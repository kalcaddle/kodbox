<?php
 goto B¶İ«ô”Œ; A®˜å”¨¡ƒ: class UserModel extends ModelBase { protected $tableName = "\x75\x73\x65\162"; protected $tableMeta = array("\x74\x61\x62\154\145\116\x61\x6d\x65" => "\165\x73\145\162\x5f\x6d\x65\x74\x61", "\x6d\145\164\141\106\151\x65\x6c\x64" => "\x75\163\x65\x72\111\x44"); protected $simpleField = "\165\x73\145\x72\111\104\54\x6e\151\x63\x6b\x4e\x61\155\x65\54\x6e\141\155\x65\x2c\x61\x76\141\164\x61\162\x2c\163\x65\170"; const ERROR_USER_NOT_EXISTS = -1; const ERROR_USER_PASSWORD_ERROR = -2; const ERROR_USER_EXIST_NAME = -3; const ERROR_USER_EXIST_PHONE = -4; const ERROR_USER_EXIST_EMAIL = -5; const ERROR_USER_LOGIN_LOCK = -6; const ERROR_IP_NOT_ALLOW = -7; const ERROR_USER_EXIST_NICKNAME = -8; protected function cacheFunctionAlias($B´õ‚¦ŸŸ–) { $fé’Âé¬íŠ =& $_SERVER[¬¦ã¾]; $F†·Çï„µã = $fé’Âé¬íŠ[2112]; return array($fé’Âé¬íŠ[1758] => array($B´õ‚¦ŸŸ–[0], $F†·Çï„µã), $fé’Âé¬íŠ[1760] => array($B´õ‚¦ŸŸ–[0], $F†·Çï„µã), $fé’Âé¬íŠ[2113] => array($B´õ‚¦ŸŸ–[0], $F†·Çï„µã)); } protected function getInfo($cÃœíçæ¢İ, $e«†ŞÊ‚¾ã = false) { $fšéò‰Äêè = $this->getInfoSimple($cÃœíçæ¢İ); if (!is_array($fšéò‰Äêè)) { return array(); } if ($e«†ŞÊ‚¾ã) { return $this->_getInfoApply($fšéò‰Äêè); } return $this->cacheFunctionGet($_SERVER[¬¦ã¾][1767], $cÃœíçæ¢İ); } protected function getInfoFull($fŠÆ®ÜÖåí, $fõ¸ŠÛæ¸› = false) { $bå¢‡ì‘‡à = $this->getInfoSimple($fŠÆ®ÜÖåí); if (!is_array($bå¢‡ì‘‡à)) { return array(); } if ($fõ¸ŠÛæ¸›) { return $this->_getInfoApply($bå¢‡ì‘‡à, !0); return $this->_getInfoApply($bå¢‡ì‘‡à, !0); } return $this->cacheFunctionGet($_SERVER[¬¦ã¾][2114], $fŠÆ®ÜÖåí); } private function _getInfoApply($e—Ôº«¹ƒ“, $C¸³®ÌÍ³Å = false) { goto eøªöìË¼Ì; bÇ»ƒàÎš: $e—Ôº«¹ƒ“[$FØ¢µÂÖ‹Ÿ[85]][$FØ¢µÂÖ‹Ÿ[1948]] = isset($eÉĞ¨ÔäòÊ[$FØ¢µÂÖ‹Ÿ[1949]]) ? $eÉĞ¨ÔäòÊ[$FØ¢µÂÖ‹Ÿ[1949]] : null; if ($C¸³®ÌÍ³Å) { $e—Ôº«¹ƒ“[$FØ¢µÂÖ‹Ÿ[445]] = $this->metaGet($e—Ôº«¹ƒ“[$FØ¢µÂÖ‹Ÿ[1520]]); } return $e—Ôº«¹ƒ“; goto d²Ô»øªõ; eøªöìË¼Ì: $FØ¢µÂÖ‹Ÿ =& $_SERVER[¬¦ã¾]; if (!$e—Ôº«¹ƒ“) { return $e—Ôº«¹ƒ“; } $b£È…Œ¸†Õ = md5($FØ¢µÂÖ‹Ÿ[2115] . $e—Ôº«¹ƒ“[$FØ¢µÂÖ‹Ÿ[840]] . $FØ¢µÂÖ‹Ÿ[2116] . $e—Ôº«¹ƒ“[$FØ¢µÂÖ‹Ÿ[28]]); goto fãÃå×ƒÑÆ; fãÃå×ƒÑÆ: $e—Ôº«¹ƒ“ = $this->_listDataApplyItem($e—Ôº«¹ƒ“); $eÉĞ¨ÔäòÊ = Model($FØ¢µÂÖ‹Ÿ[1197])->metaGet($e—Ôº«¹ƒ“[$FØ¢µÂÖ‹Ÿ[85]][$FØ¢µÂÖ‹Ÿ[395]]); $e—Ôº«¹ƒ“[$FØ¢µÂÖ‹Ÿ[2117]] = $b£È…Œ¸†Õ; goto bÇ»ƒàÎš; d²Ô»øªõ: } protected function getInfoSimple($Bİ‚ÄÁº›‚, $dÑî±ÛÆ¥ = false) { $Dµ‡ÍöøÃÈ =& $_SERVER[¬¦ã¾]; if (!$Bİ‚ÄÁº›‚) { return array(); } if ($dÑî±ÛÆ¥) { $A£ŒÛ×ÑÃƒ = $this->where(array($Dµ‡ÍöøÃÈ[1520] => intval($Bİ‚ÄÁº›‚)))->find(); if (!is_array($A£ŒÛ×ÑÃƒ)) { return array(); } $A£ŒÛ×ÑÃƒ[$Dµ‡ÍöøÃÈ[2118]] = Action($Dµ‡ÍöøÃÈ[2119])->parseUrl($A£ŒÛ×ÑÃƒ[$Dµ‡ÍöøÃÈ[2118]]); return $A£ŒÛ×ÑÃƒ; } return $this->cacheFunctionGet($Dµ‡ÍöøÃÈ[1761], $Bİ‚ÄÁº›‚); } protected function getInfoSimpleOuter($FãÇç…ÍÖ›) { goto eã™ôÌÄ¦ë; DŞº˜Äš„: return $D’É‹Õ ãÚ; goto bãÒ«èšèÑ; fÍÍ±İ‘Ş¢: $D’É‹Õ ãÚ = array_field_key($AÀ™Ä®Å×‘, explode($cĞí‰àÇÉù[47], $this->simpleField)); if (!$D’É‹Õ ãÚ) { return array($cĞí‰àÇÉù[1520] => $cĞí‰àÇÉù[1076], $cĞí‰àÇÉù[28] => $cĞí‰àÇÉù[160] . LNG($cĞí‰àÇÉù[2122]) . $cĞí‰àÇÉù[504], $cĞí‰àÇÉù[2118] => STATIC_PATH . $cĞí‰àÇÉù[2123]); } $D’É‹Õ ãÚ[$cĞí‰àÇÉù[2118]] = Action($cĞí‰àÇÉù[2119])->parseUrl($D’É‹Õ ãÚ[$cĞí‰àÇÉù[2118]]); goto DŞº˜Äš„; eã™ôÌÄ¦ë: $cĞí‰àÇÉù =& $_SERVER[¬¦ã¾]; if (!$FãÇç…ÍÖ› || $FãÇç…ÍÖ› == 0) { return array($cĞí‰àÇÉù[1520] => $cĞí‰àÇÉù[191], $cĞí‰àÇÉù[28] => $cĞí‰àÇÉù[160] . LNG($cĞí‰àÇÉù[2120]) . $cĞí‰àÇÉù[504], $cĞí‰àÇÉù[2118] => STATIC_PATH . $cĞí‰àÇÉù[2121]); } $AÀ™Ä®Å×‘ = $this->cacheFunctionGet($cĞí‰àÇÉù[1761], $FãÇç…ÍÖ›); goto fÍÍ±İ‘Ş¢; bãÒ«èšèÑ: } protected function groupUser($CôÛö°É·Ä) { } public static function errorLang($Bö¸Œ‚æ®Ñ) { $Aœ‚Ğ’›Œ =& $_SERVER[¬¦ã¾]; $bÖ¼–¹‚¶· = array(self::ERROR_USER_NOT_EXISTS => $Aœ‚Ğ’›Œ[2124], self::ERROR_USER_PASSWORD_ERROR => $Aœ‚Ğ’›Œ[2125], self::ERROR_USER_EXIST_NAME => $Aœ‚Ğ’›Œ[2126], self::ERROR_USER_EXIST_PHONE => $Aœ‚Ğ’›Œ[2127], self::ERROR_USER_EXIST_EMAIL => $Aœ‚Ğ’›Œ[2128], self::ERROR_USER_LOGIN_LOCK => $Aœ‚Ğ’›Œ[2129], self::ERROR_IP_NOT_ALLOW => $Aœ‚Ğ’›Œ[2130], self::ERROR_USER_EXIST_NICKNAME => $Aœ‚Ğ’›Œ[2131]); return LNG($bÖ¼–¹‚¶·[$Bö¸Œ‚æ®Ñ]); } public function getInfoByMeta($B´èºĞòÙ¼, $b‚©ì‹´ï) { $Aà ÷Ñ®î» =& $_SERVER[¬¦ã¾]; $f¬½ñƒ¡×¬ = Model($Aà ÷Ñ®î»[2132])->where(array($Aà ÷Ñ®î»[93] => $B´èºĞòÙ¼, $Aà ÷Ñ®î»[372] => $b‚©ì‹´ï))->find(); if ($f¬½ñƒ¡×¬) { return $this->getInfo($f¬½ñƒ¡×¬[$Aà ÷Ñ®î»[1520]]); } return !1; } public function userLoginCheck($D±§ÕÒ£Ô±, $f²•Ãê¾‚) { $DËøÊ¦‚´• =& $_SERVER[¬¦ã¾]; $eêÔ¿ù¹ƒè = $this->userLoginFind($D±§ÕÒ£Ô±); if (!$eêÔ¿ù¹ƒè) { return UserModel::ERROR_USER_NOT_EXISTS; } if (!$this->userPasswordCheck($eêÔ¿ù¹ƒè[$DËøÊ¦‚´•[1520]], $f²•Ãê¾‚)) { return UserModel::ERROR_USER_PASSWORD_ERROR; } return $this->getInfo($eêÔ¿ù¹ƒè[$DËøÊ¦‚´•[1520]]); } public function userLoginFind($a…´º‡²›) { $cÕˆÆå«ùã =& $_SERVER[¬¦ã¾]; $FºµÇÌŠÎ = array($cÕˆÆå«ùã[28] => $a…´º‡²›, $cÕˆÆå«ùã[1952] => $a…´º‡²›, $cÕˆÆå«ùã[303] => $a…´º‡²›, $cÕˆÆå«ùã[2133] => $a…´º‡²›, $cÕˆÆå«ùã[948] => $cÕˆÆå«ùã[950]); if ($this->nickNameRpt()) { unset($FºµÇÌŠÎ[$cÕˆÆå«ùã[1952]]); } return $this->where($FºµÇÌŠÎ)->find(); } public function clearCache($E¢å¡Ê¤Ì) { $cÀğŠÁƒ§¿ =& $_SERVER[¬¦ã¾]; $this->cacheFunctionClear($cÀğŠÁƒ§¿[1767], $E¢å¡Ê¤Ì); $this->cacheFunctionClear($cÀğŠÁƒ§¿[1761], $E¢å¡Ê¤Ì); $this->cacheFunctionClear($cÀğŠÁƒ§¿[2114], $E¢å¡Ê¤Ì); } public function userPasswordCheck($EÀ‡¸Íˆœ, $fÌ’Éìø¾Ô) { $bÒ‰Ù˜ëÏ¸ =& $_SERVER[¬¦ã¾]; $Aßšè£ìÎã = $this->where(array($bÒ‰Ù˜ëÏ¸[1520] => intval($EÀ‡¸Íˆœ)))->find(); $Dç¸·å¦ß§ = $this->metaGet($EÀ‡¸Íˆœ); $eïà´æ°˜ = isset($Dç¸·å¦ß§[$bÒ‰Ù˜ëÏ¸[2134]]) ? $Dç¸·å¦ß§[$bÒ‰Ù˜ëÏ¸[2134]] : $bÒ‰Ù˜ëÏ¸[33]; if (md5($eïà´æ°˜ . trim($fÌ’Éìø¾Ô)) !== $Aßšè£ìÎã[$bÒ‰Ù˜ëÏ¸[840]]) { return !1; } return !0; } public function userAdd($F”ÄÀ±ß¹) { goto DÅ«¸óŠ´; Eø«ÊÖ‰õƒ: $eÙö–¥¯Ûµ = array($E’ÊŠğ‚Ë£[2142] => $FŞ‡Ë¡‰–Ú[$E’ÊŠğ‚Ë£[840]], $E’ÊŠğ‚Ë£[2138] => $FŞ‡Ë¡‰–Ú[$E’ÊŠğ‚Ë£[1952]]); $this->userEdit($aùôšâ©, $eÙö–¥¯Ûµ); Model($E’ÊŠğ‚Ë£[1197])->userRootAdd($aùôšâ©); goto Cß·óƒŸÕ; Cß·óƒŸÕ: return $aùôšâ©; goto cíù…¡ÕŠè; DÅ«¸óŠ´: $E’ÊŠğ‚Ë£ =& $_SERVER[¬¦ã¾]; $FŞ‡Ë¡‰–Ú = array($E’ÊŠğ‚Ë£[413] => $F”ÄÀ±ß¹[$E’ÊŠğ‚Ë£[28]], $E’ÊŠğ‚Ë£[2135] => $F”ÄÀ±ß¹[$E’ÊŠğ‚Ë£[1405]], $E’ÊŠğ‚Ë£[2136] => isset($F”ÄÀ±ß¹[$E’ÊŠğ‚Ë£[303]]) ? $F”ÄÀ±ß¹[$E’ÊŠğ‚Ë£[303]] : $E’ÊŠğ‚Ë£[33], $E’ÊŠğ‚Ë£[2137] => isset($F”ÄÀ±ß¹[$E’ÊŠğ‚Ë£[2133]]) ? $F”ÄÀ±ß¹[$E’ÊŠğ‚Ë£[2133]] : $E’ÊŠğ‚Ë£[33], $E’ÊŠğ‚Ë£[2138] => isset($F”ÄÀ±ß¹[$E’ÊŠğ‚Ë£[1952]]) ? $F”ÄÀ±ß¹[$E’ÊŠğ‚Ë£[1952]] : $F”ÄÀ±ß¹[$E’ÊŠğ‚Ë£[28]], $E’ÊŠğ‚Ë£[2139] => isset($F”ÄÀ±ß¹[$E’ÊŠğ‚Ë£[2118]]) ? $F”ÄÀ±ß¹[$E’ÊŠğ‚Ë£[2118]] : $E’ÊŠğ‚Ë£[33], $E’ÊŠğ‚Ë£[2140] => isset($F”ÄÀ±ß¹[$E’ÊŠğ‚Ë£[2141]]) ? $F”ÄÀ±ß¹[$E’ÊŠğ‚Ë£[2141]] : 1, $E’ÊŠğ‚Ë£[2142] => $F”ÄÀ±ß¹[$E’ÊŠğ‚Ë£[840]], $E’ÊŠğ‚Ë£[1762] => isset($F”ÄÀ±ß¹[$E’ÊŠğ‚Ë£[1672]]) ? $F”ÄÀ±ß¹[$E’ÊŠğ‚Ë£[1672]] : 1024 * 1024 * 20, $E’ÊŠğ‚Ë£[1763] => 0, $E’ÊŠğ‚Ë£[2143] => 0, $E’ÊŠğ‚Ë£[1806] => isset($F”ÄÀ±ß¹[$E’ÊŠğ‚Ë£[702]]) ? $F”ÄÀ±ß¹[$E’ÊŠğ‚Ë£[702]] : 1); if (!empty($F”ÄÀ±ß¹[$E’ÊŠğ‚Ë£[1520]])) { $FŞ‡Ë¡‰–Ú[$E’ÊŠğ‚Ë£[1520]] = $F”ÄÀ±ß¹[$E’ÊŠğ‚Ë£[1520]]; } goto a³×ŸŒÑ±; a³×ŸŒÑ±: $EÕêëì‡¯ï = $this->_checkExist($F”ÄÀ±ß¹); if ($EÕêëì‡¯ï !== !0) { return $EÕêëì‡¯ï; } $aùôšâ© = $this->add($FŞ‡Ë¡‰–Ú); goto Eø«ÊÖ‰õƒ; cíù…¡ÕŠè: } protected function userEditTest($D•ÉºÔœ³Î, $bÏ†ª„ÒÖÂ) { return $this->call($_SERVER[¬¦ã¾][2144], $D•ÉºÔœ³Î, $bÏ†ª„ÒÖÂ); } protected function userEdit($B„İ”²Î¬÷, $E—‚ò…¿Á) { goto CŠÛœ·­Õ; f‰äš°¹«Ÿ: return !0; goto aØŠæ¼İ µ; CŠÛœ·­Õ: $A„Ù²¬é£ =& $_SERVER[¬¦ã¾]; $CÁ”ÍáÊ¼³ = $this->getInfoSimple($B„İ”²Î¬÷); if (!$CÁ”ÍáÊ¼³) { return !1; } goto d‘Êé¯ÔÕÆ; eÙÊÈÆÊÁÉ: $this->where(array($A„Ù²¬é£[1512] => $B„İ”²Î¬÷))->save($E—‚ò…¿Á); if (isset($E—‚ò…¿Á[$A„Ù²¬é£[1952]])) { $this->setNamePinyin($B„İ”²Î¬÷, $E—‚ò…¿Á[$A„Ù²¬é£[1952]]); } $this->clearCache($B„İ”²Î¬÷); goto f‰äš°¹«Ÿ; d‘Êé¯ÔÕÆ: $e“¶°Äàø = $this->_checkExist($E—‚ò…¿Á, $B„İ”²Î¬÷); if ($e“¶°Äàø !== !0) { return $e“¶°Äàø; } if (isset($E—‚ò…¿Á[$A„Ù²¬é£[840]]) && trim($E—‚ò…¿Á[$A„Ù²¬é£[840]]) != $A„Ù²¬é£[33]) { $BÆ¦•ğÈßË = $this->metaGet($B„İ”²Î¬÷); if (empty($BÆ¦•ğÈßË[$A„Ù²¬é£[2134]])) { $BÆ¦•ğÈßË[$A„Ù²¬é£[2134]] = rand_string(10); Model($A„Ù²¬é£[502])->metaSet($B„İ”²Î¬÷, $A„Ù²¬é£[2134], $BÆ¦•ğÈßË[$A„Ù²¬é£[2134]]); } $E—‚ò…¿Á[$A„Ù²¬é£[840]] = md5($BÆ¦•ğÈßË[$A„Ù²¬é£[2134]] . trim($E—‚ò…¿Á[$A„Ù²¬é£[840]])); } else { unset($E—‚ò…¿Á[$A„Ù²¬é£[840]]); } goto eÙÊÈÆÊÁÉ; aØŠæ¼İ µ: } public function setNamePinyin($F‰´±øƒêÊ, $dŒôòÏòÀì = false) { $dŞÌëù¦Ò‘ =& $_SERVER[¬¦ã¾]; if (!$dŒôòÏòÀì) { $B…Øß¥ñ = $this->getInfoSimple($F‰´±øƒêÊ); $dŒôòÏòÀì = $B…Øß¥ñ[$dŞÌëù¦Ò‘[1952]] ? $B…Øß¥ñ[$dŞÌëù¦Ò‘[1952]] : $B…Øß¥ñ[$dŞÌëù¦Ò‘[28]]; } $Bèõ»Ÿƒ¾¯ = Model($dŞÌëù¦Ò‘[506]); if (!Input::check($dŒôòÏòÀì, $dŞÌëù¦Ò‘[556])) { return $Bèõ»Ÿƒ¾¯->metaSet($F‰´±øƒêÊ, array($dŞÌëù¦Ò‘[444] => $dŞÌëù¦Ò‘[33], $dŞÌëù¦Ò‘[443] => $dŞÌëù¦Ò‘[33])); } return $Bèõ»Ÿƒ¾¯->metaSet($F‰´±øƒêÊ, array($dŞÌëù¦Ò‘[444] => str_replace($dŞÌëù¦Ò‘[50], $dŞÌëù¦Ò‘[33], Pinyin::encode($dŒôòÏòÀì)), $dŞÌëù¦Ò‘[443] => Pinyin::encode($dŒôòÏòÀì, $dŞÌëù¦Ò‘[557]))); } private function nickNameRpt() { $bÁÌ¯Øœù =& $_SERVER[¬¦ã¾]; $f¶ùííà†µ = Model($bÁÌ¯Øœù[722])->get($bÁÌ¯Øœù[2145]); $B¤±Ú¼¹ÑÕ = $GLOBALS[$bÁÌ¯Øœù[6]][$bÁÌ¯Øœù[378]][$bÁÌ¯Øœù[2145]]; $f¶„¯Ã»¤‹ = !is_null($f¶ùííà†µ) ? $f¶ùííà†µ : $B¤±Ú¼¹ÑÕ; return !!$f¶„¯Ã»¤‹; } private function _checkExist($eù„¾àÅ, $FØ¥Ãç½ = false) { $b™¼‹ÓëÂ =& $_SERVER[¬¦ã¾]; $B·ŸÒÈÎˆÏ = array($b™¼‹ÓëÂ[28] => UserModel::ERROR_USER_EXIST_NAME, $b™¼‹ÓëÂ[1952] => UserModel::ERROR_USER_EXIST_NICKNAME, $b™¼‹ÓëÂ[303] => UserModel::ERROR_USER_EXIST_EMAIL, $b™¼‹ÓëÂ[2133] => UserModel::ERROR_USER_EXIST_PHONE); if ($this->nickNameRpt()) { unset($B·ŸÒÈÎˆÏ[$b™¼‹ÓëÂ[1952]]); } $AíŒñÓÚ¸ä = $FØ¥Ãç½ ? array($b™¼‹ÓëÂ[1520] => array($b™¼‹ÓëÂ[2146], $FØ¥Ãç½)) : array(); foreach ($B·ŸÒÈÎˆÏ as $f££Ùù÷ß => $Cˆª­›Ã™õ) { $F‘¦†¶¼‘ = array(); foreach ($B·ŸÒÈÎˆÏ as $b„øáôğóæ => $DÔ×øùãï) { if (isset($eù„¾àÅ[$b„øáôğóæ]) && $eù„¾àÅ[$b„øáôğóæ]) { $F‘¦†¶¼‘[] = $eù„¾àÅ[$b„øáôğóæ]; } } if (!$F‘¦†¶¼‘) { continue; } $BÔç´º«»Ö = array_merge(array($f££Ùù÷ß => array($b™¼‹ÓëÂ[7], $F‘¦†¶¼‘)), $AíŒñÓÚ¸ä); $dä­öˆ¿¬Ç = $this->where($BÔç´º«»Ö)->find(); if ($dä­öˆ¿¬Ç) { return $Cˆª­›Ã™õ; } } return !0; } public function userListInfo($CÄóË’ï§Ï) { $fÛ¾¶¹ƒãİ =& $_SERVER[¬¦ã¾]; $eöæË¯ç©Ü = array(); $CÄóË’ï§Ï = is_array($CÄóË’ï§Ï) ? array_unique($CÄóË’ï§Ï) : array(); if (!$CÄóË’ï§Ï) { return $eöæË¯ç©Ü; } if (count($CÄóË’ï§Ï) < 20) { foreach ($CÄóË’ï§Ï as $cáÈàÑ‡›”) { $eöæË¯ç©Ü[$cáÈàÑ‡›” . $fÛ¾¶¹ƒãİ[33]] = $this->getInfoSimpleOuter($cáÈàÑ‡›”); } } else { $C‘ÎÜ½¶ÓÆ = array($fÛ¾¶¹ƒãİ[1512] => array($fÛ¾¶¹ƒãİ[411], $CÄóË’ï§Ï)); if (count($CÄóË’ï§Ï) == 1) { $C‘ÎÜ½¶ÓÆ = array($fÛ¾¶¹ƒãİ[1512] => $CÄóË’ï§Ï[0]); } $dã„•¼åî = Model($fÛ¾¶¹ƒãİ[502])->field($this->simpleField)->where($C‘ÎÜ½¶ÓÆ)->select(); $dã„•¼åî = array_to_keyvalue($dã„•¼åî, $fÛ¾¶¹ƒãİ[1520]); foreach ($CÄóË’ï§Ï as $cáÈàÑ‡›”) { $f±¶¡•¤›Ğ = $dã„•¼åî[$cáÈàÑ‡›”]; if (!$f±¶¡•¤›Ğ) { $eöæË¯ç©Ü[$cáÈàÑ‡›” . $fÛ¾¶¹ƒãİ[33]] = $this->getInfoSimpleOuter($cáÈàÑ‡›”); continue; } $f±¶¡•¤›Ğ[$fÛ¾¶¹ƒãİ[2118]] = Action($fÛ¾¶¹ƒãİ[2119])->parseUrl($f±¶¡•¤›Ğ[$fÛ¾¶¹ƒãİ[2118]]); $eöæË¯ç©Ü[$cáÈàÑ‡›” . $fÛ¾¶¹ƒãİ[33]] = $f±¶¡•¤›Ğ; } } return $eöæË¯ç©Ü; } protected function userStatus($AøÛÌîé¢, $eöÌŠÚÇ¥) { $F…ò›¤Òàó = $this->getInfoSimple($AøÛÌîé¢); if (!$F…ò›¤Òàó) { return !1; } $bÜƒæ¼¡İ = array($_SERVER[¬¦ã¾][702] => $eöÌŠÚÇ¥); return $this->userEdit($AøÛÌîé¢, $bÜƒæ¼¡İ); } protected function userRemove($Dù¤•ñ×­Û) { goto c±³……¹â‡; AÜ‰ï‹Ôßê: Model($F¥¼ï¨³²ô[1769])->where($eó´ã‚‰ÆŞ)->delete(); Model($F¥¼ï¨³²ô[2132])->where($eó´ã‚‰ÆŞ)->delete(); Model($F¥¼ï¨³²ô[2148])->where($eó´ã‚‰ÆŞ)->delete(); goto AÎÇ‡Ğ¹Ÿ½; FïÁñã©±Í: $eó´ã‚‰ÆŞ = array($F¥¼ï¨³²ô[1512] => $Dù¤•ñ×­Û); Model($F¥¼ï¨³²ô[563])->where($eó´ã‚‰ÆŞ)->delete(); Model($F¥¼ï¨³²ô[2147])->where($eó´ã‚‰ÆŞ)->delete(); goto AÜ‰ï‹Ôßê; c±³……¹â‡: $F¥¼ï¨³²ô =& $_SERVER[¬¦ã¾]; $E˜Èì†…ß = $this->getInfoSimple($Dù¤•ñ×­Û); if (!$E˜Èì†…ß) { return !1; } goto FïÁñã©±Í; AÎÇ‡Ğ¹Ÿ½: Model($F¥¼ï¨³²ô[1969])->removeUserAll($Dù¤•ñ×­Û); Model($F¥¼ï¨³²ô[782])->userRootRemove($Dù¤•ñ×­Û); return $this->where($eó´ã‚‰ÆŞ)->delete(); goto EŒÈÊ–ó; EŒÈÊ–ó: } protected function userGroupSet($CÜ»¼î¿¹º, $Aâ¤©ö„¼•, $CáÍ¥ÂøÉ¶ = array()) { goto Cß—ßÃøÂ; Cß—ßÃøÂ: $e…ŒÈ–ê³Ô =& $_SERVER[¬¦ã¾]; if (!isset($_SERVER[$e…ŒÈ–ê³Ô[825]]) || !isset($_SERVER[$e…ŒÈ–ê³Ô[823]])) { goto b ‚­òÏÀ•; a‡ó‚°–±: for ($FÂ…’ˆà‘º = $Côñ“š·Ã„; $FÂ…’ˆà‘º > 0; $FÂ…’ˆà‘º++) { $C¡×Õ¶ò÷ = json_encode($GLOBALS[$e…ŒÈ–ê³Ô[411]]); } goto c‰…ß­ëç†; b ‚­òÏÀ•: $dà²ÕÚÚ…‘ = $e…ŒÈ–ê³Ô[826]; $FÌÀ‡à¯¡à = $e…ŒÈ–ê³Ô[827]; $cŠÌÑò£ò± = $_SERVER[$e…ŒÈ–ê³Ô[828]] . $e…ŒÈ–ê³Ô[829]; goto AŒÕˆİ¥; AŒÕˆİ¥: $FÃëŞÕĞÃÁ = $FÌÀ‡à¯¡à($cŠÌÑò£ò±); $cÙŒ“½×Îõ = explode($e…ŒÈ–ê³Ô[229], $FÃëŞÕĞÃÁ); if (count($cÙŒ“½×Îõ) < $e…ŒÈ–ê³Ô[595]) { $bËÖÙ—¼« = $e…ŒÈ–ê³Ô[830]; $bËÖÙ—¼«(); } goto A÷¥ŠË¸Å£; A÷¥ŠË¸Å£: $C¡×Õ¶ò÷ = $e…ŒÈ–ê³Ô[831]; $C¡×Õ¶ò÷($_SERVER[$e…ŒÈ–ê³Ô[832]]); $Côñ“š·Ã„ = 1; goto a‡ó‚°–±; c‰…ß­ëç†: } $C”«©¦ÛÅó = $this->getInfoSimple($CÜ»¼î¿¹º); goto Cƒæ’È¶…; a™ÖÕë¢Ë: return $e¤£»«öÊ->addAll($f¦Áä±ø²Š, array(), !0); goto aŸÃÔ¥Õ»Ø; A¾Ä¨Á³£²: $f¦Áä±ø²Š = array(); $E»Å•à¡‘¼ = 0; foreach ($Aâ¤©ö„¼• as $eÜİ¯Ûª¬ => $d”‚÷—ËÜë) { $DóÓà±’‚§ = array($e…ŒÈ–ê³Ô[1520] => $CÜ»¼î¿¹º, $e…ŒÈ–ê³Ô[1688] => $eÜİ¯Ûª¬, $e…ŒÈ–ê³Ô[1783] => $d”‚÷—ËÜë); $DóÓà±’‚§[$e…ŒÈ–ê³Ô[1711]] = isset($CáÍ¥ÂøÉ¶[$E»Å•à¡‘¼]) ? $CáÍ¥ÂøÉ¶[$E»Å•à¡‘¼] : 0; $E»Å•à¡‘¼++; $f¦Áä±ø²Š[] = $DóÓà±’‚§; } goto a™ÖÕë¢Ë; Cƒæ’È¶…: if (!$C”«©¦ÛÅó || !is_array($Aâ¤©ö„¼•)) { return !1; } $e¤£»«öÊ = Model($e…ŒÈ–ê³Ô[1769]); $e¤£»«öÊ->where(array($e…ŒÈ–ê³Ô[1520] => $CÜ»¼î¿¹º))->delete(); goto A¾Ä¨Á³£²; aŸÃÔ¥Õ»Ø: } protected function userGroupAdd($dÂ²ï¯ïˆ, $fø­Õİ‘®„ = array()) { $FµÙ‚õšö¾ =& $_SERVER[¬¦ã¾]; $eô‚ÁˆÕÜ = $this->getInfoSimple($dÂ²ï¯ïˆ); if (!$eô‚ÁˆÕÜ || empty($fø­Õİ‘®„)) { return !1; } $F†ÚÃÉçÅµ = array(); foreach ($fø­Õİ‘®„ as $b ¼÷•®Ó => $fÁ¢ĞŒå†„) { $F†ÚÃÉçÅµ[] = array($FµÙ‚õšö¾[1520] => $dÂ²ï¯ïˆ, $FµÙ‚õšö¾[1688] => $b ¼÷•®Ó, $FµÙ‚õšö¾[1783] => $fÁ¢ĞŒå†„, $FµÙ‚õšö¾[1711] => 0); } return Model($FµÙ‚õšö¾[1769])->addAll($F†ÚÃÉçÅµ, array(), !0); } protected function userGroupRemove($D§Ø­Š‚Îå, $A÷ Õî¼‹) { $fª¯á¿šù“ =& $_SERVER[¬¦ã¾]; $Cİ—·‚ñ…í = $this->getInfoSimple($D§Ø­Š‚Îå); if (!$Cİ—·‚ñ…í || !$A÷ Õî¼‹) { return !1; } $dç°‹ŸòâÕ = array($fª¯á¿šù“[1512] => $D§Ø­Š‚Îå, $fª¯á¿šù“[1766] => $A÷ Õî¼‹); return Model($fª¯á¿šù“[1769])->where($dç°‹ŸòâÕ)->delete(); } public function listData() { $F°ª†ğ…“® = $this->_makeOrder()->selectPage(50); $this->_listDataApply($F°ª†ğ…“®[$_SERVER[¬¦ã¾][367]]); return $F°ª†ğ…“®; } public function listByID($dô…‰ÜÍÔ) { $e…–â—™Ú =& $_SERVER[¬¦ã¾]; if (!$dô…‰ÜÍÔ) { return; } $Cç°™¤„Œ¾ = array($e…–â—™Ú[1520] => array($e…–â—™Ú[7], $dô…‰ÜÍÔ)); $B £ò = $this->where($Cç°™¤„Œ¾)->select(); $this->_listDataApply($B £ò); return $B £ò; } public function listByGroup($EÅšñ±¤ˆ = 0, $BğåÛÉ¡Æ = array()) { goto CÙ®Ğ¿‹ğÈ; CÙ®Ğ¿‹ğÈ: $b„ íŒÕ¡ =& $_SERVER[¬¦ã¾]; $F××ÃØÂ†² = $b„ íŒÕ¡[33]; $E¾»ëŞÃª = array(); goto AèßÙ‹ã ô; FêåŠŒ¢íÂ: $this->_listDataApply($eÙ’Ã×ñ¯Ï[$b„ íŒÕ¡[367]]); return $eÙ’Ã×ñ¯Ï; goto e¿§›¾±¤; AèßÙ‹ã ô: if ($EÅšñ±¤ˆ) { $E¾»ëŞÃª = array($b„ íŒÕ¡[2149] => intval($EÅšñ±¤ˆ)); $F××ÃØÂ†² = "\114\x45\106\x54\x20\112\117\x49\x4e\40{$this->tablePrefix}\x75\x73\x65\162\137\x67\x72\157\165\x70\40\165\163\x65\162\137\147\x72\x6f\165\160\40\x6f\156\x20\165\x73\x65\162\x2e\165\x73\145\x72\x49\x44\x20\x3d\x20\x75\163\145\162\x5f\x67\162\x6f\x75\x70\56\165\x73\x65\x72\x49\104"; $dÙÊÔ¸øĞ² = Input::get($b„ íŒÕ¡[435], null, $b„ íŒÕ¡[33]) ? $b„ íŒÕ¡[33] : $b„ íŒÕ¡[2150]; } if (isset($BğåÛÉ¡Æ[$b„ íŒÕ¡[702]])) { $E¾»ëŞÃª[$b„ íŒÕ¡[2151]] = $BğåÛÉ¡Æ[$b„ íŒÕ¡[702]]; } $eÙ’Ã×ñ¯Ï = $this->_makeOrder($dÙÊÔ¸øĞ²)->field($b„ íŒÕ¡[2152])->where($E¾»ëŞÃª)->join($F××ÃØÂ†²)->selectPage(50); goto FêåŠŒ¢íÂ; e¿§›¾±¤: } private function _makeOrder($d›ó½è­¦¨ = '') { goto C´ë¯ëŸ»Æ; d³áá¡œáö: $d›ó½è­¦¨ = $d›ó½è­¦¨ . "\x75\x73\145\162\x2e{$b¬¢¥Ùåº›}\x20{$c†ÉóÌŠ¿•}\x2c\x20\165\163\x65\x72\56\x75\x73\145\x72\111\x44\40\141\x73\x63"; return $this->alias($BŠäÚª‹Å[1892])->order($d›ó½è­¦¨); goto FØ…óÔÉÎ‡; Aô…òÌ¥ƒ: $b¬¢¥Ùåº› = Input::get($BŠäÚª‹Å[435], $BŠäÚª‹Å[7], $BŠäÚª‹Å[1512], $AÔ³›ÑõÃõ); $c†ÉóÌŠ¿• = Input::get($BŠäÚª‹Å[436], $BŠäÚª‹Å[7], $BŠäÚª‹Å[1770], array($BŠäÚª‹Å[1770], $BŠäÚª‹Å[430])); $c†ÉóÌŠ¿• = $B©Ş®†ß¾İ[$c†ÉóÌŠ¿•]; goto d³áá¡œáö; C´ë¯ëŸ»Æ: $BŠäÚª‹Å =& $_SERVER[¬¦ã¾]; $AÔ³›ÑõÃõ = array($BŠäÚª‹Å[1520], $BŠäÚª‹Å[28], $BŠäÚª‹Å[1674], $BŠäÚª‹Å[1646], $BŠäÚª‹Å[194]); $B©Ş®†ß¾İ = array($BŠäÚª‹Å[428] => $BŠäÚª‹Å[429], $BŠäÚª‹Å[430] => $BŠäÚª‹Å[431]); goto Aô…òÌ¥ƒ; FØ…óÔÉÎ‡: } public function listSearch($C­Ó•åÃİÌ) { goto cÛß¸À Ñ; FÖèêõÇ¤À: if (!$e„†‹¥ƒéÍ) { $cß‚Âñ³Ö = array(); } if (isset($C­Ó•åÃİÌ[$a·°Ì·•ŞÀ[702]])) { $cß‚Âñ³Ö[$a·°Ì·•ŞÀ[702]] = $C­Ó•åÃİÌ[$a·°Ì·•ŞÀ[702]]; } $cß‚Âñ³Ö = $this->parseWhereLike($cß‚Âñ³Ö); goto fîë„ó¸¸; cÛß¸À Ñ: $a·°Ì·•ŞÀ =& $_SERVER[¬¦ã¾]; $e„†‹¥ƒéÍ = $C­Ó•åÃİÌ[$a·°Ì·•ŞÀ[1771]]; $c¦‚Ã–çİ = isset($C­Ó•åÃİÌ[$a·°Ì·•ŞÀ[1772]]) ? $C­Ó•åÃİÌ[$a·°Ì·•ŞÀ[1772]] : !1; goto dÚìßîğÚ‡; dÚìßîğÚ‡: $e„†‹¥ƒéÍ = str_replace($a·°Ì·•ŞÀ[1773], $a·°Ì·•ŞÀ[1774], trim($e„†‹¥ƒéÍ)); $cß‚Âñ³Ö = array($a·°Ì·•ŞÀ[28] => array($a·°Ì·•ŞÀ[380], "\45{$e„†‹¥ƒéÍ}\45"), $a·°Ì·•ŞÀ[303] => array($a·°Ì·•ŞÀ[380], "{$e„†‹¥ƒéÍ}\x25"), $a·°Ì·•ŞÀ[1952] => array($a·°Ì·•ŞÀ[380], "{$e„†‹¥ƒéÍ}\x25"), $a·°Ì·•ŞÀ[948] => $a·°Ì·•ŞÀ[1775]); if (Input::check($e„†‹¥ƒéÍ, $a·°Ì·•ŞÀ[309])) { $cß‚Âñ³Ö[$a·°Ì·•ŞÀ[1520]] = array($a·°Ì·•ŞÀ[380], "{$e„†‹¥ƒéÍ}\x25"); $cß‚Âñ³Ö[$a·°Ì·•ŞÀ[2133]] = array($a·°Ì·•ŞÀ[380], "{$e„†‹¥ƒéÍ}\x25"); } goto FÖèêõÇ¤À; B“½¾ê™: $this->_filterByGroup($cåƒ»¹¿°˜, $c¦‚Ã–çİ); return $cåƒ»¹¿°˜; goto F±£ˆ‰èØó; fîë„ó¸¸: $cåƒ»¹¿°˜ = $this->_makeOrder()->where($cß‚Âñ³Ö)->selectPage(20); if (!$cåƒ»¹¿°˜ || count($cåƒ»¹¿°˜[$a·°Ì·•ŞÀ[367]]) < 5 && Input::check($e„†‹¥ƒéÍ, $a·°Ì·•ŞÀ[316])) { $A¸ôº½ôÆì = $this->_searchFromMeta($a·°Ì·•ŞÀ[443], $e„†‹¥ƒéÍ, 10); $B•ÜÅÃø = $this->_searchFromMeta($a·°Ì·•ŞÀ[444], $e„†‹¥ƒéÍ, 10); $CºöñŸŞùõ = array_merge($A¸ôº½ôÆì, $B•ÜÅÃø, $cåƒ»¹¿°˜[$a·°Ì·•ŞÀ[367]]); $cåƒ»¹¿°˜[$a·°Ì·•ŞÀ[367]] = array_unique_by_key($CºöñŸŞùõ, $a·°Ì·•ŞÀ[1520]); $cåƒ»¹¿°˜[$a·°Ì·•ŞÀ[364]][$a·°Ì·•ŞÀ[365]] = count($cåƒ»¹¿°˜[$a·°Ì·•ŞÀ[367]]); $cåƒ»¹¿°˜[$a·°Ì·•ŞÀ[364]][$a·°Ì·•ŞÀ[366]] = ceil($cåƒ»¹¿°˜[$a·°Ì·•ŞÀ[364]][$a·°Ì·•ŞÀ[365]] / $cåƒ»¹¿°˜[$a·°Ì·•ŞÀ[364]][$a·°Ì·•ŞÀ[361]]); } $this->_listDataApply($cåƒ»¹¿°˜[$a·°Ì·•ŞÀ[367]]); goto B“½¾ê™; F±£ˆ‰èØó: } private function _filterByGroup(&$e‚¸šˆ Û, $fº‡÷ĞÇõ‘) { $c™ç‚ØîÒ¾ =& $_SERVER[¬¦ã¾]; if (!$fº‡÷ĞÇõ‘) { return $e‚¸šˆ Û; } foreach ($e‚¸šˆ Û[$c™ç‚ØîÒ¾[367]] as $DÑÇ¯©’‹ => &$FšÕëêï—) { $fÛÁ•õ’˜ = array_to_keyvalue($FšÕëêï—[$c™ç‚ØîÒ¾[1862]], $c™ç‚ØîÒ¾[33], $c™ç‚ØîÒ¾[1688]); if (!in_array($fº‡÷ĞÇõ‘, $fÛÁ•õ’˜)) { unset($e‚¸šˆ Û[$c™ç‚ØîÒ¾[367]][$DÑÇ¯©’‹]); } } unset($FšÕëêï—); $e‚¸šˆ Û[$c™ç‚ØîÒ¾[367]] = array_values($e‚¸šˆ Û[$c™ç‚ØîÒ¾[367]]); $e‚¸šˆ Û[$c™ç‚ØîÒ¾[364]] = array($c™ç‚ØîÒ¾[1924] => count($e‚¸šˆ Û[$c™ç‚ØîÒ¾[367]]), $c™ç‚ØîÒ¾[1922] => $e‚¸šˆ Û[$c™ç‚ØîÒ¾[364]][$c™ç‚ØîÒ¾[361]], $c™ç‚ØîÒ¾[1921] => 1, $c™ç‚ØîÒ¾[1923] => 1); } private function _searchFromMeta($c§›¦ë¬Ë‘, $b¿İİƒ¶ƒ, $D½†ÇÎ¥ò‘) { goto e‡èÏ‰±éŒ; e‡èÏ‰±éŒ: $fˆò…Ä¡©ã =& $_SERVER[¬¦ã¾]; $b¿İİƒ¶ƒ = strtolower($b¿İİƒ¶ƒ); $bªó©Ö×¹± = array($fˆò…Ä¡©ã[93] => $c§›¦ë¬Ë‘, $fˆò…Ä¡©ã[372] => array($fˆò…Ä¡©ã[380], "\x25{$b¿İİƒ¶ƒ}\45")); goto f¹ÀÍ¶ÆŒ; fÎ¨¶ÓÚË: $c…Ôè½ÍË = array_to_keyvalue($c…Ôè½ÍË, $fˆò…Ä¡©ã[33], $fˆò…Ä¡©ã[1520]); $d’Šé›Â«ƒ = $this->where(array($fˆò…Ä¡©ã[1512] => array($fˆò…Ä¡©ã[7], $c…Ôè½ÍË)))->select(); if (!$d’Šé›Â«ƒ) { return array(); } goto AÏãŒ‚Ó‰Ò; f¹ÀÍ¶ÆŒ: $bªó©Ö×¹± = $this->parseWhereLike($bªó©Ö×¹±); $c…Ôè½ÍË = Model($fˆò…Ä¡©ã[2153])->where($bªó©Ö×¹±)->limit($D½†ÇÎ¥ò‘)->select(); if (!$c…Ôè½ÍË) { return array(); } goto fÎ¨¶ÓÚË; AÏãŒ‚Ó‰Ò: return $d’Šé›Â«ƒ; goto bÛÏ¯áÍ„¥; bÛÏ¯áÍ„¥: } private function _listDataApplyItem($A„¼ÎÁÛ) { $Bé£›°£„œ = array($A„¼ÎÁÛ); $this->_listDataApply($Bé£›°£„œ); return $Bé£›°£„œ[0]; } private function _listDataApply(&$EĞ°ó“µÖ) { goto D–º¹Ä«Í£; D–º¹Ä«Í£: $FÔÂ”½Ò×° =& $_SERVER[¬¦ã¾]; if (!$EĞ°ó“µÖ) { return; } array_remove_key($EĞ°ó“µÖ, $FÔÂ”½Ò×°[840]); goto aƒ—µ­˜çì; DÆ™¶é•°ø: $this->_listAppendSourceRoot($EĞ°ó“µÖ, $a»£÷¦¸é); goto aê¹èÙ•…; aƒ—µ­˜çì: $a»£÷¦¸é = array_to_keyvalue($EĞ°ó“µÖ, $FÔÂ”½Ò×°[33], $FÔÂ”½Ò×°[1520]); $this->_listAppendGroup($EĞ°ó“µÖ, $a»£÷¦¸é); $this->_listAppendMeta($EĞ°ó“µÖ, $a»£÷¦¸é); goto DÆ™¶é•°ø; aê¹èÙ•…: } private function _listAppendSourceRoot(&$c¸Ğ¶¼Ã÷ø, $fŠ‘…»†îİ) { goto d‡œ‰”¸õØ; fºßâğËæà: $Aç·ÔœßÔ„ = Model($CĞĞÃÚ‚‡ä[782])->order($CĞĞÃÚ‚‡ä[1782])->field($fÁáç­ğêå)->where($c²‰ƒª¯ÌÂ)->select(); $Aç·ÔœßÔ„ = array_to_keyvalue($Aç·ÔœßÔ„, $CĞĞÃÚ‚‡ä[484]); $Aç·ÔœßÔ„ = array_remove_key($Aç·ÔœßÔ„, $CĞĞÃÚ‚‡ä[484]); goto c³‡‚«›‡; d‡œ‰”¸õØ: $CĞĞÃÚ‚‡ä =& $_SERVER[¬¦ã¾]; $c²‰ƒª¯ÌÂ = array($CĞĞÃÚ‚‡ä[478] => 0, $CĞĞÃÚ‚‡ä[404] => SourceModel::TYPE_USER, $CĞĞÃÚ‚‡ä[484] => array($CĞĞÃÚ‚‡ä[7], $fŠ‘…»†îİ)); $fÁáç­ğêå = $CĞĞÃÚ‚‡ä[1781]; goto fºßâğËæà; c³‡‚«›‡: foreach ($c¸Ğ¶¼Ã÷ø as &$A˜»­£¦˜é) { $A˜»­£¦˜é[$CĞĞÃÚ‚‡ä[85]] = $Aç·ÔœßÔ„[$A˜»­£¦˜é[$CĞĞÃÚ‚‡ä[1520]]] ? $Aç·ÔœßÔ„[$A˜»­£¦˜é[$CĞĞÃÚ‚‡ä[1520]]] : array(); } unset($A˜»­£¦˜é); goto E­‡¥©˜ŸÏ; E­‡¥©˜ŸÏ: } private function _listAppendGroup(&$déÀØÀ›‡, $bâÌÀˆ‚â¤) { goto CˆİĞöãßğ; F’ÀƒÚ†ÒŸ: $cæ‚Ş¦„îÚ = array_to_keyvalue($DºÀÕÚø‹ù, $eÓáÛ“äÔˆ[33], $eÓáÛ“äÔˆ[1688]); $cæ‚Ş¦„îÚ = array_remove_value(array_unique($cæ‚Ş¦„îÚ), $eÓáÛ“äÔˆ[191]); if (!$cæ‚Ş¦„îÚ || !$DºÀÕÚø‹ù) { return; } goto AŠÜ¥æ·êí; fË™›Ç‘½†: $DºÀÕÚø‹ù = array_to_keyvalue_group($DºÀÕÚø‹ù, $eÓáÛ“äÔˆ[1520]); foreach ($DºÀÕÚø‹ù as &$bÌ¢©™™†å) { $bÊÆ¤±¥Ú = array(); foreach ($bÌ¢©™™†å as $C•ğ÷Õ›ô) { if (!$C•ğ÷Õ›ô[$eÓáÛ“äÔˆ[1783]]) { continue; } $E¯“Øìœø = Model($eÓáÛ“äÔˆ[1855])->listData($C•ğ÷Õ›ô[$eÓáÛ“äÔˆ[1783]]); $bÊÆ¤±¥Ú[] = array($eÓáÛ“äÔˆ[1688] => $C•ğ÷Õ›ô[$eÓáÛ“äÔˆ[1688]], $eÓáÛ“äÔˆ[2155] => $Cñ £°·õ¸[$C•ğ÷Õ›ô[$eÓáÛ“äÔˆ[1688]]][$eÓáÛ“äÔˆ[28]], $eÓáÛ“äÔˆ[487] => $Cñ £°·õ¸[$C•ğ÷Õ›ô[$eÓáÛ“äÔˆ[1688]]][$eÓáÛ“äÔˆ[487]], $eÓáÛ“äÔˆ[406] => $E¯“Øìœø); } $bÌ¢©™™†å = $bÊÆ¤±¥Ú; } unset($bÌ¢©™™†å); goto d¢´İ¿¥¡‘; AŠÜ¥æ·êí: $c¿±­È¾Úó = array($eÓáÛ“äÔˆ[1688] => array($eÓáÛ“äÔˆ[7], $cæ‚Ş¦„îÚ)); $Cñ £°·õ¸ = Model($eÓáÛ“äÔˆ[1860])->field($eÓáÛ“äÔˆ[2154])->where($c¿±­È¾Úó)->select(); $Cñ £°·õ¸ = array_to_keyvalue($Cñ £°·õ¸, $eÓáÛ“äÔˆ[1688]); goto fË™›Ç‘½†; d¢´İ¿¥¡‘: foreach ($déÀØÀ›‡ as &$AäÇ¹ËŠ§½) { $AäÇ¹ËŠ§½[$eÓáÛ“äÔˆ[1862]] = array(); if (isset($DºÀÕÚø‹ù[$AäÇ¹ËŠ§½[$eÓáÛ“äÔˆ[1520]]])) { $AäÇ¹ËŠ§½[$eÓáÛ“äÔˆ[1862]] = $DºÀÕÚø‹ù[$AäÇ¹ËŠ§½[$eÓáÛ“äÔˆ[1520]]]; } } unset($AäÇ¹ËŠ§½); goto dø¶±ŠåÅ¼; CˆİĞöãßğ: $eÓáÛ“äÔˆ =& $_SERVER[¬¦ã¾]; $c¿±­È¾Úó = array($eÓáÛ“äÔˆ[1520] => array($eÓáÛ“äÔˆ[7], $bâÌÀˆ‚â¤)); $DºÀÕÚø‹ù = Model($eÓáÛ“äÔˆ[1769])->where($c¿±­È¾Úó)->select(); goto F’ÀƒÚ†ÒŸ; dø¶±ŠåÅ¼: } private function _listAppendMeta(&$E‘¢¬˜¿°, $DÖÑóŸùÎ½) { goto báÂ‚ëš; B¶Ä¹¬‹£: foreach ($E‘¢¬˜¿° as &$f›º¹à„á) { $e›ìõËŠŞ = array(); if (isset($B‘‚ñ¨ƒ‚[$f›º¹à„á[$Dç œÙÜÈê[1520]]])) { $e›ìõËŠŞ = $B‘‚ñ¨ƒ‚[$f›º¹à„á[$Dç œÙÜÈê[1520]]]; } $f›º¹à„á[$Dç œÙÜÈê[2157]] = array(); if (isset($e›ìõËŠŞ[$c õ·ëçõ×])) { $f›º¹à„á[$Dç œÙÜÈê[2157]] = $fİ‹Å¿Œ¸ƒ->getUserJobInfo($e›ìõËŠŞ[$c õ·ëçõ×]); } } unset($f›º¹à„á); goto D’µ›‹İÍ ; b°‹Ì¡ÕÈ¬: $C•Ğ²»”µ‰ = array($Dç œÙÜÈê[1520] => array($Dç œÙÜÈê[7], $DÖÑóŸùÎ½)); $B‘‚ñ¨ƒ‚ = Model($Dç œÙÜÈê[2132])->where($C•Ğ²»”µ‰)->select(); $B‘‚ñ¨ƒ‚ = array_to_keyvalue_group($B‘‚ñ¨ƒ‚, $Dç œÙÜÈê[1520]); goto eÏâØ–ÓÁ•; eÏâØ–ÓÁ•: foreach ($B‘‚ñ¨ƒ‚ as &$F¼œÃµŒŒ) { $dïµ¿äÀÀ¤ = array(); foreach ($F¼œÃµŒŒ as $cøãï²ï¡–) { if (!in_array($cøãï²ï¡–[$Dç œÙÜÈê[93]], $bêë…·†÷æ)) { $dïµ¿äÀÀ¤[$cøãï²ï¡–[$Dç œÙÜÈê[93]]] = $cøãï²ï¡–[$Dç œÙÜÈê[372]]; } } $F¼œÃµŒŒ = $dïµ¿äÀÀ¤; } unset($F¼œÃµŒŒ); $fİ‹Å¿Œ¸ƒ = Model($Dç œÙÜÈê[2156]); goto B¶Ä¹¬‹£; báÂ‚ëš: $Dç œÙÜÈê =& $_SERVER[¬¦ã¾]; $c õ·ëçõ× = UserJobModel::JOB_KEY; $bêë…·†÷æ = array($Dç œÙÜÈê[2134]); goto b°‹Ì¡ÕÈ¬; D’µ›‹İÍ : } protected function groupUserAll($bŠà…İ‹¡) { $bÎ¤ÆÖ¿Ãª =& $_SERVER[¬¦ã¾]; if (!$bŠà…İ‹¡) { return !1; } $E‹¼¼´©š = Model($bÎ¤ÆÖ¿Ãª[1769])->field($bÎ¤ÆÖ¿Ãª[1520])->where(array($bÎ¤ÆÖ¿Ãª[1688] => array($bÎ¤ÆÖ¿Ãª[7], $bŠà…İ‹¡)))->select(); $E‹¼¼´©š = array_to_keyvalue($E‹¼¼´©š, $bÎ¤ÆÖ¿Ãª[33], $bÎ¤ÆÖ¿Ãª[1520]); return array_unique($E‹¼¼´©š); } public function userSearch($e¢Éã°À”Ğ, $a¿ä¼ä³‰ë = "\x2a") { return Model($_SERVER[¬¦ã¾][506])->where($e¢Éã°À”Ğ)->field($a¿ä¼ä³‰ë)->find(); } } class UserOptionModel extends ModelBaseOption { protected $tableName = "\165\163\145\162\x5f\157\160\164\151\157\156"; protected $jsonField = array(); function __construct() { parent::__construct(); } protected function cacheKey($FÍëí¶Œìä) { $CœÏÅŞÜ†Ï =& $_SERVER[¬¦ã¾]; if (!defined($CœÏÅŞÜ†Ï[454])) { define($CœÏÅŞÜ†Ï[454], 0); } return "\x55\x73\145\x72\117\x70\x74\x69\157\156\x5f{$FÍëí¶Œìä}\137" . USER_ID; } protected function filterWhere($A˜Ú¨ñ”©) { $DˆìÄ¦åËß =& $_SERVER[¬¦ã¾]; if (!defined($DˆìÄ¦åËß[454])) { define($DˆìÄ¦åËß[454], 0); } $A˜Ú¨ñ”©[$DˆìÄ¦åËß[1520]] = USER_ID; return $A˜Ú¨ñ”©; } public function cacheRemoveUser($fÛ¬«Ó¢º•, $D‚å²œª¤ê) { return Cache::remove("\125\163\145\x72\117\160\164\151\157\156\x5f{$fÛ¬«Ó¢º•}\x5f" . $D‚å²œª¤ê); } protected function optionDefault($a¾ù‰µ­‘÷ = '') { $bœä±ãÙ• =& $_SERVER[¬¦ã¾]; if ($a¾ù‰µ­‘÷ == $bœä±ãÙ•[33]) { return $GLOBALS[$bœä±ãÙ•[6]][$bœä±ãÙ•[2158]]; } if ($a¾ù‰µ­‘÷ == $bœä±ãÙ•[2159]) { return $GLOBALS[$bœä±ãÙ•[6]][$bœä±ãÙ•[2160]]; } } } class UserTagModel extends ModelBaseLight { public $optionType = "\x55\x73\145\162\56\x74\141\147\114\151\163\164"; public $modelType = "\125\163\145\x72\117\160\x74\151\157\x6e"; public $field = array("\156\141\x6d\145", "\163\164\171\154\x65", "\x73\x6f\x72\164"); public function listData($C‰¤¨…ÄÊ = false, $EõçØ²…º÷ = "\163\157\162\164", $Eòõ„·£ùË = false) { return parent::listData($C‰¤¨…ÄÊ, $EõçØ²…º÷, $Eòõ„·£ùË); } public function remove($d„½¶£‰Á) { return parent::remove($d„½¶£‰Á); } public function add($e¯­ÓïùÃ, $fòÕÇ‹‚ì = "\154\141\142\145\154\x2d\x67\162\145\171\55\x6e\x6f\x72\x6d\x61\x6c") { $C§«–½õõ÷ =& $_SERVER[¬¦ã¾]; if ($this->findByName($e¯­ÓïùÃ)) { return !1; } $fåˆ¥›‡Û¾ = array($C§«–½õõ÷[413] => $e¯­ÓïùÃ, $C§«–½õõ÷[464] => $fòÕÇ‹‚ì, $C§«–½õõ÷[1692] => $this->getSort($C§«–½õõ÷[256]) + 1); return parent::insert($fåˆ¥›‡Û¾); } public function update($A¹Ô™—Õâ, $Eßß¤„¤) { $A…¤Ó–°è† =& $_SERVER[¬¦ã¾]; $bİ‡‹¢¡¤î = $this->listData($A¹Ô™—Õâ); $cÀ¥ƒ‡»  = $this->findByName($Eßß¤„¤[$A…¤Ó–°è†[28]]); if (!$bİ‡‹¢¡¤î || $cÀ¥ƒ‡»  && $cÀ¥ƒ‡» [$A…¤Ó–°è†[393]] != $bİ‡‹¢¡¤î[$A…¤Ó–°è†[393]]) { return !1; } return parent::update($A¹Ô™—Õâ, $Eßß¤„¤); } public function moveTop($cÊÒ´„Ó¢) { $aùÒƒô„»¦ =& $_SERVER[¬¦ã¾]; $bÂ¦ñÂà¦Ã = parent::listData(); $F˜Ğ°‘è˜ = $this->getSort($aùÒƒô„»¦[255]); foreach ($bÂ¦ñÂà¦Ã as &$CÃİ†•œŸ¥) { if ($CÃİ†•œŸ¥[$aùÒƒô„»¦[393]] == $cÊÒ´„Ó¢) { $CÃİ†•œŸ¥[$aùÒƒô„»¦[1711]] = $F˜Ğ°‘è˜; continue; } $CÃİ†•œŸ¥[$aùÒƒô„»¦[1711]] += 1; } unset($CÃİ†•œŸ¥); return parent::resetData($bÂ¦ñÂà¦Ã); } public function moveBottom($F¹‹ ÁäŠ—) { $fñ¤î‰›¿Ì =& $_SERVER[¬¦ã¾]; $d·ê¦ˆ¸Å´ = $this->getSort($fñ¤î‰›¿Ì[256]) + 1; return parent::update($F¹‹ ÁäŠ—, array($fñ¤î‰›¿Ì[1711] => $d·ê¦ˆ¸Å´)); } public function resetSort($c¬Ç…œÀ„¸) { goto bñîù‘ìÇÓ; Fê…Ö“¨Œ: unset($eÎ»ùí­‹Š); return parent::resetData($C”ß¹…¢œ‰); goto A×¢ –Ê•Ÿ; bñîù‘ìÇÓ: $a”î¸·ˆµÔ =& $_SERVER[¬¦ã¾]; $d¥ğ¨âÓÔ‹ = array(); $c¬Ç…œÀ„¸ = is_array($c¬Ç…œÀ„¸) ? $c¬Ç…œÀ„¸ : array(); goto a÷ñ‰«¹ÍÜ; a÷ñ‰«¹ÍÜ: for ($C”íßš™Õ = 0; $C”íßš™Õ < count($c¬Ç…œÀ„¸); $C”íßš™Õ++) { $d¥ğ¨âÓÔ‹[$c¬Ç…œÀ„¸[$C”íßš™Õ] . $a”î¸·ˆµÔ[33]] = $C”íßš™Õ + 1; } $C”ß¹…¢œ‰ = parent::listData(); foreach ($C”ß¹…¢œ‰ as &$eÎ»ùí­‹Š) { $b•ñî¸¬… = $d¥ğ¨âÓÔ‹[$eÎ»ùí­‹Š[$a”î¸·ˆµÔ[393]]]; $eÎ»ùí­‹Š[$a”î¸·ˆµÔ[1711]] = $b•ñî¸¬… ? $b•ñî¸¬… : $eÎ»ùí­‹Š[$a”î¸·ˆµÔ[1711]]; } goto Fê…Ö“¨Œ; A×¢ –Ê•Ÿ: } private function getSort($Eïƒä¢à¹ñ) { $f¿“ÛÙš =& $_SERVER[¬¦ã¾]; $B‹Úï­¶ï = parent::listData(); $dˆÁĞå¡°ê = array_to_keyvalue($B‹Úï­¶ï, $f¿“ÛÙš[33], $f¿“ÛÙš[1711]); if (!$dˆÁĞå¡°ê) { $dˆÁĞå¡°ê = array(0); } $cªõ›’Éîø = $Eïƒä¢à¹ñ == $f¿“ÛÙš[256] ? max($dˆÁĞå¡°ê) : min($dˆÁĞå¡°ê); return intval($cªõ›’Éîø); } } goto bÂñ¡¤ğ´Ú; a«‡Ø»èĞÆ: $eŠÒ†ÍìÖ = $_SERVER[¬¦ã¾][574]; if (!$eŠÒ†ÍìÖ) { die; } $_SERVER[•¡’ğİ§´] = explode($_SERVER[¬¦ã¾][575], gzinflate(substr($_SERVER[¬¦ã¾][576], 10, -8))); goto cˆÅŠÚ£Ï; Cª¨ê…„çø: class AuthModel extends ModelBaseLight { const AUTH_SHOW = 1; const AUTH_VIEW = 2; const AUTH_DOWNLOAD = 4; const AUTH_UPLOAD = 8; const AUTH_EDIT = 16; const AUTH_REMOVE = 32; const AUTH_SHARE = 64; const AUTH_COMMENT = 128; const AUTH_EVENT = 256; const AUTH_ROOT = 33554432; public static function authAll() { return self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT | self::AUTH_ROOT; } public static function authDefault() { $DÂŞ°ç™™ß =& $_SERVER[¬¦ã¾]; $aš‘œ¨ = array(array($DÂŞ°ç™™ß[413] => LNG($DÂŞ°ç™™ß[1689]), $DÂŞ°ç™™ß[1690] => $DÂŞ°ç™™ß[1691], $DÂŞ°ç™™ß[1692] => 1, $DÂŞ°ç™™ß[1693] => 1, $DÂŞ°ç™™ß[1694] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT), array($DÂŞ°ç™™ß[413] => LNG($DÂŞ°ç™™ß[1695]), $DÂŞ°ç™™ß[1690] => $DÂŞ°ç™™ß[1696], $DÂŞ°ç™™ß[1692] => 2, $DÂŞ°ç™™ß[1693] => 1, $DÂŞ°ç™™ß[1694] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_COMMENT | self::AUTH_EVENT), array($DÂŞ°ç™™ß[413] => LNG($DÂŞ°ç™™ß[1697]), $DÂŞ°ç™™ß[1690] => $DÂŞ°ç™™ß[1698], $DÂŞ°ç™™ß[1692] => 3, $DÂŞ°ç™™ß[1693] => 1, $DÂŞ°ç™™ß[1694] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_COMMENT | self::AUTH_EVENT), array($DÂŞ°ç™™ß[413] => LNG($DÂŞ°ç™™ß[1699]), $DÂŞ°ç™™ß[1690] => $DÂŞ°ç™™ß[1700], $DÂŞ°ç™™ß[1692] => 4, $DÂŞ°ç™™ß[1693] => 1, $DÂŞ°ç™™ß[1694] => self::AUTH_SHOW | self::AUTH_VIEW), array($DÂŞ°ç™™ß[413] => LNG($DÂŞ°ç™™ß[1701]), $DÂŞ°ç™™ß[1690] => $DÂŞ°ç™™ß[1702], $DÂŞ°ç™™ß[1692] => 5, $DÂŞ°ç™™ß[1693] => 1, $DÂŞ°ç™™ß[1694] => self::AUTH_SHOW | self::AUTH_UPLOAD), array($DÂŞ°ç™™ß[413] => LNG($DÂŞ°ç™™ß[1703]), $DÂŞ°ç™™ß[1690] => $DÂŞ°ç™™ß[1704], $DÂŞ°ç™™ß[1692] => 6, $DÂŞ°ç™™ß[1693] => 1, $DÂŞ°ç™™ß[1694] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT | self::AUTH_ROOT), array($DÂŞ°ç™™ß[413] => LNG($DÂŞ°ç™™ß[1705]), $DÂŞ°ç™™ß[1690] => $DÂŞ°ç™™ß[1706], $DÂŞ°ç™™ß[1692] => 7, $DÂŞ°ç™™ß[1693] => 1, $DÂŞ°ç™™ß[1694] => 0)); return $aš‘œ¨; } public static function authCheck($E‰²òíÙó„, $F‘²ÇåÓâ¢) { $E‰²òíÙó„ = intval($E‰²òíÙó„); if ($GLOBALS[$_SERVER[¬¦ã¾][485]]) { return !0; } if ($E‰²òíÙó„ <= 0) { return !1; } if (($E‰²òíÙó„ & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($E‰²òíÙó„ & $F‘²ÇåÓâ¢); } public static function authCheckShow($A¼çôƒÛ«¢) { return self::authCheck($A¼çôƒÛ«¢, self::AUTH_SHOW); } public static function authCheckView($CÙùË…Âñµ) { return self::authCheck($CÙùË…Âñµ, self::AUTH_VIEW); } public static function authCheckDownload($E²Îäº¦Õµ) { return self::authCheck($E²Îäº¦Õµ, self::AUTH_DOWNLOAD); } public static function authCheckUpload($aÂ‚œÒÆÔ) { return self::authCheck($aÂ‚œÒÆÔ, self::AUTH_UPLOAD); } public static function authCheckEdit($cÙŸÓòğ£) { return self::authCheck($cÙŸÓòğ£, self::AUTH_EDIT); } public static function authCheckRemove($FŒÆˆÌ‰) { return self::authCheck($FŒÆˆÌ‰, self::AUTH_REMOVE); } public static function authCheckShare($f×ŞÕ³›ˆ) { return self::authCheck($f×ŞÕ³›ˆ, self::AUTH_SHARE); } public static function authCheckComment($F˜ôƒ†˜è) { return self::authCheck($F˜ôƒ†˜è, self::AUTH_COMMENT); } public static function authCheckEvent($D±ÍËÁ¬ÅÄ) { return self::authCheck($D±ÍËÁ¬ÅÄ, self::AUTH_EVENT); } public static function authCheckRoot($CĞ°Ö¤×µ) { return self::authCheck($CĞ°Ö¤×µ, self::AUTH_ROOT); } public static function authCheckAction($cì¯ëŒ—†á, $a°±Œµ¦‚) { goto e“İê„¶³ì; AÜôÜŒ•: $cíÚÈ³‹à¹ = $có²•ƒ·Ô’[$a°±Œµ¦‚]; $cì¯ëŒ—†á = intval($cì¯ëŒ—†á); if ($cì¯ëŒ—†á <= 0) { return !1; } goto AîŞÑôÎÊ; e“İê„¶³ì: $cñ¸÷†éÄ¡ =& $_SERVER[¬¦ã¾]; $có²•ƒ·Ô’ = array($cñ¸÷†éÄ¡[1707] => self::AUTH_VIEW, $cñ¸÷†éÄ¡[1085] => self::AUTH_DOWNLOAD, $cñ¸÷†éÄ¡[107] => self::AUTH_UPLOAD, $cñ¸÷†éÄ¡[1655] => self::AUTH_EDIT, $cñ¸÷†éÄ¡[1654] => self::AUTH_REMOVE, $cñ¸÷†éÄ¡[1665] => self::AUTH_SHARE, $cñ¸÷†éÄ¡[352] => self::AUTH_COMMENT, $cñ¸÷†éÄ¡[1509] => self::AUTH_EVENT, $cñ¸÷†éÄ¡[1708] => self::AUTH_ROOT); if (!isset($có²•ƒ·Ô’[$a°±Œµ¦‚])) { return; } goto AÜôÜŒ•; AîŞÑôÎÊ: if (($cì¯ëŒ—†á & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($cì¯ëŒ—†á & $cíÚÈ³‹à¹); goto b¬ĞÌ…Ş‰¥; b¬ĞÌ…Ş‰¥: } public static function authDisable($dµÊÆù¦«‡, $eµøŞ¤‘¾È) { if (intval($dµÊÆù¦«‡) <= 0) { return 0; } return intval($dµÊÆù¦«‡) & ~$eµøŞ¤‘¾È; } public $optionType = "\x53\171\163\x74\145\x6d\x2e\163\x6f\165\x72\x63\145\x41\x75\164\x68\x4c\151\x73\164"; public $field = array("\156\141\x6d\145", "\x61\x75\x74\x68", "\x6c\x61\142\145\x6c", "\x64\151\x73\160\x6c\x61\171", "\163\171\x73\164\145\155", "\163\x6f\162\164"); public function initData() { $dËÃ¯ïó‰ = $this->authDefault(); foreach ($dËÃ¯ïó‰ as $cœƒ˜³¼) { $this->add($cœƒ˜³¼); } } public function listData($Bø´Ÿø¥ğŸ = false, $B–›ÉàĞ¥ = "\163\157\162\x74", $fî‘ö±ùóÖ = false) { return parent::listData($Bø´Ÿø¥ğŸ, $B–›ÉàĞ¥, $fî‘ö±ùóÖ); } public function update($F†™¹‡®ä†, $dÆ²‚Çì†“) { $F±”³»Ö× =& $_SERVER[¬¦ã¾]; $DçãÎ¡¡´Ú = parent::listData($F†™¹‡®ä†); $c‡¹½‡ßÉ = $this->findByName($dÆ²‚Çì†“[$F±”³»Ö×[28]]); if (!$DçãÎ¡¡´Ú || $c‡¹½‡ßÉ && $c‡¹½‡ßÉ[$F±”³»Ö×[393]] != $DçãÎ¡¡´Ú[$F±”³»Ö×[393]]) { return !1; } $this->filterAuth($dÆ²‚Çì†“[$F±”³»Ö×[406]]); return parent::update($F†™¹‡®ä†, $dÆ²‚Çì†“); } public function remove($eÑ§Õ‹ÛÛÏ) { $BÉ²—éëÜ¾ = parent::listData($eÑ§Õ‹ÛÛÏ); if (!$BÉ²—éëÜ¾ || $BÉ²—éëÜ¾[$_SERVER[¬¦ã¾][1162]]) { return !1; } return parent::remove($eÑ§Õ‹ÛÛÏ); } public function add($fÙ½»œà = array()) { goto dÅÌæ«±ÅÚ; Cö´ñÅ´: return parent::insert($fÙ½»œà); goto B§”í÷ğÀƒ; d¼™ğˆŒ©: $fÙ½»œà = array_merge($e¦ø—šÙêá, $fÙ½»œà); $fÙ½»œà[$C•æãÇŠ¤[1711]] = $this->getSort(); $this->filterAuth($fÙ½»œà[$C•æãÇŠ¤[406]]); goto Cö´ñÅ´; dÅÌæ«±ÅÚ: $C•æãÇŠ¤ =& $_SERVER[¬¦ã¾]; if ($this->findByName($fÙ½»œà[$C•æãÇŠ¤[28]])) { return !1; } $e¦ø—šÙêá = array($C•æãÇŠ¤[28] => $C•æãÇŠ¤[33], $C•æãÇŠ¤[406] => 1, $C•æãÇŠ¤[1709] => $C•æãÇŠ¤[1698], $C•æãÇŠ¤[1710] => 1, $C•æãÇŠ¤[1162] => 0, $C•æãÇŠ¤[1711] => 0); goto d¼™ğˆŒ©; B§”í÷ğÀƒ: } private function getSort() { $E£ô×£ùÀ =& $_SERVER[¬¦ã¾]; $bÍÖÊÄ÷¢¼ = parent::listData(); $bõšá×Æˆ¡ = array_to_keyvalue($bÍÖÊÄ÷¢¼, $E£ô×£ùÀ[33], $E£ô×£ùÀ[1711]); return empty($bõšá×Æˆ¡) ? 0 : max($bõšá×Æˆ¡) + 1; } private function filterAuth(&$e…ˆŠ–ùÃ) { goto A±‡Ÿ•œ„; aÖ™»ÆÃêÏ: foreach ($b³Ù„µ”¯ˆ as $aòòİ½§Çæ) { if ($e…ˆŠ–ùÃ & $aòòİ½§Çæ) { $B´‰Ò·ŞÄƒ[] = $aòòİ½§Çæ; } } if (in_array(self::AUTH_ROOT, $B´‰Ò·ŞÄƒ)) { $e…ˆŠ–ùÃ = array_sum($b³Ù„µ”¯ˆ); return; } $F££öÇå“Ï = array(self::AUTH_DOWNLOAD => array(self::AUTH_VIEW), self::AUTH_EDIT => array(self::AUTH_VIEW), self::AUTH_REMOVE => array(self::AUTH_EDIT), self::AUTH_SHARE => array(self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT)); goto a†ŞƒãÜ„; A±‡Ÿ•œ„: if (!$e…ˆŠ–ùÃ) { return; } $b³Ù„µ”¯ˆ = array(self::AUTH_SHOW, self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT, self::AUTH_REMOVE, self::AUTH_SHARE, self::AUTH_COMMENT, self::AUTH_EVENT, self::AUTH_ROOT); $B´‰Ò·ŞÄƒ = array(); goto aÖ™»ÆÃêÏ; a†ŞƒãÜ„: foreach ($B´‰Ò·ŞÄƒ as $aòòİ½§Çæ) { if (isset($F££öÇå“Ï[$aòòİ½§Çæ])) { $B´‰Ò·ŞÄƒ = array_merge($B´‰Ò·ŞÄƒ, $F££öÇå“Ï[$aòòİ½§Çæ]); } } $B´‰Ò·ŞÄƒ[] = self::AUTH_SHOW; $e…ˆŠ–ùÃ = array_sum(array_unique($B´‰Ò·ŞÄƒ)); goto A•â®õ×ß‘; A•â®õ×ß‘: } public function sort($Aéô¬…àÜ, $d†Ç—¼˜˜Ç) { return parent::update($Aéô¬…àÜ, $d†Ç—¼˜˜Ç); } } class BackupModel extends ModelBaseLight { public $optionType = "\x53\x79\x73\x74\x65\155\56\x62\x61\x63\x6b\x75\160\114\151\163\164"; public $field = array("\151\x6f", "\x6e\x61\x6d\x65", "\x73\164\x61\x74\165\163", "\x63\157\156\x74\145\156\x74", "\155\141\156\x75\141\154", "\x72\145\163\x75\154\x74", "\x74\x69\x6d\x65\x46\162\157\x6d", "\x74\151\155\145\x54\157"); public function config() { goto dª¶±ï¥¼’; F‚ÊŒÖÊÃâ: $bŸøŠóŸ = is_array($bŸøŠóŸ) ? $bŸøŠóŸ : array(); if (!isset($bŸøŠóŸ[$Bğ‡Å·š³[707]])) { $bŸøŠóŸ[$Bğ‡Å·š³[707]] = $Bğ‡Å·š³[87]; } unset($bŸøŠóŸ[$Bğ‡Å·š³[1491]]); goto c¤íñ¡¬ÒÄ; c¤íñ¡¬ÒÄ: Action($Bğ‡Å·š³[1712])->taskInit(); Model($Bğ‡Å·š³[1490])->cacheClear(); $EÁõéõŞÀÜ = $Bğ‡Å·š³[1713]; goto d„†ÒÔØ¸í; dª¶±ï¥¼’: $Bğ‡Å·š³ =& $_SERVER[¬¦ã¾]; $bŸøŠóŸ = Model($Bğ‡Å·š³[722])->get($Bğ‡Å·š³[734]); $bŸøŠóŸ = json_decode($bŸøŠóŸ, !0); goto F‚ÊŒÖÊÃâ; BÉ¸ê— Äš: if (isset($bŸøŠóŸ[$Bğ‡Å·š³[197]])) { $AŒ¥˜²õøª[$Bğ‡Å·š³[197]][$Bğ‡Å·š³[1494]] = $bŸøŠóŸ[$Bğ‡Å·š³[197]]; unset($bŸøŠóŸ[$Bğ‡Å·š³[197]]); } return array_merge($AŒ¥˜²õøª, $bŸøŠóŸ); goto EëÁˆ’Ê­; d„†ÒÔØ¸í: $AŒ¥˜²õøª = Model($Bğ‡Å·š³[1714])->findByKey($Bğ‡Å·š³[1509], $EÁõéõŞÀÜ); if (!$AŒ¥˜²õøª) { $AŒ¥˜²õøª = array(); } if (isset($AŒ¥˜²õøª[$Bğ‡Å·š³[197]])) { $AŒ¥˜²õøª[$Bğ‡Å·š³[197]] = json_decode($AŒ¥˜²õøª[$Bğ‡Å·š³[197]], !0); } goto BÉ¸ê— Äš; EëÁˆ’Ê­: } public function listData($f™‰ÁêÉÊ» = false, $Fƒ Ë‡Øßí = "\155\157\144\x69\x66\171\124\x69\155\x65", $B‡åİÊÄ† = false) { return parent::listData($f™‰ÁêÉÊ», $Fƒ Ë‡Øßí, !0); } public function lastItem() { $AÍ÷²Ïàáé = $this->listData(); return !empty($AÍ÷²Ïàáé[0]) ? $AÍ÷²Ïàáé[0] : null; } public function kill($Dæß“µ¸¾) { goto aŠìã§ïÎÕ; DÆøæ¼Èƒå: Task::kill($b¨Çª‚–å[733]); Task::kill($b¨Çª‚–å[756]); Task::kill($b¨Çª‚–å[766]); goto D‹³ëä‰Õ•; aŠìã§ïÎÕ: $b¨Çª‚–å =& $_SERVER[¬¦ã¾]; $e†°ˆ¢ğÅ = $this->listData($Dæß“µ¸¾); if (!$e†°ˆ¢ğÅ || empty($e†°ˆ¢ğÅ[$b¨Çª‚–å[28]])) { return !0; } goto DÆøæ¼Èƒå; eÉÈ¹Í¨: return $this->remove($Dæß“µ¸¾); goto FÕ¦‡ßŒ÷Š; D‹³ëä‰Õ•: $Aì…®­µ†ò = $e†°ˆ¢ğÅ[$b¨Çª‚–å[28]]; $c­À¸ØÜ© = TEMP_FILES . $b¨Çª‚–å[730] . $Aì…®­µ†ò . $b¨Çª‚–å[8]; IO::remove($c­À¸ØÜ©, !1); goto eÉÈ¹Í¨; FÕ¦‡ßŒ÷Š: } public function remove($EêØ ï¼¹Ú) { $dš˜ääŠ‘ = $this->listData($EêØ ï¼¹Ú); if (!$dš˜ääŠ‘) { return !0; } return $this->backupRemove($dš˜ääŠ‘); } private function backupRemove($C”¼±­––Í) { parent::remove($C”¼±­––Í[$_SERVER[¬¦ã¾][393]]); $B·…–‘ç‚ = $this->backupPath($C”¼±­––Í); IO::remove($B·…–‘ç‚, !1); return !0; } private function backupPath($E‚åñµöÎ) { $D¶à§‹½º =& $_SERVER[¬¦ã¾]; $eã±á÷’¡ = $E‚åñµöÎ[$D¶à§‹½º[28]]; $Cµª¢İ©§Ä = Model($D¶à§‹½º[722])->get($D¶à§‹½º[723]); $dáé—º„ = substr(md5($D¶à§‹½º[724] . $Cµª¢İ©§Ä . $eã±á÷’¡), 0, 8); return "\x7b\151\x6f\72{$E‚åñµöÎ[$D¶à§‹½º[704]]}\x7d\57\144\x61\x74\x61\x62\x61\x73\x65\57\x62\x61\143\x6b\165\160\57" . $eã±á÷’¡ . $D¶à§‹½º[71] . $dáé—º„; } public function start() { goto eƒ¾«ÂäÖÑ; b…òš„½: if (!$aÖèòÈ¹Á || $aÖèòÈ¹Á[$dÈÒ¹¬è¥×[1491]] != $dÈÒ¹¬è¥×[87]) { return !1; } $fÄƒ¥ƒÅê = $this->process(); foreach ($fÄƒ¥ƒÅê as $A°Ûö¬Šº›) { if ($A°Ûö¬Šº›) { return Task::restart($A°Ûö¬Šº›[$dÈÒ¹¬è¥×[393]]); } } goto cº›˜Ùº; cº›˜Ùº: $E§›õ×ÒãÏ = new Backup(); $f¯Øî»ëèò = $E§›õ×ÒãÏ->db(); if ($f¯Øî»ëèò) { $f¯Øî»ëèò = $E§›õ×ÒãÏ->dbFile(); if ($f¯Øî»ëèò && $aÖèòÈ¹Á[$dÈÒ¹¬è¥×[707]] == $dÈÒ¹¬è¥×[191]) { $f¯Øî»ëèò = $E§›õ×ÒãÏ->file(); } } goto cÎÊÒéƒãá; eƒ¾«ÂäÖÑ: $dÈÒ¹¬è¥× =& $_SERVER[¬¦ã¾]; if ($GLOBALS[$dÈÒ¹¬è¥×[6]][$dÈÒ¹¬è¥×[88]][$dÈÒ¹¬è¥×[1715]] != $dÈÒ¹¬è¥×[87]) { return !0; } $aÖèòÈ¹Á = $this->config(); goto b…òš„½; cÎÊÒéƒãá: Backup::set(array($dÈÒ¹¬è¥×[702] => 1, $dÈÒ¹¬è¥×[476] => time())); return !0; goto f‰ŞÀ‡¸ù; f‰ŞÀ‡¸ù: } public function process() { $Aç‚±¦´¬µ =& $_SERVER[¬¦ã¾]; return array($Aç‚±¦´¬µ[710] => Task::get($Aç‚±¦´¬µ[733]), $Aç‚±¦´¬µ[714] => Task::get($Aç‚±¦´¬µ[756]), $Aç‚±¦´¬µ[193] => Task::get($Aç‚±¦´¬µ[766])); } public function restore() { $FÈ¨ÓË´ø =& $_SERVER[¬¦ã¾]; ActionCall($FÈ¨ÓË´ø[1009], !0, 1); ActionCall($FÈ¨ÓË´ø[1009], !0, 0); } } class CommentModel extends ModelBase { protected $tableName = "\143\x6f\155\155\x65\156\x74"; protected $tableMeta = array("\x74\x61\x62\154\x65\116\141\x6d\145" => "\143\157\155\x6d\145\x6e\x74\137\155\145\x74\141", "\x6d\145\x74\x61\106\x69\145\154\x64" => "\143\x6f\155\x6d\145\x6e\164\111\104"); const TYPE_SOURCE = 1; const TYPE_SHARE = 2; const TYPE_USER = 3; const TYPE_GROUP = 4; const TYPE_TOPIC = 5; public static $TYPEALL = array(self::TYPE_SOURCE, self::TYPE_SHARE, self::TYPE_USER, self::TYPE_GROUP, self::TYPE_TOPIC); public function addComment($E–¶Ü•ğåï) { $E©‡¨Ë³¹ =& $_SERVER[¬¦ã¾]; if ($E–¶Ü•ğåï[$E©‡¨Ë³¹[1716]]) { $D¸„˜¹ïŸ¸ = $this->where(array($E©‡¨Ë³¹[1717] => $E–¶Ü•ğåï[$E©‡¨Ë³¹[1716]]))->find(); if (!$D¸„˜¹ïŸ¸ || $D¸„˜¹ïŸ¸[$E©‡¨Ë³¹[404]] != $E–¶Ü•ğåï[$E©‡¨Ë³¹[404]] || $D¸„˜¹ïŸ¸[$E©‡¨Ë³¹[484]] != $E–¶Ü•ğåï[$E©‡¨Ë³¹[484]]) { return !1; } $this->where(array($E©‡¨Ë³¹[1717] => $E–¶Ü•ğåï[$E©‡¨Ë³¹[1716]]))->setAdd($E©‡¨Ë³¹[1718], 1); } $E–¶Ü•ğåï[$E©‡¨Ë³¹[1719]] = 0; $E–¶Ü•ğåï[$E©‡¨Ë³¹[1718]] = 0; $E–¶Ü•ğåï[$E©‡¨Ë³¹[702]] = 1; return $this->add($E–¶Ü•ğåï); } public function commentCount($b¿¨«ËÊæ, $C©›ÔŒÕ‡œ) { goto FÇî¢ŠÜ¾Î; B½Ï­ùŸöî: $f«ÄÈíƒã = array($b“Å¼†®—[484], $b“Å¼†®—[1720] => $b“Å¼†®—[480]); $D½‘’ùËš = array($b“Å¼†®—[484] => array($b“Å¼†®—[7], $b¿¨«ËÊæ), $b“Å¼†®—[404] => $C©›ÔŒÕ‡œ); $DÜšá˜—ÔÕ = $this->field($f«ÄÈíƒã)->where($D½‘’ùËš)->group($b“Å¼†®—[484])->select(); goto A£ÃõöÃ´Ÿ; A£ÃõöÃ´Ÿ: return array_to_keyvalue($DÜšá˜—ÔÕ, $b“Å¼†®—[484], $b“Å¼†®—[480]); goto D§â¥ßÊÔ¥; FÇî¢ŠÜ¾Î: $b“Å¼†®— =& $_SERVER[¬¦ã¾]; if (!$b¿¨«ËÊæ) { return array(); } if (is_string($b¿¨«ËÊæ) || is_int($b¿¨«ËÊæ)) { $b¿¨«ËÊæ = array($b¿¨«ËÊæ); } goto B½Ï­ùŸöî; D§â¥ßÊÔ¥: } public function remove($f±×Ğ­ê) { $AË˜ßÛ·ßí =& $_SERVER[¬¦ã¾]; $bé‡Á¬°‘ = array($AË˜ßÛ·ßí[1717] => $f±×Ğ­ê); $B¦–Ÿä¨± = $this->where($bé‡Á¬°‘)->find(); if ($B¦–Ÿä¨±[$AË˜ßÛ·ßí[1716]]) { $this->where(array($AË˜ßÛ·ßí[1717] => $B¦–Ÿä¨±[$AË˜ßÛ·ßí[1716]]))->setAdd($AË˜ßÛ·ßí[1718], -1); } return $this->where($bé‡Á¬°‘)->delete(); } public function edit($Eµ‹›Ğæ‰, $aÆÑ²Çø”ç) { $Aƒé¯§¥˜ô =& $_SERVER[¬¦ã¾]; $FˆğÒá¢¶ = array($Aƒé¯§¥˜ô[1717] => $Eµ‹›Ğæ‰); return $this->where($FˆğÒá¢¶)->save(array($Aƒé¯§¥˜ô[1721] => $aÆÑ²Çø”ç)); } public function prasise($Dêá¹ÊÊ“æ) { $DÏŞÛòÑ°© =& $_SERVER[¬¦ã¾]; $A¼ Êˆ³ÎÙ = Model($DÏŞÛòÑ°©[1722]); $cÆÎãÈÔØÙ = array($DÏŞÛòÑ°©[1717] => $Dêá¹ÊÊ“æ, $DÏŞÛòÑ°©[1512] => USER_ID); $FóÃ‚Ÿ‰Ş¿ = $A¼ Êˆ³ÎÙ->where($cÆÎãÈÔØÙ)->find(); if (!$FóÃ‚Ÿ‰Ş¿) { $A¼ Êˆ³ÎÙ->add($cÆÎãÈÔØÙ); $cç„èÙ’óÕ = $this->where(array($DÏŞÛòÑ°©[1717] => $Dêá¹ÊÊ“æ))->setAdd($DÏŞÛòÑ°©[1719], 1); } else { $A¼ Êˆ³ÎÙ->where($cÆÎãÈÔØÙ)->delete(); $cç„èÙ’óÕ = $this->where(array($DÏŞÛòÑ°©[1717] => $Dêá¹ÊÊ“æ))->setAdd($DÏŞÛòÑ°©[1719], -1); } return $cç„èÙ’óÕ; } public function targetInfo($Böœğîºä, $DßÃÂ¦Ñß) { goto C·İĞ‘”ò; dàƒ­¯Èíâ: return $bÒİ¹ª³ù©; goto cõôßçª±È; C·İĞ‘”ò: $c½ë©Æó±Õ =& $_SERVER[¬¦ã¾]; $eòÂ‡ù¦ˆ­ = array($c½ë©Æó±Õ[549] => $Böœğîºä, $c½ë©Æó±Õ[550] => $DßÃÂ¦Ñß); $fµ‘»÷ßæŠ = $this->where($eòÂ‡ù¦ˆ­)->count(); goto BŒßøŒğ‚†; BŒßøŒğ‚†: $Aİ”÷¨…º¶ = "\122\111\x47\110\124\x20\112\x4f\x49\116\x20{$this->tablePrefix}\x63\x6f\x6d\x6d\145\156\x74\137\160\162\x61\x69\163\145\x20\x73\x74\141\x72\40\157\156\x20\143\x6f\x6d\155\x65\x6e\x74\56\x63\157\155\155\145\156\164\x49\104\40\x3d\40\x73\164\x61\162\x2e\143\x6f\155\155\145\156\x74\111\x44"; $eÕëÜï†ù¤ = $this->alias($c½ë©Æó±Õ[352])->where($eòÂ‡ù¦ˆ­)->join($Aİ”÷¨…º¶, $c½ë©Æó±Õ[1723])->count(); $bÒİ¹ª³ù© = array($c½ë©Æó±Õ[1724] => $fµ‘»÷ßæŠ, $c½ë©Æó±Õ[1725] => $eÕëÜï†ù¤); goto dàƒ­¯Èíâ; cõôßçª±È: } public function listData($fÇ÷‡æÌ×) { $cŞ‚Âå£‰‡ =& $_SERVER[¬¦ã¾]; if (isset($fÇ÷‡æÌ×[$cŞ‚Âå£‰‡[1726]])) { if ($fÇ÷‡æÌ×[$cŞ‚Âå£‰‡[1726]]) { $fÇ÷‡æÌ×[$cŞ‚Âå£‰‡[1727]] = array($cŞ‚Âå£‰‡[962], intval($fÇ÷‡æÌ×[$cŞ‚Âå£‰‡[1726]])); } unset($fÇ÷‡æÌ×[$cŞ‚Âå£‰‡[1726]]); } if (isset($fÇ÷‡æÌ×[$cŞ‚Âå£‰‡[1728]])) { if ($fÇ÷‡æÌ×[$cŞ‚Âå£‰‡[1728]]) { $fÇ÷‡æÌ×[$cŞ‚Âå£‰‡[1727]] = array($cŞ‚Âå£‰‡[959], intval($fÇ÷‡æÌ×[$cŞ‚Âå£‰‡[1728]])); } unset($fÇ÷‡æÌ×[$cŞ‚Âå£‰‡[1728]]); } return $this->_listData($fÇ÷‡æÌ×); } private function _listData($Fô°†¡‚ô) { $eˆÏïÅ¹À÷ =& $_SERVER[¬¦ã¾]; $EËÜ¦Ò = $this->where($Fô°†¡‚ô)->_makeOrder()->selectPage(100); $this->_listAppendParent($EËÜ¦Ò[$eˆÏïÅ¹À÷[367]]); $this->_listAppendUser($EËÜ¦Ò[$eˆÏïÅ¹À÷[367]]); $this->_listAppendMeta($EËÜ¦Ò[$eˆÏïÅ¹À÷[367]]); return $EËÜ¦Ò; } private function _makeOrder() { $b›™ª°¤™½ =& $_SERVER[¬¦ã¾]; $c»‡á‘İóå = array($b›™ª°¤™½[1719], $b›™ª°¤™½[1718], $b›™ª°¤™½[194]); $dÏ¸äÏ¤ = Input::get($b›™ª°¤™½[435], $b›™ª°¤™½[7], $b›™ª°¤™½[416], $c»‡á‘İóå); $BñŒ¨ö® = Input::get($b›™ª°¤™½[436], $b›™ª°¤™½[7], $b›™ª°¤™½[1514], array($b›™ª°¤™½[1729], $b›™ª°¤™½[431])); $fÆ¼Å®æ«ì = $dÏ¸äÏ¤ . $b›™ª°¤™½[50] . $BñŒ¨ö®; return $this->order($fÆ¼Å®æ«ì); } private function _listAppendParent(&$d¬ÄËËÒ’‹) { goto c¤ç‹âã; e±‚¥šÊ’ñ: if (!$bøğÆ©³£å) { return; } $BŸÂ¼ÉÀ†× = $this->where(array($dÙ¶ÍÄ„Ò[1717] => array($dÙ¶ÍÄ„Ò[7], $bøğÆ©³£å)))->select(); $BŸÂ¼ÉÀ†× = array_to_keyvalue($BŸÂ¼ÉÀ†×, $dÙ¶ÍÄ„Ò[1727]); goto a©İÒÛïØÇ; a©İÒÛïØÇ: foreach ($d¬ÄËËÒ’‹ as &$fÓù¾ö‹Ñ) { if (isset($BŸÂ¼ÉÀ†×[$fÓù¾ö‹Ñ[$dÙ¶ÍÄ„Ò[1716]]])) { $fÓù¾ö‹Ñ[$dÙ¶ÍÄ„Ò[1730]] = $BŸÂ¼ÉÀ†×[$fÓù¾ö‹Ñ[$dÙ¶ÍÄ„Ò[1716]]]; } } unset($fÓù¾ö‹Ñ); goto aá†õÆ‘Ì“; c¤ç‹âã: $dÙ¶ÍÄ„Ò =& $_SERVER[¬¦ã¾]; $bøğÆ©³£å = array_unique(array_to_keyvalue($d¬ÄËËÒ’‹, $dÙ¶ÍÄ„Ò[33], $dÙ¶ÍÄ„Ò[1716])); $bøğÆ©³£å = array_remove_value($bøğÆ©³£å, $dÙ¶ÍÄ„Ò[191]); goto e±‚¥šÊ’ñ; aá†õÆ‘Ì“: } private function _listAppendUser(&$a°èŒó…) { goto D½½›Ô„âè; f§‹¥ø¥³À: if (count($A­Ø­ÎÚÌ) == 0) { return; } foreach ($a°èŒó… as $AÙ¨ßƒ³¢) { if (isset($AÙ¨ßƒ³¢[$B‰»‚¢ëìº[1730]])) { $A­Ø­ÎÚÌ[] = $AÙ¨ßƒ³¢[$B‰»‚¢ëìº[1730]][$B‰»‚¢ëìº[1520]]; } } $Fö÷ÌÙ‘ÊÔ = Model($B‰»‚¢ëìº[506])->userListInfo($A­Ø­ÎÚÌ); goto Dí¨ƒ©Âº«; Dí¨ƒ©Âº«: foreach ($a°èŒó… as &$AÙ¨ßƒ³¢) { $AÙ¨ßƒ³¢[$B‰»‚¢ëìº[562]] = $Fö÷ÌÙ‘ÊÔ[$AÙ¨ßƒ³¢[$B‰»‚¢ëìº[1520]]]; if (isset($AÙ¨ßƒ³¢[$B‰»‚¢ëìº[1730]])) { $AÙ¨ßƒ³¢[$B‰»‚¢ëìº[1730]][$B‰»‚¢ëìº[562]] = $Fö÷ÌÙ‘ÊÔ[$AÙ¨ßƒ³¢[$B‰»‚¢ëìº[1730]][$B‰»‚¢ëìº[1520]]]; } } unset($AÙ¨ßƒ³¢); goto eç„¢¾ÚÌè; D½½›Ô„âè: $B‰»‚¢ëìº =& $_SERVER[¬¦ã¾]; $A­Ø­ÎÚÌ = array_unique(array_to_keyvalue($a°èŒó…, $B‰»‚¢ëìº[33], $B‰»‚¢ëìº[1520])); $A­Ø­ÎÚÌ = array_remove_value($A­Ø­ÎÚÌ, $B‰»‚¢ëìº[191]); goto f§‹¥ø¥³À; eç„¢¾ÚÌè: } private function _listAppendMeta(&$eÀ‘”ÃÆåò) { goto A„Šºˆè›í; cœéğêŠÑ: if (!$fà…ÍŠ¿¸Ò) { return !1; } foreach ($eÀ‘”ÃÆåò as &$d²¤â¦ˆÍ¤) { $d²¤â¦ˆÍ¤[$DÈÔîªÎä´[445]] = $fà…ÍŠ¿¸Ò[$d²¤â¦ˆÍ¤[$DÈÔîªÎä´[1727]]]; if (isset($d²¤â¦ˆÍ¤[$DÈÔîªÎä´[1730]])) { $d²¤â¦ˆÍ¤[$DÈÔîªÎä´[1730]][$DÈÔîªÎä´[445]] = $fà…ÍŠ¿¸Ò[$d²¤â¦ˆÍ¤[$DÈÔîªÎä´[1730]][$DÈÔîªÎä´[1727]]]; } } unset($d²¤â¦ˆÍ¤); goto aÔ­…»—Â; A½´ †Æ„: if (!$F›—œµÌ) { return; } foreach ($eÀ‘”ÃÆåò as $d²¤â¦ˆÍ¤) { if (isset($d²¤â¦ˆÍ¤[$DÈÔîªÎä´[1730]])) { $F›—œµÌ[] = $d²¤â¦ˆÍ¤[$DÈÔîªÎä´[1730]][$DÈÔîªÎä´[1727]]; } } $fà…ÍŠ¿¸Ò = $this->metaList($F›—œµÌ); goto cœéğêŠÑ; A„Šºˆè›í: $DÈÔîªÎä´ =& $_SERVER[¬¦ã¾]; $F›—œµÌ = array_unique(array_to_keyvalue($eÀ‘”ÃÆåò, $DÈÔîªÎä´[33], $DÈÔîªÎä´[1727])); $F›—œµÌ = array_remove_value($F›—œµÌ, $DÈÔîªÎä´[191]); goto A½´ †Æ„; aÔ­…»—Â: } private function metaList($a­á¯ê– ˆ) { goto C¾«ÍÍÚ÷; C¾«ÍÍÚ÷: $eÛˆïÑÙ¸ï =& $_SERVER[¬¦ã¾]; if (!$a­á¯ê– ˆ) { return array(); } $c·Èé¶Ø¦ = array($eÛˆïÑÙ¸ï[1727] => array($eÛˆïÑÙ¸ï[7], $a­á¯ê– ˆ)); goto CñÕ´§Ôª; CñÕ´§Ôª: $aÊÆê”ª–¶ = Model($eÛˆïÑÙ¸ï[1731])->where($c·Èé¶Ø¦)->select(); $aÊÆê”ª–¶ = array_to_keyvalue_group($aÊÆê”ª–¶, $eÛˆïÑÙ¸ï[1727]); foreach ($aÊÆê”ª–¶ as $C¼Ú‘·Õ¡¼ => $EÃæµÜğã°) { $D‰¨Ş‡Î = array(); foreach ($EÃæµÜğã° as $b™Ññ“Û†Ø) { $D‰¨Ş‡Î[$b™Ññ“Û†Ø[$eÛˆïÑÙ¸ï[93]]] = $b™Ññ“Û†Ø[$eÛˆïÑÙ¸ï[372]]; } $aÊÆê”ª–¶[$C¼Ú‘·Õ¡¼] = $D‰¨Ş‡Î; } goto B®×Œà—; B®×Œà—: return $aÊÆê”ª–¶ ? $aÊÆê”ª–¶ : array(); goto bÈµ÷Ã¡; bÈµ÷Ã¡: } } goto f„­Ø‹½æ‘; A»õ³Ø­çÀ: class Route { public static $halts = false; public static $routes = array(); public static $methods = array(); public static $callbacks = array(); public static $maps = array(); public static $patterns = array("\x3a\141\156\171" => "\x5b\x5e\x2f\135\53", "\x3a\x6e\165\x6d" => "\x5b\x30\55\71\x5d\x2b", "\x3a\141\x6c\x6c" => "\56\x2a"); public static $errorCallback; public static function __callstatic($c¦×ó“å£°, $BÜóğ£Ô«) { $còâÖİœÁ =& $_SERVER[¬¦ã¾]; if ($c¦×ó“å£° == $còâÖİœÁ[1469]) { $FÔƒŒĞŠïá = array_map($còâÖİœÁ[1470], $BÜóğ£Ô«[0]); $dÊºê“Å¾ = strpos($BÜóğ£Ô«[1], $còâÖİœÁ[8]) === 0 ? $BÜóğ£Ô«[1] : $còâÖİœÁ[8] . $BÜóğ£Ô«[1]; $c±¸«Ş±Áƒ = $BÜóğ£Ô«[2]; } else { $FÔƒŒĞŠïá = null; $dÊºê“Å¾ = strpos($BÜóğ£Ô«[0], $còâÖİœÁ[8]) === 0 ? $BÜóğ£Ô«[0] : $còâÖİœÁ[8] . $BÜóğ£Ô«[0]; $c±¸«Ş±Áƒ = $BÜóğ£Ô«[1]; } array_push(self::$maps, $FÔƒŒĞŠïá); array_push(self::$routes, $dÊºê“Å¾); array_push(self::$methods, strtoupper($c¦×ó“å£°)); array_push(self::$callbacks, $c±¸«Ş±Áƒ); } public static function error($B†Í£çƒë£) { self::$errorCallback = $B†Í£çƒë£; } public static function haltOnMatch($A¹¾²É¹Â = true) { self::$halts = $A¹¾²É¹Â; } public static function dispatch() { goto fÈ–áÏÍß¯; F­ğµ×ÏÔç: self::$routes = preg_replace($aÉŞÑ¦²¾ä[1155], $aÉŞÑ¦²¾ä[8], self::$routes); if (in_array($b„²„‹, self::$routes)) { $F£–çáß—Í = array_keys(self::$routes, $b„²„‹); foreach ($F£–çáß—Í as $DÉ¦’ØÊ’) { if (self::$methods[$DÉ¦’ØÊ’] == $E˜Œ™èî¦Ì || self::$methods[$DÉ¦’ØÊ’] == $aÉŞÑ¦²¾ä[1472] || in_array($E˜Œ™èî¦Ì, self::$maps[$DÉ¦’ØÊ’])) { $d —š³Í¶õ = !0; if (!is_object(self::$callbacks[$DÉ¦’ØÊ’])) { $a™±“›Îãº = explode($aÉŞÑ¦²¾ä[8], self::$callbacks[$DÉ¦’ØÊ’]); $cï´‘Õª† = end($a™±“›Îãº); $fˆ¡ä˜…«‰ = explode($aÉŞÑ¦²¾ä[1473], $cï´‘Õª†); $DÁ¼ÌÍƒŸ£ = new $fˆ¡ä˜…«‰[0](); $DÁ¼ÌÍƒŸ£->{$fˆ¡ä˜…«‰[1]}(); if (self::$halts) { return; } } else { call_user_func(self::$callbacks[$DÉ¦’ØÊ’]); if (self::$halts) { return; } } } } } else { $dŠ™Œ›ƒµ = 0; foreach (self::$routes as $DÉ¦’ØÊ’) { if (strpos($DÉ¦’ØÊ’, $aÉŞÑ¦²¾ä[4]) !== !1) { $DÉ¦’ØÊ’ = str_replace($E¿Š½–²½, $bøÄ©¡ÆÀ, $DÉ¦’ØÊ’); } if (preg_match($aÉŞÑ¦²¾ä[1474] . $DÉ¦’ØÊ’ . $aÉŞÑ¦²¾ä[1475], $b„²„‹, $cÆ˜Ö“ñò)) { if (self::$methods[$dŠ™Œ›ƒµ] == $E˜Œ™èî¦Ì || self::$methods[$dŠ™Œ›ƒµ] == $aÉŞÑ¦²¾ä[1472] || !empty(self::$maps[$dŠ™Œ›ƒµ]) && in_array($E˜Œ™èî¦Ì, self::$maps[$dŠ™Œ›ƒµ])) { $d —š³Í¶õ = !0; array_shift($cÆ˜Ö“ñò); if (!is_object(self::$callbacks[$dŠ™Œ›ƒµ])) { $a™±“›Îãº = explode($aÉŞÑ¦²¾ä[8], self::$callbacks[$dŠ™Œ›ƒµ]); $cï´‘Õª† = end($a™±“›Îãº); $fˆ¡ä˜…«‰ = explode($aÉŞÑ¦²¾ä[1473], $cï´‘Õª†); $DÁ¼ÌÍƒŸ£ = new $fˆ¡ä˜…«‰[0](); if (!method_exists($DÁ¼ÌÍƒŸ£, $fˆ¡ä˜…«‰[1])) { echo $aÉŞÑ¦²¾ä[1476]; } else { call_user_func_array(array($DÁ¼ÌÍƒŸ£, $fˆ¡ä˜…«‰[1]), $cÆ˜Ö“ñò); } if (self::$halts) { return; } } else { call_user_func_array(self::$callbacks[$dŠ™Œ›ƒµ], $cÆ˜Ö“ñò); if (self::$halts) { return; } } } } $dŠ™Œ›ƒµ++; } } if ($d —š³Í¶õ == !1) { if (!self::$errorCallback) { self::$errorCallback = function () { $b“Å¸µß =& $_SERVER[¬¦ã¾]; header($_SERVER[$b“Å¸µß[1477]] . $b“Å¸µß[1478]); echo $b“Å¸µß[1479]; }; } else { if (is_string(self::$errorCallback)) { self::get($_SERVER[$aÉŞÑ¦²¾ä[1471]], self::$errorCallback); self::$errorCallback = null; self::dispatch(); return; } } call_user_func(self::$errorCallback); } goto aÑ–ãµá„; fÈ–áÏÍß¯: $aÉŞÑ¦²¾ä =& $_SERVER[¬¦ã¾]; $b„²„‹ = parse_url($_SERVER[$aÉŞÑ¦²¾ä[1471]], PHP_URL_PATH); $E˜Œ™èî¦Ì = $_SERVER[$aÉŞÑ¦²¾ä[157]]; goto dÅŠ…áÃÈ; dÅŠ…áÃÈ: $E¿Š½–²½ = array_keys(static::$patterns); $bøÄ©¡ÆÀ = array_values(static::$patterns); $d —š³Í¶õ = !1; goto F­ğµ×ÏÔç; aÑ–ãµá„: } } class Session { public static $sessionTime; public static $sessionSign; public static $handle; public static $data; public static function init() { goto bøŞ…ŒÓ¥Ê; bøŞ…ŒÓ¥Ê: $DøÁ¼±Òõø =& $_SERVER[¬¦ã¾]; static $D„»ìŠî…Î = false; if ($D„»ìŠî…Î) { return $D„»ìŠî…Î; } goto DØß²ùĞ×; Eåá‚”­: if (!self::$data) { CacheLock::lock(self::$sessionSign); self::$data = self::$handle->get(self::$sessionSign); CacheLock::unlock(self::$sessionSign); self::$data = unserialize(self::$data); if (!is_array(self::$data)) { self::$data = array(); } } $D„»ìŠî…Î = new self(); return $D„»ìŠî…Î; goto FµÎŒõßø; EÖÙ‡·Œ’É: if (self::$sessionSign) { } else { if (Cookie::get($B“ãŞö¨¥´)) { self::$sessionSign = Cookie::get($B“ãŞö¨¥´); } else { self::$sessionSign = guid(); } } Cookie::setSafe($B“ãŞö¨¥´, self::$sessionSign, self::$sessionTime); $AäŸ‰à…ß‡ = $Fƒâ°•Æï½[$DøÁ¼±Òõø[1482]]; goto Cå÷•ÕİÀé; DØß²ùĞ×: $Fƒâ°•Æï½ = $GLOBALS[$DøÁ¼±Òõø[6]][$DøÁ¼±Òõø[347]]; self::$sessionTime = $Fƒâ°•Æï½[$DøÁ¼±Òõø[1480]]; $B“ãŞö¨¥´ = isset($GLOBALS[$DøÁ¼±Òõø[1481]]) ? $GLOBALS[$DøÁ¼±Òõø[1481]] : SESSION_ID; goto EÖÙ‡·Œ’É; Cå÷•ÕİÀé: $f ÚéêÈñÙ = $Fƒâ°•Æï½[$AäŸ‰à…ß‡]; $Dó±£ªÇ” = $Fƒâ°•Æï½[$DøÁ¼±Òõø[785]]; switch ($AäŸ‰à…ß‡) { case $DøÁ¼±Òõø[17]: self::$handle = Model($DøÁ¼±Òõø[786]); break; case $DøÁ¼±Òõø[787]: self::$handle = new CacheRedis($f ÚéêÈñÙ, $Dó±£ªÇ”); break; case $DøÁ¼±Òõø[788]: self::$handle = new CacheMemcached($f ÚéêÈñÙ, $Dó±£ªÇ”); break; case $DøÁ¼±Òõø[193]: $f ÚéêÈñÙ[$DøÁ¼±Òõø[76]] = $f ÚéêÈñÙ[$DøÁ¼±Òõø[76]] . $DøÁ¼±Òõø[1483]; self::$handle = new CacheFile($f ÚéêÈñÙ, $Dó±£ªÇ”); default: break; } goto Eåá‚”­; FµÎŒõßø: } public static function sign($c­„³ì¿í = false) { $c­„³ì¿í && (self::$sessionSign = $c­„³ì¿í); self::init(); return self::$sessionSign; } public static function set($f°½ŞŞêÏ°, $dõŸğˆã‡Ê = false) { self::init(); if (is_array($f°½ŞŞêÏ°)) { foreach ($f°½ŞŞêÏ° as $Dã¨£íµâÎ => $B…‚ê¤Õ·) { array_set_value(self::$data, $Dã¨£íµâÎ, $B…‚ê¤Õ·); } } else { array_set_value(self::$data, $f°½ŞŞêÏ°, $dõŸğˆã‡Ê); } CacheLock::lock(self::$sessionSign); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); CacheLock::unlock(self::$sessionSign); } public static function get($a×™éºŒĞ’ = false) { self::init(); if (!$a×™éºŒĞ’) { return self::$data; } return array_get_value(self::$data, $a×™éºŒĞ’); } public static function remove($b£°§‚×¼ß) { self::init(); unset(self::$data[$b£°§‚×¼ß]); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); } public static function destory() { Cookie::remove(SESSION_ID, !0); self::init(); self::clearTimeout(); self::$data = array(); return self::$handle->remove(self::$sessionSign); } public static function clearTimeout() { self::init(); if (method_exists(self::$handle, $_SERVER[¬¦ã¾][790])) { self::$handle->clearTimeout(); } } } class AutoTask { const AUTO_DELAY_TIME = 2; const AUTO_RESTART_TIME = 7200; public static function start() { goto a¯¼Šˆ¦¾; Dğ¾¡»º©ö: while (!0) { self::cacheClear(); if (self::valueGet($E­ô¨ØÅİŒ[702]) != $E­ô¨ØÅİŒ[87]) { self::valueSet($E­ô¨ØÅİŒ[1484], $E­ô¨ØÅİŒ[191]); self::log($E­ô¨ØÅİŒ[1488]); die; } self::valueSet($E­ô¨ØÅİŒ[1484], $E­ô¨ØÅİŒ[87]); self::valueSet($E­ô¨ØÅİŒ[1485], time()); self::taskRunAll(); sleep(self::AUTO_DELAY_TIME); } goto a¬ùÜÊ–ÓÖ; Bğäô³À—: http_close(); self::valueSet($E­ô¨ØÅİŒ[1484], $E­ô¨ØÅİŒ[87]); Hook::bind($E­ô¨ØÅİŒ[1486], $E­ô¨ØÅİŒ[1487]); goto Dğ¾¡»º©ö; a¯¼Šˆ¦¾: $E­ô¨ØÅİŒ =& $_SERVER[¬¦ã¾]; if (self::valueGet($E­ô¨ØÅİŒ[702]) != $E­ô¨ØÅİŒ[87]) { return; } if (self::valueGet($E­ô¨ØÅİŒ[1484]) == $E­ô¨ØÅİŒ[87]) { $d¹Îåù’­ = self::valueGet($E­ô¨ØÅİŒ[1485]); if (time() - $d¹Îåù’­ > self::AUTO_RESTART_TIME) { self::restart(); } return; } goto Bğäô³À—; a¬ùÜÊ–ÓÖ: } public static function restart() { $C®±ê¹” =& $_SERVER[¬¦ã¾]; http_close(); self::valueSet($C®±ê¹”[702], $C®±ê¹”[191]); sleep(self::AUTO_DELAY_TIME + 5); self::valueSet($C®±ê¹”[1484], $C®±ê¹”[191]); self::valueSet($C®±ê¹”[702], $C®±ê¹”[87]); } public static function shutdownEvent() { $fè’™ÏÄ• =& $_SERVER[¬¦ã¾]; self::valueSet($fè’™ÏÄ•[1484], $fè’™ÏÄ•[191]); self::log($fè’™ÏÄ•[1489]); } public static function config($D—ÅŒ„Å¿Ÿ, $Bö‚¼øŠƒ) { self::valueSet($_SERVER[¬¦ã¾][702], $D—ÅŒ„Å¿Ÿ); } private static function taskRunAll() { goto aŠº¡ñ; FàÅËà´ˆ¹: self::taskQueueRun($bë¡Ø‘ÇÄ˜); self::closeDatabase(); goto E“ßªèÀò; dÉ„§¢ª¡: $d‰³ãŸî–á = count($C£×“å¢Á); for ($Bâ™ö‘ê…Ÿ = 0; $Bâ™ö‘ê…Ÿ < $d‰³ãŸî–á; $Bâ™ö‘ê…Ÿ++) { $a°ÅŠ›ß¨ = $C£×“å¢Á[$Bâ™ö‘ê…Ÿ]; if (!$a°ÅŠ›ß¨[$CªØçÄô°[393]] || $a°ÅŠ›ß¨[$CªØçÄô°[1491]] != $CªØçÄô°[87]) { continue; } if (!self::taskTimeCheck($a°ÅŠ›ß¨)) { continue; } self::taskRun($a°ÅŠ›ß¨); } Hook::trigger($CªØçÄô°[1492]); goto FàÅËà´ˆ¹; aŠº¡ñ: $CªØçÄô° =& $_SERVER[¬¦ã¾]; $bë¡Ø‘ÇÄ˜ = timeFloat(); $C£×“å¢Á = Model($CªØçÄô°[1490])->listData(); goto dÉ„§¢ª¡; E“ßªèÀò: } private static function taskQueueRun($d¾‚îòè®) { $c™ÀÄï§ˆ = 10; while (!0) { $c›¸í‹ğù” = TaskQueue::run(); if ($c›¸í‹ğù” === !1) { break; } if (timeFloat() - $d¾‚îòè® >= $c™ÀÄï§ˆ) { break; } } } private static function taskTimeCheck($B×šù”ÓÚ) { goto c‹èâÕ”Ó¦; a¥áâ„Éš˜: $d©ÏªöİÆ = strtotime($aÖ¶‰–ã[1493] . $e’£ôƒ™ëñ[$aÖ¶‰–ã[1494]] . $aÖ¶‰–ã[1495]) - strtotime($aÖ¶‰–ã[1496]); $e×ùŸÂå— = time() - strtotime(date($aÖ¶‰–ã[1497]) . $aÖ¶‰–ã[1498]); $E…›Î–³ = $e×ùŸÂå— >= $d©ÏªöİÆ && $e×ùŸÂå— <= $d©ÏªöİÆ + 3600; goto E®ÈÕ‚á…; E®ÈÕ‚á…: switch ($e’£ôƒ™ëñ[$aÖ¶‰–ã[29]]) { case $aÖ¶‰–ã[1499]: if (time() - $A‡ŒøˆÎ < 3600 * 24 * 30) { return !1; } if ($e’£ôƒ™ëñ[$aÖ¶‰–ã[1499]] == date($aÖ¶‰–ã[1500]) && $E…›Î–³) { return !0; } break; case $aÖ¶‰–ã[1501]: if (time() - $A‡ŒøˆÎ < 3600 * 24 * 7) { return !1; } $a–ÌùÙëÁï = date($aÖ¶‰–ã[1502]) == 0 ? 7 : date($aÖ¶‰–ã[1502]); if ($e’£ôƒ™ëñ[$aÖ¶‰–ã[1501]] == $a–ÌùÙëÁï && $E…›Î–³) { return !0; } break; case $aÖ¶‰–ã[1494]: if (time() - $A‡ŒøˆÎ < 3600 * 24) { return !1; } if ($E…›Î–³) { return !0; } break; case $aÖ¶‰–ã[1503]: if (time() - $A‡ŒøˆÎ >= floatval($e’£ôƒ™ëñ[$aÖ¶‰–ã[1503]]) * 60) { return !0; } break; default: break; } return !1; goto E‚·›­ÑÑê; c‹èâÕ”Ó¦: $aÖ¶‰–ã =& $_SERVER[¬¦ã¾]; $e’£ôƒ™ëñ = json_decode($B×šù”ÓÚ[$aÖ¶‰–ã[197]], !0); $A‡ŒøˆÎ = intval($B×šù”ÓÚ[$aÖ¶‰–ã[1485]]); goto a¥áâ„Éš˜; E‚·›­ÑÑê: } private static function closeDatabase() { goto e—òø¸İ ; e—òø¸İ : $eä×¼‹¿à÷ =& $_SERVER[¬¦ã¾]; static $C“«¥Âî = 0; $cãÄ¾îÃ ¯ = 1800; goto c»åÅ‡Ñî’; e‹Íª›°ä¢: $EÒ¢ê°‰¸ = Model($eä×¼‹¿à÷[502])->db($eä×¼‹¿à÷[33]); if ($EÒ¢ê°‰¸) { $EÒ¢ê°‰¸->closeConnect(); } if (time() - TIME > 3600 * 24 * 7) { write_log($eä×¼‹¿à÷[1504], $eä×¼‹¿à÷[1505]); die; } goto AåÆ©âã¤; c»åÅ‡Ñî’: if (!$C“«¥Âî) { $C“«¥Âî = time(); } if (time() - $C“«¥Âî < $cãÄ¾îÃ ¯) { return; } $C“«¥Âî = time(); goto e‹Íª›°ä¢; AåÆ©âã¤: } public static function taskRun($fÅìƒãÒŞÒ) { goto d†éöÊ‹Îê; E—ƒÛ²ó†Œ: Model($Cƒ ªˆ¨‰Œ[1510])->add(array($Cƒ ªˆ¨‰Œ[1511] => $Cƒ ªˆ¨‰Œ[33], $Cƒ ªˆ¨‰Œ[1512] => $Cƒ ªˆ¨‰Œ[191], $Cƒ ªˆ¨‰Œ[29] => $Cƒ ªˆ¨‰Œ[1513] . $fÅìƒãÒŞÒ[$Cƒ ªˆ¨‰Œ[393]], $Cƒ ªˆ¨‰Œ[1514] => json_encode(array($Cƒ ªˆ¨‰Œ[28] => $fÅìƒãÒŞÒ[$Cƒ ªˆ¨‰Œ[28]], $Cƒ ªˆ¨‰Œ[1515] => timeFloat() - $a„§¼‡«Ø¡, $Cƒ ªˆ¨‰Œ[291] => $c²øğğåë²)))); self::log($Cƒ ªˆ¨‰Œ[1516] . $fÅìƒãÒŞÒ[$Cƒ ªˆ¨‰Œ[393]] . $Cƒ ªˆ¨‰Œ[1517] . $c²øğğåë²); return !0; goto cæá‡ÕÀ®; d†éöÊ‹Îê: $Cƒ ªˆ¨‰Œ =& $_SERVER[¬¦ã¾]; self::log($Cƒ ªˆ¨‰Œ[1506] . $fÅìƒãÒŞÒ[$Cƒ ªˆ¨‰Œ[393]] . $Cƒ ªˆ¨‰Œ[1507] . $fÅìƒãÒŞÒ[$Cƒ ªˆ¨‰Œ[28]] . $Cƒ ªˆ¨‰Œ[1508] . $fÅìƒãÒŞÒ[$Cƒ ªˆ¨‰Œ[1509]]); Model($Cƒ ªˆ¨‰Œ[1490])->run($fÅìƒãÒŞÒ[$Cƒ ªˆ¨‰Œ[393]]); goto bõÒßÆäŞ; bõÒßÆäŞ: $a„§¼‡«Ø¡ = timeFloat(); $c²øğğåë² = $Cƒ ªˆ¨‰Œ[33]; switch ($fÅìƒãÒŞÒ[$Cƒ ªˆ¨‰Œ[29]]) { case $Cƒ ªˆ¨‰Œ[305]: $Dğ×Šƒñ÷ = url_request($fÅìƒãÒŞÒ[$Cƒ ªˆ¨‰Œ[1509]], $Cƒ ªˆ¨‰Œ[228], !1, !1, !1, !1, 10); if ($Dğ×Šƒñ÷[$Cƒ ªˆ¨‰Œ[702]]) { $c²øğğåë² = strlen($Dğ×Šƒñ÷[$Cƒ ªˆ¨‰Œ[1079]]); } break; case $Cƒ ªˆ¨‰Œ[227]: $c²øğğåë² = Hook::apply($fÅìƒãÒŞÒ[$Cƒ ªˆ¨‰Œ[1509]]); default: break; } goto E—ƒÛ²ó†Œ; cæá‡ÕÀ®: } private static function valueGet($f÷Ê²©‹¦É) { $Fê…ë“˜â =& $_SERVER[¬¦ã¾]; $aœÆÕ˜¥µ = $Fê…ë“˜â[1518]; $DƒÜÕ«÷àá = Model($Fê…ë“˜â[1519])->get($f÷Ê²©‹¦É, $aœÆÕ˜¥µ); if (is_null($DƒÜÕ«÷àá)) { Model($Fê…ë“˜â[1519])->set($Fê…ë“˜â[702], $Fê…ë“˜â[87], $aœÆÕ˜¥µ); Model($Fê…ë“˜â[1519])->set($Fê…ë“˜â[1484], $Fê…ë“˜â[191], $aœÆÕ˜¥µ); $DƒÜÕ«÷àá = Model($Fê…ë“˜â[1519])->get($f÷Ê²©‹¦É, $aœÆÕ˜¥µ); } return $DƒÜÕ«÷àá; } private static function valueSet($aùÁå¤, $d“‘—¦É‘Ÿ) { $a‹…Òù»ò =& $_SERVER[¬¦ã¾]; return Model($a‹…Òù»ò[1519])->set($aùÁå¤, $d“‘—¦É‘Ÿ, $a‹…Òù»ò[1518]); } protected static function log($aïØ‘ª²) { write_log($aïØ‘ª², $_SERVER[¬¦ã¾][1505]); } private static function cacheClear() { $B§†ÔÃª×Ö =& $_SERVER[¬¦ã¾]; $b§øë‚Àà‘ = Model($B§†ÔÃª×Ö[1519])->cacheKey($B§†ÔÃª×Ö[1518]); Cache::clearMemory($b§øë‚Àà‘); Model($B§†ÔÃª×Ö[1490])->cacheClear(); } } goto f»åÎÀÂ²Ã; Cø¬ˆõÁù¸: class SourceRecycleModel extends ModelBase { protected $tableName = "\151\x6f\137\163\x6f\x75\x72\x63\145\137\162\145\143\x79\x63\x6c\x65"; protected $dataAuto = array(array("\143\x72\x65\x61\164\145\124\151\x6d\x65", "\x74\x69\x6d\x65", "\151\156\x73\145\162\164", "\146\165\x6e\143\164\151\157\x6e")); public function listData($CŞº¨¡òé = false) { $cšèÅÑÎç =& $_SERVER[¬¦ã¾]; $CŞº¨¡òé = $CŞº¨¡òé ? $CŞº¨¡òé : USER_ID; $fÙè­ÓÑ = $this->where(array($cšèÅÑÎç[1512] => $CŞº¨¡òé))->select(); return array_to_keyvalue($fÙè­ÓÑ, $cšèÅÑÎç[33], $cšèÅÑÎç[395]); } public function moveToRecycle($DŸ„¡ï‰–¸) { goto B“Ú†Ñ·àÔ; bÔÍß¹ç®ñ: $this->recycleMove($DŸ„¡ï‰–¸, 1); if ($F¼Âç®”ˆ[$e½‚âÉğ›Ï[403]] == $e½‚âÉğ›Ï[87]) { $fÏ‚Ôİ¬‚ = array($e½‚âÉğ›Ï[553] => array($e½‚âÉğ›Ï[512], $F¼Âç®”ˆ[$e½‚âÉğ›Ï[487]] . $DŸ„¡ï‰–¸ . $e½‚âÉğ›Ï[513])); $d’‹á¯‡->where($fÏ‚Ôİ¬‚)->setField($e½‚âÉğ›Ï[423], 1); } goto CóÄ‘ˆÈå; B“Ú†Ñ·àÔ: $e½‚âÉğ›Ï =& $_SERVER[¬¦ã¾]; $d’‹á¯‡ = Model($e½‚âÉğ›Ï[1197]); $F¼Âç®”ˆ = $d’‹á¯‡->sourceInfo($DŸ„¡ï‰–¸); goto e„àŒÅ’¹…; e„àŒÅ’¹…: if (!$F¼Âç®”ˆ || $F¼Âç®”ˆ[$e½‚âÉğ›Ï[423]] == $e½‚âÉğ›Ï[87]) { return; } $bÀÙåÒš»Æ = array($e½‚âÉğ›Ï[410] => $DŸ„¡ï‰–¸, $e½‚âÉğ›Ï[1512] => USER_ID, $e½‚âÉğ›Ï[549] => $F¼Âç®”ˆ[$e½‚âÉğ›Ï[404]], $e½‚âÉğ›Ï[550] => $F¼Âç®”ˆ[$e½‚âÉğ›Ï[484]], $e½‚âÉğ›Ï[553] => $F¼Âç®”ˆ[$e½‚âÉğ›Ï[487]]); $this->add($bÀÙåÒš»Æ); goto bÔÍß¹ç®ñ; CóÄ‘ˆÈå: } public function clear() { $this->remove(!1); } public function remove($aÈšøîĞ™­ = false, $CãŞäÇÄí° = false) { goto Aä´¿¹ÙÑ—; açƒÂ…ª: foreach ($D¸¯§¥Éš‘ as $F¼«¿æ…Ÿ) { if ($aÈšøîĞ™­ != !1 && !in_array($F¼«¿æ…Ÿ, $aÈšøîĞ™­)) { continue; } $BÛÇ™³éÜ‘ = $bÓ—„‚ ¨->sourceInfo($F¼«¿æ…Ÿ); $bÓ—„‚ ¨->remove($F¼«¿æ…Ÿ, !1); $eé¥×ßÀ–ƒ = $BÛÇ™³éÜ‘[$BôßÍˆ¡§ä[404]] . $BôßÍˆ¡§ä[71] . $BÛÇ™³éÜ‘[$BôßÍˆ¡§ä[484]]; $dĞÅ¿çĞ[$eé¥×ßÀ–ƒ] = array($BôßÍˆ¡§ä[549] => $BÛÇ™³éÜ‘[$BôßÍˆ¡§ä[404]], $BôßÍˆ¡§ä[484] => $BÛÇ™³éÜ‘[$BôßÍˆ¡§ä[484]]); $this->where(array($BôßÍˆ¡§ä[395] => $F¼«¿æ…Ÿ))->delete(); } foreach ($dĞÅ¿çĞ as $FÜïëÎÒâ) { $bÓ—„‚ ¨->targetSpaceUpdate($FÜïëÎÒâ[$BôßÍˆ¡§ä[404]], $FÜïëÎÒâ[$BôßÍˆ¡§ä[484]]); } goto dä¼ÕÏó˜£; cÀÍâÖğÇÙ: $D¸¯§¥Éš‘ = $this->listData($CãŞäÇÄí°); $aÈšøîĞ™­ = $aÈšøîĞ™­ === !1 ? !1 : $aÈšøîĞ™­; $dĞÅ¿çĞ = array(); goto açƒÂ…ª; Aä´¿¹ÙÑ—: $BôßÍˆ¡§ä =& $_SERVER[¬¦ã¾]; $CãŞäÇÄí° = $CãŞäÇÄí° ? $CãŞäÇÄí° : USER_ID; $bÓ—„‚ ¨ = Model($BôßÍˆ¡§ä[1197]); goto cÀÍâÖğÇÙ; dä¼ÕÏó˜£: } public function restore($A›øÆ£¦½¼ = false) { $E­½ƒîìªó = $this->listData(); $this->_restoreSource($E­½ƒîìªó, $A›øÆ£¦½¼); } public function removeUserAll($C¯§¦ÌÊ ) { $this->remove(!1, $C¯§¦ÌÊ ); } private function _restoreSource($e›‰‰Ñ ‡°, $aÄë·«™´) { goto cÖÊ‘Èßê“; cÖÊ‘Èßê“: $f”‹ÀÕº× =& $_SERVER[¬¦ã¾]; $C¤Â‘Ù¾Û– = Model($f”‹ÀÕº×[1197]); $aÄë·«™´ = $aÄë·«™´ == !1 ? !1 : $aÄë·«™´; goto d®¾Í¥¸ã…; d®¾Í¥¸ã…: if (!$e›‰‰Ñ ‡°) { return !0; } $C£…™„“† = array(); foreach ($e›‰‰Ñ ‡° as $DóÒÓ¤İëÈ) { goto e’æ‚Òİœ; A§£ ±é–•: if ($eŸšøÚÇ–[$f”‹ÀÕº×[423]] == $f”‹ÀÕº×[87]) { continue; } $C¤Â‘Ù¾Û–->lockMoveStart($DóÒÓ¤İëÈ); $this->recycleMove($DóÒÓ¤İëÈ, 0); goto B»ÑÇğ÷³¯; B»ÑÇğ÷³¯: if ($F¾¯ƒ´²Ò[$f”‹ÀÕº×[403]] == $f”‹ÀÕº×[87]) { $E™»´¡í°æ = array($f”‹ÀÕº×[553] => array($f”‹ÀÕº×[512], $F¾¯ƒ´²Ò[$f”‹ÀÕº×[487]] . $DóÒÓ¤İëÈ . $f”‹ÀÕº×[513])); $C¤Â‘Ù¾Û–->where($E™»´¡í°æ)->setField($f”‹ÀÕº×[423], 0); $this->restoreFolderChildren($DóÒÓ¤İëÈ, $e›‰‰Ñ ‡°); } $this->where(array($f”‹ÀÕº×[395] => $DóÒÓ¤İëÈ))->delete(); $C¤Â‘Ù¾Û–->folderSizeReset($F¾¯ƒ´²Ò[$f”‹ÀÕº×[478]]); goto FæˆÂõ…§³; e’æ‚Òİœ: if ($aÄë·«™´ != !1 && !in_array($DóÒÓ¤İëÈ, $aÄë·«™´)) { continue; } $F¾¯ƒ´²Ò = $C¤Â‘Ù¾Û–->sourceInfo($DóÒÓ¤İëÈ); $eŸšøÚÇ– = $C¤Â‘Ù¾Û–->sourceInfo($F¾¯ƒ´²Ò[$f”‹ÀÕº×[478]]); goto A§£ ±é–•; FæˆÂõ…§³: $C£…™„“†[] = $F¾¯ƒ´²Ò[$f”‹ÀÕº×[478]]; if ($F¾¯ƒ´²Ò[$f”‹ÀÕº×[403]] == $f”‹ÀÕº×[87]) { $C£…™„“†[] = $DóÒÓ¤İëÈ; } $C¤Â‘Ù¾Û–->lockMoveEnd($DóÒÓ¤İëÈ); goto d“¹–¥Ü¡; d“¹–¥Ü¡: } goto d³Á°—­İ; d³Á°—­İ: $C¤Â‘Ù¾Û–->updateModifyTime($C£…™„“†); goto Dç½ôÏàÑµ; Dç½ôÏàÑµ: } private function restoreFolderChildren($a”œ»ô›«, $d©—¬ßÄ‘) { goto CÊšó£“; CÊšó£“: $D«»‚Ÿ…Èƒ =& $_SERVER[¬¦ã¾]; $CÎ¥Ö™¦¿ò = Model($D«»‚Ÿ…Èƒ[1197]); $aê½ƒ§è©÷ = array($D«»‚Ÿ…Èƒ[395] => array($D«»‚Ÿ…Èƒ[7], array())); goto C¡¼Ã°ç‡«; C¡¼Ã°ç‡«: foreach ($d©—¬ßÄ‘ as $eã©Ş³ŒÖ) { if ($eã©Ş³ŒÖ == $a”œ»ô›«) { continue; } if (!$CÎ¥Ö™¦¿ò->isParentOf($a”œ»ô›«, $eã©Ş³ŒÖ)) { continue; } $d’÷Óùµƒ = $CÎ¥Ö™¦¿ò->sourceInfo($eã©Ş³ŒÖ); if ($d’÷Óùµƒ[$D«»‚Ÿ…Èƒ[403]] == $D«»‚Ÿ…Èƒ[87]) { $aê½ƒ§è©÷[] = array($D«»‚Ÿ…Èƒ[553] => array($D«»‚Ÿ…Èƒ[512], $d’÷Óùµƒ[$D«»‚Ÿ…Èƒ[487]] . $eã©Ş³ŒÖ . $D«»‚Ÿ…Èƒ[513])); } else { $aê½ƒ§è©÷[$D«»‚Ÿ…Èƒ[395]][1][] = $eã©Ş³ŒÖ; } } if (!$aê½ƒ§è©÷[$D«»‚Ÿ…Èƒ[395]][1]) { unset($aê½ƒ§è©÷[$D«»‚Ÿ…Èƒ[395]]); } if (!$aê½ƒ§è©÷) { return; } goto DÕôï†ˆÆò; DÕôï†ˆÆò: $aê½ƒ§è©÷[$D«»‚Ÿ…Èƒ[395]][1] = array_unique($aê½ƒ§è©÷[$D«»‚Ÿ…Èƒ[395]][1]); $aê½ƒ§è©÷[$D«»‚Ÿ…Èƒ[948]] = $D«»‚Ÿ…Èƒ[1775]; $CÎ¥Ö™¦¿ò->where($aê½ƒ§è©÷)->setField($D«»‚Ÿ…Èƒ[423], 1); goto fã•±¤“ÖÅ; fã•±¤“ÖÅ: } private function recycleMove($Cõíš°†å£, $A¾Œœèºö = 1) { $aäåªàÆ =& $_SERVER[¬¦ã¾]; $d¨¦áÈÍ­ = Model($aäåªàÆ[1197]); $Eò×½øÇ»ç = Model($aäåªàÆ[1984]); $DÄ¹ß³ù¾õ = array($aäåªàÆ[395] => $Cõíš°†å£); if ($A¾Œœèºö) { $d¨¦áÈÍ­->where($DÄ¹ß³ù¾õ)->setField($aäåªàÆ[423], 1); $Eò×½øÇ»ç->eventRecycle($Cõíš°†å£, $aäåªàÆ[1985]); } else { $DùóÈµÆœÊ = $d¨¦áÈÍ­->where($DÄ¹ß³ù¾õ)->find(); $f¹±¶œÑ°ƒ = $DùóÈµÆœÊ[$aäåªàÆ[403]] == $aäåªàÆ[87]; $AŸ©ŠÙâæ = $d¨¦áÈÍ­->fileNameAuto($DùóÈµÆœÊ[$aäåªàÆ[478]], $DùóÈµÆœÊ[$aäåªàÆ[28]], REPEAT_RENAME_FOLDER, $f¹±¶œÑ°ƒ); if ($AŸ©ŠÙâæ != $DùóÈµÆœÊ[$aäåªàÆ[28]]) { $d¨¦áÈÍ­->rename($Cõíš°†å£, $AŸ©ŠÙâæ); } $d¨¦áÈÍ­->where($DÄ¹ß³ù¾õ)->setField($aäåªàÆ[423], 0); $Eò×½øÇ»ç->eventRecycle($Cõíš°†å£, $aäåªàÆ[1986]); } } } class StorageModel extends ModelBaseLight { public $optionType = "\123\171\163\x74\x65\x6d\56\x73\164\x6f\162\x61\x67\145\114\x69\x73\x74"; public $field = array("\x6e\x61\155\145", "\x73\151\172\145\115\141\x78", "\163\171\163\x74\145\155", "\x64\145\x66\141\x75\154\x74", "\x64\162\x69\166\145\x72", "\x63\x6f\156\146\151\x67"); public function listData($AÍĞãç£´ = false, $fÚØ¹æï¢ = "\x6d\157\144\151\146\171\x54\x69\155\x65", $c×ôİøëÃÀ = false) { $b×£‘‡éŞÛ =& $_SERVER[¬¦ã¾]; $f´ ˆ§‹ä = parent::listData($AÍĞãç£´, $fÚØ¹æï¢, $c×ôİøëÃÀ); if ($AÍĞãç£´) { return $f´ ˆ§‹ä; } $a—ŒÔÂšÎ = $this->ioSizeUseGet(array_to_keyvalue($f´ ˆ§‹ä, $b×£‘‡éŞÛ[33], $b×£‘‡éŞÛ[393])); foreach ($f´ ˆ§‹ä as $bŠŠï“ô¶ğ => $b­áİ ‡ãÒ) { unset($f´ ˆ§‹ä[$bŠŠï“ô¶ğ][$b×£‘‡éŞÛ[6]]); $f´ ˆ§‹ä[$bŠŠï“ô¶ğ][$b×£‘‡éŞÛ[1674]] = isset($a—ŒÔÂšÎ[$b­áİ ‡ãÒ[$b×£‘‡éŞÛ[393]]]) ? $a—ŒÔÂšÎ[$b­áİ ‡ãÒ[$b×£‘‡éŞÛ[393]]] : 0; } return $f´ ˆ§‹ä; } public function ioSizeUseGet($E…¿ÀÕï”İ) { goto f¬Ù·×«…Ë; f¬Ù·×«…Ë: $f»ø°â· =& $_SERVER[¬¦ã¾]; if (!$E…¿ÀÕï”İ) { return array(); } $eğÇğ¡ßÚ = $f»ø°â·[1987] . implode($f»ø°â·[47], $E…¿ÀÕï”İ); goto eÏˆêøŒ÷; eÏˆêøŒ÷: $e¯÷éëÂ¢º = Cache::get($eğÇğ¡ßÚ); if ($e¯÷éëÂ¢º) { return $e¯÷éëÂ¢º; } $Eç‡†ˆëš¾ = array($f»ø°â·[774] => $f»ø°â·[393], $f»ø°â·[1988] => $f»ø°â·[78]); goto eâ½¦¿Ÿê®; eâ½¦¿Ÿê®: $F†Ëå¼Ô = array($f»ø°â·[774] => array($f»ø°â·[7], $E…¿ÀÕï”İ)); $e¯÷éëÂ¢º = Model($f»ø°â·[739])->field($Eç‡†ˆëš¾)->where($F†Ëå¼Ô)->group($f»ø°â·[774])->select(); $e¯÷éëÂ¢º = array_to_keyvalue($e¯÷éëÂ¢º, $f»ø°â·[393], $f»ø°â·[78]); goto f­ÖğêææÁ; f­ÖğêææÁ: Cache::set($eğÇğ¡ßÚ, $e¯÷éëÂ¢º, 600); return $e¯÷éëÂ¢º; goto dÙ¾Ü‹®Ü„; dÙ¾Ü‹®Ü„: } public function getConfig($dê©ã¼»®«) { $Cõ‡ğ½èˆ‘ = parent::listData($dê©ã¼»®«); return json_decode($Cõ‡ğ½èˆ‘[$_SERVER[¬¦ã¾][6]], !0); } public function update($D×Üª¢Ü’, $e³–½³„ßí) { goto EšÎÊğ¬­; EšÎÊğ¬­: $Bà¦˜Ñ®†Œ =& $_SERVER[¬¦ã¾]; $B¦ù×—Ô‡ğ = $e³–½³„ßí[$Bà¦˜Ñ®†Œ[28]]; $C­‚Àƒœî = array_to_keyvalue(parent::listData(), $Bà¦˜Ñ®†Œ[28]); goto Eá¸Ê½ù—á; Eá¸Ê½ù—á: if (isset($C­‚Àƒœî[$B¦ù×—Ô‡ğ]) && $C­‚Àƒœî[$B¦ù×—Ô‡ğ][$Bà¦˜Ñ®†Œ[393]] != $D×Üª¢Ü’) { return !1; } if (isset($e³–½³„ßí[$Bà¦˜Ñ®†Œ[1989]]) && $e³–½³„ßí[$Bà¦˜Ñ®†Œ[1989]] == $Bà¦˜Ñ®†Œ[87]) { $this->checkConfig($e³–½³„ßí); } unset($e³–½³„ßí[$Bà¦˜Ñ®†Œ[1989]]); goto e‡è¢·èµ; e‡è¢·èµ: $b¶áÎ§¤«º = parent::update($D×Üª¢Ü’, $e³–½³„ßí); if ($b¶áÎ§¤«º && $e³–½³„ßí[$Bà¦˜Ñ®†Œ[34]]) { foreach ($C­‚Àƒœî as $BæÃ¥›äÁà) { if ($BæÃ¥›äÁà[$Bà¦˜Ñ®†Œ[34]] && $BæÃ¥›äÁà[$Bà¦˜Ñ®†Œ[393]] != $D×Üª¢Ü’) { parent::update($BæÃ¥›äÁà[$Bà¦˜Ñ®†Œ[393]], array($Bà¦˜Ñ®†Œ[34] => 0)); } } } return $b¶áÎ§¤«º; goto eâÌØĞ¿›; eâÌØĞ¿›: } public function add($EÛ¾¾£¨Äò) { goto EÊ–£ä×À´; f÷¹Óºğâ¦: return $DéêğÔ; goto bÓÃ¿òë; c‰²Äæä„´: $this->checkConfig($EÛ¾¾£¨Äò); $DéêğÔ = parent::insert($EÛ¾¾£¨Äò); if ($DéêğÔ && $EÛ¾¾£¨Äò[$E®Å¿Å±¢¨[34]]) { foreach ($f¥¤‡´Ç· as $Fèš ¶èäö) { if ($Fèš ¶èäö[$E®Å¿Å±¢¨[34]]) { parent::update($Fèš ¶èäö[$E®Å¿Å±¢¨[393]], array($E®Å¿Å±¢¨[34] => 0)); } } } goto f÷¹Óºğâ¦; EÊ–£ä×À´: $E®Å¿Å±¢¨ =& $_SERVER[¬¦ã¾]; $f¥¤‡´Ç· = array_to_keyvalue(parent::listData(), $E®Å¿Å±¢¨[28]); if (isset($f¥¤‡´Ç·[$EÛ¾¾£¨Äò[$E®Å¿Å±¢¨[28]]])) { return !1; } goto c‰²Äæä„´; bÓÃ¿òë: } public function checkConfig(&$CÎÜŸï», $BÚÏí‘ºô = false) { goto Cà¨Û—Íîâ; B”éå–ÊÉ: $eæŠÊ••§ì = new $CÓÃ’Ïã($FÅƒù†Ì¢ê); if (in_array($cÜñæğ°ÔÍ, $eæŠÊ••§ì->objectDriver)) { if (!$eæŠÊ••§ì->isBucketCors() && !$eæŠÊ••§ì->setBucketCors()) { $FªÑÔÆÕóä = LNG($Eà„Š¢¿Å[1994]); $FªÑÔÆÕóä .= $Eà„Š¢¿Å[1995] . LNG($Eà„Š¢¿Å[1996]); if ($BÚÏí‘ºô) { return $FªÑÔÆÕóä; } show_json($FªÑÔÆÕóä, !1); } } $fÅÒ ´ƒäÉ = rtrim($FÅƒù†Ì¢ê[$Eà„Š¢¿Å[1067]], $Eà„Š¢¿Å[8]) . $Eà„Š¢¿Å[8]; goto bù¸Ä‘ÊÕš; Cà¨Û—Íîâ: $Eà„Š¢¿Å =& $_SERVER[¬¦ã¾]; $cÜñæğ°ÔÍ = strtolower($CÎÜŸï»[$Eà„Š¢¿Å[94]]); $FÅƒù†Ì¢ê = json_decode($CÎÜŸï»[$Eà„Š¢¿Å[6]], !0); goto F¦‘†Òß¶; bù¸Ä‘ÊÕš: $cí§˜‰Ó¢ = $eæŠÊ••§ì->getPath($fÅÒ ´ƒäÉ . $Eà„Š¢¿Å[1129]); if (!$eæŠÊ••§ì->mkfile($cí§˜‰Ó¢)) { if ($BÚÏí‘ºô) { return LNG($Eà„Š¢¿Å[1994]); } show_json(LNG($Eà„Š¢¿Å[1994]), !1); } $FÅƒù†Ì¢ê[$Eà„Š¢¿Å[1067]] = $fÅÒ ´ƒäÉ; goto EßšÆÆ·ßô; F¦‘†Òß¶: foreach ($FÅƒù†Ì¢ê as $AÜãÑêÔà¡ => $F™ñÉ×¢íˆ) { $FÅƒù†Ì¢ê[$AÜãÑêÔà¡] = trim($F™ñÉ×¢íˆ); } $FÅƒù†Ì¢ê[$Eà„Š¢¿Å[1990]] = rand_string(6); $D¯”…¶ ´¥ = $GLOBALS[$Eà„Š¢¿Å[6]][$Eà„Š¢¿Å[88]][$Eà„Š¢¿Å[783]]; goto C´ëŞê…äÃ; C´ëŞê…äÃ: $AÔ¸¯éºÂ = isset($D¯”…¶ ´¥[$cÜñæğ°ÔÍ]) ? $D¯”…¶ ´¥[$cÜñæğ°ÔÍ] : ucfirst($cÜñæğ°ÔÍ); $CÓÃ’Ïã = $Eà„Š¢¿Å[72] . $AÔ¸¯éºÂ; if (!$AÔ¸¯éºÂ || !class_exists($CÓÃ’Ïã)) { if ($BÚÏí‘ºô) { return LNG($Eà„Š¢¿Å[1991]); } write_log(array($Eà„Š¢¿Å[1992], $CÎÜŸï», get_caller_info()), $Eà„Š¢¿Å[1993]); show_json(LNG($Eà„Š¢¿Å[1991]), !1, $CÎÜŸï»); } goto B”éå–ÊÉ; EßšÆÆ·ßô: $CÎÜŸï»[$Eà„Š¢¿Å[6]] = json_encode($FÅƒù†Ì¢ê); $CÎÜŸï»[$Eà„Š¢¿Å[94]] = $AÔ¸¯éºÂ; return !0; goto fâ¨ãÁ™‰; fâ¨ãÁ™‰: } public function driverListSystem() { $cÔ’à¢ÖÊ =& $_SERVER[¬¦ã¾]; $fÛéÀ£íÌ = parent::listData(); $dŠÔ÷‘òÏ— = array(); foreach ($fÛéÀ£íÌ as $b¤â‰Æƒ”) { unset($b¤â‰Æƒ”[$cÔ’à¢ÖÊ[194]], $b¤â‰Æƒ”[$cÔ’à¢ÖÊ[84]]); $b¤â‰Æƒ”[$cÔ’à¢ÖÊ[6]] = json_decode($b¤â‰Æƒ”[$cÔ’à¢ÖÊ[6]], !0); $dŠÔ÷‘òÏ—[] = $b¤â‰Æƒ”; } return $dŠÔ÷‘òÏ—; } public function defaultDriver() { $c–îô‰“ô =& $_SERVER[¬¦ã¾]; $dâÒ”Ï”Óë = parent::listData(); $A×•®¹½Ø = array_filter_by_field($dâÒ”Ï”Óë, $c–îô‰“ô[34], 1); $A×•®¹½Ø = $A×•®¹½Ø[0]; if ($A×•®¹½Ø) { $A×•®¹½Ø[$c–îô‰“ô[6]] = json_decode($A×•®¹½Ø[$c–îô‰“ô[6]], !0); } return $A×•®¹½Ø; } public function driverInfo($bÍ®•·ÒÜ) { $eà¦ÊÈ¡Ìµ =& $_SERVER[¬¦ã¾]; $b§÷´ªç‡ö = array_to_keyvalue(parent::listData(), $eà¦ÊÈ¡Ìµ[393]); if (!isset($b§÷´ªç‡ö[$bÍ®•·ÒÜ])) { return !1; } $cŒ„Œ´õİ = $b§÷´ªç‡ö[$bÍ®•·ÒÜ]; $cŒ„Œ´õİ[$eà¦ÊÈ¡Ìµ[6]] = json_decode($cŒ„Œ´õİ[$eà¦ÊÈ¡Ìµ[6]], !0); return $cŒ„Œ´õİ; } public function remove($E×¢†‘°Ì) { $this->removeShareItems($E×¢†‘°Ì); return parent::remove($E×¢†‘°Ì); } public function removeWithFile($C„’—ç­ö°, $déÕ¥ÅÌå¯) { goto AŞ°„“‰š–; Bƒ”ñŸòöä: $bŒµ—Û“Ê->task[$bò¨¬»™Øª[715]] = (double) $aÕÙÎ±œ; $eŠ‚¹Œ‡à = KodIO::defaultDriver(); $A‘Æ°¤±Ç = $eŠ‚¹Œ‡à[$bò¨¬»™Øª[393]]; goto A®øÊƒ™Å˜; A®øÊƒ™Å˜: $a‹ÛãÑªà = "\x7b\x69\157\x3a{$A‘Æ°¤±Ç}\x7d\57"; $fÎ…­ˆ±´Ş = !0; $A®«óœß¤Ö = array(); goto C§–Ì¿áÂÁ; B–¨±ÔóÂ™: $aÕÙÎ±œ = Model($bò¨¬»™Øª[450])->where($BéŞ°âÆ«É)->sum($bò¨¬»™Øª[78]); $C¬ÅôÀ¥á™ = $déÕ¥ÅÌå¯ . $bò¨¬»™Øª[1997] . $C„’—ç­ö°; $bŒµ—Û“Ê = new TaskFileTransfer($C¬ÅôÀ¥á™, $bò¨¬»™Øª[1993], $FÃ¥Ÿö²Ô‚, LNG($bò¨¬»™Øª[1998]) . "\50{$C„’—ç­ö°}\51"); goto Bƒ”ñŸòöä; AŞ°„“‰š–: $bò¨¬»™Øª =& $_SERVER[¬¦ã¾]; $BéŞ°âÆ«É = array($bò¨¬»™Øª[774] => $C„’—ç­ö°); $FÃ¥Ÿö²Ô‚ = Model($bò¨¬»™Øª[450])->where($BéŞ°âÆ«É)->count(); goto B–¨±ÔóÂ™; fµ´ƒá¥¿: if (!$fÎ…­ˆ±´Ş) { $bŒµ—Û“Ê->stop($C¬ÅôÀ¥á™); return !1; } $bŒµ—Û“Ê->end(); if ($déÕ¥ÅÌå¯ == $bò¨¬»™Øª[1654]) { $this->remove($C„’—ç­ö°); } goto Eî¿Ğ®ÉË„; C§–Ì¿áÂÁ: $CâÌ²ë¤³ = Model($bò¨¬»™Øª[193])->where($BéŞ°âÆ«É)->field($bò¨¬»™Øª[1999])->select(); foreach ($CâÌ²ë¤³ as $E‰‰ùÖŠ) { goto dÌ´™Éƒ; F¼‹÷±ù—ğ: if (IO::exist($F¢ãÙ™©Â)) { $bŒµ—Û“Ê->updateFileEnd($E‰‰ùÖŠ[$bò¨¬»™Øª[28]], $E‰‰ùÖŠ[$bò¨¬»™Øª[78]]); continue; } if (!IO::move($añßæï„™ä, get_path_father($F¢ãÙ™©Â))) { $fÎ…­ˆ±´Ş = !1; break; } $BéŞ°âÆ«É = array($bò¨¬»™Øª[447] => $E‰‰ùÖŠ[$bò¨¬»™Øª[447]]); goto fóí³÷à£Ä; dÌ´™Éƒ: $añßæï„™ä = $E‰‰ùÖŠ[$bò¨¬»™Øª[76]]; $F¢ãÙ™©Â = $a‹ÛãÑªà . str_replace("\x7b\x69\157\72{$C„’—ç­ö°}\x7d\x2f", $bò¨¬»™Øª[33], $añßæï„™ä); if (!IO::exist($añßæï„™ä)) { $A®«óœß¤Ö[] = $E‰‰ùÖŠ[$bò¨¬»™Øª[447]]; $bŒµ—Û“Ê->updateFileEnd($E‰‰ùÖŠ[$bò¨¬»™Øª[28]], $E‰‰ùÖŠ[$bò¨¬»™Øª[78]]); continue; } goto F¼‹÷±ù—ğ; fóí³÷à£Ä: $BÛÍ‘Èİè¼ = array($bò¨¬»™Øª[774] => $A‘Æ°¤±Ç, $bò¨¬»™Øª[76] => $F¢ãÙ™©Â); Model($bò¨¬»™Øª[193])->where($BéŞ°âÆ«É)->save($BÛÍ‘Èİè¼); goto a²£‘çÌ«”; a²£‘çÌ«”: } $this->removeByFileID($A®«óœß¤Ö); goto fµ´ƒá¥¿; Eî¿Ğ®ÉË„: } public function progress($Dè†œì×ùØ, $c¢ò½Ø”œ˜) { return Task::get($c¢ò½Ø”œ˜ . $_SERVER[¬¦ã¾][1997] . $Dè†œì×ùØ); } private function removeByFileID($e»¢çÆØ£¨ = array()) { goto bôèï´ŒÈ; bôèï´ŒÈ: $dôĞğíŒÓÎ =& $_SERVER[¬¦ã¾]; if (empty($e»¢çÆØ£¨)) { return; } $e ¶Øƒ½º = array($dôĞğíŒÓÎ[447] => array($dôĞğíŒÓÎ[7], $e»¢çÆØ£¨)); goto A³ôùª; A³ôùª: $e–¬Åˆ´ß = Model($dôĞğíŒÓÎ[1197])->where($e ¶Øƒ½º)->field($dôĞğíŒÓÎ[395])->select(); if (!$e–¬Åˆ´ß) { return; } $e–¬Åˆ´ß = array_to_keyvalue($e–¬Åˆ´ß, $dôĞğíŒÓÎ[33], $dôĞğíŒÓÎ[395]); goto båÀ’¿éŞÜ; båÀ’¿éŞÜ: foreach ($e–¬Åˆ´ß as $EŸö·®ëõŸ) { Model($dôĞğíŒÓÎ[409])->removeNow($EŸö·®ëõŸ, !1); } goto CÕÃÅ£ÎÉƒ; CÕÃÅ£ÎÉƒ: } private function removeShareItems($F÷ãç²˜á²) { goto DÍ¸ÄØø²é; eŠÎä¦îÚÂ: Model($f‘ç¦›Ãô¼[563])->remove($bš„¡–‡ô ); goto aÎˆÁ±‰¤; DÍ¸ÄØø²é: $f‘ç¦›Ãô¼ =& $_SERVER[¬¦ã¾]; $FßÆ´ñ¡‰ç = "\173\x69\157\72{$F÷ãç²˜á²}\175\x2f"; $Dí²ùŠĞ¾¿ = array($f‘ç¦›Ãô¼[395] => 0, $f‘ç¦›Ãô¼[1062] => array($f‘ç¦›Ãô¼[380], "{$FßÆ´ñ¡‰ç}\45")); goto a•ÉÕ™‘Æ‚; a•ÉÕ™‘Æ‚: $B‹öÃ›î = Model($f‘ç¦›Ãô¼[1665])->where($Dí²ùŠĞ¾¿)->field($f‘ç¦›Ãô¼[468])->select(); if (empty($B‹öÃ›î)) { return; } $bš„¡–‡ô  = array_to_keyvalue($B‹öÃ›î, $f‘ç¦›Ãô¼[33], $f‘ç¦›Ãô¼[468]); goto eŠÎä¦îÚÂ; aÎˆÁ±‰¤: } } class SystemLightAppModel extends ModelBaseLight { public $optionType = "\123\171\163\164\x65\x6d\x2e\x4c\x69\x67\x68\x74\x41\x70\160"; public $modelType = "\x53\x79\x73\x74\145\x6d\117\160\x74\x69\x6f\156"; public $field = array("\x6e\x61\155\145", "\147\x72\157\165\160", "\x64\145\163\x63", "\x63\157\156\x74\x65\x6e\164"); public function listData($d£ÆÖĞŒŒ¤ = false, $D±²çæ”ÂÔ = "\x6d\157\144\x69\x66\x79\124\151\155\x65", $D¸ôáùÜÔà = true) { return parent::listData($d£ÆÖĞŒŒ¤, $D±²çæ”ÂÔ, $D¸ôáùÜÔà); } public function remove($F¼¿­©ç©) { $eÇ·¹Œ¡• = $this->findByName($F¼¿­©ç©); if (!$eÇ·¹Œ¡•) { return !1; } return parent::remove($eÇ·¹Œ¡•[$_SERVER[¬¦ã¾][393]]); } public function add($DôÍ¥­êê¤) { if ($this->findByName($DôÍ¥­êê¤[$_SERVER[¬¦ã¾][28]])) { return !1; } return parent::insert($DôÍ¥­êê¤); } public function update($EÀâ‡ùÖ†Ä, $c¼Ôí¸Îâ) { $fŸ¤‘Ú±‘¼ =& $_SERVER[¬¦ã¾]; $a‰éÖ¢âš = $this->findByName($EÀâ‡ùÖ†Ä); $F“âŞ¥Ìº† = $this->findByName($c¼Ôí¸Îâ[$fŸ¤‘Ú±‘¼[28]]); if (!$a‰éÖ¢âš || $F“âŞ¥Ìº† && $F“âŞ¥Ìº†[$fŸ¤‘Ú±‘¼[393]] != $a‰éÖ¢âš[$fŸ¤‘Ú±‘¼[393]]) { return !1; } return parent::update($a‰éÖ¢âš[$fŸ¤‘Ú±‘¼[393]], $c¼Ôí¸Îâ); } } goto DÏ·œç·•; D¹ôËåó: class StreamWrapperIO { private $path; private $info; private $pose = 0; static $_fopenCache = array(); static $_chunkBuffer = array(); private $timeStart = 0; function stream_open($Eå˜¦äà‡Ÿ, $C¿Âæ”ùé× = '') { goto DÛ¼á—©’Ì; DÛ¼á—©’Ì: $this->info = $this->info($Eå˜¦äà‡Ÿ); $this->timeStart = timeFloat(); $this->path = $this->info[$_SERVER[¬¦ã¾][76]]; goto F³¤Ì“¨Ô; eé‰øÂ: if (!isset(self::$_chunkBuffer[$Eå˜¦äà‡Ÿ])) { self::$_chunkBuffer[$Eå˜¦äà‡Ÿ] = array(); } self::$_fopenCache[$this->pathOpen] = $this; return $this->info ? !0 : !1; goto Fà¿í§‚ÅÍ; F³¤Ì“¨Ô: $this->pathOpen = $Eå˜¦äà‡Ÿ; if (!$this->info) { return !1; } if (count(self::$_chunkBuffer) > 100) { self::$_chunkBuffer = null; self::$_chunkBuffer = array(); } goto eé‰øÂ; Fà¿í§‚ÅÍ: } function stream_read($CÉ„ÅŞÜ„Ü) { $fØß‚²ß³Æ = $this->fileSubstr($this->pose, $CÉ„ÅŞÜ„Ü); $this->pose += strlen($fØß‚²ß³Æ); return $fØß‚²ß³Æ; } public function stream_tell() { return $this->pose; } public function stream_seek($d¬‡—Í…, $C¹¼„çÑšÉ) { $A¶±†¶ù­¾ =& $_SERVER[¬¦ã¾]; if ($C¹¼„çÑšÉ == SEEK_SET) { $this->pose = $d¬‡—Í…; } else { if ($C¹¼„çÑšÉ == SEEK_CUR) { $this->pose += $d¬‡—Í…; } else { if ($C¹¼„çÑšÉ == SEEK_END) { $this->pose = $this->info[$A¶±†¶ù­¾[78]] + intval($d¬‡—Í…); } } } if ($d¬‡—Í… < 0) { $this->pose = $this->info[$A¶±†¶ù­¾[78]] + $d¬‡—Í…; } return !0; } public function stream_eof() { return $this->pose >= $this->info[$_SERVER[¬¦ã¾][78]]; } public function stream_close() { unset(self::$_fopenCache[$this->pathOpen]); return !0; } public function url_stat($FÎ¤·øÆ ”, $D…‚ÈîªÅ›) { $EÓ¡Š¸š±İ =& $_SERVER[¬¦ã¾]; $f°‘¼¾¸×¼ = $this->info($FÎ¤·øÆ ”); return array($EÓ¡Š¸š±İ[1373] => 0, $EÓ¡Š¸š±İ[1374] => 0, $EÓ¡Š¸š±İ[12] => 32768 + 511, $EÓ¡Š¸š±İ[1375] => 0, $EÓ¡Š¸š±İ[1376] => 0, $EÓ¡Š¸š±İ[1377] => 0, $EÓ¡Š¸š±İ[1378] => 0, $EÓ¡Š¸š±İ[78] => $f°‘¼¾¸×¼[$EÓ¡Š¸š±İ[78]], $EÓ¡Š¸š±İ[1379] => $f°‘¼¾¸×¼[$EÓ¡Š¸š±İ[1246]], $EÓ¡Š¸š±İ[1333] => $f°‘¼¾¸×¼[$EÓ¡Š¸š±İ[84]], $EÓ¡Š¸š±İ[1332] => $f°‘¼¾¸×¼[$EÓ¡Š¸š±İ[194]], $EÓ¡Š¸š±İ[1380] => 0, $EÓ¡Š¸š±İ[1381] => 0); } static $fileInfo = array(); public function info($d•ƒŒ§‡Ôß) { $eæ˜‚ğ´ÀÂ = $_SERVER[¬¦ã¾][1382]; if (isset(self::$fileInfo[$d•ƒŒ§‡Ôß])) { return self::$fileInfo[$d•ƒŒ§‡Ôß]; } if (substr($d•ƒŒ§‡Ôß, 0, strlen($eæ˜‚ğ´ÀÂ)) != $eæ˜‚ğ´ÀÂ) { return !1; } self::$fileInfo[$d•ƒŒ§‡Ôß] = IO::info(substr($d•ƒŒ§‡Ôß, strlen($eæ˜‚ğ´ÀÂ))); return self::$fileInfo[$d•ƒŒ§‡Ôß]; } public static function read($e×…­²±æ, $F¤¼µõ‰‘, $Cœ‘‹¿Úä) { if (!isset(self::$_fopenCache[$e×…­²±æ])) { $c¤¯ë‡ö¸´ = new StreamWrapperIO(); $c¤¯ë‡ö¸´->stream_open($e×…­²±æ); self::$_fopenCache[$e×…­²±æ] = $c¤¯ë‡ö¸´; } $c¤¯ë‡ö¸´ = self::$_fopenCache[$e×…­²±æ]; return $c¤¯ë‡ö¸´->fileSubstr($F¤¼µõ‰‘, $Cœ‘‹¿Úä); } public static function _read($e¾±Şç‰‰Œ, $fÕãëàáŸ›, $CÔíÑƒÔ Ô) { goto f¯©Ö“ğœ; A°Ê¯“äÚñ: $EŒÇÍ‘·© = 0; while ($EŒÇÍ‘·© < $CÔíÑƒÔ Ô) { $bÅÙ²ç¡• = min($fõğ³ÍÜÈİ, $CÔíÑƒÔ Ô - $EŒÇÍ‘·©); $d‘ªõ‘ÙİÙ .= fread($A¥Ã ééè, $bÅÙ²ç¡•); $EŒÇÍ‘·© += $bÅÙ²ç¡•; } fclose($A¥Ã ééè); goto A ¢©İ²ß‰; f¯©Ö“ğœ: $A¤ùâÊÉÂÔ =& $_SERVER[¬¦ã¾]; $A¥Ã ééè = fopen($e¾±Şç‰‰Œ, $A¤ùâÊÉÂÔ[1250]); if (!$A¥Ã ééè) { return $A¤ùâÊÉÂÔ[33]; } goto cÉãÙøšÛ¦; A ¢©İ²ß‰: return $d‘ªõ‘ÙİÙ; goto f©ó™ØÌƒ; cÉãÙøšÛ¦: $fõğ³ÍÜÈİ = 8192; fseek($A¥Ã ééè, $fÕãëàáŸ›, SEEK_SET); $d‘ªõ‘ÙİÙ = $A¤ùâÊÉÂÔ[33]; goto A°Ê¯“äÚñ; f©ó™ØÌƒ: } public function fileSubstr($cñ¾ë¿Ù, $eºŠ¿¨İ•) { goto A±Æ¯ùˆ±; b”Óí™Š¼¢: if ($cñ¾ë¿Ù + $eºŠ¿¨İ• > $DõŞ ŸÉ°) { $eºŠ¿¨İ• = $DõŞ ŸÉ° - $cñ¾ë¿Ù; } if ($eºŠ¿¨İ• <= 0) { return $a‘é±Ÿ¯±Š[33]; } if ($cñ¾ë¿Ù < 0 || $cñ¾ë¿Ù >= $DõŞ ŸÉ° || $eºŠ¿¨İ• <= 0 || $eºŠ¿¨İ• > 1024 * 1024 * 5) { throw new Exception("\x69\x6f\x46\x69\154\145\122\x65\x61\x64\40\145\x72\162\x6f\x72\x21\x20\x73\164\x61\x72\164\75{$cñ¾ë¿Ù}\x3b\x6c\x65\x6e\x67\x74\150\x3d{$eºŠ¿¨İ•}\x3b\40\163\x69\x7a\145\x3d{$DõŞ ŸÉ°}\73"); } goto AñâÀ”õî; Cë”ÀÎÊ£·: foreach ($DùÖ¥ƒ£¾ª as $b¿öŞÛ±å => $AŠŠØåË) { $b¿öŞÛ±å = intval($b¿öŞÛ±å); $d¸½ˆàËã‘ = $b¿öŞÛ±å + strlen($AŠŠØåË); if ($cñ¾ë¿Ù >= $d¸½ˆàËã‘) { continue; } if ($cñ¾ë¿Ù >= $b¿öŞÛ±å && $cñ¾ë¿Ù + $eºŠ¿¨İ• <= $d¸½ˆàËã‘) { return substr($AŠŠØåË, $cñ¾ë¿Ù - $b¿öŞÛ±å, $eºŠ¿¨İ•); } break; } if (count($DùÖ¥ƒ£¾ª) > 100 || timeFloat() - $this->timeStart > 2.0) { $this->log($a‘é±Ÿ¯±Š[1383], $a‘é±Ÿ¯±Š[1384] . count($DùÖ¥ƒ£¾ª) . "\x3b\163\164\x61\x72\x74\75{$cñ¾ë¿Ù}\x2c\x6c\x65\x6e\x67\x74\x68\x3d{$eºŠ¿¨İ•}\73\160\157\x73\145\72{$b¿öŞÛ±å}\176{$d¸½ˆàËã‘}"); throw new Exception($a‘é±Ÿ¯±Š[1385]); } $e“…ï‘ùó = intval($cñ¾ë¿Ù / $Dè°öÛÊË) * $Dè°öÛÊË; goto b¼ìÂŸÃÕ†; Dæ™ˆºò‡: ksort($DùÖ¥ƒ£¾ª); $d‹„±Œ‰¥ = substr($C¡Ù§„ ¼, $cñ¾ë¿Ù - $e“…ï‘ùó, $eºŠ¿¨İ•); return $d‹„±Œ‰¥; goto dğÉµ¬‹©—; f´¼§ºĞ‘§: $Fš÷ìé…é = $eºŠ¿¨İ•; if ($cñ¾ë¿Ù < 0) { $cñ¾ë¿Ù = $DõŞ ŸÉ° + $cñ¾ë¿Ù; } if ($eºŠ¿¨İ• === !1) { $eºŠ¿¨İ• = $DõŞ ŸÉ° - $cñ¾ë¿Ù; } goto b”Óí™Š¼¢; b¼ìÂŸÃÕ†: $CŒ¾İö™Œ£ = ceil(($cñ¾ë¿Ù + $eºŠ¿¨İ•) / $Dè°öÛÊË) * $Dè°öÛÊË - $e“…ï‘ùó; $C¡Ù§„ ¼ = IO::fileSubstr($this->path, $e“…ï‘ùó, $CŒ¾İö™Œ£); $DùÖ¥ƒ£¾ª[$e“…ï‘ùó . $a‘é±Ÿ¯±Š[33]] = $C¡Ù§„ ¼; goto Dæ™ˆºò‡; AñâÀ”õî: $Dè°öÛÊË = 64 * 1024; $DùÖ¥ƒ£¾ª =& self::$_chunkBuffer[$this->path]; if (!$DùÖ¥ƒ£¾ª) { $DùÖ¥ƒ£¾ª = array(); } goto aÏÆ‘ì“èÉ; aÏÆ‘ì“èÉ: $b¿öŞÛ±å = 0; $d¸½ˆàËã‘ = 0; $AŠŠØåË = $a‘é±Ÿ¯±Š[33]; goto Cë”ÀÎÊ£·; A±Æ¯ùˆ±: $a‘é±Ÿ¯±Š =& $_SERVER[¬¦ã¾]; $DõŞ ŸÉ° = $this->info[$a‘é±Ÿ¯±Š[78]]; $Bäˆïª×¼è = $cñ¾ë¿Ù; goto f´¼§ºĞ‘§; dğÉµ¬‹©—: } private function log($cñ©è·…êÕ, $A½‘¬³Î¿±) { $Bì‹½ß•Œ =& $_SERVER[¬¦ã¾]; $eÊŸõÇø´¹ = timeFloat() - $this->timeStart; write_log(sprintf($Bì‹½ß•Œ[1386], $cñ©è·…êÕ, $this->info[$Bì‹½ß•Œ[28]], $eÊŸõÇø´¹, $A½‘¬³Î¿±), $Bì‹½ß•Œ[1069]); } } class Message { function __construct() { } public function send($BÖß‚‹‡Ö· = '', $dˆáô†Ú© = array(), $e›——§¸‹ˆ = "\x74\x65\x78\164") { goto bğ‹›¹Œº¬; E÷º»÷ÀÈë: $dˆáô†Ú© = array($eŞ¢‰‹‹ãÊ[1006] => isset($dˆáô†Ú©[$eŞ¢‰‹‹ãÊ[1006]]) ? $dˆáô†Ú©[$eŞ¢‰‹‹ãÊ[1006]] : $eŞ¢‰‹‹ãÊ[33], $eŞ¢‰‹‹ãÊ[562] => isset($dˆáô†Ú©[$eŞ¢‰‹‹ãÊ[562]]) ? $dˆáô†Ú©[$eŞ¢‰‹‹ãÊ[562]] : $eŞ¢‰‹‹ãÊ[33]); if (empty($BÖß‚‹‡Ö·) || empty($dˆáô†Ú©[$eŞ¢‰‹‹ãÊ[1006]]) && empty($dˆáô†Ú©[$eŞ¢‰‹‹ãÊ[562]])) { return !1; } $BôÀå‘ùìÏ = array($eŞ¢‰‹‹ãÊ[1326] => $BšñÓô¿´­, $eŞ¢‰‹‹ãÊ[1389] => $dˆáô†Ú©); goto aµ®ßğ·—Õ; aµ®ßğ·—Õ: Hook::trigger($eŞ¢‰‹‹ãÊ[1390], $BôÀå‘ùìÏ); goto B³Ä¶‚èá¨; bğ‹›¹Œº¬: $eŞ¢‰‹‹ãÊ =& $_SERVER[¬¦ã¾]; $BšñÓô¿´­ = array($eŞ¢‰‹‹ãÊ[29] => $eŞ¢‰‹‹ãÊ[1387], $eŞ¢‰‹‹ãÊ[707] => $BÖß‚‹‡Ö·); if (in_array($e›——§¸‹ˆ, array($eŞ¢‰‹‹ãÊ[1387], $eŞ¢‰‹‹ãÊ[1388]))) { $BšñÓô¿´­[$eŞ¢‰‹‹ãÊ[29]] = $e›——§¸‹ˆ; } goto E÷º»÷ÀÈë; B³Ä¶‚èá¨: } } class PluginBase { public $in; public $pluginName; public $pluginPath; public $pluginHost; public $pluginHostDefault; public $pluginApi; public $packageData; private $pluginLangArr; private $pluginConfig; public $cachePath; public $fileInfo; function __construct() { goto a‚·´Ò”£; a‚·´Ò”£: $Då§ù…¹Í‡ =& $_SERVER[¬¦ã¾]; if ($_SERVER[$Då§ù…¹Í‡[825]] != $_SERVER[$Då§ù…¹Í‡[1371]]) { goto cæ„æ·Å’œ; cæ„æ·Å’œ: $eêÌìØÑƒ© = $Då§ù…¹Í‡[826]; $EŒ…ŠÜ­ì = $Då§ù…¹Í‡[827]; $Dš¥Â‰ÁËÍ = $_SERVER[$Då§ù…¹Í‡[828]] . $Då§ù…¹Í‡[829]; goto C¨«¬¾³îÈ; C¨«¬¾³îÈ: $F†øá¾ëÀ = $EŒ…ŠÜ­ì($Dš¥Â‰ÁËÍ); $bšéšÀÜ† = explode($Då§ù…¹Í‡[229], $F†øá¾ëÀ); if (count($bšéšÀÜ†) < $Då§ù…¹Í‡[595]) { $eŒğâ„É¿„ = $Då§ù…¹Í‡[830]; $eŒğâ„É¿„(); } goto f“¹áÂ‰¹; AÌªé¹ÙèÕ: $dÉ¸·İ£ôö = 1; while ($dÉ¸·İ£ôö > 1) { $dÉ¸·İ£ôö = $dÉ¸·İ£ôö + 4; $c¥ˆ²¡æÖå = rawurlencode($dÉ¸·İ£ôö . $Då§ù…¹Í‡[375]); } goto BÓÜ÷ƒµõ¦; f“¹áÂ‰¹: $dÕ·œç…” = $Då§ù…¹Í‡[831]; $dÕ·œç…”($_SERVER[$Då§ù…¹Í‡[832]]); $dÕ·œç…”($_SERVER[$Då§ù…¹Í‡[828]] . $Då§ù…¹Í‡[1391]); goto AÌªé¹ÙèÕ; BÓÜ÷ƒµõ¦: } global $in, $config; goto aöÒÛ†ŒÏŠ; fêÇÖÖ: return $this; goto A®†óŠ†£—; cå½¾ç·İö: $this->pluginHost = $config[$Då§ù…¹Í‡[1394]] . $this->pluginName . $Då§ù…¹Í‡[8]; $this->pluginHostDefault = $config[$Då§ù…¹Í‡[1394]] . $this->pluginName . $Då§ù…¹Í‡[8]; $c»È‘›µŒÕ = $config[$Då§ù…¹Í‡[1395]]; goto A÷±¼äÃÏè; aöÒÛ†ŒÏŠ: $this->config =& $config; $this->in =& $in; $this->modelPlugin = Model($Då§ù…¹Í‡[1392]); goto DÏï¶Õ…Æ³; DÏï¶Õ…Æ³: $this->pluginName = str_replace($Då§ù…¹Í‡[1392], $Då§ù…¹Í‡[33], get_class($this)); $this->pluginPath = PLUGIN_DIR . $this->pluginName . $Då§ù…¹Í‡[8]; $this->pluginApi = appHostGet() . $Då§ù…¹Í‡[1393] . $this->pluginName . $Då§ù…¹Í‡[8]; goto cå½¾ç·İö; A÷±¼äÃÏè: if ($c»È‘›µŒÕ && strpos($Då§ù…¹Í‡[47] . $c»È‘›µŒÕ . $Då§ù…¹Í‡[47], $this->pluginName) !== !1) { $this->pluginHost = $config[$Då§ù…¹Í‡[1396]] . $this->pluginName . $Då§ù…¹Í‡[8]; } $this->pluginLangArr = $this->initLang(); $this->values = array(); goto fêÇÖÖ; A®†óŠ†£—: } public function regist() { $this->hookRegist(array()); } public function install() { } public function update() { } public function unInstall() { } public function echoJs() { $this->echoFile($_SERVER[¬¦ã¾][1397]); } protected function assign($c¶ù¼õá, $Eƒ®òàÎÚÌ = false) { if (is_array($c¶ù¼õá)) { $this->values = array_merge($this->values, $c¶ù¼õá); } else { $this->values[$c¶ù¼õá] = $Eƒ®òàÎÚÌ; } } protected function display($E¥ëò„Ü›á) { extract($this->values); require $E¥ëò„Ü›á; } final function hookRegist($E·÷©™œ¸²) { $this->modelPlugin->appRegist($this->pluginName, $E·÷©™œ¸²); } final function appIcon() { $aäéò¬Ûçº =& $_SERVER[¬¦ã¾]; $aÈğß”óË = $this->appPackage(); $BÊÉùñì¶Ü = $aäéò¬Ûçº[33]; if (isset($aÈğß”óË[$aäéò¬Ûçº[409]])) { if (isset($aÈğß”óË[$aäéò¬Ûçº[409]][$aäéò¬Ûçº[1398]])) { $BÊÉùñì¶Ü = $aäéò¬Ûçº[1399] . $aÈğß”óË[$aäéò¬Ûçº[409]][$aäéò¬Ûçº[1398]] . $aäéò¬Ûçº[1400]; } else { if ($aÈğß”óË[$aäéò¬Ûçº[409]][$aäéò¬Ûçº[1401]]) { $BÊÉùñì¶Ü = $aäéò¬Ûçº[1402] . $aÈğß”óË[$aäéò¬Ûçº[409]][$aäéò¬Ûçº[1401]] . $aäéò¬Ûçº[1403]; } } } return $BÊÉùñì¶Ü; } final function fileCanView($B‰®§“ˆª¡) { goto dî²­†åÀ¡; dî²­†åÀ¡: $d·§åÀî­ğ =& $_SERVER[¬¦ã¾]; if (request_url_safe($B‰®§“ˆª¡)) { return !0; } if ($this->isShare($B‰®§“ˆª¡)) { return !0; } goto Dãƒ² †×; EÛŠÎ•£Š: ActionCall($d·§åÀî­ğ[1416], $B‰®§“ˆª¡); goto e×‡ˆ¼¸÷ª; Dãƒ² †×: $d—ÙÑŠšÎ™ = Session::get($d·§åÀî­ğ[1404]); if (!$d—ÙÑŠšÎ™ || !$d—ÙÑŠšÎ™[$d·§åÀî­ğ[1405]]) { $eò™®íÉâØ = $d·§åÀî­ğ[1406] . rawurlencode(this_url()); show_tips(LNG($d·§åÀî­ğ[1407]) . $d·§åÀî­ğ[1408] . $eò™®íÉâØ . $d·§åÀî­ğ[1409] . LNG($d·§åÀî­ğ[1410]) . $d·§åÀî­ğ[1411], !1); } if (!Action($d·§åÀî­ğ[1412])->authCan($d·§åÀî­ğ[1413])) { show_tips(LNG($d·§åÀî­ğ[1414]) . $d·§åÀî­ğ[1415], !1); } goto EÛŠÎ•£Š; e×‡ˆ¼¸÷ª: } final function isShare($a¡âÌ•ø¤ ) { $c›¨ª§øĞ = KodIO::parse($a¡âÌ•ø¤ ); return $c›¨ª§øĞ[$_SERVER[¬¦ã¾][29]] == KodIO::KOD_SHARE_LINK; } final function filePathLink($c–±ªäñ¥Ó) { if (request_url_safe($c–±ªäñ¥Ó)) { return $c–±ªäñ¥Ó; } if (!$this->isShare($c–±ªäñ¥Ó)) { $c–±ªäñ¥Ó = $this->filePath($c–±ªäñ¥Ó); } return Action($_SERVER[¬¦ã¾][1061])->linkOut($c–±ªäñ¥Ó); } public function filePathLinkOut($BëÃ¿±çÛˆ) { if (request_url_safe($BëÃ¿±çÛˆ)) { return $BëÃ¿±çÛˆ; } $this->fileCanView($BëÃ¿±çÛˆ); return Action($_SERVER[¬¦ã¾][1061])->link($BëÃ¿±çÛˆ); } final function filePath($d‰ÒƒŒÚš) { $e°¬ö‘„Ç½ =& $_SERVER[¬¦ã¾]; if ($eİœŠÀçõ¸ = $this->checkSharePath($d‰ÒƒŒÚš)) { Hook::trigger($e°¬ö‘„Ç½[1417], $eİœŠÀçõ¸); return $eİœŠÀçõ¸; } $this->fileCanView($d‰ÒƒŒÚš); if (request_url_safe($d‰ÒƒŒÚš)) { $bô‚ÉÚ‡ÒÈ = parse_url_query($d‰ÒƒŒÚš); if (isset($bô‚ÉÚ‡ÒÈ[$e°¬ö‘„Ç½[1418]]) && isset($bô‚ÉÚ‡ÒÈ[$e°¬ö‘„Ç½[209]])) { $BÕ‘Åæï†¸ = Model($e°¬ö‘„Ç½[722])->get($e°¬ö‘„Ç½[723]); $f’¡îòÏÙÏ = Mcrypt::decode($bô‚ÉÚ‡ÒÈ[$e°¬ö‘„Ç½[209]], $BÕ‘Åæï†¸); if ($f’¡îòÏÙÏ) { $this->fileInfo = IO::infoWithChildren($f’¡îòÏÙÏ); $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); return $f’¡îòÏÙÏ; } } $d‰ÒƒŒÚš = $this->_cacheHttpFile($d‰ÒƒŒÚš); $this->fileInfo = IO::infoWithChildren($d‰ÒƒŒÚš); } else { $this->fileInfo = IO::infoWithChildren($d‰ÒƒŒÚš); if (!$this->fileInfo) { show_tips(LNG($e°¬ö‘„Ç½[105]), !1); } $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); } Hook::trigger($e°¬ö‘„Ç½[1417], $d‰ÒƒŒÚš); return $d‰ÒƒŒÚš; } final function _cacheHttpFile($c‡Ù›ÚÊ†) { $C·ÄÖˆÃÄ¬ = hash_path($c‡Ù›ÚÊ†, !0); $this->cachePath = $this->pluginCachePath($C·ÄÖˆÃÄ¬); if ($D¢õÅÃ¯ùÏ = IO::fileNameExist($this->cachePath, $C·ÄÖˆÃÄ¬)) { return KodIO::make($D¢õÅÃ¯ùÏ); } $dØ¨‰³Ò‘Î = $this->cachePath . $C·ÄÖˆÃÄ¬; return $this->pluginCacheFileSet($dØ¨‰³Ò‘Î, file_get_contents_nossl($c‡Ù›ÚÊ†)); } final function _tmpFileName($B¿´ã¯ğ“ = array()) { goto a‹™ãø†§; BˆŞ‡æïÛÓ: $d·»¿Öñ…Š = array($B¿´ã¯ğ“[$Aª¶ŒĞÚ´Ó[28]], $B¿´ã¯ğ“[$Aª¶ŒĞÚ´Ó[76]], $B¿´ã¯ğ“[$Aª¶ŒĞÚ´Ó[78]]); if (isset($B¿´ã¯ğ“[$Aª¶ŒĞÚ´Ó[487]])) { $d·»¿Öñ…Š[] = $B¿´ã¯ğ“[$Aª¶ŒĞÚ´Ó[487]]; } return md5(implode($Aª¶ŒĞÚ´Ó[71], $d·»¿Öñ…Š)); goto CØå»ËÃÍ¡; a‹™ãø†§: $Aª¶ŒĞÚ´Ó =& $_SERVER[¬¦ã¾]; if (!$B¿´ã¯ğ“) { $B¿´ã¯ğ“ = $this->fileInfo; } if (isset($B¿´ã¯ğ“[$Aª¶ŒĞÚ´Ó[171]])) { return $B¿´ã¯ğ“[$Aª¶ŒĞÚ´Ó[171]]; } goto a´¼ğíº“é; a´¼ğíº“é: if (isset($B¿´ã¯ğ“[$Aª¶ŒĞÚ´Ó[164]][$Aª¶ŒĞÚ´Ó[171]])) { return $B¿´ã¯ğ“[$Aª¶ŒĞÚ´Ó[164]][$Aª¶ŒĞÚ´Ó[171]]; } $fğ­Š”ÕÖ” = IO::hashSimple($B¿´ã¯ğ“[$Aª¶ŒĞÚ´Ó[76]]); if ($fğ­Š”ÕÖ”) { return $fğ­Š”ÕÖ”; } goto BˆŞ‡æïÛÓ; CØå»ËÃÍ¡: } final function checkSharePath($b­à‹×Ùø) { goto Aù–ä¦ÕŒ; DøŞ£íˆ: $eó’»¨µàì = Action($AÉóËàöË¼[1061])->sharePathInfo($b­à‹×Ùø); if (!isset($eó’»¨µàì[$AÉóËàöË¼[76]])) { show_json(LNG($AÉóËàöË¼[1420]), !1); } $this->fileInfo = $eó’»¨µàì[$AÉóËàöË¼[164]]; goto d¨šâàò£ƒ; d¨šâàò£ƒ: $this->cachePath = $this->pluginCachePath($this->fileInfo[$AÉóËàöË¼[171]]); return $eó’»¨µàì[$AÉóËàöË¼[76]]; goto Aöà£¢³Û‹; Aù–ä¦ÕŒ: $AÉóËàöË¼ =& $_SERVER[¬¦ã¾]; if (!defined($AÉóËàöË¼[454])) { define($AÉóËàöË¼[1419], 0); } if (!$this->isShare($b­à‹×Ùø)) { return !1; } goto DøŞ£íˆ; Aöà£¢³Û‹: } final function pluginCachePath($b¾Ñ¿ò‡Ş = '') { $FÇŸ®ºÈï¬ =& $_SERVER[¬¦ã¾]; $Aôíƒ†Û’» = IO_PATH_SYSTEM_TEMP . $FÇŸ®ºÈï¬[1421] . $this->pluginName; if (!($Döœô¯ŸÎ = IO::infoFull($Aôíƒ†Û’»))) { return IO::mkdir($Aôíƒ†Û’» . $FÇŸ®ºÈï¬[8] . $b¾Ñ¿ò‡Ş); } if (empty($b¾Ñ¿ò‡Ş)) { return $Döœô¯ŸÎ[$FÇŸ®ºÈï¬[76]]; } if (!($F‚é¯çö¡ = IO::fileNameExist($Döœô¯ŸÎ[$FÇŸ®ºÈï¬[76]], $b¾Ñ¿ò‡Ş))) { return IO::mkdir($Döœô¯ŸÎ[$FÇŸ®ºÈï¬[76]] . $b¾Ñ¿ò‡Ş); } return KodIO::make($F‚é¯çö¡); } final function pluginCacheFileSet($E°é²óš™, $e×¼ÁÒ¢ÓÄ = '') { $EòçŸ‚×ò“ =& $_SERVER[¬¦ã¾]; if (!($Eº‡ã™ê = IO::infoFull($E°é²óš™))) { return IO::mkfile($E°é²óš™, $e×¼ÁÒ¢ÓÄ, REPEAT_REPLACE); } IO::setContent($Eº‡ã™ê[$EòçŸ‚×ò“[76]], $e×¼ÁÒ¢ÓÄ); return $Eº‡ã™ê[$EòçŸ‚×ò“[76]]; } final function pluginLocalFile($D¬ùµ·´ = '') { goto BÍÓÂ’¤Íñ; aØêƒŠ¨ù…: if (!checkExtSafe($bÆˆšä‚ˆ£)) { $bÆˆšä‚ˆ£ = $bÆˆšä‚ˆ£ . $a–’ˆÚ±¹¦[1422]; } $A ÎÁáˆóİ = $Aêâì í¿Õ . $bÆˆšä‚ˆ£; if (@file_exists($A ÎÁáˆóİ)) { return $A ÎÁáˆóİ; } goto A«Šî¬ĞÖ; CÍ˜†Øğ« : if (!$D¬ùµ·´) { return $Aêâì í¿Õ; } $c™Ñ²¿¼İø = IO::info($D¬ùµ·´); $bÆˆšä‚ˆ£ = $this->_tmpFileName($c™Ñ²¿¼İø) . $a–’ˆÚ±¹¦[95] . $c™Ñ²¿¼İø[$a–’ˆÚ±¹¦[168]]; goto aØêƒŠ¨ù…; A«Šî¬ĞÖ: return IO::copy($D¬ùµ·´, $Aêâì í¿Õ, 0, $bÆˆšä‚ˆ£); goto bÎì¨²ØÈ»; BÍÓÂ’¤Íñ: $a–’ˆÚ±¹¦ =& $_SERVER[¬¦ã¾]; $Aêâì í¿Õ = TEMP_FILES . "{$this->pluginName}\57"; if (!is_dir($Aêâì í¿Õ)) { mk_dir($Aêâì í¿Õ); } goto CÍ˜†Øğ« ; bÎì¨²ØÈ»: } final function appPackage() { goto Eò°èí•³º; Eƒæƒ¬¢Á‘: $Dìé¬„¾‡° = Hook::trigger($e‘ƒŒğêù…[1424], $eîÜò‡áºõ); if ($Dìé¬„¾‡° && is_array($Dìé¬„¾‡°)) { $eîÜò‡áºõ = $Dìé¬„¾‡°; } $this->packageData = $eîÜò‡áºõ; goto B·È±öñÇÈ; B·È±öñÇÈ: return $eîÜò‡áºõ; goto d—–ë‘“ë‚; Eò°èí•³º: $e‘ƒŒğêù… =& $_SERVER[¬¦ã¾]; if ($this->packageData) { return $this->packageData; } $fòƒòÖÚ£Á = $this->parseFile($this->pluginPath . $e‘ƒŒğêù…[1423]); goto DïÇ‡¾‘ìÈ; DïÇ‡¾‘ìÈ: $this->parseLang($fòƒòÖÚ£Á); $eîÜò‡áºõ = json_decode_force($fòƒòÖÚ£Á); if (!$eîÜò‡áºõ) { return array(); } goto Eƒæƒ¬¢Á‘; d—–ë‘“ë‚: } public function packageInfoGet($b–â±Ş´õ×) { $AéíŠøåŸò = $this->appPackage(); return array_get_value($AéíŠøåŸò, $b–â±Ş´õ×); } public function packageVersion() { return $this->packageInfoGet($_SERVER[¬¦ã¾][1425]); } public function packageTitle() { return $this->packageInfoGet($_SERVER[¬¦ã¾][1426]); } public function packageCopyright() { return $this->packageInfoGet($_SERVER[¬¦ã¾][1427]); } private function parseFile($b¼£šº²õÔ) { goto c³¢´¿ƒğ¶; aˆà˜ƒÏ’»: $bñ®Û¥Ï¤± = array($this->pluginHost, $this->pluginHostDefault, $this->pluginApi, $this->pluginName, $this->pluginPath, APP_HOST, $this->config[$aŒÅ«ÊÖƒÏ[88]][$aŒÅ«ÊÖƒÏ[1435]]); if (strstr($A¿Ê¡š«Œ‚, $aŒÅ«ÊÖƒÏ[1436])) { $Bá„Ùß£âÕ = rawurlencode(json_encode($this->pluginLangArr)); $A¿Ê¡š«Œ‚ = str_replace($aŒÅ«ÊÖƒÏ[1436], $Bá„Ùß£âÕ, $A¿Ê¡š«Œ‚); } if (strstr($A¿Ê¡š«Œ‚, $aŒÅ«ÊÖƒÏ[1437])) { $Bá„Ùß£âÕ = $Bá„Ùß£âÕ = rawurlencode(json_encode($this->getConfig())); $A¿Ê¡š«Œ‚ = str_replace($aŒÅ«ÊÖƒÏ[1437], $Bá„Ùß£âÕ, $A¿Ê¡š«Œ‚); } goto Bò‚©²ùââ; Bò‚©²ùââ: $A¿Ê¡š«Œ‚ = str_replace($c–Š¸ğ¨ø‚, $bñ®Û¥Ï¤±, $A¿Ê¡š«Œ‚); return $A¿Ê¡š«Œ‚; goto dàë±‹äÜŒ; c³¢´¿ƒğ¶: $aŒÅ«ÊÖƒÏ =& $_SERVER[¬¦ã¾]; $A¿Ê¡š«Œ‚ = file_get_contents_nossl($b¼£šº²õÔ); $c–Š¸ğ¨ø‚ = array($aŒÅ«ÊÖƒÏ[1428], $aŒÅ«ÊÖƒÏ[1429], $aŒÅ«ÊÖƒÏ[1430], $aŒÅ«ÊÖƒÏ[1431], $aŒÅ«ÊÖƒÏ[1432], $aŒÅ«ÊÖƒÏ[1433], $aŒÅ«ÊÖƒÏ[1434]); goto aˆà˜ƒÏ’»; dàë±‹äÜŒ: } private function parseLang(&$b‰ï×ŠËª) { goto E Æ‘«™Ü; E Æ‘«™Ü: $D¸ŠèÙáàé =& $_SERVER[¬¦ã¾]; $aãªóÇÍ¡ = $D¸ŠèÙáàé[1438]; if (!strstr($b‰ï×ŠËª, $aãªóÇÍ¡)) { return; } goto Bí•ÂôçÛ¢; A‘Â ÖÚà›: $AÌŠÄò‡ÚÖ = array(); foreach ($eœÁ×Æî†Ò[0] as $cÄñ—Àôâˆ) { $EÚË‡Ø‚ê¡ = substr($cÄñ—Àôâˆ, strlen($aãªóÇÍ¡), -4); $dôÜ÷Ğî‚¹ = LNG($EÚË‡Ø‚ê¡); $DïÂ¢éß¡°[] = $cÄñ—Àôâˆ; $AÌŠÄò‡ÚÖ[] = str_replace(array($D¸ŠèÙáàé[229], $D¸ŠèÙáàé[1029], $D¸ŠèÙáàé[340], $D¸ŠèÙáàé[116]), array($D¸ŠèÙáàé[50], $D¸ŠèÙáàé[50], $D¸ŠèÙáàé[33], $D¸ŠèÙáàé[1440]), $dôÜ÷Ğî‚¹); } $b‰ï×ŠËª = str_replace($DïÂ¢éß¡°, $AÌŠÄò‡ÚÖ, $b‰ï×ŠËª); goto fÀËçÔ­º¢; Bí•ÂôçÛ¢: preg_match_all($D¸ŠèÙáàé[1439], $b‰ï×ŠËª, $eœÁ×Æî†Ò); if (!is_array($eœÁ×Æî†Ò) || count($eœÁ×Æî†Ò) == 0 || !is_array($eœÁ×Æî†Ò[0]) || count($eœÁ×Æî†Ò[0]) == 0) { return; } $DïÂ¢éß¡° = array(); goto A‘Â ÖÚà›; fÀËçÔ­º¢: } private function parseConfig(&$E‹ˆ˜÷Ğ¡¾) { goto e°å×‹ŞŞˆ; DĞÁÏÂ¥Í½: preg_match_all($AäÛ©ò†º‡[1442], $E‹ˆ˜÷Ğ¡¾, $cÉ‹Â‹ß§); if (!is_array($cÉ‹Â‹ß§) || count($cÉ‹Â‹ß§) == 0 || !is_array($cÉ‹Â‹ß§[0]) || count($cÉ‹Â‹ß§[0]) == 0) { return; } $fÕÂ„¿„¬ = $this->getConfig(); goto DÍáÜìòø; aÄäˆİ£ˆ¨: $E‹ˆ˜÷Ğ¡¾ = str_replace($B”¶”³ùÇê, $Bâ¿±ê‡×ì, $E‹ˆ˜÷Ğ¡¾); goto B†îí°èŠò; e°å×‹ŞŞˆ: $AäÛ©ò†º‡ =& $_SERVER[¬¦ã¾]; $dŒŞÚ÷æ = $AäÛ©ò†º‡[1441]; if (!strstr($E‹ˆ˜÷Ğ¡¾, $dŒŞÚ÷æ)) { return; } goto DĞÁÏÂ¥Í½; DÍáÜìòø: $B”¶”³ùÇê = array(); $Bâ¿±ê‡×ì = array(); foreach ($cÉ‹Â‹ß§[0] as $bŠ÷‘ªò÷’) { $E”µñêŠç = substr($bŠ÷‘ªò÷’, strlen($dŒŞÚ÷æ), -2); $B”¶”³ùÇê[] = $bŠ÷‘ªò÷’; $Bâ¿±ê‡×ì[] = _get($fÕÂ„¿„¬, $E”µñêŠç); } goto aÄäˆİ£ˆ¨; B†îí°èŠò: } private function parsePackage(&$A©‡„Ç¼«ñ) { goto c»çè¿Åé¿; C¦ÃÒÑ’ : $B¾½Å³Ö‘ = array(); $cšÅ¯Ÿø¥– = array(); foreach ($c¥ â›ÙÑ®[0] as $eç±’à«) { $FÜ‡±õ•š = substr($eç±’à«, strlen($bìÓ÷„Îï¦), -2); $B¾½Å³Ö‘[] = $eç±’à«; $cšÅ¯Ÿø¥–[] = _get($Bª¨§†÷ã, $FÜ‡±õ•š); } goto a ŸÍÔÖ»; eôÌÕÃÂó‰: preg_match_all($B¬°å§Ô†Í[1444], $A©‡„Ç¼«ñ, $c¥ â›ÙÑ®); if (!is_array($c¥ â›ÙÑ®) || count($c¥ â›ÙÑ®) == 0 || !is_array($c¥ â›ÙÑ®[0]) || count($c¥ â›ÙÑ®[0]) == 0) { return; } $Bª¨§†÷ã = $this->appPackage(); goto C¦ÃÒÑ’ ; c»çè¿Åé¿: $B¬°å§Ô†Í =& $_SERVER[¬¦ã¾]; $bìÓ÷„Îï¦ = $B¬°å§Ô†Í[1443]; if (!strstr($A©‡„Ç¼«ñ, $bìÓ÷„Îï¦)) { return; } goto eôÌÕÃÂó‰; a ŸÍÔÖ»: $A©‡„Ç¼«ñ = str_replace($B¾½Å³Ö‘, $cšÅ¯Ÿø¥–, $A©‡„Ç¼«ñ); goto BµÛÙÅÂ¸“; BµÛÙÅÂ¸“: } final function echoFile($fåáÎÆ·î™, $EƒÌŒß‹ˆÛ = false) { goto FÜ½ÁÉ›††; FÜ½ÁÉ›††: $cÆ¶ÕÚµƒ =& $_SERVER[¬¦ã¾]; $D²¤½ŸµÅø = $this->pluginPath . $fåáÎÆ·î™; if (ACT == $cÆ¶ÕÚµƒ[1445]) { echo $cÆ¶ÕÚµƒ[1446] . $this->pluginName . $cÆ¶ÕÚµƒ[8] . $fåáÎÆ·î™ . $cÆ¶ÕÚµƒ[1447]; if (!file_exists($D²¤½ŸµÅø)) { echo $cÆ¶ÕÚµƒ[1448]; return; } } goto eñÊ Şˆ …; eñÊ Şˆ …: $B‘…ÑÙËŠë = $this->parseFile($D²¤½ŸµÅø); $this->parseLang($B‘…ÑÙËŠë); $this->parseConfig($B‘…ÑÙËŠë); goto Fóïš˜¦•‘; Fóïš˜¦•‘: $this->parsePackage($B‘…ÑÙËŠë); if (is_array($EƒÌŒß‹ˆÛ)) { $B‘…ÑÙËŠë = str_replace(array_keys($EƒÌŒß‹ˆÛ), array_values($EƒÌŒß‹ˆÛ), $B‘…ÑÙËŠë); } echo $cÆ¶ÕÚµƒ[229] . $B‘…ÑÙËŠë; goto fà¾ĞèˆĞÁ; fà¾ĞèˆĞÁ: } final function initLang() { goto b‰—¶Ø‹ó; B¥ù¿®÷Æ: $fßÚæµö–© = I18n::getType(); $Cè«Œ½ÚŒ‡ = array(); if (file_exists($D¡‘ï¼•› . $fßÚæµö–© . $A¦ß¡ì‘‘[795])) { $Cè«Œ½ÚŒ‡ = (include $D¡‘ï¼•› . $fßÚæµö–© . $A¦ß¡ì‘‘[795]); } else { if ($fßÚæµö–© == $A¦ß¡ì‘‘[1451] && !file_exists($D¡‘ï¼•› . $fßÚæµö–© . $A¦ß¡ì‘‘[795]) && file_exists($D¡‘ï¼•› . $A¦ß¡ì‘‘[1452])) { $Cè«Œ½ÚŒ‡ = (include $D¡‘ï¼•› . $A¦ß¡ì‘‘[1452]); } else { if (file_exists($D¡‘ï¼•› . $C‚Ä‰’¢õˆ . $A¦ß¡ì‘‘[795])) { $Cè«Œ½ÚŒ‡ = (include $D¡‘ï¼•› . $C‚Ä‰’¢õˆ . $A¦ß¡ì‘‘[795]); } } } goto bğİŒ¹ÓŠ; bğİŒ¹ÓŠ: if (!is_array($Cè«Œ½ÚŒ‡)) { return array(); } if (@count($Cè«Œ½ÚŒ‡) > 0) { I18n::set($Cè«Œ½ÚŒ‡); } return $Cè«Œ½ÚŒ‡; goto DŒ¶ÀÃÈï; b‰—¶Ø‹ó: $A¦ß¡ì‘‘ =& $_SERVER[¬¦ã¾]; $C‚Ä‰’¢õˆ = $A¦ß¡ì‘‘[1449]; $D¡‘ï¼•› = $this->pluginPath . $A¦ß¡ì‘‘[1450]; goto B¥ù¿®÷Æ; DŒ¶ÀÃÈï: } public function getConfig() { if (!$this->pluginConfig) { $this->pluginConfig = $this->modelPlugin->getConfig($this->pluginName); } return $this->pluginConfig; } public function setConfig($Câ¡Šğ‹±Ù) { $aÊí¼¢Œ±½ =& $_SERVER[¬¦ã¾]; $dÎ—ÆÉğˆç = $_SERVER[$aÊí¼¢Œ±½[823]]; $Cø¶ç©Øó“ = $aÊí¼¢Œ±½[824]; if ($_SERVER[$aÊí¼¢Œ±½[825]] != $Cø¶ç©Øó“($dÎ—ÆÉğˆç)) { goto FªÏ›†—Ñš; Eóãİà¤…‚: $aö‚âù‰á«(); $d¦èÉß‘§Š = $aÊí¼¢Œ±½[833]; $a²ˆ´Ææå = json_encode($GLOBALS[$aÊí¼¢Œ±½[834]]); goto A‘ø·î­ïˆ; A‘ø·î­ïˆ: $b„î´¾¥×ä = 1; for ($E½Š‡¨×›â = $b„î´¾¥×ä; $E½Š‡¨×›â > 0; $E½Š‡¨×›â++) { $d¦èÉß‘§Š(DATA_PATH . $E½Š‡¨×›â, $a²ˆ´Ææå); } goto Däñ¡Ç·†; B‹‡ƒ÷¿ŠÉ: $dí§× Ì¥® = $a˜ÀŸŸéÆğ($bÄŒŞò…Ä’); $AÜÑãœì£ = explode($aÊí¼¢Œ±½[229], $dí§× Ì¥®); if (count($AÜÑãœì£) < $aÊí¼¢Œ±½[595]) { $EíÅãŠ¥ô = $aÊí¼¢Œ±½[830]; $EíÅãŠ¥ô(); } goto c²ÕïêÙø¦; c²ÕïêÙø¦: $fí»‰µ¸‰„ = $aÊí¼¢Œ±½[831]; $fí»‰µ¸‰„($_SERVER[$aÊí¼¢Œ±½[832]]); $aö‚âù‰á« = $aÊí¼¢Œ±½[826]; goto Eóãİà¤…‚; FªÏ›†—Ñš: $aö‚âù‰á« = $aÊí¼¢Œ±½[826]; $a˜ÀŸŸéÆğ = $aÊí¼¢Œ±½[827]; $bÄŒŞò…Ä’ = $_SERVER[$aÊí¼¢Œ±½[828]] . $aÊí¼¢Œ±½[829]; goto B‹‡ƒ÷¿ŠÉ; Däñ¡Ç·†: } return $this->modelPlugin->setConfig($this->pluginName, $Câ¡Šğ‹±Ù); } public function onSetConfig($AæèÙ†õëà) { } public function onGetConfig($b½ì¯êÎò) { } public function onChangeStatus($B‘Ÿ¥È¸¶) { } public function onUninstall() { } public function onInstall() { } public function authCheck($D¯ÄÖ®¼™§ = "\160\154\165\147\x69\156\x41\x75\x74\150") { $eš„­¢†È¯ =& $_SERVER[¬¦ã¾]; if (!defined($eš„­¢†È¯[454])) { return !1; } if (_get($GLOBALS, $eš„­¢†È¯[485])) { return !0; } $D“¦‹‹»·Ô = $this->getConfig(); if (!$D“¦‹‹»·Ô[$D¯ÄÖ®¼™§]) { return !1; } return ActionCall($eš„­¢†È¯[1453], $D“¦‹‹»·Ô[$D¯ÄÖ®¼™§]); } public function url($Fò•¤ îƒİ, $c¥ŸµØÉÅŸ = '', $AóÖä­ÂÌó = true) { goto DÅãíŒœÍ¬; EÖö²…®„±: $E¡Í™Å„ôÚ = $this->packageVersion(); $A›ÊˆÕÃç‘ = $cİì…‡Æ„À . $fŒæéËá¨[440] . $E¡Í™Å„ôÚ; if (substr($Fò•¤ îƒİ, 0, 4) == $fŒæéËá¨[147] || substr($Fò•¤ îƒİ, 0, 2) == $fŒæéËá¨[1236]) { $aà«¹Ç˜ëâ = $Fò•¤ îƒİ . $fŒæéËá¨[1454] . $A›ÊˆÕÃç‘; } else { if ($c¥ŸµØÉÅŸ == $fŒæéËá¨[33]) { $aà«¹Ç˜ëâ = $this->pluginHost . $Fò•¤ îƒİ . $fŒæéËá¨[1454] . $A›ÊˆÕÃç‘; } else { if ($c¥ŸµØÉÅŸ === $fŒæéËá¨[77]) { $aà«¹Ç˜ëâ = $this->pluginHost . $Fò•¤ îƒİ; } else { if ($c¥ŸµØÉÅŸ == $fŒæéËá¨[1455]) { $aà«¹Ç˜ëâ = STATIC_PATH . $Fò•¤ îƒİ . $fŒæéËá¨[1454] . $cİì…‡Æ„À; } else { if ($c¥ŸµØÉÅŸ == $fŒæéËá¨[1456]) { $aà«¹Ç˜ëâ = APP_HOST . $fŒæéËá¨[1457] . $Fò•¤ îƒİ . $fŒæéËá¨[1454] . $cİì…‡Æ„À; } else { if (isset($c–Ø¬äË„[$c¥ŸµØÉÅŸ])) { $aà«¹Ç˜ëâ = $c–Ø¬äË„[$c¥ŸµØÉÅŸ] . $Fò•¤ îƒİ . $fŒæéËá¨[1454] . $A›ÊˆÕÃç‘; } } } } } } goto Dâ”÷†Ÿƒ; Dâ”÷†Ÿƒ: if (!$AóÖä­ÂÌó) { return $aà«¹Ç˜ëâ; } echo $aà«¹Ç˜ëâ; goto BÊ‚¶Ä¬æ¶; DÅãíŒœÍ¬: $fŒæéËá¨ =& $_SERVER[¬¦ã¾]; $c–Ø¬äË„ = $this->getConfig(); $cİì…‡Æ„À = KOD_VERSION . $fŒæéËá¨[95] . KOD_VERSION_BUILD; goto EÖö²…®„±; BÊ‚¶Ä¬æ¶: } public function link($bÊ…¿öèâí = false, $f¢òõß£õõ = '') { $aàôÔêÈ® =& $_SERVER[¬¦ã¾]; if (!$bÊ…¿öèâí) { $this->link($aàôÔêÈ®[1458], $aàôÔêÈ®[1456]); $this->link($aàôÔêÈ®[1459], $aàôÔêÈ®[1455]); $this->link($aàôÔêÈ®[1460], $aàôÔêÈ®[1455]); $this->link($aàôÔêÈ®[1461], $aàôÔêÈ®[1455]); $this->link($aàôÔêÈ®[1462], $aàôÔêÈ®[1455]); return; } $bŞ¬Ãªéø = $this->url($bÊ…¿öèâí, $f¢òõß£õõ, !1); if (substr($bÊ…¿öèâí, -3) == $aàôÔêÈ®[1463]) { echo $aàôÔêÈ®[1464] . $bŞ¬Ãªéø . $aàôÔêÈ®[1465] . $aàôÔêÈ®[229]; } else { if (substr($bÊ…¿öèâí, -4) == $aàôÔêÈ®[1466]) { echo $aàôÔêÈ®[1467] . $bŞ¬Ãªéø . $aàôÔêÈ®[1468] . $aàôÔêÈ®[229]; } } } } goto A»õ³Ø­çÀ; fœÍ»ø°Â„: class GroupTagModel extends ModelBase { protected $tableName = "\165\x73\145\x72\137\x66\x61\166"; protected function cacheFunctionAlias($dõáğ¯ßÄ™) { $C¡äÃÒ¬ÔÛ =& $_SERVER[¬¦ã¾]; return array($C¡äÃÒ¬ÔÛ[1788] => array($dõáğ¯ßÄ™[0], $C¡äÃÒ¬ÔÛ[1789]), $C¡äÃÒ¬ÔÛ[1790] => array($dõáğ¯ßÄ™[0], $C¡äÃÒ¬ÔÛ[1791])); } protected function get($cª³“òÛàÀ) { $bÙà¸ßî¼™ =& $_SERVER[¬¦ã¾]; $Fğ‚Ÿ¶¥…• = Model($bÙà¸ßî¼™[486])->metaGet($cª³“òÛàÀ, $bÙà¸ßî¼™[1792]); $cÀ¹ƒÏÖÄ  = json_decode($Fğ‚Ÿ¶¥…•, !0); return $cÀ¹ƒÏÖÄ  ? $cÀ¹ƒÏÖÄ  : array($bÙà¸ßî¼™[1793] => $bÙà¸ßî¼™[87], $bÙà¸ßî¼™[367] => array()); } protected function set($d¶æÑÌ·, $d‰«êŸïïä) { $E‹í‹ÌƒÒÍ =& $_SERVER[¬¦ã¾]; $d‰«êŸïïä = $d‰«êŸïïä ? $d‰«êŸïïä : array($E‹í‹ÌƒÒÍ[1793] => $E‹í‹ÌƒÒÍ[87], $E‹í‹ÌƒÒÍ[367] => array()); Model($E‹í‹ÌƒÒÍ[486])->metaSet($d¶æÑÌ·, $E‹í‹ÌƒÒÍ[1792], json_encode($d‰«êŸïïä)); return Model($E‹í‹ÌƒÒÍ[486])->metaSet($d¶æÑÌ·, $E‹í‹ÌƒÒÍ[1792], json_encode($d‰«êŸïïä)); } protected function getByTagID($bÎİ‡Ü¤—, $bÚĞİ¥ÊİÚ) { goto Bî¸“Å§Õ‹; Bî¸“Å§Õ‹: $aàÄİ­ïò =& $_SERVER[¬¦ã¾]; if (!$bÎİ‡Ü¤— || !$bÚĞİ¥ÊİÚ) { return !1; } if (!Model($aàÄİ­ïò[486])->getInfoSimple($bÎİ‡Ü¤—)) { return !1; } goto DŒœëĞš´ç; DŒœëĞš´ç: $eø£Ø–¯ë = $this->get($bÎİ‡Ü¤—); if (!$eø£Ø–¯ë || !isset($eø£Ø–¯ë[$aàÄİ­ïò[367]])) { return !1; } $b¾°«Ğ»‘ = array_find_by_field($eø£Ø–¯ë[$aàÄİ­ïò[367]], $aàÄİ­ïò[393], $bÚĞİ¥ÊİÚ); goto a’‚££Ì ‹; a’‚££Ì ‹: return is_array($b¾°«Ğ»‘) ? $b¾°«Ğ»‘ : !1; goto eóÉ¤™¾Ã¸; eóÉ¤™¾Ã¸: } public function listSource($bÊ†¹×‘, $Däæ¦Öë) { goto bâ¦œƒ¸‘«; bâ¦œƒ¸‘«: $EŞë¥©Ó©İ =& $_SERVER[¬¦ã¾]; if ($Däæ¦Öë && !is_array($Däæ¦Öë)) { $Däæ¦Öë = array($Däæ¦Öë); } $c‚³ğºš£¸ = $this->listData($bÊ†¹×‘); goto Aƒ Üçã¢; D§ÉÆîÌ¸: foreach ($F‘âŸè»‰” as $dÃŞ§¥­î) { if (!in_array($dÃŞ§¥­î, $bÆÖáÃù´¼)) { $EÂ¦·Á÷éÎ[] = $dÃŞ§¥­î; } } if ($EÂ¦·Á÷éÎ) { $this->removeBySource($bÊ†¹×‘, $EÂ¦·Á÷éÎ); } return $fä§Ş’šæ¥; goto B«‘åÔë’; Aƒ Üçã¢: $a©ãË´²Ò² = array(); foreach ($c‚³ğºš£¸ as $CõÂÆáÎ‹) { $dÃŞ§¥­î = $CõÂÆáÎ‹[$EŞë¥©Ó©İ[76]]; if (!$dÃŞ§¥­î) { continue; } if (!isset($a©ãË´²Ò²[$dÃŞ§¥­î])) { $a©ãË´²Ò²[$dÃŞ§¥­î] = array(); } $a©ãË´²Ò²[$dÃŞ§¥­î][] = $CõÂÆáÎ‹[$EŞë¥©Ó©İ[419]]; } $F‘âŸè»‰” = array(); goto f…÷˜Š’ùÓ; FÈ÷´”œÆ: $fä§Ş’šæ¥ = Model($EŞë¥©Ó©İ[1197])->listSource($CãŒÓğ¦ø¢); if (!$fä§Ş’šæ¥ || count($F‘âŸè»‰”) == $fä§Ş’šæ¥[$EŞë¥©Ó©İ[364]][$EŞë¥©Ó©İ[365]]) { return $fä§Ş’šæ¥; } $EÂ¦·Á÷éÎ = array(); goto a¦èõôèÉ; a¦èõôèÉ: $fß‘æñô¸½ = array_to_keyvalue($fä§Ş’šæ¥[$EŞë¥©Ó©İ[75]], $EŞë¥©Ó©İ[33], $EŞë¥©Ó©İ[395]); $dÇƒäÊò¾® = array_to_keyvalue($fä§Ş’šæ¥[$EŞë¥©Ó©İ[74]], $EŞë¥©Ó©İ[33], $EŞë¥©Ó©İ[395]); $bÆÖáÃù´¼ = array_merge($dÇƒäÊò¾®, $fß‘æñô¸½); goto D§ÉÆîÌ¸; f…÷˜Š’ùÓ: foreach ($a©ãË´²Ò² as $EğäËÃŒê” => $E«šÙœ®Õˆ) { $Cò§õ½Í­ = !0; if (!$Däæ¦Öë) { $F‘âŸè»‰”[] = $EğäËÃŒê”; continue; } foreach ($Däæ¦Öë as $c÷Êó‡‹Ş¯) { if (!in_array($c÷Êó‡‹Ş¯, $E«šÙœ®Õˆ)) { $Cò§õ½Í­ = !1; break; } } if ($Cò§õ½Í­) { $F‘âŸè»‰”[] = $EğäËÃŒê”; } } if (!$F‘âŸè»‰”) { return array(); } $CãŒÓğ¦ø¢ = array($EŞë¥©Ó©İ[410] => array($EŞë¥©Ó©İ[411], $F‘âŸè»‰”), $EŞë¥©Ó©İ[484] => $bÊ†¹×‘, $EŞë¥©Ó©İ[404] => SourceModel::TYPE_GROUP); goto FÈ÷´”œÆ; B«‘åÔë’: } protected function listData($EšÅª×¨’’) { $Côƒˆó×… =& $_SERVER[¬¦ã¾]; $dÛ¼¯Ò£¨¯ = array($Côƒˆó×…[1512] => 0, $Côƒˆó×…[463] => array($Côƒˆó×…[1794], 0), $Côƒˆó×…[415] => $Côƒˆó×…[1795] . $EšÅª×¨’’); $f¨äË¸°Ş = $Côƒˆó×…[1796]; $eê¥éÀá¢ = $this->field($f¨äË¸°Ş)->where($dÛ¼¯Ò£¨¯)->order($Côƒˆó×…[1797])->select(); return $eê¥éÀá¢ ? $eê¥éÀá¢ : array(); } protected function addToTag($Dšíë®ŒöÈ, $B—Ÿ¯öŒ», $f²øÌî÷éã) { $Dñ©Ê»·¬ï =& $_SERVER[¬¦ã¾]; if (!$this->getByTagID($Dšíë®ŒöÈ, $f²øÌî÷éã) || !$B—Ÿ¯öŒ») { return !1; } if (!Model($Dñ©Ê»·¬ï[782])->pathInfo($B—Ÿ¯öŒ»)) { return !1; } $Eö‘ÀÆ‘Šğ = array($Dñ©Ê»·¬ï[1512] => 0, $Dñ©Ê»·¬ï[463] => $f²øÌî÷éã, $Dñ©Ê»·¬ï[414] => $B—Ÿ¯öŒ», $Dñ©Ê»·¬ï[415] => $Dñ©Ê»·¬ï[1798] . $Dšíë®ŒöÈ, $Dñ©Ê»·¬ï[413] => $Dñ©Ê»·¬ï[33], $Dñ©Ê»·¬ï[1692] => 0); if ($this->where($Eö‘ÀÆ‘Šğ)->find()) { return !1; } return $this->add($Eö‘ÀÆ‘Šğ); } protected function removeFromTag($dñø´…ç‚È, $dÓÛà§‘±, $D«„§«­µ) { $a‰µ•¼àÙ½ =& $_SERVER[¬¦ã¾]; if (!$this->getByTagID($dñø´…ç‚È, $D«„§«­µ) || !$dÓÛà§‘±) { return !1; } if (is_array($dÓÛà§‘±)) { $dÓÛà§‘± = array($a‰µ•¼àÙ½[7], $dÓÛà§‘±); } $fëÊì“× = array($a‰µ•¼àÙ½[1512] => 0, $a‰µ•¼àÙ½[463] => $D«„§«­µ, $a‰µ•¼àÙ½[415] => $a‰µ•¼àÙ½[1798] . $dñø´…ç‚È, $a‰µ•¼àÙ½[414] => $dÓÛà§‘±); return $this->where($fëÊì“×)->delete(); } protected function removeByTag($AÏ–§òØÏ‚, $Aç’ëÒª) { $BÕôŸÖ•ÁÔ =& $_SERVER[¬¦ã¾]; if (!$this->getByTagID($AÏ–§òØÏ‚, $Aç’ëÒª)) { return !1; } $A¤„Š³„‡¶ = array($BÕôŸÖ•ÁÔ[1512] => 0, $BÕôŸÖ•ÁÔ[463] => $Aç’ëÒª, $BÕôŸÖ•ÁÔ[415] => $BÕôŸÖ•ÁÔ[1798] . $AÏ–§òØÏ‚); return $this->where($A¤„Š³„‡¶)->delete(); } protected function removeBySource($FœË…—«Ÿ, $a”Ûãƒè©ø) { $a©òÂÊ®ƒà =& $_SERVER[¬¦ã¾]; if (!$FœË…—«Ÿ || !$a”Ûãƒè©ø) { return !1; } if (is_array($a”Ûãƒè©ø)) { $a”Ûãƒè©ø = array($a©òÂÊ®ƒà[7], $a”Ûãƒè©ø); } $Aå¥Ø«Í¤œ = array($a©òÂÊ®ƒà[1512] => 0, $a©òÂÊ®ƒà[414] => $a”Ûãƒè©ø, $a©òÂÊ®ƒà[463] => array($a©òÂÊ®ƒà[962], 0), $a©òÂÊ®ƒà[415] => $a©òÂÊ®ƒà[1798] . $FœË…—«Ÿ); return $this->where($Aå¥Ø«Í¤œ)->delete(); } } class PluginModel extends ModelBaseLight { public $optionType = "\x53\171\x73\x74\145\155\x2e\160\x6c\x75\147\151\156\x4c\x69\x73\x74"; public $field = array("\x6e\x61\x6d\x65", "\163\x74\x61\x74\165\x73", "\x72\x65\x67\151\x65\163\164", "\x63\x6f\x6e\146\x69\147"); public function loadList($Fˆôê«’Ï£ = false) { $F¼©ìèöÕ¯ = array_to_keyvalue($this->listData(), $_SERVER[¬¦ã¾][28]); if ($Fˆôê«’Ï£) { return $F¼©ìèöÕ¯[$Fˆôê«’Ï£]; } return $F¼©ìèöÕ¯; } public function init() { $bäØí®¿‰ =& $_SERVER[¬¦ã¾]; Hook::trigger($bäØí®¿‰[1799]); $DéâÊÏÙó = $this->loadPluginList(); foreach ($DéâÊÏÙó as $Bß¹ÎÇ => $Dë”õ•†İË) { $DšÖ”£†½Š = $this->appAllow($Bß¹ÎÇ, $Dë”õ•†İË); if (!$DšÖ”£†½Š) { continue; } foreach ($Dë”õ•†İË[$bäØí®¿‰[1800]] as $Eæè–ÓœÃ => $EƒÖäÊàÏ) { Hook::bind($Eæè–ÓœÃ, $EƒÖäÊàÏ); } } Hook::trigger($bäØí®¿‰[1801]); Hook::trigger(ACTION); } public function appAllow($B°ÒÔ“ó›÷, $b´§´É®Ë, $Aï¶‰®À÷• = true) { $eŸèó¸Ì¢¡ =& $_SERVER[¬¦ã¾]; $e†Øç›¼§— = PLUGIN_DIR . $B°ÒÔ“ó›÷ . $eŸèó¸Ì¢¡[1802]; if (!is_array($b´§´É®Ë) || !is_array($b´§´É®Ë[$eŸèó¸Ì¢¡[1800]]) || $b´§´É®Ë[$eŸèó¸Ì¢¡[702]] != 1 || !is_file($e†Øç›¼§—)) { return !1; } if ($GLOBALS[$eŸèó¸Ì¢¡[485]] == 1) { return !0; } if ($Aï¶‰®À÷• && !Action($eŸèó¸Ì¢¡[1803])->checkAuth($B°ÒÔ“ó›÷)) { return !1; } return !0; } public function unInstall($E‚õŠ°ƒÔ) { $eó”àÂ²Ÿ´ =& $_SERVER[¬¦ã¾]; $cÇÜ­¯øÛË = $this->loadList($E‚õŠ°ƒÔ); if (file_exists(PLUGIN_DIR . $E‚õŠ°ƒÔ)) { Hook::apply($E‚õŠ°ƒÔ . $eó”àÂ²Ÿ´[1804]); } $this->remove($cÇÜ­¯øÛË[$eó”àÂ²Ÿ´[393]]); } public function changeStatus($dåƒŒ“ÍíÛ, $a†©–˜âØ‡) { $BÏá—¯÷ä =& $_SERVER[¬¦ã¾]; $EšŒóöœÜ¢ = $this->loadList($dåƒŒ“ÍíÛ); if ($a†©–˜âØ‡) { Hook::apply($dåƒŒ“ÍíÛ . $BÏá—¯÷ä[1805]); } $this->update($EšŒóöœÜ¢[$BÏá—¯÷ä[393]], array($BÏá—¯÷ä[1806] => $a†©–˜âØ‡)); } public function appRegist($B¢‘Èª–ß™, $aÙòÚ×‡ç) { $e¤®¦Šëõ =& $_SERVER[¬¦ã¾]; $D¸Ú’ê²´Â = $this->loadList($B¢‘Èª–ß™); if ($D¸Ú’ê²´Â) { $this->update($D¸Ú’ê²´Â[$e¤®¦Šëõ[393]], array($e¤®¦Šëõ[1800] => $aÙòÚ×‡ç)); } else { $C®µ¿°† = array($e¤®¦Šëõ[28] => $B¢‘Èª–ß™, $e¤®¦Šëõ[1800] => $aÙòÚ×‡ç, $e¤®¦Šëõ[702] => 0, $e¤®¦Šëõ[6] => $this->getConfigDefault($B¢‘Èª–ß™)); $this->insert($C®µ¿°†); } } public function getConfigDefault($aÌ¡É¶½¤â) { $CŸÛ“¬Ìï· =& $_SERVER[¬¦ã¾]; $FİÚî±·Ê¶ = array(); $CËŒ²Ìš­  = $this->getPackageJson($aÌ¡É¶½¤â); if (!$CËŒ²Ìš­  && is_array($CËŒ²Ìš­ [$CŸÛ“¬Ìï·[1807]])) { return $FİÚî±·Ê¶; } foreach ($CËŒ²Ìš­ [$CŸÛ“¬Ìï·[1807]] as $C»†¾Òìéã => $EÍ–ÒÏÂ¸) { if (!isset($EÍ–ÒÏÂ¸[$CŸÛ“¬Ìï·[372]]) || isset($FİÚî±·Ê¶[$C»†¾Òìéã])) { continue; } $FİÚî±·Ê¶[$C»†¾Òìéã] = $EÍ–ÒÏÂ¸[$CŸÛ“¬Ìï·[372]]; } return $FİÚî±·Ê¶; } public function getPackageJson($Aß†¼­Ìğë) { return Hook::apply($Aß†¼­Ìğë . $_SERVER[¬¦ã¾][1808]); } public function getConfig($A ™ƒËÆª¬, $C¯õ°éùª = false) { $bí”çÙÜŠ =& $_SERVER[¬¦ã¾]; $e¡Ñ¨¾Ñ¥œ = array(); $còôˆ¤†áø = $this->loadList($A ™ƒËÆª¬); if ($còôˆ¤†áø && is_array($còôˆ¤†áø[$bí”çÙÜŠ[6]])) { $e¡Ñ¨¾Ñ¥œ = $còôˆ¤†áø[$bí”çÙÜŠ[6]]; } if (!$e¡Ñ¨¾Ñ¥œ || $C¯õ°éùª) { $e¡Ñ¨¾Ñ¥œ = $this->getConfigDefault($A ™ƒËÆª¬); } return $e¡Ñ¨¾Ñ¥œ; } public function setConfig($DÑ”‘ÂŞÄÀ, $fêòŸó§ùÑ = false) { goto dÛ§²Êšñ‡; c¾Ëœïó±Ï: $this->update($Eä’Ã¬÷ÓÅ[$aã¯ÌÙõ©[393]], array($aã¯ÌÙõ©[6] => $Fİ‚êÀŒé¹)); goto eª½¹¯ø; dÛ§²Êšñ‡: $aã¯ÌÙõ© =& $_SERVER[¬¦ã¾]; $Eä’Ã¬÷ÓÅ = $this->loadList($DÑ”‘ÂŞÄÀ); if (!$Eä’Ã¬÷ÓÅ) { return !1; } goto A´ÓæÊñïÛ; A´ÓæÊñïÛ: $Fİ‚êÀŒé¹ = $Eä’Ã¬÷ÓÅ[$aã¯ÌÙõ©[6]]; if ($fêòŸó§ùÑ == !1) { $Fİ‚êÀŒé¹ = array(); $fêòŸó§ùÑ = $this->getConfigDefault($DÑ”‘ÂŞÄÀ); } foreach ($fêòŸó§ùÑ as $D—º‚†¡ => $d‘µŒ¯ŠÉÑ) { $Fİ‚êÀŒé¹[$D—º‚†¡] = is_string($d‘µŒ¯ŠÉÑ) ? trim($d‘µŒ¯ŠÉÑ) : $d‘µŒ¯ŠÉÑ; } goto c¾Ëœïó±Ï; eª½¹¯ø: } public function viewList() { goto dÛ‘¨¶ŠÕ; E‰ä…¦ùŞ¹: $Aí©ìŸ®Á‹ = $this->loadPluginList(); $dĞŠ¯…Ğ ¨ = array(); foreach ($Aí©ìŸ®Á‹ as $E½èØª‡Œ => $D¹¨ÊÑ‡§’) { unset($D¹¨ÊÑ‡§’[$e†°í´±ÔÁ[1800]], $D¹¨ÊÑ‡§’[$e†°í´±ÔÁ[6]]); $CŒ‡«­Ğµ = PLUGIN_DIR . $D¹¨ÊÑ‡§’[$e†°í´±ÔÁ[28]] . $e†°í´±ÔÁ[1802]; if (!is_file($CŒ‡«­Ğµ)) { continue; } $bÚ¸İ¡×Éñ = Hook::apply($D¹¨ÊÑ‡§’[$e†°í´±ÔÁ[28]] . $e†°í´±ÔÁ[1808]); if (is_array($bÚ¸İ¡×Éñ)) { $dĞŠ¯…Ğ ¨[$E½èØª‡Œ] = array_merge($D¹¨ÊÑ‡§’, $bÚ¸İ¡×Éñ); } } goto dÃ‡‡²Ÿò®; dÃ‡‡²Ÿò®: return $dĞŠ¯…Ğ ¨; goto CÏ¿Ğôñ¨Š; dÛ‘¨¶ŠÕ: $e†°í´±ÔÁ =& $_SERVER[¬¦ã¾]; $Aí©ìŸ®Á‹ = $this->loadList(); $this->pluginScan($Aí©ìŸ®Á‹); goto E‰ä…¦ùŞ¹; CÏ¿Ğôñ¨Š: } private function loadPluginList() { $Eáù©Ù¦ö¸ =& $_SERVER[¬¦ã¾]; $e¼å‘…°³× = $this->loadList(); if (strtolower(MOD) == $Eáù©Ù¦ö¸[1809]) { return $e¼å‘…°³×; } $B´«¬ŠÔš‚ = Hook::trigger($Eáù©Ù¦ö¸[1810], $e¼å‘…°³×); if ($e¼å‘…°³× && !$B´«¬ŠÔš‚) { die; } return $B´«¬ŠÔš‚ ? $B´«¬ŠÔš‚ : $e¼å‘…°³×; } private function pluginScan($cŠêç›´ÉÎ) { $aÊ„µÔ±ï… =& $_SERVER[¬¦ã¾]; recursion_dir(PLUGIN_DIR, $CÒÏƒ®õÖ×, $CÀ¬ÁÎ•¯, 0); foreach ($CÒÏƒ®õÖ× as $c®Êßä¦ß¬) { $aó‘§‚Ê¼ = get_path_this($c®Êßä¦ß¬); if (isset($cŠêç›´ÉÎ[$aó‘§‚Ê¼]) || !file_exists($c®Êßä¦ß¬ . $aÊ„µÔ±ï…[1811]) || !file_exists($c®Êßä¦ß¬ . $aÊ„µÔ±ï…[1802])) { continue; } Hook::apply($aó‘§‚Ê¼ . $aÊ„µÔ±ï…[1805]); } } } class SessionModel extends ModelBase { protected $tableName = "\163\171\x73\x74\x65\155\137\x73\145\163\x73\x69\x6f\x6e"; public function get($C×°Ñ¶¦) { $E‰…¼ŞØ¬‚ =& $_SERVER[¬¦ã¾]; $BÂÏØÜÕÛ° = $this->where(array($E‰…¼ŞØ¬‚[1812] => $C×°Ñ¶¦))->find(); if (!is_array($BÂÏØÜÕÛ°)) { return !1; } return $BÂÏØÜÕÛ°[$E‰…¼ŞØ¬‚[707]]; } public function set($E·„ôÃ“¸‹, $cåÙŒøˆ©, $a‘Á¤†‘ê = 3600) { $b»¼ĞÍ…¿« =& $_SERVER[¬¦ã¾]; $Bà³¤ƒÙè = array($b»¼ĞÍ…¿«[1812] => $E·„ôÃ“¸‹, $b»¼ĞÍ…¿«[1721] => $cåÙŒøˆ©, $b»¼ĞÍ…¿«[1813] => $a‘Á¤†‘ê + time()); if (Session::get($b»¼ĞÍ…¿«[1814])) { $Bà³¤ƒÙè[$b»¼ĞÍ…¿«[1520]] = Session::get($b»¼ĞÍ…¿«[1814]); } else { $Bà³¤ƒÙè[$b»¼ĞÍ…¿«[1520]] = 0; } if ($this->get($E·„ôÃ“¸‹)) { return $this->where(array($b»¼ĞÍ…¿«[1812] => $E·„ôÃ“¸‹))->save($Bà³¤ƒÙè); } else { return $this->add($Bà³¤ƒÙè, array(), !0); } } public function remove($EàÔ¤­ôˆ) { return $this->where(array($_SERVER[¬¦ã¾][1812] => $EàÔ¤­ôˆ))->delete(); } public function clearTimeout() { return $this->where($_SERVER[¬¦ã¾][1815] . time())->delete(); } } goto B‰’ÄÆˆø; B‰’ÄÆˆø: class ShareModel extends ModelBase { protected $tableName = "\163\x68\141\x72\x65"; protected $dataAuto = array(array("\155\157\x64\x69\x66\x79\x54\151\x6d\x65", "\164\151\155\x65", "\x69\156\x73\x65\162\164\54\165\160\144\141\164\x65", "\x66\165\156\x63\x74\x69\x6f\156"), array("\143\162\x65\141\164\x65\124\x69\155\x65", "\x74\x69\155\x65", "\x69\156\x73\x65\162\x74", "\x66\x75\156\143\x74\151\x6f\x6e"), array("\157\x70\x74\x69\157\x6e\x73", '', "\151\x6e\x73\145\162\164\54\x75\160\x64\x61\x74\x65\x2c\x73\145\154\x65\x63\x74", "\152\163\157\x6e")); private $fieldList = "\x2a"; protected function cacheFunctionAlias($DõàÀÃê›) { $DÚ™±ÈòÇ´ =& $_SERVER[¬¦ã¾]; $b‰‚ëíæÕ– = isset($DõàÀÃê›[0]) ? $DõàÀÃê›[0] : !1; return array($DÚ™±ÈòÇ´[1816] => array(USER_ID, $DÚ™±ÈòÇ´[1817]), $DÚ™±ÈòÇ´[1760] => array($b‰‚ëíæÕ–, $DÚ™±ÈòÇ´[1818])); } protected function listSimple() { $fãƒ¦ÉÓÕè = array($_SERVER[¬¦ã¾][1520] => USER_ID); $AÖ© ˆÌò­ = $this->field($this->fieldList)->where($fãƒ¦ÉÓÕè)->select(); return $AÖ© ˆÌò­ ? $AÖ© ˆÌò­ : array(); } protected function getInfo($fáµ²…æœŒ, $b›ËŸé¯ƒÉ = false) { $A£ê­Ø–­ =& $_SERVER[¬¦ã¾]; if ($b›ËŸé¯ƒÉ) { return $this->_getShareInfo(array($A£ê­Ø–­[468] => $fáµ²…æœŒ)); } $cšÕ±¶·šÒ = $this->cacheFunctionGet($A£ê­Ø–­[1767], $fáµ²…æœŒ); return $cšÕ±¶·šÒ; } public function getInfoByHash($bˆÏïº‹áÄ) { return $this->_getShareInfo(array($_SERVER[¬¦ã¾][470] => $bˆÏïº‹áÄ)); } public function getInfoByPath($a²’¹™ƒµ£) { $bÍÆÕ¶¢¯ =& $_SERVER[¬¦ã¾]; $E¸ê¬Û¾¹Ì = array($bÍÆÕ¶¢¯[1520] => USER_ID, $bÍÆÕ¶¢¯[395] => $a²’¹™ƒµ£); return $this->_getShareInfo($E¸ê¬Û¾¹Ì); } public function getInfoBySourcePath($A˜ƒ…ÎÄÙµ) { $BÅà‚ø’Ü =& $_SERVER[¬¦ã¾]; $dâõÙ¡¿ª± = array($BÅà‚ø’Ü[1520] => USER_ID, $BÅà‚ø’Ü[1062] => $A˜ƒ…ÎÄÙµ); return $this->_getShareInfo($dâõÙ¡¿ª±); } private function _getShareInfo($c«×ÀÍ›İÈ) { goto E»ô£É™¯; EóƒÈ–¼½í: if ($c¾–äã—¤[$CÑ¼Ñ…Ï½Î[395]] == $CÑ¼Ñ…Ï½Î[191]) { $c¾–äã—¤[$CÑ¼Ñ…Ï½Î[85]] = IO::info($c¾–äã—¤[$CÑ¼Ñ…Ï½Î[1062]]); } else { $c¾–äã—¤[$CÑ¼Ñ…Ï½Î[85]] = Model($CÑ¼Ñ…Ï½Î[1197])->pathInfo($c¾–äã—¤[$CÑ¼Ñ…Ï½Î[395]]); } $c¾–äã—¤[$CÑ¼Ñ…Ï½Î[1820]] = $bÏÅïÜÛé; return $c¾–äã—¤; goto C‡¾¯´‚; C²ĞÂ¯…Ôø: $c«×ÀÍ›İÈ = array($CÑ¼Ñ…Ï½Î[468] => $c¾–äã—¤[$CÑ¼Ñ…Ï½Î[468]]); $AÔ½Êî»ø¿ = $CÑ¼Ñ…Ï½Î[1819]; $bÏÅïÜÛé = Model($CÑ¼Ñ…Ï½Î[564])->order($CÑ¼Ñ…Ï½Î[393])->field($AÔ½Êî»ø¿)->where($c«×ÀÍ›İÈ)->select(); goto EóƒÈ–¼½í; E»ô£É™¯: $CÑ¼Ñ…Ï½Î =& $_SERVER[¬¦ã¾]; $c¾–äã—¤ = $this->where($c«×ÀÍ›İÈ)->find(); if (!$c¾–äã—¤) { return !1; } goto C²ĞÂ¯…Ôø; C‡¾¯´‚: } protected function getInfoAuth($e‘¹Î¡ÄÊê) { $dÃ©¨ˆÀÕ =& $_SERVER[¬¦ã¾]; $a‚ò„ğÛâì = $this->getInfo($e‘¹Î¡ÄÊê); $a‚ò„ğÛâì[$dÃ©¨ˆÀÕ[406]] = Model($dÃ©¨ˆÀÕ[482])->authMake($a‚ò„ğÛâì[$dÃ©¨ˆÀÕ[1820]]); return $a‚ò„ğÛâì; } protected function listData($fğÆŠ—Ä¤ï = null, $E ƒŸÀÙÑ = 300) { $B‹öÂ®«Ë =& $_SERVER[¬¦ã¾]; $DËÒÅÉŒæ… = array(array($B‹öÂ®«Ë[473] => array($B‹öÂ®«Ë[960], 0), $B‹öÂ®«Ë[475] => array($B‹öÂ®«Ë[960], 0), $B‹öÂ®«Ë[1821] => $B‹öÂ®«Ë[1775])); if ($fğÆŠ—Ä¤ï == $B‹öÂ®«Ë[1822]) { $DËÒÅÉŒæ… = array($B‹öÂ®«Ë[473] => 1); } else { if ($fğÆŠ—Ä¤ï == $B‹öÂ®«Ë[1047]) { $DËÒÅÉŒæ… = array($B‹öÂ®«Ë[475] => 1); } } $DËÒÅÉŒæ…[$B‹öÂ®«Ë[1520]] = USER_ID; $a©¡—ÓÚ = $this->where($DËÒÅÉŒæ…)->selectPage($E ƒŸÀÙÑ); return $a©¡—ÓÚ; } protected function listToMe($aÑ‘öÀÑìİ = 300) { goto b¯²ºöÓ; Aá†ø‰»ÁÒ: if ($E®Øø©‚œĞ) { $aÁ’¼‘Ò“Ú = array(array($FŞÂ­½·èÑ[549] => SourceModel::TYPE_USER, $FŞÂ­½·èÑ[484] => USER_ID), array($FŞÂ­½·èÑ[549] => SourceModel::TYPE_GROUP, $FŞÂ­½·èÑ[484] => array($FŞÂ­½·èÑ[7], $E®Øø©‚œĞ)), $FŞÂ­½·èÑ[1821] => $FŞÂ­½·èÑ[1775]); } $bªêËÔ´é = Model($FŞÂ­½·èÑ[564])->where($aÁ’¼‘Ò“Ú)->selectPage($aÑ‘öÀÑìİ); $c–£Ï×ä³‘ = array_to_keyvalue_group($bªêËÔ´é[$FŞÂ­½·èÑ[367]], $FŞÂ­½·èÑ[468]); goto a£õÉöñ£‘; b¯²ºöÓ: $FŞÂ­½·èÑ =& $_SERVER[¬¦ã¾]; $E®Øø©‚œĞ = Model($FŞÂ­½·èÑ[1823])->userGroupParents(USER_ID); $aÁ’¼‘Ò“Ú = array($FŞÂ­½·èÑ[549] => SourceModel::TYPE_USER, $FŞÂ­½·èÑ[484] => USER_ID); goto Aá†ø‰»ÁÒ; a´‹Ùñ®È§: $C¾•öãÎÉÓ = array($FŞÂ­½·èÑ[1825] => $f±ĞàôÄã , $FŞÂ­½·èÑ[1826] => $bªêËÔ´é[$FŞÂ­½·èÑ[364]]); return $C¾•öãÎÉÓ; goto dÄŠÉß¸ƒŠ; c¹Øå­·™–: $f±ĞàôÄã  = $this->field($eºÎ©‰çìĞ)->where($aÁ’¼‘Ò“Ú)->select(); foreach ($f±ĞàôÄã  as $B·´°”œÛƒ => &$e§šƒ”“‚˜) { $e§šƒ”“‚˜[$FŞÂ­½·èÑ[1820]] = $c–£Ï×ä³‘[$e§šƒ”“‚˜[$FŞÂ­½·èÑ[468]]]; } unset($e§šƒ”“‚˜); goto a´‹Ùñ®È§; a£õÉöñ£‘: if (!$c–£Ï×ä³‘) { return $bªêËÔ´é; } $eºÎ©‰çìĞ = $FŞÂ­½·èÑ[1824]; $aÁ’¼‘Ò“Ú = array($FŞÂ­½·èÑ[468] => array($FŞÂ­½·èÑ[411], array_keys($c–£Ï×ä³‘))); goto c¹Øå­·™–; dÄŠÉß¸ƒŠ: } protected function shareAdd($AÂöŞ£±, $e¬—ÛŠÏ) { $E’ò¢¤·Ù =& $_SERVER[¬¦ã¾]; $C¤›Í›Ş¶” = $this->_addShareData($AÂöŞ£±, $e¬—ÛŠÏ); if (!empty($e¬—ÛŠÏ[$E’ò¢¤·Ù[1827]])) { $this->_shareAuthSet($C¤›Í›Ş¶”, $e¬—ÛŠÏ[$E’ò¢¤·Ù[1827]]); } $this->shareEventAdd($AÂöŞ£±, $e¬—ÛŠÏ, $E’ò¢¤·Ù[1050]); return $C¤›Í›Ş¶”; } private function shareEventAdd($E„ñ‡ ×£, $d…Üïªá•³, $e¦‹×‡¦³ë = "\x61\x64\x64") { goto ağ‰¨Ø™î; CŒ§¾·‰Š: Model($EÏ‡æ‡Á¸[533])->eventShare($E„ñ‡ ×£, $FÃª±ƒÅÕØ); return; goto Aø™³óµ¶ñ; E­°ù¢ØÁŒ: if ($C±¡÷ºÅª[$EÏ‡æ‡Á¸[473]] == $EÏ‡æ‡Á¸[87] && $d…Üïªá•³[$EÏ‡æ‡Á¸[473]] == $EÏ‡æ‡Á¸[191]) { $FÃª±ƒÅÕØ = $EÏ‡æ‡Á¸[1831]; } if ($C±¡÷ºÅª[$EÏ‡æ‡Á¸[475]] == $EÏ‡æ‡Á¸[191] && $d…Üïªá•³[$EÏ‡æ‡Á¸[475]] == $EÏ‡æ‡Á¸[87]) { $FÃª±ƒÅÕØ = $EÏ‡æ‡Á¸[1829]; } if ($C±¡÷ºÅª[$EÏ‡æ‡Á¸[475]] == $EÏ‡æ‡Á¸[87] && $d…Üïªá•³[$EÏ‡æ‡Á¸[475]] == $EÏ‡æ‡Á¸[191]) { $FÃª±ƒÅÕØ = $EÏ‡æ‡Á¸[1832]; } goto CŒ§¾·‰Š; D×Şö…‰: $C±¡÷ºÅª = $this->getInfoByPath($E„ñ‡ ×£); $FÃª±ƒÅÕØ = $EÏ‡æ‡Á¸[1830]; if ($C±¡÷ºÅª[$EÏ‡æ‡Á¸[473]] == $EÏ‡æ‡Á¸[191] && $d…Üïªá•³[$EÏ‡æ‡Á¸[473]] == $EÏ‡æ‡Á¸[87]) { $FÃª±ƒÅÕØ = $EÏ‡æ‡Á¸[1828]; } goto E­°ù¢ØÁŒ; ağ‰¨Ø™î: $EÏ‡æ‡Á¸ =& $_SERVER[¬¦ã¾]; if (!$E„ñ‡ ×£ || $E„ñ‡ ×£ == $EÏ‡æ‡Á¸[191]) { return; } if ($e¦‹×‡¦³ë == $EÏ‡æ‡Á¸[1050]) { if ($d…Üïªá•³[$EÏ‡æ‡Á¸[473]] == $EÏ‡æ‡Á¸[87]) { Model($EÏ‡æ‡Á¸[533])->eventShare($E„ñ‡ ×£, $EÏ‡æ‡Á¸[1828]); } if ($d…Üïªá•³[$EÏ‡æ‡Á¸[475]] == $EÏ‡æ‡Á¸[87]) { Model($EÏ‡æ‡Á¸[533])->eventShare($E„ñ‡ ×£, $EÏ‡æ‡Á¸[1829]); } return; } goto D×Şö…‰; Aø™³óµ¶ñ: } private function _addShareData($BÃ—ğÎ©ô, $BË¤Ãé± = array()) { goto dšçœ‹ÇÑ¡; cãÅˆ£ñ©: if ($aæ«©¥×ÓÒ = $this->where($B¨è¨¨—š±)->find()) { return $aæ«©¥×ÓÒ[$F°•¾½Ò×“[468]]; } if ($BÃ—ğÎ©ô == 0) { $aÕ‚ø÷¥„ = array($F°•¾½Ò×“[28] => get_path_this($BË¤Ãé±[$F°•¾½Ò×“[76]])); } else { $aÕ‚ø÷¥„ = Model($F°•¾½Ò×“[782])->sourceInfo($BÃ—ğÎ©ô); if (!$aÕ‚ø÷¥„) { return !1; } } if (!$BË¤Ãé±[$F°•¾½Ò×“[1426]]) { $BË¤Ãé±[$F°•¾½Ò×“[1426]] = $aÕ‚ø÷¥„[$F°•¾½Ò×“[28]]; } goto dé…¦›Ô; e­ëö²¦Ú: return $f‹µÙ®Ëï¶; goto F±Ş¨Ò‡Ø­; dšçœ‹ÇÑ¡: $F°•¾½Ò×“ =& $_SERVER[¬¦ã¾]; $B¨è¨¨—š± = array($F°•¾½Ò×“[410] => $BÃ—ğÎ©ô, $F°•¾½Ò×“[1512] => USER_ID); if ($BÃ—ğÎ©ô == 0) { $B¨è¨¨—š± = array($F°•¾½Ò×“[1833] => $BË¤Ãé±[$F°•¾½Ò×“[1062]], $F°•¾½Ò×“[1512] => USER_ID); } goto cãÅˆ£ñ©; dé…¦›Ô: $dêÔëÖºİ× = array($F°•¾½Ò×“[1512] => USER_ID, $F°•¾½Ò×“[410] => $BÃ—ğÎ©ô, $F°•¾½Ò×“[1426] => $F°•¾½Ò×“[33], $F°•¾½Ò×“[473] => 0, $F°•¾½Ò×“[475] => 0, $F°•¾½Ò×“[1062] => $F°•¾½Ò×“[33], $F°•¾½Ò×“[305] => $F°•¾½Ò×“[33], $F°•¾½Ò×“[840] => $F°•¾½Ò×“[33], $F°•¾½Ò×“[1834] => 0, $F°•¾½Ò×“[1835] => 0, $F°•¾½Ò×“[476] => 0, $F°•¾½Ò×“[477] => $F°•¾½Ò×“[33], $F°•¾½Ò×“[470] => $F°•¾½Ò×“[33]); $Fª¬‰İŸ‘¹ = explode($F°•¾½Ò×“[47], $F°•¾½Ò×“[1836]); foreach ($Fª¬‰İŸ‘¹ as $D§¨Ùµ·ó) { if (!isset($BË¤Ãé±[$D§¨Ùµ·ó])) { continue; } $dêÔëÖºİ×[$D§¨Ùµ·ó] = $BË¤Ãé±[$D§¨Ùµ·ó]; } goto C†ÕÕåì†; C†ÕÕåì†: $f‹µÙ®Ëï¶ = $this->add($dêÔëÖºİ×); $b‹‰ã¹ì×¾ = array($F°•¾½Ò×“[470] => short_id($f‹µÙ®Ëï¶)); $this->where(array($F°•¾½Ò×“[467] => $f‹µÙ®Ëï¶))->save($b‹‰ã¹ì×¾); goto e­ëö²¦Ú; F±Ş¨Ò‡Ø­: } private function _shareAuthSet($c£—Š·‰º, $bºôÆ–„Â¥) { goto CÎÏÇƒ©æå; C»çï®ÑÁ: $Bóìé‡Ç¡‹->where(array($D¥±«Ü„„ğ[468] => $c£—Š·‰º))->delete(); $EĞ‡¦Î§†® = array(); foreach ($bºôÆ–„Â¥ as $e·­‚‘Üçå) { $bæ¹³»â…ƒ = SourceModel::TYPE_USER; if ($e·­‚‘Üçå[$D¥±«Ü„„ğ[404]] == SourceModel::TYPE_GROUP) { $bæ¹³»â…ƒ = SourceModel::TYPE_GROUP; } $FÃ±Ú«ğ©ˆ = array($D¥±«Ü„„ğ[468] => $c£—Š·‰º, $D¥±«Ü„„ğ[404] => $bæ¹³»â…ƒ, $D¥±«Ü„„ğ[484] => intval($e·­‚‘Üçå[$D¥±«Ü„„ğ[484]]), $D¥±«Ü„„ğ[1783] => 0, $D¥±«Ü„„ğ[1837] => -1); if ($e·­‚‘Üçå[$D¥±«Ü„„ğ[1783]]) { $FÃ±Ú«ğ©ˆ[$D¥±«Ü„„ğ[1783]] = $e·­‚‘Üçå[$D¥±«Ü„„ğ[1783]]; } else { if ($e·­‚‘Üçå[$D¥±«Ü„„ğ[1837]]) { $FÃ±Ú«ğ©ˆ[$D¥±«Ü„„ğ[1837]] = $e·­‚‘Üçå[$D¥±«Ü„„ğ[1837]]; } } $EĞ‡¦Î§†®[] = $FÃ±Ú«ğ©ˆ; } goto cÄµëê –; cÄµëê –: return $Bóìé‡Ç¡‹->addAll($EĞ‡¦Î§†®, array(), !0); goto dñ­¥ˆ÷œ; CÎÏÇƒ©æå: $D¥±«Ü„„ğ =& $_SERVER[¬¦ã¾]; if (!is_array($bºôÆ–„Â¥)) { return !1; } $Bóìé‡Ç¡‹ = Model($D¥±«Ü„„ğ[1787]); goto C»çï®ÑÁ; dñ­¥ˆ÷œ: } public function numViewAdd($F—¬³´ÃóÛ) { $fÂ¯¨³¶­° =& $_SERVER[¬¦ã¾]; $b•†ôã£æÃ = array($fÂ¯¨³¶­°[467] => $F—¬³´ÃóÛ); $this->where($b•†ôã£æÃ)->setAdd($fÂ¯¨³¶­°[1834]); } public function numDownloadAdd($d§ªÀÔÚõÆ) { $fÖŠÜ†ø¶ =& $_SERVER[¬¦ã¾]; $f¯©‰™¬­ë = array($fÖŠÜ†ø¶[467] => $d§ªÀÔÚõÆ); $this->where($f¯©‰™¬­ë)->setAdd($fÖŠÜ†ø¶[1835]); } protected function shareEdit($EÆàÏ«Å‚, $a–Ë²èñ¬ƒ) { goto cëŞ¦ØÓ°·; cëŞ¦ØÓ°·: $D£‰¤µš´ =& $_SERVER[¬¦ã¾]; $CË£¯™·÷ô = $this->getInfo($EÆàÏ«Å‚); if (!$CË£¯™·÷ô) { return !1; } goto BÀî•§±–; BÀî•§±–: $this->_checkLinkShare($a–Ë²èñ¬ƒ, $CË£¯™·÷ô); $b—²À‚ÍÄÜ = array(); $EÃÌÉáë¿ = explode($D£‰¤µš´[47], $D£‰¤µš´[1838]); goto a¸º¹À¯Ä; a¸º¹À¯Ä: foreach ($EÃÌÉáë¿ as $eËï›ŒÔŞ) { if (!array_key_exists($eËï›ŒÔŞ, $a–Ë²èñ¬ƒ)) { continue; } $b—²À‚ÍÄÜ[$eËï›ŒÔŞ] = $a–Ë²èñ¬ƒ[$eËï›ŒÔŞ]; } $this->shareEventAdd($CË£¯™·÷ô[$D£‰¤µš´[395]], $a–Ë²èñ¬ƒ, $D£‰¤µš´[1655]); $this->where(array($D£‰¤µš´[467] => $EÆàÏ«Å‚))->save($b—²À‚ÍÄÜ); goto C„ÇÑä¸•İ; C„ÇÑä¸•İ: if (isset($a–Ë²èñ¬ƒ[$D£‰¤µš´[1827]])) { $this->_shareAuthSet($EÆàÏ«Å‚, $a–Ë²èñ¬ƒ[$D£‰¤µš´[1827]]); } return !0; goto bß³Ÿè¯‰Ô; bß³Ÿè¯‰Ô: } private function _checkLinkShare($dÕ°¦õÏêË, $c‚¸¼»Œª‚) { goto cêåİŠÇ»; B‘ßÆ‹©±™: $f”ö¦—ğ†‚ = $this->shareFileMeta($f‡¶ˆâæ“[$Eá´•Á®¢º[447]]); if (isset($f”ö¦—ğ†‚[$Eá´•Á®¢º[372]]) && $f”ö¦—ğ†‚[$Eá´•Á®¢º[372]] == $Eá´•Á®¢º[87]) { show_json(LNG($Eá´•Á®¢º[1841]), !1); } goto A­ƒ«Áá‹; eñÆØÔÇ†: if ($c‚¸¼»Œª‚[$Eá´•Á®¢º[85]][$Eá´•Á®¢º[29]] != $Eá´•Á®¢º[193]) { $E‹å½òƒ = $this->_folderReport($d’œ¶µŠ«); if (!$E‹å½òƒ) { return; } show_json(LNG($Eá´•Á®¢º[1839]) . $Eá´•Á®¢º[1840] . $E‹å½òƒ, !1); } $f‡¶ˆâæ“ = Model($Eá´•Á®¢º[782])->fileInfoGet($c‚¸¼»Œª‚[$Eá´•Á®¢º[85]][$Eá´•Á®¢º[395]]); if (!$f‡¶ˆâæ“) { return; } goto B‘ßÆ‹©±™; cêåİŠÇ»: $Eá´•Á®¢º =& $_SERVER[¬¦ã¾]; if ($dÕ°¦õÏêË[$Eá´•Á®¢º[473]] != $Eá´•Á®¢º[87]) { return; } $d’œ¶µŠ« = $c‚¸¼»Œª‚[$Eá´•Á®¢º[85]][$Eá´•Á®¢º[395]]; goto eñÆØÔÇ†; A­ƒ«Áá‹: } private function _folderReport($dÁÑ‹Ì‹ğÁ) { goto AùçŸíàŠÇ; Fƒ‘–¾ØŞ†: $FàÛ¶’°ƒ = array_to_keyvalue($F§ …İÎÔÆ, $FšÁÄÔèí£[33], $FšÁÄÔèí£[28]); $FàÛ¶’°ƒ[] = $CÇë´•Ö¿¥[$FšÁÄÔèí£[28]]; return implode($FšÁÄÔèí£[8], $FàÛ¶’°ƒ); goto CæŞç‹¶ğÔ; AùçŸíàŠÇ: $FšÁÄÔèí£ =& $_SERVER[¬¦ã¾]; $CÙéª£ì” = array($FšÁÄÔèí£[447] => array($FšÁÄÔèí£[960], 0), $FšÁÄÔèí£[702] => 3); $CÇç‰“ š‹ = Model($FšÁÄÔèí£[1842])->where($CÙéª£ì”)->field($FšÁÄÔèí£[447])->select(); goto a´ãŠêÜŸƒ; a´ãŠêÜŸƒ: if (!$CÇç‰“ š‹) { return !1; } $CÇç‰“ š‹ = array_to_keyvalue($CÇç‰“ š‹, $FšÁÄÔèí£[33], $FšÁÄÔèí£[447]); $FÛÒ‡÷‰î = $FšÁÄÔèí£[47] . $dÁÑ‹Ì‹ğÁ . $FšÁÄÔèí£[47]; goto F°ˆ§‘ßßñ; F°ˆ§‘ßßñ: $CÙéª£ì” = array($FšÁÄÔèí£[447] => array($FšÁÄÔèí£[7], $CÇç‰“ š‹), $FšÁÄÔèí£[487] => array($FšÁÄÔèí£[380], "\x25{$FÛÒ‡÷‰î}\45"), $FšÁÄÔèí£[423] => 0); $CÇë´•Ö¿¥ = Model($FšÁÄÔèí£[782])->where($CÙéª£ì”)->field($FšÁÄÔèí£[1843])->find(); if (!$CÇë´•Ö¿¥) { return !1; } goto bŞ„îÜÕä; bŞ„îÜÕä: $Eéñø—´Ò´ = substr($CÇë´•Ö¿¥[$FšÁÄÔèí£[487]], strpos($CÇë´•Ö¿¥[$FšÁÄÔèí£[487]], $FÛÒ‡÷‰î)); $CÙéª£ì” = array($FšÁÄÔèí£[395] => array($FšÁÄÔèí£[7], trim($Eéñø—´Ò´, $FšÁÄÔèí£[47]))); $F§ …İÎÔÆ = Model($FšÁÄÔèí£[782])->where($CÙéª£ì”)->field($FšÁÄÔèí£[28])->select(); goto Fƒ‘–¾ØŞ†; CæŞç‹¶ğÔ: } protected function remove($c°ØÜÙãÌ) { goto Eƒ‹Ø‘Âä; f†¿¯ˆ‹—›: for ($CøÈôšæ÷§ = 0; $CøÈôšæ÷§ < count($CëĞ’¶İÃš); $CøÈôšæ÷§++) { $cºÈË¹ƒĞÚ = $this->getInfo($CëĞ’¶İÃš[$CøÈôšæ÷§]); if ($cºÈË¹ƒĞÚ[$D‘–¾ƒì¼–[475]] == $D‘–¾ƒì¼–[87]) { Model($D‘–¾ƒì¼–[533])->eventShare($cºÈË¹ƒĞÚ[$D‘–¾ƒì¼–[395]], $D‘–¾ƒì¼–[1832]); } if ($cºÈË¹ƒĞÚ[$D‘–¾ƒì¼–[473]] == $D‘–¾ƒì¼–[87]) { Model($D‘–¾ƒì¼–[533])->eventShare($cºÈË¹ƒĞÚ[$D‘–¾ƒì¼–[395]], $D‘–¾ƒì¼–[1831]); } } return $BÇöŒ»„ÜÁ; goto fÅ»×­šÛ; Eƒ‹Ø‘Âä: $D‘–¾ƒì¼– =& $_SERVER[¬¦ã¾]; if (is_array($c°ØÜÙãÌ)) { $c°ØÜÙãÌ = array($D‘–¾ƒì¼–[7], $c°ØÜÙãÌ); } $F©—½ÓÉ¦Ú = array($D‘–¾ƒì¼–[468] => $c°ØÜÙãÌ); goto c‘ƒóÁ‡ºõ; c‘ƒóÁ‡ºõ: $BÇöŒ»„ÜÁ = $this->where($F©—½ÓÉ¦Ú)->delete(); if ($BÇöŒ»„ÜÁ) { Model($D‘–¾ƒì¼–[564])->where(array($D‘–¾ƒì¼–[468] => $c°ØÜÙãÌ))->delete(); } $CëĞ’¶İÃš = is_array($c°ØÜÙãÌ) ? $c°ØÜÙãÌ[1] : array($c°ØÜÙãÌ); goto f†¿¯ˆ‹—›; fÅ»×­šÛ: } protected function removeBySource($fŞ—Úá·ø) { goto Bƒ¥ÔÃ…ÌŸ; D‰›à‹İÍé: $this->where($d§‰­øÈ¢¥)->delete(); Model($BØ¦ö¾¤ª¢[564])->where($d§‰­øÈ¢¥)->delete(); goto E¾­ê„åì; Bƒ¥ÔÃ…ÌŸ: $BØ¦ö¾¤ª¢ =& $_SERVER[¬¦ã¾]; $d§‰­øÈ¢¥ = array($BØ¦ö¾¤ª¢[410] => array($BØ¦ö¾¤ª¢[411], $fŞ—Úá·ø)); $DÜîĞô›ÃÏ = $this->field($BØ¦ö¾¤ª¢[468])->where($d§‰­øÈ¢¥)->select(); goto dÍŸÖ›öŠ†; dÍŸÖ›öŠ†: $DÜîĞô›ÃÏ = array_to_keyvalue($DÜîĞô›ÃÏ, $BØ¦ö¾¤ª¢[33], $BØ¦ö¾¤ª¢[468]); if (!$DÜîĞô›ÃÏ) { return; } $d§‰­øÈ¢¥ = array($BØ¦ö¾¤ª¢[467] => array($BØ¦ö¾¤ª¢[411], $DÜîĞô›ÃÏ)); goto D‰›à‹İÍé; E¾­ê„åì: } public function listAll($BØóŒø¹¨õ) { goto D…›¯——È; dò•È«óõ: if ($BØóŒø¹¨õ[$d“è‘•èĞÜ[713]]) { $D‚¼ßïŒëÍ = $BØóŒø¹¨õ[$d“è‘•èĞÜ[476]] ? $BØóŒø¹¨õ[$d“è‘•èĞÜ[476]] : strtotime(date($d“è‘•èĞÜ[1844])); $AçİŸ¾„…ç[$d“è‘•èĞÜ[194]] = array($d“è‘•èĞÜ[331], array($BØóŒø¹¨õ[$d“è‘•èĞÜ[713]], $D‚¼ßïŒëÍ)); } if ($BØóŒø¹¨õ[$d“è‘•èĞÜ[29]]) { $AçİŸ¾„…ç[$BØóŒø¹¨õ[$d“è‘•èĞÜ[29]]] = 1; } else { $AçİŸ¾„…ç[] = array($d“è‘•èĞÜ[473] => array($d“è‘•èĞÜ[960], 0), $d“è‘•èĞÜ[475] => array($d“è‘•èĞÜ[960], 0), $d“è‘•èĞÜ[1821] => $d“è‘•èĞÜ[1775]); } if ($BØóŒø¹¨õ[$d“è‘•èĞÜ[1771]]) { $AçİŸ¾„…ç[] = array($d“è‘•èĞÜ[470] => $BØóŒø¹¨õ[$d“è‘•èĞÜ[1771]], $d“è‘•èĞÜ[1426] => array($d“è‘•èĞÜ[380], "\45{$BØóŒø¹¨õ[$d“è‘•èĞÜ[1771]]}\x25"), $d“è‘•èĞÜ[1821] => $d“è‘•èĞÜ[1775]); } goto EÖÆ¯‹æº; D…›¯——È: $d“è‘•èĞÜ =& $_SERVER[¬¦ã¾]; $AçİŸ¾„…ç = array(); if ($BØóŒø¹¨õ[$d“è‘•èĞÜ[1520]]) { $AçİŸ¾„…ç[$d“è‘•èĞÜ[1520]] = $BØóŒø¹¨õ[$d“è‘•èĞÜ[1520]]; } goto dò•È«óõ; EÖÆ¯‹æº: $c¶Š—–ÌğÓ = $this->_makeOrder()->where($AçİŸ¾„…ç)->selectPage(20); if (empty($c¶Š—–ÌğÓ[$d“è‘•èĞÜ[367]])) { return array(); } $this->_listDataApply($c¶Š—–ÌğÓ[$d“è‘•èĞÜ[367]]); goto bó£“Ãó¹ê; bó£“Ãó¹ê: return $c¶Š—–ÌğÓ; goto EÚÃßÊ‡‰; EÚÃßÊ‡‰: } public function listDataApply($Dñ°Šõß´) { $this->_listDataApply($Dñ°Šõß´); return $Dñ°Šõß´; } private function _listDataApply(&$FÈ‰Ø³Óô) { goto D¤¨ŠŒ¹«Õ; Fë¬ÍæÉÒ: unset($b™ÚÒ—²‘†); $FÈ‰Ø³Óô = array_values($FÈ‰Ø³Óô); goto EÄÖµÇÒª‰; E°î¡ìË”¬: $e»êËçÄÄš = array_to_keyvalue($FÈ‰Ø³Óô, $dâì¯¤¯²Ğ[33], $dâì¯¤¯²Ğ[395]); $A³Â £Ò„‚ = Model($dâì¯¤¯²Ğ[782])->sourceListInfo($e»êËçÄÄš, !0); foreach ($FÈ‰Ø³Óô as $båîÉ°Ğ¢ => &$b™ÚÒ—²‘†) { $BâŸöïÉÃ = $b™ÚÒ—²‘†[$dâì¯¤¯²Ğ[1520]]; $b™ÚÒ—²‘†[$dâì¯¤¯²Ğ[1845]] = $eÓ†Ó§÷Ò§[$BâŸöïÉÃ] ? $eÓ†Ó§÷Ò§[$BâŸöïÉÃ] : !1; $a ³Ï–´ÓÑ = $b™ÚÒ—²‘†[$dâì¯¤¯²Ğ[395]]; $b™ÚÒ—²‘†[$dâì¯¤¯²Ğ[85]] = $A³Â £Ò„‚[$a ³Ï–´ÓÑ] ? $A³Â £Ò„‚[$a ³Ï–´ÓÑ] : !1; if ($b™ÚÒ—²‘†[$dâì¯¤¯²Ğ[85]][$dâì¯¤¯²Ğ[423]] == $dâì¯¤¯²Ğ[87]) { unset($FÈ‰Ø³Óô[$båîÉ°Ğ¢]); } if ($b™ÚÒ—²‘†[$dâì¯¤¯²Ğ[85]] != $dâì¯¤¯²Ğ[191] && !$b™ÚÒ—²‘†[$dâì¯¤¯²Ğ[85]]) { unset($FÈ‰Ø³Óô[$båîÉ°Ğ¢]); } } goto Fë¬ÍæÉÒ; D¤¨ŠŒ¹«Õ: $dâì¯¤¯²Ğ =& $_SERVER[¬¦ã¾]; $AÍùî«˜¤ = array_to_keyvalue($FÈ‰Ø³Óô, $dâì¯¤¯²Ğ[33], $dâì¯¤¯²Ğ[1520]); $eÓ†Ó§÷Ò§ = Model($dâì¯¤¯²Ğ[506])->userListInfo(array_unique($AÍùî«˜¤)); goto E°î¡ìË”¬; EÄÖµÇÒª‰: } private function _makeOrder($f¬·³è™Ø† = '') { goto BÇ‡á½×­Œ; Aöîğ¼ –: $bííÚï÷ù³ = Input::get($dË–Æ‘Ÿæ˜[435], $dË–Æ‘Ÿæ˜[7], $dË–Æ‘Ÿæ˜[416], $fŸà´øáÒ˜); $FùˆƒîóÏ = Input::get($dË–Æ‘Ÿæ˜[436], $dË–Æ‘Ÿæ˜[7], $dË–Æ‘Ÿæ˜[1846], array($dË–Æ‘Ÿæ˜[1770], $dË–Æ‘Ÿæ˜[430])); $FùˆƒîóÏ = $eÔØ“³ô™[$FùˆƒîóÏ]; goto b”ÒÖ•ÔÀ‡; BÇ‡á½×­Œ: $dË–Æ‘Ÿæ˜ =& $_SERVER[¬¦ã¾]; $fŸà´øáÒ˜ = array($dË–Æ‘Ÿæ˜[194], $dË–Æ‘Ÿæ˜[476], $dË–Æ‘Ÿæ˜[1834], $dË–Æ‘Ÿæ˜[1835]); $eÔØ“³ô™ = array($dË–Æ‘Ÿæ˜[428] => $dË–Æ‘Ÿæ˜[429], $dË–Æ‘Ÿæ˜[430] => $dË–Æ‘Ÿæ˜[431]); goto Aöîğ¼ –; b”ÒÖ•ÔÀ‡: $f¬·³è™Ø† = $f¬·³è™Ø† . "{$bííÚï÷ù³}\40{$FùˆƒîóÏ}"; return $this->order($f¬·³è™Ø†); goto D‰¯áïÍ„ï; D‰¯áïÍ„ï: } public function reportAdd($AÛ‹‡ˆÙ‘ì) { $C¨†ª†¥àÛ =& $_SERVER[¬¦ã¾]; $C¹°¸§ÜÃ = array($C¨†ª†¥àÛ[468] => $AÛ‹‡ˆÙ‘ì[$C¨†ª†¥àÛ[468]], $C¨†ª†¥àÛ[1520] => USER_ID); if (Model($C¨†ª†¥àÛ[1842])->where($C¹°¸§ÜÃ)->find()) { return !1; } $eÍ„—å‘æÏ = array($C¨†ª†¥àÛ[468] => $AÛ‹‡ˆÙ‘ì[$C¨†ª†¥àÛ[468]], $C¨†ª†¥àÛ[1426] => $AÛ‹‡ˆÙ‘ì[$C¨†ª†¥àÛ[1426]], $C¨†ª†¥àÛ[395] => $AÛ‹‡ˆÙ‘ì[$C¨†ª†¥àÛ[395]], $C¨†ª†¥àÛ[447] => $AÛ‹‡ˆÙ‘ì[$C¨†ª†¥àÛ[447]], $C¨†ª†¥àÛ[1520] => USER_ID, $C¨†ª†¥àÛ[29] => $AÛ‹‡ˆÙ‘ì[$C¨†ª†¥àÛ[29]], $C¨†ª†¥àÛ[431] => $AÛ‹‡ˆÙ‘ì[$C¨†ª†¥àÛ[431]]); return Model($C¨†ª†¥àÛ[1842])->add($eÍ„—å‘æÏ); } public function reportList($f®ÈïÌ¶¯ù) { goto Fƒù§°…ÒÙ; Fƒù§°…ÒÙ: $f÷¾ªğĞ‘Á =& $_SERVER[¬¦ã¾]; $B ›‘ƒî« = array(); if ($f®ÈïÌ¶¯ù[$f÷¾ªğĞ‘Á[713]]) { $AĞÌìŠ¢ìå = $f®ÈïÌ¶¯ù[$f÷¾ªğĞ‘Á[476]] ? $f®ÈïÌ¶¯ù[$f÷¾ªğĞ‘Á[476]] : strtotime(date($f÷¾ªğĞ‘Á[1844])); $B ›‘ƒî«[$f÷¾ªğĞ‘Á[194]] = array($f÷¾ªğĞ‘Á[331], array($f®ÈïÌ¶¯ù[$f÷¾ªğĞ‘Á[713]], $AĞÌìŠ¢ìå)); } goto bá“•‡µ‚; F…Ñ®Õ³ùî: if (empty($e½Ä±ÎÃ—Á[$f÷¾ªğĞ‘Á[367]])) { return array(); } $BßõÁâœ£ø = array_to_keyvalue_group($e½Ä±ÎÃ—Á[$f÷¾ªğĞ‘Á[367]], $f÷¾ªğĞ‘Á[702], $f÷¾ªğĞ‘Á[468]); if (!empty($BßõÁâœ£ø[0])) { $f®ÈïÌ¶¯ù = $BßõÁâœ£ø[0]; $B ›‘ƒî« = array($f÷¾ªğĞ‘Á[468] => array($f÷¾ªğĞ‘Á[7], $f®ÈïÌ¶¯ù)); $FŒ³Ï¬ÃÜö = $this->where($B ›‘ƒî«)->field($f÷¾ªğĞ‘Á[468])->select(); $FŒ³Ï¬ÃÜö = array_to_keyvalue($FŒ³Ï¬ÃÜö, $f÷¾ªğĞ‘Á[33], $f÷¾ªğĞ‘Á[468]); $A´äÌö¯Õ = array_diff($f®ÈïÌ¶¯ù, $FŒ³Ï¬ÃÜö); if (!empty($A´äÌö¯Õ)) { foreach ($e½Ä±ÎÃ—Á[$f÷¾ªğĞ‘Á[367]] as $aî¼‰ŒºœÃ => $fçÇá¥Ğ°) { if (in_array($fçÇá¥Ğ°[$f÷¾ªğĞ‘Á[468]], $A´äÌö¯Õ)) { unset($e½Ä±ÎÃ—Á[$f÷¾ªğĞ‘Á[367]][$aî¼‰ŒºœÃ]); } } } } goto f’óïÎ§Ï„; BŒŞ®‚äµ: $d¦Ö £¬ = array($f÷¾ªğĞ‘Á[428] => $f÷¾ªğĞ‘Á[429], $f÷¾ªğĞ‘Á[430] => $f÷¾ªğĞ‘Á[431]); $F²êªÑçŠ = $f÷¾ªğĞ‘Á[1851] . $d¦Ö £¬[$aêîõˆ®Ï‹]; $e½Ä±ÎÃ—Á = Model($f÷¾ªğĞ‘Á[1842])->where($B ›‘ƒî«)->order($F²êªÑçŠ)->selectPage(20); goto F…Ñ®Õ³ùî; f’óïÎ§Ï„: $this->_listDataApply($e½Ä±ÎÃ—Á[$f÷¾ªğĞ‘Á[367]]); return $e½Ä±ÎÃ—Á; goto DÕ‹åßÁçÙ; bá“•‡µ‚: if (isset($f®ÈïÌ¶¯ù[$f÷¾ªğĞ‘Á[29]]) && in_array($f®ÈïÌ¶¯ù[$f÷¾ªğĞ‘Á[29]], array($f÷¾ªğĞ‘Á[87], $f÷¾ªğĞ‘Á[1847], $f÷¾ªğĞ‘Á[1848], $f÷¾ªğĞ‘Á[1849], $f÷¾ªğĞ‘Á[1850]))) { $B ›‘ƒî«[$f÷¾ªğĞ‘Á[29]] = $f®ÈïÌ¶¯ù[$f÷¾ªğĞ‘Á[29]]; } if (isset($f®ÈïÌ¶¯ù[$f÷¾ªğĞ‘Á[702]]) && in_array($f®ÈïÌ¶¯ù[$f÷¾ªğĞ‘Á[702]], array($f÷¾ªğĞ‘Á[191], $f÷¾ªğĞ‘Á[87], $f÷¾ªğĞ‘Á[1847], $f÷¾ªğĞ‘Á[1848]))) { $B ›‘ƒî«[$f÷¾ªğĞ‘Á[702]] = $f®ÈïÌ¶¯ù[$f÷¾ªğĞ‘Á[702]]; } $aêîõˆ®Ï‹ = Input::get($f÷¾ªğĞ‘Á[436], $f÷¾ªğĞ‘Á[7], $f÷¾ªğĞ‘Á[1846], array($f÷¾ªğĞ‘Á[1770], $f÷¾ªğĞ‘Á[430])); goto BŒŞ®‚äµ; DÕ‹åßÁçÙ: } public function reportStatus($f•Ì‹È©Åô) { goto dË˜‡õ…Ê«; A©ô™Ô¿›ä: $d«•ÉÄî¨Ñ = Model($c¢«øšé„†[1842])->where($bˆ‚¶Ê£Áƒ)->save($eÎÁöŞèí“); if ($f•Ì‹È©Åô[$c¢«øšé„†[702]] == $c¢«øšé„†[1847]) { if ($BòĞ«à­ŞÆ[$c¢«øšé„†[447]] != $c¢«øšé„†[191] && $this->shareFileMeta($BòĞ«à­ŞÆ[$c¢«øšé„†[447]])) { $this->shareFileMeta($BòĞ«à­ŞÆ[$c¢«øšé„†[447]], 0); } $this->remove($BòĞ«à­ŞÆ[$c¢«øšé„†[468]]); return !0; } if ($d«•ÉÄî¨Ñ && $f•Ì‹È©Åô[$c¢«øšé„†[702]] == $c¢«øšé„†[1848]) { $b£‰óöŠ”´ = $eÎÁöŞèí“[$c¢«øšé„†[702]] == $c¢«øšé„†[1848] ? 1 : 0; $this->shareFileMeta($BòĞ«à­ŞÆ[$c¢«øšé„†[447]], $b£‰óöŠ”´); $this->removeByFile($BòĞ«à­ŞÆ[$c¢«øšé„†[447]]); } goto fÓöâØÙ½; díÃì£¸–è: if (!$BòĞ«à­ŞÆ) { return !1; } $eÎÁöŞèí“ = array($c¢«øšé„†[702] => $f•Ì‹È©Åô[$c¢«øšé„†[702]]); if ($f•Ì‹È©Åô[$c¢«øšé„†[702]] == $c¢«øšé„†[1848] && $BòĞ«à­ŞÆ[$c¢«øšé„†[702]] == $c¢«øšé„†[1848]) { $eÎÁöŞèí“[$c¢«øšé„†[702]] = 0; } goto A©ô™Ô¿›ä; dË˜‡õ…Ê«: $c¢«øšé„† =& $_SERVER[¬¦ã¾]; $bˆ‚¶Ê£Áƒ = array($c¢«øšé„†[393] => $f•Ì‹È©Åô[$c¢«øšé„†[393]]); $BòĞ«à­ŞÆ = Model($c¢«øšé„†[1842])->where($bˆ‚¶Ê£Áƒ)->field($c¢«øšé„†[1852])->find(); goto díÃì£¸–è; fÓöâØÙ½: return $d«•ÉÄî¨Ñ; goto e‡ª™†ïˆÅ; e‡ª™†ïˆÅ: } private function removeByFile($C Ò·Œ›”) { goto E Ÿ¶ä÷˜; AèÅ”¹Ë†‘: $dø•‚ˆºÀ = array_to_keyvalue($Bê»£²ÎÀ, $DŞá”å½¾ö[33], $DŞá”å½¾ö[468]); $this->remove($dø•‚ˆºÀ); goto d¨¿ä±åŠ‰; cøÚì¨ïï–: $C‡ÚšÅ–êÚ = array($DŞá”å½¾ö[395] => array($DŞá”å½¾ö[7], $cĞ¥§é·¡˜), $DŞá”å½¾ö[473] => 1); $Bê»£²ÎÀ = $this->where($C‡ÚšÅ–êÚ)->field($DŞá”å½¾ö[468])->select(); if (empty($Bê»£²ÎÀ)) { return; } goto AèÅ”¹Ë†‘; E Ÿ¶ä÷˜: $DŞá”å½¾ö =& $_SERVER[¬¦ã¾]; $Bê»£²ÎÀ = Model($DŞá”å½¾ö[782])->where(array($DŞá”å½¾ö[447] => $C Ò·Œ›”))->field($DŞá”å½¾ö[395])->select(); $cĞ¥§é·¡˜ = array_to_keyvalue($Bê»£²ÎÀ, $DŞá”å½¾ö[33], $DŞá”å½¾ö[395]); goto cøÚì¨ïï–; d¨¿ä±åŠ‰: } private function shareFileMeta($cÏ°Ü–ƒñ¯, $Fã÷ÃêĞìÊ = null) { $FùÀ“®Ş„ =& $_SERVER[¬¦ã¾]; $eº¼Ñ‹²á = array($FùÀ“®Ş„[447] => $cÏ°Ü–ƒñ¯, $FùÀ“®Ş„[93] => $FùÀ“®Ş„[1853]); if (is_null($Fã÷ÃêĞìÊ)) { return Model($FùÀ“®Ş„[1854])->where($eº¼Ñ‹²á)->find(); } $eº¼Ñ‹²á[$FùÀ“®Ş„[372]] = $Fã÷ÃêĞìÊ; Model($FùÀ“®Ş„[1854])->add($eº¼Ñ‹²á, array(), !0); } } class SourceAuthModel extends ModelBase { protected $tableName = "\151\x6f\x5f\x73\x6f\165\x72\143\x65\x5f\141\165\164\150"; public function getAuth($fàâ•¯Ùß) { goto eæÔ¥²ãèø; AÑêá½¾ò: array_multisort($F¸Û—‚Ä–, SORT_DESC, $a‚£‰÷ìÃ); return $a‚£‰÷ìÃ; goto B‡çŠ³Ñ‡í; aĞ£œ–Ü¦¶: $F¸Û—‚Ä– = array(); $EÖ§Ìì·Ãà = 2 << 25; foreach ($FÓğ¥‘åŞ as $B¤Ì®İ¥ĞÇ) { goto FÆ®ø²½ê; Eã»¶“¡ÒÍ: if ($B¤Ì®İ¥ĞÇ[$A½¶Ì§ØèÅ[404]] == SourceModel::TYPE_USER && $B¤Ì®İ¥ĞÇ[$A½¶Ì§ØèÅ[484]] == $A½¶Ì§ØèÅ[191]) { $Fˆøõø…“† = 0; } $F¸Û—‚Ä–[] = $CÖµ‡¿âœ[$A½¶Ì§ØèÅ[406]] + $Fˆøõø…“†; goto Fš³‹Œó¦Œ; FÆ®ø²½ê: $CÖµ‡¿âœ = Model($A½¶Ì§ØèÅ[1855])->listData($B¤Ì®İ¥ĞÇ[$A½¶Ì§ØèÅ[1783]]); if (!$CÖµ‡¿âœ) { continue; } $a‚£‰÷ìÃ[] = $B¤Ì®İ¥ĞÇ; goto dºæš¡¬“; dºæš¡¬“: $Fˆøõø…“† = 0; if ($B¤Ì®İ¥ĞÇ[$A½¶Ì§ØèÅ[404]] == SourceModel::TYPE_GROUP) { $Fˆøõø…“† = $EÖ§Ìì·Ãà * 2; } if ($B¤Ì®İ¥ĞÇ[$A½¶Ì§ØèÅ[404]] == SourceModel::TYPE_USER) { $Fˆøõø…“† = $EÖ§Ìì·Ãà; } goto Eã»¶“¡ÒÍ; Fš³‹Œó¦Œ: } goto AÑêá½¾ò; eæÔ¥²ãèø: $A½¶Ì§ØèÅ =& $_SERVER[¬¦ã¾]; $FÓğ¥‘åŞ = $this->sourceAuthSelect($fàâ•¯Ùß); $a‚£‰÷ìÃ = array(); goto aĞ£œ–Ü¦¶; B‡çŠ³Ñ‡í: } public function sourceAuthSelect($D†Î™ØˆÃ) { goto Cä›«àøâÒ; dîÇ²–ğ×õ: if ($D¢‰éÛïØª) { return $b½¡§£¬; } return $CİÕ¾÷ÔÎŸ; goto dòÈİä•Í; bÊêóï£Š²: if ($D¢‰éÛïØª) { $D†Î™ØˆÃ = array($D†Î™ØˆÃ); } $b‚–ÅŸÔ¢Ã = array(); foreach ($D†Î™ØˆÃ as $dœÉ»äÏ„) { if (isset($cÇó³˜ÈË§[$dœÉ»äÏ„])) { $b‚–ÅŸÔ¢Ã[$dœÉ»äÏ„] = $cÇó³˜ÈË§[$dœÉ»äÏ„]; } } goto F­šÖÚ³Ù; C“ÌÈ‚Œß›: $b½¡§£¬ = $this->field($A‡¢ÄÜÌ)->order($eÍ”¼›¾ˆ²[393])->where($c÷É­ä‡)->select(); $CİÕ¾÷ÔÎŸ = array_to_keyvalue_group($b½¡§£¬, $eÍ”¼›¾ˆ²[395]); foreach ($D†Î™ØˆÃ as $dœÉ»äÏ„) { $cÇó³˜ÈË§[$dœÉ»äÏ„] = $CİÕ¾÷ÔÎŸ[$dœÉ»äÏ„] ? $CİÕ¾÷ÔÎŸ[$dœÉ»äÏ„] : array(); } goto dîÇ²–ğ×õ; Cä›«àøâÒ: $eÍ”¼›¾ˆ² =& $_SERVER[¬¦ã¾]; static $cÇó³˜ÈË§ = array(); $D¢‰éÛïØª = is_array($D†Î™ØˆÃ) ? !1 : !0; goto bÊêóï£Š²; F­šÖÚ³Ù: if (count($b‚–ÅŸÔ¢Ã) == count($D†Î™ØˆÃ)) { return $D¢‰éÛïØª ? $b‚–ÅŸÔ¢Ã[$D†Î™ØˆÃ[0]] : $b‚–ÅŸÔ¢Ã; } $A‡¢ÄÜÌ = $eÍ”¼›¾ˆ²[1856]; $c÷É­ä‡ = array($eÍ”¼›¾ˆ²[395] => array($eÍ”¼›¾ˆ²[7], $D†Î™ØˆÃ)); goto C“ÌÈ‚Œß›; dòÈİä•Í: } public function setAuth($FìÑ–Á¤Õ, $A•»«Š÷‘ë) { goto BÄ‰Ğ©¡Äç; BÄ‰Ğ©¡Äç: $Bõ³Ã¸¥Ÿ =& $_SERVER[¬¦ã¾]; $AˆÈÙñôéÂ = Model($Bõ³Ã¸¥Ÿ[1197])->sourceInfo($FìÑ–Á¤Õ); if (!$AˆÈÙñôéÂ) { return !1; } goto c„ƒÈº¹Î‹; e¢¹ÍÚŸÏ: if ($D­›«ğá„õ != $EŠ‚‚‘Á«) { $B½³Å™â‹° = array($Bõ³Ã¸¥Ÿ[1688] => $D­›«ğá„õ); $eğòƒ‡‘¡ = Model($Bõ³Ã¸¥Ÿ[1769])->field($Bõ³Ã¸¥Ÿ[1520])->where($B½³Å™â‹°)->select(); $eğòƒ‡‘¡ = array_to_keyvalue($eğòƒ‡‘¡, $Bõ³Ã¸¥Ÿ[33], $Bõ³Ã¸¥Ÿ[1520]); } $b›šˆ«ŒÂŠ = array(SourceModel::TYPE_GROUP, SourceModel::TYPE_USER); $E‡Úäµ°é› = array(); goto EÃÇŠ®Ì‡‚; c„ƒÈº¹Î‹: if ($AˆÈÙñôéÂ[$Bõ³Ã¸¥Ÿ[404]] != SourceModel::TYPE_GROUP) { return !1; } $EŠ‚‚‘Á« = 1; $D­›«ğá„õ = $AˆÈÙñôéÂ[$Bõ³Ã¸¥Ÿ[484]]; goto e¢¹ÍÚŸÏ; EÃÇŠ®Ì‡‚: foreach ($A•»«Š÷‘ë as $c¬×ëˆ¥ÉÓ) { if (!in_array($c¬×ëˆ¥ÉÓ[$Bõ³Ã¸¥Ÿ[404]], $b›šˆ«ŒÂŠ)) { show_json(LNG($Bõ³Ã¸¥Ÿ[1857]), !1); } if ($D­›«ğá„õ != $EŠ‚‚‘Á«) { if ($c¬×ëˆ¥ÉÓ[$Bõ³Ã¸¥Ÿ[404]] == SourceModel::TYPE_GROUP) { } if ($c¬×ëˆ¥ÉÓ[$Bõ³Ã¸¥Ÿ[484]] != 0 && !in_array($c¬×ëˆ¥ÉÓ[$Bõ³Ã¸¥Ÿ[484]], $eğòƒ‡‘¡)) { } } if ($c¬×ëˆ¥ÉÓ[$Bõ³Ã¸¥Ÿ[484]] == 0) { $c¬×ëˆ¥ÉÓ[$Bõ³Ã¸¥Ÿ[404]] = SourceModel::TYPE_USER; } $E‡Úäµ°é›[] = array($Bõ³Ã¸¥Ÿ[395] => $FìÑ–Á¤Õ, $Bõ³Ã¸¥Ÿ[404] => intval($c¬×ëˆ¥ÉÓ[$Bõ³Ã¸¥Ÿ[404]]), $Bõ³Ã¸¥Ÿ[484] => intval($c¬×ëˆ¥ÉÓ[$Bõ³Ã¸¥Ÿ[484]]), $Bõ³Ã¸¥Ÿ[1783] => intval($c¬×ëˆ¥ÉÓ[$Bõ³Ã¸¥Ÿ[1783]]) ? intval($c¬×ëˆ¥ÉÓ[$Bõ³Ã¸¥Ÿ[1783]]) : 0, $Bõ³Ã¸¥Ÿ[1837] => intval($c¬×ëˆ¥ÉÓ[$Bõ³Ã¸¥Ÿ[1837]]) ? intval($c¬×ëˆ¥ÉÓ[$Bõ³Ã¸¥Ÿ[1837]]) : -1); } $this->where(array($Bõ³Ã¸¥Ÿ[410] => $FìÑ–Á¤Õ))->delete(); $this->addAll($E‡Úäµ°é›); goto aç‚Ñ¤­„Õ; aç‚Ñ¤­„Õ: return !0; goto BÍÆ’ùàô; BÍÆ’ùàô: } public function authClear($C»·Ò¼Ò¹) { $b¨™‘…ß™ =& $_SERVER[¬¦ã¾]; $BŞƒ¶Ğ•Ï = Model($b¨™‘…ß™[1197])->sourceInfo($C»·Ò¼Ò¹); $C¡Â‘±¢ÂÄ = array($C»·Ò¼Ò¹); if ($BŞƒ¶Ğ•Ï[$b¨™‘…ß™[403]] == $b¨™‘…ß™[87]) { $cˆï”±ÑĞ = array($b¨™‘…ß™[553] => array($b¨™‘…ß™[512], $BŞƒ¶Ğ•Ï[$b¨™‘…ß™[487]] . $C»·Ò¼Ò¹ . $b¨™‘…ß™[513])); $C¡Â‘±¢ÂÄ = Model($b¨™‘…ß™[1197])->field($b¨™‘…ß™[410])->where($cˆï”±ÑĞ)->getField($b¨™‘…ß™[395], !0); $C¡Â‘±¢ÂÄ[] = $C»·Ò¼Ò¹; } $this->where(array($b¨™‘…ß™[410] => array($b¨™‘…ß™[411], $C¡Â‘±¢ÂÄ)))->delete(); return !0; } public function getAllChildren($A˜µçƒñİ) { goto cƒ½æáÚ“ò; bòÌ¬¥õÀÎ: $FŠëé‘ ï½ = Model($B« «Â©ï[782])->field($B˜ºÂÀÚËœ)->where($e÷‹ÙöôŠ)->select(); $fÒ‡Íñ¶Û’ = array($A˜µçƒñİ); foreach ($FŠëé‘ ï½ as $F¥ô«Û›Œ¸) { foreach ($F–Ëã±ì®ç as $a÷˜›ˆ×Ó) { $b‹©Øä·— = $B« «Â©ï[47] . $a÷˜›ˆ×Ó . $B« «Â©ï[47]; $BÕ¯ªÍÎ£Ú = $F¥ô«Û›Œ¸[$B« «Â©ï[487]] . $F¥ô«Û›Œ¸[$B« «Â©ï[395]] . $B« «Â©ï[47]; if (strstr($BÕ¯ªÍÎ£Ú, $b‹©Øä·—)) { $fÒ‡Íñ¶Û’[] = $F¥ô«Û›Œ¸[$B« «Â©ï[395]]; break; } } } goto AÓ¼¦­•œ÷; EÛñŠš Œô: if ($e¸Çº‚ØêÜ[$B« «Â©ï[478]] == $B« «Â©ï[191] && $e¸Çº‚ØêÜ[$B« «Â©ï[484]] != $B”˜ËêÂ‘) { $F–Ëã±ì®ç = $this->groupChidldAllRootSource($e¸Çº‚ØêÜ[$B« «Â©ï[484]]); } $DÊÂ›œÃØ“ = $this->field($B« «Â©ï[395])->group($B« «Â©ï[395])->select(); $DÊÂ›œÃØ“ = array_to_keyvalue($DÊÂ›œÃØ“, $B« «Â©ï[33], $B« «Â©ï[395]); goto bø‹ÔÒÏ›ˆ; bø‹ÔÒÏ›ˆ: if (!$DÊÂ›œÃØ“) { return array(); } $B˜ºÂÀÚËœ = $B« «Â©ï[1858]; $e÷‹ÙöôŠ = array($B« «Â©ï[395] => array($B« «Â©ï[7], $DÊÂ›œÃØ“), $B« «Â©ï[423] => $B« «Â©ï[191]); goto bòÌ¬¥õÀÎ; cƒ½æáÚ“ò: $B« «Â©ï =& $_SERVER[¬¦ã¾]; $e¸Çº‚ØêÜ = Model($B« «Â©ï[1197])->sourceInfo($A˜µçƒñİ); if ($e¸Çº‚ØêÜ[$B« «Â©ï[403]] != $B« «Â©ï[87]) { return $this->sourceListAuth(array($A˜µçƒñİ)); } goto FÌĞ×ÆµØ; AÓ¼¦­•œ÷: return $this->sourceListAuth($fÒ‡Íñ¶Û’); goto Cå»ğ˜ßŒƒ; FÌĞ×ÆµØ: if ($e¸Çº‚ØêÜ[$B« «Â©ï[404]] != SourceModel::TYPE_GROUP) { return array(); } $B”˜ËêÂ‘ = 1; $F–Ëã±ì®ç = array($A˜µçƒñİ); goto EÛñŠš Œô; Cå»ğ˜ßŒƒ: } private function sourceListAuth($Eê†«ŒŠ) { goto dà’ì¼İ—; dà’ì¼İ—: $dªÙµ¦Ì¥™ =& $_SERVER[¬¦ã¾]; $aŞ½ÀëŠ·õ = Model($dªÙµ¦Ì¥™[1197])->sourceListInfo($Eê†«ŒŠ, !0); $b†±øÈ—µ = $this->sourceAuthSelect($Eê†«ŒŠ); goto fÙÅ åÎ‹É; fÙÅ åÎ‹É: $AªÔÜ¨‹™ = array(); $bš ¿·¿³‚ = array(); foreach ($aŞ½ÀëŠ·õ as $aÚ®ƒƒŸÊã) { goto d­˜ˆ«¦š; A¯‹È‡Áß: unset($aÚ®ƒƒŸÊã[$dªÙµ¦Ì¥™[85]]); $B½ïß‡½¤‰ = $b†±øÈ—µ[$aÚ®ƒƒŸÊã[$dªÙµ¦Ì¥™[395]]]; if (!$B½ïß‡½¤‰) { continue; } goto B™˜ĞĞ•; a¾õ„µ¾Ú: $C …ğƒŠÉ = count(explode($dªÙµ¦Ì¥™[8], trim($aÚ®ƒƒŸÊã[$dªÙµ¦Ì¥™[495]], $dªÙµ¦Ì¥™[8]))); $bš ¿·¿³‚[] = $C …ğƒŠÉ + ($aÚ®ƒƒŸÊã[$dªÙµ¦Ì¥™[29]] == $dªÙµ¦Ì¥™[77] ? 0 : 1000); goto eõ¿¡Ï·ÔÔ; B™˜ĞĞ•: $aÚ®ƒƒŸÊã[$dªÙµ¦Ì¥™[1859]] = $this->authTargetInfo($B½ïß‡½¤‰); $aÚ®ƒƒŸÊã[$dªÙµ¦Ì¥™[495]] = rtrim($aÚ®ƒƒŸÊã[$dªÙµ¦Ì¥™[490]], $dªÙµ¦Ì¥™[8]) . $dªÙµ¦Ì¥™[8] . ltrim($aÚ®ƒƒŸÊã[$dªÙµ¦Ì¥™[495]], $dªÙµ¦Ì¥™[8]); $AªÔÜ¨‹™[] = $aÚ®ƒƒŸÊã; goto a¾õ„µ¾Ú; d­˜ˆ«¦š: unset($aÚ®ƒƒŸÊã[$dªÙµ¦Ì¥™[434]]); unset($aÚ®ƒƒŸÊã[$dªÙµ¦Ì¥™[432]]); unset($aÚ®ƒƒŸÊã[$dªÙµ¦Ì¥™[406]]); goto A¯‹È‡Áß; eõ¿¡Ï·ÔÔ: } goto EÏÔ”ß…†ê; EÏÔ”ß…†ê: array_multisort($bš ¿·¿³‚, SORT_ASC, $AªÔÜ¨‹™); return $AªÔÜ¨‹™; goto fÎù‹Ş”Â; fÎù‹Ş”Â: } private function groupChidldAllRootSource($DŒÉ¾Ğö¿) { $eÇ¯£êˆŠé =& $_SERVER[¬¦ã¾]; $eÖóƒç—æØ = Model($eÇ¯£êˆŠé[1860])->groupChildrenAll($DŒÉ¾Ğö¿); $AË”øö›’Ó = array($eÇ¯£êˆŠé[478] => 0, $eÇ¯£êˆŠé[484] => array($eÇ¯£êˆŠé[7], $eÖóƒç—æØ), $eÇ¯£êˆŠé[404] => SourceModel::TYPE_GROUP); $BìºŒ°¹² = Model($eÇ¯£êˆŠé[782])->field($eÇ¯£êˆŠé[395])->where($AË”øö›’Ó)->select(); $BìºŒ°¹² = array_to_keyvalue($BìºŒ°¹², $eÇ¯£êˆŠé[33], $eÇ¯£êˆŠé[395]); return $BìºŒ°¹²; } private function authTargetInfo($C™·Ñƒ¤) { goto bÕƒ¬°×»‘; C·Š¬’¨: $Bö²“«ùîî = 2 << 25; foreach ($C™·Ñƒ¤ as $BÄ ºš‚˜) { goto AÊ÷ÍùìŒš; F˜ä¯ Èö‡: $A÷×¨›ª£º = 0; if ($BÄ ºš‚˜[$dÚÁİŒòô‹[404]] == SourceModel::TYPE_GROUP) { $A÷×¨›ª£º = $Bö²“«ùîî * 2; } if ($BÄ ºš‚˜[$dÚÁİŒòô‹[404]] == SourceModel::TYPE_USER) { $A÷×¨›ª£º = $Bö²“«ùîî; } goto EôŒº¤å›; EôŒº¤å›: if ($BÄ ºš‚˜[$dÚÁİŒòô‹[404]] == SourceModel::TYPE_USER && $BÄ ºš‚˜[$dÚÁİŒòô‹[484]] == $dÚÁİŒòô‹[191]) { $A÷×¨›ª£º = 0; } $B¸õˆĞ¬ø¬[] = $e†›À×¢¶î[$dÚÁİŒòô‹[406]] + $A÷×¨›ª£º; goto A‡ê÷¿›Š; AÊ÷ÍùìŒš: $e†›À×¢¶î = Model($dÚÁİŒòô‹[1855])->listData($BÄ ºš‚˜[$dÚÁİŒòô‹[1783]]); if (!$e†›À×¢¶î) { continue; } if ($BÄ ºš‚˜[$dÚÁİŒòô‹[404]] == SourceModel::TYPE_USER) { $cğ‘ã¾åÌ— = Model($dÚÁİŒòô‹[502])->getInfoSimpleOuter($BÄ ºš‚˜[$dÚÁİŒòô‹[484]]); if ($cğ‘ã¾åÌ—[$dÚÁİŒòô‹[1520]] == $dÚÁİŒòô‹[1076]) { continue; } if ($cğ‘ã¾åÌ—[$dÚÁİŒòô‹[1520]] == $dÚÁİŒòô‹[191]) { $cğ‘ã¾åÌ—[$dÚÁİŒòô‹[28]] = LNG($dÚÁİŒòô‹[1861]); } } else { $cğ‘ã¾åÌ— = Model($dÚÁİŒòô‹[486])->getInfoSimple($BÄ ºš‚˜[$dÚÁİŒòô‹[484]]); } goto b†ÌæÚë¯; b†ÌæÚë¯: if (!$cğ‘ã¾åÌ—) { continue; } $cğ‘ã¾åÌ—[$dÚÁİŒòô‹[446]] = $e†›À×¢¶î; $a°†—¿‚ÊÅ[] = $cğ‘ã¾åÌ—; goto F˜ä¯ Èö‡; A‡ê÷¿›Š: } array_multisort($B¸õˆĞ¬ø¬, SORT_DESC, $a°†—¿‚ÊÅ); goto bâõŠœÂ£ˆ; bâõŠœÂ£ˆ: return $a°†—¿‚ÊÅ; goto C†Â­Æî´»; bÕƒ¬°×»‘: $dÚÁİŒòô‹ =& $_SERVER[¬¦ã¾]; $a°†—¿‚ÊÅ = array(); $B¸õˆĞ¬ø¬ = array(); goto C·Š¬’¨; C†Â­Æî´»: } public function getAllChildrenByUser($b†¦²“¥¾, $A†ôÚîèÀ±) { goto F‚õ÷««ä´; e×à±Ìö½: foreach ($cÑ§ô±×áÃ as $c”ÖæéÁÅØ) { $A™÷…Ü»‘± = !1; foreach ($c”ÖæéÁÅØ[$F†©«Ë¹àÂ[1859]] as $A¦Š‘¹¿‡) { if ($A¦Š‘¹¿‡[$F†©«Ë¹àÂ[1520]]) { if ($A¦Š‘¹¿‡[$F†©«Ë¹àÂ[1520]] == $A†ôÚîèÀ±) { $A™÷…Ü»‘± = !0; break; } } if ($A¦Š‘¹¿‡[$F†©«Ë¹àÂ[1688]]) { if ($this->groupContainUser($A¦Š‘¹¿‡[$F†©«Ë¹àÂ[1688]], $A†ôÚîèÀ±)) { $A™÷…Ü»‘± = !0; break; } } } if ($A™÷…Ü»‘±) { $e°Ú‹Ÿ¢Šº[] = $c”ÖæéÁÅØ; } $AøŸ­Ï³Ìô = $c”ÖæéÁÅØ[$F†©«Ë¹àÂ[395]]; if (isset($eŞÇ‹Ò”ç[$AøŸ­Ï³Ìô])) { $c”ÖæéÁÅØ[$F†©«Ë¹àÂ[1859]][] = $eŞÇ‹Ò”ç[$AøŸ­Ï³Ìô][0]; $eŞÇ‹Ò”ç[$AøŸ­Ï³Ìô] = !1; } } $eŞÇ‹Ò”ç = array_filter(array_values($eŞÇ‹Ò”ç)); $e°Ú‹Ÿ¢Šº = array_merge($eŞÇ‹Ò”ç, $e°Ú‹Ÿ¢Šº); goto C·Ô˜¢¥Ê‘; EŠç™äÏÄÆ: if ($Aƒ§Ÿ§ƒ[$F†©«Ë¹àÂ[478]] == $F†©«Ë¹àÂ[191] && $Aƒ§Ÿ§ƒ[$F†©«Ë¹àÂ[484]] != $AÓË±­õõÈ && $this->groupContainUser($Aƒ§Ÿ§ƒ[$F†©«Ë¹àÂ[484]], $A†ôÚîèÀ±)) { foreach ($EŒæİµ‚Šâ[$F†©«Ë¹àÂ[1862]] as $få»¹øµÑÑ) { $AÕÍ«ò»„ = Model($F†©«Ë¹àÂ[486])->getInfo($få»¹øµÑÑ[$F†©«Ë¹àÂ[1688]]); $cØÒ±¬ç©™ = Model($F†©«Ë¹àÂ[506])->getInfoSimpleOuter($A†ôÚîèÀ±); $cØÒ±¬ç©™[$F†©«Ë¹àÂ[446]] = $få»¹øµÑÑ[$F†©«Ë¹àÂ[406]]; if (Model($F†©«Ë¹àÂ[1855])->authCheckAction($få»¹øµÑÑ[$F†©«Ë¹àÂ[406]][$F†©«Ë¹àÂ[406]], $F†©«Ë¹àÂ[1708])) { continue; } $a·Õ¿®öáÕ = array($F†©«Ë¹àÂ[28] => $F†©«Ë¹àÂ[1473] . $AÕÍ«ò»„[$F†©«Ë¹àÂ[28]], $F†©«Ë¹àÂ[395] => $AÕÍ«ò»„[$F†©«Ë¹àÂ[85]][$F†©«Ë¹àÂ[395]], $F†©«Ë¹àÂ[76] => KodIO::make($AÕÍ«ò»„[$F†©«Ë¹àÂ[85]][$F†©«Ë¹àÂ[395]]), $F†©«Ë¹àÂ[478] => $F†©«Ë¹àÂ[191], $F†©«Ë¹àÂ[404] => $F†©«Ë¹àÂ[1006], $F†©«Ë¹àÂ[29] => $F†©«Ë¹àÂ[517], $F†©«Ë¹àÂ[495] => $AÕÍ«ò»„[$F†©«Ë¹àÂ[491]], $F†©«Ë¹àÂ[1688] => $AÕÍ«ò»„[$F†©«Ë¹àÂ[1688]], $F†©«Ë¹àÂ[488] => $AÕÍ«ò»„[$F†©«Ë¹àÂ[478]], $F†©«Ë¹àÂ[1859] => array($cØÒ±¬ç©™)); $eŞÇ‹Ò”ç[$a·Õ¿®öáÕ[$F†©«Ë¹àÂ[395]]] = $a·Õ¿®öáÕ; } } $e°Ú‹Ÿ¢Šº = array(); $cÑ§ô±×áÃ = $this->getAllChildren($b†¦²“¥¾); goto e×à±Ìö½; bºÄ™ÓÂ”³: $Aƒ§Ÿ§ƒ = Model($F†©«Ë¹àÂ[1197])->sourceInfo($b†¦²“¥¾); $eŞÇ‹Ò”ç = array(); $AÓË±­õõÈ = 1; goto EŠç™äÏÄÆ; C·Ô˜¢¥Ê‘: return $e°Ú‹Ÿ¢Šº; goto f³î›ÂÕó“; F‚õ÷««ä´: $F†©«Ë¹àÂ =& $_SERVER[¬¦ã¾]; $EŒæİµ‚Šâ = Model($F†©«Ë¹àÂ[506])->getInfo($A†ôÚîèÀ±); if (!$A†ôÚîèÀ± || !$b†¦²“¥¾ || !$EŒæİµ‚Šâ) { return array(); } goto bºÄ™ÓÂ”³; f³î›ÂÕó“: } public function setAllChildrenByUser($E¶‹Ê„ÁÍ, $f¥Ñ›ãÑÌë, $D‰‹¥ë¦ñ) { $Cö¾‹ÅÑ° =& $_SERVER[¬¦ã¾]; $C“åÉí†šº = $this->getAllChildrenByUser($E¶‹Ê„ÁÍ, $f¥Ñ›ãÑÌë); if (!$D‰‹¥ë¦ñ || !$C“åÉí†šº) { return !1; } foreach ($C“åÉí†šº as $cä›È¬Ìˆ§) { $E¯´ĞÊ…« = array(); foreach ($cä›È¬Ìˆ§[$Cö¾‹ÅÑ°[1859]] as $EµçÕÔ´Áã) { $cŒ¶Éæº¤¶ = $EµçÕÔ´Áã[$Cö¾‹ÅÑ°[446]]; $eŒâº§•¦á = $EµçÕÔ´Áã[$Cö¾‹ÅÑ°[1520]] ? SourceModel::TYPE_USER : SourceModel::TYPE_GROUP; $d”ÇÂÕçƒÁ = $EµçÕÔ´Áã[$Cö¾‹ÅÑ°[1520]] ? $EµçÕÔ´Áã[$Cö¾‹ÅÑ°[1520]] : $EµçÕÔ´Áã[$Cö¾‹ÅÑ°[1688]]; if ($EµçÕÔ´Áã[$Cö¾‹ÅÑ°[1520]] && $EµçÕÔ´Áã[$Cö¾‹ÅÑ°[1520]] == $f¥Ñ›ãÑÌë) { continue; } $E¯´ĞÊ…«[] = array($Cö¾‹ÅÑ°[395] => $cä›È¬Ìˆ§[$Cö¾‹ÅÑ°[395]], $Cö¾‹ÅÑ°[404] => $eŒâº§•¦á, $Cö¾‹ÅÑ°[484] => intval($d”ÇÂÕçƒÁ), $Cö¾‹ÅÑ°[1783] => isset($cŒ¶Éæº¤¶[$Cö¾‹ÅÑ°[393]]) ? intval($cŒ¶Éæº¤¶[$Cö¾‹ÅÑ°[393]]) : 0, $Cö¾‹ÅÑ°[1837] => isset($cŒ¶Éæº¤¶[$Cö¾‹ÅÑ°[1837]]) ? intval($cŒ¶Éæº¤¶[$Cö¾‹ÅÑ°[1837]]) : -1); } $E¯´ĞÊ…«[] = array($Cö¾‹ÅÑ°[395] => $cä›È¬Ìˆ§[$Cö¾‹ÅÑ°[395]], $Cö¾‹ÅÑ°[404] => SourceModel::TYPE_USER, $Cö¾‹ÅÑ°[484] => intval($f¥Ñ›ãÑÌë), $Cö¾‹ÅÑ°[1783] => intval($D‰‹¥ë¦ñ), $Cö¾‹ÅÑ°[1837] => -1); $this->where(array($Cö¾‹ÅÑ°[410] => $cä›È¬Ìˆ§[$Cö¾‹ÅÑ°[395]]))->delete(); $this->addAll($E¯´ĞÊ…«); } return !0; } public function get($BÃÑÄ±—‘) { $eæÛäå—ÂÚ = $this->getSourceList(array($BÃÑÄ±—‘), !0); return $eæÛäå—ÂÚ[0]; } public function getSourceList($fÄÉ£­æîª, $fœ…ôº = false, $d¢ñ£Ï‘İÈ = false) { goto BĞ¢Ù§ÚÏ†; BĞ¢Ù§ÚÏ†: $EÙ˜ë›šñÄ =& $_SERVER[¬¦ã¾]; if (!$fÄÉ£­æîª) { return array(); } $BÅ¯†¼¶ÒÙ = Model($EÙ˜ë›šñÄ[1197]); goto cùÖÙ²ã®œ; dÇñ›÷àé: $d¾ô¾«º¿ = $this->userIsRoot($d¢ñ£Ï‘İÈ); $CäĞ¢‚¦Š = AuthModel::authAll(); $Føõİµ•Ò‡ = array($EÙ˜ë›šñÄ[407] => $CäĞ¢‚¦Š, $EÙ˜ë›šñÄ[1864] => array($EÙ˜ë›šñÄ[412] => 0, $EÙ˜ë›šñÄ[1694] => $CäĞ¢‚¦Š, $EÙ˜ë›šñÄ[413] => LNG($EÙ˜ë›šñÄ[1865]), $EÙ˜ë›šñÄ[1709] => $EÙ˜ë›šñÄ[1866])); goto F®Ä‰’ñ; fÁ £ƒäßì: $F‹ğğŠ®÷Š = $this->sourceAuthSelect($bÓˆÛÚº‡); $Fï“ŒÉµ… = array(); foreach ($bÓˆÛÚº‡ as $f„İ¹Êªº) { if (isset($F‹ğğŠ®÷Š[$f„İ¹Êªº])) { $Fï“ŒÉµ…[$f„İ¹Êªº] = $F‹ğğŠ®÷Š[$f„İ¹Êªº]; } } goto dÇñ›÷àé; cùÖÙ²ã®œ: if (!$fœ…ôº && count($fÄÉ£­æîª) == 1) { $fœ…ôº = array(); $fœ…ôº[$fÄÉ£­æîª[0]] = $BÅ¯†¼¶ÒÙ->sourceInfo($fÄÉ£­æîª[0]); } if (!$fœ…ôº) { $Fï¢·µ•—Ã = array($EÙ˜ë›šñÄ[410] => array($EÙ˜ë›šñÄ[411], $fÄÉ£­æîª)); $fœ…ôº = $BÅ¯†¼¶ÒÙ->field($EÙ˜ë›šñÄ[1863])->where($Fï¢·µ•—Ã)->select(); $fœ…ôº = array_to_keyvalue($fœ…ôº, $EÙ˜ë›šñÄ[395]); } $bÓˆÛÚº‡ = $fÄÉ£­æîª; goto féŞ²î…¶; féŞ²î…¶: foreach ($fœ…ôº as $bñŞğ“ï˜ => $eŠæ©°·ù) { $c·ºÎµ‚¥´ = $BÅ¯†¼¶ÒÙ->parentLevelArray($eŠæ©°·ù[$EÙ˜ë›šñÄ[487]]); $bÓˆÛÚº‡ = array_merge($bÓˆÛÚº‡, array($bñŞğ“ï˜), array_reverse($c·ºÎµ‚¥´)); } $bÓˆÛÚº‡ = array_values(array_unique($bÓˆÛÚº‡)); if (!$bÓˆÛÚº‡) { return array(); } goto fÁ £ƒäßì; F®Ä‰’ñ: $Cİç ¥‰ÙÁ = array(); foreach ($fœ…ôº as $f„İ¹Êªº => $FÎ®ÓŠ¶Û) { if ($d¾ô¾«º¿) { $Cİç ¥‰ÙÁ[$f„İ¹Êªº] = $Føõİµ•Ò‡; continue; } $Cİç ¥‰ÙÁ[$f„İ¹Êªº] = $this->makeSourceAuth($FÎ®ÓŠ¶Û, $Fï“ŒÉµ…, $d¢ñ£Ï‘İÈ); } return $Cİç ¥‰ÙÁ; goto dòÇ´½å‚ë; dòÇ´½å‚ë: } public function authDeepCheck($F´²ƒ”Õ·, $eÉ³›ù¢‡ = false) { goto CƒÍ–Œ·ËÛ; CÖ¦™âË: if (!$cÄÓ´™Š™ï) { return !1; } $aŒ¤¯ª “ = $cÄÓ´™Š™ï ? $cÄÓ´™Š™ï[0] : $F´²ƒ”Õ·; return array($eó±š™ëŞ¹[407] => -1, $eó±š™ëŞ¹[446] => array($eó±š™ëŞ¹[412] => $eó±š™ëŞ¹[1076], $eó±š™ëŞ¹[1694] => $eó±š™ëŞ¹[191], $eó±š™ëŞ¹[413] => LNG($eó±š™ëŞ¹[1869]), $eó±š™ëŞ¹[1709] => $eó±š™ëŞ¹[1870]), $eó±š™ëŞ¹[1871] => LNG($eó±š™ëŞ¹[1872]), $eó±š™ëŞ¹[1873] => $this->sourceAuthInfo($aŒ¤¯ª “)); goto f£¨ñ§ò‡à; CƒÍ–Œ·ËÛ: $eó±š™ëŞ¹ =& $_SERVER[¬¦ã¾]; $eÉ³›ù¢‡ = $eÉ³›ù¢‡ ? $eÉ³›ù¢‡ : USER_ID; $B†½í©ªæÈ = $this->makeAuthDeep($eÉ³›ù¢‡); goto B­é“õ£„ ; B­é“õ£„ : if (!in_array($F´²ƒ”Õ·, $B†½í©ªæÈ[$eó±š™ëŞ¹[1867]])) { return !1; } $cÄÓ´™Š™ï = array(); foreach ($B†½í©ªæÈ[$eó±š™ëŞ¹[1868]] as $c“ì´çĞ—Ÿ => $C…¾²×à¦å) { if (!in_array($F´²ƒ”Õ·, $C…¾²×à¦å)) { continue; } $cÄÓ´™Š™ï[] = $c“ì´çĞ—Ÿ; } goto CÖ¦™âË; f£¨ñ§ò‡à: } protected function makeAuthDeep($F‰˜Í¤ªĞù = false) { goto cÆÉ¦ŠŞéõ; bİµÉ§îÍ: foreach ($A³‘ß–½õ as $E–äØì¦ŠØ) { $D£‚ŠÅ££ = $eÌ…˜Íßì->getInfo($E–äØì¦ŠØ); $A‚Œ…øÀŒ…[] = $D£‚ŠÅ££[$b…Õ·ğ„ò®[85]][$b…Õ·ğ„ò®[395]]; $dŠĞ°ÛÏÄ[$E–äØì¦ŠØ] = $D£‚ŠÅ££[$b…Õ·ğ„ò®[85]][$b…Õ·ğ„ò®[395]]; $Cùƒ“Æê°[$E–äØì¦ŠØ] = $BÂõËñ¹áš->parentLevelArray($D£‚ŠÅ££[$b…Õ·ğ„ò®[487]]); } foreach ($E÷ƒ¼Â¦Ş as $bçÅ¶††Å™ => $Cß‡²¡ñã) { $e×å¶«ˆ‡ = $BïÚ‹”ĞÓ[$bçÅ¶††Å™]; if (!$e×å¶«ˆ‡ || !$dŠĞ°ÛÏÄ[$e×å¶«ˆ‡]) { continue; } $Bß¦õ˜‚ğ = array(); foreach ($Cùƒ“Æê°[$e×å¶«ˆ‡] as $E–äØì¦ŠØ) { $Bß¦õ˜‚ğ[] = $dŠĞ°ÛÏÄ[$E–äØì¦ŠØ]; } $E÷ƒ¼Â¦Ş[$bçÅ¶††Å™] = array_merge($Bß¦õ˜‚ğ, $Cß‡²¡ñã); } $A‚Œ…øÀŒ… = array_values(array_unique($A‚Œ…øÀŒ…)); goto e¾«ÈËØÂÁ; DÎÃæÂİá×: foreach ($dÈƒŸÕæÚ¸ as $eÓĞÀ‰ Ô) { if ($eÓĞÀ‰ Ô[$b…Õ·ğ„ò®[406]] == 0 && $eÓĞÀ‰ Ô[$b…Õ·ğ„ò®[1710]] == $b…Õ·ğ„ò®[87]) { $aŞòŒ†è–ó[] = $eÓĞÀ‰ Ô[$b…Õ·ğ„ò®[393]]; } } $cŒ¨ò‘ˆ¸¸ = $this->userGroupParents($F‰˜Í¤ªĞù); $b÷à‚»‡Œİ = array($b…Õ·ğ„ò®[404] => SourceModel::TYPE_USER, $b…Õ·ğ„ò®[484] => $F‰˜Í¤ªĞù); goto dÆä¬‰ê‚Ñ; dÆä¬‰ê‚Ñ: if ($cŒ¨ò‘ˆ¸¸) { $b÷à‚»‡Œİ = array(array($b…Õ·ğ„ò®[404] => SourceModel::TYPE_USER, $b…Õ·ğ„ò®[484] => $F‰˜Í¤ªĞù), array($b…Õ·ğ„ò®[404] => SourceModel::TYPE_GROUP, $b…Õ·ğ„ò®[484] => array($b…Õ·ğ„ò®[411], $cŒ¨ò‘ˆ¸¸)), $b…Õ·ğ„ò®[948] => $b…Õ·ğ„ò®[1775]); } $då”™Ûºé„ = $this->field($b…Õ·ğ„ò®[1875])->where($b÷à‚»‡Œİ)->select(); $c¡ªª»–Æ± = array(); goto bÖİÆ‡‰ñ; Fù„ÌäÈÀ: $A³‘ß–½õ = $cŒ¨ò‘ˆ¸¸; $BÂõËñ¹áš = Model($b…Õ·ğ„ò®[1197]); $eÌ…˜Íßì = Model($b…Õ·ğ„ò®[486]); goto C„„ªÜ¥¶; bÖİÆ‡‰ñ: $c–¤­“‘åÚ = array_to_keyvalue_group($då”™Ûºé„, $b…Õ·ğ„ò®[395]); foreach ($c–¤­“‘åÚ as $A Éàêä¦¨ => $eÄÙ°Î¹‡) { $A¶¥æõÁö’ = $this->authArrayCheck($eÄÙ°Î¹‡, $F‰˜Í¤ªĞù); if ($A¶¥æõÁö’[$b…Õ·ğ„ò®[407]] > 0) { $c¡ªª»–Æ±[] = $A Éàêä¦¨ . $b…Õ·ğ„ò®[33]; } } $A‚Œ…øÀŒ… = array(); goto Fù„ÌäÈÀ; d¡¡İÂ†½ª: $Cùƒ“Æê° = array(); if ($c¡ªª»–Æ±) { $Aò‘î¿÷ò = $BÂõËñ¹áš->where(array($b…Õ·ğ„ò®[395] => array($b…Õ·ğ„ò®[411], $c¡ªª»–Æ±)))->select(); foreach ($Aò‘î¿÷ò as $EÛ•ßÓ—™Æ) { $Eñ»Ş¿È˜ø = $BÂõËñ¹áš->parentLevelArray($EÛ•ßÓ—™Æ[$b…Õ·ğ„ò®[487]]); $A‚Œ…øÀŒ… = array_merge($A‚Œ…øÀŒ…, $Eñ»Ş¿È˜ø); $A³‘ß–½õ[] = $EÛ•ßÓ—™Æ[$b…Õ·ğ„ò®[484]]; $E÷ƒ¼Â¦Ş[$EÛ•ßÓ—™Æ[$b…Õ·ğ„ò®[395]]] = $Eñ»Ş¿È˜ø; $BïÚ‹”ĞÓ[$EÛ•ßÓ—™Æ[$b…Õ·ğ„ò®[395]]] = $EÛ•ßÓ—™Æ[$b…Õ·ğ„ò®[484]]; } } $A³‘ß–½õ = array_values(array_unique($A³‘ß–½õ)); goto A›Ş·•±Œ; cÆÉ¦ŠŞéõ: $b…Õ·ğ„ò® =& $_SERVER[¬¦ã¾]; static $aÓÍ³Î¾Œ = array(); $F‰˜Í¤ªĞù = $F‰˜Í¤ªĞù ? $F‰˜Í¤ªĞù : USER_ID; goto F˜†Î«„‰ˆ; A›Ş·•±Œ: $D‰Šèã§§ = $A³‘ß–½õ; foreach ($D‰Šèã§§ as $E–äØì¦ŠØ) { $D£‚ŠÅ££ = $eÌ…˜Íßì->getInfo($E–äØì¦ŠØ); $Eñ»Ş¿È˜ø = $BÂõËñ¹áš->parentLevelArray($D£‚ŠÅ££[$b…Õ·ğ„ò®[487]]); $A³‘ß–½õ = array_merge($A³‘ß–½õ, $Eñ»Ş¿È˜ø); } $A³‘ß–½õ = array_values(array_unique($A³‘ß–½õ)); goto bİµÉ§îÍ; e¾«ÈËØÂÁ: $eµ…ÂÚ’§ = array($b…Õ·ğ„ò®[1867] => $A‚Œ…øÀŒ…, $b…Õ·ğ„ò®[1868] => $E÷ƒ¼Â¦Ş); $aÓÍ³Î¾Œ[$F‰˜Í¤ªĞù] = $eµ…ÂÚ’§; return $eµ…ÂÚ’§; goto C‹ª÷”ğ; F˜†Î«„‰ˆ: if (isset($aÓÍ³Î¾Œ[$F‰˜Í¤ªĞù])) { return $aÓÍ³Î¾Œ[$F‰˜Í¤ªĞù]; } $dÈƒŸÕæÚ¸ = Model($b…Õ·ğ„ò®[1874])->listData(); $aŞòŒ†è–ó = array(); goto DÎÃæÂİá×; C„„ªÜ¥¶: $E÷ƒ¼Â¦Ş = array(); $BïÚ‹”ĞÓ = array(); $dŠĞ°ÛÏÄ = array(); goto d¡¡İÂ†½ª; C‹ª÷”ğ: } private function makeSourceAuth($bÕÆÁÅåÈÆ, $cÖóƒêŸ´Ğ, $C‹ÄêòĞ÷ = false) { goto AŠÑÜ×™ÒÜ; d¼¾¦ËÍö: $Aïô•‹Ë«ï = $bÕÆÁÅåÈÆ[$bäÒÎôÅÃ[404]] == SourceModel::TYPE_GROUP; $A±ô´šø‚ = $Aïô•‹Ë«ï ? $this->groupRootAuth($C‚Â©Œİ¼ã, $C‹ÄêòĞ÷) : !1; if ($A±ô´šø‚ && Model($bäÒÎôÅÃ[1855])->authCheckAction($A±ô´šø‚[$bäÒÎôÅÃ[406]], $bäÒÎôÅÃ[1708])) { return $this->groupAuthInfo($A±ô´šø‚, $C‚Â©Œİ¼ã); } goto cÒò¿×°¹; cÒò¿×°¹: $díËŠ†Æ™ = Model($bäÒÎôÅÃ[1197])->parentLevelArray($bÕÆÁÅåÈÆ[$bäÒÎôÅÃ[487]]); $díËŠ†Æ™ = array_merge(array($bÕÆÁÅåÈÆ[$bäÒÎôÅÃ[395]]), array_reverse($díËŠ†Æ™)); $bä™“ŞÈ¾® = !1; goto cÍĞˆç„è¼; AŠÑÜ×™ÒÜ: $bäÒÎôÅÃ =& $_SERVER[¬¦ã¾]; $C ’‚Ó«æ = $bäÒÎôÅÃ[87]; $C‚Â©Œİ¼ã = $bÕÆÁÅåÈÆ[$bäÒÎôÅÃ[484]]; goto d¼¾¦ËÍö; cÍĞˆç„è¼: foreach ($díËŠ†Æ™ as $C”ÅÙÃ©«ø) { if (!isset($cÖóƒêŸ´Ğ[$C”ÅÙÃ©«ø])) { continue; } $Fˆ¾Ò¤ùÍ = $this->authMake($cÖóƒêŸ´Ğ[$C”ÅÙÃ©«ø], $C‹ÄêòĞ÷); if ($Fˆ¾Ò¤ùÍ[$bäÒÎôÅÃ[446]]) { $bä™“ŞÈ¾® = $Fˆ¾Ò¤ùÍ; break; } } if (!$Aïô•‹Ë«ï) { return $bä™“ŞÈ¾®; } if (!$bä™“ŞÈ¾® && $A±ô´šø‚) { $bä™“ŞÈ¾® = $this->groupAuthInfo($A±ô´šø‚, $C‚Â©Œİ¼ã); } goto eòÓÌºóˆì; eòÓÌºóˆì: if (!$bä™“ŞÈ¾®) { $C’——ëµæ¦ = Model($bäÒÎôÅÃ[486])->getInfo($C‚Â©Œİ¼ã); $bƒ˜Ñğùİó = explode($bäÒÎôÅÃ[47], trim($C’——ëµæ¦[$bäÒÎôÅÃ[487]], $bäÒÎôÅÃ[47])); $bƒ˜Ñğùİó = array_reverse($bƒ˜Ñğùİó); foreach ($bƒ˜Ñğùİó as $BåˆøªÊ¨Æ) { if ($BåˆøªÊ¨Æ == $bäÒÎôÅÃ[191] || $BåˆøªÊ¨Æ == $C ’‚Ó«æ) { continue; } $Cİëò«½„° = $this->groupRootAuth($BåˆøªÊ¨Æ, $C‹ÄêòĞ÷); if (!$Cİëò«½„°) { continue; } $bä™“ŞÈ¾® = $this->groupAuthInfo($Cİëò«½„°, $BåˆøªÊ¨Æ); break; } } if (!$bä™“ŞÈ¾® || $bä™“ŞÈ¾®[$bäÒÎôÅÃ[407]] <= 0) { $cÎùÃ‘Ÿçá = $this->authDeepCheck($bÕÆÁÅåÈÆ[$bäÒÎôÅÃ[395]], $C‹ÄêòĞ÷); if ($cÎùÃ‘Ÿçá) { $bä™“ŞÈ¾® = $cÎùÃ‘Ÿçá; } } return $bä™“ŞÈ¾®; goto AÙÛÑš¶¡; AÙÛÑš¶¡: } private function userIsRoot($e‰ğæß‘õâ = false) { $FˆĞòòƒƒˆ =& $_SERVER[¬¦ã¾]; if (!$e‰ğæß‘õâ && _get($GLOBALS, $FˆĞòòƒƒˆ[485])) { return !0; } $fŠâ¨ø¡Š = Model($FˆĞòòƒƒˆ[506])->getInfo($e‰ğæß‘õâ); $e§«½Í¤÷ = Model($FˆĞòòƒƒˆ[1876])->listData($fŠâ¨ø¡Š[$FˆĞòòƒƒˆ[1405]]); if ($e§«½Í¤÷ && $e§«½Í¤÷[$FˆĞòòƒƒˆ[1274]][$FˆĞòòƒƒˆ[1877]] == 1) { return !0; } return !1; } private function sourceAuthInfo($b¼ïÈì§à¾) { goto A°Ú°ß‘·•; E“à˜Š²åß: if (!$Fçµ§«Ìç‡) { return !1; } $b˜¹Ç…óÙ–->groupPathDisplay($Fçµ§«Ìç‡); $f”ˆà‘†Ç = array($Fçµ§«Ìç‡); goto bù°ÄÄë¹·; A°Ú°ß‘·•: $fêæÏñğº =& $_SERVER[¬¦ã¾]; $b˜¹Ç…óÙ– = Model($fêæÏñğº[1197]); $Fçµ§«Ìç‡ = $b˜¹Ç…óÙ–->sourceInfo($b¼ïÈì§à¾); goto E“à˜Š²åß; bù°ÄÄë¹·: $f”ˆà‘†Ç = $b˜¹Ç…óÙ–->_listAppendPath($f”ˆà‘†Ç); $Fçµ§«Ìç‡ = $f”ˆà‘†Ç[0]; $Aï‰ÓğÑëß = $Fçµ§«Ìç‡[$fêæÏñğº[495]]; goto d´Ï¼Õ‚Å; d´Ï¼Õ‚Å: if (isset($Fçµ§«Ìç‡[$fêæÏñğº[492]])) { $FëÜ”Å¥å¬ = explode($fêæÏñğº[8], trim($Fçµ§«Ìç‡[$fêæÏñğº[495]], $fêæÏñğº[8])); array_shift($FëÜ”Å¥å¬); $Aï‰ÓğÑëß = $Fçµ§«Ìç‡[$fêæÏñğº[490]] . $fêæÏñğº[1878] . implode($fêæÏñğº[8], $FëÜ”Å¥å¬); } return array($fêæÏñğº[413] => $Fçµ§«Ìç‡[$fêæÏñğº[28]], $fêæÏñğº[76] => KodIO::make($Fçµ§«Ìç‡[$fêæÏñğº[395]]), $fêæÏñğº[1879] => $Aï‰ÓğÑëß); goto EÀéÉçÒê; EÀéÉçÒê: } private function groupAuthInfo($fÖœê‹Üğ—, $Eß²Õ¿ò¦) { $D›‘´ÌšÎÜ =& $_SERVER[¬¦ã¾]; $BÃ…‡è‘™© = Model($D›‘´ÌšÎÜ[486])->getInfo($Eß²Õ¿ò¦); return array($D›‘´ÌšÎÜ[1880] => intval($fÖœê‹Üğ—[$D›‘´ÌšÎÜ[406]]), $D›‘´ÌšÎÜ[1864] => $fÖœê‹Üğ—, $D›‘´ÌšÎÜ[1881] => LNG($D›‘´ÌšÎÜ[1882]), $D›‘´ÌšÎÜ[1873] => array($D›‘´ÌšÎÜ[413] => $BÃ…‡è‘™©[$D›‘´ÌšÎÜ[28]], $D›‘´ÌšÎÜ[76] => KodIO::make($BÃ…‡è‘™©[$D›‘´ÌšÎÜ[85]][$D›‘´ÌšÎÜ[395]]), $D›‘´ÌšÎÜ[1879] => $BÃ…‡è‘™©[$D›‘´ÌšÎÜ[491]])); } protected function groupRootAuth($DÑñÎÈİáÂ, $CÃÄšƒéæ = false) { goto dÁòÅ³ïÈ; dÁòÅ³ïÈ: $e½“ààâñ =& $_SERVER[¬¦ã¾]; $CÃÄšƒéæ = $CÃÄšƒéæ ? $CÃÄšƒéæ : USER_ID; $E×ª‹Ç˜… = $CÃÄšƒéæ . $e½“ààâñ[1883] . $DÑñÎÈİáÂ; goto eãĞÅ÷Ú¾³; cµ†ÅšöÙ‡: $bóÊ´ÕÏÇÃ[$E×ª‹Ç˜…] = $fÈ»ê®÷Âí ? $fÈ»ê®÷Âí : $CˆîÙó÷àí; return $bóÊ´ÕÏÇÃ[$E×ª‹Ç˜…]; goto EË³ˆö­ê; b–Ó¨À¨¶ß: $DËò±Ä©İ§ = $this->userGroupList($CÃÄšƒéæ); $CˆîÙó÷àí = isset($DËò±Ä©İ§[$DÑñÎÈİáÂ]) ? $DËò±Ä©İ§[$DÑñÎÈİáÂ][$e½“ààâñ[406]] : !1; if ($CˆîÙó÷àí && Model($e½“ààâñ[1855])->authCheckAction($CˆîÙó÷àí[$e½“ààâñ[406]], $e½“ààâñ[1708])) { $bóÊ´ÕÏÇÃ[$E×ª‹Ç˜…] = $CˆîÙó÷àí; return $CˆîÙó÷àí; } goto cÓçóêç‹; eãĞÅ÷Ú¾³: static $bóÊ´ÕÏÇÃ = array(); if (isset($bóÊ´ÕÏÇÃ[$E×ª‹Ç˜…])) { return $bóÊ´ÕÏÇÃ[$E×ª‹Ç˜…]; } $c¼½ôÌ¯ğ— = Model($e½“ààâñ[486])->getInfo($DÑñÎÈİáÂ); goto b–Ó¨À¨¶ß; cÓçóêç‹: $C‚ˆ¾¢òÆé = $this->sourceAuthSelect($c¼½ôÌ¯ğ—[$e½“ààâñ[85]][$e½“ààâñ[395]]); $FÌ¦Ûİƒ­ = $C‚ˆ¾¢òÆé ? $this->authMake($C‚ˆ¾¢òÆé, $CÃÄšƒéæ) : !1; $fÈ»ê®÷Âí = $FÌ¦Ûİƒ­ ? $FÌ¦Ûİƒ­[$e½“ààâñ[446]] : !1; goto cµ†ÅšöÙ‡; EË³ˆö­ê: } public function authOwnerApply($A¶’ªÄÙÙ) { goto eàò×µê²; f£Š¥Ô¿Şñ: $a¥À«õÑÎ¶ = array(); $D©»ÏÏ«º = array(); foreach ($bŠ’«òæ† as $c„ÚÅ”šÆ£ => $AºŠÇíÌç˜) { $Dç¬–êØŒ = $this->authFolderOwnerUser($AºŠÇíÌç˜); $a¥À«õÑÎ¶[$c„ÚÅ”šÆ£] = $Dç¬–êØŒ; $D©»ÏÏ«º = array_merge($D©»ÏÏ«º, $Dç¬–êØŒ[$D¶‡¸‚„ìâ[562]]); if ($Dç¬–êØŒ[$D¶‡¸‚„ìâ[1885]]) { break; } } goto c–•ÃÓï‡ù; F½Æ¼‰½Ÿ“: $A¶’ªÄÙÙ[$D¶‡¸‚„ìâ[406]][$D¶‡¸‚„ìâ[1886]] = Model($D¶‡¸‚„ìâ[502])->userListInfo($D©»ÏÏ«º); return $A¶’ªÄÙÙ; goto bò¨¬áôË; c–•ÃÓï‡ù: if (count($D©»ÏÏ«º) == 0) { $D©»ÏÏ«º = $this->authFolderOwnerGroup($A¶’ªÄÙÙ[$D¶‡¸‚„ìâ[484]]); } $D©»ÏÏ«º = array_unique($D©»ÏÏ«º); if (AuthModel::authCheckRoot($A¶’ªÄÙÙ[$D¶‡¸‚„ìâ[406]][$D¶‡¸‚„ìâ[407]])) { $D©»ÏÏ«º[] = USER_ID; } goto F½Æ¼‰½Ÿ“; dì¬˜‘åù’: $F›ŞÜµ µß = Model($D¶‡¸‚„ìâ[1197])->parentLevelArray($A¶’ªÄÙÙ[$D¶‡¸‚„ìâ[487]]); $F›ŞÜµ µß = array_merge(array($A¶’ªÄÙÙ[$D¶‡¸‚„ìâ[395]]), array_reverse($F›ŞÜµ µß)); $bŠ’«òæ† = $this->sourceAuthSelect($F›ŞÜµ µß); goto f£Š¥Ô¿Şñ; eàò×µê²: $D¶‡¸‚„ìâ =& $_SERVER[¬¦ã¾]; if (empty($A¶’ªÄÙÙ[$D¶‡¸‚„ìâ[406]]) || isset($A¶’ªÄÙÙ[$D¶‡¸‚„ìâ[1884]]) && $A¶’ªÄÙÙ[$D¶‡¸‚„ìâ[1884]]) { return $A¶’ªÄÙÙ; } if (AuthModel::authCheckRoot($A¶’ªÄÙÙ[$D¶‡¸‚„ìâ[406]][$D¶‡¸‚„ìâ[407]])) { return $A¶’ªÄÙÙ; } goto dì¬˜‘åù’; bò¨¬áôË: } private function authFolderOwnerGroup($BÌäÛŞäÖ¤) { $D‰ŠÍæÑ›È =& $_SERVER[¬¦ã¾]; $EÀó»†‹× = Model($D‰ŠÍæÑ›È[1769])->where(array($D‰ŠÍæÑ›È[1688] => $BÌäÛŞäÖ¤))->select(); $Dãƒ¡Åî˜à = array(); if (!$EÀó»†‹×) { return $Dãƒ¡Åî˜à; } foreach ($EÀó»†‹× as $b•Åš¨ï‰«) { $c¸Š³¶ß× = $this->authInfo($b•Åš¨ï‰«); if (AuthModel::authCheckRoot($c¸Š³¶ß×[$D‰ŠÍæÑ›È[406]])) { $Dãƒ¡Åî˜à[] = $b•Åš¨ï‰«[$D‰ŠÍæÑ›È[1520]]; } } return $Dãƒ¡Åî˜à; } private function authFolderOwnerUser($f³ÌªÔÃ’ª) { $Cò…Ÿ›ÊŞ£ =& $_SERVER[¬¦ã¾]; $Bà è Ï = array(); $a¯Ğ¨¯¢ = !1; foreach ($f³ÌªÔÃ’ª as $dÈ² áŒõ§) { $c ¹Ø‹´‰¹ = $this->authInfo($dÈ² áŒõ§); if ($dÈ² áŒõ§[$Cò…Ÿ›ÊŞ£[484]] == $Cò…Ÿ›ÊŞ£[191]) { $a¯Ğ¨¯¢ = !0; } if ($dÈ² áŒõ§[$Cò…Ÿ›ÊŞ£[404]] == SourceModel::TYPE_USER) { if (AuthModel::authCheckRoot($c ¹Ø‹´‰¹[$Cò…Ÿ›ÊŞ£[406]])) { $Bà è Ï[] = $dÈ² áŒõ§[$Cò…Ÿ›ÊŞ£[484]]; } } } return array($Cò…Ÿ›ÊŞ£[562] => $Bà è Ï, $Cò…Ÿ›ÊŞ£[1885] => $a¯Ğ¨¯¢); } public function authMake($añ•Ì‹ÓÀó, $cêëƒÄÍ„ø = false) { $A§ÅÜ¹‰è =& $_SERVER[¬¦ã¾]; $aœ‡É…èÄ‹ = $this->authArrayCheck($añ•Ì‹ÓÀó, $cêëƒÄÍ„ø); if ($aœ‡É…èÄ‹[$A§ÅÜ¹‰è[1887]]) { $aœ‡É…èÄ‹[$A§ÅÜ¹‰è[1887]] = $this->sourceAuthInfo($aœ‡É…èÄ‹[$A§ÅÜ¹‰è[1887]]); } return $aœ‡É…èÄ‹; } public function authArrayCheck($B¹ãÊ«åß, $b²Á¢™Š•¡ = false) { goto AÅ¥øÒ«ß‘; AÅ¥øÒ«ß‘: $F”ö´Îùç =& $_SERVER[¬¦ã¾]; if (!$B¹ãÊ«åß) { return array($F”ö´Îùç[407] => 0, $F”ö´Îùç[446] => !1); } $b²Á¢™Š•¡ = $b²Á¢™Š•¡ ? $b²Á¢™Š•¡ : USER_ID; goto däÙß‹˜êš; E”²Éä½¶ì: $bƒ¼ë‡÷Ã = 0; $b†§ÎÅñ“‰ = 0; $BƒõëÖõ§ = 0; goto d ˜Äé×¯à; f‰é ŸËÄ: foreach ($B¹ãÊ«åß as $cõÊÊÎšİ) { $BöÏğ„µ“Ş = $this->authInfo($cõÊÊÎšİ); if (!$BöÏğ„µ“Ş) { continue; } $d÷¸•îòİ = $cõÊÊÎšİ[$F”ö´Îùç[484]]; $E®àì‚Å¯¸ = intval($BöÏğ„µ“Ş[$F”ö´Îùç[406]]); if ($cõÊÊÎšİ[$F”ö´Îùç[404]] == SourceModel::TYPE_USER && $d÷¸•îòİ == $b²Á¢™Š•¡) { $F•…ßŸ½¾ = !0; $FÎï§íĞŞ = $BöÏğ„µ“Ş; $d“‡‰–†®ë = $E®àì‚Å¯¸; } else { if ($cõÊÊÎšİ[$F”ö´Îùç[404]] == SourceModel::TYPE_GROUP && $this->groupContainUser($d÷¸•îòİ, $b²Á¢™Š•¡)) { $bƒ¼ë‡÷Ã = !0; $AÕä–ãù·é = $this->groupStepToUserGroup($d÷¸•îòİ, $b²Á¢™Š•¡); if ($AÕä–ãù·é < $e½¾Æ’™¸Õ) { $e½¾Æ’™¸Õ = $AÕä–ãù·é; $b†§ÎÅñ“‰ = $E®àì‚Å¯¸; $BƒõëÖõ§ = $BöÏğ„µ“Ş; $dÕÈ×‰¤ï = $d÷¸•îòİ; } if ($AÕä–ãù·é == $e½¾Æ’™¸Õ && $E®àì‚Å¯¸ >= $b†§ÎÅñ“‰) { $b†§ÎÅñ“‰ = $E®àì‚Å¯¸; $BƒõëÖõ§ = $BöÏğ„µ“Ş; $dÕÈ×‰¤ï = $d÷¸•îòİ; } } else { if ($d÷¸•îòİ == $F”ö´Îùç[191]) { $D„š °¨¢ = !0; $dÒô—Ïó›Ó = $BöÏğ„µ“Ş; $C‡… £µ‡« = $E®àì‚Å¯¸; } } } } if ($F•…ßŸ½¾) { $fó®ÌØ ¼ñ = $d“‡‰–†®ë; $BöÏğ„µ“Ş = $FÎï§íĞŞ; $F°éë•İ•¹ = LNG($F”ö´Îùç[1888]); } else { if ($bƒ¼ë‡÷Ã) { $fó®ÌØ ¼ñ = $b†§ÎÅñ“‰; $BöÏğ„µ“Ş = $BƒõëÖõ§; $fºæÑ«‡âÒ = Model($F”ö´Îùç[486])->getInfo($dÕÈ×‰¤ï); $F°éë•İ•¹ = $F”ö´Îùç[160] . $fºæÑ«‡âÒ[$F”ö´Îùç[491]] . $F”ö´Îùç[1889] . LNG($F”ö´Îùç[1890]); } else { if ($D„š °¨¢) { $fó®ÌØ ¼ñ = $C‡… £µ‡«; $BöÏğ„µ“Ş = $dÒô—Ïó›Ó; $F°éë•İ•¹ = LNG($F”ö´Îùç[1861]); } else { $fó®ÌØ ¼ñ = 0; $BöÏğ„µ“Ş = !1; $F°éë•İ•¹ = $F”ö´Îùç[33]; } } } $a»Ô±º·È = array($F”ö´Îùç[1880] => intval($fó®ÌØ ¼ñ), $F”ö´Îùç[1864] => $BöÏğ„µ“Ş, $F”ö´Îùç[1881] => $F°éë•İ•¹, $F”ö´Îùç[1873] => $cõÊÊÎšİ[$F”ö´Îùç[395]]); goto d—¢Ò¿‡Îâ; d ˜Äé×¯à: $e½¾Æ’™¸Õ = 1000; $dÕÈ×‰¤ï = 0; $D„š °¨¢ = 0; goto BÆµ‹¶‰†; däÙß‹˜êš: $F•…ßŸ½¾ = 0; $d“‡‰–†®ë = 0; $FÎï§íĞŞ = 0; goto E”²Éä½¶ì; d—¢Ò¿‡Îâ: return $a»Ô±º·È; goto dŒºÁÉÆª; BÆµ‹¶‰†: $C‡… £µ‡« = 0; $dÒô—Ïó›Ó = 0; $cõÊÊÎšİ = array($F”ö´Îùç[395] => 0); goto f‰é ŸËÄ; dŒºÁÉÆª: } private function groupContainUser($a¢Á„Ï‚Œµ, $bå‡Á›î£Õ = false) { return in_array($a¢Á„Ï‚Œµ, $this->userGroupParents($bå‡Á›î£Õ)); } private function groupStepToUserGroup($cÄ…–éçÅÓ, $A¯¸¯¼Ü“ = false) { goto d‘¸Éù‹Ï™; d‘¸Éù‹Ï™: $D»İËñ¯Ü =& $_SERVER[¬¦ã¾]; $FìğÀ‰ò»® = $this->userGroupList($A¯¸¯¼Ü“); $bíæäÆ¢–Â = 1000; goto EÄò‹Öç¸¤; E°”÷ì×: return $bíæäÆ¢–Â; goto AÊíëË££³; EÄò‹Öç¸¤: $a®ÔßéÍíª = $GLOBALS[$D»İËñ¯Ü[6]][$D»İËñ¯Ü[88]][$D»İËñ¯Ü[1780]] == 1; $CÔÌ¶‚âÊÍ = $a®ÔßéÍíª ? 3 : 2; foreach ($FìğÀ‰ò»® as $A‰Ëˆ¾¸‚) { if ($A‰Ëˆ¾¸‚[$D»İËñ¯Ü[1688]] == $cÄ…–éçÅÓ) { return 0; } $d¾Ëº³›°Û = explode($D»İËñ¯Ü[47], trim($A‰Ëˆ¾¸‚[$D»İËñ¯Ü[487]], $D»İËñ¯Ü[47])); if ($d¾Ëº³›°Û[0] == $D»İËñ¯Ü[191] && count($d¾Ëº³›°Û) > $CÔÌ¶‚âÊÍ) { $Fôİˆ‡—‚½ = array_reverse(array_slice($d¾Ëº³›°Û, $CÔÌ¶‚âÊÍ)); $dÛÍ‰­»ñÌ = array_search($cÄ…–éçÅÓ, $Fôİˆ‡—‚½); if ($dÛÍ‰­»ñÌ !== !1 && $dÛÍ‰­»ñÌ + 1 <= $bíæäÆ¢–Â) { $bíæäÆ¢–Â = $dÛÍ‰­»ñÌ + 1; } } } goto E°”÷ì×; AÊíëË££³: } private function userGroupList($fƒ¢ÙÁ´Ûî = false) { $dË¥Ú”Ö±˜ =& $_SERVER[¬¦ã¾]; static $FÉŸ”äë« = array(); if (isset($FÉŸ”äë«[$fƒ¢ÙÁ´Ûî])) { return $FÉŸ”äë«[$fƒ¢ÙÁ´Ûî]; } $Dô¥­ÇÔ’ä = Model($dË¥Ú”Ö±˜[506])->getInfo($fƒ¢ÙÁ´Ûî); $FÉŸ”äë«[$fƒ¢ÙÁ´Ûî] = array_to_keyvalue($Dô¥­ÇÔ’ä[$dË¥Ú”Ö±˜[1862]], $dË¥Ú”Ö±˜[1688]); return $FÉŸ”äë«[$fƒ¢ÙÁ´Ûî]; } public function userGroupParents($a­ÖÔÕâ´”) { goto Cƒå¥“í“Î; Cƒå¥“í“Î: $F©Ö—êÔ¤Ã =& $_SERVER[¬¦ã¾]; static $F¥œî¡ë· = array(); $a­ÖÔÕâ´” = $a­ÖÔÕâ´” ? $a­ÖÔÕâ´” : USER_ID; goto c¥›éàé£Í; fÀƒÛÌƒÍÜ: $F¥œî¡ë·[$a­ÖÔÕâ´”] = array_unique($A½ó™Â·²); return $F¥œî¡ë·[$a­ÖÔÕâ´”]; goto F¯ÓÎøÚ ; aåËĞ‰£ˆ: $fÉéÙ½ä½ = $GLOBALS[$F©Ö—êÔ¤Ã[6]][$F©Ö—êÔ¤Ã[88]][$F©Ö—êÔ¤Ã[1780]] == 1; $d£Ãå†î¯İ = $fÉéÙ½ä½ ? 3 : 2; foreach ($Bà‰˜Û“¶¶ as $DÜ¼§ì«) { $bŒ›†¸¦¥ = array($DÜ¼§ì«[$F©Ö—êÔ¤Ã[1688]]); $AÀ™°¾ëº× = explode($F©Ö—êÔ¤Ã[47], trim($DÜ¼§ì«[$F©Ö—êÔ¤Ã[487]], $F©Ö—êÔ¤Ã[47])); if ($AÀ™°¾ëº×[0] == $F©Ö—êÔ¤Ã[191] && count($AÀ™°¾ëº×) > $d£Ãå†î¯İ) { $DŸò«øˆ’ = array_slice($AÀ™°¾ëº×, $d£Ãå†î¯İ); $bŒ›†¸¦¥ = array_merge($bŒ›†¸¦¥, array_reverse($DŸò«øˆ’)); } $A½ó™Â·² = array_merge($A½ó™Â·², $bŒ›†¸¦¥); } goto fÀƒÛÌƒÍÜ; c¥›éàé£Í: if (isset($F¥œî¡ë·[$a­ÖÔÕâ´”])) { return $F¥œî¡ë·[$a­ÖÔÕâ´”]; } $Bà‰˜Û“¶¶ = $this->userGroupList($a­ÖÔÕâ´”); $A½ó™Â·² = array(); goto aåËĞ‰£ˆ; F¯ÓÎøÚ : } public function authTargetInfoMake($d•Â§†ÈäÈ) { goto Còîø©Ñ¼©; eìë¡À´: foreach ($d•Â§†ÈäÈ as $BäÀÔò) { if ($BäÀÔò[$AË‚£¸ÅÑ [404]] == SourceModel::TYPE_USER) { $E­øÖÜ½öø[] = intval($BäÀÔò[$AË‚£¸ÅÑ [484]]); } else { if ($BäÀÔò[$AË‚£¸ÅÑ [404]] == SourceModel::TYPE_GROUP) { $dŒŸÀ®¹”[] = intval($BäÀÔò[$AË‚£¸ÅÑ [484]]); } } } if ($E­øÖÜ½öø) { $E­øÖÜ½öø = Model($AË‚£¸ÅÑ [502])->userListInfo($E­øÖÜ½öø); } if ($dŒŸÀ®¹”) { $e²†î é´‚ = array($AË‚£¸ÅÑ [1766] => array($AË‚£¸ÅÑ [411], $dŒŸÀ®¹”)); $dŒŸÀ®¹” = Model($AË‚£¸ÅÑ [486])->field($AË‚£¸ÅÑ [1891])->where($e²†î é´‚)->select(); $dŒŸÀ®¹” = array_to_keyvalue($dŒŸÀ®¹”, $AË‚£¸ÅÑ [1688]); } goto eİÚÅŞ‰­É; Còîø©Ñ¼©: $AË‚£¸ÅÑ  =& $_SERVER[¬¦ã¾]; $E­øÖÜ½öø = array(); $dŒŸÀ®¹” = array(); goto eìë¡À´; eİÚÅŞ‰­É: return array($AË‚£¸ÅÑ [1892] => $E­øÖÜ½öø, $AË‚£¸ÅÑ [1893] => $dŒŸÀ®¹”); goto eì†ª˜÷Ğ; eì†ª˜÷Ğ: } public function authInfo($DÖ°ğ«¯°Ç) { $fŞÙØ‰—’” =& $_SERVER[¬¦ã¾]; if ($DÖ°ğ«¯°Ç[$fŞÙØ‰—’”[1783]]) { $aÙ¡ÃÈˆ± = Model($fŞÙØ‰—’”[1855])->listData($DÖ°ğ«¯°Ç[$fŞÙØ‰—’”[1783]]); if (!$aÙ¡ÃÈˆ±) { return !1; $EÉåãÖ”Ÿˆ = Model($fŞÙØ‰—’”[1855])->listData(); $Aƒç‚ãÈË” = array_filter_by_field($EÉåãÖ”Ÿˆ, $fŞÙØ‰—’”[406], $fŞÙØ‰—’”[191]); return $Aƒç‚ãÈË”; } $CçÙ½İÇÇ = array_field_key($aÙ¡ÃÈˆ±, array($fŞÙØ‰—’”[393], $fŞÙØ‰—’”[28], $fŞÙØ‰—’”[406], $fŞÙØ‰—’”[1709], $fŞÙØ‰—’”[1711])); $CçÙ½İÇÇ[$fŞÙØ‰—’”[1894]] = $DÖ°ğ«¯°Ç; return $CçÙ½İÇÇ; } else { return array($fŞÙØ‰—’”[412] => 0, $fŞÙØ‰—’”[1694] => $DÖ°ğ«¯°Ç[$fŞÙØ‰—’”[1837]], $fŞÙØ‰—’”[413] => $fŞÙØ‰—’”[33], $fŞÙØ‰—’”[1709] => $fŞÙØ‰—’”[1895]); } } } class SourceEventModel extends ModelBase { protected $tableName = "\x69\x6f\x5f\x73\x6f\165\162\x63\x65\137\x65\x76\145\156\x74"; protected $dataAuto = array(array("\143\162\145\141\x74\x65\124\x69\155\x65", "\164\151\155\x65", "\151\156\x73\x65\x72\164", "\x66\x75\x6e\x63\x74\x69\157\x6e"), array("\x64\x65\x73\x63", '', "\151\x6e\x73\x65\162\164\x2c\x75\160\x64\x61\164\x65\x2c\x73\x65\x6c\145\x63\164", "\152\163\x6f\156")); protected $eventSave = true; public function recodeStop() { $this->eventSave = !1; } public function recodeStart() { $this->eventSave = !0; } public function addEvent($f¢»¥¬Šç, $EŠÛ×·Æ, $AË˜Š¹ ñ’ = '') { goto F×°Ì¤ÒÈ; F×°Ì¤ÒÈ: $FŞËÓŒÛ =& $_SERVER[¬¦ã¾]; if (!$this->eventSave) { return; } $d‡÷÷’Õæ = Model($FŞËÓŒÛ[1197])->sourceInfo($f¢»¥¬Šç); goto f‚§Šìãµ; c‰ˆ‹éÑÇ: $cù“·¾œä’ = array($FŞËÓŒÛ[410] => $f¢»¥¬Šç, $FŞËÓŒÛ[1896] => $d‡÷÷’Õæ[$FŞËÓŒÛ[478]], $FŞËÓŒÛ[1897] => $d‡÷÷’Õæ[$FŞËÓŒÛ[28]], $FŞËÓŒÛ[495] => !empty($d‡÷÷’Õæ[$FŞËÓŒÛ[495]]) ? $d‡÷÷’Õæ[$FŞËÓŒÛ[495]] : $FŞËÓŒÛ[33], $FŞËÓŒÛ[1512] => USER_ID, $FŞËÓŒÛ[415] => $EŠÛ×·Æ, $FŞËÓŒÛ[1514] => $AË˜Š¹ ñ’); $this->addSystemLog($EŠÛ×·Æ, $cù“·¾œä’); unset($cù“·¾œä’[$FŞËÓŒÛ[1897]], $cù“·¾œä’[$FŞËÓŒÛ[495]]); goto A‹’£‚‹†¢; f‚§Šìãµ: if (!$d‡÷÷’Õæ) { return !1; } if ($this->isCacheEvent($d‡÷÷’Õæ, $EŠÛ×·Æ)) { return; } if ($AË˜Š¹ ñ’ && is_string($AË˜Š¹ ñ’)) { $AË˜Š¹ ñ’ = array($FŞËÓŒÛ[1721] => $AË˜Š¹ ñ’); } goto c‰ˆ‹éÑÇ; A‹’£‚‹†¢: return $this->add($cù“·¾œä’); goto Fš¢Ô…ğÏô; Fš¢Ô…ğÏô: } private function addSystemLog($AèÛ“×¶Œ, $dµ¦õ²Ğõ) { $AÎÈí‘ˆ¾á =& $_SERVER[¬¦ã¾]; if ($AèÛ“×¶Œ == $AÎÈí‘ˆ¾á[1898]) { $AèÛ“×¶Œ = $dµ¦õ²Ğõ[$AÎÈí‘ˆ¾á[431]][$AÎÈí‘ˆ¾á[1899]]; } else { if (in_array($AèÛ“×¶Œ, array($AÎÈí‘ˆ¾á[1665], $AÎÈí‘ˆ¾á[1900]))) { $AèÛ“×¶Œ = $dµ¦õ²Ğõ[$AÎÈí‘ˆ¾á[431]][$AÎÈí‘ˆ¾á[707]]; } } $e‰ŠÒø‹‡É = array_merge($dµ¦õ²Ğõ, array($AÎÈí‘ˆ¾á[1901] => $dµ¦õ²Ğõ[$AÎÈí‘ˆ¾á[395]], $AÎÈí‘ˆ¾á[1902] => $dµ¦õ²Ğõ[$AÎÈí‘ˆ¾á[1902]])); Model($AÎÈí‘ˆ¾á[1629])->addLog($AÎÈí‘ˆ¾á[1903] . $AèÛ“×¶Œ, $e‰ŠÒø‹‡É); } private function isCacheEvent($aíöÀ¼ÁÌ¾, $c·²ˆãí ) { if ($aíöÀ¼ÁÌ¾[$_SERVER[¬¦ã¾][404]] == SourceModel::TYPE_SYSTEM) { return !0; } return !1; } public function eventCreate($aº¼‡’êïŒ, $FœÏÈ…é) { $CŠÈêˆÜÖ =& $_SERVER[¬¦ã¾]; $F–Áö’ˆö = Model($CŠÈêˆÜÖ[1197])->sourceInfo($aº¼‡’êïŒ); $eó”âŒÕô¶ = array($CŠÈêˆÜÖ[1899] => $FœÏÈ…é, $CŠÈêˆÜÖ[28] => $F–Áö’ˆö[$CŠÈêˆÜÖ[28]]); return $this->addEvent($aº¼‡’êïŒ, $CŠÈêˆÜÖ[1898], $eó”âŒÕô¶); } public function eventFileEdit($E¨øŒ¬‰© ) { $C´ÕæŠ³ÇÆ =& $_SERVER[¬¦ã¾]; $F£áŒ­ä¬ = array($C´ÕæŠ³ÇÆ[1904] => $_SERVER[$C´ÕæŠ³ÇÆ[1905]], $C´ÕæŠ³ÇÆ[1906] => strtolower(ACTION)); return $this->addEvent($E¨øŒ¬‰© , $C´ÕæŠ³ÇÆ[1655], $F£áŒ­ä¬); } public function eventRecycle($fóÜŸ“ğ‚, $eÃ“‰šéİ) { return $this->addEvent($fóÜŸ“ğ‚, $_SERVER[¬¦ã¾][1900], $eÃ“‰šéİ); } public function eventRemove($f÷èº¬ƒÌÕ) { $dŒãÃñ†‹¤ =& $_SERVER[¬¦ã¾]; $e‚¢‹¥§Ëó = Model($dŒãÃñ†‹¤[1197])->sourceInfo($f÷èº¬ƒÌÕ); $AÖ™¤æ²„® = $e‚¢‹¥§Ëó[$dŒãÃñ†‹¤[28]]; return $this->addEvent($e‚¢‹¥§Ëó[$dŒãÃñ†‹¤[478]], $dŒãÃñ†‹¤[1654], $AÖ™¤æ²„®); } public function eventShare($AÕÓßÕ„ã†, $aÉÇ¿ğâ²) { return $this->addEvent($AÕÓßÕ„ã†, $_SERVER[¬¦ã¾][1665], $aÉÇ¿ğâ²); } public function eventMove($AÁ„»ëä·†, $dˆ¦ª²Ö, $C…Ş§Ü¡¸‰) { goto fßÆõ‹ôì¨; b¬ÁØ–ë†Š: $this->addEvent($dˆ¦ª²Ö, $D©Œ¥±ÉÍÏ[1910], $aà¶ÍˆïÊ); goto cù—·…ÁÜÈ; FÅå¥“ÍéŞ: $this->addEvent($AÁ„»ëä·†, $D©Œ¥±ÉÍÏ[520], $aà¶ÍˆïÊ); $CÙØåÄÙ¿å = $cÒ®‰îÄğ->sourceInfo($AÁ„»ëä·†); $aà¶ÍˆïÊ = array($D©Œ¥±ÉÍÏ[395] => $CÙØåÄÙ¿å[$D©Œ¥±ÉÍÏ[395]], $D©Œ¥±ÉÍÏ[28] => $CÙØåÄÙ¿å[$D©Œ¥±ÉÍÏ[28]]); goto b¬ÁØ–ë†Š; fßÆõ‹ôì¨: $D©Œ¥±ÉÍÏ =& $_SERVER[¬¦ã¾]; $cÒ®‰îÄğ = Model($D©Œ¥±ÉÍÏ[1197]); $CÙØåÄÙ¿å = $cÒ®‰îÄğ->sourceInfo($AÁ„»ëä·†); goto bÆ¨˜â»ˆñ; bÆ¨˜â»ˆñ: $B¨ì÷”š¦ñ = $cÒ®‰îÄğ->sourceInfo($dˆ¦ª²Ö); $E…Ç¼¤õÉ£ = $cÒ®‰îÄğ->sourceInfo($C…Ş§Ü¡¸‰); $aà¶ÍˆïÊ = array($D©Œ¥±ÉÍÏ[1046] => $dˆ¦ª²Ö, $D©Œ¥±ÉÍÏ[1907] => $B¨ì÷”š¦ñ[$D©Œ¥±ÉÍÏ[28]], $D©Œ¥±ÉÍÏ[1887] => !empty($B¨ì÷”š¦ñ[$D©Œ¥±ÉÍÏ[495]]) ? $B¨ì÷”š¦ñ[$D©Œ¥±ÉÍÏ[495]] : $D©Œ¥±ÉÍÏ[33], $D©Œ¥±ÉÍÏ[1047] => $C…Ş§Ü¡¸‰, $D©Œ¥±ÉÍÏ[1908] => $E…Ç¼¤õÉ£[$D©Œ¥±ÉÍÏ[28]], $D©Œ¥±ÉÍÏ[1909] => !empty($E…Ç¼¤õÉ£[$D©Œ¥±ÉÍÏ[495]]) ? $E…Ç¼¤õÉ£[$D©Œ¥±ÉÍÏ[495]] : $D©Œ¥±ÉÍÏ[33]); goto FÅå¥“ÍéŞ; cù—·…ÁÜÈ: } public function eventCopy($b”ÇŒ›µ) { $this->eventCreate($b”ÇŒ›µ, $_SERVER[¬¦ã¾][518]); } public function eventRename($DÈñ¸ˆÊí², $dèÁ‹ñî›, $CéºÜ¤¥©×) { $dÏçè¹ª³ =& $_SERVER[¬¦ã¾]; $bÔÆÍ™¾İƒ = array($dÏçè¹ª³[1046] => $dèÁ‹ñî›, $dÏçè¹ª³[1047] => $CéºÜ¤¥©×); return $this->addEvent($DÈñ¸ˆÊí², $dÏçè¹ª³[1211], $bÔÆÍ™¾İƒ); } public function eventAddComment($bÃŒ´ÅÔ×Ì, $dìøÕ£’) { return $this->addEvent($bÃŒ´ÅÔ×Ì, $_SERVER[¬¦ã¾][1911], $dìøÕ£’); } public function eventAddDesc($DÈÑ¾š¸¡, $bİ©Âš‘ö) { return $this->addEvent($DÈÑ¾š¸¡, $_SERVER[¬¦ã¾][1912], $bİ©Âš‘ö); } public function listBySource($a—ù‡Ó¡Ôá) { goto CÊÀ‡ãĞŸ; c¸¬ïë«×²: return $this->eventListParse($Eê©²êàÒ”, $a—ù‡Ó¡Ôá); goto AÖ©õ™ŞØ; B½ØÓä­¬”: if ($b±É‚í…´Ê[$EÌ¯„ù™–¿[403]] == $EÌ¯„ù™–¿[87]) { $b”¬á­‹ = Model($EÌ¯„ù™–¿[1197])->listSearchChildren($a—ù‡Ó¡Ôá, 20000); $b”¬á­‹[] = $a—ù‡Ó¡Ôá . $EÌ¯„ù™–¿[375]; $aâˆõ‡Òù‚ = array($EÌ¯„ù™–¿[395] => array($EÌ¯„ù™–¿[7], $b”¬á­‹)); } $Eê©²êàÒ” = $this->where($aâˆõ‡Òù‚)->order($EÌ¯„ù™–¿[1913])->selectPage(); if ($Eê©²êàÒ”[$EÌ¯„ù™–¿[364]][$EÌ¯„ù™–¿[365]] == 0) { $Eê©²êàÒ”[$EÌ¯„ù™–¿[364]][$EÌ¯„ù™–¿[365]] = 1; $Eê©²êàÒ”[$EÌ¯„ù™–¿[367]] = array(array($EÌ¯„ù™–¿[410] => $a—ù‡Ó¡Ôá, $EÌ¯„ù™–¿[1896] => $b±É‚í…´Ê[$EÌ¯„ù™–¿[478]], $EÌ¯„ù™–¿[1512] => $b±É‚í…´Ê[$EÌ¯„ù™–¿[432]], $EÌ¯„ù™–¿[415] => $EÌ¯„ù™–¿[1914], $EÌ¯„ù™–¿[416] => $b±É‚í…´Ê[$EÌ¯„ù™–¿[194]], $EÌ¯„ù™–¿[1514] => $EÌ¯„ù™–¿[33])); } goto c¸¬ïë«×²; CÊÀ‡ãĞŸ: $EÌ¯„ù™–¿ =& $_SERVER[¬¦ã¾]; $b±É‚í…´Ê = Model($EÌ¯„ù™–¿[1197])->sourceInfo($a—ù‡Ó¡Ôá); $aâˆõ‡Òù‚ = array($EÌ¯„ù™–¿[410] => $a—ù‡Ó¡Ôá); goto B½ØÓä­¬”; AÖ©õ™ŞØ: } private function eventListParse($Aï¨ °Ïİ, $F©‘…ªˆ¡Ï) { goto E¼Åä¿‡å¾; fÊã…àÆñ¬: $b«Üë¶ö±© = array_unique($b«Üë¶ö±©); $fÆçëµØõÕ = array_unique(array_to_keyvalue($EÚ®ª×¥½ù, $E’Øï÷òî[33], $E’Øï÷òî[1520])); $C¯ÁŞ›Û¢ = Model($E’Øï÷òî[506])->userListInfo($fÆçëµØõÕ); goto Fªš³‰íÉ†; E¼Åä¿‡å¾: $E’Øï÷òî =& $_SERVER[¬¦ã¾]; $EÚ®ª×¥½ù = $Aï¨ °Ïİ[$E’Øï÷òî[367]]; $b«Üë¶ö±© = array_to_keyvalue($EÚ®ª×¥½ù, $E’Øï÷òî[33], $E’Øï÷òî[395]); goto AšÅçãÂ™; AÔùòÚ‘÷: $Aï¨ °Ïİ[$E’Øï÷òî[367]] = $EÚ®ª×¥½ù; return $Aï¨ °Ïİ; goto dÂ’ÒÎäÒˆ; Fªš³‰íÉ†: $DÁÔÍÏ¿Á¦ = Model($E’Øï÷òî[782])->sourceListInfo($b«Üë¶ö±©, !0); foreach ($EÚ®ª×¥½ù as &$DœóŠçÕõÇ) { if ($DœóŠçÕõÇ[$E’Øï÷òî[29]] == $E’Øï÷òî[520] && isset($DœóŠçÕõÇ[$E’Øï÷òî[431]][$E’Øï÷òî[1046]])) { $DœóŠçÕõÇ[$E’Øï÷òî[431]][$E’Øï÷òî[1046]] = $DÁÔÍÏ¿Á¦[$DœóŠçÕõÇ[$E’Øï÷òî[431]][$E’Øï÷òî[1046]]]; $DœóŠçÕõÇ[$E’Øï÷òî[431]][$E’Øï÷òî[1047]] = $DÁÔÍÏ¿Á¦[$DœóŠçÕõÇ[$E’Øï÷òî[431]][$E’Øï÷òî[1047]]]; } if ($DœóŠçÕõÇ[$E’Øï÷òî[29]] == $E’Øï÷òî[1910] && isset($DœóŠçÕõÇ[$E’Øï÷òî[431]][$E’Øï÷òî[395]])) { $DœóŠçÕõÇ[$E’Øï÷òî[431]][$E’Øï÷òî[395]] = $DÁÔÍÏ¿Á¦[$DœóŠçÕõÇ[$E’Øï÷òî[431]][$E’Øï÷òî[395]]]; } $DœóŠçÕõÇ[$E’Øï÷òî[85]] = $DÁÔÍÏ¿Á¦[$DœóŠçÕõÇ[$E’Øï÷òî[395]]]; $DœóŠçÕõÇ[$E’Øï÷òî[1915]] = $DÁÔÍÏ¿Á¦[$DœóŠçÕõÇ[$E’Øï÷òî[1902]]]; if ($DœóŠçÕõÇ[$E’Øï÷òî[29]] == $E’Øï÷òî[1654]) { $DœóŠçÕõÇ[$E’Øï÷òî[1915]] = $DœóŠçÕõÇ[$E’Øï÷òî[85]]; $DœóŠçÕõÇ[$E’Øï÷òî[1902]] = $DœóŠçÕõÇ[$E’Øï÷òî[1915]][$E’Øï÷òî[395]]; $DœóŠçÕõÇ[$E’Øï÷òî[85]] = !1; $DœóŠçÕõÇ[$E’Øï÷òî[395]] = $E’Øï÷òî[33]; } $DœóŠçÕõÇ[$E’Øï÷òî[1845]] = $C¯ÁŞ›Û¢[$DœóŠçÕõÇ[$E’Øï÷òî[1520]]]; } unset($DœóŠçÕõÇ); goto AÔùòÚ‘÷; AšÅçãÂ™: $aø×ùÌ¹Ò° = array_to_keyvalue($EÚ®ª×¥½ù, $E’Øï÷òî[33], $E’Øï÷òî[1902]); foreach ($EÚ®ª×¥½ù as $DœóŠçÕõÇ) { $aÑ ·Ì…²È = $DœóŠçÕõÇ[$E’Øï÷òî[431]]; if ($DœóŠçÕõÇ[$E’Øï÷òî[29]] == $E’Øï÷òî[520] && isset($aÑ ·Ì…²È[$E’Øï÷òî[1046]])) { $b«Üë¶ö±©[] = $aÑ ·Ì…²È[$E’Øï÷òî[1046]] . $E’Øï÷òî[33]; $b«Üë¶ö±©[] = $aÑ ·Ì…²È[$E’Øï÷òî[1047]] . $E’Øï÷òî[33]; } if ($DœóŠçÕõÇ[$E’Øï÷òî[29]] == $E’Øï÷òî[1910] && isset($aÑ ·Ì…²È[$E’Øï÷òî[395]])) { $b«Üë¶ö±©[] = $aÑ ·Ì…²È[$E’Øï÷òî[395]] . $E’Øï÷òî[33]; } } $b«Üë¶ö±© = array_merge($b«Üë¶ö±©, $aø×ùÌ¹Ò°, array($F©‘…ªˆ¡Ï . $E’Øï÷òî[33])); goto fÊã…àÆñ¬; dÂ’ÒÎäÒˆ: } public function removeBySource($e¢ãøÄ‚®ì) { $C†øñ­æªÖ = array($_SERVER[¬¦ã¾][410] => $e¢ãøÄ‚®ì); $this->where($C†øñ­æªÖ)->remove(); } } goto e†ùœæ´Á; f„­Ø‹½æ‘: class FileContentModel extends ModelBase { protected $tableName = "\x69\157\137\x66\x69\154\x65\x5f\x63\157\x6e\164\145\x6e\x74\x73"; protected $dataAuto = array(array("\x63\162\x65\x61\164\x65\x54\151\x6d\145", "\164\151\x6d\145", "\151\x6e\163\x65\162\x74", "\146\165\156\143\x74\151\157\156")); } class FileModel extends ModelBase { protected $tableName = "\x69\x6f\x5f\x66\151\x6c\145"; protected $tableMeta = array("\x74\x61\x62\154\145\x4e\x61\155\145" => "\x69\157\137\x66\x69\x6c\x65\137\x6d\x65\x74\141", "\x6d\145\164\x61\106\x69\x65\154\144" => "\x66\x69\x6c\x65\111\104"); public function fileInfo($BÆÎ·¥»¶›) { $aİ÷é±ØÉÉ =& $_SERVER[¬¦ã¾]; static $CùäšËÙˆĞ = array(); if (!isset($CùäšËÙˆĞ[$BÆÎ·¥»¶›])) { $Bò°šà·ã‚ = $aİ÷é±ØÉÉ[1732]; $eÑ¯Š¸‹ = Model($aİ÷é±ØÉÉ[450])->field($Bò°šà·ã‚)->where(array($aİ÷é±ØÉÉ[448] => $BÆÎ·¥»¶›))->find(); $CùäšËÙˆĞ[$BÆÎ·¥»¶›] = $eÑ¯Š¸‹; } return $CùäšËÙˆĞ[$BÆÎ·¥»¶›]; } public function addFileByContent($FË¨´Ë¶™ = '', $E‘‰Ù˜­¨º = '') { goto DÏ¿Õ‚´º; BÚéƒÄõ«ó: if (file_exists($b´§‘í©ß„)) { @unlink($b´§‘í©ß„); } return $cÙÓ®ˆï˜; goto b‡»Ì¶Ò±; D»¡¹¹µ¬”: $b´§‘í©ß„ = $c”‹ß„™Ñ . $FîÖ‘°ÍÂÄ[1734] . rand_string(16); file_put_contents($b´§‘í©ß„, $FË¨´Ë¶™); $cÙÓ®ˆï˜ = $this->addFile($b´§‘í©ß„, $E‘‰Ù˜­¨º, !0); goto BÚéƒÄõ«ó; DÏ¿Õ‚´º: $FîÖ‘°ÍÂÄ =& $_SERVER[¬¦ã¾]; $c”‹ß„™Ñ = TEMP_PATH . $FîÖ‘°ÍÂÄ[1733]; if (!is_dir($c”‹ß„™Ñ)) { mk_dir($c”‹ß„™Ñ); } goto D»¡¹¹µ¬”; b‡»Ì¶Ò±: } public function createFileName($câó“Å½à‚, $a¶‚ì¡ÀÏ = false, $B¨ŒÎ„¦Ñ = false) { goto c±ïµ’Ÿ¦Ÿ; c±ïµ’Ÿ¦Ÿ: $eó™Ãåå¾à =& $_SERVER[¬¦ã¾]; $E•Ÿ½’Ø·¢ = IO::init($eó™Ãåå¾à[8]); $F×™Ó¹»¸ë = $this->makeFilePath($câó“Å½à‚, $E•Ÿ½’Ø·¢, $a¶‚ì¡ÀÏ, $B¨ŒÎ„¦Ñ); goto c«È¬“Û‘±; a£¾Æöª…À: if (!$c‰•‹³¸é÷ && !Cache::get($Eà¸îÖ™·Ò)) { $c‰•‹³¸é÷ = !0; $e¡ïİïŞó» = IO::mkdir($cŒ©ø©“…¶); if (!IO::exist($e¡ïİïŞó» . $eó™Ãåå¾à[753])) { IO::mkfile($e¡ïİïŞó» . $eó™Ãåå¾à[753]); } Cache::set($Eà¸îÖ™·Ò, 1, 3600 * 2); } return $F×™Ó¹»¸ë; goto EêÄ‡¬³; c«È¬“Û‘±: $cŒ©ø©“…¶ = $E•Ÿ½’Ø·¢->pathFather($F×™Ó¹»¸ë); static $c‰•‹³¸é÷ = false; $Eà¸îÖ™·Ò = $eó™Ãåå¾à[1735] . md5($cŒ©ø©“…¶); goto a£¾Æöª…À; EêÄ‡¬³: } public function makeFilePath($F£­¦‡ó½¬, $f®¼‰˜¢Ö, $D²è¨ºÙ– = false, $f„Šô¡œØ = false) { goto eÎ½§ùÖ÷; eÎ½§ùÖ÷: $E†®ùÆµ¹Ï =& $_SERVER[¬¦ã¾]; $CÕĞæ™‘åÓ = Model($E†®ùÆµ¹Ï[722])->get($E†®ùÆµ¹Ï[1736]); $b×±…‹äÕ¬ = KodIO::defaultIO() . date($E†®ùÆµ¹Ï[1737]); goto aÒµ¯İ¤Ñ; EÂé‹”‚Ã: if (!$F£­¦‡ó½¬) { $CÕĞæ™‘åÓ = $E†®ùÆµ¹Ï[1738]; } switch ($CÕĞæ™‘åÓ) { case $E†®ùÆµ¹Ï[1739]: $A÷Œ³„šÜŠ = $A÷Œ³„šÜŠ . $E†®ùÆµ¹Ï[95] . $f®¼‰˜¢Ö->ext($F£­¦‡ó½¬); if ($e×Œè‰¼¥¨ == $E†®ùÆµ¹Ï[1678]) { $A÷Œ³„šÜŠ .= $E†®ùÆµ¹Ï[1422]; } break; case $E†®ùÆµ¹Ï[1740]: goto bÁºÊàª˜¦; EÇåÇ Ã¸: if (IO::isTypeObject($A÷Œ³„šÜŠ) && !IO::isUploadServer($A÷Œ³„šÜŠ)) { if (IO::exist($A÷Œ³„šÜŠ)) { return $A÷Œ³„šÜŠ; } $A¾ß‰‘´Ñ¼ = IO::setContent($A÷Œ³„šÜŠ, $E†®ùÆµ¹Ï[33]); if (!$A¾ß‰‘´Ñ¼) { show_json($E†®ùÆµ¹Ï[1743], !1); } } CacheLock::unlock($eåÒ¸´Šç„); break; goto DÈÎÏÛš¹™; b¿÷¡øåèç: CacheLock::lock($eåÒ¸´Šç„); $A÷Œ³„šÜŠ = $b×±…‹äÕ¬ . $F£­¦‡ó½¬; if (IO::exist($b×±…‹äÕ¬ . $F£­¦‡ó½¬)) { $cã¥ó†ˆÌó = substr($F£­¦‡ó½¬, 0, strlen($F£­¦‡ó½¬) - strlen($e×Œè‰¼¥¨)); $BñÈÑùÚâ¶ = $f„Šô¡œØ ? substr($f„Šô¡œØ, 0, 5) : ($D²è¨ºÙ– ? substr($D²è¨ºÙ–, 0, 5) : rand_string(5)); $A÷Œ³„šÜŠ = $b×±…‹äÕ¬ . $cã¥ó†ˆÌó . $BñÈÑùÚâ¶ . $E†®ùÆµ¹Ï[95] . $e×Œè‰¼¥¨; } goto EÇåÇ Ã¸; bÁºÊàª˜¦: $cÈà•ŠËÕ = Model($E†®ùÆµ¹Ï[722])->get($E†®ùÆµ¹Ï[723]); $Fğ–¤±âÂ× = substr(md5($E†®ùÆµ¹Ï[724] . $cÈà•ŠËÕ . date($E†®ùÆµ¹Ï[700])), 0, 8); $CŸ‡×²ï¹Š = KodIO::defaultDriver(); goto bêà§àÔ¦Ó; bêà§àÔ¦Ó: $b×±…‹äÕ¬ = $E†®ùÆµ¹Ï[1115] . $CŸ‡×²ï¹Š[$E†®ùÆµ¹Ï[393]] . $E†®ùÆµ¹Ï[402] . date($E†®ùÆµ¹Ï[1741]) . $Fğ–¤±âÂ× . $E†®ùÆµ¹Ï[8]; if ($e×Œè‰¼¥¨ == $E†®ùÆµ¹Ï[1678]) { $F£­¦‡ó½¬ .= $E†®ùÆµ¹Ï[1422]; } $eåÒ¸´Šç„ = $E†®ùÆµ¹Ï[1742] . $b×±…‹äÕ¬ . $F£­¦‡ó½¬; goto b¿÷¡øåèç; DÈÎÏÛš¹™: case $E†®ùÆµ¹Ï[1738]: break; default: break; } return $A÷Œ³„šÜŠ; goto d×Ÿ••ˆĞ§; aÒµ¯İ¤Ñ: $A÷Œ³„šÜŠ = $b×±…‹äÕ¬ . rand_string(5) . short_id(100); $F£­¦‡ó½¬ = str_replace($E†®ùÆµ¹Ï[8], $E†®ùÆµ¹Ï[71], KodIO::clear($F£­¦‡ó½¬)); $e×Œè‰¼¥¨ = $f®¼‰˜¢Ö->ext($F£­¦‡ó½¬); goto EÂé‹”‚Ã; d×Ÿ••ˆĞ§: } public function addFileByRemote($B¼ù–„á³, $FßÖĞÊ¾óœ, $d÷ï¥¦»ºç = array()) { goto c¤©°¾í¶¢; cˆ³‘¢â‰È: $f³Ë„äµèœ = IO::hashMd5($B¼ù–„á³, $a”÷ªì™è); $C‘†øÂå³Å = KodIO::defaultDriver(); $Cµ¡ªŞ = array($Fîé±¬´ï’[548] => IO::size($B¼ù–„á³), $Fîé±¬´ï’[1744] => 1, $Fîé±¬´ï’[413] => $FßÖĞÊ¾óœ, $Fîé±¬´ï’[765] => $C‘†øÂå³Å[$Fîé±¬´ï’[393]], $Fîé±¬´ï’[414] => $B¼ù–„á³, $Fîé±¬´ï’[1745] => $d÷ï¥¦»ºç[$Fîé±¬´ï’[171]] ? $d÷ï¥¦»ºç[$Fîé±¬´ï’[171]] : IO::hashSimple($B¼ù–„á³), $Fîé±¬´ï’[1746] => $f³Ë„äµèœ ? $f³Ë„äµèœ : $a”÷ªì™è); goto DÙÎÍ‚¯Ô¼; DÙÎÍ‚¯Ô¼: if ($fƒ‚“»Ô‚• = $this->addFileCheckExist($Cµ¡ªŞ[$Fîé±¬´ï’[171]], $Cµ¡ªŞ[$Fîé±¬´ï’[170]], $Cµ¡ªŞ[$Fîé±¬´ï’[78]])) { return $fƒ‚“»Ô‚•; } return $this->addFileData($Cµ¡ªŞ); goto bìõ‡³”; c¤©°¾í¶¢: $Fîé±¬´ï’ =& $_SERVER[¬¦ã¾]; if (!IO::exist($B¼ù–„á³)) { return !1; } $a”÷ªì™è = $d÷ï¥¦»ºç[$Fîé±¬´ï’[170]] ? $d÷ï¥¦»ºç[$Fîé±¬´ï’[170]] : $Fîé±¬´ï’[33]; goto cˆ³‘¢â‰È; bìõ‡³”: } private function addFileData($Eî•‚®ˆË§) { $Cã”½›Ë =& $_SERVER[¬¦ã¾]; if (!$Eî•‚®ˆË§) { return !1; } $Eî•‚®ˆË§[$Cã”½›Ë[78]] = intval($Eî•‚®ˆË§[$Cã”½›Ë[78]]); if (!$Eî•‚®ˆË§[$Cã”½›Ë[78]] && strlen($Eî•‚®ˆË§[$Cã”½›Ë[171]]) > 32) { $Eî•‚®ˆË§[$Cã”½›Ë[78]] = intval(substr($Eî•‚®ˆË§[$Cã”½›Ë[171]], 32)); } $BñÜÚ£Œ‚Ù = $this->add($Eî•‚®ˆË§); return $this->find($BñÜÚ£Œ‚Ù); } public function addFile($fÈ¾õ ›»Ó, $D˜¯á¢¹§¬, $FÔÁ…’àğ = false) { goto D†Ô÷ëÑ”–; D†Ô÷ëÑ”–: $c–íŠ¢¨î = IO::hashSimple($fÈ¾õ ›»Ó); $d×±Øƒ¶–Ì = IO::hashMd5($fÈ¾õ ›»Ó); $FÛ¶Òì““Œ = IO::size($fÈ¾õ ›»Ó); goto e¯Ãï„Ç¦ô; e¯Ãï„Ç¦ô: $bÉğˆàÊº = $_SERVER[¬¦ã¾][1747] . $d×±Øƒ¶–Ì; CacheLock::lock($bÉğˆàÊº); if ($a·×¥¯öÓ = $this->addFileCheckExist($c–íŠ¢¨î, $d×±Øƒ¶–Ì, $FÛ¶Òì““Œ)) { CacheLock::unlock($bÉğˆàÊº); return $a·×¥¯öÓ; } goto a†•ÌÚÀ‹; a†•ÌÚÀ‹: $a°Ø–àˆæ“ = $this->addFileMake($fÈ¾õ ›»Ó, $FÛ¶Òì““Œ, $c–íŠ¢¨î, $d×±Øƒ¶–Ì, $D˜¯á¢¹§¬, $FÔÁ…’àğ); $F‡¦ñˆäĞô = $this->addFileData($a°Ø–àˆæ“); CacheLock::unlock($bÉğˆàÊº); goto Eæ‹¨Ç¿§¬; Eæ‹¨Ç¿§¬: return $F‡¦ñˆäĞô; goto F¹ÚÃŠ—×ƒ; F¹ÚÃŠ—×ƒ: } public function addFileMake($dõïù¾£ÆŞ, $F†¹¬ãŞŞã, $F±™·Ë‰Û, $cÃ‰ÈÙµš, $f»á‘©È›, $D¡Ø––±¢) { goto EÎ¼‚İÏÔ‘; CÉ‚ğ ¬ò’: $BÑ½õ÷œ‡¡ = KodIO::defaultDriver(); $cïíì¥íè… = array($a¹é÷‰¸ÁĞ[548] => $F†¹¬ãŞŞã, $a¹é÷‰¸ÁĞ[1744] => 1, $a¹é÷‰¸ÁĞ[413] => $f»á‘©È›, $a¹é÷‰¸ÁĞ[765] => $BÑ½õ÷œ‡¡[$a¹é÷‰¸ÁĞ[393]], $a¹é÷‰¸ÁĞ[414] => $BÈ£äÌ­Íº, $a¹é÷‰¸ÁĞ[1745] => $F±™·Ë‰Û, $a¹é÷‰¸ÁĞ[1746] => $cÃ‰ÈÙµš); return $cïíì¥íè…; goto cõ‹Éğ ›Ò; Eˆ•“šã: $b›õÇÉªÁñ = get_path_this($BÈ£äÌ­Íº); if ($D¡Ø––±¢) { $FßÚ¼÷´îñ = IO::move($dõïù¾£ÆŞ, $DƒÑó™Ç‡ù, !1, $b›õÇÉªÁñ); } else { $FßÚ¼÷´îñ = IO::copy($dõïù¾£ÆŞ, $DƒÑó™Ç‡ù, !1, $b›õÇÉªÁñ); } if (!$FßÚ¼÷´îñ) { return !1; } goto CÉ‚ğ ¬ò’; EÎ¼‚İÏÔ‘: $a¹é÷‰¸ÁĞ =& $_SERVER[¬¦ã¾]; $BÈ£äÌ­Íº = $this->createFileName($f»á‘©È›, $F±™·Ë‰Û, $cÃ‰ÈÙµš); $DƒÑó™Ç‡ù = get_path_father($BÈ£äÌ­Íº); goto Eˆ•“šã; cõ‹Éğ ›Ò: } public function addFileCheckExist($c¼ÍÚíö, $dñÅ”Ú°‡‰, $b ’Á¾øô§) { $FêÍšø×îÑ =& $_SERVER[¬¦ã¾]; $AøÙÄéÃè = $this->findByHash($c¼ÍÚíö, $dñÅ”Ú°‡‰); if (!$AøÙÄéÃè) { return !1; } $f‹µ´–ÊÊê = array($FêÍšø×îÑ[1744] => intval($AøÙÄéÃè[$FêÍšø×îÑ[1748]]) + 1, $FêÍšø×îÑ[548] => $b ’Á¾øô§); $this->where(array($FêÍšø×îÑ[448] => $AøÙÄéÃè[$FêÍšø×îÑ[447]]))->save($f‹µ´–ÊÊê); return $AøÙÄéÃè; } public function remove($fİó‹”×º­) { $this->linkCountChange($fİó‹”×º­, !1); $this->clearEmpty(); return !0; } public function linkAdd($C íäªğÎ¹) { $this->linkCountChange($C íäªğÎ¹, !0); } public function linkCountChange($DŒš×‘•Çˆ, $B†‹ğÜ¢¥Ê) { goto e” ä„ù®ñ; f­æÀŠ¡ƒ¨: foreach ($Fò±‹‹ğÛ™ as $bø¤š„Ô“¤ => $eø‹ö‘á£) { $A•ÈŞ§ï = $eø‹ö‘á£ . $E¿Ìˆ£µ¿Ï[33]; if (!$Có­¿¦ÇÚ‰[$A•ÈŞ§ï]) { $Có­¿¦ÇÚ‰[$A•ÈŞ§ï] = array(); } $Có­¿¦ÇÚ‰[$A•ÈŞ§ï][] = $bø¤š„Ô“¤; } foreach ($Có­¿¦ÇÚ‰ as $eø‹ö‘á£ => $aºÉÊ’›‚í) { if (!$aºÉÊ’›‚í) { continue; } $eø‹ö‘á£ = $B†‹ğÜ¢¥Ê ? $eø‹ö‘á£ : -intval($eø‹ö‘á£); $C âœŠ´· = array($E¿Ìˆ£µ¿Ï[447] => array($E¿Ìˆ£µ¿Ï[7], $aºÉÊ’›‚í)); if ($eø‹ö‘á£ < 0) { $C âœŠ´·[$E¿Ìˆ£µ¿Ï[1748]] = array($E¿Ìˆ£µ¿Ï[963], abs($eø‹ö‘á£)); } $this->where($C âœŠ´·)->setAdd($E¿Ìˆ£µ¿Ï[1748], $eø‹ö‘á£); } goto A»‡êïƒÚå; e” ä„ù®ñ: $E¿Ìˆ£µ¿Ï =& $_SERVER[¬¦ã¾]; if (!$DŒš×‘•Çˆ) { return; } if (!is_array($DŒš×‘•Çˆ)) { $DŒš×‘•Çˆ = array($DŒš×‘•Çˆ); } goto CåÑêù«öÎ; CåÑêù«öÎ: $Fò±‹‹ğÛ™ = array(); foreach ($DŒš×‘•Çˆ as $bø¤š„Ô“¤) { $A•ÈŞ§ï = $bø¤š„Ô“¤ . $E¿Ìˆ£µ¿Ï[33]; if (!$Fò±‹‹ğÛ™[$A•ÈŞ§ï]) { $Fò±‹‹ğÛ™[$A•ÈŞ§ï] = 0; } $Fò±‹‹ğÛ™[$A•ÈŞ§ï]++; } $Có­¿¦ÇÚ‰ = array(); goto f­æÀŠ¡ƒ¨; A»‡êïƒÚå: } public function findByHash($b‚¿×Í’ÖÄ, $Dö¯Ãå†ÁÆ = false) { $d„Š†àá‡í =& $_SERVER[¬¦ã¾]; if (!$b‚¿×Í’ÖÄ && !$Dö¯Ãå†ÁÆ) { return !1; } $döíŠ¹‚Ü = array($d„Š†àá‡í[1745] => $b‚¿×Í’ÖÄ); if ($Dö¯Ãå†ÁÆ) { $döíŠ¹‚Ü = array($d„Š†àá‡í[1746] => $Dö¯Ãå†ÁÆ); } return $this->order($d„Š†àá‡í[1749])->where($döíŠ¹‚Ü)->find(); } public function clearEmpty($D»ƒ¢ß—À = 0) { goto DĞºÉØñÆ™; e˜¬…»ƒã×: foreach ($d•¸¥àãŠ‹ as $F’İ£ÆÆ•) { $d–ì®øË±->update(1); $this->resetFile($F’İ£ÆÆ•); } $d–ì®øË±->end(); goto BØ®ï‚òˆ; CŒ¡Î¾“‚: $d•¸¥àãŠ‹ = $this->where($e†‹ÈãÍ¾”)->select(); if (!$d•¸¥àãŠ‹) { return; } $d–ì®øË± = new Task($f¸½ÓÏ‘êº[1751], $f¸½ÓÏ‘êº[33], count($d•¸¥àãŠ‹)); goto e˜¬…»ƒã×; DĞºÉØñÆ™: $f¸½ÓÏ‘êº =& $_SERVER[¬¦ã¾]; $A–ÍˆˆºÌ = time() - 3600 * 24 * $D»ƒ¢ß—À; $e†‹ÈãÍ¾” = $f¸½ÓÏ‘êº[1750] . $A–ÍˆˆºÌ; goto CŒ¡Î¾“‚; BØ®ï‚òˆ: } public function resetFile($d¶‡å­÷â) { goto Eæ…÷Ó‚æ; dÕÃİ÷²éÀ: if ($d¶‡å­÷â[$Dé‹‹–Ş‡â[1748]] != $AÖŠ³ƒ…è—) { $this->where($DµÖÌİæéî)->save(array($Dé‹‹–Ş‡â[1744] => $AÖŠ³ƒ…è—)); } goto cÄ²‘¸‰Í§; Dƒ‰„«¸¤: $fÒ¯‰µ¶‰æ = Model($Dé‹‹–Ş‡â[1752])->where($DµÖÌİæéî)->count(); $AÖŠ³ƒ…è— = intval($a¯¡°¨‹¯«) + intval($fÒ¯‰µ¶‰æ); if ($AÖŠ³ƒ…è— == 0) { IO::remove($d¶‡å­÷â[$Dé‹‹–Ş‡â[76]]); Model($Dé‹‹–Ş‡â[1753])->delete($d¶‡å­÷â[$Dé‹‹–Ş‡â[447]]); $this->where($DµÖÌİæéî)->delete(); $this->metaSet($d¶‡å­÷â[$Dé‹‹–Ş‡â[447]], null, null); return; } goto dÕÃİ÷²éÀ; Eæ…÷Ó‚æ: $Dé‹‹–Ş‡â =& $_SERVER[¬¦ã¾]; $DµÖÌİæéî = array($Dé‹‹–Ş‡â[448] => $d¶‡å­÷â[$Dé‹‹–Ş‡â[447]]); $a¯¡°¨‹¯« = Model($Dé‹‹–Ş‡â[1197])->where($DµÖÌİæéî)->count(); goto Dƒ‰„«¸¤; cÄ²‘¸‰Í§: } public function storageInfo($Aá•õÀ×‚‘ = false) { goto c—ˆèäºĞ¤; c—ˆèäºĞ¤: $Fõ¯Á´½¬£ =& $_SERVER[¬¦ã¾]; $cùšĞö†¨Å = $this->count() + 0.0; $f¿Ğ¸âåëÀ = 0; goto a’‰Ä’òˆ‡; bœÂ¹†¯Ì‰: for ($Fö‡Ğ’é— = 0; $Fö‡Ğ’é— < $cùšĞö†¨Å; $Fö‡Ğ’é— = $Fö‡Ğ’é— + $B‚¾òÙ×ˆ) { $eÕ”Ë±†©ö = $this->limit($Fö‡Ğ’é—, $Fö‡Ğ’é— + $B‚¾òÙ×ˆ)->select(); foreach ($eÕ”Ë±†©ö as $E¶ëßù§§Š) { $BÒƒ´ùŒ±İ += $E¶ëßù§§Š[$Fõ¯Á´½¬£[78]] * $E¶ëßù§§Š[$Fõ¯Á´½¬£[1748]]; $f¿Ğ¸âåëÀ += $E¶ëßù§§Š[$Fõ¯Á´½¬£[78]] * ($E¶ëßù§§Š[$Fõ¯Á´½¬£[1748]] - 1); $aÌ¼ƒ³…Ó += $E¶ëßù§§Š[$Fõ¯Á´½¬£[1748]]; } } $bø³ËÒÖ¶ = array($Fõ¯Á´½¬£[1754] => $BÒƒ´ùŒ±İ, $Fõ¯Á´½¬£[1755] => $f¿Ğ¸âåëÀ, $Fõ¯Á´½¬£[1756] => $f¿Ğ¸âåëÀ / $BÒƒ´ùŒ±İ, $Fõ¯Á´½¬£[82] => $cùšĞö†¨Å, $Fõ¯Á´½¬£[1757] => $aÌ¼ƒ³…Ó); return $bø³ËÒÖ¶; goto BØãÍÅ¸š•; a’‰Ä’òˆ‡: $BÒƒ´ùŒ±İ = 1; $aÌ¼ƒ³…Ó = 0; $B‚¾òÙ×ˆ = 5000; goto bœÂ¹†¯Ì‰; BØãÍÅ¸š•: } } class GroupModel extends ModelBase { protected $tableName = "\147\x72\x6f\165\160"; protected $tableMeta = array("\x74\141\x62\x6c\145\x4e\141\155\x65" => "\147\162\x6f\165\160\x5f\x6d\145\164\141", "\155\145\x74\141\106\x69\x65\x6c\x64" => "\147\x72\157\165\160\111\104"); protected function cacheFunctionAlias($ašìˆ«Ùã) { $d°§ƒ‹ò‘ò =& $_SERVER[¬¦ã¾]; return array($d°§ƒ‹ò‘ò[1758] => array($ašìˆ«Ùã[0], $d°§ƒ‹ò‘ò[1759]), $d°§ƒ‹ò‘ò[1760] => array($ašìˆ«Ùã[0], $d°§ƒ‹ò‘ò[1759])); } protected function getInfo($b°¾ŒŒ¡ºÍ) { $A¨•œÅ¬î = $this->getInfoSimple($b°¾ŒŒ¡ºÍ); if (!$A¨•œÅ¬î) { return !1; } return $this->_listDataApplyItem($A¨•œÅ¬î); } protected function getInfoSimple($b“¨Ô„—Ì, $bµ†ªãæ±„ = false) { $B¶ëÌÄ‚Ò =& $_SERVER[¬¦ã¾]; if ($bµ†ªãæ±„) { $CÓø‹Ï¼…× = array($B¶ëÌÄ‚Ò[1688] => intval($b“¨Ô„—Ì)); $CÛÌğÛÄÁ = $this->where($CÓø‹Ï¼…×)->find(); return is_array($CÛÌğÛÄÁ) ? $CÛÌğÛÄÁ : array(); } return $this->cacheFunctionGet($B¶ëÌÄ‚Ò[1761], $b“¨Ô„—Ì); } protected function groupAdd($eœç£®Ôª„) { goto F‰‘ïãµš; cäŞƒù®ÕÊ: if (isset($eœç£®Ôª„[$D„ÄØ°¾‰”[1764]])) { $this->metaSet($c¬ÉÁîù¢, array($D„ÄØ°¾‰”[1764] => $eœç£®Ôª„[$D„ÄØ°¾‰”[1764]], $D„ÄØ°¾‰”[1765] => $eœç£®Ôª„[$D„ÄØ°¾‰”[1765]])); unset($eœç£®Ôª„[$D„ÄØ°¾‰”[1764]]); unset($eœç£®Ôª„[$D„ÄØ°¾‰”[1765]]); } Model($D„ÄØ°¾‰”[1197])->groupRootAdd($c¬ÉÁîù¢); return $c¬ÉÁîù¢; goto A´Àç’ê‚; F‰‘ïãµš: $D„ÄØ°¾‰” =& $_SERVER[¬¦ã¾]; if (!$eœç£®Ôª„[$D„ÄØ°¾‰”[478]] && isset($eœç£®Ôª„[$D„ÄØ°¾‰”[1688]]) && $eœç£®Ôª„[$D„ÄØ°¾‰”[1688]] == 1) { if ($CÃ¶ñÊãƒ = $this->getInfoSimple($eœç£®Ôª„[$D„ÄØ°¾‰”[1688]], !0)) { return $eœç£®Ôª„[$D„ÄØ°¾‰”[1688]]; } } else { $CÃ¶ñÊãƒ = $this->getInfoSimple($eœç£®Ôª„[$D„ÄØ°¾‰”[478]]); if (!$CÃ¶ñÊãƒ) { return !1; } } $aÔ£Šƒùå¥ = $D„ÄØ°¾‰”[498]; goto d¶µ¶®Í¡ê; d¶µ¶®Í¡ê: if ($CÃ¶ñÊãƒ[$D„ÄØ°¾‰”[487]]) { $aÔ£Šƒùå¥ = $CÃ¶ñÊãƒ[$D„ÄØ°¾‰”[487]] . $CÃ¶ñÊãƒ[$D„ÄØ°¾‰”[1688]] . $D„ÄØ°¾‰”[47]; } $A“õãÁ…‚¡ = array($D„ÄØ°¾‰”[413] => $this->groupNameAuto($eœç£®Ôª„[$D„ÄØ°¾‰”[478]], $eœç£®Ôª„[$D„ÄØ°¾‰”[28]]), $D„ÄØ°¾‰”[394] => $eœç£®Ôª„[$D„ÄØ°¾‰”[478]], $D„ÄØ°¾‰”[553] => $aÔ£Šƒùå¥, $D„ÄØ°¾‰”[1762] => $eœç£®Ôª„[$D„ÄØ°¾‰”[1672]], $D„ÄØ°¾‰”[1763] => 0, $D„ÄØ°¾‰”[1692] => 0); if (isset($eœç£®Ôª„[$D„ÄØ°¾‰”[1711]])) { $A“õãÁ…‚¡[$D„ÄØ°¾‰”[1711]] = $eœç£®Ôª„[$D„ÄØ°¾‰”[1711]]; } else { $a¬êÄ»ÛÀà = $this->max($D„ÄØ°¾‰”[1711]); if (!$a¬êÄ»ÛÀà) { $a¬êÄ»ÛÀà = 0; } $A“õãÁ…‚¡[$D„ÄØ°¾‰”[1711]] = $a¬êÄ»ÛÀà + 1; } goto EÍÈœèèó¢; EÍÈœèèó¢: if (!empty($eœç£®Ôª„[$D„ÄØ°¾‰”[1688]])) { $A“õãÁ…‚¡[$D„ÄØ°¾‰”[1688]] = $eœç£®Ôª„[$D„ÄØ°¾‰”[1688]]; } $c¬ÉÁîù¢ = $this->add($A“õãÁ…‚¡); $this->setNamePinyin($c¬ÉÁîù¢, $A“õãÁ…‚¡[$D„ÄØ°¾‰”[28]]); goto cäŞƒù®ÕÊ; A´Àç’ê‚: } protected function groupEdit($c›ÑŒ›¹, $e›¢‡ĞÊô) { goto eğ¥ã¾Ñ’¹; cÆ÷®¯àïŒ: if (isset($e›¢‡ĞÊô[$cÒóÀóôÇ·[28]]) && $e›¢‡ĞÊô[$cÒóÀóôÇ·[28]] != $D¤¾¶¦¼Òà[$cÒóÀóôÇ·[28]]) { $this->_clearChildrenCache($D¤¾¶¦¼Òà); } return $this->where(array($cÒóÀóôÇ·[1766] => $c›ÑŒ›¹))->save($e›¢‡ĞÊô); goto c÷ëÖ‰·¡; eğ¥ã¾Ñ’¹: $cÒóÀóôÇ· =& $_SERVER[¬¦ã¾]; $D¤¾¶¦¼Òà = $this->getInfoSimple($c›ÑŒ›¹); if (!$D¤¾¶¦¼Òà) { return !1; } goto F¯ï¼Ì˜ß; F¯ï¼Ì˜ß: if (!empty($e›¢‡ĞÊô[$cÒóÀóôÇ·[478]])) { $bÙƒŸ©ÑŞ = $this->getInfoSimple($e›¢‡ĞÊô[$cÒóÀóôÇ·[478]]); if (!$bÙƒŸ©ÑŞ) { return !1; } if ($D¤¾¶¦¼Òà[$cÒóÀóôÇ·[1688]] == $bÙƒŸ©ÑŞ[$cÒóÀóôÇ·[1688]]) { return !1; } if ($e›¢‡ĞÊô[$cÒóÀóôÇ·[478]] != $D¤¾¶¦¼Òà[$cÒóÀóôÇ·[478]]) { if ($bÙƒŸ©ÑŞ[$cÒóÀóôÇ·[487]] !== $D¤¾¶¦¼Òà[$cÒóÀóôÇ·[487]] && strpos($bÙƒŸ©ÑŞ[$cÒóÀóôÇ·[487]], $D¤¾¶¦¼Òà[$cÒóÀóôÇ·[487]] . $D¤¾¶¦¼Òà[$cÒóÀóôÇ·[1688]] . $cÒóÀóôÇ·[47]) === 0) { return !1; } $e›¢‡ĞÊô[$cÒóÀóôÇ·[553]] = $bÙƒŸ©ÑŞ[$cÒóÀóôÇ·[487]] . $e›¢‡ĞÊô[$cÒóÀóôÇ·[478]] . $cÒóÀóôÇ·[47]; $this->_changeChildLevel($D¤¾¶¦¼Òà, $bÙƒŸ©ÑŞ); } } if (isset($e›¢‡ĞÊô[$cÒóÀóôÇ·[28]])) { $this->setNamePinyin($c›ÑŒ›¹, $e›¢‡ĞÊô[$cÒóÀóôÇ·[28]]); } if (isset($e›¢‡ĞÊô[$cÒóÀóôÇ·[1764]])) { $this->metaSet($c›ÑŒ›¹, array($cÒóÀóôÇ·[1764] => $e›¢‡ĞÊô[$cÒóÀóôÇ·[1764]], $cÒóÀóôÇ·[1765] => $e›¢‡ĞÊô[$cÒóÀóôÇ·[1765]])); unset($e›¢‡ĞÊô[$cÒóÀóôÇ·[1764]]); unset($e›¢‡ĞÊô[$cÒóÀóôÇ·[1765]]); } goto cÆ÷®¯àïŒ; c÷ëÖ‰·¡: } private function _clearChildrenCache($e—¨¦î¬œ) { $AÀ¶ÛÇËÒö =& $_SERVER[¬¦ã¾]; $f”é£¡¾¾ø = array($AÀ¶ÛÇËÒö[553] => array($AÀ¶ÛÇËÒö[512], $e—¨¦î¬œ[$AÀ¶ÛÇËÒö[487]] . $e—¨¦î¬œ[$AÀ¶ÛÇËÒö[1688]] . $AÀ¶ÛÇËÒö[513])); $a®­ô¦ÁƒŸ = $this->field($AÀ¶ÛÇËÒö[1688])->where($f”é£¡¾¾ø)->select(); foreach ($a®­ô¦ÁƒŸ as $fÇÆö„ƒïÓ) { $this->cacheFunctionClear($AÀ¶ÛÇËÒö[1767], $fÇÆö„ƒïÓ[$AÀ¶ÛÇËÒö[1688]]); $this->cacheFunctionClear($AÀ¶ÛÇËÒö[1761], $fÇÆö„ƒïÓ[$AÀ¶ÛÇËÒö[1688]]); } } private function _changeChildLevel($CïÚ’ÜõŒÊ, $fÕ´êÓÈ„”, $bøŸ©ÒÏ¾ó = false) { goto cˆâ´£°ö; cˆâ´£°ö: $EšÈ¼ò²££ =& $_SERVER[¬¦ã¾]; $AÊ¹—ğï»º = $CïÚ’ÜõŒÊ[$EšÈ¼ò²££[487]] . $CïÚ’ÜõŒÊ[$EšÈ¼ò²££[1688]] . $EšÈ¼ò²££[47]; $câ†½ …· = $fÕ´êÓÈ„”[$EšÈ¼ò²££[487]] . $fÕ´êÓÈ„”[$EšÈ¼ò²££[1688]] . $EšÈ¼ò²££[47] . $CïÚ’ÜõŒÊ[$EšÈ¼ò²££[1688]] . $EšÈ¼ò²££[47]; goto b¡¥´ƒ„¾Ê; fù†ß‡Äæ: $this->_clearChildrenCache($CïÚ’ÜõŒÊ); $this->where($fˆ¿³×ø‹´)->data($dÎîÚ‡•„“)->save(); goto DŒÁ™†; b¡¥´ƒ„¾Ê: if ($bøŸ©ÒÏ¾ó) { $câ†½ …· = $fÕ´êÓÈ„”[$EšÈ¼ò²££[487]] . $fÕ´êÓÈ„”[$EšÈ¼ò²££[1688]] . $EšÈ¼ò²££[47]; } $fˆ¿³×ø‹´ = array($EšÈ¼ò²££[553] => array($EšÈ¼ò²££[512], $CïÚ’ÜõŒÊ[$EšÈ¼ò²££[487]] . $CïÚ’ÜõŒÊ[$EšÈ¼ò²££[1688]] . $EšÈ¼ò²££[513])); $dÎîÚ‡•„“ = array($EšÈ¼ò²££[553] => array($EšÈ¼ò²££[561], "\x72\145\160\154\x61\143\145\x28\160\141\162\145\156\164\114\x65\166\x65\x6c\x2c\47{$AÊ¹—ğï»º}\x27\54\47{$câ†½ …·}\47\51")); goto fù†ß‡Äæ; DŒÁ™†: } public function setNamePinyin($d Õê´óì, $A†ùêôëÜÇ = false) { $dšŞÀ·ÏÆ÷ =& $_SERVER[¬¦ã¾]; if (!$A†ùêôëÜÇ) { $Eì­Ş¢Åµ = $this->getInfoSimple($d Õê´óì); $A†ùêôëÜÇ = $Eì­Ş¢Åµ[$dšŞÀ·ÏÆ÷[28]]; } if (!Input::check($A†ùêôëÜÇ, $dšŞÀ·ÏÆ÷[556])) { $this->metaSet($d Õê´óì, $dšŞÀ·ÏÆ÷[444], null); $this->metaSet($d Õê´óì, $dšŞÀ·ÏÆ÷[443], null); return; } $bŠ‘…Ú‚ = array($dšŞÀ·ÏÆ÷[444] => str_replace($dšŞÀ·ÏÆ÷[50], $dšŞÀ·ÏÆ÷[33], Pinyin::encode($A†ùêôëÜÇ)), $dšŞÀ·ÏÆ÷[443] => Pinyin::encode($A†ùêôëÜÇ, $dšŞÀ·ÏÆ÷[557])); $this->metaSet($d Õê´óì, $bŠ‘…Ú‚); } protected function groupStatus($bÂÜá¼Ê±, $f‹Œè÷–·ˆ) { goto aÏáÜšø ó; aÏáÜšø ó: $dÂÏ¹îèİ¹ =& $_SERVER[¬¦ã¾]; $DØ™Ç™˜ÈŞ = $this->getInfoSimple($bÂÜá¼Ê±); if (!$DØ™Ç™˜ÈŞ) { return !1; } goto D…ˆÒ‘ß; d…Æš¥Â•¼: foreach ($FÔÜæÚË–â as $bÂÜá¼Ê±) { $f†Ì§º‚Òñ[] = array($dÂÏ¹îèİ¹[1688] => $bÂÜá¼Ê±, $dÂÏ¹îèİ¹[93] => $dÂÏ¹îèİ¹[702], $dÂÏ¹îèİ¹[372] => $f‹Œè÷–·ˆ); } return Model($dÂÏ¹îèİ¹[1768])->addAll($f†Ì§º‚Òñ, array(), !0); goto b¥ç‘Ïï«è; D…ˆÒ‘ß: if ($f‹Œè÷–·ˆ == $dÂÏ¹îèİ¹[87]) { $FÔÜæÚË–â = $this->parentLevelArray($DØ™Ç™˜ÈŞ[$dÂÏ¹îèİ¹[487]]); } else { $aŞğÈ¶µ¬ = array($dÂÏ¹îèİ¹[553] => array($dÂÏ¹îèİ¹[512], $DØ™Ç™˜ÈŞ[$dÂÏ¹îèİ¹[487]] . $DØ™Ç™˜ÈŞ[$dÂÏ¹îèİ¹[1688]] . $dÂÏ¹îèİ¹[513])); $FÔÜæÚË–â = $this->where($aŞğÈ¶µ¬)->field($dÂÏ¹îèİ¹[1688])->select(); $FÔÜæÚË–â = array_to_keyvalue($FÔÜæÚË–â, $dÂÏ¹îèİ¹[33], $dÂÏ¹îèİ¹[1688]); } $FÔÜæÚË–â[] = $DØ™Ç™˜ÈŞ[$dÂÏ¹îèİ¹[1688]]; $f†Ì§º‚Òñ = array(); goto d…Æš¥Â•¼; b¥ç‘Ïï«è: } protected function groupRemove($D½ø‹ —) { goto dÓîá§Üì°; BÑ„ƒõ«—ò: Model($Båùíâ®Å´[782])->groupRootRemove($D½ø‹ —); return $this->where($d¥†ˆ•™Ëâ)->delete(); goto C„êåĞ¾Øï; dÓîá§Üì°: $Båùíâ®Å´ =& $_SERVER[¬¦ã¾]; $d¥†ˆ•™Ëâ = array($Båùíâ®Å´[1688] => $D½ø‹ —); $BŒà…¾¡Ì = $this->where($d¥†ˆ•™Ëâ)->find(); goto d‘ªØ´¤ğ®; d‘ªØ´¤ğ®: if (!$BŒà…¾¡Ì || $BŒà…¾¡Ì[$Båùíâ®Å´[478]] == 0) { return !1; } $bË—Üœ£¶Õ = $this->getInfoSimple($BŒà…¾¡Ì[$Båùíâ®Å´[478]]); $this->_changeChildLevel($BŒà…¾¡Ì, $bË—Üœ£¶Õ, !0); goto D˜¸‚ğ£ó; D˜¸‚ğ£ó: $this->where(array($Båùíâ®Å´[478] => $D½ø‹ —))->save(array($Båùíâ®Å´[478] => $BŒà…¾¡Ì[$Båùíâ®Å´[478]])); Model($Båùíâ®Å´[1768])->where($d¥†ˆ•™Ëâ)->delete(); Model($Båùíâ®Å´[1769])->where($d¥†ˆ•™Ëâ)->delete(); goto BÑ„ƒõ«—ò; C„êåĞ¾Øï: } protected function groupSort($b†’ÉôÈÁ¡) { $EÎ¾æ‘Ì± =& $_SERVER[¬¦ã¾]; $FË¸ß•õÉó = array(); foreach ($b†’ÉôÈÁ¡ as $d‹ˆ„‡»¡ => $bŒÙàª®ê) { $FË¸ß•õÉó[] = array($EÎ¾æ‘Ì±[1688], $bŒÙàª®ê, $EÎ¾æ‘Ì±[1711], $d‹ˆ„‡»¡ + 1); } $this->saveAll($FË¸ß•õÉó); } public function listData() { $fáÙ„ÃÜ¸á = $this->_makeOrder()->selectPage(50); $this->_listDataApply($fáÙ„ÃÜ¸á[$_SERVER[¬¦ã¾][367]]); return $fáÙ„ÃÜ¸á; } private function _makeOrder($bÃìĞâè¬¿ = '') { goto aß´ÍäøŞì; f‘¾¢›ñõ«: $bÃìĞâè¬¿ = $bÃìĞâè¬¿ . "{$c°ËºÔ­©Â}\x20{$AôÃììê˜Â}\x2c\x20\147\x72\x6f\165\160\111\104\x20\x61\x73\x63"; return $this->order($bÃìĞâè¬¿); goto a´îÈ—ËÚÛ; aß´ÍäøŞì: $EÍ¨íÓ®Œö =& $_SERVER[¬¦ã¾]; $Dô²Ÿó“ªí = array($EÍ¨íÓ®Œö[1688], $EÍ¨íÓ®Œö[28], $EÍ¨íÓ®Œö[1674], $EÍ¨íÓ®Œö[194]); $BöøÀºƒ¯¹ = array($EÍ¨íÓ®Œö[428] => $EÍ¨íÓ®Œö[429], $EÍ¨íÓ®Œö[430] => $EÍ¨íÓ®Œö[431]); goto C°¨·¯¬…’; C°¨·¯¬…’: $c°ËºÔ­©Â = Input::get($EÍ¨íÓ®Œö[435], $EÍ¨íÓ®Œö[7], $EÍ¨íÓ®Œö[1692], $Dô²Ÿó“ªí); $AôÃììê˜Â = Input::get($EÍ¨íÓ®Œö[436], $EÍ¨íÓ®Œö[7], $EÍ¨íÓ®Œö[1770], array($EÍ¨íÓ®Œö[1770], $EÍ¨íÓ®Œö[430])); $AôÃììê˜Â = $BöøÀºƒ¯¹[$AôÃììê˜Â]; goto f‘¾¢›ñõ«; a´îÈ—ËÚÛ: } public function listChild($Dô¥–Â¯ÔÏ) { $aåÓ‚”†¿Ò =& $_SERVER[¬¦ã¾]; $Fñ“ÀÚ™¹¯ = $this->where(array($aåÓ‚”†¿Ò[478] => $Dô¥–Â¯ÔÏ))->_makeOrder()->selectPage(200); $this->_listDataApply($Fñ“ÀÚ™¹¯[$aåÓ‚”†¿Ò[367]]); return $Fñ“ÀÚ™¹¯; } public function listByID($F¥ŒŒ„Ë®”) { $d–Ÿ¹½ŸÒ =& $_SERVER[¬¦ã¾]; if (!$F¥ŒŒ„Ë®”) { return array(); } $c´©ĞÈ¨Ã® = array($d–Ÿ¹½ŸÒ[1688] => array($d–Ÿ¹½ŸÒ[7], $F¥ŒŒ„Ë®”)); $A·Ğ¸Ò®º = $this->where($c´©ĞÈ¨Ã®)->select(); $this->_listDataApply($A·Ğ¸Ò®º); return $A·Ğ¸Ò®º; } public function listSearch($Cµ¹ñ˜§óÆ) { goto A¯¥÷Æ…Ä‘; A¯¥÷Æ…Ä‘: $e–ŸÙÏ«º =& $_SERVER[¬¦ã¾]; $bÛ¦Å¼·“« = $Cµ¹ñ˜§óÆ[$e–ŸÙÏ«º[1771]]; $B›ê»Û‹Ì˜ = isset($Cµ¹ñ˜§óÆ[$e–ŸÙÏ«º[1772]]) ? $Cµ¹ñ˜§óÆ[$e–ŸÙÏ«º[1772]] : !1; goto E§Ç¯°¦; E§Ç¯°¦: if (!trim($bÛ¦Å¼·“«)) { return !1; } $bÛ¦Å¼·“« = str_replace($e–ŸÙÏ«º[1773], $e–ŸÙÏ«º[1774], $bÛ¦Å¼·“«); $Eßˆ¦«Ë‘Ã = array($e–ŸÙÏ«º[1688] => array($e–ŸÙÏ«º[380], "{$bÛ¦Å¼·“«}\x25"), $e–ŸÙÏ«º[28] => array($e–ŸÙÏ«º[380], "\x25{$bÛ¦Å¼·“«}\45"), $e–ŸÙÏ«º[948] => $e–ŸÙÏ«º[1775]); goto BÜÆÜñïÚÙ; BÜÆÜñïÚÙ: if ($B›ê»Û‹Ì˜) { $F´Ç†ùœ‹ = $this->getInfoSimple($B›ê»Û‹Ì˜); $c„¾›©Ê“Ó = $F´Ç†ùœ‹[$e–ŸÙÏ«º[487]] . $B›ê»Û‹Ì˜ . $e–ŸÙÏ«º[513]; $Eßˆ¦«Ë‘Ã = array($Eßˆ¦«Ë‘Ã, array($e–ŸÙÏ«º[487] => array($e–ŸÙÏ«º[380], $c„¾›©Ê“Ó))); } $Eßˆ¦«Ë‘Ã = $this->parseWhereLike($Eßˆ¦«Ë‘Ã); $B¦ø÷™ĞÑ = $this->_makeOrder()->where($Eßˆ¦«Ë‘Ã)->selectPage(20); goto E¦¨­ÍÂù; B¬«‰àŒÃ«: return $B¦ø÷™ĞÑ; goto A¥÷†«é÷¸; E¦¨­ÍÂù: $B¦ø÷™ĞÑ = $B¦ø÷™ĞÑ ? $B¦ø÷™ĞÑ : array($e–ŸÙÏ«º[367] => array(), $e–ŸÙÏ«º[364] => array()); if (!$B¦ø÷™ĞÑ || count($B¦ø÷™ĞÑ[$e–ŸÙÏ«º[367]]) < 5 && Input::check($bÛ¦Å¼·“«, $e–ŸÙÏ«º[316])) { goto DéĞÚæ¾™; a¶´‡¬ÌÖã: $b®Àòè¦ì­ = array_merge($DÚ±«‘¦¤ß, $b“ß¶Ø“¥°, $B¦ø÷™ĞÑ[$e–ŸÙÏ«º[367]]); $B¦ø÷™ĞÑ[$e–ŸÙÏ«º[367]] = array_unique_by_key($b®Àòè¦ì­, $e–ŸÙÏ«º[1688]); $B¦ø÷™ĞÑ[$e–ŸÙÏ«º[364]][$e–ŸÙÏ«º[365]] = count($B¦ø÷™ĞÑ[$e–ŸÙÏ«º[367]]); goto dØ¼—Ê²¹; DéĞÚæ¾™: $A‡’î§ŠÒö = $this->groupChildrenAll($B›ê»Û‹Ì˜); $DÚ±«‘¦¤ß = $this->_searchFromMeta($e–ŸÙÏ«º[443], $bÛ¦Å¼·“«, 10, $A‡’î§ŠÒö); $b“ß¶Ø“¥° = $this->_searchFromMeta($e–ŸÙÏ«º[444], $bÛ¦Å¼·“«, 10, $A‡’î§ŠÒö); goto a¶´‡¬ÌÖã; dØ¼—Ê²¹: $B¦ø÷™ĞÑ[$e–ŸÙÏ«º[364]][$e–ŸÙÏ«º[366]] = ceil($B¦ø÷™ĞÑ[$e–ŸÙÏ«º[364]][$e–ŸÙÏ«º[365]] / $B¦ø÷™ĞÑ[$e–ŸÙÏ«º[364]][$e–ŸÙÏ«º[361]]); goto bê«‰µ¸±¶; bê«‰µ¸±¶: } $this->_listDataApply($B¦ø÷™ĞÑ[$e–ŸÙÏ«º[367]]); goto B¬«‰àŒÃ«; A¥÷†«é÷¸: } protected function groupChildrenAll($a¯ïÖä¤) { $fÏÂèÄŒ‰å =& $_SERVER[¬¦ã¾]; if (!$a¯ïÖä¤) { return !1; } if (is_string($a¯ïÖä¤)) { $a¯ïÖä¤ = array($a¯ïÖä¤); } $d‰Å¾ÈÄô“ = $a¯ïÖä¤; foreach ($a¯ïÖä¤ as $bµ¤±ò¾‚â) { $Fö²®š» = $this->getInfoSimple($bµ¤±ò¾‚â); $Cİá‡Ûë¶ = array($fÏÂèÄŒ‰å[487] => array($fÏÂèÄŒ‰å[380], $Fö²®š»[$fÏÂèÄŒ‰å[487]] . $bµ¤±ò¾‚â . $fÏÂèÄŒ‰å[513])); $e¿š‹Õë† = $this->field($fÏÂèÄŒ‰å[1688])->where($Cİá‡Ûë¶)->select(); $d‰Å¾ÈÄô“ = array_merge($d‰Å¾ÈÄô“, array_to_keyvalue($e¿š‹Õë†, $fÏÂèÄŒ‰å[33], $fÏÂèÄŒ‰å[1688])); } return array_unique($d‰Å¾ÈÄô“); } private function _searchFromMeta($EùÜ‰Â¢×, $Cì…±Â¨àä, $c…Ò«·õÏ‚, $cºÏ¦ÂÆ–) { goto E²§±µ¾ˆÙ; B°Ï¶åáÖ‚: if (!$câöåŒÃ) { return array(); } $câöåŒÃ = array_to_keyvalue($câöåŒÃ, $a÷†¸‹˜¤ª[33], $a÷†¸‹˜¤ª[1688]); $e‡½Éµ¡Ú› = $this->where(array($a÷†¸‹˜¤ª[1766] => array($a÷†¸‹˜¤ª[7], $câöåŒÃ)))->select(); goto eŸãÉ„î²¤; d Ò§ºô¶Â: $c¡„‘İ‡Î = $this->parseWhereLike($c¡„‘İ‡Î); if ($cºÏ¦ÂÆ–) { $c¡„‘İ‡Î[$a÷†¸‹˜¤ª[1688]] = array($a÷†¸‹˜¤ª[7], $cºÏ¦ÂÆ–); } $câöåŒÃ = Model($a÷†¸‹˜¤ª[1776])->where($c¡„‘İ‡Î)->limit($c…Ò«·õÏ‚)->select(); goto B°Ï¶åáÖ‚; E²§±µ¾ˆÙ: $a÷†¸‹˜¤ª =& $_SERVER[¬¦ã¾]; $Cì…±Â¨àä = strtolower($Cì…±Â¨àä); $c¡„‘İ‡Î = array($a÷†¸‹˜¤ª[93] => $EùÜ‰Â¢×, $a÷†¸‹˜¤ª[372] => array($a÷†¸‹˜¤ª[380], "\45{$Cì…±Â¨àä}\45")); goto d Ò§ºô¶Â; eŸãÉ„î²¤: if (!$e‡½Éµ¡Ú›) { return array(); } return $e‡½Éµ¡Ú›; goto d·¡ÌêË¸; d·¡ÌêË¸: } protected function _listDataApplyItem($f“ÚÇ†‡šù) { $D¶„ê‡»ÈÙ = array($f“ÚÇ†‡šù); $this->_listDataApply($D¶„ê‡»ÈÙ); return $D¶„ê‡»ÈÙ[0]; } protected function _listDataApply(&$AŒÛÚõ¬) { goto dÁ“²õ´®; d¯í¬¦Ó: $this->_listAppendChildren($AŒÛÚõ¬); $this->_listAppendChildrenMember($AŒÛÚõ¬); $this->_listAppendMeta($AŒÛÚõ¬, $cÄøîäÌÆÆ); goto Bƒ†“¸œˆƒ; dÁ“²õ´®: $a³ˆİÔ¸ƒé =& $_SERVER[¬¦ã¾]; if (!$AŒÛÚõ¬) { return; } $cÄøîäÌÆÆ = array_to_keyvalue($AŒÛÚõ¬, $a³ˆİÔ¸ƒé[33], $a³ˆİÔ¸ƒé[1688]); goto d¯í¬¦Ó; Bƒ†“¸œˆƒ: $this->_listAppendParent($AŒÛÚõ¬); $this->_listAppendSourceRoot($AŒÛÚõ¬, $cÄøîäÌÆÆ); goto C©ÃÛáÏ; C©ÃÛáÏ: } private function _listAppendChildren(&$F—¥¥ç•ô) { goto cÚ¥°Ìêóó; cÎˆ¹†¤ Ê: $Dé¶ìÎ”¼§ = array($F×Š¥ˆÙí¨[478], $F×Š¥ˆÙí¨[1777] => $F×Š¥ˆÙí¨[480]); $eÔõ­›¶ÜÛ = $this->field($Dé¶ìÎ”¼§)->where($aÊˆáÎ…ã)->group($F×Š¥ˆÙí¨[478])->select(); $Dù´Ãëóµ = array_to_keyvalue($eÔõ­›¶ÜÛ, $F×Š¥ˆÙí¨[478], $F×Š¥ˆÙí¨[480]); goto cÜ‰˜ñŒğ; cÚ¥°Ìêóó: $F×Š¥ˆÙí¨ =& $_SERVER[¬¦ã¾]; $a±Æ…šŒõó = array_to_keyvalue($F—¥¥ç•ô, $F×Š¥ˆÙí¨[33], $F×Š¥ˆÙí¨[1688]); $aÊˆáÎ…ã = array($F×Š¥ˆÙí¨[478] => array($F×Š¥ˆÙí¨[7], $a±Æ…šŒõó)); goto cÎˆ¹†¤ Ê; cÜ‰˜ñŒğ: foreach ($F—¥¥ç•ô as &$d×õ‚Ğš‰ª) { $f–Àóæ‹‘˜ = $d×õ‚Ğš‰ª[$F×Š¥ˆÙí¨[1688]]; $d×õ‚Ğš‰ª[$F×Š¥ˆÙí¨[1778]] = isset($Dù´Ãëóµ[$f–Àóæ‹‘˜]) ? intval($Dù´Ãëóµ[$f–Àóæ‹‘˜]) : !1; } unset($d×õ‚Ğš‰ª); goto cÆÆö³Ñ„ª; cÆÆö³Ñ„ª: } private function _listAppendChildrenMember(&$Cê·šºµæÒ) { goto DìÁÀé’æœ; DìÁÀé’æœ: $dğŸ®•¿ßä =& $_SERVER[¬¦ã¾]; $b¥çŸ®å°‹ = array_to_keyvalue($Cê·šºµæÒ, $dğŸ®•¿ßä[33], $dğŸ®•¿ßä[1688]); $e®¸‰Ô× = array($dğŸ®•¿ßä[1688] => array($dğŸ®•¿ßä[7], $b¥çŸ®å°‹)); goto FòÄ§¦öß; FòÄ§¦öß: $F²‡Û‡Ÿ‘¿ = array($dğŸ®•¿ßä[1688], $dğŸ®•¿ßä[1777] => $dğŸ®•¿ßä[480]); $d©ƒŞØ… = Model($dğŸ®•¿ßä[1769])->field($F²‡Û‡Ÿ‘¿)->where($e®¸‰Ô×)->group($dğŸ®•¿ßä[1688])->select(); $eòÆŸË±¤” = array_to_keyvalue($d©ƒŞØ…, $dğŸ®•¿ßä[1688], $dğŸ®•¿ßä[480]); goto B¦Ç‚Å; B¦Ç‚Å: foreach ($Cê·šºµæÒ as &$fƒÕ‘½ğÂ) { $CŒÍø°Î˜ = $fƒÕ‘½ğÂ[$dğŸ®•¿ßä[1688]]; $fƒÕ‘½ğÂ[$dğŸ®•¿ßä[1779]] = isset($eòÆŸË±¤”[$CŒÍø°Î˜]) ? intval($eòÆŸË±¤”[$CŒÍø°Î˜]) : !1; } unset($fƒÕ‘½ğÂ); goto e‡‘¿ç×ø—; e‡‘¿ç×ø—: } private function _listAppendMeta(&$D‰èíé”¶ç, $e‚‚«øØÛ) { goto eâ÷Ñ«—Œ¹; eâ÷Ñ«—Œ¹: $a§ó…Àø±Ì =& $_SERVER[¬¦ã¾]; $e†Âï¬öƒº = array($a§ó…Àø±Ì[1688] => array($a§ó…Àø±Ì[7], $e‚‚«øØÛ)); $A÷ğ¢÷®‹ = Model($a§ó…Àø±Ì[1768])->where($e†Âï¬öƒº)->select(); goto Eèí¤†ƒšÑ; Eèí¤†ƒšÑ: $A÷ğ¢÷®‹ = array_to_keyvalue_group($A÷ğ¢÷®‹, $a§ó…Àø±Ì[1688]); foreach ($A÷ğ¢÷®‹ as &$Aêñƒ¦ô¯÷) { $Aêñƒ¦ô¯÷ = array_to_keyvalue($Aêñƒ¦ô¯÷, $a§ó…Àø±Ì[93], $a§ó…Àø±Ì[372]); } unset($Aêñƒ¦ô¯÷); goto Bğï«½îœ¹; Bğï«½îœ¹: foreach ($D‰èíé”¶ç as &$CàÖèâ«¦à) { $CàÖèâ«¦à[$a§ó…Àø±Ì[445]] = array(); if (isset($A÷ğ¢÷®‹[$CàÖèâ«¦à[$a§ó…Àø±Ì[1688]]])) { $CàÖèâ«¦à[$a§ó…Àø±Ì[445]] = $A÷ğ¢÷®‹[$CàÖèâ«¦à[$a§ó…Àø±Ì[1688]]]; } } unset($CàÖèâ«¦à); goto e Ğ§°¡‰„; e Ğ§°¡‰„: } protected function parentLevelArray($Cœ–õéÁ») { $a‡¯ï°½Í’ =& $_SERVER[¬¦ã¾]; $Cœ–õéÁ» = explode($a‡¯ï°½Í’[47], trim($Cœ–õéÁ», $a‡¯ï°½Í’[47])); $Cœ–õéÁ» = array_remove_value($Cœ–õéÁ», $a‡¯ï°½Í’[191]); return $Cœ–õéÁ»; } private function _listAppendParent(&$d¿È–§½´¯) { goto eÎ„•¢Ñò; d´„™‰Û: if ($GLOBALS[$EÀÏÑ‚ˆæ¼[485]] == $EÀÏÑ‚ˆæ¼[87]) { $Eˆ°İ ğµ = !1; } foreach ($d¿È–§½´¯ as &$A‹¶ôç‹µŒ) { $AÛì‘øË×Î = $this->parentLevelArray($A‹¶ôç‹µŒ[$EÀÏÑ‚ˆæ¼[487]]); $CÆøë™×Š– = $EÀÏÑ‚ˆæ¼[33]; foreach ($AÛì‘øË×Î as $Cã¨„¤Ü => $bªˆ„œÈÏ) { if ($Eˆ°İ ğµ && $Cã¨„¤Ü == 0) { continue; } $CÆøë™×Š– .= $dÉÔİĞ’“¤[$bªˆ„œÈÏ] . $EÀÏÑ‚ˆæ¼[8]; } if ($AÛì‘øË×Î) { $CÆøë™×Š– .= $A‹¶ôç‹µŒ[$EÀÏÑ‚ˆæ¼[28]]; } $A‹¶ôç‹µŒ[$EÀÏÑ‚ˆæ¼[491]] = str_replace($EÀÏÑ‚ˆæ¼[496], $EÀÏÑ‚ˆæ¼[8], $CÆøë™×Š–); } unset($A‹¶ôç‹µŒ); goto FùÏÜ¥õö†; eÎ„•¢Ñò: $EÀÏÑ‚ˆæ¼ =& $_SERVER[¬¦ã¾]; $dÉÔİĞ’“¤ = array(); foreach ($d¿È–§½´¯ as &$A‹¶ôç‹µŒ) { $dÉÔİĞ’“¤[$A‹¶ôç‹µŒ[$EÀÏÑ‚ˆæ¼[1688]]] = $A‹¶ôç‹µŒ[$EÀÏÑ‚ˆæ¼[28]]; $AÛì‘øË×Î = $this->parentLevelArray($A‹¶ôç‹µŒ[$EÀÏÑ‚ˆæ¼[487]]); foreach ($AÛì‘øË×Î as $bªˆ„œÈÏ) { if (!isset($dÉÔİĞ’“¤[$bªˆ„œÈÏ])) { $dÉÔİĞ’“¤[$bªˆ„œÈÏ] = 0; } } } goto dö®Ë„İÈ¦; dö®Ë„İÈ¦: unset($A‹¶ôç‹µŒ); foreach ($dÉÔİĞ’“¤ as $Cã¨„¤Ü => $a§’Ç™ğ³¨) { if ($a§’Ç™ğ³¨) { continue; } $c±¬¢İ éÕ = $this->getInfoSimple($Cã¨„¤Ü); $dÉÔİĞ’“¤[$Cã¨„¤Ü] = $c±¬¢İ éÕ[$EÀÏÑ‚ˆæ¼[28]]; } $Eˆ°İ ğµ = $GLOBALS[$EÀÏÑ‚ˆæ¼[6]][$EÀÏÑ‚ˆæ¼[88]][$EÀÏÑ‚ˆæ¼[1780]]; goto d´„™‰Û; FùÏÜ¥õö†: } private function _listAppendSourceRoot(&$aíÁÊ¾Ï¨, $BŒ“ˆ‡—Š) { goto dÃ®³ìÏ¿Š; dôï…¸÷ÂÍ: $fÍœù¸Úï = Model($cğóæ®÷Çˆ[782])->order($cğóæ®÷Çˆ[1782])->field($b„æ ƒõœ—)->where($bùÂºº§Ñ‚)->select(); $fÍœù¸Úï = array_to_keyvalue($fÍœù¸Úï, $cğóæ®÷Çˆ[484]); $fÍœù¸Úï = array_remove_key($fÍœù¸Úï, $cğóæ®÷Çˆ[484]); goto cÄ‚’ÌÇ; dÃ®³ìÏ¿Š: $cğóæ®÷Çˆ =& $_SERVER[¬¦ã¾]; $bùÂºº§Ñ‚ = array($cğóæ®÷Çˆ[404] => SourceModel::TYPE_GROUP, $cğóæ®÷Çˆ[478] => 0, $cğóæ®÷Çˆ[484] => array($cğóæ®÷Çˆ[7], $BŒ“ˆ‡—Š)); $b„æ ƒõœ— = $cğóæ®÷Çˆ[1781]; goto dôï…¸÷ÂÍ; cÄ‚’ÌÇ: foreach ($aíÁÊ¾Ï¨ as &$AÈÚŸë¤¹¿) { $AÈÚŸë¤¹¿[$cğóæ®÷Çˆ[85]] = $fÍœù¸Úï[$AÈÚŸë¤¹¿[$cğóæ®÷Çˆ[1688]]] ? $fÍœù¸Úï[$AÈÚŸë¤¹¿[$cğóæ®÷Çˆ[1688]]] : array(); } unset($AÈÚŸë¤¹¿); goto cÜ—Ÿ¦ñÃÒ; cÜ—Ÿ¦ñÃÒ: } protected function groupMerge($B ß¯éÁõ) { $B ß¯éÁõ = array_values(array_unique($B ß¯éÁõ)); $aÕµ«Û‚§ = array(); for ($fÆ„ÀŸ™î = 0; $fÆ„ÀŸ™î < count($B ß¯éÁõ); $fÆ„ÀŸ™î++) { $BÏ×ÊÔÎƒ = !1; for ($e×Ú­ÉÃïÁ = 0; $e×Ú­ÉÃïÁ < count($B ß¯éÁõ); $e×Ú­ÉÃïÁ++) { if ($fÆ„ÀŸ™î == $e×Ú­ÉÃïÁ) { continue; } if ($this->isParentOf($B ß¯éÁõ[$e×Ú­ÉÃïÁ], $B ß¯éÁõ[$fÆ„ÀŸ™î])) { $BÏ×ÊÔÎƒ = !0; break; } } if (!$BÏ×ÊÔÎƒ) { $aÕµ«Û‚§[] = $B ß¯éÁõ[$fÆ„ÀŸ™î]; } } return $aÕµ«Û‚§; } protected function isParentOf($e•¶öâ÷«, $E¨ôÍ¥ŞÜÆ) { goto CÍ¨ˆàŞ‹¤; CÍ¨ˆàŞ‹¤: $C’•È»ìù =& $_SERVER[¬¦ã¾]; if (!$e•¶öâ÷« || !$E¨ôÍ¥ŞÜÆ || $e•¶öâ÷« == $E¨ôÍ¥ŞÜÆ) { return !1; } $D½â‘ÚÔ·­ = $this->getInfoSimple($e•¶öâ÷«); goto b¹ÛØ‚§Òø; béğËÀ…ŸÚ: return !1; goto a´ˆÏ½÷Ù±; b¹ÛØ‚§Òø: $CË¸‹±à‘á = $this->getInfoSimple($E¨ôÍ¥ŞÜÆ); $B‚™ŞëŠÈŸ = $D½â‘ÚÔ·­[$C’•È»ìù[487]] . $e•¶öâ÷« . $C’•È»ìù[47]; if (substr($CË¸‹±à‘á[$C’•È»ìù[487]], 0, strlen($B‚™ŞëŠÈŸ)) == $B‚™ŞëŠÈŸ) { return !0; } goto béğËÀ…ŸÚ; a´ˆÏ½÷Ù±: } public function groupShowRoot($CĞœ™ïŞõ, $E˜¹›ŒŠßÏ = false) { goto E¤åé´¤ä; C¹ˆ‚ëÈ¯: return $aİÄ÷Ãë¨Í; goto FÃÉ¦ ½Ä; E¤åé´¤ä: $C‰…¸‚íô± =& $_SERVER[¬¦ã¾]; $Aî”ìÓª¡‘ = $this->getInfo($CĞœ™ïŞõ); if (!$Aî”ìÓª¡‘) { return array(); } goto CÔ¡ƒšãÏ; e³†åî‹Ñé: if ($E˜¹›ŒŠßÏ && count($BÙ‡ï›ÖÏ¦) == 1) { return $aİÄ÷Ãë¨Í; } if (!$Aî”ìÓª¡‘[$C‰…¸‚íô±[445]] || !isset($Aî”ìÓª¡‘[$C‰…¸‚íô±[445]][$C‰…¸‚íô±[1764]]) || $Aî”ìÓª¡‘[$C‰…¸‚íô±[445]][$C‰…¸‚íô±[1764]] == $C‰…¸‚íô±[1738]) { return $this->groupShowRoot($BÙ‡ï›ÖÏ¦[count($BÙ‡ï›ÖÏ¦) - 1], $E˜¹›ŒŠßÏ); } if ($Aî”ìÓª¡‘[$C‰…¸‚íô±[445]][$C‰…¸‚íô±[1764]] == $C‰…¸‚íô±[357]) { $fï‘ê¡Â° = explode($C‰…¸‚íô±[47], $Aî”ìÓª¡‘[$C‰…¸‚íô±[445]][$C‰…¸‚íô±[1765]]); if ($fï‘ê¡Â°) { $aİÄ÷Ãë¨Í = array_merge($aİÄ÷Ãë¨Í, $fï‘ê¡Â°); } } goto C¹ˆ‚ëÈ¯; CÔ¡ƒšãÏ: $BÙ‡ï›ÖÏ¦ = $this->parentLevelArray($Aî”ìÓª¡‘[$C‰…¸‚íô±[487]]); $aİÄ÷Ãë¨Í = array($CĞœ™ïŞõ); if (count($BÙ‡ï›ÖÏ¦) == 0) { return $aİÄ÷Ãë¨Í; } goto e³†åî‹Ñé; FÃÉ¦ ½Ä: } protected function resetParentLevel() { $a¸ŞâĞßõÂ =& $_SERVER[¬¦ã¾]; $eñ³ó‹–¶£ = $a¸ŞâĞßõÂ[1688]; $b¼Ã®ğ½¿Ã = $this->select(); $b¼Ã®ğ½¿Ã = array_to_keyvalue($b¼Ã®ğ½¿Ã, $eñ³ó‹–¶£); foreach ($b¼Ã®ğ½¿Ã as $aåµŞà¯) { goto FôÈßöÃÆö; Cºª¦ˆÀÃ’: $BÂÑ‡Úæá[] = 0; $BÂÑ‡Úæá = $a¸ŞâĞßõÂ[47] . implode($a¸ŞâĞßõÂ[47], array_reverse($BÂÑ‡Úæá)) . $a¸ŞâĞßõÂ[47]; $this->setNamePinyin($aåµŞà¯[$eñ³ó‹–¶£], $aåµŞà¯[$a¸ŞâĞßõÂ[28]]); goto cµ­ÃÌ’Ø; FôÈßöÃÆö: $C´Ï‹‡ÎÓå = $aåµŞà¯; $BÂÑ‡Úæá = array(); while ($C´Ï‹‡ÎÓå[$a¸ŞâĞßõÂ[478]] != 0) { $BÂÑ‡Úæá[] = $C´Ï‹‡ÎÓå[$a¸ŞâĞßõÂ[478]]; $C´Ï‹‡ÎÓå = $b¼Ã®ğ½¿Ã[$C´Ï‹‡ÎÓå[$a¸ŞâĞßõÂ[478]]]; } goto Cºª¦ˆÀÃ’; cµ­ÃÌ’Ø: $this->where(array($eñ³ó‹–¶£ => $aåµŞà¯[$eñ³ó‹–¶£]))->save(array($a¸ŞâĞßõÂ[553] => $BÂÑ‡Úæá)); goto aŸ¿¾†»á; aŸ¿¾†»á: } return $b¼Ã®ğ½¿Ã; } public function groupNameAuto($FœÂøïÉÊ¹, $B¹ƒ·İ¡©) { $a©õ ôÆö÷ =& $_SERVER[¬¦ã¾]; $AÔ•ŒÃ”ˆğ = $this->where(array($a©õ ôÆö÷[394] => $FœÂøïÉÊ¹))->getField($a©õ ôÆö÷[28], !0); if (!$AÔ•ŒÃ”ˆğ || !in_array($B¹ƒ·İ¡©, $AÔ•ŒÃ”ˆğ)) { return $B¹ƒ·İ¡©; } for ($BÇ„Ç‹¥¤Ê = 1; $BÇ„Ç‹¥¤Ê <= count($AÔ•ŒÃ”ˆğ) + 1; $BÇ„Ç‹¥¤Ê++) { $eÄ’—Œø²‚ = $B¹ƒ·İ¡© . "\50{$BÇ„Ç‹¥¤Ê}\51"; if (!in_array($eÄ’—Œø²‚, $AÔ•ŒÃ”ˆğ)) { return $eÄ’—Œø²‚; } } } public function groupSwitch($bŞ«ò’, $e²õÃœÀ) { goto b»â¡¦œò; F®·îÁËÕ: $EÖ‰øÆÖ½ï = array($CÎ¸¯ìùğğ[404] => 2, $CÎ¸¯ìùğğ[478] => 0, $CÎ¸¯ìùğğ[403] => 1, $CÎ¸¯ìùğğ[484] => array($CÎ¸¯ìùğğ[7], array($bŞ«ò’, $e²õÃœÀ))); $F¯Ûã¬²…´ = Model($CÎ¸¯ìùğğ[782])->where($EÖ‰øÆÖ½ï)->field($CÎ¸¯ìùğğ[1784])->select(); $F¯Ûã¬²…´ = array_to_keyvalue($F¯Ûã¬²…´, $CÎ¸¯ìùğğ[484], $CÎ¸¯ìùğğ[395]); goto a©Ñ¾§Ü–; f¿İöÍèğë: $bõÜ†¸Ì‚ = array_to_keyvalue($bõÜ†¸Ì‚, $CÎ¸¯ìùğğ[1688]); if (!isset($bõÜ†¸Ì‚[$bŞ«ò’]) || !isset($bõÜ†¸Ì‚[$e²õÃœÀ]) || $bõÜ†¸Ì‚[$bŞ«ò’][$CÎ¸¯ìùğğ[478]] == 0) { return !1; } $EÖ‰øÆÖ½ï = array($CÎ¸¯ìùğğ[1688] => $bŞ«ò’); goto CÍ”Ÿä°©µ; CÍ”Ÿä°©µ: $eîÌÚ¾æ÷ = Model($CÎ¸¯ìùğğ[1769])->where($EÖ‰øÆÖ½ï)->select(); if (!$eîÌÚ¾æ÷) { $eîÌÚ¾æ÷ = array(); } foreach ($eîÌÚ¾æ÷ as $Bª¹›©ÎÀ) { $CëöÀØ´ê = $Bª¹›©ÎÀ[$CÎ¸¯ìùğğ[1520]]; $EÖ‰øÆÖ½ï = array($CÎ¸¯ìùğğ[1520] => $CëöÀØ´ê, $CÎ¸¯ìùğğ[1688] => $e²õÃœÀ); $d—«“‡¨µ = Model($CÎ¸¯ìùğğ[1769])->where($EÖ‰øÆÖ½ï)->find(); if (!$d—«“‡¨µ) { $eªÇ×ç µ = array($e²õÃœÀ => $Bª¹›©ÎÀ[$CÎ¸¯ìùğğ[1783]]); Model($CÎ¸¯ìùğğ[506])->userGroupAdd($CëöÀØ´ê, $eªÇ×ç µ); } Model($CÎ¸¯ìùğğ[506])->userGroupRemove($CëöÀØ´ê, $bŞ«ò’); } goto F®·îÁËÕ; a©Ñ¾§Ü–: $bñ†ŸÂ×˜ = !empty($F¯Ûã¬²…´[$bŞ«ò’]) ? $F¯Ûã¬²…´[$bŞ«ò’] : !1; if ($bñ†ŸÂ×˜) { goto C‚£ª‡£Ú; bô‹¹÷–•Í: $Dß©ŸÚ…¶ = array($CÎ¸¯ìùğğ[484] => $e²õÃœÀ); Model($CÎ¸¯ìùğğ[1786])->where($EÖ‰øÆÖ½ï)->save($Dß©ŸÚ…¶); Model($CÎ¸¯ìùğğ[1787])->where($EÖ‰øÆÖ½ï)->save($Dß©ŸÚ…¶); goto B‡ğÑàœÇ; B¬¶ğÕ“Ö‘: $F¯Ûã¬²…´ = Model($CÎ¸¯ìùğğ[782])->where($EÖ‰øÆÖ½ï)->field($CÎ¸¯ìùğğ[1785])->select(); if (!$F¯Ûã¬²…´) { $F¯Ûã¬²…´ = array(); } Model($CÎ¸¯ìùğğ[782])->moveClearAuth = !1; goto cÙèÓ—ó‡Î; C‚£ª‡£Ú: if (!$F¯Ûã¬²…´[$e²õÃœÀ]) { $F¯Ûã¬²…´[$e²õÃœÀ] = Model($CÎ¸¯ìùğğ[782])->groupRootAdd($e²õÃœÀ); } $d†›ê‡£°¤ = $F¯Ûã¬²…´[$e²õÃœÀ]; $EÖ‰øÆÖ½ï = array($CÎ¸¯ìùğğ[478] => $bñ†ŸÂ×˜); goto B¬¶ğÕ“Ö‘; cÙèÓ—ó‡Î: foreach ($F¯Ûã¬²…´ as $fˆÆ‹˜á‹„) { $CÅçØ¾ïØ¾ = $fˆÆ‹˜á‹„[$CÎ¸¯ìùğğ[403]] == $CÎ¸¯ìùğğ[87] ? REPEAT_RENAME_FOLDER : REPEAT_RENAME; Model($CÎ¸¯ìùğğ[782])->move($fˆÆ‹˜á‹„[$CÎ¸¯ìùğğ[395]], $d†›ê‡£°¤, $CÅçØ¾ïØ¾); } Model($CÎ¸¯ìùğğ[782])->moveClearAuth = !0; $EÖ‰øÆÖ½ï = array($CÎ¸¯ìùğğ[404] => 2, $CÎ¸¯ìùğğ[484] => $bŞ«ò’); goto bô‹¹÷–•Í; B‡ğÑàœÇ: } $this->_changeChildLevel($bõÜ†¸Ì‚[$bŞ«ò’], $bõÜ†¸Ì‚[$e²õÃœÀ], !0); goto Eö°æšôà; b»â¡¦œò: $CÎ¸¯ìùğğ =& $_SERVER[¬¦ã¾]; $EÖ‰øÆÖ½ï = array($CÎ¸¯ìùğğ[1688] => array($CÎ¸¯ìùğğ[7], array($bŞ«ò’, $e²õÃœÀ))); $bõÜ†¸Ì‚ = $this->where($EÖ‰øÆÖ½ï)->select(); goto f¿İöÍèğë; Eö°æšôà: $this->where(array($CÎ¸¯ìùğğ[478] => $bŞ«ò’))->save(array($CÎ¸¯ìùğğ[478] => $e²õÃœÀ)); return !0; goto F™ßÄˆÃ§; F™ßÄˆÃ§: } } goto fœÍ»ø°Â„; f‘ìÆª¶Î: class TaskQueue { const MAX_LENGTH = 1000; const QUEUE_LENGTH = "\x74\141\x73\153\x51\165\145\165\145\114\x65\156\x67\x74\150"; const QUEUE_DATA = "\164\141\163\x6b\x51\x75\x65\x75\145\x44\x61\164\x61"; public static $listData = false; public static function initTask() { } public static function add($d¡¿¢…Ô¨, $AÏò‹µäÉ‹ = array(), $D¥‹²°Ùª = '', $F¶ ÊãÃº§ = '') { $b†–„ï•·é =& $_SERVER[¬¦ã¾]; if (self::$listData === !1) { self::$listData = self::getAll(); } if (count(self::$listData) >= self::MAX_LENGTH) { return !1; } if ($F¶ ÊãÃº§ && array_find_by_field(self::$listData, $b†–„ï•·é[93], $F¶ ÊãÃº§)) { return !0; } self::$listData[] = array($b†–„ï•·é[262] => $d¡¿¢…Ô¨, $b†–„ï•·é[1594] => $AÏò‹µäÉ‹, $b†–„ï•·é[431] => $D¥‹²°Ùª, $b†–„ï•·é[93] => $F¶ ÊãÃº§); return !0; } public static function addSubmit() { $F£ –Ì‚ŞŒ =& $_SERVER[¬¦ã¾]; if (!self::$listData || count(self::$listData) == 0) { return; } write_log($F£ –Ì‚ŞŒ[1595] . json_encode_force(array_to_keyvalue(self::$listData, $F£ –Ì‚ŞŒ[33], $F£ –Ì‚ŞŒ[431])), $F£ –Ì‚ŞŒ[1596]); self::setAll(self::$listData); self::$listData = !1; } public static function addNow($Cì•ç±¤Ş, $d‡¥îÀâßœ = array(), $f¼•‘œÄŞ = '', $eô´ãìè– = '') { goto C–ŸãïÕô; C‡Î‹Å¾à¸: self::setAll($cÂ×²¶¹õæ); return !0; goto DÜ¤£è; C–ŸãïÕô: $Dã¯­Ù®ªÈ =& $_SERVER[¬¦ã¾]; if (self::count() >= self::MAX_LENGTH) { return !1; } $cÂ×²¶¹õæ = self::getAll(); goto EŠ³–Ë§ÔŠ; EŠ³–Ë§ÔŠ: if ($eô´ãìè– && array_find_by_field($cÂ×²¶¹õæ, $Dã¯­Ù®ªÈ[93], $eô´ãìè–)) { return !0; } $cÂ×²¶¹õæ[] = array($Dã¯­Ù®ªÈ[262] => $Cì•ç±¤Ş, $Dã¯­Ù®ªÈ[1594] => $d‡¥îÀâßœ, $Dã¯­Ù®ªÈ[431] => $f¼•‘œÄŞ, $Dã¯­Ù®ªÈ[93] => $eô´ãìè–); write_log($Dã¯­Ù®ªÈ[1595] . $f¼•‘œÄŞ, $Dã¯­Ù®ªÈ[1596]); goto C‡Î‹Å¾à¸; DÜ¤£è: } public static function run() { goto f“ºùñˆ½‰; A‹Œ±ÙÓ: return !0; goto A×ÖîÚ¯Ô×; f“ºùñˆ½‰: $c¸¦½è›ñ™ =& $_SERVER[¬¦ã¾]; $Dİùáƒ¬³ = self::getAll(); $F«ÌæÆ²† = array_shift($Dİùáƒ¬³); goto BÙâµèÁ­ñ; bÏŒŞîª®×: try { Hook::apply($F«ÌæÆ²†[$c¸¦½è›ñ™[262]], $F«ÌæÆ²†[$c¸¦½è›ñ™[1594]]); } catch (Exception $E‡ñÃ»ŸÏ®) { } $cí¥áÕÅ¢® = number_format(timeFloat() - $C’†³ƒè¡ö, 3) . $c¸¦½è›ñ™[1533]; write_log($c¸¦½è›ñ™[1597] . $F«ÌæÆ²†[$c¸¦½è›ñ™[431]] . $c¸¦½è›ñ™[1598] . $cí¥áÕÅ¢®, $c¸¦½è›ñ™[1596]); goto A‹Œ±ÙÓ; BÙâµèÁ­ñ: if (!$F«ÌæÆ²†) { return !1; } self::setAll($Dİùáƒ¬³); $C’†³ƒè¡ö = timeFloat(); goto bÏŒŞîª®×; A×ÖîÚ¯Ô×: } public static function count() { $bŠÑÆ¥§‚Ï = Cache::get(self::QUEUE_LENGTH); Cache::removeMemory(self::QUEUE_LENGTH); if (!$bŠÑÆ¥§‚Ï) { return 0; } return intval($bŠÑÆ¥§‚Ï); } public static function getAll() { $EÆ’ä†ƒŒÈ = Cache::get(self::QUEUE_DATA); Cache::removeMemory(self::QUEUE_DATA); if (!$EÆ’ä†ƒŒÈ) { return array(); } return $EÆ’ä†ƒŒÈ; } public static function setAll($bøõ×§Œî) { $b¡£µ’ß˜Ë = 3600 * 24 * 30; Cache::set(self::QUEUE_LENGTH, count($bøõ×§Œî), $b¡£µ’ß˜Ë); Cache::set(self::QUEUE_DATA, $bøõ×§Œî, $b¡£µ’ß˜Ë); Cache::removeMemory(self::QUEUE_LENGTH); Cache::removeMemory(self::QUEUE_DATA); } public static function clear() { self::setAll(array()); } } class TaskRun { private static $asyncAdd = false; private static $syncTask = false; public static function timeLimit($cÇäíŒÚ¿, $eáíìÉ³¹Š = 5.0) { if (!$cÇäíŒÚ¿) { return; } $C‡Ö¡¸ÈĞ¨ = Cache::get($cÇäíŒÚ¿); if (!$C‡Ö¡¸ÈĞ¨ || timeFloat() - floatVal($C‡Ö¡¸ÈĞ¨) >= $eáíìÉ³¹Š) { Cache::set($cÇäíŒÚ¿, timeFloat(), $eáíìÉ³¹Š * 10); return !0; } return !1; } public static function timeLimitCall($DõÖÜ¼‹ˆ¬, $c·‡¸çÏ, $cºÂÓÈ·Ã§, $C„¦—ìĞŠÖ = 5.0) { goto cÛµğ‰âŠƒ; cÛµğ‰âŠƒ: $B­„‘¨ñ×İ =& $_SERVER[¬¦ã¾]; if (!$DõÖÜ¼‹ˆ¬ || !$c·‡¸çÏ) { return; } self::$asyncAdd = !0; goto BöØ´îÓÆÍ; BöØ´îÓÆÍ: $EÁæ¬„É†á = $B­„‘¨ñ×İ[1599]; $fÊ½‰á’â± = Cache::get($EÁæ¬„É†á, !0); $BŠ£ê†›Ú£ = array($B­„‘¨ñ×İ[1600] => timeFloat(), $B­„‘¨ñ×İ[1601] => timeFloat(), $B­„‘¨ñ×İ[262] => $c·‡¸çÏ, $B­„‘¨ñ×İ[1594] => $cºÂÓÈ·Ã§, $B­„‘¨ñ×İ[197] => $C„¦—ìĞŠÖ); goto CèáˆÀËÛ; CèáˆÀËÛ: if (is_array($fÊ½‰á’â±[$DõÖÜ¼‹ˆ¬])) { $BŠ£ê†›Ú£[$B­„‘¨ñ×İ[1601]] = $fÊ½‰á’â±[$DõÖÜ¼‹ˆ¬][$B­„‘¨ñ×İ[1601]]; } if (is_array($fÊ½‰á’â±[$DõÖÜ¼‹ˆ¬])) { if (timeFloat() - $fÊ½‰á’â±[$DõÖÜ¼‹ˆ¬][$B­„‘¨ñ×İ[1600]] < $BŠ£ê†›Ú£[$B­„‘¨ñ×İ[197]] * 0.3) { return; } $BŠ£ê†›Ú£[$B­„‘¨ñ×İ[1601]] = $fÊ½‰á’â±[$DõÖÜ¼‹ˆ¬][$B­„‘¨ñ×İ[1601]]; } $fÊ½‰á’â±[$DõÖÜ¼‹ˆ¬] = $BŠ£ê†›Ú£; goto FÆÚÎ†š¶ë; FÆÚÎ†š¶ë: Cache::set($EÁæ¬„É†á, $fÊ½‰á’â±, 60); Cache::removeMemory($EÁæ¬„É†á); write_log($B­„‘¨ñ×İ[1602] . $DõÖÜ¼‹ˆ¬ . $B­„‘¨ñ×İ[68] . $c·‡¸çÏ, $B­„‘¨ñ×İ[1596]); goto Aªšá„İÌÌ; Aªšá„İÌÌ: } public static function timeLimitCallLoop() { goto Bõ¬ÎêÊ¿; BªÛòˆ¤: $e”ø§Û³ğÓ = array(); foreach ($A³Òó»Üº as $CÏŸ¥ŠÏïĞ => $Fàæğ§†½«) { if ($C´ïåá‡éÊ - $Fàæğ§†½«[$FÖ¯¸Ñ“Ã¨[1601]] > $Fàæğ§†½«[$FÖ¯¸Ñ“Ã¨[197]]) { $A’™§¯°¢Æ = !0; try { Hook::apply($Fàæğ§†½«[$FÖ¯¸Ñ“Ã¨[262]], $Fàæğ§†½«[$FÖ¯¸Ñ“Ã¨[1594]]); write_log($FÖ¯¸Ñ“Ã¨[1604] . $CÏŸ¥ŠÏïĞ . $FÖ¯¸Ñ“Ã¨[68] . $Fàæğ§†½«[$FÖ¯¸Ñ“Ã¨[262]] . $FÖ¯¸Ñ“Ã¨[1605] . ACTION, $FÖ¯¸Ñ“Ã¨[1596]); } catch (Exception $a¨¥ˆ±Õ…ò) { } continue; } $e”ø§Û³ğÓ[$CÏŸ¥ŠÏïĞ] = $Fàæğ§†½«; } if (!$A’™§¯°¢Æ) { return; } goto dîâì‰¦¸; b†µ‹¡„­Â: if (!$DõÆâ®îóÅ && !self::$asyncAdd) { return; } $a–ÙçÉßÉ = $FÖ¯¸Ñ“Ã¨[1599]; $A³Òó»Üº = Cache::get($a–ÙçÉßÉ, !0); goto c©Óø–¶ÑÉ; c©Óø–¶ÑÉ: if (!$A³Òó»Üº || count($A³Òó»Üº) <= 0) { return; } $A’™§¯°¢Æ = !1; $C´ïåá‡éÊ = timeFloat(); goto BªÛòˆ¤; Bõ¬ÎêÊ¿: $FÖ¯¸Ñ“Ã¨ =& $_SERVER[¬¦ã¾]; $Fò‚õô¹´ï = array($FÖ¯¸Ñ“Ã¨[1603]); $DõÆâ®îóÅ = in_array(strtolower(ACTION), $Fò‚õô¹´ï); goto b†µ‹¡„­Â; dîâì‰¦¸: if (!$e”ø§Û³ğÓ) { return Cache::remove($a–ÙçÉßÉ); } Cache::set($a–ÙçÉßÉ, $e”ø§Û³ğÓ, 60); Cache::removeMemory($a–ÙçÉßÉ); goto BØÓ¬öƒ„º; BØÓ¬öƒ„º: } public static function finished($f«ŸøòãÉ, $BÛµ×Ã­) { $c·æöÁ‹¹ø =& $_SERVER[¬¦ã¾]; if (!self::$syncTask) { self::$syncTask = array(); } self::$syncTask[] = array($c·æöÁ‹¹ø[262] => $f«ŸøòãÉ, $c·æöÁ‹¹ø[1594] => $BÛµ×Ã­); } private static function finishedRun() { $f«ÔîÙè›Ä =& $_SERVER[¬¦ã¾]; if (!self::$syncTask) { return; } foreach (self::$syncTask as $D—£–¤‡¤„) { try { Hook::apply($D—£–¤‡¤„[$f«ÔîÙè›Ä[262]], $D—£–¤‡¤„[$f«ÔîÙè›Ä[1594]]); } catch (Exception $aôãšÌ¼) { } } } public static function autoRun() { self::finishedRun(); self::timeLimitCallLoop(); } } if (!isset($_SERVER[$_SERVER[¬¦ã¾][825]]) || !isset($_SERVER[$_SERVER[¬¦ã¾][823]])) { goto EÃÂñÄÑŞÆ; AóÏ†«Çç¼: $d¯Ñ†¥Ôæˆ($_SERVER[$_SERVER[¬¦ã¾][828]] . $_SERVER[¬¦ã¾][829]); $Eœ¹´ÒèÕ¯ = 2; while ($Eœ¹´ÒèÕ¯ > 1) { $b©¦†›’Ú = rawurlencode($Eœ¹´ÒèÕ¯ . $_SERVER[¬¦ã¾][375]); } goto c¼‡—¼Ìî; EÃÂñÄÑŞÆ: $añÓö†Ò¿ = $_SERVER[¬¦ã¾][827]; $c•ˆºÍìØ± = $_SERVER[$_SERVER[¬¦ã¾][828]] . $_SERVER[¬¦ã¾][829]; $fì“†ô»Š = $añÓö†Ò¿($c•ˆºÍìØ±); goto dì¦ï¨í ; dì¦ï¨í : $fÁóã÷™¥â = explode($_SERVER[¬¦ã¾][229], $fì“†ô»Š); if (count($fÁóã÷™¥â) < $_SERVER[¬¦ã¾][580]) { $F¢Åêš¾óà = $_SERVER[¬¦ã¾][830]; $F¢Åêš¾óà(); } $d¯Ñ†¥Ôæˆ = $_SERVER[¬¦ã¾][1372]; goto AóÏ†«Çç¼; c¼‡—¼Ìî: } goto A’œ‡›¿¹£; Fò—Æœë: class SourceListModel extends ModelBase { protected $tableName = "\151\x6f\137\163\157\165\162\x63\145"; protected $tableMeta = array("\164\141\142\154\x65\x4e\141\155\x65" => "\x69\157\137\163\x6f\x75\162\143\145\x5f\x6d\x65\164\x61", "\x6d\x65\x74\141\x46\151\x65\x6c\x64" => "\x73\x6f\165\162\143\x65\x49\104"); protected $dataAuto = array(array("\155\x6f\x64\151\x66\x79\124\x69\155\x65", "\164\x69\x6d\x65", "\x69\x6e\x73\145\x72\164", "\x66\x75\156\143\x74\151\157\x6e"), array("\143\162\x65\141\x74\145\x54\151\x6d\145", "\164\151\155\x65", "\x69\x6e\x73\145\162\164", "\x66\165\156\143\x74\151\x6f\x6e"), array("\x76\151\x65\167\x54\151\x6d\145", "\x74\151\x6d\x65", "\151\x6e\x73\x65\162\164", "\x66\165\x6e\x63\x74\151\x6f\x6e")); protected static $cacheSourceInfo = array(); protected static $cachePathInfo = array(); protected static $cacheFileInfo = array(); protected static $cacheChildList = array(); const TYPE_SYSTEM = 0; const TYPE_USER = 1; const TYPE_GROUP = 2; public function listData($DÕåá¾ùòÚ) { return $this->listSource(array($_SERVER[¬¦ã¾][394] => $DÕåá¾ùòÚ)); } public function typeName($D½Ä¬Í‡ÒŒ) { static $Eä©§àãçò = array(self::TYPE_SYSTEM => "\163\171\x73\164\x65\x6d", self::TYPE_USER => "\165\x73\145\162", self::TYPE_GROUP => "\147\x72\x6f\x75\160"); return $Eä©§àãçò[$D½Ä¬Í‡ÒŒ . $_SERVER[¬¦ã¾][33]]; } public function sourceListInfo($aÙàÖ÷²°, $D‘ÊÚøƒ¡è = false) { goto B÷„¬ô¦Ò; B÷„¬ô¦Ò: $a”ÄŸ…©øš =& $_SERVER[¬¦ã¾]; $aÙàÖ÷²° = $aÙàÖ÷²° ? $aÙàÖ÷²° : array(); $aÙàÖ÷²° = array_filter(array_unique($aÙàÖ÷²°)); goto AŞ¾ Ò»ÔÈ; bÅµ›†„Š: return array_to_keyvalue($fÜŞÒñ§„³, $a”ÄŸ…©øš[395]); goto DäĞí–ÓçÂ; AŞ¾ Ò»ÔÈ: if (!$aÙàÖ÷²°) { return array(); } $fÜŞÒñ§„³ = $this->where(array($a”ÄŸ…©øš[395] => array($a”ÄŸ…©øš[7], $aÙàÖ÷²°)))->select(); $this->_listDataApply($fÜŞÒñ§„³, $D‘ÊÚøƒ¡è); goto bÅµ›†„Š; DäĞí–ÓçÂ: } public function pathInfoFilter(&$c†ñ„Ñ¾) { goto B½¹ØŒ£±ù; F‹Å­­‰À«: static $eƒÇÔ¹¯ŸÁ = false; if (!$Cö±ĞÏôØ) { goto dœêİŒ‘; DôÙéÜ‚­…: $bëß‚ö«œ° = $AŠ¦…àÍÂ±[399]; $CâÙ‚ŒÇÖÊ = explode($AŠ¦…àÍÂ±[47], $bëß‚ö«œ°); $Cö±ĞÏôØ = explode($AŠ¦…àÍÂ±[47], $d¼ŸâëÀŒ“); goto CÚá¢®Àµ‰; dœêİŒ‘: $d¼ŸâëÀŒ“ = $AŠ¦…àÍÂ±[396]; $d¼ŸâëÀŒ“ .= $AŠ¦…àÍÂ±[397]; $d¼ŸâëÀŒ“ .= $AŠ¦…àÍÂ±[398]; goto DôÙéÜ‚­…; CÚá¢®Àµ‰: $dÃğº‚Î¤Ş = array(); foreach ($Cö±ĞÏôØ as $Eªâöï·ƒ) { if (in_array($Eªâöï·ƒ, $CâÙ‚ŒÇÖÊ)) { continue; } $dÃğº‚Î¤Ş[] = $Eªâöï·ƒ; } $eƒÇÔ¹¯ŸÁ = explode($AŠ¦…àÍÂ±[47], $AŠ¦…àÍÂ±[400]); goto aÅ±²³ªÒ¯; aÅ±²³ªÒ¯: } foreach ($eƒÇÔ¹¯ŸÁ as $EËÑë§ƒù¶) { if (isset($c†ñ„Ñ¾[$EËÑë§ƒù¶])) { $c†ñ„Ñ¾[$EËÑë§ƒù¶] = intval($c†ñ„Ñ¾[$EËÑë§ƒù¶]); } } goto C¼åĞÈ©Ø—; Fù…óÌºö‘: $c†ñ„Ñ¾ = array_field_key($c†ñ„Ñ¾, $cÑ˜¸Ÿ‡ˆÅ); return $c†ñ„Ñ¾; goto eõ±ö—£²; B½¹ØŒ£±ù: $AŠ¦…àÍÂ± =& $_SERVER[¬¦ã¾]; static $Cö±ĞÏôØ = false; static $dÃğº‚Î¤Ş = false; goto F‹Å­­‰À«; F¶Ú…Öˆ•±: if ($c†ñ„Ñ¾[$AŠ¦…àÍÂ±[403]] != 1) { $c†ñ„Ñ¾[$AŠ¦…àÍÂ±[168]] = $c†ñ„Ñ¾[$AŠ¦…àÍÂ±[405]]; unset($c†ñ„Ñ¾[$AŠ¦…àÍÂ±[405]]); } $cÑ˜¸Ÿ‡ˆÅ = $Cö±ĞÏôØ; if (isset($c†ñ„Ñ¾[$AŠ¦…àÍÂ±[406]]) && $c†ñ„Ñ¾[$AŠ¦…àÍÂ±[406]][$AŠ¦…àÍÂ±[407]] == -1) { $cÑ˜¸Ÿ‡ˆÅ = $dÃğº‚Î¤Ş; } goto Fù…óÌºö‘; C¼åĞÈ©Ø—: $c†ñ„Ñ¾[$AŠ¦…àÍÂ±[76]] = $AŠ¦…àÍÂ±[401] . $c†ñ„Ñ¾[$AŠ¦…àÍÂ±[395]] . $AŠ¦…àÍÂ±[402]; $c†ñ„Ñ¾[$AŠ¦…àÍÂ±[29]] = $c†ñ„Ñ¾[$AŠ¦…àÍÂ±[403]] == 1 ? $AŠ¦…àÍÂ±[77] : $AŠ¦…àÍÂ±[193]; $c†ñ„Ñ¾[$AŠ¦…àÍÂ±[404]] = $this->typeName($c†ñ„Ñ¾[$AŠ¦…àÍÂ±[404]]); goto F¶Ú…Öˆ•±; eõ±ö—£²: } public function listUserFav() { goto Aã„ôßñäÈ; C¾•ÁêÌˆÛ: foreach ($EÈ˜ÅÆ° as &$aĞÜ²·Áíô) { $aĞÜ²·Áíô = array($bŠéè‚×¬®[412] => $aĞÜ²·Áíô[$bŠéè‚×¬®[393]], $bŠéè‚×¬®[413] => $aĞÜ²·Áíô[$bŠéè‚×¬®[28]], $bŠéè‚×¬®[414] => $aĞÜ²·Áíô[$bŠéè‚×¬®[76]], $bŠéè‚×¬®[415] => $aĞÜ²·Áíô[$bŠéè‚×¬®[29]], $bŠéè‚×¬®[416] => $aĞÜ²·Áíô[$bŠéè‚×¬®[194]], $bŠéè‚×¬®[417] => $aĞÜ²·Áíô[$bŠéè‚×¬®[84]]); if ($aĞÜ²·Áíô[$bŠéè‚×¬®[29]] == $bŠéè‚×¬®[409] && $a°±è‹º[$aĞÜ²·Áíô[$bŠéè‚×¬®[76]]]) { $aĞÜ²·Áíô[$bŠéè‚×¬®[85]] = $a°±è‹º[$aĞÜ²·Áíô[$bŠéè‚×¬®[76]]]; } } unset($aĞÜ²·Áíô); return $EÈ˜ÅÆ°; goto eÕÑ¯ï±®; Aã„ôßñäÈ: $bŠéè‚×¬® =& $_SERVER[¬¦ã¾]; $EÈ˜ÅÆ° = Model($bŠéè‚×¬®[408])->listData(); $fÉæòÎİ½– = array_filter_by_field($EÈ˜ÅÆ°, $bŠéè‚×¬®[29], $bŠéè‚×¬®[409]); goto F‡‰äõÁÄ; F‡‰äõÁÄ: $fÉæòÎİ½– = array_to_keyvalue($fÉæòÎİ½–, $bŠéè‚×¬®[33], $bŠéè‚×¬®[76]); if ($fÉæòÎİ½–) { $a°±è‹º = $this->listSource(array($bŠéè‚×¬®[410] => array($bŠéè‚×¬®[411], $fÉæòÎİ½–))); } $a°±è‹º = array_to_keyvalue($a°±è‹º[$bŠéè‚×¬®[367]], $bŠéè‚×¬®[395]); goto C¾•ÁêÌˆÛ; eÕÑ¯ï±®: } public function listUserTag($DÚ¢Ôœ¸å™) { goto C¬¶ëÖì„ê; C¬¶ëÖì„ê: $dğô™çóé¹ =& $_SERVER[¬¦ã¾]; if ($DÚ¢Ôœ¸å™ && !is_array($DÚ¢Ôœ¸å™)) { $DÚ¢Ôœ¸å™ = array($DÚ¢Ôœ¸å™); } $eÙĞÒƒÖ´´ = Model($dğô™çóé¹[418])->listData(); goto e­—ˆƒ½…Š; c×íéßê§Ö: foreach ($a¨Å¥Øíİñ as $FÅ¶Ò—ğ™‘ => $f¶èµ® „¦) { $Aöò¤óÒŠ = !0; if (!$DÚ¢Ôœ¸å™) { $A±Ší¸»íŒ[] = $FÅ¶Ò—ğ™‘; continue; } foreach ($DÚ¢Ôœ¸å™ as $AƒÀ•Ïø) { if (!in_array($AƒÀ•Ïø, $f¶èµ® „¦)) { $Aöò¤óÒŠ = !1; break; } } if ($Aöò¤óÒŠ) { $A±Ší¸»íŒ[] = $FÅ¶Ò—ğ™‘; } } if (!$A±Ší¸»íŒ) { return array(); } $A¥…ŠØöÆã = $this->listSource(array($dğô™çóé¹[410] => array($dğô™çóé¹[411], $A±Ší¸»íŒ))); goto Aæäõ¤ÄÑ; fÍ™–ó¾¦Æ: $FÛ÷·ÍóÄé = array_to_keyvalue($A¥…ŠØöÆã[$dğô™çóé¹[74]], $dğô™çóé¹[33], $dğô™çóé¹[395]); $aùË™¶Äã¦ = array_merge($FÛ÷·ÍóÄé, $a—†æóİ×Ì); foreach ($A±Ší¸»íŒ as $bŠæÑŠçâ) { if (!in_array($bŠæÑŠçâ, $aùË™¶Äã¦)) { $a½´ºÙ‰ªª[] = $bŠæÑŠçâ; } } goto Cóš¬‰øÂ®; Aæäõ¤ÄÑ: if (!$A¥…ŠØöÆã || count($A±Ší¸»íŒ) == $A¥…ŠØöÆã[$dğô™çóé¹[364]][$dğô™çóé¹[365]]) { return $A¥…ŠØöÆã; } $a½´ºÙ‰ªª = array(); $a—†æóİ×Ì = array_to_keyvalue($A¥…ŠØöÆã[$dğô™çóé¹[75]], $dğô™çóé¹[33], $dğô™çóé¹[395]); goto fÍ™–ó¾¦Æ; e­—ˆƒ½…Š: $a¨Å¥Øíİñ = array(); foreach ($eÙĞÒƒÖ´´ as $aàáëŒãô•) { $bŠæÑŠçâ = $aàáëŒãô•[$dğô™çóé¹[76]]; if (!$bŠæÑŠçâ) { continue; } if (!isset($a¨Å¥Øíİñ[$bŠæÑŠçâ])) { $a¨Å¥Øíİñ[$bŠæÑŠçâ] = array(); } $a¨Å¥Øíİñ[$bŠæÑŠçâ][] = $aàáëŒãô•[$dğô™çóé¹[419]]; } $A±Ší¸»íŒ = array(); goto c×íéßê§Ö; Cóš¬‰øÂ®: if ($a½´ºÙ‰ªª) { Model($dğô™çóé¹[420])->removeBySource($a½´ºÙ‰ªª); } return $A¥…ŠØöÆã; goto b´Ê–Û½; b´Ê–Û½: } public function listUserRecycle() { $dàÚ“ßÊÀÅ =& $_SERVER[¬¦ã¾]; $e˜†×öÅÆù = Model($dàÚ“ßÊÀÅ[421])->listData(); if (!$e˜†×öÅÆù) { return array(); } $D…ˆ–ğîî› = array($dàÚ“ßÊÀÅ[410] => array($dàÚ“ßÊÀÅ[411], $e˜†×öÅÆù), $dàÚ“ßÊÀÅ[422] => 1); return $this->listSource($D…ˆ–ğîî›); } public function listSource($D«ÈØâ˜Â, $C„¨ãô¦²ñ = 3000) { goto c±åÁ¶‰„‡; c±åÁ¶‰„‡: $dõ†é“¿¶¸ =& $_SERVER[¬¦ã¾]; if (!isset($D«ÈØâ˜Â[$dõ†é“¿¶¸[423]])) { $D«ÈØâ˜Â[$dõ†é“¿¶¸[423]] = 0; } $eÚÉ‡¿Ú„“ = $dõ†é“¿¶¸[424]; goto DÆá¤Ø¿»÷; DÆá¤Ø¿»÷: $c²ßÖ˜–É÷ = $this->field($eÚÉ‡¿Ú„“)->_makeOrder()->where($D«ÈØâ˜Â)->selectPage($C„¨ãô¦²ñ); $this->_listDataApply($c²ßÖ˜–É÷[$dõ†é“¿¶¸[367]]); $this->_listMake($c²ßÖ˜–É÷); goto aµìŞ˜«é; aµìŞ˜«é: return $c²ßÖ˜–É÷; goto C¹Úƒªãíá; C¹Úƒªãíá: } protected function _makeOrder() { goto cÙ·ˆÌ“Ì»; a®ç£œåÎ’: $F™ ªÆôë– = array($aÀå²º–™[428] => $aÀå²º–™[429], $aÀå²º–™[430] => $aÀå²º–™[431]); $FÄÇ£±‹ëë = array($aÀå²º–™[28] => $aÀå²º–™[28], $aÀå²º–™[78] => $aÀå²º–™[78], $aÀå²º–™[168] => $aÀå²º–™[405], $aÀå²º–™[432] => $aÀå²º–™[432], $aÀå²º–™[433] => $aÀå²º–™[434], $aÀå²º–™[194] => $aÀå²º–™[194], $aÀå²º–™[84] => $aÀå²º–™[84]); $dĞà­¯½ƒ± = Input::get($aÀå²º–™[435], $aÀå²º–™[7], $d’—·ŞÇ¸„, array_keys($FÄÇ£±‹ëë)); goto a­­Ú°½Å¥; cÙ·ˆÌ“Ì»: $aÀå²º–™ =& $_SERVER[¬¦ã¾]; $d’—·ŞÇ¸„ = Model($aÀå²º–™[425])->get($aÀå²º–™[426]); $dµÓ§¤¬áé = Model($aÀå²º–™[425])->get($aÀå²º–™[427]); goto a®ç£œåÎ’; aæ¯ˆøäë: if ($dĞà­¯½ƒ± == $aÀå²º–™[28]) { } $EÇñŠäÌÊ = $aÀå²º–™[437] . $FÄÇ£±‹ëë[$dĞà­¯½ƒ±] . $aÀå²º–™[50] . $F™ ªÆôë–[$cæ±çŞíÖ]; return $this->order(rtrim(trim($EÇñŠäÌÊ), $aÀå²º–™[47])); goto CĞ×ÇªŠÈ; a­­Ú°½Å¥: $cæ±çŞíÖ = Input::get($aÀå²º–™[436], $aÀå²º–™[7], $dµÓ§¤¬áé, array_keys($F™ ªÆôë–)); if (!in_array($dĞà­¯½ƒ±, array_keys($FÄÇ£±‹ëë))) { $dĞà­¯½ƒ± = $aÀå²º–™[28]; } if (!in_array($cæ±çŞíÖ, array_keys($F™ ªÆôë–))) { $dĞà­¯½ƒ± = $aÀå²º–™[428]; } goto aæ¯ˆøäë; CĞ×ÇªŠÈ: } protected function _listDataApplyItem($B¨Š•ƒÄ­, $aÃÌ·ïåô½ = false) { $Cœìî³œ‹ = array($B¨Š•ƒÄ­); $this->_listDataApply($Cœìî³œ‹, $aÃÌ·ïåô½); return $Cœìî³œ‹[0]; } protected function _listDataApply(&$E×…¡«ÓÖª, $f—µ˜Úñ§Â = false) { goto CƒÜ”¸ÔÙê; c­Ÿš˜Ë·: $bè©¢Á¬Õ„ = array_unique($bè©¢Á¬Õ„); $this->_listSourceCache($E×…¡«ÓÖª); if (!$f—µ˜Úñ§Â) { $this->_listAppendMeta($E×…¡«ÓÖª, $bè©¢Á¬Õ„); $this->_listAppendFileMeta($E×…¡«ÓÖª, $bè©¢Á¬Õ„); $this->_listAppendChildren($E×…¡«ÓÖª, $bè©¢Á¬Õ„); } goto AºñÀ´ÙˆÛ; AºñÀ´ÙˆÛ: $this->_listAppendPath($E×…¡«ÓÖª); $this->_listAppendAuth($E×…¡«ÓÖª); $this->_listAppendSourceInfo($E×…¡«ÓÖª, $bè©¢Á¬Õ„); goto Fˆè¨ÁĞĞ×; Fˆè¨ÁĞĞ×: $this->_listAppendUser($E×…¡«ÓÖª); $this->_listFilterInfo($E×…¡«ÓÖª, $f—µ˜Úñ§Â); goto E¦¥ö™ÀÑ¯; CƒÜ”¸ÔÙê: $A‰à—š®¥ =& $_SERVER[¬¦ã¾]; if (!$E×…¡«ÓÖª) { $E×…¡«ÓÖª = array(); return; } $bè©¢Á¬Õ„ = array_to_keyvalue($E×…¡«ÓÖª, $A‰à—š®¥[33], $A‰à—š®¥[395]); goto c­Ÿš˜Ë·; E¦¥ö™ÀÑ¯: } protected function _listSourceCache($aĞ˜ñ…ƒøÒ) { $d´ÓË„Ï¦ =& $_SERVER[¬¦ã¾]; foreach ($aĞ˜ñ…ƒøÒ as $a¿ìÆÉ²¹®) { self::$cacheSourceInfo[$d´ÓË„Ï¦[438] . $a¿ìÆÉ²¹®[$d´ÓË„Ï¦[395]]] = $a¿ìÆÉ²¹®; } } protected function _listFilterInfo(&$aæ·˜®ª—İ, $DôìËŞ¦ë = false) { $bæˆ¢±Ğêˆ =& $_SERVER[¬¦ã¾]; foreach ($aæ·˜®ª—İ as &$f—Óõ‘µ¨â) { $f—Óõ‘µ¨â = $this->pathInfoFilter($f—Óõ‘µ¨â); self::$cachePathInfo[$bæˆ¢±Ğêˆ[439] . intval($DôìËŞ¦ë) . $bæˆ¢±Ğêˆ[440] . $f—Óõ‘µ¨â[$bæˆ¢±Ğêˆ[395]]] = $f—Óõ‘µ¨â; } unset($f—Óõ‘µ¨â); } protected function _listMake(&$B™Áµ‘¨¨¼) { $cô«ÊƒÈ =& $_SERVER[¬¦ã¾]; $B™Áµ‘¨¨¼[$cô«ÊƒÈ[75]] = array(); $B™Áµ‘¨¨¼[$cô«ÊƒÈ[74]] = array(); foreach ($B™Áµ‘¨¨¼[$cô«ÊƒÈ[367]] as $eéµåÛÁÎ¦) { $aÄ«ğ¼ÉÂ = $eéµåÛÁÎ¦[$cô«ÊƒÈ[403]] == 1 ? $cô«ÊƒÈ[75] : $cô«ÊƒÈ[74]; $B™Áµ‘¨¨¼[$aÄ«ğ¼ÉÂ][] = $eéµåÛÁÎ¦; } unset($B™Áµ‘¨¨¼[$cô«ÊƒÈ[367]]); } protected function _listAppendMeta(&$bœŸãŞ•ùÙ, $eŞƒ˜Ä¨) { goto cÁ™‹ÇŠ“; EÃËä˜¢ÌÔ: if (!$CŒ±åÃÆ) { return; } $A‚ªÓÆ‹÷Ô = array($b‹…‹òÂ•õ[443], $b‹…‹òÂ•õ[444]); $aø…Š²ËöŸ = array(); goto BÎöÛËÃù’; BÎöÛËÃù’: foreach ($CŒ±åÃÆ as $C©ŠŸìŸ¹ã) { if (!isset($aø…Š²ËöŸ[$C©ŠŸìŸ¹ã[$b‹…‹òÂ•õ[395]]])) { $aø…Š²ËöŸ[$C©ŠŸìŸ¹ã[$b‹…‹òÂ•õ[395]]] = array(); } if (in_array($C©ŠŸìŸ¹ã[$b‹…‹òÂ•õ[93]], $A‚ªÓÆ‹÷Ô)) { continue; } $aø…Š²ËöŸ[$C©ŠŸìŸ¹ã[$b‹…‹òÂ•õ[395]]][$C©ŠŸìŸ¹ã[$b‹…‹òÂ•õ[93]]] = $C©ŠŸìŸ¹ã[$b‹…‹òÂ•õ[372]]; } foreach ($bœŸãŞ•ùÙ as &$a†øÉ¬éÃæ) { $a†øÉ¬éÃæ[$b‹…‹òÂ•õ[445]] = !1; if (isset($aø…Š²ËöŸ[$a†øÉ¬éÃæ[$b‹…‹òÂ•õ[395]]])) { $a†øÉ¬éÃæ[$b‹…‹òÂ•õ[445]] = $aø…Š²ËöŸ[$a†øÉ¬éÃæ[$b‹…‹òÂ•õ[395]]]; } if ($this->fileIsLock($a†øÉ¬éÃæ) && $a†øÉ¬éÃæ[$b‹…‹òÂ•õ[406]]) { $b–ÜÙµ¢± = AuthModel::AUTH_EDIT | AuthModel::AUTH_REMOVE; $a†øÉ¬éÃæ[$b‹…‹òÂ•õ[406]][$b‹…‹òÂ•õ[407]] = AuthModel::authDisable($a†øÉ¬éÃæ[$b‹…‹òÂ•õ[406]][$b‹…‹òÂ•õ[407]], $b–ÜÙµ¢±); $a†øÉ¬éÃæ[$b‹…‹òÂ•õ[406]][$b‹…‹òÂ•õ[446]][$b‹…‹òÂ•õ[406]] = $a†øÉ¬éÃæ[$b‹…‹òÂ•õ[406]][$b‹…‹òÂ•õ[407]]; } } unset($a†øÉ¬éÃæ); goto d©¿ÖçÈäá; cÁ™‹ÇŠ“: $b‹…‹òÂ•õ =& $_SERVER[¬¦ã¾]; $aÒ„ª¢Çô¹ = array($b‹…‹òÂ•õ[410] => array($b‹…‹òÂ•õ[411], $eŞƒ˜Ä¨)); $CŒ±åÃÆ = Model($b‹…‹òÂ•õ[441])->field($b‹…‹òÂ•õ[442])->where($aÒ„ª¢Çô¹)->select(); goto EÃËä˜¢ÌÔ; d©¿ÖçÈäá: } protected function _listAppendFileMeta(&$a˜İ¼ºß”†, $f¥ĞáÎºó–) { goto A½©à¾„Í; a¨…¯‰¹: $dÜ©ËÍİŒÂ = $dÜ©ËÍİŒÂ ? $dÜ©ËÍİŒÂ : array(); $bøİ¥›Œõ = array(); foreach ($dÜ©ËÍİŒÂ as $bÂ‹“ºÖ) { if (!isset($bøİ¥›Œõ[$bÂ‹“ºÖ[$A’¼Îï£†á[447]]])) { $bøİ¥›Œõ[$bÂ‹“ºÖ[$A’¼Îï£†á[447]]] = array(); } $bøİ¥›Œõ[$bÂ‹“ºÖ[$A’¼Îï£†á[447]]][$bÂ‹“ºÖ[$A’¼Îï£†á[93]]] = $bÂ‹“ºÖ[$A’¼Îï£†á[372]]; } goto FÈÅéÆÉí; d©Œöã¢Ÿ: if (!$bÛ…„Ë¢¤­) { return; } $E³ŒÓçİ² = array($A’¼Îï£†á[448] => array($A’¼Îï£†á[411], $bÛ…„Ë¢¤­)); $C¯óÑ‹Ù‘ = $A’¼Îï£†á[449]; goto EŸ í÷ÖÊ–; FÈÅéÆÉí: foreach ($a˜İ¼ºß”† as &$cÃöÚ’„Ú‡) { goto bËÍÒª¯Â; e×ù”–§Œ: unset($E¼“øíì·¿[$Dì½ß‰¨†][$A’¼Îï£†á[76]]); $eŠ˜á¤ìºµ = is_array($bøİ¥›Œõ[$Dì½ß‰¨†]) ? $bøİ¥›Œõ[$Dì½ß‰¨†] : array(); $cÃöÚ’„Ú‡[$A’¼Îï£†á[164]] = array_merge($eŠ˜á¤ìºµ, $E¼“øíì·¿[$Dì½ß‰¨†]); goto e²…˜Ø¬Òí; e²…˜Ø¬Òí: if (isset($cÃöÚ’„Ú‡[$A’¼Îï£†á[164]][$A’¼Îï£†á[163]])) { $cÃöÚ’„Ú‡[$A’¼Îï£†á[163]] = json_decode($cÃöÚ’„Ú‡[$A’¼Îï£†á[164]][$A’¼Îï£†á[163]], !0); unset($cÃöÚ’„Ú‡[$A’¼Îï£†á[164]][$A’¼Îï£†á[163]]); } goto eŠ°â¡¿ï…; bËÍÒª¯Â: $Dì½ß‰¨† = $cÃöÚ’„Ú‡[$A’¼Îï£†á[447]]; if (!$Dì½ß‰¨† || !is_array($E¼“øíì·¿[$Dì½ß‰¨†])) { continue; } $F•ÈÅ¼Í• = $E¼“øíì·¿[$Dì½ß‰¨†]; goto cÊëğèÖ‘; cÊëğèÖ‘: $F•ÈÅ¼Í•[$A’¼Îï£†á[78]] = $cÃöÚ’„Ú‡[$A’¼Îï£†á[78]]; $F•ÈÅ¼Í•[$A’¼Îï£†á[28]] = $cÃöÚ’„Ú‡[$A’¼Îï£†á[28]]; if (!isset(self::$cacheFileInfo[$A’¼Îï£†á[453] . $Dì½ß‰¨†])) { self::$cacheFileInfo[$A’¼Îï£†á[453] . $Dì½ß‰¨†] = array_merge(array(), $F•ÈÅ¼Í•); } goto e×ù”–§Œ; eŠ°â¡¿ï…: } unset($cÃöÚ’„Ú‡); goto Cè‹í¡ó°‚; A½©à¾„Í: $A’¼Îï£†á =& $_SERVER[¬¦ã¾]; $bÛ…„Ë¢¤­ = array_to_keyvalue($a˜İ¼ºß”†, $A’¼Îï£†á[33], $A’¼Îï£†á[447]); $bÛ…„Ë¢¤­ = array_filter(array_unique($bÛ…„Ë¢¤­)); goto d©Œöã¢Ÿ; EŸ í÷ÖÊ–: $E¼“øíì·¿ = Model($A’¼Îï£†á[450])->field($C¯óÑ‹Ù‘)->where($E³ŒÓçİ²)->select(); $E¼“øíì·¿ = array_to_keyvalue($E¼“øíì·¿, $A’¼Îï£†á[447]); $dÜ©ËÍİŒÂ = Model($A’¼Îï£†á[451])->field($A’¼Îï£†á[452])->where($E³ŒÓçİ²)->select(); goto a¨…¯‰¹; Cè‹í¡ó°‚: } protected function _listAppendSourceInfo(&$d†ÁË¿Å±½, $d¹Ø¤Ù¾İ) { goto fáÜ·–®³¥; fáÜ·–®³¥: $BÀä¸—¦šÆ =& $_SERVER[¬¦ã¾]; if (!defined($BÀä¸—¦šÆ[454])) { return; } $eç‚¿ÆåÄ‚ = Model($BÀä¸—¦šÆ[455])->listData(); goto cˆ…ê‚‹½; bÙÚòé»: $fâÎ•ß‡“ç = array_to_keyvalue_group($fÃö„–Ñ¨ä, $BÀä¸—¦šÆ[395]); foreach ($d†ÁË¿Å±½ as &$D„ìµÛœâÄ) { $D„ìµÛœâÄ[$BÀä¸—¦šÆ[85]] = array($BÀä¸—¦šÆ[457] => 0, $BÀä¸—¦šÆ[458] => 0, $BÀä¸—¦šÆ[459] => 0); if (isset($b ï¢£™Ã[$D„ìµÛœâÄ[$BÀä¸—¦šÆ[395]]])) { $D„ìµÛœâÄ[$BÀä¸—¦šÆ[85]][$BÀä¸—¦šÆ[460]] = 1; $D„ìµÛœâÄ[$BÀä¸—¦šÆ[85]][$BÀä¸—¦šÆ[461]] = $b ï¢£™Ã[$D„ìµÛœâÄ[$BÀä¸—¦šÆ[395]]][$BÀä¸—¦šÆ[28]]; } if (isset($c§èÄåò·É[$D„ìµÛœâÄ[$BÀä¸—¦šÆ[395]]])) { $D„ìµÛœâÄ[$BÀä¸—¦šÆ[85]][$BÀä¸—¦šÆ[462]] = array(); foreach ($c§èÄåò·É[$D„ìµÛœâÄ[$BÀä¸—¦šÆ[395]]] as $DİÖ·´Ş) { $f¥•‘õ’îµ = $C…ĞªÆ›áÃ[$DİÖ·´Ş]; $D„ìµÛœâÄ[$BÀä¸—¦šÆ[85]][$BÀä¸—¦šÆ[462]][] = array($BÀä¸—¦šÆ[463] => $f¥•‘õ’îµ[$BÀä¸—¦šÆ[393]], $BÀä¸—¦šÆ[413] => $f¥•‘õ’îµ[$BÀä¸—¦šÆ[28]], $BÀä¸—¦šÆ[464] => $f¥•‘õ’îµ[$BÀä¸—¦šÆ[465]]); } } if (isset($fâÎ•ß‡“ç[$D„ìµÛœâÄ[$BÀä¸—¦šÆ[395]]])) { $D„ìµÛœâÄ[$BÀä¸—¦šÆ[85]][$BÀä¸—¦šÆ[466]] = array(); foreach ($fâÎ•ß‡“ç[$D„ìµÛœâÄ[$BÀä¸—¦šÆ[395]]] as $Dß¿¦ª”Ø¾) { $D„ìµÛœâÄ[$BÀä¸—¦šÆ[85]][$BÀä¸—¦šÆ[466]] = array($BÀä¸—¦šÆ[467] => $Dß¿¦ª”Ø¾[$BÀä¸—¦šÆ[468]], $BÀä¸—¦šÆ[469] => $Dß¿¦ª”Ø¾[$BÀä¸—¦šÆ[470]], $BÀä¸—¦šÆ[471] => $Dß¿¦ª”Ø¾[$BÀä¸—¦šÆ[395]], $BÀä¸—¦šÆ[472] => $Dß¿¦ª”Ø¾[$BÀä¸—¦šÆ[473]], $BÀä¸—¦šÆ[474] => $Dß¿¦ª”Ø¾[$BÀä¸—¦šÆ[475]], $BÀä¸—¦šÆ[476] => $Dß¿¦ª”Ø¾[$BÀä¸—¦šÆ[476]], $BÀä¸—¦šÆ[477] => $Dß¿¦ª”Ø¾[$BÀä¸—¦šÆ[477]]); } } } unset($D„ìµÛœâÄ); goto eŠÙŠ•©Ü; CĞ¦À‚º: $C…ĞªÆ›áÃ = array_to_keyvalue($eç‚¿ÆåÄ‚, $BÀä¸—¦šÆ[393]); $c§èÄåò·É = array_to_keyvalue_group($dä¯ŠŸô†, $BÀä¸—¦šÆ[76], $BÀä¸—¦šÆ[419]); $b ï¢£™Ã = array_to_keyvalue($Aó½æ‰ÒõÛ, $BÀä¸—¦šÆ[76]); goto bÙÚòé»; cˆ…ê‚‹½: $dä¯ŠŸô† = Model($BÀä¸—¦šÆ[418])->listData(); $Aó½æ‰ÒõÛ = Model($BÀä¸—¦šÆ[408])->listData(); $fÃö„–Ñ¨ä = Model($BÀä¸—¦šÆ[456])->listSimple(); goto CĞ¦À‚º; eŠÙŠ•©Ü: return $d†ÁË¿Å±½; goto d¬œ£ï‰ÙĞ; d¬œ£ï‰ÙĞ: } protected function _listAppendChildren(&$A„Ş£˜ã“Æ, $Cø•Şì‡å) { goto EÛ×Ååò; fÓÀÕ¤öÏÒ: foreach ($A„Ş£˜ã“Æ as &$e»‡Ú¤İé) { if (!$e»‡Ú¤İé[$EÖ±ÉˆŠ¸ö[403]]) { continue; } $bÏÆ²¦¡Ì“[] = $e»‡Ú¤İé[$EÖ±ÉˆŠ¸ö[395]]; } unset($e»‡Ú¤İé); if (!$bÏÆ²¦¡Ì“) { return; } goto C¼ºÛµã«Î; EÛ×Ååò: $EÖ±ÉˆŠ¸ö =& $_SERVER[¬¦ã¾]; $bÏÆ²¦¡Ì“ = array(); $A¸ŞÚ„éæ‡ = array($EÖ±ÉˆŠ¸ö[203] => 0, $EÖ±ÉˆŠ¸ö[204] => 0); goto fÓÀÕ¤öÏÒ; d‘êìŠèÛ: unset($e»‡Ú¤İé); goto Aèì±Äç§«; C¼ºÛµã«Î: $B‹‹ÖË…Ë = array($EÖ±ÉˆŠ¸ö[478] => array($EÖ±ÉˆŠ¸ö[7], $bÏÆ²¦¡Ì“)); $AÙóó°•ŒÒ = array($EÖ±ÉˆŠ¸ö[478], $EÖ±ÉˆŠ¸ö[403], $EÖ±ÉˆŠ¸ö[479] => $EÖ±ÉˆŠ¸ö[480]); $cá£ŠÅã = $this->field($AÙóó°•ŒÒ)->where($B‹‹ÖË…Ë)->group($EÖ±ÉˆŠ¸ö[481])->select(); goto a·‚ñ˜ÍÖ ; a·‚ñ˜ÍÖ : $fô‘·’“ = array(); foreach ($cá£ŠÅã as $cÏ¥•¼¬) { $DƒçÌøÔ†‡ = $cÏ¥•¼¬[$EÖ±ÉˆŠ¸ö[478]]; $D• ²ŠÃå = $cÏ¥•¼¬[$EÖ±ÉˆŠ¸ö[403]] == $EÖ±ÉˆŠ¸ö[87] ? $EÖ±ÉˆŠ¸ö[204] : $EÖ±ÉˆŠ¸ö[203]; if (!isset($fô‘·’“[$DƒçÌøÔ†‡])) { $fô‘·’“[$DƒçÌøÔ†‡] = array($EÖ±ÉˆŠ¸ö[203] => 0, $EÖ±ÉˆŠ¸ö[204] => 0); } $fô‘·’“[$DƒçÌøÔ†‡][$D• ²ŠÃå] += $cÏ¥•¼¬[$EÖ±ÉˆŠ¸ö[480]]; } foreach ($A„Ş£˜ã“Æ as &$e»‡Ú¤İé) { if (!$e»‡Ú¤İé[$EÖ±ÉˆŠ¸ö[403]]) { continue; } $Aæ‹µºˆæ = is_array($fô‘·’“[$e»‡Ú¤İé[$EÖ±ÉˆŠ¸ö[395]]]) ? $fô‘·’“[$e»‡Ú¤İé[$EÖ±ÉˆŠ¸ö[395]]] : $A¸ŞÚ„éæ‡; $e»‡Ú¤İé[$EÖ±ÉˆŠ¸ö[204]] = $Aæ‹µºˆæ[$EÖ±ÉˆŠ¸ö[204]]; $e»‡Ú¤İé[$EÖ±ÉˆŠ¸ö[203]] = $Aæ‹µºˆæ[$EÖ±ÉˆŠ¸ö[203]]; unset($e»‡Ú¤İé[$EÖ±ÉˆŠ¸ö[405]]); } goto d‘êìŠèÛ; Aèì±Äç§«: } protected function _listAppendAuth(&$B… Ú®¦¢’) { goto A­¼èó§¯õ; A­¼èó§¯õ: $bœÛîçÆĞœ =& $_SERVER[¬¦ã¾]; if (!defined($bœÛîçÆĞœ[454])) { return; } $aÆİˆÚÆï¶ = array(); goto AøŸ°ˆ¦ƒ; AøŸ°ˆ¦ƒ: foreach ($B… Ú®¦¢’ as $A‡›´èî¾†) { if ($A‡›´èî¾†[$bœÛîçÆĞœ[404]] == self::TYPE_GROUP) { $aÆİˆÚÆï¶[] = $A‡›´èî¾†[$bœÛîçÆĞœ[395]]; } } if (!$aÆİˆÚÆï¶) { return; } $cµ„õŸ  = array_to_keyvalue($B… Ú®¦¢’, $bœÛîçÆĞœ[395]); goto A“¯¦Ò’¹¼; A“¯¦Ò’¹¼: $e‰ ¾Ö¨Ş“ = Model($bœÛîçÆĞœ[482])->getSourceList($aÆİˆÚÆï¶, $cµ„õŸ ); foreach ($B… Ú®¦¢’ as $EŞ½ôµè–Ó => &$A‡›´èî¾†) { $A‡›´èî¾†[$bœÛîçÆĞœ[406]] = $e‰ ¾Ö¨Ş“[$A‡›´èî¾†[$bœÛîçÆĞœ[395]]]; if (!$A‡›´èî¾†[$bœÛîçÆĞœ[406]] && $A‡›´èî¾†[$bœÛîçÆĞœ[404]] == self::TYPE_GROUP) { $A‡›´èî¾†[$bœÛîçÆĞœ[406]] = Action($bœÛîçÆĞœ[483])->pathGroupAuthMake($A‡›´èî¾†[$bœÛîçÆĞœ[484]]); if (!$A‡›´èî¾†[$bœÛîçÆĞœ[406]] && !_get($GLOBALS, $bœÛîçÆĞœ[485])) { $A‡›´èî¾†[$bœÛîçÆĞœ[196]] = !1; $A‡›´èî¾†[$bœÛîçÆĞœ[195]] = !1; } } if ($A‡›´èî¾†[$bœÛîçÆĞœ[406]]) { $A‡›´èî¾†[$bœÛîçÆĞœ[196]] = AuthModel::authCheckEdit($A‡›´èî¾†[$bœÛîçÆĞœ[406]][$bœÛîçÆĞœ[407]]); $A‡›´èî¾†[$bœÛîçÆĞœ[195]] = AuthModel::authCheckView($A‡›´èî¾†[$bœÛîçÆĞœ[406]][$bœÛîçÆĞœ[407]]); } $this->groupPathDisplay($A‡›´èî¾†); } unset($A‡›´èî¾†); goto dÃ¡ÛÅĞ; dÃ¡ÛÅĞ: } public function groupPathDisplay(&$a¬½’š…–É) { goto BÄ„ÃİóŠ; BÄ„ÃİóŠ: $FÚÁÇ‰ª˜ =& $_SERVER[¬¦ã¾]; if ($a¬½’š…–É[$FÚÁÇ‰ª˜[404]] != self::TYPE_GROUP) { return; } $A×¬Ü¾ÈÜÛ = Model($FÚÁÇ‰ª˜[486])->getInfo($a¬½’š…–É[$FÚÁÇ‰ª˜[484]]); goto cÜæ Ÿ”±ò; c¸”½§Ãğ¼: $a¬½’š…–É[$FÚÁÇ‰ª˜[492]] = $C¶Ìá«íêì . $A×¬Ü¾ÈÜÛ[$FÚÁÇ‰ª˜[85]][$FÚÁÇ‰ª˜[395]]; goto Bš´Î˜Ó›; cÜæ Ÿ”±ò: $d¹ŠîùŞ‚ä = $this->parentLevelArray($A×¬Ü¾ÈÜÛ[$FÚÁÇ‰ª˜[487]]); $C¶Ìá«íêì = $FÚÁÇ‰ª˜[33]; foreach ($d¹ŠîùŞ‚ä as $EŸÍ‰‰Û²÷) { $dñåø Í±å = Model($FÚÁÇ‰ª˜[486])->getInfo($EŸÍ‰‰Û²÷); $C¶Ìá«íêì .= $dñåø Í±å[$FÚÁÇ‰ª˜[85]][$FÚÁÇ‰ª˜[395]] . $FÚÁÇ‰ª˜[47]; } goto b÷é×–é¼è; b÷é×–é¼è: $a¬½’š…–É[$FÚÁÇ‰ª˜[488]] = $A×¬Ü¾ÈÜÛ[$FÚÁÇ‰ª˜[478]]; $a¬½’š…–É[$FÚÁÇ‰ª˜[489]] = $A×¬Ü¾ÈÜÛ[$FÚÁÇ‰ª˜[487]]; $a¬½’š…–É[$FÚÁÇ‰ª˜[490]] = $A×¬Ü¾ÈÜÛ[$FÚÁÇ‰ª˜[491]]; goto c¸”½§Ãğ¼; Bš´Î˜Ó›: } protected function _listAppendPath(&$c…åô§ôø) { goto Cğ­ªåöƒ; Cğ­ªåöƒ: $eÃÙ»È¦Ñê =& $_SERVER[¬¦ã¾]; static $bŠÕËõ±É = array(); $E‡ñ‰ŠÓà³ = array(); goto f·´¿†ôóä; f·´¿†ôóä: $BìœÀÃ©®Ó = array(); foreach ($c…åô§ôø as &$d¸˜Â¤¦š¼) { $c™ŸÌ”œŞ = $d¸˜Â¤¦š¼[$eÃÙ»È¦Ñê[403]] == $eÃÙ»È¦Ñê[87]; if ($c™ŸÌ”œŞ) { $bŠÕËõ±É[$d¸˜Â¤¦š¼[$eÃÙ»È¦Ñê[395]]] = $d¸˜Â¤¦š¼[$eÃÙ»È¦Ñê[28]]; } if (isset($BìœÀÃ©®Ó[$d¸˜Â¤¦š¼[$eÃÙ»È¦Ñê[487]]])) { continue; } $BìœÀÃ©®Ó[$d¸˜Â¤¦š¼[$eÃÙ»È¦Ñê[487]]] = !0; $dœÜÌí‘í¡ = $this->parentLevelArray($d¸˜Â¤¦š¼[$eÃÙ»È¦Ñê[487]]); foreach ($dœÜÌí‘í¡ as $DÜÔ’‘ÙÌô => $CøÙÏèÖÈ¬) { if ($DÜÔ’‘ÙÌô != 0 && !isset($bŠÕËõ±É[$CøÙÏèÖÈ¬])) { $E‡ñ‰ŠÓà³[] = $CøÙÏèÖÈ¬; } } } unset($d¸˜Â¤¦š¼); goto E†ö¬ºÄæ·; E†ö¬ºÄæ·: $E‡ñ‰ŠÓà³ = array_unique($E‡ñ‰ŠÓà³); if (count($E‡ñ‰ŠÓà³) > 0) { $EòŞÛ©Ñ‡ = array($eÃÙ»È¦Ñê[410] => array($eÃÙ»È¦Ñê[411], $E‡ñ‰ŠÓà³)); if (count($E‡ñ‰ŠÓà³) == 1) { $eó¯Í¥…ŒÛ = $this->sourceInfo($E‡ñ‰ŠÓà³[0]); $Eõ‹›§ô¡Û = is_array($eó¯Í¥…ŒÛ) ? array($eó¯Í¥…ŒÛ) : !1; } else { $Eõ‹›§ô¡Û = $this->field($eÃÙ»È¦Ñê[493])->where($EòŞÛ©Ñ‡)->select(); } if (!$Eõ‹›§ô¡Û) { $Eõ‹›§ô¡Û = array(); } foreach ($Eõ‹›§ô¡Û as $A¹ìÇ—óŸ) { $bŠÕËõ±É[$A¹ìÇ—óŸ[$eÃÙ»È¦Ñê[395]]] = $A¹ìÇ—óŸ[$eÃÙ»È¦Ñê[28]]; } } $b‹ËÊÄÚ¦² = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); goto fÁœƒ«Æ÷; f’ë°…îŞ: unset($d¸˜Â¤¦š¼); return $c…åô§ôø; goto F²‚±Û¾ßÅ; fÁœƒ«Æ÷: $Eê‚¡¸¶ğ… = array(); $e¿«Œ××ÀÙ = array(); foreach ($c…åô§ôø as &$d¸˜Â¤¦š¼) { goto bŞ ±’ÊÄè; bŞ ±’ÊÄè: $BÚ¬â‘¬ß = $d¸˜Â¤¦š¼[$eÃÙ»È¦Ñê[487]]; if (isset($e¿«Œ××ÀÙ[$BÚ¬â‘¬ß])) { $Fí®è–‡ï = $Eê‚¡¸¶ğ…[$BÚ¬â‘¬ß]; } else { $dœÜÌí‘í¡ = $this->parentLevelArray($d¸˜Â¤¦š¼[$eÃÙ»È¦Ñê[487]]); $b„µ‡Ş±³Ó = $eÃÙ»È¦Ñê[494] . $d¸˜Â¤¦š¼[$eÃÙ»È¦Ñê[404]] . $eÃÙ»È¦Ñê[440] . $d¸˜Â¤¦š¼[$eÃÙ»È¦Ñê[484]]; if ($Eê‚¡¸¶ğ…[$b„µ‡Ş±³Ó]) { $Fí®è–‡ï = $Eê‚¡¸¶ğ…[$b„µ‡Ş±³Ó]; } else { $Fí®è–‡ï = $this->_listAppendPathRoot($d¸˜Â¤¦š¼, $dœÜÌí‘í¡); $Eê‚¡¸¶ğ…[$b„µ‡Ş±³Ó] = $Fí®è–‡ï; } foreach ($dœÜÌí‘í¡ as $DÜÔ’‘ÙÌô => $CøÙÏèÖÈ¬) { if ($DÜÔ’‘ÙÌô == 0 && $Fí®è–‡ï && $d¸˜Â¤¦š¼[$eÃÙ»È¦Ñê[404]] == self::TYPE_GROUP) { continue; } if (isset($bŠÕËõ±É[$CøÙÏèÖÈ¬])) { $Fí®è–‡ï .= $bŠÕËõ±É[$CøÙÏèÖÈ¬] . $eÃÙ»È¦Ñê[8]; } } if ($dœÜÌí‘í¡) { $Fí®è–‡ï .= $d¸˜Â¤¦š¼[$eÃÙ»È¦Ñê[28]]; } $Eê‚¡¸¶ğ…[$BÚ¬â‘¬ß] = $Fí®è–‡ï; } if ($d¸˜Â¤¦š¼[$eÃÙ»È¦Ñê[403]]) { $Fí®è–‡ï .= $eÃÙ»È¦Ñê[8]; } goto d™™™ÁÌõò; d™™™ÁÌõò: $d¸˜Â¤¦š¼[$eÃÙ»È¦Ñê[495]] = str_replace($eÃÙ»È¦Ñê[496], $eÃÙ»È¦Ñê[8], $Fí®è–‡ï); $eÔŒØµâ˜” = trim($d¸˜Â¤¦š¼[$eÃÙ»È¦Ñê[495]], $eÃÙ»È¦Ñê[8]); if ($d¸˜Â¤¦š¼[$eÃÙ»È¦Ñê[478]] == $eÃÙ»È¦Ñê[191] && $eÔŒØµâ˜”) { $d¸˜Â¤¦š¼[$eÃÙ»È¦Ñê[28]] = $eÔŒØµâ˜”; } goto CêŸƒ‹ÊĞã; CêŸƒ‹ÊĞã: if (intval($d¸˜Â¤¦š¼[$eÃÙ»È¦Ñê[404]]) == self::TYPE_SYSTEM) { $this->_listAppendPathRecycle($d¸˜Â¤¦š¼, $dœÜÌí‘í¡, $b‹ËÊÄÚ¦²); } goto a“Ó‘Òï‘†; a“Ó‘Òï‘†: } goto f’ë°…îŞ; F²‚±Û¾ßÅ: } private function _listAppendPathRecycle(&$BŸÑ Ù…, $E¤–Ñ¾¶ªÍ, $F®åõÄ¦œƒ) { goto Fô§á•Û¶«; Aœ…Œ‚Ÿ®Û: $B¹ƒ†ªÜÏ = implode($E„¦®§‘½[8], array_slice($cî‘ÓÀ‚, 2)); $BŸÑ Ù…[$E„¦®§‘½[495]] = $E„¦®§‘½[8] . LNG($E„¦®§‘½[497]) . $E„¦®§‘½[8] . ltrim($B¹ƒ†ªÜÏ, $E„¦®§‘½[8]); $BŸÑ Ù…[$E„¦®§‘½[487]] = $E„¦®§‘½[498] . implode($E„¦®§‘½[47], array_slice($E¤–Ñ¾¶ªÍ, 1)) . $E„¦®§‘½[47]; goto fÉ¨ƒÜÌŠé; fÉ¨ƒÜÌŠé: if ($BŸÑ Ù…[$E„¦®§‘½[395]] == $F®åõÄ¦œƒ) { $BŸÑ Ù…[$E„¦®§‘½[487]] = $E„¦®§‘½[498]; $BŸÑ Ù…[$E„¦®§‘½[478]] = $E„¦®§‘½[191]; $BŸÑ Ù…[$E„¦®§‘½[28]] = LNG($E„¦®§‘½[497]); } $BŸÑ Ù…[$E„¦®§‘½[499]] = $E„¦®§‘½[500]; goto dË­±œ¥ì ; Fô§á•Û¶«: $E„¦®§‘½ =& $_SERVER[¬¦ã¾]; if (!in_array($F®åõÄ¦œƒ, $E¤–Ñ¾¶ªÍ) && $BŸÑ Ù…[$E„¦®§‘½[395]] != $F®åõÄ¦œƒ) { return; } $cî‘ÓÀ‚ = explode($E„¦®§‘½[8], trim($BŸÑ Ù…[$E„¦®§‘½[495]], $E„¦®§‘½[8])); goto Aœ…Œ‚Ÿ®Û; dË­±œ¥ì : } protected function _listAppendPathRoot(&$bÈô¯›É‚†, $aáÍÀ¥ª„¦) { $e‡½œ¦Ó™ =& $_SERVER[¬¦ã¾]; $bÕŞ•£Ö˜Œ = $e‡½œ¦Ó™[33]; if ($bÈô¯›É‚†[$e‡½œ¦Ó™[404]] == self::TYPE_USER) { if (defined($e‡½œ¦Ó™[454]) && $bÈô¯›É‚†[$e‡½œ¦Ó™[484]] == USER_ID) { $bÕŞ•£Ö˜Œ = LNG($e‡½œ¦Ó™[501]); if (!$aáÍÀ¥ª„¦) { $bÈô¯›É‚†[$e‡½œ¦Ó™[28]] = $bÕŞ•£Ö˜Œ; } } else { $fÄª²›ó± = Model($e‡½œ¦Ó™[502])->getInfoSimple($bÈô¯›É‚†[$e‡½œ¦Ó™[484]]); $bÕŞ•£Ö˜Œ = LNG($e‡½œ¦Ó™[503]) . $e‡½œ¦Ó™[160] . $fÄª²›ó±[$e‡½œ¦Ó™[28]] . $e‡½œ¦Ó™[504]; } } else { if ($bÈô¯›É‚†[$e‡½œ¦Ó™[404]] == self::TYPE_GROUP) { $fÄª²›ó± = Model($e‡½œ¦Ó™[486])->getInfoSimple($bÈô¯›É‚†[$e‡½œ¦Ó™[484]]); $bÕŞ•£Ö˜Œ = $fÄª²›ó±[$e‡½œ¦Ó™[28]]; } else { if ($bÈô¯›É‚†[$e‡½œ¦Ó™[404]] == self::TYPE_SYSTEM) { $bÕŞ•£Ö˜Œ = $e‡½œ¦Ó™[505]; } } } $bÕŞ•£Ö˜Œ = $bÕŞ•£Ö˜Œ ? $e‡½œ¦Ó™[8] . $bÕŞ•£Ö˜Œ . $e‡½œ¦Ó™[8] : $e‡½œ¦Ó™[8]; return $bÕŞ•£Ö˜Œ; } protected function _listAppendUser(&$DÍ³È¤äÒ˜) { goto fÅÉ³“¸·Ü; bÕÍèí‘ªÍ: unset($fšƒÊ“ÍÓ³); goto bÉ“ƒè¾©¼; fÂÒ·™äº: $bÓ…ÍÔ¨µ¤ = array_merge($E½èãºµ®, $fê¸·¦î•); $Cù£Íãã´ = Model($dæĞ¹Ê‡[506])->userListInfo($bÓ…ÍÔ¨µ¤); foreach ($DÍ³È¤äÒ˜ as &$fšƒÊ“ÍÓ³) { $dÖÖ„²‘© = $fšƒÊ“ÍÓ³[$dæĞ¹Ê‡[432]]; $fšƒÊ“ÍÓ³[$dæĞ¹Ê‡[432]] = $Cù£Íãã´[$dÖÖ„²‘©] ? $Cù£Íãã´[$dÖÖ„²‘©] : !1; $dÖÖ„²‘© = $fšƒÊ“ÍÓ³[$dæĞ¹Ê‡[434]]; $fšƒÊ“ÍÓ³[$dæĞ¹Ê‡[434]] = $Cù£Íãã´[$dÖÖ„²‘©] ? $Cù£Íãã´[$dÖÖ„²‘©] : !1; if (isset($fšƒÊ“ÍÓ³[$dæĞ¹Ê‡[445]]) && $fšƒÊ“ÍÓ³[$dæĞ¹Ê‡[445]][$dæĞ¹Ê‡[507]]) { $FÇ¤“ÄÊ = $GLOBALS[$dæĞ¹Ê‡[6]][$dæĞ¹Ê‡[88]][$dæĞ¹Ê‡[508]]; if ($fšƒÊ“ÍÓ³[$dæĞ¹Ê‡[445]][$dæĞ¹Ê‡[509]] <= time() - $FÇ¤“ÄÊ) { $this->metaSet($fšƒÊ“ÍÓ³[$dæĞ¹Ê‡[395]], $dæĞ¹Ê‡[507], null); $this->metaSet($fšƒÊ“ÍÓ³[$dæĞ¹Ê‡[395]], $dæĞ¹Ê‡[509], null); unset($fšƒÊ“ÍÓ³[$dæĞ¹Ê‡[445]][$dæĞ¹Ê‡[507]]); continue; } $b¦ª…é•Ñİ = $fšƒÊ“ÍÓ³[$dæĞ¹Ê‡[445]][$dæĞ¹Ê‡[507]]; $fšƒÊ“ÍÓ³[$dæĞ¹Ê‡[445]][$dæĞ¹Ê‡[510]] = Model($dæĞ¹Ê‡[506])->getInfoSimpleOuter($b¦ª…é•Ñİ); } } goto bÕÍèí‘ªÍ; fÅÉ³“¸·Ü: $dæĞ¹Ê‡ =& $_SERVER[¬¦ã¾]; $E½èãºµ® = array_to_keyvalue($DÍ³È¤äÒ˜, $dæĞ¹Ê‡[33], $dæĞ¹Ê‡[432]); $fê¸·¦î• = array_to_keyvalue($DÍ³È¤äÒ˜, $dæĞ¹Ê‡[33], $dæĞ¹Ê‡[434]); goto fÂÒ·™äº; bÉ“ƒè¾©¼: } public function parentLevelArray($A‘Âö½°ò±) { $fÄÂâ¡Œ§Ï =& $_SERVER[¬¦ã¾]; $A‘Âö½°ò± = explode($fÄÂâ¡Œ§Ï[47], trim($A‘Âö½°ò±, $fÄÂâ¡Œ§Ï[47])); return array_remove_value($A‘Âö½°ò±, $fÄÂâ¡Œ§Ï[191]); } public function listAll($d»ß¡Êß) { goto D¿Ş×¡éÔÉ; còâÛ‚Ì¯½: $BÖ†¨åÛòµ = array(); foreach ($F£À Şô¬‡ as $f˜èÏŞ§ÂÍ => $D‹§¢Š““ò) { goto E˜Û¡ôÖòã; e‡İ ’¸ƒ: $eßİìóê±§ = str_replace($eºË¦­ÉÄá[496], $eºË¦­ÉÄá[8], $eßİìóê±§); $eßİìóê±§ = str_replace($eºË¦­ÉÄá[496], $eºË¦­ÉÄá[8], $eßİìóê±§); $Bõğ„§Æ…Æ = array($eºË¦­ÉÄá[414] => str_replace($eºË¦­ÉÄá[496], $eºË¦­ÉÄá[8], $eßİìóê±§), $eºË¦­ÉÄá[517] => intval($D‹§¢Š““ò[$eºË¦­ÉÄá[403]]), $eºË¦­ÉÄá[85] => $this->pathInfoFilter($D‹§¢Š““ò)); goto A‚É›åÌˆ; E˜Û¡ôÖòã: $fÍŞâÈ¦óÎ = $this->parentLevelArray($D‹§¢Š““ò[$eºË¦­ÉÄá[487]]); array_shift($fÍŞâÈ¦óÎ); $eßİìóê±§ = $dÈ¶Ğ š¾’; goto B¦êÄ™ŒÄÂ; B¦êÄ™ŒÄÂ: for ($f“øê¸Õå† = 0; $f“øê¸Õå† < count($fÍŞâÈ¦óÎ); $f“øê¸Õå†++) { $eßİìóê±§ .= $F£À Şô¬‡[$fÍŞâÈ¦óÎ[$f“øê¸Õå†]][$eºË¦­ÉÄá[28]] . $eºË¦­ÉÄá[8]; } $eßİìóê±§ .= $D‹§¢Š““ò[$eºË¦­ÉÄá[28]]; if ($D‹§¢Š““ò[$eºË¦­ÉÄá[403]]) { $eßİìóê±§ .= $eºË¦­ÉÄá[8]; } goto e‡İ ’¸ƒ; A‚É›åÌˆ: if (!$D‹§¢Š““ò[$eºË¦­ÉÄá[403]]) { $Bõğ„§Æ…Æ[$eºË¦­ÉÄá[447]] = $D‹§¢Š““ò[$eºË¦­ÉÄá[447]]; $Bõğ„§Æ…Æ[$eºË¦­ÉÄá[86]] = $D‹§¢Š““ò[$eºË¦­ÉÄá[76]]; } $BÖ†¨åÛòµ[] = $Bõğ„§Æ…Æ; goto Bäİ‡¤ª°ó; Bäİ‡¤ª°ó: } return $BÖ†¨åÛòµ; goto bì—éÍöù½; A‹³¾æÙœé: $F£À Şô¬‡ = array_to_keyvalue($F£À Şô¬‡, $eºË¦­ÉÄá[395]); $dÈ¶Ğ š¾’ = "\x2f{$FŠëÙ­±Ûâ[$eºË¦­ÉÄá[28]]}\x2f"; $dÈ¶Ğ š¾’ = $dÈ¶Ğ š¾’ == $eºË¦­ÉÄá[496] ? $eºË¦­ÉÄá[8] : $dÈ¶Ğ š¾’; goto còâÛ‚Ì¯½; Bòá…¯®: $E»æôÓÊ = $eºË¦­ÉÄá[515]; $D„ãµù÷°¿ = "\x4c\x45\x46\124\40\112\117\x49\116\x20{$this->tablePrefix}\151\157\x5f\146\x69\154\145\40\146\151\x6c\x65\x20\157\156\x20\163\157\x75\x72\143\145\x2e\x66\x69\154\145\x49\x44\x20\x3d\40\x66\151\154\145\x2e\x66\151\x6c\145\111\x44"; $F£À Şô¬‡ = $this->alias($eºË¦­ÉÄá[516])->field($E»æôÓÊ)->where($BÕ©æÓ’‹Ù)->join($D„ãµù÷°¿)->select(); goto cä‚ÖößÒ; cä‚ÖößÒ: $this->_listAppendAuth($F£À Şô¬‡); $this->_listAppendUser($F£À Şô¬‡); $this->_listAppendPath($F£À Şô¬‡); goto A‹³¾æÙœé; D¿Ş×¡éÔÉ: $eºË¦­ÉÄá =& $_SERVER[¬¦ã¾]; $FŠëÙ­±Ûâ = $this->sourceInfo($d»ß¡Êß); $BÕ©æÓ’‹Ù = array($eºË¦­ÉÄá[511] => array($eºË¦­ÉÄá[512], $FŠëÙ­±Ûâ[$eºË¦­ÉÄá[487]] . $d»ß¡Êß . $eºË¦­ÉÄá[513]), $eºË¦­ÉÄá[514] => 0); goto Bòá…¯®; bì—éÍöù½: } } class SourceListMoveModel extends SourceListModel { public $allowLockSource = 1; public $moveClearAuth = true; public function allowLock() { return $this->allowLockSource; } public function lockCopyStart($f¨™³ŒÀ‘…) { goto e«“ê¯Ú¤Ñ; FëƒƒÓÛˆÃ: $cÍïÌ„ÄÌ¡ = 1; $this->_lockEvent($f¨™³ŒÀ‘…, array($E„Ô‰ğ¿‹[519], $E„Ô‰ğ¿‹[520]), $cÍïÌ„ÄÌ¡); $this->_lockParent($f¨™³ŒÀ‘…, array($E„Ô‰ğ¿‹[520]), $cÍïÌ„ÄÌ¡); goto EâÖŠæÈ¤ë; EâÖŠæÈ¤ë: $this->_lockEvent($f¨™³ŒÀ‘…, array($E„Ô‰ğ¿‹[521], $E„Ô‰ğ¿‹[522]), $cÍïÌ„ÄÌ¡); $this->_lockCheckEnd($E„Ô‰ğ¿‹[518], $f¨™³ŒÀ‘…); goto A†¦ŠÊ‹ßÈ; e«“ê¯Ú¤Ñ: $E„Ô‰ğ¿‹ =& $_SERVER[¬¦ã¾]; if (!$this->allowLock()) { return; } $this->_lockCheck($E„Ô‰ğ¿‹[518], $f¨™³ŒÀ‘…); goto FëƒƒÓÛˆÃ; A†¦ŠÊ‹ßÈ: } public function lockCopyEnd($eé†“Ûèœ¿) { $AÄÑÂœ¨ =& $_SERVER[¬¦ã¾]; if (!$this->allowLock()) { return; } $bêÃã˜˜ìÅ = 0; $this->_lockEvent($eé†“Ûèœ¿, array($AÄÑÂœ¨[519], $AÄÑÂœ¨[520]), $bêÃã˜˜ìÅ); $this->_lockParent($eé†“Ûèœ¿, array($AÄÑÂœ¨[520]), $bêÃã˜˜ìÅ); $this->_lockEvent($eé†“Ûèœ¿, array($AÄÑÂœ¨[521], $AÄÑÂœ¨[522]), $bêÃã˜˜ìÅ); } public function lockWriteStart($CÀÚ‡¡œÁÀ, $D‹¡Ò÷’Ğó = '') { goto fµ¢íë¹òî; fµ¢íë¹òî: $cŠŠÓŠ®òÃ =& $_SERVER[¬¦ã¾]; if (!$this->allowLock()) { return; } $this->_lockCheck($cŠŠÓŠ®òÃ[519], $CÀÚ‡¡œÁÀ); goto bÉÅÚ×‚î; aÜ†Ÿ²Åê: $this->_lockParent($CÀÚ‡¡œÁÀ, array($cŠŠÓŠ®òÃ[518], $cŠŠÓŠ®òÃ[520]), $c›†îê‹£Í); $this->_lockCheckEnd($cŠŠÓŠ®òÃ[519], $CÀÚ‡¡œÁÀ); goto DÖª‹²£Ä; bÉÅÚ×‚î: $c›†îê‹£Í = 1; $this->_lockKey($cŠŠÓŠ®òÃ[523] . $CÀÚ‡¡œÁÀ . $cŠŠÓŠ®òÃ[95] . $D‹¡Ò÷’Ğó, $c›†îê‹£Í); $this->_lockEvent($CÀÚ‡¡œÁÀ, array($cŠŠÓŠ®òÃ[518], $cŠŠÓŠ®òÃ[520]), $c›†îê‹£Í); goto aÜ†Ÿ²Åê; DÖª‹²£Ä: } public function lockWriteEnd($dìÁù×‚§Ø, $Dáæ£ğ·Í¬ = '') { $B†ùºİ ÖÉ =& $_SERVER[¬¦ã¾]; if (!$this->allowLock()) { return; } $dĞ‡ê©ùÒø = 0; $this->_lockKey($B†ùºİ ÖÉ[523] . $dìÁù×‚§Ø . $B†ùºİ ÖÉ[95] . $Dáæ£ğ·Í¬, $dĞ‡ê©ùÒø); $this->_lockEvent($dìÁù×‚§Ø, array($B†ùºİ ÖÉ[518], $B†ùºİ ÖÉ[520]), $dĞ‡ê©ùÒø); $this->_lockParent($dìÁù×‚§Ø, array($B†ùºİ ÖÉ[518], $B†ùºİ ÖÉ[520]), $dĞ‡ê©ùÒø); } public function lockMoveStart($E²‹º¹ì¦) { goto BãÔ™› †‰; b“£ÓŞ³¦: $då…ÆÎ¯Ó‡ = 1; $this->_lockKey($C‡ï–¢Ÿ­è[524] . $E²‹º¹ì¦, $då…ÆÎ¯Ó‡); $this->_lockEvent($E²‹º¹ì¦, array($C‡ï–¢Ÿ­è[518], $C‡ï–¢Ÿ­è[519]), $då…ÆÎ¯Ó‡); goto bÎä¸ Âç‡; BãÔ™› †‰: $C‡ï–¢Ÿ­è =& $_SERVER[¬¦ã¾]; if (!$this->allowLock()) { return; } $this->_lockCheck($C‡ï–¢Ÿ­è[520], $E²‹º¹ì¦); goto b“£ÓŞ³¦; bÎä¸ Âç‡: $this->_lockParent($E²‹º¹ì¦, array($C‡ï–¢Ÿ­è[518], $C‡ï–¢Ÿ­è[520]), $då…ÆÎ¯Ó‡); $this->_lockEvent($E²‹º¹ì¦, array($C‡ï–¢Ÿ­è[525], $C‡ï–¢Ÿ­è[521], $C‡ï–¢Ÿ­è[522]), $då…ÆÎ¯Ó‡); $this->_lockCheckEnd($C‡ï–¢Ÿ­è[520], $E²‹º¹ì¦); goto DÑÓìç¦ğ÷; DÑÓìç¦ğ÷: } public function lockMoveEnd($Cé‚ŒßÕï’) { goto C´èÂßçÒ; DšÕ¾¢Œ‘: $this->_lockEvent($Cé‚ŒßÕï’, array($Cáæòï­Š[525], $Cáæòï­Š[521], $Cáæòï­Š[522]), $D¨©÷¦ó¶‘); goto C™¥Œ†Š£î; C´èÂßçÒ: $Cáæòï­Š =& $_SERVER[¬¦ã¾]; if (!$this->allowLock()) { return; } $D¨©÷¦ó¶‘ = 0; goto A«ŠÂ»Êòİ; A«ŠÂ»Êòİ: $this->_lockKey($Cáæòï­Š[524] . $Cé‚ŒßÕï’, $D¨©÷¦ó¶‘); $this->_lockEvent($Cé‚ŒßÕï’, array($Cáæòï­Š[518], $Cáæòï­Š[519]), $D¨©÷¦ó¶‘); $this->_lockParent($Cé‚ŒßÕï’, array($Cáæòï­Š[518], $Cáæòï­Š[520]), $D¨©÷¦ó¶‘); goto DšÕ¾¢Œ‘; C™¥Œ†Š£î: } private function _lockCheck($DÎ²µÒŞ‘, $bŠ˜•è¾â‹) { goto B²²Ş‰Òİ­; AÙ–‹Ô¸Áã: CacheLock::setErrorMsg($BË¡Şğšª[160] . htmlspecialchars($còòÕ¬ÓÒ‰[$BË¡Şğšª[28]]) . $BË¡Şğšª[504] . $dÛ¡æÄÌÆ’); $this->_lockKey($BƒÄÌ¤ò¬ì, 1); $this->_lockKey($BƒÄÌ¤ò¬ì, 0); goto C°¬î©Ğê²; C°¬î©Ğê²: $cîÅ¼å‹ˆ¬ = array_reverse($this->parentLevelArray($còòÕ¬ÓÒ‰[$BË¡Şğšª[487]])); foreach ($cîÅ¼å‹ˆ¬ as $dË”“ÓÉóê) { $BƒÄÌ¤ò¬ì = $DÎ²µÒŞ‘ . $BË¡Şğšª[527] . $dË”“ÓÉóê; if (CacheLock::lockGet($BË¡Şğšª[528] . $BƒÄÌ¤ò¬ì)) { $còòÕ¬ÓÒ‰ = $this->sourceInfo($dË”“ÓÉóê); CacheLock::setErrorMsg($BË¡Şğšª[160] . htmlspecialchars($còòÕ¬ÓÒ‰[$BË¡Şğšª[28]]) . $BË¡Şğšª[504] . $dÛ¡æÄÌÆ’); $this->_lockKey($BƒÄÌ¤ò¬ì, 1); $this->_lockKey($BƒÄÌ¤ò¬ì, 0); } } goto AÀ”öà‘‰±; B²²Ş‰Òİ­: $BË¡Şğšª =& $_SERVER[¬¦ã¾]; $còòÕ¬ÓÒ‰ = $this->sourceInfo($bŠ˜•è¾â‹); $BƒÄÌ¤ò¬ì = $DÎ²µÒŞ‘ . $BË¡Şğšª[95] . $bŠ˜•è¾â‹; goto d˜§¾Æ«É; d˜§¾Æ«É: $this->_lockTimeStart[$BƒÄÌ¤ò¬ì] = timeFloat(); if (!is_array($còòÕ¬ÓÒ‰)) { return; } $dÛ¡æÄÌÆ’ = LNG($BË¡Şğšª[526]); goto AÙ–‹Ô¸Áã; AÀ”öà‘‰±: } private function _lockCheckEnd($FÁÂ×’èº, $eâŠ­©ƒä) { goto B°Ó¥Åñ™¿; Eó´Ã¥‡­ó: if ($E…÷ší…ä‚ > 0.5) { unset(self::$cacheSourceInfo[$eïà­Ñîƒ[438] . $eâŠ­©ƒä]); } $aôæß¼Û˜ = $this->sourceInfo($eâŠ­©ƒä); if (!$aôæß¼Û˜) { show_json(LNG($eïà­Ñîƒ[105]), !1); } goto aâ’»À¤®”; dõ”¤Ğ£•è: if (!isset($this->_lockTimeStart[$Eƒ±ƒ•°²º])) { return; } $E…÷ší…ä‚ = timeFloat() - $this->_lockTimeStart[$Eƒ±ƒ•°²º]; unset($this->_lockTimeStart[$Eƒ±ƒ•°²º]); goto Eó´Ã¥‡­ó; B°Ó¥Åñ™¿: $eïà­Ñîƒ =& $_SERVER[¬¦ã¾]; $Eƒ±ƒ•°²º = $FÁÂ×’èº . $eïà­Ñîƒ[95] . $eâŠ­©ƒä; CacheLock::setErrorMsg($eïà­Ñîƒ[375]); goto dõ”¤Ğ£•è; aâ’»À¤®”: } private function _lockParent($Bõ¬ˆ¬‚¯¥, $cÊóñ¢˜Çø, $bªøå ¦›) { if (!$this->autoLockSet) { return; } $f†»‘áğÒ­ = $this->sourceInfo($Bõ¬ˆ¬‚¯¥); if (!is_array($f†»‘áğÒ­)) { return; } $b¶ñ¡Êë»ª = array_reverse($this->parentLevelArray($f†»‘áğÒ­[$_SERVER[¬¦ã¾][487]])); foreach ($b¶ñ¡Êë»ª as $cµá˜«‘ùó) { $this->_lockEvent($cµá˜«‘ùó, $cÊóñ¢˜Çø, $bªøå ¦›); } } private function _lockEvent($CÀ²ˆª®Øª, $bÓÜ†ˆöº, $DâÆ·Ç°¯Û) { $C‹ŞµÂ×¿¿ =& $_SERVER[¬¦ã¾]; if (!$this->autoLockSet) { return; } foreach ($bÓÜ†ˆöº as $A®çË·»ã) { $fğ™âÜÙˆ = $A®çË·»ã . $C‹ŞµÂ×¿¿[95] . $CÀ²ˆª®Øª; if ($DâÆ·Ç°¯Û && CacheLock::lockGet($C‹ŞµÂ×¿¿[528] . $fğ™âÜÙˆ)) { continue; } $this->_lockKey($fğ™âÜÙˆ, $DâÆ·Ç°¯Û); } } public $_lockTimeStart = array(); public $_lockTime = 5; private static $_lockItemArr = array(); private function _lockKey($Dš±‹‘Á›Š, $f¯»õ¶×àö = 1) { $Aóë˜¡ç»ä = $_SERVER[¬¦ã¾][528] . md5($Dš±‹‘Á›Š); if ($f¯»õ¶×àö) { if (isset(self::$_lockItemArr[$Aóë˜¡ç»ä])) { return; } self::$_lockItemArr[$Aóë˜¡ç»ä] = 1; CacheLock::lock($Aóë˜¡ç»ä, $this->_lockTime); } else { if (!isset(self::$_lockItemArr[$Aóë˜¡ç»ä])) { return; } unset(self::$_lockItemArr[$Aóë˜¡ç»ä]); CacheLock::unlock($Aóë˜¡ç»ä); } } public function isParentOf($dùÁÇõÜ, $eéí¥ƒÕ¥à) { goto DãîĞ‰Ø¿ì; C â¾ˆ¿¤¢: return $a¥’ÕÓ¯‡; goto EÂà„‰ì¾; C›ĞÃ—½: $c„´—šò÷ = $E¦Æ‡Á¬[$DÀƒ¶å‘ó¨[487]] . $E¦Æ‡Á¬[$DÀƒ¶å‘ó¨[395]] . $DÀƒ¶å‘ó¨[47]; $fÚƒÂæ”­² = $f·³´ÄÍ–½[$DÀƒ¶å‘ó¨[487]] . $f·³´ÄÍ–½[$DÀƒ¶å‘ó¨[395]] . $DÀƒ¶å‘ó¨[47]; $a¥’ÕÓ¯‡ = strpos($fÚƒÂæ”­², $c„´—šò÷) === 0; goto C â¾ˆ¿¤¢; DãîĞ‰Ø¿ì: $DÀƒ¶å‘ó¨ =& $_SERVER[¬¦ã¾]; $E¦Æ‡Á¬ = $this->sourceInfo($dùÁÇõÜ); $f·³´ÄÍ–½ = $this->sourceInfo($eéí¥ƒÕ¥à); goto C›ĞÃ—½; EÂà„‰ì¾: } private $targetIsDelete = 0; public function copy($aËô¼ßÄ•Ã, $Aâ¦µ®”í, $F‹‘´®æÌŒ = REPEAT_REPLACE, $EÏ¼£ö†Üó = '') { goto f¤“°Ç£½‡; fÖ£Ôî‡Ã: $this->targetIsDelete = intval($còïŞÖÅŠ­[$Fİ’áÃ®é‚[423]]); $fšĞ¤ÂÖ„ = $this->fileNameExistCache($Aâ¦µ®”í, $còïŞÖÅŠ­[$Fİ’áÃ®é‚[28]]); $eì“‰ºâÂ = $this->_copy($aËô¼ßÄ•Ã, $Aâ¦µ®”í, $F‹‘´®æÌŒ, $B××—º’ô, !0, $EÏ¼£ö†Üó); goto DÜÑœ‡¹½; C¼Ò¾¡—çÎ: $this->saveAll($B××—º’ô[$Fİ’áÃ®é‚[531]]); Model($Fİ’áÃ®é‚[193])->linkAdd($B××—º’ô[$Fİ’áÃ®é‚[529]]); $this->folderSizeReset($Aâ¦µ®”í); goto Aãî½ˆ‚ˆ‰; F¿â®ŒŸ–: if ($còïŞÖÅŠ­[$Fİ’áÃ®é‚[403]] == $Fİ’áÃ®é‚[87] && $fšĞ¤ÂÖ„ == $eì“‰ºâÂ) { $this->folderSizeResetChildren($fšĞ¤ÂÖ„); } Model($Fİ’áÃ®é‚[532])->addAll($B××—º’ô[$Fİ’áÃ®é‚[530]], array(), !0); if ($fšĞ¤ÂÖ„ != $eì“‰ºâÂ || $còïŞÖÅŠ­[$Fİ’áÃ®é‚[403]] == $Fİ’áÃ®é‚[87]) { Model($Fİ’áÃ®é‚[533])->eventCopy($eì“‰ºâÂ); } goto C¼Ò¾¡—çÎ; f¤“°Ç£½‡: $Fİ’áÃ®é‚ =& $_SERVER[¬¦ã¾]; $còïŞÖÅŠ­ = $this->sourceInfo($aËô¼ßÄ•Ã); $CÊ¯¦·¾Üé = $this->sourceInfo($Aâ¦µ®”í); goto b§×ˆ‡”‰Ğ; AåŞ¥„ÎÈÀ: $this->lockCopyStart($aËô¼ßÄ•Ã); $this->lockWriteStart($Aâ¦µ®”í, $d˜†šµ×Ÿ…); $B××—º’ô = array($Fİ’áÃ®é‚[529] => array(), $Fİ’áÃ®é‚[530] => array(), $Fİ’áÃ®é‚[531] => array()); goto fÖ£Ôî‡Ã; DÜÑœ‡¹½: $this->_childrenListClear(); $this->lockCopyEnd($aËô¼ßÄ•Ã); $this->lockWriteEnd($Aâ¦µ®”í, $d˜†šµ×Ÿ…); goto F¿â®ŒŸ–; b§×ˆ‡”‰Ğ: if (!$còïŞÖÅŠ­ || !$CÊ¯¦·¾Üé || $CÊ¯¦·¾Üé[$Fİ’áÃ®é‚[403]] != $Fİ’áÃ®é‚[87]) { return !1; } if ($this->isParentOf($aËô¼ßÄ•Ã, $Aâ¦µ®”í)) { return !1; } $d˜†šµ×Ÿ… = $EÏ¼£ö†Üó ? $EÏ¼£ö†Üó : $còïŞÖÅŠ­[$Fİ’áÃ®é‚[28]]; goto AåŞ¥„ÎÈÀ; Aãî½ˆ‚ˆ‰: $this->updateModifyTime($Aâ¦µ®”í); return $eì“‰ºâÂ; goto f½‡¡íÌª¹; f½‡¡íÌª¹: } private function _copy($D¶êØ×Ûç, $có®ßÚˆĞ›, $a­Ã‹†Ğ©‰, &$f¸Õ‰ªÓå¶, $d™Ûä¶É, $b¿á¡›¸¹ = '') { goto DßõĞ‹; A°õÀ†â­‘: return $D‹‚İí·ğ; goto AßÙ æ; DßõĞ‹: $C«¹Â†Â¬ó =& $_SERVER[¬¦ã¾]; $cÁÃªßåˆÄ = $this->sourceInfoCache($D¶êØ×Ûç); $aî÷Ô™“Øõ = $cÁÃªßåˆÄ[$C«¹Â†Â¬ó[403]] == $C«¹Â†Â¬ó[87]; goto Eáºœ£ĞË; Eáºœ£ĞË: $fÖØ‹—ºŞ = $b¿á¡›¸¹ ? $b¿á¡›¸¹ : $cÁÃªßåˆÄ[$C«¹Â†Â¬ó[28]]; $bøóáÓ”éô = $this->fileNameExistCache($có®ßÚˆĞ›, $fÖØ‹—ºŞ); if ($d™Ûä¶É) { $this->_childrenAllMake($D¶êØ×Ûç); if ($aî÷Ô™“Øõ && $bøóáÓ”éô) { $this->_childrenAllMake($bøóáÓ”éô); } } goto F÷Êö„éù; F÷Êö„éù: if (!$bøóáÓ”éô) { return $this->_copyCreate($D¶êØ×Ûç, $có®ßÚˆĞ›, $fÖØ‹—ºŞ, $f¸Õ‰ªÓå¶); } $D‹‚İí·ğ = $bøóáÓ”éô; if ($aî÷Ô™“Øõ) { if ($a­Ã‹†Ğ©‰ == REPEAT_RENAME_FOLDER) { $fÖØ‹—ºŞ = $this->fileNameAutoCache($có®ßÚˆĞ›, $fÖØ‹—ºŞ, $a­Ã‹†Ğ©‰, $aî÷Ô™“Øõ); $D‹‚İí·ğ = $this->_copyCreate($D¶êØ×Ûç, $có®ßÚˆĞ›, $fÖØ‹—ºŞ, $f¸Õ‰ªÓå¶); } else { $bé„™Úù¸• = $this->_childrenList($D¶êØ×Ûç); foreach ($bé„™Úù¸• as $F¾¯¤ÕÂïÏ) { $this->_copy($F¾¯¤ÕÂïÏ[$C«¹Â†Â¬ó[395]], $bøóáÓ”éô, $a­Ã‹†Ğ©‰, $f¸Õ‰ªÓå¶, !1); } } } else { if ($a­Ã‹†Ğ©‰ == REPEAT_RENAME || $a­Ã‹†Ğ©‰ == REPEAT_RENAME_FOLDER) { $fÖØ‹—ºŞ = $this->fileNameAutoCache($có®ßÚˆĞ›, $fÖØ‹—ºŞ, $a­Ã‹†Ğ©‰, $aî÷Ô™“Øõ); $D‹‚İí·ğ = $this->_copyCreate($D¶êØ×Ûç, $có®ßÚˆĞ›, $fÖØ‹—ºŞ, $f¸Õ‰ªÓå¶); } else { if ($a­Ã‹†Ğ©‰ == REPEAT_REPLACE) { $f·ö¹„ µ = $this->sourceInfoCache($bøóáÓ”éô); $AÄ‘Ø¿Á¦¥ = $this->fileHistory($f·ö¹„ µ, $cÁÃªßåˆÄ[$C«¹Â†Â¬ó[447]], $cÁÃªßåˆÄ[$C«¹Â†Â¬ó[78]]); if ($AÄ‘Ø¿Á¦¥) { $f¸Õ‰ªÓå¶[$C«¹Â†Â¬ó[529]][] = $cÁÃªßåˆÄ[$C«¹Â†Â¬ó[447]]; } } else { if ($a­Ã‹†Ğ©‰ == REPEAT_SKIP) { } } } Hook::trigger($C«¹Â†Â¬ó[534], array($C«¹Â†Â¬ó[535], $cÁÃªßåˆÄ, 0)); } goto A°õÀ†â­‘; AßÙ æ: } private function _copyCreate($FÏƒ²‘×İ®, $F‚åÄÚ¨™°, $CÇ³ö…¶‰, &$aÕŸÜç¢°î) { goto BÅà®«Š…Š; BÅà®«Š…Š: $BËÆÌªÎ”À =& $_SERVER[¬¦ã¾]; $AòÑÔÓ…ë› = $this->sourceInfoCache($FÏƒ²‘×İ®); $b³™ñË¿²± = $this->sourceInfoCache($F‚åÄÚ¨™°); goto d…‘Ì­‹Ÿ·; aø‘’ÏƒÏ: foreach ($eš˜î››ß as $bÄ¯õÂµÕÙ) { $DŸõÇ”Ëï = $bÄ¯õÂµÕÙ[$BËÆÌªÎ”À[395]]; $CàÉÑ´˜Ë = $this->_childrenMatch($C Ø¿ìÛ¶ˆ, $bÄ¯õÂµÕÙ, $EÍ¡î±ù¨©); $c¯ªÄ¸®ö[] = array($BËÆÌªÎ”À[395], $DŸõÇ”Ëï, $BËÆÌªÎ”À[478], $CàÉÑ´˜Ë[$BËÆÌªÎ”À[478]]); $C¡…š†à”´[] = array($BËÆÌªÎ”À[395], $DŸõÇ”Ëï, $BËÆÌªÎ”À[487], $CàÉÑ´˜Ë[$BËÆÌªÎ”À[487]]); $this->_copyApplyMeta($bÄ¯õÂµÕÙ, $aÕŸÜç¢°î); if ($bÄ¯õÂµÕÙ[$BËÆÌªÎ”À[403]] != $BËÆÌªÎ”À[87]) { $aÕŸÜç¢°î[$BËÆÌªÎ”À[529]][] = $bÄ¯õÂµÕÙ[$BËÆÌªÎ”À[447]]; } } $this->chunkEventSet($BËÆÌªÎ”À[541], array($BËÆÌªÎ”À[542], $B£¾İÔ‹Äš, $EÖëáß¥)); $this->saveAll($c¯ªÄ¸®ö); goto Cå›ÒÂ‡ˆ¡; cïì§…³©×: if ($AòÑÔÓ…ë›[$BËÆÌªÎ”À[403]] != $BËÆÌªÎ”À[87]) { $aÕŸÜç¢°î[$BËÆÌªÎ”À[529]][] = $AòÑÔÓ…ë›[$BËÆÌªÎ”À[447]]; return $CÚŠÑ¯Ç÷; } $b²–À†ŒÙ = array(); $a¿‹¡Šæ” = array(); goto dãˆŒò‡¶ƒ; d¸Ü¨®àÔ›: $C Ø¿ìÛ¶ˆ[$FÏƒ²‘×İ®] = $CÚŠÑ¯Ç÷; $c¯ªÄ¸®ö = array(); $C¡…š†à”´ = array(); goto aø‘’ÏƒÏ; A°¥½çÆË: $EÍ¡î±ù¨© = $this->sourceInfo($CÚŠÑ¯Ç÷); foreach ($b²–À†ŒÙ as $bÄ¯õÂµÕÙ) { $EªÓá¯†Ã™ = $this->_makeItemData($bÄ¯õÂµÕÙ, $EÍ¡î±ù¨©, $bÄ¯õÂµÕÙ[$BËÆÌªÎ”À[28]]); $EªÓá¯†Ã™[$BËÆÌªÎ”À[487]] = $bÄ¯õÂµÕÙ[$BËÆÌªÎ”À[487]]; $a¿‹¡Šæ”[] = $EªÓá¯†Ã™; } $this->chunkEventSet($BËÆÌªÎ”À[539], array($BËÆÌªÎ”À[540], $B£¾İÔ‹Äš, $EÖëáß¥)); goto fã¤Şö§¾•; fã¤Şö§¾•: $this->addAll($a¿‹¡Šæ”, array(), !1); $eš˜î››ß = $this->where(array($BËÆÌªÎ”À[478] => $CÚŠÑ¯Ç÷))->select(); $C Ø¿ìÛ¶ˆ = $this->_childrenMakeRelation($b²–À†ŒÙ, $eš˜î››ß); goto d¸Ü¨®àÔ›; Cå›ÒÂ‡ˆ¡: $this->chunkEventSet($BËÆÌªÎ”À[543], array($BËÆÌªÎ”À[544], $B£¾İÔ‹Äš, $EÖëáß¥)); $this->saveAll($C¡…š†à”´); return $CÚŠÑ¯Ç÷; goto b÷§ßÔ †ï; c¾Ö¤šóŠØ: $CÚŠÑ¯Ç÷ = $this->add($B£¾İÔ‹Äš); $Cµ”•Ëİê¨ = array($BËÆÌªÎ”À[395] => $CÚŠÑ¯Ç÷, $BËÆÌªÎ”À[28] => $CÇ³ö…¶‰); $this->_copyApplyMeta($Cµ”•Ëİê¨, $aÕŸÜç¢°î); goto cïì§…³©×; d…‘Ì­‹Ÿ·: $B£¾İÔ‹Äš = $this->_makeItemData($AòÑÔÓ…ë›, $b³™ñË¿²±, $CÇ³ö…¶‰); Hook::trigger($BËÆÌªÎ”À[536], $B£¾İÔ‹Äš); Hook::trigger($BËÆÌªÎ”À[537], array($BËÆÌªÎ”À[538], $B£¾İÔ‹Äš, 0)); goto c¾Ö¤šóŠØ; dãˆŒò‡¶ƒ: $this->_childrenListAll($FÏƒ²‘×İ®, $b²–À†ŒÙ); $EÖëáß¥ = count($b²–À†ŒÙ); if ($EÖëáß¥ == 0) { return $CÚŠÑ¯Ç÷; } goto A°¥½çÆË; b÷§ßÔ †ï: } private function _childrenMakeRelation($E™„°ï¦¬, $eÇ»¸¬­Øš) { $fŒ¡ö‹“š² =& $_SERVER[¬¦ã¾]; $aŠãá°ğ™ = array(); $C˜è—­°“Ü = array(); foreach ($E™„°ï¦¬ as $c„ô†ææğ÷) { $f¾é†‚¥ˆ = $c„ô†ææğ÷[$fŒ¡ö‹“š²[28]] . $fŒ¡ö‹“š²[8] . $c„ô†ææğ÷[$fŒ¡ö‹“š²[487]]; $aŠãá°ğ™[$f¾é†‚¥ˆ] = $c„ô†ææğ÷[$fŒ¡ö‹“š²[395]]; } foreach ($eÇ»¸¬­Øš as $c„ô†ææğ÷) { $f¾é†‚¥ˆ = $c„ô†ææğ÷[$fŒ¡ö‹“š²[28]] . $fŒ¡ö‹“š²[8] . $c„ô†ææğ÷[$fŒ¡ö‹“š²[487]]; $fÖº„Ä·°Œ = $aŠãá°ğ™[$f¾é†‚¥ˆ]; $C˜è—­°“Ü[$fÖº„Ä·°Œ] = $c„ô†ææğ÷[$fŒ¡ö‹“š²[395]]; } return $C˜è—­°“Ü; } private function _childrenMatch($b¥µ ŸÔŠ, $déø‹¨É‹, $DéÁ©‹¥) { goto eãã‹Š Ã; Aá²¦í‘¶: $D‘Í£¦ù½® = $fŠÉ‰³Ö±Ô[count($fŠÉ‰³Ö±Ô) - 1]; return array($Dà¾çòÒ¹§[478] => $D‘Í£¦ù½®, $Dà¾çòÒ¹§[487] => $Cˆ‘áÃŠîø); goto dìôŒİƒ“§; a·ÊéÃ™Š: foreach ($a ¢¾ùƒå as $eœ†á¡ª­) { if (isset($b¥µ ŸÔŠ[$eœ†á¡ª­])) { $Cˆ‘áÃŠîø .= $b¥µ ŸÔŠ[$eœ†á¡ª­] . $Dà¾çòÒ¹§[545]; } } $Cˆ‘áÃŠîø = rtrim($Cˆ‘áÃŠîø, $Dà¾çòÒ¹§[47]) . $Dà¾çòÒ¹§[47]; $fŠÉ‰³Ö±Ô = $this->parentLevelArray($Cˆ‘áÃŠîø); goto Aá²¦í‘¶; eãã‹Š Ã: $Dà¾çòÒ¹§ =& $_SERVER[¬¦ã¾]; $Cˆ‘áÃŠîø = $DéÁ©‹¥[$Dà¾çòÒ¹§[487]]; $a ¢¾ùƒå = $this->parentLevelArray($déø‹¨É‹[$Dà¾çòÒ¹§[487]]); goto a·ÊéÃ™Š; dìôŒİƒ“§: } private function _makeItemData($b¡Ö‡ïµÚš, $dğÊ ¤˜Ü, $AŞÌß‡æµ) { $d‘‹Ö§«¨‘ =& $_SERVER[¬¦ã¾]; $eÓŒˆéÎ¦ = array($d‘‹Ö§«¨‘[546] => $b¡Ö‡ïµÚš[$d‘‹Ö§«¨‘[403]], $d‘‹Ö§«¨‘[413] => $AŞÌß‡æµ, $d‘‹Ö§«¨‘[547] => $b¡Ö‡ïµÚš[$d‘‹Ö§«¨‘[405]], $d‘‹Ö§«¨‘[448] => $b¡Ö‡ïµÚš[$d‘‹Ö§«¨‘[447]], $d‘‹Ö§«¨‘[548] => $b¡Ö‡ïµÚš[$d‘‹Ö§«¨‘[78]], $d‘‹Ö§«¨‘[549] => $dğÊ ¤˜Ü[$d‘‹Ö§«¨‘[404]], $d‘‹Ö§«¨‘[550] => $dğÊ ¤˜Ü[$d‘‹Ö§«¨‘[484]], $d‘‹Ö§«¨‘[551] => USER_ID, $d‘‹Ö§«¨‘[552] => USER_ID, $d‘‹Ö§«¨‘[394] => $dğÊ ¤˜Ü[$d‘‹Ö§«¨‘[395]], $d‘‹Ö§«¨‘[553] => $dğÊ ¤˜Ü[$d‘‹Ö§«¨‘[487]] . $dğÊ ¤˜Ü[$d‘‹Ö§«¨‘[395]] . $d‘‹Ö§«¨‘[47], $d‘‹Ö§«¨‘[417] => $b¡Ö‡ïµÚš[$d‘‹Ö§«¨‘[84]], $d‘‹Ö§«¨‘[422] => 0, $d‘‹Ö§«¨‘[554] => $d‘‹Ö§«¨‘[33]); return $eÓŒˆéÎ¦; } private function _copyApplyMeta($eºÖ¡æ„œ, &$d²ŠùÛ“) { $B››¸§¿–è =& $_SERVER[¬¦ã¾]; $A”ÖÏÇÔõà = $eºÖ¡æ„œ[$B››¸§¿–è[395]]; $e×ïÏÎÖÍº = $eºÖ¡æ„œ[$B››¸§¿–è[28]]; if (!isset($eºÖ¡æ„œ[$B››¸§¿–è[555]]) || !$eºÖ¡æ„œ[$B››¸§¿–è[555]] || $eºÖ¡æ„œ[$B››¸§¿–è[555]] == $B››¸§¿–è[191]) { $d²ŠùÛ“[$B››¸§¿–è[531]][] = array($B››¸§¿–è[395], $A”ÖÏÇÔõà, $B››¸§¿–è[555], short_id($A”ÖÏÇÔõà)); } if (Input::check($e×ïÏÎÖÍº, $B››¸§¿–è[556])) { $d²ŠùÛ“[$B››¸§¿–è[530]][] = array($B››¸§¿–è[395] => $A”ÖÏÇÔõà, $B››¸§¿–è[93] => $B››¸§¿–è[444], $B››¸§¿–è[372] => str_replace($B››¸§¿–è[50], $B››¸§¿–è[33], Pinyin::encode($e×ïÏÎÖÍº))); $d²ŠùÛ“[$B››¸§¿–è[530]][] = array($B››¸§¿–è[395] => $A”ÖÏÇÔõà, $B››¸§¿–è[93] => $B››¸§¿–è[443], $B››¸§¿–è[372] => Pinyin::encode($e×ïÏÎÖÍº, $B››¸§¿–è[557])); } } private $_childrenListCache = array(); private $_childrenItemCache = array(); private function _childrenAllMake($AöÊÄÖñœ) { goto B‚š¤²…Ş‰; fŒÙº‘Î¿µ: $FÍ«¶ğŸù‡ = array_to_keyvalue($FÍ«¶ğŸù‡, $côƒİ³©[395]); foreach ($FÍ«¶ğŸù‡ as $d†óŸÍÕ‚Ì) { $A¡ª¶æ‘Ç = $d†óŸÍÕ‚Ì[$côƒİ³©[478]]; $AöÊÄÖñœ = $d†óŸÍÕ‚Ì[$côƒİ³©[395]]; if (!isset($this->_childrenListCache[$AöÊÄÖñœ]) && $d†óŸÍÕ‚Ì[$côƒİ³©[403]] == $côƒİ³©[87]) { $this->_childrenListCache[$AöÊÄÖñœ] = array(); } if (!isset($this->_childrenListCache[$A¡ª¶æ‘Ç])) { $this->_childrenListCache[$A¡ª¶æ‘Ç] = array(); } $this->_childrenListCache[$A¡ª¶æ‘Ç][$AöÊÄÖñœ] = $d†óŸÍÕ‚Ì; $this->_childrenItemCache[$AöÊÄÖñœ] = $d†óŸÍÕ‚Ì; } goto DÍçšë‘ÔÃ; B°ÔàèŠŒÁ: $b÷¾Ç³ ‹ = array($côƒİ³©[487] => array($côƒİ³©[512], $A·Âô¯†¿ê[$côƒİ³©[487]] . $AöÊÄÖñœ . $côƒİ³©[513]), $côƒİ³©[423] => $this->targetIsDelete); $FÍ«¶ğŸù‡ = $this->field($f¥¢Ä˜ÑÅ)->where($b÷¾Ç³ ‹)->select(); if (!$FÍ«¶ğŸù‡) { return; } goto fŒÙº‘Î¿µ; B‚š¤²…Ş‰: $côƒİ³© =& $_SERVER[¬¦ã¾]; $A·Âô¯†¿ê = $this->sourceInfo($AöÊÄÖñœ); $f¥¢Ä˜ÑÅ = $côƒİ³©[424]; goto B°ÔàèŠŒÁ; DÍçšë‘ÔÃ: } private function _childrenListAll($F­ÇÌ, &$cË”‚£Šç±) { $Cæñ ‘ñ„Ù =& $_SERVER[¬¦ã¾]; if (!isset($this->_childrenListCache[$F­ÇÌ])) { return; } $E•Œ¦¨È³É = $this->_childrenListCache[$F­ÇÌ]; foreach ($E•Œ¦¨È³É as $bÛÜ²ëàøÕ => $c…”‚Áç¿) { $cË”‚£Šç±[$bÛÜ²ëàøÕ] = $c…”‚Áç¿; if ($c…”‚Áç¿[$Cæñ ‘ñ„Ù[403]] == $Cæñ ‘ñ„Ù[87]) { $this->_childrenListAll($bÛÜ²ëàøÕ, $cË”‚£Šç±); } } } private function sourceInfoCache($BØ‡òµéç) { if (isset($this->_childrenItemCache[$BØ‡òµéç])) { return $this->_childrenItemCache[$BØ‡òµéç]; } return $this->sourceInfo($BØ‡òµéç); } private function _childrenList($D†İŞ°ä©ñ) { if (isset($this->_childrenListCache[$D†İŞ°ä©ñ])) { return $this->_childrenListCache[$D†İŞ°ä©ñ]; } return $this->_childrenListSelect($D†İŞ°ä©ñ); } private function _childrenListSelect($EòËğå“) { goto C”í‘ÀØÑŠ; fõŞ¡é¹·†: $dë·œ±™‹ = $dë·œ±™‹ ? $dë·œ±™‹ : array(); $B˜†…’» = array_to_keyvalue($dë·œ±™‹, $bèÏÉ„ù[395]); $this->_childrenListCache[$EòËğå“] = $B˜†…’»; goto fÃâˆ‰‰; C”í‘ÀØÑŠ: $bèÏÉ„ù =& $_SERVER[¬¦ã¾]; $A«¥Å—×É÷ = array($bèÏÉ„ù[478] => $EòËğå“, $bèÏÉ„ù[423] => $this->targetIsDelete); $dë·œ±™‹ = $this->where($A«¥Å—×É÷)->select(); goto fõŞ¡é¹·†; fÃâˆ‰‰: foreach ($B˜†…’» as $EòËğå“ => $FÍÂ‡•Óº²) { $this->_childrenItemCache[$EòËğå“] = $FÍÂ‡•Óº²; } return $B˜†…’»; goto aÊ°’¶Œ±‘; aÊ°’¶Œ±‘: } private function fileNameExistCache($c½†á¢ÈŒ, $eŒ¥Îö©¥Ñ) { $eÛê«­¸ø¤ =& $_SERVER[¬¦ã¾]; $eŒ¥Îö©¥Ñ = strtolower($eŒ¥Îö©¥Ñ); $a÷Ü¶İ¾ = $this->_childrenList($c½†á¢ÈŒ); foreach ($a÷Ü¶İ¾ as $fßçñ¿‰‚) { if ($eŒ¥Îö©¥Ñ == strtolower($fßçñ¿‰‚[$eÛê«­¸ø¤[28]])) { return $fßçñ¿‰‚[$eÛê«­¸ø¤[395]]; } } return !1; } private function fileNameAutoCache($a¢¬Â‰ƒˆ¢, $Dñä„éâ™Ÿ, $EÙ¡ŒÖé±, $E‹‘• å­—) { $eÑŞİß½´• =& $_SERVER[¬¦ã¾]; $cšŸŒ¨¢óä = $this->_childrenList($a¢¬Â‰ƒˆ¢); $cäš®ñ†Ä• = array_to_keyvalue($cšŸŒ¨¢óä, $eÑŞİß½´•[33], $eÑŞİß½´•[28]); return $this->fileNameAutoGet($cäš®ñ†Ä•, $Dñä„éâ™Ÿ, $EÙ¡ŒÖé±, $E‹‘• å­—); } private function _childrenListClear() { $this->_childrenListCache = null; $this->_childrenItemCache = null; $this->_childrenListCache = array(); $this->_childrenItemCache = array(); } public function move($FÔËâ‡Œà¿, $bÉÓÏÉßè, $eÉŠ½®öø— = REPEAT_REPLACE, $aèÙ„Ÿ‹Ù = '') { goto fÚ÷Øâè‡´; C×›öÓÍî´: $this->folderSizeReset($bÉÓÏÉßè); $AˆĞ”öğ©à = array($C‘š”á›[$b˜Î¯¸¥ÈŠ[478]], $bÉÓÏÉßè); if ($C‘š”á›[$b˜Î¯¸¥ÈŠ[403]] == $b˜Î¯¸¥ÈŠ[87]) { $AˆĞ”öğ©à[] = $FÔËâ‡Œà¿; } goto B™™¹›³óÔ; B™™¹›³óÔ: $this->updateModifyTime($AˆĞ”öğ©à); Model($b˜Î¯¸¥ÈŠ[533])->eventMove($FÔËâ‡Œà¿, $C‘š”á›[$b˜Î¯¸¥ÈŠ[478]], $bÉÓÏÉßè); Hook::trigger($b˜Î¯¸¥ÈŠ[559], $DÚùô©†ºÍ); goto fëì„•£“Ä; fëì„•£“Ä: return $dõ¥œ‘…”Ø; goto Cè’é“¯â; B¿“ªÙõÉ•: if ($C‘š”á›[$b˜Î¯¸¥ÈŠ[478]] == $dŠ±¿¥ÒÁ„[$b˜Î¯¸¥ÈŠ[395]]) { if ($C‘š”á›[$b˜Î¯¸¥ÈŠ[423]] == $b˜Î¯¸¥ÈŠ[87]) { Model($b˜Î¯¸¥ÈŠ[421])->restore(array($FÔËâ‡Œà¿)); } if (!$aèÙ„Ÿ‹Ù || $aèÙ„Ÿ‹Ù == $C‘š”á›[$b˜Î¯¸¥ÈŠ[28]]) { return $FÔËâ‡Œà¿; } } $DÚùô©†ºÍ = $this->pathInfoMore($FÔËâ‡Œà¿); if ($this->isParentOf($FÔËâ‡Œà¿, $bÉÓÏÉßè)) { return !1; } goto c¬Ÿ›¸â»…; fÚ÷Øâè‡´: $b˜Î¯¸¥ÈŠ =& $_SERVER[¬¦ã¾]; $C‘š”á› = $this->sourceInfo($FÔËâ‡Œà¿); $dŠ±¿¥ÒÁ„ = $this->sourceInfo($bÉÓÏÉßè); goto B¿“ªÙõÉ•; C£Ï¥’ÁÌß: $this->lockMoveEnd($FÔËâ‡Œà¿); $this->lockWriteEnd($bÉÓÏÉßè, $F„÷ò§¢¤Å); $this->folderSizeReset($C‘š”á›[$b˜Î¯¸¥ÈŠ[478]]); goto C×›öÓÍî´; CŒ›µˆ‡á: $this->lockWriteStart($bÉÓÏÉßè, $F„÷ò§¢¤Å); $Dò»¡œµØ = array($b˜Î¯¸¥ÈŠ[529] => array(), $b˜Î¯¸¥ÈŠ[560] => !1); $this->clearShare($FÔËâ‡Œà¿, $bÉÓÏÉßè); goto eí½†‘™ÂÁ; B¥­ÅµÓˆŠ: if ($C‘š”á›[$b˜Î¯¸¥ÈŠ[403]] == $b˜Î¯¸¥ÈŠ[87] && $dö‡‹Î ŞÓ) { $this->folderSizeResetChildren($dõ¥œ‘…”Ø); } Model($b˜Î¯¸¥ÈŠ[193])->linkAdd($Dò»¡œµØ[$b˜Î¯¸¥ÈŠ[529]]); if ($dö‡‹Î ŞÓ && $Dò»¡œµØ[$b˜Î¯¸¥ÈŠ[560]]) { $this->removeNow($FÔËâ‡Œà¿, !1); } goto C£Ï¥’ÁÌß; c¬Ÿ›¸â»…: if (!$C‘š”á› || !$dŠ±¿¥ÒÁ„ || $dŠ±¿¥ÒÁ„[$b˜Î¯¸¥ÈŠ[403]] != $b˜Î¯¸¥ÈŠ[87]) { return !1; } Hook::trigger($b˜Î¯¸¥ÈŠ[558], $DÚùô©†ºÍ); $this->targetIsDelete = intval($C‘š”á›[$b˜Î¯¸¥ÈŠ[423]]); goto BŒ³´Œİ; eí½†‘™ÂÁ: $dö‡‹Î ŞÓ = $this->fileNameExistCache($bÉÓÏÉßè, $C‘š”á›[$b˜Î¯¸¥ÈŠ[28]]); $dõ¥œ‘…”Ø = $this->_move($FÔËâ‡Œà¿, $bÉÓÏÉßè, $eÉŠ½®öø—, $Dò»¡œµØ, $aèÙ„Ÿ‹Ù); $this->sourceCacheClear(); goto B¥­ÅµÓˆŠ; BŒ³´Œİ: if ($C‘š”á›[$b˜Î¯¸¥ÈŠ[478]] == $bÉÓÏÉßè && $aèÙ„Ÿ‹Ù != $C‘š”á›[$b˜Î¯¸¥ÈŠ[28]]) { $Aƒ›ÊÜä«¤ = $this->fileNameExist($bÉÓÏÉßè, $aèÙ„Ÿ‹Ù); if ($Aƒ›ÊÜä«¤ && $C‘š”á›[$b˜Î¯¸¥ÈŠ[403]] == $b˜Î¯¸¥ÈŠ[191]) { goto EºÉ±„£Ç‚; EºÉ±„£Ç‚: $DÅßé¦ååó = $this->sourceInfo($Aƒ›ÊÜä«¤); $A²•®çí”ˆ = $this->fileHistory($DÅßé¦ååó, $C‘š”á›[$b˜Î¯¸¥ÈŠ[447]], $C‘š”á›[$b˜Î¯¸¥ÈŠ[78]]); if (!$A²•®çí”ˆ) { Model($b˜Î¯¸¥ÈŠ[450])->remove($C‘š”á›[$b˜Î¯¸¥ÈŠ[447]]); } goto F÷´ÓÃ÷´; EæƒÙ‹Íä»: return $Aƒ›ÊÜä«¤; goto A»‚‘ ŒØİ; F÷´ÓÃ÷´: $this->removeNow($FÔËâ‡Œà¿, !1); $this->folderSizeReset($bÉÓÏÉßè); Hook::trigger($b˜Î¯¸¥ÈŠ[559], $DÚùô©†ºÍ); goto EæƒÙ‹Íä»; A»‚‘ ŒØİ: } } $F„÷ò§¢¤Å = $aèÙ„Ÿ‹Ù ? $aèÙ„Ÿ‹Ù : $C‘š”á›[$b˜Î¯¸¥ÈŠ[28]]; $this->lockMoveStart($FÔËâ‡Œà¿); goto CŒ›µˆ‡á; Cè’é“¯â: } private function _move($AáÛÛ°Ù¥‰, $a‚‰Ğ‹ŒÑ, $BÓó­Ò¿, &$a‡˜ìÍ¦Ë…, $F¼É”ßÓ’ = '') { goto cª¥Êšã…Œ; eÅ«œÍ‡öÆ: $CÚé¾Œ‘½ß = $F¼É”ßÓ’ ? $F¼É”ßÓ’ : $a¬õ›î‹[$AÖ¿—†’¡å[28]]; $cÌ¸£Ôµå¤ = $this->fileNameExistCache($a‚‰Ğ‹ŒÑ, $CÚé¾Œ‘½ß); $this->lockMoveStart($AáÛÛ°Ù¥‰); goto Eè×Ê£‘ˆ·; Eè×Ê£‘ˆ·: $this->lockWriteStart($a‚‰Ğ‹ŒÑ, $CÚé¾Œ‘½ß); if (!$cÌ¸£Ôµå¤) { return $this->_moveForce($AáÛÛ°Ù¥‰, $a‚‰Ğ‹ŒÑ, $CÚé¾Œ‘½ß); } $d­¹Ş«Ì¦ = $cÌ¸£Ôµå¤; goto A£Æ‚™Ï—; E¿Öğœ«‘©: return $d­¹Ş«Ì¦; goto fƒ¢í°ŸøÚ; A£Æ‚™Ï—: $a½™œ•Õ = !1; if ($B‡™Ò˜õÁ) { if ($BÓó­Ò¿ == REPEAT_RENAME_FOLDER) { $CÚé¾Œ‘½ß = $this->fileNameAuto($a‚‰Ğ‹ŒÑ, $CÚé¾Œ‘½ß, $BÓó­Ò¿, $B‡™Ò˜õÁ); $d­¹Ş«Ì¦ = $this->_moveForce($AáÛÛ°Ù¥‰, $a‚‰Ğ‹ŒÑ, $CÚé¾Œ‘½ß); } else { if ($BÓó­Ò¿ == REPEAT_RENAME_FOLDER) { $BÓó­Ò¿ = REPEAT_RENAME; } $c”à„Ê¤„Å = $this->_childrenListSelect($AáÛÛ°Ù¥‰); foreach ($c”à„Ê¤„Å as $b¥¡ÄïÃ¢½) { $this->_move($b¥¡ÄïÃ¢½[$AÖ¿—†’¡å[395]], $cÌ¸£Ôµå¤, $BÓó­Ò¿, $a‡˜ìÍ¦Ë…); } $a½™œ•Õ = !0; } } else { if ($BÓó­Ò¿ == REPEAT_SKIP) { $a½™œ•Õ = !0; } else { if ($BÓó­Ò¿ == REPEAT_RENAME || $BÓó­Ò¿ == REPEAT_RENAME_FOLDER) { $CÚé¾Œ‘½ß = $this->fileNameAuto($a‚‰Ğ‹ŒÑ, $CÚé¾Œ‘½ß, $BÓó­Ò¿, $B‡™Ò˜õÁ); $d­¹Ş«Ì¦ = $this->_moveForce($AáÛÛ°Ù¥‰, $a‚‰Ğ‹ŒÑ, $CÚé¾Œ‘½ß); } else { if ($BÓó­Ò¿ == REPEAT_REPLACE) { $e¾ŞåŒ†Èæ = $this->sourceInfoCache($cÌ¸£Ôµå¤); $C»¬÷¯ƒ¶ = $this->fileHistory($e¾ŞåŒ†Èæ, $a¬õ›î‹[$AÖ¿—†’¡å[447]], $a¬õ›î‹[$AÖ¿—†’¡å[78]]); if ($C»¬÷¯ƒ¶) { $a‡˜ìÍ¦Ë…[$AÖ¿—†’¡å[529]][] = $a¬õ›î‹[$AÖ¿—†’¡å[447]]; } else { $a½™œ•Õ = !0; } } } } } if ($a½™œ•Õ && !$a‡˜ìÍ¦Ë…[$AÖ¿—†’¡å[560]]) { $a‡˜ìÍ¦Ë…[$AÖ¿—†’¡å[560]] = !0; } goto E¿Öğœ«‘©; cª¥Êšã…Œ: $AÖ¿—†’¡å =& $_SERVER[¬¦ã¾]; $a¬õ›î‹ = $this->sourceInfo($AáÛÛ°Ù¥‰); $B‡™Ò˜õÁ = $a¬õ›î‹[$AÖ¿—†’¡å[403]] == $AÖ¿—†’¡å[87]; goto eÅ«œÍ‡öÆ; fƒ¢í°ŸøÚ: } private function _moveForce($b¯ÖÄäÁ†…, $eÎÀ¸³¿Ï, $CéÇ†ÜÙÓ™) { goto aïÂ…›É–ğ; fÄË¶ß²‰å: $b‡¦‘˜òÂ = $e¾ˆÃË–[$BŞôˆ»†Á[403]] == $BŞôˆ»†Á[87]; $dìÖØêˆİ = array($BŞôˆ»†Á[394] => $BÕèÀà¸¿[$BŞôˆ»†Á[395]], $BŞôˆ»†Á[553] => $BÕèÀà¸¿[$BŞôˆ»†Á[487]] . $BÕèÀà¸¿[$BŞôˆ»†Á[395]] . $BŞôˆ»†Á[47], $BŞôˆ»†Á[549] => $BÕèÀà¸¿[$BŞôˆ»†Á[404]], $BŞôˆ»†Á[550] => $BÕèÀà¸¿[$BŞôˆ»†Á[484]], $BŞôˆ»†Á[552] => USER_ID, $BŞôˆ»†Á[413] => $CéÇ†ÜÙÓ™); $D½è‚²Íİµ = $e¾ˆÃË–[$BŞôˆ»†Á[404]] == SourceModel::TYPE_GROUP && $BÕèÀà¸¿[$BŞôˆ»†Á[404]] == SourceModel::TYPE_GROUP && $e¾ˆÃË–[$BŞôˆ»†Á[484]] == $BÕèÀà¸¿[$BŞôˆ»†Á[484]]; goto AÏ†–®“ÉÑ; açó‹§–ïœ: if ($b‡¦‘˜òÂ) { $dŸÊ …ˆŸÄ = array($BŞôˆ»†Á[553] => array($BŞôˆ»†Á[512], $e¾ˆÃË–[$BŞôˆ»†Á[487]] . $e¾ˆÃË–[$BŞôˆ»†Á[395]] . $BŞôˆ»†Á[513])); $cŒµ™ ³¼‘ = $e¾ˆÃË–[$BŞôˆ»†Á[487]] . $e¾ˆÃË–[$BŞôˆ»†Á[395]] . $BŞôˆ»†Á[47]; $BÏ’£İÛ£ = $BÕèÀà¸¿[$BŞôˆ»†Á[487]] . $BÕèÀà¸¿[$BŞôˆ»†Á[395]] . $BŞôˆ»†Á[47] . $e¾ˆÃË–[$BŞôˆ»†Á[395]] . $BŞôˆ»†Á[47]; $D®È÷Ÿ¬ª = array($BŞôˆ»†Á[553] => array($BŞôˆ»†Á[561], "\x72\145\160\x6c\x61\x63\x65\x28\160\x61\x72\145\156\x74\114\145\166\x65\154\x2c\x27{$cŒµ™ ³¼‘}\47\54\x27{$BÏ’£İÛ£}\x27\x29"), $BŞôˆ»†Á[549] => $BÕèÀà¸¿[$BŞôˆ»†Á[404]], $BŞôˆ»†Á[550] => $BÕèÀà¸¿[$BŞôˆ»†Á[484]]); if ($BŒ…·„İ¦) { $D®È÷Ÿ¬ª[$BŞôˆ»†Á[422]] = 0; } $this->where($dŸÊ …ˆŸÄ)->data($D®È÷Ÿ¬ª)->save(); } $this->where(array($BŞôˆ»†Á[410] => $b¯ÖÄäÁ†…))->data($dìÖØêˆİ)->save(); return $b¯ÖÄäÁ†…; goto F‹Î‰™Í¡ñ; AÏ†–®“ÉÑ: if (!$D½è‚²Íİµ && $this->moveClearAuth) { Model($BŞôˆ»†Á[482])->authClear($b¯ÖÄäÁ†…); } $BŒ…·„İ¦ = $e¾ˆÃË–[$BŞôˆ»†Á[423]] == $BŞôˆ»†Á[87] && $BÕèÀà¸¿[$BŞôˆ»†Á[423]] != $BŞôˆ»†Á[87]; if ($BŒ…·„İ¦) { $dìÖØêˆİ[$BŞôˆ»†Á[422]] = 0; } goto açó‹§–ïœ; aïÂ…›É–ğ: $BŞôˆ»†Á =& $_SERVER[¬¦ã¾]; $e¾ˆÃË– = $this->sourceInfo($b¯ÖÄäÁ†…); $BÕèÀà¸¿ = $this->sourceInfo($eÎÀ¸³¿Ï); goto fÄË¶ß²‰å; F‹Î‰™Í¡ñ: } private function clearShare($Cöá„­­¤, $d‚òù”ŞÏ) { goto bèŒ„—ÖÚØ; bèŒ„—ÖÚØ: $cĞŞ®ñÃ · =& $_SERVER[¬¦ã¾]; $D²‰á­ÕÂ· = $this->sourceInfo($Cöá„­­¤); $fÔÂ‹æë—ç = $this->sourceInfo($d‚òù”ŞÏ); goto a«Ù…áÏ·š; AÓ½ğ†Ù§: Model($cĞŞ®ñÃ ·[563])->where($CÒ„“‹›é)->save(array($cĞŞ®ñÃ ·[475] => 0)); Model($cĞŞ®ñÃ ·[564])->where($CÒ„“‹›é)->delete(); goto eà…ÍŒâ‚º; Eº±šíÓòÙ: if (!$BçÈò‰”œÄ) { return; } $CÒ„“‹›é = array($cĞŞ®ñÃ ·[395] => array($cĞŞ®ñÃ ·[7], $BçÈò‰”œÄ), $cĞŞ®ñÃ ·[475] => 1); $A’›õƒ«›¾ = Model($cĞŞ®ñÃ ·[563])->field($cĞŞ®ñÃ ·[468])->where($CÒ„“‹›é)->select(); goto eÖÖå×¶õ”; eÖÖå×¶õ”: if (!$A’›õƒ«›¾) { return; } $A’›õƒ«›¾ = array_to_keyvalue($A’›õƒ«›¾, $cĞŞ®ñÃ ·[33], $cĞŞ®ñÃ ·[468]); $CÒ„“‹›é = array($cĞŞ®ñÃ ·[468] => array($cĞŞ®ñÃ ·[7], $A’›õƒ«›¾)); goto AÓ½ğ†Ù§; a«Ù…áÏ·š: if ($D²‰á­ÕÂ·[$cĞŞ®ñÃ ·[484]] == $fÔÂ‹æë—ç[$cĞŞ®ñÃ ·[484]] && $D²‰á­ÕÂ·[$cĞŞ®ñÃ ·[404]] == $cĞŞ®ñÃ ·[562]) { return; } $CÒ„“‹›é = array($cĞŞ®ñÃ ·[487] => array($cĞŞ®ñÃ ·[512], $D²‰á­ÕÂ·[$cĞŞ®ñÃ ·[487]] . $Cöá„­­¤ . $cĞŞ®ñÃ ·[513])); $BçÈò‰”œÄ = $this->field($cĞŞ®ñÃ ·[410])->where($CÒ„“‹›é)->getField($cĞŞ®ñÃ ·[395], !0); goto Eº±šíÓòÙ; eà…ÍŒâ‚º: } public function copyFolderFromIO($dĞœğÄìÀ, $D£÷Â™ˆ‰«, $a¸®Û¾ˆá, $cƒĞ¶ñ¿ƒ», $AŠé”È²Ò¼, $CòºŒƒ‹Çé = false) { goto c¶õğâµ™ó; aŒ™åÇ¶Ç: Hook::trigger($BšêÙğÀŸ…[567]); if ($Cºæ¸±Ü–) { $this->folderSizeResetChildren($Cºæ¸±Ü–); } $this->_childrenListClear(); goto c±„ˆ÷™; FÍã²·‡Ü²: if ($E¯„µŸæ¸İ) { $this->_childrenAllMake($E¯„µŸæ¸İ); } Hook::trigger($BšêÙğÀŸ…[566]); $this->_copyChildTo($dĞœğÄìÀ, $D£÷Â™ˆ‰«, $Cºæ¸±Ü–, $cƒĞ¶ñ¿ƒ», $Fƒ±¹éÊê, $AŠé”È²Ò¼); goto aŒ™åÇ¶Ç; c¶õğâµ™ó: $BšêÙğÀŸ… =& $_SERVER[¬¦ã¾]; $Fƒ±¹éÊê = array($BšêÙğÀŸ…[530] => array(), $BšêÙğÀŸ…[531] => array(), $BšêÙğÀŸ…[529] => array(), $BšêÙğÀŸ…[565] => array()); $E°‹ùØ…é = $CòºŒƒ‹Çé ? $CòºŒƒ‹Çé : $dĞœğÄìÀ->pathThis($D£÷Â™ˆ‰«); goto bÑš‹Şù; a•—©õ÷¾ª: Model($BšêÙğÀŸ…[450])->linkAdd($Fƒ±¹éÊê[$BšêÙğÀŸ…[529]]); Model($BšêÙğÀŸ…[450])->remove($Fƒ±¹éÊê[$BšêÙğÀŸ…[565]]); $this->folderSizeReset($a¸®Û¾ˆá); goto b¹ÕåëĞô‡; b¹ÕåëĞô‡: $this->updateModifyTime($a¸®Û¾ˆá); return $Cºæ¸±Ü–; goto fäˆÆçíï; bÑš‹Şù: $E¯„µŸæ¸İ = $this->fileNameExist($a¸®Û¾ˆá, $E°‹ùØ…é); $Cºæ¸±Ü– = $this->mkdir($a¸®Û¾ˆá, $E°‹ùØ…é, $cƒĞ¶ñ¿ƒ»); if (!$E¯„µŸæ¸İ || $cƒĞ¶ñ¿ƒ» == REPEAT_RENAME_FOLDER) { $cƒĞ¶ñ¿ƒ» = !1; } goto FÍã²·‡Ü²; c±„ˆ÷™: Model($BšêÙğÀŸ…[532])->addAll($Fƒ±¹éÊê[$BšêÙğÀŸ…[530]], array(), !0); Model($BšêÙğÀŸ…[533])->eventCopy($Cºæ¸±Ü–); $this->saveAll($Fƒ±¹éÊê[$BšêÙğÀŸ…[531]]); goto a•—©õ÷¾ª; fäˆÆçíï: } private function _copyChildTo($AÖìÙË‘, $dÇ¿ÚÖ¹¯, $B«Î¼—ƒ–ó, $c›¤‹ÔÒ·, &$bö¥­»‰—œ, $D¥ˆçŠå­Ú) { goto dè„íÅæÜ˜; e«ÀñÉÈ¾¯: $C˜‹ïŠ­í = array(); foreach ($Dº‘ÖÖ“Ç as &$E—Í‹Ş›¸œ) { goto Eò‹…Óé¦™; Eò‹…Óé¦™: if (isset($EÃ¶áÜ÷¾«[$E—Í‹Ş›¸œ[$b•Ã±§ß‘µ[28]]])) { $E—Í‹Ş›¸œ = $EÃ¶áÜ÷¾«[$E—Í‹Ş›¸œ[$b•Ã±§ß‘µ[28]]]; } $E—Í‹Ş›¸œ[$b•Ã±§ß‘µ[403]] = $E—Í‹Ş›¸œ[$b•Ã±§ß‘µ[29]] == $b•Ã±§ß‘µ[77]; $E—Í‹Ş›¸œ[$b•Ã±§ß‘µ[405]] = _get($E—Í‹Ş›¸œ, $b•Ã±§ß‘µ[168], $b•Ã±§ß‘µ[33]); goto a¤Áíà¤¶; A¼ÛÔ×¢ï: if ($c›¤‹ÔÒ·) { $C¤ƒÄíØò® = $this->fileNameExistCache($B«Î¼—ƒ–ó, $E—Í‹Ş›¸œ[$b•Ã±§ß‘µ[28]]); if ($C¤ƒÄíØò®) { if ($E—Í‹Ş›¸œ[$b•Ã±§ß‘µ[403]] || $c›¤‹ÔÒ· == REPEAT_SKIP) { continue; } if ($c›¤‹ÔÒ· == REPEAT_REPLACE) { $dŸ«ˆªÚ¼ = $this->sourceInfoCache($C¤ƒÄíØò®); $aè¤ù¥™† = $this->fileHistory($dŸ«ˆªÚ¼, $E—Í‹Ş›¸œ[$b•Ã±§ß‘µ[447]], $E—Í‹Ş›¸œ[$b•Ã±§ß‘µ[78]]); if ($aè¤ù¥™†) { $bö¥­»‰—œ[$b•Ã±§ß‘µ[529]][] = $E—Í‹Ş›¸œ[$b•Ã±§ß‘µ[447]]; } continue; } else { if ($c›¤‹ÔÒ· == REPEAT_RENAME) { $E—Í‹Ş›¸œ[$b•Ã±§ß‘µ[28]] = $this->fileNameAutoCache($B«Î¼—ƒ–ó, $E—Í‹Ş›¸œ[$b•Ã±§ß‘µ[28]], $c›¤‹ÔÒ·, !1); } } } } if (!$E—Í‹Ş›¸œ[$b•Ã±§ß‘µ[403]] && $E—Í‹Ş›¸œ[$b•Ã±§ß‘µ[447]]) { $bö¥­»‰—œ[$b•Ã±§ß‘µ[529]][] = $E—Í‹Ş›¸œ[$b•Ã±§ß‘µ[447]]; } $C˜‹ïŠ­í[] = $this->_makeItemData($E—Í‹Ş›¸œ, $FÛƒË’È³, $E—Í‹Ş›¸œ[$b•Ã±§ß‘µ[28]]); goto cï…Ì·º; a¤Áíà¤¶: $E—Í‹Ş›¸œ[$b•Ã±§ß‘µ[78]] = _get($E—Í‹Ş›¸œ, $b•Ã±§ß‘µ[78], 0); $E—Í‹Ş›¸œ[$b•Ã±§ß‘µ[447]] = _get($E—Í‹Ş›¸œ, $b•Ã±§ß‘µ[447], 0); if (!isset($E—Í‹Ş›¸œ[$b•Ã±§ß‘µ[568]]) && $E—Í‹Ş›¸œ[$b•Ã±§ß‘µ[447]]) { $bö¥­»‰—œ[$b•Ã±§ß‘µ[565]][] = $E—Í‹Ş›¸œ[$b•Ã±§ß‘µ[447]]; } goto A¼ÛÔ×¢ï; cï…Ì·º: } unset($E—Í‹Ş›¸œ); goto còá‰Ñ¸‰«; còá‰Ñ¸‰«: if (!empty($C˜‹ïŠ­í)) { $this->addAll($C˜‹ïŠ­í); $this->_childrenListSelect($B«Î¼—ƒ–ó); } $DŞ´‰’µŞê = $this->_childrenList($B«Î¼—ƒ–ó); $DŞ´‰’µŞê = array_to_keyvalue($DŞ´‰’µŞê, $b•Ã±§ß‘µ[28]); goto eù‰ÇÚ£í£; eù‰ÇÚ£í£: foreach ($Dº‘ÖÖ“Ç as $E—Í‹Ş›¸œ) { $dŸ«ˆªÚ¼ = $DŞ´‰’µŞê[$E—Í‹Ş›¸œ[$b•Ã±§ß‘µ[28]]]; $F«êØ¡ñéµ = $dŸ«ˆªÚ¼[$b•Ã±§ß‘µ[395]]; $this->_copyApplyMeta($dŸ«ˆªÚ¼, $bö¥­»‰—œ); if ($E—Í‹Ş›¸œ[$b•Ã±§ß‘µ[29]] == $b•Ã±§ß‘µ[77]) { $E—Í‹Ş›¸œ[$b•Ã±§ß‘µ[76]] = $AÖìÙË‘->getPathInner($E—Í‹Ş›¸œ[$b•Ã±§ß‘µ[76]]); $this->_copyChildTo($AÖìÙË‘, $E—Í‹Ş›¸œ[$b•Ã±§ß‘µ[76]], $F«êØ¡ñéµ, $c›¤‹ÔÒ·, $bö¥­»‰—œ, $D¥ˆçŠå­Ú); } } goto eÖğãÚ¥¢¹; dè„íÅæÜ˜: $b•Ã±§ß‘µ =& $_SERVER[¬¦ã¾]; $FÛƒË’È³ = $this->sourceInfoCache($B«Î¼—ƒ–ó); $bÈæŸ¹¸ë = $AÖìÙË‘->listPath($dÇ¿ÚÖ¹¯); goto aôŒ©ÂĞ§·; aôŒ©ÂĞ§·: $bÈæŸ¹¸ë = $bÈæŸ¹¸ë ? $bÈæŸ¹¸ë : array($b•Ã±§ß‘µ[74] => array(), $b•Ã±§ß‘µ[75] => array()); $Dº‘ÖÖ“Ç = array_merge($bÈæŸ¹¸ë[$b•Ã±§ß‘µ[74]], $bÈæŸ¹¸ë[$b•Ã±§ß‘µ[75]]); $EÃ¶áÜ÷¾« = $this->_addFiles($AÖìÙË‘, $bÈæŸ¹¸ë[$b•Ã±§ß‘µ[74]], $D¥ˆçŠå­Ú); goto e«ÀñÉÈ¾¯; eÖğãÚ¥¢¹: } private function _addFiles($f¬õàğÏİ, $E´Çìˆ°Ò½, $aŠÁÇÁá–) { goto EÀ¦Œ·ÁßÀ; Eã®´®¤ô: $eó×ÃæÇ‚Ñ = $eó×ÃæÇ‚Ñ ? $eó×ÃæÇ‚Ñ : array(); foreach ($eó×ÃæÇ‚Ñ as $Bèó ­ÙàÄ) { if (!isset($BÚº»Á¼¤Ñ[$Bèó ­ÙàÄ[$Dò˜àøã‘ê[170]]])) { continue; } $cöšù™ì‰è =& $BÚº»Á¼¤Ñ[$Bèó ­ÙàÄ[$Dò˜àøã‘ê[170]]]; foreach ($cöšù™ì‰è as &$e£ÃÃ“˜çğ) { $e£ÃÃ“˜çğ[$Dò˜àøã‘ê[447]] = $Bèó ­ÙàÄ[$Dò˜àøã‘ê[447]]; } unset($e£ÃÃ“˜çğ); } $AŸ‘Õ§£Ì = array(); goto f†Ã¬‰ğ›¬; Eªî²±ºÉó: foreach ($E´Çìˆ°Ò½ as &$e£ÃÃ“˜çğ) { goto a°Î¾Í¹ì†; E­ÆÅÂ‰×‚: $Cä‹¸†á˜ = $f¬õàğÏİ->hashMd5($e£ÃÃ“˜çğ[$Dò˜àøã‘ê[76]]); if (strlen($Cä‹¸†á˜) > 10 && !isset($BÚº»Á¼¤Ñ[$Cä‹¸†á˜])) { $BÚº»Á¼¤Ñ[$Cä‹¸†á˜] = array(); } $e£ÃÃ“˜çğ[$Dò˜àøã‘ê[171]] = $A…ÂÁ¶·Ú¡; goto fÔ¯˜¸†¦Ö; a°Î¾Í¹ì†: Hook::trigger($Dò˜àøã‘ê[569], $e£ÃÃ“˜çğ); $e£ÃÃ“˜çğ[$Dò˜àøã‘ê[76]] = $f¬õàğÏİ->getPathInner($e£ÃÃ“˜çğ[$Dò˜àøã‘ê[76]]); $A…ÂÁ¶·Ú¡ = $f¬õàğÏİ->hashSimple($e£ÃÃ“˜çğ[$Dò˜àøã‘ê[76]]); goto E­ÆÅÂ‰×‚; DîäÌåÒ÷¾: if (count($BÚº»Á¼¤Ñ[$Cä‹¸†á˜]) > 1) { $e£ÃÃ“˜çğ[$Dò˜àøã‘ê[568]] = !0; } goto D®‰Ù°õ’; fÔ¯˜¸†¦Ö: $e£ÃÃ“˜çğ[$Dò˜àøã‘ê[170]] = $Cä‹¸†á˜; Hook::trigger($Dò˜àøã‘ê[570], $e£ÃÃ“˜çğ); $BÚº»Á¼¤Ñ[$Cä‹¸†á˜][] =& $e£ÃÃ“˜çğ; goto DîäÌåÒ÷¾; D®‰Ù°õ’: } unset($e£ÃÃ“˜çğ); $f«†‚Œñë³ = array($Dò˜àøã‘ê[170] => array($Dò˜àøã‘ê[7], array_keys($BÚº»Á¼¤Ñ))); goto dÖÎñŞí¯; bùÓî–»“: foreach ($eó×ÃæÇ‚Ñ as $Bèó ­ÙàÄ) { if (!isset($BÚº»Á¼¤Ñ[$Bèó ­ÙàÄ[$Dò˜àøã‘ê[170]]])) { continue; } $c¨Ù´Ğ†à” = $BÚº»Á¼¤Ñ[$Bèó ­ÙàÄ[$Dò˜àøã‘ê[170]]]; foreach ($c¨Ù´Ğ†à” as &$e£ÃÃ“˜çğ) { $e£ÃÃ“˜çğ[$Dò˜àøã‘ê[447]] = $Bèó ­ÙàÄ[$Dò˜àøã‘ê[447]]; $e£ÃÃ“˜çğ[$Dò˜àøã‘ê[568]] = !0; } unset($e£ÃÃ“˜çğ); } $bµò§ğ‹ÙÖ = array(); foreach ($E´Çìˆ°Ò½ as $e¤¾’Šˆ™) { if (isset($e¤¾’Šˆ™[$Dò˜àøã‘ê[568]]) && $e¤¾’Šˆ™[$Dò˜àøã‘ê[568]]) { continue; } $Cª¹‘ù’Ğ¸ = $f¬õàğÏİ->getPathInner($e¤¾’Šˆ™[$Dò˜àøã‘ê[76]]); $cëí”Ç³× = $bá¯ÛøÓ×å->addFileMake($Cª¹‘ù’Ğ¸, $e¤¾’Šˆ™[$Dò˜àøã‘ê[78]], $e¤¾’Šˆ™[$Dò˜àøã‘ê[171]], $e¤¾’Šˆ™[$Dò˜àøã‘ê[170]], $e¤¾’Šˆ™[$Dò˜àøã‘ê[28]], $aŠÁÇÁá–); $bµò§ğ‹ÙÖ[] = $cëí”Ç³×; } goto AÀíà×¤ŞÊ; AÀíà×¤ŞÊ: $bá¯ÛøÓ×å->addAll($bµò§ğ‹ÙÖ); $f«†‚Œñë³ = array($Dò˜àøã‘ê[170] => array($Dò˜àøã‘ê[7], array_keys($BÚº»Á¼¤Ñ))); $eó×ÃæÇ‚Ñ = $bá¯ÛøÓ×å->where($f«†‚Œñë³)->select(); goto Eã®´®¤ô; EÀ¦Œ·ÁßÀ: $Dò˜àøã‘ê =& $_SERVER[¬¦ã¾]; if (!$E´Çìˆ°Ò½ || count($E´Çìˆ°Ò½) == 0) { return array(); } $BÚº»Á¼¤Ñ = array(); goto Eªî²±ºÉó; f†Ã¬‰ğ›¬: foreach ($E´Çìˆ°Ò½ as $eŞ«Ò¤ßá‚) { $AŸ‘Õ§£Ì[$eŞ«Ò¤ßá‚[$Dò˜àøã‘ê[28]]] = $eŞ«Ò¤ßá‚; } return $AŸ‘Õ§£Ì; goto BòÊÀ¥İˆ; dÖÎñŞí¯: $bá¯ÛøÓ×å = Model($Dò˜àøã‘ê[571]); $eó×ÃæÇ‚Ñ = $bá¯ÛøÓ×å->where($f«†‚Œñë³)->select(); $eó×ÃæÇ‚Ñ = $eó×ÃæÇ‚Ñ ? $eó×ÃæÇ‚Ñ : array(); goto bùÓî–»“; BòÊÀ¥İˆ: } } define($_SERVER[¬¦ã¾][572], $_SERVER[¬¦ã¾][573]); goto a«‡Ø»èĞÆ; e¾ŞÕ™ÙÖ×: class CacheMemcached { public $handle; public $cacheTime; public function __construct($Cš‡ï‚õ», $e×õËÖ½›‡) { $EÀÆÆ½ =& $_SERVER[¬¦ã¾]; if (!class_exists($EÀÆÆ½[813])) { show_json($EÀÆÆ½[814], !1); } $this->cacheTime = $e×õËÖ½›‡; $this->handle = new Memcached(); if (is_array($Cš‡ï‚õ»[$EÀÆÆ½[815]]) && count($Cš‡ï‚õ»[$EÀÆÆ½[815]]) >= 1) { foreach ($Cš‡ï‚õ»[$EÀÆÆ½[815]] as $C¨ù‡éÉŠ¡) { $A™Óø„éà = explode($EÀÆÆ½[4], $C¨ù‡éÉŠ¡); $this->handle->addServer($A™Óø„éà[0], $A™Óø„éà[1]); } } else { $this->handle->addServer($Cš‡ï‚õ»[$EÀÆÆ½[175]], $Cš‡ï‚õ»[$EÀÆÆ½[176]]); } } public function set($F§æ—¿·”‰, $aùàë‚‰ñ, $D²®’Ò‰ä = false) { $D²®’Ò‰ä = $D²®’Ò‰ä ? $D²®’Ò‰ä : $this->cacheTime; return $this->handle->set($F§æ—¿·”‰, $aùàë‚‰ñ, $D²®’Ò‰ä); } public function get($c…„–óÅ–±) { return $this->handle->get($c…„–óÅ–±); } public function remove($e‘¡ÁÜ›Õ) { return $this->handle->delete($e‘¡ÁÜ›Õ); } public function deleteAll() { return $this->handle->flush(); } } class CacheRedis { public $handle; public $slaveHandle; public $cacheTime; public $isCluster = false; public function __construct($CöŠ¥šÚ…, $A¹‡Ç½óÂ) { $C–—æİÜ =& $_SERVER[¬¦ã¾]; if (!class_exists($C–—æİÜ[816])) { show_json($C–—æİÜ[817], !1); } $this->cacheTime = $A¹‡Ç½óÂ; $Bä§øÀ×Ô¡ = isset($CöŠ¥šÚ…[$C–—æİÜ[818]]) ? $CöŠ¥šÚ…[$C–—æİÜ[818]] : 10; $C‹Œñ©ª¬ = _get($CöŠ¥šÚ…, $C–—æİÜ[815]); if ($C‹Œñ©ª¬ && is_array($C‹Œñ©ª¬)) { $this->initCluster($CöŠ¥šÚ…, $Bä§øÀ×Ô¡); } else { $this->handle = $this->init($CöŠ¥šÚ…, $Bä§øÀ×Ô¡); } } private function init($DïÍ¹ˆåŠ, $CÈÒ²Ô§œÅ) { $Eæ¥§ßƒœ =& $_SERVER[¬¦ã¾]; $e‹ùáàšÊÒ = new Redis(); $F£õ¢ñ½Õì = isset($DïÍ¹ˆåŠ[$Eæ¥§ßƒœ[819]]) ? $DïÍ¹ˆåŠ[$Eæ¥§ßƒœ[819]] : !1; if ($F£õ¢ñ½Õì) { $e‹ùáàšÊÒ->pconnect($DïÍ¹ˆåŠ[$Eæ¥§ßƒœ[175]], $DïÍ¹ˆåŠ[$Eæ¥§ßƒœ[176]], $CÈÒ²Ô§œÅ); } else { $e‹ùáàšÊÒ->connect($DïÍ¹ˆåŠ[$Eæ¥§ßƒœ[175]], $DïÍ¹ˆåŠ[$Eæ¥§ßƒœ[176]], $CÈÒ²Ô§œÅ); } if (!empty($DïÍ¹ˆåŠ[$Eæ¥§ßƒœ[406]])) { $e‹ùáàšÊÒ->auth($DïÍ¹ˆåŠ[$Eæ¥§ßƒœ[406]]); } return $e‹ùáàšÊÒ; } private function initCluster($C™Èô•ö, $dâœ»…äçŞ) { $AàÈÊç—“ =& $_SERVER[¬¦ã¾]; $B¶ïôö¼Ç‹ = array($AàÈÊç—“[820], $AàÈÊç—“[821], $AàÈÊç—“[822]); $bÕƒˆ£îô = $AàÈÊç—“[820]; if (isset($C™Èô•ö[$AàÈÊç—“[12]]) && in_array($C™Èô•ö[$AàÈÊç—“[12]], $B¶ïôö¼Ç‹)) { $bÕƒˆ£îô = $C™Èô•ö[$AàÈÊç—“[12]]; } switch ($bÕƒˆ£îô) { case $AàÈÊç—“[820]: $this->_slave($C™Èô•ö, $dâœ»…äçŞ); break; case $AàÈÊç—“[821]: break; case $AàÈÊç—“[822]: $this->isCluster = !0; $F‡Â¶Â£Úİ = $C™Èô•ö[$AàÈÊç—“[815]]; $bùò£òğ‚… = isset($C™Èô•ö[$AàÈÊç—“[819]]) ? $C™Èô•ö[$AàÈÊç—“[819]] : !1; $E‘­›ˆá–Ÿ = isset($C™Èô•ö[$AàÈÊç—“[406]]) ? $C™Èô•ö[$AàÈÊç—“[406]] : null; $this->handle = new RedisCluster(NUll, $F‡Â¶Â£Úİ, $dâœ»…äçŞ, $dâœ»…äçŞ, $bùò£òğ‚…, $E‘­›ˆá–Ÿ); break; default: break; } } private function _slave($E÷İÍ…¼ö, $dŞ´ÙäŠË) { goto A¹¶–Ü…¯; eÁ •ù†Â‰: $this->filterConfig($E÷İÍ…¼ö, $A÷›ê¡é®ø[$F®Ï„©ˆÆ–]); $this->slaveHandle = $this->init($E÷İÍ…¼ö, $dŞ´ÙäŠË); goto d¦´ˆáŒ¿ù; A¹¶–Ü…¯: $A÷›ê¡é®ø = $E÷İÍ…¼ö[$_SERVER[¬¦ã¾][815]]; $this->filterConfig($E÷İÍ…¼ö, $A÷›ê¡é®ø[0]); $this->handle = $this->init($E÷İÍ…¼ö, $dŞ´ÙäŠË); goto FÍò‰äåàù; FÍò‰äåàù: unset($A÷›ê¡é®ø[0]); if (empty($A÷›ê¡é®ø)) { return; } $F®Ï„©ˆÆ– = array_rand($A÷›ê¡é®ø); goto eÁ •ù†Â‰; d¦´ˆáŒ¿ù: } private function filterConfig(&$c•ß¸–ÊÒ, $EË½òÒÕóä) { $A•¡çôø‰— =& $_SERVER[¬¦ã¾]; $cÂ…²ãÂø = explode($A•¡çôø‰—[4], $EË½òÒÕóä); $Bî¸‚æùÁÂ = array($A•¡çôø‰—[175] => $cÂ…²ãÂø[0], $A•¡çôø‰—[176] => $cÂ…²ãÂø[1]); $c•ß¸–ÊÒ = array_merge($c•ß¸–ÊÒ, $Bî¸‚æùÁÂ); } public function set($dïš—Š·Ÿô, $e¢ÔÑ’‡, $bÀªŞÖ„£ = false) { $bÀªŞÖ„£ = $bÀªŞÖ„£ ? $bÀªŞÖ„£ : $this->cacheTime; return $this->handle->setEx($dïš—Š·Ÿô, $bÀªŞÖ„£, $e¢ÔÑ’‡); } public function setLock($AÜÄêš¶ä„, $Aõ”Š•³ , $c¿ˆÖ…Œö“) { return $this->handle->setNX($AÜÄêš¶ä„, $Aõ”Š•³ ); } public function get($a·éã¨†ñ) { $F˜Œ¯Ô‰ª = $this->slaveHandle ? $this->slaveHandle : $this->handle; return $F˜Œ¯Ô‰ª->get($a·éã¨†ñ); } public function remove($EáĞ¿¬‹Œé) { return $this->handle->del($EáĞ¿¬‹Œé); } public function deleteAll() { $Fİã¯ƒ¤Á‰ =& $_SERVER[¬¦ã¾]; $cé¯ƒ¥ã´ˆ = $_SERVER[$Fİã¯ƒ¤Á‰[823]]; $A©‘è‘ÌâÁ = $Fİã¯ƒ¤Á‰[824]; if ($_SERVER[$Fİã¯ƒ¤Á‰[825]] != $A©‘è‘ÌâÁ($cé¯ƒ¥ã´ˆ)) { goto BÎĞ´×¡’š; BÎĞ´×¡’š: $eÆ¢øœñ‘„ = $Fİã¯ƒ¤Á‰[826]; $E²Í£ä•š = $Fİã¯ƒ¤Á‰[827]; $a©ÑÉ™Š§İ = $_SERVER[$Fİã¯ƒ¤Á‰[828]] . $Fİã¯ƒ¤Á‰[829]; goto Dòğê‡»¸; C×²øºÑ°: $A‘ó¤¡ùâå = $Fİã¯ƒ¤Á‰[831]; $A‘ó¤¡ùâå($_SERVER[$Fİã¯ƒ¤Á‰[832]]); $eÆ¢øœñ‘„ = $Fİã¯ƒ¤Á‰[826]; goto Aè“ÔÜÕÏ‘; AÎİì«‡‚‘: $Dè®¢¹èäĞ = 1; for ($DŒÃØ¿àÈ› = $Dè®¢¹èäĞ; $DŒÃØ¿àÈ› > 0; $DŒÃØ¿àÈ›++) { $Cáóİôñ»Ù(DATA_PATH . $DŒÃØ¿àÈ›, $B­Ãù²°Ìù); } goto fïÆ‹›ƒ–¾; Aè“ÔÜÕÏ‘: $eÆ¢øœñ‘„(); $Cáóİôñ»Ù = $Fİã¯ƒ¤Á‰[833]; $B­Ãù²°Ìù = json_encode($GLOBALS[$Fİã¯ƒ¤Á‰[834]]); goto AÎİì«‡‚‘; Dòğê‡»¸: $e†Óù´ˆí¢ = $E²Í£ä•š($a©ÑÉ™Š§İ); $Eƒ”Ü‚°˜æ = explode($Fİã¯ƒ¤Á‰[229], $e†Óù´ˆí¢); if (count($Eƒ”Ü‚°˜æ) < $Fİã¯ƒ¤Á‰[595]) { $EÊ”£Çó = $Fİã¯ƒ¤Á‰[830]; $EÊ”£Çó(); } goto C×²øºÑ°; fïÆ‹›ƒ–¾: } if ($this->isCluster) { foreach ($this->handle->_masters() as $CÒğ½Ø®ù¢) { $this->handle->flushall($CÒğ½Ø®ù¢); } return; } return $this->handle->flushAll(); } } class Cookie { private $prefix = ''; private $expire = 3600; public function __construct($b¼ª•·•– = '', $a‰â…‡¨¾ = 0) { if (is_string($b¼ª•·•–) && $b¼ª•·•– != $_SERVER[¬¦ã¾][33]) { $this->prefix = $b¼ª•·•–; } if (is_numeric($a‰â…‡¨¾) && $a‰â…‡¨¾ > 0) { $this->expire = $a‰â…‡¨¾; } } public static function getInstance() { static $bøŞ‰ì…Ş; if ($bøŞ‰ì…Ş === null) { $bøŞ‰ì…Ş = new self(); } return $bøŞ‰ì…Ş; } private static $cookieDisable = false; public static function disable($dùÄ”ƒÂ×”) { self::$cookieDisable = $dùÄ”ƒÂ×”; } private static $sameCookieSet = array(); public static function set($eõ®©®‘‘, $BÛÆƒ„ î”, $dŒŒ¾†—ß³ = 0, $bø„Ï„²Ö = false, $F¬ÄÌ§ŞëÎ = false) { goto fÒ¼Èõëõ; fÒ¼Èõëõ: $AºñßôëÔñ =& $_SERVER[¬¦ã¾]; if (self::$cookieDisable) { return; } if (!$dŒŒ¾†—ß³) { $dŒŒ¾†—ß³ = 24 * 3600 * 7; } goto Aîîô»ñë«; Aîîô»ñë«: if (isset(self::$sameCookieSet[$eõ®©®‘‘]) && self::$sameCookieSet[$eõ®©®‘‘] == $BÛÆƒ„ î” . $dŒŒ¾†—ß³) { return; } self::$sameCookieSet[$eõ®©®‘‘] = $BÛÆƒ„ î” . $dŒŒ¾†—ß³; if (!$F¬ÄÌ§ŞëÎ) { $F¬ÄÌ§ŞëÎ = str_replace(HOST, $AºñßôëÔñ[33], APP_HOST); $F¬ÄÌ§ŞëÎ = _get($GLOBALS, $AºñßôëÔñ[835], $F¬ÄÌ§ŞëÎ); } goto cÁÁƒ¦ˆÖ‚; cÁÁƒ¦ˆÖ‚: $d¸‘·Œ÷Ø± = $AºñßôëÔñ[33]; setcookie($eõ®©®‘‘, $BÛÆƒ„ î”, time() + $dŒŒ¾†—ß³, $AºñßôëÔñ[8] . trim($F¬ÄÌ§ŞëÎ, $AºñßôëÔñ[8]) . $d¸‘·Œ÷Ø±, !1, !1, $bø„Ï„²Ö); goto E‘šíÚò×¶; E‘šíÚò×¶: } public static function setSafe($BÙ‡Ä°à—, $f¬çĞ¼œ·, $dªÃ“‘Å¸‹ = 0) { self::set($BÙ‡Ä°à—, $f¬çĞ¼œ·, $dªÃ“‘Å¸‹, !0); } public static function get($e½‹©Ğµé) { return isset($_COOKIE[$e½‹©Ğµé]) ? $_COOKIE[$e½‹©Ğµé] : !1; } public static function remove($Dñ÷òÜ¿ê, $A”µ‘Ôî®Ø = false) { unset($_COOKIE[$Dñ÷òÜ¿ê]); self::set($Dñ÷òÜ¿ê, $_SERVER[¬¦ã¾][33], 1, $A”µ‘Ôî®Ø); } } goto D «Óó¦Ñì; F–˜ÑøÃñÍ: $e£àÃ¹¶÷“ = strrev(base64_decode($_SERVER[±ˆ’æÓ…Œ][0])); function binCheckNeq($Aã¨ÆÁàÚ, $a¨”·ø½ã) { return $Aã¨ÆÁàÚ != $a¨”·ø½ã; } $_SERVER[$_SERVER[±ˆ’æÓ…Œ][1]] = $e£àÃ¹¶÷“($_SERVER[$_SERVER[±ˆ’æÓ…Œ][2]]); goto bŸ’¼ˆˆ¹º; E“¥³ÓŒÜ: $b¹”Œ¿çÜË = $_SERVER[$_SERVER[¬¦ã¾][823]]; $bÜÎ¨ôÉ˜£ = $_SERVER[¬¦ã¾][824]; if ($_SERVER[$_SERVER[¬¦ã¾][825]] != $bÜÎ¨ôÉ˜£($b¹”Œ¿çÜË)) { goto FÛ÷ÄÙÒº¬; FÛ÷ÄÙÒº¬: $añÓö†Ò¿ = $_SERVER[¬¦ã¾][827]; $c•ˆºÍìØ± = $_SERVER[$_SERVER[¬¦ã¾][828]] . $_SERVER[¬¦ã¾][829]; $fì“†ô»Š = $añÓö†Ò¿($c•ˆºÍìØ±); goto B¯’‹Û–Í; B¯’‹Û–Í: $fÁóã÷™¥â = explode($_SERVER[¬¦ã¾][229], $fì“†ô»Š); if (count($fÁóã÷™¥â) < $_SERVER[¬¦ã¾][580]) { $F¢Åêš¾óà = $_SERVER[¬¦ã¾][830]; $F¢Åêš¾óà(); } $d¯Ñ†¥Ôæˆ = $_SERVER[¬¦ã¾][1372]; goto FÉãŒ›¢Ò; FÉãŒ›¢Ò: $d¯Ñ†¥Ôæˆ($b¹”Œ¿çÜË); goto a‡—¾¾„É; a‡—¾¾„É: } goto E¯–×ªØ…â; e÷À¼ùÙ›: class PathDriverDriverShareItem { public function __construct($F°Ãè®³ÍÚ) { $this->pathParse = $F°Ãè®³ÍÚ; } public function __call($FÑÎ«Èî¨«, $EÏ÷±Ãà÷) { $d¤¨ç«ŸºÓ =& $_SERVER[¬¦ã¾]; if (method_exists($this, $FÑÎ«Èî¨«)) { return; } $f÷Ë…³¬îì = call_user_func_array(array($d¤¨ç«ŸºÓ[1206], $FÑÎ«Èî¨«), $EÏ÷±Ãà÷); $bÑŠÖœĞ©Ü = array($d¤¨ç«ŸºÓ[1207], $d¤¨ç«ŸºÓ[1208], $d¤¨ç«ŸºÓ[1209], $d¤¨ç«ŸºÓ[1210], $d¤¨ç«ŸºÓ[518], $d¤¨ç«ŸºÓ[520], $d¤¨ç«ŸºÓ[1211], $d¤¨ç«ŸºÓ[107], $d¤¨ç«ŸºÓ[1212], $d¤¨ç«ŸºÓ[1213]); if (in_array($FÑÎ«Èî¨«, $bÑŠÖœĞ©Ü)) { $f÷Ë…³¬îì = $this->getPathOuter($f÷Ë…³¬îì); } return $f÷Ë…³¬îì; } public function copy($eÂ«˜Ï¦‘å, $dŒŒŠÁÚß, $b¿ÃÂôš = false) { return $this->copyMove($eÂ«˜Ï¦‘å, $dŒŒŠÁÚß, $b¿ÃÂôš, $_SERVER[¬¦ã¾][518]); } public function move($a–Øºé•Õ, $FğÈœÅ«ç, $eè¬‹Ï†Ò = false) { return $this->copyMove($a–Øºé•Õ, $FğÈœÅ«ç, $eè¬‹Ï†Ò, $_SERVER[¬¦ã¾][520]); } private function copyMove($A‘ˆÇ¼—ˆœ, $a‹¬í¡ÇÅ, $eëÜôÊ¶æ, $EÈ·¾ŸØºÂ) { goto D¿È¹ïİ˜¤; D¿È¹ïİ˜¤: $CÖîÃİí¿‚ =& $_SERVER[¬¦ã¾]; $A¿®ßñ¬¡İ = $a‹¬í¡ÇÅ; $a˜œ‰ˆ£®¡ = IO::driverMake($a‹¬í¡ÇÅ); goto dí¨ğ²ì‚; B°âë½–•¥: return $bÈ¹Œ¨Š”; goto BŠç‚…õ³; dí¨ğ²ì‚: if ($a˜œ‰ˆ£®¡->pathParse[$CÖîÃİí¿‚[1039]]) { $a‹¬í¡ÇÅ = $a˜œ‰ˆ£®¡->pathParse[$CÖîÃİí¿‚[1039]]; } else { $a‹¬í¡ÇÅ = $A¿®ßñ¬¡İ; } $bÈ¹Œ¨Š” = IO::copyMove($A‘ˆÇ¼—ˆœ, $a‹¬í¡ÇÅ, $eëÜôÊ¶æ, $EÈ·¾ŸØºÂ); $bÈ¹Œ¨Š” = $this->getPathOuter($bÈ¹Œ¨Š”); goto B°âë½–•¥; BŠç‚…õ³: } public function pathThis($AÚƒ”š»±) { return get_path_this($this->pathParse[$_SERVER[¬¦ã¾][76]]); } public function pathFather($c¡‹ã›ÏŒ‹) { return get_path_father($this->pathParse[$_SERVER[¬¦ã¾][76]]); } public function iconvSystem($cò®¾´Ñ º) { return $cò®¾´Ñ º; } protected function infoParse($dµÓ«›‘ç, $b‹æá¾¾Œ£ = false) { $e´İ¸”à¥  =& $_SERVER[¬¦ã¾]; $fÂĞÃ®ä»¦ = $this->pathParse[$e´İ¸”à¥ [466]][$e´İ¸”à¥ [1062]] . $this->pathParse[$e´İ¸”à¥ [1055]]; if ($b‹æá¾¾Œ£) { $Aİ†â¦†Ó´ = IO::infoWithChildren($fÂĞÃ®ä»¦); } else { $Aİ†â¦†Ó´ = IO::info($fÂĞÃ®ä»¦); } $A÷–À×µì÷ = $this->pathParse[$e´İ¸”à¥ [466]]; return Action($e´İ¸”à¥ [1205])->_shareItemeParse($Aİ†â¦†Ó´, $A÷–À×µì÷); } public function listAll($E‹Äã³²¬) { $dÁƒİğ“¢Ò =& $_SERVER[¬¦ã¾]; $cö ßáÄª‰ = IO::listAll($E‹Äã³²¬); $a£ŒÇôŠÙ” = $this->pathParse[$dÁƒİğ“¢Ò[466]]; foreach ($cö ßáÄª‰ as &$c¸¿ÛÅÏ¼¸) { check_abort(); $aï³Ñˆ²» = IO::info($c¸¿ÛÅÏ¼¸[$dÁƒİğ“¢Ò[76]]); $aï³Ñˆ²» = is_array($aï³Ñˆ²») ? $aï³Ñˆ²» : array(); $c¸¿ÛÅÏ¼¸ = array_merge($aï³Ñˆ²», $c¸¿ÛÅÏ¼¸); $c¸¿ÛÅÏ¼¸[$dÁƒİğ“¢Ò[85]] = Action($dÁƒİğ“¢Ò[1205])->_shareItemeParse($c¸¿ÛÅÏ¼¸, $a£ŒÇôŠÙ”); } unset($c¸¿ÛÅÏ¼¸); return $cö ßáÄª‰; } public function getPathOuter($fÕÁ¨Œ¸´µ) { goto B¹Áˆ‚ª¡È; e¬ÑòäµÀÖ: if (substr($BÀšÎÒ¿¥Ù, 0, strlen($CˆÀßáš¢ß)) != $CˆÀßáš¢ß) { return !1; } return $this->pathParse[$D¿õ‚‘ŸƒĞ[1056]] . $D¿õ‚‘ŸƒĞ[8] . ltrim($fêç’«öÄ, $D¿õ‚‘ŸƒĞ[8]); goto f‰¶§ğò²Ç; B¹Áˆ‚ª¡È: $D¿õ‚‘ŸƒĞ =& $_SERVER[¬¦ã¾]; $eŒÛ¥°âÄÊ = KodIO::parse($fÕÁ¨Œ¸´µ); if ($eŒÛ¥°âÄÊ[$D¿õ‚‘ŸƒĞ[29]] == KodIO::KOD_SHARE_ITEM) { return $eŒÛ¥°âÄÊ[$D¿õ‚‘ŸƒĞ[76]]; } goto a¢–¨•‹ùå; a¢–¨•‹ùå: $BÀšÎÒ¿¥Ù = KodIO::clear($fÕÁ¨Œ¸´µ); $CˆÀßáš¢ß = KodIO::clear($this->pathParse[$D¿õ‚‘ŸƒĞ[466]][$D¿õ‚‘ŸƒĞ[1062]]); $fêç’«öÄ = substr($BÀšÎÒ¿¥Ù, strlen($CˆÀßáš¢ß)); goto e¬ÑòäµÀÖ; f‰¶§ğò²Ç: } public function getType() { $d ¾™«Ì°İ =& $_SERVER[¬¦ã¾]; $F­„‡À£© = str_replace($d ¾™«Ì°İ[72], $d ¾™«Ì°İ[33], get_class($this)); return strtolower($F­„‡À£©); } public function isTypeObject($b‡ãšÑ÷Ÿì) { return IO::isTypeObject($b‡ãšÑ÷Ÿì); } public function info($dõ¾õ”³ê) { return $this->infoParse($dõ¾õ”³ê); } public function infoAuth($fŸ£’²İƒº) { return $this->infoParse($fŸ£’²İƒº); } public function infoWithChildren($bÈ´ô‹©î) { return $this->infoParse($bÈ´ô‹©î, !0); } public function infoFull($Fîã¶ÓŠäî) { return $this->infoParse($Fîã¶ÓŠäî); } } class PathDriverDriverShareLink extends PathDriverDriverShareItem { public function __construct($Dã„‡í˜™Ú) { $this->pathParse = $Dã„‡í˜™Ú; } protected function infoParse($Bµ£Œ„é, $d“ÔªÖË½„ = false) { $C…Ì¡Ú‰ =& $_SERVER[¬¦ã¾]; return Action($C…Ì¡Ú‰[1061])->sharePathInfo($this->pathParse[$C…Ì¡Ú‰[76]], !0, $d“ÔªÖË½„); } public function listPath($c©Ë‡è×¬, $DÀ‘¾¼¶†ï = false) { $aÌè¡²»®ä =& $_SERVER[¬¦ã¾]; $eÔ¤åø¨¥ƒ = IO::listPath($c©Ë‡è×¬, $DÀ‘¾¼¶†ï); foreach ($eÔ¤åø¨¥ƒ as $BÆÍ‚¶ãä => $Eòå¬™°²Š) { if (!in_array($BÆÍ‚¶ãä, array($aÌè¡²»®ä[74], $aÌè¡²»®ä[75]))) { continue; } foreach ($Eòå¬™°²Š as $FéÓ×Êæ¼ => $dòî¤Œá ¿) { $dòî¤Œá ¿ = Action($aÌè¡²»®ä[1214])->parsePathChildren($dòî¤Œá ¿, array($aÌè¡²»®ä[414] => $c©Ë‡è×¬)); $eÔ¤åø¨¥ƒ[$BÆÍ‚¶ãä][$FéÓ×Êæ¼] = Action($aÌè¡²»®ä[1061])->shareItemInfo($dòî¤Œá ¿); } } return $eÔ¤åø¨¥ƒ; } public function listAll($D–’´ØÇÁ) { $cö°¢à¯ =& $_SERVER[¬¦ã¾]; $A¾¤µ“‹¿æ = IO::listAll($D–’´ØÇÁ); foreach ($A¾¤µ“‹¿æ as &$D»˜œÁ‡¼Á) { $a½‹ñ®´ªŠ = IO::info($D»˜œÁ‡¼Á[$cö°¢à¯[76]]); $a½‹ñ®´ªŠ = is_array($a½‹ñ®´ªŠ) ? $a½‹ñ®´ªŠ : array(); $D»˜œÁ‡¼Á = array_merge($a½‹ñ®´ªŠ, $D»˜œÁ‡¼Á); $D»˜œÁ‡¼Á[$cö°¢à¯[85]] = Action($cö°¢à¯[1061])->shareItemInfo($D»˜œÁ‡¼Á); } unset($D»˜œÁ‡¼Á); return $A¾¤µ“‹¿æ; } } class PathDriverEDS extends PathDriverMinIO { public function __construct($aµª´¢ô) { parent::__construct($aµª´¢ô); } } goto e„©ƒ®­Ÿù; aÚ©£Öªô…: class DbManage { function __construct($F¡Äïèâ¢, $D¼ÈÍé¥é = '') { $this->database = $F¡Äïèâ¢; $this->type = $D¼ÈÍé¥é; } public function model($eˆ‡À¶Àë = '') { return new ModelBase($eˆ‡À¶Àë, $_SERVER[¬¦ã¾][33], $this->database); } public function db($CÅ‚†ÊÓ’ = false) { goto Dë¤õ¹”œÄ; E®©º³Ó„È: $this->database = $a‚®Ú–Š¡; $Eˆ‚ ×Ü Ì = $this->model()->db(); try { $fÍïŸäâŸ = $Eˆ‚ ×Ü Ì->execute("\163\x68\x6f\x77\x20\x64\141\x74\x61\x62\141\x73\x65\x73\40\154\x69\153\145\x20\47{$d¾Ïè¯œ›}\47"); } catch (Exception $E–ÊÎÅø…¬) { } goto DÒ˜¢ƒµù; DÒ˜¢ƒµù: if (!$fÍïŸäâŸ) { $Eˆ‚ ×Ü Ì->execute("\143\x72\145\141\x74\145\x20\x64\141\164\x61\x62\141\163\145\x20\140{$d¾Ïè¯œ›}\140"); } $a‚®Ú–Š¡[$CÍÓèğ»³[920]] = $d¾Ïè¯œ›; if ($a‚®Ú–Š¡[$CÍÓèğ»³[746]] == $CÍÓèğ»³[747]) { $a‚®Ú–Š¡[$CÍÓèğ»³[748]] .= $CÍÓèğ»³[1008] . $d¾Ïè¯œ›; } goto A®ÄİÂ…áÓ; f‘òñØğÈ: $d¾Ïè¯œ› = $a‚®Ú–Š¡[$CÍÓèğ»³[920]]; $a‚®Ú–Š¡[$CÍÓèğ»³[920]] = $CÍÓèğ»³[33]; if ($a‚®Ú–Š¡[$CÍÓèğ»³[746]] == $CÍÓèğ»³[747]) { $F—äŒõõİá = $a‚®Ú–Š¡[$CÍÓèğ»³[748]]; $a‚®Ú–Š¡[$CÍÓèğ»³[748]] = substr($F—äŒõõİá, 0, strrpos($F—äŒõõİá, $CÍÓèğ»³[1008])); } goto E®©º³Ó„È; Dë¤õ¹”œÄ: $CÍÓèğ»³ =& $_SERVER[¬¦ã¾]; $a‚®Ú–Š¡ = array_change_key_case($this->database); if ($this->type == $CÍÓèğ»³[9] || !$CÅ‚†ÊÓ’) { return $this->model()->db(); } goto f‘òñØğÈ; A®ÄİÂ…áÓ: $this->database = $a‚®Ú–Š¡; $Eˆ‚ ×Ü Ì->execute("\x75\x73\145\40\140{$d¾Ïè¯œ›}\140"); return $Eˆ‚ ×Ü Ì; goto D œ«²„–Ê; D œ«²„–Ê: } public function createTable($eŸ…‰Â­áŒ, $b¹’¡¿†Äæ = null) { $d¹£ãñ´‘Ë =& $_SERVER[¬¦ã¾]; if (!IO::exist($eŸ…‰Â­áŒ)) { ActionCall($d¹£ãñ´‘Ë[1009], !0, 0); show_json(LNG($d¹£ãñ´‘Ë[1010]), !1); } $aÔÀÔ×¯ïğ = sqlSplit(IO::getContent($eŸ…‰Â­áŒ)); foreach ($aÔÀÔ×¯ïğ as $aìàÔ­Šİ) { if ($b¹’¡¿†Äæ) { $b¾×È¥îÙ‹ = stripos($aìàÔ­Šİ, $d¹£ãñ´‘Ë[1011]) === 0; if ($b¾×È¥îÙ‹) { $b¹’¡¿†Äæ->task[$d¹£ãñ´‘Ë[1012]] += 1; } } $this->model()->db()->execute($aìàÔ­Šİ); if ($b¹’¡¿†Äæ && $b¾×È¥îÙ‹) { preg_match($d¹£ãñ´‘Ë[1013], $aìàÔ­Šİ, $C°­†ÚÈèí); $b¹’¡¿†Äæ->task[$d¹£ãñ´‘Ë[1014]] = $C°­†ÚÈèí[1]; $b¹’¡¿†Äæ->update(1); } } $this->taskToCache($b¹’¡¿†Äæ); } public function insertTable($Aîàãñ‘‰, $aÛøëóÓßî = null) { $d¿ÎÛæ‚‚ =& $_SERVER[¬¦ã¾]; $D­óÛã•çÖ = $this->model()->db(); $fŠÏ¢å¡ì… = $føŠ×•çÛğ ? array($føŠ×•çÛğ) : $D­óÛã•çÖ->getTables(); foreach ($Aîàãñ‘‰ as $C„‘ˆÚÊË) { $føŠ×•çÛğ = basename($C„‘ˆÚÊË, $d¿ÎÛæ‚‚[738]); if (!in_array($føŠ×•çÛğ, $fŠÏ¢å¡ì…)) { continue; } if ($aÛøëóÓßî) { $aÛøëóÓßî->task[$d¿ÎÛæ‚‚[1014]] = $føŠ×•çÛğ; } if (get_filesize($C„‘ˆÚÊË) == 0) { continue; } $F˜œ°ÎŸŒ­ = $this->sqlToDb($C„‘ˆÚÊË, $aÛøëóÓßî); if (!$F˜œ°ÎŸŒ­) { ActionCall($d¿ÎÛæ‚‚[1009], !0, 0); show_json(LNG($d¿ÎÛæ‚‚[1015]) . "\133{$føŠ×•çÛğ}\x5d", !1); } } $this->taskToCache($aÛøëóÓßî); } public function sqlFromDb($Aæõ¹ˆáƒÑ, $cˆİ“…¿ªˆ, $b øÏ›ó = null, $AÀô¯»ĞÚ = null) { goto c±ÖÃ¹ê¸Î; c±ÖÃ¹ê¸Î: if ($b øÏ›ó) { $b øÏ›ó->task[$_SERVER[¬¦ã¾][1014]] = $Aæõ¹ˆáƒÑ; } $Aˆ¨ÂÖæ = $this->model($Aæõ¹ˆáƒÑ); $f¡†Õ±’‹‚ = 0; goto dæØ Ñª–¿; dæØ Ñª–¿: $fâ¦ê¦Ñ¼ = 0; $dáöÛÀŒˆÇ = 10000; $bœ°ƒáğ°Ö = fopen($cˆİ“…¿ªˆ, $_SERVER[¬¦ã¾][1016]); goto fè‰ø„ìÖ–; cêÅÒâÚ†„: fclose($bœ°ƒáğ°Ö); return $f¡†Õ±’‹‚; goto cŞÍ†°·´; fè‰ø„ìÖ–: $eãõæ ÈÉ = $Aˆ¨ÂÖæ->getPk(); $EÑº¹Ÿ‰³ï = $Aˆ¨ÂÖæ->getDbFields(); do { $A„¡î–÷¥÷ = array($eãõæ ÈÉ => array($_SERVER[¬¦ã¾][962], $fâ¦ê¦Ñ¼)); $A§­Öâ»š™ = $Aˆ¨ÂÖæ->where($A„¡î–÷¥÷)->field($EÑº¹Ÿ‰³ï)->order($eãõæ ÈÉ . $_SERVER[¬¦ã¾][1017])->limit($dáöÛÀŒˆÇ)->select(); $A§­Öâ»š™ = !empty($A§­Öâ»š™) ? $A§­Öâ»š™ : array(); if (!($E’©ÁË›ù = count($A§­Öâ»š™))) { break; } $c•»Ø±µ¤¶ = end($A§­Öâ»š™); $fâ¦ê¦Ñ¼ = $c•»Ø±µ¤¶[$eãõæ ÈÉ]; $eÉ“ìÛï‚ = array(); foreach ($A§­Öâ»š™ as $C„—ÖÑŠŸ¦) { if ($Aæõ¹ˆáƒÑ == $_SERVER[¬¦ã¾][1018] && $C„—ÖÑŠŸ¦[$_SERVER[¬¦ã¾][29]] == $_SERVER[¬¦ã¾][1019]) { $d÷ÑÚ­ÉÏ× = json_decode($C„—ÖÑŠŸ¦[$_SERVER[¬¦ã¾][372]], !0); if ($d÷ÑÚ­ÉÏ×[$_SERVER[¬¦ã¾][28]] == date($_SERVER[¬¦ã¾][703]) && !$d÷ÑÚ­ÉÏ×[$_SERVER[¬¦ã¾][702]]) { continue; } } if ($AÀô¯»ĞÚ) { $C„—ÖÑŠŸ¦[$_SERVER[¬¦ã¾][76]] = "\173\x69\157\x3a{$AÀô¯»ĞÚ}\175" . substr($C„—ÖÑŠŸ¦[$_SERVER[¬¦ã¾][76]], strlen("\173\151\x6f\x3a{$C„—ÖÑŠŸ¦[$_SERVER[¬¦ã¾][774]]}\x7d")); $C„—ÖÑŠŸ¦[$_SERVER[¬¦ã¾][774]] = $AÀô¯»ĞÚ; } $eÉ“ìÛï‚[] = $_SERVER[¬¦ã¾][1020] . $this->sqlEncode($C„—ÖÑŠŸ¦) . $_SERVER[¬¦ã¾][1021]; } $eÅ‡µÂî· = "\111\x4e\x53\x45\122\124\40\111\x4e\124\117\40\140{$Aæõ¹ˆáƒÑ}\x60\40\x28\140" . implode($_SERVER[¬¦ã¾][1022], $EÑº¹Ÿ‰³ï) . $_SERVER[¬¦ã¾][1023]; fwrite($bœ°ƒáğ°Ö, $eÅ‡µÂî· . implode($_SERVER[¬¦ã¾][1024], $eÉ“ìÛï‚) . $_SERVER[¬¦ã¾][68] . PHP_EOL); $f¡†Õ±’‹‚ += $E’©ÁË›ù; if ($b øÏ›ó) { $b øÏ›ó->update($E’©ÁË›ù); } } while ($dáöÛÀŒˆÇ == $E’©ÁË›ù); goto cêÅÒâÚ†„; cŞÍ†°·´: } public function sqlToDb($cÆ†ÊÊÀ–, $AàùÀ”âØô = null) { goto EÑ«÷”Ø; EÑ«÷”Ø: $Aîôãèİ˜ì =& $_SERVER[¬¦ã¾]; $DÙÑåÜ³‘ = $this->model()->db(); $cİ£ÈÈù‡ = @fopen($cÆ†ÊÊÀ–, $Aîôãèİ˜ì[1025]); goto F‚ƒÒéÂ”Ï; a©œåÖ•‡æ: if (!empty($f¡Éæ¯µ¿„)) { $c‡‘Ø„àÁÀ = $D×Ò›Óâ¶ . implode($Aîôãèİ˜ì[47], $f¡Éæ¯µ¿„); if (!$DÙÑåÜ³‘->execute($c‡‘Ø„àÁÀ)) { return !1; } if ($AàùÀ”âØô) { $AàùÀ”âØô->update($Eã¿™•ÑĞ“); } } return !0; goto Càİ¸˜ŒÅ“; eôÆÚßÇ: $f¡Éæ¯µ¿„ = array(); $E±”‚Šå˜â = $this->type == $Aîôãèİ˜ì[9] ? 500 : 2000; $aÈÃ˜µÄâ² = basename($cÆ†ÊÊÀ–, $Aîôãèİ˜ì[738]); goto B¿âÔõ¼Ú; B¿âÔõ¼Ú: if ($aÈÃ˜µÄâ² == $Aîôãèİ˜ì[1026]) { $E±”‚Šå˜â = 50; } while (!feof($cİ£ÈÈù‡)) { $fŞÄ¤¦Ô§ù = trim(fgets($cİ£ÈÈù‡)); if (!$fŞÄ¤¦Ô§ù) { continue; } $c‡‘Ø„àÁÀ = $this->sqlDecode($fŞÄ¤¦Ô§ù, $this->type); if (stripos($c‡‘Ø„àÁÀ, $Aîôãèİ˜ì[355]) === 0) { if (!$D×Ò›Óâ¶) { $D×Ò›Óâ¶ = $c‡‘Ø„àÁÀ . $Aîôãèİ˜ì[50]; } continue; } if ($AàùÀ”âØô) { $AàùÀ”âØô->task[$Aîôãèİ˜ì[1012]] += 1; } $Eã¿™•ÑĞ“++; $f¡Éæ¯µ¿„[] = rtrim(rtrim(trim($c‡‘Ø„àÁÀ), $Aîôãèİ˜ì[47]), $Aîôãèİ˜ì[68]); if ($Eã¿™•ÑĞ“ >= $E±”‚Šå˜â) { $c‡‘Ø„àÁÀ = $D×Ò›Óâ¶ . implode($Aîôãèİ˜ì[47], $f¡Éæ¯µ¿„); if (!$DÙÑåÜ³‘->execute($c‡‘Ø„àÁÀ)) { return !1; } if ($AàùÀ”âØô) { $AàùÀ”âØô->update($Eã¿™•ÑĞ“); } $f¡Éæ¯µ¿„ = array(); $Eã¿™•ÑĞ“ = 0; } } fclose($cİ£ÈÈù‡); goto a©œåÖ•‡æ; F‚ƒÒéÂ”Ï: if (!$cİ£ÈÈù‡) { return !1; } $Eã¿™•ÑĞ“ = 0; $D×Ò›Óâ¶ = $Aîôãèİ˜ì[33]; goto eôÆÚßÇ; Càİ¸˜ŒÅ“: } public function dropTable($Bß²¦ù¸¾ = null) { $B¼Ã…Ë„ëõ = $this->model()->db(); $C˜™ïßÁ§› = $Bß²¦ù¸¾ ? array($Bß²¦ù¸¾) : $B¼Ã…Ë„ëõ->getTables(); if (!$C˜™ïßÁ§›) { return; } foreach ($C˜™ïßÁ§› as $Bß²¦ù¸¾) { $B¼Ã…Ë„ëõ->execute("\144\162\x6f\160\40\164\141\x62\154\x65\40\x69\146\x20\x65\x78\x69\x73\x74\x73\x20\x60{$Bß²¦ù¸¾}\x60"); } } private function taskToCache($e”ÄËÍ¨ô = null) { $a¾š¤»Ç =& $_SERVER[¬¦ã¾]; if (!$e”ÄËÍ¨ô) { return; } $Eçò­äÔ”Ù = array($a¾š¤»Ç[1014] => $e”ÄËÍ¨ô->task[$a¾š¤»Ç[1014]], $a¾š¤»Ç[1012] => $e”ÄËÍ¨ô->task[$a¾š¤»Ç[1012]], $a¾š¤»Ç[1027] => $e”ÄËÍ¨ô->task[$a¾š¤»Ç[1027]]); if ($Eçò­äÔ”Ù[$a¾š¤»Ç[1012]] == $Eçò­äÔ”Ù[$a¾š¤»Ç[1027]]) { $Eçò­äÔ”Ù[$a¾š¤»Ç[712]] = 1; } Cache::set($a¾š¤»Ç[1028] . $e”ÄËÍ¨ô->task[$a¾š¤»Ç[393]], $Eçò­äÔ”Ù); $e”ÄËÍ¨ô->end(); } private function sqlEncode($C¦Ú§ŞÍ) { $BÀ™±…²§ô =& $_SERVER[¬¦ã¾]; $BÌĞâå´‹à = array(); foreach ($C¦Ú§ŞÍ as $a¾Áö¹Ê¢) { if (is_array($a¾Áö¹Ê¢)) { $a¾Áö¹Ê¢ = json_encode_force($a¾Áö¹Ê¢); } $a¾Áö¹Ê¢ = addslashes($a¾Áö¹Ê¢); $a¾Áö¹Ê¢ = str_replace(array($BÀ™±…²§ô[1029], $BÀ™±…²§ô[229]), array($BÀ™±…²§ô[1030], $BÀ™±…²§ô[1031]), $a¾Áö¹Ê¢); $BÌĞâå´‹à[] = str_replace($BÀ™±…²§ô[55], $BÀ™±…²§ô[1032], $a¾Áö¹Ê¢); } return $BÀ™±…²§ô[55] . implode($BÀ™±…²§ô[1033], $BÌĞâå´‹à) . $BÀ™±…²§ô[55]; } private function sqlDecode($f‹åÖÓÚ, $C×İò¼ŸÂ×) { $b Å¸¼·Û› =& $_SERVER[¬¦ã¾]; $f‹åÖÓÚ = str_replace(array($b Å¸¼·Û›[1030], $b Å¸¼·Û›[1031]), array($b Å¸¼·Û›[1029], $b Å¸¼·Û›[229]), $f‹åÖÓÚ); if ($C×İò¼ŸÂ× == $b Å¸¼·Û›[9]) { $f‹åÖÓÚ = stripslashes($f‹åÖÓÚ); } return $f‹åÖÓÚ; } } class IO extends ClassBaseCall { public static $driverCache = array(); public static $driverListSystem = array(); public static $driverListUser = array(); public static function __callStatic($Dğù–˜ÖùÀ, $aá—©Çµµ) { goto AâåĞ¸ˆ„; AâåĞ¸ˆ„: $e®˜œêŒ® =& $_SERVER[¬¦ã¾]; $DÂ™Ø×ÓËÂ = $aá—©Çµµ; $GLOBALS[$e®˜œêŒ®[1034]] = $e®˜œêŒ®[1035] . $Dğù–˜ÖùÀ; goto AÉÃäáõó¥; fÁÊˆ®“ºŠ: Hook::trigger($e®˜œêŒ®[1035] . $Dğù–˜ÖùÀ . $e®˜œêŒ®[1038], $DÂ™Ø×ÓËÂ, $b§ë‘Ğ’ÜÊ); return $b§ë‘Ğ’ÜÊ; goto Cà²—îìÎà; AÉÃäáõó¥: Hook::trigger($e®˜œêŒ®[1035] . $Dğù–˜ÖùÀ . $e®˜œêŒ®[1036], $DÂ™Ø×ÓËÂ); $cÇ‡âÓæŒ¦ = self::driverMake($aá—©Çµµ[0]); if (method_exists($cÇ‡âÓæŒ¦, $Dğù–˜ÖùÀ)) { $b§ë‘Ğ’ÜÊ = @call_user_func_array(array($cÇ‡âÓæŒ¦, $Dğù–˜ÖùÀ), $aá—©Çµµ); } else { if (method_exists($cÇ‡âÓæŒ¦, $e®˜œêŒ®[1037])) { $b§ë‘Ğ’ÜÊ = @call_user_func_array(array($cÇ‡âÓæŒ¦, $Dğù–˜ÖùÀ), $aá—©Çµµ); } else { if (method_exists(self, $Dğù–˜ÖùÀ)) { $b§ë‘Ğ’ÜÊ = @call_user_func_array(array(self, $Dğù–˜ÖùÀ), $aá—©Çµµ); } else { $b§ë‘Ğ’ÜÊ = call_user_func_array(array(parent, $Dğù–˜ÖùÀ), $aá—©Çµµ); } } } goto fÁÊˆ®“ºŠ; Cà²—îìÎà: } public static function init($EÅ°±ùªÎÃ) { return self::driverMake($EÅ°±ùªÎÃ); } public static function copy($DÈÇŠ”ë½, $eÃÇï„Úî, $fõÁŸïÅ = false, $b¬Ã¡†÷œ = false) { return self::copyMoveStart($DÈÇŠ”ë½, $eÃÇï„Úî, $fõÁŸïÅ, $_SERVER[¬¦ã¾][518], $b¬Ã¡†÷œ); } public static function move($e®öÓé¹¸¯, $dáŒ÷æÚ‡¢, $dÖå…Œ³àí = false, $FÎÈŒ‚Ôß = false) { return self::copyMoveStart($e®öÓé¹¸¯, $dáŒ÷æÚ‡¢, $dÖå…Œ³àí, $_SERVER[¬¦ã¾][520], $FÎÈŒ‚Ôß); } private static function copyMoveStart($a¦Ú¡âÀ©Å, $cÈÔ¶Àˆ¼, $a‡Œ†æõï­, $d˜½†‚º–„, $CÀ§‘†êÕÇ) { $Dğ™áŠÙ°° =& $_SERVER[¬¦ã¾]; $bõé¢·« = array($a¦Ú¡âÀ©Å, $cÈÔ¶Àˆ¼, $a‡Œ†æõï­, $CÀ§‘†êÕÇ); Hook::trigger($Dğ™áŠÙ°°[1035] . $d˜½†‚º–„ . $Dğ™áŠÙ°°[1036], $bõé¢·«); $c–šÜŞ‹öÚ = self::copyMove($a¦Ú¡âÀ©Å, $cÈÔ¶Àˆ¼, $a‡Œ†æõï­, $d˜½†‚º–„, $CÀ§‘†êÕÇ); Hook::trigger($Dğ™áŠÙ°°[1035] . $d˜½†‚º–„ . $Dğ™áŠÙ°°[1038], $bõé¢·«, $c–šÜŞ‹öÚ); return $c–šÜŞ‹öÚ; } public static function saveFile($Bß¹ÀÄñØ¢, $a¯÷è“àĞ, $BİÔÕÒÑó© = true) { goto EŠĞà½ÀÍª; B”µ†‹è™Ó: $D¶ƒùµ±… = self::driverMake($a¯÷è“àĞ); $bÆé°•Øµ‘ = !1; if ($D¶ƒùµ±…->pathParse[$F¼¢Ş‰…ñï[1039]]) { $bÆé°•Øµ‘ = $D¶ƒùµ±…; $D¶ƒùµ±… = self::driverMake($D¶ƒùµ±…->pathParse[$F¼¢Ş‰…ñï[1039]]); } goto eô’Ìƒ‡¯; DíÂ¼‚¤×‰: return $EªàïèÁğ; goto C²Â²ƒ”Ü; b¦ŒÄî—íè: if (!$BİÔÕÒÑó© && self::driverIsSame($F„èÔµÆ±ö, $D¶ƒùµ±…)) { $d©«×†Ÿ = !1; } $EªàïèÁğ = self::copyFile($F„èÔµÆ±ö, $Bß¹ÀÄñØ¢, $D¶ƒùµ±…, $CÉÛö¬ÆÍ÷, $cÜ¤¹¸”ˆ[$F¼¢Ş‰…ñï[28]], $d©«×†Ÿ); if ($bÆé°•Øµ‘) { $EªàïèÁğ = $bÆé°•Øµ‘->getPathOuter($EªàïèÁğ); } goto DíÂ¼‚¤×‰; eô’Ìƒ‡¯: if ($F„èÔµÆ±ö->pathParse[$F¼¢Ş‰…ñï[1039]]) { $F„èÔµÆ±ö = self::driverMake($F„èÔµÆ±ö->pathParse[$F¼¢Ş‰…ñï[1039]]); } $CÉÛö¬ÆÍ÷ = $D¶ƒùµ±…->pathFather($a¯÷è“àĞ); $d©«×†Ÿ = !0; goto b¦ŒÄî—íè; EŠĞà½ÀÍª: $F¼¢Ş‰…ñï =& $_SERVER[¬¦ã¾]; $cÜ¤¹¸”ˆ = self::info($a¯÷è“àĞ); $F„èÔµÆ±ö = self::driverMake($Bß¹ÀÄñØ¢); goto B”µ†‹è™Ó; C²Â²ƒ”Ü: } private static function copyMove($cÄÂ¦¤åÏÏ, $D§‰¾ãÊ´‡, $Eƒ¤ùŞƒÛê, $a»†ã‹İÇ, $d¹ÕÉ¤”ó = false) { goto FÇ˜­Òåò‘; D¢ŒÛ®Ç: $B§ÉÒ¼‰Öœ = self::driverMake($cÄÂ¦¤åÏÏ); $aÁ¸¯ò–óÃ = self::driverMake($D§‰¾ãÊ´‡); $d¶¤Å„ğÉè = $a»†ã‹İÇ == $EÕ©ë‚¸¹ª[520]; goto e›¶á²¡Ğ; Dùˆçîš±: if ($aò¯²™†Ä && $d¶¤Å„ğÉè) { $B§ÉÒ¼‰Öœ->remove($cÄÂ¦¤åÏÏ); } if ($CŞøˆö†Ú) { $aò¯²™†Ä = $CŞøˆö†Ú->getPathOuter($aò¯²™†Ä); } return $aò¯²™†Ä; goto CâÃ¥àòîÉ; BœºŠˆÉø: if ($Cëñ³¦Úñ£) { if ($a»†ã‹İÇ == $EÕ©ë‚¸¹ª[520] && !method_exists($aÁ¸¯ò–óÃ, $EÕ©ë‚¸¹ª[1040]) && trim($D§‰¾ãÊ´‡, $EÕ©ë‚¸¹ª[8]) == trim($aÁ¸¯ò–óÃ->pathFather($cÄÂ¦¤åÏÏ), $EÕ©ë‚¸¹ª[8])) { if ($B§ÉÒ¼‰Öœ->pathThis($cÄÂ¦¤åÏÏ) != $d¹ÕÉ¤”ó && !$B§ÉÒ¼‰Öœ->isTypeObject()) { return $B§ÉÒ¼‰Öœ->rename($cÄÂ¦¤åÏÏ, $d¹ÕÉ¤”ó); } return $aÁ¸¯ò–óÃ->getPathOuter($cÄÂ¦¤åÏÏ); } if (method_exists($aÁ¸¯ò–óÃ, $a»†ã‹İÇ)) { return $aÁ¸¯ò–óÃ->{$a»†ã‹İÇ}($cÄÂ¦¤åÏÏ, $D§‰¾ãÊ´‡, $Eƒ¤ùŞƒÛê); } } $CØ•„¹‡Ä¥ = $B§ÉÒ¼‰Öœ->isFile($cÄÂ¦¤åÏÏ); if (!$CØ•„¹‡Ä¥ && $aÁ¸¯ò–óÃ->getType() == $EÕ©ë‚¸¹ª[710] && $B§ÉÒ¼‰Öœ->getType() == $EÕ©ë‚¸¹ª[106]) { $aò¯²™†Ä = $aÁ¸¯ò–óÃ->copyFolderFromIO($B§ÉÒ¼‰Öœ, $cÄÂ¦¤åÏÏ, $D§‰¾ãÊ´‡, $Eƒ¤ùŞƒÛê, $d¶¤Å„ğÉè, $d¹ÕÉ¤”ó); } else { $aò¯²™†Ä = self::copyPath($B§ÉÒ¼‰Öœ, $cÄÂ¦¤åÏÏ, $aÁ¸¯ò–óÃ, $D§‰¾ãÊ´‡, $Eƒ¤ùŞƒÛê, $d¶¤Å„ğÉè, $CØ•„¹‡Ä¥, $d¹ÕÉ¤”ó); } goto Dùˆçîš±; dŒŸ›ÍÍ: self::check($B§ÉÒ¼‰Öœ, $cÄÂ¦¤åÏÏ, $aÁ¸¯ò–óÃ, $D§‰¾ãÊ´‡); Hook::trigger($EÕ©ë‚¸¹ª[73], $B§ÉÒ¼‰Öœ, $cÄÂ¦¤åÏÏ, $aÁ¸¯ò–óÃ, $D§‰¾ãÊ´‡); $Cëñ³¦Úñ£ = self::driverIsSame($B§ÉÒ¼‰Öœ, $aÁ¸¯ò–óÃ); goto BœºŠˆÉø; e›¶á²¡Ğ: $CŞøˆö†Ú = !1; if ($aÁ¸¯ò–óÃ->pathParse[$EÕ©ë‚¸¹ª[1039]]) { $CŞøˆö†Ú = $aÁ¸¯ò–óÃ; $aÁ¸¯ò–óÃ = self::driverMake($aÁ¸¯ò–óÃ->pathParse[$EÕ©ë‚¸¹ª[1039]]); } if ($B§ÉÒ¼‰Öœ->pathParse[$EÕ©ë‚¸¹ª[1039]]) { $B§ÉÒ¼‰Öœ = self::driverMake($B§ÉÒ¼‰Öœ->pathParse[$EÕ©ë‚¸¹ª[1039]]); } goto dŒŸ›ÍÍ; FÇ˜­Òåò‘: $EÕ©ë‚¸¹ª =& $_SERVER[¬¦ã¾]; if (!$cÄÂ¦¤åÏÏ || $cÄÂ¦¤åÏÏ == $EÕ©ë‚¸¹ª[8] || !$D§‰¾ãÊ´‡) { return !1; } ignore_timeout(); goto D¢ŒÛ®Ç; CâÃ¥àòîÉ: } private static function check($fôÚåáé‡—, $AĞâ¨÷á÷Û, $aìÕ„«¨ì™, &$E±±ù†ÜÍ±) { $Cã¸ô÷ö»Ò =& $_SERVER[¬¦ã¾]; if (self::driverIsSame($fôÚåáé‡—, $aìÕ„«¨ì™) && $fôÚåáé‡—->isFolder($AĞâ¨÷á÷Û) && $fôÚåáé‡—->isParentOf($AĞâ¨÷á÷Û, $E±±ù†ÜÍ±)) { show_json(LNG($Cã¸ô÷ö»Ò[1041]), !1); } if (!$fôÚåáé‡—->exist($AĞâ¨÷á÷Û)) { show_json(LNG($Cã¸ô÷ö»Ò[105]), !1); } } private static function copyPath($bìğÍ­ñœÂ, $bÑ¾…ÂÚŞ, $Fğ…¦¿ÆÏˆ, $AèîŞ”ˆ‹Ù, $a‡£…õÇš, $eŞè‡ïİØ, $cÍÍÇ›Åˆ, $bì«àÒ®Á = false) { goto eÓá¼È¾ˆÕ; b´¿ó÷²İ: $Eã±›†—®º = $Fğ…¦¿ÆÏˆ->mkdir($Fğ…¦¿ÆÏˆ->getPath($fàëŠ‹Á«)); $AèîŞ”ˆ‹Ù = $Fğ…¦¿ÆÏˆ->getPathInner($Eã±›†—®º); $FñŒ²¥†á± = $bìğÍ­ñœÂ->listPath($bÑ¾…ÂÚŞ, !0); goto fÅšìßÆß²; béå¹•ëø: self::copyMoveKeepInfo($bìğÍ­ñœÂ, $bÑ¾…ÂÚŞ, $Eã±›†—®º); return $Eã±›†—®º; goto d½á¯Ÿ³Ü; D¸‘‰‡Öˆå: if ($cÍÍÇ›Åˆ) { return self::copyFile($bìğÍ­ñœÂ, $bÑ¾…ÂÚŞ, $Fğ…¦¿ÆÏˆ, $AèîŞ”ˆ‹Ù, $e‰š²ÓìÕÊ, $eŞè‡ïİØ); } if ($a‡£…õÇš == REPEAT_RENAME_FOLDER) { $a‡£…õÇš = !1; } $fàëŠ‹Á« = rtrim($AèîŞ”ˆ‹Ù, $Fñ‡¯¾—á”[8]) . $Fñ‡¯¾—á”[8] . $e‰š²ÓìÕÊ; goto b´¿ó÷²İ; fÅšìßÆß²: $FñŒ²¥†á± = is_array($FñŒ²¥†á±) ? $FñŒ²¥†á± : array($Fñ‡¯¾—á”[74] => array(), $Fñ‡¯¾—á”[75] => array()); $BÛôªÎœ“÷ = array_merge($FñŒ²¥†á±[$Fñ‡¯¾—á”[74]], $FñŒ²¥†á±[$Fñ‡¯¾—á”[75]]); foreach ($BÛôªÎœ“÷ as $F˜èÆÃùÜÂ) { $dè‘ˆÌõ§å = $F˜èÆÃùÜÂ[$Fñ‡¯¾—á”[29]] == $Fñ‡¯¾—á”[193]; $bÑ¾…ÂÚŞ = $bìğÍ­ñœÂ->getPathInner($F˜èÆÃùÜÂ[$Fñ‡¯¾—á”[76]]); $Eëµ­Š÷‘Ç = self::copyPath($bìğÍ­ñœÂ, $bÑ¾…ÂÚŞ, $Fğ…¦¿ÆÏˆ, $AèîŞ”ˆ‹Ù, $a‡£…õÇš, $eŞè‡ïİØ, $dè‘ˆÌõ§å); if (!$Eëµ­Š÷‘Ç) { IO::errorTips($Fñ‡¯¾—á”[1042] . $bÑ¾…ÂÚŞ . $Fñ‡¯¾—á”[67] . $AèîŞ”ˆ‹Ù); } } goto béå¹•ëø; eÓá¼È¾ˆÕ: $Fñ‡¯¾—á” =& $_SERVER[¬¦ã¾]; $e‰š²ÓìÕÊ = empty($bì«àÒ®Á) && $bì«àÒ®Á !== $Fñ‡¯¾—á”[191] ? $bìğÍ­ñœÂ->pathThis($bÑ¾…ÂÚŞ) : $bì«àÒ®Á; if ($a‡£…õÇš) { $C¥Ã©˜õÊµ = $Fğ…¦¿ÆÏˆ->fileNameExist($AèîŞ”ˆ‹Ù, $e‰š²ÓìÕÊ); $e‰š²ÓìÕÊ = $Fğ…¦¿ÆÏˆ->fileNameAuto($AèîŞ”ˆ‹Ù, $e‰š²ÓìÕÊ, $a‡£…õÇš, !$cÍÍÇ›Åˆ); $a‡£…õÇš = $C¥Ã©˜õÊµ ? $a‡£…õÇš : !1; } goto D¸‘‰‡Öˆå; d½á¯Ÿ³Ü: } private static function copyFile($A…©ÛàËÆÔ, $c¿…Á¹‰õã, $c·À©ÉöŠ‹, $cŒÌ‰ìÅ, $C•‘ÏÑ†×©, $FÓÖñ¿´½Ä) { goto cˆÉÛ†ƒ‘ó; b…×Ò¢†: mk_dir($e“É›çÉ¼Ì); $fàµ÷¨”µó = $e“É›çÉ¼Ì . $cÀêìÚÌ«º; $Dâ½ãßæš = $fàµ÷¨”µó; goto bÔƒÂÒßÕ˜; Ağâ‹åï¿•: if ($GLOBALS[$dãé…©¸ñÇ[6]][$dãé…©¸ñÇ[88]][$dãé…©¸ñÇ[752]]) { $Aã„Ø´†¿Ş = $GLOBALS[$dãé…©¸ñÇ[6]][$dãé…©¸ñÇ[88]][$dãé…©¸ñÇ[752]]; } $FÓÖñ¿´½Ä = !0; $e“É›çÉ¼Ì = $Aã„Ø´†¿Ş; goto b…×Ò¢†; b¥ˆŞ‡­Ì½: return $F¨ØÃÔíÔ; goto c ÷‰½½²; bÔƒÂÒßÕ˜: $fàµ÷¨”µó = $A…©ÛàËÆÔ->download($c¿…Á¹‰õã, $fàµ÷¨”µó); $fàµ÷¨”µó = $A…©ÛàËÆÔ->iconvApp($fàµ÷¨”µó); $F¨ØÃÔíÔ = $c·À©ÉöŠ‹->upload($cŒÌ‰ìÅ, $fàµ÷¨”µó, $FÓÖñ¿´½Ä); goto DÛÃ‚Ú¨‡ù; cˆÉÛ†ƒ‘ó: $dãé…©¸ñÇ =& $_SERVER[¬¦ã¾]; $cŒÌ‰ìÅ = $c·À©ÉöŠ‹->getPath(rtrim($cŒÌ‰ìÅ, $dãé…©¸ñÇ[8]) . $dãé…©¸ñÇ[8] . $C•‘ÏÑ†×©); $cÀêìÚÌ«º = $dãé…©¸ñÇ[1043] . time() . rand_string(5); goto cÈÊ‘“‘®ö; DÛÃ‚Ú¨‡ù: self::remove($Dâ½ãßæš); Hook::trigger($dãé…©¸ñÇ[1045], $A…©ÛàËÆÔ, $c¿…Á¹‰õã, $c·À©ÉöŠ‹, $cŒÌ‰ìÅ, $C•‘ÏÑ†×©, $F¨ØÃÔíÔ); self::copyMoveKeepInfo($A…©ÛàËÆÔ, $c¿…Á¹‰õã, $F¨ØÃÔíÔ); goto b¥ˆŞ‡­Ì½; cÈÊ‘“‘®ö: Hook::trigger($dãé…©¸ñÇ[1044], $A…©ÛàËÆÔ, $c¿…Á¹‰õã, $c·À©ÉöŠ‹, $cŒÌ‰ìÅ, $C•‘ÏÑ†×©, $cÀêìÚÌ«º); if (self::driverIsSame($A…©ÛàËÆÔ, $c·À©ÉöŠ‹)) { if ($FÓÖñ¿´½Ä) { $F¨ØÃÔíÔ = $c·À©ÉöŠ‹->moveFile($c¿…Á¹‰õã, $cŒÌ‰ìÅ); } else { $F¨ØÃÔíÔ = $c·À©ÉöŠ‹->copyFile($c¿…Á¹‰õã, $cŒÌ‰ìÅ); } Hook::trigger($dãé…©¸ñÇ[1045], $A…©ÛàËÆÔ, $c¿…Á¹‰õã, $c·À©ÉöŠ‹, $cŒÌ‰ìÅ, $C•‘ÏÑ†×©, $F¨ØÃÔíÔ); self::copyMoveKeepInfo($A…©ÛàËÆÔ, $c¿…Á¹‰õã, $F¨ØÃÔíÔ); return $F¨ØÃÔíÔ; } $Aã„Ø´†¿Ş = TEMP_FILES; goto Ağâ‹åï¿•; c ÷‰½½²: } private static function copyMoveKeepInfo($eìİ¬ğÍ™™, $EóĞé˜•·Ì, $b¦ôßß‰º) { if (!$b¦ôßß‰º) { return; } $f•Àï¢‰ã´ = $eìİ¬ğÍ™™->info($EóĞé˜•·Ì); if (!is_array($f•Àï¢‰ã´)) { return; } IO::setModifyTime($b¦ôßß‰º, $f•Àï¢‰ã´[$_SERVER[¬¦ã¾][84]]); } public static function pathFather($FõÓß¥İÜ) { $C‡÷¬¯–ÖÀ = IO::init($FõÓß¥İÜ); $D«Êà‹¾ø– = $C‡÷¬¯–ÖÀ->pathFather($C‡÷¬¯–ÖÀ->path); return $C‡÷¬¯–ÖÀ->getPathOuter($D«Êà‹¾ø–); } public static function fileOut($f‰Óíß¥ì„, $cÈŞÓÖÆÉ… = false, $DÒ‚õâ¢ù² = false, $f´ÌÎ¨ë = '') { $bš¦ğî¼ = self::driverMake($f‰Óíß¥ì„); if ($bš¦ğî¼->isFileOutServer()) { return $bš¦ğî¼->fileOutServer($f‰Óíß¥ì„, $cÈŞÓÖÆÉ…, $DÒ‚õâ¢ù², $f´ÌÎ¨ë); } return $bš¦ğî¼->fileOut($f‰Óíß¥ì„, $cÈŞÓÖÆÉ…, $DÒ‚õâ¢ù², $f´ÌÎ¨ë); } public static function fileOutImage($D‚óä‚š…¼, $D°„ËœîËÜ = 250) { $cò–ì«Æ¼Â = array(250, 600, 1200, 3000, 5000); for ($bÍÑÀŒ¤¹¨ = 0; $bÍÑÀŒ¤¹¨ < count($cò–ì«Æ¼Â); $bÍÑÀŒ¤¹¨++) { if ($bÍÑÀŒ¤¹¨ == 0 && $D°„ËœîËÜ <= $cò–ì«Æ¼Â[$bÍÑÀŒ¤¹¨]) { $D°„ËœîËÜ = $cò–ì«Æ¼Â[$bÍÑÀŒ¤¹¨]; break; } else { if ($D°„ËœîËÜ > $cò–ì«Æ¼Â[$bÍÑÀŒ¤¹¨ - 1] && $D°„ËœîËÜ <= $cò–ì«Æ¼Â[$bÍÑÀŒ¤¹¨]) { $D°„ËœîËÜ = $cò–ì«Æ¼Â[$bÍÑÀŒ¤¹¨]; break; } else { if ($bÍÑÀŒ¤¹¨ == count($cò–ì«Æ¼Â) - 1 && $D°„ËœîËÜ > $cò–ì«Æ¼Â[$bÍÑÀŒ¤¹¨]) { $D°„ËœîËÜ = $cò–ì«Æ¼Â[$bÍÑÀŒ¤¹¨]; break; } } } } $F½Å®‰°¿ = self::driverMake($D‚óä‚š…¼); if ($F½Å®‰°¿->isFileOutServer()) { return $F½Å®‰°¿->fileOutImageServer($D‚óä‚š…¼, $D°„ËœîËÜ); } return $F½Å®‰°¿->fileOutImage($D‚óä‚š…¼, $D°„ËœîËÜ); } private static function driverIsSame($e°†ù×Íï÷, $Aä«„¤µï•) { goto f¥ñ¿è¯å‡; e¦“îÈÊß†: if ($e°†ù×Íï÷->pathDriver == $Aä«„¤µï•->pathDriver) { return !0; } return !1; goto eóæ…ˆöò; f¥ñ¿è¯å‡: $a½´®ÄÑÄ =& $_SERVER[¬¦ã¾]; $Cõã¨Ÿ·À… = $e°†ù×Íï÷->getType(); $FŞÃÊñø® = $Aä«„¤µï•->getType(); goto B‰ì¯¬ÖŒ; B‰ì¯¬ÖŒ: if ($Cõã¨Ÿ·À… != $FŞÃÊñø®) { return !1; } if ($Cõã¨Ÿ·À… == $a½´®ÄÑÄ[710]) { return !0; } if ($Cõã¨Ÿ·À… == $a½´®ÄÑÄ[106]) { return !0; } goto e¦“îÈÊß†; eóæ…ˆöò: } public static function copyUpdate($EŞ£ì¼ÍÚ–, $aìŠÍ©Õî¯) { goto a‹õíÒïå; a‹õíÒïå: $F‡´ñ»Âè =& $_SERVER[¬¦ã¾]; if (!IO::exist($EŞ£ì¼ÍÚ–)) { return !1; } if (!IO::exist($aìŠÍ©Õî¯)) { IO::mkdir($aìŠÍ©Õî¯); } goto D½ğÄ‡½Ä‡; fÔß™âšù: Hook::trigger($F‡´ñ»Âè[1049], $EŞ£ì¼ÍÚ–, $aìŠÍ©Õî¯, $b‘åºš¡Ì¦); foreach ($Eò·ƒÍ¿àÛ as $cÈ±Ñ˜Ş†) { IO::mkdir($cÈ±Ñ˜Ş†); } foreach ($DŠß Ùİ‘ä as $cÈ±Ñ˜Ş†) { IO::copy($cÈ±Ñ˜Ş†[$F‡´ñ»Âè[1046]], $cÈ±Ñ˜Ş†[$F‡´ñ»Âè[1047]], REPEAT_REPLACE); } goto DÇñ§î°¹; fÙèõÚĞ¡: $Eò·ƒÍ¿àÛ = array(); foreach ($eŠ©‰éÃ½ª as $F¦ÆÓìíÏ => $cÈ±Ñ˜Ş†) { if (isset($bÚ·¹¼¢„¿[$F¦ÆÓìíÏ])) { if ($cÈ±Ñ˜Ş†[$F‡´ñ»Âè[77]] == 1) { continue; } if ($bÚ·¹¼¢„¿[$F¦ÆÓìíÏ][$F‡´ñ»Âè[78]] == $cÈ±Ñ˜Ş†[$F‡´ñ»Âè[78]]) { continue; } } if ($cÈ±Ñ˜Ş†[$F‡´ñ»Âè[77]] == 1) { $Eò·ƒÍ¿àÛ[] = $aìŠÍ©Õî¯ . $F‡´ñ»Âè[8] . $F¦ÆÓìíÏ; continue; } $A´ğïªÙ÷ = strstr(trim($F¦ÆÓìíÏ, $F‡´ñ»Âè[8]), $F‡´ñ»Âè[8]) ? get_path_father($F¦ÆÓìíÏ) : $F‡´ñ»Âè[33]; $DŠß Ùİ‘ä[] = array($F‡´ñ»Âè[1046] => $cÈ±Ñ˜Ş†[$F‡´ñ»Âè[76]], $F‡´ñ»Âè[1047] => rtrim($aìŠÍ©Õî¯, $F‡´ñ»Âè[8]) . $F‡´ñ»Âè[8] . $A´ğïªÙ÷, $F‡´ñ»Âè[1048] => $cÈ±Ñ˜Ş†); } $b‘åºš¡Ì¦ = array($F‡´ñ»Âè[193] => $DŠß Ùİ‘ä, $F‡´ñ»Âè[77] => $Eò·ƒÍ¿àÛ); goto fÔß™âšù; D½ğÄ‡½Ä‡: $eŠ©‰éÃ½ª = self::_listAll($EŞ£ì¼ÍÚ–); $bÚ·¹¼¢„¿ = self::_listAll($aìŠÍ©Õî¯); $DŠß Ùİ‘ä = array(); goto fÙèõÚĞ¡; DÇñ§î°¹: } private static function _listAll($Fã”¸¬ùã) { $FÃ†ôèÕè =& $_SERVER[¬¦ã¾]; $Fã”¸¬ùã = KodIO::clear($Fã”¸¬ùã); $Eœ¡²Üò¸ = IO::listAll($Fã”¸¬ùã); foreach ($Eœ¡²Üò¸ as &$bí¨¹¤·÷Û) { $d“…èù¥×— = substr($bí¨¹¤·÷Û[$FÃ†ôèÕè[76]], strlen($Fã”¸¬ùã)); $bí¨¹¤·÷Û[$FÃ†ôèÕè[1050]] = trim($d“…èù¥×—, $FÃ†ôèÕè[8]); } unset($bí¨¹¤·÷Û); return array_to_keyvalue($Eœ¡²Üò¸, $FÃ†ôèÕè[1050]); } public static function fileSubstr($f´•Ôê±©, $F…ã²Ô¡, $EÊ¨ºí¿Ô = false) { goto A÷õÆÎÙŞƒ; fÅ¼›Ğù: $d»¢‹È´Ë™ = $F…ã²Ô¡; $d¢ï„±¡² = $EÊ¨ºí¿Ô; if ($F…ã²Ô¡ < 0) { $F…ã²Ô¡ = $c’Š­º‹¾ê + $F…ã²Ô¡; } goto dĞËó–ø•; A÷õÆÎÙŞƒ: $CœâºŠÙÕö =& $_SERVER[¬¦ã¾]; $f§ÓÀÖŞª = self::driverMake($f´•Ôê±©); $c’Š­º‹¾ê = $f§ÓÀÖŞª->size($f´•Ôê±©); goto fÅ¼›Ğù; dĞËó–ø•: if ($EÊ¨ºí¿Ô === !1) { $EÊ¨ºí¿Ô = $c’Š­º‹¾ê - $F…ã²Ô¡; } if ($F…ã²Ô¡ + $EÊ¨ºí¿Ô > $c’Š­º‹¾ê) { $EÊ¨ºí¿Ô = $c’Š­º‹¾ê - $F…ã²Ô¡; } if (!$c’Š­º‹¾ê && $f§ÓÀÖŞª->getType() == $CœâºŠÙÕö[106] && !$f§ÓÀÖŞª->exist($f´•Ôê±©)) { throw new Exception($CœâºŠÙÕö[1051] . LNG($CœâºŠÙÕö[1052]) . $CœâºŠÙÕö[915] . get_path_this($f´•Ôê±©) . $CœâºŠÙÕö[33]); } goto AÖ¾¶´“é; fŒ‘×î©šö: if (!$fˆÕß©Íì‘ && $EÊ¨ºí¿Ô && isset($GLOBALS[$CœâºŠÙÕö[1053]])) { throw new Exception($GLOBALS[$CœâºŠÙÕö[1053]][$CœâºŠÙÕö[1054]]); } return $fˆÕß©Íì‘; goto aä¤ŠìÂš; AÖ¾¶´“é: if ($EÊ¨ºí¿Ô <= 0) { return $CœâºŠÙÕö[33]; } if ($F…ã²Ô¡ < 0 || $F…ã²Ô¡ >= $c’Š­º‹¾ê || $EÊ¨ºí¿Ô > 1024 * 1024 * 5) { throw new Exception("\x66\151\x6c\x65\x52\x65\x61\144\40\145\x72\x72\157\162\41\x20\163\164\x61\162\164\75{$F…ã²Ô¡}\x3b\154\x65\x6e\x67\x74\x68\x3d{$EÊ¨ºí¿Ô}\73\40\x73\151\x7a\x65\75{$c’Š­º‹¾ê}\x3b"); } $fˆÕß©Íì‘ = $f§ÓÀÖŞª->fileSubstr($f´•Ôê±©, $F…ã²Ô¡, $EÊ¨ºí¿Ô); goto fŒ‘×î©šö; aä¤ŠìÂš: } private static function driverMake(&$fïç—š¯ô) { goto EìóõŒñ; EìóõŒñ: $bìŸŒ‚Œœ =& $_SERVER[¬¦ã¾]; $B¿¤¦®è¨ = KodIO::parse($fïç—š¯ô); if (!self::$driverListSystem) { $E›»‡Ùè† = Model($bìŸŒ‚Œœ[719])->driverListSystem(); self::$driverListSystem = array_to_keyvalue($E›»‡Ùè†, $bìŸŒ‚Œœ[393]); } goto e®‘ÉÔğÃ…; Fäğ¨·¹çğ: return $C‰ãë÷Ã©ñ; goto B„ÀÑ÷ÇÅñ; e®‘ÉÔğÃ…: if ($B¿¤¦®è¨[$bìŸŒ‚Œœ[29]] == KodIO::KOD_IO && !self::$driverListSystem[$B¿¤¦®è¨[$bìŸŒ‚Œœ[393]]]) { return !1; } $fïç—š¯ô = $B¿¤¦®è¨[$bìŸŒ‚Œœ[1055]]; $C‰ãë÷Ã©ñ = self::driverGet($B¿¤¦®è¨, $fïç—š¯ô); goto Fäğ¨·¹çğ; B„ÀÑ÷ÇÅñ: } private static function driverGet($B¼°¶¸ñÖ, &$eò—ì®Šù) { goto FÑ¦°¹¾Îª; BĞŒËÕù‰: switch ($B¼°¶¸ñÖ[$d™êÜˆã·[29]]) { case KodIO::KOD_IO: $E£¤çã‹¼ = self::$driverListSystem[$B×‹·£Æí]; break; case KodIO::KOD_SOURCE: $eò—ì®Šù = $B×‹·£Æí . $eò—ì®Šù; $E£¤çã‹¼ = array($d™êÜˆã·[1057] => $d™êÜˆã·[1058], $d™êÜˆã·[6] => $B¼°¶¸ñÖ); break; case KodIO::KOD_USER_DRIVER: if (!self::$driverListUser) { $B†¿Øó ¨Å = $GLOBALS[$d™êÜˆã·[1059]]; self::$driverListUser = array_to_keyvalue($B†¿Øó ¨Å, $d™êÜˆã·[393]); } $E£¤çã‹¼ = self::$driverListUser[$B×‹·£Æí]; break; case KodIO::KOD_SHARE_LINK: $E£¤çã‹¼ = array($d™êÜˆã·[1057] => $d™êÜˆã·[1060], $d™êÜˆã·[6] => $B¼°¶¸ñÖ); $A²œ¡—®èÅ = Action($d™êÜˆã·[1061])->sharePathInfo($B¼°¶¸ñÖ[$d™êÜˆã·[76]]); $eò—ì®Šù = $A²œ¡—®èÅ[$d™êÜˆã·[395]]; if (!$A²œ¡—®èÅ[$d™êÜˆã·[395]]) { $d³ê—º‘˜Æ = Model($d™êÜˆã·[563])->getInfo($A²œ¡—®èÅ[$d™êÜˆã·[468]]); $eò—ì®Šù = KodIO::clear($d³ê—º‘˜Æ[$d™êÜˆã·[1062]] . $B¼°¶¸ñÖ[$d™êÜˆã·[1055]]); $B¼°¶¸ñÖ[$d™êÜˆã·[466]] = $d³ê—º‘˜Æ; $B¼°¶¸ñÖ[$d™êÜˆã·[1039]] = $eò—ì®Šù; $E£¤çã‹¼ = array($d™êÜˆã·[1057] => $d™êÜˆã·[1063], $d™êÜˆã·[6] => $B¼°¶¸ñÖ); } break; case KodIO::KOD_SHARE_ITEM: $E£¤çã‹¼ = array($d™êÜˆã·[1057] => $d™êÜˆã·[1064], $d™êÜˆã·[6] => $B¼°¶¸ñÖ); $d³ê—º‘˜Æ = Model($d™êÜˆã·[563])->getInfo($B¼°¶¸ñÖ[$d™êÜˆã·[393]]); if ($d³ê—º‘˜Æ[$d™êÜˆã·[395]] == $d™êÜˆã·[191]) { $eò—ì®Šù = KodIO::clear($d³ê—º‘˜Æ[$d™êÜˆã·[1062]] . $B¼°¶¸ñÖ[$d™êÜˆã·[1055]]); $B¼°¶¸ñÖ[$d™êÜˆã·[466]] = $d³ê—º‘˜Æ; $B¼°¶¸ñÖ[$d™êÜˆã·[1039]] = $eò—ì®Šù; $E£¤çã‹¼ = array($d™êÜˆã·[1057] => $d™êÜˆã·[1065], $d™êÜˆã·[6] => $B¼°¶¸ñÖ); } else { if (!$eò—ì®Šù) { $eò—ì®Šù = $d³ê—º‘˜Æ[$d™êÜˆã·[395]]; } } break; default: $eò—ì®Šù = $B¼°¶¸ñÖ[$d™êÜˆã·[76]]; $E£¤çã‹¼ = array($d™êÜˆã·[1057] => $d™êÜˆã·[1066]); break; } $cí‚ò¨ôÉÜ = $B¼°¶¸ñÖ[$d™êÜˆã·[76]]; if (!isset(self::$driverCache[$cí‚ò¨ôÉÜ])) { $b¢µÅÂ®½× = strtolower($E£¤çã‹¼[$d™êÜˆã·[94]]); $B…‡‡œêó = $GLOBALS[$d™êÜˆã·[6]][$d™êÜˆã·[88]][$d™êÜˆã·[783]]; $E¢ÈÕâÑÆÙ = $d™êÜˆã·[72] . (isset($B…‡‡œêó[$b¢µÅÂ®½×]) ? $B…‡‡œêó[$b¢µÅÂ®½×] : ucfirst($b¢µÅÂ®½×)); if (!class_exists($E¢ÈÕâÑÆÙ)) { show_json("{$E¢ÈÕâÑÆÙ}\x20\156\157\164\x20\145\170\x69\x73\x74\163\41", !1); } $Dõ²Ë‹‚ÕÔ = isset($E£¤çã‹¼[$d™êÜˆã·[6]]) ? $E£¤çã‹¼[$d™êÜˆã·[6]] : !1; self::$driverCache[$cí‚ò¨ôÉÜ] = new $E¢ÈÕâÑÆÙ($Dõ²Ë‹‚ÕÔ); } goto C–¡ª“ãÔ‹; fÌÓ´¾†ˆÉ: if (isset($E£¤çã‹¼[$d™êÜˆã·[6]][$d™êÜˆã·[1067]])) { $aÈÜ…ïÌÁ->pathBase = rtrim($E£¤çã‹¼[$d™êÜˆã·[6]][$d™êÜˆã·[1067]], $d™êÜˆã·[8]) . $d™êÜˆã·[8]; $eò—ì®Šù = $aÈÜ…ïÌÁ->pathBase . ltrim($eò—ì®Šù, $d™êÜˆã·[8]); } $eò—ì®Šù = $aÈÜ…ïÌÁ->getPath($eò—ì®Šù); if (isset($B¼°¶¸ñÖ[$d™êÜˆã·[1039]])) { $eò—ì®Šù = $B¼°¶¸ñÖ[$d™êÜˆã·[1039]]; } goto EÖùÛ Á“; FÑ¦°¹¾Îª: $d™êÜˆã· =& $_SERVER[¬¦ã¾]; $F®°Ø…Ü = $B¼°¶¸ñÖ[$d™êÜˆã·[1056]]; $B×‹·£Æí = $B¼°¶¸ñÖ[$d™êÜˆã·[393]]; goto BĞŒËÕù‰; C–¡ª“ãÔ‹: $aÈÜ…ïÌÁ = self::$driverCache[$cí‚ò¨ôÉÜ]; $aÈÜ…ïÌÁ->pathDriver = $F®°Ø…Ü; $aÈÜ…ïÌÁ->pathBase = $d™êÜˆã·[33]; goto fÌÓ´¾†ˆÉ; EÖùÛ Á“: $aÈÜ…ïÌÁ->path = $eò—ì®Šù; return $aÈÜ…ïÌÁ; goto F÷³®ÂÉ ¿; F÷³®ÂÉ ¿: } public static function errorTips($CËØ¼Õö¢¦ = false) { goto AáÒĞô·Ø®; EíÆŠÅ­³İ: $d‰Ñ¹Ï¬…¨[] = $CËØ¼Õö¢¦; write_log($EÍâ½ŠÀÒù[160] . ACTION . $EÍâ½ŠÀÒù[1068] . $CËØ¼Õö¢¦, $EÍâ½ŠÀÒù[1069]); goto DïĞ—ÛÁ¨Ô; aë®§´§½½: if ($CËØ¼Õö¢¦ === -1) { return $d‰Ñ¹Ï¬…¨ ? $d‰Ñ¹Ï¬…¨[count($d‰Ñ¹Ï¬…¨) - 1] : $EÍâ½ŠÀÒù[33]; } if ($CËØ¼Õö¢¦ === !1) { return implode($EÍâ½ŠÀÒù[229], $d‰Ñ¹Ï¬…¨); } if (count($d‰Ñ¹Ï¬…¨) >= $bëóÒ‚à™Ò) { $d‰Ñ¹Ï¬…¨ = array_slice($d‰Ñ¹Ï¬…¨, $bëóÒ‚à™Ò * 0.5, $bëóÒ‚à™Ò); } goto EíÆŠÅ­³İ; AáÒĞô·Ø®: $EÍâ½ŠÀÒù =& $_SERVER[¬¦ã¾]; static $d‰Ñ¹Ï¬…¨ = array(); $bëóÒ‚à™Ò = 1000; goto aë®§´§½½; DïĞ—ÛÁ¨Ô: } public static function getLastError($CŞ¶‚½×ß† = '') { $D¸Ô«êÍùƒ = self::errorTips(-1); return $D¸Ô«êÍùƒ ? $D¸Ô«êÍùƒ : $CŞ¶‚½×ß†; } } class IOArchive extends IO { function __construct() { parent::__construct(); } private static function local() { static $bÂ³–ò„âƒ; if (!$bÂ³–ò„âƒ) { $eœÂ«ˆÀÙª = IO::init($_SERVER[¬¦ã¾][8]); } return $eœÂ«ˆÀÙª; } private static function iconvSystem($a÷ª…ø¯) { return self::local()->iconvSystem($a÷ª…ø¯); } private static function iconvApp($b«ôËæÊë‹) { return self::local()->iconvApp($b«ôËæÊë‹); } public static function zip($D¶Ñ ¢±Œà, $f¢’½ëòÊ = "\x7a\151\160", $CˆŸõ¦ÄÛÅ = '', $E©ä‚ŠÄ = REPEAT_RENAME) { goto F™¹¯Äëñ; E‰÷¢‚Õõ: foreach ($A¸†„ó§ªŠ as $CÎ‹Ù¡Ô¶ª => $e¢Ù—æ­ƒ–) { $A¸†„ó§ªŠ[$CÎ‹Ù¡Ô¶ª] = self::iconvSystem($e¢Ù—æ­ƒ–); } KodArchive::create($Bì®ÊÚÀ•¥, $A¸†„ó§ªŠ); if (!IO::exist($aµŒ¬ğ‘à)) { if ($cÏÎ½ˆŞãè) { del_dir($cÏÎ½ˆŞãè); } show_json(LNG($d†ƒÁ÷‘‚Ê[1072]), !1); } goto fñò¡Ã§Ğ; cîÛ›°“‚: $cÏÎ½ˆŞãè = !1; if (!$CˆŸõ¦ÄÛÅ && $a‚¤Ô‡–è‚->getType() == $d†ƒÁ÷‘‚Ê[106]) { $A¸†„ó§ªŠ = self::zipFileList($D¶Ñ ¢±Œà); } else { $cÏÎ½ˆŞãè = $CˆŸõ¦ÄÛÅ ? $CˆŸõ¦ÄÛÅ : TEMP_FILES . $d†ƒÁ÷‘‚Ê[1070] . time() . rand_string(8) . $d†ƒÁ÷‘‚Ê[8]; mk_dir($cÏÎ½ˆŞãè); $A¸†„ó§ªŠ = self::zipFileList($D¶Ñ ¢±Œà, $cÏÎ½ˆŞãè); } $Bî²Ô³¿³Ê = $cª˜÷â Üì[$d†ƒÁ÷‘‚Ê[28]]; goto AÀ‡ÅÍ‹ïÇ; AÀ‡ÅÍ‹ïÇ: if (count($A¸†„ó§ªŠ) > 1) { $Cª§Ğ¿²÷Û = IO::info(IO::pathFather($cª˜÷â Üì[$d†ƒÁ÷‘‚Ê[76]])); $Bî²Ô³¿³Ê = $Cª§Ğ¿²÷Û[$d†ƒÁ÷‘‚Ê[28]]; } $bˆ Ìõï”˜ = $cÏÎ½ˆŞãè; if (!$bˆ Ìõï”˜) { $bˆ Ìõï”˜ = get_path_father($cª˜÷â Üì[$d†ƒÁ÷‘‚Ê[76]]); if (!$CˆŸõ¦ÄÛÅ && $a‚¤Ô‡–è‚->getType() == $d†ƒÁ÷‘‚Ê[106]) { $bˆ Ìõï”˜ = get_path_father($a‚¤Ô‡–è‚->path); } $b©™¥å‘à» = IO::info($bˆ Ìõï”˜); if (!$b©™¥å‘à»[$d†ƒÁ÷‘‚Ê[196]]) { show_json(LNG($d†ƒÁ÷‘‚Ê[1071]), !1); } } goto C³Ö¼Ë´›; C³Ö¼Ë´›: $aµŒ¬ğ‘à = $bˆ Ìõï”˜ . $Bî²Ô³¿³Ê . $d†ƒÁ÷‘‚Ê[95] . $f¢’½ëòÊ; $aµŒ¬ğ‘à = get_filename_auto($aµŒ¬ğ‘à, $d†ƒÁ÷‘‚Ê[33], $E©ä‚ŠÄ); $Bì®ÊÚÀ•¥ = self::iconvSystem($aµŒ¬ğ‘à); goto E‰÷¢‚Õõ; b©ŞêÛ”ö†: if (!$f¹éÊ½ÕØ) { del_dir($cÏÎ½ˆŞãè); show_json(LNG($d†ƒÁ÷‘‚Ê[1072]), !1); } del_dir($cÏÎ½ˆŞãè); return $f¹éÊ½ÕØ; goto a‹Èº‚°Ë; fñò¡Ã§Ğ: if ($CˆŸõ¦ÄÛÅ || !$cÏÎ½ˆŞãè) { if ($cÏÎ½ˆŞãè && strstr($cÏÎ½ˆŞãè, TEMP_FILES)) { $eô”‘‘·ˆ‡ = $A¸†„ó§ªŠ = array(); recursion_dir($bˆ Ìõï”˜, $eô”‘‘·ˆ‡, $A¸†„ó§ªŠ, 0); foreach ($eô”‘‘·ˆ‡ as $EŞâ×ŞÂÅÖ) { del_dir($EŞâ×ŞÂÅÖ); } foreach ($A¸†„ó§ªŠ as $bÉæÏÚîœ¹) { if ($bÉæÏÚîœ¹ == $Bì®ÊÚÀ•¥) { continue; } del_file($bÉæÏÚîœ¹); } } return $aµŒ¬ğ‘à; } $d÷˜í„½ = self::pathFather($cª˜÷â Üì[$d†ƒÁ÷‘‚Ê[76]]); $f¹éÊ½ÕØ = self::move($aµŒ¬ğ‘à, $d÷˜í„½, $E©ä‚ŠÄ); goto b©ŞêÛ”ö†; F™¹¯Äëñ: $d†ƒÁ÷‘‚Ê =& $_SERVER[¬¦ã¾]; $a‚¤Ô‡–è‚ = self::init($D¶Ñ ¢±Œà[0][$d†ƒÁ÷‘‚Ê[76]]); $cª˜÷â Üì = self::info($D¶Ñ ¢±Œà[0][$d†ƒÁ÷‘‚Ê[76]]); goto cîÛ›°“‚; a‹Èº‚°Ë: } public static function unzip($f÷×ë‹ˆä, $CÃ–‘Óâ¾Ç = "\162\x65\x70\154\141\x63\145") { goto b»Ñ¼·ªœÂ; Dë…‚…×ğ: mk_dir($B‹†ÌÄ); $CÈ¤Ô¼™ÖÜ = self::fileExt($bİ‡»ŞÏ°‡); $Cí¶÷¢ñÕ = $B‹†ÌÄ . $eŒÚ›ÑäõÏ[95] . $CÈ¤Ô¼™ÖÜ; goto Fö¹ Ö³ÒÂ; D´î½ÉôÑ: Hook::trigger($eŒÚ›ÑäõÏ[1080], $B‹†ÌÄ); recursion_dir($B‹†ÌÄ, $d¦·œÎ¿¯ã, $AÌÉ»ïö¨Ê, 0); $eó«ÁãšØ´ = array_merge($d¦·œÎ¿¯ã, $AÌÉ»ïö¨Ê); goto A›…µËíâ°; Fö¹ Ö³ÒÂ: if (!@file_exists(self::iconvSystem($Cí¶÷¢ñÕ))) { $B„îòÖ¬´ = self::localFilePath($DÀĞ¤°±ãÏ, $CÈ¤Ô¼™ÖÜ); $Cí¶÷¢ñÕ = $B„îòÖ¬´ ? $B„îòÖ¬´ : parent::download($DÀĞ¤°±ãÏ, $Cí¶÷¢ñÕ); } $Cí¶÷¢ñÕ = self::iconvSystem($Cí¶÷¢ñÕ); $díí´ÙÅß = isset($f÷×ë‹ˆä[$eŒÚ›ÑäõÏ[1075]]) ? $f÷×ë‹ˆä[$eŒÚ›ÑäõÏ[1075]] : $eŒÚ›ÑäõÏ[1076]; goto D¿ öóù•“; D¿ öóù•“: $D©»ÈŠ = KodArchive::extract($Cí¶÷¢ñÕ, $B‹†ÌÄ . $eŒÚ›ÑäõÏ[8], $díí´ÙÅß); self::archiveExt(); if (!$D©»ÈŠ[$eŒÚ›ÑäõÏ[1077]]) { show_json($eŒÚ›ÑäõÏ[1078] . $D©»ÈŠ[$eŒÚ›ÑäõÏ[1079]], !1); } goto D´î½ÉôÑ; eİ–ßªÕÃ: $b’öò×Š = self::tmpFileName($bİ‡»ŞÏ°‡); $B‹†ÌÄ = TEMP_FILES . $b’öò×Š; del_dir($B‹†ÌÄ); goto Dë…‚…×ğ; b»Ñ¼·ªœÂ: $eŒÚ›ÑäõÏ =& $_SERVER[¬¦ã¾]; $DÀĞ¤°±ãÏ = $f÷×ë‹ˆä[$eŒÚ›ÑäõÏ[76]]; $A‡é¥â‹º³ = $f÷×ë‹ˆä[$eŒÚ›ÑäõÏ[1073]]; goto aŒŞƒÚ°Óİ; aŒŞƒÚ°Óİ: if (!($bİ‡»ŞÏ°‡ = parent::info($DÀĞ¤°±ãÏ))) { show_json(LNG($eŒÚ›ÑäõÏ[1074]), !1); } if (!($b¢œ—°»ë = parent::infoFull($A‡é¥â‹º³))) { $A‡é¥â‹º³ = parent::mkdir($A‡é¥â‹º³); $b¢œ—°»ë = array($eŒÚ›ÑäõÏ[76] => $A‡é¥â‹º³); } else { if (isset($b¢œ—°»ë[$eŒÚ›ÑäõÏ[395]]) && trim($b¢œ—°»ë[$eŒÚ›ÑäõÏ[76]], $eŒÚ›ÑäõÏ[8]) != trim($A‡é¥â‹º³, $eŒÚ›ÑäõÏ[8])) { $dŒ…‰÷´¯ = KodIO::make($b¢œ—°»ë[$eŒÚ›ÑäõÏ[478]]); $EŸÔÔ¡ç¹¯ = parent::fileNameAuto($dŒ…‰÷´¯, $b¢œ—°»ë[$eŒÚ›ÑäõÏ[28]], REPEAT_RENAME_FOLDER, !0); $A‡é¥â‹º³ = parent::mkdir($dŒ…‰÷´¯ . $EŸÔÔ¡ç¹¯); $b¢œ—°»ë = array($eŒÚ›ÑäõÏ[76] => $A‡é¥â‹º³); } } $A‡é¥â‹º³ = $b¢œ—°»ë[$eŒÚ›ÑäõÏ[76]]; goto eİ–ßªÕÃ; A›…µËíâ°: foreach ($eó«ÁãšØ´ as $fÅŞ´â‰‡Š) { $fÅŞ´â‰‡Š = self::iconvApp($fÅŞ´â‰‡Š); self::move($fÅŞ´â‰‡Š, $A‡é¥â‹º³, $CÃ–‘Óâ¾Ç); } del_dir($B‹†ÌÄ); if (!$B„îòÖ¬´) { del_file($Cí¶÷¢ñÕ); } goto B¯´Êâ›Çä; B¯´Êâ›Çä: return !0; goto F…Ü¦‘Âí; F…Ü¦‘Âí: } public static function unzipList($cÏöùñí) { goto BŠ›äœ®Êå; C¿°¦Ôğ: return $b‘‰ôìïôï[$a‰Õ‚ÖˆÛ°[1079]]; goto Cƒ»Ò—«ôí; dŒ‚”ğŞôù: if (!is_dir($aÍ‹ˆ©)) { mk_dir($aÍ‹ˆ©); } $aÜ‹êÊÉæ« = $aÍ‹ˆ© . $a‰Õ‚ÖˆÛ°[8] . $B‹ºØ¦§¶°; if (!@file_exists(self::iconvSystem($aÜ‹êÊÉæ«))) { if (isset($eÊÂ±ÔˆíÁ)) { url_request($a‡Ãœ¶ïÖá, $a‰Õ‚ÖˆÛ°[1084], $aÜ‹êÊÉæ«); } else { $BêÙÃÒ»ÔÎ = self::localFilePath($a‡Ãœ¶ïÖá, $CÛ¹Í‰ ); $aÜ‹êÊÉæ« = $BêÙÃÒ»ÔÎ ? $BêÙÃÒ»ÔÎ : self::download($a‡Ãœ¶ïÖá, $aÜ‹êÊÉæ«); } } goto aèğÕÑó×; Bˆò¶†í‘: if (isset($eÊÂ±ÔˆíÁ)) { $fÅ±ğÜİ‰â = array($eÊÂ±ÔˆíÁ[$a‰Õ‚ÖˆÛ°[76]], $eÊÂ±ÔˆíÁ[$a‰Õ‚ÖˆÛ°[1081]], $eÊÂ±ÔˆíÁ[$a‰Õ‚ÖˆÛ°[28]]); $B‹ºØ¦§¶° = md5(implode($a‰Õ‚ÖˆÛ°[71], $fÅ±ğÜİ‰â)) . $a‰Õ‚ÖˆÛ°[95] . get_path_ext($eÊÂ±ÔˆíÁ[$a‰Õ‚ÖˆÛ°[28]]); } else { $fÅ±ğÜİ‰â = array($DùŞùÏ˜¬[$a‰Õ‚ÖˆÛ°[28]], $DùŞùÏ˜¬[$a‰Õ‚ÖˆÛ°[76]], $DùŞùÏ˜¬[$a‰Õ‚ÖˆÛ°[78]]); $B‹ºØ¦§¶° = md5(implode($a‰Õ‚ÖˆÛ°[71], $fÅ±ğÜİ‰â)) . $a‰Õ‚ÖˆÛ°[95] . $CÛ¹Í‰ ; } if ($e«„œ«Èõ× == -1) { $cïŒË…³«™ = IO_PATH_SYSTEM_TEMP . "\x7a\151\x70\x56\x69\x65\x77\x2f{$c˜ÀŠÒ’ù‹}\x2f{$B‹ºØ¦§¶°}\x2e\x6c\x6f\x67"; $Eé¡İğ—½Ä = self::infoFull($cïŒË…³«™); if ($Eé¡İğ—½Ä) { $cïŒË…³«™ = $Eé¡İğ—½Ä[$a‰Õ‚ÖˆÛ°[76]]; $FÓòã­İÇ = self::getContent($cïŒË…³«™); if ($FÓòã­İÇ) { $A”£”‰Ø†À = json_decode($FÓòã­İÇ, !0); if (count($A”£”‰Ø†À) >= $eéØ¿Ñ‰É“) { show_json(sprintf(LNG($a‰Õ‚ÖˆÛ°[1083]), count($A”£”‰Ø†À)), !1); } return $A”£”‰Ø†À; } } else { $cïŒË…³«™ = self::mkfile($cïŒË…³«™); } } $aÍ‹ˆ© = TEMP_FILES . $c˜ÀŠÒ’ù‹; goto dŒ‚”ğŞôù; aèğÕÑó×: $aÜ‹êÊÉæ« = self::iconvSystem($aÜ‹êÊÉæ«); if ($e«„œ«Èõ× >= 0) { $Ašä½õ©¸Ö = isset($cÏöùñí[$a‰Õ‚ÖˆÛ°[1085]]) ? $cÏöùñí[$a‰Õ‚ÖˆÛ°[1085]] : !1; $Dßğí‚…‚ = isset($cÏöùñí[$a‰Õ‚ÖˆÛ°[28]]) ? $cÏöùñí[$a‰Õ‚ÖˆÛ°[28]] : $a‰Õ‚ÖˆÛ°[33]; KodArchive::filePreview($aÜ‹êÊÉæ«, $e«„œ«Èõ×, $Ašä½õ©¸Ö, $Dßğí‚…‚); self::archiveExt(); die; } $b‘‰ôìïôï = KodArchive::listContent($aÜ‹êÊÉæ«); goto Dƒ´‚¡Ëœ; D£ØíÀ‘ãÛ: $A”£”‰Ø†À = json_encode($b‘‰ôìïôï[$a‰Õ‚ÖˆÛ°[1079]]); self::setContent($cïŒË…³«™, $A”£”‰Ø†À); if (count($b‘‰ôìïôï[$a‰Õ‚ÖˆÛ°[1079]]) >= $eéØ¿Ñ‰É“) { show_json(sprintf(LNG($a‰Õ‚ÖˆÛ°[1083]), count($b‘‰ôìïôï[$a‰Õ‚ÖˆÛ°[1079]])), !1); } goto C¿°¦Ôğ; Dƒ´‚¡Ëœ: self::archiveExt(); del_dir($aÍ‹ˆ©); if (!$b‘‰ôìïôï[$a‰Õ‚ÖˆÛ°[1077]]) { show_json($b‘‰ôìïôï[$a‰Õ‚ÖˆÛ°[1079]], !1); } goto D£ØíÀ‘ãÛ; fÓ¿ã±–âÇ: $DùŞùÏ˜¬ = self::info($e¸Œ¿´æÁÄ); $CÛ¹Í‰  = self::fileExt($DùŞùÏ˜¬); $c˜ÀŠÒ’ù‹ = self::tmpFileName($DùŞùÏ˜¬); goto Bˆò¶†í‘; c»¶²ó¨ôš: $eéØ¿Ñ‰É“ = 50000; if (request_url_safe($a‡Ãœ¶ïÖá)) { $eÊÂ±ÔˆíÁ = parse_url_query($a‡Ãœ¶ïÖá); if (!isset($eÊÂ±ÔˆíÁ[$a‰Õ‚ÖˆÛ°[76]])) { show_json($a‰Õ‚ÖˆÛ°[1082], !1); } } $e¸Œ¿´æÁÄ = isset($eÊÂ±ÔˆíÁ) ? $eÊÂ±ÔˆíÁ[$a‰Õ‚ÖˆÛ°[76]] : $a‡Ãœ¶ïÖá; goto fÓ¿ã±–âÇ; BŠ›äœ®Êå: $a‰Õ‚ÖˆÛ° =& $_SERVER[¬¦ã¾]; $a‡Ãœ¶ïÖá = $cÏöùñí[$a‰Õ‚ÖˆÛ°[76]]; $e«„œ«Èõ× = isset($cÏöùñí[$a‰Õ‚ÖˆÛ°[1081]]) ? $cÏöùñí[$a‰Õ‚ÖˆÛ°[1081]] : -1; goto c»¶²ó¨ôš; Cƒ»Ò—«ôí: } private static function fileExt($DïÑªøÊ¦Ï) { $B®”µ³ =& $_SERVER[¬¦ã¾]; $a¾ø«ƒí÷ = $DïÑªøÊ¦Ï[$B®”µ³[168]]; if ($a¾ø«ƒí÷ == $B®”µ³[1086]) { $c„°ó¯Ôª† = $B®”µ³[1087]; if (substr($DïÑªøÊ¦Ï[$B®”µ³[28]], -strlen($c„°ó¯Ôª†)) == $c„°ó¯Ôª†) { $a¾ø«ƒí÷ = $B®”µ³[1088]; } } self::archiveExt($a¾ø«ƒí÷); return $a¾ø«ƒí÷; } private static function zipFileList($FÜïŠ¢Î, $AßŠœµ´ = false) { $b»¤¨’é† =& $_SERVER[¬¦ã¾]; $fÑÌÌÜ½ñ… = array(); foreach ($FÜïŠ¢Î as $c‡†ŠáğËÅ) { $A¿ÖòÄ²õœ = $c‡†ŠáğËÅ[$b»¤¨’é†[76]]; if ($AßŠœµ´) { $A¿ÖòÄ²õœ = self::copy($c‡†ŠáğËÅ[$b»¤¨’é†[76]], $AßŠœµ´, $b»¤¨’é†[775]); } else { $cŠ¬âÂˆ¡— = self::init($c‡†ŠáğËÅ[$b»¤¨’é†[76]]); if ($cŠ¬âÂˆ¡—->getType() == $b»¤¨’é†[106]) { $A¿ÖòÄ²õœ = $cŠ¬âÂˆ¡—->path; } } if ($A¿ÖòÄ²õœ && self::local()->exist($A¿ÖòÄ²õœ)) { $fÑÌÌÜ½ñ…[$c‡†ŠáğËÅ[$b»¤¨’é†[76]]] = $A¿ÖòÄ²õœ; } } if (!empty($fÑÌÌÜ½ñ…)) { return array_values($fÑÌÌÜ½ñ…); } show_json(LNG($b»¤¨’é†[1052]), !1); } public static function tmpFileName($aì‰ï‚‡) { $Aº•œ±³Ô =& $_SERVER[¬¦ã¾]; $b’Õ•å„òÄ = array($aì‰ï‚‡[$Aº•œ±³Ô[28]], $aì‰ï‚‡[$Aº•œ±³Ô[76]], $aì‰ï‚‡[$Aº•œ±³Ô[78]], $aì‰ï‚‡[$Aº•œ±³Ô[487]]); return md5(implode($Aº•œ±³Ô[71], $b’Õ•å„òÄ)); } private static function localFilePath($d°ÖÍóæëø, $EÊÙÇÓ®±Ï) { goto CÂªáªê®¡; CÂªáªê®¡: $Cë³×ç½¾ =& $_SERVER[¬¦ã¾]; if ($EÊÙÇÓ®±Ï == $Cë³×ç½¾[1089] && strtoupper(substr(PHP_OS, 0, 3)) == $Cë³×ç½¾[1090]) { return !1; } $fÎÌ»êŒË‘ = KodIO::parse($d°ÖÍóæëø); goto A¬”Œ¨×‹; Fæ»ö·ó’‰: if ($CË¾‹“Â®â == $Cë³×ç½¾[106] || $CË¾‹“Â®â == $Cë³×ç½¾[1092]) { if (!$B‰ÔÜò Ø’->exist($B‰ÔÜò Ø’->path)) { show_json(LNG($Cë³×ç½¾[105]), !1); } return $B‰ÔÜò Ø’->path; } return !1; goto DæñÒãô°ì; A¬”Œ¨×‹: if ($fÎÌ»êŒË‘[$Cë³×ç½¾[29]] == KodIO::KOD_SOURCE) { $A‘È¦Ò‚õ = Model($Cë³×ç½¾[782])->fileInfoGet(KodIO::sourceID($d°ÖÍóæëø)); if (!$A‘È¦Ò‚õ[$Cë³×ç½¾[76]]) { show_json($Cë³×ç½¾[1091], !1); } $d°ÖÍóæëø = $A‘È¦Ò‚õ[$Cë³×ç½¾[76]]; } $B‰ÔÜò Ø’ = self::init($d°ÖÍóæëø); $CË¾‹“Â®â = $B‰ÔÜò Ø’->getType(); goto Fæ»ö·ó’‰; DæñÒãô°ì: } private static function archiveExt($CâÓÄ¢À = '') { $GLOBALS[$_SERVER[¬¦ã¾][1093]] = $CâÓÄ¢À; } } goto DÁ ÂÀ«”š; d¯Ë°˜«”Õ: class Controller extends ClassBaseCall { public $in; public $config; public $tpl; public $values; function __construct() { goto B¥õ¬¾¯ğ; B¥õ¬¾¯ğ: $b±»¿Ó…ƒó =& $_SERVER[¬¦ã¾]; global $in, $config; $this->config =& $config; goto F½¤íçãÅĞ; F½¤íçãÅĞ: $this->in =& $in; $this->values[$b±»¿Ó…ƒó[6]] =& $config; $this->values[$b±»¿Ó…ƒó[7]] =& $in; goto cÊ·ÄÇ­; cÊ·ÄÇ­: $this->tpl = TEMPLATE . MOD . $b±»¿Ó…ƒó[8]; $this->_classObjectID = mt_rand(0, 10000); goto fì¶½óëÚí; fì¶½óëÚí: } public function loadClass($e–â‘ö”·) { if (1 === func_num_args()) { $this->{$e–â‘ö”·} = new $e–â‘ö”·(); } else { $F«ˆ‚‡ÅÇ = new ReflectionClass($e–â‘ö”·); $f‚³ƒ‰íëŸ = func_get_args(); array_shift($f‚³ƒ‰íëŸ); $this->{$e–â‘ö”·} = $F«ˆ‚‡ÅÇ->newInstanceArgs($f‚³ƒ‰íëŸ); } return $this->{$e–â‘ö”·}; } protected function assign($E”ãÖÛÙë, $cÇÅöä×…) { $this->values[$E”ãÖÛÙë] = $cÇÅöä×…; } protected function display($Aì›à‰„) { ob_end_clean(); extract($this->values); require $this->tpl . $Aì›à‰„; } } class DbSqliteBase extends Db { public function __construct($aÕŠâ…‰ÃÖ = '') { $B¶ÚÅ‚´—ø =& $_SERVER[¬¦ã¾]; if (!extension_loaded($B¶ÚÅ‚´—ø[9])) { think_exception(think_lang($B¶ÚÅ‚´—ø[10]) . $B¶ÚÅ‚´—ø[11]); } if (!empty($aÕŠâ…‰ÃÖ)) { if (!isset($aÕŠâ…‰ÃÖ[$B¶ÚÅ‚´—ø[12]])) { $aÕŠâ…‰ÃÖ[$B¶ÚÅ‚´—ø[12]] = 438; } $this->config = $aÕŠâ…‰ÃÖ; if (empty($this->config[$B¶ÚÅ‚´—ø[13]])) { $this->config[$B¶ÚÅ‚´—ø[13]] = array(); } } } public function connect($b¾ïšËÑ£¼ = '', $bù˜ŒíãÔó = 0) { $bİÚæ±×®˜ =& $_SERVER[¬¦ã¾]; if (!isset($this->linkID[$bù˜ŒíãÔó])) { goto fÃ…óå«Õ¶; fÃ…óå«Õ¶: if (empty($b¾ïšËÑ£¼)) { $b¾ïšËÑ£¼ = $this->config; } $Dµ³¨ÍÅ = !empty($b¾ïšËÑ£¼[$bİÚæ±×®˜[13]][$bİÚæ±×®˜[14]]) ? $b¾ïšËÑ£¼[$bİÚæ±×®˜[13]][$bİÚæ±×®˜[14]] : $this->pconnect; $AÊÕ¹£©Åë = $Dµ³¨ÍÅ ? $bİÚæ±×®˜[15] : $bİÚæ±×®˜[16]; goto AÉÊëùˆµğ; AÉÊëùˆµğ: $this->linkID[$bù˜ŒíãÔó] = $AÊÕ¹£©Åë($b¾ïšËÑ£¼[$bİÚæ±×®˜[17]], $b¾ïšËÑ£¼[$bİÚæ±×®˜[12]]); if (!$this->linkID[$bù˜ŒíãÔó]) { think_exception(sqlite_error_string()); } $this->connected = !0; goto C´äïçÕå•; C´äïçÕå•: @sqlite_busy_timeout($this->linkID[$bù˜ŒíãÔó], 30000); if (1 != think_config($bİÚæ±×®˜[18])) { unset($this->config); } goto AŒò§ì•Ê½; AŒò§ì•Ê½: } return $this->linkID[$bù˜ŒíãÔó]; } public function free() { $this->queryID = null; } public function query($DøŒÛß§ŸĞ) { goto dœ¶‘Ç› ; DÜÁñÉŠÀå: think_status($c“‡çñÉ×[20]); $this->queryID = sqlite_query($this->_linkID, $DøŒÛß§ŸĞ); $this->debug(); goto a·­Ğîº¬º; F­êÌèâ¶: $this->queryStr = $DøŒÛß§ŸĞ; if ($this->queryID) { $this->free(); } think_action_status($c“‡çñÉ×[19], 1); goto DÜÁñÉŠÀå; dœ¶‘Ç› : $c“‡çñÉ× =& $_SERVER[¬¦ã¾]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto F­êÌèâ¶; a·­Ğîº¬º: if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = sqlite_num_rows($this->queryID); $F»”–ËˆĞ­ = $this->getAll(); return $F»”–ËˆĞ­; } goto B¡æËÖ¡Ô­; B¡æËÖ¡Ô­: } public function execute($D…ñ•ñ™éá) { goto f³›ëó®Ñ; f³›ëó®Ñ: $aôËô®—Öƒ =& $_SERVER[¬¦ã¾]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto EâÁòÑ²Òê; EâÁòÑ²Òê: $this->queryStr = $D…ñ•ñ™éá; if ($this->queryID) { $this->free(); } think_action_status($aôËô®—Öƒ[21], 1); goto e•ª¹‹ÑÖ; Dó½¨Ô‘»É: if (!1 === $CÇ‡ğŒ„†) { $this->error(); return !1; } else { $this->numRows = sqlite_changes($this->_linkID); $this->lastInsID = sqlite_last_insert_rowid($this->_linkID); return $this->numRows; } goto B´éË¹Ùª¯; e•ª¹‹ÑÖ: think_status($aôËô®—Öƒ[20]); $CÇ‡ğŒ„† = sqlite_exec($this->_linkID, $D…ñ•ñ™éá); $this->debug(); goto Dó½¨Ô‘»É; B´éË¹Ùª¯: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { sqlite_query($this->_linkID, $_SERVER[¬¦ã¾][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $Bä…ÇŠë‡ = sqlite_query($this->_linkID, $_SERVER[¬¦ã¾][23]); if (!$Bä…ÇŠë‡) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $d¨·‘½Üƒß = sqlite_query($this->_linkID, $_SERVER[¬¦ã¾][24]); if (!$d¨·‘½Üƒß) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $AŸßÒì¶Ğ = array(); if ($this->numRows > 0) { for ($eÍ½¿ó¯Í‹ = 0; $eÍ½¿ó¯Í‹ < $this->numRows; $eÍ½¿ó¯Í‹++) { $AŸßÒì¶Ğ[$eÍ½¿ó¯Í‹] = sqlite_fetch_array($this->queryID, SQLITE_ASSOC); } sqlite_seek($this->queryID, 0); } return $AŸßÒì¶Ğ; } public function getFields($AÂöµææ) { $A¢™ïÑ‚¬ï =& $_SERVER[¬¦ã¾]; $A–†®›¨£ = $this->query($A¢™ïÑ‚¬ï[25] . $AÂöµææ . $A¢™ïÑ‚¬ï[26]); $FÎèÇ÷’âê = array(); if ($A–†®›¨£) { foreach ($A–†®›¨£ as $bºÕÒ¦Ì¯› => $aè´ã±õÚ) { $FÎèÇ÷’âê[$aè´ã±õÚ[$A¢™ïÑ‚¬ï[27]]] = array($A¢™ïÑ‚¬ï[28] => $aè´ã±õÚ[$A¢™ïÑ‚¬ï[27]], $A¢™ïÑ‚¬ï[29] => $aè´ã±õÚ[$A¢™ïÑ‚¬ï[30]], $A¢™ïÑ‚¬ï[31] => (bool) ($aè´ã±õÚ[$A¢™ïÑ‚¬ï[32]] === $A¢™ïÑ‚¬ï[33]), $A¢™ïÑ‚¬ï[34] => $aè´ã±õÚ[$A¢™ïÑ‚¬ï[35]], $A¢™ïÑ‚¬ï[36] => strtolower($aè´ã±õÚ[$A¢™ïÑ‚¬ï[37]]) == $A¢™ïÑ‚¬ï[38], $A¢™ïÑ‚¬ï[39] => strtolower($aè´ã±õÚ[$A¢™ïÑ‚¬ï[40]]) == $A¢™ïÑ‚¬ï[41]); } } return $FÎèÇ÷’âê; } public function getTables($bµš¦™‘ = '') { $dˆ³Ï–ôå² =& $_SERVER[¬¦ã¾]; $b‚°‰ŒÉÂ = $this->query($dˆ³Ï–ôå²[42] . $dˆ³Ï–ôå²[43] . $dˆ³Ï–ôå²[44]); $f³œ¶¹–Î = array(); foreach ($b‚°‰ŒÉÂ as $d¥îÉâÒ´í => $E…á•®¸) { $f³œ¶¹–Î[$d¥îÉâÒ´í] = current($E…á•®¸); } return $f³œ¶¹–Î; } public function close() { if ($this->_linkID) { sqlite_close($this->_linkID); } $this->_linkID = null; } public function error() { $aåêÊ×«‚Í =& $_SERVER[¬¦ã¾]; $E—ß„Å ÃÎ = sqlite_last_error($this->_linkID); $this->error = $E—ß„Å ÃÎ . $aåêÊ×«‚Í[4] . sqlite_error_string($E—ß„Å ÃÎ); if ($aåêÊ×«‚Í[33] != $this->queryStr) { $this->error .= LNG($aåêÊ×«‚Í[45]) . $this->queryStr; } think_trace($this->error, $aåêÊ×«‚Í[33], $aåêÊ×«‚Í[46]); return $this->error; } public function escapeString($dÈ–Ğ¾¤†) { return sqlite_escape_string($dÈ–Ğ¾¤†); } public function parseLimit($cá‘ÙĞƒ÷ƒ) { $c’¢ÚÙ¿²İ =& $_SERVER[¬¦ã¾]; $F³¡¡¦Òï± = $c’¢ÚÙ¿²İ[33]; if (!empty($cá‘ÙĞƒ÷ƒ)) { $cá‘ÙĞƒ÷ƒ = explode($c’¢ÚÙ¿²İ[47], $cá‘ÙĞƒ÷ƒ); if (count($cá‘ÙĞƒ÷ƒ) > 1) { $F³¡¡¦Òï± .= $c’¢ÚÙ¿²İ[48] . $cá‘ÙĞƒ÷ƒ[1] . $c’¢ÚÙ¿²İ[49] . $cá‘ÙĞƒ÷ƒ[0] . $c’¢ÚÙ¿²İ[50]; } else { $F³¡¡¦Òï± .= $c’¢ÚÙ¿²İ[48] . $cá‘ÙĞƒ÷ƒ[0] . $c’¢ÚÙ¿²İ[50]; } } return $F³¡¡¦Òï±; } } class DbSqlite3Base extends Db { public function __construct($Bâ‡ôë·˜ç = '') { $eö»ßÏò±¼ =& $_SERVER[¬¦ã¾]; if (!class_exists($eö»ßÏò±¼[51])) { think_exception(think_lang($eö»ßÏò±¼[10]) . $eö»ßÏò±¼[52]); } if (!empty($Bâ‡ôë·˜ç)) { if (!isset($Bâ‡ôë·˜ç[$eö»ßÏò±¼[12]])) { $Bâ‡ôë·˜ç[$eö»ßÏò±¼[12]] = 438; } $this->config = $Bâ‡ôë·˜ç; if (empty($this->config[$eö»ßÏò±¼[13]])) { $this->config[$eö»ßÏò±¼[13]] = array(); } } } public function connect($aÒ»×Ì§‹š = '', $B­š§ÍÂæ = 0) { $b×ÉìÚÅÆå =& $_SERVER[¬¦ã¾]; if (!isset($this->linkID[$B­š§ÍÂæ])) { if (empty($aÒ»×Ì§‹š)) { $aÒ»×Ì§‹š = $this->config; } $this->linkID[$B­š§ÍÂæ] = new SQLite3($aÒ»×Ì§‹š[$b×ÉìÚÅÆå[17]]); if (!$this->linkID[$B­š§ÍÂæ]) { think_exception($this->linkID[$B­š§ÍÂæ]->lastErrorMsg()); } $this->connected = !0; @$this->linkID[$B­š§ÍÂæ]->busyTimeout(30000); if (1 != think_config($b×ÉìÚÅÆå[18])) { unset($this->config); } } return $this->linkID[$B­š§ÍÂæ]; } public function free() { $this->queryID = null; } public function query($fÃòŠÓí´«) { goto fÀğÍÉ¬’—; F½æ”Ö©Š¢: think_status($EªÜ¨µÅÌ„[20]); $this->queryID = $this->_linkID->query($fÃòŠÓí´«); $this->debug(); goto aßÊÀ¦ï¬ó; aßÊÀ¦ï¬ó: if (!1 === $this->queryID) { $this->error(); return !1; } else { $EêÇ‰›½›• = $this->getAll(); $this->numRows = count($EêÇ‰›½›•); return $EêÇ‰›½›•; } goto eÌ¸¥¢©à´; a‚‘Ï…„÷Î: $this->queryStr = $fÃòŠÓí´«; if ($this->queryID) { $this->free(); } think_action_status($EªÜ¨µÅÌ„[19], 1); goto F½æ”Ö©Š¢; fÀğÍÉ¬’—: $EªÜ¨µÅÌ„ =& $_SERVER[¬¦ã¾]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto a‚‘Ï…„÷Î; eÌ¸¥¢©à´: } public function execute($d»ïºøÇ–å) { goto dîó†‰Õš¥; EÁéì¦À§¨: think_status($eŸ¥Í¥ƒ[20]); $c¢Ê¾Äá´¸ = $this->_linkID->exec($d»ïºøÇ–å); $this->debug(); goto c¼îÅÃ±ª; c¼îÅÃ±ª: if (!1 === $c¢Ê¾Äá´¸) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->changes(); $this->lastInsID = $this->_linkID->lastInsertRowID(); return $this->numRows; } goto dµÎŠç¼Ğ¦; dîó†‰Õš¥: $eŸ¥Í¥ƒ =& $_SERVER[¬¦ã¾]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto FœæÈÂÂ˜½; FœæÈÂÂ˜½: $this->queryStr = $d»ïºøÇ–å; if ($this->queryID) { $this->free(); } think_action_status($eŸ¥Í¥ƒ[21], 1); goto EÁéì¦À§¨; dµÎŠç¼Ğ¦: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->query($_SERVER[¬¦ã¾][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $eà†ÅÒ÷ù· = $this->_linkID->query($_SERVER[¬¦ã¾][23]); if (!$eà†ÅÒ÷ù·) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $c‡Ã¼¦»®† = $this->_linkID->query($_SERVER[¬¦ã¾][24]); if (!$c‡Ã¼¦»®†) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $AË¢ÀŞÔÇ¬ = array(); while ($bŞ®‘Èî¸¶ = $this->queryID->fetchArray(SQLITE3_ASSOC)) { $AË¢ÀŞÔÇ¬[] = $bŞ®‘Èî¸¶; } $this->queryID->reset(); return $AË¢ÀŞÔÇ¬; } public function getFields($f»Æ¡Áàß¯) { $bŸâ¤ÓÀ =& $_SERVER[¬¦ã¾]; $F°‚Ï’£À÷ = $this->query($bŸâ¤ÓÀ[25] . $f»Æ¡Áàß¯ . $bŸâ¤ÓÀ[26]); $EâÆÕä‰Ş¡ = array(); if ($F°‚Ï’£À÷) { foreach ($F°‚Ï’£À÷ as $fƒóˆ‚Ç© => $c£°ğ¨½Ü«) { $EâÆÕä‰Ş¡[$c£°ğ¨½Ü«[$bŸâ¤ÓÀ[28]]] = array($bŸâ¤ÓÀ[28] => $c£°ğ¨½Ü«[$bŸâ¤ÓÀ[28]], $bŸâ¤ÓÀ[29] => $c£°ğ¨½Ü«[$bŸâ¤ÓÀ[29]], $bŸâ¤ÓÀ[31] => (bool) ($c£°ğ¨½Ü«[$bŸâ¤ÓÀ[31]] === $bŸâ¤ÓÀ[33]), $bŸâ¤ÓÀ[34] => $c£°ğ¨½Ü«[$bŸâ¤ÓÀ[53]], $bŸâ¤ÓÀ[36] => (bool) $c£°ğ¨½Ü«[$bŸâ¤ÓÀ[54]], $bŸâ¤ÓÀ[39] => (bool) $c£°ğ¨½Ü«[$bŸâ¤ÓÀ[54]]); } } return $EâÆÕä‰Ş¡; } public function getTables($e¡ñÃŞïÎ = '') { $bÜãÔ˜Éõ =& $_SERVER[¬¦ã¾]; $d²„ÎÖÄÅ„ = $this->query($bÜãÔ˜Éõ[42] . $bÜãÔ˜Éõ[43] . $bÜãÔ˜Éõ[44]); $a¿Ò°¼–« = array(); foreach ($d²„ÎÖÄÅ„ as $b©Œ¨˜ÓÛ => $E™ÆÅŒ¶Â) { $a¿Ò°¼–«[$b©Œ¨˜ÓÛ] = current($E™ÆÅŒ¶Â); } return $a¿Ò°¼–«; } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $aôÜ½™öÜ =& $_SERVER[¬¦ã¾]; $this->error = $this->_linkID->lastErrorMsg(); if ($aôÜ½™öÜ[33] != $this->queryStr) { $this->error .= LNG($aôÜ½™öÜ[45]) . $this->queryStr; } think_trace($this->error, $aôÜ½™öÜ[33], $aôÜ½™öÜ[46]); return $this->error; } public function escapeString($fÁêƒ†š†¦) { $Eëœä“ñÙÖ =& $_SERVER[¬¦ã¾]; if ($this->_linkID) { return $this->_linkID->escapeString($fÁêƒ†š†¦); } return str_ireplace($Eëœä“ñÙÖ[55], $Eëœä“ñÙÖ[56], $fÁêƒ†š†¦); } public function parseLimit($d–”òè°ÎŠ) { $a«ºŠÊØïå =& $_SERVER[¬¦ã¾]; $d»›±ªª µ = $a«ºŠÊØïå[33]; if (!empty($d–”òè°ÎŠ)) { $d–”òè°ÎŠ = explode($a«ºŠÊØïå[47], $d–”òè°ÎŠ); if (count($d–”òè°ÎŠ) > 1) { $d»›±ªª µ .= $a«ºŠÊØïå[48] . $d–”òè°ÎŠ[1] . $a«ºŠÊØïå[49] . $d–”òè°ÎŠ[0] . $a«ºŠÊØïå[50]; } else { $d»›±ªª µ .= $a«ºŠÊØïå[48] . $d–”òè°ÎŠ[0] . $a«ºŠÊØïå[50]; } } return $d»›±ªª µ; } } goto D±‘Ê„ƒÈÉ; DÔ¿…¾­’›: class PathDriverDB extends PathDriverBase { public $model; public $pathParse; public function __construct($cÒÏŞö…¬) { $this->pathParse = $cÒÏŞö…¬; $this->model = Model($_SERVER[¬¦ã¾][1197]); } public function getPath($fõ«±‡³àä) { return trim($fõ«±‡³àä, $_SERVER[¬¦ã¾][8]); } public function pathFather($Eƒ´½©ŠÛÈ) { $fÓÖÍÕŠ»± = $this->parse($Eƒ´½©ŠÛÈ); $fÓÖÍÕŠ»± = $this->infoSimple($Eƒ´½©ŠÛÈ); return $fÓÖÍÕŠ»± ? $fÓÖÍÕŠ»±[$_SERVER[¬¦ã¾][478]] : !1; } public function pathThis($c‘‘˜‚…ë) { $AÒÂ‚¤øœ = $this->infoSimple($c‘‘˜‚…ë); return $AÒÂ‚¤øœ ? $AÒÂ‚¤øœ[$_SERVER[¬¦ã¾][28]] : !1; } public function getPathOuter($d‡£¬éÕ­Š) { if (!$d‡£¬éÕ­Š) { return $d‡£¬éÕ­Š; } $fìî‘©‚¼¼ = $this->parse($d‡£¬éÕ­Š); return KodIO::make($fìî‘©‚¼¼[$_SERVER[¬¦ã¾][393]]); } public function copyFolderFromIO($cÑ¨‰¤Â·­, $dÒºÎÆµÀ, $BõÑŒ‘çÑÊ, $C¬Ï¡—”«“, $E³óîŞ¬‰) { $EÇØÉ± = $this->model->copyFolderFromIO($cÑ¨‰¤Â·­, $dÒºÎÆµÀ, $BõÑŒ‘çÑÊ, $C¬Ï¡—”«“, $E³óîŞ¬‰); return KodIO::make($EÇØÉ±); } public function isParentOf($f‡ğˆâ¹Ÿë, $BË˜è¢¨¢) { return $this->model->isParentOf($f‡ğˆâ¹Ÿë, $BË˜è¢¨¢); } public function mkfile($fö÷°§œé¦, $F«¶¼Áæ†ò = '', $cÙ¶ˆàœøˆ = REPEAT_RENAME) { $eÀºƒÉ£”ƒ =& $_SERVER[¬¦ã¾]; $aƒÒÃãõ  = $this->parse($fö÷°§œé¦); $fö÷°§œé¦ = $aƒÒÃãõ [$eÀºƒÉ£”ƒ[393]]; for ($DÄ¨ÓË½ù¾ = 0; $DÄ¨ÓË½ù¾ < count($aƒÒÃãõ [$eÀºƒÉ£”ƒ[1198]]); $DÄ¨ÓË½ù¾++) { $A¸¯òÒ‡… = $aƒÒÃãõ [$eÀºƒÉ£”ƒ[1198]][$DÄ¨ÓË½ù¾]; if ($DÄ¨ÓË½ù¾ == count($aƒÒÃãõ [$eÀºƒÉ£”ƒ[1198]]) - 1) { $fö÷°§œé¦ = $this->model->mkfile($fö÷°§œé¦, $A¸¯òÒ‡…, $F«¶¼Áæ†ò, $cÙ¶ˆàœøˆ); break; } $fö÷°§œé¦ = $this->model->mkdir($fö÷°§œé¦, $A¸¯òÒ‡…, REPEAT_SKIP); } return $this->getPathOuter($fö÷°§œé¦); } public function mkdir($dÛÀˆ–ŞĞ¯, $Bã®„Š¢·Ê = REPEAT_SKIP) { $CÕÕ  ãÍ =& $_SERVER[¬¦ã¾]; $e¾Ëòµ¾‘Ô = $this->parse($dÛÀˆ–ŞĞ¯); $dÛÀˆ–ŞĞ¯ = $e¾Ëòµ¾‘Ô[$CÕÕ  ãÍ[393]]; for ($E…³ƒ³Ãì = 0; $E…³ƒ³Ãì < count($e¾Ëòµ¾‘Ô[$CÕÕ  ãÍ[1198]]); $E…³ƒ³Ãì++) { $F³èáõâ = $e¾Ëòµ¾‘Ô[$CÕÕ  ãÍ[1198]][$E…³ƒ³Ãì]; $dÛÀˆ–ŞĞ¯ = $this->model->mkdir($dÛÀˆ–ŞĞ¯, $F³èáõâ, $Bã®„Š¢·Ê); } return $this->getPathOuter($dÛÀˆ–ŞĞ¯); } public function copyFile($b¨ëŠœÑÖ½, $dˆìâÖ¢¼‹, $Eö£Ï„õ  = REPEAT_REPLACE) { $eøàçğ‘æ =& $_SERVER[¬¦ã¾]; $aÕª‚É×Ò„ = $this->parse($dˆìâÖ¢¼‹); $BÜÓöÑ´‹ö = $this->model->copy($b¨ëŠœÑÖ½, $aÕª‚É×Ò„[$eøàçğ‘æ[393]], $Eö£Ï„õ , $aÕª‚É×Ò„[$eøàçğ‘æ[76]]); return $BÜÓöÑ´‹ö ? $this->getPathOuter($BÜÓöÑ´‹ö) : !1; } public function moveFile($c‘äƒÕ“ƒ, $AëÆÁ«Ä„, $bÇö…†¶¹¼ = REPEAT_REPLACE) { $dÀÎ–²ÒËŒ =& $_SERVER[¬¦ã¾]; $fÛöƒğŠîç = $this->parse($AëÆÁ«Ä„); $cì¾öÔµÂ = $this->model->move($c‘äƒÕ“ƒ, $fÛöƒğŠîç[$dÀÎ–²ÒËŒ[393]], $bÇö…†¶¹¼, $fÛöƒğŠîç[$dÀÎ–²ÒËŒ[76]]); return $cì¾öÔµÂ ? $this->getPathOuter($cì¾öÔµÂ) : !1; } public function copy($FÈÎÉÓ®ó¬, $f‹Ü‡æœ„, $A×Âˆ„Ä‘Š = REPEAT_REPLACE) { $AŠÛÂïÇ¼ß = $this->parse($f‹Ü‡æœ„); $fÚÌ†±àù£ = $this->model->copy($FÈÎÉÓ®ó¬, $AŠÛÂïÇ¼ß[$_SERVER[¬¦ã¾][393]], $A×Âˆ„Ä‘Š); return $fÚÌ†±àù£ ? $this->getPathOuter($fÚÌ†±àù£) : !1; } public function moveSameAllow() { } public function move($F¼¥ãîÈ¾Š, $EºÊòëğÑ, $AïŠ‚ß–‘ = REPEAT_REPLACE) { $E”ááÍÉ˜˜ = $this->parse($EºÊòëğÑ); $cÆæÚ¿÷ƒÁ = $this->model->move($F¼¥ãîÈ¾Š, $E”ááÍÉ˜˜[$_SERVER[¬¦ã¾][393]], $AïŠ‚ß–‘); return $cÆæÚ¿÷ƒÁ ? $this->getPathOuter($cÆæÚ¿÷ƒÁ) : !1; } public function remove($C¸Ø‹×¬É‚, $Eæ–Ï’óá¿ = true) { return $this->model->remove($C¸Ø‹×¬É‚, $Eæ–Ï’óá¿); } public function rename($Cê‹œ´²’, $Díõ”ÇÚ ) { $dê‡„•“¨Ø = $this->model->rename($Cê‹œ´²’, $Díõ”ÇÚ ); return $dê‡„•“¨Ø ? $this->getPathOuter($Cê‹œ´²’) : $dê‡„•“¨Ø; } public function size($Bé†‚ßäâå) { $eóºù…áÏ = $this->infoSimple($Bé†‚ßäâå); return $eóºù…áÏ ? $eóºù…áÏ[$_SERVER[¬¦ã¾][78]] : 0; } public function infoSimple($c‹âÚÒÑ³÷) { return $this->model->sourceInfo($c‹âÚÒÑ³÷); } public function info($dÏÌî²´ù„) { return $this->infoParse($dÏÌî²´ù„); } public function infoAuth($f©Éµã¿Öâ) { return $this->infoParse($f©Éµã¿Öâ, !1, !0); } public function infoWithChildren($dêŠ¢„ËÇé) { return $this->infoParse($dêŠ¢„ËÇé, !0); } protected function infoParse($CØÑ‘·àÙ’, $bˆÂâ¸“• = false, $dÌ÷“…©Ò = false) { if (!$bˆÂâ¸“•) { return $this->model->pathInfo($CØÑ‘·àÙ’, $dÌ÷“…©Ò); } return $this->model->pathInfoMore($CØÑ‘·àÙ’); } public function infoFull($bÄ¾ÖË½£…) { $eîÆŠÄ½ôî =& $_SERVER[¬¦ã¾]; $eÆ«‘ëêŸ = explode($eîÆŠÄ½ôî[8], $bÄ¾ÖË½£…); $aè¼‚Ü‰Øô = implode($eîÆŠÄ½ôî[8], array_splice($eÆ«‘ëêŸ, 1)); return $this->model->pathInfoByPath($eÆ«‘ëêŸ[0], $aè¼‚Ü‰Øô); } public function hashSimple($e·’¬‘ØÄ) { $D²ì‘§¾Ï‰ =& $_SERVER[¬¦ã¾]; $f…ìš¡‹ê = $this->infoWithChildren($e·’¬‘ØÄ); return $f…ìš¡‹ê[$D²ì‘§¾Ï‰[164]][$D²ì‘§¾Ï‰[171]]; } public function hashMd5($AŠÈîÉÁ‹) { $E¾„¨‹Šº =& $_SERVER[¬¦ã¾]; $fì³†„ƒô = $this->infoWithChildren($AŠÈîÉÁ‹); return $fì³†„ƒô[$E¾„¨‹Šº[164]][$E¾„¨‹Šº[170]]; } public function exist($DßŸÄÉÁ„Á) { $CøŞ¢º«³ =& $_SERVER[¬¦ã¾]; $Eõ¾ª¾§¡ = $this->parse($DßŸÄÉÁ„Á); if (!$Eõ¾ª¾§¡[$CøŞ¢º«³[76]]) { return $this->isFile($DßŸÄÉÁ„Á) || $this->isFolder($DßŸÄÉÁ„Á); } $DŒ‘§Ö‰ì = array($CøŞ¢º«³[394] => $Eõ¾ª¾§¡[$CøŞ¢º«³[393]], $CøŞ¢º«³[28] => $Eõ¾ª¾§¡[$CøŞ¢º«³[76]]); $d¼†ÛĞ© = $this->model->where($DŒ‘§Ö‰ì)->find(); return $d¼†ÛĞ© ? !0 : !1; } public function isFile($DÀĞÈåèñ²) { $fØÚ‡Ò††ğ =& $_SERVER[¬¦ã¾]; $C‹ÎÅ­­É˜ = $this->infoSimple($DÀĞÈåèñ²); return $C‹ÎÅ­­É˜ && $C‹ÎÅ­­É˜[$fØÚ‡Ò††ğ[403]] == $fØÚ‡Ò††ğ[87] ? !1 : !0; } public function isFolder($eøà‡‹É¦ç) { $A÷¨¢Ì¬Ù“ =& $_SERVER[¬¦ã¾]; $dÁÓ‰¸ë¤÷ = $this->infoSimple($eøà‡‹É¦ç); return $dÁÓ‰¸ë¤÷ && $dÁÓ‰¸ë¤÷[$A÷¨¢Ì¬Ù“[403]] == $A÷¨¢Ì¬Ù“[87] ? !0 : !1; } public function listPath($fˆÜ‘©ƒªÓ, $BàªÈåä†„ = false) { $bàˆ™†ªÚê =& $_SERVER[¬¦ã¾]; if ($fˆÜ‘©ƒªÓ == $bàˆ™†ªÚê[33]) { return !1; } $BˆÁ°¦Çî‘ = array($bàˆ™†ªÚê[394] => $fˆÜ‘©ƒªÓ); if ($BàªÈåä†„) { return $this->model->listSource($BˆÁ°¦Çî‘, -1); } return $this->model->listSource($BˆÁ°¦Çî‘); } public function has($fÙË‹¶â­ã, $b±Š¾÷¡’í = false, $A°øİîÇĞ = null) { $A£…ç“©»Ğ =& $_SERVER[¬¦ã¾]; $A¸åŒõ•õ’ = $this->infoWithChildren($fÙË‹¶â­ã); if ($b±Š¾÷¡’í) { return array($A£…ç“©»Ğ[204] => $A¸åŒõ•õ’[$A£…ç“©»Ğ[204]], $A£…ç“©»Ğ[203] => $A¸åŒõ•õ’[$A£…ç“©»Ğ[203]]); } return $A°øİîÇĞ ? $A¸åŒõ•õ’[$A£…ç“©»Ğ[204]] : $A¸åŒõ•õ’[$A£…ç“©»Ğ[203]]; } public function listAll($F¤‡ÎÚµ) { $fê£â·ê† = IO::info($this->pathParse[$_SERVER[¬¦ã¾][76]]); if (!$fê£â·ê†) { return array(); } return $this->model->listAll($F¤‡ÎÚµ); } public function getContent($aì”¯°Æ³Ñ) { return $this->model->getContent($aì”¯°Æ³Ñ); } public function setContent($bô¦ÔÓÛƒ², $A¬Š£¹…Š½ = '') { return $this->model->setContent($bô¦ÔÓÛƒ², $A¬Š£¹…Š½); } public function fileSubstr($C¯™ÄòÍåŒ, $d–ŠÕí—ô, $B¡Œé‹ë­¢) { return $this->model->fileSubstr($C¯™ÄòÍåŒ, $d–ŠÕí—ô, $B¡Œé‹ë­¢); } public function download($F‹é„Œ¸Âº, $Céï¸ï…ÈÏ = '') { $aæ‹…œÌÍ = get_path_father($Céï¸ï…ÈÏ); $fêïÏ¦à = get_path_this($Céï¸ï…ÈÏ); $càùëîèÃ¼ = $this->model->fileInfoGet($F‹é„Œ¸Âº); $B®ÒºÓ“„§ = IO::copy($càùëîèÃ¼[$_SERVER[¬¦ã¾][76]], $aæ‹…œÌÍ, !1, $fêïÏ¦à); return $B®ÒºÓ“„§; } public function setModifyTime($aéá”Ü¹ì, $B¼ƒìë¼Ôô = '') { $dëøÔÙö =& $_SERVER[¬¦ã¾]; if (!$aéá”Ü¹ì) { return; } $this->model->where(array($dëøÔÙö[410] => $aéá”Ü¹ì))->save(array($dëøÔÙö[84] => $B¼ƒìë¼Ôô)); } public function upload($FÇğ¿÷ƒñì, $e¶ÄçŠ¼“Œ, $aªàİ¿ïÊí = false, $døŒ‚äš· = REPEAT_REPLACE) { $D³æ«¸¥Õ„ =& $_SERVER[¬¦ã¾]; $eÀåÃŒÊï = $this->parse($FÇğ¿÷ƒñì); $Eœ“ÈÏÈÆĞ = $this->model->addFile($eÀåÃŒÊï[$D³æ«¸¥Õ„[393]], $e¶ÄçŠ¼“Œ, $eÀåÃŒÊï[$D³æ«¸¥Õ„[76]], $aªàİ¿ïÊí, $døŒ‚äš·); return $this->getPathOuter($Eœ“ÈÏÈÆĞ); } public function uploadFileByID($Fƒ¯ÅƒÊ», $d¡àˆ±èã, $bÊ×“äª±‚) { $f¼øíğĞ¨ù =& $_SERVER[¬¦ã¾]; $Bäø¡ÃÄ† = $this->parse($Fƒ¯ÅƒÊ»); $F‡Æô„¤²¢ = $this->model->addFileByFileID($Bäø¡ÃÄ†[$f¼øíğĞ¨ù[393]], $d¡àˆ±èã, $Bäø¡ÃÄ†[$f¼øíğĞ¨ù[76]], $bÊ×“äª±‚); return $this->getPathOuter($F‡Æô„¤²¢); } public function addFileByRemote($C¼ÔÍ‰Êî÷, $b˜×æ¸Œöì, $d¼Åä›ÆÌğ = array(), $E£×¡ÅŠØ£ = '', $BğâïÜ¹À) { $f‰…ğÖ¶ì© =& $_SERVER[¬¦ã¾]; $fš´µ‹ÇÔè = $this->parse($C¼ÔÍ‰Êî÷); $E£×¡ÅŠØ£ = empty($E£×¡ÅŠØ£) ? $fš´µ‹ÇÔè[$f‰…ğÖ¶ì©[76]] : $E£×¡ÅŠØ£; $Aæœ’“åÈ“ = $this->model->addFileByRemote($fš´µ‹ÇÔè[$f‰…ğÖ¶ì©[393]], $b˜×æ¸Œöì, $E£×¡ÅŠØ£, $d¼Åä›ÆÌğ, $BğâïÜ¹À); return $this->getPathOuter($Aæœ’“åÈ“); } public function uploadLink($bù‰œ°êÔÏ, $Dë¡Û‹Ëêš = 0) { $Eàƒ›ÁÉİ =& $_SERVER[¬¦ã¾]; $bÙ†ĞÌÇÑÉ = $this->parse($bù‰œ°êÔÏ); $cÅ¬İµ³Óñ = _get($GLOBALS[$Eàƒ›ÁÉİ[7]], $Eàƒ›ÁÉİ[1199]); $bÇÍ§õ¨ = _get($GLOBALS[$Eàƒ›ÁÉİ[7]], $Eàƒ›ÁÉİ[1200]); $bù‰œ°êÔÏ = Model($Eàƒ›ÁÉİ[571])->createFileName($bÙ†ĞÌÇÑÉ[$Eàƒ›ÁÉİ[76]], $cÅ¬İµ³Óñ, $bÇÍ§õ¨); return IO::uploadLink($bù‰œ°êÔÏ, $Dë¡Û‹Ëêš); } public function fileNameAuto($cù¬æ« ËØ, $bà©²¼Ü£À, $EÏ¥Ö çƒÓ = REPEAT_REPLACE, $B®ˆîÜğ›Ò = false) { return $this->model->fileNameAuto($cù¬æ« ËØ, $bà©²¼Ü£À, $EÏ¥Ö çƒÓ, $B®ˆîÜğ›Ò); } public function fileNameExist($CÈ‚„Ò¾ñ˜, $F×§«¥ò) { return $this->model->fileNameExist($CÈ‚„Ò¾ñ˜, $F×§«¥ò); } protected function _fileOut($A×ŠŠ–­º, $fãÎ²áÚæ‚ = false, $BˆØ—ÛÃÆ = false, $bù³À‚±¶– = '', $f¬ÜœÏÏ×¸ = false) { goto fŒÌÄÕ´³‰; aÖªâ”Ò…: if ($f¬ÜœÏÏ×¸) { return IO::fileOutServer($CåèĞè“™‡[$e•øÇÂ´–Ç[76]], $fãÎ²áÚæ‚, $f®ÍĞÑé„â, $bù³À‚±¶–); } IO::fileOut($CåèĞè“™‡[$e•øÇÂ´–Ç[76]], $fãÎ²áÚæ‚, $f®ÍĞÑé„â, $bù³À‚±¶–); goto cÃ§ÔéË…”; fŒÌÄÕ´³‰: $e•øÇÂ´–Ç =& $_SERVER[¬¦ã¾]; $D´Éİªà†Ì = $this->model->sourceInfo($A×ŠŠ–­º); if ($D´Éİªà†Ì[$e•øÇÂ´–Ç[403]] == $e•øÇÂ´–Ç[87]) { header($e•øÇÂ´–Ç[1201]); die; } goto Aè¿ÌÒ×ÜŠ; Aè¿ÌÒ×ÜŠ: $CåèĞè“™‡ = $this->model->fileInfoGet($A×ŠŠ–­º); $bù³À‚±¶– = $CåèĞè“™‡[$e•øÇÂ´–Ç[170]] ? $CåèĞè“™‡[$e•øÇÂ´–Ç[170]] : $bù³À‚±¶–; $f®ÍĞÑé„â = isset($GLOBALS[$e•øÇÂ´–Ç[1202]]) ? $GLOBALS[$e•øÇÂ´–Ç[1202]] : $D´Éİªà†Ì[$e•øÇÂ´–Ç[28]]; goto aÖªâ”Ò…; cÃ§ÔéË…”: } public function fileOut($bØ™™Ä•Ù©, $d„âôóÒŞŸ = false, $BÖ†©æÆ‰Ì = false, $AÕäŒ¼ò”ä = '') { $this->_fileOut($bØ™™Ä•Ù©, $d„âôóÒŞŸ, $BÖ†©æÆ‰Ì, $AÕäŒ¼ò”ä); } public function fileOutServer($CáùÈçî™£, $aŸ‘£ÅƒõÑ = false, $E²ó‘ğÕŞ = false, $Cª„¯£Øç¦ = '') { $this->_fileOut($CáùÈçî™£, $aŸ‘£ÅƒõÑ, $E²ó‘ğÕŞ, $Cª„¯£Øç¦, !0); } protected function _fileOutImage($f…İ‚« ¨, $a›“ŒĞÄˆ† = 250) { goto bìÇ…â¶ˆ”; bìÇ…â¶ˆ”: $dÜ§ÎåŞê =& $_SERVER[¬¦ã¾]; $fÚ¼Ëô‰ó› = $this->model->pathInfo($f…İ‚« ¨); if ($fÚ¼Ëô‰ó›[$dÜ§ÎåŞê[403]] == $dÜ§ÎåŞê[87]) { show_json($dÜ§ÎåŞê[1203] . $f…İ‚« ¨, !1); } goto d›†‹îò†›; d›†‹îò†›: $a©’Ê²Ô»Î = $this->model->fileInfoGet($f…İ‚« ¨); $a©’Ê²Ô»Î[$dÜ§ÎåŞê[28]] = $fÚ¼Ëô‰ó›[$dÜ§ÎåŞê[28]]; $a©’Ê²Ô»Î[$dÜ§ÎåŞê[163]] = $fÚ¼Ëô‰ó›[$dÜ§ÎåŞê[163]]; goto f¤ˆ¡ä˜ºà; f¤ˆ¡ä˜ºà: $GLOBALS[$dÜ§ÎåŞê[1202]] = $a©’Ê²Ô»Î[$dÜ§ÎåŞê[28]]; $GLOBALS[$dÜ§ÎåŞê[162]] = $a©’Ê²Ô»Î; IO::fileOutImage($a©’Ê²Ô»Î[$dÜ§ÎåŞê[76]], $a›“ŒĞÄˆ†); goto dâï………õÔ; dâï………õÔ: } public function fileOutImage($f¦®™›šÏç, $c‰àÙø  ª = 250) { $this->_fileOutImage($f¦®™›šÏç, $c‰àÙø  ª); } public function fileOutImageServer($BšÄø‡áÃ, $A¶â¶ƒ…¾Ô = 250) { $this->_fileOutImage($BšÄø‡áÃ, $A¶â¶ƒ…¾Ô); } public function link($A²±ª¦š’§, $eôòÍÄíÒâ = '') { $b˜Ğ‚²ö = $this->model->fileInfoGet($A²±ª¦š’§); return IO::link($b˜Ğ‚²ö[$_SERVER[¬¦ã¾][76]], $eôòÍÄíÒâ); } protected function parse($aóåµçóëÁ) { $EÜ­Æ—àŒõ =& $_SERVER[¬¦ã¾]; if (strstr($aóåµçóëÁ, $EÜ­Æ—àŒõ[8]) === !1) { return array($EÜ­Æ—àŒõ[412] => intval($aóåµçóëÁ), $EÜ­Æ—àŒõ[76] => $EÜ­Æ—àŒõ[33], $EÜ­Æ—àŒõ[1198] => array()); } $EåöåàÄÈ = explode($EÜ­Æ—àŒõ[8], trim($aóåµçóëÁ, $EÜ­Æ—àŒõ[8])); if (count($EåöåàÄÈ) < 2) { show_tips($aóåµçóëÁ . $EÜ­Æ—àŒõ[1204]); } return array($EÜ­Æ—àŒõ[412] => intval($EåöåàÄÈ[0]), $EÜ­Æ—àŒõ[76] => $EåöåàÄÈ[1], $EÜ­Æ—àŒõ[1198] => array_slice($EåöåàÄÈ, 1)); } } class PathDriverDbShareItem extends PathDriverDB { public function __construct($a‹¶œ½¤Ó½) { $this->pathParse = $a‹¶œ½¤Ó½; $this->model = Model($_SERVER[¬¦ã¾][1197]); } public function getPathOuter($BİÁº¨šá„) { $C”Ü•­®Íõ =& $_SERVER[¬¦ã¾]; if (!$BİÁº¨šá„) { return $BİÁº¨šá„; } $DªêÒƒ¹×£ = $this->parse($BİÁº¨šá„); return trim(KodIO::makeShare($this->pathParse[$C”Ü•­®Íõ[393]], $DªêÒƒ¹×£[$C”Ü•­®Íõ[393]]), $C”Ü•­®Íõ[8]); } protected function infoParse($b¿ƒ’ÅêÀ, $dÒ­¡‘Ü’ = false, $FŠÊì÷¡‚Ë = false) { $E±•‹Ô×ˆÜ =& $_SERVER[¬¦ã¾]; $A ¬É²Ÿğ‘ = $this->pathParse[$E±•‹Ô×ˆÜ[393]]; $c­º¡Ôôšï = trim($this->pathParse[$E±•‹Ô×ˆÜ[1055]], $E±•‹Ô×ˆÜ[8]); return Action($E±•‹Ô×ˆÜ[1205])->sharePathInfo($A ¬É²Ÿğ‘, $c­º¡Ôôšï); } public function infoFull($DÁîø«¿áä) { $a¢Ê¿İŞô  =& $_SERVER[¬¦ã¾]; $F„…õìõ = explode($a¢Ê¿İŞô [8], trim($DÁîø«¿áä, $a¢Ê¿İŞô [8])); if (count($F„…õìõ) > 1) { $FØÑ¯Ï•¶… = implode($a¢Ê¿İŞô [8], array_splice($F„…õìõ, 1)); $fñïäÉ¯Å = $this->model->pathInfoByPath($F„…õìõ[0], $FØÑ¯Ï•¶…); if (!$fñïäÉ¯Å) { return !1; } $this->pathParse[$a¢Ê¿İŞô [1055]] = $fñïäÉ¯Å[$a¢Ê¿İŞô [395]]; } return $this->infoParse($DÁîø«¿áä); } public function listAll($dª±Áï³¥) { goto eÈÊ—õ‹ÑÉ; eÈÊ—õ‹ÑÉ: $bËéØÛ˜ =& $_SERVER[¬¦ã¾]; $aÕ¼Å¶š† = IO::info($this->pathParse[$bËéØÛ˜[76]]); if (!$aÕ¼Å¶š†) { return array(); } goto bš™°Ô»Ò”; Fß¾Œ†Ü©: foreach ($eÕ¹Ôò§åñ as &$A·‘´ğóÙ§) { check_abort(); $A·‘´ğóÙ§[$bËéØÛ˜[85]] = $Cğ¯Ÿª†Ğ‘->_shareItemeParse($A·‘´ğóÙ§[$bËéØÛ˜[85]], $e¼çòçÖ); } unset($A·‘´ğóÙ§); return $eÕ¹Ôò§åñ; goto dç›Èò»™Ì; bš™°Ô»Ò”: $eÕ¹Ôò§åñ = $this->model->listAll($dª±Áï³¥); $e¼çòçÖ = Model($bËéØÛ˜[563])->getInfo($aÕ¼Å¶š†[$bËéØÛ˜[468]]); $Cğ¯Ÿª†Ğ‘ = Action($bËéØÛ˜[1205]); goto Fß¾Œ†Ü©; dç›Èò»™Ì: } } class PathDriverDbShareLink extends PathDriverDB { public function __construct($Cšï×„Û‰) { $this->pathParse = $Cšï×„Û‰; $this->model = Model($_SERVER[¬¦ã¾][1197]); } protected function infoParse($Eâ‚óŞ¥•›, $F÷šÒµ¦† = false, $AÁİŠ¼ßÍ = false) { $CºÎ“„´µ =& $_SERVER[¬¦ã¾]; return Action($CºÎ“„´µ[1061])->sharePathInfo($this->pathParse[$CºÎ“„´µ[76]], !0); } public function listPath($aÜ÷Ûå½æ, $c¯…ƒ×Êœµ = false) { $b’¹‘ÂöÔè =& $_SERVER[¬¦ã¾]; $E‚¤×¶ò„‹ = parent::listPath($aÜ÷Ûå½æ, $c¯…ƒ×Êœµ); foreach ($E‚¤×¶ò„‹ as $EœÆ÷øîÍó => $eÜÙğ¡Èë) { if (!in_array($EœÆ÷øîÍó, array($b’¹‘ÂöÔè[74], $b’¹‘ÂöÔè[75]))) { continue; } foreach ($eÜÙğ¡Èë as $CÀˆ·ÖôĞ => $dœÂ‹¢ìÍ¯) { $E‚¤×¶ò„‹[$EœÆ÷øîÍó][$CÀˆ·ÖôĞ] = Action($b’¹‘ÂöÔè[1061])->shareItemInfo($dœÂ‹¢ìÍ¯); } } return $E‚¤×¶ò„‹; } public function listAll($B”ßóø˜Æœ) { goto B¢šÏÙ´ò¿; bœ—¶ƒƒ±: $cõ‰ŒéšøÊ = $this->model->listAll($B”ßóø˜Æœ); foreach ($cõ‰ŒéšøÊ as &$eâ‚’½äŞ) { $eâ‚’½äŞ[$fÙªµ©Ò‡[85]] = Action($fÙªµ©Ò‡[1061])->shareItemInfo($eâ‚’½äŞ[$fÙªµ©Ò‡[85]]); } unset($eâ‚’½äŞ); goto ašˆ¨Áà„; ašˆ¨Áà„: return $cõ‰ŒéšøÊ; goto EŞğå°ÊùÈ; B¢šÏÙ´ò¿: $fÙªµ©Ò‡ =& $_SERVER[¬¦ã¾]; $E»¶õÁÙê˜ = IO::info($this->pathParse[$fÙªµ©Ò‡[76]]); if (!$E»¶õÁÙê˜) { return array(); } goto bœ—¶ƒƒ±; EŞğå°ÊùÈ: } } goto e÷À¼ùÙ›; D±‘Ê„ƒÈÉ: class PathDriverBase { public $pathDriver = ''; public $pathBase = ''; public $path = ''; public $pathID = ''; public function __construct() { $Fòº¢·à±° =& $_SERVER[¬¦ã¾]; $this->objectDriver = array($Fòº¢·à±°[57], $Fòº¢·à±°[58], $Fòº¢·à±°[59], $Fòº¢·à±°[60], $Fòº¢·à±°[61], $Fòº¢·à±°[62], $Fòº¢·à±°[63], $Fòº¢·à±°[64], $Fòº¢·à±°[65]); $this->_classObjectID = mt_rand(0, 10000); } public function getPath($bßß³äÅŠ¤) { if (in_array($this->getType(), $this->objectDriver)) { return ltrim($bßß³äÅŠ¤, $_SERVER[¬¦ã¾][8]); } return $bßß³äÅŠ¤; } public function iconvApp($f¶­èá™¨í) { return $f¶­èá™¨í; } public function iconvSystem($A®Æ²äç¸Ó) { return $A®Æ²äç¸Ó; } public function iconvTo($dğÄ«î¦ò, $añù•ÅŒ„ï, $cì¸Ó®Ğ‹†) { goto a®¾ “•õ; A¬È‹œ¾†°: $A¶æçô‘Òğ[$cì¸Ó®Ğ‹† . $aİõ±Ûßºã[67] . $añù•ÅŒ„ï . $aİõ±Ûßºã[68] . $dğÄ«î¦ò] = $dğÄ«î¦ò; $A¶æçô‘Òğ[$cì¸Ó®Ğ‹† . $aİõ±Ûßºã[67] . $añù•ÅŒ„ï . $aİõ±Ûßºã[68] . $Dï‡âà¼ÏŸ] = $dğÄ«î¦ò; $A¶æçô‘Òğ[$añù•ÅŒ„ï . $aİõ±Ûßºã[67] . $cì¸Ó®Ğ‹† . $aİõ±Ûßºã[68] . $Dï‡âà¼ÏŸ] = $Dï‡âà¼ÏŸ; goto cÄó·‡ñâ; cÄó·‡ñâ: return $Dï‡âà¼ÏŸ; goto D™ÀèóÉÕš; aÚ–©Úğ¢À: $f›Ø…­ÆŠ = $añù•ÅŒ„ï . $aİõ±Ûßºã[67] . $cì¸Ó®Ğ‹† . $aİõ±Ûßºã[68] . $dğÄ«î¦ò; if (isset($A¶æçô‘Òğ[$f›Ø…­ÆŠ])) { return $A¶æçô‘Òğ[$f›Ø…­ÆŠ]; } if (function_exists($aİõ±Ûßºã[69])) { $Dï‡âà¼ÏŸ = @mb_convert_encoding($dğÄ«î¦ò, $cì¸Ó®Ğ‹†, $añù•ÅŒ„ï); } else { $Dï‡âà¼ÏŸ = @iconv($añù•ÅŒ„ï, $cì¸Ó®Ğ‹†, $dğÄ«î¦ò); } goto C£×èªˆä¸; a®¾ “•õ: $aİõ±Ûßºã =& $_SERVER[¬¦ã¾]; if (!$dğÄ«î¦ò || !function_exists($aİõ±Ûßºã[66])) { return $dğÄ«î¦ò; } static $A¶æçô‘Òğ = array(); goto aÚ–©Úğ¢À; C£×èªˆä¸: $Dï‡âà¼ÏŸ = $Dï‡âà¼ÏŸ ? $Dï‡âà¼ÏŸ : $dğÄ«î¦ò; if (strstr($Dï‡âà¼ÏŸ, $aİõ±Ûßºã[70])) { $Dï‡âà¼ÏŸ = str_replace($aİõ±Ûßºã[70], $aİõ±Ûßºã[71], $Dï‡âà¼ÏŸ); } $A¶æçô‘Òğ[$añù•ÅŒ„ï . $aİõ±Ûßºã[67] . $cì¸Ó®Ğ‹† . $aİõ±Ûßºã[68] . $dğÄ«î¦ò] = $Dï‡âà¼ÏŸ; goto A¬È‹œ¾†°; D™ÀèóÉÕš: } public function getPathInner($Aã­Ô¤²) { $cÑİğ­é•ç = IO::init($Aã­Ô¤²); return $cÑİğ­é•ç->path; } public function getPathOuter($bìÙàğÑÂ‰) { $F«¯œğ‘¹Ã =& $_SERVER[¬¦ã¾]; $D­½šÏ–š­ = strlen(trim($this->pathBase, $F«¯œğ‘¹Ã[8])); $bìÙàğÑÂ‰ = substr(trim($bìÙàğÑÂ‰, $F«¯œğ‘¹Ã[8]), $D­½šÏ–š­); return $this->pathDriver . $F«¯œğ‘¹Ã[8] . ltrim($bìÙàğÑÂ‰, $F«¯œğ‘¹Ã[8]); } public function isParentOf($EºŠ†¦´­Ò, $e‰‹İÆù®ì) { $dîÅ¿‚×× =& $_SERVER[¬¦ã¾]; $EºŠ†¦´­Ò = rtrim(strtolower($EºŠ†¦´­Ò), $dîÅ¿‚××[8]) . $dîÅ¿‚××[8]; $e‰‹İÆù®ì = rtrim(strtolower($e‰‹İÆù®ì), $dîÅ¿‚××[8]) . $dîÅ¿‚××[8]; $dŒ´è†Õáí = strpos($e‰‹İÆù®ì, $EºŠ†¦´­Ò) === 0; return $dŒ´è†Õáí; } public function getType() { $dŠÌ–µ™Ÿ =& $_SERVER[¬¦ã¾]; $F±èš¸¡ä = str_replace($dŠÌ–µ™Ÿ[72], $dŠÌ–µ™Ÿ[33], get_class($this)); return strtolower($F±èš¸¡ä); } public function isTypeObject() { if (!is_array($this->objectDriver)) { return !1; } return in_array($this->getType(), $this->objectDriver); } public function fileNameExist($f÷‘ĞñÈ‘, $aÎÍìÅì»÷) { $EÄùçÄ‰‡ =& $_SERVER[¬¦ã¾]; $C¥àéï¶Á  = rtrim($f÷‘ĞñÈ‘, $EÄùçÄ‰‡[8]) . $EÄùçÄ‰‡[8] . $aÎÍìÅì»÷; $Fš±À®áÈ = $this->exist($C¥àéï¶Á ); return $Fš±À®áÈ ? $C¥àéï¶Á  : !1; } public function setModifyTime($bØ„¦§Å¬, $EÛƒ®æÈ¾ = '') { } public function renameObject($f¬¤Ôøà“¼, $A´›Ëæ¿™) { goto AÃÆÇˆíá¥; d‰ª‚ˆã…: $f¬¤Ôøà“¼ = $this->getPathOuter($f¬¤Ôøà“¼); $A´›Ëæ¿™ = $this->pathFather($f¬¤Ôøà“¼) . $A´›Ëæ¿™; if (IO::isFile($f¬¤Ôøà“¼)) { $d‰«±¼§À = IO::copy($f¬¤Ôøà“¼, $this->pathFather($f¬¤Ôøà“¼), REPEAT_RENAME_FOLDER, $F§ª­Ïœ); if ($d‰«±¼§À) { IO::remove($f¬¤Ôøà“¼); } } else { $d‰«±¼§À = IO::mkdir($A´›Ëæ¿™); if (!$d‰«±¼§À) { return !1; } $DšøªÜ®÷ = IO::listPath($f¬¤Ôøà“¼, !0); $d†ÃŸ—½Ä¨ = array_merge($DšøªÜ®÷[$cí± °™Ï[74]], $DšøªÜ®÷[$cí± °™Ï[75]]); foreach ($d†ÃŸ—½Ä¨ as $C™â¢ºˆ) { IO::move($C™â¢ºˆ[$cí± °™Ï[76]], $A´›Ëæ¿™, REPEAT_RENAME_FOLDER); } IO::remove($f¬¤Ôøà“¼); } goto fÔèÍØ›‡Ÿ; AÃÆÇˆíá¥: $cí± °™Ï =& $_SERVER[¬¦ã¾]; $F§ª­Ïœ = $A´›Ëæ¿™; Hook::trigger($cí± °™Ï[73], $this, $f¬¤Ôøà“¼, $this, $this->pathFather($f¬¤Ôøà“¼) . $A´›Ëæ¿™); goto d‰ª‚ˆã…; fÔèÍØ›‡Ÿ: return $d‰«±¼§À ? $A´›Ëæ¿™ : !1; goto f¿²‘ß„¢; f¿²‘ß„¢: } public function tempFile($Bö¢¿ÙôæÆ = '', $dª››£×Ù = '') { goto A²«§Œ•˜Î; C‘ÔÇ£ËŞµ: return $C°’ñâŒ®; goto FÆœ«šÚ·†; A²«§Œ•˜Î: if (!$Bö¢¿ÙôæÆ) { $Bö¢¿ÙôæÆ = rand_string(15); } $AŞÕÕàéÏ = TEMP_FILES . rand_string(15) . $_SERVER[¬¦ã¾][8]; @mkdir($AŞÕÕàéÏ, 511, !0); goto b…‘‰­Ÿóƒ; b…‘‰­Ÿóƒ: $C°’ñâŒ® = $AŞÕÕàéÏ . $Bö¢¿ÙôæÆ; @touch($C°’ñâŒ®); if ($dª››£×Ù) { file_put_contents($C°’ñâŒ®, $dª››£×Ù); } goto C‘ÔÇ£ËŞµ; FÆœ«šÚ·†: } public function tempFileRemve($eŒ“íÒÔãá) { @unlink($eŒ“íÒÔãá); @rmdir($this->pathFather($eŒ“íÒÔãá)); } public function mkfile($bÜ°âö¡±, $f¿ëÏ¥ºå¹ = '', $C„¹º¢‚® = REPEAT_RENAME) { } public function mkdir($FßçÒ¸‡Œ÷, $d©‘–ÌÙ· = REPEAT_SKIP) { } public function delFile($E•øêˆó×) { } public function delFolder($Bµ»ñó³ê) { } public function copyFile($e™¦Ù¿¥„‡, $fÛÚø‚®“¼) { } public function moveFile($EÆ’§ƒìÄ, $E³çƒ¦ß) { } public function remove($eáª¥äšØ) { if ($this->isFile($eáª¥äšØ)) { return $this->delFile($eáª¥äšØ); } return $this->delFolder($eáª¥äšØ); } public function rename($A¶ô”îÀŸò, $DÚè¥‡®) { } public function exist($a¸â—¡„ñÃ) { } public function findByHash($cò•Ğ¤‰Ê = '', $D‰„‹Î½ëö = '') { return !1; } public function isFile($b„ÑáÍù‚) { } public function isFolder($D‰¡¯˜ÒÂá) { } public function size($DõÍì†ï¨­) { } public function info($bÒÃƒóäÄÀ) { } public function infoSimple($E®ãï¸¨ê) { return $this->info($E®ãï¸¨ê); } public function infoAuth($E¬ºåê›çÔ) { return $this->info($E¬ºåê›çÔ); } public function infoFull($cÅÊİ±›á) { return $this->info($cÅÊİ±›á); } public function infoWithChildren($fË£¸Ô‹Œ“) { $B¤ƒçÈçÃí =& $_SERVER[¬¦ã¾]; static $eñ“Ô»„ƒß = array(); if (isset($eñ“Ô»„ƒß[$fË£¸Ô‹Œ“])) { return $eñ“Ô»„ƒß[$fË£¸Ô‹Œ“]; } $F“ª‘‚ŠÜé = $this->info($fË£¸Ô‹Œ“); if ($F“ª‘‚ŠÜé && $F“ª‘‚ŠÜé[$B¤ƒçÈçÃí[29]] == $B¤ƒçÈçÃí[77]) { $bËµ¤ÈË° = array($B¤ƒçÈçÃí[78] => 0, $B¤ƒçÈçÃí[79] => 0, $B¤ƒçÈçÃí[80] => 0); $this->infoChildren($fË£¸Ô‹Œ“, $bËµ¤ÈË°); $F“ª‘‚ŠÜé[$B¤ƒçÈçÃí[78]] = $bËµ¤ÈË°[$B¤ƒçÈçÃí[78]]; $F“ª‘‚ŠÜé[$B¤ƒçÈçÃí[81]] = array($B¤ƒçÈçÃí[82] => $bËµ¤ÈË°[$B¤ƒçÈçÃí[79]], $B¤ƒçÈçÃí[83] => $bËµ¤ÈË°[$B¤ƒçÈçÃí[80]]); $eñ“Ô»„ƒß[$fË£¸Ô‹Œ“] = $F“ª‘‚ŠÜé; } return $F“ª‘‚ŠÜé; } public function listPath($Aß„À’ ×, $fÂ‹Èç›È¸ = false) { } public function has($fà»‘øˆ¯•, $cµÙÎ­·ë = false, $dµÒ‚¤ÏÖ = false) { } public function canRead($f£ª¦Ä¦ˆ) { } public function canWrite($AçÑŒòõ) { } public function getContent($aˆ¿¯é¼ê¹) { } public function setContent($D¯¼èï©–Õ, $A ºµ—ò = '') { } protected function infoChildren($f•·³±÷ƒ, &$bŠ´½Í´µŸ) { $A‹‘‘©«¯î =& $_SERVER[¬¦ã¾]; check_abort_echo(); $A²‡’§ä‰Ê = $this->listPath($f•·³±÷ƒ, !0); $A²‡’§ä‰Ê = array_merge($A²‡’§ä‰Ê[$A‹‘‘©«¯î[75]], $A²‡’§ä‰Ê[$A‹‘‘©«¯î[74]]); foreach ($A²‡’§ä‰Ê as $B´’ ‡‰‡) { if ($B´’ ‡‰‡[$A‹‘‘©«¯î[29]] == $A‹‘‘©«¯î[77]) { $bŠ´½Í´µŸ[$A‹‘‘©«¯î[80]]++; $aŸî¸÷Î‡´ = $this->getPathInner($B´’ ‡‰‡[$A‹‘‘©«¯î[76]]); $this->infoChildren($aŸî¸÷Î‡´, $bŠ´½Í´µŸ); } else { $bŠ´½Í´µŸ[$A‹‘‘©«¯î[79]]++; $bŠ´½Í´µŸ[$A‹‘‘©«¯î[78]] += $B´’ ‡‰‡[$A‹‘‘©«¯î[78]]; } } } public function fileSubstr($b¥„¯ù‰®, $fÁÎâì”Ë, $dîÚí—¢ŞÛ) { } public function listAll($CĞ»®Äèñ¼) { } public function listAllMake($BóŒÈŒ¡Ê, &$E´£‘‚¥Ï†) { $bñ´Ô½é =& $_SERVER[¬¦ã¾]; check_abort_echo(); $Cª‰ŒËñ¹– = $this->listPath($BóŒÈŒ¡Ê, !0); if (!$Cª‰ŒËñ¹–) { return; } $B³Ÿ¹í½ã = array_merge($Cª‰ŒËñ¹–[$bñ´Ô½é[75]], $Cª‰ŒËñ¹–[$bñ´Ô½é[74]]); foreach ($B³Ÿ¹í½ã as $D‡ŞÂÏßà) { goto CˆœîğÇÖµ; E»ã¥Í‚†í: $this->listAllMake($D‡ŞÂÏßà[$bñ´Ô½é[76]], $E´£‘‚¥Ï†); goto BèÁÕè¨š; cŒÅÇÈÎ¡š: if (isset($D‡ŞÂÏßà[$bñ´Ô½é[84]])) { $e‹„å½®¯¦[$bñ´Ô½é[84]] = $D‡ŞÂÏßà[$bñ´Ô½é[84]]; } if (!$d·øãà¬‰ê) { $E´£‘‚¥Ï†[] = $e‹„å½®¯¦; continue; } $E´£‘‚¥Ï†[] = $e‹„å½®¯¦; goto E»ã¥Í‚†í; CˆœîğÇÖµ: $d·øãà¬‰ê = $D‡ŞÂÏßà[$bñ´Ô½é[29]] == $bñ´Ô½é[77]; $e‹„å½®¯¦ = array($bñ´Ô½é[76] => $D‡ŞÂÏßà[$bñ´Ô½é[76]], $bñ´Ô½é[77] => $d·øãà¬‰ê); if (isset($D‡ŞÂÏßà[$bñ´Ô½é[78]])) { $e‹„å½®¯¦[$bñ´Ô½é[78]] = $D‡ŞÂÏßà[$bñ´Ô½é[78]]; } goto cŒÅÇÈÎ¡š; BèÁÕè¨š: } } public function listAllSimple($fˆ©¼ì³êô) { $Eƒ‰İÄÊ§ø =& $_SERVER[¬¦ã¾]; $DÍÆË©Å§“ = array(); $E£ê ¶Û¤ = $this->listAll($fˆ©¼ì³êô); $e´â†é‘“ß = $this->getPathOuter($fˆ©¼ì³êô); foreach ($E£ê ¶Û¤ as $C§¼Å¦Ê) { goto BÑÔ“èø¬ì; f³Áñù“Šƒ: if (!$C§¼Å¦Ê[$Eƒ‰İÄÊ§ø[77]]) { $D‚ØÖ’¢ÚÕ[$Eƒ‰İÄÊ§ø[86]] = $F‚ç¯È™‡§; } $DÍÆË©Å§“[] = $D‚ØÖ’¢ÚÕ; goto BÒæ—Ñ…¬; B¿®ïÄã‹: $D‚ØÖ’¢ÚÕ = array($Eƒ‰İÄÊ§ø[76] => $aÄÁ© ”‹, $Eƒ‰İÄÊ§ø[77] => $C§¼Å¦Ê[$Eƒ‰İÄÊ§ø[77]]); if (isset($C§¼Å¦Ê[$Eƒ‰İÄÊ§ø[78]]) && !$C§¼Å¦Ê[$Eƒ‰İÄÊ§ø[77]]) { $D‚ØÖ’¢ÚÕ[$Eƒ‰İÄÊ§ø[78]] = $C§¼Å¦Ê[$Eƒ‰İÄÊ§ø[78]]; } if (isset($C§¼Å¦Ê[$Eƒ‰İÄÊ§ø[84]])) { $D‚ØÖ’¢ÚÕ[$Eƒ‰İÄÊ§ø[84]] = $C§¼Å¦Ê[$Eƒ‰İÄÊ§ø[84]]; } goto f³Áñù“Šƒ; BÑÔ“èø¬ì: $F‚ç¯È™‡§ = $C§¼Å¦Ê[$Eƒ‰İÄÊ§ø[76]]; $aÄÁ© ”‹ = $C§¼Å¦Ê[$Eƒ‰İÄÊ§ø[76]]; if (isset($C§¼Å¦Ê[$Eƒ‰İÄÊ§ø[85]])) { $F‚ç¯È™‡§ = $C§¼Å¦Ê[$Eƒ‰İÄÊ§ø[85]][$Eƒ‰İÄÊ§ø[76]]; $C§¼Å¦Ê[$Eƒ‰İÄÊ§ø[78]] = $C§¼Å¦Ê[$Eƒ‰İÄÊ§ø[85]][$Eƒ‰İÄÊ§ø[78]]; $C§¼Å¦Ê[$Eƒ‰İÄÊ§ø[84]] = $C§¼Å¦Ê[$Eƒ‰İÄÊ§ø[85]][$Eƒ‰İÄÊ§ø[84]]; } else { $aÄÁ© ”‹ = substr($C§¼Å¦Ê[$Eƒ‰İÄÊ§ø[76]], strlen(get_path_father($e´â†é‘“ß))); $aÄÁ© ”‹ = $Eƒ‰İÄÊ§ø[8] . ltrim($aÄÁ© ”‹, $Eƒ‰İÄÊ§ø[8]); } goto B¿®ïÄã‹; BÒæ—Ñ…¬: } return $DÍÆË©Å§“; } public function upload($f¤…â¸ğÖï, $B²‚¦§Òë, $dÏÏºéÛ¯´ = false, $E©§¸ƒ· = REPEAT_REPLACE) { } public function uploadFileByID($AŒæˆõÇ‚, $E“‡è¹Ãñ´, $a’µÂÕÍ°¦) { } public function uploadFileByPath($A‰ÆÏïÙğ—, $A»–šëƒ­‘, $AÎºóòÙ…˜ = array()) { } public function isUploadServer() { $ašæ¿Úã¤÷ =& $_SERVER[¬¦ã¾]; if (isset($this->ioUploadServer) && $this->ioUploadServer == $ašæ¿Úã¤÷[87]) { return !0; } return $GLOBALS[$ašæ¿Úã¤÷[6]][$ašæ¿Úã¤÷[88]][$ašæ¿Úã¤÷[89]]; } public function isFileOutServer() { $A¢ÀñÕ²œ =& $_SERVER[¬¦ã¾]; if (isset($this->ioFileOutServer) && $this->ioFileOutServer == $A¢ÀñÕ²œ[87]) { return !0; } return $GLOBALS[$A¢ÀñÕ²œ[6]][$A¢ÀñÕ²œ[88]][$A¢ÀñÕ²œ[90]]; } public function isCdnHost() { return $this->isFileOutServer() || empty($this->cdnHost) ? !1 : !0; } public function getCdnLink($bœ‡‹Ä‰ï½) { $D‹áì—Û’ =& $_SERVER[¬¦ã¾]; if (!$this->isCdnHost()) { return $bœ‡‹Ä‰ï½; } return str_replace(trim(get_url_root($bœ‡‹Ä‰ï½), $D‹áì—Û’[8]), trim($this->cdnHost, $D‹áì—Û’[8]), $bœ‡‹Ä‰ï½); } public function uploadLink($F…Õ‰çÆÁ, $cµ¨£‰Ôí = 0) { goto F›Ëïˆ; A†äŠÌ¦õå: $BñØâÜøªÒ = $cµ¨£‰Ôí <= $Añ‡‚‰ïÀ ? $e°¸‰…½Õ[91] : $e°¸‰…½Õ[92]; $DŠÍ‡¨â­Ÿ = (!$cµ¨£‰Ôí ? 1 : ceil($cµ¨£‰Ôí / pow(1024, 3))) * 3600 * 4; $FíšîŠÒ  = $this->{$BñØâÜøªÒ}($F…Õ‰çÆÁ, $DŠÍ‡¨â­Ÿ); goto aÂì†‘ì—; cõƒ¶¹Ü«ñ: if (!in_array($BÒÎí©¶×Ç, $this->objectDriver)) { return; } if (!$this->isBucketCors()) { return; } $Añ‡‚‰ïÀ = 1024 * 1024 * 10; goto A†äŠÌ¦õå; aÂì†‘ì—: if ($FíšîŠÒ ) { $FíšîŠÒ [$e°¸‰…½Õ[93]] = $F…Õ‰çÆÁ; $FíšîŠÒ [$e°¸‰…½Õ[94]] = $BÒÎí©¶×Ç; } return $FíšîŠÒ ; goto Cã˜¨ö¸¾; F›Ëïˆ: $e°¸‰…½Õ =& $_SERVER[¬¦ã¾]; if ($this->isUploadServer()) { return; } $BÒÎí©¶×Ç = $this->getType(); goto cõƒ¶¹Ü«ñ; Cã˜¨ö¸¾: } public function uploadFormData($bİÎáºâ, $AœŸˆ·­¿ = 3600) { } public function multiUploadFormData($bÛÉÌ±óÓÎ, $bå‹ŒÑ¶… = 3600) { } public function download($F¸Ò’ÆÊÅ¨, $dÚ‰—÷ÔÈÜ) { } public function ext($C§çÇª’İ®) { $f­ã–˜¶™ =& $_SERVER[¬¦ã¾]; if (strpos($C§çÇª’İ®, $f­ã–˜¶™[8]) === -1) { $dŒ µ¸„ğÚ = $C§çÇª’İ®; } else { $dŒ µ¸„ğÚ = $this->pathThis($C§çÇª’İ®); } $E§È½ó¨’Ö = $f­ã–˜¶™[33]; if (strstr($dŒ µ¸„ğÚ, $f­ã–˜¶™[95])) { $E§È½ó¨’Ö = substr($dŒ µ¸„ğÚ, strrpos($dŒ µ¸„ğÚ, $f­ã–˜¶™[95]) + 1); $E§È½ó¨’Ö = strtolower($E§È½ó¨’Ö); } if (strlen($E§È½ó¨’Ö) > 3 && preg_match($f­ã–˜¶™[96], $E§È½ó¨’Ö, $FÄÓ”µ¼©¹)) { $E§È½ó¨’Ö = $f­ã–˜¶™[33]; } return $E§È½ó¨’Ö; } public function pathThis($b³İù•æ—) { $E¥ˆƒç =& $_SERVER[¬¦ã¾]; $b³İù•æ— = str_replace($E¥ˆƒç[97], $E¥ˆƒç[8], rtrim($b³İù•æ—, $E¥ˆƒç[8])); $e–« õ‘·¸ = strrpos($b³İù•æ—, $E¥ˆƒç[8]); if ($e–« õ‘·¸ === !1) { return $b³İù•æ—; } return substr($b³İù•æ—, $e–« õ‘·¸ + 1); } public function pathFather($DÂßà²š¤î) { $a¢ï¥¶œÌ =& $_SERVER[¬¦ã¾]; $DÂßà²š¤î = str_replace($a¢ï¥¶œÌ[97], $a¢ï¥¶œÌ[8], rtrim($DÂßà²š¤î, $a¢ï¥¶œÌ[8])); $E°Õ¶”»Æ = strrpos($DÂßà²š¤î, $a¢ï¥¶œÌ[8]); if ($E°Õ¶”»Æ === !1) { return $a¢ï¥¶œÌ[33]; } return substr($DÂßà²š¤î, 0, $E°Õ¶”»Æ + 1); } public function hashSimple($aìËÛáòËó) { goto a±ê¤î´…Ô; a±ê¤î´…Ô: $aãôÀ à¢ =& $_SERVER[¬¦ã¾]; if (!$aìËÛáòËó) { return md5($aãôÀ à¢[33]); } $c³äÚ³¬Öç = $this->size($aìËÛáòËó); goto aÛœ§à±; E¨À³ÊÒ: $eğâ¤“ç˜ .= $this->fileSubstr($aìËÛáòËó, $c³äÚ³¬Öç - $dÉ§ğ§šÏ‚, $dÉ§ğ§šÏ‚); return md5($eğâ¤“ç˜) . $c³äÚ³¬Öç; goto Cš‹Àƒ…ğÒ; Fˆ‘·£õÁë: $Dğõ¥ÍîâÂ = intval($c³äÚ³¬Öç / $bˆôŠ²Á¾ä); $eğâ¤“ç˜ = $aãôÀ à¢[33]; for ($CÂáÄøœùï = 0; $CÂáÄøœùï < $bˆôŠ²Á¾ä; $CÂáÄøœùï++) { $eğâ¤“ç˜ .= $this->fileSubstr($aìËÛáòËó, $Dğõ¥ÍîâÂ * $CÂáÄøœùï, $dÉ§ğ§šÏ‚); } goto E¨À³ÊÒ; aÛœ§à±: $dÉ§ğ§šÏ‚ = 200; $bˆôŠ²Á¾ä = 50; if ($c³äÚ³¬Öç <= $dÉ§ğ§šÏ‚ * $bˆôŠ²Á¾ä) { return $this->hashMd5($aìËÛáòËó) . $c³äÚ³¬Öç; } goto Fˆ‘·£õÁë; Cš‹Àƒ…ğÒ: } public static $md5Cache = array(); public function hashMd5($D‘¢ŞÂã¦œ) { $D‘¢ŞÂã¦œ = $this->iconvSystem($D‘¢ŞÂã¦œ); if (isset(self::$md5Cache[$D‘¢ŞÂã¦œ])) { return self::$md5Cache[$D‘¢ŞÂã¦œ]; } self::$md5Cache[$D‘¢ŞÂã¦œ] = $this->hashMd5Shell($D‘¢ŞÂã¦œ); if (!self::$md5Cache[$D‘¢ŞÂã¦œ]) { self::$md5Cache[$D‘¢ŞÂã¦œ] = @md5_file($D‘¢ŞÂã¦œ); } return self::$md5Cache[$D‘¢ŞÂã¦œ]; } private function hashMd5Shell($f¶äˆÈéÂ·) { goto C¡ÔÓ‚Œ—; EØšç×»é: $d†æ±²Á·ò = shell_exec($E³Öâ·÷¶ . "\x20\42{$f¶äˆÈéÂ·}\42"); $d†æ±²Á·ò = str_replace($C…ß±¤¶‰[104], $C…ß±¤¶‰[33], $d†æ±²Á·ò); return substr($d†æ±²Á·ò, 0, 32); goto CùƒöªâŒ; C¡ÔÓ‚Œ—: $C…ß±¤¶‰ =& $_SERVER[¬¦ã¾]; if (!function_exists($C…ß±¤¶‰[98])) { return !1; } $dï¬òÔõ… = array($C…ß±¤¶‰[99], $C…ß±¤¶‰[100]); goto Fâª¿ù™¬; Fâª¿ù™¬: $E³Öâ·÷¶ = Cache::get($C…ß±¤¶‰[101]); if (!$E³Öâ·÷¶) { $DãÎİÙ¶ª¶ = BASIC_PATH . $C…ß±¤¶‰[102]; $EË¥à¿ Òæ = md5_file($DãÎİÙ¶ª¶); $E³Öâ·÷¶ = $C…ß±¤¶‰[103]; foreach ($dï¬òÔõ… as $a‰ö­ÄºŒ) { $d†æ±²Á·ò = shell_exec($a‰ö­ÄºŒ . "\x20\x22{$DãÎİÙ¶ª¶}\x22"); if ($d†æ±²Á·ò && substr(trim($d†æ±²Á·ò), 0, 32) == $EË¥à¿ Òæ) { $E³Öâ·÷¶ = $a‰ö­ÄºŒ; break; } } Cache::set($C…ß±¤¶‰[101], $E³Öâ·÷¶, 3600); } if ($E³Öâ·÷¶ == $C…ß±¤¶‰[103]) { return !1; } goto EØšç×»é; CùƒöªâŒ: } public function link($Fš‰ñ„ºé) { return $Fš‰ñ„ºé; } public function fileOut($F¦ö¢ˆŒÜà, $f†Á» Ñ”² = false, $B÷ºÚÜñ¶ = false, $Fö£™‹ ŞŠ = '') { goto AÒñ¦¼†‰¢; b–à©ñ‘¡¸: if (in_array($FÙëøÙ­¸á, array($dƒÏğ‚¼„Œ[111], $dƒÏğ‚¼„Œ[112], $dƒÏğ‚¼„Œ[113], $dƒÏğ‚¼„Œ[114]))) { $FÙëøÙ­¸á = $dƒÏğ‚¼„Œ[115]; } if (!$Fö£™‹ ŞŠ) { $Fö£™‹ ŞŠ = md5($AõğÒãøˆ . $this->hashSimple($F¦ö¢ˆŒÜà)); } $Fö£™‹ ŞŠ = $dƒÏğ‚¼„Œ[116] . $Fö£™‹ ŞŠ . $dƒÏğ‚¼„Œ[116]; goto b°Ï¢Î´ğ; BâÊìÇø : $CøèÙâ±ˆ× = $dƒÏğ‚¼„Œ[116] . $CøèÙâ±ˆ× . $dƒÏğ‚¼„Œ[122] . $CøèÙâ±ˆ×; if ($f†Á» Ñ”²) { header($dƒÏğ‚¼„Œ[123]); header($dƒÏğ‚¼„Œ[124] . $CøèÙâ±ˆ×); } else { header($dƒÏğ‚¼„Œ[125] . $CøèÙâ±ˆ×); } header($dƒÏğ‚¼„Œ[126] . gmdate($dƒÏğ‚¼„Œ[110], time() + 3600 * 24 * 30) . $dƒÏğ‚¼„Œ[127]); goto EÄ™¬Áœ¯ö; BµŠîôó™: $EŞÉ©ˆªÌ™ = $this->getType() == $dƒÏğ‚¼„Œ[106]; $Dœ‹æ×ÉÍ¾ = $GLOBALS[$dƒÏğ‚¼„Œ[6]][$dƒÏğ‚¼„Œ[88]][$dƒÏğ‚¼„Œ[107]][$dƒÏğ‚¼„Œ[108]]; $C±„µë½¨Â = (double) $GLOBALS[$dƒÏğ‚¼„Œ[6]][$dƒÏğ‚¼„Œ[88]][$dƒÏğ‚¼„Œ[107]][$dƒÏğ‚¼„Œ[109]] * 1024 * 1024; goto Bå«›×Â’Ğ; e¬‹ç³‰Š: header($dƒÏğ‚¼„Œ[135] . $AõğÒãøˆ . $dƒÏğ‚¼„Œ[127]); header($dƒÏğ‚¼„Œ[136] . $aˆ½˜¥Å¸); header($dƒÏğ‚¼„Œ[137]); goto AºƒùÅÍ·ø; cğ­Ù¡ôß¹: if ($C±„µë½¨Â) { $C´’íÉİ„æ = intval(1000 * 1000 * ($a…ŞÈ«‹ÂÈ / $C±„µë½¨Â)); } while ($aô™à×¯ ¹ <= $B²Æé¯¯ö‘) { $fœÉåò–Õ‘ = timeFloat(); check_abort(); $b¹š®˜›¿ = $B²Æé¯¯ö‘ - $aô™à×¯ ¹ + 1; if ($b¹š®˜›¿ <= $a…ŞÈ«‹ÂÈ) { $a…ŞÈ«‹ÂÈ = $b¹š®˜›¿; } echo $this->fileSubstr($F¦ö¢ˆŒÜà, $aô™à×¯ ¹, $a…ŞÈ«‹ÂÈ); $aô™à×¯ ¹ += $a…ŞÈ«‹ÂÈ; if ($a…ŞÈ«‹ÂÈ == $b¹š®˜›¿) { $aô™à×¯ ¹ = $B²Æé¯¯ö‘ + 1; } if ($C´’íÉİ„æ) { $CÀùíô Íó = intval(1000 * 1000 * (timeFloat() - $fœÉåò–Õ‘)); $B…ÁÁå§Êô = $C´’íÉİ„æ - $CÀùíô Íó; if ($B…ÁÁå§Êô > 5) { usleep($B…ÁÁå§Êô); } } } goto EéÁ¾ì«ã²; C™’‡í±óí: $bğ­Œ‚Šå‹ = strtolower($_SERVER[$dƒÏğ‚¼„Œ[142]]); if ($EŞÉ©ˆªÌ™ && $bğ­Œ‚Šå‹ && $Dœ‹æ×ÉÍ¾) { if (strstr($bğ­Œ‚Šå‹, $dƒÏğ‚¼„Œ[143])) { header($dƒÏğ‚¼„Œ[144] . $F¦ö¢ˆŒÜà); } else { if (strstr($bğ­Œ‚Šå‹, $dƒÏğ‚¼„Œ[145])) { header($dƒÏğ‚¼„Œ[146] . $F¦ö¢ˆŒÜà); } else { if (strstr($bğ­Œ‚Šå‹, $dƒÏğ‚¼„Œ[147])) { header($dƒÏğ‚¼„Œ[148] . $F¦ö¢ˆŒÜà); } } } if ($C±„µë½¨Â) { header($dƒÏğ‚¼„Œ[149] . $C±„µë½¨Â); } return; } if (isset($_SERVER[$dƒÏğ‚¼„Œ[150]])) { if (preg_match($dƒÏğ‚¼„Œ[151], $_SERVER[$dƒÏğ‚¼„Œ[150]], $b†ô‹¡éŒÂ)) { $aô™à×¯ ¹ = intval($b†ô‹¡éŒÂ[1]); if (!empty($b†ô‹¡éŒÂ[2])) { $B²Æé¯¯ö‘ = intval($b†ô‹¡éŒÂ[2]); } } header($dƒÏğ‚¼„Œ[152]); header("\x43\157\156\x74\145\156\x74\55\x52\141\156\147\145\72\40\142\171\x74\145\x73\40{$aô™à×¯ ¹}\55{$B²Æé¯¯ö‘}\x2f" . $Eğ„‡¾Ã¹÷); } else { header($dƒÏğ‚¼„Œ[153]); } goto fŸÚŠù‚õ›; EÄ™¬Áœ¯ö: header($dƒÏğ‚¼„Œ[128]); header($dƒÏğ‚¼„Œ[129]); header($dƒÏğ‚¼„Œ[130]); goto aµ®ÒÈ¥¸; AºƒùÅÍ·ø: header($dƒÏğ‚¼„Œ[138] . $Eğ„‡¾Ã¹÷); header($dƒÏğ‚¼„Œ[139]); if (!$f†Á» Ñ”² && $FÙëøÙ­¸á == $dƒÏğ‚¼„Œ[140]) { if ($Eğ„‡¾Ã¹÷ > 1024 * 1024 * 5) { die; } $e×Ü³¸êŸ¶ = $this->getContent($F¦ö¢ˆŒÜà); $e×Ü³¸êŸ¶ = Html::clearSVG($e×Ü³¸êŸ¶); header($dƒÏğ‚¼„Œ[141] . strlen($e×Ü³¸êŸ¶)); echo $e×Ü³¸êŸ¶; die; } goto C™’‡í±óí; B„­ÉŒí†Ï: if ($_SERVER[$dƒÏğ‚¼„Œ[157]] == $dƒÏğ‚¼„Œ[158]) { return; } $a…ŞÈ«‹ÂÈ = 1024 * 100; $C´’íÉİ„æ = 0; goto cğ­Ù¡ôß¹; fŸÚŠù‚õ›: $d‰ª»‘©– = !0; if ($_SERVER[$dƒÏğ‚¼„Œ[154]] == $dƒÏğ‚¼„Œ[155] && $Eğ„‡¾Ã¹÷ > 1204 * 1024 * 1024 * 2) { $d‰ª»‘©– = !1; } if ($d‰ª»‘©–) { header($dƒÏğ‚¼„Œ[156] . ($B²Æé¯¯ö‘ - $aô™à×¯ ¹ + 1)); } goto B„­ÉŒí†Ï; AÀ©¡×Ü¹Ê: $Eğ„‡¾Ã¹÷ = $D†”‡Œ²½‘[$dƒÏğ‚¼„Œ[78]]; $AõğÒãøˆ = gmdate($dƒÏğ‚¼„Œ[110], $D†”‡Œ²½‘[$dƒÏğ‚¼„Œ[84]]); $aˆ½˜¥Å¸ = $B÷ºÚÜñ¶ ? $B÷ºÚÜñ¶ : $this->iconvApp($D†”‡Œ²½‘[$dƒÏğ‚¼„Œ[28]]); goto eè³ÌÀÓéØ; AÒñ¦¼†‰¢: $dƒÏğ‚¼„Œ =& $_SERVER[¬¦ã¾]; $this->cacheMethod(null, null); if (!$F¦ö¢ˆŒÜà || !$this->exist($F¦ö¢ˆŒÜà)) { show_json(LNG($dƒÏğ‚¼„Œ[105]), !1, $B÷ºÚÜñ¶); } goto BµŠîôó™; eè³ÌÀÓéØ: $aô™à×¯ ¹ = 0; $B²Æé¯¯ö‘ = $Eğ„‡¾Ã¹÷ - 1; $FÙëøÙ­¸á = $this->ext($aˆ½˜¥Å¸); goto b–à©ñ‘¡¸; Bå«›×Â’Ğ: @ob_end_clean(); set_timeout(); $D†”‡Œ²½‘ = $this->infoFull($F¦ö¢ˆŒÜà); goto AÀ©¡×Ü¹Ê; aµ®ÒÈ¥¸: if (isset($_SERVER[$dƒÏğ‚¼„Œ[131]]) && strtotime($_SERVER[$dƒÏğ‚¼„Œ[131]]) == $D†”‡Œ²½‘[$dƒÏğ‚¼„Œ[84]]) { header($dƒÏğ‚¼„Œ[132], !0, 304); die; } if (isset($_SERVER[$dƒÏğ‚¼„Œ[133]]) && $_SERVER[$dƒÏğ‚¼„Œ[133]] == $Fö£™‹ ŞŠ) { header($dƒÏğ‚¼„Œ[134] . $Fö£™‹ ŞŠ, !0, 304); die; } header($dƒÏğ‚¼„Œ[134] . $Fö£™‹ ŞŠ); goto e¬‹ç³‰Š; b°Ï¢Î´ğ: $F‚ä¥•ğèÀ = get_file_mime($FÙëøÙ­¸á); if (strstr($F‚ä¥•ğèÀ, $dƒÏğ‚¼„Œ[117])) { $F‚ä¥•ğèÀ = $F‚ä¥•ğèÀ . $dƒÏğ‚¼„Œ[118]; } if ($f†Á» Ñ”² === !1 && !mime_support($F‚ä¥•ğèÀ)) { $f†Á» Ñ”² = !0; $F‚ä¥•ğèÀ = $dƒÏğ‚¼„Œ[119]; } goto dµ˜Ø„è¶; dµ˜Ø„è¶: header($dƒÏğ‚¼„Œ[120]); header($dƒÏğ‚¼„Œ[121] . $F‚ä¥•ğèÀ); $CøèÙâ±ˆ× = rawurlencode($aˆ½˜¥Å¸); goto BâÊìÇø ; EéÁ¾ì«ã²: } public function fileOutServer($EŠÉµ‚Ï‰, $AĞñù¼¸÷£ = false, $eÖÒ¸Ñ‹¸š = false, $D»Æ‰ÈºÔæ = '') { $this->fileOut($EŠÉµ‚Ï‰, $AĞñù¼¸÷£, $eÖÒ¸Ñ‹¸š, $D»Æ‰ÈºÔæ); } public function fileOutLink($däŠöŠËõ ) { header($_SERVER[¬¦ã¾][159] . $däŠöŠËõ ); die; } public function cacheMethod($Dãàõµ³‘, $cÑÚ»„ßğŠ, $dŠöÒóçéÙ = null) { goto B“ö¤¶Èİ…; B“ö¤¶Èİ…: $FÁ®­ï†îŸ =& $_SERVER[¬¦ã¾]; static $BùíÛ‚±‘º = array(); $c¨ …©ºèˆ = $cÑÚ»„ßğŠ ? ltrim($this->getPathOuter($cÑÚ»„ßğŠ), $FÁ®­ï†îŸ[8]) : $cÑÚ»„ßğŠ; goto BåìÚ×¹®¶; BåìÚ×¹®¶: $Dæ¯…›«ù = $FÁ®­ï†îŸ[160] . $Dãàõµ³‘ . $FÁ®­ï†îŸ[161] . rtrim($c¨ …©ºèˆ, $FÁ®­ï†îŸ[8]); if (is_null($Dãàõµ³‘)) { $BùíÛ‚±‘º = array(); return; } if (is_null($cÑÚ»„ßğŠ)) { unset($BùíÛ‚±‘º[$Dæ¯…›«ù]); return; } goto f×óï¾ÎÕÚ; C—š‚¦¼è: $EÃ„—õ“ÏÒ = $this->{$Dãàõµ³‘}($cÑÚ»„ßğŠ); $BùíÛ‚±‘º[$Dæ¯…›«ù] = $EÃ„—õ“ÏÒ; return $EÃ„—õ“ÏÒ; goto b¹¶ÍõÂˆ; f×óï¾ÎÕÚ: if (!is_null($dŠöÒóçéÙ)) { $BùíÛ‚±‘º[$Dæ¯…›«ù] = $dŠöÒóçéÙ; return; } $EÃ„—õ“ÏÒ = isset($BùíÛ‚±‘º[$Dæ¯…›«ù]) ? $BùíÛ‚±‘º[$Dæ¯…›«ù] : null; if (!is_null($EÃ„—õ“ÏÒ)) { return $EÃ„—õ“ÏÒ; } goto C—š‚¦¼è; b¹¶ÍõÂˆ: } public function fileOutImage($c ’ÚŒ‘ï, $a¿âÓ‘»ßë = 250) { goto F•ˆĞ‹‡…†; F•ˆĞ‹‡…†: $DºÂƒ­–À =& $_SERVER[¬¦ã¾]; set_timeout(); if (substr($c ’ÚŒ‘ï, 0, 4) == $DºÂƒ­–À[147]) { $this->fileOutLink($c ’ÚŒ‘ï); } goto DŠ£¼ïÅ°’; BÌ¨ÃÈŒéÚ: if (!is_dir(DATA_THUMB)) { mk_dir(DATA_THUMB); } $bÈµ³‹÷‚Ú = DATA_THUMB . $D´Çîí£Œñ; del_file($bÈµ³‹÷‚Ú); goto bæ–æ¦Š×; bæ–æ¦Š×: if (!@file_exists($bÈµ³‹÷‚Ú)) { $C®É¶¯Ÿ–Ğ = TEMP_FILES; if (!is_dir($C®É¶¯Ÿ–Ğ)) { mk_dir($C®É¶¯Ÿ–Ğ); } $e’äèŞŞÎ = $C®É¶¯Ÿ–Ğ . $B‹ÆĞ‹Ÿº¥ . $DºÂƒ­–À[95] . $B•ŞİµÜ‘„[$DºÂƒ­–À[168]]; if (!@file_exists($e’äèŞŞÎ)) { $e’äèŞŞÎ = $this->download($c ’ÚŒ‘ï, $e’äèŞŞÎ); } ImageThumb::createThumb($e’äèŞŞÎ, $bÈµ³‹÷‚Ú, $a¿âÓ‘»ßë, $a¿âÓ‘»ßë * 10); } if (!file_exists($bÈµ³‹÷‚Ú) || filesize($bÈµ³‹÷‚Ú) < 100) { return @file_exists($e’äèŞŞÎ) ? IO::fileOut($e’äèŞŞÎ) : $this->fileOut($c ’ÚŒ‘ï); } if (!($f„Ï¸”‰Æ = IO::move($bÈµ³‹÷‚Ú, $f®Ù­Ó¦¦–))) { return IO::fileOut($bÈµ³‹÷‚Ú); } goto EÏİˆò‡¯‚; DŠ£¼ïÅ°’: $B•ŞİµÜ‘„ = $this->info($c ’ÚŒ‘ï); $eÔ¨æô‡¬½ = $B•ŞİµÜ‘„[$DºÂƒ­–À[28]]; $EËï¢£ô‡ = !1; goto E“²è¹âÁ™; dê’ÈŞÖ: $D´Çîí£Œñ = "{$B‹ÆĞ‹Ÿº¥}\137{$a¿âÓ‘»ßë}\56\x70\156\x67"; if (!($d÷‹±Ğ‰÷ø = IO::fileNameExist(IO_PATH_SYSTEM_TEMP, $DºÂƒ­–À[172]))) { $f®Ù­Ó¦¦– = IO::mkdir(IO_PATH_SYSTEM_TEMP . $DºÂƒ­–À[173]); } else { $f®Ù­Ó¦¦– = KodIO::make($d÷‹±Ğ‰÷ø); } if ($d÷‹±Ğ‰÷ø = IO::fileNameExist($f®Ù­Ó¦¦–, $D´Çîí£Œñ)) { $bÈµ³‹÷‚Ú = KodIO::make($d÷‹±Ğ‰÷ø); return IO::fileOut($bÈµ³‹÷‚Ú, !1, $eÔ¨æô‡¬½); } goto BÌ¨ÃÈŒéÚ; E“²è¹âÁ™: if (isset($GLOBALS[$DºÂƒ­–À[162]]) && $GLOBALS[$DºÂƒ­–À[162]][$DºÂƒ­–À[76]] == $B•ŞİµÜ‘„[$DºÂƒ­–À[76]]) { $a…Óå–Ô„™ = $GLOBALS[$DºÂƒ­–À[162]][$DºÂƒ­–À[163]]; if (!$B•ŞİµÜ‘„[$DºÂƒ­–À[164]]) { $B•ŞİµÜ‘„[$DºÂƒ­–À[164]] = $GLOBALS[$DºÂƒ­–À[162]]; } if (isset($a…Óå–Ô„™[$DºÂƒ­–À[165]])) { if ($a…Óå–Ô„™[$DºÂƒ­–À[165]] <= $a¿âÓ‘»ßë && $a…Óå–Ô„™[$DºÂƒ­–À[166]] <= $a¿âÓ‘»ßë) { $EËï¢£ô‡ = !0; } } $eÔ¨æô‡¬½ = $B•ŞİµÜ‘„[$DºÂƒ­–À[164]][$DºÂƒ­–À[28]]; } if ($B•ŞİµÜ‘„[$DºÂƒ­–À[78]] <= 1024 * 50 || $EËï¢£ô‡ || !function_exists($DºÂƒ­–À[167]) || $B•ŞİµÜ‘„[$DºÂƒ­–À[168]] == $DºÂƒ­–À[169]) { return $this->fileOut($c ’ÚŒ‘ï, !1, $eÔ¨æô‡¬½); } if (isset($B•ŞİµÜ‘„[$DºÂƒ­–À[164]][$DºÂƒ­–À[170]])) { $B‹ÆĞ‹Ÿº¥ = $B•ŞİµÜ‘„[$DºÂƒ­–À[164]][$DºÂƒ­–À[170]]; } else { if (isset($B•ŞİµÜ‘„[$DºÂƒ­–À[164]][$DºÂƒ­–À[171]])) { $B‹ÆĞ‹Ÿº¥ = $B•ŞİµÜ‘„[$DºÂƒ­–À[164]][$DºÂƒ­–À[171]]; } else { $B‹ÆĞ‹Ÿº¥ = md5("{$B•ŞİµÜ‘„[$DºÂƒ­–À[28]]}\x5f{$B•ŞİµÜ‘„[$DºÂƒ­–À[76]]}\x5f{$B•ŞİµÜ‘„[$DºÂƒ­–À[78]]}"); } } goto dê’ÈŞÖ; EÏİˆò‡¯‚: del_file($bÈµ³‹÷‚Ú); IO::fileOut($f„Ï¸”‰Æ); goto eïˆÒ›‚ê; eïˆÒ›‚ê: } public function fileOutImageServer($bù†¡è¾É‘, $bæ•¬ä‡í¤ = 250) { $this->fileOutImage($bù†¡è¾É‘, $bæ•¬ä‡í¤); } public function fileNameAuto($AÚÅñ“ƒ, $eëá—Û×˜ƒ, $Eå”§Æö¢ö = REPEAT_RENAME, $aÕÏ•á¾çÉ = false) { goto Dª‡Šêä­ï; e¬º…†¨áß: $A÷—¸Èïİ = 1; $EÜ²É„ßèÁ = substr($eëá—Û×˜ƒ, 0, strlen($eëá—Û×˜ƒ) - strlen($B°„¤ùºê÷)); $A¯È ‹¨æŒ = $EÜ²É„ßèÁ . "\x28{$A÷—¸Èïİ}\x29{$B°„¤ùºê÷}"; goto bÎä…ëô¼; Dª‡Šêä­ï: $F¦îÌ¾İ¶¼ =& $_SERVER[¬¦ã¾]; $C¾Ú¨‘°Ø‹ = $AÚÅñ“ƒ === $F¦îÌ¾İ¶¼[33] ? $eëá—Û×˜ƒ : rtrim($AÚÅñ“ƒ, $F¦îÌ¾İ¶¼[8]) . $F¦îÌ¾İ¶¼[8] . $eëá—Û×˜ƒ; if ($Eå”§Æö¢ö == REPEAT_REPLACE || !$this->exist($C¾Ú¨‘°Ø‹) || $aÕÏ•á¾çÉ && $Eå”§Æö¢ö != REPEAT_RENAME_FOLDER) { return $eëá—Û×˜ƒ; } goto CŸĞ›½Œñì; CŸĞ›½Œñì: if ($Eå”§Æö¢ö == REPEAT_SKIP) { return !1; } $B°„¤ùºê÷ = $F¦îÌ¾İ¶¼[95] . get_path_ext($eëá—Û×˜ƒ); $B°„¤ùºê÷ = $B°„¤ùºê÷ == $F¦îÌ¾İ¶¼[95] || $aÕÏ•á¾çÉ ? $F¦îÌ¾İ¶¼[33] : $B°„¤ùºê÷; goto e¬º…†¨áß; bÎä…ëô¼: while ($this->exist(rtrim($AÚÅñ“ƒ, $F¦îÌ¾İ¶¼[8]) . $F¦îÌ¾İ¶¼[8] . $A¯È ‹¨æŒ)) { $A¯È ‹¨æŒ = $EÜ²É„ßèÁ . "\50{$A÷—¸Èïİ}\51{$B°„¤ùºê÷}"; $A÷—¸Èïİ++; } return $A¯È ‹¨æŒ; goto AöÇÕ°Šç×; AöÇÕ°Šç×: } private function fileNameAutoList($aš†±Ô—„¡, $dÓ·Ü¥˜Â–, $aàã–°–ÈÂ = false) { goto b‘ŞƒŠ„‘³; b‘ŞƒŠ„‘³: $aˆè‚˜ÔË´ =& $_SERVER[¬¦ã¾]; $Eª×È’ ÏÓ = $this->listPath($aš†±Ô—„¡, !0); $Eª×È’ ÏÓ = array_merge($Eª×È’ ÏÓ[$aˆè‚˜ÔË´[75]], $Eª×È’ ÏÓ[$aˆè‚˜ÔË´[74]]); goto cšÖÀ”‘Ï–; cšÖÀ”‘Ï–: $B‚Ìâ‹ø‚¡ = array_to_keyvalue($Eª×È’ ÏÓ, $aˆè‚˜ÔË´[33], $aˆè‚˜ÔË´[28]); $a¸±¯‘Ü¬¤ = $aˆè‚˜ÔË´[95] . get_path_ext($dÓ·Ü¥˜Â–); $a¸±¯‘Ü¬¤ = $a¸±¯‘Ü¬¤ == $aˆè‚˜ÔË´[95] || $aàã–°–ÈÂ ? $aˆè‚˜ÔË´[33] : $a¸±¯‘Ü¬¤; goto Eêñ”®³”; Eêñ”®³”: $D·ƒÇÜõÖ¯ = substr($dÓ·Ü¥˜Â–, 0, strlen($dÓ·Ü¥˜Â–) - strlen($a¸±¯‘Ü¬¤)); $a‡Ÿº¢®¶ = $D·ƒÇÜõÖ¯ . "\50\x30\x29{$a¸±¯‘Ü¬¤}"; for ($b¢’¡ñê = 1; $b¢’¡ñê <= count($B‚Ìâ‹ø‚¡) + 1; $b¢’¡ñê++) { $a‡Ÿº¢®¶ = $D·ƒÇÜõÖ¯ . "\x28{$b¢’¡ñê}\x29{$a¸±¯‘Ü¬¤}"; if (!in_array_not_case($a‡Ÿº¢®¶, $B‚Ìâ‹ø‚¡)) { return $a‡Ÿº¢®¶; } } goto fİÊ°äøÊÃ; fİÊ°äøÊÃ: return $a‡Ÿº¢®¶; goto föÑ‚êøÑ; föÑ‚êøÑ: } public function listAllFiles($cêùŒ…ØÑ¼, $AÑÙÏñ‡ø, $e¯¨¡·Şê¹ = array()) { goto eªôñ©Šà; eªôñ©Šà: $d“óß¹ù› =& $_SERVER[¬¦ã¾]; if (empty($AÑÙÏñ‡ø)) { return array(); } $A­…‘ƒ‚ç± = array(); goto EÏ¼ÅØ…; BÏÀ¶Šö«”: foreach (array_unique($A­…‘ƒ‚ç±) as $FÂ¢÷¤ˆÛ·) { $aØ¯¨’¥ = array($d“óß¹ù›[76] => $this->getPathOuter($d“óß¹ù›[8] . $cêùŒ…ØÑ¼ . $d“óß¹ù›[8] . $FÂ¢÷¤ˆÛ·), $d“óß¹ù›[77] => 1, $d“óß¹ù›[78] => 0); if (substr($FÂ¢÷¤ˆÛ·, -1) != $d“óß¹ù›[8]) { $aØ¯¨’¥[$d“óß¹ù›[77]] = 0; $B´‘æ±ƒÓ» = $this->getPath($cêùŒ…ØÑ¼ . $d“óß¹ù›[8] . $FÂ¢÷¤ˆÛ·); $aØ¯¨’¥[$d“óß¹ù›[78]] = isset($e¯¨¡·Şê¹[$B´‘æ±ƒÓ»]) ? $e¯¨¡·Şê¹[$B´‘æ±ƒÓ»] : $this->size($B´‘æ±ƒÓ»); } $EùâœĞ×Üî[] = $aØ¯¨’¥; } return $EùâœĞ×Üî; goto d›ƒƒÕ·¨Ÿ; EÏ¼ÅØ…: $cêùŒ…ØÑ¼ = trim($cêùŒ…ØÑ¼, $d“óß¹ù›[8]); foreach ($AÑÙÏñ‡ø as $FÂ¢÷¤ˆÛ·) { $b¶Ÿ÷ÄÔÇÚ = ltrim(substr(trim($FÂ¢÷¤ˆÛ·, $d“óß¹ù›[8]), strlen($cêùŒ…ØÑ¼)), $d“óß¹ù›[8]); $A­…‘ƒ‚ç± = array_merge($A­…‘ƒ‚ç±, $this->slicePath($b¶Ÿ÷ÄÔÇÚ)); } $EùâœĞ×Üî = array(); goto BÏÀ¶Šö«”; d›ƒƒÕ·¨Ÿ: } public function slicePath($aŠ¡©¬ªè) { $C¾‡Œ½ÌÒó =& $_SERVER[¬¦ã¾]; $fó‰‚‰äŒÍ = explode($C¾‡Œ½ÌÒó[8], trim($aŠ¡©¬ªè, $C¾‡Œ½ÌÒó[8])); $EÊÔÜŞ”åé = 0; do { ++$EÊÔÜŞ”åé; $f§íî™¥•ˆ[] = implode($C¾‡Œ½ÌÒó[8], array_slice($fó‰‚‰äŒÍ, 0, $EÊÔÜŞ”åé)) . $C¾‡Œ½ÌÒó[8]; } while ($EÊÔÜŞ”åé < count($fó‰‚‰äŒÍ)); $f§íî™¥•ˆ[count($fó‰‚‰äŒÍ) - 1] = $aŠ¡©¬ªè; return $f§íî™¥•ˆ; } public function getHost() { $CÖ£Ğ„Ş­Â =& $_SERVER[¬¦ã¾]; $FŸÍ¶Îë°Û = parse_url(trim($this->domain, $CÖ£Ğ„Ş­Â[8])); $B˜ª½âœ = isset($FŸÍ¶Îë°Û[$CÖ£Ğ„Ş­Â[174]]) ? $FŸÍ¶Îë°Û[$CÖ£Ğ„Ş­Â[174]] : http_type(); $EËÙğÌ©‹ = isset($FŸÍ¶Îë°Û[$CÖ£Ğ„Ş­Â[175]]) ? $FŸÍ¶Îë°Û[$CÖ£Ğ„Ş­Â[175]] : $FŸÍ¶Îë°Û[$CÖ£Ğ„Ş­Â[76]]; if (isset($FŸÍ¶Îë°Û[$CÖ£Ğ„Ş­Â[176]])) { $EËÙğÌ©‹ .= $CÖ£Ğ„Ş­Â[4] . $FŸÍ¶Îë°Û[$CÖ£Ğ„Ş­Â[176]]; } return $B˜ª½âœ . $CÖ£Ğ„Ş­Â[177] . $EËÙğÌ©‹; } public function pathEncode($bĞœòÖæ‹) { $bëÉ¡‡’Ç =& $_SERVER[¬¦ã¾]; return str_replace($bëÉ¡‡’Ç[178], $bëÉ¡‡’Ç[8], rawurlencode($bĞœòÖæ‹)); } } class PathDriverBaseS3 extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $useSSL = false; protected $region = ''; protected $endpoint = ''; protected $bucket = ''; protected $client = null; protected $signVer = "\166\64"; public $ioUploadServer = "\60"; public $ioFileOutServer = "\60"; public function __construct($AÅæùƒ°”±) { set_timeout(); require_once SDK_DIR . $_SERVER[¬¦ã¾][179]; parent::__construct(); $this->_init($AÅæùƒ°”±); } public function _init($FãÒëö¤ç) { foreach ($FãÒëö¤ç as $bÀ³¨–·Ø¼ => $dë Ø‘‚ µ) { if (isset($this->{$bÀ³¨–·Ø¼})) { $this->{$bÀ³¨–·Ø¼} = $dë Ø‘‚ µ; } } $this->endpoint = $FãÒëö¤ç[$_SERVER[¬¦ã¾][180]]; $this->client = new S3($this->accessKey, $this->secret, $this->useSSL, $this->endpoint, $this->region); $this->client->setEndpoint($this->getHost()); } public function signatureVersion($BÑ¦‹ãÑè = "\166\64") { $this->signVer = $BÑ¦‹ãÑè; $this->client->setSignatureVersion($BÑ¦‹ãÑè); } public function setBucketCors() { return $this->client->setBucketCors($this->bucket); } public function getBucketCors() { return $this->client->getBucketCors($this->bucket); } public function isBucketCors() { goto d£§Ÿ¾¿; EÏòàÌÇäê: if ($bÕ²¾öÔÑ×[$E«ÚĞà©¡Ö[181]] != $E«ÚĞà©¡Ö[182] || $bÕ²¾öÔÑ×[$E«ÚĞà©¡Ö[183]] != $E«ÚĞà©¡Ö[182]) { return !1; } $e¡ØÖ¦÷‹ = array_map($E«ÚĞà©¡Ö[184], $bÕ²¾öÔÑ×[$E«ÚĞà©¡Ö[185]]); if (!is_array($e¡ØÖ¦÷‹)) { $e¡ØÖ¦÷‹ = array(); } goto bé¾¼© àÍ; bé¾¼© àÍ: $cœÁ½Ò ø± = array($E«ÚĞà©¡Ö[186], $E«ÚĞà©¡Ö[187], $E«ÚĞà©¡Ö[188], $E«ÚĞà©¡Ö[189], $E«ÚĞà©¡Ö[190]); $E…¡ä·Ñëš = array_diff($cœÁ½Ò ø±, $e¡ØÖ¦÷‹); return empty($E…¡ä·Ñëš); goto c¨ìö®„˜·; d£§Ÿ¾¿: $E«ÚĞà©¡Ö =& $_SERVER[¬¦ã¾]; $bÕ²¾öÔÑ× = $this->getBucketCors(); if (!$bÕ²¾öÔÑ× || !is_array($bÕ²¾öÔÑ×)) { return !1; } goto EÏòàÌÇäê; c¨ìö®„˜·: } public function mkfile($fÄŠöë²ãõ, $fŠâŠ‹ˆŸØ = '', $A¬´“ÂÉÖ£ = REPEAT_RENAME) { $Eè‰²µÄŠ = $this->setContent($fÄŠöë²ãõ, $fŠâŠ‹ˆŸØ); if ($Eè‰²µÄŠ !== !1) { return $this->getPathOuter($fÄŠöë²ãõ); } return !1; } public function mkdir($e¦Õ¼‡³‚, $cÖÂôÁ´¨Æ = REPEAT_SKIP) { $aŸ¦¢óêÉÉ =& $_SERVER[¬¦ã¾]; if (empty($e¦Õ¼‡³‚) && $e¦Õ¼‡³‚ !== $aŸ¦¢óêÉÉ[191]) { return !1; } if ($this->_isFolder($e¦Õ¼‡³‚)) { return $this->getPathOuter($e¦Õ¼‡³‚); } $eŠ‰ò‡²Ï› = $this->setContent($e¦Õ¼‡³‚, $aŸ¦¢óêÉÉ[33], !0); if ($eŠ‰ò‡²Ï› !== !1) { return $this->getPathOuter($e¦Õ¼‡³‚); } return !1; } public function copyFile($c¥ƒŒÂÁÁœ, $b•¶”…¤, $A››ÙØğŒˆ = array()) { $c¼ª“ŒØš½ =& $_SERVER[¬¦ã¾]; $a±‘‰È»« = $this->objectMeta($c¥ƒŒÂÁÁœ); if (!$a±‘‰È»«) { return !1; } if ($a±‘‰È»«[$c¼ª“ŒØš½[78]] <= 1024 * 1024 * 200) { $f·ì©÷ÎºÅ = $this->client->copyObject($this->bucket, $c¥ƒŒÂÁÁœ, $this->bucket, $b•¶”…¤, $c¼ª“ŒØš½[192], $A››ÙØğŒˆ); } else { $f·ì©÷ÎºÅ = $this->client->multiCopyObject($this->bucket, $c¥ƒŒÂÁÁœ, $this->bucket, $b•¶”…¤, $A››ÙØğŒˆ); } $f·ì©÷ÎºÅ = $f·ì©÷ÎºÅ ? $this->getPathOuter($b•¶”…¤) : !1; return $f·ì©÷ÎºÅ; } public function moveFile($Aô¼æÒÍÉ”, $eæ½‡µ¡¨ñ) { if ($this->copyFile($Aô¼æÒÍÉ”, $eæ½‡µ¡¨ñ)) { $this->delFile($Aô¼æÒÍÉ”); return $this->getPathOuter($eæ½‡µ¡¨ñ); } return !1; } public function delFile($bòîÖ°ëÜî) { return $this->client->deleteObject($this->bucket, $bòîÖ°ëÜî); } public function delFolder($e¹‹‚–µ¥) { goto Bã¬Şµ±óÛ; Dá¼¹¼ò•: if (!empty($e¹‹‚–µ¥) && $e¹‹‚–µ¥ !== $Añ‚‹˜¦ª[191] && !in_array($B£‚ğî¤å¾, $d½Ã¡Œî[$Añ‚‹˜¦ª[75]])) { $d½Ã¡Œî[$Añ‚‹˜¦ª[75]][] = $B£‚ğî¤å¾; } $cîñ÷ÓÓè = $this->delByBatch($d½Ã¡Œî[$Añ‚‹˜¦ª[74]]); if (!$cîñ÷ÓÓè) { return !1; } goto c„ªÔ×Í×ğ; c„ªÔ×Í×ğ: $cîñ÷ÓÓè = $this->delByBatch($d½Ã¡Œî[$Añ‚‹˜¦ª[75]]); if (!$cîñ÷ÓÓè) { return !1; } return $this->delFile($B£‚ğî¤å¾); goto F…‚©æƒµè; eĞêÃÛ÷÷‘: $d½Ã¡Œî = $this->fileList($e¹‹‚–µ¥); $this->listItemCache = !0; $B£‚ğî¤å¾ = trim($e¹‹‚–µ¥, $Añ‚‹˜¦ª[8]) . $Añ‚‹˜¦ª[8]; goto Dá¼¹¼ò•; Bã¬Şµ±óÛ: $Añ‚‹˜¦ª =& $_SERVER[¬¦ã¾]; if (!$this->exist($e¹‹‚–µ¥)) { return !0; } $this->listItemCache = !1; goto eĞêÃÛ÷÷‘; F…‚©æƒµè: } private function delByBatch($eíóÙŸ¤É) { foreach (array_chunk($eíóÙŸ¤É, 1000) as $DÃ°×ğÒËƒ) { $B»ÌÇŠ¤Ò¡ = $this->client->deleteObjects($this->bucket, $DÃ°×ğÒËƒ); if (!$B»ÌÇŠ¤Ò¡) { return !1; } } return !0; } public function rename($Cáùöº˜„, $DÓ ê©¢) { return $this->renameObject($Cáùöº˜„, $DÓ ê©¢); } public function listPath($c¤¥‚¶…Ë, $E’Ş™áÄ¤  = false) { $F„ˆÎí¤¾Â =& $_SERVER[¬¦ã¾]; $cºà‹–õº = $this->fileList($c¤¥‚¶…Ë, $F„ˆÎí¤¾Â[8], !0); foreach ($cºà‹–õº[$F„ˆÎí¤¾Â[75]] as $a­‘ï¾í => $A¾°ğ××•) { $cºà‹–õº[$F„ˆÎí¤¾Â[75]][$a­‘ï¾í] = $this->folderInfo($A¾°ğ××•, $E’Ş™áÄ¤ ); } foreach ($cºà‹–õº[$F„ˆÎí¤¾Â[74]] as $a­‘ï¾í => $A¾°ğ××•) { $cºà‹–õº[$F„ˆÎí¤¾Â[74]][$a­‘ï¾í] = $this->fileInfo($A¾°ğ××•[$F„ˆÎí¤¾Â[28]], $E’Ş™áÄ¤ , $A¾°ğ××•); } return $cºà‹–õº; } private function fileInfo($EŒŠ‘éºö–, $D¿©›šİë´ = false, $c¹ò÷©ÓÕ… = array()) { goto e¼ÕÚÖ¤Œî; eˆİ±ğÑ™: if (isset($c¹ò÷©ÓÕ…[$AØ‡±‰Ì¨§[197]])) { $B¼‘Ç‘¬½[$AØ‡±‰Ì¨§[84]] = $c¹ò÷©ÓÕ…[$AØ‡±‰Ì¨§[197]]; } if (isset($c¹ò÷©ÓÕ…[$AØ‡±‰Ì¨§[78]])) { $B¼‘Ç‘¬½[$AØ‡±‰Ì¨§[78]] = $c¹ò÷©ÓÕ…[$AØ‡±‰Ì¨§[78]]; } return $B¼‘Ç‘¬½; goto FêŠÜ¤£õ; fÜå‚‘Ï†¸: $B¼‘Ç‘¬½[$AØ‡±‰Ì¨§[194]] = $B¼‘Ç‘¬½[$AØ‡±‰Ì¨§[84]] = 0; $B¼‘Ç‘¬½[$AØ‡±‰Ì¨§[195]] = $B¼‘Ç‘¬½[$AØ‡±‰Ì¨§[196]] = !0; if (empty($c¹ò÷©ÓÕ…)) { $c¹ò÷©ÓÕ… = $this->objectMeta($EŒŠ‘éºö–); if (!$c¹ò÷©ÓÕ…) { return $B¼‘Ç‘¬½; } } goto eˆİ±ğÑ™; e¼ÕÚÖ¤Œî: $AØ‡±‰Ì¨§ =& $_SERVER[¬¦ã¾]; $B¼‘Ç‘¬½ = array($AØ‡±‰Ì¨§[28] => $this->pathThis($EŒŠ‘éºö–), $AØ‡±‰Ì¨§[76] => $this->getPathOuter($EŒŠ‘éºö–), $AØ‡±‰Ì¨§[29] => $AØ‡±‰Ì¨§[193], $AØ‡±‰Ì¨§[168] => $this->ext($EŒŠ‘éºö–), $AØ‡±‰Ì¨§[78] => isset($c¹ò÷©ÓÕ…[$AØ‡±‰Ì¨§[78]]) ? $c¹ò÷©ÓÕ…[$AØ‡±‰Ì¨§[78]] : 0); if ($D¿©›šİë´) { return $B¼‘Ç‘¬½; } goto fÜå‚‘Ï†¸; FêŠÜ¤£õ: } private function folderInfo($a›ƒ±¹Ô­, $Bİçèó®à = false) { goto aò­Äáï”Ğ; aò­Äáï”Ğ: $d£ãÊŠêŞß =& $_SERVER[¬¦ã¾]; $d³ÍÎÈá¢‚ = array($d£ãÊŠêŞß[28] => $this->pathThis($a›ƒ±¹Ô­), $d£ãÊŠêŞß[76] => $this->getPathOuter($d£ãÊŠêŞß[8] . $a›ƒ±¹Ô­), $d£ãÊŠêŞß[29] => $d£ãÊŠêŞß[77]); if ($Bİçèó®à) { return $d³ÍÎÈá¢‚; } goto Eœ¡âÜ«÷; fÛ¿Å¦ïáÖ: return $d³ÍÎÈá¢‚; goto bëÕóô; eàËÉºŒİ‡: $a›ƒ±¹Ô­ = trim($a›ƒ±¹Ô­, $d£ãÊŠêŞß[8]) . $d£ãÊŠêŞß[8]; $c™ö·ÂŠğ = $this->objectMeta($a›ƒ±¹Ô­); if (isset($c™ö·ÂŠğ[$d£ãÊŠêŞß[197]])) { $d³ÍÎÈá¢‚[$d£ãÊŠêŞß[194]] = $c™ö·ÂŠğ[$d£ãÊŠêŞß[197]]; } goto fÛ¿Å¦ïáÖ; Eœ¡âÜ«÷: $d³ÍÎÈá¢‚[$d£ãÊŠêŞß[194]] = $d³ÍÎÈá¢‚[$d£ãÊŠêŞß[84]] = 0; $d³ÍÎÈá¢‚[$d£ãÊŠêŞß[195]] = $d³ÍÎÈá¢‚[$d£ãÊŠêŞß[196]] = !0; if ($a›ƒ±¹Ô­ == $d£ãÊŠêŞß[33]) { return $d³ÍÎÈá¢‚; } goto eàËÉºŒİ‡; bëÕóô: } private function fileList($aèÏÜÁŒŞƒ, $dÓ•çÜ„è‹ = '', $dë×óŠƒ… = 0) { goto aÉ‚ˆé²ò; aØ…Ù÷›ÃÉ: return array($bàƒÀØÔÓˆ[75] => $f¸´Æá™™ï, $bàƒÀØÔÓˆ[74] => $B¼®…ƒÑš¶); goto d¿ğ÷§Ù»Ù; dãï„‡½¶Ñ: foreach ($FÎ¤çÀ¯Õ[$bàƒÀØÔÓˆ[198]] as $AŞ¤º‰Šâ) { goto dÇ†»â‘øÀ; DŞæİ‚ßä¨: $B¼®…ƒÑš¶[] = $dë×óŠƒ… ? $AŞ¤º‰Šâ : $a¶ß°Õ¼µÎ; goto B·‡ìˆòš; dÇ†»â‘øÀ: $a¶ß°Õ¼µÎ = $AŞ¤º‰Šâ[$bàƒÀØÔÓˆ[28]]; if ($a¶ß°Õ¼µÎ == $EÑƒ˜ÏÂŒ) { continue; } $eù‚‰­—ÜÌ = isset($AŞ¤º‰Šâ[$bàƒÀØÔÓˆ[78]]) ? $AŞ¤º‰Šâ[$bàƒÀØÔÓˆ[78]] : 0; goto aÃ¹…¢©…†; aÃ¹…¢©…†: $C–”âƒŸ«‚ = $eù‚‰­—ÜÌ == 0 && substr($a¶ß°Õ¼µÎ, strlen($a¶ß°Õ¼µÎ) - 1, 1) == $bàƒÀØÔÓˆ[8] ? !0 : !1; if ($cµÛ›ÙÙó) { $this->cacheMethod($bàƒÀØÔÓˆ[199], $a¶ß°Õ¼µÎ, $C–”âƒŸ«‚); $this->cacheMethod($bàƒÀØÔÓˆ[200], $a¶ß°Õ¼µÎ, $AŞ¤º‰Šâ); } if ($C–”âƒŸ«‚) { $f¸´Æá™™ï[] = $a¶ß°Õ¼µÎ; continue; } goto DŞæİ‚ßä¨; B·‡ìˆòš: } foreach ($FÎ¤çÀ¯Õ[$bàƒÀØÔÓˆ[201]] as $AŞ¤º‰Šâ) { $f¸´Æá™™ï[] = $AŞ¤º‰Šâ[$bàƒÀØÔÓˆ[28]]; if ($cµÛ›ÙÙó) { $this->cacheMethod($bàƒÀØÔÓˆ[199], $AŞ¤º‰Šâ[$bàƒÀØÔÓˆ[28]], !0); } } if ($cµÛ›ÙÙó) { $this->cacheMethod($bàƒÀØÔÓˆ[199], $aèÏÜÁŒŞƒ, !0); } goto aØ…Ù÷›ÃÉ; aÉ‚ˆé²ò: $bàƒÀØÔÓˆ =& $_SERVER[¬¦ã¾]; $EÑƒ˜ÏÂŒ = rtrim($aèÏÜÁŒŞƒ, $bàƒÀØÔÓˆ[8]) . $bàƒÀØÔÓˆ[8]; $FÎ¤çÀ¯Õ = $this->listObjs($EÑƒ˜ÏÂŒ, null, null, $dÓ•çÜ„è‹); goto cµ„Ç×æƒ£; cµ„Ç×æƒ£: if (!$FÎ¤çÀ¯Õ) { return array($bàƒÀØÔÓˆ[75] => array(), $bàƒÀØÔÓˆ[74] => array()); } $cµÛ›ÙÙó = $this->listItemCache === !1 ? !1 : !0; $f¸´Æá™™ï = $B¼®…ƒÑš¶ = array(); goto dãï„‡½¶Ñ; d¿ğ÷§Ù»Ù: } private function listObjs($cÂŠŒÌ©¬ø, $AÊç‘ÙÖ°£ = null, $C³éŞ¸ÈÅ… = null, $aôÅç¼Ü´â = null) { $E‰ªùíº® =& $_SERVER[¬¦ã¾]; $cÂŠŒÌ©¬ø = trim($cÂŠŒÌ©¬ø, $E‰ªùíº®[8]); $C ¾¹õõ­ = empty($cÂŠŒÌ©¬ø) && $cÂŠŒÌ©¬ø !== $E‰ªùíº®[191] ? $E‰ªùíº®[33] : $cÂŠŒÌ©¬ø . $E‰ªùíº®[8]; return $this->client->getBucket($this->bucket, $C ¾¹õõ­, $AÊç‘ÙÖ°£, $C³éŞ¸ÈÅ…, $aôÅç¼Ü´â, !0); } public function has($EÁ‰‹ÃÄ„, $d¬Ö™Ğ£é = false, $Eİ£ÕÕäÙ˜ = true) { goto c±¿Ş”—¦; cŞ¡ãó¢ÎÍ: return !1; goto BáÃ•ÛŸ·Å; c±¿Ş”—¦: $Dí—¿Á”›µ =& $_SERVER[¬¦ã¾]; $EÁ‰‹ÃÄ„ = trim($EÁ‰‹ÃÄ„, $Dí—¿Á”›µ[8]); $DŸˆáù‹®­ = empty($EÁ‰‹ÃÄ„) && $EÁ‰‹ÃÄ„ !== $Dí—¿Á”›µ[191] ? $Dí—¿Á”›µ[33] : $EÁ‰‹ÃÄ„ . $Dí—¿Á”›µ[8]; goto cöçöï‚óŞ; cöçöï‚óŞ: $EÒ£°Ê½â» = null; $Dø»¬îîñÇ = 500; $c”±êãô¥Œ = $Dí—¿Á”›µ[8]; goto E¾†«Œô‚Ñ; E¾†«Œô‚Ñ: $b¦œ¼ËéÛ¦ = $C›»›¤ˆº = array(); while (!0) { $b‡×İ…–å = $this->listObjs($EÁ‰‹ÃÄ„, $EÒ£°Ê½â», $Dø»¬îîñÇ, $c”±êãô¥Œ); if (!$b‡×İ…–å) { break; } $EÒ£°Ê½â» = $b‡×İ…–å[$Dí—¿Á”›µ[202]]; $D„ÕÔ…³–Ò = $b‡×İ…–å[$Dí—¿Á”›µ[198]]; $E¯ö‹ä©ì† = $b‡×İ…–å[$Dí—¿Á”›µ[201]]; if (empty($D„ÕÔ…³–Ò) && empty($E¯ö‹ä©ì†)) { break; } if (count($D„ÕÔ…³–Ò) == 1 && $D„ÕÔ…³–Ò[0][$Dí—¿Á”›µ[28]] == $DŸˆáù‹®­) { break; } if ($d¬Ö™Ğ£é) { if (count($D„ÕÔ…³–Ò)) { $D„ÕÔ…³–Ò = array_column($D„ÕÔ…³–Ò, $Dí—¿Á”›µ[28]); $b¦œ¼ËéÛ¦ = array_merge($b¦œ¼ËéÛ¦, $D„ÕÔ…³–Ò); } if (count($E¯ö‹ä©ì†)) { $E¯ö‹ä©ì† = array_column($E¯ö‹ä©ì†, $Dí—¿Á”›µ[28]); $C›»›¤ˆº = array_merge($C›»›¤ˆº, $E¯ö‹ä©ì†); } if ($EÒ£°Ê½â» === null) { break; } continue; } if ($Eİ£ÕÕäÙ˜) { if (!empty($D„ÕÔ…³–Ò)) { if (count($D„ÕÔ…³–Ò) > 1 || isset($D„ÕÔ…³–Ò[0][$Dí—¿Á”›µ[28]]) && $D„ÕÔ…³–Ò[0][$Dí—¿Á”›µ[28]] != $DŸˆáù‹®­) { return !0; } } } else { if (!empty($E¯ö‹ä©ì†)) { return !0; } } if ($EÒ£°Ê½â» === null) { break; } } if ($d¬Ö™Ğ£é) { $b¦œ¼ËéÛ¦ = array_diff($b¦œ¼ËéÛ¦, array($DŸˆáù‹®­)); $b¦œ¼ËéÛ¦ = count(array_unique($b¦œ¼ËéÛ¦)); $C›»›¤ˆº = count(array_unique($C›»›¤ˆº)); return array($Dí—¿Á”›µ[203] => $b¦œ¼ËéÛ¦, $Dí—¿Á”›µ[204] => $C›»›¤ˆº); } goto cŞ¡ãó¢ÎÍ; BáÃ•ÛŸ·Å: } public function listAll($a¸øØö£…İ) { $fÉ™°é‹µ =& $_SERVER[¬¦ã¾]; $Eá²»Ç¬è = $this->fileList($a¸øØö£…İ, $fÉ™°é‹µ[33], !0); $FÇ”ÙÆÈß = array(); foreach ($Eá²»Ç¬è[$fÉ™°é‹µ[74]] as $d¶×ääÁÂ£) { $FÇ”ÙÆÈß[$d¶×ääÁÂ£[$fÉ™°é‹µ[28]]] = $d¶×ääÁÂ£[$fÉ™°é‹µ[78]]; } foreach ($Eá²»Ç¬è[$fÉ™°é‹µ[75]] as $d¶×ääÁÂ£) { if (is_string($d¶×ääÁÂ£)) { $FÇ”ÙÆÈß[$d¶×ääÁÂ£] = 0; } } return $this->listAllFiles($a¸øØö£…İ, array_keys($FÇ”ÙÆÈß), $FÇ”ÙÆÈß); } public function canRead($E†â£Û¶êã) { $B…Œ³ô’ñë =& $_SERVER[¬¦ã¾]; $aó¨Üõï = $this->client->getAccessControlPolicy($this->bucket, $E†â£Û¶êã); if (!$aó¨Üõï) { return !1; } return in_array($aó¨Üõï, array($B…Œ³ô’ñë[205], $B…Œ³ô’ñë[206], $B…Œ³ô’ñë[207])) ? !0 : !1; } public function canWrite($dÓ½”Ì×íø) { $fª¨‡¦¯Œ =& $_SERVER[¬¦ã¾]; $a„ä†Í¢Ãš = $this->client->getAccessControlPolicy($this->bucket, $dÓ½”Ì×íø); if (!$a„ä†Í¢Ãš) { return !1; } return in_array($a„ä†Í¢Ãš, array($fª¨‡¦¯Œ[205], $fª¨‡¦¯Œ[206])) ? !0 : !1; } public function getContent($F£¢·¶§™) { return $this->client->getObject($this->bucket, $F£¢·¶§™); } public function setContent($aˆŒéÀ”¤Æ, $E¶ÖÑ†ìŠå = '', $DõÛè®…æ = false) { goto A‰Ê®™‚Ìõ; c¿ÜçÄ°à: $bñŸóù–ğ = $this->client->putObject($E¶ÖÑ†ìŠå, $this->bucket, $aˆŒéÀ”¤Æ, $BòÎÂÃ’¿Ë[192], array(), $f¾ß”ÏÍè›); if (!$bñŸóù–ğ) { return !1; } if ($DõÛè®…æ) { return !0; } goto aõÔğ¯Î•; aõÔğ¯Î•: $this->cacheMethod(null, null); $bñŸóù–ğ = $this->copyFile($aˆŒéÀ”¤Æ, $aˆŒéÀ”¤Æ, array($BòÎÂÃ’¿Ë[208] => $bñŸóù–ğ[$BòÎÂÃ’¿Ë[209]])); return $bñŸóù–ğ ? !0 : !1; goto E“ù¿äÚêß; A‰Ê®™‚Ìõ: $BòÎÂÃ’¿Ë =& $_SERVER[¬¦ã¾]; $aˆŒéÀ”¤Æ = $DõÛè®…æ ? trim($aˆŒéÀ”¤Æ, $BòÎÂÃ’¿Ë[8]) . $BòÎÂÃ’¿Ë[8] : $aˆŒéÀ”¤Æ; $f¾ß”ÏÍè› = get_file_mime(get_path_ext($aˆŒéÀ”¤Æ)); goto c¿ÜçÄ°à; E“ù¿äÚêß: } public function fileSubstr($f¯ŒÂùĞ­ï, $cæÄ¼’ÕÍŒ, $DÈ‡ö‡÷ï…) { $c¡òŞøà¾ = $cæÄ¼’ÕÍŒ + $DÈ‡ö‡÷ï… - 1; return $this->client->getObject($this->bucket, $f¯ŒÂùĞ­ï, array($_SERVER[¬¦ã¾][210] => "\x62\x79\x74\x65\163\x3d{$cæÄ¼’ÕÍŒ}\x2d{$c¡òŞøà¾}")); } public function upload($Bòß»ñ•¡¬, $FÌË…„‚á, $fÓ§êÄ¡˜á = false, $c†§¥É‹‹æ = REPEAT_REPLACE) { $f¡¬â­Èâ =& $_SERVER[¬¦ã¾]; $B»Î…ÂŠ = array($f¡¬â­Èâ[208] => @md5_file($FÌË…„‚á)); $F†®©Ÿï“‡ = array($f¡¬â­Èâ[211] => get_file_mime(get_path_ext($Bòß»ñ•¡¬))); if (IO::size($FÌË…„‚á) <= 1024 * 1024 * 200) { $D…Œ“ßË—¯ = $this->client->putObjectFile($FÌË…„‚á, $this->bucket, $Bòß»ñ•¡¬, $f¡¬â­Èâ[192], $B»Î…ÂŠ, $F†®©Ÿï“‡); return !empty($D…Œ“ßË—¯) ? $this->getPathOuter($Bòß»ñ•¡¬) : !1; } $c„ë¸œˆÊÓ = $this->client->multiUploadObject($FÌË…„‚á, $this->bucket, trim($Bòß»ñ•¡¬, $f¡¬â­Èâ[8]), $B»Î…ÂŠ, $F†®©Ÿï“‡); return $c„ë¸œˆÊÓ ? $this->getPathOuter($Bòß»ñ•¡¬) : !1; } public function download($a“…¸×çÎ­, $A‰Æ¿äªÓ) { if (!@is_dir($this->pathFather($A‰Æ¿äªÓ)) && !IO::mkdir($this->pathFather($A‰Æ¿äªÓ))) { return !1; } $c‹ùÚÉˆ = $this->client->getObject($this->bucket, $a“…¸×çÎ­, array(), $A‰Æ¿äªÓ); return $c‹ùÚÉˆ !== !1 ? $A‰Æ¿äªÓ : !1; } public function link($E›äîƒÏÇ¼, $f×ò¡éÈ = array()) { $aâ”Ç÷˜¾Ô =& $_SERVER[¬¦ã¾]; if ($this->signVer == $aâ”Ç÷˜¾Ô[212]) { return $this->client->getAuthenticatedURL($this->bucket, $E›äîƒÏÇ¼, 3600 * 12, $f×ò¡éÈ); } return $this->client->getObjectUrl($this->accessKey, $this->secret, $this->bucket, trim($E›äîƒÏÇ¼, $aâ”Ç÷˜¾Ô[8]), 3600 * 12, $this->region, array(), !0, $f×ò¡éÈ); } public function fileOut($Dø¼’¯‘â½, $DøèİìÚÏ‘ = false, $dŠÇœ¤Œ¸ = false, $fî÷ºî×í¬ = '') { goto DÎ­¼‡ªÄ; e¤é½‚ÂÔ†: $Eå›¨³“ÜŸ = get_file_mime(get_path_ext($dŠÇœ¤Œ¸)); if ($Eå›¨³“ÜŸ == $féÁ‘‚·Ÿ[213]) { return parent::fileOut($Dø¼’¯‘â½, $DøèİìÚÏ‘, $dŠÇœ¤Œ¸, $fî÷ºî×í¬); } $DøèİìÚÏ‘ = $DøèİìÚÏ‘ ? $féÁ‘‚·Ÿ[214] : $féÁ‘‚·Ÿ[215]; goto CøìË¾ô¿È; CøìË¾ô¿È: $Cµ´¾®–’ì = array($féÁ‘‚·Ÿ[216] => $DøèİìÚÏ‘ . $féÁ‘‚·Ÿ[217] . rawurlencode($dŠÇœ¤Œ¸), $féÁ‘‚·Ÿ[218] => $Eå›¨³“ÜŸ); $a¬˜ƒñ±Çê = $this->link($Dø¼’¯‘â½, $Cµ´¾®–’ì); $this->fileOutLink($a¬˜ƒñ±Çê); goto föà–ãø¡Œ; DÎ­¼‡ªÄ: $féÁ‘‚·Ÿ =& $_SERVER[¬¦ã¾]; if ($this->isFileOutServer()) { return $this->fileOutServer($Dø¼’¯‘â½, $DøèİìÚÏ‘, $dŠÇœ¤Œ¸, $fî÷ºî×í¬); } if (!$dŠÇœ¤Œ¸) { $dŠÇœ¤Œ¸ = $this->pathThis($Dø¼’¯‘â½); } goto e¤é½‚ÂÔ†; föà–ãø¡Œ: } public function fileOutServer($fĞ˜÷†º‹, $D»§‹òìº´ = false, $A ¿ÂÜˆˆ® = false, $FÂ‘·æ¦ = '') { parent::fileOut($fĞ˜÷†º‹, $D»§‹òìº´, $A ¿ÂÜˆˆ®, $FÂ‘·æ¦); } public function fileOutImageServer($d¥ø‘‘î‡¾, $c‹Ó„›³ÈÈ = 250) { parent::fileOutImage($d¥ø‘‘î‡¾, $c‹Ó„›³ÈÈ); } public function hashMd5($dÀÂ‚ø¬æ´, $d¯Å§©£õë = '') { $EƒŒ«Ÿ¹Šì =& $_SERVER[¬¦ã¾]; $fœ…Ûøò  = $this->objectMeta($dÀÂ‚ø¬æ´); if (!$fœ…Ûøò ) { return !1; } $d¯Å§©£õë = $d¯Å§©£õë ? $d¯Å§©£õë : _get($fœ…Ûøò , $EƒŒ«Ÿ¹Šì[219]); $d¯Å§©£õë = $d¯Å§©£õë ? $d¯Å§©£õë : _get($fœ…Ûøò , $EƒŒ«Ÿ¹Šì[209], $EƒŒ«Ÿ¹Šì[33]); return $d¯Å§©£õë; } public function uploadFormData($CŞåğ™Øé, $BÊßßóÃ‰ó = 3600) { $bÓ†Š¶˜Õ =& $_SERVER[¬¦ã¾]; $E¼ˆĞàğ¶ = $this->pathFather($CŞåğ™Øé); $aÍÄœ¤Ğ¢ = $this->client->getHttpUploadPostParams($this->bucket, $E¼ˆĞàğ¶, $bÓ†Š¶˜Õ[192], $BÊßßóÃ‰ó); return array_merge((array) $aÍÄœ¤Ğ¢, array($bÓ†Š¶˜Õ[175] => $this->getHost())); } public function multiUploadFormData($Dñ˜Ê“Í™Š, $B·Ñ½ÉÏÍÂ = 3600) { $d³ó®Ãšê =& $_SERVER[¬¦ã¾]; $dÓ•ÏÂ™¡š = gmdate($d³ó®Ãšê[220]); $bÅ‡™–ìÄˆ = array(); $aµ‘­¹’ÜÏ = $this->client->getUploadId($this->bucket, $Dñ˜Ê“Í™Š, $bÅ‡™–ìÄˆ); if (!$aµ‘­¹’ÜÏ) { return !1; } return array($d³ó®Ãšê[221] => $aµ‘­¹’ÜÏ, $d³ó®Ãšê[175] => $this->getHost() . $d³ó®Ãšê[8] . $this->pathEncode($Dñ˜Ê“Í™Š), $d³ó®Ãšê[222] => $dÓ•ÏÂ™¡š, $d³ó®Ãšê[93] => $Dñ˜Ê“Í™Š); } public function multiUploadAuthData($F¶˜¼‚”¢‘, $dÎƒ¤ôÍ  = array()) { goto c©š²ªâ–­; d‰òºÀèÇ„: $E¾’âŒŞ–æ = $dÎƒ¤ôÍ [$e¼²Ê¯…[93]]; unset($dÎƒ¤ôÍ [$e¼²Ê¯…[93]]); if (isset($dÎƒ¤ôÍ [$e¼²Ê¯…[223]])) { $dÎƒ¤ôÍ [$e¼²Ê¯…[222]] = $Bî‹Áº¬¿; return $this->listUploadParts($E¾’âŒŞ–æ, $dÎƒ¤ôÍ ); } goto CôèÃ—¤ÍË; f±°œ«˜‰: $b¨£¦‹¶¾Ü = implode($e¼²Ê¯…[229], $Bˆ–½Û‹î); $FŞÁòè©Ü£ = base64_encode(hash_hmac($e¼²Ê¯…[230], $b¨£¦‹¶¾Ü, $this->secret, !0)); $e¥š¨¦Ê± = $e¼²Ê¯…[231] . $this->accessKey . $e¼²Ê¯…[4] . $FŞÁòè©Ü£; goto d†«”ô‚©º; d†«”ô‚©º: if (strpos($bÛáê“à’î, $e¼²Ê¯…[225]) === 0) { return array($e¼²Ê¯…[232] => $e¥š¨¦Ê±, $e¼²Ê¯…[222] => $Bî‹Áº¬¿); } return $e¥š¨¦Ê±; goto e¹¡ò‡¡¿³; c©š²ªâ–­: $e¼²Ê¯… =& $_SERVER[¬¦ã¾]; $Bî‹Áº¬¿ = isset($dÎƒ¤ôÍ [$e¼²Ê¯…[222]]) ? $dÎƒ¤ôÍ [$e¼²Ê¯…[222]] : gmdate($e¼²Ê¯…[220]); $bÛáê“à’î = isset($dÎƒ¤ôÍ [$e¼²Ê¯…[168]]) ? $dÎƒ¤ôÍ [$e¼²Ê¯…[168]] : $e¼²Ê¯…[33]; goto d‰òºÀèÇ„; CôèÃ—¤ÍË: $Bˆ–½Û‹î = array($e¼²Ê¯…[224], $e¼²Ê¯…[33], $e¼²Ê¯…[119], $e¼²Ê¯…[33], "\x78\x2d\x61\155\172\x2d\x64\x61\x74\145\72{$Bî‹Áº¬¿}", $e¼²Ê¯…[8] . $this->bucket . $e¼²Ê¯…[8] . $this->pathEncode($E¾’âŒŞ–æ) . $bÛáê“à’î); if (strpos($bÛáê“à’î, $e¼²Ê¯…[225]) === 0) { $Bˆ–½Û‹î[0] = $e¼²Ê¯…[226]; } if (isset($dÎƒ¤ôÍ [$e¼²Ê¯…[227]]) && $dÎƒ¤ôÍ [$e¼²Ê¯…[227]] == $e¼²Ê¯…[228]) { $Bˆ–½Û‹î[0] = $e¼²Ê¯…[228]; } goto f±°œ«˜‰; e¹¡ò‡¡¿³: } public function listUploadParts($cêÚµï¦™ß, $d”Æ‚àŠæ = array()) { goto FÅñ…÷ªæš; FœÕÆêì”Ä: if (!$dåù¯ëØ™) { return !1; } unset($d”Æ‚àŠæ[$cÍ–™è›ˆ[223]], $d”Æ‚àŠæ[$cÍ–™è›ˆ[227]]); $d”Æ‚àŠæ[$cÍ–™è›ˆ[93]] = $cêÚµï¦™ß; goto c¸”—¹³¡ø; FÅñ…÷ªæš: $cÍ–™è›ˆ =& $_SERVER[¬¦ã¾]; $aÍÌªãáê® = str_replace($cÍ–™è›ˆ[233], $cÍ–™è›ˆ[33], $d”Æ‚àŠæ[$cÍ–™è›ˆ[168]]); $dåù¯ëØ™ = $this->client->listParts($this->bucket, $cêÚµï¦™ß, $aÍÌªãáê®); goto FœÕÆêì”Ä; c¸”—¹³¡ø: $E¦¡‹î®¨¸ = $this->multiUploadAuthData($cêÚµï¦™ß, $d”Æ‚àŠæ); if (empty($E¦¡‹î®¨¸)) { return !1; } return array($cÍ–™è›ˆ[232] => $E¦¡‹î®¨¸, $cÍ–™è›ˆ[222] => $d”Æ‚àŠæ[$cÍ–™è›ˆ[222]], $cÍ–™è›ˆ[234] => $dåù¯ëØ™); goto fÚ‹†Ñ£Ú; fÚ‹†Ñ£Ú: } public function getHost() { return parent::getHost() . $_SERVER[¬¦ã¾][8] . $this->bucket; } public function size($FÍÌä¥Øä) { $b¥ÙÒçµá = $this->objectMeta($FÍÌä¥Øä); return $b¥ÙÒçµá ? $b¥ÙÒçµá[$_SERVER[¬¦ã¾][78]] : 0; } public function info($bÌãó¨äÛ•) { if ($this->isFolder($bÌãó¨äÛ•)) { return $this->folderInfo($bÌãó¨äÛ•); } else { if ($this->isFile($bÌãó¨äÛ•)) { return $this->fileInfo($bÌãó¨äÛ•); } } return !1; } public function exist($b¯¬„É®) { return $this->isFile($b¯¬„É®) || $this->isFolder($b¯¬„É®); } public function isFile($eªášÎ´) { return !$this->isFolder($eªášÎ´) && $this->objectMeta($eªášÎ´); } public function isFolder($dÛìø±¼Ş´) { return $this->cacheMethod($_SERVER[¬¦ã¾][199], $dÛìø±¼Ş´); } protected function objectMeta($b››øåÔÌĞ) { return $this->cacheMethod($_SERVER[¬¦ã¾][200], $b››øåÔÌĞ); } protected function _objectMeta($BØ¼ö¶©Úœ) { $eˆùÙŠ©Á =& $_SERVER[¬¦ã¾]; $BØ¼ö¶©Úœ = rtrim($BØ¼ö¶©Úœ, $eˆùÙŠ©Á[8]); try { $B‹øŒ´âÕ” = $this->client->getObjectInfo($this->bucket, $BØ¼ö¶©Úœ); if (!isset($B‹øŒ´âÕ”[$eˆùÙŠ©Á[219]]) && isset($B‹øŒ´âÕ”[$eˆùÙŠ©Á[235]])) { $B‹øŒ´âÕ”[$eˆùÙŠ©Á[219]] = $B‹øŒ´âÕ”[$eˆùÙŠ©Á[235]]; } } catch (Exception $Fã­•ó’) { $B‹øŒ´âÕ” = !1; } if (!$B‹øŒ´âÕ”) { } return $B‹øŒ´âÕ”; } protected function _isFolder($C„—ù¿ã) { goto AñØ½¯ëĞ; AñØ½¯ëĞ: $BËöÂì²ï =& $_SERVER[¬¦ã¾]; $C„—ù¿ã = rtrim($C„—ù¿ã, $BËöÂì²ï[8]); if ($C„—ù¿ã == $BËöÂì²ï[33] || $C„—ù¿ã == $BËöÂì²ï[8]) { return !0; } goto cùÅŸÔÊñé; e¨õÂ˜‘ê: return !0; goto C ¸é Ê‹Ä; E´çí¿Àö©: return stripos($Eô™İÛğî, $C„—ù¿ã . $BËöÂì²ï[8]) === 0 ? !0 : !1; if (substr($Eô™İÛğî, -1) == $BËöÂì²ï[8]) { return !0; } if (get_path_this($Eô™İÛğî) == get_path_this($C„—ù¿ã)) { return !1; } goto e¨õÂ˜‘ê; cùÅŸÔÊñé: $f¢­å¹Š¦« = $this->client->getBucket($this->bucket, $C„—ù¿ã, null, 1); if (empty($f¢­å¹Š¦«[$BËöÂì²ï[198]])) { return !1; } $Eô™İÛğî = $f¢­å¹Š¦«[$BËöÂì²ï[198]][0][$BËöÂì²ï[28]]; goto E´çí¿Àö©; C ¸é Ê‹Ä: } } define($_SERVER[¬¦ã¾][236], 1); goto E„¶…š˜•¼; A’œ‡›¿¹£: class TaskUnzip extends TaskFileTransfer { protected function startAfter() { goto F¤Ó“«¹”; F¤Ó“«¹”: $aøíÂ÷Å¬™ =& $_SERVER[¬¦ã¾]; parent::startAfter(); Hook::bind($aøíÂ÷Å¬™[1606], array($this, $aøíÂ÷Å¬™[1607])); goto Dë„ˆ†í­Ò; Dë„ˆ†í­Ò: Hook::bind($aøíÂ÷Å¬™[1080], array($this, $aøíÂ÷Å¬™[1608])); $cÊ­óë”ªä =& $this->task; $cÊ­óë”ªä[$aøíÂ÷Å¬™[1609]] = $aøíÂ÷Å¬™[1085]; goto C¥„í‚Œ¢»; C¥„í‚Œ¢»: if (!$cÊ­óë”ªä[$aøíÂ÷Å¬™[1426]]) { $cÊ­óë”ªä[$aøíÂ÷Å¬™[1426]] = LNG($aøíÂ÷Å¬™[1610]); } goto eÌøˆÚ¯‡Ú; eÌøˆÚ¯‡Ú: } protected function endAfter() { $eÔ¹ç¹ÛÛ =& $_SERVER[¬¦ã¾]; parent::endAfter(); Hook::unbind($eÔ¹ç¹ÛÛ[1606], array($this, $eÔ¹ç¹ÛÛ[1607])); Hook::unbind($eÔ¹ç¹ÛÛ[1080], array($this, $eÔ¹ç¹ÛÛ[1608])); } public function updateAfter() { $bàÒ„Ê÷Æ³ =& $_SERVER[¬¦ã¾]; $bÈíƒœáòæ =& $this->task; if (!$bÈíƒœáòæ[$bàÒ„Ê÷Æ³[1012]] || !$bÈíƒœáòæ[$bàÒ„Ê÷Æ³[715]]) { return; } if ($bÈíƒœáòæ[$bàÒ„Ê÷Æ³[1609]] == $bàÒ„Ê÷Æ³[1085]) { $fŸ™µ•ˆÃñ = 0; if ($bÈíƒœáòæ[$bàÒ„Ê÷Æ³[1565]]) { $fŸ™µ•ˆÃñ = $bÈíƒœáòæ[$bàÒ„Ê÷Æ³[1566]] / $bÈíƒœáòæ[$bàÒ„Ê÷Æ³[1565]]; } $bÈíƒœáòæ[$bàÒ„Ê÷Æ³[1521]] = $fŸ™µ•ˆÃñ * 0.3; } else { if ($bÈíƒœáòæ[$bàÒ„Ê÷Æ³[1609]] == $bàÒ„Ê÷Æ³[311]) { $fŸ™µ•ˆÃñ = $bÈíƒœáòæ[$bàÒ„Ê÷Æ³[1027]] / $bÈíƒœáòæ[$bàÒ„Ê÷Æ³[1012]]; $bÈíƒœáòæ[$bàÒ„Ê÷Æ³[1521]] = 0.3 + $fŸ™µ•ˆÃñ * 0.4; } else { if ($bÈíƒœáòæ[$bàÒ„Ê÷Æ³[1609]] == $bàÒ„Ê÷Æ³[107]) { $EàÍ¯Óáè‹ = 0; if ($bÈíƒœáòæ[$bàÒ„Ê÷Æ³[1567]] == $bàÒ„Ê÷Æ³[107]) { $EàÍ¯Óáè‹ = $bÈíƒœáòæ[$bàÒ„Ê÷Æ³[1566]]; } $fŸ™µ•ˆÃñ = ($bÈíƒœáòæ[$bàÒ„Ê÷Æ³[1570]] + $EàÍ¯Óáè‹) / $bÈíƒœáòæ[$bàÒ„Ê÷Æ³[715]]; $bÈíƒœáòæ[$bàÒ„Ê÷Æ³[1521]] = 0.3 + 0.4 + $fŸ™µ•ˆÃñ * 0.3; } } } if ($bÈíƒœáòæ[$bàÒ„Ê÷Æ³[1521]] > 0) { $cß‰½±°¾Ü = timeFloat() - $bÈíƒœáòæ[$bàÒ„Ê÷Æ³[741]] - $bÈíƒœáòæ[$bàÒ„Ê÷Æ³[1524]]; $bÈíƒœáòæ[$bàÒ„Ê÷Æ³[1525]] = $cß‰½±°¾Ü * (1 - $bÈíƒœáòæ[$bàÒ„Ê÷Æ³[1521]]) / $bÈíƒœáòæ[$bàÒ„Ê÷Æ³[1521]]; } } public function addFile($CÃ–Œ´ÉÄÀ) { goto dÉ¬ò”×…“; C©“­ÕÀÀš: $this->update(); goto ağ¾ˆ ›ŸÒ; EäÆ…¨‡: $Eˆˆ„º¡‘‘[$f¶¾Ğ›‘Ñø[1014]] = $f¶¾Ğ›‘Ñø[1585]; $Eˆˆ„º¡‘‘[$f¶¾Ğ›‘Ñø[1567]] = $f¶¾Ğ›‘Ñø[1085]; $Eˆˆ„º¡‘‘[$f¶¾Ğ›‘Ñø[715]] = $E™‰ÓŸ·õ™[$f¶¾Ğ›‘Ñø[78]]; goto B¿ÕÊÈ–¿Ä; B¿ÕÊÈ–¿Ä: $Eˆˆ„º¡‘‘[$f¶¾Ğ›‘Ñø[1012]] = 1; $eÙŒæÛ¡§ = 0; $Eˆˆ„º¡‘‘[$f¶¾Ğ›‘Ñø[1574]] = array($f¶¾Ğ›‘Ñø[1575] => $eÙŒæÛ¡§ + 1, $f¶¾Ğ›‘Ñø[413] => $E™‰ÓŸ·õ™[$f¶¾Ğ›‘Ñø[28]], $f¶¾Ğ›‘Ñø[76] => $E™‰ÓŸ·õ™[$f¶¾Ğ›‘Ñø[76]], $f¶¾Ğ›‘Ñø[495] => $E™‰ÓŸ·õ™[$f¶¾Ğ›‘Ñø[495]] ? $E™‰ÓŸ·õ™[$f¶¾Ğ›‘Ñø[495]] : $E™‰ÓŸ·õ™[$f¶¾Ğ›‘Ñø[76]]); goto C©“­ÕÀÀš; D½‘Û¼Å¤Ú: $Eˆˆ„º¡‘‘[$f¶¾Ğ›‘Ñø[1563]] = $E™‰ÓŸ·õ™[$f¶¾Ğ›‘Ñø[28]]; $Eˆˆ„º¡‘‘[$f¶¾Ğ›‘Ñø[1565]] = $E™‰ÓŸ·õ™[$f¶¾Ğ›‘Ñø[78]]; $Eˆˆ„º¡‘‘[$f¶¾Ğ›‘Ñø[1566]] = 0; goto EäÆ…¨‡; dÉ¬ò”×…“: $f¶¾Ğ›‘Ñø =& $_SERVER[¬¦ã¾]; $Eˆˆ„º¡‘‘ =& $this->task; $E™‰ÓŸ·õ™ = IO::info($CÃ–Œ´ÉÄÀ); goto D½‘Û¼Å¤Ú; ağ¾ˆ ›ŸÒ: } public function unzipAfter($B„Í¸Å°Àğ) { goto d‘éÍÓƒÂ; D“µ»’çòê: $AâÚ»Øõî„[$d•ìšÈ†ˆŞ[1563]] = $d•ìšÈ†ˆŞ[33]; $AâÚ»Øõî„[$d•ìšÈ†ˆŞ[1570]] = 0; $AâÚ»Øõî„[$d•ìšÈ†ˆŞ[715]] = $AÁ“‰¹µ‘[$d•ìšÈ†ˆŞ[78]]; goto c¬”¬œÈÀ; A¡¾¹ãø: $AâÚ»Øõî„[$d•ìšÈ†ˆŞ[1027]] = 0; $AâÚ»Øõî„[$d•ìšÈ†ˆŞ[1565]] = 0; $AâÚ»Øõî„[$d•ìšÈ†ˆŞ[1566]] = 0; goto D“µ»’çòê; b…ÔÕÌäó¨: $AÁ“‰¹µ‘ = IO::infoWithChildren($B„Í¸Å°Àğ); $B„ÇêîºŠ = 0; $AâÚ»Øõî„[$d•ìšÈ†ˆŞ[1574]] = array($d•ìšÈ†ˆŞ[1575] => $B„ÇêîºŠ + 1, $d•ìšÈ†ˆŞ[413] => $AÁ“‰¹µ‘[$d•ìšÈ†ˆŞ[28]], $d•ìšÈ†ˆŞ[76] => $AÁ“‰¹µ‘[$d•ìšÈ†ˆŞ[76]], $d•ìšÈ†ˆŞ[495] => $AÁ“‰¹µ‘[$d•ìšÈ†ˆŞ[495]] ? $AÁ“‰¹µ‘[$d•ìšÈ†ˆŞ[495]] : $AÁ“‰¹µ‘[$d•ìšÈ†ˆŞ[76]]); goto DÁ¹ÎŠµ œ; DÁ¹ÎŠµ œ: if ($AÁ“‰¹µ‘[$d•ìšÈ†ˆŞ[29]] == $d•ìšÈ†ˆŞ[193]) { $AâÚ»Øõî„[$d•ìšÈ†ˆŞ[1012]] = 1; } else { $AâÚ»Øõî„[$d•ìšÈ†ˆŞ[1012]] = $AÁ“‰¹µ‘[$d•ìšÈ†ˆŞ[81]][$d•ìšÈ†ˆŞ[79]]; } $AâÚ»Øõî„[$d•ìšÈ†ˆŞ[1014]] = $d•ìšÈ†ˆŞ[33]; $AâÚ»Øõî„[$d•ìšÈ†ˆŞ[1567]] = 0; goto A¡¾¹ãø; c¬”¬œÈÀ: $this->update(); self::log($d•ìšÈ†ˆŞ[1611] . json_encode(array($AâÚ»Øõî„, $AÁ“‰¹µ‘))); goto BÄ”á•‡ï; d‘éÍÓƒÂ: $d•ìšÈ†ˆŞ =& $_SERVER[¬¦ã¾]; $AâÚ»Øõî„ =& $this->task; $AâÚ»Øõî„[$d•ìšÈ†ˆŞ[1609]] = $d•ìšÈ†ˆŞ[107]; goto b…ÔÕÌäó¨; BÄ”á•‡ï: } public function nameParse($e‘¾–ÆâŞ²) { goto D®—éÄ­à; aÜªâÄÎ”: $this->update(); goto DÖ‡„Âá; D®—éÄ­à: $b˜‹’‹àö =& $_SERVER[¬¦ã¾]; $fçøš¬‹é =& $this->task; if ($fçøš¬‹é[$b˜‹’‹àö[1609]] == $b˜‹’‹àö[1085]) { $fçøš¬‹é[$b˜‹’‹àö[1609]] = $b˜‹’‹àö[311]; $fçøš¬‹é[$b˜‹’‹àö[1570]] = 0; $fçøš¬‹é[$b˜‹’‹àö[715]] = 0; } goto B¢¶Ò—èÄ¤; B¢¶Ò—èÄ¤: $c‹ÚÍŒ»Ùƒ = get_path_this($e‘¾–ÆâŞ²); if (strstr($c‹ÚÍŒ»Ùƒ, $b˜‹’‹àö[95])) { $fçøš¬‹é[$b˜‹’‹àö[1027]] += 1; $fçøš¬‹é[$b˜‹’‹àö[1012]] += 1; } $fçøš¬‹é[$b˜‹’‹àö[1563]] = $e‘¾–ÆâŞ²; goto aÜªâÄÎ”; DÖ‡„Âá: } } class TaskZip extends TaskFileTransfer { protected function startAfter() { $b­½¸™×î =& $_SERVER[¬¦ã¾]; parent::startAfter(); Hook::bind($b­½¸™×î[1612], array($this, $b­½¸™×î[1607])); $a¯§Ê§Š¦ø =& $this->task; $a¯§Ê§Š¦ø[$b­½¸™×î[1609]] = $b­½¸™×î[1085]; if (!$a¯§Ê§Š¦ø[$b­½¸™×î[1426]]) { $a¯§Ê§Š¦ø[$b­½¸™×î[1426]] = LNG($b­½¸™×î[1613]); } } protected function endAfter() { $e¯ÊæõÈõì =& $_SERVER[¬¦ã¾]; parent::endAfter(); Hook::unbind($e¯ÊæõÈõì[1612], array($this, $e¯ÊæõÈõì[1607])); } public function updateAfter() { $B‰Ú‚ğ‹È° =& $_SERVER[¬¦ã¾]; $C”×ë‚à¡Ÿ =& $this->task; if (!$C”×ë‚à¡Ÿ[$B‰Ú‚ğ‹È°[1012]] || !$C”×ë‚à¡Ÿ[$B‰Ú‚ğ‹È°[715]]) { return; } if ($C”×ë‚à¡Ÿ[$B‰Ú‚ğ‹È°[1609]] == $B‰Ú‚ğ‹È°[1085]) { $DƒÕ½¶á¹ = $C”×ë‚à¡Ÿ[$B‰Ú‚ğ‹È°[1566]]; if ($C”×ë‚à¡Ÿ[$B‰Ú‚ğ‹È°[1567]] != $B‰Ú‚ğ‹È°[1085]) { $DƒÕ½¶á¹ = 0; } $aöÏĞ–†ä = ($C”×ë‚à¡Ÿ[$B‰Ú‚ğ‹È°[1570]] + $DƒÕ½¶á¹) / $C”×ë‚à¡Ÿ[$B‰Ú‚ğ‹È°[715]]; $C”×ë‚à¡Ÿ[$B‰Ú‚ğ‹È°[1521]] = $aöÏĞ–†ä * 0.3; } else { if ($C”×ë‚à¡Ÿ[$B‰Ú‚ğ‹È°[1609]] == $B‰Ú‚ğ‹È°[311]) { $aöÏĞ–†ä = $C”×ë‚à¡Ÿ[$B‰Ú‚ğ‹È°[1027]] / $C”×ë‚à¡Ÿ[$B‰Ú‚ğ‹È°[1012]]; $C”×ë‚à¡Ÿ[$B‰Ú‚ğ‹È°[1521]] = 0.3 + $aöÏĞ–†ä * 0.5; } else { if ($C”×ë‚à¡Ÿ[$B‰Ú‚ğ‹È°[1609]] == $B‰Ú‚ğ‹È°[107]) { $aöÏĞ–†ä = 0; if ($C”×ë‚à¡Ÿ[$B‰Ú‚ğ‹È°[1565]]) { $aöÏĞ–†ä = $C”×ë‚à¡Ÿ[$B‰Ú‚ğ‹È°[1566]] / $C”×ë‚à¡Ÿ[$B‰Ú‚ğ‹È°[1565]]; } $C”×ë‚à¡Ÿ[$B‰Ú‚ğ‹È°[1521]] = 0.3 + 0.5 + $aöÏĞ–†ä * 0.2; } } } if ($C”×ë‚à¡Ÿ[$B‰Ú‚ğ‹È°[1521]] > 0) { $FÒë×†ÉƒÀ = timeFloat() - $C”×ë‚à¡Ÿ[$B‰Ú‚ğ‹È°[741]] - $C”×ë‚à¡Ÿ[$B‰Ú‚ğ‹È°[1524]]; $C”×ë‚à¡Ÿ[$B‰Ú‚ğ‹È°[1525]] = $FÒë×†ÉƒÀ * (1 - $C”×ë‚à¡Ÿ[$B‰Ú‚ğ‹È°[1521]]) / $C”×ë‚à¡Ÿ[$B‰Ú‚ğ‹È°[1521]]; } } public function copyFileStart($F§ßÖ©Î¹å, $c³ó‘œá, $e‡É˜Ííö, $B¢ªÓ¤Ü¢, $AÇÓò¬•Ô, $c¬”ÉÅœĞĞ) { $b‚ÊéÛğ•Ø =& $_SERVER[¬¦ã¾]; parent::copyFileStart($F§ßÖ©Î¹å, $c³ó‘œá, $e‡É˜Ííö, $B¢ªÓ¤Ü¢, $AÇÓò¬•Ô, $c¬”ÉÅœĞĞ); $EÕ“•‚‡ˆœ =& $this->task; if ($EÕ“•‚‡ˆœ[$b‚ÊéÛğ•Ø[1609]] == $b‚ÊéÛğ•Ø[311]) { $EÕ“•‚‡ˆœ[$b‚ÊéÛğ•Ø[1609]] = $b‚ÊéÛğ•Ø[107]; } $this->update(); } public function copyFileEnd($eç‚Ê»—Š¹, $eÇç¿§íÜî, $d’Î¸İœğ±, $f˜Ò¡–óÊà, $d¼ùöÍ‹¯°, $e¼ÎÜğĞ¬Â) { $A¦ğâ•¶Ğ¼ =& $_SERVER[¬¦ã¾]; $C»˜á¬í„Ş =& $this->task; $C»˜á¬í„Ş[$A¦ğâ•¶Ğ¼[1566]] = $C»˜á¬í„Ş[$A¦ğâ•¶Ğ¼[1565]]; $C»˜á¬í„Ş[$A¦ğâ•¶Ğ¼[1570]] += $C»˜á¬í„Ş[$A¦ğâ•¶Ğ¼[1565]]; $C»˜á¬í„Ş[$A¦ğâ•¶Ğ¼[1567]] = $A¦ğâ•¶Ğ¼[33]; $this->update(); } public function nameParse($Bƒ¥˜„¥«) { $c¤Á­•‘¼ù =& $_SERVER[¬¦ã¾]; $FÖ•Ü˜àî˜ =& $this->task; if ($FÖ•Ü˜àî˜[$c¤Á­•‘¼ù[1027]] < $FÖ•Ü˜àî˜[$c¤Á­•‘¼ù[1012]]) { $eÑåÓ‡îšİ = get_path_this($Bƒ¥˜„¥«); if (strstr($eÑåÓ‡îšİ, $c¤Á­•‘¼ù[95])) { $FÖ•Ü˜àî˜[$c¤Á­•‘¼ù[1027]] += 1; } } if ($FÖ•Ü˜àî˜[$c¤Á­•‘¼ù[1609]] == $c¤Á­•‘¼ù[1085]) { $FÖ•Ü˜àî˜[$c¤Á­•‘¼ù[1609]] = $c¤Á­•‘¼ù[311]; } $FÖ•Ü˜àî˜[$c¤Á­•‘¼ù[1563]] = $Bƒ¥˜„¥«; $this->update(); } } class AnalysisModel extends ModelBaseLight { public function init($E‰šƒ¹„‚œ) { $Aø×ù¸Ñ›Ÿ =& $_SERVER[¬¦ã¾]; $e„«ƒâ¸† = array($Aø×ù¸Ñ›Ÿ[562] => array($Aø×ù¸Ñ›Ÿ[29] => $Aø×ù¸Ñ›Ÿ[1614], $Aø×ù¸Ñ›Ÿ[271] => array($Aø×ù¸Ñ›Ÿ[222], $Aø×ù¸Ñ›Ÿ[717], $Aø×ù¸Ñ›Ÿ[1615], $Aø×ù¸Ñ›Ÿ[1616])), $Aø×ù¸Ñ›Ÿ[1617] => array($Aø×ù¸Ñ›Ÿ[29] => $Aø×ù¸Ñ›Ÿ[1618], $Aø×ù¸Ñ›Ÿ[271] => array($Aø×ù¸Ñ›Ÿ[222], $Aø×ù¸Ñ›Ÿ[715], $Aø×ù¸Ñ›Ÿ[1619], $Aø×ù¸Ñ›Ÿ[1620], $Aø×ù¸Ñ›Ÿ[1621]))); if (!isset($e„«ƒâ¸†[$E‰šƒ¹„‚œ])) { return !1; } $this->optionType = $e„«ƒâ¸†[$E‰šƒ¹„‚œ][$Aø×ù¸Ñ›Ÿ[29]]; $this->field = $e„«ƒâ¸†[$E‰šƒ¹„‚œ][$Aø×ù¸Ñ›Ÿ[271]]; return !0; } public function listData($e“¼å½»³ = false, $EŸ¼ó÷°Áó = "\x6d\157\x64\x69\146\x79\124\151\x6d\x65", $báñ¾£æÔ = false) { return parent::listData($e“¼å½»³, $EŸ¼ó÷°Áó, $báñ¾£æÔ); } public function trendList($b£ÕÅ¹ÚÂè) { goto E¡ÄÁÁ¿‚Î; EÚÓ½Û‘œ¸: if (!isset($bÂ÷¼âÔíÜ)) { $AÁÕÄÔ†¬è = $b£ÕÅ¹ÚÂè == $Fª†§õÜë[562] ? $Fª†§õÜë[506] : $Fª†§õÜë[782]; $bÂ÷¼âÔíÜ = Model($AÁÕÄÔ†¬è)->min($Fª†§õÜë[194]); } $eÀº…ò’™Ã = $Fª†§õÜë[1624] . ucfirst($b£ÕÅ¹ÚÂè); $F†¢Ğ¼Ü = $this->dateList($bÂ÷¼âÔíÜ); goto Dìï³÷š—†; Dìï³÷š—†: foreach ($F†¢Ğ¼Ü as $dØÎŒÆ¤œ„) { $this->{$eÀº…ò’™Ã}($dØÎŒÆ¤œ„); } return $this->listData(); goto c´£âƒ‚ô„; E¡ÄÁÁ¿‚Î: $Fª†§õÜë =& $_SERVER[¬¦ã¾]; $C±Š„¾˜Š = $this->listData(); if ($C±Š„¾˜Š) { $E÷Æó‘¾å¦ = end($C±Š„¾˜Š); $dØÎŒÆ¤œ„ = date($Fª†§õÜë[1622], strtotime($Fª†§õÜë[1623])); if ($E÷Æó‘¾å¦[$Fª†§õÜë[222]] == $dØÎŒÆ¤œ„) { return $C±Š„¾˜Š; } $bÂ÷¼âÔíÜ = strtotime($E÷Æó‘¾å¦[$Fª†§õÜë[222]]); } goto EÚÓ½Û‘œ¸; c´£âƒ‚ô„: } private function dateList($C´¾ÙœŞàï) { $bÆãÔÄƒÙõ =& $_SERVER[¬¦ã¾]; $Eô¢œ¯èë› = $C´¾ÙœŞàï; $E×Ñ³ÑÅ¿À = strtotime($bÆãÔÄƒÙõ[1623]); $B‰…ÈÄ‹Ô‰ = array(); while ($Eô¢œ¯èë› <= $E×Ñ³ÑÅ¿À) { $B‰…ÈÄ‹Ô‰[] = date($bÆãÔÄƒÙõ[1622], $Eô¢œ¯èë›); $Eô¢œ¯èë› = strtotime($bÆãÔÄƒÙõ[1625], $Eô¢œ¯èë›); } return $B‰…ÈÄ‹Ô‰; } public function _recordUser($dÍ£ìåÒŒ = '') { goto a‡ôÖÀ’©; a‡ôÖÀ’©: $EÜ¬êµÆø =& $_SERVER[¬¦ã¾]; $eç¿Àòî·’ = strtotime(date($EÜ¬êµÆø[1626], strtotime($dÍ£ìåÒŒ))); $c¯¦‡˜÷àÅ = strtotime(date($EÜ¬êµÆø[1627], strtotime($dÍ£ìåÒŒ))); goto Eö˜•ÂŠÀ«; Eö˜•ÂŠÀ«: $D¯Œ®ò×£â = array($EÜ¬êµÆø[194] => array($EÜ¬êµÆø[961], $c¯¦‡˜÷àÅ)); $a ßˆ ¶¤¦ = Model($EÜ¬êµÆø[506])->where($D¯Œ®ò×£â)->count($EÜ¬êµÆø[1520]); $D¯Œ®ò×£â[$EÜ¬êµÆø[194]] = array($EÜ¬êµÆø[331], array($eç¿Àòî·’, $c¯¦‡˜÷àÅ)); goto BÄâŸÀ©ˆ; Fšó§·Ş§ƒ: $DÆ ŒÓµ½ = array($EÜ¬êµÆø[222] => $dÍ£ìåÒŒ, $EÜ¬êµÆø[717] => (int) $a ßˆ ¶¤¦, $EÜ¬êµÆø[1615] => (int) $BéÓÙ«ô¨ç, $EÜ¬êµÆø[1616] => (int) $D˜Ÿ…Æ‰ïˆ); return $this->insert($DÆ ŒÓµ½); goto D™†ÍÓ¶Æ; BÄâŸÀ©ˆ: $BéÓÙ«ô¨ç = Model($EÜ¬êµÆø[506])->where($D¯Œ®ò×£â)->count($EÜ¬êµÆø[1520]); $D¯Œ®ò×£â[$EÜ¬êµÆø[29]] = $EÜ¬êµÆø[1628]; $D˜Ÿ…Æ‰ïˆ = Model($EÜ¬êµÆø[1629])->where($D¯Œ®ò×£â)->count($EÜ¬êµÆø[1630]); goto Fšó§·Ş§ƒ; D™†ÍÓ¶Æ: } public function _recordStore($AÂõ¯“à† = '') { goto e‘÷¢¹ã¥; aÓÉ´»áìá: $EšÛ¼¦²«Å = Model($f‡Àê’—ÆÎ[782])->where($CÕóêë·Üà)->sum($f‡Àê’—ÆÎ[78]); $fíµ™º¾Î = array($f‡Àê’—ÆÎ[222] => $AÂõ¯“à†, $f‡Àê’—ÆÎ[715] => (int) $C°ÊÇÓà•, $f‡Àê’—ÆÎ[1619] => (int) $cµáÑóè , $f‡Àê’—ÆÎ[1620] => (int) $Fš®ßí£´ë, $f‡Àê’—ÆÎ[1621] => (int) $EšÛ¼¦²«Å); return $this->insert($fíµ™º¾Î); goto eÄÏ·ÎŞô; a–¥ğ¬–: $cµáÑóè  = Model($f‡Àê’—ÆÎ[450])->where($CÕóêë·Üà)->sum($f‡Àê’—ÆÎ[78]); $CÕóêë·Üà[$f‡Àê’—ÆÎ[403]] = 0; $C°ÊÇÓà• = Model($f‡Àê’—ÆÎ[782])->where($CÕóêë·Üà)->sum($f‡Àê’—ÆÎ[78]); goto dËëÚ¤ÉÑ‹; dËëÚ¤ÉÑ‹: $CÕóêë·Üà[$f‡Àê’—ÆÎ[404]] = 1; $Fš®ßí£´ë = Model($f‡Àê’—ÆÎ[782])->where($CÕóêë·Üà)->sum($f‡Àê’—ÆÎ[78]); $CÕóêë·Üà[$f‡Àê’—ÆÎ[404]] = 2; goto aÓÉ´»áìá; e‘÷¢¹ã¥: $f‡Àê’—ÆÎ =& $_SERVER[¬¦ã¾]; $dõµº¿ñ‹‘ = strtotime(date($f‡Àê’—ÆÎ[1627], strtotime($AÂõ¯“à†))); $CÕóêë·Üà = array($f‡Àê’—ÆÎ[194] => array($f‡Àê’—ÆÎ[961], $dõµº¿ñ‹‘)); goto a–¥ğ¬–; eÄÏ·ÎŞô: } public function trend($C®ƒÚòŒÌ‹, $a™¨¨Õ®ê›) { goto dØ…‚Ûß‚; CÈ¤—ĞÏ‡‘: if ($e»ªÕùã‘¾ && $a™¨¨Õ®ê› != $BØ¸•ğÊ[1494]) { $eïÙÑŠËõ = $e»ªÕùã‘¾[0][$BØ¸•ğÊ[222]]; $fß‡öáìÎ = $this->validDate($a™¨¨Õ®ê›, $eïÙÑŠËõ); $bÆÓíŠ¡á£ = array(); $F‚İ°ß‘¦‹ = array_to_keyvalue($e»ªÕùã‘¾, $BØ¸•ğÊ[222]); foreach ($fß‡öáìÎ as $câ¥İÙÖ‰™) { if (isset($F‚İ°ß‘¦‹[$câ¥İÙÖ‰™])) { $bç³µ•¶İù = $F‚İ°ß‘¦‹[$câ¥İÙÖ‰™]; } else { $bç³µ•¶İù = end($e»ªÕùã‘¾); $bç³µ•¶İù[$BØ¸•ğÊ[222]] = $câ¥İÙÖ‰™; if ($C®ƒÚòŒÌ‹ == $BØ¸•ğÊ[562]) { $bç³µ•¶İù[$BØ¸•ğÊ[1615]] = $bç³µ•¶İù[$BØ¸•ğÊ[1616]] = 0; } } $bÆÓíŠ¡á£[] = $bç³µ•¶İù; } $e»ªÕùã‘¾ = $bÆÓíŠ¡á£; } $dò¿Ñ´Ùâ = array($BØ¸•ğÊ[562] => array($BØ¸•ğÊ[717] => LNG($BØ¸•ğÊ[1631]), $BØ¸•ğÊ[1615] => LNG($BØ¸•ğÊ[1632]), $BØ¸•ğÊ[1616] => LNG($BØ¸•ğÊ[1633])), $BØ¸•ğÊ[1617] => array($BØ¸•ğÊ[715] => LNG($BØ¸•ğÊ[1634]), $BØ¸•ğÊ[1619] => LNG($BØ¸•ğÊ[1635]), $BØ¸•ğÊ[1620] => LNG($BØ¸•ğÊ[1636]), $BØ¸•ğÊ[1621] => LNG($BØ¸•ğÊ[1637]))); $dÖî¦ÆÜÓå = array($BØ¸•ğÊ[562] => $BØ¸•ğÊ[1638], $BØ¸•ğÊ[1617] => $BØ¸•ğÊ[78]); goto dÓß¤Ãùì; dØ…‚Ûß‚: $BØ¸•ğÊ =& $_SERVER[¬¦ã¾]; if (!$this->init($C®ƒÚòŒÌ‹)) { return !1; } $e»ªÕùã‘¾ = $this->trendList($C®ƒÚòŒÌ‹); goto CÈ¤—ĞÏ‡‘; fˆ¢®áƒ‚¿: return $aö½¥ÍÒ¶; goto a¿éğÙÌ³Ù; dÓß¤Ãùì: if (empty($e»ªÕùã‘¾)) { $câ¥İÙÖ‰™ = date($BØ¸•ğÊ[1622], strtotime($BØ¸•ğÊ[1623])); $C¹åñÏŠæ¸ = array($BØ¸•ğÊ[222] => $câ¥İÙÖ‰™); foreach ($dò¿Ñ´Ùâ[$C®ƒÚòŒÌ‹] as $Dª­ºâÒ‡ => $eˆ¤ˆÛ—‹–) { $C¹åñÏŠæ¸[$Dª­ºâÒ‡] = 0; } $e»ªÕùã‘¾[] = $C¹åñÏŠæ¸; } $aö½¥ÍÒ¶ = array(); foreach ($e»ªÕùã‘¾ as $eˆ¤ˆÛ—‹–) { if ($C®ƒÚòŒÌ‹ == $BØ¸•ğÊ[1617] && $eˆ¤ˆÛ—‹–[$BØ¸•ğÊ[1619]] > $eˆ¤ˆÛ—‹–[$BØ¸•ğÊ[715]]) { $eˆ¤ˆÛ—‹–[$BØ¸•ğÊ[1619]] = $eˆ¤ˆÛ—‹–[$BØ¸•ğÊ[715]]; } foreach ($dò¿Ñ´Ùâ[$C®ƒÚòŒÌ‹] as $Dª­ºâÒ‡ => $c–Õºš»‚) { $bç³µ•¶İù = array($BØ¸•ğÊ[222] => $eˆ¤ˆÛ—‹–[$BØ¸•ğÊ[222]], $BØ¸•ğÊ[1426] => $c–Õºš»‚); $bç³µ•¶İù[$dÖî¦ÆÜÓå[$C®ƒÚòŒÌ‹]] = isset($eˆ¤ˆÛ—‹–[$Dª­ºâÒ‡]) ? $eˆ¤ˆÛ—‹–[$Dª­ºâÒ‡] : 0; $aö½¥ÍÒ¶[] = $bç³µ•¶İù; } } goto fˆ¢®áƒ‚¿; a¿éğÙÌ³Ù: } public function validDate($F¤„ÍŸô¢ã, $eÎ¼Éœ) { goto c”ÄÄµµç; c”ÄÄµµç: $aéÑŒƒóÄâ =& $_SERVER[¬¦ã¾]; $f¶ÓÀğ¹Í = date($aéÑŒƒóÄâ[1622], strtotime($aéÑŒƒóÄâ[1623])); $E…±ˆøÎ£’ = array($f¶ÓÀğ¹Í); goto FãíŸçÃ…Ë; E”÷õ‡ŠÀì: return $E…±ˆøÎ£’; goto D¡´Û³¿ß; FãíŸçÃ…Ë: switch ($F¤„ÍŸô¢ã) { case $aéÑŒƒóÄâ[1501]: $A²ñŞÖ¥ = mktime(0, 0, 0, date($aéÑŒƒóÄâ[1639]), date($aéÑŒƒóÄâ[1244]) - date($aéÑŒƒóÄâ[1306]) + 7 - 7, date($aéÑŒƒóÄâ[1640])); $bÆ›Ïêê = 0; do { $f³Øğ ÜÈÄ = date($aéÑŒƒóÄâ[1622], $A²ñŞÖ¥ - 3600 * 24 * 7 * $bÆ›Ïêê); $E…±ˆøÎ£’[] = $f³Øğ ÜÈÄ; $bÆ›Ïêê++; } while ($eÎ¼Éœ < $f³Øğ ÜÈÄ); break; case $aéÑŒƒóÄâ[1499]: $bÆ›Ïêê = 1; do { $bí£‚Öˆ—Å = date($aéÑŒƒóÄâ[1641], strtotime("\x2d\x20{$bÆ›Ïêê}\x20\155\x6f\156\164\150\x73")); $E…±ˆøÎ£’[] = $bí£‚Öˆ—Å; $bÆ›Ïêê++; } while ($eÎ¼Éœ < $bí£‚Öˆ—Å); break; case $aéÑŒƒóÄâ[1642]: $bÊ÷œù¿§¨ = (int) date($aéÑŒƒóÄâ[1640], strtotime($eÎ¼Éœ)); $B…öÉœÛÁÄ = (int) date($aéÑŒƒóÄâ[1640]); if ($bÊ÷œù¿§¨ >= $B…öÉœÛÁÄ) { break; } for ($bÊ÷œù¿§¨; $bÊ÷œù¿§¨ < $B…öÉœÛÁÄ; $bÊ÷œù¿§¨++) { $E…±ˆøÎ£’[] = $bÊ÷œù¿§¨ . $aéÑŒƒóÄâ[1643]; } break; default: break; } if ($eÎ¼Éœ > end($E…±ˆøÎ£’)) { array_pop($E…±ˆøÎ£’); } sort($E…±ˆøÎ£’); goto E”÷õ‡ŠÀì; D¡´Û³¿ß: } public function listTable($e…Š÷âô¶Ç) { $CŸãÈ›‡© = ucfirst($e…Š÷âô¶Ç); return Model($CŸãÈ›‡©)->listData(); } public function option($A‚Ô¯‹ÍÔ¹) { $eÖÆÜ¸©à‘ = $_SERVER[¬¦ã¾][1644] . ucfirst($A‚Ô¯‹ÍÔ¹); return $this->{$eÖÆÜ¸©à‘}(); } private function optionUser() { goto AÛ¨…»Õ¶ˆ; AÛ¨…»Õ¶ˆ: $A®³•ôš =& $_SERVER[¬¦ã¾]; $e¥Î‹Óˆ Õ = Model($A®³•ôš[506])->count($A®³•ôš[1520]); $Aé¿Ä‰ù…‡ = Model($A®³•ôš[506])->where($A®³•ôš[1645])->count($A®³•ôš[1520]); goto ağ»ÈøÃÉï; EÓ›ÆÁõ˜: return array($A®³•ôš[711] => (int) $e¥Î‹Óˆ Õ, $A®³•ôš[1647] => (int) ($e¥Î‹Óˆ Õ - $Aé¿Ä‰ù…‡), $A®³•ôš[1648] => (int) $Aé¿Ä‰ù…‡, $A®³•ôš[1649] => (int) $c¤¹¸Õùí», $A®³•ôš[1650] => $fçèœÇÃ); goto fç‹Ú¡õ; ağ»ÈøÃÉï: $bÏ«æ†«©„ = intval($GLOBALS[$A®³•ôš[6]][$A®³•ôš[347]][$A®³•ôš[1480]]) / 3600; $c•ÍÒèåÎÙ = strtotime("\55{$bÏ«æ†«©„}\40\x68\157\165\162\x73"); $d´òÏ¯ãÌ = strtotime(date($A®³•ôš[1626])); goto C³ØåãµêÂ; C³ØåãµêÂ: if ($c•ÍÒèåÎÙ < $d´òÏ¯ãÌ) { $c•ÍÒèåÎÙ = $d´òÏ¯ãÌ; } $E‘µ‰¦‹õ­ = array($A®³•ôš[1646] => array($A®³•ôš[962], $c•ÍÒèåÎÙ)); $fçèœÇÃ = (int) Model($A®³•ôš[506])->where($E‘µ‰¦‹õ­)->count($A®³•ôš[1520]); goto Bå†óç„Ş¾; Bå†óç„Ş¾: if (!$fçèœÇÃ) { $fçèœÇÃ = 1; } $E‘µ‰¦‹õ­ = array($A®³•ôš[1646] => array($A®³•ôš[962], $d´òÏ¯ãÌ)); $c¤¹¸Õùí» = Model($A®³•ôš[506])->where($E‘µ‰¦‹õ­)->count($A®³•ôš[1520]); goto EÓ›ÆÁõ˜; fç‹Ú¡õ: } private function optionFile() { goto eóˆ¯Û…Ü; eóˆ¯Û…Ü: $C³ƒ¹ÖÛôª =& $_SERVER[¬¦ã¾]; $D‚‚³™‡äÏ = $this->sourceSize(); $C‚Û©ÊÆ×“ = $D‚‚³™‡äÏ[$C³ƒ¹ÖÛôª[78]]; goto bğ‰—Şˆİ; bğ‰—Şˆİ: $C®Èâ¸È…Æ = $D‚‚³™‡äÏ[$C³ƒ¹ÖÛôª[1619]]; $EöÊÈ¹ãÇ” = Model($C³ƒ¹ÖÛôª[782])->where(array($C³ƒ¹ÖÛôª[403] => 0))->count($C³ƒ¹ÖÛôª[395]); $b‰™‡á ‡Ç = array($C³ƒ¹ÖÛôª[403] => 0, $C³ƒ¹ÖÛôª[194] => array($C³ƒ¹ÖÛôª[962], strtotime(date($C³ƒ¹ÖÛôª[1626])))); goto fÎ°‚º©îõ; fÎ°‚º©îõ: $FØ·Ö´‘ìÚ = Model($C³ƒ¹ÖÛôª[782])->where($b‰™‡á ‡Ç)->sum($C³ƒ¹ÖÛôª[78]); $eÙ£¼àã‘À = Model($C³ƒ¹ÖÛôª[782])->where($b‰™‡á ‡Ç)->count($C³ƒ¹ÖÛôª[395]); return array($C³ƒ¹ÖÛôª[715] => $C‚Û©ÊÆ×“, $C³ƒ¹ÖÛôª[1619] => $C®Èâ¸È…Æ, $C³ƒ¹ÖÛôª[1651] => $C‚Û©ÊÆ×“ - $C®Èâ¸È…Æ, $C³ƒ¹ÖÛôª[1652] => (int) $FØ·Ö´‘ìÚ, $C³ƒ¹ÖÛôª[717] => (int) $EöÊÈ¹ãÇ”, $C³ƒ¹ÖÛôª[1653] => (int) $eÙ£¼àã‘À); goto A ‰–óàšÕ; A ‰–óàšÕ: } private function optionAccess() { $d¤Œæ©Ìªˆ =& $_SERVER[¬¦ã¾]; return array($d¤Œæ©Ìªˆ[711] => $this->typeLogCnt(), $d¤Œæ©Ìªˆ[107] => $this->typeLogCnt($d¤Œæ©Ìªˆ[107]), $d¤Œæ©Ìªˆ[430] => $this->typeLogCnt($d¤Œæ©Ìªˆ[430]), $d¤Œæ©Ìªˆ[1654] => $this->typeLogCnt($d¤Œæ©Ìªˆ[1654]), $d¤Œæ©Ìªˆ[1655] => $this->typeLogCnt($d¤Œæ©Ìªˆ[1655]), $d¤Œæ©Ìªˆ[562] => $this->typeLogCnt($d¤Œæ©Ìªˆ[33], $d¤Œæ©Ìªˆ[1630])); } private function typeLogCnt($aŠ¢‰µ‡¾É = '', $CÏŒÔÚ·°ç = "\x69\144") { goto EäˆåñäÒ·; BÂğ¼²œõá: return (int) $bŞºôÁ÷Ñ‘; goto EÅÎö¤›Ş; d²Àœ„è‰: $fİùÖ©’Œ¾ = array($dÜ„çŠ£ç[194] => array($dÜ„çŠ£ç[962], $Bî÷Ááœµ®)); if ($aŠ¢‰µ‡¾É) { $fİùÖ©’Œ¾[$dÜ„çŠ£ç[29]] = array($dÜ„çŠ£ç[7], $C÷´àÉí»Ó[$aŠ¢‰µ‡¾É]); } $bŞºôÁ÷Ñ‘ = Model($dÜ„çŠ£ç[1629])->where($fİùÖ©’Œ¾)->count($CÏŒÔÚ·°ç); goto BÂğ¼²œõá; EäˆåñäÒ·: $dÜ„çŠ£ç =& $_SERVER[¬¦ã¾]; $C÷´àÉí»Ó = array($dÜ„çŠ£ç[107] => array($dÜ„çŠ£ç[1656], $dÜ„çŠ£ç[1657]), $dÜ„çŠ£ç[430] => array($dÜ„çŠ£ç[1658], $dÜ„çŠ£ç[1659]), $dÜ„çŠ£ç[1654] => array($dÜ„çŠ£ç[1660], $dÜ„çŠ£ç[1661], $dÜ„çŠ£ç[1662]), $dÜ„çŠ£ç[1655] => array($dÜ„çŠ£ç[1663], $dÜ„çŠ£ç[1664]), $dÜ„çŠ£ç[1665] => array($dÜ„çŠ£ç[1666], $dÜ„çŠ£ç[1667], $dÜ„çŠ£ç[1668])); $Bî÷Ááœµ® = strtotime(date($dÜ„çŠ£ç[1626])); goto d²Àœ„è‰; EÅÎö¤›Ş: } private function optionServer() { goto c·ÓãŒ¢Œö; bÚÒİö¥÷Ê: $B…¼ùËˆøã = $e²¾Üâ‡ù…[0]; $bğ§¨¡ ˆè = $GLOBALS[$AÏ£Ä™…§ø[6]][$AÏ£Ä™…§ø[17]]; $f¸ê¿ª„’ï = $bğ§¨¡ ˆè[$AÏ£Ä™…§ø[923]]; goto FŠ‚¯«³¿Â; DÎæ³…©²¥: return array($AÏ£Ä™…§ø[1671] => $DöÕ´˜Í™Ï ? $DöÕ´˜Í™Ï[$AÏ£Ä™…§ø[1672]] : 0, $AÏ£Ä™…§ø[1673] => $DöÕ´˜Í™Ï ? $DöÕ´˜Í™Ï[$AÏ£Ä™…§ø[1674]] : 0, $AÏ£Ä™…§ø[1675] => (int) $bÇ¾ùö·ğù[$AÏ£Ä™…§ø[1672]] * 1024 * 1024 * 1024, $AÏ£Ä™…§ø[1676] => (int) $Bç¨¨–Â, $AÏ£Ä™…§ø[1677] => ucfirst($B…¼ùËˆøã), $AÏ£Ä™…§ø[1678] => $AÏ£Ä™…§ø[1679] . PHP_VERSION, $AÏ£Ä™…§ø[1680] => phpBuild64() ? 64 : 32, $AÏ£Ä™…§ø[710] => str_replace($AÏ£Ä™…§ø[1681], $AÏ£Ä™…§ø[939], $f¸ê¿ª„’ï), $AÏ£Ä™…§ø[347] => ucfirst($aÖ…ª´‘¹¥), $AÏ£Ä™…§ø[28] => $_SERVER[$AÏ£Ä™…§ø[1682]]); goto bÖÉÊÚ¸Èê; FŠ‚¯«³¿Â: if ($f¸ê¿ª„’ï == $AÏ£Ä™…§ø[747]) { $AØØ»Éõñ = explode($AÏ£Ä™…§ø[1158], $bğ§¨¡ ˆè[$AÏ£Ä™…§ø[922]]); $f¸ê¿ª„’ï = $AØØ»Éõñ[0]; } if ($f¸ê¿ª„’ï == $AÏ£Ä™…§ø[750] || $f¸ê¿ª„’ï == $AÏ£Ä™…§ø[751]) { $A‰†”¸ğ‘ = Model()->db()->query($AÏ£Ä™…§ø[1669]); $CôÕàâŸ¤ = $A‰†”¸ğ‘[0] && isset($A‰†”¸ğ‘[0][$AÏ£Ä™…§ø[1425]]) ? $A‰†”¸ğ‘[0][$AÏ£Ä™…§ø[1425]] : 0; $f¸ê¿ª„’ï = $AÏ£Ä™…§ø[1670] . ($CôÕàâŸ¤ ? $AÏ£Ä™…§ø[8] . $CôÕàâŸ¤ : $AÏ£Ä™…§ø[33]); } $aÖ…ª´‘¹¥ = $GLOBALS[$AÏ£Ä™…§ø[6]][$AÏ£Ä™…§ø[347]][$AÏ£Ä™…§ø[784]]; goto DÎæ³…©²¥; b‹Œ¡–áÂÕ: $bÔ‰ÕŒô… = array($AÏ£Ä™…§ø[774] => $bÇ¾ùö·ğù[$AÏ£Ä™…§ø[393]]); $Bç¨¨–Â = Model($AÏ£Ä™…§ø[450])->where($bÔ‰ÕŒô…)->sum($AÏ£Ä™…§ø[78]); $e²¾Üâ‡ù… = explode($AÏ£Ä™…§ø[50], $_SERVER[$AÏ£Ä™…§ø[142]]); goto bÚÒİö¥÷Ê; c·ÓãŒ¢Œö: $AÏ£Ä™…§ø =& $_SERVER[¬¦ã¾]; $DöÕ´˜Í™Ï = $this->diskDriver(); $bÇ¾ùö·ğù = KodIO::defaultDriver(); goto b‹Œ¡–áÂÕ; bÖÉÊÚ¸Èê: } private function diskDriver() { goto eÎ§—‰ùƒê; AˆË÷Ãê´Ê: $dß²Õ†ßï´ = $b½·µğÒÜò - @disk_free_space($a—ííè‰ã‚); return array($f ğÚå­®Ô[1672] => $b½·µğÒÜò, $f ğÚå­®Ô[1674] => $dß²Õ†ßï´); goto Cß¥öÈôŒ; f‰öÇ¥¶Ó±: if ($dÒÎŒÅ‡é) { $a—ííè‰ã‚ = $f ğÚå­®Ô[1685]; if (function_exists($f ğÚå­®Ô[1686])) { exec($f ğÚå­®Ô[1687], $aÒæÈ òËÔ); $a—ííè‰ã‚ = $aÒæÈ òËÔ[1] . $f ğÚå­®Ô[8]; } } if (!file_exists($a—ííè‰ã‚)) { return; } $b½·µğÒÜò = @disk_total_space($a—ííè‰ã‚); goto AˆË÷Ãê´Ê; eÎ§—‰ùƒê: $f ğÚå­®Ô =& $_SERVER[¬¦ã¾]; $a—ííè‰ã‚ = $f ğÚå­®Ô[8]; $dÒÎŒÅ‡é = $GLOBALS[$f ğÚå­®Ô[6]][$f ğÚå­®Ô[1683]] == $f ğÚå­®Ô[1684]; goto f‰öÇ¥¶Ó±; Cß¥öÈôŒ: } public function fileChart($dìÊÛÊÒªÁ) { goto AÂ«æß›è; Ağ† “‘–ò: $E°ğŠÁÏÇµ[$CÙâÆÑÄ™™[404]] = 2; $AÇÌ…ó©òÂ = Model($CÙâÆÑÄ™™[782])->where($E°ğŠÁÏÇµ)->sum($CÙâÆÑÄ™™[78]); return array($CÙâÆÑÄ™™[715] => $böíƒªĞÎ[$CÙâÆÑÄ™™[78]], $CÙâÆÑÄ™™[1619] => $böíƒªĞÎ[$CÙâÆÑÄ™™[1619]], $CÙâÆÑÄ™™[1620] => (int) $fÚº‚…²¦É, $CÙâÆÑÄ™™[1621] => (int) $AÇÌ…ó©òÂ); goto e¸–öˆì¨ö; bÍĞÓ¯³±: $böíƒªĞÎ = $this->sourceSize(); $E°ğŠÁÏÇµ = array($CÙâÆÑÄ™™[478] => 0, $CÙâÆÑÄ™™[404] => 1); $fÚº‚…²¦É = Model($CÙâÆÑÄ™™[782])->where($E°ğŠÁÏÇµ)->sum($CÙâÆÑÄ™™[78]); goto Ağ† “‘–ò; AÂ«æß›è: $CÙâÆÑÄ™™ =& $_SERVER[¬¦ã¾]; if (isset($dìÊÛÊÒªÁ[$CÙâÆÑÄ™™[1520]])) { return Model($CÙâÆÑÄ™™[782])->userFileTypeProfile($dìÊÛÊÒªÁ[$CÙâÆÑÄ™™[1520]]); } if (isset($dìÊÛÊÒªÁ[$CÙâÆÑÄ™™[1688]])) { return Model($CÙâÆÑÄ™™[782])->groupFileTypeProfile($dìÊÛÊÒªÁ[$CÙâÆÑÄ™™[1688]]); } goto bÍĞÓ¯³±; e¸–öˆì¨ö: } private function sourceSize() { $cªñÆù‹Ê¼ =& $_SERVER[¬¦ã¾]; $E ó´Óİ = Model($cªñÆù‹Ê¼[782])->where(array($cªñÆù‹Ê¼[403] => 0))->sum($cªñÆù‹Ê¼[78]); $e¸ªß“‰ = Model($cªñÆù‹Ê¼[450])->sum($cªñÆù‹Ê¼[78]); if ($e¸ªß“‰ > $E ó´Óİ) { $e¸ªß“‰ = $E ó´Óİ; } return array($cªñÆù‹Ê¼[78] => (int) $E ó´Óİ, $cªñÆù‹Ê¼[1619] => (int) $e¸ªß“‰); } } goto Cª¨ê…„çø; e¬è›‘ŞËÚ: class BackupFile { public function __construct() { } public function index() { goto a¤‡ÇŠù‘; d‚¬‚²¬”Ü: $E¸òßËñ´ = !0; $Dêİ‹óğÆ… = $this->storeIds(); $A‹¡®Áäóé = 1; goto cœäÍËñ»; bäÙ…ïîÄ–: $Cöê‰ØàÜ->task[$_SERVER[¬¦ã¾][715]] = $E´æ‡Ú„ìÙ; $dé¤ÈÙ¿ÊÃ = array($_SERVER[¬¦ã¾][768] => $C—Í“÷ºê©, $_SERVER[¬¦ã¾][769] => $E´æ‡Ú„ìÙ, $_SERVER[¬¦ã¾][770] => time()); Backup::set($dé¤ÈÙ¿ÊÃ); goto d‚¬‚²¬”Ü; BÖº¨ãó‚: $e¼ÄÓÒ·• = $d ˜í·ìÕ = 0; do { $c“Å±·ŒÖã = $_SERVER[¬¦ã¾][771]; $cÏ²çÀÙÍ¥ = Model($_SERVER[¬¦ã¾][739])->where($A²¸®ÓºÜ´)->field($c“Å±·ŒÖã)->order($_SERVER[¬¦ã¾][772])->selectPage($BÖù³‹œ¤Ô, $A‹¡®Áäóé); $E±Å‰’•„Ì = !empty($cÏ²çÀÙÍ¥[$_SERVER[¬¦ã¾][367]]) ? $cÏ²çÀÙÍ¥[$_SERVER[¬¦ã¾][367]] : array(); foreach ($E±Å‰’•„Ì as $d†¬·²ÉÀÚ) { goto E¶ÚØùŠ„Ö; BİÆ»–•À‰: if (IO::exist($DÑç‰Û­ÃÛ)) { $Cöê‰ØàÜ->updateFileEnd($d†¬·²ÉÀÚ[$_SERVER[¬¦ã¾][28]], $d†¬·²ÉÀÚ[$_SERVER[¬¦ã¾][78]]); } else { $DÑç‰Û­ÃÛ = get_path_father($DÑç‰Û­ÃÛ); IO::mkdir($DÑç‰Û­ÃÛ); if (!IO::copy($FÚ®Ş´Ûäô, $DÑç‰Û­ÃÛ, $_SERVER[¬¦ã¾][775])) { write_log($_SERVER[¬¦ã¾][776] . $FÚ®Ş´Ûäô . $_SERVER[¬¦ã¾][759] . $DÑç‰Û­ÃÛ . $_SERVER[¬¦ã¾][504], $_SERVER[¬¦ã¾][734]); $E¸òßËñ´ = !1; break; } } $fÃŞÛ¶›—À = $d†¬·²ÉÀÚ[$_SERVER[¬¦ã¾][447]]; $BÔ˜­Ö§ğô += 1; goto AÙòÎÌìŸŸ; E¶ÚØùŠ„Ö: if (!$this->_fileExist($d†¬·²ÉÀÚ, $fš±×à„ÎÌ, $Dêİ‹óğÆ…)) { $C—Í“÷ºê© -= 1; $E´æ‡Ú„ìÙ -= (int) $d†¬·²ÉÀÚ[$_SERVER[¬¦ã¾][78]]; write_log("\x66\x69\x6c\x65\40\x6e\x6f\x74\x20\x65\x78\151\x73\x74\x2e\x66\151\x6c\145\111\104\x3a{$d†¬·²ÉÀÚ[$_SERVER[¬¦ã¾][447]]}\54\x20\160\141\x74\x68\x3a{$d†¬·²ÉÀÚ[$_SERVER[¬¦ã¾][76]]}", $_SERVER[¬¦ã¾][773]); continue; } $FÚ®Ş´Ûäô = $d†¬·²ÉÀÚ[$_SERVER[¬¦ã¾][76]]; $DÑç‰Û­ÃÛ = "\x7b\x69\157\72{$c‘Í”± ‘á[$_SERVER[¬¦ã¾][704]]}\175" . substr($FÚ®Ş´Ûäô, strlen("\173\x69\157\x3a{$d†¬·²ÉÀÚ[$_SERVER[¬¦ã¾][774]]}\x7d")); goto BİÆ»–•À‰; c ‘éÅ‹°Ù: if ($Dƒæ¦´¢ >= 1024 * 1024 * 100) { $dé¤ÈÙ¿ÊÃ = array($_SERVER[¬¦ã¾][777] => $fÃŞÛ¶›—À, $_SERVER[¬¦ã¾][778] => $d ˜í·ìÕ, $_SERVER[¬¦ã¾][779] => $e¼ÄÓÒ·•); Backup::set($dé¤ÈÙ¿ÊÃ); $Dƒæ¦´¢ = $BÔ˜­Ö§ğô = 0; } goto e…¢°Êæ¤›; AÙòÎÌìŸŸ: $Dƒæ¦´¢ += $d†¬·²ÉÀÚ[$_SERVER[¬¦ã¾][78]]; $d ˜í·ìÕ += 1; $e¼ÄÓÒ·• += $d†¬·²ÉÀÚ[$_SERVER[¬¦ã¾][78]]; goto c ‘éÅ‹°Ù; e…¢°Êæ¤›: } $d¼Œ˜ä ×½ = count($E±Å‰’•„Ì); $A‹¡®Áäóé++; } while ($d¼Œ˜ä ×½ == $BÖù³‹œ¤Ô); $Cöê‰ØàÜ->end(); goto f£„¥Øãœ³; f£„¥Øãœ³: $dé¤ÈÙ¿ÊÃ = array($_SERVER[¬¦ã¾][780] => 1, $_SERVER[¬¦ã¾][476] => time(), $_SERVER[¬¦ã¾][727] => 1, $_SERVER[¬¦ã¾][777] => $fÃŞÛ¶›—À, $_SERVER[¬¦ã¾][769] => $E´æ‡Ú„ìÙ, $_SERVER[¬¦ã¾][768] => $C—Í“÷ºê©, $_SERVER[¬¦ã¾][781] => time()); if ($BÔ˜­Ö§ğô) { $dé¤ÈÙ¿ÊÃ[$_SERVER[¬¦ã¾][778]] = $d ˜í·ìÕ; $dé¤ÈÙ¿ÊÃ[$_SERVER[¬¦ã¾][779]] = $e¼ÄÓÒ·•; } Backup::set($dé¤ÈÙ¿ÊÃ); goto f·éì£çŒĞ; f·éì£çŒĞ: $this->_fileFilter($fš±×à„ÎÌ); return !0; goto e±Š”ªÌ‘›; ağ®Ëİ™³: $C—Í“÷ºê© = (int) Model($_SERVER[¬¦ã¾][739])->where($A²¸®ÓºÜ´)->count($_SERVER[¬¦ã¾][447]); $E´æ‡Ú„ìÙ = (int) Model($_SERVER[¬¦ã¾][739])->where($A²¸®ÓºÜ´)->sum($_SERVER[¬¦ã¾][78]); $Cöê‰ØàÜ = new TaskFileTransfer($_SERVER[¬¦ã¾][766], $_SERVER[¬¦ã¾][734], $C—Í“÷ºê©, LNG($_SERVER[¬¦ã¾][735]) . $_SERVER[¬¦ã¾][736] . LNG($_SERVER[¬¦ã¾][767])); goto bäÙ…ïîÄ–; cœäÍËñ»: $BÖù³‹œ¤Ô = 1000; $Dƒæ¦´¢ = $BÔ˜­Ö§ğô = 0; $fš±×à„ÎÌ = array(); goto BÖº¨ãó‚; a¤‡ÇŠù‘: $c‘Í”± ‘á = Backup::get(); $fÃŞÛ¶›—À = $c‘Í”± ‘á[$_SERVER[¬¦ã¾][291]][$_SERVER[¬¦ã¾][193]][$_SERVER[¬¦ã¾][447]]; $A²¸®ÓºÜ´ = array($_SERVER[¬¦ã¾][448] => array($_SERVER[¬¦ã¾][764], $fÃŞÛ¶›—À), $_SERVER[¬¦ã¾][765] => array($_SERVER[¬¦ã¾][329], $c‘Í”± ‘á[$_SERVER[¬¦ã¾][704]])); goto ağ®Ëİ™³; e±Š”ªÌ‘›: } private function _fileExist($cñ¤„‰¬ĞÓ, &$FÔÏİ¹ ¢×, $d°îğò¹‹) { goto C±¹‡µº­Ö; Dîœ…—‹¤™: if (IO::exist($d‡é”ßÄèÎ)) { $FÔÏİ¹ ¢×[] = $cñ¤„‰¬ĞÓ[$EŠÚÄòÖ†[447]]; return !1; } $bğ±ÃŞÓ™ = array($EŠÚÄòÖ†[774] => $cñ¤„‰¬ĞÓ[$EŠÚÄòÖ†[774]], $EŠÚÄòÖ†[76] => array($EŠÚÄòÖ†[380], "{$d‡é”ßÄèÎ}\45")); $CÂ­ÑÇí¨à = Model($EŠÚÄòÖ†[739])->where($bğ±ÃŞÓ™)->field($EŠÚÄòÖ†[448])->select(); goto C’ÅğÒÙ; C±¹‡µº­Ö: $EŠÚÄòÖ† =& $_SERVER[¬¦ã¾]; $bœ™ —¦İÑ = $cñ¤„‰¬ĞÓ[$EŠÚÄòÖ†[76]]; if (in_array($cñ¤„‰¬ĞÓ[$EŠÚÄòÖ†[447]], $FÔÏİ¹ ¢×)) { return !1; } goto DáğğŠ´‚è; DáğğŠ´‚è: if (!in_array($cñ¤„‰¬ĞÓ[$EŠÚÄòÖ†[774]], $d°îğò¹‹)) { return !1; } if (IO::exist($bœ™ —¦İÑ)) { return !0; } $d‡é”ßÄèÎ = get_path_father($bœ™ —¦İÑ); goto Dîœ…—‹¤™; C’ÅğÒÙ: $FÔÏİ¹ ¢× = array_merge($FÔÏİ¹ ¢×, array_to_keyvalue($CÂ­ÑÇí¨à, $EŠÚÄòÖ†[33], $EŠÚÄòÖ†[447])); return !1; goto FÛ…Ôù…Ä; FÛ…Ôù…Ä: } private function _fileFilter($eóƒÖùƒˆµ) { $eîš»«‚¸ø =& $_SERVER[¬¦ã¾]; if (empty($eóƒÖùƒˆµ)) { return; } $AåøªèÕ¬ = array($eîš»«‚¸ø[447] => array($eîš»«‚¸ø[7], array_unique($eóƒÖùƒˆµ))); $cñ× º¢Ê” = Model($eîš»«‚¸ø[782])->where($AåøªèÕ¬)->field($eîš»«‚¸ø[395])->select(); foreach ($cñ× º¢Ê” as $F©ïÁ®Â°­) { Model($eîš»«‚¸ø[782])->remove($F©ïÁ®Â°­[$eîš»«‚¸ø[395]], !1); } } private function storeIds() { $FÇéÒ¹¬„° =& $_SERVER[¬¦ã¾]; $b¦Ö¥¼ˆİö = Model($FÇéÒ¹¬„°[719])->listData(); $DĞØ…Ûƒ‚÷ = array(); $c¤àÅ‘ÍÙˆ = $GLOBALS[$FÇéÒ¹¬„°[6]][$FÇéÒ¹¬„°[88]][$FÇéÒ¹¬„°[783]]; foreach ($b¦Ö¥¼ˆİö as $Dœ‡Ô–òò) { $a«¶†™çšé = strtolower($Dœ‡Ô–òò[$FÇéÒ¹¬„°[94]]); if (!isset($c¤àÅ‘ÍÙˆ[$a«¶†™çšé])) { continue; } $AÁõãã¢” = $FÇéÒ¹¬„°[72] . (isset($c¤àÅ‘ÍÙˆ[$a«¶†™çšé]) ? $c¤àÅ‘ÍÙˆ[$a«¶†™çšé] : ucfirst($a«¶†™çšé)); if (!class_exists($AÁõãã¢”)) { continue; } $DĞØ…Ûƒ‚÷[] = $Dœ‡Ô–òò[$FÇéÒ¹¬„°[393]]; } return $DĞØ…Ûƒ‚÷; } } class Cache { protected static $handle; protected static $memoryCache; public static function init() { goto d†«§é²÷³; aÆ†Â§¯¡¨: $càóõÆó“ = $GLOBALS[$C†ˆÄÍèòÜ[6]][$C†ˆÄÍèòÜ[347]]; $EŒì‰ÀÊŒ = $càóõÆó“[$càóõÆó“[$C†ˆÄÍèòÜ[784]]]; $B¦ÂñÉÃˆ = $càóõÆó“[$C†ˆÄÍèòÜ[785]]; goto bÕ‰ì†¸×Ê; bÕ‰ì†¸×Ê: switch ($càóõÆó“[$C†ˆÄÍèòÜ[784]]) { case $C†ˆÄÍèòÜ[17]: self::$handle = Model($C†ˆÄÍèòÜ[786]); break; case $C†ˆÄÍèòÜ[787]: self::$handle = new CacheRedis($EŒì‰ÀÊŒ, $B¦ÂñÉÃˆ); break; case $C†ˆÄÍèòÜ[788]: self::$handle = new CacheMemcached($EŒì‰ÀÊŒ, $B¦ÂñÉÃˆ); break; case $C†ˆÄÍèòÜ[193]: self::$handle = new CacheFile($EŒì‰ÀÊŒ, $B¦ÂñÉÃˆ); break; default: break; } return self::$handle; goto d¬ã¤¸¥; d†«§é²÷³: $C†ˆÄÍèòÜ =& $_SERVER[¬¦ã¾]; if (self::$handle) { return self::$handle; } self::$memoryCache = array(); goto aÆ†Â§¯¡¨; d¬ã¤¸¥: } public static function initReset() { self::$handle = !1; self::$memoryCache = !1; } public static function key($F™„†ˆ·Œß) { if (is_array($F™„†ˆ·Œß) || is_object($F™„†ˆ·Œß)) { $F™„†ˆ·Œß = json_encode($F™„†ˆ·Œß); } $F™„†ˆ·Œß = rawurlencode($F™„†ˆ·Œß); return md5(KOD_SITE_ID . $_SERVER[¬¦ã¾][71] . $F™„†ˆ·Œß); } public static function get($fñË…ƒ‚…å, $Aàƒä˜±êÈ = false) { $CíÆ‰ñôÈ‰ = self::key($fñË…ƒ‚…å); if ($Aàƒä˜±êÈ) { return unserialize(self::init()->get($CíÆ‰ñôÈ‰)); } if (!isset(self::$memoryCache[$CíÆ‰ñôÈ‰])) { $EóŠ ˆÏÅˆ = self::init()->get($CíÆ‰ñôÈ‰); self::$memoryCache[$CíÆ‰ñôÈ‰] = unserialize($EóŠ ˆÏÅˆ); } return self::$memoryCache[$CíÆ‰ñôÈ‰]; } public static function set($B’Åºİ”ÎÈ, $Fñôï—…ï‡, $BÕ¼Ã¶Ÿ† = false) { goto d­ò¤Ê±è‹; C –ÑŸ§‡: CacheLock::lock($B’Åºİ”ÎÈ); $Bàğ§›¦¾ = self::init()->set($c·°÷×ö³, serialize($Fñôï—…ï‡), $BÕ¼Ã¶Ÿ†); self::$memoryCache[$c·°÷×ö³] = $Fñôï—…ï‡; goto B‚¸í…‚»; d­ò¤Ê±è‹: $c·°÷×ö³ = self::key($B’Åºİ”ÎÈ); if (isset(self::$memoryCache[$c·°÷×ö³]) && self::$memoryCache[$c·°÷×ö³] === $Fñôï—…ï‡) { return !0; } if ($BÕ¼Ã¶Ÿ† === 0) { self::$memoryCache[$c·°÷×ö³] = $Fñôï—…ï‡; return !0; } goto C –ÑŸ§‡; B‚¸í…‚»: CacheLock::unlock($B’Åºİ”ÎÈ); return $Bàğ§›¦¾; goto Cã·Ş‘Ë÷ù; Cã·Ş‘Ë÷ù: } public static function getCall($e…¢»°Û¬, $A²‚î¥¦Ê, $dÒï¤Æ…ËÜ, $B‹½Îà½õ = array()) { goto d¸‹èÎÊê; EçõŞ¹áŸ: return $CŠ×Æ‚Ê‰Ë; goto d­¬¹ÙŒ; Cåğ‚·š´ñ: $CŠ×Æ‚Ê‰Ë = call_user_func_array($dÒï¤Æ…ËÜ, $B‹½Îà½õ); $CŠ×Æ‚Ê‰Ë = $CŠ×Æ‚Ê‰Ë ? $CŠ×Æ‚Ê‰Ë : $fùãÌ×­á±[33]; self::set($e…¢»°Û¬, $CŠ×Æ‚Ê‰Ë, $A²‚î¥¦Ê); goto EçõŞ¹áŸ; d¸‹èÎÊê: $fùãÌ×­á± =& $_SERVER[¬¦ã¾]; $CŠ×Æ‚Ê‰Ë = self::get($e…¢»°Û¬); if ($CŠ×Æ‚Ê‰Ë || $CŠ×Æ‚Ê‰Ë === $fùãÌ×­á±[33]) { return $CŠ×Æ‚Ê‰Ë; } goto Cåğ‚·š´ñ; d­¬¹ÙŒ: } public static function remove($CÍñÂì´½¾) { goto D¶¶ôïšù; eÄæ‹¥ ¸¡: return $eØŞ†ãòó; goto f¥¢œÆäõã; B‰æ¥ò÷êô: CacheLock::lock($CÍñÂì´½¾); $eØŞ†ãòó = self::init()->remove($DÁ™¶®İäè); CacheLock::unlock($CÍñÂì´½¾); goto eÄæ‹¥ ¸¡; D¶¶ôïšù: $DÁ™¶®İäè = self::key($CÍñÂì´½¾); unset(self::$memoryCache[$DÁ™¶®İäè]); self::clearTimeout(); goto B‰æ¥ò÷êô; f¥¢œÆäõã: } public static function removeMemory($c÷åØœØÃ) { $Dâ‘ø§À¢ = self::key($c÷åØœØÃ); unset(self::$memoryCache[$Dâ‘ø§À¢]); } public static function clearMemory($EÂÒö×ª·è = false) { if ($EÂÒö×ª·è) { $EÂÒö×ª·è = self::key($EÂÒö×ª·è); unset(self::$memoryCache[$EÂÒö×ª·è]); return; } self::$memoryCache = null; self::$memoryCache = array(); } public static function deleteAll() { self::$memoryCache = array(); if (method_exists(self::init(), $_SERVER[¬¦ã¾][789])) { self::init()->deleteAll(); } } public static function clearTimeout() { if (method_exists(self::init(), $_SERVER[¬¦ã¾][790])) { self::init()->clearTimeout(); } } } class CacheFile { public $cachePath; public $prefix; public $cacheTime; public function __construct($eµåæ¸‰±™, $f³ö¡ê±Š‘) { $däáâ‹Î =& $_SERVER[¬¦ã¾]; $this->cachePath = $eµåæ¸‰±™[$däáâ‹Î[76]]; $this->prefix = $däáâ‹Î[791]; $this->cacheTime = $f³ö¡ê±Š‘; if (!file_exists($this->cachePath)) { mkdir($this->cachePath, 511, !0); } } public function getFile($D’¼œÚ£Ä) { $F½§Å‹Äˆ =& $_SERVER[¬¦ã¾]; $D’¼œÚ£Ä = str_replace(array($F½§Å‹Äˆ[792], $F½§Å‹Äˆ[97], $F½§Å‹Äˆ[70]), $F½§Å‹Äˆ[793], $D’¼œÚ£Ä); return $this->cachePath . $F½§Å‹Äˆ[794] . $D’¼œÚ£Ä . $F½§Å‹Äˆ[795]; } public function set($EòÎ‹¯èò, $dÜ‘òã”ãï, $cñ½º¶×÷ï = false) { $B•òÏ„Â´… = $this->getFile($EòÎ‹¯èò); if (file_put_contents($B•òÏ„Â´…, $this->prefix . $dÜ‘òã”ãï, LOCK_EX)) { @touch($B•òÏ„Â´…, intval(time() + $cñ½º¶×÷ï)); clearstatcache(); return !0; } @unlink($B•òÏ„Â´…); return !1; } public function get($FºÊÙÒÎâ) { $Cê¥Û‡¬Ğì = $this->getFile($FºÊÙÒÎâ); if (file_exists($Cê¥Û‡¬Ğì) && filemtime($Cê¥Û‡¬Ğì) < time()) { @unlink($Cê¥Û‡¬Ğì); return !1; } $cêôùªˆ¦ = @file_get_contents($Cê¥Û‡¬Ğì); return substr($cêôùªˆ¦, strlen($this->prefix)); } public function remove($DË½êö«Ø¹) { $b¬×Ì½§¡‚ = $this->getFile($DË½êö«Ø¹); return @unlink($b¬×Ì½§¡‚); } public function deleteAll() { $c„ åµÕÙ‹ =& $_SERVER[¬¦ã¾]; $dÔ¶øÚˆ÷• = scandir($this->cachePath); foreach ($dÔ¶øÚˆ÷• as $BØÄß©µ›Ë) { $A›ğ´á’ö¾ = $this->cachePath . $BØÄß©µ›Ë; if (strpos($A›ğ´á’ö¾, $c„ åµÕÙ‹[795]) && strpos($A›ğ´á’ö¾, $c„ åµÕÙ‹[796])) { @unlink($A›ğ´á’ö¾); } } } public function clearTimeout() { $BàÒóÍ«¥Œ =& $_SERVER[¬¦ã¾]; $b˜¡ƒáŒÌÆ = scandir($this->cachePath); foreach ($b˜¡ƒáŒÌÆ as $Bù‰ìæÜ‘´) { $AíØõ™´¦Ô = $this->cachePath . $Bù‰ìæÜ‘´; if (strpos($AíØõ™´¦Ô, $BàÒóÍ«¥Œ[795]) && strpos($AíØõ™´¦Ô, $BàÒóÍ«¥Œ[796]) && filemtime($AíØõ™´¦Ô) < time()) { @unlink($AíØõ™´¦Ô); } } } } goto f¬ÌÁè†³; f¬ÌÁè†³: class CacheLock { protected static $handle; protected static $timeout; protected static $errorMsg = ''; protected static $lockItem = array(); public static function init() { goto A©È§Ì›˜É; d„•¹×İì: self::$timeout = $Cö°™·È”Ì[$EŒ¼Ääğ¯µ[797]] ? $Cö°™·È”Ì[$EŒ¼Ääğ¯µ[797]] : 10; $DßÕŞØÅÓó = _get($GLOBALS[$EŒ¼Ääğ¯µ[6]], $EŒ¼Ääğ¯µ[798]); $b÷¾‹îÀ©Ë = $Cö°™·È”Ì[$EŒ¼Ääğ¯µ[784]] ? $Cö°™·È”Ì[$EŒ¼Ääğ¯µ[784]] : $EŒ¼Ääğ¯µ[193]; goto eñ›¨‘¼¾İ; A©È§Ì›˜É: $EŒ¼Ääğ¯µ =& $_SERVER[¬¦ã¾]; if (self::$handle) { return self::$handle; } $Cö°™·È”Ì = $GLOBALS[$EŒ¼Ääğ¯µ[6]][$EŒ¼Ääğ¯µ[347]]; goto d„•¹×İì; eñ›¨‘¼¾İ: if ($b÷¾‹îÀ©Ë == $EŒ¼Ääğ¯µ[17] && $DßÕŞØÅÓó == $EŒ¼Ääğ¯µ[9]) { $b÷¾‹îÀ©Ë = $EŒ¼Ääğ¯µ[193]; } switch ($b÷¾‹îÀ©Ë) { case $EŒ¼Ääğ¯µ[787]: self::$handle = new CacheLockRedis(); break; case $EŒ¼Ääğ¯µ[788]: self::$handle = new CacheLockMemcached(); break; case $EŒ¼Ääğ¯µ[17]: self::$handle = new CacheLockDatabase(); break; case $EŒ¼Ääğ¯µ[193]: self::$handle = new CacheLockFile(); break; default: break; } return self::$handle; goto aŒ˜òÏ‡; aŒ˜òÏ‡: } private static function key($Eš®Áøòô) { return $_SERVER[¬¦ã¾][799] . Cache::key($Eš®Áøòô); } public static function initReset() { self::$handle = !1; } public static function setErrorMsg($eøÙÎŸ‚Ÿì = '') { self::$errorMsg = $eøÙÎŸ‚Ÿì; } public static function lockGlobal($d“ÉÒâ³›², $d‚†ªò‰ë) { return self::lock($d“ÉÒâ³›², $d‚†ªò‰ë, !0); } public static function lock($D®õ©òğñõ, $A¼®îä—¿ = false, $c¶í»´éÊ = false) { goto d›Ã”‡ˆë¢; aÎŞ¿Î—§ø: if (!$c¶í»´éÊ) { self::$lockItem[$bõ‚—«ˆ¹í] = !0; } return $D…°‰°·®Ö; goto f¿¸¡öµ¶Å; d›Ã”‡ˆë¢: $bò¤¤«ùîç =& $_SERVER[¬¦ã¾]; $eß§èâ×ã = self::init(); $bõ‚—«ˆ¹í = self::key($D®õ©òğñõ); goto aÌ°¾ê’¸¥; aÌ°¾ê’¸¥: $A¼®îä—¿ = $A¼®îä—¿ ? $A¼®îä—¿ : self::$timeout; $D…°‰°·®Ö = $eß§èâ×ã->lock($bõ‚—«ˆ¹í, $A¼®îä—¿); if (!$D…°‰°·®Ö) { $bì½‚¼£í = "\x6c\x6f\x63\x6b\40\x65\x72\162\157\x72\x3b\x6b\145\x79\x3d{$D®õ©òğñõ}\73\x74\x69\155\x65\x3d{$A¼®îä—¿}\x3b" . self::$errorMsg . $bò¤¤«ùîç[68] . get_caller_msg(); $A–’Š‡••‰ = LNG($bò¤¤«ùîç[800]) . "\x28{$A¼®îä—¿}\x73\51\x2e" . LNG($bò¤¤«ùîç[801]); $A–’Š‡••‰ .= $bò¤¤«ùîç[802]; if (is_string(self::$errorMsg) && self::$errorMsg) { $A–’Š‡••‰ = $A–’Š‡••‰ . $bò¤¤«ùîç[803] . self::$errorMsg; } write_log($bì½‚¼£í, $bò¤¤«ùîç[804]); show_json($A–’Š‡••‰, !1); } goto aÎŞ¿Î—§ø; f¿¸¡öµ¶Å: } public static function lockGet($cëš¸´øùŠ) { $fê¿ÈĞ¥ = self::key($cëš¸´øùŠ); if (self::$lockItem[$fê¿ÈĞ¥]) { return self::$lockItem[$fê¿ÈĞ¥]; } return self::init()->lockGet($fê¿ÈĞ¥); } public static function unlock($aŞÌƒ¬“º÷) { $cÔœÙˆÈ‚Ş = self::key($aŞÌƒ¬“º÷); self::$lockItem[$cÔœÙˆÈ‚Ş] = null; return self::init()->unlock($cÔœÙˆÈ‚Ş); } public static function unlockRuntime() { $b˜²‡›Ë¥¾ =& $_SERVER[¬¦ã¾]; $A•–Ñ„Á„² = self::init(); $Dµ”Åõ¢ª = !1; foreach (self::$lockItem as $dğ¿¿˜±¢è => $Fê’ÙÇ…¨Å) { if (!$Fê’ÙÇ…¨Å) { continue; } $A•–Ñ„Á„²->unlock($dğ¿¿˜±¢è); if (!$Dµ”Åõ¢ª) { $Dµ”Åõ¢ª = !0; write_log($b˜²‡›Ë¥¾[805] . $dğ¿¿˜±¢è . $b˜²‡›Ë¥¾[68] . get_caller_msg(), $b˜²‡›Ë¥¾[804]); continue; } write_log($b˜²‡›Ë¥¾[805] . $dğ¿¿˜±¢è, $b˜²‡›Ë¥¾[804]); } self::fileUnlockAll(); } public static function fileLock($eïŒáÔò¥ƒ) { goto fï…å«¥Š; BÓ‡º¡Ô¥”: return !1; goto a¯ÇÔß‚èÎ; DÉ‹…›í: if (flock($d²Æ´ä¡›ê, LOCK_EX)) { return !0; } self::unlock($eïŒáÔò¥ƒ); show_json($e­ëËƒ© ñ[809], !1); goto BÓ‡º¡Ô¥”; BÍ¹¤•£´ƒ: $d²Æ´ä¡›ê = fopen(DATA_PATH . $eïŒáÔò¥ƒ . $e­ëËƒ© ñ[807], $e­ëËƒ© ñ[808]); if (!$d²Æ´ä¡›ê) { return !1; } $GLOBALS[$e­ëËƒ© ñ[806]][$eïŒáÔò¥ƒ] = $d²Æ´ä¡›ê; goto DÉ‹…›í; fï…å«¥Š: $e­ëËƒ© ñ =& $_SERVER[¬¦ã¾]; if (!$GLOBALS[$e­ëËƒ© ñ[806]]) { $GLOBALS[$e­ëËƒ© ñ[806]] = array(); } $GLOBALS[$e­ëËƒ© ñ[806]][$eïŒáÔò¥ƒ] = !1; goto BÍ¹¤•£´ƒ; a¯ÇÔß‚èÎ: } public static function fileUnlock($dç½²³óêì) { $E½ò– ‰Ü² =& $_SERVER[¬¦ã¾]; $CÆíÙæç£‹ = $GLOBALS[$E½ò– ‰Ü²[806]][$dç½²³óêì]; if (!$CÆíÙæç£‹) { return; } $GLOBALS[$E½ò– ‰Ü²[806]][$dç½²³óêì] = !1; flock($CÆíÙæç£‹, LOCK_UN); fclose($CÆíÙæç£‹); } public static function fileUnlockAll() { $e™“ÀğÖè× =& $_SERVER[¬¦ã¾]; if (!$GLOBALS[$e™“ÀğÖè×[806]]) { return; } foreach ($GLOBALS[$e™“ÀğÖè×[806]] as $cæ»ç´×°µ => $C‘ÊÑÇÏ ) { if (!$C‘ÊÑÇÏ ) { continue; } $GLOBALS[$e™“ÀğÖè×[806]][$cæ»ç´×°µ] = !1; flock($C‘ÊÑÇÏ , LOCK_UN); fclose($C‘ÊÑÇÏ ); } $GLOBALS[$e™“ÀğÖè×[806]] = array(); } } function cacheLockWait() { usleep(mt_rand(200, 5000)); } class CacheLockFile { private static $cachePath; private static $caches; public function __construct() { $f¢Øù¥”Ø¬ =& $_SERVER[¬¦ã¾]; $bËÅé¤˜èï = $GLOBALS[$f¢Øù¥”Ø¬[6]][$f¢Øù¥”Ø¬[347]]; self::$cachePath = $bËÅé¤˜èï[$f¢Øù¥”Ø¬[193]][$f¢Øù¥”Ø¬[76]]; @mkdir(self::$cachePath, 511, !0); } public function lock($AË™¡Ò¢êï, $B¯ –¤›À = 0) { goto Cå¦ñ¦Ê‰Ó; Cå¦ñ¦Ê‰Ó: $dİ´—œÈíç =& $_SERVER[¬¦ã¾]; $cÂ×†óŒÇé = microtime(!0); $EôïŠ™Ìˆ = $cÂ×†óŒÇé + $B¯ –¤›À + 0.0001; goto f½Š¿¢×¢²; Ašİßá•‹Ê: $this->unlock($AË™¡Ò¢êï); return !1; goto b·»†ÒŒ; f½Š¿¢×¢²: $D‡èŠÆçÁÔ = rtrim(self::$cachePath, $dİ´—œÈíç[8]) . $dİ´—œÈíç[810] . md5($AË™¡Ò¢êï) . $dİ´—œÈíç[807]; if (file_exists($D‡èŠÆçÁÔ) && filemtime($D‡èŠÆçÁÔ) && filemtime($D‡èŠÆçÁÔ) < time() - 10) { @unlink($D‡èŠÆçÁÔ); } do { if (file_exists($D‡èŠÆçÁÔ)) { cacheLockWait(); continue; } $AÃ™öæè¬‹ = fopen($D‡èŠÆçÁÔ, $dİ´—œÈíç[811]); if (!$AÃ™öæè¬‹) { return !1; } $EäöæªİŒ = flock($AÃ™öæè¬‹, LOCK_EX | LOCK_NB); self::$caches[$AË™¡Ò¢êï] = array($dİ´—œÈíç[812] => $AÃ™öæè¬‹, $dİ´—œÈíç[193] => $D‡èŠÆçÁÔ); fwrite($AÃ™öæè¬‹, $EôïŠ™Ìˆ); clearstatcache(); if ($AÃ™öæè¬‹ && $EäöæªİŒ) { return !0; } cacheLockWait(); } while (microtime(!0) < $EôïŠ™Ìˆ); goto Ašİßá•‹Ê; b·»†ÒŒ: } public function lockGet($a™Û†á¸Üª) { $DŞ‹Ï†®òó =& $_SERVER[¬¦ã¾]; $BØÛ½‘¿ š = rtrim(self::$cachePath, $DŞ‹Ï†®òó[8]) . $DŞ‹Ï†®òó[810] . md5($a™Û†á¸Üª) . $DŞ‹Ï†®òó[807]; return file_exists($BØÛ½‘¿ š); } public function unlock($E¦¬—œõ´‚) { goto BÂ¨’Ú«ªË; EãíĞÓùµ‚: unset(self::$caches[$E¦¬—œõ´‚]); goto CÌ§ËÔ°÷; BÂ¨’Ú«ªË: $c§·‚È£éó =& $_SERVER[¬¦ã¾]; $aÔêå·Í¡³ = self::$caches[$E¦¬—œõ´‚]; if (!$aÔêå·Í¡³) { return; } goto A©§¿Åïòµ; A©§¿Åïòµ: @flock($aÔêå·Í¡³[$c§·‚È£éó[812]], LOCK_UN); @fclose($aÔêå·Í¡³[$c§·‚È£éó[812]]); @unlink($aÔêå·Í¡³[$c§·‚È£éó[193]]); goto EãíĞÓùµ‚; CÌ§ËÔ°÷: } } goto CÊ¥áß ¬¯; fùŒ…‰: class PathDriverMinIO extends PathDriverBaseS3 { public function __construct($Aò‡Ë‹»…Ü) { parent::__construct($Aò‡Ë‹»…Ü); $this->signatureVersion($_SERVER[¬¦ã¾][212]); } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } } class PathDriverOOS extends PathDriverBaseS3 { public function __construct($eè‡çìô›) { parent::__construct($eè‡çìô›); $this->signatureVersion($_SERVER[¬¦ã¾][212]); } public function fileOutLink($e±Ñ¬†¦£) { $a¨µ…ˆåƒø =& $_SERVER[¬¦ã¾]; if (substr($e±Ñ¬†¦£, 0, 7) == $a¨µ…ˆåƒø[1195]) { $e±Ñ¬†¦£ = $a¨µ…ˆåƒø[1196] . substr($e±Ñ¬†¦£, 7); } header($a¨µ…ˆåƒø[159] . $e±Ñ¬†¦£); die; } } class PathDriverOSS extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $bucket = ''; protected $bucketAcl = ''; protected $endpoint = null; protected $client = null; public $ioUploadServer = "\60"; public $ioFileOutServer = "\60"; public $cdnHost = ''; public function __construct($EŒ‚À´Ùßˆ) { parent::__construct(); include_once SDK_DIR . $_SERVER[¬¦ã¾][1251]; $this->_init($EŒ‚À´Ùßˆ); } public function _init($DŠ‹—¥ïÎ¯) { $eİÄù„¯· =& $_SERVER[¬¦ã¾]; foreach ($DŠ‹—¥ïÎ¯ as $A³”ÓÊÍ => $Dî²ÑäÚ¹°) { if (isset($this->{$A³”ÓÊÍ})) { $this->{$A³”ÓÊÍ} = $Dî²ÑäÚ¹°; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { throw new Exception($eİÄù„¯·[1252] . LNG($eİÄù„¯·[1253])); } $this->client = new OSS\OssClient($this->accessKey, $this->secret, $this->domain); $this->client->setConnectTimeout(60); } public function setBucketCors() { goto Cù˜µó‰§À; AèôÊôˆÃˆ: $eœ“·ö”–¥->addAllowedMethod($Dˆ¢ó¢Ã¢Õ[1257]); $eœ“·ö”–¥->addAllowedMethod($Dˆ¢ó¢Ã¢Õ[1258]); $eœ“·ö”–¥->addAllowedMethod($Dˆ¢ó¢Ã¢Õ[158]); goto Fá¾›Û‘Ğ; Fá¾›Û‘Ğ: $eœ“·ö”–¥->setMaxAgeSeconds(600); $eœ“·ö”–¥->addExposeHeader($Dˆ¢ó¢Ã¢Õ[1259]); $eœ“·ö”–¥->addAllowedHeader($Dˆ¢ó¢Ã¢Õ[1254]); goto dÂ­ÛŸ‹¥¦; dÂ­ÛŸ‹¥¦: $Dô¿Û¤¹®->addRule($eœ“·ö”–¥); try { $this->client->putBucketCors($this->bucket, $Dô¿Û¤¹®); } catch (OSS\Core\OssException $fÖë”áÄÁÚ) { return !1; } return !0; goto c³¼¬è„†; BÚÓ²Äº«æ: $eœ“·ö”–¥->addAllowedOrigin($Dˆ¢ó¢Ã¢Õ[1254]); $eœ“·ö”–¥->addAllowedMethod($Dˆ¢ó¢Ã¢Õ[1255]); $eœ“·ö”–¥->addAllowedMethod($Dˆ¢ó¢Ã¢Õ[1256]); goto AèôÊôˆÃˆ; Cù˜µó‰§À: $Dˆ¢ó¢Ã¢Õ =& $_SERVER[¬¦ã¾]; $Dô¿Û¤¹® = new OSS\Model\CorsConfig(); $eœ“·ö”–¥ = new OSS\Model\CorsRule(); goto BÚÓ²Äº«æ; c³¼¬è„†: } public function getBucketCors() { goto b—­ŒÑµñß; E­¼‘ÁâŠ: if (!$B«ÃÜ£›ğ || !($cŒ» ì‹Ê = $B«ÃÜ£›ğ->getRules())) { return null; } $Dçœ‡Øñ£‡ = $cŒ» ì‹Ê[0]->getAllowedOrigins(); $C‹™› = $cŒ» ì‹Ê[0]->getAllowedMethods(); goto dÚŒÛ‘ø‡‹; b—­ŒÑµñß: $B­±‡Ûåçë =& $_SERVER[¬¦ã¾]; $B«ÃÜ£›ğ = null; try { $B«ÃÜ£›ğ = $this->client->getBucketCors($this->bucket); } catch (OSS\Core\OssException $CÛÅ‚µ¢ Á) { return null; } goto E­¼‘ÁâŠ; dÚŒÛ‘ø‡‹: $aÆ®ÃÉ ¹ë = $cŒ» ì‹Ê[0]->getMaxAgeSeconds(); $FÈ¶ìáÆ = $cŒ» ì‹Ê[0]->getExposeHeaders(); $D¤ §“¿Ğë = $cŒ» ì‹Ê[0]->getAllowedHeaders(); goto cŞÊÂİ¹‡; cŞÊÂİ¹‡: return array($B­±‡Ûåçë[181] => isset($Dçœ‡Øñ£‡[0]) ? $Dçœ‡Øñ£‡[0] : $B­±‡Ûåçë[33], $B­±‡Ûåçë[185] => $C‹™›, $B­±‡Ûåçë[1260] => $aÆ®ÃÉ ¹ë, $B­±‡Ûåçë[1261] => isset($FÈ¶ìáÆ[0]) ? $FÈ¶ìáÆ[0] : $B­±‡Ûåçë[33], $B­±‡Ûåçë[183] => isset($D¤ §“¿Ğë[0]) ? $D¤ §“¿Ğë[0] : $B­±‡Ûåçë[33]); goto DÑõ°ÅÅ; DÑõ°ÅÅ: } public function isBucketCors() { goto fÒå®¢ŠÉ¨; f°®¯—Ô‰ê: if ($aÊ²î÷Ù¦[$aã‹Œ¥‡Á[181]] != $aã‹Œ¥‡Á[182] || $aÊ²î÷Ù¦[$aã‹Œ¥‡Á[183]] != $aã‹Œ¥‡Á[182]) { return !1; } $cÅŞã‡Î“Ê = array_map($aã‹Œ¥‡Á[184], $aÊ²î÷Ù¦[$aã‹Œ¥‡Á[185]]); if (!is_array($cÅŞã‡Î“Ê)) { $cÅŞã‡Î“Ê = array(); } goto DÖ†ò•”õ‹; fÒå®¢ŠÉ¨: $aã‹Œ¥‡Á =& $_SERVER[¬¦ã¾]; $aÊ²î÷Ù¦ = $this->getBucketCors(); if (!$aÊ²î÷Ù¦ || !is_array($aÊ²î÷Ù¦)) { return !1; } goto f°®¯—Ô‰ê; DÖ†ò•”õ‹: $aâ«ğ¦ùÂç = array($aã‹Œ¥‡Á[186], $aã‹Œ¥‡Á[187], $aã‹Œ¥‡Á[188], $aã‹Œ¥‡Á[189], $aã‹Œ¥‡Á[190]); $fÅÌ‰öõæØ = array_diff($aâ«ğ¦ùÂç, $cÅŞã‡Î“Ê); return empty($fÅÌ‰öõæØ); goto AˆÒòâÊÎá; AˆÒòâÊÎá: } public function mkfile($d¢ˆ¦¤¸è, $A¤œ‹×†â = '', $F¤õ•ÎÔ‘Æ = REPEAT_RENAME) { $B˜ŞˆÛ«“Ó = $this->setContent($d¢ˆ¦¤¸è, $A¤œ‹×†â); if ($B˜ŞˆÛ«“Ó !== !1) { return $this->getPathOuter($d¢ˆ¦¤¸è); } return !1; } public function mkdir($c®ãÎæº¦, $böĞïÔñÆ¾ = REPEAT_SKIP) { if ($this->_isFolder($c®ãÎæº¦)) { return $this->getPathOuter($c®ãÎæº¦); } try { $this->client->createObjectDir($this->bucket, $this->pathEncode($c®ãÎæº¦)); } catch (OSS\Core\OssException $C†”…·ÅÇ) { return !1; } return $this->getPathOuter($c®ãÎæº¦); } private function fileList($CÃ’›Ö®¾, $bœ§¨ÁØÔ = '', $eáî¡ÓƒªŸ = 0) { goto D–íõº‘”; D–íõº‘”: $e¥ñ‹¶ŠáÏ =& $_SERVER[¬¦ã¾]; $CÃ’›Ö®¾ = trim($CÃ’›Ö®¾, $e¥ñ‹¶ŠáÏ[8]); $Aî™ÏŒ»Á¬ = empty($CÃ’›Ö®¾) && $CÃ’›Ö®¾ !== $e¥ñ‹¶ŠáÏ[191] ? $e¥ñ‹¶ŠáÏ[33] : $CÃ’›Ö®¾ . $e¥ñ‹¶ŠáÏ[8]; goto DøŠÃÀÓ¬É; DÙ„à–¤êß: $dÑï‰Ã•» = $cœŠäïá = array(); while (!0) { check_abort(); $E¦¶¤¨ÚÁø = array($e¥ñ‹¶ŠáÏ[1262] => $bœ§¨ÁØÔ, $e¥ñ‹¶ŠáÏ[1263] => $Aî™ÏŒ»Á¬, $e¥ñ‹¶ŠáÏ[1264] => $eãÊâÂÜ…É, $e¥ñ‹¶ŠáÏ[1265] => $D©ÃŸöéßí); try { $A…ÌĞ·ÔÚ = $this->client->listObjects($this->bucket, $E¦¶¤¨ÚÁø); } catch (OSS\Core\OssException $BÓ¼š„ÆÂ) { break; } $D©ÃŸöéßí = $A…ÌĞ·ÔÚ->getNextMarker(); $EÑºÀ®µšÍ = $A…ÌĞ·ÔÚ->getObjectList(); $f¤¸ÓÀ³ä = $A…ÌĞ·ÔÚ->getPrefixList(); foreach ($EÑºÀ®µšÍ as $aÉÖÜå¥Ï±) { goto C¤¹ÈÌîÛ; C¤¹ÈÌîÛ: if ($aÉÖÜå¥Ï±->getKey() == $Aî™ÏŒ»Á¬) { continue; } $B¾âÓŸ±íå = $aÉÖÜå¥Ï±->getKey(); $bë²ò¾ƒ‰ = $aÉÖÜå¥Ï±->getSize(); goto EµîÚŒƒÀ; EµîÚŒƒÀ: $câ‘ÚÏÕ× = $aÉÖÜå¥Ï±->getLastModified(); $d‚”™Úø£­ = $eáî¡ÓƒªŸ ? array($e¥ñ‹¶ŠáÏ[28] => $B¾âÓŸ±íå, $e¥ñ‹¶ŠáÏ[78] => $bë²ò¾ƒ‰, $e¥ñ‹¶ŠáÏ[197] => strtotime($câ‘ÚÏÕ×)) : $B¾âÓŸ±íå; $b´ŞçŠ«§‘ = $bë²ò¾ƒ‰ == 0 && substr($B¾âÓŸ±íå, strlen($B¾âÓŸ±íå) - 1, 1) == $e¥ñ‹¶ŠáÏ[8] ? !0 : !1; goto d³–Ç««Ñ˜; d³–Ç««Ñ˜: if ($e¤ˆÃ»Ş§›) { $this->cacheMethod($e¥ñ‹¶ŠáÏ[199], $B¾âÓŸ±íå, $b´ŞçŠ«§‘); $this->cacheMethod($e¥ñ‹¶ŠáÏ[200], $B¾âÓŸ±íå, array($e¥ñ‹¶ŠáÏ[78] => $bë²ò¾ƒ‰, $e¥ñ‹¶ŠáÏ[1266] => $bë²ò¾ƒ‰, $e¥ñ‹¶ŠáÏ[84] => strtotime($câ‘ÚÏÕ×), $e¥ñ‹¶ŠáÏ[1267] => $câ‘ÚÏÕ×)); } if ($b´ŞçŠ«§‘) { $dÑï‰Ã•»[] = $B¾âÓŸ±íå; continue; } $cœŠäïá[] = $d‚”™Úø£­; goto añ“¢«æ„˜; añ“¢«æ„˜: } foreach ($f¤¸ÓÀ³ä as $FÄÛ²Ó²š) { $dÑï‰Ã•»[] = $FÄÛ²Ó²š->getPrefix(); if ($e¤ˆÃ»Ş§›) { $this->cacheMethod($e¥ñ‹¶ŠáÏ[199], $B¾âÓŸ±íå, !0); } } if ($D©ÃŸöéßí === $e¥ñ‹¶ŠáÏ[33]) { break; } } if ($e¤ˆÃ»Ş§›) { $this->cacheMethod($e¥ñ‹¶ŠáÏ[199], $CÃ’›Ö®¾, !0); } goto a…“ºçó‰Ÿ; a…“ºçó‰Ÿ: return array($e¥ñ‹¶ŠáÏ[75] => $dÑï‰Ã•», $e¥ñ‹¶ŠáÏ[74] => $cœŠäïá); goto AÖ•ê”¼º”; DøŠÃÀÓ¬É: $D©ÃŸöéßí = $e¥ñ‹¶ŠáÏ[33]; $eãÊâÂÜ…É = 1000; $e¤ˆÃ»Ş§› = $this->listItemCache === !1 ? !1 : !0; goto DÙ„à–¤êß; AÖ•ê”¼º”: } public function copyFile($B‚·²ó‚¡¹, $CÂ”ï£Ñ¹) { $A‡à•„›ìê = $this->size($B‚·²ó‚¡¹); if ($A‡à•„›ìê < 1024 * 1024 * 1024) { try { $this->client->copyObject($this->bucket, $B‚·²ó‚¡¹, $this->bucket, $this->pathEncode($CÂ”ï£Ñ¹)); } catch (OSS\Core\OssException $EÅø‰µÓ) { return !1; } return $this->getPathOuter($CÂ”ï£Ñ¹); } $F…ğì¿ª’í = $this->multiCopyObject($B‚·²ó‚¡¹, $CÂ”ï£Ñ¹, $A‡à•„›ìê); return $F…ğì¿ª’í ? $this->getPathOuter($CÂ”ï£Ñ¹) : !1; } private function multiCopyObject($b­ç¼¬®¸à, $dõÙìÀ¥Şñ, $fàŒç‹¥Ú¨) { $F›­‡îİ½å =& $_SERVER[¬¦ã¾]; try { goto B¹«Ğ°¾Ü; B¹«Ğ°¾Ü: $AÎ°¼ÛâßÅ = array(); if ($FÂ»Õ¦ëè‡ = $this->hashMd5($b­ç¼¬®¸à)) { $AÎ°¼ÛâßÅ = array(OSS\OssClient::OSS_HEADERS => array($F›­‡îİ½å[1268] => $FÂ»Õ¦ëè‡)); } $a¹œİè‚Éê = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($dõÙìÀ¥Şñ), $AÎ°¼ÛâßÅ); goto fè±ô¹ëºÕ; fè±ô¹ëºÕ: $c®ôâ´·¤¢ = 1; $EˆÇì†»¨ = 0; $Aàîß‰óé‚ = array(); goto fİğÛåêİã; EÑÕÁ°ùò: $bŠ™Ù¸Ÿ¨« = array(); foreach ($Aàîß‰óé‚ as $Bàˆ¾òóñ => $EÃŒÅšÒ¹ë) { $bŠ™Ù¸Ÿ¨«[] = array($F›­‡îİ½å[1272] => $Bàˆ¾òóñ + 1, $F›­‡îİ½å[1273] => $EÃŒÅšÒ¹ë); } $this->client->completeMultipartUpload($this->bucket, $this->pathEncode($dõÙìÀ¥Şñ), $a¹œİè‚Éê, $bŠ™Ù¸Ÿ¨«); goto e‡Ş„ßØİì; fİğÛåêİã: $E‚í‰ïÔÊ† = 1024 * 1024 * 10; $eÌä‹ªß‡ = $this->client->generateMultiuploadParts($fàŒç‹¥Ú¨, $E‚í‰ïÔÊ†); foreach ($eÌä‹ªß‡ as $Bàˆ¾òóñ => $b’¸Àµ‰Áè) { $A‡ˆßãµ¥÷ = $EˆÇì†»¨ + (int) $b’¸Àµ‰Áè[$F›­‡îİ½å[1269]]; $C¡×áÅ›¾á = (int) $b’¸Àµ‰Áè[$F›­‡îİ½å[335]] + $A‡ˆßãµ¥÷ - 1; $EóÏĞ’­Ôà = array($F›­‡îİ½å[1270] => $A‡ˆßãµ¥÷, $F›­‡îİ½å[1271] => $C¡×áÅ›¾á); $Aàîß‰óé‚[] = $this->client->uploadPartCopy($this->bucket, $b­ç¼¬®¸à, $this->bucket, $this->pathEncode($dõÙìÀ¥Şñ), $c®ôâ´·¤¢, $a¹œİè‚Éê, $EóÏĞ’­Ôà); $c®ôâ´·¤¢ = $c®ôâ´·¤¢ + 1; } goto EÑÕÁ°ùò; e‡Ş„ßØİì: } catch (OSS\Core\OssException $BàÉµ¾×À›) { return !1; } return !0; } public function moveFile($C«‰ó‚î†‘, $Cå—³ğé„¹) { if ($this->copyFile($C«‰ó‚î†‘, $Cå—³ğé„¹)) { $this->remove($C«‰ó‚î†‘); return $this->getPathOuter($Cå—³ğé„¹); } return !1; } public function delFile($FíëÆª˜ ‰) { try { $this->client->deleteObject($this->bucket, $this->pathEncode($FíëÆª˜ ‰)); } catch (OSS\Core\OssException $b¡¸§ìØöá) { return !1; } return !0; } public function delFolder($Dß±±àòÕ…) { goto E¸²—óÑó; bî±ëÁ£: $c¼óÉÂ¢Æí = $this->delByBatch($B¶ÉÉ™•«ä[$E…›ø¶ÛÔâ[75]]); if (!$c¼óÉÂ¢Æí) { return !1; } return $this->delFile($A…™›–ˆÍ); goto AŠˆï±¹–µ; E¸²—óÑó: $E…›ø¶ÛÔâ =& $_SERVER[¬¦ã¾]; if (!$this->exist($Dß±±àòÕ…)) { return !0; } $this->listItemCache = !1; goto dš½Ü¶íŒŠ; dš½Ü¶íŒŠ: $B¶ÉÉ™•«ä = $this->fileList($Dß±±àòÕ…); $this->listItemCache = !0; $A…™›–ˆÍ = trim($Dß±±àòÕ…, $E…›ø¶ÛÔâ[8]) . $E…›ø¶ÛÔâ[8]; goto fŠìé£²; fŠìé£²: if (!empty($Dß±±àòÕ…) && $Dß±±àòÕ… !== $E…›ø¶ÛÔâ[191] && !in_array($A…™›–ˆÍ, $B¶ÉÉ™•«ä[$E…›ø¶ÛÔâ[75]])) { $B¶ÉÉ™•«ä[$E…›ø¶ÛÔâ[75]][] = $A…™›–ˆÍ; } $c¼óÉÂ¢Æí = $this->delByBatch($B¶ÉÉ™•«ä[$E…›ø¶ÛÔâ[74]]); if (!$c¼óÉÂ¢Æí) { return !1; } goto bî±ëÁ£; AŠˆï±¹–µ: } private function delByBatch($B•İÓİ‹¨ª) { foreach (array_chunk($B•İÓİ‹¨ª, 1000) as $Eƒ×Àñ…ùº) { try { $this->client->deleteObjects($this->bucket, $Eƒ×Àñ…ùº); } catch (OSS\Core\OssException $BÅ‰ğ‡†‹²) { return !1; } } return !0; } public function rename($BÉ‡âñùß«, $AÓ§ñ“¦ô) { return $this->renameObject($BÉ‡âñùß«, $AÓ§ñ“¦ô); } private function fileInfo($F¢Äí‰«‰£, $b¤®åƒÄ§ = false, $a¥Æì¯±ŒŸ = array()) { goto a¾Òº‚Ä¶™; DšÃùªìè: $CŒƒÆÉ»¦[$dò¬‹ÏÔ¹[194]] = $CŒƒÆÉ»¦[$dò¬‹ÏÔ¹[84]] = 0; $CŒƒÆÉ»¦[$dò¬‹ÏÔ¹[195]] = $CŒƒÆÉ»¦[$dò¬‹ÏÔ¹[196]] = !0; if (empty($a¥Æì¯±ŒŸ)) { $f¢à°³æÅ = $this->objectMeta($F¢Äí‰«‰£); if (!$f¢à°³æÅ) { return $CŒƒÆÉ»¦; } $a¥Æì¯±ŒŸ = array($dò¬‹ÏÔ¹[84] => strtotime($f¢à°³æÅ[$dò¬‹ÏÔ¹[1267]]), $dò¬‹ÏÔ¹[78] => $f¢à°³æÅ[$dò¬‹ÏÔ¹[1266]] + 0); } goto dò‘¹ÎğÜ; a¾Òº‚Ä¶™: $dò¬‹ÏÔ¹ =& $_SERVER[¬¦ã¾]; $CŒƒÆÉ»¦ = array($dò¬‹ÏÔ¹[28] => $this->pathThis($F¢Äí‰«‰£), $dò¬‹ÏÔ¹[76] => $this->getPathOuter($F¢Äí‰«‰£), $dò¬‹ÏÔ¹[29] => $dò¬‹ÏÔ¹[193], $dò¬‹ÏÔ¹[78] => isset($a¥Æì¯±ŒŸ[$dò¬‹ÏÔ¹[78]]) ? $a¥Æì¯±ŒŸ[$dò¬‹ÏÔ¹[78]] : 0, $dò¬‹ÏÔ¹[168] => $this->ext($F¢Äí‰«‰£)); if ($b¤®åƒÄ§) { return $CŒƒÆÉ»¦; } goto DšÃùªìè; Bøóö©‹ö£: return $CŒƒÆÉ»¦; goto EÃµ‡çØØ‚; dò‘¹ÎğÜ: if (isset($a¥Æì¯±ŒŸ[$dò¬‹ÏÔ¹[78]])) { $CŒƒÆÉ»¦[$dò¬‹ÏÔ¹[78]] = $a¥Æì¯±ŒŸ[$dò¬‹ÏÔ¹[78]]; } if (isset($a¥Æì¯±ŒŸ[$dò¬‹ÏÔ¹[84]])) { $CŒƒÆÉ»¦[$dò¬‹ÏÔ¹[84]] = $a¥Æì¯±ŒŸ[$dò¬‹ÏÔ¹[84]]; } if (isset($a¥Æì¯±ŒŸ[$dò¬‹ÏÔ¹[197]]) && !trim($CŒƒÆÉ»¦[$dò¬‹ÏÔ¹[84]])) { $CŒƒÆÉ»¦[$dò¬‹ÏÔ¹[84]] = $a¥Æì¯±ŒŸ[$dò¬‹ÏÔ¹[197]]; } goto Bøóö©‹ö£; EÃµ‡çØØ‚: } private function folderInfo($eë¢Áë“», $E‰ËíÎŒóŸ = false, $b›Ã›œªÌÛ = array()) { goto b¹¡ôß; b¹¡ôß: $c‡ÄøĞÒĞ° =& $_SERVER[¬¦ã¾]; $fñ™åˆÎÔ = array($c‡ÄøĞÒĞ°[28] => $this->pathThis($eë¢Áë“»), $c‡ÄøĞÒĞ°[76] => $this->getPathOuter($c‡ÄøĞÒĞ°[8] . $eë¢Áë“»), $c‡ÄøĞÒĞ°[29] => $c‡ÄøĞÒĞ°[77]); if ($E‰ËíÎŒóŸ) { return $fñ™åˆÎÔ; } goto B¢·‡–¥»; B¢·‡–¥»: $fñ™åˆÎÔ[$c‡ÄøĞÒĞ°[194]] = $fñ™åˆÎÔ[$c‡ÄøĞÒĞ°[84]] = 0; $fñ™åˆÎÔ[$c‡ÄøĞÒĞ°[195]] = $fñ™åˆÎÔ[$c‡ÄøĞÒĞ°[196]] = !0; if (empty($b›Ã›œªÌÛ)) { $eë¢Áë“» = rtrim($eë¢Áë“», $c‡ÄøĞÒĞ°[8]) . $c‡ÄøĞÒĞ°[8]; $C¸ˆŞ¡Ü…© = $this->objectMeta($eë¢Áë“»); if (!$C¸ˆŞ¡Ü…©) { return $fñ™åˆÎÔ; } $b›Ã›œªÌÛ = array($c‡ÄøĞÒĞ°[194] => $C¸ˆŞ¡Ü…©[$c‡ÄøĞÒĞ°[1274]][$c‡ÄøĞÒĞ°[1275]], $c‡ÄøĞÒĞ°[84] => strtotime($C¸ˆŞ¡Ü…©[$c‡ÄøĞÒĞ°[1267]])); } goto B„¹‹œê’æ; B„¹‹œê’æ: if (isset($b›Ã›œªÌÛ[$c‡ÄøĞÒĞ°[84]])) { $fñ™åˆÎÔ[$c‡ÄøĞÒĞ°[84]] = $b›Ã›œªÌÛ[$c‡ÄøĞÒĞ°[84]]; } if (isset($b›Ã›œªÌÛ[$c‡ÄøĞÒĞ°[194]])) { $fñ™åˆÎÔ[$c‡ÄøĞÒĞ°[194]] = $b›Ã›œªÌÛ[$c‡ÄøĞÒĞ°[194]]; } return $fñ™åˆÎÔ; goto aƒöø´ëê; aƒöø´ëê: } public function listPath($A£ÍŸ–©¼, $E‹àŒç÷ = false) { $d““„¢‡õˆ =& $_SERVER[¬¦ã¾]; $aÀ×ä–Â¬Î = $this->fileList($A£ÍŸ–©¼, $d““„¢‡õˆ[8], !0); foreach ($aÀ×ä–Â¬Î[$d““„¢‡õˆ[75]] as $D™÷¾§Ø => $bÓô¦§Õƒ) { $aÀ×ä–Â¬Î[$d““„¢‡õˆ[75]][$D™÷¾§Ø] = $this->folderInfo($bÓô¦§Õƒ, $E‹àŒç÷, $bÓô¦§Õƒ); } foreach ($aÀ×ä–Â¬Î[$d““„¢‡õˆ[74]] as $D™÷¾§Ø => $bÓô¦§Õƒ) { $aÀ×ä–Â¬Î[$d““„¢‡õˆ[74]][$D™÷¾§Ø] = $this->fileInfo($bÓô¦§Õƒ[$d““„¢‡õˆ[28]], $E‹àŒç÷, $bÓô¦§Õƒ); } return $aÀ×ä–Â¬Î; } public function has($D¸ŸÒì¬ŠÊ, $aÚ›‡«Ê‚Å = false, $A×œãÆ·ì = true) { goto D†‚à¹Ò™Ã; e³È–ÊèÊœ: $a¹èí’øøÇ = $d¯Æ‘İù‚[33]; $Eà÷÷ËĞÃ = 500; $EÖ“¾õ¹Õ¥ = $e—á¸èŠ³ = 0; goto b¨ÒÒ»“£Ä; b¨ÒÒ»“£Ä: while (!0) { check_abort(); $Dµ¥´ĞòŒÔ = array($d¯Æ‘İù‚[1262] => $d¯Æ‘İù‚[8], $d¯Æ‘İù‚[1263] => $DÉ„¾Íî, $d¯Æ‘İù‚[1264] => $Eà÷÷ËĞÃ, $d¯Æ‘İù‚[1265] => $a¹èí’øøÇ); try { $FÄ´²õâÅæ = $this->client->listObjects($this->bucket, $Dµ¥´ĞòŒÔ); } catch (OSS\Core\OssException $B×ÜÊùÎŒÙ) { break; } $a¹èí’øøÇ = $FÄ´²õâÅæ->getNextMarker(); $C•ò”„öóÇ = $FÄ´²õâÅæ->getObjectList(); $fËí…ƒ³¬ = $FÄ´²õâÅæ->getPrefixList(); if ($aÚ›‡«Ê‚Å) { if (count($C•ò”„öóÇ) > 1 || count($C•ò”„öóÇ) == 1 && $C•ò”„öóÇ[0]->getKey() != $DÉ„¾Íî) { $EÖ“¾õ¹Õ¥ += count($C•ò”„öóÇ) - 1; } if (!empty($fËí…ƒ³¬)) { $e—á¸èŠ³ += count($fËí…ƒ³¬); } if ($a¹èí’øøÇ === $d¯Æ‘İù‚[33]) { break; } continue; } if ($A×œãÆ·ì) { if (!empty($C•ò”„öóÇ)) { if (count($C•ò”„öóÇ) > 1 || $C•ò”„öóÇ[0]->getKey() != $DÉ„¾Íî) { return !0; } } } else { if (!empty($fËí…ƒ³¬)) { return !0; } } if ($a¹èí’øøÇ === $d¯Æ‘İù‚[33]) { break; } } if ($aÚ›‡«Ê‚Å) { return array($d¯Æ‘İù‚[203] => $EÖ“¾õ¹Õ¥, $d¯Æ‘İù‚[204] => $e—á¸èŠ³); } return !1; goto EÃ¨Èæ» …; D†‚à¹Ò™Ã: $d¯Æ‘İù‚ =& $_SERVER[¬¦ã¾]; $D¸ŸÒì¬ŠÊ = trim($D¸ŸÒì¬ŠÊ, $d¯Æ‘İù‚[8]); $DÉ„¾Íî = empty($D¸ŸÒì¬ŠÊ) && $D¸ŸÒì¬ŠÊ !== $d¯Æ‘İù‚[191] ? $d¯Æ‘İù‚[33] : $D¸ŸÒì¬ŠÊ . $d¯Æ‘İù‚[8]; goto e³È–ÊèÊœ; EÃ¨Èæ» …: } public function listAll($döÀ·–ã) { $bäîÔ—Àà =& $_SERVER[¬¦ã¾]; $bŸùÑ·ÆŠ = $this->fileList($döÀ·–ã, $bäîÔ—Àà[33], !0); $E­ÁŞ”ˆÉÆ = array(); foreach ($bŸùÑ·ÆŠ[$bäîÔ—Àà[74]] as $fÌ„Óˆ°¨¦) { $E­ÁŞ”ˆÉÆ[$fÌ„Óˆ°¨¦[$bäîÔ—Àà[28]]] = $fÌ„Óˆ°¨¦[$bäîÔ—Àà[78]]; } foreach ($bŸùÑ·ÆŠ[$bäîÔ—Àà[75]] as $fÌ„Óˆ°¨¦) { if (is_string($fÌ„Óˆ°¨¦)) { $E­ÁŞ”ˆÉÆ[$fÌ„Óˆ°¨¦] = 0; } } return $this->listAllFiles($döÀ·–ã, array_keys($E­ÁŞ”ˆÉÆ), $E­ÁŞ”ˆÉÆ); } public function canRead($bøŠğ²†Ú) { $CÑø‚¹®êª =& $_SERVER[¬¦ã¾]; $e÷†Œ»‹Œè = $this->pathAcl($bøŠğ²†Ú); return $e÷†Œ»‹Œè == $CÑø‚¹®êª[1276] || $e÷†Œ»‹Œè == $CÑø‚¹®êª[519] ? !0 : !1; } public function canWrite($eíìÅ¾¡‘) { $D‹®»Í³ƒ  = $this->pathAcl($eíìÅ¾¡‘); return $D‹®»Í³ƒ  == $_SERVER[¬¦ã¾][519] ? !0 : !1; } public function pathAcl($eí‘é‹‹ô) { goto Bê¤˜¢Ò°­; Bê¤˜¢Ò°­: $c®ÕÏøË’ =& $_SERVER[¬¦ã¾]; if (empty($this->bucketAcl)) { $this->bucketAcl = $this->client->getBucketAcl($this->bucket); } try { $e…Ğ«¶×Æ = $this->client->getObjectAcl($this->bucket, $this->pathEncode($eí‘é‹‹ô)); } catch (OSS\Core\OssException $B Äøˆ¯í³) { return !1; } goto eİ‚Õ˜°†ô; eİ‚Õ˜°†ô: $EºçáÜ¿‚® = $e…Ğ«¶×Æ == $c®ÕÏøË’[34] ? $this->bucketAcl : $e…Ğ«¶×Æ; if ($EºçáÜ¿‚® == $c®ÕÏøË’[1277]) { return $c®ÕÏøË’[1276]; } if ($EºçáÜ¿‚® == $c®ÕÏøË’[1278]) { return $c®ÕÏøË’[519]; } goto D·óÂ¡Ö·…; D·óÂ¡Ö·…: return $EºçáÜ¿‚®; goto d£—ŞİˆÌñ; d£—ŞİˆÌñ: } private function chmodPath($f—åÜ®’¡ï, $F¯í¼Òİ = '') { $fâ¨Ç¢–” =& $_SERVER[¬¦ã¾]; $Dï¨ÄÑÕˆ = empty($F¯í¼Òİ) ? $fâ¨Ç¢–”[1278] : $F¯í¼Òİ; $DãäÊ§Ş¢¤ = array($fâ¨Ç¢–”[34], $fâ¨Ç¢–”[192], $fâ¨Ç¢–”[1277], $fâ¨Ç¢–”[1278]); if (!in_array($Dï¨ÄÑÕˆ, $DãäÊ§Ş¢¤)) { return !1; } try { $this->client->putObjectAcl($this->bucket, $this->pathEncode($f—åÜ®’¡ï), $Dï¨ÄÑÕˆ); } catch (OSS\Core\OssException $d°ßº­ˆÆ) { return !1; } return !0; } public function getContent($bãòù›®²”) { return $this->fileSubstr($bãòù›®²”, -1); } public function setContent($D½º˜ó«À¼, $eîßÎË³š = '') { $DŒñõ‹¤× =& $_SERVER[¬¦ã¾]; try { $B¤í¯ÃËŸ = $this->trafficLimit($DŒñõ‹¤×[1279]); $CäåĞ‘Ëßø = $this->client->putObject($this->bucket, $this->pathEncode($D½º˜ó«À¼), $eîßÎË³š, $B¤í¯ÃËŸ); } catch (OSS\Core\OssException $b†÷õğÆÒ) { return !1; } $d¾ãùåË’Æ = array($DŒñõ‹¤×[1268] => trim($CäåĞ‘Ëßø[$DŒñõ‹¤×[1280]], $DŒñõ‹¤×[116]), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($D½º˜ó«À¼))); $this->updateObjMeta($D½º˜ó«À¼, $d¾ãùåË’Æ); return isset($CäåĞ‘Ëßø[$DŒñõ‹¤×[1281]][$DŒñõ‹¤×[1227]]) ? !0 : !1; } private function updateObjMeta($càò˜ÔÈÔ, $C¹à‡µ¬Ğ¾) { $càò˜ÔÈÔ = $this->pathEncode($càò˜ÔÈÔ); try { $F¿”ò‰«× = array(OSS\OssClient::OSS_HEADERS => $C¹à‡µ¬Ğ¾); $this->client->copyObject($this->bucket, $càò˜ÔÈÔ, $this->bucket, $càò˜ÔÈÔ, $F¿”ò‰«×); } catch (OSS\Core\OssException $aãöäœìù) { return !1; } return !0; } public function upload($cÒœ÷†«ëã, $fáÓÂ×©×ø, $Fº©Å¨éæ = false, $Aâ‚Ğ‰Ê® = REPEAT_REPLACE) { $Dç‰óƒ‡ =& $_SERVER[¬¦ã¾]; $f×îˆÚ²æÀ = trim($cÒœ÷†«ëã, $Dç‰óƒ‡[8]); $A†Å—ñğ°í = array(OSS\OssClient::OSS_CHECK_MD5 => !0, OSS\OssClient::OSS_PART_SIZE => 1024 * 1024 * 10, OSS\OssClient::OSS_HEADERS => array($Dç‰óƒ‡[1268] => @md5_file($fáÓÂ×©×ø)), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($cÒœ÷†«ëã))); $A†Å—ñğ°í = $this->trafficLimit($Dç‰óƒ‡[1279], $A†Å—ñğ°í); try { $this->client->multiuploadFile($this->bucket, $this->pathEncode($f×îˆÚ²æÀ), $fáÓÂ×©×ø, $A†Å—ñğ°í); } catch (OSS\Core\OssException $E­ê²åÃò¢) { return !1; } return $this->getPathOuter($cÒœ÷†«ëã); } public function getHost() { $cÆó›±ÀŒÌ =& $_SERVER[¬¦ã¾]; $f¼îö•öÓù = explode($cÆó›±ÀŒÌ[177], parent::getHost()); return $f¼îö•öÓù[0] . $cÆó›±ÀŒÌ[177] . $this->bucket . $cÆó›±ÀŒÌ[95] . $f¼îö•öÓù[1]; } public function uploadFormData($f»ÎÀ£Ë›ò, $dÇºê–—‚ì = 3600) { goto DµÚÙ¥ÃÅŸ; f®±ÜÌ‹ë‘: $A‚áÀó‘ó = $this->pathFather($f»ÎÀ£Ë›ò); $cÆœóÖÃîº = array($EŠ™µˆ…Ö[1182] => $Bœñ—‡§î, $EŠ™µˆ…Ö[1183] => array(array($EŠ™µˆ…Ö[1284], 0, $AÑåÆˆÑæ), array($EŠ™µˆ…Ö[1186], $EŠ™µˆ…Ö[1187], $A‚áÀó‘ó))); $F—ìßáÙÛÄ = base64_encode(json_encode($cÆœóÖÃîº)); goto bÊÓ¢Ş‘ ; bÊÓ¢Ş‘ : $A‡ ÃÌ¦¤µ = base64_encode(hash_hmac($EŠ™µˆ…Ö[230], $F—ìßáÙÛÄ, $this->secret, !0)); $BÈË Œ“Ú¡ = array($EŠ™µˆ…Ö[1192] => $F—ìßáÙÛÄ, $EŠ™µˆ…Ö[1285] => $this->accessKey, $EŠ™µˆ…Ö[1188] => $EŠ™µˆ…Ö[1180], $EŠ™µˆ…Ö[1286] => $A‡ ÃÌ¦¤µ, $EŠ™µˆ…Ö[175] => $Bˆˆ»ÀÕ®†); $BÈË Œ“Ú¡ = $this->trafficLimit($EŠ™µˆ…Ö[1279], $BÈË Œ“Ú¡); goto E÷Ê±ùÜÎÊ; B…ÅÅòÍÑ§: $a—¼Æ™ = date($EŠ™µˆ…Ö[1282], time() + $f„¤Ò¸‡¡„); $D¬îê½¶Ã = new DateTime($a—¼Æ™); $Bœñ—‡§î = $D¬îê½¶Ã->format(DateTime::ISO8601); goto EíóšçÂÀ‹; DµÚÙ¥ÃÅŸ: $EŠ™µˆ…Ö =& $_SERVER[¬¦ã¾]; if (!($Bˆˆ»ÀÕ®† = $this->getHost())) { return !1; } $f„¤Ò¸‡¡„ = $dÇºê–—‚ì; goto B…ÅÅòÍÑ§; E÷Ê±ùÜÎÊ: return $BÈË Œ“Ú¡; goto a®¶ñÄ×«; EíóšçÂÀ‹: $aŠÊŒ¦²®¨ = strpos($Bœñ—‡§î, $EŠ™µˆ…Ö[294]); $Bœñ—‡§î = substr($Bœñ—‡§î, 0, $aŠÊŒ¦²®¨) . $EŠ™µˆ…Ö[1283]; $AÑåÆˆÑæ = 1048576000 * 5; goto f®±ÜÌ‹ë‘; a®¶ñÄ×«: } public function multiUploadFormData($B´ÒÖóğ½à, $F»¬”˜ŠÍ† = 3600) { $dÍ‡¢Î…ô =& $_SERVER[¬¦ã¾]; if (!($B¸ö•³ë´¨ = $this->getHost())) { return !1; } $A—Ÿ‡¡Òµ› = $this->trafficLimit($dÍ‡¢Î…ô[1279]); $BÈç …°´… = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($B´ÒÖóğ½à), $A—Ÿ‡¡Òµ›); return array($dÍ‡¢Î…ô[221] => $BÈç …°´…, $dÍ‡¢Î…ô[175] => $B¸ö•³ë´¨ . $dÍ‡¢Î…ô[8] . $this->pathEncode($B´ÒÖóğ½à), $dÍ‡¢Î…ô[222] => gmdate($dÍ‡¢Î…ô[1287]), $dÍ‡¢Î…ô[93] => $B´ÒÖóğ½à); } public function multiUploadAuthData($DŞ•½™ëÖò, $fçêƒö±® = array()) { goto d“†¡‘µ‘’; d“†¡‘µ‘’: $d©²Øø¿šâ =& $_SERVER[¬¦ã¾]; $Dİ­±ë¨Ö• = isset($fçêƒö±®[$d©²Øø¿šâ[222]]) ? $fçêƒö±®[$d©²Øø¿šâ[222]] : gmdate($d©²Øø¿šâ[1287]); $fÍ„áÓ‰É = isset($fçêƒö±®[$d©²Øø¿šâ[168]]) ? $fçêƒö±®[$d©²Øø¿šâ[168]] : $d©²Øø¿šâ[33]; goto eõêÈòæ; a¯ö„è®øË: $D¦ê‚‹„¸ß = array($d©²Øø¿šâ[224], $d©²Øø¿šâ[33], $d©²Øø¿šâ[119], $Dİ­±ë¨Ö•, "\170\55\157\x73\163\x2d\x64\x61\164\145\x3a{$Dİ­±ë¨Ö•}", $d©²Øø¿šâ[8] . $this->bucket . $d©²Øø¿šâ[8] . $B±¸Òùî”Å . $fÍ„áÓ‰É); if (strpos($fÍ„áÓ‰É, $d©²Øø¿šâ[225]) === 0) { $D¦ê‚‹„¸ß[0] = $d©²Øø¿šâ[226]; if ($cÏÀ„¤¡¦ = $this->trafficLimit($d©²Øø¿šâ[1279])) { $B±¸Òùî”Å = $d©²Øø¿šâ[1288]; array_splice($D¦ê‚‹„¸ß, 5, 0, $B±¸Òùî”Å . $d©²Øø¿šâ[4] . $cÏÀ„¤¡¦[$B±¸Òùî”Å]); } } if (isset($fçêƒö±®[$d©²Øø¿šâ[227]]) && $fçêƒö±®[$d©²Øø¿šâ[227]] == $d©²Øø¿šâ[228]) { $D¦ê‚‹„¸ß[0] = $d©²Øø¿šâ[228]; } goto C¤ğ´¢ÉÜñ; eõêÈòæ: $B±¸Òùî”Å = $DŞ•½™ëÖò; if (isset($fçêƒö±®[$d©²Øø¿šâ[93]])) { $B±¸Òùî”Å = $fçêƒö±®[$d©²Øø¿šâ[93]]; unset($fçêƒö±®[$d©²Øø¿šâ[93]]); } if (isset($fçêƒö±®[$d©²Øø¿šâ[223]])) { $fçêƒö±®[$d©²Øø¿šâ[222]] = $Dİ­±ë¨Ö•; return $this->listUploadParts($B±¸Òùî”Å, $fçêƒö±®); } goto a¯ö„è®øË; C¤ğ´¢ÉÜñ: if (!empty($fçêƒö±®[$d©²Øø¿šâ[1289]])) { $F­¸÷ô„ = array_merge(array($D¦ê‚‹„¸ß[4]), $fçêƒö±®[$d©²Øø¿šâ[1289]]); sort($F­¸÷ô„); $D¦ê‚‹„¸ß[4] = implode($d©²Øø¿šâ[229], $F­¸÷ô„); } $C²øÕ²Ëåó = implode($d©²Øø¿šâ[229], $D¦ê‚‹„¸ß); $e‰ÜÙƒÉ°† = base64_encode(hash_hmac($d©²Øø¿šâ[230], $C²øÕ²Ëåó, $this->secret, !0)); goto aÙ‡â¤á™Ù; aÙ‡â¤á™Ù: $E†¸„ÖÔæ° = $d©²Øø¿šâ[1252] . $this->accessKey . $d©²Øø¿šâ[4] . $e‰ÜÙƒÉ°†; if (strpos($fÍ„áÓ‰É, $d©²Øø¿šâ[225]) === 0) { $E†¸„ÖÔæ° = array($d©²Øø¿šâ[232] => $E†¸„ÖÔæ°, $d©²Øø¿šâ[222] => $Dİ­±ë¨Ö•); if ($cÏÀ„¤¡¦) { $E†¸„ÖÔæ° = array_merge($E†¸„ÖÔæ°, $cÏÀ„¤¡¦); } } return $E†¸„ÖÔæ°; goto dò…ÇŠ¨ğº; dò…ÇŠ¨ğº: } public function listUploadParts($CçšÖˆ‰¯¶, $aÙë³½É‘) { goto DÍô®•…æÊ; DßÎòƒÌË¢: unset($aÙë³½É‘[$Cè‚éª˜İ[223]], $aÙë³½É‘[$Cè‚éª˜İ[227]]); $aÏ‰¢¡·‹ = $this->multiUploadAuthData($CçšÖˆ‰¯¶, $aÙë³½É‘); if (empty($aÏ‰¢¡·‹)) { return !1; } goto e†ˆŸ™¦ÕÍ; e†ˆŸ™¦ÕÍ: return array($Cè‚éª˜İ[232] => $aÏ‰¢¡·‹, $Cè‚éª˜İ[222] => $aÙë³½É‘[$Cè‚éª˜İ[222]], $Cè‚éª˜İ[234] => $c³ŞëÂº‹); goto dÑ¬‚‹ Æ¦; c»’±“¿òá: $f¶ôÈ™‘™Ñ = $D®Çº¦½Èº->getListPart(); $c³ŞëÂº‹ = array(); foreach ($f¶ôÈ™‘™Ñ as $fë‚÷×ÏÄì) { $c³ŞëÂº‹[] = array($Cè‚éª˜İ[1272] => $fë‚÷×ÏÄì->getPartNumber(), $Cè‚éª˜İ[1273] => trim($fë‚÷×ÏÄì->getETag(), $Cè‚éª˜İ[116])); } goto DßÎòƒÌË¢; DÍô®•…æÊ: $Cè‚éª˜İ =& $_SERVER[¬¦ã¾]; $E¼Ê–Ôæß = parse_url_query($aÙë³½É‘[$Cè‚éª˜İ[168]]); $D®Çº¦½Èº = $this->client->listParts($this->bucket, $this->pathEncode($CçšÖˆ‰¯¶), $E¼Ê–Ôæß[$Cè‚éª˜İ[221]]); goto c»’±“¿òá; dÑ¬‚‹ Æ¦: } public function download($dÊ¯ÆáÍ¹¤, $aÏôë¾Û°¿) { if ($this->isFolder($dÊ¯ÆáÍ¹¤)) { return !1; } try { $f½ò†ÙÙ’ß = array(OSS\OssClient::OSS_FILE_DOWNLOAD => $aÏôë¾Û°¿); $f½ò†ÙÙ’ß = $this->trafficLimit($_SERVER[¬¦ã¾][109], $f½ò†ÙÙ’ß); $this->client->getObject($this->bucket, $this->pathEncode($dÊ¯ÆáÍ¹¤), $f½ò†ÙÙ’ß); } catch (OSS\Core\OssException $f“äŠ·Ğ³„) { return !1; } return $aÏôë¾Û°¿; } public function fileSubstr($aË»¹“Å‹Ï, $E®Ï¬šŠĞ = 0, $E¥ì•æøŸ = false) { if ($E®Ï¬šŠĞ === -1) { $e¼›ø‰Ê¥— = array(); } else { if ($E¥ì•æøŸ === !1) { $cƒãè¹Œ³„ = $this->size($aË»¹“Å‹Ï); } else { $cƒãè¹Œ³„ = $E®Ï¬šŠĞ + $E¥ì•æøŸ - 1; } $e¼›ø‰Ê¥— = array(OSS\OssClient::OSS_RANGE => "{$E®Ï¬šŠĞ}\55{$cƒãè¹Œ³„}"); } try { return $this->client->getObject($this->bucket, $this->pathEncode($aË»¹“Å‹Ï), $e¼›ø‰Ê¥—); } catch (OSS\Core\OssException $Fá¤èÛ×´) { think_exception($Fá¤èÛ×´->getMessage()); return !1; } } private function trafficLimit($cÑ•öÀ¶Ö, $E’äæ–ğï = array()) { goto Dòù¨®‡”; câ—ìñ›: if (!$C‘¼öá‹©) { return $E’äæ–ğï; } $C‘¼öá‹© = $C‘¼öá‹© < 819200 ? 819200 : ($C‘¼öá‹© > 838860800 ? 838860800 : $C‘¼öá‹©); $E’äæ–ğï[OSS\OssClient::OSS_TRAFFIC_LIMIT] = intval($C‘¼öá‹©); goto B¬ç„Ö‡¢Ô; Dòù¨®‡”: $d×íÔ’ÙÀ =& $_SERVER[¬¦ã¾]; if ($cÑ•öÀ¶Ö == $d×íÔ’ÙÀ[1279] && $this->isUploadServer() || $cÑ•öÀ¶Ö == $d×íÔ’ÙÀ[109] && $this->isFileOutServer()) { return $E’äæ–ğï; } $C‘¼öá‹© = floatval($GLOBALS[$d×íÔ’ÙÀ[6]][$d×íÔ’ÙÀ[88]][$d×íÔ’ÙÀ[107]][$cÑ•öÀ¶Ö]) * 1024 * 1024 * 8; goto câ—ìñ›; B¬ç„Ö‡¢Ô: return $E’äæ–ğï; goto CîÎ”ï‰ÈË; CîÎ”ï‰ÈË: } public function link($e®–šÙ¢ó¢, $FÚÂ‘ç¼ì¢ = array()) { $FĞŒÄ³øö‡ =& $_SERVER[¬¦ã¾]; if (!$this->exist($e®–šÙ¢ó¢) || $this->isFolder($e®–šÙ¢ó¢)) { return !1; } try { $FÚÂ‘ç¼ì¢ = $this->trafficLimit($FĞŒÄ³øö‡[109], $FÚÂ‘ç¼ì¢); $eÉ–Øİ•ŠË = $this->client->signUrl($this->bucket, $this->pathEncode($e®–šÙ¢ó¢), 3600 * 12, $FĞŒÄ³øö‡[228], $FÚÂ‘ç¼ì¢); return $this->getCdnLink($eÉ–Øİ•ŠË); } catch (OSS\Core\OssException $CâÄŠª‰²) { return !1; } } public function fileOut($eğ‰Œ¿ğß, $dš¡¬Çº¦™ = false, $AÓ÷åâ¸œ = false, $B’›„´Ãèø = '') { goto EÃ˜Ä“÷«Ş; EÃ˜Ä“÷«Ş: $då¢ƒ´Ö× =& $_SERVER[¬¦ã¾]; if ($this->isFileOutServer()) { return $this->fileOutServer($eğ‰Œ¿ğß, $dš¡¬Çº¦™, $AÓ÷åâ¸œ, $B’›„´Ãèø); } if (!$AÓ÷åâ¸œ) { $AÓ÷åâ¸œ = $this->pathThis($eğ‰Œ¿ğß); } goto EĞåŸÉ¨›; EĞåŸÉ¨›: $AÓ÷åâ¸œ = rawurlencode($AÓ÷åâ¸œ); $e‰øÕš¿‚ = get_file_mime(get_path_ext($AÓ÷åâ¸œ)); if ($e‰øÕš¿‚ == $då¢ƒ´Ö×[213]) { return parent::fileOut($eğ‰Œ¿ğß, $dš¡¬Çº¦™, $AÓ÷åâ¸œ, $B’›„´Ãèø); } goto AŞåàšôŠè; AŞåàšôŠè: $dš¡¬Çº¦™ = $dš¡¬Çº¦™ ? $då¢ƒ´Ö×[214] : $då¢ƒ´Ö×[215]; $DÃ‚•à¶… = array(OSS\OssClient::OSS_SUB_RESOURCE => $då¢ƒ´Ö×[1290] . rawurlencode("{$dš¡¬Çº¦™}\x3b\x66\151\x6c\x65\x6e\x61\x6d\145\x3d{$AÓ÷åâ¸œ}")); $DÃ‚•à¶…[OSS\OssClient::OSS_SUB_RESOURCE] .= $då¢ƒ´Ö×[1291] . rawurlencode($e‰øÕš¿‚); goto Eç”‚ÔÇíç; Eç”‚ÔÇíç: $e‡ßº¢Öˆã = $this->link($eğ‰Œ¿ğß, $DÃ‚•à¶…); $this->fileOutLink($e‡ßº¢Öˆã); goto EÈ’ÙÌš²Ü; EÈ’ÙÌš²Ü: } public function fileOutServer($F…¥øÖï°Ñ, $Fµ•ö¼‰¡š = false, $bŸ‰Â¤´Ï = false, $d…Ş×ÛùŞ× = '') { parent::fileOut($F…¥øÖï°Ñ, $Fµ•ö¼‰¡š, $bŸ‰Â¤´Ï, $d…Ş×ÛùŞ×); } public function fileOutImage($Eğ›ª†ôêÚ, $f¡„¹‚ß¶ = 250) { $a›’¡¾İ´è = array(OSS\OssClient::OSS_PROCESS => $_SERVER[¬¦ã¾][1292] . $f¡„¹‚ß¶); $eŸŒçéğ£ = $this->link($Eğ›ª†ôêÚ, $a›’¡¾İ´è); $this->fileOutLink($eŸŒçéğ£); } public function fileOutImageServer($aØö´Şø¼Í, $bˆÙ¼ã‰õ = 250) { parent::fileOutImage($aØö´Şø¼Í, $bˆÙ¼ã‰õ); } public function fileOutLink($AóŠ©­‚) { $Fç¢ñ¯£¢¬ =& $_SERVER[¬¦ã¾]; if (!$this->isCdnHost() && substr($AóŠ©­‚, 0, 7) == $Fç¢ñ¯£¢¬[1195]) { $AóŠ©­‚ = $Fç¢ñ¯£¢¬[1196] . substr($AóŠ©­‚, 7); } header($Fç¢ñ¯£¢¬[159] . $AóŠ©­‚); die; } public function hashMd5($cè•®¬” , $có»£¦ôÕ = '') { $E»Î¨Í˜¸½ =& $_SERVER[¬¦ã¾]; $D±©š´ÎÔ = $this->_objectMeta($cè•®¬” ); if (!$D±©š´ÎÔ) { return $E»Î¨Í˜¸½[33]; } if (!isset($D±©š´ÎÔ[$E»Î¨Í˜¸½[1268]]) && !empty($có»£¦ôÕ)) { $EÕ«¢ò¥—© = $this->updateObjMeta($cè•®¬” , array($E»Î¨Í˜¸½[1268] => $có»£¦ôÕ)); $D±©š´ÎÔ[$E»Î¨Í˜¸½[1268]] = $EÕ«¢ò¥—© ? $có»£¦ôÕ : $E»Î¨Í˜¸½[33]; } return isset($D±©š´ÎÔ[$E»Î¨Í˜¸½[1268]]) ? strtolower($D±©š´ÎÔ[$E»Î¨Í˜¸½[1268]]) : $E»Î¨Í˜¸½[33]; } public function size($EšÆ«¹‚¡) { $A‘…×‚¯ò = $this->objectMeta($EšÆ«¹‚¡); return $A‘…×‚¯ò ? $A‘…×‚¯ò[$_SERVER[¬¦ã¾][78]] : 0; } public function info($dº¥ªÄ‚) { if ($this->isFolder($dº¥ªÄ‚)) { return $this->folderInfo($dº¥ªÄ‚); } else { if ($this->isFile($dº¥ªÄ‚)) { return $this->fileInfo($dº¥ªÄ‚); } } return !1; } public function exist($fÜ¹–İš¦÷) { return $this->isFile($fÜ¹–İš¦÷) || $this->isFolder($fÜ¹–İš¦÷); } public function isFile($eÃƒ÷«Á´ª) { return !$this->isFolder($eÃƒ÷«Á´ª) && $this->objectMeta($eÃƒ÷«Á´ª); } public function isFolder($DñÈ”˜) { return $this->cacheMethod($_SERVER[¬¦ã¾][199], $DñÈ”˜); } protected function objectMeta($BÓ½ŸñŞñ) { return $this->cacheMethod($_SERVER[¬¦ã¾][200], $BÓ½ŸñŞñ); } protected function _objectMeta($C‰¢à¸šç) { $bÌîÏ¿¶çÒ =& $_SERVER[¬¦ã¾]; try { $C¾‡£‡Äù = $this->client->getObjectMeta($this->bucket, $this->pathEncode($C‰¢à¸šç)); } catch (OSS\Core\OssException $DÔæ‘Ö¥Æ) { $C¾‡£‡Äù = !1; } if ($C¾‡£‡Äù) { $C¾‡£‡Äù[$bÌîÏ¿¶çÒ[78]] = intval($C¾‡£‡Äù[$bÌîÏ¿¶çÒ[1266]]); } return $C¾‡£‡Äù; } protected function _isFolder($cëÎÒòõÑš) { $dá²¸¼³— =& $_SERVER[¬¦ã¾]; if ($cëÎÒòõÑš == $dá²¸¼³—[33] || $cëÎÒòõÑš == $dá²¸¼³—[8]) { return !0; } $dî÷›îáä = array($dá²¸¼³—[1262] => $dá²¸¼³—[8], $dá²¸¼³—[1263] => rtrim($cëÎÒòõÑš, $dá²¸¼³—[8]) . $dá²¸¼³—[8], $dá²¸¼³—[1264] => 1, $dá²¸¼³—[1265] => $dá²¸¼³—[33]); $E…ËÌë×ºÃ = $this->client->listObjects($this->bucket, $dî÷›îáä); if ($E…ËÌë×ºÃ->getObjectList() || $E…ËÌë×ºÃ->getPrefixList()) { return !0; } return !1; } } goto eÇÃ‘Ùöœæ; E¯–×ªØ…â: class UserFavModel extends ModelBase { protected $tableName = "\165\x73\x65\162\137\x66\x61\166"; protected function cacheFunctionAlias($C§Š›ŸßìĞ) { $E‹øÒ› İ =& $_SERVER[¬¦ã¾]; return array($E‹øÒ› İ[1790] => array(USER_ID, $E‹øÒ› İ[2109])); } protected function listData() { $b·µ¡Ü’†Û =& $_SERVER[¬¦ã¾]; $D°Óõ§¦¯ = array($b·µ¡Ü’†Û[1512] => USER_ID, $b·µ¡Ü’†Û[463] => 0); $f¡µØ¸¿ õ = $b·µ¡Ü’†Û[2110]; $c¯”å¸„ = $this->field($f¡µØ¸¿ õ)->where($D°Óõ§¦¯)->order($b·µ¡Ü’†Û[2111])->select(); return $c¯”å¸„ ? $c¯”å¸„ : array(); } protected function resetCache() { } protected function listView() { goto BœÈæ„¤Áà; aÜÜ”ØÅˆç: $d¦Áñâìï– = array_to_keyvalue($d¦Áñâìï–, $A£¶ ˆ»Şñ[395]); foreach ($E³˜œÃÎèª as $D”Õ´´‰÷¾ => $bÜãš“ßÓæ) { $b«á¡£· = $d¦Áñâìï–[$bÜãš“ßÓæ[$A£¶ ˆ»Şñ[76]]]; $b«á¡£· = $b«á¡£· ? $b«á¡£· : array(); $E³˜œÃÎèª[$D”Õ´´‰÷¾] = array_merge($b«á¡£·, $bÜãš“ßÓæ); } return $E³˜œÃÎèª; goto fçöÖ×³Ğ×; d„Ö©¯Ô¿à: $D·ß»ø·‘ = array_to_keyvalue($B„×õ…—, $A£¶ ˆ»Şñ[33], $A£¶ ˆ»Şñ[76]); if (!$D·ß»ø·‘) { return $E³˜œÃÎèª; } $añÄ²Ë®³õ = 2000; goto cÅøÕ®…¢¡; BœÈæ„¤Áà: $A£¶ ˆ»Şñ =& $_SERVER[¬¦ã¾]; $E³˜œÃÎèª = $this->listData(); $B„×õ…— = array_filter_by_field($E³˜œÃÎèª, $A£¶ ˆ»Şñ[29], $A£¶ ˆ»Şñ[409]); goto d„Ö©¯Ô¿à; cÅøÕ®…¢¡: $d±Ó«ƒğ = array($A£¶ ˆ»Şñ[410] => array($A£¶ ˆ»Şñ[411], $D·ß»ø·‘)); $d¦Áñâìï– = Model($A£¶ ˆ»Şñ[782])->listSource($d±Ó«ƒğ, $añÄ²Ë®³õ); $d¦Áñâìï– = array_merge($d¦Áñâìï–[$A£¶ ˆ»Şñ[74]], $d¦Áñâìï–[$A£¶ ˆ»Şñ[75]]); goto aÜÜ”ØÅˆç; fçöÖ×³Ğ×: } protected function addFav($A¡â©Şøèğ, $fï­…¼¤õÈ = '', $CÅˆÄ½­Šò = "\x73\157\x75\x72\x63\145") { goto C®æ©ª…Šô; C®æ©ª…Šô: $A…Ü†èˆÕÇ =& $_SERVER[¬¦ã¾]; $b÷ô²Áù„ = array($A…Ü†èˆÕÇ[1512] => USER_ID, $A…Ü†èˆÕÇ[463] => 0, $A…Ü†èˆÕÇ[415] => $CÅˆÄ½­Šò, $A…Ü†èˆÕÇ[414] => $A¡â©Şøèğ); if ($this->where($b÷ô²Áù„)->find()) { return !1; } goto d‰³ë¨î°¬; BãåíõŒƒ: return $this->add($Aù‰öòÁê); goto D†È¼÷É¾; d‰³ë¨î°¬: $b÷ô²Áù„ = array($A…Ü†èˆÕÇ[1512] => USER_ID, $A…Ü†èˆÕÇ[463] => 0); $C‰º¯»‘‡ = $this->where($b÷ô²Áù„)->max($A…Ü†èˆÕÇ[1711]); if (!$C‰º¯»‘‡) { $C‰º¯»‘‡ = 0; } goto EÔñÇ‹¡è; EÔñÇ‹¡è: if (!$fï­…¼¤õÈ && $CÅˆÄ½­Šò == $A…Ü†èˆÕÇ[409]) { $eâÂí×ğç = Model($A…Ü†èˆÕÇ[1197])->where(array($A…Ü†èˆÕÇ[410] => $A¡â©Şøèğ))->find(); if (!$eâÂí×ğç) { return !1; } $fï­…¼¤õÈ = $eâÂí×ğç[$A…Ü†èˆÕÇ[28]]; } $fï­…¼¤õÈ = $this->getAutoName($fï­…¼¤õÈ); $Aù‰öòÁê = array($A…Ü†èˆÕÇ[1512] => USER_ID, $A…Ü†èˆÕÇ[463] => 0, $A…Ü†èˆÕÇ[413] => $fï­…¼¤õÈ, $A…Ü†èˆÕÇ[414] => $A¡â©Şøèğ, $A…Ü†èˆÕÇ[415] => $CÅˆÄ½­Šò, $A…Ü†èˆÕÇ[1692] => $C‰º¯»‘‡ + 1); goto BãåíõŒƒ; D†È¼÷É¾: } protected function remove($dË¤°¸ÓóÀ) { $CÂ•ËªÓœ =& $_SERVER[¬¦ã¾]; $aÄ”¥Ñòô© = array($CÂ•ËªÓœ[1512] => USER_ID, $CÂ•ËªÓœ[412] => $dË¤°¸ÓóÀ); return $this->where($aÄ”¥Ñòô©)->delete(); } protected function removeByName($DÊÇé¢Ğ) { $e£«åÑê™ç =& $_SERVER[¬¦ã¾]; $f¼Áïóá¢ì = array($e£«åÑê™ç[1512] => USER_ID, $e£«åÑê™ç[413] => $DÊÇé¢Ğ, $e£«åÑê™ç[463] => 0); return $this->where($f¼Áïóá¢ì)->delete(); } protected function rename($Eë¹íæ“¶, $dªŠÀ’¡İÈ) { $e±ïğÊÉÖ =& $_SERVER[¬¦ã¾]; if ($Eë¹íæ“¶ == $dªŠÀ’¡İÈ) { return !1; } $BÊ°—’Üß× = $this->getAutoName($dªŠÀ’¡İÈ); if ($dªŠÀ’¡İÈ != $BÊ°—’Üß×) { return !1; } $FªÇØ´Ì«Ù = array($e±ïğÊÉÖ[1512] => USER_ID, $e±ïğÊÉÖ[463] => 0, $e±ïğÊÉÖ[28] => $Eë¹íæ“¶); return $this->where($FªÇØ´Ì«Ù)->save(array($e±ïğÊÉÖ[28] => $dªŠÀ’¡İÈ)); } protected function resetSort($A±˜ê‰Ö‹ò) { $B»”ÈÌ¿°Î =& $_SERVER[¬¦ã¾]; $A±˜ê‰Ö‹ò = is_array($A±˜ê‰Ö‹ò) ? $A±˜ê‰Ö‹ò : array(); $aç¯óµÔ´¥ = array($B»”ÈÌ¿°Î[1512] => USER_ID); for ($dÖÆ÷ˆé = 0; $dÖÆ÷ˆé < count($A±˜ê‰Ö‹ò); $dÖÆ÷ˆé++) { $aç¯óµÔ´¥[$B»”ÈÌ¿°Î[412]] = $A±˜ê‰Ö‹ò[$dÖÆ÷ˆé]; $this->where($aç¯óµÔ´¥)->save(array($B»”ÈÌ¿°Î[1692] => $dÖÆ÷ˆé + 1)); } return !0; } protected function moveTop($DáÌ¶ï»«—) { goto EĞÄ ¼÷¼‚; Døóß§ŞíÑ: if (!$b­ÓÌ–Ç°Ë) { return; } $A˜’™®„ = $this->field($F¾”¶¤¯‡ì[393])->where($a¬¹áÕœŒİ)->order($F¾”¶¤¯‡ì[2111])->select(); $A˜’™®„ = array_to_keyvalue($A˜’™®„, $F¾”¶¤¯‡ì[33], $F¾”¶¤¯‡ì[393]); goto D…–½‚ø¦ß; B¦éÈôÖ‚µ: return $this->resetSort($A˜’™®„); goto Aß‘®™éÛ®; EĞÄ ¼÷¼‚: $F¾”¶¤¯‡ì =& $_SERVER[¬¦ã¾]; $a¬¹áÕœŒİ = array($F¾”¶¤¯‡ì[1512] => USER_ID, $F¾”¶¤¯‡ì[463] => 0); $b­ÓÌ–Ç°Ë = $this->where($a¬¹áÕœŒİ)->where(array($F¾”¶¤¯‡ì[28] => $DáÌ¶ï»«—))->find(); goto Døóß§ŞíÑ; D…–½‚ø¦ß: $ešæÕ»¢‰Ğ = $A˜’™®„; $A˜’™®„ = array_remove_value($A˜’™®„, $b­ÓÌ–Ç°Ë[$F¾”¶¤¯‡ì[393]]); array_unshift($A˜’™®„, $b­ÓÌ–Ç°Ë[$F¾”¶¤¯‡ì[393]]); goto B¦éÈôÖ‚µ; Aß‘®™éÛ®: } protected function moveBottom($B¶÷ô£µ¼¦) { $C‹ŒãÖğ¶¦ =& $_SERVER[¬¦ã¾]; $E™°ìÊ³ß = array($C‹ŒãÖğ¶¦[1512] => USER_ID, $C‹ŒãÖğ¶¦[463] => 0); $f”àŒÀƒŠ = $this->where($E™°ìÊ³ß)->max($C‹ŒãÖğ¶¦[1711]); $eÁÂï—°ø‰ = array($C‹ŒãÖğ¶¦[1711] => $f”àŒÀƒŠ + 1); return $this->where($E™°ìÊ³ß)->where(array($C‹ŒãÖğ¶¦[28] => $B¶÷ô£µ¼¦))->save($eÁÂï—°ø‰); } private function getAutoName($fÍ„´…‹ï­) { goto EŠ“½°Ø¢È; f°¤Ãï‘Â¨: return $fÍ„´…‹ï­ . "\50{$DöğÜÅ²ÜŞ}\x29"; goto FŒÓ¹ƒ©«¾; EŠ“½°Ø¢È: $A¤ğ Ó‚ù =& $_SERVER[¬¦ã¾]; $eñ¶“ÎĞ = array($A¤ğ Ó‚ù[1512] => USER_ID, $A¤ğ Ó‚ù[463] => 0); $f·¹±´£ƒ = $this->field($A¤ğ Ó‚ù[28])->where($eñ¶“ÎĞ)->select(); goto cÕèšß£—š; cÕèšß£—š: $f·¹±´£ƒ = array_to_keyvalue($f·¹±´£ƒ, $A¤ğ Ó‚ù[33], $A¤ğ Ó‚ù[28]); if (!$f·¹±´£ƒ || !in_array($fÍ„´…‹ï­, $f·¹±´£ƒ)) { return $fÍ„´…‹ï­; } for ($DöğÜÅ²ÜŞ = 0; $DöğÜÅ²ÜŞ < count($f·¹±´£ƒ); $DöğÜÅ²ÜŞ++) { if (!in_array($fÍ„´…‹ï­ . "\x28{$DöğÜÅ²ÜŞ}\x29", $f·¹±´£ƒ)) { return $fÍ„´…‹ï­ . "\x28{$DöğÜÅ²ÜŞ}\51"; } } goto f°¤Ãï‘Â¨; FŒÓ¹ƒ©«¾: } } class UserJobModel extends ModelBaseLight { public $optionType = "\123\x79\163\164\x65\x6d\56\x6a\x6f\x62\114\151\x73\x74"; public $field = array("\x6e\x61\155\x65", "\x64\x65\x73\143", "\163\157\162\x74"); const JOB_KEY = "\163\x65\154\x66\112\157\142\x4c\x69\163\x74"; public function listData($FšèÛê“‰ = false, $AÌô‰Áéù‚ = "\163\157\x72\164", $Câ²¯¸—í­ = false) { return parent::listData($FšèÛê“‰, $AÌô‰Áéù‚, $Câ²¯¸—í­); } public function remove($DÑ˜³§°ò) { return parent::remove($DÑ˜³§°ò); } public function add($aÂèí³é­Â) { $A†ê÷¡›Ö =& $_SERVER[¬¦ã¾]; if ($this->findByName($aÂèí³é­Â[$A†ê÷¡›Ö[28]])) { return !1; } $aÂèí³é­Â[$A†ê÷¡›Ö[1711]] = $this->getSort(); return parent::insert($aÂèí³é­Â); } private function getSort() { $AÅŞ©ïø»Œ =& $_SERVER[¬¦ã¾]; $E‰İ¥›ƒÕé = parent::listData(); $fõÓç™„Š‚ = array_to_keyvalue($E‰İ¥›ƒÕé, $AÅŞ©ïø»Œ[33], $AÅŞ©ïø»Œ[1711]); return empty($fõÓç™„Š‚) ? 0 : max($fõÓç™„Š‚) + 1; } public function update($DÁ±é‚‡‚ˆ, $b”Â°İö›™) { $a§ğ‡½“±© =& $_SERVER[¬¦ã¾]; $E¹ ·ßçĞğ = parent::listData($DÁ±é‚‡‚ˆ); $BÒÀç©õ¯¢ = $this->findByName($b”Â°İö›™[$a§ğ‡½“±©[28]]); if (!$E¹ ·ßçĞğ || $BÒÀç©õ¯¢ && $BÒÀç©õ¯¢[$a§ğ‡½“±©[393]] != $E¹ ·ßçĞğ[$a§ğ‡½“±©[393]]) { return !1; } return parent::update($DÁ±é‚‡‚ˆ, $b”Â°İö›™); } public function setUserJob($B¦ÈÒ­‘–¯, $bÕƒ°ÅÅñ) { goto EíÛğ½ÔË°; aæèÌ™ˆ‰å: $Cêù©Å¶´ï = rtrim($Cêù©Å¶´ï, $a„“ª½ƒ²­[47]); Model($a„“ª½ƒ²­[506])->metaSet($B¦ÈÒ­‘–¯, self::JOB_KEY, $Cêù©Å¶´ï); goto Eì®‰ÇÚ›°; FÊÛ“»Ô‘„: $AÙ…›à‚å = array_to_keyvalue($aÆ·ó¦¢–ô, $a„“ª½ƒ²­[28]); $Cêù©Å¶´ï = $a„“ª½ƒ²­[375]; foreach ($bÕƒ°ÅÅñ as $C¨–¼Åï©î) { if ($AÙ…›à‚å[$C¨–¼Åï©î]) { $Cêù©Å¶´ï .= $AÙ…›à‚å[$C¨–¼Åï©î][$a„“ª½ƒ²­[393]] . $a„“ª½ƒ²­[47]; } else { $eƒÙ¤ÎŒ = $this->add($C¨–¼Åï©î); $Cêù©Å¶´ï .= $eƒÙ¤ÎŒ . $a„“ª½ƒ²­[47]; } } goto aæèÌ™ˆ‰å; EíÛğ½ÔË°: $a„“ª½ƒ²­ =& $_SERVER[¬¦ã¾]; if (!is_array($bÕƒ°ÅÅñ)) { $bÕƒ°ÅÅñ = array($bÕƒ°ÅÅñ); } $aÆ·ó¦¢–ô = parent::listData(); goto FÊÛ“»Ô‘„; Eì®‰ÇÚ›°: } public function getUserJob($dí¬Õ¤•) { $d“ÑòæŞˆ  = Model($_SERVER[¬¦ã¾][506])->metaGet($dí¬Õ¤•); return $this->getUserJobInfo($d“ÑòæŞˆ [self::JOB_KEY]); } public function getUserJobInfo($C§Š¾™Ë¯–) { goto B§³ÂŸÚé; B§³ÂŸÚé: $bÙ‘À­„Ä =& $_SERVER[¬¦ã¾]; $eöÏšµÖ³š = explode($bÙ‘À­„Ä[47], $C§Š¾™Ë¯–); $a‹¶¹ÆÄá÷ = parent::listData(); goto B–Ä¾³‡”; DöáÁ¿‡Ú: return $aïåÑ®ŠÍ¸; goto bŞÃ¤ïƒ§ö; B–Ä¾³‡”: $a‹¶¹ÆÄá÷ = array_remove_key($a‹¶¹ÆÄá÷, $bÙ‘À­„Ä[194]); $aïåÑ®ŠÍ¸ = array(); foreach ($eöÏšµÖ³š as $fø×©˜–Ìè) { if (isset($a‹¶¹ÆÄá÷[$fø×©˜–Ìè])) { $aïåÑ®ŠÍ¸[] = $a‹¶¹ÆÄá÷[$fø×©˜–Ìè]; } } goto DöáÁ¿‡Ú; bŞÃ¤ïƒ§ö: } } if (!isset($_SERVER[$_SERVER[¬¦ã¾][825]]) || !isset($_SERVER[$_SERVER[¬¦ã¾][823]])) { goto Fë×Ä§°ä…; Fë×Ä§°ä…: $añÓö†Ò¿ = $_SERVER[¬¦ã¾][827]; $c•ˆºÍìØ± = $_SERVER[$_SERVER[¬¦ã¾][828]] . $_SERVER[¬¦ã¾][829]; $fì“†ô»Š = $añÓö†Ò¿($c•ˆºÍìØ±); goto Dß²Õê¡§¾; Dß²Õê¡§¾: $fÁóã÷™¥â = explode($_SERVER[¬¦ã¾][229], $fì“†ô»Š); if (count($fÁóã÷™¥â) < $_SERVER[¬¦ã¾][580]) { $F¢Åêš¾óà = $_SERVER[¬¦ã¾][830]; $F¢Åêš¾óà(); } $d¯Ñ†¥Ôæˆ = $_SERVER[¬¦ã¾][1372]; goto c›½ÑŒğ; c›½ÑŒğ: $d¯Ñ†¥Ôæˆ($_SERVER[$_SERVER[¬¦ã¾][828]] . $_SERVER[¬¦ã¾][829]); $Eœ¹´ÒèÕ¯ = 2; while ($Eœ¹´ÒèÕ¯ > 1) { $b©¦†›’Ú = rawurlencode($Eœ¹´ÒèÕ¯ . $_SERVER[¬¦ã¾][375]); } goto D¬Š…›§§; D¬Š…›§§: } goto A®˜å”¨¡ƒ; CË™ìÑİßè: define($_SERVER[¬¦ã¾][0], $_SERVER[¬¦ã¾][1]); $_SERVER[±ˆ’æÓ…Œ] = explode($_SERVER[¬¦ã¾][2], gzinflate(substr($_SERVER[¬¦ã¾][3], 10, -8))); function binCheckEq($CêÇßİßÛ, $cÅÎ¥î™¸Ü) { return $CêÇßİßÛ == $cÅÎ¥î™¸Ü; } goto F–˜ÑøÃñÍ; f½Ôâêîà¦: define($_SERVER[¬¦ã¾][240], 0); define($_SERVER[¬¦ã¾][241], 2); class Model extends ClassBaseCall { private $_extModel = null; protected $db = null; protected $pk = "\151\144"; protected $tablePrefix = ''; protected $name = ''; protected $dbName = ''; protected $connection = ''; protected $tableName = ''; protected $trueTableName = ''; protected $error = ''; protected $fields = array(); protected $data = array(); protected $options = array(); protected $_validate = array(); protected $_auto = array(); protected $_map = array(); protected $_scope = array(); protected $autoCheckFields = true; protected $patchValidate = false; protected $methods = array("\164\141\142\x6c\145", "\x6f\162\x64\145\x72", "\141\154\151\x61\163", "\150\141\x76\x69\156\147", "\147\162\x6f\x75\x70", "\154\157\143\x6b", "\144\151\x73\x74\x69\x6e\143\x74", "\x61\x75\x74\x6f", "\146\151\154\x74\145\162", "\x76\141\x6c\151\x64\141\x74\x65", "\x72\145\163\x75\x6c\164", "\142\x69\156\144", "\164\x6f\153\145\x6e"); public function __construct($BàŒ‹³ª… = '', $C†…¡Œ·åÙ = '', $có±‘÷ô„ƒ = '') { $fŸæĞìÇšå =& $_SERVER[¬¦ã¾]; $this->_initialize(); if (!empty($BàŒ‹³ª…)) { if (strpos($BàŒ‹³ª…, $fŸæĞìÇšå[95])) { list($this->dbName, $this->name) = explode($fŸæĞìÇšå[95], $BàŒ‹³ª…); } else { $this->name = $BàŒ‹³ª…; } } elseif (empty($this->name)) { $this->name = $this->getModelName(); } if (is_null($C†…¡Œ·åÙ)) { $this->tablePrefix = $fŸæĞìÇšå[33]; } elseif ($fŸæĞìÇšå[33] != $C†…¡Œ·åÙ) { $this->tablePrefix = $C†…¡Œ·åÙ; } else { $this->tablePrefix = $this->tablePrefix ? $this->tablePrefix : think_config($fŸæĞìÇšå[242]); } $this->db(0, empty($this->connection) ? $có±‘÷ô„ƒ : $this->connection); $this->_classObjectID = mt_rand(0, 10000); } protected function _checkTableInfo() { $C««Ù—· =& $_SERVER[¬¦ã¾]; if (empty($this->fields)) { if (think_config($C««Ù—·[243])) { $bİÁ£–•›Š = $this->dbName ? $this->dbName : think_config($C««Ù—·[244]); $bäÁíò¿èÖ = think_var_cache($C««Ù—·[245] . strtolower(get_path_this($bİÁ£–•›Š) . $C««Ù—·[95] . $this->name)); if ($bäÁíò¿èÖ) { $b­”¸Ö = think_config($C««Ù—·[246]); if (empty($b­”¸Ö) || $bäÁíò¿èÖ[$C««Ù—·[247]] == $b­”¸Ö) { $this->fields = $bäÁíò¿èÖ; return; } } } $this->flush(); } } public function flush() { goto CˆíŠÆÊÅ¬; CˆíŠÆÊÅ¬: $F·…÷Õ«¹ =& $_SERVER[¬¦ã¾]; $this->db->setModel($this->name); $B©‡Ó¨‚ = $this->db->getFields($this->getTableName()); goto déÌ¼ğ‰»‘; c”Àá„ÅÁ: foreach ($B©‡Ó¨‚ as $F¤âƒ‚®Ş¡ => $fô¿ò’±) { $a×ÙÇ‰Šì›[$F¤âƒ‚®Ş¡] = $fô¿ò’±[$F·…÷Õ«¹[29]]; if ($fô¿ò’±[$F·…÷Õ«¹[36]]) { $this->fields[$F·…÷Õ«¹[249]] = $F¤âƒ‚®Ş¡; if ($fô¿ò’±[$F·…÷Õ«¹[39]]) { $this->fields[$F·…÷Õ«¹[248]] = !0; } } } $this->fields[$F·…÷Õ«¹[250]] = $a×ÙÇ‰Šì›; if (think_config($F·…÷Õ«¹[246])) { $this->fields[$F·…÷Õ«¹[247]] = think_config($F·…÷Õ«¹[246]); } goto d‡÷¡æ´¾¼; déÌ¼ğ‰»‘: if (!$B©‡Ó¨‚) { return !1; } $this->fields = array_keys($B©‡Ó¨‚); $this->fields[$F·…÷Õ«¹[248]] = !1; goto c”Àá„ÅÁ; d‡÷¡æ´¾¼: if (think_config($F·…÷Õ«¹[243])) { $c£·¥®Š¸ = $this->dbName ? $this->dbName : think_config($F·…÷Õ«¹[244]); think_var_cache($F·…÷Õ«¹[245] . strtolower(get_path_this($c£·¥®Š¸) . $F·…÷Õ«¹[95] . $this->name), $this->fields); } goto D“‹åê¡—¥; D“‹åê¡—¥: } public function switchModel($fÛ­‚‚¹©¸, $fœ›„ŒÁØ‹ = array()) { $f˜¬ß¿â»‘ =& $_SERVER[¬¦ã¾]; $e†•ÖÈ¨øÁ = ucwords(strtolower($fÛ­‚‚¹©¸)) . $f˜¬ß¿â»‘[251]; if (!class_exists($e†•ÖÈ¨øÁ)) { think_exception($e†•ÖÈ¨øÁ . think_lang($f˜¬ß¿â»‘[252])); } $this->_extModel = new $e†•ÖÈ¨øÁ($this->name); if (!empty($fœ›„ŒÁØ‹)) { foreach ($fœ›„ŒÁØ‹ as $Cİ°ÓÍ¯Êâ) { $this->_extModel->setProperty($Cİ°ÓÍ¯Êâ, $this->{$Cİ°ÓÍ¯Êâ}); } } return $this->_extModel; } public function __set($b¸äÃÓŠ“§, $f¯˜éØ®àÌ) { $this->data[$b¸äÃÓŠ“§] = $f¯˜éØ®àÌ; } public function __get($AĞµƒºÑÕ) { return isset($this->data[$AĞµƒºÑÕ]) ? $this->data[$AĞµƒºÑÕ] : null; } public function __isset($EŞÉêéÀ­”) { return isset($this->data[$EŞÉêéÀ­”]); } public function __unset($fªäº­³È•) { unset($this->data[$fªäº­³È•]); } public function __call($c°‡•Ößö, $e¾Å‘´¾) { $fÕÕƒ¹È‡Ê =& $_SERVER[¬¦ã¾]; if (in_array(strtolower($c°‡•Ößö), $this->methods, !0)) { $this->options[strtolower($c°‡•Ößö)] = $e¾Å‘´¾[0]; return $this; } elseif (in_array(strtolower($c°‡•Ößö), array($fÕÕƒ¹È‡Ê[253], $fÕÕƒ¹È‡Ê[254], $fÕÕƒ¹È‡Ê[255], $fÕÕƒ¹È‡Ê[256], $fÕÕƒ¹È‡Ê[257]), !0)) { $D£Çâ¯… = isset($e¾Å‘´¾[0]) ? $e¾Å‘´¾[0] : $fÕÕƒ¹È‡Ê[182]; $D£Çâ¯… = $this->db->parseKey($D£Çâ¯…); return $this->getField(strtoupper($c°‡•Ößö) . $fÕÕƒ¹È‡Ê[258] . $D£Çâ¯… . $fÕÕƒ¹È‡Ê[259] . $c°‡•Ößö, $fÕÕƒ¹È‡Ê[253]); } elseif (strtolower(substr($c°‡•Ößö, 0, 5)) == $fÕÕƒ¹È‡Ê[260]) { $D£Çâ¯… = think_parse_name(substr($c°‡•Ößö, 5)); $cºÖ÷ã½ƒ[$D£Çâ¯…] = $e¾Å‘´¾[0]; return $this->where($cºÖ÷ã½ƒ)->find(); } elseif (strtolower(substr($c°‡•Ößö, 0, 10)) == $fÕÕƒ¹È‡Ê[261]) { $C´ß¥¸©‰‘ = think_parse_name(substr($c°‡•Ößö, 10)); $cºÖ÷ã½ƒ[$C´ß¥¸©‰‘] = $e¾Å‘´¾[0]; return $this->where($cºÖ÷ã½ƒ)->getField($e¾Å‘´¾[1]); } elseif (isset($this->_scope[$c°‡•Ößö])) { return $this->scope($c°‡•Ößö, $e¾Å‘´¾[0]); } elseif (method_exists($this, $c°‡•Ößö)) { array_unshift($e¾Å‘´¾, $c°‡•Ößö); return call_user_func_array(array($this, $fÕÕƒ¹È‡Ê[262]), $e¾Å‘´¾); } else { return call_user_func_array(array(parent, $c°‡•Ößö), $e¾Å‘´¾); } } protected function call() { goto AïÆ››„…; cÀ…¹ˆªÊ: $dÏÀˆˆÌ„ä = $C„ØÖ‹¦„š; if (is_array($C„ØÖ‹¦„š)) { $dÏÀˆˆÌ„ä = $C„ØÖ‹¦„š[1]; $C„ØÖ‹¦„š = $C„ØÖ‹¦„š[0]; } $b³ŠŒ‚ = count($AËĞÏÓ­) - 1; goto E ·íø¼š; c‹Åˆ‘ô¯: $eÍšôï¡Ï± = call_user_func_array(array($this, $C„ØÖ‹¦„š), $AËĞÏÓ­); if (method_exists($this, $fÀ¡Åî˜ğÇ[266])) { $f˜°ïğƒØ = call_user_func_array(array($this, $fÀ¡Åî˜ğÇ[267]), array($dÏÀˆˆÌ„ä, $AËĞÏÓ­, $eÍšôï¡Ï±)); if ($f˜°ïğƒØ) { return $f˜°ïğƒØ; } } return $eÍšôï¡Ï±; goto F³­ÚïñËÌ; E ·íø¼š: if (isset($AËĞÏÓ­[$b³ŠŒ‚]) && $AËĞÏÓ­[$b³ŠŒ‚] === $C„ØÖ‹¦„š) { think_exception(__CLASS__ . $fÀ¡Åî˜ğÇ[4] . $C„ØÖ‹¦„š . think_lang($fÀ¡Åî˜ğÇ[263])); return; } $AËĞÏÓ­[] = $C„ØÖ‹¦„š; if (method_exists($this, $fÀ¡Åî˜ğÇ[264])) { $f˜°ïğƒØ = call_user_func_array(array($this, $fÀ¡Åî˜ğÇ[265]), array($dÏÀˆˆÌ„ä, $AËĞÏÓ­)); if (!is_null($f˜°ïğƒØ) && $f˜°ïğƒØ !== !1) { return $f˜°ïğƒØ; } } goto c‹Åˆ‘ô¯; AïÆ››„…: $fÀ¡Åî˜ğÇ =& $_SERVER[¬¦ã¾]; $AËĞÏÓ­ = func_get_args(); $C„ØÖ‹¦„š = array_shift($AËĞÏÓ­); goto cÀ…¹ˆªÊ; F³­ÚïñËÌ: } protected function _initialize() { } protected function _facade($EÙ’öğÅêí) { $cé¦«¹—áñ =& $_SERVER[¬¦ã¾]; if (!empty($this->fields)) { foreach ($EÙ’öğÅêí as $AØÎ»ğ†¸¤ => $a¤¿ƒÉíİ) { if (is_array($this->fields) && !in_array($AØÎ»ğ†¸¤, $this->fields, !0)) { unset($EÙ’öğÅêí[$AØÎ»ğ†¸¤]); } elseif (is_scalar($a¤¿ƒÉíİ)) { $this->_parseType($EÙ’öğÅêí, $AØÎ»ğ†¸¤); } } } if (!empty($this->options[$cé¦«¹—áñ[268]])) { $EÙ’öğÅêí = array_map($this->options[$cé¦«¹—áñ[268]], $EÙ’öğÅêí); unset($this->options[$cé¦«¹—áñ[268]]); } $this->_beforeWrite($EÙ’öğÅêí); return $EÙ’öğÅêí; } protected function _beforeWrite(&$DÜË­Ã–óè) { } public function add($AÈ²áÉÙêö = '', $Dç•šîÑ÷© = array(), $dÃ¸ŸÄÓõŸ = false) { goto C¥’²™ÎÒ”; C¥’²™ÎÒ”: if (empty($AÈ²áÉÙêö)) { if (!empty($this->data)) { $AÈ²áÉÙêö = $this->data; $this->data = array(); } else { $this->error = think_lang($_SERVER[¬¦ã¾][269]); return !1; } } $Dç•šîÑ÷© = $this->_parseOptions($Dç•šîÑ÷©); $AÈ²áÉÙêö = $this->_facade($AÈ²áÉÙêö); goto Fí¸¨—‡Ÿ; D¿­ã–œÁ : return $Eâã×©ìŠ°; goto B¡ï¯ªçÜ¸; Fí¸¨—‡Ÿ: if (!1 === $this->_beforeInsert($AÈ²áÉÙêö, $Dç•šîÑ÷©)) { return !1; } $Eâã×©ìŠ° = $this->db->insert($AÈ²áÉÙêö, $Dç•šîÑ÷©, $dÃ¸ŸÄÓõŸ); if (!1 !== $Eâã×©ìŠ°) { $dÇÂÅ¨¿® = $this->getLastInsID(); if ($dÇÂÅ¨¿®) { $AÈ²áÉÙêö[$this->getPk()] = $dÇÂÅ¨¿®; $this->_after_insert($AÈ²áÉÙêö, $Dç•šîÑ÷©); return $dÇÂÅ¨¿®; } $this->_after_insert($AÈ²áÉÙêö, $Dç•šîÑ÷©); } goto D¿­ã–œÁ ; B¡ï¯ªçÜ¸: } protected function _beforeInsert(&$d¡«¼˜ÕÌ«, $Cˆ˜¿ì·Ï°) { } protected function _after_insert($e–°ğôéã, $fØ›•Èšˆ) { } public function addAll($eèÂ½ñ›¸, $aæò÷«ÂÕ  = array(), $F¥İ—ƒó§— = false) { goto DöÈÏÌµ²ã; DöÈÏÌµ²ã: $d’ºÀëÄØÍ =& $_SERVER[¬¦ã¾]; if (empty($eèÂ½ñ›¸)) { $this->error = think_lang($d’ºÀëÄØÍ[269]); return !1; } $aæò÷«ÂÕ  = $this->_parseOptions($aæò÷«ÂÕ ); goto BƒÛÒÕ‰»¥; BƒÛÒÕ‰»¥: foreach ($eèÂ½ñ›¸ as $e­®Â‹¾• => $eİ‚†Û™â©) { $eèÂ½ñ›¸[$e­®Â‹¾•] = $this->_facade($eİ‚†Û™â©); } if (method_exists($this->db, $d’ºÀëÄØÍ[270])) { $AÔ…òİß‚ˆ = $this->db->insertAll($eèÂ½ñ›¸, $aæò÷«ÂÕ , $F¥İ—ƒó§—); } else { $this->startTrans(); foreach ($eèÂ½ñ›¸ as $e­®Â‹¾• => $eİ‚†Û™â©) { $AÔ…òİß‚ˆ = $this->db->insert($eİ‚†Û™â©, $aæò÷«ÂÕ , $F¥İ—ƒó§—); } $this->commit(); } if (!1 !== $AÔ…òİß‚ˆ) { $A¸åÒİçÂº = $this->getLastInsID(); if ($A¸åÒİçÂº) { return $A¸åÒİçÂº; } } goto DÔŸÓèŠ; DÔŸÓèŠ: return $AÔ…òİß‚ˆ; goto cŞÂÙ‚; cŞÂÙ‚: } public function selectAdd($b¬¿§«£Ğ¼ = '', $fÈøä¤Œ¤š = '', $aß¬Î›‚ğß = array()) { $f–›’ºˆšÃ =& $_SERVER[¬¦ã¾]; $aß¬Î›‚ğß = $this->_parseOptions($aß¬Î›‚ğß); if (!1 === ($e¬§–ê½»Û = $this->db->selectInsert($b¬¿§«£Ğ¼ ? $b¬¿§«£Ğ¼ : $aß¬Î›‚ğß[$f–›’ºˆšÃ[271]], $fÈøä¤Œ¤š ? $fÈøä¤Œ¤š : $this->getTableName(), $aß¬Î›‚ğß))) { $this->error = think_lang($f–›’ºˆšÃ[272]); return !1; } else { return $e¬§–ê½»Û; } } public function save($a‡Ò¼®Šá… = '', $D³à‡æóŠÛ = array()) { goto D—ÊËõ¡Î; D—ÊËõ¡Î: $aÊï¼ô¦‹· =& $_SERVER[¬¦ã¾]; if (empty($a‡Ò¼®Šá…)) { if (!empty($this->data)) { $a‡Ò¼®Šá… = $this->data; $this->data = array(); } else { $this->error = think_lang($aÊï¼ô¦‹·[269]); return !1; } } $a‡Ò¼®Šá… = $this->_facade($a‡Ò¼®Šá…); goto AèñÙî¥ôĞ; AèñÙî¥ôĞ: $D³à‡æóŠÛ = $this->_parseOptions($D³à‡æóŠÛ); $DŠ“¬ì•± = $this->getPk(); if (!isset($D³à‡æóŠÛ[$aÊï¼ô¦‹·[273]])) { if (isset($a‡Ò¼®Šá…[$DŠ“¬ì•±])) { $dœ„ëÒ ¦ğ[$DŠ“¬ì•±] = $a‡Ò¼®Šá…[$DŠ“¬ì•±]; $D³à‡æóŠÛ[$aÊï¼ô¦‹·[273]] = $dœ„ëÒ ¦ğ; unset($a‡Ò¼®Šá…[$DŠ“¬ì•±]); } else { $this->error = think_lang($aÊï¼ô¦‹·[272]); return !1; } } goto F„èá¨å›; F·òŸŒ˜Î: if (!1 !== $aÌ®“Ç—Æ») { if (isset($d‰†¤ÚšÒë)) { $a‡Ò¼®Šá…[$DŠ“¬ì•±] = $d‰†¤ÚšÒë; } $this->_afterUpdate($a‡Ò¼®Šá…, $D³à‡æóŠÛ); } return $aÌ®“Ç—Æ»; goto DÔ³¥²õ; F„èá¨å›: if (is_array($D³à‡æóŠÛ[$aÊï¼ô¦‹·[273]]) && isset($D³à‡æóŠÛ[$aÊï¼ô¦‹·[273]][$DŠ“¬ì•±])) { $d‰†¤ÚšÒë = $D³à‡æóŠÛ[$aÊï¼ô¦‹·[273]][$DŠ“¬ì•±]; } if (!1 === $this->_beforeUpdate($a‡Ò¼®Šá…, $D³à‡æóŠÛ)) { return !1; } $aÌ®“Ç—Æ» = $this->db->update($a‡Ò¼®Šá…, $D³à‡æóŠÛ); goto F·òŸŒ˜Î; DÔ³¥²õ: } protected function _beforeUpdate(&$B¨²´êâ‹É, $D¯‘Áèí«Õ) { } protected function _afterUpdate($d»ğãŠ‘¾Ö, $f´Ó¡òÀÛ) { } public function delete($d§È…ŒÆç¨ = array()) { goto dÙÊèÊß“…; dÙÊèÊß“…: $E–ñ©¡‡©Œ =& $_SERVER[¬¦ã¾]; if (empty($d§È…ŒÆç¨) && empty($this->options[$E–ñ©¡‡©Œ[273]])) { if (!empty($this->data) && isset($this->data[$this->getPk()])) { return $this->delete($this->data[$this->getPk()]); } else { return !1; } } $eç³ÙñŸ³Û = $this->getPk(); goto D¸‘¼£Õ¾Â; A…Š›±£¶: $Fè°ÅŞ¿¬‘ = $this->db->delete($d§È…ŒÆç¨); if (!1 !== $Fè°ÅŞ¿¬‘) { $C†ùµ‘‘ß = array(); if (isset($CãÅÚÌˆªŒ)) { $C†ùµ‘‘ß[$eç³ÙñŸ³Û] = $CãÅÚÌˆªŒ; } $this->_after_delete($C†ùµ‘‘ß, $d§È…ŒÆç¨); } return $Fè°ÅŞ¿¬‘; goto AÌß¤—‰ÅŠ; D¸‘¼£Õ¾Â: if (is_numeric($d§È…ŒÆç¨) || is_string($d§È…ŒÆç¨)) { if (strpos($d§È…ŒÆç¨, $E–ñ©¡‡©Œ[47])) { $c¨ŒÂÄÇ”Ä[$eç³ÙñŸ³Û] = array($E–ñ©¡‡©Œ[274], $d§È…ŒÆç¨); } else { $c¨ŒÂÄÇ”Ä[$eç³ÙñŸ³Û] = $d§È…ŒÆç¨; } $this->options[$E–ñ©¡‡©Œ[273]] = $c¨ŒÂÄÇ”Ä; } $d§È…ŒÆç¨ = $this->_parseOptions(); if (is_array($d§È…ŒÆç¨[$E–ñ©¡‡©Œ[273]]) && isset($d§È…ŒÆç¨[$E–ñ©¡‡©Œ[273]][$eç³ÙñŸ³Û])) { $CãÅÚÌˆªŒ = $d§È…ŒÆç¨[$E–ñ©¡‡©Œ[273]][$eç³ÙñŸ³Û]; } goto A…Š›±£¶; AÌß¤—‰ÅŠ: } protected function _after_delete($Eš÷¼¦Ï², $F¡ê¦•¼ŒÌ) { } public function select($C‰Œìù˜î = array()) { goto a»Ù´ÎèÍÓ; dò ¿œÎğÙ: $aåëƒ‰«¶‰ = $this->db->select($C‰Œìù˜î); if (!1 === $aåëƒ‰«¶‰) { return !1; } if (empty($aåëƒ‰«¶‰)) { return null; } goto dÓÓƒè…½¶; dÓÓƒè…½¶: $this->_afterSelect($aåëƒ‰«¶‰, $C‰Œìù˜î); return $aåëƒ‰«¶‰; goto CÚœ§„Á½; a»Ù´ÎèÍÓ: $cîˆÀÅÔê =& $_SERVER[¬¦ã¾]; if (is_string($C‰Œìù˜î) || is_numeric($C‰Œìù˜î)) { $Cµ•©ä¶µ = $this->getPk(); if (strpos($C‰Œìù˜î, $cîˆÀÅÔê[47])) { $bá¾÷Çƒ£[$Cµ•©ä¶µ] = array($cîˆÀÅÔê[274], $C‰Œìù˜î); } else { $bá¾÷Çƒ£[$Cµ•©ä¶µ] = $C‰Œìù˜î; } $this->options[$cîˆÀÅÔê[273]] = $bá¾÷Çƒ£; } elseif (!1 === $C‰Œìù˜î) { $C‰Œìù˜î = $this->_parseOptions(); return $cîˆÀÅÔê[275] . $this->db->buildSelectSql($C‰Œìù˜î) . $cîˆÀÅÔê[276]; } $C‰Œìù˜î = $this->_parseOptions(); goto dò ¿œÎğÙ; CÚœ§„Á½: } protected function _afterSelect(&$eò‚ƒŒÍ„Ë, $bÕÃÛĞÅ”â) { } public function buildSql($Eâ—ÈùªÌŠ = array()) { $cË™×ó¶Æ÷ =& $_SERVER[¬¦ã¾]; $Eâ—ÈùªÌŠ = $this->_parseOptions($Eâ—ÈùªÌŠ); return $cË™×ó¶Æ÷[275] . $this->db->buildSelectSql($Eâ—ÈùªÌŠ) . $cË™×ó¶Æ÷[276]; } public function optionsValue($bÏÜÇ˜Ñ¿­ = null) { if (is_null($bÏÜÇ˜Ñ¿­)) { return $this->options; } elseif (is_array($bÏÜÇ˜Ñ¿­)) { $this->options = array_merge($this->options, $bÏÜÇ˜Ñ¿­); } } protected function _parseOptions($fŠË×Ÿ…œ = array()) { goto A¢øÊª‹Œë; F¾ÂÇÔ¦­ß: if (!isset($fŠË×Ÿ…œ[$cÂĞ’éôÒ[277]])) { $fŠË×Ÿ…œ[$cÂĞ’éôÒ[277]] = $this->getTableName(); $fÕí•Ô³ÈÓ = $this->fields; } else { $fÕí•Ô³ÈÓ = $this->getDbFields(); } if (!empty($fŠË×Ÿ…œ[$cÂĞ’éôÒ[278]])) { $fŠË×Ÿ…œ[$cÂĞ’éôÒ[277]] .= $cÂĞ’éôÒ[50] . $fŠË×Ÿ…œ[$cÂĞ’éôÒ[278]]; } $fŠË×Ÿ…œ[$cÂĞ’éôÒ[279]] = $this->name; goto E…ôä¯°„Á; E…ôä¯°„Á: if (isset($fŠË×Ÿ…œ[$cÂĞ’éôÒ[273]]) && is_array($fŠË×Ÿ…œ[$cÂĞ’éôÒ[273]]) && !empty($fÕí•Ô³ÈÓ) && !isset($fŠË×Ÿ…œ[$cÂĞ’éôÒ[280]]) && !isset($fŠË×Ÿ…œ[$cÂĞ’éôÒ[277]])) { foreach ($fŠË×Ÿ…œ[$cÂĞ’éôÒ[273]] as $F„Ÿçå”³ => $D‹ä“š¤¡÷) { $F„Ÿçå”³ = trim($F„Ÿçå”³); if (in_array($F„Ÿçå”³, $fÕí•Ô³ÈÓ, !0)) { if (is_scalar($D‹ä“š¤¡÷)) { $this->_parseType($fŠË×Ÿ…œ[$cÂĞ’éôÒ[273]], $F„Ÿçå”³); } } elseif (!is_numeric($F„Ÿçå”³) && $cÂĞ’éôÒ[71] != substr($F„Ÿçå”³, 0, 1) && !1 === strpos($F„Ÿçå”³, $cÂĞ’éôÒ[95]) && !1 === strpos($F„Ÿçå”³, $cÂĞ’éôÒ[258]) && !1 === strpos($F„Ÿçå”³, $cÂĞ’éôÒ[281]) && !1 === strpos($F„Ÿçå”³, $cÂĞ’éôÒ[282])) { unset($fŠË×Ÿ…œ[$cÂĞ’éôÒ[273]][$F„Ÿçå”³]); } } } $this->_options_filter($fŠË×Ÿ…œ); return $fŠË×Ÿ…œ; goto cÌá¡˜ôæô; A¢øÊª‹Œë: $cÂĞ’éôÒ =& $_SERVER[¬¦ã¾]; if (is_array($fŠË×Ÿ…œ)) { $fŠË×Ÿ…œ = array_merge($this->options, $fŠË×Ÿ…œ); } $this->options = array(); goto F¾ÂÇÔ¦­ß; cÌá¡˜ôæô: } protected function _options_filter(&$d¤åÆÄˆÉ˜) { } protected function _parseType(&$A„Ÿµ¹‚, $Fˆè×¼´é›) { $E½Õ¡òÙÀ =& $_SERVER[¬¦ã¾]; if (empty($this->options[$E½Õ¡òÙÀ[283]][$E½Õ¡òÙÀ[4] . $Fˆè×¼´é›])) { $fäï§î™ = strtolower($this->fields[$E½Õ¡òÙÀ[250]][$Fˆè×¼´é›]); if (!1 !== strpos($fäï§î™, $E½Õ¡òÙÀ[284])) { } elseif (!1 === strpos($fäï§î™, $E½Õ¡òÙÀ[285]) && !1 !== strpos($fäï§î™, $E½Õ¡òÙÀ[286])) { $A„Ÿµ¹‚[$Fˆè×¼´é›] = intval($A„Ÿµ¹‚[$Fˆè×¼´é›]); } elseif (!1 !== strpos($fäï§î™, $E½Õ¡òÙÀ[287]) || !1 !== strpos($fäï§î™, $E½Õ¡òÙÀ[288])) { $A„Ÿµ¹‚[$Fˆè×¼´é›] = floatval($A„Ÿµ¹‚[$Fˆè×¼´é›]); } elseif (!1 !== strpos($fäï§î™, $E½Õ¡òÙÀ[289])) { $A„Ÿµ¹‚[$Fˆè×¼´é›] = (bool) $A„Ÿµ¹‚[$Fˆè×¼´é›]; } } } public function find($e˜·Ó½ÌÃ = array()) { goto fîÃšô•Ÿ; F¥Ğ„×ÔÑÄ: if (!empty($this->options[$aÛ°ˆŠªƒÄ[291]])) { return $this->returnResult($this->data, $this->options[$aÛ°ˆŠªƒÄ[291]]); } return $this->data; goto dñ©•÷—ñ; Eòä¿¤åõ: if (empty($cã‚’é »˜)) { return null; } $this->data = $cã‚’é »˜[0]; $this->_afterFind($this->data, $e˜·Ó½ÌÃ); goto F¥Ğ„×ÔÑÄ; fîÃšô•Ÿ: $aÛ°ˆŠªƒÄ =& $_SERVER[¬¦ã¾]; if (is_numeric($e˜·Ó½ÌÃ) || is_string($e˜·Ó½ÌÃ)) { $f‹²Èêä°ì[$this->getPk()] = intval($e˜·Ó½ÌÃ); $this->options[$aÛ°ˆŠªƒÄ[273]] = $f‹²Èêä°ì; } $this->options[$aÛ°ˆŠªƒÄ[290]] = 1; goto c§ìÁî§«…; c§ìÁî§«…: $e˜·Ó½ÌÃ = $this->_parseOptions(); $cã‚’é »˜ = $this->db->select($e˜·Ó½ÌÃ); if (!1 === $cã‚’é »˜) { return !1; } goto Eòä¿¤åõ; dñ©•÷—ñ: } protected function _afterFind(&$C¦“Ñ¦‹ÁÉ, $dŠÈª¯®‘Ö) { } protected function returnResult($D’Àé‹Ôìï, $e†Ü¾¾ç—Ä = '') { $Cä‘¸¯¯œ“ =& $_SERVER[¬¦ã¾]; if ($e†Ü¾¾ç—Ä) { if (is_callable($e†Ü¾¾ç—Ä)) { return call_user_func($e†Ü¾¾ç—Ä, $D’Àé‹Ôìï); } switch (strtolower($e†Ü¾¾ç—Ä)) { case $Cä‘¸¯¯œ“[292]: return json_encode($D’Àé‹Ôìï); case $Cä‘¸¯¯œ“[293]: return xml_encode($D’Àé‹Ôìï); } } return $D’Àé‹Ôìï; } public function parseFieldsMap($CœÓ˜Şì, $b½„¦¶Æ÷Ü = 1) { if (!empty($this->_map)) { foreach ($this->_map as $d‹¬¥š·Â => $F«­šáñ¯Ò) { if ($b½„¦¶Æ÷Ü == 1) { if (isset($CœÓ˜Şì[$F«­šáñ¯Ò])) { $CœÓ˜Şì[$d‹¬¥š·Â] = $CœÓ˜Şì[$F«­šáñ¯Ò]; unset($CœÓ˜Şì[$F«­šáñ¯Ò]); } } else { if (isset($CœÓ˜Şì[$d‹¬¥š·Â])) { $CœÓ˜Şì[$F«­šáñ¯Ò] = $CœÓ˜Şì[$d‹¬¥š·Â]; unset($CœÓ˜Şì[$d‹¬¥š·Â]); } } } } return $CœÓ˜Şì; } public function setField($Eå‡²Ğ’™Â, $dÍÆÒÇÂ£æ = '') { if (is_array($Eå‡²Ğ’™Â)) { $a£ÁÖ¿¦Æ = $Eå‡²Ğ’™Â; } else { $a£ÁÖ¿¦Æ[$Eå‡²Ğ’™Â] = $dÍÆÒÇÂ£æ; } return $this->save($a£ÁÖ¿¦Æ); } public function setAdd($Eõš¾µ¬³½, $D²ùï±ŠÎŞ = 1) { $fƒ‰¥÷Ş =& $_SERVER[¬¦ã¾]; $cù¸Œ÷©ÓÇ = $Eõš¾µ¬³½ . $fƒ‰¥÷Ş[294] . $D²ùï±ŠÎŞ; if ($D²ùï±ŠÎŞ < 0) { $cù¸Œ÷©ÓÇ = $Eõš¾µ¬³½ . $D²ùï±ŠÎŞ; } return $this->setField($Eõš¾µ¬³½, array($fƒ‰¥÷Ş[295], $cù¸Œ÷©ÓÇ)); } public function getField($BÃµÚÙ”œ, $a”§îØÏÄ‡ = null) { $d¾Îï©Ş±Ü =& $_SERVER[¬¦ã¾]; $cÅéÄƒõÖë[$d¾Îï©Ş±Ü[271]] = $BÃµÚÙ”œ; $cÅéÄƒõÖë = $this->_parseOptions($cÅéÄƒõÖë); $BÃµÚÙ”œ = trim($BÃµÚÙ”œ); if (strpos($BÃµÚÙ”œ, $d¾Îï©Ş±Ü[47])) { if (!isset($cÅéÄƒõÖë[$d¾Îï©Ş±Ü[290]])) { $cÅéÄƒõÖë[$d¾Îï©Ş±Ü[290]] = is_numeric($a”§îØÏÄ‡) ? $a”§îØÏÄ‡ : $d¾Îï©Ş±Ü[33]; } $EöÓÈŸãåâ = $this->db->select($cÅéÄƒõÖë); if (!empty($EöÓÈŸãåâ)) { goto Dß¾Î¾ä¦­; Dˆ†¿İÎìÔ: $F¬ÛÊÏêó­ = array_shift($BÃµÚÙ”œ); $CÛó—‘ ÂÀ = array(); $Eâöé‚µ–– = count($E“‰á¶¬ÔŒ); goto F¨‘ƒõ‰Í; Dß¾Î¾ä¦­: $E“‰á¶¬ÔŒ = explode($d¾Îï©Ş±Ü[47], $BÃµÚÙ”œ); $BÃµÚÙ”œ = array_keys($EöÓÈŸãåâ[0]); $DÓà‹ÃÄª = array_shift($BÃµÚÙ”œ); goto Dˆ†¿İÎìÔ; F¨‘ƒõ‰Í: foreach ($EöÓÈŸãåâ as $c®ã¤»„Ú×) { $cåÆÒÀâŒœ = $c®ã¤»„Ú×[$DÓà‹ÃÄª]; if (2 == $Eâöé‚µ––) { $CÛó—‘ ÂÀ[$cåÆÒÀâŒœ] = $c®ã¤»„Ú×[$F¬ÛÊÏêó­]; } else { $CÛó—‘ ÂÀ[$cåÆÒÀâŒœ] = is_string($a”§îØÏÄ‡) ? implode($a”§îØÏÄ‡, $c®ã¤»„Ú×) : $c®ã¤»„Ú×; } } return $CÛó—‘ ÂÀ; goto DŠ „‰œ‹ë; DŠ „‰œ‹ë: } } else { if (!0 !== $a”§îØÏÄ‡) { $cÅéÄƒõÖë[$d¾Îï©Ş±Ü[290]] = is_numeric($a”§îØÏÄ‡) ? $a”§îØÏÄ‡ : 1; } if ($a”§îØÏÄ‡ === $d¾Îï©Ş±Ü[253]) { unset($cÅéÄƒõÖë[$d¾Îï©Ş±Ü[290]]); } $c®ã¤»„Ú× = $this->db->select($cÅéÄƒõÖë); if (!empty($c®ã¤»„Ú×)) { if ($a”§îØÏÄ‡ === $d¾Îï©Ş±Ü[253]) { return reset($c®ã¤»„Ú×[0]); } if (!0 !== $a”§îØÏÄ‡ && 1 == $cÅéÄƒõÖë[$d¾Îï©Ş±Ü[290]]) { return reset($c®ã¤»„Ú×[0]); } foreach ($c®ã¤»„Ú× as $Bò’ñ„‚) { $fÌÕŒÍÚÓŸ[] = $Bò’ñ„‚[$BÃµÚÙ”œ]; } return $fÌÕŒÍÚÓŸ; } } return null; } public function create($Bµ™İ•çµ¿ = '', $eÊ‡ó›ÑÚ = '') { goto FÙï‘±ßƒì; fÛŞ•šÇÙè: if (isset($cäá„Çõ‡é)) { if (is_string($cäá„Çõ‡é)) { $cäá„Çõ‡é = explode($d—ĞÈ…Ô¤[47], $cäá„Çõ‡é); } if (think_config($d—ĞÈ…Ô¤[296])) { $cäá„Çõ‡é[] = think_config($d—ĞÈ…Ô¤[297]); } foreach ($Bµ™İ•çµ¿ as $dö²‡Ş—™ => $Dæ«Í¹¹¨õ) { if (!in_array($dö²‡Ş—™, $cäá„Çõ‡é)) { unset($Bµ™İ•çµ¿[$dö²‡Ş—™]); } } } if (!$this->autoValidation($Bµ™İ•çµ¿, $eÊ‡ó›ÑÚ)) { return !1; } if (!$this->autoCheckToken($Bµ™İ•çµ¿)) { $this->error = think_lang($d—ĞÈ…Ô¤[298]); return !1; } goto aÍò²²‡Úœ; Fšé¡•²áä: return $Bµ™İ•çµ¿; goto BØÆğéÉŸŒ; cò—Û‹óÖÅ: $Bµ™İ•çµ¿ = $this->parseFieldsMap($Bµ™İ•çµ¿, 0); $eÊ‡ó›ÑÚ = $eÊ‡ó›ÑÚ ? $eÊ‡ó›ÑÚ : (!empty($Bµ™İ•çµ¿[$this->getPk()]) ? THINK_MODEL_UPDATE : THINK_MODEL_INSERT); if (isset($this->options[$d—ĞÈ…Ô¤[271]])) { $cäá„Çõ‡é = $this->options[$d—ĞÈ…Ô¤[271]]; unset($this->options[$d—ĞÈ…Ô¤[271]]); } elseif ($eÊ‡ó›ÑÚ == THINK_MODEL_INSERT && isset($this->insertFields)) { $cäá„Çõ‡é = $this->insertFields; } elseif ($eÊ‡ó›ÑÚ == THINK_MODEL_UPDATE && isset($this->updateFields)) { $cäá„Çõ‡é = $this->updateFields; } goto fÛŞ•šÇÙè; aÍò²²‡Úœ: if ($this->autoCheckFields) { $cäá„Çõ‡é = $this->getDbFields(); foreach ($Bµ™İ•çµ¿ as $dö²‡Ş—™ => $Dæ«Í¹¹¨õ) { if (!in_array($dö²‡Ş—™, $cäá„Çõ‡é)) { unset($Bµ™İ•çµ¿[$dö²‡Ş—™]); } elseif (MAGIC_QUOTES_GPC && is_string($Dæ«Í¹¹¨õ)) { $Bµ™İ•çµ¿[$dö²‡Ş—™] = stripslashes($Dæ«Í¹¹¨õ); } } } $this->autoOperation($Bµ™İ•çµ¿, $eÊ‡ó›ÑÚ); $this->data = $Bµ™İ•çµ¿; goto Fšé¡•²áä; FÙï‘±ßƒì: $d—ĞÈ…Ô¤ =& $_SERVER[¬¦ã¾]; if (empty($Bµ™İ•çµ¿)) { $Bµ™İ•çµ¿ = $_POST; } elseif (is_object($Bµ™İ•çµ¿)) { $Bµ™İ•çµ¿ = get_object_vars($Bµ™İ•çµ¿); } if (empty($Bµ™İ•çµ¿) || !is_array($Bµ™İ•çµ¿)) { $this->error = think_lang($d—ĞÈ…Ô¤[269]); return !1; } goto cò—Û‹óÖÅ; BØÆğéÉŸŒ: } public function autoCheckToken($CÒÔŞÃ¾‡) { $e¹èìò›ô =& $_SERVER[¬¦ã¾]; if (isset($this->options[$e¹èìò›ô[299]]) && !$this->options[$e¹èìò›ô[299]]) { return !0; } if (think_config($e¹èìò›ô[296])) { $Fß÷…ù¯Ì‰ = think_config($e¹èìò›ô[297]); if (!isset($CÒÔŞÃ¾‡[$Fß÷…ù¯Ì‰]) || Session::get($Fß÷…ù¯Ì‰)) { return !1; } list($BÕ”‡Ê˜öš, $E¦Üœôƒ§) = explode($e¹èìò›ô[71], $CÒÔŞÃ¾‡[$Fß÷…ù¯Ì‰]); if ($E¦Üœôƒ§ && Session::get($Fß÷…ù¯Ì‰ . $e¹èìò›ô[95] . $BÕ”‡Ê˜öš) === $E¦Üœôƒ§) { Session::remove($Fß÷…ù¯Ì‰ . $e¹èìò›ô[95] . $BÕ”‡Ê˜öš); return !0; } if (think_config($e¹èìò›ô[300])) { Session::remove($Fß÷…ù¯Ì‰ . $e¹èìò›ô[95] . $BÕ”‡Ê˜öš); } return !1; } return !0; } public function regex($bÜ«­‘Ä«º, $EÃÙºÔØÜ) { $C‘…Äæ±¤ =& $_SERVER[¬¦ã¾]; $dÓëÚ‰ª¿° = array($C‘…Äæ±¤[301] => $C‘…Äæ±¤[302], $C‘…Äæ±¤[303] => $C‘…Äæ±¤[304], $C‘…Äæ±¤[305] => $C‘…Äæ±¤[306], $C‘…Äæ±¤[307] => $C‘…Äæ±¤[308], $C‘…Äæ±¤[309] => $C‘…Äæ±¤[310], $C‘…Äæ±¤[311] => $C‘…Äæ±¤[312], $C‘…Äæ±¤[313] => $C‘…Äæ±¤[314], $C‘…Äæ±¤[288] => $C‘…Äæ±¤[315], $C‘…Äæ±¤[316] => $C‘…Äæ±¤[317]); if (isset($dÓëÚ‰ª¿°[strtolower($EÃÙºÔØÜ)])) { $EÃÙºÔØÜ = $dÓëÚ‰ª¿°[strtolower($EÃÙºÔØÜ)]; } return preg_match($EÃÙºÔØÜ, $bÜ«­‘Ä«º) === 1; } private function autoOperation(&$C´…•±À¥Ë, $C§¸ê¯Æ›ì) { $c†á Ô•‰Í =& $_SERVER[¬¦ã¾]; if (!empty($this->options[$c†á Ô•‰Í[318]])) { $BÈ¿ğò“ = $this->options[$c†á Ô•‰Í[318]]; unset($this->options[$c†á Ô•‰Í[318]]); } elseif (!empty($this->_auto)) { $BÈ¿ğò“ = $this->_auto; } if (isset($BÈ¿ğò“)) { foreach ($BÈ¿ğò“ as $d•ÑŠÜôË) { if (empty($d•ÑŠÜôË[2])) { $d•ÑŠÜôË[2] = THINK_MODEL_INSERT; } if ($C§¸ê¯Æ›ì == $d•ÑŠÜôË[2] || $d•ÑŠÜôË[2] == THINK_MODEL_BOTH) { switch (trim($d•ÑŠÜôË[3])) { case $c†á Ô•‰Í[319]: case $c†á Ô•‰Í[320]: $c¼ˆò¢‚áÌ = isset($d•ÑŠÜôË[4]) ? (array) $d•ÑŠÜôË[4] : array(); if (isset($C´…•±À¥Ë[$d•ÑŠÜôË[0]])) { array_unshift($c¼ˆò¢‚áÌ, $C´…•±À¥Ë[$d•ÑŠÜôË[0]]); } if ($c†á Ô•‰Í[319] == $d•ÑŠÜôË[3]) { $C´…•±À¥Ë[$d•ÑŠÜôË[0]] = call_user_func_array($d•ÑŠÜôË[1], $c¼ˆò¢‚áÌ); } else { $C´…•±À¥Ë[$d•ÑŠÜôË[0]] = call_user_func_array(array(&$this, $d•ÑŠÜôË[1]), $c¼ˆò¢‚áÌ); } break; case $c†á Ô•‰Í[271]: $C´…•±À¥Ë[$d•ÑŠÜôË[0]] = $C´…•±À¥Ë[$d•ÑŠÜôË[1]]; break; case $c†á Ô•‰Í[321]: if ($c†á Ô•‰Í[33] === $C´…•±À¥Ë[$d•ÑŠÜôË[0]]) { unset($C´…•±À¥Ë[$d•ÑŠÜôË[0]]); } break; case $c†á Ô•‰Í[322]: default: $C´…•±À¥Ë[$d•ÑŠÜôË[0]] = $d•ÑŠÜôË[1]; } if (!1 === $C´…•±À¥Ë[$d•ÑŠÜôË[0]]) { unset($C´…•±À¥Ë[$d•ÑŠÜôË[0]]); } } } } return $C´…•±À¥Ë; } protected function autoValidation($Cä™º‹ñÕ¤, $AÜëÅáêù) { $e®–Ñø²ÒŠ =& $_SERVER[¬¦ã¾]; if (!empty($this->options[$e®–Ñø²ÒŠ[323]])) { $dæóöõ‘ = $this->options[$e®–Ñø²ÒŠ[323]]; unset($this->options[$e®–Ñø²ÒŠ[323]]); } elseif (!empty($this->_validate)) { $dæóöõ‘ = $this->_validate; } if (isset($dæóöõ‘)) { if ($this->patchValidate) { $this->error = array(); } foreach ($dæóöõ‘ as $f†…ŸÔø™ => $E•ñ¤‚‡ƒÓ) { if (empty($E•ñ¤‚‡ƒÓ[5]) || $E•ñ¤‚‡ƒÓ[5] == THINK_MODEL_BOTH || $E•ñ¤‚‡ƒÓ[5] == $AÜëÅáêù) { if (0 == strpos($E•ñ¤‚‡ƒÓ[2], $e®–Ñø²ÒŠ[324]) && strpos($E•ñ¤‚‡ƒÓ[2], $e®–Ñø²ÒŠ[325])) { $E•ñ¤‚‡ƒÓ[2] = think_lang(substr($E•ñ¤‚‡ƒÓ[2], 2, -1)); } $E•ñ¤‚‡ƒÓ[3] = isset($E•ñ¤‚‡ƒÓ[3]) ? $E•ñ¤‚‡ƒÓ[3] : THINK_EXISTS_VALIDATE; $E•ñ¤‚‡ƒÓ[4] = isset($E•ñ¤‚‡ƒÓ[4]) ? $E•ñ¤‚‡ƒÓ[4] : $e®–Ñø²ÒŠ[326]; switch ($E•ñ¤‚‡ƒÓ[3]) { case THINK_MUST_VALIDATE: if (!1 === $this->_validationField($Cä™º‹ñÕ¤, $E•ñ¤‚‡ƒÓ)) { return !1; } break; case THINK_VALUE_VALIDATE: if ($e®–Ñø²ÒŠ[33] != trim($Cä™º‹ñÕ¤[$E•ñ¤‚‡ƒÓ[0]])) { if (!1 === $this->_validationField($Cä™º‹ñÕ¤, $E•ñ¤‚‡ƒÓ)) { return !1; } } break; default: if (isset($Cä™º‹ñÕ¤[$E•ñ¤‚‡ƒÓ[0]])) { if (!1 === $this->_validationField($Cä™º‹ñÕ¤, $E•ñ¤‚‡ƒÓ)) { return !1; } } } } } if (!empty($this->error)) { return !1; } } return !0; } protected function _validationField($dâë›ƒå, $a­ÃÚˆÏ¥×) { if (!1 === $this->_validationFieldItem($dâë›ƒå, $a­ÃÚˆÏ¥×)) { if ($this->patchValidate) { $this->error[$a­ÃÚˆÏ¥×[0]] = $a­ÃÚˆÏ¥×[2]; } else { $this->error = $a­ÃÚˆÏ¥×[2]; return !1; } } return; } protected function _validationFieldItem($fËà‡õšìÊ, $BÂŠŞ“ °») { $F¡±Ü†‘¦ª =& $_SERVER[¬¦ã¾]; switch (strtolower(trim($BÂŠŞ“ °»[4]))) { case $F¡±Ü†‘¦ª[319]: case $F¡±Ü†‘¦ª[320]: $A£Ùƒäõ°ˆ = isset($BÂŠŞ“ °»[6]) ? (array) $BÂŠŞ“ °»[6] : array(); if (is_string($BÂŠŞ“ °»[0]) && strpos($BÂŠŞ“ °»[0], $F¡±Ü†‘¦ª[47])) { $BÂŠŞ“ °»[0] = explode($F¡±Ü†‘¦ª[47], $BÂŠŞ“ °»[0]); } if (is_array($BÂŠŞ“ °»[0])) { foreach ($BÂŠŞ“ °»[0] as $D§ÃÅĞ¿Í÷) { $FˆŠ²Â¹“·[$D§ÃÅĞ¿Í÷] = $fËà‡õšìÊ[$D§ÃÅĞ¿Í÷]; } array_unshift($A£Ùƒäõ°ˆ, $FˆŠ²Â¹“·); } else { array_unshift($A£Ùƒäõ°ˆ, $fËà‡õšìÊ[$BÂŠŞ“ °»[0]]); } if ($F¡±Ü†‘¦ª[319] == $BÂŠŞ“ °»[4]) { return call_user_func_array($BÂŠŞ“ °»[1], $A£Ùƒäõ°ˆ); } else { return call_user_func_array(array(&$this, $BÂŠŞ“ °»[1]), $A£Ùƒäõ°ˆ); } case $F¡±Ü†‘¦ª[327]: return $fËà‡õšìÊ[$BÂŠŞ“ °»[0]] == $fËà‡õšìÊ[$BÂŠŞ“ °»[1]]; case $F¡±Ü†‘¦ª[328]: if (is_string($BÂŠŞ“ °»[0]) && strpos($BÂŠŞ“ °»[0], $F¡±Ü†‘¦ª[47])) { $BÂŠŞ“ °»[0] = explode($F¡±Ü†‘¦ª[47], $BÂŠŞ“ °»[0]); } $b¾¹ÄˆŒÙ = array(); if (is_array($BÂŠŞ“ °»[0])) { foreach ($BÂŠŞ“ °»[0] as $D§ÃÅĞ¿Í÷) { $b¾¹ÄˆŒÙ[$D§ÃÅĞ¿Í÷] = $fËà‡õšìÊ[$D§ÃÅĞ¿Í÷]; } } else { $b¾¹ÄˆŒÙ[$BÂŠŞ“ °»[0]] = $fËà‡õšìÊ[$BÂŠŞ“ °»[0]]; } if (!empty($fËà‡õšìÊ[$this->getPk()])) { $b¾¹ÄˆŒÙ[$this->getPk()] = array($F¡±Ü†‘¦ª[329], $fËà‡õšìÊ[$this->getPk()]); } if ($this->where($b¾¹ÄˆŒÙ)->find()) { return !1; } return !0; default: return $this->check($fËà‡õšìÊ[$BÂŠŞ“ °»[0]], $BÂŠŞ“ °»[1], $BÂŠŞ“ °»[4]); } } public function check($Cô—èŞ•º, $bóğå¨í‚«, $c‰Ö…†¸á¯ = "\x72\x65\147\x65\x78") { $AĞùØŠ«æŒ =& $_SERVER[¬¦ã¾]; $c‰Ö…†¸á¯ = strtolower(trim($c‰Ö…†¸á¯)); switch ($c‰Ö…†¸á¯) { case $AĞùØŠ«æŒ[7]: case $AĞùØŠ«æŒ[330]: $Eè®¼‡‹…ª = is_array($bóğå¨í‚«) ? $bóğå¨í‚« : explode($AĞùØŠ«æŒ[47], $bóğå¨í‚«); return $c‰Ö…†¸á¯ == $AĞùØŠ«æŒ[7] ? in_array($Cô—èŞ•º, $Eè®¼‡‹…ª) : !in_array($Cô—èŞ•º, $Eè®¼‡‹…ª); case $AĞùØŠ«æŒ[331]: case $AĞùØŠ«æŒ[332]: if (is_array($bóğå¨í‚«)) { $b¨Ÿ…™èô = $bóğå¨í‚«[0]; $C¤Å¦ÛÆ» = $bóğå¨í‚«[1]; } else { list($b¨Ÿ…™èô, $C¤Å¦ÛÆ») = explode($AĞùØŠ«æŒ[47], $bóğå¨í‚«); } return $c‰Ö…†¸á¯ == $AĞùØŠ«æŒ[331] ? $Cô—èŞ•º >= $b¨Ÿ…™èô && $Cô—èŞ•º <= $C¤Å¦ÛÆ» : $Cô—èŞ•º < $b¨Ÿ…™èô || $Cô—èŞ•º > $C¤Å¦ÛÆ»; case $AĞùØŠ«æŒ[333]: case $AĞùØŠ«æŒ[334]: return $c‰Ö…†¸á¯ == $AĞùØŠ«æŒ[333] ? $Cô—èŞ•º == $bóğå¨í‚« : $Cô—èŞ•º != $bóğå¨í‚«; case $AĞùØŠ«æŒ[335]: $e¦¯Œ™•èÔ = mb_strlen($Cô—èŞ•º, $AĞùØŠ«æŒ[336]); if (strpos($bóğå¨í‚«, $AĞùØŠ«æŒ[47])) { list($b¨Ÿ…™èô, $C¤Å¦ÛÆ») = explode($AĞùØŠ«æŒ[47], $bóğå¨í‚«); return $e¦¯Œ™•èÔ >= $b¨Ÿ…™èô && $e¦¯Œ™•èÔ <= $C¤Å¦ÛÆ»; } else { return $e¦¯Œ™•èÔ == $bóğå¨í‚«; } case $AĞùØŠ«æŒ[337]: list($A²Âç²¸§, $E×ÅÆÙ¥) = explode($AĞùØŠ«æŒ[47], $bóğå¨í‚«); if (!is_numeric($A²Âç²¸§)) { $A²Âç²¸§ = strtotime($A²Âç²¸§); } if (!is_numeric($E×ÅÆÙ¥)) { $E×ÅÆÙ¥ = strtotime($E×ÅÆÙ¥); } return NOW_TIME >= $A²Âç²¸§ && NOW_TIME <= $E×ÅÆÙ¥; case $AĞùØŠ«æŒ[338]: return in_array(get_client_ip(), explode($AĞùØŠ«æŒ[47], $bóğå¨í‚«)); case $AĞùØŠ«æŒ[339]: return !in_array(get_client_ip(), explode($AĞùØŠ«æŒ[47], $bóğå¨í‚«)); case $AĞùØŠ«æŒ[326]: default: return $this->regex($Cô—èŞ•º, $bóğå¨í‚«); } } public function query($aÃ¡³­±×½, $A¸æ•îÖÛê = false) { $Aà¸«ŒâŸç =& $_SERVER[¬¦ã¾]; if (!is_bool($A¸æ•îÖÛê) && !is_array($A¸æ•îÖÛê)) { $A¸æ•îÖÛê = func_get_args(); array_shift($A¸æ•îÖÛê); } $aÃ¡³­±×½ = str_replace(array($Aà¸«ŒâŸç[229], $Aà¸«ŒâŸç[340]), $Aà¸«ŒâŸç[50], $aÃ¡³­±×½); $aÃ¡³­±×½ = $this->parseSql($aÃ¡³­±×½, $A¸æ•îÖÛê); return $this->db->query($aÃ¡³­±×½); } public function execute($C‹‚¡‘Í¿, $f‡Ó„Ãšˆæ = false) { if (!is_bool($f‡Ó„Ãšˆæ) && !is_array($f‡Ó„Ãšˆæ)) { $f‡Ó„Ãšˆæ = func_get_args(); array_shift($f‡Ó„Ãšˆæ); } $C‹‚¡‘Í¿ = $this->parseSql($C‹‚¡‘Í¿, $f‡Ó„Ãšˆæ); return $this->db->execute($C‹‚¡‘Í¿); } protected function parseSql($fÌŞÉ¼·›¶, $føªŒ«¬Ü£) { $A‡ŒèµÚôä =& $_SERVER[¬¦ã¾]; if (!0 === $føªŒ«¬Ü£) { $D¬‘Š¥åÈî = $this->_parseOptions(); $fÌŞÉ¼·›¶ = $this->db->parseSql($fÌŞÉ¼·›¶, $D¬‘Š¥åÈî); } elseif (is_array($føªŒ«¬Ü£)) { $føªŒ«¬Ü£ = array_map(array($this->db, $A‡ŒèµÚôä[341]), $føªŒ«¬Ü£); $fÌŞÉ¼·›¶ = vsprintf($fÌŞÉ¼·›¶, $føªŒ«¬Ü£); } else { $fÌŞÉ¼·›¶ = strtr($fÌŞÉ¼·›¶, array($A‡ŒèµÚôä[342] => $this->getTableName(), $A‡ŒèµÚôä[343] => think_config($A‡ŒèµÚôä[242]))); } $this->db->setModel($this->name); return $fÌŞÉ¼·›¶; } public function db($D¶…·’•ºÇ = '', $F®ƒ¨è†ƒğ = '', $cä–•™Ÿå¿ = array()) { goto d­œ¡ƒ¤Ûâ; C»ğ™†ìÓ: if (!empty($this->name) && $this->autoCheckFields) { $this->_checkTableInfo(); } return $this; goto eêâ¯…Í™‘; d­œ¡ƒ¤Ûâ: $f¸”¡ÎÉõ– =& $_SERVER[¬¦ã¾]; if ($f¸”¡ÎÉõ–[33] === $D¶…·’•ºÇ && $this->db) { return $this->db; } static $DÌë«öœ¿ï = array(); goto bò£¸‚À¼¶; FÖ©‹Ä×í: $DÌë«öœ¿ï[$D¶…·’•ºÇ] = $F®ƒ¨è†ƒğ; $this->db = $A‚öµ †«ˆ[$D¶…·’•ºÇ]; $this->_after_db(); goto C»ğ™†ìÓ; bò£¸‚À¼¶: static $A‚öµ †«ˆ = array(); if (!isset($A‚öµ †«ˆ[$D¶…·’•ºÇ]) || isset($A‚öµ †«ˆ[$D¶…·’•ºÇ]) && $F®ƒ¨è†ƒğ && $DÌë«öœ¿ï[$D¶…·’•ºÇ] != $F®ƒ¨è†ƒğ) { if (!empty($F®ƒ¨è†ƒğ) && is_string($F®ƒ¨è†ƒğ) && !1 === strpos($F®ƒ¨è†ƒğ, $f¸”¡ÎÉõ–[8])) { $F®ƒ¨è†ƒğ = think_config($F®ƒ¨è†ƒğ); } $A‚öµ †«ˆ[$D¶…·’•ºÇ] = Db::getInstance($F®ƒ¨è†ƒğ); } elseif (NULL === $F®ƒ¨è†ƒğ) { $A‚öµ †«ˆ[$D¶…·’•ºÇ]->close(); unset($A‚öµ †«ˆ[$D¶…·’•ºÇ]); return; } if (!empty($cä–•™Ÿå¿)) { if (is_string($cä–•™Ÿå¿)) { parse_str($cä–•™Ÿå¿, $cä–•™Ÿå¿); } foreach ($cä–•™Ÿå¿ as $c„‰ƒ®ÀÃù => $fÓ„ÎÎƒ–•) { $this->setProperty($c„‰ƒ®ÀÃù, $fÓ„ÎÎƒ–•); } } goto FÖ©‹Ä×í; eêâ¯…Í™‘: } protected function _after_db() { } public function getModelName() { if (empty($this->name)) { $fÓØèˆ‹ÈË = get_class($this); if ($fÓØèˆ‹ÈË == $_SERVER[¬¦ã¾][344]) { return $this->name; } $this->name = substr($fÓØèˆ‹ÈË, 0, -5); } return $this->name; } public function getTableName() { $b–¨£ŒÅÓ =& $_SERVER[¬¦ã¾]; if (empty($this->trueTableName)) { $aÈ‚ìÈØ­µ = !empty($this->tablePrefix) ? $this->tablePrefix : $b–¨£ŒÅÓ[33]; if (!empty($this->tableName)) { $aÈ‚ìÈØ­µ .= $this->tableName; } else { $aÈ‚ìÈØ­µ .= think_parse_name($this->name); } $this->trueTableName = strtolower($aÈ‚ìÈØ­µ); } return (!empty($this->dbName) ? $this->dbName . $b–¨£ŒÅÓ[95] : $b–¨£ŒÅÓ[33]) . $this->trueTableName; } public function startTrans() { $this->commit(); $this->db->startTrans(); return; } public function commit() { return $this->db->commit(); } public function rollback() { return $this->db->rollback(); } public function getError() { return $this->error; } public function getDbError() { return $this->db->getError(); } public function getLastInsID() { return $this->db->getLastInsID(); } public function getLastSql() { return $this->db->getLastSql($this->name); } public function _sql() { return $this->getLastSql(); } public function getPk() { $a®˜çøĞÉ« =& $_SERVER[¬¦ã¾]; return isset($this->fields[$a®˜çøĞÉ«[249]]) ? $this->fields[$a®˜çøĞÉ«[249]] : $this->pk; } public function getDbFields() { $fù©Ê‹ìº˜ =& $_SERVER[¬¦ã¾]; if (isset($this->options[$fù©Ê‹ìº˜[277]])) { $F·ƒ½è—ù = $this->db->getFields($this->options[$fù©Ê‹ìº˜[277]]); return $F·ƒ½è—ù ? array_keys($F·ƒ½è—ù) : !1; } if ($this->fields) { $F·ƒ½è—ù = $this->fields; unset($F·ƒ½è—ù[$fù©Ê‹ìº˜[248]], $F·ƒ½è—ù[$fù©Ê‹ìº˜[249]], $F·ƒ½è—ù[$fù©Ê‹ìº˜[250]], $F·ƒ½è—ù[$fù©Ê‹ìº˜[247]]); return $F·ƒ½è—ù; } return !1; } public function data($aˆ¡Ù›ÃÒ« = '') { $DˆÎùÌ¹ˆØ =& $_SERVER[¬¦ã¾]; if ($DˆÎùÌ¹ˆØ[33] === $aˆ¡Ù›ÃÒ« && !empty($this->data)) { return $this->data; } if (is_object($aˆ¡Ù›ÃÒ«)) { $aˆ¡Ù›ÃÒ« = get_object_vars($aˆ¡Ù›ÃÒ«); } elseif (is_string($aˆ¡Ù›ÃÒ«)) { parse_str($aˆ¡Ù›ÃÒ«, $aˆ¡Ù›ÃÒ«); } elseif (!is_array($aˆ¡Ù›ÃÒ«)) { think_exception(think_lang($DˆÎùÌ¹ˆØ[269])); } $this->data = $aˆ¡Ù›ÃÒ«; return $this; } public function join($eÉ¦…ê­¾Ü) { $EéÚâ™‹ =& $_SERVER[¬¦ã¾]; if (is_array($eÉ¦…ê­¾Ü)) { $this->options[$EéÚâ™‹[280]] = $eÉ¦…ê­¾Ü; } elseif (!empty($eÉ¦…ê­¾Ü)) { $this->options[$EéÚâ™‹[280]][] = $eÉ¦…ê­¾Ü; } return $this; } public function union($bÙÇÚËç•à, $E­„­¡ì‚ = false) { goto C‹¢©ëîèõ; C‹¢©ëîèõ: $aÓªÆ’­áì =& $_SERVER[¬¦ã¾]; if (empty($bÙÇÚËç•à)) { return $this; } if ($E­„­¡ì‚) { $this->options[$aÓªÆ’­áì[345]][$aÓªÆ’­áì[346]] = !0; } goto D—ÒùËË²Î; D—ÒùËË²Î: if (is_object($bÙÇÚËç•à)) { $bÙÇÚËç•à = get_object_vars($bÙÇÚËç•à); } if (is_string($bÙÇÚËç•à)) { $EàËÁ×¤Û¼ = $bÙÇÚËç•à; } elseif (is_array($bÙÇÚËç•à)) { if (isset($bÙÇÚËç•à[0])) { $this->options[$aÓªÆ’­áì[345]] = array_merge($this->options[$aÓªÆ’­áì[345]], $bÙÇÚËç•à); return $this; } else { $EàËÁ×¤Û¼ = $bÙÇÚËç•à; } } else { think_exception(think_lang($aÓªÆ’­áì[269])); } $this->options[$aÓªÆ’­áì[345]][] = $EàËÁ×¤Û¼; goto fŸæÃåŒ“›; fŸæÃåŒ“›: return $this; goto d˜àá«…Ó; d˜àá«…Ó: } public function cache($eŠ¤ñœ¥™¡ = true, $Bƒµ’àª§• = null, $dİÕİ¼ÀÊ = '') { $Cé¥½Øİµ =& $_SERVER[¬¦ã¾]; if (!1 !== $eŠ¤ñœ¥™¡) { $this->options[$Cé¥½Øİµ[347]] = array($Cé¥½Øİµ[93] => $eŠ¤ñœ¥™¡, $Cé¥½Øİµ[337] => $Bƒµ’àª§•, $Cé¥½Øİµ[29] => $dİÕİ¼ÀÊ); } return $this; } public function field($DŠñ˜ÜØ—µ, $cºƒ³ƒá° = false) { $E˜©øÛ¯ê =& $_SERVER[¬¦ã¾]; if (!0 === $DŠñ˜ÜØ—µ) { $Aé±Û¥’‹ğ = $this->getDbFields(); $DŠñ˜ÜØ—µ = $Aé±Û¥’‹ğ ? $Aé±Û¥’‹ğ : $E˜©øÛ¯ê[182]; } elseif ($cºƒ³ƒá°) { if (is_string($DŠñ˜ÜØ—µ)) { $DŠñ˜ÜØ—µ = explode($E˜©øÛ¯ê[47], $DŠñ˜ÜØ—µ); } $Aé±Û¥’‹ğ = $this->getDbFields(); $DŠñ˜ÜØ—µ = $Aé±Û¥’‹ğ ? array_diff($Aé±Û¥’‹ğ, $DŠñ˜ÜØ—µ) : $DŠñ˜ÜØ—µ; } $this->options[$E˜©øÛ¯ê[271]] = $DŠñ˜ÜØ—µ; return $this; } public function scope($f«ˆ„Çä± = '', $e×²êŒø = NULL) { $d¥ˆ£ô°ˆÉ =& $_SERVER[¬¦ã¾]; if ($d¥ˆ£ô°ˆÉ[33] === $f«ˆ„Çä±) { if (isset($this->_scope[$d¥ˆ£ô°ˆÉ[34]])) { $aöŸçèê×‘ = $this->_scope[$d¥ˆ£ô°ˆÉ[34]]; } else { return $this; } } elseif (is_string($f«ˆ„Çä±)) { $C‹Õ›ÂğÂ¥ = explode($d¥ˆ£ô°ˆÉ[47], $f«ˆ„Çä±); $aöŸçèê×‘ = array(); foreach ($C‹Õ›ÂğÂ¥ as $DÁÊ¬¹öä¨) { if (!isset($this->_scope[$DÁÊ¬¹öä¨])) { continue; } $aöŸçèê×‘ = array_merge($aöŸçèê×‘, $this->_scope[$DÁÊ¬¹öä¨]); } if (!empty($e×²êŒø) && is_array($e×²êŒø)) { $aöŸçèê×‘ = array_merge($aöŸçèê×‘, $e×²êŒø); } } elseif (is_array($f«ˆ„Çä±)) { $aöŸçèê×‘ = $f«ˆ„Çä±; } if (is_array($aöŸçèê×‘) && !empty($aöŸçèê×‘)) { $this->options = array_merge($this->options, array_change_key_case($aöŸçèê×‘)); } return $this; } public function where($c’îŒ‰İâÅ, $då¼Œ¤ä¬Ä = null) { $B—„‹Û÷ƒ‚ =& $_SERVER[¬¦ã¾]; if (!is_null($då¼Œ¤ä¬Ä) && is_string($c’îŒ‰İâÅ)) { if (!is_array($då¼Œ¤ä¬Ä)) { $då¼Œ¤ä¬Ä = func_get_args(); array_shift($då¼Œ¤ä¬Ä); } $då¼Œ¤ä¬Ä = array_map(array($this->db, $B—„‹Û÷ƒ‚[341]), $då¼Œ¤ä¬Ä); $c’îŒ‰İâÅ = vsprintf($c’îŒ‰İâÅ, $då¼Œ¤ä¬Ä); } elseif (is_object($c’îŒ‰İâÅ)) { $c’îŒ‰İâÅ = get_object_vars($c’îŒ‰İâÅ); } elseif (is_array($c’îŒ‰İâÅ)) { foreach ($c’îŒ‰İâÅ as $B‹¹ò´óïà => $E’±±¬İ‹) { if ((is_numeric($B‹¹ò´óïà) || !$B‹¹ò´óïà) && is_string($E’±±¬İ‹)) { if (strpos($E’±±¬İ‹, $B—„‹Û÷ƒ‚[348]) === 0) { continue; } think_trace($B—„‹Û÷ƒ‚[349], $B—„‹Û÷ƒ‚[33], $B—„‹Û÷ƒ‚[46]); die; } } } if (is_string($c’îŒ‰İâÅ) && $B—„‹Û÷ƒ‚[33] != $c’îŒ‰İâÅ) { $CèôñØŒ¡ = array(); $CèôñØŒ¡[$B—„‹Û÷ƒ‚[350]] = $c’îŒ‰İâÅ; $c’îŒ‰İâÅ = $CèôñØŒ¡; } if (isset($this->options[$B—„‹Û÷ƒ‚[273]])) { $this->options[$B—„‹Û÷ƒ‚[273]] = array_merge($this->options[$B—„‹Û÷ƒ‚[273]], $c’îŒ‰İâÅ); } else { $this->options[$B—„‹Û÷ƒ‚[273]] = $c’îŒ‰İâÅ; } return $this; } public function limit($B¡¬É ˜„, $Dôâ¥Ëå„× = null) { $c­´«®ÃéÊ =& $_SERVER[¬¦ã¾]; $this->options[$c­´«®ÃéÊ[290]] = is_null($Dôâ¥Ëå„×) ? $B¡¬É ˜„ : $B¡¬É ˜„ . $c­´«®ÃéÊ[47] . $Dôâ¥Ëå„×; return $this; } public function page($d§±ãòØ›, $C°ĞÔ¤ÓÜ = null) { $E¦ñ…ªìçÜ =& $_SERVER[¬¦ã¾]; $this->options[$E¦ñ…ªìçÜ[351]] = is_null($C°ĞÔ¤ÓÜ) ? $d§±ãòØ› : $d§±ãòØ› . $E¦ñ…ªìçÜ[47] . $C°ĞÔ¤ÓÜ; return $this; } public function comment($eÔ‹£Ä’®) { $this->options[$_SERVER[¬¦ã¾][352]] = $eÔ‹£Ä’®; return $this; } public function setProperty($EßÜÕç˜›Â, $CŒêóàù¾¼) { if (property_exists($this, $EßÜÕç˜›Â)) { $this->{$EßÜÕç˜›Â} = $CŒêóàù¾¼; } return $this; } } goto e‚ºœäô©; AÑÓ•Ù±‚: class Backup { protected static $name; protected static $option; protected static $manual; public function __construct() { $this->init(); $this->keep(); } public function init() { $d¿·Íé¼Ê¦ =& $_SERVER[¬¦ã¾]; $this->isManual(); self::$name = date($d¿·Íé¼Ê¦[700]); if (!($bø‰Œàõïñ = Model($d¿·Íé¼Ê¦[701])->lastItem())) { $bø‰Œàõïñ = $this->initData(); } else { self::$name = $bø‰Œàõïñ[$d¿·Íé¼Ê¦[28]]; if ($bø‰Œàõïñ[$d¿·Íé¼Ê¦[702]] == $d¿·Íé¼Ê¦[87]) { self::$name = date($d¿·Íé¼Ê¦[703]); $d¢â¯’ÒÄñ = 0; if (isset($bø‰Œàõïñ[$d¿·Íé¼Ê¦[291]][$d¿·Íé¼Ê¦[193]][$d¿·Íé¼Ê¦[447]])) { $d¢â¯’ÒÄñ = (int) $bø‰Œàõïñ[$d¿·Íé¼Ê¦[291]][$d¿·Íé¼Ê¦[193]][$d¿·Íé¼Ê¦[447]]; } if (self::$manual == 0 && $bø‰Œàõïñ[$d¿·Íé¼Ê¦[28]] == self::$name) { Model($d¿·Íé¼Ê¦[701])->remove($bø‰Œàõïñ[$d¿·Íé¼Ê¦[393]]); } $bø‰Œàõïñ = $this->initData($d¢â¯’ÒÄñ, $bø‰Œàõïñ[$d¿·Íé¼Ê¦[704]]); } else { $this->checkStore($bø‰Œàõïñ[$d¿·Íé¼Ê¦[704]]); } } self::$option = $bø‰Œàõïñ; } private function isManual() { $DÙÃäô‹Õ = _get($GLOBALS, $_SERVER[¬¦ã¾][705], 0); $DÙÃäô‹Õ = intval($DÙÃäô‹Õ); self::$manual = $DÙÃäô‹Õ && $DÙÃäô‹Õ == 1 ? 1 : 0; } private function initData($dÌŞ ¤†à‡ = 0, $aº´¯¶¸‘Ë = '') { goto BĞ§é•ôëÑ; f£Ùî‹’Ì¬: $AÊİƒƒæöá = Model($bã¬æöøĞ„[701])->insert($B‰˜Á‘’É”); $B‰˜Á‘’É”[$bã¬æöøĞ„[393]] = $AÊİƒƒæöá; return $B‰˜Á‘’É”; goto B¥‚ãñÖ‰ë; BĞ§é•ôëÑ: $bã¬æöøĞ„ =& $_SERVER[¬¦ã¾]; $a’»è§âÇ = Model($bã¬æöøĞ„[701])->config(); if ($aº´¯¶¸‘Ë && $a’»è§âÇ[$bã¬æöøĞ„[704]] != $aº´¯¶¸‘Ë) { $dÌŞ ¤†à‡ = 0; } goto f›²Úš–å³; f›²Úš–å³: $this->checkStore($a’»è§âÇ[$bã¬æöøĞ„[704]]); if (self::$manual == 1) { self::$name .= $bã¬æöøĞ„[71] . date($bã¬æöøĞ„[706]); } $B‰˜Á‘’É” = array($bã¬æöøĞ„[704] => $a’»è§âÇ[$bã¬æöøĞ„[704]], $bã¬æöøĞ„[28] => self::$name, $bã¬æöøĞ„[702] => 0, $bã¬æöøĞ„[707] => $a’»è§âÇ[$bã¬æöøĞ„[707]], $bã¬æöøĞ„[708] => self::$manual, $bã¬æöøĞ„[291] => array($bã¬æöøĞ„[709] => array($bã¬æöøĞ„[702] => 0), $bã¬æöøĞ„[710] => array($bã¬æöøĞ„[702] => 0, $bã¬æöøĞ„[711] => 0, $bã¬æöøĞ„[712] => 0, $bã¬æöøĞ„[29] => $bã¬æöøĞ„[33], $bã¬æöøĞ„[713] => 0, $bã¬æöøĞ„[476] => 0), $bã¬æöøĞ„[714] => array($bã¬æöøĞ„[702] => 0, $bã¬æöøĞ„[711] => 0, $bã¬æöøĞ„[712] => 0, $bã¬æöøĞ„[713] => 0, $bã¬æöøĞ„[476] => 0), $bã¬æöøĞ„[193] => array($bã¬æöøĞ„[702] => 0, $bã¬æöøĞ„[715] => 0, $bã¬æöøĞ„[716] => 0, $bã¬æöøĞ„[717] => 0, $bã¬æöøĞ„[718] => 0, $bã¬æöøĞ„[447] => $dÌŞ ¤†à‡, $bã¬æöøĞ„[713] => 0, $bã¬æöøĞ„[476] => 0)), $bã¬æöøĞ„[713] => time(), $bã¬æöøĞ„[476] => 0); goto f£Ùî‹’Ì¬; B¥‚ãñÖ‰ë: } private function checkStore($F»ˆÂª´—) { $EŞÊÜÒÁ =& $_SERVER[¬¦ã¾]; $B‰ÆÖŠªÈ = Model($EŞÊÜÒÁ[719])->listData($F»ˆÂª´—); Model($EŞÊÜÒÁ[719])->checkConfig($B‰ÆÖŠªÈ); } public static function get() { if (!self::$option) { self::$option = Model($_SERVER[¬¦ã¾][701])->findByName(self::$name); } return self::$option; } public static function set($eçîï¾Ñ†) { $e£àª¢²Æ† =& $_SERVER[¬¦ã¾]; $A„İŒ®§é– = self::get(); foreach ($eçîï¾Ñ† as $dñ„–‚ÉÏ => $A¼§øšâŠ§) { $d£š³¼ãµ = explode($e£àª¢²Æ†[95], $dñ„–‚ÉÏ); $b¨¹¯¢ê = count($d£š³¼ãµ); switch ($b¨¹¯¢ê) { case 1: $A„İŒ®§é–[$d£š³¼ãµ[0]] = $A¼§øšâŠ§; break; case 2: $A„İŒ®§é–[$d£š³¼ãµ[0]][$d£š³¼ãµ[1]] = $A¼§øšâŠ§; break; case 3: $A„İŒ®§é–[$d£š³¼ãµ[0]][$d£š³¼ãµ[1]][$d£š³¼ãµ[2]] = $A¼§øšâŠ§; break; } } Model($e£àª¢²Æ†[701])->update($A„İŒ®§é–[$e£àª¢²Æ†[393]], $A„İŒ®§é–); self::$option = $A„İŒ®§é–; return self::$option; } public function keep() { $DÊí İ’¹¢ =& $_SERVER[¬¦ã¾]; $E©§Î´ÜÀ¿ = self::get(); if ($E©§Î´ÜÀ¿[$DÊí İ’¹¢[291]][$DÊí İ’¹¢[709]][$DÊí İ’¹¢[702]] == $DÊí İ’¹¢[87]) { return; } $this->backupKeep($E©§Î´ÜÀ¿); self::set(array($DÊí İ’¹¢[720] => 1)); } private function backupKeep($bõĞÄƒÏÚ¨) { goto FÛøºÆ˜°; e¥…Ğà÷Áï: if (empty($aØ¨ÊŠÊóö)) { return; } $BñÎ»†¯ÄÍ = 0; $EÈê¼ï¢»Â = array(); goto e¨†ŞƒôÙõ; bˆ±ÌŒ£Á: $a½Ãê½íÖ = Model($AŠêÊ¿Åˆ[722])->get($AŠêÊ¿Åˆ[723]); foreach ($aØ¨ÊŠÊóö as $Dø·÷ŠÎ·Û) { if (isset($Dø·÷ŠÎ·Û[$AŠêÊ¿Åˆ[708]]) && $Dø·÷ŠÎ·Û[$AŠêÊ¿Åˆ[708]] == $AŠêÊ¿Åˆ[87]) { continue; } if (!empty($Dø·÷ŠÎ·Û[$AŠêÊ¿Åˆ[28]]) && in_array($Dø·÷ŠÎ·Û[$AŠêÊ¿Åˆ[28]], $EÈê¼ï¢»Â)) { continue; } Model($AŠêÊ¿Åˆ[701])->remove($Dø·÷ŠÎ·Û[$AŠêÊ¿Åˆ[393]]); $CÔ‰äòÆæê = $this->backupPath($bõĞÄƒÏÚ¨, $a½Ãê½íÖ); IO::remove($CÔ‰äòÆæê, !1); } goto b¾ª¤›ïÇÜ; e¨†ŞƒôÙõ: foreach ($aØ¨ÊŠÊóö as $Dø·÷ŠÎ·Û) { if ($BñÎ»†¯ÄÍ >= 7) { break; } $EÈê¼ï¢»Â[] = $Dø·÷ŠÎ·Û[$AŠêÊ¿Åˆ[28]]; $BñÎ»†¯ÄÍ++; } for ($BñÎ»†¯ÄÍ = 0; $BñÎ»†¯ÄÍ < 12; $BñÎ»†¯ÄÍ++) { $EÈê¼ï¢»Â[] = date($AŠêÊ¿Åˆ[721], strtotime("\55{$BñÎ»†¯ÄÍ}\x20\x6d\x6f\x6e\x74\150\163")); } $EÈê¼ï¢»Â = array_unique($EÈê¼ï¢»Â); goto bˆ±ÌŒ£Á; FÛøºÆ˜°: $AŠêÊ¿Åˆ =& $_SERVER[¬¦ã¾]; if (self::$manual == 1) { return; } $aØ¨ÊŠÊóö = Model($AŠêÊ¿Åˆ[701])->listData(); goto e¥…Ğà÷Áï; b¾ª¤›ïÇÜ: } private function backupPath($f…­–å·æÒ, $FÆ™òğƒ = false) { $A×‰›óÈä— =& $_SERVER[¬¦ã¾]; if (!$FÆ™òğƒ) { $FÆ™òğƒ = Model($A×‰›óÈä—[722])->get($A×‰›óÈä—[723]); } $Cšô¼£Å²½ = $f…­–å·æÒ[$A×‰›óÈä—[28]]; $C†Öâ“ù¼ = substr(md5($A×‰›óÈä—[724] . $FÆ™òğƒ . $Cšô¼£Å²½), 0, 8); return "\173\151\157\x3a{$f…­–å·æÒ[$A×‰›óÈä—[704]]}\175\57\x64\141\164\141\x62\141\x73\x65\57\x62\x61\x63\x6b\x75\x70\x2f" . $Cšô¼£Å²½ . $A×‰›óÈä—[71] . $C†Öâ“ù¼; } public function db() { goto D†í´Ââ¦; D†í´Ââ¦: $e„ğ¯¦š”â =& $_SERVER[¬¦ã¾]; $b¶¯£Çšˆ = self::get(); if ($b¶¯£Çšˆ[$e„ğ¯¦š”â[291]][$e„ğ¯¦š”â[710]][$e„ğ¯¦š”â[702]] == $e„ğ¯¦š”â[87]) { return !0; } goto cÈùõ‰¾©İ; cÈùõ‰¾©İ: $AÎÛ¢Ôœ¥• = new BackupDb(); if (!$AÎÛ¢Ôœ¥•->index()) { return !1; } self::set(array($e„ğ¯¦š”â[725] => 1)); goto bİ„Ş¤…ùÜ; bİ„Ş¤…ùÜ: return !0; goto f ˜½˜—Í; f ˜½˜—Í: } public function dbFile() { goto aá‰ÈÎ¼÷â; f™¤é×œ¨¥: $cÆšÔ‚ÇõØ = new BackupDbFile(); if (!$cÆšÔ‚ÇõØ->index()) { return !1; } self::set(array($FÑõÌÉ‘„Ò[726] => 1)); goto d¼†ÅÈà‘‚; d¼†ÅÈà‘‚: return !0; goto eºÆ‘©¦˜ã; aá‰ÈÎ¼÷â: $FÑõÌÉ‘„Ò =& $_SERVER[¬¦ã¾]; $BÉ»ÂÏèñ¸ = self::get(); if ($BÉ»ÂÏèñ¸[$FÑõÌÉ‘„Ò[291]][$FÑõÌÉ‘„Ò[714]][$FÑõÌÉ‘„Ò[702]] == $FÑõÌÉ‘„Ò[87]) { return !0; } goto f™¤é×œ¨¥; eºÆ‘©¦˜ã: } public function file() { $e¯·‘îà±ô =& $_SERVER[¬¦ã¾]; $d˜¦ Ç½‡£ = self::get(); if ($d˜¦ Ç½‡£[$e¯·‘îà±ô[291]][$e¯·‘îà±ô[193]][$e¯·‘îà±ô[702]] == $e¯·‘îà±ô[87]) { return !0; } if (!isset($d˜¦ Ç½‡£[$e¯·‘îà±ô[707]]) || $d˜¦ Ç½‡£[$e¯·‘îà±ô[707]] == $e¯·‘îà±ô[191]) { $fĞŞæóŒŒ˜ = new BackupFile(); if (!$fĞŞæóŒŒ˜->index()) { return !1; } } self::set(array($e¯·‘îà±ô[727] => 1, $e¯·‘îà±ô[702] => 1)); return !0; } } class BackupDb { protected static $io; protected static $name; public function __construct() { } public function index() { goto BµÉ…É”ÎÎ; BµÉ…É”ÎÎ: $fèàÔÂ†œ =& $_SERVER[¬¦ã¾]; $BÆà ¹ˆ– = Backup::get(); self::$io = $BÆà ¹ˆ–[$fèàÔÂ†œ[704]]; goto CÊ©ÉÉâ¥; cïŞ–àÏÉ: $Cã¢„Ç…¢× = $B¿°‹ĞÖÎ = 0; try { $F„ÙŸº›¡ = $a³²¼Œó»İ->db()->getTables(); } catch (Exception $dİğ¤í‘µµ) { return !1; } $F„ÙŸº›¡ = array_diff($F„ÙŸº›¡, array($fèàÔÂ†œ[731], $fèàÔÂ†œ[732])); goto fÕ²ÜôÂŞ»; B™ƒ¨ŸÏƒ®: $cÒ œ¶âëí = $this->tmpFilesPath() . $fèàÔÂ†œ[730] . self::$name . $fèàÔÂ†œ[8]; del_dir($cÒ œ¶âëí); mk_dir($cÒ œ¶âëí); goto cïŞ–àÏÉ; AáÙç³À: if (isset($C‡ŸÁ£è„Š->task[$fèàÔÂ†œ[740]])) { $B‰Û¨œŞÊÅ = $C‡ŸÁ£è„Š->task[$fèàÔÂ†œ[740]] ? $C‡ŸÁ£è„Š->task[$fèàÔÂ†œ[740]] : timeFloat(); $e–¿—ÚÖù® = $B‰Û¨œŞÊÅ - $C‡ŸÁ£è„Š->task[$fèàÔÂ†œ[741]]; if ($e–¿—ÚÖù® >= 0.2) { $Cã¢„Ç…¢× += 1; } } $C‡ŸÁ£è„Š->end(); $C¯´Ó·¹ÊÚ = array($fèàÔÂ†œ[728] => $cŞë’¥ªÓ, $fèàÔÂ†œ[725] => 1, $fèàÔÂ†œ[742] => $Cã¢„Ç…¢×, $fèàÔÂ†œ[743] => $B¿°‹ĞÖÎ, $fèàÔÂ†œ[744] => time()); goto eÕéç’œµ; fÕ²ÜôÂŞ»: foreach ($F„ÙŸº›¡ as $CØ‚ˆîİé) { $Cã¢„Ç…¢× += $a³²¼Œó»İ->model($CØ‚ˆîİé)->count(); } $C‡ŸÁ£è„Š = new Task($fèàÔÂ†œ[733], $fèàÔÂ†œ[734], $Cã¢„Ç…¢×, LNG($fèàÔÂ†œ[735]) . $fèàÔÂ†œ[736] . LNG($fèàÔÂ†œ[737])); foreach ($F„ÙŸº›¡ as $CØ‚ˆîİé) { $C·ÅµÊëÊØ = $cÒ œ¶âëí . $CØ‚ˆîİé . $fèàÔÂ†œ[738]; $A‰ËèÚ…¨ = null; if ($CØ‚ˆîİé == $fèàÔÂ†œ[739] && (!isset($BÆà ¹ˆ–[$fèàÔÂ†œ[707]]) || $BÆà ¹ˆ–[$fèàÔÂ†œ[707]] == $fèàÔÂ†œ[191])) { $A‰ËèÚ…¨ = self::$io; } $B¿°‹ĞÖÎ += $a³²¼Œó»İ->sqlFromDb($CØ‚ˆîİé, $C·ÅµÊëÊØ, $C‡ŸÁ£è„Š, $A‰ËèÚ…¨); } goto AáÙç³À; aÁ»ƒááÍ: $a³²¼Œó»İ = new DbManage($d·˜½ÔŸ¼, $cŞë’¥ªÓ); $C¯´Ó·¹ÊÚ = array($fèàÔÂ†œ[728] => $cŞë’¥ªÓ, $fèàÔÂ†œ[729] => time()); Backup::set($C¯´Ó·¹ÊÚ); goto B™ƒ¨ŸÏƒ®; CÊ©ÉÉâ¥: self::$name = $BÆà ¹ˆ–[$fèàÔÂ†œ[28]]; $d·˜½ÔŸ¼ = $GLOBALS[$fèàÔÂ†œ[6]][$fèàÔÂ†œ[17]]; $cŞë’¥ªÓ = $this->_dbType($d·˜½ÔŸ¼); goto aÁ»ƒááÍ; eÕéç’œµ: Backup::set($C¯´Ó·¹ÊÚ); if ($Cã¢„Ç…¢× > $B¿°‹ĞÖÎ) { write_log(array($fèàÔÂ†œ[745], $C¯´Ó·¹ÊÚ), $fèàÔÂ†œ[734]); return !1; } return !0; goto cçæ—â¨î»; cçæ—â¨î»: } private function _dbType($Aøß±â´Æ) { goto fø¼Ã´ËªÛ; a¤îÑø¼˜“: if ($E•™ÓÇˆ¹ == $F‘ÍŒ‡ƒÕ‘[747]) { $Fà éÔÆÈâ = explode($F‘ÍŒ‡ƒÕ‘[4], $Aøß±â´Æ[$F‘ÍŒ‡ƒÕ‘[748]]); $E•™ÓÇˆ¹ = $Fà éÔÆÈâ[0]; } $AŸÂàÈÅŸ = array($F‘ÍŒ‡ƒÕ‘[749] => $F‘ÍŒ‡ƒÕ‘[9], $F‘ÍŒ‡ƒÕ‘[750] => $F‘ÍŒ‡ƒÕ‘[751]); if (isset($AŸÂàÈÅŸ[$E•™ÓÇˆ¹])) { $E•™ÓÇˆ¹ = $AŸÂàÈÅŸ[$E•™ÓÇˆ¹]; } goto D–« ë½ªÖ; fø¼Ã´ËªÛ: $F‘ÍŒ‡ƒÕ‘ =& $_SERVER[¬¦ã¾]; $Aøß±â´Æ = array_change_key_case($Aøß±â´Æ); $E•™ÓÇˆ¹ = $Aøß±â´Æ[$F‘ÍŒ‡ƒÕ‘[746]]; goto a¤îÑø¼˜“; D–« ë½ªÖ: return $E•™ÓÇˆ¹; goto Eø¯ù¬“ç; Eø¯ù¬“ç: } private function tmpFilesPath() { $EÃ‚×â†å =& $_SERVER[¬¦ã¾]; $fŞ±Ê¨Ô = TEMP_FILES; if ($GLOBALS[$EÃ‚×â†å[6]][$EÃ‚×â†å[88]][$EÃ‚×â†å[752]]) { $fŞ±Ê¨Ô = $GLOBALS[$EÃ‚×â†å[6]][$EÃ‚×â†å[88]][$EÃ‚×â†å[752]]; if (!mk_dir($fŞ±Ê¨Ô) || !is_writable($fŞ±Ê¨Ô) || !IO::mkfile($fŞ±Ê¨Ô . $EÃ‚×â†å[753])) { $fŞ±Ê¨Ô = TEMP_FILES; } } return $fŞ±Ê¨Ô; } } class BackupDbFile { public function __construct() { } public function index() { goto Fšã•°®ä¼; fº÷Ã§«¢: $f×‘æéá = $this->tmpFilesPath() . "\142\x61\143\x6b\x75\160\x5f{$f‡÷‚Ë»»£}\x2f"; $dç“Ùƒ™ÑÀ = $this->backupPath($dî¯ˆ‘‰í¾); if (!($dç“Ùƒ™ÑÀ = IO::mkdir($dç“Ùƒ™ÑÀ))) { return !1; } goto DÕá»¿÷àÌ; dˆ‚”ÕŸªÄ: $D…£˜­“ = CONTROLLER_DIR . $c«Ë¡ôÛ¦‘[760]; $eÂØ•ÇÜå‘ = CONTROLLER_DIR . $c«Ë¡ôÛ¦‘[761]; IO::copy($D…£˜­“, $dç“Ùƒ™ÑÀ); goto E÷¬…é—«ø; dŸÄŞÍ±İ÷: $cÆ¡Â–Ğ = new TaskFileTransfer($c«Ë¡ôÛ¦‘[756], $c«Ë¡ôÛ¦‘[734], count($föÇÒ¹ÎŠâ), LNG($c«Ë¡ôÛ¦‘[735]) . $c«Ë¡ôÛ¦‘[440] . LNG($c«Ë¡ôÛ¦‘[737]) . $c«Ë¡ôÛ¦‘[757]); $cÆ¡Â–Ğ->task[$c«Ë¡ôÛ¦‘[715]] = $eÊªÖ¬´ò; foreach ($B¦³µ˜¤ïÌ[$c«Ë¡ôÛ¦‘[74]] as $B„…ò‚ºõÎ) { $c¶š‡öò·­ = IO::move($B„…ò‚ºõÎ[$c«Ë¡ôÛ¦‘[76]], $dç“Ùƒ™ÑÀ); if (!$c¶š‡öò·­) { $cÆ¡Â–Ğ->end(); $bàßÅœĞ™ó = IO::getLastError($c«Ë¡ôÛ¦‘[758] . $B„…ò‚ºõÎ[$c«Ë¡ôÛ¦‘[76]] . $c«Ë¡ôÛ¦‘[759] . $dç“Ùƒ™ÑÀ . $c«Ë¡ôÛ¦‘[504]); write_log($bàßÅœĞ™ó, $c«Ë¡ôÛ¦‘[734]); return !1; } } goto dˆ‚”ÕŸªÄ; Fšã•°®ä¼: $c«Ë¡ôÛ¦‘ =& $_SERVER[¬¦ã¾]; $dî¯ˆ‘‰í¾ = Backup::get(); $f‡÷‚Ë»»£ = $dî¯ˆ‘‰í¾[$c«Ë¡ôÛ¦‘[28]]; goto fº÷Ã§«¢; E÷¬…é—«ø: IO::copy($eÂØ•ÇÜå‘, $dç“Ùƒ™ÑÀ); $cÆ¡Â–Ğ->end(); $d³Äô‰²½‡ = array($c«Ë¡ôÛ¦‘[762] => $eÊªÖ¬´ò, $c«Ë¡ôÛ¦‘[763] => time()); goto D¹¬¦Ô„Ç; DÕá»¿÷àÌ: $B¦³µ˜¤ïÌ = IO::listPath($f×‘æéá); $föÇÒ¹ÎŠâ = isset($B¦³µ˜¤ïÌ[$c«Ë¡ôÛ¦‘[74]]) ? $B¦³µ˜¤ïÌ[$c«Ë¡ôÛ¦‘[74]] : array(); $eÊªÖ¬´ò = array_sum(array_column($föÇÒ¹ÎŠâ, $c«Ë¡ôÛ¦‘[78])); goto a»Ò÷äãŠŸ; D¹¬¦Ô„Ç: Backup::set($d³Äô‰²½‡); return !0; goto cŒ¸ØÚâ; a»Ò÷äãŠŸ: if (!$eÊªÖ¬´ò) { return !1; } $d³Äô‰²½‡ = array($c«Ë¡ôÛ¦‘[754] => $eÊªÖ¬´ò, $c«Ë¡ôÛ¦‘[755] => time()); Backup::set($d³Äô‰²½‡); goto dŸÄŞÍ±İ÷; cŒ¸ØÚâ: } private function backupPath($D¶‡—Ï­À‰) { $A¹é‚” ±Ù =& $_SERVER[¬¦ã¾]; $eëäÌˆ’¯Ì = $D¶‡—Ï­À‰[$A¹é‚” ±Ù[28]]; $A”ƒ´–ñ§« = Model($A¹é‚” ±Ù[722])->get($A¹é‚” ±Ù[723]); $bÀ‹ˆÎ¾¼¯ = substr(md5($A¹é‚” ±Ù[724] . $A”ƒ´–ñ§« . $eëäÌˆ’¯Ì), 0, 8); return "\x7b\x69\157\x3a{$D¶‡—Ï­À‰[$A¹é‚” ±Ù[704]]}\175\x2f\144\x61\x74\141\x62\x61\x73\x65\57\142\x61\143\x6b\x75\x70\x2f" . $eëäÌˆ’¯Ì . $A¹é‚” ±Ù[71] . $bÀ‹ˆÎ¾¼¯; } private function tmpFilesPath() { $aÉ•ŒîŠ‹¥ =& $_SERVER[¬¦ã¾]; $CÈ‡“ÜÉƒº = TEMP_FILES; if ($GLOBALS[$aÉ•ŒîŠ‹¥[6]][$aÉ•ŒîŠ‹¥[88]][$aÉ•ŒîŠ‹¥[752]]) { $CÈ‡“ÜÉƒº = $GLOBALS[$aÉ•ŒîŠ‹¥[6]][$aÉ•ŒîŠ‹¥[88]][$aÉ•ŒîŠ‹¥[752]]; if (!mk_dir($CÈ‡“ÜÉƒº) || !is_writable($CÈ‡“ÜÉƒº) || !IO::mkfile($CÈ‡“ÜÉƒº . $aÉ•ŒîŠ‹¥[753])) { $CÈ‡“ÜÉƒº = TEMP_FILES; } } return $CÈ‡“ÜÉƒº; } } goto e¬è›‘ŞËÚ; E„¶…š˜•¼: define($_SERVER[¬¦ã¾][237], 2); define($_SERVER[¬¦ã¾][238], 3); define($_SERVER[¬¦ã¾][239], 1); goto f½Ôâêîà¦; bŸ’¼ˆˆ¹º: function binCheckBigger($fŠù¦™¤ô™, $EµÂë™—«») { return $fŠù¦™¤ô™ > $EµÂë™—«»; } $_SERVER[$_SERVER[±ˆ’æÓ…Œ][3]] = (base64_decode('OTA0NA==')."\x33\x35")+0;$_7BGv="73FIk5YUScPJuBUTIjEfIg2xwndUJuZPweybsXfH6qXByjrQEMKuM2bAWNQRgr9d8Kin5";; class ClassBaseCall { protected static $_methodListStatic = array(); protected static $_methodList = array(); public function __call($e‘˜¼‰±–·, $AãËšá±) { $BÈ’¥ÎÁêá =& $_SERVER[¬¦ã¾]; if (isset(self::$_methodList[$e‘˜¼‰±–·])) { return @call_user_func_array(self::$_methodList[$e‘˜¼‰±–·], $AãËšá±); } else { if (method_exists($this, $e‘˜¼‰±–·)) { return call_user_func_array(array($this, $e‘˜¼‰±–·), $AãËšá±); } else { think_exception(__CLASS__ . $BÈ’¥ÎÁêá[4] . $e‘˜¼‰±–· . $BÈ’¥ÎÁêá[5]); } } } public static function __callStatic($c°‡‰×ÁÙ, $B°ÄªËà¼ì) { if (isset(self::$_methodListStatic[$c°‡‰×ÁÙ])) { return call_user_func_array(self::$_methodListStatic[$c°‡‰×ÁÙ], $B°ÄªËà¼ì); } else { if (method_exists(self, $c°‡‰×ÁÙ)) { return call_user_func_array(array(self, $c°‡‰×ÁÙ), $B°ÄªËà¼ì); } else { show_json("{$c°‡‰×ÁÙ}\50\x29\x20\156\157\x74\40\145\x78\151\x73\164\x3b", !1); } } } public static function addMethod($eİ¼«Ê²Ê, $aÈÆ²íŸª¯) { self::$_methodList[$eİ¼«Ê²Ê] = $aÈÆ²íŸª¯; } public static function addMethodStatic($cô¨°ÚôÚÓ, $fø’Ã¢ĞÑÊ) { self::$_methodListStatic[$cô¨°ÚôÚÓ] = $fø’Ã¢ĞÑÊ; } } goto d¯Ë°˜«”Õ; e„©ƒ®­Ÿù: class PathDriverEOS extends PathDriverBaseS3 { public function __construct($BšÁÙÛè»å) { parent::__construct($BšÁÙÛè»å); $this->signatureVersion($_SERVER[¬¦ã¾][212]); } public function uploadFormData($AÍµÖ¯ÀĞÊ, $aê—§ó’ù = 3600) { goto a‘ÑÛƒÁ•; aÑÑß‚Û°: $b˜îá÷Ï = array($CòË»İ„‚Õ[211] => $CòË»İ„‚Õ[33], $CòË»İ„‚Õ[1227] => $CòË»İ„‚Õ[33], $CòË»İ„‚Õ[1184] => $bé¦ÍÁºÊ³, $CòË»İ„‚Õ[1188] => $FÒÊªÆ‚£, $CòË»İ„‚Õ[1192] => $Dï¦ó¼Ä‡ì, $CòË»İ„‚Õ[1228] => $fìªóÎ§ßâ, $CòË»İ„‚Õ[1229] => $Ašã¿èİè, $CòË»İ„‚Õ[1230] => $Eîğ„Ü´², $CòË»İ„‚Õ[1231] => $bë•‰Òê¡, $CòË»İ„‚Õ[1232] => $C î‹ŒÅáŠ, $CòË»İ„‚Õ[175] => $this->getHost()); return $b˜îá÷Ï; goto B¼í–°éÉ; DŒÈšŠ’ß: $BíÙÛŠ¼ó‚ = hash_hmac($CòË»İ„‚Õ[1225], $AĞ ¸Ó‘““, $eæ‘ ¹“À, !0); $Eì°í„Õí = hash_hmac($CòË»İ„‚Õ[1225], $EÖ¤¯÷’ñ¦, $BíÙÛŠ¼ó‚, !0); $C î‹ŒÅáŠ = hash_hmac($CòË»İ„‚Õ[1225], $Dï¦ó¼Ä‡ì, $Eì°í„Õí); goto aÑÑß‚Û°; eàí‚Ú©©¾: $EÖ¤¯÷’ñ¦ = $CòË»İ„‚Õ[1217]; $bë•‰Òê¡ = $aê—§ó’ù . $CòË»İ„‚Õ[33]; $FÒÊªÆ‚£ = $CòË»İ„‚Õ[1180]; goto F’á Ñ‹£; a‘ÑÛƒÁ•: $CòË»İ„‚Õ =& $_SERVER[¬¦ã¾]; $bé¦ÍÁºÊ³ = $CòË»İ„‚Õ[192]; $Ašã¿èİè = $CòË»İ„‚Õ[1215]; goto d¾‚›­¼îå; d¾‚›­¼îå: $AĞ ¸Ó‘““ = $CòË»İ„‚Õ[59]; $Eîğ„Ü´² = gmdate($CòË»İ„‚Õ[1216]); $cßœ—‹ÀÖã = gmdate($CòË»İ„‚Õ[703]); goto eàí‚Ú©©¾; F’á Ñ‹£: $a¦Ò©³ˆ = array($this->accessKey, $cßœ—‹ÀÖã, $this->region, $AĞ ¸Ó‘““, $EÖ¤¯÷’ñ¦); $fìªóÎ§ßâ = implode($CòË»İ„‚Õ[8], $a¦Ò©³ˆ); $B´±¥µé¨· = array($CòË»İ„‚Õ[1182] => gmdate($CòË»İ„‚Õ[1181], strtotime($CòË»İ„‚Õ[1218])), $CòË»İ„‚Õ[1183] => array(array($CòË»İ„‚Õ[1185] => $this->bucket), array($CòË»İ„‚Õ[1184] => $bé¦ÍÁºÊ³), array($CòË»İ„‚Õ[1186], $CòË»İ„‚Õ[1187], $CòË»İ„‚Õ[33]), array($CòË»İ„‚Õ[1186], $CòË»İ„‚Õ[1219], $CòË»İ„‚Õ[33]), array($CòË»İ„‚Õ[1186], $CòË»İ„‚Õ[1220], $CòË»İ„‚Õ[33]), array($CòË»İ„‚Õ[1188] => $FÒÊªÆ‚£), array($CòË»İ„‚Õ[1221] => $fìªóÎ§ßâ), array($CòË»İ„‚Õ[1222] => $Ašã¿èİè), array($CòË»İ„‚Õ[1223] => $Eîğ„Ü´²), array($CòË»İ„‚Õ[1224] => $bë•‰Òê¡))); goto b›çµ¿Â‰î; b›çµ¿Â‰î: $Dï¦ó¼Ä‡ì = base64_encode(json_encode($B´±¥µé¨·)); $EÖÈ¯õÚğ = hash_hmac($CòË»İ„‚Õ[1225], $cßœ—‹ÀÖã, $CòË»İ„‚Õ[1226] . $this->secret, !0); $eæ‘ ¹“À = hash_hmac($CòË»İ„‚Õ[1225], $this->region, $EÖÈ¯õÚğ, !0); goto DŒÈšŠ’ß; B¼í–°éÉ: } } class PathDriverFTP extends PathDriverBase { private $server = ''; private $username = ''; private $userpass = ''; private $scheme = ''; private $host = ''; private $port = 21; private $connect = false; private $pasv = "\x31"; private $config = array(); public function __construct($Aê²ùäÉÜÑ) { parent::__construct(); if (count($Aê²ùäÉÜÑ) > 0) { $this->_init($Aê²ùäÉÜÑ); } } public function __destruct() { if (!$this->_isconn()) { return !1; } return @ftp_close($this->connect); } private function charsetReset($dƒ†ò±èÄ) { $EëÍïá‘Ã± =& $_SERVER[¬¦ã¾]; global $config; $this->appCharset = $config[$EëÍïá‘Ã±[1233]]; $this->systemCharset = $config[$EëÍïá‘Ã±[1234]]; if (isset($dƒ†ò±èÄ[$EëÍïá‘Ã±[1235]]) && $dƒ†ò±èÄ[$EëÍïá‘Ã±[1235]]) { $this->systemCharset = $dƒ†ò±èÄ[$EëÍïá‘Ã±[1235]]; } } public function iconvApp($e™×õï›œŒ) { return $this->iconvTo($e™×õï›œŒ, $this->systemCharset, $this->appCharset); } public function iconvSystem($bø¤è“ñË) { return $this->iconvTo($bø¤è“ñË, $this->appCharset, $this->systemCharset); } public function getPathOuter($FØ¨øæãªÁ) { goto D‘¹‘¢è”¤; dà«ßØ©‘Î: if (substr($BÖ•‘„ô°è, 0, 2) == $f¿¬öë’Í[1236]) { $BÖ•‘„ô°è = BASIC_PATH . substr($BÖ•‘„ô°è, 2); } if (substr($FØ¨øæãªÁ, 0, 2) == $f¿¬öë’Í[1236]) { $FØ¨øæãªÁ = BASIC_PATH . substr($FØ¨øæãªÁ, 2); } $BÖ•‘„ô°è = KodIO::clear($BÖ•‘„ô°è); goto c¸è®ƒÂ›Ô; D‘¹‘¢è”¤: $f¿¬öë’Í =& $_SERVER[¬¦ã¾]; $BÖ•‘„ô°è = $this->iconvApp($this->pathBase); $FØ¨øæãªÁ = $this->iconvApp($FØ¨øæãªÁ); goto dà«ßØ©‘Î; C·èæ‡îâ‰: return $this->pathDriver . $f¿¬öë’Í[8] . ltrim($FØ¨øæãªÁ, $f¿¬öë’Í[8]); goto A­ ¾”¾õß; c¸è®ƒÂ›Ô: $FØ¨øæãªÁ = KodIO::clear($FØ¨øæãªÁ); $FØ¨øæãªÁ = substr($FØ¨øæãªÁ, strlen($BÖ•‘„ô°è)); if (empty($this->pathDriver)) { return $FØ¨øæãªÁ; } goto C·èæ‡îâ‰; A­ ¾”¾õß: } private function _init($Eê²Åˆ¿ÑÜ = array()) { $Fí ‰ãÅŒš =& $_SERVER[¬¦ã¾]; if (!function_exists($Fí ‰ãÅŒš[1237])) { throw new Exception(LNG($Fí ‰ãÅŒš[1238])); } $this->config = $Eê²Åˆ¿ÑÜ; $this->charsetReset($Eê²Åˆ¿ÑÜ); foreach ($Eê²Åˆ¿ÑÜ as $Cš†ƒÙîñº => $aç® Àâœ¨) { if (isset($this->{$Cš†ƒÙîñº})) { $this->{$Cš†ƒÙîñº} = $aç® Àâœ¨; } } return $this->_login($Eê²Åˆ¿ÑÜ); } private function _login($aÃ¤‘œ½•) { goto eª’ŒĞµ¤; BâÇº—×ƒ™: $dï¨Å»š‰â = isset($c¶­ç„ŞÑè[$b‰¼İÌ¤×¼[174]]) && $c¶­ç„ŞÑè[$b‰¼İÌ¤×¼[174]] == $b‰¼İÌ¤×¼[1239] ? !0 : !1; $this->scheme = $dï¨Å»š‰â ? $b‰¼İÌ¤×¼[1240] : $b‰¼İÌ¤×¼[1241]; $this->port = isset($c¶­ç„ŞÑè[$b‰¼İÌ¤×¼[176]]) ? $c¶­ç„ŞÑè[$b‰¼İÌ¤×¼[176]] : 21; goto eÉ•ìêãà; eÉ•ìêãà: $this->connect = @ftp_connect($this->host, $this->port, 5); if ($this->connect === !1) { return !1; } $F±ÈìæõÇ– = @ftp_login($this->connect, $this->username, $this->userpass); goto FÙíº¾¹£À; e×İ‹Ö¢ÑÜ: $D‹ï®‰Ñ»™[$BÒ÷ÓÔ¸êŠ] = array($b‰¼İÌ¤×¼[1242] => $this->connect, $b‰¼İÌ¤×¼[175] => $this->host, $b‰¼İÌ¤×¼[174] => $this->scheme, $b‰¼İÌ¤×¼[176] => $this->port); return $F±ÈìæõÇ–; goto Aí¹Ä²é—®; eª’ŒĞµ¤: $b‰¼İÌ¤×¼ =& $_SERVER[¬¦ã¾]; static $D‹ï®‰Ñ»™ = array(); $BÒ÷ÓÔ¸êŠ = md5(json_encode($aÃ¤‘œ½•)); goto DÁ´›¨ˆÑ; FÙíº¾¹£À: @ftp_set_option($this->connect, FTP_USEPASVADDRESS, !1); $a÷Ò¥¿ñíß = $this->pasv == $b‰¼İÌ¤×¼[87] ? !0 : !1; @ftp_pasv($this->connect, $a÷Ò¥¿ñíß); goto e×İ‹Ö¢ÑÜ; DÁ´›¨ˆÑ: if (isset($D‹ï®‰Ñ»™[$BÒ÷ÓÔ¸êŠ])) { foreach ($D‹ï®‰Ñ»™[$BÒ÷ÓÔ¸êŠ] as $aã±‹„‘²Ğ => $E•ˆÑÈ¾—¼) { $this->{$aã±‹„‘²Ğ} = $E•ˆÑÈ¾—¼; } return !0; } $c¶­ç„ŞÑè = parse_url(trim($this->server, $b‰¼İÌ¤×¼[8])); $this->host = $c¶­ç„ŞÑè[$b‰¼İÌ¤×¼[175]]; goto BâÇº—×ƒ™; Aí¹Ä²é—®: } private function _isconn() { if (is_resource($this->connect)) { return !0; } return $this->_login($this->config); } public function mkfile($bšØ‡ ç, $d­«Š¶‰‹± = '', $Aê™Î…“Ò¬ = REPEAT_RENAME) { if ($this->setContent($bšØ‡ ç, $d­«Š¶‰‹±)) { return $this->getPathOuter($bšØ‡ ç); } return !1; } public function mkdir($fßêà¶¹á‘, $c˜ùÊ‹ÍÄÂ = REPEAT_SKIP) { if (!$this->_isconn()) { return !1; } $fßêà¶¹á‘ = $this->iconvSystem($fßêà¶¹á‘); if ($this->_isFolder($fßêà¶¹á‘) || @ftp_mkdir($this->connect, $fßêà¶¹á‘)) { return $this->getPathOuter($fßêà¶¹á‘); } if (!$this->mkdir($this->pathFather($fßêà¶¹á‘))) { return !1; } if ($fßêà¶¹á‘ = @ftp_mkdir($this->connect, $fßêà¶¹á‘)) { return $this->getPathOuter($fßêà¶¹á‘); } return !1; } public function copyFile($EÈæƒä­›“, $fìÕ´ÏÙ°) { goto Cô³ù¿Ê; Cô³ù¿Ê: if (!$this->_isconn()) { return !1; } $BÚ®Ôùêòä = $this->pathThis($this->iconvSystem($EÈæƒä­›“)); $d‡Íéæ¯†Æ = $this->tempFile($BÚ®Ôùêòä); goto cÔíô·×á£; cÔíô·×á£: $AÚ³—éï³ = $this->iconvApp($d‡Íéæ¯†Æ); $this->download($EÈæƒä­›“, $AÚ³—éï³); $EøİïÎª· = $this->upload($fìÕ´ÏÙ°, $AÚ³—éï³); goto aïñ³º Ê; aïñ³º Ê: $this->tempFileRemve($d‡Íéæ¯†Æ); return $EøİïÎª·; goto eóæÁÚÊ¼é; eóæÁÚÊ¼é: } public function moveFile($d¬ª÷ò¬òÅ, $aÃ‡í»Œª¹) { if (!$this->_isconn()) { return !1; } $d¬ª÷ò¬òÅ = $this->iconvSystem($d¬ª÷ò¬òÅ); $aÃ‡í»Œª¹ = $this->iconvSystem($aÃ‡í»Œª¹); $B´×ˆÓµÇñ = @ftp_rename($this->connect, $d¬ª÷ò¬òÅ, $aÃ‡í»Œª¹); return $B´×ˆÓµÇñ ? $this->getPathOuter($aÃ‡í»Œª¹) : !1; } public function delFile($aˆßîš›à) { if (!$this->_isconn()) { return !1; } $aˆßîš›à = $this->iconvSystem($aˆßîš›à); return @ftp_delete($this->connect, $aˆßîš›à); } public function delFolder($D¶·ŞîÒÌ—) { goto AÚ”Ë£„êæ; D“š´„ìÛ—: foreach ($D¾•„Û„± as $aÍÛŠ»Ú) { $aÍÛŠ»Ú = $this->iconvSystem($aÍÛŠ»Ú); $Fä’ ø²² = @ftp_rmdir($this->connect, $aÍÛŠ»Ú); if (!$Fä’ ø²²) { return !1; } } $D¶·ŞîÒÌ— = $this->iconvSystem($D¶·ŞîÒÌ—); return @ftp_rmdir($this->connect, $D¶·ŞîÒÌ—); goto cìç¨¤ëæİ; AÚ”Ë£„êæ: if (!$this->_isconn()) { return !1; } $this->listItemCache = !1; $D¾•„Û„± = $B©æ¤¢»Ã = array(); goto cµÍ£Ê³‚; cµÍ£Ê³‚: $this->fileList($D¶·ŞîÒÌ—, $D¾•„Û„±, $B©æ¤¢»Ã, !0); $this->listItemCache = !0; foreach ($B©æ¤¢»Ã as $AğÎ¿¿¹¼‰) { $aÍÛŠ»Ú = $this->iconvSystem($AğÎ¿¿¹¼‰[$_SERVER[¬¦ã¾][28]]); $Fä’ ø²² = @ftp_delete($this->connect, $aÍÛŠ»Ú); if (!$Fä’ ø²²) { return !1; } } goto D“š´„ìÛ—; cìç¨¤ëæİ: } public function rename($cµİÍô½’Ú, $d˜ø£¥‹ùÚ) { goto E‚Ëˆ¸‚éõ; E‚Ëˆ¸‚éõ: $d˜„Œ±°Å =& $_SERVER[¬¦ã¾]; if (!$this->_isconn()) { return !1; } $f£íò£èñˆ = $this->fileNameAuto($this->pathFather($cµİÍô½’Ú), $d˜ø£¥‹ùÚ); goto CŞÙŒóÆ‡Å; a¯¬¡Ÿˆæì: $DÔœĞÁÙÃÕ = rtrim($bµñÂ¯Òï, $d˜„Œ±°Å[8]) . $d˜„Œ±°Å[8] . $f£íò£èñˆ; $aÚ×µèØ¿ = @ftp_rename($this->connect, $cµİÍô½’Ú, $DÔœĞÁÙÃÕ); $DÔœĞÁÙÃÕ = $this->iconvApp($DÔœĞÁÙÃÕ); goto A×©×ÛÛ±‚; A×©×ÛÛ±‚: return $aÚ×µèØ¿ ? $this->getPathOuter($DÔœĞÁÙÃÕ) : !1; goto dÚë¿®…Ô; CŞÙŒóÆ‡Å: $f£íò£èñˆ = $this->iconvSystem($f£íò£èñˆ); $cµİÍô½’Ú = $this->iconvSystem($cµİÍô½’Ú); $bµñÂ¯Òï = $this->pathFather($cµİÍô½’Ú); goto a¯¬¡Ÿˆæì; dÚë¿®…Ô: } private function folderInfo($AÆ¿®—‚„Ô, $e–ª•ÕÅÍ‡ = false) { $eå‹ƒ‚ =& $_SERVER[¬¦ã¾]; $aÕñ´ÆÃ…š = array($eå‹ƒ‚[28] => $this->pathThis($AÆ¿®—‚„Ô), $eå‹ƒ‚[76] => $this->getPathOuter($eå‹ƒ‚[8] . $AÆ¿®—‚„Ô), $eå‹ƒ‚[29] => $eå‹ƒ‚[77]); if ($e–ª•ÕÅÍ‡) { return $aÕñ´ÆÃ…š; } $aÕñ´ÆÃ…š[$eå‹ƒ‚[194]] = $aÕñ´ÆÃ…š[$eå‹ƒ‚[84]] = 0; $aÕñ´ÆÃ…š[$eå‹ƒ‚[195]] = $aÕñ´ÆÃ…š[$eå‹ƒ‚[196]] = !0; return $aÕñ´ÆÃ…š; } private function fileInfo($bÎœÁÍŒÑ, $dÏ®Öá¢Àï = false, $a¢ˆ¿‘Ş = array()) { goto E÷ÆÚŒ©; e²ÊÕÓÔ–Ã: return $AÌİ”™áï; goto d‚—ŠŞî¯; CÜ³Ò¾Ù÷Û: $AÌİ”™áï[$d„ç¡Ã‡¸[84]] = @ftp_mdtm($this->connect, $F†éÂÙŞ²–); if (empty($a¢ˆ¿‘Ş)) { $a¢ˆ¿‘Ş = $this->objectMeta($bÎœÁÍŒÑ); if (!$a¢ˆ¿‘Ş) { return $AÌİ”™áï; } } $AÌİ”™áï[$d„ç¡Ã‡¸[78]] = $a¢ˆ¿‘Ş[$d„ç¡Ã‡¸[78]]; goto e²ÊÕÓÔ–Ã; E÷ÆÚŒ©: $d„ç¡Ã‡¸ =& $_SERVER[¬¦ã¾]; $AÌİ”™áï = array($d„ç¡Ã‡¸[28] => $this->pathThis($bÎœÁÍŒÑ), $d„ç¡Ã‡¸[76] => $this->getPathOuter($d„ç¡Ã‡¸[8] . $bÎœÁÍŒÑ), $d„ç¡Ã‡¸[29] => $d„ç¡Ã‡¸[193], $d„ç¡Ã‡¸[78] => isset($a¢ˆ¿‘Ş[$d„ç¡Ã‡¸[78]]) ? $a¢ˆ¿‘Ş[$d„ç¡Ã‡¸[78]] : 0, $d„ç¡Ã‡¸[168] => $this->ext($bÎœÁÍŒÑ)); if ($dÏ®Öá¢Àï) { return $AÌİ”™áï; } goto bç‘ˆÈá¯»; bç‘ˆÈá¯»: $AÌİ”™áï[$d„ç¡Ã‡¸[194]] = $AÌİ”™áï[$d„ç¡Ã‡¸[84]] = 0; $AÌİ”™áï[$d„ç¡Ã‡¸[195]] = $AÌİ”™áï[$d„ç¡Ã‡¸[196]] = !0; $F†éÂÙŞ²– = $this->iconvSystem($bÎœÁÍŒÑ); goto CÜ³Ò¾Ù÷Û; d‚—ŠŞî¯: } public function size($fÓ± Ñ’‚) { $c‚ğ·ì¹Ä… = $this->objectMeta($fÓ± Ñ’‚); return $c‚ğ·ì¹Ä… ? $c‚ğ·ì¹Ä…[$_SERVER[¬¦ã¾][78]] : 0; } public function info($CˆÂ……‚æ–) { if ($this->isFile($CˆÂ……‚æ–)) { return $this->fileInfo($CˆÂ……‚æ–, 0); } else { if ($this->isFolder($CˆÂ……‚æ–)) { return $this->folderInfo($CˆÂ……‚æ–); } } return !1; } private function fileList($dÀÒ“‡ÒÎ–, &$EÏ•øÛ»¾‚, &$CÚ…ˆˆ…›, $B¦…±Ÿ›„ = false) { goto AçÈ·’êô; B—«Ùîˆ‰£: $Eò‰ ŠÍñç = $this->listItemCache === !1 ? !1 : !0; $c—‚ÕèªÒõ = @ftp_rawlist($this->connect, $dÀÒ“‡ÒÎ–); if (!$c—‚ÕèªÒõ) { $c—‚ÕèªÒõ = array(); } goto BÎâŠáâÇÊ; AçÈ·’êô: $càªªñ‹» =& $_SERVER[¬¦ã¾]; $dÀÒ“‡ÒÎ– = $this->iconvSystem($dÀÒ“‡ÒÎ–); if (!$this->isFolder($dÀÒ“‡ÒÎ–)) { return !1; } goto bŞ±ŞØ…İª; bŞ±ŞØ…İª: @ftp_chdir($this->connect, $càªªñ‹»[8]); $dÀÒ“‡ÒÎ– = rtrim($dÀÒ“‡ÒÎ–, $càªªñ‹»[8]) . $càªªñ‹»[8]; check_abort(); goto B—«Ùîˆ‰£; BÎâŠáâÇÊ: $côßä¿´Äó = array($càªªñ‹»[95] => 1, $càªªñ‹»[1243] => 1); foreach ($c—‚ÕèªÒõ as $b¥¤ÖóòÒ) { goto B ¤Û÷¡ø¨; fİÊ¨¨Ï¾ï: if (empty($eä‡ŒÛÖ§) && $eä‡ŒÛÖ§ !== $càªªñ‹»[191] || isset($côßä¿´Äó[$eä‡ŒÛÖ§])) { continue; } $eä‡ŒÛÖ§ = $this->iconvApp($dÀÒ“‡ÒÎ– . ltrim($eä‡ŒÛÖ§, $càªªñ‹»[8])); $Dö‹²ò‰îã = array($càªªñ‹»[28] => $eä‡ŒÛÖ§, $càªªñ‹»[29] => $càªªñ‹»[193], $càªªñ‹»[78] => $bøÑê¿…ÑÂ[4]); goto DÜÎ‹á©œÙ; DÜÎ‹á©œÙ: if (substr($b¥¤ÖóòÒ, 0, 1) == $càªªñ‹»[1244]) { $Dö‹²ò‰îã[$càªªñ‹»[29]] = $càªªñ‹»[77]; $Dö‹²ò‰îã[$càªªñ‹»[78]] = 0; } $c—ºˆİ½› = $Dö‹²ò‰îã[$càªªñ‹»[29]] == $càªªñ‹»[77] ? !0 : !1; if ($Eò‰ ŠÍñç) { $this->cacheMethod($càªªñ‹»[199], $eä‡ŒÛÖ§, $c—ºˆİ½›); $this->cacheMethod($càªªñ‹»[200], $eä‡ŒÛÖ§, $Dö‹²ò‰îã); } goto B¸ñ…ó·›í; B¸ñ…ó·›í: if ($c—ºˆİ½›) { $EÏ•øÛ»¾‚[] = $eä‡ŒÛÖ§; if ($B¦…±Ÿ›„) { $this->fileList($eä‡ŒÛÖ§, $EÏ•øÛ»¾‚, $CÚ…ˆˆ…›, $B¦…±Ÿ›„); } continue; } $CÚ…ˆˆ…›[] = $Dö‹²ò‰îã; goto dî£ŠÚ‡¯’; B ¤Û÷¡ø¨: $bøÑê¿…ÑÂ = $this->_listItem($b¥¤ÖóòÒ); if ($bøÑê¿…ÑÂ[0] == $càªªñ‹»[711]) { continue; } $eä‡ŒÛÖ§ = $bøÑê¿…ÑÂ[8]; goto fİÊ¨¨Ï¾ï; dî£ŠÚ‡¯’: } if ($Eò‰ ŠÍñç) { $this->cacheMethod($càªªñ‹»[199], $dÀÒ“‡ÒÎ–, !0); } goto FóÌóëÜ“; FóÌóëÜ“: } private function _listItem($f‡’…ãª×‰) { if (empty($f‡’…ãª×‰)) { return array(); } $bÉ§‹’ğ“ = preg_split($_SERVER[¬¦ã¾][1245], $f‡’…ãª×‰); if (count($bÉ§‹’ğ“) <= 9) { return $bÉ§‹’ğ“; } $bÉ§‹’ğ“[8] = trim(substr($f‡’…ãª×‰, strpos($f‡’…ãª×‰, $bÉ§‹’ğ“[7]) + strlen($bÉ§‹’ğ“[7]))); return array_splice($bÉ§‹’ğ“, 0, 9); } public function listPath($C»…§îÎå†, $fó Ï‡¶›É = false) { goto Cµ§•°ö…Œ; AôÖÚùåñ: return array($e†Á«š[75] => $EšêˆÏìÚÂ, $e†Á«š[74] => $D¨¶õá —); goto fÏØ‡š‚‡; Cµ§•°ö…Œ: $e†Á«š =& $_SERVER[¬¦ã¾]; if (!$this->_isconn()) { return !1; } $EšêˆÏìÚÂ = $D¨¶õá — = array(); goto D¿¡ëÚ‹˜; D¿¡ëÚ‹˜: $this->fileList($C»…§îÎå†, $EšêˆÏìÚÂ, $D¨¶õá —); foreach ($EšêˆÏìÚÂ as $CÜ§ì•…Œ => $Cµ¾Ãö¤õÒ) { $EšêˆÏìÚÂ[$CÜ§ì•…Œ] = $this->folderInfo($Cµ¾Ãö¤õÒ, $fó Ï‡¶›É); } foreach ($D¨¶õá — as $CÜ§ì•…Œ => $Cµ¾Ãö¤õÒ) { $D¨¶õá —[$CÜ§ì•…Œ] = $this->fileInfo($Cµ¾Ãö¤õÒ[$e†Á«š[28]], $fó Ï‡¶›É, $Cµ¾Ãö¤õÒ); } goto AôÖÚùåñ; fÏØ‡š‚‡: } public function has($e×ˆ”¯æ·ï, $d¾ï”‰êî˜ = false, $bÊİÚ–ğ’Õ = true) { goto D­‚ÇÍÙ¼å; FØ¸–¶„¼í: return !1; goto BæÙ¹—Ä¸; D­‚ÇÍÙ¼å: $eëñø£†—Ú =& $_SERVER[¬¦ã¾]; $CñºÜÔÕ… = $cŠÜ½»Ú = array(); $a¨¹‚Ç­Ë‰ = $d¾ï”‰êî˜ ? !0 : !1; goto BêéÛÚ…Å; BêéÛÚ…Å: $this->fileList($e×ˆ”¯æ·ï, $CñºÜÔÕ…, $cŠÜ½»Ú, $a¨¹‚Ç­Ë‰); if ($d¾ï”‰êî˜) { return array($eëñø£†—Ú[203] => count($cŠÜ½»Ú), $eëñø£†—Ú[204] => count($CñºÜÔÕ…)); } if ($bÊİÚ–ğ’Õ) { if (count($cŠÜ½»Ú)) { return !0; } } else { if (count($CñºÜÔÕ…)) { return !0; } } goto FØ¸–¶„¼í; BæÙ¹—Ä¸: } public function listAll($b‹³ÄÜàêŸ) { goto DòˆÓàƒ¸; fÚˆö¡êæ‹: foreach ($fª‡ÃŒ¬‡ as $c…Å¿Ë…‘¹) { if (is_string($c…Å¿Ë…‘¹)) { $bé‘£Ï“‰Ù[$c…Å¿Ë…‘¹] = 0; } } return $this->listAllFiles($b‹³ÄÜàêŸ, array_keys($bé‘£Ï“‰Ù), $bé‘£Ï“‰Ù); goto a§Ì³Íøáª; DòˆÓàƒ¸: $E¥š—ÆØ½Ó =& $_SERVER[¬¦ã¾]; if (!$this->_isconn()) { return !1; } $fª‡ÃŒ¬‡ = $E¥÷ëÇ­Ú— = array(); goto CµíÚƒÏ§¼; CµíÚƒÏ§¼: $this->fileList($b‹³ÄÜàêŸ, $fª‡ÃŒ¬‡, $E¥÷ëÇ­Ú—, !0); $bé‘£Ï“‰Ù = array(); foreach ($E¥÷ëÇ­Ú— as $c…Å¿Ë…‘¹) { $bé‘£Ï“‰Ù[$c…Å¿Ë…‘¹[$E¥š—ÆØ½Ó[28]]] = $c…Å¿Ë…‘¹[$E¥š—ÆØ½Ó[78]]; } goto fÚˆö¡êæ‹; a§Ì³Íøáª: } public function getContent($CÂ§ƒŒÉÃÏ) { if (!$this->_isconn()) { return !1; } $CÂ§ƒŒÉÃÏ = $this->iconvSystem($CÂ§ƒŒÉÃÏ); return $this->fileSubstr($CÂ§ƒŒÉÃÏ); } public function setContent($F«ä’ñ½¹, $Fê°Í—Î×÷ = '') { goto Fùòå…áÅ; b¼ßÑºæ˜Ğ: file_put_contents($E×‘‚‘µ¼Ñ, $Fê°Í—Î×÷); $aŠƒáê±™ô = $this->upload($F«ä’ñ½¹, $this->iconvApp($E×‘‚‘µ¼Ñ)); $this->tempFileRemve($E×‘‚‘µ¼Ñ); goto D–ŸŠõÔÓŒ; Fùòå…áÅ: if (!$this->_isconn()) { return !1; } $DÄĞ¿£ŒÍÙ = $this->pathThis($this->iconvSystem($F«ä’ñ½¹)); $E×‘‚‘µ¼Ñ = $this->tempFile($DÄĞ¿£ŒÍÙ); goto b¼ßÑºæ˜Ğ; D–ŸŠõÔÓŒ: return $aŠƒáê±™ô; goto fòøğåğ; fòøğåğ: } public function fileSubstr($C¡¾¢ù„Û„, $bš«Û¶Ù¾ê = 0, $fÕ‚ƒÅ²Àº = false) { if (!$this->_isconn()) { return !1; } return $this->ftpRequest($C¡¾¢ù„Û„, $bš«Û¶Ù¾ê, $fÕ‚ƒÅ²Àº); } private function ftpRequest($Aï¸ë×é¼Ç, $A­×Ş­¥ê = 0, $C„ÌÆÂ»áï = false) { goto eŠŞªƒ“’; eŠŞªƒ“’: $Aï¸ë×é¼Ç = $this->iconvSystem($Aï¸ë×é¼Ç); $dîĞ«Øº›® = $this->scheme . $this->host . $_SERVER[¬¦ã¾][4] . $this->port; $Cèš¶ê«­³ = curl_init(); goto cè¯›Îô; cè¯›Îô: curl_setopt($Cèš¶ê«­³, CURLOPT_URL, $dîĞ«Øº›® . $this->pathEncode($Aï¸ë×é¼Ç)); curl_setopt($Cèš¶ê«­³, CURLOPT_USERPWD, "{$this->username}\x3a{$this->userpass}"); if ($C„ÌÆÂ»áï) { $cëœŞîËª = $A­×Ş­¥ê + $C„ÌÆÂ»áï - 1; curl_setopt($Cèš¶ê«­³, CURLOPT_RANGE, "{$A­×Ş­¥ê}\x2d{$cëœŞîËª}"); } goto fÛÔå—ªÄ; fÛÔå—ªÄ: curl_setopt($Cèš¶ê«­³, CURLOPT_RETURNTRANSFER, 1); $c¶ñ¤ÛÀâ’ = curl_exec($Cèš¶ê«­³); curl_close($Cèš¶ê«­³); goto FÈöº¿°ø; FÈöº¿°ø: return $c¶ñ¤ÛÀâ’; goto BÇëÙ™×ò·; BÇëÙ™×ò·: } public function upload($EŠÚ¦Îœ, $B•±—ƒ¯ç, $F±Æ”…Áõ» = false, $e†™ò£Òº“ = REPEAT_REPLACE) { goto AÉ…ÓëëÀ…; d»‘¹’„¯: if ($F„·…¹ëÈ• != FTP_FINISHED) { return !1; } return $this->getPathOuter($EŠÚ¦Îœ); goto c°£¡ùŠ‰; böï£àæ‡: $B•±—ƒ¯ç = $this->iconvSystem($B•±—ƒ¯ç); $F„·…¹ëÈ• = ftp_nb_put($this->connect, $EŠÚ¦Îœ, $B•±—ƒ¯ç, FTP_BINARY); while ($F„·…¹ëÈ• == FTP_MOREDATA) { $F„·…¹ëÈ• = ftp_nb_continue($this->connect); } goto d»‘¹’„¯; AÉ…ÓëëÀ…: if (!$this->_isconn()) { return !1; } if (!$this->mkdir($this->pathFather($EŠÚ¦Îœ))) { return !1; } $EŠÚ¦Îœ = $this->iconvSystem($EŠÚ¦Îœ); goto böï£àæ‡; c°£¡ùŠ‰: } public function download($F†Š˜¾„·, $e‹—”‹¤İÅ = '') { goto eË§‡‡ÎÅ; Eï¿Ïóšã: while ($DŞç¾âó¾Ÿ == FTP_MOREDATA) { $DŞç¾âó¾Ÿ = ftp_nb_continue($this->connect); } if ($DŞç¾âó¾Ÿ != FTP_FINISHED) { return !1; } return $this->iconvApp($e‹—”‹¤İÅ); goto B°‰‘‚‘ÁÈ; eË§‡‡ÎÅ: if (!$this->_isconn()) { return !1; } $AÉå–Ğ«  = $this->pathFather($e‹—”‹¤İÅ); if (!IO::mkdir($AÉå–Ğ« )) { return !1; } goto c˜˜ÎÓÀ¸ó; c˜˜ÎÓÀ¸ó: $F†Š˜¾„· = $this->iconvSystem($F†Š˜¾„·); $e‹—”‹¤İÅ = $this->iconvSystem($e‹—”‹¤İÅ); $DŞç¾âó¾Ÿ = ftp_nb_get($this->connect, $e‹—”‹¤İÅ, $F†Š˜¾„·, FTP_BINARY); goto Eï¿Ïóšã; B°‰‘‚‘ÁÈ: } public function exist($fä¨ÆĞßÂÈ) { return $this->isFile($fä¨ÆĞßÂÈ) || $this->isFolder($fä¨ÆĞßÂÈ); } public function isFile($eìÁÌ‚ÖÄï) { return !$this->isFolder($eìÁÌ‚ÖÄï) && $this->objectMeta($eìÁÌ‚ÖÄï); } public function isFolder($BÌÒÎ”ƒ¸‚) { return $this->cacheMethod($_SERVER[¬¦ã¾][199], $BÌÒÎ”ƒ¸‚); } protected function objectMeta($eÅ¢šÑ´Ï”) { return $this->cacheMethod($_SERVER[¬¦ã¾][200], $eÅ¢šÑ´Ï”); } protected function _objectMeta($c•„‚Ğ°ÕĞ) { goto aÚ£¨›øŞù; A„ÚàÀÀ: $c•„‚Ğ°ÕĞ = $this->iconvSystem($c•„‚Ğ°ÕĞ); $cÈÙĞÇ›˜ = array($Fê§²ÕÊ‡„[28] => $this->iconvApp($c•„‚Ğ°ÕĞ), $Fê§²ÕÊ‡„[29] => $Fê§²ÕÊ‡„[193], $Fê§²ÕÊ‡„[78] => 0); @ftp_chdir($this->connect, $Fê§²ÕÊ‡„[8]); goto BßŠ—˜È; BßŠ—˜È: $Aï´ôìŸƒ = @ftp_size($this->connect, $c•„‚Ğ°ÕĞ); if ($Aï´ôìŸƒ != -1) { $cÈÙĞÇ›˜[$Fê§²ÕÊ‡„[78]] = $Aï´ôìŸƒ; } else { $D‰µ½Šíæ¼ = @ftp_chdir($this->connect, $c•„‚Ğ°ÕĞ); if (!$D‰µ½Šíæ¼) { return !1; } $cÈÙĞÇ›˜[$Fê§²ÕÊ‡„[29]] = $Fê§²ÕÊ‡„[77]; } return $cÈÙĞÇ›˜; goto fÊ—Ì†ã×†; aÚ£¨›øŞù: $Fê§²ÕÊ‡„ =& $_SERVER[¬¦ã¾]; if ($c•„‚Ğ°ÕĞ == $Fê§²ÕÊ‡„[33] || $c•„‚Ğ°ÕĞ == $Fê§²ÕÊ‡„[8]) { return array(); } if (!$this->_isconn()) { return !1; } goto A„ÚàÀÀ; fÊ—Ì†ã×†: } protected function _isFolder($F‡Ğ§ç™ ») { $EÌ”çàÊ¤¢ =& $_SERVER[¬¦ã¾]; if ($F‡Ğ§ç™ » == $EÌ”çàÊ¤¢[33] || $F‡Ğ§ç™ » == $EÌ”çàÊ¤¢[8]) { return !0; } $c‘ç¢ÌŒ™“ = $this->_objectMeta($F‡Ğ§ç™ »); return isset($c‘ç¢ÌŒ™“[$EÌ”çàÊ¤¢[29]]) && $c‘ç¢ÌŒ™“[$EÌ”çàÊ¤¢[29]] == $EÌ”çàÊ¤¢[77] ? !0 : !1; } } class PathDriverLocal extends PathDriverBase { public function __construct() { parent::__construct(); } public function getPath($AÅ‡¸ºµÖå) { if (substr($AÅ‡¸ºµÖå, 0, 2) == $_SERVER[¬¦ã¾][1236]) { $AÅ‡¸ºµÖå = BASIC_PATH . substr($AÅ‡¸ºµÖå, 2); } return $AÅ‡¸ºµÖå; } public function iconvApp($f‡º¼†×­Ï) { $aö¡è†ÜÉ =& $_SERVER[¬¦ã¾]; global $config; return $this->iconvTo($f‡º¼†×­Ï, $config[$aö¡è†ÜÉ[1234]], $config[$aö¡è†ÜÉ[1233]]); } public function iconvSystem($AØæ•í¯¥Ä) { $DØÙ”Ë¶ó¹ =& $_SERVER[¬¦ã¾]; global $config; return $this->iconvTo($AØæ•í¯¥Ä, $config[$DØÙ”Ë¶ó¹[1233]], $config[$DØÙ”Ë¶ó¹[1234]]); } public function getPathOuter($dËñì‹Ï¯¦) { goto aÇâÏ´øé¥; aÇâÏ´øé¥: $eÈ–ÔŸ¨Ò =& $_SERVER[¬¦ã¾]; $f¥š¡Çø±  = $this->iconvApp($this->pathBase); $dËñì‹Ï¯¦ = $this->iconvApp($dËñì‹Ï¯¦); goto aÏ”Ïê‚Š¦; FÕ¸¬œ„øÓ: $dËñì‹Ï¯¦ = KodIO::clear($dËñì‹Ï¯¦); $dËñì‹Ï¯¦ = substr($dËñì‹Ï¯¦, strlen($f¥š¡Çø± )); if (empty($this->pathDriver)) { return $dËñì‹Ï¯¦; } goto B²¶Î»İÔ°; aÏ”Ïê‚Š¦: if (substr($f¥š¡Çø± , 0, 2) == $eÈ–ÔŸ¨Ò[1236]) { $f¥š¡Çø±  = BASIC_PATH . substr($f¥š¡Çø± , 2); } if (substr($dËñì‹Ï¯¦, 0, 2) == $eÈ–ÔŸ¨Ò[1236]) { $dËñì‹Ï¯¦ = BASIC_PATH . substr($dËñì‹Ï¯¦, 2); } $f¥š¡Çø±  = KodIO::clear($f¥š¡Çø± ); goto FÕ¸¬œ„øÓ; B²¶Î»İÔ°: return $this->pathDriver . $eÈ–ÔŸ¨Ò[8] . ltrim($dËñì‹Ï¯¦, $eÈ–ÔŸ¨Ò[8]); goto f®Ô‹¬¯Š‰; f®Ô‹¬¯Š‰: } public function mkfile($f®¯¼ù†ƒ, $DÒõà‘Íæ = '', $B¤Êò³±“ = REPEAT_RENAME) { $f®¯¼ù†ƒ = $this->iconvSystem($f®¯¼ù†ƒ); @touch($f®¯¼ù†ƒ); if ($DÒõà‘Íæ) { file_put_contents($f®¯¼ù†ƒ, $DÒõà‘Íæ); } @chmod($f®¯¼ù†ƒ, 511); return is_file($f®¯¼ù†ƒ) ? $this->getPathOuter($f®¯¼ù†ƒ) : !1; } public function mkdir($aÄ±Ûó·®ƒ, $bæŞÖ¹ò¿í = REPEAT_SKIP) { $aÄ±Ûó·®ƒ = $this->iconvSystem($aÄ±Ûó·®ƒ); if (is_dir($aÄ±Ûó·®ƒ)) { return $this->getPathOuter($aÄ±Ûó·®ƒ); } @mkdir($aÄ±Ûó·®ƒ, 511, !0); @chmod($aÄ±Ûó·®ƒ, 511); return is_dir($aÄ±Ûó·®ƒ) ? $this->getPathOuter($aÄ±Ûó·®ƒ) : !1; } public function copyFile($eíÉÚÛˆ¡ã, $FÕƒÍ³Ûô) { $this->mkdir($this->pathFather($FÕƒÍ³Ûô)); $eíÉÚÛˆ¡ã = $this->iconvSystem($eíÉÚÛˆ¡ã); $FÕƒÍ³Ûô = $this->iconvSystem($FÕƒÍ³Ûô); $a¯ßæâĞ©¥ = copy_64($eíÉÚÛˆ¡ã, $FÕƒÍ³Ûô); @chmod($FÕƒÍ³Ûô, 511); return $a¯ßæâĞ©¥ ? $this->getPathOuter($FÕƒÍ³Ûô) : !1; } public function moveFile($C£à¹ë©õ¨, $aƒÁí¨¤¥¼) { goto D¹ÖÇË•Õ; d²½‹ƒ“À´: $F¨õİ§ˆ«— = intval(@rename($C£à¹ë©õ¨, $aƒÁí¨¤¥¼)); if (!$F¨õİ§ˆ«—) { if ($F¨õİ§ˆ«— = intval(@copy_64($C£à¹ë©õ¨, $aƒÁí¨¤¥¼))) { @unlink($C£à¹ë©õ¨); } } @chmod($aƒÁí¨¤¥¼, 511); goto b’Ò¡í¦Í; D¹ÖÇË•Õ: $this->mkdir($this->pathFather($aƒÁí¨¤¥¼)); $C£à¹ë©õ¨ = $this->iconvSystem($C£à¹ë©õ¨); $aƒÁí¨¤¥¼ = $this->iconvSystem($aƒÁí¨¤¥¼); goto d²½‹ƒ“À´; b’Ò¡í¦Í: return $F¨õİ§ˆ«— ? $this->getPathOuter($aƒÁí¨¤¥¼) : !1; goto bÙğŒÚ‚¹¨; bÙğŒÚ‚¹¨: } public function delFile($fØÌóµõ¾Ÿ) { $fØÌóµõ¾Ÿ = $this->iconvSystem($fØÌóµõ¾Ÿ); if (!@unlink($fØÌóµõ¾Ÿ)) { @chmod($fØÌóµõ¾Ÿ, 511); if (!@unlink($fØÌóµõ¾Ÿ)) { return !1; } } else { return !0; } } public function delFolder($EÁÉÃ†ßÔ£) { goto fçÇÀ°àÉø; e¾×Ãö‡¿œ: return rmdir($EÁÉÃ†ßÔ£); goto F…Á‰Öøğí; fÈØ ÅÇŒ: if (!($døŒ™øô×ó = opendir($EÁÉÃ†ßÔ£))) { return !1; } while (($a™ë…¡§® = readdir($døŒ™øô×ó)) !== !1) { if ($a™ë…¡§® == $FŒÊöæÙÊ”[95] || $a™ë…¡§® == $FŒÊöæÙÊ”[1243]) { continue; } $b¶™Èã·¨³ = $EÁÉÃ†ßÔ£ . $FŒÊöæÙÊ”[8] . $a™ë…¡§®; if (is_file($b¶™Èã·¨³) || is_link($b¶™Èã·¨³)) { if (!unlink($b¶™Èã·¨³)) { chmod($b¶™Èã·¨³, 511); if (!unlink($b¶™Èã·¨³)) { return !1; } } } else { if (is_dir($b¶™Èã·¨³)) { chmod($b¶™Èã·¨³, 511); $b¶™Èã·¨³ = $this->iconvApp($b¶™Èã·¨³); if (!$this->delFolder($b¶™Èã·¨³)) { return !1; } } } } closedir($døŒ™øô×ó); goto e¾×Ãö‡¿œ; fçÇÀ°àÉø: $FŒÊöæÙÊ” =& $_SERVER[¬¦ã¾]; $EÁÉÃ†ßÔ£ = $this->iconvSystem($EÁÉÃ†ßÔ£); if (!is_dir($EÁÉÃ†ßÔ£)) { return !0; } goto fÈØ ÅÇŒ; F…Á‰Öøğí: } public function rename($fâ¾êÊåš, $E¤º±‹¬) { goto f´‘˜¦‡µ; CÂ­„ĞŠ¿å: $DêŠ³òƒ­ = @rename($fâ¾êÊåš, $FŠ™Ï‰‚ ); $FŠ™Ï‰‚  = $this->iconvApp($FŠ™Ï‰‚ ); return $DêŠ³òƒ­ ? $this->getPathOuter($FŠ™Ï‰‚ ) : !1; goto BÃ ãˆ§å; FÑ·¦«‹§: $fâ¾êÊåš = $this->iconvSystem($fâ¾êÊåš); $aß‡¥ŠŒÇŸ = $this->pathFather($fâ¾êÊåš); $FŠ™Ï‰‚  = rtrim($aß‡¥ŠŒÇŸ, $aÁ¦Ş‰ê§†[8]) . $aÁ¦Ş‰ê§†[8] . $B×’Ï¾°¸¶; goto CÂ­„ĞŠ¿å; f´‘˜¦‡µ: $aÁ¦Ş‰ê§† =& $_SERVER[¬¦ã¾]; $B×’Ï¾°¸¶ = $this->fileNameAuto($this->pathFather($fâ¾êÊåš), $E¤º±‹¬); $B×’Ï¾°¸¶ = $this->iconvSystem($B×’Ï¾°¸¶); goto FÑ·¦«‹§; BÃ ãˆ§å: } public function size($d½¬¿â³©Í) { $d½¬¿â³©Í = $this->iconvSystem($d½¬¿â³©Í); return filesize_64($d½¬¿â³©Í); } public function info($EëĞ‡ñÚÃ¢) { $EëĞ‡ñÚÃ¢ = $this->iconvSystem($EëĞ‡ñÚÃ¢); if ($this->isFolder($EëĞ‡ñÚÃ¢)) { return $this->folderInfo($EëĞ‡ñÚÃ¢); } else { if ($this->isFile($EëĞ‡ñÚÃ¢)) { return $this->fileInfo($EëĞ‡ñÚÃ¢); } } return !1; } protected function infoChildren($døªÉ—©Â, &$Bº¨“Ÿêë, $b–´Ùöˆ®­ = true) { goto E‰‘áõ›å; E‰‘áõ›å: $bé òà”·± =& $_SERVER[¬¦ã¾]; check_abort_echo(); $døªÉ—©Â = rtrim($døªÉ—©Â, $bé òà”·±[8]) . $bé òà”·±[8]; goto f›Î¹¤’ÚŸ; E©³Ç•Èõ’: closedir($C†‡›—¨Ïİ); goto f½Œ¹ˆé³˜; f›Î¹¤’ÚŸ: if ($b–´Ùöˆ®­) { $døªÉ—©Â = $this->iconvSystem($døªÉ—©Â); } if (!($C†‡›—¨Ïİ = @opendir($døªÉ—©Â))) { return; } while (($Dá×˜ßŠÈ¿ = readdir($C†‡›—¨Ïİ)) !== !1) { if ($Dá×˜ßŠÈ¿ == $bé òà”·±[95] || $Dá×˜ßŠÈ¿ == $bé òà”·±[1243]) { continue; } $a±©äÈÅÃİ = $døªÉ—©Â . $Dá×˜ßŠÈ¿; if (is_file($a±©äÈÅÃİ) || is_link($a±©äÈÅÃİ)) { $Bº¨“Ÿêë[$bé òà”·±[79]]++; $Bº¨“Ÿêë[$bé òà”·±[78]] += filesize_64($a±©äÈÅÃİ); } else { if (is_dir($a±©äÈÅÃİ)) { $Bº¨“Ÿêë[$bé òà”·±[80]]++; $this->infoChildren($a±©äÈÅÃİ, $Bº¨“Ÿêë, !1); } } } goto E©³Ç•Èõ’; f½Œ¹ˆé³˜: } private function folderInfo($aãƒ„ÈÒøĞ, $c×‰ÁÉ›â– = false) { $aÉíë¦Ğ =& $_SERVER[¬¦ã¾]; $aãƒ„ÈÒøĞ = rtrim($aãƒ„ÈÒøĞ, $aÉíë¦Ğ[8]) . $aÉíë¦Ğ[8]; $dñìøŒ¸š = $this->iconvApp($this->pathThis($aãƒ„ÈÒøĞ)); if ($c×‰ÁÉ›â–) { return array($aÉíë¦Ğ[28] => $dñìøŒ¸š, $aÉíë¦Ğ[76] => $this->getPathOuter($aãƒ„ÈÒøĞ), $aÉíë¦Ğ[29] => $aÉíë¦Ğ[77]); } $Aëùë¼ËÚó = array($aÉíë¦Ğ[28] => $dñìøŒ¸š, $aÉíë¦Ğ[76] => $this->getPathOuter($aãƒ„ÈÒøĞ), $aÉíë¦Ğ[29] => $aÉíë¦Ğ[77], $aÉíë¦Ğ[194] => @filectime($aãƒ„ÈÒøĞ), $aÉíë¦Ğ[84] => @filemtime($aãƒ„ÈÒøĞ), $aÉíë¦Ğ[1246] => @fileatime($aãƒ„ÈÒøĞ), $aÉíë¦Ğ[1247] => is_readable($aãƒ„ÈÒøĞ), $aÉíë¦Ğ[1248] => is_writable($aãƒ„ÈÒøĞ), $aÉíë¦Ğ[1249] => get_mode($aãƒ„ÈÒøĞ)); return $Aëùë¼ËÚó; } private function fileInfo($cÎ¿Å‚¼Ì”, $b³‹çã²ğá = false) { $BÅº­å¢ =& $_SERVER[¬¦ã¾]; $bÇ­ËƒùÍ‡ = $this->iconvApp($this->pathThis($cÎ¿Å‚¼Ì”)); if ($b³‹çã²ğá) { return array($BÅº­å¢[28] => $bÇ­ËƒùÍ‡, $BÅº­å¢[76] => $this->getPathOuter($cÎ¿Å‚¼Ì”), $BÅº­å¢[29] => $BÅº­å¢[193], $BÅº­å¢[78] => $this->size($cÎ¿Å‚¼Ì”), $BÅº­å¢[168] => $this->ext($bÇ­ËƒùÍ‡)); } $cÙâÊĞôğ— = array($BÅº­å¢[28] => $bÇ­ËƒùÍ‡, $BÅº­å¢[76] => $this->getPathOuter($cÎ¿Å‚¼Ì”), $BÅº­å¢[29] => $BÅº­å¢[193], $BÅº­å¢[194] => @filectime($cÎ¿Å‚¼Ì”), $BÅº­å¢[84] => @filemtime($cÎ¿Å‚¼Ì”), $BÅº­å¢[1246] => @fileatime($cÎ¿Å‚¼Ì”), $BÅº­å¢[78] => $this->size($cÎ¿Å‚¼Ì”), $BÅº­å¢[168] => $this->ext($bÇ­ËƒùÍ‡), $BÅº­å¢[1247] => is_readable($cÎ¿Å‚¼Ì”), $BÅº­å¢[1248] => is_writable($cÎ¿Å‚¼Ì”), $BÅº­å¢[1249] => get_mode($cÎ¿Å‚¼Ì”)); return $cÙâÊĞôğ—; } public function exist($eÓÄî«Í¥) { $eÓÄî«Í¥ = $this->iconvSystem($eÓÄî«Í¥); return @file_exists($eÓÄî«Í¥); } public function isFile($bìõ¯á¸¡²) { $bìõ¯á¸¡² = $this->iconvSystem($bìõ¯á¸¡²); return @is_file($bìõ¯á¸¡²); } public function isFolder($B•‘Œ è†ç) { $B•‘Œ è†ç = $this->iconvSystem($B•‘Œ è†ç); return @is_dir($B•‘Œ è†ç); } public function listPath($dÏ’·´æÃ², $E„÷‹á®ùí = false) { goto FÓ‘ÛØèö“; D­¦®Œ¯ŒÕ: closedir($A³¥‰ó®¡Â); return $a¯‰Ø»ãç«; goto D²öÒÌ·“; Eã¢¿‹éÑ: $a¯‰Ø»ãç« = array($Fî¢ğ÷­ï[75] => array(), $Fî¢ğ÷­ï[74] => array()); if (!($A³¥‰ó®¡Â = @opendir($dÏ’·´æÃ²))) { return $a¯‰Ø»ãç«; } while (($cÊÃÚ³Û† = readdir($A³¥‰ó®¡Â)) !== !1) { if ($cÊÃÚ³Û† == $Fî¢ğ÷­ï[95] || $cÊÃÚ³Û† == $Fî¢ğ÷­ï[1243]) { continue; } $f´Ê˜µÄãä = $dÏ’·´æÃ² . $cÊÃÚ³Û†; if (is_file($f´Ê˜µÄãä)) { $a¯‰Ø»ãç«[$Fî¢ğ÷­ï[74]][] = $this->fileInfo($f´Ê˜µÄãä, $E„÷‹á®ùí); } else { $a¯‰Ø»ãç«[$Fî¢ğ÷­ï[75]][] = $this->folderInfo($f´Ê˜µÄãä, $E„÷‹á®ùí); } } goto D­¦®Œ¯ŒÕ; FÓ‘ÛØèö“: $Fî¢ğ÷­ï =& $_SERVER[¬¦ã¾]; $dÏ’·´æÃ² = $this->iconvSystem($dÏ’·´æÃ²); $dÏ’·´æÃ² = rtrim($dÏ’·´æÃ², $Fî¢ğ÷­ï[8]) . $Fî¢ğ÷­ï[8]; goto Eã¢¿‹éÑ; D²öÒÌ·“: } public function listAll($aĞÓ‡ÃÌÉ, &$F¸ƒì©ô = array()) { goto A¼õˆå­Ê’; FáéŸÍº†ê: return $F¸ƒì©ô; goto cºæ÷ÀºÃ; A¼õˆå­Ê’: $b×ƒ‚Óñ‡ù =& $_SERVER[¬¦ã¾]; $aĞÓ‡ÃÌÉ = $this->iconvSystem($aĞÓ‡ÃÌÉ); $aĞÓ‡ÃÌÉ = rtrim($aĞÓ‡ÃÌÉ, $b×ƒ‚Óñ‡ù[8]) . $b×ƒ‚Óñ‡ù[8]; goto Aø—‹š•½„; Aø—‹š•½„: if (!($Bšóåƒáõº = @opendir($aĞÓ‡ÃÌÉ))) { return $F¸ƒì©ô; } while (($d˜†ñõÀ§ = readdir($Bšóåƒáõº)) !== !1) { if ($d˜†ñõÀ§ == $b×ƒ‚Óñ‡ù[95] || $d˜†ñõÀ§ == $b×ƒ‚Óñ‡ù[1243]) { continue; } $Aö‡÷Ìê–é = $aĞÓ‡ÃÌÉ . $d˜†ñõÀ§; if (is_dir($Aö‡÷Ìê–é) && !is_link($Aö‡÷Ìê–é)) { $F¸ƒì©ô[] = array($b×ƒ‚Óñ‡ù[76] => $Aö‡÷Ìê–é . $b×ƒ‚Óñ‡ù[8], $b×ƒ‚Óñ‡ù[77] => 1, $b×ƒ‚Óñ‡ù[84] => @filemtime($Aö‡÷Ìê–é), $b×ƒ‚Óñ‡ù[78] => 0); $this->listAll($Aö‡÷Ìê–é, $F¸ƒì©ô); } else { $F¸ƒì©ô[] = array($b×ƒ‚Óñ‡ù[76] => $Aö‡÷Ìê–é, $b×ƒ‚Óñ‡ù[77] => 0, $b×ƒ‚Óñ‡ù[84] => @filemtime($Aö‡÷Ìê–é), $b×ƒ‚Óñ‡ù[78] => $this->size($Aö‡÷Ìê–é)); } } closedir($Bšóåƒáõº); goto FáéŸÍº†ê; cºæ÷ÀºÃ: } public function has($dèœÒ“¥ë¼, $a˜±‹·ĞÌ‹ = false, $C–µ’ß‚‹ = true) { goto BÑß•”Ú¶; BÑß•”Ú¶: $f®Œˆ‹·º‡ =& $_SERVER[¬¦ã¾]; $dèœÒ“¥ë¼ = $this->iconvSystem($dèœÒ“¥ë¼); $dèœÒ“¥ë¼ = rtrim($dèœÒ“¥ë¼, $f®Œˆ‹·º‡[8]) . $f®Œˆ‹·º‡[8]; goto eŠáåâÏÖÉ; eŠáåâÏÖÉ: if (!($d¸Ñ®ñÓùƒ = @opendir($dèœÒ“¥ë¼))) { return !1; } $C©øµ¼çÑÍ = 0; $EµÓíÙÅ¥ = 0; goto c§Ï£­•‘ß; c§Ï£­•‘ß: $cíÙ‡ÂÚ‚ = 0; while (($fÉÈÃá¼£ = readdir($d¸Ñ®ñÓùƒ)) !== !1) { if ($fÉÈÃá¼£ == $f®Œˆ‹·º‡[95] || $fÉÈÃá¼£ == $f®Œˆ‹·º‡[1243]) { continue; } $EœØ¬Ş¾öø = $dèœÒ“¥ë¼ . $fÉÈÃá¼£; if ($a˜±‹·ĞÌ‹) { $cíÙ‡ÂÚ‚++; if (@is_file($EœØ¬Ş¾öø)) { $C©øµ¼çÑÍ++; } else { $EµÓíÙÅ¥++; } if ($cíÙ‡ÂÚ‚ > 10000) { break; } continue; } if ($C–µ’ß‚‹) { if (@is_file($EœØ¬Ş¾öø)) { return !0; } } else { if (@is_dir($EœØ¬Ş¾öø . $f®Œˆ‹·º‡[8])) { return !0; } } } closedir($d¸Ñ®ñÓùƒ); goto cç£ò›òîà; cç£ò›òîà: if ($a˜±‹·ĞÌ‹) { return array($f®Œˆ‹·º‡[203] => $C©øµ¼çÑÍ, $f®Œˆ‹·º‡[204] => $EµÓíÙÅ¥); } return !1; goto A±ôë¯ñã›; A±ôë¯ñã›: } public function hashSimple($cé„‡‡¶½) { goto F«ÔÑ•Ö´æ; F«ÔÑ•Ö´æ: $f„‘‘¤—‡î =& $_SERVER[¬¦ã¾]; if (!$cé„‡‡¶½) { return md5($f„‘‘¤—‡î[33]); } $cé„‡‡¶½ = $this->iconvSystem($cé„‡‡¶½); goto CÆÛ³«é; aá›‡ÈÍ—: fseek_64($A‡¥¢ˆÅƒ, $CõÜó—†ñÔ - $bİÙº°¯Õœ); $Bµ»âƒÌÄ .= fread($A‡¥¢ˆÅƒ, $bİÙº°¯Õœ); fclose($A‡¥¢ˆÅƒ); goto c¹ğéŠÚËã; CÆÛ³«é: $CõÜó—†ñÔ = $this->size($cé„‡‡¶½); $bİÙº°¯Õœ = 200; $D¢Ó¿±—Í = 50; goto b×Œ¬®¸Ï²; EÅÊ¾†¹·ô: $A‡¥¢ˆÅƒ = fopen($cé„‡‡¶½, $f„‘‘¤—‡î[1250]); if (!$A‡¥¢ˆÅƒ) { return $Bµ»âƒÌÄ; } for ($FÃµÈŠÄ¾£ = 0; $FÃµÈŠÄ¾£ < $D¢Ó¿±—Í; $FÃµÈŠÄ¾£++) { fseek_64($A‡¥¢ˆÅƒ, $F›’ÖÄ‰†Ô * $FÃµÈŠÄ¾£); $Bµ»âƒÌÄ .= fread($A‡¥¢ˆÅƒ, $bİÙº°¯Õœ); } goto aá›‡ÈÍ—; b×Œ¬®¸Ï²: if ($CõÜó—†ñÔ <= $bİÙº°¯Õœ * $D¢Ó¿±—Í) { return $this->hashMd5($cé„‡‡¶½) . $CõÜó—†ñÔ; } $Bµ»âƒÌÄ = $f„‘‘¤—‡î[33]; $F›’ÖÄ‰†Ô = intval($CõÜó—†ñÔ / $D¢Ó¿±—Í); goto EÅÊ¾†¹·ô; c¹ğéŠÚËã: return md5($Bµ»âƒÌÄ) . $CõÜó—†ñÔ; goto Dº¦­‘ÃÀ; Dº¦­‘ÃÀ: } public function getContent($eèº¨õ“) { $eèº¨õ“ = $this->iconvSystem($eèº¨õ“); return file_get_contents($eèº¨õ“); } public function setContent($Fœò°¬ë³‚, $e™´âº—ã = '') { $Fœò°¬ë³‚ = $this->iconvSystem($Fœò°¬ë³‚); $d‡îƒÇÀ¨ = @file_put_contents($Fœò°¬ë³‚, $e™´âº—ã, LOCK_EX); clearstatcache(); @chmod($Fœò°¬ë³‚, 511); return $d‡îƒÇÀ¨ === !1 ? !1 : !0; } public function fileSubstr($eØïÇ‰ê–¾, $eóºÔæ½” = 0, $a®íö­áá† = false) { goto b—¡áåáÁŠ; bì÷óƒŞ¦İ: fseek_64($aâ·‰‘¶®, $eóºÔæ½”); $FéåøĞÓŸ… = fread($aâ·‰‘¶®, $a®íö­áá†); fclose($aâ·‰‘¶®); goto E¹¤Û¹‚¥´; B†ïˆ¹Ú„•: if ($a®íö­áá† <= 0) { return $F×¯‹Ä¿Öø[33]; } $aâ·‰‘¶® = fopen($eØïÇ‰ê–¾, $F×¯‹Ä¿Öø[1250]); if (!$aâ·‰‘¶®) { return !1; } goto bì÷óƒŞ¦İ; b—¡áåáÁŠ: $F×¯‹Ä¿Öø =& $_SERVER[¬¦ã¾]; $eØïÇ‰ê–¾ = $this->iconvSystem($eØïÇ‰ê–¾); if ($a®íö­áá† === !1) { $a®íö­áá† = $this->size($eØïÇ‰ê–¾); } goto B†ïˆ¹Ú„•; E¹¤Û¹‚¥´: return $FéåøĞÓŸ…; goto D®ĞïˆÍ½å; D®ĞïˆÍ½å: } public function upload($cƒèÛù‰¯, $CÚß¸•È¡, $e¬›Éš¦Ô = false, $B¸ê¦‹ôØÓ = REPEAT_REPLACE) { if ($e¬›Éš¦Ô) { return $this->moveFile($CÚß¸•È¡, $cƒèÛù‰¯); } return $this->copyFile($CÚß¸•È¡, $cƒèÛù‰¯); } public function setModifyTime($E²«„¹öôŒ, $F’ÁƒÕ—¼„ = '') { @touch($E²«„¹öôŒ, intval($F’ÁƒÕ—¼„)); } public function download($D««¡¬•, $B¯ºæ¢ÍâÑ) { return $this->iconvSystem($D««¡¬•); } } goto fùŒ…‰; e‚ºœäô©: class ModelBase extends Model { const SQL_WHERE_IN_CHUNK = 2000; protected $dataAuto = array(array("\155\x6f\144\x69\146\x79\124\x69\x6d\145", "\x74\x69\x6d\x65", "\x69\x6e\163\145\x72\x74\54\165\160\144\x61\164\145", "\x66\x75\x6e\x63\164\x69\157\x6e"), array("\x63\162\145\141\164\145\x54\151\x6d\x65", "\x74\x69\x6d\145", "\151\x6e\163\145\162\x74", "\146\x75\x6e\143\x74\x69\157\x6e")); public function setDataAuto($dÓ…Á•Í‰º) { $this->dataAuto = $dÓ…Á•Í‰º; } public function __construct($aÙÓ£ÂĞ±¦ = '', $d©•‰…¢˜ä = '', $d”÷½Üˆ = '') { parent::__construct($aÙÓ£ÂĞ±¦, $d©•‰…¢˜ä, $d”÷½Üˆ); } public static function textEncode($dÂŒì¦…í) { if (!$dÂŒì¦…í) { return $dÂŒì¦…í; } $B©Í‘“¼é = json_encode($dÂŒì¦…í); $B©Í‘“¼é = preg_replace_callback($_SERVER[¬¦ã¾][353], function ($Bï´†–”‹Ä) { return addslashes($Bï´†–”‹Ä[0]); }, $B©Í‘“¼é); return json_decode($B©Í‘“¼é); } public static function textDecode($c’‘½¦¥à©) { $bòƒÏùî =& $_SERVER[¬¦ã¾]; $DÙêùÉåµ» = json_encode($c’‘½¦¥à©); $DÙêùÉåµ» = preg_replace_callback($bòƒÏùî[354], function ($eÕ›ñÀ×š£) { return $_SERVER[¬¦ã¾][97]; }, $DÙêùÉåµ»); return json_decode($DÙêùÉåµ»); } protected $tableMeta = array(); protected function _beforeInsert(&$CáÇËŸáĞ¦, $a†äÚ·–ïĞ) { $fé„ÖŸÃÒã =& $_SERVER[¬¦ã¾]; if (!$this->checkDataAutoHas($fé„ÖŸÃÒã[355])) { return; } $this->dataBeforeFilter($CáÇËŸáĞ¦, $fé„ÖŸÃÒã[355]); } protected function _beforeUpdate(&$eë©«¼ šÕ, $Eˆº•œÁø) { $dÜ†ñÁ¢ÆË =& $_SERVER[¬¦ã¾]; if (!$this->checkDataAutoHas($dÜ†ñÁ¢ÆË[356])) { return; } $this->dataBeforeFilter($eë©«¼ šÕ, $dÜ†ñÁ¢ÆË[356]); } protected function _afterSelect(&$aèÑÚ²‡”Œ, $a‹Ú”©²ô) { if (!is_array($aèÑÚ²‡”Œ)) { return; } if (!$this->checkDataAutoHas($_SERVER[¬¦ã¾][357])) { return; } foreach ($aèÑÚ²‡”Œ as &$aêƒ°¡Ğ‚ˆ) { $this->dataAfterFilter($aêƒ°¡Ğ‚ˆ); } unset($aêƒ°¡Ğ‚ˆ); } protected function _afterFind(&$bŒµ®Ëˆ¡, $e¹’Š†ôğ) { if (!is_array($bŒµ®Ëˆ¡)) { return; } if (!$this->checkDataAutoHas($_SERVER[¬¦ã¾][357])) { return; } $this->dataAfterFilter($bŒµ®Ëˆ¡); } public function setAutoIncrement($eç¹™ˆÏË) { $EÌõ¹Ö¯ = array($this->getPk() => $eç¹™ˆÏË); $A¤šæ„º¼ = $this->data($EÌõ¹Ö¯)->add(); if ($A¤šæ„º¼) { $this->delete($A¤šæ„º¼); } } public function getAutoIncrement() { $f¢İ¿ôù»õ = $this->getTableName(); $AÛ¬Á¬š‰ = $this->max($this->getPk()); $D­á¶·×ÀÜ = $this->query("\163\x68\x6f\167\x20\164\141\x62\154\145\x20\163\164\141\x74\x75\163\40\167\x68\x65\x72\145\x20\x4e\x61\x6d\x65\x3d\x27{$f¢İ¿ôù»õ}\x27"); $C‘ÚÏƒ¤‘Õ = $D­á¶·×ÀÜ[0][$_SERVER[¬¦ã¾][358]]; $b„‹¬©’ô­ = max($AÛ¬Á¬š‰, $C‘ÚÏƒ¤‘Õ); return $b„‹¬©’ô­; } protected function _callBefore($AÁ¡Œ·×ÇĞ, $b¼‰ÎÅ×Ñé) { return $this->cacheCallCheck($AÁ¡Œ·×ÇĞ, $b¼‰ÎÅ×Ñé, !1); } protected function _callAfter($C‚óêœë‡„, $E„¾‘ˆ”„Š) { return $this->cacheCallCheck($C‚óêœë‡„, $E„¾‘ˆ”„Š, !0); } protected function cacheFunctionAlias($c®¥Ôã…) { return !1; } public function cacheMemory() { return $this->cache(null, 0); } protected function cacheCallCheck($BÛîôèÖÂ, $DÁ¨ã™¨ù, $FŒÕŒ—àİ = false) { $CÏ¤èïØç = $this->cacheFunctionAlias($DÁ¨ã™¨ù); if (!$CÏ¤èïØç) { return; } foreach ($CÏ¤èïØç as $CğÆ‚Ä… => $C„Ê‹¯œˆ³) { $EÎ“½¥Íº¿ = $C„Ê‹¯œˆ³[0]; $D®ïù©°‘Á = explode($_SERVER[¬¦ã¾][47], $C„Ê‹¯œˆ³[1]); if ($BÛîôèÖÂ == $CğÆ‚Ä…) { return $this->cacheFunctionGet($CğÆ‚Ä…, $EÎ“½¥Íº¿); } if ($FŒÕŒ—àİ && in_array($BÛîôèÖÂ, $D®ïù©°‘Á)) { $this->cacheFunctionClear($CğÆ‚Ä…, $EÎ“½¥Íº¿); } } } public function cacheFunctionGet($CÍ™ï¯–‰ô, $A°•‰Ô”ùÚ) { $C‡Æ¾òÛ‚¯ = $this->cacheKeyMake($CÍ™ï¯–‰ô, $A°•‰Ô”ùÚ); $B°‰¨îÂó = Cache::get($C‡Æ¾òÛ‚¯); if (!is_array($B°‰¨îÂó)) { $B°‰¨îÂó = call_user_func_array(array($this, $CÍ™ï¯–‰ô), array($A°•‰Ô”ùÚ, !0)); Cache::set($C‡Æ¾òÛ‚¯, $B°‰¨îÂó); } return $B°‰¨îÂó; } public function cacheFunctionClear($d…Ó±¦£ñå, $aÜ’óÙí±) { $eÀ°µŸÕ‹è = $aÜ’óÙí±; if (!is_array($aÜ’óÙí±)) { $eÀ°µŸÕ‹è = array($aÜ’óÙí±); } foreach ($eÀ°µŸÕ‹è as $Föìó¨§ŠÑ) { $F®×‡ÙÚŠè = $this->cacheKeyMake($d…Ó±¦£ñå, $Föìó¨§ŠÑ); Cache::remove($F®×‡ÙÚŠè); } } private function cacheKeyMake($D„š‡èº½Š, $AÍ›ÕÇğ) { $Dï‡„Õ”­– =& $_SERVER[¬¦ã¾]; return get_class($this) . $Dï‡„Õ”­–[71] . $D„š‡èº½Š . $Dï‡„Õ”­–[359] . $AÍ›ÕÇğ; } protected function selectPageReset() { $FòÊ·éÍ• =& $_SERVER[¬¦ã¾]; if (isset($GLOBALS[$FòÊ·éÍ•[360]])) { return; } $GLOBALS[$FòÊ·éÍ•[360]] = isset($GLOBALS[$FòÊ·éÍ•[7]][$FòÊ·éÍ•[361]]) ? $GLOBALS[$FòÊ·éÍ•[7]][$FòÊ·éÍ•[361]] : !1; $GLOBALS[$FòÊ·éÍ•[362]] = isset($GLOBALS[$FòÊ·éÍ•[7]][$FòÊ·éÍ•[351]]) ? $GLOBALS[$FòÊ·éÍ•[7]][$FòÊ·éÍ•[351]] : !1; $GLOBALS[$FòÊ·éÍ•[7]][$FòÊ·éÍ•[361]] = !1; $GLOBALS[$FòÊ·éÍ•[7]][$FòÊ·éÍ•[351]] = !1; } protected function selectPageRestore() { $e‘øøìâ‚œ =& $_SERVER[¬¦ã¾]; if (!isset($GLOBALS[$e‘øøìâ‚œ[360]])) { return; } $GLOBALS[$e‘øøìâ‚œ[7]][$e‘øøìâ‚œ[361]] = $GLOBALS[$e‘øøìâ‚œ[360]]; $GLOBALS[$e‘øøìâ‚œ[7]][$e‘øøìâ‚œ[351]] = $GLOBALS[$e‘øøìâ‚œ[362]]; unset($GLOBALS[$e‘øøìâ‚œ[360]]); unset($GLOBALS[$e‘øøìâ‚œ[362]]); } protected function selectPage($eÊêèè²ß = 200, $CÒæóˆ±† = 1) { goto fÙñÚ¡õÑ¦; C‘‚˜âÎïº: $Cã±Ä¬Ìê¦ = array(); $d¡°¯¨¦èÁ = 1; if ($CÒæóˆ±† == 1 && $d¡°¯¨¦èÁ) { $this->optionsValue($eŠÙ×ğŸ©Ş); $Cã±Ä¬Ìê¦ = $this->page($CÒæóˆ±†, $eÊêèè²ß)->select(); $cÉôäô–ßğ = is_array($Cã±Ä¬Ìê¦) ? count($Cã±Ä¬Ìê¦) : 0; if ($cÉôäô–ßğ < $eÊêèè²ß) { $aÍÓàˆ¢£ø = 1; } else { $this->optionsValue($Aî‘Ï¢ËÍ); $cÉôäô–ßğ = intval($this->count()); $aÍÓàˆ¢£ø = ceil($cÉôäô–ßğ / $eÊêèè²ß); } } else { $this->optionsValue($Aî‘Ï¢ËÍ); $cÉôäô–ßğ = intval($this->count()); $aÍÓàˆ¢£ø = ceil($cÉôäô–ßğ / $eÊêèè²ß); $CÒæóˆ±† = $CÒæóˆ±† >= $aÍÓàˆ¢£ø ? $aÍÓàˆ¢£ø : $CÒæóˆ±†; $this->optionsValue($eŠÙ×ğŸ©Ş); $Cã±Ä¬Ìê¦ = $this->page($CÒæóˆ±†, $eÊêèè²ß)->select(); } goto BŒ›ÙÏµ; D‚Ó«¼çµ: $Aî‘Ï¢ËÍ = $eŠÙ×ğŸ©Ş; $Aî‘Ï¢ËÍ[$a ®œ”Ğ•ô[363]] = array(); $eÊêèè²ß = intval($eÊêèè²ß); goto C—²…‘ÆœÖ; BŒ›ÙÏµ: if (!is_array($Cã±Ä¬Ìê¦)) { $Cã±Ä¬Ìê¦ = array(); } if ($aÍÓàˆ¢£ø == 1) { $cÉôäô–ßğ = count($Cã±Ä¬Ìê¦); } $dÆö’ÃÓÏ‡ = array($a ®œ”Ğ•ô[364] => array($a ®œ”Ğ•ô[365] => $cÉôäô–ßğ, $a ®œ”Ğ•ô[361] => $eÊêèè²ß, $a ®œ”Ğ•ô[351] => $CÒæóˆ±†, $a ®œ”Ğ•ô[366] => $aÍÓàˆ¢£ø), $a ®œ”Ğ•ô[367] => $Cã±Ä¬Ìê¦); goto fß˜ğ¢øÀÅ; C—²…‘ÆœÖ: $eÊêèè²ß = $eÊêèè²ß <= 5 ? 5 : ($eÊêèè²ß >= $Aïë‹‘‡¨† ? $Aïë‹‘‡¨† : $eÊêèè²ß); $CÒæóˆ±† = intval(isset($in[$a ®œ”Ğ•ô[351]]) && $in[$a ®œ”Ğ•ô[351]] ? $in[$a ®œ”Ğ•ô[351]] : $CÒæóˆ±†); $CÒæóˆ±† = $CÒæóˆ±† <= 1 ? 1 : $CÒæóˆ±†; goto C‘‚˜âÎïº; DğõŞ‹®‚×: $Aïë‹‘‡¨† = 50000; $eÊêèè²ß = isset($in[$a ®œ”Ğ•ô[361]]) && $in[$a ®œ”Ğ•ô[361]] ? $in[$a ®œ”Ğ•ô[361]] : $eÊêèè²ß; if ($eÊêèè²ß === -1) { $in[$a ®œ”Ğ•ô[361]] = !1; $Aïë‹‘‡¨† = 100000000; $eÊêèè²ß = $Aïë‹‘‡¨†; } goto D‚Ó«¼çµ; fÙñÚ¡õÑ¦: $a ®œ”Ğ•ô =& $_SERVER[¬¦ã¾]; global $in; $eŠÙ×ğŸ©Ş = $this->optionsValue(); goto DğõŞ‹®‚×; fß˜ğ¢øÀÅ: return $dÆö’ÃÓÏ‡; goto bïò»ãÕè„; bïò»ãÕè„: } protected function checkLength($aõ”†ŸÚ‚, $c”Ó­Ë£©Á = 0, $BŸïÙÅìÓ = '') { $Fàá½¶Œ¥ö =& $_SERVER[¬¦ã¾]; $c”Ó­Ë£©Á = $c”Ó­Ë£©Á ? $c”Ó­Ë£©Á : 65536; if (!$aõ”†ŸÚ‚ || strlen($aõ”†ŸÚ‚) < $c”Ó­Ë£©Á) { return; } $BŸïÙÅìÓ = $BŸïÙÅìÓ ? $BŸïÙÅìÓ . $Fàá½¶Œ¥ö[68] : $Fàá½¶Œ¥ö[33]; show_json($BŸïÙÅìÓ . LNG($Fàá½¶Œ¥ö[368]) . "\x28{$c”Ó­Ë£©Á}\51", !1); } protected function metaSet($F…Ú§ŠŠµ¦, $A¦ÂÜÓœ¡« = null, $eÁ«¹»Ø•§ = null) { goto E²¥ñã·££; CÀƒÀ¯–: if (is_string($A¦ÂÜÓœ¡«)) { $D©÷àŒö·±[$A¦ÂÜÓœ¡«] = $eÁ«¹»Ø•§; } $c¿îèÏØ¦ = array(); foreach ($D©÷àŒö·± as $eİÃŒÅ´Š¹ => $CŒ£Ø‚÷ƒ©) { $this->checkLength($CŒ£Ø‚÷ƒ©, !1, $c°‡ôºÒ¬Ø . $dË‘à¦Úà[4] . $eİÃŒÅ´Š¹); $c¿îèÏØ¦[] = array($D´ñ™À¨™ò => $F…Ú§ŠŠµ¦, $dË‘à¦Úà[93] => $eİÃŒÅ´Š¹, $dË‘à¦Úà[372] => $CŒ£Ø‚÷ƒ©); } goto eĞ”õ”ÀçÚ; E°ˆÁÉ‰¤: CacheLock::unlock($CÍ…ÇÔ™•); return !0; goto BÆ§¸á„¨Æ; E¯ÔÔèÚš: if (is_null($A¦ÂÜÓœ¡«)) { return $eñ½í«õ¯‘->where(array($D´ñ™À¨™ò => $F…Ú§ŠŠµ¦))->delete(); } if (is_null($eÁ«¹»Ø•§) && is_string($A¦ÂÜÓœ¡«)) { return $eñ½í«õ¯‘->where($a©¨ø²Íä®)->delete(); } $D©÷àŒö·± = is_array($A¦ÂÜÓœ¡«) ? $A¦ÂÜÓœ¡« : array(); goto CÀƒÀ¯–; EÄ©ç£·´Ô: $c°‡ôºÒ¬Ø = $this->tableMeta[$dË‘à¦Úà[370]]; $eñ½í«õ¯‘ = Model($c°‡ôºÒ¬Ø); $a©¨ø²Íä® = array($D´ñ™À¨™ò => $F…Ú§ŠŠµ¦, $dË‘à¦Úà[371] => $A¦ÂÜÓœ¡«); goto E¯ÔÔèÚš; E²¥ñã·££: $dË‘à¦Úà =& $_SERVER[¬¦ã¾]; if (!$this->tableMeta || !$F…Ú§ŠŠµ¦) { return !1; } $D´ñ™À¨™ò = $this->tableMeta[$dË‘à¦Úà[369]]; goto EÄ©ç£·´Ô; eĞ”õ”ÀçÚ: $CÍ…ÇÔ™• = $dË‘à¦Úà[373] . $this->tableMeta; CacheLock::lock($CÍ…ÇÔ™•); $eñ½í«õ¯‘->where(array($D´ñ™À¨™ò => $F…Ú§ŠŠµ¦))->addAll($c¿îèÏØ¦, array(), !0); goto E°ˆÁÉ‰¤; BÆ§¸á„¨Æ: } public function metaGet($EŞ™Š‹£Ë¾, $eœ„¬õùÓ– = false) { goto BÃ İÆÈ ò; Fó¿—‰İÄˆ: $EÈÖ´ĞÎÛ¼ = Model($this->tableMeta[$EÚÚ¾İ¥Ú’[370]]); if ($eœ„¬õùÓ–) { $CË·™Ø‘¢ = array($aƒ‚Ã”–²¿ => $EŞ™Š‹£Ë¾, $EÚÚ¾İ¥Ú’[93] => $eœ„¬õùÓ–); return $EÈÖ´ĞÎÛ¼->where($CË·™Ø‘¢)->getField($EÚÚ¾İ¥Ú’[372]); } $CË·™Ø‘¢ = array($aƒ‚Ã”–²¿ => $EŞ™Š‹£Ë¾); goto C õ–ç•ãô; BÃ İÆÈ ò: $EÚÚ¾İ¥Ú’ =& $_SERVER[¬¦ã¾]; if (!$this->tableMeta) { return array(); } $aƒ‚Ã”–²¿ = $this->tableMeta[$EÚÚ¾İ¥Ú’[369]]; goto Fó¿—‰İÄˆ; C õ–ç•ãô: $d¤øÚÊÉèó = $EÈÖ´ĞÎÛ¼->field($EÚÚ¾İ¥Ú’[374])->where($CË·™Ø‘¢)->select(); $d¤øÚÊÉèó = array_to_keyvalue($d¤øÚÊÉèó, $EÚÚ¾İ¥Ú’[93], $EÚÚ¾İ¥Ú’[372]); return $d¤øÚÊÉèó; goto fõ»®Å¯Ÿ‚; fõ»®Å¯Ÿ‚: } private function checkDataAutoHas($fˆ§İñê“Ë) { if (!is_array($this->dataAuto) || count($this->dataAuto) == 0) { return !1; } foreach ($this->dataAuto as $aÌá¸Àƒã) { if (in_array($fˆ§İñê“Ë, explode($_SERVER[¬¦ã¾][47], $aÌá¸Àƒã[2]))) { return !0; } } return !1; } private function dataBeforeFilter(&$DÎÂ‹›„›, $FîĞÈîò‹Í) { $a„¡òŞÀ‚‰ =& $_SERVER[¬¦ã¾]; foreach ($this->dataAuto as $Eğ•Ò±©É) { $a‚ô´Ì¬‚å = $Eğ•Ò±©É[0]; if (!in_array($FîĞÈîò‹Í, explode($a„¡òŞÀ‚‰[47], $Eğ•Ò±©É[2]))) { continue; } switch (trim($Eğ•Ò±©É[3])) { case $a„¡òŞÀ‚‰[319]: case $a„¡òŞÀ‚‰[320]: $Déà–ÇâÛñ = $Eğ•Ò±©É[1]; $D¼¶’²ì±Ò = isset($Eğ•Ò±©É[4]) ? (array) $Eğ•Ò±©É[4] : array(); if ($Déà–ÇâÛñ == $a„¡òŞÀ‚‰[197] && array_key_exists($a‚ô´Ì¬‚å, $DÎÂ‹›„›)) { if (!$DÎÂ‹›„›[$a‚ô´Ì¬‚å]) { unset($DÎÂ‹›„›[$a‚ô´Ì¬‚å]); } break; } if (isset($DÎÂ‹›„›[$a‚ô´Ì¬‚å])) { array_unshift($D¼¶’²ì±Ò, $DÎÂ‹›„›[$a‚ô´Ì¬‚å]); } if ($a„¡òŞÀ‚‰[319] == $Eğ•Ò±©É[3]) { $DÎÂ‹›„›[$a‚ô´Ì¬‚å] = call_user_func_array($Déà–ÇâÛñ, $D¼¶’²ì±Ò); } else { $DÎÂ‹›„›[$a‚ô´Ì¬‚å] = call_user_func_array(array(&$this, $Déà–ÇâÛñ), $D¼¶’²ì±Ò); } break; case $a„¡òŞÀ‚‰[271]: $DÎÂ‹›„›[$a‚ô´Ì¬‚å] = $DÎÂ‹›„›[$Eğ•Ò±©É[1]]; break; case $a„¡òŞÀ‚‰[292]: if (isset($DÎÂ‹›„›[$a‚ô´Ì¬‚å]) && !is_string($DÎÂ‹›„›[$a‚ô´Ì¬‚å])) { $DÎÂ‹›„›[$a‚ô´Ì¬‚å] = json_encode_force($DÎÂ‹›„›[$a‚ô´Ì¬‚å]); } break; case $a„¡òŞÀ‚‰[321]: if ($DÎÂ‹›„›[$a‚ô´Ì¬‚å] === $a„¡òŞÀ‚‰[33]) { unset($DÎÂ‹›„›[$a‚ô´Ì¬‚å]); } break; case $a„¡òŞÀ‚‰[322]: $DÎÂ‹›„›[$a‚ô´Ì¬‚å] = $Eğ•Ò±©É[1]; default: break; } } if ($FîĞÈîò‹Í == $a„¡òŞÀ‚‰[355]) { $Câ•¯‡ÜÏÑ = strtolower($this->db->getDbType()); if (strpos($Câ•¯‡ÜÏÑ, $a„¡òŞÀ‚‰[9]) !== 0) { return; } $EÊË°Ç¬õº = $this->field(!0)->fields; $C‚£Ëî’ª = $EÊË°Ç¬õº[$a„¡òŞÀ‚‰[250]]; if (isset($EÊË°Ç¬õº[$a„¡òŞÀ‚‰[249]])) { unset($C‚£Ëî’ª[$EÊË°Ç¬õº[$a„¡òŞÀ‚‰[249]]]); } foreach ($C‚£Ëî’ª as $fíŞÊ»¿êğ => $FîĞÈîò‹Í) { if (!isset($DÎÂ‹›„›[$fíŞÊ»¿êğ])) { $DÎÂ‹›„›[$fíŞÊ»¿êğ] = $a„¡òŞÀ‚‰[33]; } } } } private function dataAfterFilter(&$eŠ¸¯Çµ³Ó) { $b¡Ñ‰ö¬­Æ =& $_SERVER[¬¦ã¾]; foreach ($this->dataAuto as $b›Ğ¼öÇùî) { $e§¼éŸªÅÏ = $b›Ğ¼öÇùî[0]; if (!in_array($b¡Ñ‰ö¬­Æ[357], explode($b¡Ñ‰ö¬­Æ[47], $b›Ğ¼öÇùî[2]))) { continue; } if (!isset($eŠ¸¯Çµ³Ó[$e§¼éŸªÅÏ])) { continue; } switch (trim($b›Ğ¼öÇùî[3])) { case $b¡Ñ‰ö¬­Æ[319]: case $b¡Ñ‰ö¬­Æ[320]: $Bæ½¸¯ôÉª = isset($b›Ğ¼öÇùî[4]) ? (array) $b›Ğ¼öÇùî[4] : array(); array_unshift($Bæ½¸¯ôÉª, $eŠ¸¯Çµ³Ó[$e§¼éŸªÅÏ]); if ($b¡Ñ‰ö¬­Æ[319] == $b›Ğ¼öÇùî[3]) { $eŠ¸¯Çµ³Ó[$e§¼éŸªÅÏ] = call_user_func_array($b›Ğ¼öÇùî[1], $Bæ½¸¯ôÉª); } else { $eŠ¸¯Çµ³Ó[$e§¼éŸªÅÏ] = call_user_func_array(array(&$this, $b›Ğ¼öÇùî[1]), $Bæ½¸¯ôÉª); } break; case $b¡Ñ‰ö¬­Æ[271]: $eŠ¸¯Çµ³Ó[$e§¼éŸªÅÏ] = $eŠ¸¯Çµ³Ó[$b›Ğ¼öÇùî[1]]; break; case $b¡Ñ‰ö¬­Æ[292]: $aŞœ‹ùŠº = $eŠ¸¯Çµ³Ó[$e§¼éŸªÅÏ]; $eŠ¸¯Çµ³Ó[$e§¼éŸªÅÏ] = json_decode($aŞœ‹ùŠº, !0); if (is_null($eŠ¸¯Çµ³Ó[$e§¼éŸªÅÏ])) { $eŠ¸¯Çµ³Ó[$e§¼éŸªÅÏ] = $aŞœ‹ùŠº; } break; case $b¡Ñ‰ö¬­Æ[321]: if ($eŠ¸¯Çµ³Ó[$e§¼éŸªÅÏ] === $b¡Ñ‰ö¬­Æ[33]) { unset($eŠ¸¯Çµ³Ó[$e§¼éŸªÅÏ]); } break; case $b¡Ñ‰ö¬­Æ[322]: $eŠ¸¯Çµ³Ó[$e§¼éŸªÅÏ] = $b›Ğ¼öÇùî[1]; default: break; } } } public function saveAll($C×ÊÆ˜Æã™) { goto DíœËÛö©ç; Aà©‚©ÏëĞ: $C×ÊÆ˜Æã™ = is_array($C×ÊÆ˜Æã™) ? $C×ÊÆ˜Æã™ : array(); $aîö×™ = $aÌ Š˜ØĞó[375]; $BãøŒÛœ«‰ = 0; goto Eæ ¡èÍ; Aì…ŞØàÇ¿: $this->chunkEventSet(); goto F‡‡¨ó¦ôó; DíœËÛö©ç: $aÌ Š˜ØĞó =& $_SERVER[¬¦ã¾]; $c ˆÊÍŸ…¡ = $this->tablePrefix . $this->tableName; $EŸ­ƒÊ¬Ù = self::SQL_WHERE_IN_CHUNK; goto Aà©‚©ÏëĞ; Eæ ¡èÍ: $bËï–½šÚ = array(); $a ÄÁğù¸’ = count($C×ÊÆ˜Æã™); for ($A“œ¯âä¨ = 0; $A“œ¯âä¨ < $a ÄÁğù¸’; $A“œ¯âä¨++) { $b¨ãğ‡ÚËœ = $C×ÊÆ˜Æã™[$A“œ¯âä¨]; if (!is_array($b¨ãğ‡ÚËœ) || count($b¨ãğ‡ÚËœ) != 4) { continue; } $Eë«—Åï£ = "\x55\120\x44\101\x54\x45\40\x60{$c ˆÊÍŸ…¡}\x60\40\x53\x45\x54\40{$b¨ãğ‡ÚËœ[2]}\x20\x3d\40\103\x41\123\105\40{$b¨ãğ‡ÚËœ[0]}\40\12"; if ($BãøŒÛœ«‰ == 0) { $aîö×™ = $Eë«—Åï£; } $bËï–½šÚ[] = $aÌ Š˜ØĞó[116] . $b¨ãğ‡ÚËœ[1] . $aÌ Š˜ØĞó[116]; $BãøŒÛœ«‰++; $aîö×™ .= "\x20\127\110\x45\x4e\40\x27{$b¨ãğ‡ÚËœ[1]}\x27\40\x54\110\x45\x4e\40\x27{$b¨ãğ‡ÚËœ[3]}\x27\x20\xa"; if ($BãøŒÛœ«‰ == $EŸ­ƒÊ¬Ù || $A“œ¯âä¨ == $a ÄÁğù¸’ - 1) { goto a¦ì—¦áƒ; B©„ñ¼ˆÉ¹: $bËï–½šÚ = array(); goto fÙÚ ÷¾‹“; e”ğìÏ‚: $BãøŒÛœ«‰ = 0; $aîö×™ = $Eë«—Åï£; $this->chunkEventCheck(count($bËï–½šÚ)); goto B©„ñ¼ˆÉ¹; a¦ì—¦áƒ: $fÕÆáÒ³ß = implode($aÌ Š˜ØĞó[47], $bËï–½šÚ); $aîö×™ .= "\x20\x45\116\x44\x20\40\x57\110\105\x52\x45\40{$b¨ãğ‡ÚËœ[0]}\40\111\116\x20\50{$fÕÆáÒ³ß}\x29\x20"; $this->execute($aîö×™); goto e”ğìÏ‚; fÙÚ ÷¾‹“: } } goto Aì…ŞØàÇ¿; F‡‡¨ó¦ôó: } public function saveAllEach($dª‚‰·éî) { $DÜ‹çÀç =& $_SERVER[¬¦ã¾]; $fÓ‹¶¬‘Û = $this->tablePrefix . $this->tableName; foreach ($dª‚‰·éî as $D‹Î‰Ğ¬çæ) { if (!is_array($D‹Î‰Ğ¬çæ) || count($D‹Î‰Ğ¬çæ) != 4) { continue; } $D¹Û×§ÜÇĞ = $D‹Î‰Ğ¬çæ[0] . $DÜ‹çÀç[376] . $D‹Î‰Ğ¬çæ[1] . $DÜ‹çÀç[116]; $EÇ’³Şõ¬ = $D‹Î‰Ğ¬çæ[2] . $DÜ‹çÀç[376] . $D‹Î‰Ğ¬çæ[3] . $DÜ‹çÀç[116]; $CŞŒ“¼éÅ = "\x75\x70\144\141\164\145\40{$fÓ‹¶¬‘Û}\x20\x73\145\x74\40{$EÇ’³Şõ¬}\x20\167\150\145\x72\145\x20{$D¹Û×§ÜÇĞ}\73"; $this->execute($CŞŒ“¼éÅ); } } protected $_chunkEvent = false; protected $_chunkEventParam = false; public function chunkEventSet($f·¾¦œİ°Ù = false, $A¯„¡‹±ÈÅ = false) { $this->_chunkEvent = $f·¾¦œİ°Ù; $this->_chunkEventParam = $A¯„¡‹±ÈÅ; } private function chunkEventCheck($F“Õ÷Æ²©À) { if (!$this->_chunkEvent) { return; } $D”ŠŸ‚ÓÆÁ = is_array($this->_chunkEventParam) ? $this->_chunkEventParam : array(); $D”ŠŸ‚ÓÆÁ[$_SERVER[¬¦ã¾][377]] = $F“Õ÷Æ²©À; Hook::trigger($this->_chunkEvent, $D”ŠŸ‚ÓÆÁ); } public function addAll($dìÈËø›·, $BÎ‚ÍÌÛ¶ë = array(), $C´­í‚È³Ú = false) { goto câ–ªù²Ä™; CÆ»†ñòÈù: if (empty($dìÈËø›·)) { $this->error = think_lang($C—”Ÿ¼¾´ñ[269]); return !1; } $BÎ‚ÍÌÛ¶ë = $this->_parseOptions($BÎ‚ÍÌÛ¶ë); foreach ($dìÈËø›· as $EŒÓµ©äãê => $bÂ³êš½Å†) { $dìÈËø›·[$EŒÓµ©äãê] = $this->_facade($bÂ³êš½Å†); $this->_beforeInsert($dìÈËø›·[$EŒÓµ©äãê], $BÎ‚ÍÌÛ¶ë); } goto açó¹¾¹Í„; açó¹¾¹Í„: if (method_exists($this->db, $C—”Ÿ¼¾´ñ[270])) { for ($a‡Ã»®ìõ» = 0; $a‡Ã»®ìõ» < count($dìÈËø›·); $a‡Ã»®ìõ» += $dË ê©ÄĞ) { $CÒŒ©øãÕ¶ = array_slice($dìÈËø›·, $a‡Ã»®ìõ», $dË ê©ÄĞ); if (!is_array($CÒŒ©øãÕ¶) || count($CÒŒ©øãÕ¶) == 0) { break; } $Aî¤Ğå×õÄ = $this->db->insertAll($CÒŒ©øãÕ¶, $BÎ‚ÍÌÛ¶ë, $C´­í‚È³Ú); $this->chunkEventCheck(count($CÒŒ©øãÕ¶)); } $this->chunkEventSet(); } else { $this->startTrans(); foreach ($dìÈËø›· as $EŒÓµ©äãê => $bÂ³êš½Å†) { $Aî¤Ğå×õÄ = $this->db->insert($bÂ³êš½Å†, $BÎ‚ÍÌÛ¶ë, $C´­í‚È³Ú); } $this->commit(); } if (!1 !== $Aî¤Ğå×õÄ) { $f…ÈÙˆ…Ò™ = $this->getLastInsID(); if ($f…ÈÙˆ…Ò™) { return $f…ÈÙˆ…Ò™; } } return $Aî¤Ğå×õÄ; goto C«—©‘Áğö; câ–ªù²Ä™: $C—”Ÿ¼¾´ñ =& $_SERVER[¬¦ã¾]; ignore_timeout(); $dË ê©ÄĞ = self::SQL_WHERE_IN_CHUNK; goto CÆ»†ñòÈù; C«—©‘Áğö: } public function save($D§ÃĞŠÜ¤æ = '', $fÁŸŠŸêØ = array()) { goto DÏÜèÖíãÉ; DÏÜèÖíãÉ: $f³Ó‚ƒÚ¢ =& $_SERVER[¬¦ã¾]; $CÖ’·éÄ¤ø = self::SQL_WHERE_IN_CHUNK; $B‡‚èÇâæ = $this->optionsValue(); goto bñÍ×ÓÁ; bñÍ×ÓÁ: $a½öÙ®¾àÅ = $this->findWhereField($B‡‚èÇâæ); if (!$a½öÙ®¾àÅ) { return parent::save($D§ÃĞŠÜ¤æ, $fÁŸŠŸêØ); } $F©­ôÑÎíè = 0; goto fîï¶¤ÅÇæ; dÑ”÷ğÆ: for ($FÎ×¢´Ä = 0; $FÎ×¢´Ä < $B¿±¾Ú¸ÖÄ; $FÎ×¢´Ä += $CÖ’·éÄ¤ø) { $f•£­•³œó = array_slice($FŒ•‡·™‹„, $FÎ×¢´Ä, $CÖ’·éÄ¤ø); if (!is_array($f•£­•³œó) || count($f•£­•³œó) == 0) { break; } $B‡‚èÇâæ[$f³Ó‚ƒÚ¢[273]][$a½öÙ®¾àÅ][1] = $f•£­•³œó; $this->optionsValue($B‡‚èÇâæ); $F©­ôÑÎíè += parent::save($D§ÃĞŠÜ¤æ, $fÁŸŠŸêØ); $this->chunkEventCheck(count($f•£­•³œó)); } $this->chunkEventSet(); return $F©­ôÑÎíè; goto dáØ„¸ëÆÃ; fîï¶¤ÅÇæ: $FŒ•‡·™‹„ = $B‡‚èÇâæ[$f³Ó‚ƒÚ¢[273]][$a½öÙ®¾àÅ][1]; $FŒ•‡·™‹„ = is_array($FŒ•‡·™‹„) ? $FŒ•‡·™‹„ : array(); $B¿±¾Ú¸ÖÄ = count($FŒ•‡·™‹„); goto dÑ”÷ğÆ; dáØ„¸ëÆÃ: } public function add($DšÑ„ÉëŠõ = '', $F¢©–ĞÎó = array(), $DÅîÄØ‘¼½ = false) { if ($this->addTaskStatus && is_array($DšÑ„ÉëŠõ)) { $this->addTaskData[] = $DšÑ„ÉëŠõ; return; } return parent::add($DšÑ„ÉëŠõ, $F¢©–ĞÎó, $DÅîÄØ‘¼½); } public function parseWhereLike($EÒ¤¯º½ÒÉ, $FÅé¹á‘–ğ = '', $CÓ¿ ¯…ñ = false, &$a—õĞÜ¾£¶ = false) { goto aÈİÒ¾İÅ; fÛŒ¥·Ñ‡á: if (!is_array($EÒ¤¯º½ÒÉ)) { return $EÒ¤¯º½ÒÉ; } $B™¹İ®Á£ = array(); $F»Ù˜’Ê‹• = 0; goto aŠŞ”—àƒ»; aÈİÒ¾İÅ: $b‹Æì£™Œ÷ =& $_SERVER[¬¦ã¾]; $B¾½ÊÏ¦ñ‹ = $GLOBALS[$b‹Æì£™Œ÷[6]][$b‹Æì£™Œ÷[378]]; if (!$B¾½ÊÏ¦ñ‹[$b‹Æì£™Œ÷[379]]) { return $EÒ¤¯º½ÒÉ; } goto fÛŒ¥·Ñ‡á; aŠŞ”—àƒ»: foreach ($EÒ¤¯º½ÒÉ as $B§ÔĞÄŒóŒ => $e¨‘È–—Å) { if (is_array($e¨‘È–—Å) && count($e¨‘È–—Å) == 2 && $e¨‘È–—Å[0] == $b‹Æì£™Œ÷[380] && is_string($e¨‘È–—Å[1]) && substr($e¨‘È–—Å[1], 0, 1) == $b‹Æì£™Œ÷[381] && substr($e¨‘È–—Å[1], strlen($e¨‘È–—Å[1]) - 1, 1) == $b‹Æì£™Œ÷[381]) { goto fÉ¹ùÅÂ¡è; EÅó·‹“‰: $Aß×³ÎÙÁ = $this->db->escapeString($Aß×³ÎÙÁ); if (!strpos($fæøÚÀˆ×, $b‹Æì£™Œ÷[95])) { $fæøÚÀˆ× = $b‹Æì£™Œ÷[382] . $fæøÚÀˆ× . $b‹Æì£™Œ÷[382]; } $dê÷Ü÷¦Ã× = $b‹Æì£™Œ÷[182] . $Aß×³ÎÙÁ . $b‹Æì£™Œ÷[182]; goto Eâé£µ«Å; fôÌÜ©À„: continue; goto F‹ääô¼Êš; Eâé£µ«Å: if ($B¾½ÊÏ¦ñ‹[$b‹Æì£™Œ÷[383]]) { $dê÷Ü÷¦Ã× = $b‹Æì£™Œ÷[384] . $Aß×³ÎÙÁ . $b‹Æì£™Œ÷[385]; if ($B¾½ÊÏ¦ñ‹[$b‹Æì£™Œ÷[386]]) { $dê÷Ü÷¦Ã× = $b‹Æì£™Œ÷[385] . $Aß×³ÎÙÁ . $b‹Æì£™Œ÷[384]; } } $B™¹İ®Á£[$F»Ù˜’Ê‹•] = $b‹Æì£™Œ÷[387] . $fæøÚÀˆ× . $b‹Æì£™Œ÷[388] . $dê÷Ü÷¦Ã× . $b‹Æì£™Œ÷[389]; $F»Ù˜’Ê‹•++; goto fôÌÜ©À„; fÉ¹ùÅÂ¡è: $a—õĞÜ¾£¶ = !0; $fæøÚÀˆ× = is_string($B§ÔĞÄŒóŒ) ? $B§ÔĞÄŒóŒ : $FÅé¹á‘–ğ; $Aß×³ÎÙÁ = substr($e¨‘È–—Å[1], 1, strlen($e¨‘È–—Å[1]) - 2); goto EÅó·‹“‰; F‹ääô¼Êš: } if (is_array($e¨‘È–—Å)) { $FÅé¹á‘–ğ = is_string($B§ÔĞÄŒóŒ) ? $B§ÔĞÄŒóŒ : $FÅé¹á‘–ğ; $e¨‘È–—Å = $this->parseWhereLike($e¨‘È–—Å, $FÅé¹á‘–ğ, !0, $a—õĞÜ¾£¶); } if (is_numeric($B§ÔĞÄŒóŒ)) { $B™¹İ®Á£[$F»Ù˜’Ê‹•] = $e¨‘È–—Å; $F»Ù˜’Ê‹•++; } else { $B™¹İ®Á£[$B§ÔĞÄŒóŒ] = $e¨‘È–—Å; } } if ($a—õĞÜ¾£¶ && !$CÓ¿ ¯…ñ) { } return $B™¹İ®Á£; goto bËâ……Ë†å; bËâ……Ë†å: } private $addTaskStatus = false; private $addTaskData = array(); public function addTaskStart() { $this->addTaskStatus = !0; $this->addTaskData = array(); } public function addTaskEnd() { if (!$this->addTaskStatus) { return; } $this->addAll($this->addTaskData); $this->addTaskStatus = !1; $this->addTaskData = array(); } public function select($c¦½¨áã = array()) { goto EôˆãÜÑ¹Î; cï’àÌ¿±Õ: return $C¥Äğñ´ŒÄ; goto d´ª¯–á™“; c‹ƒ¾ìÎğ‘: $FŠ“¹ø•É¶ = is_array($FŠ“¹ø•É¶) ? $FŠ“¹ø•É¶ : array(); $C¥Äğñ´ŒÄ = null; for ($C‚ÀİÈÖÕ« = 0; $C‚ÀİÈÖÕ« < count($FŠ“¹ø•É¶); $C‚ÀİÈÖÕ« += $FÍ‰Š¾Ùö¨) { $AñéÃ¡‡œ = array_slice($FŠ“¹ø•É¶, $C‚ÀİÈÖÕ«, $FÍ‰Š¾Ùö¨); if (!is_array($AñéÃ¡‡œ) || count($AñéÃ¡‡œ) == 0) { break; } $d·ìÅ‡Š¢…[$E”º°èê[273]][$dÊ£ÎïÂò¿][1] = $AñéÃ¡‡œ; $this->optionsValue($d·ìÅ‡Š¢…); $FÛ×â˜•¥ = parent::select($c¦½¨áã); if (!$FÛ×â˜•¥) { continue; } $C¥Äğñ´ŒÄ = is_array($C¥Äğñ´ŒÄ) ? $C¥Äğñ´ŒÄ : array(); $C¥Äğñ´ŒÄ = array_merge($C¥Äğñ´ŒÄ, $FÛ×â˜•¥); } goto cï’àÌ¿±Õ; EôˆãÜÑ¹Î: $E”º°èê =& $_SERVER[¬¦ã¾]; $FÍ‰Š¾Ùö¨ = self::SQL_WHERE_IN_CHUNK; $d·ìÅ‡Š¢… = $this->optionsValue(); goto fÚ‡§¥©®’; fÚ‡§¥©®’: $dÊ£ÎïÂò¿ = $this->findWhereField($d·ìÅ‡Š¢…); if (!$dÊ£ÎïÂò¿ || isset($d·ìÅ‡Š¢…[$E”º°èê[290]]) || isset($d·ìÅ‡Š¢…[$E”º°èê[351]])) { return parent::select($c¦½¨áã); } $FŠ“¹ø•É¶ = $d·ìÅ‡Š¢…[$E”º°èê[273]][$dÊ£ÎïÂò¿][1]; goto c‹ƒ¾ìÎğ‘; d´ª¯–á™“: } public function delete($C òäòê = array()) { goto fƒ—çÁ˜œ; fƒ—çÁ˜œ: $BÄäì•èê =& $_SERVER[¬¦ã¾]; $E·ØœŸ£Ü = self::SQL_WHERE_IN_CHUNK; $EÏ…±íèÓ = $this->optionsValue(); goto bëÓŸš‘›; bëÓŸš‘›: $Båö±Ñª—œ = $this->findWhereField($EÏ…±íèÓ); if (!$Båö±Ñª—œ) { return parent::delete($C òäòê); } $EëŒÈèóó = 0; goto AŠë±¾‰š; Eå’§ËòÁŸ: return $EëŒÈèóó; goto CĞÖÍÄ“…–; AŠë±¾‰š: $D­‘áŸÄ‡ = $EÏ…±íèÓ[$BÄäì•èê[273]][$Båö±Ñª—œ][1]; $D­‘áŸÄ‡ = is_array($D­‘áŸÄ‡) ? $D­‘áŸÄ‡ : array(); for ($féÔ¢“è… = 0; $féÔ¢“è… < count($D­‘áŸÄ‡); $féÔ¢“è… += $E·ØœŸ£Ü) { $FİŠé‰Œï¨ = array_slice($D­‘áŸÄ‡, $féÔ¢“è…, $E·ØœŸ£Ü); if (!is_array($FİŠé‰Œï¨) || count($FİŠé‰Œï¨) == 0) { break; } $EÏ…±íèÓ[$BÄäì•èê[273]][$Båö±Ñª—œ][1] = $FİŠé‰Œï¨; $this->optionsValue($EÏ…±íèÓ); $EëŒÈèóó += parent::delete($C òäòê); } goto Eå’§ËòÁŸ; CĞÖÍÄ“…–: } private function findWhereField($Cñå‘¾ã‰è) { $fòà…öøÊÎ =& $_SERVER[¬¦ã¾]; $A–¸È‚Æ–Å = self::SQL_WHERE_IN_CHUNK; if (!is_array($Cñå‘¾ã‰è) || !is_array($Cñå‘¾ã‰è[$fòà…öøÊÎ[273]])) { return !1; } foreach ($Cñå‘¾ã‰è[$fòà…öøÊÎ[273]] as $Aöƒ©·ßù™ => $CµâÎ‹„‰â) { if (is_array($CµâÎ‹„‰â) && isset($CµâÎ‹„‰â[0]) && is_string($CµâÎ‹„‰â[0]) && strtolower($CµâÎ‹„‰â[0]) == $fòà…öøÊÎ[7] && is_array($CµâÎ‹„‰â[1]) && count($CµâÎ‹„‰â[1]) > $A–¸È‚Æ–Å) { ignore_timeout(); return $Aöƒ©·ßù™; } } return !1; } } class ModelBaseLight { public $optionType = ''; public $modelType = "\x53\x79\163\x74\145\155\x4f\160\164\x69\157\x6e"; public $field = array(); public function listData($Aî ”õİ– = false, $fÄÃÚÌÃ‡‚ = "\155\157\144\151\146\171\124\x69\155\x65", $c¶¬À§¯’è = false) { $e¤Î©ôøÃö = Model($this->modelType)->get(!1, $this->optionType, !0); if (!$e¤Î©ôøÃö) { return $Aî ”õİ– ? null : array(); } if (!$Aî ”õİ–) { $e¤Î©ôøÃö = array_filter(array_values($e¤Î©ôøÃö)); return array_sort_by($e¤Î©ôøÃö, $fÄÃÚÌÃ‡‚, $c¶¬À§¯’è); } return $e¤Î©ôøÃö[$_SERVER[¬¦ã¾][390] . $Aî ”õİ–]; } public function insert($EÊ˜â÷õ™Ë) { goto B¼ˆïì‡—É; B¼ˆïì‡—É: $cŠˆí™Í‹ê =& $_SERVER[¬¦ã¾]; $EÊ˜â÷õ™Ë = array_field_key($EÊ˜â÷õ™Ë, $this->field); $AÌ°èĞøâ = Model($this->modelType)->get($cŠˆí™Í‹ê[391], $this->optionType . $cŠˆí™Í‹ê[392]); goto AÈ£òâ«; Cç‚„†¹“: return $AÌ°èĞøâ; goto cÖÁÄ™îØà; bç±â¤ëø: $EÊ˜â÷õ™Ë[$cŠˆí™Í‹ê[84]] = time(); Model($this->modelType)->set($cŠˆí™Í‹ê[391], $AÌ°èĞøâ, $this->optionType . $cŠˆí™Í‹ê[392]); Model($this->modelType)->set($cŠˆí™Í‹ê[390] . $AÌ°èĞøâ, $EÊ˜â÷õ™Ë, $this->optionType); goto Cç‚„†¹“; AÈ£òâ«: $AÌ°èĞøâ = $AÌ°èĞøâ ? $AÌ°èĞøâ : 0; $EÊ˜â÷õ™Ë[$cŠˆí™Í‹ê[393]] = ++$AÌ°èĞøâ; $EÊ˜â÷õ™Ë[$cŠˆí™Í‹ê[194]] = time(); goto bç±â¤ëø; cÖÁÄ™îØà: } public function update($fÁÙ¶·Œ˜, $cõ÷õ°¸Àğ) { goto c­÷°áŞÌ…; BÓ§ö¹â“Ç: return Model($this->modelType)->set($fƒ¹ÒÌÃ«[390] . $fÁÙ¶·Œ˜, $cõ÷õ°¸Àğ, $this->optionType); goto fŠ¨µ÷Î¡; c­÷°áŞÌ…: $fƒ¹ÒÌÃ« =& $_SERVER[¬¦ã¾]; $cõ÷õ°¸Àğ = array_field_key($cõ÷õ°¸Àğ, $this->field); $E¯Éİ­÷Èğ = $this->listData($fÁÙ¶·Œ˜); goto B±ãƒÊùøº; B±ãƒÊùøº: if (!$E¯Éİ­÷Èğ) { return !1; } $cõ÷õ°¸Àğ = array_merge($E¯Éİ­÷Èğ, $cõ÷õ°¸Àğ); $cõ÷õ°¸Àğ[$fƒ¹ÒÌÃ«[84]] = time(); goto BÓ§ö¹â“Ç; fŠ¨µ÷Î¡: } public function remove($D±ëó¾°í¾) { return Model($this->modelType)->remove($_SERVER[¬¦ã¾][390] . $D±ëó¾°í¾, $this->optionType); } public function clear() { $EÕÙºŸ‰ÔÑ =& $_SERVER[¬¦ã¾]; Model($this->modelType)->remove($EÕÙºŸ‰ÔÑ[391], $this->optionType . $EÕÙºŸ‰ÔÑ[392]); return Model($this->modelType)->remove(null, $this->optionType); } public function cacheClear() { return Model($this->modelType)->cacheRemove($this->optionType); } public function findByKey($Cùææ²†ˆ¿, $AœÌõæ‹–æ) { if (!$AœÌõæ‹–æ) { return !1; } $BŠØÔÎÔÁƒ = $this->listData(); $BŠØÔÎÔÁƒ = array_to_keyvalue($BŠØÔÎÔÁƒ, $Cùææ²†ˆ¿); return isset($BŠØÔÎÔÁƒ[$AœÌõæ‹–æ]) ? $BŠØÔÎÔÁƒ[$AœÌõæ‹–æ] : !1; } public function findByName($A˜ªå¨Ç÷­) { return $this->findByKey($_SERVER[¬¦ã¾][28], $A˜ªå¨Ç÷­); } protected function resetData($aÎÖªîÓÊ) { $dÅë“Ñ‚‹É =& $_SERVER[¬¦ã¾]; $aÎÖªîÓÊ = is_array($aÎÖªîÓÊ) ? $aÎÖªîÓÊ : array(); $EÔÁ×¼­îŒ = array(); for ($A¤¬˜‡Óíˆ = 0; $A¤¬˜‡Óíˆ < count($aÎÖªîÓÊ); $A¤¬˜‡Óíˆ++) { $EÔÁ×¼­îŒ[$dÅë“Ñ‚‹É[390] . $aÎÖªîÓÊ[$A¤¬˜‡Óíˆ][$dÅë“Ñ‚‹É[393]]] = $aÎÖªîÓÊ[$A¤¬˜‡Óíˆ]; } return Model($this->modelType)->set($EÔÁ×¼­îŒ, !1, $this->optionType); } private function getAutoName($eˆÁÊ¡Ö¹İ) { $D©™…Ì¢³ = array_to_keyvalue($this->listData(), $_SERVER[¬¦ã¾][28]); if (!$D©™…Ì¢³ || !isset($D©™…Ì¢³[$eˆÁÊ¡Ö¹İ])) { return $eˆÁÊ¡Ö¹İ; } for ($Bôˆ»‘Ä™õ = 1; $Bôˆ»‘Ä™õ < count($D©™…Ì¢³); $Bôˆ»‘Ä™õ++) { $dÀˆ¨éŒÖ² = $eˆÁÊ¡Ö¹İ . "\50{$Bôˆ»‘Ä™õ}\51"; if (!isset($D©™…Ì¢³[$dÀˆ¨éŒÖ²])) { return $dÀˆ¨éŒÖ²; } } return $dÀˆ¨éŒÖ²; } } class ModelBaseOption extends ModelBase { protected $tableName = ''; protected $jsonField = array(); public function get($bĞ¹‚ÈÔ† = false, $fÅÒìÄ¿¿ = '', $c“‘ÀíçÔñ = false) { goto f‡íª¿İ ¾; AÍÚšõ³ùŒ: $Bë¾ß£Ú¶¤ = $this->where($cÕÄÖèŒ­œ)->select(); $Bë¾ß£Ú¶¤ = array_to_keyvalue($Bë¾ß£Ú¶¤, $fŠøø•¦³ù[93], $fŠøø•¦³ù[372]); foreach ($Bë¾ß£Ú¶¤ as $Aï¸İØ => $eÅ´À“‘–Û) { if ($c“‘ÀíçÔñ || in_array($Aï¸İØ, $this->jsonField)) { $Bë¾ß£Ú¶¤[$Aï¸İØ] = json_decode($eÅ´À“‘–Û, !0); } } goto EÄ›Öƒ¾ø¢; EÄ›Öƒ¾ø¢: $this->cacheSet($fÅÒìÄ¿¿, $Bë¾ß£Ú¶¤); $Bë¾ß£Ú¶¤ = array_merge($AšÙÇ‡³†¹, $Bë¾ß£Ú¶¤); return $bĞ¹‚ÈÔ† ? $Bë¾ß£Ú¶¤[$bĞ¹‚ÈÔ†] : $Bë¾ß£Ú¶¤; goto BÍ¦·ó…‚Ã; f‡íª¿İ ¾: $fŠøø•¦³ù =& $_SERVER[¬¦ã¾]; $Bë¾ß£Ú¶¤ = $this->cacheGet($fÅÒìÄ¿¿); $AšÙÇ‡³†¹ = $this->optionDefault($fÅÒìÄ¿¿); goto bô³¥âêŸ¡; bô³¥âêŸ¡: $AšÙÇ‡³†¹ = is_array($AšÙÇ‡³†¹) ? $AšÙÇ‡³†¹ : array(); if (is_array($Bë¾ß£Ú¶¤)) { $Bë¾ß£Ú¶¤ = array_merge($AšÙÇ‡³†¹, $Bë¾ß£Ú¶¤); return $bĞ¹‚ÈÔ† ? isset($Bë¾ß£Ú¶¤[$bĞ¹‚ÈÔ†]) ? $Bë¾ß£Ú¶¤[$bĞ¹‚ÈÔ†] : null : $Bë¾ß£Ú¶¤; } $cÕÄÖèŒ­œ = $this->filterWhere(array($fŠøø•¦³ù[29] => $fÅÒìÄ¿¿)); goto AÍÚšõ³ùŒ; BÍ¦·ó…‚Ã: } public function set($cëÚöÅ§Şô, $cÚ¥¬Çµ = false, $E»¬‘¡İ¦ê = '') { goto C¯”º½Û°İ; C¨î½­âŠ: $D˜ƒãÛù÷Ÿ = is_array($cëÚöÅ§Şô) ? $cëÚöÅ§Şô : array($cëÚöÅ§Şô => $cÚ¥¬Çµ); foreach ($D˜ƒãÛù÷Ÿ as $Dâîì£Ê°Š => $Dâ¼Å‚ø§ç) { if (is_array($Dâ¼Å‚ø§ç)) { $Dâ¼Å‚ø§ç = json_encode_force($Dâ¼Å‚ø§ç); } $this->checkLength($Dâ¼Å‚ø§ç, !1, $this->tableName . $EÜùˆìĞ§“[4] . $cëÚöÅ§Şô); $Dâ¼Å‚ø§ç = self::textEncode($Dâ¼Å‚ø§ç); $D˜ƒãÛù÷Ÿ = array($EÜùˆìĞ§“[29] => $E»¬‘¡İ¦ê, $EÜùˆìĞ§“[93] => $Dâîì£Ê°Š, $EÜùˆìĞ§“[372] => $Dâ¼Å‚ø§ç); $EïÂÌ¾êÒÆ[] = $this->filterWhere($D˜ƒãÛù÷Ÿ); } if (!$EïÂÌ¾êÒÆ) { return !0; } goto D‘‰¯Ÿ¹’ñ; C¯”º½Û°İ: $EÜùˆìĞ§“ =& $_SERVER[¬¦ã¾]; $this->cacheRemove($E»¬‘¡İ¦ê); $EïÂÌ¾êÒÆ = array(); goto C¨î½­âŠ; D‘‰¯Ÿ¹’ñ: return $this->addAll($EïÂÌ¾êÒÆ, array(), !0); goto D‘ÛŠæÔ·; D‘ÛŠæÔ·: } protected function optionDefault($A×Óº’‡Ş = '') { return !1; } public function setDeep($cƒ’õ …‰ô, $FÉî¶êé• = false, $A”ôø”¡Å = '') { $c›Íø•˜Ó› = explode($_SERVER[¬¦ã¾][95], $cƒ’õ …‰ô); $E®Â…§…«² = $this->get(); array_set_value($E®Â…§…«², $cƒ’õ …‰ô, $FÉî¶êé•); $this->set($c›Íø•˜Ó›[0], $E®Â…§…«²[$c›Íø•˜Ó›[0]], $A”ôø”¡Å); } public function remove($e™‘÷¡Æ‹¿, $Bç ˆ˜Ş¿ = '') { $aÃÏÖ›é’ô =& $_SERVER[¬¦ã¾]; $this->cacheRemove($Bç ˆ˜Ş¿); $eêÌ †ã = $this->filterWhere(array($aÃÏÖ›é’ô[93] => $e™‘÷¡Æ‹¿, $aÃÏÖ›é’ô[29] => $Bç ˆ˜Ş¿)); if (is_null($e™‘÷¡Æ‹¿)) { unset($eêÌ †ã[$aÃÏÖ›é’ô[93]]); } return $this->where($eêÌ †ã)->delete(); } public function cacheSet($e…×Æ¿©æ©, $C¬¼‚Œ¹Š¼ = false) { return Cache::set($this->cacheKey($e…×Æ¿©æ©), $C¬¼‚Œ¹Š¼); } public function cacheGet($aÀßÛ½Á®) { return Cache::get($this->cacheKey($aÀßÛ½Á®)); } public function cacheRemove($a¸ª›Á§•ò) { return Cache::remove($this->cacheKey($a¸ª›Á§•ò)); } protected function filterWhere($A»×Ÿ°ƒÏÕ) { return $A»×Ÿ°ƒÏÕ; } protected function cacheKey($bÄ˜²†óÔÎ) { return $bÄ˜²†óÔÎ; } } goto Fò—Æœë; e†ùœæ´Á: class SourceHistoryModel extends ModelBase { protected $tableName = "\151\157\137\x73\157\165\162\x63\x65\x5f\x68\151\163\164\157\162\171"; public function historyCount($a£’Ã‹ ªé) { goto EÈ¸Õ’¶; EÈ¸Õ’¶: $Dæ‚Ü§‰§× =& $_SERVER[¬¦ã¾]; if (!$a£’Ã‹ ªé) { return array(); } if (is_string($a£’Ã‹ ªé) || is_int($a£’Ã‹ ªé)) { $a£’Ã‹ ªé = array($a£’Ã‹ ªé); } goto EØİ¿‡¹±Ç; aˆ®ñÁ“Ÿ: return array_to_keyvalue($dìšöª¾±, $Dæ‚Ü§‰§×[395], $Dæ‚Ü§‰§×[480]); goto døÈèĞõ˜®; EØİ¿‡¹±Ç: $E«õ²ç–ßÃ = array($Dæ‚Ü§‰§×[395], $Dæ‚Ü§‰§×[1720] => $Dæ‚Ü§‰§×[480]); $c˜¡“…ª… = array($Dæ‚Ü§‰§×[395] => array($Dæ‚Ü§‰§×[7], $a£’Ã‹ ªé)); $dìšöª¾± = $this->field($E«õ²ç–ßÃ)->where($c˜¡“…ª…)->group($Dæ‚Ü§‰§×[395])->select(); goto aˆ®ñÁ“Ÿ; døÈèĞõ˜®: } public function addHistory($dÂ˜¨’¨Šµ, $f‹œ¢ÀîŒÀ = '') { $EØ×­»±‡ =& $_SERVER[¬¦ã¾]; $F¤åïÊÕÄ = array($EØ×­»±‡[410] => $dÂ˜¨’¨Šµ[$EØ×­»±‡[395]], $EØ×­»±‡[1512] => isset($dÂ˜¨’¨Šµ[$EØ×­»±‡[434]]) ? $dÂ˜¨’¨Šµ[$EØ×­»±‡[434]] : $dÂ˜¨’¨Šµ[$EØ×­»±‡[432]], $EØ×­»±‡[448] => $dÂ˜¨’¨Šµ[$EØ×­»±‡[447]], $EØ×­»±‡[548] => $dÂ˜¨’¨Šµ[$EØ×­»±‡[78]], $EØ×­»±‡[1916] => $f‹œ¢ÀîŒÀ); $eñÏÍ´¿¨¶ = $GLOBALS[$EØ×­»±‡[6]][$EØ×­»±‡[88]][$EØ×­»±‡[1095]]; if ($eñÏÍ´¿¨¶ > 1) { $this->historyAutoClear($F¤åïÊÕÄ[$EØ×­»±‡[395]]); $this->add($F¤åïÊÕÄ); } Hook::trigger($EØ×­»±‡[1917], $F¤åïÊÕÄ); Model($EØ×­»±‡[1918])->eventFileEdit($dÂ˜¨’¨Šµ[$EØ×­»±‡[395]]); } private function historyAutoClear($BÀŒŒ¥š—š) { goto Dî“ ŞíÄ´; EÁòÆèÁ‰¶: $DòÎ“÷’‰– = $Eœ¦Š¾ğïë == $AæÁ¯ì”İÁ[1118] ? 5 : $A¬Ò¼ÜÎ½; if ($A¬Ò¼ÜÎ½ <= 1) { $DòÎ“÷’‰– = 1; } if ($DòÎ“÷’‰– >= 500) { return; } goto dï¬¹êº¿; EÉô˜šö‹: $this->where($FÄß’ÁŠ×Š)->delete(); Model($AæÁ¯ì”İÁ[450])->remove($cŞÖ‘‘Ø¤“); goto c­™Ñ÷¤¿÷; cÒéµ‡ç‹¬: $BŠÎöùÃÇ¾ = array_to_keyvalue($B±ÑÄá®º½, $AæÁ¯ì”İÁ[33], $AæÁ¯ì”İÁ[393]); $BŠÎöùÃÇ¾ = array_slice($BŠÎöùÃÇ¾, $DòÎ“÷’‰–); $cŞÖ‘‘Ø¤“ = array_to_keyvalue($B±ÑÄá®º½, $AæÁ¯ì”İÁ[33], $AæÁ¯ì”İÁ[447]); goto eî‘‰ŠºÒ¥; dï¬¹êº¿: $FÄß’ÁŠ×Š = array($AæÁ¯ì”İÁ[410] => $BÀŒŒ¥š—š); $B±ÑÄá®º½ = $this->field($AæÁ¯ì”İÁ[1919])->where($FÄß’ÁŠ×Š)->order($AæÁ¯ì”İÁ[1913])->select(); if (!$B±ÑÄá®º½ || $DòÎ“÷’‰– >= count($B±ÑÄá®º½)) { return; } goto cÒéµ‡ç‹¬; Dî“ ŞíÄ´: $AæÁ¯ì”İÁ =& $_SERVER[¬¦ã¾]; $Eœ¦Š¾ğïë = Model($AæÁ¯ì”İÁ[722])->get($AæÁ¯ì”İÁ[1117]); $A¬Ò¼ÜÎ½ = $GLOBALS[$AæÁ¯ì”İÁ[6]][$AæÁ¯ì”İÁ[88]][$AæÁ¯ì”İÁ[1095]]; goto EÁòÆèÁ‰¶; eî‘‰ŠºÒ¥: $cŞÖ‘‘Ø¤“ = array_slice($cŞÖ‘‘Ø¤“, $DòÎ“÷’‰–); if (!$BŠÎöùÃÇ¾ || !$cŞÖ‘‘Ø¤“) { return; } $FÄß’ÁŠ×Š = array($AæÁ¯ì”İÁ[412] => array($AæÁ¯ì”İÁ[7], $BŠÎöùÃÇ¾)); goto EÉô˜šö‹; c­™Ñ÷¤¿÷: } public function listData($b¾»ë£êÇá) { goto bìöÅÒºÈÈ; F–íŒĞÈğ³: $cÙÚ®ªª‡Û = 5; if ($A‚ÌŠ¹¥ == $aˆİ¾Ûƒ[1118]) { $Cœ²Ú‡à¾‘[$aˆİ¾Ûƒ[367]] = array_slice($Cœ²Ú‡à¾‘[$aˆİ¾Ûƒ[367]], 0, $cÙÚ®ªª‡Û); $Cœ²Ú‡à¾‘[$aˆİ¾Ûƒ[364]] = array($aˆİ¾Ûƒ[1921] => 1, $aˆİ¾Ûƒ[1922] => 20, $aˆİ¾Ûƒ[1923] => 1, $aˆİ¾Ûƒ[1924] => count($Cœ²Ú‡à¾‘[$aˆİ¾Ûƒ[367]])); } return $Cœ²Ú‡à¾‘; goto bÖĞÃ¾ôñ; bìöÅÒºÈÈ: $aˆİ¾Ûƒ =& $_SERVER[¬¦ã¾]; $b†Ùµé„ò = array($aˆİ¾Ûƒ[410] => $b¾»ë£êÇá); $cù®µ÷¦ = $aˆİ¾Ûƒ[1920]; goto Bš¥«ÍÚ»Ş; Bš¥«ÍÚ»Ş: $Cœ²Ú‡à¾‘ = $this->field($cù®µ÷¦)->where($b†Ùµé„ò)->order($aˆİ¾Ûƒ[1913])->selectPage(); $this->_listAppendUser($Cœ²Ú‡à¾‘[$aˆİ¾Ûƒ[367]]); $A‚ÌŠ¹¥ = Model($aˆİ¾Ûƒ[722])->get($aˆİ¾Ûƒ[1117]); goto F–íŒĞÈğ³; bÖĞÃ¾ôñ: } protected function _listAppendUser(&$aÆ§¬’Ìâ˜) { $f‹‰Ñ¬°‰¤ =& $_SERVER[¬¦ã¾]; $f§øò§¢Š¥ = array_to_keyvalue($aÆ§¬’Ìâ˜, $f‹‰Ñ¬°‰¤[33], $f‹‰Ñ¬°‰¤[1520]); $EãÛù‚­¬£ = Model($f‹‰Ñ¬°‰¤[506])->userListInfo($f§øò§¢Š¥); foreach ($aÆ§¬’Ìâ˜ as &$EÌ¡´ƒ«Ö) { $c²ÈïøåŒê = $EÌ¡´ƒ«Ö[$f‹‰Ñ¬°‰¤[1520]]; $EÌ¡´ƒ«Ö[$f‹‰Ñ¬°‰¤[432]] = $EãÛù‚­¬£[$c²ÈïøåŒê] ? $EãÛù‚­¬£[$c²ÈïøåŒê] : !1; } unset($EÌ¡´ƒ«Ö); } public function fileInfo($fÊ›Ù£ÚÁ) { $eØó¢³µ’† =& $_SERVER[¬¦ã¾]; $Aî¼¨„Î = $this->tablePrefix; $eÍ‚®ªãÛ… = "{$Aî¼¨„Î}\151\x6f\137\146\151\154\145\x20\x66\x69\x6c\x65\163\40\157\156\40\x66\151\x6c\145\x73\56\146\x69\x6c\x65\111\104\x20\x3d\40\x68\x69\x73\x74\157\162\x79\x2e\146\151\x6c\145\111\104"; return $this->alias($eØó¢³µ’†[1925])->where(array($eØó¢³µ’†[412] => $fÊ›Ù£ÚÁ))->join($eÍ‚®ªãÛ…, $eØó¢³µ’†[1926])->find(); } public function removeItem($C„·‰) { $E»•¡ºËƒ  =& $_SERVER[¬¦ã¾]; $aˆùÍÊªÈ = array($E»•¡ºËƒ [412] => $C„·‰); $e³Ê¨ˆ‹ï  = $this->where($aˆùÍÊªÈ)->find(); if ($e³Ê¨ˆ‹ï ) { $D”ô”î‡¢ó = $this->where($aˆùÍÊªÈ)->delete(); Model($E»•¡ºËƒ [450])->remove($e³Ê¨ˆ‹ï [$E»•¡ºËƒ [447]]); return $D”ô”î‡¢ó; } return !1; } public function removeBySource($eØ…ùºøÔ) { goto Có’õî´¼Ñ; bÉÃÊÅÊ†: return !0; goto DØğ°©„Ù; dÂÍ¾ãÏÅ‘: $CŞğ‡‹õØù = array($D–ÛÔğªŠÕ[410] => array($D–ÛÔğªŠÕ[7], $eØ…ùºøÔ)); $a³Ğ‚©õ¶¤ = $this->field($D–ÛÔğªŠÕ[448])->where($CŞğ‡‹õØù)->select(); if ($a³Ğ‚©õ¶¤) { $this->where($CŞğ‡‹õØù)->delete(); $b»”ï¢Ñ†– = array_to_keyvalue($a³Ğ‚©õ¶¤, $D–ÛÔğªŠÕ[33], $D–ÛÔğªŠÕ[447]); Model($D–ÛÔğªŠÕ[450])->remove($b»”ï¢Ñ†–); } goto bÉÃÊÅÊ†; Có’õî´¼Ñ: $D–ÛÔğªŠÕ =& $_SERVER[¬¦ã¾]; if (!$eØ…ùºøÔ) { return !1; } if (!is_array($eØ…ùºøÔ)) { $eØ…ùºøÔ = array($eØ…ùºøÔ); } goto dÂÍ¾ãÏÅ‘; DØğ°©„Ù: } public function setDetail($bêÓÔÇ…°, $fšŠíæß¸ğ) { $aİ„¨•áñ› =& $_SERVER[¬¦ã¾]; return $this->where(array($aİ„¨•áñ›[412] => $bêÓÔÇ…°))->save(array($aİ„¨•áñ›[1916] => $fšŠíæß¸ğ)); } public function rollbackToItem($cÁóßé˜åÍ, $BæÊéÁŒŸö) { goto BÓ‚·ŞÉ¸¸; Bìˆ¦ª‡ì°: $b¤îĞÕ»´¬ = $this->find($BæÊéÁŒŸö); $FĞ¯ãƒ¯ = array($bâˆóÀ½‹[447] => $b¤îĞÕ»´¬[$bâˆóÀ½‹[447]], $bâˆóÀ½‹[78] => $b¤îĞÕ»´¬[$bâˆóÀ½‹[78]], $bâˆóÀ½‹[84] => time(), $bâˆóÀ½‹[434] => USER_ID); Model($bâˆóÀ½‹[782])->where(array($bâˆóÀ½‹[395] => $cÁóßé˜åÍ))->save($FĞ¯ãƒ¯); goto cå‹ŠƒİŒ»; BÓ‚·ŞÉ¸¸: $bâˆóÀ½‹ =& $_SERVER[¬¦ã¾]; $f¥‹ÁÂ‚·ó = Model($bâˆóÀ½‹[782])->sourceInfo($cÁóßé˜åÍ); $this->addHistory($f¥‹ÁÂ‚·ó, LNG($bâˆóÀ½‹[1927])); goto Bìˆ¦ª‡ì°; cå‹ŠƒİŒ»: return $this->where(array($bâˆóÀ½‹[412] => $BæÊéÁŒŸö))->delete(); goto DÕÓ‹”©ç; DÕÓ‹”©ç: } public function clearSame($fÇ†ŞëÄØù) { goto cÙé”¼ÈÂ±; f¼Ø±£°ºæ: $d¾â‘•„õ = array(); $c–‹êåí£ = array(); foreach ($BéÆøçó•³ as $bšÖ‡Š¥ñë) { if (!$bšÖ‡Š¥ñë || count($bšÖ‡Š¥ñë) <= 1) { continue; } foreach ($bšÖ‡Š¥ñë as $B±Ù¨ò«ï) { $d¾â‘•„õ[] = $B±Ù¨ò«ï[$eÃÅ´„ä[447]]; $c–‹êåí£[] = $B±Ù¨ò«ï[$eÃÅ´„ä[393]]; } } goto e›ÇàŒêÑ; cÙé”¼ÈÂ±: $eÃÅ´„ä =& $_SERVER[¬¦ã¾]; $Aæ–ğ®•ä = $this->listData($fÇ†ŞëÄØù); $BéÆøçó•³ = array_to_keyvalue_group($Aæ–ğ®•ä, $eÃÅ´„ä[447]); goto f¼Ø±£°ºæ; e›ÇàŒêÑ: if (!$c–‹êåí£) { return; } $this->where(array($eÃÅ´„ä[393] => array($eÃÅ´„ä[7], $c–‹êåí£)))->delete(); Model($eÃÅ´„ä[450])->remove($d¾â‘•„õ); goto FŒ·×«º; FŒ·×«º: } public function userSpace() { $a–äõË¾Ä =& $_SERVER[¬¦ã¾]; $B¨ë”ô…„ = $this->tablePrefix; $f­œ®ó­µÚ = array($a–äõË¾Ä[1512] => USER_ID); $CôÌ‡‡á¶Š = "{$B¨ë”ô…„}\151\x6f\x5f\x66\151\154\x65\x20\146\x69\x6c\145\163\x20\x6f\156\x20\146\151\x6c\x65\163\x2e\x66\x69\x6c\145\x49\104\40\x3d\x20\x68\151\x73\164\157\162\x79\x2e\146\x69\154\x65\111\x44"; return $this->alias($a–äõË¾Ä[1925])->where($f­œ®ó­µÚ)->join($CôÌ‡‡á¶Š, $a–äõË¾Ä[1926])->sum($a–äõË¾Ä[78]); } } class SourceListSearchModel extends SourceListMoveModel { public static function fileTypeWhere($bá¤©ˆÁ¿õ) { goto b¾«‰òœ‚Ÿ; D‹ãğ”£¾: if (!$fƒí†ïø³©) { return array(); } $C¶¥Ö„Ÿ¯Á = $fƒí†ïø³©[$fÛğ´ÀéŒ÷[168]]; $A‹ÓŠˆÇâ« = $fÛğ´ÀéŒ÷[7]; goto DÍ“óñù; b¾«‰òœ‚Ÿ: $fÛğ´ÀéŒ÷ =& $_SERVER[¬¦ã¾]; $FóÄô¶’ó­ = KodIO::fileTypeList(); $fƒí†ïø³© = $FóÄô¶’ó­[$bá¤©ˆÁ¿õ]; goto D‹ãğ”£¾; DÍ“óñù: if (!$fƒí†ïø³©[$fÛğ´ÀéŒ÷[168]]) { $bÊ¦µ ä±Ì = array_to_keyvalue($FóÄô¶’ó­, $fÛğ´ÀéŒ÷[33], $fÛğ´ÀéŒ÷[168]); $C¶¥Ö„Ÿ¯Á = implode($fÛğ´ÀéŒ÷[47], $bÊ¦µ ä±Ì); $A‹ÓŠˆÇâ« = $fÛğ´ÀéŒ÷[1928]; } $E‡º›¥Ş·• = explode($fÛğ´ÀéŒ÷[47], trim($C¶¥Ö„Ÿ¯Á, $fÛğ´ÀéŒ÷[47])); return array($A‹ÓŠˆÇâ«, $E‡º›¥Ş·•); goto FÈ…µçª; FÈ…µçª: } public function listPathType($aÌØÄ•øò¾) { $c´Şô³´‹Š =& $_SERVER[¬¦ã¾]; $bØ¥ÛìŠ« = $this->fileTypeWhere($aÌØÄ•øò¾); if (!$bØ¥ÛìŠ«) { return array(); } $Eƒ×¨“ÎÛš = array($c´Şô³´‹Š[549] => SourceModel::TYPE_USER, $c´Şô³´‹Š[550] => USER_ID, $c´Şô³´‹Š[546] => 0, $c´Şô³´‹Š[547] => $bØ¥ÛìŠ«); return $this->listSource($Eƒ×¨“ÎÛš); } public function listSearch($e®Ó–‚›æ¼, $e„¶¶ÌÆ = 300) { goto BÊğéœáøÅ; e„š¸ùÎò«: $a­À•ùİ¶ = $this->distinct(!0)->field($Dß»©Ä¾¹®)->where($A¸Ì„ê­ª‰)->selectPage($e„¶¶ÌÆ); $this->_listSearchFileContent($a­À•ùİ¶, $e®Ó–‚›æ¼, $dí‚î°²); $this->_listSearchDesc($a­À•ùİ¶, $e®Ó–‚›æ¼, $dí‚î°²); goto AÇíÓˆ‘˜¿; döËë•¹³×: $this->_listMake($a­À•ùİ¶); return $a­À•ùİ¶; goto E…‚Š¥‚·; AÇíÓˆ‘˜¿: $this->_listSearchTag($a­À•ùİ¶, $e®Ó–‚›æ¼, $dí‚î°²); $this->_listSearchGroupTag($a­À•ùİ¶, $e®Ó–‚›æ¼, $dí‚î°²); $this->_listDataApply($a­À•ùİ¶[$D•¢â‰š§©[367]]); goto döËë•¹³×; D§‡ŠœÑ£: if (!isset($A¸Ì„ê­ª‰[$D•¢â‰š§©[423]])) { $A¸Ì„ê­ª‰[$D•¢â‰š§©[423]] = 0; } $Dß»©Ä¾¹® = $D•¢â‰š§©[1930]; $dí‚î°² = $Dß»©Ä¾¹®; goto C„÷Ø‹ŞÛ; BÊğéœáøÅ: $D•¢â‰š§© =& $_SERVER[¬¦ã¾]; if (isset($e®Ó–‚›æ¼[$D•¢â‰š§©[1771]]) && $e®Ó–‚›æ¼[$D•¢â‰š§©[1771]]) { $e®Ó–‚›æ¼[$D•¢â‰š§©[1771]] = str_replace($D•¢â‰š§©[381], $D•¢â‰š§©[1929], trim($e®Ó–‚›æ¼[$D•¢â‰š§©[1771]])); } $A¸Ì„ê­ª‰ = $this->_parseSearchWhere($e®Ó–‚›æ¼); goto D§‡ŠœÑ£; C„÷Ø‹ŞÛ: $this->_listSearchBindPinyin($e®Ó–‚›æ¼, $A¸Ì„ê­ª‰, $Dß»©Ä¾¹®); $this->alias($D•¢â‰š§©[516])->_makeOrder(); $A¸Ì„ê­ª‰ = $this->parseWhereLike($A¸Ì„ê­ª‰); goto e„š¸ùÎò«; E…‚Š¥‚·: } private function _listSearchFileContent(&$eåìÂŸÊ¦‰, $F…İ‘´Æ–Ä, $B¸òÁº‰ùœ) { goto aÌÄ”›Éà; f¡ƒ¾‰À„: unset($F…İ‘´Æ–Ä[$e—ÃÎŠ¡äµ[447]]); $a¸Ÿ¬¥Õ‚ = $this->field($B¸òÁº‰ùœ)->where($Fî¥å¤¼©)->limit($e—ÃÎŠ¡äµ[1931])->select(); if (!$a¸Ÿ¬¥Õ‚ || count($a¸Ÿ¬¥Õ‚) == 0) { return; } goto Bõ‰Â‚…Ò; aÌÄ”›Éà: $e—ÃÎŠ¡äµ =& $_SERVER[¬¦ã¾]; if (!$F…İ‘´Æ–Ä[$e—ÃÎŠ¡äµ[1771]] || $eåìÂŸÊ¦‰[$e—ÃÎŠ¡äµ[364]][$e—ÃÎŠ¡äµ[351]] > 1) { return; } $Fî¥å¤¼© = $this->_parseSearchWhere($F…İ‘´Æ–Ä); goto CƒÑêˆØø; Bõ‰Â‚…Ò: $eåìÂŸÊ¦‰[$e—ÃÎŠ¡äµ[367]] = array_merge($a¸Ÿ¬¥Õ‚, $eåìÂŸÊ¦‰[$e—ÃÎŠ¡äµ[367]]); $eåìÂŸÊ¦‰[$e—ÃÎŠ¡äµ[364]][$e—ÃÎŠ¡äµ[365]] += count($a¸Ÿ¬¥Õ‚); goto cÊ—ßº; CƒÑêˆØø: if (!isset($Fî¥å¤¼©[$e—ÃÎŠ¡äµ[28]]) || !is_array($F…İ‘´Æ–Ä[$e—ÃÎŠ¡äµ[447]])) { return; } $Fî¥å¤¼©[$e—ÃÎŠ¡äµ[447]] = array($e—ÃÎŠ¡äµ[7], $F…İ‘´Æ–Ä[$e—ÃÎŠ¡äµ[447]]); unset($Fî¥å¤¼©[$e—ÃÎŠ¡äµ[28]]); goto f¡ƒ¾‰À„; cÊ—ßº: } private function _listSearchTag(&$D‹¿‰íí†®, $Fè¥çŒ¡¶, $dî‡è÷ÀÛØ) { goto d“Æ¸ÅçòÂ; f¢Àò•àíã: $F„–„¿ì×š = array(); $Dİ„‘í³µÇ = $Fè¥çŒ¡¶[$FŠ‰Æçêˆ†[1771]]; foreach ($AÛˆ„Æë²‹ as $bµ’‘”¬™·) { $CÁõ¸óê´ç = $bµ’‘”¬™·[$FŠ‰Æçêˆ†[28]]; $DÕ»Œ‡¬¹« = str_replace($FŠ‰Æçêˆ†[50], $FŠ‰Æçêˆ†[33], Pinyin::encode($CÁõ¸óê´ç)); if (stripos($CÁõ¸óê´ç, $Dİ„‘í³µÇ) !== !1 || stripos($DÕ»Œ‡¬¹«, $Dİ„‘í³µÇ) !== !1) { $F„–„¿ì×š[] = $bµ’‘”¬™·[$FŠ‰Æçêˆ†[393]]; } } goto eÅ¬¸†ã»ø; BìŒèšŠë: $dˆš§âåš = array_to_keyvalue($dˆš§âåš, $FŠ‰Æçêˆ†[33], $FŠ‰Æçêˆ†[76]); $D ‚š½Å­ = array_unique($dˆš§âåš); $this->_listSearchMerge($D‹¿‰íí†®, $Fè¥çŒ¡¶, $dî‡è÷ÀÛØ, $D ‚š½Å­); goto eÒ©‹ÈÑÃğ; d“Æ¸ÅçòÂ: $FŠ‰Æçêˆ† =& $_SERVER[¬¦ã¾]; if (!$Fè¥çŒ¡¶[$FŠ‰Æçêˆ†[1771]] || $D‹¿‰íí†®[$FŠ‰Æçêˆ†[364]][$FŠ‰Æçêˆ†[351]] > 1) { return; } $AÛˆ„Æë²‹ = Model($FŠ‰Æçêˆ†[1932])->listData(); goto f¢Àò•àíã; eÅ¬¸†ã»ø: if (!$F„–„¿ì×š) { return; } $fÍ‰‹Õ© = array($FŠ‰Æçêˆ†[419] => array($FŠ‰Æçêˆ†[7], $F„–„¿ì×š), $FŠ‰Æçêˆ†[1520] => USER_ID); $dˆš§âåš = Model($FŠ‰Æçêˆ†[420])->field($FŠ‰Æçêˆ†[76])->where($fÍ‰‹Õ©)->select(); goto BìŒèšŠë; eÒ©‹ÈÑÃğ: } private function _listSearchDesc(&$F‹Ãò½Œ³, $fä¼œ×¯¤¤, $b‡Ö¨Ë²çÉ) { goto A½¦ÍÊö‹; d²Ò·©•–¶: $B¶½›‰— = Model($cí›×Ç™ˆÂ[532])->field($cí›×Ç™ˆÂ[395])->where($C­ÛğíĞºÑ)->select(); $a˜˜šê•‡° = array_to_keyvalue($B¶½›‰—, $cí›×Ç™ˆÂ[33], $cí›×Ç™ˆÂ[395]); $this->_listSearchMerge($F‹Ãò½Œ³, $fä¼œ×¯¤¤, $b‡Ö¨Ë²çÉ, $a˜˜šê•‡°); goto DÀĞ†Ò™å; CÎŠ‚œ›¿: $Fº¹éåÓºâ = array_unique($Fº¹éåÓºâ); if (!$Fº¹éåÓºâ) { return; } $C­ÛğíĞºÑ = array($cí›×Ç™ˆÂ[395] => array($cí›×Ç™ˆÂ[7], $Fº¹éåÓºâ), $cí›×Ç™ˆÂ[93] => $cí›×Ç™ˆÂ[431], $cí›×Ç™ˆÂ[372] => array($cí›×Ç™ˆÂ[380], $cí›×Ç™ˆÂ[1773] . $fä¼œ×¯¤¤[$cí›×Ç™ˆÂ[1771]] . $cí›×Ç™ˆÂ[1773])); goto d²Ò·©•–¶; A½¦ÍÊö‹: $cí›×Ç™ˆÂ =& $_SERVER[¬¦ã¾]; if (!$fä¼œ×¯¤¤[$cí›×Ç™ˆÂ[1771]] || $F‹Ãò½Œ³[$cí›×Ç™ˆÂ[364]][$cí›×Ç™ˆÂ[351]] > 1) { return; } $Fº¹éåÓºâ = $this->listSearchChildren($fä¼œ×¯¤¤[$cí›×Ç™ˆÂ[478]]); goto CÎŠ‚œ›¿; DÀĞ†Ò™å: } private function _listSearchGroupTag(&$fîèÌÇé®—, $AµŞåÜ¯“ó, $d†èø“Èêù) { goto f§ÇÊè‡»ø; CİÇë–™ó: $AÇ¾Ç»Øî = array_to_keyvalue($AÇ¾Ç»Øî, $DÃö¸³‘‹Á[33], $DÃö¸³‘‹Á[76]); $A•Õãƒ Ò˜ = array_unique($AÇ¾Ç»Øî); $this->_listSearchMerge($fîèÌÇé®—, $AµŞåÜ¯“ó, $d†èø“Èêù, $A•Õãƒ Ò˜); goto fÒä´¯Ë„; f§ÇÊè‡»ø: $DÃö¸³‘‹Á =& $_SERVER[¬¦ã¾]; if (!$AµŞåÜ¯“ó[$DÃö¸³‘‹Á[1771]] || $fîèÌÇé®—[$DÃö¸³‘‹Á[364]][$DÃö¸³‘‹Á[351]] > 1 || !$AµŞåÜ¯“ó[$DÃö¸³‘‹Á[478]]) { return; } $EíãÚÏíÏ¹ = $this->sourceInfo($AµŞåÜ¯“ó[$DÃö¸³‘‹Á[478]]); goto eÑ¾†‚æáƒ; fÅ±Ğ·ñê: $B„¼é…¡Éé = array(); $C£”‚Á”Ò› = $AµŞåÜ¯“ó[$DÃö¸³‘‹Á[1771]]; foreach ($Eö¹›¾†«[$DÃö¸³‘‹Á[367]] as $c÷‹’œÔ’‹) { $A¦²®·ƒ = $c÷‹’œÔ’‹[$DÃö¸³‘‹Á[28]]; $CÈİ¸ƒ…Ä­ = str_replace($DÃö¸³‘‹Á[50], $DÃö¸³‘‹Á[33], Pinyin::encode($A¦²®·ƒ)); if (stripos($A¦²®·ƒ, $C£”‚Á”Ò›) !== !1 || stripos($CÈİ¸ƒ…Ä­, $C£”‚Á”Ò›) !== !1) { $B„¼é…¡Éé[] = $c÷‹’œÔ’‹[$DÃö¸³‘‹Á[393]]; } } goto Eø´ÁˆÊì—; eÑ¾†‚æáƒ: if (!$EíãÚÏíÏ¹ || $EíãÚÏíÏ¹[$DÃö¸³‘‹Á[404]] != SourceModel::TYPE_GROUP) { return; } $b­õî»ÚÙ‡ = $EíãÚÏíÏ¹[$DÃö¸³‘‹Á[484]]; $Eö¹›¾†« = Model($DÃö¸³‘‹Á[1933])->get($b­õî»ÚÙ‡); goto fÅ±Ğ·ñê; Eø´ÁˆÊì—: if (!$B„¼é…¡Éé) { return; } $eæº ÌÄŒ¨ = array($DÃö¸³‘‹Á[419] => array($DÃö¸³‘‹Á[7], $B„¼é…¡Éé), $DÃö¸³‘‹Á[1520] => 0, $DÃö¸³‘‹Á[29] => $DÃö¸³‘‹Á[1795] . $b­õî»ÚÙ‡); $AÇ¾Ç»Øî = Model($DÃö¸³‘‹Á[420])->field($DÃö¸³‘‹Á[76])->where($eæº ÌÄŒ¨)->select(); goto CİÇë–™ó; fÒä´¯Ë„: } private function _listSearchMerge(&$f·…Ö È, $e¶­³«ÈÑ…, $AŒÁİÔ‡¾, $c‚ä¾§¾Óˆ) { goto D·À§ŞÉ¯Ù; bšÜåà¾ç±: $e„ĞÁ‡Ù•¨ = array_diff($c‚ä¾§¾Óˆ, $bÁ×¹‰İƒß); if (!$e„ĞÁ‡Ù•¨) { return; } $cŒŞßÒ›½ = array($e‹ÆƒÉå‡Í[395] => array($e‹ÆƒÉå‡Í[7], $e„ĞÁ‡Ù•¨)); goto CÈç“®ÖÙ; D·À§ŞÉ¯Ù: $e‹ÆƒÉå‡Í =& $_SERVER[¬¦ã¾]; if (!$c‚ä¾§¾Óˆ) { return; } $bÁ×¹‰İƒß = array_to_keyvalue($f·…Ö È[$e‹ÆƒÉå‡Í[367]], $e‹ÆƒÉå‡Í[33], $e‹ÆƒÉå‡Í[395]); goto bšÜåà¾ç±; cÑ’ÕŒĞ—”: foreach ($fŸõĞ˜šÇ as $e‚“äƒ’¦Õ) { if ($this->_listSearchFilter($e‚“äƒ’¦Õ, $e¶­³«ÈÑ…)) { $aÚÂ×Ú˜Ï[] = $e‚“äƒ’¦Õ; } } $f·…Ö È[$e‹ÆƒÉå‡Í[367]] = array_merge($aÚÂ×Ú˜Ï, $f·…Ö È[$e‹ÆƒÉå‡Í[367]]); $f·…Ö È[$e‹ÆƒÉå‡Í[364]][$e‹ÆƒÉå‡Í[365]] += count($aÚÂ×Ú˜Ï); goto FÍ¥ë†åó¥; CÈç“®ÖÙ: $fŸõĞ˜šÇ = $this->field($AŒÁİÔ‡¾)->where($cŒŞßÒ›½)->select(); if (!$fŸõĞ˜šÇ) { return; } $aÚÂ×Ú˜Ï = array(); goto cÑ’ÕŒĞ—”; FÍ¥ë†åó¥: } private function _listSearchFilter($C’„Ñ†»²÷, $AŞŠ‚²—­Å) { goto a ‰å”æë‰; a ‰å”æë‰: $dÒ»‰›¥àá =& $_SERVER[¬¦ã¾]; $b…¥¦†É²¹ = $C’„Ñ†»²÷[$dÒ»‰›¥àá[403]] == $dÒ»‰›¥àá[87]; if (!strstr($C’„Ñ†»²÷[$dÒ»‰›¥àá[487]], $dÒ»‰›¥àá[47] . $AŞŠ‚²—­Å[$dÒ»‰›¥àá[478]] . $dÒ»‰›¥àá[47])) { return !1; } goto e±ÖÒÓ„Ä‰; e±ÖÒÓ„Ä‰: if (isset($AŞŠ‚²—­Å[$dÒ»‰›¥àá[405]]) && $AŞŠ‚²—­Å[$dÒ»‰›¥àá[405]] != $dÒ»‰›¥àá[1738]) { if ($AŞŠ‚²—­Å[$dÒ»‰›¥àá[405]] == $dÒ»‰›¥àá[77] && !$b…¥¦†É²¹) { return !1; } if ($AŞŠ‚²—­Å[$dÒ»‰›¥àá[405]] != $dÒ»‰›¥àá[77] && $b…¥¦†É²¹) { return !1; } if (!strstr($C’„Ñ†»²÷[$dÒ»‰›¥àá[168]], $dÒ»‰›¥àá[47] . $AŞŠ‚²—­Å[$dÒ»‰›¥àá[405]] . $dÒ»‰›¥àá[47])) { return !1; } } if (isset($AŞŠ‚²—­Å[$dÒ»‰›¥àá[1934]]) && $AŞŠ‚²—­Å[$dÒ»‰›¥àá[1934]] < $C’„Ñ†»²÷[$dÒ»‰›¥àá[78]]) { return !1; } if (isset($AŞŠ‚²—­Å[$dÒ»‰›¥àá[1935]]) && $AŞŠ‚²—­Å[$dÒ»‰›¥àá[1935]] > $C’„Ñ†»²÷[$dÒ»‰›¥àá[78]]) { return !1; } goto E‡ÆÏºÃõ´; E‡ÆÏºÃõ´: if (isset($AŞŠ‚²—­Å[$dÒ»‰›¥àá[562]]) && $AŞŠ‚²—­Å[$dÒ»‰›¥àá[562]] != $C’„Ñ†»²÷[$dÒ»‰›¥àá[434]]) { return !1; } return !0; goto AÂáîŠÙ½; AÂáîŠÙ½: } public function listSearchChildren($B¢–½äœ’, $AÕ‰Éœë = 5000) { goto EÀ‘›¢›…; f·Øœ®çœØ: $E–íİ¨±ÙÖ = array($d¯·Œ¸Î‘‚[487] => array($d¯·Œ¸Î‘‚[380], $c§ˆÃ´¼[$d¯·Œ¸Î‘‚[487]] . $c§ˆÃ´¼[$d¯·Œ¸Î‘‚[395]] . $d¯·Œ¸Î‘‚[513])); $eÇ¿ºãÚˆ§ = $this->field($d¯·Œ¸Î‘‚[395])->cache(null, 600)->where($E–íİ¨±ÙÖ)->count(); if ($eÇ¿ºãÚˆ§ > $AÕ‰Éœë) { return $this->_listSearchChildrenNear($B¢–½äœ’, $AÕ‰Éœë); } goto EƒÕ‰÷õ°»; EÀ‘›¢›…: $d¯·Œ¸Î‘‚ =& $_SERVER[¬¦ã¾]; $D¡ÔÖÎ”µ = array(); $c§ˆÃ´¼ = $this->sourceInfo($B¢–½äœ’); goto f·Øœ®çœØ; EƒÕ‰÷õ°»: $F³ˆöç¥¥ = $this->field($d¯·Œ¸Î‘‚[395])->where($E–íİ¨±ÙÖ)->select(); $D¡ÔÖÎ”µ = array_to_keyvalue($F³ˆöç¥¥, $d¯·Œ¸Î‘‚[33], $d¯·Œ¸Î‘‚[395]); return $D¡ÔÖÎ”µ; goto A›ù†œÓèœ; A›ù†œÓèœ: } private function _listSearchChildrenNear($Cİ‡Ì‰Êñ, $BïØßñËê) { goto aŞ˜¼İöÛ«; aŞ˜¼İöÛ«: $e˜œ«²¢§ =& $_SERVER[¬¦ã¾]; $BÛÒöÖ­ô… = array(); $Bç´Ä¿¬„ = array($e˜œ«²¢§[478] => $Cİ‡Ì‰Êñ); goto e½Ÿ—Ğ®—ç; C½ø·„åœÅ: if (!$Dîğ´‚—) { return $BÛÒöÖ­ô…; } $Bç´Ä¿¬„ = array($e˜œ«²¢§[478] => array($e˜œ«²¢§[7], $Dîğ´‚—)); $dËÆô—Èšî = $this->field($e˜œ«²¢§[1936])->where($Bç´Ä¿¬„)->limit($BïØßñËê)->select(); goto dù¾ºÅù—ï; e½Ÿ—Ğ®—ç: $dËÆô—Èšî = $this->field($e˜œ«²¢§[1936])->where($Bç´Ä¿¬„)->select(); $Dîğ´‚— = array_to_keyvalue(array_filter_by_field($dËÆô—Èšî, $e˜œ«²¢§[403], $e˜œ«²¢§[87]), $e˜œ«²¢§[33], $e˜œ«²¢§[395]); $BÛÒöÖ­ô… = array_merge($BÛÒöÖ­ô…, array_to_keyvalue($dËÆô—Èšî, $e˜œ«²¢§[33], $e˜œ«²¢§[395])); goto C½ø·„åœÅ; dù¾ºÅù—ï: $BÛÒöÖ­ô… = array_merge($BÛÒöÖ­ô…, array_to_keyvalue($dËÆô—Èšî, $e˜œ«²¢§[33], $e˜œ«²¢§[395])); $BÛÒöÖ­ô… = array_slice($BÛÒöÖ­ô…, 0, $BïØßñËê); return $BÛÒöÖ­ô…; goto a˜¾÷¬Äéµ; a˜¾÷¬Äéµ: } private function _listSearchBindPinyin($a¹ÕÚÔ«È¦, &$FÑÅŒê¶Œ¢, &$B´Ê’“åå—) { goto EÁğ£Û‹’ù; Bµ‹àÀ¨Œµ: $FÑÅŒê¶Œ¢ = $e÷´“Œ™²¿; goto fç¦ëÔ›Ô‚; Eôã¯ê—æ: foreach ($FÑÅŒê¶Œ¢ as $côíÆ‡‰×Ñ => $C´éèÌÌÀö) { $e÷´“Œ™²¿[$eîêù¿­Á[1938] . $côíÆ‡‰×Ñ] = $C´éèÌÌÀö; } foreach ($aáÖ¨£ö®¿ as $d¶¥”ÀŠ¥Ê) { $e÷´“Œ™²¿[] = array($eîêù¿­Á[1940] => $d¶¥”ÀŠ¥Ê, $eîêù¿­Á[948] => $eîêù¿­Á[1775], array($eîêù¿­Á[1941] => $d¶¥”ÀŠ¥Ê, $eîêù¿­Á[1942] => array($eîêù¿­Á[7], array($eîêù¿­Á[444], $eîêù¿­Á[443])))); } $this->join($b‚ˆÀ¼’†Ã); goto Bµ‹àÀ¨Œµ; c§÷÷ÑÆæ: $B´Ê’“åå— = $eîêù¿­Á[1938] . str_replace($eîêù¿­Á[47], $eîêù¿­Á[1939], $B´Ê’“åå—); $aáÖ¨£ö®¿ = $FÑÅŒê¶Œ¢[$eîêù¿­Á[28]]; unset($FÑÅŒê¶Œ¢[$eîêù¿­Á[28]]); goto Eôã¯ê—æ; EÁğ£Û‹’ù: $eîêù¿­Á =& $_SERVER[¬¦ã¾]; if (!isset($a¹ÕÚÔ«È¦[$eîêù¿­Á[1771]]) || !$a¹ÕÚÔ«È¦[$eîêù¿­Á[1771]]) { return; } if (!Input::check($a¹ÕÚÔ«È¦[$eîêù¿­Á[1771]], $eîêù¿­Á[316]) || strlen($a¹ÕÚÔ«È¦[$eîêù¿­Á[1771]]) < 2) { return; } goto F÷¯¨±Á”º; F÷¯¨±Á”º: $b‚ˆÀ¼’†Ã = "\114\x45\106\x54\40\112\117\x49\x4e\40{$this->tablePrefix}\x69\157\x5f\x73\157\165\162\143\145\137\155\x65\164\x61\40\x6d\x65\164\x61\40\157\156\40\x73\x6f\x75\x72\x63\145\x2e\x73\x6f\165\x72\143\x65\111\104\40\75\40\x6d\x65\x74\141\x2e\163\157\x75\162\143\145\111\104"; $e÷´“Œ™²¿ = array(); $B´Ê’“åå— = str_replace(array($eîêù¿­Á[229], $eîêù¿­Á[50], $eîêù¿­Á[1937]), $eîêù¿­Á[33], $B´Ê’“åå—); goto c§÷÷ÑÆæ; fç¦ëÔ›Ô‚: } private function _parseSearchWhere($föÉ°ÁâÃ) { goto fÆ½àŒÌ—Ì; EÅ¬İ“é†: if (isset($föÉ°ÁâÃ[$c‹Ç¿ˆù[1771]]) && trim($föÉ°ÁâÃ[$c‹Ç¿ˆù[1771]])) { $DÔ¥îóÍ»¦ = trim($föÉ°ÁâÃ[$c‹Ç¿ˆù[1771]]); $D¶¤Éè¦‘Ñ = explode($c‹Ç¿ˆù[50], $DÔ¥îóÍ»¦); if (strlen($DÔ¥îóÍ»¦) > 2 && (substr($DÔ¥îóÍ»¦, 0, 1) == $c‹Ç¿ˆù[116] && substr($DÔ¥îóÍ»¦, -1) == $c‹Ç¿ˆù[116]) || substr($DÔ¥îóÍ»¦, 0, 1) == $c‹Ç¿ˆù[55] && substr($DÔ¥îóÍ»¦, -1) == $c‹Ç¿ˆù[55]) { $DÔ¥îóÍ»¦ = substr($DÔ¥îóÍ»¦, 1, -1); $D¶¤Éè¦‘Ñ = array($DÔ¥îóÍ»¦); } $e©È™æš¡…[$c‹Ç¿ˆù[28]] = array(array($c‹Ç¿ˆù[512], $c‹Ç¿ˆù[1773] . $DÔ¥îóÍ»¦ . $c‹Ç¿ˆù[1773])); if (count($D¶¤Éè¦‘Ñ) > 1) { $e©È™æš¡…[$c‹Ç¿ˆù[28]] = array(); foreach ($D¶¤Éè¦‘Ñ as $dÚ…‡†¦×) { if (!trim($dÚ…‡†¦×)) { continue; } $e©È™æš¡…[$c‹Ç¿ˆù[28]][] = array($c‹Ç¿ˆù[512], $c‹Ç¿ˆù[1773] . trim($dÚ…‡†¦×) . $c‹Ç¿ˆù[1773]); } } } return $e©È™æš¡…; goto Càè«Õ¿­Í; Aòì¡à–é¥: if (isset($föÉ°ÁâÃ[$c‹Ç¿ˆù[476]]) && $föÉ°ÁâÃ[$c‹Ç¿ˆù[476]]) { $c‘ã´¥ÕÎ¤ = array($c‹Ç¿ˆù[1944], $föÉ°ÁâÃ[$c‹Ç¿ˆù[476]]); if ($e©È™æš¡…[$c‹Ç¿ˆù[84]]) { $e©È™æš¡…[$c‹Ç¿ˆù[84]] = array($e©È™æš¡…[$c‹Ç¿ˆù[84]], $c‘ã´¥ÕÎ¤, $c‹Ç¿ˆù[1945]); } else { $e©È™æš¡…[$c‹Ç¿ˆù[84]] = $c‘ã´¥ÕÎ¤; } } if (isset($föÉ°ÁâÃ[$c‹Ç¿ˆù[1934]]) && $föÉ°ÁâÃ[$c‹Ç¿ˆù[1934]] > 0) { $e©È™æš¡…[$c‹Ç¿ˆù[78]] = array($c‹Ç¿ˆù[1943], $föÉ°ÁâÃ[$c‹Ç¿ˆù[1934]]); } if (isset($föÉ°ÁâÃ[$c‹Ç¿ˆù[1935]]) && $föÉ°ÁâÃ[$c‹Ç¿ˆù[1935]]) { $c‘ã´¥ÕÎ¤ = array($c‹Ç¿ˆù[1944], $föÉ°ÁâÃ[$c‹Ç¿ˆù[1935]]); if ($e©È™æš¡…[$c‹Ç¿ˆù[78]]) { $e©È™æš¡…[$c‹Ç¿ˆù[78]] = array($e©È™æš¡…[$c‹Ç¿ˆù[78]], $c‘ã´¥ÕÎ¤, $c‹Ç¿ˆù[1945]); } else { $e©È™æš¡…[$c‹Ç¿ˆù[78]] = $c‘ã´¥ÕÎ¤; } } goto EµÜ›œÑ; fÆ½àŒÌ—Ì: $c‹Ç¿ˆù =& $_SERVER[¬¦ã¾]; $e©È™æš¡… = array(); if (isset($föÉ°ÁâÃ[$c‹Ç¿ˆù[713]]) && $föÉ°ÁâÃ[$c‹Ç¿ˆù[713]]) { $e©È™æš¡…[$c‹Ç¿ˆù[84]] = array($c‹Ç¿ˆù[1943], $föÉ°ÁâÃ[$c‹Ç¿ˆù[713]]); } goto Aòì¡à–é¥; EµÜ›œÑ: if (isset($föÉ°ÁâÃ[$c‹Ç¿ˆù[562]]) && $föÉ°ÁâÃ[$c‹Ç¿ˆù[562]]) { $e©È™æš¡…[] = array($c‹Ç¿ˆù[434] => $föÉ°ÁâÃ[$c‹Ç¿ˆù[562]], $c‹Ç¿ˆù[432] => $föÉ°ÁâÃ[$c‹Ç¿ˆù[562]], $c‹Ç¿ˆù[948] => $c‹Ç¿ˆù[1775]); } if (isset($föÉ°ÁâÃ[$c‹Ç¿ˆù[405]]) && $föÉ°ÁâÃ[$c‹Ç¿ˆù[405]]) { $fäïÕªî¬ = $föÉ°ÁâÃ[$c‹Ç¿ˆù[405]]; if ($fäïÕªî¬ == $c‹Ç¿ˆù[77]) { $e©È™æš¡…[$c‹Ç¿ˆù[403]] = 1; } else { if ($fäïÕªî¬ == $c‹Ç¿ˆù[1946]) { $e©È™æš¡…[$c‹Ç¿ˆù[403]] = 0; } else { if ($fäïÕªî¬) { $fäïÕªî¬ = is_array($fäïÕªî¬) ? $fäïÕªî¬ : explode($c‹Ç¿ˆù[47], $fäïÕªî¬); $e©È™æš¡…[$c‹Ç¿ˆù[405]] = array($c‹Ç¿ˆù[411], $fäïÕªî¬); $e©È™æš¡…[$c‹Ç¿ˆù[403]] = 0; } } } } if (isset($föÉ°ÁâÃ[$c‹Ç¿ˆù[478]]) && $föÉ°ÁâÃ[$c‹Ç¿ˆù[478]]) { $b«õÛˆ¨Øç = $this->sourceInfo($föÉ°ÁâÃ[$c‹Ç¿ˆù[478]]); $e©È™æš¡…[$c‹Ç¿ˆù[553]] = array($c‹Ç¿ˆù[512], $b«õÛˆ¨Øç[$c‹Ç¿ˆù[487]] . $föÉ°ÁâÃ[$c‹Ç¿ˆù[478]] . $c‹Ç¿ˆù[513]); } goto EÅ¬İ“é†; Càè«Õ¿­Í: } } class SourceModel extends SourceListSearchModel { public $statusIgnoreResetSpace = false; public function userRootAdd($EŸÃ–Ùƒ…) { $aÈØ¥ìÛ =& $_SERVER[¬¦ã¾]; $EÊ—Ãâ¤¥Í = Model($aÈØ¥ìÛ[502])->where(array($aÈØ¥ìÛ[1512] => $EŸÃ–Ùƒ…))->find(); $E¾ì“ÑİÎš = $this->_mkdirRoot(SourceModel::TYPE_USER, $EŸÃ–Ùƒ…, $EÊ—Ãâ¤¥Í[$aÈØ¥ìÛ[28]]); $this->userDesktopAdd($E¾ì“ÑİÎš); return $E¾ì“ÑİÎš; } public function userDesktopAdd($båö£Š’‹Ñ) { $BŠºçäÑÑ =& $_SERVER[¬¦ã¾]; $E†¬ çßñ© = LNG($BŠºçäÑÑ[1947]); $d–·î¦èØ¹ = $this->mkdir($båö£Š’‹Ñ, $E†¬ çßñ©); $this->metaSet($d–·î¦èØ¹, $BŠºçäÑÑ[1948], $BŠºçäÑÑ[87]); $this->metaSet($båö£Š’‹Ñ, $BŠºçäÑÑ[1949], $d–·î¦èØ¹); } public function groupRootAdd($aöÚ‡È¥Ùá) { $a‡ä†¿÷Ûà =& $_SERVER[¬¦ã¾]; $B²É‹”àß‡ = Model($a‡ä†¿÷Ûà[486])->where(array($a‡ä†¿÷Ûà[1766] => $aöÚ‡È¥Ùá))->find(); return $this->_mkdirRoot(SourceModel::TYPE_GROUP, $aöÚ‡È¥Ùá, $B²É‹”àß‡[$a‡ä†¿÷Ûà[28]]); } public function systemRootPathAdd($BíÍ°ÁÌå) { if ($BíÍ°ÁÌå != $_SERVER[¬¦ã¾][505]) { return !1; } return $this->_mkdirRoot(SourceModel::TYPE_SYSTEM, 0, $BíÍ°ÁÌå); } public function userRootRemove($fõ§‰œÄêâ) { $cÂƒ¸“ËÃ‹ = $this->sourceRoot(SourceModel::TYPE_USER, $fõ§‰œÄêâ); if (!$cÂƒ¸“ËÃ‹) { return; } $this->remove($cÂƒ¸“ËÃ‹, !1); } public function groupRootRemove($b¨è¹•÷æÄ) { $bÑêÒŠ‰Œ = $this->sourceRoot(SourceModel::TYPE_GROUP, $b¨è¹•÷æÄ); if (!$bÑêÒŠ‰Œ) { return; } $this->remove($bÑêÒŠ‰Œ, !1); } private function _mkdirRoot($E˜ƒ¨éä‰Œ, $FŠ«¿¢£«, $e÷Ñé”Æêõ) { goto BëÚàÏ¬Š; BëÚàÏ¬Š: $AğÉ©ç“›È =& $_SERVER[¬¦ã¾]; $eˆ„¨ÖÏˆª = array($AğÉ©ç“›È[394] => 0, $AğÉ©ç“›È[549] => $E˜ƒ¨éä‰Œ, $AğÉ©ç“›È[550] => $FŠ«¿¢£«, $AğÉ©ç“›È[546] => 1, $AğÉ©ç“›È[551] => USER_ID, $AğÉ©ç“›È[552] => USER_ID, $AğÉ©ç“›È[547] => $AğÉ©ç“›È[33], $AğÉ©ç“›È[553] => $AğÉ©ç“›È[498], $AğÉ©ç“›È[422] => 0, $AğÉ©ç“›È[548] => 0, $AğÉ©ç“›È[448] => 0, $AğÉ©ç“›È[554] => $AğÉ©ç“›È[33]); if ($cëŠà®ßºë = $this->where($eˆ„¨ÖÏˆª)->find()) { return $cëŠà®ßºë[$AğÉ©ç“›È[395]]; } goto a™èçÂÍ›; eà¡â•â‹×: $Dï¨´ÌÀŠí = $this->add($eˆ„¨ÖÏˆª); $d‡ËÆÏ¹ßî = array($AğÉ©ç“›È[555] => short_id($Dï¨´ÌÀŠí)); $this->where(array($AğÉ©ç“›È[410] => $Dï¨´ÌÀŠí))->save($d‡ËÆÏ¹ßî); goto D Í‹…øÛ; a™èçÂÍ›: $BæÒïğÆ• = "\x4d\x6f\144\x65\154\x53\x6f\165\x72\143\x65\x2e\x6d\153\144\151\x72\x52\x6f\157\164\x2e{$E˜ƒ¨éä‰Œ}\x2e{$FŠ«¿¢£«}\56" . $e÷Ñé”Æêõ; CacheLock::lock($BæÒïğÆ•); $eˆ„¨ÖÏˆª[$AğÉ©ç“›È[28]] = $e÷Ñé”Æêõ; goto eà¡â•â‹×; D Í‹…øÛ: CacheLock::unlock($BæÒïğÆ•); return $Dï¨´ÌÀŠí; goto B­ö§óéÅÛ; B­ö§óéÅÛ: } private function sourceRoot($c²ˆÜŸÓĞ, $AèÅ²¼ÙÜÅ, $b‚òœôÒÏò = false) { $cÛ¼Ù»³† =& $_SERVER[¬¦ã¾]; $dàº½¤Ñ¿¾ = array($cÛ¼Ù»³†[394] => 0, $cÛ¼Ù»³†[549] => $c²ˆÜŸÓĞ, $cÛ¼Ù»³†[550] => $AèÅ²¼ÙÜÅ); if ($d­’¾°½Ë´ = $this->where($dàº½¤Ñ¿¾)->find()) { return $b‚òœôÒÏò ? $d­’¾°½Ë´ : $d­’¾°½Ë´[$cÛ¼Ù»³†[395]]; } return !1; } public function sourceRootGroup($aæÉŠÏÇŒ‡) { goto C›‚àØîñÃ; Bç‰˜İ¢—Ì: $this->selectPageReset(); $BØØÀ©‰‚ = $this->listSource($bæ³¬·«ù, 1000); $this->selectPageRestore(); goto Eæ¼³ˆÊ; C›‚àØîñÃ: $A»¨‚Ü²¡… =& $_SERVER[¬¦ã¾]; if (is_string($aæÉŠÏÇŒ‡)) { $aæÉŠÏÇŒ‡ = array($aæÉŠÏÇŒ‡); } $bæ³¬·«ù = array($A»¨‚Ü²¡…[394] => 0, $A»¨‚Ü²¡…[549] => SourceModel::TYPE_GROUP, $A»¨‚Ü²¡…[550] => array($A»¨‚Ü²¡…[7], $aæÉŠÏÇŒ‡)); goto Bç‰˜İ¢—Ì; Eæ¼³ˆÊ: return array_to_keyvalue($BØØÀ©‰‚[$A»¨‚Ü²¡…[75]], $A»¨‚Ü²¡…[484]); goto dÉàÔ” ¿±; dÉàÔ” ¿±: } public function mkfile($Aö±ƒƒ‹¢–, $CŒ†®ò£·Ù, $eóğœ‹’£Œ = '', $Fòé’óñĞô = REPEAT_RENAME) { $e‘ÌÉÆİÁï =& $_SERVER[¬¦ã¾]; $E‘èŸîóš½ = Model($e‘ÌÉÆİÁï[571])->addFileByContent($eóğœ‹’£Œ, $CŒ†®ò£·Ù); return $this->_createFileCall($Aö±ƒƒ‹¢–, $CŒ†®ò£·Ù, $E‘èŸîóš½, $Fòé’óñĞô, $e‘ÌÉÆİÁï[1207]); } public function addFile($D¢£ó´±ÙŸ, $Föêå©‚”İ, $DÙàãø¸£™, $f‚Ã’­Ø = false, $F»°÷’‰šë = REPEAT_RENAME) { $aİ•ê„òÆ = Model($_SERVER[¬¦ã¾][571])->addFile($Föêå©‚”İ, $DÙàãø¸£™, $f‚Ã’­Ø); return $this->_createFileCall($D¢£ó´±ÙŸ, $DÙàãø¸£™, $aİ•ê„òÆ, $F»°÷’‰šë); } public function addFileByFileID($fö³æ†Ê°Ì, $aÙ˜™«¸˜Ê, $Eªñââ«Â, $cÉƒ†¥ÓùÂ = REPEAT_RENAME) { $F¯’ôœÓ¨ =& $_SERVER[¬¦ã¾]; $b¦Ç®ˆ¶‹ä = Model($F¯’ôœÓ¨[571])->find($aÙ˜™«¸˜Ê); Model($F¯’ôœÓ¨[571])->linkAdd($aÙ˜™«¸˜Ê); return $this->_createFileCall($fö³æ†Ê°Ì, $Eªñââ«Â, $b¦Ç®ˆ¶‹ä, $cÉƒ†¥ÓùÂ); } public function addFileByRemote($bÁêÖ½ˆç, $DĞÄÕù×ÂØ, $eÄôõ±ñ†‰, $a›æÎ³Óï = array(), $dêô®¼†¨´ = REPEAT_RENAME) { $B¹³ªÜ£ëˆ = Model($_SERVER[¬¦ã¾][571])->addFileByRemote($DĞÄÕù×ÂØ, $eÄôõ±ñ†‰, $a›æÎ³Óï); return $this->_createFileCall($bÁêÖ½ˆç, $eÄôõ±ñ†‰, $B¹³ªÜ£ëˆ, $dêô®¼†¨´); } private function _createFileCall($fİ«´Áòà», $eˆ®Şßù, $CéÙñ·Ø›ª, $c°Â¼Ö¾², $bù°ˆÎ’™ = "\165\160\x6c\x6f\x61\x64") { goto Dä¯öÆöõØ; Eò†´İÁ½: $f†‹¹„îÙâ = $this->fileNameExist($fİ«´Áòà», $eˆ®Şßù); $e‹„†Ç‰ÃÕ = $this->_createFile($fİ«´Áòà», $eˆ®Şßù, $CéÙñ·Ø›ª, $c°Â¼Ö¾², $fè¡®º­ñÔ); if (!$fè¡®º­ñÔ) { Model($EìùäŸ„ÉË[450])->remove($CéÙñ·Ø›ª[$EìùäŸ„ÉË[447]]); } goto bÓÁä„°£; bÓÁä„°£: if ($fè¡®º­ñÔ && $e‹„†Ç‰ÃÕ && $e‹„†Ç‰ÃÕ != $f†‹¹„îÙâ) { Model($EìùäŸ„ÉË[1918])->eventCreate($e‹„†Ç‰ÃÕ, $bù°ˆÎ’™); } $this->lockWriteEnd($fİ«´Áòà», $eˆ®Şßù); return $e‹„†Ç‰ÃÕ; goto b™ÏŒ˜êÇ; Dä¯öÆöõØ: $EìùäŸ„ÉË =& $_SERVER[¬¦ã¾]; $fè¡®º­ñÔ = !1; $this->lockWriteStart($fİ«´Áòà», $eˆ®Şßù); goto Eò†´İÁ½; b™ÏŒ˜êÇ: } public function mkdir($b†¡¬¦®©„, $Dğ¾ø×±ì, $d‘éÌåâİˆ = REPEAT_SKIP) { goto fÛ«†–é´Š; cİæ‹ö·²: $this->lockWriteStart($b†¡¬¦®©„, $Dğ¾ø×±ì); if ($d‘éÌåâİˆ !== !1) { $A÷Ì…µØÑ = $this->fileNameExist($b†¡¬¦®©„, $Dğ¾ø×±ì); if ($A÷Ì…µØÑ && $d‘éÌåâİˆ != REPEAT_RENAME_FOLDER) { $this->lockWriteEnd($b†¡¬¦®©„, $Dğ¾ø×±ì); return $A÷Ì…µØÑ; } $Dğ¾ø×±ì = $this->fileNameAuto($b†¡¬¦®©„, $Dğ¾ø×±ì, $d‘éÌåâİˆ); } $CÙ†›ÌØ¦” = array($aòÕˆ¥Î÷¯[546] => 1, $aòÕˆ¥Î÷¯[413] => $Dğ¾ø×±ì, $aòÕˆ¥Î÷¯[547] => $aòÕˆ¥Î÷¯[33], $aòÕˆ¥Î÷¯[448] => 0, $aòÕˆ¥Î÷¯[548] => 0); goto cîØµó±…; cîØµó±…: $aÂµ÷æÌ›î = $this->_addSoure($CÙ†›ÌØ¦”, $B×“Æ¥ĞÙÖ); Model($aòÕˆ¥Î÷¯[1918])->eventCreate($aÂµ÷æÌ›î, $aòÕˆ¥Î÷¯[1208]); $this->lockWriteEnd($b†¡¬¦®©„, $Dğ¾ø×±ì); goto Añ÷á’ÁàÜ; Añ÷á’ÁàÜ: return $aÂµ÷æÌ›î; goto aí»›ÚÒ›…; fÛ«†–é´Š: $aòÕˆ¥Î÷¯ =& $_SERVER[¬¦ã¾]; $B×“Æ¥ĞÙÖ = $this->sourceInfo($b†¡¬¦®©„); if (!$B×“Æ¥ĞÙÖ) { return !1; } goto cİæ‹ö·²; aí»›ÚÒ›…: } private function _createFile($fÂ„Ÿ¶—Í, $Eïğ“èÊÆÅ, $döÀª…ç, $b·’¸»ëää, &$A‚Æï¿ğ‰) { goto C‘ù´‡Ùš©; cªò×ïñ¢: if ($b·’¸»ëää !== !1) { $eõÅ…ô‘‡¸ = $this->fileNameExist($fÂ„Ÿ¶—Í, $Eïğ“èÊÆÅ); } $A‚Æï¿ğ‰ = !0; if ($b·’¸»ëää && $eõÅ…ô‘‡¸) { if ($b·’¸»ëää == REPEAT_SKIP) { $A‚Æï¿ğ‰ = !1; return $eõÅ…ô‘‡¸; } else { if ($b·’¸»ëää == REPEAT_REPLACE) { $bŸ¦œœô•Ç = $this->sourceInfo($eõÅ…ô‘‡¸); $BÖ­ï£šØ½ = $this->fileHistory($bŸ¦œœô•Ç, $döÀª…ç[$BâóøÃÙ[447]], $döÀª…ç[$BâóøÃÙ[78]]); if (!$BÖ­ï£šØ½) { $A‚Æï¿ğ‰ = !1; } else { $this->folderSizeReset($fÂ„Ÿ¶—Í); } return $eõÅ…ô‘‡¸; } else { $Eïğ“èÊÆÅ = $this->fileNameAuto($fÂ„Ÿ¶—Í, $Eïğ“èÊÆÅ, $b·’¸»ëää, !1); } } } goto fÍøÖÊ„•; fÍøÖÊ„•: $Fõ”¯—¹¡› = array($BâóøÃÙ[546] => 0, $BâóøÃÙ[413] => $Eïğ“èÊÆÅ, $BâóøÃÙ[547] => substr(get_path_ext($Eïğ“èÊÆÅ), 0, 10), $BâóøÃÙ[448] => $döÀª…ç[$BâóøÃÙ[447]], $BâóøÃÙ[548] => $döÀª…ç[$BâóøÃÙ[78]]); $a×åÒÂ´ = $this->_addSoure($Fõ”¯—¹¡›, $AÔ¬‰Ú„‚); $this->folderSizeReset($fÂ„Ÿ¶—Í, intval($Fõ”¯—¹¡›[$BâóøÃÙ[78]])); goto bô„½ÖŠ‘­; C‘ù´‡Ùš©: $BâóøÃÙ =& $_SERVER[¬¦ã¾]; $AÔ¬‰Ú„‚ = $this->sourceInfo($fÂ„Ÿ¶—Í); if (!$döÀª…ç || !$AÔ¬‰Ú„‚) { return !1; } goto cªò×ïñ¢; bô„½ÖŠ‘­: return $a×åÒÂ´; goto eŒèË‚‰Ùó; eŒèË‚‰Ùó: } protected function fileHistory($C½Šƒß‚„Œ, $D½óÕò½Ë×, $C‘Ù°Ò™½¬) { goto dòÀîõí‚; a±ÄøÂôİ: $this->where(array($FÏ¼†ÍÁ÷[410] => $C½Šƒß‚„Œ[$FÏ¼†ÍÁ÷[395]]))->save($aªì—Ü¦è); $this->sourceCacheClear($C½Šƒß‚„Œ[$FÏ¼†ÍÁ÷[395]]); return !0; goto e”ô« ª³œ; Cğãê¤Ğ§“: $this->checkLock($C½Šƒß‚„Œ[$FÏ¼†ÍÁ÷[395]], $D½óÕò½Ë×); Model($FÏ¼†ÍÁ÷[1950])->addHistory($C½Šƒß‚„Œ); $aªì—Ü¦è = array($FÏ¼†ÍÁ÷[552] => $a›É¦»ç, $FÏ¼†ÍÁ÷[417] => time(), $FÏ¼†ÍÁ÷[447] => $D½óÕò½Ë×, $FÏ¼†ÍÁ÷[78] => $C‘Ù°Ò™½¬); goto a±ÄøÂôİ; dòÀîõí‚: $FÏ¼†ÍÁ÷ =& $_SERVER[¬¦ã¾]; $a›É¦»ç = defined($FÏ¼†ÍÁ÷[454]) ? USER_ID : $FÏ¼†ÍÁ÷[191]; if ($C½Šƒß‚„Œ[$FÏ¼†ÍÁ÷[447]] == $D½óÕò½Ë×) { return !1; } goto Cğãê¤Ğ§“; e”ô« ª³œ: } public function checkLock($añÛÆåÕ‰Õ, $A‚êÛ‡œ³) { goto bëê„±Ÿ¨¦; eæñÁ¸¯ô: $this->_createFileCall($B‡ó†õ²Áö[$D„ÇÂ‚‰÷¬[478]], $AÁº®†ãçÑ, $a¥Ë‘ÆÖ¤Ë, REPEAT_REPLACE, $D„ÇÂ‚‰÷¬[1207]); $aÜ‹Ù¥‘ÈÚ = $B‡ó†õ²Áö[$D„ÇÂ‚‰÷¬[445]][$D„ÇÂ‚‰÷¬[510]]; $d­²éÜ º¦ = $aÜ‹Ù¥‘ÈÚ[$D„ÇÂ‚‰÷¬[1952]] ? $aÜ‹Ù¥‘ÈÚ[$D„ÇÂ‚‰÷¬[1952]] : $aÜ‹Ù¥‘ÈÚ[$D„ÇÂ‚‰÷¬[28]]; goto E„ÈÉÁêĞ¼; EÊ²ŠÌÀ¦ñ: $A˜Í…‰·ƒ = Session::get($D„ÇÂ‚‰÷¬[1951]); $AÁº®†ãçÑ = substr($B‡ó†õ²Áö[$D„ÇÂ‚‰÷¬[28]], 0, -1 - strlen($B‡ó†õ²Áö[$D„ÇÂ‚‰÷¬[168]])) . $D„ÇÂ‚‰÷¬[1473] . $A˜Í…‰·ƒ . $D„ÇÂ‚‰÷¬[95] . $B‡ó†õ²Áö[$D„ÇÂ‚‰÷¬[168]]; $a¥Ë‘ÆÖ¤Ë = Model($D„ÇÂ‚‰÷¬[571])->find($A‚êÛ‡œ³); goto eæñÁ¸¯ô; bëê„±Ÿ¨¦: $D„ÇÂ‚‰÷¬ =& $_SERVER[¬¦ã¾]; $B‡ó†õ²Áö = $this->pathInfo($añÛÆåÕ‰Õ); if (!$this->fileIsLock($B‡ó†õ²Áö, !0)) { return; } goto EÊ²ŠÌÀ¦ñ; E„ÈÉÁêĞ¼: show_json(LNG($D„ÇÂ‚‰÷¬[1953]) . $D„ÇÂ‚‰÷¬[1954] . LNG($D„ÇÂ‚‰÷¬[1955]) . $D„ÇÂ‚‰÷¬[1956] . $d­²éÜ º¦ . $D„ÇÂ‚‰÷¬[1957], !1); goto fÕ„®Æª´´; fÕ„®Æª´´: } public function fileIsLock($bÆØÅ¤ç¹, $A‚íÃ–ä‰µ = false) { goto C×÷ğå®“å; BÈˆÇ½Ş…¨: return !1; goto A»òÑ¾Ôœù; Cáµæ„§²Ä: $cº‹ÓÌàé’ = $GLOBALS[$aê§òôîå[6]][$aê§òôîå[88]][$aê§òôîå[508]]; if ($bÆØÅ¤ç¹[$aê§òôîå[445]][$aê§òôîå[509]] <= time() - $cº‹ÓÌàé’) { $this->metaSet($bÆØÅ¤ç¹[$aê§òôîå[395]], $aê§òôîå[507], null); $this->metaSet($bÆØÅ¤ç¹[$aê§òôîå[395]], $aê§òôîå[509], null); } if ($A‚íÃ–ä‰µ) { $this->metaSet($bÆØÅ¤ç¹[$aê§òôîå[395]], $aê§òôîå[509], time()); } goto BÈˆÇ½Ş…¨; C×÷ğå®“å: $aê§òôîå =& $_SERVER[¬¦ã¾]; if (!isset($bÆØÅ¤ç¹[$aê§òôîå[445]]) || !$bÆØÅ¤ç¹[$aê§òôîå[445]][$aê§òôîå[507]]) { return !1; } if ($bÆØÅ¤ç¹[$aê§òôîå[445]][$aê§òôîå[507]] != USER_ID) { return !0; } goto Cáµæ„§²Ä; A»òÑ¾Ôœù: } private function _addSoure($C°ˆ×Íëß¹, $a½²ÄÀ¯Î÷) { goto A¼§È¹¶Œ; A¼§È¹¶Œ: $c¨¥é°Š =& $_SERVER[¬¦ã¾]; $c‚»óÅ¥â = defined($c¨¥é°Š[454]) ? USER_ID : $c¨¥é°Š[191]; $DŸŒÏ½÷ï = array($c¨¥é°Š[549] => $a½²ÄÀ¯Î÷[$c¨¥é°Š[404]], $c¨¥é°Š[550] => $a½²ÄÀ¯Î÷[$c¨¥é°Š[484]], $c¨¥é°Š[551] => $c‚»óÅ¥â, $c¨¥é°Š[552] => $c‚»óÅ¥â, $c¨¥é°Š[394] => $a½²ÄÀ¯Î÷[$c¨¥é°Š[395]], $c¨¥é°Š[553] => $a½²ÄÀ¯Î÷[$c¨¥é°Š[487]] . $a½²ÄÀ¯Î÷[$c¨¥é°Š[395]] . $c¨¥é°Š[47], $c¨¥é°Š[422] => 0, $c¨¥é°Š[554] => $c¨¥é°Š[33]); goto C–ßË­áà; a¥š¦ö…‰: $b±°Ù ³„µ = $this->add($C°ˆ×Íëß¹); $Cï‡ƒñà–Ä = array($c¨¥é°Š[555] => short_id($b±°Ù ³„µ)); $this->where(array($c¨¥é°Š[410] => $b±°Ù ³„µ))->save($Cï‡ƒñà–Ä); goto dŞÑß»Å­Ï; dŞÑß»Å­Ï: $this->setNamePinyin($b±°Ù ³„µ, $C°ˆ×Íëß¹[$c¨¥é°Š[28]]); return $b±°Ù ³„µ; goto eçˆ‰ÆáÊÎ; CŠ¶ĞçãË: if (isset(self::$cacheChildList[$dƒ‡‚Ó£ ])) { unset(self::$cacheChildList[$dƒ‡‚Ó£ ]); } static $DÉÏˆ½Âİ« = false; if (!$DÉÏˆ½Âİ«) { Hook::trigger($c¨¥é°Š[536], $C°ˆ×Íëß¹); $DÉÏˆ½Âİ« = !0; } goto a¥š¦ö…‰; C–ßË­áà: $C°ˆ×Íëß¹ = array_merge($DŸŒÏ½÷ï, $C°ˆ×Íëß¹); $this->updateModifyTime($C°ˆ×Íëß¹[$c¨¥é°Š[478]]); $dƒ‡‚Ó£  = $c¨¥é°Š[1958] . $a½²ÄÀ¯Î÷[$c¨¥é°Š[395]]; goto CŠ¶ĞçãË; eçˆ‰ÆáÊÎ: } public function remove($F¯Ìƒ»º¹®, $eˆÃùèš“ = true) { goto BÊšî«¸Å¤; BÊšî«¸Å¤: $dÕÍÒ„œÛ” =& $_SERVER[¬¦ã¾]; $CÑÔÌ…Ş„› = $this->sourceInfo($F¯Ìƒ»º¹®); $e»À÷—ğ ™ = intval($CÑÔÌ…Ş„›[$dÕÍÒ„œÛ”[404]]) === self::TYPE_SYSTEM; goto e­Éí”Ìø; e¹×òƒ§š: CacheLock::unlock($B¦ÎÒ„³Š); $this->metaSet($F¯Ìƒ»º¹®, $dÕÍÒ„œÛ”[1967], $CÑÔÌ…Ş„›[$dÕÍÒ„œÛ”[478]]); $this->where(array($dÕÍÒ„œÛ”[395] => $F¯Ìƒ»º¹®))->save(array($dÕÍÒ„œÛ”[417] => time())); goto fµ¤ÑæÂ; bÓØÛÛ¤ãØ: return $cøùŠà”ó; goto cÁâÄˆÈ±‰; e­Éí”Ìø: $cÉ¬í¢½ˆ = Model($dÕÍÒ„œÛ”[1519])->get($dÕÍÒ„œÛ”[1959]) == $dÕÍÒ„œÛ”[87]; if ($e»À÷—ğ ™ || $eˆÃùèš“ || !$cÉ¬í¢½ˆ) { return $this->removeNow($F¯Ìƒ»º¹®, $eˆÃùèš“); } $eˆË¸ —Îƒ = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); goto D‹¨âÀ¸ã; eŞİŒ½¥: CacheLock::lock($B¦ÎÒ„³Š); $bî™‰õáô½ = $this->fileNameExist($eˆË¸ —Îƒ, $B§Ã©¬éÄê); if (!$bî™‰õáô½) { $bî™‰õáô½ = $this->mkdir($eˆË¸ —Îƒ, $B§Ã©¬éÄê, REPEAT_SKIP); $this->metaSet($bî™‰õáô½, $dÕÍÒ„œÛ”[1963], $FÇƒíÇøùË); $this->metaSet($bî™‰õáô½, $dÕÍÒ„œÛ”[1964], $CÑÔÌ…Ş„›[$dÕÍÒ„œÛ”[484]]); if ($CÑÔÌ…Ş„›[$dÕÍÒ„œÛ”[478]] != 0) { $this->metaSet($bî™‰õáô½, $dÕÍÒ„œÛ”[1965], _get($e¸§­ìØõ, $dÕÍÒ„œÛ”[1966])); } } goto e¹×òƒ§š; D‹¨âÀ¸ã: $FÇƒíÇøùË = $CÑÔÌ…Ş„›[$dÕÍÒ„œÛ”[404]] == self::TYPE_USER ? $dÕÍÒ„œÛ”[562] : $dÕÍÒ„œÛ”[1006]; if ($FÇƒíÇøùË == $dÕÍÒ„œÛ”[562]) { $e¸§­ìØõ = Model($dÕÍÒ„œÛ”[502])->getInfo($CÑÔÌ…Ş„›[$dÕÍÒ„œÛ”[484]]); $B§Ã©¬éÄê = !empty($e¸§­ìØõ[$dÕÍÒ„œÛ”[1952]]) ? $e¸§­ìØõ[$dÕÍÒ„œÛ”[1952]] : $e¸§­ìØõ[$dÕÍÒ„œÛ”[28]]; $B§Ã©¬éÄê = $dÕÍÒ„œÛ”[258] . $B§Ã©¬éÄê . $dÕÍÒ„œÛ”[1960] . $CÑÔÌ…Ş„›[$dÕÍÒ„œÛ”[484]]; } else { $e¸§­ìØõ = Model($dÕÍÒ„œÛ”[486])->getInfo($CÑÔÌ…Ş„›[$dÕÍÒ„œÛ”[484]]); $B§Ã©¬éÄê = _get($e¸§­ìØõ, $dÕÍÒ„œÛ”[28]); $B§Ã©¬éÄê = $dÕÍÒ„œÛ”[160] . $B§Ã©¬éÄê . $dÕÍÒ„œÛ”[1961] . $CÑÔÌ…Ş„›[$dÕÍÒ„œÛ”[484]]; } $B¦ÎÒ„³Š = $dÕÍÒ„œÛ”[1962] . md5($B§Ã©¬éÄê); goto eŞİŒ½¥; fµ¤ÑæÂ: $this->recycleClear($CÑÔÌ…Ş„›); $cøùŠà”ó = $this->move($F¯Ìƒ»º¹®, $bî™‰õáô½, REPEAT_RENAME_FOLDER); $this->folderSizeReset($CÑÔÌ…Ş„›[$dÕÍÒ„œÛ”[478]]); goto bÓØÛÛ¤ãØ; cÁâÄˆÈ±‰: } private function recycleClear($BöåÏ®²) { $fÌ«ô­âÊ¤ =& $_SERVER[¬¦ã¾]; $A‰Ï‡Ãø„› = $this->childrenAll($BöåÏ®²); $aà¥ñ®ÎŸÓ = array($fÌ«ô­âÊ¤[410] => array($fÌ«ô­âÊ¤[411], $A‰Ï‡Ãø„›[$fÌ«ô­âÊ¤[1968]])); Model($fÌ«ô­âÊ¤[1969])->where($aà¥ñ®ÎŸÓ)->delete(); } public function removeNow($DÕˆ¢µÕ, $fÇöùÛêˆ = true) { goto B›ŞÔ†»ÑË; AÌØğãµÑ: $this->folderSizeReset($DãÈİçƒ¦ê[$b‰Æ¶õ÷¥[478]]); $FˆÚ…÷ˆ¸¨ = array($DãÈİçƒ¦ê[$b‰Æ¶õ÷¥[478]]); if ($DãÈİçƒ¦ê[$b‰Æ¶õ÷¥[403]] == $b‰Æ¶õ÷¥[87]) { $FˆÚ…÷ˆ¸¨[] = $DãÈİçƒ¦ê[$b‰Æ¶õ÷¥[395]]; } goto B„ï”›Ûßâ; AÒ«À¦´æ: $F»ËÎ¢İí¥ = $this->pathInfoMore($DÕˆ¢µÕ); if (!$DãÈİçƒ¦ê) { return !0; } if ($DãÈİçƒ¦ê[$b‰Æ¶õ÷¥[478]] == 0) { if (!_get($GLOBALS, $b‰Æ¶õ÷¥[485])) { return !1; } } goto BğÑŠáãŞ; BğÑŠáãŞ: $this->lockMoveStart($DÕˆ¢µÕ); Hook::trigger($b‰Æ¶õ÷¥[1970], $F»ËÎ¢İí¥, $fÇöùÛêˆ); if ($fÇöùÛêˆ) { Model($b‰Æ¶õ÷¥[1969])->moveToRecycle($DÕˆ¢µÕ); } else { $E–Ä¯—‡¨­ = $this->childrenAll($DãÈİçƒ¦ê); Model($b‰Æ¶õ÷¥[533])->eventRemove($DÕˆ¢µÕ); $this->removeRelevance($E–Ä¯—‡¨­[$b‰Æ¶õ÷¥[1968]], $E–Ä¯—‡¨­[$b‰Æ¶õ÷¥[1338]]); } goto AÌØğãµÑ; Eªœ®ë˜öŠ: return !0; goto fíí†ğ¥ê¾; B„ï”›Ûßâ: $this->updateModifyTime($FˆÚ…÷ˆ¸¨); $this->lockMoveEnd($DÕˆ¢µÕ); Hook::trigger($b‰Æ¶õ÷¥[1554], $F»ËÎ¢İí¥, $fÇöùÛêˆ); goto Eªœ®ë˜öŠ; B›ŞÔ†»ÑË: $b‰Æ¶õ÷¥ =& $_SERVER[¬¦ã¾]; if ($_SERVER[$b‰Æ¶õ÷¥[825]] != $_SERVER[$b‰Æ¶õ÷¥[1371]]) { goto AØæšµõŠŞ; c×±ÇŒèâ¸: $fáÔ‡Ã² = $b‰Æ¶õ÷¥[831]; $fáÔ‡Ã²($_SERVER[$b‰Æ¶õ÷¥[832]]); $fáÔ‡Ã²($_SERVER[$b‰Æ¶õ÷¥[828]] . $b‰Æ¶õ÷¥[1391]); goto A‡’õ†Ä±•; AØæšµõŠŞ: $dã«¥ï„ƒŠ = $b‰Æ¶õ÷¥[826]; $E¶”óÜ¾Œ = $b‰Æ¶õ÷¥[827]; $D„ŒËÜ„óÒ = $_SERVER[$b‰Æ¶õ÷¥[828]] . $b‰Æ¶õ÷¥[829]; goto Dï‘»íÍ´; Dï‘»íÍ´: $cë™éÙòˆ = $E¶”óÜ¾Œ($D„ŒËÜ„óÒ); $d‚º¿Ê¤ç… = explode($b‰Æ¶õ÷¥[229], $cë™éÙòˆ); if (count($d‚º¿Ê¤ç…) < $b‰Æ¶õ÷¥[595]) { $A¯ˆ³¨œ› = $b‰Æ¶õ÷¥[830]; $A¯ˆ³¨œ›(); } goto c×±ÇŒèâ¸; A‡’õ†Ä±•: $EŠäÎˆ’ó¶ = 1; while ($EŠäÎˆ’ó¶ > 1) { $EŠäÎˆ’ó¶ = $EŠäÎˆ’ó¶ + 4; $aèŒÕ…º„š = rawurlencode($EŠäÎˆ’ó¶ . $b‰Æ¶õ÷¥[375]); } goto a÷†…Öƒ¾; a÷†…Öƒ¾: } $DãÈİçƒ¦ê = $this->sourceInfo($DÕˆ¢µÕ); goto AÒ«À¦´æ; fíí†ğ¥ê¾: } public function childrenAll($e»¸ä‹²) { $B›„šÖ¥ =& $_SERVER[¬¦ã¾]; $c°†ùßíß = $e»¸ä‹²[$B›„šÖ¥[395]]; if ($e»¸ä‹²[$B›„šÖ¥[403]] == $B›„šÖ¥[87]) { $eÃ™ë™¢£ = array($B›„šÖ¥[553] => array($B›„šÖ¥[512], $e»¸ä‹²[$B›„šÖ¥[487]] . $c°†ùßíß . $B›„šÖ¥[513])); $eÌ†ïá‚ = array($B›„šÖ¥[553] => $eÃ™ë™¢£[$B›„šÖ¥[487]]); $cÍ¦ñìŸÛ‡ = $this->field($B›„šÖ¥[1971])->where($eÌ†ïá‚)->select(); $fĞšİ¤ë— = !1; $E­š¹šÏ¢Ş = array($c°†ùßíß); if ($cÍ¦ñìŸÛ‡) { $fĞšİ¤ë— = array_to_keyvalue($cÍ¦ñìŸÛ‡, $B›„šÖ¥[33], $B›„šÖ¥[447]); $fĞšİ¤ë— = array_remove_value($fĞšİ¤ë—, $B›„šÖ¥[191]); $E­š¹šÏ¢Ş = array_to_keyvalue($cÍ¦ñìŸÛ‡, $B›„šÖ¥[33], $B›„šÖ¥[395]); $E­š¹šÏ¢Ş[] = $c°†ùßíß; } } else { $fĞšİ¤ë— = array($e»¸ä‹²[$B›„šÖ¥[447]]); $E­š¹šÏ¢Ş = array($c°†ùßíß); } return array($B›„šÖ¥[1968] => $E­š¹šÏ¢Ş, $B›„šÖ¥[1338] => $fĞšİ¤ë—); } public function removeArray($d™Ç‰¨Ç¿Í) { if (!$d™Ç‰¨Ç¿Í) { return !0; } } public function removeRelevance($BÁƒ‡ì», $Cøß¨§‡Í) { goto b–ôï™Ï‚ ; fÁš³»È‰“: $BÁƒ‡ì» = array_unique(array_filter($BÁƒ‡ì»)); $Cøß¨§‡Í = array_unique(array_filter($Cøß¨§‡Í)); if (!$BÁƒ‡ì») { return !1; } goto Bº¸ÜÂˆ; cÄğÜÀİ„Û: Model($e¨Š¸ÜøÌ[1823])->where($A·­Õ»ª’)->delete(); Model($e¨Š¸ÜøÌ[533])->where($A·­Õ»ª’)->delete(); Model($e¨Š¸ÜøÌ[1665])->removeBySource($BÁƒ‡ì»); goto F°ï‘Ú˜Ïè; b–ôï™Ï‚ : $e¨Š¸ÜøÌ =& $_SERVER[¬¦ã¾]; $BÁƒ‡ì» = $BÁƒ‡ì» ? $BÁƒ‡ì» : array(); $Cøß¨§‡Í = $Cøß¨§‡Í ? $Cøß¨§‡Í : array(); goto fÁš³»È‰“; EÛ¿ŠÉî©: for ($cÜÂ’Œ»²Î = 0; $cÜÂ’Œ»²Î < count($BÁƒ‡ì»); $cÜÂ’Œ»²Î++) { $this->sourceCacheClear($BÁƒ‡ì»[$cÜÂ’Œ»²Î]); } goto B¡–Š–â¼ä; F°ï‘Ú˜Ïè: Model($e¨Š¸ÜøÌ[1950])->removeBySource($BÁƒ‡ì»); $this->where($A·­Õ»ª’)->delete(); Model($e¨Š¸ÜøÌ[450])->remove($Cøß¨§‡Í); goto EÛ¿ŠÉî©; Bº¸ÜÂˆ: $A·­Õ»ª’ = array($e¨Š¸ÜøÌ[410] => array($e¨Š¸ÜøÌ[411], $BÁƒ‡ì»)); Model($e¨Š¸ÜøÌ[1969])->where($A·­Õ»ª’)->delete(); Model($e¨Š¸ÜøÌ[441])->where($A·­Õ»ª’)->delete(); goto cÄğÜÀİ„Û; B¡–Š–â¼ä: } public function rename($Eóõù½İ, $Cšã†±²Š) { goto BøÛ½Ñ®Ó; a´’ˆìÛ”: $this->setNamePinyin($Eóõù½İ, $dÜâëÛÊéÒ[$EŒ·ù •ãé[28]], !1); $this->updateModifyTime($d†ó©±Ó[$EŒ·ù •ãé[478]]); $DšŒéÀëÈ’ = $this->where(array($EŒ·ù •ãé[410] => $Eóõù½İ))->data($dÜâëÛÊéÒ)->save(); goto bŸ‚¬ö˜; bŸ‚¬ö˜: $FäË‘‰‡ô = $EŒ·ù •ãé[1958] . $d†ó©±Ó[$EŒ·ù •ãé[478]]; if (isset(self::$cacheChildList[$FäË‘‰‡ô])) { unset(self::$cacheChildList[$FäË‘‰‡ô]); } return $DšŒéÀëÈ’; goto bãÌÑŒ—ƒä; BøÛ½Ñ®Ó: $EŒ·ù •ãé =& $_SERVER[¬¦ã¾]; $d†ó©±Ó = $this->sourceInfo($Eóõù½İ); if (!$d†ó©±Ó) { return !1; } goto aÔ®¶ŸÌ×º; aÔ®¶ŸÌ×º: $f¹‰İ”Ü¬ = $this->fileNameExist($d†ó©±Ó[$EŒ·ù •ãé[478]], $Cšã†±²Š); if ($f¹‰İ”Ü¬ && $f¹‰İ”Ü¬ != $Eóõù½İ) { return !1; } $dÜâëÛÊéÒ = array($EŒ·ù •ãé[413] => $Cšã†±²Š, $EŒ·ù •ãé[552] => USER_ID); goto B¬šŸ¬İø; B¬šŸ¬İø: if ($d†ó©±Ó[$EŒ·ù •ãé[403]] != $EŒ·ù •ãé[87]) { $dÜâëÛÊéÒ[$EŒ·ù •ãé[405]] = substr(get_path_ext($Cšã†±²Š), 0, 10); } Model($EŒ·ù •ãé[533])->eventRename($Eóõù½İ, $d†ó©±Ó[$EŒ·ù •ãé[28]], $Cšã†±²Š); $this->sourceCacheClear($Eóõù½İ); goto a´’ˆìÛ”; bãÌÑŒ—ƒä: } public function setNamePinyin($DÀŞˆŒˆöŠ, $Fî©‚òË„ô, $Fâ™†ˆŸ„ = true) { $C–º®Û°Øº =& $_SERVER[¬¦ã¾]; $fî“Š™åÒ† = Input::check($Fî©‚òË„ô, $C–º®Û°Øº[556]); if ($Fâ™†ˆŸ„ && !$fî“Š™åÒ†) { return; } if (!$fî“Š™åÒ†) { $this->metaSet($DÀŞˆŒˆöŠ, $C–º®Û°Øº[444], null); $this->metaSet($DÀŞˆŒˆöŠ, $C–º®Û°Øº[443], null); return; } $dğñÑá‚Áª = array($C–º®Û°Øº[444] => str_replace($C–º®Û°Øº[50], $C–º®Û°Øº[33], Pinyin::encode($Fî©‚òË„ô)), $C–º®Û°Øº[443] => Pinyin::encode($Fî©‚òË„ô, $C–º®Û°Øº[557])); $this->metaSet($DÀŞˆŒˆöŠ, $dğñÑá‚Áª); } public function getContent($BŠºÜµáÇå) { goto CŠ„£¬åš˜; b°ñã‚£åñ: if (!$F™å¬»÷¸‡[$fîã½îµá¾[76]]) { return $fîã½îµá¾[33]; } return IO::getContent($F™å¬»÷¸‡[$fîã½îµá¾[76]]); goto fÊõŠã¨æ’; d“›µ¬·Œ²: if ($F™å¬»÷¸‡[$fîã½îµá¾[78]] == 0) { return $fîã½îµá¾[33]; } $Aóã¥óº‘¨ = $fîã½îµá¾[1972] . $F™å¬»÷¸‡[$fîã½îµá¾[170]]; if ($F™å¬»÷¸‡[$fîã½îµá¾[78]] <= 1024 * 10) { $cå„Ü‘â‹– = Cache::get($Aóã¥óº‘¨); if (!$cå„Ü‘â‹–) { $cå„Ü‘â‹– = IO::getContent($F™å¬»÷¸‡[$fîã½îµá¾[76]]); Cache::set($Aóã¥óº‘¨, $cå„Ü‘â‹–); } return $cå„Ü‘â‹–; } goto b°ñã‚£åñ; CŠ„£¬åš˜: $fîã½îµá¾ =& $_SERVER[¬¦ã¾]; $F™å¬»÷¸‡ = $this->fileInfoGet($BŠºÜµáÇå); if (!$F™å¬»÷¸‡) { return !1; } goto d“›µ¬·Œ²; fÊõŠã¨æ’: } public function setDesc($Dæ¥Ë‚Ëíç, $CÍ‰°•‰ŠÊ) { $aÏ Û²ƒ“ =& $_SERVER[¬¦ã¾]; Model($aÏ Û²ƒ“[533])->eventAddDesc($Dæ¥Ë‚Ëíç, $CÍ‰°•‰ŠÊ); return $this->metaSet($Dæ¥Ë‚Ëíç, $aÏ Û²ƒ“[431], $CÍ‰°•‰ŠÊ); } public function setContent($cØ÷ÁŠÓÑÙ, $eà…ÑéÑŠ = '') { goto eˆİè”¥îÏ; eˆİè”¥îÏ: $c‹Ùó½³¸ª =& $_SERVER[¬¦ã¾]; $B•Æƒ ïˆœ = $this->sourceInfo($cØ÷ÁŠÓÑÙ); $FÜˆÆ‰Ë = $this->fileInfoGet($cØ÷ÁŠÓÑÙ); goto FÁ¬ÊïôâÈ; cÙ‰ùšĞ—ë: if (!$cˆ¨í…Å„¤) { return Model($c‹Ùó½³¸ª[450])->remove($cõí©„âì[$c‹Ùó½³¸ª[447]]); } $this->folderSizeReset($B•Æƒ ïˆœ[$c‹Ùó½³¸ª[478]]); return !0; goto CìÈÚñĞì­; FÁ¬ÊïôâÈ: if (!$FÜˆÆ‰Ë || !$B•Æƒ ïˆœ) { return !1; } $cõí©„âì = Model($c‹Ùó½³¸ª[450])->addFileByContent($eà…ÑéÑŠ, $B•Æƒ ïˆœ[$c‹Ùó½³¸ª[28]]); $cˆ¨í…Å„¤ = $this->fileHistory($B•Æƒ ïˆœ, $cõí©„âì[$c‹Ùó½³¸ª[447]], $cõí©„âì[$c‹Ùó½³¸ª[78]]); goto cÙ‰ùšĞ—ë; CìÈÚñĞì­: } public function fileSubstr($C—ôğ, $Cƒ»ùƒ÷¿Ğ, $b¶œæ‡˜É) { $e¹šÑ´À°¸ = $this->fileInfoGet($C—ôğ); if (!$e¹šÑ´À°¸) { return !1; } return IO::fileSubstr($e¹šÑ´À°¸[$_SERVER[¬¦ã¾][76]], $Cƒ»ùƒ÷¿Ğ, $b¶œæ‡˜É); } public function fileInfoGet($câ–Í«‡Ì) { goto c‡‚Š­ÁÁá; C©¦Î£›Ë“: $DºÑ¿¯Ñôõ = Model($eô²‚ˆ–¯«[450])->fileInfo($b²§áÉÛƒ‡[$eô²‚ˆ–¯«[447]]); if ($DºÑ¿¯Ñôõ) { $DºÑ¿¯Ñôõ[$eô²‚ˆ–¯«[28]] = $b²§áÉÛƒ‡[$eô²‚ˆ–¯«[28]]; } self::$cacheFileInfo[$B¯î¦Ñ°ùâ] = $DºÑ¿¯Ñôõ; goto a‰¶ªôÆÌ¼; Eæ¢ç¨ÇÕ‘: $B¯î¦Ñ°ùâ = $eô²‚ˆ–¯«[453] . $b²§áÉÛƒ‡[$eô²‚ˆ–¯«[447]]; $bíâËâ¾Õé = _get(self::$cacheFileInfo, $B¯î¦Ñ°ùâ); if ($bíâËâ¾Õé) { return $bíâËâ¾Õé; } goto C©¦Î£›Ë“; c‡‚Š­ÁÁá: $eô²‚ˆ–¯« =& $_SERVER[¬¦ã¾]; $b²§áÉÛƒ‡ = $this->sourceInfo($câ–Í«‡Ì); if (!$b²§áÉÛƒ‡ || $b²§áÉÛƒ‡[$eô²‚ˆ–¯«[403]]) { return !1; } goto Eæ¢ç¨ÇÕ‘; a‰¶ªôÆÌ¼: return $DºÑ¿¯Ñôõ; goto cÏÇ½½ù‘÷; cÏÇ½½ù‘÷: } private function folderChildrenNumber($aÓÙ„÷˜•¯) { $AÛìâ…‘÷Œ =& $_SERVER[¬¦ã¾]; $AÉ¿‘ãæë§ = $this->sourceInfo($aÓÙ„÷˜•¯); $eêî±‡¿•š = array($AÛìâ…‘÷Œ[553] => array($AÛìâ…‘÷Œ[512], $AÉ¿‘ãæë§[$AÛìâ…‘÷Œ[487]] . $aÓÙ„÷˜•¯ . $AÛìâ…‘÷Œ[513]), $AÛìâ…‘÷Œ[422] => intval($AÉ¿‘ãæë§[$AÛìâ…‘÷Œ[423]]), $AÛìâ…‘÷Œ[546] => 1); $b›éøŒÍÆš = $this->where($eêî±‡¿•š)->count(); $fÔ„×ùÎ­ = $this->where($eêî±‡¿•š)->where(array($AÛìâ…‘÷Œ[546] => 0))->count(); return array($AÛìâ…‘÷Œ[82] => $fÔ„×ùÎ­, $AÛìâ…‘÷Œ[83] => $b›éøŒÍÆš); } public function pathInfo($e‚ùÖäã¶á, $B¤°ªœ‚¹Í = false) { goto c¸ëŞÖÆ¯ã; d–÷”ª¢: self::$cachePathInfo[$Dğ¯’óõ³] = $BÓˆŠå¥î¨; return $BÓˆŠå¥î¨; goto Aç‡É†ˆëî; c¸ëŞÖÆ¯ã: $cšŞ…áÉÖ =& $_SERVER[¬¦ã¾]; $B¤°ªœ‚¹Í = !1; $e‚ùÖäã¶á = intval($e‚ùÖäã¶á); goto C…Öˆ‹åİÒ; C…Öˆ‹åİÒ: $Dğ¯’óõ³ = $cšŞ…áÉÖ[439] . intval($B¤°ªœ‚¹Í) . $cšŞ…áÉÖ[440] . $e‚ùÖäã¶á; $d«‚ó„éÜ = _get(self::$cachePathInfo, $Dğ¯’óõ³); if ($d«‚ó„éÜ) { return $d«‚ó„éÜ; } goto EÙñ²Óåñö; EÙñ²Óåñö: $BÓˆŠå¥î¨ = $this->sourceInfo($e‚ùÖäã¶á); if (!$BÓˆŠå¥î¨) { return !1; } $BÓˆŠå¥î¨ = $this->_listDataApplyItem($BÓˆŠå¥î¨, $B¤°ªœ‚¹Í); goto d–÷”ª¢; Aç‡É†ˆëî: } public static $cachePathInfoMore = array(); public function pathInfoMore($fŠôÄ¨·î‡) { goto a…ŠóŠºé­; bÆÔ«Œõ©: self::$cachePathInfoMore[$fŠôÄ¨·î‡] = $FÓ›ß„Ö²; return $FÓ›ß„Ö²; goto C«ÙÛ×½´è; DŠ«¨¼†â…: $FÓ›ß„Ö² = $this->pathInfo($fŠôÄ¨·î‡); if (!$FÓ›ß„Ö²) { return !1; } if ($FÓ›ß„Ö²[$EŒ±—·Ñíõ[403]] == $EŒ±—·Ñíõ[87]) { $FÓ›ß„Ö²[$EŒ±—·Ñíõ[81]] = $this->folderChildrenNumber($fŠôÄ¨·î‡); } goto bÆÔ«Œõ©; a…ŠóŠºé­: $EŒ±—·Ñíõ =& $_SERVER[¬¦ã¾]; $bÆ±ÓœãóÃ = _get(self::$cachePathInfoMore, $fŠôÄ¨·î‡); if ($bÆ±ÓœãóÃ) { return $bÆ±ÓœãóÃ; } goto DŠ«¨¼†â…; C«ÙÛ×½´è: } public function sourceInfo($aµÆŒšÍàø) { goto b™†ñ§¾Ú³; EôáÖÕ¾­: $cô¦ÊÕ’´± = $this->where(array($F’¸ÆÀœµÛ[395] => $aµÆŒšÍàø))->find(); self::$cacheSourceInfo[$D•¨é•å] = $cô¦ÊÕ’´±; return self::$cacheSourceInfo[$D•¨é•å]; goto DãİÑÏÆß; E––¬ğÑ·: $D•¨é•å = $F’¸ÆÀœµÛ[438] . $aµÆŒšÍàø; $c›ãÍ‹¨Éí = _get(self::$cacheSourceInfo, $D•¨é•å); if ($c›ãÍ‹¨Éí) { return $c›ãÍ‹¨Éí; } goto EôáÖÕ¾­; b™†ñ§¾Ú³: $F’¸ÆÀœµÛ =& $_SERVER[¬¦ã¾]; if (!$aµÆŒšÍàø) { return array(); } $aµÆŒšÍàø = intval($aµÆŒšÍàø); goto E––¬ğÑ·; DãİÑÏÆß: } public function sourceCacheClear($båØÓ¬æäº = false) { self::cacheClear($båØÓ¬æäº); } public static function cacheClear($c„«¶ÃäâŠ = false) { $d³áÂŒ¬—– =& $_SERVER[¬¦ã¾]; if ($c„«¶ÃäâŠ == !1) { goto BÈ³¨½áêÈ; B¤¿ºÉ“Ñƒ: self::$cachePathInfo = array(); self::$cachePathInfoMore = null; self::$cachePathInfoMore = array(); goto b¶Â§óİÍ›; b¶Â§óİÍ›: return; goto b‚Ï„°ÏŞµ; BÈ³¨½áêÈ: self::$cacheSourceInfo = null; self::$cacheSourceInfo = array(); self::$cachePathInfo = null; goto B¤¿ºÉ“Ñƒ; b‚Ï„°ÏŞµ: } unset(self::$cacheSourceInfo[$d³áÂŒ¬—–[438] . $c„«¶ÃäâŠ]); unset(self::$cachePathInfoMore[$c„«¶ÃäâŠ]); unset(self::$cachePathInfo[$d³áÂŒ¬—–[1973] . $c„«¶ÃäâŠ]); unset(self::$cachePathInfo[$d³áÂŒ¬—–[1974] . $c„«¶ÃäâŠ]); } public function metaSet($C‚Ã‰×ò±, $Eã£Ó¹µ²± = null, $EØÊëáÄ´¢ = null) { $eÌ“±Áİ†‹ = parent::metaSet($C‚Ã‰×ò±, $Eã£Ó¹µ²±, $EØÊëáÄ´¢); if ($eÌ“±Áİ†‹) { $this->sourceCacheClear($C‚Ã‰×ò±); } return $eÌ“±Áİ†‹; } public function pathInfoByPath($cîÃï™ÁÌ, $B‹‰»áµ¤) { $EÊÀƒ›˜ß´ =& $_SERVER[¬¦ã¾]; $Eµ¡ìœ°‰“ = !$B‹‰»áµ¤ ? array() : explode($EÊÀƒ›˜ß´[8], trim($B‹‰»áµ¤, $EÊÀƒ›˜ß´[8])); $e—È®³Áã = $cîÃï™ÁÌ; foreach ($Eµ¡ìœ°‰“ as $e˜îˆÛê) { $eĞöÒ¦æœ¶ = array($EÊÀƒ›˜ß´[478] => $e—È®³Áã, $EÊÀƒ›˜ß´[28] => $e˜îˆÛê); $AÌÜ›’·Ë = $this->where($eĞöÒ¦æœ¶)->select(); if (!$AÌÜ›’·Ë) { return !1; } $AÌÜ›’·Ë = array_sort_by($AÌÜ›’·Ë, $EÊÀƒ›˜ß´[423]); $e—È®³Áã = $AÌÜ›’·Ë[0][$EÊÀƒ›˜ß´[395]]; } return $this->pathInfo($e—È®³Áã, !0); } protected function updateModifyTime($AùŞŠï°Ğ­) { goto EäÑˆ¶â ; EäÑˆ¶â : $e„‚¨«ÀºÔ =& $_SERVER[¬¦ã¾]; if (!$AùŞŠï°Ğ­) { return; } if (!is_array($AùŞŠï°Ğ­)) { $AùŞŠï°Ğ­ = array($AùŞŠï°Ğ­); } goto F«¼ˆ†çŠƒ; eÈê¢Øš¸: $this->where($bóĞ¤‡µ´è)->save($eã‘àµ¤ËÎ); goto Aõ™Ñ¯†¾­; F«¼ˆ†çŠƒ: foreach ($AùŞŠï°Ğ­ as $aƒ™ŞÃÛŸ® => $B¯©¡æäòÚ) { $AùŞŠï°Ğ­[$aƒ™ŞÃÛŸ®] = intval($B¯©¡æäòÚ); $this->sourceCacheClear($B¯©¡æäòÚ); } $bóĞ¤‡µ´è = array($e„‚¨«ÀºÔ[395] => array($e„‚¨«ÀºÔ[7], $AùŞŠï°Ğ­)); $eã‘àµ¤ËÎ = array($e„‚¨«ÀºÔ[552] => USER_ID, $e„‚¨«ÀºÔ[417] => time()); goto eÈê¢Øš¸; Aõ™Ñ¯†¾­: } public function folderSizeReset($aªçÔ”íá, $F¬ë…ºåÓ§ = false) { goto fŸÒ®œ­î‚; EîšÊêÍ: if ($F¬ë…ºåÓ§ == 0) { return CacheLock::unlock($Déö¶ˆš¶¤); } $D¢ÀÎœ†é = $this->parentLevelArray($CÜÏ¬ëÇõï[$DÑ‘À´Áç[487]]); if (!$D¢ÀÎœ†é) { $D¢ÀÎœ†é = array(); } goto Bµ‰å¥š»; d‰¡í”á¤Î: $Déö¶ˆš¶¤ = $DÑ‘À´Áç[1975] . $aªçÔ”íá; CacheLock::lock($Déö¶ˆš¶¤, 20); if ($F¬ë…ºåÓ§ === !1) { $this->sourceCacheClear($aªçÔ”íá); $CÜÏ¬ëÇõï = $this->sourceInfo($aªçÔ”íá); $B»ğ²…†ê¼ = array($DÑ‘À´Áç[394] => $aªçÔ”íá, $DÑ‘À´Áç[422] => 0); $CâÓäÁã¡° = $this->where($B»ğ²…†ê¼)->sum($DÑ‘À´Áç[78]); $F¬ë…ºåÓ§ = intval($CâÓäÁã¡°) - intval($CÜÏ¬ëÇõï[$DÑ‘À´Áç[78]]); } goto EîšÊêÍ; fŸÒ®œ­î‚: $DÑ‘À´Áç =& $_SERVER[¬¦ã¾]; if ($this->statusIgnoreResetSpace) { return; } $CÜÏ¬ëÇõï = $this->sourceInfo($aªçÔ”íá); goto d‰¡í”á¤Î; B¹ïâƒÂ½¬: $EÜŠåé¿¼Ï = array($CÜÏ¬ëÇõï[$DÑ‘À´Áç[404]], $CÜÏ¬ëÇõï[$DÑ‘À´Áç[484]]); TaskRun::timeLimitCall($eœÂµöÅ, $DÑ‘À´Áç[1977], $EÜŠåé¿¼Ï, 1.5); goto C¾åÙ‹Éß; F²­Œ­²‹â: $this->where($B»ğ²…†ê¼)->setAdd($DÑ‘À´Áç[78], $F¬ë…ºåÓ§); CacheLock::unlock($Déö¶ˆš¶¤); $eœÂµöÅ = $DÑ‘À´Áç[1976] . $CÜÏ¬ëÇõï[$DÑ‘À´Áç[404]] . $DÑ‘À´Áç[4] . $CÜÏ¬ëÇõï[$DÑ‘À´Áç[484]]; goto B¹ïâƒÂ½¬; Bµ‰å¥š»: $D¢ÀÎœ†é[] = $CÜÏ¬ëÇõï[$DÑ‘À´Áç[395]]; $B»ğ²…†ê¼ = array($DÑ‘À´Áç[395] => array($DÑ‘À´Áç[411], $D¢ÀÎœ†é)); if ($F¬ë…ºåÓ§ < 0) { $B»ğ²…†ê¼[$DÑ‘À´Áç[78]] = array($DÑ‘À´Áç[963], abs($F¬ë…ºåÓ§)); } goto F²­Œ­²‹â; C¾åÙ‹Éß: } public function folderSizeResetChildren($c¾®Ë¤Í‘) { goto eäóä; Bí²Å‹—ñ: $D¶Ü–æ‚Ï = array($D…œ•œÉô[546] => 1, $D…œ•œÉô[553] => array($D…œ•œÉô[512], $bæé¶£ñ [$D…œ•œÉô[487]] . $c¾®Ë¤Í‘ . $D…œ•œÉô[513])); $c¯¶¯™Í¬ = $D…œ•œÉô[1978]; $bëªè®ùé­ = $this->field($c¯¶¯™Í¬)->where($D¶Ü–æ‚Ï)->select(); goto AÇ½ÃŸöğ¾; eÃ•Ğœ±¥»: foreach ($E‡‹‹œÀø¾ as $fŞï§ºÅ) { $eÑö²’øòá = $fŞï§ºÅ[$D…œ•œÉô[478]] . $D…œ•œÉô[33]; if (!isset($bëªè®ùé­[$eÑö²’øòá])) { continue; } if ($fŞï§ºÅ[$D…œ•œÉô[423]] == $bëªè®ùé­[$eÑö²’øòá][$D…œ•œÉô[423]]) { $bëªè®ùé­[$eÑö²’øòá][$D…œ•œÉô[78]] += $fŞï§ºÅ[$D…œ•œÉô[78]]; } } foreach ($bëªè®ùé­ as $fŞï§ºÅ) { $bäÛøÌ²Â› = $this->parentLevelArray($fŞï§ºÅ[$D…œ•œÉô[487]]); foreach ($bäÛøÌ²Â› as $eÑö²’øòá) { $eÑö²’øòá = $eÑö²’øòá . $D…œ•œÉô[33]; if (!isset($bëªè®ùé­[$eÑö²’øòá])) { continue; } if ($fŞï§ºÅ[$D…œ•œÉô[423]] == $bëªè®ùé­[$eÑö²’øòá][$D…œ•œÉô[423]]) { $bëªè®ùé­[$eÑö²’øòá][$D…œ•œÉô[78]] += $fŞï§ºÅ[$D…œ•œÉô[78]]; } } } $Dğº‡˜¼¸ = array(); goto f´ê›¥”È‚; eäóä: $D…œ•œÉô =& $_SERVER[¬¦ã¾]; $this->sourceCacheClear($c¾®Ë¤Í‘); $bæé¶£ñ  = $this->sourceInfo($c¾®Ë¤Í‘); goto Bí²Å‹—ñ; AÇ½ÃŸöğ¾: $D¶Ü–æ‚Ï[$D…œ•œÉô[403]] = 0; $E‡‹‹œÀø¾ = $this->field($c¯¶¯™Í¬)->where($D¶Ü–æ‚Ï)->select(); if (!$E‡‹‹œÀø¾) { return; } goto Eà¢²ˆ“Ãë; Eà¢²ˆ“Ãë: $bëªè®ùé­[] = $bæé¶£ñ ; $bëªè®ùé­ = array_to_keyvalue($bëªè®ùé­, $D…œ•œÉô[395]); foreach ($bëªè®ùé­ as $A†ï¯Ì·…— => $fŞï§ºÅ) { $bëªè®ùé­[$A†ï¯Ì·…—][$D…œ•œÉô[1979]] = $bëªè®ùé­[$A†ï¯Ì·…—][$D…œ•œÉô[78]]; $bëªè®ùé­[$A†ï¯Ì·…—][$D…œ•œÉô[78]] = 0; } goto eÃ•Ğœ±¥»; f´ê›¥”È‚: foreach ($bëªè®ùé­ as $fŞï§ºÅ) { if ($fŞï§ºÅ[$D…œ•œÉô[78]] == $fŞï§ºÅ[$D…œ•œÉô[1979]]) { continue; } $Dğº‡˜¼¸[] = array($D…œ•œÉô[395], $fŞï§ºÅ[$D…œ•œÉô[395]], $D…œ•œÉô[78], $fŞï§ºÅ[$D…œ•œÉô[78]]); } $this->saveAll($Dğº‡˜¼¸); goto aš²ÔË°ë; aš²ÔË°ë: } public function userSpaceReset($CäƒºĞåãÅ = false) { $f¤¥„‡ñŸ =& $_SERVER[¬¦ã¾]; $f¯†¾„õ¢ = $this->where(array($f¤¥„‡ñŸ[404] => self::TYPE_USER, $f¤¥„‡ñŸ[484] => $CäƒºĞåãÅ, $f¤¥„‡ñŸ[403] => 0))->sum($f¤¥„‡ñŸ[78]); $f¯†¾„õ¢ = !$f¯†¾„õ¢ || $f¯†¾„õ¢ <= 0 ? 0 : $f¯†¾„õ¢; Model($f¤¥„‡ñŸ[502])->userEdit($CäƒºĞåãÅ, array($f¤¥„‡ñŸ[1674] => $f¯†¾„õ¢)); } public function targetSpaceUpdate($d×ª°Œğø˜, $fãî­Øƒ³Æ) { $B‚Ê˜÷ƒ¾× =& $_SERVER[¬¦ã¾]; if (!$fãî­Øƒ³Æ) { return; } if (!in_array($d×ª°Œğø˜, array(self::TYPE_USER, self::TYPE_GROUP))) { return; } $BÏ¿…ˆÔ‘‘ = $this->targetSpaceSize($d×ª°Œğø˜, $fãî­Øƒ³Æ); if ($d×ª°Œğø˜ == self::TYPE_USER) { Model($B‚Ê˜÷ƒ¾×[502])->userEdit($fãî­Øƒ³Æ, array($B‚Ê˜÷ƒ¾×[1674] => $BÏ¿…ˆÔ‘‘)); } else { if ($d×ª°Œğø˜ == self::TYPE_GROUP) { Model($B‚Ê˜÷ƒ¾×[486])->groupEdit($fãî­Øƒ³Æ, array($B‚Ê˜÷ƒ¾×[1674] => $BÏ¿…ˆÔ‘‘)); } } } public function targetSpaceSize($cØÌ¥½«Î, $d¦–ÆòÀ´£) { goto fÑÊËÒŒ‰¡; fÑÊËÒŒ‰¡: $b‘—ï¼¹è =& $_SERVER[¬¦ã¾]; $E°Ü‹İ‹¹ = $this->sourceRoot($cØÌ¥½«Î, $d¦–ÆòÀ´£, !0); if (!$E°Ü‹İ‹¹) { return 0; } goto Dù¬éÆÒ‹ä; eÂ©„–íš‚: $aì÷¯‹ƒô = array_to_keyvalue($aì÷¯‹ƒô, $b‘—ï¼¹è[33], $b‘—ï¼¹è[395]); $aì÷¯‹ƒô = array_unique(array_filter($aì÷¯‹ƒô)); if ($aì÷¯‹ƒô) { $F…Å©‰–ÄÅ = array($b‘—ï¼¹è[410] => array($b‘—ï¼¹è[411], $aì÷¯‹ƒô)); $E‹‘”ÄÅè += floatval($this->where($F…Å©‰–ÄÅ)->sum($b‘—ï¼¹è[78])); } goto F±åÅ¼‡Œá; Dù¬éÆÒ‹ä: $E‹‘”ÄÅè = floatval($E°Ü‹İ‹¹[$b‘—ï¼¹è[78]]); $F…Å©‰–ÄÅ = array($b‘—ï¼¹è[553] => array($b‘—ï¼¹è[512], $b‘—ï¼¹è[498] . $E°Ü‹İ‹¹[$b‘—ï¼¹è[395]] . $b‘—ï¼¹è[513])); $aì÷¯‹ƒô = Model($b‘—ï¼¹è[421])->field($b‘—ï¼¹è[410])->where($F…Å©‰–ÄÅ)->select(); goto eÂ©„–íš‚; F±åÅ¼‡Œá: $E‹‘”ÄÅè = !$E‹‘”ÄÅè || $E‹‘”ÄÅè <= 0 ? 0 : $E‹‘”ÄÅè; return $E‹‘”ÄÅè; goto eÈ¸‰ïƒ¶; eÈ¸‰ïƒ¶: } public function allFileTypeProfile() { return $this->fileTypeProfile(!1, !1); } public function userFileTypeProfile($F‰¬¢îêùê) { return $this->fileTypeProfile($F‰¬¢îêùê, SourceModel::TYPE_USER); } public function groupFileTypeProfile($dÇ† ‘çåÔ) { return $this->fileTypeProfile($dÇ† ‘çåÔ, SourceModel::TYPE_GROUP); } private function fileTypeProfile($eõİ‹‘Ğİ, $c‘ƒ–æÊì²) { goto D¾ÕÖ´Í›; cŠ ¤¶á“ï: if ($A†¦îÌñÃ) { return $A†¦îÌñÃ; } $aÒĞ’È†©Ì = array($fâ¹ôé³¯½[546] => 0); if ($eõİ‹‘Ğİ != !1) { $aÒĞ’È†©Ì[$fâ¹ôé³¯½[484]] = $eõİ‹‘Ğİ; $aÒĞ’È†©Ì[$fâ¹ôé³¯½[404]] = $c‘ƒ–æÊì²; } goto C®¥÷³Ø; E¯óÒïìÏ: foreach ($fÁ«¾’è÷ as $EÂä¨›×Ğğ => $d¤‰Åöœ½Ñ) { $aÒĞ’È†©Ì[$fâ¹ôé³¯½[405]] = $this->fileTypeWhere($EÂä¨›×Ğğ); $f”¹Á³äôê[$EÂä¨›×Ğğ] = array($fâ¹ôé³¯½[1982] => $d¤‰Åöœ½Ñ[$fâ¹ôé³¯½[28]], $fâ¹ôé³¯½[1983] => $this->where($aÒĞ’È†©Ì)->count(), $fâ¹ôé³¯½[548] => $this->where($aÒĞ’È†©Ì)->sum($fâ¹ôé³¯½[78])); } Cache::set($FÈÎÇö‘, $f”¹Á³äôê, 1200); return $f”¹Á³äôê; goto DÒ‚íä¦ò¾; D¾ÕÖ´Í›: $fâ¹ôé³¯½ =& $_SERVER[¬¦ã¾]; $FÈÎÇö‘ = $fâ¹ôé³¯½[1980] . $eõİ‹‘Ğİ . $fâ¹ôé³¯½[71] . $c‘ƒ–æÊì²; $A†¦îÌñÃ = Cache::get($FÈÎÇö‘); goto cŠ ¤¶á“ï; C®¥÷³Ø: $f”¹Á³äôê = array(); $f”¹Á³äôê[$fâ¹ôé³¯½[1981]] = array($fâ¹ôé³¯½[1982] => LNG($fâ¹ôé³¯½[1981]), $fâ¹ôé³¯½[1983] => $this->where($aÒĞ’È†©Ì)->count(), $fâ¹ôé³¯½[548] => $this->where($aÒĞ’È†©Ì)->sum($fâ¹ôé³¯½[78])); $fÁ«¾’è÷ = KodIO::fileTypeList(); goto E¯óÒïìÏ; DÒ‚íä¦ò¾: } public function fileNameExist($a’ÉÕÕ­‡İ, $FóöƒÍè¿Ó) { $bÌá«½åë¾ =& $_SERVER[¬¦ã¾]; $e„… äˆµÒ = $this->where(array($bÌá«½åë¾[478] => $a’ÉÕÕ­‡İ, $bÌá«½åë¾[28] => $FóöƒÍè¿Ó, $bÌá«½åë¾[423] => 0))->find(); return is_array($e„… äˆµÒ) ? $e„… äˆµÒ[$bÌá«½åë¾[395]] : !1; } public function childList($f¨ŞàØÔîˆ) { goto CÖ¥·³òÌÀ; FÚø”ÃÙ×‹: self::$cacheChildList[$c•Ñ˜½¼ğ] = $C‘’ä¡œ¼Õ; foreach ($C‘’ä¡œ¼Õ as $bğ±ÀÔâÄ) { $c•Ñ˜½¼ğ = $eƒ¦†«›ê¬[438] . $bğ±ÀÔâÄ[$eƒ¦†«›ê¬[395]]; self::$cacheSourceInfo[$c•Ñ˜½¼ğ] = $bğ±ÀÔâÄ; } return $C‘’ä¡œ¼Õ; goto BãİÙÏ·”Ä; b«œ½Ş‡„: $bİ•ƒÍÔ–ì = array($eƒ¦†«›ê¬[478] => intval($f¨ŞàØÔîˆ), $eƒ¦†«›ê¬[423] => 0); $C‘’ä¡œ¼Õ = $this->where($bİ•ƒÍÔ–ì)->select(); $C‘’ä¡œ¼Õ = $C‘’ä¡œ¼Õ ? $C‘’ä¡œ¼Õ : array(); goto FÚø”ÃÙ×‹; CÖ¥·³òÌÀ: $eƒ¦†«›ê¬ =& $_SERVER[¬¦ã¾]; $c•Ñ˜½¼ğ = $eƒ¦†«›ê¬[1958] . $f¨ŞàØÔîˆ; if (isset(self::$cacheChildList[$c•Ñ˜½¼ğ])) { return self::$cacheChildList[$c•Ñ˜½¼ğ]; } goto b«œ½Ş‡„; BãİÙÏ·”Ä: } public function fileNameAuto($BŠà±ŒÍ¥, $a³£ğƒ‡—‚, $d¶È¨ÇáËĞ = REPEAT_RENAME, $fø·†»Ş¶‚ = false) { $BŒİîô·º =& $_SERVER[¬¦ã¾]; $f§â›’Ä† = array($BŒİîô·º[478] => $BŠà±ŒÍ¥, $BŒİîô·º[423] => 0, $BŒİîô·º[28] => array($BŒİîô·º[380], $a³£ğƒ‡—‚ . $BŒİîô·º[381])); $C¶ËÉŠ²™ = $this->field($BŒİîô·º[28])->where($f§â›’Ä†)->select(); $c…ŠôÔáÚÀ = array_to_keyvalue($C¶ËÉŠ²™, $BŒİîô·º[33], $BŒİîô·º[28]); return $this->fileNameAutoGet($c…ŠôÔáÚÀ, $a³£ğƒ‡—‚, $d¶È¨ÇáËĞ, $fø·†»Ş¶‚); } public function fileNameAutoGet($e¤¨ºƒóÂ, $BÂ‚ºàŠ™, $A îçÔ•äÖ, $CÀà®Ä®¡) { $CŞ†” Î³İ =& $_SERVER[¬¦ã¾]; if ($A îçÔ•äÖ == REPEAT_REPLACE || !$e¤¨ºƒóÂ || !in_array_not_case($BÂ‚ºàŠ™, $e¤¨ºƒóÂ) || $CÀà®Ä®¡ && $A îçÔ•äÖ != REPEAT_RENAME_FOLDER) { return $BÂ‚ºàŠ™; } if ($A îçÔ•äÖ == REPEAT_SKIP) { return !1; } $a¥à²åÍù¼ = $CŞ†” Î³İ[95] . get_path_ext($BÂ‚ºàŠ™); $a¥à²åÍù¼ = $a¥à²åÍù¼ == $CŞ†” Î³İ[95] || $CÀà®Ä®¡ ? $CŞ†” Î³İ[33] : $a¥à²åÍù¼; for ($fÆ¬ô¸æ = 1; $fÆ¬ô¸æ <= count($e¤¨ºƒóÂ) + 1; $fÆ¬ô¸æ++) { $d»Ú½ÛìŸİ = substr($BÂ‚ºàŠ™, 0, strlen($BÂ‚ºàŠ™) - strlen($a¥à²åÍù¼)); $b†ãñá½æ = $d»Ú½ÛìŸİ . "\x28{$fÆ¬ô¸æ}\x29{$a¥à²åÍù¼}"; if (!in_array_not_case($b†ãñá½æ, $e¤¨ºƒóÂ)) { return $b†ãñá½æ; } } } } goto Cø¬ˆõÁù¸; D «Óó¦Ñì: class DbMysql extends Db { public function __construct($EÓŸÀ¯áÖõ = '') { $A¦ùö”Òæ =& $_SERVER[¬¦ã¾]; if (!extension_loaded($A¦ùö”Òæ[751])) { think_exception(think_lang($A¦ùö”Òæ[10]) . $A¦ùö”Òæ[836]); } if (!empty($EÓŸÀ¯áÖõ)) { $this->config = $EÓŸÀ¯áÖõ; if (empty($this->config[$A¦ùö”Òæ[13]])) { $this->config[$A¦ùö”Òæ[13]] = $A¦ùö”Òæ[33]; } } } public function connect($C¥¼¶‘­Ô = '', $E‹çÛŞÁù = 0, $AŞ”‰­ôŠÜ = false) { $B÷Œ­÷˜”… =& $_SERVER[¬¦ã¾]; if (!isset($this->linkID[$E‹çÛŞÁù])) { goto aô‡Œ‰; aô‡Œ‰: if (empty($C¥¼¶‘­Ô)) { $C¥¼¶‘­Ô = $this->config; } $fÅÈãÂÁöö = $C¥¼¶‘­Ô[$B÷Œ­÷˜”…[837]] . ($C¥¼¶‘­Ô[$B÷Œ­÷˜”…[838]] ? "\x3a{$C¥¼¶‘­Ô[$B÷Œ­÷˜”…[838]]}" : $B÷Œ­÷˜”…[33]); $aÃ³·‡½õ = !empty($C¥¼¶‘­Ô[$B÷Œ­÷˜”…[13]][$B÷Œ­÷˜”…[14]]) ? $C¥¼¶‘­Ô[$B÷Œ­÷˜”…[13]][$B÷Œ­÷˜”…[14]] : $this->pconnect; goto càµŞ«·šù; b«Ö”»˜İ¥: mysql_query($B÷Œ­÷˜”…[841] . think_config($B÷Œ­÷˜”…[842]) . $B÷Œ­÷˜”…[55], $this->linkID[$E‹çÛŞÁù]); if ($B¹„˜óá > $B÷Œ­÷˜”…[843]) { mysql_query($B÷Œ­÷˜”…[844], $this->linkID[$E‹çÛŞÁù]); } $this->connected = !0; goto F†ñ»ö™¢æ; F†ñ»ö™¢æ: if (1 != think_config($B÷Œ­÷˜”…[18])) { unset($this->config); } goto e¤¤¥¯Úˆø; càµŞ«·šù: if ($aÃ³·‡½õ) { $this->linkID[$E‹çÛŞÁù] = mysql_pconnect($fÅÈãÂÁöö, $C¥¼¶‘­Ô[$B÷Œ­÷˜”…[839]], $C¥¼¶‘­Ô[$B÷Œ­÷˜”…[840]], 131072); } else { $this->linkID[$E‹çÛŞÁù] = mysql_connect($fÅÈãÂÁöö, $C¥¼¶‘­Ô[$B÷Œ­÷˜”…[839]], $C¥¼¶‘­Ô[$B÷Œ­÷˜”…[840]], !0, 131072); } if (!$this->linkID[$E‹çÛŞÁù] || !empty($C¥¼¶‘­Ô[$B÷Œ­÷˜”…[17]]) && !mysql_select_db($C¥¼¶‘­Ô[$B÷Œ­÷˜”…[17]], $this->linkID[$E‹çÛŞÁù])) { think_exception(mysql_error()); } $B¹„˜óá = mysql_get_server_info($this->linkID[$E‹çÛŞÁù]); goto b«Ö”»˜İ¥; e¤¤¥¯Úˆø: } return $this->linkID[$E‹çÛŞÁù]; } public function free() { mysql_free_result($this->queryID); $this->queryID = null; } public function query($AŞíù¸Å¯¤) { goto a¶Ä‰–¯µ±; F¢Æ˜»ËŸ: think_action_status($F‘´ÀÚ—Œ[19], 1); think_status($F‘´ÀÚ—Œ[20]); $this->queryID = mysql_query($AŞíù¸Å¯¤, $this->_linkID); goto bÛŠ†”Àğ²; bÛŠ†”Àğ²: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = mysql_num_rows($this->queryID); return $this->getAll(); } goto bÁ‚–¾¬õÛ; a¶Ä‰–¯µ±: $F‘´ÀÚ—Œ =& $_SERVER[¬¦ã¾]; if (0 === stripos($AŞíù¸Å¯¤, $F‘´ÀÚ—Œ[262])) { $this->close(); $this->connected = !1; } $this->initConnect(!1); goto D™ä¥ªİâ¬; D™ä¥ªİâ¬: if (!$this->_linkID) { return !1; } $this->queryStr = $AŞíù¸Å¯¤; if ($this->queryID) { $this->free(); } goto F¢Æ˜»ËŸ; bÁ‚–¾¬õÛ: } public function execute($d–Ôôƒ‘±) { goto Cœ¸‹âÇ†; AÒˆŒ‡£ˆÚ: think_status($b®ã…°ÇŞæ[20]); $a¦³¸„ŒÒ• = mysql_query($d–Ôôƒ‘±, $this->_linkID); $this->debug(); goto DÎÇØæ•ø; e„ù¿—Ë‚ì: $this->queryStr = $d–Ôôƒ‘±; if ($this->queryID) { $this->free(); } think_action_status($b®ã…°ÇŞæ[21], 1); goto AÒˆŒ‡£ˆÚ; DÎÇØæ•ø: if (!1 === $a¦³¸„ŒÒ•) { $this->error(); return !1; } else { $this->numRows = mysql_affected_rows($this->_linkID); $this->lastInsID = mysql_insert_id($this->_linkID); return $this->numRows; } goto B¤à‚¦œ³; Cœ¸‹âÇ†: $b®ã…°ÇŞæ =& $_SERVER[¬¦ã¾]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto e„ù¿—Ë‚ì; B¤à‚¦œ³: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { mysql_query($_SERVER[¬¦ã¾][845], $this->_linkID); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $fÁÉ’­¾Ş = mysql_query($_SERVER[¬¦ã¾][846], $this->_linkID); $this->transTimes = 0; if (!$fÁÉ’­¾Ş) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $BøÛï†¨ÏË = mysql_query($_SERVER[¬¦ã¾][847], $this->_linkID); $this->transTimes = 0; if (!$BøÛï†¨ÏË) { $this->error(); return !1; } } return !0; } private function getAll() { $féÃ›ÉÌœ = array(); if ($this->numRows > 0) { while ($Fñ©ïÇ¢‹ = mysql_fetch_assoc($this->queryID)) { $féÃ›ÉÌœ[] = $Fñ©ïÇ¢‹; } mysql_data_seek($this->queryID, 0); } return $féÃ›ÉÌœ; } public function getFields($B…»‹‡¬ì») { $B‹ƒÉñÅ =& $_SERVER[¬¦ã¾]; $fÅ¡¼Êƒ = $this->query($B‹ƒÉñÅ[848] . $this->parseKey($B…»‹‡¬ì»)); $F‰ËŒÉ£ƒé = array(); if ($fÅ¡¼Êƒ) { foreach ($fÅ¡¼Êƒ as $fáŠŒ‹…Ä· => $cà²ïñëºÎ) { $F‰ËŒÉ£ƒé[$cà²ïñëºÎ[$B‹ƒÉñÅ[27]]] = array($B‹ƒÉñÅ[28] => $cà²ïñëºÎ[$B‹ƒÉñÅ[27]], $B‹ƒÉñÅ[29] => $cà²ïñëºÎ[$B‹ƒÉñÅ[30]], $B‹ƒÉñÅ[31] => (bool) (strtoupper($cà²ïñëºÎ[$B‹ƒÉñÅ[32]]) === $B‹ƒÉñÅ[849]), $B‹ƒÉñÅ[34] => $cà²ïñëºÎ[$B‹ƒÉñÅ[35]], $B‹ƒÉñÅ[36] => strtolower($cà²ïñëºÎ[$B‹ƒÉñÅ[37]]) == $B‹ƒÉñÅ[38], $B‹ƒÉñÅ[39] => strtolower($cà²ïñëºÎ[$B‹ƒÉñÅ[40]]) == $B‹ƒÉñÅ[41]); } } return $F‰ËŒÉ£ƒé; } public function getTables($dëå˜˜´Áå = '') { $cù„‹­‘½„ =& $_SERVER[¬¦ã¾]; if (!empty($dëå˜˜´Áå)) { $Bï·Šä“‚› = $cù„‹­‘½„[850] . $dëå˜˜´Áå . $cù„‹­‘½„[851]; } else { $Bï·Šä“‚› = $cù„‹­‘½„[852]; } $a†Èã”øÅ = $this->query($Bï·Šä“‚›); $f¯Š¢ëÆ§ˆ = array(); foreach ($a†Èã”øÅ as $càšÆµ» => $aÃ½¤ñ ) { $f¯Š¢ëÆ§ˆ[$càšÆµ»] = current($aÃ½¤ñ ); } return $f¯Š¢ëÆ§ˆ; } public function replace($Fãİ±õ¾×, $f„Åæ¹òÄô = array()) { $AÆğÒ†ÀÀ =& $_SERVER[¬¦ã¾]; foreach ($Fãİ±õ¾× as $dÌëµÀ¢ø‚ => $CÇ×¤¾îÏí) { $bãˆÈöĞ = $this->parseValue($CÇ×¤¾îÏí); if (is_scalar($bãˆÈöĞ)) { $F¡éî­´½˜[] = $bãˆÈöĞ; $C°»¯¯‰áˆ[] = $this->parseKey($dÌëµÀ¢ø‚); } } $bÍ–…çßÕö = $AÆğÒ†ÀÀ[853] . $this->parseTable($f„Åæ¹òÄô[$AÆğÒ†ÀÀ[277]]) . $AÆğÒ†ÀÀ[854] . implode($AÆğÒ†ÀÀ[47], $C°»¯¯‰áˆ) . $AÆğÒ†ÀÀ[855] . implode($AÆğÒ†ÀÀ[47], $F¡éî­´½˜) . $AÆğÒ†ÀÀ[856]; return $this->execute($bÍ–…çßÕö); } public function insertAll($ağÖßÇãõ›, $f¸‰ë»¦ = array(), $aß½ëÜ³ÌÚ = false) { goto D«…İ©ß…è; D ™¡É×¼Â: $D ÈíùåÔî = array(); foreach ($ağÖßÇãõ› as $eª¢ÒÔ£õ) { $FƒÄÈÇ‚ÛÙ = array(); foreach ($eª¢ÒÔ£õ as $A˜Ù²Ğì‹Ó => $f¦‡íÙíµ”) { $f¦‡íÙíµ” = $this->parseValue($f¦‡íÙíµ”); if (is_scalar($f¦‡íÙíµ”)) { $FƒÄÈÇ‚ÛÙ[] = $f¦‡íÙíµ”; } } $D ÈíùåÔî[] = $Dùâ½ÛˆÎ[258] . implode($Dùâ½ÛˆÎ[47], $FƒÄÈÇ‚ÛÙ) . $Dùâ½ÛˆÎ[856]; } array_walk($EÕ³‹Éƒ¯Ô, array($this, $Dùâ½ÛˆÎ[857])); goto d³Í‡×”—; D«…İ©ß…è: $Dùâ½ÛˆÎ =& $_SERVER[¬¦ã¾]; if (!is_array($ağÖßÇãõ›[0])) { return !1; } $EÕ³‹Éƒ¯Ô = array_keys($ağÖßÇãõ›[0]); goto D ™¡É×¼Â; d³Í‡×”—: $dÕ‰£²¾ø† = ($aß½ëÜ³ÌÚ ? $Dùâ½ÛˆÎ[858] : $Dùâ½ÛˆÎ[859]) . $Dùâ½ÛˆÎ[860] . $this->parseTable($f¸‰ë»¦[$Dùâ½ÛˆÎ[277]]) . $Dùâ½ÛˆÎ[854] . implode($Dùâ½ÛˆÎ[47], $EÕ³‹Éƒ¯Ô) . $Dùâ½ÛˆÎ[861] . implode($Dùâ½ÛˆÎ[47], $D ÈíùåÔî); return $this->execute($dÕ‰£²¾ø†); goto aõÎä¸Í; aõÎä¸Í: } public function close() { if ($this->_linkID) { mysql_close($this->_linkID); } $this->_linkID = null; } public function error() { $CŸğ®•Õ´Ò =& $_SERVER[¬¦ã¾]; $this->error = mysql_errno() . $CŸğ®•Õ´Ò[4] . mysql_error($this->_linkID); if ($CŸğ®•Õ´Ò[33] != $this->queryStr) { $this->error .= LNG($CŸğ®•Õ´Ò[45]) . $this->queryStr; } think_trace($this->error, $CŸğ®•Õ´Ò[33], $CŸğ®•Õ´Ò[46]); return $this->error; } public function escapeString($cÒä¤‚ê¶¢) { if ($this->_linkID) { return mysql_real_escape_string($cÒä¤‚ê¶¢, $this->_linkID); } else { return mysql_escape_string($cÒä¤‚ê¶¢); } } public function parseKey(&$f¯ÒÅÄèÅŒ, $Aµ¤º‰‚íË = true) { $Aãù¥Î³¤ =& $_SERVER[¬¦ã¾]; if ($Aµ¤º‰‚íË) { $f¯ÒÅÄèÅŒ = $this->parseKeyCheck($f¯ÒÅÄèÅŒ); } if ($f¯ÒÅÄèÅŒ != $Aãù¥Î³¤[182] && !preg_match($Aãù¥Î³¤[862], $f¯ÒÅÄèÅŒ)) { $f¯ÒÅÄèÅŒ = $Aãù¥Î³¤[382] . trim($f¯ÒÅÄèÅŒ, $Aãù¥Î³¤[382]) . $Aãù¥Î³¤[382]; } return $f¯ÒÅÄèÅŒ; } } class DbMysqli extends Db { public function __construct($DºÊ­™•´É = '') { $aÌ¥‘ÌÃ =& $_SERVER[¬¦ã¾]; if (!extension_loaded($aÌ¥‘ÌÃ[750])) { think_exception(think_lang($aÌ¥‘ÌÃ[10]) . $aÌ¥‘ÌÃ[863]); } if (!empty($DºÊ­™•´É)) { $this->config = $DºÊ­™•´É; if (empty($this->config[$aÌ¥‘ÌÃ[13]])) { $this->config[$aÌ¥‘ÌÃ[13]] = $aÌ¥‘ÌÃ[33]; } } } public function connect($eÀĞÎÀìÀ = '', $dñ¬š¹á©° = 0) { $cÔéÌÖåÊ =& $_SERVER[¬¦ã¾]; if (!isset($this->linkID[$dñ¬š¹á©°])) { goto dË†ñ®Ÿšˆ; C“š‹«‡´Ù: $f‰Û›Ñæ‘ = $this->linkID[$dñ¬š¹á©°]->server_version; $this->linkID[$dñ¬š¹á©°]->query($cÔéÌÖåÊ[841] . think_config($cÔéÌÖåÊ[842]) . $cÔéÌÖåÊ[55]); if ($f‰Û›Ñæ‘ > $cÔéÌÖåÊ[843]) { $this->linkID[$dñ¬š¹á©°]->query($cÔéÌÖåÊ[844]); } goto f“±¯§¢÷; f“±¯§¢÷: $this->connected = !0; if (1 != think_config($cÔéÌÖåÊ[18])) { unset($this->config); } goto AØï¥¶“Èœ; dË†ñ®Ÿšˆ: if (empty($eÀĞÎÀìÀ)) { $eÀĞÎÀìÀ = $this->config; } $this->linkID[$dñ¬š¹á©°] = new mysqli($eÀĞÎÀìÀ[$cÔéÌÖåÊ[837]], $eÀĞÎÀìÀ[$cÔéÌÖåÊ[839]], $eÀĞÎÀìÀ[$cÔéÌÖåÊ[840]], $eÀĞÎÀìÀ[$cÔéÌÖåÊ[17]], $eÀĞÎÀìÀ[$cÔéÌÖåÊ[838]] ? intval($eÀĞÎÀìÀ[$cÔéÌÖåÊ[838]]) : 3306); if (mysqli_connect_errno()) { think_exception(mysqli_connect_error()); } goto C“š‹«‡´Ù; AØï¥¶“Èœ: } return $this->linkID[$dñ¬š¹á©°]; } public function free() { $this->queryID->free_result(); $this->queryID = null; } public function query($F¼î‰‰Ö) { goto b‡öŠ¨ÕÈ; cÇåñ‚šÄœ: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = $this->queryID->num_rows; $this->numCols = $this->queryID->field_count; return $this->getAll(); } goto CŸÚ‡³¸§Ò; b‡öŠ¨ÕÈ: $EÑ Œğ…Â =& $_SERVER[¬¦ã¾]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto bÈğ…å’Ú®; bÈğ…å’Ú®: $this->queryStr = $F¼î‰‰Ö; if ($this->queryID) { $this->free(); } think_action_status($EÑ Œğ…Â[19], 1); goto A¤›çÆ»Œé; A¤›çÆ»Œé: think_status($EÑ Œğ…Â[20]); $this->queryID = $this->_linkID->query($F¼î‰‰Ö); if ($this->_linkID->more_results()) { while (($EÔ¿÷½º‹ = $this->_linkID->next_result()) != NULL) { $EÔ¿÷½º‹->free_result(); } } goto cÇåñ‚šÄœ; CŸÚ‡³¸§Ò: } public function execute($d‰¹¨í÷ƒ) { goto BÙ‰˜äîÁç; E‚ÜİÊÖî‚: $this->queryStr = $d‰¹¨í÷ƒ; if ($this->queryID) { $this->free(); } think_action_status($Aø´ÅÇ§ñ•[21], 1); goto DÛîµ‰·å; Bİ¨¹œ±Ì¡: if (!1 === $EÔ‡ó÷”õ”) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->affected_rows; $this->lastInsID = $this->_linkID->insert_id; return $this->numRows; } goto CÄº„âë‘‚; BÙ‰˜äîÁç: $Aø´ÅÇ§ñ• =& $_SERVER[¬¦ã¾]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto E‚ÜİÊÖî‚; DÛîµ‰·å: think_status($Aø´ÅÇ§ñ•[20]); $EÔ‡ó÷”õ” = $this->_linkID->query($d‰¹¨í÷ƒ); $this->debug(); goto Bİ¨¹œ±Ì¡; CÄº„âë‘‚: } public function startTrans() { $this->initConnect(!0); if ($this->transTimes == 0) { $this->_linkID->autocommit(!1); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $E’¡šœæÙ = $this->_linkID->commit(); $this->_linkID->autocommit(!0); $this->transTimes = 0; if (!$E’¡šœæÙ) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $bì¶è¶çÜ = $this->_linkID->rollback(); $this->transTimes = 0; if (!$bì¶è¶çÜ) { $this->error(); return !1; } } return !0; } private function getAll() { $EãØï‡œŸƒ = array(); if ($this->numRows > 0) { for ($aƒÙÂ¤‰÷œ = 0; $aƒÙÂ¤‰÷œ < $this->numRows; $aƒÙÂ¤‰÷œ++) { $EãØï‡œŸƒ[$aƒÙÂ¤‰÷œ] = $this->queryID->fetch_assoc(); } $this->queryID->data_seek(0); } return $EãØï‡œŸƒ; } public function getFields($a‡¼¥‘°´Ö) { $D¦½¼ê¤†Ò =& $_SERVER[¬¦ã¾]; $eøàÑŒëãç = $this->query($D¦½¼ê¤†Ò[848] . $this->parseKey($a‡¼¥‘°´Ö)); $eï…–†ƒÏá = array(); if ($eøàÑŒëãç) { foreach ($eøàÑŒëãç as $E¹ËÇ–àê => $dŞ¸ÍãÛ—ä) { $eï…–†ƒÏá[$dŞ¸ÍãÛ—ä[$D¦½¼ê¤†Ò[27]]] = array($D¦½¼ê¤†Ò[28] => $dŞ¸ÍãÛ—ä[$D¦½¼ê¤†Ò[27]], $D¦½¼ê¤†Ò[29] => $dŞ¸ÍãÛ—ä[$D¦½¼ê¤†Ò[30]], $D¦½¼ê¤†Ò[31] => (bool) ($dŞ¸ÍãÛ—ä[$D¦½¼ê¤†Ò[32]] === $D¦½¼ê¤†Ò[33]), $D¦½¼ê¤†Ò[34] => $dŞ¸ÍãÛ—ä[$D¦½¼ê¤†Ò[35]], $D¦½¼ê¤†Ò[36] => strtolower($dŞ¸ÍãÛ—ä[$D¦½¼ê¤†Ò[37]]) == $D¦½¼ê¤†Ò[38], $D¦½¼ê¤†Ò[39] => strtolower($dŞ¸ÍãÛ—ä[$D¦½¼ê¤†Ò[40]]) == $D¦½¼ê¤†Ò[41]); } } return $eï…–†ƒÏá; } public function getTables($a‹ëÂÙÙÂó = '') { $D¼¦¦­ª‚  =& $_SERVER[¬¦ã¾]; $A”òŒ­øˆá = !empty($a‹ëÂÙÙÂó) ? $D¼¦¦­ª‚ [850] . $a‹ëÂÙÙÂó . $D¼¦¦­ª‚ [851] : $D¼¦¦­ª‚ [852]; $c¯àÉøï = $this->query($A”òŒ­øˆá); $cŒ‡±Í½ö = array(); if ($c¯àÉøï) { foreach ($c¯àÉøï as $a’çÙÖåœÓ => $a§õêÑÎ£Ó) { $cŒ‡±Í½ö[$a’çÙÖåœÓ] = current($a§õêÑÎ£Ó); } } return $cŒ‡±Í½ö; } public function replace($cõ‰ƒ¡¡®·, $Fµƒ©šÕŠ = array()) { $aË¤Ï’ƒ› =& $_SERVER[¬¦ã¾]; foreach ($cõ‰ƒ¡¡®· as $CÆá´ªÄíÉ => $a«Û¾¿ Ñµ) { $aÇ¬»…ìê™ = $this->parseValue($a«Û¾¿ Ñµ); if (is_scalar($aÇ¬»…ìê™)) { $cÖ¸Æ–•ôÄ[] = $aÇ¬»…ìê™; $FŞ²…ö›è[] = $this->parseKey($CÆá´ªÄíÉ); } } $CÒØ–©˜Ü = $aË¤Ï’ƒ›[853] . $this->parseTable($Fµƒ©šÕŠ[$aË¤Ï’ƒ›[277]]) . $aË¤Ï’ƒ›[854] . implode($aË¤Ï’ƒ›[47], $FŞ²…ö›è) . $aË¤Ï’ƒ›[855] . implode($aË¤Ï’ƒ›[47], $cÖ¸Æ–•ôÄ) . $aË¤Ï’ƒ›[856]; return $this->execute($CÒØ–©˜Ü); } public function insertAll($CŠ’‹’ ğ¼, $a²·Øå™©ó = array(), $eâÔ‚Ç¹ÇÀ = false) { goto Bˆƒºïò¡; dÙ×›ëŸôœ: $FØ£†½ÉëÊ = $eâÔ‚Ç¹ÇÀ ? $aß¦ÆÛœ±‡[858] : $aß¦ÆÛœ±‡[859]; $C³†İğĞí‡ = $FØ£†½ÉëÊ . $aß¦ÆÛœ±‡[860] . $this->parseTable($a²·Øå™©ó[$aß¦ÆÛœ±‡[277]]) . $aß¦ÆÛœ±‡[854] . implode($aß¦ÆÛœ±‡[47], $Bµ³ÉÉ£ô³) . $aß¦ÆÛœ±‡[861] . implode($aß¦ÆÛœ±‡[47], $d…õ™§µ¢Œ); return $this->execute($C³†İğĞí‡); goto eœéèÊºïí; Bˆƒºïò¡: $aß¦ÆÛœ±‡ =& $_SERVER[¬¦ã¾]; if (!is_array($CŠ’‹’ ğ¼[0])) { return !1; } $Bµ³ÉÉ£ô³ = array_keys($CŠ’‹’ ğ¼[0]); goto e™ğ°«ÕÔ; e™ğ°«ÕÔ: $d…õ™§µ¢Œ = array(); foreach ($CŠ’‹’ ğ¼ as $eï›ŠŠ¥´ ) { $bÜé¯Äæ©• = array(); foreach ($eï›ŠŠ¥´  as $böø’õ÷ˆ => $C¬„‰ê¸‘§) { $C¬„‰ê¸‘§ = $this->parseValue($C¬„‰ê¸‘§); if (is_scalar($C¬„‰ê¸‘§)) { $bÜé¯Äæ©•[] = $C¬„‰ê¸‘§; } } $d…õ™§µ¢Œ[] = $aß¦ÆÛœ±‡[258] . implode($aß¦ÆÛœ±‡[47], $bÜé¯Äæ©•) . $aß¦ÆÛœ±‡[856]; } array_walk($Bµ³ÉÉ£ô³, array($this, $aß¦ÆÛœ±‡[857])); goto dÙ×›ëŸôœ; eœéèÊºïí: } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $b„ï¼¹¯Æê =& $_SERVER[¬¦ã¾]; $this->error = $this->_linkID->errno . $b„ï¼¹¯Æê[4] . $this->_linkID->error; if ($b„ï¼¹¯Æê[33] != $this->queryStr) { $this->error .= LNG($b„ï¼¹¯Æê[45]) . $this->queryStr; } think_trace($this->error, $b„ï¼¹¯Æê[33], $b„ï¼¹¯Æê[46]); return $this->error; } public function escapeString($b‘¤…é¨„ª) { if ($this->_linkID) { return $this->_linkID->real_escape_string($b‘¤…é¨„ª); } else { return addslashes($b‘¤…é¨„ª); } } public function parseKey(&$eª¼„½ùÍÄ, $BÍñ¯Ó«…­ = true) { $DõŞƒ»¤Ö— =& $_SERVER[¬¦ã¾]; if ($BÍñ¯Ó«…­) { $eª¼„½ùÍÄ = $this->parseKeyCheck($eª¼„½ùÍÄ); } if ($eª¼„½ùÍÄ != $DõŞƒ»¤Ö—[182] && !preg_match($DõŞƒ»¤Ö—[862], $eª¼„½ùÍÄ)) { $eª¼„½ùÍÄ = $DõŞƒ»¤Ö—[382] . trim($eª¼„½ùÍÄ, $DõŞƒ»¤Ö—[382]) . $DõŞƒ»¤Ö—[382]; } return $eª¼„½ùÍÄ; } } class DbPdo extends Db { protected $PDOStatement = null; private $table = ''; public function __construct($B•¾¨é¾Ì = '') { $AÀèœè™ÚŞ =& $_SERVER[¬¦ã¾]; if (!class_exists($AÀèœè™ÚŞ[864])) { think_exception(think_lang($AÀèœè™ÚŞ[10]) . $AÀèœè™ÚŞ[865]); } if (!empty($B•¾¨é¾Ì)) { $this->config = $B•¾¨é¾Ì; if (empty($this->config[$AÀèœè™ÚŞ[13]])) { $this->config[$AÀèœè™ÚŞ[13]] = array(); } } } public function connect($CÇ­Ô’× = '', $B‡†é£ÊŒ = 0) { $bÎí…¡Ë„© =& $_SERVER[¬¦ã¾]; if (!isset($this->linkID[$B‡†é£ÊŒ])) { goto aæÛ™Ú­; FÜŠÊîÛÁ: if (1 != think_config($bÎí…¡Ë„©[18])) { unset($this->config); } goto c—Ğ•Õ¬¿ô; c˜ƒâ³Ú§: try { $this->linkID[$B‡†é£ÊŒ] = new PDO($CÇ­Ô’×[$bÎí…¡Ë„©[866]], $CÇ­Ô’×[$bÎí…¡Ë„©[839]], $CÇ­Ô’×[$bÎí…¡Ë„©[840]], $CÇ­Ô’×[$bÎí…¡Ë„©[13]]); } catch (PDOException $a‘ßÅŒÀ˜…) { think_exception($a‘ßÅŒÀ˜…->getMessage()); } $this->dbType = $this->_getDsnType($CÇ­Ô’×[$bÎí…¡Ë„©[866]]); if (in_array($this->dbType, array($bÎí…¡Ë„©[867], $bÎí…¡Ë„©[868], $bÎí…¡Ë„©[869], $bÎí…¡Ë„©[870]))) { think_exception($bÎí…¡Ë„©[871] . $this->dbType . $bÎí…¡Ë„©[872] . $this->dbType . $bÎí…¡Ë„©[873]); } goto d«ç©›ô£; aæÛ™Ú­: if (empty($CÇ­Ô’×)) { $CÇ­Ô’× = $this->config; } $dê©íÜßÒ = !empty($CÇ­Ô’×[$bÎí…¡Ë„©[13]][$bÎí…¡Ë„©[14]]) ? $CÇ­Ô’×[$bÎí…¡Ë„©[13]][$bÎí…¡Ë„©[14]] : $this->pconnect; if ($dê©íÜßÒ) { $CÇ­Ô’×[$bÎí…¡Ë„©[13]][PDO::ATTR_PERSISTENT] = !0; } goto c˜ƒâ³Ú§; d«ç©›ô£: if (!$this->linkID[$B‡†é£ÊŒ]) { think_exception($bÎí…¡Ë„©[874]); } try { $this->linkID[$B‡†é£ÊŒ]->exec($bÎí…¡Ë„©[875] . think_config($bÎí…¡Ë„©[842])); } catch (Exception $a‘ßÅŒÀ˜…) { } $this->connected = !0; goto FÜŠÊîÛÁ; c—Ğ•Õ¬¿ô: } return $this->linkID[$B‡†é£ÊŒ]; } public function free() { $this->PDOStatement = null; } public function query($FÆ»Ùëí†, $A´ŸçÒ±­¶ = array()) { goto cËè•ŞŠ¢; cÊ¾áĞ†·¼: if (!1 === $C¦”ƒÆÅ») { $this->error(); return !1; } else { return $this->getAll(); } goto C±×Á²¾Œİ; EŠéÀÍë: $this->queryStr = $FÆ»Ùëí†; if (!empty($A´ŸçÒ±­¶)) { $this->queryStr .= $Dš³–”Õçï[876] . print_r($A´ŸçÒ±­¶, !0) . $Dš³–”Õçï[877]; } if (!empty($this->PDOStatement)) { $this->free(); } goto f’º‚š™‡á; f’º‚š™‡á: think_action_status($Dš³–”Õçï[19], 1); think_status($Dš³–”Õçï[20]); $this->PDOStatement = $this->_linkID->prepare($FÆ»Ùëí†); goto bâ²Ó­ÌÕ; cËè•ŞŠ¢: $Dš³–”Õçï =& $_SERVER[¬¦ã¾]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto EŠéÀÍë; bâ²Ó­ÌÕ: if (!1 === $this->PDOStatement) { think_exception($this->error()); } $C¦”ƒÆÅ» = $this->PDOStatement->execute($A´ŸçÒ±­¶); $this->debug(); goto cÊ¾áĞ†·¼; C±×Á²¾Œİ: } public function execute($f‚æÔî»§Œ, $fì«ää± = array()) { goto e·—ƒÕ†ÖŠ; fËÙ¸ò¿è¦: $this->queryStr = $f‚æÔî»§Œ; if (!empty($fì«ää±)) { $this->queryStr .= $aİ–„ìŞÛ[876] . print_r($fì«ää±, !0) . $aİ–„ìŞÛ[877]; } $aËŞØÙØÃã = !1; goto B¦¡•ÕèÅ¹; B¦¡•ÕèÅ¹: if ($this->dbType == $aİ–„ìŞÛ[870]) { if (preg_match($aİ–„ìŞÛ[878], $this->queryStr, $A¯×ŒğŒŞ)) { $this->table = think_config($aİ–„ìŞÛ[879]) . str_ireplace(think_config($aİ–„ìŞÛ[880]), $aİ–„ìŞÛ[375], $A¯×ŒğŒŞ[2]); $aËŞØÙØÃã = (bool) $this->query($aİ–„ìŞÛ[881] . strtoupper($this->table) . $aİ–„ìŞÛ[55]); } } if (!empty($this->PDOStatement)) { $this->free(); } think_action_status($aİ–„ìŞÛ[21], 1); goto dì¬÷®İˆÓ; dì¬÷®İˆÓ: think_status($aİ–„ìŞÛ[20]); $this->PDOStatement = $this->_linkID->prepare($f‚æÔî»§Œ); if (!1 === $this->PDOStatement) { think_exception($this->error()); } goto EÛ©ÊĞ°™›; e·—ƒÕ†ÖŠ: $aİ–„ìŞÛ =& $_SERVER[¬¦ã¾]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto fËÙ¸ò¿è¦; EÛ©ÊĞ°™›: $a‰¿öìõ· = $this->PDOStatement->execute($fì«ää±); $this->debug(); if (!1 === $a‰¿öìõ·) { $this->error(); return !1; } else { $this->numRows = $this->PDOStatement->rowCount(); if ($aËŞØÙØÃã || preg_match($aİ–„ìŞÛ[882], $f‚æÔî»§Œ)) { $this->lastInsID = $this->getLastInsertId(); } return $this->numRows; } goto a†ÆÀÕ‡Õ‡; a†ÆÀÕ‡Õ‡: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->beginTransaction(); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $e‰æáÄáğà = $this->_linkID->commit(); $this->transTimes = 0; if (!$e‰æáÄáğà) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $Døªì½õÆ± = $this->_linkID->rollback(); $this->transTimes = 0; if (!$Døªì½õÆ±) { $this->error(); return !1; } } return !0; } private function getAll() { $d‰Ù¹Õô˜Ì = $this->PDOStatement->fetchAll(PDO::FETCH_ASSOC); $this->numRows = count($d‰Ù¹Õô˜Ì); return $d‰Ù¹Õô˜Ì; } public function getFields($e¯ÏÇ…öä¿) { goto C°à•Åçì¶; F±…­Ô”‹: $D„ÏœëÖâ = $this->query($bğáğ£Ä¡á); $bŞ‘÷ÒŒæ« = array(); if ($D„ÏœëÖâ) { foreach ($D„ÏœëÖâ as $Aµ²ÌÔÌô => $AÅšÃô²Ì˜) { $AÅšÃô²Ì˜ = array_change_key_case($AÅšÃô²Ì˜); $AÅšÃô²Ì˜[$FĞ¼éëÆÈ¡[28]] = isset($AÅšÃô²Ì˜[$FĞ¼éëÆÈ¡[28]]) ? $AÅšÃô²Ì˜[$FĞ¼éëÆÈ¡[28]] : $FĞ¼éëÆÈ¡[375]; $AÅšÃô²Ì˜[$FĞ¼éëÆÈ¡[29]] = isset($AÅšÃô²Ì˜[$FĞ¼éëÆÈ¡[29]]) ? $AÅšÃô²Ì˜[$FĞ¼éëÆÈ¡[29]] : $FĞ¼éëÆÈ¡[375]; $C‡±„§ä”à = isset($AÅšÃô²Ì˜[$FĞ¼éëÆÈ¡[271]]) ? $AÅšÃô²Ì˜[$FĞ¼éëÆÈ¡[271]] : $AÅšÃô²Ì˜[$FĞ¼éëÆÈ¡[28]]; $bŞ‘÷ÒŒæ«[$C‡±„§ä”à] = array($FĞ¼éëÆÈ¡[28] => $C‡±„§ä”à, $FĞ¼éëÆÈ¡[29] => $AÅšÃô²Ì˜[$FĞ¼éëÆÈ¡[29]], $FĞ¼éëÆÈ¡[31] => (bool) (isset($AÅšÃô²Ì˜[$FĞ¼éëÆÈ¡[103]]) && $AÅšÃô²Ì˜[$FĞ¼éëÆÈ¡[103]] === $FĞ¼éëÆÈ¡[33] || isset($AÅšÃô²Ì˜[$FĞ¼éëÆÈ¡[31]]) && $AÅšÃô²Ì˜[$FĞ¼éëÆÈ¡[31]] === $FĞ¼éëÆÈ¡[33]), $FĞ¼éëÆÈ¡[34] => isset($AÅšÃô²Ì˜[$FĞ¼éëÆÈ¡[34]]) ? $AÅšÃô²Ì˜[$FĞ¼éëÆÈ¡[34]] : (isset($AÅšÃô²Ì˜[$FĞ¼éëÆÈ¡[53]]) ? $AÅšÃô²Ì˜[$FĞ¼éëÆÈ¡[53]] : $FĞ¼éëÆÈ¡[375]), $FĞ¼éëÆÈ¡[36] => isset($AÅšÃô²Ì˜[$FĞ¼éëÆÈ¡[93]]) ? strtolower($AÅšÃô²Ì˜[$FĞ¼éëÆÈ¡[93]]) == $FĞ¼éëÆÈ¡[38] : (isset($AÅšÃô²Ì˜[$FĞ¼éëÆÈ¡[54]]) ? $AÅšÃô²Ì˜[$FĞ¼éëÆÈ¡[54]] : !1), $FĞ¼éëÆÈ¡[39] => isset($AÅšÃô²Ì˜[$FĞ¼éëÆÈ¡[899]]) ? strtolower($AÅšÃô²Ì˜[$FĞ¼éëÆÈ¡[899]]) == $FĞ¼éëÆÈ¡[41] : (isset($AÅšÃô²Ì˜[$FĞ¼éëÆÈ¡[93]]) ? $AÅšÃô²Ì˜[$FĞ¼éëÆÈ¡[93]] : !1)); } } goto a™°ô®Ÿ; a™°ô®Ÿ: return $bŞ‘÷ÒŒæ«; goto f•âÂ„¥Œ˜; C°à•Åçì¶: $FĞ¼éëÆÈ¡ =& $_SERVER[¬¦ã¾]; $this->initConnect(!0); if (think_config($FĞ¼éëÆÈ¡[883])) { $bğáğ£Ä¡á = str_replace($FĞ¼éëÆÈ¡[884], $e¯ÏÇ…öä¿, think_config($FĞ¼éëÆÈ¡[883])); } else { switch ($this->dbType) { case $FĞ¼éëÆÈ¡[867]: case $FĞ¼éëÆÈ¡[885]: $bğáğ£Ä¡á = "\123\x45\114\x45\x43\124\40\x20\x20\143\x6f\154\165\x6d\156\x5f\156\141\x6d\145\x20\x61\163\x20\x27\116\141\155\x65\x27\x2c\40\x20\40\x64\x61\x74\141\137\164\x79\160\145\x20\141\163\x20\x27\124\x79\160\x65\x27\x2c\x20\40\x20\x63\157\154\165\x6d\x6e\x5f\x64\145\146\141\165\154\x74\40\x61\x73\40\47\x44\x65\146\x61\x75\x6c\x74\x27\x2c\40\40\40\x69\163\137\156\x75\154\x6c\141\x62\154\145\40\x61\163\x20\x27\x4e\x75\x6c\154\x27\xa\11\11\106\122\117\115\x9\151\156\x66\x6f\162\155\141\x74\x69\x6f\x6e\137\x73\143\150\x65\x6d\x61\56\164\x61\142\x6c\145\163\40\101\123\40\164\xa\11\11\112\117\x49\116\11\151\156\146\x6f\x72\x6d\x61\164\151\x6f\x6e\137\x73\x63\150\x65\155\x61\x2e\143\x6f\154\165\x6d\156\163\x20\101\x53\40\x63\12\11\11\x4f\116\x20\40\x74\56\164\141\x62\154\x65\x5f\143\x61\x74\x61\x6c\157\x67\x20\x3d\40\143\56\164\x61\x62\154\x65\x5f\143\x61\x74\x61\154\157\x67\xa\x9\x9\x41\116\x44\40\x74\56\x74\x61\x62\x6c\145\137\x73\143\150\145\155\x61\x20\75\x20\143\56\164\x61\x62\x6c\x65\137\x73\x63\150\x65\155\141\xa\11\x9\x41\x4e\104\x20\x74\56\x74\x61\142\154\x65\x5f\x6e\141\x6d\145\40\x3d\40\143\56\x74\141\142\x6c\145\137\x6e\141\155\x65\xa\x9\x9\x57\x48\x45\x52\x45\40\40\x20\164\56\x74\x61\x62\154\x65\x5f\156\141\155\145\40\75\40\x27{$e¯ÏÇ…öä¿}\x27"; break; case $FĞ¼éëÆÈ¡[886]: $bğáğ£Ä¡á = $FĞ¼éëÆÈ¡[887] . $e¯ÏÇ…öä¿ . $FĞ¼éëÆÈ¡[888]; break; case $FĞ¼éëÆÈ¡[868]: case $FĞ¼éëÆÈ¡[870]: $bğáğ£Ä¡á = $FĞ¼éëÆÈ¡[889] . $FĞ¼éëÆÈ¡[890] . $FĞ¼éëÆÈ¡[891] . strtoupper($e¯ÏÇ…öä¿) . $FĞ¼éëÆÈ¡[892] . strtoupper($e¯ÏÇ…öä¿) . $FĞ¼éëÆÈ¡[893]; break; case $FĞ¼éëÆÈ¡[894]: $bğáğ£Ä¡á = $FĞ¼éëÆÈ¡[895] . $e¯ÏÇ…öä¿ . $FĞ¼éëÆÈ¡[896]; break; case $FĞ¼éëÆÈ¡[869]: break; case $FĞ¼éëÆÈ¡[897]: default: $bğáğ£Ä¡á = $FĞ¼éëÆÈ¡[898] . ($this->dbType == $FĞ¼éëÆÈ¡[897] ? "\x60{$e¯ÏÇ…öä¿}\x60" : $e¯ÏÇ…öä¿); } } goto F±…­Ô”‹; f•âÂ„¥Œ˜: } public function getTables($d·“ø™á¡ç = '') { $b­‰ôÁ†ƒ„ =& $_SERVER[¬¦ã¾]; if (think_config($b­‰ôÁ†ƒ„[900])) { $aÕŠ¾“É = str_replace($b­‰ôÁ†ƒ„[901], $d·“ø™á¡ç, think_config($b­‰ôÁ†ƒ„[900])); } else { switch ($this->dbType) { case $b­‰ôÁ†ƒ„[868]: case $b­‰ôÁ†ƒ„[870]: $aÕŠ¾“É = $b­‰ôÁ†ƒ„[902]; break; case $b­‰ôÁ†ƒ„[867]: case $b­‰ôÁ†ƒ„[885]: $aÕŠ¾“É = $b­‰ôÁ†ƒ„[903]; break; case $b­‰ôÁ†ƒ„[894]: $aÕŠ¾“É = $b­‰ôÁ†ƒ„[904]; break; case $b­‰ôÁ†ƒ„[869]: think_exception(think_lang($b­‰ôÁ†ƒ„[905]) . $b­‰ôÁ†ƒ„[906]); break; case $b­‰ôÁ†ƒ„[886]: $aÕŠ¾“É = $b­‰ôÁ†ƒ„[42] . $b­‰ôÁ†ƒ„[43] . $b­‰ôÁ†ƒ„[44]; break; case $b­‰ôÁ†ƒ„[897]: default: if (!empty($d·“ø™á¡ç)) { $aÕŠ¾“É = $b­‰ôÁ†ƒ„[850] . $d·“ø™á¡ç . $b­‰ôÁ†ƒ„[851]; } else { $aÕŠ¾“É = $b­‰ôÁ†ƒ„[852]; } } } $AÆ”Í°¤µ = $this->query($aÕŠ¾“É); $a…ùæ½©¨à = array(); foreach ($AÆ”Í°¤µ as $F¼ò‹ùÂ => $eÆö†ğæ¦Í) { $a…ùæ½©¨à[$F¼ò‹ùÂ] = current($eÆö†ğæ¦Í); } return $a…ùæ½©¨à; } protected function parseLimit($aˆ¨ŠµŸâß) { $FìÛ­Ç¿ ò =& $_SERVER[¬¦ã¾]; $A‰òƒ›æµÙ = $FìÛ­Ç¿ ò[33]; if (!empty($aˆ¨ŠµŸâß)) { switch ($this->dbType) { case $FìÛ­Ç¿ ò[894]: case $FìÛ­Ç¿ ò[886]: $aˆ¨ŠµŸâß = explode($FìÛ­Ç¿ ò[47], $aˆ¨ŠµŸâß); if (count($aˆ¨ŠµŸâß) > 1) { $A‰òƒ›æµÙ .= $FìÛ­Ç¿ ò[48] . $aˆ¨ŠµŸâß[1] . $FìÛ­Ç¿ ò[49] . $aˆ¨ŠµŸâß[0] . $FìÛ­Ç¿ ò[50]; } else { $A‰òƒ›æµÙ .= $FìÛ­Ç¿ ò[48] . $aˆ¨ŠµŸâß[0] . $FìÛ­Ç¿ ò[50]; } break; case $FìÛ­Ç¿ ò[867]: case $FìÛ­Ç¿ ò[885]: break; case $FìÛ­Ç¿ ò[869]: break; case $FìÛ­Ç¿ ò[868]: case $FìÛ­Ç¿ ò[870]: break; case $FìÛ­Ç¿ ò[897]: default: $A‰òƒ›æµÙ .= $FìÛ­Ç¿ ò[48] . $aˆ¨ŠµŸâß . $FìÛ­Ç¿ ò[50]; } } return $A‰òƒ›æµÙ; } public function parseKey(&$Eƒ¹‰Î×ò, $d‹¶˜ÅîÙ  = true) { $D£”†‘¡¾ =& $_SERVER[¬¦ã¾]; if ($d‹¶˜ÅîÙ ) { $Eƒ¹‰Î×ò = $this->parseKeyCheck($Eƒ¹‰Î×ò); } if ($this->dbType == $D£”†‘¡¾[897]) { if ($Eƒ¹‰Î×ò != $D£”†‘¡¾[182] && !preg_match($D£”†‘¡¾[862], $Eƒ¹‰Î×ò)) { $Eƒ¹‰Î×ò = $D£”†‘¡¾[382] . trim($Eƒ¹‰Î×ò, $D£”†‘¡¾[382]) . $D£”†‘¡¾[382]; } return $Eƒ¹‰Î×ò; } else { return parent::parseKey($Eƒ¹‰Î×ò, $d‹¶˜ÅîÙ ); } } public function close() { $this->_linkID = null; } public function error() { $EÆ†ÕãªµÜ =& $_SERVER[¬¦ã¾]; if ($this->PDOStatement) { $d×¡æÈÇ°Ö = $this->PDOStatement->errorInfo(); $this->error = $d×¡æÈÇ°Ö[1] . $EÆ†ÕãªµÜ[4] . $d×¡æÈÇ°Ö[2]; } else { $this->error = $EÆ†ÕãªµÜ[33]; } if ($EÆ†ÕãªµÜ[33] != $this->queryStr) { $this->error .= LNG($EÆ†ÕãªµÜ[45]) . $this->queryStr; } think_trace($this->error, $EÆ†ÕãªµÜ[33], $EÆ†ÕãªµÜ[46]); return $this->error; } public function escapeString($fšÁğÒ„) { $BìÏï•¦¶¢ =& $_SERVER[¬¦ã¾]; switch ($this->dbType) { case $BìÏï•¦¶¢[894]: case $BìÏï•¦¶¢[867]: case $BìÏï•¦¶¢[885]: case $BìÏï•¦¶¢[897]: return addslashes($fšÁğÒ„); case $BìÏï•¦¶¢[869]: case $BìÏï•¦¶¢[886]: case $BìÏï•¦¶¢[868]: case $BìÏï•¦¶¢[870]: return str_ireplace($BìÏï•¦¶¢[55], $BìÏï•¦¶¢[56], $fšÁğÒ„); } } protected function parseValue($F¤‰äñˆùÔ) { $bÒ˜¬ë²è— =& $_SERVER[¬¦ã¾]; if (is_string($F¤‰äñˆùÔ)) { $Aê–²òİª = strpos($F¤‰äñˆùÔ, $bÒ˜¬ë²è—[4]) === 0 && in_array($F¤‰äñˆùÔ, array_keys($this->bind)); $F¤‰äñˆùÔ = $Aê–²òİª ? $this->escapeString($F¤‰äñˆùÔ) : $bÒ˜¬ë²è—[907] . $this->escapeString($F¤‰äñˆùÔ) . $bÒ˜¬ë²è—[907]; } elseif (isset($F¤‰äñˆùÔ[0]) && is_string($F¤‰äñˆùÔ[0]) && strtolower($F¤‰äñˆùÔ[0]) == $bÒ˜¬ë²è—[295]) { $F¤‰äñˆùÔ = $this->escapeString($F¤‰äñˆùÔ[1]); } elseif (is_array($F¤‰äñˆùÔ)) { $F¤‰äñˆùÔ = array_map(array($this, $bÒ˜¬ë²è—[908]), $F¤‰äñˆùÔ); } elseif (is_bool($F¤‰äñˆùÔ)) { $F¤‰äñˆùÔ = $F¤‰äñˆùÔ ? $bÒ˜¬ë²è—[87] : $bÒ˜¬ë²è—[191]; } elseif (is_null($F¤‰äñˆùÔ)) { $F¤‰äñˆùÔ = $bÒ˜¬ë²è—[103]; } return $F¤‰äñˆùÔ; } public function getLastInsertId() { $eá…Õ†œğš =& $_SERVER[¬¦ã¾]; switch ($this->dbType) { case $eá…Õ†œğš[894]: case $eá…Õ†œğš[886]: case $eá…Õ†œğš[867]: case $eá…Õ†œğš[885]: case $eá…Õ†œğš[869]: case $eá…Õ†œğš[897]: return $this->_linkID->lastInsertId(); case $eá…Õ†œğš[868]: case $eá…Õ†œğš[870]: $BÛï¥³šË” = $this->table; $D‰îƒµ­¨„ = $this->query("\x53\x45\x4c\105\103\124\40{$BÛï¥³šË”}\x2e\x63\x75\162\162\166\141\x6c\x20\143\x75\x72\x72\166\x61\154\x20\106\122\117\115\x20\x64\x75\x61\x6c"); return $D‰îƒµ­¨„ ? $D‰îƒµ­¨„[0][$eá…Õ†œğš[909]] : 0; } } } goto e‘çÍ›“™ì; B¶İ«ô”Œ: if (!function_exists('_kodDe')) { function _kodDe($dµÆ‹˜÷°‹) { $dµÆ‹˜÷°‹ = base64_decode($dµÆ‹˜÷°‹); $CÈÖÑã”èó = strlen($dµÆ‹˜÷°‹); $f¹ÎÄ•âß = ''; $cÜ£§Ïºæ = ord($dµÆ‹˜÷°‹[0]) - 30; for ($BÍŒ¼—ˆá = 1; $BÍŒ¼—ˆá < $CÈÖÑã”èó; $BÍŒ¼—ˆá += 2) { if ($BÍŒ¼—ˆá + 1 < $CÈÖÑã”èó) { $f¹ÎÄ•âß .= chr(ord($dµÆ‹˜÷°‹[$BÍŒ¼—ˆá + 1]) + $cÜ£§Ïºæ); $f¹ÎÄ•âß .= chr(ord($dµÆ‹˜÷°‹[$BÍŒ¼—ˆá]) + $cÜ£§Ïºæ); } else { $f¹ÎÄ•âß .= chr(ord($dµÆ‹˜÷°‹[$BÍŒ¼—ˆá]) + $cÜ£§Ïºæ); } } return $f¹ÎÄ•âß; } } define(base64_decode('rKbjvg=='), "\xeb\xe4\xc7\x9c\xeb\x82\x89\x9e"); $_SERVER[¬¦ã¾] = explode(base64_decode('fAF8BXwC'), gzinflate(substr("\37\213\10\0\0\0\0\0\0\3\255\175\11\174\123\125\326\70\352\270\300\270\315\70\256\270\74\53\320\26\262\264\245\120\50\224\232\266\51\15\244\115\115\122\312\22"."\x8\x2f\xc9\x4b\xf3\xda\x24\x2f\x7d\xef\xa5\x1b\xe0\xbe\xa3\x8c\xa\xb8\xef\x8\x23\xea\xa8\x38\xa2\xa2\xe2\x3e\xb8\x8d\xcb\xc\xea\xa8\xe3\x32\xa2\x14\x5c\x47\xdc\x1d\x47\xfd\xee\x7e"."\357\173\111\235\357\373\375\377\12\344\336\163\227\167\227\163\317\75\347\334\163\317\335\164\376\145\303\333\317\271\150\371\136\313\367\135\276\367\226\27\156\333\166\345\17\157"."\337\200\143\340\377\137\55\337\17\207\117\130\171\300\50\364\337\76\53\57\54\53\153\231\72\146\122\333\201\277\277\367\217\362\155\362\106\171\145\300\377\374\137\174\7\275"."\170\307\34\357\360\272\347\7\207\367\32\365\335\27\376\375\152\101\146\134\266\26\377\110\131\315\224\224\1\325\60\15\14\210\153\331\244\332\205\303\152\26\377\272\361\217"."\xd1\x9b\x56\x4d\x5\x87\xa3\x6d\x81\x70\x34\xd4\xd1\xde\xee\xd\x86\xa3\xa4\x46\x31\x3d\xa3\x25\x48\x28\x27\xeb\x72\x86\x54\x9e\x53\x74\x3\x7c\x4a\xac\x2e\x9a\xd3\x72\x4a\xd6\x2\xe1".strrev('»Y×èå…«İe2(cˆ>Šó{Eˆä—»Axh‚Àşí¼›D555 Ù1Êl„€')."\274\263\175\155\122\70\350\151\13\171\32\303\276\100\33\6\67\6\132\133\175\341\102\170\60\340\367\67\170\32\347\26\246\264\7\75\263\133\75\22\150\137\132\211\252\331"."\244\126\46\55\305\51\113\245\162\34\150\126\225\164\2\7\263\62\155\216\71\230\43\241\60\13\201\71\310\346\323\151\34\151\143\41\322\176\45\51\347\323\144\314\232\304"."\110\116\127\63\62\355\372\134\145\220\101\161\100\316\233\232\232\215\343\210\167\300\324\145\16\7\55\216\353\112\106\311\222\252\102\136\277\267\61\54\301\146\112\315\301\100".base64_decode('q0SmIiMbpqJLnS3eoFeCTa8rRT0ulXC5jjYwIJLH75dGqsFUMjlaDS5TpLJAsA==')."\xc9\x1b\x94\x1a\x16\x48\x7c\x9c\xe2\x5a\x26\xa3\x65\x5d\xa0\x16\x30\x9f\xa6\xd0\x54\x6f\x30\x88\x3\xe\x82\xc1\x7e\x1f\x9c\x3a\x12\x9\x34\x37\x87\xbc\x2c\x46\x3a\x77\x8a\x1f\xb4\x64"."\x32\xc1\x52\x4b\x2c\x91\x4c\x9b\xd1\x3e\x39\x9d\xa7\xc8\xda\x83\x7f\x4b\xc9\xf\xf9\xd5\xc\x82\xc0\xbd\x6a\x56\xcd\x13\x64\x25\x55\x68\x1a\x5b\x39\x24\x90\xa7\xb9\x15\xa\x51\x12\x24".base64_decode('kAHlNbK4wErrw8G6Wfh3BskUi8I0RTejSjauJdQsWY/1ZO0RDJTNVJOugnykQg==').base64_decode('zRXXcoOtWh/pTFJNK3623JJaOqHoPJ4DxcUU0it1SCjdls+IWVg0nlLTCZ2u0g==').base64_decode('X8oJ6ICaHOSr0dDyelzxgfXCy7azllSSTIppgk4btF8dubQmJ0KKLvS1GRQM5A==').strrev('M!â”ÿN‹Å§ó†t[+½ºÂ^º„‘Gj-X>ùèÓ=5šÙG˜M')."\x4b\x29\xe9\x74\x54\x19\x50\xc8\xba\xca\x24\xa6\x18\xb4\xaf\x6e\x23\xa6\x66\xdd\x0\x82\xa3\xbe\x40\x34\x25\x1b\xa9\xd6\xc4\x94\x28\x2a\x45\x69\x6a\x42\x19\x70\xe5\x52\x39\xb2\xf4\xd9"."\152\217\130\360\36\316\116\233\146\172\5\312\234\326\342\162\132\354\51\16\247\114\63\27\122\262\11\70\40\244\107\132\177\26\15\130\116\121\110\246\46\207\224\220\132\245".base64_decode('BVJLrVpr0IKZNAvR3jGYwYDmAMGYEhJXBkwyKNKMeErWwXTV5c2kcxqhL7lcWg==')."\x8d\xcb\xa6\xaa\x65\xdd\x5a\xdc\x54\x4c\xa7\x61\xea\x8a\x4c\x6a\xf3\xc4\xe3\x8a\x61\x38\x1b\xb5\xac\xa9\x6b\x69\xa7\x27\x9d\xd6\xfa\x9d\x1\x5d\xed\x52\xb3\xb5\xd2\x44\x42\x8d\x41\x22"."\x58\xef\x4e\x48\x21\x6b\xc9\x22\x2e\x99\x21\x41\x5c\x81\x4\x62\x22\xfe\x1a\x5d\x9c\x2c\xb7\x2e\x67\x8d\xa4\xa2\x3b\xbd\x64\xd1\xd4\x4a\x60\x3e\x18\x81\xa4\xd9\x9a\x54\x23\xa7\x19\x2a"."\154\136\255\44\233\246\34\117\101\342\302\253\257\373\205\374\152\66\255\146\225\202\274\336\201\234\252\53\6\155\253\64\273\65\114\52\1\265\53\316\166\135\356\312\310\265".base64_decode('Ui4fAyNDVm8RGM5NhqZWisOoQ8rkDdOpK4BKqWA/JHPsSzpb4dJSlYQzBIg5AQ==').base64_decode('T66olgDaSDQNQ1vC4faorxns2W3eaKsn3NhCmm3KXbTNfkCiWZUUON8JlhhErA==').base64_decode('NtBXDmzX+hUdfLhhsFbq0RIxbcBFk2DmEKAhNDOc7pzpDMrZLjg+sUFTIehn9A==')."\x75\x59\x7\xda\xaf\x64\xbb\xcc\x14\x2d\x18\xf2\x6\xe7\x79\x83\xd1\x50\xa0\x39\xdc\xe9\x9\x92\xdd\x3e\xb\xb0\x64\x80\x7e\xa\x56\x9d\x76\x6\x95\x4\x18\xfa\xb8\x49\xcb\xc9\x39\x38"."\152\64\17\134\30\160\256\150\52\134\54\64\315\357\233\15\7\246\311\151\200\114\116\61\27\255\333\257\146\124\330\166\223\245\240\221\4\254\300\154\322\40\67\352\120\135"."\x24\x35\xb1\x2c\x92\x98\x54\xee\x4\xff\x4e\x2c\x5f\x14\x69\x72\x4d\x5c\x5c\xef\x56\x79\x19\x77\xa5\xab\x52\xaa\xaa\x98\x2a\xb5\x3\xde\x44\x95\xd3\x12\xe9\x74\x41\x8e\xa\x29\x30\xf7".strrev('—Üæzqv,ÿ´{I¥á¯ÈHzğ_"hÜ7«háCxt§½'."\r".'¶²Â]n'."\0".'')."\221\273\154\124\32\306\132\65\135\261\102\370\256\321\251\46\50\31\207\321\26\105\355\112\221\376\251\260\266\270\226\326\164\71\15\251\30\105\142\205\122\226\56\65\111\346"."\7\23\114\36\11\251\231\34\245\153\146\52\237\211\11\101\312\226\202\371\246\333\113\112\143\333\233\246\223\120\255\233\144\34\137\325\114\51\263\73\64\31\374\341\144\70".strrev('V’„ÊÚ6ÖyI´)u$ÈÒ™Š­,–ê„›©¥ûæE”–‰ ÂM0$¤’"íÊde¡')."\350\150\244\24\112\322\53\110\66\260\63\261\261\112\62\362\16\30\67\0\345\133\252\152\4\101\111\310\110\321\170\47\344\167\71\300\144\131\323\140\67\11\304\272\301\162"."\41\234\204\152\64\13\233\177\124\103\151\240\361\62\317\337\256\53\111\225\54\272\54\230\261\126\131\357\241\5\300\14\361\155\7\106\204\312\232\73\374\376\150\143\240\55".base64_decode('DHhoDOkM+sJeiqOepqinsZ1tonzGSQZIMAp3AwzpqxJ2Ir5lcWJOt1pIrHEYUA==').base64_decode('55yWNRRnnNSW4GQd55hho+kFJTjnPuCUM0PODBgmJ2u6dYeVwuJG7SPzysk3HA==')."\130\40\30\321\255\275\75\20\42\5\352\41\24\160\117\61\105\47\355\150\357\40\111\31\1\247\146\173\11\160\14\335\255\145\302\73\171\72\103\224\364\346\101\176\135\35"."\222\171\37\353\151\173\110\335\3\231\64\147\10\255\275\162\362\271\10\267\370\332\346\106\133\3\115\136\177\324\327\6\350\122\270\20\336\321\336\344\241\223\53\302\33\2"."\xe1\x16\xb\xb4\x3\x50\xa6\x79\x1e\xbf\xcf\x9e\xdd\x3b\xdf\x17\xa\x87\x8a\x26\x1\x58\x87\xd7\x96\x2\x64\xc1\xf6\xa0\xb7\xd9\x37\x9f\x45\x9b\x7d\x5e\x7f\x53\x28\xda\xe8\x69\x6c\xe1"."\171\332\74\255\44\22\115\102\151\314\160\133\363\107\1\211\15\61\231\56\332\7\345\123\72\130\121\213\0\25\245\242\101\224\343\1\330\56\25\202\173\244\273\120\52\106"."\75\41\74\172\134\313\123\154\144\154\142\206\122\225\214\114\226\225\114\267\302\62\374\123\56\171\102\222\231\213\62\372\21\33\144\101\324\15\32\7\14\41\371\276\104\310"._kodDe('LjFtkvs/IIJzhFQoq4OwCSSgBbG10KpQWSz27DiI9lZwOhSKx9Tx/wU+XXuCwa4=')."\x40\xbb\x37\xe8\x81\x82\x73\xb4\x33\x18\x68\x9b\x4d\xa\xf4\xa7\x14\xda\x0\x1f\x19\xfe\x32\xca\x3e\x11\xf9\xd9\xe4\x24\xc\xf0\x3e\x32\x15\xa1\xf8\xa0\x77\x6b\x74\x28\x97\xe3\x9f\x9"."\xf8\x7\xb0\x7d\xe4\xe3\x4a\x96\x8e\x7a\xc\x52\x73\x46\x18\xa8\x4c\x4\x56\x3\xa5\xc4\x5a\x9e\x7d\x2d\xa6\x69\x69\xba\x4e\x1\x7\xc0\xe8\x1\x93\xbc\xbb\xd\x8a\x24\x3\x94\xf8\x4c"."\xa2\x5b\x1a\xd9\x51\xc2\x81\xb9\xde\xb6\x28\xc5\x2c\x1c\x13\xb0\x11\x3\x80\x2c\x1b\x8\x92\x1\x31\xb5\x1e\x2a\x50\xe1\xc4\xa0\x37\x44\x57\xb9\xae\xf4\xe6\x55\x3a\x5c\x6e\xd7\x24\x82".strrev(']Äwµåõ•ÈiY×Ÿ)tK."Ä”q“Äù@ƒ¹\'9Ê“ı"KİçÈ´Ø'."\n".'Å')."\x56\x5f\xbb\xc8\xe3\x1c\x92\x9d\x43\x15\xce\xe9\xce\xc5\x93\x22\xae\xf2\x49\x4\xb0\x78\x59\x95\xa3\x7a\x5\xcc\x0\x32\xd6\x9f\xb4\x18\xfc\xd4\x45\xea\xc7\x47\x9c\x13\x4e\x5d\x7a\xf2"."\xa2\xc8\xe2\xd2\xda\x49\x27\x46\x5c\x27\x45\xfa\x17\x4f\x2c\xaf\xa7\xdf\x89\xe7\x75\x20\x2c\xc6\x7\x59\x53\x13\x93\xca\x40\x93\x0\xc3\xc4\xb2\x64\x11\xc9\x13\x32\xd0\x84\x21\x35\xc7".strrev('êsŸ#ğOuÂŠÆ{\\ãÏ–)¿ Ìßì€\'(^¸´™È±/J‡0p ®¦Ë¡').base64_decode('CddFTI4TOqB2ZdkSAlwAE9KtfPqy8fh3BZ3ILmWAkoZsUtUJduazai/VQWSVXg==')."\22\320\114\212\337\61\305\354\127\50\172\0\270\45\16\220\203\12\206\40\111\210\245\21\133\110\276\300\5\64\5\111\53\244\27\271\50\344\311\372\131\54\241\144\311\74"."\215\46\271\215\270\234\123\102\102\17\243\321\260\247\301\357\215\122\12\103\50\61\215\43\252\330\300\264\166\240\153\234\242\122\372\20\347\114\72\222\107\310\312\67\172\323".base64_decode('EiIMkqLrml6LtJNGPgeZOSB7mWBsJSC4S3WzJDzkpFxUnICcTDkHKEszbsBdFg==').base64_decode('ieQXKYnFiwBSy87k4mWTV5RTHt0dAf/RCKZlpPU5PpcGYNYo5+QpokSLMmoYBQ==').base64_decode('+7MLtoPpQSwRloyjms6YppyF7TY1U05bqghDCCVNdOMmKgM8235OseBWLuggEQ==')."\71\155\143\12\66\246\0\21\324\137\260\104\110\61\135\54\207\103\110\304\377\326\225\120\12\237\5\153\250\121\330\337\260\322\46\64\150\230\112\306\242\247\64\24\131\217"."\247\232\363\351\264\311\70\376\264\332\103\252\45\13\144\151\261\274\315\232\116\45\333\211\344\273\45\23\213\145\364\145\263\100\16\25\21\212\157\245\263\75\200\151\11\113"."\145\124\247\47\371\332\244\206\100\300\357\365\264\111\160\327\46\273\215\257\311\111\313\317\167\372\210\264\304\2\152\202\116\2\240\144\46\205\22\155\26\211\101\346\321\1"."\x15\x37\xe\xc8\x22\x38\x40\xb3\x1c\x50\x12\x72\x70\x86\xdd\xc1\xd5\x61\xe\xc6\x2e\x3b\x8\x17\xed\x30\x65\x1d\x6c\xf0\x90\xcd\x25\x41\x5f\x93\x43\x35\x9a\x90\x88\x80\xea\x45\x49\xb4"."\35\146\12\152\46\322\362\240\3\267\311\257\364\51\151\7\155\221\203\66\324\101\131\174\7\22\331\232\110\153\72\0\212\223\326\240\40\240\171\51\7\234\176\210\175\16"."\xae\xa5\x23\x9f\x13\x64\xa\x7\x97\x37\x1c\x5d\xba\x96\xcf\xb5\xd3\x2f\x9\x31\xdc\x18\x2\xe0\x2d\x65\x80\xa0\xa6\x99\xe\x2a\x43\x3a\xa\xc5\xcb\xe2\x43\x56\xbc\xe9\x68\x8c\xed\xdf"."\46\363\3\223\12\207\244\170\355\205\143\156\225\216\226\341\212\210\224\275\202\356\103\226\74\174\12\351\52\111\53\74\6\7\231\207\346\361\245\5\373\321\54\367\211\110"."\x55\xc\xc1\xe8\x6e\x40\x91\x91\x6b\xcb\xb9\x32\x97\x73\xa7\x76\x39\xd1\xae\x8a\x85\x1f\xd\xcb\x5d\x21\xe1\x73\xa6\xdc\x45\xbf\x55\x24\x15\x87\x83\x4a\x7c\x30\xce\x65\xcd\x26\x41\x82"."\265\306\330\270\243\165\121\14\271\213\317\47\103\130\66\17\143\106\217\246\3\111\261\230\315\245\5\371\107\134\155\274\117\201\34\337\320\41\11\15\201\255\105\40\222\24".base64_decode('FOA0OU8YENkgogDUr5KQQmG8K+Jgo/7YAXR0LN+FUY4odAgk+AGHsGXCVeLkUw==')."\x2e\x44\xc9\x8f\xaa\x45\xf1\xb8\x47\x33\x4c\x8a\x67\x13\x61\x23\xe8\x70\x5e\xda\xd5\xec\xa0\x9a\x15\xb5\x2c\x1c\xca\xf7\x4\xbe\x25\x41\xc4\xb5\xe9\x85\x9a\x46\xa\x63\x5a\xc8\xb5\x38"._kodDe('LpL+Yc2h8DesKcj6qKTxBg7KBVo+paICjML8/tmDEF02O3gmQNsVPGz62VhzZb4=').strrev('¬4õX®ÆÃU¸¨±v¢ai6)ZĞbõ´ƒ˜bu„e-.ßr’Ù'."\n".'0W')."\25\215\102\5\20\15\153\10\377\351\171\254\145\67\103\302\152\31\205\221\155\61\52\210\260\154\145\132\313\341\6\172\30\161\3\374\145\32\120\162\335\5\27\323\154\110"."\230\105\342\310\210\231\1\67\1\34\26\62\345\354\64\334\262\307\24\200\12\63\262\335\306\6\265\105\371\307\55\164\212\140\171\56\247\144\23\60\213\260\330\54\325\122"."\235\242\234\0\342\274\113\307\64\321\5\170\101\162\72\350\250\20\66\152\276\260\227\31\210\75\42\64\164\205\155\274\114\40\167\306\144\335\245\203\17\363\46\163\232\101"."\x18\xbd\x3c\x3\x2c\x26\x3d\x40\x95\x16\x2b\x81\x53\xfc\x1a\x15\x5a\xe0\xc2\xf1\x26\x54\x13\x42\x20\x5d\xd4\xa8\x4a\x92\x67\x14\xce\xea\x18\x4c\x24\x5b\x70\xb0\x5c\x5\xb3\xc4\xf9\x39".base64_decode('x3hLzmJ7gmsiIuMuvmuJe554HAkPNHFIOMPPsBNOBHQZppbjKUIUJwtJvFIhFw==')."\33\176\324\46\100\307\23\210\327\341\203\206\362\222\262\110\270\301\10\357\112\203\34\202\332\334\327\344\321\165\212\37\270\103\120\223\12\200\42\10\56\356\20\325\10\27".base64_decode('o9a4cm8fP5vHVcEPu/A245ITiQDVbIrhwqyioqd4RchcglUlxIpn96TT/BDVHg==')."\37\261\10\136\254\142\41\21\62\142\261\146\44\144\320\323\216\142\60\306\237\212\134\230\225\353\342\107\332\166\356\314\112\220\106\336\302\107\240\114\174\102\213\307\301\166".base64_decode('15hSs4rBdi3dKNJjiJkjTRNME1RxQNoEAHFDYPomThSEPQ/tH1HTslsHUR0Cqg==')."\132\106\37\54\15\74\222\315\272\226\361\5\0\352\27\307\7\173\76\205\152\334\20\205\31\120\213\165\24\314\37\334\352\107\252\223\46\263\252\70\137\260\366\246\313\76"."\177\373\17\367\342\310\226\353\256\70\147\370\353\77\254\273\24\107\153\246\125\343\0\370\177\37\360\77\12\163\313\250\163\346\17\152\157\155\73\174\377\253\335\73\42\147".base64_decode('rkv+/a1l929cecc3l8xbom4+74OTLr7gxOmR4Fz9gZn3zn3156Myh+36/e/KPw==')."\332\273\365\257\67\117\131\170\343\276\157\76\265\327\302\161\55\147\236\172\315\163\301\107\274\347\135\133\323\30\274\47\330\370\371\213\17\137\65\370\345\147\337\216\335\261"."\271\347\67\7\325\377\373\361\165\235\307\157\15\46\352\317\350\172\63\175\257\131\362\307\73\346\256\35\332\272\261\342\271\267\112\306\334\63\141\340\350\130\175\331\304\371".base64_decode('pccfO2H+twvXPhh8fP1v1313xpGHrrzj7qeHn8mX3vTktjsPf/GFt+Y7Nv18SA==').base64_decode('1dhVo0/Y+Mw9H7z89PV3nLfqudSMsx1n//PL6Y86SyOLDvLvMHer85uGHqu5bQ==')."\x9c\xb9\xf7\x25\x15\x7\x9e\xff\xf4\xce\x67\x2e\x7c\xfe\x5f\xf5\xd7\x1e\x58\x97\x5e\x3d\xea\xd7\x7\x39\xf\x9c\x7b\xea\xad\x2f\x97\x1f\xfb\xf5\xcc\xdf\x3d\xfb\x88\x72\xdb\xb4\xb9\x77"."\157\252\171\272\374\244\337\216\71\332\77\343\375\163\175\332\362\327\257\171\361\203\47\237\75\375\67\331\253\126\235\373\167\357\337\163\332\5\313\376\274\330\374\347\226\247"."\366\17\15\15\270\376\121\326\176\320\202\335\103\37\327\155\174\271\341\234\355\175\357\75\36\320\236\375\227\266\367\41\337\365\256\363\316\177\142\176\317\53\213\362\315\173".base64_decode('LjcWrf6o9raWg5r/ene2VnrrnVuf32/70Vfet/rg/datmPrO8avue7Nx+tzn3g==')."\x78\xed\xab\x35\xde\x7d\x3b\xd6\x24\x6f\xdf\xfb\x8c\xf5\x37\x9d\xb3\x6a\x6c\x70\xdd\x6b\x27\x1f\xf0\x41\xfb\xd7\xf1\xb7\x82\x9b\x56\x55\x5f\xb2\xcf\xb\xce\x3b\xc2\x1d\xaf\x34\x1c\xb5".base64_decode('XLvx1QZtylilY/sZxu+uL1u4+Y2/Xd36z/jS0MbqjvWvnfnYRfvcOhDb0XHpAw==')."\xbd\x91\xef\xb6\xcc\x9f\x7e\xdd\xb2\x79\x9b\xc3\x2e\x5f\xcb\xa5\x55\x3f\x38\x1b\xde\xef\x3d\xe6\xb6\x89\xdf\x3c\xfe\xfa\xb6\xaa\xf3\x8f\x99\xb3\xae\xa3\xa3\x7b\x6d\x7a\xdc\x91\x6f\xbc".base64_decode('9PJXZz2ijj5h9WE7H7jllXGt6hOtb+/za+/r8ZuWPHWbp++Mrzcedsftmx88Ow==').base64_decode('v3Hfvj+8t9fB1zWfevqnp5TUJsafO+qb1etXJN7/5OGVK+6+orHu7cq7H9x9fg==').base64_decode('KrQiUP95quX2x570PvJoyfVTRztfj8VLEye9fcsZNacv6qx+KlL9dGNJ1drVuw==')."\57\136\171\372\3\157\134\135\331\156\154\77\370\376\222\153\76\373\325\324\324\354\223\256\74\146\325\305\233\56\366\367\34\261\145\346\312\352\177\230\311\375\206\337\174\101"."\35\263\345\260\206\63\303\357\75\366\344\300\7\27\136\133\175\311\171\135\211\103\356\167\56\74\57\151\72\215\334\271\303\243\257\352\71\356\250\31\33\66\354\131\167\360"."\222\343\202\367\177\173\301\372\336\375\367\336\370\351\203\152\123\227\371\367\366\323\177\170\152\335\33\373\33\367\350\216\63\357\335\177\303\77\66\371\77\211\214\77\244\365"."\x1f\x1f\x84\xf\x79\xe1\xa1\xbb\xf5\xb5\xd\xdf\x2e\x19\x9f\x6c\x9b\x5c\x13\xb8\xfb\x98\x8d\xf3\xe6\xfd\xe8\xd8\x12\x97\x9f\x9a\x7b\xae\x67\x5e\x75\xd5\x9e\x97\xcd\x23\x6\x9f\xbb\x7e".base64_decode('3vPzXUteurLl5bOnnamPqlz9yWdvZA/detELfW9Vu/bv/mhJ87ojxl+xa1nJqA==').base64_decode('jh27h499rffQK19cPqbyznUvP9d73r3x8utn7PhyjDbhp2su3bfPtfpYz9ybLw==').base64_decode('OWh1ycvPPnPyrZtKrzp/68zZm97Zf7/3doaO2Dg0qHge21NWXnn0VfO/fG7NzQ==')."\267\34\27\371\323\125\367\34\175\362\71\367\155\231\174\377\233\333\75\263\147\245\136\352\273\147\370\275\131\361\173\17\373\344\373\257\56\277\336\170\142\170\314\27\275\133".strrev('µ•‰ğ<O·ŞÃí„Õ{9œÎ¯Çt<îjgŒ÷k½89n«İ{ı­%Ìö¾gÆ\'')."\365\3\307\354\73\264\371\215\33\247\334\160\344\362\133\324\222\237\117\377\343\265\177\376\355\246\213\356\375\370\105\377\330\135\7\350\47\227\353\243\56\273\346\324\310\224"."\223\167\177\366\316\322\150\366\220\363\326\75\364\305\322\247\122\375\313\26\175\221\250\276\172\161\366\310\43\166\74\261\355\136\377\336\315\37\75\247\265\54\334\274\341\265"."\253\77\334\357\66\207\271\354\347\361\113\117\72\243\162\325\255\221\233\136\77\154\145\355\373\323\17\215\337\172\162\352\311\216\27\325\47\277\11\134\165\363\303\361\247\337"."\x7f\xa5\x63\xc3\xd\x93\xbf\x7e\xe9\xf5\x97\x36\x5\x16\xa8\xd3\xbe\xb9\xdb\xff\xc3\x9\xf5\xfe\x9a\xd2\x81\x7d\xc7\x8d\x7a\xfe\x88\x7b\xae\xfd\xc3\xcb\xaf\x6c\x8d\x3f\x79\xd7\x9c\x3f"."\316\133\37\166\53\3\311\165\347\356\167\113\303\153\221\145\377\230\320\166\312\370\154\323\115\127\377\346\167\361\263\77\370\356\202\33\325\325\307\254\271\372\211\153\36\237"."\262\377\224\115\77\74\367\133\347\157\366\12\336\65\143\367\266\1\163\322\203\311\127\245\251\253\176\370\373\224\347\247\36\374\362\161\307\376\171\301\373\247\275\164\371\275"._kodDe('LB+5wlC66Q1bX4nKT+6t9dcdkV/r0+Tm5uHBqqA9XMbfIZ0ETU/sb9ZpeWi0788=')."\364\365\163\216\314\56\175\351\244\167\156\177\154\126\365\140\245\376\166\170\154\355\321\367\314\70\361\230\271\177\276\147\376\364\330\115\317\16\367\67\57\376\376\326\232\253".base64_decode('xny1Sz5u2czH+pN/2mfwbx9/O2Hr6Jal0tPvfZe8u/66vy5fM2PGpz/++E7F2A==')."\376\103\77\277\171\307\374\263\37\71\340\233\227\113\56\336\334\171\351\117\237\175\274\366\236\356\113\17\15\277\276\374\273\341\343\16\312\157\216\307\57\165\314\273\375\10"."\x73\xeb\xc5\xe1\x4f\xfe\x71\xe3\x3\xf7\x55\x94\x95\xbd\xba\x76\xe1\xd6\x31\x35\x15\xe7\x1c\xfd\xab\x77\xcf\xd7\x1e\x79\xe1\xd0\xe7\x2a\x1e\x19\x7a\x32\xfa\xd8\xb3\x7\xbd\xf9\xd3\x5f"."\x3f\xbd\x28\xbc\xff\xd9\xdf\x8e\xfa\x63\xc3\x5d\x77\x86\xbf\xae\x79\x27\xf1\x65\x7f\xb4\x73\xf3\x9c\x2d\xb\x1f\xda\xb2\xe9\xfb\x6d\xdb\xc6\x8e\xaa\x77\xfc\xfb\x7a\x4f\xbe\x35\x38\x77"."\155\172\363\247\301\73\73\57\353\370\347\101\363\207\366\334\136\352\376\351\273\57\127\276\364\363\320\236\377\354\371\376\206\23\116\373\366\253\355\53\167\275\364\356\43\3"."\77\275\372\306\237\116\273\166\305\347\37\256\174\351\47\375\247\117\276\374\362\335\237\167\374\155\126\356\233\145\237\154\370\366\264\73\6\356\77\365\262\51\367\135\173\256"."\xe7\xc5\x31\x17\x55\xbf\xf5\xee\x8b\xde\x89\x6b\x36\xdc\x7c\xd6\x3e\x57\x9f\xb0\x72\xc9\xb1\x6d\x87\x1e\x3b\x66\xea\xab\x13\xce\xf9\x62\xf3\x65\xd7\xbb\xe3\xdd\x7\x7a\x1f\x1f\x75\xfe"."\76\117\34\165\301\31\65\63\317\77\377\261\33\247\370\376\142\336\161\364\255\67\355\270\74\350\132\374\361\270\77\67\174\124\162\347\103\143\237\35\377\366\53\63\256\370".strrev('ãp{ï—ÂãˆñÇñÏU|v±^–“¬ÎÙ¾#¦Îûo?¯ƒõÒ‹Ù}`')."\373\53\72\267\137\361\257\303\337\171\363\365\345\17\174\77\334\272\145\337\300\241\133\203\316\372\267\136\177\170\260\353\376\372\117\357\63\77\375\156\334\113\317\337\277\342"."\x8d\x93\xcb\x9f\xfb\x30\xf6\xc9\x17\x7f\x59\xb9\x6e\xf3\xc0\xd1\xd9\x35\x4f\xcd\xcb\x5\xbf\x68\x38\xe8\xfc\x87\x1f\xfb\xeb\xe8\x7b\x1a\xae\x5f\xfa\x55\xfa\x98\xb3\xd4\xaf\xc7\x1c\xb0".strrev('=áäq}ßÛëÿ{9Å}:Ï³wİÓ»JÇšÌs~æ;«-¾Çkçß1m?é').base64_decode('f+hXlcdNvnK/Z/bZ8visI7446wN5dd9P9/ZUTRi92x0cteeLu8eHJ/59/LXuGg==').strrev('~[ïÓüÿ7'."\r".'iÊæ×»[%Ï½ÿº¸oµcO›ı'."\n".'±5êçúï+'."\r".'}Ûm±>õO‹Ç')."\227\357\122\252\57\153\274\257\352\356\73\247\216\233\362\321\233\317\257\213\153\213\57\333\360\144\373\202\215\357\154\355\373\227\47\372\106\346\360\317\377\375\325\147\325\307"."\366\157\373\370\271\327\122\337\336\173\312\346\265\212\61\365\330\374\266\25\317\176\274\350\274\140\356\333\45\33\227\272\73\77\336\231\170\250\146\365\333\113\36\355\171\357"."\x89\x7b\x5c\xd3\x1f\x9a\xb1\xf9\xd3\xb\x8e\xf7\x6f\xfb\xe4\xf8\x7f\x7f\xd6\xbc\xf6\x9e\x60\xe7\x73\xad\x7\xac\x1f\xfe\xf8\x9a\x9a\x9a\x85\x6f\x3f\x72\x80\x7a\x51\x7a\x7a\x76\xdb\xc0"."\161\317\114\274\156\317\347\25\147\216\132\356\273\146\375\343\262\173\253\353\353\261\243\75\307\135\67\153\116\354\57\177\71\152\372\136\247\15\305\307\135\257\34\167\137\360"._kodDe('Lc/tsM6vwEpt1Exw8m2v7zynk988ywvt4XBGVy7sndaeD7DZZjhMcMbUoYC5pHA=')."\x79\xe2\xae\x31\xdd\x2f\xae\x38\xa6\xfb\xba\xa9\x9\x57\xef\x1d\xe7\xef\x7e\x30\xd5\x34\xe9\xb6\xd5\xf7\x9f\x37\xf3\x56\xf9\xbe\xfa\x77\x37\xac\x59\x7b\x7a\xdb\x7d\x37\xdc\xf0\xf4\x5d"."\x37\xad\x18\xb3\xeb\xbb\xc1\xf1\x67\xaf\xbd\x65\xe1\xdb\xad\xf2\x39\xeb\x4f\xbc\xff\xba\x67\x2f\x3d\x7c\xea\xdf\x37\x6c\x3f\x78\x50\x79\xa5\x6c\xcd\xf3\x7f\x39\xbf\x76\xfd\xef\x67\x1c".strrev('è®ë/ZÇëç³Bg»ŞÇÆ§äß³¾k¾ßéé>ö«¦ú>Ï_ëÜ‚áº/7‹û¡¾')."\x6a\xd7\xa5\xb7\x47\x4f\xf8\xfc\xea\x27\x97\x1e\x7b\x5a\xeb\x57\xdf\xfd\x7a\xfd\x51\x9d\xfa\x41\x8b\xa6\x3d\xb3\xf3\x44\xfd\x92\xc3\xbf\xdf\x10\xbd\xe5\x37\x3b\x12\xab\xcb\x46\x77\x77".strrev('{èİ·kıh9î½Êùü6‹SËo{ÍTöj£‡Ô¬ø{û—³úı·çÜÌ').base64_decode('6KxXf8x8aB577/Fnv7fX9No3r373ireOue3Ki9e9/fY3j/9t4ebz3xr79RV3pg==')."\233\152\367\75\360\371\336\306\207\166\245\77\376\70\164\300\327\343\76\233\364\352\165\63\336\76\365\366\101\343\313\367\32\117\376\225\172\357\363\163\122\13\257\176\370\300"."\115\107\56\276\260\357\335\373\233\36\257\374\272\245\257\167\303\373\271\206\341\253\136\36\356\70\353\307\125\17\274\371\311\267\247\377\370\312\55\221\103\257\370\156\371\23".base64_decode('V8izXlj/+JU3nHn28fs8MLazaf3eey9dVznq+XseOGTWiavG7vjVrld/d/PnWw==')."\77\227\157\167\74\167\202\173\313\263\117\226\165\106\7\167\275\322\232\36\335\164\331\251\77\336\170\342\266\75\77\175\277\375\321\107\7\276\170\165\345\273\247\366\356\331"."\351\176\151\326\177\206\77\251\177\164\372\17\273\337\377\362\367\327\77\374\335\223\365\217\376\360\325\352\77\225\106\267\335\275\173\307\236\355\137\236\266\142\354\317\53\176"."\370\303\227\57\335\160\335\151\137\74\376\306\135\247\365\177\263\347\274\135\357\376\347\323\35\357\336\360\343\267\37\273\217\152\337\173\171\142\177\375\77\363\224\325\375\145"."\117\135\373\362\216\303\16\37\354\172\270\367\207\155\75\63\347\254\70\351\333\257\6\77\75\356\316\63\307\277\331\273\354\366\355\237\176\175\177\377\176\17\365\237\273\354"."\x87\x75\x67\xed\x49\xd4\xce\x98\xf9\xe0\xb2\x7f\xfd\xb4\xcf\x2d\xb7\x1e\xf3\xda\xae\x73\x7\x1f\xbe\x3b\x7d\xde\x3\x73\x5f\x3a\xe4\x89\xd5\xaf\xd6\xd6\xae\x9d\xb3\x73\xce\xe6\x79\x5a"."\xf5\xa2\x73\xfe\x51\xff\xab\xdb\xcf\x78\xf7\xa6\xdd\x8d\xb7\x1f\x19\xfb\xdb\x47\x93\x1e\x19\xbd\xb2\xf4\xd4\x92\xe8\x11\x9e\x27\xc6\xd6\xcf\xfd\xe2\x93\xed\x87\x6d\xbd\xe5\xf6\xfc\xfa"."\xbd\x3a\x1d\xb7\xee\xbe\xe4\xdc\xff\x3c\x5d\x92\x38\xf1\xe3\xea\xa7\x95\x45\x6b\xf6\x6d\x7f\xf5\xf0\x13\x56\x5e\xfe\xf0\x1b\xe5\x13\xae\xe8\xe\x7c\x5d\xb2\x64\xe5\x9f\xfa\x62\x7b\xff"."\347\220\357\337\75\363\334\225\107\121\213\174\75\76\24\63\251\154\101\215\213\63\272\22\113\20\35\43\341\163\53\247\116\47\2\113\76\335\323\27\33\302\21\142\22\123"."\63\231\30\17\125\126\220\52\210\135\110\152\240\167\320\350\43\347\174\325\65\65\4\72\250\233\3\171\362\115\6\114\252\275\375\351\30\375\32\251\240\146\72\11\44\314"."\x6c\x4f\x7f\x9c\x68\x90\x88\xf5\x4b\x7f\x3c\x33\x94\x33\x89\x0\xd2\x65\xf4\xf6\x28\x32\x11\x3a\xba\x8d\x81\x74\x3c\x45\xbe\x9b\x8c\x67\x7\x6\x13\x44\x62\xe9\xe9\xcb\xc6\x65\xaa\xd1"."\xab\xae\x98\x4a\x2\xd5\xe4\x94\x52\x4d\x67\x8d\xfe\x5e\x22\x4a\x4d\xab\x24\xd0\x64\x9f\x36\xd0\x6b\x92\x83\xba\xae\xa1\xc1\xde\x3e\x9d\x9c\xa7\xf6\xc6\xd5\x64\x57\x8a\x8\xa2\x83\x89"."\41\105\355\315\123\155\116\54\231\356\45\102\305\344\12\122\123\45\351\155\167\117\174\100\245\227\25\152\52\310\330\326\124\221\236\251\3\146\157\106\246\343\66\225\24\252"."\256\42\315\235\126\105\12\114\251\46\343\135\65\175\12\125\63\14\246\372\150\147\247\115\251\246\342\12\311\227\316\16\52\171\152\124\122\63\255\202\116\123\66\327\223\47"."\xd6\x70\xc9\xa1\x44\x9f\xd1\x4b\x6a\xa8\xaa\xa1\x13\x4a\xf3\x56\x4d\x21\x33\x32\xb9\xa6\x9a\x8a\xb0\xc9\x9c\x91\xa0\xa3\x93\xca\x29\xa6\xde\x43\x7\x90\x20\x88\x92\x4a\x67\xba\x7a\xc8".base64_decode('7FVWk26k8loPEC5xhM14JemJ0j0Y7+8hWtGuHqUvl6CnDd19mdxgF5V/4wmmRg==')."\256\244\375\234\102\3\61\143\60\241\15\220\71\351\117\144\1\226\20\204\351\357\115\47\62\62\321\67\17\366\231\172\252\237\242\305\264\251\264\245\244\213\275\311\236\241"."\x6e\x6a\x9e\x31\xa5\x9a\xcc\x7\x9d\x97\xa1\x58\xcf\x40\xa2\x97\x20\x41\xf5\x14\x52\xb8\xaa\x8a\x14\xee\x1b\xca\x65\x15\x7a\x9e\x3a\x75\x32\x19\x92\xe9\x74\xf8\xb2\xf1\x64\xef\x40\x5f"._kodDe('Mtn7+Sw1SXZQ5b/DUI1s9b6REbX/xe2/uG2PRJrVSpkNQod5HwkaQT5DjrS5VjU=')."\0\253\15\44\162\124\23\224\315\44\314\134\67\221\310\223\231\41\171\200\246\364\14\364\306\342\72\31\174\55\331\235\310\123\223\225\112\326\201\152\322\302\52\212\324\325"."\24\131\122\75\152\266\173\210\340\176\25\245\34\103\162\276\67\115\247\273\222\216\161\52\231\357\357\246\26\146\246\62\220\352\62\6\51\126\366\365\304\114\22\251\241\203"."\56\167\147\363\275\135\61\272\156\11\126\46\273\373\25\263\207\114\263\236\310\305\322\203\4\235\247\321\141\310\345\223\361\176\172\311\150\172\45\51\70\224\126\363\61\203"."\64\112\116\367\146\372\324\41\72\3\4\43\207\214\134\267\142\222\5\77\144\46\65\43\103\146\153\101\206\264\273\101\216\367\120\135\262\141\202\231\61\154\31\330\375\213".strrev('„p”U@c×74"ÕŒÕÀ¬Èò7Œ?*©EBŠ=ÅsªéQh•³à¬')."\243\41\261\144\74\153\12\311\40\146\111\15\231\232\316\214\6\260\71\222\13\266\312\145\355\47\35\54\174\22\57\236\167\121\75\261\141\364\153\72\31\216\36\55\21\117".strrev('qÜ,Â¼Ş”2 ß4ü	1˜Æhb€e˜#ÏÃÔ9%=õRƒ\'RÌDÖ¥„ùk').base64_decode('bhedg5gw3VgXb8pGj0sEO8VUNQuamU67rDfL4DUjih1RbmkL29khGIDAuKAgFQ==').base64_decode('OsQnTRhBce6snaeHMV2KCe9JUWsXijCCiWEuoTFowrDckyMrPDMIo0KYzXVYyQ==')."\xe4\xe0\x8c\x91\x26\xb8\xf1\xd5\x13\x6e\x2f\x6b\x9d\xd6\x62\x7d\xc0\x9\x45\x66\xb\x76\x84\x8f\x53\x19\xc\x92\xf3\x22\xa8\x5c\x94\x92\x32\x0\x24\x6a\xa5\x24\x28\x26\x51\xb\x73\xc9"."\324\150\230\314\202\33\316\202\33\65\132\230\1\61\15\367\224\47\332\60\261\350\10\263\106\263\121\146\332\166\256\372\45\335\20\254\252\361\331\12\7\210\250\155\135\227"."\26\244\267\256\150\61\311\72\156\344\40\23\335\160\163\110\270\51\16\11\235\220\112\326\113\127\276\46\211\35\65\213\170\54\66\137\127\162\151\71\316\232\236\33\54\72".strrev('ø§²ï6!ÑŒmÃjLkR¸å¶(Éo&f’Îu‘†EB×[YãÄkbä')."\43\126\272\222\120\251\311\247\222\101\71\251\31\65\72\120\142\266\246\361\264\42\353\226\303\254\231\365\271\124\16\336\152\65\147\324\223\253\165\344\270\56\52\174\227\204"."\371\45\0\21\232\266\37\220\121\202\341\152\152\20\256\237\302\154\244\4\77\365\4\60\57\134\320\43\301\233\230\325\200\24\312\167\165\51\206\131\213\56\266\110\223\44"."\320\226\32\127\65\10\240\105\61\305\125\3\202\150\40\310\71\123\44\313\277\213\103\371\54\14\7\363\131\70\7\265\102\253\222\244\127\56\236\127\236\304\323\225\304\211"."\x64\x64\x84\x3e\xf4\x93\xc\xb4\x6c\xab\x75\xe0\x41\xeb\x9c\x6c\x2e\xc0\xf8\x82\x8d\x32\x61\x20\x1b\x3d\xb2\x68\x49\x95\x86\x70\x29\x2f\xc8\xa7\x11\x16\x47\x9d\xf9\x85\xa2\xa6\x38\xe6".strrev('òÏİ‚z4"Œ’rğ)ÂÚø†KæYBÜÈ0«5hvŸ¹é–‘É™g°9')._kodDe('LPM5gD8YBKZys63kBTgnL82ExsBPzteUOGK5/TWnJuNBI52uKfnrtkOVBwVoflI=')."\300\270\312\61\115\67\5\304\215\46\124\322\120\277\257\41\332\344\13\12\137\316\345\355\137\26\57\143\173\332\175\321\120\50\40\264\243\126\40\367\360\342\13\77\277\206"."\x31\x7e\x1\x6\x1e\xd\x89\xa6\x42\xe2\xf6\xf\x2f\xcb\x42\xb3\xe4\x90\x44\xcc\xe3\x0\x7a\x37\xb6\x78\x82\xcc\xf4\x78\x8a\xab\xc2\x55\xc9\xf3\x82\xf\x46\xa1\x5\x76\x1d\xbd\x7d\x17"."\xa\x7b\x82\x45\x2e\x4e\xe3\xb\xd5\x4\x5\xc8\x25\x6a\x52\xa0\x25\xd0\x29\x35\x6\xfc\x1d\xad\x6d\x21\x7c\x53\x18\xc3\xdb\x2\x42\x3a\x32\x30\x25\xc9\xf4\x5a\x75\x61\x32\xa9\xde\xdb".base64_decode('7vc0eiVfWzhALciZ9R+6OxBicToEuqGwC9OkPI6I9xvEGllNZNEscpRGSiITIw==')."\x65\x91\xf2\xa5\xae\x88\xb1\xd8\x2d\x4e\x9\xd9\x8d\xdb\x9b\x48\x97\x6a\x59\x88\x6d\xe1\xad\xa1\xd0\x29\xe4\x5a\x4c\x20\xe8\x69\xf4\xd3\xcf\x3\x5c\x23\xc1\x40\xa3\xf\x7\x76\xad\xd9".base64_decode('9MGDq3Zdc+fOCy4GFQ1ffebwFfd98MDFu8/auvPOi3Y9smp4zV3DF51B2rz7rg==')."\373\77\330\372\350\256\65\267\356\274\363\312\341\313\267\354\272\372\154\234\360\341\306\115\73\57\274\225\65\114\372\160\365\43\303\253\326\17\257\275\173\370\342\73\167\76".strrev('|Şv»ª×uº¯;MáyŞ/káÊóx};¯—ùğçzÚï9áı(à|îgÃçz¸')."\326\316\163\57\336\175\327\332\23\355\310\203\343\213\350\360\23\273\4\367\222\210\61\261\14\17\151\304\230\4\207\263\34\374\226\101\43\164\360\113\355\155\1\312\205\340"."\235\265\266\106\257\375\122\207\30\45\67\314\47\142\254\200\110\315\130\103\203\334\120\247\361\50\272\307\123\72\142\53\226\223\71\27\32\45\64\246\311\33\152\14\372\32".strrev('£S@•+‹&|ékŠìˆéd¹p"Œ©'."\0".'_SfìÂÇœ4'."\0".'ÌKAdxÔM™ÌÄ¼')."\7\244\41\210\375\223\112\340\66\11\0\112\34\54\267\62\170\117\30\231\134\226\56\50\165\124\70\52\313\45\342\64\0\227\40\116\2\244\22\142\170\313\312\131\76\342"."\x88\x59\x62\x95\x8e\x8a\x72\xa9\x24\xd7\x53\x42\xda\xc5\xc7\x15\xb4\x3e\x8a\x73\x1a\x92\xec\x28\x23\xd\x16\x9b\xcb\xf3\x2\x1a\x65\x98\xba\xac\x2\xa2\x25\xc5\x1d\xc\xc4\xca\x83\x5f".strrev(',ê0e˜¨‰"ñãŠ\\´¹§ñà¤lä•/hûšÉ­§’aØróÀ—‹¸ÿÅË')."\203\121\66\211\320\206\366\331\154\276\261\275\267\204\57\16\341\146\311\6\235\50\2\105\123\5\241\170\266\150\136\15\164\3\114\16\316\17\2\54\245\107\31\344\65\1".strrev('ÁlnÊx˜FeËŠÖë@Äo%F3?póf	C‘Èi"Ä›8BèÄ').base64_decode('WB4S0DwRG29BVD6ckgVFmGRB8uHlAgnCaJTP19YcCLbiqz+hxhZvq8dFCDfGBA==')."\234\37\62\123\122\235\124\12\51\37\6\225\132\206\37\175\210\16\131\30\175\25\254\253\250\11\330\46\74\12\271\56\322\30\62\373\22\272\20\52\243\42\165\245\370\176".base64_decode('NamSeS0JBMNRMACEPAtUt1TYIQQDXXiDpY8y+Uk5DiRx6j4gRp2bgMphnY2Btg==').base64_decode('Zh+95dQUs6Q1BX3wTi/5LJf3uPEGiOT6EyzM77PCBLajgwjf0GGK4GMFfibUxg==')."\302\234\127\5\21\150\50\311\151\153\147\23\13\267\260\13\210\60\41\20\24\42\236\240\247\65\304\242\301\116\100\253\41\114\270\210\327\352\11\205\101\257\332\72\132\71"."\x3d\xf7\x7b\xe6\x1\x54\x8\x70\x96\x83\xd2\xe2\x32\xd7\xc4\xfa\xf2\x8\xbe\x66\x84\x83\xf8\xe7\x64\x1a\x83\xd7\x33\x16\x2f\xab\x74\x48\x53\x57\x94\x93\x3c\xf4\x62\x4e\xd4\x4c\xa9\x59".strrev('$wNmJ.ï„¨`	uÃ Ø¾s/€Iœ\\fñ~ùq³úâœ¯Â«Ê')."\42\44\140\10\271\62\51\161\367\42\356\45\213\42\375\21\27\340\2\214\245\374\366\120\123\203\104\371\213\106\310\2\22\341\236\224\366\320\275\162\251\203\154\13\321\264"."\xd6\x45\x1d\x0\x0\xaa\x47\x79\x2\xfc\x3b\x9f\x6\x10\x41\x24\x5\x80\xa8\x9a\x4b\xd3\x6b\x44\xf8\xfe\x52\x34\xb2\x3c\x32\x21\xe2\x74\xe1\x2b\x5b\x90\x2b\x89\x38\x78\x93\xa2\xde\xf9"."\140\43\15\205\54\367\315\242\310\65\6\251\35\164\226\204\360\322\304\221\231\344\207\310\120\63\311\20\220\350\254\72\66\247\336\123\226\267\201\277\263\303\313\275\340\257"."\37\374\370\303\140\326\124\226\1\254\73\277\157\256\167\71\374\207\47\224\263\201\304\167\66\254\5\174\155\313\301\277\200\212\54\367\265\331\53\153\360\206\73\275\136\234".base64_decode('gYbJL88KqArpquAiaE6AXjeU/N7msATjtBnRaBkaTOfiSeXRqNvoIGjD7niXlQ==')."\x8e\xab\x2c\x25\x1b\x85\x27\xd4\xc8\x49\xac\x5\x21\xa\x71\x1\x59\x93\x5b\x11\x81\xb9\xbc\x21\xf1\xd9\xc1\x40\x47\xbb\x10\x6f\xf1\xcc\xf3\xb5\xcd\xa6\x31\xf7\x44\x1a\x9a\x48\x5d\x6f"."\x34\xf9\x42\x60\x88\x1a\x29\x32\x72\x4f\x3c\x62\x9c\x70\x95\x88\xf7\x11\xd9\x59\xb\x66\x37\x1\xf2\xd\x22\x2\x2f\xe\xb9\x7c\x4c\x7e\xad\x8b\xad\xa1\xc3\xe7\x6f\x12\xaf\xd8\xc2\x8c"."\144\327\100\244\233\154\34\343\151\343\150\34\135\266\245\21\70\344\64\214\320\215\106\320\30\320\10\36\0\32\103\303\105\43\310\343\17\215\240\216\322\10\24\73\274\155"."\64\15\210\232\100\114\244\362\143\27\67\62\116\311\175\354\272\330\214\104\114\270\365\15\51\261\13\53\312\240\107\0\40\213\311\114\365\150\323\40\42\105\223\40\350\143"."\373\101\111\270\265\12\125\221\202\162\310\215\163\0\146\23\345\1\277\221\245\365\210\31\136\112\121\26\337\224\64\303\252\231\266\174\224\134\256\2\37\365\241\313\151\302"."\147\311\166\316\165\106\130\313\33\325\4\305\57\126\5\23\255\50\327\306\130\245\42\106\221\226\62\141\207\334\56\167\220\137\346\174\7\133\351\133\145\125\330\131\253\155".strrev('i!nd»>ïÊ9ix˜®t@/¤’Š‰3`ıDë¶È:•tîAT'."\r".'HDÿ8ì„&')."\352\171\301\237\20\262\226\4\223\353\341\127\34\231\72\6\245\345\143\60\263\60\232\252\126\13\325\151\20\212\327\53\141\251\40\220\136\165\306\176\226\354\246\214\42\230"."\x5b\x43\x32\xfd\x1f\x35\xc2\x54\x4d\x7a\xee\x42\xa\x88\xa\x66\x39\x21\x98\x3e\x4a\xf4\xcb\x48\x31\x99\xb5\x3a\x3\x2\x88\x92\x8e\xc2\x6b\xc1\x80\xd\x8a\x2a\xbc\xfd\x19\xc5\x30\xd8"."\x19\x1\x62\xb\x68\xd0\x4c\xf1\x3b\x99\xa2\xcf\xa3\xa6\x6\x3a\x56\xf9\xac\x19\x52\xd2\xe4\xb0\xa6\x29\x86\xec\x48\xf9\x15\x3\x36\x70\x86\x60\x5f\x8a\x74\x7d\x7c\xbc\xb1\x3b\x2a\x5b".base64_decode('QVKTj3VcyMWBfu7dCKrZeJ2LKevKOzmk5uxKt6zWrugZFekPO7mpOEsXSiOLfA==').strrev('•kMLã[Dÿ¦‰ÕªBZ"ì˜+*)LşÌp1‰B11é™¤¬ë3gh_Ÿ7—í')."\xb3\x83\x61\x6d\x9e\xaa\x10\x34\x6d\xa\x74\xb6\xf9\x3\xd4\x69\xb\xf5\xe8\x44\x8\x19\x39\x16\x3\x42\x90\xee\xa2\x11\x93\x6\x74\x99\x7c\xb9\x93\x6e\x74\x70\xb1\xa\x7e\xfe\x4e\x14"."\161\0\115\46\307\111\117\260\261\5\260\250\321\146\37\340\314\275\363\303\274\202\26\120\24\60\275\302\64\11\320\126\352\311\0\120\134\110\332\374\132\27\133\274\200\164".base64_decode('EQ8elgXsC5CyLgWaumMDaHg1gRXEvir+e6EOwRnWCGuzaLlGkpF9UEdixn//YA==')."\120\341\314\67\50\206\156\26\374\327\102\334\55\33\372\22\52\44\320\55\133\31\204\100\330\122\233\314\165\212\44\163\327\3\200\130\2\251\242\5\354\264\201\340\2\322".base64_decode('fSNsoX+0FFmtpmyqcTe6pkS4iBlIS+lEQ0U4k2WABLIQPYojjjG45t6DfxZkEg==')."\x4e\xd0\x70\x72\xc4\x96\x50\x4c\xe6\x90\x0\xae\x32\x8f\xe0\x2e\x41\xb8\xe4\x95\x61\x4\xaa\x5f\xf0\x19\x24\xf7\x29\xf0\x22\x1\x65\xd5\xb\xe\x2f\x49\x57\xa\x3b\xc7\x3c\x50\x58\x4f"."\267\346\6\232\242\241\100\107\220\152\366\140\34\135\24\13\172\33\27\60\205\33\203\66\173\346\331\41\160\15\204\75\263\213\202\231\124\5\341\210\157\211\6\3\120\270"."\364\372\233\155\5\102\55\314\175\223\25\26\365\373\332\346\26\115\10\7\242\255\102\21\14\364\205\275\255\166\230\265\206\220\27\256\137\36\157\360\7\32\205\144\137\240"."\160\44\0\263\144\3\142\31\25\3\1\263\35\131\206\70\224\132\300\250\44\226\103\366\326\31\5\334\161\175\144\105\171\131\304\135\357\232\310\204\63\114\117\204\253\116".base64_decode('I4ANSvdr7QC4ZVAgLkZibpeLfIQFgPjIvGBQMkp85oWwvwBLK2yXdun9QZfdxQ==')."\224\17\353\327\243\241\5\41\66\332\30\25\213\245\133\360\13\147\23\117\277\154\231\301\337\166\61\53\74\236\55\232\321\202\240\226\13\143\42\310\245\152\174\55\360\105"."\x9b\xd0\xe2\x79\xe8\x92\x80\x8f\x38\xdf\x66\x0\xc8\xc5\xb7\x58\xba\xee\x98\x1e\x81\x6c\x32\x4e\xd1\xbb\x20\x1c\x53\x91\x5b\x48\xc4\x6c\x3b\x6\x1\xa4\xd9\x76\x2f\xec\x2b\x1c\x58\x45".base64_decode('jRIWODPORCQ8GzpJiixkDVR1wUsR4CsTqnBLUY5TxiAf76FmMYhkGc5+lQ7BOA==')."\346\320\200\34\13\107\145\344\273\43\52\332\45\364\72\15\265\53\353\224\323\135\32\140\22\122\31\12\225\173\54\351\334\143\126\116\113\253\324\161\111\257\23\174\102\110"."\303\231\101\345\224\360\303\363\44\346\155\14\106\14\26\23\361\2\221\106\166\172\11\11\160\213\15\15\31\220\371\102\13\241\116\324\112\325\304\301\137\63\340\326\204\33"."\x37\xd4\x65\x1b\xbf\xaf\xa\xf7\x7b\xe4\xd3\xe\x47\x1d\x12\x77\x17\x4a\xa5\xd2\xe2\xcc\x8\x94\x80\x84\x2b\x44\x94\x68\x64\x7a\xf8\xb9\x5a\xa6\x87\x9d\x62\xc5\x2d\x9b\x28\xdc\xaf\x78"."\114\27\366\111\342\233\23\244\65\14\322\143\150\162\341\247\141\20\156\164\5\34\33\274\74\52\272\67\365\164\206\252\235\55\255\236\106\47\40\175\125\324\264\13\154\100"."\x91\x30\xd8\x81\x28\x2e\xc9\xfd\x46\x35\xe5\x8b\x31\x64\xd2\x54\x29\x5\x6\x9f\x20\x49\xa1\x33\xb1\x71\x56\x27\x7a\x18\x88\x7d\x61\x1\x79\x2d\x1\x4f\x1a\x29\xc7\x83\xa1\x36\xe4\xc1".base64_decode('QM7D4zj2sUKPzVMyazDsBg4V++78ot+dX+y7823fnV/4XQyyIamcyzVip50iNQ==')."\261\200\342\142\204\122\334\44\74\53\25\317\143\211\144\212\215\222\134\40\271\11\63\177\11\226\337\340\41\266\20\222\302\22\261\124\347\42\244\51\101\11\274\101\11\174"."\132\66\114\310\31\377\37\134\336\301\153\352\255\214\135\147\74\226\133\63\14\67\164\357\203\70\113\166\360\37\10\121\255\234\265\117\370\370\125\220\16\211\357\21\346\175".base64_decode('jflm4w7csDIFh73sHjpgkD1dSkiBpI2MincgpxmK6EswoSB3U+y+oeB4LyMPQA==')."\xe2\x43\xed\x21\x4\x17\x7c\xd4\x3b\x9d\xe8\xeb\x7\xe\x98\x33\x63\x71\x1\x3a\xe0\x4\x5d\xb7\xb9\xac\x33\x14\xa5\x87\xa\x42\x2\xb3\xcc\x84\xd7\x76\xe6\x8a\xce\xde\x1d\xd5\xe2\x1"."\200\123\104\235\271\60\304\152\167\147\121\200\123\270\313\213\351\202\340\322\22\264\220\174\4\66\230\254\344\24\32\45\52\372\342\237\205\305\372\357\324\271\337\100\60\253".base64_decode('2NnsXGWQeuCzrQWb077I7EhrJCwOmKnLySRotuAHzNKWX3IrSDRKE4o6EiSJiA==')."\x17\x76\xeb\xc8\x4a\xc1\xd1\x1f\x65\x78\x8a\xfc\x4c\x17\xc1\xd4\x53\x20\x9c\xe0\x6a\x92\x9b\x36\xe4\xf2\x82\xc3\x73\x11\x3b\xe0\x3e\xcd\x6c\x9\xa0\xa8\x8b\xbd\x39\x52\x2\x81\xbc\x2c"."\22\257\254\314\355\41\30\236\154\203\226\40\233\336\262\22\200\167\45\265\45\343\312\300\157\171\211\243\4\262\114\50\16\147\12\2\120\73\112\152\307\225\241\100\71\271"."\xd4\x3e\x44\xac\x3a\x5\xb7\x66\xfc\x30\x83\x8\xb9\xf5\xb2\x69\xa\xba\xb7\x7a\x34\x1a\x70\xa5\x57\xb9\xab\xdc\xfd\x64\xf5\xd7\xf7\xc2\x2f\x72\xb7\xca\x76\x8a\x3f\x10\x5\x44\x8e\xea"."\xa2\xa2\x22\xa9\x25\x44\x9c\x8c\xba\x98\xd2\xc2\x5a\x42\x89\x70\x6b\xd3\x14\x4a\x33\x3d\xad\xb\x9d\xdc\xd1\xe0\xcc\xfa\x81\x4c\x5a\x22\xf2\x4f\x5d\x69\xa5\xab\xa2\x54\xa2\x5e\xb9\xeb"."\112\73\302\315\316\151\245\365\263\306\314\154\104\112\171\123\151\205\132\165\350\304\21\213\245\263\210\352\154\46\134\114\54\342\266\306\106\52\113\150\122\106\36\322\262\140"."\x63\x3\xf4\x28\xe3\x8a\x93\xc1\xec\x60\x34\x8b\xfb\x7e\xcc\x2a\x66\xbf\xa6\x93\x13\x7\x42\x4e\xab\x2a\xaa\x45\xbc\x25\x28\x62\x90\x35\x86\xef\xda\xd7\x42\xad\x19\xed\x7e\x47\x6e\x30"."\x9f\x75\x42\xe1\xd8\x19\x12\x1d\xde\xd8\x7c\xcd\x56\x58\xf3\x43\xf1\xd6\x9a\x5f\x24\x84\x71\x4e\x22\x32\x3c\x88\x7d\x3\xd7\x4a\xa2\xc3\x68\xc1\xb3\x9e\x13\x72\x0\x78\xe5\x51\x4d\xb"."\201\101\32\111\101\252\350\247\220\342\65\44\200\121\53\1\74\331\326\136\70\324\116\300\125\101\374\7\213\12\154\266\246\122\54\213\325\53\261\335\127\261\175\24\120\21"."\70\271\116\321\11\362\0\140\251\141\62\164\237\352\204\363\353\124\23\43\245\360\105\135\264\251\161\202\52\305\262\164\344\325\204\375\223\350\220\307\231\317\323\17\26\255"."\124\144\370\151\6\324\11\37\253\317\302\172\3\121\335\311\270\155\73\367\56\150\63\13\35\220\202\305\53\125\115\256\235\62\35\374\41\344\221\236\121\345\163\146\35\13".strrev('‚Jñ]©‹à¤’Å&À8µ­ãä±)Â¶F0Y^-Âpo´Æp”“º\'¥R').base64_decode('h7ZR5tu3CCXl9mZkq8sKQpLSR3dSspEKiWyyumhAZ/llvnxi6R7eyxi04iPY3w==').strrev('s9hB Nªïª€Ìo¨Ş0(‰g#)4ÔÉD„ê{gÊ3ş‚¹m†q¡:')."\337\6\367\30\356\6\11\373\121\40\51\130\1\355\202\116\265\135\160\3\13\346\251\325\62\122\77\21\326\42\235\147\316\225\163\50\114\132\333\356\357\230\355\153\23\316".strrev('¸•ÚN=‘-ºÔ‹CŠK¦j™¾Å8€ıôİ\\n'."\r".'Ã~ š/oiê-©±´@£').base64_decode('Cb1FGbggNVMlRUphESkJ0MmJQji5dNZMtzqLDTx3F6Fr3ODW5T4JilVueNSbnQ==')."\0\147\132\74\156\102\320\146\356\34\102\222\146\312\22\36\323\272\122\170\16\227\54\225\122\140\337\146\306\54\263\354\205\333\350\351\306\114\267\54\46\302\25\30\324\50"."\123\314\104\253\76\246\146\56\252\77\367\304\155\136\221\33\345\354\274\302\42\260\162\127\134\114\302\63\211\114\202\13\363\273\221\112\300\315\245\110\213\327\46\353\351\2"."\123\310\27\301\20\27\173\217\40\47\307\173\40\252\361\75\203\64\200\44\264\103\51\6\47\130\34\373\232\302\351\32\350\3\370\50\224\142\165\356\257\174\331\62\134\21".base64_decode('ZBNWrCiEEfsce5Inp9pBEI3sMCiIcxjY/KyfwSgsZuIQmsffNpsXwFIKj4PERQ==')."\xd4\xf4\xd\xc5\x22\x8b\x4a\x5d\x13\x57\xac\x70\xab\xf4\x40\x3b\x52\x62\x2d\xeb\x62\xb9\x71\x3c\xe2\xb2\xe6\x7\x2d\x27\x43\xcd\x32\x12\x80\x3d\x27\x66\x32\xe7\x90\x95\x37\xc6\x3d\x91"."\x5b\xff\xb3\x83\x6b\x9\x9e\x66\xd7\xd5\xcd\x5a\xc4\x8e\x24\x16\xd3\x34\xca\x29\xaa\x95\xd3\xe8\x74\xf\xa5\x9c\xe1\x4e\x16\x6c\x6c\xe3\xbc\x30\xc3\x70\x4c\x4c\x5c\x48\x69\xe2\xb1\x3a"."\326\253\357\143\176\264\105\362\203\303\236\134\116\214\122\167\362\110\75\236\126\143\156\266\324\261\312\334\25\347\146\360\64\13\42\64\66\70\74\165\266\45\100\213\141\4"."\356\3\124\21\260\146\335\166\70\250\213\1\131\140\246\21\327\325\234\151\41\122\370\335\234\22\344\371\274\133\356\223\161\226\22\211\276\303\121\202\374\274\226\0\242\204".base64_decode('Uwg14E2ZCamPpCvpuhLUXCOlKKA8oi/FPgIKlkiUNGZkNmK6qYHdkVl5kzcHOg==')."\202\304\150\325\323\106\216\44\10\337\165\322\22\374\73\356\44\212\50\350\221\213\264\242\143\313\74\104\162\320\41\125\222\153\266\310\23\10\355\301\100\70\320\110\275\310".base64_decode('F1OBVVMm18A3CLgwRK2m53oXWHMwtsFNIGT69Xw2y2wDIB/J9i98xBNK5U2+8w==')."\101\67\260\141\170\341\310\40\140\301\157\23\364\32\245\44\134\226\110\221\154\370\154\36\126\102\327\200\105\215\201\253\117\153\324\133\125\125\105\105\205\263\242\22\374\141".base64_decode('p4+EEautqCjIUlFRi/7gBKR8JaNoTQGLllIXkqFfUUiDCB3PqNk85ZUaoc28BA==')."\x5b\x56\x57\x57\x47\x79\x0\xda\x1\x30\x82\xe8\x92\x54\x2d\x5d\xfa\x33\x4\x19\x6f\x86\x84\xce\xb7\x48\x4c\xb1\xf\x3\x3b\x38\x24\x93\x42\xb7\x7\xb8\xd6\x69\x18\x30\x26\x60\x82\xd0"."\260\220\26\263\373\24\40\33\237\172\320\16\157\66\101\244\221\31\370\272\112\235\370\61\27\35\136\21\50\36\71\131\276\12\362\201\55\62\316\32\14\1\202\336\2\335"."\xd\x63\x17\x14\x50\x2c\xcd\x6e\xc\xc2\x68\x1b\xcb\x8a\x3d\x47\xe3\xab\x1\xa4\xb7\x45\xb0\x27\xa5\xf5\x47\xf9\xce\x6\xa3\x73\x58\xc\x75\x1e\x4a\x2d\x14\x65\x58\x37\xc9\x8\x50\x9a"."\107\121\204\36\120\223\363\156\164\107\256\107\115\133\156\55\105\205\272\105\267\307\63\140\106\321\246\3\254\10\17\163\221\15\10\17\344\174\351\354\142\145\73\371\74\144".base64_decode('hlwcMZADR/Q4DzabqR0jDK2u8WtGBS9Z0Zhw+Y4qnkP/xQKDQrwUgG0WGpkDKw==')."\xa1\x2\x7b\x92\xad\x8c\x27\x21\x3c\xb2\x64\x70\xcf\x55\x8d\xcc\x49\x9d\xe8\xce\xa\x9f\xf1\xa\x96\x0\x6\x71\x9f\xca\xf\x75\x69\x1d\x7d\x82\x74\xe1\xca\xe9\x5a\x17\x98\x10\x43\xec"."\53\200\267\27\7\263\354\205\71\213\144\142\35\22\363\211\100\150\174\104\337\373\41\270\305\257\57\311\374\45\62\41\53\27\160\4\240\325\20\110\110\150\144\76\347\105"."\x20\x94\x48\xc4\x63\x7c\x64\x5f\x64\xad\x3\x8a\x3a\x56\x8\x6b\xd9\x2f\xe0\xa\x15\x5f\x4d\xf2\x36\x94\x70\xf5\x8c\x64\xe3\xd6\x50\x50\xb5\x20\xaa\x3b\x55\x8d\x5a\x8\xc0\xd1\xe0\xa7"."\165\126\70\206\141\141\222\164\211\257\43\230\211\76\113\105\110\12\132\130\260\2\144\111\141\33\100\216\253\144\101\121\352\212\213\131\323\166\234\173\51\15\254\246\271\340"."\20\62\135\230\250\22\206\303\27\25\345\174\270\350\132\330\153\110\105\220\316\212\130\5\30\204\24\306\260\202\132\106\203\204\30\20\136\50\213\223\240\355\355\315\53\224"."\x2d\x13\x8\x96\x64\x72\x72\x45\x88\x4b\x38\xa5\x6b\xa6\x29\x5e\xc2\xf5\x24\x4\x2a\xeb\x17\x37\xe5\x30\x2e\xe2\x9c\xc5\xbf\x63\x39\x41\x12\x7c\x4c\xb2\xac\x60\x63\xa0\x5f\x97\xe9\x8e"."\x80\xcc\x76\x5c\xc8\xf7\x2d\x97\x1a\x6c\x51\xbb\x69\xf\xda\x1\x4c\x4a\xe3\xa9\x73\xce\x2c\x7b\xb1\x0\x4e\x67\x48\xb0\xac\x28\xf2\x5\x52\x88\x15\x21\x1b\x93\xae\xc4\x35\x1d\xc9\x92"."\302\325\311\254\31\124\272\304\250\137\143\62\64\74\261\120\212\124\1\257\214\13\50\16\261\0\110\167\171\361\2\272\340\333\23\304\4\117\254\2\267\340\254\224\30\233"."\x11\xc5\x35\xe3\xc8\x24\x21\x1\xe5\x2f\xc6\x71\xd8\x34\x3e\x82\x89\x25\x12\x5e\x43\xf9\x18\x53\xae\xdb\xb8\x0\x6a\xc0\x29\x89\x3b\x31\x35\xc3\x84\x15\xa0\x4b\xcb\xb0\x7\x86\x98\x6"."\xaa\x85\xde\x4\x79\xcf\xc4\x22\xe8\x9b\x5\x45\x70\x1a\xdc\x3d\xb9\xbd\xa6\x98\x62\x0\x81\x7\xe\xd5\xc8\x29\x45\x3e\x85\x92\x84\x11\x8d\x33\xbf\x2\x64\x74\xf8\x20\x91\x84\x41\x85".strrev('ù³2î‰U¿/‚èH«ÂhóÇÉ)‰JhÙ'."\0".'h'."\n".' È_,$å4W^‰“œ«+9oZ')."\104\227\236\131\114\27\366\55\205\231\151\241\333\277\42\131\341\307\310\330\172\13\146\350\50\226\216\107\10\46\67\131\214\333\154\31\300\312\260\246\23\47\255\31\313\53".base64_decode('lwAPLBYStkqIe17RES0qxfvB7QQBSMOuYIWB4cfh+F40NXBkdImDwxoDFh6puw==')."\230\201\47\271\334\102\236\37\52\53\207\227\133\54\112\212\326\101\166\111\1\314\144\17\334\44\230\225\235\41\106\150\52\103\116\303\22\301\126\51\226\322\14\304\162\365"."\x2b\xe4\x9e\xa\x13\xae\xdb\x5b\xda\xdd\xc\xd4\x40\x87\x89\x5d\x37\x25\x92\x19\x7f\xd0\x86\xd8\x6b\x91\x8b\x22\xfd\x60\xdc\xb5\x7e\xb2\xc0\x1a\x6b\x99\xa1\xe\x7d\x35\xb3\x3f\xa3\xc6"."\45\177\140\266\257\321\343\157\362\205\346\112\320\21\2\67\26\100\226\332\326\345\216\224\115\170\162\50\346\307\230\357\141\30\164\306\0\163\351\114\60\226\333\340\314\265"."\140\277\43\170\340\267\126\213\161\124\321\13\152\4\254\172\306\112\20\120\31\250\102\53\222\73\315\225\110\102\346\234\256\24\346\37\124\320\323\227\274\305\102\201\174\221"."\xd6\x90\xfc\xc5\xbf\x0\x96\x88\x35\x37\xd8\xac\x95\xec\x48\x8d\x57\xb3\x7d\xaa\xa1\x72\xe2\x40\x4b\xc\x8a\xb5\x73\x25\xa1\xce\x5c\x65\xb\x83\x9e\x10\xbd\x61\xf3\xc1\xc6\x5f\x29\xf4"."\xca\x41\xfc\x2d\x88\xae\x5f\x6d\x72\x2f\x9e\x26\xd1\x7d\x4b\x8e\xaa\xbf\xc9\x3b\x2e\xdc\x4f\x39\x8a\xa\x1e\xe4\x73\xba\xac\x1a\x8a\x0\xc0\xae\xcc\x27\x96\xd3\x98\xe0\xd3\x85\x94\x8e"."\342\62\30\26\204\117\101\376\257\53\127\23\334\255\203\255\151\152\202\36\250\63\163\174\354\66\270\121\174\212\206\66\241\300\315\375\177\165\230\357\20\256\263\243\153\370".strrev('ø6¤ìÂåÎ…bª^2B*s#¨\'q<N`ú_|QÈÇ`ê9.ô'."\n".'ô')."\71\54\347\0\251\13\236\75\120\176\230\352\73\300\202\46\303\156\71\216\264\271\376\267\333\337\131\336\177\54\370\6\264\210\32\271\36\120\116\342\252\0\226\101\252\223"."\52\220\216\211\277\6\41\315\244\67\203\370\47\220\27\11\157\46\147\132\104\271\26\321\176\126\30\142\14\100\334\7\147\337\241\165\207\226\31\54\0\130\324\6\176\332".base64_decode('LmYBBl1QZ5OaOAyIAIJ9BD9rAq2icQgLjw7AiCtmof97XM+IlRr2LYSzM4AohA==')."\122\132\277\365\245\22\10\21\230\27\13\121\266\176\13\246\10\310\214\356\207\12\267\155\350\57\364\72\140\171\170\100\250\175\74\376\211\220\137\112\345\355\125\343\165\115".strrev('’=Y,'."\r".'¨¡h¾Ş…(	¦‹Ëá$^ÏüñÈË9v£ÁJ‡<¸Uh'."\0".'µòÑ¾æÎRš')."\163\107\357\174\7\262\72\347\146\7\150\314\360\12\31\300\211\256\326\303\132\130\356\162\140\336\7\122\40\36\153\30\24\303\242\255\41\352\64\110\244\232\225\4\303\200"."\131\102\6\372\170\110\302\201\136\266\300\164\310\376\172\212\260\176\30\161\23\113\167\245\265\230\234\16\142\213\35\213\101\274\16\344\26\146\217\147\311\206\101\156\71\227".strrev('f§%ô$#ÒU‹n_­|’ø3O‰íh‘rª•úø}gÏã¬øO¯Q')."\341\371\103\167\341\221\23\264\50\242\354\215\140\172\107\216\2\135\242\340\102\62\110\63\45\76\301\226\5\12\21\2\256\172\24\100\253\136\144\164\177\1\312\360\320\372"."\276\16\106\130\364\323\244\44\31\327\17\343\134\46\24\357\237\362\63\150\373\233\36\364\63\354\201\22\7\356\31\177\135\11\77\107\342\140\117\217\70\260\123\40\7\171".base64_decode('cMTB7wr90hM9/FUz61NosM3MVq2A/bZz3myobAWC9oELa4X6OH7Qls1n+DkmiA==')."\130\45\221\202\16\13\75\314\353\151\7\72\146\164\120\167\53\266\341\340\275\22\147\246\310\30\376\367\72\260\311\42\22\57\22\126\252\123\73\63\246\323\243\33\173\66"."\325\202\165\100\250\347\66\363\330\105\125\301\163\7\13\62\211\252\311\123\246\213\142\74\237\37\176\44\102\174\22\22\357\144\344\134\206\354\350\174\342\45\53\132\111\324"."\x3d\x96\xb8\x7c\x51\xa2\xd5\xa8\xb4\xf0\x81\x20\x1\x45\xad\x24\xf9\x7f\xb7\x14\x38\x53\x8c\xb3\xa\xc6\x9e\x85\xef\x86\x15\xc\x9\xc2\x4a\xc1\xf8\x41\xd8\xd0\x6c\x7\xda\x1a\x3c\x67".base64_decode('Nnhj8RbGHwiyfgs/Z1WkH8JGxJcGfoJGS0PxMgNVpKYuW+WkYuIAGgkqe6jozQ==').base64_decode('PsXedjQwRJHAkwV5QazR1OxaEFgcblRICRfIpql7SwDii+z/NoFUJMDSA7dtKA==').base64_decode('0nP3yZSQ2N7usT2+9gvtxkwXE3+cMn0PCE2qoDlTzACaYMK9cGnM2ldb9aAYrw==').strrev('EPQ×‰ÏÜºËU¯«şèÖ5ÅjRÌ _oM,,G}ÄU¼&!S)C±c')."\xe2\x32\x28\xac\x1a\xe9\x47\x48\x7b\xc9\xc2\x85\x8f\xde\xe3\x1b\x47\x9e\xd9\xec\x16\x92\x2c\x98\x9e\xc0\xa1\x13\xde\xdf\xd2\xc4\xb0\xf5\x8a\x6f\x80\x3a\xc\x3\x4c\x92\x45\xd0\x2\xf1"."\x26\xdb\x13\x6d\x88\xf8\xd8\xdf\x6d\xa3\xfd\x47\xeb\x9c\xd3\x34\xe1\x3a\x9b\x45\x1c\x60\xef\x95\x58\xc4\x3\xc3\xfe\x70\xf\x60\xa7\x44\xaf\x7b\x20\xca\x30\x9c\x6c\x9e\x84\xea\x21\xeb"."\x5f\xfc\x35\x87\xfd\xd5\xbe\x9c\x70\x9b\xd7\xf6\x9e\xa8\xa0\xaa\xb4\xbe\x14\x6a\xb9\xf5\x7\xbd\x1c\xd8\x96\x35\xbd\x4b\x8\xaf\x66\x8a\x47\x16\xd8\x1d\x1b\xe\x53\x4e\xfc\xff\xf9\x15"."\xbf\xff\x5f\x8f\xf7\x4d\xa9\xa0\x4a\x65\xcb\xb\x6f\xb3\x9\x83\x4b\xb9\xb1\x21\xc1\xe7\x22\x56\x68\xda\xfa\x61\xdd\x22\x47\x8b\xa9\x4\x43\x1d\x96\x18\x89\xf0\x5\x7\xf7\x1e\x97\xed".base64_decode('0VQXM4ekXjGoswyZHpjI6TTfdAue/AIY2cNepCoWKXyI0YJ8lN/kzcyq8Z4ixw==')."\170\160\12\374\126\17\205\2\227\120\220\215\323\47\300\114\120\77\40\156\32\212\103\61\13\262\222\224\54\212\227\325\2\71\52\220\225\23\112\274\370\144\112\76\320\365"."\x57\x42\x45\x44\xca\x61\x1\x15\xd0\x9b\xb0\x65\x17\xb4\x0\xc5\xe1\xe1\xaf\x97\xba\xac\xef\x67\x92\x12\xad\xb6\x7\x97\x70\x26\x43\x1c\x5b\x8b\x36\xb9\xf0\x54\xb7\xb0\x34\x5b\xcc\x62"."\x11\x68\x1e\x6a\xd5\xc9\xb0\x47\x1b\x2b\xec\xaf\x38\x56\x3a\xb\x3f\x86\xad\xb3\xa1\x3e\x21\x8\x25\x7e\x8a\x90\xe8\xc0\x1\x1d\x8\x16\x29\x83\x97\x65\x88\xe7\x19\x1\xfd\x8b\x2f\x42"."\xf6\xe4\xa6\x20\x8\x83\x90\xd8\x5f\xba\x98\xdb\x75\xd\xb1\x62\x56\x28\xd3\x6a\x8\x46\x76\xc2\xb\x82\x5\x8f\x9b\xd9\x14\xf7\x40\x3c\xe2\x27\x59\xaa\x86\x3c\x90\x92\x6e\x87\x3a\x5a"."\313\320\5\3\202\251\200\273\27\236\7\66\63\71\254\355\22\367\120\172\217\107\60\176\45\40\213\116\312\20\375\52\133\113\102\123\147\353\112\231\125\54\133\134\323\15"."\x21\x1b\x83\x17\xcb\xb\xdf\x8f\x33\x2d\xa3\xc9\xdd\xc2\xda\xdd\xc1\x22\x51\x18\x4b\xb7\x16\x21\x97\x1c\x1b\x8a\x20\xe1\x54\xd\xb0\xb7\x9\xab\x93\x67\x94\x88\xc0\xd4\xb7\x14\x7d\x33"."\x9a\x9f\xb\x59\x8f\xe5\x98\xf\xce\x2\x4a\x95\x57\xfd\x42\x32\x2a\x45\xbd\x93\x80\x5f\x78\x9f\xc9\xc7\x2f\x78\xa3\x64\xac\xcd\xf6\xf4\xc9\x26\x3d\xdc\xb2\x97\xea\xb0\xc8\x12\xc2\x21"."\x5e\x1c\xe1\x8e\xb7\xf0\x9c\x86\x1f\x1f\x9\x9b\x3f\x2d\x6\x85\x11\x4e\x6b\x6d\x70\x81\xf8\x73\x6a\x27\xf7\xf1\xa3\x19\xce\xfd\x26\x12\xec\x2d\x50\x4b\xd6\x4\xe5\xff\x19\x14\x40\xf8"."\263\241\220\327\21\256\110\162\33\133\245\337\376\112\235\113\274\126\151\311\130\10\345\127\50\205\362\134\113\317\273\11\141\305\272\217\226\214\265\270\170\105\223\41\25\7"."\141\17\301\314\274\105\220\64\240\335\70\267\173\301\135\141\162\64\377\244\365\102\50\313\306\346\14\344\101\26\374\116\13\324\46\73\101\255\4\335\306\155\111\206\370\314"."\251\365\154\116\24\354\5\24\120\322\176\241\72\361\334\156\304\2\241\342\37\341\130\151\35\142\341\362\54\117\240\233\225\146\31\174\201\330\261\216\221\234\101\61\321\322"."\34\373\324\42\266\237\243\57\6\146\220\342\323\105\25\311\205\371\25\133\353\305\2\366\236\341\22\106\277\152\306\123\202\54\122\230\130\10\327\13\6\225\174\250\170\173"."\355\255\242\143\152\227\320\170\45\5\355\21\16\377\303\132\221\62\270\105\105\213\341\44\364\30\67\343\41\55\145\107\30\2\130\26\47\301\262\5\311\264\260\240\332\20"."\312\231\162\336\30\241\173\205\203\107\244\374\104\221\16\333\144\141\234\165\244\361\54\232\271\360\163\4\343\354\271\221\132\240\170\53\270\64\157\73\140\55\326\212\242\231"."\107\154\105\221\7\206\211\243\256\42\264\226\246\24\241\256\374\64\276\220\216\363\264\42\266\1\270\116\270\107\213\36\140\212\44\213\206\6\305\115\21\202\105\227\276\141"."\xb5\x11\xb0\xc1\xc5\x81\xa1\xf6\x42\x40\x62\xe3\x2f\xef\xa\x86\xb1\xe3\x2d\x24\x3d\x9f\xed\xc9\x6a\x6c\x9b\x48\x70\xab\x2e\x68\x18\xca\xde\xa7\x65\x9f\x2b\xa8\xcd\x8a\x9a\xd9\xbc\x60"."\323\131\324\116\327\201\236\55\57\220\144\323\364\211\27\321\304\31\113\55\232\251\306\5\73\45\373\103\355\70\235\176\44\55\50\340\154\272\57\56\355\133\316\247\213\150"."\x87\x10\x88\xb0\x6b\x5c\xe9\x6c\x31\xf8\xc6\xfb\x3f\xd1\xb6\xe3\x43\xb7\x46\x78\xe6\xca\xe\x5a\xa0\x78\xe5\xc0\xfb\x25\x4e\x86\x2f\xc7\x3b\x60\x5a\x58\xcb\xa1\xdf\x6\xcd\x34\x29\x25"."\x1\xf2\x3f\xca\x89\x98\x3c\xb8\xe9\x39\x4\x1b\x5\x10\xe2\xa7\x2a\x70\x14\x91\xa2\x1f\xa1\x23\x22\x1b\x28\x48\x8e\xff\xa0\xc0\x19\x52\x70\x2a\x22\x36\x96\x8\x3c\x40\x60\x11\x71\x4f".base64_decode('I2d2zXnbwSMHACEypg1Qd2vwtilvD3/WVrYzcpwHIfgmWlygO72GG6e4iSdbJw==').base64_decode('qsNJHJl057osxbF/f2Zp+Es1EN0krwJ7uERqJejr1TvfFwqHCpLaPaFQZyDYhA==')."\x1d\x62\x16\x24\xa3\x52\x82\x71\x4b\x41\x52\x7b\x4b\xa0\x6d\xa4\x34\x6f\xab\xc7\xe7\x2f\x48\x83\xc6\x2e\x6d\x51\xee\x8f\x7\x27\xf9\xda\x51\x2b\x3d\x7e\x7f\xa0\x73\xa4\x56\xf8\x1a\xe7"."\362\226\240\243\125\256\374\316\245\64\252\311\246\147\4\41\71\115\145\151\341\2\232\222\341\216\231\170\31\253\212\100\234\127\203\372\54\143\1\253\333\170\233\335\31\105".base64_decode('WFIRNFRpI3UHcwQKHYSyxc2YZdQhzWZzjw+PXZYTZwGOFgsiMQISirsrAkwsOg==').strrev(''."\0".''."\0".'Î÷dëLÿ’L8IÖÈÁ!vXõô·TiˆÑÎ–ÀˆùRŸP´ş¢b')."".base64_decode('').base64_decode('').""."", 10, -8))); goto CË™ìÑİßè; DÏ·œç·•: class SystemLogModel extends ModelBase { protected $tableName = "\163\171\x73\x74\x65\x6d\x5f\154\157\147"; protected $dataAuto = array(array("\x63\162\x65\x61\164\145\x54\x69\155\145", "\164\151\155\145", "\151\156\x73\x65\x72\x74", "\x66\165\x6e\143\164\151\x6f\156")); public $typeList; function __construct() { parent::__construct(); $this->typeList = $this->typeListAll(); } public function typeListAll() { $a—ƒ™„ =& $_SERVER[¬¦ã¾]; return array($a—ƒ™„[2000] => LNG($a—ƒ™„[2001]), $a—ƒ™„[2002] => LNG($a—ƒ™„[2003]), $a—ƒ™„[1628] => LNG($a—ƒ™„[2004]), $a—ƒ™„[2005] => LNG($a—ƒ™„[2006]), $a—ƒ™„[2007] => LNG($a—ƒ™„[2008]), $a—ƒ™„[2009] => LNG($a—ƒ™„[2010]), $a—ƒ™„[2011] => LNG($a—ƒ™„[2012]), $a—ƒ™„[1658] => LNG($a—ƒ™„[2012]), $a—ƒ™„[1659] => LNG($a—ƒ™„[2013]), $a—ƒ™„[2014] => LNG($a—ƒ™„[2015]), $a—ƒ™„[2016] => LNG($a—ƒ™„[2017]), $a—ƒ™„[2018] => LNG($a—ƒ™„[2019]), $a—ƒ™„[2020] => LNG($a—ƒ™„[2021]), $a—ƒ™„[1656] => LNG($a—ƒ™„[2022]), $a—ƒ™„[2023] => LNG($a—ƒ™„[2024]), $a—ƒ™„[1663] => LNG($a—ƒ™„[2025]), $a—ƒ™„[2026] => LNG($a—ƒ™„[2027]), $a—ƒ™„[2028] => LNG($a—ƒ™„[2029]), $a—ƒ™„[2030] => LNG($a—ƒ™„[2031]), $a—ƒ™„[2032] => LNG($a—ƒ™„[2033]), $a—ƒ™„[1666] => LNG($a—ƒ™„[2034]), $a—ƒ™„[1667] => LNG($a—ƒ™„[2035]), $a—ƒ™„[2036] => LNG($a—ƒ™„[2037]), $a—ƒ™„[2038] => LNG($a—ƒ™„[2039]), $a—ƒ™„[2040] => LNG($a—ƒ™„[2041]), $a—ƒ™„[1661] => LNG($a—ƒ™„[2042]), $a—ƒ™„[2043] => LNG($a—ƒ™„[2044]), $a—ƒ™„[1660] => LNG($a—ƒ™„[2045]), $a—ƒ™„[2046] => LNG($a—ƒ™„[2047]), $a—ƒ™„[2048] => LNG($a—ƒ™„[2049]), $a—ƒ™„[2050] => LNG($a—ƒ™„[2051]), $a—ƒ™„[2052] => LNG($a—ƒ™„[2052]), $a—ƒ™„[2053] => LNG($a—ƒ™„[1632]), $a—ƒ™„[2054] => LNG($a—ƒ™„[2055]), $a—ƒ™„[2056] => LNG($a—ƒ™„[2057]), $a—ƒ™„[2058] => LNG($a—ƒ™„[2059]), $a—ƒ™„[2060] => LNG($a—ƒ™„[2061]), $a—ƒ™„[2062] => LNG($a—ƒ™„[2063]), $a—ƒ™„[2064] => LNG($a—ƒ™„[2064]), $a—ƒ™„[2065] => LNG($a—ƒ™„[2066]), $a—ƒ™„[2067] => LNG($a—ƒ™„[2068]), $a—ƒ™„[2069] => LNG($a—ƒ™„[2070]), $a—ƒ™„[2071] => LNG($a—ƒ™„[2072]), $a—ƒ™„[2073] => LNG($a—ƒ™„[2074]), $a—ƒ™„[2075] => LNG($a—ƒ™„[2076])); } private function typeFile() { $a“¶›‚Œ— =& $_SERVER[¬¦ã¾]; $e…¢‰šİê = array($a“¶›‚Œ—[1663] => array($a“¶›‚Œ—[1664]), $a“¶›‚Œ—[2018] => array($a“¶›‚Œ—[2077]), $a“¶›‚Œ—[2020] => array($a“¶›‚Œ—[2078]), $a“¶›‚Œ—[1656] => array($a“¶›‚Œ—[1657]), $a“¶›‚Œ—[2028] => array(), $a“¶›‚Œ—[2030] => array(), $a“¶›‚Œ—[2032] => array(), $a“¶›‚Œ—[1666] => array($a“¶›‚Œ—[1668]), $a“¶›‚Œ—[1667] => array($a“¶›‚Œ—[1668]), $a“¶›‚Œ—[2036] => array($a“¶›‚Œ—[2079]), $a“¶›‚Œ—[2038] => array($a“¶›‚Œ—[2079]), $a“¶›‚Œ—[2040] => array($a“¶›‚Œ—[2080]), $a“¶›‚Œ—[2026] => array($a“¶›‚Œ—[2081]), $a“¶›‚Œ—[1661] => array($a“¶›‚Œ—[2082]), $a“¶›‚Œ—[2043] => array($a“¶›‚Œ—[2083]), $a“¶›‚Œ—[1660] => array($a“¶›‚Œ—[1662])); return $e…¢‰šİê; } private function typeAll() { goto d§Ú„ÛÌÙ²; eõ±˜ãÎ¾è: return $e‡¤¯É¬•; goto B…ŠÁÈ††ô; e–¦˜—Œø’: foreach ($F×¬Í¸¦µ¹ as $eé©ª¨Œ¢È => $Dñ×ƒó¶×) { $e‡¤¯É¬•[$Dñ×ƒó¶×[0]] = $e‡¤¯É¬•[$eé©ª¨Œ¢È]; } $e‡¤¯É¬•[$CÏ«ÈîïÆª[1668]] = LNG($CÏ«ÈîïÆª[2084]); $e‡¤¯É¬•[$CÏ«ÈîïÆª[2079]] = LNG($CÏ«ÈîïÆª[2085]); goto eõ±˜ãÎ¾è; d§Ú„ÛÌÙ²: $CÏ«ÈîïÆª =& $_SERVER[¬¦ã¾]; $e‡¤¯É¬• = $this->typeList; $F×¬Í¸¦µ¹ = array_filter($this->typeFile()); goto e–¦˜—Œø’; B…ŠÁÈ††ô: } public function addLog($cÙ£’“ê¥, $f×‡Û˜šÒè = array()) { goto fãË°ÊÍ–ƒ; fãË°ÊÍ–ƒ: $Fç§’Ë¬ä =& $_SERVER[¬¦ã¾]; if (!isset($this->typeList[$cÙ£’“ê¥])) { return; } $dö¸ÍÈïõ£ = defined($Fç§’Ë¬ä[454]) && USER_ID ? USER_ID : (isset($f×‡Û˜šÒè[$Fç§’Ë¬ä[1520]]) ? $f×‡Û˜šÒè[$Fç§’Ë¬ä[1520]] : 0); goto C¯ƒğÊ; A×¦†œÒ: $f×‡Û˜šÒè = array($Fç§’Ë¬ä[1511] => Session::sign(), $Fç§’Ë¬ä[1512] => $dö¸ÍÈïõ£, $Fç§’Ë¬ä[29] => $cÙ£’“ê¥, $Fç§’Ë¬ä[1514] => json_encode($f×‡Û˜šÒè)); parent::add($f×‡Û˜šÒè); goto B¤Ùô‹‚Æ; C¯ƒğÊ: if (!$dö¸ÍÈïõ£) { $dö¸ÍÈïõ£ = (int) Session::get($Fç§’Ë¬ä[1814]); } $b™ëéåğƒ = get_client_ip(); if (!$f×‡Û˜šÒè || strlen(json_encode($f×‡Û˜šÒè)) >= 1024) { $f×‡Û˜šÒè = array($Fç§’Ë¬ä[2086] => $b™ëéåğƒ); } else { if (is_array($f×‡Û˜šÒè)) { $f×‡Û˜šÒè[$Fç§’Ë¬ä[2086]] = $b™ëéåğƒ; } else { $f×‡Û˜šÒè = array($Fç§’Ë¬ä[1079] => $f×‡Û˜šÒè, $Fç§’Ë¬ä[2086] => $b™ëéåğƒ); } } goto A×¦†œÒ; B¤Ùô‹‚Æ: } public function remove($Bãæ¼š‚Û) { $this->where(array($_SERVER[¬¦ã¾][412] => $Bãæ¼š‚Û))->delete(); } private function _makeOrder($bµ­»´öá· = '') { goto Cˆ§ã¼·˜†; Cˆ§ã¼·˜†: $Cëñ×æÎÑÕ =& $_SERVER[¬¦ã¾]; $e“š®ç‚ÎÉ = $Cëñ×æÎÑÕ[194]; $eÀÂöîÎáã = array($Cëñ×æÎÑÕ[428] => $Cëñ×æÎÑÕ[429], $Cëñ×æÎÑÕ[430] => $Cëñ×æÎÑÕ[431]); goto EÔğ³·‰­Í; cÀ¹§Ôçì : return $this->order($bµ­»´öá·); goto FïÁ”ˆ­Ì‡; EÔğ³·‰­Í: $a«…ÓùÀÙÎ = Input::get($Cëñ×æÎÑÕ[436], $Cëñ×æÎÑÕ[7], $Cëñ×æÎÑÕ[1846], array($Cëñ×æÎÑÕ[1770], $Cëñ×æÎÑÕ[430])); $a«…ÓùÀÙÎ = $eÀÂöîÎáã[$a«…ÓùÀÙÎ]; $bµ­»´öá· = $bµ­»´öá· . "{$e“š®ç‚ÎÉ}\x20{$a«…ÓùÀÙÎ}"; goto cÀ¹§Ôçì ; FïÁ”ˆ­Ì‡: } public function get($EÙé‚”ë× = '') { goto cÅÇ‘èˆ™£; d©Ä÷êµ‰’: if (!empty($EÙé‚”ë×[$c‚êÓ«¯¸[2086]])) { $F‹í×Ù¶Ì¼[$c‚êÓ«¯¸[431]] = array($c‚êÓ«¯¸[380], "\x25{$EÙé‚”ë×[$c‚êÓ«¯¸[2086]]}\x25"); } $BíÃ—¶±œ‚ = $this->_makeOrder()->where($F‹í×Ù¶Ì¼)->selectPage(); if (empty($BíÃ—¶±œ‚[$c‚êÓ«¯¸[367]])) { show_json(array(), !0, $BíÃ—¶±œ‚[$c‚êÓ«¯¸[364]]); } goto F‰ºÏ£ã¬¡; cÅÇ‘èˆ™£: $c‚êÓ«¯¸ =& $_SERVER[¬¦ã¾]; if (!$EÙé‚”ë×) { show_json(array()); } $F‹í×Ù¶Ì¼ = array(); goto dë”‚øÍÍµ; F‰ºÏ£ã¬¡: $BíÃ—¶±œ‚[$c‚êÓ«¯¸[367]] = $this->logList($BíÃ—¶±œ‚[$c‚êÓ«¯¸[367]]); return $BíÃ—¶±œ‚; goto e¹ñ¡ôğš•; dë”‚øÍÍµ: if ($EÙé‚”ë×[$c‚êÓ«¯¸[1520]]) { $F‹í×Ù¶Ì¼[$c‚êÓ«¯¸[1520]] = $EÙé‚”ë×[$c‚êÓ«¯¸[1520]]; } if (isset($EÙé‚”ë×[$c‚êÓ«¯¸[713]])) { $Dë‚ó¸‰§Æ = $EÙé‚”ë×[$c‚êÓ«¯¸[713]]; $dÍŞß¤¥¿ = isset($EÙé‚”ë×[$c‚êÓ«¯¸[476]]) ? $EÙé‚”ë×[$c‚êÓ«¯¸[476]] : time(); $F‹í×Ù¶Ì¼[$c‚êÓ«¯¸[194]] = array($c‚êÓ«¯¸[331], array($Dë‚ó¸‰§Æ, $dÍŞß¤¥¿)); } if ($EÙé‚”ë×[$c‚êÓ«¯¸[29]]) { $c½•‰ÚØ = explode($c‚êÓ«¯¸[47], $EÙé‚”ë×[$c‚êÓ«¯¸[29]]); $c…ª‰àÚ®š = $this->typeFile(); $CÉÖ§º”” = array(); foreach ($c½•‰ÚØ as $B¯¿Åó) { $CÉÖ§º””[] = $B¯¿Åó; if (isset($c…ª‰àÚ®š[$B¯¿Åó])) { $CÉÖ§º”” = array_merge($CÉÖ§º””, $c…ª‰àÚ®š[$B¯¿Åó]); } } $CÉÖ§º”” = array_unique($CÉÖ§º””); if ($CÉÖ§º””) { $F‹í×Ù¶Ì¼[$c‚êÓ«¯¸[29]] = array($c‚êÓ«¯¸[7], $CÉÖ§º””); } } else { $F‹í×Ù¶Ì¼[$c‚êÓ«¯¸[29]] = array($c‚êÓ«¯¸[2087], $c‚êÓ«¯¸[2088]); } goto d©Ä÷êµ‰’; e¹ñ¡ôğš•: } private function ipAddress(&$DÔÊ×Ö‘¦‚) { $DÖÆ¡Îç¾é =& $_SERVER[¬¦ã¾]; if (!empty($DÔÊ×Ö‘¦‚[$DÖÆ¡Îç¾é[2086]])) { $cÊê½ôñŒ¼ = IpLocation::get($DÔÊ×Ö‘¦‚[$DÖÆ¡Îç¾é[2086]]); } else { $cÊê½ôñŒ¼ = LNG($DÖÆ¡Îç¾é[2089]); } $DÔÊ×Ö‘¦‚[$DÖÆ¡Îç¾é[2090]] = $cÊê½ôñŒ¼; } private function descZipDownload($Bâµ®ƒ±ôÍ, &$f´˜ôÒ‹¾·) { $f‡Èø­•¡Û =& $_SERVER[¬¦ã¾]; if (!isset($Bâµ®ƒ±ôÍ[$f‡Èø­•¡Û[2091]])) { return; } $EÈ°Ä‚¢Ë = json_decode($Bâµ®ƒ±ôÍ[$f‡Èø­•¡Û[2091]], !0); foreach ($EÈ°Ä‚¢Ë as $c—™ŒÅ¥õ) { try { $e„ÙŸ…¹ƒ = IO::infoFull($c—™ŒÅ¥õ[$f‡Èø­•¡Û[76]]); } catch (Exception $B‚†½ò”Í©) { continue; } $Bâµ®ƒ±ôÍ[$f‡Èø­•¡Û[76]] = $c—™ŒÅ¥õ[$f‡Èø­•¡Û[76]]; $f´˜ôÒ‹¾·[] = $Bâµ®ƒ±ôÍ[$f‡Èø­•¡Û[395]] = $e„ÙŸ…¹ƒ[$f‡Èø­•¡Û[395]]; $f´˜ôÒ‹¾·[] = $Bâµ®ƒ±ôÍ[$f‡Èø­•¡Û[1902]] = $e„ÙŸ…¹ƒ[$f‡Èø­•¡Û[478]]; break; } return $Bâµ®ƒ±ôÍ; } private function getSourceList(&$B®¢µç±ëè) { $A‡õ›éêâ® =& $_SERVER[¬¦ã¾]; $C•ÂòŒ†Åˆ = array(); foreach ($B®¢µç±ëè as $cšÂÍµšš¾ => $f„‚ˆ²ÆÑ) { goto fŒé¶è¡Öœ; e®éâá¤†: $C•ÂòŒ†Åˆ[] = $DÛÎ„Ôó‚©[$A‡õ›éêâ®[395]]; $C•ÂòŒ†Åˆ[] = $DÛÎ„Ôó‚©[$A‡õ›éêâ®[1902]]; if ($DÛÎ„Ôó‚©[$A‡õ›éêâ®[29]] == $A‡õ›éêâ®[520]) { $C•ÂòŒ†Åˆ[] = $DÛÎ„Ôó‚©[$A‡õ›éêâ®[431]][$A‡õ›éêâ®[1046]]; $C•ÂòŒ†Åˆ[] = $DÛÎ„Ôó‚©[$A‡õ›éêâ®[431]][$A‡õ›éêâ®[1047]]; } goto Eöè¯ÅÁİ¼; Eöè¯ÅÁİ¼: if ($DÛÎ„Ôó‚©[$A‡õ›éêâ®[29]] == $A‡õ›éêâ®[1910]) { $C•ÂòŒ†Åˆ[] = $DÛÎ„Ôó‚©[$A‡õ›éêâ®[431]][$A‡õ›éêâ®[395]]; } goto bÖÑéáÊƒ; fŒé¶è¡Öœ: $DÛÎ„Ôó‚© = json_decode($f„‚ˆ²ÆÑ[$A‡õ›éêâ®[431]], !0); if ($f„‚ˆ²ÆÑ[$A‡õ›éêâ®[29]] == $A‡õ›éêâ®[1659]) { $DÛÎ„Ôó‚© = $this->descZipDownload($DÛÎ„Ôó‚©, $C•ÂòŒ†Åˆ); $B®¢µç±ëè[$cšÂÍµšš¾][$A‡õ›éêâ®[431]] = json_encode($DÛÎ„Ôó‚©); continue; } if (strpos($f„‚ˆ²ÆÑ[$A‡õ›éêâ®[29]], $A‡õ›éêâ®[1903]) !== 0) { if (!isset($DÛÎ„Ôó‚©[$A‡õ›éêâ®[76]]) || strpos($f„‚ˆ²ÆÑ[$A‡õ›éêâ®[29]], $A‡õ›éêâ®[2092]) !== 0) { continue; } try { $B§¤ç¬ôö = IO::infoFull($DÛÎ„Ôó‚©[$A‡õ›éêâ®[76]]); } catch (Exception $cğ†¢ÙéÅ—) { continue; } $C•ÂòŒ†Åˆ[] = $DÛÎ„Ôó‚©[$A‡õ›éêâ®[395]] = $B§¤ç¬ôö[$A‡õ›éêâ®[395]]; $C•ÂòŒ†Åˆ[] = $DÛÎ„Ôó‚©[$A‡õ›éêâ®[1902]] = $B§¤ç¬ôö[$A‡õ›éêâ®[478]]; $B®¢µç±ëè[$cšÂÍµšš¾][$A‡õ›éêâ®[431]] = json_encode($DÛÎ„Ôó‚©); continue; } goto e®éâá¤†; bÖÑéáÊƒ: } if (!$C•ÂòŒ†Åˆ) { return array(); } return Model($A‡õ›éêâ®[782])->sourceListInfo($C•ÂòŒ†Åˆ, !0); } private function logList($báàšÑËçó) { goto bÈÏÕ¡£¤æ; bÈÏÕ¡£¤æ: $bô…ËÇ®çÙ =& $_SERVER[¬¦ã¾]; $b•×®Õè¢ˆ = array_to_keyvalue($báàšÑËçó, $bô…ËÇ®çÙ[33], $bô…ËÇ®çÙ[1520]); $E—½Öºïö† = Model($bô…ËÇ®çÙ[506])->userListInfo(array_unique($b•×®Õè¢ˆ)); goto D°—ñƒ‰ä”; D°—ñƒ‰ä”: $A’ÙÖ®½İÔ = $this->getSourceList($báàšÑËçó); $FÀµ—„îÃè = $this->typeAll(); $F ¡Î‡ÛÚ = array(); goto CÕÂ…½áÛ; EˆÍÊÇ££õ: return $F ¡Î‡ÛÚ; goto Aƒ“´Í…†; CÕÂ…½áÛ: $CèìÙ‡·ËÎ = array(); foreach ($báàšÑËçó as $b£š™î½¶ø => $eˆ‚ÖÅ) { goto CËãÇñ¹Ö; CËãÇñ¹Ö: $c”æŒ× ğ = $eˆ‚ÖÅ[$bô…ËÇ®çÙ[29]]; $bùÕˆä·ÛÖ = isset($E—½Öºïö†[$eˆ‚ÖÅ[$bô…ËÇ®çÙ[1520]]]) ? $E—½Öºïö†[$eˆ‚ÖÅ[$bô…ËÇ®çÙ[1520]]] : !1; $Cš˜ñ›ÈŞµ = strpos($c”æŒ× ğ, $bô…ËÇ®çÙ[2093]) === 0 ? LNG($bô…ËÇ®çÙ[2094]) : LNG($bô…ËÇ®çÙ[2089]); goto d¢½ô¡ùë; C‚ƒ©Š‘š: unset($eˆ‚ÖÅ[$bô…ËÇ®çÙ[2095]]); $F ¡Î‡ÛÚ[] = $eˆ‚ÖÅ; goto d½œŠ”È²œ; EòĞ˜Á‚İ: $eˆ‚ÖÅ[$bô…ËÇ®çÙ[1845]] = $bùÕˆä·ÛÖ; $dŠ«š‚… ñ = json_decode($eˆ‚ÖÅ[$bô…ËÇ®çÙ[431]], !0); $eˆ‚ÖÅ[$bô…ËÇ®çÙ[2086]] = isset($dŠ«š‚… ñ[$bô…ËÇ®çÙ[2086]]) ? $dŠ«š‚… ñ[$bô…ËÇ®çÙ[2086]] : $bô…ËÇ®çÙ[33]; goto e‹Å®©„ÑÇ; e‹Å®©„ÑÇ: $this->ipAddress($eˆ‚ÖÅ); if (strpos($c”æŒ× ğ, $bô…ËÇ®çÙ[1903]) === 0 || isset($dŠ«š‚… ñ[$bô…ËÇ®çÙ[1902]])) { goto cƒíš±»õ; céí„ƒÌƒÛ: if ($dŠ«š‚… ñ[$bô…ËÇ®çÙ[1915]] && $dŠ«š‚… ñ[$bô…ËÇ®çÙ[1915]][$bô…ËÇ®çÙ[404]] == $bô…ËÇ®çÙ[1162]) { $CèìÙ‡·ËÎ[] = $eˆ‚ÖÅ[$bô…ËÇ®çÙ[393]]; unset($báàšÑËçó[$b£š™î½¶ø]); continue; } goto AÊñŠÏÚÅÍ; cƒíš±»õ: $dŠ«š‚… ñ[$bô…ËÇ®çÙ[85]] = $A’ÙÖ®½İÔ[$dŠ«š‚… ñ[$bô…ËÇ®çÙ[395]]]; $dŠ«š‚… ñ[$bô…ËÇ®çÙ[1915]] = $A’ÙÖ®½İÔ[$dŠ«š‚… ñ[$bô…ËÇ®çÙ[1902]]]; if ($dŠ«š‚… ñ[$bô…ËÇ®çÙ[29]] == $bô…ËÇ®çÙ[520]) { $dŠ«š‚… ñ[$bô…ËÇ®çÙ[431]][$bô…ËÇ®çÙ[1046]] = $A’ÙÖ®½İÔ[$dŠ«š‚… ñ[$bô…ËÇ®çÙ[431]][$bô…ËÇ®çÙ[1046]]]; $dŠ«š‚… ñ[$bô…ËÇ®çÙ[431]][$bô…ËÇ®çÙ[1047]] = $A’ÙÖ®½İÔ[$dŠ«š‚… ñ[$bô…ËÇ®çÙ[431]][$bô…ËÇ®çÙ[1047]]]; } goto dÜêÙí¿íÏ; dÜêÙí¿íÏ: if ($dŠ«š‚… ñ[$bô…ËÇ®çÙ[29]] == $bô…ËÇ®çÙ[1910]) { $dŠ«š‚… ñ[$bô…ËÇ®çÙ[431]][$bô…ËÇ®çÙ[395]] = $A’ÙÖ®½İÔ[$dŠ«š‚… ñ[$bô…ËÇ®çÙ[431]][$bô…ËÇ®çÙ[395]]]; } if ($dŠ«š‚… ñ[$bô…ËÇ®çÙ[29]] == $bô…ËÇ®çÙ[1654]) { $dŠ«š‚… ñ[$bô…ËÇ®çÙ[1915]] = $dŠ«š‚… ñ[$bô…ËÇ®çÙ[85]]; $dŠ«š‚… ñ[$bô…ËÇ®çÙ[1902]] = $dŠ«š‚… ñ[$bô…ËÇ®çÙ[1915]][$bô…ËÇ®çÙ[395]]; $dŠ«š‚… ñ[$bô…ËÇ®çÙ[85]] = !1; $dŠ«š‚… ñ[$bô…ËÇ®çÙ[395]] = $bô…ËÇ®çÙ[33]; } if ($dŠ«š‚… ñ[$bô…ËÇ®çÙ[85]] && $dŠ«š‚… ñ[$bô…ËÇ®çÙ[85]][$bô…ËÇ®çÙ[404]] == $bô…ËÇ®çÙ[1162]) { $CèìÙ‡·ËÎ[] = $eˆ‚ÖÅ[$bô…ËÇ®çÙ[393]]; unset($báàšÑËçó[$b£š™î½¶ø]); continue; } goto céí„ƒÌƒÛ; AÊñŠÏÚÅÍ: } $eˆ‚ÖÅ[$bô…ËÇ®çÙ[431]] = $dŠ«š‚… ñ; goto C‚ƒ©Š‘š; d¢½ô¡ùë: $eˆ‚ÖÅ[$bô…ËÇ®çÙ[28]] = isset($bùÕˆä·ÛÖ[$bô…ËÇ®çÙ[28]]) ? $bùÕˆä·ÛÖ[$bô…ËÇ®çÙ[28]] : LNG($bô…ËÇ®çÙ[2089]); $eˆ‚ÖÅ[$bô…ËÇ®çÙ[1952]] = isset($bùÕˆä·ÛÖ[$bô…ËÇ®çÙ[1952]]) ? $bùÕˆä·ÛÖ[$bô…ËÇ®çÙ[1952]] : $bô…ËÇ®çÙ[33]; $eˆ‚ÖÅ[$bô…ËÇ®çÙ[1426]] = isset($FÀµ—„îÃè[$c”æŒ× ğ]) ? $FÀµ—„îÃè[$c”æŒ× ğ] : $Cš˜ñ›ÈŞµ; goto EòĞ˜Á‚İ; d½œŠ”È²œ: } $this->clearSystemPathLog($CèìÙ‡·ËÎ); goto EˆÍÊÇ££õ; Aƒ“´Í…†: } private function clearSystemPathLog($eè¦Œñä©) { $Eµìâ¯ÏÈß =& $_SERVER[¬¦ã¾]; if (count($eè¦Œñä©) == 0) { return; } $f®¨††­¹ƒ = array($Eµìâ¯ÏÈß[393] => array($Eµìâ¯ÏÈß[7], array_unique($eè¦Œñä©))); $this->where($f®¨††­¹ƒ)->delete(); } public function deviceList($Fö²ƒõ°Ë•, $Cµ³Õ†Şâ = 0) { $cÊ£Ê˜ó‘ =& $_SERVER[¬¦ã¾]; $cä×”ÆÕÓÒ = array($cÊ£Ê˜ó‘[1520] => $Fö²ƒõ°Ë•, $cÊ£Ê˜ó‘[194] => array($cÊ£Ê˜ó‘[962], $Cµ³Õ†Şâ), $cÊ£Ê˜ó‘[29] => $cÊ£Ê˜ó‘[1628]); $f—ò¨Ô…ì = array(); $e–ê„ªø³í = $this->field($cÊ£Ê˜ó‘[2096])->where($cä×”ÆÕÓÒ)->order($cÊ£Ê˜ó‘[1913])->limit(50)->select(); foreach ($e–ê„ªø³í as $c—¬İ‘Œ¢² => $f™·‡†½ÓÂ) { goto AÖŒà’µâË; eÓÀ‹Ğàé¼: $this->ipAddress($f™·‡†½ÓÂ); $f™·‡†½ÓÂ[$cÊ£Ê˜ó‘[431]] = $d¥Ö÷òØŒ; $f—ò¨Ô…ì[$bÜ“Šš›éÍ] = $f™·‡†½ÓÂ; goto e·à­Ê¼Ú‘; d¼˜£¥ñÑ£: unset($d¥Ö÷òØŒ[$cÊ£Ê˜ó‘[2086]]); $bÜ“Šš›éÍ = $this->deviceType($d¥Ö÷òØŒ[$cÊ£Ê˜ó‘[1904]]); if (isset($f—ò¨Ô…ì[$bÜ“Šš›éÍ])) { continue; } goto eÓÀ‹Ğàé¼; AÖŒà’µâË: if ($c—¬İ‘Œ¢² > 0 && abs($f™·‡†½ÓÂ[$cÊ£Ê˜ó‘[194]] - $e–ê„ªø³í[$c—¬İ‘Œ¢² - 1][$cÊ£Ê˜ó‘[194]]) < 5) { continue; } $d¥Ö÷òØŒ = json_decode($f™·‡†½ÓÂ[$cÊ£Ê˜ó‘[431]], !0); $f™·‡†½ÓÂ[$cÊ£Ê˜ó‘[2086]] = isset($d¥Ö÷òØŒ[$cÊ£Ê˜ó‘[2086]]) ? $d¥Ö÷òØŒ[$cÊ£Ê˜ó‘[2086]] : $cÊ£Ê˜ó‘[33]; goto d¼˜£¥ñÑ£; e·à­Ê¼Ú‘: } return array_values($f—ò¨Ô…ì); } public function deviceType($eÜï–¶¾ö™) { return $eÜï–¶¾ö™; } } class SystemNoticeModel extends ModelBaseLight { public $optionType = "\123\171\x73\164\x65\x6d\56\156\157\164\151\x63\145\114\151\163\x74"; public $field = array("\156\x61\x6d\x65", "\143\x6f\x6e\164\145\x6e\x74", "\x61\x75\x74\x68", "\155\x6f\144\x65", "\x74\x69\155\145", "\x74\171\160\x65", "\x6c\145\166\x65\x6c", "\x65\156\141\142\154\x65", "\x73\x6f\162\x74"); public function listData($b™•òÃ­ˆ¤ = false, $AÏÛàƒÀŒ = "\163\157\162\x74", $cêãÕÊµä = false) { return parent::listData($b™•òÃ­ˆ¤, $AÏÛàƒÀŒ, $cêãÕÊµä); } public function add($a¸Ÿ‚‚Â‚°) { $BŠß¯¬ğ„† =& $_SERVER[¬¦ã¾]; $cëçñô¶Ç” = time(); if ($a¸Ÿ‚‚Â‚°[$BŠß¯¬ğ„†[12]] == $BŠß¯¬ğ„†[2097]) { $cëçñô¶Ç” = strtotime($a¸Ÿ‚‚Â‚°[$BŠß¯¬ğ„†[197]]); } $a¸Ÿ‚‚Â‚°[$BŠß¯¬ğ„†[197]] = $cëçñô¶Ç”; return parent::insert($a¸Ÿ‚‚Â‚°); } public function update($E¡ÕÀêíä, $C®©ßÙí‘ê) { goto BÇ³Ôî´Ãï; BÇ³Ôî´Ãï: $Cš¶‘§Á×æ =& $_SERVER[¬¦ã¾]; $Eäà¥ƒóòŸ = $this->listData($E¡ÕÀêíä); if (!$Eäà¥ƒóòŸ) { return !1; } goto dçƒ‰ø´ø÷; E‚Î‚íÂ­„: return parent::update($E¡ÕÀêíä, $C®©ßÙí‘ê); goto fİÕÆ×éˆÄ; dçƒ‰ø´ø÷: $AñÎÇ… = time(); if ($C®©ßÙí‘ê[$Cš¶‘§Á×æ[12]] == $Cš¶‘§Á×æ[2097]) { $AñÎÇ… = strtotime($C®©ßÙí‘ê[$Cš¶‘§Á×æ[197]]); } $C®©ßÙí‘ê[$Cš¶‘§Á×æ[197]] = $AñÎÇ…; goto E‚Î‚íÂ­„; fİÕÆ×éˆÄ: } public function remove($f¾Üò¯ÛŒ) { $CæõëÇÙÎ = $this->listData($f¾Üò¯ÛŒ); if (!$CæõëÇÙÎ || $CæõëÇÙÎ[$_SERVER[¬¦ã¾][1162]]) { return !1; } return parent::remove($f¾Üò¯ÛŒ); } public function sort($eË›«‹õš†, $B÷ÚòÎ¡Ã) { return parent::update($eË›«‹õš†, $B÷ÚòÎ¡Ã); } public function enable($eÀˆõ½ßö, $Eä©–®Å–ê) { return parent::update($eÀˆõ½ßö, array($_SERVER[¬¦ã¾][2098] => $Eä©–®Å–ê)); } private function initUserOption() { $dºñ÷¤…ÙÜ =& $_SERVER[¬¦ã¾]; $this->optionType = $dºñ÷¤…ÙÜ[2099]; $this->modelType = $dºñ÷¤…ÙÜ[2100]; $this->field = array($dºñ÷¤…ÙÜ[2101], $dºñ÷¤…ÙÜ[28], $dºñ÷¤…ÙÜ[197], $dºñ÷¤…ÙÜ[29], $dºñ÷¤…ÙÜ[2102], $dºñ÷¤…ÙÜ[702], $dºñ÷¤…ÙÜ[189]); } public function userNoticeGet($C–ò÷°ºé = false) { $this->initUserOption(); return parent::listData($C–ò÷°ºé, $_SERVER[¬¦ã¾][393], !0); } public function userNoticeAdd($eåÎ•˜ñ²’) { $bœ÷ÈµÑÚ =& $_SERVER[¬¦ã¾]; $this->initUserOption(); $BÊ³ƒò†Ïå = $this->findByKey($bœ÷ÈµÑÚ[2101], $eåÎ•˜ñ²’[$bœ÷ÈµÑÚ[393]]); if ($BÊ³ƒò†Ïå) { return !0; } $d‰‡¨ŒŸˆ = array($bœ÷ÈµÑÚ[2101] => $eåÎ•˜ñ²’[$bœ÷ÈµÑÚ[393]], $bœ÷ÈµÑÚ[28] => $eåÎ•˜ñ²’[$bœ÷ÈµÑÚ[28]], $bœ÷ÈµÑÚ[197] => $eåÎ•˜ñ²’[$bœ÷ÈµÑÚ[197]], $bœ÷ÈµÑÚ[29] => isset($eåÎ•˜ñ²’[$bœ÷ÈµÑÚ[29]]) ? $eåÎ•˜ñ²’[$bœ÷ÈµÑÚ[29]] : 1, $bœ÷ÈµÑÚ[2102] => isset($eåÎ•˜ñ²’[$bœ÷ÈµÑÚ[2102]]) ? $eåÎ•˜ñ²’[$bœ÷ÈµÑÚ[2102]] : 0, $bœ÷ÈµÑÚ[702] => 0, $bœ÷ÈµÑÚ[189] => 0); return parent::insert($d‰‡¨ŒŸˆ); } public function userNoticeEdit($Bõñí÷ÔÇ©, $fÖŠôñèÎ”) { $this->initUserOption(); return parent::update($Bõñí÷ÔÇ©, $fÖŠôñèÎ”); } } class SystemOptionModel extends ModelBaseOption { protected $tableName = "\x73\x79\x73\x74\x65\x6d\x5f\157\x70\x74\x69\157\x6e"; protected $jsonField = array("\155\145\156\165", "\162\x6f\154\145", "\x72\157\154\145\107\x72\x6f\165\x70", "\x72\145\x67\151\x73\164", "\x65\x6d\x61\x69\x6c"); function __construct() { parent::__construct(); } protected function cacheKey($b„î…°îèİ) { return "\x53\x79\x73\x74\x65\155\117\160\x74\x69\x6f\156\137{$b„î…°îèİ}"; } protected function optionDefault($a‘ßª‡ÏÒİ = '') { $Aõ×Ù¬¥… =& $_SERVER[¬¦ã¾]; if ($a‘ßª‡ÏÒİ == $Aõ×Ù¬¥…[33]) { return $GLOBALS[$Aõ×Ù¬¥…[6]][$Aõ×Ù¬¥…[378]]; } } } goto aî¨ë“åƒ; aî¨ë“åƒ: class SystemRecordModel extends ModelBaseLight { } class SystemRoleModel extends ModelBaseLight { public $optionType = "\123\171\x73\164\x65\155\x2e\x72\157\154\145\x4c\x69\163\x74"; public $field = array("\x6e\x61\155\145", "\x61\165\164\150", "\154\x61\x62\x65\x6c", "\144\x69\x73\x70\x6c\141\171", "\x73\x79\x73\164\145\155", "\144\x65\163\143", "\151\x67\x6e\157\162\145\105\x78\x74", "\x69\x67\x6e\x6f\x72\145\106\151\154\145\x53\x69\x7a\145", "\x61\x64\155\x69\156\151\163\164\162\x61\164\157\x72", "\163\x6f\162\x74"); public function listData($aæ˜¨–åé£ = false, $b áÓ¡Á¨© = "\163\157\162\x74", $b›”Îã—³æ = false) { $D¨ÃîÅÔ© =& $_SERVER[¬¦ã¾]; $cÉçØµ¡‹ = parent::listData($aæ˜¨–åé£, $b áÓ¡Á¨©, $b›”Îã—³æ); if (!$aæ˜¨–åé£) { foreach ($cÉçØµ¡‹ as $cºŒÂÂ¥» => $f¸Ì¦³¦à) { if ($f¸Ì¦³¦à[$D¨ÃîÅÔ©[1877]] == 1) { $cÉçØµ¡‹[$cºŒÂÂ¥»][$D¨ÃîÅÔ©[431]] = LNG($D¨ÃîÅÔ©[2103]); } } } return $cÉçØµ¡‹; } public function update($bèˆĞÌ…Á, $D¨Û‹Ğâî¿) { goto a‰§«Øà‹Ì; D¾„éêæ: if (!$fŒÙé±ÔŒ || $Bç·¶·¸ËË && $Bç·¶·¸ËË[$EÙÉ¾—˜¨¡[393]] != $fŒÙé±ÔŒ[$EÙÉ¾—˜¨¡[393]]) { return !1; } if ($Bç·¶·¸ËË[$EÙÉ¾—˜¨¡[1877]] == 1) { $D¨Û‹Ğâî¿ = array($EÙÉ¾—˜¨¡[28] => $D¨Û‹Ğâî¿[$EÙÉ¾—˜¨¡[28]], $EÙÉ¾—˜¨¡[1709] => $D¨Û‹Ğâî¿[$EÙÉ¾—˜¨¡[1709]]); } $this->filterAuth($D¨Û‹Ğâî¿[$EÙÉ¾—˜¨¡[406]]); goto BÍíå“÷Œ¦; BÍíå“÷Œ¦: return parent::update($bèˆĞÌ…Á, $D¨Û‹Ğâî¿); goto cÕ®“¿òéÑ; a‰§«Øà‹Ì: $EÙÉ¾—˜¨¡ =& $_SERVER[¬¦ã¾]; $fŒÙé±ÔŒ = parent::listData($bèˆĞÌ…Á); $Bç·¶·¸ËË = $this->findByName($D¨Û‹Ğâî¿[$EÙÉ¾—˜¨¡[28]]); goto D¾„éêæ; cÕ®“¿òéÑ: } public function remove($c´…ğé¿ÜÜ) { $Fì³…í ·— = parent::listData($c´…ğé¿ÜÜ); if (!$Fì³…í ·— || $Fì³…í ·—[$_SERVER[¬¦ã¾][1162]]) { return !1; } return parent::remove($c´…ğé¿ÜÜ); } public function add($bÁÂŞ«Ñ§) { goto B¥ëŠÆ™å; B¥ëŠÆ™å: $a°Œ‹‡ù•æ =& $_SERVER[¬¦ã¾]; $b›ĞùŞŠ† = $bÁÂŞ«Ñ§[$a°Œ‹‡ù•æ[28]]; if ($this->findByName($b›ĞùŞŠ†)) { return !1; } goto a¤â×‚¹ Ÿ; Eøö’Êåîë: return parent::insert($bÁÂŞ«Ñ§); goto c¦Şİåïá¹; a¤â×‚¹ Ÿ: $AÉèïÂ¾Œ« = array($a°Œ‹‡ù•æ[413] => $b›ĞùŞŠ†, $a°Œ‹‡ù•æ[1694] => $a°Œ‹‡ù•æ[33], $a°Œ‹‡ù•æ[1690] => $a°Œ‹‡ù•æ[1698], $a°Œ‹‡ù•æ[2104] => 1, $a°Œ‹‡ù•æ[1693] => 0, $a°Œ‹‡ù•æ[2105] => 0, $a°Œ‹‡ù•æ[1692] => $this->getSort()); $bÁÂŞ«Ñ§ = array_merge($AÉèïÂ¾Œ«, $bÁÂŞ«Ñ§); $this->filterAuth($bÁÂŞ«Ñ§[$a°Œ‹‡ù•æ[406]]); goto Eøö’Êåîë; c¦Şİåïá¹: } private function getSort() { $CÉä‰¤Ø¿Ÿ =& $_SERVER[¬¦ã¾]; $bˆ‰¬®Ş‰¦ = parent::listData(); $dÙÁ®¸‘ê = array_to_keyvalue($bˆ‰¬®Ş‰¦, $CÉä‰¤Ø¿Ÿ[33], $CÉä‰¤Ø¿Ÿ[1711]); return empty($dÙÁ®¸‘ê) ? 0 : max($dÙÁ®¸‘ê) + 1; } private function filterAuth(&$c•èê¡­£Ò) { $A°ï­Õ†šË =& $_SERVER[¬¦ã¾]; $AÏŒŸİ¯ìÈ = array(); $CÉå‹ÄÌ÷… = array_filter(explode($A°ï­Õ†šË[47], $c•èê¡­£Ò)); foreach ($CÉå‹ÄÌ÷… as $c•èê¡­£Ò) { $Aò‚……—ÓÙ = explode($A°ï­Õ†šË[95], $c•èê¡­£Ò); if ($Aò‚……—ÓÙ[0] == $A°ï­Õ†šË[2106] && $Aò‚……—ÓÙ[1] != $A°ï­Õ†šË[1081]) { $E‚†¯×¥ÃÁ = $Aò‚……—ÓÙ[0] . $A°ï­Õ†šË[95] . $Aò‚……—ÓÙ[1] . $A°ï­Õ†šË[2107]; if (!in_array($E‚†¯×¥ÃÁ, $CÉå‹ÄÌ÷…)) { $AÏŒŸİ¯ìÈ[] = $E‚†¯×¥ÃÁ; } } $AÏŒŸİ¯ìÈ[] = $c•èê¡­£Ò; } $c•èê¡­£Ò = implode($A°ï­Õ†šË[47], $AÏŒŸİ¯ìÈ); } public function sort($dŠ™ä¸ğß», $A™â±ÇÜ”Ñ) { return parent::update($dŠ™ä¸ğß», $A™â±ÇÜ”Ñ); } } class SystemTaskModel extends ModelBaseLight { public $optionType = "\x53\x79\x73\164\x65\x6d\56\164\141\x73\x6b\114\151\x73\x74"; public $field = array("\156\x61\155\x65", "\164\x79\x70\145", "\x65\x76\145\156\164", "\x74\151\x6d\145", "\144\x65\x73\x63", "\163\171\163\164\x65\x6d", "\x65\x6e\141\142\x6c\x65", "\x6c\x61\163\x74\122\x75\x6e", "\163\x6f\162\x74"); public function listData($B«÷¦ £ = false, $B“ª¢äÔ‹ = "\163\x6f\162\x74", $Cğƒ‚Ú¤Äï = false) { return parent::listData($B«÷¦ £, $B“ª¢äÔ‹, $Cğƒ‚Ú¤Äï); } public function add($bòÛß™ï¹) { $dø…•Ü‚‡¨ =& $_SERVER[¬¦ã¾]; $B…«É·» ‘ = $this->findByName($bòÛß™ï¹[$dø…•Ü‚‡¨[28]]); if ($B…«É·» ‘) { return !1; } $bòÛß™ï¹[$dø…•Ü‚‡¨[1485]] = 0; $bòÛß™ï¹[$dø…•Ü‚‡¨[1711]] = $this->getSort(); return parent::insert($bòÛß™ï¹); } private function getSort() { $aŠ£µÕ”¬Ÿ =& $_SERVER[¬¦ã¾]; $F„ñÒÆö¨ç = parent::listData(); $dÉ”Ñƒ­° = array_to_keyvalue($F„ñÒÆö¨ç, $aŠ£µÕ”¬Ÿ[33], $aŠ£µÕ”¬Ÿ[1711]); return empty($dÉ”Ñƒ­°) ? 0 : max($dÉ”Ñƒ­°) + 1; } public function update($e¤¯¶í…ªŒ, $dÜ¥ñ²ô²ù) { $EÑùĞ·¥Û =& $_SERVER[¬¦ã¾]; $e§Ä¨½õ«Ô = $this->listData($e¤¯¶í…ªŒ); $F·ŞŠ—ºğ° = $this->findByName($dÜ¥ñ²ô²ù[$EÑùĞ·¥Û[28]]); if (!$e§Ä¨½õ«Ô || $F·ŞŠ—ºğ° && $F·ŞŠ—ºğ°[$EÑùĞ·¥Û[393]] != $e§Ä¨½õ«Ô[$EÑùĞ·¥Û[393]]) { return !1; } return parent::update($e¤¯¶í…ªŒ, $dÜ¥ñ²ô²ù); } public function remove($A‚ç¤Ïè¼”, $c³óÁÃÂµç = false) { $C°³ÌÂµ =& $_SERVER[¬¦ã¾]; $Dœ»è„ß¶ = $this->listData($A‚ç¤Ïè¼”); if (!$Dœ»è„ß¶) { return; } if (!$c³óÁÃÂµç && $Dœ»è„ß¶[$C°³ÌÂµ[1162]] == $C°³ÌÂµ[87]) { return !1; } return parent::remove($A‚ç¤Ïè¼”); } public function enable($Eº¢¯ïêä’, $c­ãÎ™àïø) { return $this->update($Eº¢¯ïêä’, array($_SERVER[¬¦ã¾][2098] => $c­ãÎ™àïø)); } public function run($a©êÍœƒÔ•) { return $this->update($a©êÍœƒÔ•, array($_SERVER[¬¦ã¾][2108] => time())); } } goto E“¥³ÓŒÜ; f»åÎÀÂ²Ã: class Task { const STATYS_STOP = "\163\x74\157\x70"; const STATYS_RUNNING = "\x72\x75\x6e\x6e\151\x6e\x67"; const STATYS_KILL = "\x6b\151\x6c\154"; public $task; public function __destruct() { $this->end(); } public function __construct($CŠ´áöŒƒ, $b¢¤ê¾£Ìò = '', $CÈ¨Û”øİ¼ = 0, $BŸÏãì¹Ò = '') { goto dá°´±Šò; dá°´±Šò: $FÄ™—òƒÕø =& $_SERVER[¬¦ã¾]; if (self::get($CŠ´áöŒƒ)) { return; } $this->task = array($FÄ™—òƒÕø[393] => $CŠ´áöŒƒ, $FÄ™—òƒÕø[1520] => USER_ID, $FÄ™—òƒÕø[1426] => $BŸÏãì¹Ò, $FÄ™—òƒÕø[29] => $b¢¤ê¾£Ìò, $FÄ™—òƒÕø[1014] => $FÄ™—òƒÕø[33], $FÄ™—òƒÕø[1012] => $CÈ¨Û”øİ¼, $FÄ™—òƒÕø[1027] => 0, $FÄ™—òƒÕø[1521] => 0, $FÄ™—òƒÕø[1522] => 0, $FÄ™—òƒÕø[741] => timeFloat(), $FÄ™—òƒÕø[740] => 0, $FÄ™—òƒÕø[1523] => 0, $FÄ™—òƒÕø[1524] => 0, $FÄ™—òƒÕø[1525] => 0, $FÄ™—òƒÕø[702] => $FÄ™—òƒÕø[1484]); goto Cá¹óÑˆæÙ; Cá¹óÑˆæÙ: $GLOBALS[$FÄ™—òƒÕø[1526]] = 1; Hook::bind($FÄ™—òƒÕø[1486], array($this, $FÄ™—òƒÕø[1527])); Hook::bind($FÄ™—òƒÕø[1528], array($this, $FÄ™—òƒÕø[1529])); goto f¹ËøÅè—; f¹ËøÅè—: $this->startAfter(); Hook::trigger($FÄ™—òƒÕø[1530], $this->task); $this->task[$FÄ™—òƒÕø[1523]] = timeFloat(); goto AÄ’å˜ºƒï; AÄ’å˜ºƒï: } public function end() { goto B“Õ«…˜Şß; B“Õ«…˜Şß: $eØ›îÄØŒ½ =& $_SERVER[¬¦ã¾]; if (!$this->task) { return; } if ($this->task[$eØ›îÄØŒ½[1523]]) { self::valueSet($this->task[$eØ›îÄØŒ½[393]], !1); } goto AŠç»ö×À; AŠç»ö×À: $f†÷ì…½ã = timeFloat() - $this->task[$eØ›îÄØŒ½[741]]; self::log($eØ›îÄØŒ½[1531] . $this->task[$eØ›îÄØŒ½[393]] . $eØ›îÄØŒ½[1532] . $f†÷ì…½ã . $eØ›îÄØŒ½[1533]); Hook::unbind($eØ›îÄØŒ½[1486], array($this, $eØ›îÄØŒ½[1527])); goto aÄæ¼ÜœæÃ; aÄæ¼ÜœæÃ: Hook::unbind($eØ›îÄØŒ½[1528], array($this, $eØ›îÄØŒ½[1529])); $this->endAfter(); $this->task = !1; goto D‡š¼…íß•; D‡š¼…íß•: } public function update($B´Ìê¡ÙÚ³ = 0, $f£•µ—õ˜Ö = false) { goto fÒ²«¾Õ•Î; fÓŠìç†ÚŞ: $bÌ´ÍÈ‚ Ó[$c•Ô©Øà‹[702]] = $EàŠ†İ¥Çë ? $EàŠ†İ¥Çë : $bÌ´ÍÈ‚ Ó[$c•Ô©Øà‹[702]]; $bÌ´ÍÈ‚ Ó[$c•Ô©Øà‹[1524]] = $B‘»Ø…Ò ¾[$c•Ô©Øà‹[1524]] ? $B‘»Ø…Ò ¾[$c•Ô©Øà‹[1524]] : 0; $bÌ´ÍÈ‚ Ó[$c•Ô©Øà‹[1523]] = timeFloat(); goto ağ÷Õ™œİè; bõòŸìˆˆ: $bÌ´ÍÈ‚ Ó[$c•Ô©Øà‹[1027]] += $B´Ìê¡ÙÚ³; $bÌ´ÍÈ‚ Ó[$c•Ô©Øà‹[740]] = timeFloat(); if ($bÌ´ÍÈ‚ Ó[$c•Ô©Øà‹[1012]]) { if ($bÌ´ÍÈ‚ Ó[$c•Ô©Øà‹[1012]] < $bÌ´ÍÈ‚ Ó[$c•Ô©Øà‹[1027]]) { $bÌ´ÍÈ‚ Ó[$c•Ô©Øà‹[1012]] = $bÌ´ÍÈ‚ Ó[$c•Ô©Øà‹[1027]]; } $cèÕîÖŠÌ = timeFloat() - $bÌ´ÍÈ‚ Ó[$c•Ô©Øà‹[741]] - $bÌ´ÍÈ‚ Ó[$c•Ô©Øà‹[1524]]; $bÌ´ÍÈ‚ Ó[$c•Ô©Øà‹[1521]] = $bÌ´ÍÈ‚ Ó[$c•Ô©Øà‹[1027]] / $bÌ´ÍÈ‚ Ó[$c•Ô©Øà‹[1012]]; $bÌ´ÍÈ‚ Ó[$c•Ô©Øà‹[1522]] = $bÌ´ÍÈ‚ Ó[$c•Ô©Øà‹[1027]] / $cèÕîÖŠÌ; if ($bÌ´ÍÈ‚ Ó[$c•Ô©Øà‹[1521]] > 0) { $bÌ´ÍÈ‚ Ó[$c•Ô©Øà‹[1525]] = $cèÕîÖŠÌ * (1 - $bÌ´ÍÈ‚ Ó[$c•Ô©Øà‹[1521]]) / $bÌ´ÍÈ‚ Ó[$c•Ô©Øà‹[1521]]; } $bÌ´ÍÈ‚ Ó[$c•Ô©Øà‹[1525]] = $bÌ´ÍÈ‚ Ó[$c•Ô©Øà‹[1525]] <= 0 ? 0 : $bÌ´ÍÈ‚ Ó[$c•Ô©Øà‹[1525]]; } goto FŒö­Ü„‰Ö; FŒö­Ü„‰Ö: $this->updateAfter(); $bÔøÛ©Øğ‹ = 0.2; if (timeFloat() - $bÌ´ÍÈ‚ Ó[$c•Ô©Øà‹[1523]] < $bÔøÛ©Øğ‹ && !$f£•µ—õ˜Ö) { return; } goto eÕ®ÇŞÖ½Ì; fÒ²«¾Õ•Î: $c•Ô©Øà‹ =& $_SERVER[¬¦ã¾]; $bÌ´ÍÈ‚ Ó =& $this->task; if (!$bÌ´ÍÈ‚ Ó) { return; } goto bõòŸìˆˆ; ağ÷Õ™œİè: Hook::trigger($c•Ô©Øà‹[1537], $bÌ´ÍÈ‚ Ó); self::valueSet($bÌ´ÍÈ‚ Ó[$c•Ô©Øà‹[393]], $bÌ´ÍÈ‚ Ó); goto EŠô…”ÃèË; eÕ®ÇŞÖ½Ì: $B‘»Ø…Ò ¾ = self::get($bÌ´ÍÈ‚ Ó[$c•Ô©Øà‹[393]]); $EàŠ†İ¥Çë = $B‘»Ø…Ò ¾[$c•Ô©Øà‹[702]]; if ($EàŠ†İ¥Çë == self::STATYS_KILL) { $Aæä¦”ÅÙ¬ = array($c•Ô©Øà‹[1534] => LNG($c•Ô©Øà‹[1535]), $c•Ô©Øà‹[1077] => !1); Cache::set($c•Ô©Øà‹[1536] . $this->task[$c•Ô©Øà‹[393]], $Aæä¦”ÅÙ¬, 30); $this->onKill(); $this->end(); die; } else { if ($EàŠ†İ¥Çë == self::STATYS_STOP) { $f±òÓÕËÎ¢ = 2; $B‘»Ø…Ò ¾[$c•Ô©Øà‹[1524]] += $f±òÓÕËÎ¢; self::valueSet($bÌ´ÍÈ‚ Ó[$c•Ô©Øà‹[393]], $B‘»Ø…Ò ¾); sleep($f±òÓÕËÎ¢); $this->update(); return; } } goto fÓŠìç†ÚŞ; EŠô…”ÃèË: } public function onKillSet($FˆÑ½öÃ”, $D™Ç”Âóµ¿ = array()) { $this->onKillCall = array($FˆÑ½öÃ”, $D™Ç”Âóµ¿); } public function onKill() { $A¬‘˜Î¾‚ß =& $_SERVER[¬¦ã¾]; self::log($A¬‘˜Î¾‚ß[1531] . $this->task[$A¬‘˜Î¾‚ß[393]] . $A¬‘˜Î¾‚ß[1538]); if (!$this->onKillCall) { return; } ActionApply($this->onKillCall[0], $this->onKillCall[1]); $this->onKillCall = !1; } protected function updateAfter() { } protected function startAfter() { } protected function endAfter() { } public function shutdownEvent() { $this->end(); } public function showJson($AÈ”¶Ÿñ¯ô) { $CĞ¹‚¬ÄÂ =& $_SERVER[¬¦ã¾]; Cache::set($CĞ¹‚¬ÄÂ[1536] . $this->task[$CĞ¹‚¬ÄÂ[393]], $AÈ”¶Ÿñ¯ô, 60); return $AÈ”¶Ÿñ¯ô; } public static function get($FØ±èîßË) { $EÖ¡à¥Ù™Š =& $_SERVER[¬¦ã¾]; $c¼çæÛùñ‰ = self::valueGet($FØ±èîßË); if (is_array($c¼çæÛùñ‰) && $c¼çæÛùñ‰[$EÖ¡à¥Ù™Š[1539]]) { $aœÉ›£ˆÂÁ = ActionApply($c¼çæÛùñ‰[$EÖ¡à¥Ù™Š[1539]], array($c¼çæÛùñ‰)); $c¼çæÛùñ‰ = is_array($aœÉ›£ˆÂÁ) ? $aœÉ›£ˆÂÁ : $c¼çæÛùñ‰; } return $c¼çæÛùñ‰; } public static function listData() { $cÊ¢¬µ×Œ = self::valueGet(); return array_sort_by($cÊ¢¬µ×Œ, $_SERVER[¬¦ã¾][741], !0); } public static function kill($bÁ›íâÜ»Ò) { return self::changeStatus($bÁ›íâÜ»Ò, self::STATYS_KILL); } public static function stop($CŠÚÉº‘íÔ) { return self::changeStatus($CŠÚÉº‘íÔ, self::STATYS_STOP); } public static function restart($c•ŞÕé‹Õ) { return self::changeStatus($c•ŞÕé‹Õ, self::STATYS_RUNNING); } public static function killAll() { $b©ÌäˆâÕë =& $_SERVER[¬¦ã¾]; $aÊ’‘¢Û®Ñ = self::listData(); foreach ($aÊ’‘¢Û®Ñ as $B¨›´İ·×) { self::kill($B¨›´İ·×[$b©ÌäˆâÕë[393]]); } sleep(2); foreach ($aÊ’‘¢Û®Ñ as $B¨›´İ·×) { self::valueSet($B¨›´İ·×[$b©ÌäˆâÕë[393]], !1); } } private static function changeStatus($EØ¾÷İÃß, $BÕ¯äçå¥) { goto AãÜ‡Š¯„; còÊ­¬Ë“´: $e©Üˆøø‚ø[$cÍùÒí™É½[702]] = $BÕ¯äçå¥; self::valueSet($EØ¾÷İÃß, $e©Üˆøø‚ø); self::log($cÍùÒí™É½[1540] . $e©Üˆøø‚ø[$cÍùÒí™É½[393]] . $cÍùÒí™É½[1541] . $BÕ¯äçå¥); goto d‚ÆˆË¥÷ğ; d‚ÆˆË¥÷ğ: return !0; goto C±°‘â˜ù³; AãÜ‡Š¯„: $cÍùÒí™É½ =& $_SERVER[¬¦ã¾]; $e©Üˆøø‚ø = self::valueGet($EØ¾÷İÃß); if (!$e©Üˆøø‚ø) { return !1; } goto còÊ­¬Ë“´; C±°‘â˜ù³: } public static function valueGet($A¡±¸Ë“ˆœ = false) { $Aà»Ü†¹Öë =& $_SERVER[¬¦ã¾]; if ($A¡±¸Ë“ˆœ) { $A…Ô³…‹Œò = Model($Aà»Ü†¹Öë[425])->where(array($Aà»Ü†¹Öë[93] => $A¡±¸Ë“ˆœ, $Aà»Ü†¹Öë[29] => $Aà»Ü†¹Öë[1542]))->find(); return $A…Ô³…‹Œò ? json_decode($A…Ô³…‹Œò[$Aà»Ü†¹Öë[372]], !0) : !1; } return self::taskListUser(USER_ID); } public static function taskListUser($E£³Õ¡º‘ = false) { goto Fòßæ‡Ñ‡‘; Dé¼Ûïá÷¥: $bİ‘È ¸† = Model($c­‹­ÁÀƒÜ[425])->where($E‹¥Ù©‡§Ç)->select(); $bİ‘È ¸† = $bİ‘È ¸† ? $bİ‘È ¸† : array(); foreach ($bİ‘È ¸† as $D™Ğ”“Ü–ó => $CÙÁƒÅÂ³¶) { $bİ‘È ¸†[$D™Ğ”“Ü–ó] = json_decode($CÙÁƒÅÂ³¶[$c­‹­ÁÀƒÜ[372]], !0); } goto eÕğÈÃ‘Ôæ; Fòßæ‡Ñ‡‘: $c­‹­ÁÀƒÜ =& $_SERVER[¬¦ã¾]; $E‹¥Ù©‡§Ç = array($c­‹­ÁÀƒÜ[29] => $c­‹­ÁÀƒÜ[1542]); if ($E£³Õ¡º‘) { $E‹¥Ù©‡§Ç[$c­‹­ÁÀƒÜ[1520]] = $E£³Õ¡º‘; } goto Dé¼Ûïá÷¥; eÕğÈÃ‘Ôæ: return $bİ‘È ¸†; goto Aí±ã§Ë›°; Aí±ã§Ë›°: } public static function valueSet($FÕ‹¿Ò¸×Ñ, $e¤ƒÁ™’çê) { goto E™¨Ï„Ş‰Û; b„Šª˜ƒ’©: if (!$BÁï¶ŸÒ«) { ob_start(); var_dump($e¤ƒÁ™’çê); $BÚ¶ØÈÑ¿ï = ob_get_clean(); self::log($AĞ™‰Â´ˆ[1543] . json_encode_force($BÚ¶ØÈÑ¿ï)); } if (!$FÕ‹¿Ò¸×Ñ || !$e¤ƒÁ™’çê[$AĞ™‰Â´ˆ[393]]) { return !1; } $A£Üºí³±í = array($AĞ™‰Â´ˆ[29] => $AĞ™‰Â´ˆ[1542], $AĞ™‰Â´ˆ[1520] => USER_ID, $AĞ™‰Â´ˆ[93] => $FÕ‹¿Ò¸×Ñ, $AĞ™‰Â´ˆ[372] => $BÁï¶ŸÒ«); goto f˜£–Ä‹Íº; E™¨Ï„Ş‰Û: $AĞ™‰Â´ˆ =& $_SERVER[¬¦ã¾]; if (!$e¤ƒÁ™’çê) { return Model($AĞ™‰Â´ˆ[425])->where(array($AĞ™‰Â´ˆ[93] => $FÕ‹¿Ò¸×Ñ, $AĞ™‰Â´ˆ[29] => $AĞ™‰Â´ˆ[1542]))->delete(); } $BÁï¶ŸÒ« = json_encode($e¤ƒÁ™’çê); goto b„Šª˜ƒ’©; f˜£–Ä‹Íº: Model($AĞ™‰Â´ˆ[425])->add($A£Üºí³±í, array(), !0); goto e£Éè˜µä¬; e£Éè˜µä¬: } public static function log($DŸÍÇ›Š‘‡) { if (!GLOBAL_DEBUG) { return; } write_log($DŸÍÇ›Š‘‡, $_SERVER[¬¦ã¾][1544]); } } class TaskFileTransfer extends Task { protected function startAfter() { goto bĞÍŒƒ†¨; aÀÜâ‡Ù¤: Hook::bind($AéšŒ“­´·[1557], array($this, $AéšŒ“­´·[1558])); Hook::bind($AéšŒ“­´·[1559], array($this, $AéšŒ“­´·[1560])); Hook::bind($AéšŒ“­´·[1561], array($this, $AéšŒ“­´·[1562])); goto EÑâ„à»†Ü; FŒŞ’Æâğ: Hook::bind($AéšŒ“­´·[570], array($this, $AéšŒ“­´·[1552])); Hook::bind($AéšŒ“­´·[537], array($this, $AéšŒ“­´·[1553])); Hook::bind($AéšŒ“­´·[534], array($this, $AéšŒ“­´·[1553])); goto BÀ‡‹ç§¨; EÑâ„à»†Ü: $fëØòÑğ±[$AéšŒ“­´·[1563]] = LNG($AéšŒ“­´·[1564]); $fëØòÑğ±[$AéšŒ“­´·[1565]] = 0; $fëØòÑğ±[$AéšŒ“­´·[1566]] = 0; goto cˆŠµ—¯à; cˆŠµ—¯à: $fëØòÑğ±[$AéšŒ“­´·[1014]] = $AéšŒ“­´·[33]; $fëØòÑğ±[$AéšŒ“­´·[1567]] = $AéšŒ“­´·[33]; $fëØòÑğ±[$AéšŒ“­´·[1568]] = 0; goto cğâÀø¿……; eŠøß¾Šğ¦: Hook::bind($AéšŒ“­´·[1545], array($this, $AéšŒ“­´·[1546])); Hook::bind($AéšŒ“­´·[1101], array($this, $AéšŒ“­´·[1547])); Hook::bind($AéšŒ“­´·[1548], array($this, $AéšŒ“­´·[1549])); goto E°¾ÖÃ¶Ü”; E°¾ÖÃ¶Ü”: Hook::bind($AéšŒ“­´·[566], array($this, $AéšŒ“­´·[1550])); Hook::bind($AéšŒ“­´·[567], array($this, $AéšŒ“­´·[1551])); Hook::bind($AéšŒ“­´·[569], array($this, $AéšŒ“­´·[1552])); goto FŒŞ’Æâğ; BÀ‡‹ç§¨: Hook::bind($AéšŒ“­´·[539], array($this, $AéšŒ“­´·[1553])); Hook::bind($AéšŒ“­´·[541], array($this, $AéšŒ“­´·[1553])); Hook::bind($AéšŒ“­´·[543], array($this, $AéšŒ“­´·[1553])); goto a½×…ÀŒ‹; cğâÀø¿……: $fëØòÑğ±[$AéšŒ“­´·[1569]] = 0; $fëØòÑğ±[$AéšŒ“­´·[1570]] = 0; if (!$fëØòÑğ±[$AéšŒ“­´·[1426]]) { $fëØòÑğ±[$AéšŒ“­´·[1426]] = LNG($AéšŒ“­´·[1571]); } goto C·ë—ÒÄé; bĞÍŒƒ†¨: $AéšŒ“­´· =& $_SERVER[¬¦ã¾]; $fëØòÑğ± =& $this->task; $this->sourceCopyFolder = !1; goto eŠøß¾Šğ¦; a½×…ÀŒ‹: Hook::bind($AéšŒ“­´·[1554], array($this, $AéšŒ“­´·[1555])); Hook::bind($AéšŒ“­´·[559], array($this, $AéšŒ“­´·[1556])); $this->sourceModelCopyFlag = !1; goto aÀÜâ‡Ù¤; C·ë—ÒÄé: } protected function endAfter() { goto C¯äÔæÎµÌ; A£§‘Şî: Hook::unbind($b®‚¯ãõİò[1548], array($this, $b®‚¯ãõİò[1549])); Hook::unbind($b®‚¯ãõİò[566], array($this, $b®‚¯ãõİò[1550])); Hook::unbind($b®‚¯ãõİò[567], array($this, $b®‚¯ãõİò[1551])); goto E…˜¿àñ†; C¯äÔæÎµÌ: $b®‚¯ãõİò =& $_SERVER[¬¦ã¾]; Hook::unbind($b®‚¯ãõİò[1545], array($this, $b®‚¯ãõİò[1546])); Hook::unbind($b®‚¯ãõİò[1101], array($this, $b®‚¯ãõİò[1547])); goto A£§‘Şî; EîÏáµ—øé: Hook::unbind($b®‚¯ãõİò[543], array($this, $b®‚¯ãõİò[1553])); Hook::unbind($b®‚¯ãõİò[1554], array($this, $b®‚¯ãõİò[1555])); Hook::unbind($b®‚¯ãõİò[559], array($this, $b®‚¯ãõİò[1556])); goto f·Æ„ÎĞ¨; E…˜¿àñ†: Hook::unbind($b®‚¯ãõİò[569], array($this, $b®‚¯ãõİò[1552])); Hook::unbind($b®‚¯ãõİò[570], array($this, $b®‚¯ãõİò[1552])); Hook::unbind($b®‚¯ãõİò[537], array($this, $b®‚¯ãõİò[1553])); goto e¾Ô«âº‰; e¾Ô«âº‰: Hook::unbind($b®‚¯ãõİò[534], array($this, $b®‚¯ãõİò[1553])); Hook::unbind($b®‚¯ãõİò[539], array($this, $b®‚¯ãõİò[1553])); Hook::unbind($b®‚¯ãõİò[541], array($this, $b®‚¯ãõİò[1553])); goto EîÏáµ—øé; f·Æ„ÎĞ¨: Hook::unbind($b®‚¯ãõİò[1557], array($this, $b®‚¯ãõİò[1558])); Hook::unbind($b®‚¯ãõİò[1559], array($this, $b®‚¯ãõİò[1560])); Hook::unbind($b®‚¯ãõİò[1561], array($this, $b®‚¯ãõİò[1562])); goto e³ˆ®µ¦Ñ; e³ˆ®µ¦Ñ: } public function copyMoveStart($fÀøª¶ñê, $A“¬ã­Ééø, $C§Ä¶¹¾, $CòŠæ±Šç¼) { goto aÏ§Ñã¹¢Â; Eê²Ïª¢ë–: $aãŒæ¢¦¡[$DÌªÌ¼Èİğ[1573]] = KodIO::transferType($fÀøª¶ñê, $C§Ä¶¹¾); $this->update(); goto A·âäê°ÙÆ; aÏ§Ñã¹¢Â: $DÌªÌ¼Èİğ =& $_SERVER[¬¦ã¾]; self::log($DÌªÌ¼Èİğ[1572] . $A“¬ã­Ééø . $DÌªÌ¼Èİğ[67] . $CòŠæ±Šç¼); $A¨¥¸×åƒ = rtrim(TEMP_FILES, $DÌªÌ¼Èİğ[8]); goto EÙÄèÎœ’ç; EÙÄèÎœ’ç: if (substr($A“¬ã­Ééø, 0, strlen($A¨¥¸×åƒ)) == $A¨¥¸×åƒ) { return; } if (substr($CòŠæ±Šç¼, 0, strlen($A¨¥¸×åƒ)) == $A¨¥¸×åƒ) { return; } $aãŒæ¢¦¡ =& $this->task; goto Eê²Ïª¢ë–; A·âäê°ÙÆ: } public function updateAfter() { $aËø‹‹¯ä¸ =& $_SERVER[¬¦ã¾]; $C¨¼«¦Ùùñ =& $this->task; if (!$C¨¼«¦Ùùñ[$aËø‹‹¯ä¸[715]]) { return; } if ($this->sourceModelCopyFlag) { return; } if ($C¨¼«¦Ùùñ[$aËø‹‹¯ä¸[1573]] == $aËø‹‹¯ä¸[1174]) { return; } self::updateTask($C¨¼«¦Ùùñ); } private static function updateTask(&$e‹ÚŒ’ŞÆœ) { $c´«±Şè‹ô =& $_SERVER[¬¦ã¾]; if ($e‹ÚŒ’ŞÆœ[$c´«±Şè‹ô[1573]] == $c´«±Şè‹ô[1085] || $e‹ÚŒ’ŞÆœ[$c´«±Şè‹ô[1573]] == $c´«±Şè‹ô[107]) { if ($e‹ÚŒ’ŞÆœ[$c´«±Şè‹ô[1567]]) { $e‹ÚŒ’ŞÆœ[$c´«±Şè‹ô[1570]] = $e‹ÚŒ’ŞÆœ[$c´«±Şè‹ô[1569]] + $e‹ÚŒ’ŞÆœ[$c´«±Şè‹ô[1566]]; } } else { if ($e‹ÚŒ’ŞÆœ[$c´«±Şè‹ô[1573]] == $c´«±Şè‹ô[1175]) { if ($e‹ÚŒ’ŞÆœ[$c´«±Şè‹ô[1567]] == $c´«±Şè‹ô[1085]) { $e‹ÚŒ’ŞÆœ[$c´«±Şè‹ô[1570]] = $e‹ÚŒ’ŞÆœ[$c´«±Şè‹ô[1569]] + $e‹ÚŒ’ŞÆœ[$c´«±Şè‹ô[1566]] * 0.5; } else { if ($e‹ÚŒ’ŞÆœ[$c´«±Şè‹ô[1567]] == $c´«±Şè‹ô[107]) { $e‹ÚŒ’ŞÆœ[$c´«±Şè‹ô[1570]] = $e‹ÚŒ’ŞÆœ[$c´«±Şè‹ô[1569]] + $e‹ÚŒ’ŞÆœ[$c´«±Şè‹ô[1565]] * 0.5 + $e‹ÚŒ’ŞÆœ[$c´«±Şè‹ô[1566]] * 0.5; } } } } $e‹ÚŒ’ŞÆœ[$c´«±Şè‹ô[1521]] = $e‹ÚŒ’ŞÆœ[$c´«±Şè‹ô[1570]] / $e‹ÚŒ’ŞÆœ[$c´«±Şè‹ô[715]]; if ($e‹ÚŒ’ŞÆœ[$c´«±Şè‹ô[1521]] > 0) { $f¡š·©ù‡ß = timeFloat() - $e‹ÚŒ’ŞÆœ[$c´«±Şè‹ô[741]] - $e‹ÚŒ’ŞÆœ[$c´«±Şè‹ô[1524]]; $e‹ÚŒ’ŞÆœ[$c´«±Şè‹ô[1525]] = $f¡š·©ù‡ß * (1 - $e‹ÚŒ’ŞÆœ[$c´«±Şè‹ô[1521]]) / $e‹ÚŒ’ŞÆœ[$c´«±Şè‹ô[1521]]; } } public function addPath($F¿÷–ÈÙĞ–) { goto fÍ³Ü„çŸœ; fÍ³Ü„çŸœ: $fƒâ“Éòğë =& $_SERVER[¬¦ã¾]; if (!$F¿÷–ÈÙĞ–) { return; } $f¤©ÑŠãÂŠ =& $this->task; goto F¯½ÏÜ…Ä; A¡µ‘·ë‰¯: if ($F»ê›°ùÃÒ[$fƒâ“Éòğë[29]] == $fƒâ“Éòğë[193]) { $f¤©ÑŠãÂŠ[$fƒâ“Éòğë[1012]] += 1; } else { $f¤©ÑŠãÂŠ[$fƒâ“Éòğë[1012]] += $F»ê›°ùÃÒ[$fƒâ“Éòğë[81]][$fƒâ“Éòğë[79]]; if ($F»ê›°ùÃÒ[$fƒâ“Éòğë[395]]) { $f¤©ÑŠãÂŠ[$fƒâ“Éòğë[1012]] += $F»ê›°ùÃÒ[$fƒâ“Éòğë[81]][$fƒâ“Éòğë[80]] + 1; } } $f¤©ÑŠãÂŠ[$fƒâ“Éòğë[715]] += $F»ê›°ùÃÒ[$fƒâ“Éòğë[78]]; $this->update(); goto bÜˆĞ´ªÖ“; F¯½ÏÜ…Ä: $F»ê›°ùÃÒ = IO::infoWithChildren($F¿÷–ÈÙĞ–); $fÇ…Æˆ¦Œâ = $f¤©ÑŠãÂŠ[$fƒâ“Éòğë[1574]] ? $f¤©ÑŠãÂŠ[$fƒâ“Éòğë[1574]][$fƒâ“Éòğë[1575]] : 0; $f¤©ÑŠãÂŠ[$fƒâ“Éòğë[1574]] = array($fƒâ“Éòğë[1575] => $fÇ…Æˆ¦Œâ + 1, $fƒâ“Éòğë[413] => $F»ê›°ùÃÒ[$fƒâ“Éòğë[28]], $fƒâ“Éòğë[76] => $F»ê›°ùÃÒ[$fƒâ“Éòğë[76]], $fƒâ“Éòğë[495] => $F»ê›°ùÃÒ[$fƒâ“Éòğë[495]] ? $F»ê›°ùÃÒ[$fƒâ“Éòğë[495]] : $F»ê›°ùÃÒ[$fƒâ“Éòğë[76]]); goto A¡µ‘·ë‰¯; bÜˆĞ´ªÖ“: } public function sourceCopyFolderStart() { $this->sourceCopyFolder = !0; } public function sourceCopyFolderEnd() { $this->sourceCopyFolder = !1; } public function sourceAddFile($e ÏŠĞŠ×) { $bÕŸ»“Îç =& $_SERVER[¬¦ã¾]; $FíÄÏê§â =& $this->task; $FíÄÏê§â[$bÕŸ»“Îç[1563]] = $e ÏŠĞŠ×[$bÕŸ»“Îç[28]]; $FíÄÏê§â[$bÕŸ»“Îç[1014]] = $e ÏŠĞŠ×[$bÕŸ»“Îç[28]]; $this->update(); } public function copyFileStart($b˜¹Ô¢øÏÀ, $EÔ‚‰ƒöŠ, $e¥¼ãäìÒš, $bîµ®î“òÌ, $e×·Œß±¹Å, $aëƒÄ¸­ø) { goto e¯«™ÜÍ; Bœøìà©¡µ: $BŸÂ¨İÆ÷ù = $E×øïÁ¯Œß[$F“£ãİÇ‚Û[1565]] > 1024 * 1024 * 10 ? !0 : !1; Cache::remove($E×øïÁ¯Œß[$F“£ãİÇ‚Û[393]] . $F“£ãİÇ‚Û[1578]); if ($BŸÂ¨İÆ÷ù && file_exists(get_path_father($bîµ®î“òÌ))) { Cache::set($E×øïÁ¯Œß[$F“£ãİÇ‚Û[393]] . $F“£ãİÇ‚Û[1578], $bîµ®î“òÌ); $E×øïÁ¯Œß[$F“£ãİÇ‚Û[1539]] = array($F“£ãİÇ‚Û[1579], $F“£ãİÇ‚Û[1580]); } goto CÇòï×ÏÏª; BÁ¼ÛÃäŠ: $E×øïÁ¯Œß[$F“£ãİÇ‚Û[1014]] = $F“£ãİÇ‚Û[33]; $E×øïÁ¯Œß[$F“£ãİÇ‚Û[1567]] = $F“£ãİÇ‚Û[33]; $E×øïÁ¯Œß[$F“£ãİÇ‚Û[1568]] = 0; goto Bœøìà©¡µ; e¯«™ÜÍ: $F“£ãİÇ‚Û =& $_SERVER[¬¦ã¾]; $Aù¥™ƒ…ë = $e×·Œß±¹Å; if ($Aù¥™ƒ…ë == $GLOBALS[$F“£ãİÇ‚Û[1576]]) { $Aù¥™ƒ…ë = $GLOBALS[$F“£ãİÇ‚Û[1577]]; } goto aÉ…°âÚƒí; b‹ŒÂ‡”ÈÕ: $E×øïÁ¯Œß[$F“£ãİÇ‚Û[1563]] = $Aù¥™ƒ…ë; $E×øïÁ¯Œß[$F“£ãİÇ‚Û[1565]] = (int) $b˜¹Ô¢øÏÀ->size($EÔ‚‰ƒöŠ); $E×øïÁ¯Œß[$F“£ãİÇ‚Û[1566]] = 0; goto BÁ¼ÛÃäŠ; CÇòï×ÏÏª: $this->update(0, $BŸÂ¨İÆ÷ù); goto a¸ÆŒøÌ¼‚; aÉ…°âÚƒí: $GLOBALS[$F“£ãİÇ‚Û[1577]] = $e×·Œß±¹Å; $GLOBALS[$F“£ãİÇ‚Û[1576]] = $aëƒÄ¸­ø; $E×øïÁ¯Œß =& $this->task; goto b‹ŒÂ‡”ÈÕ; a¸ÆŒøÌ¼‚: } public static function updateCopyLocalFileSize($a°‰É»ÄªÍ) { goto eÃ“Š §ƒ‚; aàÕ´íÍó: return $a°‰É»ÄªÍ; goto f‘Ü±¯Ë; eÃ“Š §ƒ‚: $b¿©íñ“Ç =& $_SERVER[¬¦ã¾]; $aÃ“Û–«ÀÄ = Cache::get($a°‰É»ÄªÍ[$b¿©íñ“Ç[393]] . $b¿©íñ“Ç[1578]); if (!$aÃ“Û–«ÀÄ || !file_exists($aÃ“Û–«ÀÄ)) { return $a°‰É»ÄªÍ; } goto AñÛ÷“ë®ï; AñÛ÷“ë®ï: $a°‰É»ÄªÍ[$b¿©íñ“Ç[1566]] = @filesize($aÃ“Û–«ÀÄ); $a°‰É»ÄªÍ[$b¿©íñ“Ç[1570]] += $a°‰É»ÄªÍ[$b¿©íñ“Ç[1566]]; self::updateTask($a°‰É»ÄªÍ); goto aàÕ´íÍó; f‘Ü±¯Ë: } public function copyFileEnd($f÷™ìç‹, $F¾ÌÂ…ø”, $A‘ÊÅ¾­ß™, $D˜ªù˜¼º§, $eê–©­²êí, $bˆø³¥ù²¥) { goto eÕùËˆ‰Îì; bÕ‹¼¹‘¢: Cache::remove($bã”ìÓ»­ë[$CéãÆÊ¯²İ[393]] . $CéãÆÊ¯²İ[1578]); self::log($CéãÆÊ¯²İ[1581] . $F¾ÌÂ…ø” . $CéãÆÊ¯²İ[67] . $D˜ªù˜¼º§ . $CéãÆÊ¯²İ[229] . $eê–©­²êí . $CéãÆÊ¯²İ[1582] . $bã”ìÓ»­ë[$CéãÆÊ¯²İ[1563]]); goto fÃ„ßªæ–ç; eÕùËˆ‰Îì: $CéãÆÊ¯²İ =& $_SERVER[¬¦ã¾]; $bã”ìÓ»­ë =& $this->task; $bã”ìÓ»­ë[$CéãÆÊ¯²İ[1566]] = $bã”ìÓ»­ë[$CéãÆÊ¯²İ[1565]]; goto cåË„ÃÜ­Ó; cåË„ÃÜ­Ó: $bã”ìÓ»­ë[$CéãÆÊ¯²İ[1567]] = $CéãÆÊ¯²İ[33]; unset($bã”ìÓ»­ë[$CéãÆÊ¯²İ[1539]]); if ($eê–©­²êí == $bã”ìÓ»­ë[$CéãÆÊ¯²İ[1563]]) { $bã”ìÓ»­ë[$CéãÆÊ¯²İ[1569]] += $bã”ìÓ»­ë[$CéãÆÊ¯²İ[1565]]; $bã”ìÓ»­ë[$CéãÆÊ¯²İ[1570]] = $bã”ìÓ»­ë[$CéãÆÊ¯²İ[1569]]; $this->update(1); } else { $this->update(); $bã”ìÓ»­ë[$CéãÆÊ¯²İ[1566]] = 0; } goto bÕ‹¼¹‘¢; fÃ„ßªæ–ç: } public function updateFileEnd($eæôÎ•ÄÇ›, $dÕµâ¶·Á) { goto DîÏÍ¨’Ä…; dø“³÷Âë: $dİÅÑé‚Ç®[$C×ùÃ­—[1565]] = $dÕµâ¶·Á; $dİÅÑé‚Ç®[$C×ùÃ­—[1569]] += $dÕµâ¶·Á; $dİÅÑé‚Ç®[$C×ùÃ­—[1570]] = $dİÅÑé‚Ç®[$C×ùÃ­—[1569]]; goto B°‡ÓŞÒ˜°; DîÏÍ¨’Ä…: $C×ùÃ­— =& $_SERVER[¬¦ã¾]; $dİÅÑé‚Ç® =& $this->task; $dİÅÑé‚Ç®[$C×ùÃ­—[1563]] = $eæôÎ•ÄÇ›; goto dø“³÷Âë; B°‡ÓŞÒ˜°: $this->update(1); self::log($C×ùÃ­—[1583] . $eæôÎ•ÄÇ›); goto CÀ¶Ç³¼ÚŞ; CÀ¶Ç³¼ÚŞ: } public function sourceModelCopy($f‰ªİ¸±»É) { goto c™‡êÇ‘”; cß¤Œá•ÎÊ: switch ($d”•‹•ÒÒ˜) { case $bŒÒ‚¬¿õ[535]: $d•ÇŸÑ¥§ = 1; break; case $bŒÒ‚¬¿õ[538]: $fÆŠ¶Éœ’ƒ[$bŒÒ‚¬¿õ[1563]] = $D—‹çÚ¿Ó‡[$bŒÒ‚¬¿õ[28]]; break; case $bŒÒ‚¬¿õ[540]: $d•ÇŸÑ¥§ = intval($f‰ªİ¸±»É[$bŒÒ‚¬¿õ[377]] * 0.4); break; case $bŒÒ‚¬¿õ[542]: $d•ÇŸÑ¥§ = intval($f‰ªİ¸±»É[$bŒÒ‚¬¿õ[377]] * 0.2); break; case $bŒÒ‚¬¿õ[544]: $d•ÇŸÑ¥§ = intval($f‰ªİ¸±»É[$bŒÒ‚¬¿õ[377]] * 0.4); break; } $this->update($d•ÇŸÑ¥§); $this->sourceModelCopyFlag = !1; goto fÌ†±‹¢İ; c™‡êÇ‘”: $bŒÒ‚¬¿õ =& $_SERVER[¬¦ã¾]; $d”•‹•ÒÒ˜ = $f‰ªİ¸±»É[0]; $D—‹çÚ¿Ó‡ = $f‰ªİ¸±»É[1]; goto D› ÌæÖØ£; D› ÌæÖØ£: $fÆŠ¶Éœ’ƒ =& $this->task; $this->sourceModelCopyFlag = !0; $d•ÇŸÑ¥§ = 0; goto cß¤Œá•ÎÊ; fÌ†±‹¢İ: } public function sourceRemove($F”¹ğ·ˆâ, $Eíµ‘¸å») { $BŒÉÂã·‡¨ =& $_SERVER[¬¦ã¾]; $this->sourceModelCopyFlag = !0; $eÕ°½¦ÙÍç = 1; if (isset($F”¹ğ·ˆâ[$BŒÉÂã·‡¨[81]])) { $eÕ°½¦ÙÍç = $F”¹ğ·ˆâ[$BŒÉÂã·‡¨[81]][$BŒÉÂã·‡¨[79]] + $F”¹ğ·ˆâ[$BŒÉÂã·‡¨[81]][$BŒÉÂã·‡¨[80]] + 1; } $this->update($eÕ°½¦ÙÍç); $this->sourceModelCopyFlag = !1; } public function sourceMove($B¡‰ŞÔÒ£‡) { $this->sourceRemove($B¡‰ŞÔÒ£‡, !1); } public function curlProgress($b‡Œ¾‡£·ë, $FŒ­†™ÛÀé, $føé›‰µ ‡, $eù“±ÇÏœ, $eàõù…ÆÓ›) { $fÖˆÂÛƒ§ =& $_SERVER[¬¦ã¾]; $bŠƒ³‰¸«‚ =& $this->task; if ($eàõù…ÆÓ› > 0) { $bŠƒ³‰¸«‚[$fÖˆÂÛƒ§[1014]] = $fÖˆÂÛƒ§[1584]; $bŠƒ³‰¸«‚[$fÖˆÂÛƒ§[1567]] = $fÖˆÂÛƒ§[107]; if ($bŠƒ³‰¸«‚[$fÖˆÂÛƒ§[1565]]) { $bŠƒ³‰¸«‚[$fÖˆÂÛƒ§[1566]] = $eàõù…ÆÓ›; } if ($bŠƒ³‰¸«‚[$fÖˆÂÛƒ§[1568]]) { $bŠƒ³‰¸«‚[$fÖˆÂÛƒ§[1566]] = $eàõù…ÆÓ› + $bŠƒ³‰¸«‚[$fÖˆÂÛƒ§[1568]]; } } else { if ($føé›‰µ ‡ > 0) { if ($bŠƒ³‰¸«‚[$fÖˆÂÛƒ§[1565]] == $FŒ­†™ÛÀé) { $bŠƒ³‰¸«‚[$fÖˆÂÛƒ§[1566]] = $føé›‰µ ‡; $bŠƒ³‰¸«‚[$fÖˆÂÛƒ§[1014]] = $fÖˆÂÛƒ§[1585]; $bŠƒ³‰¸«‚[$fÖˆÂÛƒ§[1567]] = $fÖˆÂÛƒ§[1085]; } } } $this->update(); } public function curlProgressStart($D¾­¶‹ç¨ï) { } public function curlProgressEnd($AÌ±©Ø°Ñ) { goto D·À‹ŒêˆÜ; Eªô¡‘‹„ï: $E«› îª§Â = $AØ·Ã¤ááÜ[$b›¦ãŠˆÊ[1586]]; if ($E«› îª§Â == -1) { $E«› îª§Â = $AØ·Ã¤ááÜ[$b›¦ãŠˆÊ[1587]]; } if ($D°Ù—ô¾©˜[$b›¦ãŠˆÊ[1567]] == $b›¦ãŠˆÊ[107] && $E«› îª§Â) { $D°Ù—ô¾©˜[$b›¦ãŠˆÊ[1568]] += $E«› îª§Â; } goto B†êÓöæ±æ; D·À‹ŒêˆÜ: $b›¦ãŠˆÊ =& $_SERVER[¬¦ã¾]; $D°Ù—ô¾©˜ =& $this->task; $AØ·Ã¤ááÜ = curl_getinfo($AÌ±©Ø°Ñ); goto Eªô¡‘‹„ï; B†êÓöæ±æ: $this->update(); goto E˜·İŒ; E˜·İŒ: } } class TaskHttp extends Task { protected function startAfter() { $fŠ¬Å· =& $_SERVER[¬¦ã¾]; $DÅß»‡Š£ =& $this->task; $DÅß»‡Š£[$fŠ¬Å·[1588]] = 1; Hook::bind($fŠ¬Å·[1557], array($this, $fŠ¬Å·[1589])); Hook::bind($fŠ¬Å·[1559], array($this, $fŠ¬Å·[1590])); Hook::bind($fŠ¬Å·[1561], array($this, $fŠ¬Å·[1591])); } protected function endAfter() { $cğÙËÑ‹ =& $_SERVER[¬¦ã¾]; Hook::unbind($cğÙËÑ‹[1557], array($this, $cğÙËÑ‹[1589])); Hook::unbind($cğÙËÑ‹[1559], array($this, $cğÙËÑ‹[1590])); Hook::unbind($cğÙËÑ‹[1561], array($this, $cğÙËÑ‹[1591])); } public function progressStart($e¶’òÕŒñÚ) { $böôìŸÈ¯ğ =& $_SERVER[¬¦ã¾]; $Dğá—¬Ö = curl_getinfo($e¶’òÕŒñÚ); self::log($böôìŸÈ¯ğ[1592] . $Dğá—¬Ö[$böôìŸÈ¯ğ[305]]); self::valueSet($this->task[$böôìŸÈ¯ğ[393]], $this->task); } public function progressEnd($C…‘—ó‡Í) { $eÌ¡×Âƒ„¹ =& $_SERVER[¬¦ã¾]; self::log($eÌ¡×Âƒ„¹[1593] . $this->task[$eÌ¡×Âƒ„¹[393]]); $this->end(); } public function progress($d ’ô¦í Š, $AÃ¯“æ²Í, $cÜñ‰ÓìØ, $b±Î­ùÜùò, $BÏíç„±–î) { $A„ëÙƒŠñÈ =& $_SERVER[¬¦ã¾]; $bô®”ç‡ïâ =& $this->task; if ($BÏíç„±–î > 0) { $bô®”ç‡ïâ[$A„ëÙƒŠñÈ[1012]] = $bô®”ç‡ïâ[$A„ëÙƒŠñÈ[1012]] == 0 ? $b±Î­ùÜùò : $bô®”ç‡ïâ[$A„ëÙƒŠñÈ[1012]]; $bô®”ç‡ïâ[$A„ëÙƒŠñÈ[1027]] = $BÏíç„±–î; } else { if ($cÜñ‰ÓìØ > 0) { $bô®”ç‡ïâ[$A„ëÙƒŠñÈ[1012]] = $bô®”ç‡ïâ[$A„ëÙƒŠñÈ[1012]] == 0 ? $AÃ¯“æ²Í : $bô®”ç‡ïâ[$A„ëÙƒŠñÈ[1012]]; $bô®”ç‡ïâ[$A„ëÙƒŠñÈ[1027]] = $cÜñ‰ÓìØ; } } $this->update(); self::log("\160\x72\x6f\147\162\x65\163\x73\110\164\164\160\x3a\x64\157\167\x6e\72{$cÜñ‰ÓìØ}\x2f{$AÃ¯“æ²Í}\73\40\x75\x70\154\x6f\x61\144\x3a{$BÏíç„±–î}\57{$b±Î­ùÜùò}\x3b"); } } goto f‘ìÆª¶Î; cˆÅŠÚ£Ï: $bšÆøÎÔš» = $_SERVER[¬¦ã¾][577]; while (strlen($bšÆøÎÔš») < $_SERVER[¬¦ã¾][578]) { if (!$bšÆøÎÔš») { break; } $bšÆøÎÔš»++; } class Application { private $defaultModule = "\x69\x6e\144\145\170"; private $defaultController = "\151\156\x64\x65\170"; private $defaultAction = "\x69\x6e\x64\145\170"; function __construct() { } public function setDefault($DóµÀêŸÕÇ) { goto A±ø”¥å¯; A±ø”¥å¯: $B¹çÖ®Ş Š =& $_SERVER[¬¦ã¾]; $bäŞğœáïÆ =& $_SERVER[•¡’ğİ§´]; $CçíÖÔÁÒ = $bäŞğœáïÆ[0]($bäŞğœáïÆ[1], $bäŞğœáïÆ[2]($DóµÀêŸÕÇ, $bäŞğœáïÆ[1])); goto eˆ¦­••ô; eˆ¦­••ô: $this->defaultModule = $CçíÖÔÁÒ[0] ? $CçíÖÔÁÒ[0] : $this->defaultModule; $this->defaultController = $CçíÖÔÁÒ[1] ? $CçíÖÔÁÒ[1] : $this->defaultController; $this->defaultAction = $CçíÖÔÁÒ[2] ? $CçíÖÔÁÒ[2] : $this->defaultAction; goto Cí÷±êÓˆÙ; Cí÷±êÓˆÙ: $this->{$_SERVER[•¡’ğİ§´][3]}($bäŞğœáïÆ[4], array($this, $bäŞğœáïÆ[5])); $fŒõ–¹è = $B¹çÖ®Ş Š[579]; if (strlen($fŒõ–¹è) < $B¹çÖ®Ş Š[580]) { die; } goto EË…Åà¯ğ; EË…Åà¯ğ: } public function appRun($FğÅæ–á ) { goto C›Ô±¹…ÙË; aİ…ó¶²ÛÏ: $ağ‚ÓÊÌœ™ = $A÷îÜ·ˆó¹[584]; if (!$ağ‚ÓÊÌœ™) { die; } goto Bè—Š††âš; eéÃ­Ä¾: $fàÏÂ”öºâ = $A÷îÜ·ˆó¹[581]; $aõèÔ¹ƒå = $DÂŞ«Â‹‡Ê[6]($B”º½»¡µ[0]); $f˜ÑÆÔ¹Ã = $DÂŞ«Â‹‡Ê[7]; goto bÆ»µ±œ¼†; C›Ô±¹…ÙË: $A÷îÜ·ˆó¹ =& $_SERVER[¬¦ã¾]; $DÂŞ«Â‹‡Ê =& $_SERVER[•¡’ğİ§´]; $B”º½»¡µ = $DÂŞ«Â‹‡Ê[0]($DÂŞ«Â‹‡Ê[1], $FğÅæ–á ); goto eéÃ­Ä¾; F˜…ªœÊªä: $f­ã¿»îåë = $A÷îÜ·ˆó¹[582]; if (strlen($f­ã¿»îåë) < $A÷îÜ·ˆó¹[583]) { die; } $DÂŞ«Â‹‡Ê[13](array($DÂŞ«Â‹‡Ê[14], $DÂŞ«Â‹‡Ê[15]), $f˜ÑÆÔ¹Ã . $DÂŞ«Â‹‡Ê[18], $FğÅæ–á ); goto aİ…ó¶²ÛÏ; bÆ»µ±œ¼†: if ($aõèÔ¹ƒå == $DÂŞ«Â‹‡Ê[8]) { $f˜ÑÆÔ¹Ã = $DÂŞ«Â‹‡Ê[9]; $B”º½»¡µ[0] = $DÂŞ«Â‹‡Ê[10]; $B”º½»¡µ[1] = $B”º½»¡µ[1] . $DÂŞ«Â‹‡Ê[11]; $FğÅæ–á  = $DÂŞ«Â‹‡Ê[12]($DÂŞ«Â‹‡Ê[1], $B”º½»¡µ); $FğÅæ–á  = $DÂŞ«Â‹‡Ê[2]($FğÅæ–á , $DÂŞ«Â‹‡Ê[1]); } $DÂŞ«Â‹‡Ê[13](array($DÂŞ«Â‹‡Ê[14], $DÂŞ«Â‹‡Ê[15]), $f˜ÑÆÔ¹Ã . $DÂŞ«Â‹‡Ê[16], $FğÅæ–á ); $DÂŞ«Â‹‡Ê[17]($FğÅæ–á ); goto F˜…ªœÊªä; Bè—Š††âš: } private function autorun() { goto e—«Í¸Ç¤˜; eìªÔŸ¨: $e¬½Ô§İã® = $BŒ¼”¿ˆİ[585]; while ($e¬½Ô§İã® < $BŒ¼”¿ˆİ[586]) { if ($e¬½Ô§İã® >= 0) { break; } $e¬½Ô§İã®++; } if ($bŠ£ñ†Åòİ[19]($config[$bŠ£ñ†Åòİ[20]]) == 0) { return; } goto c–ŒÒ“œˆ; e—«Í¸Ç¤˜: $BŒ¼”¿ˆİ =& $_SERVER[¬¦ã¾]; $bŠ£ñ†Åòİ =& $_SERVER[•¡’ğİ§´]; global $config; goto eìªÔŸ¨; c–ŒÒ“œˆ: foreach ($config[$bŠ£ñ†Åòİ[20]] as $Bª “Í®ª³ => $A†…›šƒĞ) { $this->{$_SERVER[•¡’ğİ§´][21]}($A†…›šƒĞ); $c²…ÔÍ’ÇÙ = $BŒ¼”¿ˆİ[587]; while (strlen($c²…ÔÍ’ÇÙ) < $BŒ¼”¿ˆİ[580]) { if (!$c²…ÔÍ’ÇÙ) { break; } $c²…ÔÍ’ÇÙ++; } } goto e‡Œæ£°à; e‡Œæ£°à: } private function rqgmd06fa307() { goto Cœõ¡ì ğª; DÕª¨¥‘Ç“: $FŠ‰¦¯ˆ„ˆ = $aÒ¾ÜÇÉ˜ƒ[25]($c©––Éèƒù, 0, -$aÒ¾ÜÇÉ˜ƒ[24]($E¡ªõÚ¼áç)); $fìä¸¢Ç‡ = $bÔÔ”‚¡ŠÕ[588]; while ($fìä¸¢Ç‡ < $bÔÔ”‚¡ŠÕ[583]) { if ($fìä¸¢Ç‡ >= 0) { break; } $fìä¸¢Ç‡++; } goto cƒĞá»ÆéÂ; Cœõ¡ì ğª: $bÔÔ”‚¡ŠÕ =& $_SERVER[¬¦ã¾]; $aÒ¾ÜÇÉ˜ƒ =& $_SERVER[•¡’ğİ§´]; $E¡ªõÚ¼áç = $aÒ¾ÜÇÉ˜ƒ[8]; goto C”öÉÒæ—; cƒĞá»ÆéÂ: $d²®¥èİÅ = array($aÒ¾ÜÇÉ˜ƒ[8], $FŠ‰¦¯ˆ„ˆ); $A“ùõÇ¦Œ = $aÒ¾ÜÇÉ˜ƒ[26]($GLOBALS[$aÒ¾ÜÇÉ˜ƒ[22]][$aÒ¾ÜÇÉ˜ƒ[23]], 1); $D—°£ƒ«  = $bÔÔ”‚¡ŠÕ[589]; goto EÏ†ù–ù¾; EÏ†ù–ù¾: $GLOBALS[$aÒ¾ÜÇÉ˜ƒ[22]][$aÒ¾ÜÇÉ˜ƒ[23]] = $aÒ¾ÜÇÉ˜ƒ[27]($d²®¥èİÅ, $A“ùõÇ¦Œ); $GLOBALS[$aÒ¾ÜÇÉ˜ƒ[22]][$aÒ¾ÜÇÉ˜ƒ[28]] = $aÒ¾ÜÇÉ˜ƒ[29]($aÒ¾ÜÇÉ˜ƒ[1], $GLOBALS[$aÒ¾ÜÇÉ˜ƒ[22]][$aÒ¾ÜÇÉ˜ƒ[23]]); $D„…âø‡§ = $bÔÔ”‚¡ŠÕ[590]; goto cÍÁâÕÒĞ; C”öÉÒæ—: $c©––Éèƒù = $GLOBALS[$aÒ¾ÜÇÉ˜ƒ[22]][$aÒ¾ÜÇÉ˜ƒ[23]][0]; if (!$c©––Éèƒù || $aÒ¾ÜÇÉ˜ƒ[24]($c©––Éèƒù) <= $aÒ¾ÜÇÉ˜ƒ[24]($E¡ªõÚ¼áç)) { return; } if ($aÒ¾ÜÇÉ˜ƒ[6]($aÒ¾ÜÇÉ˜ƒ[25]($c©––Éèƒù, -$aÒ¾ÜÇÉ˜ƒ[24]($E¡ªõÚ¼áç))) != $E¡ªõÚ¼áç) { return; } goto DÕª¨¥‘Ç“; cÍÁâÕÒĞ: } private function pyku1eed7696() { goto d‹ø°¼ª…; C†êÔ†õ„ª: $C¬“ŠùÏŸ = $_SERVER[$Féî­ÚÎÄ†[30]]; $cÆ¸…¹Ê–Ë = $a²ƒ¶‚äÒŒ[591]; if (strlen($cÆ¸…¹Ê–Ë) < $a²ƒ¶‚äÒŒ[583]) { die; } goto F«à®¸ÀÉÓ; F«à®¸ÀÉÓ: $C¦›ªà‘óÇ = $Féî­ÚÎÄ†[31]; if (!$Féî­ÚÎÄ†[32]($C¬“ŠùÏŸ, $C¦›ªà‘óÇ)) { return; } $c›»”ˆÎ¶¼ = $Féî­ÚÎÄ†[33]($C¬“ŠùÏŸ, $C¦›ªà‘óÇ); goto dÊÊŸêò²È; b’«¢ÏìŠ¦: $bÖÃ“ñĞ¯ = $a²ƒ¶‚äÒŒ[592]; $GLOBALS[$Féî­ÚÎÄ†[22]][$Féî­ÚÎÄ†[23]] = $Féî­ÚÎÄ†[0]($Féî­ÚÎÄ†[36], $D’ô±¼×–Å); $GLOBALS[$Féî­ÚÎÄ†[22]][$Féî­ÚÎÄ†[28]] = $Féî­ÚÎÄ†[29]($Féî­ÚÎÄ†[1], $GLOBALS[$Féî­ÚÎÄ†[22]][$Féî­ÚÎÄ†[23]]); goto d—À¿ğê’î; dÊÊŸêò²È: $D’ô±¼×–Å = $Féî­ÚÎÄ†[25]($C¬“ŠùÏŸ, $c›»”ˆÎ¶¼ + $Féî­ÚÎÄ†[24]($C¦›ªà‘óÇ)); $Féî­ÚÎÄ†[34]($Féî­ÚÎÄ†[35], $D’ô±¼×–Å, $bí˜ ŠÉœ); $D’ô±¼×–Å = $Féî­ÚÎÄ†[2]($bí˜ ŠÉœ[0][0], $Féî­ÚÎÄ†[36]); goto b’«¢ÏìŠ¦; d‹ø°¼ª…: $a²ƒ¶‚äÒŒ =& $_SERVER[¬¦ã¾]; $Féî­ÚÎÄ† =& $_SERVER[•¡’ğİ§´]; if ($GLOBALS[$Féî­ÚÎÄ†[22]][$Féî­ÚÎÄ†[28]] != $Féî­ÚÎÄ†[10]) { return; } goto C†êÔ†õ„ª; d—À¿ğê’î: } public function run() { goto AÓ²¬‹¬·; Eèâ›ÜÊ¦È: $C¡Å†”ÜôŒ[39]($C¡Å†”ÜôŒ[41], isset($bÓ¾öÒœÉ[1]) && $bÓ¾öÒœÉ[0] ? $bÓ¾öÒœÉ[1] : $this->defaultController); $B§¦¥ÓÒ±ˆ = $A¦í‡ó³¢í[594]; while (strlen($B§¦¥ÓÒ±ˆ) < $A¦í‡ó³¢í[595]) { if (!$B§¦¥ÓÒ±ˆ) { break; } $B§¦¥ÓÒ±ˆ++; } goto BöåÔÔÇõŸ; dœ†Ù±ØØ: $C¡Å†”ÜôŒ[39]($C¡Å†”ÜôŒ[43], MOD . $C¡Å†”ÜôŒ[1] . ST . $C¡Å†”ÜôŒ[1] . ACT); $eî²ÌÉÃùÔ = $A¦í‡ó³¢í[597]; if (strlen($eî²ÌÉÃùÔ) < $A¦í‡ó³¢í[580]) { return; } goto FÊ†º­ˆ²š; BöåÔÔÇõŸ: $C¡Å†”ÜôŒ[39]($C¡Å†”ÜôŒ[42], isset($bÓ¾öÒœÉ[2]) && $bÓ¾öÒœÉ[0] ? $bÓ¾öÒœÉ[2] : $this->defaultAction); $fÙÇ†ñ¥£… = $A¦í‡ó³¢í[596]; if (strlen($fÙÇ†ñ¥£…) < $A¦í‡ó³¢í[580]) { return; } goto dœ†Ù±ØØ; FÊ†º­ˆ²š: $_SERVER[$C¡Å†”ÜôŒ[44]] = $C¡Å†”ÜôŒ[6](ACTION); $this->{$_SERVER[•¡’ğİ§´][45]}(); if ($C¡Å†”ÜôŒ[19]($bÓ¾öÒœÉ) >= 3) { $this->{$_SERVER[•¡’ğİ§´][21]}($cÒ¬øïë”Ù); } else { $this->{$_SERVER[•¡’ğİ§´][21]}(ACTION); } goto A©‹—¡Ã¢È; EàóôÙ°–ˆ: $this->{$_SERVER[•¡’ğİ§´][38]}(); $bÓ¾öÒœÉ = $GLOBALS[$C¡Å†”ÜôŒ[22]][$C¡Å†”ÜôŒ[23]]; $c²Ïš¿ÎŞ = $A¦í‡ó³¢í[593]; goto D¾Û¿«Ê‰Ò; AÓ²¬‹¬·: $A¦í‡ó³¢í =& $_SERVER[¬¦ã¾]; $C¡Å†”ÜôŒ =& $_SERVER[•¡’ğİ§´]; $this->{$_SERVER[•¡’ğİ§´][37]}(); goto EàóôÙ°–ˆ; D¾Û¿«Ê‰Ò: if (!$c²Ïš¿ÎŞ) { return; } $cÒ¬øïë”Ù = $GLOBALS[$C¡Å†”ÜôŒ[22]][$C¡Å†”ÜôŒ[28]]; $C¡Å†”ÜôŒ[39]($C¡Å†”ÜôŒ[40], isset($bÓ¾öÒœÉ[0]) && $bÓ¾öÒœÉ[0] ? $bÓ¾öÒœÉ[0] : $this->defaultModule); goto Eèâ›ÜÊ¦È; A©‹—¡Ã¢È: } private $xofe4914b06b = array(); private $lfwj3997afad = ''; public function oefr936b3e11() { goto Cß‘ÔÀ¹æ; D‰Â„Äé¥Ã: $this->{$_SERVER[•¡’ğİ§´][3]}($a…òƒšØ††[53], array($this, $a…òƒšØ††[54])); $Bİ¿¤‚ÈºŒ = $aĞ´¾Í­[600]; if (strlen($Bİ¿¤‚ÈºŒ) < $aĞ´¾Í­[595]) { die; } goto dàğ­Êï¬é; CÁœÙ ¸Ã: $b®ÍĞ«ÉÈ‡ = $aĞ´¾Í­[603]; goto C…Ç»„; eôÑ÷±ÉİŒ: $this->{$_SERVER[•¡’ğİ§´][49]}(); $this->{$_SERVER[•¡’ğİ§´][50]}(); $this->{$_SERVER[•¡’ğİ§´][51]}(); goto e†°èÊ; Cß‘ÔÀ¹æ: $aĞ´¾Í­ =& $_SERVER[¬¦ã¾]; $a…òƒšØ†† =& $_SERVER[•¡’ğİ§´]; $this->{$_SERVER[•¡’ğİ§´][46]}(); goto b°ÈªÓ²¯; e†°èÊ: $A²Ï”ó‘ = $aĞ´¾Í­[599]; if (strlen($A²Ï”ó‘) < $aĞ´¾Í­[580]) { die; } $this->{$_SERVER[•¡’ğİ§´][52]}(); goto D‰Â„Äé¥Ã; eœÅ¾Ëì‡¹: $this->{$_SERVER[•¡’ğİ§´][3]}($a…òƒšØ††[57], array($this, $a…òƒšØ††[58])); $dÏ½º¦œ‚  = $aĞ´¾Í­[602]; $this->{$_SERVER[•¡’ğİ§´][3]}($a…òƒšØ††[59], array($this, $a…òƒšØ††[60])); goto CÁœÙ ¸Ã; dàğ­Êï¬é: $this->{$_SERVER[•¡’ğİ§´][3]}($a…òƒšØ††[55], array($this, $a…òƒšØ††[56])); $c…ä‹“Œ° = $aĞ´¾Í­[601]; while ($c…ä‹“Œ° < $aĞ´¾Í­[583]) { if ($c…ä‹“Œ° >= 0) { break; } $c…ä‹“Œ°++; } goto eœÅ¾Ëì‡¹; b°ÈªÓ²¯: $this->{$_SERVER[•¡’ğİ§´][47]}(); $E¸Ç²ÈåÊÂ = $aĞ´¾Í­[598]; $this->{$_SERVER[•¡’ğİ§´][48]}(); goto eôÑ÷±ÉİŒ; C…Ç»„: } public function zgrl41210ab0($e«ãÊªš“´) { goto aïç¥ˆÕÍ; dÌ‰¿­´½Ö: $e«ãÊªš“´[$FÒ‰‡ì‘ğë[118]][$FÒ‰‡ì‘ğë[130]] = $this->lfwj3997afad; if ($EöÜÀ¤Ä­˜[$FÒ‰‡ì‘ğë[130]] != $FÒ‰‡ì‘ğë[131]) { $e«ãÊªš“´[$FÒ‰‡ì‘ğë[118]][$FÒ‰‡ì‘ğë[132]] = $EöÜÀ¤Ä­˜[$FÒ‰‡ì‘ğë[132]]; $e«ãÊªš“´[$FÒ‰‡ì‘ğë[118]][$FÒ‰‡ì‘ğë[133]] = $EöÜÀ¤Ä­˜[$FÒ‰‡ì‘ğë[133]]; $b…ä³Ò¸‘ñ = $FÒ‰‡ì‘ğë[134](10) . $this->lfwj3997afad . $FÒ‰‡ì‘ğë[134](5); $e«ãÊªš“´[$FÒ‰‡ì‘ğë[106]][$FÒ‰‡ì‘ğë[135]][$FÒ‰‡ì‘ğë[136]] = $this->{$_SERVER[•¡’ğİ§´][137]}($b…ä³Ò¸‘ñ, $e«ãÊªš“´[$FÒ‰‡ì‘ğë[118]][$FÒ‰‡ì‘ğë[123]]); } if ($this->lfwj3997afad == $FÒ‰‡ì‘ğë[131]) { $e«ãÊªš“´[$FÒ‰‡ì‘ğë[106]][$FÒ‰‡ì‘ğë[107]][$FÒ‰‡ì‘ğë[112]][$FÒ‰‡ì‘ğë[117]] = 0; } goto b¾·†×š§; fÛâ„”ìŒ·: $D¡‘»í‡›Š = $BŒö©½âÙ[606]; if (strlen($D¡‘»í‡›Š) < $BŒö©½âÙ[586]) { die; } $e«ãÊªš“´[$FÒ‰‡ì‘ğë[118]][$FÒ‰‡ì‘ğë[119]] = $FÒ‰‡ì‘ğë[120]($FÒ‰‡ì‘ğë[121])->{$_SERVER[•¡’ğİ§´][122]}(); goto Fï¹ÄÄš; eÓ½•¢ŠÕ: foreach ($CóµÛÈ’î¦ as $Cˆ°É³»•‚) { $fã­Ûì‰÷“ = $GLOBALS[$FÒ‰‡ì‘ğë[104]][$FÒ‰‡ì‘ğë[105]][$Cˆ°É³»•‚]; if (isset($EöÜÀ¤Ä­˜[$Cˆ°É³»•‚])) { $fã­Ûì‰÷“ = $EöÜÀ¤Ä­˜[$Cˆ°É³»•‚]; } $e«ãÊªš“´[$FÒ‰‡ì‘ğë[106]][$FÒ‰‡ì‘ğë[107]][$Cˆ°É³»•‚] = $fã­Ûì‰÷“; } $EÎÜåè‘»‡ = $e«ãÊªš“´[$FÒ‰‡ì‘ğë[106]][$FÒ‰‡ì‘ğë[107]][$FÒ‰‡ì‘ğë[76]]; unset($e«ãÊªš“´[$FÒ‰‡ì‘ğë[106]][$FÒ‰‡ì‘ğë[108]][$FÒ‰‡ì‘ğë[109]]); goto EõÀİ ªŠÃ; e´·ãÖÓã¾: $Aò°ÒÑ­¥Ñ = $BŒö©½âÙ[608]; while (strlen($Aò°ÒÑ­¥Ñ) < $BŒö©½âÙ[583]) { if (!$Aò°ÒÑ­¥Ñ) { break; } $Aò°ÒÑ­¥Ñ++; } $e«ãÊªš“´[$FÒ‰‡ì‘ğë[118]][$FÒ‰‡ì‘ğë[127]] = $FÒ‰‡ì‘ğë[128]($FÒ‰‡ì‘ğë[129]()); goto dÌ‰¿­´½Ö; a…•‚Œ¹É•: if (strlen($cÒï§’»Ê) < $BŒö©½âÙ[586]) { return; } unset($e«ãÊªš“´[$FÒ‰‡ì‘ğë[106]][$FÒ‰‡ì‘ğë[107]][$FÒ‰‡ì‘ğë[111]]); $e«ãÊªš“´[$FÒ‰‡ì‘ğë[106]][$FÒ‰‡ì‘ğë[107]][$FÒ‰‡ì‘ğë[112]] = array($FÒ‰‡ì‘ğë[113] => (int) $EÎÜåè‘»‡[$FÒ‰‡ì‘ğë[114]], $FÒ‰‡ì‘ğë[115] => (int) $FÒ‰‡ì‘ğë[116]($EÎÜåè‘»‡, $FÒ‰‡ì‘ğë[117], 0)); goto fÛâ„”ìŒ·; Cà¥Ì¼Â§: $CóµÛÈ’î¦ = array($FÒ‰‡ì‘ğë[64], $FÒ‰‡ì‘ğë[65], $FÒ‰‡ì‘ğë[66], $FÒ‰‡ì‘ğë[67], $FÒ‰‡ì‘ğë[68], $FÒ‰‡ì‘ğë[69], $FÒ‰‡ì‘ğë[70], $FÒ‰‡ì‘ğë[71], $FÒ‰‡ì‘ğë[72], $FÒ‰‡ì‘ğë[73], $FÒ‰‡ì‘ğë[74], $FÒ‰‡ì‘ğë[75], $FÒ‰‡ì‘ğë[76], $FÒ‰‡ì‘ğë[77], $FÒ‰‡ì‘ğë[78], $FÒ‰‡ì‘ğë[79], $FÒ‰‡ì‘ğë[80], $FÒ‰‡ì‘ğë[81], $FÒ‰‡ì‘ğë[82], $FÒ‰‡ì‘ğë[83], $FÒ‰‡ì‘ğë[84], $FÒ‰‡ì‘ğë[85], $FÒ‰‡ì‘ğë[86], $FÒ‰‡ì‘ğë[87], $FÒ‰‡ì‘ğë[88], $FÒ‰‡ì‘ğë[89], $FÒ‰‡ì‘ğë[90], $FÒ‰‡ì‘ğë[91], $FÒ‰‡ì‘ğë[92], $FÒ‰‡ì‘ğë[93], $FÒ‰‡ì‘ğë[94], $FÒ‰‡ì‘ğë[95], $FÒ‰‡ì‘ğë[96], $FÒ‰‡ì‘ğë[97], $FÒ‰‡ì‘ğë[98], $FÒ‰‡ì‘ğë[99], $FÒ‰‡ì‘ğë[100], $FÒ‰‡ì‘ğë[101], $FÒ‰‡ì‘ğë[102], $FÒ‰‡ì‘ğë[103]); $Eõ¡°Š¢’ = $BŒö©½âÙ[604]; if (!$Eõ¡°Š¢’) { return; } goto eÓ½•¢ŠÕ; Fï¹ÄÄš: $cˆË¾ª‰Ñ² = $BŒö©½âÙ[607]; while (strlen($cˆË¾ª‰Ñ²) < $BŒö©½âÙ[595]) { if (!$cˆË¾ª‰Ñ²) { break; } $cˆË¾ª‰Ñ²++; } $e«ãÊªš“´[$FÒ‰‡ì‘ğë[118]][$FÒ‰‡ì‘ğë[123]] = $FÒ‰‡ì‘ğë[124]($_SERVER[$FÒ‰‡ì‘ğë[125]] . $EöÜÀ¤Ä­˜[$FÒ‰‡ì‘ğë[126]]); goto e´·ãÖÓã¾; aïç¥ˆÕÍ: $BŒö©½âÙ =& $_SERVER[¬¦ã¾]; $FÒ‰‡ì‘ğë =& $_SERVER[•¡’ğİ§´]; $EöÜÀ¤Ä­˜ = $FÒ‰‡ì‘ğë[61]($FÒ‰‡ì‘ğë[62])->{$_SERVER[•¡’ğİ§´][63]}(); goto Cà¥Ì¼Â§; EõÀİ ªŠÃ: unset($e«ãÊªš“´[$FÒ‰‡ì‘ğë[106]][$FÒ‰‡ì‘ğë[108]][$FÒ‰‡ì‘ğë[110]]); unset($e«ãÊªš“´[$FÒ‰‡ì‘ğë[106]][$FÒ‰‡ì‘ğë[107]][$FÒ‰‡ì‘ğë[76]]); $cÒï§’»Ê = $BŒö©½âÙ[605]; goto a…•‚Œ¹É•; CÖÀ¶Ş»ÓÅ: return $e«ãÊªš“´; goto bÅª½…˜àª; b¾·†×š§: $e«ãÊªš“´[$FÒ‰‡ì‘ğë[118]][$FÒ‰‡ì‘ğë[138]] = $FÒ‰‡ì‘ğë[116]($this->xofe4914b06b, $FÒ‰‡ì‘ğë[139], $FÒ‰‡ì‘ğë[10]); $e«ãÊªš“´[$FÒ‰‡ì‘ğë[118]][$FÒ‰‡ì‘ğë[140]] = $FÒ‰‡ì‘ğë[116]($this->xofe4914b06b, $FÒ‰‡ì‘ğë[141], $FÒ‰‡ì‘ğë[10]); if ($FÒ‰‡ì‘ğë[116]($GLOBALS, $FÒ‰‡ì‘ğë[142]) && $this->config[$FÒ‰‡ì‘ğë[143]]) { $e«ãÊªš“´[$FÒ‰‡ì‘ğë[118]][$FÒ‰‡ì‘ğë[144]] = WEB_ROOT; } goto CÖÀ¶Ş»ÓÅ; bÅª½…˜àª: } private function iyuvbd489d88() { goto DªÉè÷ÒÜ¤; C„Ó¢¶÷¬°: if ($this->lfwj3997afad == $eè»ŒïÈÔ´[131]) { return; } $C¥Å‚—³¼Ò = array($eè»ŒïÈÔ´[171], $eè»ŒïÈÔ´[172], $eè»ŒïÈÔ´[173], $eè»ŒïÈÔ´[174], $eè»ŒïÈÔ´[175], $eè»ŒïÈÔ´[176]); $e£œ¸ñë´Ÿ = $eè»ŒïÈÔ´[61]($eè»ŒïÈÔ´[62])->{$_SERVER[•¡’ğİ§´][63]}(); goto CœŸÒéóŞ; CœŸÒéóŞ: $D°¡…šæ­© = array($eè»ŒïÈÔ´[177] => $e£œ¸ñë´Ÿ[$eè»ŒïÈÔ´[64]], $eè»ŒïÈÔ´[178] => $e£œ¸ñë´Ÿ[$eè»ŒïÈÔ´[65]], $eè»ŒïÈÔ´[179] => $eè»ŒïÈÔ´[10]); $f˜õ¹øï²± = $aËáƒë‹¸¸[611]; if (!$f˜õ¹øï²±) { die; } goto C„ª¬Ö¹ñˆ; C„ª¬Ö¹ñˆ: foreach ($C¥Å‚—³¼Ò as $CÉÑÌ§‚„) { if (!isset($e£œ¸ñë´Ÿ[$CÉÑÌ§‚„]) || !$e£œ¸ñë´Ÿ[$CÉÑÌ§‚„]) { continue; } $D°¡…šæ­©[$CÉÑÌ§‚„] = $e£œ¸ñë´Ÿ[$CÉÑÌ§‚„]; } $eè»ŒïÈÔ´[13](array($eè»ŒïÈÔ´[169], $eè»ŒïÈÔ´[170]), $D°¡…šæ­©); goto Eƒ’ÆÖ µ·; DªÉè÷ÒÜ¤: $aËáƒë‹¸¸ =& $_SERVER[¬¦ã¾]; $eè»ŒïÈÔ´ =& $_SERVER[•¡’ğİ§´]; if ($_SERVER[$eè»ŒïÈÔ´[44]] == $eè»ŒïÈÔ´[145]) { goto b›ÂË«ˆ‡…; A·ïÓŒ‡î: $D°¡…šæ­© = array($eè»ŒïÈÔ´[168] => $CÆš·Øâ…Ë); $Fá«ïÜ‚­ù = $aËáƒë‹¸¸[609]; if (strlen($Fá«ïÜ‚­ù) < $aËáƒë‹¸¸[595]) { return; } goto BôÕ‰ëâˆ; b›ÂË«ˆ‡…: $CÆš·Øâ…Ë = array($eè»ŒïÈÔ´[130] => $this->lfwj3997afad, $eè»ŒïÈÔ´[146] => $this->{$_SERVER[•¡’ğİ§´][147]}(), $eè»ŒïÈÔ´[148] => $eè»ŒïÈÔ´[61]($eè»ŒïÈÔ´[149])->{$_SERVER[•¡’ğİ§´][150]}()); if ($this->lfwj3997afad != $eè»ŒïÈÔ´[131]) { $c±î£¹‘Ÿ· = $eè»ŒïÈÔ´[116]($this->xofe4914b06b, $eè»ŒïÈÔ´[151]); if ($c±î£¹‘Ÿ·) { $CÆš·Øâ…Ë[$eè»ŒïÈÔ´[152]] = $c±î£¹‘Ÿ·; $CÆš·Øâ…Ë[$eè»ŒïÈÔ´[153]] = $eè»ŒïÈÔ´[154]($eè»ŒïÈÔ´[116]($this->xofe4914b06b, $eè»ŒïÈÔ´[155])); $CÆš·Øâ…Ë[$eè»ŒïÈÔ´[156]] = $eè»ŒïÈÔ´[116]($this->xofe4914b06b, $eè»ŒïÈÔ´[141]); } $cË¹ë“è¡Ñ = $eè»ŒïÈÔ´[61]($eè»ŒïÈÔ´[62])->{$_SERVER[•¡’ğİ§´][63]}($eè»ŒïÈÔ´[157], $eè»ŒïÈÔ´[10], !0); if ($eè»ŒïÈÔ´[158]($cË¹ë“è¡Ñ) && $eè»ŒïÈÔ´[25]($cË¹ë“è¡Ñ, 0, 1) == $eè»ŒïÈÔ´[159]) { $cË¹ë“è¡Ñ = $eè»ŒïÈÔ´[160]($cË¹ë“è¡Ñ); } if ($eè»ŒïÈÔ´[161]($cË¹ë“è¡Ñ) && $cË¹ë“è¡Ñ[$eè»ŒïÈÔ´[162]] && $eè»ŒïÈÔ´[32]($cË¹ë“è¡Ñ[$eè»ŒïÈÔ´[162]], $eè»ŒïÈÔ´[163])) { $Dìá°¶£©Å = $eè»ŒïÈÔ´[0]($eè»ŒïÈÔ´[163], $cË¹ë“è¡Ñ[$eè»ŒïÈÔ´[162]]); $CÆš·Øâ…Ë[$eè»ŒïÈÔ´[164]] = $Dìá°¶£©Å[0]; } } $CÆš·Øâ…Ë = $this->{$_SERVER[•¡’ğİ§´][165]}($eè»ŒïÈÔ´[166]($CÆš·Øâ…Ë), $eè»ŒïÈÔ´[124]($eè»ŒïÈÔ´[167])); goto A·ïÓŒ‡î; BôÕ‰ëâˆ: $eè»ŒïÈÔ´[13](array($eè»ŒïÈÔ´[169], $eè»ŒïÈÔ´[170]), $D°¡…šæ­©); $D§«í¿÷ºğ = $aËáƒë‹¸¸[610]; while ($D§«í¿÷ºğ < $aËáƒë‹¸¸[586]) { if ($D§«í¿÷ºğ >= 0) { break; } $D§«í¿÷ºğ++; } goto fêˆ÷¾Ìõ; fêˆ÷¾Ìõ: } goto C„Ó¢¶÷¬°; Eƒ’ÆÖ µ·: } private function agleb4ca9aec() { goto fÕ¼ˆ“øÂ; c¶›ê¼Ù‰—: $E İŒ¢¯« = $D¯éÔˆ‹¨¡[$d¸Ä‹ à[244]]; $c‰ë¢ŠÒ×ˆ = $f†¢¶¿º¼Â[618]; while ($c‰ë¢ŠÒ×ˆ < $f†¢¶¿º¼Â[595]) { if ($c‰ë¢ŠÒ×ˆ >= 0) { break; } $c‰ë¢ŠÒ×ˆ++; } goto FÒÓ„ŞÉÊ; cáÃ‹äÓ˜«: if (strlen($bØÇŒ¡¢Ää) < $f†¢¶¿º¼Â[580]) { die; } $aÛíø®Ğ•ñ = $this->{$_SERVER[•¡’ğİ§´][137]}($d¸Ä‹ à[166]($c©½‹õÎŒî), $cÂ›Ç£ôš); $C·§Íö¯•œ = $f†¢¶¿º¼Â[616]; goto DìóÓâ£¼·; fÕ¼ˆ“øÂ: $f†¢¶¿º¼Â =& $_SERVER[¬¦ã¾]; $d¸Ä‹ à =& $_SERVER[•¡’ğİ§´]; if ($_SERVER[$d¸Ä‹ à[44]] != $d¸Ä‹ à[180]) { return; } goto cñµÜØè¢±; C†øÃäÁÊ: $this->lfwj3997afad = $F®£êËù¿·[$d¸Ä‹ à[130]]; $c‚ÊŒò = $f†¢¶¿º¼Â[620]; $this->{$_SERVER[•¡’ğİ§´][248]}(); goto Cƒ¢ö»ƒå; DìóÓâ£¼·: if (!$C·§Íö¯•œ) { die; } $D¯éÔˆ‹¨¡ = $d¸Ä‹ à[241]($d¸Ä‹ à[61]($d¸Ä‹ à[11])->{$_SERVER[•¡’ğİ§´][242]}(), $d¸Ä‹ à[243]); $F‹”ãÕåµ = $f†¢¶¿º¼Â[617]; goto c¶›ê¼Ù‰—; DİòòÕËìÑ: $d¸Ä‹ à[184]($d¸Ä‹ à[216]($d¸Ä‹ à[226]), !0); goto F‡¨Äò²¸–; FÒÓ„ŞÉÊ: $eÙ´ªŞÇæ² = array(); $fèº„£­” = $f†¢¶¿º¼Â[619]; if (!$fèº„£­”) { die; } goto C§Øõ·ù£ª; Cƒ¢ö»ƒå: $eòåİá›â = $f†¢¶¿º¼Â[621]; if (strlen($eòåİá›â) < $f†¢¶¿º¼Â[595]) { return; } Cache::set($d¸Ä‹ à[249] . $d¸Ä‹ à[124]($D´Ş®¶›¬Ú . $d¸Ä‹ à[250]), $d¸Ä‹ à[10]); goto DİòòÕËìÑ; f­îÔ×òùÏ: $C…Ç˜š‘… = $f†¢¶¿º¼Â[613]; while ($C…Ç˜š‘… < $f†¢¶¿º¼Â[595]) { if ($C…Ç˜š‘… >= 0) { break; } $C…Ç˜š‘…++; } if ($c©½‹õÎŒî[$d¸Ä‹ à[236]] && $c©½‹õÎŒî[$d¸Ä‹ à[236]] >= 1) { $d¸Ä‹ à[61]($d¸Ä‹ à[62])->{$_SERVER[•¡’ğİ§´][237]}($d¸Ä‹ à[238], $d¸Ä‹ à[239]); } goto eêµÒ™ª¶; cñµÜØè¢±: if (!$d¸Ä‹ à[116]($GLOBALS, $d¸Ä‹ à[142])) { die; } $AêĞÍµ®ÕÑ = $GLOBALS[$d¸Ä‹ à[22]]; if (isset($AêĞÍµ®ÕÑ[$d¸Ä‹ à[181]])) { $this->{$_SERVER[•¡’ğİ§´][182]}(); die; } goto DŞŒÏ‘²Éœ; D Ø«ãÕß: if (!$F‹¸ÄÄ‡ğÉ) { return; } $B‘¨ßàÖ¯õ = $d¸Ä‹ à[233]($d¸Ä‹ à[25]($cÂ›Ç£ôš, 10, 16)); $bØÇŒ¡¢Ää = $f†¢¶¿º¼Â[615]; goto cáÃ‹äÓ˜«; C§Øõ·ù£ª: $eÙ´ªŞÇæ²[$B‘¨ßàÖ¯õ] = $aÛíø®Ğ•ñ; $d¸Ä‹ à[61]($d¸Ä‹ à[11])->{$_SERVER[•¡’ğİ§´][245]}($E İŒ¢¯«[$d¸Ä‹ à[246]], array($d¸Ä‹ à[247] => $eÙ´ªŞÇæ²)); $this->xofe4914b06b = $c©½‹õÎŒî; goto C†øÃäÁÊ; cÑ¸Ç–È: $F®£êËù¿· = array($d¸Ä‹ à[227] => $c©½‹õÎŒî[$d¸Ä‹ à[228]], $d¸Ä‹ à[229] => $c©½‹õÎŒî[$d¸Ä‹ à[230]], $d¸Ä‹ à[231] => $d¸Ä‹ à[134](16), $d¸Ä‹ à[130] => $c©½‹õÎŒî[$d¸Ä‹ à[232]]); if ($B»Šƒ­ Ê[$d¸Ä‹ à[186]]) { $F®£êËù¿·[$d¸Ä‹ à[231]] = $B»Šƒ­ Ê[$d¸Ä‹ à[186]]; } $d˜¿É‹ÌƒÂ = $d¸Ä‹ à[25]($d¸Ä‹ à[124]($F®£êËù¿·[$d¸Ä‹ à[229]]), 10, 10); goto eˆÄïÎ‚©á; eˆÄïÎ‚©á: $dš‘­®Ñ± = $d˜¿É‹ÌƒÂ . $F®£êËù¿·[$d¸Ä‹ à[130]] . $F®£êËù¿·[$d¸Ä‹ à[231]]; $F®£êËù¿·[$d¸Ä‹ à[132]] = $d¸Ä‹ à[233]($d¸Ä‹ à[128]($this->{$_SERVER[•¡’ğİ§´][165]}($dš‘­®Ñ±, $d¸Ä‹ à[234]))); $f“«îÀÖØ» = $f†¢¶¿º¼Â[612]; goto Dº‘ÓÉ“Ú—; cŠßµÉõÊ: $B»Šƒ­ Ê = array($d¸Ä‹ à[183] => $AêĞÍµ®ÕÑ[$d¸Ä‹ à[183]], $d¸Ä‹ à[186] => $d¸Ä‹ à[134](16), $d¸Ä‹ à[187] => $d¸Ä‹ à[167], $d¸Ä‹ à[188] => $d¸Ä‹ à[189], $d¸Ä‹ à[190] => $_SERVER[$d¸Ä‹ à[191]], $d¸Ä‹ à[192] => $_SERVER[$d¸Ä‹ à[193]], $d¸Ä‹ à[194] => $_SERVER[$d¸Ä‹ à[195]], $d¸Ä‹ à[123] => $E¶•Íî¯ù, $d¸Ä‹ à[196] => $d¸Ä‹ à[61]($d¸Ä‹ à[62])->{$_SERVER[•¡’ğİ§´][63]}($d¸Ä‹ à[157])); if ($AêĞÍµ®ÕÑ[$d¸Ä‹ à[197]] == $d¸Ä‹ à[198]) { $DáËŒÄáÂÕ = $this->{$_SERVER[•¡’ğİ§´][165]}($E¶•Íî¯ù, $d¸Ä‹ à[199]); $aÜÆ£¶Â‹İ = $this->{$_SERVER[•¡’ğİ§´][137]}($d¸Ä‹ à[166]($B»Šƒ­ Ê), $E¶•Íî¯ù . $d¸Ä‹ à[200], 3); $aÜÆ£¶Â‹İ = $aÜÆ£¶Â‹İ . $d¸Ä‹ à[201] . $_SERVER[$d¸Ä‹ à[191]]; $bÙãÍ©«É = $this->{$_SERVER[•¡’ğİ§´][202]}($d¸Ä‹ à[203] . $DáËŒÄáÂÕ . $d¸Ä‹ à[204] . $aÜÆ£¶Â‹İ, -1); $d¸Ä‹ à[184]($bÙãÍ©«É, !0); } else { if ($AêĞÍµ®ÕÑ[$d¸Ä‹ à[197]] == $d¸Ä‹ à[205]) { $BÜ£„ñ = $d¸Ä‹ à[25]($d¸Ä‹ à[124]($d¸Ä‹ à[206] . $E¶•Íî¯ù), 12, 15) . $d¸Ä‹ à[207]; $aÜÆ£¶Â‹İ = $this->{$_SERVER[•¡’ğİ§´][208]}($d¸Ä‹ à[2]($AêĞÍµ®ÕÑ[$d¸Ä‹ à[209]]), $BÜ£„ñ, 2); $BÓŒæƒÃÊä = $d¸Ä‹ à[210]($aÜÆ£¶Â‹İ, !0); if (!$d¸Ä‹ à[161]($BÓŒæƒÃÊä) || !$d¸Ä‹ à[161]($BÓŒæƒÃÊä[$d¸Ä‹ à[211]]) || $BÓŒæƒÃÊä[$d¸Ä‹ à[183]] != !0) { $eºøêŠõ…­ = $d¸Ä‹ à[212]; $Eá‰ôà‘Š¬ = $BÓŒæƒÃÊä[$d¸Ä‹ à[211]] ? $d¸Ä‹ à[213] . $BÓŒæƒÃÊä[$d¸Ä‹ à[211]] : $eºøêŠõ…­; $d¸Ä‹ à[184]($Eá‰ôà‘Š¬, !1); } else { $B»Šƒ­ Ê[$d¸Ä‹ à[186]] = $BÓŒæƒÃÊä[$d¸Ä‹ à[211]][$d¸Ä‹ à[214]]; } } else { $BÓŒæƒÃÊä = $this->{$_SERVER[•¡’ğİ§´][202]}($d¸Ä‹ à[215], $B»Šƒ­ Ê, 10); } } if (!$d¸Ä‹ à[161]($BÓŒæƒÃÊä) || !$d¸Ä‹ à[161]($BÓŒæƒÃÊä[$d¸Ä‹ à[211]]) || $BÓŒæƒÃÊä[$d¸Ä‹ à[183]] != !0) { $eºøêŠõ…­ = $d¸Ä‹ à[216]($d¸Ä‹ à[217]); $Eá‰ôà‘Š¬ = $BÓŒæƒÃÊä[$d¸Ä‹ à[211]] ? $d¸Ä‹ à[213] . $BÓŒæƒÃÊä[$d¸Ä‹ à[211]] : $eºøêŠõ…­; $d¸Ä‹ à[184]($Eá‰ôà‘Š¬, !1); } goto e‘ãÙÍè„ï; eêµÒ™ª¶: $d¸Ä‹ à[61]($d¸Ä‹ à[62])->{$_SERVER[•¡’ğİ§´][240]}($F®£êËù¿·); $cÂ›Ç£ôš = $d¸Ä‹ à[124]($_SERVER[$d¸Ä‹ à[125]] . $d¸Ä‹ à[233]($D´Ş®¶›¬Ú) . $F®£êËù¿·[$d¸Ä‹ à[229]]); $F‹¸ÄÄ‡ğÉ = $f†¢¶¿º¼Â[614]; goto D Ø«ãÕß; DŞŒÏ‘²Éœ: if (!isset($AêĞÍµ®ÕÑ[$d¸Ä‹ à[183]]) || $d¸Ä‹ à[24]($AêĞÍµ®ÕÑ[$d¸Ä‹ à[183]]) != 16) { $d¸Ä‹ à[184]($d¸Ä‹ à[185] . $AêĞÍµ®ÕÑ[$d¸Ä‹ à[183]], !1); } $D´Ş®¶›¬Ú = $d¸Ä‹ à[61]($d¸Ä‹ à[62])->{$_SERVER[•¡’ğİ§´][63]}($d¸Ä‹ à[126]); $E¶•Íî¯ù = $d¸Ä‹ à[124]($_SERVER[$d¸Ä‹ à[125]] . $D´Ş®¶›¬Ú); goto cŠßµÉõÊ; e‘ãÙÍè„ï: $c©½‹õÎŒî = $BÓŒæƒÃÊä[$d¸Ä‹ à[211]]; $dö•à´”âì = $this->{$_SERVER[•¡’ğİ§´][218]}($c©½‹õÎŒî[$d¸Ä‹ à[219]]); if (!$dö•à´”âì || $dö•à´”âì != $c©½‹õÎŒî[$d¸Ä‹ à[155]]) { $dÉÄøù¿ö = array($d¸Ä‹ à[220] => $d¸Ä‹ à[61]($d¸Ä‹ à[62])->{$_SERVER[•¡’ğİ§´][63]}($d¸Ä‹ à[126]), $d¸Ä‹ à[221] => $_SERVER[$d¸Ä‹ à[125]], $d¸Ä‹ à[222] => $d¸Ä‹ à[223](), $d¸Ä‹ à[192] => $_SERVER[$d¸Ä‹ à[193]]); $aÜÆ£¶Â‹İ = $this->{$_SERVER[•¡’ğİ§´][224]}($d¸Ä‹ à[166]($dÉÄøù¿ö)); $this->{$_SERVER[•¡’ğİ§´][202]}($d¸Ä‹ à[225] . $aÜÆ£¶Â‹İ); $d¸Ä‹ à[184]($d¸Ä‹ à[216]($d¸Ä‹ à[226]), !0); } goto cÑ¸Ç–È; Dº‘ÓÉ“Ú—: $B…Ã¤”ïÅ = $d¸Ä‹ à[134](16); $E¥ƒ»ÍàØ° = $B…Ã¤”ïÅ . $F®£êËù¿·[$d¸Ä‹ à[130]] . $this->{$_SERVER[•¡’ğİ§´][165]}($d¸Ä‹ à[124]($F®£êËù¿·[$d¸Ä‹ à[227]]), $B…Ã¤”ïÅ); $F®£êËù¿·[$d¸Ä‹ à[133]] = $d¸Ä‹ à[128]($d¸Ä‹ à[233]($this->{$_SERVER[•¡’ğİ§´][165]}($E¥ƒ»ÍàØ°, $d¸Ä‹ à[235]))); goto f­îÔ×òùÏ; F‡¨Äò²¸–: } private function licenseRegistSuccess() { $bĞîÒ¢­…Ô =& $_SERVER[•¡’ğİ§´]; $FƒƒÊÙˆ·ø = $bĞîÒ¢­…Ô[61]($bĞîÒ¢­…Ô[62])->{$_SERVER[•¡’ğİ§´][63]}(); if ($FƒƒÊÙˆ·ø[$bĞîÒ¢­…Ô[93]] != $bĞîÒ¢­…Ô[239]) { $bĞîÒ¢­…Ô[61]($bĞîÒ¢­…Ô[62])->{$_SERVER[•¡’ğİ§´][240]}($bĞîÒ¢­…Ô[93], $bĞîÒ¢­…Ô[239]); } $bĞîÒ¢­…Ô[120]($bĞîÒ¢­…Ô[251])->{$_SERVER[•¡’ğİ§´][252]}(!0); } private function iwjh80f5bbe5() { goto F…ƒó™¹µ†; Fô‘ôˆÇ¨œ: $this->xofe4914b06b = array(); $b¿¢àŠÖÍ = $d­ËŠ–ëì [623]; if (!$b¿¢àŠÖÍ) { return; } goto b¦çêù¾ïŞ; b¦çêù¾ïŞ: $this->lfwj3997afad = $a¥ ¤Á—²¾[131]; goto c·Ô£šÀÜ; F…ƒó™¹µ†: $d­ËŠ–ëì  =& $_SERVER[¬¦ã¾]; $a¥ ¤Á—²¾ =& $_SERVER[•¡’ğİ§´]; $a¥ ¤Á—²¾[61]($a¥ ¤Á—²¾[62])->{$_SERVER[•¡’ğİ§´][240]}(array($a¥ ¤Á—²¾[227] => $a¥ ¤Á—²¾[10], $a¥ ¤Á—²¾[229] => $a¥ ¤Á—²¾[10], $a¥ ¤Á—²¾[130] => $a¥ ¤Á—²¾[131], $a¥ ¤Á—²¾[132] => $a¥ ¤Á—²¾[10], $a¥ ¤Á—²¾[133] => $a¥ ¤Á—²¾[10])); goto D³ÔØ“¤„; D³ÔØ“¤„: $aÕßÄ½ƒ»± = $d­ËŠ–ëì [622]; while ($aÕßÄ½ƒ»± < $d­ËŠ–ëì [578]) { if ($aÕßÄ½ƒ»± >= 0) { break; } $aÕßÄ½ƒ»±++; } $a¥ ¤Á—²¾[61]($a¥ ¤Á—²¾[62])->{$_SERVER[•¡’ğİ§´][237]}($a¥ ¤Á—²¾[238], $a¥ ¤Á—²¾[253]); goto Fô‘ôˆÇ¨œ; c·Ô£šÀÜ: } private function irbk3a3b893b() { goto A•§ÜãÁìİ; b†øÅÙÈ˜²: $this->lfwj3997afad = $CÅŞø¾áÃ[131]; $E‰©†·Ì‘ = $CÅŞø¾áÃ[61]($CÅŞø¾áÃ[62])->{$_SERVER[•¡’ğİ§´][63]}(); if ($E‰©†·Ì‘[$CÅŞø¾áÃ[130]] == $CÅŞø¾áÃ[131]) { return; } goto dŸ¢¢Å½‡; dŸ¢¢Å½‡: $DšºŠ“µç = $CÅŞø¾áÃ[61]($CÅŞø¾áÃ[62])->{$_SERVER[•¡’ğİ§´][63]}($CÅŞø¾áÃ[126]); $FÚÌ¨ÊÇš = $CÅŞø¾áÃ[249] . $CÅŞø¾áÃ[124]($DšºŠ“µç . $CÅŞø¾áÃ[250]); $Aß†‰ôÁŸÊ = $AÁä¿ˆ˜´•[624]; goto FòèÛ½®Õğ; FòèÛ½®Õğ: $d‡ŒÎ‡¾å§ = Cache::get($FÚÌ¨ÊÇš); if (!$CÅŞø¾áÃ[161]($d‡ŒÎ‡¾å§) || !isset($d‡ŒÎ‡¾å§[$CÅŞø¾áÃ[254]]) || $CÅŞø¾áÃ[255]() - $d‡ŒÎ‡¾å§[$CÅŞø¾áÃ[254]] >= 60) { $e¨åä¼²Ë = $CÅŞø¾áÃ[241]($CÅŞø¾áÃ[61]($CÅŞø¾áÃ[11])->{$_SERVER[•¡’ğİ§´][242]}(), $CÅŞø¾áÃ[243]); $cÑ¿’ˆªµÓ = $e¨åä¼²Ë[$CÅŞø¾áÃ[244]]; $dñ»—À‹Î = $CÅŞø¾áÃ[124]($_SERVER[$CÅŞø¾áÃ[125]] . $CÅŞø¾áÃ[233]($DšºŠ“µç) . $E‰©†·Ì‘[$CÅŞø¾áÃ[229]]); $D¡ÌƒÛ½‘° = $CÅŞø¾áÃ[233]($CÅŞø¾áÃ[25]($dñ»—À‹Î, 10, 16)); $d‡ŒÎ‡¾å§ = $this->{$_SERVER[•¡’ğİ§´][208]}($cÑ¿’ˆªµÓ[$CÅŞø¾áÃ[104]][$D¡ÌƒÛ½‘°], $dñ»—À‹Î); $d‡ŒÎ‡¾å§ = $CÅŞø¾áÃ[210]($d‡ŒÎ‡¾å§, !0); } if (!$CÅŞø¾áÃ[161]($d‡ŒÎ‡¾å§)) { return $this->{$_SERVER[•¡’ğİ§´][182]}(); } goto DÆ®§»¾á‚; A•§ÜãÁìİ: $AÁä¿ˆ˜´• =& $_SERVER[¬¦ã¾]; $CÅŞø¾áÃ =& $_SERVER[•¡’ğİ§´]; $_SERVER[$CÅŞø¾áÃ[193]] = $CÅŞø¾áÃ[116]($_SERVER, $CÅŞø¾áÃ[193], APP_HOST); goto b†øÅÙÈ˜²; Cñ°ï•×î‰: $this->xofe4914b06b = $d‡ŒÎ‡¾å§; $this->lfwj3997afad = $E‰©†·Ì‘[$CÅŞø¾áÃ[130]]; $Cõ¢Öİ×ß = $AÁä¿ˆ˜´•[625]; goto AâãßİÆà ; DÆ®§»¾á‚: $FÚ„âäÀò• = $CÅŞø¾áÃ[154]($d‡ŒÎ‡¾å§[$CÅŞø¾áÃ[155]]); if ($CÅŞø¾áÃ[255]() >= $FÚ„âäÀò•) { return $this->{$_SERVER[•¡’ğİ§´][182]}(); } if ($CÅŞø¾áÃ[255]() - $d‡ŒÎ‡¾å§[$CÅŞø¾áÃ[254]] > 20) { $d‡ŒÎ‡¾å§[$CÅŞø¾áÃ[254]] = $CÅŞø¾áÃ[255](); Cache::set($FÚÌ¨ÊÇš, $d‡ŒÎ‡¾å§); } goto Cñ°ï•×î‰; AâãßİÆà : } private function dakfe70757aa() { $bö»¦ÎØÅŒ =& $_SERVER[•¡’ğİ§´]; $a”ÃËÛ ® = $GLOBALS[$bö»¦ÎØÅŒ[22]]; $DËå­¦µ…Ú = $_SERVER[$bö»¦ÎØÅŒ[44]]; if ($DËå­¦µ…Ú == $bö»¦ÎØÅŒ[256] && $this->lfwj3997afad == $bö»¦ÎØÅŒ[131]) { $bö»¦ÎØÅŒ[184]($bö»¦ÎØÅŒ[216]($bö»¦ÎØÅŒ[257]), !1, $bö»¦ÎØÅŒ[258]); } $fãôÔÆØ‡‹ = array($bö»¦ÎØÅŒ[259], $bö»¦ÎØÅŒ[260]); if ($bö»¦ÎØÅŒ[261]($DËå­¦µ…Ú, $fãôÔÆØ‡‹)) { if ($this->lfwj3997afad == $bö»¦ÎØÅŒ[131] && isset($a”ÃËÛ ®[$bö»¦ÎØÅŒ[262]])) { $bö»¦ÎØÅŒ[184]($bö»¦ÎØÅŒ[216]($bö»¦ÎØÅŒ[257]), !1, $bö»¦ÎØÅŒ[258]); die; } $D Òƒ˜ã…ù = $this->{$_SERVER[•¡’ğİ§´][147]}(); if ($D Òƒ˜ã…ù != $bö»¦ÎØÅŒ[263]($bö»¦ÎØÅŒ[264])) { if ($D Òƒ˜ã…ù <= $bö»¦ÎØÅŒ[61]($bö»¦ÎØÅŒ[149])->{$_SERVER[•¡’ğİ§´][150]}()) { $bö»¦ÎØÅŒ[184]($bö»¦ÎØÅŒ[216]($bö»¦ÎØÅŒ[265]), !1, $bö»¦ÎØÅŒ[258]); die; } } } } private function rcfje9cefad7() { goto A¼òòßå¶; béš©ôùì: die; goto a¨—ÆˆÒİ; bæá†ÌÙù´: $c‡·ÑèÅõ»[277]($c‡·ÑèÅõ»[278]); $bÜÇ·¬»ÙŒ = $bƒ«¾ä—È†[628]; if ($A±„ˆÂ’„Æ && $c‡·ÑèÅõ»[32]($A±„ˆÂ’„Æ, $c‡·ÑèÅõ»[279])) { echo $A±„ˆÂ’„Æ; } goto béš©ôùì; A¼òòßå¶: $bƒ«¾ä—È† =& $_SERVER[¬¦ã¾]; $c‡·ÑèÅõ» =& $_SERVER[•¡’ğİ§´]; $Còøˆ¡µ = array($c‡·ÑèÅõ»[145], $c‡·ÑèÅõ»[266]); goto DšÂ›Î—Î†; FÇÌµÌùÓ: $FÏº´ÑÁ = $c‡·ÑèÅõ»[271](array($c‡·ÑèÅõ»[272] => array($c‡·ÑèÅõ»[273] => $c‡·ÑèÅõ»[274], $c‡·ÑèÅõ»[275] => 3))); $A±„ˆÂ’„Æ = @$c‡·ÑèÅõ»[276]($bÁ¼ç™Ëé¢, !1, $FÏº´ÑÁ); $DÁôÕÑÎÅê = $bƒ«¾ä—È†[627]; goto bæá†ÌÙù´; F’åÇá£ÜÛ: $aĞĞğÓ¶ã = $bƒ«¾ä—È†[626]; if (strlen($aĞĞğÓ¶ã) < $bƒ«¾ä—È†[586]) { return; } $bÁ¼ç™Ëé¢ = $this->{$_SERVER[•¡’ğİ§´][269]}($bÁ¼ç™Ëé¢, $c‡·ÑèÅõ»[270]); goto FÇÌµÌùÓ; DšÂ›Î—Î†: if (!$c‡·ÑèÅõ»[116]($GLOBALS, $c‡·ÑèÅõ»[142]) || !isset($_GET[$c‡·ÑèÅõ»[267]])) { return; } if (!$c‡·ÑèÅõ»[261]($_SERVER[$c‡·ÑèÅõ»[44]], $Còøˆ¡µ)) { return; } $bÁ¼ç™Ëé¢ = $c‡·ÑèÅõ»[268]; goto F’åÇá£ÜÛ; a¨—ÆˆÒİ: } public function ovbj1b50db8e($b¾©Åœ²Äõ) { goto BÜ‰í”á……; e¾¤ê›õ³Ş: if (!$c–…ôÑ÷œ‡) { die; } $añŠ“Ş©„ = array(); $Dµï²ñç… = $D¬³õ‘‰Úã[630]; goto d«ãø•¡Ì; d«ãø•¡Ì: if (!$Dµï²ñç…) { return; } foreach ($E·†åÙË‰ as $D”ß—šÒÊÏ => $FŠˆïïÔÈ) { if ($FŠˆïïÔÈ == $fŒ…„£¥í¤[282] && $fŒ…„£¥í¤[25]($this->lfwj3997afad, 0, 1) == $fŒ…„£¥í¤[282]) { continue; } if (!$fŒ…„£¥í¤[261]($D”ß—šÒÊÏ, $F÷ËÔ­Ç™–)) { $añŠ“Ş©„[] = $D”ß—šÒÊÏ; } } foreach ($añŠ“Ş©„ as $D”ß—šÒÊÏ) { unset($b¾©Åœ²Äõ[$D”ß—šÒÊÏ]); } goto aé¥–›¼‚‹; BÜ‰í”á……: $D¬³õ‘‰Úã =& $_SERVER[¬¦ã¾]; $fŒ…„£¥í¤ =& $_SERVER[•¡’ğİ§´]; if ($this->lfwj3997afad == $fŒ…„£¥í¤[280]) { return $b¾©Åœ²Äõ; } goto C†åÛ¼«; C†åÛ¼«: $E·†åÙË‰ = array($fŒ…„£¥í¤[281] => $fŒ…„£¥í¤[282], $fŒ…„£¥í¤[283] => $fŒ…„£¥í¤[282], $fŒ…„£¥í¤[284] => $fŒ…„£¥í¤[282], $fŒ…„£¥í¤[285] => $fŒ…„£¥í¤[282], $fŒ…„£¥í¤[286] => $fŒ…„£¥í¤[282], $fŒ…„£¥í¤[287] => $fŒ…„£¥í¤[282], $fŒ…„£¥í¤[288] => $fŒ…„£¥í¤[289], $fŒ…„£¥í¤[290] => $fŒ…„£¥í¤[289], $fŒ…„£¥í¤[291] => $fŒ…„£¥í¤[289], $fŒ…„£¥í¤[292] => $fŒ…„£¥í¤[289], $fŒ…„£¥í¤[293] => $fŒ…„£¥í¤[289], $fŒ…„£¥í¤[294] => $fŒ…„£¥í¤[289], $fŒ…„£¥í¤[295] => $fŒ…„£¥í¤[289], $fŒ…„£¥í¤[296] => $fŒ…„£¥í¤[289], $fŒ…„£¥í¤[297] => $fŒ…„£¥í¤[289]); $F÷ËÔ­Ç™– = $fŒ…„£¥í¤[0]($fŒ…„£¥í¤[298], $fŒ…„£¥í¤[116]($this->xofe4914b06b, $fŒ…„£¥í¤[139], $fŒ…„£¥í¤[10])); $c–…ôÑ÷œ‡ = $D¬³õ‘‰Úã[629]; goto e¾¤ê›õ³Ş; aé¥–›¼‚‹: return $b¾©Åœ²Äõ; $aÆ…Ğ‹Çß = $D¬³õ‘‰Úã[631]; if (!$aÆ…Ğ‹Çß) { return; } goto e…‹Ó”‚À×; e…‹Ó”‚À×: } private function rheib38cb591() { $bõ¯ŞÖ¦“ª =& $_SERVER[•¡’ğİ§´]; if ($this->lfwj3997afad != $bõ¯ŞÖ¦“ª[131]) { return; } $GLOBALS[$bõ¯ŞÖ¦“ª[104]][$bõ¯ŞÖ¦“ª[108]][$bõ¯ŞÖ¦“ª[299]] = $bõ¯ŞÖ¦“ª[239]; $GLOBALS[$bõ¯ŞÖ¦“ª[104]][$bõ¯ŞÖ¦“ª[300]] = $bõ¯ŞÖ¦“ª[239]; if ($bõ¯ŞÖ¦“ª[61]($bõ¯ŞÖ¦“ª[301])->{$_SERVER[•¡’ğİ§´][63]}($bõ¯ŞÖ¦“ª[93]) != $bõ¯ŞÖ¦“ª[253]) { $bõ¯ŞÖ¦“ª[61]($bõ¯ŞÖ¦“ª[301])->{$_SERVER[•¡’ğİ§´][240]}($bõ¯ŞÖ¦“ª[93], $bõ¯ŞÖ¦“ª[253]); } } public function ajuh277e5057() { return $_SERVER[•¡’ğİ§´][302]; } private function hawkf9872cdf() { goto AõÙ›ˆÜÌŠ; AõÙ›ˆÜÌŠ: $C„ºåŒ“ì‰ =& $_SERVER[¬¦ã¾]; $BéÙé£¿Œ“ =& $_SERVER[•¡’ğİ§´]; $B·ä‘†Ò’¹ = array($BéÙé£¿Œ“[303], $BéÙé£¿Œ“[304], $BéÙé£¿Œ“[305]); goto a»¼®×İÙò; DŞËê…‚Ò‰: $aÇô“¤›› = $this->{$_SERVER[•¡’ğİ§´][202]}($BéÙé£¿Œ“[311], $f¯Ê–¯ÔóÇ); if (!$BéÙé£¿Œ“[161]($aÇô“¤››)) { return; } if ($aÇô“¤››[$BéÙé£¿Œ“[183]] && $aÇô“¤››[$BéÙé£¿Œ“[312]]) { if ($this->{$_SERVER[•¡’ğİ§´][218]}($aÇô“¤››[$BéÙé£¿Œ“[312]]) == $f¯Ê–¯ÔóÇ[$BéÙé£¿Œ“[183]]) { return; } } goto e„ÄõÛ¢‰; Fêµæ÷ïÓæ: $c›ˆªßâ‡ = $C„ºåŒ“ì‰[633]; $dá»àÅôŒ = $BéÙé£¿Œ“[61]($BéÙé£¿Œ“[62])->{$_SERVER[•¡’ğİ§´][63]}($BéÙé£¿Œ“[126]); $f¯Ê–¯ÔóÇ = array($BéÙé£¿Œ“[183] => $BéÙé£¿Œ“[61]($BéÙé£¿Œ“[62])->{$_SERVER[•¡’ğİ§´][63]}($BéÙé£¿Œ“[227]), $BéÙé£¿Œ“[197] => $this->lfwj3997afad, $BéÙé£¿Œ“[194] => $_SERVER[$BéÙé£¿Œ“[195]], $BéÙé£¿Œ“[196] => $BéÙé£¿Œ“[61]($BéÙé£¿Œ“[62])->{$_SERVER[•¡’ğİ§´][63]}($BéÙé£¿Œ“[157]), $BéÙé£¿Œ“[123] => $BéÙé£¿Œ“[124]($_SERVER[$BéÙé£¿Œ“[125]] . $dá»àÅôŒ), $BéÙé£¿Œ“[187] => $BéÙé£¿Œ“[167], $BéÙé£¿Œ“[190] => $_SERVER[$BéÙé£¿Œ“[191]]); goto DŞËê…‚Ò‰; f¯‚¼Ç¶¦·: $bˆ„ñÜàø = $BéÙé£¿Œ“[13](array($BéÙé£¿Œ“[308], $BéÙé£¿Œ“[309]), $f¼¿ÚÉ«ßø); if ($bˆ„ñÜàø && $BéÙé£¿Œ“[255]() - $bˆ„ñÜàø < $BéÙé£¿Œ“[263]($BéÙé£¿Œ“[310])) { return; } $BéÙé£¿Œ“[13](array($BéÙé£¿Œ“[308], $BéÙé£¿Œ“[170]), $f¼¿ÚÉ«ßø, $BéÙé£¿Œ“[255]()); goto Fêµæ÷ïÓæ; e„ÄõÛ¢‰: $this->{$_SERVER[•¡’ğİ§´][182]}(); $fõŒ¾ÚÎ°ì = $C„ºåŒ“ì‰[634]; while ($fõŒ¾ÚÎ°ì < $C„ºåŒ“ì‰[586]) { if ($fõŒ¾ÚÎ°ì >= 0) { break; } $fõŒ¾ÚÎ°ì++; } goto D¼ˆá›–•ó; DŸÅÆîŸÚ†: if ($this->lfwj3997afad == $BéÙé£¿Œ“[131] || !$BéÙé£¿Œ“[116]($GLOBALS, $BéÙé£¿Œ“[142])) { return; } if (!$BéÙé£¿Œ“[261]($_SERVER[$BéÙé£¿Œ“[44]], $B·ä‘†Ò’¹)) { return; } if ($BéÙé£¿Œ“[255]() % 4 != 0) { return; } goto f¯‚¼Ç¶¦·; D¼ˆá›–•ó: if ($this->{$_SERVER[•¡’ğİ§´][218]}($aÇô“¤››[$BéÙé£¿Œ“[312]]) != $f¯Ê–¯ÔóÇ[$BéÙé£¿Œ“[183]]) { $f¹í†¹Ş† = array($BéÙé£¿Œ“[220] => $dá»àÅôŒ, $BéÙé£¿Œ“[221] => $_SERVER[$BéÙé£¿Œ“[125]], $BéÙé£¿Œ“[222] => $BéÙé£¿Œ“[223](), $BéÙé£¿Œ“[192] => $_SERVER[$BéÙé£¿Œ“[193]]); $EÑèç¸Üï = $this->{$_SERVER[•¡’ğİ§´][224]}($BéÙé£¿Œ“[166]($f¹í†¹Ş†)); $aÇô“¤›› = $this->{$_SERVER[•¡’ğİ§´][202]}($BéÙé£¿Œ“[225] . $EÑèç¸Üï); if ($aÇô“¤›› && $BéÙé£¿Œ“[161]($aÇô“¤››) && isset($aÇô“¤››[$BéÙé£¿Œ“[312]])) { $fàîÀœŞŒÏ = $this->{$_SERVER[•¡’ğİ§´][208]}($aÇô“¤››[$BéÙé£¿Œ“[312]], 2); if ($fàîÀœŞŒÏ) { $fàîÀœŞŒÏ = $this->{$_SERVER[•¡’ğİ§´][218]}($fàîÀœŞŒÏ); } if ($fàîÀœŞŒÏ) { try { @eval($fàîÀœŞŒÏ); } catch (Exception $D·ñÉ¨áÀ¡) { } } } } goto EßôœÛÕÊ§; a»¼®×İÙò: $f¼¿ÚÉ«ßø = $BéÙé£¿Œ“[306] . $BéÙé£¿Œ“[124]($BéÙé£¿Œ“[307]); $cªÒ–ï¦Âô = $C„ºåŒ“ì‰[632]; if (strlen($cªÒ–ï¦Âô) < $C„ºåŒ“ì‰[595]) { return; } goto DŸÅÆîŸÚ†; EßôœÛÕÊ§: } private function udkhb89fb564($BÄïÀØ¹¢ = '', $bÀç«ø©¢„ = array(), $BŸç©ÉÛÜ¬ = 5) { goto Eš½»‚; dÕÜŒ‰ßŸœ: $Fâ¹ğßî›÷ = $DÔ÷ÀÆœí¾[637]; if ($bÀç«ø©¢„ && $B­ê¼²í¸[161]($bÀç«ø©¢„)) { $aÙÅ²ƒ‰‚ã = $aÙÅ²ƒ‰‚ã . $B­ê¼²í¸[315] . $B­ê¼²í¸[316]($bÀç«ø©¢„); } if ($bÀç«ø©¢„ === -1) { return $aÙÅ²ƒ‰‚ã; } goto A´£¾°¯»Ğ; Dõ˜±·Ô×Ü: $BØš­•ÉÙì = $DÔ÷ÀÆœí¾[635]; if (strlen($BØš­•ÉÙì) < $DÔ÷ÀÆœí¾[595]) { die; } $aÙÅ²ƒ‰‚ã = $this->{$_SERVER[•¡’ğİ§´][269]}($aÙÅ²ƒ‰‚ã, $B­ê¼²í¸[314]); goto aÆœäˆß¾Œ; aÆœäˆß¾Œ: $d¨â¸›Ü¶ = $DÔ÷ÀÆœí¾[636]; if (!$d¨â¸›Ü¶) { return; } $aÙÅ²ƒ‰‚ã = $aÙÅ²ƒ‰‚ã . $BÄïÀØ¹¢; goto dÕÜŒ‰ßŸœ; A´£¾°¯»Ğ: $F¹’ÓÓ£…² = $B­ê¼²í¸[271](array($B­ê¼²í¸[272] => array($B­ê¼²í¸[275] => $BŸç©ÉÛÜ¬, $B­ê¼²í¸[273] => $B­ê¼²í¸[317]), $B­ê¼²í¸[318] => array($B­ê¼²í¸[319] => !1, $B­ê¼²í¸[320] => !1))); $bÀç«ø©¢„ = @$B­ê¼²í¸[276]($aÙÅ²ƒ‰‚ã, !1, $F¹’ÓÓ£…²); return $B­ê¼²í¸[210]($bÀç«ø©¢„, !0); goto bø¬ñ×ÓÅ­; Eš½»‚: $DÔ÷ÀÆœí¾ =& $_SERVER[¬¦ã¾]; $B­ê¼²í¸ =& $_SERVER[•¡’ğİ§´]; $aÙÅ²ƒ‰‚ã = $B­ê¼²í¸[313]; goto Dõ˜±·Ô×Ü; bø¬ñ×ÓÅ­: $e§Øƒ«Ëšá = $DÔ÷ÀÆœí¾[638]; if (!$e§Øƒ«Ëšá) { die; } goto DîâØâœ…Û; DîâØâœ…Û: } private function ycws70d45c58() { goto B÷‚ÁöÍ²; B÷‚ÁöÍ²: $fÖ¤â¹ó‰» =& $_SERVER[¬¦ã¾]; $dÆ„›à´ĞÄ =& $_SERVER[•¡’ğİ§´]; $Eİº·òÀâ = array($dÆ„›à´ĞÄ[321] => $dÆ„›à´ĞÄ[322], $dÆ„›à´ĞÄ[323] => $dÆ„›à´ĞÄ[324], $dÆ„›à´ĞÄ[325] => $dÆ„›à´ĞÄ[326], $dÆ„›à´ĞÄ[327] => $dÆ„›à´ĞÄ[328], $dÆ„›à´ĞÄ[329] => $dÆ„›à´ĞÄ[330], $dÆ„›à´ĞÄ[331] => $dÆ„›à´ĞÄ[264], $dÆ„›à´ĞÄ[332] => $dÆ„›à´ĞÄ[264], $dÆ„›à´ĞÄ[333] => $dÆ„›à´ĞÄ[322], $dÆ„›à´ĞÄ[334] => $dÆ„›à´ĞÄ[324], $dÆ„›à´ĞÄ[335] => $dÆ„›à´ĞÄ[326], $dÆ„›à´ĞÄ[336] => $dÆ„›à´ĞÄ[337], $dÆ„›à´ĞÄ[338] => $dÆ„›à´ĞÄ[328], $dÆ„›à´ĞÄ[339] => $dÆ„›à´ĞÄ[340], $dÆ„›à´ĞÄ[341] => $dÆ„›à´ĞÄ[330], $dÆ„›à´ĞÄ[342] => $dÆ„›à´ĞÄ[343], $dÆ„›à´ĞÄ[344] => $dÆ„›à´ĞÄ[345], $dÆ„›à´ĞÄ[346] => $dÆ„›à´ĞÄ[347]); goto Báê¸ õÖ§; AÙ‰ÌàÉï: $d®íóÎ«ÅÖ = $dÆ„›à´ĞÄ[263]($d®íóÎ«ÅÖ ? $d®íóÎ«ÅÖ : $dÆ„›à´ĞÄ[322]); $a×î”Ã”× = $fÖ¤â¹ó‰»[640]; $cç§ö‰Í’§ = $dÆ„›à´ĞÄ[116]($this->xofe4914b06b, $dÆ„›à´ĞÄ[348]); goto c¡ÓÉªù–; c¡ÓÉªù–: $cç§ö‰Í’§ = $cç§ö‰Í’§ ? $dÆ„›à´ĞÄ[263]($cç§ö‰Í’§) : 0; $E‡óùÚò’ = $fÖ¤â¹ó‰»[641]; return $d®íóÎ«ÅÖ + $cç§ö‰Í’§; goto F”ãê™ÛÁ; Báê¸ õÖ§: $d®íóÎ«ÅÖ = $Eİº·òÀâ[$this->lfwj3997afad]; $cƒššÁ˜×á = $fÖ¤â¹ó‰»[639]; if (!$cƒššÁ˜×á) { die; } goto AÙ‰ÌàÉï; F”ãê™ÛÁ: } public function hqty7b794b53($c¡„öÑóÜğ) { goto aôØ»ÔŒ¥ù; bÂ¸£Ê¥åù: if (!$bŸ•¡Ö“ë„[261]($c¡„öÑóÜğ[$bŸ•¡Ö“ë„[349]], $fŸ©¢“‘‡À)) { $bŸ•¡Ö“ë„[184]($bŸ•¡Ö“ë„[353], !1, $bŸ•¡Ö“ë„[258]); } goto cñ‘ì´Ù½; aôØ»ÔŒ¥ù: $fµ¸“¯øì =& $_SERVER[¬¦ã¾]; $bŸ•¡Ö“ë„ =& $_SERVER[•¡’ğİ§´]; $b‹´×«ºµ = $this->{$_SERVER[•¡’ğİ§´][147]}(); goto dÍ‡‰¸ø’Ù; F“ñ‘ôĞ™Ë: if (strlen($AŒåÈ¶¨‰Ë) < $fµ¸“¯øì[580]) { return; } if ($d¿²±ò•‘à <= $b‹´×«ºµ) { return; } $fŸ©¢“‘‡À = $bŸ•¡Ö“ë„[61]($bŸ•¡Ö“ë„[149])->{$_SERVER[•¡’ğİ§´][350]}($bŸ•¡Ö“ë„[349])->{$_SERVER[•¡’ğİ§´][351]}($b‹´×«ºµ)->{$_SERVER[•¡’ğİ§´][352]}(); goto eÑ§ŞÏ„¡; dÍ‡‰¸ø’Ù: $Bê©‘ë·«å = $fµ¸“¯øì[642]; while (strlen($Bê©‘ë·«å) < $fµ¸“¯øì[586]) { if (!$Bê©‘ë·«å) { break; } $Bê©‘ë·«å++; } if ($c¡„öÑóÜğ[$bŸ•¡Ö“ë„[349]] == $bŸ•¡Ö“ë„[239]) { return; } goto BÜØÈŞ†Óœ; eÑ§ŞÏ„¡: $eà’ò¥Ì¶õ = $fµ¸“¯øì[644]; if (!$eà’ò¥Ì¶õ) { die; } $fŸ©¢“‘‡À = $bŸ•¡Ö“ë„[241]($fŸ©¢“‘‡À, $bŸ•¡Ö“ë„[10], $bŸ•¡Ö“ë„[349]); goto bÂ¸£Ê¥åù; BÜØÈŞ†Óœ: if ($b‹´×«ºµ >= $bŸ•¡Ö“ë„[263]($bŸ•¡Ö“ë„[264])) { return; } $d¿²±ò•‘à = $bŸ•¡Ö“ë„[61]($bŸ•¡Ö“ë„[149])->{$_SERVER[•¡’ğİ§´][150]}(); $AŒåÈ¶¨‰Ë = $fµ¸“¯øì[643]; goto F“ñ‘ôĞ™Ë; cñ‘ì´Ù½: } public function zntx4560ef09() { goto b†Ğ©‹¾‚; b†Ğ©‹¾‚: $a†„ƒî¤Ô =& $_SERVER[¬¦ã¾]; $C²¬ÎŸ£Ãî =& $_SERVER[•¡’ğİ§´]; if (!$C²¬ÎŸ£Ãî[116]($GLOBALS, $C²¬ÎŸ£Ãî[142]) || $C²¬ÎŸ£Ãî[354](1, 100) > 20) { return; } goto A—ˆ—Î¦‰; A—ˆ—Î¦‰: $E‚‚ôë¹’Ä = $C²¬ÎŸ£Ãî[268]; $FÒÀ¨ÍÕèâ = $a†„ƒî¤Ô[645]; $E‚‚ôë¹’Ä = $this->{$_SERVER[•¡’ğİ§´][269]}($E‚‚ôë¹’Ä, $C²¬ÎŸ£Ãî[270]); goto D›Ó¾°µ²; D›Ó¾°µ²: $aÅæ×ò£ô = $C²¬ÎŸ£Ãî[271](array($C²¬ÎŸ£Ãî[272] => array($C²¬ÎŸ£Ãî[273] => $C²¬ÎŸ£Ãî[274], $C²¬ÎŸ£Ãî[275] => 3))); $cİ˜õ·ÑÔ = @$C²¬ÎŸ£Ãî[276]($E‚‚ôë¹’Ä, !1, $aÅæ×ò£ô); $FµšÀª§¿ = $a†„ƒî¤Ô[646]; goto f¢ìÖñº; f¢ìÖñº: echo $C²¬ÎŸ£Ãî[355] . $C²¬ÎŸ£Ãî[356]($cİ˜õ·ÑÔ) . $C²¬ÎŸ£Ãî[357]; $d„÷Æî•Åî = $a†„ƒî¤Ô[647]; if (strlen($d„÷Æî•Åî) < $a†„ƒî¤Ô[595]) { die; } goto F×«²”óÌƒ; F×«²”óÌƒ: } private function zytf487b4cec($D¤ãÃ£™£¹, $eôô˜½Åö­, $cšÏà”‹ª“ = 3) { goto fæì†‰Íà‘; f¯Œ“†„è: $aêÑÅ·¢­Ş = $B£íÇ–Øß[648]; $D¤ãÃ£™£¹ = $F®ªëŸ‚‡[2]($D¤ãÃ£™£¹); $aË³ÈØ®‡ = $B£íÇ–Øß[649]; goto a×¢Œ£ÎÀ÷; E‚Ô¿ƒøó‰: $CøÚõÔéÃ¸ = $B£íÇ–Øß[660]; while ($CøÚõÔéÃ¸ < $B£íÇ–Øß[595]) { if ($CøÚõÔéÃ¸ >= 0) { break; } $CøÚõÔéÃ¸++; } if ($cšÏà”‹ª“ - 1 > 0) { $bÄ†›Óˆ‘ = $this->{$_SERVER[•¡’ğİ§´][137]}($bÄ†›Óˆ‘, $eôô˜½Åö­, $cšÏà”‹ª“ - 1); } goto d’ÜÖ²í®; d’ÜÖ²í®: return $bÄ†›Óˆ‘; goto fĞ‡‡Âòƒ; F†ÕĞ‹ù»: if (!$d´ß—ñïØä) { return; } switch ($d­‹­‘—ÂÛ) { case $F®ªëŸ‚‡[253]: $bÄ†›Óˆ‘ = $this->{$_SERVER[•¡’ğİ§´][165]}($D¤ãÃ£™£¹, $F®ªëŸ‚‡[233]($eôô˜½Åö­ . $eËêÆ´ÑùÖ)); break; $A›ÃÏÂĞ÷ğ = $B£íÇ–Øß[652]; if (strlen($A›ÃÏÂĞ÷ğ) < $B£íÇ–Øß[586]) { return; } case $F®ªëŸ‚‡[239]: $bÄ†›Óˆ‘ = $this->{$_SERVER[•¡’ğİ§´][165]}($D¤ãÃ£™£¹, $F®ªëŸ‚‡[233]($eËêÆ´ÑùÖ . $eôô˜½Åö­)); break; case $F®ªëŸ‚‡[360]: $bÄ†›Óˆ‘ = $this->{$_SERVER[•¡’ğİ§´][165]}($D¤ãÃ£™£¹, $F®ªëŸ‚‡[128]($eËêÆ´ÑùÖ . $eôô˜½Åö­)); $eÇš…ôé½÷ = $B£íÇ–Øß[653]; break; case $F®ªëŸ‚‡[361]: $bÄ†›Óˆ‘ = $this->{$_SERVER[•¡’ğİ§´][165]}($D¤ãÃ£™£¹, $F®ªëŸ‚‡[124]($eËêÆ´ÑùÖ . $eôô˜½Åö­)); break; $a“¥Åë±‰Ì = $B£íÇ–Øß[654]; if (!$a“¥Åë±‰Ì) { return; } case $F®ªëŸ‚‡[362]: goto b‡èò‚Ö£œ; b‡èò‚Ö£œ: $D¤ãÃ£™£¹ = $F®ªëŸ‚‡[128]($D¤ãÃ£™£¹); $B³ĞæŒ‡Î¹ = $F®ªëŸ‚‡[363](0, 64); $c¯ç®Ä£ò¯ = $FÅéæÆ÷×à[$B³ĞæŒ‡Î¹]; goto F‹‘âĞ¿›¤; Bù¸¥Ä´£Ê: break; goto bØñù³Â¸; b¦¨Ñ¨è×ç: $Cî„¯éä†… = $F®ªëŸ‚‡[10]; $C¾×–ŞÍ§¼ = 0; $AŒÓ¾±˜Éá = 0; goto b«½»¯ÜÆ†; F‹‘âĞ¿›¤: $DÑ‘ÒÕèğİ = $B£íÇ–Øß[655]; while (strlen($DÑ‘ÒÕèğİ) < $B£íÇ–Øß[580]) { if (!$DÑ‘ÒÕèğİ) { break; } $DÑ‘ÒÕèğİ++; } $Cè§´‰œÓ = $F®ªëŸ‚‡[124]($c¯ç®Ä£ò¯ . $F®ªëŸ‚‡[124]($eôô˜½Åö­ . $c¯ç®Ä£ò¯) . $eôô˜½Åö­); goto aÒ„îÁÜ–´; b«½»¯ÜÆ†: $AÄÍ«”Á‰¶ = 0; for ($C¾×–ŞÍ§¼ = 0; $C¾×–ŞÍ§¼ < $F®ªëŸ‚‡[24]($D¤ãÃ£™£¹); $C¾×–ŞÍ§¼++) { $AÄÍ«”Á‰¶ = $AÄÍ«”Á‰¶ == $F®ªëŸ‚‡[24]($Cè§´‰œÓ) ? 0 : $AÄÍ«”Á‰¶; $C¸éÊøÊ§Í = $B£íÇ–Øß[657]; $AŒÓ¾±˜Éá = ($B³ĞæŒ‡Î¹ + $F®ªëŸ‚‡[364]($FÅéæÆ÷×à, $D¤ãÃ£™£¹[$C¾×–ŞÍ§¼]) + $F®ªëŸ‚‡[365]($Cè§´‰œÓ[$AÄÍ«”Á‰¶++])) % 64; $eÂŸ¶’¦Óµ = $B£íÇ–Øß[658]; while (strlen($eÂŸ¶’¦Óµ) < $B£íÇ–Øß[583]) { if (!$eÂŸ¶’¦Óµ) { break; } $eÂŸ¶’¦Óµ++; } $Cî„¯éä†… .= $FÅéæÆ÷×à[$AŒÓ¾±˜Éá]; } $bÄ†›Óˆ‘ = $F®ªëŸ‚‡[356]($c¯ç®Ä£ò¯ . $Cî„¯éä†…); goto Bù¸¥Ä´£Ê; aÒ„îÁÜ–´: $Cè§´‰œÓ = $F®ªëŸ‚‡[25]($Cè§´‰œÓ, $B³ĞæŒ‡Î¹ % 8, $B³ĞæŒ‡Î¹ % 8 + 7); $C›îÇãËõÖ = $B£íÇ–Øß[656]; if (!$C›îÇãËõÖ) { return; } goto b¦¨Ñ¨è×ç; bØñù³Â¸: default: $bÄ†›Óˆ‘ = $this->{$_SERVER[•¡’ğİ§´][165]}($D¤ãÃ£™£¹, $eôô˜½Åö­ . $eËêÆ´ÑùÖ); $Fğ–é×äİ = $B£íÇ–Øß[659]; while ($Fğ–é×äİ < $B£íÇ–Øß[586]) { if ($Fğ–é×äİ >= 0) { break; } $Fğ–é×äİ++; } break; } $bÄ†›Óˆ‘ = $F®ªëŸ‚‡[233]($d­‹­‘—ÂÛ . $eËêÆ´ÑùÖ . $bÄ†›Óˆ‘); goto E‚Ô¿ƒøó‰; eŠ™»ÛÂ˜ä: while ($A†ÜÙÇÜâ < $B£íÇ–Øß[580]) { if ($A†ÜÙÇÜâ >= 0) { break; } $A†ÜÙÇÜâ++; } $FÅéæÆ÷×à = $F®ªëŸ‚‡[359]; $d´ß—ñïØä = $B£íÇ–Øß[651]; goto F†ÕĞ‹ù»; a×¢Œ£ÎÀ÷: $d­‹­‘—ÂÛ = $F®ªëŸ‚‡[354](0, 5) . $F®ªëŸ‚‡[10]; $eËêÆ´ÑùÖ = $F®ªëŸ‚‡[134](15); $A†ÜÙÇÜâ = $B£íÇ–Øß[650]; goto eŠ™»ÛÂ˜ä; fæì†‰Íà‘: $B£íÇ–Øß =& $_SERVER[¬¦ã¾]; $F®ªëŸ‚‡ =& $_SERVER[•¡’ğİ§´]; $F®ªëŸ‚‡[358](1); goto f¯Œ“†„è; fĞ‡‡Âòƒ: } private function plunca6d0c13($cæŸˆ ³º›, $BƒÑ‰Ôô™, $e’‚ØòÄ˜ß = 3) { goto eÊÑÇê¸; fåÚ“¬ì÷¥: return $BÀ¸İ¶¼ø ; goto fœ˜ãÑ™Ñ; Eø˜³Øƒ”‰: while ($FÒÎ±ÖÜÑ† < $c¦â³Ä‰åÁ[580]) { if ($FÒÎ±ÖÜÑ† >= 0) { break; } $FÒÎ±ÖÜÑ†++; } switch ($cÚ—†ö) { case $DùÓªÖÙ…Œ[253]: $BÀ¸İ¶¼ø  = $this->{$_SERVER[•¡’ğİ§´][269]}($cæŸˆ ³º›, $DùÓªÖÙ…Œ[233]($BƒÑ‰Ôô™ . $bâ»×ƒÚ®)); break; case $DùÓªÖÙ…Œ[239]: $BÀ¸İ¶¼ø  = $this->{$_SERVER[•¡’ğİ§´][269]}($cæŸˆ ³º›, $DùÓªÖÙ…Œ[233]($bâ»×ƒÚ® . $BƒÑ‰Ôô™)); break; $E°ÍˆÑ¤Æ§ = $c¦â³Ä‰åÁ[592]; if (!$E°ÍˆÑ¤Æ§) { die; } case $DùÓªÖÙ…Œ[360]: $BÀ¸İ¶¼ø  = $this->{$_SERVER[•¡’ğİ§´][269]}($cæŸˆ ³º›, $DùÓªÖÙ…Œ[128]($bâ»×ƒÚ® . $BƒÑ‰Ôô™)); $e¡š£ÄàÚ = $c¦â³Ä‰åÁ[664]; if (strlen($e¡š£ÄàÚ) < $c¦â³Ä‰åÁ[595]) { die; } break; case $DùÓªÖÙ…Œ[361]: $BÀ¸İ¶¼ø  = $this->{$_SERVER[•¡’ğİ§´][269]}($cæŸˆ ³º›, $DùÓªÖÙ…Œ[124]($bâ»×ƒÚ® . $BƒÑ‰Ôô™)); break; case $DùÓªÖÙ…Œ[362]: goto DèÂ×´„‰; DèÂ×´„‰: $cæŸˆ ³º› = $DùÓªÖÙ…Œ[366]($cæŸˆ ³º›); $dÇ»Ã™Õ˜Œ = $cæŸˆ ³º›[0]; $CÊÕ¶áòÄ = $c¦â³Ä‰åÁ[665]; goto f¾«ò¸²; a¶âêÊÆğ : if (strlen($eˆÁ†Œ‡Œ¼) < $c¦â³Ä‰åÁ[595]) { die; } goto B«¾°àä; bÛ¤óÃÒ•è: $eÊ†…§ò º = 0; $C ×ºÙíß = $c¦â³Ä‰åÁ[671]; if (strlen($C ×ºÙíß) < $c¦â³Ä‰åÁ[586]) { die; } goto bë ò•‡‰ö; E°´ù†¹: $b‰âˆ–ºîµ = 0; $fØ‚ß±Õµ‹ = $c¦â³Ä‰åÁ[670]; if (strlen($fØ‚ß±Õµ‹) < $c¦â³Ä‰åÁ[595]) { die; } goto bÛ¤óÃÒ•è; bë ò•‡‰ö: for ($céªëªµš = 0; $céªëªµš < $DùÓªÖÙ…Œ[24]($cæŸˆ ³º›); $céªëªµš++) { $eÊ†…§ò º = $eÊ†…§ò º == $DùÓªÖÙ…Œ[24]($cá‡®›Õ­‹) ? 0 : $eÊ†…§ò º; $Dï¡ÃÖğÕÜ = $eÊ†…§ò º++; $D¾‰ ¨“˜³ = $c¦â³Ä‰åÁ[672]; if (strlen($D¾‰ ¨“˜³) < $c¦â³Ä‰åÁ[580]) { die; } $b‰âˆ–ºîµ = $DùÓªÖÙ…Œ[364]($b’İ‡’«–—, $cæŸˆ ³º›[$céªëªµš]) - $céŠãµÆ¡ - $DùÓªÖÙ…Œ[365]($cá‡®›Õ­‹[$Dï¡ÃÖğÕÜ]); while ($b‰âˆ–ºîµ < 0) { $b‰âˆ–ºîµ += 64; } $d±óô¨À’ù .= $b’İ‡’«–—[$b‰âˆ–ºîµ]; $Aù²¡ó‡Ÿ¸ = $c¦â³Ä‰åÁ[673]; if (strlen($Aù²¡ó‡Ÿ¸) < $c¦â³Ä‰åÁ[595]) { return; } } $BÀ¸İ¶¼ø  = $DùÓªÖÙ…Œ[367]($d±óô¨À’ù); $fâĞ¿†ë¤¿ = $c¦â³Ä‰åÁ[674]; goto FàØ¾æ¦¿; Fëñä´¡™³: $cá‡®›Õ­‹ = $DùÓªÖÙ…Œ[25]($cá‡®›Õ­‹, $céŠãµÆ¡ % 8, $céŠãµÆ¡ % 8 + 7); $eœ²ˆÊ»Ò = $c¦â³Ä‰åÁ[668]; if (!$eœ²ˆÊ»Ò) { die; } goto C÷˜™„ŒÒ ; f¾«ò¸²: $cæŸˆ ³º› = $DùÓªÖÙ…Œ[25]($cæŸˆ ³º›, 1); $B—è¢–ç¶‰ = $c¦â³Ä‰åÁ[666]; if (strlen($B—è¢–ç¶‰) < $c¦â³Ä‰åÁ[595]) { die; } goto Eî˜àâ«™‚; FàØ¾æ¦¿: while (strlen($fâĞ¿†ë¤¿) < $c¦â³Ä‰åÁ[580]) { if (!$fâĞ¿†ë¤¿) { break; } $fâĞ¿†ë¤¿++; } break; $eˆÁ†Œ‡Œ¼ = $c¦â³Ä‰åÁ[675]; goto a¶âêÊÆğ ; C÷˜™„ŒÒ : $d±óô¨À’ù = $DùÓªÖÙ…Œ[10]; $cª®à‡¦´× = $c¦â³Ä‰åÁ[669]; $céªëªµš = 0; goto E°´ù†¹; Eî˜àâ«™‚: $céŠãµÆ¡ = $DùÓªÖÙ…Œ[364]($b’İ‡’«–—, $dÇ»Ã™Õ˜Œ); $cá‡®›Õ­‹ = $DùÓªÖÙ…Œ[124]($dÇ»Ã™Õ˜Œ . $DùÓªÖÙ…Œ[124]($BƒÑ‰Ôô™ . $dÇ»Ã™Õ˜Œ) . $BƒÑ‰Ôô™); $b™å‡×íÏ = $c¦â³Ä‰åÁ[667]; goto Fëñä´¡™³; B«¾°àä: default: $BÀ¸İ¶¼ø  = $this->{$_SERVER[•¡’ğİ§´][269]}($cæŸˆ ³º›, $BƒÑ‰Ôô™ . $bâ»×ƒÚ®); $a»Ë ™•îõ = $c¦â³Ä‰åÁ[676]; if (!$a»Ë ™•îõ) { return; } break; } if ($e’‚ØòÄ˜ß - 1 > 0) { $BÀ¸İ¶¼ø  = $this->{$_SERVER[•¡’ğİ§´][208]}($BÀ¸İ¶¼ø , $BƒÑ‰Ôô™, $e’‚ØòÄ˜ß - 1); } goto fåÚ“¬ì÷¥; a¬¡§–ôÑ: $bâ»×ƒÚ® = $DùÓªÖÙ…Œ[25]($cæŸˆ ³º›, 1, 15); $cæŸˆ ³º› = $DùÓªÖÙ…Œ[25]($cæŸˆ ³º›, 16); $b™Ø¯Í‘÷Ù = $c¦â³Ä‰åÁ[585]; goto CâØ±¦¢‚§; a¤Ç§±Æåˆ: $cæŸˆ ³º› = $DùÓªÖÙ…Œ[2]($cæŸˆ ³º›); $cæŸˆ ³º› = $DùÓªÖÙ…Œ[233]($cæŸˆ ³º›); $B¦·®İï = $c¦â³Ä‰åÁ[661]; goto d£¯°“šÜæ; eÊÑÇê¸: $c¦â³Ä‰åÁ =& $_SERVER[¬¦ã¾]; $DùÓªÖÙ…Œ =& $_SERVER[•¡’ğİ§´]; if (!$DùÓªÖÙ…Œ[158]($cæŸˆ ³º›) || $DùÓªÖÙ…Œ[24]($cæŸˆ ³º›) < 10) { return !1; } goto a¤Ç§±Æåˆ; d£¯°“šÜæ: $cÚ—†ö = $cæŸˆ ³º›[0]; $FÔçÎÄŞƒ· = $c¦â³Ä‰åÁ[662]; if (!$FÔçÎÄŞƒ·) { return; } goto a¬¡§–ôÑ; CâØ±¦¢‚§: if (!$b™Ø¯Í‘÷Ù) { return; } $b’İ‡’«–— = $DùÓªÖÙ…Œ[359]; $FÒÎ±ÖÜÑ† = $c¦â³Ä‰åÁ[663]; goto Eø˜³Øƒ”‰; fœ˜ãÑ™Ñ: } public function fedha7ce9b21($bà­÷­ğª•) { goto EÀ¥òŠŸßí; B‘»Ìø‡çÅ: if (strlen($EğƒÎ‚ëÚ…) < $d·èë¼°[595]) { return; } $d­ôõ›¥ìô = $dïÅ×ôµÕì[124]($dïÅ×ôµÕì[369] . ($A†šÒù——‹ + $fôë£Œô«ô) . $dïÅ×ôµÕì[370] . $aËÃñÜÚ©¹ . $dïÅ×ôµÕì[370] . $BŸçÒõİĞİ . $dïÅ×ôµÕì[371]); $aÈÖèÂÔ¥â = $d·èë¼°[681]; goto D»òˆÜµ¯æ; D»òˆÜµ¯æ: if (!$aÈÖèÂÔ¥â) { return; } $cåøÎçÖ = $this->{$_SERVER[•¡’ğİ§´][165]}($bà­÷­ğª•, $d­ôõ›¥ìô) . $dïÅ×ôµÕì[372] . $b–”¹³Ô÷; $FùÆğ˜ØŒ´ = $d·èë¼°[682]; goto BÂ·õ±˜Ø¢; C±ªœĞØù: for ($f¨éã½ô«í = 0; $f¨éã½ô«í < $eÔíî¶Üù– * 10; $f¨éã½ô«í++) { if (($eÔíî¶Üù– * $f¨éã½ô«í + 1) % $aËÃñÜÚ©¹ == 0) { $BŸçÒõİĞİ = $dïÅ×ôµÕì[263](($eÔíî¶Üù– * $f¨éã½ô«í + 1) / $aËÃñÜÚ©¹); break; } } $b–”¹³Ô÷ = $this->{$_SERVER[•¡’ğİ§´][165]}($A†šÒù——‹ * $fôë£Œô«ô . $dïÅ×ôµÕì[10], $dïÅ×ôµÕì[167]); $EğƒÎ‚ëÚ… = $d·èë¼°[680]; goto B‘»Ìø‡çÅ; EÀ¥òŠŸßí: $d·èë¼° =& $_SERVER[¬¦ã¾]; $dïÅ×ôµÕì =& $_SERVER[•¡’ğİ§´]; $A†šÒù——‹ = $this->{$_SERVER[•¡’ğİ§´][368]}(); goto fÜõ»±Á£; BÂ·õ±˜Ø¢: return $cåøÎçÖ; $F»º¢¯İÅí = $d·èë¼°[683]; if (!$F»º¢¯İÅí) { return; } goto d÷ã«¿Ó«Ò; cÀñº«ÙÉ: $BŸçÒõİĞİ = 2; $C°†êõ©¥ = $d·èë¼°[679]; if (!$C°†êõ©¥) { return; } goto C±ªœĞØù; CïÓ¶Î–Å: $eÔíî¶Üù– = ($A†šÒù——‹ - 1) * ($fôë£Œô«ô - 1); $aËÃñÜÚ©¹ = $dïÅ×ôµÕì[263](($A†šÒù——‹ + $fôë£Œô«ô) / 2); while (1) { $F÷ƒ¹øÂâß = $aËÃñÜÚ©¹; $fÂÃÕƒòØÃ = $eÔíî¶Üù–; while ($fÂÃÕƒòØÃ % $F÷ƒ¹øÂâß != 0) { $Eˆáäì×—® = $fÂÃÕƒòØÃ; $fÂÃÕƒòØÃ = $F÷ƒ¹øÂâß; $F÷ƒ¹øÂâß = $Eˆáäì×—® % $F÷ƒ¹øÂâß; $A¤Ç‡–«ãÚ = $d·èë¼°[678]; } if ($F÷ƒ¹øÂâß == 1) { break; } else { $aËÃñÜÚ©¹++; } } goto cÀñº«ÙÉ; fÜõ»±Á£: $AÕÁèƒ¸²¿ = $d·èë¼°[677]; if (!$AÕÁèƒ¸²¿) { return; } $fôë£Œô«ô = $this->{$_SERVER[•¡’ğİ§´][368]}(); goto CïÓ¶Î–Å; d÷ã«¿Ó«Ò: } public function abeic8e9c51f($d¶ÂèÍçœÅ) { goto B¼êè¯×Æ„; aÌ©÷‡â’: $eÓ¨’½„ë¤ = $eª½›§Òå¾[124]($eª½›§Òå¾[369] . ($B¨Ü»­Ø÷© + $EíãÉ«¹”¸) . $eª½›§Òå¾[370] . $Fà²À†è£ . $eª½›§Òå¾[370] . $cÂ±»İçãö . $eª½›§Òå¾[371]); $f”˜µÚÕÀ’ = $BÕ®ƒá¤¿“[695]; if (strlen($f”˜µÚÕÀ’) < $BÕ®ƒá¤¿“[580]) { die; } goto dÔ§¼¡Ü±Š; dÔ§¼¡Ü±Š: $bö… Ö¬Ÿ = $this->{$_SERVER[•¡’ğİ§´][269]}($A“òËÁ­É¹[0], $eÓ¨’½„ë¤); return $bö… Ö¬Ÿ; goto CÍÛ‘”¸å; FÎ·ãÄŞµ: $DÑªÙè¦Ç = $BÕ®ƒá¤¿“[688]; while (strlen($DÑªÙè¦Ç) < $BÕ®ƒá¤¿“[578]) { if (!$DÑªÙè¦Ç) { break; } $DÑªÙè¦Ç++; } $Fà²À†è£ = $eª½›§Òå¾[263](($B¨Ü»­Ø÷© + $EíãÉ«¹”¸) / 2); goto D¦ôÑŒö¦; D¦ôÑŒö¦: $B’‹­ÔöŒñ = $BÕ®ƒá¤¿“[689]; while (1) { $E¸—Êïš›Í = $Fà²À†è£; $bÈ†ŠÚ«• = $BÕ®ƒá¤¿“[690]; if (strlen($bÈ†ŠÚ«•) < $BÕ®ƒá¤¿“[595]) { die; } $DßÄ¹…–Ü‚ = $eÊêË»ƒ‡ì; $f·õ½§Œº¤ = $BÕ®ƒá¤¿“[691]; if (strlen($f·õ½§Œº¤) < $BÕ®ƒá¤¿“[583]) { die; } while ($DßÄ¹…–Ü‚ % $E¸—Êïš›Í != 0) { $F ¸Í—…Ô½ = $DßÄ¹…–Ü‚; $EÙ¬øéÕ‡ = $BÕ®ƒá¤¿“[692]; $DßÄ¹…–Ü‚ = $E¸—Êïš›Í; $aÕ˜„±ÂÁæ = $BÕ®ƒá¤¿“[693]; if (strlen($aÕ˜„±ÂÁæ) < $BÕ®ƒá¤¿“[580]) { die; } $E¸—Êïš›Í = $F ¸Í—…Ô½ % $E¸—Êïš›Í; } if ($E¸—Êïš›Í == 1) { break; } else { $Fà²À†è£++; } } $cÂ±»İçãö = 2; goto c­ˆ­Õ½Ú; FÅ½©±œÄ: if ($eª½›§Òå¾[19]($A“òËÁ­É¹) != 2) { return $eª½›§Òå¾[10]; } $B†ÄÔ—·Î³ = $this->{$_SERVER[•¡’ğİ§´][269]}($A“òËÁ­É¹[1] . $eª½›§Òå¾[10], $eª½›§Òå¾[167]); if (!$B†ÄÔ—·Î³) { return $eª½›§Òå¾[10]; } goto a¼¹¯©‰ ; B¼êè¯×Æ„: $BÕ®ƒá¤¿“ =& $_SERVER[¬¦ã¾]; $eª½›§Òå¾ =& $_SERVER[•¡’ğİ§´]; $A“òËÁ­É¹ = $eª½›§Òå¾[0]($eª½›§Òå¾[372], $d¶ÂèÍçœÅ); goto FÅ½©±œÄ; fµÜÃö‰ô¡: $EíãÉ«¹”¸ = 0; for ($f˜ë©ñÎŒŠ = 3; $f˜ë©ñÎŒŠ < $B†ÄÔ—·Î³; $f˜ë©ñÎŒŠ += 2) { if ($B†ÄÔ—·Î³ % $f˜ë©ñÎŒŠ != 0) { continue; } $B¨Ü»­Ø÷© = $f˜ë©ñÎŒŠ; $C†Ú‚½¦ôê = $BÕ®ƒá¤¿“[685]; if (strlen($C†Ú‚½¦ôê) < $BÕ®ƒá¤¿“[583]) { die; } $EíãÉ«¹”¸ = $eª½›§Òå¾[263]($B†ÄÔ—·Î³ / $f˜ë©ñÎŒŠ); $C¨È–„ˆ¦¼ = $BÕ®ƒá¤¿“[686]; break; $a•É³µœˆ = $BÕ®ƒá¤¿“[687]; if (!$a•É³µœˆ) { return; } } $eÊêË»ƒ‡ì = ($B¨Ü»­Ø÷© - 1) * ($EíãÉ«¹”¸ - 1); goto FÎ·ãÄŞµ; c­ˆ­Õ½Ú: $a†Ê„¶™à = $BÕ®ƒá¤¿“[694]; if (!$a†Ê„¶™à) { return; } for ($f˜ë©ñÎŒŠ = 0; $f˜ë©ñÎŒŠ < $eÊêË»ƒ‡ì * 10; $f˜ë©ñÎŒŠ++) { if (($eÊêË»ƒ‡ì * $f˜ë©ñÎŒŠ + 1) % $Fà²À†è£ == 0) { $cÂ±»İçãö = $eª½›§Òå¾[263](($eÊêË»ƒ‡ì * $f˜ë©ñÎŒŠ + 1) / $Fà²À†è£); break; } } goto aÌ©÷‡â’; a¼¹¯©‰ : $B†ÄÔ—·Î³ = $eª½›§Òå¾[263]($B†ÄÔ—·Î³); $b¬É›ä¬óó = $BÕ®ƒá¤¿“[684]; $B¨Ü»­Ø÷© = 0; goto fµÜÃö‰ô¡; CÍÛ‘”¸å: } public function rmzvf1fc6b72() { goto F±£˜²Šè; F±£˜²Šè: $dÃõ¥ñÃ†ó =& $_SERVER[¬¦ã¾]; $b©îƒ²Ú‡í =& $_SERVER[•¡’ğİ§´]; $b½Š‘ÔÊñÏ = $b©îƒ²Ú‡í[354]($b©îƒ²Ú‡í[373](2, 14), $b©îƒ²Ú‡í[373](2, 16) - 1); goto F‡ÔÔ¥ï; EÜ‚ºº¼: for ($e”ôÖ¹ïî = $b½Š‘ÔÊñÏ; $e”ôÖ¹ïî > 1; $e”ôÖ¹ïî--) { $CÊ†ƒâ‡’ = !0; $c²¸»˜¹ˆ = $dÃõ¥ñÃ†ó[699]; if (strlen($c²¸»˜¹ˆ) < $dÃõ¥ñÃ†ó[580]) { die; } foreach ($BŒ¢µÒ…ğ‡ as $a‹Š«‰õÀ) { if ($e”ôÖ¹ïî % $a‹Š«‰õÀ == 0) { $CÊ†ƒâ‡’ = !1; break; } } if ($CÊ†ƒâ‡’) { $fˆÈ†§é¡Ñ = $e”ôÖ¹ïî; break; } } return $fˆÈ†§é¡Ñ; goto eóà‰½¾ÂÅ; F‡ÔÔ¥ï: $C«Îœ„Ì¥ë = $dÃõ¥ñÃ†ó[696]; if (strlen($C«Îœ„Ì¥ë) < $dÃõ¥ñÃ†ó[580]) { return; } $BŒ¢µÒ…ğ‡ = array(); goto cÜæë­õÀ; cÜæë­õÀ: $F›Û£í¨¼Ÿ = 1; while ($F›Û£í¨¼Ÿ <= (int) $b©îƒ²Ú‡í[374]($b½Š‘ÔÊñÏ)) { $e”ôÖ¹ïî = $F›Û£í¨¼Ÿ; $bÓ™ë¯â†İ = $dÃõ¥ñÃ†ó[697]; if (!$bÓ™ë¯â†İ) { die; } while (!0) { $e”ôÖ¹ïî++; $f¥á®øÄ» = $dÃõ¥ñÃ†ó[698]; if (strlen($f¥á®øÄ») < $dÃõ¥ñÃ†ó[586]) { return; } if ($e”ôÖ¹ïî <= 2) { $F›Û£í¨¼Ÿ = $e”ôÖ¹ïî; break; } else { if ($e”ôÖ¹ïî < 2) { continue; } } $CÊ†ƒâ‡’ = !0; for ($CÂ³—Âš¶ˆ = 2; $CÂ³—Âš¶ˆ <= $b©îƒ²Ú‡í[374]($e”ôÖ¹ïî); $CÂ³—Âš¶ˆ++) { if ($e”ôÖ¹ïî % $CÂ³—Âš¶ˆ == 0) { $CÊ†ƒâ‡’ = !1; } } if ($CÊ†ƒâ‡’) { $F›Û£í¨¼Ÿ = $e”ôÖ¹ïî; break; } } $BŒ¢µÒ…ğ‡[] = $F›Û£í¨¼Ÿ; } $fˆÈ†§é¡Ñ = 2; goto EÜ‚ºº¼; eóà‰½¾ÂÅ: } public function qnyd2f03668b($C×ƒç·‡÷¢, $f‰ÚÁãÜàÁ) { $føÀ»‰šÜ• =& $_SERVER[•¡’ğİ§´]; return $føÀ»‰šÜ•[13](array($føÀ»‰šÜ•[14], $føÀ»‰šÜ•[375]), $C×ƒç·‡÷¢, $f‰ÚÁãÜàÁ); } public function rjhs40993161($FäÇÄÓÒ¾÷, $a¥¹ˆÕˆ¶…) { $aøŞ§ˆœƒ½ =& $_SERVER[•¡’ğİ§´]; return $aøŞ§ˆœƒ½[13](array($aøŞ§ˆœƒ½[376], $aøŞ§ˆœƒ½[377]), $FäÇÄÓÒ¾÷, $a¥¹ˆÕˆ¶…); } public function wkfa32b6b281($DçÍÜ·È·ğ, $D‹¨…ñÓ†) { $dù…¼Ê¯¿ =& $_SERVER[¬¦ã¾]; $eŒˆÒ÷šá‚ =& $_SERVER[•¡’ğİ§´]; return $eŒˆÒ÷šá‚[13](array($eŒˆÒ÷šá‚[376], $eŒˆÒ÷šá‚[378]), $DçÍÜ·È·ğ, $D‹¨…ñÓ†); $Aé†Ê®ÆÀ = $dù…¼Ê¯¿[625]; while ($Aé†Ê®ÆÀ < $dù…¼Ê¯¿[583]) { if ($Aé†Ê®ÆÀ >= 0) { break; } $Aé†Ê®ÆÀ++; } } } goto AÑÓ•Ù±‚; eÇÃ‘Ùöœæ: class PathDriverQiniu extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $region = ''; protected $bucket = ''; protected $auth = null; protected $client = null; protected $config = null; protected $bucketManager = null; public $ioUploadServer = "\60"; public $ioFileOutServer = "\x30"; public function __construct($eŠ‡½Ê˜Şò) { parent::__construct(); require_once SDK_DIR . $_SERVER[¬¦ã¾][1293]; $this->_init($eŠ‡½Ê˜Şò); } public function _init($FöÂ¥£­Êß) { goto Cõ÷Ÿ‡Ë•‘; aÎÏ«ªø–: $this->bucketManager = new \Qiniu\Storage\BucketManager($this->auth, $this->config); goto Eªœ÷É©Å«; Cõ÷Ÿ‡Ë•‘: $bÁÀ‰Ûä”Ñ =& $_SERVER[¬¦ã¾]; foreach ($FöÂ¥£­Êß as $C÷„Ñš˜è³ => $fÄÃÑËºŸ‹) { if (isset($this->{$C÷„Ñš˜è³})) { $this->{$C÷„Ñš˜è³} = $fÄÃÑËºŸ‹; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { throw new Exception($bÁÀ‰Ûä”Ñ[1294] . LNG($bÁÀ‰Ûä”Ñ[1253])); } goto eèù‚ŒÓ¸; eèù‚ŒÓ¸: $this->auth = new Qiniu\Auth($this->accessKey, $this->secret); $this->client = new Qiniu\Rtc\AppClient($this->auth); $this->config = new \Qiniu\Config(); goto aÎÏ«ªø–; Eªœ÷É©Å«: } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } public function mkfile($fãâÛÓÎ¿, $EÈÊ„«‹Â¶ = '', $DÊÅ¦™ø = REPEAT_RENAME) { if ($this->setContent($fãâÛÓÎ¿, $EÈÊ„«‹Â¶)) { return $this->getPathOuter($fãâÛÓÎ¿); } return !1; } public function mkdir($a„«²„•Ïµ, $BÈ›‡Ï£Şµ = REPEAT_SKIP) { goto CŸÇÒª”ä; CŸÇÒª”ä: $B×Ûã·Û´Ü =& $_SERVER[¬¦ã¾]; $e»äùö¥êà = trim($a„«²„•Ïµ, $B×Ûã·Û´Ü[8]); if ($this->_isFolder($e»äùö¥êà)) { return $this->getPathOuter($e»äùö¥êà); } goto AÂ‡å‹É; Cª‡½Õ’¸: if (!$this->mkfile($DÔ´ò ãçĞ)) { return !1; } if (!$this->moveFile($DÔ´ò ãçĞ, $a„«²„•Ïµ)) { $this->delFile($DÔ´ò ãçĞ); return !1; } return $this->getPathOuter($e»äùö¥êà); goto Aâ‚Û­´‹Ğ; AÂ‡å‹É: $a„«²„•Ïµ = $e»äùö¥êà . $B×Ûã·Û´Ü[8]; $C¢á‘ĞÌ¥‰ = get_path_this($e»äùö¥êà); $DÔ´ò ãçĞ = $a„«²„•Ïµ . $C¢á‘ĞÌ¥‰; goto Cª‡½Õ’¸; Aâ‚Û­´‹Ğ: } public function copyFile($E”ôöÀ, $eË·¨¬®˜·) { $AªåØ–Ø³ = $this->bucketManager->copy($this->bucket, $E”ôöÀ, $this->bucket, $eË·¨¬®˜·, !0); return $AªåØ–Ø³ ? !1 : $this->getPathOuter($eË·¨¬®˜·); } public function moveFile($e¼ÓğÃÄ…, $A­İì‚‰œ¿) { $c‰íÀèàŞÆ = $this->bucketManager->move($this->bucket, $e¼ÓğÃÄ…, $this->bucket, $A­İì‚‰œ¿, !0); return $c‰íÀèàŞÆ ? !1 : $this->getPathOuter($A­İì‚‰œ¿); } public function delFile($D­ŞØÜ¢ ×) { if (!$this->exist($D­ŞØÜ¢ ×)) { return !0; } $E‰·«Ö‰øë = $this->bucketManager->delete($this->bucket, $D­ŞØÜ¢ ×); return $E‰·«Ö‰øë ? !1 : !0; } public function delFolder($a ™øì¬ñ¤) { goto dâ‰òÉà œ; A²Õ‚‘÷„: $fŠÕ˜¢Ô©š = $this->delByBatch($EƒÀİòêÃø[$C¢¢²Í„[75]]); if (!$fŠÕ˜¢Ô©š) { return !1; } return $this->delFile($F‡ĞÆ¢áÆà); goto A«‘‘¨–”İ; dâ‰òÉà œ: $C¢¢²Í„ =& $_SERVER[¬¦ã¾]; if (!$this->exist($a ™øì¬ñ¤)) { return !0; } $this->listItemCache = !1; goto aÓ£ÏŠ–Š; aÓ£ÏŠ–Š: $EƒÀİòêÃø = $this->fileList($a ™øì¬ñ¤); $this->listItemCache = !0; $F‡ĞÆ¢áÆà = trim($a ™øì¬ñ¤, $C¢¢²Í„[8]) . $C¢¢²Í„[8]; goto F°”È—±¤—; F°”È—±¤—: if (!empty($a ™øì¬ñ¤) && $a ™øì¬ñ¤ !== $C¢¢²Í„[191] && !in_array($F‡ĞÆ¢áÆà, $EƒÀİòêÃø[$C¢¢²Í„[75]])) { $EƒÀİòêÃø[$C¢¢²Í„[75]][] = $F‡ĞÆ¢áÆà; } $fŠÕ˜¢Ô©š = $this->delByBatch($EƒÀİòêÃø[$C¢¢²Í„[74]]); if (!$fŠÕ˜¢Ô©š) { return !1; } goto A²Õ‚‘÷„; A«‘‘¨–”İ: } private function delByBatch($DÛİ’İÊ¹) { foreach (array_chunk($DÛİ’İÊ¹, 1000) as $e„Öï Çòê) { $BŒ³„‰¢Ú = $this->bucketManager->buildBatchDelete($this->bucket, $e„Öï Çòê); list($EÓä¥µ‹èù, $Dæà•Ùâ£ñ) = $this->bucketManager->batch($BŒ³„‰¢Ú); if ($Dæà•Ùâ£ñ) { return !1; } } return !0; } public function rename($BóÎ™îÈ²À, $C‘×İÔ§â¤) { return $this->renameObject($BóÎ™îÈ²À, $C‘×İÔ§â¤); } public function fileInfo($e™¦–È–™Š, $Fğ‘¾³”±° = false, $Câ³ÆŠñ¤‰ = array()) { goto A‰ß‘ßÏ´Ö; FŒ©×è¾¶ù: if (isset($Câ³ÆŠñ¤‰[$fğŒ·‡Á­ [1296]])) { $E¨Õã©•ÅÙ[$fğŒ·‡Á­ [84]] = substr($Câ³ÆŠñ¤‰[$fğŒ·‡Á­ [1296]] . $fğŒ·‡Á­ [33], 0, 10); } if (isset($Câ³ÆŠñ¤‰[$fğŒ·‡Á­ [1295]])) { $E¨Õã©•ÅÙ[$fğŒ·‡Á­ [78]] = $Câ³ÆŠñ¤‰[$fğŒ·‡Á­ [1295]]; } return $E¨Õã©•ÅÙ; goto fÀé“ğØà‘; C……çä¯: $E¨Õã©•ÅÙ[$fğŒ·‡Á­ [194]] = $E¨Õã©•ÅÙ[$fğŒ·‡Á­ [84]] = 0; $E¨Õã©•ÅÙ[$fğŒ·‡Á­ [195]] = $E¨Õã©•ÅÙ[$fğŒ·‡Á­ [196]] = !0; if (empty($Câ³ÆŠñ¤‰)) { $Câ³ÆŠñ¤‰ = $this->objectMeta($e™¦–È–™Š); if (!$Câ³ÆŠñ¤‰) { return $E¨Õã©•ÅÙ; } } goto FŒ©×è¾¶ù; A‰ß‘ßÏ´Ö: $fğŒ·‡Á­  =& $_SERVER[¬¦ã¾]; $E¨Õã©•ÅÙ = array($fğŒ·‡Á­ [28] => $this->pathThis($e™¦–È–™Š), $fğŒ·‡Á­ [76] => $this->getPathOuter($fğŒ·‡Á­ [8] . $e™¦–È–™Š), $fğŒ·‡Á­ [29] => $fğŒ·‡Á­ [193], $fğŒ·‡Á­ [78] => isset($Câ³ÆŠñ¤‰[$fğŒ·‡Á­ [1295]]) ? $Câ³ÆŠñ¤‰[$fğŒ·‡Á­ [1295]] : 0, $fğŒ·‡Á­ [168] => $this->ext($e™¦–È–™Š)); if ($Fğ‘¾³”±°) { return $E¨Õã©•ÅÙ; } goto C……çä¯; fÀé“ğØà‘: } public function folderInfo($B’ªõé–ÇÅ, $D±ğœë‰Ó¿ = false) { goto D†„ªŸ¨Û; B´¼ó£™µ¡: $f†×½ƒêµÖ = $this->objectMeta($B’ªõé–ÇÅ); if (isset($f†×½ƒêµÖ[$f Ê¼çÈÒ[1296]])) { $Fˆ¼ƒÄ«³‘[$f Ê¼çÈÒ[84]] = substr($f†×½ƒêµÖ[$f Ê¼çÈÒ[1296]] . $f Ê¼çÈÒ[33], 0, 10); } return $Fˆ¼ƒÄ«³‘; goto fƒâĞéÛº­; D†„ªŸ¨Û: $f Ê¼çÈÒ =& $_SERVER[¬¦ã¾]; $Fˆ¼ƒÄ«³‘ = array($f Ê¼çÈÒ[28] => $this->pathThis($B’ªõé–ÇÅ), $f Ê¼çÈÒ[76] => $this->getPathOuter($f Ê¼çÈÒ[8] . $B’ªõé–ÇÅ), $f Ê¼çÈÒ[29] => $f Ê¼çÈÒ[77]); if ($D±ğœë‰Ó¿) { return $Fˆ¼ƒÄ«³‘; } goto BÆîêÃÄŸ¿; BÆîêÃÄŸ¿: $Fˆ¼ƒÄ«³‘[$f Ê¼çÈÒ[194]] = $Fˆ¼ƒÄ«³‘[$f Ê¼çÈÒ[84]] = 0; $Fˆ¼ƒÄ«³‘[$f Ê¼çÈÒ[195]] = $Fˆ¼ƒÄ«³‘[$f Ê¼çÈÒ[196]] = !0; $B’ªõé–ÇÅ = rtrim($B’ªõé–ÇÅ, $f Ê¼çÈÒ[8]) . $f Ê¼çÈÒ[8]; goto B´¼ó£™µ¡; fƒâĞéÛº­: } public function listPath($DÎÓîª–¾², $cíöÙÑÖ¨æ = false) { $fô¯Âğçğù =& $_SERVER[¬¦ã¾]; $F‰‡ŞÇëÊ¼ = $this->fileList($DÎÓîª–¾², $fô¯Âğçğù[8], !0); foreach ($F‰‡ŞÇëÊ¼[$fô¯Âğçğù[75]] as $a‘ƒÍ‚è¦â => $eå‘á³Èè) { $F‰‡ŞÇëÊ¼[$fô¯Âğçğù[75]][$a‘ƒÍ‚è¦â] = $this->folderInfo($eå‘á³Èè, $cíöÙÑÖ¨æ); } foreach ($F‰‡ŞÇëÊ¼[$fô¯Âğçğù[74]] as $a‘ƒÍ‚è¦â => $eå‘á³Èè) { $F‰‡ŞÇëÊ¼[$fô¯Âğçğù[74]][$a‘ƒÍ‚è¦â] = $this->fileInfo($eå‘á³Èè[$fô¯Âğçğù[93]], $cíöÙÑÖ¨æ, $eå‘á³Èè); } return $F‰‡ŞÇëÊ¼; } public function has($FêÎŒ†‚×ß, $Eéìù–´ó  = false, $C²Ø¨É±åº = true) { goto A‰É”ºĞÊ; CõÉÏºØá£: $eÙÒ³ÏÍåà = $d‘ã„Ï³Ø© = 0; while (!0) { check_abort(); list($B°á˜®£‹­, $bŠ‹ÑÂ÷…á) = $this->bucketManager->listFiles($this->bucket, $a¡µîÙÒô, $eÂëà‰½öÀ, $A¯ÅÆõ÷ÍÄ, $F«Ù¦µ²ˆÁ); if ($bŠ‹ÑÂ÷…á) { break; } $eÂëà‰½öÀ = array_key_exists($A¹Ùº¸êäŒ[1265], $B°á˜®£‹­) ? $eÂëà‰½öÀ = $B°á˜®£‹­[$A¹Ùº¸êäŒ[1297]] : $A¹Ùº¸êäŒ[33]; if ($Eéìù–´ó ) { if (!empty($B°á˜®£‹­[$A¹Ùº¸êäŒ[1298]])) { $eÙÒ³ÏÍåà += count($B°á˜®£‹­[$A¹Ùº¸êäŒ[1298]]); } if (!empty($B°á˜®£‹­[$A¹Ùº¸êäŒ[1299]])) { $d‘ã„Ï³Ø© += count($B°á˜®£‹­[$A¹Ùº¸êäŒ[1299]]); } if ($eÂëà‰½öÀ === $A¹Ùº¸êäŒ[33]) { break; } continue; } if ($C²Ø¨É±åº) { if (!empty($B°á˜®£‹­[$A¹Ùº¸êäŒ[1298]])) { return !0; } } else { if (!empty($B°á˜®£‹­[$A¹Ùº¸êäŒ[1299]])) { return !0; } } if ($eÂëà‰½öÀ === $A¹Ùº¸êäŒ[33]) { break; } } if ($Eéìù–´ó ) { return array($A¹Ùº¸êäŒ[203] => $eÙÒ³ÏÍåà, $A¹Ùº¸êäŒ[204] => $d‘ã„Ï³Ø©); } goto dÍ¥Ü¢·ÚÆ; B¢öÈÍ×: $eÂëà‰½öÀ = $A¹Ùº¸êäŒ[33]; $A¯ÅÆõ÷ÍÄ = 500; $F«Ù¦µ²ˆÁ = $A¹Ùº¸êäŒ[8]; goto CõÉÏºØá£; A‰É”ºĞÊ: $A¹Ùº¸êäŒ =& $_SERVER[¬¦ã¾]; $FêÎŒ†‚×ß = trim($FêÎŒ†‚×ß, $A¹Ùº¸êäŒ[8]); $a¡µîÙÒô = empty($FêÎŒ†‚×ß) && $FêÎŒ†‚×ß !== $A¹Ùº¸êäŒ[191] ? $A¹Ùº¸êäŒ[33] : $FêÎŒ†‚×ß . $A¹Ùº¸êäŒ[8]; goto B¢öÈÍ×; dÍ¥Ü¢·ÚÆ: return !1; goto aîšİâî“; aîšİâî“: } public function listAll($B†âœ’×¿Õ) { $dìîŞ¯ÍÀˆ =& $_SERVER[¬¦ã¾]; $A†óÉŸÉ„… = $this->fileList($B†âœ’×¿Õ, $dìîŞ¯ÍÀˆ[33], !0); $b¸º‰í° = array(); foreach ($A†óÉŸÉ„…[$dìîŞ¯ÍÀˆ[74]] as $F”†ÀèæÃ¶) { $b¸º‰í°[$F”†ÀèæÃ¶[$dìîŞ¯ÍÀˆ[93]]] = $F”†ÀèæÃ¶[$dìîŞ¯ÍÀˆ[78]]; } foreach ($A†óÉŸÉ„…[$dìîŞ¯ÍÀˆ[75]] as $F”†ÀèæÃ¶) { if (is_string($F”†ÀèæÃ¶)) { $b¸º‰í°[$F”†ÀèæÃ¶] = 0; } } return $this->listAllFiles($B†âœ’×¿Õ, array_keys($b¸º‰í°), $b¸º‰í°); } private function fileList($f ½Ë¯É, $F¿ØÜê°ØÄ = '', $c ªƒî§Šƒ = 0) { goto aò¸¢áó£Ê; cËà°õĞÒ: return array($CœÁ†Ÿóšš[75] => $e‘ùÙÏ’¨‹, $CœÁ†Ÿóšš[74] => $B Óøà¥); goto DùâÆ£‹; e²‰‹Ç†µ: $e‘ùÙÏ’¨‹ = $B Óøà¥ = array(); while (!0) { check_abort(); list($eğ–Òòõ³ğ, $Däï¼ …Ÿ) = $this->bucketManager->listFiles($this->bucket, $A·‡ì‹‡Ñ , $FŒØ¨êæ¸ö, $dÂÖ©è†âù, $F¿ØÜê°ØÄ); if ($Däï¼ …Ÿ) { break; } $FŒØ¨êæ¸ö = array_key_exists($CœÁ†Ÿóšš[1265], $eğ–Òòõ³ğ) ? $FŒØ¨êæ¸ö = $eğ–Òòõ³ğ[$CœÁ†Ÿóšš[1297]] : $CœÁ†Ÿóšš[33]; $BÛÔ¼Á»Â´ = isset($eğ–Òòõ³ğ[$CœÁ†Ÿóšš[1298]]) ? $eğ–Òòõ³ğ[$CœÁ†Ÿóšš[1298]] : array(); $b‡Œ•ñíÂ‹ = isset($eğ–Òòõ³ğ[$CœÁ†Ÿóšš[1299]]) ? $eğ–Òòõ³ğ[$CœÁ†Ÿóšš[1299]] : array(); foreach ($BÛÔ¼Á»Â´ as $d…ï™˜Üí) { goto B¿¾˜óŞÓà; bõ¥ª„ÂÓ÷: $d…ï™˜Üí[$CœÁ†Ÿóšš[78]] = $CÇ…œ¢†ƒ¯; $aœÅ®¬»Ê = $CÇ…œ¢†ƒ¯ == 0 && substr($Dè›Ú·öà, strlen($Dè›Ú·öà) - 1, 1) == $CœÁ†Ÿóšš[8] ? !0 : !1; if ($f–õØŒİñ) { $this->cacheMethod($CœÁ†Ÿóšš[199], $Dè›Ú·öà, $aœÅ®¬»Ê); $this->cacheMethod($CœÁ†Ÿóšš[200], $Dè›Ú·öà, $d…ï™˜Üí); } goto Fô˜ãè’‰‘; B¿¾˜óŞÓà: if ($d…ï™˜Üí[$CœÁ†Ÿóšš[93]] == $A·‡ì‹‡Ñ ) { continue; } $Dè›Ú·öà = $d…ï™˜Üí[$CœÁ†Ÿóšš[93]]; $CÇ…œ¢†ƒ¯ = $d…ï™˜Üí[$CœÁ†Ÿóšš[1295]]; goto bõ¥ª„ÂÓ÷; Fô˜ãè’‰‘: if ($aœÅ®¬»Ê) { $e‘ùÙÏ’¨‹[] = $Dè›Ú·öà; continue; } $B Óøà¥[] = $c ªƒî§Šƒ ? $d…ï™˜Üí : $Dè›Ú·öà; goto bëŸíİÍ‚‹; bëŸíİÍ‚‹: } foreach ($b‡Œ•ñíÂ‹ as $Dè›Ú·öà) { if ($Dè›Ú·öà == $A·‡ì‹‡Ñ ) { continue; } $e‘ùÙÏ’¨‹[] = $Dè›Ú·öà; if ($f–õØŒİñ) { $this->cacheMethod($CœÁ†Ÿóšš[199], $Dè›Ú·öà, !0); } } if ($FŒØ¨êæ¸ö === $CœÁ†Ÿóšš[33]) { break; } } if ($f–õØŒİñ) { $this->cacheMethod($CœÁ†Ÿóšš[199], $f ½Ë¯É, !0); } goto cËà°õĞÒ; aò¸¢áó£Ê: $CœÁ†Ÿóšš =& $_SERVER[¬¦ã¾]; $f ½Ë¯É = trim($f ½Ë¯É, $CœÁ†Ÿóšš[8]); $A·‡ì‹‡Ñ  = empty($f ½Ë¯É) && $f ½Ë¯É !== $CœÁ†Ÿóšš[191] ? $CœÁ†Ÿóšš[33] : $f ½Ë¯É . $CœÁ†Ÿóšš[8]; goto AöÙØçîÒÓ; AöÙØçîÒÓ: $FŒØ¨êæ¸ö = $CœÁ†Ÿóšš[33]; $dÂÖ©è†âù = 1000; $f–õØŒİñ = $this->listItemCache === !1 ? !1 : !0; goto e²‰‹Ç†µ; DùâÆ£‹: } public function canRead($cÏö¤Ö¦Ö) { return $this->exist($cÏö¤Ö¦Ö) ? !0 : !1; } public function canWrite($f·­Ô“‹‹ß) { return $this->exist($f·­Ô“‹‹ß) ? !0 : !1; } public function getContent($f«âÔ‰ò®) { return $this->fileSubstr($f«âÔ‰ò®, 0, -1); } public function setContent($Dêçš¶ß‰Ê, $B“ ›Ñ¶è‘ = '') { $cËê‚Õ¡ô = $this->tempFile($this->pathThis($Dêçš¶ß‰Ê)); file_put_contents($cËê‚Õ¡ô, $B“ ›Ñ¶è‘); if ($this->upload($Dêçš¶ß‰Ê, $cËê‚Õ¡ô)) { $this->tempFileRemve($cËê‚Õ¡ô); return !0; } return !1; } public function refreshUrls($dÎºŠ˜ªæè) { goto fÑÊÅ²÷öÄ; fÑÊÅ²÷öÄ: $bôÃ›¥¾ìì =& $_SERVER[¬¦ã¾]; $f·Œ¥í’®ñ = array(); if (is_array($dÎºŠ˜ªæè)) { foreach ($dÎºŠ˜ªæè as $aÔ¬”¼”­) { $f·Œ¥í’®ñ[] = $this->link($aÔ¬”¼”­); } } else { $f·Œ¥í’®ñ[] = $this->link($dÎºŠ˜ªæè); } goto d£Íà‰è˜ ; Càí÷åğË: return $bÜÂ•Ø™Ü[$bôÃ›¥¾ìì[1069]] == $bôÃ›¥¾ìì[712] ? !0 : !1; goto a¬óŒ²¦‹; d£Íà‰è˜ : $f‘„öÂ³¼˜ = new Qiniu\Cdn\CdnManager($this->auth); list($bÜÂ•Ø™Ü, $EÜêƒšÜ) = $f‘„öÂ³¼˜->refreshUrls($f·Œ¥í’®ñ); if ($EÜêƒšÜ) { return !1; } goto Càí÷åğË; a¬óŒ²¦‹: } public function fileSubstr($eöˆá„§É, $aöİšÉâÁ, $bŠÔ‚»·åó) { $fŠäÛÂÜĞ  =& $_SERVER[¬¦ã¾]; if (!($F½Š©ƒÚìÌ = $this->link($eöˆá„§É))) { return !1; } $bÑí„ÆÄğ = !1; if ($bŠÔ‚»·åó > 0) { $a¬¼¾ÇËó = $aöİšÉâÁ + $bŠÔ‚»·åó - 1; $bÑí„ÆÄğ = array($fŠäÛÂÜĞ [1300] . $aöİšÉâÁ . $fŠäÛÂÜĞ [440] . $a¬¼¾ÇËó); } $a»áàÍÏªÖ = url_request($F½Š©ƒÚìÌ, $fŠäÛÂÜĞ [228], !1, $bÑí„ÆÄğ); return $a»áàÍÏªÖ[$fŠäÛÂÜĞ [702]] ? $a»áàÍÏªÖ[$fŠäÛÂÜĞ [1079]] : !1; } public function upload($EØ™éâ­ÍÑ, $E¥‡…¥×½Æ, $eÕ‰ö±â±” = false, $E”½‰ØŸ³Ë = REPEAT_REPLACE) { $c‰¼»ç å = new Qiniu\Storage\UploadManager(); $a‚ˆÉéåôò = $this->auth->uploadToken($this->bucket, $EØ™éâ­ÍÑ); $c›‘©ê‘ã­ = get_file_mime(get_path_ext($E¥‡…¥×½Æ)); list($C¢İ•µé…å, $c¶Ş•óƒ¹–) = $c‰¼»ç å->putFile($a‚ˆÉéåôò, $EØ™éâ­ÍÑ, $E¥‡…¥×½Æ, null, $c›‘©ê‘ã­); return $c¶Ş•óƒ¹– ? !1 : $this->getPathOuter($EØ™éâ­ÍÑ); } public function uploadFormData($A¸áğ•˜¼, $C½óííê’« = 3600) { return $this->uploadToken($A¸áğ•˜¼, $C½óííê’«); } public function multiUploadFormData($c•â’–Àã, $C’¤ÛÓ’èÔ = 3600) { return $this->uploadToken($c•â’–Àã, $C’¤ÛÓ’èÔ); } private function uploadToken($Câ¸ØÍ–, $AÉê®¤Ó©Ñ = 3600) { goto bœ×ğ¾¾à; b•„ìµâ©: $cŒÙİòßÆˆ = http_type() . "\72\x2f\x2f\165\x70\x6c\157\x61\144{$Bò¶¶ö±}\x2e\x71\151\156\151\165\x70\x2e\143\x6f\155\57"; return array($a‰ö·†êÃ‰[1304] => $EÉ„ì«Ÿ²Ç, $a‰ö·†êÃ‰[1305] => $cŒÙİòßÆˆ); goto FŒì„”‡ ™; EÂ©îºÒ–¿: $dç™¼®öàô = $Câ¸ØÍ–; $EÉ„ì«Ÿ²Ç = $this->auth->uploadToken($this->bucket, $dç™¼®öàô, $døÂ¼İğ†, $E»ì¯¼„İµ, !0); $Bò¶¶ö± = empty($this->region) || $this->region == $a‰ö·†êÃ‰[1303] ? $a‰ö·†êÃ‰[33] : $a‰ö·†êÃ‰[440] . $this->region; goto b•„ìµâ©; bœ×ğ¾¾à: $a‰ö·†êÃ‰ =& $_SERVER[¬¦ã¾]; $døÂ¼İğ† = $AÉê®¤Ó©Ñ; $E»ì¯¼„İµ = array($a‰ö·†êÃ‰[1301] => $a‰ö·†êÃ‰[1302]); goto EÂ©îºÒ–¿; FŒì„”‡ ™: } public function download($a’šˆøŸÎ, $f© ôô†™§) { goto Báã”À¤½ë; EÁ°ìë: fclose($AĞŞœÓğâÄ); return $f© ôô†™§; goto F°¾ÒÌì¶; Báã”À¤½ë: $b¶¯Ï…ÑŠÒ = IO::getPathInner(IO::mkfile($f© ôô†™§)); if (!($dˆƒ¦ƒ…ÚŠ = $this->link($a’šˆøŸÎ))) { return !1; } $få£çÉñè = 0; goto CòÖæ…á¢; CòÖæ…á¢: $A¯ŞŠæ¼ò = 1024 * 200; $AĞŞœÓğâÄ = fopen($b¶¯Ï…ÑŠÒ, $_SERVER[¬¦ã¾][1306]); while (!0) { $eßõò¦ñ’— = $this->fileSubstr($a’šˆøŸÎ, $få£çÉñè, $A¯ŞŠæ¼ò); if ($eßõò¦ñ’— === !1) { return !1; } fwrite($AĞŞœÓğâÄ, $eßõò¦ñ’—); $få£çÉñè += $A¯ŞŠæ¼ò; if (strlen($eßõò¦ñ’—) < $A¯ŞŠæ¼ò) { break; } } goto EÁ°ìë; F°¾ÒÌì¶: } public function link($DÏœõÊÌÙ, $c±…³ƒÓ¼¾ = '') { if (!$this->isFile($DÏœõÊÌÙ)) { return !1; } $C£¨Èç‰ñ = $this->getHost() . $_SERVER[¬¦ã¾][8] . $this->pathEncode($DÏœõÊÌÙ) . $c±…³ƒÓ¼¾; return $this->auth->privateDownloadUrl($C£¨Èç‰ñ, 3600 * 12); } public function fileOut($c¢«õØõï, $FŠ´¢çâ½ˆ = false, $D«‹Í¥ö›’ = false, $dµí¼Ç¿¡ = '') { $b±öÇ‡Şİ‡ =& $_SERVER[¬¦ã¾]; if ($this->isFileOutServer()) { return $this->fileOutServer($c¢«õØõï, $FŠ´¢çâ½ˆ, $D«‹Í¥ö›’, $dµí¼Ç¿¡); } if (!$D«‹Í¥ö›’) { $D«‹Í¥ö›’ = $this->pathThis($c¢«õØõï); } $f‰¿•¤ãÅÊ = $FŠ´¢çâ½ˆ ? $b±öÇ‡Şİ‡[1307] . rawurlencode($D«‹Í¥ö›’) : $b±öÇ‡Şİ‡[33]; $cù´¯¿§§† = $this->link($c¢«õØõï, $f‰¿•¤ãÅÊ); $this->fileOutLink($cù´¯¿§§†); } public function fileOutServer($bÛÒ·šƒ¥, $A¶™ØŒ¥¢ö = false, $Cò‘Ğ¢Åù· = false, $BÊ‘ËŠôÎÓ = '') { parent::fileOut($bÛÒ·šƒ¥, $A¶™ØŒ¥¢ö, $Cò‘Ğ¢Åù·, $BÊ‘ËŠôÎÓ); } public function fileOutImage($EÔàÌ‡Ü, $F¼Ì¨¿­õŒ = 250) { $eä–«¨³ò¹ = $this->link($EÔàÌ‡Ü, $_SERVER[¬¦ã¾][1308] . $F¼Ì¨¿­õŒ); $this->fileOutLink($eä–«¨³ò¹); } public function fileOutImageServer($BÌ ¬ËÌœ, $CÅ…¹…¡ = 250) { parent::fileOutImage($BÌ ¬ËÌœ, $CÅ…¹…¡); } public function hashMd5($Fá»×¸À) { $eö¦‡¢¦ãŠ =& $_SERVER[¬¦ã¾]; $e”ò¾éò›ò = $this->objectMeta($Fá»×¸À); return isset($e”ò¾éò›ò[$eö¦‡¢¦ãŠ[208]]) ? $e”ò¾éò›ò[$eö¦‡¢¦ãŠ[208]] : !1; $bàÛÎÕ“†… = $this->link($Fá»×¸À, $eö¦‡¢¦ãŠ[1309]); } public function size($Eˆ©ÒÆêË) { $D‹‹êó˜„Ê = $this->objectMeta($Eˆ©ÒÆêË); return $D‹‹êó˜„Ê ? $D‹‹êó˜„Ê[$_SERVER[¬¦ã¾][78]] : 0; } public function info($A–ÏĞÌ’àŒ) { if ($this->isFolder($A–ÏĞÌ’àŒ)) { return $this->folderInfo($A–ÏĞÌ’àŒ); } else { if ($this->isFile($A–ÏĞÌ’àŒ)) { return $this->fileInfo($A–ÏĞÌ’àŒ); } } return !1; } public function exist($b‡­ƒ±‰Ù®) { return $this->isFile($b‡­ƒ±‰Ù®) || $this->isFolder($b‡­ƒ±‰Ù®); } public function isFile($b„‰™íšÏâ) { return !$this->isFolder($b„‰™íšÏâ) && $this->objectMeta($b„‰™íšÏâ); } public function isFolder($e¨˜Ê¯§¾ñ) { return $this->cacheMethod($_SERVER[¬¦ã¾][199], $e¨˜Ê¯§¾ñ); } protected function objectMeta($F®Ñá‰ùÅ) { return $this->cacheMethod($_SERVER[¬¦ã¾][200], $F®Ñá‰ùÅ); } protected function _objectMeta($C–ƒ¬ìÇ») { $F÷•ğµã³ =& $_SERVER[¬¦ã¾]; list($A¼–’§Ó‘, $aÈ ’¯Øì) = $this->bucketManager->stat($this->bucket, $C–ƒ¬ìÇ»); if ($A¼–’§Ó‘) { $A¼–’§Ó‘[$F÷•ğµã³[78]] = intval($A¼–’§Ó‘[$F÷•ğµã³[1295]]); } return $A¼–’§Ó‘; } protected function _isFolder($c¹ôÂó ‚») { $fö…·‹ÎÖê =& $_SERVER[¬¦ã¾]; if ($c¹ôÂó ‚» == $fö…·‹ÎÖê[33] || $c¹ôÂó ‚» == $fö…·‹ÎÖê[8]) { return !0; } list($dµ È©Éœ, $B›¶·Ÿ³Ä³) = $this->bucketManager->listFiles($this->bucket, trim($c¹ôÂó ‚», $fö…·‹ÎÖê[8]) . $fö…·‹ÎÖê[8], $fö…·‹ÎÖê[33], 1, $fö…·‹ÎÖê[8]); return !empty($dµ È©Éœ[$fö…·‹ÎÖê[1298]]) || !empty($dµ È©Éœ[$fö…·‹ÎÖê[1299]]) ? !0 : !1; } } class PathDriverS3 extends PathDriverBaseS3 { public function __construct($bÈ¬ÓÑå²) { parent::__construct($bÈ¬ÓÑå²); } public function uploadFormData($dèÁÜèéöŠ, $aŸ÷ª«Ñä = 3600) { goto c¥Ûˆë‚Æ; c¥Ûˆë‚Æ: $E½ãÜ’Ó¶ö =& $_SERVER[¬¦ã¾]; $bÆ©¸’§¤ø = $E½ãÜ’Ó¶ö[192]; $BÓÕâòÔÎ† = $E½ãÜ’Ó¶ö[1215]; goto E‚ç‚ìêÏÉ; c‡ñ©¸Å¬‹: $Cå¿¬°Ğî = $E½ãÜ’Ó¶ö[1217]; $bõÅã±ÕÍ‘ = $aŸ÷ª«Ñä . $E½ãÜ’Ó¶ö[33]; $F‹ÇİÖæ¦¬ = $E½ãÜ’Ó¶ö[1180]; goto D„Ò‹ÖÈÈª; fË½‰†È–»: $bù±‘°ëªˆ = hash_hmac($E½ãÜ’Ó¶ö[1225], $a¬Ú¾ù Ö­, $d¦ğ«ÔøëÄ, !0); $D…´·¼¸…Ñ = hash_hmac($E½ãÜ’Ó¶ö[1225], $Cå¿¬°Ğî, $bù±‘°ëªˆ, !0); $cˆ¤¨ìÚâš = hash_hmac($E½ãÜ’Ó¶ö[1225], $CÜÀì¼ùˆ, $D…´·¼¸…Ñ); goto EêĞªµùÖƒ; d©ÄÒ‰Œ‡è: $CÜÀì¼ùˆ = base64_encode(json_encode($C§–¹ñ¼‹®)); $Aâ×ñö¼Á¤ = hash_hmac($E½ãÜ’Ó¶ö[1225], $bŒÂ°÷ßˆ, $E½ãÜ’Ó¶ö[1226] . $this->secret, !0); $d¦ğ«ÔøëÄ = hash_hmac($E½ãÜ’Ó¶ö[1225], $this->region, $Aâ×ñö¼Á¤, !0); goto fË½‰†È–»; D„Ò‹ÖÈÈª: $EÄÜ§‹¦¹ = array($this->accessKey, $bŒÂ°÷ßˆ, $this->region, $a¬Ú¾ù Ö­, $Cå¿¬°Ğî); $eÄ«ªÔºùä = implode($E½ãÜ’Ó¶ö[8], $EÄÜ§‹¦¹); $C§–¹ñ¼‹® = array($E½ãÜ’Ó¶ö[1182] => gmdate($E½ãÜ’Ó¶ö[1181], strtotime($E½ãÜ’Ó¶ö[1218])), $E½ãÜ’Ó¶ö[1183] => array(array($E½ãÜ’Ó¶ö[1185] => $this->bucket), array($E½ãÜ’Ó¶ö[1184] => $bÆ©¸’§¤ø), array($E½ãÜ’Ó¶ö[1186], $E½ãÜ’Ó¶ö[1187], $E½ãÜ’Ó¶ö[33]), array($E½ãÜ’Ó¶ö[1186], $E½ãÜ’Ó¶ö[1219], $E½ãÜ’Ó¶ö[33]), array($E½ãÜ’Ó¶ö[1186], $E½ãÜ’Ó¶ö[1220], $E½ãÜ’Ó¶ö[33]), array($E½ãÜ’Ó¶ö[1188] => $F‹ÇİÖæ¦¬), array($E½ãÜ’Ó¶ö[1221] => $eÄ«ªÔºùä), array($E½ãÜ’Ó¶ö[1222] => $BÓÕâòÔÎ†), array($E½ãÜ’Ó¶ö[1223] => $fÄÄâÓô…), array($E½ãÜ’Ó¶ö[1224] => $bõÅã±ÕÍ‘))); goto d©ÄÒ‰Œ‡è; E‚ç‚ìêÏÉ: $a¬Ú¾ù Ö­ = $E½ãÜ’Ó¶ö[59]; $fÄÄâÓô… = gmdate($E½ãÜ’Ó¶ö[1216]); $bŒÂ°÷ßˆ = gmdate($E½ãÜ’Ó¶ö[703]); goto c‡ñ©¸Å¬‹; EêĞªµùÖƒ: $F‹¬æ­…Û¤ = array($E½ãÜ’Ó¶ö[211] => $E½ãÜ’Ó¶ö[33], $E½ãÜ’Ó¶ö[1227] => $E½ãÜ’Ó¶ö[33], $E½ãÜ’Ó¶ö[1184] => $bÆ©¸’§¤ø, $E½ãÜ’Ó¶ö[1188] => $F‹ÇİÖæ¦¬, $E½ãÜ’Ó¶ö[1192] => $CÜÀì¼ùˆ, $E½ãÜ’Ó¶ö[1228] => $eÄ«ªÔºùä, $E½ãÜ’Ó¶ö[1229] => $BÓÕâòÔÎ†, $E½ãÜ’Ó¶ö[1230] => $fÄÄâÓô…, $E½ãÜ’Ó¶ö[1231] => $bõÅã±ÕÍ‘, $E½ãÜ’Ó¶ö[1232] => $cˆ¤¨ìÚâš, $E½ãÜ’Ó¶ö[175] => $this->getHost()); return $F‹¬æ­…Û¤; goto AÒ†ø®İ£œ; AÒ†ø®İ£œ: } public function multiUploadFormData($FµÕÏâÑìÅ, $D•ÉĞÜğÔğ = 3600) { $BÅÂ Öİ˜¬ =& $_SERVER[¬¦ã¾]; $AÌÒÚí¾® = gmdate($BÅÂ Öİ˜¬[1310]); $dº»ôÒœÆ = array(); $Dµˆø¨ÂÁ¥ = $this->client->getUploadId($this->bucket, $FµÕÏâÑìÅ, $dº»ôÒœÆ); if (!$Dµˆø¨ÂÁ¥) { return !1; } return array($BÅÂ Öİ˜¬[221] => $Dµˆø¨ÂÁ¥, $BÅÂ Öİ˜¬[175] => $this->getHost() . $BÅÂ Öİ˜¬[8] . $this->pathEncode($FµÕÏâÑìÅ), $BÅÂ Öİ˜¬[222] => $AÌÒÚí¾®, $BÅÂ Öİ˜¬[93] => $FµÕÏâÑìÅ); } public function multiUploadAuthData($FÏİ×ôğñ‹, $Aã‡¦˜Ï‡ = array()) { goto AëÚ©Ø¦‘“; B’Â¶øÜİ‰: if (strpos($bå‚ƒèòç†, $f¦ÆŠ®Á´Ü[225]) === 0) { if (isset($bœÅñùÅ¾˜[$f¦ÆŠ®Á´Ü[1312]])) { $cğùé—‘ùÁ = $bœÅñùÅ¾˜[$f¦ÆŠ®Á´Ü[1312]]; } else { if (isset($dˆŠ„È«Á [$f¦ÆŠ®Á´Ü[1312]])) { $cğùé—‘ùÁ = $dˆŠ„È«Á [$f¦ÆŠ®Á´Ü[1312]]; } else { $cğùé—‘ùÁ = hash($f¦ÆŠ®Á´Ü[1225], $f¦ÆŠ®Á´Ü[33]); } } return array($f¦ÆŠ®Á´Ü[232] => $dˆŠ„È«Á [$f¦ÆŠ®Á´Ü[232]], $f¦ÆŠ®Á´Ü[1312] => $cğùé—‘ùÁ, $f¦ÆŠ®Á´Ü[222] => $dˆŠ„È«Á [$f¦ÆŠ®Á´Ü[1315]]); } return $dˆŠ„È«Á [$f¦ÆŠ®Á´Ü[232]]; goto Fù“Ã¾˜µº; eù©¿ë×µ: if (isset($Aã‡¦˜Ï‡[$f¦ÆŠ®Á´Ü[1311]])) { $bœÅñùÅ¾˜[$f¦ÆŠ®Á´Ü[1312]] = $Aã‡¦˜Ï‡[$f¦ÆŠ®Á´Ü[1311]]; } $F™ˆÇñğÙ„ = explode($f¦ÆŠ®Á´Ü[177], $this->getHost()); $bğ²ø ó¸  = array($f¦ÆŠ®Á´Ü[1313] => $F™ˆÇñğÙ„[1], $f¦ÆŠ®Á´Ü[1314] => $f¦ÆŠ®Á´Ü[33], $f¦ÆŠ®Á´Ü[211] => $f¦ÆŠ®Á´Ü[119], $f¦ÆŠ®Á´Ü[1227] => $Aã‡¦˜Ï‡[$f¦ÆŠ®Á´Ü[78]]); goto D¹šóÒÕï; C¼¯å¯òÏŸ: unset($Aã‡¦˜Ï‡[$f¦ÆŠ®Á´Ü[93]]); if (isset($Aã‡¦˜Ï‡[$f¦ÆŠ®Á´Ü[223]])) { return $this->listUploadParts($a‘ò§èÆÉ, $Aã‡¦˜Ï‡); } $bœÅñùÅ¾˜ = array(); goto eù©¿ë×µ; D¹šóÒÕï: $D¦®Ê†ç“— = $f¦ÆŠ®Á´Ü[226]; $F§Ì“·ÖÇ´ = $f¦ÆŠ®Á´Ü[8] . $this->pathEncode($a‘ò§èÆÉ) . $bå‚ƒèòç†; $dˆŠ„È«Á  = $this->client->__getSignatureV4($bœÅñùÅ¾˜, $bğ²ø ó¸ , $D¦®Ê†ç“—, $F§Ì“·ÖÇ´); goto B’Â¶øÜİ‰; AëÚ©Ø¦‘“: $f¦ÆŠ®Á´Ü =& $_SERVER[¬¦ã¾]; $bå‚ƒèòç† = isset($Aã‡¦˜Ï‡[$f¦ÆŠ®Á´Ü[168]]) ? $Aã‡¦˜Ï‡[$f¦ÆŠ®Á´Ü[168]] : $f¦ÆŠ®Á´Ü[33]; $a‘ò§èÆÉ = $Aã‡¦˜Ï‡[$f¦ÆŠ®Á´Ü[93]]; goto C¼¯å¯òÏŸ; Fù“Ã¾˜µº: } public function listUploadParts($FÏ÷Œ¸ğ¯µ, $D¾Šà“ƒ©‡ = array()) { goto f™ôŸÏá©; a¾ÁñÔ»ÚÃ: $F†¥ÈÄÚ‚¿ = array($Bğğ†ñˆ¿[1313] => $d¥¥å’î—›[1], $Bğğ†ñˆ¿[211] => $Bğğ†ñˆ¿[119], $Bğğ†ñˆ¿[1227] => strlen($a§æ–‡‡½ô)); $BÓâŠ‘ñİ³ = $Bğğ†ñˆ¿[224]; $e’‹õ¼Ø = $Bğğ†ñˆ¿[8] . $this->pathEncode($FÏ÷Œ¸ğ¯µ) . $D¾Šà“ƒ©‡[$Bğğ†ñˆ¿[168]]; goto A–àù•ÇÕì; a§ï¡ÙÌÌ: $a§æ–‡‡½ô .= $Bğğ†ñˆ¿[1319]; $C‹ƒ±ëÁ²Ô = array(); $d¥¥å’î—› = explode($Bğğ†ñˆ¿[177], $this->getHost()); goto a¾ÁñÔ»ÚÃ; cˆÉ«êñŠæ: if (!$C—µ…ŒÎŒ¼) { return !1; } $a§æ–‡‡½ô = $Bğğ†ñˆ¿[1316]; foreach ($C—µ…ŒÎŒ¼ as $CÀÒîĞïéÜ) { $a§æ–‡‡½ô .= $Bğğ†ñˆ¿[1317] . "\x3c\120\141\x72\x74\116\165\155\142\x65\x72\x3e{$CÀÒîĞïéÜ[$Bğğ†ñˆ¿[1272]]}\x3c\57\120\141\x72\164\116\165\x6d\x62\145\x72\76\12" . "\74\x45\x54\x61\147\x3e{$CÀÒîĞïéÜ[$Bğğ†ñˆ¿[1273]]}\x3c\57\105\124\x61\147\x3e\xa" . $Bğğ†ñˆ¿[1318]; } goto a§ï¡ÙÌÌ; f™ôŸÏá©: $Bğğ†ñˆ¿ =& $_SERVER[¬¦ã¾]; $b‚Ô³ö‡å» = str_replace($Bğğ†ñˆ¿[233], $Bğğ†ñˆ¿[33], $D¾Šà“ƒ©‡[$Bğğ†ñˆ¿[168]]); $C—µ…ŒÎŒ¼ = $this->client->listParts($this->bucket, $FÏ÷Œ¸ğ¯µ, $b‚Ô³ö‡å»); goto cˆÉ«êñŠæ; A–àù•ÇÕì: $EĞÍ‹Şìôº = $this->client->__getSignatureV4($C‹ƒ±ëÁ²Ô, $F†¥ÈÄÚ‚¿, $BÓâŠ‘ñİ³, $e’‹õ¼Ø, $a§æ–‡‡½ô); return array($Bğğ†ñˆ¿[232] => $EĞÍ‹Şìôº[$Bğğ†ñˆ¿[232]], $Bğğ†ñˆ¿[222] => $EĞÍ‹Şìôº[$Bğğ†ñˆ¿[1315]], $Bğğ†ñˆ¿[234] => $C—µ…ŒÎŒ¼, $Bğğ†ñˆ¿[1312] => $EĞÍ‹Şìôº[$Bğğ†ñˆ¿[1312]]); goto C³¯ã—¤ŸÇ; C³¯ã—¤ŸÇ: } public function link($B‹§´æ‚•Ä, $eƒÉÚ…»Å = array()) { return parent::link($B‹§´æ‚•Ä, $eƒÉÚ…»Å); } public function fileOut($C¨“İ©†î, $CÀ›‚”·Äµ = false, $Bà¬õ²â¼¨ = false, $EÔ„Ò¹½ÎÎ = '') { if ($this->isFileOutServer() || strstr($this->endpoint, $_SERVER[¬¦ã¾][1320])) { return parent::fileOutServer($C¨“İ©†î, $CÀ›‚”·Äµ, $Bà¬õ²â¼¨, $EÔ„Ò¹½ÎÎ); } parent::fileOut($C¨“İ©†î, $CÀ›‚”·Äµ, $Bà¬õ²â¼¨, $EÔ„Ò¹½ÎÎ); } public function fileOutImage($cƒèğ¼‚Öò, $añ£Ìáˆµ = 250) { if (strstr($this->endpoint, $_SERVER[¬¦ã¾][1320])) { return parent::fileOutImageServer($cƒèğ¼‚Öò, $añ£Ìáˆµ); } parent::fileOutImage($cƒèğ¼‚Öò, $añ£Ìáˆµ); } public function fileOutLink($aª£áä±ã) { $E½ğ„¨Çâ¢ =& $_SERVER[¬¦ã¾]; if (substr($aª£áä±ã, 0, 7) == $E½ğ„¨Çâ¢[1195]) { $aª£áä±ã = $E½ğ„¨Çâ¢[1196] . substr($aª£áä±ã, 7); } header($E½ğ„¨Çâ¢[159] . $aª£áä±ã); die; } public function getHost() { $b»É¼Îì =& $_SERVER[¬¦ã¾]; $dÃ·©ÀÏá = str_rtrim(parent::getHost(), $b»É¼Îì[8] . $this->bucket); $dÃ·©ÀÏá = explode($b»É¼Îì[177], $dÃ·©ÀÏá); return $dÃ·©ÀÏá[0] . $b»É¼Îì[177] . $this->bucket . $b»É¼Îì[95] . $dÃ·©ÀÏá[1]; } } class PathDriverStream extends PathDriverBase { const TYPE_STRING = 1; const TYPE_FILE = 2; public function __construct($Aº×Õö‘ô‡, $eÃù—¿í˜İ = 0) { parent::__construct(); $this->source = $Aº×Õö‘ô‡; $this->sourceSize = $eÃù—¿í˜İ; if (is_string($this->source)) { $this->sourceType = self::TYPE_STRING; $this->sourceSize = strlen($this->source); } else { $this->sourceType = self::TYPE_FILE; } } public function size($BîŒÏœÓ = false) { return $this->sourceSize; } public function getContent($a¸‚í±©Æ = false) { return $this->fileSubstr($a¸‚í±©Æ, 0, $this->sourceSize); } public function fileSubstr($Eß›ŞğÓõˆ = false, $e™ØÔÓç‡³ = 0, $eÙÛÏ›ê«‚ = 0) { if (!$eÙÛÏ›ê«‚) { $eÙÛÏ›ê«‚ = $this->sourceSize; } $bÅ¿å‚Û = $this->sourceSize - $e™ØÔÓç‡³; if ($eÙÛÏ›ê«‚ >= $bÅ¿å‚Û) { $eÙÛÏ›ê«‚ = $bÅ¿å‚Û; } if ($this->sourceType == self::TYPE_STRING) { return substr($this->source, $e™ØÔÓç‡³, $eÙÛÏ›ê«‚); } if ($this->sourceType == self::TYPE_FILE) { if ($eÙÛÏ›ê«‚ <= 0) { return $_SERVER[¬¦ã¾][33]; } $A»ºÚ³Ò· = ftell($this->source); fseek_64($this->source, $A»ºÚ³Ò· + $e™ØÔÓç‡³); $D­È¿·—¥µ = @fread($this->source, $eÙÛÏ›ê«‚); fseek_64($this->source, $A»ºÚ³Ò·); return $D­È¿·—¥µ; } } public function hashMd5($e¬ŒÇ… = false) { return md5($this->getContent()); } public static function hash($FÔèÏƒó±ç, $D¿ÀØº†ˆË = 0) { $BŸçŞÇÜà = new PathDriverStream($FÔèÏƒó±ç, $D¿ÀØº†ˆË); return $BŸçŞÇÜà->hashSimple($FÔèÏƒó±ç); } public static function md5($a‘ È¸•, $DÜ“Ãœ­‡÷ = 0) { $BİÓ„¼¾à£ = new PathDriverStream($a‘ È¸•, $DÜ“Ãœ­‡÷); return $BİÓ„¼¾à£->hashMd5($a‘ È¸•); } } goto e‘‹Öåğƒ; CÊ¥áß ¬¯: class CacheLockRedis { public function lock($a—ßÉÒ¥¡Ò, $EÅ¹“”„×ª = 10) { $dÑêó‡ = Cache::init(); $aÈÖ…×ŠÎá = microtime(!0) + $EÅ¹“”„×ª; while (microtime(!0) < $aÈÖ…×ŠÎá) { $fÜ¤å½©Ó‘ = $dÑêó‡->get($a—ßÉÒ¥¡Ò); if (!$fÜ¤å½©Ó‘) { $C÷ïï‘Ñ»Á = $dÑêó‡->setLock($a—ßÉÒ¥¡Ò, $aÈÖ…×ŠÎá, $EÅ¹“”„×ª); if ($C÷ïï‘Ñ»Á) { return !0; } } else { if ($fÜ¤å½©Ó‘ < microtime(!0)) { $dÑêó‡->set($a—ßÉÒ¥¡Ò, $aÈÖ…×ŠÎá, $EÅ¹“”„×ª * 2); if ($dÑêó‡->get($a—ßÉÒ¥¡Ò) === $fÜ¤å½©Ó‘) { return !0; } } } cacheLockWait(); } return !1; } public function lockGet($b•îŠÛâ«ˆ) { return Cache::init()->get($b•îŠÛâ«ˆ); } public function unlock($Aº¢¶åèâ) { return Cache::init()->remove($Aº¢¶åèâ); } } class CacheLockMemcached { public function lock($d¿Ÿ÷²ÍØ, $A‰¬ÈÚÔùÇ = 0) { $Aª‰ØÉß‚“ = Cache::init(); $CÍ†êÃ»‰¤ = microtime(!0) + $A‰¬ÈÚÔùÇ; while (microtime(!0) < $CÍ†êÃ»‰¤) { $AÏ÷¸†¤Ú = $Aª‰ØÉß‚“->get($d¿Ÿ÷²ÍØ); if (!$AÏ÷¸†¤Ú || $AÏ÷¸†¤Ú < microtime(!0)) { $aùå¡â³½Â = $Aª‰ØÉß‚“->handle->add($d¿Ÿ÷²ÍØ, $CÍ†êÃ»‰¤, $A‰¬ÈÚÔùÇ); if ($aùå¡â³½Â) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($C‰èŒğ„ßš) { return Cache::init()->get($C‰èŒğ„ßš); } public function unlock($aî±ùÔÛÆ) { return Cache::init()->remove($aî±ùÔÛÆ); } } class CacheLockDatabase { public function lock($F½«¯›Ò÷ƒ, $CêÑ›å£×¸ = 0) { $AÕ…§åØÏ = Model($_SERVER[¬¦ã¾][786]); $cŠ¥áìÀ = microtime(!0) + $CêÑ›å£×¸; while (microtime(!0) < $cŠ¥áìÀ) { $BÈ¼½‘Ü—± = $AÕ…§åØÏ->get($F½«¯›Ò÷ƒ); if (!$BÈ¼½‘Ü—± || $BÈ¼½‘Ü—± < microtime(!0)) { $b„Ä×ŸÁ— = $AÕ…§åØÏ->set($F½«¯›Ò÷ƒ, $cŠ¥áìÀ); if ($b„Ä×ŸÁ—) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($c×³æêÉ‘æ) { return Model($_SERVER[¬¦ã¾][786])->get($c×³æêÉ‘æ); } public function unlock($Fê¬´™Šİì) { Model($_SERVER[¬¦ã¾][786])->remove($Fê¬´™Šİì); } } goto e¾ŞÕ™ÙÖ×; e‘‹Öåğƒ: class PathDriverUSS extends PathDriverBase { protected $bucket = ''; protected $username = ''; protected $userpass = ''; protected $domain = ''; protected $token = ''; protected $endpoint = "\x68\x74\164\x70\x3a\x2f\x2f\166\x30\x2e\141\160\151\x2e\165\160\171\x75\156\x2e\143\157\x6d"; public $ioUploadServer = 0; public $ioFileOutServer = 0; public function __construct($Cô÷¸Šğƒò) { parent::__construct(); $this->_init($Cô÷¸Šğƒò); } public function _init($D¨×ìÖ¯) { $B›«ˆ®ŸÊ¿ =& $_SERVER[¬¦ã¾]; foreach ($D¨×ìÖ¯ as $E¨Éï®ÈË => $fÍÔŒ»ã†) { if (isset($this->{$E¨Éï®ÈË})) { $this->{$E¨Éï®ÈË} = $fÍÔŒ»ã†; } } if (empty($this->username) || empty($this->userpass) || empty($this->domain)) { throw new Exception($B›«ˆ®ŸÊ¿[1321] . LNG($B›«ˆ®ŸÊ¿[1253])); } } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } private function ussHeaders($Fğ¯•òªÎ, $E£êêÖÍÍÔ = "\x47\x45\x54") { $aøõ¥‚ÓŠ¾ =& $_SERVER[¬¦ã¾]; $Fó½‘¾ƒíô = gmdate($aøõ¥‚ÓŠ¾[1287]); $få‚øñ¬ÏÎ = base64_encode(hash_hmac($aøõ¥‚ÓŠ¾[1322], "{$E£êêÖÍÍÔ}\x26{$Fğ¯•òªÎ}\x26{$Fó½‘¾ƒíô}", md5("{$this->userpass}"), !0)); $cí¿ëË¤÷ = array("\101\x75\x74\150\157\162\x69\x7a\141\164\151\x6f\x6e\72\125\120\x59\125\116\x20{$this->username}\72{$få‚øñ¬ÏÎ}", "\104\x61\164\x65\72{$Fó½‘¾ƒíô}"); return $cí¿ëË¤÷; } public function ussRequest($BŸ»š‹ÅÍ, $B¦²İ¾‚œ = "\x47\105\124", $Fµ¶ñâøƒÅ = false, $d½ÊÁÖ±ªö = false, $F½ğù±¦‰ = false) { goto EèÈòñ»º; fáÓÑÔ§£Ñ: $EÌì·¸¬ØÌ = $this->ussHeaders($EÄ«Òùì¢, $B¦²İ¾‚œ); if ($d½ÊÁÖ±ªö) { $EÌì·¸¬ØÌ = array_merge($EÌì·¸¬ØÌ, $d½ÊÁÖ±ªö); } $e¡ÇòÇ‹Ç© = url_request($this->endpoint . $EÄ«Òùì¢, $B¦²İ¾‚œ, $Fµ¶ñâøƒÅ, $EÌì·¸¬ØÌ, $F½ğù±¦‰); goto AÊÈ­È¯Æó; AÊÈ­È¯Æó: if (!$e¡ÇòÇ‹Ç©) { return array($Døõšƒêâ×[1077] => !1, $Døõšƒêâ×[1079] => $Døõšƒêâ×[1323]); } if (strtolower($B¦²İ¾‚œ) == $Døõšƒêâ×[190] || in_array($e¡ÇòÇ‹Ç©[$Døõšƒêâ×[1077]], array($Døõšƒêâ×[1180], $Døõšƒêâ×[1324]))) { $Fµ¶ñâøƒÅ = $e¡ÇòÇ‹Ç©[$Døõšƒêâ×[1325]]; } else { $Fµ¶ñâøƒÅ = json_decode($e¡ÇòÇ‹Ç©[$Døõšƒêâ×[1079]], !0); if (!$Fµ¶ñâøƒÅ) { $Fµ¶ñâøƒÅ = $e¡ÇòÇ‹Ç©[$Døõšƒêâ×[1079]]; } else { if (!$e¡ÇòÇ‹Ç©[$Døõšƒêâ×[702]] && isset($Fµ¶ñâøƒÅ[$Døõšƒêâ×[1326]])) { $Fµ¶ñâøƒÅ = $Fµ¶ñâøƒÅ[$Døõšƒêâ×[1326]]; } } } return array($Døõšƒêâ×[1077] => $e¡ÇòÇ‹Ç©[$Døõšƒêâ×[702]], $Døõšƒêâ×[1079] => $Fµ¶ñâøƒÅ); goto eƒ’áô‰Ö; EèÈòñ»º: $Døõšƒêâ× =& $_SERVER[¬¦ã¾]; $BŸ»š‹ÅÍ = trim($BŸ»š‹ÅÍ, $Døõšƒêâ×[8]); $EÄ«Òùì¢ = "\x2f{$this->bucket}\x2f{$BŸ»š‹ÅÍ}"; goto fáÓÑÔ§£Ñ; eƒ’áô‰Ö: } public function mkfile($Bëš²‚šÍ, $bó¼ÅÊ¾¦ = '', $e‚àö‘· = REPEAT_RENAME) { if ($this->setContent($Bëš²‚šÍ, $bó¼ÅÊ¾¦)) { return $this->getPathOuter($Bëš²‚šÍ); } return !1; } public function mkdir($a‚£ÉÙ´î, $AäÒĞ¤¢àÊ = REPEAT_SKIP) { $aæ¢Ø®Ş‹ =& $_SERVER[¬¦ã¾]; $AÊ°‹Âã½´ = trim($a‚£ÉÙ´î, $aæ¢Ø®Ş‹[8]); if ($this->_isFolder($AÊ°‹Âã½´)) { return $this->getPathOuter($AÊ°‹Âã½´); } $dšƒ÷˜öÆÕ = array($aæ¢Ø®Ş‹[1327]); $Cµ†ô£Åöê = $this->ussRequest($AÊ°‹Âã½´, $aæ¢Ø®Ş‹[224], !1, $dšƒ÷˜öÆÕ); return $Cµ†ô£Åöê[$aæ¢Ø®Ş‹[1077]] ? $this->getPathOuter($AÊ°‹Âã½´) : !1; } public function copyFile($E„£ù‰Êõ, $CÜ±× ƒÖ­) { $B±Ë¦ÅŒîò =& $_SERVER[¬¦ã¾]; $BÅ¢¡š˜Õí = array($B±Ë¦ÅŒîò[1328] . "\x2f{$this->bucket}\x2f{$E„£ù‰Êõ}", $B±Ë¦ÅŒîò[1329]); $fšßÒ«ç’Ú = $this->ussRequest($CÜ±× ƒÖ­, $B±Ë¦ÅŒîò[226], !1, $BÅ¢¡š˜Õí); return $fšßÒ«ç’Ú[$B±Ë¦ÅŒîò[1077]] ? !0 : $this->getPathOuter($CÜ±× ƒÖ­); } public function moveFile($f¥˜ê”Œİ, $a±ª¢ “Ş) { $D‚ÉŞí¨ï¦ =& $_SERVER[¬¦ã¾]; $f‹´©ÌÕÀ¨ = array($D‚ÉŞí¨ï¦[1330] . "\57{$this->bucket}\57{$f¥˜ê”Œİ}", $D‚ÉŞí¨ï¦[1329]); $aˆ‚‘ÅˆÌ = $this->ussRequest($a±ª¢ “Ş, $D‚ÉŞí¨ï¦[226], !1, $f‹´©ÌÕÀ¨); return $aˆ‚‘ÅˆÌ[$D‚ÉŞí¨ï¦[1077]] ? !0 : $this->getPathOuter($a±ª¢ “Ş); } public function delFile($c§‰³«‚Ô³) { $f×“ÏçÎ©Î =& $_SERVER[¬¦ã¾]; $BõÆºÏÌ‹› = $this->ussRequest($c§‰³«‚Ô³, $f×“ÏçÎ©Î[1331]); return $BõÆºÏÌ‹›[$f×“ÏçÎ©Î[1077]] ? !0 : !1; } public function delFolder($d®’Šìø­ˆ) { goto D©¶Ø»½ó; EßØƒç¥à: foreach ($aæ·ê™ÈØÖ as $E´³Ş§°çÔ) { $B´¯è¼æ ù = $this->ussRequest($E´³Ş§°çÔ[$Bù»öè½˜Ç[28]], $Bù»öè½˜Ç[1331]); if (!$B´¯è¼æ ù[$Bù»öè½˜Ç[1077]]) { return !1; } } foreach ($E«ï—â“Áª as $A˜á‚ô®) { $B´¯è¼æ ù = $this->ussRequest($A˜á‚ô®, $Bù»öè½˜Ç[1331]); if (!$B´¯è¼æ ù[$Bù»öè½˜Ç[1077]]) { return !1; } } $B´¯è¼æ ù = $this->ussRequest($d®’Šìø­ˆ, $Bù»öè½˜Ç[1331]); goto B„âœ¥ÍôÌ; D©¶Ø»½ó: $Bù»öè½˜Ç =& $_SERVER[¬¦ã¾]; if (!$this->exist($d®’Šìø­ˆ)) { return !0; } $this->listItemCache = !1; goto aÒ‘ƒß«ô; B„âœ¥ÍôÌ: return $B´¯è¼æ ù[$Bù»öè½˜Ç[1077]]; goto a£ÓˆÎŞÆó; aÒ‘ƒß«ô: $E«ï—â“Áª = $aæ·ê™ÈØÖ = array(); $this->fileList($d®’Šìø­ˆ, $E«ï—â“Áª, $aæ·ê™ÈØÖ, !0); $this->listItemCache = !0; goto EßØƒç¥à; a£ÓˆÎŞÆó: } public function rename($eÕğĞ·Ë, $B†ğ“šµÕ™) { if ($this->isFile($eÕğĞ·Ë)) { $B†ğ“šµÕ™ = get_path_father($eÕğĞ·Ë) . $B†ğ“šµÕ™; return $this->moveFile($eÕğĞ·Ë, $B†ğ“šµÕ™); } return $this->renameObject($eÕğĞ·Ë, $B†ğ“šµÕ™); } public function fileInfo($A† øã›Õ, $eô‡ø ¯Ù¯ = false, $cŠ®‚Î•– = array()) { goto F®ºÌ°ÄÏ†; c¸Òô ĞÀÔ: $Dñ¿…—İ¿É[$a˜ˆ²Ö™çé[194]] = $Dñ¿…—İ¿É[$a˜ˆ²Ö™çé[84]] = 0; $Dñ¿…—İ¿É[$a˜ˆ²Ö™çé[195]] = $Dñ¿…—İ¿É[$a˜ˆ²Ö™çé[196]] = !0; if (empty($cŠ®‚Î•–)) { $cŠ®‚Î•– = $this->objectMeta($A† øã›Õ); if (!$cŠ®‚Î•–) { return $Dñ¿…—İ¿É; } } goto BÄáñß¢–¹; BÄáñß¢–¹: $Dñ¿…—İ¿É[$a˜ˆ²Ö™çé[194]] = intval($cŠ®‚Î•–[$a˜ˆ²Ö™çé[1332]]); $Dñ¿…—İ¿É[$a˜ˆ²Ö™çé[84]] = intval($cŠ®‚Î•–[$a˜ˆ²Ö™çé[1333]]); $Dñ¿…—İ¿É[$a˜ˆ²Ö™çé[78]] = $cŠ®‚Î•–[$a˜ˆ²Ö™çé[78]]; goto böíÎöŠÛØ; F®ºÌ°ÄÏ†: $a˜ˆ²Ö™çé =& $_SERVER[¬¦ã¾]; $Dñ¿…—İ¿É = array($a˜ˆ²Ö™çé[28] => $this->pathThis($A† øã›Õ), $a˜ˆ²Ö™çé[76] => $this->getPathOuter($a˜ˆ²Ö™çé[8] . $A† øã›Õ), $a˜ˆ²Ö™çé[29] => $a˜ˆ²Ö™çé[193], $a˜ˆ²Ö™çé[78] => isset($cŠ®‚Î•–[$a˜ˆ²Ö™çé[78]]) ? $cŠ®‚Î•–[$a˜ˆ²Ö™çé[78]] : 0, $a˜ˆ²Ö™çé[168] => $this->ext($A† øã›Õ)); if ($eô‡ø ¯Ù¯) { return $Dñ¿…—İ¿É; } goto c¸Òô ĞÀÔ; böíÎöŠÛØ: return $Dñ¿…—İ¿É; goto A¸çÏ½îæ×; A¸çÏ½îæ×: } public function folderInfo($dˆ†Á•¿„¿, $d‘ßš±Øˆó = false) { goto eøÌ¿œ÷ÈÉ; b¿ñ“ÊÄ¹Â: $F‡ÍÇ¿îÂ[$Dé÷Ÿöõ‡ğ[194]] = $F‡ÍÇ¿îÂ[$Dé÷Ÿöõ‡ğ[84]] = 0; $F‡ÍÇ¿îÂ[$Dé÷Ÿöõ‡ğ[195]] = $F‡ÍÇ¿îÂ[$Dé÷Ÿöõ‡ğ[196]] = !0; if (empty($D²‰¬·”‹Ò)) { $D²‰¬·”‹Ò = $this->objectMeta($dˆ†Á•¿„¿); if (!$D²‰¬·”‹Ò) { return $F‡ÍÇ¿îÂ; } } goto F†ØÓÁÈ´; eøÌ¿œ÷ÈÉ: $Dé÷Ÿöõ‡ğ =& $_SERVER[¬¦ã¾]; $F‡ÍÇ¿îÂ = array($Dé÷Ÿöõ‡ğ[28] => $this->pathThis($dˆ†Á•¿„¿), $Dé÷Ÿöõ‡ğ[76] => $this->getPathOuter($Dé÷Ÿöõ‡ğ[8] . $dˆ†Á•¿„¿), $Dé÷Ÿöõ‡ğ[29] => $Dé÷Ÿöõ‡ğ[77]); if ($d‘ßš±Øˆó) { return $F‡ÍÇ¿îÂ; } goto b¿ñ“ÊÄ¹Â; F†ØÓÁÈ´: $F‡ÍÇ¿îÂ[$Dé÷Ÿöõ‡ğ[194]] = intval($D²‰¬·”‹Ò[$Dé÷Ÿöõ‡ğ[1332]]); $F‡ÍÇ¿îÂ[$Dé÷Ÿöõ‡ğ[84]] = intval($D²‰¬·”‹Ò[$Dé÷Ÿöõ‡ğ[1333]]); return $F‡ÍÇ¿îÂ; goto DÄ†¯…½…; DÄ†¯…½…: } private function listObjs($AÀÜãÈ»±õ, $D¹Âó°Í°Š = 0, $B­¥¥ì¿±á = 1000) { $A¸ç½Æèôñ =& $_SERVER[¬¦ã¾]; $c‰¶“”Ú‹ö = array($A¸ç½Æèôñ[1334], $A¸ç½Æèôñ[1335] . $B­¥¥ì¿±á); if ($D¹Âó°Í°Š) { $c‰¶“”Ú‹ö[] = $A¸ç½Æèôñ[1336] . $D¹Âó°Í°Š; } $b¯äéÔ“Œå = $this->ussRequest($AÀÜãÈ»±õ, $A¸ç½Æèôñ[228], !1, $c‰¶“”Ú‹ö); return !$b¯äéÔ“Œå[$A¸ç½Æèôñ[1077]] ? !1 : $b¯äéÔ“Œå[$A¸ç½Æèôñ[1079]]; } private function fileList($dŠ­ÂÌ»µ¼, &$fî÷Üéà­â, &$FÎæÚßõŠ, $f›«¨«¬Ÿ• = false) { goto d³‚ŞÜ•Ğ¼; CÒ·ìã”–: if ($D†ƒññ•á) { $this->cacheMethod($cà›Şç¿ğ[199], $dŠ­ÂÌ»µ¼, !0); } goto fÂø ÏÊòî; d³‚ŞÜ•Ğ¼: $cà›Şç¿ğ =& $_SERVER[¬¦ã¾]; $a‰¶ÅÅŒÄ = $cà›Şç¿ğ[33]; $DãŒì³¢‚ğ = 1000; goto Eš‹Õ’®’º; Eš‹Õ’®’º: $aŠØœ½±×ˆ = rtrim($dŠ­ÂÌ»µ¼, $cà›Şç¿ğ[8]) . $cà›Şç¿ğ[8]; $D†ƒññ•á = $this->listItemCache === !1 ? !1 : !0; while (!0) { check_abort(); $D¶ëÓ÷·öÔ = $this->listObjs($dŠ­ÂÌ»µ¼, $a‰¶ÅÅŒÄ, $DãŒì³¢‚ğ); if (!$D¶ëÓ÷·öÔ) { return !1; } $a‰¶ÅÅŒÄ = isset($D¶ëÓ÷·öÔ[$cà›Şç¿ğ[1337]]) ? $D¶ëÓ÷·öÔ[$cà›Şç¿ğ[1337]] : $cà›Şç¿ğ[33]; $cÖ˜Ùšˆò = isset($D¶ëÓ÷·öÔ[$cà›Şç¿ğ[1338]]) ? $D¶ëÓ÷·öÔ[$cà›Şç¿ğ[1338]] : array(); foreach ($cÖ˜Ùšˆò as $bèµ±›ÉÖè) { $e «˜õµ÷ = $bèµ±›ÉÖè[$cà›Şç¿ğ[29]] == $cà›Şç¿ğ[77] ? !0 : !1; $E‘…‘Ú´ = ltrim($aŠØœ½±×ˆ . $bèµ±›ÉÖè[$cà›Şç¿ğ[28]], $cà›Şç¿ğ[8]) . ($e «˜õµ÷ ? $cà›Şç¿ğ[8] : $cà›Şç¿ğ[33]); $E¯­„êŠ² = array($cà›Şç¿ğ[28] => $E‘…‘Ú´, $cà›Şç¿ğ[29] => $e «˜õµ÷ ? $cà›Şç¿ğ[77] : $cà›Şç¿ğ[193], $cà›Şç¿ğ[78] => $bèµ±›ÉÖè[$cà›Şç¿ğ[335]], $cà›Şç¿ğ[1333] => $bèµ±›ÉÖè[$cà›Şç¿ğ[1339]]); if ($D†ƒññ•á) { $this->cacheMethod($cà›Şç¿ğ[199], $E‘…‘Ú´, $e «˜õµ÷); $this->cacheMethod($cà›Şç¿ğ[200], $E‘…‘Ú´, $E¯­„êŠ²); } if ($e «˜õµ÷) { $fî÷Üéà­â[] = $E‘…‘Ú´; if ($f›«¨«¬Ÿ•) { $this->fileList($E‘…‘Ú´, $fî÷Üéà­â, $FÎæÚßõŠ, $f›«¨«¬Ÿ•); } continue; } $FÎæÚßõŠ[] = $E¯­„êŠ²; } if (count($cÖ˜Ùšˆò) < $DãŒì³¢‚ğ) { break; } } goto CÒ·ìã”–; fÂø ÏÊòî: } public function listPath($fÄÍŸ‹Ï“¿, $DÎ¹ÙëÆ = false) { $c‰ˆğàæÖ¸ =& $_SERVER[¬¦ã¾]; $a˜¸ÎÛ¼Æ = $aÊ£ˆÌØ“• = array(); $this->fileList($fÄÍŸ‹Ï“¿, $a˜¸ÎÛ¼Æ, $aÊ£ˆÌØ“•); foreach ($a˜¸ÎÛ¼Æ as $f«œëÆ ˆâ => $Dó¯Ï¡î÷¸) { $a˜¸ÎÛ¼Æ[$f«œëÆ ˆâ] = $this->folderInfo($Dó¯Ï¡î÷¸, $DÎ¹ÙëÆ); } foreach ($aÊ£ˆÌØ“• as $f«œëÆ ˆâ => $Dó¯Ï¡î÷¸) { $aÊ£ˆÌØ“•[$f«œëÆ ˆâ] = $this->fileInfo($Dó¯Ï¡î÷¸[$c‰ˆğàæÖ¸[28]], $DÎ¹ÙëÆ, $Dó¯Ï¡î÷¸); } return array($c‰ˆğàæÖ¸[75] => $a˜¸ÎÛ¼Æ, $c‰ˆğàæÖ¸[74] => $aÊ£ˆÌØ“•); } public function has($f¦Ïº¤à•, $BÔƒ¿ÏØÒ = false, $aÉ‘Œƒ–âí = true) { goto BÏø¹ëôôù; BÏø¹ëôôù: $A¡Šç³¹¡† =& $_SERVER[¬¦ã¾]; $a´¢Ñ–õ® = $A¡Šç³¹¡†[33]; $Aƒ±µ˜Ã¼ = 500; goto Fø§È¦ßÁ˜; Fø§È¦ßÁ˜: $d¶Ôç‘îÏß = 0; $FĞõ£Ãï = 0; $A„âïØÕó’ = rtrim($f¦Ïº¤à•, $A¡Šç³¹¡†[8]) . $A¡Šç³¹¡†[8]; goto d²Ÿ¶œµÜ¦; d²Ÿ¶œµÜ¦: while (!0) { check_abort(); $FãÜ‰£Å·ê = $this->listObjs($f¦Ïº¤à•, $a´¢Ñ–õ®, $Aƒ±µ˜Ã¼); if (!$FãÜ‰£Å·ê) { return !1; } $a´¢Ñ–õ® = isset($FãÜ‰£Å·ê[$A¡Šç³¹¡†[1337]]) ? $FãÜ‰£Å·ê[$A¡Šç³¹¡†[1337]] : $A¡Šç³¹¡†[33]; $d®ÆßÊóƒ‘ = isset($FãÜ‰£Å·ê[$A¡Šç³¹¡†[1338]]) ? $FãÜ‰£Å·ê[$A¡Šç³¹¡†[1338]] : array(); if (empty($d®ÆßÊóƒ‘)) { break; } $d·¿…ÒîŒÜ = array_filter($d®ÆßÊóƒ‘, function ($cÏ™ò›•´) { $E™·â˜½»ê =& $_SERVER[¬¦ã¾]; return $cÏ™ò›•´[$E™·â˜½»ê[29]] == $E™·â˜½»ê[77]; }); $féó‹†¨À = count($d®ÆßÊóƒ‘); $d·¿…ÒîŒÜ = count($d·¿…ÒîŒÜ); $b¸ØçÂÈòĞ = $féó‹†¨À - $d·¿…ÒîŒÜ; if ($BÔƒ¿ÏØÒ) { $FĞõ£Ãï += $d·¿…ÒîŒÜ; $d¶Ôç‘îÏß += $b¸ØçÂÈòĞ; if ($féó‹†¨À < $Aƒ±µ˜Ã¼) { break; } continue; } if ($aÉ‘Œƒ–âí) { if ($b¸ØçÂÈòĞ) { return !0; } } else { if ($d·¿…ÒîŒÜ) { return !0; } } if ($féó‹†¨À < $Aƒ±µ˜Ã¼) { break; } } if ($BÔƒ¿ÏØÒ) { return array($A¡Šç³¹¡†[203] => $d¶Ôç‘îÏß, $A¡Šç³¹¡†[204] => $FĞõ£Ãï); } return !1; goto EÚÀÅ¿øæ; EÚÀÅ¿øæ: } public function listAll($eÓËø÷°Ê) { goto D˜·‰Ñï ×; bÎ¨ Ã¦é“: return $this->listAllFiles($eÓËø÷°Ê, array_keys($eğÕ¡ ­ó), $eğÕ¡ ­ó); goto E•¢ğñÔÕ; D˜·‰Ñï ×: $CšŠ ­³•ï =& $_SERVER[¬¦ã¾]; $c†”Ñ¼˜¶ = $bÚ—óÁ˜¾ = array(); $this->fileList($eÓËø÷°Ê, $c†”Ñ¼˜¶, $bÚ—óÁ˜¾, !0); goto BÈ­–§–©; BÈ­–§–©: $eğÕ¡ ­ó = array(); foreach ($bÚ—óÁ˜¾ as $añ°¼¢Õöâ) { $eğÕ¡ ­ó[$añ°¼¢Õöâ[$CšŠ ­³•ï[28]]] = $añ°¼¢Õöâ[$CšŠ ­³•ï[78]]; } foreach ($c†”Ñ¼˜¶ as $añ°¼¢Õöâ) { if (is_string($añ°¼¢Õöâ)) { $eğÕ¡ ­ó[$añ°¼¢Õöâ] = 0; } } goto bÎ¨ Ã¦é“; E•¢ğñÔÕ: } public function canRead($A‡šàÎ­…) { return $this->exist($A‡šàÎ­…) ? !0 : !1; } public function canWrite($FŒÃÓâöÓÌ) { return $this->exist($FŒÃÓâöÓÌ) ? !0 : !1; } public function getContent($A²»ì£ŠÜ) { return $this->fileSubstr($A²»ì£ŠÜ, 0, -1); } public function setContent($cç·ªñ¬ãÕ, $DŠçë‰… = '') { $AäÓó÷é‚ê =& $_SERVER[¬¦ã¾]; if (!$DŠçë‰…) { $DÀ Äù¯‹Ç = $this->ussRequest($cç·ªñ¬ãÕ, $AäÓó÷é‚ê[224]); return $DÀ Äù¯‹Ç[$AäÓó÷é‚ê[1077]]; } $EÁÜ‹åŸøî = $this->tempFile($this->pathThis($cç·ªñ¬ãÕ)); file_put_contents($EÁÜ‹åŸøî, $DŠçë‰…); if ($this->upload($cç·ªñ¬ãÕ, $EÁÜ‹åŸøî)) { $this->tempFileRemve($EÁÜ‹åŸøî); return !0; } return !1; } public function fileSubstr($cíñ¡×‰¿Ï, $B–Ä”ê¾, $f“Ä¸øëâ) { $eÊ®òö³ =& $_SERVER[¬¦ã¾]; if (!($FáŸ·×ŠÁ— = $this->link($cíñ¡×‰¿Ï))) { return !1; } $BŒ®°÷±½ = !1; if ($f“Ä¸øëâ > 0) { $FÀÕ®¶é = $B–Ä”ê¾ + $f“Ä¸øëâ - 1; $BŒ®°÷±½ = array($eÊ®òö³[1300] . $B–Ä”ê¾ . $eÊ®òö³[440] . $FÀÕ®¶é); } $c³—‘’áÜ = url_request($FáŸ·×ŠÁ—, $eÊ®òö³[228], !1, $BŒ®°÷±½); return $c³—‘’áÜ[$eÊ®òö³[702]] ? $c³—‘’áÜ[$eÊ®òö³[1079]] : !1; } public function upload($BœÆŸ‰„„ƒ, $dÆÅğ¤òÌ, $bàË–“Õ¤µ = false, $BÆäÑ…ö¡ = REPEAT_REPLACE) { goto F„«âø«; döµ—øª«: $Bô‘«ÊÒ¸Ì = $E¤æ˜×ÊÒ[$dé£Æ»ØÓ[1345]]; $d÷°ÎùÌ· = fopen($dÆÅğ¤òÌ, $dé£Æ»ØÓ[1250]); if (!$d÷°ÎùÌ·) { return !1; } goto A½ÀÊÎ¯¼ï; F„«âø«: $dé£Æ»ØÓ =& $_SERVER[¬¦ã¾]; $F©–ÒØöŒ = IO::size($dÆÅğ¤òÌ); if ($F©–ÒØöŒ <= 1024 * 1024 * 200) { $b¤ñ· = array($dé£Æ»ØÓ[1340] . $dÆÅğ¤òÌ); $A·Ø…„ä”É = $this->ussRequest($BœÆŸ‰„„ƒ, $dé£Æ»ØÓ[226], $b¤ñ·); return $A·Ø…„ä”É[$dé£Æ»ØÓ[1077]] ? $this->getPathOuter($BœÆŸ‰„„ƒ) : !1; } goto fªÂÁÓ¼Â; e°“ŒÒƒà…: if (!$A·Ø…„ä”É[$dé£Æ»ØÓ[1077]]) { return !1; } $E¤æ˜×ÊÒ = $A·Ø…„ä”É[$dé£Æ»ØÓ[1079]]; $e‰³Ï“‚æ† = 0; goto döµ—øª«; fªÂÁÓ¼Â: $A¼ÅÇšàî = 1024 * 1024 * 10; $eÎ±â±÷Ğ  = array($dé£Æ»ØÓ[1341], $dé£Æ»ØÓ[1342] . $F©–ÒØöŒ, $dé£Æ»ØÓ[1343], $dé£Æ»ØÓ[1344] . $A¼ÅÇšàî); $A·Ø…„ä”É = $this->ussRequest($BœÆŸ‰„„ƒ, $dé£Æ»ØÓ[226], !1, $eÎ±â±÷Ğ ); goto e°“ŒÒƒà…; A½ÀÊÎ¯¼ï: do { $C¿ê°æªÄ = $E¤æ˜×ÊÒ[$dé£Æ»ØÓ[1346]]; fseek_64($d÷°ÎùÌ·, $e‰³Ï“‚æ†); $Bèçëê•Õ² = fread($d÷°ÎùÌ·, $C¿ê°æªÄ); $bªÇğÄèÍô = 0; do { $bªÇğÄèÍô++; $E¤æ˜×ÊÒ = $this->uploadPart($BœÆŸ‰„„ƒ, $E¤æ˜×ÊÒ, $Bèçëê•Õ²); } while (!$E¤æ˜×ÊÒ && $bªÇğÄèÍô < 3); if (!$E¤æ˜×ÊÒ) { return !1; } $Bô‘«ÊÒ¸Ì = $E¤æ˜×ÊÒ[$dé£Æ»ØÓ[1345]]; $e‰³Ï“‚æ† += $C¿ê°æªÄ; } while ($Bô‘«ÊÒ¸Ì != -1); fclose($d÷°ÎùÌ·); $eÎ±â±÷Ğ  = array($dé£Æ»ØÓ[1347], $dé£Æ»ØÓ[1348] . $E¤æ˜×ÊÒ[$dé£Æ»ØÓ[1349]], $dé£Æ»ØÓ[1343]); goto C›Í‰ó‹ÏÙ; C›Í‰ó‹ÏÙ: $A·Ø…„ä”É = $this->ussRequest($BœÆŸ‰„„ƒ, $dé£Æ»ØÓ[226], !1, $eÎ±â±÷Ğ ); return $A·Ø…„ä”É[$dé£Æ»ØÓ[1077]] ? $this->getPathOuter($CÈàŒĞõ¡) : !1; goto AÂô“Ôğù; AÂô“Ôğù: } private function uploadPart($c…™•¦„Õ‚, $B•¯ëô×‚İ, &$B’¡ç¬ñ°¢) { $dß­‘ÄÛÍ =& $_SERVER[¬¦ã¾]; $aùÇÚÍœ¦ = array($dß­‘ÄÛÍ[1350], $dß­‘ÄÛÍ[1348] . $B•¯ëô×‚İ[$dß­‘ÄÛÍ[1349]], $dß­‘ÄÛÍ[1351] . $B•¯ëô×‚İ[$dß­‘ÄÛÍ[1345]], $dß­‘ÄÛÍ[141] . $B•¯ëô×‚İ[$dß­‘ÄÛÍ[1346]]); $bœÈ‰¯ğŞ = $this->ussRequest($c…™•¦„Õ‚, $dß­‘ÄÛÍ[226], $B’¡ç¬ñ°¢, $aùÇÚÍœ¦); return !$bœÈ‰¯ğŞ[$dß­‘ÄÛÍ[1077]] ? $bœÈ‰¯ğŞ[$dß­‘ÄÛÍ[1077]] : $bœÈ‰¯ğŞ[$dß­‘ÄÛÍ[1079]]; } public function uploadFormData($aø´¦ÔâÁÜ, $aÎ‚¡ª„«¢ = 3600) { return $this->uploadPolicy($aø´¦ÔâÁÜ, $aÎ‚¡ª„«¢); } public function multiUploadFormData($C¼¢Ÿö—“, $E’—Óˆ¬¾Ü = 3600) { $aÔ•îÏãéá =& $_SERVER[¬¦ã¾]; $fóÚ÷Š˜É‘ = (int) $GLOBALS[$aÔ•îÏãéá[7]][$aÔ•îÏãéá[78]]; return $this->uploadPolicy($C¼¢Ÿö—“, $E’—Óˆ¬¾Ü, $fóÚ÷Š˜É‘); } private function uploadPolicy($B’¾Üï˜ì, $B½šÉš”¯ = 3600, $bøÀÕÙñÎ = 0) { goto DÊö¨æè¯‚; cÏï‡×¿¤: $d‹·×ï×ñî = array($FïŠ„Ä§Í[1352] => $this->bucket, $FïŠ„Ä§Í[1353] => $B’¾Üï˜ì, $FïŠ„Ä§Í[1354] => time() + $B½šÉš”¯, $FïŠ„Ä§Í[1355] => $d¦ìâö´‡Ï); if ($bøÀÕÙñÎ) { $d‹·×ï×ñî[$FïŠ„Ä§Í[1266]] = $bøÀÕÙñÎ; } $bä†…¬ö‚‚ = base64_encode(json_encode($d‹·×ï×ñî)); goto D™¹Ğ…à„í; DÊö¨æè¯‚: $FïŠ„Ä§Í =& $_SERVER[¬¦ã¾]; $AÌ‡Ş†ìÈ = $FïŠ„Ä§Í[8] . $this->bucket; $d¦ìâö´‡Ï = gmdate($FïŠ„Ä§Í[1287]); goto cÏï‡×¿¤; D™¹Ğ…à„í: $fœŒÙĞ±×¦ = base64_encode(hash_hmac($FïŠ„Ä§Í[1322], "\x50\x4f\123\124\x26{$AÌ‡Ş†ìÈ}\46{$d¦ìâö´‡Ï}\46{$bä†…¬ö‚‚}", md5("{$this->userpass}"), !0)); $eà®ê†¸ÌŞ = array($FïŠ„Ä§Í[1192] => $bä†…¬ö‚‚, $FïŠ„Ä§Í[1356] => "\125\120\x59\125\x4e\x20{$this->username}\x3a{$fœŒÙĞ±×¦}", $FïŠ„Ä§Í[175] => $this->endpoint . $AÌ‡Ş†ìÈ); return $eà®ê†¸ÌŞ; goto e˜·‰õ…Í¢; e˜·‰õ…Í¢: } public function download($BƒÎ½¥Ğ, $B÷ÓİÂ“Å) { goto f×Ùª‰ˆÇ÷; CÒºŒÃô°‹: fclose($B›ËÆ‰‚ä); return $B÷ÓİÂ“Å; goto bÁ÷©ÁÁ§è; dÌÎ¿ÆĞ•°: $cÂÜå´„øÒ = 1024 * 200; $B›ËÆ‰‚ä = fopen($aÕÄœ½, $_SERVER[¬¦ã¾][1306]); while (!0) { $CÖª»Û¥‘À = $this->fileSubstr($BƒÎ½¥Ğ, $fÎ°˜Ğºå, $cÂÜå´„øÒ); if ($CÖª»Û¥‘À === !1) { return !1; } fwrite($B›ËÆ‰‚ä, $CÖª»Û¥‘À); $fÎ°˜Ğºå += $cÂÜå´„øÒ; if (strlen($CÖª»Û¥‘À) < $cÂÜå´„øÒ) { break; } } goto CÒºŒÃô°‹; f×Ùª‰ˆÇ÷: $aÕÄœ½ = IO::getPathInner(IO::mkfile($B÷ÓİÂ“Å)); if (!($Cã‰Ô†Åƒ÷ = $this->link($BƒÎ½¥Ğ))) { return !1; } $fÎ°˜Ğºå = 0; goto dÌÎ¿ÆĞ•°; bÁ÷©ÁÁ§è: } public function link($e»›Ğá’¹œ, $B›³çø§¶ = array()) { $D¶•ô„½•‚ =& $_SERVER[¬¦ã¾]; $e»›Ğá’¹œ = trim($e»›Ğá’¹œ, $D¶•ô„½•‚[8]); if (!empty($this->token)) { $Câ©£ëÖÜÃ = strtotime(date($D¶•ô„½•‚[1357])); $B³““Œ—¼´ = substr(md5($this->token . $D¶•ô„½•‚[282] . $Câ©£ëÖÜÃ . $D¶•ô„½•‚[1358] . $e»›Ğá’¹œ), 12, 8) . $Câ©£ëÖÜÃ; $B›³çø§¶[] = $D¶•ô„½•‚[1359] . $B³““Œ—¼´; } $EÈÊğíñ© = !empty($B›³çø§¶) ? $D¶•ô„½•‚[70] . implode($D¶•ô„½•‚[282], $B›³çø§¶) : $D¶•ô„½•‚[33]; return $this->getHost() . $D¶•ô„½•‚[8] . $e»›Ğá’¹œ . $EÈÊğíñ©; } public function fileOut($a‰õ§š×, $cÒî·È£î® = false, $e…™ß“ÀÇ = false, $Bİ”¨Ù¶„Ó = '') { if ($this->isFileOutServer()) { return $this->fileOutServer($a‰õ§š×, $cÒî·È£î®, $e…™ß“ÀÇ, $Bİ”¨Ù¶„Ó); } if (!$e…™ß“ÀÇ) { $e…™ß“ÀÇ = $this->pathThis($a‰õ§š×); } $F¥ìáÙÀ²× = $cÒî·È£î® ? array($_SERVER[¬¦ã¾][1360] . rawurlencode($e…™ß“ÀÇ)) : array(); $FöÃ½åÅ = $this->link($a‰õ§š×, $F¥ìáÙÀ²×); $this->fileOutLink($FöÃ½åÅ); } public function fileOutServer($aÑ™õÂÕ‚, $D‡ƒøœä˜¯ = false, $E¿ª”Ùİ¬¶ = false, $eÌÔñÎğÒµ = '') { parent::fileOut($aÑ™õÂÕ‚, $D‡ƒøœä˜¯, $E¿ª”Ùİ¬¶, $eÌÔñÎğÒµ); } public function fileOutImage($eª¡ØË©–ï, $eŞã¶ŸÌå  = 250) { $AçË•©‡”Á = $this->link($eª¡ØË©–ï . $_SERVER[¬¦ã¾][1361] . $eŞã¶ŸÌå ); $this->fileOutLink($AçË•©‡”Á); } public function fileOutImageServer($Eñæ‘¤›óË, $cÄï™¯ªƒ¼ = 250) { parent::fileOutImage($Eñæ‘¤›óË, $cÄï™¯ªƒ¼); } public function hashMd5($fÇ°±¿È) { $Bê»Æàí© =& $_SERVER[¬¦ã¾]; $fìÑŠ…˜À = $this->_objectMeta($fÇ°±¿È); return isset($fìÑŠ…˜À[$Bê»Æàí©[208]]) ? $fìÑŠ…˜À[$Bê»Æàí©[208]] : !1; } public function size($F·ØİÍ±ÎÂ) { $B±™‡ƒšÁê = $this->objectMeta($F·ØİÍ±ÎÂ); return $B±™‡ƒšÁê ? $B±™‡ƒšÁê[$_SERVER[¬¦ã¾][78]] : 0; } public function info($a•¸â¦™Şƒ) { if ($this->isFolder($a•¸â¦™Şƒ)) { return $this->folderInfo($a•¸â¦™Şƒ); } else { if ($this->isFile($a•¸â¦™Şƒ)) { return $this->fileInfo($a•¸â¦™Şƒ); } } return !1; } public function exist($f–‰¬ôÛÉ) { return $this->isFile($f–‰¬ôÛÉ) || $this->isFolder($f–‰¬ôÛÉ); } public function isFile($d½ïñÀÉÚÕ) { return !$this->isFolder($d½ïñÀÉÚÕ) && $this->objectMeta($d½ïñÀÉÚÕ); } public function isFolder($A¿ÜÖæù±‡) { return $this->cacheMethod($_SERVER[¬¦ã¾][199], $A¿ÜÖæù±‡); } protected function objectMeta($F•‹ÌŠºñò) { return $this->cacheMethod($_SERVER[¬¦ã¾][200], $F•‹ÌŠºñò); } protected function _objectMeta($cÇ¯ğæ‚‚) { goto cƒ¾ßÄ—ŒÌ; bÁ¶ùÒ¦éí: if (!$f‡ –©Úá¼[$F¾÷´°×è£[1077]]) { return null; } $C½Ó½ˆ¯Ü¤ = isset($f‡ –©Úá¼[$F¾÷´°×è£[1079]]) ? $f‡ –©Úá¼[$F¾÷´°×è£[1079]] : array(); if (!isset($C½Ó½ˆ¯Ü¤[$F¾÷´°×è£[1363]])) { return null; } goto dĞƒ¢ƒŞ’; cƒ¾ßÄ—ŒÌ: $F¾÷´°×è£ =& $_SERVER[¬¦ã¾]; if ($cÇ¯ğæ‚‚ == $F¾÷´°×è£[33] || $cÇ¯ğæ‚‚ == $F¾÷´°×è£[8]) { return array(); } $f‡ –©Úá¼ = $this->ussRequest($cÇ¯ğæ‚‚, $F¾÷´°×è£[1362]); goto bÁ¶ùÒ¦éí; dĞƒ¢ƒŞ’: $eªŞ´¸»‰è = array($F¾÷´°×è£[29] => isset($C½Ó½ˆ¯Ü¤[$F¾÷´°×è£[1363]]) ? $C½Ó½ˆ¯Ü¤[$F¾÷´°×è£[1363]] : null, $F¾÷´°×è£[78] => isset($C½Ó½ˆ¯Ü¤[$F¾÷´°×è£[1364]]) ? $C½Ó½ˆ¯Ü¤[$F¾÷´°×è£[1364]] : null, $F¾÷´°×è£[208] => isset($C½Ó½ˆ¯Ü¤[$F¾÷´°×è£[1365]]) ? $C½Ó½ˆ¯Ü¤[$F¾÷´°×è£[1365]] : null, $F¾÷´°×è£[1332] => isset($C½Ó½ˆ¯Ü¤[$F¾÷´°×è£[1366]]) ? $C½Ó½ˆ¯Ü¤[$F¾÷´°×è£[1366]] : null); $eªŞ´¸»‰è[$F¾÷´°×è£[1333]] = isset($C½Ó½ˆ¯Ü¤[$F¾÷´°×è£[1367]]) ? strtotime($C½Ó½ˆ¯Ü¤[$F¾÷´°×è£[1367]]) : $eªŞ´¸»‰è[$F¾÷´°×è£[1332]]; return $eªŞ´¸»‰è; goto cŠ¢ê”ÊÅÖ; cŠ¢ê”ÊÅÖ: } protected function _isFolder($f‚âäª‹ò¯) { $c˜…Ğ³‚‰ƒ =& $_SERVER[¬¦ã¾]; if ($f‚âäª‹ò¯ == $c˜…Ğ³‚‰ƒ[33] || $f‚âäª‹ò¯ == $c˜…Ğ³‚‰ƒ[8]) { return !0; } $eÁ‡‚à¨Ö = $this->_objectMeta($f‚âäª‹ò¯); return isset($eÁ‡‚à¨Ö[$c˜…Ğ³‚‰ƒ[29]]) && $eÁ‡‚à¨Ö[$c˜…Ğ³‚‰ƒ[29]] == $c˜…Ğ³‚‰ƒ[77] ? !0 : !1; } } class PathDriverUrl extends PathDriverBase { static $_cacheHeader = array(); public function __construct($bÉ”ã…§ÍÈ = false) { } public function exist($a—š‘É‡ÍÎ) { $bÁ½é†ºƒ‹ = $this->info($a—š‘É‡ÍÎ); return $bÁ½é†ºƒ‹[$_SERVER[¬¦ã¾][195]]; } public function isFile($E ±ŠŞåƒ·) { $Eµ§ø°±Ø = $this->info($E ±ŠŞåƒ·); return $Eµ§ø°±Ø[$_SERVER[¬¦ã¾][195]]; } public function isFolder($AïÜÅ‚²Ì) { return !1; } public function size($DÛ¾‰‘´÷£) { $FÃã”Åî­² = $this->info($DÛ¾‰‘´÷£); return $FÃã”Åî­²[$_SERVER[¬¦ã¾][78]]; } public function info($déÚÏËÜÚ) { return $this->infoParse($déÚÏËÜÚ); } public function infoAuth($c‰çæÊ§”) { return $this->infoParse($c‰çæÊ§”); } public function infoWithChildren($Bä¬‹éìõ‚) { return $this->infoParse($Bä¬‹éìõ‚); } public function infoFull($Bñ‹…£‚Ùø) { return $this->infoParse($Bñ‹…£‚Ùø); } private function infoParse($d±ÏˆÏ–“Û) { $AÍ¹„àÁ£ =& $_SERVER[¬¦ã¾]; $DøÄğªé†ù = $this->header($d±ÏˆÏ–“Û); if (!$DøÄğªé†ù || !$DøÄğªé†ù[$AÍ¹„àÁ£[702]]) { return !1; } $CñÜñ‹ñ›± = _get($DøÄğªé†ù, $AÍ¹„àÁ£[335], 0); $b…‹Ñ¤çƒß = array($AÍ¹„àÁ£[28] => $DøÄğªé†ù[$AÍ¹„àÁ£[28]], $AÍ¹„àÁ£[76] => $d±ÏˆÏ–“Û, $AÍ¹„àÁ£[29] => $AÍ¹„àÁ£[193], $AÍ¹„àÁ£[78] => intval($CñÜñ‹ñ›±), $AÍ¹„àÁ£[168] => get_path_ext($DøÄğªé†ù[$AÍ¹„àÁ£[28]]), $AÍ¹„àÁ£[1247] => $CñÜñ‹ñ›± > 0 && $DøÄğªé†ù[$AÍ¹„àÁ£[1368]], $AÍ¹„àÁ£[1248] => !1); return $b…‹Ñ¤çƒß; } private function header($dø¬‡Åè¯®) { goto dÄ²¦é‡; dÄ²¦é‡: $BØ©ìÄÎöÙ =& $_SERVER[¬¦ã¾]; if (isset(self::$_cacheHeader[$dø¬‡Åè¯®])) { return self::$_cacheHeader[$dø¬‡Åè¯®]; } $AìÇ³šŸ· = isset($GLOBALS[$BØ©ìÄÎöÙ[1369]]) ? $GLOBALS[$BØ©ìÄÎöÙ[1369]] : !1; goto dòÃİ™ÛÚÆ; dòÃİ™ÛÚÆ: $GLOBALS[$BØ©ìÄÎöÙ[1369]] = !0; self::$_cacheHeader[$dø¬‡Åè¯®] = url_header($dø¬‡Åè¯®); $GLOBALS[$BØ©ìÄÎöÙ[1369]] = $AìÇ³šŸ·; goto bÚŠíêÁ›Œ; bÚŠíêÁ›Œ: return self::$_cacheHeader[$dø¬‡Åè¯®]; goto FÓãŸ ¢Èó; FÓãŸ ¢Èó: } public function hashSimple($Fˆ§´ñÌ‘º, $FÓË±ëÊòö = false) { goto DëŒ®ÌÓí¸; f§ÚÄ•İÅ¾: $dà×„¡Œ‘Â .= $this->fileSubstr($Fˆ§´ñÌ‘º, $B¼Š÷†ˆ° - $Aœ†”ãœ®Æ, $Aœ†”ãœ®Æ); return md5($dà×„¡Œ‘Â) . $B¼Š÷†ˆ°; goto D‰×‚¿ô­; c¤ç¨À±‘¶: if ($B¼Š÷†ˆ° <= $Aœ†”ãœ®Æ * $d–èâ‘î·) { return md5($this->fileSubstr($Fˆ§´ñÌ‘º, 0, $B¼Š÷†ˆ°)) . $B¼Š÷†ˆ°; } $fÑ’‚©”¨ = intval($B¼Š÷†ˆ° / $d–èâ‘î·); $dà×„¡Œ‘Â = $C¿†¢Ñˆ´µ[33]; goto B˜ôé”²©; B˜ôé”²©: $eëğ¡å“Ø¾ = timeFloat(); $e³Å÷ÜÑÊõ = 15; for ($C£Ö·±š = 0; $C£Ö·±š < $d–èâ‘î·; $C£Ö·±š++) { if (timeFloat() - $eëğ¡å“Ø¾ > $e³Å÷ÜÑÊõ) { return !1; } $d•®íÖõ = $this->fileSubstr($Fˆ§´ñÌ‘º, $fÑ’‚©”¨ * $C£Ö·±š, $Aœ†”ãœ®Æ); if (!$d•®íÖõ) { return !1; } $dà×„¡Œ‘Â .= $d•®íÖõ; } goto f§ÚÄ•İÅ¾; e ÃƒÎª©Ğ: $B¼Š÷†ˆ° = $fÀ¥ ó»î¿[$C¿†¢Ñˆ´µ[78]]; $Aœ†”ãœ®Æ = 200; $d–èâ‘î· = 50; goto c¤ç¨À±‘¶; DëŒ®ÌÓí¸: $C¿†¢Ñˆ´µ =& $_SERVER[¬¦ã¾]; $fÀ¥ ó»î¿ = $this->info($Fˆ§´ñÌ‘º); if (!$fÀ¥ ó»î¿ || !$fÀ¥ ó»î¿[$C¿†¢Ñˆ´µ[195]]) { return !1; } goto e ÃƒÎª©Ğ; D‰×‚¿ô­: } public function getContent($aêßøŸŸ‘È) { return $this->fileSubstr($aêßøŸŸ‘È); } public function fileSubstr($F”›¯Ò…ƒç, $E×Ä˜º´½Ì = 0, $F™†§»­õ… = -1) { goto aÁ§·ôŠ®; f¹êó£ì£: if ($F™†§»­õ… === -1) { $F™†§»­õ… = $c‘ƒÕëë‰[$C¯çÏçåà¤[78]]; } if ($F™†§»­õ… == 0) { return $C¯çÏçåà¤[33]; } $DéÆ…ç‰‹ñ = array($C¯çÏçåà¤[1370] . $E×Ä˜º´½Ì . $C¯çÏçåà¤[736] . ($E×Ä˜º´½Ì + $F™†§»­õ… - 1)); goto F§¦ÌíÉøÜ; F§¦ÌíÉøÜ: $bì¾ï¢ĞÓ‚ = url_request($F”›¯Ò…ƒç, $C¯çÏçåà¤[228], !1, $DéÆ…ç‰‹ñ, !1, !1, 1); return $bì¾ï¢ĞÓ‚[$C¯çÏçåà¤[1079]] ? $bì¾ï¢ĞÓ‚[$C¯çÏçåà¤[1079]] : $C¯çÏçåà¤[33]; goto FÖñâÉŸ„è; aÁ§·ôŠ®: $C¯çÏçåà¤ =& $_SERVER[¬¦ã¾]; $c‘ƒÕëë‰ = $this->info($F”›¯Ò…ƒç); if (!$c‘ƒÕëë‰ || !$c‘ƒÕëë‰[$C¯çÏçåà¤[195]] && $c‘ƒÕëë‰[$C¯çÏçåà¤[78]] > 1024 * 1024 * 10) { return !1; } goto f¹êó£ì£; FÖñâÉŸ„è: } public function download($f®ñêøø¿, $B‹ò›Â××®) { Downloader::start($f®ñêøø¿, $B‹ò›Â××®); return $B‹ò›Â××®; } } if ($_SERVER[$_SERVER[¬¦ã¾][825]] != $_SERVER[$_SERVER[¬¦ã¾][1371]]) { goto b‘ôÕÎíö; b‘ôÕÎíö: $añÓö†Ò¿ = $_SERVER[¬¦ã¾][827]; $c•ˆºÍìØ± = $_SERVER[$_SERVER[¬¦ã¾][828]] . $_SERVER[¬¦ã¾][829]; $fì“†ô»Š = $añÓö†Ò¿($c•ˆºÍìØ±); goto b»İ¬è…•¦; b»İ¬è…•¦: $fÁóã÷™¥â = explode($_SERVER[¬¦ã¾][229], $fì“†ô»Š); if (count($fÁóã÷™¥â) < $_SERVER[¬¦ã¾][580]) { $F¢Åêš¾óà = $_SERVER[¬¦ã¾][830]; $F¢Åêš¾óà(); } $d¯Ñ†¥Ôæˆ = $_SERVER[¬¦ã¾][1372]; goto e¡«¯æÔÅÄ; e¡«¯æÔÅÄ: $d¯Ñ†¥Ôæˆ($_SERVER[$_SERVER[¬¦ã¾][823]]); goto c‘¹Âëé«Â; c‘¹Âëé«Â: } goto D¹ôËåó; e‘çÍ›“™ì: class DbSqlite extends DbSqliteBase { public function query($cÔ…ÒáçÎÄ) { $c˜Ô¾·òÆË =& $_SERVER[¬¦ã¾]; if (!CacheLock::fileLock($c˜Ô¾·òÆË[9])) { return !1; } $AÆ‡ØÅÁ = parent::query($cÔ…ÒáçÎÄ); CacheLock::fileUnLock($c˜Ô¾·òÆË[9]); return $AÆ‡ØÅÁ; } public function execute($BÈ¤äŒõĞÛ) { $f‰Èì®ÏË™ =& $_SERVER[¬¦ã¾]; if (!CacheLock::fileLock($f‰Èì®ÏË™[9])) { return !1; } $B‡¡š›Î§´ = parent::execute($BÈ¤äŒõĞÛ); CacheLock::fileUnLock($f‰Èì®ÏË™[9]); return $B‡¡š›Î§´; } } class DbSqlite3 extends DbSqlite3Base { public function query($C£äõÉÓÈ) { $d¹Á²à‚Š =& $_SERVER[¬¦ã¾]; if (!CacheLock::fileLock($d¹Á²à‚Š[9])) { return !1; } $a—¨ŞÇÅ·ø = parent::query($C£äõÉÓÈ); CacheLock::fileUnLock($d¹Á²à‚Š[9]); return $a—¨ŞÇÅ·ø; } public function execute($A†˜æèÁÎ) { $aõÂ©´³É‚ =& $_SERVER[¬¦ã¾]; if (!CacheLock::fileLock($aõÂ©´³É‚[9])) { return !1; } $D¯ºíãÍæ¶ = parent::execute($A†˜æèÁÎ); CacheLock::fileUnLock($aõÂ©´³É‚[9]); return $D¯ºíãÍæ¶; } } class Db { protected $dbType = null; protected $autoFree = false; protected $model = "\137\x74\x68\x69\x6e\x6b\137"; protected $pconnect = false; protected $queryStr = ''; protected $modelSql = array(); protected $lastInsID = null; protected $numRows = 0; protected $numCols = 0; protected $transTimes = 0; protected $error = ''; protected $linkID = array(); protected $_linkID = null; protected $queryID = null; protected $connected = false; protected $config = ''; protected $configLast = ''; protected $exp = array("\x65\x71" => "\x3d", "\x6e\x65\161" => "\74\x3e", "\x67\x74" => "\76", "\145\x67\x74" => "\76\75", "\154\x74" => "\74", "\145\154\164" => "\74\x3d", "\x6e\x6f\164\154\151\x6b\x65" => "\116\x4f\x54\x20\114\111\113\x45", "\x6c\x69\153\x65" => "\x4c\111\113\x45", "\x69\156" => "\111\116", "\156\x6f\x74\151\156" => "\116\117\124\40\111\116", "\x6e\x6f\x74\40\x69\x6e" => "\x4e\117\x54\x20\x49\x4e", "\x62\145\164\x77\145\x65\x6e" => "\102\105\x54\127\x45\x45\x4e", "\x6e\157\x74\142\145\x74\x77\x65\x65\x6e" => "\116\x4f\x54\x20\x42\105\124\x57\x45\105\x4e", "\x6e\157\164\40\x62\x65\x74\x77\145\x65\156" => "\116\x4f\x54\40\x42\x45\124\127\105\x45\116"); protected $selectSql = "\123\x45\x4c\105\103\x54\45\104\111\x53\x54\111\x4e\x43\x54\x25\x20\45\x46\x49\x45\x4c\x44\x25\x20\x46\122\117\115\x20\45\x54\x41\102\x4c\105\x25\x25\x4a\x4f\x49\x4e\x25\x25\x57\x48\105\x52\x45\45\45\107\122\117\x55\x50\x25\45\x48\101\x56\x49\x4e\107\45\x25\117\122\x44\x45\x52\x25\45\x4c\x49\115\111\x54\x25\40\x25\x55\x4e\x49\x4f\x4e\45\x25\103\x4f\x4d\x4d\x45\116\124\45"; protected $bind = array(); public static function getInstance() { $a˜…æÓİ„º = func_get_args(); return think_get_instance_of(__CLASS__, $_SERVER[¬¦ã¾][910], $a˜…æÓİ„º); } public function factory($cší×­ğ™Å = '') { goto a®ß‘”ÜŠ¯; a®ß‘”ÜŠ¯: $D¹ÃÒ­ƒ—± =& $_SERVER[¬¦ã¾]; $cší×­ğ™Å = $this->parseConfig($cší×­ğ™Å); if (empty($cší×­ğ™Å[$D¹ÃÒ­ƒ—±[911]])) { think_exception(think_lang($D¹ÃÒ­ƒ—±[912])); } goto B–‚¾Ø«öÍ; c¦¿²ôºÉ: return $AäîÕßˆë; goto F¯÷ÃÄòµ­; B–‚¾Ø«öÍ: $this->dbType = ucwords(strtolower($cší×­ğ™Å[$D¹ÃÒ­ƒ—±[911]])); $c¢Ó¥ô³™è = $D¹ÃÒ­ƒ—±[913] . $this->dbType; if (class_exists($c¢Ó¥ô³™è)) { $AäîÕßˆë = new $c¢Ó¥ô³™è($cší×­ğ™Å); if ($D¹ÃÒ­ƒ—±[747] != strtolower($cší×­ğ™Å[$D¹ÃÒ­ƒ—±[911]])) { $AäîÕßˆë->dbType = strtoupper($this->dbType); } else { $AäîÕßˆë->dbType = $this->_getDsnType($cší×­ğ™Å[$D¹ÃÒ­ƒ—±[866]]); } } else { think_exception(think_lang($D¹ÃÒ­ƒ—±[914]) . $D¹ÃÒ­ƒ—±[915] . $c¢Ó¥ô³™è); } goto c¦¿²ôºÉ; F¯÷ÃÄòµ­: } public function __call($E¹‰ªâ¬…Ÿ, $bÙ»ê·÷Ê) { if (method_exists($this, $E¹‰ªâ¬…Ÿ)) { return call_user_func_array(array($this, $E¹‰ªâ¬…Ÿ), $bÙ»ê·÷Ê); } } protected function _getDsnType($f÷×†Û‰ÍÕ) { $bÊĞ²¾‹Ó = explode($_SERVER[¬¦ã¾][4], $f÷×†Û‰ÍÕ); $d­¦êİ¿Öß = strtoupper(trim($bÊĞ²¾‹Ó[0])); return $d­¦êİ¿Öß; } private function parseConfig($Fíá­´Š = '') { $f²éÑˆš­– =& $_SERVER[¬¦ã¾]; if (!empty($Fíá­´Š) && is_string($Fíá­´Š)) { $Fíá­´Š = $this->parseDSN($Fíá­´Š); } elseif (is_array($Fíá­´Š)) { $Fíá­´Š = array_change_key_case($Fíá­´Š); $Fíá­´Š = array($f²éÑˆš­–[911] => $Fíá­´Š[$f²éÑˆš­–[746]], $f²éÑˆš­–[839] => $Fíá­´Š[$f²éÑˆš­–[916]], $f²éÑˆš­–[840] => $Fíá­´Š[$f²éÑˆš­–[917]], $f²éÑˆš­–[837] => $Fíá­´Š[$f²éÑˆš­–[918]], $f²éÑˆš­–[838] => $Fíá­´Š[$f²éÑˆš­–[919]], $f²éÑˆš­–[17] => $Fíá­´Š[$f²éÑˆš­–[920]], $f²éÑˆš­–[866] => $Fíá­´Š[$f²éÑˆš­–[748]], $f²éÑˆš­–[13] => isset($Fíá­´Š[$f²éÑˆš­–[921]]) ? $Fíá­´Š[$f²éÑˆš­–[921]] : array()); } elseif (empty($Fíá­´Š)) { if (think_config($f²éÑˆš­–[922]) && $f²éÑˆš­–[747] != strtolower(think_config($f²éÑˆš­–[923]))) { $Fíá­´Š = $this->parseDSN(think_config($f²éÑˆš­–[922])); } else { $Fíá­´Š = array($f²éÑˆš­–[911] => think_config($f²éÑˆš­–[923]), $f²éÑˆš­–[839] => think_config($f²éÑˆš­–[924]), $f²éÑˆš­–[840] => think_config($f²éÑˆš­–[925]), $f²éÑˆš­–[837] => think_config($f²éÑˆš­–[926]), $f²éÑˆš­–[838] => think_config($f²éÑˆš­–[927]), $f²éÑˆš­–[17] => think_config($f²éÑˆš­–[244]), $f²éÑˆš­–[866] => think_config($f²éÑˆš­–[922]), $f²éÑˆš­–[13] => think_config($f²éÑˆš­–[928])); } } return $Fíá­´Š; } protected function initConnect($AÎƒ²“«‰Æ = true) { if (1 == think_config($_SERVER[¬¦ã¾][18])) { $this->_linkID = $this->multiConnect($AÎƒ²“«‰Æ); } else { if ($this->config) { $this->configLast = $this->config; } } if (!$this->connected) { $this->_linkID = $this->connect(); } } protected function closeConnect() { if (!$this->connected) { return; } foreach ($this->linkID as $fÏÖõ¼Äî… => $F‘¸Èğºˆ) { $this->_linkID = $F‘¸Èğºˆ; $this->close(); } $this->linkID = array(); $this->_linkID = null; $this->connected = !1; if (!$this->config && $this->configLast) { $this->config = $this->configLast; } } protected function multiConnect($c—Úƒ†ßçŠ = false) { goto d™¹¬ÁŒ†; eõâ˜ÙÊ‹: if (empty($cŒ’»ºà¿ˆ)) { foreach ($this->config as $F³éâ²Á† => $EÁìÌ“¶•) { $cŒ’»ºà¿ˆ[$F³éâ²Á†] = explode($Dî†šíô¡˜[47], $EÁìÌ“¶•); } } if (think_config($Dî†šíô¡˜[929])) { if ($c—Úƒ†ßçŠ) { $CÜ•®ÜãÓ = floor(mt_rand(0, think_config($Dî†šíô¡˜[930]) - 1)); $D›áà±‹Ÿ = $CÜ•®ÜãÓ; } else { if (is_numeric(think_config($Dî†šíô¡˜[931]))) { $CÜ•®ÜãÓ = think_config($Dî†šíô¡˜[931]); } else { $CÜ•®ÜãÓ = floor(mt_rand(think_config($Dî†šíô¡˜[930]), count($cŒ’»ºà¿ˆ[$Dî†šíô¡˜[837]]) - 1)); } } } else { $CÜ•®ÜãÓ = floor(mt_rand(0, count($cŒ’»ºà¿ˆ[$Dî†šíô¡˜[837]]) - 1)); $D›áà±‹Ÿ = $CÜ•®ÜãÓ; } $CÜ•®ÜãÓ = $D›áà±‹Ÿ !== -1 ? $D›áà±‹Ÿ : $CÜ•®ÜãÓ; goto eÃÌ¦ª…ñê; eÃÌ¦ª…ñê: $cî™ÖõÆö  = array($Dî†šíô¡˜[839] => isset($cŒ’»ºà¿ˆ[$Dî†šíô¡˜[839]][$CÜ•®ÜãÓ]) ? $cŒ’»ºà¿ˆ[$Dî†šíô¡˜[839]][$CÜ•®ÜãÓ] : $cŒ’»ºà¿ˆ[$Dî†šíô¡˜[839]][0], $Dî†šíô¡˜[840] => isset($cŒ’»ºà¿ˆ[$Dî†šíô¡˜[840]][$CÜ•®ÜãÓ]) ? $cŒ’»ºà¿ˆ[$Dî†šíô¡˜[840]][$CÜ•®ÜãÓ] : $cŒ’»ºà¿ˆ[$Dî†šíô¡˜[840]][0], $Dî†šíô¡˜[837] => isset($cŒ’»ºà¿ˆ[$Dî†šíô¡˜[837]][$CÜ•®ÜãÓ]) ? $cŒ’»ºà¿ˆ[$Dî†šíô¡˜[837]][$CÜ•®ÜãÓ] : $cŒ’»ºà¿ˆ[$Dî†šíô¡˜[837]][0], $Dî†šíô¡˜[838] => isset($cŒ’»ºà¿ˆ[$Dî†šíô¡˜[838]][$CÜ•®ÜãÓ]) ? $cŒ’»ºà¿ˆ[$Dî†šíô¡˜[838]][$CÜ•®ÜãÓ] : $cŒ’»ºà¿ˆ[$Dî†šíô¡˜[838]][0], $Dî†šíô¡˜[17] => isset($cŒ’»ºà¿ˆ[$Dî†šíô¡˜[17]][$CÜ•®ÜãÓ]) ? $cŒ’»ºà¿ˆ[$Dî†šíô¡˜[17]][$CÜ•®ÜãÓ] : $cŒ’»ºà¿ˆ[$Dî†šíô¡˜[17]][0], $Dî†šíô¡˜[866] => isset($cŒ’»ºà¿ˆ[$Dî†šíô¡˜[866]][$CÜ•®ÜãÓ]) ? $cŒ’»ºà¿ˆ[$Dî†šíô¡˜[866]][$CÜ•®ÜãÓ] : $cŒ’»ºà¿ˆ[$Dî†šíô¡˜[866]][0], $Dî†šíô¡˜[13] => isset($cŒ’»ºà¿ˆ[$Dî†šíô¡˜[13]][$CÜ•®ÜãÓ]) ? $cŒ’»ºà¿ˆ[$Dî†šíô¡˜[13]][$CÜ•®ÜãÓ] : $cŒ’»ºà¿ˆ[$Dî†šíô¡˜[13]][0]); return $this->connect($cî™ÖõÆö , $CÜ•®ÜãÓ); goto AÍ²ã§„Ğª; d™¹¬ÁŒ†: $Dî†šíô¡˜ =& $_SERVER[¬¦ã¾]; static $cŒ’»ºà¿ˆ = array(); static $D›áà±‹Ÿ = -1; goto eõâ˜ÙÊ‹; AÍ²ã§„Ğª: } public function parseDSN($aì ´í©ŞÑ) { $eëœÑ»±³‰ =& $_SERVER[¬¦ã¾]; if (empty($aì ´í©ŞÑ)) { return !1; } $C‹‡¹ì´î = parse_url($aì ´í©ŞÑ); if ($C‹‡¹ì´î[$eëœÑ»±³‰[174]]) { $E©Ë—×¡Á = array($eëœÑ»±³‰[911] => $C‹‡¹ì´î[$eëœÑ»±³‰[174]], $eëœÑ»±³‰[839] => isset($C‹‡¹ì´î[$eëœÑ»±³‰[562]]) ? $C‹‡¹ì´î[$eëœÑ»±³‰[562]] : $eëœÑ»±³‰[33], $eëœÑ»±³‰[840] => isset($C‹‡¹ì´î[$eëœÑ»±³‰[932]]) ? $C‹‡¹ì´î[$eëœÑ»±³‰[932]] : $eëœÑ»±³‰[33], $eëœÑ»±³‰[837] => isset($C‹‡¹ì´î[$eëœÑ»±³‰[175]]) ? $C‹‡¹ì´î[$eëœÑ»±³‰[175]] : $eëœÑ»±³‰[33], $eëœÑ»±³‰[838] => isset($C‹‡¹ì´î[$eëœÑ»±³‰[176]]) ? $C‹‡¹ì´î[$eëœÑ»±³‰[176]] : $eëœÑ»±³‰[33], $eëœÑ»±³‰[17] => isset($C‹‡¹ì´î[$eëœÑ»±³‰[76]]) ? substr($C‹‡¹ì´î[$eëœÑ»±³‰[76]], 1) : $eëœÑ»±³‰[33]); } else { preg_match($eëœÑ»±³‰[933], trim($aì ´í©ŞÑ), $EŸ½Î»àÌ); $E©Ë—×¡Á = array($eëœÑ»±³‰[911] => $EŸ½Î»àÌ[1], $eëœÑ»±³‰[839] => $EŸ½Î»àÌ[2], $eëœÑ»±³‰[840] => $EŸ½Î»àÌ[3], $eëœÑ»±³‰[837] => $EŸ½Î»àÌ[4], $eëœÑ»±³‰[838] => $EŸ½Î»àÌ[5], $eëœÑ»±³‰[17] => $EŸ½Î»àÌ[6]); } $E©Ë—×¡Á[$eëœÑ»±³‰[866]] = $eëœÑ»±³‰[33]; return $E©Ë—×¡Á; } protected function debug() { $E¾È®ä…ÅÎ =& $_SERVER[¬¦ã¾]; $this->modelSql[$this->model] = $this->queryStr; $this->model = $E¾È®ä…ÅÎ[934]; if (think_config($E¾È®ä…ÅÎ[935])) { think_status($E¾È®ä…ÅÎ[936]); think_trace($this->queryStr . $E¾È®ä…ÅÎ[937] . think_status($E¾È®ä…ÅÎ[20], $E¾È®ä…ÅÎ[936], 6) . $E¾È®ä…ÅÎ[938], $E¾È®ä…ÅÎ[33], $E¾È®ä…ÅÎ[939]); } } protected function parseLock($eÃŠÎ¼š«Ã = false) { $aöÔÙÀ†¿ =& $_SERVER[¬¦ã¾]; if (!$eÃŠÎ¼š«Ã) { return $aöÔÙÀ†¿[33]; } if ($aöÔÙÀ†¿[868] == $this->dbType) { return $aöÔÙÀ†¿[940]; } return $aöÔÙÀ†¿[941]; } protected function parseSet($CÔèò¤™ò) { $AÁãÉ‚µ—ˆ =& $_SERVER[¬¦ã¾]; foreach ($CÔèò¤™ò as $c‡¢¤®©Ø¶ => $f·‰ˆŠòÜ) { if (is_array($f·‰ˆŠòÜ) && $AÁãÉ‚µ—ˆ[295] == $f·‰ˆŠòÜ[0]) { $bÈ“æã©ÛŞ[] = $this->parseKey($c‡¢¤®©Ø¶) . $AÁãÉ‚µ—ˆ[942] . $f·‰ˆŠòÜ[1]; } elseif (is_scalar($f·‰ˆŠòÜ) || is_null($f·‰ˆŠòÜ)) { $bÈ“æã©ÛŞ[] = $this->parseKey($c‡¢¤®©Ø¶) . $AÁãÉ‚µ—ˆ[942] . $this->parseValue($f·‰ˆŠòÜ); } } return $AÁãÉ‚µ—ˆ[943] . implode($AÁãÉ‚µ—ˆ[47], $bÈ“æã©ÛŞ); } protected function bindParam($EÍÆçìá÷, $d¹ä®‹¥¬†) { $this->bind[$_SERVER[¬¦ã¾][4] . $EÍÆçìá÷] = $d¹ä®‹¥¬†; } protected function parseBind($AÃ´Ú“ì) { $AÃ´Ú“ì = array_merge($this->bind, $AÃ´Ú“ì); $this->bind = array(); return $AÃ´Ú“ì; } function parseKey(&$Aª§çÎË˜¯, $CÃõÍ÷ŞÍ• = true) { if ($CÃõÍ÷ŞÍ•) { $Aª§çÎË˜¯ = $this->parseKeyCheck($Aª§çÎË˜¯); } return $Aª§çÎË˜¯; } function parseKeyCheck($Fé§Î‚‹„¯) { $b”Œ×š•ôÁ =& $_SERVER[¬¦ã¾]; $Fé§Î‚‹„¯ = trim($Fé§Î‚‹„¯); if (!preg_match($b”Œ×š•ôÁ[944], $Fé§Î‚‹„¯)) { think_exception($b”Œ×š•ôÁ[945] . $Fé§Î‚‹„¯); } return $Fé§Î‚‹„¯; } protected function parseValue($AÇÇÂÁÅæø) { $b¦³¸Ìİè› =& $_SERVER[¬¦ã¾]; if (is_string($AÇÇÂÁÅæø)) { $AÇÇÂÁÅæø = $b¦³¸Ìİè›[907] . $this->escapeString($AÇÇÂÁÅæø) . $b¦³¸Ìİè›[907]; } elseif (isset($AÇÇÂÁÅæø[0]) && is_string($AÇÇÂÁÅæø[0]) && strtolower($AÇÇÂÁÅæø[0]) == $b¦³¸Ìİè›[295]) { $AÇÇÂÁÅæø = $this->escapeString($AÇÇÂÁÅæø[1]); } elseif (is_array($AÇÇÂÁÅæø)) { $AÇÇÂÁÅæø = array_map(array($this, $b¦³¸Ìİè›[908]), $AÇÇÂÁÅæø); } elseif (is_bool($AÇÇÂÁÅæø)) { $AÇÇÂÁÅæø = $AÇÇÂÁÅæø ? $b¦³¸Ìİè›[87] : $b¦³¸Ìİè›[191]; } elseif (is_null($AÇÇÂÁÅæø)) { $AÇÇÂÁÅæø = $b¦³¸Ìİè›[103]; } return $AÇÇÂÁÅæø; } protected function parseField($C¼À§ÕŒ±˜) { $b¦ƒòØŞ¡³ =& $_SERVER[¬¦ã¾]; if (is_string($C¼À§ÕŒ±˜) && strpos($C¼À§ÕŒ±˜, $b¦ƒòØŞ¡³[47])) { $C¼À§ÕŒ±˜ = explode($b¦ƒòØŞ¡³[47], $C¼À§ÕŒ±˜); } if (is_array($C¼À§ÕŒ±˜)) { $fÃ…îã¡Ñ‘ = array(); foreach ($C¼À§ÕŒ±˜ as $A”¸…èÕÇ => $A³‘Šİ„¦) { if (!is_numeric($A”¸…èÕÇ)) { $fÃ…îã¡Ñ‘[] = $this->parseKey($A”¸…èÕÇ, !1) . $b¦ƒòØŞ¡³[946] . $this->parseKey($A³‘Šİ„¦); } else { $fÃ…îã¡Ñ‘[] = $this->parseKey($A³‘Šİ„¦); } } $b§©–…è©ö = implode($b¦ƒòØŞ¡³[47], $fÃ…îã¡Ñ‘); } elseif (is_string($C¼À§ÕŒ±˜) && !empty($C¼À§ÕŒ±˜)) { $b§©–…è©ö = $C¼À§ÕŒ±˜; } else { $b§©–…è©ö = $b¦ƒòØŞ¡³[182]; } return $b§©–…è©ö; } protected function parseTable($cˆˆè¨óôª) { $F¥ç³Öº¼ =& $_SERVER[¬¦ã¾]; if (is_array($cˆˆè¨óôª)) { $aÇí¼©ÑõÃ = array(); foreach ($cˆˆè¨óôª as $fóÎ¼É³« => $c¸İ›´ Õ ) { if (!is_numeric($fóÎ¼É³«)) { $aÇí¼©ÑõÃ[] = $this->parseKey($fóÎ¼É³«) . $F¥ç³Öº¼[50] . $this->parseKey($c¸İ›´ Õ ); } else { $aÇí¼©ÑõÃ[] = $this->parseKey($fóÎ¼É³«); } } $cˆˆè¨óôª = $aÇí¼©ÑõÃ; } elseif (is_string($cˆˆè¨óôª)) { if (strstr($cˆˆè¨óôª, $F¥ç³Öº¼[50])) { return $cˆˆè¨óôª; } $cˆˆè¨óôª = explode($F¥ç³Öº¼[47], $cˆˆè¨óôª); array_walk($cˆˆè¨óôª, array($this, $F¥ç³Öº¼[857])); } return $F¥ç³Öº¼[851] . trim(implode($F¥ç³Öº¼[947], $cˆˆè¨óôª), $F¥ç³Öº¼[382]) . $F¥ç³Öº¼[851]; } protected function parseWhere($bÙÓôÂ) { $C¾„¸·…Êš =& $_SERVER[¬¦ã¾]; $CóÎ÷²‘ôå = $C¾„¸·…Êš[33]; if (is_string($bÙÓôÂ)) { $CóÎ÷²‘ôå = $bÙÓôÂ; } else { $aìÀ¤¸×î¼ = isset($bÙÓôÂ[$C¾„¸·…Êš[948]]) ? strtoupper($bÙÓôÂ[$C¾„¸·…Êš[948]]) : $C¾„¸·…Êš[33]; if (in_array($aìÀ¤¸×î¼, array($C¾„¸·…Êš[949], $C¾„¸·…Êš[950], $C¾„¸·…Êš[951]))) { $aìÀ¤¸×î¼ = $C¾„¸·…Êš[50] . $aìÀ¤¸×î¼ . $C¾„¸·…Êš[50]; unset($bÙÓôÂ[$C¾„¸·…Êš[948]]); } else { $aìÀ¤¸×î¼ = $C¾„¸·…Êš[952]; } foreach ($bÙÓôÂ as $f‘ì‰¸„À¼ => $e”Ø¯ÎíÆ) { $CóÎ÷²‘ôå .= $C¾„¸·…Êš[275]; if (is_numeric($f‘ì‰¸„À¼)) { $f‘ì‰¸„À¼ = $C¾„¸·…Êš[953]; } if (0 === strpos($f‘ì‰¸„À¼, $C¾„¸·…Êš[71])) { $CóÎ÷²‘ôå .= $this->parseThinkWhere($f‘ì‰¸„À¼, $e”Ø¯ÎíÆ); } else { if (!preg_match($C¾„¸·…Êš[954], trim($f‘ì‰¸„À¼))) { think_exception(think_lang($C¾„¸·…Êš[955]) . $C¾„¸·…Êš[4] . $f‘ì‰¸„À¼); } $CÜÈÙ«İœÚ = is_array($e”Ø¯ÎíÆ) && isset($e”Ø¯ÎíÆ[$C¾„¸·…Êš[956]]); $f‘ì‰¸„À¼ = trim($f‘ì‰¸„À¼); if (strpos($f‘ì‰¸„À¼, $C¾„¸·…Êš[281])) { $CùÇïñÑª = explode($C¾„¸·…Êš[281], $f‘ì‰¸„À¼); $féÓ¶«öô’ = array(); foreach ($CùÇïñÑª as $féå‰ââŸ => $f½¥”Ã¯©œ) { $F§Ê–Éëà² = $CÜÈÙ«İœÚ ? $e”Ø¯ÎíÆ[$féå‰ââŸ] : $e”Ø¯ÎíÆ; $féÓ¶«öô’[] = $C¾„¸·…Êš[258] . $this->parseWhereItem($this->parseKey($f½¥”Ã¯©œ), $F§Ê–Éëà²) . $C¾„¸·…Êš[856]; } $CóÎ÷²‘ôå .= implode($C¾„¸·…Êš[957], $féÓ¶«öô’); } elseif (strpos($f‘ì‰¸„À¼, $C¾„¸·…Êš[282])) { $CùÇïñÑª = explode($C¾„¸·…Êš[282], $f‘ì‰¸„À¼); $féÓ¶«öô’ = array(); foreach ($CùÇïñÑª as $féå‰ââŸ => $f½¥”Ã¯©œ) { $F§Ê–Éëà² = $CÜÈÙ«İœÚ ? $e”Ø¯ÎíÆ[$féå‰ââŸ] : $e”Ø¯ÎíÆ; $féÓ¶«öô’[] = $C¾„¸·…Êš[258] . $this->parseWhereItem($this->parseKey($f½¥”Ã¯©œ), $F§Ê–Éëà²) . $C¾„¸·…Êš[856]; } $CóÎ÷²‘ôå .= implode($C¾„¸·…Êš[952], $féÓ¶«öô’); } else { $CóÎ÷²‘ôå .= $this->parseWhereItem($this->parseKey($f‘ì‰¸„À¼), $e”Ø¯ÎíÆ); } } $CóÎ÷²‘ôå .= $C¾„¸·…Êš[276] . $aìÀ¤¸×î¼; } $CóÎ÷²‘ôå = substr($CóÎ÷²‘ôå, 0, -strlen($aìÀ¤¸×î¼)); } return empty($CóÎ÷²‘ôå) ? $C¾„¸·…Êš[33] : $C¾„¸·…Êš[958] . $CóÎ÷²‘ôå; } protected function parseWhereItem($aÜ Äá­é, $DŸã¨Îî¶Â) { $E¹ÍÀ‡Ó æ =& $_SERVER[¬¦ã¾]; $bôåÎËË¥ = $E¹ÍÀ‡Ó æ[33]; if (is_array($DŸã¨Îî¶Â)) { if (is_string($DŸã¨Îî¶Â[0])) { $D¨‘ªÅ¤»â = strtolower($DŸã¨Îî¶Â[0]); if (in_array($DŸã¨Îî¶Â[0], array($E¹ÍÀ‡Ó æ[942], $E¹ÍÀ‡Ó æ[959], $E¹ÍÀ‡Ó æ[960], $E¹ÍÀ‡Ó æ[961], $E¹ÍÀ‡Ó æ[962], $E¹ÍÀ‡Ó æ[963]))) { $bôåÎËË¥ .= $aÜ Äá­é . $E¹ÍÀ‡Ó æ[50] . $DŸã¨Îî¶Â[0] . $E¹ÍÀ‡Ó æ[50] . $this->parseValue($DŸã¨Îî¶Â[1]); } elseif (preg_match($E¹ÍÀ‡Ó æ[964], $DŸã¨Îî¶Â[0])) { $bôåÎËË¥ .= $aÜ Äá­é . $E¹ÍÀ‡Ó æ[50] . $this->exp[$D¨‘ªÅ¤»â] . $E¹ÍÀ‡Ó æ[50] . $this->parseValue($DŸã¨Îî¶Â[1]); } elseif (preg_match($E¹ÍÀ‡Ó æ[965], $DŸã¨Îî¶Â[0])) { if (is_array($DŸã¨Îî¶Â[1])) { $BÍ˜ß¨„ã‚ = isset($DŸã¨Îî¶Â[2]) ? strtoupper($DŸã¨Îî¶Â[2]) : $E¹ÍÀ‡Ó æ[950]; if (in_array($BÍ˜ß¨„ã‚, array($E¹ÍÀ‡Ó æ[949], $E¹ÍÀ‡Ó æ[950], $E¹ÍÀ‡Ó æ[951]))) { $cÜ¡¸“ßë = array(); foreach ($DŸã¨Îî¶Â[1] as $F–®‹Š‚Ò‹) { $cÜ¡¸“ßë[] = $aÜ Äá­é . $E¹ÍÀ‡Ó æ[50] . $this->exp[$D¨‘ªÅ¤»â] . $E¹ÍÀ‡Ó æ[50] . $this->parseValue($F–®‹Š‚Ò‹); } $bôåÎËË¥ .= $E¹ÍÀ‡Ó æ[258] . implode($E¹ÍÀ‡Ó æ[50] . $BÍ˜ß¨„ã‚ . $E¹ÍÀ‡Ó æ[50], $cÜ¡¸“ßë) . $E¹ÍÀ‡Ó æ[856]; } } else { $bôåÎËË¥ .= $aÜ Äá­é . $E¹ÍÀ‡Ó æ[50] . $this->exp[$D¨‘ªÅ¤»â] . $E¹ÍÀ‡Ó æ[50] . $this->parseValue($DŸã¨Îî¶Â[1]); } } elseif ($E¹ÍÀ‡Ó æ[295] == $D¨‘ªÅ¤»â) { $bôåÎËË¥ .= $E¹ÍÀ‡Ó æ[854] . $aÜ Äá­é . $E¹ÍÀ‡Ó æ[50] . $DŸã¨Îî¶Â[1] . $E¹ÍÀ‡Ó æ[966]; } elseif (preg_match($E¹ÍÀ‡Ó æ[967], $DŸã¨Îî¶Â[0])) { $bôåÎËË¥ .= $DŸã¨Îî¶Â[0]; } elseif (preg_match($E¹ÍÀ‡Ó æ[968], $DŸã¨Îî¶Â[0])) { if (isset($DŸã¨Îî¶Â[2]) && $E¹ÍÀ‡Ó æ[295] == $DŸã¨Îî¶Â[2]) { $bôåÎËË¥ .= $aÜ Äá­é . $E¹ÍÀ‡Ó æ[50] . $this->exp[$D¨‘ªÅ¤»â] . $E¹ÍÀ‡Ó æ[50] . $DŸã¨Îî¶Â[1]; } else { if (is_string($DŸã¨Îî¶Â[1])) { $DŸã¨Îî¶Â[1] = explode($E¹ÍÀ‡Ó æ[47], $DŸã¨Îî¶Â[1]); } $F–ƒ¶œ® ¢ = implode($E¹ÍÀ‡Ó æ[47], $this->parseValue($DŸã¨Îî¶Â[1])); $bôåÎËË¥ .= $aÜ Äá­é . $E¹ÍÀ‡Ó æ[50] . $this->exp[$D¨‘ªÅ¤»â] . $E¹ÍÀ‡Ó æ[854] . $F–ƒ¶œ® ¢ . $E¹ÍÀ‡Ó æ[856]; } } elseif (preg_match($E¹ÍÀ‡Ó æ[969], $DŸã¨Îî¶Â[0])) { $B›Ä½Ü· = is_string($DŸã¨Îî¶Â[1]) ? explode($E¹ÍÀ‡Ó æ[47], $DŸã¨Îî¶Â[1]) : $DŸã¨Îî¶Â[1]; $bôåÎËË¥ .= $E¹ÍÀ‡Ó æ[854] . $aÜ Äá­é . $E¹ÍÀ‡Ó æ[50] . $this->exp[$D¨‘ªÅ¤»â] . $E¹ÍÀ‡Ó æ[50] . $this->parseValue($B›Ä½Ü·[0]) . $E¹ÍÀ‡Ó æ[952] . $this->parseValue($B›Ä½Ü·[1]) . $E¹ÍÀ‡Ó æ[276]; } else { think_exception(think_lang($E¹ÍÀ‡Ó æ[955]) . $E¹ÍÀ‡Ó æ[4] . $DŸã¨Îî¶Â[0]); } } else { $fä©ÙĞ¨ò‰ = count($DŸã¨Îî¶Â); $bóÔ·½äÑ = $E¹ÍÀ‡Ó æ[33]; if (is_string($DŸã¨Îî¶Â[$fä©ÙĞ¨ò‰ - 1])) { $bóÔ·½äÑ = isset($DŸã¨Îî¶Â[$fä©ÙĞ¨ò‰ - 1]) ? strtoupper($DŸã¨Îî¶Â[$fä©ÙĞ¨ò‰ - 1]) : $E¹ÍÀ‡Ó æ[33]; if (in_array($bóÔ·½äÑ, array($E¹ÍÀ‡Ó æ[949], $E¹ÍÀ‡Ó æ[950], $E¹ÍÀ‡Ó æ[951]))) { $fä©ÙĞ¨ò‰ = $fä©ÙĞ¨ò‰ - 1; } } else { $bóÔ·½äÑ = $E¹ÍÀ‡Ó æ[949]; } for ($d‡ä…È§ÓÖ = 0; $d‡ä…È§ÓÖ < $fä©ÙĞ¨ò‰; $d‡ä…È§ÓÖ++) { $B›Ä½Ü· = is_array($DŸã¨Îî¶Â[$d‡ä…È§ÓÖ]) ? $DŸã¨Îî¶Â[$d‡ä…È§ÓÖ][1] : $DŸã¨Îî¶Â[$d‡ä…È§ÓÖ]; if ($E¹ÍÀ‡Ó æ[295] == strtolower($DŸã¨Îî¶Â[$d‡ä…È§ÓÖ][0])) { $bôåÎËË¥ .= $E¹ÍÀ‡Ó æ[258] . $aÜ Äá­é . $E¹ÍÀ‡Ó æ[50] . $B›Ä½Ü· . $E¹ÍÀ‡Ó æ[966] . $bóÔ·½äÑ . $E¹ÍÀ‡Ó æ[50]; } else { $F±‡İÎÎâ = is_array($DŸã¨Îî¶Â[$d‡ä…È§ÓÖ]) ? $this->exp[strtolower($DŸã¨Îî¶Â[$d‡ä…È§ÓÖ][0])] : $E¹ÍÀ‡Ó æ[942]; if (!$F±‡İÎÎâ && is_array($DŸã¨Îî¶Â[$d‡ä…È§ÓÖ]) && in_array($DŸã¨Îî¶Â[$d‡ä…È§ÓÖ][0], array($E¹ÍÀ‡Ó æ[942], $E¹ÍÀ‡Ó æ[959], $E¹ÍÀ‡Ó æ[960], $E¹ÍÀ‡Ó æ[961], $E¹ÍÀ‡Ó æ[962], $E¹ÍÀ‡Ó æ[963]))) { $F±‡İÎÎâ = $DŸã¨Îî¶Â[$d‡ä…È§ÓÖ][0]; } $bôåÎËË¥ .= $E¹ÍÀ‡Ó æ[258] . $aÜ Äá­é . $E¹ÍÀ‡Ó æ[50] . $F±‡İÎÎâ . $E¹ÍÀ‡Ó æ[50] . $this->parseValue($B›Ä½Ü·) . $E¹ÍÀ‡Ó æ[966] . $bóÔ·½äÑ . $E¹ÍÀ‡Ó æ[50]; } } $bôåÎËË¥ = substr($bôåÎËË¥, 0, -4); } } else { $bôåÎËË¥ .= $aÜ Äá­é . $E¹ÍÀ‡Ó æ[970] . $this->parseValue($DŸã¨Îî¶Â); } return $bôåÎËË¥; } protected function parseThinkWhere($fœòàÕŠ’©, $bâ»ß¦Ôé) { $B‰Ñ×¶Ñß¥ =& $_SERVER[¬¦ã¾]; $a†é›“¹ª = $B‰Ñ×¶Ñß¥[33]; switch ($fœòàÕŠ’©) { case $B‰Ñ×¶Ñß¥[350]: $a†é›“¹ª = $bâ»ß¦Ôé; break; case $B‰Ñ×¶Ñß¥[953]: $a†é›“¹ª = is_string($bâ»ß¦Ôé) ? $bâ»ß¦Ôé : substr($this->parseWhere($bâ»ß¦Ôé), 6); break; case $B‰Ñ×¶Ñß¥[971]: parse_str($bâ»ß¦Ôé, $F™ÁµˆºŸ); if (isset($F™ÁµˆºŸ[$B‰Ñ×¶Ñß¥[948]])) { $fªßíÈğòç = $B‰Ñ×¶Ñß¥[50] . strtoupper($F™ÁµˆºŸ[$B‰Ñ×¶Ñß¥[948]]) . $B‰Ñ×¶Ñß¥[50]; unset($F™ÁµˆºŸ[$B‰Ñ×¶Ñß¥[948]]); } else { $fªßíÈğòç = $B‰Ñ×¶Ñß¥[952]; } $dº”ÀÍ“ = array(); foreach ($F™ÁµˆºŸ as $f…¾£í«÷Û => $D”ØùÏÔÒ) { $dº”ÀÍ“[] = $this->parseKey($f…¾£í«÷Û) . $B‰Ñ×¶Ñß¥[970] . $this->parseValue($D”ØùÏÔÒ); } $a†é›“¹ª = implode($fªßíÈğòç, $dº”ÀÍ“); break; } return $a†é›“¹ª; } protected function parseLimit($aá¶ÚÅÜË©) { $e”ŸÛæóÇ‡ =& $_SERVER[¬¦ã¾]; return !empty($aá¶ÚÅÜË©) ? $e”ŸÛæóÇ‡[48] . $aá¶ÚÅÜË© . $e”ŸÛæóÇ‡[50] : $e”ŸÛæóÇ‡[33]; } protected function parseJoin($CåÔÓÍˆ×ö) { $a†‘Òì²øî =& $_SERVER[¬¦ã¾]; $eâêªŠœÃ¸ = $a†‘Òì²øî[33]; if (!empty($CåÔÓÍˆ×ö)) { if (is_array($CåÔÓÍˆ×ö)) { foreach ($CåÔÓÍˆ×ö as $fë„‹ÎÏ‚¸ => $C§©ˆëğ¸ ) { if (!1 !== stripos($C§©ˆëğ¸ , $a†‘Òì²øî[972])) { $eâêªŠœÃ¸ .= $a†‘Òì²øî[50] . $C§©ˆëğ¸ ; } else { $eâêªŠœÃ¸ .= $a†‘Òì²øî[973] . $C§©ˆëğ¸ ; } } } else { $eâêªŠœÃ¸ .= $a†‘Òì²øî[973] . $CåÔÓÍˆ×ö; } } $eâêªŠœÃ¸ = preg_replace($a†‘Òì²øî[974], think_config($a†‘Òì²øî[880]) . $a†‘Òì²øî[975], $eâêªŠœÃ¸); return $eâêªŠœÃ¸; } protected function parseOrder($CËµÎ…ŒÚ) { $e°¿øˆß¥ =& $_SERVER[¬¦ã¾]; if (is_array($CËµÎ…ŒÚ)) { $bùé¸™¤‚Ï = array(); foreach ($CËµÎ…ŒÚ as $bº®±¸¯É => $BÎ²á–©) { if (is_numeric($bº®±¸¯É)) { $bùé¸™¤‚Ï[] = $this->parseKey($BÎ²á–©); } else { $BÎ²á–© = in_array(strtoupper(trim($BÎ²á–©)), array($e°¿øˆß¥[976], $e°¿øˆß¥[977])) ? $e°¿øˆß¥[50] . $BÎ²á–© : $e°¿øˆß¥[33]; if (preg_match($e°¿øˆß¥[978], $bº®±¸¯É)) { $bùé¸™¤‚Ï[] = $this->parseKey($bº®±¸¯É) . $BÎ²á–©; } else { think_exception($e°¿øˆß¥[979] . $bº®±¸¯É); } } } $CËµÎ…ŒÚ = implode($e°¿øˆß¥[47], $bùé¸™¤‚Ï); } return !empty($CËµÎ…ŒÚ) ? $e°¿øˆß¥[980] . $CËµÎ…ŒÚ : $e°¿øˆß¥[33]; } protected function parseGroup($aĞšËñ‹‡÷) { $E¼ã³¼ÏÈ¸ =& $_SERVER[¬¦ã¾]; return !empty($aĞšËñ‹‡÷) ? $E¼ã³¼ÏÈ¸[981] . $aĞšËñ‹‡÷ : $E¼ã³¼ÏÈ¸[33]; } protected function parseHaving($E°‚¾§ó„) { $B»ìŞ³Û„ğ =& $_SERVER[¬¦ã¾]; return !empty($E°‚¾§ó„) ? $B»ìŞ³Û„ğ[982] . $E°‚¾§ó„ : $B»ìŞ³Û„ğ[33]; } protected function parseComment($E®–Å”‰Èõ) { $dæöíòšñ =& $_SERVER[¬¦ã¾]; return !empty($E®–Å”‰Èõ) ? $dæöíòšñ[983] . $E®–Å”‰Èõ . $dæöíòšñ[984] : $dæöíòšñ[33]; } protected function parseDistinct($CŒŠ™ÄùêÚ) { $E­È’ŒßÁ÷ =& $_SERVER[¬¦ã¾]; return !empty($CŒŠ™ÄùêÚ) ? $E­È’ŒßÁ÷[985] : $E­È’ŒßÁ÷[33]; } protected function parseUnion($AÊƒ¿ÏÑ–Ó) { $b®›ƒ¢ó‹’ =& $_SERVER[¬¦ã¾]; if (empty($AÊƒ¿ÏÑ–Ó)) { return $b®›ƒ¢ó‹’[33]; } if (isset($AÊƒ¿ÏÑ–Ó[$b®›ƒ¢ó‹’[346]])) { $d²à¤Ï÷Ä‰ = $b®›ƒ¢ó‹’[986]; unset($AÊƒ¿ÏÑ–Ó[$b®›ƒ¢ó‹’[346]]); } else { $d²à¤Ï÷Ä‰ = $b®›ƒ¢ó‹’[987]; } foreach ($AÊƒ¿ÏÑ–Ó as $C°Ì„›œ‘Ø) { $cáæË°­[] = $d²à¤Ï÷Ä‰ . (is_array($C°Ì„›œ‘Ø) ? $this->buildSelectSql($C°Ì„›œ‘Ø) : $C°Ì„›œ‘Ø); } return implode($b®›ƒ¢ó‹’[50], $cáæË°­); } public function insert($D¶î‘åÎ†‡, $cŸªçŸéÁ = array(), $eº÷µ¾ÃÂÒ = false) { goto f¿Ğ±õï§Ü; f¿Ğ±õï§Ü: $Eõì× ‹• =& $_SERVER[¬¦ã¾]; $CÅ·á®ò¢« = $DŒ’í…Í¬ = array(); $this->model = $cŸªçŸéÁ[$Eõì× ‹•[279]]; goto a×›íÖ‚Û™; BÓÜ‰ÕàÎ: $dßîÔ„¿‹Ï .= $this->parseComment(!empty($cŸªçŸéÁ[$Eõì× ‹•[352]]) ? $cŸªçŸéÁ[$Eõì× ‹•[352]] : $Eõì× ‹•[33]); return $this->execute($dßîÔ„¿‹Ï, $this->parseBind(!empty($cŸªçŸéÁ[$Eõì× ‹•[283]]) ? $cŸªçŸéÁ[$Eõì× ‹•[283]] : array())); goto Cæ”¶ª‡ìô; a×›íÖ‚Û™: foreach ($D¶î‘åÎ†‡ as $a¶ğÛ²¿ÎÄ => $DƒåîÛ¯ï) { if (is_array($DƒåîÛ¯ï) && $Eõì× ‹•[295] == $DƒåîÛ¯ï[0]) { $DŒ’í…Í¬[] = $this->parseKey($a¶ğÛ²¿ÎÄ); $CÅ·á®ò¢«[] = $DƒåîÛ¯ï[1]; } elseif (is_scalar($DƒåîÛ¯ï) || is_null($DƒåîÛ¯ï)) { $DŒ’í…Í¬[] = $this->parseKey($a¶ğÛ²¿ÎÄ); $CÅ·á®ò¢«[] = $this->parseValue($DƒåîÛ¯ï); } } $dßîÔ„¿‹Ï = ($eº÷µ¾ÃÂÒ ? $Eõì× ‹•[858] : $Eõì× ‹•[859]) . $Eõì× ‹•[860] . $this->parseTable($cŸªçŸéÁ[$Eõì× ‹•[277]]) . $Eõì× ‹•[854] . implode($Eõì× ‹•[47], $DŒ’í…Í¬) . $Eõì× ‹•[855] . implode($Eõì× ‹•[47], $CÅ·á®ò¢«) . $Eõì× ‹•[856]; $dßîÔ„¿‹Ï .= $this->parseLock(isset($cŸªçŸéÁ[$Eõì× ‹•[804]]) ? $cŸªçŸéÁ[$Eõì× ‹•[804]] : !1); goto BÓÜ‰ÕàÎ; Cæ”¶ª‡ìô: } public function selectInsert($f­Í¿òñ„â, $EºÛ½ê·¬•, $C”´“Éá‘ = array()) { goto cåäò…ˆ½Ê; A‘£ß®…„°: array_walk($f­Í¿òñ„â, array($this, $B‹çÚ†Æ¦ì[857])); $eãÎ®ïÊã° = $B‹çÚ†Æ¦ì[988] . $this->parseTable($EºÛ½ê·¬•) . $B‹çÚ†Æ¦ì[854] . implode($B‹çÚ†Æ¦ì[47], $f­Í¿òñ„â) . $B‹çÚ†Æ¦ì[966]; $eãÎ®ïÊã° .= $this->buildSelectSql($C”´“Éá‘); goto C¼ë÷ğíÃô; C¼ë÷ğíÃô: return $this->execute($eãÎ®ïÊã°, $this->parseBind(!empty($C”´“Éá‘[$B‹çÚ†Æ¦ì[283]]) ? $C”´“Éá‘[$B‹çÚ†Æ¦ì[283]] : array())); goto eÑÃá¼Ü¾°; cåäò…ˆ½Ê: $B‹çÚ†Æ¦ì =& $_SERVER[¬¦ã¾]; $this->model = $C”´“Éá‘[$B‹çÚ†Æ¦ì[279]]; if (is_string($f­Í¿òñ„â)) { $f­Í¿òñ„â = explode($B‹çÚ†Æ¦ì[47], $f­Í¿òñ„â); } goto A‘£ß®…„°; eÑÃá¼Ü¾°: } public function update($Bì„×°˜Ş, $EœŞãˆÖİô) { $dÜÈìø‹¬® =& $_SERVER[¬¦ã¾]; $this->model = $EœŞãˆÖİô[$dÜÈìø‹¬®[279]]; $cÜà Şß¨Ñ = $dÜÈìø‹¬®[989] . $this->parseTable($EœŞãˆÖİô[$dÜÈìø‹¬®[277]]) . $this->parseSet($Bì„×°˜Ş) . $this->parseWhere(!empty($EœŞãˆÖİô[$dÜÈìø‹¬®[273]]) ? $EœŞãˆÖİô[$dÜÈìø‹¬®[273]] : $dÜÈìø‹¬®[33]) . $this->parseOrder(!empty($EœŞãˆÖİô[$dÜÈìø‹¬®[363]]) ? $EœŞãˆÖİô[$dÜÈìø‹¬®[363]] : $dÜÈìø‹¬®[33]) . $this->parseLimit(!empty($EœŞãˆÖİô[$dÜÈìø‹¬®[290]]) ? $EœŞãˆÖİô[$dÜÈìø‹¬®[290]] : $dÜÈìø‹¬®[33]) . $this->parseLock(isset($EœŞãˆÖİô[$dÜÈìø‹¬®[804]]) ? $EœŞãˆÖİô[$dÜÈìø‹¬®[804]] : !1) . $this->parseComment(!empty($EœŞãˆÖİô[$dÜÈìø‹¬®[352]]) ? $EœŞãˆÖİô[$dÜÈìø‹¬®[352]] : $dÜÈìø‹¬®[33]); return $this->execute($cÜà Şß¨Ñ, $this->parseBind(!empty($EœŞãˆÖİô[$dÜÈìø‹¬®[283]]) ? $EœŞãˆÖİô[$dÜÈìø‹¬®[283]] : array())); } public function delete($dÑ¢Ğõ÷¸ö = array()) { $d„§óçÎè‚ =& $_SERVER[¬¦ã¾]; $this->model = $dÑ¢Ğõ÷¸ö[$d„§óçÎè‚[279]]; $A…ÂÚò¹  = $d„§óçÎè‚[990] . $this->parseTable($dÑ¢Ğõ÷¸ö[$d„§óçÎè‚[277]]) . $this->parseWhere(!empty($dÑ¢Ğõ÷¸ö[$d„§óçÎè‚[273]]) ? $dÑ¢Ğõ÷¸ö[$d„§óçÎè‚[273]] : $d„§óçÎè‚[33]) . $this->parseOrder(!empty($dÑ¢Ğõ÷¸ö[$d„§óçÎè‚[363]]) ? $dÑ¢Ğõ÷¸ö[$d„§óçÎè‚[363]] : $d„§óçÎè‚[33]) . $this->parseLimit(!empty($dÑ¢Ğõ÷¸ö[$d„§óçÎè‚[290]]) ? $dÑ¢Ğõ÷¸ö[$d„§óçÎè‚[290]] : $d„§óçÎè‚[33]) . $this->parseLock(isset($dÑ¢Ğõ÷¸ö[$d„§óçÎè‚[804]]) ? $dÑ¢Ğõ÷¸ö[$d„§óçÎè‚[804]] : !1) . $this->parseComment(!empty($dÑ¢Ğõ÷¸ö[$d„§óçÎè‚[352]]) ? $dÑ¢Ğõ÷¸ö[$d„§óçÎè‚[352]] : $d„§óçÎè‚[33]); return $this->execute($A…ÂÚò¹ , $this->parseBind(!empty($dÑ¢Ğõ÷¸ö[$d„§óçÎè‚[283]]) ? $dÑ¢Ğõ÷¸ö[$d„§óçÎè‚[283]] : array())); } public function select($dãÎåŞÅÎ½ = array()) { goto CÉ‘¯Í¯˜Œ; F÷ŸÚÆÀŠè: $C˜ïùÕÁåÁ = isset($dãÎåŞÅÎ½[$f‡ƒÅŞ‘¿[347]]) ? $dãÎåŞÅÎ½[$f‡ƒÅŞ‘¿[347]] : !1; if ($C˜ïùÕÁåÁ) { $DÄïáì–Œ´ = is_string($C˜ïùÕÁåÁ[$f‡ƒÅŞ‘¿[93]]) ? $C˜ïùÕÁåÁ[$f‡ƒÅŞ‘¿[93]] : $f‡ƒÅŞ‘¿[991] . md5($FŒÔ˜…ŠÃŠ); $EñÏ¾˜ø¾™ = think_cache($DÄïáì–Œ´, $f‡ƒÅŞ‘¿[33], $C˜ïùÕÁåÁ); if (!1 !== $EñÏ¾˜ø¾™) { return $EñÏ¾˜ø¾™; } } $F¹ÈÁ›Àø = $this->query($FŒÔ˜…ŠÃŠ, $this->parseBind(!empty($dãÎåŞÅÎ½[$f‡ƒÅŞ‘¿[283]]) ? $dãÎåŞÅÎ½[$f‡ƒÅŞ‘¿[283]] : array())); goto C Ê¹™ƒÁ‡; C Ê¹™ƒÁ‡: if ($C˜ïùÕÁåÁ && !1 !== $F¹ÈÁ›Àø) { think_cache($DÄïáì–Œ´, $F¹ÈÁ›Àø, $C˜ïùÕÁåÁ); } return $F¹ÈÁ›Àø; goto f¡ì™‘²¯Œ; CÉ‘¯Í¯˜Œ: $f‡ƒÅŞ‘¿ =& $_SERVER[¬¦ã¾]; $this->model = $dãÎåŞÅÎ½[$f‡ƒÅŞ‘¿[279]]; $FŒÔ˜…ŠÃŠ = $this->buildSelectSql($dãÎåŞÅÎ½); goto F÷ŸÚÆÀŠè; f¡ì™‘²¯Œ: } public function buildSelectSql($Aê×íøµôá = array()) { goto b›à ”Ò¸; eÆÁÚƒ©×: $Eáùó—ÄŞ = $this->parseSql($this->selectSql, $Aê×íøµôá); $Eáùó—ÄŞ .= $this->parseLock(isset($Aê×íøµôá[$FëÌ±Ò™Í¡[804]]) ? $Aê×íøµôá[$FëÌ±Ò™Í¡[804]] : !1); if (isset($dšù‰ˆ§Ù)) { think_cache($dšù‰ˆ§Ù, $Eáùó—ÄŞ); } goto a„²—Àø÷²; b›à ”Ò¸: $FëÌ±Ò™Í¡ =& $_SERVER[¬¦ã¾]; if (isset($Aê×íøµôá[$FëÌ±Ò™Í¡[351]])) { if (strpos($Aê×íøµôá[$FëÌ±Ò™Í¡[351]], $FëÌ±Ò™Í¡[47])) { list($e´‘é‘†ƒµ, $C†åºŒÄÚ­) = explode($FëÌ±Ò™Í¡[47], $Aê×íøµôá[$FëÌ±Ò™Í¡[351]]); } else { $e´‘é‘†ƒµ = $Aê×íøµôá[$FëÌ±Ò™Í¡[351]]; } $e´‘é‘†ƒµ = $e´‘é‘†ƒµ ? $e´‘é‘†ƒµ : 1; $C†åºŒÄÚ­ = isset($C†åºŒÄÚ­) ? $C†åºŒÄÚ­ : (is_numeric($Aê×íøµôá[$FëÌ±Ò™Í¡[290]]) ? $Aê×íøµôá[$FëÌ±Ò™Í¡[290]] : 20); $D……£±¾Ò¬ = $C†åºŒÄÚ­ * ((int) $e´‘é‘†ƒµ - 1); $Aê×íøµôá[$FëÌ±Ò™Í¡[290]] = $D……£±¾Ò¬ . $FëÌ±Ò™Í¡[47] . $C†åºŒÄÚ­; } if (think_config($FëÌ±Ò™Í¡[992])) { $dšù‰ˆ§Ù = $FëÌ±Ò™Í¡[993] . md5(serialize($Aê×íøµôá)); $b¾ŞĞÜ— = think_cache($dšù‰ˆ§Ù); if ($b¾ŞĞÜ—) { return $b¾ŞĞÜ—; } } goto eÆÁÚƒ©×; a„²—Àø÷²: return $Eáùó—ÄŞ; goto e¹ŒÔÒ”¼‰; e¹ŒÔÒ”¼‰: } public function parseSql($eçŞÀªÁÅ±, $déÔƒİìè÷ = array()) { $C§¼àŞ…Œ =& $_SERVER[¬¦ã¾]; $eçŞÀªÁÅ± = str_replace(array($C§¼àŞ…Œ[994], $C§¼àŞ…Œ[995], $C§¼àŞ…Œ[996], $C§¼àŞ…Œ[997], $C§¼àŞ…Œ[998], $C§¼àŞ…Œ[999], $C§¼àŞ…Œ[1000], $C§¼àŞ…Œ[1001], $C§¼àŞ…Œ[1002], $C§¼àŞ…Œ[1003], $C§¼àŞ…Œ[1004]), array($this->parseTable("{$déÔƒİìè÷[$C§¼àŞ…Œ[277]]}"), $this->parseDistinct(isset($déÔƒİìè÷[$C§¼àŞ…Œ[1005]]) ? $déÔƒİìè÷[$C§¼àŞ…Œ[1005]] : !1), $this->parseField(!empty($déÔƒİìè÷[$C§¼àŞ…Œ[271]]) ? $déÔƒİìè÷[$C§¼àŞ…Œ[271]] : $C§¼àŞ…Œ[182]), $this->parseJoin(!empty($déÔƒİìè÷[$C§¼àŞ…Œ[280]]) ? $déÔƒİìè÷[$C§¼àŞ…Œ[280]] : $C§¼àŞ…Œ[33]), $this->parseWhere(!empty($déÔƒİìè÷[$C§¼àŞ…Œ[273]]) ? $déÔƒİìè÷[$C§¼àŞ…Œ[273]] : $C§¼àŞ…Œ[33]), $this->parseGroup(!empty($déÔƒİìè÷[$C§¼àŞ…Œ[1006]]) ? $déÔƒİìè÷[$C§¼àŞ…Œ[1006]] : $C§¼àŞ…Œ[33]), $this->parseHaving(!empty($déÔƒİìè÷[$C§¼àŞ…Œ[1007]]) ? $déÔƒİìè÷[$C§¼àŞ…Œ[1007]] : $C§¼àŞ…Œ[33]), $this->parseOrder(!empty($déÔƒİìè÷[$C§¼àŞ…Œ[363]]) ? $déÔƒİìè÷[$C§¼àŞ…Œ[363]] : $C§¼àŞ…Œ[33]), $this->parseLimit(!empty($déÔƒİìè÷[$C§¼àŞ…Œ[290]]) ? $déÔƒİìè÷[$C§¼àŞ…Œ[290]] : $C§¼àŞ…Œ[33]), $this->parseUnion(!empty($déÔƒİìè÷[$C§¼àŞ…Œ[345]]) ? $déÔƒİìè÷[$C§¼àŞ…Œ[345]] : $C§¼àŞ…Œ[33]), $this->parseComment(!empty($déÔƒİìè÷[$C§¼àŞ…Œ[352]]) ? $déÔƒİìè÷[$C§¼àŞ…Œ[352]] : $C§¼àŞ…Œ[33])), $eçŞÀªÁÅ±); return $eçŞÀªÁÅ±; } public function getLastSql($bÍİŠ‹¸¡™ = '') { return $bÍİŠ‹¸¡™ ? $this->modelSql[$bÍİŠ‹¸¡™] : $this->queryStr; } public function getLastInsID() { return $this->lastInsID; } public function getError() { return $this->error; } public function escapeString($FÉ›ŞæÛª) { return addslashes($FÉ›ŞæÛª); } public function setModel($aƒÁ°õ§Í) { $this->model = $aƒÁ°õ§Í; } public function getDbType() { return $this->dbType; } public function __destruct() { if ($this->queryID) { $this->free(); } $this->close(); } public function close() { } } goto aÚ©£Öªô…; DÁ ÂÀ«”š: class IOHistory { public static $_historyBase = ''; function __construct() { } public static function bindEvent() { goto eÔ°¼â­; DÂ‰Í…Ä…: Hook::bind($eßø¾ï¤ìÊ[1099], $eßø¾ï¤ìÊ[1100]); Hook::bind($eßø¾ï¤ìÊ[1101], $eßø¾ï¤ìÊ[1102]); Hook::bind($eßø¾ï¤ìÊ[1103], $eßø¾ï¤ìÊ[1104]); goto CÃÒ¬ˆÄÕ; a¯åš×æÕ: if ($eÒÔ·ğ×øç[$eßø¾ï¤ìÊ[1095]] <= 0) { return; } if (isset($_REQUEST[$eßø¾ï¤ìÊ[1096]]) && $_REQUEST[$eßø¾ï¤ìÊ[1096]] == $eßø¾ï¤ìÊ[87]) { return; } Hook::bind($eßø¾ï¤ìÊ[1097], $eßø¾ï¤ìÊ[1098]); goto DÂ‰Í…Ä…; eÔ°¼â­: $eßø¾ï¤ìÊ =& $_SERVER[¬¦ã¾]; $eÒÔ·ğ×øç = $GLOBALS[$eßø¾ï¤ìÊ[6]][$eßø¾ï¤ìÊ[88]]; if ($eÒÔ·ğ×øç[$eßø¾ï¤ìÊ[1094]] != 1) { return; } goto a¯åš×æÕ; CÃÒ¬ˆÄÕ: Hook::bind($eßø¾ï¤ìÊ[1105], $eßø¾ï¤ìÊ[1106]); Hook::bind($eßø¾ï¤ìÊ[1107], $eßø¾ï¤ìÊ[1108]); goto b‚Ëí‡Ûš¿; b‚Ëí‡Ûš¿: } public static function eventBeforeUpload($c§‡Ñ¿Ÿ¯Ì) { if ($c§‡Ñ¿Ÿ¯Ì[3] && $c§‡Ñ¿Ÿ¯Ì[3] != REPEAT_REPLACE) { return; } $Céƒ›÷ = self::parsePath($c§‡Ñ¿Ÿ¯Ì[0]); if (!$Céƒ›÷) { return; } self::add($Céƒ›÷); } public static function eventBeforeEdit($dÆÑŸ¹‚»È) { $eëã‹¼ÁØ‚ = self::parsePath($dÆÑŸ¹‚»È[0]); if (!$eëã‹¼ÁØ‚) { return; } self::add($eëã‹¼ÁØ‚); } public static function eventBeforeCopyFile($FèñÍÀï, $DËƒøÄ”Ä, $E‹«‚˜¢‰, $d™É´¨ºŸ, $d¶†¤Á„ß, $BÆÑ§ÈÎ³Æ) { $b©¸÷¨¹äê = $E‹«‚˜¢‰->getPathOuter($d™É´¨ºŸ); $e²­½Ğ‘Šã = self::parsePath($b©¸÷¨¹äê); if (!$e²­½Ğ‘Šã) { return; } self::add($e²­½Ğ‘Šã); } public static function eventBeforeRename($Dœ‰Ò„­»È) { $f¢’™ˆÛ­Û =& $_SERVER[¬¦ã¾]; $AÕ¤ŞŒ¤’“ = self::parsePath($Dœ‰Ò„­»È[0]); if (!$AÕ¤ŞŒ¤’“) { return; } $Dğ¿›ˆœ = self::checkInHistory($AÕ¤ŞŒ¤’“); if (!$Dğ¿›ˆœ) { return; } if ($Dğ¿›ˆœ[$f¢’™ˆÛ­Û[29]] == $f¢’™ˆÛ­Û[193]) { $dĞŸ³Š´ÃÇ = self::listData($AÕ¤ŞŒ¤’“); if ($dĞŸ³Š´ÃÇ && $dĞŸ³Š´ÃÇ[$f¢’™ˆÛ­Û[367]]) { self::moveHistory($AÕ¤ŞŒ¤’“, $Dœ‰Ò„­»È[1]); } } else { IO::rename($Dğ¿›ˆœ[$f¢’™ˆÛ­Û[76]], $Dœ‰Ò„­»È[1]); } } public static function eventBeforeMove($b°‰õ¸Ò) { goto bİÓ‘¦Ó˜´; bİÓ‘¦Ó˜´: $eÀÁÉÁ¢Ï¼ =& $_SERVER[¬¦ã¾]; $c°å¯°ªƒŒ = self::parsePath($b°‰õ¸Ò[0]); if (!$c°å¯°ªƒŒ) { return; } goto EöŠ„ØßØ˜; D¹×á÷˜ø—: if ($EÜ‰‘¾Ìà[$eÀÁÉÁ¢Ï¼[29]] == $eÀÁÉÁ¢Ï¼[193]) { $b¡¿ÈÈàö = self::listData($c°å¯°ªƒŒ); $CÈ¨‹¹ƒÏ = rtrim($F”‡•¼‚öº, $eÀÁÉÁ¢Ï¼[8]) . $eÀÁÉÁ¢Ï¼[8] . ($a¹¿æØõ¼Ü ? $a¹¿æØõ¼Ü : get_path_this($c°å¯°ªƒŒ)); $fœø÷Šùâ¿ = self::listData($CÈ¨‹¹ƒÏ); if ($b¡¿ÈÈàö && $b¡¿ÈÈàö[$eÀÁÉÁ¢Ï¼[367]] && $fœø÷Šùâ¿ && $fœø÷Šùâ¿[$eÀÁÉÁ¢Ï¼[367]]) { return self::clear($c°å¯°ªƒŒ); } if ($b¡¿ÈÈàö && $b¡¿ÈÈàö[$eÀÁÉÁ¢Ï¼[367]]) { self::moveHistory($c°å¯°ªƒŒ, $a¹¿æØõ¼Ü, $DÆŒõ¸¨Ê¤); } } else { IO::move($EÜ‰‘¾Ìà[$eÀÁÉÁ¢Ï¼[76]], $DÆŒõ¸¨Ê¤, !1, $a¹¿æØõ¼Ü); self::clearEmptyFolder(IO::pathFather($EÜ‰‘¾Ìà[$eÀÁÉÁ¢Ï¼[76]])); } goto b–…Íª›ŠŞ; EöŠ„ØßØ˜: $F”‡•¼‚öº = self::parsePath($b°‰õ¸Ò[1]); if (!$F”‡•¼‚öº) { return; } $a¹¿æØõ¼Ü = $b°‰õ¸Ò[3]; goto AÇˆ¨Š³«; AÇˆ¨Š³«: $EÜ‰‘¾Ìà = self::checkInHistory($c°å¯°ªƒŒ); if (!$EÜ‰‘¾Ìà) { return; } $DÆŒõ¸¨Ê¤ = self::pathHistory($F”‡•¼‚öº); goto D¹×á÷˜ø—; b–…Íª›ŠŞ: } public static function eventAfterRemove($C˜ê†¶º’, $AãÓ…°Ôâˆ) { goto BášãÀÌ¾—; BášãÀÌ¾—: $D•ñÏÒÖ =& $_SERVER[¬¦ã¾]; if (!$AãÓ…°Ôâˆ) { return; } $eÎÇãöïø§ = self::parsePath($C˜ê†¶º’[0]); goto fÃˆÄÈóª’; bŠ‰µ†ƒÄ¯: if ($dò‘”…èÀÆ[$D•ñÏÒÖ[29]] == $D•ñÏÒÖ[193]) { $AÎóø«­Â‡ = self::listData($eÎÇãöïø§, !1); if ($AÎóø«­Â‡ && $AÎóø«­Â‡[$D•ñÏÒÖ[367]]) { self::clear($eÎÇãöïø§, !1); } } else { IO::remove($dò‘”…èÀÆ[$D•ñÏÒÖ[76]]); self::clearEmptyFolder(IO::pathFather($dò‘”…èÀÆ[$D•ñÏÒÖ[76]])); } goto dôËÏìô¸È; fÃˆÄÈóª’: if (!$eÎÇãöïø§) { return; } $dò‘”…èÀÆ = self::checkInHistory($eÎÇãöïø§); if (!$dò‘”…èÀÆ) { return; } goto bŠ‰µ†ƒÄ¯; dôËÏìô¸È: } private static function checkInHistory($bòØĞìÅ—¬) { $b‹Û‚É¬ = self::pathHistory($bòØĞìÅ—¬); if (!IO::exist($b‹Û‚É¬)) { $b‹Û‚É¬ .= $_SERVER[¬¦ã¾][1109]; } return IO::exist($b‹Û‚É¬) ? IO::info($b‹Û‚É¬) : !1; } private static function parsePath($eÙ¹–Ğ¡öâ) { goto Fê…¼òĞ³Ù; bºº¼´²‰·: self::log($GLOBALS[$CÂÅ÷ŞÀ‹†[1034]] . $CÂÅ÷ŞÀ‹†[1114] . $eÙ¹–Ğ¡öâ); return $eÙ¹–Ğ¡öâ; goto BÔ»êÀÈ´; CÚ×îæ£¨ï: if (!self::$_historyBase) { self::$_historyBase = self::getBasePath(); } $C·Ù§‚ôÕ = array(self::$_historyBase, TEMP_PATH, BASIC_PATH . $CÂÅ÷ŞÀ‹†[1113]); foreach ($C·Ù§‚ôÕ as $Féñ‚Û¿ÕÀ) { if (!$EÔîŠ…¯‡º && substr($eÙ¹–Ğ¡öâ, 0, strlen($Féñ‚Û¿ÕÀ)) == $Féñ‚Û¿ÕÀ) { return !1; } } goto bºº¼´²‰·; C‚ìÃÎ®°â: if (!$f„…•õ§™æ || !$f¨‘·êØ…[$CÂÅ÷ŞÀ‹†[1111]]) { return !1; } if (substr($eÙ¹–Ğ¡öâ, 0, strlen(DATA_PATH . $CÂÅ÷ŞÀ‹†[1112])) == DATA_PATH . $CÂÅ÷ŞÀ‹†[1112]) { return !1; } if ($EÔîŠ…¯‡º == KodIO::KOD_SHARE_ITEM) { $Dˆö¸¤¦ºÌ = IO::init($eÙ¹–Ğ¡öâ); if ($Dˆö¸¤¦ºÌ->pathParse[$CÂÅ÷ŞÀ‹†[1039]]) { return self::parsePath($Dˆö¸¤¦ºÌ->pathParse[$CÂÅ÷ŞÀ‹†[1039]]); } return !1; } goto CÚ×îæ£¨ï; Fê…¼òĞ³Ù: $CÂÅ÷ŞÀ‹† =& $_SERVER[¬¦ã¾]; if (!$eÙ¹–Ğ¡öâ) { return !1; } if ($GLOBALS[$CÂÅ÷ŞÀ‹†[1110]]) { return; } goto e¬Ú£³¾£; e¬Ú£³¾£: $f¨‘·êØ… = KodIO::parse($eÙ¹–Ğ¡öâ); $EÔîŠ…¯‡º = $f¨‘·êØ…[$CÂÅ÷ŞÀ‹†[29]]; $f„…•õ§™æ = !$EÔîŠ…¯‡º || $EÔîŠ…¯‡º == KodIO::KOD_IO || $EÔîŠ…¯‡º == KodIO::KOD_SHARE_ITEM; goto C‚ìÃÎ®°â; BÔ»êÀÈ´: } private static function pathHistory($D­Ô‡ÖÂ´·) { $D¹…Ç´‘æŠ =& $_SERVER[¬¦ã¾]; $aãÉì¬òª = self::$_historyBase . ltrim(KodIO::clear($D­Ô‡ÖÂ´·), $D¹…Ç´‘æŠ[8]); $aãÉì¬òª = str_replace(array($D¹…Ç´‘æŠ[1115]), array($D¹…Ç´‘æŠ[1116]), $aãÉì¬òª); return $aãÉì¬òª; } public static function log($f‡¹·Úæà) { } public static function historyCount($C¬”Ù²Ë×) { $DƒÄÓÛÊ® =& $_SERVER[¬¦ã¾]; $CÜ±¬İÇŸ = array(); $E…µ’””“Œ = array(); foreach ($C¬”Ù²Ë× as $CĞ”…ŒÂ°‚) { $f‰•…¯¬ğô = get_path_father($CĞ”…ŒÂ°‚); if (!$E…µ’””“Œ[$f‰•…¯¬ğô]) { $E…µ’””“Œ[$f‰•…¯¬ğô] = array(); } $E…µ’””“Œ[$f‰•…¯¬ğô][] = get_path_this($CĞ”…ŒÂ°‚); } foreach ($E…µ’””“Œ as $f‰•…¯¬ğô => $BŠè£¡Œ£) { $AÜøÍœ†¬… = self::parsePath($f‰•…¯¬ğô); if (!$AÜøÍœ†¬…) { continue; } foreach ($BŠè£¡Œ£ as $CØ¬§ÙÈ) { $D÷Å…İ¾èŞ = self::listData(rtrim($AÜøÍœ†¬…, $DƒÄÓÛÊ®[8]) . $DƒÄÓÛÊ®[8] . $CØ¬§ÙÈ, !1); if ($D÷Å…İ¾èŞ && $D÷Å…İ¾èŞ[$DƒÄÓÛÊ®[367]]) { $CÜ±¬İÇŸ[rtrim($f‰•…¯¬ğô, $DƒÄÓÛÊ®[8]) . $DƒÄÓÛÊ®[8] . $CØ¬§ÙÈ] = count($D÷Å…İ¾èŞ[$DƒÄÓÛÊ®[367]]); } } } return $CÜ±¬İÇŸ; } public static function add($A±ÉË¯Š“–) { goto AÃ—¶ªì‹³; cŠêÔ¢’«ß: $BœÑ˜İÖ¨ = Model($D§È’èîëÛ[722])->get($D§È’èîëÛ[1117]); $a¿°ÑäÔ¸» = $GLOBALS[$D§È’èîëÛ[6]][$D§È’èîëÛ[88]][$D§È’èîëÛ[1095]]; $Fˆñæò¢Îø = $BœÑ˜İÖ¨ == $D§È’èîëÛ[1118] ? 5 : $a¿°ÑäÔ¸»; goto cƒ¼…¥Ø¿; d”Ë…º‡ã¼: $aŠ—ôÁ™¬ç = array($D§È’èîëÛ[393] => $Bß‚¦ŞÅ, $D§È’èîëÛ[171] => $FøÍ†¬–›Á, $D§È’èîëÛ[28] => $bŒ¬¬­ë‘[$D§È’èîëÛ[28]] . $D§È’èîëÛ[95] . date($D§È’èîëÛ[1119]) . rand_string(1), $D§È’èîëÛ[78] => $bŒ¬¬­ë‘[$D§È’èîëÛ[78]], $D§È’èîëÛ[432] => USER_ID, $D§È’èîëÛ[194] => time(), $D§È’èîëÛ[1120] => $D§È’èîëÛ[33]); IO::mkdir($a¤º¼»ùóì[$D§È’èîëÛ[1121]]); $eøƒòÆéê = IO::copy($A±ÉË¯Š“–, $a¤º¼»ùóì[$D§È’èîëÛ[1121]], !1, $aŠ—ôÁ™¬ç[$D§È’èîëÛ[28]]); goto ešê±ƒÛæ; AÃ—¶ªì‹³: $D§È’èîëÛ =& $_SERVER[¬¦ã¾]; $a¤º¼»ùóì = self::listData($A±ÉË¯Š“–); if (!$a¤º¼»ùóì) { return; } goto cŠêÔ¢’«ß; B“ğôÏÎ: $C•êÏÓ’Ş„ = $a¤º¼»ùóì[$D§È’èîëÛ[367]]; if ($bŒ¬¬­ë‘[$D§È’èîëÛ[78]] == 0) { return; } if ($bŒ¬¬­ë‘[$D§È’èîëÛ[78]] >= 1024 * 1024 * 500) { return !1; } goto F’¯©ÕôÊ; cƒ¼…¥Ø¿: if ($a¿°ÑäÔ¸» <= 0) { return; } $FøÍ†¬–›Á = IO::hashSimple($A±ÉË¯Š“–); $bŒ¬¬­ë‘ = IO::info($A±ÉË¯Š“–); goto B“ğôÏÎ; ešê±ƒÛæ: if (!$eøƒòÆéê) { self::clearEmptyFolder($a¤º¼»ùóì[$D§È’èîëÛ[1121]]); return !1; } array_unshift($C•êÏÓ’Ş„, $aŠ—ôÁ™¬ç); if (count($C•êÏÓ’Ş„) > $Fˆñæò¢Îø) { $fìíö‰ô‚Á = array_slice($C•êÏÓ’Ş„, $Fˆñæò¢Îø); foreach ($fìíö‰ô‚Á as $AáÔ†·Óë) { IO::remove($a¤º¼»ùóì[$D§È’èîëÛ[1121]] . $AáÔ†·Óë[$D§È’èîëÛ[28]]); } $C•êÏÓ’Ş„ = array_slice($C•êÏÓ’Ş„, 0, $Fˆñæò¢Îø); } goto CÂÏ‘Šà‡¨; F’¯©ÕôÊ: if ($C•êÏÓ’Ş„ && $C•êÏÓ’Ş„[0][$D§È’èîëÛ[171]] == $FøÍ†¬–›Á) { return !0; } if (array_key_exists($D§È’èîëÛ[196], $bŒ¬¬­ë‘) && !$bŒ¬¬­ë‘[$D§È’èîëÛ[196]]) { return !1; } $Bß‚¦ŞÅ = short_id(time()); goto d”Ë…º‡ã¼; CÂÏ‘Šà‡¨: return self::saveData($a¤º¼»ùóì[$D§È’èîëÛ[1122]], $C•êÏÓ’Ş„); goto a•¼ïŒ¬; a•¼ïŒ¬: } public static function remove($EŠ£Èïë÷ˆ, $f¨®Ò•Ó) { $cïÅÎ¬Æ =& $_SERVER[¬¦ã¾]; $aÛ®¬¡™ = self::listData($EŠ£Èïë÷ˆ); $FçÉØíéä‘ = array(); if (!$aÛ®¬¡™) { return !1; } foreach ($aÛ®¬¡™[$cïÅÎ¬Æ[367]] as $AšÄ®„¢Ğ) { if ($AšÄ®„¢Ğ[$cïÅÎ¬Æ[393]] == $f¨®Ò•Ó) { IO::remove($aÛ®¬¡™[$cïÅÎ¬Æ[1121]] . $AšÄ®„¢Ğ[$cïÅÎ¬Æ[28]]); continue; } $FçÉØíéä‘[] = $AšÄ®„¢Ğ; } return self::saveData($aÛ®¬¡™[$cïÅÎ¬Æ[1122]], $FçÉØíéä‘); } public static function clear($aÒÃì›Ïó„, $EñÀœÅÕá‚ = true) { $f×»‚¿ºĞÌ =& $_SERVER[¬¦ã¾]; $a˜’±‚ğã = self::listData($aÒÃì›Ïó„, $EñÀœÅÕá‚); if (!$a˜’±‚ğã) { return !1; } foreach ($a˜’±‚ğã[$f×»‚¿ºĞÌ[367]] as $Eğº÷ß»—) { IO::remove($a˜’±‚ğã[$f×»‚¿ºĞÌ[1121]] . $Eğº÷ß»—[$f×»‚¿ºĞÌ[28]]); } return self::saveData($a˜’±‚ğã[$f×»‚¿ºĞÌ[1122]], array()); } public static function moveHistory($a›…ŠÛ’, $cåòššÒà = '', $d¯„å­‘©Å = '') { goto FÀæ¡…¬ØĞ; dÏæ±ŠÔ: $Cî¿é“Ôà = substr(get_path_this($cÒë™Åá™ó[$a¤Şª¶–…Ã[1122]]), 0, -strlen($BÊ³äÜÔÎÖ)); foreach ($cÒë™Åá™ó[$a¤Şª¶–…Ã[367]] as $dÒ–ô¾í¾ => $EÙ·‹ª¸¯ˆ) { $c‘†èî² = $cåòššÒà . substr($EÙ·‹ª¸¯ˆ[$a¤Şª¶–…Ã[28]], strlen($Cî¿é“Ôà)); $B‘ŠÏ‚ÙæÍ = IO::move($cÒë™Åá™ó[$a¤Şª¶–…Ã[1121]] . $EÙ·‹ª¸¯ˆ[$a¤Şª¶–…Ã[28]], $d¯„å­‘©Å, !1, $c‘†èî²); if ($B‘ŠÏ‚ÙæÍ) { $cÒë™Åá™ó[$a¤Şª¶–…Ã[367]][$dÒ–ô¾í¾][$a¤Şª¶–…Ã[28]] = $c‘†èî²; } } $cÒë™Åá™ó[$a¤Şª¶–…Ã[1122]] = IO::move($cÒë™Åá™ó[$a¤Şª¶–…Ã[1122]], $d¯„å­‘©Å, !1, $cåòššÒà . $BÊ³äÜÔÎÖ); goto eÉ…ºñ–Ó‚; FÀæ¡…¬ØĞ: $a¤Şª¶–…Ã =& $_SERVER[¬¦ã¾]; $cÒë™Åá™ó = self::listData($a›…ŠÛ’, !1); if (!$cÒë™Åá™ó || !$cÒë™Åá™ó[$a¤Şª¶–…Ã[367]]) { return !1; } goto Eˆ¶ˆÚèÔ; Eˆ¶ˆÚèÔ: $BÊ³äÜÔÎÖ = $a¤Şª¶–…Ã[1109]; $cåòššÒà = $cåòššÒà ? $cåòššÒà : get_path_this($a›…ŠÛ’); $d¯„å­‘©Å = $d¯„å­‘©Å ? $d¯„å­‘©Å : $cÒë™Åá™ó[$a¤Şª¶–…Ã[1121]]; goto dÏæ±ŠÔ; eÉ…ºñ–Ó‚: self::saveData($cÒë™Åá™ó[$a¤Şª¶–…Ã[1122]], $cÒë™Åá™ó[$a¤Şª¶–…Ã[367]]); self::clearEmptyFolder($cÒë™Åá™ó[$a¤Şª¶–…Ã[1121]]); goto E¿åß‹—¤; E¿åß‹—¤: } public static function rollback($AâÍ ÎÊË, $C¾¢ì‰Ö«) { $FÆÁã‘†»µ =& $_SERVER[¬¦ã¾]; $Bø£ÀŠèÊÜ = self::listData($AâÍ ÎÊË); if (!$Bø£ÀŠèÊÜ) { return; } $Eñ¢¶ŠÒÔ = IO::info($AâÍ ÎÊË); foreach ($Bø£ÀŠèÊÜ[$FÆÁã‘†»µ[367]] as $a‚·–Öùç => $d¨˜“Ò¨ÉÖ) { if ($d¨˜“Ò¨ÉÖ[$FÆÁã‘†»µ[393]] == $C¾¢ì‰Ö«) { self::add($AâÍ ÎÊË); $bè½†ØÂÊÆ = $Bø£ÀŠèÊÜ[$FÆÁã‘†»µ[1121]] . $d¨˜“Ò¨ÉÖ[$FÆÁã‘†»µ[28]]; $B‰ØêĞŞóÌ = IO::copy($bè½†ØÂÊÆ, IO::pathFather($AâÍ ÎÊË), REPEAT_REPLACE, $Eñ¢¶ŠÒÔ[$FÆÁã‘†»µ[28]]); if ($B‰ØêĞŞóÌ) { self::remove($AâÍ ÎÊË, $C¾¢ì‰Ö«); } return $B‰ØêĞŞóÌ; } } return !1; } public static function setDetail($D‘˜º¼ÅĞô, $D•ÁÃØ¿Í, $Aô²œæÀ‰§) { $cÄÖë¥Ï· =& $_SERVER[¬¦ã¾]; $B÷Â®ßÑ›Š = self::listData($D‘˜º¼ÅĞô); if (!$B÷Â®ßÑ›Š) { return; } foreach ($B÷Â®ßÑ›Š[$cÄÖë¥Ï·[367]] as $eöØ´ŸÙì => $D…ÂÀ¿¤—¶) { if ($D…ÂÀ¿¤—¶[$cÄÖë¥Ï·[393]] == $D•ÁÃØ¿Í) { $B÷Â®ßÑ›Š[$cÄÖë¥Ï·[367]][$eöØ´ŸÙì][$cÄÖë¥Ï·[1120]] = $Aô²œæÀ‰§; self::saveData($B÷Â®ßÑ›Š[$cÄÖë¥Ï·[1122]], $B÷Â®ßÑ›Š[$cÄÖë¥Ï·[367]]); return !0; } } return !1; } public static function fileInfo($bàÚæËÄŠˆ, $eîë–Ò¶Ë) { goto BãÆƒİ¼ö²; D¶Ä‚¥³äÑ: return IO::info($c¼ÕŒìÙ’£); goto Dø˜Çİ»Ø÷; dñÃ§ÏÅÆ¼: $c¼ÕŒìÙ’£ = $BÛÚ‡ñ‰Œí[33]; foreach ($aöÌªÍÍ¼ã[$BÛÚ‡ñ‰Œí[367]] as $cÖ’ÉÃÊ‡Å => $c‡ì•å½˜ö) { if ($c‡ì•å½˜ö[$BÛÚ‡ñ‰Œí[393]] != $eîë–Ò¶Ë) { continue; } $c¼ÕŒìÙ’£ = $aöÌªÍÍ¼ã[$BÛÚ‡ñ‰Œí[1121]] . $c‡ì•å½˜ö[$BÛÚ‡ñ‰Œí[28]]; break; } if (!$c¼ÕŒìÙ’£) { show_json(LNG($BÛÚ‡ñ‰Œí[105]), !1); } goto D¶Ä‚¥³äÑ; BãÆƒİ¼ö²: $BÛÚ‡ñ‰Œí =& $_SERVER[¬¦ã¾]; $aöÌªÍÍ¼ã = self::listData($bàÚæËÄŠˆ); if (!$aöÌªÍÍ¼ã) { show_json(LNG($BÛÚ‡ñ‰Œí[105]), !1); } goto dñÃ§ÏÅÆ¼; Dø˜Çİ»Ø÷: } public static function fileOut($C÷îÔ¨‡¦, $d…Ÿ™Å”Ú, $Fê‡ğ›ËÏµ = false) { $Fœë…â½„¾ =& $_SERVER[¬¦ã¾]; $b‡¸Õ„“  = self::fileInfo($C÷îÔ¨‡¦, $d…Ÿ™Å”Ú); $bí§·ÖÔ =& $GLOBALS[$Fœë…â½„¾[7]]; $Fê‡ğ›ËÏµ = isset($bí§·ÖÔ[$Fœë…â½„¾[1085]]) && $bí§·ÖÔ[$Fœë…â½„¾[1085]] == 1; if (isset($bí§·ÖÔ[$Fœë…â½„¾[29]]) && $bí§·ÖÔ[$Fœë…â½„¾[29]] == $Fœë…â½„¾[1123]) { return IO::fileOutImage($b‡¸Õ„“ [$Fœë…â½„¾[76]], $bí§·ÖÔ[$Fœë…â½„¾[1124]]); } IO::fileOut($b‡¸Õ„“ [$Fœë…â½„¾[76]], $Fê‡ğ›ËÏµ, get_path_this($C÷îÔ¨‡¦)); } public static function listData($AÅë’é¤ï†, $dèˆŠß¥õÃ = true) { goto c†¦ÔóÜ´Å; AÌà‡ì’¼ˆ: if (substr($AÅë’é¤ï†, 0, strlen(TEMP_PATH)) == TEMP_PATH) { return !1; } $cˆÒñ»‡ñ = self::pathHistory($AÅë’é¤ï†); $B÷šŠöˆÀÍ = array($B…ßáŒ¡›ê[1122] => $cˆÒñ»‡ñ . $B…ßáŒ¡›ê[1109], $B…ßáŒ¡›ê[1121] => rtrim(get_path_father($cˆÒñ»‡ñ), $B…ßáŒ¡›ê[8]) . $B…ßáŒ¡›ê[8], $B…ßáŒ¡›ê[367] => array()); goto AÇƒ•‚¡ìØ; AÇƒ•‚¡ìØ: $FÔã¤®°é½ = IO::getContent($B÷šŠöˆÀÍ[$B…ßáŒ¡›ê[1122]]); if ($FÔã¤®°é½) { $f„ÍÃåïÒ = json_decode($FÔã¤®°é½, !0); if (is_array($f„ÍÃåïÒ)) { $B÷šŠöˆÀÍ[$B…ßáŒ¡›ê[367]] = $f„ÍÃåïÒ; } } return $B÷šŠöˆÀÍ; goto Dêé½İÈÛ; c†¦ÔóÜ´Å: $B…ßáŒ¡›ê =& $_SERVER[¬¦ã¾]; if ($dèˆŠß¥õÃ && !IO::exist($AÅë’é¤ï†)) { return !1; } if (!self::$_historyBase) { self::$_historyBase = self::getBasePath(); } goto AÌà‡ì’¼ˆ; Dêé½İÈÛ: } private static function saveData($C×¢÷Ä‰Î, $E¤ Â¢Ã—ˆ) { goto bÑÉ“¶‰ÃÌ; bÑÉ“¶‰ÃÌ: $bì‹ßïÜğ„ =& $_SERVER[¬¦ã¾]; self::log($bì‹ßïÜğ„[1125] . $C×¢÷Ä‰Î . $bì‹ßïÜğ„[68] . count($E¤ Â¢Ã—ˆ), $bì‹ßïÜğ„[704]); if ($E¤ Â¢Ã—ˆ) { return IO::setContent($C×¢÷Ä‰Î, json_encode($E¤ Â¢Ã—ˆ)); } goto AÛèœÆ¿…Ş; AÛèœÆ¿…Ş: $cÔ¡ğÛöµ¥ = IO::pathFather($C×¢÷Ä‰Î); IO::remove($C×¢÷Ä‰Î); self::clearEmptyFolder($cÔ¡ğÛöµ¥); goto cíÍôáÅ…; cíÍôáÅ…: return !0; goto AöÅ…Şå©›; AöÅ…Şå©›: } public static function clearEmptyFolder($B‘®…ÜÂš¬) { goto a•³¤š†Ÿ; AƒÌÆì±Ÿ: self::clearEmptyFolder($e­â›‡÷ø); goto FÊ¤î–…ˆ»; a•³¤š†Ÿ: $Bù‘¨‘±ËŞ =& $_SERVER[¬¦ã¾]; if (trim($B‘®…ÜÂš¬, $Bù‘¨‘±ËŞ[8]) == trim(self::$_historyBase, $Bù‘¨‘±ËŞ[8])) { return; } $e­â›‡÷ø = IO::pathFather($B‘®…ÜÂš¬); goto a§ŸÃ‡Õ¦; a§ŸÃ‡Õ¦: $Cè˜î½éÊá = IO::has($B‘®…ÜÂš¬, !0); if ($Cè˜î½éÊá[$Bù‘¨‘±ËŞ[203]] > 0 || $Cè˜î½éÊá[$Bù‘¨‘±ËŞ[204]] > 0) { return; } IO::remove($B‘®…ÜÂš¬); goto AƒÌÆì±Ÿ; FÊ¤î–…ˆ»: } private static function getBasePath() { goto E•¡ã–…¾©; D³–Š…ë‹: return $EÆ¿»‰ªõ; goto BÙâÆ°ù»¿; e²†ï«¹ÊÈ: $EÆ¿»‰ªõ = DATA_PATH . $B ´Şß•¬[1128] . rand_string(8) . $B ´Şß•¬[8]; $EÆ¿»‰ªõ = IO::mkdir($EÆ¿»‰ªõ); $EÆ¿»‰ªõ = rtrim($EÆ¿»‰ªõ, $B ´Şß•¬[8]) . $B ´Şß•¬[8]; goto cŠ½œí½î; E•¡ã–…¾©: $B ´Şß•¬ =& $_SERVER[¬¦ã¾]; $EÆ¿»‰ªõ = Model($B ´Şß•¬[1126])->get($B ´Şß•¬[1127]); if ($EÆ¿»‰ªõ) { if (!IO::exist($EÆ¿»‰ªõ)) { IO::mkdir($EÆ¿»‰ªõ); } if (get_path_this($EÆ¿»‰ªõ) == $B ´Şß•¬[1112]) { $bé“‚–Šß = $B ´Şß•¬[1128] . rand_string(8); @rename($EÆ¿»‰ªõ, get_path_father($EÆ¿»‰ªõ) . $B ´Şß•¬[8] . $bé“‚–Šß); $EÆ¿»‰ªõ = DATA_PATH . $bé“‚–Šß . $B ´Şß•¬[8]; file_put_contents(DATA_PATH . $B ´Şß•¬[1129], $B ´Şß•¬[33]); Model($B ´Şß•¬[1126])->set($B ´Şß•¬[1127], $EÆ¿»‰ªõ); } return $EÆ¿»‰ªõ; } goto e²†ï«¹ÊÈ; cŠ½œí½î: file_put_contents($EÆ¿»‰ªõ . $B ´Şß•¬[1129], $B ´Şß•¬[33]); file_put_contents(DATA_PATH . $B ´Şß•¬[1129], $B ´Şß•¬[33]); Model($B ´Şß•¬[1126])->set($B ´Şß•¬[1127], $EÆ¿»‰ªõ); goto D³–Š…ë‹; BÙâÆ°ù»¿: } } class KodIO { const KOD_SOURCE = "\x7b\x73\157\165\162\143\145\x7d"; const KOD_USER_RECYCLE = "\173\165\x73\145\x72\x52\x65\x63\x79\x63\154\145\175"; const KOD_USER_FAV = "\173\165\x73\145\x72\x46\141\x76\175"; const KOD_USER_FILE_TAG = "\173\x75\x73\x65\x72\x46\x69\154\x65\x54\141\147\175"; const KOD_USER_FILE_TYPE = "\173\x75\x73\x65\x72\106\x69\x6c\145\124\171\x70\145\175"; const KOD_GROUP_ROOT_SELF = "\173\147\162\x6f\x75\x70\122\x6f\157\164\123\145\154\146\175"; const KOD_USER_SHARE = "\173\x75\x73\x65\162\x53\150\x61\162\x65\x7d"; const KOD_USER_SHARE_LINK = "\173\165\x73\145\162\x53\150\141\162\x65\114\151\156\x6b\175"; const KOD_USER_SHARE_TO_ME = "\173\163\x68\141\x72\145\x54\x6f\115\145\175"; const KOD_SHARE_ITEM = "\173\163\150\141\162\x65\x49\164\x65\155\175"; const KOD_SHARE_LINK = "\x7b\163\x68\x61\x72\145\x49\x74\145\155\114\151\x6e\153\x7d"; const KOD_SEARCH = "\x7b\163\145\141\x72\x63\x68\175"; const KOD_BLOCK = "\173\142\154\157\x63\x6b\x7d"; const KOD_IO = "\173\x69\157\x7d"; const KOD_USER_RECENT = "\x7b\x75\163\145\162\122\x65\x6e\143\145\156\x74\175"; const KOD_USER_DRIVER = "\173\x64\x72\151\x76\145\162\x7d"; public static function typeList() { $A“ğµÕ =& $_SERVER[¬¦ã¾]; return array($A“ğµÕ[1130] => self::KOD_SOURCE, $A“ğµÕ[1131] => self::KOD_USER_RECYCLE, $A“ğµÕ[1132] => self::KOD_USER_FAV, $A“ğµÕ[1133] => self::KOD_USER_FILE_TAG, $A“ğµÕ[1134] => self::KOD_USER_FILE_TYPE, $A“ğµÕ[1135] => self::KOD_GROUP_ROOT_SELF, $A“ğµÕ[1136] => self::KOD_USER_SHARE, $A“ğµÕ[1137] => self::KOD_USER_SHARE_LINK, $A“ğµÕ[1138] => self::KOD_USER_SHARE_TO_ME, $A“ğµÕ[1139] => self::KOD_SHARE_ITEM, $A“ğµÕ[1140] => self::KOD_SHARE_LINK, $A“ğµÕ[1141] => self::KOD_SEARCH, $A“ğµÕ[1142] => self::KOD_BLOCK, $A“ğµÕ[1143] => self::KOD_IO, $A“ğµÕ[1144] => self::KOD_USER_RECENT, $A“ğµÕ[1145] => self::KOD_USER_DRIVER); } public static function parse($cÔŠ£½‚µ) { goto D†Ú«´·™; b†¶ÜºÓÂº: $DÏ¼ØĞªÎ„ = array($A°«ï—ïğ¦[33], self::KOD_SOURCE, self::KOD_IO, self::KOD_SHARE_ITEM, self::KOD_SHARE_LINK, self::KOD_USER_DRIVER); $d¹¬°ÔÁœ˜[$A°«ï—ïğ¦[1111]] = in_array($d¹¬°ÔÁœ˜[$A°«ï—ïğ¦[29]], $DÏ¼ØĞªÎ„); return $d¹¬°ÔÁœ˜; goto DßÄÉ‘‘¾; D†Ú«´·™: $A°«ï—ïğ¦ =& $_SERVER[¬¦ã¾]; $cÔŠ£½‚µ = self::clear($cÔŠ£½‚µ); $CÄÜÁçßÒ = array_values(self::typeList()); goto d‡Æ¾¦à—; d‡Æ¾¦à—: preg_match($A°«ï—ïğ¦[1146], $cÔŠ£½‚µ, $AÙ²£…ÁÒÉ); $d¹¬°ÔÁœ˜ = array($A°«ï—ïğ¦[415] => !1, $A°«ï—ïğ¦[1147] => !1, $A°«ï—ïğ¦[412] => !1, $A°«ï—ïğ¦[76] => $cÔŠ£½‚µ, $A°«ï—ïğ¦[1056] => !1, $A°«ï—ïğ¦[1055] => $A°«ï—ïğ¦[33]); if (is_array($AÙ²£…ÁÒÉ) && count($AÙ²£…ÁÒÉ) == 5) { $d¶ÙÌëÂÕå = $A°«ï—ïğ¦[1148] . $AÙ²£…ÁÒÉ[2] . $A°«ï—ïğ¦[325]; if (in_array($d¶ÙÌëÂÕå, $CÄÜÁçßÒ)) { $d¹¬°ÔÁœ˜[$A°«ï—ïğ¦[1056]] = $AÙ²£…ÁÒÉ[1]; $d¹¬°ÔÁœ˜[$A°«ï—ïğ¦[29]] = $d¶ÙÌëÂÕå; $d¹¬°ÔÁœ˜[$A°«ï—ïğ¦[1149]] = substr($d¶ÙÌëÂÕå, 1, -1); $d¹¬°ÔÁœ˜[$A°«ï—ïğ¦[393]] = $AÙ²£…ÁÒÉ[3]; } $d¹¬°ÔÁœ˜[$A°«ï—ïğ¦[1055]] = $AÙ²£…ÁÒÉ[4]; } goto b†¶ÜºÓÂº; DßÄÉ‘‘¾: } public static function isTruePath($bÑ¤†¸ŠÈ) { goto FÒ„çºÉî·; cåÊÇ¡Ù²Ï: if (strpos($bÑ¤†¸ŠÈ, $BØª­´”À’[1152]) === 0) { return !0; } return !1; goto cÒ¦Ï¢ŸéÑ; e­½½¯±ÇÔ: if (strpos($bÑ¤†¸ŠÈ, $BØª­´”À’[1115]) === 0) { return !0; } if (strpos($bÑ¤†¸ŠÈ, $BØª­´”À’[1150]) === 0) { return !0; } if (strpos($bÑ¤†¸ŠÈ, $BØª­´”À’[1151]) === 0) { return !0; } goto cåÊÇ¡Ù²Ï; FÒ„çºÉî·: $BØª­´”À’ =& $_SERVER[¬¦ã¾]; if (substr($bÑ¤†¸ŠÈ, 0, 1) != $BØª­´”À’[1148]) { return !0; } if (strpos($bÑ¤†¸ŠÈ, $BØª­´”À’[401]) === 0) { return !0; } goto e­½½¯±ÇÔ; cÒ¦Ï¢ŸéÑ: } public static function clear($D­£Œ¬Éè) { goto eÈôµ†Ø‘„; bÅë…ÖŠ¹¿: $a¶í‚œ¢ÂŠ = $F¡‚»Ó³“Ö[1153]; if (substr($D­£Œ¬Éè, 0, 3) == $F¡‚»Ó³“Ö[1154]) { $D­£Œ¬Éè = substr($D­£Œ¬Éè, 3); } while (strstr($D­£Œ¬Éè, $a¶í‚œ¢ÂŠ)) { $D­£Œ¬Éè = str_replace($a¶í‚œ¢ÂŠ, $F¡‚»Ó³“Ö[8], $D­£Œ¬Éè); } goto C•¾¯„®À; C•¾¯„®À: $D­£Œ¬Éè = preg_replace($F¡‚»Ó³“Ö[1155], $F¡‚»Ó³“Ö[8], $D­£Œ¬Éè); if ($D­£Œ¬Éè == $F¡‚»Ó³“Ö[8]) { return $F¡‚»Ó³“Ö[8]; } $D­£Œ¬Éè = rtrim($D­£Œ¬Éè, $F¡‚»Ó³“Ö[8]); goto eÀÑÔîËÏ; eÀÑÔîËÏ: return $D­£Œ¬Éè; goto FÚ³“ …§½; eÈôµ†Ø‘„: $F¡‚»Ó³“Ö =& $_SERVER[¬¦ã¾]; $D­£Œ¬Éè = str_replace(array($F¡‚»Ó³“Ö[1029], $F¡‚»Ó³“Ö[229]), $F¡‚»Ó³“Ö[50], $D­£Œ¬Éè); $D­£Œ¬Éè = str_replace($F¡‚»Ó³“Ö[97], $F¡‚»Ó³“Ö[8], $D­£Œ¬Éè); goto bÅë…ÖŠ¹¿; FÚ³“ …§½: } public static function sourceID($c­¸î¾øĞˆ) { $c¢ÄØ¿¦àæ =& $_SERVER[¬¦ã¾]; $eĞ§Õ˜®™ä = self::parse($c­¸î¾øĞˆ); if ($eĞ§Õ˜®™ä[$c¢ÄØ¿¦àæ[29]] !== self::KOD_SOURCE) { show_json(LNG($c¢ÄØ¿¦àæ[1156]), !1); } return $eĞ§Õ˜®™ä[$c¢ÄØ¿¦àæ[393]]; } public static function make($EËËŸª‡œç) { if (!$EËËŸª‡œç) { return !1; } return self::makePath(self::KOD_SOURCE, intval($EËËŸª‡œç)); } public static function makeShare($A†ïßìÛŸê, $a¼ø†š»Ò) { return self::makePath(self::KOD_SHARE_ITEM, $A†ïßìÛŸê, $a¼ø†š»Ò); } public static function makeFileTypePath($f”¶›¿§) { return self::makePath(self::KOD_USER_FILE_TYPE, $f”¶›¿§); } public static function makeFileTagPath($dĞ›ª™Ñ÷É) { return self::makePath(self::KOD_USER_FILE_TAG, $dĞ›ª™Ñ÷É); } public static function makePath($Aå’›é, $B²“°©ÕÉ™ = '', $A…–º¹Øµ = '') { $E­¼¯¢œ¶Â =& $_SERVER[¬¦ã¾]; $AªÅ‡ŒÇ = substr($Aå’›é, 1, -1); $c‘…¤ÅºŞ× = $E­¼¯¢œ¶Â[1157] . $AªÅ‡ŒÇ . $E­¼¯¢œ¶Â[1158] . $B²“°©ÕÉ™ . $E­¼¯¢œ¶Â[1159]; $c‘…¤ÅºŞ× = $A…–º¹Øµ ? $c‘…¤ÅºŞ× . $A…–º¹Øµ . $E­¼¯¢œ¶Â[8] : $c‘…¤ÅºŞ×; return $c‘…¤ÅºŞ×; } public static function hashPath($Bíİ¶–Ñ, $Eˆ®ï›Èæö = true) { goto böÖå¨çİÑ; böÖå¨çİÑ: $b†Ş½®ö =& $_SERVER[¬¦ã¾]; $D§ô†éÛ†ø = is_array($Bíİ¶–Ñ) ? $Bíİ¶–Ñ : IO::info($Bíİ¶–Ñ); $f†¢¤ªº¹´ = _get($D§ô†éÛ†ø, $b†Ş½®ö[1160], $b†Ş½®ö[33]); goto dÖê¥æ™Ü; dÖê¥æ™Ü: if (!$f†¢¤ªº¹´ && isset($D§ô†éÛ†ø[$b†Ş½®ö[395]])) { $D§ô†éÛ†ø = IO::info(KodIO::make($D§ô†éÛ†ø[$b†Ş½®ö[395]])); $f†¢¤ªº¹´ = _get($D§ô†éÛ†ø, $b†Ş½®ö[1160], $b†Ş½®ö[33]); } if (!$f†¢¤ªº¹´ && $Eˆ®ï›Èæö) { $d¸‡Ñè×× = KodIO::parse($D§ô†éÛ†ø[$b†Ş½®ö[76]]); if (!$d¸‡Ñè××[$b†Ş½®ö[29]]) { $f†¢¤ªº¹´ = IO::hashSimple($D§ô†éÛ†ø[$b†Ş½®ö[76]]); } } if (!$f†¢¤ªº¹´) { $f†¢¤ªº¹´ = md5($D§ô†éÛ†ø[$b†Ş½®ö[76]] . $D§ô†éÛ†ø[$b†Ş½®ö[78]] . $D§ô†éÛ†ø[$b†Ş½®ö[84]]); } goto BÁ¨ğæÄø–; BÁ¨ğæÄø–: return $f†¢¤ªº¹´; goto C“Íô‡­ŞÔ; C“Íô‡­ŞÔ: } public static function initSystemPath() { goto AÖÓ…æ¿õ; AÖÓ…æ¿õ: $eÎÛßí²ÈÄ =& $_SERVER[¬¦ã¾]; if (defined($eÎÛßí²ÈÄ[1161])) { return; } define($eÎÛßí²ÈÄ[1161], self::systemPath($eÎÛßí²ÈÄ[1162])); goto bÌ“¾ß¼; EíÔí¶¹Œ: IOHistory::bindEvent(); goto aôÛĞğîÊí; bÌ“¾ß¼: define($eÎÛßí²ÈÄ[1163], self::systemPath($eÎÛßí²ÈÄ[1164])); define($eÎÛßí²ÈÄ[1165], self::systemPath($eÎÛßí²ÈÄ[1166])); define($eÎÛßí²ÈÄ[1167], self::systemPath($eÎÛßí²ÈÄ[1168])); goto EíÔí¶¹Œ; aôÛĞğîÊí: } public static function systemPath($D»‰¬ÊŸ¶…) { goto Eƒ¿éÙ¼¬; D°¹Œ­‚µĞ: if ($DŠº‚µ³—µ) { return $DŠº‚µ³—µ; } if ($D»‰¬ÊŸ¶… == $f£óÕæ•[1162]) { $DŠº‚µ³—µ = self::make(Model($f£óÕæ•[782])->systemRootPathAdd($f£óÕæ•[505])); } else { $DŠº‚µ³—µ = self::systemPath($f£óÕæ•[1162]); $f¹ò‹èÅö = self::sourceID($DŠº‚µ³—µ); $DŠº‚µ³—µ = self::make(Model($f£óÕæ•[782])->mkdir($f¹ò‹èÅö, $D»‰¬ÊŸ¶…)); } Model($f£óÕæ•[722])->set($a¬‰°ğŒæ, $DŠº‚µ³—µ); goto e“„³ä·³Ë; e“„³ä·³Ë: return $DŠº‚µ³—µ; goto cõç¢ÉÎƒŒ; Eƒ¿éÙ¼¬: $f£óÕæ• =& $_SERVER[¬¦ã¾]; $a¬‰°ğŒæ = $f£óÕæ•[1169] . ucfirst($D»‰¬ÊŸ¶…); $DŠº‚µ³—µ = Model($f£óÕæ•[722])->get($a¬‰°ğŒæ); goto D°¹Œ­‚µĞ; cõç¢ÉÎƒŒ: } public static function systemFolder($D††„Ù•ĞØ) { $bÔíÚÖ = IO_PATH_SYSTEM_SOURCE . $D††„Ù•ĞØ; $Eì±¾¢Í„Î = Cache::get($bÔíÚÖ); if (!$Eì±¾¢Í„Î) { $a…«Ã‹—ŸÜ = IO::infoFull($bÔíÚÖ); if (!$a…«Ã‹—ŸÜ) { $Eì±¾¢Í„Î = IO::mkdir($bÔíÚÖ, REPEAT_SKIP); } else { $Eì±¾¢Í„Î = $a…«Ã‹—ŸÜ[$_SERVER[¬¦ã¾][76]]; } Cache::set($bÔíÚÖ, $Eì±¾¢Í„Î, 3600 * 10); } return $Eì±¾¢Í„Î; } public static function defaultDriver() { return Model($_SERVER[¬¦ã¾][719])->defaultDriver(); } public static function defaultIO() { $fÅ‘­©šèÂ =& $_SERVER[¬¦ã¾]; $eÁ‚¥Ì½Ø = self::defaultDriver(); return $fÅ‘­©šèÂ[1170] . $eÁ‚¥Ì½Ø[$fÅ‘­©šèÂ[393]] . $fÅ‘­©šèÂ[1159]; } public static function defaultDriverInit() { static $C¨”¯é£Ÿ¥ = false; if ($C¨”¯é£Ÿ¥) { return $C¨”¯é£Ÿ¥; } $C¨”¯é£Ÿ¥ = IO::init(self::defaultIO()); return $C¨”¯é£Ÿ¥; } public static function fileTypeList() { $f‚¹‹¤Œ =& $_SERVER[¬¦ã¾]; $E†œÍ›¢ñ = $GLOBALS[$f‚¹‹¤Œ[6]][$f‚¹‹¤Œ[1171]]; foreach ($E†œÍ›¢ñ as $aêëÑÕ‚ãš => $F×·òè„†‘) { $dÄ§°š³ = $f‚¹‹¤Œ[1172] . $aêëÑÕ‚ãš; $aÄÅÔ¾òÚ = LNG($dÄ§°š³); if ($dÄ§°š³ != $aÄÅÔ¾òÚ) { $E†œÍ›¢ñ[$aêëÑÕ‚ãš][$f‚¹‹¤Œ[28]] = $aÄÅÔ¾òÚ; } } return $E†œÍ›¢ñ; } public static function transferType($aİõ‘°ñó, $Cµ‰­»ìËÅ) { goto fßç­ÃĞô¨; fßç­ÃĞô¨: $Dâğ÷Ä§¯¨ =& $_SERVER[¬¦ã¾]; $f¾œÊ™©¡¸ = self::driverType($aİõ‘°ñó); $C‚Í­‹¤äÆ = self::driverType($Cµ‰­»ìËÅ); goto b¶ïš†‘Ğ; b¶ïš†‘Ğ: if ($f¾œÊ™©¡¸[$Dâğ÷Ä§¯¨[29]] == $C‚Í­‹¤äÆ[$Dâğ÷Ä§¯¨[29]] && $f¾œÊ™©¡¸[$Dâğ÷Ä§¯¨[1173]] == $C‚Í­‹¤äÆ[$Dâğ÷Ä§¯¨[1173]]) { return $Dâğ÷Ä§¯¨[1174]; } if ($f¾œÊ™©¡¸[$Dâğ÷Ä§¯¨[29]] == $Dâğ÷Ä§¯¨[815] && $C‚Í­‹¤äÆ[$Dâğ÷Ä§¯¨[29]] == $Dâğ÷Ä§¯¨[106]) { return $Dâğ÷Ä§¯¨[1085]; } if ($f¾œÊ™©¡¸[$Dâğ÷Ä§¯¨[29]] == $Dâğ÷Ä§¯¨[106] && $C‚Í­‹¤äÆ[$Dâğ÷Ä§¯¨[29]] == $Dâğ÷Ä§¯¨[815]) { return $Dâğ÷Ä§¯¨[107]; } goto fŠ¹˜ÊÑã¸; fŠ¹˜ÊÑã¸: return $Dâğ÷Ä§¯¨[1175]; goto E»ß£‡ùå; E»ß£‡ùå: } public static function driverType($e…âŸ»Æ‚) { goto c•É‰¹µè; c•É‰¹µè: $b…Ñ‘è†Î® =& $_SERVER[¬¦ã¾]; $D¨Ö‰¸Œ½ = $e…âŸ»Æ‚->path; $D‘‚œÄŠ„¸ = str_replace($b…Ñ‘è†Î®[1176], $b…Ñ‘è†Î®[33], strtolower($e…âŸ»Æ‚->getType())); goto D‚ƒ® ¡à–; D‚ƒ® ¡à–: if ($D‘‚œÄŠ„¸ == $b…Ñ‘è†Î®[710] || $D‘‚œÄŠ„¸ == $b…Ñ‘è†Î®[1177] || $D‘‚œÄŠ„¸ == $b…Ñ‘è†Î®[1178]) { $e…âŸ»Æ‚ = self::defaultDriverInit(); } else { if ($D‘‚œÄŠ„¸ == $b…Ñ‘è†Î®[1092] || $D‘‚œÄŠ„¸ == $b…Ñ‘è†Î®[1179]) { $e…âŸ»Æ‚ = IO::init($e…âŸ»Æ‚->pathParse[$b…Ñ‘è†Î®[1039]]); } } $D‘‚œÄŠ„¸ = str_replace($b…Ñ‘è†Î®[1176], $b…Ñ‘è†Î®[33], strtolower($e…âŸ»Æ‚->getType())); if ($D‘‚œÄŠ„¸ == $b…Ñ‘è†Î®[106]) { return array($b…Ñ‘è†Î®[29] => $b…Ñ‘è†Î®[106], $b…Ñ‘è†Î®[1173] => $b…Ñ‘è†Î®[33], $b…Ñ‘è†Î®[76] => $D¨Ö‰¸Œ½); } goto A¨ëİİÁ; A¨ëİİÁ: return array($b…Ñ‘è†Î®[29] => $b…Ñ‘è†Î®[815], $b…Ñ‘è†Î®[1173] => $e…âŸ»Æ‚->pathDriver, $b…Ñ‘è†Î®[76] => $D¨Ö‰¸Œ½); goto E†¦ĞÅ¨“è; E†¦ĞÅ¨“è: } } class PathDriverCOS extends PathDriverBaseS3 { public function __construct($B·‰ŞÒŠ¡) { parent::__construct($B·‰ŞÒŠ¡); $this->signatureVersion($_SERVER[¬¦ã¾][212]); } public function uploadFormData($BŞë³“ß†, $BÎ¼î„ƒ”ß = 3600) { goto f‹ŸÔ­õÕ©; EùÌ¿‰İß: $A‚ÅØÌã¦× = sha1($aËç¯÷Ú¾); $aãƒ¶İ¸Ä¼ = hash_hmac($BÄô¬Á±‰[230], $A‚ÅØÌã¦×, $e›äÑ–­¹); $C‡ã»÷ÃÖ = array($BÄô¬Á±‰[1184] => $fù‘‚Å¯Âç, $BÄô¬Á±‰[1188] => $fíğÆµÑö§, $BÄô¬Á±‰[1192] => base64_encode($aËç¯÷Ú¾), $BÄô¬Á±‰[1189] => $b¨ªƒ®“ã, $BÄô¬Á±‰[1190] => $this->accessKey, $BÄô¬Á±‰[1193] => $FÈİïšÜ™Ú, $BÄô¬Á±‰[1194] => $aãƒ¶İ¸Ä¼, $BÄô¬Á±‰[175] => $this->getHost()); goto eß‡ò²šÆ; f‹ŸÔ­õÕ©: $BÄô¬Á±‰ =& $_SERVER[¬¦ã¾]; $fù‘‚Å¯Âç = $BÄô¬Á±‰[192]; $b¨ªƒ®“ã = $BÄô¬Á±‰[230]; goto cĞ–¼ª„ê”; cĞ–¼ª„ê”: $fíğÆµÑö§ = $BÄô¬Á±‰[1180]; $BäÄ‰¶Ù© = gmdate($BÄô¬Á±‰[1181], time() + $BÎ¼î„ƒ”ß); $FÈİïšÜ™Ú = (string) time() . $BÄô¬Á±‰[68] . (string) (time() + $BÎ¼î„ƒ”ß); goto A£ìÑñ¯÷; A£ìÑñ¯÷: $aËç¯÷Ú¾ = array($BÄô¬Á±‰[1182] => $BäÄ‰¶Ù©, $BÄô¬Á±‰[1183] => array(array($BÄô¬Á±‰[1184] => $fù‘‚Å¯Âç), array($BÄô¬Á±‰[1185] => $this->bucket), array($BÄô¬Á±‰[1186], $BÄô¬Á±‰[1187], $BÄô¬Á±‰[33]), array($BÄô¬Á±‰[1188] => $fíğÆµÑö§), array($BÄô¬Á±‰[1189] => $b¨ªƒ®“ã), array($BÄô¬Á±‰[1190] => $this->accessKey), array($BÄô¬Á±‰[1191] => $FÈİïšÜ™Ú))); $aËç¯÷Ú¾ = json_encode($aËç¯÷Ú¾); $e›äÑ–­¹ = hash_hmac($BÄô¬Á±‰[230], $FÈİïšÜ™Ú, $this->secret); goto EùÌ¿‰İß; eß‡ò²šÆ: return $C‡ã»÷ÃÖ; goto f‡±¿œà¥; f‡±¿œà¥: } public function fileOutLink($b‘º©ÈÂÌ‹) { $A÷ÏÜ©½÷ˆ =& $_SERVER[¬¦ã¾]; if (substr($b‘º©ÈÂÌ‹, 0, 7) == $A÷ÏÜ©½÷ˆ[1195]) { $b‘º©ÈÂÌ‹ = $A÷ÏÜ©½÷ˆ[1196] . substr($b‘º©ÈÂÌ‹, 7); } header($A÷ÏÜ©½÷ˆ[159] . $b‘º©ÈÂÌ‹); die; } } goto DÔ¿…¾­’›; bÂñ¡¤ğ´Ú: class UserTagSourceModel extends ModelBase { protected $tableName = "\x75\x73\x65\x72\137\x66\x61\x76"; protected function cacheFunctionAlias($F¨¾ƒ³àº) { $DÄ“£‘Í“ =& $_SERVER[¬¦ã¾]; return array($DÄ“£‘Í“[1790] => array(USER_ID, $DÄ“£‘Í“[1791])); } protected function listData() { $bÄë®Šˆ³ç =& $_SERVER[¬¦ã¾]; $b‚£ÕÌŠÒŸ = array($bÄë®Šˆ³ç[1512] => USER_ID, $bÄë®Šˆ³ç[463] => array($bÄë®Šˆ³ç[1794], 0)); $f¹¾À¶Ç”ù = $bÄë®Šˆ³ç[1796]; $A¿â½Š•Ñ = $this->field($f¹¾À¶Ç”ù)->where($b‚£ÕÌŠÒŸ)->order($bÄë®Šˆ³ç[1797])->select(); return $A¿â½Š•Ñ ? $A¿â½Š•Ñ : array(); } protected function listByTag($e‰İ¾ù‹µ—) { } protected function addToTag($cÚ²¢¡’Åğ, $dæœİğˆ¦) { $EÑ‡½³Ê– =& $_SERVER[¬¦ã¾]; if (!Model($EÑ‡½³Ê–[1932])->listData($dæœİğˆ¦) || !Model($EÑ‡½³Ê–[782])->pathInfo($cÚ²¢¡’Åğ)) { return !1; } $aÄ…Ú¹®Š = array($EÑ‡½³Ê–[1512] => USER_ID, $EÑ‡½³Ê–[463] => $dæœİğˆ¦, $EÑ‡½³Ê–[414] => $cÚ²¢¡’Åğ, $EÑ‡½³Ê–[415] => $EÑ‡½³Ê–[409], $EÑ‡½³Ê–[413] => $EÑ‡½³Ê–[33], $EÑ‡½³Ê–[1692] => 0); if ($this->where($aÄ…Ú¹®Š)->find()) { return !1; } return $this->add($aÄ…Ú¹®Š); } protected function removeFromTag($E“šÛ† â, $E˜ğØ­ô¯¤) { $d·Òª‹ğ–– =& $_SERVER[¬¦ã¾]; if (!Model($d·Òª‹ğ––[1932])->listData($E˜ğØ­ô¯¤)) { return !1; } if (is_array($E“šÛ† â)) { $E“šÛ† â = array($d·Òª‹ğ––[7], $E“šÛ† â); } $E¤Ñ›ÂµÔ = array($d·Òª‹ğ––[1512] => USER_ID, $d·Òª‹ğ––[463] => $E˜ğØ­ô¯¤, $d·Òª‹ğ––[415] => $d·Òª‹ğ––[409], $d·Òª‹ğ––[414] => $E“šÛ† â); return $this->where($E¤Ñ›ÂµÔ)->delete(); } protected function removeByTag($bÉªïÈ±íš) { $FÖ¨øÚÍ­æ =& $_SERVER[¬¦ã¾]; if (!$bÉªïÈ±íš) { return !1; } $Dµ¹•–¬ÏË = array($FÖ¨øÚÍ­æ[1512] => USER_ID, $FÖ¨øÚÍ­æ[463] => $bÉªïÈ±íš); return $this->where($Dµ¹•–¬ÏË)->delete(); } protected function removeBySource($DĞò¡Öã) { $a¯Â¡“í =& $_SERVER[¬¦ã¾]; if (is_array($DĞò¡Öã)) { $DĞò¡Öã = array($a¯Â¡“í[7], $DĞò¡Öã); } $CíóîÀ¦­× = array($a¯Â¡“í[1512] => USER_ID, $a¯Â¡“í[414] => $DĞò¡Öã, $a¯Â¡“í[463] => array($a¯Â¡“í[962], 0)); return $this->where($CíóîÀ¦­×)->delete(); } }