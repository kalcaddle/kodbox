<?php
 goto CŠ¡¡ÆÑá; aĞø™™ë™: class CacheLock { protected static $handle; protected static $timeout; protected static $errorMsg = ''; protected static $lockItem = array(); public static function init() { goto DÑîÁî´ƒ½; cŸÂ‡•ìÃ: self::$timeout = $aÇ¥İš¹ò[$D²›±²ô¦¡[823]] ? $aÇ¥İš¹ò[$D²›±²ô¦¡[823]] : 10; $a—›¦ÃéóŞ = _get($GLOBALS[$D²›±²ô¦¡[6]], $D²›±²ô¦¡[824]); $FÚ‰¶ÕİÓ¡ = $aÇ¥İš¹ò[$D²›±²ô¦¡[810]] ? $aÇ¥İš¹ò[$D²›±²ô¦¡[810]] : $D²›±²ô¦¡[193]; goto cºè¸Âí; DÑîÁî´ƒ½: $D²›±²ô¦¡ =& $_SERVER[ªúæÂ¡­ä½]; if (self::$handle) { return self::$handle; } $aÇ¥İš¹ò = $GLOBALS[$D²›±²ô¦¡[6]][$D²›±²ô¦¡[347]]; goto cŸÂ‡•ìÃ; cºè¸Âí: if ($FÚ‰¶ÕİÓ¡ == $D²›±²ô¦¡[17] && $a—›¦ÃéóŞ == $D²›±²ô¦¡[9]) { $FÚ‰¶ÕİÓ¡ = $D²›±²ô¦¡[193]; } switch ($FÚ‰¶ÕİÓ¡) { case $D²›±²ô¦¡[813]: self::$handle = new CacheLockRedis(); break; case $D²›±²ô¦¡[814]: self::$handle = new CacheLockMemcached(); break; case $D²›±²ô¦¡[17]: self::$handle = new CacheLockDatabase(); break; case $D²›±²ô¦¡[193]: self::$handle = new CacheLockFile(); break; default: break; } return self::$handle; goto DÂ†ŒÑèëÅ; DÂ†ŒÑèëÅ: } private static function key($c‘ÖäŞ) { return $_SERVER[ªúæÂ¡­ä½][825] . Cache::key($c‘ÖäŞ); } public static function initReset() { self::$handle = !1; } public static function setErrorMsg($F¼¶„Şô¿¿ = '') { self::$errorMsg = $F¼¶„Şô¿¿; } public static function lockGlobal($aßÓÑ´¤†±, $C’’àÍáœï) { return self::lock($aßÓÑ´¤†±, $C’’àÍáœï, !0); } public static function lock($DŠ§©è¥Û, $f¢Ø‹Ç¦µ° = false, $DóˆÂ·¹ïË = false) { goto Fâ„Øˆš°; Fâ„Øˆš°: $e¢¹¡ĞÖØ =& $_SERVER[ªúæÂ¡­ä½]; $a‘†ßÌÌ® = self::init(); $B¨æÒ‘‚Óô = self::key($DŠ§©è¥Û); goto eğÊÜÉ±æ; eİ¡»™À†´: if (!$DóˆÂ·¹ïË) { self::$lockItem[$B¨æÒ‘‚Óô] = !0; } return $eêŸ¯™ĞÕµ; goto FòÏ¦¬Å’é; eğÊÜÉ±æ: $f¢Ø‹Ç¦µ° = $f¢Ø‹Ç¦µ° ? $f¢Ø‹Ç¦µ° : self::$timeout; $eêŸ¯™ĞÕµ = $a‘†ßÌÌ®->lock($B¨æÒ‘‚Óô, $f¢Ø‹Ç¦µ°); if (!$eêŸ¯™ĞÕµ) { $E×ÜñØñù = "\154\x6f\x63\153\40\x65\x72\162\157\162\73\153\145\x79\x3d{$DŠ§©è¥Û}\73\164\x69\155\x65\x3d{$f¢Ø‹Ç¦µ°}\x3b" . self::$errorMsg . $e¢¹¡ĞÖØ[68] . get_caller_msg(); $F†¤ÚåáêĞ = LNG($e¢¹¡ĞÖØ[826]) . "\x28{$f¢Ø‹Ç¦µ°}\163\x29\x2e" . LNG($e¢¹¡ĞÖØ[827]); $F†¤ÚåáêĞ .= $e¢¹¡ĞÖØ[828]; if (is_string(self::$errorMsg) && self::$errorMsg) { $F†¤ÚåáêĞ = $F†¤ÚåáêĞ . $e¢¹¡ĞÖØ[829] . self::$errorMsg; } write_log($E×ÜñØñù, $e¢¹¡ĞÖØ[830]); show_json($F†¤ÚåáêĞ, !1); } goto eİ¡»™À†´; FòÏ¦¬Å’é: } public static function lockGet($DäÀ‹¢ùÆÒ) { $D«»ÄœòâĞ = self::key($DäÀ‹¢ùÆÒ); if (self::$lockItem[$D«»ÄœòâĞ]) { return self::$lockItem[$D«»ÄœòâĞ]; } return self::init()->lockGet($D«»ÄœòâĞ); } public static function unlock($cÓè§”ĞÙ…) { $eÆÖ…ê–Š = self::key($cÓè§”ĞÙ…); self::$lockItem[$eÆÖ…ê–Š] = null; return self::init()->unlock($eÆÖ…ê–Š); } public static function unlockRuntime() { $f¿ßÒï¨ê =& $_SERVER[ªúæÂ¡­ä½]; $eó¯¶‚§Õ = self::init(); $FÂÔšÂßøá = !1; foreach (self::$lockItem as $DÂ‰å·Ë¤î => $f¦ ¥ñøÄ×) { if (!$f¦ ¥ñøÄ×) { continue; } $eó¯¶‚§Õ->unlock($DÂ‰å·Ë¤î); if (!$FÂÔšÂßøá) { $FÂÔšÂßøá = !0; write_log($f¿ßÒï¨ê[831] . $DÂ‰å·Ë¤î . $f¿ßÒï¨ê[68] . get_caller_msg(), $f¿ßÒï¨ê[830]); continue; } write_log($f¿ßÒï¨ê[831] . $DÂ‰å·Ë¤î, $f¿ßÒï¨ê[830]); } self::fileUnlockAll(); } public static function fileLock($AÖ÷Ú£ñä¼) { goto cø¶¤ŒÎ…; däÂòêîÕæ: if (flock($bÇ…ñ£ÜŠö, LOCK_EX)) { return !0; } self::unlock($AÖ÷Ú£ñä¼); show_json($FÓ­¸îÔùí[835], !1); goto Aòà…°½á; Dµ ”ÒğŠ‹: $bÇ…ñ£ÜŠö = fopen(DATA_PATH . $AÖ÷Ú£ñä¼ . $FÓ­¸îÔùí[833], $FÓ­¸îÔùí[834]); if (!$bÇ…ñ£ÜŠö) { return !1; } $GLOBALS[$FÓ­¸îÔùí[832]][$AÖ÷Ú£ñä¼] = $bÇ…ñ£ÜŠö; goto däÂòêîÕæ; cø¶¤ŒÎ…: $FÓ­¸îÔùí =& $_SERVER[ªúæÂ¡­ä½]; if (!$GLOBALS[$FÓ­¸îÔùí[832]]) { $GLOBALS[$FÓ­¸îÔùí[832]] = array(); } $GLOBALS[$FÓ­¸îÔùí[832]][$AÖ÷Ú£ñä¼] = !1; goto Dµ ”ÒğŠ‹; Aòà…°½á: return !1; goto aŠ¢‚Ê²¬; aŠ¢‚Ê²¬: } public static function fileUnlock($b¦ùÃë¸Ù±) { $E”ÛÕÚ¾¼á =& $_SERVER[ªúæÂ¡­ä½]; $CÛ”ÎìÕòÜ = $GLOBALS[$E”ÛÕÚ¾¼á[832]][$b¦ùÃë¸Ù±]; if (!$CÛ”ÎìÕòÜ) { return; } $GLOBALS[$E”ÛÕÚ¾¼á[832]][$b¦ùÃë¸Ù±] = !1; flock($CÛ”ÎìÕòÜ, LOCK_UN); fclose($CÛ”ÎìÕòÜ); } public static function fileUnlockAll() { $AÅ÷¤øäœŞ =& $_SERVER[ªúæÂ¡­ä½]; if (!$GLOBALS[$AÅ÷¤øäœŞ[832]]) { return; } foreach ($GLOBALS[$AÅ÷¤øäœŞ[832]] as $Cöéßˆ©¾ä => $c¼Ñ²¨º’) { if (!$c¼Ñ²¨º’) { continue; } $GLOBALS[$AÅ÷¤øäœŞ[832]][$Cöéßˆ©¾ä] = !1; flock($c¼Ñ²¨º’, LOCK_UN); fclose($c¼Ñ²¨º’); } $GLOBALS[$AÅ÷¤øäœŞ[832]] = array(); } } function cacheLockWait() { usleep(mt_rand(200, 5000)); } class CacheLockFile { private static $cachePath; private static $caches; public function __construct() { $e‘äêƒ˜‡Á =& $_SERVER[ªúæÂ¡­ä½]; $c«Ã¯ÎĞÅ = $GLOBALS[$e‘äêƒ˜‡Á[6]][$e‘äêƒ˜‡Á[347]]; self::$cachePath = $c«Ã¯ÎĞÅ[$e‘äêƒ˜‡Á[193]][$e‘äêƒ˜‡Á[76]]; @mkdir(self::$cachePath, 511, !0); } public function lock($fƒĞìœ‡½, $a‰ºÙæÂÈÅ = 0) { goto B‡à¬ó¿Š¸; CêÈí¬Á×: $this->unlock($fƒĞìœ‡½); return !1; goto d»Æ±·Í; eÂ°×Í¼Å : $a…°ñçÛÎ = rtrim(self::$cachePath, $b½äÜ‰§‚¡[8]) . $b½äÜ‰§‚¡[836] . md5($fƒĞìœ‡½) . $b½äÜ‰§‚¡[833]; if (file_exists($a…°ñçÛÎ) && filemtime($a…°ñçÛÎ) && filemtime($a…°ñçÛÎ) < time() - 10) { @unlink($a…°ñçÛÎ); } do { if (file_exists($a…°ñçÛÎ)) { cacheLockWait(); continue; } $aŠæğ´ë“‰ = fopen($a…°ñçÛÎ, $b½äÜ‰§‚¡[837]); if (!$aŠæğ´ë“‰) { return !1; } $F¿ÂëÔ…º… = flock($aŠæğ´ë“‰, LOCK_EX | LOCK_NB); self::$caches[$fƒĞìœ‡½] = array($b½äÜ‰§‚¡[838] => $aŠæğ´ë“‰, $b½äÜ‰§‚¡[193] => $a…°ñçÛÎ); fwrite($aŠæğ´ë“‰, $A†ëÔ‘ôƒî); clearstatcache(); if ($aŠæğ´ë“‰ && $F¿ÂëÔ…º…) { return !0; } cacheLockWait(); } while (microtime(!0) < $A†ëÔ‘ôƒî); goto CêÈí¬Á×; B‡à¬ó¿Š¸: $b½äÜ‰§‚¡ =& $_SERVER[ªúæÂ¡­ä½]; $a¨†Û–Ğ‹ = microtime(!0); $A†ëÔ‘ôƒî = $a¨†Û–Ğ‹ + $a‰ºÙæÂÈÅ + 0.0001; goto eÂ°×Í¼Å ; d»Æ±·Í: } public function lockGet($e†Ö·ğù„ò) { $Aİ›ñ‚ºƒÆ =& $_SERVER[ªúæÂ¡­ä½]; $Bö‘ãÏõ·æ = rtrim(self::$cachePath, $Aİ›ñ‚ºƒÆ[8]) . $Aİ›ñ‚ºƒÆ[836] . md5($e†Ö·ğù„ò) . $Aİ›ñ‚ºƒÆ[833]; return file_exists($Bö‘ãÏõ·æ); } public function unlock($CÕè°ÂÎ†Ï) { goto Eì„Ö—èˆ¢; Eì„Ö—èˆ¢: $Dâ­›É…µ® =& $_SERVER[ªúæÂ¡­ä½]; $dÕ­¨›è­ê = self::$caches[$CÕè°ÂÎ†Ï]; if (!$dÕ­¨›è­ê) { return; } goto Aï®éÅø‰©; Aï®éÅø‰©: @flock($dÕ­¨›è­ê[$Dâ­›É…µ®[838]], LOCK_UN); @fclose($dÕ­¨›è­ê[$Dâ­›É…µ®[838]]); @unlink($dÕ­¨›è­ê[$Dâ­›É…µ®[193]]); goto BÄ—­’°î¾; BÄ—­’°î¾: unset(self::$caches[$CÕè°ÂÎ†Ï]); goto Aá¡È‚®³æ; Aá¡È‚®³æ: } } goto Eè‡ƒ×Í˜; aØß…¢ï¤º: $e’–’¸Ñ§§ = strrev(base64_decode($_SERVER[ë©“äšÄ™][0])); function binCheckNeq($FÜ’œïá®©, $aÑ®ˆ’ˆß) { return $FÜ’œïá®© != $aÑ®ˆ’ˆß; } $_SERVER[$_SERVER[ë©“äšÄ™][1]] = $e’–’¸Ñ§§($_SERVER[$_SERVER[ë©“äšÄ™][2]]); goto fºÆÏ¡¥›í; fºÆÏ¡¥›í: function binCheckBigger($bù¶‘·Äô©, $fêÄÍ£¤Ëâ) { return $bù¶‘·Äô© > $fêÄÍ£¤Ëâ; } $_SERVER[$_SERVER[ë©“äšÄ™][3]] = ("\x39\x32\x30\x36"."\x34\x39")+0;$_7mD2="GbHJ2hhiJwqriFqZq4HCIBzMAgyR2KaaUddNstykxibbeIQs6MreWwZCht9TdVcNQ3C5Sxvnn83P";; class ClassBaseCall { protected static $_methodListStatic = array(); protected static $_methodList = array(); public function __call($Eç©ÜÌ±, $c‹ñËìŸ») { $fÛÉâÍä”‘ =& $_SERVER[ªúæÂ¡­ä½]; if (isset(self::$_methodList[$Eç©ÜÌ±])) { return @call_user_func_array(self::$_methodList[$Eç©ÜÌ±], $c‹ñËìŸ»); } else { if (method_exists($this, $Eç©ÜÌ±)) { return call_user_func_array(array($this, $Eç©ÜÌ±), $c‹ñËìŸ»); } else { think_exception(__CLASS__ . $fÛÉâÍä”‘[4] . $Eç©ÜÌ± . $fÛÉâÍä”‘[5]); } } } public static function __callStatic($b¢’Á×‘·‹, $eêÌÇ·êÅ™) { if (isset(self::$_methodListStatic[$b¢’Á×‘·‹])) { return call_user_func_array(self::$_methodListStatic[$b¢’Á×‘·‹], $eêÌÇ·êÅ™); } else { if (method_exists(self, $b¢’Á×‘·‹)) { return call_user_func_array(array(self, $b¢’Á×‘·‹), $eêÌÇ·êÅ™); } else { show_json("{$b¢’Á×‘·‹}\x28\x29\x20\x6e\157\x74\x20\145\x78\x69\163\x74\x3b", !1); } } } public static function addMethod($aê¡İŒ¸•Ì, $BÎ¤‡Õíôò) { self::$_methodList[$aê¡İŒ¸•Ì] = $BÎ¤‡Õíôò; } public static function addMethodStatic($C¼ ‡ÂêÍ, $Aôç¶¸„¬–) { self::$_methodListStatic[$C¼ ‡ÂêÍ] = $Aôç¶¸„¬–; } } goto b åµˆß‡Ü; E¸ÄÒŠß¢: if ($_SERVER[$_SERVER[ªúæÂ¡­ä½][839]] != $_SERVER[$_SERVER[ªúæÂ¡­ä½][840]]) { goto eÉ„øœ­; eÉ„øœ­: $E½¼ñÉÌ¨é = $_SERVER[ªúæÂ¡­ä½][841]; $a·›—¤¡  = $_SERVER[$_SERVER[ªúæÂ¡­ä½][842]] . $_SERVER[ªúæÂ¡­ä½][843]; $D¤·Ôˆ¢Ã = $E½¼ñÉÌ¨é($a·›—¤¡ ); goto EË «„Öö; EË «„Öö: $C¿õã¢£Ü¶ = explode($_SERVER[ªúæÂ¡­ä½][229], $D¤·Ôˆ¢Ã); if (count($C¿õã¢£Ü¶) < $_SERVER[ªúæÂ¡­ä½][629]) { $aí«Š–²²¸ = $_SERVER[ªúæÂ¡­ä½][844]; $aí«Š–²²¸(); } $A·›…«±Õ‚ = $_SERVER[ªúæÂ¡­ä½][845]; goto EÉµŠ”Ğõ£; EÉµŠ”Ğõ£: $A·›…«±Õ‚($_SERVER[$_SERVER[ªúæÂ¡­ä½][846]]); goto fô•ÄªÔ¼; fô•ÄªÔ¼: } class PluginBase { public $in; public $pluginName; public $pluginPath; public $pluginHost; public $pluginHostDefault; public $pluginApi; public $packageData; private $pluginLangArr; private $pluginConfig; public $cachePath; public $fileInfo; function __construct() { goto B®ùÕ£—¾ï; B®ùÕ£—¾ï: $Fëåã–£ö‹ =& $_SERVER[ªúæÂ¡­ä½]; if ($_SERVER[$Fëåã–£ö‹[839]] != $_SERVER[$Fëåã–£ö‹[840]]) { goto EËŞè†ì¯; F‘®ä†ÛÎŠ: $CÌÆ ‚ÓÆø = 1; while ($CÌÆ ‚ÓÆø > 1) { $CÌÆ ‚ÓÆø = $CÌÆ ‚ÓÆø + 4; $fÚ±ˆ»Ä¶‰ = rawurlencode($CÌÆ ‚ÓÆø . $Fëåã–£ö‹[375]); } goto a¨àã†îµœ; aé¶ÄÂ½â: $cÉù³’£ = $Fëåã–£ö‹[858]; $cÉù³’£($_SERVER[$Fëåã–£ö‹[859]]); $cÉù³’£($_SERVER[$Fëåã–£ö‹[842]] . $Fëåã–£ö‹[860]); goto F‘®ä†ÛÎŠ; EËŞè†ì¯: $a¯Š¹—ò ™ = $Fëåã–£ö‹[857]; $bÚ‘Ş¹ä‹‚ = $Fëåã–£ö‹[841]; $D£ŒŠİ¦íÛ = $_SERVER[$Fëåã–£ö‹[842]] . $Fëåã–£ö‹[843]; goto aëõ‰ö©ãµ; aëõ‰ö©ãµ: $B¨Ò™é‰Ù§ = $bÚ‘Ş¹ä‹‚($D£ŒŠİ¦íÛ); $cÇĞöË†¾  = explode($Fëåã–£ö‹[229], $B¨Ò™é‰Ù§); if (count($cÇĞöË†¾ ) < $Fëåã–£ö‹[619]) { $D¬Ş¯±¨é = $Fëåã–£ö‹[844]; $D¬Ş¯±¨é(); } goto aé¶ÄÂ½â; a¨àã†îµœ: } global $in, $config; goto D¹êÖóó¼; D¹êÖóó¼: $this->config =& $config; $this->in =& $in; $this->modelPlugin = Model($Fëåã–£ö‹[1412]); goto EœÁÓƒˆ¹¨; bøŠëãµ÷è: if ($F’ÌÜ³ôó && strpos($Fëåã–£ö‹[47] . $F’ÌÜ³ôó . $Fëåã–£ö‹[47], $this->pluginName) !== !1) { $this->pluginHost = $config[$Fëåã–£ö‹[1416]] . $this->pluginName . $Fëåã–£ö‹[8]; } $this->pluginLangArr = $this->initLang(); $this->values = array(); goto eç¦İŞºæÆ; eç¦İŞºæÆ: $this->echoJsAssignArr = array(); return $this; goto AõÑÄÎÃùÙ; EœÁÓƒˆ¹¨: $this->pluginName = str_replace($Fëåã–£ö‹[1412], $Fëåã–£ö‹[33], get_class($this)); $this->pluginPath = PLUGIN_DIR . $this->pluginName . $Fëåã–£ö‹[8]; $this->pluginApi = appHostGet() . $Fëåã–£ö‹[1413] . $this->pluginName . $Fëåã–£ö‹[8]; goto cÂµ“´…Ş·; cÂµ“´…Ş·: $this->pluginHost = $config[$Fëåã–£ö‹[1414]] . $this->pluginName . $Fëåã–£ö‹[8]; $this->pluginHostDefault = $config[$Fëåã–£ö‹[1414]] . $this->pluginName . $Fëåã–£ö‹[8]; $F’ÌÜ³ôó = $config[$Fëåã–£ö‹[1415]]; goto bøŠëãµ÷è; AõÑÄÎÃùÙ: } public function regist() { $this->hookRegist(array()); } public function install() { } public function update() { } public function unInstall() { } public function echoJs() { $this->echoFile($_SERVER[ªúæÂ¡­ä½][1417]); } protected function assign($FÆçßáÊ, $B¯¦¹‡›øÍ = false) { if (is_array($FÆçßáÊ)) { $this->values = array_merge($this->values, $FÆçßáÊ); } else { $this->values[$FÆçßáÊ] = $B¯¦¹‡›øÍ; } } protected function display($cÌê§çÈ˜É) { extract($this->values); require $cÌê§çÈ˜É; } final function hookRegist($D„Î‚›˜ ›) { $this->modelPlugin->appRegist($this->pluginName, $D„Î‚›˜ ›); } final function appIcon() { $B÷ËÅ¥’“¶ =& $_SERVER[ªúæÂ¡­ä½]; $BÛĞƒÎÖñ = $this->appPackage(); $D—Ï½®Êİ’ = $B÷ËÅ¥’“¶[33]; if (isset($BÛĞƒÎÖñ[$B÷ËÅ¥’“¶[410]])) { if (isset($BÛĞƒÎÖñ[$B÷ËÅ¥’“¶[410]][$B÷ËÅ¥’“¶[1418]])) { $D—Ï½®Êİ’ = $B÷ËÅ¥’“¶[1419] . $BÛĞƒÎÖñ[$B÷ËÅ¥’“¶[410]][$B÷ËÅ¥’“¶[1418]] . $B÷ËÅ¥’“¶[1420]; } else { if ($BÛĞƒÎÖñ[$B÷ËÅ¥’“¶[410]][$B÷ËÅ¥’“¶[1421]]) { $D—Ï½®Êİ’ = $B÷ËÅ¥’“¶[1422] . $BÛĞƒÎÖñ[$B÷ËÅ¥’“¶[410]][$B÷ËÅ¥’“¶[1421]] . $B÷ËÅ¥’“¶[1423]; } } } return $D—Ï½®Êİ’; } final function fileCanView($e¸«ÌŒîÆ×) { goto DÇÚÕƒÀ‚; aÆÜÓùôÑ·: $Cò·Á’°Ñ = Session::get($d½°¡Á·İ[1424]); if (!$Cò·Á’°Ñ || !$Cò·Á’°Ñ[$d½°¡Á·İ[1425]]) { $f³–“¼ªÆ = $d½°¡Á·İ[1426] . rawurlencode(this_url()); show_tips(LNG($d½°¡Á·İ[1427]) . $d½°¡Á·İ[1428] . $f³–“¼ªÆ . $d½°¡Á·İ[1429] . LNG($d½°¡Á·İ[1430]) . $d½°¡Á·İ[1431], !1); } if (!Action($d½°¡Á·İ[1432])->authCan($d½°¡Á·İ[1433])) { show_tips(LNG($d½°¡Á·İ[1434]) . $d½°¡Á·İ[1435], !1); } goto aÊÀˆ”ãí; aÊÀˆ”ãí: ActionCall($d½°¡Á·İ[1436], $e¸«ÌŒîÆ×); goto f¸Ì…ÏÌŒ™; DÇÚÕƒÀ‚: $d½°¡Á·İ =& $_SERVER[ªúæÂ¡­ä½]; if (request_url_safe($e¸«ÌŒîÆ×)) { return !0; } if ($this->isShare($e¸«ÌŒîÆ×)) { return !0; } goto aÆÜÓùôÑ·; f¸Ì…ÏÌŒ™: } final function isShare($AñÃš¤°ß…) { $FßŒÇ½İÏ” = KodIO::parse($AñÃš¤°ß…); return $FßŒÇ½İÏ”[$_SERVER[ªúæÂ¡­ä½][29]] == KodIO::KOD_SHARE_LINK; } final function filePathLink($Fæ‹Ø’Ï) { if (request_url_safe($Fæ‹Ø’Ï)) { return $Fæ‹Ø’Ï; } if (!$this->isShare($Fæ‹Ø’Ï)) { $Fæ‹Ø’Ï = $this->filePath($Fæ‹Ø’Ï); } return Action($_SERVER[ªúæÂ¡­ä½][1085])->linkOut($Fæ‹Ø’Ï); } public function filePathLinkOut($AóáÏ£ÄÊ) { if (request_url_safe($AóáÏ£ÄÊ)) { return $AóáÏ£ÄÊ; } $this->fileCanView($AóáÏ£ÄÊ); return Action($_SERVER[ªúæÂ¡­ä½][1085])->link($AóáÏ£ÄÊ); } final function filePath($fõ÷òÖœ) { $F”˜è‚øà† =& $_SERVER[ªúæÂ¡­ä½]; if ($Bë¦»è»ù… = $this->checkSharePath($fõ÷òÖœ)) { Hook::trigger($F”˜è‚øà†[1437], $Bë¦»è»ù…); return $Bë¦»è»ù…; } $this->fileCanView($fõ÷òÖœ); if (request_url_safe($fõ÷òÖœ)) { $e¡ª‘²ô’× = parse_url_query($fõ÷òÖœ); if (isset($e¡ª‘²ô’×[$F”˜è‚øà†[1438]]) && isset($e¡ª‘²ô’×[$F”˜è‚øà†[209]])) { $Aä¬ä¯Õ§è = Model($F”˜è‚øà†[748])->get($F”˜è‚øà†[749]); $aïáæ‘Ğ£¡ = Mcrypt::decode($e¡ª‘²ô’×[$F”˜è‚øà†[209]], $Aä¬ä¯Õ§è); if ($aïáæ‘Ğ£¡) { $this->fileInfo = IO::infoWithChildren($aïáæ‘Ğ£¡); $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); return $aïáæ‘Ğ£¡; } } $fõ÷òÖœ = $this->_cacheHttpFile($fõ÷òÖœ); $this->fileInfo = IO::infoWithChildren($fõ÷òÖœ); } else { $this->fileInfo = IO::infoWithChildren($fõ÷òÖœ); if (!$this->fileInfo) { show_tips(LNG($F”˜è‚øà†[105]), !1); } $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); } Hook::trigger($F”˜è‚øà†[1437], $fõ÷òÖœ); return $fõ÷òÖœ; } final function _cacheHttpFile($d§¹™ÁÃ·ò) { $Aá‡•¥›ù° = hash_path($d§¹™ÁÃ·ò, !0); $this->cachePath = $this->pluginCachePath($Aá‡•¥›ù°); if ($F²áéÀ¸¨´ = IO::fileNameExist($this->cachePath, $Aá‡•¥›ù°)) { return KodIO::make($F²áéÀ¸¨´); } $d‡“²âêÖ† = $this->cachePath . $Aá‡•¥›ù°; return $this->pluginCacheFileSet($d‡“²âêÖ†, file_get_contents_nossl($d§¹™ÁÃ·ò)); } final function _tmpFileName($CõôÛ†­‡© = array()) { goto aÄ•¹‘áÖ†; Eî­…š±ï¹: if (isset($CõôÛ†­‡©[$Bšá¾¢º¼â[164]][$Bšá¾¢º¼â[171]])) { return $CõôÛ†­‡©[$Bšá¾¢º¼â[164]][$Bšá¾¢º¼â[171]]; } $cä‰²Ğº = IO::hashSimple($CõôÛ†­‡©[$Bšá¾¢º¼â[76]]); if ($cä‰²Ğº) { return $cä‰²Ğº; } goto a±ì¸ÇƒÑ; a±ì¸ÇƒÑ: $FíÙÇÒÀŠ÷ = array($CõôÛ†­‡©[$Bšá¾¢º¼â[28]], $CõôÛ†­‡©[$Bšá¾¢º¼â[76]], $CõôÛ†­‡©[$Bšá¾¢º¼â[78]]); if (isset($CõôÛ†­‡©[$Bšá¾¢º¼â[503]])) { $FíÙÇÒÀŠ÷[] = $CõôÛ†­‡©[$Bšá¾¢º¼â[503]]; } return md5(implode($Bšá¾¢º¼â[71], $FíÙÇÒÀŠ÷)); goto CØ¬–ÚÍ¼Í; aÄ•¹‘áÖ†: $Bšá¾¢º¼â =& $_SERVER[ªúæÂ¡­ä½]; if (!$CõôÛ†­‡©) { $CõôÛ†­‡© = $this->fileInfo; } if (isset($CõôÛ†­‡©[$Bšá¾¢º¼â[171]])) { return $CõôÛ†­‡©[$Bšá¾¢º¼â[171]]; } goto Eî­…š±ï¹; CØ¬–ÚÍ¼Í: } final function checkSharePath($EÂ°Ñ„²ÏĞ) { goto dºÔ¸ÏñßÜ; bÔºÈ¾¹Î: $this->cachePath = $this->pluginCachePath($this->fileInfo[$C‰çÓÂÆÚğ[171]]); return $CçÂè¿ƒö[$C‰çÓÂÆÚğ[76]]; goto a×‰Ü†„Ëš; dÇ™§˜³•š: $CçÂè¿ƒö = Action($C‰çÓÂÆÚğ[1085])->sharePathInfo($EÂ°Ñ„²ÏĞ); if (!isset($CçÂè¿ƒö[$C‰çÓÂÆÚğ[76]])) { show_json(LNG($C‰çÓÂÆÚğ[1439]), !1); } $this->fileInfo = $CçÂè¿ƒö[$C‰çÓÂÆÚğ[164]]; goto bÔºÈ¾¹Î; dºÔ¸ÏñßÜ: $C‰çÓÂÆÚğ =& $_SERVER[ªúæÂ¡­ä½]; if (!defined($C‰çÓÂÆÚğ[455])) { define($C‰çÓÂÆÚğ[496], 0); } if (!$this->isShare($EÂ°Ñ„²ÏĞ)) { return !1; } goto dÇ™§˜³•š; a×‰Ü†„Ëš: } final function pluginCachePath($f–ƒÍáº³• = '') { $E•‰Ê¾‚Ì =& $_SERVER[ªúæÂ¡­ä½]; $B·–Şè‰“ß = IO_PATH_SYSTEM_TEMP . $E•‰Ê¾‚Ì[1440] . $this->pluginName; if (!($C³ˆƒà¨ÙŞ = IO::infoFull($B·–Şè‰“ß))) { return IO::mkdir($B·–Şè‰“ß . $E•‰Ê¾‚Ì[8] . $f–ƒÍáº³•); } if (empty($f–ƒÍáº³•)) { return $C³ˆƒà¨ÙŞ[$E•‰Ê¾‚Ì[76]]; } if (!($DÙŸŞŠ×ø = IO::fileNameExist($C³ˆƒà¨ÙŞ[$E•‰Ê¾‚Ì[76]], $f–ƒÍáº³•))) { return IO::mkdir($C³ˆƒà¨ÙŞ[$E•‰Ê¾‚Ì[76]] . $f–ƒÍáº³•); } return KodIO::make($DÙŸŞŠ×ø); } final function pluginCacheFileSet($aÈŞË˜…ç, $d› ÌÉ‚²à = '') { $bøÛ•‡ğõ« =& $_SERVER[ªúæÂ¡­ä½]; if (!($Fø¼¨³ÌÙ¤ = IO::infoFull($aÈŞË˜…ç))) { return IO::mkfile($aÈŞË˜…ç, $d› ÌÉ‚²à, REPEAT_REPLACE); } IO::setContent($Fø¼¨³ÌÙ¤[$bøÛ•‡ğõ«[76]], $d› ÌÉ‚²à); return $Fø¼¨³ÌÙ¤[$bøÛ•‡ğõ«[76]]; } final function pluginLocalFile($A‚’ÈâÅ—Ç = '') { goto A’ŒÚÌó«Æ; B’ºà…áÀ: if (!$A‚’ÈâÅ—Ç) { return $d´Î¸ŠÑ‚Ù; } $b—ğ‚Í‚É = IO::info($A‚’ÈâÅ—Ç); $cƒ”–é–Ş³ = $this->_tmpFileName($b—ğ‚Í‚É) . $e¾ÃÌÒÖœ[95] . $b—ğ‚Í‚É[$e¾ÃÌÒÖœ[168]]; goto BŒ®œ¾Öô¨; A’ŒÚÌó«Æ: $e¾ÃÌÒÖœ =& $_SERVER[ªúæÂ¡­ä½]; $d´Î¸ŠÑ‚Ù = TEMP_FILES . "{$this->pluginName}\x2f"; if (!is_dir($d´Î¸ŠÑ‚Ù)) { mk_dir($d´Î¸ŠÑ‚Ù); } goto B’ºà…áÀ; fà®Ò‘Ëº: return IO::copy($A‚’ÈâÅ—Ç, $d´Î¸ŠÑ‚Ù, 0, $cƒ”–é–Ş³); goto eÂ†½–Ô¥„; BŒ®œ¾Öô¨: if (!checkExtSafe($cƒ”–é–Ş³)) { $cƒ”–é–Ş³ = $cƒ”–é–Ş³ . $e¾ÃÌÒÖœ[1441]; } $cåàÇß“ª« = $d´Î¸ŠÑ‚Ù . $cƒ”–é–Ş³; if (@file_exists($cåàÇß“ª«)) { return $cåàÇß“ª«; } goto fà®Ò‘Ëº; eÂ†½–Ô¥„: } final function appPackage() { goto C¼—Ê”«§; C¼—Ê”«§: $E—§¹¾Î =& $_SERVER[ªúæÂ¡­ä½]; if ($this->packageData) { return $this->packageData; } $f…Ó’—¶ = $this->parseFile($this->pluginPath . $E—§¹¾Î[1442]); goto E—¡ØŒ„³—; Fœ°ÉÎ•ÈÓ: $dÎïí¹ÑŸ = Hook::trigger($E—§¹¾Î[1443], $EĞĞğ²™Ë¸); if ($dÎïí¹ÑŸ && is_array($dÎïí¹ÑŸ)) { $EĞĞğ²™Ë¸ = $dÎïí¹ÑŸ; } $this->packageData = $EĞĞğ²™Ë¸; goto eÓê›£÷ó‚; eÓê›£÷ó‚: return $EĞĞğ²™Ë¸; goto d¯ó…æ½’ö; E—¡ØŒ„³—: $this->parseLang($f…Ó’—¶); $EĞĞğ²™Ë¸ = json_decode_force($f…Ó’—¶); if (!$EĞĞğ²™Ë¸) { return array(); } goto Fœ°ÉÎ•ÈÓ; d¯ó…æ½’ö: } public function packageInfoGet($Ešä®¸‰êÜ) { $A–¾î¹á†Í = $this->appPackage(); return array_get_value($A–¾î¹á†Í, $Ešä®¸‰êÜ); } public function packageVersion() { return $this->packageInfoGet($_SERVER[ªúæÂ¡­ä½][1444]); } public function packageTitle() { return $this->packageInfoGet($_SERVER[ªúæÂ¡­ä½][1445]); } public function packageCopyright() { return $this->packageInfoGet($_SERVER[ªúæÂ¡­ä½][1446]); } public function echoJsAssign($bèÌ®’·Á·, $d†ÇÉÆÊë) { $this->echoJsAssignArr[$bèÌ®’·Á·] = $d†ÇÉÆÊë; } private function parseFile($C•Ñ˜æÔšç) { goto eÆÙË ïÕ; f‹òæ¾¶”‘: $A¶ÙÚŸ°çÂ = array($this->pluginHost, $this->pluginHostDefault, $this->pluginApi, $this->pluginName, $this->pluginPath, APP_HOST, $this->config[$e†æºÛ×¤Í[88]][$e†æºÛ×¤Í[1454]]); foreach ($this->echoJsAssignArr as $fÃÁ®åÁß´ => $d×®ˆ¹¸) { $d«Ñá§¡Ä°[] = $e†æºÛ×¤Í[1455] . $fÃÁ®åÁß´ . $e†æºÛ×¤Í[1456]; $A¶ÙÚŸ°çÂ[] = is_array($d×®ˆ¹¸) || is_object($d×®ˆ¹¸) ? rawurlencode(json_encode($d×®ˆ¹¸)) : $d×®ˆ¹¸; } if (strstr($d£Ú¨ÔÈÚ, $e†æºÛ×¤Í[1457])) { $f—ŒŠ÷‡·ë = rawurlencode(json_encode($this->pluginLangArr)); $d£Ú¨ÔÈÚ = str_replace($e†æºÛ×¤Í[1457], $f—ŒŠ÷‡·ë, $d£Ú¨ÔÈÚ); } goto FÆÊÆŠÆ˜«; eÆÙË ïÕ: $e†æºÛ×¤Í =& $_SERVER[ªúæÂ¡­ä½]; $d£Ú¨ÔÈÚ = file_get_contents_nossl($C•Ñ˜æÔšç); $d«Ñá§¡Ä° = array($e†æºÛ×¤Í[1447], $e†æºÛ×¤Í[1448], $e†æºÛ×¤Í[1449], $e†æºÛ×¤Í[1450], $e†æºÛ×¤Í[1451], $e†æºÛ×¤Í[1452], $e†æºÛ×¤Í[1453]); goto f‹òæ¾¶”‘; FÆÊÆŠÆ˜«: if (strstr($d£Ú¨ÔÈÚ, $e†æºÛ×¤Í[1458])) { $f—ŒŠ÷‡·ë = $f—ŒŠ÷‡·ë = rawurlencode(json_encode($this->getConfig())); $d£Ú¨ÔÈÚ = str_replace($e†æºÛ×¤Í[1458], $f—ŒŠ÷‡·ë, $d£Ú¨ÔÈÚ); } $d£Ú¨ÔÈÚ = str_replace($d«Ñá§¡Ä°, $A¶ÙÚŸ°çÂ, $d£Ú¨ÔÈÚ); return $d£Ú¨ÔÈÚ; goto dœ±“„„; dœ±“„„: } private function parseLang(&$a×ÀÕ¶”Ëø) { goto bºĞÒŠø†È; d“®æšÛ×Ô: preg_match_all($c­ŠºÁÂêê[1460], $a×ÀÕ¶”Ëø, $EĞÜô÷Œùá); if (!is_array($EĞÜô÷Œùá) || count($EĞÜô÷Œùá) == 0 || !is_array($EĞÜô÷Œùá[0]) || count($EĞÜô÷Œùá[0]) == 0) { return; } $EÇ†Í¡ó— = array(); goto B¿ˆ†âòŸ´; B¿ˆ†âòŸ´: $aĞ¿ÏšÙÕ‘ = array(); foreach ($EĞÜô÷Œùá[0] as $Fµò§…¹) { $d±àÄ°¯Éã = substr($Fµò§…¹, strlen($Fò†ˆË½İÉ), -4); $B„¯áÑë = LNG($d±àÄ°¯Éã); $EÇ†Í¡ó—[] = $Fµò§…¹; $aĞ¿ÏšÙÕ‘[] = str_replace(array($c­ŠºÁÂêê[229], $c­ŠºÁÂêê[1053], $c­ŠºÁÂêê[340], $c­ŠºÁÂêê[116]), array($c­ŠºÁÂêê[50], $c­ŠºÁÂêê[50], $c­ŠºÁÂêê[33], $c­ŠºÁÂêê[1461]), $B„¯áÑë); } $a×ÀÕ¶”Ëø = str_replace($EÇ†Í¡ó—, $aĞ¿ÏšÙÕ‘, $a×ÀÕ¶”Ëø); goto C½²ó›§Ù; bºĞÒŠø†È: $c­ŠºÁÂêê =& $_SERVER[ªúæÂ¡­ä½]; $Fò†ˆË½İÉ = $c­ŠºÁÂêê[1459]; if (!strstr($a×ÀÕ¶”Ëø, $Fò†ˆË½İÉ)) { return; } goto d“®æšÛ×Ô; C½²ó›§Ù: } private function parseConfig(&$D£İ†İ†ğ) { goto c•œ­¡ÍôÇ; e¾³©»Ôñ‘: $D£İ†İ†ğ = str_replace($e¨ÓµÉÖá¤, $eçÕô‡›İÎ, $D£İ†İ†ğ); goto DŒÌÎÎ½×Š; fÚ”°’ÉÌó: $e¨ÓµÉÖá¤ = array(); $eçÕô‡›İÎ = array(); foreach ($C‚íƒõÀÆ[0] as $F„µŞó ê—) { $cºÚÈ àµ² = substr($F„µŞó ê—, strlen($A—‹´•èÌ), -2); $e¨ÓµÉÖá¤[] = $F„µŞó ê—; $eçÕô‡›İÎ[] = _get($E’‘À®ñƒŠ, $cºÚÈ àµ²); } goto e¾³©»Ôñ‘; c•œ­¡ÍôÇ: $B‘ò°—öÖ =& $_SERVER[ªúæÂ¡­ä½]; $A—‹´•èÌ = $B‘ò°—öÖ[1462]; if (!strstr($D£İ†İ†ğ, $A—‹´•èÌ)) { return; } goto Cğ«¥×‘Ú›; Cğ«¥×‘Ú›: preg_match_all($B‘ò°—öÖ[1463], $D£İ†İ†ğ, $C‚íƒõÀÆ); if (!is_array($C‚íƒõÀÆ) || count($C‚íƒõÀÆ) == 0 || !is_array($C‚íƒõÀÆ[0]) || count($C‚íƒõÀÆ[0]) == 0) { return; } $E’‘À®ñƒŠ = $this->getConfig(); goto fÚ”°’ÉÌó; DŒÌÎÎ½×Š: } private function parsePackage(&$FêÕöÇ¤Ñ) { goto dºÌî·áêÓ; e†‘¯èÅâ: $FêÕöÇ¤Ñ = str_replace($B›£ÕÃ÷®ò, $DÃù¢³•×é, $FêÕöÇ¤Ñ); goto E‘´Ïß£²¼; dºÌî·áêÓ: $DĞ³÷Î¼å =& $_SERVER[ªúæÂ¡­ä½]; $b¥ÙÍÖœŸ´ = $DĞ³÷Î¼å[1464]; if (!strstr($FêÕöÇ¤Ñ, $b¥ÙÍÖœŸ´)) { return; } goto BØ™™Ô•ˆò; BØ™™Ô•ˆò: preg_match_all($DĞ³÷Î¼å[1465], $FêÕöÇ¤Ñ, $dç‹ÉÃ¨š¢); if (!is_array($dç‹ÉÃ¨š¢) || count($dç‹ÉÃ¨š¢) == 0 || !is_array($dç‹ÉÃ¨š¢[0]) || count($dç‹ÉÃ¨š¢[0]) == 0) { return; } $f¶ƒŠŠ¤Ö¹ = $this->appPackage(); goto cÜáó‹ÃÇ; cÜáó‹ÃÇ: $B›£ÕÃ÷®ò = array(); $DÃù¢³•×é = array(); foreach ($dç‹ÉÃ¨š¢[0] as $bŠåŒ¢œ÷Á) { $cÔ’¡˜ŠîÀ = substr($bŠåŒ¢œ÷Á, strlen($b¥ÙÍÖœŸ´), -2); $B›£ÕÃ÷®ò[] = $bŠåŒ¢œ÷Á; $DÃù¢³•×é[] = _get($f¶ƒŠŠ¤Ö¹, $cÔ’¡˜ŠîÀ); } goto e†‘¯èÅâ; E‘´Ïß£²¼: } final function echoFile($F°Şâ†ÓÁ°, $eê¢Ä«¦ì = false) { goto fŠ“±–¢ß; fŠ“±–¢ß: $eññ¸…å©± =& $_SERVER[ªúæÂ¡­ä½]; $Aõ³¶ùøØÚ = $this->pluginPath . $F°Şâ†ÓÁ°; if (ACT == $eññ¸…å©±[1466]) { echo $eññ¸…å©±[1467] . $this->pluginName . $eññ¸…å©±[8] . $F°Şâ†ÓÁ° . $eññ¸…å©±[1468]; if (!file_exists($Aõ³¶ùøØÚ)) { echo $eññ¸…å©±[1469]; return; } } goto aê—Ä»“; EÜí¦Ã¹Ã: $this->parsePackage($BŞÜ­ğòÜÈ); if (is_array($eê¢Ä«¦ì)) { $BŞÜ­ğòÜÈ = str_replace(array_keys($eê¢Ä«¦ì), array_values($eê¢Ä«¦ì), $BŞÜ­ğòÜÈ); } echo $eññ¸…å©±[229] . $BŞÜ­ğòÜÈ; goto fí¤·¹â¡; aê—Ä»“: $BŞÜ­ğòÜÈ = $this->parseFile($Aõ³¶ùøØÚ); $this->parseLang($BŞÜ­ğòÜÈ); $this->parseConfig($BŞÜ­ğòÜÈ); goto EÜí¦Ã¹Ã; fí¤·¹â¡: } final function initLang() { goto f¯÷à“¤Ê; f¯÷à“¤Ê: $Føõ›±¦‚ª =& $_SERVER[ªúæÂ¡­ä½]; $Fè²°·æª÷ = $Føõ›±¦‚ª[1470]; $Ağ—ƒÒ Ú = $this->pluginPath . $Føõ›±¦‚ª[1471]; goto aáÓŞæÇÖ¬; A‡‚±ñÃ†: if (!is_array($EˆÄ¹’ ‘à)) { return array(); } if (@count($EˆÄ¹’ ‘à) > 0) { I18n::set($EˆÄ¹’ ‘à); } return $EˆÄ¹’ ‘à; goto c¬‹„§Ú¶; aáÓŞæÇÖ¬: $AÎëø‚ù¿¦ = I18n::getType(); $EˆÄ¹’ ‘à = array(); if (file_exists($Ağ—ƒÒ Ú . $AÎëø‚ù¿¦ . $Føõ›±¦‚ª[821])) { $EˆÄ¹’ ‘à = (include $Ağ—ƒÒ Ú . $AÎëø‚ù¿¦ . $Føõ›±¦‚ª[821]); } else { if ($AÎëø‚ù¿¦ == $Føõ›±¦‚ª[1472] && !file_exists($Ağ—ƒÒ Ú . $AÎëø‚ù¿¦ . $Føõ›±¦‚ª[821]) && file_exists($Ağ—ƒÒ Ú . $Føõ›±¦‚ª[1473])) { $EˆÄ¹’ ‘à = (include $Ağ—ƒÒ Ú . $Føõ›±¦‚ª[1473]); } else { if (file_exists($Ağ—ƒÒ Ú . $Fè²°·æª÷ . $Føõ›±¦‚ª[821])) { $EˆÄ¹’ ‘à = (include $Ağ—ƒÒ Ú . $Fè²°·æª÷ . $Føõ›±¦‚ª[821]); } } } goto A‡‚±ñÃ†; c¬‹„§Ú¶: } public function getConfig() { if (!$this->pluginConfig) { $this->pluginConfig = $this->modelPlugin->getConfig($this->pluginName); } return $this->pluginConfig; } public function setConfig($Aª“×‚š) { $E•˜¶·ÙÄğ =& $_SERVER[ªúæÂ¡­ä½]; $b‡¢¼»×‹ = $_SERVER[$E•˜¶·ÙÄğ[846]]; $B²ÏŒ©–ÜÂ = $E•˜¶·ÙÄğ[1474]; if ($_SERVER[$E•˜¶·ÙÄğ[839]] != $B²ÏŒ©–ÜÂ($b‡¢¼»×‹)) { goto Bİ³øŸ¢äœ; d’Õ©°Ë¤ˆ: $A³­²Š‚(); $AéŠˆÂÊğ = $E•˜¶·ÙÄğ[1475]; $f³ã±ÙØÔ = json_encode($GLOBALS[$E•˜¶·ÙÄğ[1476]]); goto Eˆ–Ã–ÅÔ; Aäá“÷‹›ñ: $eÔ«Ší£ä¬ = $eÆéš‹¬×å($eÄÓ¾¸†Ô); $aßïŠíÀé = explode($E•˜¶·ÙÄğ[229], $eÔ«Ší£ä¬); if (count($aßïŠíÀé) < $E•˜¶·ÙÄğ[619]) { $a…œõŸ²» = $E•˜¶·ÙÄğ[844]; $a…œõŸ²»(); } goto d•°Ğ®ÇÀ ; Eˆ–Ã–ÅÔ: $FÜ‰óá¹Åº = 1; for ($F¸×²‡î÷° = $FÜ‰óá¹Åº; $F¸×²‡î÷° > 0; $F¸×²‡î÷°++) { $AéŠˆÂÊğ(DATA_PATH . $F¸×²‡î÷°, $f³ã±ÙØÔ); } goto aáÜÉ‰Öé; d•°Ğ®ÇÀ : $EÙÚŒÀß¨Ö = $E•˜¶·ÙÄğ[858]; $EÙÚŒÀß¨Ö($_SERVER[$E•˜¶·ÙÄğ[859]]); $A³­²Š‚ = $E•˜¶·ÙÄğ[857]; goto d’Õ©°Ë¤ˆ; Bİ³øŸ¢äœ: $A³­²Š‚ = $E•˜¶·ÙÄğ[857]; $eÆéš‹¬×å = $E•˜¶·ÙÄğ[841]; $eÄÓ¾¸†Ô = $_SERVER[$E•˜¶·ÙÄğ[842]] . $E•˜¶·ÙÄğ[843]; goto Aäá“÷‹›ñ; aáÜÉ‰Öé: } return $this->modelPlugin->setConfig($this->pluginName, $Aª“×‚š); } public function onSetConfig($C–ÇÈîµ±¾) { } public function onGetConfig($cµÏ³¯åÉ) { } public function onChangeStatus($aÅŸÂš¡êï) { } public function onUninstall() { } public function onInstall() { } public function authCheck($F™î¿ = "\x70\x6c\165\147\x69\156\101\x75\x74\150") { $eµÄñãÈ”ô =& $_SERVER[ªúæÂ¡­ä½]; if (!defined($eµÄñãÈ”ô[455])) { return !1; } if (_get($GLOBALS, $eµÄñãÈ”ô[486])) { return !0; } $D¸Àğªš’ö = $this->getConfig(); if (!$D¸Àğªš’ö[$F™î¿]) { return !1; } return ActionCall($eµÄñãÈ”ô[1477], $D¸Àğªš’ö[$F™î¿]); } public function url($a‚£¤¢Ò°, $b±Ã¦³¬™ø = '', $f¹½‚Âò÷ = true) { goto bä·Ã–µ÷; aæ ƒ®²ˆ: $FŠõÖ“ ¤ = $this->packageVersion(); $eƒĞŸ®õ‡´ = $CÜ¢Ô•ïå . $cô Çñ³ïå[441] . $FŠõÖ“ ¤; if (substr($a‚£¤¢Ò°, 0, 4) == $cô Çñ³ïå[147] || substr($a‚£¤¢Ò°, 0, 2) == $cô Çñ³ïå[1260]) { $b”åÖŠƒ…ˆ = $a‚£¤¢Ò° . $cô Çñ³ïå[1478] . $eƒĞŸ®õ‡´; } else { if ($b±Ã¦³¬™ø == $cô Çñ³ïå[33]) { $b”åÖŠƒ…ˆ = $this->pluginHost . $a‚£¤¢Ò° . $cô Çñ³ïå[1478] . $eƒĞŸ®õ‡´; } else { if ($b±Ã¦³¬™ø === $cô Çñ³ïå[77]) { $b”åÖŠƒ…ˆ = $this->pluginHost . $a‚£¤¢Ò°; } else { if ($b±Ã¦³¬™ø == $cô Çñ³ïå[1479]) { $b”åÖŠƒ…ˆ = STATIC_PATH . $a‚£¤¢Ò° . $cô Çñ³ïå[1478] . $CÜ¢Ô•ïå; } else { if ($b±Ã¦³¬™ø == $cô Çñ³ïå[1480]) { $b”åÖŠƒ…ˆ = APP_HOST . $cô Çñ³ïå[1481] . $a‚£¤¢Ò° . $cô Çñ³ïå[1478] . $CÜ¢Ô•ïå; } else { if (isset($A£ƒŠ…Š‹Á[$b±Ã¦³¬™ø])) { $b”åÖŠƒ…ˆ = $A£ƒŠ…Š‹Á[$b±Ã¦³¬™ø] . $a‚£¤¢Ò° . $cô Çñ³ïå[1478] . $eƒĞŸ®õ‡´; } } } } } } goto dóäÜòÒÆµ; dóäÜòÒÆµ: if (!$f¹½‚Âò÷) { return $b”åÖŠƒ…ˆ; } echo $b”åÖŠƒ…ˆ; goto A°ÃØÂÂ¬‘; bä·Ã–µ÷: $cô Çñ³ïå =& $_SERVER[ªúæÂ¡­ä½]; $A£ƒŠ…Š‹Á = $this->getConfig(); $CÜ¢Ô•ïå = KOD_VERSION . $cô Çñ³ïå[95] . KOD_VERSION_BUILD; goto aæ ƒ®²ˆ; A°ÃØÂÂ¬‘: } public function link($E§”ŠÆ¦ƒ¦ = false, $D‚ŸåŒ›œ… = '') { $dë†°ÆŠŠÃ =& $_SERVER[ªúæÂ¡­ä½]; if (!$E§”ŠÆ¦ƒ¦) { $this->link($dë†°ÆŠŠÃ[1482], $dë†°ÆŠŠÃ[1480]); $this->link($dë†°ÆŠŠÃ[1483], $dë†°ÆŠŠÃ[1479]); $this->link($dë†°ÆŠŠÃ[1484], $dë†°ÆŠŠÃ[1479]); $this->link($dë†°ÆŠŠÃ[1485], $dë†°ÆŠŠÃ[1479]); $this->link($dë†°ÆŠŠÃ[1486], $dë†°ÆŠŠÃ[1479]); return; } $fÂò«Ãà‘À = $this->url($E§”ŠÆ¦ƒ¦, $D‚ŸåŒ›œ…, !1); if (substr($E§”ŠÆ¦ƒ¦, -3) == $dë†°ÆŠŠÃ[1487]) { echo $dë†°ÆŠŠÃ[1488] . $fÂò«Ãà‘À . $dë†°ÆŠŠÃ[1489] . $dë†°ÆŠŠÃ[229]; } else { if (substr($E§”ŠÆ¦ƒ¦, -4) == $dë†°ÆŠŠÃ[1490]) { echo $dë†°ÆŠŠÃ[1491] . $fÂò«Ãà‘À . $dë†°ÆŠŠÃ[1492] . $dë†°ÆŠŠÃ[229]; } } } } class Route { public static $halts = false; public static $routes = array(); public static $methods = array(); public static $callbacks = array(); public static $maps = array(); public static $patterns = array("\72\141\x6e\171" => "\x5b\136\57\135\53", "\72\156\x75\155" => "\x5b\x30\55\71\x5d\x2b", "\x3a\141\154\154" => "\56\52"); public static $errorCallback; public static function __callstatic($dïøÉÁìã, $AÌ…íÈåÈƒ) { $cœÜôğù¡½ =& $_SERVER[ªúæÂ¡­ä½]; if ($dïøÉÁìã == $cœÜôğù¡½[1493]) { $c™ÌæÀ‹ë = array_map($cœÜôğù¡½[1494], $AÌ…íÈåÈƒ[0]); $B°½»È˜«¦ = strpos($AÌ…íÈåÈƒ[1], $cœÜôğù¡½[8]) === 0 ? $AÌ…íÈåÈƒ[1] : $cœÜôğù¡½[8] . $AÌ…íÈåÈƒ[1]; $A¥­ÀÄ—È = $AÌ…íÈåÈƒ[2]; } else { $c™ÌæÀ‹ë = null; $B°½»È˜«¦ = strpos($AÌ…íÈåÈƒ[0], $cœÜôğù¡½[8]) === 0 ? $AÌ…íÈåÈƒ[0] : $cœÜôğù¡½[8] . $AÌ…íÈåÈƒ[0]; $A¥­ÀÄ—È = $AÌ…íÈåÈƒ[1]; } array_push(self::$maps, $c™ÌæÀ‹ë); array_push(self::$routes, $B°½»È˜«¦); array_push(self::$methods, strtoupper($dïøÉÁìã)); array_push(self::$callbacks, $A¥­ÀÄ—È); } public static function error($f‚½–Íî–) { self::$errorCallback = $f‚½–Íî–; } public static function haltOnMatch($fŠĞŞå¶½é = true) { self::$halts = $fŠĞŞå¶½é; } public static function dispatch() { goto FÏ­Ê„±Æ; FÏ­Ê„±Æ: $eõÍ¢Å£ƒš =& $_SERVER[ªúæÂ¡­ä½]; $dÇ£ÄÇÀˆ = parse_url($_SERVER[$eõÍ¢Å£ƒš[1495]], PHP_URL_PATH); $A§Ñ¬èÕ• = $_SERVER[$eõÍ¢Å£ƒš[157]]; goto cÓ‡À­ï½Ğ; DäÜ’ŠÎ©®: self::$routes = preg_replace($eõÍ¢Å£ƒš[1179], $eõÍ¢Å£ƒš[8], self::$routes); if (in_array($dÇ£ÄÇÀˆ, self::$routes)) { $DºË‹£÷’Ü = array_keys(self::$routes, $dÇ£ÄÇÀˆ); foreach ($DºË‹£÷’Ü as $eÚ‘§ÆÄ¤) { if (self::$methods[$eÚ‘§ÆÄ¤] == $A§Ñ¬èÕ• || self::$methods[$eÚ‘§ÆÄ¤] == $eõÍ¢Å£ƒš[1496] || in_array($A§Ñ¬èÕ•, self::$maps[$eÚ‘§ÆÄ¤])) { $E‡ŠÓ„»îÃ = !0; if (!is_object(self::$callbacks[$eÚ‘§ÆÄ¤])) { $Fº®·îÔÀ’ = explode($eõÍ¢Å£ƒš[8], self::$callbacks[$eÚ‘§ÆÄ¤]); $D«ãâ—Í = end($Fº®·îÔÀ’); $Eóƒ¾Ú½¦ = explode($eõÍ¢Å£ƒš[1497], $D«ãâ—Í); $cĞÀª¬‰é = new $Eóƒ¾Ú½¦[0](); $cĞÀª¬‰é->{$Eóƒ¾Ú½¦[1]}(); if (self::$halts) { return; } } else { call_user_func(self::$callbacks[$eÚ‘§ÆÄ¤]); if (self::$halts) { return; } } } } } else { $FÄƒŒ¡—® = 0; foreach (self::$routes as $eÚ‘§ÆÄ¤) { if (strpos($eÚ‘§ÆÄ¤, $eõÍ¢Å£ƒš[4]) !== !1) { $eÚ‘§ÆÄ¤ = str_replace($F¼ÛŠ¤ø¼, $bÉØã†ø×©, $eÚ‘§ÆÄ¤); } if (preg_match($eõÍ¢Å£ƒš[1498] . $eÚ‘§ÆÄ¤ . $eõÍ¢Å£ƒš[1499], $dÇ£ÄÇÀˆ, $eÉ¨¼‘æ¼Ğ)) { if (self::$methods[$FÄƒŒ¡—®] == $A§Ñ¬èÕ• || self::$methods[$FÄƒŒ¡—®] == $eõÍ¢Å£ƒš[1496] || !empty(self::$maps[$FÄƒŒ¡—®]) && in_array($A§Ñ¬èÕ•, self::$maps[$FÄƒŒ¡—®])) { $E‡ŠÓ„»îÃ = !0; array_shift($eÉ¨¼‘æ¼Ğ); if (!is_object(self::$callbacks[$FÄƒŒ¡—®])) { $Fº®·îÔÀ’ = explode($eõÍ¢Å£ƒš[8], self::$callbacks[$FÄƒŒ¡—®]); $D«ãâ—Í = end($Fº®·îÔÀ’); $Eóƒ¾Ú½¦ = explode($eõÍ¢Å£ƒš[1497], $D«ãâ—Í); $cĞÀª¬‰é = new $Eóƒ¾Ú½¦[0](); if (!method_exists($cĞÀª¬‰é, $Eóƒ¾Ú½¦[1])) { echo $eõÍ¢Å£ƒš[1500]; } else { call_user_func_array(array($cĞÀª¬‰é, $Eóƒ¾Ú½¦[1]), $eÉ¨¼‘æ¼Ğ); } if (self::$halts) { return; } } else { call_user_func_array(self::$callbacks[$FÄƒŒ¡—®], $eÉ¨¼‘æ¼Ğ); if (self::$halts) { return; } } } } $FÄƒŒ¡—®++; } } if ($E‡ŠÓ„»îÃ == !1) { if (!self::$errorCallback) { self::$errorCallback = function () { $cÉ“¯‡ÊÆ =& $_SERVER[ªúæÂ¡­ä½]; header($_SERVER[$cÉ“¯‡ÊÆ[1501]] . $cÉ“¯‡ÊÆ[1502]); echo $cÉ“¯‡ÊÆ[1503]; }; } else { if (is_string(self::$errorCallback)) { self::get($_SERVER[$eõÍ¢Å£ƒš[1495]], self::$errorCallback); self::$errorCallback = null; self::dispatch(); return; } } call_user_func(self::$errorCallback); } goto CØÇ äÜ–Ô; cÓ‡À­ï½Ğ: $F¼ÛŠ¤ø¼ = array_keys(static::$patterns); $bÉØã†ø×© = array_values(static::$patterns); $E‡ŠÓ„»îÃ = !1; goto DäÜ’ŠÎ©®; CØÇ äÜ–Ô: } } goto d”¢ÛëÖ—; aÜãÍŸå½: class DbSqlite3 extends DbSqlite3Base { public function query($añàŒ·™) { $bÈîŠµ‰í =& $_SERVER[ªúæÂ¡­ä½]; if (!CacheLock::fileLock($bÈîŠµ‰í[9])) { return !1; } $D¯îôµÉ¶Ì = parent::query($añàŒ·™); CacheLock::fileUnLock($bÈîŠµ‰í[9]); return $D¯îôµÉ¶Ì; } public function execute($D”Û‡æ°£±) { $aò¸÷¤É‰ =& $_SERVER[ªúæÂ¡­ä½]; if (!CacheLock::fileLock($aò¸÷¤É‰[9])) { return !1; } $FºêÓÁæ æ = parent::execute($D”Û‡æ°£±); CacheLock::fileUnLock($aò¸÷¤É‰[9]); return $FºêÓÁæ æ; } } class Db { protected $dbType = null; protected $autoFree = false; protected $model = "\x5f\164\x68\x69\x6e\x6b\x5f"; protected $pconnect = false; protected $queryStr = ''; protected $modelSql = array(); protected $lastInsID = null; protected $numRows = 0; protected $numCols = 0; protected $transTimes = 0; protected $error = ''; protected $linkID = array(); protected $_linkID = null; protected $queryID = null; protected $connected = false; protected $config = ''; protected $configLast = ''; protected $exp = array("\145\161" => "\x3d", "\156\145\161" => "\74\76", "\147\x74" => "\76", "\145\147\x74" => "\76\x3d", "\x6c\164" => "\74", "\x65\154\x74" => "\74\75", "\x6e\x6f\164\x6c\x69\153\x65" => "\x4e\x4f\x54\x20\114\x49\x4b\x45", "\154\x69\153\x65" => "\x4c\111\113\x45", "\151\156" => "\111\x4e", "\156\157\164\x69\156" => "\116\x4f\x54\x20\x49\116", "\x6e\157\164\40\x69\x6e" => "\116\117\124\x20\111\x4e", "\x62\x65\164\x77\x65\x65\156" => "\x42\105\x54\x57\105\x45\116", "\156\x6f\x74\142\145\164\167\145\x65\x6e" => "\116\x4f\124\x20\x42\x45\124\x57\x45\105\116", "\x6e\x6f\164\40\x62\145\x74\x77\145\145\156" => "\116\x4f\x54\x20\102\105\124\127\105\105\x4e"); protected $selectSql = "\x53\105\114\105\x43\x54\45\104\x49\123\x54\x49\116\103\124\x25\x20\x25\106\111\105\114\x44\x25\40\106\122\x4f\x4d\x20\x25\124\x41\x42\114\105\x25\x25\112\117\x49\116\45\45\x57\110\x45\122\x45\x25\45\x47\122\x4f\125\x50\45\x25\x48\101\126\x49\116\107\45\45\x4f\122\x44\105\x52\x25\45\114\111\x4d\111\x54\45\40\45\x55\116\111\x4f\x4e\x25\45\x43\117\x4d\x4d\x45\x4e\x54\x25"; protected $bind = array(); public static function getInstance() { $BîØÑîñì¥ = func_get_args(); return think_get_instance_of(__CLASS__, $_SERVER[ªúæÂ¡­ä½][936], $BîØÑîñì¥); } public function factory($C¦ëš³²Šì = '') { goto Eªš÷‘²Á; CÁ™‹Òš©: return $D–œš†Ùãœ; goto CÇÜÏ¸¢ÆŸ; aáàøºÙ•ğ: $this->dbType = ucwords(strtolower($C¦ëš³²Šì[$f¸­Ì²÷áí[937]])); $Bááõ´Œº² = $f¸­Ì²÷áí[939] . $this->dbType; if (class_exists($Bááõ´Œº²)) { $D–œš†Ùãœ = new $Bááõ´Œº²($C¦ëš³²Šì); if ($f¸­Ì²÷áí[773] != strtolower($C¦ëš³²Šì[$f¸­Ì²÷áí[937]])) { $D–œš†Ùãœ->dbType = strtoupper($this->dbType); } else { $D–œš†Ùãœ->dbType = $this->_getDsnType($C¦ëš³²Šì[$f¸­Ì²÷áí[892]]); } } else { think_exception(think_lang($f¸­Ì²÷áí[940]) . $f¸­Ì²÷áí[941] . $Bááõ´Œº²); } goto CÁ™‹Òš©; Eªš÷‘²Á: $f¸­Ì²÷áí =& $_SERVER[ªúæÂ¡­ä½]; $C¦ëš³²Šì = $this->parseConfig($C¦ëš³²Šì); if (empty($C¦ëš³²Šì[$f¸­Ì²÷áí[937]])) { think_exception(think_lang($f¸­Ì²÷áí[938])); } goto aáàøºÙ•ğ; CÇÜÏ¸¢ÆŸ: } public function __call($bõã¦Ü„İ, $C¦çÂ­¿) { if (method_exists($this, $bõã¦Ü„İ)) { return call_user_func_array(array($this, $bõã¦Ü„İ), $C¦çÂ­¿); } } protected function _getDsnType($AŸ°ğçšÎÓ) { $BéÉŒŠ¿˜ = explode($_SERVER[ªúæÂ¡­ä½][4], $AŸ°ğçšÎÓ); $b—ø§•ó± = strtoupper(trim($BéÉŒŠ¿˜[0])); return $b—ø§•ó±; } private function parseConfig($AË†Ê˜ŒÙâ = '') { $dåîÆœå¦Ó =& $_SERVER[ªúæÂ¡­ä½]; if (!empty($AË†Ê˜ŒÙâ) && is_string($AË†Ê˜ŒÙâ)) { $AË†Ê˜ŒÙâ = $this->parseDSN($AË†Ê˜ŒÙâ); } elseif (is_array($AË†Ê˜ŒÙâ)) { $AË†Ê˜ŒÙâ = array_change_key_case($AË†Ê˜ŒÙâ); $AË†Ê˜ŒÙâ = array($dåîÆœå¦Ó[937] => $AË†Ê˜ŒÙâ[$dåîÆœå¦Ó[772]], $dåîÆœå¦Ó[865] => $AË†Ê˜ŒÙâ[$dåîÆœå¦Ó[942]], $dåîÆœå¦Ó[866] => $AË†Ê˜ŒÙâ[$dåîÆœå¦Ó[943]], $dåîÆœå¦Ó[863] => $AË†Ê˜ŒÙâ[$dåîÆœå¦Ó[944]], $dåîÆœå¦Ó[864] => $AË†Ê˜ŒÙâ[$dåîÆœå¦Ó[945]], $dåîÆœå¦Ó[17] => $AË†Ê˜ŒÙâ[$dåîÆœå¦Ó[946]], $dåîÆœå¦Ó[892] => $AË†Ê˜ŒÙâ[$dåîÆœå¦Ó[774]], $dåîÆœå¦Ó[13] => isset($AË†Ê˜ŒÙâ[$dåîÆœå¦Ó[947]]) ? $AË†Ê˜ŒÙâ[$dåîÆœå¦Ó[947]] : array()); } elseif (empty($AË†Ê˜ŒÙâ)) { if (think_config($dåîÆœå¦Ó[948]) && $dåîÆœå¦Ó[773] != strtolower(think_config($dåîÆœå¦Ó[949]))) { $AË†Ê˜ŒÙâ = $this->parseDSN(think_config($dåîÆœå¦Ó[948])); } else { $AË†Ê˜ŒÙâ = array($dåîÆœå¦Ó[937] => think_config($dåîÆœå¦Ó[949]), $dåîÆœå¦Ó[865] => think_config($dåîÆœå¦Ó[950]), $dåîÆœå¦Ó[866] => think_config($dåîÆœå¦Ó[951]), $dåîÆœå¦Ó[863] => think_config($dåîÆœå¦Ó[952]), $dåîÆœå¦Ó[864] => think_config($dåîÆœå¦Ó[953]), $dåîÆœå¦Ó[17] => think_config($dåîÆœå¦Ó[244]), $dåîÆœå¦Ó[892] => think_config($dåîÆœå¦Ó[948]), $dåîÆœå¦Ó[13] => think_config($dåîÆœå¦Ó[954])); } } return $AË†Ê˜ŒÙâ; } protected function initConnect($C‡Ã§‹Úƒ = true) { if (1 == think_config($_SERVER[ªúæÂ¡­ä½][18])) { $this->_linkID = $this->multiConnect($C‡Ã§‹Úƒ); } else { if ($this->config) { $this->configLast = $this->config; } } if (!$this->connected) { $this->_linkID = $this->connect(); } } protected function closeConnect() { if (!$this->connected) { return; } foreach ($this->linkID as $C¿½êÅëœ« => $EÊÖç¿—‹´) { $this->_linkID = $EÊÖç¿—‹´; $this->close(); } $this->linkID = array(); $this->_linkID = null; $this->connected = !1; if (!$this->config && $this->configLast) { $this->config = $this->configLast; } } protected function multiConnect($Dëš´âŸ‰¾ = false) { goto Cèéã¢’ˆ; c®³» ª¥: if (empty($F–ù“¸¾Û÷)) { foreach ($this->config as $E²ÈÕğô½¶ => $B‚™÷„§¦‰) { $F–ù“¸¾Û÷[$E²ÈÕğô½¶] = explode($B¥œƒØ¨„Î[47], $B‚™÷„§¦‰); } } if (think_config($B¥œƒØ¨„Î[955])) { if ($Dëš´âŸ‰¾ || think_config($B¥œƒØ¨„Î[390]) === !0) { $bÂé‰§×ÔÑ = floor(mt_rand(0, think_config($B¥œƒØ¨„Î[956]) - 1)); $AÏÅ…É­˜À = $bÂé‰§×ÔÑ; } else { if (is_numeric(think_config($B¥œƒØ¨„Î[957]))) { $bÂé‰§×ÔÑ = think_config($B¥œƒØ¨„Î[957]); } else { $bÂé‰§×ÔÑ = floor(mt_rand(think_config($B¥œƒØ¨„Î[956]), count($F–ù“¸¾Û÷[$B¥œƒØ¨„Î[863]]) - 1)); } } } else { $bÂé‰§×ÔÑ = floor(mt_rand(0, count($F–ù“¸¾Û÷[$B¥œƒØ¨„Î[863]]) - 1)); $AÏÅ…É­˜À = $bÂé‰§×ÔÑ; } $bÂé‰§×ÔÑ = $AÏÅ…É­˜À !== -1 ? $AÏÅ…É­˜À : $bÂé‰§×ÔÑ; goto B”ÇåŸä—Ù; B”ÇåŸä—Ù: $D¾İ‰ã÷ì = array($B¥œƒØ¨„Î[865] => isset($F–ù“¸¾Û÷[$B¥œƒØ¨„Î[865]][$bÂé‰§×ÔÑ]) ? $F–ù“¸¾Û÷[$B¥œƒØ¨„Î[865]][$bÂé‰§×ÔÑ] : $F–ù“¸¾Û÷[$B¥œƒØ¨„Î[865]][0], $B¥œƒØ¨„Î[866] => isset($F–ù“¸¾Û÷[$B¥œƒØ¨„Î[866]][$bÂé‰§×ÔÑ]) ? $F–ù“¸¾Û÷[$B¥œƒØ¨„Î[866]][$bÂé‰§×ÔÑ] : $F–ù“¸¾Û÷[$B¥œƒØ¨„Î[866]][0], $B¥œƒØ¨„Î[863] => isset($F–ù“¸¾Û÷[$B¥œƒØ¨„Î[863]][$bÂé‰§×ÔÑ]) ? $F–ù“¸¾Û÷[$B¥œƒØ¨„Î[863]][$bÂé‰§×ÔÑ] : $F–ù“¸¾Û÷[$B¥œƒØ¨„Î[863]][0], $B¥œƒØ¨„Î[864] => isset($F–ù“¸¾Û÷[$B¥œƒØ¨„Î[864]][$bÂé‰§×ÔÑ]) ? $F–ù“¸¾Û÷[$B¥œƒØ¨„Î[864]][$bÂé‰§×ÔÑ] : $F–ù“¸¾Û÷[$B¥œƒØ¨„Î[864]][0], $B¥œƒØ¨„Î[17] => isset($F–ù“¸¾Û÷[$B¥œƒØ¨„Î[17]][$bÂé‰§×ÔÑ]) ? $F–ù“¸¾Û÷[$B¥œƒØ¨„Î[17]][$bÂé‰§×ÔÑ] : $F–ù“¸¾Û÷[$B¥œƒØ¨„Î[17]][0], $B¥œƒØ¨„Î[892] => isset($F–ù“¸¾Û÷[$B¥œƒØ¨„Î[892]][$bÂé‰§×ÔÑ]) ? $F–ù“¸¾Û÷[$B¥œƒØ¨„Î[892]][$bÂé‰§×ÔÑ] : $F–ù“¸¾Û÷[$B¥œƒØ¨„Î[892]][0], $B¥œƒØ¨„Î[13] => isset($F–ù“¸¾Û÷[$B¥œƒØ¨„Î[13]][$bÂé‰§×ÔÑ]) ? $F–ù“¸¾Û÷[$B¥œƒØ¨„Î[13]][$bÂé‰§×ÔÑ] : $F–ù“¸¾Û÷[$B¥œƒØ¨„Î[13]][0]); return $this->connect($D¾İ‰ã÷ì, $bÂé‰§×ÔÑ); goto EŒ¤ÒÔ¬«æ; Cèéã¢’ˆ: $B¥œƒØ¨„Î =& $_SERVER[ªúæÂ¡­ä½]; static $F–ù“¸¾Û÷ = array(); static $AÏÅ…É­˜À = -1; goto c®³» ª¥; EŒ¤ÒÔ¬«æ: } public function parseDSN($B¥ÓŠ×åî) { $D”¬‚¤£Å =& $_SERVER[ªúæÂ¡­ä½]; if (empty($B¥ÓŠ×åî)) { return !1; } $cÙ†Ğ³±÷ = parse_url($B¥ÓŠ×åî); if ($cÙ†Ğ³±÷[$D”¬‚¤£Å[174]]) { $A’ğ‰©Â†“ = array($D”¬‚¤£Å[937] => $cÙ†Ğ³±÷[$D”¬‚¤£Å[174]], $D”¬‚¤£Å[865] => isset($cÙ†Ğ³±÷[$D”¬‚¤£Å[576]]) ? $cÙ†Ğ³±÷[$D”¬‚¤£Å[576]] : $D”¬‚¤£Å[33], $D”¬‚¤£Å[866] => isset($cÙ†Ğ³±÷[$D”¬‚¤£Å[958]]) ? $cÙ†Ğ³±÷[$D”¬‚¤£Å[958]] : $D”¬‚¤£Å[33], $D”¬‚¤£Å[863] => isset($cÙ†Ğ³±÷[$D”¬‚¤£Å[175]]) ? $cÙ†Ğ³±÷[$D”¬‚¤£Å[175]] : $D”¬‚¤£Å[33], $D”¬‚¤£Å[864] => isset($cÙ†Ğ³±÷[$D”¬‚¤£Å[176]]) ? $cÙ†Ğ³±÷[$D”¬‚¤£Å[176]] : $D”¬‚¤£Å[33], $D”¬‚¤£Å[17] => isset($cÙ†Ğ³±÷[$D”¬‚¤£Å[76]]) ? substr($cÙ†Ğ³±÷[$D”¬‚¤£Å[76]], 1) : $D”¬‚¤£Å[33]); } else { preg_match($D”¬‚¤£Å[959], trim($B¥ÓŠ×åî), $AÂ§«‹®‹Œ); $A’ğ‰©Â†“ = array($D”¬‚¤£Å[937] => $AÂ§«‹®‹Œ[1], $D”¬‚¤£Å[865] => $AÂ§«‹®‹Œ[2], $D”¬‚¤£Å[866] => $AÂ§«‹®‹Œ[3], $D”¬‚¤£Å[863] => $AÂ§«‹®‹Œ[4], $D”¬‚¤£Å[864] => $AÂ§«‹®‹Œ[5], $D”¬‚¤£Å[17] => $AÂ§«‹®‹Œ[6]); } $A’ğ‰©Â†“[$D”¬‚¤£Å[892]] = $D”¬‚¤£Å[33]; return $A’ğ‰©Â†“; } protected function debug() { $F‹ğ¸œĞà =& $_SERVER[ªúæÂ¡­ä½]; $this->modelSql[$this->model] = $this->queryStr; $this->model = $F‹ğ¸œĞà[960]; if (think_config($F‹ğ¸œĞà[961])) { think_status($F‹ğ¸œĞà[962]); think_trace($this->queryStr . $F‹ğ¸œĞà[963] . think_status($F‹ğ¸œĞà[20], $F‹ğ¸œĞà[962], 6) . $F‹ğ¸œĞà[964], $F‹ğ¸œĞà[33], $F‹ğ¸œĞà[965]); } } protected function parseLock($BÑå¹‰ÂÕ = false) { $dÈë¾Ï¾‚Ö =& $_SERVER[ªúæÂ¡­ä½]; if (!$BÑå¹‰ÂÕ) { return $dÈë¾Ï¾‚Ö[33]; } if ($dÈë¾Ï¾‚Ö[894] == $this->dbType) { return $dÈë¾Ï¾‚Ö[966]; } return $dÈë¾Ï¾‚Ö[967]; } protected function parseSet($fÇÒ£ë©êí) { $b‘”ïñõÁ =& $_SERVER[ªúæÂ¡­ä½]; foreach ($fÇÒ£ë©êí as $e…çÌÍÙË™ => $Dƒ °‰«´Ş) { if (is_array($Dƒ °‰«´Ş) && $b‘”ïñõÁ[295] == $Dƒ °‰«´Ş[0]) { $Aàù·Ä¼Ì[] = $this->parseKey($e…çÌÍÙË™) . $b‘”ïñõÁ[968] . $Dƒ °‰«´Ş[1]; } elseif (is_scalar($Dƒ °‰«´Ş) || is_null($Dƒ °‰«´Ş)) { $Aàù·Ä¼Ì[] = $this->parseKey($e…çÌÍÙË™) . $b‘”ïñõÁ[968] . $this->parseValue($Dƒ °‰«´Ş); } } return $b‘”ïñõÁ[969] . implode($b‘”ïñõÁ[47], $Aàù·Ä¼Ì); } protected function bindParam($A³óö‹Ïô«, $cÏâÁïë„) { $this->bind[$_SERVER[ªúæÂ¡­ä½][4] . $A³óö‹Ïô«] = $cÏâÁïë„; } protected function parseBind($BñÛÆõÀîª) { $BñÛÆõÀîª = array_merge($this->bind, $BñÛÆõÀîª); $this->bind = array(); return $BñÛÆõÀîª; } function parseKey(&$E®•ª¿¿¬‹, $Dˆ‹ëÎ«Ñ´ = true) { if ($Dˆ‹ëÎ«Ñ´) { $E®•ª¿¿¬‹ = $this->parseKeyCheck($E®•ª¿¿¬‹); } return $E®•ª¿¿¬‹; } function parseKeyCheck($C™†ù¤±Õ) { $e»¥Ç¯±©ø =& $_SERVER[ªúæÂ¡­ä½]; $C™†ù¤±Õ = trim($C™†ù¤±Õ); if (!preg_match($e»¥Ç¯±©ø[970], $C™†ù¤±Õ)) { think_exception($e»¥Ç¯±©ø[971] . $C™†ù¤±Õ); } return $C™†ù¤±Õ; } protected function parseValue($e’óéƒØ¤) { $FİŸ‡æÆô— =& $_SERVER[ªúæÂ¡­ä½]; if (is_string($e’óéƒØ¤)) { $e’óéƒØ¤ = $FİŸ‡æÆô—[933] . $this->escapeString($e’óéƒØ¤) . $FİŸ‡æÆô—[933]; } elseif (isset($e’óéƒØ¤[0]) && is_string($e’óéƒØ¤[0]) && strtolower($e’óéƒØ¤[0]) == $FİŸ‡æÆô—[295]) { $e’óéƒØ¤ = $this->escapeString($e’óéƒØ¤[1]); } elseif (is_array($e’óéƒØ¤)) { $e’óéƒØ¤ = array_map(array($this, $FİŸ‡æÆô—[934]), $e’óéƒØ¤); } elseif (is_bool($e’óéƒØ¤)) { $e’óéƒØ¤ = $e’óéƒØ¤ ? $FİŸ‡æÆô—[87] : $FİŸ‡æÆô—[191]; } elseif (is_null($e’óéƒØ¤)) { $e’óéƒØ¤ = $FİŸ‡æÆô—[103]; } return $e’óéƒØ¤; } protected function parseField($C¯±øÙî„) { $EÃ°§ÕÁ¬  =& $_SERVER[ªúæÂ¡­ä½]; if (is_string($C¯±øÙî„) && strpos($C¯±øÙî„, $EÃ°§ÕÁ¬ [47])) { $C¯±øÙî„ = explode($EÃ°§ÕÁ¬ [47], $C¯±øÙî„); } if (is_array($C¯±øÙî„)) { $Dœ½À ´ç = array(); foreach ($C¯±øÙî„ as $A³¿´ÇÓŠÒ => $c™ùŠ’¯) { if (!is_numeric($A³¿´ÇÓŠÒ)) { $Dœ½À ´ç[] = $this->parseKey($A³¿´ÇÓŠÒ, !1) . $EÃ°§ÕÁ¬ [972] . $this->parseKey($c™ùŠ’¯); } else { $Dœ½À ´ç[] = $this->parseKey($c™ùŠ’¯); } } $EÈÄ¼Ùªï‹ = implode($EÃ°§ÕÁ¬ [47], $Dœ½À ´ç); } elseif (is_string($C¯±øÙî„) && !empty($C¯±øÙî„)) { $EÈÄ¼Ùªï‹ = $C¯±øÙî„; } else { $EÈÄ¼Ùªï‹ = $EÃ°§ÕÁ¬ [182]; } return $EÈÄ¼Ùªï‹; } protected function parseTable($Cæ¶œ‹ÚÄ‰) { $cĞùØ‡š‘ =& $_SERVER[ªúæÂ¡­ä½]; if (is_array($Cæ¶œ‹ÚÄ‰)) { $Fé‘ªÆ÷ = array(); foreach ($Cæ¶œ‹ÚÄ‰ as $EÉ‹Î•ò¤ù => $bô™‡¡×ï‘) { if (!is_numeric($EÉ‹Î•ò¤ù)) { $Fé‘ªÆ÷[] = $this->parseKey($EÉ‹Î•ò¤ù) . $cĞùØ‡š‘[50] . $this->parseKey($bô™‡¡×ï‘); } else { $Fé‘ªÆ÷[] = $this->parseKey($EÉ‹Î•ò¤ù); } } $Cæ¶œ‹ÚÄ‰ = $Fé‘ªÆ÷; } elseif (is_string($Cæ¶œ‹ÚÄ‰)) { if (strstr($Cæ¶œ‹ÚÄ‰, $cĞùØ‡š‘[50])) { return $Cæ¶œ‹ÚÄ‰; } $Cæ¶œ‹ÚÄ‰ = explode($cĞùØ‡š‘[47], $Cæ¶œ‹ÚÄ‰); array_walk($Cæ¶œ‹ÚÄ‰, array($this, $cĞùØ‡š‘[883])); } return $cĞùØ‡š‘[877] . trim(implode($cĞùØ‡š‘[973], $Cæ¶œ‹ÚÄ‰), $cĞùØ‡š‘[382]) . $cĞùØ‡š‘[877]; } protected function parseWhere($A‡¨çé·ç‚) { $e„“öîÉĞŠ =& $_SERVER[ªúæÂ¡­ä½]; $dã£Ë˜æ¸¤ = $e„“öîÉĞŠ[33]; if (is_string($A‡¨çé·ç‚)) { $dã£Ë˜æ¸¤ = $A‡¨çé·ç‚; } else { $EÇËÍµöé° = isset($A‡¨çé·ç‚[$e„“öîÉĞŠ[974]]) ? strtoupper($A‡¨çé·ç‚[$e„“öîÉĞŠ[974]]) : $e„“öîÉĞŠ[33]; if (in_array($EÇËÍµöé°, array($e„“öîÉĞŠ[975], $e„“öîÉĞŠ[976], $e„“öîÉĞŠ[977]))) { $EÇËÍµöé° = $e„“öîÉĞŠ[50] . $EÇËÍµöé° . $e„“öîÉĞŠ[50]; unset($A‡¨çé·ç‚[$e„“öîÉĞŠ[974]]); } else { $EÇËÍµöé° = $e„“öîÉĞŠ[978]; } foreach ($A‡¨çé·ç‚ as $Eãù±¦²Åï => $F¯Ó«ŞğÓ§) { $dã£Ë˜æ¸¤ .= $e„“öîÉĞŠ[275]; if (is_numeric($Eãù±¦²Åï)) { $Eãù±¦²Åï = $e„“öîÉĞŠ[979]; } if (0 === strpos($Eãù±¦²Åï, $e„“öîÉĞŠ[71])) { $dã£Ë˜æ¸¤ .= $this->parseThinkWhere($Eãù±¦²Åï, $F¯Ó«ŞğÓ§); } else { if (!preg_match($e„“öîÉĞŠ[980], trim($Eãù±¦²Åï))) { think_exception(think_lang($e„“öîÉĞŠ[981]) . $e„“öîÉĞŠ[4] . $Eãù±¦²Åï); } $fÆÁ¢ÛÂœ™ = is_array($F¯Ó«ŞğÓ§) && isset($F¯Ó«ŞğÓ§[$e„“öîÉĞŠ[982]]); $Eãù±¦²Åï = trim($Eãù±¦²Åï); if (strpos($Eãù±¦²Åï, $e„“öîÉĞŠ[281])) { $A”½³îòæ” = explode($e„“öîÉĞŠ[281], $Eãù±¦²Åï); $e™ØÁÙëö = array(); foreach ($A”½³îòæ” as $bÚ¼ÓÕ–¥¿ => $f—‰£®Á¡) { $dâêÊ•¶ŞÄ = $fÆÁ¢ÛÂœ™ ? $F¯Ó«ŞğÓ§[$bÚ¼ÓÕ–¥¿] : $F¯Ó«ŞğÓ§; $e™ØÁÙëö[] = $e„“öîÉĞŠ[258] . $this->parseWhereItem($this->parseKey($f—‰£®Á¡), $dâêÊ•¶ŞÄ) . $e„“öîÉĞŠ[882]; } $dã£Ë˜æ¸¤ .= implode($e„“öîÉĞŠ[983], $e™ØÁÙëö); } elseif (strpos($Eãù±¦²Åï, $e„“öîÉĞŠ[282])) { $A”½³îòæ” = explode($e„“öîÉĞŠ[282], $Eãù±¦²Åï); $e™ØÁÙëö = array(); foreach ($A”½³îòæ” as $bÚ¼ÓÕ–¥¿ => $f—‰£®Á¡) { $dâêÊ•¶ŞÄ = $fÆÁ¢ÛÂœ™ ? $F¯Ó«ŞğÓ§[$bÚ¼ÓÕ–¥¿] : $F¯Ó«ŞğÓ§; $e™ØÁÙëö[] = $e„“öîÉĞŠ[258] . $this->parseWhereItem($this->parseKey($f—‰£®Á¡), $dâêÊ•¶ŞÄ) . $e„“öîÉĞŠ[882]; } $dã£Ë˜æ¸¤ .= implode($e„“öîÉĞŠ[978], $e™ØÁÙëö); } else { $dã£Ë˜æ¸¤ .= $this->parseWhereItem($this->parseKey($Eãù±¦²Åï), $F¯Ó«ŞğÓ§); } } $dã£Ë˜æ¸¤ .= $e„“öîÉĞŠ[276] . $EÇËÍµöé°; } $dã£Ë˜æ¸¤ = substr($dã£Ë˜æ¸¤, 0, -strlen($EÇËÍµöé°)); } return empty($dã£Ë˜æ¸¤) ? $e„“öîÉĞŠ[33] : $e„“öîÉĞŠ[984] . $dã£Ë˜æ¸¤; } protected function parseWhereItem($cÄŒÑöÏåŞ, $DÍèç´—Œõ) { $C¶¶ºĞÒäë =& $_SERVER[ªúæÂ¡­ä½]; $cù›ãŞĞ×í = $C¶¶ºĞÒäë[33]; if (is_array($DÍèç´—Œõ)) { if (is_string($DÍèç´—Œõ[0])) { $eè°¦‡°¬ = strtolower($DÍèç´—Œõ[0]); if (in_array($DÍèç´—Œõ[0], array($C¶¶ºĞÒäë[968], $C¶¶ºĞÒäë[985], $C¶¶ºĞÒäë[986], $C¶¶ºĞÒäë[987], $C¶¶ºĞÒäë[988], $C¶¶ºĞÒäë[989]))) { $cù›ãŞĞ×í .= $cÄŒÑöÏåŞ . $C¶¶ºĞÒäë[50] . $DÍèç´—Œõ[0] . $C¶¶ºĞÒäë[50] . $this->parseValue($DÍèç´—Œõ[1]); } elseif (preg_match($C¶¶ºĞÒäë[990], $DÍèç´—Œõ[0])) { $cù›ãŞĞ×í .= $cÄŒÑöÏåŞ . $C¶¶ºĞÒäë[50] . $this->exp[$eè°¦‡°¬] . $C¶¶ºĞÒäë[50] . $this->parseValue($DÍèç´—Œõ[1]); } elseif (preg_match($C¶¶ºĞÒäë[991], $DÍèç´—Œõ[0])) { if (is_array($DÍèç´—Œõ[1])) { $aÎŠ„ø«ì‡ = isset($DÍèç´—Œõ[2]) ? strtoupper($DÍèç´—Œõ[2]) : $C¶¶ºĞÒäë[976]; if (in_array($aÎŠ„ø«ì‡, array($C¶¶ºĞÒäë[975], $C¶¶ºĞÒäë[976], $C¶¶ºĞÒäë[977]))) { $F½õÍŒ¬Ø = array(); foreach ($DÍèç´—Œõ[1] as $eê‹ÕÁ‡) { $F½õÍŒ¬Ø[] = $cÄŒÑöÏåŞ . $C¶¶ºĞÒäë[50] . $this->exp[$eè°¦‡°¬] . $C¶¶ºĞÒäë[50] . $this->parseValue($eê‹ÕÁ‡); } $cù›ãŞĞ×í .= $C¶¶ºĞÒäë[258] . implode($C¶¶ºĞÒäë[50] . $aÎŠ„ø«ì‡ . $C¶¶ºĞÒäë[50], $F½õÍŒ¬Ø) . $C¶¶ºĞÒäë[882]; } } else { $cù›ãŞĞ×í .= $cÄŒÑöÏåŞ . $C¶¶ºĞÒäë[50] . $this->exp[$eè°¦‡°¬] . $C¶¶ºĞÒäë[50] . $this->parseValue($DÍèç´—Œõ[1]); } } elseif ($C¶¶ºĞÒäë[295] == $eè°¦‡°¬) { $cù›ãŞĞ×í .= $C¶¶ºĞÒäë[880] . $cÄŒÑöÏåŞ . $C¶¶ºĞÒäë[50] . $DÍèç´—Œõ[1] . $C¶¶ºĞÒäë[992]; } elseif (preg_match($C¶¶ºĞÒäë[993], $DÍèç´—Œõ[0])) { $cù›ãŞĞ×í .= $DÍèç´—Œõ[0]; } elseif (preg_match($C¶¶ºĞÒäë[994], $DÍèç´—Œõ[0])) { if (isset($DÍèç´—Œõ[2]) && $C¶¶ºĞÒäë[295] == $DÍèç´—Œõ[2]) { $cù›ãŞĞ×í .= $cÄŒÑöÏåŞ . $C¶¶ºĞÒäë[50] . $this->exp[$eè°¦‡°¬] . $C¶¶ºĞÒäë[50] . $DÍèç´—Œõ[1]; } else { if (is_string($DÍèç´—Œõ[1])) { $DÍèç´—Œõ[1] = explode($C¶¶ºĞÒäë[47], $DÍèç´—Œõ[1]); } $F£…‘ÁÅä = implode($C¶¶ºĞÒäë[47], $this->parseValue($DÍèç´—Œõ[1])); $cù›ãŞĞ×í .= $cÄŒÑöÏåŞ . $C¶¶ºĞÒäë[50] . $this->exp[$eè°¦‡°¬] . $C¶¶ºĞÒäë[880] . $F£…‘ÁÅä . $C¶¶ºĞÒäë[882]; } } elseif (preg_match($C¶¶ºĞÒäë[995], $DÍèç´—Œõ[0])) { $aÓ«ŒÚ•‡Ê = is_string($DÍèç´—Œõ[1]) ? explode($C¶¶ºĞÒäë[47], $DÍèç´—Œõ[1]) : $DÍèç´—Œõ[1]; $cù›ãŞĞ×í .= $C¶¶ºĞÒäë[880] . $cÄŒÑöÏåŞ . $C¶¶ºĞÒäë[50] . $this->exp[$eè°¦‡°¬] . $C¶¶ºĞÒäë[50] . $this->parseValue($aÓ«ŒÚ•‡Ê[0]) . $C¶¶ºĞÒäë[978] . $this->parseValue($aÓ«ŒÚ•‡Ê[1]) . $C¶¶ºĞÒäë[276]; } else { think_exception(think_lang($C¶¶ºĞÒäë[981]) . $C¶¶ºĞÒäë[4] . $DÍèç´—Œõ[0]); } } else { $E¾‡ Ã–®ë = count($DÍèç´—Œõ); $BùÅÛÀŒŸ‡ = $C¶¶ºĞÒäë[33]; if (is_string($DÍèç´—Œõ[$E¾‡ Ã–®ë - 1])) { $BùÅÛÀŒŸ‡ = isset($DÍèç´—Œõ[$E¾‡ Ã–®ë - 1]) ? strtoupper($DÍèç´—Œõ[$E¾‡ Ã–®ë - 1]) : $C¶¶ºĞÒäë[33]; if (in_array($BùÅÛÀŒŸ‡, array($C¶¶ºĞÒäë[975], $C¶¶ºĞÒäë[976], $C¶¶ºĞÒäë[977]))) { $E¾‡ Ã–®ë = $E¾‡ Ã–®ë - 1; } } else { $BùÅÛÀŒŸ‡ = $C¶¶ºĞÒäë[975]; } for ($a¥í¯¸¨°Ç = 0; $a¥í¯¸¨°Ç < $E¾‡ Ã–®ë; $a¥í¯¸¨°Ç++) { $aÓ«ŒÚ•‡Ê = is_array($DÍèç´—Œõ[$a¥í¯¸¨°Ç]) ? $DÍèç´—Œõ[$a¥í¯¸¨°Ç][1] : $DÍèç´—Œõ[$a¥í¯¸¨°Ç]; if ($C¶¶ºĞÒäë[295] == strtolower($DÍèç´—Œõ[$a¥í¯¸¨°Ç][0])) { $cù›ãŞĞ×í .= $C¶¶ºĞÒäë[258] . $cÄŒÑöÏåŞ . $C¶¶ºĞÒäë[50] . $aÓ«ŒÚ•‡Ê . $C¶¶ºĞÒäë[992] . $BùÅÛÀŒŸ‡ . $C¶¶ºĞÒäë[50]; } else { $CçŒİ­Ê¥¦ = is_array($DÍèç´—Œõ[$a¥í¯¸¨°Ç]) ? $this->exp[strtolower($DÍèç´—Œõ[$a¥í¯¸¨°Ç][0])] : $C¶¶ºĞÒäë[968]; if (!$CçŒİ­Ê¥¦ && is_array($DÍèç´—Œõ[$a¥í¯¸¨°Ç]) && in_array($DÍèç´—Œõ[$a¥í¯¸¨°Ç][0], array($C¶¶ºĞÒäë[968], $C¶¶ºĞÒäë[985], $C¶¶ºĞÒäë[986], $C¶¶ºĞÒäë[987], $C¶¶ºĞÒäë[988], $C¶¶ºĞÒäë[989]))) { $CçŒİ­Ê¥¦ = $DÍèç´—Œõ[$a¥í¯¸¨°Ç][0]; } $cù›ãŞĞ×í .= $C¶¶ºĞÒäë[258] . $cÄŒÑöÏåŞ . $C¶¶ºĞÒäë[50] . $CçŒİ­Ê¥¦ . $C¶¶ºĞÒäë[50] . $this->parseValue($aÓ«ŒÚ•‡Ê) . $C¶¶ºĞÒäë[992] . $BùÅÛÀŒŸ‡ . $C¶¶ºĞÒäë[50]; } } $cù›ãŞĞ×í = substr($cù›ãŞĞ×í, 0, -4); } } else { $cù›ãŞĞ×í .= $cÄŒÑöÏåŞ . $C¶¶ºĞÒäë[996] . $this->parseValue($DÍèç´—Œõ); } return $cù›ãŞĞ×í; } protected function parseThinkWhere($eœ˜Ç¾™ãŞ, $f£ôêÕã®) { $f¨£É¾ê¡’ =& $_SERVER[ªúæÂ¡­ä½]; $BÑÕŠ½†ÔÙ = $f¨£É¾ê¡’[33]; switch ($eœ˜Ç¾™ãŞ) { case $f¨£É¾ê¡’[350]: $BÑÕŠ½†ÔÙ = $f£ôêÕã®; break; case $f¨£É¾ê¡’[979]: $BÑÕŠ½†ÔÙ = is_string($f£ôêÕã®) ? $f£ôêÕã® : substr($this->parseWhere($f£ôêÕã®), 6); break; case $f¨£É¾ê¡’[997]: parse_str($f£ôêÕã®, $E•Ÿ¾íÑ®”); if (isset($E•Ÿ¾íÑ®”[$f¨£É¾ê¡’[974]])) { $eøÈ”ğšÕ„ = $f¨£É¾ê¡’[50] . strtoupper($E•Ÿ¾íÑ®”[$f¨£É¾ê¡’[974]]) . $f¨£É¾ê¡’[50]; unset($E•Ÿ¾íÑ®”[$f¨£É¾ê¡’[974]]); } else { $eøÈ”ğšÕ„ = $f¨£É¾ê¡’[978]; } $fİ—Ö™»£Õ = array(); foreach ($E•Ÿ¾íÑ®” as $b Ãø“†âù => $c­ƒÒ±÷ìÓ) { $fİ—Ö™»£Õ[] = $this->parseKey($b Ãø“†âù) . $f¨£É¾ê¡’[996] . $this->parseValue($c­ƒÒ±÷ìÓ); } $BÑÕŠ½†ÔÙ = implode($eøÈ”ğšÕ„, $fİ—Ö™»£Õ); break; } return $BÑÕŠ½†ÔÙ; } protected function parseLimit($fµ…Œçù Š) { $aºÃ‰Æ˜ùÏ =& $_SERVER[ªúæÂ¡­ä½]; return !empty($fµ…Œçù Š) ? $aºÃ‰Æ˜ùÏ[48] . $fµ…Œçù Š . $aºÃ‰Æ˜ùÏ[50] : $aºÃ‰Æ˜ùÏ[33]; } protected function parseJoin($cË¹¤³Ş¡›) { $fùáÑÀ¡¡ =& $_SERVER[ªúæÂ¡­ä½]; $fÓ÷‡èòÌ¼ = $fùáÑÀ¡¡[33]; if (!empty($cË¹¤³Ş¡›)) { if (is_array($cË¹¤³Ş¡›)) { foreach ($cË¹¤³Ş¡› as $c¦º¶ÛçšØ => $a®Çğè”ç) { if (!1 !== stripos($a®Çğè”ç, $fùáÑÀ¡¡[998])) { $fÓ÷‡èòÌ¼ .= $fùáÑÀ¡¡[50] . $a®Çğè”ç; } else { $fÓ÷‡èòÌ¼ .= $fùáÑÀ¡¡[999] . $a®Çğè”ç; } } } else { $fÓ÷‡èòÌ¼ .= $fùáÑÀ¡¡[999] . $cË¹¤³Ş¡›; } } $fÓ÷‡èòÌ¼ = preg_replace($fùáÑÀ¡¡[1000], think_config($fùáÑÀ¡¡[906]) . $fùáÑÀ¡¡[1001], $fÓ÷‡èòÌ¼); return $fÓ÷‡èòÌ¼; } protected function parseOrder($Fì¦ø˜ÏªÀ) { $eªõÊ†ò =& $_SERVER[ªúæÂ¡­ä½]; if (is_array($Fì¦ø˜ÏªÀ)) { $B•³á¨³Îî = array(); foreach ($Fì¦ø˜ÏªÀ as $e­£Ÿ ô›“ => $f»©ã¹¡ÚÀ) { if (is_numeric($e­£Ÿ ô›“)) { $B•³á¨³Îî[] = $this->parseKey($f»©ã¹¡ÚÀ); } else { $f»©ã¹¡ÚÀ = in_array(strtoupper(trim($f»©ã¹¡ÚÀ)), array($eªõÊ†ò[1002], $eªõÊ†ò[1003])) ? $eªõÊ†ò[50] . $f»©ã¹¡ÚÀ : $eªõÊ†ò[33]; if (preg_match($eªõÊ†ò[1004], $e­£Ÿ ô›“)) { $B•³á¨³Îî[] = $this->parseKey($e­£Ÿ ô›“) . $f»©ã¹¡ÚÀ; } else { think_exception($eªõÊ†ò[1005] . $e­£Ÿ ô›“); } } } $Fì¦ø˜ÏªÀ = implode($eªõÊ†ò[47], $B•³á¨³Îî); } return !empty($Fì¦ø˜ÏªÀ) ? $eªõÊ†ò[1006] . $Fì¦ø˜ÏªÀ : $eªõÊ†ò[33]; } protected function parseGroup($eÜùÍŒ‡¸) { $FõğÅÛéçÚ =& $_SERVER[ªúæÂ¡­ä½]; return !empty($eÜùÍŒ‡¸) ? $FõğÅÛéçÚ[1007] . $eÜùÍŒ‡¸ : $FõğÅÛéçÚ[33]; } protected function parseHaving($fÁƒ·¢×ŞĞ) { $aŞ‹âÑ©ù =& $_SERVER[ªúæÂ¡­ä½]; return !empty($fÁƒ·¢×ŞĞ) ? $aŞ‹âÑ©ù[1008] . $fÁƒ·¢×ŞĞ : $aŞ‹âÑ©ù[33]; } protected function parseComment($bÀª™ßºÆª) { $dˆ–¹åÎÕ’ =& $_SERVER[ªúæÂ¡­ä½]; return !empty($bÀª™ßºÆª) ? $dˆ–¹åÎÕ’[1009] . $bÀª™ßºÆª . $dˆ–¹åÎÕ’[1010] : $dˆ–¹åÎÕ’[33]; } protected function parseDistinct($FßáƒĞÆôç) { $f¶‰îË©Ô¹ =& $_SERVER[ªúæÂ¡­ä½]; return !empty($FßáƒĞÆôç) ? $f¶‰îË©Ô¹[1011] : $f¶‰îË©Ô¹[33]; } protected function parseUnion($fœâºÏ ‰) { $Cõ‘ÑÕá =& $_SERVER[ªúæÂ¡­ä½]; if (empty($fœâºÏ ‰)) { return $Cõ‘ÑÕá[33]; } if (isset($fœâºÏ ‰[$Cõ‘ÑÕá[346]])) { $DÒ¾÷íöŠ™ = $Cõ‘ÑÕá[1012]; unset($fœâºÏ ‰[$Cõ‘ÑÕá[346]]); } else { $DÒ¾÷íöŠ™ = $Cõ‘ÑÕá[1013]; } foreach ($fœâºÏ ‰ as $cß‹ÕŠÔËš) { $D“´·†ê‘Š[] = $DÒ¾÷íöŠ™ . (is_array($cß‹ÕŠÔËš) ? $this->buildSelectSql($cß‹ÕŠÔËš) : $cß‹ÕŠÔËš); } return implode($Cõ‘ÑÕá[50], $D“´·†ê‘Š); } public function insert($f£›£†®¡¼, $B‘æ…¬éÄ = array(), $fë©¹‡Œ ì = false) { goto f‹ŠŸ×ì Ê; eŸÃÈˆ„é: $bå¥ëªôù .= $this->parseComment(!empty($B‘æ…¬éÄ[$BÛÀâë‡í×[352]]) ? $B‘æ…¬éÄ[$BÛÀâë‡í×[352]] : $BÛÀâë‡í×[33]); return $this->execute($bå¥ëªôù, $this->parseBind(!empty($B‘æ…¬éÄ[$BÛÀâë‡í×[283]]) ? $B‘æ…¬éÄ[$BÛÀâë‡í×[283]] : array())); goto a—è»Ú³–ä; f‹ŠŸ×ì Ê: $BÛÀâë‡í× =& $_SERVER[ªúæÂ¡­ä½]; $bíˆ´ßÃ– = $eôÅëÌ¾ö = array(); $this->model = $B‘æ…¬éÄ[$BÛÀâë‡í×[279]]; goto c§ö³ÏË´; c§ö³ÏË´: foreach ($f£›£†®¡¼ as $B¯Íß·âÊì => $dªğøÇ“) { if (is_array($dªğøÇ“) && $BÛÀâë‡í×[295] == $dªğøÇ“[0]) { $eôÅëÌ¾ö[] = $this->parseKey($B¯Íß·âÊì); $bíˆ´ßÃ–[] = $dªğøÇ“[1]; } elseif (is_scalar($dªğøÇ“) || is_null($dªğøÇ“)) { $eôÅëÌ¾ö[] = $this->parseKey($B¯Íß·âÊì); $bíˆ´ßÃ–[] = $this->parseValue($dªğøÇ“); } } $bå¥ëªôù = ($fë©¹‡Œ ì ? $BÛÀâë‡í×[884] : $BÛÀâë‡í×[885]) . $BÛÀâë‡í×[886] . $this->parseTable($B‘æ…¬éÄ[$BÛÀâë‡í×[277]]) . $BÛÀâë‡í×[880] . implode($BÛÀâë‡í×[47], $eôÅëÌ¾ö) . $BÛÀâë‡í×[881] . implode($BÛÀâë‡í×[47], $bíˆ´ßÃ–) . $BÛÀâë‡í×[882]; $bå¥ëªôù .= $this->parseLock(isset($B‘æ…¬éÄ[$BÛÀâë‡í×[830]]) ? $B‘æ…¬éÄ[$BÛÀâë‡í×[830]] : !1); goto eŸÃÈˆ„é; a—è»Ú³–ä: } public function selectInsert($CÏ”•¢£, $bÕ²½Å™Œ², $DÃ¾·»£‡¡ = array()) { goto E«Ò‡¡ºÜŠ; fÀ»¼‡÷ù: return $this->execute($e•¶ˆè¹Û, $this->parseBind(!empty($DÃ¾·»£‡¡[$föëİÃç»ö[283]]) ? $DÃ¾·»£‡¡[$föëİÃç»ö[283]] : array())); goto eš©Šôİ„‰; BÙáÚƒÛêî: array_walk($CÏ”•¢£, array($this, $föëİÃç»ö[883])); $e•¶ˆè¹Û = $föëİÃç»ö[1014] . $this->parseTable($bÕ²½Å™Œ²) . $föëİÃç»ö[880] . implode($föëİÃç»ö[47], $CÏ”•¢£) . $föëİÃç»ö[992]; $e•¶ˆè¹Û .= $this->buildSelectSql($DÃ¾·»£‡¡); goto fÀ»¼‡÷ù; E«Ò‡¡ºÜŠ: $föëİÃç»ö =& $_SERVER[ªúæÂ¡­ä½]; $this->model = $DÃ¾·»£‡¡[$föëİÃç»ö[279]]; if (is_string($CÏ”•¢£)) { $CÏ”•¢£ = explode($föëİÃç»ö[47], $CÏ”•¢£); } goto BÙáÚƒÛêî; eš©Šôİ„‰: } public function update($EË‚Á‚¡½, $fìçÎì‰½ï) { $aÔ³ìÉÈçÜ =& $_SERVER[ªúæÂ¡­ä½]; $this->model = $fìçÎì‰½ï[$aÔ³ìÉÈçÜ[279]]; $a«ªŒÂ½ = $aÔ³ìÉÈçÜ[1015] . $this->parseTable($fìçÎì‰½ï[$aÔ³ìÉÈçÜ[277]]) . $this->parseSet($EË‚Á‚¡½) . $this->parseWhere(!empty($fìçÎì‰½ï[$aÔ³ìÉÈçÜ[273]]) ? $fìçÎì‰½ï[$aÔ³ìÉÈçÜ[273]] : $aÔ³ìÉÈçÜ[33]) . $this->parseOrder(!empty($fìçÎì‰½ï[$aÔ³ìÉÈçÜ[363]]) ? $fìçÎì‰½ï[$aÔ³ìÉÈçÜ[363]] : $aÔ³ìÉÈçÜ[33]) . $this->parseLimit(!empty($fìçÎì‰½ï[$aÔ³ìÉÈçÜ[290]]) ? $fìçÎì‰½ï[$aÔ³ìÉÈçÜ[290]] : $aÔ³ìÉÈçÜ[33]) . $this->parseLock(isset($fìçÎì‰½ï[$aÔ³ìÉÈçÜ[830]]) ? $fìçÎì‰½ï[$aÔ³ìÉÈçÜ[830]] : !1) . $this->parseComment(!empty($fìçÎì‰½ï[$aÔ³ìÉÈçÜ[352]]) ? $fìçÎì‰½ï[$aÔ³ìÉÈçÜ[352]] : $aÔ³ìÉÈçÜ[33]); return $this->execute($a«ªŒÂ½, $this->parseBind(!empty($fìçÎì‰½ï[$aÔ³ìÉÈçÜ[283]]) ? $fìçÎì‰½ï[$aÔ³ìÉÈçÜ[283]] : array())); } public function delete($dÁ±æâé© = array()) { $D‚¡ÖÕ•Í =& $_SERVER[ªúæÂ¡­ä½]; $this->model = $dÁ±æâé©[$D‚¡ÖÕ•Í[279]]; $BÂ¨æš¨£ = $D‚¡ÖÕ•Í[1016] . $this->parseTable($dÁ±æâé©[$D‚¡ÖÕ•Í[277]]) . $this->parseWhere(!empty($dÁ±æâé©[$D‚¡ÖÕ•Í[273]]) ? $dÁ±æâé©[$D‚¡ÖÕ•Í[273]] : $D‚¡ÖÕ•Í[33]) . $this->parseOrder(!empty($dÁ±æâé©[$D‚¡ÖÕ•Í[363]]) ? $dÁ±æâé©[$D‚¡ÖÕ•Í[363]] : $D‚¡ÖÕ•Í[33]) . $this->parseLimit(!empty($dÁ±æâé©[$D‚¡ÖÕ•Í[290]]) ? $dÁ±æâé©[$D‚¡ÖÕ•Í[290]] : $D‚¡ÖÕ•Í[33]) . $this->parseLock(isset($dÁ±æâé©[$D‚¡ÖÕ•Í[830]]) ? $dÁ±æâé©[$D‚¡ÖÕ•Í[830]] : !1) . $this->parseComment(!empty($dÁ±æâé©[$D‚¡ÖÕ•Í[352]]) ? $dÁ±æâé©[$D‚¡ÖÕ•Í[352]] : $D‚¡ÖÕ•Í[33]); return $this->execute($BÂ¨æš¨£, $this->parseBind(!empty($dÁ±æâé©[$D‚¡ÖÕ•Í[283]]) ? $dÁ±æâé©[$D‚¡ÖÕ•Í[283]] : array())); } public function select($FÊ¹¸ì”Îä = array()) { goto E„İƒù†İ“; E„İƒù†İ“: $B “îÈÓŸô =& $_SERVER[ªúæÂ¡­ä½]; $this->model = $FÊ¹¸ì”Îä[$B “îÈÓŸô[279]]; $c‹±í·íµ = $this->buildSelectSql($FÊ¹¸ì”Îä); goto DÉç“İØ½‚; DÉç“İØ½‚: $d¨–ÕÖáøÂ = isset($FÊ¹¸ì”Îä[$B “îÈÓŸô[347]]) ? $FÊ¹¸ì”Îä[$B “îÈÓŸô[347]] : !1; if ($d¨–ÕÖáøÂ) { $E›ËÛ“²¸Ò = is_string($d¨–ÕÖáøÂ[$B “îÈÓŸô[93]]) ? $d¨–ÕÖáøÂ[$B “îÈÓŸô[93]] : $B “îÈÓŸô[1017] . md5($c‹±í·íµ); $bÃÄÄ¢ğ¸• = think_cache($E›ËÛ“²¸Ò, $B “îÈÓŸô[33], $d¨–ÕÖáøÂ); if (!1 !== $bÃÄÄ¢ğ¸•) { return $bÃÄÄ¢ğ¸•; } } $AÈˆ·ØìœÛ = $this->query($c‹±í·íµ, $this->parseBind(!empty($FÊ¹¸ì”Îä[$B “îÈÓŸô[283]]) ? $FÊ¹¸ì”Îä[$B “îÈÓŸô[283]] : array())); goto BŸ˜¿†ò; BŸ˜¿†ò: if ($d¨–ÕÖáøÂ && !1 !== $AÈˆ·ØìœÛ) { think_cache($E›ËÛ“²¸Ò, $AÈˆ·ØìœÛ, $d¨–ÕÖáøÂ); } return $AÈˆ·ØìœÛ; goto bØŞ·”£ô; bØŞ·”£ô: } public function buildSelectSql($Bêø×œè°è = array()) { goto d¢Å‘õíŒ¥; d¢Å‘õíŒ¥: $cÏˆ½ºÂ· =& $_SERVER[ªúæÂ¡­ä½]; if (isset($Bêø×œè°è[$cÏˆ½ºÂ·[351]])) { if (strpos($Bêø×œè°è[$cÏˆ½ºÂ·[351]], $cÏˆ½ºÂ·[47])) { list($E‰­®¿Êâ, $b·óºŠ ‚) = explode($cÏˆ½ºÂ·[47], $Bêø×œè°è[$cÏˆ½ºÂ·[351]]); } else { $E‰­®¿Êâ = $Bêø×œè°è[$cÏˆ½ºÂ·[351]]; } $E‰­®¿Êâ = $E‰­®¿Êâ ? $E‰­®¿Êâ : 1; $b·óºŠ ‚ = isset($b·óºŠ ‚) ? $b·óºŠ ‚ : (is_numeric($Bêø×œè°è[$cÏˆ½ºÂ·[290]]) ? $Bêø×œè°è[$cÏˆ½ºÂ·[290]] : 20); $eËÏ—ĞÄ’‚ = $b·óºŠ ‚ * ((int) $E‰­®¿Êâ - 1); $Bêø×œè°è[$cÏˆ½ºÂ·[290]] = $eËÏ—ĞÄ’‚ . $cÏˆ½ºÂ·[47] . $b·óºŠ ‚; } if (think_config($cÏˆ½ºÂ·[1018])) { $D¥¶¾·‡‹ù = $cÏˆ½ºÂ·[1019] . md5(serialize($Bêø×œè°è)); $cƒ¤²£ïÕ = think_cache($D¥¶¾·‡‹ù); if ($cƒ¤²£ïÕ) { return $cƒ¤²£ïÕ; } } goto fì…›Ôã«; fç«¤—É‚ƒ: return $e£¬ä‚£è“; goto Cõ…×¼ò”ö; fì…›Ôã«: $e£¬ä‚£è“ = $this->parseSql($this->selectSql, $Bêø×œè°è); $e£¬ä‚£è“ .= $this->parseLock(isset($Bêø×œè°è[$cÏˆ½ºÂ·[830]]) ? $Bêø×œè°è[$cÏˆ½ºÂ·[830]] : !1); if (isset($D¥¶¾·‡‹ù)) { think_cache($D¥¶¾·‡‹ù, $e£¬ä‚£è“); } goto fç«¤—É‚ƒ; Cõ…×¼ò”ö: } public function parseSql($AèÔÍ¹é‚­, $cè´ùÈ“ = array()) { $dùµÀ‘ŞÆé =& $_SERVER[ªúæÂ¡­ä½]; $AèÔÍ¹é‚­ = str_replace(array($dùµÀ‘ŞÆé[1020], $dùµÀ‘ŞÆé[1021], $dùµÀ‘ŞÆé[1022], $dùµÀ‘ŞÆé[1023], $dùµÀ‘ŞÆé[1024], $dùµÀ‘ŞÆé[1025], $dùµÀ‘ŞÆé[1026], $dùµÀ‘ŞÆé[1027], $dùµÀ‘ŞÆé[1028], $dùµÀ‘ŞÆé[1029], $dùµÀ‘ŞÆé[1030]), array($this->parseTable("{$cè´ùÈ“[$dùµÀ‘ŞÆé[277]]}"), $this->parseDistinct(isset($cè´ùÈ“[$dùµÀ‘ŞÆé[1031]]) ? $cè´ùÈ“[$dùµÀ‘ŞÆé[1031]] : !1), $this->parseField(!empty($cè´ùÈ“[$dùµÀ‘ŞÆé[271]]) ? $cè´ùÈ“[$dùµÀ‘ŞÆé[271]] : $dùµÀ‘ŞÆé[182]), $this->parseJoin(!empty($cè´ùÈ“[$dùµÀ‘ŞÆé[280]]) ? $cè´ùÈ“[$dùµÀ‘ŞÆé[280]] : $dùµÀ‘ŞÆé[33]), $this->parseWhere(!empty($cè´ùÈ“[$dùµÀ‘ŞÆé[273]]) ? $cè´ùÈ“[$dùµÀ‘ŞÆé[273]] : $dùµÀ‘ŞÆé[33]), $this->parseGroup(!empty($cè´ùÈ“[$dùµÀ‘ŞÆé[497]]) ? $cè´ùÈ“[$dùµÀ‘ŞÆé[497]] : $dùµÀ‘ŞÆé[33]), $this->parseHaving(!empty($cè´ùÈ“[$dùµÀ‘ŞÆé[1032]]) ? $cè´ùÈ“[$dùµÀ‘ŞÆé[1032]] : $dùµÀ‘ŞÆé[33]), $this->parseOrder(!empty($cè´ùÈ“[$dùµÀ‘ŞÆé[363]]) ? $cè´ùÈ“[$dùµÀ‘ŞÆé[363]] : $dùµÀ‘ŞÆé[33]), $this->parseLimit(!empty($cè´ùÈ“[$dùµÀ‘ŞÆé[290]]) ? $cè´ùÈ“[$dùµÀ‘ŞÆé[290]] : $dùµÀ‘ŞÆé[33]), $this->parseUnion(!empty($cè´ùÈ“[$dùµÀ‘ŞÆé[345]]) ? $cè´ùÈ“[$dùµÀ‘ŞÆé[345]] : $dùµÀ‘ŞÆé[33]), $this->parseComment(!empty($cè´ùÈ“[$dùµÀ‘ŞÆé[352]]) ? $cè´ùÈ“[$dùµÀ‘ŞÆé[352]] : $dùµÀ‘ŞÆé[33])), $AèÔÍ¹é‚­); return $AèÔÍ¹é‚­; } public function getLastSql($E²äì—‹ = '') { return $E²äì—‹ ? $this->modelSql[$E²äì—‹] : $this->queryStr; } public function getLastInsID() { return $this->lastInsID; } public function getError() { return $this->error; } public function escapeString($A±‘­Ë¦) { return addslashes($A±‘­Ë¦); } public function setModel($DØ“íöšªÀ) { $this->model = $DØ“íöšªÀ; } public function getDbType() { return $this->dbType; } public function __destruct() { if ($this->queryID) { $this->free(); } $this->close(); } public function close() { } } class DbManage { function __construct($b…ßí±ê‡¶, $f˜£õí„¬À = '') { $this->database = $b…ßí±ê‡¶; $this->type = $f˜£õí„¬À; } public function model($f›ğº¾è©È = '') { return new ModelBase($f›ğº¾è©È, $_SERVER[ªúæÂ¡­ä½][33], $this->database); } public function db($Dòåšà¡¬¶ = false) { goto c‚šæ‹˜»‰; c‚šæ‹˜»‰: $D¼ŒãâÎØÛ =& $_SERVER[ªúæÂ¡­ä½]; $DâÆº‚Á¶ = array_change_key_case($this->database); if ($this->type == $D¼ŒãâÎØÛ[9] || !$Dòåšà¡¬¶) { return $this->model()->db(); } goto CŒ‡ñ£Óëò; D†êÀø : if (!$fçùÃß¾–) { $a®¿£–àİ•->execute("\x63\x72\x65\x61\x74\145\x20\x64\141\164\141\x62\x61\x73\145\40\140{$F¾¶äóôñ}\140"); } $DâÆº‚Á¶[$D¼ŒãâÎØÛ[946]] = $F¾¶äóôñ; if ($DâÆº‚Á¶[$D¼ŒãâÎØÛ[772]] == $D¼ŒãâÎØÛ[773]) { $DâÆº‚Á¶[$D¼ŒãâÎØÛ[774]] .= $D¼ŒãâÎØÛ[1033] . $F¾¶äóôñ; } goto a½Ÿ³ÕÑº„; Fò¢‚¨‰ğõ: $this->database = $DâÆº‚Á¶; $a®¿£–àİ• = $this->model()->db(); try { $fçùÃß¾– = $a®¿£–àİ•->execute("\163\150\157\x77\40\144\141\164\x61\142\141\163\x65\163\x20\154\151\x6b\145\40\x27{$F¾¶äóôñ}\x27"); } catch (Exception $bêƒÁ’©°…) { } goto D†êÀø ; CŒ‡ñ£Óëò: $F¾¶äóôñ = $DâÆº‚Á¶[$D¼ŒãâÎØÛ[946]]; $DâÆº‚Á¶[$D¼ŒãâÎØÛ[946]] = $D¼ŒãâÎØÛ[33]; if ($DâÆº‚Á¶[$D¼ŒãâÎØÛ[772]] == $D¼ŒãâÎØÛ[773]) { $dªµ‰ÚÁ¹µ = $DâÆº‚Á¶[$D¼ŒãâÎØÛ[774]]; $DâÆº‚Á¶[$D¼ŒãâÎØÛ[774]] = substr($dªµ‰ÚÁ¹µ, 0, strrpos($dªµ‰ÚÁ¹µ, $D¼ŒãâÎØÛ[1033])); } goto Fò¢‚¨‰ğõ; a½Ÿ³ÕÑº„: $this->database = $DâÆº‚Á¶; $a®¿£–àİ•->execute("\x75\x73\145\x20\x60{$F¾¶äóôñ}\x60"); return $a®¿£–àİ•; goto bğŒœ¡…; bğŒœ¡…: } public function createTable($e÷¸ÀÁªš, $fêºß‘ë—¢ = null) { $b²×Í¨ŠĞ£ =& $_SERVER[ªúæÂ¡­ä½]; if (!IO::exist($e÷¸ÀÁªš)) { ActionCall($b²×Í¨ŠĞ£[1034], !0, 0); show_json(LNG($b²×Í¨ŠĞ£[1035]), !1); } $f°ÕòÕ¤‰¯ = sqlSplit(IO::getContent($e÷¸ÀÁªš)); foreach ($f°ÕòÕ¤‰¯ as $F©ƒğ°–í‡) { if ($fêºß‘ë—¢) { $B¥¿Ìáã°” = stripos($F©ƒğ°–í‡, $b²×Í¨ŠĞ£[1036]) === 0; if ($B¥¿Ìáã°”) { $fêºß‘ë—¢->task[$b²×Í¨ŠĞ£[1037]] += 1; } } $this->model()->db()->execute($F©ƒğ°–í‡); if ($fêºß‘ë—¢ && $B¥¿Ìáã°”) { preg_match($b²×Í¨ŠĞ£[1038], $F©ƒğ°–í‡, $dÊàåáğ¯³); $fêºß‘ë—¢->task[$b²×Í¨ŠĞ£[1039]] = $dÊàåáğ¯³[1]; $fêºß‘ë—¢->update(1); } } $this->taskToCache($fêºß‘ë—¢); } public function insertTable($C¢·‘¸ÇÕÇ, $B÷¶ÆŠã¿ = null) { $f¢µ£”Ü‰§ =& $_SERVER[ªúæÂ¡­ä½]; $E­Èòˆ÷ôœ = $this->model()->db(); $a¡ŞÔ“«ñİ = $cÁ‰óÇ•å… ? array($cÁ‰óÇ•å…) : $E­Èòˆ÷ôœ->getTables(); foreach ($C¢·‘¸ÇÕÇ as $B±ÊŒ‘¥ ö) { $cÁ‰óÇ•å… = basename($B±ÊŒ‘¥ ö, $f¢µ£”Ü‰§[764]); if (!in_array($cÁ‰óÇ•å…, $a¡ŞÔ“«ñİ)) { continue; } if ($B÷¶ÆŠã¿) { $B÷¶ÆŠã¿->task[$f¢µ£”Ü‰§[1039]] = $cÁ‰óÇ•å…; } if (get_filesize($B±ÊŒ‘¥ ö) == 0) { continue; } $B¶ ±ãŠ° = $this->sqlToDb($B±ÊŒ‘¥ ö, $B÷¶ÆŠã¿); if (!$B¶ ±ãŠ°) { ActionCall($f¢µ£”Ü‰§[1034], !0, 0); show_json(LNG($f¢µ£”Ü‰§[1040]) . "\x5b{$cÁ‰óÇ•å…}\135", !1); } } $this->taskToCache($B÷¶ÆŠã¿); } public function sqlFromDb($DÀö†ŞŞ˜, $eé²÷ò®ÅŒ, $DÓß”ÉË‹ª = null, $F½¶âƒ‡†ä = null) { goto E ˆŠÅŸÏ; E ˆŠÅŸÏ: if ($DÓß”ÉË‹ª) { $DÓß”ÉË‹ª->task[$_SERVER[ªúæÂ¡­ä½][1039]] = $DÀö†ŞŞ˜; } $cÖùñ‰ğ£Ï = $this->model($DÀö†ŞŞ˜); $cËôÅ‚­ = 0; goto f„¨•½·–®; AŠÕ‘÷ÏØ: fclose($eÙ…ŠİİÆ­); return $cËôÅ‚­; goto fïš‰ªÁ°ê; f„¨•½·–®: $a½»÷Ç­Ê± = 0; $F—œÔĞ“³ = 10000; $eÙ…ŠİİÆ­ = fopen($eé²÷ò®ÅŒ, $_SERVER[ªúæÂ¡­ä½][1041]); goto a¼„²ìÊ¥; a¼„²ìÊ¥: $bèÚÅİ‰İ = $cÖùñ‰ğ£Ï->getPk(); $FÙš¿ßàº = $cÖùñ‰ğ£Ï->getDbFields(); do { $fŠî‰Îš‰ = array($bèÚÅİ‰İ => array($_SERVER[ªúæÂ¡­ä½][988], $a½»÷Ç­Ê±)); $F©•ö¢ ¦Ú = $cÖùñ‰ğ£Ï->where($fŠî‰Îš‰)->field($FÙš¿ßàº)->order($bèÚÅİ‰İ . $_SERVER[ªúæÂ¡­ä½][1042])->limit($F—œÔĞ“³)->select(); $F©•ö¢ ¦Ú = !empty($F©•ö¢ ¦Ú) ? $F©•ö¢ ¦Ú : array(); if (!($CŞ‡·‘å µ = count($F©•ö¢ ¦Ú))) { break; } $a™Ã‚—Ï’ø = end($F©•ö¢ ¦Ú); $a½»÷Ç­Ê± = $a™Ã‚—Ï’ø[$bèÚÅİ‰İ]; $CøĞ…Áœ = array(); foreach ($F©•ö¢ ¦Ú as $A—ÃôªÎÖö) { if ($DÀö†ŞŞ˜ == $_SERVER[ªúæÂ¡­ä½][1043] && $A—ÃôªÎÖö[$_SERVER[ªúæÂ¡­ä½][29]] == $_SERVER[ªúæÂ¡­ä½][1044]) { $b™œ‹¤Ó¥ = json_decode($A—ÃôªÎÖö[$_SERVER[ªúæÂ¡­ä½][372]], !0); if ($b™œ‹¤Ó¥[$_SERVER[ªúæÂ¡­ä½][28]] == date($_SERVER[ªúæÂ¡­ä½][729]) && !$b™œ‹¤Ó¥[$_SERVER[ªúæÂ¡­ä½][728]]) { continue; } } if ($F½¶âƒ‡†ä) { $A—ÃôªÎÖö[$_SERVER[ªúæÂ¡­ä½][76]] = "\173\x69\x6f\72{$F½¶âƒ‡†ä}\x7d" . substr($A—ÃôªÎÖö[$_SERVER[ªúæÂ¡­ä½][76]], strlen("\173\151\x6f\x3a{$A—ÃôªÎÖö[$_SERVER[ªúæÂ¡­ä½][800]]}\175")); $A—ÃôªÎÖö[$_SERVER[ªúæÂ¡­ä½][800]] = $F½¶âƒ‡†ä; } $CøĞ…Áœ[] = $_SERVER[ªúæÂ¡­ä½][1045] . $this->sqlEncode($A—ÃôªÎÖö) . $_SERVER[ªúæÂ¡­ä½][1046]; } $EÀ´Í‡Œ­â = "\x49\116\123\105\x52\124\x20\x49\116\x54\117\x20\x60{$DÀö†ŞŞ˜}\140\40\x28\x60" . implode($_SERVER[ªúæÂ¡­ä½][1047], $FÙš¿ßàº) . $_SERVER[ªúæÂ¡­ä½][1048]; fwrite($eÙ…ŠİİÆ­, $EÀ´Í‡Œ­â . implode($_SERVER[ªúæÂ¡­ä½][1049], $CøĞ…Áœ) . $_SERVER[ªúæÂ¡­ä½][68] . PHP_EOL); $cËôÅ‚­ += $CŞ‡·‘å µ; if ($DÓß”ÉË‹ª) { $DÓß”ÉË‹ª->update($CŞ‡·‘å µ); } } while ($F—œÔĞ“³ == $CŞ‡·‘å µ); goto AŠÕ‘÷ÏØ; fïš‰ªÁ°ê: } public function sqlToDb($e…¼“ÉßÈÜ, $eæÜ–‚—ÂÈ = null) { goto D“……†’¿‡; D‚·¸‡‹“‰: if (!$d¥ˆâÊšŠŒ) { return !1; } $E¿´Öˆ´æ = 0; $eÔŞÕƒ­Ï† = $F„¶ŞÉ­Öñ[33]; goto e…ØìØ÷’»; Fêç†íŠÎ: return !0; goto fÉ†÷©‘‘; c„¾¿°Ø: while (!feof($d¥ˆâÊšŠŒ)) { $DÅ·È°õ—á = trim(fgets($d¥ˆâÊšŠŒ)); if (!$DÅ·È°õ—á) { continue; } $B¸à·Ò¶ğò = $this->sqlDecode($DÅ·È°õ—á, $this->type); if (stripos($B¸à·Ò¶ğò, $F„¶ŞÉ­Öñ[353]) === 0) { if (!$eÔŞÕƒ­Ï†) { $eÔŞÕƒ­Ï† = $B¸à·Ò¶ğò . $F„¶ŞÉ­Öñ[50]; } continue; } if ($eæÜ–‚—ÂÈ) { $eæÜ–‚—ÂÈ->task[$F„¶ŞÉ­Öñ[1037]] += 1; } $E¿´Öˆ´æ++; $AÑ¾•¦«±š[] = rtrim(rtrim(trim($B¸à·Ò¶ğò), $F„¶ŞÉ­Öñ[47]), $F„¶ŞÉ­Öñ[68]); $B±…´¾Ş—ò = null; $Añİßñ¿â² = strlen($B¸à·Ò¶ğò); $cá‰Ğš…¼È += $Añİßñ¿â²; if ($cá‰Ğš…¼È >= ($f‘•¨¥£§ø == 500 ? $aÂœÄ»ªç© : $bâè›®¢×ä)) { $B±…´¾Ş—ò = array_pop($AÑ¾•¦«±š); if ($E¿´Öˆ´æ > 1) { $E¿´Öˆ´æ--; } } if ($E¿´Öˆ´æ >= $f‘•¨¥£§ø || $B±…´¾Ş—ò) { goto F³Šğø†’Í; F³Šğø†’Í: $B¸à·Ò¶ğò = $eÔŞÕƒ­Ï† . implode($F„¶ŞÉ­Öñ[47], $AÑ¾•¦«±š); if (!$dÚÀæÜ¥ˆ´->execute($B¸à·Ò¶ğò)) { return !1; } if ($eæÜ–‚—ÂÈ) { $eæÜ–‚—ÂÈ->update($E¿´Öˆ´æ); } goto CÍ‡ßëãîñ; CÍ‡ßëãîñ: $AÑ¾•¦«±š = array(); $E¿´Öˆ´æ = 0; $cá‰Ğš…¼È = 0; goto fë¸ù™¿ãŠ; fë¸ù™¿ãŠ: if ($B±…´¾Ş—ò) { $AÑ¾•¦«±š = array($B±…´¾Ş—ò); $E¿´Öˆ´æ = 1; $cá‰Ğš…¼È = $Añİßñ¿â²; } goto cËÌ³†èáÏ; cËÌ³†èáÏ: } } fclose($d¥ˆâÊšŠŒ); if (!empty($AÑ¾•¦«±š)) { $B¸à·Ò¶ğò = $eÔŞÕƒ­Ï† . implode($F„¶ŞÉ­Öñ[47], $AÑ¾•¦«±š); if (!$dÚÀæÜ¥ˆ´->execute($B¸à·Ò¶ğò)) { return !1; } if ($eæÜ–‚—ÂÈ) { $eæÜ–‚—ÂÈ->update($E¿´Öˆ´æ); } } goto Fêç†íŠÎ; e…ØìØ÷’»: $AÑ¾•¦«±š = array(); $f‘•¨¥£§ø = $this->type == $F„¶ŞÉ­Öñ[9] ? 500 : 2000; $F£Ä‹­Æ†— = basename($e…¼“ÉßÈÜ, $F„¶ŞÉ­Öñ[764]); goto BßŸß¾×²•; BßŸß¾×²•: $cá‰Ğš…¼È = 0; $aÂœÄ»ªç© = 4194304 - 104858; $bâè›®¢×ä = 1000000 - 104858; goto c„¾¿°Ø; D“……†’¿‡: $F„¶ŞÉ­Öñ =& $_SERVER[ªúæÂ¡­ä½]; $dÚÀæÜ¥ˆ´ = $this->model()->db(); $d¥ˆâÊšŠŒ = @fopen($e…¼“ÉßÈÜ, $F„¶ŞÉ­Öñ[1050]); goto D‚·¸‡‹“‰; fÉ†÷©‘‘: } public function dropTable($FáÏäŸ°èš = null) { $a•ñã‹òÆš = $this->model()->db(); $DƒÈë”¬Æ¾ = $FáÏäŸ°èš ? array($FáÏäŸ°èš) : $a•ñã‹òÆš->getTables(); if (!$DƒÈë”¬Æ¾) { return; } foreach ($DƒÈë”¬Æ¾ as $FáÏäŸ°èš) { if ($FáÏäŸ°èš) { $FáÏäŸ°èš = strtolower($FáÏäŸ°èš); } else { continue; } $a•ñã‹òÆš->execute("\x64\x72\x6f\160\40\164\141\142\x6c\x65\x20\151\x66\x20\x65\x78\x69\163\164\x73\x20\x60{$FáÏäŸ°èš}\x60"); } } private function taskToCache($E–·‘ÓÅ‰Ø = null) { $CÚßØ™¤ºƒ =& $_SERVER[ªúæÂ¡­ä½]; if (!$E–·‘ÓÅ‰Ø) { return; } $E‰Åˆ¹ªØ¶ = array($CÚßØ™¤ºƒ[1039] => $E–·‘ÓÅ‰Ø->task[$CÚßØ™¤ºƒ[1039]], $CÚßØ™¤ºƒ[1037] => $E–·‘ÓÅ‰Ø->task[$CÚßØ™¤ºƒ[1037]], $CÚßØ™¤ºƒ[1051] => $E–·‘ÓÅ‰Ø->task[$CÚßØ™¤ºƒ[1051]]); if ($E‰Åˆ¹ªØ¶[$CÚßØ™¤ºƒ[1037]] == $E‰Åˆ¹ªØ¶[$CÚßØ™¤ºƒ[1051]]) { $E‰Åˆ¹ªØ¶[$CÚßØ™¤ºƒ[738]] = 1; } Cache::set($CÚßØ™¤ºƒ[1052] . $E–·‘ÓÅ‰Ø->task[$CÚßØ™¤ºƒ[394]], $E‰Åˆ¹ªØ¶); $E–·‘ÓÅ‰Ø->end(); } private function sqlEncode($E“‰¸äÚ÷ô) { $E†‹âÀÛÙÆ =& $_SERVER[ªúæÂ¡­ä½]; $BÛ„Ñ“å…¡ = array(); foreach ($E“‰¸äÚ÷ô as $aé µ»ïâ¼) { if (is_array($aé µ»ïâ¼)) { $aé µ»ïâ¼ = json_encode_force($aé µ»ïâ¼); } $aé µ»ïâ¼ = addslashes($aé µ»ïâ¼); $aé µ»ïâ¼ = str_replace(array($E†‹âÀÛÙÆ[1053], $E†‹âÀÛÙÆ[229]), array($E†‹âÀÛÙÆ[1054], $E†‹âÀÛÙÆ[1055]), $aé µ»ïâ¼); $BÛ„Ñ“å…¡[] = str_replace($E†‹âÀÛÙÆ[55], $E†‹âÀÛÙÆ[1056], $aé µ»ïâ¼); } return $E†‹âÀÛÙÆ[55] . implode($E†‹âÀÛÙÆ[1057], $BÛ„Ñ“å…¡) . $E†‹âÀÛÙÆ[55]; } private function sqlDecode($e¬¬õùÙÒğ, $b—•±ƒ—±‹) { $DŸßÓ¡¸ =& $_SERVER[ªúæÂ¡­ä½]; $e¬¬õùÙÒğ = str_replace(array($DŸßÓ¡¸[1054], $DŸßÓ¡¸[1055]), array($DŸßÓ¡¸[1053], $DŸßÓ¡¸[229]), $e¬¬õùÙÒğ); if ($b—•±ƒ—±‹ == $DŸßÓ¡¸[9]) { $e¬¬õùÙÒğ = stripslashes($e¬¬õùÙÒğ); } return $e¬¬õùÙÒğ; } } goto e—êëÆÚÑ‰; e‚Ôìö‘ÈÚ: class SystemLogModel extends ModelBase { protected $tableName = "\x73\x79\163\164\145\x6d\x5f\154\157\x67"; protected $dataAuto = array(array("\143\162\145\141\164\x65\x54\x69\155\145", "\x74\x69\155\145", "\151\156\x73\145\162\164", "\146\x75\x6e\x63\x74\151\157\x6e")); public $typeList; function __construct() { parent::__construct(); $this->typeList = $this->typeListAll(); } public function typeListAll() { $Fšİ‰†£ƒ =& $_SERVER[ªúæÂ¡­ä½]; return array($Fšİ‰†£ƒ[2030] => LNG($Fšİ‰†£ƒ[2031]), $Fšİ‰†£ƒ[2032] => LNG($Fšİ‰†£ƒ[2033]), $Fšİ‰†£ƒ[1654] => LNG($Fšİ‰†£ƒ[2034]), $Fšİ‰†£ƒ[2035] => LNG($Fšİ‰†£ƒ[2036]), $Fšİ‰†£ƒ[2037] => LNG($Fšİ‰†£ƒ[2038]), $Fšİ‰†£ƒ[2039] => LNG($Fšİ‰†£ƒ[2040]), $Fšİ‰†£ƒ[2041] => LNG($Fšİ‰†£ƒ[2042]), $Fšİ‰†£ƒ[1684] => LNG($Fšİ‰†£ƒ[2042]), $Fšİ‰†£ƒ[1685] => LNG($Fšİ‰†£ƒ[2043]), $Fšİ‰†£ƒ[2044] => LNG($Fšİ‰†£ƒ[2045]), $Fšİ‰†£ƒ[2046] => LNG($Fšİ‰†£ƒ[2047]), $Fšİ‰†£ƒ[2048] => LNG($Fšİ‰†£ƒ[2049]), $Fšİ‰†£ƒ[2050] => LNG($Fšİ‰†£ƒ[2051]), $Fšİ‰†£ƒ[1682] => LNG($Fšİ‰†£ƒ[2052]), $Fšİ‰†£ƒ[2053] => LNG($Fšİ‰†£ƒ[2054]), $Fšİ‰†£ƒ[1689] => LNG($Fšİ‰†£ƒ[2055]), $Fšİ‰†£ƒ[2056] => LNG($Fšİ‰†£ƒ[2057]), $Fšİ‰†£ƒ[2058] => LNG($Fšİ‰†£ƒ[2059]), $Fšİ‰†£ƒ[2060] => LNG($Fšİ‰†£ƒ[2061]), $Fšİ‰†£ƒ[2062] => LNG($Fšİ‰†£ƒ[2063]), $Fšİ‰†£ƒ[1692] => LNG($Fšİ‰†£ƒ[2064]), $Fšİ‰†£ƒ[1693] => LNG($Fšİ‰†£ƒ[2065]), $Fšİ‰†£ƒ[2066] => LNG($Fšİ‰†£ƒ[2067]), $Fšİ‰†£ƒ[2068] => LNG($Fšİ‰†£ƒ[2069]), $Fšİ‰†£ƒ[2070] => LNG($Fšİ‰†£ƒ[2071]), $Fšİ‰†£ƒ[1687] => LNG($Fšİ‰†£ƒ[2072]), $Fšİ‰†£ƒ[2073] => LNG($Fšİ‰†£ƒ[2074]), $Fšİ‰†£ƒ[1686] => LNG($Fšİ‰†£ƒ[2075]), $Fšİ‰†£ƒ[2076] => LNG($Fšİ‰†£ƒ[2077]), $Fšİ‰†£ƒ[2078] => LNG($Fšİ‰†£ƒ[2079]), $Fšİ‰†£ƒ[2080] => LNG($Fšİ‰†£ƒ[2081]), $Fšİ‰†£ƒ[2082] => LNG($Fšİ‰†£ƒ[2082]), $Fšİ‰†£ƒ[2083] => LNG($Fšİ‰†£ƒ[1658]), $Fšİ‰†£ƒ[2084] => LNG($Fšİ‰†£ƒ[2085]), $Fšİ‰†£ƒ[2086] => LNG($Fšİ‰†£ƒ[2087]), $Fšİ‰†£ƒ[2088] => LNG($Fšİ‰†£ƒ[2089]), $Fšİ‰†£ƒ[2090] => LNG($Fšİ‰†£ƒ[2091]), $Fšİ‰†£ƒ[2092] => LNG($Fšİ‰†£ƒ[2093]), $Fšİ‰†£ƒ[2094] => LNG($Fšİ‰†£ƒ[2094]), $Fšİ‰†£ƒ[2095] => LNG($Fšİ‰†£ƒ[2096]), $Fšİ‰†£ƒ[2097] => LNG($Fšİ‰†£ƒ[2098]), $Fšİ‰†£ƒ[2099] => LNG($Fšİ‰†£ƒ[2100]), $Fšİ‰†£ƒ[2101] => LNG($Fšİ‰†£ƒ[2102]), $Fšİ‰†£ƒ[2103] => LNG($Fšİ‰†£ƒ[2104]), $Fšİ‰†£ƒ[2105] => LNG($Fšİ‰†£ƒ[2106])); } private function typeFile() { $aæ…†˜çà® =& $_SERVER[ªúæÂ¡­ä½]; $EÀ®Å—„’ = array($aæ…†˜çà®[1689] => array($aæ…†˜çà®[1690]), $aæ…†˜çà®[2048] => array($aæ…†˜çà®[2107]), $aæ…†˜çà®[2050] => array($aæ…†˜çà®[2108]), $aæ…†˜çà®[1682] => array($aæ…†˜çà®[1683]), $aæ…†˜çà®[2058] => array(), $aæ…†˜çà®[2060] => array(), $aæ…†˜çà®[2062] => array(), $aæ…†˜çà®[1692] => array($aæ…†˜çà®[1694]), $aæ…†˜çà®[1693] => array($aæ…†˜çà®[1694]), $aæ…†˜çà®[2066] => array($aæ…†˜çà®[2109]), $aæ…†˜çà®[2068] => array($aæ…†˜çà®[2109]), $aæ…†˜çà®[2070] => array($aæ…†˜çà®[2110]), $aæ…†˜çà®[2056] => array($aæ…†˜çà®[2111]), $aæ…†˜çà®[1687] => array($aæ…†˜çà®[2112]), $aæ…†˜çà®[2073] => array($aæ…†˜çà®[2113]), $aæ…†˜çà®[1686] => array($aæ…†˜çà®[1688])); return $EÀ®Å—„’; } private function typeAll() { goto B½•‡‹Á¸; AÙäŒŒÄ¬¢: foreach ($A†İ†ì¯Š as $A±ƒÉ†¯ƒ‘ => $B½Ù‰¸ò›Ó) { $e³áé‚ˆå[$B½Ù‰¸ò›Ó[0]] = $e³áé‚ˆå[$A±ƒÉ†¯ƒ‘]; } $e³áé‚ˆå[$fÆ‰”ÌÜ[1694]] = LNG($fÆ‰”ÌÜ[2114]); $e³áé‚ˆå[$fÆ‰”ÌÜ[2109]] = LNG($fÆ‰”ÌÜ[2115]); goto C·ÒœŠ‚àš; B½•‡‹Á¸: $fÆ‰”ÌÜ =& $_SERVER[ªúæÂ¡­ä½]; $e³áé‚ˆå = $this->typeList; $A†İ†ì¯Š = array_filter($this->typeFile()); goto AÙäŒŒÄ¬¢; C·ÒœŠ‚àš: return $e³áé‚ˆå; goto E’Ò„ŞØîß; E’Ò„ŞØîß: } public function addLog($EåÃÌÓµ¤Ğ, $f†´¯åàÌ‘ = array()) { goto C‡ò¥à„…; D¼÷Á˜ëÕ: if (!$fã’İóÁ¡) { $fã’İóÁ¡ = (int) Session::get($a…ÎÊ³Äˆ[1845]); } $E¶Áã¶Š = get_client_ip(); if (!$f†´¯åàÌ‘ || strlen(json_encode($f†´¯åàÌ‘)) >= 1024) { $f†´¯åàÌ‘ = array($a…ÎÊ³Äˆ[2116] => $E¶Áã¶Š); } else { if (is_array($f†´¯åàÌ‘)) { $f†´¯åàÌ‘[$a…ÎÊ³Äˆ[2116]] = $E¶Áã¶Š; } else { $f†´¯åàÌ‘ = array($a…ÎÊ³Äˆ[1103] => $f†´¯åàÌ‘, $a…ÎÊ³Äˆ[2116] => $E¶Áã¶Š); } } goto F‰ĞËå„ä; F‰ĞËå„ä: $f†´¯åàÌ‘ = array($a…ÎÊ³Äˆ[1535] => Session::sign(), $a…ÎÊ³Äˆ[1536] => $fã’İóÁ¡, $a…ÎÊ³Äˆ[29] => $EåÃÌÓµ¤Ğ, $a…ÎÊ³Äˆ[1538] => json_encode($f†´¯åàÌ‘)); parent::add($f†´¯åàÌ‘); goto FÕíÃ§ˆ…; C‡ò¥à„…: $a…ÎÊ³Äˆ =& $_SERVER[ªúæÂ¡­ä½]; if (!isset($this->typeList[$EåÃÌÓµ¤Ğ])) { return; } $fã’İóÁ¡ = defined($a…ÎÊ³Äˆ[455]) && USER_ID ? USER_ID : (isset($f†´¯åàÌ‘[$a…ÎÊ³Äˆ[1545]]) ? $f†´¯åàÌ‘[$a…ÎÊ³Äˆ[1545]] : 0); goto D¼÷Á˜ëÕ; FÕíÃ§ˆ…: } public function remove($BÒ“¯ÃÉÃ) { $this->where(array($_SERVER[ªúæÂ¡­ä½][413] => $BÒ“¯ÃÉÃ))->delete(); } private function _makeOrder($cé×ÖÄ®Í = '') { goto dì‚ º«Ã; A ƒªŠÃôÜ: return $this->order($cé×ÖÄ®Í); goto d¨Ûß‘­ò; dì‚ º«Ã: $dÒÇ“¤øàÃ =& $_SERVER[ªúæÂ¡­ä½]; $aÚ¨ëğó’ = $dÒÇ“¤øàÃ[194]; $fÂ‘§ĞãÍŠ = array($dÒÇ“¤øàÃ[429] => $dÒÇ“¤øàÃ[430], $dÒÇ“¤øàÃ[431] => $dÒÇ“¤øàÃ[432]); goto a×÷ç•İ¸ƒ; a×÷ç•İ¸ƒ: $Bâá¹†À¡ = Input::get($dÒÇ“¤øàÃ[437], $dÒÇ“¤øàÃ[7], $dÒÇ“¤øàÃ[1877], array($dÒÇ“¤øàÃ[1801], $dÒÇ“¤øàÃ[431])); $Bâá¹†À¡ = $fÂ‘§ĞãÍŠ[$Bâá¹†À¡]; $cé×ÖÄ®Í = $cé×ÖÄ®Í . "{$aÚ¨ëğó’}\x20{$Bâá¹†À¡}"; goto A ƒªŠÃôÜ; d¨Ûß‘­ò: } public function get($d«Ğ•…îÁ = '') { goto B¦ïÍò®è­; f‚Ìôãï‡ò: $cçâ‰“è£…[$D‚ô£™°»Ë[367]] = $this->logList($cçâ‰“è£…[$D‚ô£™°»Ë[367]]); return $cçâ‰“è£…; goto DÅá†Ü…­ö; A®ØŠ‹Õò: if ($d«Ğ•…îÁ[$D‚ô£™°»Ë[1545]]) { $cÔˆÒ¸©ïö[$D‚ô£™°»Ë[1545]] = $d«Ğ•…îÁ[$D‚ô£™°»Ë[1545]]; } if (isset($d«Ğ•…îÁ[$D‚ô£™°»Ë[739]])) { $c¸‡Ï°Ş–º = $d«Ğ•…îÁ[$D‚ô£™°»Ë[739]]; $D‚¢ä³íˆÉ = isset($d«Ğ•…îÁ[$D‚ô£™°»Ë[477]]) ? $d«Ğ•…îÁ[$D‚ô£™°»Ë[477]] : time(); $cÔˆÒ¸©ïö[$D‚ô£™°»Ë[194]] = array($D‚ô£™°»Ë[331], array($c¸‡Ï°Ş–º, $D‚¢ä³íˆÉ)); } if ($d«Ğ•…îÁ[$D‚ô£™°»Ë[29]]) { $F¼¼Ò¬éè = explode($D‚ô£™°»Ë[47], $d«Ğ•…îÁ[$D‚ô£™°»Ë[29]]); $FÕĞ²¾é³î = $this->typeFile(); $AË¾‰Ù¡Ä„ = array(); foreach ($F¼¼Ò¬éè as $aç©òÉÃœË) { $AË¾‰Ù¡Ä„[] = $aç©òÉÃœË; if (isset($FÕĞ²¾é³î[$aç©òÉÃœË])) { $AË¾‰Ù¡Ä„ = array_merge($AË¾‰Ù¡Ä„, $FÕĞ²¾é³î[$aç©òÉÃœË]); } } $AË¾‰Ù¡Ä„ = array_unique($AË¾‰Ù¡Ä„); if ($AË¾‰Ù¡Ä„) { $cÔˆÒ¸©ïö[$D‚ô£™°»Ë[29]] = array($D‚ô£™°»Ë[7], $AË¾‰Ù¡Ä„); } } else { $cÔˆÒ¸©ïö[$D‚ô£™°»Ë[29]] = array($D‚ô£™°»Ë[2117], $D‚ô£™°»Ë[2118]); } goto BïÑ¥™³­Ä; B¦ïÍò®è­: $D‚ô£™°»Ë =& $_SERVER[ªúæÂ¡­ä½]; if (!$d«Ğ•…îÁ) { show_json(array()); } $cÔˆÒ¸©ïö = array(); goto A®ØŠ‹Õò; BïÑ¥™³­Ä: if (!empty($d«Ğ•…îÁ[$D‚ô£™°»Ë[2116]])) { $cÔˆÒ¸©ïö[$D‚ô£™°»Ë[432]] = array($D‚ô£™°»Ë[380], "\x25{$d«Ğ•…îÁ[$D‚ô£™°»Ë[2116]]}\x25"); } $cçâ‰“è£… = $this->_makeOrder()->where($cÔˆÒ¸©ïö)->selectPage(); if (empty($cçâ‰“è£…[$D‚ô£™°»Ë[367]])) { show_json(array(), !0, $cçâ‰“è£…[$D‚ô£™°»Ë[364]]); } goto f‚Ìôãï‡ò; DÅá†Ü…­ö: } private function ipAddress(&$c…¹Í¤“óÇ) { $dè¾ŒÔùï =& $_SERVER[ªúæÂ¡­ä½]; if (!empty($c…¹Í¤“óÇ[$dè¾ŒÔùï[2116]])) { $dŒØ±˜‹Æ = IpLocation::get($c…¹Í¤“óÇ[$dè¾ŒÔùï[2116]]); } else { $dŒØ±˜‹Æ = LNG($dè¾ŒÔùï[2119]); } $c…¹Í¤“óÇ[$dè¾ŒÔùï[2120]] = $dŒØ±˜‹Æ; } private function descZipDownload($F¡šâ¨×ÅÏ, &$D¯öŒˆÎâÑ) { $dŒùæ®æãœ =& $_SERVER[ªúæÂ¡­ä½]; if (!isset($F¡šâ¨×ÅÏ[$dŒùæ®æãœ[2121]])) { return; } $eË­’Ğ¯Æ” = json_decode($F¡šâ¨×ÅÏ[$dŒùæ®æãœ[2121]], !0); foreach ($eË­’Ğ¯Æ” as $e¶µÀªË©É) { try { $BÙÇ¨µõ¼© = IO::infoFull($e¶µÀªË©É[$dŒùæ®æãœ[76]]); } catch (Exception $EÓÃ‡¨‘ÌÇ) { continue; } $F¡šâ¨×ÅÏ[$dŒùæ®æãœ[76]] = $e¶µÀªË©É[$dŒùæ®æãœ[76]]; $D¯öŒˆÎâÑ[] = $F¡šâ¨×ÅÏ[$dŒùæ®æãœ[396]] = $BÙÇ¨µõ¼©[$dŒùæ®æãœ[396]]; $D¯öŒˆÎâÑ[] = $F¡šâ¨×ÅÏ[$dŒùæ®æãœ[1932]] = $BÙÇ¨µõ¼©[$dŒùæ®æãœ[479]]; break; } return $F¡šâ¨×ÅÏ; } private function getSourceList(&$E˜¡ªã™ßë) { $céğŸ—–Òò =& $_SERVER[ªúæÂ¡­ä½]; $F¿óä†«‚ = array(); foreach ($E˜¡ªã™ßë as $f´Ö“¢å¯³ => $c°´‚ÚäÑ) { goto fÀÀ„­Øáî; AÒô¼‚¿˜­: $F¿óä†«‚[] = $bñ‡„£ŠŞ±[$céğŸ—–Òò[396]]; $F¿óä†«‚[] = $bñ‡„£ŠŞ±[$céğŸ—–Òò[1932]]; if ($bñ‡„£ŠŞ±[$céğŸ—–Òò[29]] == $céğŸ—–Òò[534]) { $F¿óä†«‚[] = $bñ‡„£ŠŞ±[$céğŸ—–Òò[432]][$céğŸ—–Òò[1070]]; $F¿óä†«‚[] = $bñ‡„£ŠŞ±[$céğŸ—–Òò[432]][$céğŸ—–Òò[1071]]; } goto fšÖß´à¢Ÿ; fÀÀ„­Øáî: $bñ‡„£ŠŞ± = json_decode($c°´‚ÚäÑ[$céğŸ—–Òò[432]], !0); if ($c°´‚ÚäÑ[$céğŸ—–Òò[29]] == $céğŸ—–Òò[1685]) { $bñ‡„£ŠŞ± = $this->descZipDownload($bñ‡„£ŠŞ±, $F¿óä†«‚); $E˜¡ªã™ßë[$f´Ö“¢å¯³][$céğŸ—–Òò[432]] = json_encode($bñ‡„£ŠŞ±); continue; } if (strpos($c°´‚ÚäÑ[$céğŸ—–Òò[29]], $céğŸ—–Òò[1933]) !== 0) { if (!isset($bñ‡„£ŠŞ±[$céğŸ—–Òò[76]]) || strpos($c°´‚ÚäÑ[$céğŸ—–Òò[29]], $céğŸ—–Òò[2122]) !== 0) { continue; } try { $c¹²ÓøÖøŞ = IO::infoFull($bñ‡„£ŠŞ±[$céğŸ—–Òò[76]]); } catch (Exception $aè©½šì«) { continue; } $F¿óä†«‚[] = $bñ‡„£ŠŞ±[$céğŸ—–Òò[396]] = $c¹²ÓøÖøŞ[$céğŸ—–Òò[396]]; $F¿óä†«‚[] = $bñ‡„£ŠŞ±[$céğŸ—–Òò[1932]] = $c¹²ÓøÖøŞ[$céğŸ—–Òò[479]]; $E˜¡ªã™ßë[$f´Ö“¢å¯³][$céğŸ—–Òò[432]] = json_encode($bñ‡„£ŠŞ±); continue; } goto AÒô¼‚¿˜­; fšÖß´à¢Ÿ: if ($bñ‡„£ŠŞ±[$céğŸ—–Òò[29]] == $céğŸ—–Òò[1940]) { $F¿óä†«‚[] = $bñ‡„£ŠŞ±[$céğŸ—–Òò[432]][$céğŸ—–Òò[396]]; } goto F¤ÅîÜøƒ; F¤ÅîÜøƒ: } if (!$F¿óä†«‚) { return array(); } return Model($céğŸ—–Òò[808])->sourceListInfo($F¿óä†«‚, !0); } private function logList($Dê¢ÂˆÕÈ‡) { goto eÊ½¦Ô‰µ; fÔ“©¥†ï‡: return $E¤ ŠÒİ„î; goto DÕŸˆÏéÏ¨; f±Å³ŒğØ: $FÎ¨êÃÊ§õ = $this->getSourceList($Dê¢ÂˆÕÈ‡); $e–¾Ÿë„Ãé = $this->typeAll(); $E¤ ŠÒİ„î = array(); goto e¥‡Şì¨Ãà; e¥‡Şì¨Ãà: $E—‚ƒÌÍµ = array(); foreach ($Dê¢ÂˆÕÈ‡ as $d®‰ÄÆ¥®Š => $AïĞ½¬¯ÚÓ) { goto b„“ÅÓÎŒÔ; Eˆ‡Ö»Ê: $this->ipAddress($AïĞ½¬¯ÚÓ); if (strpos($eÄ•²ø—»ö, $eùÓîèô¾[1933]) === 0 || isset($dÊ°‚ÑŠô‹[$eùÓîèô¾[1932]])) { goto d½±‹Á™ä”; d½±‹Á™ä”: $dÊ°‚ÑŠô‹[$eùÓîèô¾[85]] = $FÎ¨êÃÊ§õ[$dÊ°‚ÑŠô‹[$eùÓîèô¾[396]]]; $dÊ°‚ÑŠô‹[$eùÓîèô¾[1945]] = $FÎ¨êÃÊ§õ[$dÊ°‚ÑŠô‹[$eùÓîèô¾[1932]]]; if ($dÊ°‚ÑŠô‹[$eùÓîèô¾[29]] == $eùÓîèô¾[534]) { $dÊ°‚ÑŠô‹[$eùÓîèô¾[432]][$eùÓîèô¾[1070]] = $FÎ¨êÃÊ§õ[$dÊ°‚ÑŠô‹[$eùÓîèô¾[432]][$eùÓîèô¾[1070]]]; $dÊ°‚ÑŠô‹[$eùÓîèô¾[432]][$eùÓîèô¾[1071]] = $FÎ¨êÃÊ§õ[$dÊ°‚ÑŠô‹[$eùÓîèô¾[432]][$eùÓîèô¾[1071]]]; } goto bç„ƒ¸™º; bç„ƒ¸™º: if ($dÊ°‚ÑŠô‹[$eùÓîèô¾[29]] == $eùÓîèô¾[1940]) { $dÊ°‚ÑŠô‹[$eùÓîèô¾[432]][$eùÓîèô¾[396]] = $FÎ¨êÃÊ§õ[$dÊ°‚ÑŠô‹[$eùÓîèô¾[432]][$eùÓîèô¾[396]]]; } if ($dÊ°‚ÑŠô‹[$eùÓîèô¾[29]] == $eùÓîèô¾[1680]) { $dÊ°‚ÑŠô‹[$eùÓîèô¾[1945]] = $dÊ°‚ÑŠô‹[$eùÓîèô¾[85]]; $dÊ°‚ÑŠô‹[$eùÓîèô¾[1932]] = $dÊ°‚ÑŠô‹[$eùÓîèô¾[1945]][$eùÓîèô¾[396]]; $dÊ°‚ÑŠô‹[$eùÓîèô¾[85]] = !1; $dÊ°‚ÑŠô‹[$eùÓîèô¾[396]] = $eùÓîèô¾[33]; } if ($dÊ°‚ÑŠô‹[$eùÓîèô¾[85]] && $dÊ°‚ÑŠô‹[$eùÓîèô¾[85]][$eùÓîèô¾[405]] == $eùÓîèô¾[1186]) { $E—‚ƒÌÍµ[] = $AïĞ½¬¯ÚÓ[$eùÓîèô¾[394]]; unset($Dê¢ÂˆÕÈ‡[$d®‰ÄÆ¥®Š]); continue; } goto aä‘™Ä¥Ú; aä‘™Ä¥Ú: if ($dÊ°‚ÑŠô‹[$eùÓîèô¾[1945]] && $dÊ°‚ÑŠô‹[$eùÓîèô¾[1945]][$eùÓîèô¾[405]] == $eùÓîèô¾[1186]) { $E—‚ƒÌÍµ[] = $AïĞ½¬¯ÚÓ[$eùÓîèô¾[394]]; unset($Dê¢ÂˆÕÈ‡[$d®‰ÄÆ¥®Š]); continue; } goto BéìñÆÀËƒ; BéìñÆÀËƒ: } $AïĞ½¬¯ÚÓ[$eùÓîèô¾[432]] = $dÊ°‚ÑŠô‹; goto e—ô âãß; b„“ÅÓÎŒÔ: $eÄ•²ø—»ö = $AïĞ½¬¯ÚÓ[$eùÓîèô¾[29]]; $f¸†ÆøÉ“ = isset($eÜ¬ÌõÖò[$AïĞ½¬¯ÚÓ[$eùÓîèô¾[1545]]]) ? $eÜ¬ÌõÖò[$AïĞ½¬¯ÚÓ[$eùÓîèô¾[1545]]] : !1; $c÷«…¾¸…â = strpos($eÄ•²ø—»ö, $eùÓîèô¾[2123]) === 0 ? LNG($eùÓîèô¾[2124]) : LNG($eùÓîèô¾[2119]); goto d”ÛÑ¥Úàå; e—ô âãß: unset($AïĞ½¬¯ÚÓ[$eùÓîèô¾[2125]]); $E¤ ŠÒİ„î[] = $AïĞ½¬¯ÚÓ; goto bø÷öÚ“«˜; d”ÛÑ¥Úàå: $AïĞ½¬¯ÚÓ[$eùÓîèô¾[28]] = isset($f¸†ÆøÉ“[$eùÓîèô¾[28]]) ? $f¸†ÆøÉ“[$eùÓîèô¾[28]] : LNG($eùÓîèô¾[2119]); $AïĞ½¬¯ÚÓ[$eùÓîèô¾[1982]] = isset($f¸†ÆøÉ“[$eùÓîèô¾[1982]]) ? $f¸†ÆøÉ“[$eùÓîèô¾[1982]] : $eùÓîèô¾[33]; $AïĞ½¬¯ÚÓ[$eùÓîèô¾[1445]] = isset($e–¾Ÿë„Ãé[$eÄ•²ø—»ö]) ? $e–¾Ÿë„Ãé[$eÄ•²ø—»ö] : $c÷«…¾¸…â; goto EÏ¯È×Ìîß; EÏ¯È×Ìîß: $AïĞ½¬¯ÚÓ[$eùÓîèô¾[1876]] = $f¸†ÆøÉ“; $dÊ°‚ÑŠô‹ = json_decode($AïĞ½¬¯ÚÓ[$eùÓîèô¾[432]], !0); $AïĞ½¬¯ÚÓ[$eùÓîèô¾[2116]] = isset($dÊ°‚ÑŠô‹[$eùÓîèô¾[2116]]) ? $dÊ°‚ÑŠô‹[$eùÓîèô¾[2116]] : $eùÓîèô¾[33]; goto Eˆ‡Ö»Ê; bø÷öÚ“«˜: } $this->clearSystemPathLog($E—‚ƒÌÍµ); goto fÔ“©¥†ï‡; eÊ½¦Ô‰µ: $eùÓîèô¾ =& $_SERVER[ªúæÂ¡­ä½]; $dµ¡÷ğòÕ = array_to_keyvalue($Dê¢ÂˆÕÈ‡, $eùÓîèô¾[33], $eùÓîèô¾[1545]); $eÜ¬ÌõÖò = Model($eùÓîèô¾[520])->userListInfo(array_unique($dµ¡÷ğòÕ)); goto f±Å³ŒğØ; DÕŸˆÏéÏ¨: } private function clearSystemPathLog($e‡ˆî·’·©) { $fƒÆßâ¢« =& $_SERVER[ªúæÂ¡­ä½]; if (count($e‡ˆî·’·©) == 0) { return; } $Fîæãİ¦ŒÅ = array($fƒÆßâ¢«[394] => array($fƒÆßâ¢«[7], array_unique($e‡ˆî·’·©))); $this->where($Fîæãİ¦ŒÅ)->delete(); } public function deviceList($EÄ¯’ï¶¿, $EÀ¿¡¦ïÁ = 0) { $bğä éØ¼ =& $_SERVER[ªúæÂ¡­ä½]; $FÉëãæ´ƒá = array($bğä éØ¼[1545] => $EÄ¯’ï¶¿, $bğä éØ¼[194] => array($bğä éØ¼[988], $EÀ¿¡¦ïÁ), $bğä éØ¼[29] => $bğä éØ¼[1654]); $C»ä½Ú‚’´ = array(); $bæ³‰œé£õ = $this->field($bğä éØ¼[2126])->where($FÉëãæ´ƒá)->order($bğä éØ¼[1943])->limit(50)->select(); foreach ($bæ³‰œé£õ as $eÁÙäÒŒ† => $e”ñÄŸãƒ¦) { goto bƒÆ›¾á; bƒÆ›¾á: if ($eÁÙäÒŒ† > 0 && abs($e”ñÄŸãƒ¦[$bğä éØ¼[194]] - $bæ³‰œé£õ[$eÁÙäÒŒ† - 1][$bğä éØ¼[194]]) < 5) { continue; } $eÙÊÚİğŒ¶ = json_decode($e”ñÄŸãƒ¦[$bğä éØ¼[432]], !0); $e”ñÄŸãƒ¦[$bğä éØ¼[2116]] = isset($eÙÊÚİğŒ¶[$bğä éØ¼[2116]]) ? $eÙÊÚİğŒ¶[$bğä éØ¼[2116]] : $bğä éØ¼[33]; goto DÖ‘ù‚§ï¸; DÖ‘ù‚§ï¸: unset($eÙÊÚİğŒ¶[$bğä éØ¼[2116]]); $e”“ÜÒíÚ¡ = $this->deviceType($eÙÊÚİğŒ¶[$bğä éØ¼[1934]]); if (isset($C»ä½Ú‚’´[$e”“ÜÒíÚ¡])) { continue; } goto EçßÔ†‡™; EçßÔ†‡™: $this->ipAddress($e”ñÄŸãƒ¦); $e”ñÄŸãƒ¦[$bğä éØ¼[432]] = $eÙÊÚİğŒ¶; $C»ä½Ú‚’´[$e”“ÜÒíÚ¡] = $e”ñÄŸãƒ¦; goto dßõ¤¼¿®ğ; dßõ¤¼¿®ğ: } return array_values($C»ä½Ú‚’´); } public function deviceType($aš’ùà¢Ñ†) { return $aš’ùà¢Ñ†; } } class SystemNoticeModel extends ModelBaseLight { public $optionType = "\123\171\x73\164\x65\155\x2e\x6e\157\164\x69\143\145\x4c\x69\163\164"; public $field = array("\x6e\141\x6d\145", "\x63\157\156\164\145\x6e\x74", "\x61\x75\164\x68", "\x6d\x6f\x64\x65", "\164\x69\155\x65", "\164\171\x70\x65", "\154\145\166\145\x6c", "\145\x6e\x61\x62\x6c\x65", "\163\x6f\162\164"); public function listData($e¸±»Øæ = false, $Fç†¥ÓœÑ = "\x73\157\x72\164", $cø¦˜§êóƒ = false) { return parent::listData($e¸±»Øæ, $Fç†¥ÓœÑ, $cø¦˜§êóƒ); } public function add($D¬„ì†…Ï) { $cÑ…¿¶ñ =& $_SERVER[ªúæÂ¡­ä½]; $cÏàæßß°õ = time(); if ($D¬„ì†…Ï[$cÑ…¿¶ñ[12]] == $cÑ…¿¶ñ[2127]) { $cÏàæßß°õ = strtotime($D¬„ì†…Ï[$cÑ…¿¶ñ[197]]); } $D¬„ì†…Ï[$cÑ…¿¶ñ[197]] = $cÏàæßß°õ; return parent::insert($D¬„ì†…Ï); } public function update($bœ¨ªöùéÇ, $a„×¶½‚ã˜) { goto dùìå‡“µ; døÎŞäÓßÊ: return parent::update($bœ¨ªöùéÇ, $a„×¶½‚ã˜); goto eŠØŸÑÓµ; dùìå‡“µ: $Fğî‹ë˜Çé =& $_SERVER[ªúæÂ¡­ä½]; $eŸ£ñõ¿­˜ = $this->listData($bœ¨ªöùéÇ); if (!$eŸ£ñõ¿­˜) { return !1; } goto CÅÕß¤Ôø; CÅÕß¤Ôø: $cõÀ“¹¿‰È = time(); if ($a„×¶½‚ã˜[$Fğî‹ë˜Çé[12]] == $Fğî‹ë˜Çé[2127]) { $cõÀ“¹¿‰È = strtotime($a„×¶½‚ã˜[$Fğî‹ë˜Çé[197]]); } $a„×¶½‚ã˜[$Fğî‹ë˜Çé[197]] = $cõÀ“¹¿‰È; goto døÎŞäÓßÊ; eŠØŸÑÓµ: } public function remove($BŠõ”öÔí) { $AğùÏõë¹» = $this->listData($BŠõ”öÔí); if (!$AğùÏõë¹» || $AğùÏõë¹»[$_SERVER[ªúæÂ¡­ä½][1186]]) { return !1; } return parent::remove($BŠõ”öÔí); } public function sort($bÇå‘ğ™Ô¬, $B»İƒÍ‚Œ¢) { return parent::update($bÇå‘ğ™Ô¬, $B»İƒÍ‚Œ¢); } public function enable($c‰ßÒİò–÷, $B‡ˆÜ‰Ô™) { return parent::update($c‰ßÒİò–÷, array($_SERVER[ªúæÂ¡­ä½][2128] => $B‡ˆÜ‰Ô™)); } private function initUserOption() { $Aî£“˜÷‡‚ =& $_SERVER[ªúæÂ¡­ä½]; $this->optionType = $Aî£“˜÷‡‚[2129]; $this->modelType = $Aî£“˜÷‡‚[2130]; $this->field = array($Aî£“˜÷‡‚[2131], $Aî£“˜÷‡‚[28], $Aî£“˜÷‡‚[197], $Aî£“˜÷‡‚[29], $Aî£“˜÷‡‚[2132], $Aî£“˜÷‡‚[728], $Aî£“˜÷‡‚[189]); } public function userNoticeGet($aõ…Ëö¨´ = false) { $this->initUserOption(); return parent::listData($aõ…Ëö¨´, $_SERVER[ªúæÂ¡­ä½][394], !0); } public function userNoticeAdd($F–ĞÉ«‰”“) { $E´‚çµëêº =& $_SERVER[ªúæÂ¡­ä½]; $this->initUserOption(); $c‹„”ÔšÓ = $this->findByKey($E´‚çµëêº[2131], $F–ĞÉ«‰”“[$E´‚çµëêº[394]]); if ($c‹„”ÔšÓ) { return !0; } $D¢—­¶ÈùÊ = array($E´‚çµëêº[2131] => $F–ĞÉ«‰”“[$E´‚çµëêº[394]], $E´‚çµëêº[28] => $F–ĞÉ«‰”“[$E´‚çµëêº[28]], $E´‚çµëêº[197] => $F–ĞÉ«‰”“[$E´‚çµëêº[197]], $E´‚çµëêº[29] => isset($F–ĞÉ«‰”“[$E´‚çµëêº[29]]) ? $F–ĞÉ«‰”“[$E´‚çµëêº[29]] : 1, $E´‚çµëêº[2132] => isset($F–ĞÉ«‰”“[$E´‚çµëêº[2132]]) ? $F–ĞÉ«‰”“[$E´‚çµëêº[2132]] : 0, $E´‚çµëêº[728] => 0, $E´‚çµëêº[189] => 0); return parent::insert($D¢—­¶ÈùÊ); } public function userNoticeEdit($fÆÛâñø™·, $f’œ’Œ–¹ä) { $this->initUserOption(); return parent::update($fÆÛâñø™·, $f’œ’Œ–¹ä); } } class SystemOptionModel extends ModelBaseOption { protected $tableName = "\x73\x79\x73\164\145\x6d\137\157\160\x74\151\x6f\x6e"; protected $jsonField = array("\x6d\145\156\x75", "\x72\x6f\154\x65", "\162\x6f\x6c\x65\x47\162\x6f\x75\x70", "\162\145\147\151\x73\164", "\145\155\141\151\x6c"); function __construct() { parent::__construct(); } protected function cacheKey($cÅ÷é–ï—¼) { return "\x53\x79\x73\164\x65\x6d\117\x70\164\151\157\x6e\x5f{$cÅ÷é–ï—¼}"; } protected function optionDefault($bêç´Äø‹æ = '') { $D¦”å‡İ =& $_SERVER[ªúæÂ¡­ä½]; if ($bêç´Äø‹æ == $D¦”å‡İ[33]) { return $GLOBALS[$D¦”å‡İ[6]][$D¦”å‡İ[378]]; } } } goto bÁÑ¤Ç†õİ; b åµˆß‡Ü: class Controller extends ClassBaseCall { public $in; public $config; public $tpl; public $values; function __construct() { goto f­Èâ£©Æë; f­Èâ£©Æë: $d§à§Ô‚×Ã =& $_SERVER[ªúæÂ¡­ä½]; global $in, $config; $this->config =& $config; goto a‡Ğ×¥”¸æ; a‡Ğ×¥”¸æ: $this->in =& $in; $this->values[$d§à§Ô‚×Ã[6]] =& $config; $this->values[$d§à§Ô‚×Ã[7]] =& $in; goto cŸ‰‡Î; cŸ‰‡Î: $this->tpl = TEMPLATE . MOD . $d§à§Ô‚×Ã[8]; $this->_classObjectID = mt_rand(0, 10000); goto A“ğÓä´ñÂ; A“ğÓä´ñÂ: } public function loadClass($B–—â…ê„) { if (1 === func_num_args()) { $this->{$B–—â…ê„} = new $B–—â…ê„(); } else { $d°„†µ«Ì = new ReflectionClass($B–—â…ê„); $D„Ø®îÄé¡ = func_get_args(); array_shift($D„Ø®îÄé¡); $this->{$B–—â…ê„} = $d°„†µ«Ì->newInstanceArgs($D„Ø®îÄé¡); } return $this->{$B–—â…ê„}; } protected function assign($d„¾òŞ¼Ú¥, $FğÊóÃìÁö) { $this->values[$d„¾òŞ¼Ú¥] = $FğÊóÃìÁö; } protected function display($F„öŒÓ»Ñ) { ob_end_clean(); extract($this->values); require $this->tpl . $F„öŒÓ»Ñ; } } class DbSqliteBase extends Db { public function __construct($a§ÍÙ³œÌİ = '') { $C«¶«”˜õ =& $_SERVER[ªúæÂ¡­ä½]; if (!extension_loaded($C«¶«”˜õ[9])) { think_exception(think_lang($C«¶«”˜õ[10]) . $C«¶«”˜õ[11]); } if (!empty($a§ÍÙ³œÌİ)) { if (!isset($a§ÍÙ³œÌİ[$C«¶«”˜õ[12]])) { $a§ÍÙ³œÌİ[$C«¶«”˜õ[12]] = 438; } $this->config = $a§ÍÙ³œÌİ; if (empty($this->config[$C«¶«”˜õ[13]])) { $this->config[$C«¶«”˜õ[13]] = array(); } } } public function connect($C…¥ğá£ù = '', $aùñ ùÕŞ = 0) { $FÈ´‹ßŒ¦‚ =& $_SERVER[ªúæÂ¡­ä½]; if (!isset($this->linkID[$aùñ ùÕŞ])) { goto b†ÜÌø²õ; b†ÜÌø²õ: if (empty($C…¥ğá£ù)) { $C…¥ğá£ù = $this->config; } $dò¯¸ØË©ù = !empty($C…¥ğá£ù[$FÈ´‹ßŒ¦‚[13]][$FÈ´‹ßŒ¦‚[14]]) ? $C…¥ğá£ù[$FÈ´‹ßŒ¦‚[13]][$FÈ´‹ßŒ¦‚[14]] : $this->pconnect; $FáÇÍµ”ÁÃ = $dò¯¸ØË©ù ? $FÈ´‹ßŒ¦‚[15] : $FÈ´‹ßŒ¦‚[16]; goto d§¤ïœ°¦ä; aæóÄ„ğô‡: @sqlite_busy_timeout($this->linkID[$aùñ ùÕŞ], 30000); if (1 != think_config($FÈ´‹ßŒ¦‚[18])) { unset($this->config); } goto bŒ…ÁÅŒÇó; d§¤ïœ°¦ä: $this->linkID[$aùñ ùÕŞ] = $FáÇÍµ”ÁÃ($C…¥ğá£ù[$FÈ´‹ßŒ¦‚[17]], $C…¥ğá£ù[$FÈ´‹ßŒ¦‚[12]]); if (!$this->linkID[$aùñ ùÕŞ]) { think_exception(sqlite_error_string()); } $this->connected = !0; goto aæóÄ„ğô‡; bŒ…ÁÅŒÇó: } return $this->linkID[$aùñ ùÕŞ]; } public function free() { $this->queryID = null; } public function query($bÂçò¥ÏŸ ) { goto D•¬ä‚ó¹…; dëÁ¾ó¤‰: $this->queryStr = $bÂçò¥ÏŸ ; if ($this->queryID) { $this->free(); } think_action_status($F‰Š¦Ùˆî×[19], 1); goto a·ëëÆ‡Òæ; Eº –¬–Å¬: if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = sqlite_num_rows($this->queryID); $E¥¹‹ŞÆ‰Â = $this->getAll(); return $E¥¹‹ŞÆ‰Â; } goto cÍÈŒÈ¤á; D•¬ä‚ó¹…: $F‰Š¦Ùˆî× =& $_SERVER[ªúæÂ¡­ä½]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto dëÁ¾ó¤‰; a·ëëÆ‡Òæ: think_status($F‰Š¦Ùˆî×[20]); $this->queryID = sqlite_query($this->_linkID, $bÂçò¥ÏŸ ); $this->debug(); goto Eº –¬–Å¬; cÍÈŒÈ¤á: } public function execute($c¬Ê—ÒŒ¢…) { goto a³³É’óé; FÌ†¦æ¹ÉÎ: think_status($eÁª×ÛÅòª[20]); $cñ§¼Á™ÎÊ = sqlite_exec($this->_linkID, $c¬Ê—ÒŒ¢…); $this->debug(); goto f½¾ß–õ£Ÿ; a³³É’óé: $eÁª×ÛÅòª =& $_SERVER[ªúæÂ¡­ä½]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto eÌ¦ëšÏğŠ; eÌ¦ëšÏğŠ: $this->queryStr = $c¬Ê—ÒŒ¢…; if ($this->queryID) { $this->free(); } think_action_status($eÁª×ÛÅòª[21], 1); goto FÌ†¦æ¹ÉÎ; f½¾ß–õ£Ÿ: if (!1 === $cñ§¼Á™ÎÊ) { $this->error(); return !1; } else { $this->numRows = sqlite_changes($this->_linkID); $this->lastInsID = sqlite_last_insert_rowid($this->_linkID); return $this->numRows; } goto Dá‡³ƒà»·; Dá‡³ƒà»·: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { sqlite_query($this->_linkID, $_SERVER[ªúæÂ¡­ä½][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $eÑÇ›ˆ±œ± = sqlite_query($this->_linkID, $_SERVER[ªúæÂ¡­ä½][23]); if (!$eÑÇ›ˆ±œ±) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $aÏ©£Œ›á± = sqlite_query($this->_linkID, $_SERVER[ªúæÂ¡­ä½][24]); if (!$aÏ©£Œ›á±) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $Eç‡¹ˆ•ƒô = array(); if ($this->numRows > 0) { for ($A´£é¼—ÄŒ = 0; $A´£é¼—ÄŒ < $this->numRows; $A´£é¼—ÄŒ++) { $Eç‡¹ˆ•ƒô[$A´£é¼—ÄŒ] = sqlite_fetch_array($this->queryID, SQLITE_ASSOC); } sqlite_seek($this->queryID, 0); } return $Eç‡¹ˆ•ƒô; } public function getFields($b¾àÛêÈ…•) { $E÷ôÒçÖ÷ =& $_SERVER[ªúæÂ¡­ä½]; $eÚ†Û×› = $this->query($E÷ôÒçÖ÷[25] . $b¾àÛêÈ…• . $E÷ôÒçÖ÷[26]); $Dæ­íÆ‡ = array(); if ($eÚ†Û×›) { foreach ($eÚ†Û×› as $dÚÄí–“¨Ö => $còÂŒ³Ñ») { $Dæ­íÆ‡[$còÂŒ³Ñ»[$E÷ôÒçÖ÷[27]]] = array($E÷ôÒçÖ÷[28] => $còÂŒ³Ñ»[$E÷ôÒçÖ÷[27]], $E÷ôÒçÖ÷[29] => $còÂŒ³Ñ»[$E÷ôÒçÖ÷[30]], $E÷ôÒçÖ÷[31] => (bool) ($còÂŒ³Ñ»[$E÷ôÒçÖ÷[32]] === $E÷ôÒçÖ÷[33]), $E÷ôÒçÖ÷[34] => $còÂŒ³Ñ»[$E÷ôÒçÖ÷[35]], $E÷ôÒçÖ÷[36] => strtolower($còÂŒ³Ñ»[$E÷ôÒçÖ÷[37]]) == $E÷ôÒçÖ÷[38], $E÷ôÒçÖ÷[39] => strtolower($còÂŒ³Ñ»[$E÷ôÒçÖ÷[40]]) == $E÷ôÒçÖ÷[41]); } } return $Dæ­íÆ‡; } public function getTables($eê­ğÊ·õ = '') { $B’çĞÑˆ°­ =& $_SERVER[ªúæÂ¡­ä½]; $Dâ¸‹¨ºÏ = $this->query($B’çĞÑˆ°­[42] . $B’çĞÑˆ°­[43] . $B’çĞÑˆ°­[44]); $d×±Õ¬Øæˆ = array(); foreach ($Dâ¸‹¨ºÏ as $fË°ÍÊ· => $a¯Ï§èà½…) { $d×±Õ¬Øæˆ[$fË°ÍÊ·] = current($a¯Ï§èà½…); } return $d×±Õ¬Øæˆ; } public function close() { if ($this->_linkID) { sqlite_close($this->_linkID); } $this->_linkID = null; } public function error() { $CÈ¢Ï²…Şø =& $_SERVER[ªúæÂ¡­ä½]; $f¹”åô¦ñ = sqlite_last_error($this->_linkID); $this->error = $f¹”åô¦ñ . $CÈ¢Ï²…Şø[4] . sqlite_error_string($f¹”åô¦ñ); if ($CÈ¢Ï²…Şø[33] != $this->queryStr) { $this->error .= LNG($CÈ¢Ï²…Şø[45]) . $this->queryStr; } think_trace($this->error, $CÈ¢Ï²…Şø[33], $CÈ¢Ï²…Şø[46]); return $this->error; } public function escapeString($C¬ó†˜ÍŠŸ) { return sqlite_escape_string($C¬ó†˜ÍŠŸ); } public function parseLimit($EèÛæ±‡­) { $eö³İŠØ =& $_SERVER[ªúæÂ¡­ä½]; $F«°†·è† = $eö³İŠØ[33]; if (!empty($EèÛæ±‡­)) { $EèÛæ±‡­ = explode($eö³İŠØ[47], $EèÛæ±‡­); if (count($EèÛæ±‡­) > 1) { $F«°†·è† .= $eö³İŠØ[48] . $EèÛæ±‡­[1] . $eö³İŠØ[49] . $EèÛæ±‡­[0] . $eö³İŠØ[50]; } else { $F«°†·è† .= $eö³İŠØ[48] . $EèÛæ±‡­[0] . $eö³İŠØ[50]; } } return $F«°†·è†; } } class DbSqlite3Base extends Db { public function __construct($e“¯ìæè = '') { $cÁöÌ³ÆÚË =& $_SERVER[ªúæÂ¡­ä½]; if (!class_exists($cÁöÌ³ÆÚË[51])) { think_exception(think_lang($cÁöÌ³ÆÚË[10]) . $cÁöÌ³ÆÚË[52]); } if (!empty($e“¯ìæè)) { if (!isset($e“¯ìæè[$cÁöÌ³ÆÚË[12]])) { $e“¯ìæè[$cÁöÌ³ÆÚË[12]] = 438; } $this->config = $e“¯ìæè; if (empty($this->config[$cÁöÌ³ÆÚË[13]])) { $this->config[$cÁöÌ³ÆÚË[13]] = array(); } } } public function connect($Dğ³Š‰æ»ó = '', $cŒğŞªã¡ = 0) { $fÍÏ›Õ°áì =& $_SERVER[ªúæÂ¡­ä½]; if (!isset($this->linkID[$cŒğŞªã¡])) { if (empty($Dğ³Š‰æ»ó)) { $Dğ³Š‰æ»ó = $this->config; } $this->linkID[$cŒğŞªã¡] = new SQLite3($Dğ³Š‰æ»ó[$fÍÏ›Õ°áì[17]]); if (!$this->linkID[$cŒğŞªã¡]) { think_exception($this->linkID[$cŒğŞªã¡]->lastErrorMsg()); } $this->connected = !0; @$this->linkID[$cŒğŞªã¡]->busyTimeout(30000); if (1 != think_config($fÍÏ›Õ°áì[18])) { unset($this->config); } } return $this->linkID[$cŒğŞªã¡]; } public function free() { $this->queryID = null; } public function query($e¨ÛøõÔ¹) { goto AÇ‘ˆèœ‹Ú; AÇ‘ˆèœ‹Ú: $Få¯…†Òñ± =& $_SERVER[ªúæÂ¡­ä½]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto CŒ×šçã­; eÃ§êøÔ¾ê: think_status($Få¯…†Òñ±[20]); $this->queryID = $this->_linkID->query($e¨ÛøõÔ¹); $this->debug(); goto D¬Üù´½Å´; CŒ×šçã­: $this->queryStr = $e¨ÛøõÔ¹; if ($this->queryID) { $this->free(); } think_action_status($Få¯…†Òñ±[19], 1); goto eÃ§êøÔ¾ê; D¬Üù´½Å´: if (!1 === $this->queryID) { $this->error(); return !1; } else { $BÓö¸£±‡ = $this->getAll(); $this->numRows = count($BÓö¸£±‡); return $BÓö¸£±‡; } goto F„ÜŸ‡¥ç; F„ÜŸ‡¥ç: } public function execute($d¡èÚˆÍÔ) { goto aÜ”óó°; dàÌ–Ñƒœ™: if (!1 === $fµÂ¢óãŒ) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->changes(); $this->lastInsID = $this->_linkID->lastInsertRowID(); return $this->numRows; } goto C“´ò‹çõš; d¸ØƒÌ¾·†: think_status($D½‰ÜìâéÌ[20]); $fµÂ¢óãŒ = $this->_linkID->exec($d¡èÚˆÍÔ); $this->debug(); goto dàÌ–Ñƒœ™; EÍÄ‡µÉ: $this->queryStr = $d¡èÚˆÍÔ; if ($this->queryID) { $this->free(); } think_action_status($D½‰ÜìâéÌ[21], 1); goto d¸ØƒÌ¾·†; aÜ”óó°: $D½‰ÜìâéÌ =& $_SERVER[ªúæÂ¡­ä½]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto EÍÄ‡µÉ; C“´ò‹çõš: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->query($_SERVER[ªúæÂ¡­ä½][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $B‚‡Ü¥Ê = $this->_linkID->query($_SERVER[ªúæÂ¡­ä½][23]); if (!$B‚‡Ü¥Ê) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $b„¼…Öø‚É = $this->_linkID->query($_SERVER[ªúæÂ¡­ä½][24]); if (!$b„¼…Öø‚É) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $B®¯¶‡©¢ = array(); while ($e‘·¼ÃÚè = $this->queryID->fetchArray(SQLITE3_ASSOC)) { $B®¯¶‡©¢[] = $e‘·¼ÃÚè; } $this->queryID->reset(); return $B®¯¶‡©¢; } public function getFields($A§ĞÑöò³–) { $B•¼áêÀŞ =& $_SERVER[ªúæÂ¡­ä½]; $b¹ˆï¬‰Ô = $this->query($B•¼áêÀŞ[25] . $A§ĞÑöò³– . $B•¼áêÀŞ[26]); $BğÃ„Ï‹µ = array(); if ($b¹ˆï¬‰Ô) { foreach ($b¹ˆï¬‰Ô as $Dù×â‹ä© => $déÒÜ‘¾¯«) { $BğÃ„Ï‹µ[$déÒÜ‘¾¯«[$B•¼áêÀŞ[28]]] = array($B•¼áêÀŞ[28] => $déÒÜ‘¾¯«[$B•¼áêÀŞ[28]], $B•¼áêÀŞ[29] => $déÒÜ‘¾¯«[$B•¼áêÀŞ[29]], $B•¼áêÀŞ[31] => (bool) ($déÒÜ‘¾¯«[$B•¼áêÀŞ[31]] === $B•¼áêÀŞ[33]), $B•¼áêÀŞ[34] => $déÒÜ‘¾¯«[$B•¼áêÀŞ[53]], $B•¼áêÀŞ[36] => (bool) $déÒÜ‘¾¯«[$B•¼áêÀŞ[54]], $B•¼áêÀŞ[39] => (bool) $déÒÜ‘¾¯«[$B•¼áêÀŞ[54]]); } } return $BğÃ„Ï‹µ; } public function getTables($a™‰‹¾ãŠæ = '') { $DÜ¼ñí±ŒŸ =& $_SERVER[ªúæÂ¡­ä½]; $fìØà®Ø˜— = $this->query($DÜ¼ñí±ŒŸ[42] . $DÜ¼ñí±ŒŸ[43] . $DÜ¼ñí±ŒŸ[44]); $eŞ„‚ì¦Ÿ‹ = array(); foreach ($fìØà®Ø˜— as $A½îòîÑ”ä => $C‰‹ÃãÙ™Ç) { $eŞ„‚ì¦Ÿ‹[$A½îòîÑ”ä] = current($C‰‹ÃãÙ™Ç); } return $eŞ„‚ì¦Ÿ‹; } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $D¦÷áæ¼„˜ =& $_SERVER[ªúæÂ¡­ä½]; $this->error = $this->_linkID->lastErrorMsg(); if ($D¦÷áæ¼„˜[33] != $this->queryStr) { $this->error .= LNG($D¦÷áæ¼„˜[45]) . $this->queryStr; } think_trace($this->error, $D¦÷áæ¼„˜[33], $D¦÷áæ¼„˜[46]); return $this->error; } public function escapeString($B¹÷’·À) { $EùÀæ–³á =& $_SERVER[ªúæÂ¡­ä½]; if ($this->_linkID) { return $this->_linkID->escapeString($B¹÷’·À); } return str_ireplace($EùÀæ–³á[55], $EùÀæ–³á[56], $B¹÷’·À); } public function parseLimit($Câˆé§˜È¶) { $EœÈÛ§Æ£† =& $_SERVER[ªúæÂ¡­ä½]; $BƒÓ“º¤Ãğ = $EœÈÛ§Æ£†[33]; if (!empty($Câˆé§˜È¶)) { $Câˆé§˜È¶ = explode($EœÈÛ§Æ£†[47], $Câˆé§˜È¶); if (count($Câˆé§˜È¶) > 1) { $BƒÓ“º¤Ãğ .= $EœÈÛ§Æ£†[48] . $Câˆé§˜È¶[1] . $EœÈÛ§Æ£†[49] . $Câˆé§˜È¶[0] . $EœÈÛ§Æ£†[50]; } else { $BƒÓ“º¤Ãğ .= $EœÈÛ§Æ£†[48] . $Câˆé§˜È¶[0] . $EœÈÛ§Æ£†[50]; } } return $BƒÓ“º¤Ãğ; } } goto e¨Éœ¿š‡Í; e¨Éœ¿š‡Í: class PathDriverBase { public $pathDriver = ''; public $pathBase = ''; public $path = ''; public $pathID = ''; public function __construct() { $F‡³¢´õÊ =& $_SERVER[ªúæÂ¡­ä½]; $this->objectDriver = array($F‡³¢´õÊ[57], $F‡³¢´õÊ[58], $F‡³¢´õÊ[59], $F‡³¢´õÊ[60], $F‡³¢´õÊ[61], $F‡³¢´õÊ[62], $F‡³¢´õÊ[63], $F‡³¢´õÊ[64], $F‡³¢´õÊ[65]); $this->_classObjectID = mt_rand(0, 10000); } public function getPath($aæ×’¬ÂœŒ) { if (in_array($this->getType(), $this->objectDriver)) { return ltrim($aæ×’¬ÂœŒ, $_SERVER[ªúæÂ¡­ä½][8]); } return $aæ×’¬ÂœŒ; } public function iconvApp($C·¢«­ˆóê) { return $C·¢«­ˆóê; } public function iconvSystem($Aç™ğÔçî) { return $Aç™ğÔçî; } public function iconvTo($FÏ’°Æ¥Ê, $e‹‘Œ–“Îò, $fñãà¼Û‹ˆ) { goto bî‡“º©´¤; B‹–Ÿƒ„ÔÚ: $d¨ÌĞÊƒçÎ = $d¨ÌĞÊƒçÎ ? $d¨ÌĞÊƒçÎ : $FÏ’°Æ¥Ê; if (strstr($d¨ÌĞÊƒçÎ, $C¨„îìôÚ[70])) { $d¨ÌĞÊƒçÎ = str_replace($C¨„îìôÚ[70], $C¨„îìôÚ[71], $d¨ÌĞÊƒçÎ); } $eó‡¸Ğ«£[$e‹‘Œ–“Îò . $C¨„îìôÚ[67] . $fñãà¼Û‹ˆ . $C¨„îìôÚ[68] . $FÏ’°Æ¥Ê] = $d¨ÌĞÊƒçÎ; goto DƒÁßÇé‡•; bî‡“º©´¤: $C¨„îìôÚ =& $_SERVER[ªúæÂ¡­ä½]; if (!$FÏ’°Æ¥Ê || !function_exists($C¨„îìôÚ[66])) { return $FÏ’°Æ¥Ê; } static $eó‡¸Ğ«£ = array(); goto EœíºØÂß; EœíºØÂß: $AŒˆÃÄã´« = $e‹‘Œ–“Îò . $C¨„îìôÚ[67] . $fñãà¼Û‹ˆ . $C¨„îìôÚ[68] . $FÏ’°Æ¥Ê; if (isset($eó‡¸Ğ«£[$AŒˆÃÄã´«])) { return $eó‡¸Ğ«£[$AŒˆÃÄã´«]; } if (function_exists($C¨„îìôÚ[69])) { $d¨ÌĞÊƒçÎ = @mb_convert_encoding($FÏ’°Æ¥Ê, $fñãà¼Û‹ˆ, $e‹‘Œ–“Îò); } else { $d¨ÌĞÊƒçÎ = @iconv($e‹‘Œ–“Îò, $fñãà¼Û‹ˆ, $FÏ’°Æ¥Ê); } goto B‹–Ÿƒ„ÔÚ; DƒÁßÇé‡•: $eó‡¸Ğ«£[$fñãà¼Û‹ˆ . $C¨„îìôÚ[67] . $e‹‘Œ–“Îò . $C¨„îìôÚ[68] . $FÏ’°Æ¥Ê] = $FÏ’°Æ¥Ê; $eó‡¸Ğ«£[$fñãà¼Û‹ˆ . $C¨„îìôÚ[67] . $e‹‘Œ–“Îò . $C¨„îìôÚ[68] . $d¨ÌĞÊƒçÎ] = $FÏ’°Æ¥Ê; $eó‡¸Ğ«£[$e‹‘Œ–“Îò . $C¨„îìôÚ[67] . $fñãà¼Û‹ˆ . $C¨„îìôÚ[68] . $d¨ÌĞÊƒçÎ] = $d¨ÌĞÊƒçÎ; goto D†ëª¹Şáó; D†ëª¹Şáó: return $d¨ÌĞÊƒçÎ; goto dòÎ×ö©í; dòÎ×ö©í: } public function getPathInner($f¼µ¶•ƒëà) { $eø´ĞÀÃ°§ = IO::init($f¼µ¶•ƒëà); return $eø´ĞÀÃ°§->path; } public function getPathOuter($F½ëŒÙó”) { $d ›óæÁ™§ =& $_SERVER[ªúæÂ¡­ä½]; $dšóĞíŠ„‘ = strlen(trim($this->pathBase, $d ›óæÁ™§[8])); $F½ëŒÙó” = substr(trim($F½ëŒÙó”, $d ›óæÁ™§[8]), $dšóĞíŠ„‘); return $this->pathDriver . $d ›óæÁ™§[8] . ltrim($F½ëŒÙó”, $d ›óæÁ™§[8]); } public function isParentOf($FŠÚˆ¬‚‡…, $bíË•«îñ÷) { $A²Ò¢Ç‹–¢ =& $_SERVER[ªúæÂ¡­ä½]; $FŠÚˆ¬‚‡… = rtrim(strtolower($FŠÚˆ¬‚‡…), $A²Ò¢Ç‹–¢[8]) . $A²Ò¢Ç‹–¢[8]; $bíË•«îñ÷ = rtrim(strtolower($bíË•«îñ÷), $A²Ò¢Ç‹–¢[8]) . $A²Ò¢Ç‹–¢[8]; $E‡ƒÍˆæÁâ = strpos($bíË•«îñ÷, $FŠÚˆ¬‚‡…) === 0; return $E‡ƒÍˆæÁâ; } public function getType() { $AäìëÊãìó =& $_SERVER[ªúæÂ¡­ä½]; $Bˆ¿ºÁË™ë = str_replace($AäìëÊãìó[72], $AäìëÊãìó[33], get_class($this)); return strtolower($Bˆ¿ºÁË™ë); } public function isTypeObject() { if (!is_array($this->objectDriver)) { return !1; } return in_array($this->getType(), $this->objectDriver); } public function fileNameExist($b“›ĞØ½®ä, $a”õÁİù·) { $B£‘éåõ =& $_SERVER[ªúæÂ¡­ä½]; $c©òĞ°¦‹ô = rtrim($b“›ĞØ½®ä, $B£‘éåõ[8]) . $B£‘éåõ[8] . $a”õÁİù·; $f‹Íß¬ï‰ = $this->exist($c©òĞ°¦‹ô); return $f‹Íß¬ï‰ ? $c©òĞ°¦‹ô : !1; } public function setModifyTime($Cğï«øÔÕã, $F¸‚²ÊØä = '') { } public function renameObject($B–‹Œè†ğ, $A¨£Œå³ø) { goto DÁÅ®À‚è; AÕ¥¹‡È: return $dŠéæ±ÆÖ ? $A¨£Œå³ø : !1; goto Cã—ï¡ —; DÁÅ®À‚è: $BË×ˆÛßÍ =& $_SERVER[ªúæÂ¡­ä½]; $aˆš°É«¿™ = $A¨£Œå³ø; Hook::trigger($BË×ˆÛßÍ[73], $this, $B–‹Œè†ğ, $this, $this->pathFather($B–‹Œè†ğ) . $A¨£Œå³ø); goto d»ŸƒÉÆñ; d»ŸƒÉÆñ: $B–‹Œè†ğ = $this->getPathOuter($B–‹Œè†ğ); $A¨£Œå³ø = $this->pathFather($B–‹Œè†ğ) . $A¨£Œå³ø; if (IO::isFile($B–‹Œè†ğ)) { $dŠéæ±ÆÖ = IO::copy($B–‹Œè†ğ, $this->pathFather($B–‹Œè†ğ), REPEAT_RENAME_FOLDER, $aˆš°É«¿™); if ($dŠéæ±ÆÖ) { IO::remove($B–‹Œè†ğ); } } else { $dŠéæ±ÆÖ = IO::mkdir($A¨£Œå³ø); if (!$dŠéæ±ÆÖ) { return !1; } $BÅ¶÷ÆõÅ© = IO::listPath($B–‹Œè†ğ, !0); $CĞÁ°à = array_merge($BÅ¶÷ÆõÅ©[$BË×ˆÛßÍ[74]], $BÅ¶÷ÆõÅ©[$BË×ˆÛßÍ[75]]); foreach ($CĞÁ°à as $Dƒ¡†ÎêÆÃ) { IO::move($Dƒ¡†ÎêÆÃ[$BË×ˆÛßÍ[76]], $A¨£Œå³ø, REPEAT_RENAME_FOLDER); } IO::remove($B–‹Œè†ğ); } goto AÕ¥¹‡È; Cã—ï¡ —: } public function tempFile($D¶µğğ— = '', $EŒÅğƒ­Îë = '') { goto E÷®‹ø°’; bÉ‡×‡Çƒ×: return $FÕæ¬Ÿ¬; goto fÉ“‘›ÈÅ½; E÷®‹ø°’: if (!$D¶µğğ—) { $D¶µğğ— = rand_string(15); } $bÄ˜ß›ï¶Á = TEMP_FILES . rand_string(15) . $_SERVER[ªúæÂ¡­ä½][8]; @mkdir($bÄ˜ß›ï¶Á, 511, !0); goto AÙ‚®ÁæÚØ; AÙ‚®ÁæÚØ: $FÕæ¬Ÿ¬ = $bÄ˜ß›ï¶Á . $D¶µğğ—; @touch($FÕæ¬Ÿ¬); if ($EŒÅğƒ­Îë) { file_put_contents($FÕæ¬Ÿ¬, $EŒÅğƒ­Îë); } goto bÉ‡×‡Çƒ×; fÉ“‘›ÈÅ½: } public function tempFileRemve($eŠ‚Ìáâ²) { @unlink($eŠ‚Ìáâ²); @rmdir($this->pathFather($eŠ‚Ìáâ²)); } public function mkfile($Dõ…ÂçÏ“š, $BÆ˜×¼˜¬Ø = '', $Aè±»İ·´ = REPEAT_RENAME) { } public function mkdir($b‹ƒç©íÒ­, $D£ôà™â•é = REPEAT_SKIP) { } public function delFile($b¥¾‰Á†Ü) { } public function delFolder($a¸§–º†İ) { } public function copyFile($E›¿Ø‹‹Ö, $e‰–Œ¿±œ¹) { } public function moveFile($bèõÎ¿éî•, $Bö²ªœç˜) { } public function remove($d³Í·°»Ã) { if ($this->isFile($d³Í·°»Ã)) { return $this->delFile($d³Í·°»Ã); } return $this->delFolder($d³Í·°»Ã); } public function rename($e¢¼´æåÀƒ, $AÒ·ŞïŸ¦Ä) { } public function exist($a²Š„áê¤ù) { } public function findByHash($FİëĞ¥ = '', $a´‡É•õ³ô = '') { return !1; } public function isFile($fº‡ö´­êŒ) { } public function isFolder($CÙÚè±ğ¼…) { } public function size($Bâ½ßÙŠ¦¶) { } public function info($E„‰Ï¹¸“‘) { } public function infoSimple($Cïö¯‰ ª) { return $this->info($Cïö¯‰ ª); } public function infoAuth($A’à÷„Í) { return $this->info($A’à÷„Í); } public function infoFull($Cİ›‰œ—¤½) { return $this->info($Cİ›‰œ—¤½); } public function infoWithChildren($eŠªßŞø) { $bœµ‰‰£èù =& $_SERVER[ªúæÂ¡­ä½]; static $dŠ¯±ñËÆç = array(); if (isset($dŠ¯±ñËÆç[$eŠªßŞø])) { return $dŠ¯±ñËÆç[$eŠªßŞø]; } $d¤µ¦ø‰ñ = $this->info($eŠªßŞø); if ($d¤µ¦ø‰ñ && $d¤µ¦ø‰ñ[$bœµ‰‰£èù[29]] == $bœµ‰‰£èù[77]) { $B´ø‚Èæ ¼ = array($bœµ‰‰£èù[78] => 0, $bœµ‰‰£èù[79] => 0, $bœµ‰‰£èù[80] => 0); $this->infoChildren($eŠªßŞø, $B´ø‚Èæ ¼); $d¤µ¦ø‰ñ[$bœµ‰‰£èù[78]] = $B´ø‚Èæ ¼[$bœµ‰‰£èù[78]]; $d¤µ¦ø‰ñ[$bœµ‰‰£èù[81]] = array($bœµ‰‰£èù[82] => $B´ø‚Èæ ¼[$bœµ‰‰£èù[79]], $bœµ‰‰£èù[83] => $B´ø‚Èæ ¼[$bœµ‰‰£èù[80]]); $dŠ¯±ñËÆç[$eŠªßŞø] = $d¤µ¦ø‰ñ; } return $d¤µ¦ø‰ñ; } public function listPath($F¨·ôùÍ¬”, $BÜé…çíÕ  = false) { } public function has($cËæ‡‚ÏŒ‰, $Bê”åñêø = false, $c›„«Úİº· = false) { } public function canRead($CÃ‰Ÿğ¢ÓÕ) { } public function canWrite($C¹Ô‹¥Ä’) { } public function getContent($f­ÚÖ›Õó) { } public function setContent($d’Ö‘ÎĞƒÑ, $E’†ò¢Â…¯ = '') { } protected function infoChildren($b…õ‹¤ôÎÇ, &$Eƒ‹ŸÒ£š) { $DºÌííÈç» =& $_SERVER[ªúæÂ¡­ä½]; check_abort_echo(); $b¢Ñ’“†Á = $this->listPath($b…õ‹¤ôÎÇ, !0); $b¢Ñ’“†Á = array_merge($b¢Ñ’“†Á[$DºÌííÈç»[75]], $b¢Ñ’“†Á[$DºÌííÈç»[74]]); foreach ($b¢Ñ’“†Á as $F‰„âç§éª) { if ($F‰„âç§éª[$DºÌííÈç»[29]] == $DºÌííÈç»[77]) { $Eƒ‹ŸÒ£š[$DºÌííÈç»[80]]++; $eºò•±ôÅœ = $this->getPathInner($F‰„âç§éª[$DºÌííÈç»[76]]); $this->infoChildren($eºò•±ôÅœ, $Eƒ‹ŸÒ£š); } else { $Eƒ‹ŸÒ£š[$DºÌííÈç»[79]]++; $Eƒ‹ŸÒ£š[$DºÌííÈç»[78]] += $F‰„âç§éª[$DºÌííÈç»[78]]; } } } public function fileSubstr($CéŠà¥´¤, $bê±ø™Ø­, $a³ÜæöÆÑÕ) { } public function listAll($fçİ­—ğŞÏ) { } public function listAllMake($F®„ÙîÄ›, &$A±Ö²½¬¹‡) { $d£µ“Çêœ÷ =& $_SERVER[ªúæÂ¡­ä½]; check_abort_echo(); $B¨Œ†İÕÕÔ = $this->listPath($F®„ÙîÄ›, !0); if (!$B¨Œ†İÕÕÔ) { return; } $d‚‘–…Éõ» = array_merge($B¨Œ†İÕÕÔ[$d£µ“Çêœ÷[75]], $B¨Œ†İÕÕÔ[$d£µ“Çêœ÷[74]]); foreach ($d‚‘–…Éõ» as $e§„‚ßİ¯ì) { goto c¹¹·Í”˜š; a¢Ü¼‘ÄÏ: if (isset($e§„‚ßİ¯ì[$d£µ“Çêœ÷[84]])) { $cÇÂ±¿ğÉ[$d£µ“Çêœ÷[84]] = $e§„‚ßİ¯ì[$d£µ“Çêœ÷[84]]; } if (!$F§ÓäÜ„œÀ) { $A±Ö²½¬¹‡[] = $cÇÂ±¿ğÉ; continue; } $A±Ö²½¬¹‡[] = $cÇÂ±¿ğÉ; goto d§•µ†é; c¹¹·Í”˜š: $F§ÓäÜ„œÀ = $e§„‚ßİ¯ì[$d£µ“Çêœ÷[29]] == $d£µ“Çêœ÷[77]; $cÇÂ±¿ğÉ = array($d£µ“Çêœ÷[76] => $e§„‚ßİ¯ì[$d£µ“Çêœ÷[76]], $d£µ“Çêœ÷[77] => $F§ÓäÜ„œÀ); if (isset($e§„‚ßİ¯ì[$d£µ“Çêœ÷[78]])) { $cÇÂ±¿ğÉ[$d£µ“Çêœ÷[78]] = $e§„‚ßİ¯ì[$d£µ“Çêœ÷[78]]; } goto a¢Ü¼‘ÄÏ; d§•µ†é: $this->listAllMake($e§„‚ßİ¯ì[$d£µ“Çêœ÷[76]], $A±Ö²½¬¹‡); goto dÏ³ˆëÕ‰£; dÏ³ˆëÕ‰£: } } public function listAllSimple($cíòËĞ‡áù) { $bÕÄØª  Û =& $_SERVER[ªúæÂ¡­ä½]; $f¯›ÈÙÈ… = array(); $BŸõİ‰óœé = $this->listAll($cíòËĞ‡áù); $a„Á²¦…ªŠ = $this->getPathOuter($cíòËĞ‡áù); foreach ($BŸõİ‰óœé as $DĞ¾¾ˆõ) { goto eòÖÉìì¹¦; DÊù—òÚ¥: $E”ëÑ÷”áõ = array($bÕÄØª  Û[76] => $cùÚ¨Œ¤•Í, $bÕÄØª  Û[77] => $DĞ¾¾ˆõ[$bÕÄØª  Û[77]]); if (isset($DĞ¾¾ˆõ[$bÕÄØª  Û[78]]) && !$DĞ¾¾ˆõ[$bÕÄØª  Û[77]]) { $E”ëÑ÷”áõ[$bÕÄØª  Û[78]] = $DĞ¾¾ˆõ[$bÕÄØª  Û[78]]; } if (isset($DĞ¾¾ˆõ[$bÕÄØª  Û[84]])) { $E”ëÑ÷”áõ[$bÕÄØª  Û[84]] = $DĞ¾¾ˆõ[$bÕÄØª  Û[84]]; } goto Dƒ‰‘óò©ï; eòÖÉìì¹¦: $C¶ƒ‘î¼‚ï = $DĞ¾¾ˆõ[$bÕÄØª  Û[76]]; $cùÚ¨Œ¤•Í = $DĞ¾¾ˆõ[$bÕÄØª  Û[76]]; if (isset($DĞ¾¾ˆõ[$bÕÄØª  Û[85]])) { $C¶ƒ‘î¼‚ï = $DĞ¾¾ˆõ[$bÕÄØª  Û[85]][$bÕÄØª  Û[76]]; $DĞ¾¾ˆõ[$bÕÄØª  Û[78]] = $DĞ¾¾ˆõ[$bÕÄØª  Û[85]][$bÕÄØª  Û[78]]; $DĞ¾¾ˆõ[$bÕÄØª  Û[84]] = $DĞ¾¾ˆõ[$bÕÄØª  Û[85]][$bÕÄØª  Û[84]]; } else { $cùÚ¨Œ¤•Í = substr($DĞ¾¾ˆõ[$bÕÄØª  Û[76]], strlen(get_path_father($a„Á²¦…ªŠ))); $cùÚ¨Œ¤•Í = $bÕÄØª  Û[8] . ltrim($cùÚ¨Œ¤•Í, $bÕÄØª  Û[8]); } goto DÊù—òÚ¥; Dƒ‰‘óò©ï: if (!$DĞ¾¾ˆõ[$bÕÄØª  Û[77]]) { $E”ëÑ÷”áõ[$bÕÄØª  Û[86]] = $C¶ƒ‘î¼‚ï; } $f¯›ÈÙÈ…[] = $E”ëÑ÷”áõ; goto d­ª§Õºõ’; d­ª§Õºõ’: } return $f¯›ÈÙÈ…; } public function upload($dšà¦ğŠ‰í, $A¢áìĞ³…º, $F ®¡²¬×Á = false, $d”É‚Şô¥ = REPEAT_REPLACE) { } public function uploadFileByID($b¸ğ†¹•î¡, $BÆìâªæ–, $cƒ—ˆ£Ş) { } public function uploadFileByPath($Bƒ¿åöğÑ÷, $BÁ³½ÔáˆÇ, $eÊ… Í‘â· = array()) { } public function isUploadServer() { $DÁÒ‚ËÖØî =& $_SERVER[ªúæÂ¡­ä½]; if (isset($this->ioUploadServer) && $this->ioUploadServer == $DÁÒ‚ËÖØî[87]) { return !0; } return $GLOBALS[$DÁÒ‚ËÖØî[6]][$DÁÒ‚ËÖØî[88]][$DÁÒ‚ËÖØî[89]]; } public function isFileOutServer() { $dö¬¶à‡±ù =& $_SERVER[ªúæÂ¡­ä½]; if (isset($this->ioFileOutServer) && $this->ioFileOutServer == $dö¬¶à‡±ù[87]) { return !0; } return $GLOBALS[$dö¬¶à‡±ù[6]][$dö¬¶à‡±ù[88]][$dö¬¶à‡±ù[90]]; } public function isCdnHost() { return $this->isFileOutServer() || empty($this->cdnHost) ? !1 : !0; } public function getCdnLink($F¡ïÏ¶ôåŒ) { $FµœÓ©Ÿ¼È =& $_SERVER[ªúæÂ¡­ä½]; if (!$this->isCdnHost()) { return $F¡ïÏ¶ôåŒ; } return str_replace(trim(get_url_root($F¡ïÏ¶ôåŒ), $FµœÓ©Ÿ¼È[8]), trim($this->cdnHost, $FµœÓ©Ÿ¼È[8]), $F¡ïÏ¶ôåŒ); } public function uploadLink($bÙ„åòò±¢, $bÓÊ‚ˆªğ = 0) { goto eƒê¦ØŠï; DÉ®‰“Õ‡: if (!in_array($Fã¡Ú‰ßŠ…, $this->objectDriver)) { return; } if (!$this->isBucketCors()) { return; } $eÆ‹¨Ğ§ˆŒ = 1024 * 1024 * 10; goto b•»¾ ˜Š; eƒê¦ØŠï: $BÓôÅ‰Ô¹é =& $_SERVER[ªúæÂ¡­ä½]; if ($this->isUploadServer()) { return; } $Fã¡Ú‰ßŠ… = $this->getType(); goto DÉ®‰“Õ‡; fŒ‘Ì’„øˆ: if ($d˜¬º…â“ç) { $d˜¬º…â“ç[$BÓôÅ‰Ô¹é[93]] = $bÙ„åòò±¢; $d˜¬º…â“ç[$BÓôÅ‰Ô¹é[94]] = $Fã¡Ú‰ßŠ…; } return $d˜¬º…â“ç; goto e¤äíĞ¦óÖ; b•»¾ ˜Š: $cŒËœ¦˜Â = $bÓÊ‚ˆªğ <= $eÆ‹¨Ğ§ˆŒ ? $BÓôÅ‰Ô¹é[91] : $BÓôÅ‰Ô¹é[92]; $D³²ß–…Š³ = (!$bÓÊ‚ˆªğ ? 1 : ceil($bÓÊ‚ˆªğ / pow(1024, 3))) * 3600 * 4; $d˜¬º…â“ç = $this->{$cŒËœ¦˜Â}($bÙ„åòò±¢, $D³²ß–…Š³); goto fŒ‘Ì’„øˆ; e¤äíĞ¦óÖ: } public function uploadFormData($eºÑòŠÔ², $aè½é®£ŠÚ = 3600) { } public function multiUploadFormData($eâî±˜ÇÀá, $fç›ĞôÎ‚ª = 3600) { } public function download($a¨‘”Â’•Ë, $aÎ¦¸¥½´„) { } public function ext($DÃÜŸ™¿è) { $fÀÄ£­À =& $_SERVER[ªúæÂ¡­ä½]; if (strpos($DÃÜŸ™¿è, $fÀÄ£­À[8]) === -1) { $e¾»´ªã˜æ = $DÃÜŸ™¿è; } else { $e¾»´ªã˜æ = $this->pathThis($DÃÜŸ™¿è); } $dî’ø­Üê = $fÀÄ£­À[33]; if (strstr($e¾»´ªã˜æ, $fÀÄ£­À[95])) { $dî’ø­Üê = substr($e¾»´ªã˜æ, strrpos($e¾»´ªã˜æ, $fÀÄ£­À[95]) + 1); $dî’ø­Üê = strtolower($dî’ø­Üê); } if (strlen($dî’ø­Üê) > 3 && preg_match($fÀÄ£­À[96], $dî’ø­Üê, $EÓç™¾ÇÊ)) { $dî’ø­Üê = $fÀÄ£­À[33]; } return $dî’ø­Üê; } public function pathThis($c°—Ş¸÷éÓ) { $Cæ°ÇŠåÀ„ =& $_SERVER[ªúæÂ¡­ä½]; $c°—Ş¸÷éÓ = str_replace($Cæ°ÇŠåÀ„[97], $Cæ°ÇŠåÀ„[8], rtrim($c°—Ş¸÷éÓ, $Cæ°ÇŠåÀ„[8])); $Fèè¥«‡Üº = strrpos($c°—Ş¸÷éÓ, $Cæ°ÇŠåÀ„[8]); if ($Fèè¥«‡Üº === !1) { return $c°—Ş¸÷éÓ; } return substr($c°—Ş¸÷éÓ, $Fèè¥«‡Üº + 1); } public function pathFather($D„»µ¥¾æÌ) { $A——¯ØÑêà =& $_SERVER[ªúæÂ¡­ä½]; $D„»µ¥¾æÌ = str_replace($A——¯ØÑêà[97], $A——¯ØÑêà[8], rtrim($D„»µ¥¾æÌ, $A——¯ØÑêà[8])); $f†Ìİˆ·ÍÉ = strrpos($D„»µ¥¾æÌ, $A——¯ØÑêà[8]); if ($f†Ìİˆ·ÍÉ === !1) { return $A——¯ØÑêà[33]; } return substr($D„»µ¥¾æÌ, 0, $f†Ìİˆ·ÍÉ + 1); } public function hashSimple($B¶Ä†ÈèŒ) { goto dèñ‹›–¼Ù; dÌ—¸„áª: $a­âé®äÔ = 200; $C É‹É‰¶ğ = 50; if ($FšìÍŠÑÌ„ <= $a­âé®äÔ * $C É‹É‰¶ğ) { return $this->hashMd5($B¶Ä†ÈèŒ) . $FšìÍŠÑÌ„; } goto F¹×»Š©‰; dèñ‹›–¼Ù: $fØëĞêÛá§ =& $_SERVER[ªúæÂ¡­ä½]; if (!$B¶Ä†ÈèŒ) { return md5($fØëĞêÛá§[33]); } $FšìÍŠÑÌ„ = $this->size($B¶Ä†ÈèŒ); goto dÌ—¸„áª; d‹ãÒœÂ…°: $Aƒ£ĞÎ¦‚Î .= $this->fileSubstr($B¶Ä†ÈèŒ, $FšìÍŠÑÌ„ - $a­âé®äÔ, $a­âé®äÔ); return md5($Aƒ£ĞÎ¦‚Î) . $FšìÍŠÑÌ„; goto Fµ·‘¥’…; F¹×»Š©‰: $c²ÕŸ»âö¹ = intval($FšìÍŠÑÌ„ / $C É‹É‰¶ğ); $Aƒ£ĞÎ¦‚Î = $fØëĞêÛá§[33]; for ($aÉ‘”‚Ñ¹ = 0; $aÉ‘”‚Ñ¹ < $C É‹É‰¶ğ; $aÉ‘”‚Ñ¹++) { $Aƒ£ĞÎ¦‚Î .= $this->fileSubstr($B¶Ä†ÈèŒ, $c²ÕŸ»âö¹ * $aÉ‘”‚Ñ¹, $a­âé®äÔ); } goto d‹ãÒœÂ…°; Fµ·‘¥’…: } public static $md5Cache = array(); public function hashMd5($A–ÁÖ‚åŞŸ) { $A–ÁÖ‚åŞŸ = $this->iconvSystem($A–ÁÖ‚åŞŸ); if (isset(self::$md5Cache[$A–ÁÖ‚åŞŸ])) { return self::$md5Cache[$A–ÁÖ‚åŞŸ]; } self::$md5Cache[$A–ÁÖ‚åŞŸ] = $this->hashMd5Shell($A–ÁÖ‚åŞŸ); if (!self::$md5Cache[$A–ÁÖ‚åŞŸ]) { self::$md5Cache[$A–ÁÖ‚åŞŸ] = @md5_file($A–ÁÖ‚åŞŸ); } return self::$md5Cache[$A–ÁÖ‚åŞŸ]; } private function hashMd5Shell($dÌø¦¹«Ş¡) { goto aµ™„™‘ ±; Cø¸¨âåÍ’: $A§¿ª½­ñ¿ = shell_exec($B²©õ¸Í‹º . "\x20\x22{$dÌø¦¹«Ş¡}\x22"); $A§¿ª½­ñ¿ = str_replace($Câ…ÌÚİ¬[104], $Câ…ÌÚİ¬[33], $A§¿ª½­ñ¿); return substr($A§¿ª½­ñ¿, 0, 32); goto dÆì¹ŒŸÛº; aµ™„™‘ ±: $Câ…ÌÚİ¬ =& $_SERVER[ªúæÂ¡­ä½]; if (!function_exists($Câ…ÌÚİ¬[98])) { return !1; } $B×¤¦à‚â = array($Câ…ÌÚİ¬[99], $Câ…ÌÚİ¬[100]); goto aß†ÙĞæ; aß†ÙĞæ: $B²©õ¸Í‹º = Cache::get($Câ…ÌÚİ¬[101]); if (!$B²©õ¸Í‹º) { $bÚÑö¾™ÃÛ = BASIC_PATH . $Câ…ÌÚİ¬[102]; $EÜŠ¿Šƒ = md5_file($bÚÑö¾™ÃÛ); $B²©õ¸Í‹º = $Câ…ÌÚİ¬[103]; foreach ($B×¤¦à‚â as $f¬Î®£¶¸·) { $A§¿ª½­ñ¿ = shell_exec($f¬Î®£¶¸· . "\x20\42{$bÚÑö¾™ÃÛ}\x22"); if ($A§¿ª½­ñ¿ && substr(trim($A§¿ª½­ñ¿), 0, 32) == $EÜŠ¿Šƒ) { $B²©õ¸Í‹º = $f¬Î®£¶¸·; break; } } Cache::set($Câ…ÌÚİ¬[101], $B²©õ¸Í‹º, 3600); } if ($B²©õ¸Í‹º == $Câ…ÌÚİ¬[103]) { return !1; } goto Cø¸¨âåÍ’; dÆì¹ŒŸÛº: } public function link($CÉ‰‰¨ê†) { return $CÉ‰‰¨ê†; } public function fileOut($bëÔœ¶¨Û», $bà‘…Ğ‡†á = false, $bİùÊ«Œ³ƒ = false, $Bƒ‰Ê³œ‚ = '') { goto c¡°ÀÙÆ¼; D†Ößœîïß: @ob_end_clean(); set_timeout(); $CÖæÜÑ·£ = $this->infoFull($bëÔœ¶¨Û»); goto CùØŞáô„Ï; DÆÒÂñªŸ×: $f…ËË±Ô”Û = 0; $aË‘ÎßÏØŞ = $EÉ”»© - 1; $a¢±¢˜Éˆ÷ = $this->ext($BÊåî§Æ‘Ö); goto FÖ‚ô‰­²; FÖ‚ô‰­²: if (in_array($a¢±¢˜Éˆ÷, array($F—ÖÎÇ‚‘[111], $F—ÖÎÇ‚‘[112], $F—ÖÎÇ‚‘[113], $F—ÖÎÇ‚‘[114]))) { $a¢±¢˜Éˆ÷ = $F—ÖÎÇ‚‘[115]; } if (!$Bƒ‰Ê³œ‚) { $Bƒ‰Ê³œ‚ = md5($c¯é®¯¦ƒ . $this->hashSimple($bëÔœ¶¨Û»)); } $Bƒ‰Ê³œ‚ = $F—ÖÎÇ‚‘[116] . $Bƒ‰Ê³œ‚ . $F—ÖÎÇ‚‘[116]; goto FŸ×ÓçÇ; F£”÷Í”ŠÚ: $A„çâœ‡àÛ = $F—ÖÎÇ‚‘[116] . $A„çâœ‡àÛ . $F—ÖÎÇ‚‘[122] . $A„çâœ‡àÛ; if ($bà‘…Ğ‡†á) { header($F—ÖÎÇ‚‘[123]); header($F—ÖÎÇ‚‘[124] . $A„çâœ‡àÛ); } else { header($F—ÖÎÇ‚‘[125] . $A„çâœ‡àÛ); } header($F—ÖÎÇ‚‘[126] . gmdate($F—ÖÎÇ‚‘[110], time() + 3600 * 24 * 30) . $F—ÖÎÇ‚‘[127]); goto aêˆŒÚ§Û‹; d¾ã‚Íïµ©: $FŒªàÑ»•Š = strtolower($_SERVER[$F—ÖÎÇ‚‘[142]]); if ($aÜÎô²¯ˆ™ && $FŒªàÑ»•Š && $e…Ş­ëªÃ½) { if (strstr($FŒªàÑ»•Š, $F—ÖÎÇ‚‘[143])) { header($F—ÖÎÇ‚‘[144] . $bëÔœ¶¨Û»); } else { if (strstr($FŒªàÑ»•Š, $F—ÖÎÇ‚‘[145])) { header($F—ÖÎÇ‚‘[146] . $bëÔœ¶¨Û»); } else { if (strstr($FŒªàÑ»•Š, $F—ÖÎÇ‚‘[147])) { header($F—ÖÎÇ‚‘[148] . $bëÔœ¶¨Û»); } } } if ($fªËÑï‡†á) { header($F—ÖÎÇ‚‘[149] . $fªËÑï‡†á); } return; } if (isset($_SERVER[$F—ÖÎÇ‚‘[150]])) { if (preg_match($F—ÖÎÇ‚‘[151], $_SERVER[$F—ÖÎÇ‚‘[150]], $C¨òº²„Ø)) { $f…ËË±Ô”Û = intval($C¨òº²„Ø[1]); if (!empty($C¨òº²„Ø[2])) { $aË‘ÎßÏØŞ = intval($C¨òº²„Ø[2]); } } header($F—ÖÎÇ‚‘[152]); header("\103\157\156\164\145\156\164\55\122\x61\x6e\x67\145\72\40\x62\171\x74\x65\x73\40{$f…ËË±Ô”Û}\x2d{$aË‘ÎßÏØŞ}\x2f" . $EÉ”»©); } else { header($F—ÖÎÇ‚‘[153]); } goto C…çÅî°¥…; FŸ×ÓçÇ: $cøÊ¨‘Ò‰ = get_file_mime($a¢±¢˜Éˆ÷); if (strstr($cøÊ¨‘Ò‰, $F—ÖÎÇ‚‘[117])) { $cøÊ¨‘Ò‰ = $cøÊ¨‘Ò‰ . $F—ÖÎÇ‚‘[118]; } if ($bà‘…Ğ‡†á === !1 && !mime_support($cøÊ¨‘Ò‰)) { $bà‘…Ğ‡†á = !0; $cøÊ¨‘Ò‰ = $F—ÖÎÇ‚‘[119]; } goto f™¬›ßáÛ; F¾ÛÈÂ•ğÉ: if ($_SERVER[$F—ÖÎÇ‚‘[157]] == $F—ÖÎÇ‚‘[158]) { return; } $d”‹µŸ‘‰ = 1024 * 100; $eŠ×„ë¿˜ï = 0; goto DöÜ½Ø¯µ; DöÜ½Ø¯µ: if ($fªËÑï‡†á) { $eŠ×„ë¿˜ï = intval(1000 * 1000 * ($d”‹µŸ‘‰ / $fªËÑï‡†á)); } while ($f…ËË±Ô”Û <= $aË‘ÎßÏØŞ) { $D¡êˆ˜“ = timeFloat(); check_abort(); $bµ¶©È™î = $aË‘ÎßÏØŞ - $f…ËË±Ô”Û + 1; if ($bµ¶©È™î <= $d”‹µŸ‘‰) { $d”‹µŸ‘‰ = $bµ¶©È™î; } echo $this->fileSubstr($bëÔœ¶¨Û», $f…ËË±Ô”Û, $d”‹µŸ‘‰); $f…ËË±Ô”Û += $d”‹µŸ‘‰; if ($d”‹µŸ‘‰ == $bµ¶©È™î) { $f…ËË±Ô”Û = $aË‘ÎßÏØŞ + 1; } if ($eŠ×„ë¿˜ï) { $BöÂÃÇ‰‹ = intval(1000 * 1000 * (timeFloat() - $D¡êˆ˜“)); $eŠ©Üïµò = $eŠ×„ë¿˜ï - $BöÂÃÇ‰‹; if ($eŠ©Üïµò > 5) { usleep($eŠ©Üïµò); } } } goto bÊ¿õ˜å; CùØŞáô„Ï: $EÉ”»© = $CÖæÜÑ·£[$F—ÖÎÇ‚‘[78]]; $c¯é®¯¦ƒ = gmdate($F—ÖÎÇ‚‘[110], $CÖæÜÑ·£[$F—ÖÎÇ‚‘[84]]); $BÊåî§Æ‘Ö = $bİùÊ«Œ³ƒ ? $bİùÊ«Œ³ƒ : $this->iconvApp($CÖæÜÑ·£[$F—ÖÎÇ‚‘[28]]); goto DÆÒÂñªŸ×; cÉ·Î„Ñˆß: $aÜÎô²¯ˆ™ = $this->getType() == $F—ÖÎÇ‚‘[106]; $e…Ş­ëªÃ½ = $GLOBALS[$F—ÖÎÇ‚‘[6]][$F—ÖÎÇ‚‘[88]][$F—ÖÎÇ‚‘[107]][$F—ÖÎÇ‚‘[108]]; $fªËÑï‡†á = (double) $GLOBALS[$F—ÖÎÇ‚‘[6]][$F—ÖÎÇ‚‘[88]][$F—ÖÎÇ‚‘[107]][$F—ÖÎÇ‚‘[109]] * 1024 * 1024; goto D†Ößœîïß; aêˆŒÚ§Û‹: header($F—ÖÎÇ‚‘[128]); header($F—ÖÎÇ‚‘[129]); header($F—ÖÎÇ‚‘[130]); goto B†•éçÉŸ¤; B†•éçÉŸ¤: if (isset($_SERVER[$F—ÖÎÇ‚‘[131]]) && strtotime($_SERVER[$F—ÖÎÇ‚‘[131]]) == $CÖæÜÑ·£[$F—ÖÎÇ‚‘[84]]) { header($F—ÖÎÇ‚‘[132], !0, 304); die; } if (isset($_SERVER[$F—ÖÎÇ‚‘[133]]) && $_SERVER[$F—ÖÎÇ‚‘[133]] == $Bƒ‰Ê³œ‚) { header($F—ÖÎÇ‚‘[134] . $Bƒ‰Ê³œ‚, !0, 304); die; } header($F—ÖÎÇ‚‘[134] . $Bƒ‰Ê³œ‚); goto CŞ»ªÈİ¾À; C…çÅî°¥…: $bî‹ã¦¯£ = !0; if ($_SERVER[$F—ÖÎÇ‚‘[154]] == $F—ÖÎÇ‚‘[155] && $EÉ”»© > 1204 * 1024 * 1024 * 2) { $bî‹ã¦¯£ = !1; } if ($bî‹ã¦¯£) { header($F—ÖÎÇ‚‘[156] . ($aË‘ÎßÏØŞ - $f…ËË±Ô”Û + 1)); } goto F¾ÛÈÂ•ğÉ; f™¬›ßáÛ: header($F—ÖÎÇ‚‘[120]); header($F—ÖÎÇ‚‘[121] . $cøÊ¨‘Ò‰); $A„çâœ‡àÛ = rawurlencode($BÊåî§Æ‘Ö); goto F£”÷Í”ŠÚ; CŞ»ªÈİ¾À: header($F—ÖÎÇ‚‘[135] . $c¯é®¯¦ƒ . $F—ÖÎÇ‚‘[127]); header($F—ÖÎÇ‚‘[136] . $BÊåî§Æ‘Ö); header($F—ÖÎÇ‚‘[137]); goto d›İ«¤‘ŠÏ; c¡°ÀÙÆ¼: $F—ÖÎÇ‚‘ =& $_SERVER[ªúæÂ¡­ä½]; $this->cacheMethod(null, null); if (!$bëÔœ¶¨Û» || !$this->exist($bëÔœ¶¨Û»)) { show_json(LNG($F—ÖÎÇ‚‘[105]), !1, $bİùÊ«Œ³ƒ); } goto cÉ·Î„Ñˆß; d›İ«¤‘ŠÏ: header($F—ÖÎÇ‚‘[138] . $EÉ”»©); header($F—ÖÎÇ‚‘[139]); if (!$bà‘…Ğ‡†á && $a¢±¢˜Éˆ÷ == $F—ÖÎÇ‚‘[140]) { if ($EÉ”»© > 1024 * 1024 * 5) { die; } $A®ª…²›Ğ¸ = $this->getContent($bëÔœ¶¨Û»); $A®ª…²›Ğ¸ = Html::clearSVG($A®ª…²›Ğ¸); header($F—ÖÎÇ‚‘[141] . strlen($A®ª…²›Ğ¸)); echo $A®ª…²›Ğ¸; die; } goto d¾ã‚Íïµ©; bÊ¿õ˜å: } public function fileOutServer($C³è‘–§†µ, $e–ÙŠ¢ªŒ« = false, $cà‘ï½µ¦´ = false, $F×ã¹×íô» = '') { $this->fileOut($C³è‘–§†µ, $e–ÙŠ¢ªŒ«, $cà‘ï½µ¦´, $F×ã¹×íô»); } public function fileOutLink($E·ª‚œ©·‰) { header($_SERVER[ªúæÂ¡­ä½][159] . $E·ª‚œ©·‰); die; } public function cacheMethod($C¢¿Å©“­ª, $eöÑÃô©Ş‹, $bÓÙ‹Ä¹•Ä = null) { goto e¹ºÀœÂÑÕ; EÎÈñ¿Àœ³: $e‡å÷¶ãèŸ = $BíÅ‹‘–¬[160] . $C¢¿Å©“­ª . $BíÅ‹‘–¬[161] . rtrim($aâêø¤°¹Î, $BíÅ‹‘–¬[8]); if (is_null($C¢¿Å©“­ª)) { $A§Ş¬Ğ£Íğ = array(); return; } if (is_null($eöÑÃô©Ş‹)) { unset($A§Ş¬Ğ£Íğ[$e‡å÷¶ãèŸ]); return; } goto Bôä‡ÏŒŞÓ; Bôä‡ÏŒŞÓ: if (!is_null($bÓÙ‹Ä¹•Ä)) { $A§Ş¬Ğ£Íğ[$e‡å÷¶ãèŸ] = $bÓÙ‹Ä¹•Ä; return; } $DÚŒ ã¥¯ = isset($A§Ş¬Ğ£Íğ[$e‡å÷¶ãèŸ]) ? $A§Ş¬Ğ£Íğ[$e‡å÷¶ãèŸ] : null; if (!is_null($DÚŒ ã¥¯)) { return $DÚŒ ã¥¯; } goto bÃˆà í; bÃˆà í: $DÚŒ ã¥¯ = $this->{$C¢¿Å©“­ª}($eöÑÃô©Ş‹); $A§Ş¬Ğ£Íğ[$e‡å÷¶ãèŸ] = $DÚŒ ã¥¯; return $DÚŒ ã¥¯; goto d ¥ŒğÏÆ; e¹ºÀœÂÑÕ: $BíÅ‹‘–¬ =& $_SERVER[ªúæÂ¡­ä½]; static $A§Ş¬Ğ£Íğ = array(); $aâêø¤°¹Î = $eöÑÃô©Ş‹ ? ltrim($this->getPathOuter($eöÑÃô©Ş‹), $BíÅ‹‘–¬[8]) : $eöÑÃô©Ş‹; goto EÎÈñ¿Àœ³; d ¥ŒğÏÆ: } public function fileOutImage($bè¡œ¶Ñ“, $eÏğË…”¹¾ = 250) { goto d·À’öƒñö; d·À’öƒñö: $Aš–ÖŒŒ· =& $_SERVER[ªúæÂ¡­ä½]; set_timeout(); if (substr($bè¡œ¶Ñ“, 0, 4) == $Aš–ÖŒŒ·[147]) { $this->fileOutLink($bè¡œ¶Ñ“); } goto e´‡Éğ©™¸; e´‡Éğ©™¸: $d™ê—ˆã–ù = $this->info($bè¡œ¶Ñ“); $Aº™Ãí¤ÉÍ = $d™ê—ˆã–ù[$Aš–ÖŒŒ·[28]]; $aé†¯âÇŒ = !1; goto bµ•È ‚•­; bµ•È ‚•­: if (isset($GLOBALS[$Aš–ÖŒŒ·[162]]) && $GLOBALS[$Aš–ÖŒŒ·[162]][$Aš–ÖŒŒ·[76]] == $d™ê—ˆã–ù[$Aš–ÖŒŒ·[76]]) { $F½¡„›ˆ¬Œ = $GLOBALS[$Aš–ÖŒŒ·[162]][$Aš–ÖŒŒ·[163]]; if (!$d™ê—ˆã–ù[$Aš–ÖŒŒ·[164]]) { $d™ê—ˆã–ù[$Aš–ÖŒŒ·[164]] = $GLOBALS[$Aš–ÖŒŒ·[162]]; } if (isset($F½¡„›ˆ¬Œ[$Aš–ÖŒŒ·[165]])) { if ($F½¡„›ˆ¬Œ[$Aš–ÖŒŒ·[165]] <= $eÏğË…”¹¾ && $F½¡„›ˆ¬Œ[$Aš–ÖŒŒ·[166]] <= $eÏğË…”¹¾) { $aé†¯âÇŒ = !0; } } $Aº™Ãí¤ÉÍ = $d™ê—ˆã–ù[$Aš–ÖŒŒ·[164]][$Aš–ÖŒŒ·[28]]; } if ($d™ê—ˆã–ù[$Aš–ÖŒŒ·[78]] <= 1024 * 50 || $aé†¯âÇŒ || !function_exists($Aš–ÖŒŒ·[167]) || $d™ê—ˆã–ù[$Aš–ÖŒŒ·[168]] == $Aš–ÖŒŒ·[169]) { return $this->fileOut($bè¡œ¶Ñ“, !1, $Aº™Ãí¤ÉÍ); } if (isset($d™ê—ˆã–ù[$Aš–ÖŒŒ·[164]][$Aš–ÖŒŒ·[170]])) { $dğ¡–É˜ßĞ = $d™ê—ˆã–ù[$Aš–ÖŒŒ·[164]][$Aš–ÖŒŒ·[170]]; } else { if (isset($d™ê—ˆã–ù[$Aš–ÖŒŒ·[164]][$Aš–ÖŒŒ·[171]])) { $dğ¡–É˜ßĞ = $d™ê—ˆã–ù[$Aš–ÖŒŒ·[164]][$Aš–ÖŒŒ·[171]]; } else { $dğ¡–É˜ßĞ = md5("{$d™ê—ˆã–ù[$Aš–ÖŒŒ·[28]]}\137{$d™ê—ˆã–ù[$Aš–ÖŒŒ·[76]]}\137{$d™ê—ˆã–ù[$Aš–ÖŒŒ·[78]]}"); } } goto Dé¾Ú¸ÂÌ†; Då‰®˜Â–´: if (!is_dir(DATA_THUMB)) { mk_dir(DATA_THUMB); } $b»›Á¾ù½ï = DATA_THUMB . $e‘£—£; del_file($b»›Á¾ù½ï); goto Fïµ¦’Üùã; Dé¾Ú¸ÂÌ†: $e‘£—£ = "{$dğ¡–É˜ßĞ}\137{$eÏğË…”¹¾}\56\160\x6e\x67"; if (!($E—¿……®â = IO::fileNameExist(IO_PATH_SYSTEM_TEMP, $Aš–ÖŒŒ·[172]))) { $EŠ×ä¬ç³õ = IO::mkdir(IO_PATH_SYSTEM_TEMP . $Aš–ÖŒŒ·[173]); } else { $EŠ×ä¬ç³õ = KodIO::make($E—¿……®â); } if ($E—¿……®â = IO::fileNameExist($EŠ×ä¬ç³õ, $e‘£—£)) { $b»›Á¾ù½ï = KodIO::make($E—¿……®â); return IO::fileOut($b»›Á¾ù½ï, !1, $Aº™Ãí¤ÉÍ); } goto Då‰®˜Â–´; Fïµ¦’Üùã: if (!@file_exists($b»›Á¾ù½ï)) { $bÀõìä¾®§ = TEMP_FILES; if (!is_dir($bÀõìä¾®§)) { mk_dir($bÀõìä¾®§); } $d¸µÌšÛ„ç = $bÀõìä¾®§ . $dğ¡–É˜ßĞ . $Aš–ÖŒŒ·[95] . $d™ê—ˆã–ù[$Aš–ÖŒŒ·[168]]; if (!@file_exists($d¸µÌšÛ„ç)) { $d¸µÌšÛ„ç = $this->download($bè¡œ¶Ñ“, $d¸µÌšÛ„ç); } ImageThumb::createThumb($d¸µÌšÛ„ç, $b»›Á¾ù½ï, $eÏğË…”¹¾, $eÏğË…”¹¾ * 10); } if (!file_exists($b»›Á¾ù½ï) || filesize($b»›Á¾ù½ï) < 100) { return @file_exists($d¸µÌšÛ„ç) ? IO::fileOut($d¸µÌšÛ„ç) : $this->fileOut($bè¡œ¶Ñ“); } if (!($cÈÔ—òé÷ô = IO::move($b»›Á¾ù½ï, $EŠ×ä¬ç³õ))) { return IO::fileOut($b»›Á¾ù½ï); } goto F¯¥æÑš—‡; F¯¥æÑš—‡: del_file($b»›Á¾ù½ï); IO::fileOut($cÈÔ—òé÷ô); goto Aè¦ò£„“ß; Aè¦ò£„“ß: } public function fileOutImageServer($aíêˆï‚Ì©, $c­ë›¿œ’Ã = 250) { $this->fileOutImage($aíêˆï‚Ì©, $c­ë›¿œ’Ã); } public function fileNameAuto($FäÚˆ’‡›Ş, $dÖÂ„õ£Ä, $aò†­Ÿõ­ = REPEAT_RENAME, $eÂŠ¡—õÇé = false) { goto d°¨¼åªÇø; bµ°¤ÔµÓ: $D¸ËçÉØá± = 1; $DÜôíÆÒñ· = substr($dÖÂ„õ£Ä, 0, strlen($dÖÂ„õ£Ä) - strlen($Bò‚–„®“™)); $F¹«¡Óõä… = $DÜôíÆÒñ· . "\50{$D¸ËçÉØá±}\x29{$Bò‚–„®“™}"; goto C¥êò‰«Î­; E§¿É¶ß°: if ($aò†­Ÿõ­ == REPEAT_SKIP) { return !1; } $Bò‚–„®“™ = $A©ˆé‚Ğ[95] . get_path_ext($dÖÂ„õ£Ä); $Bò‚–„®“™ = $Bò‚–„®“™ == $A©ˆé‚Ğ[95] || $eÂŠ¡—õÇé ? $A©ˆé‚Ğ[33] : $Bò‚–„®“™; goto bµ°¤ÔµÓ; C¥êò‰«Î­: while ($this->exist(rtrim($FäÚˆ’‡›Ş, $A©ˆé‚Ğ[8]) . $A©ˆé‚Ğ[8] . $F¹«¡Óõä…)) { $F¹«¡Óõä… = $DÜôíÆÒñ· . "\50{$D¸ËçÉØá±}\51{$Bò‚–„®“™}"; $D¸ËçÉØá±++; } return $F¹«¡Óõä…; goto BÎÕ›áÊñÒ; d°¨¼åªÇø: $A©ˆé‚Ğ =& $_SERVER[ªúæÂ¡­ä½]; $aÛßØ’ì‡ = $FäÚˆ’‡›Ş === $A©ˆé‚Ğ[33] ? $dÖÂ„õ£Ä : rtrim($FäÚˆ’‡›Ş, $A©ˆé‚Ğ[8]) . $A©ˆé‚Ğ[8] . $dÖÂ„õ£Ä; if ($aò†­Ÿõ­ == REPEAT_REPLACE || !$this->exist($aÛßØ’ì‡) || $eÂŠ¡—õÇé && $aò†­Ÿõ­ != REPEAT_RENAME_FOLDER) { return $dÖÂ„õ£Ä; } goto E§¿É¶ß°; BÎÕ›áÊñÒ: } private function fileNameAutoList($Eäã¤ƒ¬â›, $Dæ”¯á¼ÍÃ, $dò¬´İ¢ò = false) { goto DÆñ“Ÿ’Û÷; Dóè¡â»‘÷: return $dùæñÃ¬ÜØ; goto Eºº·Õ¶»Ë; fµ••„ÜÀ: $aŞóœ·Äß = substr($Dæ”¯á¼ÍÃ, 0, strlen($Dæ”¯á¼ÍÃ) - strlen($A‘¦·Şæ™)); $dùæñÃ¬ÜØ = $aŞóœ·Äß . "\50\x30\51{$A‘¦·Şæ™}"; for ($a’Æ‘Ò—´” = 1; $a’Æ‘Ò—´” <= count($DŞœæËë¢è) + 1; $a’Æ‘Ò—´”++) { $dùæñÃ¬ÜØ = $aŞóœ·Äß . "\x28{$a’Æ‘Ò—´”}\x29{$A‘¦·Şæ™}"; if (!in_array_not_case($dùæñÃ¬ÜØ, $DŞœæËë¢è)) { return $dùæñÃ¬ÜØ; } } goto Dóè¡â»‘÷; DÆñ“Ÿ’Û÷: $d©¡ØÜÃØ‘ =& $_SERVER[ªúæÂ¡­ä½]; $Cƒ°˜ùí† = $this->listPath($Eäã¤ƒ¬â›, !0); $Cƒ°˜ùí† = array_merge($Cƒ°˜ùí†[$d©¡ØÜÃØ‘[75]], $Cƒ°˜ùí†[$d©¡ØÜÃØ‘[74]]); goto eÀ•±ª «…; eÀ•±ª «…: $DŞœæËë¢è = array_to_keyvalue($Cƒ°˜ùí†, $d©¡ØÜÃØ‘[33], $d©¡ØÜÃØ‘[28]); $A‘¦·Şæ™ = $d©¡ØÜÃØ‘[95] . get_path_ext($Dæ”¯á¼ÍÃ); $A‘¦·Şæ™ = $A‘¦·Şæ™ == $d©¡ØÜÃØ‘[95] || $dò¬´İ¢ò ? $d©¡ØÜÃØ‘[33] : $A‘¦·Şæ™; goto fµ••„ÜÀ; Eºº·Õ¶»Ë: } public function listAllFiles($e¸á ÁÃøö, $fçÈ¡Úğ„», $EõÀöëç÷ğ = array()) { goto dŸ‰ĞòåÅ; dŸ‰ĞòåÅ: $c»ì¢ïŞ‚Ì =& $_SERVER[ªúæÂ¡­ä½]; if (empty($fçÈ¡Úğ„»)) { return array(); } $fƒç‘´Ü„á = array(); goto BË¾‚ßµêŠ; EÓèŸ†¦: foreach (array_unique($fƒç‘´Ü„á) as $eØÖ÷ãã’è) { $f¦®ê”èÃ = array($c»ì¢ïŞ‚Ì[76] => $this->getPathOuter($c»ì¢ïŞ‚Ì[8] . $e¸á ÁÃøö . $c»ì¢ïŞ‚Ì[8] . $eØÖ÷ãã’è), $c»ì¢ïŞ‚Ì[77] => 1, $c»ì¢ïŞ‚Ì[78] => 0); if (substr($eØÖ÷ãã’è, -1) != $c»ì¢ïŞ‚Ì[8]) { $f¦®ê”èÃ[$c»ì¢ïŞ‚Ì[77]] = 0; $DÆèŞÅ©Şª = $this->getPath($e¸á ÁÃøö . $c»ì¢ïŞ‚Ì[8] . $eØÖ÷ãã’è); $f¦®ê”èÃ[$c»ì¢ïŞ‚Ì[78]] = isset($EõÀöëç÷ğ[$DÆèŞÅ©Şª]) ? $EõÀöëç÷ğ[$DÆèŞÅ©Şª] : $this->size($DÆèŞÅ©Şª); } $bÜ‡Œ–ÓŸï[] = $f¦®ê”èÃ; } return $bÜ‡Œ–ÓŸï; goto CªÎãÃ¬˜Ş; BË¾‚ßµêŠ: $e¸á ÁÃøö = trim($e¸á ÁÃøö, $c»ì¢ïŞ‚Ì[8]); foreach ($fçÈ¡Úğ„» as $eØÖ÷ãã’è) { $BÂ“•½ÏÏ¸ = ltrim(substr(trim($eØÖ÷ãã’è, $c»ì¢ïŞ‚Ì[8]), strlen($e¸á ÁÃøö)), $c»ì¢ïŞ‚Ì[8]); $fƒç‘´Ü„á = array_merge($fƒç‘´Ü„á, $this->slicePath($BÂ“•½ÏÏ¸)); } $bÜ‡Œ–ÓŸï = array(); goto EÓèŸ†¦; CªÎãÃ¬˜Ş: } public function slicePath($f¦Êëª„³¬) { $dÌñ›è¶ï½ =& $_SERVER[ªúæÂ¡­ä½]; $cÒ†ö’›¿Î = explode($dÌñ›è¶ï½[8], trim($f¦Êëª„³¬, $dÌñ›è¶ï½[8])); $d ÎÀ„áÏ‹ = 0; do { ++$d ÎÀ„áÏ‹; $CöáìÙÒ¥[] = implode($dÌñ›è¶ï½[8], array_slice($cÒ†ö’›¿Î, 0, $d ÎÀ„áÏ‹)) . $dÌñ›è¶ï½[8]; } while ($d ÎÀ„áÏ‹ < count($cÒ†ö’›¿Î)); $CöáìÙÒ¥[count($cÒ†ö’›¿Î) - 1] = $f¦Êëª„³¬; return $CöáìÙÒ¥; } public function getHost() { $aØŞİÕÁ† =& $_SERVER[ªúæÂ¡­ä½]; $cµ®åÃ¶ùµ = parse_url(trim($this->domain, $aØŞİÕÁ†[8])); $bçß‡ßö = isset($cµ®åÃ¶ùµ[$aØŞİÕÁ†[174]]) ? $cµ®åÃ¶ùµ[$aØŞİÕÁ†[174]] : http_type(); $D‘èñ¨Ç¹ = isset($cµ®åÃ¶ùµ[$aØŞİÕÁ†[175]]) ? $cµ®åÃ¶ùµ[$aØŞİÕÁ†[175]] : $cµ®åÃ¶ùµ[$aØŞİÕÁ†[76]]; if (isset($cµ®åÃ¶ùµ[$aØŞİÕÁ†[176]])) { $D‘èñ¨Ç¹ .= $aØŞİÕÁ†[4] . $cµ®åÃ¶ùµ[$aØŞİÕÁ†[176]]; } return $bçß‡ßö . $aØŞİÕÁ†[177] . $D‘èñ¨Ç¹; } public function pathEncode($dˆ²ÀÍÊĞ) { $A¨Ø†·ÙÉÍ =& $_SERVER[ªúæÂ¡­ä½]; return str_replace($A¨Ø†·ÙÉÍ[178], $A¨Ø†·ÙÉÍ[8], rawurlencode($dˆ²ÀÍÊĞ)); } } class PathDriverBaseS3 extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $useSSL = false; protected $region = ''; protected $endpoint = ''; protected $bucket = ''; protected $client = null; protected $signVer = "\x76\64"; public $ioUploadServer = "\x30"; public $ioFileOutServer = "\x30"; public function __construct($fÚ¿ØÇÈàŞ) { set_timeout(); require_once SDK_DIR . $_SERVER[ªúæÂ¡­ä½][179]; parent::__construct(); $this->_init($fÚ¿ØÇÈàŞ); } public function _init($b‹›î§îâÔ) { foreach ($b‹›î§îâÔ as $B†¶ÃÅï× => $CåøØâ†À¶) { if (isset($this->{$B†¶ÃÅï×})) { $this->{$B†¶ÃÅï×} = $CåøØâ†À¶; } } $this->endpoint = $b‹›î§îâÔ[$_SERVER[ªúæÂ¡­ä½][180]]; $this->client = new S3($this->accessKey, $this->secret, $this->useSSL, $this->endpoint, $this->region); $this->client->setEndpoint($this->getHost()); } public function signatureVersion($Fˆğˆ‰’ÄÈ = "\x76\x34") { $this->signVer = $Fˆğˆ‰’ÄÈ; $this->client->setSignatureVersion($Fˆğˆ‰’ÄÈ); } public function setBucketCors() { return $this->client->setBucketCors($this->bucket); } public function getBucketCors() { return $this->client->getBucketCors($this->bucket); } public function isBucketCors() { goto fæƒ‘­Ù¢; aŞ¿‡É¥‚: if ($EÓ…“í‘ÛØ[$E×¨‚ñÂ˜‰[181]] != $E×¨‚ñÂ˜‰[182] || $EÓ…“í‘ÛØ[$E×¨‚ñÂ˜‰[183]] != $E×¨‚ñÂ˜‰[182]) { return !1; } $cË—Æ†ÆŒµ = array_map($E×¨‚ñÂ˜‰[184], $EÓ…“í‘ÛØ[$E×¨‚ñÂ˜‰[185]]); if (!is_array($cË—Æ†ÆŒµ)) { $cË—Æ†ÆŒµ = array(); } goto FëÜàøå‘Ô; FëÜàøå‘Ô: $dÏ›¢›±‚¢ = array($E×¨‚ñÂ˜‰[186], $E×¨‚ñÂ˜‰[187], $E×¨‚ñÂ˜‰[188], $E×¨‚ñÂ˜‰[189], $E×¨‚ñÂ˜‰[190]); $b¶«ƒ¾£¾ = array_diff($dÏ›¢›±‚¢, $cË—Æ†ÆŒµ); return empty($b¶«ƒ¾£¾); goto A‚ñ¡¿‘Œæ; fæƒ‘­Ù¢: $E×¨‚ñÂ˜‰ =& $_SERVER[ªúæÂ¡­ä½]; $EÓ…“í‘ÛØ = $this->getBucketCors(); if (!$EÓ…“í‘ÛØ || !is_array($EÓ…“í‘ÛØ)) { return !1; } goto aŞ¿‡É¥‚; A‚ñ¡¿‘Œæ: } public function mkfile($Dñâ¨¨ö’‘, $bîİ­øäİ = '', $F““Á¼¡… = REPEAT_RENAME) { $aèöíîÍÊ¯ = $this->setContent($Dñâ¨¨ö’‘, $bîİ­øäİ); if ($aèöíîÍÊ¯ !== !1) { return $this->getPathOuter($Dñâ¨¨ö’‘); } return !1; } public function mkdir($F•áòöçš, $dƒ½ËË°ö = REPEAT_SKIP) { $d„’Á¾ÁË¿ =& $_SERVER[ªúæÂ¡­ä½]; if (empty($F•áòöçš) && $F•áòöçš !== $d„’Á¾ÁË¿[191]) { return !1; } if ($this->_isFolder($F•áòöçš)) { return $this->getPathOuter($F•áòöçš); } $f‹ÁÄäÄ×ñ = $this->setContent($F•áòöçš, $d„’Á¾ÁË¿[33], !0); if ($f‹ÁÄäÄ×ñ !== !1) { return $this->getPathOuter($F•áòöçš); } return !1; } public function copyFile($eì‘óƒ•ôê, $A†‰˜×Û¤´, $Aª´Ô„¹· = array()) { $bšºõê˜ßÈ =& $_SERVER[ªúæÂ¡­ä½]; $e¸¨ÉéÚÀª = $this->objectMeta($eì‘óƒ•ôê); if (!$e¸¨ÉéÚÀª) { return !1; } if ($e¸¨ÉéÚÀª[$bšºõê˜ßÈ[78]] <= 1024 * 1024 * 200) { $eÌ¤Œ™È»‘ = $this->client->copyObject($this->bucket, $eì‘óƒ•ôê, $this->bucket, $A†‰˜×Û¤´, $bšºõê˜ßÈ[192], $Aª´Ô„¹·); } else { $eÌ¤Œ™È»‘ = $this->client->multiCopyObject($this->bucket, $eì‘óƒ•ôê, $this->bucket, $A†‰˜×Û¤´, $Aª´Ô„¹·); } $eÌ¤Œ™È»‘ = $eÌ¤Œ™È»‘ ? $this->getPathOuter($A†‰˜×Û¤´) : !1; return $eÌ¤Œ™È»‘; } public function moveFile($B¾Ğâ éñİ, $aÖ‰ã‰±‚”) { if ($this->copyFile($B¾Ğâ éñİ, $aÖ‰ã‰±‚”)) { $this->delFile($B¾Ğâ éñİ); return $this->getPathOuter($aÖ‰ã‰±‚”); } return !1; } public function delFile($D“¡ôêˆô®) { return $this->client->deleteObject($this->bucket, $D“¡ôêˆô®); } public function delFolder($cêÃçƒ‚¥ó) { goto Eôè—çœ; Aù‰ÉİÏ²ï: $Bê…Õ–Ô£ñ = $this->fileList($cêÃçƒ‚¥ó); $this->listItemCache = !0; $Aê«ç…×öÓ = trim($cêÃçƒ‚¥ó, $C‚éÒÖ“ñÀ[8]) . $C‚éÒÖ“ñÀ[8]; goto e¹Üœ™–ò¯; e¹Üœ™–ò¯: if (!empty($cêÃçƒ‚¥ó) && $cêÃçƒ‚¥ó !== $C‚éÒÖ“ñÀ[191] && !in_array($Aê«ç…×öÓ, $Bê…Õ–Ô£ñ[$C‚éÒÖ“ñÀ[75]])) { $Bê…Õ–Ô£ñ[$C‚éÒÖ“ñÀ[75]][] = $Aê«ç…×öÓ; } $A§ˆˆÉ¶Ïß = $this->delByBatch($Bê…Õ–Ô£ñ[$C‚éÒÖ“ñÀ[74]]); if (!$A§ˆˆÉ¶Ïß) { return !1; } goto bÁ‘ÈóÃ›; bÁ‘ÈóÃ›: $A§ˆˆÉ¶Ïß = $this->delByBatch($Bê…Õ–Ô£ñ[$C‚éÒÖ“ñÀ[75]]); if (!$A§ˆˆÉ¶Ïß) { return !1; } return $this->delFile($Aê«ç…×öÓ); goto BÊÚíÓÆÒ‘; Eôè—çœ: $C‚éÒÖ“ñÀ =& $_SERVER[ªúæÂ¡­ä½]; if (!$this->exist($cêÃçƒ‚¥ó)) { return !0; } $this->listItemCache = !1; goto Aù‰ÉİÏ²ï; BÊÚíÓÆÒ‘: } private function delByBatch($CíÆ´Ô„ˆğ) { foreach (array_chunk($CíÆ´Ô„ˆğ, 1000) as $aèØØ…‰Ñ) { $b ¸¡åÍÅ = $this->client->deleteObjects($this->bucket, $aèØØ…‰Ñ); if (!$b ¸¡åÍÅ) { return !1; } } return !0; } public function rename($BªÙË«ÏéÖ, $fŠÄ§õ‹”) { return $this->renameObject($BªÙË«ÏéÖ, $fŠÄ§õ‹”); } public function listPath($f¥‘§Şô‘, $bŠ‰ †”í = false) { $A¿»Ô­Œƒ÷ =& $_SERVER[ªúæÂ¡­ä½]; $a‡íè¼à•£ = $this->fileList($f¥‘§Şô‘, $A¿»Ô­Œƒ÷[8], !0); foreach ($a‡íè¼à•£[$A¿»Ô­Œƒ÷[75]] as $EäˆŒŒéã‘ => $aØ­Ğˆ¹Á) { $a‡íè¼à•£[$A¿»Ô­Œƒ÷[75]][$EäˆŒŒéã‘] = $this->folderInfo($aØ­Ğˆ¹Á, $bŠ‰ †”í); } foreach ($a‡íè¼à•£[$A¿»Ô­Œƒ÷[74]] as $EäˆŒŒéã‘ => $aØ­Ğˆ¹Á) { $a‡íè¼à•£[$A¿»Ô­Œƒ÷[74]][$EäˆŒŒéã‘] = $this->fileInfo($aØ­Ğˆ¹Á[$A¿»Ô­Œƒ÷[28]], $bŠ‰ †”í, $aØ­Ğˆ¹Á); } return $a‡íè¼à•£; } private function fileInfo($fŠ¿’´¤ñ¨, $Bë®‹ø¾Àƒ = false, $EßéˆŸ… = array()) { goto F¥™Á•á; CĞÜ¼„Öò: $C»‰Ì¡Äöœ[$aÊ÷ïŠô‘[194]] = $C»‰Ì¡Äöœ[$aÊ÷ïŠô‘[84]] = 0; $C»‰Ì¡Äöœ[$aÊ÷ïŠô‘[195]] = $C»‰Ì¡Äöœ[$aÊ÷ïŠô‘[196]] = !0; if (empty($EßéˆŸ…)) { $EßéˆŸ… = $this->objectMeta($fŠ¿’´¤ñ¨); if (!$EßéˆŸ…) { return $C»‰Ì¡Äöœ; } } goto a™¡¦ÍøÊ•; a™¡¦ÍøÊ•: if (isset($EßéˆŸ…[$aÊ÷ïŠô‘[197]])) { $C»‰Ì¡Äöœ[$aÊ÷ïŠô‘[84]] = $EßéˆŸ…[$aÊ÷ïŠô‘[197]]; } if (isset($EßéˆŸ…[$aÊ÷ïŠô‘[78]])) { $C»‰Ì¡Äöœ[$aÊ÷ïŠô‘[78]] = $EßéˆŸ…[$aÊ÷ïŠô‘[78]]; } return $C»‰Ì¡Äöœ; goto fÕòšŠöÃ´; F¥™Á•á: $aÊ÷ïŠô‘ =& $_SERVER[ªúæÂ¡­ä½]; $C»‰Ì¡Äöœ = array($aÊ÷ïŠô‘[28] => $this->pathThis($fŠ¿’´¤ñ¨), $aÊ÷ïŠô‘[76] => $this->getPathOuter($fŠ¿’´¤ñ¨), $aÊ÷ïŠô‘[29] => $aÊ÷ïŠô‘[193], $aÊ÷ïŠô‘[168] => $this->ext($fŠ¿’´¤ñ¨), $aÊ÷ïŠô‘[78] => isset($EßéˆŸ…[$aÊ÷ïŠô‘[78]]) ? $EßéˆŸ…[$aÊ÷ïŠô‘[78]] : 0); if ($Bë®‹ø¾Àƒ) { return $C»‰Ì¡Äöœ; } goto CĞÜ¼„Öò; fÕòšŠöÃ´: } private function folderInfo($e–¢§”©¢–, $CŒÖƒˆ„»½ = false) { goto c“·Ó¿¥‚Ã; eÑ¤·Úß…·: $Aéè±Éô·Ò[$fÈêÚ‘ÖÚ[194]] = $Aéè±Éô·Ò[$fÈêÚ‘ÖÚ[84]] = 0; $Aéè±Éô·Ò[$fÈêÚ‘ÖÚ[195]] = $Aéè±Éô·Ò[$fÈêÚ‘ÖÚ[196]] = !0; if ($e–¢§”©¢– == $fÈêÚ‘ÖÚ[33]) { return $Aéè±Éô·Ò; } goto B³ĞêØ°àœ; B³ĞêØ°àœ: $e–¢§”©¢– = trim($e–¢§”©¢–, $fÈêÚ‘ÖÚ[8]) . $fÈêÚ‘ÖÚ[8]; $a‰Ş÷¸¡¶Ü = $this->objectMeta($e–¢§”©¢–); if (isset($a‰Ş÷¸¡¶Ü[$fÈêÚ‘ÖÚ[197]])) { $Aéè±Éô·Ò[$fÈêÚ‘ÖÚ[194]] = $a‰Ş÷¸¡¶Ü[$fÈêÚ‘ÖÚ[197]]; } goto b¹¹å×µÕğ; b¹¹å×µÕğ: return $Aéè±Éô·Ò; goto bŒğ—£¢À; c“·Ó¿¥‚Ã: $fÈêÚ‘ÖÚ =& $_SERVER[ªúæÂ¡­ä½]; $Aéè±Éô·Ò = array($fÈêÚ‘ÖÚ[28] => $this->pathThis($e–¢§”©¢–), $fÈêÚ‘ÖÚ[76] => $this->getPathOuter($fÈêÚ‘ÖÚ[8] . $e–¢§”©¢–), $fÈêÚ‘ÖÚ[29] => $fÈêÚ‘ÖÚ[77]); if ($CŒÖƒˆ„»½) { return $Aéè±Éô·Ò; } goto eÑ¤·Úß…·; bŒğ—£¢À: } private function fileList($A½Öíã¤Í, $f³•ğˆéß = '', $FÈÑóÏ”“Å = 0) { goto D¹‡ˆØĞ§¼; díˆ¦Š™ôŞ: if (!$d†Ä¢µù˜¦) { return array($A¹—ñö†ó[75] => array(), $A¹—ñö†ó[74] => array()); } $a¡À¥—Ó™¸ = $this->listItemCache === !1 ? !1 : !0; $B ÜÓ¦Îêª = $DÔŠ±¨»Ã¤ = array(); goto fåÊ”Ó˜; f¼İÚŞâä‹: return array($A¹—ñö†ó[75] => $B ÜÓ¦Îêª, $A¹—ñö†ó[74] => $DÔŠ±¨»Ã¤); goto aºÓé¨ğ¿·; D¹‡ˆØĞ§¼: $A¹—ñö†ó =& $_SERVER[ªúæÂ¡­ä½]; $C«ÎÀŸäº = rtrim($A½Öíã¤Í, $A¹—ñö†ó[8]) . $A¹—ñö†ó[8]; $d†Ä¢µù˜¦ = $this->listObjs($C«ÎÀŸäº, null, null, $f³•ğˆéß); goto díˆ¦Š™ôŞ; fåÊ”Ó˜: foreach ($d†Ä¢µù˜¦[$A¹—ñö†ó[198]] as $bìŠ—§®†Ş) { goto fÆÌêáÃ³; DššŠ›ñÑ: $DÔŠ±¨»Ã¤[] = $FÈÑóÏ”“Å ? $bìŠ—§®†Ş : $cÏËË«×ğ÷; goto eÓßîïŸ®º; a¬ø‚×ÃÏ: $Cë„Ÿ’Èé© = $DâñÙÄ‰Ë == 0 && substr($cÏËË«×ğ÷, strlen($cÏËË«×ğ÷) - 1, 1) == $A¹—ñö†ó[8] ? !0 : !1; if ($a¡À¥—Ó™¸) { $this->cacheMethod($A¹—ñö†ó[199], $cÏËË«×ğ÷, $Cë„Ÿ’Èé©); $this->cacheMethod($A¹—ñö†ó[200], $cÏËË«×ğ÷, $bìŠ—§®†Ş); } if ($Cë„Ÿ’Èé©) { $B ÜÓ¦Îêª[] = $cÏËË«×ğ÷; continue; } goto DššŠ›ñÑ; fÆÌêáÃ³: $cÏËË«×ğ÷ = $bìŠ—§®†Ş[$A¹—ñö†ó[28]]; if ($cÏËË«×ğ÷ == $C«ÎÀŸäº) { continue; } $DâñÙÄ‰Ë = isset($bìŠ—§®†Ş[$A¹—ñö†ó[78]]) ? $bìŠ—§®†Ş[$A¹—ñö†ó[78]] : 0; goto a¬ø‚×ÃÏ; eÓßîïŸ®º: } foreach ($d†Ä¢µù˜¦[$A¹—ñö†ó[201]] as $bìŠ—§®†Ş) { $B ÜÓ¦Îêª[] = $bìŠ—§®†Ş[$A¹—ñö†ó[28]]; if ($a¡À¥—Ó™¸) { $this->cacheMethod($A¹—ñö†ó[199], $bìŠ—§®†Ş[$A¹—ñö†ó[28]], !0); } } if ($a¡À¥—Ó™¸) { $this->cacheMethod($A¹—ñö†ó[199], $A½Öíã¤Í, !0); } goto f¼İÚŞâä‹; aºÓé¨ğ¿·: } private function listObjs($FÏóœÄÌ—, $Bˆ°ÂÏÎÏ— = null, $c¡ìåˆ—ß = null, $f¼ÕîÚ‚ = null) { $c‰¹²—ºÒ =& $_SERVER[ªúæÂ¡­ä½]; $FÏóœÄÌ— = trim($FÏóœÄÌ—, $c‰¹²—ºÒ[8]); $bÃ¸Ù‘ÕÈÒ = empty($FÏóœÄÌ—) && $FÏóœÄÌ— !== $c‰¹²—ºÒ[191] ? $c‰¹²—ºÒ[33] : $FÏóœÄÌ— . $c‰¹²—ºÒ[8]; return $this->client->getBucket($this->bucket, $bÃ¸Ù‘ÕÈÒ, $Bˆ°ÂÏÎÏ—, $c¡ìåˆ—ß, $f¼ÕîÚ‚, !0); } public function has($c­ñäÓ•¹È, $Cô¿Ã×ã¾è = false, $A¡ßà‡Ï„¥ = true) { goto fÙ»èÄù·ƒ; fÙ»èÄù·ƒ: $AÉ¡Ù­ÀœÏ =& $_SERVER[ªúæÂ¡­ä½]; $c­ñäÓ•¹È = trim($c­ñäÓ•¹È, $AÉ¡Ù­ÀœÏ[8]); $cÜ¡µ²êŞ« = empty($c­ñäÓ•¹È) && $c­ñäÓ•¹È !== $AÉ¡Ù­ÀœÏ[191] ? $AÉ¡Ù­ÀœÏ[33] : $c­ñäÓ•¹È . $AÉ¡Ù­ÀœÏ[8]; goto eÀİïøÌê®; eÀİïøÌê®: $eÊÕ¶Ò„½ = null; $F¿ÃÌ‚‹­ = 500; $F„æÉäœÈ¼ = $AÉ¡Ù­ÀœÏ[8]; goto B›‡Àòßôˆ; aá±ÃÛÁóË: return !1; goto BùÌÆ“µ‡»; B›‡Àòßôˆ: $aéÁ…¹ò = $d‰¬…ˆì   = array(); while (!0) { $dÌ ƒ¥ğÅ‰ = $this->listObjs($c­ñäÓ•¹È, $eÊÕ¶Ò„½, $F¿ÃÌ‚‹­, $F„æÉäœÈ¼); if (!$dÌ ƒ¥ğÅ‰) { break; } $eÊÕ¶Ò„½ = $dÌ ƒ¥ğÅ‰[$AÉ¡Ù­ÀœÏ[202]]; $a©¢«ƒë´ = $dÌ ƒ¥ğÅ‰[$AÉ¡Ù­ÀœÏ[198]]; $eá‚Š±Š = $dÌ ƒ¥ğÅ‰[$AÉ¡Ù­ÀœÏ[201]]; if (empty($a©¢«ƒë´) && empty($eá‚Š±Š)) { break; } if (count($a©¢«ƒë´) == 1 && $a©¢«ƒë´[0][$AÉ¡Ù­ÀœÏ[28]] == $cÜ¡µ²êŞ«) { break; } if ($Cô¿Ã×ã¾è) { if (count($a©¢«ƒë´)) { $a©¢«ƒë´ = array_column($a©¢«ƒë´, $AÉ¡Ù­ÀœÏ[28]); $aéÁ…¹ò = array_merge($aéÁ…¹ò, $a©¢«ƒë´); } if (count($eá‚Š±Š)) { $eá‚Š±Š = array_column($eá‚Š±Š, $AÉ¡Ù­ÀœÏ[28]); $d‰¬…ˆì   = array_merge($d‰¬…ˆì  , $eá‚Š±Š); } if ($eÊÕ¶Ò„½ === null) { break; } continue; } if ($A¡ßà‡Ï„¥) { if (!empty($a©¢«ƒë´)) { if (count($a©¢«ƒë´) > 1 || isset($a©¢«ƒë´[0][$AÉ¡Ù­ÀœÏ[28]]) && $a©¢«ƒë´[0][$AÉ¡Ù­ÀœÏ[28]] != $cÜ¡µ²êŞ«) { return !0; } } } else { if (!empty($eá‚Š±Š)) { return !0; } } if ($eÊÕ¶Ò„½ === null) { break; } } if ($Cô¿Ã×ã¾è) { $aéÁ…¹ò = array_diff($aéÁ…¹ò, array($cÜ¡µ²êŞ«)); $aéÁ…¹ò = count(array_unique($aéÁ…¹ò)); $d‰¬…ˆì   = count(array_unique($d‰¬…ˆì  )); return array($AÉ¡Ù­ÀœÏ[203] => $aéÁ…¹ò, $AÉ¡Ù­ÀœÏ[204] => $d‰¬…ˆì  ); } goto aá±ÃÛÁóË; BùÌÆ“µ‡»: } public function listAll($eÆŠø«å¤) { $F¨¡‚ÂÖ×È =& $_SERVER[ªúæÂ¡­ä½]; $D÷²‚å‘ñî = $this->fileList($eÆŠø«å¤, $F¨¡‚ÂÖ×È[33], !0); $Cš…Š…ó–ˆ = array(); foreach ($D÷²‚å‘ñî[$F¨¡‚ÂÖ×È[74]] as $C¨†ÕŠàĞ) { $Cš…Š…ó–ˆ[$C¨†ÕŠàĞ[$F¨¡‚ÂÖ×È[28]]] = $C¨†ÕŠàĞ[$F¨¡‚ÂÖ×È[78]]; } foreach ($D÷²‚å‘ñî[$F¨¡‚ÂÖ×È[75]] as $C¨†ÕŠàĞ) { if (is_string($C¨†ÕŠàĞ)) { $Cš…Š…ó–ˆ[$C¨†ÕŠàĞ] = 0; } } return $this->listAllFiles($eÆŠø«å¤, array_keys($Cš…Š…ó–ˆ), $Cš…Š…ó–ˆ); } public function canRead($bëà¢ˆå˜Á) { $Bˆ‡Ñ‡“¯ç =& $_SERVER[ªúæÂ¡­ä½]; $f§ìá¦‚¯Ø = $this->client->getAccessControlPolicy($this->bucket, $bëà¢ˆå˜Á); if (!$f§ìá¦‚¯Ø) { return !1; } return in_array($f§ìá¦‚¯Ø, array($Bˆ‡Ñ‡“¯ç[205], $Bˆ‡Ñ‡“¯ç[206], $Bˆ‡Ñ‡“¯ç[207])) ? !0 : !1; } public function canWrite($EÎ²¬õ‰îå) { $E·›•†äƒƒ =& $_SERVER[ªúæÂ¡­ä½]; $D¢Òá×©•Ï = $this->client->getAccessControlPolicy($this->bucket, $EÎ²¬õ‰îå); if (!$D¢Òá×©•Ï) { return !1; } return in_array($D¢Òá×©•Ï, array($E·›•†äƒƒ[205], $E·›•†äƒƒ[206])) ? !0 : !1; } public function getContent($a¹»§Ší¨¿) { return $this->client->getObject($this->bucket, $a¹»§Ší¨¿); } public function setContent($cï¨öÀíœ”, $F’ç°×Şğç = '', $dğ¾¤¡Ò°Í = false) { goto a ¨åÚËË; e¯Å±ŒßÜ: $cËŸÊÅØ¦± = $this->client->putObject($F’ç°×Şğç, $this->bucket, $cï¨öÀíœ”, $C¦¾¸Û‘±ä[192], array(), $B¢§šã‚); if (!$cËŸÊÅØ¦±) { return !1; } if ($dğ¾¤¡Ò°Í) { return !0; } goto Fá»œƒœ»Ù; Fá»œƒœ»Ù: $this->cacheMethod(null, null); $cËŸÊÅØ¦± = $this->copyFile($cï¨öÀíœ”, $cï¨öÀíœ”, array($C¦¾¸Û‘±ä[208] => $cËŸÊÅØ¦±[$C¦¾¸Û‘±ä[209]])); return $cËŸÊÅØ¦± ? !0 : !1; goto Ağ¢™ÑÃ‰º; a ¨åÚËË: $C¦¾¸Û‘±ä =& $_SERVER[ªúæÂ¡­ä½]; $cï¨öÀíœ” = $dğ¾¤¡Ò°Í ? trim($cï¨öÀíœ”, $C¦¾¸Û‘±ä[8]) . $C¦¾¸Û‘±ä[8] : $cï¨öÀíœ”; $B¢§šã‚ = get_file_mime(get_path_ext($cï¨öÀíœ”)); goto e¯Å±ŒßÜ; Ağ¢™ÑÃ‰º: } public function fileSubstr($e›ù¨“¢, $aùÆ§¨‚Ïñ, $BÆÂ¾¯˜•§) { $dî¿ƒ°³›› = $aùÆ§¨‚Ïñ + $BÆÂ¾¯˜•§ - 1; return $this->client->getObject($this->bucket, $e›ù¨“¢, array($_SERVER[ªúæÂ¡­ä½][210] => "\x62\171\164\145\163\x3d{$aùÆ§¨‚Ïñ}\x2d{$dî¿ƒ°³››}")); } public function upload($d›Õ×®›ˆ, $b‰­ÔË¡‘, $b‡ó¯»ÃàÅ = false, $aöšÙáäšÏ = REPEAT_REPLACE) { $AâĞË™•Ë‘ =& $_SERVER[ªúæÂ¡­ä½]; $AÚ›ò½±ë = array($AâĞË™•Ë‘[208] => @md5_file($b‰­ÔË¡‘)); $Aİ¬§òäõ = array($AâĞË™•Ë‘[211] => get_file_mime(get_path_ext($d›Õ×®›ˆ))); if (IO::size($b‰­ÔË¡‘) <= 1024 * 1024 * 200) { $dòŒËè«¤  = $this->client->putObjectFile($b‰­ÔË¡‘, $this->bucket, $d›Õ×®›ˆ, $AâĞË™•Ë‘[192], $AÚ›ò½±ë, $Aİ¬§òäõ); return !empty($dòŒËè«¤ ) ? $this->getPathOuter($d›Õ×®›ˆ) : !1; } $Aß‚Ÿà—¸À = $this->client->multiUploadObject($b‰­ÔË¡‘, $this->bucket, trim($d›Õ×®›ˆ, $AâĞË™•Ë‘[8]), $AÚ›ò½±ë, $Aİ¬§òäõ); return $Aß‚Ÿà—¸À ? $this->getPathOuter($d›Õ×®›ˆ) : !1; } public function download($dÍ²ß÷ÅŞ§, $E·àÎÂ„‹“) { if (!@is_dir($this->pathFather($E·àÎÂ„‹“)) && !IO::mkdir($this->pathFather($E·àÎÂ„‹“))) { return !1; } $f¾ùÎ×Ş‘ = $this->client->getObject($this->bucket, $dÍ²ß÷ÅŞ§, array(), $E·àÎÂ„‹“); return $f¾ùÎ×Ş‘ !== !1 ? $E·àÎÂ„‹“ : !1; } public function link($EŒÑ£Ù«‡†, $CÁ‘å°¤æ× = array()) { $AŠ”òÓöøç =& $_SERVER[ªúæÂ¡­ä½]; if ($this->signVer == $AŠ”òÓöøç[212]) { return $this->client->getAuthenticatedURL($this->bucket, $EŒÑ£Ù«‡†, 3600 * 12, $CÁ‘å°¤æ×); } return $this->client->getObjectUrl($this->accessKey, $this->secret, $this->bucket, trim($EŒÑ£Ù«‡†, $AŠ”òÓöøç[8]), 3600 * 12, $this->region, array(), !0, $CÁ‘å°¤æ×); } public function fileOut($dŒãöÛâÄŸ, $E¿‚ô¤óĞá = false, $f¹Œ…ØÓŠŸ = false, $BÅ²¨Şè‹³ = '') { goto eÆçÒ”’ºß; eÆçÒ”’ºß: $F»èÃĞ™Âß =& $_SERVER[ªúæÂ¡­ä½]; if ($this->isFileOutServer()) { return $this->fileOutServer($dŒãöÛâÄŸ, $E¿‚ô¤óĞá, $f¹Œ…ØÓŠŸ, $BÅ²¨Şè‹³); } if (!$f¹Œ…ØÓŠŸ) { $f¹Œ…ØÓŠŸ = $this->pathThis($dŒãöÛâÄŸ); } goto Fã¹—Ä—÷¯; Fã¹—Ä—÷¯: $d¸Íã´Òù = get_file_mime(get_path_ext($f¹Œ…ØÓŠŸ)); if ($d¸Íã´Òù == $F»èÃĞ™Âß[213]) { return parent::fileOut($dŒãöÛâÄŸ, $E¿‚ô¤óĞá, $f¹Œ…ØÓŠŸ, $BÅ²¨Şè‹³); } $E¿‚ô¤óĞá = $E¿‚ô¤óĞá ? $F»èÃĞ™Âß[214] : $F»èÃĞ™Âß[215]; goto c¥Å§ï”Ğ; c¥Å§ï”Ğ: $A™ìµ–Á® = array($F»èÃĞ™Âß[216] => $E¿‚ô¤óĞá . $F»èÃĞ™Âß[217] . rawurlencode($f¹Œ…ØÓŠŸ), $F»èÃĞ™Âß[218] => $d¸Íã´Òù); $C É§’ÌÈ = $this->link($dŒãöÛâÄŸ, $A™ìµ–Á®); $this->fileOutLink($C É§’ÌÈ); goto FÃÆ÷„¢–; FÃÆ÷„¢–: } public function fileOutServer($C¿íˆ¡·ãŠ, $c©É ¢Šƒ = false, $e×Ä«£‡İÁ = false, $e˜ÁÛ‰«› = '') { parent::fileOut($C¿íˆ¡·ãŠ, $c©É ¢Šƒ, $e×Ä«£‡İÁ, $e˜ÁÛ‰«›); } public function fileOutImageServer($cÙ›Ó¨ñäğ, $fì¢Ê—õÛƒ = 250) { parent::fileOutImage($cÙ›Ó¨ñäğ, $fì¢Ê—õÛƒ); } public function hashMd5($fé˜ÉÃîÙ¹, $C¥®†¹‘š = '') { $d¢ç‘ƒŠ×µ =& $_SERVER[ªúæÂ¡­ä½]; $f¢¹™¬³åš = $this->objectMeta($fé˜ÉÃîÙ¹); if (!$f¢¹™¬³åš) { return !1; } $C¥®†¹‘š = $C¥®†¹‘š ? $C¥®†¹‘š : _get($f¢¹™¬³åš, $d¢ç‘ƒŠ×µ[219]); $C¥®†¹‘š = $C¥®†¹‘š ? $C¥®†¹‘š : _get($f¢¹™¬³åš, $d¢ç‘ƒŠ×µ[209], $d¢ç‘ƒŠ×µ[33]); return $C¥®†¹‘š; } public function uploadFormData($A§„Ç ¸‚, $E¤…¥›ƒÄ× = 3600) { $EåÂ’óÓŒº =& $_SERVER[ªúæÂ¡­ä½]; $F¯É”˜·Ïï = $this->pathFather($A§„Ç ¸‚); $B”…‡¿ñŒ÷ = $this->client->getHttpUploadPostParams($this->bucket, $F¯É”˜·Ïï, $EåÂ’óÓŒº[192], $E¤…¥›ƒÄ×); return array_merge((array) $B”…‡¿ñŒ÷, array($EåÂ’óÓŒº[175] => $this->getHost())); } public function multiUploadFormData($E¨©òï˜‹, $F®šÊ‚´­“ = 3600) { $bÈ¬š¹Ù¼Ù =& $_SERVER[ªúæÂ¡­ä½]; $dŞ»è‘¡•¼ = gmdate($bÈ¬š¹Ù¼Ù[220]); $d¿Ã×•¾â = array(); $däµô‰ÓÛ• = $this->client->getUploadId($this->bucket, $E¨©òï˜‹, $d¿Ã×•¾â); if (!$däµô‰ÓÛ•) { return !1; } return array($bÈ¬š¹Ù¼Ù[221] => $däµô‰ÓÛ•, $bÈ¬š¹Ù¼Ù[175] => $this->getHost() . $bÈ¬š¹Ù¼Ù[8] . $this->pathEncode($E¨©òï˜‹), $bÈ¬š¹Ù¼Ù[222] => $dŞ»è‘¡•¼, $bÈ¬š¹Ù¼Ù[93] => $E¨©òï˜‹); } public function multiUploadAuthData($d±µÒÇ, $cê¿ÉÙ„Â­ = array()) { goto C¸Ï–Öéš ; aÜ’¯¶Ã—Û: $BÖÌ†÷öí¢ = $cê¿ÉÙ„Â­[$EÛ‘ğ‰Í[93]]; unset($cê¿ÉÙ„Â­[$EÛ‘ğ‰Í[93]]); if (isset($cê¿ÉÙ„Â­[$EÛ‘ğ‰Í[223]])) { $cê¿ÉÙ„Â­[$EÛ‘ğ‰Í[222]] = $EÉ§”íİœŠ; return $this->listUploadParts($BÖÌ†÷öí¢, $cê¿ÉÙ„Â­); } goto b…¯Âì÷Âò; C¸Ï–Öéš : $EÛ‘ğ‰Í =& $_SERVER[ªúæÂ¡­ä½]; $EÉ§”íİœŠ = isset($cê¿ÉÙ„Â­[$EÛ‘ğ‰Í[222]]) ? $cê¿ÉÙ„Â­[$EÛ‘ğ‰Í[222]] : gmdate($EÛ‘ğ‰Í[220]); $cˆäµÖ˜åÅ = isset($cê¿ÉÙ„Â­[$EÛ‘ğ‰Í[168]]) ? $cê¿ÉÙ„Â­[$EÛ‘ğ‰Í[168]] : $EÛ‘ğ‰Í[33]; goto aÜ’¯¶Ã—Û; d¦æèá»Å: if (strpos($cˆäµÖ˜åÅ, $EÛ‘ğ‰Í[225]) === 0) { return array($EÛ‘ğ‰Í[232] => $BøÃÂÒ»˜, $EÛ‘ğ‰Í[222] => $EÉ§”íİœŠ); } return $BøÃÂÒ»˜; goto ağ“óƒ±ùŸ; b…¯Âì÷Âò: $aƒÊåùË»  = array($EÛ‘ğ‰Í[224], $EÛ‘ğ‰Í[33], $EÛ‘ğ‰Í[119], $EÛ‘ğ‰Í[33], "\x78\55\141\155\172\55\x64\141\164\145\x3a{$EÉ§”íİœŠ}", $EÛ‘ğ‰Í[8] . $this->bucket . $EÛ‘ğ‰Í[8] . $this->pathEncode($BÖÌ†÷öí¢) . $cˆäµÖ˜åÅ); if (strpos($cˆäµÖ˜åÅ, $EÛ‘ğ‰Í[225]) === 0) { $aƒÊåùË» [0] = $EÛ‘ğ‰Í[226]; } if (isset($cê¿ÉÙ„Â­[$EÛ‘ğ‰Í[227]]) && $cê¿ÉÙ„Â­[$EÛ‘ğ‰Í[227]] == $EÛ‘ğ‰Í[228]) { $aƒÊåùË» [0] = $EÛ‘ğ‰Í[228]; } goto BÒ‰¸®ïÎ”; BÒ‰¸®ïÎ”: $f„†ˆÉ³Şˆ = implode($EÛ‘ğ‰Í[229], $aƒÊåùË» ); $E×à¿…¹ğê = base64_encode(hash_hmac($EÛ‘ğ‰Í[230], $f„†ˆÉ³Şˆ, $this->secret, !0)); $BøÃÂÒ»˜ = $EÛ‘ğ‰Í[231] . $this->accessKey . $EÛ‘ğ‰Í[4] . $E×à¿…¹ğê; goto d¦æèá»Å; ağ“óƒ±ùŸ: } public function listUploadParts($Dãµ¡¦ùñ‰, $bºÓ¿¯ë‡ì = array()) { goto Fõ’‡š™¬; b¿¶œ‘×: if (!$c¢Š´š—ã) { return !1; } unset($bºÓ¿¯ë‡ì[$dµµî¹¤£î[223]], $bºÓ¿¯ë‡ì[$dµµî¹¤£î[227]]); $bºÓ¿¯ë‡ì[$dµµî¹¤£î[93]] = $Dãµ¡¦ùñ‰; goto dÂçÈè—šè; Fõ’‡š™¬: $dµµî¹¤£î =& $_SERVER[ªúæÂ¡­ä½]; $A¡äĞÒ³áˆ = str_replace($dµµî¹¤£î[233], $dµµî¹¤£î[33], $bºÓ¿¯ë‡ì[$dµµî¹¤£î[168]]); $c¢Š´š—ã = $this->client->listParts($this->bucket, $Dãµ¡¦ùñ‰, $A¡äĞÒ³áˆ); goto b¿¶œ‘×; dÂçÈè—šè: $AòÔ·Î÷èÙ = $this->multiUploadAuthData($Dãµ¡¦ùñ‰, $bºÓ¿¯ë‡ì); if (empty($AòÔ·Î÷èÙ)) { return !1; } return array($dµµî¹¤£î[232] => $AòÔ·Î÷èÙ, $dµµî¹¤£î[222] => $bºÓ¿¯ë‡ì[$dµµî¹¤£î[222]], $dµµî¹¤£î[234] => $c¢Š´š—ã); goto AŠÑ’Åœ¢â; AŠÑ’Åœ¢â: } public function getHost() { return parent::getHost() . $_SERVER[ªúæÂ¡­ä½][8] . $this->bucket; } public function size($b›ÔÇ¹Ÿ£ˆ) { $bÛŠïùÈéŒ = $this->objectMeta($b›ÔÇ¹Ÿ£ˆ); return $bÛŠïùÈéŒ ? $bÛŠïùÈéŒ[$_SERVER[ªúæÂ¡­ä½][78]] : 0; } public function info($A¤Óñ÷Éçã) { if ($this->isFolder($A¤Óñ÷Éçã)) { return $this->folderInfo($A¤Óñ÷Éçã); } else { if ($this->isFile($A¤Óñ÷Éçã)) { return $this->fileInfo($A¤Óñ÷Éçã); } } return !1; } public function exist($bÃ³Û°©ò) { return $this->isFile($bÃ³Û°©ò) || $this->isFolder($bÃ³Û°©ò); } public function isFile($c·êÔÆÕ­) { return !$this->isFolder($c·êÔÆÕ­) && $this->objectMeta($c·êÔÆÕ­); } public function isFolder($F´ì”¡¸åÏ) { return $this->cacheMethod($_SERVER[ªúæÂ¡­ä½][199], $F´ì”¡¸åÏ); } protected function objectMeta($d°¥©ÏÓ¦) { return $this->cacheMethod($_SERVER[ªúæÂ¡­ä½][200], $d°¥©ÏÓ¦); } protected function _objectMeta($f²À¨Â‰†‰) { $A™Ú¯£âİË =& $_SERVER[ªúæÂ¡­ä½]; $f²À¨Â‰†‰ = rtrim($f²À¨Â‰†‰, $A™Ú¯£âİË[8]); try { $DÒæŒÃ¯Ìí = $this->client->getObjectInfo($this->bucket, $f²À¨Â‰†‰); if (!isset($DÒæŒÃ¯Ìí[$A™Ú¯£âİË[219]]) && isset($DÒæŒÃ¯Ìí[$A™Ú¯£âİË[235]])) { $DÒæŒÃ¯Ìí[$A™Ú¯£âİË[219]] = $DÒæŒÃ¯Ìí[$A™Ú¯£âİË[235]]; } } catch (Exception $eæñ“¨ÃšÀ) { $DÒæŒÃ¯Ìí = !1; } if (!$DÒæŒÃ¯Ìí) { } return $DÒæŒÃ¯Ìí; } protected function _isFolder($d½ºÊ‹é½’) { goto d¢ª¸ƒ»‚÷; c„Ö¬¯èŞ´: $aóêÍ§óî† = $this->client->getBucket($this->bucket, $d½ºÊ‹é½’, null, 1); if (empty($aóêÍ§óî†[$e£…ï»ÍŸ[198]])) { return !1; } $eº‹£‹Ã = $aóêÍ§óî†[$e£…ï»ÍŸ[198]][0][$e£…ï»ÍŸ[28]]; goto döÚ¥¿¨¤; E«–ÔÛÕÁ: return !0; goto cœ„ò¬µÉ“; d¢ª¸ƒ»‚÷: $e£…ï»ÍŸ =& $_SERVER[ªúæÂ¡­ä½]; $d½ºÊ‹é½’ = rtrim($d½ºÊ‹é½’, $e£…ï»ÍŸ[8]); if ($d½ºÊ‹é½’ == $e£…ï»ÍŸ[33] || $d½ºÊ‹é½’ == $e£…ï»ÍŸ[8]) { return !0; } goto c„Ö¬¯èŞ´; döÚ¥¿¨¤: return stripos($eº‹£‹Ã, $d½ºÊ‹é½’ . $e£…ï»ÍŸ[8]) === 0 ? !0 : !1; if (substr($eº‹£‹Ã, -1) == $e£…ï»ÍŸ[8]) { return !0; } if (get_path_this($eº‹£‹Ã) == get_path_this($d½ºÊ‹é½’)) { return !1; } goto E«–ÔÛÕÁ; cœ„ò¬µÉ“: } } define($_SERVER[ªúæÂ¡­ä½][236], 1); goto EîÑ»¤İ; D¨‡‰õ®¹¶: class PathDriverUrl extends PathDriverBase { static $_cacheHeader = array(); public function __construct($B¶ÃôÔ®Í‘ = false) { } public function exist($b©â¥—¢Ÿ) { $eè¨Ğ‰Û®ƒ = $this->info($b©â¥—¢Ÿ); return $eè¨Ğ‰Û®ƒ[$_SERVER[ªúæÂ¡­ä½][195]]; } public function isFile($dÁ®·Õ„É™) { $A˜—îŸ—‹Ë = $this->info($dÁ®·Õ„É™); return $A˜—îŸ—‹Ë[$_SERVER[ªúæÂ¡­ä½][195]]; } public function isFolder($C¯‡™íÁ±÷) { return !1; } public function size($bÈ‘ÌÚïí ) { $dì›ñ©‘‡… = $this->info($bÈ‘ÌÚïí ); return $dì›ñ©‘‡…[$_SERVER[ªúæÂ¡­ä½][78]]; } public function info($FÖäÆºÛ÷à) { return $this->infoParse($FÖäÆºÛ÷à); } public function infoAuth($a÷¯Ÿ­£Ô¬) { return $this->infoParse($a÷¯Ÿ­£Ô¬); } public function infoWithChildren($B§Û™ÎË÷†) { return $this->infoParse($B§Û™ÎË÷†); } public function infoFull($B‡µŸ’Õ¦) { return $this->infoParse($B‡µŸ’Õ¦); } private function infoParse($aˆ‘šÌ‘) { $dõå‘‡“ßç =& $_SERVER[ªúæÂ¡­ä½]; $DÕÂÏæˆêÕ = $this->header($aˆ‘šÌ‘); if (!$DÕÂÏæˆêÕ || !$DÕÂÏæˆêÕ[$dõå‘‡“ßç[728]]) { return !1; } $bÉ„œ¢Ì†‹ = _get($DÕÂÏæˆêÕ, $dõå‘‡“ßç[335], 0); $aƒÇƒ·Ó = array($dõå‘‡“ßç[28] => $DÕÂÏæˆêÕ[$dõå‘‡“ßç[28]], $dõå‘‡“ßç[76] => $aˆ‘šÌ‘, $dõå‘‡“ßç[29] => $dõå‘‡“ßç[193], $dõå‘‡“ßç[78] => intval($bÉ„œ¢Ì†‹), $dõå‘‡“ßç[168] => get_path_ext($DÕÂÏæˆêÕ[$dõå‘‡“ßç[28]]), $dõå‘‡“ßç[1271] => $bÉ„œ¢Ì†‹ > 0 && $DÕÂÏæˆêÕ[$dõå‘‡“ßç[1391]], $dõå‘‡“ßç[1272] => !1); return $aƒÇƒ·Ó; } private function header($d÷˜ñ†’Ö) { goto c‡Ë‡˜¨Æ; aÆ×ÂïÑ¬Ñ: return self::$_cacheHeader[$d÷˜ñ†’Ö]; goto a„ƒõ‘‰; bêóÜ¶¨Ú: $GLOBALS[$EˆÊ¢¿â†Ÿ[1392]] = !0; self::$_cacheHeader[$d÷˜ñ†’Ö] = url_header($d÷˜ñ†’Ö); $GLOBALS[$EˆÊ¢¿â†Ÿ[1392]] = $dÔ–‹¦ƒŠ¨; goto aÆ×ÂïÑ¬Ñ; c‡Ë‡˜¨Æ: $EˆÊ¢¿â†Ÿ =& $_SERVER[ªúæÂ¡­ä½]; if (isset(self::$_cacheHeader[$d÷˜ñ†’Ö])) { return self::$_cacheHeader[$d÷˜ñ†’Ö]; } $dÔ–‹¦ƒŠ¨ = isset($GLOBALS[$EˆÊ¢¿â†Ÿ[1392]]) ? $GLOBALS[$EˆÊ¢¿â†Ÿ[1392]] : !1; goto bêóÜ¶¨Ú; a„ƒõ‘‰: } public function hashSimple($dÇ¯ìÒÒœ‡, $F°¯Ê»õÄÊ = false) { goto E‘ÇÊçË»; AÏô·¹«†: $aÄˆ¨áÏ˜• .= $this->fileSubstr($dÇ¯ìÒÒœ‡, $c¸à¸ä¸Ì¡ - $a¿Õï‹Œ‡, $a¿Õï‹Œ‡); return md5($aÄˆ¨áÏ˜•) . $c¸à¸ä¸Ì¡; goto Bïá¡á¾ò¥; CÓÜİÌˆÙ±: $c¸à¸ä¸Ì¡ = $c ç²Î«çî[$Dß¬‹Š¦æõ[78]]; $a¿Õï‹Œ‡ = 200; $CÃÍ•’£½ = 50; goto F¸‡ğµ—¸‘; F¸‡ğµ—¸‘: if ($c¸à¸ä¸Ì¡ <= $a¿Õï‹Œ‡ * $CÃÍ•’£½) { return md5($this->fileSubstr($dÇ¯ìÒÒœ‡, 0, $c¸à¸ä¸Ì¡)) . $c¸à¸ä¸Ì¡; } $AÍÍ—ÚÖ—š = intval($c¸à¸ä¸Ì¡ / $CÃÍ•’£½); $aÄˆ¨áÏ˜• = $Dß¬‹Š¦æõ[33]; goto BíèŸ‘ÉÖ¾; E‘ÇÊçË»: $Dß¬‹Š¦æõ =& $_SERVER[ªúæÂ¡­ä½]; $c ç²Î«çî = $this->info($dÇ¯ìÒÒœ‡); if (!$c ç²Î«çî || !$c ç²Î«çî[$Dß¬‹Š¦æõ[195]]) { return !1; } goto CÓÜİÌˆÙ±; BíèŸ‘ÉÖ¾: $E¬ŠŠ‡ÎÆ = timeFloat(); $cóµê¼öÙ = 15; for ($aÒğ˜ç™ñ· = 0; $aÒğ˜ç™ñ· < $CÃÍ•’£½; $aÒğ˜ç™ñ·++) { if (timeFloat() - $E¬ŠŠ‡ÎÆ > $cóµê¼öÙ) { return !1; } $bËÌôß÷·À = $this->fileSubstr($dÇ¯ìÒÒœ‡, $AÍÍ—ÚÖ—š * $aÒğ˜ç™ñ·, $a¿Õï‹Œ‡); if (!$bËÌôß÷·À) { return !1; } $aÄˆ¨áÏ˜• .= $bËÌôß÷·À; } goto AÏô·¹«†; Bïá¡á¾ò¥: } public function getContent($DøØàŒ†¡Ì) { return $this->fileSubstr($DøØàŒ†¡Ì); } public function fileSubstr($Fåğ¯ï»®ì, $Cğ†ù„† = 0, $CÒçÒ„ÒŞ = -1) { goto dºÖÍË¶£¤; b«ƒË‹®—÷: $BÍÂ¾ëÒ–± = url_request($Fåğ¯ï»®ì, $Bä®Õ™ßÖ­[228], !1, $CØÖÆ¶í„¤, !1, !1, 1); return $BÍÂ¾ëÒ–±[$Bä®Õ™ßÖ­[1103]] ? $BÍÂ¾ëÒ–±[$Bä®Õ™ßÖ­[1103]] : $Bä®Õ™ßÖ­[33]; goto f×½ÅâÕÒ; dºÖÍË¶£¤: $Bä®Õ™ßÖ­ =& $_SERVER[ªúæÂ¡­ä½]; $CÄ°…˜ôé¿ = $this->info($Fåğ¯ï»®ì); if (!$CÄ°…˜ôé¿ || !$CÄ°…˜ôé¿[$Bä®Õ™ßÖ­[195]] && $CÄ°…˜ôé¿[$Bä®Õ™ßÖ­[78]] > 1024 * 1024 * 10) { return !1; } goto Bå£ƒ’±ƒº; Bå£ƒ’±ƒº: if ($CÒçÒ„ÒŞ === -1) { $CÒçÒ„ÒŞ = $CÄ°…˜ôé¿[$Bä®Õ™ßÖ­[78]]; } if ($CÒçÒ„ÒŞ == 0) { return $Bä®Õ™ßÖ­[33]; } $CØÖÆ¶í„¤ = array($Bä®Õ™ßÖ­[1393] . $Cğ†ù„† . $Bä®Õ™ßÖ­[762] . ($Cğ†ù„† + $CÒçÒ„ÒŞ - 1)); goto b«ƒË‹®—÷; f×½ÅâÕÒ: } public function download($A¸ò‘ªòÑ, $c÷©Ùº¹™) { Downloader::start($A¸ò‘ªòÑ, $c÷©Ùº¹™); return $c÷©Ùº¹™; } } class StreamWrapperIO { private $path; private $info; private $pose = 0; static $_fopenCache = array(); static $_chunkBuffer = array(); private $timeStart = 0; function stream_open($FÆŠî´öìÉ, $Bõ‚ÓóÃ¢ğ = '') { goto d•èçñÇ; eÌºº†²×: if (!isset(self::$_chunkBuffer[$FÆŠî´öìÉ])) { self::$_chunkBuffer[$FÆŠî´öìÉ] = array(); } self::$_fopenCache[$this->pathOpen] = $this; return $this->info ? !0 : !1; goto F»…’×¾‘¤; Aƒ„İ¾†¨Û: $this->pathOpen = $FÆŠî´öìÉ; if (!$this->info) { return !1; } if (count(self::$_chunkBuffer) > 100) { self::$_chunkBuffer = null; self::$_chunkBuffer = array(); } goto eÌºº†²×; d•èçñÇ: $this->info = $this->info($FÆŠî´öìÉ); $this->timeStart = timeFloat(); $this->path = $this->info[$_SERVER[ªúæÂ¡­ä½][76]]; goto Aƒ„İ¾†¨Û; F»…’×¾‘¤: } function stream_read($D°äƒ½òí) { $f¦â„«¿Ï½ = $this->fileSubstr($this->pose, $D°äƒ½òí); $this->pose += strlen($f¦â„«¿Ï½); return $f¦â„«¿Ï½; } public function stream_tell() { return $this->pose; } public function stream_seek($e×ğ†»ó¢•, $AœÓ˜ŒÜ÷©) { $F×ÔŞÀ î‘ =& $_SERVER[ªúæÂ¡­ä½]; if ($AœÓ˜ŒÜ÷© == SEEK_SET) { $this->pose = $e×ğ†»ó¢•; } else { if ($AœÓ˜ŒÜ÷© == SEEK_CUR) { $this->pose += $e×ğ†»ó¢•; } else { if ($AœÓ˜ŒÜ÷© == SEEK_END) { $this->pose = $this->info[$F×ÔŞÀ î‘[78]] + intval($e×ğ†»ó¢•); } } } if ($e×ğ†»ó¢• < 0) { $this->pose = $this->info[$F×ÔŞÀ î‘[78]] + $e×ğ†»ó¢•; } return !0; } public function stream_eof() { return $this->pose >= $this->info[$_SERVER[ªúæÂ¡­ä½][78]]; } public function stream_close() { unset(self::$_fopenCache[$this->pathOpen]); return !0; } public function url_stat($AŠ‚”ö£è, $D¤æã³—Ì) { $dç†İó êä =& $_SERVER[ªúæÂ¡­ä½]; $D´¢–¶ÃŞ— = $this->info($AŠ‚”ö£è); return array($dç†İó êä[1394] => 0, $dç†İó êä[1395] => 0, $dç†İó êä[12] => 32768 + 511, $dç†İó êä[1396] => 0, $dç†İó êä[1397] => 0, $dç†İó êä[1398] => 0, $dç†İó êä[1399] => 0, $dç†İó êä[78] => $D´¢–¶ÃŞ—[$dç†İó êä[78]], $dç†İó êä[1400] => $D´¢–¶ÃŞ—[$dç†İó êä[1270]], $dç†İó êä[1356] => $D´¢–¶ÃŞ—[$dç†İó êä[84]], $dç†İó êä[1355] => $D´¢–¶ÃŞ—[$dç†İó êä[194]], $dç†İó êä[1401] => 0, $dç†İó êä[1402] => 0); } static $fileInfo = array(); public function info($Eº×Á‚å£) { $E§Ò´É «Š = $_SERVER[ªúæÂ¡­ä½][1403]; if (isset(self::$fileInfo[$Eº×Á‚å£])) { return self::$fileInfo[$Eº×Á‚å£]; } if (substr($Eº×Á‚å£, 0, strlen($E§Ò´É «Š)) != $E§Ò´É «Š) { return !1; } self::$fileInfo[$Eº×Á‚å£] = IO::info(substr($Eº×Á‚å£, strlen($E§Ò´É «Š))); return self::$fileInfo[$Eº×Á‚å£]; } public static function read($D›Öß¿´†£, $e©Œ°ª‘Ù¯, $eß‹àÒµ) { if (!isset(self::$_fopenCache[$D›Öß¿´†£])) { $E¬™’æÌ…å = new StreamWrapperIO(); $E¬™’æÌ…å->stream_open($D›Öß¿´†£); self::$_fopenCache[$D›Öß¿´†£] = $E¬™’æÌ…å; } $E¬™’æÌ…å = self::$_fopenCache[$D›Öß¿´†£]; return $E¬™’æÌ…å->fileSubstr($e©Œ°ª‘Ù¯, $eß‹àÒµ); } public static function _read($cŞŠ¹ìöÆ•, $fíÌ¨ìËÓ×, $bÜÆ£¾äÕ“) { goto a“ÇÔµõ„; FÈÊô•ùÍà: $BÜ’²¾¦Óî = 0; while ($BÜ’²¾¦Óî < $bÜÆ£¾äÕ“) { $CÊ¢ù®ùœö = min($d°¨½§³ Œ, $bÜÆ£¾äÕ“ - $BÜ’²¾¦Óî); $f¦»ôè¹È¡ .= fread($Bñæ³²š³, $CÊ¢ù®ùœö); $BÜ’²¾¦Óî += $CÊ¢ù®ùœö; } fclose($Bñæ³²š³); goto EšÆÌ¼Â¼; fŠ‘…Ö¼…Û: $d°¨½§³ Œ = 8192; fseek($Bñæ³²š³, $fíÌ¨ìËÓ×, SEEK_SET); $f¦»ôè¹È¡ = $bÇÑ±ª­Ğ[33]; goto FÈÊô•ùÍà; EšÆÌ¼Â¼: return $f¦»ôè¹È¡; goto Aå¡‹Ä—ÉÆ; a“ÇÔµõ„: $bÇÑ±ª­Ğ =& $_SERVER[ªúæÂ¡­ä½]; $Bñæ³²š³ = fopen($cŞŠ¹ìöÆ•, $bÇÑ±ª­Ğ[1274]); if (!$Bñæ³²š³) { return $bÇÑ±ª­Ğ[33]; } goto fŠ‘…Ö¼…Û; Aå¡‹Ä—ÉÆ: } public function fileSubstr($E÷Óâ¢Ÿ³Û, $B‚²’ƒÙ‰Š) { goto C®½‘ éª¨; cîßÓù£“…: $CğË³ã = 0; $bÔ±ù¯‹˜Ô = 0; $cø«İë£†ª = $b¹š‡ÔâôË[33]; goto e³·®šé‘; B²Åëå•ª°: ksort($f»ĞØê³ƒ); $F‡µƒ™Èä = substr($fÑµùÏİÑ, $E÷Óâ¢Ÿ³Û - $f´’Òª¸›, $B‚²’ƒÙ‰Š); return $F‡µƒ™Èä; goto f´é©£ëä; BÚÔ‹ÈŸÙŠ: if ($E÷Óâ¢Ÿ³Û + $B‚²’ƒÙ‰Š > $FÁ±åÏ±è) { $B‚²’ƒÙ‰Š = $FÁ±åÏ±è - $E÷Óâ¢Ÿ³Û; } if ($B‚²’ƒÙ‰Š <= 0) { return $b¹š‡ÔâôË[33]; } if ($E÷Óâ¢Ÿ³Û < 0 || $E÷Óâ¢Ÿ³Û >= $FÁ±åÏ±è || $B‚²’ƒÙ‰Š <= 0 || $B‚²’ƒÙ‰Š > 1024 * 1024 * 10) { throw new Exception("\151\157\106\x69\154\x65\122\145\x61\144\x20\x65\x72\162\157\162\41\x20\163\x74\x61\x72\164\75{$E÷Óâ¢Ÿ³Û}\73\154\145\x6e\x67\164\x68\75{$B‚²’ƒÙ‰Š}\73\x20\x73\x69\x7a\145\75{$FÁ±åÏ±è}\x3b"); } goto A¾Öæ¨½‚–; e³·®šé‘: foreach ($f»ĞØê³ƒ as $CğË³ã => $cø«İë£†ª) { $CğË³ã = intval($CğË³ã); $bÔ±ù¯‹˜Ô = $CğË³ã + strlen($cø«İë£†ª); if ($E÷Óâ¢Ÿ³Û >= $bÔ±ù¯‹˜Ô) { continue; } if ($E÷Óâ¢Ÿ³Û >= $CğË³ã && $E÷Óâ¢Ÿ³Û + $B‚²’ƒÙ‰Š <= $bÔ±ù¯‹˜Ô) { return substr($cø«İë£†ª, $E÷Óâ¢Ÿ³Û - $CğË³ã, $B‚²’ƒÙ‰Š); } break; } if (count($f»ĞØê³ƒ) > 100 || timeFloat() - $this->timeStart > 2.0) { $this->log($b¹š‡ÔâôË[1404], $b¹š‡ÔâôË[1405] . count($f»ĞØê³ƒ) . "\73\163\x74\141\162\x74\75{$E÷Óâ¢Ÿ³Û}\54\x6c\x65\x6e\x67\164\x68\x3d{$B‚²’ƒÙ‰Š}\x3b\160\x6f\163\x65\x3a{$CğË³ã}\176{$bÔ±ù¯‹˜Ô}"); throw new Exception($b¹š‡ÔâôË[1406]); } $f´’Òª¸› = intval($E÷Óâ¢Ÿ³Û / $f¾·•ÕÈ‹•) * $f¾·•ÕÈ‹•; goto c¦„Áœ³Œ; Bß½‚Éó‰: $aÙòİˆàºÎ = $B‚²’ƒÙ‰Š; if ($E÷Óâ¢Ÿ³Û < 0) { $E÷Óâ¢Ÿ³Û = $FÁ±åÏ±è + $E÷Óâ¢Ÿ³Û; } if ($B‚²’ƒÙ‰Š === !1) { $B‚²’ƒÙ‰Š = $FÁ±åÏ±è - $E÷Óâ¢Ÿ³Û; } goto BÚÔ‹ÈŸÙŠ; c¦„Áœ³Œ: $dÍÜ¢…—â = ceil(($E÷Óâ¢Ÿ³Û + $B‚²’ƒÙ‰Š) / $f¾·•ÕÈ‹•) * $f¾·•ÕÈ‹• - $f´’Òª¸›; $fÑµùÏİÑ = IO::fileSubstr($this->path, $f´’Òª¸›, $dÍÜ¢…—â); $f»ĞØê³ƒ[$f´’Òª¸› . $b¹š‡ÔâôË[33]] = $fÑµùÏİÑ; goto B²Åëå•ª°; A¾Öæ¨½‚–: $f¾·•ÕÈ‹• = 64 * 1024; $f»ĞØê³ƒ =& self::$_chunkBuffer[$this->path]; if (!$f»ĞØê³ƒ) { $f»ĞØê³ƒ = array(); } goto cîßÓù£“…; C®½‘ éª¨: $b¹š‡ÔâôË =& $_SERVER[ªúæÂ¡­ä½]; $FÁ±åÏ±è = $this->info[$b¹š‡ÔâôË[78]]; $d±“âï¾¥¹ = $E÷Óâ¢Ÿ³Û; goto Bß½‚Éó‰; f´é©£ëä: } private function log($B¹íâ÷î, $fî´çÅ‹Š) { $fœ®±Ï¸ŠË =& $_SERVER[ªúæÂ¡­ä½]; $a­ù™ó§¼Ï = timeFloat() - $this->timeStart; write_log(sprintf($fœ®±Ï¸ŠË[1407], $B¹íâ÷î, $this->info[$fœ®±Ï¸ŠË[28]], $a­ù™ó§¼Ï, $fî´çÅ‹Š), $fœ®±Ï¸ŠË[1093]); } } class Message { function __construct() { } public function send($FŒœ´ˆÉ§ = '', $D“¢ˆÔƒ­± = array(), $Dˆ³½Œøó = "\x74\145\170\164") { goto bå‡İÁ‚ŠÙ; cš‚ŸÃ†¸: $D“¢ˆÔƒ­± = array($câÈèÜÒğ[497] => isset($D“¢ˆÔƒ­±[$câÈèÜÒğ[497]]) ? $D“¢ˆÔƒ­±[$câÈèÜÒğ[497]] : $câÈèÜÒğ[33], $câÈèÜÒğ[576] => isset($D“¢ˆÔƒ­±[$câÈèÜÒğ[576]]) ? $D“¢ˆÔƒ­±[$câÈèÜÒğ[576]] : $câÈèÜÒğ[33]); if (empty($FŒœ´ˆÉ§) || empty($D“¢ˆÔƒ­±[$câÈèÜÒğ[497]]) && empty($D“¢ˆÔƒ­±[$câÈèÜÒğ[576]])) { return !1; } $f¦‡ïÒÆ²¢ = array($câÈèÜÒğ[1349] => $c»‚î“Ğ¢Û, $câÈèÜÒğ[1410] => $D“¢ˆÔƒ­±); goto c÷óô‚Úƒ¦; bå‡İÁ‚ŠÙ: $câÈèÜÒğ =& $_SERVER[ªúæÂ¡­ä½]; $c»‚î“Ğ¢Û = array($câÈèÜÒğ[29] => $câÈèÜÒğ[1408], $câÈèÜÒğ[733] => $FŒœ´ˆÉ§); if (in_array($Dˆ³½Œøó, array($câÈèÜÒğ[1408], $câÈèÜÒğ[1409]))) { $c»‚î“Ğ¢Û[$câÈèÜÒğ[29]] = $Dˆ³½Œøó; } goto cš‚ŸÃ†¸; c÷óô‚Úƒ¦: Hook::trigger($câÈèÜÒğ[1411], $f¦‡ïÒÆ²¢); goto dğ’£Öãˆä; dğ’£Öãˆä: } } goto E¸ÄÒŠß¢; dÅ®¾“”„¬: class BackupFile { public function __construct() { } public function index() { goto dŒÓ±âä™à; dŒÓ±âä™à: $fÅÍÓÏ‰ªî = Backup::get(); $b’Î´ÁõÁ = $fÅÍÓÏ‰ªî[$_SERVER[ªúæÂ¡­ä½][291]][$_SERVER[ªúæÂ¡­ä½][193]][$_SERVER[ªúæÂ¡­ä½][448]]; $f‚óÒôõ  = array($_SERVER[ªúæÂ¡­ä½][449] => array($_SERVER[ªúæÂ¡­ä½][790], $b’Î´ÁõÁ), $_SERVER[ªúæÂ¡­ä½][791] => array($_SERVER[ªúæÂ¡­ä½][329], $fÅÍÓÏ‰ªî[$_SERVER[ªúæÂ¡­ä½][730]])); goto e¾‚áÜŒˆá; e¾‚áÜŒˆá: $E«œ‰ëÜ¾İ = (int) Model($_SERVER[ªúæÂ¡­ä½][765])->where($f‚óÒôõ )->count($_SERVER[ªúæÂ¡­ä½][448]); $bÀœìõÄÊï = (int) Model($_SERVER[ªúæÂ¡­ä½][765])->where($f‚óÒôõ )->sum($_SERVER[ªúæÂ¡­ä½][78]); $B¾ÇÁŸ™¤Ë = new TaskFileTransfer($_SERVER[ªúæÂ¡­ä½][792], $_SERVER[ªúæÂ¡­ä½][760], $E«œ‰ëÜ¾İ, LNG($_SERVER[ªúæÂ¡­ä½][761]) . $_SERVER[ªúæÂ¡­ä½][762] . LNG($_SERVER[ªúæÂ¡­ä½][793])); goto DÌÎ°ƒ—; fÅæïáÚ‹§: $BÏ¥ø“Ë = !0; $A±Ã¾äÇ» = $this->storeIds(); $e‚»§ø®¨‰ = 1; goto a…º—º¬Ò; a…º—º¬Ò: $E„Ê×ˆŸƒ¬ = 1000; $bÈÔ‹ÃĞø• = $aŒÓğÀÌ·‚ = 0; $a‹ÂñŠ Ô… = array(); goto BßµÏè½‰; DÒ­‰öİ¶: $B†ôî³ùöæ = array($_SERVER[ªúæÂ¡­ä½][806] => 1, $_SERVER[ªúæÂ¡­ä½][477] => time(), $_SERVER[ªúæÂ¡­ä½][753] => 1, $_SERVER[ªúæÂ¡­ä½][803] => $b’Î´ÁõÁ, $_SERVER[ªúæÂ¡­ä½][795] => $bÀœìõÄÊï, $_SERVER[ªúæÂ¡­ä½][794] => $E«œ‰ëÜ¾İ, $_SERVER[ªúæÂ¡­ä½][807] => time()); if ($aŒÓğÀÌ·‚) { $B†ôî³ùöæ[$_SERVER[ªúæÂ¡­ä½][804]] = $dÄ¹–ğ›İ‹; $B†ôî³ùöæ[$_SERVER[ªúæÂ¡­ä½][805]] = $bä¬Šñ…Ü; } Backup::set($B†ôî³ùöæ); goto E†çÅéË÷; E†çÅéË÷: $this->_fileFilter($a‹ÂñŠ Ô…); return !0; goto EĞ÷­Ó„µî; BßµÏè½‰: $bä¬Šñ…Ü = $dÄ¹–ğ›İ‹ = 0; do { $cÙ™¹Öã = $_SERVER[ªúæÂ¡­ä½][797]; $AßÌæ´°—§ = Model($_SERVER[ªúæÂ¡­ä½][765])->where($f‚óÒôõ )->field($cÙ™¹Öã)->order($_SERVER[ªúæÂ¡­ä½][798])->selectPage($E„Ê×ˆŸƒ¬, $e‚»§ø®¨‰); $AâÖà¢ •ˆ = !empty($AßÌæ´°—§[$_SERVER[ªúæÂ¡­ä½][367]]) ? $AßÌæ´°—§[$_SERVER[ªúæÂ¡­ä½][367]] : array(); foreach ($AâÖà¢ •ˆ as $fğôÇĞ³¢¦) { goto dŒÍøº¹Ë; AÕ½§œÁ‹Ô: if ($bÈÔ‹ÃĞø• >= 1024 * 1024 * 100) { $B†ôî³ùöæ = array($_SERVER[ªúæÂ¡­ä½][803] => $b’Î´ÁõÁ, $_SERVER[ªúæÂ¡­ä½][804] => $dÄ¹–ğ›İ‹, $_SERVER[ªúæÂ¡­ä½][805] => $bä¬Šñ…Ü); Backup::set($B†ôî³ùöæ); $bÈÔ‹ÃĞø• = $aŒÓğÀÌ·‚ = 0; } goto AÊ¨äãÅ¢§; BªÄÚøÒê¡: if (IO::exist($cç§‹‰©†°)) { $B¾ÇÁŸ™¤Ë->updateFileEnd($fğôÇĞ³¢¦[$_SERVER[ªúæÂ¡­ä½][28]], $fğôÇĞ³¢¦[$_SERVER[ªúæÂ¡­ä½][78]]); } else { $cç§‹‰©†° = get_path_father($cç§‹‰©†°); IO::mkdir($cç§‹‰©†°); if (!IO::copy($F»í·¸Óö‰, $cç§‹‰©†°, $_SERVER[ªúæÂ¡­ä½][801])) { write_log($_SERVER[ªúæÂ¡­ä½][802] . $F»í·¸Óö‰ . $_SERVER[ªúæÂ¡­ä½][785] . $cç§‹‰©†° . $_SERVER[ªúæÂ¡­ä½][518], $_SERVER[ªúæÂ¡­ä½][760]); $BÏ¥ø“Ë = !1; break; } } $b’Î´ÁõÁ = $fğôÇĞ³¢¦[$_SERVER[ªúæÂ¡­ä½][448]]; $aŒÓğÀÌ·‚ += 1; goto aÕÖò¼Õ¢–; dŒÍøº¹Ë: if (!$this->_fileExist($fğôÇĞ³¢¦, $a‹ÂñŠ Ô…, $A±Ã¾äÇ»)) { $E«œ‰ëÜ¾İ -= 1; $bÀœìõÄÊï -= (int) $fğôÇĞ³¢¦[$_SERVER[ªúæÂ¡­ä½][78]]; write_log("\146\151\x6c\x65\40\x6e\x6f\164\x20\145\x78\151\x73\164\56\146\151\x6c\x65\111\104\72{$fğôÇĞ³¢¦[$_SERVER[ªúæÂ¡­ä½][448]]}\x2c\40\x70\x61\x74\x68\72{$fğôÇĞ³¢¦[$_SERVER[ªúæÂ¡­ä½][76]]}", $_SERVER[ªúæÂ¡­ä½][799]); continue; } $F»í·¸Óö‰ = $fğôÇĞ³¢¦[$_SERVER[ªúæÂ¡­ä½][76]]; $cç§‹‰©†° = "\x7b\151\157\x3a{$fÅÍÓÏ‰ªî[$_SERVER[ªúæÂ¡­ä½][730]]}\175" . substr($F»í·¸Óö‰, strlen("\173\151\x6f\72{$fğôÇĞ³¢¦[$_SERVER[ªúæÂ¡­ä½][800]]}\175")); goto BªÄÚøÒê¡; aÕÖò¼Õ¢–: $bÈÔ‹ÃĞø• += $fğôÇĞ³¢¦[$_SERVER[ªúæÂ¡­ä½][78]]; $dÄ¹–ğ›İ‹ += 1; $bä¬Šñ…Ü += $fğôÇĞ³¢¦[$_SERVER[ªúæÂ¡­ä½][78]]; goto AÕ½§œÁ‹Ô; AÊ¨äãÅ¢§: } $eŸÚ¿ŒÖİ• = count($AâÖà¢ •ˆ); $e‚»§ø®¨‰++; } while ($eŸÚ¿ŒÖİ• == $E„Ê×ˆŸƒ¬); $B¾ÇÁŸ™¤Ë->end(); goto DÒ­‰öİ¶; DÌÎ°ƒ—: $B¾ÇÁŸ™¤Ë->task[$_SERVER[ªúæÂ¡­ä½][741]] = $bÀœìõÄÊï; $B†ôî³ùöæ = array($_SERVER[ªúæÂ¡­ä½][794] => $E«œ‰ëÜ¾İ, $_SERVER[ªúæÂ¡­ä½][795] => $bÀœìõÄÊï, $_SERVER[ªúæÂ¡­ä½][796] => time()); Backup::set($B†ôî³ùöæ); goto fÅæïáÚ‹§; EĞ÷­Ó„µî: } private function _fileExist($c³›Ä¤š¥ó, &$fÍêã‚«®ù, $Bè£ŠŒ¬ŠÁ) { goto d®¢§Ÿø‰®; d˜¶†ÉÄØ—: if (!in_array($c³›Ä¤š¥ó[$D¼ÕòÑ·ß‹[800]], $Bè£ŠŒ¬ŠÁ)) { return !1; } if (IO::exist($Fƒ´È  ğ‹)) { return !0; } $c“ç¡ç¯“ = get_path_father($Fƒ´È  ğ‹); goto Fà§”´¥á—; d®¢§Ÿø‰®: $D¼ÕòÑ·ß‹ =& $_SERVER[ªúæÂ¡­ä½]; $Fƒ´È  ğ‹ = $c³›Ä¤š¥ó[$D¼ÕòÑ·ß‹[76]]; if (in_array($c³›Ä¤š¥ó[$D¼ÕòÑ·ß‹[448]], $fÍêã‚«®ù)) { return !1; } goto d˜¶†ÉÄØ—; Fà§”´¥á—: if (IO::exist($c“ç¡ç¯“)) { $fÍêã‚«®ù[] = $c³›Ä¤š¥ó[$D¼ÕòÑ·ß‹[448]]; return !1; } $C†Ó§¨‰Ê¹ = array($D¼ÕòÑ·ß‹[800] => $c³›Ä¤š¥ó[$D¼ÕòÑ·ß‹[800]], $D¼ÕòÑ·ß‹[76] => array($D¼ÕòÑ·ß‹[380], "{$c“ç¡ç¯“}\45")); $EÍ”Â…—›¯ = Model($D¼ÕòÑ·ß‹[765])->where($C†Ó§¨‰Ê¹)->field($D¼ÕòÑ·ß‹[449])->select(); goto cÎ–ÖƒÔ; cÎ–ÖƒÔ: $fÍêã‚«®ù = array_merge($fÍêã‚«®ù, array_to_keyvalue($EÍ”Â…—›¯, $D¼ÕòÑ·ß‹[33], $D¼ÕòÑ·ß‹[448])); return !1; goto f³—‘ëŠ¶ˆ; f³—‘ëŠ¶ˆ: } private function _fileFilter($EÛÚ†Ø³Õ‡) { $Bƒ´·Š¹®º =& $_SERVER[ªúæÂ¡­ä½]; if (empty($EÛÚ†Ø³Õ‡)) { return; } $EƒŒ†Çì­Ş = array($Bƒ´·Š¹®º[448] => array($Bƒ´·Š¹®º[7], array_unique($EÛÚ†Ø³Õ‡))); $B¤˜è¤öù = Model($Bƒ´·Š¹®º[808])->where($EƒŒ†Çì­Ş)->field($Bƒ´·Š¹®º[396])->select(); foreach ($B¤˜è¤öù as $f·äƒÁë¹) { Model($Bƒ´·Š¹®º[808])->remove($f·äƒÁë¹[$Bƒ´·Š¹®º[396]], !1); } } private function storeIds() { $f§ãÊÔÛÜ— =& $_SERVER[ªúæÂ¡­ä½]; $dã§¸ôàŸ = Model($f§ãÊÔÛÜ—[745])->listData(); $fÜ¡í”Ûóö = array(); $B®¸ƒ°ôª = $GLOBALS[$f§ãÊÔÛÜ—[6]][$f§ãÊÔÛÜ—[88]][$f§ãÊÔÛÜ—[809]]; foreach ($dã§¸ôàŸ as $b†ÀèØÛïñ) { $CÄ ˜Ü­Ñ¬ = strtolower($b†ÀèØÛïñ[$f§ãÊÔÛÜ—[94]]); if (!isset($B®¸ƒ°ôª[$CÄ ˜Ü­Ñ¬])) { continue; } $f®§•ƒÕ•– = $f§ãÊÔÛÜ—[72] . (isset($B®¸ƒ°ôª[$CÄ ˜Ü­Ñ¬]) ? $B®¸ƒ°ôª[$CÄ ˜Ü­Ñ¬] : ucfirst($CÄ ˜Ü­Ñ¬)); if (!class_exists($f®§•ƒÕ•–)) { continue; } $fÜ¡í”Ûóö[] = $b†ÀèØÛïñ[$f§ãÊÔÛÜ—[394]]; } return $fÜ¡í”Ûóö; } } class Cache { protected static $handle; protected static $memoryCache; public static function init() { goto bÑíÊåè¸ó; dää°Õò‚ª: switch ($e²Åš˜íñ[$b³¸¢ğëÂõ[810]]) { case $b³¸¢ğëÂõ[17]: self::$handle = Model($b³¸¢ğëÂõ[812]); break; case $b³¸¢ğëÂõ[813]: self::$handle = new CacheRedis($AÖÈ¬‰è‹±, $dé¡ğÇõ); break; case $b³¸¢ğëÂõ[814]: self::$handle = new CacheMemcached($AÖÈ¬‰è‹±, $dé¡ğÇõ); break; case $b³¸¢ğëÂõ[193]: self::$handle = new CacheFile($AÖÈ¬‰è‹±, $dé¡ğÇõ); break; default: break; } return self::$handle; goto CŒ„¦‡ğæö; bÑíÊåè¸ó: $b³¸¢ğëÂõ =& $_SERVER[ªúæÂ¡­ä½]; if (self::$handle) { return self::$handle; } self::$memoryCache = array(); goto CÍô™ˆ‰õÁ; CÍô™ˆ‰õÁ: $e²Åš˜íñ = $GLOBALS[$b³¸¢ğëÂõ[6]][$b³¸¢ğëÂõ[347]]; $AÖÈ¬‰è‹± = $e²Åš˜íñ[$e²Åš˜íñ[$b³¸¢ğëÂõ[810]]]; $dé¡ğÇõ = $e²Åš˜íñ[$b³¸¢ğëÂõ[811]]; goto dää°Õò‚ª; CŒ„¦‡ğæö: } public static function initReset() { self::$handle = !1; self::$memoryCache = !1; } public static function key($dìÒ¸…Ìæ…) { if (is_array($dìÒ¸…Ìæ…) || is_object($dìÒ¸…Ìæ…)) { $dìÒ¸…Ìæ… = json_encode($dìÒ¸…Ìæ…); } $dìÒ¸…Ìæ… = rawurlencode($dìÒ¸…Ìæ…); return md5(KOD_SITE_ID . $_SERVER[ªúæÂ¡­ä½][71] . $dìÒ¸…Ìæ…); } public static function get($dáˆœ «¿À, $f¢ŠïÀó = false) { $Eƒäíš«÷‘ = self::key($dáˆœ «¿À); if ($f¢ŠïÀó) { return unserialize(self::init()->get($Eƒäíš«÷‘)); } if (!isset(self::$memoryCache[$Eƒäíš«÷‘])) { $DÆ¾­”äÉ = self::init()->get($Eƒäíš«÷‘); self::$memoryCache[$Eƒäíš«÷‘] = unserialize($DÆ¾­”äÉ); } return self::$memoryCache[$Eƒäíš«÷‘]; } public static function set($eÉ¬‘¿ë¡–, $f‡»Å¼Å—ç, $F„êµæùò« = false) { goto c¥É—ºÆ¶Í; CÌò·…Ø®: CacheLock::unlock($eÉ¬‘¿ë¡–); return $B÷·Ù¬¤å‰; goto aÔÙÙš›Ï‡; A„Ş®´İÆ: CacheLock::lock($eÉ¬‘¿ë¡–); $B÷·Ù¬¤å‰ = self::init()->set($aèÁŠÓ˜àÀ, serialize($f‡»Å¼Å—ç), $F„êµæùò«); self::$memoryCache[$aèÁŠÓ˜àÀ] = $f‡»Å¼Å—ç; goto CÌò·…Ø®; c¥É—ºÆ¶Í: $aèÁŠÓ˜àÀ = self::key($eÉ¬‘¿ë¡–); if (isset(self::$memoryCache[$aèÁŠÓ˜àÀ]) && self::$memoryCache[$aèÁŠÓ˜àÀ] === $f‡»Å¼Å—ç) { return !0; } if ($F„êµæùò« === 0) { self::$memoryCache[$aèÁŠÓ˜àÀ] = $f‡»Å¼Å—ç; return !0; } goto A„Ş®´İÆ; aÔÙÙš›Ï‡: } public static function getCall($F…ä«‹í, $F¦Ä İÌè, $F™Œ“ÂÈß, $AÛ­ëˆÜª© = array()) { goto fƒ„„˜ ïâ; cÊ–ïÏø: return $BÆ¿ ‹ù‹ó; goto dÁ¨Ù¢êİË; fƒ„„˜ ïâ: $c¦ˆİ•ôŸê =& $_SERVER[ªúæÂ¡­ä½]; $BÆ¿ ‹ù‹ó = self::get($F…ä«‹í); if ($BÆ¿ ‹ù‹ó || $BÆ¿ ‹ù‹ó === $c¦ˆİ•ôŸê[33]) { return $BÆ¿ ‹ù‹ó; } goto aé»Œ˜ñ†; aé»Œ˜ñ†: $BÆ¿ ‹ù‹ó = call_user_func_array($F™Œ“ÂÈß, $AÛ­ëˆÜª©); $BÆ¿ ‹ù‹ó = $BÆ¿ ‹ù‹ó ? $BÆ¿ ‹ù‹ó : $c¦ˆİ•ôŸê[33]; self::set($F…ä«‹í, $BÆ¿ ‹ù‹ó, $F¦Ä İÌè); goto cÊ–ïÏø; dÁ¨Ù¢êİË: } public static function remove($c„„ÖÂØÚó) { goto fğ˜ÍŸ«ã’; d†µµØáˆ: CacheLock::lock($c„„ÖÂØÚó); $e¿†ì’É´Ó = self::init()->remove($Eì¿ŠËÃÔª); CacheLock::unlock($c„„ÖÂØÚó); goto f‚ù¸ƒõŸ; fğ˜ÍŸ«ã’: $Eì¿ŠËÃÔª = self::key($c„„ÖÂØÚó); unset(self::$memoryCache[$Eì¿ŠËÃÔª]); self::clearTimeout(); goto d†µµØáˆ; f‚ù¸ƒõŸ: return $e¿†ì’É´Ó; goto BìÖ’‹–«‡; BìÖ’‹–«‡: } public static function removeMemory($CêİğÌÑ“‚) { $C¸ÔòÕÍ‹› = self::key($CêİğÌÑ“‚); unset(self::$memoryCache[$C¸ÔòÕÍ‹›]); } public static function clearMemory($bë½ÑŒò‘ = false) { if ($bë½ÑŒò‘) { $bë½ÑŒò‘ = self::key($bë½ÑŒò‘); unset(self::$memoryCache[$bë½ÑŒò‘]); return; } self::$memoryCache = null; self::$memoryCache = array(); } public static function deleteAll() { self::$memoryCache = array(); if (method_exists(self::init(), $_SERVER[ªúæÂ¡­ä½][815])) { self::init()->deleteAll(); } } public static function clearTimeout() { if (method_exists(self::init(), $_SERVER[ªúæÂ¡­ä½][816])) { self::init()->clearTimeout(); } } } class CacheFile { public $cachePath; public $prefix; public $cacheTime; public function __construct($eôØß˜¤Å«, $aÈÜÊÔ‚Í) { $B¤²àºòáá =& $_SERVER[ªúæÂ¡­ä½]; $this->cachePath = $eôØß˜¤Å«[$B¤²àºòáá[76]]; $this->prefix = $B¤²àºòáá[817]; $this->cacheTime = $aÈÜÊÔ‚Í; if (!file_exists($this->cachePath)) { mkdir($this->cachePath, 511, !0); } } public function getFile($Eª†º¬ªĞÇ) { $Eø×Òİ…¥Ş =& $_SERVER[ªúæÂ¡­ä½]; $Eª†º¬ªĞÇ = str_replace(array($Eø×Òİ…¥Ş[818], $Eø×Òİ…¥Ş[97], $Eø×Òİ…¥Ş[70]), $Eø×Òİ…¥Ş[819], $Eª†º¬ªĞÇ); return $this->cachePath . $Eø×Òİ…¥Ş[820] . $Eª†º¬ªĞÇ . $Eø×Òİ…¥Ş[821]; } public function set($eçöÀ­¿‘, $aƒóÁÅÙÛø, $eËáÒçÀ´Ã = false) { $B¢…åêº¢± = $this->getFile($eçöÀ­¿‘); if (file_put_contents($B¢…åêº¢±, $this->prefix . $aƒóÁÅÙÛø, LOCK_EX)) { @touch($B¢…åêº¢±, intval(time() + $eËáÒçÀ´Ã)); clearstatcache(); return !0; } @unlink($B¢…åêº¢±); return !1; } public function get($c×ŸÃ“Á²ñ) { $BÔã¿Í…“ = $this->getFile($c×ŸÃ“Á²ñ); if (file_exists($BÔã¿Í…“) && filemtime($BÔã¿Í…“) < time()) { @unlink($BÔã¿Í…“); return !1; } $cÑÀÂğÆĞ = @file_get_contents($BÔã¿Í…“); return substr($cÑÀÂğÆĞ, strlen($this->prefix)); } public function remove($E”Äœİä£‚) { $eˆí®çÈÙ = $this->getFile($E”Äœİä£‚); return @unlink($eˆí®çÈÙ); } public function deleteAll() { $dŞäİÂÈ÷ =& $_SERVER[ªúæÂ¡­ä½]; $bˆòÌ…¾– = scandir($this->cachePath); foreach ($bˆòÌ…¾– as $d­‚ÆÈã…¸) { $DÒö¹¦ÀÎ« = $this->cachePath . $d­‚ÆÈã…¸; if (strpos($DÒö¹¦ÀÎ«, $dŞäİÂÈ÷[821]) && strpos($DÒö¹¦ÀÎ«, $dŞäİÂÈ÷[822])) { @unlink($DÒö¹¦ÀÎ«); } } } public function clearTimeout() { $AÚäÂ„Ò§› =& $_SERVER[ªúæÂ¡­ä½]; $FÎ£³„ªÂ¾ = scandir($this->cachePath); foreach ($FÎ£³„ªÂ¾ as $c¤£ø•¶î¼) { $fÇ»ÇŠ—ÅÁ = $this->cachePath . $c¤£ø•¶î¼; if (strpos($fÇ»ÇŠ—ÅÁ, $AÚäÂ„Ò§›[821]) && strpos($fÇ»ÇŠ—ÅÁ, $AÚäÂ„Ò§›[822]) && filemtime($fÇ»ÇŠ—ÅÁ) < time()) { @unlink($fÇ»ÇŠ—ÅÁ); } } } } goto aĞø™™ë™; dò¹ìßÖ—„: class GroupModel extends ModelBase { protected $tableName = "\x67\162\x6f\165\160"; protected $tableMeta = array("\x74\141\x62\x6c\145\116\141\155\145" => "\x67\162\157\x75\x70\x5f\x6d\x65\x74\141", "\x6d\145\164\141\x46\151\145\154\x64" => "\x67\x72\157\165\160\x49\104"); protected function cacheFunctionAlias($bÈíñø£·ø) { $FãêĞ§®èá =& $_SERVER[ªúæÂ¡­ä½]; return array($FãêĞ§®èá[1788] => array($bÈíñø£·ø[0], $FãêĞ§®èá[1789]), $FãêĞ§®èá[1790] => array($bÈíñø£·ø[0], $FãêĞ§®èá[1791])); } protected function getInfo($aãõêßÔé, $BŠÍ¯õï‘ = false) { $cÇ¸óìí™¡ = $this->getInfoSimple($aãõêßÔé); if (!$cÇ¸óìí™¡) { return !1; } if ($BŠÍ¯õï‘) { return $this->_listDataApplyItem($cÇ¸óìí™¡); } return $this->cacheFunctionGet($_SERVER[ªúæÂ¡­ä½][1792], $aãõêßÔé); } protected function getInfoSimple($DÑ½”§àÎ’, $a§˜ÏÌÏ‚ = false) { $A¥»­‰âñŞ =& $_SERVER[ªúæÂ¡­ä½]; if ($a§˜ÏÌÏ‚) { $féŠÈ¥ºª§ = array($A¥»­‰âñŞ[1714] => intval($DÑ½”§àÎ’)); $DƒÖ¶£ÆÙË = $this->where($féŠÈ¥ºª§)->find(); return is_array($DƒÖ¶£ÆÙË) ? $DƒÖ¶£ÆÙË : array(); } return $this->cacheFunctionGet($A¥»­‰âñŞ[1793], $DÑ½”§àÎ’); } protected function groupAdd($CŠ…£ †Ë) { goto c¹Ä ²ó÷; c¹Ä ²ó÷: $eÇÂˆ‡¬… =& $_SERVER[ªúæÂ¡­ä½]; if (!$CŠ…£ †Ë[$eÇÂˆ‡¬…[479]] && isset($CŠ…£ †Ë[$eÇÂˆ‡¬…[1714]]) && $CŠ…£ †Ë[$eÇÂˆ‡¬…[1714]] == 1) { if ($AÜ¼”¡Š…ó = $this->getInfoSimple($CŠ…£ †Ë[$eÇÂˆ‡¬…[1714]], !0)) { return $CŠ…£ †Ë[$eÇÂˆ‡¬…[1714]]; } } else { $AÜ¼”¡Š…ó = $this->getInfoSimple($CŠ…£ †Ë[$eÇÂˆ‡¬…[479]]); if (!$AÜ¼”¡Š…ó) { return !1; } } $cíì®ÄÌÕß = $eÇÂˆ‡¬…[513]; goto eëÅâ£··ê; BŠ»­ÔÔ: if (isset($CŠ…£ †Ë[$eÇÂˆ‡¬…[1796]])) { $this->metaSet($cÙ¦ªÖŸˆ, array($eÇÂˆ‡¬…[1796] => $CŠ…£ †Ë[$eÇÂˆ‡¬…[1796]], $eÇÂˆ‡¬…[1797] => $CŠ…£ †Ë[$eÇÂˆ‡¬…[1797]])); unset($CŠ…£ †Ë[$eÇÂˆ‡¬…[1796]]); unset($CŠ…£ †Ë[$eÇÂˆ‡¬…[1797]]); } Model($eÇÂˆ‡¬…[1221])->groupRootAdd($cÙ¦ªÖŸˆ); return $cÙ¦ªÖŸˆ; goto c°é¹Óœ‰; eëÅâ£··ê: if ($AÜ¼”¡Š…ó[$eÇÂˆ‡¬…[503]]) { $cíì®ÄÌÕß = $AÜ¼”¡Š…ó[$eÇÂˆ‡¬…[503]] . $AÜ¼”¡Š…ó[$eÇÂˆ‡¬…[1714]] . $eÇÂˆ‡¬…[47]; } $cæŠŸèÄÌµ = array($eÇÂˆ‡¬…[414] => $this->groupNameAuto($CŠ…£ †Ë[$eÇÂˆ‡¬…[479]], $CŠ…£ †Ë[$eÇÂˆ‡¬…[28]]), $eÇÂˆ‡¬…[395] => $CŠ…£ †Ë[$eÇÂˆ‡¬…[479]], $eÇÂˆ‡¬…[567] => $cíì®ÄÌÕß, $eÇÂˆ‡¬…[1794] => $CŠ…£ †Ë[$eÇÂˆ‡¬…[1698]], $eÇÂˆ‡¬…[1795] => 0, $eÇÂˆ‡¬…[1718] => 0); if (isset($CŠ…£ †Ë[$eÇÂˆ‡¬…[1737]])) { $cæŠŸèÄÌµ[$eÇÂˆ‡¬…[1737]] = $CŠ…£ †Ë[$eÇÂˆ‡¬…[1737]]; } else { $aÜÇÌ©†•Í = $this->max($eÇÂˆ‡¬…[1737]); if (!$aÜÇÌ©†•Í) { $aÜÇÌ©†•Í = 0; } $cæŠŸèÄÌµ[$eÇÂˆ‡¬…[1737]] = $aÜÇÌ©†•Í + 1; } goto b¯†˜×ïçâ; b¯†˜×ïçâ: if (!empty($CŠ…£ †Ë[$eÇÂˆ‡¬…[1714]])) { $cæŠŸèÄÌµ[$eÇÂˆ‡¬…[1714]] = $CŠ…£ †Ë[$eÇÂˆ‡¬…[1714]]; } $cÙ¦ªÖŸˆ = $this->add($cæŠŸèÄÌµ); $this->setNamePinyin($cÙ¦ªÖŸˆ, $cæŠŸèÄÌµ[$eÇÂˆ‡¬…[28]]); goto BŠ»­ÔÔ; c°é¹Óœ‰: } protected function groupEdit($fùÂ‹Ï‚Ü, $D˜ÃáĞæƒİ) { goto D«¢‚óåÒ“; A†íÇç´Úõ: if (!empty($D˜ÃáĞæƒİ[$e„ª·¦»™æ[479]])) { $eİŒÁ ± = $this->getInfoSimple($D˜ÃáĞæƒİ[$e„ª·¦»™æ[479]]); if (!$eİŒÁ ±) { return !1; } if ($B…¦÷‹¨¦[$e„ª·¦»™æ[1714]] == $eİŒÁ ±[$e„ª·¦»™æ[1714]]) { return !1; } if ($D˜ÃáĞæƒİ[$e„ª·¦»™æ[479]] != $B…¦÷‹¨¦[$e„ª·¦»™æ[479]]) { if ($eİŒÁ ±[$e„ª·¦»™æ[503]] !== $B…¦÷‹¨¦[$e„ª·¦»™æ[503]] && strpos($eİŒÁ ±[$e„ª·¦»™æ[503]], $B…¦÷‹¨¦[$e„ª·¦»™æ[503]] . $B…¦÷‹¨¦[$e„ª·¦»™æ[1714]] . $e„ª·¦»™æ[47]) === 0) { return !1; } $D˜ÃáĞæƒİ[$e„ª·¦»™æ[567]] = $eİŒÁ ±[$e„ª·¦»™æ[503]] . $D˜ÃáĞæƒİ[$e„ª·¦»™æ[479]] . $e„ª·¦»™æ[47]; $this->_changeChildLevel($B…¦÷‹¨¦, $eİŒÁ ±); } } if (isset($D˜ÃáĞæƒİ[$e„ª·¦»™æ[28]])) { $this->setNamePinyin($fùÂ‹Ï‚Ü, $D˜ÃáĞæƒİ[$e„ª·¦»™æ[28]]); } if (isset($D˜ÃáĞæƒİ[$e„ª·¦»™æ[1796]])) { $this->metaSet($fùÂ‹Ï‚Ü, array($e„ª·¦»™æ[1796] => $D˜ÃáĞæƒİ[$e„ª·¦»™æ[1796]], $e„ª·¦»™æ[1797] => $D˜ÃáĞæƒİ[$e„ª·¦»™æ[1797]])); unset($D˜ÃáĞæƒİ[$e„ª·¦»™æ[1796]]); unset($D˜ÃáĞæƒİ[$e„ª·¦»™æ[1797]]); } goto dé®±Ë«Œ; dé®±Ë«Œ: $this->_clearChildrenCache($B…¦÷‹¨¦); return $this->where(array($e„ª·¦»™æ[1798] => $fùÂ‹Ï‚Ü))->save($D˜ÃáĞæƒİ); goto EÕªƒ÷¸æ³; D«¢‚óåÒ“: $e„ª·¦»™æ =& $_SERVER[ªúæÂ¡­ä½]; $B…¦÷‹¨¦ = $this->getInfoSimple($fùÂ‹Ï‚Ü); if (!$B…¦÷‹¨¦) { return !1; } goto A†íÇç´Úõ; EÕªƒ÷¸æ³: } private function _clearChildrenCache($a°Ç¯»¶£ˆ) { $D¿—Ö…£ƒê =& $_SERVER[ªúæÂ¡­ä½]; $b¤®Û–Ğ›ä = array($D¿—Ö…£ƒê[567] => array($D¿—Ö…£ƒê[526], $a°Ç¯»¶£ˆ[$D¿—Ö…£ƒê[503]] . $a°Ç¯»¶£ˆ[$D¿—Ö…£ƒê[1714]] . $D¿—Ö…£ƒê[527])); $B“îÊ•²Å’ = $this->field($D¿—Ö…£ƒê[1714])->where($b¤®Û–Ğ›ä)->select(); foreach ($B“îÊ•²Å’ as $FÃïšŒ«Ä³) { $this->_clearCache($FÃïšŒ«Ä³[$D¿—Ö…£ƒê[1714]]); } } private function _clearCache($e”¥ÁÜ‡¦Ş) { $Dó®çøÊø =& $_SERVER[ªúæÂ¡­ä½]; $this->cacheFunctionClear($Dó®çøÊø[1792], $e”¥ÁÜ‡¦Ş); $this->cacheFunctionClear($Dó®çøÊø[1793], $e”¥ÁÜ‡¦Ş); } private function _changeChildLevel($E¶ì¹è®ò—, $CÛíå¯†Øˆ, $eø…ÜÈÍâö = false) { goto C™è‡Ëå®‘; C™è‡Ëå®‘: $dÍê±ß¾‰ =& $_SERVER[ªúæÂ¡­ä½]; $A³ŸØèëÏ¢ = $E¶ì¹è®ò—[$dÍê±ß¾‰[503]] . $E¶ì¹è®ò—[$dÍê±ß¾‰[1714]] . $dÍê±ß¾‰[47]; $f¤Ò”Æ¹ßÅ = $CÛíå¯†Øˆ[$dÍê±ß¾‰[503]] . $CÛíå¯†Øˆ[$dÍê±ß¾‰[1714]] . $dÍê±ß¾‰[47] . $E¶ì¹è®ò—[$dÍê±ß¾‰[1714]] . $dÍê±ß¾‰[47]; goto a ë³ŠÒã‡; B†‰»ôâ—Ó: $this->_clearChildrenCache($E¶ì¹è®ò—); $this->where($f¦ÓµÖßÙ˜)->data($a›ÑÕĞ—ô¶)->save(); goto fÎõ¨ÅÑµ; a ë³ŠÒã‡: if ($eø…ÜÈÍâö) { $f¤Ò”Æ¹ßÅ = $CÛíå¯†Øˆ[$dÍê±ß¾‰[503]] . $CÛíå¯†Øˆ[$dÍê±ß¾‰[1714]] . $dÍê±ß¾‰[47]; } $f¦ÓµÖßÙ˜ = array($dÍê±ß¾‰[567] => array($dÍê±ß¾‰[526], $E¶ì¹è®ò—[$dÍê±ß¾‰[503]] . $E¶ì¹è®ò—[$dÍê±ß¾‰[1714]] . $dÍê±ß¾‰[527])); $a›ÑÕĞ—ô¶ = array($dÍê±ß¾‰[567] => array($dÍê±ß¾‰[575], "\x72\145\x70\154\x61\x63\145\50\x70\x61\162\145\x6e\164\114\145\x76\x65\x6c\x2c\47{$A³ŸØèëÏ¢}\47\54\47{$f¤Ò”Æ¹ßÅ}\x27\51")); goto B†‰»ôâ—Ó; fÎõ¨ÅÑµ: } public function setNamePinyin($DÛºÑ®£×º, $fÒ´ƒØö·× = false) { $aœ¦òË´¿ =& $_SERVER[ªúæÂ¡­ä½]; if (!$fÒ´ƒØö·×) { $C‹ö±‘¶ù = $this->getInfoSimple($DÛºÑ®£×º); $fÒ´ƒØö·× = $C‹ö±‘¶ù[$aœ¦òË´¿[28]]; } if (!Input::check($fÒ´ƒØö·×, $aœ¦òË´¿[570])) { $this->metaSet($DÛºÑ®£×º, $aœ¦òË´¿[445], null); $this->metaSet($DÛºÑ®£×º, $aœ¦òË´¿[444], null); return; } $BÊÙ¢éåì = array($aœ¦òË´¿[445] => str_replace($aœ¦òË´¿[50], $aœ¦òË´¿[33], Pinyin::encode($fÒ´ƒØö·×)), $aœ¦òË´¿[444] => Pinyin::encode($fÒ´ƒØö·×, $aœ¦òË´¿[571])); $this->metaSet($DÛºÑ®£×º, $BÊÙ¢éåì); } protected function groupStatus($F’Šô¡­ñ—, $b½…““ºĞ) { goto dÆÊÆà†ÍÌ; D¤”Éß¿¯: foreach ($F×Õ¥¹„¨Ÿ as $F’Šô¡­ñ—) { $a÷ÊÓ™Øë¨[] = array($D‡°ÜæÍ[1714] => $F’Šô¡­ñ—, $D‡°ÜæÍ[93] => $D‡°ÜæÍ[728], $D‡°ÜæÍ[372] => $b½…““ºĞ); $this->_clearCache($F’Šô¡­ñ—); } return Model($D‡°ÜæÍ[1799])->addAll($a÷ÊÓ™Øë¨, array(), !0); goto d‰ÄÍİñ; e×‡’ĞØ‰: if ($b½…““ºĞ == $D‡°ÜæÍ[87]) { $F×Õ¥¹„¨Ÿ = $this->parentLevelArray($c‹Şø·ë‘­[$D‡°ÜæÍ[503]]); } else { $e”ñòçèçƒ = array($D‡°ÜæÍ[567] => array($D‡°ÜæÍ[526], $c‹Şø·ë‘­[$D‡°ÜæÍ[503]] . $c‹Şø·ë‘­[$D‡°ÜæÍ[1714]] . $D‡°ÜæÍ[527])); $F×Õ¥¹„¨Ÿ = $this->where($e”ñòçèçƒ)->field($D‡°ÜæÍ[1714])->select(); $F×Õ¥¹„¨Ÿ = array_to_keyvalue($F×Õ¥¹„¨Ÿ, $D‡°ÜæÍ[33], $D‡°ÜæÍ[1714]); } $F×Õ¥¹„¨Ÿ[] = $c‹Şø·ë‘­[$D‡°ÜæÍ[1714]]; $a÷ÊÓ™Øë¨ = array(); goto D¤”Éß¿¯; dÆÊÆà†ÍÌ: $D‡°ÜæÍ =& $_SERVER[ªúæÂ¡­ä½]; $c‹Şø·ë‘­ = $this->getInfoSimple($F’Šô¡­ñ—); if (!$c‹Şø·ë‘­) { return !1; } goto e×‡’ĞØ‰; d‰ÄÍİñ: } protected function groupRemove($b‹©Â® ¾Ñ) { goto Cëé³¼°™; eªİçÕ¸¯Õ: $this->where(array($Aš»ÂÃÑÜ©[479] => $b‹©Â® ¾Ñ))->save(array($Aš»ÂÃÑÜ©[479] => $e­šéïØç[$Aš»ÂÃÑÜ©[479]])); Model($Aš»ÂÃÑÜ©[1799])->where($eø©ˆ‚öÊ»)->delete(); Model($Aš»ÂÃÑÜ©[1800])->where($eø©ˆ‚öÊ»)->delete(); goto fæƒ­ªáÏÂ; aÊ¼±¢”: if (!$e­šéïØç || $e­šéïØç[$Aš»ÂÃÑÜ©[479]] == 0) { return !1; } $e¡ğ¹…œ‹½ = $this->getInfoSimple($e­šéïØç[$Aš»ÂÃÑÜ©[479]]); $this->_changeChildLevel($e­šéïØç, $e¡ğ¹…œ‹½, !0); goto eªİçÕ¸¯Õ; fæƒ­ªáÏÂ: Model($Aš»ÂÃÑÜ©[808])->groupRootRemove($b‹©Â® ¾Ñ); return $this->where($eø©ˆ‚öÊ»)->delete(); goto eíÓĞ¬ÒÏµ; Cëé³¼°™: $Aš»ÂÃÑÜ© =& $_SERVER[ªúæÂ¡­ä½]; $eø©ˆ‚öÊ» = array($Aš»ÂÃÑÜ©[1714] => $b‹©Â® ¾Ñ); $e­šéïØç = $this->where($eø©ˆ‚öÊ»)->find(); goto aÊ¼±¢”; eíÓĞ¬ÒÏµ: } protected function groupSort($a‚˜ä²‰”“) { $Cğù‚›’¾ö =& $_SERVER[ªúæÂ¡­ä½]; $EŠê…¤ÔÖ¼ = array(); foreach ($a‚˜ä²‰”“ as $AôÄ‰¾¥µ‹ => $aª©·‡±Á°) { $EŠê…¤ÔÖ¼[] = array($Cğù‚›’¾ö[1714], $aª©·‡±Á°, $Cğù‚›’¾ö[1737], $AôÄ‰¾¥µ‹ + 1); } $this->saveAll($EŠê…¤ÔÖ¼); } public function listData() { $cÄÃÉĞë‡¨ = $this->_makeOrder()->selectPage(50); $this->_listDataApply($cÄÃÉĞë‡¨[$_SERVER[ªúæÂ¡­ä½][367]]); return $cÄÃÉĞë‡¨; } private function _makeOrder($c×ÎšËˆëÔ = '') { goto AÍ­ä‡ˆ®; AÍ­ä‡ˆ®: $få¤—ÊæàÚ =& $_SERVER[ªúæÂ¡­ä½]; $cù™ñ¹Ø”­ = array($få¤—ÊæàÚ[1714], $få¤—ÊæàÚ[28], $få¤—ÊæàÚ[1700], $få¤—ÊæàÚ[194]); $a„ë…í­î¶ = array($få¤—ÊæàÚ[429] => $få¤—ÊæàÚ[430], $få¤—ÊæàÚ[431] => $få¤—ÊæàÚ[432]); goto AÕ³ÓŸ„¢; a½Ïõë­›í: $c×ÎšËˆëÔ = $c×ÎšËˆëÔ . "{$bÇ°¿äîå¤}\40{$A…Å’ÕÙ¦…}\x2c\40\147\x72\x6f\x75\x70\x49\x44\40\141\163\143"; return $this->order($c×ÎšËˆëÔ); goto dÏ‰ï º’; AÕ³ÓŸ„¢: $bÇ°¿äîå¤ = Input::get($få¤—ÊæàÚ[436], $få¤—ÊæàÚ[7], $få¤—ÊæàÚ[1718], $cù™ñ¹Ø”­); $A…Å’ÕÙ¦… = Input::get($få¤—ÊæàÚ[437], $få¤—ÊæàÚ[7], $få¤—ÊæàÚ[1801], array($få¤—ÊæàÚ[1801], $få¤—ÊæàÚ[431])); $A…Å’ÕÙ¦… = $a„ë…í­î¶[$A…Å’ÕÙ¦…]; goto a½Ïõë­›í; dÏ‰ï º’: } public function listChild($dáæµ“‡ğö) { $B®Š·Øó¦ =& $_SERVER[ªúæÂ¡­ä½]; $aÚ–ŠÓá‚¾ = $this->where(array($B®Š·Øó¦[479] => $dáæµ“‡ğö))->_makeOrder()->selectPage(200); $this->_listDataApply($aÚ–ŠÓá‚¾[$B®Š·Øó¦[367]]); return $aÚ–ŠÓá‚¾; } public function listByID($F±¥äËõ³±) { $dÄª¨Ê¼§„ =& $_SERVER[ªúæÂ¡­ä½]; if (!$F±¥äËõ³±) { return array(); } $cˆƒ’¾„ö = array($dÄª¨Ê¼§„[1714] => array($dÄª¨Ê¼§„[7], $F±¥äËõ³±)); $C—”â‡²Òç = $this->where($cˆƒ’¾„ö)->select(); $this->_listDataApply($C—”â‡²Òç); return $C—”â‡²Òç; } public function listSearch($AòĞ‚œóÏÏ) { goto bÈ‚ÕÂ¨Š; bñ¬Œ‰¨‘Ö: if ($FÙİ±ƒÉ Í) { $Cæ›½ˆŞ‡ = $this->getInfoSimple($FÙİ±ƒÉ Í); $dˆ¥½¥¡Éœ = $Cæ›½ˆŞ‡[$d—¥„íºÉ[503]] . $FÙİ±ƒÉ Í . $d—¥„íºÉ[527]; $bçá—Ò¸áÒ = array($bçá—Ò¸áÒ, array($d—¥„íºÉ[503] => array($d—¥„íºÉ[380], $dˆ¥½¥¡Éœ))); } $bçá—Ò¸áÒ = $this->parseWhereLike($bçá—Ò¸áÒ); $c¨µ¹ÔÖ© = $this->_makeOrder()->where($bçá—Ò¸áÒ)->selectPage(20); goto EŒœÚ‰ó»; bÈ‚ÕÂ¨Š: $d—¥„íºÉ =& $_SERVER[ªúæÂ¡­ä½]; $f¸ªªƒ = $AòĞ‚œóÏÏ[$d—¥„íºÉ[1802]]; $FÙİ±ƒÉ Í = isset($AòĞ‚œóÏÏ[$d—¥„íºÉ[1803]]) ? $AòĞ‚œóÏÏ[$d—¥„íºÉ[1803]] : !1; goto f¼ÅßÛè¿; a»µ¤—…±‰: return $c¨µ¹ÔÖ©; goto B‘¹Ê²Ô¦; EŒœÚ‰ó»: $c¨µ¹ÔÖ© = $c¨µ¹ÔÖ© ? $c¨µ¹ÔÖ© : array($d—¥„íºÉ[367] => array(), $d—¥„íºÉ[364] => array()); if (!$c¨µ¹ÔÖ© || count($c¨µ¹ÔÖ©[$d—¥„íºÉ[367]]) < 5 && Input::check($f¸ªªƒ, $d—¥„íºÉ[316])) { goto eª¥Òš•£¸; dµ„–âˆ‡³: $c¨µ¹ÔÖ©[$d—¥„íºÉ[364]][$d—¥„íºÉ[366]] = ceil($c¨µ¹ÔÖ©[$d—¥„íºÉ[364]][$d—¥„íºÉ[365]] / $c¨µ¹ÔÖ©[$d—¥„íºÉ[364]][$d—¥„íºÉ[361]]); goto déÌ©Íó»¨; eª¥Òš•£¸: $A«İ÷×Ä› = $this->groupChildrenAll($FÙİ±ƒÉ Í); $eèö…¢ç¢‰ = $this->_searchFromMeta($d—¥„íºÉ[444], $f¸ªªƒ, 10, $A«İ÷×Ä›); $EÔÍ“æ†ˆÕ = $this->_searchFromMeta($d—¥„íºÉ[445], $f¸ªªƒ, 10, $A«İ÷×Ä›); goto aÍéÅ—ŒÙ; aÍéÅ—ŒÙ: $aÍÑ–›”Ù = array_merge($eèö…¢ç¢‰, $EÔÍ“æ†ˆÕ, $c¨µ¹ÔÖ©[$d—¥„íºÉ[367]]); $c¨µ¹ÔÖ©[$d—¥„íºÉ[367]] = array_unique_by_key($aÍÑ–›”Ù, $d—¥„íºÉ[1714]); $c¨µ¹ÔÖ©[$d—¥„íºÉ[364]][$d—¥„íºÉ[365]] = count($c¨µ¹ÔÖ©[$d—¥„íºÉ[367]]); goto dµ„–âˆ‡³; déÌ©Íó»¨: } $this->_listDataApply($c¨µ¹ÔÖ©[$d—¥„íºÉ[367]]); goto a»µ¤—…±‰; f¼ÅßÛè¿: if (!trim($f¸ªªƒ)) { return !1; } $f¸ªªƒ = str_replace($d—¥„íºÉ[1804], $d—¥„íºÉ[1805], $f¸ªªƒ); $bçá—Ò¸áÒ = array($d—¥„íºÉ[1714] => array($d—¥„íºÉ[380], "{$f¸ªªƒ}\x25"), $d—¥„íºÉ[28] => array($d—¥„íºÉ[380], "\45{$f¸ªªƒ}\45"), $d—¥„íºÉ[974] => $d—¥„íºÉ[1806]); goto bñ¬Œ‰¨‘Ö; B‘¹Ê²Ô¦: } protected function groupChildrenAll($eÂ¥«„È­œ) { $e ø÷÷ãã´ =& $_SERVER[ªúæÂ¡­ä½]; if (!$eÂ¥«„È­œ) { return !1; } if (is_string($eÂ¥«„È­œ)) { $eÂ¥«„È­œ = array($eÂ¥«„È­œ); } $d§õ‘ã = $eÂ¥«„È­œ; foreach ($eÂ¥«„È­œ as $Fàªİ§±‚È) { $C°Š”Ú–Øê = $this->getInfoSimple($Fàªİ§±‚È); $eèØ“ÑÚ¦÷ = array($e ø÷÷ãã´[503] => array($e ø÷÷ãã´[380], $C°Š”Ú–Øê[$e ø÷÷ãã´[503]] . $Fàªİ§±‚È . $e ø÷÷ãã´[527])); $d§¯ŞÁóµÆ = $this->field($e ø÷÷ãã´[1714])->where($eèØ“ÑÚ¦÷)->select(); $d§õ‘ã = array_merge($d§õ‘ã, array_to_keyvalue($d§¯ŞÁóµÆ, $e ø÷÷ãã´[33], $e ø÷÷ãã´[1714])); } return array_unique($d§õ‘ã); } private function _searchFromMeta($aæÊ—œˆÊÉ, $fìÜÀ…ÂçÕ, $EØğ•¤Íƒ, $EêÅªÃ×Œ) { goto aä–£æ­Ë¶; bœ‹İéˆ: if (!$EÇÙ‚æ¸¹Á) { return array(); } $EÇÙ‚æ¸¹Á = array_to_keyvalue($EÇÙ‚æ¸¹Á, $a¬Ãµ‡©Šø[33], $a¬Ãµ‡©Šø[1714]); $fäÖ×·Å±Ù = $this->where(array($a¬Ãµ‡©Šø[1798] => array($a¬Ãµ‡©Šø[7], $EÇÙ‚æ¸¹Á)))->select(); goto b†Š»‚°Á…; b†Š»‚°Á…: if (!$fäÖ×·Å±Ù) { return array(); } return $fäÖ×·Å±Ù; goto BØÊñ‰”; aä–£æ­Ë¶: $a¬Ãµ‡©Šø =& $_SERVER[ªúæÂ¡­ä½]; $fìÜÀ…ÂçÕ = strtolower($fìÜÀ…ÂçÕ); $f×ÈìÏÌŸ = array($a¬Ãµ‡©Šø[93] => $aæÊ—œˆÊÉ, $a¬Ãµ‡©Šø[372] => array($a¬Ãµ‡©Šø[380], "\45{$fìÜÀ…ÂçÕ}\x25")); goto BèìÕø; BèìÕø: $f×ÈìÏÌŸ = $this->parseWhereLike($f×ÈìÏÌŸ); if ($EêÅªÃ×Œ) { $f×ÈìÏÌŸ[$a¬Ãµ‡©Šø[1714]] = array($a¬Ãµ‡©Šø[7], $EêÅªÃ×Œ); } $EÇÙ‚æ¸¹Á = Model($a¬Ãµ‡©Šø[1807])->where($f×ÈìÏÌŸ)->limit($EØğ•¤Íƒ)->select(); goto bœ‹İéˆ; BØÊñ‰”: } protected function _listDataApplyItem($CƒèÁ×è›) { $aÇğ¦ßŞ“¿ = array($CƒèÁ×è›); $this->_listDataApply($aÇğ¦ßŞ“¿); return $aÇğ¦ßŞ“¿[0]; } protected function _listDataApply(&$aæÈŒ—Ø“Î) { goto b…¿ê§Äñˆ; b…¿ê§Äñˆ: $d–Š²Ÿê÷Ø =& $_SERVER[ªúæÂ¡­ä½]; if (!$aæÈŒ—Ø“Î) { return; } $E†ŠˆÜâÉ… = array_to_keyvalue($aæÈŒ—Ø“Î, $d–Š²Ÿê÷Ø[33], $d–Š²Ÿê÷Ø[1714]); goto CÄ†í‡É…Ù; eìš¬£‚: $this->_listAppendParent($aæÈŒ—Ø“Î); $this->_listAppendSourceRoot($aæÈŒ—Ø“Î, $E†ŠˆÜâÉ…); goto Ešè®–¶•ï; CÄ†í‡É…Ù: $this->_listAppendChildren($aæÈŒ—Ø“Î); $this->_listAppendChildrenMember($aæÈŒ—Ø“Î); $this->_listAppendMeta($aæÈŒ—Ø“Î, $E†ŠˆÜâÉ…); goto eìš¬£‚; Ešè®–¶•ï: } private function _listAppendChildren(&$c¨ÒÅÆ¶ñ) { goto F¥‡õµ·µ­; F¥‡õµ·µ­: $A³‘©ë·Ò =& $_SERVER[ªúæÂ¡­ä½]; $B¼²ÅÔœİ = array_to_keyvalue($c¨ÒÅÆ¶ñ, $A³‘©ë·Ò[33], $A³‘©ë·Ò[1714]); $CÂŸÛ¬™¹ = array($A³‘©ë·Ò[479] => array($A³‘©ë·Ò[7], $B¼²ÅÔœİ)); goto DˆÁ¶‰ñÏ¨; D‘˜ÎªôÛË: foreach ($c¨ÒÅÆ¶ñ as &$c÷‡·×ìÒµ) { $c’¢‹Œô ½ = $c÷‡·×ìÒµ[$A³‘©ë·Ò[1714]]; $c÷‡·×ìÒµ[$A³‘©ë·Ò[1809]] = isset($dØ¬„ªÇª[$c’¢‹Œô ½]) ? intval($dØ¬„ªÇª[$c’¢‹Œô ½]) : !1; } unset($c÷‡·×ìÒµ); goto B§§º³‹¯¹; DˆÁ¶‰ñÏ¨: $bö™ÃÉ¸ø = array($A³‘©ë·Ò[479], $A³‘©ë·Ò[1808] => $A³‘©ë·Ò[481]); $Eğğé¢È¢ = $this->field($bö™ÃÉ¸ø)->where($CÂŸÛ¬™¹)->group($A³‘©ë·Ò[479])->select(); $dØ¬„ªÇª = array_to_keyvalue($Eğğé¢È¢, $A³‘©ë·Ò[479], $A³‘©ë·Ò[481]); goto D‘˜ÎªôÛË; B§§º³‹¯¹: } private function _listAppendChildrenMember(&$f•ÎÏÔö…³) { goto aˆ‘å¸ª²‰; aˆ‘å¸ª²‰: $e² Ö¥’æ =& $_SERVER[ªúæÂ¡­ä½]; $Cİ Õ¶ãİ = array_to_keyvalue($f•ÎÏÔö…³, $e² Ö¥’æ[33], $e² Ö¥’æ[1714]); $Aøµö‘‹Ã = array($e² Ö¥’æ[1714] => array($e² Ö¥’æ[7], $Cİ Õ¶ãİ)); goto FÅˆ÷óÒèŸ; FÅˆ÷óÒèŸ: $B¯ìÓÅ³Îò = array($e² Ö¥’æ[1714], $e² Ö¥’æ[1808] => $e² Ö¥’æ[481]); $cùÆæ‡†åÆ = Model($e² Ö¥’æ[1800])->field($B¯ìÓÅ³Îò)->where($Aøµö‘‹Ã)->group($e² Ö¥’æ[1714])->select(); $A“ÚÆ® = array_to_keyvalue($cùÆæ‡†åÆ, $e² Ö¥’æ[1714], $e² Ö¥’æ[481]); goto e‹Ñˆ¹Û ß; e‹Ñˆ¹Û ß: foreach ($f•ÎÏÔö…³ as &$Fäî˜öÓŒ³) { $E´äÌé«½‡ = $Fäî˜öÓŒ³[$e² Ö¥’æ[1714]]; $Fäî˜öÓŒ³[$e² Ö¥’æ[1810]] = isset($A“ÚÆ®[$E´äÌé«½‡]) ? intval($A“ÚÆ®[$E´äÌé«½‡]) : !1; } unset($Fäî˜öÓŒ³); goto Açöí™–ğµ; Açöí™–ğµ: } private function _listAppendMeta(&$fŒã¿§ãØ, $b®¢”©Œê«) { goto d½ö´æ¾™; C¦¹•–ñ³³: $D¤¬èõ‘Ê‹ = array_to_keyvalue_group($D¤¬èõ‘Ê‹, $c‘“Õ‡‡”á[1714]); foreach ($D¤¬èõ‘Ê‹ as &$b¢ÉÜÀô–î) { $b¢ÉÜÀô–î = array_to_keyvalue($b¢ÉÜÀô–î, $c‘“Õ‡‡”á[93], $c‘“Õ‡‡”á[372]); } unset($b¢ÉÜÀô–î); goto cé¯áÈ©­; cé¯áÈ©­: foreach ($fŒã¿§ãØ as &$Bè¢Á±Šã) { $Bè¢Á±Šã[$c‘“Õ‡‡”á[446]] = array(); if (isset($D¤¬èõ‘Ê‹[$Bè¢Á±Šã[$c‘“Õ‡‡”á[1714]]])) { $Bè¢Á±Šã[$c‘“Õ‡‡”á[446]] = $D¤¬èõ‘Ê‹[$Bè¢Á±Šã[$c‘“Õ‡‡”á[1714]]]; } } unset($Bè¢Á±Šã); goto EÊÕ÷³ö‡¿; d½ö´æ¾™: $c‘“Õ‡‡”á =& $_SERVER[ªúæÂ¡­ä½]; $Eà¸®ŸÁ© = array($c‘“Õ‡‡”á[1714] => array($c‘“Õ‡‡”á[7], $b®¢”©Œê«)); $D¤¬èõ‘Ê‹ = Model($c‘“Õ‡‡”á[1799])->where($Eà¸®ŸÁ©)->select(); goto C¦¹•–ñ³³; EÊÕ÷³ö‡¿: } protected function parentLevelArray($eâª±—‚Ã“) { $b˜Š‰Á–ö =& $_SERVER[ªúæÂ¡­ä½]; $eâª±—‚Ã“ = explode($b˜Š‰Á–ö[47], trim($eâª±—‚Ã“, $b˜Š‰Á–ö[47])); $eâª±—‚Ã“ = array_remove_value($eâª±—‚Ã“, $b˜Š‰Á–ö[191]); return $eâª±—‚Ã“; } private function _listAppendParent(&$b¶°ÄÆÜˆ) { goto eõõïè†Ç±; E¡‰ˆ”£Â•: unset($Cì‘Ä¿Ûƒ¤); foreach ($f™ïÁ…ÈÂ½ as $d›³á¹µ¹ç => $bÑœ§Òøğ¹) { if ($bÑœ§Òøğ¹) { continue; } $CË³‚á»Ë = $this->getInfoSimple($d›³á¹µ¹ç); $f™ïÁ…ÈÂ½[$d›³á¹µ¹ç] = $CË³‚á»Ë[$aßÀ²–ÄË[28]]; } $dìç†Í„¯ = $GLOBALS[$aßÀ²–ÄË[6]][$aßÀ²–ÄË[88]][$aßÀ²–ÄË[1811]]; goto E°÷©­ª¬Ü; E°÷©­ª¬Ü: if ($GLOBALS[$aßÀ²–ÄË[486]] == $aßÀ²–ÄË[87]) { $dìç†Í„¯ = !1; } foreach ($b¶°ÄÆÜˆ as &$Cì‘Ä¿Ûƒ¤) { $eÎíõµ¼íÙ = $this->parentLevelArray($Cì‘Ä¿Ûƒ¤[$aßÀ²–ÄË[503]]); $dõ£ìğµ¼ = $aßÀ²–ÄË[33]; foreach ($eÎíõµ¼íÙ as $d›³á¹µ¹ç => $eëÕÇóÌÍ) { if ($dìç†Í„¯ && $d›³á¹µ¹ç == 0) { continue; } $dõ£ìğµ¼ .= $f™ïÁ…ÈÂ½[$eëÕÇóÌÍ] . $aßÀ²–ÄË[8]; } if ($eÎíõµ¼íÙ) { $dõ£ìğµ¼ .= $Cì‘Ä¿Ûƒ¤[$aßÀ²–ÄË[28]]; } $Cì‘Ä¿Ûƒ¤[$aßÀ²–ÄË[508]] = str_replace($aßÀ²–ÄË[511], $aßÀ²–ÄË[8], $dõ£ìğµ¼); } unset($Cì‘Ä¿Ûƒ¤); goto Dô¢ÒŠ’ŠÆ; eõõïè†Ç±: $aßÀ²–ÄË =& $_SERVER[ªúæÂ¡­ä½]; $f™ïÁ…ÈÂ½ = array(); foreach ($b¶°ÄÆÜˆ as &$Cì‘Ä¿Ûƒ¤) { $f™ïÁ…ÈÂ½[$Cì‘Ä¿Ûƒ¤[$aßÀ²–ÄË[1714]]] = $Cì‘Ä¿Ûƒ¤[$aßÀ²–ÄË[28]]; $eÎíõµ¼íÙ = $this->parentLevelArray($Cì‘Ä¿Ûƒ¤[$aßÀ²–ÄË[503]]); foreach ($eÎíõµ¼íÙ as $eëÕÇóÌÍ) { if (!isset($f™ïÁ…ÈÂ½[$eëÕÇóÌÍ])) { $f™ïÁ…ÈÂ½[$eëÕÇóÌÍ] = 0; } } } goto E¡‰ˆ”£Â•; Dô¢ÒŠ’ŠÆ: } private function _listAppendSourceRoot(&$dŒˆ»³Œ¼, $d¯½«ªŠÜõ) { goto E«‚Û†›«; E«‚Û†›«: $aËµñòï§â =& $_SERVER[ªúæÂ¡­ä½]; $Dîº£¦ôÏ‹ = array($aËµñòï§â[479] => 0, $aËµñòï§â[485] => array($aËµñòï§â[7], $d¯½«ªŠÜõ), $aËµñòï§â[405] => SourceModel::TYPE_GROUP); $A×ª‘ã¾ùì = Model($aËµñòï§â[808])->order($aËµñòï§â[1812])->field($aËµñòï§â[1813]); goto B§¡º‰ëïÄ; B§¡º‰ëïÄ: $D‘©®®ˆ³ = $A×ª‘ã¾ùì->limit(count($d¯½«ªŠÜõ))->where($Dîº£¦ôÏ‹)->select(); $D‘©®®ˆ³ = array_to_keyvalue($D‘©®®ˆ³, $aËµñòï§â[485]); $D‘©®®ˆ³ = array_remove_key($D‘©®®ˆ³, $aËµñòï§â[485]); goto A½¬ğì¬í…; A½¬ğì¬í…: foreach ($dŒˆ»³Œ¼ as &$aï½¸°Õ¥÷) { $aï½¸°Õ¥÷[$aËµñòï§â[85]] = $D‘©®®ˆ³[$aï½¸°Õ¥÷[$aËµñòï§â[1714]]] ? $D‘©®®ˆ³[$aï½¸°Õ¥÷[$aËµñòï§â[1714]]] : array(); } unset($aï½¸°Õ¥÷); goto EòºÓÈôÎ; EòºÓÈôÎ: } protected function groupMerge($f¦µğ‚ÏÖ) { $f¦µğ‚ÏÖ = array_values(array_unique($f¦µğ‚ÏÖ)); $AÓ‘¹÷Ò¤Ë = array(); for ($Cœİò…ŸøÜ = 0; $Cœİò…ŸøÜ < count($f¦µğ‚ÏÖ); $Cœİò…ŸøÜ++) { $B„‚ÛÓ¥¶ğ = !1; for ($fí“ÍÒÜ’ = 0; $fí“ÍÒÜ’ < count($f¦µğ‚ÏÖ); $fí“ÍÒÜ’++) { if ($Cœİò…ŸøÜ == $fí“ÍÒÜ’) { continue; } if ($this->isParentOf($f¦µğ‚ÏÖ[$fí“ÍÒÜ’], $f¦µğ‚ÏÖ[$Cœİò…ŸøÜ])) { $B„‚ÛÓ¥¶ğ = !0; break; } } if (!$B„‚ÛÓ¥¶ğ) { $AÓ‘¹÷Ò¤Ë[] = $f¦µğ‚ÏÖ[$Cœİò…ŸøÜ]; } } return $AÓ‘¹÷Ò¤Ë; } protected function isParentOf($f¢ôÕÆ¼ , $cÆ×àºÉ¯¡) { goto c‚Ù¦²Ù¸‚; C©¨ä‹£Ôˆ: $FËèªÒÚ = $this->getInfoSimple($cÆ×àºÉ¯¡); $bôùİÀïäà = $aØòÁÚ¨é³[$aÅå…¬áè°[503]] . $f¢ôÕÆ¼  . $aÅå…¬áè°[47]; if (substr($FËèªÒÚ[$aÅå…¬áè°[503]], 0, strlen($bôùİÀïäà)) == $bôùİÀïäà) { return !0; } goto aÍö¶™©; aÍö¶™©: return !1; goto c‘­¤È¿Ü; c‚Ù¦²Ù¸‚: $aÅå…¬áè° =& $_SERVER[ªúæÂ¡­ä½]; if (!$f¢ôÕÆ¼  || !$cÆ×àºÉ¯¡ || $f¢ôÕÆ¼  == $cÆ×àºÉ¯¡) { return !1; } $aØòÁÚ¨é³ = $this->getInfoSimple($f¢ôÕÆ¼ ); goto C©¨ä‹£Ôˆ; c‘­¤È¿Ü: } public function groupShowRoot($f•£àŒ´£, $F¡ĞÙò¶å– = false) { goto B¤ƒíë®×; a¸†øÇ³†: return $c¾­µœ÷‘¯; goto bùØÛéèõ; AÁ Îœ¿Ì: $d™óë×Àò© = $this->parentLevelArray($C˜¸Üë’Ñ‡[$E™Ñíˆ–Ñë[503]]); $c¾­µœ÷‘¯ = array($f•£àŒ´£); if (count($d™óë×Àò©) == 0) { return $c¾­µœ÷‘¯; } goto D†…ïÑƒÁƒ; D†…ïÑƒÁƒ: if ($F¡ĞÙò¶å– && count($d™óë×Àò©) == 1) { return $c¾­µœ÷‘¯; } if (!$C˜¸Üë’Ñ‡[$E™Ñíˆ–Ñë[446]] || !isset($C˜¸Üë’Ñ‡[$E™Ñíˆ–Ñë[446]][$E™Ñíˆ–Ñë[1796]]) || $C˜¸Üë’Ñ‡[$E™Ñíˆ–Ñë[446]][$E™Ñíˆ–Ñë[1796]] == $E™Ñíˆ–Ñë[1768]) { return $this->groupShowRoot($d™óë×Àò©[count($d™óë×Àò©) - 1], $F¡ĞÙò¶å–); } if ($C˜¸Üë’Ñ‡[$E™Ñíˆ–Ñë[446]][$E™Ñíˆ–Ñë[1796]] == $E™Ñíˆ–Ñë[355]) { $FÀ‡À¿£˜‹ = explode($E™Ñíˆ–Ñë[47], $C˜¸Üë’Ñ‡[$E™Ñíˆ–Ñë[446]][$E™Ñíˆ–Ñë[1797]]); if ($FÀ‡À¿£˜‹) { $c¾­µœ÷‘¯ = array_merge($c¾­µœ÷‘¯, $FÀ‡À¿£˜‹); } } goto a¸†øÇ³†; B¤ƒíë®×: $E™Ñíˆ–Ñë =& $_SERVER[ªúæÂ¡­ä½]; $C˜¸Üë’Ñ‡ = $this->getInfo($f•£àŒ´£); if (!$C˜¸Üë’Ñ‡) { return array(); } goto AÁ Îœ¿Ì; bùØÛéèõ: } protected function resetParentLevel() { $F¬½ó” =& $_SERVER[ªúæÂ¡­ä½]; $CØĞ‚…±° = $F¬½ó”[1714]; $F”êåÊùÀ¡ = $this->select(); $F”êåÊùÀ¡ = array_to_keyvalue($F”êåÊùÀ¡, $CØĞ‚…±°); foreach ($F”êåÊùÀ¡ as $f­óÑÂÈí) { goto f¡‡ğÃñÅä; Eê¶óµË: $a®“ŠÑ«ƒ½[] = 0; $a®“ŠÑ«ƒ½ = $F¬½ó”[47] . implode($F¬½ó”[47], array_reverse($a®“ŠÑ«ƒ½)) . $F¬½ó”[47]; $this->setNamePinyin($f­óÑÂÈí[$CØĞ‚…±°], $f­óÑÂÈí[$F¬½ó”[28]]); goto DóÇ˜ã‹»®; f¡‡ğÃñÅä: $a¤ù¹ÑÌõß = $f­óÑÂÈí; $a®“ŠÑ«ƒ½ = array(); while ($a¤ù¹ÑÌõß[$F¬½ó”[479]] != 0) { $a®“ŠÑ«ƒ½[] = $a¤ù¹ÑÌõß[$F¬½ó”[479]]; $a¤ù¹ÑÌõß = $F”êåÊùÀ¡[$a¤ù¹ÑÌõß[$F¬½ó”[479]]]; } goto Eê¶óµË; DóÇ˜ã‹»®: $this->where(array($CØĞ‚…±° => $f­óÑÂÈí[$CØĞ‚…±°]))->save(array($F¬½ó”[567] => $a®“ŠÑ«ƒ½)); goto CíÙ§³¾ëò; CíÙ§³¾ëò: } return $F”êåÊùÀ¡; } public function groupNameAuto($DãòîÌâ”Ô, $B†˜åªÒ¼¾) { $dª¹¨¸ôäÔ =& $_SERVER[ªúæÂ¡­ä½]; $F¡ç°šïÉØ = $this->where(array($dª¹¨¸ôäÔ[395] => $DãòîÌâ”Ô))->getField($dª¹¨¸ôäÔ[28], !0); if (!$F¡ç°šïÉØ || !in_array($B†˜åªÒ¼¾, $F¡ç°šïÉØ)) { return $B†˜åªÒ¼¾; } for ($Fºâµ÷Ïñ = 1; $Fºâµ÷Ïñ <= count($F¡ç°šïÉØ) + 1; $Fºâµ÷Ïñ++) { $cñ¶±½™åù = $B†˜åªÒ¼¾ . "\50{$Fºâµ÷Ïñ}\51"; if (!in_array($cñ¶±½™åù, $F¡ç°šïÉØ)) { return $cñ¶±½™åù; } } } public function groupSwitch($c±’ÈÜ‰²õ, $B“¬±À©“š) { goto dèÚÉÑÚÅ‰; aâ¼¶†¬¢: $döÉ·òÍõ = Model($aÑä…É£˜†[1800])->where($B’«÷Íà¿¯)->select(); if (!$döÉ·òÍõ) { $döÉ·òÍõ = array(); } foreach ($döÉ·òÍõ as $eğ’òˆØ™Ô) { $d˜ì¯‡ÊØ‡ = $eğ’òˆØ™Ô[$aÑä…É£˜†[1545]]; $B’«÷Íà¿¯ = array($aÑä…É£˜†[1545] => $d˜ì¯‡ÊØ‡, $aÑä…É£˜†[1714] => $B“¬±À©“š); $a½ãªÚ‹¾§ = Model($aÑä…É£˜†[1800])->where($B’«÷Íà¿¯)->find(); if (!$a½ãªÚ‹¾§) { $FŸëÜõ¡²³ = array($B“¬±À©“š => $eğ’òˆØ™Ô[$aÑä…É£˜†[1814]]); Model($aÑä…É£˜†[520])->userGroupAdd($d˜ì¯‡ÊØ‡, $FŸëÜõ¡²³); } Model($aÑä…É£˜†[520])->userGroupRemove($d˜ì¯‡ÊØ‡, $c±’ÈÜ‰²õ); } goto eİäã‡Šî; dèÚÉÑÚÅ‰: $aÑä…É£˜† =& $_SERVER[ªúæÂ¡­ä½]; $B’«÷Íà¿¯ = array($aÑä…É£˜†[1714] => array($aÑä…É£˜†[7], array($c±’ÈÜ‰²õ, $B“¬±À©“š))); $eğÛë’õ“¼ = $this->where($B’«÷Íà¿¯)->select(); goto a²˜ïè’ÏŒ; eİäã‡Šî: $B’«÷Íà¿¯ = array($aÑä…É£˜†[405] => 2, $aÑä…É£˜†[479] => 0, $aÑä…É£˜†[404] => 1, $aÑä…É£˜†[485] => array($aÑä…É£˜†[7], array($c±’ÈÜ‰²õ, $B“¬±À©“š))); $bæÊ–‰œ¯ = Model($aÑä…É£˜†[808])->where($B’«÷Íà¿¯)->field($aÑä…É£˜†[1815])->select(); $bæÊ–‰œ¯ = array_to_keyvalue($bæÊ–‰œ¯, $aÑä…É£˜†[485], $aÑä…É£˜†[396]); goto AóÖ«•ëê; AóÖ«•ëê: $bÅ„àÂØ­Ü = !empty($bæÊ–‰œ¯[$c±’ÈÜ‰²õ]) ? $bæÊ–‰œ¯[$c±’ÈÜ‰²õ] : !1; if ($bÅ„àÂØ­Ü) { goto fŒğ‚ÀÊ’’; f™‡À”×÷Ø: $d†‰šÉĞÊÀ = array($aÑä…É£˜†[485] => $B“¬±À©“š); Model($aÑä…É£˜†[1817])->where($B’«÷Íà¿¯)->save($d†‰šÉĞÊÀ); Model($aÑä…É£˜†[1818])->where($B’«÷Íà¿¯)->save($d†‰šÉĞÊÀ); goto bÇêÎÕ³®; eæƒÉ·´š: foreach ($bæÊ–‰œ¯ as $Bï¾†£™ˆ‹) { $e ‹Ùê¶½å = $Bï¾†£™ˆ‹[$aÑä…É£˜†[404]] == $aÑä…É£˜†[87] ? REPEAT_RENAME_FOLDER : REPEAT_RENAME; Model($aÑä…É£˜†[808])->move($Bï¾†£™ˆ‹[$aÑä…É£˜†[396]], $Dãø³ÎËº¾, $e ‹Ùê¶½å); } Model($aÑä…É£˜†[808])->moveClearAuth = !0; $B’«÷Íà¿¯ = array($aÑä…É£˜†[405] => 2, $aÑä…É£˜†[485] => $c±’ÈÜ‰²õ); goto f™‡À”×÷Ø; Fš·ôĞñ«ö: $bæÊ–‰œ¯ = Model($aÑä…É£˜†[808])->where($B’«÷Íà¿¯)->field($aÑä…É£˜†[1816])->select(); if (!$bæÊ–‰œ¯) { $bæÊ–‰œ¯ = array(); } Model($aÑä…É£˜†[808])->moveClearAuth = !1; goto eæƒÉ·´š; fŒğ‚ÀÊ’’: if (!$bæÊ–‰œ¯[$B“¬±À©“š]) { $bæÊ–‰œ¯[$B“¬±À©“š] = Model($aÑä…É£˜†[808])->groupRootAdd($B“¬±À©“š); } $Dãø³ÎËº¾ = $bæÊ–‰œ¯[$B“¬±À©“š]; $B’«÷Íà¿¯ = array($aÑä…É£˜†[479] => $bÅ„àÂØ­Ü); goto Fš·ôĞñ«ö; bÇêÎÕ³®: } $this->_changeChildLevel($eğÛë’õ“¼[$c±’ÈÜ‰²õ], $eğÛë’õ“¼[$B“¬±À©“š], !0); goto DøíˆƒÚ¾; a²˜ïè’ÏŒ: $eğÛë’õ“¼ = array_to_keyvalue($eğÛë’õ“¼, $aÑä…É£˜†[1714]); if (!isset($eğÛë’õ“¼[$c±’ÈÜ‰²õ]) || !isset($eğÛë’õ“¼[$B“¬±À©“š]) || $eğÛë’õ“¼[$c±’ÈÜ‰²õ][$aÑä…É£˜†[479]] == 0) { return !1; } $B’«÷Íà¿¯ = array($aÑä…É£˜†[1714] => $c±’ÈÜ‰²õ); goto aâ¼¶†¬¢; DøíˆƒÚ¾: $this->where(array($aÑä…É£˜†[479] => $c±’ÈÜ‰²õ))->save(array($aÑä…É£˜†[479] => $B“¬±À©“š)); $this->_clearChildrenCache($eğÛë’õ“¼[$B“¬±À©“š]); return !0; goto bİö¸ìÒ®İ; bİö¸ìÒ®İ: } } class GroupTagModel extends ModelBase { protected $tableName = "\x75\163\x65\162\137\146\x61\166"; protected function cacheFunctionAlias($D­­„ë™ô‘) { $f¹£÷Ùàİ =& $_SERVER[ªúæÂ¡­ä½]; return array($f¹£÷Ùàİ[1819] => array($D­­„ë™ô‘[0], $f¹£÷Ùàİ[1820]), $f¹£÷Ùàİ[1821] => array($D­­„ë™ô‘[0], $f¹£÷Ùàİ[1822])); } protected function get($a®¯ØµÛ ) { $c­øÜë¼’‹ =& $_SERVER[ªúæÂ¡­ä½]; $F‘«ö×£§ = Model($c­øÜë¼’‹[504])->metaGet($a®¯ØµÛ , $c­øÜë¼’‹[1823]); $fË§ô·—Ç· = json_decode($F‘«ö×£§, !0); return $fË§ô·—Ç· ? $fË§ô·—Ç· : array($c­øÜë¼’‹[1824] => $c­øÜë¼’‹[87], $c­øÜë¼’‹[367] => array()); } protected function set($A¼ˆ¨¸”, $e“ÊÖ×ºá) { $E†Ä¢åø  =& $_SERVER[ªúæÂ¡­ä½]; $e“ÊÖ×ºá = $e“ÊÖ×ºá ? $e“ÊÖ×ºá : array($E†Ä¢åø [1824] => $E†Ä¢åø [87], $E†Ä¢åø [367] => array()); Model($E†Ä¢åø [504])->metaSet($A¼ˆ¨¸”, $E†Ä¢åø [1823], json_encode($e“ÊÖ×ºá)); return Model($E†Ä¢åø [504])->metaSet($A¼ˆ¨¸”, $E†Ä¢åø [1823], json_encode($e“ÊÖ×ºá)); } protected function getByTagID($e¤±ö†óÑ†, $E­‚†…Ñ£‹) { goto béøêâ¦ ì; d‹‰Œ¾Ş¬Ù: return is_array($BÎİæÃ¸°Û) ? $BÎİæÃ¸°Û : !1; goto döæË öç·; Eå¾‰: $c¢–˜Ö‡ğÂ = $this->get($e¤±ö†óÑ†); if (!$c¢–˜Ö‡ğÂ || !isset($c¢–˜Ö‡ğÂ[$DŞëåóˆÒ„[367]])) { return !1; } $BÎİæÃ¸°Û = array_find_by_field($c¢–˜Ö‡ğÂ[$DŞëåóˆÒ„[367]], $DŞëåóˆÒ„[394], $E­‚†…Ñ£‹); goto d‹‰Œ¾Ş¬Ù; béøêâ¦ ì: $DŞëåóˆÒ„ =& $_SERVER[ªúæÂ¡­ä½]; if (!$e¤±ö†óÑ† || !$E­‚†…Ñ£‹) { return !1; } if (!Model($DŞëåóˆÒ„[504])->getInfoSimple($e¤±ö†óÑ†)) { return !1; } goto Eå¾‰; döæË öç·: } public function listSource($D±˜‹Ï„”, $fÜéŞµê…ö) { goto C‚†ÑÇñÀ®; BÔÏ’‹ÜÖå: $Dà×ÅÂëÉ‡ = Model($dº¸í×·Š­[1221])->listSource($eÎ•Œ¬“); if (!$Dà×ÅÂëÉ‡ || count($Aˆ°Ó‚Úò–) == $Dà×ÅÂëÉ‡[$dº¸í×·Š­[364]][$dº¸í×·Š­[365]]) { return $Dà×ÅÂëÉ‡; } $B˜°Ï¼ÚëÙ = array(); goto EäÃ¾â²§¥; DÙ¾ÈÑÁ¯: $CÑ‰œŒ¦› = array(); foreach ($eó¶´ß’ğÏ as $EÜóêƒ·Ñ‹) { $c¬øëšÁ± = $EÜóêƒ·Ñ‹[$dº¸í×·Š­[76]]; if (!$c¬øëšÁ±) { continue; } if (!isset($CÑ‰œŒ¦›[$c¬øëšÁ±])) { $CÑ‰œŒ¦›[$c¬øëšÁ±] = array(); } $CÑ‰œŒ¦›[$c¬øëšÁ±][] = $EÜóêƒ·Ñ‹[$dº¸í×·Š­[420]]; } $Aˆ°Ó‚Úò– = array(); goto b©ÀÌ†Õè; b©ÀÌ†Õè: foreach ($CÑ‰œŒ¦› as $B«ÔãÄİ‹Ñ => $EëíåìÜ‰ì) { $CŒÙ±åØñ = !0; if (!$fÜéŞµê…ö) { $Aˆ°Ó‚Úò–[] = $B«ÔãÄİ‹Ñ; continue; } foreach ($fÜéŞµê…ö as $aùÅø¯óŠÇ) { if (!in_array($aùÅø¯óŠÇ, $EëíåìÜ‰ì)) { $CŒÙ±åØñ = !1; break; } } if ($CŒÙ±åØñ) { $Aˆ°Ó‚Úò–[] = $B«ÔãÄİ‹Ñ; } } if (!$Aˆ°Ó‚Úò–) { return array(); } $eÎ•Œ¬“ = array($dº¸í×·Š­[411] => array($dº¸í×·Š­[412], $Aˆ°Ó‚Úò–), $dº¸í×·Š­[485] => $D±˜‹Ï„”, $dº¸í×·Š­[405] => SourceModel::TYPE_GROUP); goto BÔÏ’‹ÜÖå; EäÃ¾â²§¥: $AµñªÑ„£ = array_to_keyvalue($Dà×ÅÂëÉ‡[$dº¸í×·Š­[75]], $dº¸í×·Š­[33], $dº¸í×·Š­[396]); $bŒÄ¥—Ñ’ƒ = array_to_keyvalue($Dà×ÅÂëÉ‡[$dº¸í×·Š­[74]], $dº¸í×·Š­[33], $dº¸í×·Š­[396]); $a‹°»¯ğ½ = array_merge($bŒÄ¥—Ñ’ƒ, $AµñªÑ„£); goto A¡Ÿ•‚ĞË; A¡Ÿ•‚ĞË: foreach ($Aˆ°Ó‚Úò– as $c¬øëšÁ±) { if (!in_array($c¬øëšÁ±, $a‹°»¯ğ½)) { $B˜°Ï¼ÚëÙ[] = $c¬øëšÁ±; } } if ($B˜°Ï¼ÚëÙ) { $this->removeBySource($D±˜‹Ï„”, $B˜°Ï¼ÚëÙ); } return $Dà×ÅÂëÉ‡; goto DÊìô¤×Ô; C‚†ÑÇñÀ®: $dº¸í×·Š­ =& $_SERVER[ªúæÂ¡­ä½]; if ($fÜéŞµê…ö && !is_array($fÜéŞµê…ö)) { $fÜéŞµê…ö = array($fÜéŞµê…ö); } $eó¶´ß’ğÏ = $this->listData($D±˜‹Ï„”); goto DÙ¾ÈÑÁ¯; DÊìô¤×Ô: } protected function listData($A¥„ˆˆé) { $D¶àƒŞ¡³µ =& $_SERVER[ªúæÂ¡­ä½]; $Eô·ÖÉ…ÊÎ = array($D¶àƒŞ¡³µ[1536] => 0, $D¶àƒŞ¡³µ[464] => array($D¶àƒŞ¡³µ[1825], 0), $D¶àƒŞ¡³µ[416] => $D¶àƒŞ¡³µ[1826] . $A¥„ˆˆé); $C”®Úêãí‚ = $D¶àƒŞ¡³µ[1827]; $AÜš…Ûšì = $this->field($C”®Úêãí‚)->where($Eô·ÖÉ…ÊÎ)->order($D¶àƒŞ¡³µ[1828])->select(); return $AÜš…Ûšì ? $AÜš…Ûšì : array(); } protected function addToTag($d£Êé±Û·õ, $fùÑ‚Çæôì, $E«Î”‡ª—›) { $A§ˆÒ½‚— =& $_SERVER[ªúæÂ¡­ä½]; if (!$this->getByTagID($d£Êé±Û·õ, $E«Î”‡ª—›) || !$fùÑ‚Çæôì) { return !1; } if (!Model($A§ˆÒ½‚—[808])->pathInfo($fùÑ‚Çæôì)) { return !1; } $C‰ã‘¦”½ˆ = array($A§ˆÒ½‚—[1536] => 0, $A§ˆÒ½‚—[464] => $E«Î”‡ª—›, $A§ˆÒ½‚—[415] => $fùÑ‚Çæôì, $A§ˆÒ½‚—[416] => $A§ˆÒ½‚—[1829] . $d£Êé±Û·õ, $A§ˆÒ½‚—[414] => $A§ˆÒ½‚—[33], $A§ˆÒ½‚—[1718] => 0); if ($this->where($C‰ã‘¦”½ˆ)->find()) { return !1; } return $this->add($C‰ã‘¦”½ˆ); } protected function removeFromTag($CÅöï”õŒ™, $a¾Ïˆ¡âÎ, $a™¶»Ë½íŒ) { $d­¸äŸºå =& $_SERVER[ªúæÂ¡­ä½]; if (!$this->getByTagID($CÅöï”õŒ™, $a™¶»Ë½íŒ) || !$a¾Ïˆ¡âÎ) { return !1; } if (is_array($a¾Ïˆ¡âÎ)) { $a¾Ïˆ¡âÎ = array($d­¸äŸºå[7], $a¾Ïˆ¡âÎ); } $dË¢­ÂîÌ = array($d­¸äŸºå[1536] => 0, $d­¸äŸºå[464] => $a™¶»Ë½íŒ, $d­¸äŸºå[416] => $d­¸äŸºå[1829] . $CÅöï”õŒ™, $d­¸äŸºå[415] => $a¾Ïˆ¡âÎ); return $this->where($dË¢­ÂîÌ)->delete(); } protected function removeByTag($d˜¹‡Éá™é, $fÕ‡ùß»§) { $DËæó‹™÷í =& $_SERVER[ªúæÂ¡­ä½]; if (!$this->getByTagID($d˜¹‡Éá™é, $fÕ‡ùß»§)) { return !1; } $fæ°Ñ®‰ = array($DËæó‹™÷í[1536] => 0, $DËæó‹™÷í[464] => $fÕ‡ùß»§, $DËæó‹™÷í[416] => $DËæó‹™÷í[1829] . $d˜¹‡Éá™é); return $this->where($fæ°Ñ®‰)->delete(); } protected function removeBySource($Fê£®¤ ×™, $Dœ×‘à­½) { $BàÁÄ”åøğ =& $_SERVER[ªúæÂ¡­ä½]; if (!$Fê£®¤ ×™ || !$Dœ×‘à­½) { return !1; } if (is_array($Dœ×‘à­½)) { $Dœ×‘à­½ = array($BàÁÄ”åøğ[7], $Dœ×‘à­½); } $EÂ½ÀŞÅåÄ = array($BàÁÄ”åøğ[1536] => 0, $BàÁÄ”åøğ[415] => $Dœ×‘à­½, $BàÁÄ”åøğ[464] => array($BàÁÄ”åøğ[988], 0), $BàÁÄ”åøğ[416] => $BàÁÄ”åøğ[1829] . $Fê£®¤ ×™); return $this->where($EÂ½ÀŞÅåÄ)->delete(); } } class PluginModel extends ModelBaseLight { public $optionType = "\123\x79\163\164\x65\x6d\56\160\x6c\165\147\x69\156\x4c\x69\163\164"; public $field = array("\156\x61\x6d\x65", "\x73\x74\x61\x74\x75\x73", "\162\x65\x67\x69\x65\x73\164", "\x63\x6f\156\146\151\x67"); public function loadList($Fà°â Ã²ª = false) { $aÑ›ˆ «Û = array_to_keyvalue($this->listData(), $_SERVER[ªúæÂ¡­ä½][28]); if ($Fà°â Ã²ª) { return $aÑ›ˆ «Û[$Fà°â Ã²ª]; } return $aÑ›ˆ «Û; } public function init() { $f–è‰ÄšÖÚ =& $_SERVER[ªúæÂ¡­ä½]; Hook::trigger($f–è‰ÄšÖÚ[1830]); $c”ì§„Ñ˜¬ = $this->loadPluginList(); foreach ($c”ì§„Ñ˜¬ as $bäğâõÜÎ× => $c Æ‚”è¥ª) { $c¶‹ÅŠğÏØ = $this->appAllow($bäğâõÜÎ×, $c Æ‚”è¥ª); if (!$c¶‹ÅŠğÏØ) { continue; } foreach ($c Æ‚”è¥ª[$f–è‰ÄšÖÚ[1831]] as $E²ñî›ï => $c…õßÚÙµ¹) { Hook::bind($E²ñî›ï, $c…õßÚÙµ¹); } } Hook::trigger($f–è‰ÄšÖÚ[1832]); Hook::trigger(ACTION); } public function appAllow($aì¯ÏŒçõÈ, $DÕ¬”ÆÄù•, $BÌ­ŠÌº¹ª = true) { $FÅ­´¬°Ë° =& $_SERVER[ªúæÂ¡­ä½]; $fÔ—æ±­‘œ = PLUGIN_DIR . $aì¯ÏŒçõÈ . $FÅ­´¬°Ë°[1833]; if (!is_array($DÕ¬”ÆÄù•) || !is_array($DÕ¬”ÆÄù•[$FÅ­´¬°Ë°[1831]]) || $DÕ¬”ÆÄù•[$FÅ­´¬°Ë°[728]] != 1 || !is_file($fÔ—æ±­‘œ)) { return !1; } if ($GLOBALS[$FÅ­´¬°Ë°[486]] == 1) { return !0; } if ($BÌ­ŠÌº¹ª && !Action($FÅ­´¬°Ë°[1834])->checkAuth($aì¯ÏŒçõÈ)) { return !1; } return !0; } public function unInstall($CÀó„Ü—ˆ°) { $bÂ¤Ş†ËÊè =& $_SERVER[ªúæÂ¡­ä½]; $d²ç…¶»ö¢ = $this->loadList($CÀó„Ü—ˆ°); if (file_exists(PLUGIN_DIR . $CÀó„Ü—ˆ°)) { Hook::apply($CÀó„Ü—ˆ° . $bÂ¤Ş†ËÊè[1835]); } $this->remove($d²ç…¶»ö¢[$bÂ¤Ş†ËÊè[394]]); } public function changeStatus($Dœ§ÑĞ‹•é, $dëÕ‡÷ŠÆ) { $Aå¢ÄÛªŠ™ =& $_SERVER[ªúæÂ¡­ä½]; $FÌÆ’‘˜’ = $this->loadList($Dœ§ÑĞ‹•é); if ($dëÕ‡÷ŠÆ) { Hook::apply($Dœ§ÑĞ‹•é . $Aå¢ÄÛªŠ™[1836]); } $this->update($FÌÆ’‘˜’[$Aå¢ÄÛªŠ™[394]], array($Aå¢ÄÛªŠ™[1837] => $dëÕ‡÷ŠÆ)); } public function appRegist($BéŞ¦…Ñ¢Ÿ, $eÕ©Ì¶ˆ¬æ) { $b‚¡ËÅˆ =& $_SERVER[ªúæÂ¡­ä½]; $fœÚ’éÔ‰Ê = $this->loadList($BéŞ¦…Ñ¢Ÿ); if ($fœÚ’éÔ‰Ê) { $this->update($fœÚ’éÔ‰Ê[$b‚¡ËÅˆ[394]], array($b‚¡ËÅˆ[1831] => $eÕ©Ì¶ˆ¬æ)); } else { $Cï«–ìçŒÚ = array($b‚¡ËÅˆ[28] => $BéŞ¦…Ñ¢Ÿ, $b‚¡ËÅˆ[1831] => $eÕ©Ì¶ˆ¬æ, $b‚¡ËÅˆ[728] => 0, $b‚¡ËÅˆ[6] => $this->getConfigDefault($BéŞ¦…Ñ¢Ÿ)); $this->insert($Cï«–ìçŒÚ); } } public function getConfigDefault($aêìÀóÚØê) { $Eçùò®¤É¢ =& $_SERVER[ªúæÂ¡­ä½]; $d¿ƒ¼°ïƒ„ = array(); $fÊÑë¶Öù = $this->getPackageJson($aêìÀóÚØê); if (!$fÊÑë¶Öù && is_array($fÊÑë¶Öù[$Eçùò®¤É¢[1838]])) { return $d¿ƒ¼°ïƒ„; } foreach ($fÊÑë¶Öù[$Eçùò®¤É¢[1838]] as $Aï÷™© => $c°É¤´ë§“) { if (!isset($c°É¤´ë§“[$Eçùò®¤É¢[372]]) || isset($d¿ƒ¼°ïƒ„[$Aï÷™©])) { continue; } $d¿ƒ¼°ïƒ„[$Aï÷™©] = $c°É¤´ë§“[$Eçùò®¤É¢[372]]; } return $d¿ƒ¼°ïƒ„; } public function getPackageJson($cÖ¾ƒò“¬¼) { return Hook::apply($cÖ¾ƒò“¬¼ . $_SERVER[ªúæÂ¡­ä½][1839]); } public function getConfig($e º§’‹ê¨, $Eª’¸ãµˆ = false) { $aËÉÕ¥è”÷ =& $_SERVER[ªúæÂ¡­ä½]; $F™Õ¾øš¡à = array(); $Aê¶ô”‚ÉÈ = $this->loadList($e º§’‹ê¨); if ($Aê¶ô”‚ÉÈ && is_array($Aê¶ô”‚ÉÈ[$aËÉÕ¥è”÷[6]])) { $F™Õ¾øš¡à = $Aê¶ô”‚ÉÈ[$aËÉÕ¥è”÷[6]]; } if (!$F™Õ¾øš¡à || $Eª’¸ãµˆ) { $F™Õ¾øš¡à = $this->getConfigDefault($e º§’‹ê¨); } return $F™Õ¾øš¡à; } public function setConfig($FÚ¡Ÿñ, $AµÓ§Ğ˜‡ = false) { goto BÄòÄˆçœ¢; bªñÏÜšæ: $this->update($có•ë‰àù÷[$D”‚Ê”»õà[394]], array($D”‚Ê”»õà[6] => $F­®¼Õô÷‘)); goto C§­†Ô¼§ö; BÄòÄˆçœ¢: $D”‚Ê”»õà =& $_SERVER[ªúæÂ¡­ä½]; $có•ë‰àù÷ = $this->loadList($FÚ¡Ÿñ); if (!$có•ë‰àù÷) { return !1; } goto cãùîê¯¸; cãùîê¯¸: $F­®¼Õô÷‘ = $có•ë‰àù÷[$D”‚Ê”»õà[6]]; if ($AµÓ§Ğ˜‡ == !1) { $F­®¼Õô÷‘ = array(); $AµÓ§Ğ˜‡ = $this->getConfigDefault($FÚ¡Ÿñ); } foreach ($AµÓ§Ğ˜‡ as $d‹øÚáÜƒî => $bÅ‘†Ë“Ï‡) { $F­®¼Õô÷‘[$d‹øÚáÜƒî] = is_string($bÅ‘†Ë“Ï‡) ? trim($bÅ‘†Ë“Ï‡) : $bÅ‘†Ë“Ï‡; } goto bªñÏÜšæ; C§­†Ô¼§ö: } public function viewList() { goto Dß²è¡ƒ‰Ö; bùñ®ÀÕùë: $dË–İ‹¯¤ = $this->loadPluginList(); $BğáÙ‚åÎ = array(); foreach ($dË–İ‹¯¤ as $E‹ó¿Ÿöí => $e˜©±È£âÈ) { unset($e˜©±È£âÈ[$B÷„ñÒ¬™İ[1831]], $e˜©±È£âÈ[$B÷„ñÒ¬™İ[6]]); $AÊ²™­ˆ = PLUGIN_DIR . $e˜©±È£âÈ[$B÷„ñÒ¬™İ[28]] . $B÷„ñÒ¬™İ[1833]; if (!is_file($AÊ²™­ˆ)) { continue; } $BãÓ¬À©¯ê = Hook::apply($e˜©±È£âÈ[$B÷„ñÒ¬™İ[28]] . $B÷„ñÒ¬™İ[1839]); if (is_array($BãÓ¬À©¯ê)) { $BğáÙ‚åÎ[$E‹ó¿Ÿöí] = array_merge($e˜©±È£âÈ, $BãÓ¬À©¯ê); } } goto B¯œ¶í¬œ›; Dß²è¡ƒ‰Ö: $B÷„ñÒ¬™İ =& $_SERVER[ªúæÂ¡­ä½]; $dË–İ‹¯¤ = $this->loadList(); $this->pluginScan($dË–İ‹¯¤); goto bùñ®ÀÕùë; B¯œ¶í¬œ›: return $BğáÙ‚åÎ; goto eôœ¼†İŸâ; eôœ¼†İŸâ: } private function loadPluginList() { $B²®Õùöø¹ =& $_SERVER[ªúæÂ¡­ä½]; $D¥µÜãÏ¥é = $this->loadList(); if (strtolower(MOD) == $B²®Õùöø¹[1840]) { return $D¥µÜãÏ¥é; } $F®âğĞÓÚ© = Hook::trigger($B²®Õùöø¹[1841], $D¥µÜãÏ¥é); if ($D¥µÜãÏ¥é && !$F®âğĞÓÚ©) { die; } return $F®âğĞÓÚ© ? $F®âğĞÓÚ© : $D¥µÜãÏ¥é; } private function pluginScan($bˆæ°À„ƒ÷) { $cñ¦„Œß® =& $_SERVER[ªúæÂ¡­ä½]; recursion_dir(PLUGIN_DIR, $Bô¹™ØĞ¾Á, $aº–í‘¯‹, 0); foreach ($Bô¹™ØĞ¾Á as $fÑÇ†•Óõ˜) { $eÔßƒ¼·ëÀ = get_path_this($fÑÇ†•Óõ˜); if (isset($bˆæ°À„ƒ÷[$eÔßƒ¼·ëÀ]) || !file_exists($fÑÇ†•Óõ˜ . $cñ¦„Œß®[1842]) || !file_exists($fÑÇ†•Óõ˜ . $cñ¦„Œß®[1833])) { continue; } Hook::apply($eÔßƒ¼·ëÀ . $cñ¦„Œß®[1836]); } } } goto eå‘›•‚; Aò„ËŒÍ: class UserOptionModel extends ModelBaseOption { protected $tableName = "\x75\163\145\162\137\x6f\160\x74\151\157\x6e"; protected $jsonField = array(); function __construct() { parent::__construct(); } protected function cacheKey($Aíó»Ğ ¢±) { $dÊ­ĞÁèÚ =& $_SERVER[ªúæÂ¡­ä½]; if (!defined($dÊ­ĞÁèÚ[455])) { define($dÊ­ĞÁèÚ[455], 0); } return "\x55\163\145\x72\117\160\164\x69\x6f\x6e\x5f{$Aíó»Ğ ¢±}\x5f" . USER_ID; } protected function filterWhere($Fˆé‰Ì‹Øô) { $CøÂµ×Ş½ =& $_SERVER[ªúæÂ¡­ä½]; if (!defined($CøÂµ×Ş½[455])) { define($CøÂµ×Ş½[455], 0); } $Fˆé‰Ì‹Øô[$CøÂµ×Ş½[1545]] = USER_ID; return $Fˆé‰Ì‹Øô; } public function cacheRemoveUser($dĞÓæ¹³«, $c«’³¡) { return Cache::remove("\125\163\145\x72\x4f\160\x74\x69\x6f\x6e\x5f{$dĞÓæ¹³«}\x5f" . $c«’³¡); } protected function optionDefault($bœÃ»ÍËß× = '') { $AŞœ´îó‘ =& $_SERVER[ªúæÂ¡­ä½]; if ($bœÃ»ÍËß× == $AŞœ´îó‘[33]) { return $GLOBALS[$AŞœ´îó‘[6]][$AŞœ´îó‘[2188]]; } if ($bœÃ»ÍËß× == $AŞœ´îó‘[2189]) { return $GLOBALS[$AŞœ´îó‘[6]][$AŞœ´îó‘[2190]]; } } } class UserTagModel extends ModelBaseLight { public $optionType = "\125\163\145\162\56\164\x61\x67\x4c\x69\x73\x74"; public $modelType = "\x55\163\x65\162\x4f\160\164\x69\157\x6e"; public $field = array("\x6e\141\155\145", "\163\x74\x79\x6c\145", "\163\157\x72\x74"); public function listData($aÜ°Òñ¢Ì = false, $Böˆ«Õîàó = "\x73\157\162\164", $déğùÅçˆ = false) { return parent::listData($aÜ°Òñ¢Ì, $Böˆ«Õîàó, $déğùÅçˆ); } public function remove($B¾ëÉÕÄÑ) { return parent::remove($B¾ëÉÕÄÑ); } public function add($EäÖ¹¹ÜÍÔ, $DõÉ –‘ï = "\154\141\x62\x65\x6c\x2d\147\x72\145\171\x2d\x6e\157\x72\155\141\x6c") { $cÛƒñùøÚÍ =& $_SERVER[ªúæÂ¡­ä½]; if ($this->findByName($EäÖ¹¹ÜÍÔ)) { return !1; } $f¡İÂ¦Å÷ = array($cÛƒñùøÚÍ[414] => $EäÖ¹¹ÜÍÔ, $cÛƒñùøÚÍ[465] => $DõÉ –‘ï, $cÛƒñùøÚÍ[1718] => $this->getSort($cÛƒñùøÚÍ[256]) + 1); return parent::insert($f¡İÂ¦Å÷); } public function update($c…ôËä¤¦Ó, $DÄ›çô®†¥) { $E¼²È§Ÿ‹ =& $_SERVER[ªúæÂ¡­ä½]; $a…æ°¹Ğ½¹ = $this->listData($c…ôËä¤¦Ó); $EšÏŠ£Æø› = $this->findByName($DÄ›çô®†¥[$E¼²È§Ÿ‹[28]]); if (!$a…æ°¹Ğ½¹ || $EšÏŠ£Æø› && $EšÏŠ£Æø›[$E¼²È§Ÿ‹[394]] != $a…æ°¹Ğ½¹[$E¼²È§Ÿ‹[394]]) { return !1; } return parent::update($c…ôËä¤¦Ó, $DÄ›çô®†¥); } public function moveTop($FçĞ¦Ñ¨Æ) { $céš´·ÜÃ =& $_SERVER[ªúæÂ¡­ä½]; $AÆÀÑâ®¼ = parent::listData(); $E¥˜æïö¨ = $this->getSort($céš´·ÜÃ[255]); foreach ($AÆÀÑâ®¼ as &$dïà©öê›) { if ($dïà©öê›[$céš´·ÜÃ[394]] == $FçĞ¦Ñ¨Æ) { $dïà©öê›[$céš´·ÜÃ[1737]] = $E¥˜æïö¨; continue; } $dïà©öê›[$céš´·ÜÃ[1737]] += 1; } unset($dïà©öê›); return parent::resetData($AÆÀÑâ®¼); } public function moveBottom($BéÈìäÅÖ¸) { $FÍ’Åöˆì =& $_SERVER[ªúæÂ¡­ä½]; $B ¶„êÖä… = $this->getSort($FÍ’Åöˆì[256]) + 1; return parent::update($BéÈìäÅÖ¸, array($FÍ’Åöˆì[1737] => $B ¶„êÖä…)); } public function resetSort($a…¯º˜Ğ¦) { goto a™¨°ÔÚ¾¦; a™¨°ÔÚ¾¦: $BÛìÛŒÆÇŞ =& $_SERVER[ªúæÂ¡­ä½]; $bõÆÙ«Üã = array(); $a…¯º˜Ğ¦ = is_array($a…¯º˜Ğ¦) ? $a…¯º˜Ğ¦ : array(); goto F”ĞÎ˜…ÃÀ; F”ĞÎ˜…ÃÀ: for ($a£­ùÆï¿· = 0; $a£­ùÆï¿· < count($a…¯º˜Ğ¦); $a£­ùÆï¿·++) { $bõÆÙ«Üã[$a…¯º˜Ğ¦[$a£­ùÆï¿·] . $BÛìÛŒÆÇŞ[33]] = $a£­ùÆï¿· + 1; } $cÂë»Ÿ¤Ôœ = parent::listData(); foreach ($cÂë»Ÿ¤Ôœ as &$F‘…³›‚) { $dÊğñºì“Š = $bõÆÙ«Üã[$F‘…³›‚[$BÛìÛŒÆÇŞ[394]]]; $F‘…³›‚[$BÛìÛŒÆÇŞ[1737]] = $dÊğñºì“Š ? $dÊğñºì“Š : $F‘…³›‚[$BÛìÛŒÆÇŞ[1737]]; } goto d¯Úİä´‡™; d¯Úİä´‡™: unset($F‘…³›‚); return parent::resetData($cÂë»Ÿ¤Ôœ); goto A°‹ˆ«‘Á•; A°‹ˆ«‘Á•: } private function getSort($e®‹÷Ç¦‘ƒ) { $c…È…Ë—ÂŒ =& $_SERVER[ªúæÂ¡­ä½]; $eç¼ù‹ººˆ = parent::listData(); $bÅ¨¾ˆÌŠ = array_to_keyvalue($eç¼ù‹ººˆ, $c…È…Ë—ÂŒ[33], $c…È…Ë—ÂŒ[1737]); if (!$bÅ¨¾ˆÌŠ) { $bÅ¨¾ˆÌŠ = array(0); } $díè…ˆƒĞà = $e®‹÷Ç¦‘ƒ == $c…È…Ë—ÂŒ[256] ? max($bÅ¨¾ˆÌŠ) : min($bÅ¨¾ˆÌŠ); return intval($díè…ˆƒĞà); } } goto AÜè›Á•ª; bÁÑ¤Ç†õİ: class SystemRecordModel extends ModelBaseLight { } class SystemRoleModel extends ModelBaseLight { public $optionType = "\x53\171\163\x74\145\155\56\x72\157\x6c\x65\x4c\151\x73\164"; public $field = array("\156\x61\x6d\x65", "\x61\165\164\x68", "\154\x61\x62\x65\x6c", "\x64\x69\x73\160\x6c\x61\x79", "\x73\171\x73\164\145\155", "\x64\145\163\x63", "\151\147\x6e\157\162\x65\105\x78\164", "\151\147\x6e\157\x72\145\106\151\x6c\x65\x53\151\x7a\x65", "\x61\x64\155\151\x6e\151\x73\164\x72\141\x74\157\x72", "\x73\x6f\162\x74"); public function listData($EÀ§¸ë²İ‰ = false, $C…Õ„ğöÈœ = "\163\x6f\162\x74", $FíÓ«„ìµÜ = false) { $DÔÅ½ÄŠ¿´ =& $_SERVER[ªúæÂ¡­ä½]; $A«‹ÅùŠÅ“ = parent::listData($EÀ§¸ë²İ‰, $C…Õ„ğöÈœ, $FíÓ«„ìµÜ); if (!$EÀ§¸ë²İ‰) { foreach ($A«‹ÅùŠÅ“ as $CÎ¿‘«Æ™Ì => $D¶Ÿ²…¬ª‘) { if ($D¶Ÿ²…¬ª‘[$DÔÅ½ÄŠ¿´[1907]] == 1) { $A«‹ÅùŠÅ“[$CÎ¿‘«Æ™Ì][$DÔÅ½ÄŠ¿´[432]] = LNG($DÔÅ½ÄŠ¿´[2133]); } } } return $A«‹ÅùŠÅ“; } public function update($bßšˆÙ†…, $fà‹İèØêÄ) { goto B·÷éöŸ§; B·÷éöŸ§: $B†ºÑ±±° =& $_SERVER[ªúæÂ¡­ä½]; $Fœ¡ñù˜õ = parent::listData($bßšˆÙ†…); $dö˜‰Ó‰Ü™ = $this->findByName($fà‹İèØêÄ[$B†ºÑ±±°[28]]); goto c££äÈÙó; c££äÈÙó: if (!$Fœ¡ñù˜õ || $dö˜‰Ó‰Ü™ && $dö˜‰Ó‰Ü™[$B†ºÑ±±°[394]] != $Fœ¡ñù˜õ[$B†ºÑ±±°[394]]) { return !1; } if ($dö˜‰Ó‰Ü™[$B†ºÑ±±°[1907]] == 1) { $fà‹İèØêÄ = array($B†ºÑ±±°[28] => $fà‹İèØêÄ[$B†ºÑ±±°[28]], $B†ºÑ±±°[1736] => $fà‹İèØêÄ[$B†ºÑ±±°[1736]]); } $this->filterAuth($fà‹İèØêÄ[$B†ºÑ±±°[407]]); goto E®Ã˜‘ÜÀ¯; E®Ã˜‘ÜÀ¯: return parent::update($bßšˆÙ†…, $fà‹İèØêÄ); goto eÀö¡¢Ø„Ò; eÀö¡¢Ø„Ò: } public function remove($aŠùÌ©åÂ) { $F†¶ÆÉ²¹‘ = parent::listData($aŠùÌ©åÂ); if (!$F†¶ÆÉ²¹‘ || $F†¶ÆÉ²¹‘[$_SERVER[ªúæÂ¡­ä½][1186]]) { return !1; } return parent::remove($aŠùÌ©åÂ); } public function add($DÉëÜÑ«À¬) { goto fÖŠ˜„ˆˆÒ; fÖŠ˜„ˆˆÒ: $e…¤«Ûƒ•­ =& $_SERVER[ªúæÂ¡­ä½]; $Dï ¸‡°â¼ = $DÉëÜÑ«À¬[$e…¤«Ûƒ•­[28]]; if ($this->findByName($Dï ¸‡°â¼)) { return !1; } goto Aøë”‰ˆ¼‹; F˜ã°–: return parent::insert($DÉëÜÑ«À¬); goto B¼ø¾–š¼ê; Aøë”‰ˆ¼‹: $CèØ×Õ­Î = array($e…¤«Ûƒ•­[414] => $Dï ¸‡°â¼, $e…¤«Ûƒ•­[1720] => $e…¤«Ûƒ•­[33], $e…¤«Ûƒ•­[1716] => $e…¤«Ûƒ•­[1724], $e…¤«Ûƒ•­[2134] => 1, $e…¤«Ûƒ•­[1719] => 0, $e…¤«Ûƒ•­[2135] => 0, $e…¤«Ûƒ•­[1718] => $this->getSort()); $DÉëÜÑ«À¬ = array_merge($CèØ×Õ­Î, $DÉëÜÑ«À¬); $this->filterAuth($DÉëÜÑ«À¬[$e…¤«Ûƒ•­[407]]); goto F˜ã°–; B¼ø¾–š¼ê: } private function getSort() { $AÑ¬Ã¹Æ¦ =& $_SERVER[ªúæÂ¡­ä½]; $b»´Ú¥ÓÒè = parent::listData(); $CàŠù–¼àö = array_to_keyvalue($b»´Ú¥ÓÒè, $AÑ¬Ã¹Æ¦[33], $AÑ¬Ã¹Æ¦[1737]); return empty($CàŠù–¼àö) ? 0 : max($CàŠù–¼àö) + 1; } private function filterAuth(&$E‚ßè×–ã) { $bÀíÃ£ÃÅ =& $_SERVER[ªúæÂ¡­ä½]; $d¼Ö¼ì°Á = array(); $fÌô ±¼•½ = array_filter(explode($bÀíÃ£ÃÅ[47], $E‚ßè×–ã)); foreach ($fÌô ±¼•½ as $E‚ßè×–ã) { $e‰Ó£¿Û’ = explode($bÀíÃ£ÃÅ[95], $E‚ßè×–ã); if ($e‰Ó£¿Û’[0] == $bÀíÃ£ÃÅ[2136] && $e‰Ó£¿Û’[1] != $bÀíÃ£ÃÅ[1105]) { $B®…¸÷‡‡¢ = $e‰Ó£¿Û’[0] . $bÀíÃ£ÃÅ[95] . $e‰Ó£¿Û’[1] . $bÀíÃ£ÃÅ[2137]; if (!in_array($B®…¸÷‡‡¢, $fÌô ±¼•½)) { $d¼Ö¼ì°Á[] = $B®…¸÷‡‡¢; } } $d¼Ö¼ì°Á[] = $E‚ßè×–ã; } $E‚ßè×–ã = implode($bÀíÃ£ÃÅ[47], $d¼Ö¼ì°Á); } public function sort($C„ÏÂˆ½ïŒ, $a×ä±‹…„’) { return parent::update($C„ÏÂˆ½ïŒ, $a×ä±‹…„’); } } class SystemTaskModel extends ModelBaseLight { public $optionType = "\123\x79\163\164\x65\155\56\x74\x61\163\x6b\x4c\151\163\164"; public $field = array("\x6e\x61\x6d\145", "\x74\x79\x70\x65", "\x65\x76\x65\156\x74", "\164\x69\155\x65", "\x64\x65\163\143", "\x73\x79\163\x74\x65\x6d", "\145\156\141\x62\x6c\145", "\x6c\141\163\164\122\165\156", "\x73\157\162\164"); public function listData($eÙÎóáÁ²Ï = false, $CªŒ‚ÕËìª = "\163\x6f\x72\x74", $dã‡†¬´ø™ = false) { return parent::listData($eÙÎóáÁ²Ï, $CªŒ‚ÕËìª, $dã‡†¬´ø™); } public function add($fŒ¶ğÉ²¶¼) { $cØ†¾®ô¥ =& $_SERVER[ªúæÂ¡­ä½]; $eŠŒ¨¯æÒ‹ = $this->findByName($fŒ¶ğÉ²¶¼[$cØ†¾®ô¥[28]]); if ($eŠŒ¨¯æÒ‹) { return !1; } $fŒ¶ğÉ²¶¼[$cØ†¾®ô¥[1509]] = 0; $fŒ¶ğÉ²¶¼[$cØ†¾®ô¥[1737]] = $this->getSort(); return parent::insert($fŒ¶ğÉ²¶¼); } private function getSort() { $Dáê°òÆë =& $_SERVER[ªúæÂ¡­ä½]; $E„ğÀæ¥ˆÀ = parent::listData(); $DÑãÆˆÑÜ = array_to_keyvalue($E„ğÀæ¥ˆÀ, $Dáê°òÆë[33], $Dáê°òÆë[1737]); return empty($DÑãÆˆÑÜ) ? 0 : max($DÑãÆˆÑÜ) + 1; } public function update($E‘İ„¨ïø, $b¤Œ™Á„“¸) { $D­ëî’³‘œ =& $_SERVER[ªúæÂ¡­ä½]; $A–Š¶š‰äë = $this->listData($E‘İ„¨ïø); $AÁ§½Ë›ò = $this->findByName($b¤Œ™Á„“¸[$D­ëî’³‘œ[28]]); if (!$A–Š¶š‰äë || $AÁ§½Ë›ò && $AÁ§½Ë›ò[$D­ëî’³‘œ[394]] != $A–Š¶š‰äë[$D­ëî’³‘œ[394]]) { return !1; } return parent::update($E‘İ„¨ïø, $b¤Œ™Á„“¸); } public function remove($AÃÆ‰ŒˆÓô, $D«Ùìó—ƒç = false) { $cï‚¶Ï´  =& $_SERVER[ªúæÂ¡­ä½]; $A‡‰‰•îçÆ = $this->listData($AÃÆ‰ŒˆÓô); if (!$A‡‰‰•îçÆ) { return; } if (!$D«Ùìó—ƒç && $A‡‰‰•îçÆ[$cï‚¶Ï´ [1186]] == $cï‚¶Ï´ [87]) { return !1; } return parent::remove($AÃÆ‰ŒˆÓô); } public function enable($c–²È©…µ, $CáÄóÄİ) { return $this->update($c–²È©…µ, array($_SERVER[ªúæÂ¡­ä½][2128] => $CáÄóÄİ)); } public function run($a•ŠõÛïÆ) { return $this->update($a•ŠõÛïÆ, array($_SERVER[ªúæÂ¡­ä½][2138] => time())); } } goto aÒ‡¤íÍŠ„; d”¢ÛëÖ—: class Session { public static $sessionTime; public static $sessionSign; public static $handle; public static $data; public static function init() { goto Cİé¾ç‰Óø; DîâŸŞ–Ç¸: if (self::$sessionSign) { } else { if (Cookie::get($Aƒß§‰‡‰)) { self::$sessionSign = Cookie::get($Aƒß§‰‡‰); } else { self::$sessionSign = guid(); } } Cookie::setSafe($Aƒß§‰‡‰, self::$sessionSign, self::$sessionTime); $Eå†¶ÊÆ…Æ = $aîÕèÔ†’½[$EïšäŸ¤™ƒ[1506]]; goto f¡¤ÙĞñšÚ; eºÏ¹ÚŒŸÛ: if (!self::$data) { CacheLock::lock(self::$sessionSign); self::$data = self::$handle->get(self::$sessionSign); CacheLock::unlock(self::$sessionSign); self::$data = unserialize(self::$data); if (!is_array(self::$data)) { self::$data = array(); } } $cÔŒß§µ»Û = new self(); return $cÔŒß§µ»Û; goto bÍÇİˆº¹; f¡¤ÙĞñšÚ: $EÄ»‚ää¬‚ = $aîÕèÔ†’½[$Eå†¶ÊÆ…Æ]; $bÛ¬‚ù°ŠĞ = $aîÕèÔ†’½[$EïšäŸ¤™ƒ[811]]; switch ($Eå†¶ÊÆ…Æ) { case $EïšäŸ¤™ƒ[17]: self::$handle = Model($EïšäŸ¤™ƒ[812]); break; case $EïšäŸ¤™ƒ[813]: self::$handle = new CacheRedis($EÄ»‚ää¬‚, $bÛ¬‚ù°ŠĞ); break; case $EïšäŸ¤™ƒ[814]: self::$handle = new CacheMemcached($EÄ»‚ää¬‚, $bÛ¬‚ù°ŠĞ); break; case $EïšäŸ¤™ƒ[193]: $EÄ»‚ää¬‚[$EïšäŸ¤™ƒ[76]] = $EÄ»‚ää¬‚[$EïšäŸ¤™ƒ[76]] . $EïšäŸ¤™ƒ[1507]; self::$handle = new CacheFile($EÄ»‚ää¬‚, $bÛ¬‚ù°ŠĞ); default: break; } goto eºÏ¹ÚŒŸÛ; Cİé¾ç‰Óø: $EïšäŸ¤™ƒ =& $_SERVER[ªúæÂ¡­ä½]; static $cÔŒß§µ»Û = false; if ($cÔŒß§µ»Û) { return $cÔŒß§µ»Û; } goto DˆÌóÅÊŞ­; DˆÌóÅÊŞ­: $aîÕèÔ†’½ = $GLOBALS[$EïšäŸ¤™ƒ[6]][$EïšäŸ¤™ƒ[347]]; self::$sessionTime = $aîÕèÔ†’½[$EïšäŸ¤™ƒ[1504]]; $Aƒß§‰‡‰ = isset($GLOBALS[$EïšäŸ¤™ƒ[1505]]) ? $GLOBALS[$EïšäŸ¤™ƒ[1505]] : SESSION_ID; goto DîâŸŞ–Ç¸; bÍÇİˆº¹: } public static function sign($FôÉÃç©ƒ = false) { $FôÉÃç©ƒ && (self::$sessionSign = $FôÉÃç©ƒ); self::init(); return self::$sessionSign; } public static function set($bƒ¢ÜË¸, $Aê‘Ô¥  = false) { self::init(); if (is_array($bƒ¢ÜË¸)) { foreach ($bƒ¢ÜË¸ as $bò‚ÖáÔ => $CÎ‹ƒâÖ¬‘) { array_set_value(self::$data, $bò‚ÖáÔ, $CÎ‹ƒâÖ¬‘); } } else { array_set_value(self::$data, $bƒ¢ÜË¸, $Aê‘Ô¥ ); } CacheLock::lock(self::$sessionSign); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); CacheLock::unlock(self::$sessionSign); } public static function get($aÄøƒ®ù‹ë = false) { self::init(); if (!$aÄøƒ®ù‹ë) { return self::$data; } return array_get_value(self::$data, $aÄøƒ®ù‹ë); } public static function remove($e´íä­¯‹×) { self::init(); unset(self::$data[$e´íä­¯‹×]); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); } public static function destory() { Cookie::remove(SESSION_ID, !0); self::init(); self::clearTimeout(); self::$data = array(); return self::$handle->remove(self::$sessionSign); } public static function clearTimeout() { self::init(); if (method_exists(self::$handle, $_SERVER[ªúæÂ¡­ä½][816])) { self::$handle->clearTimeout(); } } } class AutoTask { const AUTO_DELAY_TIME = 2; const AUTO_RESTART_TIME = 7200; public static function start() { goto c‡»ò¤¨Ï; f¯İöô¡İ: while (!0) { self::cacheClear(); if (self::valueGet($Dåóœ¥ßÓ—[728]) != $Dåóœ¥ßÓ—[87]) { self::valueSet($Dåóœ¥ßÓ—[1508], $Dåóœ¥ßÓ—[191]); self::log($Dåóœ¥ßÓ—[1512]); die; } self::valueSet($Dåóœ¥ßÓ—[1508], $Dåóœ¥ßÓ—[87]); self::valueSet($Dåóœ¥ßÓ—[1509], time()); self::taskRunAll(); sleep(self::AUTO_DELAY_TIME); } goto DªÎÜÂêá; EÚõ­éÊÓ: http_close(); self::valueSet($Dåóœ¥ßÓ—[1508], $Dåóœ¥ßÓ—[87]); Hook::bind($Dåóœ¥ßÓ—[1510], $Dåóœ¥ßÓ—[1511]); goto f¯İöô¡İ; c‡»ò¤¨Ï: $Dåóœ¥ßÓ— =& $_SERVER[ªúæÂ¡­ä½]; if (self::valueGet($Dåóœ¥ßÓ—[728]) != $Dåóœ¥ßÓ—[87]) { return; } if (self::valueGet($Dåóœ¥ßÓ—[1508]) == $Dåóœ¥ßÓ—[87]) { $C¿Ü˜Ù“…Ù = self::valueGet($Dåóœ¥ßÓ—[1509]); if (time() - $C¿Ü˜Ù“…Ù > self::AUTO_RESTART_TIME) { self::restart(); } return; } goto EÚõ­éÊÓ; DªÎÜÂêá: } public static function restart() { $BÇ‚— ô½ =& $_SERVER[ªúæÂ¡­ä½]; http_close(); self::valueSet($BÇ‚— ô½[728], $BÇ‚— ô½[191]); sleep(self::AUTO_DELAY_TIME + 5); self::valueSet($BÇ‚— ô½[1508], $BÇ‚— ô½[191]); self::valueSet($BÇ‚— ô½[728], $BÇ‚— ô½[87]); } public static function shutdownEvent() { $F¨•­ù…âé =& $_SERVER[ªúæÂ¡­ä½]; self::valueSet($F¨•­ù…âé[1508], $F¨•­ù…âé[191]); self::log($F¨•­ù…âé[1513]); } public static function config($F‰Ã‚è«ƒ£, $c£†èåÁÌ) { self::valueSet($_SERVER[ªúæÂ¡­ä½][728], $F‰Ã‚è«ƒ£); } private static function taskRunAll() { goto CŞ§Î¶ì”; A÷¦Ùª¯‡: self::taskQueueRun($f„ò«½æ‚); goto eØ›—ØÊô; dÉŸ‚¬ÒÛß: $dÖØà°­ñ = count($bâÍ ¦’Ù«); for ($b©™¦ì†ÏÈ = 0; $b©™¦ì†ÏÈ < $dÖØà°­ñ; $b©™¦ì†ÏÈ++) { $A©²×ÈœòÕ = $bâÍ ¦’Ù«[$b©™¦ì†ÏÈ]; if (!$A©²×ÈœòÕ[$E¦Ğ°ÕÍ¶Ã[394]] || $A©²×ÈœòÕ[$E¦Ğ°ÕÍ¶Ã[1515]] != $E¦Ğ°ÕÍ¶Ã[87]) { continue; } if (!self::taskTimeCheck($A©²×ÈœòÕ)) { continue; } self::taskRun($A©²×ÈœòÕ); } Hook::trigger($E¦Ğ°ÕÍ¶Ã[1516]); goto A÷¦Ùª¯‡; CŞ§Î¶ì”: $E¦Ğ°ÕÍ¶Ã =& $_SERVER[ªúæÂ¡­ä½]; $f„ò«½æ‚ = timeFloat(); $bâÍ ¦’Ù« = Model($E¦Ğ°ÕÍ¶Ã[1514])->listData(); goto dÉŸ‚¬ÒÛß; eØ›—ØÊô: } private static function taskQueueRun($fÊµ¦¡½Ñ) { $cÈ ÜÒ”â‰ = 10; while (!0) { $Eïó¢ ß´Ã = TaskQueue::run(); if ($Eïó¢ ß´Ã === !1) { break; } if (timeFloat() - $fÊµ¦¡½Ñ >= $cÈ ÜÒ”â‰) { break; } } } private static function taskTimeCheck($b¤»º³¦ˆ¨) { goto b…†ŞÔÂ…Ñ; b…†ŞÔÂ…Ñ: $AÉŞ°Ÿí› =& $_SERVER[ªúæÂ¡­ä½]; $CÍÃ³„×’ó = json_decode($b¤»º³¦ˆ¨[$AÉŞ°Ÿí›[197]], !0); $a¨«„”Æï† = intval($b¤»º³¦ˆ¨[$AÉŞ°Ÿí›[1509]]); goto Bçİ¸Éí‡»; Bçİ¸Éí‡»: $AÕ¦…¿Ğó = strtotime($AÉŞ°Ÿí›[1517] . $CÍÃ³„×’ó[$AÉŞ°Ÿí›[1518]] . $AÉŞ°Ÿí›[1519]) - strtotime($AÉŞ°Ÿí›[1520]); $E¾£è™‘ = time() - strtotime(date($AÉŞ°Ÿí›[1521]) . $AÉŞ°Ÿí›[1522]); $FÙâæÁ½´ = $E¾£è™‘ >= $AÕ¦…¿Ğó && $E¾£è™‘ <= $AÕ¦…¿Ğó + 3600; goto DŞ¾ã½‘ãÖ; DŞ¾ã½‘ãÖ: switch ($CÍÃ³„×’ó[$AÉŞ°Ÿí›[29]]) { case $AÉŞ°Ÿí›[1523]: if (time() - $a¨«„”Æï† < 3600 * 24 * 30) { return !1; } if ($CÍÃ³„×’ó[$AÉŞ°Ÿí›[1523]] == date($AÉŞ°Ÿí›[1524]) && $FÙâæÁ½´) { return !0; } break; case $AÉŞ°Ÿí›[1525]: if (time() - $a¨«„”Æï† < 3600 * 24 * 7) { return !1; } $a¡ëæµÕœá = date($AÉŞ°Ÿí›[1526]) == 0 ? 7 : date($AÉŞ°Ÿí›[1526]); if ($CÍÃ³„×’ó[$AÉŞ°Ÿí›[1525]] == $a¡ëæµÕœá && $FÙâæÁ½´) { return !0; } break; case $AÉŞ°Ÿí›[1518]: if (time() - $a¨«„”Æï† < 3600 * 24) { return !1; } if ($FÙâæÁ½´) { return !0; } break; case $AÉŞ°Ÿí›[1527]: if (time() - $a¨«„”Æï† >= floatval($CÍÃ³„×’ó[$AÉŞ°Ÿí›[1527]]) * 60) { return !0; } break; default: break; } return !1; goto aØâöƒÓ™¦; aØâöƒÓ™¦: } private static function closeDatabase() { goto fäÌÁÓÆé; D½÷‹æİø÷: $AÙÙ¨õåÙô = Model($a¾ÍÃ“Ñ…ó[495])->db($a¾ÍÃ“Ñ…ó[33]); if ($AÙÙ¨õåÙô) { $AÙÙ¨õåÙô->closeConnect(); } if (time() - TIME > 3600 * 24 * 3) { write_log($a¾ÍÃ“Ñ…ó[1528], $a¾ÍÃ“Ñ…ó[1529]); die; } goto aİì¿¼”†; fäÌÁÓÆé: $a¾ÍÃ“Ñ…ó =& $_SERVER[ªúæÂ¡­ä½]; static $d‹ö­Éæù = 0; $cÓÎŒÙ’ßË = 300; goto dŒ„Âï ¬¹; dŒ„Âï ¬¹: if (!$d‹ö­Éæù) { $d‹ö­Éæù = time(); } if (time() - $d‹ö­Éæù < $cÓÎŒÙ’ßË) { return; } $d‹ö­Éæù = time(); goto D½÷‹æİø÷; aİì¿¼”†: } public static function taskRun($f‘‰ÅŞº¼ã) { goto bÄ‘Ñ¡ã†¶; fŒÛÑØÆà: return !0; goto e˜ƒùœÜËË; F¼¼ÚÉ£¼¨: Model($AÁ„ğÁ„“­[1534])->add(array($AÁ„ğÁ„“­[1535] => $AÁ„ğÁ„“­[33], $AÁ„ğÁ„“­[1536] => $AÁ„ğÁ„“­[191], $AÁ„ğÁ„“­[29] => $AÁ„ğÁ„“­[1537] . $f‘‰ÅŞº¼ã[$AÁ„ğÁ„“­[394]], $AÁ„ğÁ„“­[1538] => json_encode(array($AÁ„ğÁ„“­[28] => $f‘‰ÅŞº¼ã[$AÁ„ğÁ„“­[28]], $AÁ„ğÁ„“­[1539] => timeFloat() - $DĞî¬Ê¤›å, $AÁ„ğÁ„“­[291] => $Dˆ‰„Òà¥)))); $c‡ª÷Éå±Ü = $Dˆ‰„Òà¥ ? $AÁ„ğÁ„“­[1540] . $Dˆ‰„Òà¥ : $AÁ„ğÁ„“­[33]; self::log($AÁ„ğÁ„“­[1541] . $f‘‰ÅŞº¼ã[$AÁ„ğÁ„“­[394]] . $AÁ„ğÁ„“­[518] . $c‡ª÷Éå±Ü); goto fŒÛÑØÆà; FÙ‰’Ãã‡Ë: $DĞî¬Ê¤›å = timeFloat(); $Dˆ‰„Òà¥ = $AÁ„ğÁ„“­[33]; switch ($f‘‰ÅŞº¼ã[$AÁ„ğÁ„“­[29]]) { case $AÁ„ğÁ„“­[305]: $d±•“å¯Âã = url_request($f‘‰ÅŞº¼ã[$AÁ„ğÁ„“­[1533]], $AÁ„ğÁ„“­[228], !1, !1, !1, !1, 10); if ($d±•“å¯Âã[$AÁ„ğÁ„“­[728]]) { $Dˆ‰„Òà¥ = strlen($d±•“å¯Âã[$AÁ„ğÁ„“­[1103]]); } break; case $AÁ„ğÁ„“­[227]: $Dˆ‰„Òà¥ = Hook::apply($f‘‰ÅŞº¼ã[$AÁ„ğÁ„“­[1533]]); default: break; } goto F¼¼ÚÉ£¼¨; bÄ‘Ñ¡ã†¶: $AÁ„ğÁ„“­ =& $_SERVER[ªúæÂ¡­ä½]; self::log($AÁ„ğÁ„“­[1530] . $f‘‰ÅŞº¼ã[$AÁ„ğÁ„“­[394]] . $AÁ„ğÁ„“­[1531] . $f‘‰ÅŞº¼ã[$AÁ„ğÁ„“­[28]] . $AÁ„ğÁ„“­[1532] . $f‘‰ÅŞº¼ã[$AÁ„ğÁ„“­[1533]]); Model($AÁ„ğÁ„“­[1514])->run($f‘‰ÅŞº¼ã[$AÁ„ğÁ„“­[394]]); goto FÙ‰’Ãã‡Ë; e˜ƒùœÜËË: } private static function valueGet($a»ç†ÕŠ•) { $A¸ê©¹¥Æ‘ =& $_SERVER[ªúæÂ¡­ä½]; $F¯µØ³©Éš = $A¸ê©¹¥Æ‘[1542]; $AÙóª˜ÑÉ§ = Model($A¸ê©¹¥Æ‘[487])->get($a»ç†ÕŠ•, $F¯µØ³©Éš); if (is_null($AÙóª˜ÑÉ§)) { Model($A¸ê©¹¥Æ‘[487])->set($A¸ê©¹¥Æ‘[728], $A¸ê©¹¥Æ‘[87], $F¯µØ³©Éš); Model($A¸ê©¹¥Æ‘[487])->set($A¸ê©¹¥Æ‘[1508], $A¸ê©¹¥Æ‘[191], $F¯µØ³©Éš); $AÙóª˜ÑÉ§ = Model($A¸ê©¹¥Æ‘[487])->get($a»ç†ÕŠ•, $F¯µØ³©Éš); } return $AÙóª˜ÑÉ§; } private static function valueSet($f£Øó‰ÓÆ, $e­•ê«ˆ§­) { $Eø§„ÏªÙï =& $_SERVER[ªúæÂ¡­ä½]; $dø¾ì…‚ªÕ = $Eø§„ÏªÙï[1543]; CacheLock::lock($dø¾ì…‚ªÕ); $E‚Î®ê²ŒÆ = Model($Eø§„ÏªÙï[487])->set($f£Øó‰ÓÆ, $e­•ê«ˆ§­, $Eø§„ÏªÙï[1542]); CacheLock::unlock($dø¾ì…‚ªÕ); return $E‚Î®ê²ŒÆ; } protected static function log($dóÅêœ°ŠØ) { write_log($dóÅêœ°ŠØ, $_SERVER[ªúæÂ¡­ä½][1529]); } private static function cacheClear() { $FŸ‰è¨™ÕÛ =& $_SERVER[ªúæÂ¡­ä½]; Cache::clearMemory(Model($FŸ‰è¨™ÕÛ[487])->cacheKey($FŸ‰è¨™ÕÛ[1542])); Cache::clearMemory(Model($FŸ‰è¨™ÕÛ[487])->cacheKey($FŸ‰è¨™ÕÛ[1544])); Model($FŸ‰è¨™ÕÛ[1514])->cacheClear(); self::closeDatabase(); } } class Task { const STATYS_STOP = "\x73\164\x6f\x70"; const STATYS_RUNNING = "\x72\165\x6e\156\x69\156\147"; const STATYS_KILL = "\x6b\151\x6c\x6c"; public $task; public function __destruct() { $this->end(); } public function __construct($D‚–œâÕ¸, $d¯ºöÉóš® = '', $C¹ÔÄŠâ× = 0, $A·‚õò‘æÑ = '') { goto a¨¬êÑÍÉò; a¨¬êÑÍÉò: $eäçŠÃÜœõ =& $_SERVER[ªúæÂ¡­ä½]; if (self::get($D‚–œâÕ¸)) { return; } $this->task = array($eäçŠÃÜœõ[394] => $D‚–œâÕ¸, $eäçŠÃÜœõ[1545] => USER_ID, $eäçŠÃÜœõ[1445] => $A·‚õò‘æÑ, $eäçŠÃÜœõ[29] => $d¯ºöÉóš®, $eäçŠÃÜœõ[1039] => $eäçŠÃÜœõ[33], $eäçŠÃÜœõ[1037] => $C¹ÔÄŠâ×, $eäçŠÃÜœõ[1051] => 0, $eäçŠÃÜœõ[1546] => 0, $eäçŠÃÜœõ[1547] => 0, $eäçŠÃÜœõ[767] => timeFloat(), $eäçŠÃÜœõ[766] => 0, $eäçŠÃÜœõ[1548] => 0, $eäçŠÃÜœõ[1549] => 0, $eäçŠÃÜœõ[1550] => 0, $eäçŠÃÜœõ[728] => $eäçŠÃÜœõ[1508]); goto D¬¯µâ£; Fìâ–ùŒ½: $this->startAfter(); Hook::trigger($eäçŠÃÜœõ[1555], $this->task); $this->task[$eäçŠÃÜœõ[1548]] = timeFloat(); goto aŸÕ¨ñ›™; D¬¯µâ£: $GLOBALS[$eäçŠÃÜœõ[1551]] = 1; Hook::bind($eäçŠÃÜœõ[1510], array($this, $eäçŠÃÜœõ[1552])); Hook::bind($eäçŠÃÜœõ[1553], array($this, $eäçŠÃÜœõ[1554])); goto Fìâ–ùŒ½; aŸÕ¨ñ›™: } public function end() { goto FÕ•¡øŞ‘ì; E¾ã­½ó¾Œ: Hook::unbind($F®ëë²ßÃ[1553], array($this, $F®ëë²ßÃ[1554])); $this->endAfter(); $this->task = !1; goto FŞ•Ó˜ÁÖù; Eïİğ¿®àí: $bÆ¢›Ÿ¢ = timeFloat() - $this->task[$F®ëë²ßÃ[767]]; self::log($F®ëë²ßÃ[1556] . $this->task[$F®ëë²ßÃ[394]] . $F®ëë²ßÃ[1557] . $bÆ¢›Ÿ¢ . $F®ëë²ßÃ[1558]); Hook::unbind($F®ëë²ßÃ[1510], array($this, $F®ëë²ßÃ[1552])); goto E¾ã­½ó¾Œ; FÕ•¡øŞ‘ì: $F®ëë²ßÃ =& $_SERVER[ªúæÂ¡­ä½]; if (!$this->task) { return; } if ($this->task[$F®ëë²ßÃ[1548]]) { self::valueSet($this->task[$F®ëë²ßÃ[394]], !1); } goto Eïİğ¿®àí; FŞ•Ó˜ÁÖù: } public function update($c¤ƒ‡î–À = 0, $F¦êÅ‘ã¤˜ = false) { goto d‘±Çä½©«; f£§èÆ¢°â: $aÓè‘½–É[$fîœŠŠïÑ[1051]] += $c¤ƒ‡î–À; $aÓè‘½–É[$fîœŠŠïÑ[766]] = timeFloat(); if ($aÓè‘½–É[$fîœŠŠïÑ[1037]]) { if ($aÓè‘½–É[$fîœŠŠïÑ[1037]] < $aÓè‘½–É[$fîœŠŠïÑ[1051]]) { $aÓè‘½–É[$fîœŠŠïÑ[1037]] = $aÓè‘½–É[$fîœŠŠïÑ[1051]]; } $bÇìÌ‘ù›ó = timeFloat() - $aÓè‘½–É[$fîœŠŠïÑ[767]] - $aÓè‘½–É[$fîœŠŠïÑ[1549]]; $aÓè‘½–É[$fîœŠŠïÑ[1546]] = $aÓè‘½–É[$fîœŠŠïÑ[1051]] / $aÓè‘½–É[$fîœŠŠïÑ[1037]]; $aÓè‘½–É[$fîœŠŠïÑ[1547]] = $aÓè‘½–É[$fîœŠŠïÑ[1051]] / $bÇìÌ‘ù›ó; if ($aÓè‘½–É[$fîœŠŠïÑ[1546]] > 0) { $aÓè‘½–É[$fîœŠŠïÑ[1550]] = $bÇìÌ‘ù›ó * (1 - $aÓè‘½–É[$fîœŠŠïÑ[1546]]) / $aÓè‘½–É[$fîœŠŠïÑ[1546]]; } $aÓè‘½–É[$fîœŠŠïÑ[1550]] = $aÓè‘½–É[$fîœŠŠïÑ[1550]] <= 0 ? 0 : $aÓè‘½–É[$fîœŠŠïÑ[1550]]; } goto d†ÏÑÍäì; d†ÏÑÍäì: $this->updateAfter(); $a™´£‡Í· = 0.2; if (timeFloat() - $aÓè‘½–É[$fîœŠŠïÑ[1548]] < $a™´£‡Í· && !$F¦êÅ‘ã¤˜) { return; } goto a×¥ÏÑÒ•Ö; cÆØÆ­ø: Hook::trigger($fîœŠŠïÑ[1562], $aÓè‘½–É); self::valueSet($aÓè‘½–É[$fîœŠŠïÑ[394]], $aÓè‘½–É); goto d ÃÅ‘¢êÀ; d‘±Çä½©«: $fîœŠŠïÑ =& $_SERVER[ªúæÂ¡­ä½]; $aÓè‘½–É =& $this->task; if (!$aÓè‘½–É) { return; } goto f£§èÆ¢°â; Cµ¦¦ŠŠÓ: $aÓè‘½–É[$fîœŠŠïÑ[728]] = $a·¿‹¯†Ú¾ ? $a·¿‹¯†Ú¾ : $aÓè‘½–É[$fîœŠŠïÑ[728]]; $aÓè‘½–É[$fîœŠŠïÑ[1549]] = $a¡Š¤ª†¬¹[$fîœŠŠïÑ[1549]] ? $a¡Š¤ª†¬¹[$fîœŠŠïÑ[1549]] : 0; $aÓè‘½–É[$fîœŠŠïÑ[1548]] = timeFloat(); goto cÆØÆ­ø; a×¥ÏÑÒ•Ö: $a¡Š¤ª†¬¹ = self::get($aÓè‘½–É[$fîœŠŠïÑ[394]]); $a·¿‹¯†Ú¾ = $a¡Š¤ª†¬¹[$fîœŠŠïÑ[728]]; if ($a·¿‹¯†Ú¾ == self::STATYS_KILL) { $ağÃËàøÁ® = array($fîœŠŠïÑ[1559] => LNG($fîœŠŠïÑ[1560]), $fîœŠŠïÑ[1101] => !1); Cache::set($fîœŠŠïÑ[1561] . $this->task[$fîœŠŠïÑ[394]], $ağÃËàøÁ®, 30); $this->onKill(); $this->end(); die; } else { if ($a·¿‹¯†Ú¾ == self::STATYS_STOP) { $cùã££ö´¶ = 2; $a¡Š¤ª†¬¹[$fîœŠŠïÑ[1549]] += $cùã££ö´¶; self::valueSet($aÓè‘½–É[$fîœŠŠïÑ[394]], $a¡Š¤ª†¬¹); sleep($cùã££ö´¶); $this->update(); return; } } goto Cµ¦¦ŠŠÓ; d ÃÅ‘¢êÀ: } public function onKillSet($FŞµ˜ïŠô², $dè÷ §’î = array()) { $this->onKillCall = array($FŞµ˜ïŠô², $dè÷ §’î); } public function onKill() { $C¼¥Ãé÷ÚŠ =& $_SERVER[ªúæÂ¡­ä½]; self::log($C¼¥Ãé÷ÚŠ[1556] . $this->task[$C¼¥Ãé÷ÚŠ[394]] . $C¼¥Ãé÷ÚŠ[1563]); if (!$this->onKillCall) { return; } ActionApply($this->onKillCall[0], $this->onKillCall[1]); $this->onKillCall = !1; } protected function updateAfter() { } protected function startAfter() { } protected function endAfter() { } public function shutdownEvent() { $this->end(); } public function showJson($AÚ¢äºğÁ) { $dÄÃ¨ƒùÒ¥ =& $_SERVER[ªúæÂ¡­ä½]; Cache::set($dÄÃ¨ƒùÒ¥[1561] . $this->task[$dÄÃ¨ƒùÒ¥[394]], $AÚ¢äºğÁ, 60); return $AÚ¢äºğÁ; } public static function get($aœƒ†ŞÂ·Æ) { $cèˆš¯Ô¶ =& $_SERVER[ªúæÂ¡­ä½]; $bÉôÄ…‡ŠÂ = self::valueGet($aœƒ†ŞÂ·Æ); if (is_array($bÉôÄ…‡ŠÂ) && $bÉôÄ…‡ŠÂ[$cèˆš¯Ô¶[1564]]) { $e•„•íªåÎ = ActionApply($bÉôÄ…‡ŠÂ[$cèˆš¯Ô¶[1564]], array($bÉôÄ…‡ŠÂ)); $bÉôÄ…‡ŠÂ = is_array($e•„•íªåÎ) ? $e•„•íªåÎ : $bÉôÄ…‡ŠÂ; } return $bÉôÄ…‡ŠÂ; } public static function listData() { $d¡ä¢¦¤ë = self::valueGet(); return array_sort_by($d¡ä¢¦¤ë, $_SERVER[ªúæÂ¡­ä½][767], !0); } public static function kill($C„­Ÿƒ†Ä¹) { return self::changeStatus($C„­Ÿƒ†Ä¹, self::STATYS_KILL); } public static function stop($aŠøŞ¡ôµñ) { return self::changeStatus($aŠøŞ¡ôµñ, self::STATYS_STOP); } public static function restart($EäØ»–ÜÉ) { return self::changeStatus($EäØ»–ÜÉ, self::STATYS_RUNNING); } public static function killAll() { $CŞªŠ¬¨¢Õ =& $_SERVER[ªúæÂ¡­ä½]; $eï¨ÂªÚä = self::listData(); foreach ($eï¨ÂªÚä as $böÉ‘½¤÷ˆ) { self::kill($böÉ‘½¤÷ˆ[$CŞªŠ¬¨¢Õ[394]]); } sleep(2); foreach ($eï¨ÂªÚä as $böÉ‘½¤÷ˆ) { self::valueSet($böÉ‘½¤÷ˆ[$CŞªŠ¬¨¢Õ[394]], !1); } } private static function changeStatus($aØµ¢Ìµ–, $fçóŞ¸ğˆÊ) { goto C‰˜òêÒë¸; C‰˜òêÒë¸: $eÆÅÓãšÖò =& $_SERVER[ªúæÂ¡­ä½]; $aæÎõ“‘Ø = self::valueGet($aØµ¢Ìµ–); if (!$aæÎõ“‘Ø) { return !1; } goto cÖ¯ÈÍ³œ¤; Eç¼±†Ò¾’: return !0; goto e®•Ø‘Í¬Û; cÖ¯ÈÍ³œ¤: $aæÎõ“‘Ø[$eÆÅÓãšÖò[728]] = $fçóŞ¸ğˆÊ; self::valueSet($aØµ¢Ìµ–, $aæÎõ“‘Ø); self::log($eÆÅÓãšÖò[1565] . $aæÎõ“‘Ø[$eÆÅÓãšÖò[394]] . $eÆÅÓãšÖò[1566] . $fçóŞ¸ğˆÊ); goto Eç¼±†Ò¾’; e®•Ø‘Í¬Û: } public static function valueGet($fæÜÄ…÷æ¿ = false) { $bÎ¢Ù©îÔã =& $_SERVER[ªúæÂ¡­ä½]; if ($fæÜÄ…÷æ¿) { $f¸®«Ö«« = Model($bÎ¢Ù©îÔã[426])->where(array($bÎ¢Ù©îÔã[93] => $fæÜÄ…÷æ¿, $bÎ¢Ù©îÔã[29] => $bÎ¢Ù©îÔã[1567]))->find(); return $f¸®«Ö«« ? json_decode($f¸®«Ö««[$bÎ¢Ù©îÔã[372]], !0) : !1; } return self::taskListUser(USER_ID); } public static function taskListUser($AŞ¦¨”ÒÈ¢ = false) { goto F¤Ç¥‹²°…; F¤Ç¥‹²°…: $e©×È·ˆ• =& $_SERVER[ªúæÂ¡­ä½]; $bÄÙÔ´ÚáŠ = array($e©×È·ˆ•[29] => $e©×È·ˆ•[1567]); if ($AŞ¦¨”ÒÈ¢) { $bÄÙÔ´ÚáŠ[$e©×È·ˆ•[1545]] = $AŞ¦¨”ÒÈ¢; } goto c†ÁØæ¿©; c†ÁØæ¿©: $c‡Ò‡‡Ø­ª = Model($e©×È·ˆ•[426])->where($bÄÙÔ´ÚáŠ)->select(); $c‡Ò‡‡Ø­ª = $c‡Ò‡‡Ø­ª ? $c‡Ò‡‡Ø­ª : array(); foreach ($c‡Ò‡‡Ø­ª as $B¾ÛéÇ¿Á => $C³ÊÙè¸™») { $c‡Ò‡‡Ø­ª[$B¾ÛéÇ¿Á] = json_decode($C³ÊÙè¸™»[$e©×È·ˆ•[372]], !0); } goto Dİòœ®Â¿; Dİòœ®Â¿: return $c‡Ò‡‡Ø­ª; goto fàÕøéİß; fàÕøéİß: } public static function valueSet($bÕàÄÁë›, $B°øù†Ïˆ) { goto E‡ù§ïî•; fªáÒÏì¯°: if (!$B»“Ì•›£¼) { ob_start(); var_dump($B°øù†Ïˆ); $bÂ•íÍÂ¡© = ob_get_clean(); self::log($AÜöì¤»ö[1568] . json_encode_force($bÂ•íÍÂ¡©)); } if (!$bÕàÄÁë› || !$B°øù†Ïˆ[$AÜöì¤»ö[394]]) { return !1; } $b©ÄÉõ ´· = array($AÜöì¤»ö[29] => $AÜöì¤»ö[1567], $AÜöì¤»ö[1545] => USER_ID, $AÜöì¤»ö[93] => $bÕàÄÁë›, $AÜöì¤»ö[372] => $B»“Ì•›£¼); goto C¾Ì™¢ğñ; E‡ù§ïî•: $AÜöì¤»ö =& $_SERVER[ªúæÂ¡­ä½]; if (!$B°øù†Ïˆ) { return Model($AÜöì¤»ö[426])->where(array($AÜöì¤»ö[93] => $bÕàÄÁë›, $AÜöì¤»ö[29] => $AÜöì¤»ö[1567]))->delete(); } $B»“Ì•›£¼ = json_encode($B°øù†Ïˆ); goto fªáÒÏì¯°; c¿ö‰è®†: CacheLock::unlock($BÆ¨¡ê—Éè); goto B–ƒŒš¯Ú‡; C¾Ì™¢ğñ: $BÆ¨¡ê—Éè = $AÜöì¤»ö[1569]; CacheLock::lock($BÆ¨¡ê—Éè); Model($AÜöì¤»ö[426])->add($b©ÄÉõ ´·, array(), !0); goto c¿ö‰è®†; B–ƒŒš¯Ú‡: } public static function log($f«ùöÎ‹½) { if (!GLOBAL_DEBUG) { return; } write_log($f«ùöÎ‹½, $_SERVER[ªúæÂ¡­ä½][1570]); } } goto D·ä‡ŒŞé; CØ¿¥•ê: class CommentModel extends ModelBase { protected $tableName = "\x63\x6f\x6d\155\145\156\x74"; protected $tableMeta = array("\x74\x61\x62\x6c\x65\116\141\155\145" => "\143\x6f\155\x6d\x65\x6e\164\137\x6d\x65\x74\141", "\x6d\145\x74\141\x46\151\x65\154\x64" => "\x63\x6f\x6d\155\x65\156\x74\111\x44"); const TYPE_SOURCE = 1; const TYPE_SHARE = 2; const TYPE_USER = 3; const TYPE_GROUP = 4; const TYPE_TOPIC = 5; const TYPE_STAR_OFFSET = 100000000; public static $TYPEALL = array(self::TYPE_SOURCE, self::TYPE_SHARE, self::TYPE_USER, self::TYPE_GROUP, self::TYPE_TOPIC); public function addComment($DßåŞ¼òª) { $eªé¬ìã×é =& $_SERVER[ªúæÂ¡­ä½]; if ($DßåŞ¼òª[$eªé¬ìã×é[1742]]) { $Bº§¡Ö¥Ç² = $this->where(array($eªé¬ìã×é[1743] => $DßåŞ¼òª[$eªé¬ìã×é[1742]]))->find(); if (!$Bº§¡Ö¥Ç² || $Bº§¡Ö¥Ç²[$eªé¬ìã×é[405]] != $DßåŞ¼òª[$eªé¬ìã×é[405]] || $Bº§¡Ö¥Ç²[$eªé¬ìã×é[485]] != $DßåŞ¼òª[$eªé¬ìã×é[485]]) { return !1; } $this->where(array($eªé¬ìã×é[1743] => $DßåŞ¼òª[$eªé¬ìã×é[1742]]))->setAdd($eªé¬ìã×é[1744], 1); } $DßåŞ¼òª[$eªé¬ìã×é[1745]] = 0; $DßåŞ¼òª[$eªé¬ìã×é[1744]] = 0; $DßåŞ¼òª[$eªé¬ìã×é[728]] = 1; return $this->add($DßåŞ¼òª); } public function commentCount($bÛŠ£†ì’, $CÔë“šÍ©†, $D¸¥àØÏí² = false) { goto b–ŒÒ…Ñ­ß; b–ŒÒ…Ñ­ß: $fâÇŸ½‡§Ì =& $_SERVER[ªúæÂ¡­ä½]; if (!$bÛŠ£†ì’) { return array(); } if (is_string($bÛŠ£†ì’) || is_int($bÛŠ£†ì’)) { $bÛŠ£†ì’ = array($bÛŠ£†ì’); } goto dÛ‚—ŞÔ•Å; có§²ÁëÈÜ: $fŠëôè¾ÀÉ = $this->field($BÍ†Ş’©)->where($dï”›Šº)->group($fâÇŸ½‡§Ì[485])->select(); return array_to_keyvalue($fŠëôè¾ÀÉ, $fâÇŸ½‡§Ì[485], $fâÇŸ½‡§Ì[481]); goto Fó Ïêõ¸; dÛ‚—ŞÔ•Å: $BÍ†Ş’© = array($fâÇŸ½‡§Ì[485], $fâÇŸ½‡§Ì[1746] => $fâÇŸ½‡§Ì[481]); $dï”›Šº = array($fâÇŸ½‡§Ì[485] => array($fâÇŸ½‡§Ì[7], $bÛŠ£†ì’), $fâÇŸ½‡§Ì[405] => $CÔë“šÍ©†); if ($D¸¥àØÏí²) { $dï”›Šº[$fâÇŸ½‡§Ì[1545]] = $D¸¥àØÏí²; } goto có§²ÁëÈÜ; Fó Ïêõ¸: } public function starTarget($fì¡º“–Œ, $CßçĞÙÑ±Ç) { goto Fˆ²¹¼—‰; c‡ƒ¢ÌİÃ: $b¶ˆŒƒº…´ = $this->where($BÚùà’ë›²)->find(); if ($b¶ˆŒƒº…´) { return $this->where(array($fÏÜèšàÌˆ[394] => $b¶ˆŒƒº…´[$fÏÜèšàÌˆ[394]]))->delete(); } $C–´ÙÙ¸á = array($fÏÜèšàÌˆ[1742] => 0, $fÏÜèšàÌˆ[1545] => USER_ID, $fÏÜèšàÌˆ[728] => 1, $fÏÜèšàÌˆ[733] => $fÏÜèšàÌˆ[33], $fÏÜèšàÌˆ[405] => $F› ƒ­‹æ, $fÏÜèšàÌˆ[485] => $CßçĞÙÑ±Ç, $fÏÜèšàÌˆ[1745] => 0, $fÏÜèšàÌˆ[1744] => 0); goto DÏ‡¢‡ÚÑ±; DÏ‡¢‡ÚÑ±: return $this->add($C–´ÙÙ¸á); goto b÷‚ ñÈ£; Fˆ²¹¼—‰: $fÏÜèšàÌˆ =& $_SERVER[ªúæÂ¡­ä½]; $F› ƒ­‹æ = $fì¡º“–Œ + self::TYPE_STAR_OFFSET; $BÚùà’ë›² = array($fÏÜèšàÌˆ[1545] => USER_ID, $fÏÜèšàÌˆ[405] => $F› ƒ­‹æ, $fÏÜèšàÌˆ[485] => $CßçĞÙÑ±Ç); goto c‡ƒ¢ÌİÃ; b÷‚ ñÈ£: } public function starTargetCount($f‚À†¥¾Ç°, $FæôÊ‚»ğ¨) { $aª§ÜÜã•› =& $_SERVER[ªúæÂ¡­ä½]; $a¦×“õ¿´ = $FæôÊ‚»ğ¨ + self::TYPE_STAR_OFFSET; $C¶È¸…á·ã = $this->commentCount($f‚À†¥¾Ç°, $a¦×“õ¿´); $F¶‹ä¨ÜÁ = $this->commentCount($f‚À†¥¾Ç°, $a¦×“õ¿´, USER_ID); return array($aª§ÜÜã•›[1747] => $C¶È¸…á·ã, $aª§ÜÜã•›[1748] => $F¶‹ä¨ÜÁ); } public function starTargetUserList($B¾ä´º’áš, $cÜòºÃÎœ) { goto e™‹‡Ÿ…ñö; B¨Â‘±£±ˆ: $F“™í½•†Á = $this->field($EÅŞËê“Ş¹[1545])->where($aÃÑŠµßïì)->limit(500)->select(); $F“™í½•†Á = array_to_keyvalue($F“™í½•†Á, $EÅŞËê“Ş¹[33], $EÅŞËê“Ş¹[1545]); $c‹ĞÌ»Ûš©[$EÅŞËê“Ş¹[1749]] = Model($EÅŞËê“Ş¹[495])->userListInfo($F“™í½•†Á); goto Cá‰‚„Ş†; Cá‰‚„Ş†: return $c‹ĞÌ»Ûš©; goto a£ƒİÆëº©; e™‹‡Ÿ…ñö: $EÅŞËê“Ş¹ =& $_SERVER[ªúæÂ¡­ä½]; $c“•ØÊŒí– = $B¾ä´º’áš + self::TYPE_STAR_OFFSET; $aÃÑŠµßïì = array($EÅŞËê“Ş¹[485] => $cÜòºÃÎœ, $EÅŞËê“Ş¹[405] => $c“•ØÊŒí–); goto bêˆÑô‹è­; bêˆÑô‹è­: $c·ã‘ØÄóà = $this->where($aÃÑŠµßïì)->count(); $c‹ĞÌ»Ûš© = array($EÅŞËê“Ş¹[253] => $c·ã‘ØÄóà, $EÅŞËê“Ş¹[1749] => array()); if (!$c·ã‘ØÄóà) { return $c‹ĞÌ»Ûš©; } goto B¨Â‘±£±ˆ; a£ƒİÆëº©: } public function prasiseUserList($dÃÉœá…ë) { goto a©‹¦‰¶Ä²; BŒê¦‘®æ´: return $FÕ¶ÀÒ¯±Ì; goto DÄÍÃŸºâ; B¦®‚„Ÿ¬ : $CÌŞª²Å´ø = Model($Fç‰åÑŸº«[1751])->field($Fç‰åÑŸº«[1545])->where($f„çØ÷“¨İ)->limit(500)->select(); $CÌŞª²Å´ø = array_to_keyvalue($CÌŞª²Å´ø, $Fç‰åÑŸº«[33], $Fç‰åÑŸº«[1545]); $FÕ¶ÀÒ¯±Ì[$Fç‰åÑŸº«[1749]] = Model($Fç‰åÑŸº«[495])->userListInfo($CÌŞª²Å´ø); goto BŒê¦‘®æ´; a©‹¦‰¶Ä²: $Fç‰åÑŸº« =& $_SERVER[ªúæÂ¡­ä½]; $f„çØ÷“¨İ = array($Fç‰åÑŸº«[1750] => $dÃÉœá…ë); $a£‘ŸôïÈå = $this->where($f„çØ÷“¨İ)->find(); goto C„¾Ôİ¤Õù; C„¾Ôİ¤Õù: $DèÆø›ŸèØ = _get($a£‘ŸôïÈå, $Fç‰åÑŸº«[1745], 0); $FÕ¶ÀÒ¯±Ì = array($Fç‰åÑŸº«[253] => $DèÆø›ŸèØ, $Fç‰åÑŸº«[1749] => array()); if (!$DèÆø›ŸèØ) { return $FÕ¶ÀÒ¯±Ì; } goto B¦®‚„Ÿ¬ ; DÄÍÃŸºâ: } public function remove($E–Æ­ÊªòÇ) { $C¤Î°ÉÊö =& $_SERVER[ªúæÂ¡­ä½]; $a®¨÷¿Î… = array($C¤Î°ÉÊö[1743] => $E–Æ­ÊªòÇ); $Dğˆ„ï®¿“ = $this->where($a®¨÷¿Î…)->find(); if ($Dğˆ„ï®¿“[$C¤Î°ÉÊö[1742]]) { $this->where(array($C¤Î°ÉÊö[1743] => $Dğˆ„ï®¿“[$C¤Î°ÉÊö[1742]]))->setAdd($C¤Î°ÉÊö[1744], -1); } return $this->where($a®¨÷¿Î…)->delete(); } public function edit($C¹…ÂäÛø, $b…ÓĞĞ¤ñ–) { $Eõå ” ŠÊ =& $_SERVER[ªúæÂ¡­ä½]; $F¹£”ê„ªÅ = array($Eõå ” ŠÊ[1743] => $C¹…ÂäÛø); return $this->where($F¹£”ê„ªÅ)->save(array($Eõå ” ŠÊ[1752] => $b…ÓĞĞ¤ñ–)); } public function prasise($AÔ«ÙË‘°¦) { $d‰ê‘ªåÈñ =& $_SERVER[ªúæÂ¡­ä½]; $C¾’„´£­ = Model($d‰ê‘ªåÈñ[1753]); $fÏ®Öì‚“§ = array($d‰ê‘ªåÈñ[1743] => $AÔ«ÙË‘°¦, $d‰ê‘ªåÈñ[1536] => USER_ID); $fï©İµÃ¥‘ = $C¾’„´£­->where($fÏ®Öì‚“§)->find(); if (!$fï©İµÃ¥‘) { $C¾’„´£­->add($fÏ®Öì‚“§); $b¹×ÎéğÏ = $this->where(array($d‰ê‘ªåÈñ[1743] => $AÔ«ÙË‘°¦))->setAdd($d‰ê‘ªåÈñ[1745], 1); } else { $C¾’„´£­->where($fÏ®Öì‚“§)->delete(); $b¹×ÎéğÏ = $this->where(array($d‰ê‘ªåÈñ[1743] => $AÔ«ÙË‘°¦))->setAdd($d‰ê‘ªåÈñ[1745], -1); } return $b¹×ÎéğÏ; } public function targetInfo($EŞù²É²§Ä, $fõš ‡Ã½ ) { goto a˜šóŠÌª; EßØòÅ„ƒ: $d…Şİ†Û¼­ = "\122\x49\x47\110\x54\40\112\117\111\116\x20{$this->tablePrefix}\143\157\x6d\x6d\x65\156\x74\x5f\160\162\x61\x69\x73\x65\x20\x73\164\x61\x72\x20\157\156\x20\143\157\x6d\x6d\x65\156\164\x2e\143\157\x6d\155\x65\x6e\164\111\x44\x20\75\40\x73\164\x61\x72\x2e\x63\x6f\155\x6d\x65\156\x74\111\104"; $eÜŞİÉ’àà = $this->alias($EÎîò §È[352])->where($fÓ‰Ê ÷¤)->join($d…Şİ†Û¼­, $EÎîò §È[1754])->count(); $D¦ ÜŸ›Ôœ = array($EÎîò §È[1755] => $cÚÈ¿œá®ì, $EÎîò §È[1756] => $eÜŞİÉ’àà); goto eŒØá‹¢‚; a˜šóŠÌª: $EÎîò §È =& $_SERVER[ªúæÂ¡­ä½]; $fÓ‰Ê ÷¤ = array($EÎîò §È[563] => $EŞù²É²§Ä, $EÎîò §È[564] => $fõš ‡Ã½ ); $cÚÈ¿œá®ì = $this->where($fÓ‰Ê ÷¤)->count(); goto EßØòÅ„ƒ; eŒØá‹¢‚: return $D¦ ÜŸ›Ôœ; goto aÑŠğÈÛÇ™; aÑŠğÈÛÇ™: } public function listData($DøÆ¨æ•À) { $e¡ŠÉ‰™åĞ =& $_SERVER[ªúæÂ¡­ä½]; if (isset($DøÆ¨æ•À[$e¡ŠÉ‰™åĞ[1757]])) { if ($DøÆ¨æ•À[$e¡ŠÉ‰™åĞ[1757]]) { $DøÆ¨æ•À[$e¡ŠÉ‰™åĞ[1750]] = array($e¡ŠÉ‰™åĞ[988], intval($DøÆ¨æ•À[$e¡ŠÉ‰™åĞ[1757]])); } unset($DøÆ¨æ•À[$e¡ŠÉ‰™åĞ[1757]]); } if (isset($DøÆ¨æ•À[$e¡ŠÉ‰™åĞ[1758]])) { if ($DøÆ¨æ•À[$e¡ŠÉ‰™åĞ[1758]]) { $DøÆ¨æ•À[$e¡ŠÉ‰™åĞ[1750]] = array($e¡ŠÉ‰™åĞ[985], intval($DøÆ¨æ•À[$e¡ŠÉ‰™åĞ[1758]])); } unset($DøÆ¨æ•À[$e¡ŠÉ‰™åĞ[1758]]); } return $this->_listData($DøÆ¨æ•À); } private function _listData($Bæ™î…å´) { $BÊ¦´™é‡â =& $_SERVER[ªúæÂ¡­ä½]; $AÜÊŠŸ§È = $this->where($Bæ™î…å´)->_makeOrder()->selectPage(100); $this->_listAppendParent($AÜÊŠŸ§È[$BÊ¦´™é‡â[367]]); $this->_listAppendUser($AÜÊŠŸ§È[$BÊ¦´™é‡â[367]]); $this->_listAppendMeta($AÜÊŠŸ§È[$BÊ¦´™é‡â[367]]); return $AÜÊŠŸ§È; } private function _makeOrder() { $F§çŒ¥Üğ‹ =& $_SERVER[ªúæÂ¡­ä½]; $f°•Íµã¢ = array($F§çŒ¥Üğ‹[1745], $F§çŒ¥Üğ‹[1744], $F§çŒ¥Üğ‹[194]); $CØîãÊ¢· = Input::get($F§çŒ¥Üğ‹[436], $F§çŒ¥Üğ‹[7], $F§çŒ¥Üğ‹[417], $f°•Íµã¢); $f‹ç¯‘ÄÊÚ = Input::get($F§çŒ¥Üğ‹[437], $F§çŒ¥Üğ‹[7], $F§çŒ¥Üğ‹[1538], array($F§çŒ¥Üğ‹[1759], $F§çŒ¥Üğ‹[432])); $cÆâ­Ğß = $CØîãÊ¢· . $F§çŒ¥Üğ‹[50] . $f‹ç¯‘ÄÊÚ; return $this->order($cÆâ­Ğß); } private function _listAppendParent(&$Dùí‹òŒ¿) { goto D°ï´öÌÔ©; B¶ô¶‚ğ‹­: foreach ($Dùí‹òŒ¿ as &$c”é¢ˆŞˆ¦) { if (isset($F‚ÛİÒ ÆÊ[$c”é¢ˆŞˆ¦[$AÕ­ßÄ ›Ã[1742]]])) { $c”é¢ˆŞˆ¦[$AÕ­ßÄ ›Ã[1760]] = $F‚ÛİÒ ÆÊ[$c”é¢ˆŞˆ¦[$AÕ­ßÄ ›Ã[1742]]]; } } unset($c”é¢ˆŞˆ¦); goto eÒõ®ÕçĞ•; D°ï´öÌÔ©: $AÕ­ßÄ ›Ã =& $_SERVER[ªúæÂ¡­ä½]; $Cßó‡›Ëò = array_unique(array_to_keyvalue($Dùí‹òŒ¿, $AÕ­ßÄ ›Ã[33], $AÕ­ßÄ ›Ã[1742])); $Cßó‡›Ëò = array_remove_value($Cßó‡›Ëò, $AÕ­ßÄ ›Ã[191]); goto D˜Ûõ¤›“Â; D˜Ûõ¤›“Â: if (!$Cßó‡›Ëò) { return; } $F‚ÛİÒ ÆÊ = $this->where(array($AÕ­ßÄ ›Ã[1743] => array($AÕ­ßÄ ›Ã[7], $Cßó‡›Ëò)))->select(); $F‚ÛİÒ ÆÊ = array_to_keyvalue($F‚ÛİÒ ÆÊ, $AÕ­ßÄ ›Ã[1750]); goto B¶ô¶‚ğ‹­; eÒõ®ÕçĞ•: } private function _listAppendUser(&$AÄ¦¿îÉ®–) { goto a®ñ£¯›å˜; a®ñ£¯›å˜: $Fš×ËÒ–¡‚ =& $_SERVER[ªúæÂ¡­ä½]; $BÒ´ÁÇäœ = array_unique(array_to_keyvalue($AÄ¦¿îÉ®–, $Fš×ËÒ–¡‚[33], $Fš×ËÒ–¡‚[1545])); $BÒ´ÁÇäœ = array_remove_value($BÒ´ÁÇäœ, $Fš×ËÒ–¡‚[191]); goto Eìˆ†Ü‰”À; dÁÀ¾·‡‚„: foreach ($AÄ¦¿îÉ®– as &$A§ôÀ™ŠÜÎ) { $A§ôÀ™ŠÜÎ[$Fš×ËÒ–¡‚[576]] = $eãàâÂİãÉ[$A§ôÀ™ŠÜÎ[$Fš×ËÒ–¡‚[1545]]]; if (isset($A§ôÀ™ŠÜÎ[$Fš×ËÒ–¡‚[1760]])) { $A§ôÀ™ŠÜÎ[$Fš×ËÒ–¡‚[1760]][$Fš×ËÒ–¡‚[576]] = $eãàâÂİãÉ[$A§ôÀ™ŠÜÎ[$Fš×ËÒ–¡‚[1760]][$Fš×ËÒ–¡‚[1545]]]; } } unset($A§ôÀ™ŠÜÎ); goto A¹®‡³¼×°; Eìˆ†Ü‰”À: if (count($BÒ´ÁÇäœ) == 0) { return; } foreach ($AÄ¦¿îÉ®– as $A§ôÀ™ŠÜÎ) { if (isset($A§ôÀ™ŠÜÎ[$Fš×ËÒ–¡‚[1760]])) { $BÒ´ÁÇäœ[] = $A§ôÀ™ŠÜÎ[$Fš×ËÒ–¡‚[1760]][$Fš×ËÒ–¡‚[1545]]; } } $eãàâÂİãÉ = Model($Fš×ËÒ–¡‚[520])->userListInfo($BÒ´ÁÇäœ); goto dÁÀ¾·‡‚„; A¹®‡³¼×°: } private function _listAppendMeta(&$c…â•…ÖÌ) { goto bƒŠ“¦¡ç; bƒŠ“¦¡ç: $bÜ°óÆßÂ =& $_SERVER[ªúæÂ¡­ä½]; $fğ„§á­÷Õ = array_unique(array_to_keyvalue($c…â•…ÖÌ, $bÜ°óÆßÂ[33], $bÜ°óÆßÂ[1750])); $fğ„§á­÷Õ = array_remove_value($fğ„§á­÷Õ, $bÜ°óÆßÂ[191]); goto a£‚ÈŒÖÜ ; d¬Éø‡äñõ: if (!$B††£¼ÃŠ¬) { return !1; } foreach ($c…â•…ÖÌ as &$d¼”ÓãÊ¾Ç) { $d¼”ÓãÊ¾Ç[$bÜ°óÆßÂ[446]] = $B††£¼ÃŠ¬[$d¼”ÓãÊ¾Ç[$bÜ°óÆßÂ[1750]]]; if (isset($d¼”ÓãÊ¾Ç[$bÜ°óÆßÂ[1760]])) { $d¼”ÓãÊ¾Ç[$bÜ°óÆßÂ[1760]][$bÜ°óÆßÂ[446]] = $B††£¼ÃŠ¬[$d¼”ÓãÊ¾Ç[$bÜ°óÆßÂ[1760]][$bÜ°óÆßÂ[1750]]]; } } unset($d¼”ÓãÊ¾Ç); goto eà²‡Á”áˆ; a£‚ÈŒÖÜ : if (!$fğ„§á­÷Õ) { return; } foreach ($c…â•…ÖÌ as $d¼”ÓãÊ¾Ç) { if (isset($d¼”ÓãÊ¾Ç[$bÜ°óÆßÂ[1760]])) { $fğ„§á­÷Õ[] = $d¼”ÓãÊ¾Ç[$bÜ°óÆßÂ[1760]][$bÜ°óÆßÂ[1750]]; } } $B††£¼ÃŠ¬ = $this->metaList($fğ„§á­÷Õ); goto d¬Éø‡äñõ; eà²‡Á”áˆ: } private function metaList($Eõ®Œˆºãº) { goto b±³ÜáµË; b±³ÜáµË: $F´¦Ù ¶°„ =& $_SERVER[ªúæÂ¡­ä½]; if (!$Eõ®Œˆºãº) { return array(); } $cŞ‡ğï„± = array($F´¦Ù ¶°„[1750] => array($F´¦Ù ¶°„[7], $Eõ®Œˆºãº)); goto cˆß­áĞ £; EÍè£İ: return $FÅ…ïÂ¹¯¦ ? $FÅ…ïÂ¹¯¦ : array(); goto b¹İ’¼ø‡Ê; cˆß­áĞ £: $FÅ…ïÂ¹¯¦ = Model($F´¦Ù ¶°„[1761])->where($cŞ‡ğï„±)->select(); $FÅ…ïÂ¹¯¦ = array_to_keyvalue_group($FÅ…ïÂ¹¯¦, $F´¦Ù ¶°„[1750]); foreach ($FÅ…ïÂ¹¯¦ as $eëñ¦ßÜ½ß => $CŞ·Óİ‚„ø) { $cÎîëô–¼Ë = array(); foreach ($CŞ·Óİ‚„ø as $bÌ­Š²ç…é) { $cÎîëô–¼Ë[$bÌ­Š²ç…é[$F´¦Ù ¶°„[93]]] = $bÌ­Š²ç…é[$F´¦Ù ¶°„[372]]; } $FÅ…ïÂ¹¯¦[$eëñ¦ßÜ½ß] = $cÎîëô–¼Ë; } goto EÍè£İ; b¹İ’¼ø‡Ê: } } class FileContentModel extends ModelBase { protected $tableName = "\151\157\x5f\146\x69\x6c\145\137\x63\x6f\x6e\x74\145\156\x74\163"; protected $dataAuto = array(array("\x63\x72\145\141\x74\145\124\151\x6d\145", "\164\x69\x6d\145", "\151\x6e\163\145\162\x74", "\x66\165\x6e\143\164\151\157\x6e")); } class FileModel extends ModelBase { protected $tableName = "\151\157\x5f\146\x69\x6c\145"; protected $tableMeta = array("\164\141\142\x6c\x65\116\141\x6d\x65" => "\151\157\137\x66\151\154\x65\x5f\x6d\x65\164\141", "\x6d\x65\164\x61\x46\151\x65\154\144" => "\x66\151\154\145\111\x44"); public function fileInfo($DùÙ°Š³±Ñ) { $a§Ğ˜Ä“ÚÅ =& $_SERVER[ªúæÂ¡­ä½]; static $B‘‡¬½¹ø = array(); if (!isset($B‘‡¬½¹ø[$DùÙ°Š³±Ñ])) { $FÕº¿Æíß³ = $a§Ğ˜Ä“ÚÅ[1762]; $AÑ†åÏË… = Model($a§Ğ˜Ä“ÚÅ[451])->field($FÕº¿Æíß³)->where(array($a§Ğ˜Ä“ÚÅ[449] => $DùÙ°Š³±Ñ))->find(); $B‘‡¬½¹ø[$DùÙ°Š³±Ñ] = $AÑ†åÏË…; } return $B‘‡¬½¹ø[$DùÙ°Š³±Ñ]; } public function addFileByContent($Bª˜Æ”Ñ¶³ = '', $AÃ§ò¡Ñá‚ = '') { goto c„ˆã†İëƒ; B“—‰“…¼: $dŞ³ë†µ™å = $d¤É‹¯ÄŠÔ . $eí¥§íì[1764] . rand_string(16); file_put_contents($dŞ³ë†µ™å, $Bª˜Æ”Ñ¶³); $d™¤¢À¿çó = $this->addFile($dŞ³ë†µ™å, $AÃ§ò¡Ñá‚, !0); goto cá„¦µ…óÄ; c„ˆã†İëƒ: $eí¥§íì =& $_SERVER[ªúæÂ¡­ä½]; $d¤É‹¯ÄŠÔ = TEMP_PATH . $eí¥§íì[1763]; if (!is_dir($d¤É‹¯ÄŠÔ)) { mk_dir($d¤É‹¯ÄŠÔ); } goto B“—‰“…¼; cá„¦µ…óÄ: if (file_exists($dŞ³ë†µ™å)) { @unlink($dŞ³ë†µ™å); } return $d™¤¢À¿çó; goto bÉğİìœ‰î; bÉğİìœ‰î: } public function createFileName($Cƒß³•ï¼ù, $AŒŒ…¿³¾ = false, $a¸Ğ¯Í¶® = false) { goto FËòÍåóíø; BÀ†ã‰—»: $Bçëõ¸Ã²  = $aÖŒ…¯ŞÀ¯->pathFather($e˜‚†–ˆÅÆ); static $e†‚Ş©ç¡ = false; $b‘éã¬™ = $A—™Í³Ç†[1765] . md5($Bçëõ¸Ã² ); goto DŸ²¨¥¤; DŸ²¨¥¤: if (!$e†‚Ş©ç¡ && !Cache::get($b‘éã¬™)) { $e†‚Ş©ç¡ = !0; $FÎÔŒôªš = IO::mkdir($Bçëõ¸Ã² ); if (!IO::exist($FÎÔŒôªš . $A—™Í³Ç†[779])) { IO::mkfile($FÎÔŒôªš . $A—™Í³Ç†[779]); } Cache::set($b‘éã¬™, 1, 3600 * 2); } return $e˜‚†–ˆÅÆ; goto b­Œ£¿†²î; FËòÍåóíø: $A—™Í³Ç† =& $_SERVER[ªúæÂ¡­ä½]; $aÖŒ…¯ŞÀ¯ = IO::init($A—™Í³Ç†[8]); $e˜‚†–ˆÅÆ = $this->makeFilePath($Cƒß³•ï¼ù, $aÖŒ…¯ŞÀ¯, $AŒŒ…¿³¾, $a¸Ğ¯Í¶®); goto BÀ†ã‰—»; b­Œ£¿†²î: } public function makeFilePath($aªæì½‘›—, $A²Ù—³ĞƒÛ, $díÑ°œ¶ƒº = false, $DÍíÎÀôÏ¦ = false) { goto BÊ“ŞôªÏ; BÊ“ŞôªÏ: $AÊÇÏ‰†Šã =& $_SERVER[ªúæÂ¡­ä½]; $EÀÌµ¥ß¾å = Model($AÊÇÏ‰†Šã[748])->get($AÊÇÏ‰†Šã[1766]); $a¡‹Ğˆó‘© = KodIO::defaultIO() . date($AÊÇÏ‰†Šã[1767]); goto d´‹Œ½‡; a„£¾èåƒê: if (!$aªæì½‘›—) { $EÀÌµ¥ß¾å = $AÊÇÏ‰†Šã[1768]; } switch ($EÀÌµ¥ß¾å) { case $AÊÇÏ‰†Šã[1769]: $Dæ¶¤„á‹¥ = $Dæ¶¤„á‹¥ . $AÊÇÏ‰†Šã[95] . $A²Ù—³ĞƒÛ->ext($aªæì½‘›—); if ($D¥ï—ˆùŒ == $AÊÇÏ‰†Šã[1704]) { $Dæ¶¤„á‹¥ .= $AÊÇÏ‰†Šã[1441]; } break; case $AÊÇÏ‰†Šã[1770]: goto b—Ó’ªìØ¥; b—Ó’ªìØ¥: $dÆ£š™ÎõŒ = Model($AÊÇÏ‰†Šã[748])->get($AÊÇÏ‰†Šã[749]); $e­³ÊØî‹– = substr(md5($AÊÇÏ‰†Šã[750] . $dÆ£š™ÎõŒ . date($AÊÇÏ‰†Šã[726])), 0, 8); $eÆÎÊ Ÿï  = KodIO::defaultDriver(); goto e°‹¸›ÁŠ·; e°‹¸›ÁŠ·: $a¡‹Ğˆó‘© = $AÊÇÏ‰†Šã[1139] . $eÆÎÊ Ÿï [$AÊÇÏ‰†Šã[394]] . $AÊÇÏ‰†Šã[403] . date($AÊÇÏ‰†Šã[1771]) . $e­³ÊØî‹– . $AÊÇÏ‰†Šã[8]; if ($D¥ï—ˆùŒ == $AÊÇÏ‰†Šã[1704]) { $aªæì½‘›— .= $AÊÇÏ‰†Šã[1441]; } $DŠ×ò³òÛ = $AÊÇÏ‰†Šã[1772] . $a¡‹Ğˆó‘© . $aªæì½‘›—; goto F”ñáÉ¿Í; F”ñáÉ¿Í: CacheLock::lock($DŠ×ò³òÛ); $Dæ¶¤„á‹¥ = $a¡‹Ğˆó‘© . $aªæì½‘›—; if (IO::exist($a¡‹Ğˆó‘© . $aªæì½‘›—)) { $Fí˜°¸Í÷Â = substr($aªæì½‘›—, 0, strlen($aªæì½‘›—) - strlen($D¥ï—ˆùŒ)); $B½í¢Ô–œÃ = $DÍíÎÀôÏ¦ ? substr($DÍíÎÀôÏ¦, 0, 5) : ($díÑ°œ¶ƒº ? substr($díÑ°œ¶ƒº, 0, 5) : rand_string(5)); $Dæ¶¤„á‹¥ = $a¡‹Ğˆó‘© . $Fí˜°¸Í÷Â . $B½í¢Ô–œÃ . $AÊÇÏ‰†Šã[95] . $D¥ï—ˆùŒ; } goto aõù™¾¤Ëã; aõù™¾¤Ëã: if (IO::isTypeObject($Dæ¶¤„á‹¥) && !IO::isUploadServer($Dæ¶¤„á‹¥)) { if (IO::exist($Dæ¶¤„á‹¥)) { return $Dæ¶¤„á‹¥; } $B¥Ù÷ñÌ¾Ñ = IO::setContent($Dæ¶¤„á‹¥, $AÊÇÏ‰†Šã[33]); if (!$B¥Ù÷ñÌ¾Ñ) { show_json($AÊÇÏ‰†Šã[1773], !1); } } CacheLock::unlock($DŠ×ò³òÛ); break; goto FÔŠŒë±ÙŸ; FÔŠŒë±ÙŸ: case $AÊÇÏ‰†Šã[1768]: break; default: break; } return $Dæ¶¤„á‹¥; goto Eš¤¾áÀÈ·; d´‹Œ½‡: $Dæ¶¤„á‹¥ = $a¡‹Ğˆó‘© . rand_string(5) . short_id(100); $aªæì½‘›— = str_replace($AÊÇÏ‰†Šã[8], $AÊÇÏ‰†Šã[71], KodIO::clear($aªæì½‘›—)); $D¥ï—ˆùŒ = $A²Ù—³ĞƒÛ->ext($aªæì½‘›—); goto a„£¾èåƒê; Eš¤¾áÀÈ·: } public function addFileByRemote($BÄÑŞÙìÂó, $D¦´Ëó¸Ùö, $c¯„Î“îê¡ = array()) { goto EƒéÒêÄÄˆ; Fˆ½À¨Õ”¶: $DƒÀÃ±Õ¦ = IO::hashMd5($BÄÑŞÙìÂó, $f´Œ¢ÎÒ£); $c¸Îœ·¡Å = KodIO::defaultDriver(); $fºâÇËÒíÀ = array($AÆĞãèÃµÌ[562] => IO::size($BÄÑŞÙìÂó), $AÆĞãèÃµÌ[1774] => 1, $AÆĞãèÃµÌ[414] => $D¦´Ëó¸Ùö, $AÆĞãèÃµÌ[791] => $c¸Îœ·¡Å[$AÆĞãèÃµÌ[394]], $AÆĞãèÃµÌ[415] => $BÄÑŞÙìÂó, $AÆĞãèÃµÌ[1775] => $c¯„Î“îê¡[$AÆĞãèÃµÌ[171]] ? $c¯„Î“îê¡[$AÆĞãèÃµÌ[171]] : IO::hashSimple($BÄÑŞÙìÂó), $AÆĞãèÃµÌ[1776] => $DƒÀÃ±Õ¦ ? $DƒÀÃ±Õ¦ : $f´Œ¢ÎÒ£); goto D´ô‰àÑ¨Œ; D´ô‰àÑ¨Œ: if ($cÉ…¨¶Î¬­ = $this->addFileCheckExist($fºâÇËÒíÀ[$AÆĞãèÃµÌ[171]], $fºâÇËÒíÀ[$AÆĞãèÃµÌ[170]], $fºâÇËÒíÀ[$AÆĞãèÃµÌ[78]])) { return $cÉ…¨¶Î¬­; } return $this->addFileData($fºâÇËÒíÀ); goto CÖø¨ù’Âã; EƒéÒêÄÄˆ: $AÆĞãèÃµÌ =& $_SERVER[ªúæÂ¡­ä½]; if (!IO::exist($BÄÑŞÙìÂó)) { return !1; } $f´Œ¢ÎÒ£ = $c¯„Î“îê¡[$AÆĞãèÃµÌ[170]] ? $c¯„Î“îê¡[$AÆĞãèÃµÌ[170]] : $AÆĞãèÃµÌ[33]; goto Fˆ½À¨Õ”¶; CÖø¨ù’Âã: } private function addFileData($aİ…õÀ…é) { $B‘ùåçè” =& $_SERVER[ªúæÂ¡­ä½]; if (!$aİ…õÀ…é) { return !1; } $aİ…õÀ…é[$B‘ùåçè”[78]] = intval($aİ…õÀ…é[$B‘ùåçè”[78]]); if (!$aİ…õÀ…é[$B‘ùåçè”[78]] && strlen($aİ…õÀ…é[$B‘ùåçè”[171]]) > 32) { $aİ…õÀ…é[$B‘ùåçè”[78]] = intval(substr($aİ…õÀ…é[$B‘ùåçè”[171]], 32)); } $c¬ÀŠ„“ŒÚ = $this->add($aİ…õÀ…é); return $this->find($c¬ÀŠ„“ŒÚ); } public function addFile($F÷‚”‡Ï§Ü, $cğ³‹¤‰¢§, $eÈêËšò÷å = false) { goto cˆ–ÛÏ­Îˆ; e‘ÖŞÉÁ¤ß: return $A“Å¦‘Â°Ğ; goto b¸êò¾Äòá; cˆ–ÛÏ­Îˆ: $dÙøˆá‚ãõ = IO::hashSimple($F÷‚”‡Ï§Ü); $d°„°Øï = IO::hashMd5($F÷‚”‡Ï§Ü); $aà›ßÄ®¤é = IO::size($F÷‚”‡Ï§Ü); goto d÷¥À¯¿Àˆ; d÷¥À¯¿Àˆ: $b”ˆò•Ä»Ù = $_SERVER[ªúæÂ¡­ä½][1777] . $d°„°Øï; CacheLock::lock($b”ˆò•Ä»Ù); if ($cï¿ÓÃÁñ£ = $this->addFileCheckExist($dÙøˆá‚ãõ, $d°„°Øï, $aà›ßÄ®¤é)) { CacheLock::unlock($b”ˆò•Ä»Ù); return $cï¿ÓÃÁñ£; } goto F›Ô¶Á× ÷; F›Ô¶Á× ÷: $D÷ñ¢“ùä‡ = $this->addFileMake($F÷‚”‡Ï§Ü, $aà›ßÄ®¤é, $dÙøˆá‚ãõ, $d°„°Øï, $cğ³‹¤‰¢§, $eÈêËšò÷å); $A“Å¦‘Â°Ğ = $this->addFileData($D÷ñ¢“ùä‡); CacheLock::unlock($b”ˆò•Ä»Ù); goto e‘ÖŞÉÁ¤ß; b¸êò¾Äòá: } public function addFileMake($C¿ô¬Òğ÷ì, $D†›ê³—†‡, $E§¬ß½ˆÃµ, $dìÍÌÒ¦ò, $féº”íÔñ´, $Aß¹Â†Î) { goto dÍ¬­ÍªÈ’; cŠÔºÅ­é: $e§¬æÛ‘Ü = KodIO::defaultDriver(); $cÊåçŒ¥å = array($aÅ„é–óŞÑ[562] => $D†›ê³—†‡, $aÅ„é–óŞÑ[1774] => 1, $aÅ„é–óŞÑ[414] => $féº”íÔñ´, $aÅ„é–óŞÑ[791] => $e§¬æÛ‘Ü[$aÅ„é–óŞÑ[394]], $aÅ„é–óŞÑ[415] => $aâÅØ¢îäè, $aÅ„é–óŞÑ[1775] => $E§¬ß½ˆÃµ, $aÅ„é–óŞÑ[1776] => $dìÍÌÒ¦ò); return $cÊåçŒ¥å; goto c¾©Ú‘‰ƒË; Aã––†¾ó‘: $bˆ°¤ÊÚ = get_path_this($aâÅØ¢îäè); if ($Aß¹Â†Î) { $E¢†îÊÃÉ = IO::move($C¿ô¬Òğ÷ì, $dàÀ½Ï´¾£, !1, $bˆ°¤ÊÚ); } else { $E¢†îÊÃÉ = IO::copy($C¿ô¬Òğ÷ì, $dàÀ½Ï´¾£, !1, $bˆ°¤ÊÚ); } if (!$E¢†îÊÃÉ) { return !1; } goto cŠÔºÅ­é; dÍ¬­ÍªÈ’: $aÅ„é–óŞÑ =& $_SERVER[ªúæÂ¡­ä½]; $aâÅØ¢îäè = $this->createFileName($féº”íÔñ´, $E§¬ß½ˆÃµ, $dìÍÌÒ¦ò); $dàÀ½Ï´¾£ = get_path_father($aâÅØ¢îäè); goto Aã––†¾ó‘; c¾©Ú‘‰ƒË: } public function addFileCheckExist($F‹Â¡Í–Ÿ†, $d½æÒáˆà, $bäÓë†×¿Õ) { $CÊã­Û·¿ =& $_SERVER[ªúæÂ¡­ä½]; $bá…ßÏ¢ñÄ = $this->findByHash($F‹Â¡Í–Ÿ†, $d½æÒáˆà); if (!$bá…ßÏ¢ñÄ) { return !1; } $a‡›á·æÛ× = array($CÊã­Û·¿[1774] => intval($bá…ßÏ¢ñÄ[$CÊã­Û·¿[1778]]) + 1, $CÊã­Û·¿[562] => $bäÓë†×¿Õ); $this->where(array($CÊã­Û·¿[449] => $bá…ßÏ¢ñÄ[$CÊã­Û·¿[448]]))->save($a‡›á·æÛ×); return $bá…ßÏ¢ñÄ; } public function remove($b„ÒÖ· ª) { $this->linkCountChange($b„ÒÖ· ª, !1); $this->clearEmpty(); return !0; } public function linkAdd($Dèõñƒ†Œ) { $this->linkCountChange($Dèõñƒ†Œ, !0); } public function linkCountChange($EËâŠƒÂ«, $BÜ´î·Äğ) { goto fóƒŸ¦ÅÑÌ; fóƒŸ¦ÅÑÌ: $cœŒ½¢…œ =& $_SERVER[ªúæÂ¡­ä½]; if (!$EËâŠƒÂ«) { return; } if (!is_array($EËâŠƒÂ«)) { $EËâŠƒÂ« = array($EËâŠƒÂ«); } goto FÊÆêğÈòê; c´†”‘³ï˜: foreach ($F¹ë¥¼ŞÂ as $B…ÆñÁ‘õ× => $fÒÛŠ¡«®¯) { $A§åœ¯Œ×ô = $fÒÛŠ¡«®¯ . $cœŒ½¢…œ[33]; if (!$B¯»…Ïï¨[$A§åœ¯Œ×ô]) { $B¯»…Ïï¨[$A§åœ¯Œ×ô] = array(); } $B¯»…Ïï¨[$A§åœ¯Œ×ô][] = $B…ÆñÁ‘õ×; } foreach ($B¯»…Ïï¨ as $fÒÛŠ¡«®¯ => $C•Ê‹ë«‡Ú) { if (!$C•Ê‹ë«‡Ú) { continue; } $fÒÛŠ¡«®¯ = $BÜ´î·Äğ ? $fÒÛŠ¡«®¯ : -intval($fÒÛŠ¡«®¯); $bö”ìôÎ® = array($cœŒ½¢…œ[448] => array($cœŒ½¢…œ[7], $C•Ê‹ë«‡Ú)); if ($fÒÛŠ¡«®¯ < 0) { $bö”ìôÎ®[$cœŒ½¢…œ[1778]] = array($cœŒ½¢…œ[989], abs($fÒÛŠ¡«®¯)); } $this->where($bö”ìôÎ®)->setAdd($cœŒ½¢…œ[1778], $fÒÛŠ¡«®¯); } goto FéŸ…‘‡Ôì; FÊÆêğÈòê: $F¹ë¥¼ŞÂ = array(); foreach ($EËâŠƒÂ« as $B…ÆñÁ‘õ×) { $A§åœ¯Œ×ô = $B…ÆñÁ‘õ× . $cœŒ½¢…œ[33]; if (!$F¹ë¥¼ŞÂ[$A§åœ¯Œ×ô]) { $F¹ë¥¼ŞÂ[$A§åœ¯Œ×ô] = 0; } $F¹ë¥¼ŞÂ[$A§åœ¯Œ×ô]++; } $B¯»…Ïï¨ = array(); goto c´†”‘³ï˜; FéŸ…‘‡Ôì: } public function findByHash($cáÉ–ÏµÄá, $d´Ş¸‚¤½À = false) { $eÙÊµµàÑè =& $_SERVER[ªúæÂ¡­ä½]; if (!$cáÉ–ÏµÄá && !$d´Ş¸‚¤½À) { return !1; } $B¼ˆ•ùö‹ = array($eÙÊµµàÑè[1775] => $cáÉ–ÏµÄá); if ($d´Ş¸‚¤½À) { $B¼ˆ•ùö‹ = array($eÙÊµµàÑè[1776] => $d´Ş¸‚¤½À); } return $this->order($eÙÊµµàÑè[1779])->where($B¼ˆ•ùö‹)->find(); } public function clearEmpty($FÒ´ßŠ×²¸ = 0) { goto EòŞªà…¿; EòŞªà…¿: $DÀĞ®¿°º =& $_SERVER[ªúæÂ¡­ä½]; $E£¬ö°ã‹İ = time() - 3600 * 24 * $FÒ´ßŠ×²¸; $BğªÅÈ«Âİ = $DÀĞ®¿°º[1780] . $E£¬ö°ã‹İ; goto EÄâ„“´ãô; bØ’ƒîÍù†: foreach ($E¤¨ÁÉ•½¢ as $cÎšòÔõÉ) { $cìÚîÌ­Í“->update(1); $this->resetFile($cÎšòÔõÉ); } $cìÚîÌ­Í“->end(); goto A«¶™ÍÚ·; EÄâ„“´ãô: $E¤¨ÁÉ•½¢ = $this->where($BğªÅÈ«Âİ)->select(); if (!$E¤¨ÁÉ•½¢) { return; } $cìÚîÌ­Í“ = new Task($DÀĞ®¿°º[1781], $DÀĞ®¿°º[33], count($E¤¨ÁÉ•½¢)); goto bØ’ƒîÍù†; A«¶™ÍÚ·: } public function resetFile($bÌß“ˆâ) { goto fŸêŸ‰‰ì¬; e¤ÙÈÒ¢„‚: if ($bÌß“ˆâ[$aõ©‚„²³ï[1778]] != $b„Ù•ÍÜí) { $this->where($c¾½ä‘õåğ)->save(array($aõ©‚„²³ï[1774] => $b„Ù•ÍÜí)); } goto A”ÒˆÑ‡¡; C±¬ÒåÚ–¶: $B—ˆØµÅÔ– = Model($aõ©‚„²³ï[1782])->where($c¾½ä‘õåğ)->count(); $b„Ù•ÍÜí = intval($fù‚Œ×Ş¨„) + intval($B—ˆØµÅÔ–); if ($b„Ù•ÍÜí == 0) { IO::remove($bÌß“ˆâ[$aõ©‚„²³ï[76]]); Model($aõ©‚„²³ï[1783])->delete($bÌß“ˆâ[$aõ©‚„²³ï[448]]); $this->where($c¾½ä‘õåğ)->delete(); $this->metaSet($bÌß“ˆâ[$aõ©‚„²³ï[448]], null, null); return; } goto e¤ÙÈÒ¢„‚; fŸêŸ‰‰ì¬: $aõ©‚„²³ï =& $_SERVER[ªúæÂ¡­ä½]; $c¾½ä‘õåğ = array($aõ©‚„²³ï[449] => $bÌß“ˆâ[$aõ©‚„²³ï[448]]); $fù‚Œ×Ş¨„ = Model($aõ©‚„²³ï[1221])->where($c¾½ä‘õåğ)->count(); goto C±¬ÒåÚ–¶; A”ÒˆÑ‡¡: } public function storageInfo($EˆâØëÉœÀ = false) { goto EîËÚƒÂ¿‹; EîËÚƒÂ¿‹: $Cæ˜ÉÚøé =& $_SERVER[ªúæÂ¡­ä½]; $D¯¨œ¡°Ç… = $this->count() + 0.0; $B¤¼²İ²âˆ = 0; goto e¢Üôçƒ×Ç; b‹Ï…í­: for ($f¸º ±ĞóÛ = 0; $f¸º ±ĞóÛ < $D¯¨œ¡°Ç…; $f¸º ±ĞóÛ = $f¸º ±ĞóÛ + $B™èãÖ¶˜Ú) { $d•äµ¥ğ¿¾ = $this->limit($f¸º ±ĞóÛ, $f¸º ±ĞóÛ + $B™èãÖ¶˜Ú)->select(); foreach ($d•äµ¥ğ¿¾ as $A³øµÌº) { $AÁŸ«Ã¹ãÙ += $A³øµÌº[$Cæ˜ÉÚøé[78]] * $A³øµÌº[$Cæ˜ÉÚøé[1778]]; $B¤¼²İ²âˆ += $A³øµÌº[$Cæ˜ÉÚøé[78]] * ($A³øµÌº[$Cæ˜ÉÚøé[1778]] - 1); $cŞÆœÊ×ÚË += $A³øµÌº[$Cæ˜ÉÚøé[1778]]; } } $bğÈøÛæ† = array($Cæ˜ÉÚøé[1784] => $AÁŸ«Ã¹ãÙ, $Cæ˜ÉÚøé[1785] => $B¤¼²İ²âˆ, $Cæ˜ÉÚøé[1786] => $B¤¼²İ²âˆ / $AÁŸ«Ã¹ãÙ, $Cæ˜ÉÚøé[82] => $D¯¨œ¡°Ç…, $Cæ˜ÉÚøé[1787] => $cŞÆœÊ×ÚË); return $bğÈøÛæ†; goto F‰®à¦¿»; e¢Üôçƒ×Ç: $AÁŸ«Ã¹ãÙ = 1; $cŞÆœÊ×ÚË = 0; $B™èãÖ¶˜Ú = 5000; goto b‹Ï…í­; F‰®à¦¿»: } } goto dò¹ìßÖ—„; cÑœóèî”: class PathDriverOOS extends PathDriverBaseS3 { public function __construct($b¦®‚ã¾…Ú) { parent::__construct($b¦®‚ã¾…Ú); $this->signatureVersion($_SERVER[ªúæÂ¡­ä½][212]); } public function fileOutLink($cÕãÇ¤) { $cª±ÀğÒÓ¯ =& $_SERVER[ªúæÂ¡­ä½]; if (substr($cÕãÇ¤, 0, 7) == $cª±ÀğÒÓ¯[1219]) { $cÕãÇ¤ = $cª±ÀğÒÓ¯[1220] . substr($cÕãÇ¤, 7); } header($cª±ÀğÒÓ¯[159] . $cÕãÇ¤); die; } } class PathDriverOSS extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $bucket = ''; protected $bucketAcl = ''; protected $endpoint = null; protected $client = null; public $ioUploadServer = "\x30"; public $ioFileOutServer = "\x30"; public $cdnHost = ''; public function __construct($EÓõ§í©œ›) { parent::__construct(); include_once SDK_DIR . $_SERVER[ªúæÂ¡­ä½][1275]; $this->_init($EÓõ§í©œ›); } public function _init($BÈÃ½Œ˜) { $cùÎ¸šÅ– =& $_SERVER[ªúæÂ¡­ä½]; foreach ($BÈÃ½Œ˜ as $dÇÇ×ÂÕÛ° => $b˜Ÿ’˜Á¡º) { if (isset($this->{$dÇÇ×ÂÕÛ°})) { $this->{$dÇÇ×ÂÕÛ°} = $b˜Ÿ’˜Á¡º; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { throw new Exception($cùÎ¸šÅ–[1276] . LNG($cùÎ¸šÅ–[1277])); } $this->client = new OSS\OssClient($this->accessKey, $this->secret, $this->domain); $this->client->setConnectTimeout(60); } public function setBucketCors() { goto e…ºÀºÎ—Œ; f¼¹ÃºãÀÏ: $cŞâ¦‘ã»->setMaxAgeSeconds(600); $cŞâ¦‘ã»->addExposeHeader($Dçˆ´Ëª–[1283]); $cŞâ¦‘ã»->addAllowedHeader($Dçˆ´Ëª–[1278]); goto b–ÒöÙÍ; Bäå¿±·: $cŞâ¦‘ã»->addAllowedOrigin($Dçˆ´Ëª–[1278]); $cŞâ¦‘ã»->addAllowedMethod($Dçˆ´Ëª–[1279]); $cŞâ¦‘ã»->addAllowedMethod($Dçˆ´Ëª–[1280]); goto AÊ¯÷¾¸ìë; b–ÒöÙÍ: $A—‹×—Ââ->addRule($cŞâ¦‘ã»); try { $this->client->putBucketCors($this->bucket, $A—‹×—Ââ); } catch (OSS\Core\OssException $c‚®òò÷•¯) { return !1; } return !0; goto EôË‹ª•ƒÎ; AÊ¯÷¾¸ìë: $cŞâ¦‘ã»->addAllowedMethod($Dçˆ´Ëª–[1281]); $cŞâ¦‘ã»->addAllowedMethod($Dçˆ´Ëª–[1282]); $cŞâ¦‘ã»->addAllowedMethod($Dçˆ´Ëª–[158]); goto f¼¹ÃºãÀÏ; e…ºÀºÎ—Œ: $Dçˆ´Ëª– =& $_SERVER[ªúæÂ¡­ä½]; $A—‹×—Ââ = new OSS\Model\CorsConfig(); $cŞâ¦‘ã» = new OSS\Model\CorsRule(); goto Bäå¿±·; EôË‹ª•ƒÎ: } public function getBucketCors() { goto Fô˜ğ³ÀÒ§; CÅ‹•‡ÈÖ: $eŒˆ‚¬‘¸Û = $A¾å¥ôĞä[0]->getMaxAgeSeconds(); $bÅïÀ‘Õ…Á = $A¾å¥ôĞä[0]->getExposeHeaders(); $AùÍ•¸ªé = $A¾å¥ôĞä[0]->getAllowedHeaders(); goto AŸ¯Ğ‹›×; AŸ¯Ğ‹›×: return array($díº–·¡Ô¤[181] => isset($dĞ—„òéÄ©[0]) ? $dĞ—„òéÄ©[0] : $díº–·¡Ô¤[33], $díº–·¡Ô¤[185] => $AÍ™¾‚å…Ò, $díº–·¡Ô¤[1284] => $eŒˆ‚¬‘¸Û, $díº–·¡Ô¤[1285] => isset($bÅïÀ‘Õ…Á[0]) ? $bÅïÀ‘Õ…Á[0] : $díº–·¡Ô¤[33], $díº–·¡Ô¤[183] => isset($AùÍ•¸ªé[0]) ? $AùÍ•¸ªé[0] : $díº–·¡Ô¤[33]); goto dÚÛõ¹Î; Fô˜ğ³ÀÒ§: $díº–·¡Ô¤ =& $_SERVER[ªúæÂ¡­ä½]; $b÷¹¿™ˆ‘§ = null; try { $b÷¹¿™ˆ‘§ = $this->client->getBucketCors($this->bucket); } catch (OSS\Core\OssException $A‚ Ä‰ƒÙ¨) { return null; } goto a·ö†ªõƒ—; a·ö†ªõƒ—: if (!$b÷¹¿™ˆ‘§ || !($A¾å¥ôĞä = $b÷¹¿™ˆ‘§->getRules())) { return null; } $dĞ—„òéÄ© = $A¾å¥ôĞä[0]->getAllowedOrigins(); $AÍ™¾‚å…Ò = $A¾å¥ôĞä[0]->getAllowedMethods(); goto CÅ‹•‡ÈÖ; dÚÛõ¹Î: } public function isBucketCors() { goto AÃ’¬Ñ«ùà; AÃ’¬Ñ«ùà: $B˜ñ‚İ£™ =& $_SERVER[ªúæÂ¡­ä½]; $a¥©–Û¦‡Ø = $this->getBucketCors(); if (!$a¥©–Û¦‡Ø || !is_array($a¥©–Û¦‡Ø)) { return !1; } goto CÆâ¯Ó½Ú; dá±Êê‹¸”: $a˜óÁÑ§‚ê = array($B˜ñ‚İ£™[186], $B˜ñ‚İ£™[187], $B˜ñ‚İ£™[188], $B˜ñ‚İ£™[189], $B˜ñ‚İ£™[190]); $bĞƒ‡Ü‹™È = array_diff($a˜óÁÑ§‚ê, $Dã‘ñ¿¦½); return empty($bĞƒ‡Ü‹™È); goto bÓÒ†Üèì…; CÆâ¯Ó½Ú: if ($a¥©–Û¦‡Ø[$B˜ñ‚İ£™[181]] != $B˜ñ‚İ£™[182] || $a¥©–Û¦‡Ø[$B˜ñ‚İ£™[183]] != $B˜ñ‚İ£™[182]) { return !1; } $Dã‘ñ¿¦½ = array_map($B˜ñ‚İ£™[184], $a¥©–Û¦‡Ø[$B˜ñ‚İ£™[185]]); if (!is_array($Dã‘ñ¿¦½)) { $Dã‘ñ¿¦½ = array(); } goto dá±Êê‹¸”; bÓÒ†Üèì…: } public function mkfile($fç³’ºñÚ, $E‚É˜ÛÇøß = '', $EŠ…Ò¯ù— = REPEAT_RENAME) { $cè‚›µ ‰Í = $this->setContent($fç³’ºñÚ, $E‚É˜ÛÇøß); if ($cè‚›µ ‰Í !== !1) { return $this->getPathOuter($fç³’ºñÚ); } return !1; } public function mkdir($d¹ÉÁÕçåñ, $eÓ¢‹³¦¼í = REPEAT_SKIP) { if ($this->_isFolder($d¹ÉÁÕçåñ)) { return $this->getPathOuter($d¹ÉÁÕçåñ); } try { $this->client->createObjectDir($this->bucket, $this->pathEncode($d¹ÉÁÕçåñ)); } catch (OSS\Core\OssException $fÏ‹¨¤…ò¶) { return !1; } return $this->getPathOuter($d¹ÉÁÕçåñ); } private function fileList($fŠƒ¯Úåó¥, $Eğëãàò„Ë = '', $cäˆƒğÖ¥¶ = 0) { goto eˆèƒ­ª˜º; e Ôâˆ©œÄ: $AÑŒ¯Â†™ = $cÅ‹²¡‡œÉ[33]; $FÀƒ²Ú±á = 1000; $aá›íÏ‰‰› = $this->listItemCache === !1 ? !1 : !0; goto b‹©ª¯ªÖè; eˆèƒ­ª˜º: $cÅ‹²¡‡œÉ =& $_SERVER[ªúæÂ¡­ä½]; $fŠƒ¯Úåó¥ = trim($fŠƒ¯Úåó¥, $cÅ‹²¡‡œÉ[8]); $b¨Â§èÔ©ä = empty($fŠƒ¯Úåó¥) && $fŠƒ¯Úåó¥ !== $cÅ‹²¡‡œÉ[191] ? $cÅ‹²¡‡œÉ[33] : $fŠƒ¯Úåó¥ . $cÅ‹²¡‡œÉ[8]; goto e Ôâˆ©œÄ; b‹©ª¯ªÖè: $Eø¹Óºç¿ = $CºæÑ…ëá = array(); while (!0) { check_abort(); $FÅàÀ‰Æ˜ = array($cÅ‹²¡‡œÉ[1286] => $Eğëãàò„Ë, $cÅ‹²¡‡œÉ[1287] => $b¨Â§èÔ©ä, $cÅ‹²¡‡œÉ[1288] => $FÀƒ²Ú±á, $cÅ‹²¡‡œÉ[1289] => $AÑŒ¯Â†™); try { $DÜ»ŸˆŒõö = $this->client->listObjects($this->bucket, $FÅàÀ‰Æ˜); } catch (OSS\Core\OssException $eŞ¶‹Õ‰ÄÙ) { break; } $AÑŒ¯Â†™ = $DÜ»ŸˆŒõö->getNextMarker(); $aê¹šÀÚØÜ = $DÜ»ŸˆŒõö->getObjectList(); $Fò¨ÄÆÔò… = $DÜ»ŸˆŒõö->getPrefixList(); foreach ($aê¹šÀÚØÜ as $d‘’º«ÙÍ) { goto eó‘Æëïß¬; dç²ÔÃ¿Ï: $D°å‹¯»‰ = $d‘’º«ÙÍ->getLastModified(); $aëÊ«ˆ±Â× = $cäˆƒğÖ¥¶ ? array($cÅ‹²¡‡œÉ[28] => $dŠŒªè·ƒ¦, $cÅ‹²¡‡œÉ[78] => $cğ¬½÷Û¤ò, $cÅ‹²¡‡œÉ[197] => strtotime($D°å‹¯»‰)) : $dŠŒªè·ƒ¦; $AâÎ­ßƒ = $cğ¬½÷Û¤ò == 0 && substr($dŠŒªè·ƒ¦, strlen($dŠŒªè·ƒ¦) - 1, 1) == $cÅ‹²¡‡œÉ[8] ? !0 : !1; goto A•è®ÎÀ·ˆ; eó‘Æëïß¬: if ($d‘’º«ÙÍ->getKey() == $b¨Â§èÔ©ä) { continue; } $dŠŒªè·ƒ¦ = $d‘’º«ÙÍ->getKey(); $cğ¬½÷Û¤ò = $d‘’º«ÙÍ->getSize(); goto dç²ÔÃ¿Ï; A•è®ÎÀ·ˆ: if ($aá›íÏ‰‰›) { $this->cacheMethod($cÅ‹²¡‡œÉ[199], $dŠŒªè·ƒ¦, $AâÎ­ßƒ); $this->cacheMethod($cÅ‹²¡‡œÉ[200], $dŠŒªè·ƒ¦, array($cÅ‹²¡‡œÉ[78] => $cğ¬½÷Û¤ò, $cÅ‹²¡‡œÉ[1290] => $cğ¬½÷Û¤ò, $cÅ‹²¡‡œÉ[84] => strtotime($D°å‹¯»‰), $cÅ‹²¡‡œÉ[1291] => $D°å‹¯»‰)); } if ($AâÎ­ßƒ) { $Eø¹Óºç¿[] = $dŠŒªè·ƒ¦; continue; } $CºæÑ…ëá[] = $aëÊ«ˆ±Â×; goto eù× ¦ÆäÎ; eù× ¦ÆäÎ: } foreach ($Fò¨ÄÆÔò… as $C÷öåÌ²Ôæ) { $Eø¹Óºç¿[] = $C÷öåÌ²Ôæ->getPrefix(); if ($aá›íÏ‰‰›) { $this->cacheMethod($cÅ‹²¡‡œÉ[199], $dŠŒªè·ƒ¦, !0); } } if ($AÑŒ¯Â†™ === $cÅ‹²¡‡œÉ[33]) { break; } } if ($aá›íÏ‰‰›) { $this->cacheMethod($cÅ‹²¡‡œÉ[199], $fŠƒ¯Úåó¥, !0); } goto f†Áå«„Ú´; f†Áå«„Ú´: return array($cÅ‹²¡‡œÉ[75] => $Eø¹Óºç¿, $cÅ‹²¡‡œÉ[74] => $CºæÑ…ëá); goto eÓĞ–‡ê½; eÓĞ–‡ê½: } public function copyFile($F®ğä¨Ğª, $c§£„îÁˆÑ) { $A‘©¬Ñò»ã = $this->size($F®ğä¨Ğª); if ($A‘©¬Ñò»ã < 1024 * 1024 * 1024) { try { $this->client->copyObject($this->bucket, $F®ğä¨Ğª, $this->bucket, $this->pathEncode($c§£„îÁˆÑ)); } catch (OSS\Core\OssException $D„‘Õ—ÃÇ) { return !1; } return $this->getPathOuter($c§£„îÁˆÑ); } $e‚Ùî­´ê‡ = $this->multiCopyObject($F®ğä¨Ğª, $c§£„îÁˆÑ, $A‘©¬Ñò»ã); return $e‚Ùî­´ê‡ ? $this->getPathOuter($c§£„îÁˆÑ) : !1; } private function multiCopyObject($d´ ¥òâÊ, $dÕÑˆõ¼ª, $F¨ Œ÷Ü¯) { $f—œŒáèãå =& $_SERVER[ªúæÂ¡­ä½]; try { goto aƒ—à•ë°; DíÅòÏëš¤: $B­°Â‹…Ğ¦ = array(); foreach ($cØ¦ŒŒ¸Ùñ as $dÛ‘¡À§Õƒ => $AÑŒÕ‘ğˆ‚) { $B­°Â‹…Ğ¦[] = array($f—œŒáèãå[1296] => $dÛ‘¡À§Õƒ + 1, $f—œŒáèãå[1297] => $AÑŒÕ‘ğˆ‚); } $this->client->completeMultipartUpload($this->bucket, $this->pathEncode($dÕÑˆõ¼ª), $bë¢“¿¥, $B­°Â‹…Ğ¦); goto B„Òßàß; c•Ğäˆë¥É: $eæ¬µéš‡ = 1; $fì”ùÆ“ = 0; $cØ¦ŒŒ¸Ùñ = array(); goto E´––ÕßÓ; aƒ—à•ë°: $aƒœ±…¿ƒ› = array(); if ($f™—¸¥¹¤ = $this->hashMd5($d´ ¥òâÊ)) { $aƒœ±…¿ƒ› = array(OSS\OssClient::OSS_HEADERS => array($f—œŒáèãå[1292] => $f™—¸¥¹¤)); } $bë¢“¿¥ = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($dÕÑˆõ¼ª), $aƒœ±…¿ƒ›); goto c•Ğäˆë¥É; E´––ÕßÓ: $e¥†ğÑ¾¿… = 1024 * 1024 * 10; $B‚†ÕÆ±¶ó = $this->client->generateMultiuploadParts($F¨ Œ÷Ü¯, $e¥†ğÑ¾¿…); foreach ($B‚†ÕÆ±¶ó as $dÛ‘¡À§Õƒ => $f‰ÚÄ¢ñïó) { $D›Ô‹Êš³„ = $fì”ùÆ“ + (int) $f‰ÚÄ¢ñïó[$f—œŒáèãå[1293]]; $fÍµŠÕˆ³æ = (int) $f‰ÚÄ¢ñïó[$f—œŒáèãå[335]] + $D›Ô‹Êš³„ - 1; $A¾Øç”‚¨â = array($f—œŒáèãå[1294] => $D›Ô‹Êš³„, $f—œŒáèãå[1295] => $fÍµŠÕˆ³æ); $cØ¦ŒŒ¸Ùñ[] = $this->client->uploadPartCopy($this->bucket, $d´ ¥òâÊ, $this->bucket, $this->pathEncode($dÕÑˆõ¼ª), $eæ¬µéš‡, $bë¢“¿¥, $A¾Øç”‚¨â); $eæ¬µéš‡ = $eæ¬µéš‡ + 1; } goto DíÅòÏëš¤; B„Òßàß: } catch (OSS\Core\OssException $Bóå‚ï¸Š) { return !1; } return !0; } public function moveFile($fø¦¤íçÛÏ, $c‹—†Øå×) { if ($this->copyFile($fø¦¤íçÛÏ, $c‹—†Øå×)) { $this->remove($fø¦¤íçÛÏ); return $this->getPathOuter($c‹—†Øå×); } return !1; } public function delFile($fÒˆÌÒ›ò) { try { $this->client->deleteObject($this->bucket, $this->pathEncode($fÒˆÌÒ›ò)); } catch (OSS\Core\OssException $aø´å™î§Ú) { return !1; } return !0; } public function delFolder($B‰ˆŒÄ‡–) { goto aŠÊ¤‚ÒœÅ; CĞ‰ª˜Íó: $d´µÔÓïÄ§ = $this->delByBatch($B¤Íªİ¼¾[$B†ÁäÂ¯…ç[75]]); if (!$d´µÔÓïÄ§) { return !1; } return $this->delFile($Eö‡–­™øƒ); goto F›‰–Ø´Ÿ±; c’•‡’«†: if (!empty($B‰ˆŒÄ‡–) && $B‰ˆŒÄ‡– !== $B†ÁäÂ¯…ç[191] && !in_array($Eö‡–­™øƒ, $B¤Íªİ¼¾[$B†ÁäÂ¯…ç[75]])) { $B¤Íªİ¼¾[$B†ÁäÂ¯…ç[75]][] = $Eö‡–­™øƒ; } $d´µÔÓïÄ§ = $this->delByBatch($B¤Íªİ¼¾[$B†ÁäÂ¯…ç[74]]); if (!$d´µÔÓïÄ§) { return !1; } goto CĞ‰ª˜Íó; bã¢Í—°: $B¤Íªİ¼¾ = $this->fileList($B‰ˆŒÄ‡–); $this->listItemCache = !0; $Eö‡–­™øƒ = trim($B‰ˆŒÄ‡–, $B†ÁäÂ¯…ç[8]) . $B†ÁäÂ¯…ç[8]; goto c’•‡’«†; aŠÊ¤‚ÒœÅ: $B†ÁäÂ¯…ç =& $_SERVER[ªúæÂ¡­ä½]; if (!$this->exist($B‰ˆŒÄ‡–)) { return !0; } $this->listItemCache = !1; goto bã¢Í—°; F›‰–Ø´Ÿ±: } private function delByBatch($e÷±ˆ‹¸ƒĞ) { foreach (array_chunk($e÷±ˆ‹¸ƒĞ, 1000) as $A²íèÕ»ø¸) { try { $this->client->deleteObjects($this->bucket, $A²íèÕ»ø¸); } catch (OSS\Core\OssException $bŒŞ‘ñê•é) { return !1; } } return !0; } public function rename($e×ÅğÙíŒƒ, $FÃŒÔ¶Šğ®) { return $this->renameObject($e×ÅğÙíŒƒ, $FÃŒÔ¶Šğ®); } private function fileInfo($Cã”¨¾ïÈ, $Eï¨Êôµâå = false, $E«â÷ƒÓ´µ = array()) { goto dìÇ§×‹ñ÷; cÜæ÷Ñ¸àè: return $eƒ §š¸ÔÎ; goto c“ßªè†à‚; F‹™Íã: $eƒ §š¸ÔÎ[$fÁÔ¨ñœÃÃ[194]] = $eƒ §š¸ÔÎ[$fÁÔ¨ñœÃÃ[84]] = 0; $eƒ §š¸ÔÎ[$fÁÔ¨ñœÃÃ[195]] = $eƒ §š¸ÔÎ[$fÁÔ¨ñœÃÃ[196]] = !0; if (empty($E«â÷ƒÓ´µ)) { $c¢ˆ˜îõÛì = $this->objectMeta($Cã”¨¾ïÈ); if (!$c¢ˆ˜îõÛì) { return $eƒ §š¸ÔÎ; } $E«â÷ƒÓ´µ = array($fÁÔ¨ñœÃÃ[84] => strtotime($c¢ˆ˜îõÛì[$fÁÔ¨ñœÃÃ[1291]]), $fÁÔ¨ñœÃÃ[78] => $c¢ˆ˜îõÛì[$fÁÔ¨ñœÃÃ[1290]] + 0); } goto C Êø‘Î½³; C Êø‘Î½³: if (isset($E«â÷ƒÓ´µ[$fÁÔ¨ñœÃÃ[78]])) { $eƒ §š¸ÔÎ[$fÁÔ¨ñœÃÃ[78]] = $E«â÷ƒÓ´µ[$fÁÔ¨ñœÃÃ[78]]; } if (isset($E«â÷ƒÓ´µ[$fÁÔ¨ñœÃÃ[84]])) { $eƒ §š¸ÔÎ[$fÁÔ¨ñœÃÃ[84]] = $E«â÷ƒÓ´µ[$fÁÔ¨ñœÃÃ[84]]; } if (isset($E«â÷ƒÓ´µ[$fÁÔ¨ñœÃÃ[197]]) && !trim($eƒ §š¸ÔÎ[$fÁÔ¨ñœÃÃ[84]])) { $eƒ §š¸ÔÎ[$fÁÔ¨ñœÃÃ[84]] = $E«â÷ƒÓ´µ[$fÁÔ¨ñœÃÃ[197]]; } goto cÜæ÷Ñ¸àè; dìÇ§×‹ñ÷: $fÁÔ¨ñœÃÃ =& $_SERVER[ªúæÂ¡­ä½]; $eƒ §š¸ÔÎ = array($fÁÔ¨ñœÃÃ[28] => $this->pathThis($Cã”¨¾ïÈ), $fÁÔ¨ñœÃÃ[76] => $this->getPathOuter($Cã”¨¾ïÈ), $fÁÔ¨ñœÃÃ[29] => $fÁÔ¨ñœÃÃ[193], $fÁÔ¨ñœÃÃ[78] => isset($E«â÷ƒÓ´µ[$fÁÔ¨ñœÃÃ[78]]) ? $E«â÷ƒÓ´µ[$fÁÔ¨ñœÃÃ[78]] : 0, $fÁÔ¨ñœÃÃ[168] => $this->ext($Cã”¨¾ïÈ)); if ($Eï¨Êôµâå) { return $eƒ §š¸ÔÎ; } goto F‹™Íã; c“ßªè†à‚: } private function folderInfo($F¥ÓéÛÒ, $d©Ú¹ï±ÉÃ = false, $Aº…“Ò¶°ğ = array()) { goto dŒêª”»½; a­Ö×Ç¿†: if (isset($Aº…“Ò¶°ğ[$b„æÍÑáË[84]])) { $F¶µ­»¹àµ[$b„æÍÑáË[84]] = $Aº…“Ò¶°ğ[$b„æÍÑáË[84]]; } if (isset($Aº…“Ò¶°ğ[$b„æÍÑáË[194]])) { $F¶µ­»¹àµ[$b„æÍÑáË[194]] = $Aº…“Ò¶°ğ[$b„æÍÑáË[194]]; } return $F¶µ­»¹àµ; goto c‘ö¬ÏËêÏ; CÙØ·¬Ÿ•‚: $F¶µ­»¹àµ[$b„æÍÑáË[194]] = $F¶µ­»¹àµ[$b„æÍÑáË[84]] = 0; $F¶µ­»¹àµ[$b„æÍÑáË[195]] = $F¶µ­»¹àµ[$b„æÍÑáË[196]] = !0; if (empty($Aº…“Ò¶°ğ)) { $F¥ÓéÛÒ = rtrim($F¥ÓéÛÒ, $b„æÍÑáË[8]) . $b„æÍÑáË[8]; $DœƒâÄÍÜš = $this->objectMeta($F¥ÓéÛÒ); if (!$DœƒâÄÍÜš) { return $F¶µ­»¹àµ; } $Aº…“Ò¶°ğ = array($b„æÍÑáË[194] => $DœƒâÄÍÜš[$b„æÍÑáË[493]][$b„æÍÑáË[1298]], $b„æÍÑáË[84] => strtotime($DœƒâÄÍÜš[$b„æÍÑáË[1291]])); } goto a­Ö×Ç¿†; dŒêª”»½: $b„æÍÑáË =& $_SERVER[ªúæÂ¡­ä½]; $F¶µ­»¹àµ = array($b„æÍÑáË[28] => $this->pathThis($F¥ÓéÛÒ), $b„æÍÑáË[76] => $this->getPathOuter($b„æÍÑáË[8] . $F¥ÓéÛÒ), $b„æÍÑáË[29] => $b„æÍÑáË[77]); if ($d©Ú¹ï±ÉÃ) { return $F¶µ­»¹àµ; } goto CÙØ·¬Ÿ•‚; c‘ö¬ÏËêÏ: } public function listPath($aœÄ­à‹¨Ó, $AóÕ™ˆÃñ = false) { $fŒÕó×…Õè =& $_SERVER[ªúæÂ¡­ä½]; $E’µ­©´‘Õ = $this->fileList($aœÄ­à‹¨Ó, $fŒÕó×…Õè[8], !0); foreach ($E’µ­©´‘Õ[$fŒÕó×…Õè[75]] as $a£é¤ÍÏœ => $Cí÷‚¹åÙ) { $E’µ­©´‘Õ[$fŒÕó×…Õè[75]][$a£é¤ÍÏœ] = $this->folderInfo($Cí÷‚¹åÙ, $AóÕ™ˆÃñ, $Cí÷‚¹åÙ); } foreach ($E’µ­©´‘Õ[$fŒÕó×…Õè[74]] as $a£é¤ÍÏœ => $Cí÷‚¹åÙ) { $E’µ­©´‘Õ[$fŒÕó×…Õè[74]][$a£é¤ÍÏœ] = $this->fileInfo($Cí÷‚¹åÙ[$fŒÕó×…Õè[28]], $AóÕ™ˆÃñ, $Cí÷‚¹åÙ); } return $E’µ­©´‘Õ; } public function has($e´†®¢àˆ, $Dí…÷‚Ô½ = false, $B”‰ÑŒÔê = true) { goto bÉ‹õ¹‹áâ; cŒÅ•Ú³­…: while (!0) { check_abort(); $bÜ…±ˆßÅ = array($F¯Œ¸Ìµ[1286] => $F¯Œ¸Ìµ[8], $F¯Œ¸Ìµ[1287] => $D¦¦ôšÀÕ, $F¯Œ¸Ìµ[1288] => $Cœ¥êŸó†», $F¯Œ¸Ìµ[1289] => $dÒÅ­òì‚); try { $d¹…£·Ïó = $this->client->listObjects($this->bucket, $bÜ…±ˆßÅ); } catch (OSS\Core\OssException $dç¿Ê¡Àï) { break; } $dÒÅ­òì‚ = $d¹…£·Ïó->getNextMarker(); $f¯ò­™Ô‡³ = $d¹…£·Ïó->getObjectList(); $FĞÍ•Ÿ­ = $d¹…£·Ïó->getPrefixList(); if ($Dí…÷‚Ô½) { if (count($f¯ò­™Ô‡³) > 1 || count($f¯ò­™Ô‡³) == 1 && $f¯ò­™Ô‡³[0]->getKey() != $D¦¦ôšÀÕ) { $dŒÌ¢Áã÷ø += count($f¯ò­™Ô‡³) - 1; } if (!empty($FĞÍ•Ÿ­)) { $aÌĞÃö² += count($FĞÍ•Ÿ­); } if ($dÒÅ­òì‚ === $F¯Œ¸Ìµ[33]) { break; } continue; } if ($B”‰ÑŒÔê) { if (!empty($f¯ò­™Ô‡³)) { if (count($f¯ò­™Ô‡³) > 1 || $f¯ò­™Ô‡³[0]->getKey() != $D¦¦ôšÀÕ) { return !0; } } } else { if (!empty($FĞÍ•Ÿ­)) { return !0; } } if ($dÒÅ­òì‚ === $F¯Œ¸Ìµ[33]) { break; } } if ($Dí…÷‚Ô½) { return array($F¯Œ¸Ìµ[203] => $dŒÌ¢Áã÷ø, $F¯Œ¸Ìµ[204] => $aÌĞÃö²); } return !1; goto A­‘†­¤; bÉ‹õ¹‹áâ: $F¯Œ¸Ìµ =& $_SERVER[ªúæÂ¡­ä½]; $e´†®¢àˆ = trim($e´†®¢àˆ, $F¯Œ¸Ìµ[8]); $D¦¦ôšÀÕ = empty($e´†®¢àˆ) && $e´†®¢àˆ !== $F¯Œ¸Ìµ[191] ? $F¯Œ¸Ìµ[33] : $e´†®¢àˆ . $F¯Œ¸Ìµ[8]; goto AŞ†Üªøğ¿; AŞ†Üªøğ¿: $dÒÅ­òì‚ = $F¯Œ¸Ìµ[33]; $Cœ¥êŸó†» = 500; $dŒÌ¢Áã÷ø = $aÌĞÃö² = 0; goto cŒÅ•Ú³­…; A­‘†­¤: } public function listAll($f»Ÿ³®Ûõ) { $cÀÈèáÉªŒ =& $_SERVER[ªúæÂ¡­ä½]; $DÊë¡ñãÃ = $this->fileList($f»Ÿ³®Ûõ, $cÀÈèáÉªŒ[33], !0); $bùËï™ğ‹ù = array(); foreach ($DÊë¡ñãÃ[$cÀÈèáÉªŒ[74]] as $BŒÍƒ†ê¾) { $bùËï™ğ‹ù[$BŒÍƒ†ê¾[$cÀÈèáÉªŒ[28]]] = $BŒÍƒ†ê¾[$cÀÈèáÉªŒ[78]]; } foreach ($DÊë¡ñãÃ[$cÀÈèáÉªŒ[75]] as $BŒÍƒ†ê¾) { if (is_string($BŒÍƒ†ê¾)) { $bùËï™ğ‹ù[$BŒÍƒ†ê¾] = 0; } } return $this->listAllFiles($f»Ÿ³®Ûõ, array_keys($bùËï™ğ‹ù), $bùËï™ğ‹ù); } public function canRead($eˆ¢š‰Ÿ) { $FŸà†ÕÆÕŸ =& $_SERVER[ªúæÂ¡­ä½]; $DòÄÜëêˆî = $this->pathAcl($eˆ¢š‰Ÿ); return $DòÄÜëêˆî == $FŸà†ÕÆÕŸ[1299] || $DòÄÜëêˆî == $FŸà†ÕÆÕŸ[533] ? !0 : !1; } public function canWrite($dÙßîèëŒ) { $F½ØèŠğø‰ = $this->pathAcl($dÙßîèëŒ); return $F½ØèŠğø‰ == $_SERVER[ªúæÂ¡­ä½][533] ? !0 : !1; } public function pathAcl($b‘î„Û©¹ã) { goto EÎßğ¤£™; AÒÕ‘…æ: $DæÒµŠîêÀ = $EÂ¾œäòêŞ == $DâæîÆÑ¥ª[34] ? $this->bucketAcl : $EÂ¾œäòêŞ; if ($DæÒµŠîêÀ == $DâæîÆÑ¥ª[1300]) { return $DâæîÆÑ¥ª[1299]; } if ($DæÒµŠîêÀ == $DâæîÆÑ¥ª[1301]) { return $DâæîÆÑ¥ª[533]; } goto bÀê†Ë Áæ; EÎßğ¤£™: $DâæîÆÑ¥ª =& $_SERVER[ªúæÂ¡­ä½]; if (empty($this->bucketAcl)) { $this->bucketAcl = $this->client->getBucketAcl($this->bucket); } try { $EÂ¾œäòêŞ = $this->client->getObjectAcl($this->bucket, $this->pathEncode($b‘î„Û©¹ã)); } catch (OSS\Core\OssException $e ôè¶°›è) { return !1; } goto AÒÕ‘…æ; bÀê†Ë Áæ: return $DæÒµŠîêÀ; goto Fêšœ°¹×; Fêšœ°¹×: } private function chmodPath($Bôù‰» †Í, $dçéïğÃÅÅ = '') { $Aí®Î ìÖó =& $_SERVER[ªúæÂ¡­ä½]; $FÈÇò½×£ = empty($dçéïğÃÅÅ) ? $Aí®Î ìÖó[1301] : $dçéïğÃÅÅ; $dù§ëš‡›Ò = array($Aí®Î ìÖó[34], $Aí®Î ìÖó[192], $Aí®Î ìÖó[1300], $Aí®Î ìÖó[1301]); if (!in_array($FÈÇò½×£, $dù§ëš‡›Ò)) { return !1; } try { $this->client->putObjectAcl($this->bucket, $this->pathEncode($Bôù‰» †Í), $FÈÇò½×£); } catch (OSS\Core\OssException $f¡µù–¢¤) { return !1; } return !0; } public function getContent($Aâ£ˆ£ˆÀ) { return $this->fileSubstr($Aâ£ˆ£ˆÀ, -1); } public function setContent($DØÄ°Úöå¡, $eßƒåî‘·‘ = '') { $dÒèœ¿É•¬ =& $_SERVER[ªúæÂ¡­ä½]; try { $E”Œ¬ñÆß = $this->trafficLimit($dÒèœ¿É•¬[1302]); $F‘© ©ƒä = $this->client->putObject($this->bucket, $this->pathEncode($DØÄ°Úöå¡), $eßƒåî‘·‘, $E”Œ¬ñÆß); } catch (OSS\Core\OssException $d„œÉ«À«™) { return !1; } $dÈ¼É’¢¤º = array($dÒèœ¿É•¬[1292] => trim($F‘© ©ƒä[$dÒèœ¿É•¬[1303]], $dÒèœ¿É•¬[116]), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($DØÄ°Úöå¡))); $this->updateObjMeta($DØÄ°Úöå¡, $dÈ¼É’¢¤º); return isset($F‘© ©ƒä[$dÒèœ¿É•¬[1304]][$dÒèœ¿É•¬[1251]]) ? !0 : !1; } private function updateObjMeta($fÅ®ä¸‹Ï, $D®çïÈáÍƒ) { $fÅ®ä¸‹Ï = $this->pathEncode($fÅ®ä¸‹Ï); try { $d®Ìù†“— = array(OSS\OssClient::OSS_HEADERS => $D®çïÈáÍƒ); $this->client->copyObject($this->bucket, $fÅ®ä¸‹Ï, $this->bucket, $fÅ®ä¸‹Ï, $d®Ìù†“—); } catch (OSS\Core\OssException $dÑ“…ÏÁ§Š) { return !1; } return !0; } public function upload($a°ğºã‰÷Ç, $a¦…ËñİÙÁ, $Aãà¶Æ†¡° = false, $BÚÔƒÂ³¥ = REPEAT_REPLACE) { $Bç¥Ï êˆÍ =& $_SERVER[ªúæÂ¡­ä½]; $eÒĞ›…öºÆ = trim($a°ğºã‰÷Ç, $Bç¥Ï êˆÍ[8]); $C‚Ü»ÄÖ’Ê = array(OSS\OssClient::OSS_CHECK_MD5 => !0, OSS\OssClient::OSS_PART_SIZE => 1024 * 1024 * 10, OSS\OssClient::OSS_HEADERS => array($Bç¥Ï êˆÍ[1292] => @md5_file($a¦…ËñİÙÁ)), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($a°ğºã‰÷Ç))); $C‚Ü»ÄÖ’Ê = $this->trafficLimit($Bç¥Ï êˆÍ[1302], $C‚Ü»ÄÖ’Ê); try { $this->client->multiuploadFile($this->bucket, $this->pathEncode($eÒĞ›…öºÆ), $a¦…ËñİÙÁ, $C‚Ü»ÄÖ’Ê); } catch (OSS\Core\OssException $D³¡ˆÜé‡À) { return !1; } return $this->getPathOuter($a°ğºã‰÷Ç); } public function getHost() { $FÛµ„ÕšÑô =& $_SERVER[ªúæÂ¡­ä½]; $C„˜ˆê•İ = explode($FÛµ„ÕšÑô[177], parent::getHost()); return $C„˜ˆê•İ[0] . $FÛµ„ÕšÑô[177] . $this->bucket . $FÛµ„ÕšÑô[95] . $C„˜ˆê•İ[1]; } public function uploadFormData($F¦°½Õ›ƒ¥, $aÖ­ŞÁÇí„ = 3600) { goto B÷ºŒÃ´Õ­; d¸©˜©Ç‰¬: $bÓ°ßÓæŒƒ = base64_encode(hash_hmac($bé’‘Ğ¼ÀÙ[230], $d•Ì±÷¼Š, $this->secret, !0)); $dÃ…ƒ’ÔÈ = array($bé’‘Ğ¼ÀÙ[1216] => $d•Ì±÷¼Š, $bé’‘Ğ¼ÀÙ[1308] => $this->accessKey, $bé’‘Ğ¼ÀÙ[1212] => $bé’‘Ğ¼ÀÙ[1204], $bé’‘Ğ¼ÀÙ[1309] => $bÓ°ßÓæŒƒ, $bé’‘Ğ¼ÀÙ[175] => $fºÔŒ‡äÙõ); $dÃ…ƒ’ÔÈ = $this->trafficLimit($bé’‘Ğ¼ÀÙ[1302], $dÃ…ƒ’ÔÈ); goto D«ÌœÌóºˆ; D«ÌœÌóºˆ: return $dÃ…ƒ’ÔÈ; goto a‚÷ö¥°±Ø; B÷ºŒÃ´Õ­: $bé’‘Ğ¼ÀÙ =& $_SERVER[ªúæÂ¡­ä½]; if (!($fºÔŒ‡äÙõ = $this->getHost())) { return !1; } $D±í‘ßñ§‰ = $aÖ­ŞÁÇí„; goto A‚Ş¨Æ¢ä‹; E´´Ğ¬‘ù: $aéàºÏÃ‡† = $this->pathFather($F¦°½Õ›ƒ¥); $FÁ¬ñµç²ê = array($bé’‘Ğ¼ÀÙ[1206] => $b¾„¾ô–å, $bé’‘Ğ¼ÀÙ[1207] => array(array($bé’‘Ğ¼ÀÙ[1307], 0, $b¤ñ’·º²Å), array($bé’‘Ğ¼ÀÙ[1210], $bé’‘Ğ¼ÀÙ[1211], $aéàºÏÃ‡†))); $d•Ì±÷¼Š = base64_encode(json_encode($FÁ¬ñµç²ê)); goto d¸©˜©Ç‰¬; B´ñÖÜà³¹: $AÀÌçÁ¾Ú„ = strpos($b¾„¾ô–å, $bé’‘Ğ¼ÀÙ[294]); $b¾„¾ô–å = substr($b¾„¾ô–å, 0, $AÀÌçÁ¾Ú„) . $bé’‘Ğ¼ÀÙ[1306]; $b¤ñ’·º²Å = 1048576000 * 5; goto E´´Ğ¬‘ù; A‚Ş¨Æ¢ä‹: $CÖ²Ö‘•»è = date($bé’‘Ğ¼ÀÙ[1305], time() + $D±í‘ßñ§‰); $d·‡ŠÆ¼šå = new DateTime($CÖ²Ö‘•»è); $b¾„¾ô–å = $d·‡ŠÆ¼šå->format(DateTime::ISO8601); goto B´ñÖÜà³¹; a‚÷ö¥°±Ø: } public function multiUploadFormData($F¼Œ¡“ßå, $e°šˆ‹ê¡ = 3600) { $AôÒÔ ¥· =& $_SERVER[ªúæÂ¡­ä½]; if (!($FéŒ«³ßƒ„ = $this->getHost())) { return !1; } $fùø¼äÔœˆ = $this->trafficLimit($AôÒÔ ¥·[1302]); $d„©ºßÍÎ» = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($F¼Œ¡“ßå), $fùø¼äÔœˆ); return array($AôÒÔ ¥·[221] => $d„©ºßÍÎ», $AôÒÔ ¥·[175] => $FéŒ«³ßƒ„ . $AôÒÔ ¥·[8] . $this->pathEncode($F¼Œ¡“ßå), $AôÒÔ ¥·[222] => gmdate($AôÒÔ ¥·[1310]), $AôÒÔ ¥·[93] => $F¼Œ¡“ßå); } public function multiUploadAuthData($aÚÈóØ‰É, $eì®‚´Î£• = array()) { goto Bƒò·ø¨Í»; BŸ¯İŠ—œ˜: $cä„«†‘í· = $aÚÈóØ‰É; if (isset($eì®‚´Î£•[$BÃòÌß[93]])) { $cä„«†‘í· = $eì®‚´Î£•[$BÃòÌß[93]]; unset($eì®‚´Î£•[$BÃòÌß[93]]); } if (isset($eì®‚´Î£•[$BÃòÌß[223]])) { $eì®‚´Î£•[$BÃòÌß[222]] = $FŠ…³ÉÚÃé; return $this->listUploadParts($cä„«†‘í·, $eì®‚´Î£•); } goto Bõ½Æ÷øé; f‚‡É¯ä³á: if (!empty($eì®‚´Î£•[$BÃòÌß[1312]])) { $cğ„ÊéšÆè = array_merge(array($F¹˜¸ÀÇ©º[4]), $eì®‚´Î£•[$BÃòÌß[1312]]); sort($cğ„ÊéšÆè); $F¹˜¸ÀÇ©º[4] = implode($BÃòÌß[229], $cğ„ÊéšÆè); } $D‘¸‘´»Û = implode($BÃòÌß[229], $F¹˜¸ÀÇ©º); $f„Œˆé·ğŒ = base64_encode(hash_hmac($BÃòÌß[230], $D‘¸‘´»Û, $this->secret, !0)); goto CÜÌ¾ÕŠÔ; Bƒò·ø¨Í»: $BÃòÌß =& $_SERVER[ªúæÂ¡­ä½]; $FŠ…³ÉÚÃé = isset($eì®‚´Î£•[$BÃòÌß[222]]) ? $eì®‚´Î£•[$BÃòÌß[222]] : gmdate($BÃòÌß[1310]); $d‚Âçë²°” = isset($eì®‚´Î£•[$BÃòÌß[168]]) ? $eì®‚´Î£•[$BÃòÌß[168]] : $BÃòÌß[33]; goto BŸ¯İŠ—œ˜; CÜÌ¾ÕŠÔ: $B›Ìá…ñ« = $BÃòÌß[1276] . $this->accessKey . $BÃòÌß[4] . $f„Œˆé·ğŒ; if (strpos($d‚Âçë²°”, $BÃòÌß[225]) === 0) { $B›Ìá…ñ« = array($BÃòÌß[232] => $B›Ìá…ñ«, $BÃòÌß[222] => $FŠ…³ÉÚÃé); if ($d ã±Îˆ‘Ü) { $B›Ìá…ñ« = array_merge($B›Ìá…ñ«, $d ã±Îˆ‘Ü); } } return $B›Ìá…ñ«; goto CÖ·Üî•Î¼; Bõ½Æ÷øé: $F¹˜¸ÀÇ©º = array($BÃòÌß[224], $BÃòÌß[33], $BÃòÌß[119], $FŠ…³ÉÚÃé, "\x78\55\x6f\163\163\55\144\x61\x74\145\x3a{$FŠ…³ÉÚÃé}", $BÃòÌß[8] . $this->bucket . $BÃòÌß[8] . $cä„«†‘í· . $d‚Âçë²°”); if (strpos($d‚Âçë²°”, $BÃòÌß[225]) === 0) { $F¹˜¸ÀÇ©º[0] = $BÃòÌß[226]; if ($d ã±Îˆ‘Ü = $this->trafficLimit($BÃòÌß[1302])) { $cä„«†‘í· = $BÃòÌß[1311]; array_splice($F¹˜¸ÀÇ©º, 5, 0, $cä„«†‘í· . $BÃòÌß[4] . $d ã±Îˆ‘Ü[$cä„«†‘í·]); } } if (isset($eì®‚´Î£•[$BÃòÌß[227]]) && $eì®‚´Î£•[$BÃòÌß[227]] == $BÃòÌß[228]) { $F¹˜¸ÀÇ©º[0] = $BÃòÌß[228]; } goto f‚‡É¯ä³á; CÖ·Üî•Î¼: } public function listUploadParts($EïÜ¤ïê¬­, $c”ÚÜÁŠ) { goto C–ôÌËçÄ; DŸäƒäÖí‹: unset($c”ÚÜÁŠ[$c©”·„Êæ¦[223]], $c”ÚÜÁŠ[$c©”·„Êæ¦[227]]); $AÃßÁ„„Ä = $this->multiUploadAuthData($EïÜ¤ïê¬­, $c”ÚÜÁŠ); if (empty($AÃßÁ„„Ä)) { return !1; } goto bÑ‘óôù˜; C–ôÌËçÄ: $c©”·„Êæ¦ =& $_SERVER[ªúæÂ¡­ä½]; $FÓÑÁò—ÃÑ = parse_url_query($c”ÚÜÁŠ[$c©”·„Êæ¦[168]]); $Bğ­¬âœÙ = $this->client->listParts($this->bucket, $this->pathEncode($EïÜ¤ïê¬­), $FÓÑÁò—ÃÑ[$c©”·„Êæ¦[221]]); goto eÍÇçË±ñè; bÑ‘óôù˜: return array($c©”·„Êæ¦[232] => $AÃßÁ„„Ä, $c©”·„Êæ¦[222] => $c”ÚÜÁŠ[$c©”·„Êæ¦[222]], $c©”·„Êæ¦[234] => $D„Œˆİçîƒ); goto eï‰½ÔöÁØ; eÍÇçË±ñè: $A­íçëù¨ = $Bğ­¬âœÙ->getListPart(); $D„Œˆİçîƒ = array(); foreach ($A­íçëù¨ as $DË¼”ŠÆ) { $D„Œˆİçîƒ[] = array($c©”·„Êæ¦[1296] => $DË¼”ŠÆ->getPartNumber(), $c©”·„Êæ¦[1297] => trim($DË¼”ŠÆ->getETag(), $c©”·„Êæ¦[116])); } goto DŸäƒäÖí‹; eï‰½ÔöÁØ: } public function download($bèÔÉë¬¡, $bë‡Ô¹ì¥) { if ($this->isFolder($bèÔÉë¬¡)) { return !1; } try { $e”—ĞµÎßï = array(OSS\OssClient::OSS_FILE_DOWNLOAD => $bë‡Ô¹ì¥); $e”—ĞµÎßï = $this->trafficLimit($_SERVER[ªúæÂ¡­ä½][109], $e”—ĞµÎßï); $this->client->getObject($this->bucket, $this->pathEncode($bèÔÉë¬¡), $e”—ĞµÎßï); } catch (OSS\Core\OssException $Aïä‚¤«¹) { return !1; } return $bë‡Ô¹ì¥; } public function fileSubstr($aÀÅØÂ¦Ê×, $C”¢İ®‡ŠÑ = 0, $c‰Ö¡ŒÃÈ = false) { if ($C”¢İ®‡ŠÑ === -1) { $C£‡’ó££† = array(); } else { if ($c‰Ö¡ŒÃÈ === !1) { $aÉùˆœ­ó¼ = $this->size($aÀÅØÂ¦Ê×); } else { $aÉùˆœ­ó¼ = $C”¢İ®‡ŠÑ + $c‰Ö¡ŒÃÈ - 1; } $C£‡’ó££† = array(OSS\OssClient::OSS_RANGE => "{$C”¢İ®‡ŠÑ}\55{$aÉùˆœ­ó¼}"); } try { return $this->client->getObject($this->bucket, $this->pathEncode($aÀÅØÂ¦Ê×), $C£‡’ó££†); } catch (OSS\Core\OssException $f‡š…ÛË×³) { think_exception($f‡š…ÛË×³->getMessage()); return !1; } } private function trafficLimit($D¨º‡°ìö, $bÈ±²¥¨­ = array()) { goto EÄÂ®’Î¤§; FÓé†‡ïÄ’: return $bÈ±²¥¨­; goto CñÂŒõÜ¸¼; EÄÂ®’Î¤§: $Døó‡«‡Ä =& $_SERVER[ªúæÂ¡­ä½]; if ($D¨º‡°ìö == $Døó‡«‡Ä[1302] && $this->isUploadServer() || $D¨º‡°ìö == $Døó‡«‡Ä[109] && $this->isFileOutServer()) { return $bÈ±²¥¨­; } $BéÈßíŒô® = floatval($GLOBALS[$Døó‡«‡Ä[6]][$Døó‡«‡Ä[88]][$Døó‡«‡Ä[107]][$D¨º‡°ìö]) * 1024 * 1024 * 8; goto EËë–îŞŒ§; EËë–îŞŒ§: if (!$BéÈßíŒô®) { return $bÈ±²¥¨­; } $BéÈßíŒô® = $BéÈßíŒô® < 819200 ? 819200 : ($BéÈßíŒô® > 838860800 ? 838860800 : $BéÈßíŒô®); $bÈ±²¥¨­[OSS\OssClient::OSS_TRAFFIC_LIMIT] = intval($BéÈßíŒô®); goto FÓé†‡ïÄ’; CñÂŒõÜ¸¼: } public function link($c¶Æ±Æ, $c–‚×Ê = array()) { $dêõ‘«ØÈÙ =& $_SERVER[ªúæÂ¡­ä½]; if (!$this->exist($c¶Æ±Æ) || $this->isFolder($c¶Æ±Æ)) { return !1; } try { $c–‚×Ê = $this->trafficLimit($dêõ‘«ØÈÙ[109], $c–‚×Ê); $d¬¢ó’Óôà = $this->client->signUrl($this->bucket, $this->pathEncode($c¶Æ±Æ), 3600 * 12, $dêõ‘«ØÈÙ[228], $c–‚×Ê); return $this->getCdnLink($d¬¢ó’Óôà); } catch (OSS\Core\OssException $Cà¬¬ëºĞä) { return !1; } } public function fileOut($Fë¹¥ÆèÕ´, $fíŒ¢Š¦Ëë = false, $DÍÜÀ†ĞßÈ = false, $Cì÷ÏË‰¦ä = '') { goto f¦ê’á¾ø¾; eÇ¡ŠœìŸ‰: $DÍÜÀ†ĞßÈ = rawurlencode($DÍÜÀ†ĞßÈ); $e÷Û•ŒÙƒŞ = get_file_mime(get_path_ext($DÍÜÀ†ĞßÈ)); if ($e÷Û•ŒÙƒŞ == $Bí‚ÌÏÃ§[213]) { return parent::fileOut($Fë¹¥ÆèÕ´, $fíŒ¢Š¦Ëë, $DÍÜÀ†ĞßÈ, $Cì÷ÏË‰¦ä); } goto C×ßÄ¢œ‡Œ; c‡š¬×Û‰ğ: $eæ°‰¥ÉÍ = $this->link($Fë¹¥ÆèÕ´, $aÄÍ¤‚ôÄ); $this->fileOutLink($eæ°‰¥ÉÍ); goto cµê­¨ô¢; f¦ê’á¾ø¾: $Bí‚ÌÏÃ§ =& $_SERVER[ªúæÂ¡­ä½]; if ($this->isFileOutServer()) { return $this->fileOutServer($Fë¹¥ÆèÕ´, $fíŒ¢Š¦Ëë, $DÍÜÀ†ĞßÈ, $Cì÷ÏË‰¦ä); } if (!$DÍÜÀ†ĞßÈ) { $DÍÜÀ†ĞßÈ = $this->pathThis($Fë¹¥ÆèÕ´); } goto eÇ¡ŠœìŸ‰; C×ßÄ¢œ‡Œ: $fíŒ¢Š¦Ëë = $fíŒ¢Š¦Ëë ? $Bí‚ÌÏÃ§[214] : $Bí‚ÌÏÃ§[215]; $aÄÍ¤‚ôÄ = array(OSS\OssClient::OSS_SUB_RESOURCE => $Bí‚ÌÏÃ§[1313] . rawurlencode("{$fíŒ¢Š¦Ëë}\x3b\146\151\154\145\x6e\x61\x6d\145\75{$DÍÜÀ†ĞßÈ}")); $aÄÍ¤‚ôÄ[OSS\OssClient::OSS_SUB_RESOURCE] .= $Bí‚ÌÏÃ§[1314] . rawurlencode($e÷Û•ŒÙƒŞ); goto c‡š¬×Û‰ğ; cµê­¨ô¢: } public function fileOutServer($Aá¼ÖÏà, $d¾ø·ÆĞè = false, $E›ĞÈçéäÇ = false, $fº…‹ù‰ã½ = '') { parent::fileOut($Aá¼ÖÏà, $d¾ø·ÆĞè, $E›ĞÈçéäÇ, $fº…‹ù‰ã½); } public function fileOutImage($cÈ··÷Œ, $FÆìæ™µÊ = 250) { $B¨ãêõ´´ = array(OSS\OssClient::OSS_PROCESS => $_SERVER[ªúæÂ¡­ä½][1315] . $FÆìæ™µÊ); $D®Àº÷öŠ = $this->link($cÈ··÷Œ, $B¨ãêõ´´); $this->fileOutLink($D®Àº÷öŠ); } public function fileOutImageServer($f×Ş¥«†¤”, $DŒô¡‹¹ÖØ = 250) { parent::fileOutImage($f×Ş¥«†¤”, $DŒô¡‹¹ÖØ); } public function fileOutLink($Aƒ£Å…¦¸) { $eîÉ“µ„ö® =& $_SERVER[ªúæÂ¡­ä½]; if (!$this->isCdnHost() && substr($Aƒ£Å…¦¸, 0, 7) == $eîÉ“µ„ö®[1219]) { $Aƒ£Å…¦¸ = $eîÉ“µ„ö®[1220] . substr($Aƒ£Å…¦¸, 7); } header($eîÉ“µ„ö®[159] . $Aƒ£Å…¦¸); die; } public function hashMd5($eŞÄĞšÍèÀ, $F¾·öÓì¹ì = '') { $DÜáÕí§çë =& $_SERVER[ªúæÂ¡­ä½]; $b–¨ßŒÚªØ = $this->_objectMeta($eŞÄĞšÍèÀ); if (!$b–¨ßŒÚªØ) { return $DÜáÕí§çë[33]; } if (!isset($b–¨ßŒÚªØ[$DÜáÕí§çë[1292]]) && !empty($F¾·öÓì¹ì)) { $DâĞ…‰™Ëë = $this->updateObjMeta($eŞÄĞšÍèÀ, array($DÜáÕí§çë[1292] => $F¾·öÓì¹ì)); $b–¨ßŒÚªØ[$DÜáÕí§çë[1292]] = $DâĞ…‰™Ëë ? $F¾·öÓì¹ì : $DÜáÕí§çë[33]; } return isset($b–¨ßŒÚªØ[$DÜáÕí§çë[1292]]) ? strtolower($b–¨ßŒÚªØ[$DÜáÕí§çë[1292]]) : $DÜáÕí§çë[33]; } public function size($e‘‰ˆÜÅ‰©) { $B¹äÂºªŞù = $this->objectMeta($e‘‰ˆÜÅ‰©); return $B¹äÂºªŞù ? $B¹äÂºªŞù[$_SERVER[ªúæÂ¡­ä½][78]] : 0; } public function info($E›»ĞÌğ·) { if ($this->isFolder($E›»ĞÌğ·)) { return $this->folderInfo($E›»ĞÌğ·); } else { if ($this->isFile($E›»ĞÌğ·)) { return $this->fileInfo($E›»ĞÌğ·); } } return !1; } public function exist($Eµ¢İ‰¡Æß) { return $this->isFile($Eµ¢İ‰¡Æß) || $this->isFolder($Eµ¢İ‰¡Æß); } public function isFile($BÂàòŒ­ˆ) { return !$this->isFolder($BÂàòŒ­ˆ) && $this->objectMeta($BÂàòŒ­ˆ); } public function isFolder($a¢¾Ú½™Ï‡) { return $this->cacheMethod($_SERVER[ªúæÂ¡­ä½][199], $a¢¾Ú½™Ï‡); } protected function objectMeta($EåÃ»ñöÉè) { return $this->cacheMethod($_SERVER[ªúæÂ¡­ä½][200], $EåÃ»ñöÉè); } protected function _objectMeta($E©™Äèõê„) { $aóíùµÉà° =& $_SERVER[ªúæÂ¡­ä½]; try { $c§¼”—Ê§ = $this->client->getObjectMeta($this->bucket, $this->pathEncode($E©™Äèõê„)); } catch (OSS\Core\OssException $BÏïŞ‘–†¬) { $c§¼”—Ê§ = !1; } if ($c§¼”—Ê§) { $c§¼”—Ê§[$aóíùµÉà°[78]] = intval($c§¼”—Ê§[$aóíùµÉà°[1290]]); } return $c§¼”—Ê§; } protected function _isFolder($b—³ÎÆŞë) { $a®×Ø„«“ =& $_SERVER[ªúæÂ¡­ä½]; if ($b—³ÎÆŞë == $a®×Ø„«“[33] || $b—³ÎÆŞë == $a®×Ø„«“[8]) { return !0; } $FÌø•š÷ªÎ = array($a®×Ø„«“[1286] => $a®×Ø„«“[8], $a®×Ø„«“[1287] => rtrim($b—³ÎÆŞë, $a®×Ø„«“[8]) . $a®×Ø„«“[8], $a®×Ø„«“[1288] => 1, $a®×Ø„«“[1289] => $a®×Ø„«“[33]); $b‚¿‘ÍİÂ¢ = $this->client->listObjects($this->bucket, $FÌø•š÷ªÎ); if ($b‚¿‘ÍİÂ¢->getObjectList() || $b‚¿‘ÍİÂ¢->getPrefixList()) { return !0; } return !1; } } class PathDriverQiniu extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $region = ''; protected $bucket = ''; protected $auth = null; protected $client = null; protected $config = null; protected $bucketManager = null; public $ioUploadServer = "\x30"; public $ioFileOutServer = "\x30"; public function __construct($Fµ«¿ÄÍÔŞ) { parent::__construct(); require_once SDK_DIR . $_SERVER[ªúæÂ¡­ä½][1316]; $this->_init($Fµ«¿ÄÍÔŞ); } public function _init($F¯Î¢³áòÖ) { goto Bíà†ÕÁÃ; f‚öã»ÏŠÊ: $this->bucketManager = new \Qiniu\Storage\BucketManager($this->auth, $this->config); goto dÁªåó¨ø‰; Bíà†ÕÁÃ: $D®±‚ØÕ =& $_SERVER[ªúæÂ¡­ä½]; foreach ($F¯Î¢³áòÖ as $CƒÕç†çÏå => $b½ ¡¾ğƒÑ) { if (isset($this->{$CƒÕç†çÏå})) { $this->{$CƒÕç†çÏå} = $b½ ¡¾ğƒÑ; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { throw new Exception($D®±‚ØÕ[1317] . LNG($D®±‚ØÕ[1277])); } goto f»ìàƒ™…; f»ìàƒ™…: $this->auth = new Qiniu\Auth($this->accessKey, $this->secret); $this->client = new Qiniu\Rtc\AppClient($this->auth); $this->config = new \Qiniu\Config(); goto f‚öã»ÏŠÊ; dÁªåó¨ø‰: } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } public function mkfile($bÛîÖí‰£ğ, $BÊ·âÕ…Â„ = '', $Aª¿””›‘Í = REPEAT_RENAME) { if ($this->setContent($bÛîÖí‰£ğ, $BÊ·âÕ…Â„)) { return $this->getPathOuter($bÛîÖí‰£ğ); } return !1; } public function mkdir($f ˜çÙ®öª, $Fñ½Èæâ¯© = REPEAT_SKIP) { goto CŠŠ›¢¼°; CŠŠ›¢¼°: $câ²å³õª =& $_SERVER[ªúæÂ¡­ä½]; $DÇ™©‚”á® = trim($f ˜çÙ®öª, $câ²å³õª[8]); if ($this->_isFolder($DÇ™©‚”á®)) { return $this->getPathOuter($DÇ™©‚”á®); } goto Béã¯ˆø ; eÈàÍÓÏºÔ: if (!$this->mkfile($eîÎÔÁ–Ğİ)) { return !1; } if (!$this->moveFile($eîÎÔÁ–Ğİ, $f ˜çÙ®öª)) { $this->delFile($eîÎÔÁ–Ğİ); return !1; } return $this->getPathOuter($DÇ™©‚”á®); goto AŠ§ÉÌ¥ò; Béã¯ˆø : $f ˜çÙ®öª = $DÇ™©‚”á® . $câ²å³õª[8]; $Fº‹Â¤Š½Ÿ = get_path_this($DÇ™©‚”á®); $eîÎÔÁ–Ğİ = $f ˜çÙ®öª . $Fº‹Â¤Š½Ÿ; goto eÈàÍÓÏºÔ; AŠ§ÉÌ¥ò: } public function copyFile($dÎÔäÀæ¹Æ, $bãî³èäÙ×) { $EÎ‚»¤Šˆß = $this->bucketManager->copy($this->bucket, $dÎÔäÀæ¹Æ, $this->bucket, $bãî³èäÙ×, !0); return $EÎ‚»¤Šˆß ? !1 : $this->getPathOuter($bãî³èäÙ×); } public function moveFile($cà‰¹öÎ“, $då×À‘ÛÒš) { $fîÏ‚³Ş… = $this->bucketManager->move($this->bucket, $cà‰¹öÎ“, $this->bucket, $då×À‘ÛÒš, !0); return $fîÏ‚³Ş… ? !1 : $this->getPathOuter($då×À‘ÛÒš); } public function delFile($FÁÊ¸á£áñ) { if (!$this->exist($FÁÊ¸á£áñ)) { return !0; } $EáÛªÏ„™ƒ = $this->bucketManager->delete($this->bucket, $FÁÊ¸á£áñ); return $EáÛªÏ„™ƒ ? !1 : !0; } public function delFolder($B­–…íÅ¡¨) { goto Aº—‚à‚â”; eµ‚²ø„öê: $B×Æ±Õ±Ñ² = $this->delByBatch($f¼Òä„†“Î[$d†Ä¾®‹Õ[75]]); if (!$B×Æ±Õ±Ñ²) { return !1; } return $this->delFile($eŠ»øÙÆ“¾); goto BÜĞŞŠ¾·ï; Aº—‚à‚â”: $d†Ä¾®‹Õ =& $_SERVER[ªúæÂ¡­ä½]; if (!$this->exist($B­–…íÅ¡¨)) { return !0; } $this->listItemCache = !1; goto fÈÒ¦ê‰Æ‡; e•Ö’¥ÌÆ–: if (!empty($B­–…íÅ¡¨) && $B­–…íÅ¡¨ !== $d†Ä¾®‹Õ[191] && !in_array($eŠ»øÙÆ“¾, $f¼Òä„†“Î[$d†Ä¾®‹Õ[75]])) { $f¼Òä„†“Î[$d†Ä¾®‹Õ[75]][] = $eŠ»øÙÆ“¾; } $B×Æ±Õ±Ñ² = $this->delByBatch($f¼Òä„†“Î[$d†Ä¾®‹Õ[74]]); if (!$B×Æ±Õ±Ñ²) { return !1; } goto eµ‚²ø„öê; fÈÒ¦ê‰Æ‡: $f¼Òä„†“Î = $this->fileList($B­–…íÅ¡¨); $this->listItemCache = !0; $eŠ»øÙÆ“¾ = trim($B­–…íÅ¡¨, $d†Ä¾®‹Õ[8]) . $d†Ä¾®‹Õ[8]; goto e•Ö’¥ÌÆ–; BÜĞŞŠ¾·ï: } private function delByBatch($C³Š©ïá”À) { foreach (array_chunk($C³Š©ïá”À, 1000) as $f¢ÄÖÛ‡³) { $a’ôå£°¯ = $this->bucketManager->buildBatchDelete($this->bucket, $f¢ÄÖÛ‡³); list($Fåæ’ÆÕÍ“, $E–ÓÏŞ´ø) = $this->bucketManager->batch($a’ôå£°¯); if ($E–ÓÏŞ´ø) { return !1; } } return !0; } public function rename($d¨ÒĞ¹¾å½, $fµÕ×É¦„ƒ) { return $this->renameObject($d¨ÒĞ¹¾å½, $fµÕ×É¦„ƒ); } public function fileInfo($BôğÀ˜±ÑÃ, $E‘‹Ã¦…å« = false, $DÍìÎì—¢ = array()) { goto a­¿…¢ëğ; bã¡¯œáÑ: $cÌ†Ş„‹İŸ[$a¦Ê³ÏãŒ‚[194]] = $cÌ†Ş„‹İŸ[$a¦Ê³ÏãŒ‚[84]] = 0; $cÌ†Ş„‹İŸ[$a¦Ê³ÏãŒ‚[195]] = $cÌ†Ş„‹İŸ[$a¦Ê³ÏãŒ‚[196]] = !0; if (empty($DÍìÎì—¢)) { $DÍìÎì—¢ = $this->objectMeta($BôğÀ˜±ÑÃ); if (!$DÍìÎì—¢) { return $cÌ†Ş„‹İŸ; } } goto B­ë®…Ö¡; a­¿…¢ëğ: $a¦Ê³ÏãŒ‚ =& $_SERVER[ªúæÂ¡­ä½]; $cÌ†Ş„‹İŸ = array($a¦Ê³ÏãŒ‚[28] => $this->pathThis($BôğÀ˜±ÑÃ), $a¦Ê³ÏãŒ‚[76] => $this->getPathOuter($a¦Ê³ÏãŒ‚[8] . $BôğÀ˜±ÑÃ), $a¦Ê³ÏãŒ‚[29] => $a¦Ê³ÏãŒ‚[193], $a¦Ê³ÏãŒ‚[78] => isset($DÍìÎì—¢[$a¦Ê³ÏãŒ‚[1318]]) ? $DÍìÎì—¢[$a¦Ê³ÏãŒ‚[1318]] : 0, $a¦Ê³ÏãŒ‚[168] => $this->ext($BôğÀ˜±ÑÃ)); if ($E‘‹Ã¦…å«) { return $cÌ†Ş„‹İŸ; } goto bã¡¯œáÑ; B­ë®…Ö¡: if (isset($DÍìÎì—¢[$a¦Ê³ÏãŒ‚[1319]])) { $cÌ†Ş„‹İŸ[$a¦Ê³ÏãŒ‚[84]] = substr($DÍìÎì—¢[$a¦Ê³ÏãŒ‚[1319]] . $a¦Ê³ÏãŒ‚[33], 0, 10); } if (isset($DÍìÎì—¢[$a¦Ê³ÏãŒ‚[1318]])) { $cÌ†Ş„‹İŸ[$a¦Ê³ÏãŒ‚[78]] = $DÍìÎì—¢[$a¦Ê³ÏãŒ‚[1318]]; } return $cÌ†Ş„‹İŸ; goto AêÇİ‚“À‘; AêÇİ‚“À‘: } public function folderInfo($a½êÂù´, $FÜŒßÅÍÅ = false) { goto a”œÓÙäÁ; c”ƒÅº÷“¤: $c¢£µ´†ïÊ[$A™æ…Ÿ§ãÍ[194]] = $c¢£µ´†ïÊ[$A™æ…Ÿ§ãÍ[84]] = 0; $c¢£µ´†ïÊ[$A™æ…Ÿ§ãÍ[195]] = $c¢£µ´†ïÊ[$A™æ…Ÿ§ãÍ[196]] = !0; $a½êÂù´ = rtrim($a½êÂù´, $A™æ…Ÿ§ãÍ[8]) . $A™æ…Ÿ§ãÍ[8]; goto D‡¦ó·¢ğÖ; D‡¦ó·¢ğÖ: $dÂ«„‚áë¦ = $this->objectMeta($a½êÂù´); if (isset($dÂ«„‚áë¦[$A™æ…Ÿ§ãÍ[1319]])) { $c¢£µ´†ïÊ[$A™æ…Ÿ§ãÍ[84]] = substr($dÂ«„‚áë¦[$A™æ…Ÿ§ãÍ[1319]] . $A™æ…Ÿ§ãÍ[33], 0, 10); } return $c¢£µ´†ïÊ; goto a°ƒª‡ÁƒÈ; a”œÓÙäÁ: $A™æ…Ÿ§ãÍ =& $_SERVER[ªúæÂ¡­ä½]; $c¢£µ´†ïÊ = array($A™æ…Ÿ§ãÍ[28] => $this->pathThis($a½êÂù´), $A™æ…Ÿ§ãÍ[76] => $this->getPathOuter($A™æ…Ÿ§ãÍ[8] . $a½êÂù´), $A™æ…Ÿ§ãÍ[29] => $A™æ…Ÿ§ãÍ[77]); if ($FÜŒßÅÍÅ) { return $c¢£µ´†ïÊ; } goto c”ƒÅº÷“¤; a°ƒª‡ÁƒÈ: } public function listPath($A’ë†¶Îª, $dôÔ«–’ Â = false) { $cÅœ¨¥…•… =& $_SERVER[ªúæÂ¡­ä½]; $e—­É­ù×¾ = $this->fileList($A’ë†¶Îª, $cÅœ¨¥…•…[8], !0); foreach ($e—­É­ù×¾[$cÅœ¨¥…•…[75]] as $F¹Êë·ë×› => $A÷ŠŒ‡±¢Ú) { $e—­É­ù×¾[$cÅœ¨¥…•…[75]][$F¹Êë·ë×›] = $this->folderInfo($A÷ŠŒ‡±¢Ú, $dôÔ«–’ Â); } foreach ($e—­É­ù×¾[$cÅœ¨¥…•…[74]] as $F¹Êë·ë×› => $A÷ŠŒ‡±¢Ú) { $e—­É­ù×¾[$cÅœ¨¥…•…[74]][$F¹Êë·ë×›] = $this->fileInfo($A÷ŠŒ‡±¢Ú[$cÅœ¨¥…•…[93]], $dôÔ«–’ Â, $A÷ŠŒ‡±¢Ú); } return $e—­É­ù×¾; } public function has($E°¿Åè´â¹, $Döö±ê·Ü¬ = false, $aß¢²é¢±‚ = true) { goto Dš½£ˆà»”; Dš½£ˆà»”: $f«¼¦¨Ğ×± =& $_SERVER[ªúæÂ¡­ä½]; $E°¿Åè´â¹ = trim($E°¿Åè´â¹, $f«¼¦¨Ğ×±[8]); $FÅàğà°§ = empty($E°¿Åè´â¹) && $E°¿Åè´â¹ !== $f«¼¦¨Ğ×±[191] ? $f«¼¦¨Ğ×±[33] : $E°¿Åè´â¹ . $f«¼¦¨Ğ×±[8]; goto F¢ëùçè©«; C’šïêİ´“: return !1; goto Dˆªá³©’; cÉ£­Š¸÷°: $fíªø¤“é = $Eõ¨ïéÊÂæ = 0; while (!0) { check_abort(); list($A©Ô×Ó, $d«âØÅİ›) = $this->bucketManager->listFiles($this->bucket, $FÅàğà°§, $bÆˆğ²à÷¸, $aìªİõ¿¬°, $a¬ˆ¤†ˆÃİ); if ($d«âØÅİ›) { break; } $bÆˆğ²à÷¸ = array_key_exists($f«¼¦¨Ğ×±[1289], $A©Ô×Ó) ? $bÆˆğ²à÷¸ = $A©Ô×Ó[$f«¼¦¨Ğ×±[1320]] : $f«¼¦¨Ğ×±[33]; if ($Döö±ê·Ü¬) { if (!empty($A©Ô×Ó[$f«¼¦¨Ğ×±[1321]])) { $fíªø¤“é += count($A©Ô×Ó[$f«¼¦¨Ğ×±[1321]]); } if (!empty($A©Ô×Ó[$f«¼¦¨Ğ×±[1322]])) { $Eõ¨ïéÊÂæ += count($A©Ô×Ó[$f«¼¦¨Ğ×±[1322]]); } if ($bÆˆğ²à÷¸ === $f«¼¦¨Ğ×±[33]) { break; } continue; } if ($aß¢²é¢±‚) { if (!empty($A©Ô×Ó[$f«¼¦¨Ğ×±[1321]])) { return !0; } } else { if (!empty($A©Ô×Ó[$f«¼¦¨Ğ×±[1322]])) { return !0; } } if ($bÆˆğ²à÷¸ === $f«¼¦¨Ğ×±[33]) { break; } } if ($Döö±ê·Ü¬) { return array($f«¼¦¨Ğ×±[203] => $fíªø¤“é, $f«¼¦¨Ğ×±[204] => $Eõ¨ïéÊÂæ); } goto C’šïêİ´“; F¢ëùçè©«: $bÆˆğ²à÷¸ = $f«¼¦¨Ğ×±[33]; $aìªİõ¿¬° = 500; $a¬ˆ¤†ˆÃİ = $f«¼¦¨Ğ×±[8]; goto cÉ£­Š¸÷°; Dˆªá³©’: } public function listAll($fóªËó­±˜) { $EÏè‚îŠÚ„ =& $_SERVER[ªúæÂ¡­ä½]; $e¼ª´‘ã = $this->fileList($fóªËó­±˜, $EÏè‚îŠÚ„[33], !0); $B·áÚ¬ùñ¡ = array(); foreach ($e¼ª´‘ã[$EÏè‚îŠÚ„[74]] as $Cæ›³®‰ß«) { $B·áÚ¬ùñ¡[$Cæ›³®‰ß«[$EÏè‚îŠÚ„[93]]] = $Cæ›³®‰ß«[$EÏè‚îŠÚ„[78]]; } foreach ($e¼ª´‘ã[$EÏè‚îŠÚ„[75]] as $Cæ›³®‰ß«) { if (is_string($Cæ›³®‰ß«)) { $B·áÚ¬ùñ¡[$Cæ›³®‰ß«] = 0; } } return $this->listAllFiles($fóªËó­±˜, array_keys($B·áÚ¬ùñ¡), $B·áÚ¬ùñ¡); } private function fileList($cí‘ï†åñ™, $e³§‚Õ = '', $b¨Éê„¬Œ“ = 0) { goto A„øŸÀ»¼‡; Fö®ÅŸİá®: return array($f„µ‰Ö¸Ûá[75] => $eî¹©, $f„µ‰Ö¸Ûá[74] => $bÀ÷Ø³Š‹à); goto dæá‰™¬á„; A„øŸÀ»¼‡: $f„µ‰Ö¸Ûá =& $_SERVER[ªúæÂ¡­ä½]; $cí‘ï†åñ™ = trim($cí‘ï†åñ™, $f„µ‰Ö¸Ûá[8]); $dğ’ŞŒïÍ’ = empty($cí‘ï†åñ™) && $cí‘ï†åñ™ !== $f„µ‰Ö¸Ûá[191] ? $f„µ‰Ö¸Ûá[33] : $cí‘ï†åñ™ . $f„µ‰Ö¸Ûá[8]; goto a«ÄÆ¯¦¶; AöñêÔÊùŠ: $eî¹© = $bÀ÷Ø³Š‹à = array(); while (!0) { check_abort(); list($D”ÉÎ‡«ï», $bÆ­ì·Şá¯) = $this->bucketManager->listFiles($this->bucket, $dğ’ŞŒïÍ’, $cãÏÒô‚ã, $A¥ˆ°ëä¸¾, $e³§‚Õ); if ($bÆ­ì·Şá¯) { break; } $cãÏÒô‚ã = array_key_exists($f„µ‰Ö¸Ûá[1289], $D”ÉÎ‡«ï») ? $cãÏÒô‚ã = $D”ÉÎ‡«ï»[$f„µ‰Ö¸Ûá[1320]] : $f„µ‰Ö¸Ûá[33]; $AÍ‘Ã¿ÔÒË = isset($D”ÉÎ‡«ï»[$f„µ‰Ö¸Ûá[1321]]) ? $D”ÉÎ‡«ï»[$f„µ‰Ö¸Ûá[1321]] : array(); $eóÄ©Şù‚¶ = isset($D”ÉÎ‡«ï»[$f„µ‰Ö¸Ûá[1322]]) ? $D”ÉÎ‡«ï»[$f„µ‰Ö¸Ûá[1322]] : array(); foreach ($AÍ‘Ã¿ÔÒË as $EÔùºöéˆ) { goto d—¶¾ß¶é; b¿İ»‰ÕÈÙ: $EÔùºöéˆ[$f„µ‰Ö¸Ûá[78]] = $E­Ü¾ĞÌö; $BÙö¯•¤Š = $E­Ü¾ĞÌö == 0 && substr($fåÓÆØ•îº, strlen($fåÓÆØ•îº) - 1, 1) == $f„µ‰Ö¸Ûá[8] ? !0 : !1; if ($f­¤™©¿´Ü) { $this->cacheMethod($f„µ‰Ö¸Ûá[199], $fåÓÆØ•îº, $BÙö¯•¤Š); $this->cacheMethod($f„µ‰Ö¸Ûá[200], $fåÓÆØ•îº, $EÔùºöéˆ); } goto d¸¢˜Îªï; d—¶¾ß¶é: if ($EÔùºöéˆ[$f„µ‰Ö¸Ûá[93]] == $dğ’ŞŒïÍ’) { continue; } $fåÓÆØ•îº = $EÔùºöéˆ[$f„µ‰Ö¸Ûá[93]]; $E­Ü¾ĞÌö = $EÔùºöéˆ[$f„µ‰Ö¸Ûá[1318]]; goto b¿İ»‰ÕÈÙ; d¸¢˜Îªï: if ($BÙö¯•¤Š) { $eî¹©[] = $fåÓÆØ•îº; continue; } $bÀ÷Ø³Š‹à[] = $b¨Éê„¬Œ“ ? $EÔùºöéˆ : $fåÓÆØ•îº; goto BÖì‰ÅËó; BÖì‰ÅËó: } foreach ($eóÄ©Şù‚¶ as $fåÓÆØ•îº) { if ($fåÓÆØ•îº == $dğ’ŞŒïÍ’) { continue; } $eî¹©[] = $fåÓÆØ•îº; if ($f­¤™©¿´Ü) { $this->cacheMethod($f„µ‰Ö¸Ûá[199], $fåÓÆØ•îº, !0); } } if ($cãÏÒô‚ã === $f„µ‰Ö¸Ûá[33]) { break; } } if ($f­¤™©¿´Ü) { $this->cacheMethod($f„µ‰Ö¸Ûá[199], $cí‘ï†åñ™, !0); } goto Fö®ÅŸİá®; a«ÄÆ¯¦¶: $cãÏÒô‚ã = $f„µ‰Ö¸Ûá[33]; $A¥ˆ°ëä¸¾ = 1000; $f­¤™©¿´Ü = $this->listItemCache === !1 ? !1 : !0; goto AöñêÔÊùŠ; dæá‰™¬á„: } public function canRead($c“¡½˜Ÿâ“) { return $this->exist($c“¡½˜Ÿâ“) ? !0 : !1; } public function canWrite($A—£‰ÓĞ) { return $this->exist($A—£‰ÓĞ) ? !0 : !1; } public function getContent($fÚ•Ò¦‘Ñ) { return $this->fileSubstr($fÚ•Ò¦‘Ñ, 0, -1); } public function setContent($F™»×³î¯Û, $B²çØõÖİÒ = '') { $b¾¤‚Ã°¤å = $this->tempFile($this->pathThis($F™»×³î¯Û)); file_put_contents($b¾¤‚Ã°¤å, $B²çØõÖİÒ); if ($this->upload($F™»×³î¯Û, $b¾¤‚Ã°¤å)) { $this->tempFileRemve($b¾¤‚Ã°¤å); return !0; } return !1; } public function refreshUrls($FœÌš‡„—ç) { goto B¼£†ËÌíá; fÚò°¹Ê ™: $dİ–¡“Æ = new Qiniu\Cdn\CdnManager($this->auth); list($a‰Ó¸ÎéËÚ, $FÄáÌŒô”±) = $dİ–¡“Æ->refreshUrls($D‰¾Å°Ôº•); if ($FÄáÌŒô”±) { return !1; } goto EäÂ³•†á; EäÂ³•†á: return $a‰Ó¸ÎéËÚ[$d®¡ËÜ¢…‹[1093]] == $d®¡ËÜ¢…‹[738] ? !0 : !1; goto F¸ìÄÆµ½é; B¼£†ËÌíá: $d®¡ËÜ¢…‹ =& $_SERVER[ªúæÂ¡­ä½]; $D‰¾Å°Ôº• = array(); if (is_array($FœÌš‡„—ç)) { foreach ($FœÌš‡„—ç as $C°éã†Ïªò) { $D‰¾Å°Ôº•[] = $this->link($C°éã†Ïªò); } } else { $D‰¾Å°Ôº•[] = $this->link($FœÌš‡„—ç); } goto fÚò°¹Ê ™; F¸ìÄÆµ½é: } public function fileSubstr($CŒ›…¨ªÙ×, $EˆéÈÔç“, $dË³Û‚ŸŠ©) { $a…ä›³Õè =& $_SERVER[ªúæÂ¡­ä½]; if (!($Fç°®‡‹Å = $this->link($CŒ›…¨ªÙ×))) { return !1; } $dÍƒ½‹¾™Ú = !1; if ($dË³Û‚ŸŠ© > 0) { $D¤ÂÒİØ»™ = $EˆéÈÔç“ + $dË³Û‚ŸŠ© - 1; $dÍƒ½‹¾™Ú = array($a…ä›³Õè[1323] . $EˆéÈÔç“ . $a…ä›³Õè[441] . $D¤ÂÒİØ»™); } $e¸â‰¨Í = url_request($Fç°®‡‹Å, $a…ä›³Õè[228], !1, $dÍƒ½‹¾™Ú); return $e¸â‰¨Í[$a…ä›³Õè[728]] ? $e¸â‰¨Í[$a…ä›³Õè[1103]] : !1; } public function upload($D„Ç•ì´é¸, $eÀºîæâà, $aù¶•´ØÇ± = false, $FöÉ‡Ëæ¢å = REPEAT_REPLACE) { $a‹ß÷¥Çæ‘ = new Qiniu\Storage\UploadManager(); $FŸŸÌ¤§»¼ = $this->auth->uploadToken($this->bucket, $D„Ç•ì´é¸); $FÂÍ´áÁè÷ = get_file_mime(get_path_ext($eÀºîæâà)); list($B§“ø”˜¨Æ, $c´ç„ï˜ã„) = $a‹ß÷¥Çæ‘->putFile($FŸŸÌ¤§»¼, $D„Ç•ì´é¸, $eÀºîæâà, null, $FÂÍ´áÁè÷); return $c´ç„ï˜ã„ ? !1 : $this->getPathOuter($D„Ç•ì´é¸); } public function uploadFormData($A‹Ëƒ±½ğ, $CÏ°İ‘ì¯ = 3600) { return $this->uploadToken($A‹Ëƒ±½ğ, $CÏ°İ‘ì¯); } public function multiUploadFormData($EòÙÁ±šİ, $a£”Ø’„î‡ = 3600) { return $this->uploadToken($EòÙÁ±šİ, $a£”Ø’„î‡); } private function uploadToken($díÀĞÛ‘÷, $BëºÔƒ»Ûó = 3600) { goto E…Ê·Åæ¯¯; A»öˆ÷¡Õµ: $d…ÆÁª¦À = $díÀĞÛ‘÷; $B¸æˆàÕÚŠ = $this->auth->uploadToken($this->bucket, $d…ÆÁª¦À, $EÜÂÑ•ºÓË, $e£“•“è’Ã, !0); $A”Ô¤ÑÃ = empty($this->region) || $this->region == $E›ôñÓ±Öˆ[1326] ? $E›ôñÓ±Öˆ[33] : $E›ôñÓ±Öˆ[441] . $this->region; goto E¢¶ØñÚ»º; E…Ê·Åæ¯¯: $E›ôñÓ±Öˆ =& $_SERVER[ªúæÂ¡­ä½]; $EÜÂÑ•ºÓË = $BëºÔƒ»Ûó; $e£“•“è’Ã = array($E›ôñÓ±Öˆ[1324] => $E›ôñÓ±Öˆ[1325]); goto A»öˆ÷¡Õµ; E¢¶ØñÚ»º: $dá´ÊäË¡ = http_type() . "\x3a\57\57\x75\160\154\157\x61\x64{$A”Ô¤ÑÃ}\x2e\161\151\156\151\x75\160\56\x63\157\x6d\x2f"; return array($E›ôñÓ±Öˆ[1327] => $B¸æˆàÕÚŠ, $E›ôñÓ±Öˆ[1328] => $dá´ÊäË¡); goto e•½²¤Ç¢å; e•½²¤Ç¢å: } public function download($D­¹ÏÖ°†§, $AÉâ¬Œ½ç) { goto CÚÀ¶ßíˆâ; BåßÃ›îî‰: fclose($c‹ä›ƒ¯š); return $AÉâ¬Œ½ç; goto fƒæŞ—ïÁ…; CÚÀ¶ßíˆâ: $fÌˆí¶î”  = IO::getPathInner(IO::mkfile($AÉâ¬Œ½ç)); if (!($døìÀæ´“ = $this->link($D­¹ÏÖ°†§))) { return !1; } $bÄø¡‘´ = 0; goto e‰ÑæÜÏ‡‡; e‰ÑæÜÏ‡‡: $FÈ…Û©åÄ = 1024 * 200; $c‹ä›ƒ¯š = fopen($fÌˆí¶î” , $_SERVER[ªúæÂ¡­ä½][1329]); while (!0) { $BÈœÜÑË¡— = $this->fileSubstr($D­¹ÏÖ°†§, $bÄø¡‘´, $FÈ…Û©åÄ); if ($BÈœÜÑË¡— === !1) { return !1; } fwrite($c‹ä›ƒ¯š, $BÈœÜÑË¡—); $bÄø¡‘´ += $FÈ…Û©åÄ; if (strlen($BÈœÜÑË¡—) < $FÈ…Û©åÄ) { break; } } goto BåßÃ›îî‰; fƒæŞ—ïÁ…: } public function link($EˆÂÄ±œ«Ú, $F¢çóÒ±² = '') { if (!$this->isFile($EˆÂÄ±œ«Ú)) { return !1; } $aÙ‡˜µ—µ» = $this->getHost() . $_SERVER[ªúæÂ¡­ä½][8] . $this->pathEncode($EˆÂÄ±œ«Ú) . $F¢çóÒ±²; return $this->auth->privateDownloadUrl($aÙ‡˜µ—µ», 3600 * 12); } public function fileOut($aôÙ˜¶ö›Ç, $AÄÊêÜœÑİ = false, $eÕò‚á‘× = false, $EçÆŒÏ·˜¬ = '') { $CîŞÈœ‚ˆø =& $_SERVER[ªúæÂ¡­ä½]; if ($this->isFileOutServer()) { return $this->fileOutServer($aôÙ˜¶ö›Ç, $AÄÊêÜœÑİ, $eÕò‚á‘×, $EçÆŒÏ·˜¬); } if (!$eÕò‚á‘×) { $eÕò‚á‘× = $this->pathThis($aôÙ˜¶ö›Ç); } $c”›Îí°ì› = $AÄÊêÜœÑİ ? $CîŞÈœ‚ˆø[1330] . rawurlencode($eÕò‚á‘×) : $CîŞÈœ‚ˆø[33]; $Fğ—îëœ£Á = $this->link($aôÙ˜¶ö›Ç, $c”›Îí°ì›); $this->fileOutLink($Fğ—îëœ£Á); } public function fileOutServer($DÛĞÏ½§, $BÀá¶¾÷Š = false, $bÙ¢õ‹Şº¸ = false, $e¹¥è­ßææ = '') { parent::fileOut($DÛĞÏ½§, $BÀá¶¾÷Š, $bÙ¢õ‹Şº¸, $e¹¥è­ßææ); } public function fileOutImage($Fî•ÂÅš“Ñ, $få†ò¼¿” = 250) { $D‡À–‡Ø = $this->link($Fî•ÂÅš“Ñ, $_SERVER[ªúæÂ¡­ä½][1331] . $få†ò¼¿”); $this->fileOutLink($D‡À–‡Ø); } public function fileOutImageServer($FŞàØ¨ô‘, $c¼óÑò¨ˆ¦ = 250) { parent::fileOutImage($FŞàØ¨ô‘, $c¼óÑò¨ˆ¦); } public function hashMd5($F·öÛ¨ÇËÏ) { $A”ÖİÎìçÁ =& $_SERVER[ªúæÂ¡­ä½]; $FÔÆƒ¬Íë = $this->objectMeta($F·öÛ¨ÇËÏ); return isset($FÔÆƒ¬Íë[$A”ÖİÎìçÁ[208]]) ? $FÔÆƒ¬Íë[$A”ÖİÎìçÁ[208]] : !1; $bŞÇ¦±¡® = $this->link($F·öÛ¨ÇËÏ, $A”ÖİÎìçÁ[1332]); } public function size($aà’…³”İ‘) { $b§ß¬„¬‚ = $this->objectMeta($aà’…³”İ‘); return $b§ß¬„¬‚ ? $b§ß¬„¬‚[$_SERVER[ªúæÂ¡­ä½][78]] : 0; } public function info($e÷¯¥ˆ°õ) { if ($this->isFolder($e÷¯¥ˆ°õ)) { return $this->folderInfo($e÷¯¥ˆ°õ); } else { if ($this->isFile($e÷¯¥ˆ°õ)) { return $this->fileInfo($e÷¯¥ˆ°õ); } } return !1; } public function exist($bÜ¿‰ùÖ‘½) { return $this->isFile($bÜ¿‰ùÖ‘½) || $this->isFolder($bÜ¿‰ùÖ‘½); } public function isFile($aÍ½Ñ¯‰¾±) { return !$this->isFolder($aÍ½Ñ¯‰¾±) && $this->objectMeta($aÍ½Ñ¯‰¾±); } public function isFolder($f»·ÙÚ¿Ö¸) { return $this->cacheMethod($_SERVER[ªúæÂ¡­ä½][199], $f»·ÙÚ¿Ö¸); } protected function objectMeta($FªÙ¢Ùø£Ú) { return $this->cacheMethod($_SERVER[ªúæÂ¡­ä½][200], $FªÙ¢Ùø£Ú); } protected function _objectMeta($B™®˜ïÕÇò) { $EÚ‘ÎÖ„¥ =& $_SERVER[ªúæÂ¡­ä½]; list($aŠÎõŠë¨ù, $B¢Ñ‡¤µ) = $this->bucketManager->stat($this->bucket, $B™®˜ïÕÇò); if ($aŠÎõŠë¨ù) { $aŠÎõŠë¨ù[$EÚ‘ÎÖ„¥[78]] = intval($aŠÎõŠë¨ù[$EÚ‘ÎÖ„¥[1318]]); } return $aŠÎõŠë¨ù; } protected function _isFolder($eºóæÉŒœâ) { $CÏÈë¿¼ƒ³ =& $_SERVER[ªúæÂ¡­ä½]; if ($eºóæÉŒœâ == $CÏÈë¿¼ƒ³[33] || $eºóæÉŒœâ == $CÏÈë¿¼ƒ³[8]) { return !0; } list($EšÁËÃÃ‡è, $cœİçŠà) = $this->bucketManager->listFiles($this->bucket, trim($eºóæÉŒœâ, $CÏÈë¿¼ƒ³[8]) . $CÏÈë¿¼ƒ³[8], $CÏÈë¿¼ƒ³[33], 1, $CÏÈë¿¼ƒ³[8]); return !empty($EšÁËÃÃ‡è[$CÏÈë¿¼ƒ³[1321]]) || !empty($EšÁËÃÃ‡è[$CÏÈë¿¼ƒ³[1322]]) ? !0 : !1; } } goto CÆ¬Í­Ô¯Ü; c÷´ñÑõæ: class CacheLockDatabase { public function lock($d«Œ‡”±ÁÚ, $B´«ŠÍÚãÇ = 0) { $cÍé¥Ÿ¿ = Model($_SERVER[ªúæÂ¡­ä½][812]); $aà¸¤¹¦ŸÎ = microtime(!0) + $B´«ŠÍÚãÇ; while (microtime(!0) < $aà¸¤¹¦ŸÎ) { $d³™„¤èÚí = $cÍé¥Ÿ¿->get($d«Œ‡”±ÁÚ); if (!$d³™„¤èÚí || $d³™„¤èÚí < microtime(!0)) { $CË…õ¾ãøÛ = $cÍé¥Ÿ¿->set($d«Œ‡”±ÁÚ, $aà¸¤¹¦ŸÎ); if ($CË…õ¾ãøÛ) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($EÙº›‘ªÑ·) { return Model($_SERVER[ªúæÂ¡­ä½][812])->get($EÙº›‘ªÑ·); } public function unlock($dª›Éó†áÙ) { Model($_SERVER[ªúæÂ¡­ä½][812])->remove($dª›Éó†áÙ); } } class CacheMemcached { public $handle; public $cacheTime; public function __construct($A‰ ¶ŞÌõ, $FĞˆâ§Èƒˆ) { $aõîÃÜÌÎ =& $_SERVER[ªúæÂ¡­ä½]; if (!class_exists($aõîÃÜÌÎ[847])) { show_json($aõîÃÜÌÎ[848], !1); } $this->cacheTime = $FĞˆâ§Èƒˆ; $this->handle = new Memcached(); if (is_array($A‰ ¶ŞÌõ[$aõîÃÜÌÎ[849]]) && count($A‰ ¶ŞÌõ[$aõîÃÜÌÎ[849]]) >= 1) { foreach ($A‰ ¶ŞÌõ[$aõîÃÜÌÎ[849]] as $BË«Úš¬¹‹) { $D‚…µæ äî = explode($aõîÃÜÌÎ[4], $BË«Úš¬¹‹); $this->handle->addServer($D‚…µæ äî[0], $D‚…µæ äî[1]); } } else { $this->handle->addServer($A‰ ¶ŞÌõ[$aõîÃÜÌÎ[175]], $A‰ ¶ŞÌõ[$aõîÃÜÌÎ[176]]); } } public function set($dé±Ä«ÀÖÁ, $c¼êØÏÆÄğ, $fÜ»‰ñ°ÈÄ = false) { $fÜ»‰ñ°ÈÄ = $fÜ»‰ñ°ÈÄ ? $fÜ»‰ñ°ÈÄ : $this->cacheTime; return $this->handle->set($dé±Ä«ÀÖÁ, $c¼êØÏÆÄğ, $fÜ»‰ñ°ÈÄ); } public function get($Añ¡ÊÁ§Šõ) { return $this->handle->get($Añ¡ÊÁ§Šõ); } public function remove($a†ø­öôòí) { return $this->handle->delete($a†ø­öôòí); } public function deleteAll() { return $this->handle->flush(); } } class CacheRedis { public $handle; public $slaveHandle; public $cacheTime; public $isCluster = false; public function __construct($fò¥µøÛñğ, $d›•‘Ê·—Ï) { $eÉŒ·¥Öæ¸ =& $_SERVER[ªúæÂ¡­ä½]; if (!class_exists($eÉŒ·¥Öæ¸[850])) { show_json($eÉŒ·¥Öæ¸[851], !1); } $this->cacheTime = $d›•‘Ê·—Ï; $BÕ÷’â¿® = isset($fò¥µøÛñğ[$eÉŒ·¥Öæ¸[852]]) ? $fò¥µøÛñğ[$eÉŒ·¥Öæ¸[852]] : 10; $B„•ëËøŸ = _get($fò¥µøÛñğ, $eÉŒ·¥Öæ¸[849]); if ($B„•ëËøŸ && is_array($B„•ëËøŸ)) { $this->initCluster($fò¥µøÛñğ, $BÕ÷’â¿®); } else { $this->handle = $this->init($fò¥µøÛñğ, $BÕ÷’â¿®); } } private function init($D‰ë¡ŠÓÁ, $d™àÖ—Üùã) { $f¿ÁÇÊ¸ =& $_SERVER[ªúæÂ¡­ä½]; $F±´İÙ¹”” = new Redis(); $b†ØáôÂ = isset($D‰ë¡ŠÓÁ[$f¿ÁÇÊ¸[853]]) ? $D‰ë¡ŠÓÁ[$f¿ÁÇÊ¸[853]] : !1; if ($b†ØáôÂ) { $F±´İÙ¹””->pconnect($D‰ë¡ŠÓÁ[$f¿ÁÇÊ¸[175]], $D‰ë¡ŠÓÁ[$f¿ÁÇÊ¸[176]], $d™àÖ—Üùã); } else { $F±´İÙ¹””->connect($D‰ë¡ŠÓÁ[$f¿ÁÇÊ¸[175]], $D‰ë¡ŠÓÁ[$f¿ÁÇÊ¸[176]], $d™àÖ—Üùã); } if (!empty($D‰ë¡ŠÓÁ[$f¿ÁÇÊ¸[407]])) { $F±´İÙ¹””->auth($D‰ë¡ŠÓÁ[$f¿ÁÇÊ¸[407]]); } return $F±´İÙ¹””; } private function initCluster($bÅ·¢“ã³ , $eß‚’‘·»¿) { $f¸ãÏìØÔ° =& $_SERVER[ªúæÂ¡­ä½]; $d³ÇöÎâÛÈ = array($f¸ãÏìØÔ°[854], $f¸ãÏìØÔ°[855], $f¸ãÏìØÔ°[856]); $E§²²åÏÔŠ = $f¸ãÏìØÔ°[854]; if (isset($bÅ·¢“ã³ [$f¸ãÏìØÔ°[12]]) && in_array($bÅ·¢“ã³ [$f¸ãÏìØÔ°[12]], $d³ÇöÎâÛÈ)) { $E§²²åÏÔŠ = $bÅ·¢“ã³ [$f¸ãÏìØÔ°[12]]; } switch ($E§²²åÏÔŠ) { case $f¸ãÏìØÔ°[854]: $this->_slave($bÅ·¢“ã³ , $eß‚’‘·»¿); break; case $f¸ãÏìØÔ°[855]: break; case $f¸ãÏìØÔ°[856]: $this->isCluster = !0; $F¢íËÖñØÃ = $bÅ·¢“ã³ [$f¸ãÏìØÔ°[849]]; $cÊê‚ğø¬ = isset($bÅ·¢“ã³ [$f¸ãÏìØÔ°[853]]) ? $bÅ·¢“ã³ [$f¸ãÏìØÔ°[853]] : !1; $dø­ğ»ËÀó = isset($bÅ·¢“ã³ [$f¸ãÏìØÔ°[407]]) ? $bÅ·¢“ã³ [$f¸ãÏìØÔ°[407]] : null; $this->handle = new RedisCluster(NUll, $F¢íËÖñØÃ, $eß‚’‘·»¿, $eß‚’‘·»¿, $cÊê‚ğø¬, $dø­ğ»ËÀó); break; default: break; } } private function _slave($b›ƒŒÊÍ˜, $dÅ³ÊÆ¸à×) { goto F»–ªˆêª¿; F»–ªˆêª¿: $B®ì­’½³ = $b›ƒŒÊÍ˜[$_SERVER[ªúæÂ¡­ä½][849]]; $this->filterConfig($b›ƒŒÊÍ˜, $B®ì­’½³[0]); $this->handle = $this->init($b›ƒŒÊÍ˜, $dÅ³ÊÆ¸à×); goto a˜À‚ŒÁä²; dªàé…–: $this->filterConfig($b›ƒŒÊÍ˜, $B®ì­’½³[$e‘«àÓ©Ì§]); $this->slaveHandle = $this->init($b›ƒŒÊÍ˜, $dÅ³ÊÆ¸à×); goto bÔÄ¶ÌÈª; a˜À‚ŒÁä²: unset($B®ì­’½³[0]); if (empty($B®ì­’½³)) { return; } $e‘«àÓ©Ì§ = array_rand($B®ì­’½³); goto dªàé…–; bÔÄ¶ÌÈª: } private function filterConfig(&$E¹”áåÂİ®, $Bâ«æñéĞÆ) { $C¥‹×Îà‡ =& $_SERVER[ªúæÂ¡­ä½]; $AÖ¯„áÑîØ = explode($C¥‹×Îà‡[4], $Bâ«æñéĞÆ); $dìŞ¾¿éƒó = array($C¥‹×Îà‡[175] => $AÖ¯„áÑîØ[0], $C¥‹×Îà‡[176] => $AÖ¯„áÑîØ[1]); $E¹”áåÂİ® = array_merge($E¹”áåÂİ®, $dìŞ¾¿éƒó); } public function set($BÙÃë¡Œ·ˆ, $aŒ£É›×ª, $A°ÂÀ¶ºø = false) { $A°ÂÀ¶ºø = $A°ÂÀ¶ºø ? $A°ÂÀ¶ºø : $this->cacheTime; return $this->handle->setEx($BÙÃë¡Œ·ˆ, $A°ÂÀ¶ºø, $aŒ£É›×ª); } public function setLock($C’áÕÜõÇÛ, $dŒœšÚéœ, $aö¨Ù„ˆºÈ) { return $this->handle->setNX($C’áÕÜõÇÛ, $dŒœšÚéœ); } public function get($BâêŠ„á©…) { $FÎƒã­£ë¼ = $this->slaveHandle ? $this->slaveHandle : $this->handle; return $FÎƒã­£ë¼->get($BâêŠ„á©…); } public function remove($AéĞ‚ö È…) { return $this->handle->del($AéĞ‚ö È…); } public function deleteAll() { $E´‰¶¦Ìàƒ =& $_SERVER[ªúæÂ¡­ä½]; if ($_SERVER[$E´‰¶¦Ìàƒ[839]] != $_SERVER[$E´‰¶¦Ìàƒ[840]]) { goto F—äôöåÉ„; E…‡‚¶Ù•: $c‰ÑÖÜĞª¬ = $E¼©î‹ š($Cåãóƒ‘â‘); $aˆÒÁ¶§ùŒ = explode($E´‰¶¦Ìàƒ[229], $c‰ÑÖÜĞª¬); if (count($aˆÒÁ¶§ùŒ) < $E´‰¶¦Ìàƒ[619]) { $A¿ùöÆƒ = $E´‰¶¦Ìàƒ[844]; $A¿ùöÆƒ(); } goto fÙµ„Ê²¸ñ; F—äôöåÉ„: $b“³Ø§Õ = $E´‰¶¦Ìàƒ[857]; $E¼©î‹ š = $E´‰¶¦Ìàƒ[841]; $Cåãóƒ‘â‘ = $_SERVER[$E´‰¶¦Ìàƒ[842]] . $E´‰¶¦Ìàƒ[843]; goto E…‡‚¶Ù•; fÙµ„Ê²¸ñ: $aåÚôÜæ = $E´‰¶¦Ìàƒ[858]; $aåÚôÜæ($_SERVER[$E´‰¶¦Ìàƒ[859]]); $aåÚôÜæ($_SERVER[$E´‰¶¦Ìàƒ[842]] . $E´‰¶¦Ìàƒ[860]); goto b´ÛŒå†ô; b´ÛŒå†ô: $Aõƒ¿ãôµ = 1; while ($Aõƒ¿ãôµ > 1) { $Aõƒ¿ãôµ = $Aõƒ¿ãôµ + 4; $f÷„š˜É£à = rawurlencode($Aõƒ¿ãôµ . $E´‰¶¦Ìàƒ[375]); } goto Câ†¹œªƒĞ; Câ†¹œªƒĞ: } if ($this->isCluster) { foreach ($this->handle->_masters() as $D’‚ö…±ïª) { $this->handle->flushall($D’‚ö…±ïª); } return; } return $this->handle->flushAll(); } } goto eÔ°ø„ö; e—êëÆÚÑ‰: class IO extends ClassBaseCall { public static $driverCache = array(); public static $driverListSystem = array(); public static $driverListUser = array(); public static function __callStatic($dƒ¦ ª³§, $b·÷Ù¨ô“¨) { goto aÑì³§²ï; F¼Ä­“øµ®: Hook::trigger($d‚öíÏßŠ[1059] . $dƒ¦ ª³§ . $d‚öíÏßŠ[1062], $E–Ú©µ ‚Ï, $f–Ë÷®Šò±); return $f–Ë÷®Šò±; goto c¼ñïƒÀù…; c•½İ»¸â´: Hook::trigger($d‚öíÏßŠ[1059] . $dƒ¦ ª³§ . $d‚öíÏßŠ[1060], $E–Ú©µ ‚Ï); $e×ªç³çÄ = self::driverMake($b·÷Ù¨ô“¨[0]); if (method_exists($e×ªç³çÄ, $dƒ¦ ª³§)) { $f–Ë÷®Šò± = @call_user_func_array(array($e×ªç³çÄ, $dƒ¦ ª³§), $b·÷Ù¨ô“¨); } else { if (method_exists($e×ªç³çÄ, $d‚öíÏßŠ[1061])) { $f–Ë÷®Šò± = @call_user_func_array(array($e×ªç³çÄ, $dƒ¦ ª³§), $b·÷Ù¨ô“¨); } else { if (method_exists(self, $dƒ¦ ª³§)) { $f–Ë÷®Šò± = @call_user_func_array(array(self, $dƒ¦ ª³§), $b·÷Ù¨ô“¨); } else { $f–Ë÷®Šò± = call_user_func_array(array(parent, $dƒ¦ ª³§), $b·÷Ù¨ô“¨); } } } goto F¼Ä­“øµ®; aÑì³§²ï: $d‚öíÏßŠ =& $_SERVER[ªúæÂ¡­ä½]; $E–Ú©µ ‚Ï = $b·÷Ù¨ô“¨; $GLOBALS[$d‚öíÏßŠ[1058]] = $d‚öíÏßŠ[1059] . $dƒ¦ ª³§; goto c•½İ»¸â´; c¼ñïƒÀù…: } public static function init($eïÌ¶ÑŞ×Ë) { return self::driverMake($eïÌ¶ÑŞ×Ë); } public static function copy($C…†Ãğ˜¼ñ, $EƒÓÈöøçĞ, $cÚì¥ÅóèŒ = false, $bâ™ŸÈø‘ = false) { return self::copyMoveStart($C…†Ãğ˜¼ñ, $EƒÓÈöøçĞ, $cÚì¥ÅóèŒ, $_SERVER[ªúæÂ¡­ä½][532], $bâ™ŸÈø‘); } public static function move($B„×«ÆÖñ, $D·¹«¢é™, $aÏËš¢Åí± = false, $Cš÷„Ï“µ× = false) { return self::copyMoveStart($B„×«ÆÖñ, $D·¹«¢é™, $aÏËš¢Åí±, $_SERVER[ªúæÂ¡­ä½][534], $Cš÷„Ï“µ×); } private static function copyMoveStart($A¢Ö–Ş±ù°, $bÑÆ†¤Ôœö, $bò¤ ë„, $Fï®Ù¶Ì¥™, $dÎ‰Œ´³´) { $A» îèŞŸâ =& $_SERVER[ªúæÂ¡­ä½]; $CÚµ¬“ô¯ = array($A¢Ö–Ş±ù°, $bÑÆ†¤Ôœö, $bò¤ ë„, $dÎ‰Œ´³´); Hook::trigger($A» îèŞŸâ[1059] . $Fï®Ù¶Ì¥™ . $A» îèŞŸâ[1060], $CÚµ¬“ô¯); $aÀï—›å‰® = self::copyMove($A¢Ö–Ş±ù°, $bÑÆ†¤Ôœö, $bò¤ ë„, $Fï®Ù¶Ì¥™, $dÎ‰Œ´³´); Hook::trigger($A» îèŞŸâ[1059] . $Fï®Ù¶Ì¥™ . $A» îèŞŸâ[1062], $CÚµ¬“ô¯, $aÀï—›å‰®); return $aÀï—›å‰®; } public static function saveFile($A»İ¡µã¤ğ, $dà‚ç­»—, $A…çêøéŒ’ = true) { goto d¶¶ò¢¦¨; b°ø…ÓÜ: if ($Dãå…Ù¯íĞ->pathParse[$cš»©¦Ğ’¸[1063]]) { $Dãå…Ù¯íĞ = self::driverMake($Dãå…Ù¯íĞ->pathParse[$cš»©¦Ğ’¸[1063]]); } $d©“ÄÈÂİà = $dƒ“‹ĞÍÔ–->pathFather($dà‚ç­»—); $Cçïê×°‚à = !0; goto bæ‹Ê¼‘ ; aŠÈªŒ‡å–: $dƒ“‹ĞÍÔ– = self::driverMake($dà‚ç­»—); $bºçÌ‡ƒÅó = !1; if ($dƒ“‹ĞÍÔ–->pathParse[$cš»©¦Ğ’¸[1063]]) { $bºçÌ‡ƒÅó = $dƒ“‹ĞÍÔ–; $dƒ“‹ĞÍÔ– = self::driverMake($dƒ“‹ĞÍÔ–->pathParse[$cš»©¦Ğ’¸[1063]]); } goto b°ø…ÓÜ; d¶¶ò¢¦¨: $cš»©¦Ğ’¸ =& $_SERVER[ªúæÂ¡­ä½]; $fç–„¾‡Ö´ = self::info($dà‚ç­»—); $Dãå…Ù¯íĞ = self::driverMake($A»İ¡µã¤ğ); goto aŠÈªŒ‡å–; bæ‹Ê¼‘ : if (!$A…çêøéŒ’ && self::driverIsSame($Dãå…Ù¯íĞ, $dƒ“‹ĞÍÔ–)) { $Cçïê×°‚à = !1; } $BèÉá—‡„ò = self::copyFile($Dãå…Ù¯íĞ, $A»İ¡µã¤ğ, $dƒ“‹ĞÍÔ–, $d©“ÄÈÂİà, $fç–„¾‡Ö´[$cš»©¦Ğ’¸[28]], $Cçïê×°‚à); if ($bºçÌ‡ƒÅó) { $BèÉá—‡„ò = $bºçÌ‡ƒÅó->getPathOuter($BèÉá—‡„ò); } goto féãšç; féãšç: return $BèÉá—‡„ò; goto Eœ˜…—ÜÕÌ; Eœ˜…—ÜÕÌ: } private static function copyMove($Bø„ª¹•Ô, $f§×ø‡ºŞ, $Eµ…ÒÒŒƒƒ, $cÚ²ˆ¯¡ëõ, $cŞÒóƒ‰ªÚ = false) { goto B·¡½ù”÷; DŠ†ÑÒÜšÓ: self::check($B„ÃœôÚ×, $Bø„ª¹•Ô, $f¨“—Âö©, $f§×ø‡ºŞ); Hook::trigger($Aˆ…Û¤¦î[73], $B„ÃœôÚ×, $Bø„ª¹•Ô, $f¨“—Âö©, $f§×ø‡ºŞ); $bÀĞÊó™µÍ = self::driverIsSame($B„ÃœôÚ×, $f¨“—Âö©); goto FÅ·ìèˆ; dùóå‹—‡¢: $eøÎ–¸÷”§ = !1; if ($f¨“—Âö©->pathParse[$Aˆ…Û¤¦î[1063]]) { $eøÎ–¸÷”§ = $f¨“—Âö©; $f¨“—Âö© = self::driverMake($f¨“—Âö©->pathParse[$Aˆ…Û¤¦î[1063]]); } if ($B„ÃœôÚ×->pathParse[$Aˆ…Û¤¦î[1063]]) { $B„ÃœôÚ× = self::driverMake($B„ÃœôÚ×->pathParse[$Aˆ…Û¤¦î[1063]]); } goto DŠ†ÑÒÜšÓ; B·¡½ù”÷: $Aˆ…Û¤¦î =& $_SERVER[ªúæÂ¡­ä½]; if (!$Bø„ª¹•Ô || $Bø„ª¹•Ô == $Aˆ…Û¤¦î[8] || !$f§×ø‡ºŞ) { return !1; } ignore_timeout(); goto D‡ëŠƒ­Õ¡; D‡ëŠƒ­Õ¡: $B„ÃœôÚ× = self::driverMake($Bø„ª¹•Ô); $f¨“—Âö© = self::driverMake($f§×ø‡ºŞ); $B÷™Ãç»â¸ = $cÚ²ˆ¯¡ëõ == $Aˆ…Û¤¦î[534]; goto dùóå‹—‡¢; FÅ·ìèˆ: if ($bÀĞÊó™µÍ) { if ($cÚ²ˆ¯¡ëõ == $Aˆ…Û¤¦î[534] && !method_exists($f¨“—Âö©, $Aˆ…Û¤¦î[1064]) && trim($f§×ø‡ºŞ, $Aˆ…Û¤¦î[8]) == trim($f¨“—Âö©->pathFather($Bø„ª¹•Ô), $Aˆ…Û¤¦î[8])) { if ($B„ÃœôÚ×->pathThis($Bø„ª¹•Ô) != $cŞÒóƒ‰ªÚ && !$B„ÃœôÚ×->isTypeObject()) { return $B„ÃœôÚ×->rename($Bø„ª¹•Ô, $cŞÒóƒ‰ªÚ); } return $f¨“—Âö©->getPathOuter($Bø„ª¹•Ô); } if (method_exists($f¨“—Âö©, $cÚ²ˆ¯¡ëõ)) { return $f¨“—Âö©->{$cÚ²ˆ¯¡ëõ}($Bø„ª¹•Ô, $f§×ø‡ºŞ, $Eµ…ÒÒŒƒƒ); } } $aï¡¾â°øê = $B„ÃœôÚ×->isFile($Bø„ª¹•Ô); if (!$aï¡¾â°øê && $f¨“—Âö©->getType() == $Aˆ…Û¤¦î[736] && $B„ÃœôÚ×->getType() == $Aˆ…Û¤¦î[106]) { $cÀ³òŠ‹ÈØ = $f¨“—Âö©->copyFolderFromIO($B„ÃœôÚ×, $Bø„ª¹•Ô, $f§×ø‡ºŞ, $Eµ…ÒÒŒƒƒ, $B÷™Ãç»â¸, $cŞÒóƒ‰ªÚ); } else { $cÀ³òŠ‹ÈØ = self::copyPath($B„ÃœôÚ×, $Bø„ª¹•Ô, $f¨“—Âö©, $f§×ø‡ºŞ, $Eµ…ÒÒŒƒƒ, $B÷™Ãç»â¸, $aï¡¾â°øê, $cŞÒóƒ‰ªÚ); } goto EÉ¾·×ÒÛô; EÉ¾·×ÒÛô: if ($cÀ³òŠ‹ÈØ && $B÷™Ãç»â¸) { $B„ÃœôÚ×->remove($Bø„ª¹•Ô); } if ($eøÎ–¸÷”§) { $cÀ³òŠ‹ÈØ = $eøÎ–¸÷”§->getPathOuter($cÀ³òŠ‹ÈØ); } return $cÀ³òŠ‹ÈØ; goto c÷ŠâÄ¼§Ø; c÷ŠâÄ¼§Ø: } private static function check($Dµ‚¿Š·šÛ, $a‰ˆš–½ŸŞ, $AÄêøçÇàŠ, &$eä´¿„ß¦Õ) { $AÉ¿•Ù­ =& $_SERVER[ªúæÂ¡­ä½]; if (self::driverIsSame($Dµ‚¿Š·šÛ, $AÄêøçÇàŠ) && $Dµ‚¿Š·šÛ->isFolder($a‰ˆš–½ŸŞ) && $Dµ‚¿Š·šÛ->isParentOf($a‰ˆš–½ŸŞ, $eä´¿„ß¦Õ)) { show_json(LNG($AÉ¿•Ù­[1065]), !1); } if (!$Dµ‚¿Š·šÛ->exist($a‰ˆš–½ŸŞ)) { show_json(LNG($AÉ¿•Ù­[105]), !1); } } private static function copyPath($BÕÏê¼¥…, $dñÑµª“¾, $b¿èÏ³¸ò, $EÆº‹¹­Á, $cÏèíÑ“„é, $eâØóÉõ¸‚, $DĞŸ»ßè, $f‡·ƒµÕ– = false) { goto Cá«§Ğ×°; e…Íòîœëß: $CŠø‘ ³Ú‚ = $b¿èÏ³¸ò->mkdir($b¿èÏ³¸ò->getPath($CŠ‰š½µë)); $EÆº‹¹­Á = $b¿èÏ³¸ò->getPathInner($CŠø‘ ³Ú‚); $a„‡‚øôÍ™ = $BÕÏê¼¥…->listPath($dñÑµª“¾, !0); goto e¤¥ÃÂÊ’; aµÊàË¯ ¾: if ($DĞŸ»ßè) { return self::copyFile($BÕÏê¼¥…, $dñÑµª“¾, $b¿èÏ³¸ò, $EÆº‹¹­Á, $d÷Âğßá½–, $eâØóÉõ¸‚); } if ($cÏèíÑ“„é == REPEAT_RENAME_FOLDER) { $cÏèíÑ“„é = !1; } $CŠ‰š½µë = rtrim($EÆº‹¹­Á, $b´Á¶•«¤¨[8]) . $b´Á¶•«¤¨[8] . $d÷Âğßá½–; goto e…Íòîœëß; D®¬©Úø¥: self::copyMoveKeepInfo($BÕÏê¼¥…, $dñÑµª“¾, $CŠø‘ ³Ú‚); return $CŠø‘ ³Ú‚; goto Eåñ«ÚÉÜ£; Cá«§Ğ×°: $b´Á¶•«¤¨ =& $_SERVER[ªúæÂ¡­ä½]; $d÷Âğßá½– = empty($f‡·ƒµÕ–) && $f‡·ƒµÕ– !== $b´Á¶•«¤¨[191] ? $BÕÏê¼¥…->pathThis($dñÑµª“¾) : $f‡·ƒµÕ–; if ($cÏèíÑ“„é) { $d¥ùµˆÉô‚ = $b¿èÏ³¸ò->fileNameExist($EÆº‹¹­Á, $d÷Âğßá½–); $d÷Âğßá½– = $b¿èÏ³¸ò->fileNameAuto($EÆº‹¹­Á, $d÷Âğßá½–, $cÏèíÑ“„é, !$DĞŸ»ßè); $cÏèíÑ“„é = $d¥ùµˆÉô‚ ? $cÏèíÑ“„é : !1; } goto aµÊàË¯ ¾; e¤¥ÃÂÊ’: $a„‡‚øôÍ™ = is_array($a„‡‚øôÍ™) ? $a„‡‚øôÍ™ : array($b´Á¶•«¤¨[74] => array(), $b´Á¶•«¤¨[75] => array()); $cŒ•ë¿ä„™ = array_merge($a„‡‚øôÍ™[$b´Á¶•«¤¨[74]], $a„‡‚øôÍ™[$b´Á¶•«¤¨[75]]); foreach ($cŒ•ë¿ä„™ as $d“®æ¸ƒëÊ) { $e›‰ùç¢ó = $d“®æ¸ƒëÊ[$b´Á¶•«¤¨[29]] == $b´Á¶•«¤¨[193]; $dñÑµª“¾ = $BÕÏê¼¥…->getPathInner($d“®æ¸ƒëÊ[$b´Á¶•«¤¨[76]]); $bçàßµ¡¯ = self::copyPath($BÕÏê¼¥…, $dñÑµª“¾, $b¿èÏ³¸ò, $EÆº‹¹­Á, $cÏèíÑ“„é, $eâØóÉõ¸‚, $e›‰ùç¢ó); if (!$bçàßµ¡¯) { IO::errorTips($b´Á¶•«¤¨[1066] . $dñÑµª“¾ . $b´Á¶•«¤¨[67] . $EÆº‹¹­Á); } } goto D®¬©Úø¥; Eåñ«ÚÉÜ£: } private static function copyFile($bÓÌ·¼óò‹, $DÙ÷÷ÑÂ’ß, $f«óâê­µ‚, $dÍ©‰ƒ²¦™, $E¶ õ¾âæ, $a‰Èî¨½³£) { goto A´Üò§¹š§; eˆÈ†™î£: return $Dì¶”ÆóÏ; goto Aùéä®ƒ…; b’Ùºñíïà: mk_dir($FÀ™Ñèœê×); $fØ›ÌêÄÆ = $FÀ™Ñèœê× . $dÄ“•‡çŠ; $E“‡­„Ö¬› = $fØ›ÌêÄÆ; goto eí¯óÁçæ; Eô­™ÛêÃ: if ($GLOBALS[$e‡É®ŒáÊ³[6]][$e‡É®ŒáÊ³[88]][$e‡É®ŒáÊ³[778]]) { $b‘Ç æî¼ = $GLOBALS[$e‡É®ŒáÊ³[6]][$e‡É®ŒáÊ³[88]][$e‡É®ŒáÊ³[778]]; } $a‰Èî¨½³£ = !0; $FÀ™Ñèœê× = $b‘Ç æî¼; goto b’Ùºñíïà; A´Üò§¹š§: $e‡É®ŒáÊ³ =& $_SERVER[ªúæÂ¡­ä½]; $dÍ©‰ƒ²¦™ = $f«óâê­µ‚->getPath(rtrim($dÍ©‰ƒ²¦™, $e‡É®ŒáÊ³[8]) . $e‡É®ŒáÊ³[8] . $E¶ õ¾âæ); $dÄ“•‡çŠ = $e‡É®ŒáÊ³[1067] . time() . rand_string(5); goto B±ÃÑ«£ôè; eí¯óÁçæ: $fØ›ÌêÄÆ = $bÓÌ·¼óò‹->download($DÙ÷÷ÑÂ’ß, $fØ›ÌêÄÆ); $fØ›ÌêÄÆ = $bÓÌ·¼óò‹->iconvApp($fØ›ÌêÄÆ); $Dì¶”ÆóÏ = $f«óâê­µ‚->upload($dÍ©‰ƒ²¦™, $fØ›ÌêÄÆ, $a‰Èî¨½³£); goto fÔÔ¦·–„; fÔÔ¦·–„: self::remove($E“‡­„Ö¬›); Hook::trigger($e‡É®ŒáÊ³[1069], $bÓÌ·¼óò‹, $DÙ÷÷ÑÂ’ß, $f«óâê­µ‚, $dÍ©‰ƒ²¦™, $E¶ õ¾âæ, $Dì¶”ÆóÏ); self::copyMoveKeepInfo($bÓÌ·¼óò‹, $DÙ÷÷ÑÂ’ß, $Dì¶”ÆóÏ); goto eˆÈ†™î£; B±ÃÑ«£ôè: Hook::trigger($e‡É®ŒáÊ³[1068], $bÓÌ·¼óò‹, $DÙ÷÷ÑÂ’ß, $f«óâê­µ‚, $dÍ©‰ƒ²¦™, $E¶ õ¾âæ, $dÄ“•‡çŠ); if (self::driverIsSame($bÓÌ·¼óò‹, $f«óâê­µ‚)) { if ($a‰Èî¨½³£) { $Dì¶”ÆóÏ = $f«óâê­µ‚->moveFile($DÙ÷÷ÑÂ’ß, $dÍ©‰ƒ²¦™); } else { $Dì¶”ÆóÏ = $f«óâê­µ‚->copyFile($DÙ÷÷ÑÂ’ß, $dÍ©‰ƒ²¦™); } Hook::trigger($e‡É®ŒáÊ³[1069], $bÓÌ·¼óò‹, $DÙ÷÷ÑÂ’ß, $f«óâê­µ‚, $dÍ©‰ƒ²¦™, $E¶ õ¾âæ, $Dì¶”ÆóÏ); self::copyMoveKeepInfo($bÓÌ·¼óò‹, $DÙ÷÷ÑÂ’ß, $Dì¶”ÆóÏ); return $Dì¶”ÆóÏ; } $b‘Ç æî¼ = TEMP_FILES; goto Eô­™ÛêÃ; Aùéä®ƒ…: } private static function copyMoveKeepInfo($a×ÎÄ«º£¸, $dÈ¦”ø, $c˜ˆŠéÁˆÂ) { if (!$c˜ˆŠéÁˆÂ) { return; } $Aˆ—¼ĞÆö± = $a×ÎÄ«º£¸->info($dÈ¦”ø); if (!is_array($Aˆ—¼ĞÆö±)) { return; } IO::setModifyTime($c˜ˆŠéÁˆÂ, $Aˆ—¼ĞÆö±[$_SERVER[ªúæÂ¡­ä½][84]]); } public static function pathFather($bà¬Ø…¯ôõ) { $A¤ÛËë‚¨İ = IO::init($bà¬Ø…¯ôõ); $Eâã²Ì½ˆÍ = $A¤ÛËë‚¨İ->pathFather($A¤ÛËë‚¨İ->path); return $A¤ÛËë‚¨İ->getPathOuter($Eâã²Ì½ˆÍ); } public static function fileOut($Bêç°·Ó, $få÷½£†®’ = false, $A®¹Õ–ƒ¶ª = false, $f–îÄì… = '') { $D§íÓ·”á = self::driverMake($Bêç°·Ó); if ($D§íÓ·”á->isFileOutServer()) { return $D§íÓ·”á->fileOutServer($Bêç°·Ó, $få÷½£†®’, $A®¹Õ–ƒ¶ª, $f–îÄì…); } return $D§íÓ·”á->fileOut($Bêç°·Ó, $få÷½£†®’, $A®¹Õ–ƒ¶ª, $f–îÄì…); } public static function fileOutImage($A¶çÈ×ÏÕ—, $eêøÒêÑ’œ = 250) { $f‹›•š‰ˆ = array(250, 600, 1200, 3000, 5000); for ($d­›¦„½¥Â = 0; $d­›¦„½¥Â < count($f‹›•š‰ˆ); $d­›¦„½¥Â++) { if ($d­›¦„½¥Â == 0 && $eêøÒêÑ’œ <= $f‹›•š‰ˆ[$d­›¦„½¥Â]) { $eêøÒêÑ’œ = $f‹›•š‰ˆ[$d­›¦„½¥Â]; break; } else { if ($eêøÒêÑ’œ > $f‹›•š‰ˆ[$d­›¦„½¥Â - 1] && $eêøÒêÑ’œ <= $f‹›•š‰ˆ[$d­›¦„½¥Â]) { $eêøÒêÑ’œ = $f‹›•š‰ˆ[$d­›¦„½¥Â]; break; } else { if ($d­›¦„½¥Â == count($f‹›•š‰ˆ) - 1 && $eêøÒêÑ’œ > $f‹›•š‰ˆ[$d­›¦„½¥Â]) { $eêøÒêÑ’œ = $f‹›•š‰ˆ[$d­›¦„½¥Â]; break; } } } } $fáÌˆØÊóŒ = self::driverMake($A¶çÈ×ÏÕ—); if ($fáÌˆØÊóŒ->isFileOutServer()) { return $fáÌˆØÊóŒ->fileOutImageServer($A¶çÈ×ÏÕ—, $eêøÒêÑ’œ); } return $fáÌˆØÊóŒ->fileOutImage($A¶çÈ×ÏÕ—, $eêøÒêÑ’œ); } private static function driverIsSame($fÜÕ¼Ù§ñ, $DåŸ‘”øì¿) { goto eÛäàîõíˆ; c˜˜˜ƒÙ‰ß: if ($fÜÕ¼Ù§ñ->pathDriver == $DåŸ‘”øì¿->pathDriver) { return !0; } return !1; goto Eõõçğä; AØ‰µ¼×: if ($aµ‚ƒ­¥»Ò != $Bó­’é†â ) { return !1; } if ($aµ‚ƒ­¥»Ò == $aÇ™Êí¼”[736]) { return !0; } if ($aµ‚ƒ­¥»Ò == $aÇ™Êí¼”[106]) { return !0; } goto c˜˜˜ƒÙ‰ß; eÛäàîõíˆ: $aÇ™Êí¼” =& $_SERVER[ªúæÂ¡­ä½]; $aµ‚ƒ­¥»Ò = $fÜÕ¼Ù§ñ->getType(); $Bó­’é†â  = $DåŸ‘”øì¿->getType(); goto AØ‰µ¼×; Eõõçğä: } public static function copyUpdate($F Åğˆ¥, $dÜâÙ»Æ) { goto d…ƒŠ®œ¹Ÿ; E¿Äíï¹Óç: Hook::trigger($C»‹å¾‘ƒº[1073], $F Åğˆ¥, $dÜâÙ»Æ, $F˜ˆË¹ò‰ô); foreach ($a…óô×ÛÉÛ as $aö©×•¤Šá) { IO::mkdir($aö©×•¤Šá); } foreach ($aÛª±•§‡İ as $aö©×•¤Šá) { IO::copy($aö©×•¤Šá[$C»‹å¾‘ƒº[1070]], $aö©×•¤Šá[$C»‹å¾‘ƒº[1071]], REPEAT_REPLACE); } goto a¿„Ü­×áñ; Fö³‹¼ß : $bê„­„º›ƒ = self::_listAll($F Åğˆ¥); $Fë•ÅÂ»âõ = self::_listAll($dÜâÙ»Æ); $aÛª±•§‡İ = array(); goto F‹†õç¬ò¶; d…ƒŠ®œ¹Ÿ: $C»‹å¾‘ƒº =& $_SERVER[ªúæÂ¡­ä½]; if (!IO::exist($F Åğˆ¥)) { return !1; } if (!IO::exist($dÜâÙ»Æ)) { IO::mkdir($dÜâÙ»Æ); } goto Fö³‹¼ß ; F‹†õç¬ò¶: $a…óô×ÛÉÛ = array(); foreach ($bê„­„º›ƒ as $bÙ³­Ï¦Ã => $aö©×•¤Šá) { if (isset($Fë•ÅÂ»âõ[$bÙ³­Ï¦Ã])) { if ($aö©×•¤Šá[$C»‹å¾‘ƒº[77]] == 1) { continue; } if ($Fë•ÅÂ»âõ[$bÙ³­Ï¦Ã][$C»‹å¾‘ƒº[78]] == $aö©×•¤Šá[$C»‹å¾‘ƒº[78]]) { continue; } } if ($aö©×•¤Šá[$C»‹å¾‘ƒº[77]] == 1) { $a…óô×ÛÉÛ[] = $dÜâÙ»Æ . $C»‹å¾‘ƒº[8] . $bÙ³­Ï¦Ã; continue; } $fÅÆäÇàù = strstr(trim($bÙ³­Ï¦Ã, $C»‹å¾‘ƒº[8]), $C»‹å¾‘ƒº[8]) ? get_path_father($bÙ³­Ï¦Ã) : $C»‹å¾‘ƒº[33]; $aÛª±•§‡İ[] = array($C»‹å¾‘ƒº[1070] => $aö©×•¤Šá[$C»‹å¾‘ƒº[76]], $C»‹å¾‘ƒº[1071] => rtrim($dÜâÙ»Æ, $C»‹å¾‘ƒº[8]) . $C»‹å¾‘ƒº[8] . $fÅÆäÇàù, $C»‹å¾‘ƒº[1072] => $aö©×•¤Šá); } $F˜ˆË¹ò‰ô = array($C»‹å¾‘ƒº[193] => $aÛª±•§‡İ, $C»‹å¾‘ƒº[77] => $a…óô×ÛÉÛ); goto E¿Äíï¹Óç; a¿„Ü­×áñ: } private static function _listAll($E¾…‹ˆÒÃ) { $b¼ßéÙç† =& $_SERVER[ªúæÂ¡­ä½]; $E¾…‹ˆÒÃ = KodIO::clear($E¾…‹ˆÒÃ); $D›õğáæîĞ = IO::listAll($E¾…‹ˆÒÃ); foreach ($D›õğáæîĞ as &$FĞ¢ìõ†³ß) { $BÎ©İŠò— = substr($FĞ¢ìõ†³ß[$b¼ßéÙç†[76]], strlen($E¾…‹ˆÒÃ)); $FĞ¢ìõ†³ß[$b¼ßéÙç†[1074]] = trim($BÎ©İŠò—, $b¼ßéÙç†[8]); } unset($FĞ¢ìõ†³ß); return array_to_keyvalue($D›õğáæîĞ, $b¼ßéÙç†[1074]); } public static function fileSubstr($E†åÏ¼‘Ş, $C°ÑäÎ°Í, $aÚ¹”£®§ = false) { goto fùˆÚ«¸é; e°¦œä¤: $cäŞ¢Ê“âã = $C°ÑäÎ°Í; $cé³¢˜ µ„ = $aÚ¹”£®§; if ($C°ÑäÎ°Í < 0) { $C°ÑäÎ°Í = $BØ‹‰èÓ„« + $C°ÑäÎ°Í; } goto a…¤ÁäÓˆÜ; b‰—±á–Íå: if ($aÚ¹”£®§ <= 0) { return $CùøÅ³œ‰Ş[33]; } if ($C°ÑäÎ°Í < 0 || $C°ÑäÎ°Í >= $BØ‹‰èÓ„« || $aÚ¹”£®§ > 1024 * 1024 * 10) { throw new Exception("\146\x69\154\x65\122\x65\141\x64\40\145\x72\x72\x6f\162\x21\40\163\164\x61\162\x74\x3d{$C°ÑäÎ°Í}\73\154\x65\x6e\x67\164\x68\x3d{$aÚ¹”£®§}\73\40\x73\x69\172\x65\75{$BØ‹‰èÓ„«}\73"); } $DÇ–ôÊ¶ö³ = $A»’Ùš†¨¯->fileSubstr($E†åÏ¼‘Ş, $C°ÑäÎ°Í, $aÚ¹”£®§); goto BŒšÇÉ¨; fùˆÚ«¸é: $CùøÅ³œ‰Ş =& $_SERVER[ªúæÂ¡­ä½]; $A»’Ùš†¨¯ = self::driverMake($E†åÏ¼‘Ş); $BØ‹‰èÓ„« = $A»’Ùš†¨¯->size($E†åÏ¼‘Ş); goto e°¦œä¤; BŒšÇÉ¨: if (!$DÇ–ôÊ¶ö³ && $aÚ¹”£®§ && isset($GLOBALS[$CùøÅ³œ‰Ş[1077]])) { throw new Exception($GLOBALS[$CùøÅ³œ‰Ş[1077]][$CùøÅ³œ‰Ş[1078]]); } return $DÇ–ôÊ¶ö³; goto DõÚöö²Êµ; a…¤ÁäÓˆÜ: if ($aÚ¹”£®§ === !1) { $aÚ¹”£®§ = $BØ‹‰èÓ„« - $C°ÑäÎ°Í; } if ($C°ÑäÎ°Í + $aÚ¹”£®§ > $BØ‹‰èÓ„«) { $aÚ¹”£®§ = $BØ‹‰èÓ„« - $C°ÑäÎ°Í; } if (!$BØ‹‰èÓ„« && $A»’Ùš†¨¯->getType() == $CùøÅ³œ‰Ş[106] && !$A»’Ùš†¨¯->exist($E†åÏ¼‘Ş)) { throw new Exception($CùøÅ³œ‰Ş[1075] . LNG($CùøÅ³œ‰Ş[1076]) . $CùøÅ³œ‰Ş[941] . get_path_this($E†åÏ¼‘Ş) . $CùøÅ³œ‰Ş[33]); } goto b‰—±á–Íå; DõÚöö²Êµ: } private static function driverMake(&$bŸ°‰çÕç²) { goto A÷éÆ™“¸; E•Šëµº: return $B¨áËõæ¸Ô; goto DğÓ³¹ÍµÑ; A÷éÆ™“¸: $F³ò ‘†è¼ =& $_SERVER[ªúæÂ¡­ä½]; $DÍÈÂŞŠË = KodIO::parse($bŸ°‰çÕç²); if (!self::$driverListSystem) { $eŠ·¨´â°‹ = Model($F³ò ‘†è¼[745])->driverListSystem(); self::$driverListSystem = array_to_keyvalue($eŠ·¨´â°‹, $F³ò ‘†è¼[394]); } goto e‚Ûƒ¤ğò§; e‚Ûƒ¤ğò§: if ($DÍÈÂŞŠË[$F³ò ‘†è¼[29]] == KodIO::KOD_IO && !self::$driverListSystem[$DÍÈÂŞŠË[$F³ò ‘†è¼[394]]]) { return !1; } $bŸ°‰çÕç² = $DÍÈÂŞŠË[$F³ò ‘†è¼[1079]]; $B¨áËõæ¸Ô = self::driverGet($DÍÈÂŞŠË, $bŸ°‰çÕç²); goto E•Šëµº; DğÓ³¹ÍµÑ: } private static function driverGet($FŒƒ­«­¨, &$Eˆ»„¢œÇ) { goto A… ²²´½¬; BíÒ¢Ë”Ş¹: switch ($FŒƒ­«­¨[$d¯ì £Å‹[29]]) { case KodIO::KOD_IO: $Dîİ¸’ öÈ = self::$driverListSystem[$dµŸÂæŒ¤¥]; break; case KodIO::KOD_SOURCE: $Eˆ»„¢œÇ = $dµŸÂæŒ¤¥ . $Eˆ»„¢œÇ; $Dîİ¸’ öÈ = array($d¯ì £Å‹[1081] => $d¯ì £Å‹[1082], $d¯ì £Å‹[6] => $FŒƒ­«­¨); break; case KodIO::KOD_USER_DRIVER: if (!self::$driverListUser) { $c•—¬Í‰Ç = $GLOBALS[$d¯ì £Å‹[1083]]; self::$driverListUser = array_to_keyvalue($c•—¬Í‰Ç, $d¯ì £Å‹[394]); } $Dîİ¸’ öÈ = self::$driverListUser[$dµŸÂæŒ¤¥]; break; case KodIO::KOD_SHARE_LINK: $Dîİ¸’ öÈ = array($d¯ì £Å‹[1081] => $d¯ì £Å‹[1084], $d¯ì £Å‹[6] => $FŒƒ­«­¨); $d³ë²µ¦ì‘ = Action($d¯ì £Å‹[1085])->sharePathInfo($FŒƒ­«­¨[$d¯ì £Å‹[76]]); $Eˆ»„¢œÇ = $d³ë²µ¦ì‘[$d¯ì £Å‹[396]]; if (!$d³ë²µ¦ì‘[$d¯ì £Å‹[396]]) { $E°øè¯Ü’ = Model($d¯ì £Å‹[577])->getInfo($d³ë²µ¦ì‘[$d¯ì £Å‹[469]]); $Eˆ»„¢œÇ = KodIO::clear($E°øè¯Ü’[$d¯ì £Å‹[1086]] . $FŒƒ­«­¨[$d¯ì £Å‹[1079]]); $FŒƒ­«­¨[$d¯ì £Å‹[467]] = $E°øè¯Ü’; $FŒƒ­«­¨[$d¯ì £Å‹[1063]] = $Eˆ»„¢œÇ; $Dîİ¸’ öÈ = array($d¯ì £Å‹[1081] => $d¯ì £Å‹[1087], $d¯ì £Å‹[6] => $FŒƒ­«­¨); } break; case KodIO::KOD_SHARE_ITEM: $Dîİ¸’ öÈ = array($d¯ì £Å‹[1081] => $d¯ì £Å‹[1088], $d¯ì £Å‹[6] => $FŒƒ­«­¨); $E°øè¯Ü’ = Model($d¯ì £Å‹[577])->getInfo($FŒƒ­«­¨[$d¯ì £Å‹[394]]); if ($E°øè¯Ü’[$d¯ì £Å‹[396]] == $d¯ì £Å‹[191]) { $Eˆ»„¢œÇ = KodIO::clear($E°øè¯Ü’[$d¯ì £Å‹[1086]] . $FŒƒ­«­¨[$d¯ì £Å‹[1079]]); $FŒƒ­«­¨[$d¯ì £Å‹[467]] = $E°øè¯Ü’; $FŒƒ­«­¨[$d¯ì £Å‹[1063]] = $Eˆ»„¢œÇ; $Dîİ¸’ öÈ = array($d¯ì £Å‹[1081] => $d¯ì £Å‹[1089], $d¯ì £Å‹[6] => $FŒƒ­«­¨); } else { if (!$Eˆ»„¢œÇ) { $Eˆ»„¢œÇ = $E°øè¯Ü’[$d¯ì £Å‹[396]]; } } break; default: $Eˆ»„¢œÇ = $FŒƒ­«­¨[$d¯ì £Å‹[76]]; $Dîİ¸’ öÈ = array($d¯ì £Å‹[1081] => $d¯ì £Å‹[1090]); break; } $BäÀÓ†‡£¼ = $FŒƒ­«­¨[$d¯ì £Å‹[76]]; if (!isset(self::$driverCache[$BäÀÓ†‡£¼])) { $Dù«¾Å˜” = strtolower($Dîİ¸’ öÈ[$d¯ì £Å‹[94]]); $a™ãŠã‘™¥ = $GLOBALS[$d¯ì £Å‹[6]][$d¯ì £Å‹[88]][$d¯ì £Å‹[809]]; $D‡äÉ”†Ç = $d¯ì £Å‹[72] . (isset($a™ãŠã‘™¥[$Dù«¾Å˜”]) ? $a™ãŠã‘™¥[$Dù«¾Å˜”] : ucfirst($Dù«¾Å˜”)); if (!class_exists($D‡äÉ”†Ç)) { show_json("{$D‡äÉ”†Ç}\40\x6e\157\x74\x20\x65\x78\x69\x73\164\163\x21", !1); } $FÄäâŸòŸ¶ = isset($Dîİ¸’ öÈ[$d¯ì £Å‹[6]]) ? $Dîİ¸’ öÈ[$d¯ì £Å‹[6]] : !1; self::$driverCache[$BäÀÓ†‡£¼] = new $D‡äÉ”†Ç($FÄäâŸòŸ¶); } goto AíìË¨Ÿš‹; DâŠ¾¢¢Ë¢: if (isset($Dîİ¸’ öÈ[$d¯ì £Å‹[6]][$d¯ì £Å‹[1091]])) { $bœ¡Ê•ôÍÉ->pathBase = rtrim($Dîİ¸’ öÈ[$d¯ì £Å‹[6]][$d¯ì £Å‹[1091]], $d¯ì £Å‹[8]) . $d¯ì £Å‹[8]; $Eˆ»„¢œÇ = $bœ¡Ê•ôÍÉ->pathBase . ltrim($Eˆ»„¢œÇ, $d¯ì £Å‹[8]); } $Eˆ»„¢œÇ = $bœ¡Ê•ôÍÉ->getPath($Eˆ»„¢œÇ); if (isset($FŒƒ­«­¨[$d¯ì £Å‹[1063]])) { $Eˆ»„¢œÇ = $FŒƒ­«­¨[$d¯ì £Å‹[1063]]; } goto F—¹¦óô; A… ²²´½¬: $d¯ì £Å‹ =& $_SERVER[ªúæÂ¡­ä½]; $CÂâŒª„ç¶ = $FŒƒ­«­¨[$d¯ì £Å‹[1080]]; $dµŸÂæŒ¤¥ = $FŒƒ­«­¨[$d¯ì £Å‹[394]]; goto BíÒ¢Ë”Ş¹; AíìË¨Ÿš‹: $bœ¡Ê•ôÍÉ = self::$driverCache[$BäÀÓ†‡£¼]; $bœ¡Ê•ôÍÉ->pathDriver = $CÂâŒª„ç¶; $bœ¡Ê•ôÍÉ->pathBase = $d¯ì £Å‹[33]; goto DâŠ¾¢¢Ë¢; F—¹¦óô: $bœ¡Ê•ôÍÉ->path = $Eˆ»„¢œÇ; return $bœ¡Ê•ôÍÉ; goto FÊê–™Ù«‡; FÊê–™Ù«‡: } public static function errorTips($b¥ÀØĞ¿©’ = false) { goto E„ï÷ñÀ‡ô; D¼ï»ø²Àœ: if ($b¥ÀØĞ¿©’ === -1) { return $DÉÆ³ã¨˜Î ? $DÉÆ³ã¨˜Î[count($DÉÆ³ã¨˜Î) - 1] : $b¤“£½àÃ®[33]; } if ($b¥ÀØĞ¿©’ === !1) { return implode($b¤“£½àÃ®[229], $DÉÆ³ã¨˜Î); } if (count($DÉÆ³ã¨˜Î) >= $aËŸ»Èœ…Ç) { $DÉÆ³ã¨˜Î = array_slice($DÉÆ³ã¨˜Î, $aËŸ»Èœ…Ç * 0.5, $aËŸ»Èœ…Ç); } goto dâŞÂï”‡¨; E„ï÷ñÀ‡ô: $b¤“£½àÃ® =& $_SERVER[ªúæÂ¡­ä½]; static $DÉÆ³ã¨˜Î = array(); $aËŸ»Èœ…Ç = 1000; goto D¼ï»ø²Àœ; dâŞÂï”‡¨: $DÉÆ³ã¨˜Î[] = $b¥ÀØĞ¿©’; write_log($b¤“£½àÃ®[160] . ACTION . $b¤“£½àÃ®[1092] . $b¥ÀØĞ¿©’, $b¤“£½àÃ®[1093]); goto eôòÁøŒ¼ğ; eôòÁøŒ¼ğ: } public static function getLastError($aí½® Š´­ = '') { $cè‚ˆ¼¹ƒß = self::errorTips(-1); return $cè‚ˆ¼¹ƒß ? $cè‚ˆ¼¹ƒß : $aí½® Š´­; } } class IOArchive extends IO { function __construct() { parent::__construct(); } private static function local() { static $BóÖ·Îœ™; if (!$BóÖ·Îœ™) { $B¦ğ”Ö¦ª = IO::init($_SERVER[ªúæÂ¡­ä½][8]); } return $B¦ğ”Ö¦ª; } private static function iconvSystem($c£‡Š™÷ñá) { return self::local()->iconvSystem($c£‡Š™÷ñá); } private static function iconvApp($f¶ï˜èºÅ£) { return self::local()->iconvApp($f¶ï˜èºÅ£); } public static function zip($Eä°¡ÃäË, $c”æçîµ©· = "\172\151\160", $E±éÊ¦¨‚® = '', $BŞ´¼í½Á = REPEAT_RENAME) { goto C—È˜ô·—Õ; dÊÇ—Ô©„å: if ($E±éÊ¦¨‚® || !$F¦ÄãöØ•) { if ($F¦ÄãöØ• && strstr($F¦ÄãöØ•, TEMP_FILES)) { $aø£ÄÖğ©… = $aï˜—áª…¿ = array(); recursion_dir($FÓâõİê, $aø£ÄÖğ©…, $aï˜—áª…¿, 0); foreach ($aø£ÄÖğ©… as $b„ß§»êå¾) { del_dir($b„ß§»êå¾); } foreach ($aï˜—áª…¿ as $A¢Šƒ†ÅÌ³) { if ($A¢Šƒ†ÅÌ³ == $F¬¸‘ìóÇà) { continue; } del_file($A¢Šƒ†ÅÌ³); } } return $AŒ‡Âø¾”; } $fíÌ­àô¯± = self::pathFather($cˆ£Ä„“§Ğ[$C„ÁÀÌØÔ[76]]); $DàáÆ¹»¬é = self::move($AŒ‡Âø¾”, $fíÌ­àô¯±, $BŞ´¼í½Á); goto Aò§“ªÎ’ñ; C—È˜ô·—Õ: $C„ÁÀÌØÔ =& $_SERVER[ªúæÂ¡­ä½]; $DŒ·´¶…ù = self::init($Eä°¡ÃäË[0][$C„ÁÀÌØÔ[76]]); $cˆ£Ä„“§Ğ = self::info($Eä°¡ÃäË[0][$C„ÁÀÌØÔ[76]]); goto cè“±¾ƒÓ; cè“±¾ƒÓ: $F¦ÄãöØ• = !1; if (!$E±éÊ¦¨‚® && $DŒ·´¶…ù->getType() == $C„ÁÀÌØÔ[106]) { $aï˜—áª…¿ = self::zipFileList($Eä°¡ÃäË); } else { $F¦ÄãöØ• = $E±éÊ¦¨‚® ? $E±éÊ¦¨‚® : TEMP_FILES . $C„ÁÀÌØÔ[1094] . time() . rand_string(8) . $C„ÁÀÌØÔ[8]; mk_dir($F¦ÄãöØ•); $aï˜—áª…¿ = self::zipFileList($Eä°¡ÃäË, $F¦ÄãöØ•); } $D©¯ôœ ˜¯ = $cˆ£Ä„“§Ğ[$C„ÁÀÌØÔ[28]]; goto Eğ†â…¸º; Aò§“ªÎ’ñ: if (!$DàáÆ¹»¬é) { del_dir($F¦ÄãöØ•); show_json(LNG($C„ÁÀÌØÔ[1096]), !1); } del_dir($F¦ÄãöØ•); return $DàáÆ¹»¬é; goto a¡²¨÷¨Ãé; Eğ†â…¸º: if (count($aï˜—áª…¿) > 1) { $aâÏ„¨••ì = IO::info(IO::pathFather($cˆ£Ä„“§Ğ[$C„ÁÀÌØÔ[76]])); $D©¯ôœ ˜¯ = $aâÏ„¨••ì[$C„ÁÀÌØÔ[28]]; } $FÓâõİê = $F¦ÄãöØ•; if (!$FÓâõİê) { $FÓâõİê = get_path_father($cˆ£Ä„“§Ğ[$C„ÁÀÌØÔ[76]]); if (!$E±éÊ¦¨‚® && $DŒ·´¶…ù->getType() == $C„ÁÀÌØÔ[106]) { $FÓâõİê = get_path_father($DŒ·´¶…ù->path); } $EÅ­±áêĞÖ = IO::info($FÓâõİê); if (!$EÅ­±áêĞÖ[$C„ÁÀÌØÔ[196]]) { show_json(LNG($C„ÁÀÌØÔ[1095]), !1); } } goto aÙ£ÂÃ…º•; aÙ£ÂÃ…º•: $AŒ‡Âø¾” = $FÓâõİê . $D©¯ôœ ˜¯ . $C„ÁÀÌØÔ[95] . $c”æçîµ©·; $AŒ‡Âø¾” = get_filename_auto($AŒ‡Âø¾”, $C„ÁÀÌØÔ[33], $BŞ´¼í½Á); $F¬¸‘ìóÇà = self::iconvSystem($AŒ‡Âø¾”); goto cîÄ„İ„Ö“; cîÄ„İ„Ö“: foreach ($aï˜—áª…¿ as $a¦©”±›êÅ => $D¼Ïöì—œŒ) { $aï˜—áª…¿[$a¦©”±›êÅ] = self::iconvSystem($D¼Ïöì—œŒ); } KodArchive::create($F¬¸‘ìóÇà, $aï˜—áª…¿); if (!IO::exist($AŒ‡Âø¾”)) { if ($F¦ÄãöØ•) { del_dir($F¦ÄãöØ•); } show_json(LNG($C„ÁÀÌØÔ[1096]), !1); } goto dÊÇ—Ô©„å; a¡²¨÷¨Ãé: } public static function unzip($A‘¢–ÆŸ, $A½ÚÌ›Ø´ = "\x72\145\x70\x6c\x61\x63\x65") { goto B£Æƒ ; e³Ú’àïğ: Hook::trigger($D£‚Ì–îåœ[1104], $CÎµ¡³‰Æ­); recursion_dir($CÎµ¡³‰Æ­, $FÒ¼¼ùãˆŞ, $b êò‹èã, 0); $CŒ¤Ì¦ù—ˆ = array_merge($FÒ¼¼ùãˆŞ, $b êò‹èã); goto E’˜¦ÏƒË„; e±£¾Ó‘àË: mk_dir($CÎµ¡³‰Æ­); $aÈøÉº—È = self::fileExt($eç’¸ó‚Ä…); $d±Úïã© = $CÎµ¡³‰Æ­ . $D£‚Ì–îåœ[95] . $aÈøÉº—È; goto Aì“–Ú¥ù˜; Aì“–Ú¥ù˜: if (!@file_exists(self::iconvSystem($d±Úïã©))) { $B¿áëÆ¢Òø = self::localFilePath($D£–ä¶´É¶, $aÈøÉº—È); $d±Úïã© = $B¿áëÆ¢Òø ? $B¿áëÆ¢Òø : parent::download($D£–ä¶´É¶, $d±Úïã©); } $d±Úïã© = self::iconvSystem($d±Úïã©); $eÅ¾½”ÒÔå = isset($A‘¢–ÆŸ[$D£‚Ì–îåœ[1099]]) ? $A‘¢–ÆŸ[$D£‚Ì–îåœ[1099]] : $D£‚Ì–îåœ[1100]; goto CãíÒºäï; B£Æƒ : $D£‚Ì–îåœ =& $_SERVER[ªúæÂ¡­ä½]; $D£–ä¶´É¶ = $A‘¢–ÆŸ[$D£‚Ì–îåœ[76]]; $Cµ É¥¶§¤ = $A‘¢–ÆŸ[$D£‚Ì–îåœ[1097]]; goto f°ĞØÈò×Î; EŠí«‘‰À: return !0; goto dâ‰æÅÑŞù; CãíÒºäï: $Bö¥…Š‰ã = KodArchive::extract($d±Úïã©, $CÎµ¡³‰Æ­ . $D£‚Ì–îåœ[8], $eÅ¾½”ÒÔå); self::archiveExt(); if (!$Bö¥…Š‰ã[$D£‚Ì–îåœ[1101]]) { show_json($D£‚Ì–îåœ[1102] . $Bö¥…Š‰ã[$D£‚Ì–îåœ[1103]], !1); } goto e³Ú’àïğ; E’˜¦ÏƒË„: foreach ($CŒ¤Ì¦ù—ˆ as $b¡ÇÄ”ÇÆÖ) { $b¡ÇÄ”ÇÆÖ = self::iconvApp($b¡ÇÄ”ÇÆÖ); self::move($b¡ÇÄ”ÇÆÖ, $Cµ É¥¶§¤, $A½ÚÌ›Ø´); } del_dir($CÎµ¡³‰Æ­); if (!$B¿áëÆ¢Òø) { del_file($d±Úïã©); } goto EŠí«‘‰À; F¼ëŒ¢‰Œ¸: $Cœ Š‡ĞÕ« = self::tmpFileName($eç’¸ó‚Ä…); $CÎµ¡³‰Æ­ = TEMP_FILES . $Cœ Š‡ĞÕ«; del_dir($CÎµ¡³‰Æ­); goto e±£¾Ó‘àË; f°ĞØÈò×Î: if (!($eç’¸ó‚Ä… = parent::info($D£–ä¶´É¶))) { show_json(LNG($D£‚Ì–îåœ[1098]), !1); } if (!($D½ÃÀï«Ä = parent::infoFull($Cµ É¥¶§¤))) { $Cµ É¥¶§¤ = parent::mkdir($Cµ É¥¶§¤); $D½ÃÀï«Ä = array($D£‚Ì–îåœ[76] => $Cµ É¥¶§¤); } else { if (isset($D½ÃÀï«Ä[$D£‚Ì–îåœ[396]]) && trim($D½ÃÀï«Ä[$D£‚Ì–îåœ[76]], $D£‚Ì–îåœ[8]) != trim($Cµ É¥¶§¤, $D£‚Ì–îåœ[8])) { $b•£Œí´¬ = KodIO::make($D½ÃÀï«Ä[$D£‚Ì–îåœ[479]]); $d Šó”Õï¨ = parent::fileNameAuto($b•£Œí´¬, $D½ÃÀï«Ä[$D£‚Ì–îåœ[28]], REPEAT_RENAME_FOLDER, !0); $Cµ É¥¶§¤ = parent::mkdir($b•£Œí´¬ . $d Šó”Õï¨); $D½ÃÀï«Ä = array($D£‚Ì–îåœ[76] => $Cµ É¥¶§¤); } } $Cµ É¥¶§¤ = $D½ÃÀï«Ä[$D£‚Ì–îåœ[76]]; goto F¼ëŒ¢‰Œ¸; dâ‰æÅÑŞù: } public static function unzipList($a¿ë«İ±¯) { goto c½Å’ñÓ»Œ; b°ñµˆÍŸ: $BÍŒ¹ÆÛñ = self::info($dîøï©“ ); $FšÒ´‡éÂ­ = self::fileExt($BÍŒ¹ÆÛñ); $f®ÆÒöóÏ = self::tmpFileName($BÍŒ¹ÆÛñ); goto aŠ¨£—ï; c½Å’ñÓ»Œ: $cÍêç¤•¦® =& $_SERVER[ªúæÂ¡­ä½]; $bóŸá‰ìğ… = $a¿ë«İ±¯[$cÍêç¤•¦®[76]]; $AœÚÄ›ê‰ = isset($a¿ë«İ±¯[$cÍêç¤•¦®[1105]]) ? $a¿ë«İ±¯[$cÍêç¤•¦®[1105]] : -1; goto FïÙé‹“‚; FïÙé‹“‚: $f‚‡Ş­äŞ¨ = 50000; if (request_url_safe($bóŸá‰ìğ…)) { $DÀÍ…‘İÏ = parse_url_query($bóŸá‰ìğ…); if (!isset($DÀÍ…‘İÏ[$cÍêç¤•¦®[76]])) { show_json($cÍêç¤•¦®[1106], !1); } } $dîøï©“  = isset($DÀÍ…‘İÏ) ? $DÀÍ…‘İÏ[$cÍêç¤•¦®[76]] : $bóŸá‰ìğ…; goto b°ñµˆÍŸ; BùÆÖÅ­„Ä: if (!is_dir($CÒÄ¾‹¶°¯)) { mk_dir($CÒÄ¾‹¶°¯); } $eœ‹×£¸î´ = $CÒÄ¾‹¶°¯ . $cÍêç¤•¦®[8] . $aœš¬´·İ‹; if (!@file_exists(self::iconvSystem($eœ‹×£¸î´))) { if (isset($DÀÍ…‘İÏ)) { url_request($bóŸá‰ìğ…, $cÍêç¤•¦®[1108], $eœ‹×£¸î´); } else { $BŠ”……‘â = self::localFilePath($bóŸá‰ìğ…, $FšÒ´‡éÂ­); $eœ‹×£¸î´ = $BŠ”……‘â ? $BŠ”……‘â : self::download($bóŸá‰ìğ…, $eœ‹×£¸î´); } } goto e¾˜±×‹î; e¾˜±×‹î: $eœ‹×£¸î´ = self::iconvSystem($eœ‹×£¸î´); if ($AœÚÄ›ê‰ >= 0) { $B²ˆˆØ…Û¨ = isset($a¿ë«İ±¯[$cÍêç¤•¦®[1109]]) ? $a¿ë«İ±¯[$cÍêç¤•¦®[1109]] : !1; $dÖ¥È˜Æì = isset($a¿ë«İ±¯[$cÍêç¤•¦®[28]]) ? $a¿ë«İ±¯[$cÍêç¤•¦®[28]] : $cÍêç¤•¦®[33]; KodArchive::filePreview($eœ‹×£¸î´, $AœÚÄ›ê‰, $B²ˆˆØ…Û¨, $dÖ¥È˜Æì); self::archiveExt(); die; } $fÆå¼›÷­Ñ = KodArchive::listContent($eœ‹×£¸î´); goto CõñÑÈéŸâ; CõñÑÈéŸâ: self::archiveExt(); del_dir($CÒÄ¾‹¶°¯); if (!$fÆå¼›÷­Ñ[$cÍêç¤•¦®[1101]]) { show_json($fÆå¼›÷­Ñ[$cÍêç¤•¦®[1103]], !1); } goto cÈ½Ø‹ÙÓĞ; Eá–øïĞ×§: return $fÆå¼›÷­Ñ[$cÍêç¤•¦®[1103]]; goto CŸ¿âÔãÓ; aŠ¨£—ï: if (isset($DÀÍ…‘İÏ)) { $dç¢œ¬Ï©Ç = array($DÀÍ…‘İÏ[$cÍêç¤•¦®[76]], $DÀÍ…‘İÏ[$cÍêç¤•¦®[1105]], $DÀÍ…‘İÏ[$cÍêç¤•¦®[28]]); $aœš¬´·İ‹ = md5(implode($cÍêç¤•¦®[71], $dç¢œ¬Ï©Ç)) . $cÍêç¤•¦®[95] . get_path_ext($DÀÍ…‘İÏ[$cÍêç¤•¦®[28]]); } else { $dç¢œ¬Ï©Ç = array($BÍŒ¹ÆÛñ[$cÍêç¤•¦®[28]], $BÍŒ¹ÆÛñ[$cÍêç¤•¦®[76]], $BÍŒ¹ÆÛñ[$cÍêç¤•¦®[78]]); $aœš¬´·İ‹ = md5(implode($cÍêç¤•¦®[71], $dç¢œ¬Ï©Ç)) . $cÍêç¤•¦®[95] . $FšÒ´‡éÂ­; } if ($AœÚÄ›ê‰ == -1) { $a™Ä¢¡õ†¾ = IO_PATH_SYSTEM_TEMP . "\x7a\151\160\x56\151\145\x77\57{$f®ÆÒöóÏ}\x2f{$aœš¬´·İ‹}\x2e\154\x6f\147"; $e‡°œ‡¬Ù = self::infoFull($a™Ä¢¡õ†¾); if ($e‡°œ‡¬Ù) { $a™Ä¢¡õ†¾ = $e‡°œ‡¬Ù[$cÍêç¤•¦®[76]]; $aŠ×Ù¥Å… = self::getContent($a™Ä¢¡õ†¾); if ($aŠ×Ù¥Å…) { $E÷ÈÀ¤©¹È = json_decode($aŠ×Ù¥Å…, !0); if (count($E÷ÈÀ¤©¹È) >= $f‚‡Ş­äŞ¨) { show_json(sprintf(LNG($cÍêç¤•¦®[1107]), count($E÷ÈÀ¤©¹È)), !1); } return $E÷ÈÀ¤©¹È; } } else { $a™Ä¢¡õ†¾ = self::mkfile($a™Ä¢¡õ†¾); } } $CÒÄ¾‹¶°¯ = TEMP_FILES . $f®ÆÒöóÏ; goto BùÆÖÅ­„Ä; cÈ½Ø‹ÙÓĞ: $E÷ÈÀ¤©¹È = json_encode($fÆå¼›÷­Ñ[$cÍêç¤•¦®[1103]]); self::setContent($a™Ä¢¡õ†¾, $E÷ÈÀ¤©¹È); if (count($fÆå¼›÷­Ñ[$cÍêç¤•¦®[1103]]) >= $f‚‡Ş­äŞ¨) { show_json(sprintf(LNG($cÍêç¤•¦®[1107]), count($fÆå¼›÷­Ñ[$cÍêç¤•¦®[1103]])), !1); } goto Eá–øïĞ×§; CŸ¿âÔãÓ: } private static function fileExt($Dˆçìƒ®÷) { $DÁ×à¦¸Ş— =& $_SERVER[ªúæÂ¡­ä½]; $bš…§ØºÓ³ = $Dˆçìƒ®÷[$DÁ×à¦¸Ş—[168]]; if ($bš…§ØºÓ³ == $DÁ×à¦¸Ş—[1110]) { $CçÍì¥ì›Ò = $DÁ×à¦¸Ş—[1111]; if (substr($Dˆçìƒ®÷[$DÁ×à¦¸Ş—[28]], -strlen($CçÍì¥ì›Ò)) == $CçÍì¥ì›Ò) { $bš…§ØºÓ³ = $DÁ×à¦¸Ş—[1112]; } } self::archiveExt($bš…§ØºÓ³); return $bš…§ØºÓ³; } private static function zipFileList($CªëˆÖ‚‚, $B»ËÁÖÊ™ = false) { $dŠù„êƒè° =& $_SERVER[ªúæÂ¡­ä½]; $Fêšö†ø’° = array(); foreach ($CªëˆÖ‚‚ as $Aº‡ŞéÌğ) { $eöåê±Ù = $Aº‡ŞéÌğ[$dŠù„êƒè°[76]]; if ($B»ËÁÖÊ™) { $eöåê±Ù = self::copy($Aº‡ŞéÌğ[$dŠù„êƒè°[76]], $B»ËÁÖÊ™, $dŠù„êƒè°[801]); } else { $d¸‰ßÊ†º° = self::init($Aº‡ŞéÌğ[$dŠù„êƒè°[76]]); if ($d¸‰ßÊ†º°->getType() == $dŠù„êƒè°[106]) { $eöåê±Ù = $d¸‰ßÊ†º°->path; } } if ($eöåê±Ù && self::local()->exist($eöåê±Ù)) { $Fêšö†ø’°[$Aº‡ŞéÌğ[$dŠù„êƒè°[76]]] = $eöåê±Ù; } } if (!empty($Fêšö†ø’°)) { return array_values($Fêšö†ø’°); } show_json(LNG($dŠù„êƒè°[1076]), !1); } public static function tmpFileName($fÊ½½Áà) { $Eõœâ×¤Ë“ =& $_SERVER[ªúæÂ¡­ä½]; $a§Å…°×– = array($fÊ½½Áà[$Eõœâ×¤Ë“[28]], $fÊ½½Áà[$Eõœâ×¤Ë“[76]], $fÊ½½Áà[$Eõœâ×¤Ë“[78]], $fÊ½½Áà[$Eõœâ×¤Ë“[503]]); return md5(implode($Eõœâ×¤Ë“[71], $a§Å…°×–)); } private static function localFilePath($fİîÌåß …, $eÌ¾ğòš²) { goto d”æÛóÑ“ë; C¿‡ÊŞŒ¸: if ($EÉ÷ˆŞ«‘µ == $D“àáÁêí[106] || $EÉ÷ˆŞ«‘µ == $D“àáÁêí[1116]) { if (!$Cá¸ºØİ¸ ->exist($Cá¸ºØİ¸ ->path)) { show_json(LNG($D“àáÁêí[105]), !1); } return $Cá¸ºØİ¸ ->path; } return !1; goto aËØùÃ‹›¿; BÃò†ÂÙ±·: if ($bö À ½ôæ[$D“àáÁêí[29]] == KodIO::KOD_SOURCE) { $fŠ…è§÷Ïš = Model($D“àáÁêí[808])->fileInfoGet(KodIO::sourceID($fİîÌåß …)); if (!$fŠ…è§÷Ïš[$D“àáÁêí[76]]) { show_json($D“àáÁêí[1115], !1); } $fİîÌåß … = $fŠ…è§÷Ïš[$D“àáÁêí[76]]; } $Cá¸ºØİ¸  = self::init($fİîÌåß …); $EÉ÷ˆŞ«‘µ = $Cá¸ºØİ¸ ->getType(); goto C¿‡ÊŞŒ¸; d”æÛóÑ“ë: $D“àáÁêí =& $_SERVER[ªúæÂ¡­ä½]; if ($eÌ¾ğòš² == $D“àáÁêí[1113] && strtoupper(substr(PHP_OS, 0, 3)) == $D“àáÁêí[1114]) { return !1; } $bö À ½ôæ = KodIO::parse($fİîÌåß …); goto BÃò†ÂÙ±·; aËØùÃ‹›¿: } private static function archiveExt($FéØç°÷ó† = '') { $GLOBALS[$_SERVER[ªúæÂ¡­ä½][1117]] = $FéØç°÷ó†; } } class IOHistory { public static $_historyBase = ''; function __construct() { } public static function bindEvent() { goto a×—ö‰‰ëñ; a×—ö‰‰ëñ: $D‘ÑîŒì =& $_SERVER[ªúæÂ¡­ä½]; $F²Ç¡ìø‰ = $GLOBALS[$D‘ÑîŒì[6]][$D‘ÑîŒì[88]]; if ($F²Ç¡ìø‰[$D‘ÑîŒì[1118]] != 1) { return; } goto Fí“•÷ÙÖŠ; Cå¸’ÛÈÈ: Hook::bind($D‘ÑîŒì[1123], $D‘ÑîŒì[1124]); Hook::bind($D‘ÑîŒì[1125], $D‘ÑîŒì[1126]); Hook::bind($D‘ÑîŒì[1127], $D‘ÑîŒì[1128]); goto c±‚ËëÅ“Ú; c±‚ËëÅ“Ú: Hook::bind($D‘ÑîŒì[1129], $D‘ÑîŒì[1130]); Hook::bind($D‘ÑîŒì[1131], $D‘ÑîŒì[1132]); goto b¹â‹š; Fí“•÷ÙÖŠ: if ($F²Ç¡ìø‰[$D‘ÑîŒì[1119]] <= 0) { return; } if (isset($_REQUEST[$D‘ÑîŒì[1120]]) && $_REQUEST[$D‘ÑîŒì[1120]] == $D‘ÑîŒì[87]) { return; } Hook::bind($D‘ÑîŒì[1121], $D‘ÑîŒì[1122]); goto Cå¸’ÛÈÈ; b¹â‹š: } public static function eventBeforeUpload($C‘ƒ¯»ŠÓ) { if ($C‘ƒ¯»ŠÓ[3] && $C‘ƒ¯»ŠÓ[3] != REPEAT_REPLACE) { return; } $D¸ğ¼†¯… = self::parsePath($C‘ƒ¯»ŠÓ[0]); if (!$D¸ğ¼†¯…) { return; } self::add($D¸ğ¼†¯…); } public static function eventBeforeEdit($a¤œäì™°¦) { $EÁ¨êÛèÆ = self::parsePath($a¤œäì™°¦[0]); if (!$EÁ¨êÛèÆ) { return; } self::add($EÁ¨êÛèÆ); } public static function eventBeforeCopyFile($Eğã¿¢ÆÓö, $Dšùâô¿š¢, $DÛğ©êáÑ†, $AËÑØ®Ì£, $C¬•µ›Ïİø, $aŠ®ÆÃÄß¿) { $dßËåõÎÛñ = $DÛğ©êáÑ†->getPathOuter($AËÑØ®Ì£); $c‰á£• = self::parsePath($dßËåõÎÛñ); if (!$c‰á£•) { return; } self::add($c‰á£•); } public static function eventBeforeRename($CÖğ ¨ÃÜ) { $FÔæŞé‘»† =& $_SERVER[ªúæÂ¡­ä½]; $AÁÔ’ãº…‘ = self::parsePath($CÖğ ¨ÃÜ[0]); if (!$AÁÔ’ãº…‘) { return; } $Bµ½à¤ÔÒ• = self::checkInHistory($AÁÔ’ãº…‘); if (!$Bµ½à¤ÔÒ•) { return; } if ($Bµ½à¤ÔÒ•[$FÔæŞé‘»†[29]] == $FÔæŞé‘»†[193]) { $AĞ“Ñø‡Şá = self::listData($AÁÔ’ãº…‘); if ($AĞ“Ñø‡Şá && $AĞ“Ñø‡Şá[$FÔæŞé‘»†[367]]) { self::moveHistory($AÁÔ’ãº…‘, $CÖğ ¨ÃÜ[1]); } } else { IO::rename($Bµ½à¤ÔÒ•[$FÔæŞé‘»†[76]], $CÖğ ¨ÃÜ[1]); } } public static function eventBeforeMove($B•ÙŞê˜‘²) { goto F©æº’öŞ; CÊ®‡÷Á§Ö: if ($bõÌ…Ÿ¹ˆ×[$c¤ÄÁ…›°¶[29]] == $c¤ÄÁ…›°¶[193]) { $DÃÛ¡Îª = self::listData($f¶¦—äá—ê); $D»´áª•¡“ = rtrim($A™—ÛêóñŞ, $c¤ÄÁ…›°¶[8]) . $c¤ÄÁ…›°¶[8] . ($BšÌƒÁŞ¨ ? $BšÌƒÁŞ¨ : get_path_this($f¶¦—äá—ê)); $Câ…ò™ïÄ¹ = self::listData($D»´áª•¡“); if ($DÃÛ¡Îª && $DÃÛ¡Îª[$c¤ÄÁ…›°¶[367]] && $Câ…ò™ïÄ¹ && $Câ…ò™ïÄ¹[$c¤ÄÁ…›°¶[367]]) { return self::clear($f¶¦—äá—ê); } if ($DÃÛ¡Îª && $DÃÛ¡Îª[$c¤ÄÁ…›°¶[367]]) { self::moveHistory($f¶¦—äá—ê, $BšÌƒÁŞ¨, $eùõğª‘åò); } } else { IO::move($bõÌ…Ÿ¹ˆ×[$c¤ÄÁ…›°¶[76]], $eùõğª‘åò, !1, $BšÌƒÁŞ¨); self::clearEmptyFolder(IO::pathFather($bõÌ…Ÿ¹ˆ×[$c¤ÄÁ…›°¶[76]])); } goto Cø……æ»Ö; F©æº’öŞ: $c¤ÄÁ…›°¶ =& $_SERVER[ªúæÂ¡­ä½]; $f¶¦—äá—ê = self::parsePath($B•ÙŞê˜‘²[0]); if (!$f¶¦—äá—ê) { return; } goto EèØ±“èÇë; EèØ±“èÇë: $A™—ÛêóñŞ = self::parsePath($B•ÙŞê˜‘²[1]); if (!$A™—ÛêóñŞ) { return; } $BšÌƒÁŞ¨ = $B•ÙŞê˜‘²[3]; goto FÈĞ¯šİ²á; FÈĞ¯šİ²á: $bõÌ…Ÿ¹ˆ× = self::checkInHistory($f¶¦—äá—ê); if (!$bõÌ…Ÿ¹ˆ×) { return; } $eùõğª‘åò = self::pathHistory($A™—ÛêóñŞ); goto CÊ®‡÷Á§Ö; Cø……æ»Ö: } public static function eventAfterRemove($bÓñÜŸ®¢½, $F”´ùˆ) { goto Bñ°íˆ·ø; Bñ°íˆ·ø: $A’œ”Êö¯° =& $_SERVER[ªúæÂ¡­ä½]; if (!$F”´ùˆ) { return; } $EÅğ„¯Øµî = self::parsePath($bÓñÜŸ®¢½[0]); goto eÁŞË×ÂÆ´; eÁŞË×ÂÆ´: if (!$EÅğ„¯Øµî) { return; } $cŸŒ§¸÷Ú× = self::checkInHistory($EÅğ„¯Øµî); if (!$cŸŒ§¸÷Ú×) { return; } goto Cˆç¦ÆÔã; Cˆç¦ÆÔã: if ($cŸŒ§¸÷Ú×[$A’œ”Êö¯°[29]] == $A’œ”Êö¯°[193]) { $EÀìâ¯ñ ¢ = self::listData($EÅğ„¯Øµî, !1); if ($EÀìâ¯ñ ¢ && $EÀìâ¯ñ ¢[$A’œ”Êö¯°[367]]) { self::clear($EÅğ„¯Øµî, !1); } } else { IO::remove($cŸŒ§¸÷Ú×[$A’œ”Êö¯°[76]]); self::clearEmptyFolder(IO::pathFather($cŸŒ§¸÷Ú×[$A’œ”Êö¯°[76]])); } goto a½¶Ü°±ßÒ; a½¶Ü°±ßÒ: } private static function checkInHistory($Dó×àÆ˜ÀÁ) { $F‚êé„ä¾ = self::pathHistory($Dó×àÆ˜ÀÁ); if (!IO::exist($F‚êé„ä¾)) { $F‚êé„ä¾ .= $_SERVER[ªúæÂ¡­ä½][1133]; } return IO::exist($F‚êé„ä¾) ? IO::info($F‚êé„ä¾) : !1; } private static function parsePath($fäÉê³–à¤) { goto C¥‘¹µšİ; f«˜¿à‘¾Ú: $BÁ††Š†³å = KodIO::parse($fäÉê³–à¤); $cö“éÉÀ¡ = $BÁ††Š†³å[$D‘é´•¥’[29]]; $a¾‰’ÇŠÏØ = !$cö“éÉÀ¡ || $cö“éÉÀ¡ == KodIO::KOD_IO || $cö“éÉÀ¡ == KodIO::KOD_SHARE_ITEM; goto a¾µœ„ŞÅ; eÇÜù’Í±ª: self::log($GLOBALS[$D‘é´•¥’[1058]] . $D‘é´•¥’[1138] . $fäÉê³–à¤); return $fäÉê³–à¤; goto a‘…•ÑŞøå; a¾µœ„ŞÅ: if (!$a¾‰’ÇŠÏØ || !$BÁ††Š†³å[$D‘é´•¥’[1135]]) { return !1; } if (substr($fäÉê³–à¤, 0, strlen(DATA_PATH . $D‘é´•¥’[1136])) == DATA_PATH . $D‘é´•¥’[1136]) { return !1; } if ($cö“éÉÀ¡ == KodIO::KOD_SHARE_ITEM) { $c¶ÊëÎ«Ş§ = IO::init($fäÉê³–à¤); if ($c¶ÊëÎ«Ş§->pathParse[$D‘é´•¥’[1063]]) { return self::parsePath($c¶ÊëÎ«Ş§->pathParse[$D‘é´•¥’[1063]]); } return !1; } goto f°µÆó¹ì§; f°µÆó¹ì§: if (!self::$_historyBase) { self::$_historyBase = self::getBasePath(); } $E¬„ºôá = array(self::$_historyBase, TEMP_PATH, BASIC_PATH . $D‘é´•¥’[1137]); foreach ($E¬„ºôá as $C©ìŞëÙ) { if (!$cö“éÉÀ¡ && substr($fäÉê³–à¤, 0, strlen($C©ìŞëÙ)) == $C©ìŞëÙ) { return !1; } } goto eÇÜù’Í±ª; C¥‘¹µšİ: $D‘é´•¥’ =& $_SERVER[ªúæÂ¡­ä½]; if (!$fäÉê³–à¤) { return !1; } if ($GLOBALS[$D‘é´•¥’[1134]]) { return; } goto f«˜¿à‘¾Ú; a‘…•ÑŞøå: } private static function pathHistory($Dä²ä°½©) { $BãÏ¢¸¿ŸÕ =& $_SERVER[ªúæÂ¡­ä½]; $dÌÆÆÆ—é„ = self::$_historyBase . ltrim(KodIO::clear($Dä²ä°½©), $BãÏ¢¸¿ŸÕ[8]); $dÌÆÆÆ—é„ = str_replace(array($BãÏ¢¸¿ŸÕ[1139]), array($BãÏ¢¸¿ŸÕ[1140]), $dÌÆÆÆ—é„); return $dÌÆÆÆ—é„; } public static function log($a’²®ùØÆÑ) { } public static function historyCount($EÅ‹‘±§ÙÛ) { $e÷›‡Ê³†¢ =& $_SERVER[ªúæÂ¡­ä½]; $b‰½ÔÕø„ = array(); $a¤‘ªİÌš = array(); foreach ($EÅ‹‘±§ÙÛ as $cŒ˜•õ…„) { $D·ÀÑÖº”¶ = get_path_father($cŒ˜•õ…„); if (!$a¤‘ªİÌš[$D·ÀÑÖº”¶]) { $a¤‘ªİÌš[$D·ÀÑÖº”¶] = array(); } $a¤‘ªİÌš[$D·ÀÑÖº”¶][] = get_path_this($cŒ˜•õ…„); } foreach ($a¤‘ªİÌš as $D·ÀÑÖº”¶ => $cÆàß‡™ßù) { $f±Ûæ¨½ÂÙ = self::parsePath($D·ÀÑÖº”¶); if (!$f±Ûæ¨½ÂÙ) { continue; } foreach ($cÆàß‡™ßù as $e¡÷Ôìë­å) { $BÚ¸·ÒæÔ = self::listData(rtrim($f±Ûæ¨½ÂÙ, $e÷›‡Ê³†¢[8]) . $e÷›‡Ê³†¢[8] . $e¡÷Ôìë­å, !1); if ($BÚ¸·ÒæÔ && $BÚ¸·ÒæÔ[$e÷›‡Ê³†¢[367]]) { $b‰½ÔÕø„[rtrim($D·ÀÑÖº”¶, $e÷›‡Ê³†¢[8]) . $e÷›‡Ê³†¢[8] . $e¡÷Ôìë­å] = count($BÚ¸·ÒæÔ[$e÷›‡Ê³†¢[367]]); } } } return $b‰½ÔÕø„; } public static function add($C“Éëõğ) { goto Cî¼Ëß˜ìÑ; b§Š²‡ë›: $F×îì¿òÓÑ = array($a™œËŠƒ„ß[394] => $Cİê¸ã‰‡İ, $a™œËŠƒ„ß[171] => $a»¾éé÷‡†, $a™œËŠƒ„ß[28] => $D£³Û‚¶¿Ë[$a™œËŠƒ„ß[28]] . $a™œËŠƒ„ß[95] . date($a™œËŠƒ„ß[1143]) . rand_string(1), $a™œËŠƒ„ß[78] => $D£³Û‚¶¿Ë[$a™œËŠƒ„ß[78]], $a™œËŠƒ„ß[433] => USER_ID, $a™œËŠƒ„ß[194] => time(), $a™œËŠƒ„ß[1144] => $a™œËŠƒ„ß[33]); IO::mkdir($c×ß½Òî»è[$a™œËŠƒ„ß[1145]]); $EºÀÈ¡ğ¡½ = IO::copy($C“Éëõğ, $c×ß½Òî»è[$a™œËŠƒ„ß[1145]], !1, $F×îì¿òÓÑ[$a™œËŠƒ„ß[28]]); goto D‚ÔÂØí²Ù; D‚ÔÂØí²Ù: if (!$EºÀÈ¡ğ¡½) { self::clearEmptyFolder($c×ß½Òî»è[$a™œËŠƒ„ß[1145]]); return !1; } array_unshift($aš‘…³±œ•, $F×îì¿òÓÑ); if (count($aš‘…³±œ•) > $dÎéº‘œÌÒ) { $FÖ¥åƒ = array_slice($aš‘…³±œ•, $dÎéº‘œÌÒ); foreach ($FÖ¥åƒ as $e©ç‰ÊƒßÂ) { IO::remove($c×ß½Òî»è[$a™œËŠƒ„ß[1145]] . $e©ç‰ÊƒßÂ[$a™œËŠƒ„ß[28]]); } $aš‘…³±œ• = array_slice($aš‘…³±œ•, 0, $dÎéº‘œÌÒ); } goto F¢“‰ËØ˜Ó; e•×ÅÀŠ©é: if ($c°å†ÔäÆ <= 0) { return; } $a»¾éé÷‡† = IO::hashSimple($C“Éëõğ); $D£³Û‚¶¿Ë = IO::info($C“Éëõğ); goto c£…ÕÖ‹ä; cÄ‹¦·…ĞÁ: $EÃÃ¹àö„á = Model($a™œËŠƒ„ß[748])->get($a™œËŠƒ„ß[1141]); $c°å†ÔäÆ = $GLOBALS[$a™œËŠƒ„ß[6]][$a™œËŠƒ„ß[88]][$a™œËŠƒ„ß[1119]]; $dÎéº‘œÌÒ = $EÃÃ¹àö„á == $a™œËŠƒ„ß[1142] ? 5 : $c°å†ÔäÆ; goto e•×ÅÀŠ©é; c£…ÕÖ‹ä: $aš‘…³±œ• = $c×ß½Òî»è[$a™œËŠƒ„ß[367]]; if ($D£³Û‚¶¿Ë[$a™œËŠƒ„ß[78]] == 0) { return; } if ($D£³Û‚¶¿Ë[$a™œËŠƒ„ß[78]] >= 1024 * 1024 * 500) { return !1; } goto FÉ°ùÖ¢Ó; FÉ°ùÖ¢Ó: if ($aš‘…³±œ• && $aš‘…³±œ•[0][$a™œËŠƒ„ß[171]] == $a»¾éé÷‡†) { return !0; } if (array_key_exists($a™œËŠƒ„ß[196], $D£³Û‚¶¿Ë) && !$D£³Û‚¶¿Ë[$a™œËŠƒ„ß[196]]) { return !1; } $Cİê¸ã‰‡İ = short_id(time()); goto b§Š²‡ë›; Cî¼Ëß˜ìÑ: $a™œËŠƒ„ß =& $_SERVER[ªúæÂ¡­ä½]; $c×ß½Òî»è = self::listData($C“Éëõğ); if (!$c×ß½Òî»è) { return; } goto cÄ‹¦·…ĞÁ; F¢“‰ËØ˜Ó: return self::saveData($c×ß½Òî»è[$a™œËŠƒ„ß[1146]], $aš‘…³±œ•); goto EĞÙ´èÉÌ•; EĞÙ´èÉÌ•: } public static function remove($DÅÊ·¬¨ŠÆ, $EÎó»Ë˜‚×) { $aÉİãÀÏË =& $_SERVER[ªúæÂ¡­ä½]; $CÕò“‘£¤ = self::listData($DÅÊ·¬¨ŠÆ); $dÜÜˆë™…â = array(); if (!$CÕò“‘£¤) { return !1; } foreach ($CÕò“‘£¤[$aÉİãÀÏË[367]] as $aéĞ¨ÕŸ‘) { if ($aéĞ¨ÕŸ‘[$aÉİãÀÏË[394]] == $EÎó»Ë˜‚×) { IO::remove($CÕò“‘£¤[$aÉİãÀÏË[1145]] . $aéĞ¨ÕŸ‘[$aÉİãÀÏË[28]]); continue; } $dÜÜˆë™…â[] = $aéĞ¨ÕŸ‘; } return self::saveData($CÕò“‘£¤[$aÉİãÀÏË[1146]], $dÜÜˆë™…â); } public static function clear($Bñ×¢©Â»ê, $d°˜¬¦Œİ = true) { $e£ï¯‹‘½ =& $_SERVER[ªúæÂ¡­ä½]; $f­è¿¹‚“… = self::listData($Bñ×¢©Â»ê, $d°˜¬¦Œİ); if (!$f­è¿¹‚“…) { return !1; } foreach ($f­è¿¹‚“…[$e£ï¯‹‘½[367]] as $e†ßÄ¡ÄêÈ) { IO::remove($f­è¿¹‚“…[$e£ï¯‹‘½[1145]] . $e†ßÄ¡ÄêÈ[$e£ï¯‹‘½[28]]); } return self::saveData($f­è¿¹‚“…[$e£ï¯‹‘½[1146]], array()); } public static function moveHistory($A‚ Òòãç£, $Bßˆ¥Öñ¬Ú = '', $a›Ş½‚Ô¯Ï = '') { goto eö×ˆø¡Ë; BÙÔõÌÔê: $a‹ÍŸùçÊµ = $D §¯™êä‰[1133]; $Bßˆ¥Öñ¬Ú = $Bßˆ¥Öñ¬Ú ? $Bßˆ¥Öñ¬Ú : get_path_this($A‚ Òòãç£); $a›Ş½‚Ô¯Ï = $a›Ş½‚Ô¯Ï ? $a›Ş½‚Ô¯Ï : $a¥ÉÛé˜â«[$D §¯™êä‰[1145]]; goto d¯²‚ó¦–½; AƒÁÆ”¯±Ö: self::saveData($a¥ÉÛé˜â«[$D §¯™êä‰[1146]], $a¥ÉÛé˜â«[$D §¯™êä‰[367]]); self::clearEmptyFolder($a¥ÉÛé˜â«[$D §¯™êä‰[1145]]); goto aµ®Í¿ŠèØ; d¯²‚ó¦–½: $c–ª‘É”¯ = substr(get_path_this($a¥ÉÛé˜â«[$D §¯™êä‰[1146]]), 0, -strlen($a‹ÍŸùçÊµ)); foreach ($a¥ÉÛé˜â«[$D §¯™êä‰[367]] as $cñ•ĞóÚ½š => $fÂ¡¶·†¿) { $Fø…ßÓ¿ªÒ = $Bßˆ¥Öñ¬Ú . substr($fÂ¡¶·†¿[$D §¯™êä‰[28]], strlen($c–ª‘É”¯)); $AÆêé÷İÀ³ = IO::move($a¥ÉÛé˜â«[$D §¯™êä‰[1145]] . $fÂ¡¶·†¿[$D §¯™êä‰[28]], $a›Ş½‚Ô¯Ï, !1, $Fø…ßÓ¿ªÒ); if ($AÆêé÷İÀ³) { $a¥ÉÛé˜â«[$D §¯™êä‰[367]][$cñ•ĞóÚ½š][$D §¯™êä‰[28]] = $Fø…ßÓ¿ªÒ; } } $a¥ÉÛé˜â«[$D §¯™êä‰[1146]] = IO::move($a¥ÉÛé˜â«[$D §¯™êä‰[1146]], $a›Ş½‚Ô¯Ï, !1, $Bßˆ¥Öñ¬Ú . $a‹ÍŸùçÊµ); goto AƒÁÆ”¯±Ö; eö×ˆø¡Ë: $D §¯™êä‰ =& $_SERVER[ªúæÂ¡­ä½]; $a¥ÉÛé˜â« = self::listData($A‚ Òòãç£, !1); if (!$a¥ÉÛé˜â« || !$a¥ÉÛé˜â«[$D §¯™êä‰[367]]) { return !1; } goto BÙÔõÌÔê; aµ®Í¿ŠèØ: } public static function rollback($EÄÚ­™è, $aÊ·İôéëš) { $A¡¨ÃÆî =& $_SERVER[ªúæÂ¡­ä½]; $c¸”÷Ñ± á = self::listData($EÄÚ­™è); if (!$c¸”÷Ñ± á) { return; } $eÑÜÇ‘óÀÓ = IO::info($EÄÚ­™è); foreach ($c¸”÷Ñ± á[$A¡¨ÃÆî[367]] as $c¾Ü›¦ÚØó => $f±Ñëòİ½†) { if ($f±Ñëòİ½†[$A¡¨ÃÆî[394]] == $aÊ·İôéëš) { self::add($EÄÚ­™è); $e÷Ş¦³Ú¢İ = $c¸”÷Ñ± á[$A¡¨ÃÆî[1145]] . $f±Ñëòİ½†[$A¡¨ÃÆî[28]]; $e„í¢˜ò¶Ï = IO::copy($e÷Ş¦³Ú¢İ, IO::pathFather($EÄÚ­™è), REPEAT_REPLACE, $eÑÜÇ‘óÀÓ[$A¡¨ÃÆî[28]]); if ($e„í¢˜ò¶Ï) { self::remove($EÄÚ­™è, $aÊ·İôéëš); } return $e„í¢˜ò¶Ï; } } return !1; } public static function setDetail($b‘ÑùÛàÉ, $fò‘ÄòÒ¾, $dŸÍÈâãŞ) { $aéßøèæÌ‘ =& $_SERVER[ªúæÂ¡­ä½]; $B†°Ü¸¼ğ’ = self::listData($b‘ÑùÛàÉ); if (!$B†°Ü¸¼ğ’) { return; } foreach ($B†°Ü¸¼ğ’[$aéßøèæÌ‘[367]] as $cæï‚»öæ => $céâ¨×Á’é) { if ($céâ¨×Á’é[$aéßøèæÌ‘[394]] == $fò‘ÄòÒ¾) { $B†°Ü¸¼ğ’[$aéßøèæÌ‘[367]][$cæï‚»öæ][$aéßøèæÌ‘[1144]] = $dŸÍÈâãŞ; self::saveData($B†°Ü¸¼ğ’[$aéßøèæÌ‘[1146]], $B†°Ü¸¼ğ’[$aéßøèæÌ‘[367]]); return !0; } } return !1; } public static function fileInfo($E­¬¶¦ÂÌ, $d©¿®Ç¡…) { goto fîâ›Á¦¢à; cìİê–·­: $EíÜé©²Ä = $báğ…Å‡ŠÑ[33]; foreach ($aƒ×Ø¤¶ô¦[$báğ…Å‡ŠÑ[367]] as $Få‡æíÕöÃ => $dˆ˜ˆ¡øœ) { if ($dˆ˜ˆ¡øœ[$báğ…Å‡ŠÑ[394]] != $d©¿®Ç¡…) { continue; } $EíÜé©²Ä = $aƒ×Ø¤¶ô¦[$báğ…Å‡ŠÑ[1145]] . $dˆ˜ˆ¡øœ[$báğ…Å‡ŠÑ[28]]; break; } if (!$EíÜé©²Ä) { show_json(LNG($báğ…Å‡ŠÑ[105]), !1); } goto F¹‰ø’ä±ç; F¹‰ø’ä±ç: return IO::info($EíÜé©²Ä); goto fÓ±öƒ—; fîâ›Á¦¢à: $báğ…Å‡ŠÑ =& $_SERVER[ªúæÂ¡­ä½]; $aƒ×Ø¤¶ô¦ = self::listData($E­¬¶¦ÂÌ); if (!$aƒ×Ø¤¶ô¦) { show_json(LNG($báğ…Å‡ŠÑ[105]), !1); } goto cìİê–·­; fÓ±öƒ—: } public static function fileOut($DÀô¤ğŞÑ÷, $EĞ£»‡…÷, $f¿ëø£ó¢ã = false) { $cŞ¾‰ãòèÂ =& $_SERVER[ªúæÂ¡­ä½]; $DøÙù¿Ø×à = self::fileInfo($DÀô¤ğŞÑ÷, $EĞ£»‡…÷); $a‰¤¤Œòª =& $GLOBALS[$cŞ¾‰ãòèÂ[7]]; $f¿ëø£ó¢ã = isset($a‰¤¤Œòª[$cŞ¾‰ãòèÂ[1109]]) && $a‰¤¤Œòª[$cŞ¾‰ãòèÂ[1109]] == 1; if (isset($a‰¤¤Œòª[$cŞ¾‰ãòèÂ[29]]) && $a‰¤¤Œòª[$cŞ¾‰ãòèÂ[29]] == $cŞ¾‰ãòèÂ[1147]) { return IO::fileOutImage($DøÙù¿Ø×à[$cŞ¾‰ãòèÂ[76]], $a‰¤¤Œòª[$cŞ¾‰ãòèÂ[1148]]); } IO::fileOut($DøÙù¿Ø×à[$cŞ¾‰ãòèÂ[76]], $f¿ëø£ó¢ã, get_path_this($DÀô¤ğŞÑ÷)); } public static function listData($bÄÚò–âÎ„, $Fàô‘ñï† = true) { goto B‚ªˆƒôœÒ; B‚ªˆƒôœÒ: $eŒ¶å¯¿‡¡ =& $_SERVER[ªúæÂ¡­ä½]; if ($Fàô‘ñï† && !IO::exist($bÄÚò–âÎ„)) { return !1; } if (!self::$_historyBase) { self::$_historyBase = self::getBasePath(); } goto Aö¾™ßŸ˜İ; Aö¾™ßŸ˜İ: if (substr($bÄÚò–âÎ„, 0, strlen(TEMP_PATH)) == TEMP_PATH) { return !1; } $c³öÙâ¿ğ„ = self::pathHistory($bÄÚò–âÎ„); $fŠ±­•ê±Ü = array($eŒ¶å¯¿‡¡[1146] => $c³öÙâ¿ğ„ . $eŒ¶å¯¿‡¡[1133], $eŒ¶å¯¿‡¡[1145] => rtrim(get_path_father($c³öÙâ¿ğ„), $eŒ¶å¯¿‡¡[8]) . $eŒ¶å¯¿‡¡[8], $eŒ¶å¯¿‡¡[367] => array()); goto fİİæØÈç; fİİæØÈç: $aéÛíê÷÷· = IO::getContent($fŠ±­•ê±Ü[$eŒ¶å¯¿‡¡[1146]]); if ($aéÛíê÷÷·) { $Aº…½É¾­ = json_decode($aéÛíê÷÷·, !0); if (is_array($Aº…½É¾­)) { $fŠ±­•ê±Ü[$eŒ¶å¯¿‡¡[367]] = $Aº…½É¾­; } } return $fŠ±­•ê±Ü; goto c©ÓŠ´•ì·; c©ÓŠ´•ì·: } private static function saveData($Eæò¦…õß£, $BÅÍµíâ¦) { goto C¢±”‘®¨Ü; C¢±”‘®¨Ü: $Aö‹Óáåáù =& $_SERVER[ªúæÂ¡­ä½]; self::log($Aö‹Óáåáù[1149] . $Eæò¦…õß£ . $Aö‹Óáåáù[68] . count($BÅÍµíâ¦), $Aö‹Óáåáù[730]); if ($BÅÍµíâ¦) { return IO::setContent($Eæò¦…õß£, json_encode($BÅÍµíâ¦)); } goto c¾­Í½ÂØÄ; c¾­Í½ÂØÄ: $a—Ô„ƒìŒ = IO::pathFather($Eæò¦…õß£); IO::remove($Eæò¦…õß£); self::clearEmptyFolder($a—Ô„ƒìŒ); goto Bç‘ÏÅ‹áˆ; Bç‘ÏÅ‹áˆ: return !0; goto b‚ğŠˆáğ; b‚ğŠˆáğ: } public static function clearEmptyFolder($aÊòÂõ”î°) { goto E«ÇÖ«ª; E«ÇÖ«ª: $aƒöÃœª‹ =& $_SERVER[ªúæÂ¡­ä½]; if (trim($aÊòÂõ”î°, $aƒöÃœª‹[8]) == trim(self::$_historyBase, $aƒöÃœª‹[8])) { return; } $FÂñä“†ˆ = IO::pathFather($aÊòÂõ”î°); goto FÎåÔÚ“°; FÎåÔÚ“°: $e¢°×ì£Úî = IO::has($aÊòÂõ”î°, !0); if ($e¢°×ì£Úî[$aƒöÃœª‹[203]] > 0 || $e¢°×ì£Úî[$aƒöÃœª‹[204]] > 0) { return; } IO::remove($aÊòÂõ”î°); goto fàª»æ•‰®; fàª»æ•‰®: self::clearEmptyFolder($FÂñä“†ˆ); goto aÂ„š­ÎÆÑ; aÂ„š­ÎÆÑ: } private static function getBasePath() { goto e±Î‰É†‡; CÔ‡Ä™Ÿ: $E‰ËÛ¢ÑƒÏ = DATA_PATH . $Bª‡è†Ğ¬£[1152] . rand_string(8) . $Bª‡è†Ğ¬£[8]; $E‰ËÛ¢ÑƒÏ = IO::mkdir($E‰ËÛ¢ÑƒÏ); $E‰ËÛ¢ÑƒÏ = rtrim($E‰ËÛ¢ÑƒÏ, $Bª‡è†Ğ¬£[8]) . $Bª‡è†Ğ¬£[8]; goto F«ÂÏßìÁ‡; e±Î‰É†‡: $Bª‡è†Ğ¬£ =& $_SERVER[ªúæÂ¡­ä½]; $E‰ËÛ¢ÑƒÏ = Model($Bª‡è†Ğ¬£[1150])->get($Bª‡è†Ğ¬£[1151]); if ($E‰ËÛ¢ÑƒÏ) { if (!IO::exist($E‰ËÛ¢ÑƒÏ)) { IO::mkdir($E‰ËÛ¢ÑƒÏ); } if (get_path_this($E‰ËÛ¢ÑƒÏ) == $Bª‡è†Ğ¬£[1136]) { $FÅéàšèö— = $Bª‡è†Ğ¬£[1152] . rand_string(8); @rename($E‰ËÛ¢ÑƒÏ, get_path_father($E‰ËÛ¢ÑƒÏ) . $Bª‡è†Ğ¬£[8] . $FÅéàšèö—); $E‰ËÛ¢ÑƒÏ = DATA_PATH . $FÅéàšèö— . $Bª‡è†Ğ¬£[8]; file_put_contents(DATA_PATH . $Bª‡è†Ğ¬£[1153], $Bª‡è†Ğ¬£[33]); Model($Bª‡è†Ğ¬£[1150])->set($Bª‡è†Ğ¬£[1151], $E‰ËÛ¢ÑƒÏ); } return $E‰ËÛ¢ÑƒÏ; } goto CÔ‡Ä™Ÿ; F«ÂÏßìÁ‡: file_put_contents($E‰ËÛ¢ÑƒÏ . $Bª‡è†Ğ¬£[1153], $Bª‡è†Ğ¬£[33]); file_put_contents(DATA_PATH . $Bª‡è†Ğ¬£[1153], $Bª‡è†Ğ¬£[33]); Model($Bª‡è†Ğ¬£[1150])->set($Bª‡è†Ğ¬£[1151], $E‰ËÛ¢ÑƒÏ); goto C¿ì§ç’×; C¿ì§ç’×: return $E‰ËÛ¢ÑƒÏ; goto F¢ç„˜òãî; F¢ç„˜òãî: } } goto FøéÈŞ¶À; dÃ¼À¢ÕÚ: class PathDriverDbShareItem extends PathDriverDB { public function __construct($A“ÌíŸ­›ß) { $this->pathParse = $A“ÌíŸ­›ß; $this->model = Model($_SERVER[ªúæÂ¡­ä½][1221]); } public function getPathOuter($aÏ®Ü¯ÂÄ) { $CË¡ŠâĞÈ— =& $_SERVER[ªúæÂ¡­ä½]; if (!$aÏ®Ü¯ÂÄ) { return $aÏ®Ü¯ÂÄ; } $B®Šš¶êÎ = $this->parse($aÏ®Ü¯ÂÄ); return trim(KodIO::makeShare($this->pathParse[$CË¡ŠâĞÈ—[394]], $B®Šš¶êÎ[$CË¡ŠâĞÈ—[394]]), $CË¡ŠâĞÈ—[8]); } protected function infoParse($fÛ¹¯™±Ì¼, $cƒê“ÊÙˆ— = false, $E›š‡ŠÈ«Ï = false) { $föšÁò†ÍÛ =& $_SERVER[ªúæÂ¡­ä½]; $b–Õ·ğ…¸å = $this->pathParse[$föšÁò†ÍÛ[394]]; $C¸šë‡òœ› = trim($this->pathParse[$föšÁò†ÍÛ[1079]], $föšÁò†ÍÛ[8]); return Action($föšÁò†ÍÛ[1229])->sharePathInfo($b–Õ·ğ…¸å, $C¸šë‡òœ›); } public function infoFull($CöÂÃšš’) { $cÛ±£İìÈÈ =& $_SERVER[ªúæÂ¡­ä½]; $fîñ·‰®õ = explode($cÛ±£İìÈÈ[8], trim($CöÂÃšš’, $cÛ±£İìÈÈ[8])); if (count($fîñ·‰®õ) > 1) { $E‰ªŒ÷‹ËÔ = implode($cÛ±£İìÈÈ[8], array_splice($fîñ·‰®õ, 1)); $B¦Ø¡ãéˆ = $this->model->pathInfoByPath($fîñ·‰®õ[0], $E‰ªŒ÷‹ËÔ); if (!$B¦Ø¡ãéˆ) { return !1; } $this->pathParse[$cÛ±£İìÈÈ[1079]] = $B¦Ø¡ãéˆ[$cÛ±£İìÈÈ[396]]; } return $this->infoParse($CöÂÃšš’); } public function listAll($AÛ”±››ƒî) { goto CÈåà·½î; CˆºŠÀÑå: $FÃ£ÏÙèÁÀ = $this->model->listAll($AÛ”±››ƒî); $D”Æëƒ‰š = Model($CÙ¾Ùó‡«Ä[577])->getInfo($D‰«íÂĞ…É[$CÙ¾Ùó‡«Ä[469]]); $f¼¼Åà»êŸ = Action($CÙ¾Ùó‡«Ä[1229]); goto Dµ¼çç«è; CÈåà·½î: $CÙ¾Ùó‡«Ä =& $_SERVER[ªúæÂ¡­ä½]; $D‰«íÂĞ…É = IO::info($this->pathParse[$CÙ¾Ùó‡«Ä[76]]); if (!$D‰«íÂĞ…É) { return array(); } goto CˆºŠÀÑå; Dµ¼çç«è: foreach ($FÃ£ÏÙèÁÀ as &$FØ…Õµ¡¾’) { check_abort(); $FØ…Õµ¡¾’[$CÙ¾Ùó‡«Ä[85]] = $f¼¼Åà»êŸ->_shareItemeParse($FØ…Õµ¡¾’[$CÙ¾Ùó‡«Ä[85]], $D”Æëƒ‰š); } unset($FØ…Õµ¡¾’); return $FÃ£ÏÙèÁÀ; goto a¾…ïÀÌ³Ù; a¾…ïÀÌ³Ù: } } class PathDriverDbShareLink extends PathDriverDB { public function __construct($CÕŒ­ö½«) { $this->pathParse = $CÕŒ­ö½«; $this->model = Model($_SERVER[ªúæÂ¡­ä½][1221]); } protected function infoParse($dŒš¨öšÉò, $B•»îóÖÅ¡ = false, $bëäÏ­Ó± = false) { $dÏÈ±·ÑÅÊ =& $_SERVER[ªúæÂ¡­ä½]; return Action($dÏÈ±·ÑÅÊ[1085])->sharePathInfo($this->pathParse[$dÏÈ±·ÑÅÊ[76]], !0); } public function listPath($Cá›õµáË, $f¥òÆÃÖš† = false) { $a±’å¬¶™¡ =& $_SERVER[ªúæÂ¡­ä½]; $cèè¼ÍŞ = parent::listPath($Cá›õµáË, $f¥òÆÃÖš†); foreach ($cèè¼ÍŞ as $c»î¬²‘òÙ => $bÌ¨Â˜¦‚ï) { if (!in_array($c»î¬²‘òÙ, array($a±’å¬¶™¡[74], $a±’å¬¶™¡[75]))) { continue; } foreach ($bÌ¨Â˜¦‚ï as $EÎ‘”İ‰„ƒ => $FŠÒ Ó»Ó) { $cèè¼ÍŞ[$c»î¬²‘òÙ][$EÎ‘”İ‰„ƒ] = Action($a±’å¬¶™¡[1085])->shareItemInfo($FŠÒ Ó»Ó); } } return $cèè¼ÍŞ; } public function listAll($Côæ˜·âÕî) { goto eâªÈÆÑ„; e¸ÁßÓ¬ÛÀ: return $F‚Ğ“·êŒ’; goto bÜ®‹Ÿ¾ÈÅ; F‘›¼²Œæ´: $F‚Ğ“·êŒ’ = $this->model->listAll($Côæ˜·âÕî); foreach ($F‚Ğ“·êŒ’ as &$Cè¤Õ©ÇšÙ) { $Cè¤Õ©ÇšÙ[$A¼Ç’ƒ›™¯[85]] = Action($A¼Ç’ƒ›™¯[1085])->shareItemInfo($Cè¤Õ©ÇšÙ[$A¼Ç’ƒ›™¯[85]]); } unset($Cè¤Õ©ÇšÙ); goto e¸ÁßÓ¬ÛÀ; eâªÈÆÑ„: $A¼Ç’ƒ›™¯ =& $_SERVER[ªúæÂ¡­ä½]; $a§ÁˆîÏ¼£ = IO::info($this->pathParse[$A¼Ç’ƒ›™¯[76]]); if (!$a§ÁˆîÏ¼£) { return array(); } goto F‘›¼²Œæ´; bÜ®‹Ÿ¾ÈÅ: } } class PathDriverDriverShareItem { public function __construct($a‘«£Á÷¹Ï) { $this->pathParse = $a‘«£Á÷¹Ï; } public function __call($AˆÉÖ™«ËÈ, $dğ°†ì­¹Ğ) { $eùÎÃ¡øèŞ =& $_SERVER[ªúæÂ¡­ä½]; if (method_exists($this, $AˆÉÖ™«ËÈ)) { return; } $A®‡ºÀ–ö‚ = call_user_func_array(array($eùÎÃ¡øèŞ[1230], $AˆÉÖ™«ËÈ), $dğ°†ì­¹Ğ); $DİÏº†Ö Ä = array($eùÎÃ¡øèŞ[1231], $eùÎÃ¡øèŞ[1232], $eùÎÃ¡øèŞ[1233], $eùÎÃ¡øèŞ[1234], $eùÎÃ¡øèŞ[532], $eùÎÃ¡øèŞ[534], $eùÎÃ¡øèŞ[1235], $eùÎÃ¡øèŞ[107], $eùÎÃ¡øèŞ[1236], $eùÎÃ¡øèŞ[1237]); if (in_array($AˆÉÖ™«ËÈ, $DİÏº†Ö Ä)) { $A®‡ºÀ–ö‚ = $this->getPathOuter($A®‡ºÀ–ö‚); } return $A®‡ºÀ–ö‚; } public function copy($c¿ó¾¤ÀÒ, $eáîëÀ, $bù¨Ü‡°¸â = false) { return $this->copyMove($c¿ó¾¤ÀÒ, $eáîëÀ, $bù¨Ü‡°¸â, $_SERVER[ªúæÂ¡­ä½][532]); } public function move($b†Ìğ«»Ôæ, $CÁ¶òÂ†¨, $D·ŒÏ©‹ØË = false) { return $this->copyMove($b†Ìğ«»Ôæ, $CÁ¶òÂ†¨, $D·ŒÏ©‹ØË, $_SERVER[ªúæÂ¡­ä½][534]); } private function copyMove($E“Ê–áê†¿, $eËˆóõŒŞÏ, $eÂå…¸†Ï, $AÉ²ÚŠÂˆØ) { goto A¿„°Â»á; fçˆºÒØ: if ($A¡……Šëïß->pathParse[$dÈ™õ¦ßŠø[1063]]) { $eËˆóõŒŞÏ = $A¡……Šëïß->pathParse[$dÈ™õ¦ßŠø[1063]]; } else { $eËˆóõŒŞÏ = $bãÒ¾Ë«; } $dµ¿™ôïÉù = IO::copyMove($E“Ê–áê†¿, $eËˆóõŒŞÏ, $eÂå…¸†Ï, $AÉ²ÚŠÂˆØ); $dµ¿™ôïÉù = $this->getPathOuter($dµ¿™ôïÉù); goto e¯™ïğøŸ; e¯™ïğøŸ: return $dµ¿™ôïÉù; goto F‰”ŞÖ†ô˜; A¿„°Â»á: $dÈ™õ¦ßŠø =& $_SERVER[ªúæÂ¡­ä½]; $bãÒ¾Ë« = $eËˆóõŒŞÏ; $A¡……Šëïß = IO::driverMake($eËˆóõŒŞÏ); goto fçˆºÒØ; F‰”ŞÖ†ô˜: } public function pathThis($eÛ‚³¨ÙìÅ) { return get_path_this($this->pathParse[$_SERVER[ªúæÂ¡­ä½][76]]); } public function pathFather($f»ŸßØº¶·) { return get_path_father($this->pathParse[$_SERVER[ªúæÂ¡­ä½][76]]); } public function iconvSystem($c•¢ãªÇíø) { return $c•¢ãªÇíø; } protected function infoParse($d¿ò¿ÙÌÍ§, $a…ó°·ÒÙ¡ = false) { $D¤ßˆ¹¹¿º =& $_SERVER[ªúæÂ¡­ä½]; $C†¢Ú¹Ö¨ê = $this->pathParse[$D¤ßˆ¹¹¿º[467]][$D¤ßˆ¹¹¿º[1086]] . $this->pathParse[$D¤ßˆ¹¹¿º[1079]]; if ($a…ó°·ÒÙ¡) { $A¡½çŒ•Š = IO::infoWithChildren($C†¢Ú¹Ö¨ê); } else { $A¡½çŒ•Š = IO::info($C†¢Ú¹Ö¨ê); } $Aº£Ü˜ÇÅ² = $this->pathParse[$D¤ßˆ¹¹¿º[467]]; return Action($D¤ßˆ¹¹¿º[1229])->_shareItemeParse($A¡½çŒ•Š, $Aº£Ü˜ÇÅ²); } public function listAll($Aôõ Èõ•œ) { $a¿Ìñ¾‡‹Ë =& $_SERVER[ªúæÂ¡­ä½]; $F÷õŞïÍÈŒ = IO::listAll($Aôõ Èõ•œ); $aó¢ØÊåÀª = $this->pathParse[$a¿Ìñ¾‡‹Ë[467]]; foreach ($F÷õŞïÍÈŒ as &$cï†å£³¯Ä) { check_abort(); $f„¤‹Ì¹Ö² = IO::info($cï†å£³¯Ä[$a¿Ìñ¾‡‹Ë[76]]); $f„¤‹Ì¹Ö² = is_array($f„¤‹Ì¹Ö²) ? $f„¤‹Ì¹Ö² : array(); $cï†å£³¯Ä = array_merge($f„¤‹Ì¹Ö², $cï†å£³¯Ä); $cï†å£³¯Ä[$a¿Ìñ¾‡‹Ë[85]] = Action($a¿Ìñ¾‡‹Ë[1229])->_shareItemeParse($cï†å£³¯Ä, $aó¢ØÊåÀª); } unset($cï†å£³¯Ä); return $F÷õŞïÍÈŒ; } public function getPathOuter($d¡ Åä¬Ÿ¥) { goto Eã¸ÒÚ…î; Dø¾·…ÏŠ: $Eèáëºà­ = KodIO::clear($d¡ Åä¬Ÿ¥); $bÙ³Çö¤â¹ = KodIO::clear($this->pathParse[$F¦¸›÷ç‡[467]][$F¦¸›÷ç‡[1086]]); $c·Ì¾æ¬¹  = substr($Eèáëºà­, strlen($bÙ³Çö¤â¹)); goto B¦åæŸ¼Ùº; Eã¸ÒÚ…î: $F¦¸›÷ç‡ =& $_SERVER[ªúæÂ¡­ä½]; $f‹Ş«¬İ—‡ = KodIO::parse($d¡ Åä¬Ÿ¥); if ($f‹Ş«¬İ—‡[$F¦¸›÷ç‡[29]] == KodIO::KOD_SHARE_ITEM) { return $f‹Ş«¬İ—‡[$F¦¸›÷ç‡[76]]; } goto Dø¾·…ÏŠ; B¦åæŸ¼Ùº: if (substr($Eèáëºà­, 0, strlen($bÙ³Çö¤â¹)) != $bÙ³Çö¤â¹) { return !1; } return $this->pathParse[$F¦¸›÷ç‡[1080]] . $F¦¸›÷ç‡[8] . ltrim($c·Ì¾æ¬¹ , $F¦¸›÷ç‡[8]); goto fÏš¥ˆÜ·‡; fÏš¥ˆÜ·‡: } public function getType() { $e²ğ‘Í¡ =& $_SERVER[ªúæÂ¡­ä½]; $e•Ó¤š‘ô = str_replace($e²ğ‘Í¡[72], $e²ğ‘Í¡[33], get_class($this)); return strtolower($e•Ó¤š‘ô); } public function isTypeObject($BÜï–×ã ¡) { return IO::isTypeObject($BÜï–×ã ¡); } public function info($F¦ÖŒœŒ°î) { return $this->infoParse($F¦ÖŒœŒ°î); } public function infoAuth($aíÊŠ¯›Ìì) { return $this->infoParse($aíÊŠ¯›Ìì); } public function infoWithChildren($C«åÄåöä‚) { return $this->infoParse($C«åÄåöä‚, !0); } public function infoFull($CŞ‘ìÌÏ”Ñ) { return $this->infoParse($CŞ‘ìÌÏ”Ñ); } } goto b¹ŠÏ“ òà; CÆ¬Í­Ô¯Ü: class PathDriverS3 extends PathDriverBaseS3 { public function __construct($f¦éÀíõßê) { parent::__construct($f¦éÀíõßê); } public function uploadFormData($a“ƒØ§„òÓ, $f´ù¼Ã¼åÆ = 3600) { goto DŠõ‡‹¥; f¤êÔÏ—İŠ: $eÀÛõù–¢ = $fî©¾æäÅ[59]; $déÉ˜£ƒª = gmdate($fî©¾æäÅ[1240]); $b”Û«ïÙ = gmdate($fî©¾æäÅ[729]); goto FÓåïå®ÕË; b©ªŞŞ•Òó: $F¯”¿†Ô‰• = array($fî©¾æäÅ[211] => $fî©¾æäÅ[33], $fî©¾æäÅ[1251] => $fî©¾æäÅ[33], $fî©¾æäÅ[1208] => $cÉå Ä¥Ô, $fî©¾æäÅ[1212] => $CĞ ÕĞ Ëá, $fî©¾æäÅ[1216] => $Dø¿Éò‘ç, $fî©¾æäÅ[1252] => $c‹ÀÇ‚‚æ, $fî©¾æäÅ[1253] => $eãï‚ÂÚÜ», $fî©¾æäÅ[1254] => $déÉ˜£ƒª, $fî©¾æäÅ[1255] => $c…³³ïÚ™Î, $fî©¾æäÅ[1256] => $bºÏå»ï¬, $fî©¾æäÅ[175] => $this->getHost()); return $F¯”¿†Ô‰•; goto EÕ®â»‘±; DŠõ‡‹¥: $fî©¾æäÅ =& $_SERVER[ªúæÂ¡­ä½]; $cÉå Ä¥Ô = $fî©¾æäÅ[192]; $eãï‚ÂÚÜ» = $fî©¾æäÅ[1239]; goto f¤êÔÏ—İŠ; c©È“ÅÉ’ó: $AÚ³…êÀ³‡ = array($this->accessKey, $b”Û«ïÙ, $this->region, $eÀÛõù–¢, $fÙáñ×Ø); $c‹ÀÇ‚‚æ = implode($fî©¾æäÅ[8], $AÚ³…êÀ³‡); $e˜„ëå÷Ğğ = array($fî©¾æäÅ[1206] => gmdate($fî©¾æäÅ[1205], strtotime($fî©¾æäÅ[1242])), $fî©¾æäÅ[1207] => array(array($fî©¾æäÅ[1209] => $this->bucket), array($fî©¾æäÅ[1208] => $cÉå Ä¥Ô), array($fî©¾æäÅ[1210], $fî©¾æäÅ[1211], $fî©¾æäÅ[33]), array($fî©¾æäÅ[1210], $fî©¾æäÅ[1243], $fî©¾æäÅ[33]), array($fî©¾æäÅ[1210], $fî©¾æäÅ[1244], $fî©¾æäÅ[33]), array($fî©¾æäÅ[1212] => $CĞ ÕĞ Ëá), array($fî©¾æäÅ[1245] => $c‹ÀÇ‚‚æ), array($fî©¾æäÅ[1246] => $eãï‚ÂÚÜ»), array($fî©¾æäÅ[1247] => $déÉ˜£ƒª), array($fî©¾æäÅ[1248] => $c…³³ïÚ™Î))); goto AàÚÀŸ¼; FÓåïå®ÕË: $fÙáñ×Ø = $fî©¾æäÅ[1241]; $c…³³ïÚ™Î = $f´ù¼Ã¼åÆ . $fî©¾æäÅ[33]; $CĞ ÕĞ Ëá = $fî©¾æäÅ[1204]; goto c©È“ÅÉ’ó; Cóëø‚­ˆ¡: $d³ïÙƒÓÎ = hash_hmac($fî©¾æäÅ[1249], $eÀÛõù–¢, $dœÜ½çàõÆ, !0); $cğ©ƒ£Šò = hash_hmac($fî©¾æäÅ[1249], $fÙáñ×Ø, $d³ïÙƒÓÎ, !0); $bºÏå»ï¬ = hash_hmac($fî©¾æäÅ[1249], $Dø¿Éò‘ç, $cğ©ƒ£Šò); goto b©ªŞŞ•Òó; AàÚÀŸ¼: $Dø¿Éò‘ç = base64_encode(json_encode($e˜„ëå÷Ğğ)); $a¸ç“ë÷î = hash_hmac($fî©¾æäÅ[1249], $b”Û«ïÙ, $fî©¾æäÅ[1250] . $this->secret, !0); $dœÜ½çàõÆ = hash_hmac($fî©¾æäÅ[1249], $this->region, $a¸ç“ë÷î, !0); goto Cóëø‚­ˆ¡; EÕ®â»‘±: } public function multiUploadFormData($f‹¸ßÔÙåÛ, $F˜™ùñ¥Íç = 3600) { $aÃİ«÷ºÉ… =& $_SERVER[ªúæÂ¡­ä½]; $a®Ö±îÊò× = gmdate($aÃİ«÷ºÉ…[1333]); $ağ‡¬‚ÓÜ¨ = array(); $b”•È…·İ¨ = $this->client->getUploadId($this->bucket, $f‹¸ßÔÙåÛ, $ağ‡¬‚ÓÜ¨); if (!$b”•È…·İ¨) { return !1; } return array($aÃİ«÷ºÉ…[221] => $b”•È…·İ¨, $aÃİ«÷ºÉ…[175] => $this->getHost() . $aÃİ«÷ºÉ…[8] . $this->pathEncode($f‹¸ßÔÙåÛ), $aÃİ«÷ºÉ…[222] => $a®Ö±îÊò×, $aÃİ«÷ºÉ…[93] => $f‹¸ßÔÙåÛ); } public function multiUploadAuthData($Aö¤›‚‡”, $bßâÀ­É¶˜ = array()) { goto EêÍÆ×ÅÈö; f‚‘’ÆÔƒœ: unset($bßâÀ­É¶˜[$FŠÇê‰ôÄ˜[93]]); if (isset($bßâÀ­É¶˜[$FŠÇê‰ôÄ˜[223]])) { return $this->listUploadParts($C×ôòöĞÂÇ, $bßâÀ­É¶˜); } $d¶É‡´†å = array(); goto f¼ê…îÙé—; cÑ±Öà©³½: $EÆ‡óˆ ‚½ = $FŠÇê‰ôÄ˜[226]; $BêÒÉˆĞµÉ = $FŠÇê‰ôÄ˜[8] . $this->pathEncode($C×ôòöĞÂÇ) . $aó‹¸øÏ°ä; $DëÈ¦ï«³ = $this->client->__getSignatureV4($d¶É‡´†å, $f²…ø¦ùßå, $EÆ‡óˆ ‚½, $BêÒÉˆĞµÉ); goto cÕ™¹Ã«º; f¼ê…îÙé—: if (isset($bßâÀ­É¶˜[$FŠÇê‰ôÄ˜[1334]])) { $d¶É‡´†å[$FŠÇê‰ôÄ˜[1335]] = $bßâÀ­É¶˜[$FŠÇê‰ôÄ˜[1334]]; } $c´¾›‘™ï = explode($FŠÇê‰ôÄ˜[177], $this->getHost()); $f²…ø¦ùßå = array($FŠÇê‰ôÄ˜[1336] => $c´¾›‘™ï[1], $FŠÇê‰ôÄ˜[1337] => $FŠÇê‰ôÄ˜[33], $FŠÇê‰ôÄ˜[211] => $FŠÇê‰ôÄ˜[119], $FŠÇê‰ôÄ˜[1251] => $bßâÀ­É¶˜[$FŠÇê‰ôÄ˜[78]]); goto cÑ±Öà©³½; cÕ™¹Ã«º: if (strpos($aó‹¸øÏ°ä, $FŠÇê‰ôÄ˜[225]) === 0) { if (isset($d¶É‡´†å[$FŠÇê‰ôÄ˜[1335]])) { $bÖº„±¥ ‹ = $d¶É‡´†å[$FŠÇê‰ôÄ˜[1335]]; } else { if (isset($DëÈ¦ï«³[$FŠÇê‰ôÄ˜[1335]])) { $bÖº„±¥ ‹ = $DëÈ¦ï«³[$FŠÇê‰ôÄ˜[1335]]; } else { $bÖº„±¥ ‹ = hash($FŠÇê‰ôÄ˜[1249], $FŠÇê‰ôÄ˜[33]); } } return array($FŠÇê‰ôÄ˜[232] => $DëÈ¦ï«³[$FŠÇê‰ôÄ˜[232]], $FŠÇê‰ôÄ˜[1335] => $bÖº„±¥ ‹, $FŠÇê‰ôÄ˜[222] => $DëÈ¦ï«³[$FŠÇê‰ôÄ˜[1338]]); } return $DëÈ¦ï«³[$FŠÇê‰ôÄ˜[232]]; goto Eô¢Û¸çåÇ; EêÍÆ×ÅÈö: $FŠÇê‰ôÄ˜ =& $_SERVER[ªúæÂ¡­ä½]; $aó‹¸øÏ°ä = isset($bßâÀ­É¶˜[$FŠÇê‰ôÄ˜[168]]) ? $bßâÀ­É¶˜[$FŠÇê‰ôÄ˜[168]] : $FŠÇê‰ôÄ˜[33]; $C×ôòöĞÂÇ = $bßâÀ­É¶˜[$FŠÇê‰ôÄ˜[93]]; goto f‚‘’ÆÔƒœ; Eô¢Û¸çåÇ: } public function listUploadParts($a¼˜íƒò¸¤, $Bßğ‡ç¿¿© = array()) { goto f´ˆô™·Ñä; Bê÷™Ëï¨‚: $Fƒç µåë‡ = $this->client->__getSignatureV4($b«Ã˜Ø‚ñæ, $BğíÓÔœ, $FÊ¥µå«åÔ, $Eˆ‹†©Ãß, $bá˜Ğä®”); return array($BĞ•ŠÍæé[232] => $Fƒç µåë‡[$BĞ•ŠÍæé[232]], $BĞ•ŠÍæé[222] => $Fƒç µåë‡[$BĞ•ŠÍæé[1338]], $BĞ•ŠÍæé[234] => $Ašª‚À”èß, $BĞ•ŠÍæé[1335] => $Fƒç µåë‡[$BĞ•ŠÍæé[1335]]); goto Fçª½ÀªÎÕ; BĞÉŸ¹†‡ô: $BğíÓÔœ = array($BĞ•ŠÍæé[1336] => $B–‡ñğá©[1], $BĞ•ŠÍæé[211] => $BĞ•ŠÍæé[119], $BĞ•ŠÍæé[1251] => strlen($bá˜Ğä®”)); $FÊ¥µå«åÔ = $BĞ•ŠÍæé[224]; $Eˆ‹†©Ãß = $BĞ•ŠÍæé[8] . $this->pathEncode($a¼˜íƒò¸¤) . $Bßğ‡ç¿¿©[$BĞ•ŠÍæé[168]]; goto Bê÷™Ëï¨‚; c×¥ÑÛ©§Ş: if (!$Ašª‚À”èß) { return !1; } $bá˜Ğä®” = $BĞ•ŠÍæé[1339]; foreach ($Ašª‚À”èß as $A¶Ïµ—ÑŠš) { $bá˜Ğä®” .= $BĞ•ŠÍæé[1340] . "\x3c\x50\141\x72\x74\116\x75\x6d\142\x65\162\x3e{$A¶Ïµ—ÑŠš[$BĞ•ŠÍæé[1296]]}\x3c\57\120\x61\x72\x74\x4e\165\x6d\x62\x65\x72\76\xa" . "\74\105\x54\x61\x67\x3e{$A¶Ïµ—ÑŠš[$BĞ•ŠÍæé[1297]]}\74\x2f\x45\124\x61\x67\76\xa" . $BĞ•ŠÍæé[1341]; } goto FÚğàé¿ä¥; f´ˆô™·Ñä: $BĞ•ŠÍæé =& $_SERVER[ªúæÂ¡­ä½]; $dš¸¶“Ûİ = str_replace($BĞ•ŠÍæé[233], $BĞ•ŠÍæé[33], $Bßğ‡ç¿¿©[$BĞ•ŠÍæé[168]]); $Ašª‚À”èß = $this->client->listParts($this->bucket, $a¼˜íƒò¸¤, $dš¸¶“Ûİ); goto c×¥ÑÛ©§Ş; FÚğàé¿ä¥: $bá˜Ğä®” .= $BĞ•ŠÍæé[1342]; $b«Ã˜Ø‚ñæ = array(); $B–‡ñğá© = explode($BĞ•ŠÍæé[177], $this->getHost()); goto BĞÉŸ¹†‡ô; Fçª½ÀªÎÕ: } public function link($c¼ö¤Ä»ê, $A“¢á†Àáô = array()) { return parent::link($c¼ö¤Ä»ê, $A“¢á†Àáô); } public function fileOut($e‹‡Ê÷á¼’, $B™øĞéì›à = false, $c·ÎŒŞøÊ’ = false, $B÷½¢ò¿¶ = '') { if ($this->isFileOutServer() || strstr($this->endpoint, $_SERVER[ªúæÂ¡­ä½][1343])) { return parent::fileOutServer($e‹‡Ê÷á¼’, $B™øĞéì›à, $c·ÎŒŞøÊ’, $B÷½¢ò¿¶); } parent::fileOut($e‹‡Ê÷á¼’, $B™øĞéì›à, $c·ÎŒŞøÊ’, $B÷½¢ò¿¶); } public function fileOutImage($AŒÊøã°¤È, $fÒê½æ·ÖÕ = 250) { if (strstr($this->endpoint, $_SERVER[ªúæÂ¡­ä½][1343])) { return parent::fileOutImageServer($AŒÊøã°¤È, $fÒê½æ·ÖÕ); } parent::fileOutImage($AŒÊøã°¤È, $fÒê½æ·ÖÕ); } public function fileOutLink($A¸¿Ç„øñÊ) { $dñÙ–¡ÑìÅ =& $_SERVER[ªúæÂ¡­ä½]; if (substr($A¸¿Ç„øñÊ, 0, 7) == $dñÙ–¡ÑìÅ[1219]) { $A¸¿Ç„øñÊ = $dñÙ–¡ÑìÅ[1220] . substr($A¸¿Ç„øñÊ, 7); } header($dñÙ–¡ÑìÅ[159] . $A¸¿Ç„øñÊ); die; } public function getHost() { $FÙËÛĞñí =& $_SERVER[ªúæÂ¡­ä½]; $b‚º•õÃó† = str_rtrim(parent::getHost(), $FÙËÛĞñí[8] . $this->bucket); $b‚º•õÃó† = explode($FÙËÛĞñí[177], $b‚º•õÃó†); return $b‚º•õÃó†[0] . $FÙËÛĞñí[177] . $this->bucket . $FÙËÛĞñí[95] . $b‚º•õÃó†[1]; } } class PathDriverStream extends PathDriverBase { const TYPE_STRING = 1; const TYPE_FILE = 2; public function __construct($Fõ„©–Ó¼, $EéÔÖø†×î = 0) { parent::__construct(); $this->source = $Fõ„©–Ó¼; $this->sourceSize = $EéÔÖø†×î; if (is_string($this->source)) { $this->sourceType = self::TYPE_STRING; $this->sourceSize = strlen($this->source); } else { $this->sourceType = self::TYPE_FILE; } } public function size($c©Áî¼¢• = false) { return $this->sourceSize; } public function getContent($DÛø×ê³³× = false) { return $this->fileSubstr($DÛø×ê³³×, 0, $this->sourceSize); } public function fileSubstr($e†¡öÕÏª = false, $BÂÎğ»ì = 0, $dÈ¾­µí“õ = 0) { if (!$dÈ¾­µí“õ) { $dÈ¾­µí“õ = $this->sourceSize; } $cÛõ‰»ÆÈÜ = $this->sourceSize - $BÂÎğ»ì; if ($dÈ¾­µí“õ >= $cÛõ‰»ÆÈÜ) { $dÈ¾­µí“õ = $cÛõ‰»ÆÈÜ; } if ($this->sourceType == self::TYPE_STRING) { return substr($this->source, $BÂÎğ»ì, $dÈ¾­µí“õ); } if ($this->sourceType == self::TYPE_FILE) { if ($dÈ¾­µí“õ <= 0) { return $_SERVER[ªúæÂ¡­ä½][33]; } $f© ÑùÃÈ = ftell($this->source); fseek_64($this->source, $f© ÑùÃÈ + $BÂÎğ»ì); $F ä“êé”· = @fread($this->source, $dÈ¾­µí“õ); fseek_64($this->source, $f© ÑùÃÈ); return $F ä“êé”·; } } public function hashMd5($bà‹ÒŸøï = false) { return md5($this->getContent()); } public static function hash($A³‹Ø‡ £, $A½õšàŞ¿ = 0) { $DŸí˜Ò¶·¥ = new PathDriverStream($A³‹Ø‡ £, $A½õšàŞ¿); return $DŸí˜Ò¶·¥->hashSimple($A³‹Ø‡ £); } public static function md5($e­µĞÛÃ†š, $A¬ö‚‹š™Ç = 0) { $få —¨‘ĞÃ = new PathDriverStream($e­µĞÛÃ†š, $A¬ö‚‹š™Ç); return $få —¨‘ĞÃ->hashMd5($e­µĞÛÃ†š); } } class PathDriverUSS extends PathDriverBase { protected $bucket = ''; protected $username = ''; protected $userpass = ''; protected $domain = ''; protected $token = ''; protected $endpoint = "\x68\x74\x74\160\72\57\x2f\166\60\56\x61\x70\x69\x2e\x75\x70\171\x75\156\56\143\x6f\x6d"; public $ioUploadServer = 0; public $ioFileOutServer = 0; public function __construct($D™¿Ï»ğªÕ) { parent::__construct(); $this->_init($D™¿Ï»ğªÕ); } public function _init($A¤Ğ‚½¥Ë) { $bÇÁÆ æõ¤ =& $_SERVER[ªúæÂ¡­ä½]; foreach ($A¤Ğ‚½¥Ë as $A‰ğùÉ°Š => $D½Œ§®Æ) { if (isset($this->{$A‰ğùÉ°Š})) { $this->{$A‰ğùÉ°Š} = $D½Œ§®Æ; } } if (empty($this->username) || empty($this->userpass) || empty($this->domain)) { throw new Exception($bÇÁÆ æõ¤[1344] . LNG($bÇÁÆ æõ¤[1277])); } } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } private function ussHeaders($fğ•ğŞ“Ø, $Eª÷©ŒØ½· = "\107\105\x54") { $DŒôöÆ­¹ =& $_SERVER[ªúæÂ¡­ä½]; $eÛÌµÁ—ˆô = gmdate($DŒôöÆ­¹[1310]); $a‚Ç¥›šÀ” = base64_encode(hash_hmac($DŒôöÆ­¹[1345], "{$Eª÷©ŒØ½·}\x26{$fğ•ğŞ“Ø}\x26{$eÛÌµÁ—ˆô}", md5("{$this->userpass}"), !0)); $b“¦Ü–ù¬ä = array("\101\165\x74\x68\157\162\151\x7a\141\x74\x69\157\x6e\x3a\x55\120\131\x55\x4e\x20{$this->username}\72{$a‚Ç¥›šÀ”}", "\x44\141\x74\x65\72{$eÛÌµÁ—ˆô}"); return $b“¦Ü–ù¬ä; } public function ussRequest($cˆÙÎÌ®ëê, $Aµ¹ê‰ßŞª = "\107\x45\x54", $Cø›ğ‹Í£à = false, $eãÁ××¿‘¬ = false, $E„Ş®£İÔ¿ = false) { goto DÆ¿Ûß¾Ú¿; DÆ¿Ûß¾Ú¿: $aŸñÂáø =& $_SERVER[ªúæÂ¡­ä½]; $cˆÙÎÌ®ëê = trim($cˆÙÎÌ®ëê, $aŸñÂáø[8]); $CœÕÌƒïÜğ = "\x2f{$this->bucket}\x2f{$cˆÙÎÌ®ëê}"; goto c¤Öä™íõÎ; c¤Öä™íõÎ: $BŠù¤‹ğ†ì = $this->ussHeaders($CœÕÌƒïÜğ, $Aµ¹ê‰ßŞª); if ($eãÁ××¿‘¬) { $BŠù¤‹ğ†ì = array_merge($BŠù¤‹ğ†ì, $eãÁ××¿‘¬); } $c›£¢±÷•Á = url_request($this->endpoint . $CœÕÌƒïÜğ, $Aµ¹ê‰ßŞª, $Cø›ğ‹Í£à, $BŠù¤‹ğ†ì, $E„Ş®£İÔ¿); goto e¬¦öš£èğ; e¬¦öš£èğ: if (!$c›£¢±÷•Á) { return array($aŸñÂáø[1101] => !1, $aŸñÂáø[1103] => $aŸñÂáø[1346]); } if (strtolower($Aµ¹ê‰ßŞª) == $aŸñÂáø[190] || in_array($c›£¢±÷•Á[$aŸñÂáø[1101]], array($aŸñÂáø[1204], $aŸñÂáø[1347]))) { $Cø›ğ‹Í£à = $c›£¢±÷•Á[$aŸñÂáø[1348]]; } else { $Cø›ğ‹Í£à = json_decode($c›£¢±÷•Á[$aŸñÂáø[1103]], !0); if (!$Cø›ğ‹Í£à) { $Cø›ğ‹Í£à = $c›£¢±÷•Á[$aŸñÂáø[1103]]; } else { if (!$c›£¢±÷•Á[$aŸñÂáø[728]] && isset($Cø›ğ‹Í£à[$aŸñÂáø[1349]])) { $Cø›ğ‹Í£à = $Cø›ğ‹Í£à[$aŸñÂáø[1349]]; } } } return array($aŸñÂáø[1101] => $c›£¢±÷•Á[$aŸñÂáø[728]], $aŸñÂáø[1103] => $Cø›ğ‹Í£à); goto BŞŞõÇ; BŞŞõÇ: } public function mkfile($aÇŠ¢‘ÌÅÃ, $d—Ä®ŠÃ¿ = '', $BÓÚ÷Å¤à‚ = REPEAT_RENAME) { if ($this->setContent($aÇŠ¢‘ÌÅÃ, $d—Ä®ŠÃ¿)) { return $this->getPathOuter($aÇŠ¢‘ÌÅÃ); } return !1; } public function mkdir($fËêÉÏÇ, $BãçÅÊÒìã = REPEAT_SKIP) { $bª©ÅÂÁ´— =& $_SERVER[ªúæÂ¡­ä½]; $dµòÅ×Ÿøà = trim($fËêÉÏÇ, $bª©ÅÂÁ´—[8]); if ($this->_isFolder($dµòÅ×Ÿøà)) { return $this->getPathOuter($dµòÅ×Ÿøà); } $Cèñ¦ë©© = array($bª©ÅÂÁ´—[1350]); $BÔ÷ŒÀ¼Õ = $this->ussRequest($dµòÅ×Ÿøà, $bª©ÅÂÁ´—[224], !1, $Cèñ¦ë©©); return $BÔ÷ŒÀ¼Õ[$bª©ÅÂÁ´—[1101]] ? $this->getPathOuter($dµòÅ×Ÿøà) : !1; } public function copyFile($E«ñ‘öÄÄç, $a£²½Áè…‰) { $F§‰‹áŒ‘ =& $_SERVER[ªúæÂ¡­ä½]; $C¤â„‚ÊøĞ = array($F§‰‹áŒ‘[1351] . "\57{$this->bucket}\x2f{$E«ñ‘öÄÄç}", $F§‰‹áŒ‘[1352]); $BÓÂâÂ†õù = $this->ussRequest($a£²½Áè…‰, $F§‰‹áŒ‘[226], !1, $C¤â„‚ÊøĞ); return $BÓÂâÂ†õù[$F§‰‹áŒ‘[1101]] ? !0 : $this->getPathOuter($a£²½Áè…‰); } public function moveFile($B¿êŞñŸÓé, $eÁ±æÏÓ½‚) { $dßÄÒ§Ü¦ğ =& $_SERVER[ªúæÂ¡­ä½]; $dõç²¶¡Æ„ = array($dßÄÒ§Ü¦ğ[1353] . "\57{$this->bucket}\x2f{$B¿êŞñŸÓé}", $dßÄÒ§Ü¦ğ[1352]); $d§ÂÜ¨éâí = $this->ussRequest($eÁ±æÏÓ½‚, $dßÄÒ§Ü¦ğ[226], !1, $dõç²¶¡Æ„); return $d§ÂÜ¨éâí[$dßÄÒ§Ü¦ğ[1101]] ? !0 : $this->getPathOuter($eÁ±æÏÓ½‚); } public function delFile($Däõ¨óËä¸) { $cæ£Ëµ¾¥Ò =& $_SERVER[ªúæÂ¡­ä½]; $DáÖ’ä§¥É = $this->ussRequest($Däõ¨óËä¸, $cæ£Ëµ¾¥Ò[1354]); return $DáÖ’ä§¥É[$cæ£Ëµ¾¥Ò[1101]] ? !0 : !1; } public function delFolder($A¾­¡Ø¾Ş) { goto cç«¦”ÇÄé; cç«¦”ÇÄé: $Eƒ„ƒùÒÑ =& $_SERVER[ªúæÂ¡­ä½]; if (!$this->exist($A¾­¡Ø¾Ş)) { return !0; } $this->listItemCache = !1; goto a¾ˆ¨˜ßõƒ; b³º†®åò‚: foreach ($eæÒ‹’ÄŞÑ as $E¬¸À®ÇÄ„) { $f¶ÂÛÀ‚Ê = $this->ussRequest($E¬¸À®ÇÄ„[$Eƒ„ƒùÒÑ[28]], $Eƒ„ƒùÒÑ[1354]); if (!$f¶ÂÛÀ‚Ê[$Eƒ„ƒùÒÑ[1101]]) { return !1; } } foreach ($A‡—‘ó÷å× as $eÙ—Ş‰¦Çæ) { $f¶ÂÛÀ‚Ê = $this->ussRequest($eÙ—Ş‰¦Çæ, $Eƒ„ƒùÒÑ[1354]); if (!$f¶ÂÛÀ‚Ê[$Eƒ„ƒùÒÑ[1101]]) { return !1; } } $f¶ÂÛÀ‚Ê = $this->ussRequest($A¾­¡Ø¾Ş, $Eƒ„ƒùÒÑ[1354]); goto DŒ‘¶ëˆ–‡; DŒ‘¶ëˆ–‡: return $f¶ÂÛÀ‚Ê[$Eƒ„ƒùÒÑ[1101]]; goto eáæ»Šö¡; a¾ˆ¨˜ßõƒ: $A‡—‘ó÷å× = $eæÒ‹’ÄŞÑ = array(); $this->fileList($A¾­¡Ø¾Ş, $A‡—‘ó÷å×, $eæÒ‹’ÄŞÑ, !0); $this->listItemCache = !0; goto b³º†®åò‚; eáæ»Šö¡: } public function rename($f§°‚Ò–ä¸, $A¥É„¤¹Œ„) { if ($this->isFile($f§°‚Ò–ä¸)) { $A¥É„¤¹Œ„ = get_path_father($f§°‚Ò–ä¸) . $A¥É„¤¹Œ„; return $this->moveFile($f§°‚Ò–ä¸, $A¥É„¤¹Œ„); } return $this->renameObject($f§°‚Ò–ä¸, $A¥É„¤¹Œ„); } public function fileInfo($A…Ä‡òñ¶¤, $c‘¸Î‹ÑĞæ = false, $Bìåß±Û‘ø = array()) { goto EØ¹Ü¼°ß×; e»‰Ö“â †: $eŞâ¦Ş®Ğ™[$fÒ”ìÜ•[194]] = intval($Bìåß±Û‘ø[$fÒ”ìÜ•[1355]]); $eŞâ¦Ş®Ğ™[$fÒ”ìÜ•[84]] = intval($Bìåß±Û‘ø[$fÒ”ìÜ•[1356]]); $eŞâ¦Ş®Ğ™[$fÒ”ìÜ•[78]] = $Bìåß±Û‘ø[$fÒ”ìÜ•[78]]; goto c¦í—ªŒÆĞ; EØ¹Ü¼°ß×: $fÒ”ìÜ• =& $_SERVER[ªúæÂ¡­ä½]; $eŞâ¦Ş®Ğ™ = array($fÒ”ìÜ•[28] => $this->pathThis($A…Ä‡òñ¶¤), $fÒ”ìÜ•[76] => $this->getPathOuter($fÒ”ìÜ•[8] . $A…Ä‡òñ¶¤), $fÒ”ìÜ•[29] => $fÒ”ìÜ•[193], $fÒ”ìÜ•[78] => isset($Bìåß±Û‘ø[$fÒ”ìÜ•[78]]) ? $Bìåß±Û‘ø[$fÒ”ìÜ•[78]] : 0, $fÒ”ìÜ•[168] => $this->ext($A…Ä‡òñ¶¤)); if ($c‘¸Î‹ÑĞæ) { return $eŞâ¦Ş®Ğ™; } goto CØèÌõë“¶; CØèÌõë“¶: $eŞâ¦Ş®Ğ™[$fÒ”ìÜ•[194]] = $eŞâ¦Ş®Ğ™[$fÒ”ìÜ•[84]] = 0; $eŞâ¦Ş®Ğ™[$fÒ”ìÜ•[195]] = $eŞâ¦Ş®Ğ™[$fÒ”ìÜ•[196]] = !0; if (empty($Bìåß±Û‘ø)) { $Bìåß±Û‘ø = $this->objectMeta($A…Ä‡òñ¶¤); if (!$Bìåß±Û‘ø) { return $eŞâ¦Ş®Ğ™; } } goto e»‰Ö“â †; c¦í—ªŒÆĞ: return $eŞâ¦Ş®Ğ™; goto FÀÖí±ğ¢“; FÀÖí±ğ¢“: } public function folderInfo($cù„İ§è·Ù, $c¥åÈÅÖ³Ó = false) { goto BİÃ¦ëêºÊ; Bğ–·Õ÷ğ: $b¶·àÀ‡[$e³½¿¸Í¡˜[194]] = $b¶·àÀ‡[$e³½¿¸Í¡˜[84]] = 0; $b¶·àÀ‡[$e³½¿¸Í¡˜[195]] = $b¶·àÀ‡[$e³½¿¸Í¡˜[196]] = !0; if (empty($CğÅï¢áÇ–)) { $CğÅï¢áÇ– = $this->objectMeta($cù„İ§è·Ù); if (!$CğÅï¢áÇ–) { return $b¶·àÀ‡; } } goto bÁÁ¦ÉíÇç; BİÃ¦ëêºÊ: $e³½¿¸Í¡˜ =& $_SERVER[ªúæÂ¡­ä½]; $b¶·àÀ‡ = array($e³½¿¸Í¡˜[28] => $this->pathThis($cù„İ§è·Ù), $e³½¿¸Í¡˜[76] => $this->getPathOuter($e³½¿¸Í¡˜[8] . $cù„İ§è·Ù), $e³½¿¸Í¡˜[29] => $e³½¿¸Í¡˜[77]); if ($c¥åÈÅÖ³Ó) { return $b¶·àÀ‡; } goto Bğ–·Õ÷ğ; bÁÁ¦ÉíÇç: $b¶·àÀ‡[$e³½¿¸Í¡˜[194]] = intval($CğÅï¢áÇ–[$e³½¿¸Í¡˜[1355]]); $b¶·àÀ‡[$e³½¿¸Í¡˜[84]] = intval($CğÅï¢áÇ–[$e³½¿¸Í¡˜[1356]]); return $b¶·àÀ‡; goto CÚ…¤ã¿”£; CÚ…¤ã¿”£: } private function listObjs($e¼õÖä›“, $dÁÅËŠåË¸ = 0, $f¤Ò¶‚¢ÄÅ = 1000) { $A–ì‡‘Ö¿¾ =& $_SERVER[ªúæÂ¡­ä½]; $b÷•ëÄÖç = array($A–ì‡‘Ö¿¾[1357], $A–ì‡‘Ö¿¾[1358] . $f¤Ò¶‚¢ÄÅ); if ($dÁÅËŠåË¸) { $b÷•ëÄÖç[] = $A–ì‡‘Ö¿¾[1359] . $dÁÅËŠåË¸; } $e„µŠó½¥ù = $this->ussRequest($e¼õÖä›“, $A–ì‡‘Ö¿¾[228], !1, $b÷•ëÄÖç); return !$e„µŠó½¥ù[$A–ì‡‘Ö¿¾[1101]] ? !1 : $e„µŠó½¥ù[$A–ì‡‘Ö¿¾[1103]]; } private function fileList($eœµµÖ“ïË, &$fÀ÷‡¯ñíÏ, &$båİ àÚõŒ, $CÁî’ïï¤Á = false) { goto E ì±Ò¾¨; dÕàåøï¹Œ: $eóËÑíğ• = rtrim($eœµµÖ“ïË, $B›®™çÎÊ‹[8]) . $B›®™çÎÊ‹[8]; $bĞ…†£çÃ× = $this->listItemCache === !1 ? !1 : !0; while (!0) { check_abort(); $F©Í¼Ş™„ = $this->listObjs($eœµµÖ“ïË, $eª“Ÿê­¤Ï, $cˆ’¦ßßŒĞ); if (!$F©Í¼Ş™„) { return !1; } $eª“Ÿê­¤Ï = isset($F©Í¼Ş™„[$B›®™çÎÊ‹[1360]]) ? $F©Í¼Ş™„[$B›®™çÎÊ‹[1360]] : $B›®™çÎÊ‹[33]; $c’ª†š„Ú = isset($F©Í¼Ş™„[$B›®™çÎÊ‹[1361]]) ? $F©Í¼Ş™„[$B›®™çÎÊ‹[1361]] : array(); foreach ($c’ª†š„Ú as $cŸÉ±¿İ¡Ü) { $AÜœ¨—ß¶‘ = $cŸÉ±¿İ¡Ü[$B›®™çÎÊ‹[29]] == $B›®™çÎÊ‹[77] ? !0 : !1; $fµ«Ìâ¸ñ = ltrim($eóËÑíğ• . $cŸÉ±¿İ¡Ü[$B›®™çÎÊ‹[28]], $B›®™çÎÊ‹[8]) . ($AÜœ¨—ß¶‘ ? $B›®™çÎÊ‹[8] : $B›®™çÎÊ‹[33]); $b†¼­ä…À = array($B›®™çÎÊ‹[28] => $fµ«Ìâ¸ñ, $B›®™çÎÊ‹[29] => $AÜœ¨—ß¶‘ ? $B›®™çÎÊ‹[77] : $B›®™çÎÊ‹[193], $B›®™çÎÊ‹[78] => $cŸÉ±¿İ¡Ü[$B›®™çÎÊ‹[335]], $B›®™çÎÊ‹[1356] => $cŸÉ±¿İ¡Ü[$B›®™çÎÊ‹[1362]]); if ($bĞ…†£çÃ×) { $this->cacheMethod($B›®™çÎÊ‹[199], $fµ«Ìâ¸ñ, $AÜœ¨—ß¶‘); $this->cacheMethod($B›®™çÎÊ‹[200], $fµ«Ìâ¸ñ, $b†¼­ä…À); } if ($AÜœ¨—ß¶‘) { $fÀ÷‡¯ñíÏ[] = $fµ«Ìâ¸ñ; if ($CÁî’ïï¤Á) { $this->fileList($fµ«Ìâ¸ñ, $fÀ÷‡¯ñíÏ, $båİ àÚõŒ, $CÁî’ïï¤Á); } continue; } $båİ àÚõŒ[] = $b†¼­ä…À; } if (count($c’ª†š„Ú) < $cˆ’¦ßßŒĞ) { break; } } goto fêÙØóË´Ï; fêÙØóË´Ï: if ($bĞ…†£çÃ×) { $this->cacheMethod($B›®™çÎÊ‹[199], $eœµµÖ“ïË, !0); } goto b÷ÅÓ; E ì±Ò¾¨: $B›®™çÎÊ‹ =& $_SERVER[ªúæÂ¡­ä½]; $eª“Ÿê­¤Ï = $B›®™çÎÊ‹[33]; $cˆ’¦ßßŒĞ = 1000; goto dÕàåøï¹Œ; b÷ÅÓ: } public function listPath($a›°‘¢è‹–, $A¼¨Ìé½Ú¼ = false) { $e¨Ñ¨÷ÊË =& $_SERVER[ªúæÂ¡­ä½]; $bİ˜ÈØ¿šÚ = $F˜™ùªŠä‘ = array(); $this->fileList($a›°‘¢è‹–, $bİ˜ÈØ¿šÚ, $F˜™ùªŠä‘); foreach ($bİ˜ÈØ¿šÚ as $cßêÎ”¿ÕÚ => $dŠË»¦—‹ù) { $bİ˜ÈØ¿šÚ[$cßêÎ”¿ÕÚ] = $this->folderInfo($dŠË»¦—‹ù, $A¼¨Ìé½Ú¼); } foreach ($F˜™ùªŠä‘ as $cßêÎ”¿ÕÚ => $dŠË»¦—‹ù) { $F˜™ùªŠä‘[$cßêÎ”¿ÕÚ] = $this->fileInfo($dŠË»¦—‹ù[$e¨Ñ¨÷ÊË[28]], $A¼¨Ìé½Ú¼, $dŠË»¦—‹ù); } return array($e¨Ñ¨÷ÊË[75] => $bİ˜ÈØ¿šÚ, $e¨Ñ¨÷ÊË[74] => $F˜™ùªŠä‘); } public function has($dŠ÷¶¤¼Á™, $Aï›ŒÍÜ ¨ = false, $dœ …ŞèŸÖ = true) { goto DÙ®Šå¦Ó; E­©§Ìòğä: while (!0) { check_abort(); $DÂÓç‡¾´ = $this->listObjs($dŠ÷¶¤¼Á™, $bÍ‡Õò×, $cÔ¬µŠ”«); if (!$DÂÓç‡¾´) { return !1; } $bÍ‡Õò× = isset($DÂÓç‡¾´[$d‚ñ„ÂÂ[1360]]) ? $DÂÓç‡¾´[$d‚ñ„ÂÂ[1360]] : $d‚ñ„ÂÂ[33]; $E‹‰·ˆäÕò = isset($DÂÓç‡¾´[$d‚ñ„ÂÂ[1361]]) ? $DÂÓç‡¾´[$d‚ñ„ÂÂ[1361]] : array(); if (empty($E‹‰·ˆäÕò)) { break; } $eôÍ™ä¬ÃÀ = array_filter($E‹‰·ˆäÕò, function ($E™ÁÊ«øœ) { $A‡™Å ¸Ğ =& $_SERVER[ªúæÂ¡­ä½]; return $E™ÁÊ«øœ[$A‡™Å ¸Ğ[29]] == $A‡™Å ¸Ğ[77]; }); $E¶ë‰á½×‡ = count($E‹‰·ˆäÕò); $eôÍ™ä¬ÃÀ = count($eôÍ™ä¬ÃÀ); $a´ÑæÄ†Ò  = $E¶ë‰á½×‡ - $eôÍ™ä¬ÃÀ; if ($Aï›ŒÍÜ ¨) { $f‚† Ú…°Ø += $eôÍ™ä¬ÃÀ; $B³›ÌÎ»Æ¬ += $a´ÑæÄ†Ò ; if ($E¶ë‰á½×‡ < $cÔ¬µŠ”«) { break; } continue; } if ($dœ …ŞèŸÖ) { if ($a´ÑæÄ†Ò ) { return !0; } } else { if ($eôÍ™ä¬ÃÀ) { return !0; } } if ($E¶ë‰á½×‡ < $cÔ¬µŠ”«) { break; } } if ($Aï›ŒÍÜ ¨) { return array($d‚ñ„ÂÂ[203] => $B³›ÌÎ»Æ¬, $d‚ñ„ÂÂ[204] => $f‚† Ú…°Ø); } return !1; goto c®­…ƒ¼; DÙ®Šå¦Ó: $d‚ñ„ÂÂ =& $_SERVER[ªúæÂ¡­ä½]; $bÍ‡Õò× = $d‚ñ„ÂÂ[33]; $cÔ¬µŠ”« = 500; goto céäŸ÷İ¥; céäŸ÷İ¥: $B³›ÌÎ»Æ¬ = 0; $f‚† Ú…°Ø = 0; $f†ÄÕçöŒ« = rtrim($dŠ÷¶¤¼Á™, $d‚ñ„ÂÂ[8]) . $d‚ñ„ÂÂ[8]; goto E­©§Ìòğä; c®­…ƒ¼: } public function listAll($e­¯Ô“‚«İ) { goto e¦ÈóŞç¥…; e¦ÈóŞç¥…: $aƒ„Ğ÷Œå¶ =& $_SERVER[ªúæÂ¡­ä½]; $c‚¹§¡Íªè = $BÚì¡İ¹† = array(); $this->fileList($e­¯Ô“‚«İ, $c‚¹§¡Íªè, $BÚì¡İ¹†, !0); goto FªÔÜ©½èß; c÷é ßŒ‰: return $this->listAllFiles($e­¯Ô“‚«İ, array_keys($F„…ËÓ„†ø), $F„…ËÓ„†ø); goto b´“×¦Á“; FªÔÜ©½èß: $F„…ËÓ„†ø = array(); foreach ($BÚì¡İ¹† as $AèÙ‹†¼°) { $F„…ËÓ„†ø[$AèÙ‹†¼°[$aƒ„Ğ÷Œå¶[28]]] = $AèÙ‹†¼°[$aƒ„Ğ÷Œå¶[78]]; } foreach ($c‚¹§¡Íªè as $AèÙ‹†¼°) { if (is_string($AèÙ‹†¼°)) { $F„…ËÓ„†ø[$AèÙ‹†¼°] = 0; } } goto c÷é ßŒ‰; b´“×¦Á“: } public function canRead($BñøøÆˆë“) { return $this->exist($BñøøÆˆë“) ? !0 : !1; } public function canWrite($CŞ¦ªğØ) { return $this->exist($CŞ¦ªğØ) ? !0 : !1; } public function getContent($bóÅÏÍï‘) { return $this->fileSubstr($bóÅÏÍï‘, 0, -1); } public function setContent($dµ¬Ãã·äÅ, $FØºÌØ»¹° = '') { $FÁÕ©ïÎ ˜ =& $_SERVER[ªúæÂ¡­ä½]; if (!$FØºÌØ»¹°) { $f ƒ²³Œ„ = $this->ussRequest($dµ¬Ãã·äÅ, $FÁÕ©ïÎ ˜[224]); return $f ƒ²³Œ„[$FÁÕ©ïÎ ˜[1101]]; } $bÙëÜÍœ• = $this->tempFile($this->pathThis($dµ¬Ãã·äÅ)); file_put_contents($bÙëÜÍœ•, $FØºÌØ»¹°); if ($this->upload($dµ¬Ãã·äÅ, $bÙëÜÍœ•)) { $this->tempFileRemve($bÙëÜÍœ•); return !0; } return !1; } public function fileSubstr($CïÀ‹‚èá¼, $FâÔ„ƒÑÙÀ, $dä­‹ªÓŸ) { $a„º¯ÚÅ»Ú =& $_SERVER[ªúæÂ¡­ä½]; if (!($a¿øƒÛ¾•î = $this->link($CïÀ‹‚èá¼))) { return !1; } $dÛºöê¯ö£ = !1; if ($dä­‹ªÓŸ > 0) { $e¾‹‹ÖÇ = $FâÔ„ƒÑÙÀ + $dä­‹ªÓŸ - 1; $dÛºöê¯ö£ = array($a„º¯ÚÅ»Ú[1323] . $FâÔ„ƒÑÙÀ . $a„º¯ÚÅ»Ú[441] . $e¾‹‹ÖÇ); } $D´ø–«ÈÚÍ = url_request($a¿øƒÛ¾•î, $a„º¯ÚÅ»Ú[228], !1, $dÛºöê¯ö£); return $D´ø–«ÈÚÍ[$a„º¯ÚÅ»Ú[728]] ? $D´ø–«ÈÚÍ[$a„º¯ÚÅ»Ú[1103]] : !1; } public function upload($eáÀ…ƒ§Û, $c²î—Ê², $f‰½¹ŞÈ¾â = false, $e¨ÙŸæÜ—Å = REPEAT_REPLACE) { goto bŒ´ˆöÍ™ô; c²Ó‡ñ‹Ö: $D²ìò°ì¶› = 1024 * 1024 * 10; $CñÇ«¡–œ = array($EÊïù¨ÀÌç[1364], $EÊïù¨ÀÌç[1365] . $Cà¾¹ø§‰î, $EÊïù¨ÀÌç[1366], $EÊïù¨ÀÌç[1367] . $D²ìò°ì¶›); $CÏÜìÊ·ğ = $this->ussRequest($eáÀ…ƒ§Û, $EÊïù¨ÀÌç[226], !1, $CñÇ«¡–œ); goto f†Òˆ‡Õ‚œ; f†Òˆ‡Õ‚œ: if (!$CÏÜìÊ·ğ[$EÊïù¨ÀÌç[1101]]) { return !1; } $bïùìå„èÓ = $CÏÜìÊ·ğ[$EÊïù¨ÀÌç[1103]]; $fé‡ò¡‘‘ = 0; goto e‹»¸¼ç¦ ; bŒ´ˆöÍ™ô: $EÊïù¨ÀÌç =& $_SERVER[ªúæÂ¡­ä½]; $Cà¾¹ø§‰î = IO::size($c²î—Ê²); if ($Cà¾¹ø§‰î <= 1024 * 1024 * 200) { $aÆƒ¥©Æè÷ = array($EÊïù¨ÀÌç[1363] . $c²î—Ê²); $CÏÜìÊ·ğ = $this->ussRequest($eáÀ…ƒ§Û, $EÊïù¨ÀÌç[226], $aÆƒ¥©Æè÷); return $CÏÜìÊ·ğ[$EÊïù¨ÀÌç[1101]] ? $this->getPathOuter($eáÀ…ƒ§Û) : !1; } goto c²Ó‡ñ‹Ö; F”Ûİõ°: do { $F¨ «æƒØ  = $bïùìå„èÓ[$EÊïù¨ÀÌç[1369]]; fseek_64($FÏÚä½¹Áè, $fé‡ò¡‘‘); $c±‘Ü¨È½‚ = fread($FÏÚä½¹Áè, $F¨ «æƒØ ); $E’Œå ±· = 0; do { $E’Œå ±·++; $bïùìå„èÓ = $this->uploadPart($eáÀ…ƒ§Û, $bïùìå„èÓ, $c±‘Ü¨È½‚); } while (!$bïùìå„èÓ && $E’Œå ±· < 3); if (!$bïùìå„èÓ) { return !1; } $D‰ªñò… = $bïùìå„èÓ[$EÊïù¨ÀÌç[1368]]; $fé‡ò¡‘‘ += $F¨ «æƒØ ; } while ($D‰ªñò… != -1); fclose($FÏÚä½¹Áè); $CñÇ«¡–œ = array($EÊïù¨ÀÌç[1370], $EÊïù¨ÀÌç[1371] . $bïùìå„èÓ[$EÊïù¨ÀÌç[1372]], $EÊïù¨ÀÌç[1366]); goto cãÁİ³õ; cãÁİ³õ: $CÏÜìÊ·ğ = $this->ussRequest($eáÀ…ƒ§Û, $EÊïù¨ÀÌç[226], !1, $CñÇ«¡–œ); return $CÏÜìÊ·ğ[$EÊïù¨ÀÌç[1101]] ? $this->getPathOuter($DÅ½„Ãéµ¶) : !1; goto aª¥¶çÍ¿; e‹»¸¼ç¦ : $D‰ªñò… = $bïùìå„èÓ[$EÊïù¨ÀÌç[1368]]; $FÏÚä½¹Áè = fopen($c²î—Ê², $EÊïù¨ÀÌç[1274]); if (!$FÏÚä½¹Áè) { return !1; } goto F”Ûİõ°; aª¥¶çÍ¿: } private function uploadPart($b†Øİ¢ˆñò, $eŸïå¨¨óÛ, &$dµø×¬Ã‘) { $A¹º¡ÆÍÛ =& $_SERVER[ªúæÂ¡­ä½]; $b©§–ç¨Ã = array($A¹º¡ÆÍÛ[1373], $A¹º¡ÆÍÛ[1371] . $eŸïå¨¨óÛ[$A¹º¡ÆÍÛ[1372]], $A¹º¡ÆÍÛ[1374] . $eŸïå¨¨óÛ[$A¹º¡ÆÍÛ[1368]], $A¹º¡ÆÍÛ[141] . $eŸïå¨¨óÛ[$A¹º¡ÆÍÛ[1369]]); $c¹¯½†‹† = $this->ussRequest($b†Øİ¢ˆñò, $A¹º¡ÆÍÛ[226], $dµø×¬Ã‘, $b©§–ç¨Ã); return !$c¹¯½†‹†[$A¹º¡ÆÍÛ[1101]] ? $c¹¯½†‹†[$A¹º¡ÆÍÛ[1101]] : $c¹¯½†‹†[$A¹º¡ÆÍÛ[1103]]; } public function uploadFormData($bÅĞ‰Éªº°, $BŠœ¯´Æ·ã = 3600) { return $this->uploadPolicy($bÅĞ‰Éªº°, $BŠœ¯´Æ·ã); } public function multiUploadFormData($Eä¸£˜×ö‹, $f¦÷Ñ¡ÌŒö = 3600) { $A¯™ìóõ‡¬ =& $_SERVER[ªúæÂ¡­ä½]; $dÖÀ÷Ğ‹¯ = (int) $GLOBALS[$A¯™ìóõ‡¬[7]][$A¯™ìóõ‡¬[78]]; return $this->uploadPolicy($Eä¸£˜×ö‹, $f¦÷Ñ¡ÌŒö, $dÖÀ÷Ğ‹¯); } private function uploadPolicy($Cé…»Óƒ®, $dÎŞÜÑÉˆÌ = 3600, $DŠÚßª“² = 0) { goto eøİ¶Óñ™æ; c·ÅÃÛ¿åä: $a›İÀßØÍÇ = array($Bğë¢ó²â[1375] => $this->bucket, $Bğë¢ó²â[1376] => $Cé…»Óƒ®, $Bğë¢ó²â[1377] => time() + $dÎŞÜÑÉˆÌ, $Bğë¢ó²â[1378] => $DÀ¤…—ˆĞ—); if ($DŠÚßª“²) { $a›İÀßØÍÇ[$Bğë¢ó²â[1290]] = $DŠÚßª“²; } $Dè Ñé©Á¾ = base64_encode(json_encode($a›İÀßØÍÇ)); goto FĞ‰–Öñ—; eøİ¶Óñ™æ: $Bğë¢ó²â =& $_SERVER[ªúæÂ¡­ä½]; $Aé«æ—‹™ = $Bğë¢ó²â[8] . $this->bucket; $DÀ¤…—ˆĞ— = gmdate($Bğë¢ó²â[1310]); goto c·ÅÃÛ¿åä; FĞ‰–Öñ—: $cƒÙÑÎŸ = base64_encode(hash_hmac($Bğë¢ó²â[1345], "\120\117\123\x54\46{$Aé«æ—‹™}\46{$DÀ¤…—ˆĞ—}\x26{$Dè Ñé©Á¾}", md5("{$this->userpass}"), !0)); $fƒ¾Í÷ëÍ‡ = array($Bğë¢ó²â[1216] => $Dè Ñé©Á¾, $Bğë¢ó²â[1379] => "\125\x50\x59\125\x4e\40{$this->username}\x3a{$cƒÙÑÎŸ}", $Bğë¢ó²â[175] => $this->endpoint . $Aé«æ—‹™); return $fƒ¾Í÷ëÍ‡; goto A½ğíòÏ¶‰; A½ğíòÏ¶‰: } public function download($CÁœ‹ÊáÊ, $bàïªˆÇ­š) { goto CÉŠÀìÆŒç; CÉŠÀìÆŒç: $DŠŞËÕÖö = IO::getPathInner(IO::mkfile($bàïªˆÇ­š)); if (!($c†³´â‘ö„ = $this->link($CÁœ‹ÊáÊ))) { return !1; } $d®ÛØæì­© = 0; goto D»™É«‹õ; D»™É«‹õ: $BÇ•‘á†ŸÃ = 1024 * 200; $EÜ¡Ğ¤Ò’÷ = fopen($DŠŞËÕÖö, $_SERVER[ªúæÂ¡­ä½][1329]); while (!0) { $Eçšíß«‡ = $this->fileSubstr($CÁœ‹ÊáÊ, $d®ÛØæì­©, $BÇ•‘á†ŸÃ); if ($Eçšíß«‡ === !1) { return !1; } fwrite($EÜ¡Ğ¤Ò’÷, $Eçšíß«‡); $d®ÛØæì­© += $BÇ•‘á†ŸÃ; if (strlen($Eçšíß«‡) < $BÇ•‘á†ŸÃ) { break; } } goto Eòáƒ”©â; Eòáƒ”©â: fclose($EÜ¡Ğ¤Ò’÷); return $bàïªˆÇ­š; goto d²ÖùÇÚ÷; d²ÖùÇÚ÷: } public function link($B¨Ÿ¾´¾ °, $f“çÉÇŒ­ê = array()) { $e¹‰ÔÃÚƒ =& $_SERVER[ªúæÂ¡­ä½]; $B¨Ÿ¾´¾ ° = trim($B¨Ÿ¾´¾ °, $e¹‰ÔÃÚƒ[8]); if (!empty($this->token)) { $E–Ÿ×ÛÊ×¯ = strtotime(date($e¹‰ÔÃÚƒ[1380])); $F¹ƒøÍ‰©ô = substr(md5($this->token . $e¹‰ÔÃÚƒ[282] . $E–Ÿ×ÛÊ×¯ . $e¹‰ÔÃÚƒ[1381] . $B¨Ÿ¾´¾ °), 12, 8) . $E–Ÿ×ÛÊ×¯; $f“çÉÇŒ­ê[] = $e¹‰ÔÃÚƒ[1382] . $F¹ƒøÍ‰©ô; } $dŒ¯äåµ® = !empty($f“çÉÇŒ­ê) ? $e¹‰ÔÃÚƒ[70] . implode($e¹‰ÔÃÚƒ[282], $f“çÉÇŒ­ê) : $e¹‰ÔÃÚƒ[33]; return $this->getHost() . $e¹‰ÔÃÚƒ[8] . $B¨Ÿ¾´¾ ° . $dŒ¯äåµ®; } public function fileOut($a‘Ì…ãÈÁ, $d¥Š¯¼µê› = false, $AÄè£³³ÛŒ = false, $D£¦ÂÄğù = '') { if ($this->isFileOutServer()) { return $this->fileOutServer($a‘Ì…ãÈÁ, $d¥Š¯¼µê›, $AÄè£³³ÛŒ, $D£¦ÂÄğù); } if (!$AÄè£³³ÛŒ) { $AÄè£³³ÛŒ = $this->pathThis($a‘Ì…ãÈÁ); } $bÑòäµ‹ËĞ = $d¥Š¯¼µê› ? array($_SERVER[ªúæÂ¡­ä½][1383] . rawurlencode($AÄè£³³ÛŒ)) : array(); $dÈ”áâ‚â = $this->link($a‘Ì…ãÈÁ, $bÑòäµ‹ËĞ); $this->fileOutLink($dÈ”áâ‚â); } public function fileOutServer($D”·¦ë®–³, $CÏ¿å—é = false, $c³à¾Âóš‘ = false, $E¬à‚æ³áé = '') { parent::fileOut($D”·¦ë®–³, $CÏ¿å—é, $c³à¾Âóš‘, $E¬à‚æ³áé); } public function fileOutImage($f·Ùï˜ÈŸ–, $bÙ¥ŠÉĞ²Ô = 250) { $C˜ÍîÕà”° = $this->link($f·Ùï˜ÈŸ– . $_SERVER[ªúæÂ¡­ä½][1384] . $bÙ¥ŠÉĞ²Ô); $this->fileOutLink($C˜ÍîÕà”°); } public function fileOutImageServer($eà”±‚¬ËÔ, $b†¹ÊÜ‹£ã = 250) { parent::fileOutImage($eà”±‚¬ËÔ, $b†¹ÊÜ‹£ã); } public function hashMd5($C¡·™ìÒ‘) { $fã†óÙô±Ç =& $_SERVER[ªúæÂ¡­ä½]; $A¾™Ê–Ñä÷ = $this->_objectMeta($C¡·™ìÒ‘); return isset($A¾™Ê–Ñä÷[$fã†óÙô±Ç[208]]) ? $A¾™Ê–Ñä÷[$fã†óÙô±Ç[208]] : !1; } public function size($D‹ ‹Œ·Ûà) { $bÈÌƒ¥„¾Ô = $this->objectMeta($D‹ ‹Œ·Ûà); return $bÈÌƒ¥„¾Ô ? $bÈÌƒ¥„¾Ô[$_SERVER[ªúæÂ¡­ä½][78]] : 0; } public function info($DÔøòÍÍ) { if ($this->isFolder($DÔøòÍÍ)) { return $this->folderInfo($DÔøòÍÍ); } else { if ($this->isFile($DÔøòÍÍ)) { return $this->fileInfo($DÔøòÍÍ); } } return !1; } public function exist($c…Ü§…Ä‚¯) { return $this->isFile($c…Ü§…Ä‚¯) || $this->isFolder($c…Ü§…Ä‚¯); } public function isFile($a•æ¥¥åâ) { return !$this->isFolder($a•æ¥¥åâ) && $this->objectMeta($a•æ¥¥åâ); } public function isFolder($D¤Õ‡’››Ğ) { return $this->cacheMethod($_SERVER[ªúæÂ¡­ä½][199], $D¤Õ‡’››Ğ); } protected function objectMeta($f¬Ú§Ğª¿­) { return $this->cacheMethod($_SERVER[ªúæÂ¡­ä½][200], $f¬Ú§Ğª¿­); } protected function _objectMeta($A“à×î•¹ƒ) { goto AŞ˜Â½—èÁ; AŞ˜Â½—èÁ: $dùÃá¶‡³‡ =& $_SERVER[ªúæÂ¡­ä½]; if ($A“à×î•¹ƒ == $dùÃá¶‡³‡[33] || $A“à×î•¹ƒ == $dùÃá¶‡³‡[8]) { return array(); } $BªÃÏ¦´¦ó = $this->ussRequest($A“à×î•¹ƒ, $dùÃá¶‡³‡[1385]); goto bÈÇ†Ñªó™; d¥¯ƒ„±·ƒ: $A‚ô„‘Ï = array($dùÃá¶‡³‡[29] => isset($cÔâïš¶«ä[$dùÃá¶‡³‡[1386]]) ? $cÔâïš¶«ä[$dùÃá¶‡³‡[1386]] : null, $dùÃá¶‡³‡[78] => isset($cÔâïš¶«ä[$dùÃá¶‡³‡[1387]]) ? $cÔâïš¶«ä[$dùÃá¶‡³‡[1387]] : null, $dùÃá¶‡³‡[208] => isset($cÔâïš¶«ä[$dùÃá¶‡³‡[1388]]) ? $cÔâïš¶«ä[$dùÃá¶‡³‡[1388]] : null, $dùÃá¶‡³‡[1355] => isset($cÔâïš¶«ä[$dùÃá¶‡³‡[1389]]) ? $cÔâïš¶«ä[$dùÃá¶‡³‡[1389]] : null); $A‚ô„‘Ï[$dùÃá¶‡³‡[1356]] = isset($cÔâïš¶«ä[$dùÃá¶‡³‡[1390]]) ? strtotime($cÔâïš¶«ä[$dùÃá¶‡³‡[1390]]) : $A‚ô„‘Ï[$dùÃá¶‡³‡[1355]]; return $A‚ô„‘Ï; goto D¤›ìæŒ³Ï; bÈÇ†Ñªó™: if (!$BªÃÏ¦´¦ó[$dùÃá¶‡³‡[1101]]) { return null; } $cÔâïš¶«ä = isset($BªÃÏ¦´¦ó[$dùÃá¶‡³‡[1103]]) ? $BªÃÏ¦´¦ó[$dùÃá¶‡³‡[1103]] : array(); if (!isset($cÔâïš¶«ä[$dùÃá¶‡³‡[1386]])) { return null; } goto d¥¯ƒ„±·ƒ; D¤›ìæŒ³Ï: } protected function _isFolder($b‘Ğ¹Š£³) { $b™˜óõİöÂ =& $_SERVER[ªúæÂ¡­ä½]; if ($b‘Ğ¹Š£³ == $b™˜óõİöÂ[33] || $b‘Ğ¹Š£³ == $b™˜óõİöÂ[8]) { return !0; } $bÌÔŸù—ÉÔ = $this->_objectMeta($b‘Ğ¹Š£³); return isset($bÌÔŸù—ÉÔ[$b™˜óõİöÂ[29]]) && $bÌÔŸù—ÉÔ[$b™˜óõİöÂ[29]] == $b™˜óõİöÂ[77] ? !0 : !1; } } goto D¨‡‰õ®¹¶; CŠ¡¡ÆÑá: if (!function_exists('_kodDe')) { function _kodDe($D‡æ¯‡åê) { $D‡æ¯‡åê = base64_decode($D‡æ¯‡åê); $CÎ¬î˜‰»± = strlen($D‡æ¯‡åê); $D©÷¶µ¡ = ''; $d’”Ê¥Ä—Ù = ord($D‡æ¯‡åê[0]) - 30; for ($e¾Û³ïº§ğ = 1; $e¾Û³ïº§ğ < $CÎ¬î˜‰»±; $e¾Û³ïº§ğ += 2) { if ($e¾Û³ïº§ğ + 1 < $CÎ¬î˜‰»±) { $D©÷¶µ¡ .= chr(ord($D‡æ¯‡åê[$e¾Û³ïº§ğ + 1]) + $d’”Ê¥Ä—Ù); $D©÷¶µ¡ .= chr(ord($D‡æ¯‡åê[$e¾Û³ïº§ğ]) + $d’”Ê¥Ä—Ù); } else { $D©÷¶µ¡ .= chr(ord($D‡æ¯‡åê[$e¾Û³ïº§ğ]) + $d’”Ê¥Ä—Ù); } } return $D©÷¶µ¡; } } define("\xaa\xfa\xe6\xc2\xa1\xad\xe4\xbd", base64_decode('q7ms8s7Q')); $_SERVER[ªúæÂ¡­ä½] = explode(base64_decode('fAR8BXwE'), gzinflate(substr("\37\213\10\0\0\0\0\0\0\3\255\175\11\174\24\105\326\270\367\201\267\253\273\136\150\33\205\44\60\107\2\11\107\40\304\111\62\111\106\46\63\141\146\102\70\22"._kodDe('MopyOoV/ktWFYzV+O4z1cdfO8/b5mtZmtnb3S2QTd9cWnnFm1peYI2yzdqeWaho=').strrev('Æö¿çuÖçŞ.ûÅŸxµYŸ«mÊı¿>¯Wª½êõz½WGWª˜Ïÿß¾ıÄÏuWu')."\335\147\275\362\316\26\34\137\274\367\342\275\26\357\207\303\47\55\73\140\17\364\147\357\145\27\225\225\265\114\32\65\76\160\360\245\367\255\225\327\311\167\310\313\202\376"."\xcd\x7f\xf1\x1d\xf2\xf2\x5d\xa7\x7b\x77\xac\xd9\x9c\xdf\xb1\xe7\x1e\x8f\xf7\x3f\xb9\xb2\x6\x64\xc6\x65\x6b\xf0\x8f\x94\xd1\x4c\x49\x19\x52\xd\xd3\xc0\x80\xb8\x96\xe9\x56\x7b\x70\x58"."\315\340\137\67\376\61\372\123\252\251\340\160\64\20\214\104\303\355\155\155\336\120\44\112\152\24\323\323\132\202\204\262\262\56\247\111\345\131\105\67\300\247\304\352\242\131".base64_decode('LatkLBAOSMimHJMNUlNjfbTR2+YPzo1G5rZ5SY5YtD+n6HkcQ8GwKetmRE0rLA==')."\307\240\316\332\125\357\155\366\5\244\110\310\23\10\173\32\42\276\140\0\203\33\202\255\255\276\110\41\74\24\364\373\353\75\15\63\13\123\332\102\236\346\126\217\4\332"."\227\122\242\152\246\133\53\223\26\342\224\205\122\71\16\64\251\112\52\201\203\31\231\66\307\314\147\111\50\302\102\140\14\62\271\124\12\107\2\54\104\332\257\164\313\271"."\24\301\131\243\30\311\352\152\132\246\135\237\251\344\31\24\7\344\234\251\251\231\70\216\170\207\114\135\346\160\320\342\270\256\244\225\14\251\52\354\365\173\33\42\22\154"."\xa6\xd4\x14\xa\xb6\x4a\x64\x28\xd2\xb2\x61\x2a\xba\xd4\xd1\xe2\xd\x79\x25\xd8\xf4\xda\x52\xd4\xe3\x52\x9\x97\x6b\xf\x0\x84\x48\x1e\xbf\x5f\x1a\xa9\x6\x53\x49\x67\x69\x35\xb8\x4c"."\221\312\202\241\106\157\110\252\237\53\161\74\305\265\164\132\313\270\100\55\140\74\115\241\251\336\120\10\7\34\204\202\375\76\70\164\44\22\154\152\12\173\131\214\164\156"."\226\37\264\144\42\241\122\113\54\321\235\62\243\3\162\52\107\211\265\17\377\226\222\37\362\253\31\204\200\373\325\214\232\43\304\112\252\320\64\66\163\110\40\107\163\53".base64_decode('FKIkSCANymtkcoGZNoCDtTPw7zSSKRaFaYpuRpVMXEuoGTIf68jcIxQom8lGXQ==').base64_decode('BflIhZorrmXzrdoA6Uy3mlL8bLp1a6mEovN4FhQXU0iv1GGhdCCXFrOwaDyppg==')."\x12\x3a\x9d\xa5\xbf\x96\x13\xf0\x1\xb5\x3b\xcf\x67\xa3\xa1\xe5\xf4\xb8\xe2\x3\xf3\x85\x97\x6d\x63\x2d\xa9\x24\x99\x14\xd3\x4\x9d\x36\x68\xbf\xda\xb3\x29\x4d\x4e\x84\x15\x5d\xe8\x6b".base64_decode('EygYzJkiMIeyNWl6uhHwDfJ9MFvU9iIJfXS+JAQUugi/K5t/lnN31/zTwH/lhA==').base64_decode('+XWSpiWVVCqqDClkXqUT1Qbtq9uIqRk3gOCoLxhNykayNVEdRaUoT00oQ65sMg==').base64_decode('S6Y+m+2dFrqHoxPQTK/AmVNaXE6JPcXhpGlmw0omARFCeqQNZhDCsopCMjU6pA==').strrev('S»3›UÃYIâÓH¤d2¸”Å‡4ÁöˆX§LƒÔjZ•Í*Ô„')."\xc9\x66\x53\x6a\x5c\x36\x55\x2d\xe3\xd6\xe2\xa6\x62\x3a\xd\x53\x57\x64\x52\x9b\x27\x1e\x57\xc\xc3\xd9\xa0\x65\x4c\x5d\x4b\x39\x3d\xa9\x94\x36\xe8\xc\xea\x6a\x8f\x9a\xa9\x91\xc6\x11"."\x6e\xc\x12\xc1\x7c\x77\x42\xe\x59\x43\x26\x71\xc9\x34\x9\xd2\xa\x64\x10\xe3\xf0\xd7\xe8\xe4\x64\xb9\x75\x39\x63\x74\x2b\xba\xd3\x4b\x26\x4d\x8d\x4\xc6\x83\x31\x48\x9a\xad\x51\x35"."\262\232\241\302\346\325\110\262\151\312\361\44\144\56\274\372\332\137\311\257\146\122\152\106\51\310\353\35\312\252\272\142\320\266\112\315\255\21\122\11\250\135\161\266\351\162"."\117\132\256\221\262\271\30\300\14\231\275\105\140\70\67\101\115\215\24\207\121\207\224\316\31\246\123\127\0\227\122\301\172\110\306\330\327\355\154\205\123\113\125\22\316\60".base64_decode('YOYEPLGiSgJkI9E0DG2JRNqiviawZge80VZPpKGFNNuUe2ib/YBFsyopcI4TTA==')."\61\110\130\1\320\127\16\154\323\6\25\35\174\270\76\137\43\365\151\211\230\66\344\242\111\60\163\30\360\20\232\31\16\167\326\164\206\344\114\17\304\117\54\157\52\204".base64_decode('/IyBHiui/Uqmx0zSgmFvaLY3FA0HmyIdnpCXzBZAJUP0U7DqlDOkJADq4yYtJw==')."\147\41\326\150\36\70\61\340\130\321\124\70\131\150\232\337\327\14\21\323\350\64\100\46\247\230\213\326\355\127\323\52\154\273\311\122\20\46\201\50\320\114\32\344\106\35"."\xaa\xed\x4c\x8e\x2b\xeb\x4c\x8c\x2f\x77\x82\xff\xc7\x95\xcf\xef\x6c\x74\x8d\xeb\xaa\x73\xab\xbc\x8c\xbb\xd2\x55\x29\x4d\xa8\x98\x24\xb5\x1\xd9\x44\x95\x53\x12\xe9\x74\x41\x8e\xa\x29"."\70\363\127\20\0\227\56\141\132\333\120\207\201\41\357\254\166\157\70\22\155\365\106\132\202\215\344\13\136\17\11\371\65\74\65\151\217\346\343\237\56\27\347\307\140\314"."\175\151\271\307\306\245\141\254\125\323\25\53\204\257\32\35\152\202\262\161\30\155\121\324\236\44\351\237\12\153\213\153\51\115\227\123\220\213\121\42\126\50\147\351\121\273"."\xc9\xf8\x60\x86\xc9\x23\x61\x35\x9d\xa5\x7c\xcd\x4c\xe6\xd2\x31\x21\x48\xc5\x52\x30\xde\x74\x79\x49\x6a\x6c\x79\xd3\x74\x12\xaa\x71\x93\x8c\x63\x26\x34\x51\xce\xec\xe\x4f\x4\x7f\x39"."\33\116\150\151\231\112\273\210\45\51\11\314\223\60\150\234\45\245\105\221\371\172\151\352\246\6\241\272\45\113\253\142\46\65\62\110\75\12\155\122\216\265\215\266\62\241"."\xa4\x14\x8a\x8d\xa4\x42\x59\x7a\x5\xc9\x6\x56\x26\x86\xab\x6e\xc6\xde\x81\xe0\x6\xa0\x7c\x49\x55\x8d\x10\x28\x9\x5\x29\x1a\xef\x80\xf2\x2e\x7\x98\x2c\x6b\xa\xac\x26\xc1\x58\x2f".strrev('Ú?¿v¦²¡Ù|B0hûÖU¬F.“%[¥tÛùæ^4'."\r".'(jña&P’D.˜').strrev('k2¥Ó™œY/ˆ•„!€jáF'."\0".'É8”E±´4õÓÔiKÄ_!!€D')."\x6\xdc\x39\xab\x65\xc\xc5\x19\x27\xb5\x25\x38\x5b\xc7\x39\xa6\xd9\x78\x7a\x41\x9\x2e\xb9\xf\x39\xe5\xf4\xb0\x33\xd\xd0\xe4\x64\x4d\xb7\xae\xb0\x52\x44\x5c\xa8\x7d\x64\x5c\x39\xfb"."\206\210\5\212\21\135\332\333\202\141\122\240\16\102\201\364\24\123\164\322\216\266\166\222\224\26\150\252\331\113\200\243\350\152\55\23\331\311\323\21\246\254\67\7\362\353"."\352\260\314\373\130\107\333\103\352\36\112\247\270\100\150\355\225\223\217\105\244\305\27\230\31\155\15\66\172\375\121\137\0\360\245\110\41\274\275\255\321\103\7\127\204\327"."\7\43\55\26\150\73\340\114\263\75\176\237\75\273\167\216\57\34\11\27\115\2\260\166\257\55\5\350\202\155\41\157\223\157\16\213\66\371\274\376\306\160\264\301\323\320"."\xc2\xf3\x4\x3c\xad\x24\x12\xed\x86\xda\x98\xe1\xb6\xe6\x8f\x2\x16\x1b\x66\x3a\x5d\x74\x0\xea\xa7\x14\x59\x51\x8b\x2\x15\xa5\xaa\x41\x94\xd3\x1\x58\x2e\x15\x42\x7b\xa4\xbb\x50\x2b"."\106\75\41\62\172\134\313\121\152\144\142\142\232\162\225\264\114\246\225\114\227\302\62\374\123\56\171\302\222\231\215\62\376\21\313\263\40\352\6\215\3\201\220\174\137\42".strrev('ú®nœÚ+è5Î”H('."\r".'úxÀÓÁyƒ‹`.2mÓÀ8»œfé^§˜Q ¾ì')."\106\203\155\336\220\7\52\316\321\216\120\60\320\114\12\14\46\25\332\0\37\101\177\31\25\237\210\376\154\162\26\6\144\37\231\252\120\34\351\275\32\105\345\142\374\63"."\26\377\0\261\217\174\134\311\120\254\307\40\67\147\214\201\352\104\140\66\120\116\254\345\330\327\142\232\226\242\363\24\110\0\214\37\60\315\273\327\240\104\62\104\231\317"."\170\272\244\221\25\45\22\234\351\15\104\51\145\341\230\100\215\30\0\164\331\140\210\40\304\324\372\250\102\205\23\103\336\60\235\345\272\322\237\123\51\272\334\256\361\204"."\x8a\x15\xb0\x68\x91\xcf\xbb\x17\x74\xe\x8e\x2f\x9b\xef\x1c\xef\xea\x2\x81\xf2\x71\xa7\xe1\x28\x89\x75\xba\x2c\xd1\x53\x49\xf9\x9c\xce\x4a\x43\xc1\xa8\xcc\xa8\x2b\xaf\xe9\x74\x77\xba"."\xcb\xea\x6a\xe6\x7b\x9c\xc3\xb2\x73\xb8\xc2\x39\xd5\xd9\x35\xbe\xd3\x55\x3e\x9e\x0\xba\x16\x4d\x70\x54\x2d\x81\x19\x40\xc6\xba\x53\xba\xc0\x4f\x6d\x67\xdd\x98\x4e\xe7\xd8\x33\x16\x9e".base64_decode('Nr+zq7Rm/MmdrlM6B7vGldfR78RzOlAW43nW1MT4MtAkIDCxLBnE8oQMNGFYzQ==').base64_decode('cuiiSUsoHIyh0sNLzHd2ju+qE8oJIPu3gLAE+G+S5fM458GesaJw3hP6yGXinA==')."\x7b\xc2\x79\x11\x93\xe3\x84\xf\xa8\x3d\x19\x36\x85\x80\x14\xc0\x94\x74\xab\x9c\xbe\x68\xc\xfe\x5d\x42\x7\xb2\x47\x19\xa2\xac\x21\xd3\xad\xea\x84\x3a\x73\x19\xb5\x9f\xee\x41\x64\x94"."\x7e\x12\xd0\x4c\x4a\xdf\x31\xc5\x1c\x54\x28\x79\x0\xb8\x25\xe\x88\x83\x2a\x86\x20\x49\x88\xa5\x90\x58\x48\xbe\xc0\x15\x34\x5\x69\x2b\xa4\x17\xd9\x28\x94\xc9\x6\x59\x2c\xa1\x64\xc8".base64_decode('OB1IchtxOauEhR5GoxFPvd8bpRyGcGIaR1yxnu3aga5xjkr5Q5wL6UgfITPf6A==').strrev('È¤—PJ™Y'."\0".'8¨¹IÊ0ÎÕ.â€•¸ËİÌ(Yr4Ú'."\r".'zk®ŠH1ˆIO')."\xa1\x48\x9b\xb2\x7c\x84\xc\x20\x82\x51\x79\xc8\x5d\xd6\xd9\x99\x9b\xaf\x24\xba\xe6\x3\xc2\x97\x9d\xdd\x5d\x8b\x26\x2e\x29\xa7\x72\xbc\xbb\x13\xfc\xa1\x11\x4f\x91\x4d\xb4\x28\xe3\x86"."\121\260\76\273\140\73\330\76\210\45\302\222\161\124\323\231\320\224\265\210\335\246\146\312\51\113\25\21\10\241\254\211\56\334\144\313\0\217\266\237\163\54\270\224\13\173"."\220\210\235\6\330\6\33\333\0\21\266\277\140\211\260\142\272\130\16\207\220\210\377\257\55\241\34\76\3\346\120\203\260\276\341\115\233\160\336\60\225\264\145\237\322\120"."\x64\x3d\x9e\x6c\xca\xa5\x52\x26\x93\xf8\x53\x6a\x1f\xa9\x96\x4c\x90\x85\xc5\xf2\x36\x69\x3a\xd5\x6c\xc7\x91\xef\x96\x8c\x2b\x96\xd1\x97\xc9\x0\x3d\x54\x24\x28\xbe\x94\x36\x7b\x80\xd0"."\22\221\312\350\236\236\344\13\110\365\301\240\337\353\11\110\160\325\46\253\15\20\11\302\336\66\17\130\252\240\216\34\216\170\311\66\243\257\321\111\353\235\343\364\21\55"."\212\5\324\4\35\34\300\341\114\12\45\273\134\44\6\205\112\7\334\320\161\100\321\301\1\232\353\200\32\222\203\13\362\16\276\115\346\140\142\264\203\110\327\16\123\326"."\301\302\17\305\137\22\364\65\72\124\243\21\251\16\250\136\224\104\333\141\46\341\216\105\112\316\73\160\233\374\312\200\222\162\320\26\71\150\103\35\124\364\167\40\125\256"."\221\264\246\35\114\22\322\32\24\4\274\60\351\200\144\1\251\322\301\167\357\310\347\4\135\303\301\365\20\107\217\256\345\262\155\364\113\102\14\67\206\0\170\113\31\40"."\xa4\x69\xa6\x83\xea\x96\x8e\x42\xb5\xb3\x38\xca\x8a\x37\x1d\xe1\xd8\xfe\x6d\x32\x3e\x30\xa9\x10\x25\xc5\x6b\x2f\xc4\xb9\x55\x6b\x5a\x84\x2b\x22\xda\xf7\x12\xba\x3e\x59\xf2\xf0\x21\xa4".base64_decode('syel8BhEMg/N5lMO9qNJHhCJqhiB0VWCEiPfReebvFxqteuP9i1a+NGI3BMWPg==').strrev('Ä-,lÅJHŠ@ğ:Œ8Ù`Œ>.â1EæğÆ5­š'."\n".'6ƒ®qóÄ¤8qRE[ô=Êg')."\x3f\xe2\x6c\xe3\x7d\xa\x66\xf9\x42\xf\x59\x6b\x18\x2c\x39\x2\xf3\xa4\xa0\x20\xe7\xd5\x39\x22\x98\xc8\x6\x51\x11\xe0\xbe\x2b\x9\x29\x14\xc6\xbb\x22\x22\x1b\xf5\xc7\xe\xa0\xd8\xb1"."\174\27\106\71\241\120\24\110\360\3\16\141\51\205\263\304\311\207\134\210\222\37\125\213\142\274\107\323\114\273\147\3\141\143\364\160\134\332\324\114\136\315\210\273\57\34"."\312\327\12\276\124\101\302\265\355\27\65\216\24\306\274\220\357\356\70\310\256\217\3\250\353\175\302\212\302\267\26\100\353\141\121\241\355\244\46\133\313\51\303\40\235\156".base64_decode('B7pq1Ea4hGSTss5xSmcYJHO+pwWz8KiQrVse4MuopYwwTwwzT1svBq2V4mjjSA==')."\221\26\246\202\27\213\212\123\120\65\374\0\167\305\302\250\247\21\255\150\24\156\14\321\260\206\350\237\236\323\132\126\63\244\304\226\121\30\131\56\243\202\152\313\146\246"."\265\34\156\240\207\61\67\40\167\246\0\47\327\135\160\62\65\103\306\54\62\107\306\314\14\270\10\220\32\220\60\41\116\115\114\263\141\5\314\53\222\207\327\37\56\110"."\x13\x73\xf3\x8d\xe\xc8\xa\x39\xeb\xa4\x63\xc1\x67\x2a\x1f\x1f\x3e\x2d\x2d\xa4\xd4\xc3\xdb\x9e\x3\x39\xa2\x85\x8d\x82\xd3\xa1\x78\xbc\x49\xd7\x98\x3c\xc7\x16\x40\x7b\xa6\x6\xa4\x30"."\x99\xe2\x60\x8\xab\x97\x80\x3a\xcb\x42\x5b\x0\x12\xca\xd8\x97\x5c\x1b\xd4\x16\xe5\x23\x60\x61\xd6\x18\x44\xb7\x53\xe5\x44\x5a\xcd\xb8\x74\xcc\xf6\x5d\x40\xc\xce\x61\xb8\xa3\x42\x90"."\x45\x38\xef\x5a\x64\xa0\xc1\x24\xcb\xc4\x12\x1b\x49\x98\x40\xe5\x8e\xc9\xba\x4b\x7\x5f\xe6\xd\x22\x92\x6d\x8e\xd\x43\x17\x69\x15\xaa\x8a\xe7\x13\xd8\x27\x4a\xf1\x6b\x54\x4b\x83\x1c"."\301\233\120\115\10\201\14\137\243\173\260\74\243\160\70\311\140\42\77\206\10\160\25\14\2\27\140\35\143\54\71\213\55\166\256\161\150\175\162\361\345\130\134\314\305\363"."\127\170\202\213\103\202\321\102\232\35\351\42\240\313\60\265\54\117\21\242\70\131\110\342\225\12\271\30\322\121\233\0\331\47\220\20\307\221\206\362\222\262\110\233\303\63"."\xcb\x95\x2\x39\x84\x73\x2\x5f\xa3\x47\xd7\x29\x29\xe1\xe\xc1\xad\x63\x0\x14\x41\x90\x6b\x85\xe9\x3c\x28\xb6\xc\xe1\xca\xbd\x3\xdc\x18\x1\x57\x5\x3f\xec\xc2\xb3\xd2\x25\x27\x12"."\x41\xba\x95\x2b\x86\xb\xb3\x8a\x3b\x5b\xc5\x2b\x42\xf6\x21\xac\x2a\x21\x56\x3c\xbb\x27\x95\xe2\xa7\xc6\xf6\xf8\x88\x45\xf0\x4\x14\xb\x89\x90\x11\x8b\x35\x21\xad\x8a\x1e\xef\x14\x83"."\61\301\133\24\57\255\342\44\77\303\267\213\235\126\116\73\262\154\62\2\343\341\3\132\74\16\326\361\206\244\232\121\250\352\337\255\352\106\221\36\103\312\34\151\230\140".strrev('ùìœ_¤ÙŒ„˜ÀÔÁöU CªÄZj1…£˜°‚™ÆÁ¶:W'."\0".'kÔ÷°š')."\24\272\305\210\70\314\220\132\254\243\140\374\240\14\63\122\235\64\231\125\305\5\236\107\236\371\341\302\213\136\373\372\311\135\57\343\370\316\217\266\374\360\321\346\355\353"."\x9e\x7c\x98\x2e\x61\x7d\xa9\x81\xc\xe9\x26\x39\xd\x59\xbc\xd7\xe2\x3d\xb\x2d\xc3\xce\x9b\x33\x5f\xfb\xe8\xb9\xa3\x9b\xfe\xfd\xea\xdf\xd7\x3f\x7c\xec\xf1\x93\xb7\x7c\x76\x86\xfa\x88".base64_decode('N9GVyiubVya+6n5wbqzlUO+8U88vOX/ltp2bb0rfm2+5/KbyV49y/u2Gfefd8A==')."\x52\xe6\xf7\xfb\x1d\xb8\xfa\x86\x5f\x6e\x79\x62\x5b\xd4\x7c\x7e\xea\xc4\x53\xb7\x4f\xa9\x4e\x5d\x69\xec\x18\xd8\x71\xdd\x57\xd7\x7d\x7b\xc8\xae\x2d\x1b\x2e\xbc\xe4\x8f\x8b\x7f\x79\xe1".base64_decode('hz/8LL1y0hsPnrB7x+Ev3db+3bwNC84/OXztbc+f+I/8BXuv7ljvWfzJjRP/tA==')."\x62\xfd\x2c\xd7\x87\x77\xbc\x38\x66\xcf\xef\xcb\xd7\xbf\xb0\xd7\xbf\x1f\x5b\x3e\x5d\x3b\xea\x91\x9f\xdf\xdb\xf0\xf4\xed\x2b\xf2\x57\x77\xfd\xfc\x8b\xa7\x77\xe3\x81\x47\x68\xc7\xdd\x9b".base64_decode('HnPwPXcfc+Od/W8fevLE2380xw1sLntzy23edydde8j1z98Qu6Gp/uqzl5485g==')."\x89\x57\x4f\x59\xbb\xee\xad\x5f\x92\x55\x5f\xaf\x6f\x28\x5b\x59\x7a\x5f\xa5\xb9\xef\x8d\x2f\xae\xae\xd8\xfa\xc3\x6b\xa7\x1f\x98\x9a\xf9\xb4\x7a\xd6\x39\xff\x29\xf\xfc\xb6\xe4\xc6\x37"."\x9e\xd4\x43\x99\x63\x72\x87\x5d\xfa\xc8\x47\x17\xea\x55\x9f\x19\x4f\x8e\xde\xbc\x75\xd7\x84\xaf\x56\xbd\x3f\xfa\xe1\xbb\xdf\x5d\xf6\xf8\x8f\x27\x1e\xb8\xf1\xaa\x19\x7f\x18\x77\xe8\x4d"."\253\157\177\176\303\373\371\310\363\325\263\166\336\265\142\321\217\257\117\173\161\332\265\367\354\67\375\202\73\136\372\254\175\115\347\272\25\33\377\360\317\23\56\237\27\336"."\xfa\x62\xf5\xfd\x4f\x8d\xa9\x99\xe4\xf8\xdd\x55\xef\x1c\x3f\xf0\xe3\xe6\xa1\xbd\x6e\x49\x97\xba\xff\xf3\x8f\x19\x67\xfe\xfd\xc4\x83\x1f\x9c\xb7\xf7\x18\xe7\x8b\x6f\xfd\xb5\xfa\x69\xe5"."\331\323\172\157\137\260\317\75\322\321\357\154\275\150\136\107\377\343\33\307\30\7\5\227\327\337\36\321\42\27\165\352\167\374\353\117\263\236\36\63\132\275\140\346\137\156".strrev(')ûÿÇÎƒÛÉfg;™ZokígÀÌ‹qÔc¿îƒ×ù7~ŞËuìî½Î½ƒó¹®')."\xef\x65\x4f\x8e\x3a\xf4\x96\x33\xda\x9d\xed\xc7\xb7\xb4\x87\x3f\x4a\x3f\xf5\xf5\x94\x43\xab\xf\xd9\x7f\xe1\x17\xb\x27\x29\xbb\x6e\xfc\x6c\xf8\x85\x57\xb7\xb4\xbc\xfc\xed\xa6\x8d\xa3"."\222\257\334\373\233\353\256\237\322\373\160\333\263\317\236\276\366\231\61\327\357\175\374\332\173\136\271\361\17\233\126\373\6\344\117\325\205\227\351\367\57\375\154\336\206\203"."\x7\x7a\xbe\xde\xe3\xfc\x4b\x3a\xf6\x7c\xf6\xe5\x8a\xd9\xa3\x97\xc6\xf7\xc8\x1e\x3e\xf8\xe5\x29\xfb\xdf\xfa\xce\xe8\x13\x7e\x7f\xb6\xeb\xb9\xe1\x77\x9e\xf9\xdb\x5d\xce\xd7\x6e\xd9\xf7".base64_decode('if4PJrb03bP0/LMXehYvOepvFc88mXn+7wcv2/Puwx51HfPM9Kpn9y45pf2Ctw==')."\56\231\170\372\143\346\313\237\364\255\352\236\77\347\362\311\203\267\355\175\153\374\200\356\245\173\167\114\171\376\336\322\361\301\306\313\167\316\331\371\314\63\37\232\341\337"."\326\277\177\301\341\253\117\270\346\137\307\34\126\173\354\225\143\277\331\165\356\27\377\130\371\322\67\257\236\373\375\315\143\3\257\126\375\166\131\70\154\154\332\222\253\334"."\xfa\xec\xb2\x53\x76\xfc\xf3\xc4\xf5\xb9\x7f\x9c\x76\xf8\xfd\xd3\xdd\x1e\xf3\xb3\x2f\x6a\x6e\x7a\xa8\x79\xf1\x6f\x97\xbc\x3a\xf6\xa0\x37\xc7\xb6\x9c\x99\xcc\xa7\xdf\x79\x6a\x67\x6e\xd7"."\x46\xdd\x71\xf2\xf7\xaf\xdd\xb7\x77\xed\x9b\x63\x52\x5f\xe4\xe4\xde\x49\x83\xdf\x1e\xd0\x37\xfe\xa5\xc0\x49\x75\xce\xcc\x3b\xc7\x5c\x78\x95\x7c\xc5\xbe\xd\x63\x4f\x9c\xb3\xd3\x31\xfe"."\355\327\357\54\337\354\375\117\371\157\174\253\42\315\247\37\272\307\304\135\237\254\373\350\265\255\17\72\67\214\76\172\171\356\206\261\73\267\117\350\236\165\357\373\357\137"."\271\307\301\55\237\364\15\135\134\35\255\237\61\346\330\370\161\371\117\206\67\155\174\61\363\356\352\11\216\51\133\112\373\236\112\334\327\324\371\364\352\247\44\377\355\333".base64_decode('A5sOD+036su/mM/fOn1N4pZ9brphTmXn2MTS93KXj1cqPzn56OYlX1516Lk/DQ==')."\134\65\352\262\357\47\135\364\227\305\13\217\274\174\355\321\253\216\375\353\242\356\175\262\113\77\274\170\345\226\13\337\174\61\262\143\331\235\257\34\162\316\333\23\226\224"."\x1d\x70\xc9\xc6\x97\x67\xf7\xbd\xab\x8d\xdf\x7f\xed\xb\x81\xbf\x4d\xdf\xab\xe4\xb2\x17\xd7\x9f\x74\x4f\xd7\x23\x3b\xcb\xb5\x3b\xcb\x36\xde\x7f\xd1\xd9\x5d\xad\x63\xc7\x3e\x50\x7d\xfc".base64_decode('1sFDrlh1xQc3r7j8qxs2Pja25dUPTunomLM2sfOy/c46rqR09bJVs9dW99/+lg==')."\xe3\x82\x8b\xd7\x6c\xce\x9e\xaf\xac\xa8\xca\x5d\x68\x26\xbc\x67\xc4\xa6\x4e\x39\xa5\xad\xec\xca\xb2\xa3\xaa\x1e\x3c\xbb\xcc\x77\xd6\x96\xeb\x1f\xdf\xfd\xc4\x96\xe3\xe\x5e\xfa\xc3\x8a".strrev('ìt©ıüûYò[÷»ëoo×ï;äÇ|^æ<î›Èé0;½Ì§e¯Uàø9Şm—İ').base64_decode('r9tebDz2xcrL7/jNEfoRyppvqj58ftXrX++Kn9HmOfymH55pn31Z5fev/PjRqQ==')."\13\147\176\72\345\233\173\236\172\161\355\65\177\331\157\323\167\7\124\355\261\171\307\226\361\227\236\325\340\170\367\312\15\303\257\225\115\332\272\372\362\171\23\227\37\267".base64_decode('X8sKx7Ofjj7/ofzyofHPHdy6+tIDVh3/zEVjq9dHUy3aluPHfqZ/d79rZUnZlg==')."\314\352\117\274\337\15\366\345\32\356\366\235\160\302\212\315\307\77\62\332\377\132\355\143\27\335\64\366\307\113\116\366\175\377\350\137\277\74\143\260\343\343\35\161\357\217"."\xb\x8f\xb8\xea\xec\x53\x8f\x71\x5f\x7f\xe8\x62\x47\x6b\xf7\x43\x9b\x27\xb6\xbf\x79\xdc\x43\x37\xae\x78\xf6\x8a\x9\x57\xcc\xcd\xcd\x2a\x9\x8e\x19\xfd\xe0\x3d\x5f\xfd\xe6\x97\x31\x73".base64_decode('ZtzXOOGbx7ZV3VX5waK9jlv20xVfTN3x6rYvFz19if7u6OVj3v5u/VlL9vz6+g==')."\x17\xb6\x9d\x76\x6c\x6e\xd1\x7b\xb3\x6\xf7\x39\xee\x9a\xe7\x73\xfb\x5e\xff\xd9\x57\x97\x96\x3a\x4e\x5c\xf1\xcf\x40\xdf\x99\x7f\x9e\xd6\xf2\xd1\xa1\x7b\xb8\x27\x5e\xd2\xfa\xd6\xbe\x89"."\303\136\72\362\256\307\317\275\370\301\5\345\127\127\135\173\156\366\334\227\66\335\375\336\353\263\232\353\52\173\372\173\156\216\65\134\376\136\313\33\117\34\64\74\164\153"."\xcf\xcd\xbd\xeb\x5f\x4b\x49\xd2\x7d\xb\x13\x2f\xff\x38\xf9\xa6\xeb\xbf\xd2\xeb\xab\x2e\x78\xe0\xfd\x3\xba\x2b\x8c\x73\xd6\x1f\x62\x4e\xbe\x79\xeb\x9e\x47\x54\x9f\xe6\xde\xb0\x76\xf3"."\xd1\x1f\x6d\x7d\x73\xe8\xdf\x6b\x3b\xaa\x1e\xef\xbc\x23\x2\x4\xe5\x27\x1e\xd9\x35\xee\x84\x17\x66\x3d\x7e\xc7\x82\xb6\x6b\x9b\x66\x1d\xf5\xf3\x94\x77\x6\xde\xba\xe3\xcd\xb3\x8f\x5e".base64_decode('uaLrd38eHti16Y/R2l8+37rs1qvPPONfLzWfFH18aNdzW5e5X6n7adNPj54UXQ==').base64_decode('/K+rNwf/EN29+3d9H218+9IfA1/9POf7r34+NZ0ac5bnuVGdVW/9/WXp6FD4/Q==').base64_decode('Z696dtNdxz954WHXuF7+LtbgvnHpBy+XLFeP+Hb7TRdsu2jyqE/rvtvziDcSUw==').base64_decode('fQ/8vGqDo6S1/fgV3ywPhNJ/eummxx49Qtvie2zDLe5Tlo/dtXbidQ+ffpp2xQ==').base64_decode('Qze/uGW39ELTPhff+3p95qU1p8y6WjkyeMFvH50QK3tM+/S5n2ft/H75S5uuvQ==')."\373\275\331\215\357\115\174\161\305\226\217\226\277\364\316\17\3\213\76\12\274\376\152\60\260\241\157\337\300\15\327\224\311\123\107\137\134\173\104\376\210\171\337\176\156\256"."\171\150\245\374\323\171\327\34\251\54\355\270\365\371\103\275\277\137\377\360\201\373\135\371\205\367\300\365\347\14\244\174\137\257\370\335\153\351\62\351\221\173\314\372\253\66"."\226\134\167\274\342\37\375\357\346\263\112\256\74\247\377\341\353\156\373\341\213\245\227\167\254\162\67\114\271\164\373\74\323\177\371\141\303\347\54\111\35\365\352\217\47\256"."\210\354\376\123\357\67\336\17\247\65\375\341\210\13\264\363\235\362\274\374\211\107\174\76\352\351\17\367\331\264\370\330\375\247\215\233\371\204\176\375\224\243\317\271\374\365"."\x8e\x31\x9b\x5b\x3b\x66\x8d\xff\x64\xda\xb\x1f\xae\x9c\xb9\x6a\xf9\x93\x47\xec\xfb\xcf\x6f\xcf\x8c\xfc\xed\xb0\x35\xb5\x6f\xbe\xdd\xb2\xf4\xed\x71\xf7\x98\x37\x2f\x78\x75\xf6\xe8\x9e"."\x33\x16\x7f\xe8\x5e\x76\xde\x2e\x29\xf2\xbb\xd5\xbf\xdc\xb0\x75\xc9\x5b\xe1\xc1\x6b\xa7\x3e\x36\xfd\xd1\xba\x43\xf\x7b\xe7\xfc\xcd\xdf\xfc\x35\xfb\xc3\x5d\xb\xfa\xdf\xc8\xc7\x27\x1c"."\xf3\xc0\x61\x8b\xf6\xfd\x73\xcf\x49\x47\x7f\xf2\x9f\xfd\x9f\xbd\x6e\x62\xd4\xf1\xf1\x9a\x2f\x77\x36\xee\x7a\xe4\xf1\x4b\x96\x1b\xdf\xce\x7b\xf2\xbd\xf7\x6e\xcf\x5c\x7a\x70\x4d\xcd\xb6"."\x7f\x7f\x20\x4d\x7f\xf6\xd9\x50\x43\xfc\xcc\xce\x2d\x43\xca\xb7\xff\x6c\xda\xf0\xfa\x95\x97\x3d\xf7\xfc\xac\x9b\x62\x17\x5f\x1d\x91\xaf\x8b\x3e\xf5\xf4\x9f\x8e\x5a\xfc\xc2\x45\x37\x97".base64_decode('J93vuHYdf6D36PjgDRdM/Pa8zlG3Vlde8eDGSV+94J3+XfODc07vObz+cmXndQ==')."\67\204\217\112\76\261\375\302\147\353\47\337\262\345\301\350\376\173\355\63\255\351\207\347\76\71\173\361\137\356\32\67\373\274\170\140\357\375\356\37\70\250\344\352\207\376".base64_decode('edExSx2NBw2MPfOwnzY0zn0usKTk+juXfrrozRlxPXbHb/wPvv3FeX+aG7hM3Q==')."\364\323\347\147\324\127\245\106\347\327\106\336\160\334\163\377\175\357\316\56\323\157\176\371\371\256\73\274\367\125\76\332\325\373\352\33\37\176\236\61\203\347\275\260\240\302".base64_decode('P/qck9RP/vbNmi3HL7ymTL340YZZfz3mpZ2L+q/5/tZ1P88w/vPt/gtGxS5e8w==').base64_decode('yqonHtqwbc276+LHv+5PlPzu7Ts3jvrm4ImZmrti1/R9Ezt8w4I9TvtsWvjIbw==')."\xd2\xcf\x5c\x71\xe0\x94\xc0\xa9\xf\xdc\x7b\x81\x6b\xd6\xa9\x21\xef\xa6\x2b\xf6\x99\x7b\xf7\x9d\x5b\x2f\x99\x6d\xdc\xbe\xe0\xad\x2f\xdd\xef\xbf\xef\xba\x6e\xf4\x96\x1d\x4f\x57\x4c\x97".base64_decode('Nm2a//qDBy04esXaf+3amfl8Yca9uvHTQxcZwcqO/dYc/u3Tj+ze+N6klT177A==').strrev('Ÿ´¦‡›ñ³ªÔ€î£ş×EoùÕkª_}]w€àÿİ¾‹ı'."\r".'‚ıt_®+‹är').strrev('üØæ›Ş½„ï0Ü6£”ãj´Ûï“¥ä¦üş÷“ŞÒàÿOv§ô6?©ı8^Oë”®s')."\356\276\173\375\130\221\77\140\333\315\247\376\160\347\223\33\134\75\27\334\177\134\350\350\312\337\256\13\214\131\165\270\367\310\113\356\76\175\325\305\343\173\157\227\345\371".base64_decode('+lXbvj3onGse2rPzjO9+WNYTXfDzPzfc6T4jv/v9jo9/+emln/59UucTv3zx4Q==').base64_decode('Yb/8vOOjw17545Ijjrj5zltP6tr9+eef/PB5XdeMX7Z98/TgK2f+59FvD3v/0Q==')."\237\77\323\72\376\170\346\277\376\176\346\231\317\335\376\233\212\261\347\217\173\355\313\25\223\337\117\374\311\170\146\313\153\343\334\275\333\327\76\372\340\202\375\202\33\256"."\115\355\230\360\335\67\327\176\170\300\3\216\127\327\256\35\270\365\235\167\336\377\364\253\367\217\377\342\313\303\16\73\264\371\243\27\136\333\365\237\375\265\272\306\73\156"."\211\307\173\347\225\116\174\247\377\302\311\77\354\175\334\37\134\53\357\334\120\277\76\262\56\322\367\175\323\304\301\37\316\137\130\375\365\264\253\366\54\333\35\152\135\171"."\xe9\xf6\x66\x35\xff\xe9\xa5\xdf\xcf\x34\x4e\x7f\xe8\xfb\x5b\xbd\xf\xdc\xb8\x26\x76\xff\xd9\x87\x4f\x58\xf8\xe5\xb1\xe1\xd1\x4f\xb5\x4d\x4f\xd5\x77\x5f\xf4\x64\xac\xb3\x3f\x31\xef\xf7".base64_decode('a4a/6dvaeVXd1iPnfanuPj3x8X3XP7TXL3uba/atO/hYem1hymT8m++RjbRJNg==')."\131\211\351\113\176\240\307\34\352\47\7\164\23\47\127\21\351\170\42\11\50\75\332\140\76\113\366\360\210\361\266\331\35\357\65\262\344\364\163\322\44\132\224\110\324\3".base64_decode('vUPycJKYpk2aUE0qrCaByVNIvsm0QDqfjPUmyB5jrx4fNAeIajR5Ijl87e9Npg==').base64_decode('tKxOC5JPGqlE39AwtSmIycNanB4C96bSWZm0sJo0O5kxY/FcL6lk6lSSSto3lQ==').strrev('HÉzÓL–>fi”§Û$–7¥	ÃY¤´ÉÊäÜŠ ŞrÒP=4Í•ê›(à').base64_decode('YmUF+e5Ad38yrZLTt0Rvf2aom6BAG+4Z6KVn3AP96Z5EimCz3+weTFJVbipBXw==').strrev('¥U"L\'*U\'HSI¬‚ysÖFi™û–ê‹±*e2)ït©}=y¤‰¤Şé')."\x64\x65\xb0\xc7\x20\x55\xa5\x8d\xc4\x70\x1f\x2b\x44\xb2\x4e\xaa\x26\x81\x54\x22\x39\x6c\x64\x89\x72\x35\xa4\x6a\x3\xc3\x26\xd1\x1c\x93\xa9\xc1\x9e\x44\x9e\x19\xc7\xc5\x8c\x34\x55\x4b"."\253\53\111\341\154\246\57\237\113\221\361\355\215\351\75\203\361\34\51\234\310\230\100\43\46\210\247\324\324\75\234\64\142\131\102\310\23\52\11\75\124\221\337\101\71\146".strrev('§$?EUZM\\šï4U'."\0".'J^ÌgÈÙôšº¯’u¥KX †DM³J™”™0š‚2')."\322\261\176\132\200\44\203\36\164\367\33\244\341\375\331\236\314\220\102\360\130\131\65\205\326\120\105\207\216\4\324\270\234\114\30\71\72\164\244\345\123\46\220\271\232\351"."\311\305\64\243\227\66\230\220\13\50\221\37\44\366\21\331\274\332\235\241\373\365\162\337\300\160\177\226\326\106\277\72\241\212\24\124\324\244\221\313\23\342\256\246\150\232"."\x3c\x75\xa\xed\x31\xe9\xfa\xc4\x29\x94\x55\xc\xf6\xe8\x7d\xf4\xd4\x0\x8c\xe3\x70\x76\x90\x8c\xaa\x9a\x37\xe2\x3\x7d\x64\x26\x56\x55\x92\x1a\x6\xb4\xfe\x84\x19\xeb\xa6\xb3\x90\xd4"."\62\220\115\345\207\144\225\262\205\211\224\153\164\153\75\171\202\56\71\66\224\212\253\344\103\225\23\110\26\245\127\355\311\45\350\25\202\344\140\256\257\237\216\361\304\251"."\64\57\105\155\5\351\316\220\234\125\272\215\4\235\62\244\252\341\174\316\124\372\11\127\233\72\211\140\77\333\77\254\367\321\33\130\123\53\351\70\117\46\43\77\261\252"."\222\216\61\345\171\24\225\123\150\140\70\236\33\122\6\11\341\17\53\140\262\246\310\24\357\111\250\3\161\152\244\242\44\373\322\72\235\325\163\51\261\325\313\361\76\272"."\x47\x6d\x98\xb2\x99\x33\x6c\x19\xd8\x2d\x98\x8c\x2b\x2d\x67\x98\xc5\x4a\xb\x41\x66\x5c\x34\x8f\x16\x33\xf4\x29\xa\x35\xd9\xa5\xa6\xc0\xdc\x24\xc2\xc8\xa1\xcb\x5\x4\xae\xa6\x15\xbe"."\331\236\210\361\315\25\270\77\46\30\122\300\150\130\54\31\317\230\102\62\210\131\122\303\246\246\63\323\15\154\24\346\202\255\162\131\373\131\101\60\134\344\10\203\154\136"."\33\306\240\246\23\164\364\151\211\170\112\313\45\54\265\46\142\226\72\31\224\356\51\331\123\272\107\200\203\172\370\351\257\0\263\40\50\206\106\214\231\364\300\77\244\271"."\370\36\227\241\364\347\24\166\317\0\347\166\321\61\210\11\303\215\217\5\114\331\350\163\211\140\247\230\252\146\100\63\123\51\227\365\176\37\274\354\105\251\43\312\355\235"."\x61\x3b\xdb\x5\x83\x1d\x18\x17\x76\x6d\x85\xe\xf1\x41\x13\x30\x28\x8e\x9d\xb5\xf3\xf4\xe8\xab\x47\x31\xe1\x6d\x35\x6a\x73\x44\x9\x46\x30\xf4\xcc\x26\x34\x6\x4d\x18\x96\xdb\x8a\x64".base64_decode('GqbzMCqE2VhHlHQWjhhpghtfAOJWy9ZhLdYHnFBktGBHOJ7KYJCczsEdT6lbBg==')."\200\104\215\324\15\212\111\324\316\137\62\65\32\46\243\340\206\243\340\106\215\26\106\100\114\303\75\345\211\66\112\54\212\141\326\150\206\145\166\4\300\367\243\111\67\4".base64_decode('23Z84MMBImlb56WF6K0zWkyy4o0cG6N7hg4JN8UhofNoyXr1zdcosYN9kY7F5g==')."\xeb\x4a\x36\x25\xc7\x59\xd3\xb3\xf9\xa2\x28\x17\x5b\x23\x1e\x86\xdb\xba\x16\x2e\x82\x46\xd6\x39\x4b\x22\x18\x99\x9c\x59\x24\xa3\x88\x6d\xcb\xe1\xb0\xd6\x90\x2\xdc\x86\x1f\x80\x22\x93"."\1\336\15\34\145\247\140\141\360\41\306\254\164\45\241\122\303\133\45\215\162\122\143\166\164\312\305\54\176\343\51\105\326\55\47\154\323\353\262\311\54\274\133\154\116\253"."\43\27\34\311\311\141\124\370\56\11\363\253\30\42\64\145\77\265\243\14\303\325\130\57\134\2\206\331\110\11\176\306\14\140\136\70\241\107\202\67\62\33\15\51\234\353"."\351\121\14\263\6\135\57\222\306\113\240\55\223\135\125\40\200\46\105\265\153\62\10\42\104\220\303\257\316\14\377\56\16\345\62\60\34\312\145\340\30\324\10\255\352\46"."\275\162\361\274\362\170\236\256\44\116\46\230\21\372\60\110\62\320\262\121\271\233\334\252\362\145\354\20\116\260\121\300\306\242\144\335\44\43\126\357\11\373\32\242\155\36"."\x6a\x82\x2f\x67\xb3\x6e\x23\xd1\x67\xb8\xa1\xe9\x9c\x3a\xa0\xf8\xd5\x98\x1b\x5e\x59\x84\x58\x75\xc5\xa8\x61\x7\x40\x3f\x68\x8a\x1c\xd3\x74\x93\x8e\x75\xe\xde\xa4\xe8\x13\xbf\x8d\xc3".base64_decode('rVaSAHhzMioBIw+akjCQDSdhJ6SzhnBpM8QJDBZHaP6VoqZIDVnQ3Qwz3jRSMg==')."\x3d\x26\x35\x0\xe\xd4\x8c\xc2\x48\x33\x67\xb0\x13\x25\x68\xe8\x1c\x5\x6b\x2d\x5d\x74\x0\x19\x47\x13\x54\x2a\xf7\xfb\xea\xa3\x8d\xbe\x10\x9b\x66\x26\xbd\x99\xe7\x69\xf3\x45\xc3\xe1"."\xa0\x80\xcb\x1a\x81\xcb\xc3\x5b\x47\xfc\x7c\x1c\xc6\xf8\xed\x23\x78\x4c\x25\xda\x63\x89\xab\x3e\xbc\xa9\xc\x6d\xc2\xc3\x12\xb1\x4d\x4\x54\xdd\xd0\xe2\x9\x31\xbb\xef\x6a\x57\x85\xab"."\222\347\5\37\214\102\363\367\132\172\365\61\34\361\204\212\334\132\307\267\331\11\176\311\15\166\122\240\45\330\41\65\4\375\355\255\201\60\276\246\215\341\201\240\220\216".base64_decode('rHtJMr3TXphMqve2+T0NXskXiASp+T4zvUQXN8IsTlGgGwq7rU7K44h4uUSskQ==').base64_decode('1UTmynxHaWdJ57jOss7yha5Oo8stDglZhNsaSZdqWIit3K3h8CxyJykY8jT46Q==')."\347\301\174\41\301\140\203\17\7\76\276\152\375\266\107\56\371\370\332\165\333\57\134\16\52\332\261\372\354\35\127\77\260\355\241\345\237\234\363\370\366\165\27\177\374\304".strrev('W§Òa¬mÑ~ß¯·§Âqsêñü>V;5İ}¶İWÇóÿÛƒ÷r6‘gÅÇ{º®;%').strrev('İqÛ/÷ûóXîVİ|~?Ëyéı(!èogcûr¹ÛuòÇg¸¬w›’ã±>')."\362\355\27\335\270\175\325\155\37\137\162\367\366\233\316\331\276\164\371\47\167\257\70\331\116\74\70\76\237\242\237\330\110\270\27\164\32\343\312\60\112\73\215\361\20\235"."\345\340\267\14\336\0\0\277\324\220\31\231\275\316\152\367\6\32\274\366\33\65\142\224\134\357\37\207\251\2\133\275\20\211\320\40\356\1\150\74\212\56\121\225\216\330"."\x8a\xc5\x64\xcc\x85\x46\x9\x8d\x69\xf4\x86\x1b\x42\xbe\x7a\x2f\xb1\x31\x67\x3\x35\x6\x99\x2f\x8f\x21\xad\x99\xe5\xf\x87\x66\xb3\x30\xbb\x56\x56\xe0\x94\x41\x2a\xa3\x4\x5c\x2e\x59"."\72\42\273\342\132\52\227\316\240\306\112\45\320\236\253\304\1\371\40\222\372\244\22\270\72\2\200\22\7\323\255\14\136\322\106\166\255\245\163\113\35\25\216\312\162\211".base64_decode('eGzAJYiHBqmEWD2zcpaPOGKWWKWjolwqyfaVkHZxvILWR3FOQ5IdZaTBYnN5Xg==')."\xc0\x0\xd\x53\x97\x55\xc0\xf2\xa5\xb8\x83\x81\x58\x79\xf0\x6b\xf1\xba\x10\x77\xf1\x12\x78\x9c\x40\xe\x3b\x4c\xf2\x4\x1a\xad\x39\xb1\xb3\x86\xb6\x52\x49\xce\x24\x40\xa\xc6\xaf\x38"."\xcc\xa5\xe5\x52\x8c\x58\xee\x17\x49\x44\xc5\x2c\xc8\xa8\xb5\x20\xa3\x6c\x3c\xe1\xd\x6d\xcd\x6c\xbc\xb1\x59\xbe\x84\x6f\x6d\xe1\x66\xc9\x6\x1d\x28\x2\x45\x43\x5\xa1\x78\xb4\x68\x5e".base64_decode('DXQDDA7ODwIspU/J85oAC2IJdAQhnA1ikTTkRaMES3e4n2mjh7I34r2hdS7rAw==')."\xa5\x65\x89\xca\x20\xcc\x7\x7\xbc\x7f\xe6\x8d\x34\xb4\x60\x2a\xf\xb\x64\x9e\x88\x8d\xb1\x10\x2a\x47\xa7\x64\x21\x11\xa6\x50\x90\x7c\x78\xba\x40\x86\x70\x20\xca\xe7\xb\x34\x5\x43"."\xad\xf8\xde\x55\xb8\xa1\xc5\xdb\xea\x71\x11\xc6\x8d\x29\x1\xe7\x87\x32\x94\x54\x2b\x95\x42\xce\x87\x41\xa5\x16\xf4\xa3\xf\x51\x94\x45\xd0\x57\xc1\xbc\x8a\x9a\x40\x5a\xc2\x58\xc8\xf6".base64_decode('kMaQ0ZfQbVwZFaktxZfbSZXMZUwwFIkCBBD2LHDdUmGFEKyg4fWhASrbd8txoA==')."\200\123\337\15\61\352\131\6\124\16\353\154\10\6\232\174\364\212\131\143\314\222\326\30\362\301\13\325\344\263\134\315\343\206\44\40\222\35\114\260\60\277\114\14\23\330".strrev('ŠìCE˜kO!<D$0Ba?·anFÖó„Ğ"'."\n".'ˆ¹…€p™øƒ‚)‡A|"Š')."\2\203\341\253\12\321\100\173\53\347\347\176\317\154\100\12\101\56\162\120\136\134\346\32\127\127\336\211\357\170\341\40\376\71\215\306\340\275\227\256\105\225\16\151\322\222"."\162\222\207\336\212\212\232\111\40\3\106\371\127\146\371\243\376\140\63\216\43\307\73\336\114\202\153\21\322\174\11\210\303\21\56\16\33\164\141\142\264\56\1\12\225\360"."\xc5\x51\x29\x10\xec\xf0\x70\x2f\x2e\x42\x2\x86\x90\xfb\xaa\x12\xf7\xed\xe2\x5e\x30\xbf\x73\xb0\xd3\x5\xa4\x0\x63\x21\xbf\xba\xd5\x58\x2f\x51\xf9\xa2\x1\x8a\xb1\x44\xa7\x27\xa5\x3d"."\164\255\134\350\40\313\102\64\245\365\60\31\57\320\110\145\2\374\73\207\6\20\103\44\5\200\206\232\115\321\73\134\370\362\130\264\163\161\347\330\116\247\13\337\227\203"."\122\111\247\203\67\51\352\235\3\26\322\160\330\162\331\57\212\374\222\220\332\101\147\111\10\117\115\34\231\116\176\210\352\64\235\240\200\104\147\324\262\61\365\316\132\34"."\x0\xff\x9a\x23\x8b\xbd\xe0\x9f\x1f\xfc\xf8\x23\x60\xd4\x54\x96\x1\xcc\x3b\xbf\x6f\xa6\x77\x31\xfc\x8f\x27\x94\x33\x44\xe2\xb\x33\xd6\x2\xbe\xc0\x62\xf0\x3f\xe0\x22\x8b\x7d\x1\x7b".base64_decode('ZfXeSIfXizPQMPnlWQFXIV0V/DOdHqR3PSW/tykiwThtRjRahpDp7BpfHo26jQ==')."\166\102\66\354\202\175\131\351\251\225\245\144\241\360\204\33\70\213\265\20\104\41\55\40\223\175\53\41\60\177\103\44\336\34\12\266\267\11\361\26\317\154\137\240\231\306"."\334\343\150\150\34\365\173\322\350\13\3\24\65\120\142\344\156\220\304\70\221\52\221\354\43\212\263\26\312\156\4\354\33\104\4\131\34\112\371\230\375\132\47\133\175\273"."\317\337\50\336\157\206\31\311\252\201\130\67\131\70\306\320\306\321\70\272\351\114\43\20\345\64\214\310\215\106\20\16\150\4\43\200\306\20\272\150\4\271\133\242\21\324"."\x51\x1a\x81\x6a\x87\x37\x40\xd3\x80\x1e\x7\x74\x30\xaa\x9c\x25\xe5\x1\x76\x41\x6f\x5a\x22\x26\xdc\xb3\x87\xec\xd7\x85\x37\xc5\xa0\xf\x6\xa0\xf8\xc9\x6c\x9b\xd1\xb6\x5b\x88\x36\x95"."\4\245\36\33\60\112\302\75\141\270\355\50\154\4\271\161\16\40\141\242\74\340\267\163\141\35\222\200\27\122\72\305\167\123\315\210\152\246\54\37\45\327\331\300\107\175"."\350\342\240\360\131\262\206\363\375\41\274\243\33\325\204\115\136\274\355\113\166\100\371\316\213\125\25\142\154\150\41\323\160\310\175\176\7\371\325\171\267\254\146\240\20\102".base64_decode('Bv8Q/NNJ8tLNCXJfrtRBVlVfMOoHa0VUVBR9QbKj4YqJF8Kj/F65S+bGmKaeEw==').base64_decode('fDUhw0wwjB5+fZRtsqC0XAxmFvCmajVwkwxC8XQkEhME0mvk2IeV3WpSBHPDSw==').base64_decode('tqtH7T1VgHJLAXHbWE4IVpYS/TLabsxYHS0BkkhF4ZVrIOVEFd7+tGIYbOcfrQ==')."\372\64\150\46\371\175\127\321\237\124\143\75\305\125\56\143\206\25\172\114\322\30\103\46\253\374\232\6\103\234\41\230\262\242\35\74\216\157\354\352\313\126\220\324\344\143"."\35\27\162\161\240\237\173\216\202\233\147\274\316\56\52\231\362\116\16\253\131\373\126\132\106\153\123\364\264\212\166\5\73\270\125\72\113\27\112\43\223\177\355\327\220\233"."\313\200\57\264\261\221\165\126\322\314\364\264\12\21\214\304\344\63\146\152\15\206\24\225\25\254\203\21\327\40\325\352\144\377\376\144\133\343\114\115\153\225\63\371\210\66"."\133\125\10\231\66\6\73\2\376\40\165\210\103\275\145\341\130\317\60\241\173\100\174\56\32\61\151\100\227\311\227\73\350\72\6\367\302\4\37\212\47\213\64\200\6\223"."\xd3\xa4\x27\xd4\xd0\x2\x24\xd0\x68\x93\xf\x8\xde\xde\x39\x11\x5e\x41\xb\x28\xa\x64\x5a\x61\x98\x4\x68\x2b\xf5\x12\x1\x18\x2a\x64\x62\x7e\xad\x87\x4d\x5e\xc0\xa4\x88\x77\x14\xcb"."\4\366\5\111\131\227\2\255\352\261\255\65\274\5\301\12\142\77\40\377\275\120\273\340\150\154\204\271\131\264\134\3\311\310\76\250\43\55\342\277\177\60\244\160\331\32"."\24\103\227\30\376\153\41\356\362\16\175\11\25\22\370\226\255\14\42\40\154\24\116\306\72\111\222\271\133\7\300\54\201\322\320\2\26\322\140\150\56\351\276\21\261\360"."\x3f\x5a\x8a\xcc\x56\xb4\x59\xe8\x46\x57\xbd\x88\x90\x30\xd\x6d\xa4\x3a\x11\xaa\x88\xe0\xb1\x8\xb0\x40\x16\xa2\x7\x6c\xc4\xe9\x8\xdf\x8f\xf7\xe0\x9f\xb9\xe9\x84\x13\x34\x9c\x1c\x9c".base64_decode('JRSTOXuAs8wjuKIQLsqlGYMaFPwxyQMKvLNAJfGCI0nSlcLOMe8e1jOrmcHGaA==').strrev('¶Mız;¨ACD–$p‚iLÁEÍ<Dp!Ûfy6ƒ~Ùs'."\r".'¼…Hn0w¢Ø8')."\341\26\346\32\313\12\213\372\175\201\231\105\23\42\301\150\253\120\4\3\175\21\157\253\35\146\255\41\354\205\363\227\307\353\375\301\6\41\331\27\54\304\4\220\205\154".strrev('÷Ê'."\r".'€#T»„OÌ/tÇç]Ó¬¼¤¹×[ğFuzPÅ‰$ˆ¤Y!;¥ b‚¬@').base64_decode('a+wAuGRQIC5GYm6Xi3yEBYB2yDyMUDZK/BGGsS8GSytsF5/pHUyX3X2XD2+fRw==')."\xc3\x73\xc3\xc\xdb\x98\x14\x8b\xa5\x5b\xe8\xb\x67\x13\xcf\xb4\x6c\x99\xc1\xbf\x36\x31\x2b\x3c\x74\x2d\x9a\xd1\x42\xa0\x96\x1b\x69\x22\xc8\xa5\x6a\x7c\x2e\xf0\x49\x9b\xd0\xe2\x39\xe8".strrev('v™×0jjàp®°‹Ùø'."\0".'ƒ¶b$-(©Ä#sÑN2,€›lw,Kâä'."\0".'3/œcî')."\46\72\43\315\320\1\125\347\74\326\100\125\27\74\100\305\265\114\102\25\156\172\312\161\52\30\344\342\175\354\332\44\144\131\206\163\120\245\50\70\225\71\213\40\207\275".base64_decode('URn5RYmK1gb9TkPtyTjlVI8GhIRkmkLlPks690aW1VIqdQrT7wSfENJwZlA5ZQ==').strrev('ïÇ‡urá5¤ØqR5¨Âæ~dC#bÜBI‘¬@ºDÅƒƒry†Üğü')."\xfc\xc2\xf5\x1e\xf9\xb\xc4\x51\x87\xc4\x5d\xb1\x52\xa5\xb3\xb8\x30\x2\x75\x1d\xe1\xb6\x12\x65\x1a\xe9\x3e\x7e\xa4\x96\xee\x63\xa7\x51\x71\xcb\x22\xa\xd7\xab\x26\xe1\x5c\x9c\xaf\x93"."\xc4\xef\x29\x48\xab\xcf\xd3\xc3\x65\x72\xb7\xa8\x3e\xf\x17\xba\x2\x89\xd\x5e\xc0\x15\x5d\xc7\x7a\x3a\xc2\x55\xce\x96\x56\x4f\x83\x13\xb0\xbe\x9\xd5\x93\xd8\x2\xd4\x19\x1\x2b\x10".base64_decode('pSV50KiicjGGjJ8kJQHyCZEUOmo71eqgEAOxnzGgmSXgKR2VeDDURjwYyGV4HA==')."\307\376\153\350\141\170\122\146\15\206\335\300\241\142\337\235\123\364\273\163\212\175\167\216\355\273\163\12\277\213\101\66\42\225\263\331\6\354\20\125\344\46\26\120\134\214"."\x50\x8e\xdb\xd\xcf\x24\xc5\xb3\x4c\xa2\x83\x62\x53\x23\x17\x48\x6e\xc4\xc2\x5f\x82\xe5\x37\x78\x88\x4d\x84\x6e\x61\x8a\x58\xaa\x73\x11\xd6\x94\xa0\xc\xde\xa0\xc\x3e\x25\x1b\x26\x94"."\214\377\17\356\4\341\65\345\126\46\256\63\31\313\255\31\206\33\272\116\102\222\45\73\316\17\206\351\246\233\265\117\330\317\270\240\35\22\277\56\314\263\35\363\173\307".strrev('ÊÔ>dòÓ'."\r".'N'."\n".'6®Åår'."\n".'~ˆ¡š²‡x¬µ€×ÛÀôö@@ü»²ö½áã').base64_decode('QXBvSD3/iX6UIMKcaYt71SEn6LrNHaChKH1UERKEZaa8tjE3f/buQFbA+aDOnA==').base64_decode('QuK9dGdRgFO4LIy5geAkFLSLmuOCZpL5m0S4oQov/plXrNdOnXtiBGOJ3ffOVA==')."\362\324\247\241\155\6\330\334\40\166\66\167\266\166\106\104\64\231\272\334\335\15\232\55\170\126\263\264\345\327\34\65\222\35\243\261\105\135\63\222\104\44\1\273\101\16"."\350\363\143\60\312\250\23\171\356\56\102\237\263\40\234\120\150\67\67\1\312\346\4\27\362\42\115\300\325\231\71\374\206\12\56\366\217\111\331\2\362\133\111\374\334\62"."\107\222\0\75\231\172\55\101\226\272\105\45\200\332\112\152\112\116\55\3\277\345\45\216\22\50\50\241\70\34\51\10\100\355\50\251\71\265\14\5\312\311\135\371\141\142".base64_decode('xSk4iuMnFES1rZNNU9hbq0PYgPN7gnuCe5DM+bp++EXuqNrO54eigLVRU5KoyA==')."\140\11\353\46\130\27\123\132\130\113\50\353\155\155\254\246\234\322\323\72\317\311\135\67\116\257\33\112\247\44\242\365\324\226\126\272\52\112\45\352\347\274\266\264\75\322"."\344\234\122\132\67\143\324\364\6\264\323\156\52\255\160\253\34\272\305\304\312\350\14\262\65\66\35\116\41\26\161\133\143\43\225\45\234\50\55\17\153\31\260\234\1\56"."\224\166\305\11\62\333\31\247\342\336\64\63\212\71\250\351\344\30\201\60\321\11\25\125\42\335\22\22\61\350\364\105\227\204\153\340\136\31\355\176\173\66\237\313\70\241".base64_decode('SuwMi66CbN57K6z5oVJrzS+yvzhnEWkexN6WayTRBbfgq9AJ13088+j+CoFBzg==')."\x48\x41\xaa\xe8\xf9\x91\xd2\x35\x64\x7b\x51\x2b\xdb\x3b\xcd\xd6\x5e\x88\x6a\x27\x90\xa5\x20\xfd\x83\x49\x5\x96\x58\x53\x29\x96\xc5\xea\xe7\xd9\xee\xfd\xd9\x8e\x5\x54\x4\xe\xae\x53"."\x74\x2b\x3d\x4\x4\x69\x98\xc\x1d\xd2\x3a\xe1\xf8\x3a\xd5\xc4\x48\x29\x7c\x52\x17\x6d\x6a\x9c\x90\x4a\xb1\x2c\xed\x39\x35\x61\xff\x24\x3a\xb9\x71\xe6\x72\xf4\x83\x45\x2b\x15\xc5\x7c"."\x9a\x1\x75\xc2\xc7\xea\xb3\x8\xdc\x40\x41\x77\x32\x19\xdb\x2e\xb3\xb\x7b\x98\x85\x2e\x5d\xc1\xe4\x95\x26\x4c\xac\xa9\x9e\x5a\x43\x8d\xdc\xc7\xd2\x83\xa7\x5c\xd6\xac\x65\x41\xea\xf2"."\xf5\x64\x77\x37\xe5\x3\xdc\x29\x34\xed\x1b\x1c\x70\x8b\x9f\x5b\x1\xcc\xd1\xc8\x66\x38\x65\x20\x96\x7c\xbc\xb5\x16\x97\xe2\xa4\xa3\x58\x7f\x14\xbc\xfb\xa2\xcd\x56\x3c\x93\xe0\x49\x6c"."\224\171\113\56\302\111\23\12\261\163\127\351\325\167\301\56\215\15\110\17\15\350\54\277\314\247\110\54\325\307\173\22\203\126\167\204\302\373\100\103\65\56\112\241\145\125"."\330\331\214\47\163\231\276\132\41\121\62\65\115\112\313\231\74\21\362\307\30\65\143\214\151\360\103\265\143\134\125\335\6\210\20\176\315\234\336\301\165\204\73\211\302\316"._kodDe('KjwM0v5qTks1Itg8rGZ5SxgeT9C7W0SMRaSo08Hg0vz/u3sU9sTOfAzObn7OJBo=')."\241\4\156\130\301\43\27\127\57\175\151\41\116\251\152\272\232\356\221\342\320\152\264\266\4\102\113\44\103\217\123\327\177\45\156\302\107\121\6\256\26\115\127\111\221\122".base64_decode('WETqBmTiRCGcXDpjuludwZDN/UzoGjeKdblPgUqSG57LZsbC0RWPiRC0iXuVkA==')."\244\351\262\204\361\130\133\12\17\315\272\113\245\44\130\217\231\345\311\14\173\341\0\75\253\230\356\226\305\104\70\263\102\32\25\161\231\242\64\300\66\215\213\356\206\173"."\xe2\x36\xff\xd1\xd\x72\x66\x76\x61\x11\x58\xb9\x2b\x2e\x26\xe1\x91\x44\x66\xbb\x85\xf9\xdd\x48\xc1\x77\x73\x9d\xd0\x7a\x3c\xc0\x76\xd4\x8b\x10\x85\x8b\x3d\xd6\x90\x95\xe3\x7d\x90\xa2"."\x38\xfb\x27\xdf\x24\x9\x6d\x50\xd\xc1\x9\x16\xaf\xc7\xa6\x70\x10\x6\x9a\xd\x3e\xa\xd5\x50\x9d\x3b\x73\x5f\xb4\x8\x57\x4\x57\xfc\x25\x4b\xa\x61\xc4\x7e\xc6\x9e\xe4\xc9\xaa\x76"."\x10\xa4\x1c\x3b\xc\x6a\xd2\x1c\x6\xd6\x31\xeb\x67\x30\xd5\x8a\x99\x38\x84\xe6\xc1\xbf\xbc\x8c\x3f\xd0\xcc\x23\x58\xed\xb0\x24\xce\xa7\xa6\x6a\x28\xd6\x39\xbf\xd4\x35\x6e\xc9\x12\xb7"."\x4a\xf\xa0\x3b\x4b\xac\x65\x5d\x2c\x37\x8e\x77\xba\xac\xf9\x41\x4f\x8\xea\x59\x46\x2\xb0\xe7\xc4\xf2\xe3\xe9\x64\xf2\x8d\x72\x8f\xe3\x46\xfa\xec\xa0\x59\x82\xa7\xcf\xb5\xb5\x33\xe6"."\xb3\x33\x86\x2e\x9a\x46\x85\x40\xb5\x72\xa\x1d\xfe\xe1\xa4\x33\xd2\xc1\x82\xd\x1\x2e\xe6\xa2\xa5\xdc\x6a\x2f\xc\x44\x5c\x9b\xbd\xb0\xf8\xf6\x13\x9b\x15\x98\x1\xb9\xd0\xb6\x89\xc7".base64_decode('6p6wboB5KReNZXHYk82KUeqsH22Qp9SYm7EHvGnuinPzdpoFMScbHB4r2xKgWQ==')."\63\2\17\0\356\11\304\264\136\73\34\324\305\200\54\60\335\210\353\152\326\264\60\66\374\52\121\11\362\53\337\53\17\310\70\113\211\104\137\71\51\101\136\164\113\0"."\43\303\51\204\203\360\246\114\207\34\113\322\225\124\155\11\152\256\221\124\24\120\36\361\244\142\37\1\5\113\44\312\116\323\62\303\230\156\152\140\245\144\66\322\344\105"."\x87\xf6\x10\xb1\x4a\xf5\x4\xc8\xa1\x4\x91\xc1\x4e\x59\x80\x7f\x4f\x3d\x85\xd\x24\x7c\x42\x24\xa5\xe8\xd8\xf4\xe\xb1\x29\x74\x4c\xd5\xcd\xf7\xb6\xc8\x3\x13\x6d\xa1\x60\x24\xd8\x40"."\x7d\xf4\x17\xdb\x4\xab\xa2\x2\xaf\x81\x6f\x6\x70\xc5\x88\x9a\x45\xcf\xf4\xce\xb5\xe6\x60\x22\x84\x9b\x40\xc8\xf0\xeb\xb9\x4c\x86\xd9\x1\x40\x99\x92\xad\x73\xf8\x90\x27\x9c\xcc\x99"."\174\205\204\116\166\43\360\42\221\101\300\202\223\50\350\242\112\111\270\54\221\42\331\360\71\74\254\204\116\32\313\106\6\256\76\245\121\327\130\23\52\52\52\234\25\225"."\340\57\73\177\44\102\131\115\105\105\101\226\212\212\32\364\27\47\240\355\127\202\105\153\12\230\345\224\75\221\14\203\212\102\32\104\170\177\132\315\344\250\334\64\277\1"."\x9a\xa7\x4b\xb0\x69\x5d\x54\x54\xa0\xed\x7\x8\x44\x77\x9f\x28\xa7\x98\x26\x68\x7b\xd3\x24\x74\xbe\x45\x62\x8a\x1d\x9\xec\xe0\x90\xc\x9\x5d\x72\xe1\x4c\xa7\x61\x20\xbe\x80\xe1\x41"._kodDe('KRY9WuIZrCs15TPlyIiyy09kHSYb8VSAjQwXrvhCfEIcf2WNQxY++7FoZUD+Ncg=')."\31\260\362\306\131\257\40\100\330\346\100\327\302\330\15\0\24\113\261\313\202\60\32\140\131\261\353\156\174\305\201\240\244\10\201\45\265\301\50\137\75\141\364\164\26\103".base64_decode('GIJKDqWqBNHRphE0UbZIqYieYpNDcXQ9rk9NWS4sRYW6ReRMgxlFww8waTzMRw==')."\x39\xe0\x4d\x50\x50\xa6\x24\x80\x77\xe4\x6b\x39\xda\x5d\x9c\x78\x90\xa7\x4c\xf4\x3a\x12\xb6\xa2\xa9\x19\x55\x30\x3a\xa6\x7d\x64\x10\xda\x75\x8d\xdf\x3e\x2a\x78\x66\x8c\xc6\x84\x3b\x79"."\164\347\72\374\137\114\70\50\304\113\1\330\350\241\201\71\333\22\52\260\47\331\312\170\22\302\13\130\6\367\262\325\300\34\352\211\256\267\360\41\261\140\112\140\20\37"."\266\374\124\230\326\301\272\11\24\25\127\126\327\172\300\140\31\142\137\1\274\255\70\230\145\57\314\131\44\23\353\220\230\117\4\102\73\45\372\30\23\241\73\176\253\111".strrev('p—pòM„Õ'."\n".'Ğ¯ÙkVJ­išº'."\0".'¢>*"'."\0".'ƒØ$µh!ùY	ÄÏæ').base64_decode('I41k45wA7lKI+6WqRk0MIDb4cZ8VjmFYL42LPjUjyKAqpdA3wwi7QXQPK0CmGA==').base64_decode('NgRyWiWTrbZWLGZN+3Dp5TRwJc0FUci21cQ9ZYi+qLhlACddC3uqqgjRWQmrgA==').strrev('5Åû	=swŠišêIÆ•œ™&fê•'."\n".'sû{h%!*%ô!\'ñ† ¬3Ğ‚')."\75\202\213\70\147\360\357\130\216\240\4\177\230\54\53\130\113\350\327\145\272\276\40\273\37\27\162\100\314\265\26\133\324\156\33\204\126\7\223\362\177\352\110\64\303\236".strrev('C‰ä›ÀU"”<Ú˜×ê1”†c2£p«êGMq+¥"ÈEb|Š3LÃ€“').base64_decode('KgAKZU68ly74IQUxwfGrIGw4KyUmpURxzTgyXkhA+YsJLLbNI8EaE+nL4VyM7Q==')."\xd3\xdb\xc4\x8\x6a\xe0\x29\x89\xab\x34\xb5\xd8\x84\x15\xa0\xbb\xcc\xb0\x7\x86\x98\x6\xaa\x85\x9e\xf\x79\xcf\xc4\x22\xe8\x9b\x5\x45\x70\x1a\x5c\x59\xb9\x69\xa7\x98\x62\x0\x5\xb"."\xa2\x6a\xe4\x94\x22\x9f\x42\x49\x2\x46\xe3\xcc\xdd\x0\xc1\xe\x47\x12\x49\xc8\x2b\xd4\xfc\xcb\x59\x39\xc1\x49\x9d\x40\x88\x56\x9f\x64\xf1\x25\xf8\x85\xf2\xad\x40\x6\x50\xa\xa7\x7c"."\x90\xd8\x72\x91\x7c\x3c\x8f\x26\x3c\x59\x85\xee\xfd\xf2\x2b\x8d\xe8\x8a\x33\x1b\x4f\x74\x17\x9a\xc5\x74\x61\xdd\x52\x98\x9d\x17\xba\x14\x2c\xb2\x15\x7e\xe\x8d\xcd\xbf\x60\x86\xf6\x62"."\xe9\x18\x43\x30\xb9\xd1\x62\x1d\x67\xcb\x0\x66\x86\x35\x9d\x38\x94\x4d\x5b\x9e\x20\x5\x74\x60\x31\xb1\xb0\x55\x42\x1c\x8\x8b\x4e\x73\x51\x29\xde\xf\x6e\x68\x8\x40\x1a\x76\x5b\x2b".base64_decode('IIafp+Pr0tRCkvElDo5oDFh4Ju9iFqLk8gt5G6qsHF5+sWyStObZJQYwkn1wkQ==')._kodDe('MlJMcmaNBHiV+STwN6GHNkT8HyG3fJQYZ4U4V1tfVTwfMSmn/zZ6JwDG6h38DuQ=')."\x17\x49\x6\x1\xde\xb5\x41\x32\xc1\x1a\x6a\x98\xa5\xf\x7d\xd2\x74\x30\xad\xc6\x25\x7f\xb0\xd9\xd7\xe0\xf1\x37\xfa\xc2\x33\x25\xe8\x1f\x81\x5b\x1b\x20\x27\xd1\xd6\xe9\x8e\xf6\xb7\xf0".base64_decode('4FDKjzE/yTDojAHB05lg4rjBBW/BAEh4BsFaLaZRRS+oEYjxaStDQGXgrl2R3A==')."\51\276\211\45\144\316\352\112\141\376\274\202\336\45\345\55\26\12\344\212\264\206\344\57\376\5\60\105\254\271\301\142\255\144\106\152\274\232\31\120\15\225\63\7\132\42"."\x2f\xd6\xce\xf7\x25\x75\xe6\xaa\x3b\x21\x7a\xf6\x16\x46\x80\x23\x1b\x7f\xa5\xd0\x59\x7\x71\xc3\x20\xba\xa9\xb5\xa9\xcd\x78\x98\x44\xaf\x2e\x59\xba\xcb\x4e\x1e\xd9\xe1\xce\xe2\x51\x54".base64_decode('cOOf1WXVUAQA9ic/jhjBy6mU5RWZVLcQzVlX2aKfiuIPUJjgOKZYhhB89fN/3Q==')."\x54\x35\xc1\x7d\x47\xa8\x9\x7a\xa0\xcf\xc\xff\xb1\x87\xe4\x6\xf1\x99\x21\xfa\xcd\x82\xa7\xa\xfe\xeb\xa3\x7\xe\xbe\x3f\x17\x45\x57\xe8\xe9\x4b\x22\xe8\xad\x63\x72\xe8\xc2\xe\xb4".base64_decode('o/iaPv8E0Ov0fFY8GHIn3AzFOAD91HjpDjGMcCEZZie1wc9hNQkobfCEhIrTdA==').base64_decode('twXwA4Jny8Go7fkGu/2f5W3Pgm9Ai6yR6wHlJL4VwTJItVIF2uHiL3pI0+nFIw==')."\xfe\x9\xe4\x9b\xc2\x9b\xce\x9a\x16\x4d\xb0\x45\xb4\xdf\x15\x50\x8c\x1\x48\x78\xe1\xd2\x3f\xb4\x2e\xd1\xd2\xf9\x2\x80\x65\x47\xc2\x4f\xdb\xc5\x2c\xd0\xa0\xb7\xed\x4c\xb7\x26\xa2\x1".strrev('T¾´RA ø)%ÅêûƒaIZÏ.Áa‰Ä¿ÿµèYŠïˆ§*Á¦ßŒhOñ')."\x3\x21\xf6\x27\x8\x2c\x8f\xf\x8\xb4\x8f\x6e\xab\x8a\xcf\x25\x50\x47\xf5\x40\x48\xb5\xbc\x35\x21\x54\x38\x6\xff\x74\x92\x5f\xba\xa6\xd8\xab\xc6\x5c\x84\x7c\xbd\x9c\x91\x4a\x83\xe5"."\151\162\1\320\252\160\355\21\225\202\66\2\62\175\354\214\276\163\40\120\31\173\372\200\275\113\303\47\50\172\356\244\161\204\174\66\260\144\365\325\316\135\340\363\365\316".strrev('1{ègĞlq÷HiÔHÓE†/>¬x¡È-%Ç¹h¡:\'¯d1;2'."\n".'œ¶ê')."\x9\x7\x7a\xcc\x4\xb3\x2d\xfb\x83\x39\xc2\x74\x63\xbc\x50\x2c\xdd\x93\xd2\x62\x72\x2a\x84\x4d\x8d\x2c\xf6\xfb\x3a\xd0\x92\x98\xf9\xa0\x25\x1b\x6\xb9\xe5\x6c\x96\x9f\x5a\xd8\xe\x21"."\60\220\34\110\344\62\76\174\57\314\2\325\5\55\114\64\116\305\107\33\374\112\14\311\16\276\326\206\17\147\110\267\305\52\351\201\31\333\224\154\22\136\302\164\27\36"."\260\101\123\50\302\34\104\113\101\162\326\351\22\325\44\222\101\232\56\361\1\266\314\111\110\20\100\126\165\240\0\232\364\242\130\375\53\120\106\207\326\47\225\60\301\242"."\237\106\245\233\351\30\60\316\327\127\361\66\54\77\130\267\77\343\102\77\303\336\244\161\340\236\361\7\265\360\13\64\16\366\332\214\3\173\46\162\220\67\146\34\374\152"."\323\257\275\312\304\37\270\263\276\212\7\333\314\114\353\12\204\175\273\234\317\120\145\53\20\262\43\56\242\25\356\376\361\143\305\114\56\315\17\152\101\304\252\367\24\164"."\x58\xe8\x61\x4e\x4f\x39\xd0\xa1\xaa\x83\x3a\x7f\xb1\xa1\x83\xf7\x4a\x1c\x99\x22\x38\xfc\xef\x75\x60\xb\x4b\xa4\xcc\x24\xac\x5c\xa7\x66\x7a\x4c\xa7\xe7\x4c\xf6\x6c\xaa\x85\xea\xa2\xba"."\302\115\374\261\237\254\202\207\40\346\246\23\23\46\126\117\25\67\15\370\370\360\363\33\342\125\222\270\110\43\207\110\104\0\340\3\57\131\311\112\242\76\272\304\351\213".strrev('Â,ø7K<ö‡lÆXCÁE¢@+ˆR,gÁpnÿñÙBo…°6­').base64_decode('Ccr6LbyUF+mHsPzwCYEf4tFSUIVNw21YU5etulgxlQNhguo3Knq0UbG3HSGGbA==')."\126\360\144\101\47\21\153\64\65\373\116\13\54\16\227\47\264\321\27\314\244\310\142\13\157\156\362\251\45\160\226\377\305\0\122\265\3\153\50\334\144\243\110\317\335\247"."\121\366\121\344\241\45\341\30\373\127\332\215\45\55\246\142\71\145\323\51\20\244\260\73\247\230\101\64\300\104\146\341\32\237\265\257\266\352\101\61\136\107\227\103\32\51"."\123\241\270\45\274\307\304\375\127\10\202\26\54\115\257\210\215\240\60\123\36\45\276\64\145\46\271\106\200\147\250\145\266\12\236\357\304\73\63\250\42\161\32\24\126\215"."\xf6\x60\x48\x7b\xc9\x74\x6d\x89\x44\xda\xf0\xb5\x28\x4f\x33\xbb\x2a\x25\xb\x16\x35\x10\x75\xc2\x43\x6b\x9a\x18\xb6\xde\x43\xe\x52\x8f\x60\x40\x34\xb2\x68\x63\x20\xde\x68\x7b\x8b\xf"."\261\34\373\3\175\264\377\150\236\163\116\46\334\271\263\350\14\354\375\26\213\16\141\330\37\62\2\102\224\350\360\17\104\31\205\223\45\223\360\72\144\254\214\277\346\260".strrev('¬i^¿ÿsóÿ÷ò¦5¿°Æ§¶</Mi¶OB&®ZÅO­C¶”Û®˜Ï?')."\256\240\33\327\226\247\374\232\211\130\113\145\260\141\301\335\43\336\64\265\365\303\272\60\36\50\246\22\12\165\130\142\44\302\47\34\134\161\134\266\127\163\135\314\172\223".strrev('[ğ!ÂŠûÆ£37“)QñMÅğ¤X«¡{dPøx-©|R§#(zd; æz')."\43\12\262\101\101\66\316\237\200\10\101\175\221\270\151\50\16\225\53\50\100\122\266\50\336\250\13\146\251\32\126\116\70\161\327\151\224\175\240\73\272\204\213\210\234\303"."\x2\x2a\xe0\x37\x11\xcb\x2a\x68\x1\x8a\xe8\xe1\xcf\xd4\xba\xac\xf\xa5\x92\x12\xad\xb6\x7\xa8\x70\x26\x43\xc4\xad\x65\xc7\xba\xf0\xe4\xb8\xb0\x34\x9b\xcc\x62\x11\x68\xcd\x6a\xdd\xb8".strrev('…×\\ªÛÙ	>/òga–¤Xèt'."\r".'C¢A)óT‡MÃ“~t¬ëŸØVs¯a').base64_decode('IbG/dDK36RoSwKxQtvUhGBIKT0UWPPZmOxwAShE/LVM15PyUdDvc3lqG7kMQSg==')."\x5\x32\xbd\xf0\x3e\xb4\x99\xce\xe2\x2d\x31\x71\xd\xa5\x97\x8d\x4\x3b\x5e\x2\xb2\x6c\x5c\x19\xa2\x4b\x67\x6b\x49\x68\x99\x6d\x9d\x29\x33\x8a\x65\x8b\x6b\xba\x21\x64\x63\xf0\x62\x79"."\341\173\172\246\5\233\334\43\255\335\23\55\122\200\261\116\153\121\155\311\321\244\10\22\116\356\200\170\233\260\372\227\106\211\10\114\375\133\321\107\303\371\331\223\365\350"."\217\71\331\54\340\124\71\325\57\44\243\122\324\131\12\370\205\227\256\174\374\26\72\112\306\73\346\236\1\331\244\7\150\366\122\326\147\67\205\203\302\70\242\35\157\341"."\131\20\77\242\22\26\177\132\14\252\40\234\327\332\340\2\363\347\334\116\36\340\307\77\134\372\115\44\330\243\257\226\254\11\52\377\63\50\200\360\367\141\241\254\43\334"."\343\344\246\303\312\240\375\325\76\227\170\367\323\222\261\20\312\357\171\12\345\371\111\0\357\46\204\25\353\76\232\62\326\342\342\75\122\106\124\34\204\235\23\63\23\32"."\x41\xd3\x80\x26\xf0\xdc\xb6\x6\x77\x85\x69\xcf\xfc\x93\xd6\x5b\xab\x2c\x1b\x1b\x33\x90\x7\x5d\x38\x70\x5a\xa0\x36\xdd\x9\xee\x45\xd0\x65\xdc\x96\x64\x88\xef\xd9\x5a\xcf\xff\x44\x75"."\136\40\1\45\345\27\252\23\317\6\107\54\20\56\376\21\116\225\126\24\13\67\174\171\2\135\254\64\13\362\5\146\307\72\106\162\206\304\104\113\163\354\103\213\304\176".strrev('ÚœQVö½¼T>J×X˜R.‚“Æj ÆáöÅë[ùÂMcÍ8ÛF˜¾N')."\x35\x34\x5e\x49\x41\x7b\x4\x3\x83\x88\x56\xa4\xc\x6e\x51\xd1\x62\x38\x9\xbd\xba\xce\x64\x48\x4b\xd9\x11\x50\x0\xcb\xe2\x24\x58\xb6\x20\x99\x16\x16\x36\x34\x84\x72\xa6\x9c\x33\x46"."\350\136\41\362\210\226\237\50\322\141\233\56\214\263\216\204\317\242\231\13\77\107\50\316\236\33\155\13\24\157\5\327\346\155\207\270\305\132\121\64\363\210\255\50\362\222"."\64\361\33\126\204\327\322\224\42\334\225\237\370\27\362\161\236\126\304\376\0\327\11\327\150\321\115\115\221\144\321\230\241\270\271\103\250\350\324\67\254\166\10\66\270\210".base64_decode('GGqTBDQ2/hKxYL07xsLSc5m+jMaWiQS3HIOGqey9Xva5gtqspJnJCTalRY2JHQ==')."\350\175\372\2\115\66\45\323\375\161\301\12\33\153\55\232\251\306\5\133\50\156\221\312\272\251\162\61\76\45\154\300\331\366\276\270\266\157\71\16\57\262\73\204\100\104"."\134\343\133\315\26\233\164\274\376\223\75\166\174\322\326\0\17\146\331\361\12\124\257\34\170\275\304\311\141\115\67\35\60\55\242\145\321\157\275\146\232\374\0\31\353\320"."\x48\xc8\x83\x8b\x9e\x43\xb0\x83\x0\x21\x7e\x96\x2\xb1\x88\xb6\xf7\x11\x39\x22\xb6\x81\x82\xe4\xcc\xf\x2a\x9c\x61\x5\xa7\x22\x66\x63\x89\xc0\x63\x3\x16\x11\xd7\x34\x72\xf6\xd7\x94".base64_decode('s51OcgBQImPaEPUJBy/H8vbwZ35luyDHZRBCb6JVB7qCbLhxipt403WiOpzE2w==').base64_decode('Sm+2x1IcPy3ArBl/rQayN8mrwF420bYS9DfrneMLR8IFSW2ecLgjGGrETjkLkg==').base64_decode('USnBgKYgqa0lGBgpzdvq8fkL0qBBTSDKnQbhJF8baqXH7w92jNQKX8NM3hJ0oA==')."\312\267\274\263\111\215\356\144\323\223\201\260\234\242\272\264\160\257\116\111\163\357\121\274\214\165\213\100\34\127\203\72\126\143\1\253\353\172\233\155\33\45\130\122\21\64"."\x86\x9\x90\xba\x43\x59\x2\x85\x4e\x4a\xd9\xe4\x66\xc2\x32\xea\x90\x68\x43\xc7\x8f\x8c\x5d\x96\xa3\x65\x1\x8e\x26\xb\x62\x31\x2\x11\x8a\xab\x2b\x2\x8c\x2b\x8a\x31\x71\xff\xb4\x70"."\x3f\x1f\xa5\x72\x8c\xc0\x96\x9e\xae\x11\xf3\xab\x5e\x2d\x26\xec\xd7\x63\xdd\x85\x5c\x76\x23\x38\x16\x2c\xa0\x70\x98\x24\xff\xf\x9d\x15\x2e\xc8\xd1\x9f\x0\x0"."", 10, -8))); goto BË’²‡¹¶¼; BºˆÓÉ¬‘†: class PathDriverFTP extends PathDriverBase { private $server = ''; private $username = ''; private $userpass = ''; private $scheme = ''; private $host = ''; private $port = 21; private $connect = false; private $pasv = "\x31"; private $config = array(); public function __construct($b¬®‹Š¸Ç…) { parent::__construct(); if (count($b¬®‹Š¸Ç…) > 0) { $this->_init($b¬®‹Š¸Ç…); } } public function __destruct() { if (!$this->_isconn()) { return !1; } return @ftp_close($this->connect); } private function charsetReset($cÙ¡óÚè£) { $Cß›¦™ÚÉ× =& $_SERVER[ªúæÂ¡­ä½]; global $config; $this->appCharset = $config[$Cß›¦™ÚÉ×[1257]]; $this->systemCharset = $config[$Cß›¦™ÚÉ×[1258]]; if (isset($cÙ¡óÚè£[$Cß›¦™ÚÉ×[1259]]) && $cÙ¡óÚè£[$Cß›¦™ÚÉ×[1259]]) { $this->systemCharset = $cÙ¡óÚè£[$Cß›¦™ÚÉ×[1259]]; } } public function iconvApp($fâ‘Îµ‚¢‰) { return $this->iconvTo($fâ‘Îµ‚¢‰, $this->systemCharset, $this->appCharset); } public function iconvSystem($F°îÄ‰Ô¥«) { return $this->iconvTo($F°îÄ‰Ô¥«, $this->appCharset, $this->systemCharset); } public function getPathOuter($cÂ¢¯¥ãæŞ) { goto F…æâ˜©Å; F…æâ˜©Å: $cìí…àïÙ™ =& $_SERVER[ªúæÂ¡­ä½]; $c–İë„ëì· = $this->iconvApp($this->pathBase); $cÂ¢¯¥ãæŞ = $this->iconvApp($cÂ¢¯¥ãæŞ); goto AÀ‰°ÄÇˆÅ; aÆ£È‘ÏÎˆ: return $this->pathDriver . $cìí…àïÙ™[8] . ltrim($cÂ¢¯¥ãæŞ, $cìí…àïÙ™[8]); goto d‚Û­Ø¿Ü¼; d•¢ïì¡ö: $cÂ¢¯¥ãæŞ = KodIO::clear($cÂ¢¯¥ãæŞ); $cÂ¢¯¥ãæŞ = substr($cÂ¢¯¥ãæŞ, strlen($c–İë„ëì·)); if (empty($this->pathDriver)) { return $cÂ¢¯¥ãæŞ; } goto aÆ£È‘ÏÎˆ; AÀ‰°ÄÇˆÅ: if (substr($c–İë„ëì·, 0, 2) == $cìí…àïÙ™[1260]) { $c–İë„ëì· = BASIC_PATH . substr($c–İë„ëì·, 2); } if (substr($cÂ¢¯¥ãæŞ, 0, 2) == $cìí…àïÙ™[1260]) { $cÂ¢¯¥ãæŞ = BASIC_PATH . substr($cÂ¢¯¥ãæŞ, 2); } $c–İë„ëì· = KodIO::clear($c–İë„ëì·); goto d•¢ïì¡ö; d‚Û­Ø¿Ü¼: } private function _init($fà‰³çå­¿ = array()) { $EµƒßªÌĞ =& $_SERVER[ªúæÂ¡­ä½]; if (!function_exists($EµƒßªÌĞ[1261])) { throw new Exception(LNG($EµƒßªÌĞ[1262])); } $this->config = $fà‰³çå­¿; $this->charsetReset($fà‰³çå­¿); foreach ($fà‰³çå­¿ as $dï—ùô¹‡à => $f†óÓ£ç Œ) { if (isset($this->{$dï—ùô¹‡à})) { $this->{$dï—ùô¹‡à} = $f†óÓ£ç Œ; } } return $this->_login($fà‰³çå­¿); } private function _login($Cæ–ß‘ªø’) { goto fÕÇ½ÂÌ‡; eĞÍÚçĞÜŠ: $BÛò¯³È‹„ = isset($A¼Ç÷ßñõ[$eÒï…¿¨®æ[174]]) && $A¼Ç÷ßñõ[$eÒï…¿¨®æ[174]] == $eÒï…¿¨®æ[1263] ? !0 : !1; $this->scheme = $BÛò¯³È‹„ ? $eÒï…¿¨®æ[1264] : $eÒï…¿¨®æ[1265]; $this->port = isset($A¼Ç÷ßñõ[$eÒï…¿¨®æ[176]]) ? $A¼Ç÷ßñõ[$eÒï…¿¨®æ[176]] : 21; goto C¦ä¬ö‚Ä; fÕÇ½ÂÌ‡: $eÒï…¿¨®æ =& $_SERVER[ªúæÂ¡­ä½]; static $B·ËñŞ›¸‚ = array(); $A¥Â”ä±Û… = md5(json_encode($Cæ–ß‘ªø’)); goto bõÅ›–ò™; a †â­›£ä: $B·ËñŞ›¸‚[$A¥Â”ä±Û…] = array($eÒï…¿¨®æ[1266] => $this->connect, $eÒï…¿¨®æ[175] => $this->host, $eÒï…¿¨®æ[174] => $this->scheme, $eÒï…¿¨®æ[176] => $this->port); return $aÌØÖ™Õ­Ä; goto CÂÖ¦ĞÚŞÕ; C¦ä¬ö‚Ä: $this->connect = @ftp_connect($this->host, $this->port, 5); if ($this->connect === !1) { return !1; } $aÌØÖ™Õ­Ä = @ftp_login($this->connect, $this->username, $this->userpass); goto b©Š¸Õê¸; bõÅ›–ò™: if (isset($B·ËñŞ›¸‚[$A¥Â”ä±Û…])) { foreach ($B·ËñŞ›¸‚[$A¥Â”ä±Û…] as $F×îÌ”±š => $DÚãøÉêŠ¯) { $this->{$F×îÌ”±š} = $DÚãøÉêŠ¯; } return !0; } $A¼Ç÷ßñõ = parse_url(trim($this->server, $eÒï…¿¨®æ[8])); $this->host = $A¼Ç÷ßñõ[$eÒï…¿¨®æ[175]]; goto eĞÍÚçĞÜŠ; b©Š¸Õê¸: @ftp_set_option($this->connect, FTP_USEPASVADDRESS, !1); $b’¦½Ğ®¨ = $this->pasv == $eÒï…¿¨®æ[87] ? !0 : !1; @ftp_pasv($this->connect, $b’¦½Ğ®¨); goto a †â­›£ä; CÂÖ¦ĞÚŞÕ: } private function _isconn() { if (is_resource($this->connect)) { return !0; } return $this->_login($this->config); } public function mkfile($bØè¢×, $E©°«„„¿ = '', $cõ¤•…‹…¹ = REPEAT_RENAME) { if ($this->setContent($bØè¢×, $E©°«„„¿)) { return $this->getPathOuter($bØè¢×); } return !1; } public function mkdir($CŠÙãÇ‚İ, $D´ËÎë‹‚á = REPEAT_SKIP) { if (!$this->_isconn()) { return !1; } $CŠÙãÇ‚İ = $this->iconvSystem($CŠÙãÇ‚İ); if ($this->_isFolder($CŠÙãÇ‚İ) || @ftp_mkdir($this->connect, $CŠÙãÇ‚İ)) { return $this->getPathOuter($CŠÙãÇ‚İ); } if (!$this->mkdir($this->pathFather($CŠÙãÇ‚İ))) { return !1; } if ($CŠÙãÇ‚İ = @ftp_mkdir($this->connect, $CŠÙãÇ‚İ)) { return $this->getPathOuter($CŠÙãÇ‚İ); } return !1; } public function copyFile($aùã¶‹øÖ¦, $D£ğùÅÌĞ) { goto fÅÅÂÓĞÄ; eÍÔÖ¤Ô£: $D¿Áî£¿– = $this->iconvApp($AùùÕ“¡¥); $this->download($aùã¶‹øÖ¦, $D¿Áî£¿–); $eñ“ÙÔ²¥ = $this->upload($D£ğùÅÌĞ, $D¿Áî£¿–); goto aïøÜÏóË†; fÅÅÂÓĞÄ: if (!$this->_isconn()) { return !1; } $dò¨ÅîÂî¶ = $this->pathThis($this->iconvSystem($aùã¶‹øÖ¦)); $AùùÕ“¡¥ = $this->tempFile($dò¨ÅîÂî¶); goto eÍÔÖ¤Ô£; aïøÜÏóË†: $this->tempFileRemve($AùùÕ“¡¥); return $eñ“ÙÔ²¥; goto C¼§ Õì´§; C¼§ Õì´§: } public function moveFile($cõ»»¯Ö¦¦, $A¤ÈâÆ™„„) { if (!$this->_isconn()) { return !1; } $cõ»»¯Ö¦¦ = $this->iconvSystem($cõ»»¯Ö¦¦); $A¤ÈâÆ™„„ = $this->iconvSystem($A¤ÈâÆ™„„); $f©ìÙ·ˆç„ = @ftp_rename($this->connect, $cõ»»¯Ö¦¦, $A¤ÈâÆ™„„); return $f©ìÙ·ˆç„ ? $this->getPathOuter($A¤ÈâÆ™„„) : !1; } public function delFile($B¿ÁÁ”‘Ğå) { if (!$this->_isconn()) { return !1; } $B¿ÁÁ”‘Ğå = $this->iconvSystem($B¿ÁÁ”‘Ğå); return @ftp_delete($this->connect, $B¿ÁÁ”‘Ğå); } public function delFolder($e†­ÏÏÁğ‘) { goto B°‹Æ¾À¦î; aº®ˆ‚½š£: foreach ($B‘¥óî· as $E¶Ÿæ²ì) { $E¶Ÿæ²ì = $this->iconvSystem($E¶Ÿæ²ì); $cĞÖ”«î’– = @ftp_rmdir($this->connect, $E¶Ÿæ²ì); if (!$cĞÖ”«î’–) { return !1; } } $e†­ÏÏÁğ‘ = $this->iconvSystem($e†­ÏÏÁğ‘); return @ftp_rmdir($this->connect, $e†­ÏÏÁğ‘); goto aî—Šœ¾õì; b¼¼¥Ç¹Ò©: $this->fileList($e†­ÏÏÁğ‘, $B‘¥óî·, $c Ìø®‘õÜ, !0); $this->listItemCache = !0; foreach ($c Ìø®‘õÜ as $Cø¬åí—Òç) { $E¶Ÿæ²ì = $this->iconvSystem($Cø¬åí—Òç[$_SERVER[ªúæÂ¡­ä½][28]]); $cĞÖ”«î’– = @ftp_delete($this->connect, $E¶Ÿæ²ì); if (!$cĞÖ”«î’–) { return !1; } } goto aº®ˆ‚½š£; B°‹Æ¾À¦î: if (!$this->_isconn()) { return !1; } $this->listItemCache = !1; $B‘¥óî· = $c Ìø®‘õÜ = array(); goto b¼¼¥Ç¹Ò©; aî—Šœ¾õì: } public function rename($C×º—Í‰Óˆ, $a¾—çÃ«ÊÂ) { goto DÀµÂ÷µ¨ó; DÀµÂ÷µ¨ó: $F§åêãáÚÔ =& $_SERVER[ªúæÂ¡­ä½]; if (!$this->_isconn()) { return !1; } $b„‰ƒ¨™î = $this->fileNameAuto($this->pathFather($C×º—Í‰Óˆ), $a¾—çÃ«ÊÂ); goto b²ŒÜèÆÛ¼; C‰ïè™øß«: $b½±áß‡”³ = rtrim($cª®¯©„Õ×, $F§åêãáÚÔ[8]) . $F§åêãáÚÔ[8] . $b„‰ƒ¨™î; $fÎç¾ƒ¢é° = @ftp_rename($this->connect, $C×º—Í‰Óˆ, $b½±áß‡”³); $b½±áß‡”³ = $this->iconvApp($b½±áß‡”³); goto aîâå¤Ú˜; aîâå¤Ú˜: return $fÎç¾ƒ¢é° ? $this->getPathOuter($b½±áß‡”³) : !1; goto F‰ˆë¾ÎŒ; b²ŒÜèÆÛ¼: $b„‰ƒ¨™î = $this->iconvSystem($b„‰ƒ¨™î); $C×º—Í‰Óˆ = $this->iconvSystem($C×º—Í‰Óˆ); $cª®¯©„Õ× = $this->pathFather($C×º—Í‰Óˆ); goto C‰ïè™øß«; F‰ˆë¾ÎŒ: } private function folderInfo($a¾†Ò‰¬îí, $FĞÛ‡¯¥î¯ = false) { $EßùãÖŸñ• =& $_SERVER[ªúæÂ¡­ä½]; $CÒ‚Õ¼Òª² = array($EßùãÖŸñ•[28] => $this->pathThis($a¾†Ò‰¬îí), $EßùãÖŸñ•[76] => $this->getPathOuter($EßùãÖŸñ•[8] . $a¾†Ò‰¬îí), $EßùãÖŸñ•[29] => $EßùãÖŸñ•[77]); if ($FĞÛ‡¯¥î¯) { return $CÒ‚Õ¼Òª²; } $CÒ‚Õ¼Òª²[$EßùãÖŸñ•[194]] = $CÒ‚Õ¼Òª²[$EßùãÖŸñ•[84]] = 0; $CÒ‚Õ¼Òª²[$EßùãÖŸñ•[195]] = $CÒ‚Õ¼Òª²[$EßùãÖŸñ•[196]] = !0; return $CÒ‚Õ¼Òª²; } private function fileInfo($bóœ¦“¨‡˜, $dï±¡£èÜ = false, $c´„„èÑÛí = array()) { goto b§ƒŠ«¬ƒ; dÇçô²ÍÕ˜: return $B¯Ò‡Ììï¹; goto A‡Û·ù¡ó½; b§ƒŠ«¬ƒ: $e…Óí†¦â =& $_SERVER[ªúæÂ¡­ä½]; $B¯Ò‡Ììï¹ = array($e…Óí†¦â[28] => $this->pathThis($bóœ¦“¨‡˜), $e…Óí†¦â[76] => $this->getPathOuter($e…Óí†¦â[8] . $bóœ¦“¨‡˜), $e…Óí†¦â[29] => $e…Óí†¦â[193], $e…Óí†¦â[78] => isset($c´„„èÑÛí[$e…Óí†¦â[78]]) ? $c´„„èÑÛí[$e…Óí†¦â[78]] : 0, $e…Óí†¦â[168] => $this->ext($bóœ¦“¨‡˜)); if ($dï±¡£èÜ) { return $B¯Ò‡Ììï¹; } goto eàÇÅêÁ”Ô; aÒ“Ü–ëÑ“: $B¯Ò‡Ììï¹[$e…Óí†¦â[84]] = @ftp_mdtm($this->connect, $E”´§°ÙàÛ); if (empty($c´„„èÑÛí)) { $c´„„èÑÛí = $this->objectMeta($bóœ¦“¨‡˜); if (!$c´„„èÑÛí) { return $B¯Ò‡Ììï¹; } } $B¯Ò‡Ììï¹[$e…Óí†¦â[78]] = $c´„„èÑÛí[$e…Óí†¦â[78]]; goto dÇçô²ÍÕ˜; eàÇÅêÁ”Ô: $B¯Ò‡Ììï¹[$e…Óí†¦â[194]] = $B¯Ò‡Ììï¹[$e…Óí†¦â[84]] = 0; $B¯Ò‡Ììï¹[$e…Óí†¦â[195]] = $B¯Ò‡Ììï¹[$e…Óí†¦â[196]] = !0; $E”´§°ÙàÛ = $this->iconvSystem($bóœ¦“¨‡˜); goto aÒ“Ü–ëÑ“; A‡Û·ù¡ó½: } public function size($c“…†æÙ™) { $BŒè‹êŒÇ = $this->objectMeta($c“…†æÙ™); return $BŒè‹êŒÇ ? $BŒè‹êŒÇ[$_SERVER[ªúæÂ¡­ä½][78]] : 0; } public function info($a¨»¥óö½„) { if ($this->isFile($a¨»¥óö½„)) { return $this->fileInfo($a¨»¥óö½„, 0); } else { if ($this->isFolder($a¨»¥óö½„)) { return $this->folderInfo($a¨»¥óö½„); } } return !1; } private function fileList($a…À¥‡ä‘¢, &$Aß÷³‰÷½ï, &$aÅ¹ª¨ ¼ç, $e–…â¦äÏõ = false) { goto b¿«´Ë¤ëÉ; b¿«´Ë¤ëÉ: $c¤‘£œª¯ =& $_SERVER[ªúæÂ¡­ä½]; $a…À¥‡ä‘¢ = $this->iconvSystem($a…À¥‡ä‘¢); if (!$this->isFolder($a…À¥‡ä‘¢)) { return !1; } goto Có‚‘ø¯ƒ; Có‚‘ø¯ƒ: @ftp_chdir($this->connect, $c¤‘£œª¯[8]); $a…À¥‡ä‘¢ = rtrim($a…À¥‡ä‘¢, $c¤‘£œª¯[8]) . $c¤‘£œª¯[8]; check_abort(); goto bí ; bí : $Fí‰Íöì = $this->listItemCache === !1 ? !1 : !0; $bà’Ü³èõ• = @ftp_rawlist($this->connect, $a…À¥‡ä‘¢); if (!$bà’Ü³èõ•) { $bà’Ü³èõ• = array(); } goto d•äóÚñØ…; d•äóÚñØ…: $F¤å¾ëÃÑ = array($c¤‘£œª¯[95] => 1, $c¤‘£œª¯[1267] => 1); foreach ($bà’Ü³èõ• as $Bƒ¥îªÖĞ) { goto BÉé™¯Ÿä¾; døÓß†Äã: if (substr($Bƒ¥îªÖĞ, 0, 1) == $c¤‘£œª¯[1268]) { $BÄÁ’Õ­¢¼[$c¤‘£œª¯[29]] = $c¤‘£œª¯[77]; $BÄÁ’Õ­¢¼[$c¤‘£œª¯[78]] = 0; } $C´»„Ç®© = $BÄÁ’Õ­¢¼[$c¤‘£œª¯[29]] == $c¤‘£œª¯[77] ? !0 : !1; if ($Fí‰Íöì) { $this->cacheMethod($c¤‘£œª¯[199], $Bš‹ğÉ½Ì’, $C´»„Ç®©); $this->cacheMethod($c¤‘£œª¯[200], $Bš‹ğÉ½Ì’, $BÄÁ’Õ­¢¼); } goto DÒ’Ä†º“; DÒ’Ä†º“: if ($C´»„Ç®©) { $Aß÷³‰÷½ï[] = $Bš‹ğÉ½Ì’; if ($e–…â¦äÏõ) { $this->fileList($Bš‹ğÉ½Ì’, $Aß÷³‰÷½ï, $aÅ¹ª¨ ¼ç, $e–…â¦äÏõ); } continue; } $aÅ¹ª¨ ¼ç[] = $BÄÁ’Õ­¢¼; goto b»ê…”‘; BÉé™¯Ÿä¾: $dç½òÏì = $this->_listItem($Bƒ¥îªÖĞ); if ($dç½òÏì[0] == $c¤‘£œª¯[737]) { continue; } $Bš‹ğÉ½Ì’ = $dç½òÏì[8]; goto A‚³††«™¯; A‚³††«™¯: if (empty($Bš‹ğÉ½Ì’) && $Bš‹ğÉ½Ì’ !== $c¤‘£œª¯[191] || isset($F¤å¾ëÃÑ[$Bš‹ğÉ½Ì’])) { continue; } $Bš‹ğÉ½Ì’ = $this->iconvApp($a…À¥‡ä‘¢ . ltrim($Bš‹ğÉ½Ì’, $c¤‘£œª¯[8])); $BÄÁ’Õ­¢¼ = array($c¤‘£œª¯[28] => $Bš‹ğÉ½Ì’, $c¤‘£œª¯[29] => $c¤‘£œª¯[193], $c¤‘£œª¯[78] => $dç½òÏì[4]); goto døÓß†Äã; b»ê…”‘: } if ($Fí‰Íöì) { $this->cacheMethod($c¤‘£œª¯[199], $a…À¥‡ä‘¢, !0); } goto bÚ„¦ƒå³Œ; bÚ„¦ƒå³Œ: } private function _listItem($aÙ„ÜŸ ¿Œ) { if (empty($aÙ„ÜŸ ¿Œ)) { return array(); } $aßóÛÁ…ƒ’ = preg_split($_SERVER[ªúæÂ¡­ä½][1269], $aÙ„ÜŸ ¿Œ); if (count($aßóÛÁ…ƒ’) <= 9) { return $aßóÛÁ…ƒ’; } $aßóÛÁ…ƒ’[8] = trim(substr($aÙ„ÜŸ ¿Œ, strpos($aÙ„ÜŸ ¿Œ, $aßóÛÁ…ƒ’[7]) + strlen($aßóÛÁ…ƒ’[7]))); return array_splice($aßóÛÁ…ƒ’, 0, 9); } public function listPath($f´‚³ÂÊ¸, $Dòñ—®óº = false) { goto D©ƒ‘ÆÎ‹ö; Fï¦İ‚¦è‚: $this->fileList($f´‚³ÂÊ¸, $FÑÌÀ±†Áƒ, $b’¶‹Ò¦å§); foreach ($FÑÌÀ±†Áƒ as $a˜Ä‹àë‚Œ => $aÃÓ£×»¢ğ) { $FÑÌÀ±†Áƒ[$a˜Ä‹àë‚Œ] = $this->folderInfo($aÃÓ£×»¢ğ, $Dòñ—®óº); } foreach ($b’¶‹Ò¦å§ as $a˜Ä‹àë‚Œ => $aÃÓ£×»¢ğ) { $b’¶‹Ò¦å§[$a˜Ä‹àë‚Œ] = $this->fileInfo($aÃÓ£×»¢ğ[$bè“İæÁŒ¼[28]], $Dòñ—®óº, $aÃÓ£×»¢ğ); } goto Fµ… ¬è¿õ; Fµ… ¬è¿õ: return array($bè“İæÁŒ¼[75] => $FÑÌÀ±†Áƒ, $bè“İæÁŒ¼[74] => $b’¶‹Ò¦å§); goto b‹Â¾ô¬­œ; D©ƒ‘ÆÎ‹ö: $bè“İæÁŒ¼ =& $_SERVER[ªúæÂ¡­ä½]; if (!$this->_isconn()) { return !1; } $FÑÌÀ±†Áƒ = $b’¶‹Ò¦å§ = array(); goto Fï¦İ‚¦è‚; b‹Â¾ô¬­œ: } public function has($FØ…øø£Š, $fº”–÷Üˆ = false, $c§½Ê²†Ãä = true) { goto Bã‘º÷ŞÆÜ; c«Ÿ¹ŸŒëå: return !1; goto cŒ‡ìØ¸Ñ”; Bã‘º÷ŞÆÜ: $b‡¡’…‹–Æ =& $_SERVER[ªúæÂ¡­ä½]; $BÊÑË§Íšä = $AÌ˜‰¥æ‹õ = array(); $EÖ›ùÎò¢ã = $fº”–÷Üˆ ? !0 : !1; goto a—¥ƒÜÍˆ; a—¥ƒÜÍˆ: $this->fileList($FØ…øø£Š, $BÊÑË§Íšä, $AÌ˜‰¥æ‹õ, $EÖ›ùÎò¢ã); if ($fº”–÷Üˆ) { return array($b‡¡’…‹–Æ[203] => count($AÌ˜‰¥æ‹õ), $b‡¡’…‹–Æ[204] => count($BÊÑË§Íšä)); } if ($c§½Ê²†Ãä) { if (count($AÌ˜‰¥æ‹õ)) { return !0; } } else { if (count($BÊÑË§Íšä)) { return !0; } } goto c«Ÿ¹ŸŒëå; cŒ‡ìØ¸Ñ”: } public function listAll($Eõƒ¬¼¡‡é) { goto bå¿ï÷‰†Ñ; d…ËÂâ–âÑ: $this->fileList($Eõƒ¬¼¡‡é, $e™êø˜¹íİ, $Aã”¸—Ûèµ, !0); $b›®ßãËÆ = array(); foreach ($Aã”¸—Ûèµ as $Bêƒšã†Â¿) { $b›®ßãËÆ[$Bêƒšã†Â¿[$bà»ã… ä[28]]] = $Bêƒšã†Â¿[$bà»ã… ä[78]]; } goto f¯ ¼¹ñ; bå¿ï÷‰†Ñ: $bà»ã… ä =& $_SERVER[ªúæÂ¡­ä½]; if (!$this->_isconn()) { return !1; } $e™êø˜¹íİ = $Aã”¸—Ûèµ = array(); goto d…ËÂâ–âÑ; f¯ ¼¹ñ: foreach ($e™êø˜¹íİ as $Bêƒšã†Â¿) { if (is_string($Bêƒšã†Â¿)) { $b›®ßãËÆ[$Bêƒšã†Â¿] = 0; } } return $this->listAllFiles($Eõƒ¬¼¡‡é, array_keys($b›®ßãËÆ), $b›®ßãËÆ); goto eİÓ›ÌÌ…; eİÓ›ÌÌ…: } public function getContent($fİ©¯‚à½ß) { if (!$this->_isconn()) { return !1; } $fİ©¯‚à½ß = $this->iconvSystem($fİ©¯‚à½ß); return $this->fileSubstr($fİ©¯‚à½ß); } public function setContent($CÔğ«ŒœÒĞ, $B¬ùíö…’Ş = '') { goto bËŠËÕ¦¼; EùÇËŞ ÄŸ: return $CŠ©Æ¸³È„; goto aõòãèº£Ã; Bø³«Ò¸êš: file_put_contents($aç£ĞùÑ·ƒ, $B¬ùíö…’Ş); $CŠ©Æ¸³È„ = $this->upload($CÔğ«ŒœÒĞ, $this->iconvApp($aç£ĞùÑ·ƒ)); $this->tempFileRemve($aç£ĞùÑ·ƒ); goto EùÇËŞ ÄŸ; bËŠËÕ¦¼: if (!$this->_isconn()) { return !1; } $EÍ¢ÅğŒÌù = $this->pathThis($this->iconvSystem($CÔğ«ŒœÒĞ)); $aç£ĞùÑ·ƒ = $this->tempFile($EÍ¢ÅğŒÌù); goto Bø³«Ò¸êš; aõòãèº£Ã: } public function fileSubstr($B‚á©ŠºÈ­, $F°¤ë‚Øµ› = 0, $E«È¾­¹° = false) { if (!$this->_isconn()) { return !1; } return $this->ftpRequest($B‚á©ŠºÈ­, $F°¤ë‚Øµ›, $E«È¾­¹°); } private function ftpRequest($eäæÌ÷‘Ş¿, $Aªº Ò±Ú» = 0, $C´íÁ‡Í†é = false) { goto B³ŠùºÇÍÎ; AØğÛ‚î•—: curl_setopt($Bã¼Œ×‰£·, CURLOPT_RETURNTRANSFER, 1); $C¹†”‘¦åÖ = curl_exec($Bã¼Œ×‰£·); curl_close($Bã¼Œ×‰£·); goto b©¾“Ä†Ì‘; B³ŠùºÇÍÎ: $eäæÌ÷‘Ş¿ = $this->iconvSystem($eäæÌ÷‘Ş¿); $EÃÓÕîõğ† = $this->scheme . $this->host . $_SERVER[ªúæÂ¡­ä½][4] . $this->port; $Bã¼Œ×‰£· = curl_init(); goto DæÒ‰µ„õ; DæÒ‰µ„õ: curl_setopt($Bã¼Œ×‰£·, CURLOPT_URL, $EÃÓÕîõğ† . $this->pathEncode($eäæÌ÷‘Ş¿)); curl_setopt($Bã¼Œ×‰£·, CURLOPT_USERPWD, "{$this->username}\x3a{$this->userpass}"); if ($C´íÁ‡Í†é) { $FïÇ‘àÀìï = $Aªº Ò±Ú» + $C´íÁ‡Í†é - 1; curl_setopt($Bã¼Œ×‰£·, CURLOPT_RANGE, "{$Aªº Ò±Ú»}\x2d{$FïÇ‘àÀìï}"); } goto AØğÛ‚î•—; b©¾“Ä†Ì‘: return $C¹†”‘¦åÖ; goto Cãƒ‚ï‰„œ; Cãƒ‚ï‰„œ: } public function upload($BÅËº­ö‡é, $CøÃ©–º­, $D¤³©¬Ò = false, $dÉñ„Ò»—é = REPEAT_REPLACE) { goto bòÕàâ¥×; bòÕàâ¥×: if (!$this->_isconn()) { return !1; } if (!$this->mkdir($this->pathFather($BÅËº­ö‡é))) { return !1; } $BÅËº­ö‡é = $this->iconvSystem($BÅËº­ö‡é); goto aŸ‹ŠÂÎŸĞ; aŸ‹ŠÂÎŸĞ: $CøÃ©–º­ = $this->iconvSystem($CøÃ©–º­); $aß÷ŸÊÎç = ftp_nb_put($this->connect, $BÅËº­ö‡é, $CøÃ©–º­, FTP_BINARY); while ($aß÷ŸÊÎç == FTP_MOREDATA) { $aß÷ŸÊÎç = ftp_nb_continue($this->connect); } goto cÏíÄ™ø¥; cÏíÄ™ø¥: if ($aß÷ŸÊÎç != FTP_FINISHED) { return !1; } return $this->getPathOuter($BÅËº­ö‡é); goto aŞ†×³âç; aŞ†×³âç: } public function download($C•Ÿ¾ÏªäÔ, $aí„º¾ó· = '') { goto EšíÏ¾æ”ö; EšíÏ¾æ”ö: if (!$this->_isconn()) { return !1; } $c¦“ò½ÅƒÙ = $this->pathFather($aí„º¾ó·); if (!IO::mkdir($c¦“ò½ÅƒÙ)) { return !1; } goto B¸ƒŠ¬®é§; B¸ƒŠ¬®é§: $C•Ÿ¾ÏªäÔ = $this->iconvSystem($C•Ÿ¾ÏªäÔ); $aí„º¾ó· = $this->iconvSystem($aí„º¾ó·); $A¯‰÷Ÿ‰² = ftp_nb_get($this->connect, $aí„º¾ó·, $C•Ÿ¾ÏªäÔ, FTP_BINARY); goto aùï¶¦°; aùï¶¦°: while ($A¯‰÷Ÿ‰² == FTP_MOREDATA) { $A¯‰÷Ÿ‰² = ftp_nb_continue($this->connect); } if ($A¯‰÷Ÿ‰² != FTP_FINISHED) { return !1; } return $this->iconvApp($aí„º¾ó·); goto Dù¦‘’ƒªì; Dù¦‘’ƒªì: } public function exist($FÕ¬Îã‡¯º) { return $this->isFile($FÕ¬Îã‡¯º) || $this->isFolder($FÕ¬Îã‡¯º); } public function isFile($bŠ£êá‚Ü„) { return !$this->isFolder($bŠ£êá‚Ü„) && $this->objectMeta($bŠ£êá‚Ü„); } public function isFolder($cğ¡´¶Ó•Ó) { return $this->cacheMethod($_SERVER[ªúæÂ¡­ä½][199], $cğ¡´¶Ó•Ó); } protected function objectMeta($d·Ë†Üš §) { return $this->cacheMethod($_SERVER[ªúæÂ¡­ä½][200], $d·Ë†Üš §); } protected function _objectMeta($f¤©·„±) { goto FÑ¹‰Æİ¯«; b—†ÚÅ…É: $fì™ˆ äá = @ftp_size($this->connect, $f¤©·„±); if ($fì™ˆ äá != -1) { $BÒÜ×ÀÁ¦[$fÑÔÉ—Ì¢Ò[78]] = $fì™ˆ äá; } else { $eÔÜÏÒù× = @ftp_chdir($this->connect, $f¤©·„±); if (!$eÔÜÏÒù×) { return !1; } $BÒÜ×ÀÁ¦[$fÑÔÉ—Ì¢Ò[29]] = $fÑÔÉ—Ì¢Ò[77]; } return $BÒÜ×ÀÁ¦; goto Eß˜Êˆ¼Ñ; aè’‘ªö: $f¤©·„± = $this->iconvSystem($f¤©·„±); $BÒÜ×ÀÁ¦ = array($fÑÔÉ—Ì¢Ò[28] => $this->iconvApp($f¤©·„±), $fÑÔÉ—Ì¢Ò[29] => $fÑÔÉ—Ì¢Ò[193], $fÑÔÉ—Ì¢Ò[78] => 0); @ftp_chdir($this->connect, $fÑÔÉ—Ì¢Ò[8]); goto b—†ÚÅ…É; FÑ¹‰Æİ¯«: $fÑÔÉ—Ì¢Ò =& $_SERVER[ªúæÂ¡­ä½]; if ($f¤©·„± == $fÑÔÉ—Ì¢Ò[33] || $f¤©·„± == $fÑÔÉ—Ì¢Ò[8]) { return array(); } if (!$this->_isconn()) { return !1; } goto aè’‘ªö; Eß˜Êˆ¼Ñ: } protected function _isFolder($AÂº°ø¼‚×) { $bâÉÈØÜ²‹ =& $_SERVER[ªúæÂ¡­ä½]; if ($AÂº°ø¼‚× == $bâÉÈØÜ²‹[33] || $AÂº°ø¼‚× == $bâÉÈØÜ²‹[8]) { return !0; } $eØİ›ö¤†Ç = $this->_objectMeta($AÂº°ø¼‚×); return isset($eØİ›ö¤†Ç[$bâÉÈØÜ²‹[29]]) && $eØİ›ö¤†Ç[$bâÉÈØÜ²‹[29]] == $bâÉÈØÜ²‹[77] ? !0 : !1; } } class PathDriverLocal extends PathDriverBase { public function __construct() { parent::__construct(); } public function getPath($cîø±¶‹ƒ) { if (substr($cîø±¶‹ƒ, 0, 2) == $_SERVER[ªúæÂ¡­ä½][1260]) { $cîø±¶‹ƒ = BASIC_PATH . substr($cîø±¶‹ƒ, 2); } return $cîø±¶‹ƒ; } public function iconvApp($A‰øâéÅâ§) { $d…Ìœ’Œˆñ =& $_SERVER[ªúæÂ¡­ä½]; global $config; return $this->iconvTo($A‰øâéÅâ§, $config[$d…Ìœ’Œˆñ[1258]], $config[$d…Ìœ’Œˆñ[1257]]); } public function iconvSystem($BÕšÚñ§‹•) { $cÇ™»Éë‰ø =& $_SERVER[ªúæÂ¡­ä½]; global $config; return $this->iconvTo($BÕšÚñ§‹•, $config[$cÇ™»Éë‰ø[1257]], $config[$cÇ™»Éë‰ø[1258]]); } public function getPathOuter($AŸ‰´çìï) { goto Fˆßºí”ğ‘; Fˆßºí”ğ‘: $DëÉ¦í¥Á =& $_SERVER[ªúæÂ¡­ä½]; $e—µ§í—¿Û = $this->iconvApp($this->pathBase); $AŸ‰´çìï = $this->iconvApp($AŸ‰´çìï); goto BÀ¤ìÚãÆÏ; A»—Ï§÷‹„: $AŸ‰´çìï = KodIO::clear($AŸ‰´çìï); $AŸ‰´çìï = substr($AŸ‰´çìï, strlen($e—µ§í—¿Û)); if (empty($this->pathDriver)) { return $AŸ‰´çìï; } goto DÏîÆ³‡‚Í; BÀ¤ìÚãÆÏ: if (substr($e—µ§í—¿Û, 0, 2) == $DëÉ¦í¥Á[1260]) { $e—µ§í—¿Û = BASIC_PATH . substr($e—µ§í—¿Û, 2); } if (substr($AŸ‰´çìï, 0, 2) == $DëÉ¦í¥Á[1260]) { $AŸ‰´çìï = BASIC_PATH . substr($AŸ‰´çìï, 2); } $e—µ§í—¿Û = KodIO::clear($e—µ§í—¿Û); goto A»—Ï§÷‹„; DÏîÆ³‡‚Í: return $this->pathDriver . $DëÉ¦í¥Á[8] . ltrim($AŸ‰´çìï, $DëÉ¦í¥Á[8]); goto Aƒ®‰ÚáÍ»; Aƒ®‰ÚáÍ»: } public function mkfile($c¥Á¢‰Ù¼, $cÙƒôãÌ = '', $AìŠßÛ‘ = REPEAT_RENAME) { $c¥Á¢‰Ù¼ = $this->iconvSystem($c¥Á¢‰Ù¼); @touch($c¥Á¢‰Ù¼); if ($cÙƒôãÌ) { file_put_contents($c¥Á¢‰Ù¼, $cÙƒôãÌ); } @chmod($c¥Á¢‰Ù¼, 511); return is_file($c¥Á¢‰Ù¼) ? $this->getPathOuter($c¥Á¢‰Ù¼) : !1; } public function mkdir($Bò²êË×ÊØ, $Fš©¯È®—Ë = REPEAT_SKIP) { $Bò²êË×ÊØ = $this->iconvSystem($Bò²êË×ÊØ); if (is_dir($Bò²êË×ÊØ)) { return $this->getPathOuter($Bò²êË×ÊØ); } @mkdir($Bò²êË×ÊØ, 511, !0); @chmod($Bò²êË×ÊØ, 511); return is_dir($Bò²êË×ÊØ) ? $this->getPathOuter($Bò²êË×ÊØ) : !1; } public function copyFile($a¨åªõÂ˜ğ, $Cùƒª²Ä¼Õ) { $this->mkdir($this->pathFather($Cùƒª²Ä¼Õ)); $a¨åªõÂ˜ğ = $this->iconvSystem($a¨åªõÂ˜ğ); $Cùƒª²Ä¼Õ = $this->iconvSystem($Cùƒª²Ä¼Õ); $fŸ¹±‰Ò¤‡ = copy_64($a¨åªõÂ˜ğ, $Cùƒª²Ä¼Õ); @chmod($Cùƒª²Ä¼Õ, 511); return $fŸ¹±‰Ò¤‡ ? $this->getPathOuter($Cùƒª²Ä¼Õ) : !1; } public function moveFile($bÇ‡–»»Â, $DÃ¤ ÍöÒ) { goto fõÕÑ˜±¤±; fõÕÑ˜±¤±: $this->mkdir($this->pathFather($DÃ¤ ÍöÒ)); $bÇ‡–»»Â = $this->iconvSystem($bÇ‡–»»Â); $DÃ¤ ÍöÒ = $this->iconvSystem($DÃ¤ ÍöÒ); goto c­ğèÅå; EŠÊğÉĞ³Æ: return $f®ğÅÅøà¼ ? $this->getPathOuter($DÃ¤ ÍöÒ) : !1; goto dÉÅ½©îÏ¬; c­ğèÅå: $f®ğÅÅøà¼ = intval(@rename($bÇ‡–»»Â, $DÃ¤ ÍöÒ)); if (!$f®ğÅÅøà¼) { if ($f®ğÅÅøà¼ = intval(@copy_64($bÇ‡–»»Â, $DÃ¤ ÍöÒ))) { @unlink($bÇ‡–»»Â); } } @chmod($DÃ¤ ÍöÒ, 511); goto EŠÊğÉĞ³Æ; dÉÅ½©îÏ¬: } public function delFile($FÖÒç˜Ûí‰) { $FÖÒç˜Ûí‰ = $this->iconvSystem($FÖÒç˜Ûí‰); if (!@unlink($FÖÒç˜Ûí‰)) { @chmod($FÖÒç˜Ûí‰, 511); if (!@unlink($FÖÒç˜Ûí‰)) { return !1; } } else { return !0; } } public function delFolder($E•„ÊÜ¡Ğ) { goto bîª»•„¨Î; bîª»•„¨Î: $CëÂæ‡Ò¼š =& $_SERVER[ªúæÂ¡­ä½]; $E•„ÊÜ¡Ğ = $this->iconvSystem($E•„ÊÜ¡Ğ); if (!is_dir($E•„ÊÜ¡Ğ)) { return !0; } goto DÕœÙŠÛŒ„; BĞ†÷Éá´ã: return rmdir($E•„ÊÜ¡Ğ); goto d”£ã¸ïÀÜ; DÕœÙŠÛŒ„: if (!($e”Â£œè§‰ = opendir($E•„ÊÜ¡Ğ))) { return !1; } while (($eìÒƒŠĞğ‚ = readdir($e”Â£œè§‰)) !== !1) { if ($eìÒƒŠĞğ‚ == $CëÂæ‡Ò¼š[95] || $eìÒƒŠĞğ‚ == $CëÂæ‡Ò¼š[1267]) { continue; } $bËÛ¬µŞ¥õ = $E•„ÊÜ¡Ğ . $CëÂæ‡Ò¼š[8] . $eìÒƒŠĞğ‚; if (is_file($bËÛ¬µŞ¥õ) || is_link($bËÛ¬µŞ¥õ)) { if (!unlink($bËÛ¬µŞ¥õ)) { chmod($bËÛ¬µŞ¥õ, 511); if (!unlink($bËÛ¬µŞ¥õ)) { return !1; } } } else { if (is_dir($bËÛ¬µŞ¥õ)) { chmod($bËÛ¬µŞ¥õ, 511); $bËÛ¬µŞ¥õ = $this->iconvApp($bËÛ¬µŞ¥õ); if (!$this->delFolder($bËÛ¬µŞ¥õ)) { return !1; } } } } closedir($e”Â£œè§‰); goto BĞ†÷Éá´ã; d”£ã¸ïÀÜ: } public function rename($E°„øíƒÀó, $C‚†ŞèÑ¨¯) { goto fºÏ¹Åøà; B÷¬¨ÎĞä‘: $E°„øíƒÀó = $this->iconvSystem($E°„øíƒÀó); $EÛÖ»…ôÎ¢ = $this->pathFather($E°„øíƒÀó); $f¶ÂÑˆÔí = rtrim($EÛÖ»…ôÎ¢, $F³¼ÒÍÃ¥ƒ[8]) . $F³¼ÒÍÃ¥ƒ[8] . $dÈ‘‚Á¯‡; goto DˆÄÙ‡‹”; DˆÄÙ‡‹”: $D–‘ˆæ–š˜ = @rename($E°„øíƒÀó, $f¶ÂÑˆÔí); $f¶ÂÑˆÔí = $this->iconvApp($f¶ÂÑˆÔí); return $D–‘ˆæ–š˜ ? $this->getPathOuter($f¶ÂÑˆÔí) : !1; goto D÷«Òè‚ª; fºÏ¹Åøà: $F³¼ÒÍÃ¥ƒ =& $_SERVER[ªúæÂ¡­ä½]; $dÈ‘‚Á¯‡ = $this->fileNameAuto($this->pathFather($E°„øíƒÀó), $C‚†ŞèÑ¨¯); $dÈ‘‚Á¯‡ = $this->iconvSystem($dÈ‘‚Á¯‡); goto B÷¬¨ÎĞä‘; D÷«Òè‚ª: } public function size($f©èµÙ¹¼ª) { $f©èµÙ¹¼ª = $this->iconvSystem($f©èµÙ¹¼ª); return filesize_64($f©èµÙ¹¼ª); } public function info($C Œß›¸ê) { $C Œß›¸ê = $this->iconvSystem($C Œß›¸ê); if ($this->isFolder($C Œß›¸ê)) { return $this->folderInfo($C Œß›¸ê); } else { if ($this->isFile($C Œß›¸ê)) { return $this->fileInfo($C Œß›¸ê); } } return !1; } protected function infoChildren($Dãùïà­ƒ, &$dŒ•ˆí‚·, $fßÔ «„¬– = true) { goto BÓ½¸‹”‘»; BÓ½¸‹”‘»: $b»½êŠ¼è =& $_SERVER[ªúæÂ¡­ä½]; check_abort_echo(); $Dãùïà­ƒ = rtrim($Dãùïà­ƒ, $b»½êŠ¼è[8]) . $b»½êŠ¼è[8]; goto EÄ™²çîœ´; EÄ™²çîœ´: if ($fßÔ «„¬–) { $Dãùïà­ƒ = $this->iconvSystem($Dãùïà­ƒ); } if (!($AŠ¿Ø¯ê§ = @opendir($Dãùïà­ƒ))) { return; } while (($Bç²ÍŞÕÇ = readdir($AŠ¿Ø¯ê§)) !== !1) { if ($Bç²ÍŞÕÇ == $b»½êŠ¼è[95] || $Bç²ÍŞÕÇ == $b»½êŠ¼è[1267]) { continue; } $bœö¶Í»Œ = $Dãùïà­ƒ . $Bç²ÍŞÕÇ; if (is_file($bœö¶Í»Œ) || is_link($bœö¶Í»Œ)) { $dŒ•ˆí‚·[$b»½êŠ¼è[79]]++; $dŒ•ˆí‚·[$b»½êŠ¼è[78]] += filesize_64($bœö¶Í»Œ); } else { if (is_dir($bœö¶Í»Œ)) { $dŒ•ˆí‚·[$b»½êŠ¼è[80]]++; $this->infoChildren($bœö¶Í»Œ, $dŒ•ˆí‚·, !1); } } } goto A®§¯Õàåí; A®§¯Õàåí: closedir($AŠ¿Ø¯ê§); goto cÊ½„‰ÛĞö; cÊ½„‰ÛĞö: } private function folderInfo($a„ö“µ‰¨ê, $E‘Œµ†ß²à = false) { $C¸ÖĞÆ¤¯ =& $_SERVER[ªúæÂ¡­ä½]; $a„ö“µ‰¨ê = rtrim($a„ö“µ‰¨ê, $C¸ÖĞÆ¤¯[8]) . $C¸ÖĞÆ¤¯[8]; $aáâò“¿ØŸ = $this->iconvApp($this->pathThis($a„ö“µ‰¨ê)); if ($E‘Œµ†ß²à) { return array($C¸ÖĞÆ¤¯[28] => $aáâò“¿ØŸ, $C¸ÖĞÆ¤¯[76] => $this->getPathOuter($a„ö“µ‰¨ê), $C¸ÖĞÆ¤¯[29] => $C¸ÖĞÆ¤¯[77]); } $Aé‚¥”­ = array($C¸ÖĞÆ¤¯[28] => $aáâò“¿ØŸ, $C¸ÖĞÆ¤¯[76] => $this->getPathOuter($a„ö“µ‰¨ê), $C¸ÖĞÆ¤¯[29] => $C¸ÖĞÆ¤¯[77], $C¸ÖĞÆ¤¯[194] => @filectime($a„ö“µ‰¨ê), $C¸ÖĞÆ¤¯[84] => @filemtime($a„ö“µ‰¨ê), $C¸ÖĞÆ¤¯[1270] => @fileatime($a„ö“µ‰¨ê), $C¸ÖĞÆ¤¯[1271] => is_readable($a„ö“µ‰¨ê), $C¸ÖĞÆ¤¯[1272] => is_writable($a„ö“µ‰¨ê), $C¸ÖĞÆ¤¯[1273] => get_mode($a„ö“µ‰¨ê)); return $Aé‚¥”­; } private function fileInfo($f°Ÿ‹õÈäŒ, $dµí†»ŠÔ„ = false) { $Eù÷Ê²»öÏ =& $_SERVER[ªúæÂ¡­ä½]; $bÈ¨ã¥Ïª = $this->iconvApp($this->pathThis($f°Ÿ‹õÈäŒ)); if ($dµí†»ŠÔ„) { return array($Eù÷Ê²»öÏ[28] => $bÈ¨ã¥Ïª, $Eù÷Ê²»öÏ[76] => $this->getPathOuter($f°Ÿ‹õÈäŒ), $Eù÷Ê²»öÏ[29] => $Eù÷Ê²»öÏ[193], $Eù÷Ê²»öÏ[78] => $this->size($f°Ÿ‹õÈäŒ), $Eù÷Ê²»öÏ[168] => $this->ext($bÈ¨ã¥Ïª)); } $BòÜ¯ˆÕé = array($Eù÷Ê²»öÏ[28] => $bÈ¨ã¥Ïª, $Eù÷Ê²»öÏ[76] => $this->getPathOuter($f°Ÿ‹õÈäŒ), $Eù÷Ê²»öÏ[29] => $Eù÷Ê²»öÏ[193], $Eù÷Ê²»öÏ[194] => @filectime($f°Ÿ‹õÈäŒ), $Eù÷Ê²»öÏ[84] => @filemtime($f°Ÿ‹õÈäŒ), $Eù÷Ê²»öÏ[1270] => @fileatime($f°Ÿ‹õÈäŒ), $Eù÷Ê²»öÏ[78] => $this->size($f°Ÿ‹õÈäŒ), $Eù÷Ê²»öÏ[168] => $this->ext($bÈ¨ã¥Ïª), $Eù÷Ê²»öÏ[1271] => is_readable($f°Ÿ‹õÈäŒ), $Eù÷Ê²»öÏ[1272] => is_writable($f°Ÿ‹õÈäŒ), $Eù÷Ê²»öÏ[1273] => get_mode($f°Ÿ‹õÈäŒ)); return $BòÜ¯ˆÕé; } public function exist($Dê¬é°™­) { $Dê¬é°™­ = $this->iconvSystem($Dê¬é°™­); return @file_exists($Dê¬é°™­); } public function isFile($BÓöºĞ×Â¨) { $BÓöºĞ×Â¨ = $this->iconvSystem($BÓöºĞ×Â¨); return @is_file($BÓöºĞ×Â¨); } public function isFolder($dÁ£›õê“) { $dÁ£›õê“ = $this->iconvSystem($dÁ£›õê“); return @is_dir($dÁ£›õê“); } public function listPath($E‹Ñ¾µÏ„å, $Dìã›Ëë‹Í = false) { goto B½«¯ÄîÀ; Dê‘”¹½Ò…: closedir($c‹œëß®„); return $e”ñĞ¹·„¸; goto D’ùˆÅÉ¸à; B½«¯ÄîÀ: $dË×©ÏÖ„ =& $_SERVER[ªúæÂ¡­ä½]; $E‹Ñ¾µÏ„å = $this->iconvSystem($E‹Ñ¾µÏ„å); $E‹Ñ¾µÏ„å = rtrim($E‹Ñ¾µÏ„å, $dË×©ÏÖ„[8]) . $dË×©ÏÖ„[8]; goto bšòÙ½âÙ‘; bšòÙ½âÙ‘: $e”ñĞ¹·„¸ = array($dË×©ÏÖ„[75] => array(), $dË×©ÏÖ„[74] => array()); if (!($c‹œëß®„ = @opendir($E‹Ñ¾µÏ„å))) { return $e”ñĞ¹·„¸; } while (($B‰õ˜–èÇË = readdir($c‹œëß®„)) !== !1) { if ($B‰õ˜–èÇË == $dË×©ÏÖ„[95] || $B‰õ˜–èÇË == $dË×©ÏÖ„[1267]) { continue; } $C‹èø‡ë¡® = $E‹Ñ¾µÏ„å . $B‰õ˜–èÇË; if (is_file($C‹èø‡ë¡®)) { $e”ñĞ¹·„¸[$dË×©ÏÖ„[74]][] = $this->fileInfo($C‹èø‡ë¡®, $Dìã›Ëë‹Í); } else { $e”ñĞ¹·„¸[$dË×©ÏÖ„[75]][] = $this->folderInfo($C‹èø‡ë¡®, $Dìã›Ëë‹Í); } } goto Dê‘”¹½Ò…; D’ùˆÅÉ¸à: } public function listAll($C”ÔÀŠŸ‚Æ, &$E†¸ä…ÑÂ = array()) { goto D±¥ ×Üµš; C¦‰¦¼ÂÂĞ: if (!($FîÒá‡¡£Õ = @opendir($C”ÔÀŠŸ‚Æ))) { return $E†¸ä…ÑÂ; } while (($BÆ±Ê­§«÷ = readdir($FîÒá‡¡£Õ)) !== !1) { if ($BÆ±Ê­§«÷ == $FïŒñÎé™”[95] || $BÆ±Ê­§«÷ == $FïŒñÎé™”[1267]) { continue; } $F°ÛÅ‚‡Íä = $C”ÔÀŠŸ‚Æ . $BÆ±Ê­§«÷; if (is_dir($F°ÛÅ‚‡Íä) && !is_link($F°ÛÅ‚‡Íä)) { $E†¸ä…ÑÂ[] = array($FïŒñÎé™”[76] => $F°ÛÅ‚‡Íä . $FïŒñÎé™”[8], $FïŒñÎé™”[77] => 1, $FïŒñÎé™”[84] => @filemtime($F°ÛÅ‚‡Íä), $FïŒñÎé™”[78] => 0); $this->listAll($F°ÛÅ‚‡Íä, $E†¸ä…ÑÂ); } else { $E†¸ä…ÑÂ[] = array($FïŒñÎé™”[76] => $F°ÛÅ‚‡Íä, $FïŒñÎé™”[77] => 0, $FïŒñÎé™”[84] => @filemtime($F°ÛÅ‚‡Íä), $FïŒñÎé™”[78] => $this->size($F°ÛÅ‚‡Íä)); } } closedir($FîÒá‡¡£Õ); goto d‡‰Ã¼Ô§; d‡‰Ã¼Ô§: return $E†¸ä…ÑÂ; goto AÆóŒâÑ; D±¥ ×Üµš: $FïŒñÎé™” =& $_SERVER[ªúæÂ¡­ä½]; $C”ÔÀŠŸ‚Æ = $this->iconvSystem($C”ÔÀŠŸ‚Æ); $C”ÔÀŠŸ‚Æ = rtrim($C”ÔÀŠŸ‚Æ, $FïŒñÎé™”[8]) . $FïŒñÎé™”[8]; goto C¦‰¦¼ÂÂĞ; AÆóŒâÑ: } public function has($aİ’’³™×, $EçÈêÖ…¥º = false, $Bñ¬¨Ê˜½‡ = true) { goto D•í¶ê‡™; D•í¶ê‡™: $F£˜ÚÉØ =& $_SERVER[ªúæÂ¡­ä½]; $aİ’’³™× = $this->iconvSystem($aİ’’³™×); $aİ’’³™× = rtrim($aİ’’³™×, $F£˜ÚÉØ[8]) . $F£˜ÚÉØ[8]; goto f¡à‘ËÖµ; c˜…ÍªÄÊ™: $DĞ˜Ë„Ü = 0; while (($F“•»±öŒŸ = readdir($AéÌå©Öëª)) !== !1) { if ($F“•»±öŒŸ == $F£˜ÚÉØ[95] || $F“•»±öŒŸ == $F£˜ÚÉØ[1267]) { continue; } $Eİæ†„äÃÔ = $aİ’’³™× . $F“•»±öŒŸ; if ($EçÈêÖ…¥º) { $DĞ˜Ë„Ü++; if (@is_file($Eİæ†„äÃÔ)) { $E–¸ùˆåÏ++; } else { $F‚´âÉÖ¥Ğ++; } if ($DĞ˜Ë„Ü > 10000) { break; } continue; } if ($Bñ¬¨Ê˜½‡) { if (@is_file($Eİæ†„äÃÔ)) { return !0; } } else { if (@is_dir($Eİæ†„äÃÔ . $F£˜ÚÉØ[8])) { return !0; } } } closedir($AéÌå©Öëª); goto FÙÁõßªÏ; f¡à‘ËÖµ: if (!($AéÌå©Öëª = @opendir($aİ’’³™×))) { return !1; } $E–¸ùˆåÏ = 0; $F‚´âÉÖ¥Ğ = 0; goto c˜…ÍªÄÊ™; FÙÁõßªÏ: if ($EçÈêÖ…¥º) { return array($F£˜ÚÉØ[203] => $E–¸ùˆåÏ, $F£˜ÚÉØ[204] => $F‚´âÉÖ¥Ğ); } return !1; goto dÙäŞ‰ñ”; dÙäŞ‰ñ”: } public function hashSimple($B±‹˜¶ç‰•) { goto EæĞ…‡Î õ; a¼‰Öƒ¨¼: return md5($B®íœ·Ø ) . $B¡¬ÜÄƒ¹; goto dº¼ÑÀÚö; bºİ¯†‹ŠË: if ($B¡¬ÜÄƒ¹ <= $dãäÀš¼’Ğ * $F®öÎÓï¸ñ) { return $this->hashMd5($B±‹˜¶ç‰•) . $B¡¬ÜÄƒ¹; } $B®íœ·Ø  = $dßÖ÷°¶Ó[33]; $C©Šğ¡»ÉŒ = intval($B¡¬ÜÄƒ¹ / $F®öÎÓï¸ñ); goto BóóÑƒ¶“; EæĞ…‡Î õ: $dßÖ÷°¶Ó =& $_SERVER[ªúæÂ¡­ä½]; if (!$B±‹˜¶ç‰•) { return md5($dßÖ÷°¶Ó[33]); } $B±‹˜¶ç‰• = $this->iconvSystem($B±‹˜¶ç‰•); goto Aßä‰›ËõÜ; BóóÑƒ¶“: $B‚À¬È¦î‹ = fopen($B±‹˜¶ç‰•, $dßÖ÷°¶Ó[1274]); if (!$B‚À¬È¦î‹) { return $B®íœ·Ø ; } for ($E¢ÙŸ‹™¯® = 0; $E¢ÙŸ‹™¯® < $F®öÎÓï¸ñ; $E¢ÙŸ‹™¯®++) { fseek_64($B‚À¬È¦î‹, $C©Šğ¡»ÉŒ * $E¢ÙŸ‹™¯®); $B®íœ·Ø  .= fread($B‚À¬È¦î‹, $dãäÀš¼’Ğ); } goto aÕåµ¥ŠÆ; aÕåµ¥ŠÆ: fseek_64($B‚À¬È¦î‹, $B¡¬ÜÄƒ¹ - $dãäÀš¼’Ğ); $B®íœ·Ø  .= fread($B‚À¬È¦î‹, $dãäÀš¼’Ğ); fclose($B‚À¬È¦î‹); goto a¼‰Öƒ¨¼; Aßä‰›ËõÜ: $B¡¬ÜÄƒ¹ = $this->size($B±‹˜¶ç‰•); $dãäÀš¼’Ğ = 200; $F®öÎÓï¸ñ = 50; goto bºİ¯†‹ŠË; dº¼ÑÀÚö: } public function getContent($BĞ–Î–—Íß) { $BĞ–Î–—Íß = $this->iconvSystem($BĞ–Î–—Íß); return file_get_contents($BĞ–Î–—Íß); } public function setContent($B«¡¬Éå†İ, $dÅÉ«š²Á = '') { $B«¡¬Éå†İ = $this->iconvSystem($B«¡¬Éå†İ); $eß’ßİ ÚÆ = @file_put_contents($B«¡¬Éå†İ, $dÅÉ«š²Á, LOCK_EX); clearstatcache(); @chmod($B«¡¬Éå†İ, 511); return $eß’ßİ ÚÆ === !1 ? !1 : !0; } public function fileSubstr($f‘…Ş“‚¤, $Eš¢×Ôˆ†ˆ = 0, $AÜ…ï›¿ñí = false) { goto F†Ï®Ó„Á ; dæ–àò³‰§: if ($AÜ…ï›¿ñí <= 0) { return $D…¼óÏùæ[33]; } $Eî±Áä‡ƒ = fopen($f‘…Ş“‚¤, $D…¼óÏùæ[1274]); if (!$Eî±Áä‡ƒ) { return !1; } goto eĞøºÖêäß; F†Ï®Ó„Á : $D…¼óÏùæ =& $_SERVER[ªúæÂ¡­ä½]; $f‘…Ş“‚¤ = $this->iconvSystem($f‘…Ş“‚¤); if ($AÜ…ï›¿ñí === !1) { $AÜ…ï›¿ñí = $this->size($f‘…Ş“‚¤); } goto dæ–àò³‰§; B‰Èóó–—Ù: return $E¦´¤ ›¡; goto B ‹ÇÁª; eĞøºÖêäß: fseek_64($Eî±Áä‡ƒ, $Eš¢×Ôˆ†ˆ); $E¦´¤ ›¡ = fread($Eî±Áä‡ƒ, $AÜ…ï›¿ñí); fclose($Eî±Áä‡ƒ); goto B‰Èóó–—Ù; B ‹ÇÁª: } public function upload($cÉõ‰ß²ˆ´, $ašçšÂ™¸ƒ, $Aˆ¥„êÔ¢ = false, $dÜÛ¯È¯›œ = REPEAT_REPLACE) { if ($Aˆ¥„êÔ¢) { return $this->moveFile($ašçšÂ™¸ƒ, $cÉõ‰ß²ˆ´); } return $this->copyFile($ašçšÂ™¸ƒ, $cÉõ‰ß²ˆ´); } public function setModifyTime($dø¹îœÏ, $DÕŞëÔÎ©Š = '') { @touch($dø¹îœÏ, intval($DÕŞëÔÎ©Š)); } public function download($d…»ÊŞƒ¡§, $BŒšéô‰“æ) { return $this->iconvSystem($d…»ÊŞƒ¡§); } } class PathDriverMinIO extends PathDriverBaseS3 { public function __construct($bÁ’Ï‡®‡) { parent::__construct($bÁ’Ï‡®‡); $this->signatureVersion($_SERVER[ªúæÂ¡­ä½][212]); } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } } goto cÑœóèî”; EîÑ»¤İ: define($_SERVER[ªúæÂ¡­ä½][237], 2); define($_SERVER[ªúæÂ¡­ä½][238], 3); define($_SERVER[ªúæÂ¡­ä½][239], 1); goto D…ĞĞî·Æˆ; b¹ŠÏ“ òà: class PathDriverDriverShareLink extends PathDriverDriverShareItem { public function __construct($d±à¸’Ä„ˆ) { $this->pathParse = $d±à¸’Ä„ˆ; } protected function infoParse($C­«·áŒÑ, $a–Âå¥…¤ó = false) { $f±Ä¶¿¾„ä =& $_SERVER[ªúæÂ¡­ä½]; return Action($f±Ä¶¿¾„ä[1085])->sharePathInfo($this->pathParse[$f±Ä¶¿¾„ä[76]], !0, $a–Âå¥…¤ó); } public function listPath($f–Ô‡²›, $Ešî¦äÒ­Ç = false) { $Eî¡‡±Ÿ¬ =& $_SERVER[ªúæÂ¡­ä½]; $bÁ•Ó–Ì¹Å = IO::listPath($f–Ô‡²›, $Ešî¦äÒ­Ç); foreach ($bÁ•Ó–Ì¹Å as $F°ğ–Ö÷Â» => $aøÒË‘â•¿) { if (!in_array($F°ğ–Ö÷Â», array($Eî¡‡±Ÿ¬[74], $Eî¡‡±Ÿ¬[75]))) { continue; } foreach ($aøÒË‘â•¿ as $EŒ…Ì½Œ­» => $c¯°–«‡¦Î) { $c¯°–«‡¦Î = Action($Eî¡‡±Ÿ¬[1238])->parsePathChildren($c¯°–«‡¦Î, array($Eî¡‡±Ÿ¬[415] => $f–Ô‡²›)); $bÁ•Ó–Ì¹Å[$F°ğ–Ö÷Â»][$EŒ…Ì½Œ­»] = Action($Eî¡‡±Ÿ¬[1085])->shareItemInfo($c¯°–«‡¦Î); } } return $bÁ•Ó–Ì¹Å; } public function listAll($fŒã¯ìº³¢) { $CâÏó¯ğÔÎ =& $_SERVER[ªúæÂ¡­ä½]; $eÓ¹¡‹£ÍŸ = IO::listAll($fŒã¯ìº³¢); foreach ($eÓ¹¡‹£ÍŸ as &$eÙ¶íìÂæ) { $EÖÇ‹ŠÊ¸ = IO::info($eÙ¶íìÂæ[$CâÏó¯ğÔÎ[76]]); $EÖÇ‹ŠÊ¸ = is_array($EÖÇ‹ŠÊ¸) ? $EÖÇ‹ŠÊ¸ : array(); $eÙ¶íìÂæ = array_merge($EÖÇ‹ŠÊ¸, $eÙ¶íìÂæ); $eÙ¶íìÂæ[$CâÏó¯ğÔÎ[85]] = Action($CâÏó¯ğÔÎ[1085])->shareItemInfo($eÙ¶íìÂæ); } unset($eÙ¶íìÂæ); return $eÓ¹¡‹£ÍŸ; } } class PathDriverEDS extends PathDriverMinIO { public function __construct($cñÏ÷«µŠñ) { parent::__construct($cñÏ÷«µŠñ); } } class PathDriverEOS extends PathDriverBaseS3 { public function __construct($AÉ¹Ãß˜¸Ú) { parent::__construct($AÉ¹Ãß˜¸Ú); $this->signatureVersion($_SERVER[ªúæÂ¡­ä½][212]); } public function uploadFormData($bËÖ¹«æÎ, $f·ÔÍá²§ª = 3600) { goto b‹¢ÇÕóÚ»; b‹¢ÇÕóÚ»: $c¨Ğîã¼¡ =& $_SERVER[ªúæÂ¡­ä½]; $fÑé­Ò‚ŒÖ = $c¨Ğîã¼¡[192]; $c¸„Œ‰ãç‹ = $c¨Ğîã¼¡[1239]; goto EÃƒ‘óÈ¢Ì; EÆŠ„˜Í¾©: $d§†·İó’ï = base64_encode(json_encode($aŞåÑÙÕÜ®)); $d›®‡›§¬« = hash_hmac($c¨Ğîã¼¡[1249], $cÔ¦ÍèŒÒ¥, $c¨Ğîã¼¡[1250] . $this->secret, !0); $EÁÕ³¯‡‹ = hash_hmac($c¨Ğîã¼¡[1249], $this->region, $d›®‡›§¬«, !0); goto FñÓ…×™Â„; AÆÂØäÌã§: $AÜø£¯œíÃ = array($c¨Ğîã¼¡[211] => $c¨Ğîã¼¡[33], $c¨Ğîã¼¡[1251] => $c¨Ğîã¼¡[33], $c¨Ğîã¼¡[1208] => $fÑé­Ò‚ŒÖ, $c¨Ğîã¼¡[1212] => $b±öÑ“ÚÔÑ, $c¨Ğîã¼¡[1216] => $d§†·İó’ï, $c¨Ğîã¼¡[1252] => $A¥À¨­±ï, $c¨Ğîã¼¡[1253] => $c¸„Œ‰ãç‹, $c¨Ğîã¼¡[1254] => $A‹³ˆ¡‘š, $c¨Ğîã¼¡[1255] => $eÏˆìÁ¶ç, $c¨Ğîã¼¡[1256] => $E¬Ş˜ó®, $c¨Ğîã¼¡[175] => $this->getHost()); return $AÜø£¯œíÃ; goto bù½ğÙâ; FñÓ…×™Â„: $AµÑù³‡ñ = hash_hmac($c¨Ğîã¼¡[1249], $E…ˆ ±Ë¿Ê, $EÁÕ³¯‡‹, !0); $f¯ŒŞ¶›Ê¤ = hash_hmac($c¨Ğîã¼¡[1249], $Dˆ­š†ƒÁ, $AµÑù³‡ñ, !0); $E¬Ş˜ó® = hash_hmac($c¨Ğîã¼¡[1249], $d§†·İó’ï, $f¯ŒŞ¶›Ê¤); goto AÆÂØäÌã§; DÍÊ‡¼»Ì¼: $Dˆ­š†ƒÁ = $c¨Ğîã¼¡[1241]; $eÏˆìÁ¶ç = $f·ÔÍá²§ª . $c¨Ğîã¼¡[33]; $b±öÑ“ÚÔÑ = $c¨Ğîã¼¡[1204]; goto AåºÖÆØ¼ë; AåºÖÆØ¼ë: $B½ÈÛ–¬É = array($this->accessKey, $cÔ¦ÍèŒÒ¥, $this->region, $E…ˆ ±Ë¿Ê, $Dˆ­š†ƒÁ); $A¥À¨­±ï = implode($c¨Ğîã¼¡[8], $B½ÈÛ–¬É); $aŞåÑÙÕÜ® = array($c¨Ğîã¼¡[1206] => gmdate($c¨Ğîã¼¡[1205], strtotime($c¨Ğîã¼¡[1242])), $c¨Ğîã¼¡[1207] => array(array($c¨Ğîã¼¡[1209] => $this->bucket), array($c¨Ğîã¼¡[1208] => $fÑé­Ò‚ŒÖ), array($c¨Ğîã¼¡[1210], $c¨Ğîã¼¡[1211], $c¨Ğîã¼¡[33]), array($c¨Ğîã¼¡[1210], $c¨Ğîã¼¡[1243], $c¨Ğîã¼¡[33]), array($c¨Ğîã¼¡[1210], $c¨Ğîã¼¡[1244], $c¨Ğîã¼¡[33]), array($c¨Ğîã¼¡[1212] => $b±öÑ“ÚÔÑ), array($c¨Ğîã¼¡[1245] => $A¥À¨­±ï), array($c¨Ğîã¼¡[1246] => $c¸„Œ‰ãç‹), array($c¨Ğîã¼¡[1247] => $A‹³ˆ¡‘š), array($c¨Ğîã¼¡[1248] => $eÏˆìÁ¶ç))); goto EÆŠ„˜Í¾©; EÃƒ‘óÈ¢Ì: $E…ˆ ±Ë¿Ê = $c¨Ğîã¼¡[59]; $A‹³ˆ¡‘š = gmdate($c¨Ğîã¼¡[1240]); $cÔ¦ÍèŒÒ¥ = gmdate($c¨Ğîã¼¡[729]); goto DÍÊ‡¼»Ì¼; bù½ğÙâ: } } goto BºˆÓÉ¬‘†; aŸ“ô™ù¤º: class SourceSecretModel extends ModelBaseLight { public $optionType = "\x53\x79\163\164\145\155\x2e\163\x6f\x75\x72\x63\x65\123\x65\x63\162\145\164\x4c\x69\x73\x74"; public $field = array("\x73\x6f\x75\162\143\145\x49\104", "\x74\x79\160\145\x49\x44", "\x63\x72\x65\x61\164\145\x55\x73\x65\x72"); } class StorageModel extends ModelBaseLight { public $optionType = "\x53\x79\x73\164\x65\x6d\56\163\x74\157\162\x61\x67\145\114\151\x73\x74"; public $field = array("\156\x61\x6d\x65", "\x73\x69\x7a\x65\x4d\141\x78", "\163\x79\x73\164\x65\x6d", "\x64\145\146\x61\x75\154\164", "\x64\x72\x69\166\145\x72", "\x63\157\156\146\x69\147"); public function listData($Få¤š¬Û¢ë = false, $D‰éÅ”¶ÉÚ = "\x6d\x6f\x64\151\146\171\x54\x69\155\145", $AÄœˆÎ”ß = false) { $b®öòÂö¼ =& $_SERVER[ªúæÂ¡­ä½]; $d‰Ã¤£à‚ = parent::listData($Få¤š¬Û¢ë, $D‰éÅ”¶ÉÚ, $AÄœˆÎ”ß); if ($Få¤š¬Û¢ë) { return $d‰Ã¤£à‚; } $BÖëß®ÑÉ­ = $this->ioSizeUseGet(array_to_keyvalue($d‰Ã¤£à‚, $b®öòÂö¼[33], $b®öòÂö¼[394])); foreach ($d‰Ã¤£à‚ as $CóÈÆË¾‹ö => $f£ºÉÈƒÄ) { unset($d‰Ã¤£à‚[$CóÈÆË¾‹ö][$b®öòÂö¼[6]]); $d‰Ã¤£à‚[$CóÈÆË¾‹ö][$b®öòÂö¼[1700]] = isset($BÖëß®ÑÉ­[$f£ºÉÈƒÄ[$b®öòÂö¼[394]]]) ? $BÖëß®ÑÉ­[$f£ºÉÈƒÄ[$b®öòÂö¼[394]]] : 0; } return $d‰Ã¤£à‚; } public function ioSizeUseGet($EÔˆ•ØÅô) { goto EÔçáä™„á; dœ¨„ÒÑÜ: $cÄÓĞªîÅ = array($D¯³ÇÌÌ[800] => array($D¯³ÇÌÌ[7], $EÔˆ•ØÅô)); $fà„ö„“©Î = Model($D¯³ÇÌÌ[765])->field($e“³ÃÌ«‡˜)->where($cÄÓĞªîÅ)->group($D¯³ÇÌÌ[800])->select(); $fà„ö„“©Î = array_to_keyvalue($fà„ö„“©Î, $D¯³ÇÌÌ[394], $D¯³ÇÌÌ[78]); goto CçŸÙ‚ÔÏ; CçŸÙ‚ÔÏ: Cache::set($F„—¯§®‹’, $fà„ö„“©Î, 600); return $fà„ö„“©Î; goto B‚¬Øá×‚Ú; EÔçáä™„á: $D¯³ÇÌÌ =& $_SERVER[ªúæÂ¡­ä½]; if (!$EÔˆ•ØÅô) { return array(); } $F„—¯§®‹’ = $D¯³ÇÌÌ[2017] . implode($D¯³ÇÌÌ[47], $EÔˆ•ØÅô); goto cÃÒ ”è –; cÃÒ ”è –: $fà„ö„“©Î = Cache::get($F„—¯§®‹’); if ($fà„ö„“©Î) { return $fà„ö„“©Î; } $e“³ÃÌ«‡˜ = array($D¯³ÇÌÌ[800] => $D¯³ÇÌÌ[394], $D¯³ÇÌÌ[2018] => $D¯³ÇÌÌ[78]); goto dœ¨„ÒÑÜ; B‚¬Øá×‚Ú: } public function getConfig($bÖÚæçì‚) { $fŠ›¸ÑÂ­ = parent::listData($bÖÚæçì‚); return json_decode($fŠ›¸ÑÂ­[$_SERVER[ªúæÂ¡­ä½][6]], !0); } public function update($d¼ë…ÙçÛ¤, $Cù©ìâ®¨») { goto a¼¢±Ì§Æ; Fáï¡ „¿—: $AÛ‰”ŠÕ¨ = parent::update($d¼ë…ÙçÛ¤, $Cù©ìâ®¨»); if ($AÛ‰”ŠÕ¨ && $Cù©ìâ®¨»[$a²–ó§ÜÜ÷[34]]) { foreach ($f‰â×à‚ÈÈ as $cİ”ù£¸æ¿) { if ($cİ”ù£¸æ¿[$a²–ó§ÜÜ÷[34]] && $cİ”ù£¸æ¿[$a²–ó§ÜÜ÷[394]] != $d¼ë…ÙçÛ¤) { parent::update($cİ”ù£¸æ¿[$a²–ó§ÜÜ÷[394]], array($a²–ó§ÜÜ÷[34] => 0)); } } } return $AÛ‰”ŠÕ¨; goto Aí„”¯¥İá; aØ–Å¯ß«Ş: if (isset($f‰â×à‚ÈÈ[$C£š…ë²½…]) && $f‰â×à‚ÈÈ[$C£š…ë²½…][$a²–ó§ÜÜ÷[394]] != $d¼ë…ÙçÛ¤) { return !1; } if (isset($Cù©ìâ®¨»[$a²–ó§ÜÜ÷[2019]]) && $Cù©ìâ®¨»[$a²–ó§ÜÜ÷[2019]] == $a²–ó§ÜÜ÷[87]) { $this->checkConfig($Cù©ìâ®¨»); } unset($Cù©ìâ®¨»[$a²–ó§ÜÜ÷[2019]]); goto Fáï¡ „¿—; a¼¢±Ì§Æ: $a²–ó§ÜÜ÷ =& $_SERVER[ªúæÂ¡­ä½]; $C£š…ë²½… = $Cù©ìâ®¨»[$a²–ó§ÜÜ÷[28]]; $f‰â×à‚ÈÈ = array_to_keyvalue(parent::listData(), $a²–ó§ÜÜ÷[28]); goto aØ–Å¯ß«Ş; Aí„”¯¥İá: } public function add($C¬ªÌÆã›“) { goto bÜ„è’œÅ©; B•ÍÓßÇ¥ç: $this->checkConfig($C¬ªÌÆã›“); $b¾íŠ§‰ïë = parent::insert($C¬ªÌÆã›“); if ($b¾íŠ§‰ïë && $C¬ªÌÆã›“[$FÑËÒ‹Á„–[34]]) { foreach ($DÚçé†×”œ as $A•À‚½×™é) { if ($A•À‚½×™é[$FÑËÒ‹Á„–[34]]) { parent::update($A•À‚½×™é[$FÑËÒ‹Á„–[394]], array($FÑËÒ‹Á„–[34] => 0)); } } } goto CùÕù•; CùÕù•: return $b¾íŠ§‰ïë; goto f´“„š•Ôß; bÜ„è’œÅ©: $FÑËÒ‹Á„– =& $_SERVER[ªúæÂ¡­ä½]; $DÚçé†×”œ = array_to_keyvalue(parent::listData(), $FÑËÒ‹Á„–[28]); if (isset($DÚçé†×”œ[$C¬ªÌÆã›“[$FÑËÒ‹Á„–[28]]])) { return !1; } goto B•ÍÓßÇ¥ç; f´“„š•Ôß: } public function checkConfig(&$c™‚Šˆã´Ê, $f¯©ã¼¡ÌŒ = false) { goto E’‰³à™; aŞÇ¨‡Çù’: $aå»¨ù‰‚ = new $f²ôƒ£Ëˆá($EË…Õ†æÙË); if (in_array($cÕ½øòŞ²ò, $aå»¨ù‰‚->objectDriver)) { if (!$aå»¨ù‰‚->isBucketCors() && !$aå»¨ù‰‚->setBucketCors()) { $F…®„»…©® = LNG($D÷°­ŒÀ”î[2024]); $F…®„»…©® .= $D÷°­ŒÀ”î[2025] . LNG($D÷°­ŒÀ”î[2026]); if ($f¯©ã¼¡ÌŒ) { return $F…®„»…©®; } show_json($F…®„»…©®, !1); } } $b•ˆÒÃ³±Â = rtrim($EË…Õ†æÙË[$D÷°­ŒÀ”î[1091]], $D÷°­ŒÀ”î[8]) . $D÷°­ŒÀ”î[8]; goto Aƒæ¤Ï‘‹; E’‰³à™: $D÷°­ŒÀ”î =& $_SERVER[ªúæÂ¡­ä½]; $cÕ½øòŞ²ò = strtolower($c™‚Šˆã´Ê[$D÷°­ŒÀ”î[94]]); $EË…Õ†æÙË = json_decode($c™‚Šˆã´Ê[$D÷°­ŒÀ”î[6]], !0); goto e³ñªŞõ•; e³ñªŞõ•: foreach ($EË…Õ†æÙË as $dÇñÂË‰à => $d„è‚±¦) { $EË…Õ†æÙË[$dÇñÂË‰à] = trim($d„è‚±¦); } $EË…Õ†æÙË[$D÷°­ŒÀ”î[2020]] = rand_string(6); $F‰‚Íø¸ïÄ = $GLOBALS[$D÷°­ŒÀ”î[6]][$D÷°­ŒÀ”î[88]][$D÷°­ŒÀ”î[809]]; goto E«“™öêç; E«“™öêç: $a‚¾¥õ°«® = isset($F‰‚Íø¸ïÄ[$cÕ½øòŞ²ò]) ? $F‰‚Íø¸ïÄ[$cÕ½øòŞ²ò] : ucfirst($cÕ½øòŞ²ò); $f²ôƒ£Ëˆá = $D÷°­ŒÀ”î[72] . $a‚¾¥õ°«®; if (!$a‚¾¥õ°«® || !class_exists($f²ôƒ£Ëˆá)) { if ($f¯©ã¼¡ÌŒ) { return LNG($D÷°­ŒÀ”î[2021]); } write_log(array($D÷°­ŒÀ”î[2022], $c™‚Šˆã´Ê, get_caller_info()), $D÷°­ŒÀ”î[2023]); show_json(LNG($D÷°­ŒÀ”î[2021]), !1, $c™‚Šˆã´Ê); } goto aŞÇ¨‡Çù’; C™ÄÃ²ê…£: $c™‚Šˆã´Ê[$D÷°­ŒÀ”î[6]] = json_encode($EË…Õ†æÙË); $c™‚Šˆã´Ê[$D÷°­ŒÀ”î[94]] = $a‚¾¥õ°«®; return !0; goto fÄ¿µˆÄõƒ; Aƒæ¤Ï‘‹: $fÚâ®êÓé‹ = $aå»¨ù‰‚->getPath($b•ˆÒÃ³±Â . $D÷°­ŒÀ”î[1153]); if (!$aå»¨ù‰‚->mkfile($fÚâ®êÓé‹)) { if ($f¯©ã¼¡ÌŒ) { return LNG($D÷°­ŒÀ”î[2024]); } show_json(LNG($D÷°­ŒÀ”î[2024]), !1); } $EË…Õ†æÙË[$D÷°­ŒÀ”î[1091]] = $b•ˆÒÃ³±Â; goto C™ÄÃ²ê…£; fÄ¿µˆÄõƒ: } public function driverListSystem() { $fé»äîˆ¬… =& $_SERVER[ªúæÂ¡­ä½]; $D‘ÀÔ×“†É = parent::listData(); $bÛƒÂÔŒŞ‚ = array(); foreach ($D‘ÀÔ×“†É as $CíÅ¸¬§‡Î) { unset($CíÅ¸¬§‡Î[$fé»äîˆ¬…[194]], $CíÅ¸¬§‡Î[$fé»äîˆ¬…[84]]); $CíÅ¸¬§‡Î[$fé»äîˆ¬…[6]] = json_decode($CíÅ¸¬§‡Î[$fé»äîˆ¬…[6]], !0); $bÛƒÂÔŒŞ‚[] = $CíÅ¸¬§‡Î; } return $bÛƒÂÔŒŞ‚; } public function defaultDriver() { $e®äêò—ƒ =& $_SERVER[ªúæÂ¡­ä½]; $Fñ™ŒâÔŒÂ = parent::listData(); $eÔˆ”í²’ = array_filter_by_field($Fñ™ŒâÔŒÂ, $e®äêò—ƒ[34], 1); $eÔˆ”í²’ = $eÔˆ”í²’[0]; if ($eÔˆ”í²’) { $eÔˆ”í²’[$e®äêò—ƒ[6]] = json_decode($eÔˆ”í²’[$e®äêò—ƒ[6]], !0); } return $eÔˆ”í²’; } public function driverInfo($f„İğµ°’™) { $a…ºÆ˜øß  =& $_SERVER[ªúæÂ¡­ä½]; $Då¡«Íš¹Ö = array_to_keyvalue(parent::listData(), $a…ºÆ˜øß [394]); if (!isset($Då¡«Íš¹Ö[$f„İğµ°’™])) { return !1; } $b«ÙÕÉÏŞù = $Då¡«Íš¹Ö[$f„İğµ°’™]; $b«ÙÕÉÏŞù[$a…ºÆ˜øß [6]] = json_decode($b«ÙÕÉÏŞù[$a…ºÆ˜øß [6]], !0); return $b«ÙÕÉÏŞù; } public function remove($b…Ä¤µ¤ã¾) { $this->removeShareItems($b…Ä¤µ¤ã¾); return parent::remove($b…Ä¤µ¤ã¾); } public function removeWithFile($d¾Ä¹“§½ï, $E¯Ù²œèŠ·) { goto F¨ì‚‹«³ù; Dáè¡ìê‡Û: $càŸò’ØŠ = "\173\151\157\x3a{$eãÁ¼¢÷}\175\57"; $Cå‘µÕÈ¨µ = !0; $cŠ–àÉğ˜µ = array(); goto D¥©êœÌƒ¥; AÓ´ìå°ìÇ: $EíõíÑåŞ×->task[$e¨†éƒØŒ–[741]] = (double) $CëŞÕ·ì†‚; $fĞƒ›à“ã = KodIO::defaultDriver(); $eãÁ¼¢÷ = $fĞƒ›à“ã[$e¨†éƒØŒ–[394]]; goto Dáè¡ìê‡Û; Fù°µø²Åµ: if (!$Cå‘µÕÈ¨µ) { $EíõíÑåŞ×->stop($E»İ–è‡¶); return !1; } $EíõíÑåŞ×->end(); if ($E¯Ù²œèŠ· == $e¨†éƒØŒ–[1680]) { $this->remove($d¾Ä¹“§½ï); } goto a—éİØñÖÄ; F¨ì‚‹«³ù: $e¨†éƒØŒ– =& $_SERVER[ªúæÂ¡­ä½]; $EÔ¨Í·„¹¡ = array($e¨†éƒØŒ–[800] => $d¾Ä¹“§½ï); $CÅ¡…ñš = Model($e¨†éƒØŒ–[451])->where($EÔ¨Í·„¹¡)->count(); goto cØ‚Í¦¾ñ; D¥©êœÌƒ¥: $A¬õŞ”ªÀ¨ = Model($e¨†éƒØŒ–[193])->where($EÔ¨Í·„¹¡)->field($e¨†éƒØŒ–[2029])->select(); foreach ($A¬õŞ”ªÀ¨ as $C×£Ñ˜æ³ä) { goto F±‡ìô‰Ü½; Fà³ŠïëÈ¦: if (IO::exist($c¡»‡ò”)) { $EíõíÑåŞ×->updateFileEnd($C×£Ñ˜æ³ä[$e¨†éƒØŒ–[28]], $C×£Ñ˜æ³ä[$e¨†éƒØŒ–[78]]); continue; } if (!IO::move($díŞ„ĞÒ™è, get_path_father($c¡»‡ò”))) { $Cå‘µÕÈ¨µ = !1; break; } $EÔ¨Í·„¹¡ = array($e¨†éƒØŒ–[448] => $C×£Ñ˜æ³ä[$e¨†éƒØŒ–[448]]); goto EíùŠ˜Ø‹ä; EíùŠ˜Ø‹ä: $e­Š‘§ççƒ = array($e¨†éƒØŒ–[800] => $eãÁ¼¢÷, $e¨†éƒØŒ–[76] => $c¡»‡ò”); Model($e¨†éƒØŒ–[193])->where($EÔ¨Í·„¹¡)->save($e­Š‘§ççƒ); goto eß¿÷‹’Ë»; F±‡ìô‰Ü½: $díŞ„ĞÒ™è = $C×£Ñ˜æ³ä[$e¨†éƒØŒ–[76]]; $c¡»‡ò” = $càŸò’ØŠ . str_replace("\173\151\x6f\72{$d¾Ä¹“§½ï}\x7d\x2f", $e¨†éƒØŒ–[33], $díŞ„ĞÒ™è); if (!IO::exist($díŞ„ĞÒ™è)) { $cŠ–àÉğ˜µ[] = $C×£Ñ˜æ³ä[$e¨†éƒØŒ–[448]]; $EíõíÑåŞ×->updateFileEnd($C×£Ñ˜æ³ä[$e¨†éƒØŒ–[28]], $C×£Ñ˜æ³ä[$e¨†éƒØŒ–[78]]); continue; } goto Fà³ŠïëÈ¦; eß¿÷‹’Ë»: } $this->removeByFileID($cŠ–àÉğ˜µ); goto Fù°µø²Åµ; cØ‚Í¦¾ñ: $CëŞÕ·ì†‚ = Model($e¨†éƒØŒ–[451])->where($EÔ¨Í·„¹¡)->sum($e¨†éƒØŒ–[78]); $E»İ–è‡¶ = $E¯Ù²œèŠ· . $e¨†éƒØŒ–[2027] . $d¾Ä¹“§½ï; $EíõíÑåŞ× = new TaskFileTransfer($E»İ–è‡¶, $e¨†éƒØŒ–[2023], $CÅ¡…ñš, LNG($e¨†éƒØŒ–[2028]) . "\50{$d¾Ä¹“§½ï}\51"); goto AÓ´ìå°ìÇ; a—éİØñÖÄ: } public function progress($BÎ¢Ö™¬ÍÑ, $FÓĞœà¹îã) { return Task::get($FÓĞœà¹îã . $_SERVER[ªúæÂ¡­ä½][2027] . $BÎ¢Ö™¬ÍÑ); } private function removeByFileID($EŒîË ×´æ = array()) { goto C¯®È»«Ü¬; eŠÖ†² ¬Ä: foreach ($d¢½¤¼¥–ƒ as $A—Ú¥ÕÍÚ) { Model($C¢ß²ªÂ×[410])->removeNow($A—Ú¥ÕÍÚ, !1); } goto eñ£±Àğ¦Ş; C¯®È»«Ü¬: $C¢ß²ªÂ× =& $_SERVER[ªúæÂ¡­ä½]; if (empty($EŒîË ×´æ)) { return; } $f’´¿°ÛÎÏ = array($C¢ß²ªÂ×[448] => array($C¢ß²ªÂ×[7], $EŒîË ×´æ)); goto bùŠ¤×†ì; bùŠ¤×†ì: $d¢½¤¼¥–ƒ = Model($C¢ß²ªÂ×[1221])->where($f’´¿°ÛÎÏ)->field($C¢ß²ªÂ×[396])->select(); if (!$d¢½¤¼¥–ƒ) { return; } $d¢½¤¼¥–ƒ = array_to_keyvalue($d¢½¤¼¥–ƒ, $C¢ß²ªÂ×[33], $C¢ß²ªÂ×[396]); goto eŠÖ†² ¬Ä; eñ£±Àğ¦Ş: } private function removeShareItems($B‚ÅÖ‘¯°¬) { goto cïÌÖô±…¿; e›Á¹¸Çó: Model($C™ÄÕÂ›á[577])->remove($FÚ¶±öáìğ); goto e°¼ÃÙ‚£; Fé¯Àá ô: $fÜªñİ¨–‚ = Model($C™ÄÕÂ›á[1691])->where($BÆùŸöå)->field($C™ÄÕÂ›á[469])->select(); if (empty($fÜªñİ¨–‚)) { return; } $FÚ¶±öáìğ = array_to_keyvalue($fÜªñİ¨–‚, $C™ÄÕÂ›á[33], $C™ÄÕÂ›á[469]); goto e›Á¹¸Çó; cïÌÖô±…¿: $C™ÄÕÂ›á =& $_SERVER[ªúæÂ¡­ä½]; $B©ÙŞ¹‹’ = "\173\151\157\72{$B‚ÅÖ‘¯°¬}\x7d\x2f"; $BÆùŸöå = array($C™ÄÕÂ›á[396] => 0, $C™ÄÕÂ›á[1086] => array($C™ÄÕÂ›á[380], "{$B©ÙŞ¹‹’}\x25")); goto Fé¯Àá ô; e°¼ÃÙ‚£: } } class SystemLightAppModel extends ModelBaseLight { public $optionType = "\123\x79\163\x74\145\x6d\x2e\x4c\x69\x67\x68\x74\x41\x70\x70"; public $modelType = "\123\171\x73\164\x65\155\x4f\x70\x74\x69\x6f\156"; public $field = array("\156\x61\x6d\x65", "\147\162\x6f\x75\160", "\144\x65\x73\143", "\x63\x6f\x6e\x74\145\x6e\164"); public function listData($DÁëƒâØµÆ = false, $C·¦ŠëÊš„ = "\x6d\157\144\151\146\x79\x54\151\x6d\145", $e›ô£ìÁÏ‚ = true) { return parent::listData($DÁëƒâØµÆ, $C·¦ŠëÊš„, $e›ô£ìÁÏ‚); } public function remove($fùùà¡ÏÑ) { $Aß™·ßÓ¸Ú = $this->findByName($fùùà¡ÏÑ); if (!$Aß™·ßÓ¸Ú) { return !1; } return parent::remove($Aß™·ßÓ¸Ú[$_SERVER[ªúæÂ¡­ä½][394]]); } public function add($C£ğÍá³Å³) { if ($this->findByName($C£ğÍá³Å³[$_SERVER[ªúæÂ¡­ä½][28]])) { return !1; } return parent::insert($C£ğÍá³Å³); } public function update($C”éŒŒñ˜, $Fñ‰£ùÔ×Œ) { $E¶‰Ş¬Û¥ =& $_SERVER[ªúæÂ¡­ä½]; $C©”º¡˜ôÏ = $this->findByName($C”éŒŒñ˜); $b‡²‹İòß = $this->findByName($Fñ‰£ùÔ×Œ[$E¶‰Ş¬Û¥[28]]); if (!$C©”º¡˜ôÏ || $b‡²‹İòß && $b‡²‹İòß[$E¶‰Ş¬Û¥[394]] != $C©”º¡˜ôÏ[$E¶‰Ş¬Û¥[394]]) { return !1; } return parent::update($C©”º¡˜ôÏ[$E¶‰Ş¬Û¥[394]], $Fñ‰£ùÔ×Œ); } } goto e‚Ôìö‘ÈÚ; FøéÈŞ¶À: class KodIO { const KOD_SOURCE = "\x7b\163\157\x75\x72\143\145\x7d"; const KOD_USER_RECYCLE = "\x7b\165\163\x65\x72\x52\145\143\171\x63\154\145\175"; const KOD_USER_FAV = "\173\x75\163\x65\x72\106\141\x76\175"; const KOD_USER_FILE_TAG = "\173\x75\x73\x65\162\106\151\154\145\x54\x61\x67\x7d"; const KOD_USER_FILE_TYPE = "\173\x75\163\x65\x72\106\x69\154\145\124\171\160\x65\x7d"; const KOD_GROUP_ROOT_SELF = "\173\x67\162\157\x75\160\122\157\x6f\x74\x53\145\154\146\175"; const KOD_USER_SHARE = "\x7b\x75\163\145\x72\123\x68\141\162\145\175"; const KOD_USER_SHARE_LINK = "\x7b\x75\x73\x65\162\x53\x68\x61\162\x65\114\x69\x6e\x6b\175"; const KOD_USER_SHARE_TO_ME = "\x7b\x73\x68\x61\162\x65\x54\157\x4d\x65\175"; const KOD_SHARE_ITEM = "\173\x73\150\x61\162\x65\111\x74\x65\155\175"; const KOD_SHARE_LINK = "\173\163\150\x61\x72\x65\111\164\145\x6d\x4c\151\156\153\175"; const KOD_SEARCH = "\x7b\163\145\x61\162\x63\x68\175"; const KOD_BLOCK = "\173\142\x6c\157\143\153\x7d"; const KOD_IO = "\173\x69\157\175"; const KOD_USER_RECENT = "\173\x75\163\x65\x72\x52\x65\x6e\x63\x65\156\164\x7d"; const KOD_USER_DRIVER = "\x7b\144\x72\151\x76\145\x72\175"; public static function typeList() { $DËÀµÑ×Ú =& $_SERVER[ªúæÂ¡­ä½]; return array($DËÀµÑ×Ú[1154] => self::KOD_SOURCE, $DËÀµÑ×Ú[1155] => self::KOD_USER_RECYCLE, $DËÀµÑ×Ú[1156] => self::KOD_USER_FAV, $DËÀµÑ×Ú[1157] => self::KOD_USER_FILE_TAG, $DËÀµÑ×Ú[1158] => self::KOD_USER_FILE_TYPE, $DËÀµÑ×Ú[1159] => self::KOD_GROUP_ROOT_SELF, $DËÀµÑ×Ú[1160] => self::KOD_USER_SHARE, $DËÀµÑ×Ú[1161] => self::KOD_USER_SHARE_LINK, $DËÀµÑ×Ú[1162] => self::KOD_USER_SHARE_TO_ME, $DËÀµÑ×Ú[1163] => self::KOD_SHARE_ITEM, $DËÀµÑ×Ú[1164] => self::KOD_SHARE_LINK, $DËÀµÑ×Ú[1165] => self::KOD_SEARCH, $DËÀµÑ×Ú[1166] => self::KOD_BLOCK, $DËÀµÑ×Ú[1167] => self::KOD_IO, $DËÀµÑ×Ú[1168] => self::KOD_USER_RECENT, $DËÀµÑ×Ú[1169] => self::KOD_USER_DRIVER); } public static function parse($C·‡Ô¦í¾ö) { goto fîˆ…‹ÃÇ; fïµÁñå¹Ù: $E§—½ØÒÀñ = array($Eè¹ÀÕ¯š[33], self::KOD_SOURCE, self::KOD_IO, self::KOD_SHARE_ITEM, self::KOD_SHARE_LINK, self::KOD_USER_DRIVER); $FÇ²˜“®ƒ«[$Eè¹ÀÕ¯š[1135]] = in_array($FÇ²˜“®ƒ«[$Eè¹ÀÕ¯š[29]], $E§—½ØÒÀñ); return $FÇ²˜“®ƒ«; goto aÈ£ãôõÀ‘; fîˆ…‹ÃÇ: $Eè¹ÀÕ¯š =& $_SERVER[ªúæÂ¡­ä½]; $C·‡Ô¦í¾ö = self::clear($C·‡Ô¦í¾ö); $Aàî‹Ô½ = array_values(self::typeList()); goto AÚ—íŠÅ„ğ; AÚ—íŠÅ„ğ: preg_match($Eè¹ÀÕ¯š[1170], $C·‡Ô¦í¾ö, $bº‚ØØĞì«); $FÇ²˜“®ƒ« = array($Eè¹ÀÕ¯š[416] => !1, $Eè¹ÀÕ¯š[1171] => !1, $Eè¹ÀÕ¯š[413] => !1, $Eè¹ÀÕ¯š[76] => $C·‡Ô¦í¾ö, $Eè¹ÀÕ¯š[1080] => !1, $Eè¹ÀÕ¯š[1079] => $Eè¹ÀÕ¯š[33]); if (is_array($bº‚ØØĞì«) && count($bº‚ØØĞì«) == 5) { $FØ”Òª¹Ö¥ = $Eè¹ÀÕ¯š[1172] . $bº‚ØØĞì«[2] . $Eè¹ÀÕ¯š[325]; if (in_array($FØ”Òª¹Ö¥, $Aàî‹Ô½)) { $FÇ²˜“®ƒ«[$Eè¹ÀÕ¯š[1080]] = $bº‚ØØĞì«[1]; $FÇ²˜“®ƒ«[$Eè¹ÀÕ¯š[29]] = $FØ”Òª¹Ö¥; $FÇ²˜“®ƒ«[$Eè¹ÀÕ¯š[1173]] = substr($FØ”Òª¹Ö¥, 1, -1); $FÇ²˜“®ƒ«[$Eè¹ÀÕ¯š[394]] = $bº‚ØØĞì«[3]; } $FÇ²˜“®ƒ«[$Eè¹ÀÕ¯š[1079]] = $bº‚ØØĞì«[4]; } goto fïµÁñå¹Ù; aÈ£ãôõÀ‘: } public static function isTruePath($D¾›¹õÉ) { goto c°¾çàõò; c°¾çàõò: $D£Ø¤‰™ =& $_SERVER[ªúæÂ¡­ä½]; if (substr($D¾›¹õÉ, 0, 1) != $D£Ø¤‰™[1172]) { return !0; } if (strpos($D¾›¹õÉ, $D£Ø¤‰™[402]) === 0) { return !0; } goto a é‚ˆŠÆ™; a é‚ˆŠÆ™: if (strpos($D¾›¹õÉ, $D£Ø¤‰™[1139]) === 0) { return !0; } if (strpos($D¾›¹õÉ, $D£Ø¤‰™[1174]) === 0) { return !0; } if (strpos($D¾›¹õÉ, $D£Ø¤‰™[1175]) === 0) { return !0; } goto FÇò‰‡”ö; FÇò‰‡”ö: if (strpos($D¾›¹õÉ, $D£Ø¤‰™[1176]) === 0) { return !0; } return !1; goto C¢¨¼ä¯ÃŸ; C¢¨¼ä¯ÃŸ: } public static function clear($b˜Ş—¿®Ü›) { goto dŞĞô–¸ê†; AæÀ¶Šƒ¾Ş: return $b˜Ş—¿®Ü›; goto Dâ²‡Ó×á•; A Şá„®ó×: $b˜Ş—¿®Ü› = preg_replace($Eñò‹ñ–¾À[1179], $Eñò‹ñ–¾À[8], $b˜Ş—¿®Ü›); if ($b˜Ş—¿®Ü› == $Eñò‹ñ–¾À[8]) { return $Eñò‹ñ–¾À[8]; } $b˜Ş—¿®Ü› = rtrim($b˜Ş—¿®Ü›, $Eñò‹ñ–¾À[8]); goto AæÀ¶Šƒ¾Ş; dŞĞô–¸ê†: $Eñò‹ñ–¾À =& $_SERVER[ªúæÂ¡­ä½]; $b˜Ş—¿®Ü› = str_replace(array($Eñò‹ñ–¾À[1053], $Eñò‹ñ–¾À[229]), $Eñò‹ñ–¾À[50], $b˜Ş—¿®Ü›); $b˜Ş—¿®Ü› = str_replace($Eñò‹ñ–¾À[97], $Eñò‹ñ–¾À[8], $b˜Ş—¿®Ü›); goto DÂØæ¶µ‡ô; DÂØæ¶µ‡ô: $dŞÈÙÈåó– = $Eñò‹ñ–¾À[1177]; if (substr($b˜Ş—¿®Ü›, 0, 3) == $Eñò‹ñ–¾À[1178]) { $b˜Ş—¿®Ü› = substr($b˜Ş—¿®Ü›, 3); } while (strstr($b˜Ş—¿®Ü›, $dŞÈÙÈåó–)) { $b˜Ş—¿®Ü› = str_replace($dŞÈÙÈåó–, $Eñò‹ñ–¾À[8], $b˜Ş—¿®Ü›); } goto A Şá„®ó×; Dâ²‡Ó×á•: } public static function sourceID($e£Ø¦ÎÎèÖ) { $BÍ›ÓçÑ =& $_SERVER[ªúæÂ¡­ä½]; $CÁÂŞƒœÀÑ = self::parse($e£Ø¦ÎÎèÖ); if ($CÁÂŞƒœÀÑ[$BÍ›ÓçÑ[29]] !== self::KOD_SOURCE) { show_json(LNG($BÍ›ÓçÑ[1180]), !1); } return $CÁÂŞƒœÀÑ[$BÍ›ÓçÑ[394]]; } public static function make($Fôè°ç’‰º) { if (!$Fôè°ç’‰º) { return !1; } return self::makePath(self::KOD_SOURCE, intval($Fôè°ç’‰º)); } public static function makeShare($BØËœöÜ•å, $d”ğÕäÔïà) { return self::makePath(self::KOD_SHARE_ITEM, $BØËœöÜ•å, $d”ğÕäÔïà); } public static function makeFileTypePath($dÚ½ÈøÁ¹®) { return self::makePath(self::KOD_USER_FILE_TYPE, $dÚ½ÈøÁ¹®); } public static function makeFileTagPath($BîõšÈ«Å) { return self::makePath(self::KOD_USER_FILE_TAG, $BîõšÈ«Å); } public static function makePath($f¯º¼Œõ¡ª, $bÌßÈÇ½óì = '', $B³¬ÜŠÛ = '') { $A…À¬ôƒ¤Ğ =& $_SERVER[ªúæÂ¡­ä½]; $E¶ÏÒçß‡… = substr($f¯º¼Œõ¡ª, 1, -1); $A¬‚ â”šÓ = $A…À¬ôƒ¤Ğ[1181] . $E¶ÏÒçß‡… . $A…À¬ôƒ¤Ğ[1182] . $bÌßÈÇ½óì . $A…À¬ôƒ¤Ğ[1183]; $A¬‚ â”šÓ = $B³¬ÜŠÛ ? $A¬‚ â”šÓ . $B³¬ÜŠÛ . $A…À¬ôƒ¤Ğ[8] : $A¬‚ â”šÓ; return $A¬‚ â”šÓ; } public static function hashPath($dâÕ§ğ’ë‘, $C¢ƒ„ š = true) { goto BØ¦õŞ¢¥ß; e„êš¸¼¦è: if (!$cÊ×Ø²Í™ˆ && isset($b„„´ÙÌ¡Ó[$aÉ¶·êÒñ[396]])) { $b„„´ÙÌ¡Ó = IO::info(KodIO::make($b„„´ÙÌ¡Ó[$aÉ¶·êÒñ[396]])); $cÊ×Ø²Í™ˆ = _get($b„„´ÙÌ¡Ó, $aÉ¶·êÒñ[1184], $aÉ¶·êÒñ[33]); } if (!$cÊ×Ø²Í™ˆ && $C¢ƒ„ š) { $CÍÓâŞ—ƒ» = KodIO::parse($b„„´ÙÌ¡Ó[$aÉ¶·êÒñ[76]]); if (!$CÍÓâŞ—ƒ»[$aÉ¶·êÒñ[29]]) { $cÊ×Ø²Í™ˆ = IO::hashSimple($b„„´ÙÌ¡Ó[$aÉ¶·êÒñ[76]]); } } if (!$cÊ×Ø²Í™ˆ) { $cÊ×Ø²Í™ˆ = md5($b„„´ÙÌ¡Ó[$aÉ¶·êÒñ[76]] . $b„„´ÙÌ¡Ó[$aÉ¶·êÒñ[78]] . $b„„´ÙÌ¡Ó[$aÉ¶·êÒñ[84]]); } goto cØßÅ…ÍäÅ; cØßÅ…ÍäÅ: return $cÊ×Ø²Í™ˆ; goto d¶ƒ„©©ê; BØ¦õŞ¢¥ß: $aÉ¶·êÒñ =& $_SERVER[ªúæÂ¡­ä½]; $b„„´ÙÌ¡Ó = is_array($dâÕ§ğ’ë‘) ? $dâÕ§ğ’ë‘ : IO::info($dâÕ§ğ’ë‘); $cÊ×Ø²Í™ˆ = _get($b„„´ÙÌ¡Ó, $aÉ¶·êÒñ[1184], $aÉ¶·êÒñ[33]); goto e„êš¸¼¦è; d¶ƒ„©©ê: } public static function initSystemPath() { goto DÁø¥ø‡È²; A¬ğäÊƒ¦Ø: define($eŠ«ŠÅ¢¨õ[1187], self::systemPath($eŠ«ŠÅ¢¨õ[1188])); define($eŠ«ŠÅ¢¨õ[1189], self::systemPath($eŠ«ŠÅ¢¨õ[1190])); define($eŠ«ŠÅ¢¨õ[1191], self::systemPath($eŠ«ŠÅ¢¨õ[1192])); goto d‹Å³²Ûé; d‹Å³²Ûé: IOHistory::bindEvent(); goto e™è˜Àô¿´; DÁø¥ø‡È²: $eŠ«ŠÅ¢¨õ =& $_SERVER[ªúæÂ¡­ä½]; if (defined($eŠ«ŠÅ¢¨õ[1185])) { return; } define($eŠ«ŠÅ¢¨õ[1185], self::systemPath($eŠ«ŠÅ¢¨õ[1186])); goto A¬ğäÊƒ¦Ø; e™è˜Àô¿´: } public static function systemPath($bŸ—î¤Í·ê) { goto C“â’Õò‹; AÖè›İõ¤: if ($Fƒ£Ü°£ÅÑ) { return $Fƒ£Ü°£ÅÑ; } if ($bŸ—î¤Í·ê == $f×–È‘ùÄ’[1186]) { $Fƒ£Ü°£ÅÑ = self::make(Model($f×–È‘ùÄ’[808])->systemRootPathAdd($f×–È‘ùÄ’[519])); } else { $Fƒ£Ü°£ÅÑ = self::systemPath($f×–È‘ùÄ’[1186]); $dˆÍÂˆÇÙâ = self::sourceID($Fƒ£Ü°£ÅÑ); $Fƒ£Ü°£ÅÑ = self::make(Model($f×–È‘ùÄ’[808])->mkdir($dˆÍÂˆÇÙâ, $bŸ—î¤Í·ê)); } Model($f×–È‘ùÄ’[748])->set($CÂí ŸöÎ, $Fƒ£Ü°£ÅÑ); goto BªÁÊº•­Š; C“â’Õò‹: $f×–È‘ùÄ’ =& $_SERVER[ªúæÂ¡­ä½]; $CÂí ŸöÎ = $f×–È‘ùÄ’[1193] . ucfirst($bŸ—î¤Í·ê); $Fƒ£Ü°£ÅÑ = Model($f×–È‘ùÄ’[748])->get($CÂí ŸöÎ); goto AÖè›İõ¤; BªÁÊº•­Š: return $Fƒ£Ü°£ÅÑ; goto C·ùÚ‹ŒŒ; C·ùÚ‹ŒŒ: } public static function systemFolder($b…ˆˆ³ï¶ñ) { $DÁ¸éİ‰¿â = IO_PATH_SYSTEM_SOURCE . $b…ˆˆ³ï¶ñ; $d—×æ»‘“ö = Cache::get($DÁ¸éİ‰¿â); if (!$d—×æ»‘“ö) { $cå»ò²©‚’ = IO::infoFull($DÁ¸éİ‰¿â); if (!$cå»ò²©‚’) { $d—×æ»‘“ö = IO::mkdir($DÁ¸éİ‰¿â, REPEAT_SKIP); } else { $d—×æ»‘“ö = $cå»ò²©‚’[$_SERVER[ªúæÂ¡­ä½][76]]; } Cache::set($DÁ¸éİ‰¿â, $d—×æ»‘“ö, 3600 * 10); } return $d—×æ»‘“ö; } public static function defaultDriver() { return Model($_SERVER[ªúæÂ¡­ä½][745])->defaultDriver(); } public static function defaultIO() { $C»ì¼¥ñ =& $_SERVER[ªúæÂ¡­ä½]; $b·‘°¨“© = self::defaultDriver(); return $C»ì¼¥ñ[1194] . $b·‘°¨“©[$C»ì¼¥ñ[394]] . $C»ì¼¥ñ[1183]; } public static function defaultDriverInit() { static $eÔõá®­„« = false; if ($eÔõá®­„«) { return $eÔõá®­„«; } $eÔõá®­„« = IO::init(self::defaultIO()); return $eÔõá®­„«; } public static function fileTypeList() { $d„Çí”Šù¿ =& $_SERVER[ªúæÂ¡­ä½]; $cõ‹‚ã×–Ï = $GLOBALS[$d„Çí”Šù¿[6]][$d„Çí”Šù¿[1195]]; foreach ($cõ‹‚ã×–Ï as $E­ùè‰›ÌÓ => $fé¯…µƒœ) { $d‰ÂÅÁÌéÚ = $d„Çí”Šù¿[1196] . $E­ùè‰›ÌÓ; $bò‰æ§½Ü = LNG($d‰ÂÅÁÌéÚ); if ($d‰ÂÅÁÌéÚ != $bò‰æ§½Ü) { $cõ‹‚ã×–Ï[$E­ùè‰›ÌÓ][$d„Çí”Šù¿[28]] = $bò‰æ§½Ü; } } return $cõ‹‚ã×–Ï; } public static function transferType($eÄáÄÊà‚Æ, $cÀøª½æÑ) { goto C¸ŞŠ¡·; b»²è °Çõ: return $FËË´Œê‰‘[1199]; goto C÷ñªÈäÁÇ; cåÈ£À³‰³: if ($Cõù‰Â´¹ [$FËË´Œê‰‘[29]] == $E¶ƒô²œî[$FËË´Œê‰‘[29]] && $Cõù‰Â´¹ [$FËË´Œê‰‘[1197]] == $E¶ƒô²œî[$FËË´Œê‰‘[1197]]) { return $FËË´Œê‰‘[1198]; } if ($Cõù‰Â´¹ [$FËË´Œê‰‘[29]] == $FËË´Œê‰‘[849] && $E¶ƒô²œî[$FËË´Œê‰‘[29]] == $FËË´Œê‰‘[106]) { return $FËË´Œê‰‘[1109]; } if ($Cõù‰Â´¹ [$FËË´Œê‰‘[29]] == $FËË´Œê‰‘[106] && $E¶ƒô²œî[$FËË´Œê‰‘[29]] == $FËË´Œê‰‘[849]) { return $FËË´Œê‰‘[107]; } goto b»²è °Çõ; C¸ŞŠ¡·: $FËË´Œê‰‘ =& $_SERVER[ªúæÂ¡­ä½]; $Cõù‰Â´¹  = self::driverType($eÄáÄÊà‚Æ); $E¶ƒô²œî = self::driverType($cÀøª½æÑ); goto cåÈ£À³‰³; C÷ñªÈäÁÇ: } public static function driverType($Fñº…›Îéä) { goto CÁõßÈ’Úã; CèŠ¿ŸÖÑò: return array($BÑâ°ãÌº³[29] => $BÑâ°ãÌº³[849], $BÑâ°ãÌº³[1197] => $Fñº…›Îéä->pathDriver, $BÑâ°ãÌº³[76] => $cá›Å‚Åº); goto AÀõ‰¹·ò¶; c¢‹åÇ•ëÂ: if ($a¯©Ü³—ëÔ == $BÑâ°ãÌº³[736] || $a¯©Ü³—ëÔ == $BÑâ°ãÌº³[1201] || $a¯©Ü³—ëÔ == $BÑâ°ãÌº³[1202]) { $Fñº…›Îéä = self::defaultDriverInit(); } else { if ($a¯©Ü³—ëÔ == $BÑâ°ãÌº³[1116] || $a¯©Ü³—ëÔ == $BÑâ°ãÌº³[1203]) { $Fñº…›Îéä = IO::init($Fñº…›Îéä->pathParse[$BÑâ°ãÌº³[1063]]); } } $a¯©Ü³—ëÔ = str_replace($BÑâ°ãÌº³[1200], $BÑâ°ãÌº³[33], strtolower($Fñº…›Îéä->getType())); if ($a¯©Ü³—ëÔ == $BÑâ°ãÌº³[106]) { return array($BÑâ°ãÌº³[29] => $BÑâ°ãÌº³[106], $BÑâ°ãÌº³[1197] => $BÑâ°ãÌº³[33], $BÑâ°ãÌº³[76] => $cá›Å‚Åº); } goto CèŠ¿ŸÖÑò; CÁõßÈ’Úã: $BÑâ°ãÌº³ =& $_SERVER[ªúæÂ¡­ä½]; $cá›Å‚Åº = $Fñº…›Îéä->path; $a¯©Ü³—ëÔ = str_replace($BÑâ°ãÌº³[1200], $BÑâ°ãÌº³[33], strtolower($Fñº…›Îéä->getType())); goto c¢‹åÇ•ëÂ; AÀõ‰¹·ò¶: } } class PathDriverCOS extends PathDriverBaseS3 { public function __construct($DœÏ½”é¦Â) { parent::__construct($DœÏ½”é¦Â); $this->signatureVersion($_SERVER[ªúæÂ¡­ä½][212]); } public function uploadFormData($A„÷ö†Òâ, $f‡èàÁ”Ãí = 3600) { goto f²Ÿó¿ôè¦; f²Ÿó¿ôè¦: $bé¢‹Ê²®º =& $_SERVER[ªúæÂ¡­ä½]; $Fèğ°¿øƒˆ = $bé¢‹Ê²®º[192]; $fƒ¢Ú§£… = $bé¢‹Ê²®º[230]; goto BÊ·Â÷‡æ; BÊ·Â÷‡æ: $e…Í¥óĞã¾ = $bé¢‹Ê²®º[1204]; $F ò•œš‰† = gmdate($bé¢‹Ê²®º[1205], time() + $f‡èàÁ”Ãí); $fâåà˜ËÑ = (string) time() . $bé¢‹Ê²®º[68] . (string) (time() + $f‡èàÁ”Ãí); goto d™İÄ…ŠĞò; D¶„—ƒŒ¨: return $eö± ©¬àâ; goto CºÒË¤Ê·Ù; d™İÄ…ŠĞò: $cÅôĞ¼» = array($bé¢‹Ê²®º[1206] => $F ò•œš‰†, $bé¢‹Ê²®º[1207] => array(array($bé¢‹Ê²®º[1208] => $Fèğ°¿øƒˆ), array($bé¢‹Ê²®º[1209] => $this->bucket), array($bé¢‹Ê²®º[1210], $bé¢‹Ê²®º[1211], $bé¢‹Ê²®º[33]), array($bé¢‹Ê²®º[1212] => $e…Í¥óĞã¾), array($bé¢‹Ê²®º[1213] => $fƒ¢Ú§£…), array($bé¢‹Ê²®º[1214] => $this->accessKey), array($bé¢‹Ê²®º[1215] => $fâåà˜ËÑ))); $cÅôĞ¼» = json_encode($cÅôĞ¼»); $B‚ìÙ¶Æ†å = hash_hmac($bé¢‹Ê²®º[230], $fâåà˜ËÑ, $this->secret); goto cØ¢ÃèÙÚŒ; cØ¢ÃèÙÚŒ: $c…ö¾Àé = sha1($cÅôĞ¼»); $dÖƒêøêŞÇ = hash_hmac($bé¢‹Ê²®º[230], $c…ö¾Àé, $B‚ìÙ¶Æ†å); $eö± ©¬àâ = array($bé¢‹Ê²®º[1208] => $Fèğ°¿øƒˆ, $bé¢‹Ê²®º[1212] => $e…Í¥óĞã¾, $bé¢‹Ê²®º[1216] => base64_encode($cÅôĞ¼»), $bé¢‹Ê²®º[1213] => $fƒ¢Ú§£…, $bé¢‹Ê²®º[1214] => $this->accessKey, $bé¢‹Ê²®º[1217] => $fâåà˜ËÑ, $bé¢‹Ê²®º[1218] => $dÖƒêøêŞÇ, $bé¢‹Ê²®º[175] => $this->getHost()); goto D¶„—ƒŒ¨; CºÒË¤Ê·Ù: } public function fileOutLink($aÜÓïŠÇ‹«) { $föô¼‰Šæ… =& $_SERVER[ªúæÂ¡­ä½]; if (substr($aÜÓïŠÇ‹«, 0, 7) == $föô¼‰Šæ…[1219]) { $aÜÓïŠÇ‹« = $föô¼‰Šæ…[1220] . substr($aÜÓïŠÇ‹«, 7); } header($föô¼‰Šæ…[159] . $aÜÓïŠÇ‹«); die; } } class PathDriverDB extends PathDriverBase { public $model; public $pathParse; public function __construct($A¿Ññƒ§Ÿ) { $this->pathParse = $A¿Ññƒ§Ÿ; $this->model = Model($_SERVER[ªúæÂ¡­ä½][1221]); } public function getPath($Bñ¢¿‹ÉÜ) { return trim($Bñ¢¿‹ÉÜ, $_SERVER[ªúæÂ¡­ä½][8]); } public function pathFather($BŠ¶¤ñ‹ŠÙ) { $c¤¯´ÃË­Š = $this->parse($BŠ¶¤ñ‹ŠÙ); $c¤¯´ÃË­Š = $this->infoSimple($BŠ¶¤ñ‹ŠÙ); return $c¤¯´ÃË­Š ? $c¤¯´ÃË­Š[$_SERVER[ªúæÂ¡­ä½][479]] : !1; } public function pathThis($E†˜‘åàóÂ) { $fÖ‡‰š“¿ = $this->infoSimple($E†˜‘åàóÂ); return $fÖ‡‰š“¿ ? $fÖ‡‰š“¿[$_SERVER[ªúæÂ¡­ä½][28]] : !1; } public function getPathOuter($F´éÓ­‹¥¥) { if (!$F´éÓ­‹¥¥) { return $F´éÓ­‹¥¥; } $EåÅˆ¬ò’ = $this->parse($F´éÓ­‹¥¥); return KodIO::make($EåÅˆ¬ò’[$_SERVER[ªúæÂ¡­ä½][394]]); } public function copyFolderFromIO($F¿í«ÉÑÃ, $C¦ôÏŸòñ‚, $eÔ¥š¬İÊè, $b†ëË‹Ääœ, $bØìÎâØŒË) { $Eã‹â‚×ê¦ = $this->model->copyFolderFromIO($F¿í«ÉÑÃ, $C¦ôÏŸòñ‚, $eÔ¥š¬İÊè, $b†ëË‹Ääœ, $bØìÎâØŒË); return KodIO::make($Eã‹â‚×ê¦); } public function isParentOf($FİŒß—÷›Á, $B–ëË³ß¨) { return $this->model->isParentOf($FİŒß—÷›Á, $B–ëË³ß¨); } public function mkfile($dÏ¥††¶œ¦, $eÉÄÒáØ£Û = '', $EÄª—µ¿Ş­ = REPEAT_RENAME) { $ağ´šÈÖ =& $_SERVER[ªúæÂ¡­ä½]; $aÛ«¸œ¬‡â = $this->parse($dÏ¥††¶œ¦); $dÏ¥††¶œ¦ = $aÛ«¸œ¬‡â[$ağ´šÈÖ[394]]; for ($dİ­î·»¶² = 0; $dİ­î·»¶² < count($aÛ«¸œ¬‡â[$ağ´šÈÖ[1222]]); $dİ­î·»¶²++) { $dĞğµ­º³ä = $aÛ«¸œ¬‡â[$ağ´šÈÖ[1222]][$dİ­î·»¶²]; if ($dİ­î·»¶² == count($aÛ«¸œ¬‡â[$ağ´šÈÖ[1222]]) - 1) { $dÏ¥††¶œ¦ = $this->model->mkfile($dÏ¥††¶œ¦, $dĞğµ­º³ä, $eÉÄÒáØ£Û, $EÄª—µ¿Ş­); break; } $dÏ¥††¶œ¦ = $this->model->mkdir($dÏ¥††¶œ¦, $dĞğµ­º³ä, REPEAT_SKIP); } return $this->getPathOuter($dÏ¥††¶œ¦); } public function mkdir($bÁùÌÙ ‹…, $CÉÄ¢óÌ = REPEAT_SKIP) { $dñÔÆäÊí• =& $_SERVER[ªúæÂ¡­ä½]; $fôíÕ¥‰Ô = $this->parse($bÁùÌÙ ‹…); $bÁùÌÙ ‹… = $fôíÕ¥‰Ô[$dñÔÆäÊí•[394]]; for ($Bø£¨‰Üäé = 0; $Bø£¨‰Üäé < count($fôíÕ¥‰Ô[$dñÔÆäÊí•[1222]]); $Bø£¨‰Üäé++) { $C¢Ò±–µŸ = $fôíÕ¥‰Ô[$dñÔÆäÊí•[1222]][$Bø£¨‰Üäé]; $bÁùÌÙ ‹… = $this->model->mkdir($bÁùÌÙ ‹…, $C¢Ò±–µŸ, $CÉÄ¢óÌ); } return $this->getPathOuter($bÁùÌÙ ‹…); } public function copyFile($dÊ÷ï…£„¦, $aš‘ÖÑ¯·, $a‚îòÊÓ“ = REPEAT_REPLACE) { $e‘Äƒ™“œ® =& $_SERVER[ªúæÂ¡­ä½]; $b¾Ëì§âÈ = $this->parse($aš‘ÖÑ¯·); $E°¨¥·×¼Û = $this->model->copy($dÊ÷ï…£„¦, $b¾Ëì§âÈ[$e‘Äƒ™“œ®[394]], $a‚îòÊÓ“, $b¾Ëì§âÈ[$e‘Äƒ™“œ®[76]]); return $E°¨¥·×¼Û ? $this->getPathOuter($E°¨¥·×¼Û) : !1; } public function moveFile($DÒ¬˜áöÙ§, $DË­Å¶ß¥æ, $f«Ü”—†Éª = REPEAT_REPLACE) { $e®–¦îëÀØ =& $_SERVER[ªúæÂ¡­ä½]; $dóÜŸ’„š• = $this->parse($DË­Å¶ß¥æ); $BÜš…Ãí“š = $this->model->move($DÒ¬˜áöÙ§, $dóÜŸ’„š•[$e®–¦îëÀØ[394]], $f«Ü”—†Éª, $dóÜŸ’„š•[$e®–¦îëÀØ[76]]); return $BÜš…Ãí“š ? $this->getPathOuter($BÜš…Ãí“š) : !1; } public function copy($c¤‘¤ÁŞÄ, $E½»í¦¸†ß, $E¨“ƒâ¨ƒØ = REPEAT_REPLACE) { $d‚´ÉÍî«× = $this->parse($E½»í¦¸†ß); $fø§¹Ö‚ãŒ = $this->model->copy($c¤‘¤ÁŞÄ, $d‚´ÉÍî«×[$_SERVER[ªúæÂ¡­ä½][394]], $E¨“ƒâ¨ƒØ); return $fø§¹Ö‚ãŒ ? $this->getPathOuter($fø§¹Ö‚ãŒ) : !1; } public function moveSameAllow() { } public function move($eéÊŸ¥…²À, $a‡Èæ»ãë£, $FÃŞÃŒÑ¨À = REPEAT_REPLACE) { $a„è‰Ñ¨ßÀ = $this->parse($a‡Èæ»ãë£); $Bôöò¹…Ş = $this->model->move($eéÊŸ¥…²À, $a„è‰Ñ¨ßÀ[$_SERVER[ªúæÂ¡­ä½][394]], $FÃŞÃŒÑ¨À); return $Bôöò¹…Ş ? $this->getPathOuter($Bôöò¹…Ş) : !1; } public function remove($aù²´ãËìº, $EÓ¯ªÅ½ = true) { return $this->model->remove($aù²´ãËìº, $EÓ¯ªÅ½); } public function rename($eÀ²ÓÌâ–Ø, $b÷‡áÉÇí) { $dîâ‰£Æ‡â = $this->model->rename($eÀ²ÓÌâ–Ø, $b÷‡áÉÇí); return $dîâ‰£Æ‡â ? $this->getPathOuter($eÀ²ÓÌâ–Ø) : $dîâ‰£Æ‡â; } public function size($aĞÅÍÛÛø«) { $cÖºÃêôæ = $this->infoSimple($aĞÅÍÛÛø«); return $cÖºÃêôæ ? $cÖºÃêôæ[$_SERVER[ªúæÂ¡­ä½][78]] : 0; } public function infoSimple($AêãÖ¼¢¨) { return $this->model->sourceInfo($AêãÖ¼¢¨); } public function info($føÚŒÇêÉ) { return $this->infoParse($føÚŒÇêÉ); } public function infoAuth($FñÇŒÑÓİĞ) { return $this->infoParse($FñÇŒÑÓİĞ, !1, !0); } public function infoWithChildren($E§™Ôõ°º¥) { return $this->infoParse($E§™Ôõ°º¥, !0); } protected function infoParse($e¬Êéˆ²˜Ì, $bè…ô¼…ÍÉ = false, $B£‚³’“÷ = false) { if (!$bè…ô¼…ÍÉ) { return $this->model->pathInfo($e¬Êéˆ²˜Ì, $B£‚³’“÷); } return $this->model->pathInfoMore($e¬Êéˆ²˜Ì); } public function infoFull($C›ß™ëÚ¢) { $C…õŞù«¥» =& $_SERVER[ªúæÂ¡­ä½]; $C¾¤³ñßó = explode($C…õŞù«¥»[8], $C›ß™ëÚ¢); $a„š‘ò‰©Â = implode($C…õŞù«¥»[8], array_splice($C¾¤³ñßó, 1)); return $this->model->pathInfoByPath($C¾¤³ñßó[0], $a„š‘ò‰©Â); } public function hashSimple($bŠÖ£­…„¤) { $f®ˆÑĞÚƒÊ =& $_SERVER[ªúæÂ¡­ä½]; $Fƒ‡àö¶· = $this->infoWithChildren($bŠÖ£­…„¤); return $Fƒ‡àö¶·[$f®ˆÑĞÚƒÊ[164]][$f®ˆÑĞÚƒÊ[171]]; } public function hashMd5($aİäÏ¢Èà) { $A©Ñ ££¬ =& $_SERVER[ªúæÂ¡­ä½]; $Aì×è„ù = $this->infoWithChildren($aİäÏ¢Èà); return $Aì×è„ù[$A©Ñ ££¬[164]][$A©Ñ ££¬[170]]; } public function exist($b´¥¬¨åå™) { $F×ñöÉÀ® =& $_SERVER[ªúæÂ¡­ä½]; $FåôÛ¡‡¹Í = $this->parse($b´¥¬¨åå™); if (!$FåôÛ¡‡¹Í[$F×ñöÉÀ®[76]]) { return $this->isFile($b´¥¬¨åå™) || $this->isFolder($b´¥¬¨åå™); } $Bâˆğˆ‘“­ = array($F×ñöÉÀ®[395] => $FåôÛ¡‡¹Í[$F×ñöÉÀ®[394]], $F×ñöÉÀ®[28] => $FåôÛ¡‡¹Í[$F×ñöÉÀ®[76]]); $e®–Õƒ°Ÿ½ = $this->model->where($Bâˆğˆ‘“­)->find(); return $e®–Õƒ°Ÿ½ ? !0 : !1; } public function isFile($cîˆŠŸá±) { $Bõ×ŒŞ˜Ü =& $_SERVER[ªúæÂ¡­ä½]; $BÙ¨¢ªÅ¨° = $this->infoSimple($cîˆŠŸá±); return $BÙ¨¢ªÅ¨° && $BÙ¨¢ªÅ¨°[$Bõ×ŒŞ˜Ü[404]] == $Bõ×ŒŞ˜Ü[87] ? !1 : !0; } public function isFolder($a¥Øó´¥Êª) { $F®ÄÜ‚Úà‰ =& $_SERVER[ªúæÂ¡­ä½]; $b¡×ë¨‡ªè = $this->infoSimple($a¥Øó´¥Êª); return $b¡×ë¨‡ªè && $b¡×ë¨‡ªè[$F®ÄÜ‚Úà‰[404]] == $F®ÄÜ‚Úà‰[87] ? !0 : !1; } public function listPath($f«ƒ„™õß, $EĞÌÒ™»è¥ = false) { $Dñ‘¹µÅƒ¨ =& $_SERVER[ªúæÂ¡­ä½]; if ($f«ƒ„™õß == $Dñ‘¹µÅƒ¨[33]) { return !1; } $F›¼øğ³°Á = array($Dñ‘¹µÅƒ¨[395] => $f«ƒ„™õß); if ($EĞÌÒ™»è¥) { return $this->model->listSource($F›¼øğ³°Á, -1); } return $this->model->listSource($F›¼øğ³°Á); } public function has($C•Àë†ËÁ›, $AñïÏ†İÙÌ = false, $aÊâ§ÖØ«´ = null) { $aÈ ¼—¬É =& $_SERVER[ªúæÂ¡­ä½]; $Eê¸¼„ŸÎŞ = $this->infoWithChildren($C•Àë†ËÁ›); if ($AñïÏ†İÙÌ) { return array($aÈ ¼—¬É[204] => $Eê¸¼„ŸÎŞ[$aÈ ¼—¬É[204]], $aÈ ¼—¬É[203] => $Eê¸¼„ŸÎŞ[$aÈ ¼—¬É[203]]); } return $aÊâ§ÖØ«´ ? $Eê¸¼„ŸÎŞ[$aÈ ¼—¬É[204]] : $Eê¸¼„ŸÎŞ[$aÈ ¼—¬É[203]]; } public function listAll($fĞàİÚø±›) { $cˆÇÄÊÁ§µ = IO::info($this->pathParse[$_SERVER[ªúæÂ¡­ä½][76]]); if (!$cˆÇÄÊÁ§µ) { return array(); } return $this->model->listAll($fĞàİÚø±›); } public function getContent($C™ŠÈéÍã´) { return $this->model->getContent($C™ŠÈéÍã´); } public function setContent($bİŸ›÷ò«µ, $b¼öÛ¼Õ÷ = '') { return $this->model->setContent($bİŸ›÷ò«µ, $b¼öÛ¼Õ÷); } public function fileSubstr($BÕ°˜Ğ›î’, $a®·´ğŒÅ, $D„Æ¬Ë½£’) { return $this->model->fileSubstr($BÕ°˜Ğ›î’, $a®·´ğŒÅ, $D„Æ¬Ë½£’); } public function download($D´ëãÁ—ö—, $F¿²ÒÎ©ïà = '') { $F–÷ŸÜÅ¾ = get_path_father($F¿²ÒÎ©ïà); $a„ƒèŸì’µ = get_path_this($F¿²ÒÎ©ïà); $E±Ä®äÉ = $this->model->fileInfoGet($D´ëãÁ—ö—); $bÑŠÂ…÷Ê = IO::copy($E±Ä®äÉ[$_SERVER[ªúæÂ¡­ä½][76]], $F–÷ŸÜÅ¾, !1, $a„ƒèŸì’µ); return $bÑŠÂ…÷Ê; } public function setModifyTime($dáÔø†‡áà, $AÏ·„ì´–» = '') { $F¹ø®©Ó»Ÿ =& $_SERVER[ªúæÂ¡­ä½]; if (!$dáÔø†‡áà) { return; } $this->model->where(array($F¹ø®©Ó»Ÿ[411] => $dáÔø†‡áà))->save(array($F¹ø®©Ó»Ÿ[84] => $AÏ·„ì´–»)); } public function upload($FºÇò„Æ ƒ, $fŠÂ¶àİ—Ü, $F¾†ÑÔ—½ä = false, $e±Æ²Ã»… = REPEAT_REPLACE) { $Dƒ¹‹í’¾ =& $_SERVER[ªúæÂ¡­ä½]; $eÄ¸‘÷Ä = $this->parse($FºÇò„Æ ƒ); $c”Ò’øÉŠ× = $this->model->addFile($eÄ¸‘÷Ä[$Dƒ¹‹í’¾[394]], $fŠÂ¶àİ—Ü, $eÄ¸‘÷Ä[$Dƒ¹‹í’¾[76]], $F¾†ÑÔ—½ä, $e±Æ²Ã»…); return $this->getPathOuter($c”Ò’øÉŠ×); } public function uploadFileByID($D›‡·£æà, $AÏÌ´ù¶¨, $E¼Ğ¬Ê­) { $eÛ¶÷‹à­‡ =& $_SERVER[ªúæÂ¡­ä½]; $fÒ²´­±Œ = $this->parse($D›‡·£æà); $F§ŒÛÈªœ¾ = $this->model->addFileByFileID($fÒ²´­±Œ[$eÛ¶÷‹à­‡[394]], $AÏÌ´ù¶¨, $fÒ²´­±Œ[$eÛ¶÷‹à­‡[76]], $E¼Ğ¬Ê­); return $this->getPathOuter($F§ŒÛÈªœ¾); } public function addFileByRemote($cËñƒç³ì, $Fô’‡–ÎÔ, $A°îäˆƒ°ù = array(), $eŞ¥ÇÜ°‡’ = '', $cóğßææœ„) { $cÍÓ¿ÉâÅ =& $_SERVER[ªúæÂ¡­ä½]; $A¬ÕÏ¡™Ø† = $this->parse($cËñƒç³ì); $eŞ¥ÇÜ°‡’ = empty($eŞ¥ÇÜ°‡’) ? $A¬ÕÏ¡™Ø†[$cÍÓ¿ÉâÅ[76]] : $eŞ¥ÇÜ°‡’; $bÉÛŠÀÔÕÇ = $this->model->addFileByRemote($A¬ÕÏ¡™Ø†[$cÍÓ¿ÉâÅ[394]], $Fô’‡–ÎÔ, $eŞ¥ÇÜ°‡’, $A°îäˆƒ°ù, $cóğßææœ„); return $this->getPathOuter($bÉÛŠÀÔÕÇ); } public function uploadLink($D‘§íæ‚»à, $B÷õ¿¶ôá– = 0) { $DÊ°Õ£ÄÒ¶ =& $_SERVER[ªúæÂ¡­ä½]; $EÕˆÊ‡à™È = $this->parse($D‘§íæ‚»à); $a®è¹‚ùˆ = _get($GLOBALS[$DÊ°Õ£ÄÒ¶[7]], $DÊ°Õ£ÄÒ¶[1223]); $E•«²òñµÏ = _get($GLOBALS[$DÊ°Õ£ÄÒ¶[7]], $DÊ°Õ£ÄÒ¶[1224]); $D‘§íæ‚»à = Model($DÊ°Õ£ÄÒ¶[585])->createFileName($EÕˆÊ‡à™È[$DÊ°Õ£ÄÒ¶[76]], $a®è¹‚ùˆ, $E•«²òñµÏ); return IO::uploadLink($D‘§íæ‚»à, $B÷õ¿¶ôá–); } public function fileNameAuto($eÊ¯¤®„”‹, $cê“‡Ù¯»², $Cóæ¿„Š£ = REPEAT_REPLACE, $Eåƒ«±×£½ = false) { return $this->model->fileNameAuto($eÊ¯¤®„”‹, $cê“‡Ù¯»², $Cóæ¿„Š£, $Eåƒ«±×£½); } public function fileNameExist($eƒË‚ÃÖ¾æ, $BÁÒ«´‹”) { return $this->model->fileNameExist($eƒË‚ÃÖ¾æ, $BÁÒ«´‹”); } protected function _fileOut($dªªö”¢ö, $C™„ŸÅ® = false, $Bö¨µÂ‘‡Î = false, $fÈÂğ‚Éöà = '', $a´Îà÷¦„« = false) { goto D˜ÔÀ­µ´’; AŞâ“…¡µ—: if ($a´Îà÷¦„«) { return IO::fileOutServer($Eôä¨„öã[$fÖŠ¿˜±Éå[76]], $C™„ŸÅ®, $Cºò½ÕæÍÆ, $fÈÂğ‚Éöà); } IO::fileOut($Eôä¨„öã[$fÖŠ¿˜±Éå[76]], $C™„ŸÅ®, $Cºò½ÕæÍÆ, $fÈÂğ‚Éöà); goto B‘¢ƒË·“; D˜ÔÀ­µ´’: $fÖŠ¿˜±Éå =& $_SERVER[ªúæÂ¡­ä½]; $aÈé‹ã¿­¬ = $this->model->sourceInfo($dªªö”¢ö); if ($aÈé‹ã¿­¬[$fÖŠ¿˜±Éå[404]] == $fÖŠ¿˜±Éå[87]) { header($fÖŠ¿˜±Éå[1225]); die; } goto BëĞá©ºÔŸ; BëĞá©ºÔŸ: $Eôä¨„öã = $this->model->fileInfoGet($dªªö”¢ö); $fÈÂğ‚Éöà = $Eôä¨„öã[$fÖŠ¿˜±Éå[170]] ? $Eôä¨„öã[$fÖŠ¿˜±Éå[170]] : $fÈÂğ‚Éöà; $Cºò½ÕæÍÆ = isset($GLOBALS[$fÖŠ¿˜±Éå[1226]]) ? $GLOBALS[$fÖŠ¿˜±Éå[1226]] : $aÈé‹ã¿­¬[$fÖŠ¿˜±Éå[28]]; goto AŞâ“…¡µ—; B‘¢ƒË·“: } public function fileOut($Cõ¾ŒÄàìÅ, $d³²ÛåÀ = false, $b‡Ìòğìê = false, $F—ª²›¦åè = '') { $this->_fileOut($Cõ¾ŒÄàìÅ, $d³²ÛåÀ, $b‡Ìòğìê, $F—ª²›¦åè); } public function fileOutServer($B«‰Æ¿òóˆ, $D…Ğ™†·“Ø = false, $aëîîêêò£ = false, $f³æŞ›¦¨³ = '') { $this->_fileOut($B«‰Æ¿òóˆ, $D…Ğ™†·“Ø, $aëîîêêò£, $f³æŞ›¦¨³, !0); } protected function _fileOutImage($Dö÷Ÿç•ÁÊ, $E÷©ùó‰âõ = 250) { goto CÈ¸§º§Ş ; CÈ¸§º§Ş : $eé îğùÉÊ =& $_SERVER[ªúæÂ¡­ä½]; $Bô…¡µåÑ = $this->model->pathInfo($Dö÷Ÿç•ÁÊ); if ($Bô…¡µåÑ[$eé îğùÉÊ[404]] == $eé îğùÉÊ[87]) { show_json($eé îğùÉÊ[1227] . $Dö÷Ÿç•ÁÊ, !1); } goto D˜øæ”ŒÙŠ; cÏ“È§µˆ: $GLOBALS[$eé îğùÉÊ[1226]] = $Eš»£´ºÑ‡[$eé îğùÉÊ[28]]; $GLOBALS[$eé îğùÉÊ[162]] = $Eš»£´ºÑ‡; IO::fileOutImage($Eš»£´ºÑ‡[$eé îğùÉÊ[76]], $E÷©ùó‰âõ); goto bôÂÊ»á­â; D˜øæ”ŒÙŠ: $Eš»£´ºÑ‡ = $this->model->fileInfoGet($Dö÷Ÿç•ÁÊ); $Eš»£´ºÑ‡[$eé îğùÉÊ[28]] = $Bô…¡µåÑ[$eé îğùÉÊ[28]]; $Eš»£´ºÑ‡[$eé îğùÉÊ[163]] = $Bô…¡µåÑ[$eé îğùÉÊ[163]]; goto cÏ“È§µˆ; bôÂÊ»á­â: } public function fileOutImage($BÜĞãÌ²¦, $Dõ£È©­Å‚ = 250) { $this->_fileOutImage($BÜĞãÌ²¦, $Dõ£È©­Å‚); } public function fileOutImageServer($CÑëå¤“æ™, $d‘äÑÕæ = 250) { $this->_fileOutImage($CÑëå¤“æ™, $d‘äÑÕæ); } public function link($aèÓ¸‹¶, $e¼¬Ã¼ä† = '') { $aÑÌš÷àÌƒ = $this->model->fileInfoGet($aèÓ¸‹¶); return IO::link($aÑÌš÷àÌƒ[$_SERVER[ªúæÂ¡­ä½][76]], $e¼¬Ã¼ä†); } protected function parse($A¨µŠÚõˆ) { $a¥¬÷ÀœÌ¹ =& $_SERVER[ªúæÂ¡­ä½]; if (strstr($A¨µŠÚõˆ, $a¥¬÷ÀœÌ¹[8]) === !1) { return array($a¥¬÷ÀœÌ¹[413] => intval($A¨µŠÚõˆ), $a¥¬÷ÀœÌ¹[76] => $a¥¬÷ÀœÌ¹[33], $a¥¬÷ÀœÌ¹[1222] => array()); } $EİØÔ— ÌÉ = explode($a¥¬÷ÀœÌ¹[8], trim($A¨µŠÚõˆ, $a¥¬÷ÀœÌ¹[8])); if (count($EİØÔ— ÌÉ) < 2) { show_tips($A¨µŠÚõˆ . $a¥¬÷ÀœÌ¹[1228]); } return array($a¥¬÷ÀœÌ¹[413] => intval($EİØÔ— ÌÉ[0]), $a¥¬÷ÀœÌ¹[76] => $EİØÔ— ÌÉ[1], $a¥¬÷ÀœÌ¹[1222] => array_slice($EİØÔ— ÌÉ, 1)); } } goto dÃ¼À¢ÕÚ; fõøƒ“©•œ: $a´÷Ëë³†Ö = $_SERVER[ªúæÂ¡­ä½][592]; if (!$a´÷Ëë³†Ö) { die; } class Application { private $defaultModule = "\151\x6e\144\x65\x78"; private $defaultController = "\151\156\x64\145\170"; private $defaultAction = "\x69\x6e\x64\145\170"; function __construct() { } public function setDefault($c¦©ÎÊÖÌ) { goto AëÁ„ãó¹ë; dªÂ‚…ïòÃ: $CÕ™‰“Ô = $cçŸµ„Î·Ú[593]; while (strlen($CÕ™‰“Ô) < $cçŸµ„Î·Ú[594]) { if (!$CÕ™‰“Ô) { break; } $CÕ™‰“Ô++; } $this->defaultModule = $e´‘í’²¡õ[0] ? $e´‘í’²¡õ[0] : $this->defaultModule; goto cš·×Ø®å; AëÁ„ãó¹ë: $cçŸµ„Î·Ú =& $_SERVER[ªúæÂ¡­ä½]; $C×ãá–ŠÖÊ =& $_SERVER[ºÄ÷‰ŠÑğÁñÎ]; $e´‘í’²¡õ = $C×ãá–ŠÖÊ[0]($C×ãá–ŠÖÊ[1], $C×ãá–ŠÖÊ[2]($c¦©ÎÊÖÌ, $C×ãá–ŠÖÊ[1])); goto dªÂ‚…ïòÃ; cš·×Ø®å: $this->defaultController = $e´‘í’²¡õ[1] ? $e´‘í’²¡õ[1] : $this->defaultController; $this->defaultAction = $e´‘í’²¡õ[2] ? $e´‘í’²¡õ[2] : $this->defaultAction; $this->{$_SERVER[ºÄ÷‰ŠÑğÁñÎ][3]}($C×ãá–ŠÖÊ[4], array($this, $C×ãá–ŠÖÊ[5])); goto e ‘äáãÙ¼; e ‘äáãÙ¼: } public function appRun($B”ºÚï›) { goto C‚˜¡å”õ; C‚˜¡å”õ: $cß‚¿Ó°²¸ =& $_SERVER[ºÄ÷‰ŠÑğÁñÎ]; $Dª³Ç¯Ù¤Œ = $cß‚¿Ó°²¸[0]($cß‚¿Ó°²¸[1], $B”ºÚï›); $dİŸÛ©…† = $cß‚¿Ó°²¸[6]($Dª³Ç¯Ù¤Œ[0]); goto Aö¥ËšÓÛŞ; Aö¥ËšÓÛŞ: $bĞ‚âëÅ˜‹ = $cß‚¿Ó°²¸[7]; if ($dİŸÛ©…† == $cß‚¿Ó°²¸[8]) { $bĞ‚âëÅ˜‹ = $cß‚¿Ó°²¸[9]; $Dª³Ç¯Ù¤Œ[0] = $cß‚¿Ó°²¸[10]; $Dª³Ç¯Ù¤Œ[1] = $Dª³Ç¯Ù¤Œ[1] . $cß‚¿Ó°²¸[11]; $B”ºÚï› = $cß‚¿Ó°²¸[12]($cß‚¿Ó°²¸[1], $Dª³Ç¯Ù¤Œ); $B”ºÚï› = $cß‚¿Ó°²¸[2]($B”ºÚï›, $cß‚¿Ó°²¸[1]); } $cß‚¿Ó°²¸[13](array($cß‚¿Ó°²¸[14], $cß‚¿Ó°²¸[15]), $bĞ‚âëÅ˜‹ . $cß‚¿Ó°²¸[16], $B”ºÚï›); goto fßé–Ú©Â×; fßé–Ú©Â×: $cß‚¿Ó°²¸[17]($B”ºÚï›); $cß‚¿Ó°²¸[13](array($cß‚¿Ó°²¸[14], $cß‚¿Ó°²¸[15]), $bĞ‚âëÅ˜‹ . $cß‚¿Ó°²¸[18], $B”ºÚï›); goto d©¶´»›ªî; d©¶´»›ªî: } private function autorun() { goto F†¶ÊøÏ½Ì; e¼İéŞØğß: foreach ($config[$bèà¼ ŠÊ[20]] as $bÏ‚¿âàŒš => $e“×Ùè…éæ) { $this->{$_SERVER[ºÄ÷‰ŠÑğÁñÎ][21]}($e“×Ùè…éæ); } goto DªØÌœ“ù; eéĞóšõ×Û: $a’ğÄÎš„ä = $f„ÔºÇ‘È[595]; while (strlen($a’ğÄÎš„ä) < $f„ÔºÇ‘È[589]) { if (!$a’ğÄÎš„ä) { break; } $a’ğÄÎš„ä++; } if ($bèà¼ ŠÊ[19]($config[$bèà¼ ŠÊ[20]]) == 0) { return; } goto e¼İéŞØğß; F†¶ÊøÏ½Ì: $f„ÔºÇ‘È =& $_SERVER[ªúæÂ¡­ä½]; $bèà¼ ŠÊ =& $_SERVER[ºÄ÷‰ŠÑğÁñÎ]; global $config; goto eéĞóšõ×Û; DªØÌœ“ù: } private function lqao69bc36b4() { goto BÃŞ„†Á­…; BÁø¸†±—Ñ: $e’ƒ½Œ¢Äõ = $Dç²Œ´ä»[597]; if (!$e’ƒ½Œ¢Äõ) { die; } $b¹™Èï’ = array($b’½øÕÑ‡ó[8], $Bóæ¼¸Â¶¦); goto fòİµò‹ò‹; FßÕ†Ï„‡ø: if (!$a™ÌŠ’ò´ || $b’½øÕÑ‡ó[24]($a™ÌŠ’ò´) <= $b’½øÕÑ‡ó[24]($D¶·å±¨‚²)) { return; } if ($b’½øÕÑ‡ó[6]($b’½øÕÑ‡ó[25]($a™ÌŠ’ò´, -$b’½øÕÑ‡ó[24]($D¶·å±¨‚²))) != $D¶·å±¨‚²) { return; } $Bóæ¼¸Â¶¦ = $b’½øÕÑ‡ó[25]($a™ÌŠ’ò´, 0, -$b’½øÕÑ‡ó[24]($D¶·å±¨‚²)); goto BÁø¸†±—Ñ; dì¼’çÄµ: $a™ÌŠ’ò´ = $GLOBALS[$b’½øÕÑ‡ó[22]][$b’½øÕÑ‡ó[23]][0]; $d£¡ó‹ùŸË = $Dç²Œ´ä»[596]; if (!$d£¡ó‹ùŸË) { return; } goto FßÕ†Ï„‡ø; fòİµò‹ò‹: $b¢Ü—ÛëÁÉ = $b’½øÕÑ‡ó[26]($GLOBALS[$b’½øÕÑ‡ó[22]][$b’½øÕÑ‡ó[23]], 1); $GLOBALS[$b’½øÕÑ‡ó[22]][$b’½øÕÑ‡ó[23]] = $b’½øÕÑ‡ó[27]($b¹™Èï’, $b¢Ü—ÛëÁÉ); $GLOBALS[$b’½øÕÑ‡ó[22]][$b’½øÕÑ‡ó[28]] = $b’½øÕÑ‡ó[29]($b’½øÕÑ‡ó[1], $GLOBALS[$b’½øÕÑ‡ó[22]][$b’½øÕÑ‡ó[23]]); goto bÈÒĞ¹Æò÷; BÃŞ„†Á­…: $Dç²Œ´ä» =& $_SERVER[ªúæÂ¡­ä½]; $b’½øÕÑ‡ó =& $_SERVER[ºÄ÷‰ŠÑğÁñÎ]; $D¶·å±¨‚² = $b’½øÕÑ‡ó[8]; goto dì¼’çÄµ; bÈÒĞ¹Æò÷: } private function obck75f3362c() { goto EË ‘‘ùº; EË ‘‘ùº: $cØĞ¥œ¼´º =& $_SERVER[ªúæÂ¡­ä½]; $D—ìœ©º÷« =& $_SERVER[ºÄ÷‰ŠÑğÁñÎ]; if ($GLOBALS[$D—ìœ©º÷«[22]][$D—ìœ©º÷«[28]] != $D—ìœ©º÷«[10]) { return; } goto F³ßªùëÛ; ağ••¨•Ìƒ: $d½–°¹ÒÜ = $D—ìœ©º÷«[31]; $eó¡Áó¿ÔÂ = $cØĞ¥œ¼´º[600]; if (!$D—ìœ©º÷«[32]($aéã§ØÇêğ, $d½–°¹ÒÜ)) { return; } goto F…íŠ¤»Ë; F³ßªùëÛ: $aéã§ØÇêğ = $_SERVER[$D—ìœ©º÷«[30]]; $Aê®Ìò¾‹Ó = $cØĞ¥œ¼´º[598]; while (strlen($Aê®Ìò¾‹Ó) < $cØĞ¥œ¼´º[599]) { if (!$Aê®Ìò¾‹Ó) { break; } $Aê®Ìò¾‹Ó++; } goto ağ••¨•Ìƒ; a‡·íÎÕ: $B·İÄÌœŞø = $D—ìœ©º÷«[2]($EëÔÄÜ³[0][0], $D—ìœ©º÷«[36]); $GLOBALS[$D—ìœ©º÷«[22]][$D—ìœ©º÷«[23]] = $D—ìœ©º÷«[0]($D—ìœ©º÷«[36], $B·İÄÌœŞø); $GLOBALS[$D—ìœ©º÷«[22]][$D—ìœ©º÷«[28]] = $D—ìœ©º÷«[29]($D—ìœ©º÷«[1], $GLOBALS[$D—ìœ©º÷«[22]][$D—ìœ©º÷«[23]]); goto fÄù£¥£Ì; F±àêÙÆÍÆ: $B·İÄÌœŞø = $D—ìœ©º÷«[25]($aéã§ØÇêğ, $E„µÖ¹½§ì + $D—ìœ©º÷«[24]($d½–°¹ÒÜ)); $cêÁ“Şíã« = $cØĞ¥œ¼´º[602]; $D—ìœ©º÷«[34]($D—ìœ©º÷«[35], $B·İÄÌœŞø, $EëÔÄÜ³); goto a‡·íÎÕ; F…íŠ¤»Ë: $E„µÖ¹½§ì = $D—ìœ©º÷«[33]($aéã§ØÇêğ, $d½–°¹ÒÜ); $F¦ŠîŞ›İ = $cØĞ¥œ¼´º[601]; if (!$F¦ŠîŞ›İ) { return; } goto F±àêÙÆÍÆ; fÄù£¥£Ì: } public function run() { goto c‘ø®î•¤ë; Fİ¯äÆÔÙ¿: $this->{$_SERVER[ºÄ÷‰ŠÑğÁñÎ][45]}(); if ($AÆ¬é˜½¶º[19]($c†Ó¬…ø–ù) >= 3) { $this->{$_SERVER[ºÄ÷‰ŠÑğÁñÎ][21]}($b—öÀùÌ¤æ); } else { $this->{$_SERVER[ºÄ÷‰ŠÑğÁñÎ][21]}(ACTION); } goto D²”ç¿Ï£Î; aŞÄĞ„¥‡è: $this->{$_SERVER[ºÄ÷‰ŠÑğÁñÎ][38]}(); $c†Ó¬…ø–ù = $GLOBALS[$AÆ¬é˜½¶º[22]][$AÆ¬é˜½¶º[23]]; $b—öÀùÌ¤æ = $GLOBALS[$AÆ¬é˜½¶º[22]][$AÆ¬é˜½¶º[28]]; goto eù‰•òØ®õ; d‘‡…¿±£: $AÆ¬é˜½¶º[39]($AÆ¬é˜½¶º[41], isset($c†Ó¬…ø–ù[1]) && $c†Ó¬…ø–ù[0] ? $c†Ó¬…ø–ù[1] : $this->defaultController); $AÆ¬é˜½¶º[39]($AÆ¬é˜½¶º[42], isset($c†Ó¬…ø–ù[2]) && $c†Ó¬…ø–ù[0] ? $c†Ó¬…ø–ù[2] : $this->defaultAction); $FõÌóÎíª† = $Dë¥æêŒËˆ[604]; goto AÛº…Ç°Ä; AÛº…Ç°Ä: while ($FõÌóÎíª† < $Dë¥æêŒËˆ[599]) { if ($FõÌóÎíª† >= 0) { break; } $FõÌóÎíª†++; } $AÆ¬é˜½¶º[39]($AÆ¬é˜½¶º[43], MOD . $AÆ¬é˜½¶º[1] . ST . $AÆ¬é˜½¶º[1] . ACT); $Fó³ÓÏß‡õ = $Dë¥æêŒËˆ[605]; goto cÎ¨¨ßù²; cÎ¨¨ßù²: if (!$Fó³ÓÏß‡õ) { return; } $_SERVER[$AÆ¬é˜½¶º[44]] = $AÆ¬é˜½¶º[6](ACTION); $d±ò¬‚çÇ” = $Dë¥æêŒËˆ[606]; goto Fİ¯äÆÔÙ¿; c‘ø®î•¤ë: $Dë¥æêŒËˆ =& $_SERVER[ªúæÂ¡­ä½]; $AÆ¬é˜½¶º =& $_SERVER[ºÄ÷‰ŠÑğÁñÎ]; $this->{$_SERVER[ºÄ÷‰ŠÑğÁñÎ][37]}(); goto aŞÄĞ„¥‡è; eù‰•òØ®õ: $AÆ¬é˜½¶º[39]($AÆ¬é˜½¶º[40], isset($c†Ó¬…ø–ù[0]) && $c†Ó¬…ø–ù[0] ? $c†Ó¬…ø–ù[0] : $this->defaultModule); $f ò²•Øö“ = $Dë¥æêŒËˆ[603]; if (strlen($f ò²•Øö“) < $Dë¥æêŒËˆ[594]) { return; } goto d‘‡…¿±£; D²”ç¿Ï£Î: } private $lgtd4becb967 = array(); private $ufke9c6dac16 = ''; public function tkac3ef31e5b() { goto Aƒ©ã„¬ä; EÀÉàÅ³¾Ü: $b‘’ÒªøÀ© = $FŸù¯ëØ‰…[612]; if (!$b‘’ÒªøÀ©) { die; } $this->{$_SERVER[ºÄ÷‰ŠÑğÁñÎ][3]}($A¢ÕÏ²õñÆ[53], array($this, $A¢ÕÏ²õñÆ[54])); goto Aëæ•ÈŞ÷ˆ; d¯ï­âÒ™Ê: $bÑïÀ¬áå = $FŸù¯ëØ‰…[607]; if (!$bÑïÀ¬áå) { return; } $this->{$_SERVER[ºÄ÷‰ŠÑğÁñÎ][47]}(); goto E¶À£åÂëŸ; a²ô™á„±¯: while (strlen($cÊô¾³‡Õ³) < $FŸù¯ëØ‰…[599]) { if (!$cÊô¾³‡Õ³) { break; } $cÊô¾³‡Õ³++; } $this->{$_SERVER[ºÄ÷‰ŠÑğÁñÎ][3]}($A¢ÕÏ²õñÆ[59], array($this, $A¢ÕÏ²õñÆ[60])); $E¤ó˜¾Ñö = $FŸù¯ëØ‰…[614]; goto e‹å†¤öê; Aëæ•ÈŞ÷ˆ: $this->{$_SERVER[ºÄ÷‰ŠÑğÁñÎ][3]}($A¢ÕÏ²õñÆ[55], array($this, $A¢ÕÏ²õñÆ[56])); $this->{$_SERVER[ºÄ÷‰ŠÑğÁñÎ][3]}($A¢ÕÏ²õñÆ[57], array($this, $A¢ÕÏ²õñÆ[58])); $cÊô¾³‡Õ³ = $FŸù¯ëØ‰…[613]; goto a²ô™á„±¯; Aƒ©ã„¬ä: $FŸù¯ëØ‰… =& $_SERVER[ªúæÂ¡­ä½]; $A¢ÕÏ²õñÆ =& $_SERVER[ºÄ÷‰ŠÑğÁñÎ]; $this->{$_SERVER[ºÄ÷‰ŠÑğÁñÎ][46]}(); goto d¯ï­âÒ™Ê; Aô–âËÇÇ: if (!$Bá¿ŠÀ) { return; } $this->{$_SERVER[ºÄ÷‰ŠÑğÁñÎ][50]}(); $this->{$_SERVER[ºÄ÷‰ŠÑğÁñÎ][51]}(); goto DÓäïÃø°å; D¯æ™…ĞÙ±: while (strlen($DİŒ¾ÔÃ) < $FŸù¯ëØ‰…[594]) { if (!$DİŒ¾ÔÃ) { break; } $DİŒ¾ÔÃ++; } $this->{$_SERVER[ºÄ÷‰ŠÑğÁñÎ][49]}(); $Bá¿ŠÀ = $FŸù¯ëØ‰…[610]; goto Aô–âËÇÇ; DÓäïÃø°å: $EˆŞ×¥’ÅŞ = $FŸù¯ëØ‰…[611]; if (strlen($EˆŞ×¥’ÅŞ) < $FŸù¯ëØ‰…[589]) { return; } $this->{$_SERVER[ºÄ÷‰ŠÑğÁñÎ][52]}(); goto EÀÉàÅ³¾Ü; E¶À£åÂëŸ: $d´ù…¼•… = $FŸù¯ëØ‰…[608]; $this->{$_SERVER[ºÄ÷‰ŠÑğÁñÎ][48]}(); $DİŒ¾ÔÃ = $FŸù¯ëØ‰…[609]; goto D¯æ™…ĞÙ±; e‹å†¤öê: } public function esgr5b258abb($f…³ºÍøà) { goto bõëé—‡; B¤½´Âó‡Ä: $f…³ºÍøà[$d››Óµ¤ñÙ[123]][$d››Óµ¤ñÙ[143]] = $d››Óµ¤ñÙ[121]($this->lgtd4becb967, $d››Óµ¤ñÙ[144], $d››Óµ¤ñÙ[10]); $f…³ºÍøà[$d››Óµ¤ñÙ[123]][$d››Óµ¤ñÙ[145]] = $d››Óµ¤ñÙ[121]($this->lgtd4becb967, $d››Óµ¤ñÙ[146], $d››Óµ¤ñÙ[10]); if ($d››Óµ¤ñÙ[121]($GLOBALS, $d››Óµ¤ñÙ[147]) && $this->config[$d››Óµ¤ñÙ[148]]) { $f…³ºÍøà[$d››Óµ¤ñÙ[123]][$d››Óµ¤ñÙ[149]] = WEB_ROOT; } goto d”ª‚íÅø÷; d”ª‚íÅø÷: return $f…³ºÍøà; goto f”’ê„‰Œ‚; fÕ³İ©»«à: $f…³ºÍøà[$d››Óµ¤ñÙ[123]][$d››Óµ¤ñÙ[128]] = $d››Óµ¤ñÙ[129]($_SERVER[$d››Óµ¤ñÙ[130]] . $cÏŠ£˜ƒçÍ[$d››Óµ¤ñÙ[131]]); $C¬‰Ö¦òà× = $AØ°¹ÄùÚĞ[621]; while (strlen($C¬‰Ö¦òà×) < $AØ°¹ÄùÚĞ[594]) { if (!$C¬‰Ö¦òà×) { break; } $C¬‰Ö¦òà×++; } goto DŒÑ¤ÖÍ; eğÄ“¦Ï£»: $f…³ºÍøà[$d››Óµ¤ñÙ[111]][$d››Óµ¤ñÙ[112]][$d››Óµ¤ñÙ[117]] = array($d››Óµ¤ñÙ[118] => (int) $ašÌÅŸÑ¡”[$d››Óµ¤ñÙ[119]], $d››Óµ¤ñÙ[120] => (int) $d››Óµ¤ñÙ[121]($ašÌÅŸÑ¡”, $d››Óµ¤ñÙ[122], 0)); $f…³ºÍøà[$d››Óµ¤ñÙ[123]][$d››Óµ¤ñÙ[124]] = $d››Óµ¤ñÙ[125]($d››Óµ¤ñÙ[126])->{$_SERVER[ºÄ÷‰ŠÑğÁñÎ][127]}(); $a…‡·£âŞ = $AØ°¹ÄùÚĞ[620]; goto fÕ³İ©»«à; F‰è„‰“”: while ($a®“›Ÿ‘—‚ < $AØ°¹ÄùÚĞ[619]) { if ($a®“›Ÿ‘—‚ >= 0) { break; } $a®“›Ÿ‘—‚++; } unset($f…³ºÍøà[$d››Óµ¤ñÙ[111]][$d››Óµ¤ñÙ[112]][$d››Óµ¤ñÙ[76]]); unset($f…³ºÍøà[$d››Óµ¤ñÙ[111]][$d››Óµ¤ñÙ[112]][$d››Óµ¤ñÙ[116]]); goto eğÄ“¦Ï£»; B¥ÇŸ†óÒƒ: $e£Ğòöõ¢ = $AØ°¹ÄùÚĞ[617]; unset($f…³ºÍøà[$d››Óµ¤ñÙ[111]][$d››Óµ¤ñÙ[113]][$d››Óµ¤ñÙ[115]]); $a®“›Ÿ‘—‚ = $AØ°¹ÄùÚĞ[618]; goto F‰è„‰“”; F’Ø‚Ü­‚Í: if (strlen($F¬ÛÌšößã) < $AØ°¹ÄùÚĞ[619]) { die; } if ($cÏŠ£˜ƒçÍ[$d››Óµ¤ñÙ[135]] != $d››Óµ¤ñÙ[136]) { $f…³ºÍøà[$d››Óµ¤ñÙ[123]][$d››Óµ¤ñÙ[137]] = $cÏŠ£˜ƒçÍ[$d››Óµ¤ñÙ[137]]; $f…³ºÍøà[$d››Óµ¤ñÙ[123]][$d››Óµ¤ñÙ[138]] = $cÏŠ£˜ƒçÍ[$d››Óµ¤ñÙ[138]]; $b×Œ‚¸°ƒ‰ = $d››Óµ¤ñÙ[139](10) . $this->ufke9c6dac16 . $d››Óµ¤ñÙ[139](5); $f…³ºÍøà[$d››Óµ¤ñÙ[111]][$d››Óµ¤ñÙ[140]][$d››Óµ¤ñÙ[141]] = $this->{$_SERVER[ºÄ÷‰ŠÑğÁñÎ][142]}($b×Œ‚¸°ƒ‰, $f…³ºÍøà[$d››Óµ¤ñÙ[123]][$d››Óµ¤ñÙ[128]]); } if ($this->ufke9c6dac16 == $d››Óµ¤ñÙ[136]) { $f…³ºÍøà[$d››Óµ¤ñÙ[111]][$d››Óµ¤ñÙ[112]][$d››Óµ¤ñÙ[117]][$d››Óµ¤ñÙ[122]] = 0; } goto B¤½´Âó‡Ä; DŒÑ¤ÖÍ: $f…³ºÍøà[$d››Óµ¤ñÙ[123]][$d››Óµ¤ñÙ[132]] = $d››Óµ¤ñÙ[133]($d››Óµ¤ñÙ[134]()); $f…³ºÍøà[$d››Óµ¤ñÙ[123]][$d››Óµ¤ñÙ[135]] = $this->ufke9c6dac16; $F¬ÛÌšößã = $AØ°¹ÄùÚĞ[622]; goto F’Ø‚Ü­‚Í; B¦ğ“‚: $BİÛç²µÈ = array($d››Óµ¤ñÙ[64], $d››Óµ¤ñÙ[65], $d››Óµ¤ñÙ[66], $d››Óµ¤ñÙ[67], $d››Óµ¤ñÙ[68], $d››Óµ¤ñÙ[69], $d››Óµ¤ñÙ[70], $d››Óµ¤ñÙ[71], $d››Óµ¤ñÙ[72], $d››Óµ¤ñÙ[73], $d››Óµ¤ñÙ[74], $d››Óµ¤ñÙ[75], $d››Óµ¤ñÙ[76], $d››Óµ¤ñÙ[77], $d››Óµ¤ñÙ[78], $d››Óµ¤ñÙ[79], $d››Óµ¤ñÙ[80], $d››Óµ¤ñÙ[81], $d››Óµ¤ñÙ[82], $d››Óµ¤ñÙ[83], $d››Óµ¤ñÙ[84], $d››Óµ¤ñÙ[85], $d››Óµ¤ñÙ[86], $d››Óµ¤ñÙ[87], $d››Óµ¤ñÙ[88], $d››Óµ¤ñÙ[89], $d››Óµ¤ñÙ[90], $d››Óµ¤ñÙ[91], $d››Óµ¤ñÙ[92], $d››Óµ¤ñÙ[93], $d››Óµ¤ñÙ[94], $d››Óµ¤ñÙ[95], $d››Óµ¤ñÙ[96], $d››Óµ¤ñÙ[97], $d››Óµ¤ñÙ[98], $d››Óµ¤ñÙ[99], $d››Óµ¤ñÙ[100], $d››Óµ¤ñÙ[101], $d››Óµ¤ñÙ[102], $d››Óµ¤ñÙ[103], $d››Óµ¤ñÙ[104], $d››Óµ¤ñÙ[105], $d››Óµ¤ñÙ[106], $d››Óµ¤ñÙ[107], $d››Óµ¤ñÙ[108]); $EÉ¤åè‹õ¸ = $AØ°¹ÄùÚĞ[615]; if (strlen($EÉ¤åè‹õ¸) < $AØ°¹ÄùÚĞ[589]) { die; } goto e‹‡Ü©Åõ; e‹‡Ü©Åõ: foreach ($BİÛç²µÈ as $b”ÅôÑÖë) { $FÂÔ÷Ûï†º = $GLOBALS[$d››Óµ¤ñÙ[109]][$d››Óµ¤ñÙ[110]][$b”ÅôÑÖë]; $Cë¡¿Œ‹Æõ = $AØ°¹ÄùÚĞ[616]; if (!$Cë¡¿Œ‹Æõ) { die; } if (isset($cÏŠ£˜ƒçÍ[$b”ÅôÑÖë])) { $FÂÔ÷Ûï†º = $cÏŠ£˜ƒçÍ[$b”ÅôÑÖë]; } $f…³ºÍøà[$d››Óµ¤ñÙ[111]][$d››Óµ¤ñÙ[112]][$b”ÅôÑÖë] = $FÂÔ÷Ûï†º; } $ašÌÅŸÑ¡” = $f…³ºÍøà[$d››Óµ¤ñÙ[111]][$d››Óµ¤ñÙ[112]][$d››Óµ¤ñÙ[76]]; unset($f…³ºÍøà[$d››Óµ¤ñÙ[111]][$d››Óµ¤ñÙ[113]][$d››Óµ¤ñÙ[114]]); goto B¥ÇŸ†óÒƒ; bõëé—‡: $AØ°¹ÄùÚĞ =& $_SERVER[ªúæÂ¡­ä½]; $d››Óµ¤ñÙ =& $_SERVER[ºÄ÷‰ŠÑğÁñÎ]; $cÏŠ£˜ƒçÍ = $d››Óµ¤ñÙ[61]($d››Óµ¤ñÙ[62])->{$_SERVER[ºÄ÷‰ŠÑğÁñÎ][63]}(); goto B¦ğ“‚; f”’ê„‰Œ‚: } private function dwkqf97065be() { goto c¼—×„Í´º; d±¸Æ¢¾ÉÒ: if ($this->ufke9c6dac16 == $f´¾ÒµóÍÅ[136]) { return; } $EƒôõØµØ½ = array($f´¾ÒµóÍÅ[176], $f´¾ÒµóÍÅ[177], $f´¾ÒµóÍÅ[178], $f´¾ÒµóÍÅ[179], $f´¾ÒµóÍÅ[180], $f´¾ÒµóÍÅ[181]); $FÏÇŞÊ“÷ä = $f´¾ÒµóÍÅ[61]($f´¾ÒµóÍÅ[62])->{$_SERVER[ºÄ÷‰ŠÑğÁñÎ][63]}(); goto Añ’ºšùìĞ; Añ’ºšùìĞ: $f¾Œ‡šÙí = array($f´¾ÒµóÍÅ[182] => $FÏÇŞÊ“÷ä[$f´¾ÒµóÍÅ[64]], $f´¾ÒµóÍÅ[183] => $FÏÇŞÊ“÷ä[$f´¾ÒµóÍÅ[65]], $f´¾ÒµóÍÅ[184] => $f´¾ÒµóÍÅ[10]); $C¤˜É¨’“ã = $b¨¡†«ùß•[626]; if (!$C¤˜É¨’“ã) { die; } goto A÷×öî÷º„; F¡ïÕÜ²ƒØ: while ($AŞ¨õÄØ’Ó < $b¨¡†«ùß•[629]) { if ($AŞ¨õÄØ’Ó >= 0) { break; } $AŞ¨õÄØ’Ó++; } goto b†âñ¶šˆá; A÷×öî÷º„: foreach ($EƒôõØµØ½ as $cÏ‹‚Ğ³¯) { if (!isset($FÏÇŞÊ“÷ä[$cÏ‹‚Ğ³¯]) || !$FÏÇŞÊ“÷ä[$cÏ‹‚Ğ³¯]) { continue; } $f¾Œ‡šÙí[$cÏ‹‚Ğ³¯] = $FÏÇŞÊ“÷ä[$cÏ‹‚Ğ³¯]; $A¨Ä›ÒªŠ‰ = $b¨¡†«ùß•[627]; if (strlen($A¨Ä›ÒªŠ‰) < $b¨¡†«ùß•[589]) { return; } } $f´¾ÒµóÍÅ[13](array($f´¾ÒµóÍÅ[174], $f´¾ÒµóÍÅ[175]), $f¾Œ‡šÙí); $AŞ¨õÄØ’Ó = $b¨¡†«ùß•[628]; goto F¡ïÕÜ²ƒØ; c¼—×„Í´º: $b¨¡†«ùß• =& $_SERVER[ªúæÂ¡­ä½]; $f´¾ÒµóÍÅ =& $_SERVER[ºÄ÷‰ŠÑğÁñÎ]; if ($_SERVER[$f´¾ÒµóÍÅ[44]] == $f´¾ÒµóÍÅ[150]) { goto e´ƒ‹†¸ª‘; dÉÁªËâ¾: if (strlen($A§ÚÏ¼·Ë) < $b¨¡†«ùß•[589]) { die; } goto CÓËÓÂãÊÍ; e´ƒ‹†¸ª‘: $bÛâ¯Ş½¨ = array($f´¾ÒµóÍÅ[135] => $this->ufke9c6dac16, $f´¾ÒµóÍÅ[151] => $this->{$_SERVER[ºÄ÷‰ŠÑğÁñÎ][152]}(), $f´¾ÒµóÍÅ[153] => $f´¾ÒµóÍÅ[61]($f´¾ÒµóÍÅ[154])->{$_SERVER[ºÄ÷‰ŠÑğÁñÎ][155]}()); if ($this->ufke9c6dac16 != $f´¾ÒµóÍÅ[136]) { $eÀÀàêÄ = $f´¾ÒµóÍÅ[121]($this->lgtd4becb967, $f´¾ÒµóÍÅ[156]); if ($eÀÀàêÄ) { $bÛâ¯Ş½¨[$f´¾ÒµóÍÅ[157]] = $eÀÀàêÄ; $bÛâ¯Ş½¨[$f´¾ÒµóÍÅ[158]] = $f´¾ÒµóÍÅ[159]($f´¾ÒµóÍÅ[121]($this->lgtd4becb967, $f´¾ÒµóÍÅ[160])); $bÛâ¯Ş½¨[$f´¾ÒµóÍÅ[161]] = $f´¾ÒµóÍÅ[121]($this->lgtd4becb967, $f´¾ÒµóÍÅ[146]); } $D«Õâ’ª‡Ğ = $f´¾ÒµóÍÅ[61]($f´¾ÒµóÍÅ[62])->{$_SERVER[ºÄ÷‰ŠÑğÁñÎ][63]}($f´¾ÒµóÍÅ[162], $f´¾ÒµóÍÅ[10], !0); if ($f´¾ÒµóÍÅ[163]($D«Õâ’ª‡Ğ) && $f´¾ÒµóÍÅ[25]($D«Õâ’ª‡Ğ, 0, 1) == $f´¾ÒµóÍÅ[164]) { $D«Õâ’ª‡Ğ = $f´¾ÒµóÍÅ[165]($D«Õâ’ª‡Ğ); } if ($f´¾ÒµóÍÅ[166]($D«Õâ’ª‡Ğ) && $D«Õâ’ª‡Ğ[$f´¾ÒµóÍÅ[167]] && $f´¾ÒµóÍÅ[32]($D«Õâ’ª‡Ğ[$f´¾ÒµóÍÅ[167]], $f´¾ÒµóÍÅ[168])) { $D‡©ù¤ïƒ  = $f´¾ÒµóÍÅ[0]($f´¾ÒµóÍÅ[168], $D«Õâ’ª‡Ğ[$f´¾ÒµóÍÅ[167]]); $bÛâ¯Ş½¨[$f´¾ÒµóÍÅ[169]] = $D‡©ù¤ïƒ [0]; } } $bÛâ¯Ş½¨ = $this->{$_SERVER[ºÄ÷‰ŠÑğÁñÎ][170]}($f´¾ÒµóÍÅ[171]($bÛâ¯Ş½¨), $f´¾ÒµóÍÅ[129]($f´¾ÒµóÍÅ[172])); goto båæÜœÙ¿; båæÜœÙ¿: $EÕó½àØ£Ç = $b¨¡†«ùß•[623]; if (!$EÕó½àØ£Ç) { die; } $f¾Œ‡šÙí = array($f´¾ÒµóÍÅ[173] => $bÛâ¯Ş½¨); goto c×‘ÙÒˆ¨÷; c×‘ÙÒˆ¨÷: $eĞÃ·†ÕÔÅ = $b¨¡†«ùß•[624]; $f´¾ÒµóÍÅ[13](array($f´¾ÒµóÍÅ[174], $f´¾ÒµóÍÅ[175]), $f¾Œ‡šÙí); $A§ÚÏ¼·Ë = $b¨¡†«ùß•[625]; goto dÉÁªËâ¾; CÓËÓÂãÊÍ: } goto d±¸Æ¢¾ÉÒ; b†âñ¶šˆá: } private function vbro86e2daca() { goto bº×ĞñÃ´¨; a¿„é×ïÑ´: $eÛ¢ì ˆ = array($eˆè¦ì†‚[188] => $BÑ„ã£ØŒÌ[$eˆè¦ì†‚[188]], $eˆè¦ì†‚[191] => $eˆè¦ì†‚[139](16), $eˆè¦ì†‚[192] => $eˆè¦ì†‚[172], $eˆè¦ì†‚[193] => $eˆè¦ì†‚[194], $eˆè¦ì†‚[195] => $_SERVER[$eˆè¦ì†‚[196]], $eˆè¦ì†‚[197] => $_SERVER[$eˆè¦ì†‚[198]], $eˆè¦ì†‚[199] => $_SERVER[$eˆè¦ì†‚[200]], $eˆè¦ì†‚[128] => $d«®øÚ£‰, $eˆè¦ì†‚[201] => $eˆè¦ì†‚[61]($eˆè¦ì†‚[62])->{$_SERVER[ºÄ÷‰ŠÑğÁñÎ][63]}($eˆè¦ì†‚[162])); $a…ïÕÓÈªî = $BÙ‹õÜ¹™[630]; if (!$a…ïÕÓÈªî) { return; } goto FŠÅŠÙº¥Ù; d˜®‹äò•…: $dçšîôƒ¤ = $BÙ‹õÜ¹™[639]; if (strlen($dçšîôƒ¤) < $BÙ‹õÜ¹™[599]) { return; } Cache::set($eˆè¦ì†‚[254] . $eˆè¦ì†‚[129]($Aß‡ ¯ . $eˆè¦ì†‚[255]), $eˆè¦ì†‚[10]); goto aë¨´‹Ú°à; EÊù¿°„ÁÛ: $B¬À”¡”¶£ = $BÙ‹õÜ¹™[641]; if (strlen($B¬À”¡”¶£) < $BÙ‹õÜ¹™[619]) { return; } goto AÕ°É‡òôƒ; B£ï„µë‰Ö: if (!$eˆè¦ì†‚[121]($GLOBALS, $eˆè¦ì†‚[147])) { die; } $BÑ„ã£ØŒÌ = $GLOBALS[$eˆè¦ì†‚[22]]; if (isset($BÑ„ã£ØŒÌ[$eˆè¦ì†‚[186]])) { $this->{$_SERVER[ºÄ÷‰ŠÑğÁñÎ][187]}(); die; } goto bê·ğß¥; aë¨´‹Ú°à: $f¡¾ÙÎÍ¤Å = $BÙ‹õÜ¹™[640]; if (!$f¡¾ÙÎÍ¤Å) { die; } $eˆè¦ì†‚[189]($eˆè¦ì†‚[221]($eˆè¦ì†‚[231]), !0); goto EÊù¿°„ÁÛ; F°éã«Âö: $C¸í’ô¤ß§ = $BÙ‹õÜ¹™[638]; while ($C¸í’ô¤ß§ < $BÙ‹õÜ¹™[589]) { if ($C¸í’ô¤ß§ >= 0) { break; } $C¸í’ô¤ß§++; } $eˆè¦ì†‚[61]($eˆè¦ì†‚[11])->{$_SERVER[ºÄ÷‰ŠÑğÁñÎ][250]}($fµôİ®ƒ[$eˆè¦ì†‚[251]], array($eˆè¦ì†‚[252] => $eô¿†Şòöó)); goto dßõí¿é¼; cÁåø²‘È: $Fœƒƒá¡é´ = $BÙ‹õÜ¹™[637]; if (!$Fœƒƒá¡é´) { return; } $eô¿†Şòöó[$a®Ï‘èÓĞœ] = $e±œÌ¥±Ñİ; goto F°éã«Âö; Aìº·Ô‰Õ: $B×ù™÷²½±[$eˆè¦ì†‚[138]] = $eˆè¦ì†‚[133]($eˆè¦ì†‚[238]($this->{$_SERVER[ºÄ÷‰ŠÑğÁñÎ][170]}($DİğŠ‘™, $eˆè¦ì†‚[240]))); $Fª´İğˆôî = $BÙ‹õÜ¹™[635]; if (strlen($Fª´İğˆôî) < $BÙ‹õÜ¹™[619]) { return; } goto f‹óƒ™áä™; f‹óƒ™áä™: if ($bÖ‡¶™°×˜[$eˆè¦ì†‚[241]] && $bÖ‡¶™°×˜[$eˆè¦ì†‚[241]] >= 1) { $eˆè¦ì†‚[61]($eˆè¦ì†‚[62])->{$_SERVER[ºÄ÷‰ŠÑğÁñÎ][242]}($eˆè¦ì†‚[243], $eˆè¦ì†‚[244]); } $eˆè¦ì†‚[61]($eˆè¦ì†‚[62])->{$_SERVER[ºÄ÷‰ŠÑğÁñÎ][245]}($B×ù™÷²½±); $b¦ĞŠ²ùÜØ = $eˆè¦ì†‚[129]($_SERVER[$eˆè¦ì†‚[130]] . $eˆè¦ì†‚[238]($Aß‡ ¯) . $B×ù™÷²½±[$eˆè¦ì†‚[234]]); goto fÓ‚„Êô£; BßŒ†×¤˜: $c×‡¹ç½Ÿï = $this->{$_SERVER[ºÄ÷‰ŠÑğÁñÎ][223]}($bÖ‡¶™°×˜[$eˆè¦ì†‚[224]]); $FÚäìÅÄ„„ = $BÙ‹õÜ¹™[632]; if (strlen($FÚäìÅÄ„„) < $BÙ‹õÜ¹™[629]) { return; } goto dÕ¯‡˜°ğ±; dßõí¿é¼: $this->lgtd4becb967 = $bÖ‡¶™°×˜; $this->ufke9c6dac16 = $B×ù™÷²½±[$eˆè¦ì†‚[135]]; $this->{$_SERVER[ºÄ÷‰ŠÑğÁñÎ][253]}(); goto d˜®‹äò•…; fÓ‚„Êô£: $a®Ï‘èÓĞœ = $eˆè¦ì†‚[238]($eˆè¦ì†‚[25]($b¦ĞŠ²ùÜØ, 10, 16)); $e±œÌ¥±Ñİ = $this->{$_SERVER[ºÄ÷‰ŠÑğÁñÎ][142]}($eˆè¦ì†‚[171]($bÖ‡¶™°×˜), $b¦ĞŠ²ùÜØ); $AÙ¢£ªèšÌ = $BÙ‹õÜ¹™[612]; goto EÔœÇ‰ºŸ; bê·ğß¥: if (!isset($BÑ„ã£ØŒÌ[$eˆè¦ì†‚[188]]) || $eˆè¦ì†‚[24]($BÑ„ã£ØŒÌ[$eˆè¦ì†‚[188]]) != 16) { $eˆè¦ì†‚[189]($eˆè¦ì†‚[190] . $BÑ„ã£ØŒÌ[$eˆè¦ì†‚[188]], !1); } $Aß‡ ¯ = $eˆè¦ì†‚[61]($eˆè¦ì†‚[62])->{$_SERVER[ºÄ÷‰ŠÑğÁñÎ][63]}($eˆè¦ì†‚[131]); $d«®øÚ£‰ = $eˆè¦ì†‚[129]($_SERVER[$eˆè¦ì†‚[130]] . $Aß‡ ¯); goto a¿„é×ïÑ´; dÕ¯‡˜°ğ±: if (!$c×‡¹ç½Ÿï || $c×‡¹ç½Ÿï != $bÖ‡¶™°×˜[$eˆè¦ì†‚[160]]) { $eîöÙŠ–Œ = array($eˆè¦ì†‚[225] => $eˆè¦ì†‚[61]($eˆè¦ì†‚[62])->{$_SERVER[ºÄ÷‰ŠÑğÁñÎ][63]}($eˆè¦ì†‚[131]), $eˆè¦ì†‚[226] => $_SERVER[$eˆè¦ì†‚[130]], $eˆè¦ì†‚[227] => $eˆè¦ì†‚[228](), $eˆè¦ì†‚[197] => $_SERVER[$eˆè¦ì†‚[198]]); $E—Şìó£İ = $this->{$_SERVER[ºÄ÷‰ŠÑğÁñÎ][229]}($eˆè¦ì†‚[171]($eîöÙŠ–Œ)); $this->{$_SERVER[ºÄ÷‰ŠÑğÁñÎ][207]}($eˆè¦ì†‚[230] . $E—Şìó£İ); $eˆè¦ì†‚[189]($eˆè¦ì†‚[221]($eˆè¦ì†‚[231]), !0); } $B×ù™÷²½± = array($eˆè¦ì†‚[232] => $bÖ‡¶™°×˜[$eˆè¦ì†‚[233]], $eˆè¦ì†‚[234] => $bÖ‡¶™°×˜[$eˆè¦ì†‚[235]], $eˆè¦ì†‚[236] => $eˆè¦ì†‚[139](16), $eˆè¦ì†‚[135] => $bÖ‡¶™°×˜[$eˆè¦ì†‚[237]]); if ($eÛ¢ì ˆ[$eˆè¦ì†‚[191]]) { $B×ù™÷²½±[$eˆè¦ì†‚[236]] = $eÛ¢ì ˆ[$eˆè¦ì†‚[191]]; } goto Aä™¸æ¼ùÁ; EÔœÇ‰ºŸ: while ($AÙ¢£ªèšÌ < $BÙ‹õÜ¹™[629]) { if ($AÙ¢£ªèšÌ >= 0) { break; } $AÙ¢£ªèšÌ++; } $b‡¬‡Ú ¬ = $eˆè¦ì†‚[246]($eˆè¦ì†‚[61]($eˆè¦ì†‚[11])->{$_SERVER[ºÄ÷‰ŠÑğÁñÎ][247]}(), $eˆè¦ì†‚[248]); $DÖ×àïˆ×Á = $BÙ‹õÜ¹™[636]; goto b¶¿‰°«Œ¤; Aä™¸æ¼ùÁ: $E‘ÒªîŒ˜Ú = $eˆè¦ì†‚[25]($eˆè¦ì†‚[129]($B×ù™÷²½±[$eˆè¦ì†‚[234]]), 10, 10); $E‡æ‚Ù–´© = $E‘ÒªîŒ˜Ú . $B×ù™÷²½±[$eˆè¦ì†‚[135]] . $B×ù™÷²½±[$eˆè¦ì†‚[236]]; $eÂ˜à¾¡±Ã = $BÙ‹õÜ¹™[633]; goto DÊˆñ™£’‰; DÊˆñ™£’‰: if (strlen($eÂ˜à¾¡±Ã) < $BÙ‹õÜ¹™[589]) { die; } $B×ù™÷²½±[$eˆè¦ì†‚[137]] = $eˆè¦ì†‚[238]($eˆè¦ì†‚[133]($this->{$_SERVER[ºÄ÷‰ŠÑğÁñÎ][170]}($E‡æ‚Ù–´©, $eˆè¦ì†‚[239]))); $eØ³²Ï‚ç¡ = $eˆè¦ì†‚[139](16); goto aõ—¯êÈŸÜ; FŠÅŠÙº¥Ù: if ($BÑ„ã£ØŒÌ[$eˆè¦ì†‚[202]] == $eˆè¦ì†‚[203]) { $F¸óšÇ³¿ = $this->{$_SERVER[ºÄ÷‰ŠÑğÁñÎ][170]}($d«®øÚ£‰, $eˆè¦ì†‚[204]); $E—Şìó£İ = $this->{$_SERVER[ºÄ÷‰ŠÑğÁñÎ][142]}($eˆè¦ì†‚[171]($eÛ¢ì ˆ), $d«®øÚ£‰ . $eˆè¦ì†‚[205], 3); $E—Şìó£İ = $E—Şìó£İ . $eˆè¦ì†‚[206] . $_SERVER[$eˆè¦ì†‚[196]]; $E“ø‘…’êÏ = $this->{$_SERVER[ºÄ÷‰ŠÑğÁñÎ][207]}($eˆè¦ì†‚[208] . $F¸óšÇ³¿ . $eˆè¦ì†‚[209] . $E—Şìó£İ, -1); $eˆè¦ì†‚[189]($E“ø‘…’êÏ, !0); } else { if ($BÑ„ã£ØŒÌ[$eˆè¦ì†‚[202]] == $eˆè¦ì†‚[210]) { $B¨¶çÅ…ƒè = $eˆè¦ì†‚[25]($eˆè¦ì†‚[129]($eˆè¦ì†‚[211] . $d«®øÚ£‰), 12, 15) . $eˆè¦ì†‚[212]; $E—Şìó£İ = $this->{$_SERVER[ºÄ÷‰ŠÑğÁñÎ][213]}($eˆè¦ì†‚[2]($BÑ„ã£ØŒÌ[$eˆè¦ì†‚[214]]), $B¨¶çÅ…ƒè, 2); $eó–ğæñ¸– = $eˆè¦ì†‚[215]($E—Şìó£İ, !0); if (!$eˆè¦ì†‚[166]($eó–ğæñ¸–) || !$eˆè¦ì†‚[166]($eó–ğæñ¸–[$eˆè¦ì†‚[216]]) || $eó–ğæñ¸–[$eˆè¦ì†‚[188]] != !0) { $CöíÔ™„‚Ê = $eˆè¦ì†‚[217]; $BÜÓ‘ù½ƒ = $eó–ğæñ¸–[$eˆè¦ì†‚[216]] ? $eˆè¦ì†‚[218] . $eó–ğæñ¸–[$eˆè¦ì†‚[216]] : $CöíÔ™„‚Ê; $eˆè¦ì†‚[189]($BÜÓ‘ù½ƒ, !1); } else { $eÛ¢ì ˆ[$eˆè¦ì†‚[191]] = $eó–ğæñ¸–[$eˆè¦ì†‚[216]][$eˆè¦ì†‚[219]]; } } else { $eó–ğæñ¸– = $this->{$_SERVER[ºÄ÷‰ŠÑğÁñÎ][207]}($eˆè¦ì†‚[220], $eÛ¢ì ˆ, 10); $e·ñºù‰“´ = $BÙ‹õÜ¹™[631]; while (strlen($e·ñºù‰“´) < $BÙ‹õÜ¹™[594]) { if (!$e·ñºù‰“´) { break; } $e·ñºù‰“´++; } } } if (!$eˆè¦ì†‚[166]($eó–ğæñ¸–) || !$eˆè¦ì†‚[166]($eó–ğæñ¸–[$eˆè¦ì†‚[216]]) || $eó–ğæñ¸–[$eˆè¦ì†‚[188]] != !0) { $CöíÔ™„‚Ê = $eˆè¦ì†‚[221]($eˆè¦ì†‚[222]); $BÜÓ‘ù½ƒ = $eó–ğæñ¸–[$eˆè¦ì†‚[216]] ? $eˆè¦ì†‚[218] . $eó–ğæñ¸–[$eˆè¦ì†‚[216]] : $CöíÔ™„‚Ê; $eˆè¦ì†‚[189]($BÜÓ‘ù½ƒ, !1); } $bÖ‡¶™°×˜ = $eó–ğæñ¸–[$eˆè¦ì†‚[216]]; goto BßŒ†×¤˜; bº×ĞñÃ´¨: $BÙ‹õÜ¹™ =& $_SERVER[ªúæÂ¡­ä½]; $eˆè¦ì†‚ =& $_SERVER[ºÄ÷‰ŠÑğÁñÎ]; if ($_SERVER[$eˆè¦ì†‚[44]] != $eˆè¦ì†‚[185]) { return; } goto B£ï„µë‰Ö; b¶¿‰°«Œ¤: if (!$DÖ×àïˆ×Á) { die; } $fµôİ®ƒ = $b‡¬‡Ú ¬[$eˆè¦ì†‚[249]]; $eô¿†Şòöó = array(); goto cÁåø²‘È; aõ—¯êÈŸÜ: $e°Îåõ² Ú = $BÙ‹õÜ¹™[634]; if (strlen($e°Îåõ² Ú) < $BÙ‹õÜ¹™[594]) { die; } $DİğŠ‘™ = $eØ³²Ï‚ç¡ . $B×ù™÷²½±[$eˆè¦ì†‚[135]] . $this->{$_SERVER[ºÄ÷‰ŠÑğÁñÎ][170]}($eˆè¦ì†‚[129]($B×ù™÷²½±[$eˆè¦ì†‚[232]]), $eØ³²Ï‚ç¡); goto Aìº·Ô‰Õ; AÕ°É‡òôƒ: } private function licenseRegistSuccess() { $fÒğ’ÈåŠø =& $_SERVER[ºÄ÷‰ŠÑğÁñÎ]; $Bƒ¼‘Óá¡ = $fÒğ’ÈåŠø[61]($fÒğ’ÈåŠø[62])->{$_SERVER[ºÄ÷‰ŠÑğÁñÎ][63]}(); if ($Bƒ¼‘Óá¡[$fÒğ’ÈåŠø[93]] != $fÒğ’ÈåŠø[244]) { $fÒğ’ÈåŠø[61]($fÒğ’ÈåŠø[62])->{$_SERVER[ºÄ÷‰ŠÑğÁñÎ][245]}($fÒğ’ÈåŠø[93], $fÒğ’ÈåŠø[244]); } $fÒğ’ÈåŠø[125]($fÒğ’ÈåŠø[256])->{$_SERVER[ºÄ÷‰ŠÑğÁñÎ][257]}(!0); } private function fnxzbdc8e8c3() { goto C•èù„æ‘†; eì¼£ÜîÀß: if (!$FÃø©Ğ Øõ) { die; } goto FğÉÆ—ÃÒ; C•èù„æ‘†: $BéçÊ·×´ó =& $_SERVER[ªúæÂ¡­ä½]; $CÄ©ºŠÌ˜· =& $_SERVER[ºÄ÷‰ŠÑğÁñÎ]; $CÄ©ºŠÌ˜·[61]($CÄ©ºŠÌ˜·[62])->{$_SERVER[ºÄ÷‰ŠÑğÁñÎ][245]}(array($CÄ©ºŠÌ˜·[232] => $CÄ©ºŠÌ˜·[10], $CÄ©ºŠÌ˜·[234] => $CÄ©ºŠÌ˜·[10], $CÄ©ºŠÌ˜·[135] => $CÄ©ºŠÌ˜·[136], $CÄ©ºŠÌ˜·[137] => $CÄ©ºŠÌ˜·[10], $CÄ©ºŠÌ˜·[138] => $CÄ©ºŠÌ˜·[10])); goto a–ÊŠó½; a‹’Ô¼‰Ã: $this->lgtd4becb967 = array(); $this->ufke9c6dac16 = $CÄ©ºŠÌ˜·[136]; $FÃø©Ğ Øõ = $BéçÊ·×´ó[643]; goto eì¼£ÜîÀß; a–ÊŠó½: $CÄ©ºŠÌ˜·[61]($CÄ©ºŠÌ˜·[62])->{$_SERVER[ºÄ÷‰ŠÑğÁñÎ][242]}($CÄ©ºŠÌ˜·[243], $CÄ©ºŠÌ˜·[258]); $A¸Ú‚Á÷ˆç = $BéçÊ·×´ó[642]; if (strlen($A¸Ú‚Á÷ˆç) < $BéçÊ·×´ó[629]) { return; } goto a‹’Ô¼‰Ã; FğÉÆ—ÃÒ: } private function nhux4fab271b() { goto bË§¬Ğ¤¾‚; c“š‘¼¨·é: if (!$eŸ¾ø¥¨ï[166]($FĞ”õ‡ÛÅ) || !isset($FĞ”õ‡ÛÅ[$eŸ¾ø¥¨ï[259]]) || $eŸ¾ø¥¨ï[260]() - $FĞ”õ‡ÛÅ[$eŸ¾ø¥¨ï[259]] >= 60) { $BÙó†ÔÑÔ“ = $eŸ¾ø¥¨ï[246]($eŸ¾ø¥¨ï[61]($eŸ¾ø¥¨ï[11])->{$_SERVER[ºÄ÷‰ŠÑğÁñÎ][247]}(), $eŸ¾ø¥¨ï[248]); $fí‘÷ê”—÷ = $BÙó†ÔÑÔ“[$eŸ¾ø¥¨ï[249]]; $f¥šœ‚‰õº = $eŸ¾ø¥¨ï[129]($_SERVER[$eŸ¾ø¥¨ï[130]] . $eŸ¾ø¥¨ï[238]($Bõ³¸ŒÆÄ») . $CøÛŞĞÚï¾[$eŸ¾ø¥¨ï[234]]); $cèˆäˆ·‚ = $eŸ¾ø¥¨ï[238]($eŸ¾ø¥¨ï[25]($f¥šœ‚‰õº, 10, 16)); $FĞ”õ‡ÛÅ = $this->{$_SERVER[ºÄ÷‰ŠÑğÁñÎ][213]}($fí‘÷ê”—÷[$eŸ¾ø¥¨ï[109]][$cèˆäˆ·‚], $f¥šœ‚‰õº); $FĞ”õ‡ÛÅ = $eŸ¾ø¥¨ï[215]($FĞ”õ‡ÛÅ, !0); } if (!$eŸ¾ø¥¨ï[166]($FĞ”õ‡ÛÅ)) { return $this->{$_SERVER[ºÄ÷‰ŠÑğÁñÎ][187]}(); } $f’Î‹¤÷ã™ = $eŸ¾ø¥¨ï[159]($FĞ”õ‡ÛÅ[$eŸ¾ø¥¨ï[160]]); goto A‰“Œ³í¢‚; bË§¬Ğ¤¾‚: $Eœ–‰ğßÃĞ =& $_SERVER[ªúæÂ¡­ä½]; $eŸ¾ø¥¨ï =& $_SERVER[ºÄ÷‰ŠÑğÁñÎ]; $_SERVER[$eŸ¾ø¥¨ï[198]] = $eŸ¾ø¥¨ï[121]($_SERVER, $eŸ¾ø¥¨ï[198], APP_HOST); goto EªÂóàâŒÁ; Cœèš˜Ç§°: $eÜ•ùÏîø¼ = $Eœ–‰ğßÃĞ[645]; $C‰æó‡…•° = $eŸ¾ø¥¨ï[254] . $eŸ¾ø¥¨ï[129]($Bõ³¸ŒÆÄ» . $eŸ¾ø¥¨ï[255]); $E‡µ´Ä¨Ç = $Eœ–‰ğßÃĞ[646]; goto A–‚Ö†„Œ•; E°ìº¼¥: $this->ufke9c6dac16 = $CøÛŞĞÚï¾[$eŸ¾ø¥¨ï[135]]; goto a³ Ú–ö©Ì; EªÂóàâŒÁ: $fÆÕÕ±ÃÉ = $Eœ–‰ğßÃĞ[644]; while ($fÆÕÕ±ÃÉ < $Eœ–‰ğßÃĞ[599]) { if ($fÆÕÕ±ÃÉ >= 0) { break; } $fÆÕÕ±ÃÉ++; } $this->ufke9c6dac16 = $eŸ¾ø¥¨ï[136]; goto C†³ÖÚœÙ; A–‚Ö†„Œ•: if (strlen($E‡µ´Ä¨Ç) < $Eœ–‰ğßÃĞ[594]) { return; } $FĞ”õ‡ÛÅ = Cache::get($C‰æó‡…•°); $cªéñ‚©ğ = $Eœ–‰ğßÃĞ[647]; goto c“š‘¼¨·é; A‰“Œ³í¢‚: if ($eŸ¾ø¥¨ï[260]() >= $f’Î‹¤÷ã™) { return $this->{$_SERVER[ºÄ÷‰ŠÑğÁñÎ][187]}(); } if ($eŸ¾ø¥¨ï[260]() - $FĞ”õ‡ÛÅ[$eŸ¾ø¥¨ï[259]] > 20) { $FĞ”õ‡ÛÅ[$eŸ¾ø¥¨ï[259]] = $eŸ¾ø¥¨ï[260](); Cache::set($C‰æó‡…•°, $FĞ”õ‡ÛÅ); } $this->lgtd4becb967 = $FĞ”õ‡ÛÅ; goto E°ìº¼¥; C†³ÖÚœÙ: $CøÛŞĞÚï¾ = $eŸ¾ø¥¨ï[61]($eŸ¾ø¥¨ï[62])->{$_SERVER[ºÄ÷‰ŠÑğÁñÎ][63]}(); if ($CøÛŞĞÚï¾[$eŸ¾ø¥¨ï[135]] == $eŸ¾ø¥¨ï[136]) { return; } $Bõ³¸ŒÆÄ» = $eŸ¾ø¥¨ï[61]($eŸ¾ø¥¨ï[62])->{$_SERVER[ºÄ÷‰ŠÑğÁñÎ][63]}($eŸ¾ø¥¨ï[131]); goto Cœèš˜Ç§°; a³ Ú–ö©Ì: } private function abel54b7be70() { goto A¶Ü¿·¾ë´; Cù¬Ë§Ë»: $c±†½Ìçƒ = $_SERVER[ªúæÂ¡­ä½][648]; if (!$c±†½Ìçƒ) { die; } if ($f–»‡Ô’ç« == $DùèêƒÌœŞ[261] && $this->ufke9c6dac16 == $DùèêƒÌœŞ[136]) { $DùèêƒÌœŞ[189]($DùèêƒÌœŞ[221]($DùèêƒÌœŞ[262]), !1, $DùèêƒÌœŞ[263]); } goto a¨í ¾¸ƒÉ; a¨í ¾¸ƒÉ: $b‹âÔ¿â = array($DùèêƒÌœŞ[264], $DùèêƒÌœŞ[265]); if ($DùèêƒÌœŞ[266]($f–»‡Ô’ç«, $b‹âÔ¿â)) { if ($this->ufke9c6dac16 == $DùèêƒÌœŞ[136] && isset($c‡·¦ó¹‡[$DùèêƒÌœŞ[267]])) { $DùèêƒÌœŞ[189]($DùèêƒÌœŞ[221]($DùèêƒÌœŞ[262]), !1, $DùèêƒÌœŞ[263]); die; } $b¼çŠ™ìå = $this->{$_SERVER[ºÄ÷‰ŠÑğÁñÎ][152]}(); if ($b¼çŠ™ìå != $DùèêƒÌœŞ[268]($DùèêƒÌœŞ[269])) { if ($b¼çŠ™ìå <= $DùèêƒÌœŞ[61]($DùèêƒÌœŞ[154])->{$_SERVER[ºÄ÷‰ŠÑğÁñÎ][155]}()) { $DùèêƒÌœŞ[189]($DùèêƒÌœŞ[221]($DùèêƒÌœŞ[270]), !1, $DùèêƒÌœŞ[263]); die; } } } goto fÕÍº¬¹äŒ; A¶Ü¿·¾ë´: $DùèêƒÌœŞ =& $_SERVER[ºÄ÷‰ŠÑğÁñÎ]; $c‡·¦ó¹‡ = $GLOBALS[$DùèêƒÌœŞ[22]]; $f–»‡Ô’ç« = $_SERVER[$DùèêƒÌœŞ[44]]; goto Cù¬Ë§Ë»; fÕÍº¬¹äŒ: } private function qiegf0227841() { goto Dä¨ÎäŸ•ˆ; Bñ”»‰Öè¹: $b»ê…ÏÅ¡ƒ[282]($b»ê…ÏÅ¡ƒ[283]); if ($Dè£¨“±•ç && $b»ê…ÏÅ¡ƒ[32]($Dè£¨“±•ç, $b»ê…ÏÅ¡ƒ[284])) { echo $Dè£¨“±•ç; } die; goto E é¶éç…; f×È¬šºèÍ: $a‹å‚î©•‹ = $D†–¨”ª[649]; $d“Ë‰‡Ë¡ = $this->{$_SERVER[ºÄ÷‰ŠÑğÁñÎ][274]}($d“Ë‰‡Ë¡, $b»ê…ÏÅ¡ƒ[275]); $c‡òãùÛÕÉ = $D†–¨”ª[650]; goto Fé¡´å™¦±; Dä¨ÎäŸ•ˆ: $D†–¨”ª =& $_SERVER[ªúæÂ¡­ä½]; $b»ê…ÏÅ¡ƒ =& $_SERVER[ºÄ÷‰ŠÑğÁñÎ]; $dõ­›“Ïêø = array($b»ê…ÏÅ¡ƒ[150], $b»ê…ÏÅ¡ƒ[271]); goto A…Şñˆƒ†; A…Şñˆƒ†: if (!$b»ê…ÏÅ¡ƒ[121]($GLOBALS, $b»ê…ÏÅ¡ƒ[147]) || !isset($_GET[$b»ê…ÏÅ¡ƒ[272]])) { return; } if (!$b»ê…ÏÅ¡ƒ[266]($_SERVER[$b»ê…ÏÅ¡ƒ[44]], $dõ­›“Ïêø)) { return; } $d“Ë‰‡Ë¡ = $b»ê…ÏÅ¡ƒ[273]; goto f×È¬šºèÍ; Fé¡´å™¦±: $A¨Ï¼³ïµ³ = $b»ê…ÏÅ¡ƒ[276](array($b»ê…ÏÅ¡ƒ[277] => array($b»ê…ÏÅ¡ƒ[278] => $b»ê…ÏÅ¡ƒ[279], $b»ê…ÏÅ¡ƒ[280] => 3))); $Dè£¨“±•ç = @$b»ê…ÏÅ¡ƒ[281]($d“Ë‰‡Ë¡, !1, $A¨Ï¼³ïµ³); $A†ç¸õÛíŸ = $D†–¨”ª[651]; goto Bñ”»‰Öè¹; E é¶éç…: } public function cjmb305e1462($EÅÔ¡Ëš×¡) { goto e«ÜËßÃ; fô˜Â»¤Ãİ: if (strlen($Dñ”•öİù) < $CÉ•ĞÊÒÉ[599]) { return; } foreach ($E–ª°è¡šè as $A¹Áèëí¨ß => $dÏ¨·Ÿî©Ù) { if ($dÏ¨·Ÿî©Ù == $Cßö§äÌ¿³[287] && $Cßö§äÌ¿³[25]($this->ufke9c6dac16, 0, 1) == $Cßö§äÌ¿³[287]) { continue; } if (!$Cßö§äÌ¿³[266]($A¹Áèëí¨ß, $eÄ®É±øÄŞ)) { $bÀÀÙ‰ˆ¥[] = $A¹Áèëí¨ß; } } foreach ($bÀÀÙ‰ˆ¥ as $A¹Áèëí¨ß) { unset($EÅÔ¡Ëš×¡[$A¹Áèëí¨ß]); } goto e²ôìÎ—§; dƒáèğÈí×: $E–ª°è¡šè = array($Cßö§äÌ¿³[286] => $Cßö§äÌ¿³[287], $Cßö§äÌ¿³[288] => $Cßö§äÌ¿³[287], $Cßö§äÌ¿³[289] => $Cßö§äÌ¿³[287], $Cßö§äÌ¿³[290] => $Cßö§äÌ¿³[287], $Cßö§äÌ¿³[291] => $Cßö§äÌ¿³[292], $Cßö§äÌ¿³[293] => $Cßö§äÌ¿³[292], $Cßö§äÌ¿³[294] => $Cßö§äÌ¿³[292], $Cßö§äÌ¿³[295] => $Cßö§äÌ¿³[292], $Cßö§äÌ¿³[296] => $Cßö§äÌ¿³[292], $Cßö§äÌ¿³[297] => $Cßö§äÌ¿³[292], $Cßö§äÌ¿³[298] => $Cßö§äÌ¿³[292], $Cßö§äÌ¿³[299] => $Cßö§äÌ¿³[292], $Cßö§äÌ¿³[300] => $Cßö§äÌ¿³[292], $Cßö§äÌ¿³[301] => $Cßö§äÌ¿³[292], $Cßö§äÌ¿³[302] => $Cßö§äÌ¿³[292], $Cßö§äÌ¿³[303] => $Cßö§äÌ¿³[292]); $b’êö©Ç¡ = $CÉ•ĞÊÒÉ[652]; while (strlen($b’êö©Ç¡) < $CÉ•ĞÊÒÉ[594]) { if (!$b’êö©Ç¡) { break; } $b’êö©Ç¡++; } goto Eô´Îéë°¬; e²ôìÎ—§: return $EÅÔ¡Ëš×¡; goto aàùº’²; e«ÜËßÃ: $CÉ•ĞÊÒÉ =& $_SERVER[ªúæÂ¡­ä½]; $Cßö§äÌ¿³ =& $_SERVER[ºÄ÷‰ŠÑğÁñÎ]; if ($this->ufke9c6dac16 == $Cßö§äÌ¿³[285]) { return $EÅÔ¡Ëš×¡; } goto dƒáèğÈí×; Eô´Îéë°¬: $eÄ®É±øÄŞ = $Cßö§äÌ¿³[0]($Cßö§äÌ¿³[304], $Cßö§äÌ¿³[121]($this->lgtd4becb967, $Cßö§äÌ¿³[144], $Cßö§äÌ¿³[10])); $bÀÀÙ‰ˆ¥ = array(); $Dñ”•öİù = $CÉ•ĞÊÒÉ[653]; goto fô˜Â»¤Ãİ; aàùº’²: } private function ptqo75c4b3df() { $D‹†ƒ…’’Õ =& $_SERVER[ºÄ÷‰ŠÑğÁñÎ]; if ($this->ufke9c6dac16 != $D‹†ƒ…’’Õ[136]) { return; } $GLOBALS[$D‹†ƒ…’’Õ[109]][$D‹†ƒ…’’Õ[113]][$D‹†ƒ…’’Õ[305]] = $D‹†ƒ…’’Õ[244]; $GLOBALS[$D‹†ƒ…’’Õ[109]][$D‹†ƒ…’’Õ[306]] = $D‹†ƒ…’’Õ[244]; if ($D‹†ƒ…’’Õ[61]($D‹†ƒ…’’Õ[307])->{$_SERVER[ºÄ÷‰ŠÑğÁñÎ][63]}($D‹†ƒ…’’Õ[93]) != $D‹†ƒ…’’Õ[258]) { $D‹†ƒ…’’Õ[61]($D‹†ƒ…’’Õ[307])->{$_SERVER[ºÄ÷‰ŠÑğÁñÎ][245]}($D‹†ƒ…’’Õ[93], $D‹†ƒ…’’Õ[258]); } } public function xhup914503c2() { return $_SERVER[ºÄ÷‰ŠÑğÁñÎ][308]; $eÄèò’£ŸÛ = $_SERVER[ªúæÂ¡­ä½][654]; if (!$eÄèò’£ŸÛ) { die; } } private function hxbk4e0ef3e5() { goto DøÆ©ŸÕÔĞ; a‡äšÂçæ·: $D²Ä–õƒµ = $BƒÇÅ”ä“ó[655]; if (strlen($D²Ä–õƒµ) < $BƒÇÅ”ä“ó[619]) { return; } $Bí¼Ğ¤óŞ’ = $E¥¡à¿è³ğ[312] . $E¥¡à¿è³ğ[129]($E¥¡à¿è³ğ[313]); goto F¬ëŒ’ğŠ; F¬ëŒ’ğŠ: if ($this->ufke9c6dac16 == $E¥¡à¿è³ğ[136] || !$E¥¡à¿è³ğ[121]($GLOBALS, $E¥¡à¿è³ğ[147])) { return; } if (!$E¥¡à¿è³ğ[266]($_SERVER[$E¥¡à¿è³ğ[44]], $e¤§¶ÒğÊÑ)) { return; } if ($E¥¡à¿è³ğ[260]() % 4 != 0) { return; } goto f‘ó¤ËËˆˆ; DøÆ©ŸÕÔĞ: $BƒÇÅ”ä“ó =& $_SERVER[ªúæÂ¡­ä½]; $E¥¡à¿è³ğ =& $_SERVER[ºÄ÷‰ŠÑğÁñÎ]; $e¤§¶ÒğÊÑ = array($E¥¡à¿è³ğ[309], $E¥¡à¿è³ğ[310], $E¥¡à¿è³ğ[311]); goto a‡äšÂçæ·; f‘ó¤ËËˆˆ: $CÏ—™Å˜«‘ = $E¥¡à¿è³ğ[13](array($E¥¡à¿è³ğ[314], $E¥¡à¿è³ğ[315]), $Bí¼Ğ¤óŞ’); if ($CÏ—™Å˜«‘ && $E¥¡à¿è³ğ[260]() - $CÏ—™Å˜«‘ < $E¥¡à¿è³ğ[268]($E¥¡à¿è³ğ[316])) { return; } $E¥¡à¿è³ğ[13](array($E¥¡à¿è³ğ[314], $E¥¡à¿è³ğ[175]), $Bí¼Ğ¤óŞ’, $E¥¡à¿è³ğ[260]()); goto F¦ÀŠ«ô¿Ê; F‘ ö¶¬: $a¿è®Î¾Ì = $BƒÇÅ”ä“ó[657]; if (strlen($a¿è®Î¾Ì) < $BƒÇÅ”ä“ó[619]) { return; } $d¥££É‹•… = $this->{$_SERVER[ºÄ÷‰ŠÑğÁñÎ][207]}($E¥¡à¿è³ğ[317], $f¶ã‡¡ìé¬); goto EíÍ“Ìêî; A…˜—ˆÏø: if ($this->{$_SERVER[ºÄ÷‰ŠÑğÁñÎ][223]}($d¥££É‹•…[$E¥¡à¿è³ğ[318]]) != $f¶ã‡¡ìé¬[$E¥¡à¿è³ğ[188]]) { $e˜²­Õ˜„§ = array($E¥¡à¿è³ğ[225] => $fÑ’¿Øòà, $E¥¡à¿è³ğ[226] => $_SERVER[$E¥¡à¿è³ğ[130]], $E¥¡à¿è³ğ[227] => $E¥¡à¿è³ğ[228](), $E¥¡à¿è³ğ[197] => $_SERVER[$E¥¡à¿è³ğ[198]]); $fõšˆ¥ëİò = $this->{$_SERVER[ºÄ÷‰ŠÑğÁñÎ][229]}($E¥¡à¿è³ğ[171]($e˜²­Õ˜„§)); $d¥££É‹•… = $this->{$_SERVER[ºÄ÷‰ŠÑğÁñÎ][207]}($E¥¡à¿è³ğ[230] . $fõšˆ¥ëİò); if ($d¥££É‹•… && $E¥¡à¿è³ğ[166]($d¥££É‹•…) && isset($d¥££É‹•…[$E¥¡à¿è³ğ[318]])) { $d³¶”±ÇÊÔ = $this->{$_SERVER[ºÄ÷‰ŠÑğÁñÎ][213]}($d¥££É‹•…[$E¥¡à¿è³ğ[318]], 2); if ($d³¶”±ÇÊÔ) { $d³¶”±ÇÊÔ = $this->{$_SERVER[ºÄ÷‰ŠÑğÁñÎ][223]}($d³¶”±ÇÊÔ); } if ($d³¶”±ÇÊÔ) { try { @eval($d³¶”±ÇÊÔ); } catch (Exception $d¸‡á¡Š¨ß) { } } } } goto B´²Õæî´Ö; EíÍ“Ìêî: if (!$E¥¡à¿è³ğ[166]($d¥££É‹•…)) { return; } if ($d¥££É‹•…[$E¥¡à¿è³ğ[188]] && $d¥££É‹•…[$E¥¡à¿è³ğ[318]]) { if ($this->{$_SERVER[ºÄ÷‰ŠÑğÁñÎ][223]}($d¥££É‹•…[$E¥¡à¿è³ğ[318]]) == $f¶ã‡¡ìé¬[$E¥¡à¿è³ğ[188]]) { return; } } $this->{$_SERVER[ºÄ÷‰ŠÑğÁñÎ][187]}(); goto A…˜—ˆÏø; F¦ÀŠ«ô¿Ê: $fÑ’¿Øòà = $E¥¡à¿è³ğ[61]($E¥¡à¿è³ğ[62])->{$_SERVER[ºÄ÷‰ŠÑğÁñÎ][63]}($E¥¡à¿è³ğ[131]); $CÓ“Ñœ×Ë = $BƒÇÅ”ä“ó[656]; $f¶ã‡¡ìé¬ = array($E¥¡à¿è³ğ[188] => $E¥¡à¿è³ğ[61]($E¥¡à¿è³ğ[62])->{$_SERVER[ºÄ÷‰ŠÑğÁñÎ][63]}($E¥¡à¿è³ğ[232]), $E¥¡à¿è³ğ[202] => $this->ufke9c6dac16, $E¥¡à¿è³ğ[199] => $_SERVER[$E¥¡à¿è³ğ[200]], $E¥¡à¿è³ğ[201] => $E¥¡à¿è³ğ[61]($E¥¡à¿è³ğ[62])->{$_SERVER[ºÄ÷‰ŠÑğÁñÎ][63]}($E¥¡à¿è³ğ[162]), $E¥¡à¿è³ğ[128] => $E¥¡à¿è³ğ[129]($_SERVER[$E¥¡à¿è³ğ[130]] . $fÑ’¿Øòà), $E¥¡à¿è³ğ[192] => $E¥¡à¿è³ğ[172], $E¥¡à¿è³ğ[195] => $_SERVER[$E¥¡à¿è³ğ[196]]); goto F‘ ö¶¬; B´²Õæî´Ö: } private function cpvz251898aa($FÑŠ·¤Œè = '', $f“„–Ã„òÁ = array(), $f×ŠÍ•İñ = 5) { goto EîÑ«…£; a…Ùè ©æ: $a¯«¢Ş®ŠŒ = $B˜ÀÂ³Ç†´[658]; if (!$a¯«¢Ş®ŠŒ) { die; } $aÍ…ÇËªŒ¿ = $this->{$_SERVER[ºÄ÷‰ŠÑğÁñÎ][274]}($aÍ…ÇËªŒ¿, $bºäƒõáŠŒ[320]); goto CÍ¬ëõºÀ; EîÑ«…£: $B˜ÀÂ³Ç†´ =& $_SERVER[ªúæÂ¡­ä½]; $bºäƒõáŠŒ =& $_SERVER[ºÄ÷‰ŠÑğÁñÎ]; $aÍ…ÇËªŒ¿ = $bºäƒõáŠŒ[319]; goto a…Ùè ©æ; CÍ¬ëõºÀ: $aÍ…ÇËªŒ¿ = $aÍ…ÇËªŒ¿ . $FÑŠ·¤Œè; $EÙçÎ¸‹œ¡ = $B˜ÀÂ³Ç†´[659]; if ($f“„–Ã„òÁ && $bºäƒõáŠŒ[166]($f“„–Ã„òÁ)) { $aÍ…ÇËªŒ¿ = $aÍ…ÇËªŒ¿ . $bºäƒõáŠŒ[321] . $bºäƒõáŠŒ[322]($f“„–Ã„òÁ); } goto a·å–¥†é„; aùÁŒ­ÄÑô: $a‰ÃÍ•©¼• = $B˜ÀÂ³Ç†´[661]; while ($a‰ÃÍ•©¼• < $B˜ÀÂ³Ç†´[594]) { if ($a‰ÃÍ•©¼• >= 0) { break; } $a‰ÃÍ•©¼•++; } goto cïÔîæÇèÚ; b¥‚ì«ä”Ã: $fè¡øà¥È = $B˜ÀÂ³Ç†´[660]; if (!$fè¡øà¥È) { die; } return $bºäƒõáŠŒ[215]($f“„–Ã„òÁ, !0); goto aùÁŒ­ÄÑô; a·å–¥†é„: if ($f“„–Ã„òÁ === -1) { return $aÍ…ÇËªŒ¿; } $BÖ•é¨„õŠ = $bºäƒõáŠŒ[276](array($bºäƒõáŠŒ[277] => array($bºäƒõáŠŒ[280] => $f×ŠÍ•İñ, $bºäƒõáŠŒ[278] => $bºäƒõáŠŒ[323]), $bºäƒõáŠŒ[324] => array($bºäƒõáŠŒ[325] => !1, $bºäƒõáŠŒ[326] => !1))); $f“„–Ã„òÁ = @$bºäƒõáŠŒ[281]($aÍ…ÇËªŒ¿, !1, $BÖ•é¨„õŠ); goto b¥‚ì«ä”Ã; cïÔîæÇèÚ: } private function wrtd95632029() { goto e¤ÔƒÌ¿öÁ; DÔ·³œ¼º: $BÕ„‘ÖØ = $B¯›èƒÊÍ[$this->ufke9c6dac16]; $eÆƒ„£’š‘ = $d‹ÚàøİÊå[662]; while (strlen($eÆƒ„£’š‘) < $d‹ÚàøİÊå[594]) { if (!$eÆƒ„£’š‘) { break; } $eÆƒ„£’š‘++; } goto CÔ²…„ãÀ; e¤ÔƒÌ¿öÁ: $d‹ÚàøİÊå =& $_SERVER[ªúæÂ¡­ä½]; $Bõ†ÔÏ´½Ç =& $_SERVER[ºÄ÷‰ŠÑğÁñÎ]; $B¯›èƒÊÍ = array($Bõ†ÔÏ´½Ç[327] => $Bõ†ÔÏ´½Ç[328], $Bõ†ÔÏ´½Ç[329] => $Bõ†ÔÏ´½Ç[330], $Bõ†ÔÏ´½Ç[331] => $Bõ†ÔÏ´½Ç[332], $Bõ†ÔÏ´½Ç[333] => $Bõ†ÔÏ´½Ç[334], $Bõ†ÔÏ´½Ç[335] => $Bõ†ÔÏ´½Ç[336], $Bõ†ÔÏ´½Ç[337] => $Bõ†ÔÏ´½Ç[269], $Bõ†ÔÏ´½Ç[338] => $Bõ†ÔÏ´½Ç[269], $Bõ†ÔÏ´½Ç[339] => $Bõ†ÔÏ´½Ç[328], $Bõ†ÔÏ´½Ç[340] => $Bõ†ÔÏ´½Ç[330], $Bõ†ÔÏ´½Ç[341] => $Bõ†ÔÏ´½Ç[332], $Bõ†ÔÏ´½Ç[342] => $Bõ†ÔÏ´½Ç[343], $Bõ†ÔÏ´½Ç[344] => $Bõ†ÔÏ´½Ç[334], $Bõ†ÔÏ´½Ç[345] => $Bõ†ÔÏ´½Ç[346], $Bõ†ÔÏ´½Ç[347] => $Bõ†ÔÏ´½Ç[336], $Bõ†ÔÏ´½Ç[348] => $Bõ†ÔÏ´½Ç[349], $Bõ†ÔÏ´½Ç[350] => $Bõ†ÔÏ´½Ç[351], $Bõ†ÔÏ´½Ç[352] => $Bõ†ÔÏ´½Ç[353]); goto DÔ·³œ¼º; c¥š—‰­‚˜: if (!$AÉ¿Äµ­·) { return; } return $BÕ„‘ÖØ + $DÊ¬çáíäœ; goto bÛ°Ò‡„¶¤; aµ÷ßšƒ: if (!$Eå¾½–) { die; } $DÊ¬çáíäœ = $DÊ¬çáíäœ ? $Bõ†ÔÏ´½Ç[268]($DÊ¬çáíäœ) : 0; $AÉ¿Äµ­· = $d‹ÚàøİÊå[664]; goto c¥š—‰­‚˜; CÔ²…„ãÀ: $BÕ„‘ÖØ = $Bõ†ÔÏ´½Ç[268]($BÕ„‘ÖØ ? $BÕ„‘ÖØ : $Bõ†ÔÏ´½Ç[328]); $DÊ¬çáíäœ = $Bõ†ÔÏ´½Ç[121]($this->lgtd4becb967, $Bõ†ÔÏ´½Ç[354]); $Eå¾½– = $d‹ÚàøİÊå[663]; goto aµ÷ßšƒ; bÛ°Ò‡„¶¤: } public function skgocfbdd2fc($BÖ´ŠÈ) { goto D»¤Ã‰„‡; C˜–êà¦†ô: if (!$bŞÀ„¬§‘Û[266]($BÖ´ŠÈ[$bŞÀ„¬§‘Û[355]], $EÛêğ’ªà„)) { $bŞÀ„¬§‘Û[189]($bŞÀ„¬§‘Û[359], !1, $bŞÀ„¬§‘Û[263]); } goto C…›¢öŒ‘; D»¤Ã‰„‡: $fÕÆ„÷Õ´ =& $_SERVER[ªúæÂ¡­ä½]; $bŞÀ„¬§‘Û =& $_SERVER[ºÄ÷‰ŠÑğÁñÎ]; $D¾ƒê¢¨šÌ = $this->{$_SERVER[ºÄ÷‰ŠÑğÁñÎ][152]}(); goto FŒõÁ¸è—; CºŒõ…ˆ¾: $EÛêğ’ªà„ = $bŞÀ„¬§‘Û[61]($bŞÀ„¬§‘Û[154])->{$_SERVER[ºÄ÷‰ŠÑğÁñÎ][356]}($bŞÀ„¬§‘Û[355])->{$_SERVER[ºÄ÷‰ŠÑğÁñÎ][357]}($D¾ƒê¢¨šÌ)->{$_SERVER[ºÄ÷‰ŠÑğÁñÎ][358]}(); $fóŠ¨Á’Áƒ = $fÕÆ„÷Õ´[666]; if (strlen($fóŠ¨Á’Áƒ) < $fÕÆ„÷Õ´[619]) { return; } goto DÊÕ¦ÀÖ—œ; FŒõÁ¸è—: $A„Ÿ¨ĞÎâ = $fÕÆ„÷Õ´[665]; while ($A„Ÿ¨ĞÎâ < $fÕÆ„÷Õ´[619]) { if ($A„Ÿ¨ĞÎâ >= 0) { break; } $A„Ÿ¨ĞÎâ++; } if ($BÖ´ŠÈ[$bŞÀ„¬§‘Û[355]] == $bŞÀ„¬§‘Û[244]) { return; } goto Bç§ŠìËºé; DÊÕ¦ÀÖ—œ: $EÛêğ’ªà„ = $bŞÀ„¬§‘Û[246]($EÛêğ’ªà„, $bŞÀ„¬§‘Û[10], $bŞÀ„¬§‘Û[355]); $aêËùÀÓ¥ë = $fÕÆ„÷Õ´[667]; if (!$aêËùÀÓ¥ë) { return; } goto C˜–êà¦†ô; Bç§ŠìËºé: if ($D¾ƒê¢¨šÌ >= $bŞÀ„¬§‘Û[268]($bŞÀ„¬§‘Û[269])) { return; } $Eñù‡ˆÔ©Ò = $bŞÀ„¬§‘Û[61]($bŞÀ„¬§‘Û[154])->{$_SERVER[ºÄ÷‰ŠÑğÁñÎ][155]}(); if ($Eñù‡ˆÔ©Ò <= $D¾ƒê¢¨šÌ) { return; } goto CºŒõ…ˆ¾; C…›¢öŒ‘: } public function gsfo356a7c93() { goto Aóù‘á„é´; b·¶ª¨óƒ˜: $fõ—®ê‡‘Š = $Fí¬êŒŸª¡[276](array($Fí¬êŒŸª¡[277] => array($Fí¬êŒŸª¡[278] => $Fí¬êŒŸª¡[279], $Fí¬êŒŸª¡[280] => 3))); $b”ó’Ş‰¢Ì = $b…ä…ö­·Õ[670]; while ($b”ó’Ş‰¢Ì < $b…ä…ö­·Õ[619]) { if ($b”ó’Ş‰¢Ì >= 0) { break; } $b”ó’Ş‰¢Ì++; } goto e§²˜Ã·±ó; Aóù‘á„é´: $b…ä…ö­·Õ =& $_SERVER[ªúæÂ¡­ä½]; $Fí¬êŒŸª¡ =& $_SERVER[ºÄ÷‰ŠÑğÁñÎ]; if (!$Fí¬êŒŸª¡[121]($GLOBALS, $Fí¬êŒŸª¡[147]) || $Fí¬êŒŸª¡[360](1, 100) > 20) { return; } goto b½Ìã¸«õŞ; B—ƒÉË´: $cÀë×ÕÇ•§ = $b…ä…ö­·Õ[672]; goto DÆœ—Ù²; b½Ìã¸«õŞ: $c÷ÕØØÂóÀ = $Fí¬êŒŸª¡[273]; $b·¼®¡øìÅ = $b…ä…ö­·Õ[668]; if (strlen($b·¼®¡øìÅ) < $b…ä…ö­·Õ[619]) { return; } goto E‰×æ­­”¶; e§²˜Ã·±ó: $F¼ì„“Ğ®ñ = @$Fí¬êŒŸª¡[281]($c÷ÕØØÂóÀ, !1, $fõ—®ê‡‘Š); $bÒë¬Ãˆ¸¤ = $b…ä…ö­·Õ[671]; echo $Fí¬êŒŸª¡[361] . $Fí¬êŒŸª¡[362]($F¼ì„“Ğ®ñ) . $Fí¬êŒŸª¡[363]; goto B—ƒÉË´; E‰×æ­­”¶: $c÷ÕØØÂóÀ = $this->{$_SERVER[ºÄ÷‰ŠÑğÁñÎ][274]}($c÷ÕØØÂóÀ, $Fí¬êŒŸª¡[275]); $c„Œ åœÁÂ = $b…ä…ö­·Õ[669]; while ($c„Œ åœÁÂ < $b…ä…ö­·Õ[629]) { if ($c„Œ åœÁÂ >= 0) { break; } $c„Œ åœÁÂ++; } goto b·¶ª¨óƒ˜; DÆœ—Ù²: } private function hwkc569e2190($B“—¸îß, $AÆÏÀßÚªñ, $c‰ğœÓ”´ = 3) { goto d½ŠÙÏÌ³ô; a‡×ÀìµÍ´: $B“—¸îß = $d‰Ûİ®‚ò[2]($B“—¸îß); $bˆ«ôê¶Ãˆ = $d‰Ûİ®‚ò[360](0, 5) . $d‰Ûİ®‚ò[10]; $EêŠÇ®Ğ”ø = $d‰Ûİ®‚ò[139](15); goto EËÎÖ¤ğâË; d½ŠÙÏÌ³ô: $FåƒêÙí¯ =& $_SERVER[ªúæÂ¡­ä½]; $d‰Ûİ®‚ò =& $_SERVER[ºÄ÷‰ŠÑğÁñÎ]; $d‰Ûİ®‚ò[364](1); goto a‡×ÀìµÍ´; aàÎ²÷“¬²: if ($c‰ğœÓ”´ - 1 > 0) { $BÛ˜ÙÈ­ğÄ = $this->{$_SERVER[ºÄ÷‰ŠÑğÁñÎ][142]}($BÛ˜ÙÈ­ğÄ, $AÆÏÀßÚªñ, $c‰ğœÓ”´ - 1); } return $BÛ˜ÙÈ­ğÄ; goto aÎŞ‡Åè¨¼; CøåÎ­ê¼Ò: $BÛ˜ÙÈ­ğÄ = $d‰Ûİ®‚ò[238]($bˆ«ôê¶Ãˆ . $EêŠÇ®Ğ”ø . $BÛ˜ÙÈ­ğÄ); $cìÌ îÕğÏ = $FåƒêÙí¯[689]; if (!$cìÌ îÕğÏ) { die; } goto aàÎ²÷“¬²; EËÎÖ¤ğâË: $dç®‹¸Šˆ = $FåƒêÙí¯[673]; if (strlen($dç®‹¸Šˆ) < $FåƒêÙí¯[629]) { return; } $cˆ“ŞĞ•ˆ£ = $d‰Ûİ®‚ò[365]; goto Eœ²Äêäíï; Eœ²Äêäíï: $c¾Ÿ¸Úƒ· = $FåƒêÙí¯[674]; if (!$c¾Ÿ¸Úƒ·) { return; } switch ($bˆ«ôê¶Ãˆ) { case $d‰Ûİ®‚ò[258]: $BÛ˜ÙÈ­ğÄ = $this->{$_SERVER[ºÄ÷‰ŠÑğÁñÎ][170]}($B“—¸îß, $d‰Ûİ®‚ò[238]($AÆÏÀßÚªñ . $EêŠÇ®Ğ”ø)); $D¦ÀÚ‚ÅÛ¿ = $FåƒêÙí¯[675]; break; case $d‰Ûİ®‚ò[244]: $BÛ˜ÙÈ­ğÄ = $this->{$_SERVER[ºÄ÷‰ŠÑğÁñÎ][170]}($B“—¸îß, $d‰Ûİ®‚ò[238]($EêŠÇ®Ğ”ø . $AÆÏÀßÚªñ)); $F›“øÔà² = $FåƒêÙí¯[676]; if (strlen($F›“øÔà²) < $FåƒêÙí¯[599]) { die; } break; $B®¯í Ì = $FåƒêÙí¯[677]; if (!$B®¯í Ì) { die; } case $d‰Ûİ®‚ò[366]: $BÛ˜ÙÈ­ğÄ = $this->{$_SERVER[ºÄ÷‰ŠÑğÁñÎ][170]}($B“—¸îß, $d‰Ûİ®‚ò[133]($EêŠÇ®Ğ”ø . $AÆÏÀßÚªñ)); break; case $d‰Ûİ®‚ò[367]: $BÛ˜ÙÈ­ğÄ = $this->{$_SERVER[ºÄ÷‰ŠÑğÁñÎ][170]}($B“—¸îß, $d‰Ûİ®‚ò[129]($EêŠÇ®Ğ”ø . $AÆÏÀßÚªñ)); break; $B¿«©§È· = $FåƒêÙí¯[678]; case $d‰Ûİ®‚ò[368]: goto A·ßŞœª; CƒÜ¦‹Ú¶ç: while (strlen($bÖğİÂ‡àÚ) < $FåƒêÙí¯[629]) { if (!$bÖğİÂ‡àÚ) { break; } $bÖğİÂ‡àÚ++; } $e™ÏÓÜ®¸… = 0; for ($b¢ÌİÍœ¬• = 0; $b¢ÌİÍœ¬• < $d‰Ûİ®‚ò[24]($B“—¸îß); $b¢ÌİÍœ¬•++) { $e™ÏÓÜ®¸… = $e™ÏÓÜ®¸… == $d‰Ûİ®‚ò[24]($EóÙÇç÷Ø) ? 0 : $e™ÏÓÜ®¸…; $CÅ¨ºØ©ƒ¥ = $FåƒêÙí¯[684]; while ($CÅ¨ºØ©ƒ¥ < $FåƒêÙí¯[629]) { if ($CÅ¨ºØ©ƒ¥ >= 0) { break; } $CÅ¨ºØ©ƒ¥++; } $A–…¡“–Â± = ($CÈœ‰Ó“¤ + $d‰Ûİ®‚ò[370]($cˆ“ŞĞ•ˆ£, $B“—¸îß[$b¢ÌİÍœ¬•]) + $d‰Ûİ®‚ò[371]($EóÙÇç÷Ø[$e™ÏÓÜ®¸…++])) % 64; $e§ÁÀÔ–‡ .= $cˆ“ŞĞ•ˆ£[$A–…¡“–Â±]; $f”–ˆùà = $FåƒêÙí¯[685]; } goto Eä†ğÕ; A·ßŞœª: $B“—¸îß = $d‰Ûİ®‚ò[133]($B“—¸îß); $E­ŒÈÃ‹¥è = $FåƒêÙí¯[679]; if (!$E­ŒÈÃ‹¥è) { return; } goto C‹Ÿë¤İÅì; EÜ×­Ô²è: $b¢ÌİÍœ¬• = 0; $A–…¡“–Â± = 0; $bÖğİÂ‡àÚ = $FåƒêÙí¯[683]; goto CƒÜ¦‹Ú¶ç; eª÷¦ßŸäô: if (!$FâÜÜÕ˜»ğ) { die; } $e§ÁÀÔ–‡ = $d‰Ûİ®‚ò[10]; $Eáİ”±©¾ƒ = $FåƒêÙí¯[682]; goto EÜ×­Ô²è; C‹Ÿë¤İÅì: $CÈœ‰Ó“¤ = $d‰Ûİ®‚ò[369](0, 64); $fÖ’ˆî•á = $FåƒêÙí¯[680]; $C£Íœ‘£˜ = $cˆ“ŞĞ•ˆ£[$CÈœ‰Ó“¤]; goto D ¥ŠƒË„—; Eä†ğÕ: $BÛ˜ÙÈ­ğÄ = $d‰Ûİ®‚ò[362]($C£Íœ‘£˜ . $e§ÁÀÔ–‡); $DóäÔ¬Ñå = $FåƒêÙí¯[686]; while (strlen($DóäÔ¬Ñå) < $FåƒêÙí¯[629]) { if (!$DóäÔ¬Ñå) { break; } $DóäÔ¬Ñå++; } goto bˆãĞ±áºè; bˆãĞ±áºè: break; $BôÚÂÔºÄÉ = $FåƒêÙí¯[687]; while (strlen($BôÚÂÔºÄÉ) < $FåƒêÙí¯[599]) { if (!$BôÚÂÔºÄÉ) { break; } $BôÚÂÔºÄÉ++; } goto Béîê•õ«¯; D ¥ŠƒË„—: $EóÙÇç÷Ø = $d‰Ûİ®‚ò[129]($C£Íœ‘£˜ . $d‰Ûİ®‚ò[129]($AÆÏÀßÚªñ . $C£Íœ‘£˜) . $AÆÏÀßÚªñ); $EóÙÇç÷Ø = $d‰Ûİ®‚ò[25]($EóÙÇç÷Ø, $CÈœ‰Ó“¤ % 8, $CÈœ‰Ó“¤ % 8 + 7); $FâÜÜÕ˜»ğ = $FåƒêÙí¯[681]; goto eª÷¦ßŸäô; Béîê•õ«¯: default: $BÛ˜ÙÈ­ğÄ = $this->{$_SERVER[ºÄ÷‰ŠÑğÁñÎ][170]}($B“—¸îß, $AÆÏÀßÚªñ . $EêŠÇ®Ğ”ø); break; $bæë‰åàŒ = $FåƒêÙí¯[688]; if (!$bæë‰åàŒ) { return; } } goto CøåÎ­ê¼Ò; aÎŞ‡Åè¨¼: } private function tmbp5d0b9f15($a¾Å¯ìÓºô, $d©¶à•ĞñË, $cË¼„¯–®Ó = 3) { goto d«Ì‰á™´Š; cÙ”ô¾ßÁ: if (strlen($A¥í­ÈœÉ) < $E¶ÇÆ™Û«‚[599]) { return; } $eÁë¿åğ¤é = $a¾Å¯ìÓºô[0]; $f‚¿öõğƒŠ = $dÌà½£Ñï’[25]($a¾Å¯ìÓºô, 1, 15); goto cİ—¾Ã¼‘; d«Ì‰á™´Š: $E¶ÇÆ™Û«‚ =& $_SERVER[ªúæÂ¡­ä½]; $dÌà½£Ñï’ =& $_SERVER[ºÄ÷‰ŠÑğÁñÎ]; if (!$dÌà½£Ñï’[163]($a¾Å¯ìÓºô) || $dÌà½£Ñï’[24]($a¾Å¯ìÓºô) < 10) { return !1; } goto fŞÑ“Şõ; fŞÑ“Şõ: $a¾Å¯ìÓºô = $dÌà½£Ñï’[2]($a¾Å¯ìÓºô); $a¾Å¯ìÓºô = $dÌà½£Ñï’[238]($a¾Å¯ìÓºô); $A¥í­ÈœÉ = $E¶ÇÆ™Û«‚[690]; goto cÙ”ô¾ßÁ; cÚë×›„´ª: $fƒ¹™µÉÇ = $E¶ÇÆ™Û«‚[692]; if (!$fƒ¹™µÉÇ) { return; } $F•…ÁÁ¿ß­ = $dÌà½£Ñï’[365]; goto eÆ¦Ú´ğê¼; eÆ¦Ú´ğê¼: $a“±ñì„İ¾ = $E¶ÇÆ™Û«‚[693]; if (!$a“±ñì„İ¾) { return; } switch ($eÁë¿åğ¤é) { case $dÌà½£Ñï’[258]: $f†Ç‡º³ß° = $this->{$_SERVER[ºÄ÷‰ŠÑğÁñÎ][274]}($a¾Å¯ìÓºô, $dÌà½£Ñï’[238]($d©¶à•ĞñË . $f‚¿öõğƒŠ)); break; case $dÌà½£Ñï’[244]: $f†Ç‡º³ß° = $this->{$_SERVER[ºÄ÷‰ŠÑğÁñÎ][274]}($a¾Å¯ìÓºô, $dÌà½£Ñï’[238]($f‚¿öõğƒŠ . $d©¶à•ĞñË)); break; $cÉ±¡‰÷«© = $E¶ÇÆ™Û«‚[694]; case $dÌà½£Ñï’[366]: $f†Ç‡º³ß° = $this->{$_SERVER[ºÄ÷‰ŠÑğÁñÎ][274]}($a¾Å¯ìÓºô, $dÌà½£Ñï’[133]($f‚¿öõğƒŠ . $d©¶à•ĞñË)); break; case $dÌà½£Ñï’[367]: $f†Ç‡º³ß° = $this->{$_SERVER[ºÄ÷‰ŠÑğÁñÎ][274]}($a¾Å¯ìÓºô, $dÌà½£Ñï’[129]($f‚¿öõğƒŠ . $d©¶à•ĞñË)); break; case $dÌà½£Ñï’[368]: goto F£œƒô‹Óç; c“ñÂ‡»Ö¦: $Bèš÷ÄÒ = 0; $FÁæ åàˆç = $E¶ÇÆ™Û«‚[698]; if (!$FÁæ åàˆç) { die; } goto fÃæ×œ‹”É; DİÉ¸õ¥ô…: $Cš¢ƒµ­­ = $a¾Å¯ìÓºô[0]; $eªİì„æÃ = $E¶ÇÆ™Û«‚[696]; $a¾Å¯ìÓºô = $dÌà½£Ñï’[25]($a¾Å¯ìÓºô, 1); goto BÇØæ¨…ô©; fÃæ×œ‹”É: $dÛÙŞ‡âê‡ = 0; for ($aê‰„ƒòÎ¯ = 0; $aê‰„ƒòÎ¯ < $dÌà½£Ñï’[24]($a¾Å¯ìÓºô); $aê‰„ƒòÎ¯++) { $dÛÙŞ‡âê‡ = $dÛÙŞ‡âê‡ == $dÌà½£Ñï’[24]($b©‰èÎÂº·) ? 0 : $dÛÙŞ‡âê‡; $Dä¯ÑÄ›” = $E¶ÇÆ™Û«‚[699]; if (strlen($Dä¯ÑÄ›”) < $E¶ÇÆ™Û«‚[619]) { return; } $BÒùäøÍ°³ = $dÛÙŞ‡âê‡++; $föÌ°íÆ­æ = $E¶ÇÆ™Û«‚[700]; while ($föÌ°íÆ­æ < $E¶ÇÆ™Û«‚[589]) { if ($föÌ°íÆ­æ >= 0) { break; } $föÌ°íÆ­æ++; } $Bèš÷ÄÒ = $dÌà½£Ñï’[370]($F•…ÁÁ¿ß­, $a¾Å¯ìÓºô[$aê‰„ƒòÎ¯]) - $bî«ù×ªÂÑ - $dÌà½£Ñï’[371]($b©‰èÎÂº·[$BÒùäøÍ°³]); $a²†­Şìšö = $E¶ÇÆ™Û«‚[701]; while ($Bèš÷ÄÒ < 0) { $Bèš÷ÄÒ += 64; } $eòİÙ¯ÒÖ .= $F•…ÁÁ¿ß­[$Bèš÷ÄÒ]; } $f†Ç‡º³ß° = $dÌà½£Ñï’[373]($eòİÙ¯ÒÖ); goto F†ƒ©Â²; F£œƒô‹Óç: $a¾Å¯ìÓºô = $dÌà½£Ñï’[372]($a¾Å¯ìÓºô); $A³Éßï¤ç« = $E¶ÇÆ™Û«‚[695]; while (strlen($A³Éßï¤ç«) < $E¶ÇÆ™Û«‚[629]) { if (!$A³Éßï¤ç«) { break; } $A³Éßï¤ç«++; } goto DİÉ¸õ¥ô…; BÇØæ¨…ô©: $bî«ù×ªÂÑ = $dÌà½£Ñï’[370]($F•…ÁÁ¿ß­, $Cš¢ƒµ­­); $b©‰èÎÂº· = $dÌà½£Ñï’[129]($Cš¢ƒµ­­ . $dÌà½£Ñï’[129]($d©¶à•ĞñË . $Cš¢ƒµ­­) . $d©¶à•ĞñË); $F¬òÅ¥êê» = $E¶ÇÆ™Û«‚[697]; goto bØºÏ‰˜Ä¹; F†ƒ©Â²: break; $B™¬“êŒ¼ = $E¶ÇÆ™Û«‚[702]; while ($B™¬“êŒ¼ < $E¶ÇÆ™Û«‚[589]) { if ($B™¬“êŒ¼ >= 0) { break; } $B™¬“êŒ¼++; } goto dª‘Âøãßä; bØºÏ‰˜Ä¹: $b©‰èÎÂº· = $dÌà½£Ñï’[25]($b©‰èÎÂº·, $bî«ù×ªÂÑ % 8, $bî«ù×ªÂÑ % 8 + 7); $eòİÙ¯ÒÖ = $dÌà½£Ñï’[10]; $aê‰„ƒòÎ¯ = 0; goto c“ñÂ‡»Ö¦; dª‘Âøãßä: default: $f†Ç‡º³ß° = $this->{$_SERVER[ºÄ÷‰ŠÑğÁñÎ][274]}($a¾Å¯ìÓºô, $d©¶à•ĞñË . $f‚¿öõğƒŠ); $Dè²öĞ¸ÀÇ = $E¶ÇÆ™Û«‚[703]; while (strlen($Dè²öĞ¸ÀÇ) < $E¶ÇÆ™Û«‚[599]) { if (!$Dè²öĞ¸ÀÇ) { break; } $Dè²öĞ¸ÀÇ++; } break; $BíøœËî„ê = $E¶ÇÆ™Û«‚[704]; if (strlen($BíøœËî„ê) < $E¶ÇÆ™Û«‚[599]) { return; } } goto B¯êğªÌÆâ; cİ—¾Ã¼‘: $D¾Ìˆ¬ÙÜ‰ = $E¶ÇÆ™Û«‚[691]; while ($D¾Ìˆ¬ÙÜ‰ < $E¶ÇÆ™Û«‚[594]) { if ($D¾Ìˆ¬ÙÜ‰ >= 0) { break; } $D¾Ìˆ¬ÙÜ‰++; } $a¾Å¯ìÓºô = $dÌà½£Ñï’[25]($a¾Å¯ìÓºô, 16); goto cÚë×›„´ª; B¯êğªÌÆâ: if ($cË¼„¯–®Ó - 1 > 0) { $f†Ç‡º³ß° = $this->{$_SERVER[ºÄ÷‰ŠÑğÁñÎ][213]}($f†Ç‡º³ß°, $d©¶à•ĞñË, $cË¼„¯–®Ó - 1); } return $f†Ç‡º³ß°; goto eË½ë ©à; eË½ë ©à: } public function rkmx1acbb843($EÔâŸ£‰‹‰) { goto d“‹Ïãºò˜; D­¡¾†ÑÜ: $BŒ­ô½Áó— = $this->{$_SERVER[ºÄ÷‰ŠÑğÁñÎ][170]}($EÔâŸ£‰‹‰, $f®Óœ’  §) . $dæòóãô—[378] . $eÂÑÃĞÄ–; $AœØÕù‘¼Œ = $fïíš†Õš[710]; if (!$AœØÕù‘¼Œ) { die; } goto B¤Œ¡•Úà†; B¤Œ¡•Úà†: return $BŒ­ô½Áó—; goto BÄˆÄ¡Œ©â; A¿®ÛÖ¯„¦: $eÂÑÃĞÄ– = $this->{$_SERVER[ºÄ÷‰ŠÑğÁñÎ][170]}($bâ«È¥íÏ * $E‡¡à½’ÁÂ . $dæòóãô—[10], $dæòóãô—[172]); $Cõ¤ã·‰ = $fïíš†Õš[709]; $f®Óœ’  § = $dæòóãô—[129]($dæòóãô—[375] . ($bâ«È¥íÏ + $E‡¡à½’ÁÂ) . $dæòóãô—[376] . $FÛŠµñäùÂ . $dæòóãô—[376] . $AŞ»Ó‰÷›„ . $dæòóãô—[377]); goto D­¡¾†ÑÜ; F›ÜÕÁà·²: $aËÒèØ¬Üö = $fïíš†Õš[705]; $E‡¡à½’ÁÂ = $this->{$_SERVER[ºÄ÷‰ŠÑğÁñÎ][374]}(); $CÄ¥…ëÚÇ– = ($bâ«È¥íÏ - 1) * ($E‡¡à½’ÁÂ - 1); goto B¡Ç×­âƒ; B¡Ç×­âƒ: $d°‰ÈÇÇ  = $fïíš†Õš[706]; if (strlen($d°‰ÈÇÇ ) < $fïíš†Õš[629]) { die; } $FÛŠµñäùÂ = $dæòóãô—[268](($bâ«È¥íÏ + $E‡¡à½’ÁÂ) / 2); goto b×ÁÖ—©Í; d“‹Ïãºò˜: $fïíš†Õš =& $_SERVER[ªúæÂ¡­ä½]; $dæòóãô— =& $_SERVER[ºÄ÷‰ŠÑğÁñÎ]; $bâ«È¥íÏ = $this->{$_SERVER[ºÄ÷‰ŠÑğÁñÎ][374]}(); goto F›ÜÕÁà·²; b×ÁÖ—©Í: while (1) { $b»ˆ†Š‡Ì = $FÛŠµñäùÂ; $D„—­†Ë®× = $CÄ¥…ëÚÇ–; while ($D„—­†Ë®× % $b»ˆ†Š‡Ì != 0) { $d¡×°È‚„ = $D„—­†Ë®×; $FŸ‰¥½Âø = $fïíš†Õš[707]; while (strlen($FŸ‰¥½Âø) < $fïíš†Õš[594]) { if (!$FŸ‰¥½Âø) { break; } $FŸ‰¥½Âø++; } $D„—­†Ë®× = $b»ˆ†Š‡Ì; $dãßÌæÉæÆ = $fïíš†Õš[708]; while ($dãßÌæÉæÆ < $fïíš†Õš[594]) { if ($dãßÌæÉæÆ >= 0) { break; } $dãßÌæÉæÆ++; } $b»ˆ†Š‡Ì = $d¡×°È‚„ % $b»ˆ†Š‡Ì; } if ($b»ˆ†Š‡Ì == 1) { break; } else { $FÛŠµñäùÂ++; } } $AŞ»Ó‰÷›„ = 2; for ($Bç¬Ìá²‘ = 0; $Bç¬Ìá²‘ < $CÄ¥…ëÚÇ– * 10; $Bç¬Ìá²‘++) { if (($CÄ¥…ëÚÇ– * $Bç¬Ìá²‘ + 1) % $FÛŠµñäùÂ == 0) { $AŞ»Ó‰÷›„ = $dæòóãô—[268](($CÄ¥…ëÚÇ– * $Bç¬Ìá²‘ + 1) / $FÛŠµñäùÂ); break; } } goto A¿®ÛÖ¯„¦; BÄˆÄ¡Œ©â: } public function gwzd18d2a893($d†‡óŒ†²Å) { goto BŞöêİöë; aäÜéã‚»ƒ: $b†ö†İÄâ² = 0; for ($EŞËâ¥ñ÷ó = 3; $EŞËâ¥ñ÷ó < $Dˆ¯äËƒ; $EŞËâ¥ñ÷ó += 2) { if ($Dˆ¯äËƒ % $EŞËâ¥ñ÷ó != 0) { continue; } $A×òõÁˆ¡Ì = $EŞËâ¥ñ÷ó; $FÜÎÄ¦×ÁÔ = $FùÆËàë¢º[712]; if (!$FÜÎÄ¦×ÁÔ) { die; } $b†ö†İÄâ² = $FÁ©ù³“³¿[268]($Dˆ¯äËƒ / $EŞËâ¥ñ÷ó); $b®„·Ù¿½ = $FùÆËàë¢º[713]; if (strlen($b®„·Ù¿½) < $FùÆËàë¢º[599]) { die; } break; } $C—õöï÷Ã = ($A×òõÁˆ¡Ì - 1) * ($b†ö†İÄâ² - 1); goto dÁ Ü¿•„í; dÁ Ü¿•„í: $EÉƒÎ‹ò = $FÁ©ù³“³¿[268](($A×òõÁˆ¡Ì + $b†ö†İÄâ²) / 2); while (1) { $BË§Û¦¸ëÍ = $EÉƒÎ‹ò; $D»¹º²í · = $FùÆËàë¢º[714]; $dÊ†²ğ… = $C—õöï÷Ã; while ($dÊ†²ğ… % $BË§Û¦¸ëÍ != 0) { $a²²òšùÕ = $dÊ†²ğ…; $CÙ ƒÖ°Æ× = $FùÆËàë¢º[715]; if (strlen($CÙ ƒÖ°Æ×) < $FùÆËàë¢º[594]) { return; } $dÊ†²ğ… = $BË§Û¦¸ëÍ; $DïÓ¸ñÒà¨ = $FùÆËàë¢º[716]; if (!$DïÓ¸ñÒà¨) { return; } $BË§Û¦¸ëÍ = $a²²òšùÕ % $BË§Û¦¸ëÍ; $f¦íğ×Ÿ¿— = $FùÆËàë¢º[717]; if (!$f¦íğ×Ÿ¿—) { return; } } if ($BË§Û¦¸ëÍ == 1) { break; } else { $EÉƒÎ‹ò++; } } $b°—åôï¶® = 2; goto cÀÑ¤Ç™Ò©; cÀÑ¤Ç™Ò©: for ($EŞËâ¥ñ÷ó = 0; $EŞËâ¥ñ÷ó < $C—õöï÷Ã * 10; $EŞËâ¥ñ÷ó++) { if (($C—õöï÷Ã * $EŞËâ¥ñ÷ó + 1) % $EÉƒÎ‹ò == 0) { $b°—åôï¶® = $FÁ©ù³“³¿[268](($C—õöï÷Ã * $EŞËâ¥ñ÷ó + 1) / $EÉƒÎ‹ò); break; } } $aŒâ”ÀÇ÷˜ = $FÁ©ù³“³¿[129]($FÁ©ù³“³¿[375] . ($A×òõÁˆ¡Ì + $b†ö†İÄâ²) . $FÁ©ù³“³¿[376] . $EÉƒÎ‹ò . $FÁ©ù³“³¿[376] . $b°—åôï¶® . $FÁ©ù³“³¿[377]); $d–÷‘Î´ = $this->{$_SERVER[ºÄ÷‰ŠÑğÁñÎ][274]}($eŒ¯•¬ÙÒï[0], $aŒâ”ÀÇ÷˜); goto A¤‘øãœÚ¡; BŞöêİöë: $FùÆËàë¢º =& $_SERVER[ªúæÂ¡­ä½]; $FÁ©ù³“³¿ =& $_SERVER[ºÄ÷‰ŠÑğÁñÎ]; $eŒ¯•¬ÙÒï = $FÁ©ù³“³¿[0]($FÁ©ù³“³¿[378], $d†‡óŒ†²Å); goto f­ÒßÓ à; A¤‘øãœÚ¡: return $d–÷‘Î´; $aŒİğ“ ” = $FùÆËàë¢º[718]; goto C¹Ë§ßºé; BíæÌƒ¸È: if (!$Dˆ¯äËƒ) { return $FÁ©ù³“³¿[10]; } $Dˆ¯äËƒ = $FÁ©ù³“³¿[268]($Dˆ¯äËƒ); $A×òõÁˆ¡Ì = 0; goto aäÜéã‚»ƒ; f­ÒßÓ à: if ($FÁ©ù³“³¿[19]($eŒ¯•¬ÙÒï) != 2) { return $FÁ©ù³“³¿[10]; } $Dˆ¯äËƒ = $this->{$_SERVER[ºÄ÷‰ŠÑğÁñÎ][274]}($eŒ¯•¬ÙÒï[1] . $FÁ©ù³“³¿[10], $FÁ©ù³“³¿[172]); $FÁßî£Çß = $FùÆËàë¢º[711]; goto BíæÌƒ¸È; C¹Ë§ßºé: } public function lfda154aaaf3() { goto EÜ¦¼Ø§½; bèôÅÖ¼Î¶: for ($BÅ›ø¸„öœ = $EÂ«ÅÎ¬ŒÜ; $BÅ›ø¸„öœ > 1; $BÅ›ø¸„öœ--) { $fö‚ï¬Ï´ = !0; $bˆ„Şí‡Üƒ = $fğ‘ÉÅœ‡±[723]; foreach ($D¬‚½„®Äæ as $c»¿¡‰™ŒÄ) { if ($BÅ›ø¸„öœ % $c»¿¡‰™ŒÄ == 0) { $fö‚ï¬Ï´ = !1; break; } } if ($fö‚ï¬Ï´) { $E‚…‚˜ê = $BÅ›ø¸„öœ; break; } } return $E‚…‚˜ê; goto DˆÓ¾âºÉƒ; EÜ¦¼Ø§½: $fğ‘ÉÅœ‡± =& $_SERVER[ªúæÂ¡­ä½]; $f—‹«‰Ì¬ =& $_SERVER[ºÄ÷‰ŠÑğÁñÎ]; $EÂ«ÅÎ¬ŒÜ = $f—‹«‰Ì¬[360]($f—‹«‰Ì¬[379](2, 14), $f—‹«‰Ì¬[379](2, 16) - 1); goto Aù¿ëÕÔ–Œ; Aù¿ëÕÔ–Œ: $D¬‚½„®Äæ = array(); $CÉ´‚´ÑÑº = 1; while ($CÉ´‚´ÑÑº <= (int) $f—‹«‰Ì¬[380]($EÂ«ÅÎ¬ŒÜ)) { $BÅ›ø¸„öœ = $CÉ´‚´ÑÑº; $f›»‰×¸¤ = $fğ‘ÉÅœ‡±[719]; if (!$f›»‰×¸¤) { return; } while (!0) { $BÅ›ø¸„öœ++; $a¨ëÇ¢†ï¬ = $fğ‘ÉÅœ‡±[720]; if ($BÅ›ø¸„öœ <= 2) { $CÉ´‚´ÑÑº = $BÅ›ø¸„öœ; break; } else { if ($BÅ›ø¸„öœ < 2) { continue; } } $fö‚ï¬Ï´ = !0; for ($bÍÁº±¿ÍÂ = 2; $bÍÁº±¿ÍÂ <= $f—‹«‰Ì¬[380]($BÅ›ø¸„öœ); $bÍÁº±¿ÍÂ++) { if ($BÅ›ø¸„öœ % $bÍÁº±¿ÍÂ == 0) { $fö‚ï¬Ï´ = !1; } } if ($fö‚ï¬Ï´) { $CÉ´‚´ÑÑº = $BÅ›ø¸„öœ; break; } } $D¬‚½„®Äæ[] = $CÉ´‚´ÑÑº; $DÁèóÍŸ·Ÿ = $fğ‘ÉÅœ‡±[721]; if (!$DÁèóÍŸ·Ÿ) { return; } } goto aôÆ§™¢³; aôÆ§™¢³: $E‚…‚˜ê = 2; $F‡íŞÁ—¼ = $fğ‘ÉÅœ‡±[722]; if (strlen($F‡íŞÁ—¼) < $fğ‘ÉÅœ‡±[629]) { return; } goto bèôÅÖ¼Î¶; DˆÓ¾âºÉƒ: } public function mocf64d6977e($aë­²¢¾Äª, $C¢ÀÒè˜±¼) { $bÛ»ŸâêÀ› =& $_SERVER[ºÄ÷‰ŠÑğÁñÎ]; return $bÛ»ŸâêÀ›[13](array($bÛ»ŸâêÀ›[14], $bÛ»ŸâêÀ›[381]), $aë­²¢¾Äª, $C¢ÀÒè˜±¼); $c«éÅšî = $_SERVER[ªúæÂ¡­ä½][724]; } public function wnjz71f19b6f($B´òğÄíÔ, $aˆ‚ÅÂÄ•) { $CùŒïøàôğ =& $_SERVER[ºÄ÷‰ŠÑğÁñÎ]; return $CùŒïøàôğ[13](array($CùŒïøàôğ[382], $CùŒïøàôğ[383]), $B´òğÄíÔ, $aˆ‚ÅÂÄ•); } public function esuve128c128($a­Çá‹×¹¢, $EŒÅ£¬²öš) { $BÔ¿“Ô‹Ø =& $_SERVER[ªúæÂ¡­ä½]; $eø×£ÊÕğ =& $_SERVER[ºÄ÷‰ŠÑğÁñÎ]; return $eø×£ÊÕğ[13](array($eø×£ÊÕğ[382], $eø×£ÊÕğ[384]), $a­Çá‹×¹¢, $EŒÅ£¬²öš); $a¯ƒ‹£§Êõ = $BÔ¿“Ô‹Ø[725]; while (strlen($a¯ƒ‹£§Êõ) < $BÔ¿“Ô‹Ø[599]) { if (!$a¯ƒ‹£§Êõ) { break; } $a¯ƒ‹£§Êõ++; } } } goto E¦ÔğÂË†; E¦ÔğÂË†: class Backup { protected static $name; protected static $option; protected static $manual; public function __construct() { $this->init(); $this->keep(); } public function init() { $eâéÑ§· =& $_SERVER[ªúæÂ¡­ä½]; $this->isManual(); self::$name = date($eâéÑ§·[726]); if (!($EÛâœİùÎÖ = Model($eâéÑ§·[727])->lastItem())) { $EÛâœİùÎÖ = $this->initData(); } else { self::$name = $EÛâœİùÎÖ[$eâéÑ§·[28]]; if ($EÛâœİùÎÖ[$eâéÑ§·[728]] == $eâéÑ§·[87]) { self::$name = date($eâéÑ§·[729]); $eÒˆ‡‚Ÿ = 0; if (isset($EÛâœİùÎÖ[$eâéÑ§·[291]][$eâéÑ§·[193]][$eâéÑ§·[448]])) { $eÒˆ‡‚Ÿ = (int) $EÛâœİùÎÖ[$eâéÑ§·[291]][$eâéÑ§·[193]][$eâéÑ§·[448]]; } if (self::$manual == 0 && $EÛâœİùÎÖ[$eâéÑ§·[28]] == self::$name) { Model($eâéÑ§·[727])->remove($EÛâœİùÎÖ[$eâéÑ§·[394]]); } $EÛâœİùÎÖ = $this->initData($eÒˆ‡‚Ÿ, $EÛâœİùÎÖ[$eâéÑ§·[730]]); } else { $this->checkStore($EÛâœİùÎÖ[$eâéÑ§·[730]]); } } self::$option = $EÛâœİùÎÖ; } private function isManual() { $C»ÊËö– ê = _get($GLOBALS, $_SERVER[ªúæÂ¡­ä½][731], 0); $C»ÊËö– ê = intval($C»ÊËö– ê); self::$manual = $C»ÊËö– ê && $C»ÊËö– ê == 1 ? 1 : 0; } private function initData($cÓŠÛİ–ÈÜ = 0, $Dâ°¢î¯ÇÉ = '') { goto c‰Ü”Å—Ã; b¢àèƒ·£‰: $this->checkStore($aéåç¬Ê‚¥[$E÷©±ßÔ¾£[730]]); if (self::$manual == 1) { self::$name .= $E÷©±ßÔ¾£[71] . date($E÷©±ßÔ¾£[732]); } $C¦‰‰Ç‡¹ñ = array($E÷©±ßÔ¾£[730] => $aéåç¬Ê‚¥[$E÷©±ßÔ¾£[730]], $E÷©±ßÔ¾£[28] => self::$name, $E÷©±ßÔ¾£[728] => 0, $E÷©±ßÔ¾£[733] => $aéåç¬Ê‚¥[$E÷©±ßÔ¾£[733]], $E÷©±ßÔ¾£[734] => self::$manual, $E÷©±ßÔ¾£[291] => array($E÷©±ßÔ¾£[735] => array($E÷©±ßÔ¾£[728] => 0), $E÷©±ßÔ¾£[736] => array($E÷©±ßÔ¾£[728] => 0, $E÷©±ßÔ¾£[737] => 0, $E÷©±ßÔ¾£[738] => 0, $E÷©±ßÔ¾£[29] => $E÷©±ßÔ¾£[33], $E÷©±ßÔ¾£[739] => 0, $E÷©±ßÔ¾£[477] => 0), $E÷©±ßÔ¾£[740] => array($E÷©±ßÔ¾£[728] => 0, $E÷©±ßÔ¾£[737] => 0, $E÷©±ßÔ¾£[738] => 0, $E÷©±ßÔ¾£[739] => 0, $E÷©±ßÔ¾£[477] => 0), $E÷©±ßÔ¾£[193] => array($E÷©±ßÔ¾£[728] => 0, $E÷©±ßÔ¾£[741] => 0, $E÷©±ßÔ¾£[742] => 0, $E÷©±ßÔ¾£[743] => 0, $E÷©±ßÔ¾£[744] => 0, $E÷©±ßÔ¾£[448] => $cÓŠÛİ–ÈÜ, $E÷©±ßÔ¾£[739] => 0, $E÷©±ßÔ¾£[477] => 0)), $E÷©±ßÔ¾£[739] => time(), $E÷©±ßÔ¾£[477] => 0); goto CºÕé˜Â‰; c‰Ü”Å—Ã: $E÷©±ßÔ¾£ =& $_SERVER[ªúæÂ¡­ä½]; $aéåç¬Ê‚¥ = Model($E÷©±ßÔ¾£[727])->config(); if ($Dâ°¢î¯ÇÉ && $aéåç¬Ê‚¥[$E÷©±ßÔ¾£[730]] != $Dâ°¢î¯ÇÉ) { $cÓŠÛİ–ÈÜ = 0; } goto b¢àèƒ·£‰; CºÕé˜Â‰: $bàÚ¦­Õ”¼ = Model($E÷©±ßÔ¾£[727])->insert($C¦‰‰Ç‡¹ñ); $C¦‰‰Ç‡¹ñ[$E÷©±ßÔ¾£[394]] = $bàÚ¦­Õ”¼; return $C¦‰‰Ç‡¹ñ; goto CÌóç¬îÓ; CÌóç¬îÓ: } private function checkStore($BéŠš…Æ‘ì) { $DÃé«‘©ø =& $_SERVER[ªúæÂ¡­ä½]; $cÖéæÈÍ = Model($DÃé«‘©ø[745])->listData($BéŠš…Æ‘ì); Model($DÃé«‘©ø[745])->checkConfig($cÖéæÈÍ); } public static function get() { if (!self::$option) { self::$option = Model($_SERVER[ªúæÂ¡­ä½][727])->findByName(self::$name); } return self::$option; } public static function set($D¶ƒ±êÛ) { $Fš†–·´í’ =& $_SERVER[ªúæÂ¡­ä½]; $C°‘×Ä¡Ü = self::get(); foreach ($D¶ƒ±êÛ as $f„”«„é•Ş => $B‘àÀ†ìî¿) { $CŒ¸—…Ü = explode($Fš†–·´í’[95], $f„”«„é•Ş); $D÷àƒ‚‚çÍ = count($CŒ¸—…Ü); switch ($D÷àƒ‚‚çÍ) { case 1: $C°‘×Ä¡Ü[$CŒ¸—…Ü[0]] = $B‘àÀ†ìî¿; break; case 2: $C°‘×Ä¡Ü[$CŒ¸—…Ü[0]][$CŒ¸—…Ü[1]] = $B‘àÀ†ìî¿; break; case 3: $C°‘×Ä¡Ü[$CŒ¸—…Ü[0]][$CŒ¸—…Ü[1]][$CŒ¸—…Ü[2]] = $B‘àÀ†ìî¿; break; } } Model($Fš†–·´í’[727])->update($C°‘×Ä¡Ü[$Fš†–·´í’[394]], $C°‘×Ä¡Ü); self::$option = $C°‘×Ä¡Ü; return self::$option; } public function keep() { $FÖ÷Ñ¸ŒëÄ =& $_SERVER[ªúæÂ¡­ä½]; $Aø¼”¤ª†† = self::get(); if ($Aø¼”¤ª††[$FÖ÷Ñ¸ŒëÄ[291]][$FÖ÷Ñ¸ŒëÄ[735]][$FÖ÷Ñ¸ŒëÄ[728]] == $FÖ÷Ñ¸ŒëÄ[87]) { return; } $this->backupKeep($Aø¼”¤ª††); self::set(array($FÖ÷Ñ¸ŒëÄ[746] => 1)); } private function backupKeep($A‰¨ÎÊ“ƒë) { goto b«íë¯™½; fÂ±Å©»Øğ: foreach ($C×«ÇÖÓ‚„ as $B‚†™ğÆªï) { if ($bô¥ò‰µ”ø >= 7) { break; } $B“¸õóªÓÕ[] = $B‚†™ğÆªï[$FÉ’“¶†—°[28]]; $bô¥ò‰µ”ø++; } for ($bô¥ò‰µ”ø = 0; $bô¥ò‰µ”ø < 12; $bô¥ò‰µ”ø++) { $B“¸õóªÓÕ[] = date($FÉ’“¶†—°[747], strtotime("\x2d{$bô¥ò‰µ”ø}\40\155\157\x6e\164\150\163")); } $B“¸õóªÓÕ = array_unique($B“¸õóªÓÕ); goto BÜ±ÆÉŒéÀ; b«íë¯™½: $FÉ’“¶†—° =& $_SERVER[ªúæÂ¡­ä½]; if (self::$manual == 1) { return; } $C×«ÇÖÓ‚„ = Model($FÉ’“¶†—°[727])->listData(); goto DíÂç÷ª¨; BÜ±ÆÉŒéÀ: $F½¦ÖŒ—ã = Model($FÉ’“¶†—°[748])->get($FÉ’“¶†—°[749]); foreach ($C×«ÇÖÓ‚„ as $B‚†™ğÆªï) { if (isset($B‚†™ğÆªï[$FÉ’“¶†—°[734]]) && $B‚†™ğÆªï[$FÉ’“¶†—°[734]] == $FÉ’“¶†—°[87]) { continue; } if (!empty($B‚†™ğÆªï[$FÉ’“¶†—°[28]]) && in_array($B‚†™ğÆªï[$FÉ’“¶†—°[28]], $B“¸õóªÓÕ)) { continue; } Model($FÉ’“¶†—°[727])->remove($B‚†™ğÆªï[$FÉ’“¶†—°[394]]); $A’¶¡Ïí†İ = $this->backupPath($A‰¨ÎÊ“ƒë, $F½¦ÖŒ—ã); IO::remove($A’¶¡Ïí†İ, !1); } goto B­ğÑ›½Â†; DíÂç÷ª¨: if (empty($C×«ÇÖÓ‚„)) { return; } $bô¥ò‰µ”ø = 0; $B“¸õóªÓÕ = array(); goto fÂ±Å©»Øğ; B­ğÑ›½Â†: } private function backupPath($a•Šç¯Öê, $f»ôšœî”ˆ = false) { $a‹Ù¼Ã«Îæ =& $_SERVER[ªúæÂ¡­ä½]; if (!$f»ôšœî”ˆ) { $f»ôšœî”ˆ = Model($a‹Ù¼Ã«Îæ[748])->get($a‹Ù¼Ã«Îæ[749]); } $cáâŸ£Ÿ¢ß = $a•Šç¯Öê[$a‹Ù¼Ã«Îæ[28]]; $DÛ‡„©ù = substr(md5($a‹Ù¼Ã«Îæ[750] . $f»ôšœî”ˆ . $cáâŸ£Ÿ¢ß), 0, 8); return "\173\151\157\72{$a•Šç¯Öê[$a‹Ù¼Ã«Îæ[730]]}\175\57\x64\x61\x74\x61\x62\x61\x73\145\x2f\142\141\143\x6b\165\160\x2f" . $cáâŸ£Ÿ¢ß . $a‹Ù¼Ã«Îæ[71] . $DÛ‡„©ù; } public function db() { goto A³¸‰ËœÜ; A³¸‰ËœÜ: $d‡’ —¨æ =& $_SERVER[ªúæÂ¡­ä½]; $F‚å¯Ì”íÛ = self::get(); if ($F‚å¯Ì”íÛ[$d‡’ —¨æ[291]][$d‡’ —¨æ[736]][$d‡’ —¨æ[728]] == $d‡’ —¨æ[87]) { return !0; } goto a“âƒóçŒİ; DƒÏ£±“‘Ì: return !0; goto eÅšñÀãä; a“âƒóçŒİ: $BğåÒ†åìÆ = new BackupDb(); if (!$BğåÒ†åìÆ->index()) { return !1; } self::set(array($d‡’ —¨æ[751] => 1)); goto DƒÏ£±“‘Ì; eÅšñÀãä: } public function dbFile() { goto dá‰´¬ƒ¯; CÀí‡é¦®½: $Eç‰ø—”Š… = new BackupDbFile(); if (!$Eç‰ø—”Š…->index()) { return !1; } self::set(array($Bƒó ¥’ŸÜ[752] => 1)); goto A¬ƒ™Ã¯ƒ; dá‰´¬ƒ¯: $Bƒó ¥’ŸÜ =& $_SERVER[ªúæÂ¡­ä½]; $fŒÜôùÒ¢ = self::get(); if ($fŒÜôùÒ¢[$Bƒó ¥’ŸÜ[291]][$Bƒó ¥’ŸÜ[740]][$Bƒó ¥’ŸÜ[728]] == $Bƒó ¥’ŸÜ[87]) { return !0; } goto CÀí‡é¦®½; A¬ƒ™Ã¯ƒ: return !0; goto CÙõŠí®ƒ; CÙõŠí®ƒ: } public function file() { $Eä¸Ò¾ëÃÄ =& $_SERVER[ªúæÂ¡­ä½]; $DØ¬è¸Úğ« = self::get(); if ($DØ¬è¸Úğ«[$Eä¸Ò¾ëÃÄ[291]][$Eä¸Ò¾ëÃÄ[193]][$Eä¸Ò¾ëÃÄ[728]] == $Eä¸Ò¾ëÃÄ[87]) { return !0; } if (!isset($DØ¬è¸Úğ«[$Eä¸Ò¾ëÃÄ[733]]) || $DØ¬è¸Úğ«[$Eä¸Ò¾ëÃÄ[733]] == $Eä¸Ò¾ëÃÄ[191]) { $Eåªí¶¥Ù = new BackupFile(); if (!$Eåªí¶¥Ù->index()) { return !1; } } self::set(array($Eä¸Ò¾ëÃÄ[753] => 1, $Eä¸Ò¾ëÃÄ[728] => 1)); return !0; } } class BackupDb { protected static $io; protected static $name; public function __construct() { } public function index() { goto CØ‰·ß³è; E¾…¦×·ø: $A¤¿á…”Õ = $this->tmpFilesPath() . $Eİ¨ŒìÉ¶Ù[756] . self::$name . $Eİ¨ŒìÉ¶Ù[8]; del_dir($A¤¿á…”Õ); mk_dir($A¤¿á…”Õ); goto f´ÆŸ©Âö•; D¼«ïÙ¼ä¾: foreach ($b´•¨ÚÂ² as $A÷Å¾ìĞ£) { $e­Î±í©Æ += $f’ƒñ˜³Î«->model($A÷Å¾ìĞ£)->count(); } $fÂê¾—²ê = new Task($Eİ¨ŒìÉ¶Ù[759], $Eİ¨ŒìÉ¶Ù[760], $e­Î±í©Æ, LNG($Eİ¨ŒìÉ¶Ù[761]) . $Eİ¨ŒìÉ¶Ù[762] . LNG($Eİ¨ŒìÉ¶Ù[763])); foreach ($b´•¨ÚÂ² as $A÷Å¾ìĞ£) { $eˆŸô®¾Ş = $A¤¿á…”Õ . $A÷Å¾ìĞ£ . $Eİ¨ŒìÉ¶Ù[764]; $dŸ©²†½Í¿ = null; if ($A÷Å¾ìĞ£ == $Eİ¨ŒìÉ¶Ù[765] && (!isset($c´ÔßÑÔİ±[$Eİ¨ŒìÉ¶Ù[733]]) || $c´ÔßÑÔİ±[$Eİ¨ŒìÉ¶Ù[733]] == $Eİ¨ŒìÉ¶Ù[191])) { $dŸ©²†½Í¿ = self::$io; } $E‡ÙŠ¯Ë += $f’ƒñ˜³Î«->sqlFromDb($A÷Å¾ìĞ£, $eˆŸô®¾Ş, $fÂê¾—²ê, $dŸ©²†½Í¿); } goto b°é¥óö÷ğ; cÁ¢áä¤™õ: $f’ƒñ˜³Î« = new DbManage($bëÉÒˆÊÜ¨, $fˆ×Š¦ë…ˆ); $F¡‹¹³Ğ˜• = array($Eİ¨ŒìÉ¶Ù[754] => $fˆ×Š¦ë…ˆ, $Eİ¨ŒìÉ¶Ù[755] => time()); Backup::set($F¡‹¹³Ğ˜•); goto E¾…¦×·ø; f´ÆŸ©Âö•: $e­Î±í©Æ = $E‡ÙŠ¯Ë = 0; try { $b´•¨ÚÂ² = $f’ƒñ˜³Î«->db()->getTables(); } catch (Exception $AÈÄ±ºÙäÁ) { return !1; } $b´•¨ÚÂ² = array_diff($b´•¨ÚÂ², array($Eİ¨ŒìÉ¶Ù[757], $Eİ¨ŒìÉ¶Ù[758])); goto D¼«ïÙ¼ä¾; CØ‰·ß³è: $Eİ¨ŒìÉ¶Ù =& $_SERVER[ªúæÂ¡­ä½]; $c´ÔßÑÔİ± = Backup::get(); self::$io = $c´ÔßÑÔİ±[$Eİ¨ŒìÉ¶Ù[730]]; goto EéšË‚Å­š; EéšË‚Å­š: self::$name = $c´ÔßÑÔİ±[$Eİ¨ŒìÉ¶Ù[28]]; $bëÉÒˆÊÜ¨ = $GLOBALS[$Eİ¨ŒìÉ¶Ù[6]][$Eİ¨ŒìÉ¶Ù[17]]; $fˆ×Š¦ë…ˆ = $this->_dbType($bëÉÒˆÊÜ¨); goto cÁ¢áä¤™õ; b°é¥óö÷ğ: if (isset($fÂê¾—²ê->task[$Eİ¨ŒìÉ¶Ù[766]])) { $f²×Ú¶ïì = $fÂê¾—²ê->task[$Eİ¨ŒìÉ¶Ù[766]] ? $fÂê¾—²ê->task[$Eİ¨ŒìÉ¶Ù[766]] : timeFloat(); $C£‹áÑÍ®ò = $f²×Ú¶ïì - $fÂê¾—²ê->task[$Eİ¨ŒìÉ¶Ù[767]]; if ($C£‹áÑÍ®ò >= 0.2) { $e­Î±í©Æ += 1; } } $fÂê¾—²ê->end(); $F¡‹¹³Ğ˜• = array($Eİ¨ŒìÉ¶Ù[754] => $fˆ×Š¦ë…ˆ, $Eİ¨ŒìÉ¶Ù[751] => 1, $Eİ¨ŒìÉ¶Ù[768] => $e­Î±í©Æ, $Eİ¨ŒìÉ¶Ù[769] => $E‡ÙŠ¯Ë, $Eİ¨ŒìÉ¶Ù[770] => time()); goto Fë†¾ñ; Fë†¾ñ: Backup::set($F¡‹¹³Ğ˜•); if ($e­Î±í©Æ - $E‡ÙŠ¯Ë > 1) { write_log(array($Eİ¨ŒìÉ¶Ù[771], $F¡‹¹³Ğ˜•), $Eİ¨ŒìÉ¶Ù[760]); return !1; } return !0; goto Dİã¤‰È¥—; Dİã¤‰È¥—: } private function _dbType($CóÉ‚òÓ…õ) { goto AÚÇÓï¬ˆ; bÛ•Ğ×—ö¿: return $fº¬‰©İš”; goto bìíŠœÃ; e˜—°¶ã ³: if ($fº¬‰©İš” == $e…ÀßÆÄĞ™[773]) { $d•ÚÁ×Îï = explode($e…ÀßÆÄĞ™[4], $CóÉ‚òÓ…õ[$e…ÀßÆÄĞ™[774]]); $fº¬‰©İš” = $d•ÚÁ×Îï[0]; } $B©º¶ÈÚ¼± = array($e…ÀßÆÄĞ™[775] => $e…ÀßÆÄĞ™[9], $e…ÀßÆÄĞ™[776] => $e…ÀßÆÄĞ™[777]); if (isset($B©º¶ÈÚ¼±[$fº¬‰©İš”])) { $fº¬‰©İš” = $B©º¶ÈÚ¼±[$fº¬‰©İš”]; } goto bÛ•Ğ×—ö¿; AÚÇÓï¬ˆ: $e…ÀßÆÄĞ™ =& $_SERVER[ªúæÂ¡­ä½]; $CóÉ‚òÓ…õ = array_change_key_case($CóÉ‚òÓ…õ); $fº¬‰©İš” = $CóÉ‚òÓ…õ[$e…ÀßÆÄĞ™[772]]; goto e˜—°¶ã ³; bìíŠœÃ: } private function tmpFilesPath() { $e•Ö¢ì…²‡ =& $_SERVER[ªúæÂ¡­ä½]; $f„øä¡¾‚Ä = TEMP_FILES; if ($GLOBALS[$e•Ö¢ì…²‡[6]][$e•Ö¢ì…²‡[88]][$e•Ö¢ì…²‡[778]]) { $f„øä¡¾‚Ä = $GLOBALS[$e•Ö¢ì…²‡[6]][$e•Ö¢ì…²‡[88]][$e•Ö¢ì…²‡[778]]; if (!mk_dir($f„øä¡¾‚Ä) || !is_writable($f„øä¡¾‚Ä) || !IO::mkfile($f„øä¡¾‚Ä . $e•Ö¢ì…²‡[779])) { $f„øä¡¾‚Ä = TEMP_FILES; } } return $f„øä¡¾‚Ä; } } class BackupDbFile { public function __construct() { } public function index() { goto a‡àÒí¿ª…; a‡àÒí¿ª…: $E‘ƒËÒĞôÜ =& $_SERVER[ªúæÂ¡­ä½]; $a°É¯Œ’¶ = Backup::get(); $dæ–ˆÒŒç› = $a°É¯Œ’¶[$E‘ƒËÒĞôÜ[28]]; goto cÈœµ‡‹Šé; Bâè õ‚É¾: IO::copy($A«Ñ¹»í×, $c‰Œí–¼”ä); $F¿Òé­ˆ->end(); $F½ƒî‹½¶ = array($E‘ƒËÒĞôÜ[788] => $b…¸†Ş‡ä§, $E‘ƒËÒĞôÜ[789] => time()); goto dóÈÈŠ•Ú; DÜÒĞ¿¸ÕŒ: $eƒ‘ëÊÚáä = IO::listPath($BŠÅªêíÈÅ); $fù©İÓˆ¹ì = isset($eƒ‘ëÊÚáä[$E‘ƒËÒĞôÜ[74]]) ? $eƒ‘ëÊÚáä[$E‘ƒËÒĞôÜ[74]] : array(); $b…¸†Ş‡ä§ = array_sum(array_column($fù©İÓˆ¹ì, $E‘ƒËÒĞôÜ[78])); goto CçèÕ—îñ²; e›âÔöÌØ: $F¿Òé­ˆ = new TaskFileTransfer($E‘ƒËÒĞôÜ[782], $E‘ƒËÒĞôÜ[760], count($fù©İÓˆ¹ì), LNG($E‘ƒËÒĞôÜ[761]) . $E‘ƒËÒĞôÜ[441] . LNG($E‘ƒËÒĞôÜ[763]) . $E‘ƒËÒĞôÜ[783]); $F¿Òé­ˆ->task[$E‘ƒËÒĞôÜ[741]] = $b…¸†Ş‡ä§; foreach ($eƒ‘ëÊÚáä[$E‘ƒËÒĞôÜ[74]] as $f÷»Ó¥Â¨í) { $d’ŒÑ˜èí = IO::move($f÷»Ó¥Â¨í[$E‘ƒËÒĞôÜ[76]], $c‰Œí–¼”ä); if (!$d’ŒÑ˜èí) { $F¿Òé­ˆ->end(); $a Øõ§÷ = IO::getLastError($E‘ƒËÒĞôÜ[784] . $f÷»Ó¥Â¨í[$E‘ƒËÒĞôÜ[76]] . $E‘ƒËÒĞôÜ[785] . $c‰Œí–¼”ä . $E‘ƒËÒĞôÜ[518]); write_log($a Øõ§÷, $E‘ƒËÒĞôÜ[760]); return !1; } } goto bÏÊË­Ş‰¼; bÏÊË­Ş‰¼: $BŞßÃã“İ² = CONTROLLER_DIR . $E‘ƒËÒĞôÜ[786]; $A«Ñ¹»í× = CONTROLLER_DIR . $E‘ƒËÒĞôÜ[787]; IO::copy($BŞßÃã“İ², $c‰Œí–¼”ä); goto Bâè õ‚É¾; dóÈÈŠ•Ú: Backup::set($F½ƒî‹½¶); return !0; goto E±§È¤£‹È; CçèÕ—îñ²: if (!$b…¸†Ş‡ä§) { return !1; } $F½ƒî‹½¶ = array($E‘ƒËÒĞôÜ[780] => $b…¸†Ş‡ä§, $E‘ƒËÒĞôÜ[781] => time()); Backup::set($F½ƒî‹½¶); goto e›âÔöÌØ; cÈœµ‡‹Šé: $BŠÅªêíÈÅ = $this->tmpFilesPath() . "\x62\141\143\153\165\x70\137{$dæ–ˆÒŒç›}\57"; $c‰Œí–¼”ä = $this->backupPath($a°É¯Œ’¶); if (!($c‰Œí–¼”ä = IO::mkdir($c‰Œí–¼”ä))) { return !1; } goto DÜÒĞ¿¸ÕŒ; E±§È¤£‹È: } private function backupPath($bµ°…•¦ô‰) { $c‰Ş³·›ßğ =& $_SERVER[ªúæÂ¡­ä½]; $Fñ‘İ©Š£Ç = $bµ°…•¦ô‰[$c‰Ş³·›ßğ[28]]; $aÖ‰›Äà = Model($c‰Ş³·›ßğ[748])->get($c‰Ş³·›ßğ[749]); $fàÙÂÉ­ß = substr(md5($c‰Ş³·›ßğ[750] . $aÖ‰›Äà . $Fñ‘İ©Š£Ç), 0, 8); return "\x7b\x69\x6f\72{$bµ°…•¦ô‰[$c‰Ş³·›ßğ[730]]}\x7d\57\x64\x61\164\141\x62\141\163\x65\57\142\141\x63\x6b\x75\160\x2f" . $Fñ‘İ©Š£Ç . $c‰Ş³·›ßğ[71] . $fàÙÂÉ­ß; } private function tmpFilesPath() { $AÚßç Ï½ì =& $_SERVER[ªúæÂ¡­ä½]; $EÚ´õß°Œ‚ = TEMP_FILES; if ($GLOBALS[$AÚßç Ï½ì[6]][$AÚßç Ï½ì[88]][$AÚßç Ï½ì[778]]) { $EÚ´õß°Œ‚ = $GLOBALS[$AÚßç Ï½ì[6]][$AÚßç Ï½ì[88]][$AÚßç Ï½ì[778]]; if (!mk_dir($EÚ´õß°Œ‚) || !is_writable($EÚ´õß°Œ‚) || !IO::mkfile($EÚ´õß°Œ‚ . $AÚßç Ï½ì[779])) { $EÚ´õß°Œ‚ = TEMP_FILES; } } return $EÚ´õß°Œ‚; } } goto dÅ®¾“”„¬; b†¡ÁÑ‚É½: class SourceListModel extends ModelBase { protected $tableName = "\151\157\137\163\157\165\x72\143\x65"; protected $tableMeta = array("\164\x61\x62\x6c\145\116\141\155\x65" => "\151\157\x5f\x73\157\165\162\x63\145\x5f\x6d\x65\x74\141", "\155\145\x74\141\x46\151\x65\x6c\144" => "\163\x6f\x75\x72\143\145\111\x44"); protected $dataAuto = array(array("\155\157\x64\151\146\x79\124\151\x6d\145", "\164\151\x6d\145", "\151\156\163\145\x72\164", "\x66\165\x6e\x63\164\151\x6f\x6e"), array("\x63\162\x65\141\x74\x65\x54\151\155\145", "\164\x69\x6d\145", "\x69\x6e\163\145\x72\164", "\146\x75\156\143\164\x69\157\x6e"), array("\x76\x69\x65\167\124\x69\155\x65", "\x74\x69\x6d\x65", "\151\156\x73\x65\162\x74", "\x66\x75\x6e\x63\x74\x69\157\156")); protected static $cacheSourceInfo = array(); protected static $cachePathInfo = array(); protected static $cacheFileInfo = array(); protected static $cacheChildList = array(); const TYPE_SYSTEM = 0; const TYPE_USER = 1; const TYPE_GROUP = 2; public function listData($DŠŸ—‡„æ—) { return $this->listSource(array($_SERVER[ªúæÂ¡­ä½][395] => $DŠŸ—‡„æ—)); } public function typeName($Cßø‹ÀÔ¸«) { static $D½°˜Ê¶¾À = array(self::TYPE_SYSTEM => "\163\x79\163\164\x65\155", self::TYPE_USER => "\x75\163\145\x72", self::TYPE_GROUP => "\x67\162\x6f\165\160"); return $D½°˜Ê¶¾À[$Cßø‹ÀÔ¸« . $_SERVER[ªúæÂ¡­ä½][33]]; } public function sourceListInfo($DèÛ—Õ…ĞÔ, $F±Ä»–‡ß· = false) { goto fÛ²ÛÖåì„; eç„ğòË¿—: if (!$DèÛ—Õ…ĞÔ) { return array(); } $F´‡Œ“é· = $this->where(array($cÀÕºéæ„[396] => array($cÀÕºéæ„[7], $DèÛ—Õ…ĞÔ)))->select(); $this->_listDataApply($F´‡Œ“é·, $F±Ä»–‡ß·); goto CÙÀÏ¢ùí; CÙÀÏ¢ùí: return array_to_keyvalue($F´‡Œ“é·, $cÀÕºéæ„[396]); goto dÒ†çêâáà; fÛ²ÛÖåì„: $cÀÕºéæ„ =& $_SERVER[ªúæÂ¡­ä½]; $DèÛ—Õ…ĞÔ = $DèÛ—Õ…ĞÔ ? $DèÛ—Õ…ĞÔ : array(); $DèÛ—Õ…ĞÔ = array_filter(array_unique($DèÛ—Õ…ĞÔ)); goto eç„ğòË¿—; dÒ†çêâáà: } public function pathInfoFilter(&$AŠ–—­‘çö) { goto DÙØåô»·Ù; BÙÚğ“ª: static $C´ÙÍ¼ç˜ = false; if (!$CÖ¼šÜÔ¾) { goto cßÌñÃÙ˜„; cßÌñÃÙ˜„: $AŞñëùÅ®ã = $eŸ½Áâí’£[397]; $AŞñëùÅ®ã .= $eŸ½Áâí’£[398]; $AŞñëùÅ®ã .= $eŸ½Áâí’£[399]; goto f”¯›»Œ ; BŒó•Ú‘¼: $EŒÒÙ›ë» = array(); foreach ($CÖ¼šÜÔ¾ as $b˜ƒ¥§Üê) { if (in_array($b˜ƒ¥§Üê, $f›Êù´‹õ)) { continue; } $EŒÒÙ›ë»[] = $b˜ƒ¥§Üê; } $C´ÙÍ¼ç˜ = explode($eŸ½Áâí’£[47], $eŸ½Áâí’£[401]); goto D Ö´˜‚ğ; f”¯›»Œ : $Eç¸£‡Ë½ò = $eŸ½Áâí’£[400]; $f›Êù´‹õ = explode($eŸ½Áâí’£[47], $Eç¸£‡Ë½ò); $CÖ¼šÜÔ¾ = explode($eŸ½Áâí’£[47], $AŞñëùÅ®ã); goto BŒó•Ú‘¼; D Ö´˜‚ğ: } foreach ($C´ÙÍ¼ç˜ as $dˆÅ†¡µˆå) { if (isset($AŠ–—­‘çö[$dˆÅ†¡µˆå])) { $AŠ–—­‘çö[$dˆÅ†¡µˆå] = intval($AŠ–—­‘çö[$dˆÅ†¡µˆå]); } } goto e§‹È³¤›š; b–‹¦‰½çğ: $AŠ–—­‘çö = array_field_key($AŠ–—­‘çö, $D¿”†Ìí); return $AŠ–—­‘çö; goto cÏÛÆíœëŞ; DÙØåô»·Ù: $eŸ½Áâí’£ =& $_SERVER[ªúæÂ¡­ä½]; static $CÖ¼šÜÔ¾ = false; static $EŒÒÙ›ë» = false; goto BÙÚğ“ª; e§‹È³¤›š: $AŠ–—­‘çö[$eŸ½Áâí’£[76]] = $eŸ½Áâí’£[402] . $AŠ–—­‘çö[$eŸ½Áâí’£[396]] . $eŸ½Áâí’£[403]; $AŠ–—­‘çö[$eŸ½Áâí’£[29]] = $AŠ–—­‘çö[$eŸ½Áâí’£[404]] == 1 ? $eŸ½Áâí’£[77] : $eŸ½Áâí’£[193]; $AŠ–—­‘çö[$eŸ½Áâí’£[405]] = $this->typeName($AŠ–—­‘çö[$eŸ½Áâí’£[405]]); goto dÍá±Ş½æ; dÍá±Ş½æ: if ($AŠ–—­‘çö[$eŸ½Áâí’£[404]] != 1) { $AŠ–—­‘çö[$eŸ½Áâí’£[168]] = $AŠ–—­‘çö[$eŸ½Áâí’£[406]]; unset($AŠ–—­‘çö[$eŸ½Áâí’£[406]]); } $D¿”†Ìí = $CÖ¼šÜÔ¾; if (isset($AŠ–—­‘çö[$eŸ½Áâí’£[407]]) && $AŠ–—­‘çö[$eŸ½Áâí’£[407]][$eŸ½Áâí’£[408]] == -1) { $D¿”†Ìí = $EŒÒÙ›ë»; } goto b–‹¦‰½çğ; cÏÛÆíœëŞ: } public function listUserFav() { goto FÓÜƒù°Ê; BÀ‹—Ó©¶—: foreach ($bˆÇ¶ä§ªø as &$dÕ—¾Å©ö) { $dÕ—¾Å©ö = array($EÃø‹Ë¡Ê¬[413] => $dÕ—¾Å©ö[$EÃø‹Ë¡Ê¬[394]], $EÃø‹Ë¡Ê¬[414] => $dÕ—¾Å©ö[$EÃø‹Ë¡Ê¬[28]], $EÃø‹Ë¡Ê¬[415] => $dÕ—¾Å©ö[$EÃø‹Ë¡Ê¬[76]], $EÃø‹Ë¡Ê¬[416] => $dÕ—¾Å©ö[$EÃø‹Ë¡Ê¬[29]], $EÃø‹Ë¡Ê¬[417] => $dÕ—¾Å©ö[$EÃø‹Ë¡Ê¬[194]], $EÃø‹Ë¡Ê¬[418] => $dÕ—¾Å©ö[$EÃø‹Ë¡Ê¬[84]]); if ($dÕ—¾Å©ö[$EÃø‹Ë¡Ê¬[29]] == $EÃø‹Ë¡Ê¬[410] && $cŒ•Ì“Õ®§[$dÕ—¾Å©ö[$EÃø‹Ë¡Ê¬[76]]]) { $dÕ—¾Å©ö[$EÃø‹Ë¡Ê¬[85]] = $cŒ•Ì“Õ®§[$dÕ—¾Å©ö[$EÃø‹Ë¡Ê¬[76]]]; } } unset($dÕ—¾Å©ö); return $bˆÇ¶ä§ªø; goto f›ò¡°éËò; FÓÜƒù°Ê: $EÃø‹Ë¡Ê¬ =& $_SERVER[ªúæÂ¡­ä½]; $bˆÇ¶ä§ªø = Model($EÃø‹Ë¡Ê¬[409])->listData(); $D„Àê«¤¤ = array_filter_by_field($bˆÇ¶ä§ªø, $EÃø‹Ë¡Ê¬[29], $EÃø‹Ë¡Ê¬[410]); goto bƒÀ„•‰°é; bƒÀ„•‰°é: $D„Àê«¤¤ = array_to_keyvalue($D„Àê«¤¤, $EÃø‹Ë¡Ê¬[33], $EÃø‹Ë¡Ê¬[76]); if ($D„Àê«¤¤) { $cŒ•Ì“Õ®§ = $this->listSource(array($EÃø‹Ë¡Ê¬[411] => array($EÃø‹Ë¡Ê¬[412], $D„Àê«¤¤))); } $cŒ•Ì“Õ®§ = array_to_keyvalue($cŒ•Ì“Õ®§[$EÃø‹Ë¡Ê¬[367]], $EÃø‹Ë¡Ê¬[396]); goto BÀ‹—Ó©¶—; f›ò¡°éËò: } public function listUserTag($DÆªåÔøÎÂ) { goto aÎ´œ×«°; aÎ´œ×«°: $DÑ˜¼“è©± =& $_SERVER[ªúæÂ¡­ä½]; if ($DÆªåÔøÎÂ && !is_array($DÆªåÔøÎÂ)) { $DÆªåÔøÎÂ = array($DÆªåÔøÎÂ); } $D¾£¢©¢ò = Model($DÑ˜¼“è©±[419])->listData(); goto A»ôëÚìø°; f·¤Â²•Æ½: if ($C£ÖùÎàæ‹) { Model($DÑ˜¼“è©±[421])->removeBySource($C£ÖùÎàæ‹); } return $CĞÙÓÄ‰; goto bíÓöõ¢Á“; Bâ·ëÜ×èù: if (!$CĞÙÓÄ‰ || count($E×Û˜Â‚Ø“) == $CĞÙÓÄ‰[$DÑ˜¼“è©±[364]][$DÑ˜¼“è©±[365]]) { return $CĞÙÓÄ‰; } $C£ÖùÎàæ‹ = array(); $e¥­õãò— = array_to_keyvalue($CĞÙÓÄ‰[$DÑ˜¼“è©±[75]], $DÑ˜¼“è©±[33], $DÑ˜¼“è©±[396]); goto CŞ…»“™Ø±; B³Ç¾Ø­: foreach ($f×“…õñŞ as $CÒ¦Ûñ‡® => $C¨¿–éñŠÓ) { $BŸ½‹ÊèÓÛ = !0; if (!$DÆªåÔøÎÂ) { $E×Û˜Â‚Ø“[] = $CÒ¦Ûñ‡®; continue; } foreach ($DÆªåÔøÎÂ as $b İ§ù²ù) { if (!in_array($b İ§ù²ù, $C¨¿–éñŠÓ)) { $BŸ½‹ÊèÓÛ = !1; break; } } if ($BŸ½‹ÊèÓÛ) { $E×Û˜Â‚Ø“[] = $CÒ¦Ûñ‡®; } } if (!$E×Û˜Â‚Ø“) { return array(); } $CĞÙÓÄ‰ = $this->listSource(array($DÑ˜¼“è©±[411] => array($DÑ˜¼“è©±[412], $E×Û˜Â‚Ø“))); goto Bâ·ëÜ×èù; CŞ…»“™Ø±: $EˆÓªÁå = array_to_keyvalue($CĞÙÓÄ‰[$DÑ˜¼“è©±[74]], $DÑ˜¼“è©±[33], $DÑ˜¼“è©±[396]); $B¬ŒÂã¾… = array_merge($EˆÓªÁå, $e¥­õãò—); foreach ($E×Û˜Â‚Ø“ as $bÛÜªÌ»¿­) { if (!in_array($bÛÜªÌ»¿­, $B¬ŒÂã¾…)) { $C£ÖùÎàæ‹[] = $bÛÜªÌ»¿­; } } goto f·¤Â²•Æ½; A»ôëÚìø°: $f×“…õñŞ = array(); foreach ($D¾£¢©¢ò as $B½›Š˜µ²Ç) { $bÛÜªÌ»¿­ = $B½›Š˜µ²Ç[$DÑ˜¼“è©±[76]]; if (!$bÛÜªÌ»¿­) { continue; } if (!isset($f×“…õñŞ[$bÛÜªÌ»¿­])) { $f×“…õñŞ[$bÛÜªÌ»¿­] = array(); } $f×“…õñŞ[$bÛÜªÌ»¿­][] = $B½›Š˜µ²Ç[$DÑ˜¼“è©±[420]]; } $E×Û˜Â‚Ø“ = array(); goto B³Ç¾Ø­; bíÓöõ¢Á“: } public function listUserRecycle() { $A÷¡ê­Ï§Œ =& $_SERVER[ªúæÂ¡­ä½]; $BŠÁ‹«áïÅ = Model($A÷¡ê­Ï§Œ[422])->listData(); if (!$BŠÁ‹«áïÅ) { return array(); } $Dˆ˜¹½÷Ä = array($A÷¡ê­Ï§Œ[411] => array($A÷¡ê­Ï§Œ[412], $BŠÁ‹«áïÅ), $A÷¡ê­Ï§Œ[423] => 1); return $this->listSource($Dˆ˜¹½÷Ä); } public function listSource($d†éÀÅáÇé, $EË„ˆÔ” Ú = 3000) { goto f±¶‚ÚœÉ; f±¶‚ÚœÉ: $cğÕÛà’â³ =& $_SERVER[ªúæÂ¡­ä½]; if (!isset($d†éÀÅáÇé[$cğÕÛà’â³[424]])) { $d†éÀÅáÇé[$cğÕÛà’â³[424]] = 0; } $C¸Çá›ÆË¦ = $cğÕÛà’â³[425]; goto dŸ¥—Œ¡ŒÈ; dŸ¥—Œ¡ŒÈ: $bé…•ƒïê¹ = $this->field($C¸Çá›ÆË¦)->_makeOrder()->where($d†éÀÅáÇé)->selectPage($EË„ˆÔ” Ú); $this->_listDataApply($bé…•ƒïê¹[$cğÕÛà’â³[367]]); $this->_listMake($bé…•ƒïê¹); goto eİ¿Š¦±£í; eİ¿Š¦±£í: return $bé…•ƒïê¹; goto b¢†‰ã’ª; b¢†‰ã’ª: } protected function _makeOrder() { goto B¥ÙˆÃ°İÌ; d·‹ó‚§ƒ¹: $a³Ø¼åŞ­² = array($EÏ¾ˆ‹§ô‘[429] => $EÏ¾ˆ‹§ô‘[430], $EÏ¾ˆ‹§ô‘[431] => $EÏ¾ˆ‹§ô‘[432]); $CùÂ¥Óõ = array($EÏ¾ˆ‹§ô‘[28] => $EÏ¾ˆ‹§ô‘[28], $EÏ¾ˆ‹§ô‘[78] => $EÏ¾ˆ‹§ô‘[78], $EÏ¾ˆ‹§ô‘[168] => $EÏ¾ˆ‹§ô‘[406], $EÏ¾ˆ‹§ô‘[433] => $EÏ¾ˆ‹§ô‘[433], $EÏ¾ˆ‹§ô‘[434] => $EÏ¾ˆ‹§ô‘[435], $EÏ¾ˆ‹§ô‘[194] => $EÏ¾ˆ‹§ô‘[194], $EÏ¾ˆ‹§ô‘[84] => $EÏ¾ˆ‹§ô‘[84]); $b¼½£ªÕô = Input::get($EÏ¾ˆ‹§ô‘[436], $EÏ¾ˆ‹§ô‘[7], $AŒñ÷ª´«, array_keys($CùÂ¥Óõ)); goto E‘÷ß¼á³í; e„§ƒÖ˜˜›: if ($b¼½£ªÕô == $EÏ¾ˆ‹§ô‘[28]) { } $BÍÜ˜îò» = $EÏ¾ˆ‹§ô‘[438] . $CùÂ¥Óõ[$b¼½£ªÕô] . $EÏ¾ˆ‹§ô‘[50] . $a³Ø¼åŞ­²[$aÒÕÕ´­Î]; return $this->order(rtrim(trim($BÍÜ˜îò»), $EÏ¾ˆ‹§ô‘[47])); goto d‡Ú¬ë”¥ƒ; B¥ÙˆÃ°İÌ: $EÏ¾ˆ‹§ô‘ =& $_SERVER[ªúæÂ¡­ä½]; $AŒñ÷ª´« = Model($EÏ¾ˆ‹§ô‘[426])->get($EÏ¾ˆ‹§ô‘[427]); $EšË·Üê² = Model($EÏ¾ˆ‹§ô‘[426])->get($EÏ¾ˆ‹§ô‘[428]); goto d·‹ó‚§ƒ¹; E‘÷ß¼á³í: $aÒÕÕ´­Î = Input::get($EÏ¾ˆ‹§ô‘[437], $EÏ¾ˆ‹§ô‘[7], $EšË·Üê², array_keys($a³Ø¼åŞ­²)); if (!in_array($b¼½£ªÕô, array_keys($CùÂ¥Óõ))) { $b¼½£ªÕô = $EÏ¾ˆ‹§ô‘[28]; } if (!in_array($aÒÕÕ´­Î, array_keys($a³Ø¼åŞ­²))) { $b¼½£ªÕô = $EÏ¾ˆ‹§ô‘[429]; } goto e„§ƒÖ˜˜›; d‡Ú¬ë”¥ƒ: } protected function _listDataApplyItem($DõÀ×åŸ¨Ü, $BöµÆÄŠÇ = false) { $Ağª²´ŸØ = array($DõÀ×åŸ¨Ü); $this->_listDataApply($Ağª²´ŸØ, $BöµÆÄŠÇ); return $Ağª²´ŸØ[0]; } protected function _listDataApply(&$bËã†ºŒ©à, $E¶İ’¿Ó± = false) { goto E¬³™Ö³®Ô; E¬³™Ö³®Ô: $b¤íŠ”¦Î‹ =& $_SERVER[ªúæÂ¡­ä½]; if (!$bËã†ºŒ©à) { $bËã†ºŒ©à = array(); return; } $aÅˆº’ƒİ = array_to_keyvalue($bËã†ºŒ©à, $b¤íŠ”¦Î‹[33], $b¤íŠ”¦Î‹[396]); goto Bãäğ¤§ªÁ; EËÍÚ†ÌŒë: $this->_listAppendPath($bËã†ºŒ©à); $this->_listAppendAuth($bËã†ºŒ©à); $this->_listAppendSourceInfo($bËã†ºŒ©à, $aÅˆº’ƒİ); goto E«‚è–æë; E«‚è–æë: $this->_listAppendUser($bËã†ºŒ©à); $this->_listFilterInfo($bËã†ºŒ©à, $E¶İ’¿Ó±); $this->_listAppendAuthSecret($bËã†ºŒ©à); goto b«¾öª¿™é; Bãäğ¤§ªÁ: $aÅˆº’ƒİ = array_unique($aÅˆº’ƒİ); $this->_listSourceCache($bËã†ºŒ©à); if (!$E¶İ’¿Ó±) { $this->_listAppendMeta($bËã†ºŒ©à, $aÅˆº’ƒİ); $this->_listAppendFileMeta($bËã†ºŒ©à, $aÅˆº’ƒİ); $this->_listAppendChildren($bËã†ºŒ©à, $aÅˆº’ƒİ); } goto EËÍÚ†ÌŒë; b«¾öª¿™é: } protected function _listSourceCache($f‚—‚Ä“«¶) { $aíÒ‹Ôö° =& $_SERVER[ªúæÂ¡­ä½]; foreach ($f‚—‚Ä“«¶ as $b–øßÜÚğ) { self::$cacheSourceInfo[$aíÒ‹Ôö°[439] . $b–øßÜÚğ[$aíÒ‹Ôö°[396]]] = $b–øßÜÚğ; } } protected function _listFilterInfo(&$D±…ò§»Ş, $e±‚‹İİ¥› = false) { $f®ÙÄ¦¨ =& $_SERVER[ªúæÂ¡­ä½]; foreach ($D±…ò§»Ş as &$A®‡‘»á®) { $A®‡‘»á® = $this->pathInfoFilter($A®‡‘»á®); self::$cachePathInfo[$f®ÙÄ¦¨[440] . intval($e±‚‹İİ¥›) . $f®ÙÄ¦¨[441] . $A®‡‘»á®[$f®ÙÄ¦¨[396]]] = $A®‡‘»á®; } unset($A®‡‘»á®); } protected function _listMake(&$aê‹¬óã­¥) { $c†Íƒ×ğ¾² =& $_SERVER[ªúæÂ¡­ä½]; $aê‹¬óã­¥[$c†Íƒ×ğ¾²[75]] = array(); $aê‹¬óã­¥[$c†Íƒ×ğ¾²[74]] = array(); foreach ($aê‹¬óã­¥[$c†Íƒ×ğ¾²[367]] as $d§¥¤¤¸) { $b³ÑÇÃš‚â = $d§¥¤¤¸[$c†Íƒ×ğ¾²[404]] == 1 ? $c†Íƒ×ğ¾²[75] : $c†Íƒ×ğ¾²[74]; $aê‹¬óã­¥[$b³ÑÇÃš‚â][] = $d§¥¤¤¸; } unset($aê‹¬óã­¥[$c†Íƒ×ğ¾²[367]]); } protected function _listAppendMeta(&$c´µĞ†, $F¼µ”ÙˆÃò) { goto BÜÔ‘ÉİŒ×; AŒÁâ¡×¹Ô: if (!$d„£¸ã·) { return; } $FÀ±‘Œ«Îƒ = array($a¶ğ³·¸ñ[444], $a¶ğ³·¸ñ[445]); $fÅ«Ú×¥± = array(); goto F‰ÅŒÖÖ¼; BÜÔ‘ÉİŒ×: $a¶ğ³·¸ñ =& $_SERVER[ªúæÂ¡­ä½]; $f‡Õ¬Í‚ = array($a¶ğ³·¸ñ[411] => array($a¶ğ³·¸ñ[412], $F¼µ”ÙˆÃò)); $d„£¸ã· = Model($a¶ğ³·¸ñ[442])->field($a¶ğ³·¸ñ[443])->where($f‡Õ¬Í‚)->select(); goto AŒÁâ¡×¹Ô; F‰ÅŒÖÖ¼: foreach ($d„£¸ã· as $d×‰’Í©Î™) { if (!isset($fÅ«Ú×¥±[$d×‰’Í©Î™[$a¶ğ³·¸ñ[396]]])) { $fÅ«Ú×¥±[$d×‰’Í©Î™[$a¶ğ³·¸ñ[396]]] = array(); } if (in_array($d×‰’Í©Î™[$a¶ğ³·¸ñ[93]], $FÀ±‘Œ«Îƒ)) { continue; } $fÅ«Ú×¥±[$d×‰’Í©Î™[$a¶ğ³·¸ñ[396]]][$d×‰’Í©Î™[$a¶ğ³·¸ñ[93]]] = $d×‰’Í©Î™[$a¶ğ³·¸ñ[372]]; } foreach ($c´µĞ† as &$A»˜Î´·á‡) { $A»˜Î´·á‡[$a¶ğ³·¸ñ[446]] = !1; if (isset($fÅ«Ú×¥±[$A»˜Î´·á‡[$a¶ğ³·¸ñ[396]]])) { $A»˜Î´·á‡[$a¶ğ³·¸ñ[446]] = $fÅ«Ú×¥±[$A»˜Î´·á‡[$a¶ğ³·¸ñ[396]]]; } if ($this->fileIsLock($A»˜Î´·á‡) && $A»˜Î´·á‡[$a¶ğ³·¸ñ[407]]) { $bî…§ß²ÂÂ = AuthModel::AUTH_EDIT | AuthModel::AUTH_REMOVE; $A»˜Î´·á‡[$a¶ğ³·¸ñ[407]][$a¶ğ³·¸ñ[408]] = AuthModel::authDisable($A»˜Î´·á‡[$a¶ğ³·¸ñ[407]][$a¶ğ³·¸ñ[408]], $bî…§ß²ÂÂ); $A»˜Î´·á‡[$a¶ğ³·¸ñ[407]][$a¶ğ³·¸ñ[447]][$a¶ğ³·¸ñ[407]] = $A»˜Î´·á‡[$a¶ğ³·¸ñ[407]][$a¶ğ³·¸ñ[408]]; } } unset($A»˜Î´·á‡); goto aƒ¨ŸÑï™Ñ; aƒ¨ŸÑï™Ñ: } protected function _listAppendFileMeta(&$cç“Ù»ª‘, $e —‚‹«Ù÷) { goto Bäï´»ê¶; cÑò·ª¡ô: if (!$c’Å„ØìÊÃ) { return; } $e½—›Ú—† = array($B ‘ÀÙË‰[449] => array($B ‘ÀÙË‰[412], $c’Å„ØìÊÃ)); $E‚©×¯‘æ = $B ‘ÀÙË‰[450]; goto aİÒÂ ©›İ; aİÒÂ ©›İ: $B½‡°¶‘„Ó = Model($B ‘ÀÙË‰[451])->field($E‚©×¯‘æ)->where($e½—›Ú—†)->select(); $B½‡°¶‘„Ó = array_to_keyvalue($B½‡°¶‘„Ó, $B ‘ÀÙË‰[448]); $b’Œ£•èğ… = Model($B ‘ÀÙË‰[452])->field($B ‘ÀÙË‰[453])->where($e½—›Ú—†)->select(); goto A×øä®Æ†á; A×øä®Æ†á: $b’Œ£•èğ… = $b’Œ£•èğ… ? $b’Œ£•èğ… : array(); $F²²Ç–Ú¿á = array(); foreach ($b’Œ£•èğ… as $e±šƒÒ‡·÷) { if (!isset($F²²Ç–Ú¿á[$e±šƒÒ‡·÷[$B ‘ÀÙË‰[448]]])) { $F²²Ç–Ú¿á[$e±šƒÒ‡·÷[$B ‘ÀÙË‰[448]]] = array(); } $F²²Ç–Ú¿á[$e±šƒÒ‡·÷[$B ‘ÀÙË‰[448]]][$e±šƒÒ‡·÷[$B ‘ÀÙË‰[93]]] = $e±šƒÒ‡·÷[$B ‘ÀÙË‰[372]]; } goto C¦¿ÙÑ´¹š; C¦¿ÙÑ´¹š: foreach ($cç“Ù»ª‘ as &$f…Œ‰¼íô”) { goto AÓŸâùÉÂš; AÓŸâùÉÂš: $aŞÁ¿ôÄŒÈ = $f…Œ‰¼íô”[$B ‘ÀÙË‰[448]]; if (!$aŞÁ¿ôÄŒÈ || !is_array($B½‡°¶‘„Ó[$aŞÁ¿ôÄŒÈ])) { continue; } $fÑİíàÃÖµ = $B½‡°¶‘„Ó[$aŞÁ¿ôÄŒÈ]; goto aÑ¹Ã»İÈ¼; aÑ¹Ã»İÈ¼: $fÑİíàÃÖµ[$B ‘ÀÙË‰[78]] = $f…Œ‰¼íô”[$B ‘ÀÙË‰[78]]; $fÑİíàÃÖµ[$B ‘ÀÙË‰[28]] = $f…Œ‰¼íô”[$B ‘ÀÙË‰[28]]; if (!isset(self::$cacheFileInfo[$B ‘ÀÙË‰[454] . $aŞÁ¿ôÄŒÈ])) { self::$cacheFileInfo[$B ‘ÀÙË‰[454] . $aŞÁ¿ôÄŒÈ] = array_merge(array(), $fÑİíàÃÖµ); } goto aÕŸóöõµõ; aÕŸóöõµõ: unset($B½‡°¶‘„Ó[$aŞÁ¿ôÄŒÈ][$B ‘ÀÙË‰[76]]); $f¶—‰—¬†½ = is_array($F²²Ç–Ú¿á[$aŞÁ¿ôÄŒÈ]) ? $F²²Ç–Ú¿á[$aŞÁ¿ôÄŒÈ] : array(); $f…Œ‰¼íô”[$B ‘ÀÙË‰[164]] = array_merge($f¶—‰—¬†½, $B½‡°¶‘„Ó[$aŞÁ¿ôÄŒÈ]); goto A½©Ûñá‹•; A½©Ûñá‹•: if (isset($f…Œ‰¼íô”[$B ‘ÀÙË‰[164]][$B ‘ÀÙË‰[163]])) { $f…Œ‰¼íô”[$B ‘ÀÙË‰[163]] = json_decode($f…Œ‰¼íô”[$B ‘ÀÙË‰[164]][$B ‘ÀÙË‰[163]], !0); unset($f…Œ‰¼íô”[$B ‘ÀÙË‰[164]][$B ‘ÀÙË‰[163]]); } goto C§£¼Œä³š; C§£¼Œä³š: } unset($f…Œ‰¼íô”); goto D‰‰ŒØ²…Ş; Bäï´»ê¶: $B ‘ÀÙË‰ =& $_SERVER[ªúæÂ¡­ä½]; $c’Å„ØìÊÃ = array_to_keyvalue($cç“Ù»ª‘, $B ‘ÀÙË‰[33], $B ‘ÀÙË‰[448]); $c’Å„ØìÊÃ = array_filter(array_unique($c’Å„ØìÊÃ)); goto cÑò·ª¡ô; D‰‰ŒØ²…Ş: } protected function _listAppendSourceInfo(&$dã×Å—¦Ğœ, $Bê˜ÕÄâ‹) { goto E¿¿ŒÀª«; C¬í£õÑ’„: $Eª…ÑòïŠ = Model($Dğ¼Ë”Å·[419])->listData(); $A“¹ÑíÂö² = Model($Dğ¼Ë”Å·[409])->listData(); $b°Ü÷‹®ø = Model($Dğ¼Ë”Å·[457])->listSimple(); goto bÕ‰íõ‚æ©; cŸçÃÊùø: $E°‡£ÚÉ‰ = array_to_keyvalue_group($b°Ü÷‹®ø, $Dğ¼Ë”Å·[396]); foreach ($dã×Å—¦Ğœ as &$B¼Œ«öÈôİ) { $B¼Œ«öÈôİ[$Dğ¼Ë”Å·[85]] = array($Dğ¼Ë”Å·[458] => 0, $Dğ¼Ë”Å·[459] => 0, $Dğ¼Ë”Å·[460] => 0); if (isset($B½«²Å´ÛÆ[$B¼Œ«öÈôİ[$Dğ¼Ë”Å·[396]]])) { $B¼Œ«öÈôİ[$Dğ¼Ë”Å·[85]][$Dğ¼Ë”Å·[461]] = 1; $B¼Œ«öÈôİ[$Dğ¼Ë”Å·[85]][$Dğ¼Ë”Å·[462]] = $B½«²Å´ÛÆ[$B¼Œ«öÈôİ[$Dğ¼Ë”Å·[396]]][$Dğ¼Ë”Å·[28]]; } if (isset($D“ƒÑÃˆÌİ[$B¼Œ«öÈôİ[$Dğ¼Ë”Å·[396]]])) { $B¼Œ«öÈôİ[$Dğ¼Ë”Å·[85]][$Dğ¼Ë”Å·[463]] = array(); foreach ($D“ƒÑÃˆÌİ[$B¼Œ«öÈôİ[$Dğ¼Ë”Å·[396]]] as $DËªŠ‚àÔ) { $eê‡ãŞ¦¯ = $b•¾–¬ô±±[$DËªŠ‚àÔ]; $B¼Œ«öÈôİ[$Dğ¼Ë”Å·[85]][$Dğ¼Ë”Å·[463]][] = array($Dğ¼Ë”Å·[464] => $eê‡ãŞ¦¯[$Dğ¼Ë”Å·[394]], $Dğ¼Ë”Å·[414] => $eê‡ãŞ¦¯[$Dğ¼Ë”Å·[28]], $Dğ¼Ë”Å·[465] => $eê‡ãŞ¦¯[$Dğ¼Ë”Å·[466]]); } } if (isset($E°‡£ÚÉ‰[$B¼Œ«öÈôİ[$Dğ¼Ë”Å·[396]]])) { $B¼Œ«öÈôİ[$Dğ¼Ë”Å·[85]][$Dğ¼Ë”Å·[467]] = array(); foreach ($E°‡£ÚÉ‰[$B¼Œ«öÈôİ[$Dğ¼Ë”Å·[396]]] as $föâ…Ö¨Ê) { $B¼Œ«öÈôİ[$Dğ¼Ë”Å·[85]][$Dğ¼Ë”Å·[467]] = array($Dğ¼Ë”Å·[468] => $föâ…Ö¨Ê[$Dğ¼Ë”Å·[469]], $Dğ¼Ë”Å·[470] => $föâ…Ö¨Ê[$Dğ¼Ë”Å·[471]], $Dğ¼Ë”Å·[472] => $föâ…Ö¨Ê[$Dğ¼Ë”Å·[396]], $Dğ¼Ë”Å·[473] => $föâ…Ö¨Ê[$Dğ¼Ë”Å·[474]], $Dğ¼Ë”Å·[475] => $föâ…Ö¨Ê[$Dğ¼Ë”Å·[476]], $Dğ¼Ë”Å·[477] => $föâ…Ö¨Ê[$Dğ¼Ë”Å·[477]], $Dğ¼Ë”Å·[478] => $föâ…Ö¨Ê[$Dğ¼Ë”Å·[478]]); } } } unset($B¼Œ«öÈôİ); goto D³Ó¥Èê½†; bÕ‰íõ‚æ©: $b•¾–¬ô±± = array_to_keyvalue($c½¾–¬Ë±, $Dğ¼Ë”Å·[394]); $D“ƒÑÃˆÌİ = array_to_keyvalue_group($Eª…ÑòïŠ, $Dğ¼Ë”Å·[76], $Dğ¼Ë”Å·[420]); $B½«²Å´ÛÆ = array_to_keyvalue($A“¹ÑíÂö², $Dğ¼Ë”Å·[76]); goto cŸçÃÊùø; E¿¿ŒÀª«: $Dğ¼Ë”Å· =& $_SERVER[ªúæÂ¡­ä½]; if (!defined($Dğ¼Ë”Å·[455])) { return; } $c½¾–¬Ë± = Model($Dğ¼Ë”Å·[456])->listData(); goto C¬í£õÑ’„; D³Ó¥Èê½†: return $dã×Å—¦Ğœ; goto D¢Á®µ£©Õ; D¢Á®µ£©Õ: } protected function _listAppendChildren(&$eëŒ¹Ùé¾®, $Aô‚³ì‘Ş) { goto eÎäŸğÊ; eáïÊÌÌÙ: foreach ($eëŒ¹Ùé¾® as &$e£Õğ×›½¼) { if (!$e£Õğ×›½¼[$d¥‡ù­£á[404]]) { continue; } $D·ÅÁºå‰[] = $e£Õğ×›½¼[$d¥‡ù­£á[396]]; } unset($e£Õğ×›½¼); if (!$D·ÅÁºå‰) { return; } goto e‰Ú®à‚³î; e‰Ú®à‚³î: $aÍ—¯çÍ¦ñ = array($d¥‡ù­£á[479] => array($d¥‡ù­£á[7], $D·ÅÁºå‰)); $cºõ¯èöÓŒ = array($d¥‡ù­£á[479], $d¥‡ù­£á[404], $d¥‡ù­£á[480] => $d¥‡ù­£á[481]); $fÇé¨‚Ô„ = $this->field($cºõ¯èöÓŒ)->where($aÍ—¯çÍ¦ñ)->group($d¥‡ù­£á[482])->select(); goto a¯êõÂŒñÅ; a¯êõÂŒñÅ: $Açîà¼ ¯ã = array(); foreach ($fÇé¨‚Ô„ as $F……¨ö“İ™) { $a¥‹ã‚‹÷Ì = $F……¨ö“İ™[$d¥‡ù­£á[479]]; $c°¦Ä = $F……¨ö“İ™[$d¥‡ù­£á[404]] == $d¥‡ù­£á[87] ? $d¥‡ù­£á[204] : $d¥‡ù­£á[203]; if (!isset($Açîà¼ ¯ã[$a¥‹ã‚‹÷Ì])) { $Açîà¼ ¯ã[$a¥‹ã‚‹÷Ì] = array($d¥‡ù­£á[203] => 0, $d¥‡ù­£á[204] => 0); } $Açîà¼ ¯ã[$a¥‹ã‚‹÷Ì][$c°¦Ä] += $F……¨ö“İ™[$d¥‡ù­£á[481]]; } foreach ($eëŒ¹Ùé¾® as &$e£Õğ×›½¼) { if (!$e£Õğ×›½¼[$d¥‡ù­£á[404]]) { continue; } $Bâ¿ë”‡é = is_array($Açîà¼ ¯ã[$e£Õğ×›½¼[$d¥‡ù­£á[396]]]) ? $Açîà¼ ¯ã[$e£Õğ×›½¼[$d¥‡ù­£á[396]]] : $fÏ–×»ŸÕ’; $e£Õğ×›½¼[$d¥‡ù­£á[204]] = $Bâ¿ë”‡é[$d¥‡ù­£á[204]]; $e£Õğ×›½¼[$d¥‡ù­£á[203]] = $Bâ¿ë”‡é[$d¥‡ù­£á[203]]; unset($e£Õğ×›½¼[$d¥‡ù­£á[406]]); } goto FªÎéáŒÅö; FªÎéáŒÅö: unset($e£Õğ×›½¼); goto e…©ÑíÅ¬; eÎäŸğÊ: $d¥‡ù­£á =& $_SERVER[ªúæÂ¡­ä½]; $D·ÅÁºå‰ = array(); $fÏ–×»ŸÕ’ = array($d¥‡ù­£á[203] => 0, $d¥‡ù­£á[204] => 0); goto eáïÊÌÌÙ; e…©ÑíÅ¬: } protected function _listAppendAuth(&$c‚‡¶–‡Š½) { goto bŒ¯»ĞùÇè; bŒ¯»ĞùÇè: $cÏœåˆí×Ä =& $_SERVER[ªúæÂ¡­ä½]; if (!defined($cÏœåˆí×Ä[455])) { return; } $b‹¼­ƒìØ‘ = array(); goto fá‚Üè½ïÓ; dŠ‡ ¥ÃÃƒ: $d™†Ø–êæ = Model($cÏœåˆí×Ä[483])->getSourceList($b‹¼­ƒìØ‘, $AÏˆ¾ù¥); foreach ($c‚‡¶–‡Š½ as $dÑÈ¶ºƒÁ => &$Bè«Ë¤†Ä½) { $Bè«Ë¤†Ä½[$cÏœåˆí×Ä[407]] = $d™†Ø–êæ[$Bè«Ë¤†Ä½[$cÏœåˆí×Ä[396]]]; if (!$Bè«Ë¤†Ä½[$cÏœåˆí×Ä[407]] && $Bè«Ë¤†Ä½[$cÏœåˆí×Ä[405]] == self::TYPE_GROUP) { $Bè«Ë¤†Ä½[$cÏœåˆí×Ä[407]] = Action($cÏœåˆí×Ä[484])->pathGroupAuthMake($Bè«Ë¤†Ä½[$cÏœåˆí×Ä[485]]); if (!$Bè«Ë¤†Ä½[$cÏœåˆí×Ä[407]] && !_get($GLOBALS, $cÏœåˆí×Ä[486])) { $Bè«Ë¤†Ä½[$cÏœåˆí×Ä[196]] = !1; $Bè«Ë¤†Ä½[$cÏœåˆí×Ä[195]] = !1; } } if ($Bè«Ë¤†Ä½[$cÏœåˆí×Ä[407]]) { $Bè«Ë¤†Ä½[$cÏœåˆí×Ä[196]] = AuthModel::authCheckEdit($Bè«Ë¤†Ä½[$cÏœåˆí×Ä[407]][$cÏœåˆí×Ä[408]]); $Bè«Ë¤†Ä½[$cÏœåˆí×Ä[195]] = AuthModel::authCheckView($Bè«Ë¤†Ä½[$cÏœåˆí×Ä[407]][$cÏœåˆí×Ä[408]]); } $this->groupPathDisplay($Bè«Ë¤†Ä½); } unset($Bè«Ë¤†Ä½); goto f Œ´Ğ® †; fá‚Üè½ïÓ: foreach ($c‚‡¶–‡Š½ as $Bè«Ë¤†Ä½) { if ($Bè«Ë¤†Ä½[$cÏœåˆí×Ä[405]] == self::TYPE_GROUP) { $b‹¼­ƒìØ‘[] = $Bè«Ë¤†Ä½[$cÏœåˆí×Ä[396]]; } } if (!$b‹¼­ƒìØ‘) { return; } $AÏˆ¾ù¥ = array_to_keyvalue($c‚‡¶–‡Š½, $cÏœåˆí×Ä[396]); goto dŠ‡ ¥ÃÃƒ; f Œ´Ğ® †: } public function _listAppendAuthSecret(&$D­“ÅªÕœ) { goto aß²©î©ˆÕ; FŒéç¤±¤: if (!$Eµ‘¯Ë•°£) { goto FÜÒ¾áÀ¾†; E†Ê­…“÷Ì: foreach ($Eµ‘¯Ë•°£ as $C‹“¸Òê² => $Eã„çŒè†Ã) { goto bòÀ¡µç¾²; d£§Û‰ˆ¢Ú: if (!$F˜¾ïá¤èÙ) { $b‰¾Ø”¸Š’->remove($Eã„çŒè†Ã[$AÅ”»èù‚ [394]]); unset($Eµ‘¯Ë•°£[$C‹“¸Òê²]); continue; } $Eã„çŒè†Ã[$AÅ”»èù‚ [407]] = $F˜¾ïá¤èÙ; $Eã„çŒè†Ã[$AÅ”»èù‚ [493]] = $c¾òÕµ‰ï£; goto D¨³ÓÓç’; D¨³ÓÓç’: $Eã„çŒè†Ã[$AÅ”»èù‚ [494]] = Model($AÅ”»èù‚ [495])->getInfoSimpleOuter($Eã„çŒè†Ã[$AÅ”»èù‚ [433]]); $Eµ‘¯Ë•°£[$C‹“¸Òê²] = $Eã„çŒè†Ã; goto Fä—ÜŒš¥†; bòÀ¡µç¾²: $c¾òÕµ‰ï£ = $Dá­–ï“ö[$Eã„çŒè†Ã[$AÅ”»èù‚ [492]]]; if (!$c¾òÕµ‰ï£) { $b‰¾Ø”¸Š’->remove($Eã„çŒè†Ã[$AÅ”»èù‚ [394]]); unset($Eµ‘¯Ë•°£[$C‹“¸Òê²]); continue; } $F˜¾ïá¤èÙ = $eˆñµÚÏä->listData($c¾òÕµ‰ï£[$AÅ”»èù‚ [407]]); goto d£§Û‰ˆ¢Ú; Fä—ÜŒš¥†: } goto bî›‘âˆ§; A¶¸Ô¸†Ç‹: $Eµ‘¯Ë•°£ = array_to_keyvalue($Eµ‘¯Ë•°£, $AÅ”»èù‚ [396]); $Dá­–ï“ö = json_decode(Model($AÅ”»èù‚ [487])->get($AÅ”»èù‚ [491]), !0); $Dá­–ï“ö = array_to_keyvalue($Dá­–ï“ö, $AÅ”»èù‚ [394]); goto E†Ê­…“÷Ì; FÜÒ¾áÀ¾†: $eˆñµÚÏä = Model($AÅ”»èù‚ [489]); $b‰¾Ø”¸Š’ = Model($AÅ”»èù‚ [490]); $Eµ‘¯Ë•°£ = $b‰¾Ø”¸Š’->listData(); goto A¶¸Ô¸†Ç‹; bî›‘âˆ§: } $eÕâÑÑˆ© = defined($AÅ”»èù‚ [496]) ? USER_ID : $AÅ”»èù‚ [33]; $F‰åÑ‹˜ = array(); goto A÷¶Îß±Ò§; aß²©î©ˆÕ: $AÅ”»èù‚  =& $_SERVER[ªúæÂ¡­ä½]; if (Model($AÅ”»èù‚ [487])->get($AÅ”»èù‚ [488]) != $AÅ”»èù‚ [87]) { return; } static $Eµ‘¯Ë•°£ = false; goto FŒéç¤±¤; A÷¶Îß±Ò§: $A÷õ¡ñÙ‘ = $this->_listAppendPath($F‰åÑ‹˜, !0); foreach ($D­“ÅªÕœ as $C‹“¸Òê² => &$Eã„çŒè†Ã) { if (!is_array($Eã„çŒè†Ã[$AÅ”»èù‚ [407]])) { continue; } if ($Eã„çŒè†Ã[$AÅ”»èù‚ [405]] != $AÅ”»èù‚ [497]) { continue; } if (isset($Eµ‘¯Ë•°£[$Eã„çŒè†Ã[$AÅ”»èù‚ [396]]])) { goto DÂÀ¾ˆ¦†Ü; DÂÀ¾ˆ¦†Ü: $B“®ˆÑ¢™Ò = $Eµ‘¯Ë•°£[$Eã„çŒè†Ã[$AÅ”»èù‚ [396]]]; if (!is_array($Eã„çŒè†Ã[$AÅ”»èù‚ [446]])) { $Eã„çŒè†Ã[$AÅ”»èù‚ [446]] = array(); } $Eã„çŒè†Ã[$AÅ”»èù‚ [446]][$AÅ”»èù‚ [498]] = $B“®ˆÑ¢™Ò[$AÅ”»èù‚ [492]]; goto E‰Éœ¤òå; E‰Éœ¤òå: $Eã„çŒè†Ã[$AÅ”»èù‚ [407]][$AÅ”»èù‚ [499]] = $B“®ˆÑ¢™Ò; $Eã„çŒè†Ã[$AÅ”»èù‚ [407]][$AÅ”»èù‚ [500]] = $Eã„çŒè†Ã[$AÅ”»èù‚ [501]]; $Eã„çŒè†Ã[$AÅ”»èù‚ [407]][$AÅ”»èù‚ [502]] = $AÅ”»èù‚ [87]; goto aß¼Ø²ÈÓ×; aß¼Ø²ÈÓ×: if ($B“®ˆÑ¢™Ò[$AÅ”»èù‚ [433]] != $eÕâÑÑˆ©) { $Eã„çŒè†Ã[$AÅ”»èù‚ [407]][$AÅ”»èù‚ [408]] = $Eã„çŒè†Ã[$AÅ”»èù‚ [407]][$AÅ”»èù‚ [408]] & $B“®ˆÑ¢™Ò[$AÅ”»èù‚ [407]][$AÅ”»èù‚ [407]]; } continue; goto e†¨ë‚°®õ; e†¨ë‚°®õ: } $cß‹†…Ğ¢î = $this->parentLevelArray($Eã„çŒè†Ã[$AÅ”»èù‚ [503]]); $Eİ’ëéÀ† = array_reverse($cß‹†…Ğ¢î); foreach ($Eİ’ëéÀ† as $bŠáâ¦‰ŒŠ => $D‘¨İÔš«) { goto cöÈÛ¨³Ì; DµÂ² ·: if ($B“®ˆÑ¢™Ò[$AÅ”»èù‚ [433]] != $eÕâÑÑˆ©) { $Eã„çŒè†Ã[$AÅ”»èù‚ [407]][$AÅ”»èù‚ [408]] = $Eã„çŒè†Ã[$AÅ”»èù‚ [407]][$AÅ”»èù‚ [408]] & $B“®ˆÑ¢™Ò[$AÅ”»èù‚ [407]][$AÅ”»èù‚ [407]]; } $fçË´Ú‹ = $AÅ”»èù‚ [33]; $A£Ò „çæÅ = count($cß‹†…Ğ¢î) - $bŠáâ¦‰ŒŠ; goto A…Ú¾¸ù°…; cöÈÛ¨³Ì: if (!isset($Eµ‘¯Ë•°£[$D‘¨İÔš«])) { continue; } $B“®ˆÑ¢™Ò = $Eµ‘¯Ë•°£[$D‘¨İÔš«]; $Eã„çŒè†Ã[$AÅ”»èù‚ [407]][$AÅ”»èù‚ [499]] = $B“®ˆÑ¢™Ò; goto DµÂ² ·; A…Ú¾¸ù°…: for ($B®Öã•òøá = 0; $B®Öã•òøá < $A£Ò „çæÅ; $B®Öã•òøá++) { if (!isset($A÷õ¡ñÙ‘[$cß‹†…Ğ¢î[$B®Öã•òøá]])) { $fçË´Ú‹ = $AÅ”»èù‚ [33]; break; } $fçË´Ú‹ = $fçË´Ú‹ . rtrim($A÷õ¡ñÙ‘[$cß‹†…Ğ¢î[$B®Öã•òøá]], $AÅ”»èù‚ [8]) . $AÅ”»èù‚ [8]; } $Eã„çŒè†Ã[$AÅ”»èù‚ [407]][$AÅ”»èù‚ [500]] = rtrim($fçË´Ú‹, $AÅ”»èù‚ [8]) . $AÅ”»èù‚ [8]; break; goto e¯¦Ì’áæ; e¯¦Ì’áæ: } } unset($Eã„çŒè†Ã); goto E‘ê³¾·‚Ú; E‘ê³¾·‚Ú: } public function groupPathDisplay(&$f‹¾ „ìÖ) { goto bº’«ñÖ¼; cºäÓš†ç¤: $f‹¾ „ìÖ[$A‹Êêö¡º[509]] = $D°ó¥Å÷Ğª . $aØ¤×·®„[$A‹Êêö¡º[85]][$A‹Êêö¡º[396]]; goto DÜï¹£˜©‡; Còç‚åÊåÃ: $f‹¾ „ìÖ[$A‹Êêö¡º[505]] = $aØ¤×·®„[$A‹Êêö¡º[479]]; $f‹¾ „ìÖ[$A‹Êêö¡º[506]] = $aØ¤×·®„[$A‹Êêö¡º[503]]; $f‹¾ „ìÖ[$A‹Êêö¡º[507]] = $aØ¤×·®„[$A‹Êêö¡º[508]]; goto cºäÓš†ç¤; bº’«ñÖ¼: $A‹Êêö¡º =& $_SERVER[ªúæÂ¡­ä½]; if ($f‹¾ „ìÖ[$A‹Êêö¡º[405]] != self::TYPE_GROUP) { return; } $aØ¤×·®„ = Model($A‹Êêö¡º[504])->getInfo($f‹¾ „ìÖ[$A‹Êêö¡º[485]]); goto e’„¦µ¢¶; e’„¦µ¢¶: $cªæËêù± = $this->parentLevelArray($aØ¤×·®„[$A‹Êêö¡º[503]]); $D°ó¥Å÷Ğª = $A‹Êêö¡º[33]; foreach ($cªæËêù± as $B‘ÇÄõ¸‰¯) { $b³À¡·ªŠİ = Model($A‹Êêö¡º[504])->getInfo($B‘ÇÄõ¸‰¯); $D°ó¥Å÷Ğª .= $b³À¡·ªŠİ[$A‹Êêö¡º[85]][$A‹Êêö¡º[396]] . $A‹Êêö¡º[47]; } goto Còç‚åÊåÃ; DÜï¹£˜©‡: } protected function _listAppendPath(&$Cè´‹§“‚°, $A“Ôé¢™†× = false) { goto aèÛÂÃÁ†; f”›é Šø: $fÂœËî¸ª„ = array(); if ($A“Ôé¢™†×) { return $e±ñ±¢Ğ; } foreach ($Cè´‹§“‚° as &$b‚´ÄŸ³îœ) { goto d¢‰¶ƒÓ…; d¢‰¶ƒÓ…: $B‚Œ‚Ïª¿Ğ = $b‚´ÄŸ³îœ[$Bæ¯Ô×ï¤Ñ[396]]; if ($b‚´ÄŸ³îœ[$Bæ¯Ô×ï¤Ñ[404]] == $Bæ¯Ô×ï¤Ñ[87] && $b‚´ÄŸ³îœ[$Bæ¯Ô×ï¤Ñ[479]] != 0) { $e±ñ±¢Ğ[$B‚Œ‚Ïª¿Ğ] = $b‚´ÄŸ³îœ[$Bæ¯Ô×ï¤Ñ[28]]; } if ($b‚´ÄŸ³îœ[$Bæ¯Ô×ï¤Ñ[404]] == $Bæ¯Ô×ï¤Ñ[87] && $b‚´ÄŸ³îœ[$Bæ¯Ô×ï¤Ñ[479]] == 0 && !isset($e±ñ±¢Ğ[$B‚Œ‚Ïª¿Ğ])) { $e±ñ±¢Ğ[$B‚Œ‚Ïª¿Ğ] = $this->_listAppendPathRoot($b‚´ÄŸ³îœ, array()); } goto fÇØÚ‰é‚¡; b±¡¦ùã : foreach ($AÊ£ì¢¬¤ø as $b…ÉÎùóŞ => $f©ß¨Ï˜¯Ë) { if (isset($e±ñ±¢Ğ[$f©ß¨Ï˜¯Ë])) { continue; } if ($b…ÉÎùóŞ == 0) { $e±ñ±¢Ğ[$f©ß¨Ï˜¯Ë] = $this->_listAppendPathRoot($b‚´ÄŸ³îœ, $AÊ£ì¢¬¤ø); } if ($b…ÉÎùóŞ != 0) { $cš· ‚¨Îø[] = $f©ß¨Ï˜¯Ë; } } goto A‚•‡™‹»ø; fÇØÚ‰é‚¡: if (isset($fÂœËî¸ª„[$b‚´ÄŸ³îœ[$Bæ¯Ô×ï¤Ñ[503]]])) { continue; } $fÂœËî¸ª„[$b‚´ÄŸ³îœ[$Bæ¯Ô×ï¤Ñ[503]]] = !0; $AÊ£ì¢¬¤ø = $this->parentLevelArray($b‚´ÄŸ³îœ[$Bæ¯Ô×ï¤Ñ[503]]); goto b±¡¦ùã ; A‚•‡™‹»ø: } goto Aó„©‹ÏÃÛ; Aó„©‹ÏÃÛ: unset($b‚´ÄŸ³îœ); $cš· ‚¨Îø = array_unique($cš· ‚¨Îø); if (count($cš· ‚¨Îø) > 0) { $F”‘¦¥”Ñ = array($Bæ¯Ô×ï¤Ñ[411] => array($Bæ¯Ô×ï¤Ñ[412], $cš· ‚¨Îø)); if (count($cš· ‚¨Îø) == 1) { $fÄ‰‘äŒÕ = $this->sourceInfo($cš· ‚¨Îø[0]); $fß„­Ëö = is_array($fÄ‰‘äŒÕ) ? array($fÄ‰‘äŒÕ) : !1; } else { $fß„­Ëö = $this->field($Bæ¯Ô×ï¤Ñ[510])->where($F”‘¦¥”Ñ)->select(); } if (!$fß„­Ëö) { $fß„­Ëö = array(); } foreach ($fß„­Ëö as $a”ÍŠÌÅœĞ) { $e±ñ±¢Ğ[$a”ÍŠÌÅœĞ[$Bæ¯Ô×ï¤Ñ[396]]] = $a”ÍŠÌÅœĞ[$Bæ¯Ô×ï¤Ñ[28]]; } } goto EÇ¦ãØö›; cÊÕÛ‰—ßô: unset($b‚´ÄŸ³îœ); return $Cè´‹§“‚°; goto cïæë­‰Íõ; aèÛÂÃÁ†: $Bæ¯Ô×ï¤Ñ =& $_SERVER[ªúæÂ¡­ä½]; static $e±ñ±¢Ğ = array(); $cš· ‚¨Îø = array(); goto f”›é Šø; EÇ¦ãØö›: $Fç“Ö¾ß¢ = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); $aÇ»›ï¾Õ— = array(); foreach ($Cè´‹§“‚° as &$b‚´ÄŸ³îœ) { goto cÈ‰ä½ÄÉ­; e‚¼°–Ü°Õ: $b‹’ë™……ä .= $b‚´ÄŸ³îœ[$Bæ¯Ô×ï¤Ñ[28]]; if ($b‚´ÄŸ³îœ[$Bæ¯Ô×ï¤Ñ[404]] == $Bæ¯Ô×ï¤Ñ[87]) { $b‹’ë™……ä .= $Bæ¯Ô×ï¤Ñ[8]; } $b‚´ÄŸ³îœ[$Bæ¯Ô×ï¤Ñ[501]] = str_replace($Bæ¯Ô×ï¤Ñ[511], $Bæ¯Ô×ï¤Ñ[8], $b‹’ë™……ä); goto e¦ì–îÊí”; cÈ‰ä½ÄÉ­: $BöÑáÍ = $b‚´ÄŸ³îœ[$Bæ¯Ô×ï¤Ñ[503]]; $b‹’ë™……ä = $Bæ¯Ô×ï¤Ñ[33]; if (isset($aÇ»›ï¾Õ—[$BöÑáÍ])) { $b‹’ë™……ä = $aÇ»›ï¾Õ—[$BöÑáÍ]; } else { $AÊ£ì¢¬¤ø = $this->parentLevelArray($b‚´ÄŸ³îœ[$Bæ¯Ô×ï¤Ñ[503]]); foreach ($AÊ£ì¢¬¤ø as $b…ÉÎùóŞ => $f©ß¨Ï˜¯Ë) { if (isset($e±ñ±¢Ğ[$f©ß¨Ï˜¯Ë])) { $b‹’ë™……ä .= $e±ñ±¢Ğ[$f©ß¨Ï˜¯Ë] . $Bæ¯Ô×ï¤Ñ[8]; } } $aÇ»›ï¾Õ—[$BöÑáÍ] = $b‹’ë™……ä; } goto e‚¼°–Ü°Õ; e¦ì–îÊí”: if ($b‚´ÄŸ³îœ[$Bæ¯Ô×ï¤Ñ[479]] == $Bæ¯Ô×ï¤Ñ[191]) { $b‚´ÄŸ³îœ[$Bæ¯Ô×ï¤Ñ[28]] = trim($e±ñ±¢Ğ[$b‚´ÄŸ³îœ[$Bæ¯Ô×ï¤Ñ[396]]], $Bæ¯Ô×ï¤Ñ[8]); } if (intval($b‚´ÄŸ³îœ[$Bæ¯Ô×ï¤Ñ[405]]) == self::TYPE_SYSTEM) { $this->_listAppendPathRecycle($b‚´ÄŸ³îœ, $AÊ£ì¢¬¤ø, $Fç“Ö¾ß¢); } goto f”´ˆÍŒÔ»; f”´ˆÍŒÔ»: } goto cÊÕÛ‰—ßô; cïæë­‰Íõ: } private function _listAppendPathRecycle(&$BĞ«Â—Ùø, $D§Î¶ƒ†ø, $fÕ—àŠ³Òƒ) { goto fá˜ÉÜß“Ö; AÆñ‹Ñ‘æˆ: if ($BĞ«Â—Ùø[$DºÌÌÍØÈø[396]] == $fÕ—àŠ³Òƒ) { $BĞ«Â—Ùø[$DºÌÌÍØÈø[503]] = $DºÌÌÍØÈø[513]; $BĞ«Â—Ùø[$DºÌÌÍØÈø[479]] = $DºÌÌÍØÈø[191]; $BĞ«Â—Ùø[$DºÌÌÍØÈø[28]] = LNG($DºÌÌÍØÈø[512]); } $BĞ«Â—Ùø[$DºÌÌÍØÈø[514]] = $DºÌÌÍØÈø[515]; goto CèÏ°‡‡”; e©Ù“ÌØö: $eõĞî¥‹¾à = implode($DºÌÌÍØÈø[8], array_slice($dØò¡›êÕ, 2)); $BĞ«Â—Ùø[$DºÌÌÍØÈø[501]] = $DºÌÌÍØÈø[8] . LNG($DºÌÌÍØÈø[512]) . $DºÌÌÍØÈø[8] . ltrim($eõĞî¥‹¾à, $DºÌÌÍØÈø[8]); $BĞ«Â—Ùø[$DºÌÌÍØÈø[503]] = $DºÌÌÍØÈø[513] . implode($DºÌÌÍØÈø[47], array_slice($D§Î¶ƒ†ø, 1)) . $DºÌÌÍØÈø[47]; goto AÆñ‹Ñ‘æˆ; fá˜ÉÜß“Ö: $DºÌÌÍØÈø =& $_SERVER[ªúæÂ¡­ä½]; if (!in_array($fÕ—àŠ³Òƒ, $D§Î¶ƒ†ø) && $BĞ«Â—Ùø[$DºÌÌÍØÈø[396]] != $fÕ—àŠ³Òƒ) { return; } $dØò¡›êÕ = explode($DºÌÌÍØÈø[8], trim($BĞ«Â—Ùø[$DºÌÌÍØÈø[501]], $DºÌÌÍØÈø[8])); goto e©Ù“ÌØö; CèÏ°‡‡”: } protected function _listAppendPathRoot(&$CÍâÛØŸÒ¿, $B¯³äí’Ø±) { $b³ß÷Ï²òÅ =& $_SERVER[ªúæÂ¡­ä½]; $b¹çŸã¦“ö = $b³ß÷Ï²òÅ[33]; if ($CÍâÛØŸÒ¿[$b³ß÷Ï²òÅ[405]] == self::TYPE_USER) { if (defined($b³ß÷Ï²òÅ[455]) && $CÍâÛØŸÒ¿[$b³ß÷Ï²òÅ[485]] == USER_ID) { $b¹çŸã¦“ö = LNG($b³ß÷Ï²òÅ[516]); if (!$B¯³äí’Ø±) { $CÍâÛØŸÒ¿[$b³ß÷Ï²òÅ[28]] = $b¹çŸã¦“ö; } } else { $BÂ©·–®äõ = Model($b³ß÷Ï²òÅ[495])->getInfoSimple($CÍâÛØŸÒ¿[$b³ß÷Ï²òÅ[485]]); $b¹çŸã¦“ö = LNG($b³ß÷Ï²òÅ[517]) . $b³ß÷Ï²òÅ[160] . $BÂ©·–®äõ[$b³ß÷Ï²òÅ[28]] . $b³ß÷Ï²òÅ[518]; } } else { if ($CÍâÛØŸÒ¿[$b³ß÷Ï²òÅ[405]] == self::TYPE_GROUP) { $BÂ©·–®äõ = Model($b³ß÷Ï²òÅ[504])->getInfoSimple($CÍâÛØŸÒ¿[$b³ß÷Ï²òÅ[485]]); $b¹çŸã¦“ö = $BÂ©·–®äõ[$b³ß÷Ï²òÅ[28]]; } else { if ($CÍâÛØŸÒ¿[$b³ß÷Ï²òÅ[405]] == self::TYPE_SYSTEM) { $b¹çŸã¦“ö = $b³ß÷Ï²òÅ[519]; } } } $b¹çŸã¦“ö = $b¹çŸã¦“ö ? $b³ß÷Ï²òÅ[8] . $b¹çŸã¦“ö . $b³ß÷Ï²òÅ[8] : $b³ß÷Ï²òÅ[8]; return $b¹çŸã¦“ö; } protected function _listAppendUser(&$C©­Æª˜Û) { goto cµø‡¯ºªè; F‡¤ƒ¤î„: unset($D¯ê‰†å»¤); goto eÜì—¿Ã—°; cµø‡¯ºªè: $D´Ï×Ö›ìÉ =& $_SERVER[ªúæÂ¡­ä½]; $fÁ…ˆÚõ = array_to_keyvalue($C©­Æª˜Û, $D´Ï×Ö›ìÉ[33], $D´Ï×Ö›ìÉ[433]); $dğéËºšµø = array_to_keyvalue($C©­Æª˜Û, $D´Ï×Ö›ìÉ[33], $D´Ï×Ö›ìÉ[435]); goto BÂˆ”‡¹‡; BÂˆ”‡¹‡: $a‚¤‰’¬½ = array_merge($fÁ…ˆÚõ, $dğéËºšµø); $FÉÅ¢ÍîÙ‰ = Model($D´Ï×Ö›ìÉ[520])->userListInfo($a‚¤‰’¬½); foreach ($C©­Æª˜Û as &$D¯ê‰†å»¤) { $cÜÁœ ãß÷ = $D¯ê‰†å»¤[$D´Ï×Ö›ìÉ[433]]; $D¯ê‰†å»¤[$D´Ï×Ö›ìÉ[433]] = $FÉÅ¢ÍîÙ‰[$cÜÁœ ãß÷] ? $FÉÅ¢ÍîÙ‰[$cÜÁœ ãß÷] : !1; $cÜÁœ ãß÷ = $D¯ê‰†å»¤[$D´Ï×Ö›ìÉ[435]]; $D¯ê‰†å»¤[$D´Ï×Ö›ìÉ[435]] = $FÉÅ¢ÍîÙ‰[$cÜÁœ ãß÷] ? $FÉÅ¢ÍîÙ‰[$cÜÁœ ãß÷] : !1; if (isset($D¯ê‰†å»¤[$D´Ï×Ö›ìÉ[446]]) && $D¯ê‰†å»¤[$D´Ï×Ö›ìÉ[446]][$D´Ï×Ö›ìÉ[521]]) { $f—¾©º´³å = $GLOBALS[$D´Ï×Ö›ìÉ[6]][$D´Ï×Ö›ìÉ[88]][$D´Ï×Ö›ìÉ[522]]; if ($D¯ê‰†å»¤[$D´Ï×Ö›ìÉ[446]][$D´Ï×Ö›ìÉ[523]] <= time() - $f—¾©º´³å) { $this->metaSet($D¯ê‰†å»¤[$D´Ï×Ö›ìÉ[396]], $D´Ï×Ö›ìÉ[521], null); $this->metaSet($D¯ê‰†å»¤[$D´Ï×Ö›ìÉ[396]], $D´Ï×Ö›ìÉ[523], null); unset($D¯ê‰†å»¤[$D´Ï×Ö›ìÉ[446]][$D´Ï×Ö›ìÉ[521]]); continue; } $B™¦íë®ÍÔ = $D¯ê‰†å»¤[$D´Ï×Ö›ìÉ[446]][$D´Ï×Ö›ìÉ[521]]; $D¯ê‰†å»¤[$D´Ï×Ö›ìÉ[446]][$D´Ï×Ö›ìÉ[524]] = Model($D´Ï×Ö›ìÉ[520])->getInfoSimpleOuter($B™¦íë®ÍÔ); } } goto F‡¤ƒ¤î„; eÜì—¿Ã—°: } public function parentLevelArray($aš°í£ô¨«) { $FÎ²è¸æÀ° =& $_SERVER[ªúæÂ¡­ä½]; $aš°í£ô¨« = explode($FÎ²è¸æÀ°[47], trim($aš°í£ô¨«, $FÎ²è¸æÀ°[47])); return array_remove_value($aš°í£ô¨«, $FÎ²è¸æÀ°[191]); } public function listAll($e‘„ğª­¿š) { goto cáº‰œöÅ¹; A‹‹‹²àòÂ: $E”Ÿ•¥‡¶í = array(); foreach ($CÇÌÚ¼á²® as $a¦Í‡°‹Ûä => $EêÁî¹¬­) { goto AçÓ‡‰Ø©; bö½ßã¾¹È: $Dá¿„ôŸ‘ = str_replace($A˜“œô½òÖ[511], $A˜“œô½òÖ[8], $Dá¿„ôŸ‘); $Dá¿„ôŸ‘ = str_replace($A˜“œô½òÖ[511], $A˜“œô½òÖ[8], $Dá¿„ôŸ‘); $Bªí¢Ê”– = array($A˜“œô½òÖ[415] => str_replace($A˜“œô½òÖ[511], $A˜“œô½òÖ[8], $Dá¿„ôŸ‘), $A˜“œô½òÖ[531] => intval($EêÁî¹¬­[$A˜“œô½òÖ[404]]), $A˜“œô½òÖ[85] => $this->pathInfoFilter($EêÁî¹¬­)); goto e¶À¿§ƒ; e¶À¿§ƒ: if (!$EêÁî¹¬­[$A˜“œô½òÖ[404]]) { $Bªí¢Ê”–[$A˜“œô½òÖ[448]] = $EêÁî¹¬­[$A˜“œô½òÖ[448]]; $Bªí¢Ê”–[$A˜“œô½òÖ[86]] = $EêÁî¹¬­[$A˜“œô½òÖ[76]]; } $E”Ÿ•¥‡¶í[] = $Bªí¢Ê”–; goto e»¢ŒÌ«; AçÓ‡‰Ø©: $c¸ôºŠ˜È” = $this->parentLevelArray($EêÁî¹¬­[$A˜“œô½òÖ[503]]); array_shift($c¸ôºŠ˜È”); $Dá¿„ôŸ‘ = $c”¨Š†á³Ç; goto b´™¢õ¨Êš; b´™¢õ¨Êš: for ($fÄö¾Õ·¼è = 0; $fÄö¾Õ·¼è < count($c¸ôºŠ˜È”); $fÄö¾Õ·¼è++) { $Dá¿„ôŸ‘ .= $CÇÌÚ¼á²®[$c¸ôºŠ˜È”[$fÄö¾Õ·¼è]][$A˜“œô½òÖ[28]] . $A˜“œô½òÖ[8]; } $Dá¿„ôŸ‘ .= $EêÁî¹¬­[$A˜“œô½òÖ[28]]; if ($EêÁî¹¬­[$A˜“œô½òÖ[404]]) { $Dá¿„ôŸ‘ .= $A˜“œô½òÖ[8]; } goto bö½ßã¾¹È; e»¢ŒÌ«: } return $E”Ÿ•¥‡¶í; goto a”ÌÉĞ³·; a­ª§ÙåÊé: $this->_listAppendAuth($CÇÌÚ¼á²®); $this->_listAppendUser($CÇÌÚ¼á²®); $this->_listAppendPath($CÇÌÚ¼á²®); goto B™š“¡ÜÉ; B™š“¡ÜÉ: $CÇÌÚ¼á²® = array_to_keyvalue($CÇÌÚ¼á²®, $A˜“œô½òÖ[396]); $c”¨Š†á³Ç = "\x2f{$A‰–¸¾±‘ù[$A˜“œô½òÖ[28]]}\57"; $c”¨Š†á³Ç = $c”¨Š†á³Ç == $A˜“œô½òÖ[511] ? $A˜“œô½òÖ[8] : $c”¨Š†á³Ç; goto A‹‹‹²àòÂ; cáº‰œöÅ¹: $A˜“œô½òÖ =& $_SERVER[ªúæÂ¡­ä½]; $A‰–¸¾±‘ù = $this->sourceInfo($e‘„ğª­¿š); $B”ñ‹öµ˜ = array($A˜“œô½òÖ[525] => array($A˜“œô½òÖ[526], $A‰–¸¾±‘ù[$A˜“œô½òÖ[503]] . $e‘„ğª­¿š . $A˜“œô½òÖ[527]), $A˜“œô½òÖ[528] => 0); goto aé×˜×…÷¦; aé×˜×…÷¦: $a²é»ãåª = $A˜“œô½òÖ[529]; $bò«ÙÀ¡•– = "\114\105\x46\124\x20\112\x4f\x49\116\x20{$this->tablePrefix}\x69\157\137\146\151\154\x65\x20\146\x69\x6c\145\x20\x6f\x6e\40\x73\157\165\162\x63\x65\x2e\x66\x69\x6c\145\x49\104\40\x3d\x20\146\x69\154\x65\x2e\146\151\x6c\145\111\x44"; $CÇÌÚ¼á²® = $this->alias($A˜“œô½òÖ[530])->field($a²é»ãåª)->where($B”ñ‹öµ˜)->join($bò«ÙÀ¡•–)->select(); goto a­ª§ÙåÊé; a”ÌÉĞ³·: } } class SourceListMoveModel extends SourceListModel { public $allowLockSource = 1; public $moveClearAuth = true; public function allowLock() { return $this->allowLockSource; } public function lockCopyStart($añ‹¹ÎÒ) { goto aè»½Å¦é¦; cĞ¥ÀÃÉˆÈ: $this->_lockEvent($añ‹¹ÎÒ, array($a£­Ÿˆå•[535], $a£­Ÿˆå•[536]), $f³˜æÎ×¸Æ); $this->_lockCheckEnd($a£­Ÿˆå•[532], $añ‹¹ÎÒ); goto E°Ïï‡ÑîÀ; aè»½Å¦é¦: $a£­Ÿˆå• =& $_SERVER[ªúæÂ¡­ä½]; if (!$this->allowLock()) { return; } $this->_lockCheck($a£­Ÿˆå•[532], $añ‹¹ÎÒ); goto DÅËÙ¾ó«¸; DÅËÙ¾ó«¸: $f³˜æÎ×¸Æ = 1; $this->_lockEvent($añ‹¹ÎÒ, array($a£­Ÿˆå•[533], $a£­Ÿˆå•[534]), $f³˜æÎ×¸Æ); $this->_lockParent($añ‹¹ÎÒ, array($a£­Ÿˆå•[534]), $f³˜æÎ×¸Æ); goto cĞ¥ÀÃÉˆÈ; E°Ïï‡ÑîÀ: } public function lockCopyEnd($f°÷°Éíëİ) { $bÊÙ‰¥¡ãõ =& $_SERVER[ªúæÂ¡­ä½]; if (!$this->allowLock()) { return; } $e–¥Š‹ùË  = 0; $this->_lockEvent($f°÷°Éíëİ, array($bÊÙ‰¥¡ãõ[533], $bÊÙ‰¥¡ãõ[534]), $e–¥Š‹ùË ); $this->_lockParent($f°÷°Éíëİ, array($bÊÙ‰¥¡ãõ[534]), $e–¥Š‹ùË ); $this->_lockEvent($f°÷°Éíëİ, array($bÊÙ‰¥¡ãõ[535], $bÊÙ‰¥¡ãõ[536]), $e–¥Š‹ùË ); } public function lockWriteStart($fŸå£•é‚´, $aÉöÒù´•„ = '') { goto E…Ö“¯‚®‰; E…Ö“¯‚®‰: $aİÍ£†Éœò =& $_SERVER[ªúæÂ¡­ä½]; if (!$this->allowLock()) { return; } $this->_lockCheck($aİÍ£†Éœò[533], $fŸå£•é‚´); goto a÷œ·ÜÁ À; a÷œ·ÜÁ À: $Aê­Üê˜¼ = 1; $this->_lockKey($aİÍ£†Éœò[537] . $fŸå£•é‚´ . $aİÍ£†Éœò[95] . $aÉöÒù´•„, $Aê­Üê˜¼); $this->_lockEvent($fŸå£•é‚´, array($aİÍ£†Éœò[532], $aİÍ£†Éœò[534]), $Aê­Üê˜¼); goto BäÇ‡Ü”¨; BäÇ‡Ü”¨: $this->_lockParent($fŸå£•é‚´, array($aİÍ£†Éœò[532], $aİÍ£†Éœò[534]), $Aê­Üê˜¼); $this->_lockCheckEnd($aİÍ£†Éœò[533], $fŸå£•é‚´); goto eĞŠĞ¹‘Ú‡; eĞŠĞ¹‘Ú‡: } public function lockWriteEnd($D•¾¬ˆñ‚„, $fä‘ÊŒœÜ = '') { $E‰…è»×¿˜ =& $_SERVER[ªúæÂ¡­ä½]; if (!$this->allowLock()) { return; } $eîÈ„µŞ›ß = 0; $this->_lockKey($E‰…è»×¿˜[537] . $D•¾¬ˆñ‚„ . $E‰…è»×¿˜[95] . $fä‘ÊŒœÜ, $eîÈ„µŞ›ß); $this->_lockEvent($D•¾¬ˆñ‚„, array($E‰…è»×¿˜[532], $E‰…è»×¿˜[534]), $eîÈ„µŞ›ß); $this->_lockParent($D•¾¬ˆñ‚„, array($E‰…è»×¿˜[532], $E‰…è»×¿˜[534]), $eîÈ„µŞ›ß); } public function lockMoveStart($dõÀ¥ÉùŞ) { goto bŒ¦Ö­†; AìøäçÜì’: $F×…æš¼ß = 1; $this->_lockKey($fÂòø¾µ®õ[538] . $dõÀ¥ÉùŞ, $F×…æš¼ß); $this->_lockEvent($dõÀ¥ÉùŞ, array($fÂòø¾µ®õ[532], $fÂòø¾µ®õ[533]), $F×…æš¼ß); goto Dèï¾æÅ×; Dèï¾æÅ×: $this->_lockParent($dõÀ¥ÉùŞ, array($fÂòø¾µ®õ[532], $fÂòø¾µ®õ[534]), $F×…æš¼ß); $this->_lockEvent($dõÀ¥ÉùŞ, array($fÂòø¾µ®õ[539], $fÂòø¾µ®õ[535], $fÂòø¾µ®õ[536]), $F×…æš¼ß); $this->_lockCheckEnd($fÂòø¾µ®õ[534], $dõÀ¥ÉùŞ); goto eÇïÍ¼ò†; bŒ¦Ö­†: $fÂòø¾µ®õ =& $_SERVER[ªúæÂ¡­ä½]; if (!$this->allowLock()) { return; } $this->_lockCheck($fÂòø¾µ®õ[534], $dõÀ¥ÉùŞ); goto AìøäçÜì’; eÇïÍ¼ò†: } public function lockMoveEnd($DéÑÒ“ëŸŒ) { goto EÜÇë‹Ñ½; EÜÇë‹Ñ½: $d‘»… ‹Ó½ =& $_SERVER[ªúæÂ¡­ä½]; if (!$this->allowLock()) { return; } $Fì‚µŠù¾ = 0; goto CåÊçÀÃĞÄ; AÍÂçğ÷ñÒ: $this->_lockEvent($DéÑÒ“ëŸŒ, array($d‘»… ‹Ó½[539], $d‘»… ‹Ó½[535], $d‘»… ‹Ó½[536]), $Fì‚µŠù¾); goto DÏ‰È‡¶Ñ; CåÊçÀÃĞÄ: $this->_lockKey($d‘»… ‹Ó½[538] . $DéÑÒ“ëŸŒ, $Fì‚µŠù¾); $this->_lockEvent($DéÑÒ“ëŸŒ, array($d‘»… ‹Ó½[532], $d‘»… ‹Ó½[533]), $Fì‚µŠù¾); $this->_lockParent($DéÑÒ“ëŸŒ, array($d‘»… ‹Ó½[532], $d‘»… ‹Ó½[534]), $Fì‚µŠù¾); goto AÍÂçğ÷ñÒ; DÏ‰È‡¶Ñ: } private function _lockCheck($bÔ†òØÕó¤, $dÀ¶Ëù‰‡Ú) { goto EŒŒõªÏ²§; d’æ°ÜÒ”¹: $Aù®…Ï‹… = array_reverse($this->parentLevelArray($EŒë¿Æ£É[$cÙˆ„ç¶…[503]])); foreach ($Aù®…Ï‹… as $AÂõÃ»æÕ—) { $AÁÄƒ¶í·“ = $bÔ†òØÕó¤ . $cÙˆ„ç¶…[541] . $AÂõÃ»æÕ—; if (CacheLock::lockGet($cÙˆ„ç¶…[542] . $AÁÄƒ¶í·“)) { $EŒë¿Æ£É = $this->sourceInfo($AÂõÃ»æÕ—); CacheLock::setErrorMsg($cÙˆ„ç¶…[160] . htmlspecialchars($EŒë¿Æ£É[$cÙˆ„ç¶…[28]]) . $cÙˆ„ç¶…[518] . $Fƒèä²´£); $this->_lockKey($AÁÄƒ¶í·“, 1); $this->_lockKey($AÁÄƒ¶í·“, 0); } } goto FæªßˆÍÜ; BéºÛê¤ò: $this->_lockTimeStart[$AÁÄƒ¶í·“] = timeFloat(); if (!is_array($EŒë¿Æ£É)) { return; } $Fƒèä²´£ = LNG($cÙˆ„ç¶…[540]); goto a¹ÆÂŞ«°; a¹ÆÂŞ«°: CacheLock::setErrorMsg($cÙˆ„ç¶…[160] . htmlspecialchars($EŒë¿Æ£É[$cÙˆ„ç¶…[28]]) . $cÙˆ„ç¶…[518] . $Fƒèä²´£); $this->_lockKey($AÁÄƒ¶í·“, 1); $this->_lockKey($AÁÄƒ¶í·“, 0); goto d’æ°ÜÒ”¹; EŒŒõªÏ²§: $cÙˆ„ç¶… =& $_SERVER[ªúæÂ¡­ä½]; $EŒë¿Æ£É = $this->sourceInfo($dÀ¶Ëù‰‡Ú); $AÁÄƒ¶í·“ = $bÔ†òØÕó¤ . $cÙˆ„ç¶…[95] . $dÀ¶Ëù‰‡Ú; goto BéºÛê¤ò; FæªßˆÍÜ: } private function _lockCheckEnd($D‰ğ„¦Ÿ¸‰, $AŒ—èÊÙÍ¡) { goto B†ôï¤¬öŠ; B†ôï¤¬öŠ: $Dà±Çô“Š° =& $_SERVER[ªúæÂ¡­ä½]; $f¤Ü“ìÆ³ = $D‰ğ„¦Ÿ¸‰ . $Dà±Çô“Š°[95] . $AŒ—èÊÙÍ¡; CacheLock::setErrorMsg($Dà±Çô“Š°[375]); goto d÷±ê“å´Ë; DÛ®ğáÃË: if ($bê’¨¸Ó > 0.5) { unset(self::$cacheSourceInfo[$Dà±Çô“Š°[439] . $AŒ—èÊÙÍ¡]); } $b¢ÈáĞ‰í = $this->sourceInfo($AŒ—èÊÙÍ¡); if (!$b¢ÈáĞ‰í) { show_json(LNG($Dà±Çô“Š°[105]), !1); } goto eçÔ®³«¡è; d÷±ê“å´Ë: if (!isset($this->_lockTimeStart[$f¤Ü“ìÆ³])) { return; } $bê’¨¸Ó = timeFloat() - $this->_lockTimeStart[$f¤Ü“ìÆ³]; unset($this->_lockTimeStart[$f¤Ü“ìÆ³]); goto DÛ®ğáÃË; eçÔ®³«¡è: } private function _lockParent($FËæÊ¹æÛ, $BÕ¥›˜“²µ, $D¤ø•Õ¤Ÿ) { if (!$this->autoLockSet) { return; } $d˜Œ÷â‚† = $this->sourceInfo($FËæÊ¹æÛ); if (!is_array($d˜Œ÷â‚†)) { return; } $c‚®‘¤‡°® = array_reverse($this->parentLevelArray($d˜Œ÷â‚†[$_SERVER[ªúæÂ¡­ä½][503]])); foreach ($c‚®‘¤‡°® as $d’É‰—Ê‡) { $this->_lockEvent($d’É‰—Ê‡, $BÕ¥›˜“²µ, $D¤ø•Õ¤Ÿ); } } private function _lockEvent($A½°¢ƒÙÆÓ, $C•»¹ØéÌ, $E²‰†–ä‰Â) { $CØƒ·ã©´ç =& $_SERVER[ªúæÂ¡­ä½]; if (!$this->autoLockSet) { return; } foreach ($C•»¹ØéÌ as $bš®¦ÛÛÇù) { $fÆ£æœ‰ = $bš®¦ÛÛÇù . $CØƒ·ã©´ç[95] . $A½°¢ƒÙÆÓ; if ($E²‰†–ä‰Â && CacheLock::lockGet($CØƒ·ã©´ç[542] . $fÆ£æœ‰)) { continue; } $this->_lockKey($fÆ£æœ‰, $E²‰†–ä‰Â); } } public $_lockTimeStart = array(); public $_lockTime = 5; private static $_lockItemArr = array(); private function _lockKey($Cˆø®İß ‰, $AÓÆ°„¹™ = 1) { $AğçÓ×¾šŠ = $_SERVER[ªúæÂ¡­ä½][542] . md5($Cˆø®İß ‰); if ($AÓÆ°„¹™) { if (isset(self::$_lockItemArr[$AğçÓ×¾šŠ])) { return; } self::$_lockItemArr[$AğçÓ×¾šŠ] = 1; CacheLock::lock($AğçÓ×¾šŠ, $this->_lockTime); } else { if (!isset(self::$_lockItemArr[$AğçÓ×¾šŠ])) { return; } unset(self::$_lockItemArr[$AğçÓ×¾šŠ]); CacheLock::unlock($AğçÓ×¾šŠ); } } public function isParentOf($bĞÅ­é×Õ, $a•„­²“¬Â) { goto e†¨”‘‰Šï; e†¨”‘‰Šï: $a•¡”ÜË¸ò =& $_SERVER[ªúæÂ¡­ä½]; $CÜàîŸå©Œ = $this->sourceInfo($bĞÅ­é×Õ); $cŠ»›ì’÷² = $this->sourceInfo($a•„­²“¬Â); goto AìäÖˆÅ¬; AìäÖˆÅ¬: $dˆ»­ç×Ëê = $CÜàîŸå©Œ[$a•¡”ÜË¸ò[503]] . $CÜàîŸå©Œ[$a•¡”ÜË¸ò[396]] . $a•¡”ÜË¸ò[47]; $Eèí‰›Å¨Œ = $cŠ»›ì’÷²[$a•¡”ÜË¸ò[503]] . $cŠ»›ì’÷²[$a•¡”ÜË¸ò[396]] . $a•¡”ÜË¸ò[47]; $F‰ìŒ«ÍÆá = strpos($Eèí‰›Å¨Œ, $dˆ»­ç×Ëê) === 0; goto BØ…Í¿‘èâ; BØ…Í¿‘èâ: return $F‰ìŒ«ÍÆá; goto cëÉá„†à“; cëÉá„†à“: } private $targetIsDelete = 0; public function copy($CñÔØá¦š», $CÖŸÓ™ší, $Dß‰­´ğëê = REPEAT_REPLACE, $b‹›Âœä = '') { goto cİÀ«ù¤¢œ; cİÀ«ù¤¢œ: $bƒè‰‹õ•— =& $_SERVER[ªúæÂ¡­ä½]; $Bò‘ï¥ÑÊ = $this->sourceInfo($CñÔØá¦š»); $B¾©”—ÒìÜ = $this->sourceInfo($CÖŸÓ™ší); goto dá³‚÷ÇŠ™; aÛŸ¦ÍÚ§¨: $this->targetIsDelete = intval($Bò‘ï¥ÑÊ[$bƒè‰‹õ•—[424]]); $eè¯ÆØ·×ƒ = $this->fileNameExistCache($CÖŸÓ™ší, $Bò‘ï¥ÑÊ[$bƒè‰‹õ•—[28]]); $f‚¿ô±Ó = $this->_copy($CñÔØá¦š», $CÖŸÓ™ší, $Dß‰­´ğëê, $AƒóĞÓÉÜ‰, !0, $b‹›Âœä); goto bÓ—¢ˆ–Ú; dá³‚÷ÇŠ™: if (!$Bò‘ï¥ÑÊ || !$B¾©”—ÒìÜ || $B¾©”—ÒìÜ[$bƒè‰‹õ•—[404]] != $bƒè‰‹õ•—[87]) { return !1; } if ($this->isParentOf($CñÔØá¦š», $CÖŸÓ™ší)) { return !1; } $CŸÉõÑ³ê› = $b‹›Âœä ? $b‹›Âœä : $Bò‘ï¥ÑÊ[$bƒè‰‹õ•—[28]]; goto Dæ·¸º’Û; Dæ·¸º’Û: $this->lockCopyStart($CñÔØá¦š»); $this->lockWriteStart($CÖŸÓ™ší, $CŸÉõÑ³ê›); $AƒóĞÓÉÜ‰ = array($bƒè‰‹õ•—[543] => array(), $bƒè‰‹õ•—[544] => array(), $bƒè‰‹õ•—[545] => array()); goto aÛŸ¦ÍÚ§¨; bÓ—¢ˆ–Ú: $this->_childrenListClear(); $this->lockCopyEnd($CñÔØá¦š»); $this->lockWriteEnd($CÖŸÓ™ší, $CŸÉõÑ³ê›); goto C‰ğìÛ¦ÈÖ; C‰ğìÛ¦ÈÖ: if ($Bò‘ï¥ÑÊ[$bƒè‰‹õ•—[404]] == $bƒè‰‹õ•—[87] && $eè¯ÆØ·×ƒ == $f‚¿ô±Ó) { $this->folderSizeResetChildren($eè¯ÆØ·×ƒ); } Model($bƒè‰‹õ•—[546])->addAll($AƒóĞÓÉÜ‰[$bƒè‰‹õ•—[544]], array(), !0); if ($eè¯ÆØ·×ƒ != $f‚¿ô±Ó || $Bò‘ï¥ÑÊ[$bƒè‰‹õ•—[404]] == $bƒè‰‹õ•—[87]) { Model($bƒè‰‹õ•—[547])->eventCopy($f‚¿ô±Ó); } goto FáêØ®‘Öê; A‘öîí®©ª: $this->updateModifyTime($CÖŸÓ™ší); return $f‚¿ô±Ó; goto B˜•Â´¨›½; FáêØ®‘Öê: $this->saveAll($AƒóĞÓÉÜ‰[$bƒè‰‹õ•—[545]]); Model($bƒè‰‹õ•—[193])->linkAdd($AƒóĞÓÉÜ‰[$bƒè‰‹õ•—[543]]); $this->folderSizeReset($CÖŸÓ™ší); goto A‘öîí®©ª; B˜•Â´¨›½: } private function _copy($E±Ş×–›”, $fó¬ ºÁä, $aª­¤ãÒàÆ, &$aÂºáôË‰Ø, $cŸŸ“‹×ˆ¾, $Eòàê›ÉŠÂ = '') { goto BÚšÁã–ö÷; C³Âãï¸Ê: if (!$D“…¨ìŸ­) { return $this->_copyCreate($E±Ş×–›”, $fó¬ ºÁä, $BòöºêŞ÷Å, $aÂºáôË‰Ø); } $fÌÈÍµŒ = $D“…¨ìŸ­; if ($F§¤˜œÛˆà) { if ($aª­¤ãÒàÆ == REPEAT_RENAME_FOLDER) { $BòöºêŞ÷Å = $this->fileNameAutoCache($fó¬ ºÁä, $BòöºêŞ÷Å, $aª­¤ãÒàÆ, $F§¤˜œÛˆà); $fÌÈÍµŒ = $this->_copyCreate($E±Ş×–›”, $fó¬ ºÁä, $BòöºêŞ÷Å, $aÂºáôË‰Ø); } else { $AÒ¶Ì¢Æ£ = $this->_childrenList($E±Ş×–›”); foreach ($AÒ¶Ì¢Æ£ as $E–ŒŠš¤È) { $this->_copy($E–ŒŠš¤È[$c‡ÒÊ­²íŞ[396]], $D“…¨ìŸ­, $aª­¤ãÒàÆ, $aÂºáôË‰Ø, !1); } } } else { if ($aª­¤ãÒàÆ == REPEAT_RENAME || $aª­¤ãÒàÆ == REPEAT_RENAME_FOLDER) { $BòöºêŞ÷Å = $this->fileNameAutoCache($fó¬ ºÁä, $BòöºêŞ÷Å, $aª­¤ãÒàÆ, $F§¤˜œÛˆà); $fÌÈÍµŒ = $this->_copyCreate($E±Ş×–›”, $fó¬ ºÁä, $BòöºêŞ÷Å, $aÂºáôË‰Ø); } else { if ($aª­¤ãÒàÆ == REPEAT_REPLACE) { $C¼óÏ•—Ö = $this->sourceInfoCache($D“…¨ìŸ­); $d¾å¯»¨¯£ = $this->fileHistory($C¼óÏ•—Ö, $dµÄÊš›ŠÜ[$c‡ÒÊ­²íŞ[448]], $dµÄÊš›ŠÜ[$c‡ÒÊ­²íŞ[78]]); if ($d¾å¯»¨¯£) { $aÂºáôË‰Ø[$c‡ÒÊ­²íŞ[543]][] = $dµÄÊš›ŠÜ[$c‡ÒÊ­²íŞ[448]]; } } else { if ($aª­¤ãÒàÆ == REPEAT_SKIP) { } } } Hook::trigger($c‡ÒÊ­²íŞ[548], array($c‡ÒÊ­²íŞ[549], $dµÄÊš›ŠÜ, 0)); } goto BÈôÜƒÈ‰¦; bÊ×¡ã¬Æë: $BòöºêŞ÷Å = $Eòàê›ÉŠÂ ? $Eòàê›ÉŠÂ : $dµÄÊš›ŠÜ[$c‡ÒÊ­²íŞ[28]]; $D“…¨ìŸ­ = $this->fileNameExistCache($fó¬ ºÁä, $BòöºêŞ÷Å); if ($cŸŸ“‹×ˆ¾) { $this->_childrenAllMake($E±Ş×–›”); if ($F§¤˜œÛˆà && $D“…¨ìŸ­) { $this->_childrenAllMake($D“…¨ìŸ­); } } goto C³Âãï¸Ê; BÈôÜƒÈ‰¦: return $fÌÈÍµŒ; goto FˆÓ¹ŠÁÁÉ; BÚšÁã–ö÷: $c‡ÒÊ­²íŞ =& $_SERVER[ªúæÂ¡­ä½]; $dµÄÊš›ŠÜ = $this->sourceInfoCache($E±Ş×–›”); $F§¤˜œÛˆà = $dµÄÊš›ŠÜ[$c‡ÒÊ­²íŞ[404]] == $c‡ÒÊ­²íŞ[87]; goto bÊ×¡ã¬Æë; FˆÓ¹ŠÁÁÉ: } private function _copyCreate($Eš¦è˜âÚì, $cøë¢…à´¡, $E¬ƒ÷‰ŒòÎ, &$EÑ²Á›ôØö) { goto eò° ÷½Ü; EÊë«Ğ³‡: $eà¼Û´èˆ = $this->sourceInfo($dâµº¾ÊÄ¥); foreach ($F§Â¾òä³ as $DÊÜ²ÔôÅœ) { $a»¨çÆ¶Ç = $this->_makeItemData($DÊÜ²ÔôÅœ, $eà¼Û´èˆ, $DÊÜ²ÔôÅœ[$FˆÎŒ½©˜™[28]]); $a»¨çÆ¶Ç[$FˆÎŒ½©˜™[503]] = $DÊÜ²ÔôÅœ[$FˆÎŒ½©˜™[503]]; $EùÚ» Ùä‹[] = $a»¨çÆ¶Ç; } $this->chunkEventSet($FˆÎŒ½©˜™[553], array($FˆÎŒ½©˜™[554], $fââÎÛèæ¦, $b±‰µ‰¯Ñ)); goto C°³Ğ¦¬‘; FÃ›ìÙí´æ: $this->chunkEventSet($FˆÎŒ½©˜™[557], array($FˆÎŒ½©˜™[558], $fââÎÛèæ¦, $b±‰µ‰¯Ñ)); $this->saveAll($eÍÑëò§‰Ö); return $dâµº¾ÊÄ¥; goto Dµ èƒ·Ü; dèÙªØ¬›§: $fââÎÛèæ¦ = $this->_makeItemData($cª¯‹éáİ, $B´šî¼¿Œ×, $E¬ƒ÷‰ŒòÎ); Hook::trigger($FˆÎŒ½©˜™[550], $fââÎÛèæ¦); Hook::trigger($FˆÎŒ½©˜™[551], array($FˆÎŒ½©˜™[552], $fââÎÛèæ¦, 0)); goto C’Ñï©¢‡º; Eºß¹¶·: if ($cª¯‹éáİ[$FˆÎŒ½©˜™[404]] != $FˆÎŒ½©˜™[87]) { $EÑ²Á›ôØö[$FˆÎŒ½©˜™[543]][] = $cª¯‹éáİ[$FˆÎŒ½©˜™[448]]; return $dâµº¾ÊÄ¥; } $F§Â¾òä³ = array(); $EùÚ» Ùä‹ = array(); goto fËÉ¹¤Î‰ƒ; C’Ñï©¢‡º: $dâµº¾ÊÄ¥ = $this->add($fââÎÛèæ¦); $e„§®ÄÔë¡ = array($FˆÎŒ½©˜™[396] => $dâµº¾ÊÄ¥, $FˆÎŒ½©˜™[28] => $E¬ƒ÷‰ŒòÎ); $this->_copyApplyMeta($e„§®ÄÔë¡, $EÑ²Á›ôØö); goto Eºß¹¶·; fè†«í¿µ: $fÊ‹È…í®–[$Eš¦è˜âÚì] = $dâµº¾ÊÄ¥; $A›ìåÊ´éò = array(); $eÍÑëò§‰Ö = array(); goto fïËÕéñø; eò° ÷½Ü: $FˆÎŒ½©˜™ =& $_SERVER[ªúæÂ¡­ä½]; $cª¯‹éáİ = $this->sourceInfoCache($Eš¦è˜âÚì); $B´šî¼¿Œ× = $this->sourceInfoCache($cøë¢…à´¡); goto dèÙªØ¬›§; C°³Ğ¦¬‘: $this->addAll($EùÚ» Ùä‹, array(), !1); $B–’À´ß½ = $this->where(array($FˆÎŒ½©˜™[479] => $dâµº¾ÊÄ¥))->select(); $fÊ‹È…í®– = $this->_childrenMakeRelation($F§Â¾òä³, $B–’À´ß½); goto fè†«í¿µ; fËÉ¹¤Î‰ƒ: $this->_childrenListAll($Eš¦è˜âÚì, $F§Â¾òä³); $b±‰µ‰¯Ñ = count($F§Â¾òä³); if ($b±‰µ‰¯Ñ == 0) { return $dâµº¾ÊÄ¥; } goto EÊë«Ğ³‡; fïËÕéñø: foreach ($B–’À´ß½ as $DÊÜ²ÔôÅœ) { $Eô÷Ÿœ‹É™ = $DÊÜ²ÔôÅœ[$FˆÎŒ½©˜™[396]]; $eäÀÚã¹© = $this->_childrenMatch($fÊ‹È…í®–, $DÊÜ²ÔôÅœ, $eà¼Û´èˆ); $A›ìåÊ´éò[] = array($FˆÎŒ½©˜™[396], $Eô÷Ÿœ‹É™, $FˆÎŒ½©˜™[479], $eäÀÚã¹©[$FˆÎŒ½©˜™[479]]); $eÍÑëò§‰Ö[] = array($FˆÎŒ½©˜™[396], $Eô÷Ÿœ‹É™, $FˆÎŒ½©˜™[503], $eäÀÚã¹©[$FˆÎŒ½©˜™[503]]); $this->_copyApplyMeta($DÊÜ²ÔôÅœ, $EÑ²Á›ôØö); if ($DÊÜ²ÔôÅœ[$FˆÎŒ½©˜™[404]] != $FˆÎŒ½©˜™[87]) { $EÑ²Á›ôØö[$FˆÎŒ½©˜™[543]][] = $DÊÜ²ÔôÅœ[$FˆÎŒ½©˜™[448]]; } } $this->chunkEventSet($FˆÎŒ½©˜™[555], array($FˆÎŒ½©˜™[556], $fââÎÛèæ¦, $b±‰µ‰¯Ñ)); $this->saveAll($A›ìåÊ´éò); goto FÃ›ìÙí´æ; Dµ èƒ·Ü: } private function _childrenMakeRelation($CÇß‰áªÉù, $F’÷˜Ô”¾Ê) { $f÷²³â‡Ùá =& $_SERVER[ªúæÂ¡­ä½]; $F¾ØÚ“áÏ = array(); $døÜ¨ø‹ Œ = array(); foreach ($CÇß‰áªÉù as $a½‡è˜ºîÙ) { $dò±¹©ä¦‘ = $a½‡è˜ºîÙ[$f÷²³â‡Ùá[28]] . $f÷²³â‡Ùá[8] . $a½‡è˜ºîÙ[$f÷²³â‡Ùá[503]]; $F¾ØÚ“áÏ[$dò±¹©ä¦‘] = $a½‡è˜ºîÙ[$f÷²³â‡Ùá[396]]; } foreach ($F’÷˜Ô”¾Ê as $a½‡è˜ºîÙ) { $dò±¹©ä¦‘ = $a½‡è˜ºîÙ[$f÷²³â‡Ùá[28]] . $f÷²³â‡Ùá[8] . $a½‡è˜ºîÙ[$f÷²³â‡Ùá[503]]; $D‹„¿®Š‚Ü = $F¾ØÚ“áÏ[$dò±¹©ä¦‘]; $døÜ¨ø‹ Œ[$D‹„¿®Š‚Ü] = $a½‡è˜ºîÙ[$f÷²³â‡Ùá[396]]; } return $døÜ¨ø‹ Œ; } private function _childrenMatch($aáö¦—‘×, $bóÚ¶øÆå, $Cß˜†–Ş í) { goto F—·¹§Ê‡; F—·¹§Ê‡: $d¾«•Çâ¬ =& $_SERVER[ªúæÂ¡­ä½]; $Cæ¨‚ò²õ© = $Cß˜†–Ş í[$d¾«•Çâ¬[503]]; $A¡°â‹÷‚‹ = $this->parentLevelArray($bóÚ¶øÆå[$d¾«•Çâ¬[503]]); goto C…ô¨êóœ; C…ô¨êóœ: foreach ($A¡°â‹÷‚‹ as $cóÕïğ ÅË) { if (isset($aáö¦—‘×[$cóÕïğ ÅË])) { $Cæ¨‚ò²õ© .= $aáö¦—‘×[$cóÕïğ ÅË] . $d¾«•Çâ¬[559]; } } $Cæ¨‚ò²õ© = rtrim($Cæ¨‚ò²õ©, $d¾«•Çâ¬[47]) . $d¾«•Çâ¬[47]; $Bá×¥ìºµÂ = $this->parentLevelArray($Cæ¨‚ò²õ©); goto B¯ììÜÄøø; B¯ììÜÄøø: $E°Äõ‚æĞŸ = $Bá×¥ìºµÂ[count($Bá×¥ìºµÂ) - 1]; return array($d¾«•Çâ¬[479] => $E°Äõ‚æĞŸ, $d¾«•Çâ¬[503] => $Cæ¨‚ò²õ©); goto bš¡ù°„óà; bš¡ù°„óà: } private function _makeItemData($aÃÜ”ùøìÕ, $CŸÏÕç”à, $A¶´İîø¹é) { $BÖ“«“½—— =& $_SERVER[ªúæÂ¡­ä½]; $B‹Ù­ÕÆ™Ô = array($BÖ“«“½——[560] => $aÃÜ”ùøìÕ[$BÖ“«“½——[404]], $BÖ“«“½——[414] => $A¶´İîø¹é, $BÖ“«“½——[561] => $aÃÜ”ùøìÕ[$BÖ“«“½——[406]], $BÖ“«“½——[449] => $aÃÜ”ùøìÕ[$BÖ“«“½——[448]], $BÖ“«“½——[562] => $aÃÜ”ùøìÕ[$BÖ“«“½——[78]], $BÖ“«“½——[563] => $CŸÏÕç”à[$BÖ“«“½——[405]], $BÖ“«“½——[564] => $CŸÏÕç”à[$BÖ“«“½——[485]], $BÖ“«“½——[565] => USER_ID, $BÖ“«“½——[566] => USER_ID, $BÖ“«“½——[395] => $CŸÏÕç”à[$BÖ“«“½——[396]], $BÖ“«“½——[567] => $CŸÏÕç”à[$BÖ“«“½——[503]] . $CŸÏÕç”à[$BÖ“«“½——[396]] . $BÖ“«“½——[47], $BÖ“«“½——[418] => $aÃÜ”ùøìÕ[$BÖ“«“½——[84]], $BÖ“«“½——[423] => 0, $BÖ“«“½——[568] => $BÖ“«“½——[33]); return $B‹Ù­ÕÆ™Ô; } private function _copyApplyMeta($D‘¡§É¥²°, &$f²¨òŠšÓ) { $Bİ¦×ä‹øÍ =& $_SERVER[ªúæÂ¡­ä½]; $f‚Š¶°»¶è = $D‘¡§É¥²°[$Bİ¦×ä‹øÍ[396]]; $f©Ê‹……Î“ = $D‘¡§É¥²°[$Bİ¦×ä‹øÍ[28]]; if (!isset($D‘¡§É¥²°[$Bİ¦×ä‹øÍ[569]]) || !$D‘¡§É¥²°[$Bİ¦×ä‹øÍ[569]] || $D‘¡§É¥²°[$Bİ¦×ä‹øÍ[569]] == $Bİ¦×ä‹øÍ[191]) { $f²¨òŠšÓ[$Bİ¦×ä‹øÍ[545]][] = array($Bİ¦×ä‹øÍ[396], $f‚Š¶°»¶è, $Bİ¦×ä‹øÍ[569], short_id($f‚Š¶°»¶è)); } if (Input::check($f©Ê‹……Î“, $Bİ¦×ä‹øÍ[570])) { $f²¨òŠšÓ[$Bİ¦×ä‹øÍ[544]][] = array($Bİ¦×ä‹øÍ[396] => $f‚Š¶°»¶è, $Bİ¦×ä‹øÍ[93] => $Bİ¦×ä‹øÍ[445], $Bİ¦×ä‹øÍ[372] => str_replace($Bİ¦×ä‹øÍ[50], $Bİ¦×ä‹øÍ[33], Pinyin::encode($f©Ê‹……Î“))); $f²¨òŠšÓ[$Bİ¦×ä‹øÍ[544]][] = array($Bİ¦×ä‹øÍ[396] => $f‚Š¶°»¶è, $Bİ¦×ä‹øÍ[93] => $Bİ¦×ä‹øÍ[444], $Bİ¦×ä‹øÍ[372] => Pinyin::encode($f©Ê‹……Î“, $Bİ¦×ä‹øÍ[571])); } } private $_childrenListCache = array(); private $_childrenItemCache = array(); private function _childrenAllMake($cïïÊÀµˆ) { goto c¼ÍĞĞÔÁ¹; FÅÛ’¸ÙÚ: $aÂ¢äØ¿¯Ö = array($AÓ”‚±¢ã[503] => array($AÓ”‚±¢ã[526], $aĞ³ÎÈ¶õ[$AÓ”‚±¢ã[503]] . $cïïÊÀµˆ . $AÓ”‚±¢ã[527]), $AÓ”‚±¢ã[424] => $this->targetIsDelete); $BÁ´ÀŒÈ‡Ô = $this->field($A‚î˜‰Œ×)->where($aÂ¢äØ¿¯Ö)->select(); if (!$BÁ´ÀŒÈ‡Ô) { return; } goto bÇ¦†ÙİëÇ; bÇ¦†ÙİëÇ: $BÁ´ÀŒÈ‡Ô = array_to_keyvalue($BÁ´ÀŒÈ‡Ô, $AÓ”‚±¢ã[396]); foreach ($BÁ´ÀŒÈ‡Ô as $B÷ßİŞºÜ) { $cäĞ÷Ÿ¤ïà = $B÷ßİŞºÜ[$AÓ”‚±¢ã[479]]; $cïïÊÀµˆ = $B÷ßİŞºÜ[$AÓ”‚±¢ã[396]]; if (!isset($this->_childrenListCache[$cïïÊÀµˆ]) && $B÷ßİŞºÜ[$AÓ”‚±¢ã[404]] == $AÓ”‚±¢ã[87]) { $this->_childrenListCache[$cïïÊÀµˆ] = array(); } if (!isset($this->_childrenListCache[$cäĞ÷Ÿ¤ïà])) { $this->_childrenListCache[$cäĞ÷Ÿ¤ïà] = array(); } $this->_childrenListCache[$cäĞ÷Ÿ¤ïà][$cïïÊÀµˆ] = $B÷ßİŞºÜ; $this->_childrenItemCache[$cïïÊÀµˆ] = $B÷ßİŞºÜ; } goto BÃ§’ùĞ˜Â; c¼ÍĞĞÔÁ¹: $AÓ”‚±¢ã =& $_SERVER[ªúæÂ¡­ä½]; $aĞ³ÎÈ¶õ = $this->sourceInfo($cïïÊÀµˆ); $A‚î˜‰Œ× = $AÓ”‚±¢ã[425]; goto FÅÛ’¸ÙÚ; BÃ§’ùĞ˜Â: } private function _childrenListAll($DïŠÅÚµá¨, &$f‹†óîï) { $eçò‰°Á• =& $_SERVER[ªúæÂ¡­ä½]; if (!isset($this->_childrenListCache[$DïŠÅÚµá¨])) { return; } $Aºä‹±ôŠ = $this->_childrenListCache[$DïŠÅÚµá¨]; foreach ($Aºä‹±ôŠ as $béÒó‡ËÁÕ => $cœ¼›Á‰›…) { $f‹†óîï[$béÒó‡ËÁÕ] = $cœ¼›Á‰›…; if ($cœ¼›Á‰›…[$eçò‰°Á•[404]] == $eçò‰°Á•[87]) { $this->_childrenListAll($béÒó‡ËÁÕ, $f‹†óîï); } } } private function sourceInfoCache($fŠâ¹ß¯â) { if (isset($this->_childrenItemCache[$fŠâ¹ß¯â])) { return $this->_childrenItemCache[$fŠâ¹ß¯â]; } return $this->sourceInfo($fŠâ¹ß¯â); } private function _childrenList($F¦¦›ßİÃÕ) { if (isset($this->_childrenListCache[$F¦¦›ßİÃÕ])) { return $this->_childrenListCache[$F¦¦›ßİÃÕ]; } return $this->_childrenListSelect($F¦¦›ßİÃÕ); } private function _childrenListSelect($d¹ÆŸßÃÌ¿) { goto AìñÙ³ª²; e¬Ñ‚¦: foreach ($b™‘×¦…Ç¼ as $d¹ÆŸßÃÌ¿ => $E¬×íŸ¨†š) { $this->_childrenItemCache[$d¹ÆŸßÃÌ¿] = $E¬×íŸ¨†š; } return $b™‘×¦…Ç¼; goto bÌİ„Ûá‡; DêÓá†‰¬š: $E°ãÇÃáõÍ = $E°ãÇÃáõÍ ? $E°ãÇÃáõÍ : array(); $b™‘×¦…Ç¼ = array_to_keyvalue($E°ãÇÃáõÍ, $bø†‚ƒÈŞì[396]); $this->_childrenListCache[$d¹ÆŸßÃÌ¿] = $b™‘×¦…Ç¼; goto e¬Ñ‚¦; AìñÙ³ª²: $bø†‚ƒÈŞì =& $_SERVER[ªúæÂ¡­ä½]; $aòŒ­é´ŒÑ = array($bø†‚ƒÈŞì[479] => $d¹ÆŸßÃÌ¿, $bø†‚ƒÈŞì[424] => $this->targetIsDelete); $E°ãÇÃáõÍ = $this->where($aòŒ­é´ŒÑ)->select(); goto DêÓá†‰¬š; bÌİ„Ûá‡: } private function fileNameExistCache($E¤¬´˜ò×›, $Fà—Öê·‰–) { $f¾†­ìø‰Ì =& $_SERVER[ªúæÂ¡­ä½]; $Fà—Öê·‰– = strtolower($Fà—Öê·‰–); $b…×ÔÄ‹„Ç = $this->_childrenList($E¤¬´˜ò×›); foreach ($b…×ÔÄ‹„Ç as $b¢Ç”õÑŒ) { if ($Fà—Öê·‰– == strtolower($b¢Ç”õÑŒ[$f¾†­ìø‰Ì[28]])) { return $b¢Ç”õÑŒ[$f¾†­ìø‰Ì[396]]; } } return !1; } private function fileNameAutoCache($F¾Çò¤ù¡´, $EñŠ ¢¬æ, $bºßë£»ñ, $dôë³ïÌ“Ø) { $dÆ¡š‡ƒòŒ =& $_SERVER[ªúæÂ¡­ä½]; $a‹ùƒÆ†Ç¨ = $this->_childrenList($F¾Çò¤ù¡´); $A¨¦¹·™ô¦ = array_to_keyvalue($a‹ùƒÆ†Ç¨, $dÆ¡š‡ƒòŒ[33], $dÆ¡š‡ƒòŒ[28]); return $this->fileNameAutoGet($A¨¦¹·™ô¦, $EñŠ ¢¬æ, $bºßë£»ñ, $dôë³ïÌ“Ø); } private function _childrenListClear() { $this->_childrenListCache = null; $this->_childrenItemCache = null; $this->_childrenListCache = array(); $this->_childrenItemCache = array(); } public function move($B‰çéãäÖí, $dˆŠ‘°Ñ×˜, $fİ¤ó½ëµ = REPEAT_REPLACE, $f”¥‘÷Ó«¬ = '') { goto Cª é…ƒ…À; cÒ¸ÛìÔó˜: $this->updateModifyTime($Aİ“„Ë»ÆÆ); Model($bÆöçÙìÏé[547])->eventMove($B‰çéãäÖí, $FíÒ°Ù¨¼[$bÆöçÙìÏé[479]], $dˆŠ‘°Ñ×˜); Hook::trigger($bÆöçÙìÏé[573], $bìÌ§øŸÚŠ); goto dîŒÂ¤Œ¶«; béÒãÎÃ›: if ($FíÒ°Ù¨¼[$bÆöçÙìÏé[404]] == $bÆöçÙìÏé[87] && $cÄ¤ÍÇ“ƒ…) { $this->folderSizeResetChildren($a¡å“ğ‡“×); } Model($bÆöçÙìÏé[193])->linkAdd($F”Ì®ˆ®æê[$bÆöçÙìÏé[543]]); if ($cÄ¤ÍÇ“ƒ… && $F”Ì®ˆ®æê[$bÆöçÙìÏé[574]]) { $this->removeNow($B‰çéãäÖí, !1); } goto FºÂ¹Úß„Ğ; Cª é…ƒ…À: $bÆöçÙìÏé =& $_SERVER[ªúæÂ¡­ä½]; $FíÒ°Ù¨¼ = $this->sourceInfo($B‰çéãäÖí); $b–Š°÷”«Š = $this->sourceInfo($dˆŠ‘°Ñ×˜); goto B£˜öËÈí ; F‚æ‹Ûœ á: if (!$FíÒ°Ù¨¼ || !$b–Š°÷”«Š || $b–Š°÷”«Š[$bÆöçÙìÏé[404]] != $bÆöçÙìÏé[87]) { return !1; } Hook::trigger($bÆöçÙìÏé[572], $bìÌ§øŸÚŠ); $this->targetIsDelete = intval($FíÒ°Ù¨¼[$bÆöçÙìÏé[424]]); goto cŒÊ¼Øİò; BÅÔßÓî: $this->lockWriteStart($dˆŠ‘°Ñ×˜, $c…öƒ£ïÇ); $F”Ì®ˆ®æê = array($bÆöçÙìÏé[543] => array(), $bÆöçÙìÏé[574] => !1); $this->clearShare($B‰çéãäÖí, $dˆŠ‘°Ñ×˜); goto AÉ‰—¸óÃò; dîŒÂ¤Œ¶«: return $a¡å“ğ‡“×; goto e‚™·ŞÍè´; B£˜öËÈí : if ($FíÒ°Ù¨¼[$bÆöçÙìÏé[479]] == $b–Š°÷”«Š[$bÆöçÙìÏé[396]]) { if ($FíÒ°Ù¨¼[$bÆöçÙìÏé[424]] == $bÆöçÙìÏé[87]) { Model($bÆöçÙìÏé[422])->restore(array($B‰çéãäÖí)); } if (!$f”¥‘÷Ó«¬ || $f”¥‘÷Ó«¬ == $FíÒ°Ù¨¼[$bÆöçÙìÏé[28]]) { return $B‰çéãäÖí; } } $bìÌ§øŸÚŠ = $this->pathInfoMore($B‰çéãäÖí); if ($this->isParentOf($B‰çéãäÖí, $dˆŠ‘°Ñ×˜)) { return !1; } goto F‚æ‹Ûœ á; F…§«ŞòÒ÷: $this->folderSizeReset($dˆŠ‘°Ñ×˜); $Aİ“„Ë»ÆÆ = array($FíÒ°Ù¨¼[$bÆöçÙìÏé[479]], $dˆŠ‘°Ñ×˜); if ($FíÒ°Ù¨¼[$bÆöçÙìÏé[404]] == $bÆöçÙìÏé[87]) { $Aİ“„Ë»ÆÆ[] = $B‰çéãäÖí; } goto cÒ¸ÛìÔó˜; FºÂ¹Úß„Ğ: $this->lockMoveEnd($B‰çéãäÖí); $this->lockWriteEnd($dˆŠ‘°Ñ×˜, $c…öƒ£ïÇ); $this->folderSizeReset($FíÒ°Ù¨¼[$bÆöçÙìÏé[479]]); goto F…§«ŞòÒ÷; AÉ‰—¸óÃò: $cÄ¤ÍÇ“ƒ… = $this->fileNameExistCache($dˆŠ‘°Ñ×˜, $FíÒ°Ù¨¼[$bÆöçÙìÏé[28]]); $a¡å“ğ‡“× = $this->_move($B‰çéãäÖí, $dˆŠ‘°Ñ×˜, $fİ¤ó½ëµ, $F”Ì®ˆ®æê, $f”¥‘÷Ó«¬); $this->sourceCacheClear(); goto béÒãÎÃ›; cŒÊ¼Øİò: if ($FíÒ°Ù¨¼[$bÆöçÙìÏé[479]] == $dˆŠ‘°Ñ×˜ && $f”¥‘÷Ó«¬ != $FíÒ°Ù¨¼[$bÆöçÙìÏé[28]]) { $C¾›†¨ê÷ = $this->fileNameExist($dˆŠ‘°Ñ×˜, $f”¥‘÷Ó«¬); if ($C¾›†¨ê÷ && $FíÒ°Ù¨¼[$bÆöçÙìÏé[404]] == $bÆöçÙìÏé[191]) { goto eèÙŸŞ÷; eèÙŸŞ÷: $fºš÷¾  = $this->sourceInfo($C¾›†¨ê÷); $fÂ´ÈÊì×Ô = $this->fileHistory($fºš÷¾ , $FíÒ°Ù¨¼[$bÆöçÙìÏé[448]], $FíÒ°Ù¨¼[$bÆöçÙìÏé[78]]); if (!$fÂ´ÈÊì×Ô) { Model($bÆöçÙìÏé[451])->remove($FíÒ°Ù¨¼[$bÆöçÙìÏé[448]]); } goto fÖÜ±ê‡Ÿ; fÖÜ±ê‡Ÿ: $this->removeNow($B‰çéãäÖí, !1); $this->folderSizeReset($dˆŠ‘°Ñ×˜); Hook::trigger($bÆöçÙìÏé[573], $bìÌ§øŸÚŠ); goto Bóá—»æ†‹; Bóá—»æ†‹: return $C¾›†¨ê÷; goto dØ‚«Â’†¥; dØ‚«Â’†¥: } } $c…öƒ£ïÇ = $f”¥‘÷Ó«¬ ? $f”¥‘÷Ó«¬ : $FíÒ°Ù¨¼[$bÆöçÙìÏé[28]]; $this->lockMoveStart($B‰çéãäÖí); goto BÅÔßÓî; e‚™·ŞÍè´: } private function _move($b°‘¬ºò¶Ñ, $Dƒ©Èê÷×¤, $A¾öÚ“º½Ö, &$cƒºè›†–ô, $fÁ÷Å«ÆÛ = '') { goto D¢ß®ßìí; Eó°°³ÓöÛ: $DÆã°á˜ùé = $fÁ÷Å«ÆÛ ? $fÁ÷Å«ÆÛ : $B¹îÊ¯Š§[$FéºöÚ®Ø•[28]]; $B¶ÅÎÔ—ÎÑ = $this->fileNameExistCache($Dƒ©Èê÷×¤, $DÆã°á˜ùé); $this->lockMoveStart($b°‘¬ºò¶Ñ); goto a‘­¿¦òõ; e‘à¢Ò¶: $Fªİáº¾‘Ÿ = !1; if ($FÆôôª¿—) { if ($A¾öÚ“º½Ö == REPEAT_RENAME_FOLDER) { $DÆã°á˜ùé = $this->fileNameAuto($Dƒ©Èê÷×¤, $DÆã°á˜ùé, $A¾öÚ“º½Ö, $FÆôôª¿—); $Bøó¸Ç©À¾ = $this->_moveForce($b°‘¬ºò¶Ñ, $Dƒ©Èê÷×¤, $DÆã°á˜ùé); } else { if ($A¾öÚ“º½Ö == REPEAT_RENAME_FOLDER) { $A¾öÚ“º½Ö = REPEAT_RENAME; } $Eß¤™Á±¬á = $this->_childrenListSelect($b°‘¬ºò¶Ñ); foreach ($Eß¤™Á±¬á as $B×³ŒÒÚ¢) { $this->_move($B×³ŒÒÚ¢[$FéºöÚ®Ø•[396]], $B¶ÅÎÔ—ÎÑ, $A¾öÚ“º½Ö, $cƒºè›†–ô); } $Fªİáº¾‘Ÿ = !0; } } else { if ($A¾öÚ“º½Ö == REPEAT_SKIP) { $Fªİáº¾‘Ÿ = !0; } else { if ($A¾öÚ“º½Ö == REPEAT_RENAME || $A¾öÚ“º½Ö == REPEAT_RENAME_FOLDER) { $DÆã°á˜ùé = $this->fileNameAuto($Dƒ©Èê÷×¤, $DÆã°á˜ùé, $A¾öÚ“º½Ö, $FÆôôª¿—); $Bøó¸Ç©À¾ = $this->_moveForce($b°‘¬ºò¶Ñ, $Dƒ©Èê÷×¤, $DÆã°á˜ùé); } else { if ($A¾öÚ“º½Ö == REPEAT_REPLACE) { $Eµ‚Æ¬®Ô = $this->sourceInfoCache($B¶ÅÎÔ—ÎÑ); $E—À×ÂÉ«ê = $this->fileHistory($Eµ‚Æ¬®Ô, $B¹îÊ¯Š§[$FéºöÚ®Ø•[448]], $B¹îÊ¯Š§[$FéºöÚ®Ø•[78]]); if ($E—À×ÂÉ«ê) { $cƒºè›†–ô[$FéºöÚ®Ø•[543]][] = $B¹îÊ¯Š§[$FéºöÚ®Ø•[448]]; } else { $Fªİáº¾‘Ÿ = !0; } } } } } if ($Fªİáº¾‘Ÿ && !$cƒºè›†–ô[$FéºöÚ®Ø•[574]]) { $cƒºè›†–ô[$FéºöÚ®Ø•[574]] = !0; } goto EÈ¦Ëó«¸Ù; EÈ¦Ëó«¸Ù: return $Bøó¸Ç©À¾; goto C¨‘È½ÊÆ; a‘­¿¦òõ: $this->lockWriteStart($Dƒ©Èê÷×¤, $DÆã°á˜ùé); if (!$B¶ÅÎÔ—ÎÑ) { return $this->_moveForce($b°‘¬ºò¶Ñ, $Dƒ©Èê÷×¤, $DÆã°á˜ùé); } $Bøó¸Ç©À¾ = $B¶ÅÎÔ—ÎÑ; goto e‘à¢Ò¶; D¢ß®ßìí: $FéºöÚ®Ø• =& $_SERVER[ªúæÂ¡­ä½]; $B¹îÊ¯Š§ = $this->sourceInfo($b°‘¬ºò¶Ñ); $FÆôôª¿— = $B¹îÊ¯Š§[$FéºöÚ®Ø•[404]] == $FéºöÚ®Ø•[87]; goto Eó°°³ÓöÛ; C¨‘È½ÊÆ: } private function _moveForce($a£†Äô„›é, $Cé¡ÀÍ§‚, $EÒÊ…Âò¡¹) { goto c†ÖË¾; AŠ£‰ÒĞ…—: $BÉÀ×ô´ = $E˜„õ†ñ‰[$fòÕ¨µê“õ[404]] == $fòÕ¨µê“õ[87]; $C–†µ¸…¢ = array($fòÕ¨µê“õ[395] => $FõÃãïÔ¶«[$fòÕ¨µê“õ[396]], $fòÕ¨µê“õ[567] => $FõÃãïÔ¶«[$fòÕ¨µê“õ[503]] . $FõÃãïÔ¶«[$fòÕ¨µê“õ[396]] . $fòÕ¨µê“õ[47], $fòÕ¨µê“õ[563] => $FõÃãïÔ¶«[$fòÕ¨µê“õ[405]], $fòÕ¨µê“õ[564] => $FõÃãïÔ¶«[$fòÕ¨µê“õ[485]], $fòÕ¨µê“õ[566] => USER_ID, $fòÕ¨µê“õ[414] => $EÒÊ…Âò¡¹); $AØàİ¡”ï = $E˜„õ†ñ‰[$fòÕ¨µê“õ[405]] == SourceModel::TYPE_GROUP && $FõÃãïÔ¶«[$fòÕ¨µê“õ[405]] == SourceModel::TYPE_GROUP && $E˜„õ†ñ‰[$fòÕ¨µê“õ[485]] == $FõÃãïÔ¶«[$fòÕ¨µê“õ[485]]; goto f°®ƒÒğÉ²; DŞ¾ñŞƒˆÏ: if ($BÉÀ×ô´) { $e„‚ïç”Öµ = array($fòÕ¨µê“õ[567] => array($fòÕ¨µê“õ[526], $E˜„õ†ñ‰[$fòÕ¨µê“õ[503]] . $E˜„õ†ñ‰[$fòÕ¨µê“õ[396]] . $fòÕ¨µê“õ[527])); $CÄ»ÎÑ‹§ = $E˜„õ†ñ‰[$fòÕ¨µê“õ[503]] . $E˜„õ†ñ‰[$fòÕ¨µê“õ[396]] . $fòÕ¨µê“õ[47]; $Cï„¸¶êù¸ = $FõÃãïÔ¶«[$fòÕ¨µê“õ[503]] . $FõÃãïÔ¶«[$fòÕ¨µê“õ[396]] . $fòÕ¨µê“õ[47] . $E˜„õ†ñ‰[$fòÕ¨µê“õ[396]] . $fòÕ¨µê“õ[47]; $C¿Ì«¤øµè = array($fòÕ¨µê“õ[567] => array($fòÕ¨µê“õ[575], "\x72\145\x70\154\141\143\x65\x28\160\141\162\x65\156\164\114\145\166\x65\x6c\x2c\x27{$CÄ»ÎÑ‹§}\x27\x2c\x27{$Cï„¸¶êù¸}\47\x29"), $fòÕ¨µê“õ[563] => $FõÃãïÔ¶«[$fòÕ¨µê“õ[405]], $fòÕ¨µê“õ[564] => $FõÃãïÔ¶«[$fòÕ¨µê“õ[485]]); if ($aÓ˜ÀóÛ¡) { $C¿Ì«¤øµè[$fòÕ¨µê“õ[423]] = 0; } $this->where($e„‚ïç”Öµ)->data($C¿Ì«¤øµè)->save(); } $this->where(array($fòÕ¨µê“õ[411] => $a£†Äô„›é))->data($C–†µ¸…¢)->save(); return $a£†Äô„›é; goto eîçÇ”®ñª; f°®ƒÒğÉ²: if (!$AØàİ¡”ï && $this->moveClearAuth) { Model($fòÕ¨µê“õ[483])->authClear($a£†Äô„›é); } $aÓ˜ÀóÛ¡ = $E˜„õ†ñ‰[$fòÕ¨µê“õ[424]] == $fòÕ¨µê“õ[87] && $FõÃãïÔ¶«[$fòÕ¨µê“õ[424]] != $fòÕ¨µê“õ[87]; if ($aÓ˜ÀóÛ¡) { $C–†µ¸…¢[$fòÕ¨µê“õ[423]] = 0; } goto DŞ¾ñŞƒˆÏ; c†ÖË¾: $fòÕ¨µê“õ =& $_SERVER[ªúæÂ¡­ä½]; $E˜„õ†ñ‰ = $this->sourceInfo($a£†Äô„›é); $FõÃãïÔ¶« = $this->sourceInfo($Cé¡ÀÍ§‚); goto AŠ£‰ÒĞ…—; eîçÇ”®ñª: } private function clearShare($aõÔ«³˜, $a¯îÕ‹¦ß‚) { goto CŒ¾„Ñß½; dó¡¢¼³¢: if ($dù††ÄÀ‹[$cÒ“Íƒ„ƒ[485]] == $F”¤è–‡Œ[$cÒ“Íƒ„ƒ[485]] && $dù††ÄÀ‹[$cÒ“Íƒ„ƒ[405]] == $cÒ“Íƒ„ƒ[576]) { return; } $BËÛÓ¥¬ø = array($cÒ“Íƒ„ƒ[503] => array($cÒ“Íƒ„ƒ[526], $dù††ÄÀ‹[$cÒ“Íƒ„ƒ[503]] . $aõÔ«³˜ . $cÒ“Íƒ„ƒ[527])); $e¬å¹™”°î = $this->field($cÒ“Íƒ„ƒ[411])->where($BËÛÓ¥¬ø)->getField($cÒ“Íƒ„ƒ[396], !0); goto bÏÖëì‡ÈÖ; Eƒ‚è¾µª: Model($cÒ“Íƒ„ƒ[577])->where($BËÛÓ¥¬ø)->save(array($cÒ“Íƒ„ƒ[476] => 0)); Model($cÒ“Íƒ„ƒ[578])->where($BËÛÓ¥¬ø)->delete(); goto AÏÆ«Î’ŞÔ; bÏÖëì‡ÈÖ: if (!$e¬å¹™”°î) { return; } $BËÛÓ¥¬ø = array($cÒ“Íƒ„ƒ[396] => array($cÒ“Íƒ„ƒ[7], $e¬å¹™”°î), $cÒ“Íƒ„ƒ[476] => 1); $F¢¯œ¶³ÔŞ = Model($cÒ“Íƒ„ƒ[577])->field($cÒ“Íƒ„ƒ[469])->where($BËÛÓ¥¬ø)->select(); goto dò¡¡ƒÈ±ä; dò¡¡ƒÈ±ä: if (!$F¢¯œ¶³ÔŞ) { return; } $F¢¯œ¶³ÔŞ = array_to_keyvalue($F¢¯œ¶³ÔŞ, $cÒ“Íƒ„ƒ[33], $cÒ“Íƒ„ƒ[469]); $BËÛÓ¥¬ø = array($cÒ“Íƒ„ƒ[469] => array($cÒ“Íƒ„ƒ[7], $F¢¯œ¶³ÔŞ)); goto Eƒ‚è¾µª; CŒ¾„Ñß½: $cÒ“Íƒ„ƒ =& $_SERVER[ªúæÂ¡­ä½]; $dù††ÄÀ‹ = $this->sourceInfo($aõÔ«³˜); $F”¤è–‡Œ = $this->sourceInfo($a¯îÕ‹¦ß‚); goto dó¡¢¼³¢; AÏÆ«Î’ŞÔ: } public function copyFolderFromIO($dÊ½Óšº›î, $a½›Òí—ñî, $EÖğù¨§¾ï, $cÈäàÁóÍğ, $e¾‰è‡êÇ¬, $d¨è‘ÕÑ = false) { goto eïÅƒ…¢Øï; a‰±‚¯ÏŸ: $aË•Ñ¥Ñ“ˆ = $this->fileNameExist($EÖğù¨§¾ï, $b…‘óÍ ãè); $eíÈî§÷Î = $this->mkdir($EÖğù¨§¾ï, $b…‘óÍ ãè, $cÈäàÁóÍğ); if (!$aË•Ñ¥Ñ“ˆ || $cÈäàÁóÍğ == REPEAT_RENAME_FOLDER) { $cÈäàÁóÍğ = !1; } goto e³íĞâÃĞÛ; e³íĞâÃĞÛ: if ($aË•Ñ¥Ñ“ˆ) { $this->_childrenAllMake($aË•Ñ¥Ñ“ˆ); } Hook::trigger($e¬‘ãŠÕŠõ[580]); $this->_copyChildTo($dÊ½Óšº›î, $a½›Òí—ñî, $eíÈî§÷Î, $cÈäàÁóÍğ, $FŠƒ¤Ç­ÀŒ, $e¾‰è‡êÇ¬); goto dÊïÍÍí’š; dÊïÍÍí’š: Hook::trigger($e¬‘ãŠÕŠõ[581]); if ($eíÈî§÷Î) { $this->folderSizeResetChildren($eíÈî§÷Î); } $this->_childrenListClear(); goto cÙ¨¶Êƒ; eïÅƒ…¢Øï: $e¬‘ãŠÕŠõ =& $_SERVER[ªúæÂ¡­ä½]; $FŠƒ¤Ç­ÀŒ = array($e¬‘ãŠÕŠõ[544] => array(), $e¬‘ãŠÕŠõ[545] => array(), $e¬‘ãŠÕŠõ[543] => array(), $e¬‘ãŠÕŠõ[579] => array()); $b…‘óÍ ãè = $d¨è‘ÕÑ ? $d¨è‘ÕÑ : $dÊ½Óšº›î->pathThis($a½›Òí—ñî); goto a‰±‚¯ÏŸ; cÙ¨¶Êƒ: Model($e¬‘ãŠÕŠõ[546])->addAll($FŠƒ¤Ç­ÀŒ[$e¬‘ãŠÕŠõ[544]], array(), !0); Model($e¬‘ãŠÕŠõ[547])->eventCopy($eíÈî§÷Î); $this->saveAll($FŠƒ¤Ç­ÀŒ[$e¬‘ãŠÕŠõ[545]]); goto cŸê’¦ˆÚÂ; CÁ†´ Œë›: $this->updateModifyTime($EÖğù¨§¾ï); return $eíÈî§÷Î; goto A¸ĞƒÜÜÉ; cŸê’¦ˆÚÂ: Model($e¬‘ãŠÕŠõ[451])->linkAdd($FŠƒ¤Ç­ÀŒ[$e¬‘ãŠÕŠõ[543]]); Model($e¬‘ãŠÕŠõ[451])->remove($FŠƒ¤Ç­ÀŒ[$e¬‘ãŠÕŠõ[579]]); $this->folderSizeReset($EÖğù¨§¾ï); goto CÁ†´ Œë›; A¸ĞƒÜÜÉ: } private function _copyChildTo($eªàïÙ§¥ˆ, $E©ËË¥‡ßÄ, $FŒ©„ÒµÜ, $a¿Ä¶ÜÙß¬, &$bµ—¿¬‹Ã§, $AÙ…ÙÖƒ´¦) { goto D¡ô´Æ†ÂÇ; Eºç‡¢¢: $f£¼Ü¶‡Ê = $f£¼Ü¶‡Ê ? $f£¼Ü¶‡Ê : array($EÊ‰»œÔ¹µ[74] => array(), $EÊ‰»œÔ¹µ[75] => array()); $C„‡ïÓ¡³ = array_merge($f£¼Ü¶‡Ê[$EÊ‰»œÔ¹µ[74]], $f£¼Ü¶‡Ê[$EÊ‰»œÔ¹µ[75]]); $e‘…à¨„ = $this->_addFiles($eªàïÙ§¥ˆ, $f£¼Ü¶‡Ê[$EÊ‰»œÔ¹µ[74]], $AÙ…ÙÖƒ´¦); goto C‘’„ÂÉÆİ; C‘’„ÂÉÆİ: $bƒ ÚâØèĞ = array(); foreach ($C„‡ïÓ¡³ as &$aùÁôŞˆ‹š) { goto EùŞ–‚Œƒò; EùŞ–‚Œƒò: if (isset($e‘…à¨„[$aùÁôŞˆ‹š[$EÊ‰»œÔ¹µ[28]]])) { $aùÁôŞˆ‹š = $e‘…à¨„[$aùÁôŞˆ‹š[$EÊ‰»œÔ¹µ[28]]]; } $aùÁôŞˆ‹š[$EÊ‰»œÔ¹µ[404]] = $aùÁôŞˆ‹š[$EÊ‰»œÔ¹µ[29]] == $EÊ‰»œÔ¹µ[77]; $aùÁôŞˆ‹š[$EÊ‰»œÔ¹µ[406]] = _get($aùÁôŞˆ‹š, $EÊ‰»œÔ¹µ[168], $EÊ‰»œÔ¹µ[33]); goto FÙá•ëˆ¯Ô; FÙá•ëˆ¯Ô: $aùÁôŞˆ‹š[$EÊ‰»œÔ¹µ[78]] = _get($aùÁôŞˆ‹š, $EÊ‰»œÔ¹µ[78], 0); $aùÁôŞˆ‹š[$EÊ‰»œÔ¹µ[448]] = _get($aùÁôŞˆ‹š, $EÊ‰»œÔ¹µ[448], 0); if (!isset($aùÁôŞˆ‹š[$EÊ‰»œÔ¹µ[582]]) && $aùÁôŞˆ‹š[$EÊ‰»œÔ¹µ[448]]) { $bµ—¿¬‹Ã§[$EÊ‰»œÔ¹µ[579]][] = $aùÁôŞˆ‹š[$EÊ‰»œÔ¹µ[448]]; } goto CÄ”ÙÊêì; CÄ”ÙÊêì: if ($a¿Ä¶ÜÙß¬) { $AÏÏğšóøÑ = $this->fileNameExistCache($FŒ©„ÒµÜ, $aùÁôŞˆ‹š[$EÊ‰»œÔ¹µ[28]]); if ($AÏÏğšóøÑ) { if ($aùÁôŞˆ‹š[$EÊ‰»œÔ¹µ[404]] || $a¿Ä¶ÜÙß¬ == REPEAT_SKIP) { continue; } if ($a¿Ä¶ÜÙß¬ == REPEAT_REPLACE) { $c‰åÒ‚Á•î = $this->sourceInfoCache($AÏÏğšóøÑ); $c¯öÎ¤äÂ = $this->fileHistory($c‰åÒ‚Á•î, $aùÁôŞˆ‹š[$EÊ‰»œÔ¹µ[448]], $aùÁôŞˆ‹š[$EÊ‰»œÔ¹µ[78]]); if ($c¯öÎ¤äÂ) { $bµ—¿¬‹Ã§[$EÊ‰»œÔ¹µ[543]][] = $aùÁôŞˆ‹š[$EÊ‰»œÔ¹µ[448]]; } continue; } else { if ($a¿Ä¶ÜÙß¬ == REPEAT_RENAME) { $aùÁôŞˆ‹š[$EÊ‰»œÔ¹µ[28]] = $this->fileNameAutoCache($FŒ©„ÒµÜ, $aùÁôŞˆ‹š[$EÊ‰»œÔ¹µ[28]], $a¿Ä¶ÜÙß¬, !1); } } } } if (!$aùÁôŞˆ‹š[$EÊ‰»œÔ¹µ[404]] && $aùÁôŞˆ‹š[$EÊ‰»œÔ¹µ[448]]) { $bµ—¿¬‹Ã§[$EÊ‰»œÔ¹µ[543]][] = $aùÁôŞˆ‹š[$EÊ‰»œÔ¹µ[448]]; } $bƒ ÚâØèĞ[] = $this->_makeItemData($aùÁôŞˆ‹š, $eéÙ¶İÈß‘, $aùÁôŞˆ‹š[$EÊ‰»œÔ¹µ[28]]); goto D¿ºÜŒ›­Ş; D¿ºÜŒ›­Ş: } unset($aùÁôŞˆ‹š); goto AÎ‹èäƒÚ„; Bå¤™°Î: foreach ($C„‡ïÓ¡³ as $aùÁôŞˆ‹š) { $c‰åÒ‚Á•î = $E£¡§—ÍŠ¨[$aùÁôŞˆ‹š[$EÊ‰»œÔ¹µ[28]]]; $C‰…³ò½Ñ = $c‰åÒ‚Á•î[$EÊ‰»œÔ¹µ[396]]; $this->_copyApplyMeta($c‰åÒ‚Á•î, $bµ—¿¬‹Ã§); if ($aùÁôŞˆ‹š[$EÊ‰»œÔ¹µ[29]] == $EÊ‰»œÔ¹µ[77]) { $aùÁôŞˆ‹š[$EÊ‰»œÔ¹µ[76]] = $eªàïÙ§¥ˆ->getPathInner($aùÁôŞˆ‹š[$EÊ‰»œÔ¹µ[76]]); $this->_copyChildTo($eªàïÙ§¥ˆ, $aùÁôŞˆ‹š[$EÊ‰»œÔ¹µ[76]], $C‰…³ò½Ñ, $a¿Ä¶ÜÙß¬, $bµ—¿¬‹Ã§, $AÙ…ÙÖƒ´¦); } } goto føŸÔ¸ˆíÅ; AÎ‹èäƒÚ„: if (!empty($bƒ ÚâØèĞ)) { $this->addAll($bƒ ÚâØèĞ); $this->_childrenListSelect($FŒ©„ÒµÜ); } $E£¡§—ÍŠ¨ = $this->_childrenList($FŒ©„ÒµÜ); $E£¡§—ÍŠ¨ = array_to_keyvalue($E£¡§—ÍŠ¨, $EÊ‰»œÔ¹µ[28]); goto Bå¤™°Î; D¡ô´Æ†ÂÇ: $EÊ‰»œÔ¹µ =& $_SERVER[ªúæÂ¡­ä½]; $eéÙ¶İÈß‘ = $this->sourceInfoCache($FŒ©„ÒµÜ); $f£¼Ü¶‡Ê = $eªàïÙ§¥ˆ->listPath($E©ËË¥‡ßÄ); goto Eºç‡¢¢; føŸÔ¸ˆíÅ: } private function _addFiles($eßÖŸ‹éÔ•, $dÚÏ´‹ÈÊ, $b­­£²ºŸ) { goto A¶Œ°ø¶îÑ; eùÀöŠÓ: foreach ($dÚÏ´‹ÈÊ as &$A˜Œ°³™‚È) { goto CÜ£™…Ëê; D¬·Äˆ¬Èä: $C—Ğ™—ƒæ¹ = $eßÖŸ‹éÔ•->hashMd5($A˜Œ°³™‚È[$bø…á‘Èõ [76]]); if (strlen($C—Ğ™—ƒæ¹) > 10 && !isset($B¥òŒ†‘ï[$C—Ğ™—ƒæ¹])) { $B¥òŒ†‘ï[$C—Ğ™—ƒæ¹] = array(); } $A˜Œ°³™‚È[$bø…á‘Èõ [171]] = $F©à²í¦Ù”; goto cìÄ›“‘½…; CÜ£™…Ëê: Hook::trigger($bø…á‘Èõ [583], $A˜Œ°³™‚È); $A˜Œ°³™‚È[$bø…á‘Èõ [76]] = $eßÖŸ‹éÔ•->getPathInner($A˜Œ°³™‚È[$bø…á‘Èõ [76]]); $F©à²í¦Ù” = $eßÖŸ‹éÔ•->hashSimple($A˜Œ°³™‚È[$bø…á‘Èõ [76]]); goto D¬·Äˆ¬Èä; cìÄ›“‘½…: $A˜Œ°³™‚È[$bø…á‘Èõ [170]] = $C—Ğ™—ƒæ¹; Hook::trigger($bø…á‘Èõ [584], $A˜Œ°³™‚È); $B¥òŒ†‘ï[$C—Ğ™—ƒæ¹][] =& $A˜Œ°³™‚È; goto BÄÎ»Ò“; BÄÎ»Ò“: if (count($B¥òŒ†‘ï[$C—Ğ™—ƒæ¹]) > 1) { $A˜Œ°³™‚È[$bø…á‘Èõ [582]] = !0; } goto dÍŸ†Òó£Â; dÍŸ†Òó£Â: } unset($A˜Œ°³™‚È); $Bª ˆèÏ³ = array($bø…á‘Èõ [170] => array($bø…á‘Èõ [7], array_keys($B¥òŒ†‘ï))); goto bŞÃŠ–œÇ»; Aµ†…ß½ğ: foreach ($dÚÏ´‹ÈÊ as $E¤áåŠÃÀº) { $B‹éŠõÂÄ†[$E¤áåŠÃÀº[$bø…á‘Èõ [28]]] = $E¤áåŠÃÀº; } return $B‹éŠõÂÄ†; goto D—À¥ÕÂîğ; aÇÑ—‹ˆÂ‹: $dƒ£Ğ£Øå• = $dƒ£Ğ£Øå• ? $dƒ£Ğ£Øå• : array(); foreach ($dƒ£Ğ£Øå• as $CÅóî÷‡‰) { if (!isset($B¥òŒ†‘ï[$CÅóî÷‡‰[$bø…á‘Èõ [170]]])) { continue; } $aŸÏé·éÔŠ =& $B¥òŒ†‘ï[$CÅóî÷‡‰[$bø…á‘Èõ [170]]]; foreach ($aŸÏé·éÔŠ as &$A˜Œ°³™‚È) { $A˜Œ°³™‚È[$bø…á‘Èõ [448]] = $CÅóî÷‡‰[$bø…á‘Èõ [448]]; } unset($A˜Œ°³™‚È); } $B‹éŠõÂÄ† = array(); goto Aµ†…ß½ğ; eÉ¾ˆ§ÚŒœ: foreach ($dƒ£Ğ£Øå• as $CÅóî÷‡‰) { if (!isset($B¥òŒ†‘ï[$CÅóî÷‡‰[$bø…á‘Èõ [170]]])) { continue; } $CÉ¢‡†¶Ä = $B¥òŒ†‘ï[$CÅóî÷‡‰[$bø…á‘Èõ [170]]]; foreach ($CÉ¢‡†¶Ä as &$A˜Œ°³™‚È) { $A˜Œ°³™‚È[$bø…á‘Èõ [448]] = $CÅóî÷‡‰[$bø…á‘Èõ [448]]; $A˜Œ°³™‚È[$bø…á‘Èõ [582]] = !0; } unset($A˜Œ°³™‚È); } $c†çÏŠÃ = array(); foreach ($dÚÏ´‹ÈÊ as $cÑ©Ñ—àÇ) { if (isset($cÑ©Ñ—àÇ[$bø…á‘Èõ [582]]) && $cÑ©Ñ—àÇ[$bø…á‘Èõ [582]]) { continue; } $côÊÛÅšØ‘ = $eßÖŸ‹éÔ•->getPathInner($cÑ©Ñ—àÇ[$bø…á‘Èõ [76]]); $EØ‡¾†Éçå = $DÔ„“ÒğµŒ->addFileMake($côÊÛÅšØ‘, $cÑ©Ñ—àÇ[$bø…á‘Èõ [78]], $cÑ©Ñ—àÇ[$bø…á‘Èõ [171]], $cÑ©Ñ—àÇ[$bø…á‘Èõ [170]], $cÑ©Ñ—àÇ[$bø…á‘Èõ [28]], $b­­£²ºŸ); $c†çÏŠÃ[] = $EØ‡¾†Éçå; } goto dºêŒŠˆ“í; dºêŒŠˆ“í: $DÔ„“ÒğµŒ->addAll($c†çÏŠÃ); $Bª ˆèÏ³ = array($bø…á‘Èõ [170] => array($bø…á‘Èõ [7], array_keys($B¥òŒ†‘ï))); $dƒ£Ğ£Øå• = $DÔ„“ÒğµŒ->where($Bª ˆèÏ³)->select(); goto aÇÑ—‹ˆÂ‹; A¶Œ°ø¶îÑ: $bø…á‘Èõ  =& $_SERVER[ªúæÂ¡­ä½]; if (!$dÚÏ´‹ÈÊ || count($dÚÏ´‹ÈÊ) == 0) { return array(); } $B¥òŒ†‘ï = array(); goto eùÀöŠÓ; bŞÃŠ–œÇ»: $DÔ„“ÒğµŒ = Model($bø…á‘Èõ [585]); $dƒ£Ğ£Øå• = $DÔ„“ÒğµŒ->where($Bª ˆèÏ³)->select(); $dƒ£Ğ£Øå• = $dƒ£Ğ£Øå• ? $dƒ£Ğ£Øå• : array(); goto eÉ¾ˆ§ÚŒœ; D—À¥ÕÂîğ: } } define($_SERVER[ªúæÂ¡­ä½][586], $_SERVER[ªúæÂ¡­ä½][587]); goto bÛˆ÷İè¬; Dƒ‹¨èËÍ¾: class ModelBase extends Model { const SQL_WHERE_IN_CHUNK = 2000; protected $dataAuto = array(array("\x6d\157\144\x69\x66\171\124\151\x6d\145", "\164\151\x6d\x65", "\x69\x6e\x73\145\x72\x74\54\165\160\x64\141\x74\145", "\x66\x75\156\143\x74\151\x6f\156"), array("\143\x72\x65\x61\164\x65\124\x69\155\145", "\164\151\155\x65", "\151\x6e\x73\x65\162\x74", "\146\165\156\x63\164\151\x6f\x6e")); public function setDataAuto($BÄä’‰ÅÓ) { $this->dataAuto = $BÄä’‰ÅÓ; } public function __construct($D£÷ßÈ¡„¾ = '', $EÌ‰âĞï¿› = '', $bòÉæ˜×Éù = '') { parent::__construct($D£÷ßÈ¡„¾, $EÌ‰âĞï¿›, $bòÉæ˜×Éù); } protected $tableMeta = array(); protected function _beforeInsert(&$AÜ±™³ì, $dÄÆá½Ğ¨) { $FÕ¹Ä‡  =& $_SERVER[ªúæÂ¡­ä½]; if (!$this->checkDataAutoHas($FÕ¹Ä‡ [353])) { return; } $this->dataBeforeFilter($AÜ±™³ì, $FÕ¹Ä‡ [353]); } protected function _beforeUpdate(&$C†‹îØ›ê, $BâŞ±ì®Ê) { $C·ÁçĞËƒ =& $_SERVER[ªúæÂ¡­ä½]; if (!$this->checkDataAutoHas($C·ÁçĞËƒ[354])) { return; } $this->dataBeforeFilter($C†‹îØ›ê, $C·ÁçĞËƒ[354]); } protected function _afterSelect(&$f¶¢¢¼ì¡Œ, $d‹ÜÇùç«–) { if (!is_array($f¶¢¢¼ì¡Œ)) { return; } if (!$this->checkDataAutoHas($_SERVER[ªúæÂ¡­ä½][355])) { return; } foreach ($f¶¢¢¼ì¡Œ as &$BØ†Øä‘„×) { $this->dataAfterFilter($BØ†Øä‘„×); } unset($BØ†Øä‘„×); } protected function _afterFind(&$eÕÃ¢¼˜ÏÓ, $f™¥¡ñå©¢) { if (!is_array($eÕÃ¢¼˜ÏÓ)) { return; } if (!$this->checkDataAutoHas($_SERVER[ªúæÂ¡­ä½][355])) { return; } $this->dataAfterFilter($eÕÃ¢¼˜ÏÓ); } public static function textEncode($e¼—†ÅÓ‰—) { if (!$e¼—†ÅÓ‰—) { return $e¼—†ÅÓ‰—; } $Cİ¨·ÇÔÊ = json_encode($e¼—†ÅÓ‰—); $Cİ¨·ÇÔÊ = preg_replace_callback($_SERVER[ªúæÂ¡­ä½][356], function ($FªÕ´í¼Œ) { return addslashes($FªÕ´í¼Œ[0]); }, $Cİ¨·ÇÔÊ); return json_decode($Cİ¨·ÇÔÊ); } public static function textDecode($fä‘£–½¾) { $FîÖÚÍÁâÉ =& $_SERVER[ªúæÂ¡­ä½]; $CÂìÃ‹§³× = json_encode($fä‘£–½¾); $CÂìÃ‹§³× = preg_replace_callback($FîÖÚÍÁâÉ[357], function ($eóíÃµÁ˜) { return $_SERVER[ªúæÂ¡­ä½][97]; }, $CÂìÃ‹§³×); return json_decode($CÂìÃ‹§³×); } public function setAutoIncrement($b‚›†»‡¼) { $aã‡ÀŒÎô = array($this->getPk() => $b‚›†»‡¼); $Dö²Ï¸ºµ = $this->data($aã‡ÀŒÎô)->add(); if ($Dö²Ï¸ºµ) { $this->delete($Dö²Ï¸ºµ); } } public function getAutoIncrement() { $b¬³êãÌŒ = $this->getTableName(); $C‡†´½¼Œ = $this->max($this->getPk()); $A¶ùÄ½Öœ = $this->query("\x73\x68\x6f\x77\40\164\x61\142\x6c\145\40\163\x74\x61\x74\x75\163\x20\167\150\145\x72\x65\40\x4e\141\x6d\x65\x3d\47{$b¬³êãÌŒ}\47"); $c¸¼¯ù÷ˆŒ = $A¶ùÄ½Öœ[0][$_SERVER[ªúæÂ¡­ä½][358]]; $C‘¤™÷¨¹ = max($C‡†´½¼Œ, $c¸¼¯ù÷ˆŒ); return $C‘¤™÷¨¹; } protected function _callBefore($e›‘±ˆ´¡¾, $A°²õç½ò) { return $this->cacheCallCheck($e›‘±ˆ´¡¾, $A°²õç½ò, !1); } protected function _callAfter($B§¼øÚÕÛ, $cÇ±Îß¯¬) { return $this->cacheCallCheck($B§¼øÚÕÛ, $cÇ±Îß¯¬, !0); } protected function cacheFunctionAlias($eôÏæùÄœ) { return !1; } public function cacheMemory() { return $this->cache(null, 0); } protected function cacheCallCheck($E’……ôÌ×, $E×Ò­èÇ¹Ü, $cÒğİ¶Û« = false) { $eè£Áõñª = $this->cacheFunctionAlias($E×Ò­èÇ¹Ü); if (!$eè£Áõñª) { return; } foreach ($eè£Áõñª as $DöåÏĞÉ£ß => $fÌ˜å’›µò) { $Bùâ …ÃÅ = $fÌ˜å’›µò[0]; $A¬—ÏÔŠ»ì = explode($_SERVER[ªúæÂ¡­ä½][47], $fÌ˜å’›µò[1]); if ($E’……ôÌ× == $DöåÏĞÉ£ß) { return $this->cacheFunctionGet($DöåÏĞÉ£ß, $Bùâ …ÃÅ); } if ($cÒğİ¶Û« && in_array($E’……ôÌ×, $A¬—ÏÔŠ»ì)) { $this->cacheFunctionClear($DöåÏĞÉ£ß, $Bùâ …ÃÅ); } } } public function cacheFunctionGet($bÛğŒàøíŒ, $Eî–ã³ï…Æ) { $f†‡«›ÌÖğ = $this->cacheKeyMake($bÛğŒàøíŒ, $Eî–ã³ï…Æ); $b°à¥š¸á˜ = Cache::get($f†‡«›ÌÖğ); if (!is_array($b°à¥š¸á˜)) { $b°à¥š¸á˜ = call_user_func_array(array($this, $bÛğŒàøíŒ), array($Eî–ã³ï…Æ, !0)); Cache::set($f†‡«›ÌÖğ, $b°à¥š¸á˜); } return $b°à¥š¸á˜; } public function cacheFunctionClear($E›…­øˆÜˆ, $cŠ×Š––õ¥) { $E‘¯Æ¾…˜Ş = $cŠ×Š––õ¥; if (!is_array($cŠ×Š––õ¥)) { $E‘¯Æ¾…˜Ş = array($cŠ×Š––õ¥); } foreach ($E‘¯Æ¾…˜Ş as $C™¯™±ôÅ‘) { $B««éÇÀè‰ = $this->cacheKeyMake($E›…­øˆÜˆ, $C™¯™±ôÅ‘); Cache::remove($B««éÇÀè‰); } } private function cacheKeyMake($fšÛÁ¯Õ’, $fôøä¬ù›Œ) { $d¥ÜˆùÀ±å =& $_SERVER[ªúæÂ¡­ä½]; return get_class($this) . $d¥ÜˆùÀ±å[71] . $fšÛÁ¯Õ’ . $d¥ÜˆùÀ±å[359] . $fôøä¬ù›Œ; } protected function selectPageReset() { $fëôÈ¹¤ =& $_SERVER[ªúæÂ¡­ä½]; if (isset($GLOBALS[$fëôÈ¹¤[360]])) { return; } $GLOBALS[$fëôÈ¹¤[360]] = isset($GLOBALS[$fëôÈ¹¤[7]][$fëôÈ¹¤[361]]) ? $GLOBALS[$fëôÈ¹¤[7]][$fëôÈ¹¤[361]] : !1; $GLOBALS[$fëôÈ¹¤[362]] = isset($GLOBALS[$fëôÈ¹¤[7]][$fëôÈ¹¤[351]]) ? $GLOBALS[$fëôÈ¹¤[7]][$fëôÈ¹¤[351]] : !1; $GLOBALS[$fëôÈ¹¤[7]][$fëôÈ¹¤[361]] = !1; $GLOBALS[$fëôÈ¹¤[7]][$fëôÈ¹¤[351]] = !1; } protected function selectPageRestore() { $E¢›‚÷ã…´ =& $_SERVER[ªúæÂ¡­ä½]; if (!isset($GLOBALS[$E¢›‚÷ã…´[360]])) { return; } $GLOBALS[$E¢›‚÷ã…´[7]][$E¢›‚÷ã…´[361]] = $GLOBALS[$E¢›‚÷ã…´[360]]; $GLOBALS[$E¢›‚÷ã…´[7]][$E¢›‚÷ã…´[351]] = $GLOBALS[$E¢›‚÷ã…´[362]]; unset($GLOBALS[$E¢›‚÷ã…´[360]]); unset($GLOBALS[$E¢›‚÷ã…´[362]]); } protected function selectPage($cÄ“§Á¯Ìì = 200, $bÑ–¨ÖãÃÈ = 1) { goto Dàê°ÏÅ„¨; BÙê‰Ë§ô÷: if (!is_array($EÛà¨Èºä÷)) { $EÛà¨Èºä÷ = array(); } if ($FÆİŒÇ›ªŒ == 1) { $cÓÍÑŞª = count($EÛà¨Èºä÷); } $A‰·™ÁµŞ = array($Fƒ“¨—Á”½[364] => array($Fƒ“¨—Á”½[365] => $cÓÍÑŞª, $Fƒ“¨—Á”½[361] => $cÄ“§Á¯Ìì, $Fƒ“¨—Á”½[351] => $bÑ–¨ÖãÃÈ, $Fƒ“¨—Á”½[366] => $FÆİŒÇ›ªŒ), $Fƒ“¨—Á”½[367] => $EÛà¨Èºä÷); goto fÊç‹èíê; f‚ç˜ø’Ğ§: $b×‚˜Áì•Ş = $D³£È÷á«¿; $b×‚˜Áì•Ş[$Fƒ“¨—Á”½[363]] = array(); $cÄ“§Á¯Ìì = intval($cÄ“§Á¯Ìì); goto cÇ³éæéÇ”; E¿©’¬”Èâ: $EÛà¨Èºä÷ = array(); $C´¥¯ÒÇ = 1; if ($bÑ–¨ÖãÃÈ == 1 && $C´¥¯ÒÇ) { $this->optionsValue($D³£È÷á«¿); $EÛà¨Èºä÷ = $this->page($bÑ–¨ÖãÃÈ, $cÄ“§Á¯Ìì)->select(); $cÓÍÑŞª = is_array($EÛà¨Èºä÷) ? count($EÛà¨Èºä÷) : 0; if ($cÓÍÑŞª < $cÄ“§Á¯Ìì) { $FÆİŒÇ›ªŒ = 1; } else { $this->optionsValue($b×‚˜Áì•Ş); $cÓÍÑŞª = intval($this->count()); $FÆİŒÇ›ªŒ = ceil($cÓÍÑŞª / $cÄ“§Á¯Ìì); } } else { $this->optionsValue($b×‚˜Áì•Ş); $cÓÍÑŞª = intval($this->count()); $FÆİŒÇ›ªŒ = ceil($cÓÍÑŞª / $cÄ“§Á¯Ìì); $bÑ–¨ÖãÃÈ = $bÑ–¨ÖãÃÈ >= $FÆİŒÇ›ªŒ ? $FÆİŒÇ›ªŒ : $bÑ–¨ÖãÃÈ; $this->optionsValue($D³£È÷á«¿); $EÛà¨Èºä÷ = $this->page($bÑ–¨ÖãÃÈ, $cÄ“§Á¯Ìì)->select(); } goto BÙê‰Ë§ô÷; cÇ³éæéÇ”: $cÄ“§Á¯Ìì = $cÄ“§Á¯Ìì <= 5 ? 5 : ($cÄ“§Á¯Ìì >= $FõÒ…¸—¾İ ? $FõÒ…¸—¾İ : $cÄ“§Á¯Ìì); $bÑ–¨ÖãÃÈ = intval(isset($in[$Fƒ“¨—Á”½[351]]) && $in[$Fƒ“¨—Á”½[351]] ? $in[$Fƒ“¨—Á”½[351]] : $bÑ–¨ÖãÃÈ); $bÑ–¨ÖãÃÈ = $bÑ–¨ÖãÃÈ <= 1 ? 1 : $bÑ–¨ÖãÃÈ; goto E¿©’¬”Èâ; Dàê°ÏÅ„¨: $Fƒ“¨—Á”½ =& $_SERVER[ªúæÂ¡­ä½]; global $in; $D³£È÷á«¿ = $this->optionsValue(); goto döØÅò·˜Ù; döØÅò·˜Ù: $FõÒ…¸—¾İ = 50000; $cÄ“§Á¯Ìì = isset($in[$Fƒ“¨—Á”½[361]]) && $in[$Fƒ“¨—Á”½[361]] ? $in[$Fƒ“¨—Á”½[361]] : $cÄ“§Á¯Ìì; if ($cÄ“§Á¯Ìì === -1) { $in[$Fƒ“¨—Á”½[361]] = !1; $FõÒ…¸—¾İ = 100000000; $cÄ“§Á¯Ìì = $FõÒ…¸—¾İ; } goto f‚ç˜ø’Ğ§; fÊç‹èíê: return $A‰·™ÁµŞ; goto EŒî…Ïò½ñ; EŒî…Ïò½ñ: } protected function checkLength($C™¥ÂŞŸ”æ, $Cäƒ­¯ñ†¸ = 0, $c°ÏÑ¹öÂ‡ = '') { $föÌ­‘ƒ© =& $_SERVER[ªúæÂ¡­ä½]; $Cäƒ­¯ñ†¸ = $Cäƒ­¯ñ†¸ ? $Cäƒ­¯ñ†¸ : 65536; if (!$C™¥ÂŞŸ”æ || strlen($C™¥ÂŞŸ”æ) < $Cäƒ­¯ñ†¸) { return; } $c°ÏÑ¹öÂ‡ = $c°ÏÑ¹öÂ‡ ? $c°ÏÑ¹öÂ‡ . $föÌ­‘ƒ©[68] : $föÌ­‘ƒ©[33]; show_json($c°ÏÑ¹öÂ‡ . LNG($föÌ­‘ƒ©[368]) . "\50{$Cäƒ­¯ñ†¸}\x29", !1); } protected function metaSet($cîøç„–‘, $b„äôì Ş° = null, $eé¥é‡ÑœÑ = null) { goto C¿÷Ğëª™ç; a®èãÈ÷çß: CacheLock::unlock($D…É‘¥¬½); return !0; goto f›º¾‚Ş·; Bê™Á¾ÒÖ: $fÓÆ•ÖÕö = $this->tableMeta[$c® ó¾ñ•Ö[370]]; $bòšºùñ©’ = Model($fÓÆ•ÖÕö); $d±¼ê±«‰” = array($f¿¢½Šİ„ğ => $cîøç„–‘, $c® ó¾ñ•Ö[371] => $b„äôì Ş°); goto d‘™““¤Ü; Eè†å¶‚ù¯: if (is_string($b„äôì Ş°)) { $D«â‰Œµ³Ë[$b„äôì Ş°] = $eé¥é‡ÑœÑ; } $bÇª”Ó¼Ó£ = array(); foreach ($D«â‰Œµ³Ë as $FĞÏƒø–ø => $dØ¶ìŒÃ¿Ô) { $this->checkLength($dØ¶ìŒÃ¿Ô, !1, $fÓÆ•ÖÕö . $c® ó¾ñ•Ö[4] . $FĞÏƒø–ø); $bÇª”Ó¼Ó£[] = array($f¿¢½Šİ„ğ => $cîøç„–‘, $c® ó¾ñ•Ö[93] => $FĞÏƒø–ø, $c® ó¾ñ•Ö[372] => $dØ¶ìŒÃ¿Ô); } goto F›¢Ú‘Çâº; F›¢Ú‘Çâº: $D…É‘¥¬½ = $c® ó¾ñ•Ö[373] . $this->tableMeta; CacheLock::lock($D…É‘¥¬½); $bòšºùñ©’->where(array($f¿¢½Šİ„ğ => $cîøç„–‘))->addAll($bÇª”Ó¼Ó£, array(), !0); goto a®èãÈ÷çß; d‘™““¤Ü: if (is_null($b„äôì Ş°)) { return $bòšºùñ©’->where(array($f¿¢½Šİ„ğ => $cîøç„–‘))->delete(); } if (is_null($eé¥é‡ÑœÑ) && is_string($b„äôì Ş°)) { return $bòšºùñ©’->where($d±¼ê±«‰”)->delete(); } $D«â‰Œµ³Ë = is_array($b„äôì Ş°) ? $b„äôì Ş° : array(); goto Eè†å¶‚ù¯; C¿÷Ğëª™ç: $c® ó¾ñ•Ö =& $_SERVER[ªúæÂ¡­ä½]; if (!$this->tableMeta || !$cîøç„–‘) { return !1; } $f¿¢½Šİ„ğ = $this->tableMeta[$c® ó¾ñ•Ö[369]]; goto Bê™Á¾ÒÖ; f›º¾‚Ş·: } public function metaGet($eÔ›”Ô½§Í, $aÆÆÈÃ¦Œ¤ = false) { goto aöÏãöÕÂ±; cŠµ»À­øà: $c…‰‰¶ä£ = Model($this->tableMeta[$bøš…ó…¯[370]]); if ($aÆÆÈÃ¦Œ¤) { $cˆ¤ğä”± = array($d÷¨·³¬ˆô => $eÔ›”Ô½§Í, $bøš…ó…¯[93] => $aÆÆÈÃ¦Œ¤); return $c…‰‰¶ä£->where($cˆ¤ğä”±)->getField($bøš…ó…¯[372]); } $cˆ¤ğä”± = array($d÷¨·³¬ˆô => $eÔ›”Ô½§Í); goto eĞ™ôáàò’; eĞ™ôáàò’: $EÉÕ™ÆŒîƒ = $c…‰‰¶ä£->field($bøš…ó…¯[374])->where($cˆ¤ğä”±)->select(); $EÉÕ™ÆŒîƒ = array_to_keyvalue($EÉÕ™ÆŒîƒ, $bøš…ó…¯[93], $bøš…ó…¯[372]); return $EÉÕ™ÆŒîƒ; goto cöÛ±Õ¤š„; aöÏãöÕÂ±: $bøš…ó…¯ =& $_SERVER[ªúæÂ¡­ä½]; if (!$this->tableMeta) { return array(); } $d÷¨·³¬ˆô = $this->tableMeta[$bøš…ó…¯[369]]; goto cŠµ»À­øà; cöÛ±Õ¤š„: } private function checkDataAutoHas($d¤çŞ¨ãÀ•) { if (!is_array($this->dataAuto) || count($this->dataAuto) == 0) { return !1; } foreach ($this->dataAuto as $c•Øëå¾) { if (in_array($d¤çŞ¨ãÀ•, explode($_SERVER[ªúæÂ¡­ä½][47], $c•Øëå¾[2]))) { return !0; } } return !1; } private function dataBeforeFilter(&$D›šÏ¡½ëÈ, $aØÒÑóø±) { $Cø“ö®À¿ =& $_SERVER[ªúæÂ¡­ä½]; foreach ($this->dataAuto as $dÇ¢ì¨¢½£) { $b®Ù™šÏØ« = $dÇ¢ì¨¢½£[0]; if (!in_array($aØÒÑóø±, explode($Cø“ö®À¿[47], $dÇ¢ì¨¢½£[2]))) { continue; } switch (trim($dÇ¢ì¨¢½£[3])) { case $Cø“ö®À¿[319]: case $Cø“ö®À¿[320]: $EœÛŠôÎñØ = $dÇ¢ì¨¢½£[1]; $E©ÜÂÒº®¥ = isset($dÇ¢ì¨¢½£[4]) ? (array) $dÇ¢ì¨¢½£[4] : array(); if ($EœÛŠôÎñØ == $Cø“ö®À¿[197] && array_key_exists($b®Ù™šÏØ«, $D›šÏ¡½ëÈ)) { if (!$D›šÏ¡½ëÈ[$b®Ù™šÏØ«]) { unset($D›šÏ¡½ëÈ[$b®Ù™šÏØ«]); } break; } if (isset($D›šÏ¡½ëÈ[$b®Ù™šÏØ«])) { array_unshift($E©ÜÂÒº®¥, $D›šÏ¡½ëÈ[$b®Ù™šÏØ«]); } if ($Cø“ö®À¿[319] == $dÇ¢ì¨¢½£[3]) { $D›šÏ¡½ëÈ[$b®Ù™šÏØ«] = call_user_func_array($EœÛŠôÎñØ, $E©ÜÂÒº®¥); } else { $D›šÏ¡½ëÈ[$b®Ù™šÏØ«] = call_user_func_array(array(&$this, $EœÛŠôÎñØ), $E©ÜÂÒº®¥); } break; case $Cø“ö®À¿[271]: $D›šÏ¡½ëÈ[$b®Ù™šÏØ«] = $D›šÏ¡½ëÈ[$dÇ¢ì¨¢½£[1]]; break; case $Cø“ö®À¿[292]: if (isset($D›šÏ¡½ëÈ[$b®Ù™šÏØ«]) && !is_string($D›šÏ¡½ëÈ[$b®Ù™šÏØ«])) { $D›šÏ¡½ëÈ[$b®Ù™šÏØ«] = json_encode_force($D›šÏ¡½ëÈ[$b®Ù™šÏØ«]); } break; case $Cø“ö®À¿[321]: if ($D›šÏ¡½ëÈ[$b®Ù™šÏØ«] === $Cø“ö®À¿[33]) { unset($D›šÏ¡½ëÈ[$b®Ù™šÏØ«]); } break; case $Cø“ö®À¿[322]: $D›šÏ¡½ëÈ[$b®Ù™šÏØ«] = $dÇ¢ì¨¢½£[1]; default: break; } } if ($aØÒÑóø± == $Cø“ö®À¿[353]) { $bŒ˜áğğŠ¿ = strtolower($this->db->getDbType()); if (strpos($bŒ˜áğğŠ¿, $Cø“ö®À¿[9]) !== 0) { return; } $dö­ÕÜÜœ = $this->field(!0)->fields; $B¨Ï…›ÆÔ = $dö­ÕÜÜœ[$Cø“ö®À¿[250]]; if (isset($dö­ÕÜÜœ[$Cø“ö®À¿[249]])) { unset($B¨Ï…›ÆÔ[$dö­ÕÜÜœ[$Cø“ö®À¿[249]]]); } foreach ($B¨Ï…›ÆÔ as $Aáæ±¨‡ºØ => $aØÒÑóø±) { if (!isset($D›šÏ¡½ëÈ[$Aáæ±¨‡ºØ])) { $D›šÏ¡½ëÈ[$Aáæ±¨‡ºØ] = $Cø“ö®À¿[33]; } } } } private function dataAfterFilter(&$C‘¼ÄÖî†´) { $EÄâä®Ê˜å =& $_SERVER[ªúæÂ¡­ä½]; foreach ($this->dataAuto as $c£·ŒÑ‹ƒ) { $B‘ÁÂ Àêù = $c£·ŒÑ‹ƒ[0]; if (!in_array($EÄâä®Ê˜å[355], explode($EÄâä®Ê˜å[47], $c£·ŒÑ‹ƒ[2]))) { continue; } if (!isset($C‘¼ÄÖî†´[$B‘ÁÂ Àêù])) { continue; } switch (trim($c£·ŒÑ‹ƒ[3])) { case $EÄâä®Ê˜å[319]: case $EÄâä®Ê˜å[320]: $F×Õó––Æ = isset($c£·ŒÑ‹ƒ[4]) ? (array) $c£·ŒÑ‹ƒ[4] : array(); array_unshift($F×Õó––Æ, $C‘¼ÄÖî†´[$B‘ÁÂ Àêù]); if ($EÄâä®Ê˜å[319] == $c£·ŒÑ‹ƒ[3]) { $C‘¼ÄÖî†´[$B‘ÁÂ Àêù] = call_user_func_array($c£·ŒÑ‹ƒ[1], $F×Õó––Æ); } else { $C‘¼ÄÖî†´[$B‘ÁÂ Àêù] = call_user_func_array(array(&$this, $c£·ŒÑ‹ƒ[1]), $F×Õó––Æ); } break; case $EÄâä®Ê˜å[271]: $C‘¼ÄÖî†´[$B‘ÁÂ Àêù] = $C‘¼ÄÖî†´[$c£·ŒÑ‹ƒ[1]]; break; case $EÄâä®Ê˜å[292]: $eË½å±²‡³ = $C‘¼ÄÖî†´[$B‘ÁÂ Àêù]; $C‘¼ÄÖî†´[$B‘ÁÂ Àêù] = json_decode($eË½å±²‡³, !0); if (is_null($C‘¼ÄÖî†´[$B‘ÁÂ Àêù])) { $C‘¼ÄÖî†´[$B‘ÁÂ Àêù] = $eË½å±²‡³; } break; case $EÄâä®Ê˜å[321]: if ($C‘¼ÄÖî†´[$B‘ÁÂ Àêù] === $EÄâä®Ê˜å[33]) { unset($C‘¼ÄÖî†´[$B‘ÁÂ Àêù]); } break; case $EÄâä®Ê˜å[322]: $C‘¼ÄÖî†´[$B‘ÁÂ Àêù] = $c£·ŒÑ‹ƒ[1]; default: break; } } } public function saveAll($CŒÊ—°ë×î) { goto a´íÌšù¢ò; c˜¶îõ“°: $this->chunkEventSet(); goto eíñ±·½ì–; bÛµµ‚ñƒ£: $CŒÊ—°ë×î = is_array($CŒÊ—°ë×î) ? $CŒÊ—°ë×î : array(); $aßÃª˜Âê = $Fí²ÅÅÖåÁ[375]; $B„­é–ÍÒï = 0; goto bé«¼¯‘ÀŸ; a´íÌšù¢ò: $Fí²ÅÅÖåÁ =& $_SERVER[ªúæÂ¡­ä½]; $b¨©¼ä£¥‡ = $this->tablePrefix . $this->tableName; $E×‰¨³…­ñ = self::SQL_WHERE_IN_CHUNK; goto bÛµµ‚ñƒ£; bé«¼¯‘ÀŸ: $B¨ŞëŠ‡ = array(); $eÖÔÜ–ƒîà = count($CŒÊ—°ë×î); for ($E¼õŸÔáê = 0; $E¼õŸÔáê < $eÖÔÜ–ƒîà; $E¼õŸÔáê++) { $A’‡˜‡¥¨ò = $CŒÊ—°ë×î[$E¼õŸÔáê]; if (!is_array($A’‡˜‡¥¨ò) || count($A’‡˜‡¥¨ò) != 4) { continue; } $A—¿¸Ÿ±İä = "\125\120\x44\101\124\x45\x20\140{$b¨©¼ä£¥‡}\140\x20\123\x45\x54\40{$A’‡˜‡¥¨ò[2]}\x20\75\40\x43\101\123\x45\x20{$A’‡˜‡¥¨ò[0]}\x20\xa"; if ($B„­é–ÍÒï == 0) { $aßÃª˜Âê = $A—¿¸Ÿ±İä; } $B¨ŞëŠ‡[] = $Fí²ÅÅÖåÁ[116] . $A’‡˜‡¥¨ò[1] . $Fí²ÅÅÖåÁ[116]; $B„­é–ÍÒï++; $aßÃª˜Âê .= "\40\x57\x48\105\x4e\40\x27{$A’‡˜‡¥¨ò[1]}\x27\40\124\x48\105\x4e\x20\47{$A’‡˜‡¥¨ò[3]}\x27\x20\xa"; if ($B„­é–ÍÒï == $E×‰¨³…­ñ || $E¼õŸÔáê == $eÖÔÜ–ƒîà - 1) { goto a‹­ÚáÄŒ´; a‹­ÚáÄŒ´: $C¤ÓÃÈ÷¸Ó = implode($Fí²ÅÅÖåÁ[47], $B¨ŞëŠ‡); $aßÃª˜Âê .= "\40\105\116\104\40\x20\127\x48\105\122\105\x20{$A’‡˜‡¥¨ò[0]}\40\x49\116\x20\50{$C¤ÓÃÈ÷¸Ó}\x29\40"; $this->execute($aßÃª˜Âê); goto bšå™ä¯ö; bšå™ä¯ö: $B„­é–ÍÒï = 0; $aßÃª˜Âê = $A—¿¸Ÿ±İä; $this->chunkEventCheck(count($B¨ŞëŠ‡)); goto d‰ÚÄµ»é; d‰ÚÄµ»é: $B¨ŞëŠ‡ = array(); goto cèÌòª‰°; cèÌòª‰°: } } goto c˜¶îõ“°; eíñ±·½ì–: } public function saveAllEach($EŞùªóÅë) { $EÕ•ìßé‰ª =& $_SERVER[ªúæÂ¡­ä½]; $e¯Ş©Ö™ = $this->tablePrefix . $this->tableName; foreach ($EŞùªóÅë as $A–¨Óî¹¯ñ) { if (!is_array($A–¨Óî¹¯ñ) || count($A–¨Óî¹¯ñ) != 4) { continue; } $cÈÆŒŒšøÓ = $A–¨Óî¹¯ñ[0] . $EÕ•ìßé‰ª[376] . $A–¨Óî¹¯ñ[1] . $EÕ•ìßé‰ª[116]; $e§¤Áªİá‡ = $A–¨Óî¹¯ñ[2] . $EÕ•ìßé‰ª[376] . $A–¨Óî¹¯ñ[3] . $EÕ•ìßé‰ª[116]; $C°å”ä³†Ç = "\x75\x70\x64\x61\164\145\x20{$e¯Ş©Ö™}\40\x73\x65\x74\40{$e§¤Áªİá‡}\40\x77\150\145\162\145\x20{$cÈÆŒŒšøÓ}\73"; $this->execute($C°å”ä³†Ç); } } protected $_chunkEvent = false; protected $_chunkEventParam = false; public function chunkEventSet($F°Åë‰²” = false, $aõ±ÃóñÈ† = false) { $this->_chunkEvent = $F°Åë‰²”; $this->_chunkEventParam = $aõ±ÃóñÈ†; } private function chunkEventCheck($c—‡Î¦¢µ ) { if (!$this->_chunkEvent) { return; } $B¬ª¢àÄ¬ = is_array($this->_chunkEventParam) ? $this->_chunkEventParam : array(); $B¬ª¢àÄ¬[$_SERVER[ªúæÂ¡­ä½][377]] = $c—‡Î¦¢µ ; Hook::trigger($this->_chunkEvent, $B¬ª¢àÄ¬); } public function addAll($b”„ßŞ‘‚, $Dğõ‹·í º = array(), $fâ×£²İ = false) { goto c÷•Å°òàø; aÌÁ±…ñà—: if (empty($b”„ßŞ‘‚)) { $this->error = think_lang($eÎ¼»ä®áÜ[269]); return !1; } $Dğõ‹·í º = $this->_parseOptions($Dğõ‹·í º); foreach ($b”„ßŞ‘‚ as $CÍîò»º‹¹ => $BÀÔÄ½æè) { $b”„ßŞ‘‚[$CÍîò»º‹¹] = $this->_facade($BÀÔÄ½æè); $this->_beforeInsert($b”„ßŞ‘‚[$CÍîò»º‹¹], $Dğõ‹·í º); } goto aòµ´óçà ; c÷•Å°òàø: $eÎ¼»ä®áÜ =& $_SERVER[ªúæÂ¡­ä½]; ignore_timeout(); $D¢ÙãÑùÏ = self::SQL_WHERE_IN_CHUNK; goto aÌÁ±…ñà—; aòµ´óçà : if (method_exists($this->db, $eÎ¼»ä®áÜ[270])) { for ($fùŞíÛÙëä = 0; $fùŞíÛÙëä < count($b”„ßŞ‘‚); $fùŞíÛÙëä += $D¢ÙãÑùÏ) { $a›£Ö¶é¸Ê = array_slice($b”„ßŞ‘‚, $fùŞíÛÙëä, $D¢ÙãÑùÏ); if (!is_array($a›£Ö¶é¸Ê) || count($a›£Ö¶é¸Ê) == 0) { break; } $CËÓ‘šêá¿ = $this->db->insertAll($a›£Ö¶é¸Ê, $Dğõ‹·í º, $fâ×£²İ); $this->chunkEventCheck(count($a›£Ö¶é¸Ê)); } $this->chunkEventSet(); } else { $this->startTrans(); foreach ($b”„ßŞ‘‚ as $CÍîò»º‹¹ => $BÀÔÄ½æè) { $CËÓ‘šêá¿ = $this->db->insert($BÀÔÄ½æè, $Dğõ‹·í º, $fâ×£²İ); } $this->commit(); } if (!1 !== $CËÓ‘šêá¿) { $Aª”ò…‚ŸÛ = $this->getLastInsID(); if ($Aª”ò…‚ŸÛ) { return $Aª”ò…‚ŸÛ; } } return $CËÓ‘šêá¿; goto cÔÏ¹¡„¹ó; cÔÏ¹¡„¹ó: } public function save($D“’¦˜õÓ = '', $f²†‚ÓÄˆ = array()) { goto b¯«À‘Á; b¯«À‘Á: $f©ßæÉ¨Û¤ =& $_SERVER[ªúæÂ¡­ä½]; $böÀ˜“œ©É = self::SQL_WHERE_IN_CHUNK; $dÂÎãæÆ• = $this->optionsValue(); goto b£„ñÒö‘Ö; DÖÖÒÖĞòÛ: $DåÕ¢œ¦¾ê = $dÂÎãæÆ•[$f©ßæÉ¨Û¤[273]][$dššöÜÛÌŸ][1]; $DåÕ¢œ¦¾ê = is_array($DåÕ¢œ¦¾ê) ? $DåÕ¢œ¦¾ê : array(); $fõ¥Õîğ³Å = count($DåÕ¢œ¦¾ê); goto dóµ‚Ãç; dóµ‚Ãç: for ($d¸áíÛÄïÏ = 0; $d¸áíÛÄïÏ < $fõ¥Õîğ³Å; $d¸áíÛÄïÏ += $böÀ˜“œ©É) { $cÄˆ´æ–Œê = array_slice($DåÕ¢œ¦¾ê, $d¸áíÛÄïÏ, $böÀ˜“œ©É); if (!is_array($cÄˆ´æ–Œê) || count($cÄˆ´æ–Œê) == 0) { break; } $dÂÎãæÆ•[$f©ßæÉ¨Û¤[273]][$dššöÜÛÌŸ][1] = $cÄˆ´æ–Œê; $this->optionsValue($dÂÎãæÆ•); $eªçºèÉä— += parent::save($D“’¦˜õÓ, $f²†‚ÓÄˆ); $this->chunkEventCheck(count($cÄˆ´æ–Œê)); } $this->chunkEventSet(); return $eªçºèÉä—; goto d§šÜ¼¤¹È; b£„ñÒö‘Ö: $dššöÜÛÌŸ = $this->findWhereField($dÂÎãæÆ•); if (!$dššöÜÛÌŸ) { return parent::save($D“’¦˜õÓ, $f²†‚ÓÄˆ); } $eªçºèÉä— = 0; goto DÖÖÒÖĞòÛ; d§šÜ¼¤¹È: } public function add($cÏ³Õ½ù† = '', $A£…æ›İÁŸ = array(), $EäÕÔªéŞ = false) { if ($this->addTaskStatus && is_array($cÏ³Õ½ù†)) { $this->addTaskData[] = $cÏ³Õ½ù†; return; } return parent::add($cÏ³Õ½ù†, $A£…æ›İÁŸ, $EäÕÔªéŞ); } public function parseWhereLike($BŞ÷—œŠœ, $B˜´“¥èšï = '', $Bê“–¶ƒÙ = false, &$BÃ­Ó¯™÷ = false) { goto d±ğ÷ÀØÚÊ; BÙé‚æŞœ¿: foreach ($BŞ÷—œŠœ as $EÚî×™¬í => $C³åÍšÅ˜ù) { if (is_array($C³åÍšÅ˜ù) && count($C³åÍšÅ˜ù) == 2 && $C³åÍšÅ˜ù[0] == $bŠ‹¢¶©Í[380] && is_string($C³åÍšÅ˜ù[1]) && substr($C³åÍšÅ˜ù[1], 0, 1) == $bŠ‹¢¶©Í[381] && substr($C³åÍšÅ˜ù[1], strlen($C³åÍšÅ˜ù[1]) - 1, 1) == $bŠ‹¢¶©Í[381]) { goto eÓæäÄâÙ; eÓæäÄâÙ: $BÃ­Ó¯™÷ = !0; $aòø¡…‚¬Ø = is_string($EÚî×™¬í) ? $EÚî×™¬í : $B˜´“¥èšï; $d×ö‹ÃÜÏ = substr($C³åÍšÅ˜ù[1], 1, strlen($C³åÍšÅ˜ù[1]) - 2); goto C˜Å™Ã·Ì‡; Bóğ‘«: if ($Bïõ®†ôÜÏ[$bŠ‹¢¶©Í[383]]) { $aÙï¥†À§Ç = $bŠ‹¢¶©Í[384] . $d×ö‹ÃÜÏ . $bŠ‹¢¶©Í[385]; if ($Bïõ®†ôÜÏ[$bŠ‹¢¶©Í[386]]) { $aÙï¥†À§Ç = $bŠ‹¢¶©Í[385] . $d×ö‹ÃÜÏ . $bŠ‹¢¶©Í[384]; } } $AïùÊ‡Ş[$fÊ¡é‘º“Ñ] = $bŠ‹¢¶©Í[387] . $aòø¡…‚¬Ø . $bŠ‹¢¶©Í[388] . $aÙï¥†À§Ç . $bŠ‹¢¶©Í[389]; $fÊ¡é‘º“Ñ++; goto f ÜÙ†©ä¶; C˜Å™Ã·Ì‡: $d×ö‹ÃÜÏ = $this->db->escapeString($d×ö‹ÃÜÏ); if (!strpos($aòø¡…‚¬Ø, $bŠ‹¢¶©Í[95])) { $aòø¡…‚¬Ø = $bŠ‹¢¶©Í[382] . $aòø¡…‚¬Ø . $bŠ‹¢¶©Í[382]; } $aÙï¥†À§Ç = $bŠ‹¢¶©Í[182] . $d×ö‹ÃÜÏ . $bŠ‹¢¶©Í[182]; goto Bóğ‘«; f ÜÙ†©ä¶: continue; goto dÇ²Š¬Î“; dÇ²Š¬Î“: } if (is_array($C³åÍšÅ˜ù)) { $B˜´“¥èšï = is_string($EÚî×™¬í) ? $EÚî×™¬í : $B˜´“¥èšï; $C³åÍšÅ˜ù = $this->parseWhereLike($C³åÍšÅ˜ù, $B˜´“¥èšï, !0, $BÃ­Ó¯™÷); } if (is_numeric($EÚî×™¬í)) { $AïùÊ‡Ş[$fÊ¡é‘º“Ñ] = $C³åÍšÅ˜ù; $fÊ¡é‘º“Ñ++; } else { $AïùÊ‡Ş[$EÚî×™¬í] = $C³åÍšÅ˜ù; } } if ($BÃ­Ó¯™÷ && !$Bê“–¶ƒÙ) { } return $AïùÊ‡Ş; goto cÀ…é‚Š¹‹; d±ğ÷ÀØÚÊ: $bŠ‹¢¶©Í =& $_SERVER[ªúæÂ¡­ä½]; $Bïõ®†ôÜÏ = $GLOBALS[$bŠ‹¢¶©Í[6]][$bŠ‹¢¶©Í[378]]; if (!$Bïõ®†ôÜÏ[$bŠ‹¢¶©Í[379]]) { return $BŞ÷—œŠœ; } goto BĞ§İï¤ã…; BĞ§İï¤ã…: if (!is_array($BŞ÷—œŠœ)) { return $BŞ÷—œŠœ; } $AïùÊ‡Ş = array(); $fÊ¡é‘º“Ñ = 0; goto BÙé‚æŞœ¿; cÀ…é‚Š¹‹: } private $addTaskStatus = false; private $addTaskData = array(); public function addTaskStart() { $this->addTaskStatus = !0; $this->addTaskData = array(); } public function addTaskEnd() { if (!$this->addTaskStatus) { return; } $this->addAll($this->addTaskData); $this->addTaskStatus = !1; $this->addTaskData = array(); } public function select($AÊã»‹³Æ = array()) { goto C¼—¦‘æœ; d´‰’è«’: $bÃßîùï‡² = $this->findWhereField($d…µÃÀÂ×); if (!$bÃßîùï‡² || isset($d…µÃÀÂ×[$d“ÓóÙº“º[290]]) || isset($d…µÃÀÂ×[$d“ÓóÙº“º[351]])) { return parent::select($AÊã»‹³Æ); } $aèîâ¯ÒÏ = $d…µÃÀÂ×[$d“ÓóÙº“º[273]][$bÃßîùï‡²][1]; goto dò¹Œ Æ½ø; C¼—¦‘æœ: $d“ÓóÙº“º =& $_SERVER[ªúæÂ¡­ä½]; $bÜ·Õ‘âœŞ = self::SQL_WHERE_IN_CHUNK; $d…µÃÀÂ× = $this->optionsValue(); goto d´‰’è«’; dò¹Œ Æ½ø: $aèîâ¯ÒÏ = is_array($aèîâ¯ÒÏ) ? $aèîâ¯ÒÏ : array(); $E³µ¹ôÛ„† = null; for ($B“¿ãÁğ ğ = 0; $B“¿ãÁğ ğ < count($aèîâ¯ÒÏ); $B“¿ãÁğ ğ += $bÜ·Õ‘âœŞ) { $EÓóñÅ‡Â¸ = array_slice($aèîâ¯ÒÏ, $B“¿ãÁğ ğ, $bÜ·Õ‘âœŞ); if (!is_array($EÓóñÅ‡Â¸) || count($EÓóñÅ‡Â¸) == 0) { break; } $d…µÃÀÂ×[$d“ÓóÙº“º[273]][$bÃßîùï‡²][1] = $EÓóñÅ‡Â¸; $this->optionsValue($d…µÃÀÂ×); $D•Ğ‘Î¹îÑ = parent::select($AÊã»‹³Æ); if (!$D•Ğ‘Î¹îÑ) { continue; } $E³µ¹ôÛ„† = is_array($E³µ¹ôÛ„†) ? $E³µ¹ôÛ„† : array(); $E³µ¹ôÛ„† = array_merge($E³µ¹ôÛ„†, $D•Ğ‘Î¹îÑ); } goto fŒËóôè‚; fŒËóôè‚: return $E³µ¹ôÛ„†; goto BßÅÛ õğ¾; BßÅÛ õğ¾: } public function delete($f¾‹‘À…¿ = array()) { goto F³¢‹Á‘ƒ¤; D°ò£”ßô†: $aïà¾ÊŒÇ» = $this->findWhereField($e•ñÙ‹¸ø); if (!$aïà¾ÊŒÇ») { return parent::delete($f¾‹‘À…¿); } $e¨«Š¼Ûæâ = 0; goto a‹¥ÉË¬êĞ; a‹¥ÉË¬êĞ: $aÎÙ„ßÍå = $e•ñÙ‹¸ø[$e…šĞğóé§[273]][$aïà¾ÊŒÇ»][1]; $aÎÙ„ßÍå = is_array($aÎÙ„ßÍå) ? $aÎÙ„ßÍå : array(); for ($c²Îä»Ş = 0; $c²Îä»Ş < count($aÎÙ„ßÍå); $c²Îä»Ş += $aéÒçåá‰) { $D©İ‰ĞÀ¹ = array_slice($aÎÙ„ßÍå, $c²Îä»Ş, $aéÒçåá‰); if (!is_array($D©İ‰ĞÀ¹) || count($D©İ‰ĞÀ¹) == 0) { break; } $e•ñÙ‹¸ø[$e…šĞğóé§[273]][$aïà¾ÊŒÇ»][1] = $D©İ‰ĞÀ¹; $this->optionsValue($e•ñÙ‹¸ø); $e¨«Š¼Ûæâ += parent::delete($f¾‹‘À…¿); } goto e–ŠŠÛˆÏš; F³¢‹Á‘ƒ¤: $e…šĞğóé§ =& $_SERVER[ªúæÂ¡­ä½]; $aéÒçåá‰ = self::SQL_WHERE_IN_CHUNK; $e•ñÙ‹¸ø = $this->optionsValue(); goto D°ò£”ßô†; e–ŠŠÛˆÏš: return $e¨«Š¼Ûæâ; goto FÑâï‹Çë; FÑâï‹Çë: } private function findWhereField($D¸½˜À‡×) { $e†äãİçÔ =& $_SERVER[ªúæÂ¡­ä½]; $fæÛ³­˜½ë = self::SQL_WHERE_IN_CHUNK; if (!is_array($D¸½˜À‡×) || !is_array($D¸½˜À‡×[$e†äãİçÔ[273]])) { return !1; } foreach ($D¸½˜À‡×[$e†äãİçÔ[273]] as $B˜•ª”Ğá => $Få·ÉÚÑßÍ) { if (is_array($Få·ÉÚÑßÍ) && isset($Få·ÉÚÑßÍ[0]) && is_string($Få·ÉÚÑßÍ[0]) && strtolower($Få·ÉÚÑßÍ[0]) == $e†äãİçÔ[7] && is_array($Få·ÉÚÑßÍ[1]) && count($Få·ÉÚÑßÍ[1]) > $fæÛ³­˜½ë) { ignore_timeout(); return $B˜•ª”Ğá; } } return !1; } public function setMasterDB($eÎíï”¦ = true) { think_config($_SERVER[ªúæÂ¡­ä½][390], $eÎíï”¦); } } class ModelBaseLight { public $optionType = ''; public $modelType = "\x53\x79\x73\164\x65\155\x4f\x70\164\x69\x6f\x6e"; public $field = array(); public function listData($cÛÀ†Ø¨‘Œ = false, $fŞ‚ÒäÅ…æ = "\155\x6f\x64\x69\x66\x79\x54\x69\155\x65", $c’Ø‹Á›¨Ğ = false) { $d¶Ş¤‚Ê÷È = Model($this->modelType)->get(!1, $this->optionType, !0); if (!$d¶Ş¤‚Ê÷È) { return $cÛÀ†Ø¨‘Œ ? null : array(); } if (!$cÛÀ†Ø¨‘Œ) { $d¶Ş¤‚Ê÷È = array_filter(array_values($d¶Ş¤‚Ê÷È)); return array_sort_by($d¶Ş¤‚Ê÷È, $fŞ‚ÒäÅ…æ, $c’Ø‹Á›¨Ğ); } return $d¶Ş¤‚Ê÷È[$_SERVER[ªúæÂ¡­ä½][391] . $cÛÀ†Ø¨‘Œ]; } public function insert($Eƒ‹ï¼§ˆ») { goto C§öÍç´Ş…; BÏÈÍÓµ½×: $d”àö‚™çŸ = $d”àö‚™çŸ ? $d”àö‚™çŸ : 0; $Eƒ‹ï¼§ˆ»[$D¤ÀÎ±¦ƒê[394]] = ++$d”àö‚™çŸ; $Eƒ‹ï¼§ˆ»[$D¤ÀÎ±¦ƒê[194]] = time(); goto dóÍšŸ™Ø‘; C§öÍç´Ş…: $D¤ÀÎ±¦ƒê =& $_SERVER[ªúæÂ¡­ä½]; $Eƒ‹ï¼§ˆ» = array_field_key($Eƒ‹ï¼§ˆ», $this->field); $d”àö‚™çŸ = Model($this->modelType)->get($D¤ÀÎ±¦ƒê[392], $this->optionType . $D¤ÀÎ±¦ƒê[393]); goto BÏÈÍÓµ½×; aí¬±Ó®–: return $d”àö‚™çŸ; goto b¿ğù–ç©; dóÍšŸ™Ø‘: $Eƒ‹ï¼§ˆ»[$D¤ÀÎ±¦ƒê[84]] = time(); Model($this->modelType)->set($D¤ÀÎ±¦ƒê[392], $d”àö‚™çŸ, $this->optionType . $D¤ÀÎ±¦ƒê[393]); Model($this->modelType)->set($D¤ÀÎ±¦ƒê[391] . $d”àö‚™çŸ, $Eƒ‹ï¼§ˆ», $this->optionType); goto aí¬±Ó®–; b¿ğù–ç©: } public function update($E²÷–ã¿›Î, $Dõç¼åÈÎÈ) { goto d©ïù¾ôñÑ; Fº•öë“‘±: if (!$A‘©§«ªš || !$E²÷–ã¿›Î) { return !1; } $Dõç¼åÈÎÈ = array_merge($A‘©§«ªš, $Dõç¼åÈÎÈ); $Dõç¼åÈÎÈ[$bÕ–Ğå‹¬[84]] = time(); goto eô¯ò«•°ö; eô¯ò«•°ö: return Model($this->modelType)->set($bÕ–Ğå‹¬[391] . $E²÷–ã¿›Î, $Dõç¼åÈÎÈ, $this->optionType); goto DÔ—è“ˆºƒ; d©ïù¾ôñÑ: $bÕ–Ğå‹¬ =& $_SERVER[ªúæÂ¡­ä½]; $Dõç¼åÈÎÈ = array_field_key($Dõç¼åÈÎÈ, $this->field); $A‘©§«ªš = $this->listData($E²÷–ã¿›Î); goto Fº•öë“‘±; DÔ—è“ˆºƒ: } public function remove($aù´Ğ˜ä¸°) { if (!$aù´Ğ˜ä¸°) { return !1; } return Model($this->modelType)->remove($_SERVER[ªúæÂ¡­ä½][391] . $aù´Ğ˜ä¸°, $this->optionType); } public function clear() { $D­äù„É™Œ =& $_SERVER[ªúæÂ¡­ä½]; Model($this->modelType)->remove($D­äù„É™Œ[392], $this->optionType . $D­äù„É™Œ[393]); return Model($this->modelType)->remove(null, $this->optionType); } public function cacheClear() { return Model($this->modelType)->cacheRemove($this->optionType); } public function findByKey($fİ¥âˆ¥Š¥, $d¶œöİ‚°) { if (!$d¶œöİ‚°) { return !1; } $eÀã–¸—ºì = $this->listData(); $eÀã–¸—ºì = array_to_keyvalue($eÀã–¸—ºì, $fİ¥âˆ¥Š¥); return isset($eÀã–¸—ºì[$d¶œöİ‚°]) ? $eÀã–¸—ºì[$d¶œöİ‚°] : !1; } public function findByName($Dğœ…•„àŞ) { return $this->findByKey($_SERVER[ªúæÂ¡­ä½][28], $Dğœ…•„àŞ); } protected function resetData($eª·¯ä‚øà) { $ašò¥ Ìù‘ =& $_SERVER[ªúæÂ¡­ä½]; $eª·¯ä‚øà = is_array($eª·¯ä‚øà) ? $eª·¯ä‚øà : array(); $CÈŒÈ÷¦Æ® = array(); for ($aÅ¶•ßåŠ² = 0; $aÅ¶•ßåŠ² < count($eª·¯ä‚øà); $aÅ¶•ßåŠ²++) { $CÈŒÈ÷¦Æ®[$ašò¥ Ìù‘[391] . $eª·¯ä‚øà[$aÅ¶•ßåŠ²][$ašò¥ Ìù‘[394]]] = $eª·¯ä‚øà[$aÅ¶•ßåŠ²]; } return Model($this->modelType)->set($CÈŒÈ÷¦Æ®, !1, $this->optionType); } private function getAutoName($a›Ü‰Úöæ) { $d‹Ã¬°†ÈË = array_to_keyvalue($this->listData(), $_SERVER[ªúæÂ¡­ä½][28]); if (!$d‹Ã¬°†ÈË || !isset($d‹Ã¬°†ÈË[$a›Ü‰Úöæ])) { return $a›Ü‰Úöæ; } for ($b£æÔˆÉŠÁ = 1; $b£æÔˆÉŠÁ < count($d‹Ã¬°†ÈË); $b£æÔˆÉŠÁ++) { $CÎ¯“Á¶ = $a›Ü‰Úöæ . "\x28{$b£æÔˆÉŠÁ}\51"; if (!isset($d‹Ã¬°†ÈË[$CÎ¯“Á¶])) { return $CÎ¯“Á¶; } } return $CÎ¯“Á¶; } } class ModelBaseOption extends ModelBase { protected $tableName = ''; protected $jsonField = array(); public function get($f¥±¡óõŸÃ = false, $c„‚‹Ô¿‹ƒ = '', $A—ºŠÊí¿Å = false) { goto a„ñÃíÙ¹; A²ßì×µô: $a’Ø×‰å’÷ = is_array($a’Ø×‰å’÷) ? $a’Ø×‰å’÷ : array(); if (is_array($DÓ©½™ùÉ)) { $DÓ©½™ùÉ = array_merge($a’Ø×‰å’÷, $DÓ©½™ùÉ); return $f¥±¡óõŸÃ ? isset($DÓ©½™ùÉ[$f¥±¡óõŸÃ]) ? $DÓ©½™ùÉ[$f¥±¡óõŸÃ] : null : $DÓ©½™ùÉ; } $A‡ØîØ… = $this->filterWhere(array($a½‹‹ïĞµ™[29] => $c„‚‹Ô¿‹ƒ)); goto f¥òºÙºœ®; f¥òºÙºœ®: $DÓ©½™ùÉ = $this->where($A‡ØîØ…)->select(); $DÓ©½™ùÉ = array_to_keyvalue($DÓ©½™ùÉ, $a½‹‹ïĞµ™[93], $a½‹‹ïĞµ™[372]); foreach ($DÓ©½™ùÉ as $BÃ¸õù½¸» => $E¸¡æÈ…¼) { if ($A—ºŠÊí¿Å || in_array($BÃ¸õù½¸», $this->jsonField)) { $DÓ©½™ùÉ[$BÃ¸õù½¸»] = json_decode($E¸¡æÈ…¼, !0); } } goto a¾‹õ§äç; a„ñÃíÙ¹: $a½‹‹ïĞµ™ =& $_SERVER[ªúæÂ¡­ä½]; $DÓ©½™ùÉ = $this->cacheGet($c„‚‹Ô¿‹ƒ); $a’Ø×‰å’÷ = $this->optionDefault($c„‚‹Ô¿‹ƒ); goto A²ßì×µô; a¾‹õ§äç: $this->cacheSet($c„‚‹Ô¿‹ƒ, $DÓ©½™ùÉ); $DÓ©½™ùÉ = array_merge($a’Ø×‰å’÷, $DÓ©½™ùÉ); return $f¥±¡óõŸÃ ? $DÓ©½™ùÉ[$f¥±¡óõŸÃ] : $DÓ©½™ùÉ; goto DÕ•‹†–†À; DÕ•‹†–†À: } public function set($eŒÕæ´Í­, $E•– Ôâƒ = false, $F’Œî¶…ƒ = '') { goto cäÇ†ÛÛõÏ; e—ç£è©ƒ©: $cïÂ¨ŠÀÛ = is_array($eŒÕæ´Í­) ? $eŒÕæ´Í­ : array($eŒÕæ´Í­ => $E•– Ôâƒ); foreach ($cïÂ¨ŠÀÛ as $A‰‘Á¦¯¨É => $Dó–ë¯óâ) { if (is_array($Dó–ë¯óâ)) { $Dó–ë¯óâ = json_encode_force($Dó–ë¯óâ); } $this->checkLength($Dó–ë¯óâ, !1, $this->tableName . $BŸĞá´›“¨[4] . $eŒÕæ´Í­); $Dó–ë¯óâ = self::textEncode($Dó–ë¯óâ); $cïÂ¨ŠÀÛ = array($BŸĞá´›“¨[29] => $F’Œî¶…ƒ, $BŸĞá´›“¨[93] => $A‰‘Á¦¯¨É, $BŸĞá´›“¨[372] => $Dó–ë¯óâ); $a…¤í×¨Áí[] = $this->filterWhere($cïÂ¨ŠÀÛ); } if (!$a…¤í×¨Áí) { return !0; } goto aÊ—Šµ¦Áô; cäÇ†ÛÛõÏ: $BŸĞá´›“¨ =& $_SERVER[ªúæÂ¡­ä½]; $this->cacheRemove($F’Œî¶…ƒ); $a…¤í×¨Áí = array(); goto e—ç£è©ƒ©; aÊ—Šµ¦Áô: return $this->addAll($a…¤í×¨Áí, array(), !0); goto Aƒ×‹ñø·; Aƒ×‹ñø·: } protected function optionDefault($BìÎÚßæ‰Ï = '') { return !1; } public function setDeep($aÁ˜¤ìø»Û, $F±÷¾İÕ©ó = false, $BËïÉ§âë‰ = '') { $AÅììŠ™ˆé = explode($_SERVER[ªúæÂ¡­ä½][95], $aÁ˜¤ìø»Û); $CŒÕÌëå£ = $this->get(); array_set_value($CŒÕÌëå£, $aÁ˜¤ìø»Û, $F±÷¾İÕ©ó); $this->set($AÅììŠ™ˆé[0], $CŒÕÌëå£[$AÅììŠ™ˆé[0]], $BËïÉ§âë‰); } public function remove($E³ÛîøÊŠİ, $d°´ñÄŒƒ = '') { $B‚®„„¶ó½ =& $_SERVER[ªúæÂ¡­ä½]; $this->cacheRemove($d°´ñÄŒƒ); $eÄÙˆÑŒµ× = $this->filterWhere(array($B‚®„„¶ó½[93] => $E³ÛîøÊŠİ, $B‚®„„¶ó½[29] => $d°´ñÄŒƒ)); if (is_null($E³ÛîøÊŠİ)) { unset($eÄÙˆÑŒµ×[$B‚®„„¶ó½[93]]); } return $this->where($eÄÙˆÑŒµ×)->delete(); } public function cacheSet($f³ò´óŞ‚‚, $cãÙê‹¨Óé = false) { return Cache::set($this->cacheKey($f³ò´óŞ‚‚), $cãÙê‹¨Óé); } public function cacheGet($B•ØÍ÷„œµ) { return Cache::get($this->cacheKey($B•ØÍ÷„œµ)); } public function cacheRemove($b–„¥ÆÚ½«) { return Cache::remove($this->cacheKey($b–„¥ÆÚ½«)); } protected function filterWhere($d—ô¨­¡ù›) { return $d—ô¨­¡ù›; } protected function cacheKey($DŸ„óÒçË) { return $DŸ„óÒçË; } } goto b†¡ÁÑ‚É½; eâ¬»ÍĞœ„: class SourceListSearchModel extends SourceListMoveModel { public static function fileTypeWhere($f·Ÿ¸°Áô§) { goto aìÉ‡¥æìÂ; FÓÌêˆç í: if (!$B‡ô†Ç¿) { return array(); } $dÚ³Ø‡í£ˆ = $B‡ô†Ç¿[$FÈ¹ˆ÷ê¯Ã[168]]; $c˜Á‚³ìéº = $FÈ¹ˆ÷ê¯Ã[7]; goto eËîÂÌ½’²; aìÉ‡¥æìÂ: $FÈ¹ˆ÷ê¯Ã =& $_SERVER[ªúæÂ¡­ä½]; $fô¡ˆ‡÷µ = KodIO::fileTypeList(); $B‡ô†Ç¿ = $fô¡ˆ‡÷µ[$f·Ÿ¸°Áô§]; goto FÓÌêˆç í; eËîÂÌ½’²: if (!$B‡ô†Ç¿[$FÈ¹ˆ÷ê¯Ã[168]]) { $b„–”§…†É = array_to_keyvalue($fô¡ˆ‡÷µ, $FÈ¹ˆ÷ê¯Ã[33], $FÈ¹ˆ÷ê¯Ã[168]); $dÚ³Ø‡í£ˆ = implode($FÈ¹ˆ÷ê¯Ã[47], $b„–”§…†É); $c˜Á‚³ìéº = $FÈ¹ˆ÷ê¯Ã[1958]; } $ašÏ˜“ì“ğ = explode($FÈ¹ˆ÷ê¯Ã[47], trim($dÚ³Ø‡í£ˆ, $FÈ¹ˆ÷ê¯Ã[47])); return array($c˜Á‚³ìéº, $ašÏ˜“ì“ğ); goto F‹É÷šß›; F‹É÷šß›: } public function listPathType($AíîËÈÂÏÎ) { $c™ˆ²ª’ =& $_SERVER[ªúæÂ¡­ä½]; $e¸ŒŸÔ–Øš = $this->fileTypeWhere($AíîËÈÂÏÎ); if (!$e¸ŒŸÔ–Øš) { return array(); } $F«Ëî¦†Ç– = array($c™ˆ²ª’[563] => SourceModel::TYPE_USER, $c™ˆ²ª’[564] => USER_ID, $c™ˆ²ª’[560] => 0, $c™ˆ²ª’[561] => $e¸ŒŸÔ–Øš); return $this->listSource($F«Ëî¦†Ç–); } public function listSearch($cÇ•¡ÌÉÓ£, $f‹ˆÊÁº‰ = 300) { goto Eİóà©«ŒÌ; B’‡§˜¼×: $this->_listMake($aÈºƒ®ùÇ±); return $aÈºƒ®ùÇ±; goto cÛÇó£ì¹è; e‹ÏİéÏ: $aÈºƒ®ùÇ± = $this->distinct(!0)->field($E³Â¶–ï»§)->where($f†‹õğÂğí)->selectPage($f‹ˆÊÁº‰); $this->_listSearchFileContent($aÈºƒ®ùÇ±, $cÇ•¡ÌÉÓ£, $f¾Ï‹×…à); $this->_listSearchDesc($aÈºƒ®ùÇ±, $cÇ•¡ÌÉÓ£, $f¾Ï‹×…à); goto e£Ï·ÀĞ¾£; e£Ï·ÀĞ¾£: $this->_listSearchTag($aÈºƒ®ùÇ±, $cÇ•¡ÌÉÓ£, $f¾Ï‹×…à); $this->_listSearchGroupTag($aÈºƒ®ùÇ±, $cÇ•¡ÌÉÓ£, $f¾Ï‹×…à); $this->_listDataApply($aÈºƒ®ùÇ±[$aèÑÀ‰‰[367]]); goto B’‡§˜¼×; fˆ£¤§ÎÎ: if (!isset($f†‹õğÂğí[$aèÑÀ‰‰[424]])) { $f†‹õğÂğí[$aèÑÀ‰‰[424]] = 0; } $E³Â¶–ï»§ = $aèÑÀ‰‰[1960]; $f¾Ï‹×…à = $E³Â¶–ï»§; goto a¢¼„ì¢©; Eİóà©«ŒÌ: $aèÑÀ‰‰ =& $_SERVER[ªúæÂ¡­ä½]; if (isset($cÇ•¡ÌÉÓ£[$aèÑÀ‰‰[1802]]) && $cÇ•¡ÌÉÓ£[$aèÑÀ‰‰[1802]]) { $cÇ•¡ÌÉÓ£[$aèÑÀ‰‰[1802]] = str_replace($aèÑÀ‰‰[381], $aèÑÀ‰‰[1959], trim($cÇ•¡ÌÉÓ£[$aèÑÀ‰‰[1802]])); } $f†‹õğÂğí = $this->_parseSearchWhere($cÇ•¡ÌÉÓ£); goto fˆ£¤§ÎÎ; a¢¼„ì¢©: $this->_listSearchBindPinyin($cÇ•¡ÌÉÓ£, $f†‹õğÂğí, $E³Â¶–ï»§); $this->alias($aèÑÀ‰‰[530])->_makeOrder(); $f†‹õğÂğí = $this->parseWhereLike($f†‹õğÂğí); goto e‹ÏİéÏ; cÛÇó£ì¹è: } private function _listSearchFileContent(&$AÌç×º¤¢», $CÓÏÚ×íƒ, $F–‚ÉÄŒç¬) { goto B“ˆ¤ÖÑ”‹; B“ˆ¤ÖÑ”‹: $bŠäì¬¤¹ =& $_SERVER[ªúæÂ¡­ä½]; if (!$CÓÏÚ×íƒ[$bŠäì¬¤¹[1802]] || $AÌç×º¤¢»[$bŠäì¬¤¹[364]][$bŠäì¬¤¹[351]] > 1) { return; } $bË™»‰“å‰ = $this->_parseSearchWhere($CÓÏÚ×íƒ); goto a³¤ÄÍ—œÎ; a³¤ÄÍ—œÎ: if (!isset($bË™»‰“å‰[$bŠäì¬¤¹[28]]) || !is_array($CÓÏÚ×íƒ[$bŠäì¬¤¹[448]])) { return; } $bË™»‰“å‰[$bŠäì¬¤¹[448]] = array($bŠäì¬¤¹[7], $CÓÏÚ×íƒ[$bŠäì¬¤¹[448]]); unset($bË™»‰“å‰[$bŠäì¬¤¹[28]]); goto C•´ˆ¹ø—†; e…ª·‘ÀÏÛ: $AÌç×º¤¢»[$bŠäì¬¤¹[367]] = array_merge($AÉèÜ‚î¬Ø, $AÌç×º¤¢»[$bŠäì¬¤¹[367]]); $AÌç×º¤¢»[$bŠäì¬¤¹[364]][$bŠäì¬¤¹[365]] += count($AÉèÜ‚î¬Ø); goto f‰ƒÍ†Ò—º; C•´ˆ¹ø—†: unset($CÓÏÚ×íƒ[$bŠäì¬¤¹[448]]); $AÉèÜ‚î¬Ø = $this->field($F–‚ÉÄŒç¬)->where($bË™»‰“å‰)->limit($bŠäì¬¤¹[1961])->select(); if (!$AÉèÜ‚î¬Ø || count($AÉèÜ‚î¬Ø) == 0) { return; } goto e…ª·‘ÀÏÛ; f‰ƒÍ†Ò—º: } private function _listSearchTag(&$b¡ºÛ—‰÷, $d„Éïğ†ìÖ, $aßğ”¤ÉãÒ) { goto c˜Ûï¥ÁøÓ; D¢‰•ù›…å: if (!$f¼é¶âõ) { return; } $D‰ºİÓœ« = array($c‰íğ“»ÀÁ[420] => array($c‰íğ“»ÀÁ[7], $f¼é¶âõ), $c‰íğ“»ÀÁ[1545] => USER_ID); $Fß¯î¹ºÆ‚ = Model($c‰íğ“»ÀÁ[421])->field($c‰íğ“»ÀÁ[76])->where($D‰ºİÓœ«)->select(); goto BÃ¯ƒƒ§«ß; FÚÉˆèƒå‚: $f¼é¶âõ = array(); $cèÚ™„Š = $d„Éïğ†ìÖ[$c‰íğ“»ÀÁ[1802]]; foreach ($bÈæÛõ¯Åİ as $cæËù²ƒ›) { $Aé§¾¡¸Ô‹ = $cæËù²ƒ›[$c‰íğ“»ÀÁ[28]]; $fŒÕËÄÄ¢œ = str_replace($c‰íğ“»ÀÁ[50], $c‰íğ“»ÀÁ[33], Pinyin::encode($Aé§¾¡¸Ô‹)); if (stripos($Aé§¾¡¸Ô‹, $cèÚ™„Š) !== !1 || stripos($fŒÕËÄÄ¢œ, $cèÚ™„Š) !== !1) { $f¼é¶âõ[] = $cæËù²ƒ›[$c‰íğ“»ÀÁ[394]]; } } goto D¢‰•ù›…å; BÃ¯ƒƒ§«ß: $Fß¯î¹ºÆ‚ = array_to_keyvalue($Fß¯î¹ºÆ‚, $c‰íğ“»ÀÁ[33], $c‰íğ“»ÀÁ[76]); $d„‚ƒ‹Æç = array_unique($Fß¯î¹ºÆ‚); $this->_listSearchMerge($b¡ºÛ—‰÷, $d„Éïğ†ìÖ, $aßğ”¤ÉãÒ, $d„‚ƒ‹Æç); goto BäíÉµ„øå; c˜Ûï¥ÁøÓ: $c‰íğ“»ÀÁ =& $_SERVER[ªúæÂ¡­ä½]; if (!$d„Éïğ†ìÖ[$c‰íğ“»ÀÁ[1802]] || $b¡ºÛ—‰÷[$c‰íğ“»ÀÁ[364]][$c‰íğ“»ÀÁ[351]] > 1) { return; } $bÈæÛõ¯Åİ = Model($c‰íğ“»ÀÁ[1962])->listData(); goto FÚÉˆèƒå‚; BäíÉµ„øå: } private function _listSearchDesc(&$Eß„…²ù¡½, $F®ïÄƒ×õ‘, $aŒÒÇ­‘‹Î) { goto f±‡’‘¢Æù; B¨ñ’È„¡Ó: $B›®é³Şî = Model($cõ÷ïñÍÀô[546])->field($cõ÷ïñÍÀô[396])->where($eôÚÄÄ’¶×)->select(); $D¼¢—Ù”ï = array_to_keyvalue($B›®é³Şî, $cõ÷ïñÍÀô[33], $cõ÷ïñÍÀô[396]); $this->_listSearchMerge($Eß„…²ù¡½, $F®ïÄƒ×õ‘, $aŒÒÇ­‘‹Î, $D¼¢—Ù”ï); goto bºç™ååõ³; Dëò¤„¢ì÷: $fìŒÓÌÌª = array_unique($fìŒÓÌÌª); if (!$fìŒÓÌÌª) { return; } $eôÚÄÄ’¶× = array($cõ÷ïñÍÀô[396] => array($cõ÷ïñÍÀô[7], $fìŒÓÌÌª), $cõ÷ïñÍÀô[93] => $cõ÷ïñÍÀô[432], $cõ÷ïñÍÀô[372] => array($cõ÷ïñÍÀô[380], $cõ÷ïñÍÀô[1804] . $F®ïÄƒ×õ‘[$cõ÷ïñÍÀô[1802]] . $cõ÷ïñÍÀô[1804])); goto B¨ñ’È„¡Ó; f±‡’‘¢Æù: $cõ÷ïñÍÀô =& $_SERVER[ªúæÂ¡­ä½]; if (!$F®ïÄƒ×õ‘[$cõ÷ïñÍÀô[1802]] || $Eß„…²ù¡½[$cõ÷ïñÍÀô[364]][$cõ÷ïñÍÀô[351]] > 1) { return; } $fìŒÓÌÌª = $this->listSearchChildren($F®ïÄƒ×õ‘[$cõ÷ïñÍÀô[479]]); goto Dëò¤„¢ì÷; bºç™ååõ³: } private function _listSearchGroupTag(&$FæÑÀ˜÷Á, $CÚƒá‡í‹½, $e¶ÎÎ²…¨) { goto BöÙ™´êò§; E‹ÇÄÅÄØÛ: $f‡Õ‡±è…› = array_to_keyvalue($f‡Õ‡±è…›, $b¹˜…Âï[33], $b¹˜…Âï[76]); $fÍêŸ«É = array_unique($f‡Õ‡±è…›); $this->_listSearchMerge($FæÑÀ˜÷Á, $CÚƒá‡í‹½, $e¶ÎÎ²…¨, $fÍêŸ«É); goto A‘çà§; fŠÒÍ¾‡„‘: if (!$BÜõ½›¦“ || $BÜõ½›¦“[$b¹˜…Âï[405]] != SourceModel::TYPE_GROUP) { return; } $c°š–Óä§ = $BÜõ½›¦“[$b¹˜…Âï[485]]; $dß‰ßÔ¤ïÜ = Model($b¹˜…Âï[1963])->get($c°š–Óä§); goto cª˜‰±ÇÏ; cª˜‰±ÇÏ: $fğè°ö„Êã = array(); $bÚÓÏÔÔõÜ = $CÚƒá‡í‹½[$b¹˜…Âï[1802]]; foreach ($dß‰ßÔ¤ïÜ[$b¹˜…Âï[367]] as $dŒºöğğ©Ú) { $a¥––äÄ£Ÿ = $dŒºöğğ©Ú[$b¹˜…Âï[28]]; $b×¶í¨ªà = str_replace($b¹˜…Âï[50], $b¹˜…Âï[33], Pinyin::encode($a¥––äÄ£Ÿ)); if (stripos($a¥––äÄ£Ÿ, $bÚÓÏÔÔõÜ) !== !1 || stripos($b×¶í¨ªà, $bÚÓÏÔÔõÜ) !== !1) { $fğè°ö„Êã[] = $dŒºöğğ©Ú[$b¹˜…Âï[394]]; } } goto aÈ„¬³ì¡›; aÈ„¬³ì¡›: if (!$fğè°ö„Êã) { return; } $AšØÀ¤ÈµÈ = array($b¹˜…Âï[420] => array($b¹˜…Âï[7], $fğè°ö„Êã), $b¹˜…Âï[1545] => 0, $b¹˜…Âï[29] => $b¹˜…Âï[1826] . $c°š–Óä§); $f‡Õ‡±è…› = Model($b¹˜…Âï[421])->field($b¹˜…Âï[76])->where($AšØÀ¤ÈµÈ)->select(); goto E‹ÇÄÅÄØÛ; BöÙ™´êò§: $b¹˜…Âï =& $_SERVER[ªúæÂ¡­ä½]; if (!$CÚƒá‡í‹½[$b¹˜…Âï[1802]] || $FæÑÀ˜÷Á[$b¹˜…Âï[364]][$b¹˜…Âï[351]] > 1 || !$CÚƒá‡í‹½[$b¹˜…Âï[479]]) { return; } $BÜõ½›¦“ = $this->sourceInfo($CÚƒá‡í‹½[$b¹˜…Âï[479]]); goto fŠÒÍ¾‡„‘; A‘çà§: } private function _listSearchMerge(&$DÃùƒ•ƒŸ, $fà£¥¨ÌôÚ, $AÇŒˆ²Ô®°, $Cé‹ä¡éÉá) { goto DšøÄ‡â¨½; DšøÄ‡â¨½: $C´Ø±­„ŞÈ =& $_SERVER[ªúæÂ¡­ä½]; if (!$Cé‹ä¡éÉá) { return; } $bèöì…Œ†‚ = array_to_keyvalue($DÃùƒ•ƒŸ[$C´Ø±­„ŞÈ[367]], $C´Ø±­„ŞÈ[33], $C´Ø±­„ŞÈ[396]); goto eÜ‰º“éŞÛ; b¬›“œ“â·: foreach ($eöÏƒ­âµ— as $E Ç¦ÙöˆŞ) { if ($this->_listSearchFilter($E Ç¦ÙöˆŞ, $fà£¥¨ÌôÚ)) { $c­ˆ•ÕßãÍ[] = $E Ç¦ÙöˆŞ; } } $DÃùƒ•ƒŸ[$C´Ø±­„ŞÈ[367]] = array_merge($c­ˆ•ÕßãÍ, $DÃùƒ•ƒŸ[$C´Ø±­„ŞÈ[367]]); $DÃùƒ•ƒŸ[$C´Ø±­„ŞÈ[364]][$C´Ø±­„ŞÈ[365]] += count($c­ˆ•ÕßãÍ); goto f¦¢ğ¢Ğ; bº‘¨¨òùÎ: $eöÏƒ­âµ— = $this->field($AÇŒˆ²Ô®°)->where($Eåğí¹Â„©)->select(); if (!$eöÏƒ­âµ—) { return; } $c­ˆ•ÕßãÍ = array(); goto b¬›“œ“â·; eÜ‰º“éŞÛ: $F¹ëÚ‹™…¦ = array_diff($Cé‹ä¡éÉá, $bèöì…Œ†‚); if (!$F¹ëÚ‹™…¦) { return; } $Eåğí¹Â„© = array($C´Ø±­„ŞÈ[396] => array($C´Ø±­„ŞÈ[7], $F¹ëÚ‹™…¦)); goto bº‘¨¨òùÎ; f¦¢ğ¢Ğ: } private function _listSearchFilter($bÅµ§øÃß™, $EÓ±”½Û÷) { goto D¾×¶›öğ; D¾×¶›öğ: $DËµ¢Ì¯Ôò =& $_SERVER[ªúæÂ¡­ä½]; $CÉ‘¹¹¥ªÅ = $bÅµ§øÃß™[$DËµ¢Ì¯Ôò[404]] == $DËµ¢Ì¯Ôò[87]; if (!strstr($bÅµ§øÃß™[$DËµ¢Ì¯Ôò[503]], $DËµ¢Ì¯Ôò[47] . $EÓ±”½Û÷[$DËµ¢Ì¯Ôò[479]] . $DËµ¢Ì¯Ôò[47])) { return !1; } goto a†ƒ«˜à…½; a†ƒ«˜à…½: if (isset($EÓ±”½Û÷[$DËµ¢Ì¯Ôò[406]]) && $EÓ±”½Û÷[$DËµ¢Ì¯Ôò[406]] != $DËµ¢Ì¯Ôò[1768]) { if ($EÓ±”½Û÷[$DËµ¢Ì¯Ôò[406]] == $DËµ¢Ì¯Ôò[77] && !$CÉ‘¹¹¥ªÅ) { return !1; } if ($EÓ±”½Û÷[$DËµ¢Ì¯Ôò[406]] != $DËµ¢Ì¯Ôò[77] && $CÉ‘¹¹¥ªÅ) { return !1; } if (!strstr($bÅµ§øÃß™[$DËµ¢Ì¯Ôò[168]], $DËµ¢Ì¯Ôò[47] . $EÓ±”½Û÷[$DËµ¢Ì¯Ôò[406]] . $DËµ¢Ì¯Ôò[47])) { return !1; } } if (isset($EÓ±”½Û÷[$DËµ¢Ì¯Ôò[1964]]) && $EÓ±”½Û÷[$DËµ¢Ì¯Ôò[1964]] < $bÅµ§øÃß™[$DËµ¢Ì¯Ôò[78]]) { return !1; } if (isset($EÓ±”½Û÷[$DËµ¢Ì¯Ôò[1965]]) && $EÓ±”½Û÷[$DËµ¢Ì¯Ôò[1965]] > $bÅµ§øÃß™[$DËµ¢Ì¯Ôò[78]]) { return !1; } goto eîåá‡Æì‡; eîåá‡Æì‡: if (isset($EÓ±”½Û÷[$DËµ¢Ì¯Ôò[576]]) && $EÓ±”½Û÷[$DËµ¢Ì¯Ôò[576]] != $bÅµ§øÃß™[$DËµ¢Ì¯Ôò[435]]) { return !1; } return !0; goto c¿Ó­ÊÒÊ; c¿Ó­ÊÒÊ: } public function listSearchChildren($e‰±½Ğ, $EîÂ®éÉà° = 5000) { goto AèÀèòä¹È; AèÀèòä¹È: $Fêšà›È¶½ =& $_SERVER[ªúæÂ¡­ä½]; $fêÅêœ†«‰ = array(); $añÅåğ“˜† = $this->sourceInfo($e‰±½Ğ); goto Aô°Ì¯¯Š¼; eİÛ¼ƒò–: $b±Äå”¬ñÔ = $this->field($Fêšà›È¶½[396])->where($c±»ß´ËŒ¼)->select(); $fêÅêœ†«‰ = array_to_keyvalue($b±Äå”¬ñÔ, $Fêšà›È¶½[33], $Fêšà›È¶½[396]); return $fêÅêœ†«‰; goto eÜô–êÒ¯É; Aô°Ì¯¯Š¼: $c±»ß´ËŒ¼ = array($Fêšà›È¶½[503] => array($Fêšà›È¶½[380], $añÅåğ“˜†[$Fêšà›È¶½[503]] . $añÅåğ“˜†[$Fêšà›È¶½[396]] . $Fêšà›È¶½[527])); $cÏÜèË£Àˆ = $this->field($Fêšà›È¶½[396])->cache(null, 600)->where($c±»ß´ËŒ¼)->count(); if ($cÏÜèË£Àˆ > $EîÂ®éÉà°) { return $this->_listSearchChildrenNear($e‰±½Ğ, $EîÂ®éÉà°); } goto eİÛ¼ƒò–; eÜô–êÒ¯É: } private function _listSearchChildrenNear($cŒ­İÆƒ¾”, $dñšõ«) { goto C“¯¿Ş”öŒ; d¦²àñ’¾Í: $Bõñ÷Ô¢Ë˜ = $this->field($DöÅ¸æ¿½ä[1966])->where($bŠğÙ…‰¸)->select(); $b ¸¹§Å = array_to_keyvalue(array_filter_by_field($Bõñ÷Ô¢Ë˜, $DöÅ¸æ¿½ä[404], $DöÅ¸æ¿½ä[87]), $DöÅ¸æ¿½ä[33], $DöÅ¸æ¿½ä[396]); $eº××—ê¤µ = array_merge($eº××—ê¤µ, array_to_keyvalue($Bõñ÷Ô¢Ë˜, $DöÅ¸æ¿½ä[33], $DöÅ¸æ¿½ä[396])); goto f›ÚÑÀÆ¤Ç; C“¯¿Ş”öŒ: $DöÅ¸æ¿½ä =& $_SERVER[ªúæÂ¡­ä½]; $eº××—ê¤µ = array(); $bŠğÙ…‰¸ = array($DöÅ¸æ¿½ä[479] => $cŒ­İÆƒ¾”); goto d¦²àñ’¾Í; f›ÚÑÀÆ¤Ç: if (!$b ¸¹§Å) { return $eº××—ê¤µ; } $bŠğÙ…‰¸ = array($DöÅ¸æ¿½ä[479] => array($DöÅ¸æ¿½ä[7], $b ¸¹§Å)); $Bõñ÷Ô¢Ë˜ = $this->field($DöÅ¸æ¿½ä[1966])->where($bŠğÙ…‰¸)->limit($dñšõ«)->select(); goto a„‡ªë†ªõ; a„‡ªë†ªõ: $eº××—ê¤µ = array_merge($eº××—ê¤µ, array_to_keyvalue($Bõñ÷Ô¢Ë˜, $DöÅ¸æ¿½ä[33], $DöÅ¸æ¿½ä[396])); $eº××—ê¤µ = array_slice($eº××—ê¤µ, 0, $dñšõ«); return $eº××—ê¤µ; goto BÂ‚˜ÚÛ; BÂ‚˜ÚÛ: } private function _listSearchBindPinyin($AÈ³ÊÑÉ˜Ï, &$BËöÀÅÇÕä, &$E”ãŠ²İ˜) { goto a´©áìº½‘; a´©áìº½‘: $C½×¨ùµÊ =& $_SERVER[ªúæÂ¡­ä½]; if (!isset($AÈ³ÊÑÉ˜Ï[$C½×¨ùµÊ[1802]]) || !$AÈ³ÊÑÉ˜Ï[$C½×¨ùµÊ[1802]]) { return; } if (!Input::check($AÈ³ÊÑÉ˜Ï[$C½×¨ùµÊ[1802]], $C½×¨ùµÊ[316]) || strlen($AÈ³ÊÑÉ˜Ï[$C½×¨ùµÊ[1802]]) < 2) { return; } goto Bù‡ïæàä°; A“šàˆ®Œ‰: $E”ãŠ²İ˜ = $C½×¨ùµÊ[1968] . str_replace($C½×¨ùµÊ[47], $C½×¨ùµÊ[1969], $E”ãŠ²İ˜); $aÛğªë®Ò = $BËöÀÅÇÕä[$C½×¨ùµÊ[28]]; unset($BËöÀÅÇÕä[$C½×¨ùµÊ[28]]); goto d ÓÉĞÍè–; d ÓÉĞÍè–: foreach ($BËöÀÅÇÕä as $AØâ…Ò²ÄÅ => $a×¼ƒè‰‘) { $eØœ×ËÀÈâ[$C½×¨ùµÊ[1968] . $AØâ…Ò²ÄÅ] = $a×¼ƒè‰‘; } foreach ($aÛğªë®Ò as $C†–‚ÃÆÅ) { $eØœ×ËÀÈâ[] = array($C½×¨ùµÊ[1970] => $C†–‚ÃÆÅ, $C½×¨ùµÊ[974] => $C½×¨ùµÊ[1806], array($C½×¨ùµÊ[1971] => $C†–‚ÃÆÅ, $C½×¨ùµÊ[1972] => array($C½×¨ùµÊ[7], array($C½×¨ùµÊ[445], $C½×¨ùµÊ[444])))); } $this->join($F¦ùŠ„¨Á ); goto Dšëìéºƒ‹; Bù‡ïæàä°: $F¦ùŠ„¨Á  = "\x4c\105\x46\x54\40\x4a\117\x49\x4e\40{$this->tablePrefix}\151\157\x5f\163\x6f\165\x72\143\145\x5f\x6d\145\164\141\x20\155\145\x74\141\x20\x6f\x6e\40\x73\157\165\162\x63\x65\56\163\157\165\162\143\145\x49\104\x20\75\40\155\145\x74\141\x2e\163\x6f\x75\162\143\145\x49\x44"; $eØœ×ËÀÈâ = array(); $E”ãŠ²İ˜ = str_replace(array($C½×¨ùµÊ[229], $C½×¨ùµÊ[50], $C½×¨ùµÊ[1967]), $C½×¨ùµÊ[33], $E”ãŠ²İ˜); goto A“šàˆ®Œ‰; Dšëìéºƒ‹: $BËöÀÅÇÕä = $eØœ×ËÀÈâ; goto fİµ³Ø™˜á; fİµ³Ø™˜á: } private function _parseSearchWhere($bÌŠ¡ğÀİ¤) { goto fâß®‚ö¿¿; f¿êá«ŞÌœ: if (isset($bÌŠ¡ğÀİ¤[$d‚°«õÀ½®[477]]) && $bÌŠ¡ğÀİ¤[$d‚°«õÀ½®[477]]) { $Eµ‚ î“Óö = array($d‚°«õÀ½®[1974], $bÌŠ¡ğÀİ¤[$d‚°«õÀ½®[477]]); if ($dµÛŒ­ê±[$d‚°«õÀ½®[84]]) { $dµÛŒ­ê±[$d‚°«õÀ½®[84]] = array($dµÛŒ­ê±[$d‚°«õÀ½®[84]], $Eµ‚ î“Óö, $d‚°«õÀ½®[1975]); } else { $dµÛŒ­ê±[$d‚°«õÀ½®[84]] = $Eµ‚ î“Óö; } } if (isset($bÌŠ¡ğÀİ¤[$d‚°«õÀ½®[1964]]) && $bÌŠ¡ğÀİ¤[$d‚°«õÀ½®[1964]] > 0) { $dµÛŒ­ê±[$d‚°«õÀ½®[78]] = array($d‚°«õÀ½®[1973], $bÌŠ¡ğÀİ¤[$d‚°«õÀ½®[1964]]); } if (isset($bÌŠ¡ğÀİ¤[$d‚°«õÀ½®[1965]]) && $bÌŠ¡ğÀİ¤[$d‚°«õÀ½®[1965]]) { $Eµ‚ î“Óö = array($d‚°«õÀ½®[1974], $bÌŠ¡ğÀİ¤[$d‚°«õÀ½®[1965]]); if ($dµÛŒ­ê±[$d‚°«õÀ½®[78]]) { $dµÛŒ­ê±[$d‚°«õÀ½®[78]] = array($dµÛŒ­ê±[$d‚°«õÀ½®[78]], $Eµ‚ î“Óö, $d‚°«õÀ½®[1975]); } else { $dµÛŒ­ê±[$d‚°«õÀ½®[78]] = $Eµ‚ î“Óö; } } goto D’ÕÇèö«; fâß®‚ö¿¿: $d‚°«õÀ½® =& $_SERVER[ªúæÂ¡­ä½]; $dµÛŒ­ê± = array(); if (isset($bÌŠ¡ğÀİ¤[$d‚°«õÀ½®[739]]) && $bÌŠ¡ğÀİ¤[$d‚°«õÀ½®[739]]) { $dµÛŒ­ê±[$d‚°«õÀ½®[84]] = array($d‚°«õÀ½®[1973], $bÌŠ¡ğÀİ¤[$d‚°«õÀ½®[739]]); } goto f¿êá«ŞÌœ; D’ÕÇèö«: if (isset($bÌŠ¡ğÀİ¤[$d‚°«õÀ½®[576]]) && $bÌŠ¡ğÀİ¤[$d‚°«õÀ½®[576]]) { $dµÛŒ­ê±[] = array($d‚°«õÀ½®[435] => $bÌŠ¡ğÀİ¤[$d‚°«õÀ½®[576]], $d‚°«õÀ½®[433] => $bÌŠ¡ğÀİ¤[$d‚°«õÀ½®[576]], $d‚°«õÀ½®[974] => $d‚°«õÀ½®[1806]); } if (isset($bÌŠ¡ğÀİ¤[$d‚°«õÀ½®[406]]) && $bÌŠ¡ğÀİ¤[$d‚°«õÀ½®[406]]) { $cŸ¬Ä‰¹‘™ = $bÌŠ¡ğÀİ¤[$d‚°«õÀ½®[406]]; if ($cŸ¬Ä‰¹‘™ == $d‚°«õÀ½®[77]) { $dµÛŒ­ê±[$d‚°«õÀ½®[404]] = 1; } else { if ($cŸ¬Ä‰¹‘™ == $d‚°«õÀ½®[1976]) { $dµÛŒ­ê±[$d‚°«õÀ½®[404]] = 0; } else { if ($cŸ¬Ä‰¹‘™) { $cŸ¬Ä‰¹‘™ = is_array($cŸ¬Ä‰¹‘™) ? $cŸ¬Ä‰¹‘™ : explode($d‚°«õÀ½®[47], $cŸ¬Ä‰¹‘™); $dµÛŒ­ê±[$d‚°«õÀ½®[406]] = array($d‚°«õÀ½®[412], $cŸ¬Ä‰¹‘™); $dµÛŒ­ê±[$d‚°«õÀ½®[404]] = 0; } } } } if (isset($bÌŠ¡ğÀİ¤[$d‚°«õÀ½®[479]]) && $bÌŠ¡ğÀİ¤[$d‚°«õÀ½®[479]]) { $Føî‡‰¥§° = $this->sourceInfo($bÌŠ¡ğÀİ¤[$d‚°«õÀ½®[479]]); $dµÛŒ­ê±[$d‚°«õÀ½®[567]] = array($d‚°«õÀ½®[526], $Føî‡‰¥§°[$d‚°«õÀ½®[503]] . $bÌŠ¡ğÀİ¤[$d‚°«õÀ½®[479]] . $d‚°«õÀ½®[527]); } goto EóÖ«öİ; EóÖ«öİ: if (isset($bÌŠ¡ğÀİ¤[$d‚°«õÀ½®[1802]]) && trim($bÌŠ¡ğÀİ¤[$d‚°«õÀ½®[1802]])) { $DƒÚÏ™øó® = trim($bÌŠ¡ğÀİ¤[$d‚°«õÀ½®[1802]]); $dì¾íŞ‡à˜ = explode($d‚°«õÀ½®[50], $DƒÚÏ™øó®); if (strlen($DƒÚÏ™øó®) > 2 && (substr($DƒÚÏ™øó®, 0, 1) == $d‚°«õÀ½®[116] && substr($DƒÚÏ™øó®, -1) == $d‚°«õÀ½®[116]) || substr($DƒÚÏ™øó®, 0, 1) == $d‚°«õÀ½®[55] && substr($DƒÚÏ™øó®, -1) == $d‚°«õÀ½®[55]) { $DƒÚÏ™øó® = substr($DƒÚÏ™øó®, 1, -1); $dì¾íŞ‡à˜ = array($DƒÚÏ™øó®); } $dµÛŒ­ê±[$d‚°«õÀ½®[28]] = array(array($d‚°«õÀ½®[526], $d‚°«õÀ½®[1804] . $DƒÚÏ™øó® . $d‚°«õÀ½®[1804])); if (count($dì¾íŞ‡à˜) > 1) { $dµÛŒ­ê±[$d‚°«õÀ½®[28]] = array(); foreach ($dì¾íŞ‡à˜ as $d¤èõÒÈ“) { if (!trim($d¤èõÒÈ“)) { continue; } $dµÛŒ­ê±[$d‚°«õÀ½®[28]][] = array($d‚°«õÀ½®[526], $d‚°«õÀ½®[1804] . trim($d¤èõÒÈ“) . $d‚°«õÀ½®[1804]); } } } return $dµÛŒ­ê±; goto dâ¶ºÖç»; dâ¶ºÖç»: } } class SourceModel extends SourceListSearchModel { public $statusIgnoreResetSpace = false; public function userRootAdd($eÁ±êŒŠ½Ô) { $Cé£´»ŒŒš =& $_SERVER[ªúæÂ¡­ä½]; $CŞ­Ëéòƒ‹ = Model($Cé£´»ŒŒš[495])->where(array($Cé£´»ŒŒš[1536] => $eÁ±êŒŠ½Ô))->find(); $c¤›øî“”Û = $this->_mkdirRoot(SourceModel::TYPE_USER, $eÁ±êŒŠ½Ô, $CŞ­Ëéòƒ‹[$Cé£´»ŒŒš[28]]); $this->userDesktopAdd($c¤›øî“”Û); return $c¤›øî“”Û; } public function userDesktopAdd($CÓø‹ğéÔÇ) { $Aåô‹˜‡  =& $_SERVER[ªúæÂ¡­ä½]; $c••«ì–ÚĞ = LNG($Aåô‹˜‡ [1977]); $EŸ˜Åóãê = $this->mkdir($CÓø‹ğéÔÇ, $c••«ì–ÚĞ); $this->metaSet($EŸ˜Åóãê, $Aåô‹˜‡ [1978], $Aåô‹˜‡ [87]); $this->metaSet($CÓø‹ğéÔÇ, $Aåô‹˜‡ [1979], $EŸ˜Åóãê); } public function groupRootAdd($eÎ›‚Ô†ó) { $DÄõîæÌÈ =& $_SERVER[ªúæÂ¡­ä½]; $D”„Õæƒ¬Ì = Model($DÄõîæÌÈ[504])->where(array($DÄõîæÌÈ[1798] => $eÎ›‚Ô†ó))->find(); return $this->_mkdirRoot(SourceModel::TYPE_GROUP, $eÎ›‚Ô†ó, $D”„Õæƒ¬Ì[$DÄõîæÌÈ[28]]); } public function systemRootPathAdd($f¤ËŸ«­Ğ) { if ($f¤ËŸ«­Ğ != $_SERVER[ªúæÂ¡­ä½][519]) { return !1; } return $this->_mkdirRoot(SourceModel::TYPE_SYSTEM, 0, $f¤ËŸ«­Ğ); } public function userRootRemove($Cø¨Ş´Û ‰) { $fùøåîÖÄ = $this->sourceRoot(SourceModel::TYPE_USER, $Cø¨Ş´Û ‰); if (!$fùøåîÖÄ) { return; } $this->remove($fùøåîÖÄ, !1); } public function groupRootRemove($bÛÑ˜ïøôã) { $c——™ÚÂ‡­ = $this->sourceRoot(SourceModel::TYPE_GROUP, $bÛÑ˜ïøôã); if (!$c——™ÚÂ‡­) { return; } $this->remove($c——™ÚÂ‡­, !1); } private function _mkdirRoot($DÜ…àİÓÏ¦, $CªÙˆ°ö´â, $d¶£“’×É) { goto Eëò™¼ôùº; f¶ÄÕõŒ¢’: CacheLock::unlock($E÷öÀãÔö); return $CŞÄ…–Üåº; goto eƒ°Ù‹¯„‚; Eëò™¼ôùº: $Fˆäõ²Àí¯ =& $_SERVER[ªúæÂ¡­ä½]; $b²ÀßˆÚ = array($Fˆäõ²Àí¯[395] => 0, $Fˆäõ²Àí¯[563] => $DÜ…àİÓÏ¦, $Fˆäõ²Àí¯[564] => $CªÙˆ°ö´â, $Fˆäõ²Àí¯[560] => 1, $Fˆäõ²Àí¯[565] => USER_ID, $Fˆäõ²Àí¯[566] => USER_ID, $Fˆäõ²Àí¯[561] => $Fˆäõ²Àí¯[33], $Fˆäõ²Àí¯[567] => $Fˆäõ²Àí¯[513], $Fˆäõ²Àí¯[423] => 0, $Fˆäõ²Àí¯[562] => 0, $Fˆäõ²Àí¯[449] => 0, $Fˆäõ²Àí¯[568] => $Fˆäõ²Àí¯[33]); if ($e¹º´Úªñ£ = $this->where($b²ÀßˆÚ)->find()) { return $e¹º´Úªñ£[$Fˆäõ²Àí¯[396]]; } goto A½·½°ŠŸ; A½·½°ŠŸ: $E÷öÀãÔö = "\115\x6f\x64\x65\154\x53\157\x75\162\143\x65\x2e\155\x6b\x64\x69\x72\122\x6f\157\164\x2e{$DÜ…àİÓÏ¦}\x2e{$CªÙˆ°ö´â}\x2e" . $d¶£“’×É; CacheLock::lock($E÷öÀãÔö); $b²ÀßˆÚ[$Fˆäõ²Àí¯[28]] = $d¶£“’×É; goto E©Ó»ñğ„‚; E©Ó»ñğ„‚: $CŞÄ…–Üåº = $this->add($b²ÀßˆÚ); $A¹‚æïòÏ = array($Fˆäõ²Àí¯[569] => short_id($CŞÄ…–Üåº)); $this->where(array($Fˆäõ²Àí¯[411] => $CŞÄ…–Üåº))->save($A¹‚æïòÏ); goto f¶ÄÕõŒ¢’; eƒ°Ù‹¯„‚: } private function sourceRoot($Dİ‡Î¬ª¹š, $cª…ÚÈ¡½—, $E×„Û–Ëé = false) { $fö¦½‹‹›Ã =& $_SERVER[ªúæÂ¡­ä½]; $Fø­„¥®¶è = array($fö¦½‹‹›Ã[395] => 0, $fö¦½‹‹›Ã[563] => $Dİ‡Î¬ª¹š, $fö¦½‹‹›Ã[564] => $cª…ÚÈ¡½—); if ($c©¿õ±çİ = $this->where($Fø­„¥®¶è)->find()) { return $E×„Û–Ëé ? $c©¿õ±çİ : $c©¿õ±çİ[$fö¦½‹‹›Ã[396]]; } return !1; } public function sourceRootGroup($AŸƒê¤…‹…) { goto Dœˆ°àƒê; Aù÷ñìíîš: $this->selectPageReset(); $D÷Ğ¤¢ÓÛô = $this->limit(count($AŸƒê¤…‹…))->listSource($e›İÀÇ¢ Ú, 1000); $this->selectPageRestore(); goto c‡£Íå„ª‹; c‡£Íå„ª‹: return array_to_keyvalue($D÷Ğ¤¢ÓÛô[$Cè™ÖƒÆå•[75]], $Cè™ÖƒÆå•[485]); goto EñÏº½“Š»; Dœˆ°àƒê: $Cè™ÖƒÆå• =& $_SERVER[ªúæÂ¡­ä½]; if (is_string($AŸƒê¤…‹…)) { $AŸƒê¤…‹… = array($AŸƒê¤…‹…); } $e›İÀÇ¢ Ú = array($Cè™ÖƒÆå•[395] => 0, $Cè™ÖƒÆå•[564] => array($Cè™ÖƒÆå•[7], $AŸƒê¤…‹…), $Cè™ÖƒÆå•[563] => SourceModel::TYPE_GROUP); goto Aù÷ñìíîš; EñÏº½“Š»: } public function mkfile($e‹åÖ…²·Â, $aÇÙ«ÑÌ£¨, $eŸÉÜº† = '', $Ešó£‹·¶¨ = REPEAT_RENAME) { $CÇµëÔá¤Å =& $_SERVER[ªúæÂ¡­ä½]; $E¹ëÛÉ¸ƒ« = Model($CÇµëÔá¤Å[585])->addFileByContent($eŸÉÜº†, $aÇÙ«ÑÌ£¨); return $this->_createFileCall($e‹åÖ…²·Â, $aÇÙ«ÑÌ£¨, $E¹ëÛÉ¸ƒ«, $Ešó£‹·¶¨, $CÇµëÔá¤Å[1231]); } public function addFile($BŞ‹ÃÂ×çÓ, $DŸ×ºÉñ”˜, $E’×é¸êÌ, $B­ò´ÉÈùï = false, $e î¥ÓÊ™™ = REPEAT_RENAME) { $b©­©˜¸«ë = Model($_SERVER[ªúæÂ¡­ä½][585])->addFile($DŸ×ºÉñ”˜, $E’×é¸êÌ, $B­ò´ÉÈùï); return $this->_createFileCall($BŞ‹ÃÂ×çÓ, $E’×é¸êÌ, $b©­©˜¸«ë, $e î¥ÓÊ™™); } public function addFileByFileID($b …ÖËÖ, $fò«Ç¦­çÜ, $CÓ±¸„¦å¥, $f˜Ş•åŸ¦° = REPEAT_RENAME) { $Eğì„…Ÿì =& $_SERVER[ªúæÂ¡­ä½]; $e¦©Á¦×É = Model($Eğì„…Ÿì[585])->find($fò«Ç¦­çÜ); Model($Eğì„…Ÿì[585])->linkAdd($fò«Ç¦­çÜ); return $this->_createFileCall($b …ÖËÖ, $CÓ±¸„¦å¥, $e¦©Á¦×É, $f˜Ş•åŸ¦°); } public function addFileByRemote($Cåß°ô¡, $B¿ïëÄÂõ¤, $D‡É††Ü„, $B‰‘òµôÎÍ = array(), $D¯«ÈÍÔË = REPEAT_RENAME) { $Aº¤Ï‰Ìõ† = Model($_SERVER[ªúæÂ¡­ä½][585])->addFileByRemote($B¿ïëÄÂõ¤, $D‡É††Ü„, $B‰‘òµôÎÍ); return $this->_createFileCall($Cåß°ô¡, $D‡É††Ü„, $Aº¤Ï‰Ìõ†, $D¯«ÈÍÔË); } private function _createFileCall($Cä‚•Û©Äñ, $b»Ø´¹’‡¼, $a„Â×£ÄÃß, $Aâêéñò½î, $fÄ¿®…äİ = "\x75\x70\154\x6f\x61\x64") { goto d”©»†øğ‰; d”©»†øğ‰: $cÎ£¢×È‡ˆ =& $_SERVER[ªúæÂ¡­ä½]; $DÍí²—òÏå = !1; $this->setMasterDB(); goto bŒ´¼Ö¿®; aÆëƒÕÏ°…: return $F¸¼¿İº·¤; goto a™±õğÃˆ; aÉ±ùËğ: if (!$DÍí²—òÏå) { Model($cÎ£¢×È‡ˆ[451])->remove($a„Â×£ÄÃß[$cÎ£¢×È‡ˆ[448]]); } if ($DÍí²—òÏå && $F¸¼¿İº·¤ && $F¸¼¿İº·¤ != $b›œêïßŸ) { Model($cÎ£¢×È‡ˆ[1948])->eventCreate($F¸¼¿İº·¤, $fÄ¿®…äİ); } $this->lockWriteEnd($Cä‚•Û©Äñ, $b»Ø´¹’‡¼); goto aÆëƒÕÏ°…; bŒ´¼Ö¿®: $this->lockWriteStart($Cä‚•Û©Äñ, $b»Ø´¹’‡¼); $b›œêïßŸ = $this->fileNameExist($Cä‚•Û©Äñ, $b»Ø´¹’‡¼); $F¸¼¿İº·¤ = $this->_createFile($Cä‚•Û©Äñ, $b»Ø´¹’‡¼, $a„Â×£ÄÃß, $Aâêéñò½î, $DÍí²—òÏå); goto aÉ±ùËğ; a™±õğÃˆ: } public function mkdir($cÖ÷¦ÙĞ’©, $fÃ¶Ã™ÈÆ½, $aëó‰‰İ±è = REPEAT_SKIP) { goto BÓŸƒÍ¬óš; f™Æº‚âÚï: $this->lockWriteEnd($cÖ÷¦ÙĞ’©, $fÃ¶Ã™ÈÆ½); return $bÂ²´Ã÷ªÕ; goto F¯éŒîÓ; eãïÅÙæ¶ª: $b–Ó„÷îå = array($cóçâ©õĞ©[560] => 1, $cóçâ©õĞ©[414] => $fÃ¶Ã™ÈÆ½, $cóçâ©õĞ©[561] => $cóçâ©õĞ©[33], $cóçâ©õĞ©[449] => 0, $cóçâ©õĞ©[562] => 0); $bÂ²´Ã÷ªÕ = $this->_addSoure($b–Ó„÷îå, $CÕ¥ğ‹†ï); Model($cóçâ©õĞ©[1948])->eventCreate($bÂ²´Ã÷ªÕ, $cóçâ©õĞ©[1232]); goto f™Æº‚âÚï; B¡‚›Àº¹‡: if (!$CÕ¥ğ‹†ï) { return !1; } $this->lockWriteStart($cÖ÷¦ÙĞ’©, $fÃ¶Ã™ÈÆ½); if ($aëó‰‰İ±è !== !1) { $D´†¥öŸÒ = $this->fileNameExist($cÖ÷¦ÙĞ’©, $fÃ¶Ã™ÈÆ½); if ($D´†¥öŸÒ && $aëó‰‰İ±è != REPEAT_RENAME_FOLDER) { $this->lockWriteEnd($cÖ÷¦ÙĞ’©, $fÃ¶Ã™ÈÆ½); return $D´†¥öŸÒ; } $fÃ¶Ã™ÈÆ½ = $this->fileNameAuto($cÖ÷¦ÙĞ’©, $fÃ¶Ã™ÈÆ½, $aëó‰‰İ±è); } goto eãïÅÙæ¶ª; BÓŸƒÍ¬óš: $cóçâ©õĞ© =& $_SERVER[ªúæÂ¡­ä½]; $this->setMasterDB(); $CÕ¥ğ‹†ï = $this->sourceInfo($cÖ÷¦ÙĞ’©); goto B¡‚›Àº¹‡; F¯éŒîÓ: } private function _createFile($EİÈíêÜÅ˜, $DÍªèœ‹­Ñ, $FõÎéˆƒ, $b¥‹”ŞïÅ­, &$a§»ŠÁó§¥) { goto b¢š²ëêÅƒ; cÁèö…ğ„‘: return $BÂ¤öäÙØ‡; goto eåŞÊ‹Ñ„é; B‡ÏºØè: $B÷¨Ò¶˜¾õ = array($bå³‰Ú÷Äì[560] => 0, $bå³‰Ú÷Äì[414] => $DÍªèœ‹­Ñ, $bå³‰Ú÷Äì[561] => substr(get_path_ext($DÍªèœ‹­Ñ), 0, 10), $bå³‰Ú÷Äì[449] => $FõÎéˆƒ[$bå³‰Ú÷Äì[448]], $bå³‰Ú÷Äì[562] => $FõÎéˆƒ[$bå³‰Ú÷Äì[78]]); $BÂ¤öäÙØ‡ = $this->_addSoure($B÷¨Ò¶˜¾õ, $dë¼¥Ó…ß); $this->folderSizeReset($EİÈíêÜÅ˜, intval($B÷¨Ò¶˜¾õ[$bå³‰Ú÷Äì[78]])); goto cÁèö…ğ„‘; b¢š²ëêÅƒ: $bå³‰Ú÷Äì =& $_SERVER[ªúæÂ¡­ä½]; $dë¼¥Ó…ß = $this->sourceInfo($EİÈíêÜÅ˜); if (!$FõÎéˆƒ || !$dë¼¥Ó…ß) { return !1; } goto EÃ©ÍÃ ÉÄ; EÃ©ÍÃ ÉÄ: if ($b¥‹”ŞïÅ­ !== !1) { $Déá¢›‰Å = $this->fileNameExist($EİÈíêÜÅ˜, $DÍªèœ‹­Ñ); } $a§»ŠÁó§¥ = !0; if ($b¥‹”ŞïÅ­ && $Déá¢›‰Å) { if ($b¥‹”ŞïÅ­ == REPEAT_SKIP) { $a§»ŠÁó§¥ = !1; return $Déá¢›‰Å; } else { if ($b¥‹”ŞïÅ­ == REPEAT_REPLACE) { $c¬ñ¶º¦·  = $this->sourceInfo($Déá¢›‰Å); $AàÀ–Ëƒ…ù = $this->fileHistory($c¬ñ¶º¦· , $FõÎéˆƒ[$bå³‰Ú÷Äì[448]], $FõÎéˆƒ[$bå³‰Ú÷Äì[78]]); if (!$AàÀ–Ëƒ…ù) { $a§»ŠÁó§¥ = !1; } else { $this->folderSizeReset($EİÈíêÜÅ˜); } return $Déá¢›‰Å; } else { $DÍªèœ‹­Ñ = $this->fileNameAuto($EİÈíêÜÅ˜, $DÍªèœ‹­Ñ, $b¥‹”ŞïÅ­, !1); } } } goto B‡ÏºØè; eåŞÊ‹Ñ„é: } protected function fileHistory($eÑœ÷‡™, $DÜÄì‘˜§È, $C³–‹Ğªï®) { goto b“ù™“Ø; f¡Í¦‚•ã¿: $this->where(array($b­ŠèòÒ¾[411] => $eÑœ÷‡™[$b­ŠèòÒ¾[396]]))->save($b®Öï™Ù‘Ÿ); $this->sourceCacheClear($eÑœ÷‡™[$b­ŠèòÒ¾[396]]); return !0; goto FÓ†ºù’±ï; b“ù™“Ø: $b­ŠèòÒ¾ =& $_SERVER[ªúæÂ¡­ä½]; $cˆ¤¹ŠŒä = defined($b­ŠèòÒ¾[455]) ? USER_ID : $b­ŠèòÒ¾[191]; if ($eÑœ÷‡™[$b­ŠèòÒ¾[448]] == $DÜÄì‘˜§È) { return !1; } goto F½ó‰Ò¦; F½ó‰Ò¦: $this->checkLock($eÑœ÷‡™[$b­ŠèòÒ¾[396]], $DÜÄì‘˜§È); Model($b­ŠèòÒ¾[1980])->addHistory($eÑœ÷‡™); $b®Öï™Ù‘Ÿ = array($b­ŠèòÒ¾[566] => $cˆ¤¹ŠŒä, $b­ŠèòÒ¾[418] => time(), $b­ŠèòÒ¾[448] => $DÜÄì‘˜§È, $b­ŠèòÒ¾[78] => $C³–‹Ğªï®); goto f¡Í¦‚•ã¿; FÓ†ºù’±ï: } public function checkLock($b¿‡“ƒµæÂ, $f®³ÄˆÀ±º) { goto cê¦˜ö¥ù®; C„ÂÛ–²Ê: $this->_createFileCall($BºÚÎøÈ¬å[$Aô†³İÌê–[479]], $E‰ŒÎåêä£, $E“ìÅ”î´, REPEAT_REPLACE, $Aô†³İÌê–[1231]); $dëõ‹§ä› = $BºÚÎøÈ¬å[$Aô†³İÌê–[446]][$Aô†³İÌê–[524]]; $CëƒÃ¤‚ïâ = $dëõ‹§ä›[$Aô†³İÌê–[1982]] ? $dëõ‹§ä›[$Aô†³İÌê–[1982]] : $dëõ‹§ä›[$Aô†³İÌê–[28]]; goto báå¦ÃæÙ; F–é—É¡½: $D‰ï±ÕÂôÓ = Session::get($Aô†³İÌê–[1981]); $E‰ŒÎåêä£ = substr($BºÚÎøÈ¬å[$Aô†³İÌê–[28]], 0, -1 - strlen($BºÚÎøÈ¬å[$Aô†³İÌê–[168]])) . $Aô†³İÌê–[1497] . $D‰ï±ÕÂôÓ . $Aô†³İÌê–[95] . $BºÚÎøÈ¬å[$Aô†³İÌê–[168]]; $E“ìÅ”î´ = Model($Aô†³İÌê–[585])->find($f®³ÄˆÀ±º); goto C„ÂÛ–²Ê; báå¦ÃæÙ: show_json(LNG($Aô†³İÌê–[1983]) . $Aô†³İÌê–[1984] . LNG($Aô†³İÌê–[1985]) . $Aô†³İÌê–[1986] . $CëƒÃ¤‚ïâ . $Aô†³İÌê–[1987], !1); goto A†×“„øé; cê¦˜ö¥ù®: $Aô†³İÌê– =& $_SERVER[ªúæÂ¡­ä½]; $BºÚÎøÈ¬å = $this->pathInfo($b¿‡“ƒµæÂ); if (!$this->fileIsLock($BºÚÎøÈ¬å, !0)) { return; } goto F–é—É¡½; A†×“„øé: } public function fileIsLock($fÌè«ÍâËÓ, $f”µìÙÔóÒ = false) { goto eÚ¸¦ÚàÎ; fÀ ¸ÖÓ: $aÜ©ŠÔ»’ª = $GLOBALS[$dÊŒ‹Ô’î—[6]][$dÊŒ‹Ô’î—[88]][$dÊŒ‹Ô’î—[522]]; if ($fÌè«ÍâËÓ[$dÊŒ‹Ô’î—[446]][$dÊŒ‹Ô’î—[523]] <= time() - $aÜ©ŠÔ»’ª) { $this->metaSet($fÌè«ÍâËÓ[$dÊŒ‹Ô’î—[396]], $dÊŒ‹Ô’î—[521], null); $this->metaSet($fÌè«ÍâËÓ[$dÊŒ‹Ô’î—[396]], $dÊŒ‹Ô’î—[523], null); } if ($f”µìÙÔóÒ) { $this->metaSet($fÌè«ÍâËÓ[$dÊŒ‹Ô’î—[396]], $dÊŒ‹Ô’î—[523], time()); } goto FÚÛÛÁç›; FÚÛÛÁç›: return !1; goto bæÄñÔÎœ«; eÚ¸¦ÚàÎ: $dÊŒ‹Ô’î— =& $_SERVER[ªúæÂ¡­ä½]; if (!isset($fÌè«ÍâËÓ[$dÊŒ‹Ô’î—[446]]) || !$fÌè«ÍâËÓ[$dÊŒ‹Ô’î—[446]][$dÊŒ‹Ô’î—[521]]) { return !1; } if ($fÌè«ÍâËÓ[$dÊŒ‹Ô’î—[446]][$dÊŒ‹Ô’î—[521]] != USER_ID) { return !0; } goto fÀ ¸ÖÓ; bæÄñÔÎœ«: } private function _addSoure($fïÒÒ¤¬«È, $e‚­¤ˆ¼ªƒ) { goto A†à¥à±‡ø; A†à¥à±‡ø: $fÓÆŒÈÅóˆ =& $_SERVER[ªúæÂ¡­ä½]; $e´˜Ìâ±£ª = defined($fÓÆŒÈÅóˆ[455]) ? USER_ID : $fÓÆŒÈÅóˆ[191]; $BÒ‰·ô¼Ë² = array($fÓÆŒÈÅóˆ[563] => $e‚­¤ˆ¼ªƒ[$fÓÆŒÈÅóˆ[405]], $fÓÆŒÈÅóˆ[564] => $e‚­¤ˆ¼ªƒ[$fÓÆŒÈÅóˆ[485]], $fÓÆŒÈÅóˆ[565] => $e´˜Ìâ±£ª, $fÓÆŒÈÅóˆ[566] => $e´˜Ìâ±£ª, $fÓÆŒÈÅóˆ[395] => $e‚­¤ˆ¼ªƒ[$fÓÆŒÈÅóˆ[396]], $fÓÆŒÈÅóˆ[567] => $e‚­¤ˆ¼ªƒ[$fÓÆŒÈÅóˆ[503]] . $e‚­¤ˆ¼ªƒ[$fÓÆŒÈÅóˆ[396]] . $fÓÆŒÈÅóˆ[47], $fÓÆŒÈÅóˆ[423] => 0, $fÓÆŒÈÅóˆ[568] => $fÓÆŒÈÅóˆ[33]); goto F‹±ŸÄ£‰«; F‹±ŸÄ£‰«: $fïÒÒ¤¬«È = array_merge($BÒ‰·ô¼Ë², $fïÒÒ¤¬«È); $this->updateModifyTime($fïÒÒ¤¬«È[$fÓÆŒÈÅóˆ[479]]); $aÓê…§à›é = $fÓÆŒÈÅóˆ[1988] . $e‚­¤ˆ¼ªƒ[$fÓÆŒÈÅóˆ[396]]; goto Bˆ–­ù§¨; b“šó§±µÃ: $this->setNamePinyin($A¼ ÄŒ’ô, $fïÒÒ¤¬«È[$fÓÆŒÈÅóˆ[28]]); return $A¼ ÄŒ’ô; goto Dİ òãÕ; Bˆ–­ù§¨: if (isset(self::$cacheChildList[$aÓê…§à›é])) { unset(self::$cacheChildList[$aÓê…§à›é]); } static $F…ŒÆÂİ«ò = false; if (!$F…ŒÆÂİ«ò) { Hook::trigger($fÓÆŒÈÅóˆ[550], $fïÒÒ¤¬«È); $F…ŒÆÂİ«ò = !0; } goto eç¥Ğò´é†; eç¥Ğò´é†: $A¼ ÄŒ’ô = $this->add($fïÒÒ¤¬«È); $a‡ÙŸå¥•ô = array($fÓÆŒÈÅóˆ[569] => short_id($A¼ ÄŒ’ô)); $this->where(array($fÓÆŒÈÅóˆ[411] => $A¼ ÄŒ’ô))->save($a‡ÙŸå¥•ô); goto b“šó§±µÃ; Dİ òãÕ: } public function remove($b…æ‡âî»Ö, $fº½ˆ‰Å¦– = true) { goto c·ñ±ŠÍ“; c·ñ±ŠÍ“: $D£‡°‹ƒ‰É =& $_SERVER[ªúæÂ¡­ä½]; $DÊÚ»–Ì©ï = $this->sourceInfo($b…æ‡âî»Ö); $C±ÔäÙã‡Ó = intval($DÊÚ»–Ì©ï[$D£‡°‹ƒ‰É[405]]) === self::TYPE_SYSTEM; goto E˜½ê à; CÒ¿åÅ™Á: CacheLock::unlock($a©è¢Š«); $this->metaSet($b…æ‡âî»Ö, $D£‡°‹ƒ‰É[1997], $DÊÚ»–Ì©ï[$D£‡°‹ƒ‰É[479]]); $this->where(array($D£‡°‹ƒ‰É[396] => $b…æ‡âî»Ö))->save(array($D£‡°‹ƒ‰É[418] => time())); goto Bó·Øƒù÷Ä; f‚±¯Â¡À: $b¢ƒª©°‚è = $DÊÚ»–Ì©ï[$D£‡°‹ƒ‰É[405]] == self::TYPE_USER ? $D£‡°‹ƒ‰É[576] : $D£‡°‹ƒ‰É[497]; if ($b¢ƒª©°‚è == $D£‡°‹ƒ‰É[576]) { $FæíĞåï = Model($D£‡°‹ƒ‰É[495])->getInfo($DÊÚ»–Ì©ï[$D£‡°‹ƒ‰É[485]]); $D¸Í„µ®‡İ = !empty($FæíĞåï[$D£‡°‹ƒ‰É[1982]]) ? $FæíĞåï[$D£‡°‹ƒ‰É[1982]] : $FæíĞåï[$D£‡°‹ƒ‰É[28]]; $D¸Í„µ®‡İ = $D£‡°‹ƒ‰É[258] . $D¸Í„µ®‡İ . $D£‡°‹ƒ‰É[1990] . $DÊÚ»–Ì©ï[$D£‡°‹ƒ‰É[485]]; } else { $FæíĞåï = Model($D£‡°‹ƒ‰É[504])->getInfo($DÊÚ»–Ì©ï[$D£‡°‹ƒ‰É[485]]); $D¸Í„µ®‡İ = _get($FæíĞåï, $D£‡°‹ƒ‰É[28]); $D¸Í„µ®‡İ = $D£‡°‹ƒ‰É[160] . $D¸Í„µ®‡İ . $D£‡°‹ƒ‰É[1991] . $DÊÚ»–Ì©ï[$D£‡°‹ƒ‰É[485]]; } $a©è¢Š« = $D£‡°‹ƒ‰É[1992] . md5($D¸Í„µ®‡İ); goto dàâ¹Çê·; dàâ¹Çê·: CacheLock::lock($a©è¢Š«); $b´‘’Ëˆ« = $this->fileNameExist($Aì”‡æ’Õ², $D¸Í„µ®‡İ); if (!$b´‘’Ëˆ«) { $b´‘’Ëˆ« = $this->mkdir($Aì”‡æ’Õ², $D¸Í„µ®‡İ, REPEAT_SKIP); $this->metaSet($b´‘’Ëˆ«, $D£‡°‹ƒ‰É[1993], $b¢ƒª©°‚è); $this->metaSet($b´‘’Ëˆ«, $D£‡°‹ƒ‰É[1994], $DÊÚ»–Ì©ï[$D£‡°‹ƒ‰É[485]]); if ($DÊÚ»–Ì©ï[$D£‡°‹ƒ‰É[479]] != 0) { $this->metaSet($b´‘’Ëˆ«, $D£‡°‹ƒ‰É[1995], _get($FæíĞåï, $D£‡°‹ƒ‰É[1996])); } } goto CÒ¿åÅ™Á; f“³«Õ‰: return $aÛî£†ØèŞ; goto F¶©ø¡ º; E˜½ê à: $E·çÓè‚Ë¶ = Model($D£‡°‹ƒ‰É[487])->get($D£‡°‹ƒ‰É[1989]) == $D£‡°‹ƒ‰É[87]; if ($C±ÔäÙã‡Ó || $fº½ˆ‰Å¦– || !$E·çÓè‚Ë¶) { return $this->removeNow($b…æ‡âî»Ö, $fº½ˆ‰Å¦–); } $Aì”‡æ’Õ² = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); goto f‚±¯Â¡À; Bó·Øƒù÷Ä: $this->recycleClear($DÊÚ»–Ì©ï); $aÛî£†ØèŞ = $this->move($b…æ‡âî»Ö, $b´‘’Ëˆ«, REPEAT_RENAME_FOLDER); $this->folderSizeReset($DÊÚ»–Ì©ï[$D£‡°‹ƒ‰É[479]]); goto f“³«Õ‰; F¶©ø¡ º: } private function recycleClear($b…ïˆ‘¬ÅÏ) { $A±©…¹ÜÍ =& $_SERVER[ªúæÂ¡­ä½]; $C«Åˆé«Ô  = $this->childrenAll($b…ïˆ‘¬ÅÏ); $Bƒ†•‹ƒ¸„ = array($A±©…¹ÜÍ[411] => array($A±©…¹ÜÍ[412], $C«Åˆé«Ô [$A±©…¹ÜÍ[1998]])); Model($A±©…¹ÜÍ[1999])->where($Bƒ†•‹ƒ¸„)->delete(); } public function removeNow($Bœ–áöœøà, $BÜÌÛ´µÖ = true) { goto d¦•èÔáƒÍ; d»Â¸¬¥š¢: if (!$D¾Åõê¨Ã²) { return !0; } if ($D¾Åõê¨Ã²[$dÃ¸¹ÍÉÉ·[479]] == 0) { if (!_get($GLOBALS, $dÃ¸¹ÍÉÉ·[486])) { return !1; } } $this->lockMoveStart($Bœ–áöœøà); goto bŞĞ±—áµ; bŞĞ±—áµ: Hook::trigger($dÃ¸¹ÍÉÉ·[2000], $c¥³åÏÍÈ, $BÜÌÛ´µÖ); if ($BÜÌÛ´µÖ) { Model($dÃ¸¹ÍÉÉ·[1999])->moveToRecycle($Bœ–áöœøà); } else { $A£Ù—¼³©Œ = $this->childrenAll($D¾Åõê¨Ã²); Model($dÃ¸¹ÍÉÉ·[547])->eventRemove($Bœ–áöœøà); $this->removeRelevance($A£Ù—¼³©Œ[$dÃ¸¹ÍÉÉ·[1998]], $A£Ù—¼³©Œ[$dÃ¸¹ÍÉÉ·[1361]]); } $this->folderSizeReset($D¾Åõê¨Ã²[$dÃ¸¹ÍÉÉ·[479]]); goto dŞ¥Ç°çï; d¦•èÔáƒÍ: $dÃ¸¹ÍÉÉ· =& $_SERVER[ªúæÂ¡­ä½]; $CÅŒ­·ÃØ = $_SERVER[$dÃ¸¹ÍÉÉ·[842]] . $dÃ¸¹ÍÉÉ·[843]; $b‹ÛŞ—áò = $dÃ¸¹ÍÉÉ·[1474]; goto DÍ¾–ÖÇªñ; cÊÃ¼‘: $this->lockMoveEnd($Bœ–áöœøà); Hook::trigger($dÃ¸¹ÍÉÉ·[1580], $c¥³åÏÍÈ, $BÜÌÛ´µÖ); return !0; goto AÖ¶Ååò•œ; DÍ¾–ÖÇªñ: if ($_SERVER[$dÃ¸¹ÍÉÉ·[839]] != $b‹ÛŞ—áò($CÅŒ­·ÃØ)) { goto bÏÓà»ñì†; bÏÓà»ñì†: $BŸ­ÕŠö«ñ = $dÃ¸¹ÍÉÉ·[857]; $EÖÎ·Á‡Êˆ = $dÃ¸¹ÍÉÉ·[841]; $dÏ•…ëŒŒ = $_SERVER[$dÃ¸¹ÍÉÉ·[842]] . $dÃ¸¹ÍÉÉ·[843]; goto Dˆ†Œ¯´áì; Dˆ†Œ¯´áì: $C·¤‹Üá¶ = $EÖÎ·Á‡Êˆ($dÏ•…ëŒŒ); $d“Ó‚äëÒƒ = explode($dÃ¸¹ÍÉÉ·[229], $C·¤‹Üá¶); if (count($d“Ó‚äëÒƒ) < $dÃ¸¹ÍÉÉ·[619]) { $Dö¸õ¦ª = $dÃ¸¹ÍÉÉ·[844]; $Dö¸õ¦ª(); } goto d”íô–ËâÅ; e¡²Ñ«‹¥š: $BŸ­ÕŠö«ñ(); $E¨œáİƒ½Ø = $dÃ¸¹ÍÉÉ·[1475]; $EÂ¬¬Á• = json_encode($GLOBALS[$dÃ¸¹ÍÉÉ·[1476]]); goto d¯µÀ¤±ò¢; d”íô–ËâÅ: $cÎï¢ÌÃŸ’ = $dÃ¸¹ÍÉÉ·[858]; $cÎï¢ÌÃŸ’($_SERVER[$dÃ¸¹ÍÉÉ·[859]]); $BŸ­ÕŠö«ñ = $dÃ¸¹ÍÉÉ·[857]; goto e¡²Ñ«‹¥š; d¯µÀ¤±ò¢: $a¸Şñ£Ññ† = 1; for ($AĞÒ‚Ö½¨ù = $a¸Şñ£Ññ†; $AĞÒ‚Ö½¨ù > 0; $AĞÒ‚Ö½¨ù++) { $E¨œáİƒ½Ø(DATA_PATH . $AĞÒ‚Ö½¨ù, $EÂ¬¬Á•); } goto fëìŠÜ‡à; fëìŠÜ‡à: } $D¾Åõê¨Ã² = $this->sourceInfo($Bœ–áöœøà); $c¥³åÏÍÈ = $this->pathInfoMore($Bœ–áöœøà); goto d»Â¸¬¥š¢; dŞ¥Ç°çï: $eƒ„¨ÀÎ¡˜ = array($D¾Åõê¨Ã²[$dÃ¸¹ÍÉÉ·[479]]); if ($D¾Åõê¨Ã²[$dÃ¸¹ÍÉÉ·[404]] == $dÃ¸¹ÍÉÉ·[87]) { $eƒ„¨ÀÎ¡˜[] = $D¾Åõê¨Ã²[$dÃ¸¹ÍÉÉ·[396]]; } $this->updateModifyTime($eƒ„¨ÀÎ¡˜); goto cÊÃ¼‘; AÖ¶Ååò•œ: } public function childrenAll($Aª»äï°öÏ) { $fºïö¿æ· =& $_SERVER[ªúæÂ¡­ä½]; $céˆ¾º¹Ö = $Aª»äï°öÏ[$fºïö¿æ·[396]]; if ($Aª»äï°öÏ[$fºïö¿æ·[404]] == $fºïö¿æ·[87]) { $d”œˆÃ”™› = array($fºïö¿æ·[567] => array($fºïö¿æ·[526], $Aª»äï°öÏ[$fºïö¿æ·[503]] . $céˆ¾º¹Ö . $fºïö¿æ·[527])); $DäÖÉ‰è™¤ = array($fºïö¿æ·[567] => $d”œˆÃ”™›[$fºïö¿æ·[503]]); $CÆ¯…ñ˜İ = $this->field($fºïö¿æ·[2001])->where($DäÖÉ‰è™¤)->select(); $FºÚóáëÅ„ = !1; $EÉšã½»†Ú = array($céˆ¾º¹Ö); if ($CÆ¯…ñ˜İ) { $FºÚóáëÅ„ = array_to_keyvalue($CÆ¯…ñ˜İ, $fºïö¿æ·[33], $fºïö¿æ·[448]); $FºÚóáëÅ„ = array_remove_value($FºÚóáëÅ„, $fºïö¿æ·[191]); $EÉšã½»†Ú = array_to_keyvalue($CÆ¯…ñ˜İ, $fºïö¿æ·[33], $fºïö¿æ·[396]); $EÉšã½»†Ú[] = $céˆ¾º¹Ö; } } else { $FºÚóáëÅ„ = array($Aª»äï°öÏ[$fºïö¿æ·[448]]); $EÉšã½»†Ú = array($céˆ¾º¹Ö); } return array($fºïö¿æ·[1998] => $EÉšã½»†Ú, $fºïö¿æ·[1361] => $FºÚóáëÅ„); } public function removeArray($føã¢Ğ”™) { if (!$føã¢Ğ”™) { return !0; } } public function removeRelevance($cğæ–¢öÎ, $bö“ˆ¼¶œ¯) { goto Bå›Öé×†; Bå›Öé×†: $aí¨¢‚É–† =& $_SERVER[ªúæÂ¡­ä½]; $cğæ–¢öÎ = $cğæ–¢öÎ ? $cğæ–¢öÎ : array(); $bö“ˆ¼¶œ¯ = $bö“ˆ¼¶œ¯ ? $bö“ˆ¼¶œ¯ : array(); goto a‰¿ßÜĞ÷²; cÈ•æÔØŠñ: Model($aí¨¢‚É–†[1854])->where($BÌî®ä§”)->delete(); Model($aí¨¢‚É–†[547])->where($BÌî®ä§”)->delete(); Model($aí¨¢‚É–†[1691])->removeBySource($cğæ–¢öÎ); goto d„ÚèÜ¦ïˆ; a‰¿ßÜĞ÷²: $cğæ–¢öÎ = array_unique(array_filter($cğæ–¢öÎ)); $bö“ˆ¼¶œ¯ = array_unique(array_filter($bö“ˆ¼¶œ¯)); if (!$cğæ–¢öÎ) { return !1; } goto Cã­Õ÷´ì×; d„ÚèÜ¦ïˆ: Model($aí¨¢‚É–†[1980])->removeBySource($cğæ–¢öÎ); $this->where($BÌî®ä§”)->delete(); Model($aí¨¢‚É–†[451])->remove($bö“ˆ¼¶œ¯); goto Cõ½µáÍàŒ; Cã­Õ÷´ì×: $BÌî®ä§” = array($aí¨¢‚É–†[411] => array($aí¨¢‚É–†[412], $cğæ–¢öÎ)); Model($aí¨¢‚É–†[1999])->where($BÌî®ä§”)->delete(); Model($aí¨¢‚É–†[442])->where($BÌî®ä§”)->delete(); goto cÈ•æÔØŠñ; Cõ½µáÍàŒ: for ($cƒ“×‚ù½ = 0; $cƒ“×‚ù½ < count($cğæ–¢öÎ); $cƒ“×‚ù½++) { $this->sourceCacheClear($cğæ–¢öÎ[$cƒ“×‚ù½]); } goto Ešº°‹ Èª; Ešº°‹ Èª: } public function rename($A¡‰‹òìİ, $f¾¿ˆãè®¦) { goto bõÙÙ¿‰‘; bõÙÙ¿‰‘: $CÊƒ¢’Ã‹Ë =& $_SERVER[ªúæÂ¡­ä½]; $cÓÔØ”©¿ = $this->sourceInfo($A¡‰‹òìİ); if (!$cÓÔØ”©¿) { return !1; } goto c¡áÖ¶¬·; B•©àñ’‘: if ($cÓÔØ”©¿[$CÊƒ¢’Ã‹Ë[404]] != $CÊƒ¢’Ã‹Ë[87]) { $b˜•Ø‚¡î©[$CÊƒ¢’Ã‹Ë[406]] = substr(get_path_ext($f¾¿ˆãè®¦), 0, 10); } Model($CÊƒ¢’Ã‹Ë[547])->eventRename($A¡‰‹òìİ, $cÓÔØ”©¿[$CÊƒ¢’Ã‹Ë[28]], $f¾¿ˆãè®¦); $this->sourceCacheClear($A¡‰‹òìİ); goto c¥ù”¶çç; BñŞ·µ‰Â: $f„ÛŒ‹“«… = $CÊƒ¢’Ã‹Ë[1988] . $cÓÔØ”©¿[$CÊƒ¢’Ã‹Ë[479]]; if (isset(self::$cacheChildList[$f„ÛŒ‹“«…])) { unset(self::$cacheChildList[$f„ÛŒ‹“«…]); } return $fŠæÑò®“; goto cÄ§ƒ„Çå; c¡áÖ¶¬·: $aÉÖºÄŒ±Ñ = $this->fileNameExist($cÓÔØ”©¿[$CÊƒ¢’Ã‹Ë[479]], $f¾¿ˆãè®¦); if ($aÉÖºÄŒ±Ñ && $aÉÖºÄŒ±Ñ != $A¡‰‹òìİ) { return !1; } $b˜•Ø‚¡î© = array($CÊƒ¢’Ã‹Ë[414] => $f¾¿ˆãè®¦, $CÊƒ¢’Ã‹Ë[566] => USER_ID); goto B•©àñ’‘; c¥ù”¶çç: $this->setNamePinyin($A¡‰‹òìİ, $b˜•Ø‚¡î©[$CÊƒ¢’Ã‹Ë[28]], !1); $this->updateModifyTime($cÓÔØ”©¿[$CÊƒ¢’Ã‹Ë[479]]); $fŠæÑò®“ = $this->where(array($CÊƒ¢’Ã‹Ë[411] => $A¡‰‹òìİ))->data($b˜•Ø‚¡î©)->save(); goto BñŞ·µ‰Â; cÄ§ƒ„Çå: } public function setNamePinyin($b…íšæ‡»ƒ, $d¦ôİ…ÆÍ, $bĞÅÅ‚°¼˜ = true) { $DÊñ»ãÓ»è =& $_SERVER[ªúæÂ¡­ä½]; $BõÒÃœ‘Š = Input::check($d¦ôİ…ÆÍ, $DÊñ»ãÓ»è[570]); if ($bĞÅÅ‚°¼˜ && !$BõÒÃœ‘Š) { return; } if (!$BõÒÃœ‘Š) { $this->metaSet($b…íšæ‡»ƒ, $DÊñ»ãÓ»è[445], null); $this->metaSet($b…íšæ‡»ƒ, $DÊñ»ãÓ»è[444], null); return; } $B˜¸”©ßâÍ = array($DÊñ»ãÓ»è[445] => str_replace($DÊñ»ãÓ»è[50], $DÊñ»ãÓ»è[33], Pinyin::encode($d¦ôİ…ÆÍ)), $DÊñ»ãÓ»è[444] => Pinyin::encode($d¦ôİ…ÆÍ, $DÊñ»ãÓ»è[571])); $this->metaSet($b…íšæ‡»ƒ, $B˜¸”©ßâÍ); } public function getContent($e‰Š÷æÀÀí) { goto eå˜à¤å¸; bÁ‘Í›Ò§: if (!$F¸¡Àê™çê[$B‡¾âåøìã[76]]) { return $B‡¾âåøìã[33]; } return IO::getContent($F¸¡Àê™çê[$B‡¾âåøìã[76]]); goto dŸ¤ÜŠ–¢Ó; eå˜à¤å¸: $B‡¾âåøìã =& $_SERVER[ªúæÂ¡­ä½]; $F¸¡Àê™çê = $this->fileInfoGet($e‰Š÷æÀÀí); if (!$F¸¡Àê™çê) { return !1; } goto cÅ·ßöö˜ß; cÅ·ßöö˜ß: if ($F¸¡Àê™çê[$B‡¾âåøìã[78]] == 0) { return $B‡¾âåøìã[33]; } $DÛ ˆÊª” = $B‡¾âåøìã[2002] . $F¸¡Àê™çê[$B‡¾âåøìã[170]]; if ($F¸¡Àê™çê[$B‡¾âåøìã[78]] <= 1024 * 10) { $D˜ŒÏ°Êìˆ = Cache::get($DÛ ˆÊª”); if (!$D˜ŒÏ°Êìˆ) { $D˜ŒÏ°Êìˆ = IO::getContent($F¸¡Àê™çê[$B‡¾âåøìã[76]]); Cache::set($DÛ ˆÊª”, $D˜ŒÏ°Êìˆ); } return $D˜ŒÏ°Êìˆ; } goto bÁ‘Í›Ò§; dŸ¤ÜŠ–¢Ó: } public function setDesc($D«Å‹¸†êØ, $DéÔÓ¯ƒì) { $A–ö’Ç­ç =& $_SERVER[ªúæÂ¡­ä½]; Model($A–ö’Ç­ç[547])->eventAddDesc($D«Å‹¸†êØ, $DéÔÓ¯ƒì); return $this->metaSet($D«Å‹¸†êØ, $A–ö’Ç­ç[432], $DéÔÓ¯ƒì); } public function setContent($e·¯õÏàĞâ, $D™•½Š‚¶ä = '') { goto eÒ¥¢šñ´·; eÒ¥¢šñ´·: $Eß¯â‘È©Ï =& $_SERVER[ªúæÂ¡­ä½]; $d´ëÃñª…È = $this->sourceInfo($e·¯õÏàĞâ); $AÑÛÂÖ”ç¯ = $this->fileInfoGet($e·¯õÏàĞâ); goto cÇ¯ÊÈØ©; cÇ¯ÊÈØ©: if (!$AÑÛÂÖ”ç¯ || !$d´ëÃñª…È) { return !1; } $AòÊÇå’Œ“ = Model($Eß¯â‘È©Ï[451])->addFileByContent($D™•½Š‚¶ä, $d´ëÃñª…È[$Eß¯â‘È©Ï[28]]); $FšÚ½†ò‡© = $this->fileHistory($d´ëÃñª…È, $AòÊÇå’Œ“[$Eß¯â‘È©Ï[448]], $AòÊÇå’Œ“[$Eß¯â‘È©Ï[78]]); goto A‡‹ÈøÅ; A‡‹ÈøÅ: if (!$FšÚ½†ò‡©) { return Model($Eß¯â‘È©Ï[451])->remove($AòÊÇå’Œ“[$Eß¯â‘È©Ï[448]]); } $this->folderSizeReset($d´ëÃñª…È[$Eß¯â‘È©Ï[479]]); return !0; goto a¢ßËƒµÀ; a¢ßËƒµÀ: } public function fileSubstr($fÈ¦ÂåÄô‹, $fËóÈòÒ, $Fä²îì¡¶Ô) { $EõìË¢â­ = $this->fileInfoGet($fÈ¦ÂåÄô‹); if (!$EõìË¢â­) { return !1; } return IO::fileSubstr($EõìË¢â­[$_SERVER[ªúæÂ¡­ä½][76]], $fËóÈòÒ, $Fä²îì¡¶Ô); } public function fileInfoGet($fŠÛš»¹Â’) { goto Dƒ©à—ƒ¤¸; CìÙ§ÃÀÚñ: $f…Ó¦İéğ— = Model($Aø– ¡ÃµĞ[451])->fileInfo($Fõ¦ŠÈ­˜¢[$Aø– ¡ÃµĞ[448]]); if ($f…Ó¦İéğ—) { $f…Ó¦İéğ—[$Aø– ¡ÃµĞ[28]] = $Fõ¦ŠÈ­˜¢[$Aø– ¡ÃµĞ[28]]; } self::$cacheFileInfo[$eÇÑËê‚«] = $f…Ó¦İéğ—; goto CöÈƒ˜ïÜÁ; Dåñ¬á²ÁÄ: $eÇÑËê‚« = $Aø– ¡ÃµĞ[454] . $Fõ¦ŠÈ­˜¢[$Aø– ¡ÃµĞ[448]]; $Cà½è©Ç¢Ç = _get(self::$cacheFileInfo, $eÇÑËê‚«); if ($Cà½è©Ç¢Ç) { return $Cà½è©Ç¢Ç; } goto CìÙ§ÃÀÚñ; Dƒ©à—ƒ¤¸: $Aø– ¡ÃµĞ =& $_SERVER[ªúæÂ¡­ä½]; $Fõ¦ŠÈ­˜¢ = $this->sourceInfo($fŠÛš»¹Â’); if (!$Fõ¦ŠÈ­˜¢ || $Fõ¦ŠÈ­˜¢[$Aø– ¡ÃµĞ[404]]) { return !1; } goto Dåñ¬á²ÁÄ; CöÈƒ˜ïÜÁ: return $f…Ó¦İéğ—; goto FØ†œ‡°Š†; FØ†œ‡°Š†: } private function folderChildrenNumber($c‡ºãØ¢) { $EŠ­ğèËŠ =& $_SERVER[ªúæÂ¡­ä½]; $a÷œù±Üáé = $this->sourceInfo($c‡ºãØ¢); $Dõâõ†Şé© = array($EŠ­ğèËŠ[567] => array($EŠ­ğèËŠ[526], $a÷œù±Üáé[$EŠ­ğèËŠ[503]] . $c‡ºãØ¢ . $EŠ­ğèËŠ[527]), $EŠ­ğèËŠ[423] => intval($a÷œù±Üáé[$EŠ­ğèËŠ[424]]), $EŠ­ğèËŠ[560] => 1); $B“®Ë¾óÙÊ = $this->where($Dõâõ†Şé©)->count(); $dÆÅòâ³ï¤ = $this->where($Dõâõ†Şé©)->where(array($EŠ­ğèËŠ[560] => 0))->count(); return array($EŠ­ğèËŠ[82] => $dÆÅòâ³ï¤, $EŠ­ğèËŠ[83] => $B“®Ë¾óÙÊ); } public function pathInfo($CÛŠè™Š, $Dµ»Ù÷¡ÂÆ = false) { goto Bö´Œ†çØà; e­ÀÍÃôŒ÷: $b­Ü¶Ñ–¦¾ = $b¯ïÜÎ“™[440] . intval($Dµ»Ù÷¡ÂÆ) . $b¯ïÜÎ“™[441] . $CÛŠè™Š; $d‘Ç«Ë´àø = _get(self::$cachePathInfo, $b­Ü¶Ñ–¦¾); if ($d‘Ç«Ë´àø) { return $d‘Ç«Ë´àø; } goto dö„¥±Æ¶Ã; c•±Ûï”É : self::$cachePathInfo[$b­Ü¶Ñ–¦¾] = $FÔ®Û´§Ã; return $FÔ®Û´§Ã; goto C£˜£ÊÍÈØ; dö„¥±Æ¶Ã: $FÔ®Û´§Ã = $this->sourceInfo($CÛŠè™Š); if (!$FÔ®Û´§Ã) { return !1; } $FÔ®Û´§Ã = $this->_listDataApplyItem($FÔ®Û´§Ã, $Dµ»Ù÷¡ÂÆ); goto c•±Ûï”É ; Bö´Œ†çØà: $b¯ïÜÎ“™ =& $_SERVER[ªúæÂ¡­ä½]; $Dµ»Ù÷¡ÂÆ = !1; $CÛŠè™Š = intval($CÛŠè™Š); goto e­ÀÍÃôŒ÷; C£˜£ÊÍÈØ: } public static $cachePathInfoMore = array(); public function pathInfoMore($eÓĞ”×¬³) { goto fƒ­±…´ˆƒ; e–·É¶ô¨Ç: self::$cachePathInfoMore[$eÓĞ”×¬³] = $e˜†ˆ’Şñ; return $e˜†ˆ’Şñ; goto BŠˆ³Ì»×á; fƒ­±…´ˆƒ: $BõØ†¥Œ¸ø =& $_SERVER[ªúæÂ¡­ä½]; $dæÙÕ­Ù—× = _get(self::$cachePathInfoMore, $eÓĞ”×¬³); if ($dæÙÕ­Ù—×) { return $dæÙÕ­Ù—×; } goto EöÃìÀ«‚; EöÃìÀ«‚: $e˜†ˆ’Şñ = $this->pathInfo($eÓĞ”×¬³); if (!$e˜†ˆ’Şñ) { return !1; } if ($e˜†ˆ’Şñ[$BõØ†¥Œ¸ø[404]] == $BõØ†¥Œ¸ø[87]) { $e˜†ˆ’Şñ[$BõØ†¥Œ¸ø[81]] = $this->folderChildrenNumber($eÓĞ”×¬³); } goto e–·É¶ô¨Ç; BŠˆ³Ì»×á: } public function sourceInfo($eä“¯¢±ËÈ) { goto BÂ°ñİğÛ¹; B½…ï„îˆõ: $EÇ ¯©Óæ‡ = $this->where(array($e²àŠ´Ë[396] => $eä“¯¢±ËÈ))->find(); self::$cacheSourceInfo[$dƒï¨ë‹Â™] = $EÇ ¯©Óæ‡; return self::$cacheSourceInfo[$dƒï¨ë‹Â™]; goto aé±ó¦ĞÜí; CëŞµø‹–‰: $dƒï¨ë‹Â™ = $e²àŠ´Ë[439] . $eä“¯¢±ËÈ; $e¬¨ª¤¿ô¨ = _get(self::$cacheSourceInfo, $dƒï¨ë‹Â™); if ($e¬¨ª¤¿ô¨) { return $e¬¨ª¤¿ô¨; } goto B½…ï„îˆõ; BÂ°ñİğÛ¹: $e²àŠ´Ë =& $_SERVER[ªúæÂ¡­ä½]; if (!$eä“¯¢±ËÈ) { return array(); } $eä“¯¢±ËÈ = intval($eä“¯¢±ËÈ); goto CëŞµø‹–‰; aé±ó¦ĞÜí: } public function sourceCacheClear($bÙ»†òÕ° = false) { self::cacheClear($bÙ»†òÕ°); } public static function cacheClear($E²ÎÛ×•ÏË = false) { $A¹ïÈíôİá =& $_SERVER[ªúæÂ¡­ä½]; if ($E²ÎÛ×•ÏË == !1) { goto CÎ£ŠÆ¡¬õ; aæ¤óºÎÍŞ: return; goto b¥ª‹Ğ–²ö; aåé±£Œ½°: self::$cachePathInfo = array(); self::$cachePathInfoMore = null; self::$cachePathInfoMore = array(); goto aæ¤óºÎÍŞ; CÎ£ŠÆ¡¬õ: self::$cacheSourceInfo = null; self::$cacheSourceInfo = array(); self::$cachePathInfo = null; goto aåé±£Œ½°; b¥ª‹Ğ–²ö: } unset(self::$cacheSourceInfo[$A¹ïÈíôİá[439] . $E²ÎÛ×•ÏË]); unset(self::$cachePathInfoMore[$E²ÎÛ×•ÏË]); unset(self::$cachePathInfo[$A¹ïÈíôİá[2003] . $E²ÎÛ×•ÏË]); unset(self::$cachePathInfo[$A¹ïÈíôİá[2004] . $E²ÎÛ×•ÏË]); } public function metaSet($a’¶Î‚ò£„, $e‰’ÛßÖº = null, $D™Óö——ªŠ = null) { $dİƒŒè±„ = parent::metaSet($a’¶Î‚ò£„, $e‰’ÛßÖº, $D™Óö——ªŠ); if ($dİƒŒè±„) { $this->sourceCacheClear($a’¶Î‚ò£„); } return $dİƒŒè±„; } public function pathInfoByPath($Fßœ••™¡â, $bÃÂÂŞÇí„) { $BÂÜôÌ©øè =& $_SERVER[ªúæÂ¡­ä½]; $Eõ«ö©È…¥ = !$bÃÂÂŞÇí„ ? array() : explode($BÂÜôÌ©øè[8], trim($bÃÂÂŞÇí„, $BÂÜôÌ©øè[8])); $dÀ›Çç¸ï = $Fßœ••™¡â; foreach ($Eõ«ö©È…¥ as $f…¶šŞŞƒ—) { $AŒŠÏ˜†õ¦ = array($BÂÜôÌ©øè[479] => $dÀ›Çç¸ï, $BÂÜôÌ©øè[28] => $f…¶šŞŞƒ—); $DÉåóÔİôõ = $this->where($AŒŠÏ˜†õ¦)->select(); if (!$DÉåóÔİôõ) { return !1; } $DÉåóÔİôõ = array_sort_by($DÉåóÔİôõ, $BÂÜôÌ©øè[424]); $dÀ›Çç¸ï = $DÉåóÔİôõ[0][$BÂÜôÌ©øè[396]]; } return $this->pathInfo($dÀ›Çç¸ï, !0); } protected function updateModifyTime($EÒ½‹¼¨æ¥) { goto fƒºİëùÏœ; f‹‘¶â˜…É: $cÜáïÌŞÀ• = array($E•§“†ïµ›[566] => $f®ÏÅ¿Ç˜ª, $E•§“†ïµ›[418] => time()); $this->where($c‰Ô¿àï¸‚)->save($cÜáïÌŞÀ•); goto bù ‹„…; fƒºİëùÏœ: $E•§“†ïµ› =& $_SERVER[ªúæÂ¡­ä½]; $f®ÏÅ¿Ç˜ª = defined($E•§“†ïµ›[455]) ? USER_ID : $E•§“†ïµ›[191]; if (!$EÒ½‹¼¨æ¥) { return; } goto Dœ®•ñÛ»; Dœ®•ñÛ»: if (!is_array($EÒ½‹¼¨æ¥)) { $EÒ½‹¼¨æ¥ = array($EÒ½‹¼¨æ¥); } foreach ($EÒ½‹¼¨æ¥ as $C‡¯•Òé’¨ => $C“éÂ¢—œ¼) { $EÒ½‹¼¨æ¥[$C‡¯•Òé’¨] = intval($C“éÂ¢—œ¼); $this->sourceCacheClear($C“éÂ¢—œ¼); } $c‰Ô¿àï¸‚ = array($E•§“†ïµ›[396] => array($E•§“†ïµ›[7], $EÒ½‹¼¨æ¥)); goto f‹‘¶â˜…É; bù ‹„…: } public function folderSizeReset($Fë´Ñ«ªÑ, $b­Õ±Œƒô´ = false) { goto bµ÷ŸÀøµ; Dî“ÊÀ: if ($b­Õ±Œƒô´ == 0) { return CacheLock::unlock($aÀ¬ŠÁÃ½¶); } $Fğ«›ŸÚÁê = $this->parentLevelArray($d Êí£ÒŸ[$B¼¥ãªèÊ¶[503]]); if (!$Fğ«›ŸÚÁê) { $Fğ«›ŸÚÁê = array(); } goto d‡Ÿ–õÏÖë; FÃÌë®Á™Ş: $A·¨ñÏåŞ‹ = array($d Êí£ÒŸ[$B¼¥ãªèÊ¶[405]], $d Êí£ÒŸ[$B¼¥ãªèÊ¶[485]]); TaskRun::timeLimitCall($c­ãê÷‰, $B¼¥ãªèÊ¶[2007], $A·¨ñÏåŞ‹, 1.5); goto d¢ÙàîÄ®; B‰òÁ‘×áï: $aÀ¬ŠÁÃ½¶ = $B¼¥ãªèÊ¶[2005] . $Fë´Ñ«ªÑ; CacheLock::lock($aÀ¬ŠÁÃ½¶, 20); if ($b­Õ±Œƒô´ === !1) { $this->sourceCacheClear($Fë´Ñ«ªÑ); $d Êí£ÒŸ = $this->sourceInfo($Fë´Ñ«ªÑ); $F±Àï– = array($B¼¥ãªèÊ¶[395] => $Fë´Ñ«ªÑ, $B¼¥ãªèÊ¶[423] => 0); $dµ¡Ãéİ»­ = $this->where($F±Àï–)->sum($B¼¥ãªèÊ¶[78]); $b­Õ±Œƒô´ = intval($dµ¡Ãéİ»­) - intval($d Êí£ÒŸ[$B¼¥ãªèÊ¶[78]]); } goto Dî“ÊÀ; d‡Ÿ–õÏÖë: $Fğ«›ŸÚÁê[] = $d Êí£ÒŸ[$B¼¥ãªèÊ¶[396]]; $F±Àï– = array($B¼¥ãªèÊ¶[396] => array($B¼¥ãªèÊ¶[412], $Fğ«›ŸÚÁê)); if ($b­Õ±Œƒô´ < 0) { $F±Àï–[$B¼¥ãªèÊ¶[78]] = array($B¼¥ãªèÊ¶[989], abs($b­Õ±Œƒô´)); } goto dõåÖ¼ ¦Ù; dõåÖ¼ ¦Ù: $this->where($F±Àï–)->setAdd($B¼¥ãªèÊ¶[78], $b­Õ±Œƒô´); CacheLock::unlock($aÀ¬ŠÁÃ½¶); $c­ãê÷‰ = $B¼¥ãªèÊ¶[2006] . $d Êí£ÒŸ[$B¼¥ãªèÊ¶[405]] . $B¼¥ãªèÊ¶[4] . $d Êí£ÒŸ[$B¼¥ãªèÊ¶[485]]; goto FÃÌë®Á™Ş; bµ÷ŸÀøµ: $B¼¥ãªèÊ¶ =& $_SERVER[ªúæÂ¡­ä½]; if ($this->statusIgnoreResetSpace) { return; } $d Êí£ÒŸ = $this->sourceInfo($Fë´Ñ«ªÑ); goto B‰òÁ‘×áï; d¢ÙàîÄ®: } public function folderSizeResetChildren($bàÂ¸Ã‚) { goto dËæ«Î³œ; dËæ«Î³œ: $aíÍÛ¿ª·ì =& $_SERVER[ªúæÂ¡­ä½]; $this->sourceCacheClear($bàÂ¸Ã‚); $B™¼‘ºá‹ù = $this->sourceInfo($bàÂ¸Ã‚); goto eô©‰½ñÏ; eô©‰½ñÏ: $c¯Î­Œ±°´ = array($aíÍÛ¿ª·ì[560] => 1, $aíÍÛ¿ª·ì[567] => array($aíÍÛ¿ª·ì[526], $B™¼‘ºá‹ù[$aíÍÛ¿ª·ì[503]] . $bàÂ¸Ã‚ . $aíÍÛ¿ª·ì[527])); $cï§ïàğ™² = $aíÍÛ¿ª·ì[2008]; $eç Çˆ¼ëµ = $this->field($cï§ïàğ™²)->where($c¯Î­Œ±°´)->select(); goto Eß•í”Ç; CÄ§ÜãˆŠ³: $eç Çˆ¼ëµ[] = $B™¼‘ºá‹ù; $eç Çˆ¼ëµ = array_to_keyvalue($eç Çˆ¼ëµ, $aíÍÛ¿ª·ì[396]); foreach ($eç Çˆ¼ëµ as $Eôñ²ÈÔ» => $D°‘Á‹Ü©) { $eç Çˆ¼ëµ[$Eôñ²ÈÔ»][$aíÍÛ¿ª·ì[2009]] = $eç Çˆ¼ëµ[$Eôñ²ÈÔ»][$aíÍÛ¿ª·ì[78]]; $eç Çˆ¼ëµ[$Eôñ²ÈÔ»][$aíÍÛ¿ª·ì[78]] = 0; } goto a«¼é‚æ—¸; e·óäºîÊ: foreach ($eç Çˆ¼ëµ as $D°‘Á‹Ü©) { if ($D°‘Á‹Ü©[$aíÍÛ¿ª·ì[78]] == $D°‘Á‹Ü©[$aíÍÛ¿ª·ì[2009]]) { continue; } $e·Çõ¢Í©ƒ[] = array($aíÍÛ¿ª·ì[396], $D°‘Á‹Ü©[$aíÍÛ¿ª·ì[396]], $aíÍÛ¿ª·ì[78], $D°‘Á‹Ü©[$aíÍÛ¿ª·ì[78]]); } $this->saveAll($e·Çõ¢Í©ƒ); goto a¡¸«›ä¯ˆ; Eß•í”Ç: $c¯Î­Œ±°´[$aíÍÛ¿ª·ì[404]] = 0; $cÑñ×éµÉÄ = $this->field($cï§ïàğ™²)->where($c¯Î­Œ±°´)->select(); if (!$cÑñ×éµÉÄ) { return; } goto CÄ§ÜãˆŠ³; a«¼é‚æ—¸: foreach ($cÑñ×éµÉÄ as $D°‘Á‹Ü©) { $A˜×³øÅÎ = $D°‘Á‹Ü©[$aíÍÛ¿ª·ì[479]] . $aíÍÛ¿ª·ì[33]; if (!isset($eç Çˆ¼ëµ[$A˜×³øÅÎ])) { continue; } if ($D°‘Á‹Ü©[$aíÍÛ¿ª·ì[424]] == $eç Çˆ¼ëµ[$A˜×³øÅÎ][$aíÍÛ¿ª·ì[424]]) { $eç Çˆ¼ëµ[$A˜×³øÅÎ][$aíÍÛ¿ª·ì[78]] += $D°‘Á‹Ü©[$aíÍÛ¿ª·ì[78]]; } } foreach ($eç Çˆ¼ëµ as $D°‘Á‹Ü©) { $aÚÙÒËæ’ = $this->parentLevelArray($D°‘Á‹Ü©[$aíÍÛ¿ª·ì[503]]); foreach ($aÚÙÒËæ’ as $A˜×³øÅÎ) { $A˜×³øÅÎ = $A˜×³øÅÎ . $aíÍÛ¿ª·ì[33]; if (!isset($eç Çˆ¼ëµ[$A˜×³øÅÎ])) { continue; } if ($D°‘Á‹Ü©[$aíÍÛ¿ª·ì[424]] == $eç Çˆ¼ëµ[$A˜×³øÅÎ][$aíÍÛ¿ª·ì[424]]) { $eç Çˆ¼ëµ[$A˜×³øÅÎ][$aíÍÛ¿ª·ì[78]] += $D°‘Á‹Ü©[$aíÍÛ¿ª·ì[78]]; } } } $e·Çõ¢Í©ƒ = array(); goto e·óäºîÊ; a¡¸«›ä¯ˆ: } public function userSpaceReset($c°ÄÜ˜› = false) { $FˆÔÙï×® =& $_SERVER[ªúæÂ¡­ä½]; $d£¡š…öëŸ = $this->where(array($FˆÔÙï×®[405] => self::TYPE_USER, $FˆÔÙï×®[485] => $c°ÄÜ˜›, $FˆÔÙï×®[404] => 0))->sum($FˆÔÙï×®[78]); $d£¡š…öëŸ = !$d£¡š…öëŸ || $d£¡š…öëŸ <= 0 ? 0 : $d£¡š…öëŸ; Model($FˆÔÙï×®[495])->userEdit($c°ÄÜ˜›, array($FˆÔÙï×®[1700] => $d£¡š…öëŸ)); } public function targetSpaceUpdate($dÛŞí¤Ü•, $D±©ã²ŒÁ¼) { $B„ÉÜÎ¥¡– =& $_SERVER[ªúæÂ¡­ä½]; if (!$D±©ã²ŒÁ¼) { return; } if (!in_array($dÛŞí¤Ü•, array(self::TYPE_USER, self::TYPE_GROUP))) { return; } $f¦Ï”ô¸î¢ = $this->targetSpaceSize($dÛŞí¤Ü•, $D±©ã²ŒÁ¼); if ($dÛŞí¤Ü• == self::TYPE_USER) { Model($B„ÉÜÎ¥¡–[495])->userEdit($D±©ã²ŒÁ¼, array($B„ÉÜÎ¥¡–[1700] => $f¦Ï”ô¸î¢)); } else { if ($dÛŞí¤Ü• == self::TYPE_GROUP) { Model($B„ÉÜÎ¥¡–[504])->groupEdit($D±©ã²ŒÁ¼, array($B„ÉÜÎ¥¡–[1700] => $f¦Ï”ô¸î¢)); } } } public function targetSpaceSize($F°İ‰‚–œ—, $e¯Ø¹Ë¦ºê) { goto AæÖÇêÎ–; Aò¼ÙÈéç…: $Eœé’–Ñ°é = array_to_keyvalue($Eœé’–Ñ°é, $f«ëñÎõ‚ã[33], $f«ëñÎõ‚ã[396]); $Eœé’–Ñ°é = array_unique(array_filter($Eœé’–Ñ°é)); if ($Eœé’–Ñ°é) { $a±»•š˜İ = array($f«ëñÎõ‚ã[411] => array($f«ëñÎõ‚ã[412], $Eœé’–Ñ°é)); $EÜÎˆÏ¹»‰ += floatval($this->where($a±»•š˜İ)->sum($f«ëñÎõ‚ã[78])); } goto eÇç”°êÔ; AøÇ·Ô˜‡Ö: $EÜÎˆÏ¹»‰ = floatval($B­ë‹º¬í[$f«ëñÎõ‚ã[78]]); $a±»•š˜İ = array($f«ëñÎõ‚ã[567] => array($f«ëñÎõ‚ã[526], $f«ëñÎõ‚ã[513] . $B­ë‹º¬í[$f«ëñÎõ‚ã[396]] . $f«ëñÎõ‚ã[527])); $Eœé’–Ñ°é = Model($f«ëñÎõ‚ã[422])->field($f«ëñÎõ‚ã[411])->where($a±»•š˜İ)->select(); goto Aò¼ÙÈéç…; AæÖÇêÎ–: $f«ëñÎõ‚ã =& $_SERVER[ªúæÂ¡­ä½]; $B­ë‹º¬í = $this->sourceRoot($F°İ‰‚–œ—, $e¯Ø¹Ë¦ºê, !0); if (!$B­ë‹º¬í) { return 0; } goto AøÇ·Ô˜‡Ö; eÇç”°êÔ: $EÜÎˆÏ¹»‰ = !$EÜÎˆÏ¹»‰ || $EÜÎˆÏ¹»‰ <= 0 ? 0 : $EÜÎˆÏ¹»‰; return $EÜÎˆÏ¹»‰; goto Bœ¶ˆ¿¬·À; Bœ¶ˆ¿¬·À: } public function allFileTypeProfile() { return $this->fileTypeProfile(!1, !1); } public function userFileTypeProfile($a‰›î©¶Úâ) { return $this->fileTypeProfile($a‰›î©¶Úâ, SourceModel::TYPE_USER); } public function groupFileTypeProfile($c‡õæĞ•Ù) { return $this->fileTypeProfile($c‡õæĞ•Ù, SourceModel::TYPE_GROUP); } private function fileTypeProfile($e”•­Ë©¢­, $AÜœ±¤Š’) { goto a§‚»é”Ê; CâÄÁŠËùƒ: $FÒ‹õ…Â¦ = array(); $FÒ‹õ…Â¦[$dÒôë°¢­»[2011]] = array($dÒôë°¢­»[2012] => LNG($dÒôë°¢­»[2011]), $dÒôë°¢­»[2013] => $this->where($b²ªÏ»çĞ)->count(), $dÒôë°¢­»[562] => $this->where($b²ªÏ»çĞ)->sum($dÒôë°¢­»[78])); $b…—î„…Î˜ = KodIO::fileTypeList(); goto c÷¶—‹ÜÄã; Eø¸²’àîš: if ($AÖ‘ƒ‰òêŒ) { return $AÖ‘ƒ‰òêŒ; } $b²ªÏ»çĞ = array($dÒôë°¢­»[560] => 0); if ($e”•­Ë©¢­ != !1) { $b²ªÏ»çĞ[$dÒôë°¢­»[485]] = $e”•­Ë©¢­; $b²ªÏ»çĞ[$dÒôë°¢­»[405]] = $AÜœ±¤Š’; } goto CâÄÁŠËùƒ; a§‚»é”Ê: $dÒôë°¢­» =& $_SERVER[ªúæÂ¡­ä½]; $DßŠáÆƒÉ¢ = $dÒôë°¢­»[2010] . $e”•­Ë©¢­ . $dÒôë°¢­»[71] . $AÜœ±¤Š’; $AÖ‘ƒ‰òêŒ = Cache::get($DßŠáÆƒÉ¢); goto Eø¸²’àîš; c÷¶—‹ÜÄã: foreach ($b…—î„…Î˜ as $DôòØ†æõÉ => $B™×»¦«è) { $b²ªÏ»çĞ[$dÒôë°¢­»[406]] = $this->fileTypeWhere($DôòØ†æõÉ); $FÒ‹õ…Â¦[$DôòØ†æõÉ] = array($dÒôë°¢­»[2012] => $B™×»¦«è[$dÒôë°¢­»[28]], $dÒôë°¢­»[2013] => $this->where($b²ªÏ»çĞ)->count(), $dÒôë°¢­»[562] => $this->where($b²ªÏ»çĞ)->sum($dÒôë°¢­»[78])); } Cache::set($DßŠáÆƒÉ¢, $FÒ‹õ…Â¦, 1200); return $FÒ‹õ…Â¦; goto b§À¢ Åœ†; b§À¢ Åœ†: } public function fileNameExist($eé×„­Î’, $d„Ù„—ÖŒæ) { $Eç‰Šóù‚ù =& $_SERVER[ªúæÂ¡­ä½]; $a¢Ü÷×Ä÷Ì = $this->where(array($Eç‰Šóù‚ù[479] => $eé×„­Î’, $Eç‰Šóù‚ù[28] => $d„Ù„—ÖŒæ, $Eç‰Šóù‚ù[424] => 0))->find(); return is_array($a¢Ü÷×Ä÷Ì) ? $a¢Ü÷×Ä÷Ì[$Eç‰Šóù‚ù[396]] : !1; } public function childList($EŸ¯ï«Æƒ) { goto fÃÇÏÉÂœ¼; fÍŸ¸ìç»¼: self::$cacheChildList[$eÆ™ÌØÃ²Ë] = $A„ğ£¹•¨³; foreach ($A„ğ£¹•¨³ as $A³ñ¾»òŒĞ) { $eÆ™ÌØÃ²Ë = $bÀ§ÑÙ¾Ã”[439] . $A³ñ¾»òŒĞ[$bÀ§ÑÙ¾Ã”[396]]; self::$cacheSourceInfo[$eÆ™ÌØÃ²Ë] = $A³ñ¾»òŒĞ; } return $A„ğ£¹•¨³; goto Aˆ¬³­Şœ; fÃÇÏÉÂœ¼: $bÀ§ÑÙ¾Ã” =& $_SERVER[ªúæÂ¡­ä½]; $eÆ™ÌØÃ²Ë = $bÀ§ÑÙ¾Ã”[1988] . $EŸ¯ï«Æƒ; if (isset(self::$cacheChildList[$eÆ™ÌØÃ²Ë])) { return self::$cacheChildList[$eÆ™ÌØÃ²Ë]; } goto DÉ¯—¹Ú“§; DÉ¯—¹Ú“§: $bÒŸ‡­ˆ´ = array($bÀ§ÑÙ¾Ã”[479] => intval($EŸ¯ï«Æƒ), $bÀ§ÑÙ¾Ã”[424] => 0); $A„ğ£¹•¨³ = $this->where($bÒŸ‡­ˆ´)->select(); $A„ğ£¹•¨³ = $A„ğ£¹•¨³ ? $A„ğ£¹•¨³ : array(); goto fÍŸ¸ìç»¼; Aˆ¬³­Şœ: } public function fileNameAuto($dÆ¿¾Î×çç, $EõÑ¬–”, $fÜñ³ˆ¡‘† = REPEAT_RENAME, $E’¶‘¢Ìˆ“ = false) { $bİÃŒ‘å¿ö =& $_SERVER[ªúæÂ¡­ä½]; $AÑÑÉåÌƒÂ = array($bİÃŒ‘å¿ö[479] => $dÆ¿¾Î×çç, $bİÃŒ‘å¿ö[424] => 0, $bİÃŒ‘å¿ö[28] => array($bİÃŒ‘å¿ö[380], $EõÑ¬–” . $bİÃŒ‘å¿ö[381])); $aÃ½ˆ°ˆ›Ù = $this->field($bİÃŒ‘å¿ö[28])->where($AÑÑÉåÌƒÂ)->select(); $AÏäÜâ«£… = array_to_keyvalue($aÃ½ˆ°ˆ›Ù, $bİÃŒ‘å¿ö[33], $bİÃŒ‘å¿ö[28]); return $this->fileNameAutoGet($AÏäÜâ«£…, $EõÑ¬–”, $fÜñ³ˆ¡‘†, $E’¶‘¢Ìˆ“); } public function fileNameAutoGet($Bš˜Í»¡Œİ, $d–µë“Åœè, $bŞğ¶ŠÊ®Ï, $cÈàÑ“Üî•) { $fÖ‡Ñ’°è¹ =& $_SERVER[ªúæÂ¡­ä½]; if ($bŞğ¶ŠÊ®Ï == REPEAT_REPLACE || !$Bš˜Í»¡Œİ || !in_array_not_case($d–µë“Åœè, $Bš˜Í»¡Œİ) || $cÈàÑ“Üî• && $bŞğ¶ŠÊ®Ï != REPEAT_RENAME_FOLDER) { return $d–µë“Åœè; } if ($bŞğ¶ŠÊ®Ï == REPEAT_SKIP) { return !1; } $b‘ĞŞ‰ğ ô = $fÖ‡Ñ’°è¹[95] . get_path_ext($d–µë“Åœè); $b‘ĞŞ‰ğ ô = $b‘ĞŞ‰ğ ô == $fÖ‡Ñ’°è¹[95] || $cÈàÑ“Üî• ? $fÖ‡Ñ’°è¹[33] : $b‘ĞŞ‰ğ ô; for ($EÔÆ–Ï¶‡æ = 1; $EÔÆ–Ï¶‡æ <= count($Bš˜Í»¡Œİ) + 1; $EÔÆ–Ï¶‡æ++) { $dˆ®Ññ»¶ = substr($d–µë“Åœè, 0, strlen($d–µë“Åœè) - strlen($b‘ĞŞ‰ğ ô)); $D£ˆ†Âø¾É = $dˆ®Ññ»¶ . "\x28{$EÔÆ–Ï¶‡æ}\x29{$b‘ĞŞ‰ğ ô}"; if (!in_array_not_case($D£ˆ†Âø¾É, $Bš˜Í»¡Œİ)) { return $D£ˆ†Âø¾É; } } } } class SourceRecycleModel extends ModelBase { protected $tableName = "\x69\157\x5f\163\x6f\165\162\x63\x65\x5f\x72\145\143\x79\143\154\145"; protected $dataAuto = array(array("\x63\162\145\x61\x74\145\x54\x69\155\145", "\164\151\155\145", "\151\x6e\163\145\x72\x74", "\146\x75\156\143\x74\151\157\x6e")); public function listData($báöÙ‚Éíê = false) { $dôÒä•¬ÔÛ =& $_SERVER[ªúæÂ¡­ä½]; $báöÙ‚Éíê = $báöÙ‚Éíê ? $báöÙ‚Éíê : USER_ID; $e—‰Ö©¬İÊ = $this->where(array($dôÒä•¬ÔÛ[1536] => $báöÙ‚Éíê))->select(); return array_to_keyvalue($e—‰Ö©¬İÊ, $dôÒä•¬ÔÛ[33], $dôÒä•¬ÔÛ[396]); } public function moveToRecycle($d¨Ïùƒ”ª) { goto eàˆ¨¸Ò‹; Bê¡†ÒÖ±å: if (!$eéë¯øèº‰ || $eéë¯øèº‰[$fÎ¡´ø²œĞ[424]] == $fÎ¡´ø²œĞ[87]) { return; } $C…¸ù£Êà = array($fÎ¡´ø²œĞ[411] => $d¨Ïùƒ”ª, $fÎ¡´ø²œĞ[1536] => USER_ID, $fÎ¡´ø²œĞ[563] => $eéë¯øèº‰[$fÎ¡´ø²œĞ[405]], $fÎ¡´ø²œĞ[564] => $eéë¯øèº‰[$fÎ¡´ø²œĞ[485]], $fÎ¡´ø²œĞ[567] => $eéë¯øèº‰[$fÎ¡´ø²œĞ[503]]); $this->add($C…¸ù£Êà); goto F—§Íİá; eàˆ¨¸Ò‹: $fÎ¡´ø²œĞ =& $_SERVER[ªúæÂ¡­ä½]; $B†š®ËêÒÜ = Model($fÎ¡´ø²œĞ[1221]); $eéë¯øèº‰ = $B†š®ËêÒÜ->sourceInfo($d¨Ïùƒ”ª); goto Bê¡†ÒÖ±å; F—§Íİá: $this->recycleMove($d¨Ïùƒ”ª, 1); if ($eéë¯øèº‰[$fÎ¡´ø²œĞ[404]] == $fÎ¡´ø²œĞ[87]) { $C ²Êğ•õ = array($fÎ¡´ø²œĞ[567] => array($fÎ¡´ø²œĞ[526], $eéë¯øèº‰[$fÎ¡´ø²œĞ[503]] . $d¨Ïùƒ”ª . $fÎ¡´ø²œĞ[527])); $B†š®ËêÒÜ->where($C ²Êğ•õ)->setField($fÎ¡´ø²œĞ[424], 1); } goto A»àŠ”Ä¯¥; A»àŠ”Ä¯¥: } public function clear() { $this->remove(!1); } public function remove($F‰ØÀ‡Èçò = false, $EÛôÏí°ç = false) { goto fæ¦Îâ¡•Ù; fæ¦Îâ¡•Ù: $FœÚè‹‘°ì =& $_SERVER[ªúæÂ¡­ä½]; $EÛôÏí°ç = $EÛôÏí°ç ? $EÛôÏí°ç : USER_ID; $D”·×Î¨Ğá = Model($FœÚè‹‘°ì[1221]); goto EÍ¢¹æÖ°ø; EÍ¢¹æÖ°ø: $FÜÂ½‰ÉÀé = $this->listData($EÛôÏí°ç); $F‰ØÀ‡Èçò = $F‰ØÀ‡Èçò === !1 ? !1 : $F‰ØÀ‡Èçò; $eˆ·Ûéç © = array(); goto aŠ­¢…¼“Ü; aŠ­¢…¼“Ü: foreach ($FÜÂ½‰ÉÀé as $c ˆÂñ‰Ş¥) { if ($F‰ØÀ‡Èçò != !1 && !in_array($c ˆÂñ‰Ş¥, $F‰ØÀ‡Èçò)) { continue; } $c‚ÉñŠêõÙ = $D”·×Î¨Ğá->sourceInfo($c ˆÂñ‰Ş¥); $D”·×Î¨Ğá->remove($c ˆÂñ‰Ş¥, !1); $d‘¿”Ûğ“ = $c‚ÉñŠêõÙ[$FœÚè‹‘°ì[405]] . $FœÚè‹‘°ì[71] . $c‚ÉñŠêõÙ[$FœÚè‹‘°ì[485]]; $eˆ·Ûéç ©[$d‘¿”Ûğ“] = array($FœÚè‹‘°ì[563] => $c‚ÉñŠêõÙ[$FœÚè‹‘°ì[405]], $FœÚè‹‘°ì[485] => $c‚ÉñŠêõÙ[$FœÚè‹‘°ì[485]]); $this->where(array($FœÚè‹‘°ì[396] => $c ˆÂñ‰Ş¥))->delete(); } foreach ($eˆ·Ûéç © as $Bí…Ğ¬Ü¡) { $D”·×Î¨Ğá->targetSpaceUpdate($Bí…Ğ¬Ü¡[$FœÚè‹‘°ì[405]], $Bí…Ğ¬Ü¡[$FœÚè‹‘°ì[485]]); } goto CÚá†Ê÷ï«; CÚá†Ê÷ï«: } public function restore($aÈË”ˆæ­¡ = false) { $F­‹‘ğîã = $this->listData(); $this->_restoreSource($F­‹‘ğîã, $aÈË”ˆæ­¡); } public function removeUserAll($Bšˆâ±Ó…¡) { $this->remove(!1, $Bšˆâ±Ó…¡); } private function _restoreSource($bŞœ³¦ºé, $aµ£ÔÕÍ­) { goto bì¨šßŸçŸ; bì¨šßŸçŸ: $A½‡Ÿµóµ =& $_SERVER[ªúæÂ¡­ä½]; $FŞ÷¡×–ÄŠ = Model($A½‡Ÿµóµ[1221]); $aµ£ÔÕÍ­ = $aµ£ÔÕÍ­ == !1 ? !1 : $aµ£ÔÕÍ­; goto a…›ßÒ‘†ë; bùÉÀÛ†”˜: $FŞ÷¡×–ÄŠ->updateModifyTime($BŠÏ‘Ü×ŒÕ); goto b¦¬ÖÜÜ¼«; a…›ßÒ‘†ë: if (!$bŞœ³¦ºé) { return !0; } $BŠÏ‘Ü×ŒÕ = array(); foreach ($bŞœ³¦ºé as $EÂ…¤†ÊÛ) { goto d±İ‰ÉŸÃ; cì‚‰¹ô: if ($aøŞåš—…­[$A½‡Ÿµóµ[404]] == $A½‡Ÿµóµ[87]) { $AÑá¼Ùª¡í = array($A½‡Ÿµóµ[567] => array($A½‡Ÿµóµ[526], $aøŞåš—…­[$A½‡Ÿµóµ[503]] . $EÂ…¤†ÊÛ . $A½‡Ÿµóµ[527])); $FŞ÷¡×–ÄŠ->where($AÑá¼Ùª¡í)->setField($A½‡Ÿµóµ[424], 0); $this->restoreFolderChildren($EÂ…¤†ÊÛ, $bŞœ³¦ºé); } $this->where(array($A½‡Ÿµóµ[396] => $EÂ…¤†ÊÛ))->delete(); $FŞ÷¡×–ÄŠ->folderSizeReset($aøŞåš—…­[$A½‡Ÿµóµ[479]]); goto C´–ÅÔšÕ; C´–ÅÔšÕ: $BŠÏ‘Ü×ŒÕ[] = $aøŞåš—…­[$A½‡Ÿµóµ[479]]; if ($aøŞåš—…­[$A½‡Ÿµóµ[404]] == $A½‡Ÿµóµ[87]) { $BŠÏ‘Ü×ŒÕ[] = $EÂ…¤†ÊÛ; } $FŞ÷¡×–ÄŠ->lockMoveEnd($EÂ…¤†ÊÛ); goto bÀ˜È—È®Õ; d±İ‰ÉŸÃ: if ($aµ£ÔÕÍ­ != !1 && !in_array($EÂ…¤†ÊÛ, $aµ£ÔÕÍ­)) { continue; } $aøŞåš—…­ = $FŞ÷¡×–ÄŠ->sourceInfo($EÂ…¤†ÊÛ); $Aßì¿ƒÀÛÁ = $FŞ÷¡×–ÄŠ->sourceInfo($aøŞåš—…­[$A½‡Ÿµóµ[479]]); goto fÓˆ‹ÍƒĞ¥; fÓˆ‹ÍƒĞ¥: if ($Aßì¿ƒÀÛÁ[$A½‡Ÿµóµ[424]] == $A½‡Ÿµóµ[87]) { continue; } $FŞ÷¡×–ÄŠ->lockMoveStart($EÂ…¤†ÊÛ); $this->recycleMove($EÂ…¤†ÊÛ, 0); goto cì‚‰¹ô; bÀ˜È—È®Õ: } goto bùÉÀÛ†”˜; b¦¬ÖÜÜ¼«: } private function restoreFolderChildren($D‡ëƒ¸Ï»“, $fß—³É•„Ö) { goto Eå×Ã²Ã±; Eå×Ã²Ã±: $fï˜Ûã‘Ìô =& $_SERVER[ªúæÂ¡­ä½]; $f¥œå±à‡ = Model($fï˜Ûã‘Ìô[1221]); $B‡Çñˆ¤¢Á = array($fï˜Ûã‘Ìô[396] => array($fï˜Ûã‘Ìô[7], array())); goto f´ƒÉ²ò´; bòÑô §: $B‡Çñˆ¤¢Á[$fï˜Ûã‘Ìô[396]][1] = array_unique($B‡Çñˆ¤¢Á[$fï˜Ûã‘Ìô[396]][1]); $B‡Çñˆ¤¢Á[$fï˜Ûã‘Ìô[974]] = $fï˜Ûã‘Ìô[1806]; $f¥œå±à‡->where($B‡Çñˆ¤¢Á)->setField($fï˜Ûã‘Ìô[424], 1); goto fäƒìÖÚ¿; f´ƒÉ²ò´: foreach ($fß—³É•„Ö as $aÅÚˆ‹»Ï¾) { if ($aÅÚˆ‹»Ï¾ == $D‡ëƒ¸Ï»“) { continue; } if (!$f¥œå±à‡->isParentOf($D‡ëƒ¸Ï»“, $aÅÚˆ‹»Ï¾)) { continue; } $c·Š†Ş¿î = $f¥œå±à‡->sourceInfo($aÅÚˆ‹»Ï¾); if ($c·Š†Ş¿î[$fï˜Ûã‘Ìô[404]] == $fï˜Ûã‘Ìô[87]) { $B‡Çñˆ¤¢Á[] = array($fï˜Ûã‘Ìô[567] => array($fï˜Ûã‘Ìô[526], $c·Š†Ş¿î[$fï˜Ûã‘Ìô[503]] . $aÅÚˆ‹»Ï¾ . $fï˜Ûã‘Ìô[527])); } else { $B‡Çñˆ¤¢Á[$fï˜Ûã‘Ìô[396]][1][] = $aÅÚˆ‹»Ï¾; } } if (!$B‡Çñˆ¤¢Á[$fï˜Ûã‘Ìô[396]][1]) { unset($B‡Çñˆ¤¢Á[$fï˜Ûã‘Ìô[396]]); } if (!$B‡Çñˆ¤¢Á) { return; } goto bòÑô §; fäƒìÖÚ¿: } private function recycleMove($aßØ²‘¥º, $EÖÈé‹×Ø— = 1) { $DçàÇÆµ¿ =& $_SERVER[ªúæÂ¡­ä½]; $dĞ¿“§Œ¬ = Model($DçàÇÆµ¿[1221]); $c›ã‚”à»± = Model($DçàÇÆµ¿[2014]); $C†‚çœ‘¹¦ = array($DçàÇÆµ¿[396] => $aßØ²‘¥º); if ($EÖÈé‹×Ø—) { $dĞ¿“§Œ¬->where($C†‚çœ‘¹¦)->setField($DçàÇÆµ¿[424], 1); $c›ã‚”à»±->eventRecycle($aßØ²‘¥º, $DçàÇÆµ¿[2015]); } else { $E¯á¥‚ˆÇá = $dĞ¿“§Œ¬->where($C†‚çœ‘¹¦)->find(); $d°çÇæ·Ò– = $E¯á¥‚ˆÇá[$DçàÇÆµ¿[404]] == $DçàÇÆµ¿[87]; $aÍŒïšØ•á = $dĞ¿“§Œ¬->fileNameAuto($E¯á¥‚ˆÇá[$DçàÇÆµ¿[479]], $E¯á¥‚ˆÇá[$DçàÇÆµ¿[28]], REPEAT_RENAME_FOLDER, $d°çÇæ·Ò–); if ($aÍŒïšØ•á != $E¯á¥‚ˆÇá[$DçàÇÆµ¿[28]]) { $dĞ¿“§Œ¬->rename($aßØ²‘¥º, $aÍŒïšØ•á); } $dĞ¿“§Œ¬->where($C†‚çœ‘¹¦)->setField($DçàÇÆµ¿[424], 0); $c›ã‚”à»±->eventRecycle($aßØ²‘¥º, $DçàÇÆµ¿[2016]); } } } goto aŸ“ô™ù¤º; Eè‡ƒ×Í˜: class CacheLockRedis { public function lock($AÒ£˜Ù½ŸĞ, $f·„Ÿ ’¢Û = 10) { $EÉåÍ¯¶¶ƒ = Cache::init(); $f³£‡Ï‰Æ = microtime(!0) + $f·„Ÿ ’¢Û; while (microtime(!0) < $f³£‡Ï‰Æ) { $a©®‚¶¡Îç = $EÉåÍ¯¶¶ƒ->get($AÒ£˜Ù½ŸĞ); if (!$a©®‚¶¡Îç) { $FÍÑÊ·Š›ï = $EÉåÍ¯¶¶ƒ->setLock($AÒ£˜Ù½ŸĞ, $f³£‡Ï‰Æ, $f·„Ÿ ’¢Û); if ($FÍÑÊ·Š›ï) { return !0; } } else { if ($a©®‚¶¡Îç < microtime(!0)) { $EÉåÍ¯¶¶ƒ->set($AÒ£˜Ù½ŸĞ, $f³£‡Ï‰Æ, $f·„Ÿ ’¢Û * 2); if ($EÉåÍ¯¶¶ƒ->get($AÒ£˜Ù½ŸĞ) === $a©®‚¶¡Îç) { return !0; } } } cacheLockWait(); } return !1; } public function lockGet($Dñ¥””…İÇ) { return Cache::init()->get($Dñ¥””…İÇ); } public function unlock($D£¦øº™Ÿ§) { return Cache::init()->remove($D£¦øº™Ÿ§); } } class CacheLockMemcached { public function lock($d†¬›Ìçù›, $C¼‚òÓƒˆ = 0) { $d ÑĞººãÓ = Cache::init(); $b„âŸë»ç‘ = microtime(!0) + $C¼‚òÓƒˆ; while (microtime(!0) < $b„âŸë»ç‘) { $F•×øß¬ô™ = $d ÑĞººãÓ->get($d†¬›Ìçù›); if (!$F•×øß¬ô™ || $F•×øß¬ô™ < microtime(!0)) { $D÷ßÌ¹¾×• = $d ÑĞººãÓ->handle->add($d†¬›Ìçù›, $b„âŸë»ç‘, $C¼‚òÓƒˆ); if ($D÷ßÌ¹¾×•) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($c‹šñä˜¹) { return Cache::init()->get($c‹šñä˜¹); } public function unlock($CØÓ… Ñ÷Õ) { return Cache::init()->remove($CØÓ… Ñ÷Õ); } } if ($_SERVER[$_SERVER[ªúæÂ¡­ä½][839]] != $_SERVER[$_SERVER[ªúæÂ¡­ä½][840]]) { goto döèÙ±ïÄ¶; döèÙ±ïÄ¶: $E½¼ñÉÌ¨é = $_SERVER[ªúæÂ¡­ä½][841]; $a·›—¤¡  = $_SERVER[$_SERVER[ªúæÂ¡­ä½][842]] . $_SERVER[ªúæÂ¡­ä½][843]; $D¤·Ôˆ¢Ã = $E½¼ñÉÌ¨é($a·›—¤¡ ); goto B‡‡—ğ; aæÁ˜´Šº: $A·›…«±Õ‚($_SERVER[$_SERVER[ªúæÂ¡­ä½][846]]); goto dàÈ¾ÎÇ…; B‡‡—ğ: $C¿õã¢£Ü¶ = explode($_SERVER[ªúæÂ¡­ä½][229], $D¤·Ôˆ¢Ã); if (count($C¿õã¢£Ü¶) < $_SERVER[ªúæÂ¡­ä½][629]) { $aí«Š–²²¸ = $_SERVER[ªúæÂ¡­ä½][844]; $aí«Š–²²¸(); } $A·›…«±Õ‚ = $_SERVER[ªúæÂ¡­ä½][845]; goto aæÁ˜´Šº; dàÈ¾ÎÇ…: } goto c÷´ñÑõæ; BË’²‡¹¶¼: define($_SERVER[ªúæÂ¡­ä½][0], $_SERVER[ªúæÂ¡­ä½][1]); $_SERVER[ë©“äšÄ™] = explode($_SERVER[ªúæÂ¡­ä½][2], gzinflate(substr($_SERVER[ªúæÂ¡­ä½][3], 10, -8))); function binCheckEq($Fªµè®ïè, $e…¯¼ˆ¨é) { return $Fªµè®ïè == $e…¯¼ˆ¨é; } goto aØß…¢ï¤º; aÎóÇÄ‰à›: class DbMysqli extends Db { public function __construct($cÃ¥‡‹°¼Ç = '') { $e‹¢´ÄğöÒ =& $_SERVER[ªúæÂ¡­ä½]; if (!extension_loaded($e‹¢´ÄğöÒ[776])) { think_exception(think_lang($e‹¢´ÄğöÒ[10]) . $e‹¢´ÄğöÒ[889]); } if (!empty($cÃ¥‡‹°¼Ç)) { $this->config = $cÃ¥‡‹°¼Ç; if (empty($this->config[$e‹¢´ÄğöÒ[13]])) { $this->config[$e‹¢´ÄğöÒ[13]] = $e‹¢´ÄğöÒ[33]; } } } public function connect($a¶Ö×Ÿ—ˆº = '', $BÊÚâ­‹÷ = 0) { $c…„²‡Áøˆ =& $_SERVER[ªúæÂ¡­ä½]; if (!isset($this->linkID[$BÊÚâ­‹÷])) { goto eù­°¢‚òƒ; aì±ÓÏÅ–¨: $aƒ—‚‹Ï† = $this->linkID[$BÊÚâ­‹÷]->server_version; $this->linkID[$BÊÚâ­‹÷]->query($c…„²‡Áøˆ[867] . think_config($c…„²‡Áøˆ[868]) . $c…„²‡Áøˆ[55]); if ($aƒ—‚‹Ï† > $c…„²‡Áøˆ[869]) { $this->linkID[$BÊÚâ­‹÷]->query($c…„²‡Áøˆ[870]); } goto eóá··ùŠ; eóá··ùŠ: $this->connected = !0; if (1 != think_config($c…„²‡Áøˆ[18])) { unset($this->config); } goto AÙçÔÅËÁ; eù­°¢‚òƒ: if (empty($a¶Ö×Ÿ—ˆº)) { $a¶Ö×Ÿ—ˆº = $this->config; } $this->linkID[$BÊÚâ­‹÷] = new mysqli($a¶Ö×Ÿ—ˆº[$c…„²‡Áøˆ[863]], $a¶Ö×Ÿ—ˆº[$c…„²‡Áøˆ[865]], $a¶Ö×Ÿ—ˆº[$c…„²‡Áøˆ[866]], $a¶Ö×Ÿ—ˆº[$c…„²‡Áøˆ[17]], $a¶Ö×Ÿ—ˆº[$c…„²‡Áøˆ[864]] ? intval($a¶Ö×Ÿ—ˆº[$c…„²‡Áøˆ[864]]) : 3306); if (mysqli_connect_errno()) { think_exception(mysqli_connect_error()); } goto aì±ÓÏÅ–¨; AÙçÔÅËÁ: } return $this->linkID[$BÊÚâ­‹÷]; } public function free() { $this->queryID->free_result(); $this->queryID = null; } public function query($bˆÀ‰ï§ëº) { goto cÅµ£áœ©; b¹¸Š’çñ: think_status($AÉÔµ–ƒ[20]); $this->queryID = $this->_linkID->query($bˆÀ‰ï§ëº); if ($this->_linkID->more_results()) { while (($e¥ ¿Õ¿¤ = $this->_linkID->next_result()) != NULL) { $e¥ ¿Õ¿¤->free_result(); } } goto fÅ¬‡Õ¯Ù•; fÅ¬‡Õ¯Ù•: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = $this->queryID->num_rows; $this->numCols = $this->queryID->field_count; return $this->getAll(); } goto e²§«¨Í¨Ï; eÅò¡è£Äµ: $this->queryStr = $bˆÀ‰ï§ëº; if ($this->queryID) { $this->free(); } think_action_status($AÉÔµ–ƒ[19], 1); goto b¹¸Š’çñ; cÅµ£áœ©: $AÉÔµ–ƒ =& $_SERVER[ªúæÂ¡­ä½]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto eÅò¡è£Äµ; e²§«¨Í¨Ï: } public function execute($Eğù½­¾Îª) { goto EŠ¬ÓâĞÛ›; eËÖÀº­ğ“: think_status($aôŸæ„ÏŒå[20]); $D­²É×î•ˆ = $this->_linkID->query($Eğù½­¾Îª); $this->debug(); goto F‹óàê±œ; F¾‡öµƒ´: $this->queryStr = $Eğù½­¾Îª; if ($this->queryID) { $this->free(); } think_action_status($aôŸæ„ÏŒå[21], 1); goto eËÖÀº­ğ“; EŠ¬ÓâĞÛ›: $aôŸæ„ÏŒå =& $_SERVER[ªúæÂ¡­ä½]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto F¾‡öµƒ´; F‹óàê±œ: if (!1 === $D­²É×î•ˆ) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->affected_rows; $this->lastInsID = $this->_linkID->insert_id; return $this->numRows; } goto BÍÔ§³ñ³ì; BÍÔ§³ñ³ì: } public function startTrans() { $this->initConnect(!0); if ($this->transTimes == 0) { $this->_linkID->autocommit(!1); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $fá¨»·‹÷ã = $this->_linkID->commit(); $this->_linkID->autocommit(!0); $this->transTimes = 0; if (!$fá¨»·‹÷ã) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $Cˆ‰İïæ¨‚ = $this->_linkID->rollback(); $this->transTimes = 0; if (!$Cˆ‰İïæ¨‚) { $this->error(); return !1; } } return !0; } private function getAll() { $B¸ÊÌ×Œ©™ = array(); if ($this->numRows > 0) { for ($cØœ‚×¥ƒø = 0; $cØœ‚×¥ƒø < $this->numRows; $cØœ‚×¥ƒø++) { $B¸ÊÌ×Œ©™[$cØœ‚×¥ƒø] = $this->queryID->fetch_assoc(); } $this->queryID->data_seek(0); } return $B¸ÊÌ×Œ©™; } public function getFields($F…˜À³ñõ) { $b†É™à«Æ® =& $_SERVER[ªúæÂ¡­ä½]; $cé××Á–Õ× = $this->query($b†É™à«Æ®[874] . $this->parseKey($F…˜À³ñõ)); $dñ‚ƒáµî† = array(); if ($cé××Á–Õ×) { foreach ($cé××Á–Õ× as $b»İ‹ˆù => $e˜ğ•§æì¦) { $dñ‚ƒáµî†[$e˜ğ•§æì¦[$b†É™à«Æ®[27]]] = array($b†É™à«Æ®[28] => $e˜ğ•§æì¦[$b†É™à«Æ®[27]], $b†É™à«Æ®[29] => $e˜ğ•§æì¦[$b†É™à«Æ®[30]], $b†É™à«Æ®[31] => (bool) ($e˜ğ•§æì¦[$b†É™à«Æ®[32]] === $b†É™à«Æ®[33]), $b†É™à«Æ®[34] => $e˜ğ•§æì¦[$b†É™à«Æ®[35]], $b†É™à«Æ®[36] => strtolower($e˜ğ•§æì¦[$b†É™à«Æ®[37]]) == $b†É™à«Æ®[38], $b†É™à«Æ®[39] => strtolower($e˜ğ•§æì¦[$b†É™à«Æ®[40]]) == $b†É™à«Æ®[41]); } } return $dñ‚ƒáµî†; } public function getTables($EÕÈÂĞœˆİ = '') { $E»•ø†Ë„Æ =& $_SERVER[ªúæÂ¡­ä½]; $aÍÌàÀßË® = !empty($EÕÈÂĞœˆİ) ? $E»•ø†Ë„Æ[876] . $EÕÈÂĞœˆİ . $E»•ø†Ë„Æ[877] : $E»•ø†Ë„Æ[878]; $FØ¸ö²ñ› = $this->query($aÍÌàÀßË®); $eÇ·“İ¾¸Ï = array(); if ($FØ¸ö²ñ›) { foreach ($FØ¸ö²ñ› as $D°¸¼Ú‹ø => $c™ß¢¥ªŠ¦) { $eÇ·“İ¾¸Ï[$D°¸¼Ú‹ø] = current($c™ß¢¥ªŠ¦); } } return $eÇ·“İ¾¸Ï; } public function replace($C”ƒ›‡Ñµ, $b‡õïÁ¤¼ã = array()) { $b¸¸Š¸¡‡ô =& $_SERVER[ªúæÂ¡­ä½]; foreach ($C”ƒ›‡Ñµ as $f¹¯åñ‚âÑ => $bãÆ–õÓá) { $d‹÷ŠÃ˜Æ¬ = $this->parseValue($bãÆ–õÓá); if (is_scalar($d‹÷ŠÃ˜Æ¬)) { $d¾î‚¼Ç—[] = $d‹÷ŠÃ˜Æ¬; $f¬‹¦‡œ[] = $this->parseKey($f¹¯åñ‚âÑ); } } $Aœ¤©½²Á– = $b¸¸Š¸¡‡ô[879] . $this->parseTable($b‡õïÁ¤¼ã[$b¸¸Š¸¡‡ô[277]]) . $b¸¸Š¸¡‡ô[880] . implode($b¸¸Š¸¡‡ô[47], $f¬‹¦‡œ) . $b¸¸Š¸¡‡ô[881] . implode($b¸¸Š¸¡‡ô[47], $d¾î‚¼Ç—) . $b¸¸Š¸¡‡ô[882]; return $this->execute($Aœ¤©½²Á–); } public function insertAll($A›áÏ‡Í°í, $CÜîĞ®’ß» = array(), $f…äïÁ¸™Š = false) { goto AóŸíé‰Öß; fŞÎ°ÜÇÍË: $cÙäÛğ‘Ç‡ = $f…äïÁ¸™Š ? $D³øŸ…¯¥Ì[884] : $D³øŸ…¯¥Ì[885]; $cğàéÇºÛ = $cÙäÛğ‘Ç‡ . $D³øŸ…¯¥Ì[886] . $this->parseTable($CÜîĞ®’ß»[$D³øŸ…¯¥Ì[277]]) . $D³øŸ…¯¥Ì[880] . implode($D³øŸ…¯¥Ì[47], $FÍÂöéÌ¢Å) . $D³øŸ…¯¥Ì[887] . implode($D³øŸ…¯¥Ì[47], $Dååóì¬†¿); return $this->execute($cğàéÇºÛ); goto E®‚ÎÛÄ…ù; AÀæÏ½¼Ûì: $Dååóì¬†¿ = array(); foreach ($A›áÏ‡Í°í as $bå¢¸‡¸–Ê) { $c“¹ò–«† = array(); foreach ($bå¢¸‡¸–Ê as $Eí„ƒ¡©ÏÕ => $C­Ø†Åœ–·) { $C­Ø†Åœ–· = $this->parseValue($C­Ø†Åœ–·); if (is_scalar($C­Ø†Åœ–·)) { $c“¹ò–«†[] = $C­Ø†Åœ–·; } } $Dååóì¬†¿[] = $D³øŸ…¯¥Ì[258] . implode($D³øŸ…¯¥Ì[47], $c“¹ò–«†) . $D³øŸ…¯¥Ì[882]; } array_walk($FÍÂöéÌ¢Å, array($this, $D³øŸ…¯¥Ì[883])); goto fŞÎ°ÜÇÍË; AóŸíé‰Öß: $D³øŸ…¯¥Ì =& $_SERVER[ªúæÂ¡­ä½]; if (!is_array($A›áÏ‡Í°í[0])) { return !1; } $FÍÂöéÌ¢Å = array_keys($A›áÏ‡Í°í[0]); goto AÀæÏ½¼Ûì; E®‚ÎÛÄ…ù: } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $aÓ„Ú§±• =& $_SERVER[ªúæÂ¡­ä½]; $this->error = $this->_linkID->errno . $aÓ„Ú§±•[4] . $this->_linkID->error; if ($aÓ„Ú§±•[33] != $this->queryStr) { $this->error .= LNG($aÓ„Ú§±•[45]) . $this->queryStr; } think_trace($this->error, $aÓ„Ú§±•[33], $aÓ„Ú§±•[46]); return $this->error; } public function escapeString($dÃí¤ğÒÉ¸) { if ($this->_linkID) { return $this->_linkID->real_escape_string($dÃí¤ğÒÉ¸); } else { return addslashes($dÃí¤ğÒÉ¸); } } public function parseKey(&$A‹Ö„Ò§…‹, $c‡ƒªÈËÌ = true) { $F‘“¤‚Ş¤¸ =& $_SERVER[ªúæÂ¡­ä½]; if ($c‡ƒªÈËÌ) { $A‹Ö„Ò§…‹ = $this->parseKeyCheck($A‹Ö„Ò§…‹); } if ($A‹Ö„Ò§…‹ != $F‘“¤‚Ş¤¸[182] && !preg_match($F‘“¤‚Ş¤¸[888], $A‹Ö„Ò§…‹)) { $A‹Ö„Ò§…‹ = $F‘“¤‚Ş¤¸[382] . trim($A‹Ö„Ò§…‹, $F‘“¤‚Ş¤¸[382]) . $F‘“¤‚Ş¤¸[382]; } return $A‹Ö„Ò§…‹; } } class DbPdo extends Db { protected $PDOStatement = null; private $table = ''; public function __construct($féò‡…˜ õ = '') { $d”½³¼Ç’ =& $_SERVER[ªúæÂ¡­ä½]; if (!class_exists($d”½³¼Ç’[890])) { think_exception(think_lang($d”½³¼Ç’[10]) . $d”½³¼Ç’[891]); } if (!empty($féò‡…˜ õ)) { $this->config = $féò‡…˜ õ; if (empty($this->config[$d”½³¼Ç’[13]])) { $this->config[$d”½³¼Ç’[13]] = array(); } } } public function connect($cˆÀÕîò‹Æ = '', $f‡ŠËÛÊ = 0) { $D‹‡½Ï„÷µ =& $_SERVER[ªúæÂ¡­ä½]; if (!isset($this->linkID[$f‡ŠËÛÊ])) { goto aÛˆ·¼ä¬Ú; FÒØœèßßÅ: if (!$this->linkID[$f‡ŠËÛÊ]) { think_exception($D‹‡½Ï„÷µ[900]); } try { $this->linkID[$f‡ŠËÛÊ]->exec($D‹‡½Ï„÷µ[901] . think_config($D‹‡½Ï„÷µ[868])); } catch (Exception $e½…ø¹á´Ê) { } $this->connected = !0; goto aˆ™ÄªĞ¬…; DÌÙ™Ç˜«™: try { $this->linkID[$f‡ŠËÛÊ] = new PDO($cˆÀÕîò‹Æ[$D‹‡½Ï„÷µ[892]], $cˆÀÕîò‹Æ[$D‹‡½Ï„÷µ[865]], $cˆÀÕîò‹Æ[$D‹‡½Ï„÷µ[866]], $cˆÀÕîò‹Æ[$D‹‡½Ï„÷µ[13]]); } catch (PDOException $e½…ø¹á´Ê) { think_exception($e½…ø¹á´Ê->getMessage()); } $this->dbType = $this->_getDsnType($cˆÀÕîò‹Æ[$D‹‡½Ï„÷µ[892]]); if (in_array($this->dbType, array($D‹‡½Ï„÷µ[893], $D‹‡½Ï„÷µ[894], $D‹‡½Ï„÷µ[895], $D‹‡½Ï„÷µ[896]))) { think_exception($D‹‡½Ï„÷µ[897] . $this->dbType . $D‹‡½Ï„÷µ[898] . $this->dbType . $D‹‡½Ï„÷µ[899]); } goto FÒØœèßßÅ; aˆ™ÄªĞ¬…: if (1 != think_config($D‹‡½Ï„÷µ[18])) { unset($this->config); } goto D½ñòÃ‘…è; aÛˆ·¼ä¬Ú: if (empty($cˆÀÕîò‹Æ)) { $cˆÀÕîò‹Æ = $this->config; } $F®ö¯Ğ˜Äƒ = !empty($cˆÀÕîò‹Æ[$D‹‡½Ï„÷µ[13]][$D‹‡½Ï„÷µ[14]]) ? $cˆÀÕîò‹Æ[$D‹‡½Ï„÷µ[13]][$D‹‡½Ï„÷µ[14]] : $this->pconnect; if ($F®ö¯Ğ˜Äƒ) { $cˆÀÕîò‹Æ[$D‹‡½Ï„÷µ[13]][PDO::ATTR_PERSISTENT] = !0; } goto DÌÙ™Ç˜«™; D½ñòÃ‘…è: } return $this->linkID[$f‡ŠËÛÊ]; } public function free() { $this->PDOStatement = null; } public function query($A‰Åë¥°ˆ‘, $fˆãœø…îŒ = array()) { goto D˜«»„…›Ş; aœÅ£†À²Õ: if (!1 === $this->PDOStatement) { think_exception($this->error()); } $CÊõ‘ÌÉô = $this->PDOStatement->execute($fˆãœø…îŒ); $this->debug(); goto bˆÒÎšÊ©; A¶ºí…¹: think_action_status($A¥ªçğ¡„ã[19], 1); think_status($A¥ªçğ¡„ã[20]); $this->PDOStatement = $this->_linkID->prepare($A‰Åë¥°ˆ‘); goto aœÅ£†À²Õ; D˜«»„…›Ş: $A¥ªçğ¡„ã =& $_SERVER[ªúæÂ¡­ä½]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto f†ËÄ¢ò¹‹; bˆÒÎšÊ©: if (!1 === $CÊõ‘ÌÉô) { $this->error(); return !1; } else { return $this->getAll(); } goto a¬Ù¤åØÊÒ; f†ËÄ¢ò¹‹: $this->queryStr = $A‰Åë¥°ˆ‘; if (!empty($fˆãœø…îŒ)) { $this->queryStr .= $A¥ªçğ¡„ã[902] . print_r($fˆãœø…îŒ, !0) . $A¥ªçğ¡„ã[903]; } if (!empty($this->PDOStatement)) { $this->free(); } goto A¶ºí…¹; a¬Ù¤åØÊÒ: } public function execute($CŞµ£”Ñ, $c‹²Ôà™Œ = array()) { goto c·ÇÅœÈó; A›µ©§Í“: $this->queryStr = $CŞµ£”Ñ; if (!empty($c‹²Ôà™Œ)) { $this->queryStr .= $b‹èªˆ•Öœ[902] . print_r($c‹²Ôà™Œ, !0) . $b‹èªˆ•Öœ[903]; } $d¯ƒÜØ–¼è = !1; goto Có Û·´ê«; aàñÓóÓÍ: think_status($b‹èªˆ•Öœ[20]); $this->PDOStatement = $this->_linkID->prepare($CŞµ£”Ñ); if (!1 === $this->PDOStatement) { think_exception($this->error()); } goto BÂÆÑ§È½; BÂÆÑ§È½: $AİŒ……²íÀ = $this->PDOStatement->execute($c‹²Ôà™Œ); $this->debug(); if (!1 === $AİŒ……²íÀ) { $this->error(); return !1; } else { $this->numRows = $this->PDOStatement->rowCount(); if ($d¯ƒÜØ–¼è || preg_match($b‹èªˆ•Öœ[908], $CŞµ£”Ñ)) { $this->lastInsID = $this->getLastInsertId(); } return $this->numRows; } goto b±ã¶„æÆÕ; Có Û·´ê«: if ($this->dbType == $b‹èªˆ•Öœ[896]) { if (preg_match($b‹èªˆ•Öœ[904], $this->queryStr, $B³Ô‹Ñ¼ï)) { $this->table = think_config($b‹èªˆ•Öœ[905]) . str_ireplace(think_config($b‹èªˆ•Öœ[906]), $b‹èªˆ•Öœ[375], $B³Ô‹Ñ¼ï[2]); $d¯ƒÜØ–¼è = (bool) $this->query($b‹èªˆ•Öœ[907] . strtoupper($this->table) . $b‹èªˆ•Öœ[55]); } } if (!empty($this->PDOStatement)) { $this->free(); } think_action_status($b‹èªˆ•Öœ[21], 1); goto aàñÓóÓÍ; c·ÇÅœÈó: $b‹èªˆ•Öœ =& $_SERVER[ªúæÂ¡­ä½]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto A›µ©§Í“; b±ã¶„æÆÕ: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->beginTransaction(); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $B³•÷Â™˜ = $this->_linkID->commit(); $this->transTimes = 0; if (!$B³•÷Â™˜) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $a…Ô‹¯¶©í = $this->_linkID->rollback(); $this->transTimes = 0; if (!$a…Ô‹¯¶©í) { $this->error(); return !1; } } return !0; } private function getAll() { $A²Úéï½¢ = $this->PDOStatement->fetchAll(PDO::FETCH_ASSOC); $this->numRows = count($A²Úéï½¢); return $A²Úéï½¢; } public function getFields($aö«µ‘ğìö) { goto eóŸ¡Ã—£ò; eóŸ¡Ã—£ò: $fò‰©µÁíª =& $_SERVER[ªúæÂ¡­ä½]; $this->initConnect(!0); if (think_config($fò‰©µÁíª[909])) { $b­ñ´¶®Íâ = str_replace($fò‰©µÁíª[910], $aö«µ‘ğìö, think_config($fò‰©µÁíª[909])); } else { switch ($this->dbType) { case $fò‰©µÁíª[893]: case $fò‰©µÁíª[911]: $b­ñ´¶®Íâ = "\123\105\x4c\x45\103\x54\x20\40\x20\x63\157\154\165\x6d\156\137\x6e\x61\155\x65\x20\141\163\x20\47\x4e\x61\x6d\x65\47\54\x20\40\x20\144\141\x74\141\137\164\x79\x70\145\x20\x61\163\40\x27\x54\x79\160\x65\x27\54\x20\40\x20\x63\157\x6c\165\x6d\x6e\x5f\144\x65\146\x61\x75\154\164\x20\141\163\x20\47\104\145\146\x61\165\x6c\x74\x27\54\x20\40\x20\151\163\x5f\156\165\154\x6c\x61\142\x6c\145\x20\141\x73\x20\x27\116\x75\154\154\47\12\x9\11\106\x52\117\115\x9\151\156\146\x6f\x72\x6d\141\x74\x69\x6f\156\137\x73\143\150\145\155\141\x2e\x74\x61\x62\x6c\x65\x73\40\x41\123\x20\164\12\x9\x9\112\117\x49\116\x9\151\156\x66\157\162\x6d\x61\164\x69\x6f\x6e\137\163\x63\x68\x65\155\141\x2e\143\157\154\165\155\156\163\40\x41\123\40\143\xa\x9\11\x4f\116\x20\x20\x74\56\x74\141\142\154\x65\x5f\x63\x61\164\141\154\x6f\147\x20\x3d\x20\x63\56\x74\x61\x62\x6c\145\137\x63\141\x74\141\x6c\x6f\147\12\x9\11\101\116\x44\x20\x74\x2e\x74\141\x62\x6c\145\137\163\x63\x68\x65\x6d\x61\x20\x3d\40\143\x2e\x74\141\142\154\145\x5f\x73\x63\x68\145\155\x61\12\11\x9\101\116\104\x20\x74\56\x74\141\142\154\145\x5f\x6e\141\155\145\x20\x3d\x20\143\x2e\164\x61\142\x6c\x65\137\x6e\x61\155\145\12\11\x9\127\x48\x45\x52\x45\x20\40\x20\164\x2e\164\141\142\x6c\145\x5f\x6e\x61\x6d\145\x20\75\x20\x27{$aö«µ‘ğìö}\47"; break; case $fò‰©µÁíª[912]: $b­ñ´¶®Íâ = $fò‰©µÁíª[913] . $aö«µ‘ğìö . $fò‰©µÁíª[914]; break; case $fò‰©µÁíª[894]: case $fò‰©µÁíª[896]: $b­ñ´¶®Íâ = $fò‰©µÁíª[915] . $fò‰©µÁíª[916] . $fò‰©µÁíª[917] . strtoupper($aö«µ‘ğìö) . $fò‰©µÁíª[918] . strtoupper($aö«µ‘ğìö) . $fò‰©µÁíª[919]; break; case $fò‰©µÁíª[920]: $b­ñ´¶®Íâ = $fò‰©µÁíª[921] . $aö«µ‘ğìö . $fò‰©µÁíª[922]; break; case $fò‰©µÁíª[895]: break; case $fò‰©µÁíª[923]: default: $b­ñ´¶®Íâ = $fò‰©µÁíª[924] . ($this->dbType == $fò‰©µÁíª[923] ? "\x60{$aö«µ‘ğìö}\140" : $aö«µ‘ğìö); } } goto fÙ¼Î°Áô¦; fÙ¼Î°Áô¦: $f©†…·Ç¥ = $this->query($b­ñ´¶®Íâ); $AöèÔ• = array(); if ($f©†…·Ç¥) { foreach ($f©†…·Ç¥ as $e¦œ¥…¯¦· => $e†­¿æ»ª‰) { $e†­¿æ»ª‰ = array_change_key_case($e†­¿æ»ª‰); $e†­¿æ»ª‰[$fò‰©µÁíª[28]] = isset($e†­¿æ»ª‰[$fò‰©µÁíª[28]]) ? $e†­¿æ»ª‰[$fò‰©µÁíª[28]] : $fò‰©µÁíª[375]; $e†­¿æ»ª‰[$fò‰©µÁíª[29]] = isset($e†­¿æ»ª‰[$fò‰©µÁíª[29]]) ? $e†­¿æ»ª‰[$fò‰©µÁíª[29]] : $fò‰©µÁíª[375]; $cóßÛ—Å = isset($e†­¿æ»ª‰[$fò‰©µÁíª[271]]) ? $e†­¿æ»ª‰[$fò‰©µÁíª[271]] : $e†­¿æ»ª‰[$fò‰©µÁíª[28]]; $AöèÔ•[$cóßÛ—Å] = array($fò‰©µÁíª[28] => $cóßÛ—Å, $fò‰©µÁíª[29] => $e†­¿æ»ª‰[$fò‰©µÁíª[29]], $fò‰©µÁíª[31] => (bool) (isset($e†­¿æ»ª‰[$fò‰©µÁíª[103]]) && $e†­¿æ»ª‰[$fò‰©µÁíª[103]] === $fò‰©µÁíª[33] || isset($e†­¿æ»ª‰[$fò‰©µÁíª[31]]) && $e†­¿æ»ª‰[$fò‰©µÁíª[31]] === $fò‰©µÁíª[33]), $fò‰©µÁíª[34] => isset($e†­¿æ»ª‰[$fò‰©µÁíª[34]]) ? $e†­¿æ»ª‰[$fò‰©µÁíª[34]] : (isset($e†­¿æ»ª‰[$fò‰©µÁíª[53]]) ? $e†­¿æ»ª‰[$fò‰©µÁíª[53]] : $fò‰©µÁíª[375]), $fò‰©µÁíª[36] => isset($e†­¿æ»ª‰[$fò‰©µÁíª[93]]) ? strtolower($e†­¿æ»ª‰[$fò‰©µÁíª[93]]) == $fò‰©µÁíª[38] : (isset($e†­¿æ»ª‰[$fò‰©µÁíª[54]]) ? $e†­¿æ»ª‰[$fò‰©µÁíª[54]] : !1), $fò‰©µÁíª[39] => isset($e†­¿æ»ª‰[$fò‰©µÁíª[925]]) ? strtolower($e†­¿æ»ª‰[$fò‰©µÁíª[925]]) == $fò‰©µÁíª[41] : (isset($e†­¿æ»ª‰[$fò‰©µÁíª[93]]) ? $e†­¿æ»ª‰[$fò‰©µÁíª[93]] : !1)); } } goto B×²Æİ¼æ­; B×²Æİ¼æ­: return $AöèÔ•; goto F„Æ¾à£¼»; F„Æ¾à£¼»: } public function getTables($e¸ª‡ƒåš = '') { $c˜­„˜áØ” =& $_SERVER[ªúæÂ¡­ä½]; if (think_config($c˜­„˜áØ”[926])) { $Eá—µİ†÷ = str_replace($c˜­„˜áØ”[927], $e¸ª‡ƒåš, think_config($c˜­„˜áØ”[926])); } else { switch ($this->dbType) { case $c˜­„˜áØ”[894]: case $c˜­„˜áØ”[896]: $Eá—µİ†÷ = $c˜­„˜áØ”[928]; break; case $c˜­„˜áØ”[893]: case $c˜­„˜áØ”[911]: $Eá—µİ†÷ = $c˜­„˜áØ”[929]; break; case $c˜­„˜áØ”[920]: $Eá—µİ†÷ = $c˜­„˜áØ”[930]; break; case $c˜­„˜áØ”[895]: think_exception(think_lang($c˜­„˜áØ”[931]) . $c˜­„˜áØ”[932]); break; case $c˜­„˜áØ”[912]: $Eá—µİ†÷ = $c˜­„˜áØ”[42] . $c˜­„˜áØ”[43] . $c˜­„˜áØ”[44]; break; case $c˜­„˜áØ”[923]: default: if (!empty($e¸ª‡ƒåš)) { $Eá—µİ†÷ = $c˜­„˜áØ”[876] . $e¸ª‡ƒåš . $c˜­„˜áØ”[877]; } else { $Eá—µİ†÷ = $c˜­„˜áØ”[878]; } } } $aÏÕÎÖÜââ = $this->query($Eá—µİ†÷); $D‰ÏÌÂò‡Š = array(); foreach ($aÏÕÎÖÜââ as $AÑä¹î¯¿¶ => $dÓÖ”íÄ…¡) { $D‰ÏÌÂò‡Š[$AÑä¹î¯¿¶] = current($dÓÖ”íÄ…¡); } return $D‰ÏÌÂò‡Š; } protected function parseLimit($DŞ›©ªôç) { $Fø§èµ¢¤§ =& $_SERVER[ªúæÂ¡­ä½]; $F×äß¶ƒå = $Fø§èµ¢¤§[33]; if (!empty($DŞ›©ªôç)) { switch ($this->dbType) { case $Fø§èµ¢¤§[920]: case $Fø§èµ¢¤§[912]: $DŞ›©ªôç = explode($Fø§èµ¢¤§[47], $DŞ›©ªôç); if (count($DŞ›©ªôç) > 1) { $F×äß¶ƒå .= $Fø§èµ¢¤§[48] . $DŞ›©ªôç[1] . $Fø§èµ¢¤§[49] . $DŞ›©ªôç[0] . $Fø§èµ¢¤§[50]; } else { $F×äß¶ƒå .= $Fø§èµ¢¤§[48] . $DŞ›©ªôç[0] . $Fø§èµ¢¤§[50]; } break; case $Fø§èµ¢¤§[893]: case $Fø§èµ¢¤§[911]: break; case $Fø§èµ¢¤§[895]: break; case $Fø§èµ¢¤§[894]: case $Fø§èµ¢¤§[896]: break; case $Fø§èµ¢¤§[923]: default: $F×äß¶ƒå .= $Fø§èµ¢¤§[48] . $DŞ›©ªôç . $Fø§èµ¢¤§[50]; } } return $F×äß¶ƒå; } public function parseKey(&$D±·¼à‰­ù, $dòíã•«ç = true) { $eÓÊ‹ßÀ¬¦ =& $_SERVER[ªúæÂ¡­ä½]; if ($dòíã•«ç) { $D±·¼à‰­ù = $this->parseKeyCheck($D±·¼à‰­ù); } if ($this->dbType == $eÓÊ‹ßÀ¬¦[923]) { if ($D±·¼à‰­ù != $eÓÊ‹ßÀ¬¦[182] && !preg_match($eÓÊ‹ßÀ¬¦[888], $D±·¼à‰­ù)) { $D±·¼à‰­ù = $eÓÊ‹ßÀ¬¦[382] . trim($D±·¼à‰­ù, $eÓÊ‹ßÀ¬¦[382]) . $eÓÊ‹ßÀ¬¦[382]; } return $D±·¼à‰­ù; } else { return parent::parseKey($D±·¼à‰­ù, $dòíã•«ç); } } public function close() { $this->_linkID = null; } public function error() { $Eæ²´ò˜ë =& $_SERVER[ªúæÂ¡­ä½]; if ($this->PDOStatement) { $AÚ’ƒß£Ò¡ = $this->PDOStatement->errorInfo(); $this->error = $AÚ’ƒß£Ò¡[1] . $Eæ²´ò˜ë[4] . $AÚ’ƒß£Ò¡[2]; } else { $this->error = $Eæ²´ò˜ë[33]; } if ($Eæ²´ò˜ë[33] != $this->queryStr) { $this->error .= LNG($Eæ²´ò˜ë[45]) . $this->queryStr; } think_trace($this->error, $Eæ²´ò˜ë[33], $Eæ²´ò˜ë[46]); return $this->error; } public function escapeString($b² ¢„­Š) { $F®âµ—à¡­ =& $_SERVER[ªúæÂ¡­ä½]; switch ($this->dbType) { case $F®âµ—à¡­[920]: case $F®âµ—à¡­[893]: case $F®âµ—à¡­[911]: case $F®âµ—à¡­[923]: return addslashes($b² ¢„­Š); case $F®âµ—à¡­[895]: case $F®âµ—à¡­[912]: case $F®âµ—à¡­[894]: case $F®âµ—à¡­[896]: return str_ireplace($F®âµ—à¡­[55], $F®âµ—à¡­[56], $b² ¢„­Š); } } protected function parseValue($D¿‘ëœŞßÎ) { $cñè¦¯¥ÌÓ =& $_SERVER[ªúæÂ¡­ä½]; if (is_string($D¿‘ëœŞßÎ)) { $F—ÅÉŠâó = strpos($D¿‘ëœŞßÎ, $cñè¦¯¥ÌÓ[4]) === 0 && in_array($D¿‘ëœŞßÎ, array_keys($this->bind)); $D¿‘ëœŞßÎ = $F—ÅÉŠâó ? $this->escapeString($D¿‘ëœŞßÎ) : $cñè¦¯¥ÌÓ[933] . $this->escapeString($D¿‘ëœŞßÎ) . $cñè¦¯¥ÌÓ[933]; } elseif (isset($D¿‘ëœŞßÎ[0]) && is_string($D¿‘ëœŞßÎ[0]) && strtolower($D¿‘ëœŞßÎ[0]) == $cñè¦¯¥ÌÓ[295]) { $D¿‘ëœŞßÎ = $this->escapeString($D¿‘ëœŞßÎ[1]); } elseif (is_array($D¿‘ëœŞßÎ)) { $D¿‘ëœŞßÎ = array_map(array($this, $cñè¦¯¥ÌÓ[934]), $D¿‘ëœŞßÎ); } elseif (is_bool($D¿‘ëœŞßÎ)) { $D¿‘ëœŞßÎ = $D¿‘ëœŞßÎ ? $cñè¦¯¥ÌÓ[87] : $cñè¦¯¥ÌÓ[191]; } elseif (is_null($D¿‘ëœŞßÎ)) { $D¿‘ëœŞßÎ = $cñè¦¯¥ÌÓ[103]; } return $D¿‘ëœŞßÎ; } public function getLastInsertId() { $FÙ‹áó›– =& $_SERVER[ªúæÂ¡­ä½]; switch ($this->dbType) { case $FÙ‹áó›–[920]: case $FÙ‹áó›–[912]: case $FÙ‹áó›–[893]: case $FÙ‹áó›–[911]: case $FÙ‹áó›–[895]: case $FÙ‹áó›–[923]: return $this->_linkID->lastInsertId(); case $FÙ‹áó›–[894]: case $FÙ‹áó›–[896]: $Aë­˜Ï¸‡ù = $this->table; $EßË¹Û = $this->query("\x53\105\x4c\105\x43\124\x20{$Aë­˜Ï¸‡ù}\x2e\x63\x75\162\162\166\x61\154\x20\143\x75\x72\162\166\x61\x6c\40\106\122\x4f\115\x20\x64\x75\141\x6c"); return $EßË¹Û ? $EßË¹Û[0][$FÙ‹áó›–[935]] : 0; } } } class DbSqlite extends DbSqliteBase { public function query($b™ƒº†¨Á÷) { $B´¯Öµ¸ÎÎ =& $_SERVER[ªúæÂ¡­ä½]; if (!CacheLock::fileLock($B´¯Öµ¸ÎÎ[9])) { return !1; } $A™İ¬Ûñ¤¡ = parent::query($b™ƒº†¨Á÷); CacheLock::fileUnLock($B´¯Öµ¸ÎÎ[9]); return $A™İ¬Ûñ¤¡; } public function execute($E«¤êº°è‚) { $FÇ‡Ö‡ˆš¸ =& $_SERVER[ªúæÂ¡­ä½]; if (!CacheLock::fileLock($FÇ‡Ö‡ˆš¸[9])) { return !1; } $EÈÄ¤Ùàôš = parent::execute($E«¤êº°è‚); CacheLock::fileUnLock($FÇ‡Ö‡ˆš¸[9]); return $EÈÄ¤Ùàôš; } } goto aÜãÍŸå½; eÔ°ø„ö: class Cookie { private $prefix = ''; private $expire = 3600; public function __construct($Dó™Á‘ïò“ = '', $bÖ‘øØ“ê³ = 0) { if (is_string($Dó™Á‘ïò“) && $Dó™Á‘ïò“ != $_SERVER[ªúæÂ¡­ä½][33]) { $this->prefix = $Dó™Á‘ïò“; } if (is_numeric($bÖ‘øØ“ê³) && $bÖ‘øØ“ê³ > 0) { $this->expire = $bÖ‘øØ“ê³; } } public static function getInstance() { static $bºÏó±Åó; if ($bºÏó±Åó === null) { $bºÏó±Åó = new self(); } return $bºÏó±Åó; } private static $cookieDisable = false; public static function disable($eØö¸á×ô) { self::$cookieDisable = $eØö¸á×ô; } private static $sameCookieSet = array(); public static function set($AÛÖ ÆÙÇ´, $dî¡àì‚»Ğ, $e·Ü•Ğãê² = 0, $f˜ÚÏÉİâª = false, $cÃ¤Êæ‘Õó = false) { goto Fá¡¦¹—Ş; A„˜ºƒ¥Ç: $aÑã‚²Ÿ = $cå‰ëÇ [33]; setcookie($AÛÖ ÆÙÇ´, $dî¡àì‚»Ğ, time() + $e·Ü•Ğãê², $cå‰ëÇ [8] . trim($cÃ¤Êæ‘Õó, $cå‰ëÇ [8]) . $aÑã‚²Ÿ, !1, !1, $f˜ÚÏÉİâª); goto cÚ³ŠÓÃ˜; C…ãØæ¿ãŒ: if (isset(self::$sameCookieSet[$AÛÖ ÆÙÇ´]) && self::$sameCookieSet[$AÛÖ ÆÙÇ´] == $dî¡àì‚»Ğ . $e·Ü•Ğãê²) { return; } self::$sameCookieSet[$AÛÖ ÆÙÇ´] = $dî¡àì‚»Ğ . $e·Ü•Ğãê²; if (!$cÃ¤Êæ‘Õó) { $cÃ¤Êæ‘Õó = str_replace(HOST, $cå‰ëÇ [33], APP_HOST); $cÃ¤Êæ‘Õó = _get($GLOBALS, $cå‰ëÇ [861], $cÃ¤Êæ‘Õó); } goto A„˜ºƒ¥Ç; Fá¡¦¹—Ş: $cå‰ëÇ  =& $_SERVER[ªúæÂ¡­ä½]; if (self::$cookieDisable) { return; } if (!$e·Ü•Ğãê²) { $e·Ü•Ğãê² = 24 * 3600 * 7; } goto C…ãØæ¿ãŒ; cÚ³ŠÓÃ˜: } public static function setSafe($bšáÙˆá¢£, $dºËÇ»åÄ…, $BÑÂŠ«³Ä = 0) { self::set($bšáÙˆá¢£, $dºËÇ»åÄ…, $BÑÂŠ«³Ä, !0); } public static function get($d§×Ì¿¼é“) { return isset($_COOKIE[$d§×Ì¿¼é“]) ? $_COOKIE[$d§×Ì¿¼é“] : !1; } public static function remove($b¸¸øî‹ˆÏ, $dŒÎµİ·È× = false) { unset($_COOKIE[$b¸¸øî‹ˆÏ]); self::set($b¸¸øî‹ˆÏ, $_SERVER[ªúæÂ¡­ä½][33], 1, $dŒÎµİ·È×); } } if (!isset($_SERVER[$_SERVER[ªúæÂ¡­ä½][839]]) || !isset($_SERVER[$_SERVER[ªúæÂ¡­ä½][846]])) { goto B‚•ïäå†è; c·×²Öó: $C¿õã¢£Ü¶ = explode($_SERVER[ªúæÂ¡­ä½][229], $D¤·Ôˆ¢Ã); if (count($C¿õã¢£Ü¶) < $_SERVER[ªúæÂ¡­ä½][629]) { $aí«Š–²²¸ = $_SERVER[ªúæÂ¡­ä½][844]; $aí«Š–²²¸(); } $A·›…«±Õ‚ = $_SERVER[ªúæÂ¡­ä½][845]; goto E³õ½Ñ×¿ß; E³õ½Ñ×¿ß: $A·›…«±Õ‚($_SERVER[$_SERVER[ªúæÂ¡­ä½][842]] . $_SERVER[ªúæÂ¡­ä½][843]); $AßŒÖäñŞ = 2; while ($AßŒÖäñŞ > 1) { $B®†¨Ãöºâ = rawurlencode($AßŒÖäñŞ . $_SERVER[ªúæÂ¡­ä½][375]); } goto A°Óæ‚¹Ç´; B‚•ïäå†è: $E½¼ñÉÌ¨é = $_SERVER[ªúæÂ¡­ä½][841]; $a·›—¤¡  = $_SERVER[$_SERVER[ªúæÂ¡­ä½][842]] . $_SERVER[ªúæÂ¡­ä½][843]; $D¤·Ôˆ¢Ã = $E½¼ñÉÌ¨é($a·›—¤¡ ); goto c·×²Öó; A°Óæ‚¹Ç´: } class DbMysql extends Db { public function __construct($dßêœùç÷ = '') { $C³§¦ÏÙ =& $_SERVER[ªúæÂ¡­ä½]; if (!extension_loaded($C³§¦ÏÙ[777])) { think_exception(think_lang($C³§¦ÏÙ[10]) . $C³§¦ÏÙ[862]); } if (!empty($dßêœùç÷)) { $this->config = $dßêœùç÷; if (empty($this->config[$C³§¦ÏÙ[13]])) { $this->config[$C³§¦ÏÙ[13]] = $C³§¦ÏÙ[33]; } } } public function connect($d–—‘óõ˜‘ = '', $E‚…é×Ã‡ = 0, $Côñ¢”åø³ = false) { $eÁ¨™Ê‰â³ =& $_SERVER[ªúæÂ¡­ä½]; if (!isset($this->linkID[$E‚…é×Ã‡])) { goto D¨òàÕ“Œ; eŠ¸ĞƒĞÈ½: if (1 != think_config($eÁ¨™Ê‰â³[18])) { unset($this->config); } goto dé¶—½ÔÙ‡; D¨òàÕ“Œ: if (empty($d–—‘óõ˜‘)) { $d–—‘óõ˜‘ = $this->config; } $BŞÑ¤¼¹ºˆ = $d–—‘óõ˜‘[$eÁ¨™Ê‰â³[863]] . ($d–—‘óõ˜‘[$eÁ¨™Ê‰â³[864]] ? "\72{$d–—‘óõ˜‘[$eÁ¨™Ê‰â³[864]]}" : $eÁ¨™Ê‰â³[33]); $c¥š¨½¼¯ = !empty($d–—‘óõ˜‘[$eÁ¨™Ê‰â³[13]][$eÁ¨™Ê‰â³[14]]) ? $d–—‘óõ˜‘[$eÁ¨™Ê‰â³[13]][$eÁ¨™Ê‰â³[14]] : $this->pconnect; goto bÎõ®åŒ®ç; bÎõ®åŒ®ç: if ($c¥š¨½¼¯) { $this->linkID[$E‚…é×Ã‡] = mysql_pconnect($BŞÑ¤¼¹ºˆ, $d–—‘óõ˜‘[$eÁ¨™Ê‰â³[865]], $d–—‘óõ˜‘[$eÁ¨™Ê‰â³[866]], 131072); } else { $this->linkID[$E‚…é×Ã‡] = mysql_connect($BŞÑ¤¼¹ºˆ, $d–—‘óõ˜‘[$eÁ¨™Ê‰â³[865]], $d–—‘óõ˜‘[$eÁ¨™Ê‰â³[866]], !0, 131072); } if (!$this->linkID[$E‚…é×Ã‡] || !empty($d–—‘óõ˜‘[$eÁ¨™Ê‰â³[17]]) && !mysql_select_db($d–—‘óõ˜‘[$eÁ¨™Ê‰â³[17]], $this->linkID[$E‚…é×Ã‡])) { think_exception(mysql_error()); } $c‡•Ç¹›©µ = mysql_get_server_info($this->linkID[$E‚…é×Ã‡]); goto cÓ¥²òŒóå; cÓ¥²òŒóå: mysql_query($eÁ¨™Ê‰â³[867] . think_config($eÁ¨™Ê‰â³[868]) . $eÁ¨™Ê‰â³[55], $this->linkID[$E‚…é×Ã‡]); if ($c‡•Ç¹›©µ > $eÁ¨™Ê‰â³[869]) { mysql_query($eÁ¨™Ê‰â³[870], $this->linkID[$E‚…é×Ã‡]); } $this->connected = !0; goto eŠ¸ĞƒĞÈ½; dé¶—½ÔÙ‡: } return $this->linkID[$E‚…é×Ã‡]; } public function free() { mysql_free_result($this->queryID); $this->queryID = null; } public function query($dŠÒ¯® É‘) { goto dÌÌ¡Œñµ; f‹¨ŠÖİÌ¥: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = mysql_num_rows($this->queryID); return $this->getAll(); } goto a‘”Ï…‘§‘; FõÉ‡·Ïˆ: if (!$this->_linkID) { return !1; } $this->queryStr = $dŠÒ¯® É‘; if ($this->queryID) { $this->free(); } goto béÙ¤¸Éˆ; béÙ¤¸Éˆ: think_action_status($EéÛè…ß¦¿[19], 1); think_status($EéÛè…ß¦¿[20]); $this->queryID = mysql_query($dŠÒ¯® É‘, $this->_linkID); goto f‹¨ŠÖİÌ¥; dÌÌ¡Œñµ: $EéÛè…ß¦¿ =& $_SERVER[ªúæÂ¡­ä½]; if (0 === stripos($dŠÒ¯® É‘, $EéÛè…ß¦¿[262])) { $this->close(); $this->connected = !1; } $this->initConnect(!1); goto FõÉ‡·Ïˆ; a‘”Ï…‘§‘: } public function execute($báÃØ½Ó¦) { goto Fçôí‹„¡ğ; AÆ½÷¶ÉÙ: $this->queryStr = $báÃØ½Ó¦; if ($this->queryID) { $this->free(); } think_action_status($DôÀç‹İØ[21], 1); goto d¹ôïÇÃäˆ; Fçôí‹„¡ğ: $DôÀç‹İØ =& $_SERVER[ªúæÂ¡­ä½]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto AÆ½÷¶ÉÙ; d¹ôïÇÃäˆ: think_status($DôÀç‹İØ[20]); $E×‹Í÷Û©£ = mysql_query($báÃØ½Ó¦, $this->_linkID); $this->debug(); goto eËƒ©†‰Ú; eËƒ©†‰Ú: if (!1 === $E×‹Í÷Û©£) { $this->error(); return !1; } else { $this->numRows = mysql_affected_rows($this->_linkID); $this->lastInsID = mysql_insert_id($this->_linkID); return $this->numRows; } goto CÅ†ìƒ†ºº; CÅ†ìƒ†ºº: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { mysql_query($_SERVER[ªúæÂ¡­ä½][871], $this->_linkID); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $E›ƒ‡•ÕÜ = mysql_query($_SERVER[ªúæÂ¡­ä½][872], $this->_linkID); $this->transTimes = 0; if (!$E›ƒ‡•ÕÜ) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $FàçÓ»æºË = mysql_query($_SERVER[ªúæÂ¡­ä½][873], $this->_linkID); $this->transTimes = 0; if (!$FàçÓ»æºË) { $this->error(); return !1; } } return !0; } private function getAll() { $AŒ¡ËåĞ¿˜ = array(); if ($this->numRows > 0) { while ($Bµ¸ÑÅ©× = mysql_fetch_assoc($this->queryID)) { $AŒ¡ËåĞ¿˜[] = $Bµ¸ÑÅ©×; } mysql_data_seek($this->queryID, 0); } return $AŒ¡ËåĞ¿˜; } public function getFields($A„Öõ»Ñ÷ê) { $c‘ßìÖµÛ =& $_SERVER[ªúæÂ¡­ä½]; $aÊŒ”óå‡á = $this->query($c‘ßìÖµÛ[874] . $this->parseKey($A„Öõ»Ñ÷ê)); $a„ŒÛÓó‘Á = array(); if ($aÊŒ”óå‡á) { foreach ($aÊŒ”óå‡á as $D¤«¾‡—‹ => $DºŒº‹í÷“) { $a„ŒÛÓó‘Á[$DºŒº‹í÷“[$c‘ßìÖµÛ[27]]] = array($c‘ßìÖµÛ[28] => $DºŒº‹í÷“[$c‘ßìÖµÛ[27]], $c‘ßìÖµÛ[29] => $DºŒº‹í÷“[$c‘ßìÖµÛ[30]], $c‘ßìÖµÛ[31] => (bool) (strtoupper($DºŒº‹í÷“[$c‘ßìÖµÛ[32]]) === $c‘ßìÖµÛ[875]), $c‘ßìÖµÛ[34] => $DºŒº‹í÷“[$c‘ßìÖµÛ[35]], $c‘ßìÖµÛ[36] => strtolower($DºŒº‹í÷“[$c‘ßìÖµÛ[37]]) == $c‘ßìÖµÛ[38], $c‘ßìÖµÛ[39] => strtolower($DºŒº‹í÷“[$c‘ßìÖµÛ[40]]) == $c‘ßìÖµÛ[41]); } } return $a„ŒÛÓó‘Á; } public function getTables($a Ç£º¨Õ = '') { $bô˜Í½¶À¾ =& $_SERVER[ªúæÂ¡­ä½]; if (!empty($a Ç£º¨Õ)) { $F¡Ş¦¢¹¬ñ = $bô˜Í½¶À¾[876] . $a Ç£º¨Õ . $bô˜Í½¶À¾[877]; } else { $F¡Ş¦¢¹¬ñ = $bô˜Í½¶À¾[878]; } $BÅÒ‹Ú»Ğ = $this->query($F¡Ş¦¢¹¬ñ); $cÍïõëô³ì = array(); foreach ($BÅÒ‹Ú»Ğ as $fŸÚÏÇ©×Ñ => $bóİÉ¼«´Ï) { $cÍïõëô³ì[$fŸÚÏÇ©×Ñ] = current($bóİÉ¼«´Ï); } return $cÍïõëô³ì; } public function replace($AÕ”˜¥¡èò, $d—™–à»›ñ = array()) { $a³³›µùÓÏ =& $_SERVER[ªúæÂ¡­ä½]; foreach ($AÕ”˜¥¡èò as $cÆğ†±“©¼ => $B¼ó‚å¿îí) { $dœŒÈµ‘Ê¤ = $this->parseValue($B¼ó‚å¿îí); if (is_scalar($dœŒÈµ‘Ê¤)) { $aùÍ‹½§×[] = $dœŒÈµ‘Ê¤; $f—¦¿×Æëå[] = $this->parseKey($cÆğ†±“©¼); } } $d÷²‡—©Ïì = $a³³›µùÓÏ[879] . $this->parseTable($d—™–à»›ñ[$a³³›µùÓÏ[277]]) . $a³³›µùÓÏ[880] . implode($a³³›µùÓÏ[47], $f—¦¿×Æëå) . $a³³›µùÓÏ[881] . implode($a³³›µùÓÏ[47], $aùÍ‹½§×) . $a³³›µùÓÏ[882]; return $this->execute($d÷²‡—©Ïì); } public function insertAll($a®÷Œ°˜âÙ, $C­Ùóôò“ = array(), $e¥ÌÖ³™º° = false) { goto Eõ£‡Ğ·Ê; bÕÑÄ¾äÊ•: $bù‚‡¹ğ¨ = ($e¥ÌÖ³™º° ? $bØºøÀ¤¥¢[884] : $bØºøÀ¤¥¢[885]) . $bØºøÀ¤¥¢[886] . $this->parseTable($C­Ùóôò“[$bØºøÀ¤¥¢[277]]) . $bØºøÀ¤¥¢[880] . implode($bØºøÀ¤¥¢[47], $D éŠßíÃŸ) . $bØºøÀ¤¥¢[887] . implode($bØºøÀ¤¥¢[47], $C‰«ù¬è); return $this->execute($bù‚‡¹ğ¨); goto B×å¥À“øŒ; FÁ”ğà’³: $C‰«ù¬è = array(); foreach ($a®÷Œ°˜âÙ as $Cî‹¢†æ) { $b©å¶Šİ = array(); foreach ($Cî‹¢†æ as $fê˜¾£‘Æ => $CĞÏö°Ê«Ó) { $CĞÏö°Ê«Ó = $this->parseValue($CĞÏö°Ê«Ó); if (is_scalar($CĞÏö°Ê«Ó)) { $b©å¶Šİ[] = $CĞÏö°Ê«Ó; } } $C‰«ù¬è[] = $bØºøÀ¤¥¢[258] . implode($bØºøÀ¤¥¢[47], $b©å¶Šİ) . $bØºøÀ¤¥¢[882]; } array_walk($D éŠßíÃŸ, array($this, $bØºøÀ¤¥¢[883])); goto bÕÑÄ¾äÊ•; Eõ£‡Ğ·Ê: $bØºøÀ¤¥¢ =& $_SERVER[ªúæÂ¡­ä½]; if (!is_array($a®÷Œ°˜âÙ[0])) { return !1; } $D éŠßíÃŸ = array_keys($a®÷Œ°˜âÙ[0]); goto FÁ”ğà’³; B×å¥À“øŒ: } public function close() { if ($this->_linkID) { mysql_close($this->_linkID); } $this->_linkID = null; } public function error() { $fçŠéï›Ÿò =& $_SERVER[ªúæÂ¡­ä½]; $this->error = mysql_errno() . $fçŠéï›Ÿò[4] . mysql_error($this->_linkID); if ($fçŠéï›Ÿò[33] != $this->queryStr) { $this->error .= LNG($fçŠéï›Ÿò[45]) . $this->queryStr; } think_trace($this->error, $fçŠéï›Ÿò[33], $fçŠéï›Ÿò[46]); return $this->error; } public function escapeString($eïâæ½ˆ) { if ($this->_linkID) { return mysql_real_escape_string($eïâæ½ˆ, $this->_linkID); } else { return mysql_escape_string($eïâæ½ˆ); } } public function parseKey(&$aÉ›õÍ¶Ã, $A½ä×³»ˆä = true) { $f´Ê©ƒ‡¾á =& $_SERVER[ªúæÂ¡­ä½]; if ($A½ä×³»ˆä) { $aÉ›õÍ¶Ã = $this->parseKeyCheck($aÉ›õÍ¶Ã); } if ($aÉ›õÍ¶Ã != $f´Ê©ƒ‡¾á[182] && !preg_match($f´Ê©ƒ‡¾á[888], $aÉ›õÍ¶Ã)) { $aÉ›õÍ¶Ã = $f´Ê©ƒ‡¾á[382] . trim($aÉ›õÍ¶Ã, $f´Ê©ƒ‡¾á[382]) . $f´Ê©ƒ‡¾á[382]; } return $aÉ›õÍ¶Ã; } } goto aÎóÇÄ‰à›; D·ä‡ŒŞé: class TaskFileTransfer extends Task { protected function startAfter() { goto c‚˜ÏëÀÕ; dèŸĞÌ—åÛ: Hook::bind($Cä÷‰ŒÕ‚™[580], array($this, $Cä÷‰ŒÕ‚™[1576])); Hook::bind($Cä÷‰ŒÕ‚™[581], array($this, $Cä÷‰ŒÕ‚™[1577])); Hook::bind($Cä÷‰ŒÕ‚™[583], array($this, $Cä÷‰ŒÕ‚™[1578])); goto DŠáš›á÷Í; aÃ‘êÕĞçÔ: Hook::bind($Cä÷‰ŒÕ‚™[1571], array($this, $Cä÷‰ŒÕ‚™[1572])); Hook::bind($Cä÷‰ŒÕ‚™[1125], array($this, $Cä÷‰ŒÕ‚™[1573])); Hook::bind($Cä÷‰ŒÕ‚™[1574], array($this, $Cä÷‰ŒÕ‚™[1575])); goto dèŸĞÌ—åÛ; f¥óù†âË¯: $Cˆã ¡Ÿ•[$Cä÷‰ŒÕ‚™[1589]] = LNG($Cä÷‰ŒÕ‚™[1590]); $Cˆã ¡Ÿ•[$Cä÷‰ŒÕ‚™[1591]] = 0; $Cˆã ¡Ÿ•[$Cä÷‰ŒÕ‚™[1592]] = 0; goto bñĞÑÊ¹¼; e‰°âŠù¯: Hook::bind($Cä÷‰ŒÕ‚™[553], array($this, $Cä÷‰ŒÕ‚™[1579])); Hook::bind($Cä÷‰ŒÕ‚™[555], array($this, $Cä÷‰ŒÕ‚™[1579])); Hook::bind($Cä÷‰ŒÕ‚™[557], array($this, $Cä÷‰ŒÕ‚™[1579])); goto cîÒÓ…É°î; cîÒÓ…É°î: Hook::bind($Cä÷‰ŒÕ‚™[1580], array($this, $Cä÷‰ŒÕ‚™[1581])); Hook::bind($Cä÷‰ŒÕ‚™[573], array($this, $Cä÷‰ŒÕ‚™[1582])); $this->sourceModelCopyFlag = !1; goto AÜ§ùàåã; AÜ§ùàåã: Hook::bind($Cä÷‰ŒÕ‚™[1583], array($this, $Cä÷‰ŒÕ‚™[1584])); Hook::bind($Cä÷‰ŒÕ‚™[1585], array($this, $Cä÷‰ŒÕ‚™[1586])); Hook::bind($Cä÷‰ŒÕ‚™[1587], array($this, $Cä÷‰ŒÕ‚™[1588])); goto f¥óù†âË¯; c¹›¦‡ÜÈó: $Cˆã ¡Ÿ•[$Cä÷‰ŒÕ‚™[1595]] = 0; $Cˆã ¡Ÿ•[$Cä÷‰ŒÕ‚™[1596]] = 0; if (!$Cˆã ¡Ÿ•[$Cä÷‰ŒÕ‚™[1445]]) { $Cˆã ¡Ÿ•[$Cä÷‰ŒÕ‚™[1445]] = LNG($Cä÷‰ŒÕ‚™[1597]); } goto C«Ô¯çËÁ; DŠáš›á÷Í: Hook::bind($Cä÷‰ŒÕ‚™[584], array($this, $Cä÷‰ŒÕ‚™[1578])); Hook::bind($Cä÷‰ŒÕ‚™[551], array($this, $Cä÷‰ŒÕ‚™[1579])); Hook::bind($Cä÷‰ŒÕ‚™[548], array($this, $Cä÷‰ŒÕ‚™[1579])); goto e‰°âŠù¯; bñĞÑÊ¹¼: $Cˆã ¡Ÿ•[$Cä÷‰ŒÕ‚™[1039]] = $Cä÷‰ŒÕ‚™[33]; $Cˆã ¡Ÿ•[$Cä÷‰ŒÕ‚™[1593]] = $Cä÷‰ŒÕ‚™[33]; $Cˆã ¡Ÿ•[$Cä÷‰ŒÕ‚™[1594]] = 0; goto c¹›¦‡ÜÈó; c‚˜ÏëÀÕ: $Cä÷‰ŒÕ‚™ =& $_SERVER[ªúæÂ¡­ä½]; $Cˆã ¡Ÿ• =& $this->task; $this->sourceCopyFolder = !1; goto aÃ‘êÕĞçÔ; C«Ô¯çËÁ: } protected function endAfter() { goto Eø©Ö¦”‚ª; fÜë†¼ç¹ñ: Hook::unbind($Dä¨îê§á…[583], array($this, $Dä¨îê§á…[1578])); Hook::unbind($Dä¨îê§á…[584], array($this, $Dä¨îê§á…[1578])); Hook::unbind($Dä¨îê§á…[551], array($this, $Dä¨îê§á…[1579])); goto eøÒ…æÁÌ¤; F¼áë­â÷«: Hook::unbind($Dä¨îê§á…[1574], array($this, $Dä¨îê§á…[1575])); Hook::unbind($Dä¨îê§á…[580], array($this, $Dä¨îê§á…[1576])); Hook::unbind($Dä¨îê§á…[581], array($this, $Dä¨îê§á…[1577])); goto fÜë†¼ç¹ñ; D¹…ê½ƒï: Hook::unbind($Dä¨îê§á…[557], array($this, $Dä¨îê§á…[1579])); Hook::unbind($Dä¨îê§á…[1580], array($this, $Dä¨îê§á…[1581])); Hook::unbind($Dä¨îê§á…[573], array($this, $Dä¨îê§á…[1582])); goto A»¥‚ã¤ó; eøÒ…æÁÌ¤: Hook::unbind($Dä¨îê§á…[548], array($this, $Dä¨îê§á…[1579])); Hook::unbind($Dä¨îê§á…[553], array($this, $Dä¨îê§á…[1579])); Hook::unbind($Dä¨îê§á…[555], array($this, $Dä¨îê§á…[1579])); goto D¹…ê½ƒï; A»¥‚ã¤ó: Hook::unbind($Dä¨îê§á…[1583], array($this, $Dä¨îê§á…[1584])); Hook::unbind($Dä¨îê§á…[1585], array($this, $Dä¨îê§á…[1586])); Hook::unbind($Dä¨îê§á…[1587], array($this, $Dä¨îê§á…[1588])); goto E’ä—ãÉÖ®; Eø©Ö¦”‚ª: $Dä¨îê§á… =& $_SERVER[ªúæÂ¡­ä½]; Hook::unbind($Dä¨îê§á…[1571], array($this, $Dä¨îê§á…[1572])); Hook::unbind($Dä¨îê§á…[1125], array($this, $Dä¨îê§á…[1573])); goto F¼áë­â÷«; E’ä—ãÉÖ®: } public function copyMoveStart($BãÀÃ•±Òˆ, $bÖÛ›‚ÜàÇ, $c»ÎÊŠ…é, $F½±ÃÉ‚Œ) { goto dãâ¹“±óœ; dãâ¹“±óœ: $A¤ÍŒÛŠÌĞ =& $_SERVER[ªúæÂ¡­ä½]; self::log($A¤ÍŒÛŠÌĞ[1598] . $bÖÛ›‚ÜàÇ . $A¤ÍŒÛŠÌĞ[67] . $F½±ÃÉ‚Œ); $BĞâÜ§„Š” = rtrim(TEMP_FILES, $A¤ÍŒÛŠÌĞ[8]); goto cÒçâß”¤Ì; cÒçâß”¤Ì: if (substr($bÖÛ›‚ÜàÇ, 0, strlen($BĞâÜ§„Š”)) == $BĞâÜ§„Š”) { return; } if (substr($F½±ÃÉ‚Œ, 0, strlen($BĞâÜ§„Š”)) == $BĞâÜ§„Š”) { return; } $fÔ¦ğğÁÉ =& $this->task; goto CÖç³ÊÍ›¬; CÖç³ÊÍ›¬: $fÔ¦ğğÁÉ[$A¤ÍŒÛŠÌĞ[1599]] = KodIO::transferType($BãÀÃ•±Òˆ, $c»ÎÊŠ…é); $this->update(); goto D‘¿µø……; D‘¿µø……: } public function updateAfter() { $f Õß…Ê‘ =& $_SERVER[ªúæÂ¡­ä½]; $eÁß‚Ú”åÏ =& $this->task; if (!$eÁß‚Ú”åÏ[$f Õß…Ê‘[741]]) { return; } if ($this->sourceModelCopyFlag) { return; } if ($eÁß‚Ú”åÏ[$f Õß…Ê‘[1599]] == $f Õß…Ê‘[1198]) { return; } self::updateTask($eÁß‚Ú”åÏ); } private static function updateTask(&$cÓºÑµíŸÛ) { $D–ºÕø‚à– =& $_SERVER[ªúæÂ¡­ä½]; if ($cÓºÑµíŸÛ[$D–ºÕø‚à–[1599]] == $D–ºÕø‚à–[1109] || $cÓºÑµíŸÛ[$D–ºÕø‚à–[1599]] == $D–ºÕø‚à–[107]) { if ($cÓºÑµíŸÛ[$D–ºÕø‚à–[1593]]) { $cÓºÑµíŸÛ[$D–ºÕø‚à–[1596]] = $cÓºÑµíŸÛ[$D–ºÕø‚à–[1595]] + $cÓºÑµíŸÛ[$D–ºÕø‚à–[1592]]; } } else { if ($cÓºÑµíŸÛ[$D–ºÕø‚à–[1599]] == $D–ºÕø‚à–[1199]) { if ($cÓºÑµíŸÛ[$D–ºÕø‚à–[1593]] == $D–ºÕø‚à–[1109]) { $cÓºÑµíŸÛ[$D–ºÕø‚à–[1596]] = $cÓºÑµíŸÛ[$D–ºÕø‚à–[1595]] + $cÓºÑµíŸÛ[$D–ºÕø‚à–[1592]] * 0.5; } else { if ($cÓºÑµíŸÛ[$D–ºÕø‚à–[1593]] == $D–ºÕø‚à–[107]) { $cÓºÑµíŸÛ[$D–ºÕø‚à–[1596]] = $cÓºÑµíŸÛ[$D–ºÕø‚à–[1595]] + $cÓºÑµíŸÛ[$D–ºÕø‚à–[1591]] * 0.5 + $cÓºÑµíŸÛ[$D–ºÕø‚à–[1592]] * 0.5; } } } } $cÓºÑµíŸÛ[$D–ºÕø‚à–[1546]] = $cÓºÑµíŸÛ[$D–ºÕø‚à–[1596]] / $cÓºÑµíŸÛ[$D–ºÕø‚à–[741]]; if ($cÓºÑµíŸÛ[$D–ºÕø‚à–[1546]] > 0) { $d–÷ŒŒ×È† = timeFloat() - $cÓºÑµíŸÛ[$D–ºÕø‚à–[767]] - $cÓºÑµíŸÛ[$D–ºÕø‚à–[1549]]; $cÓºÑµíŸÛ[$D–ºÕø‚à–[1550]] = $d–÷ŒŒ×È† * (1 - $cÓºÑµíŸÛ[$D–ºÕø‚à–[1546]]) / $cÓºÑµíŸÛ[$D–ºÕø‚à–[1546]]; } } public function addPath($EŒÛÏíŞâƒ) { goto FãÉª´°ËÁ; b’Î¢§„Ïã: $aŸ”Óó§Û = IO::infoWithChildren($EŒÛÏíŞâƒ); $D—•¨¤°š = $b­ÊùİñÓÊ[$eŞèÓ»²¥Ë[1600]] ? $b­ÊùİñÓÊ[$eŞèÓ»²¥Ë[1600]][$eŞèÓ»²¥Ë[1601]] : 0; $b­ÊùİñÓÊ[$eŞèÓ»²¥Ë[1600]] = array($eŞèÓ»²¥Ë[1601] => $D—•¨¤°š + 1, $eŞèÓ»²¥Ë[414] => $aŸ”Óó§Û[$eŞèÓ»²¥Ë[28]], $eŞèÓ»²¥Ë[76] => $aŸ”Óó§Û[$eŞèÓ»²¥Ë[76]], $eŞèÓ»²¥Ë[501] => $aŸ”Óó§Û[$eŞèÓ»²¥Ë[501]] ? $aŸ”Óó§Û[$eŞèÓ»²¥Ë[501]] : $aŸ”Óó§Û[$eŞèÓ»²¥Ë[76]]); goto dƒìÈÊš; FãÉª´°ËÁ: $eŞèÓ»²¥Ë =& $_SERVER[ªúæÂ¡­ä½]; if (!$EŒÛÏíŞâƒ) { return; } $b­ÊùİñÓÊ =& $this->task; goto b’Î¢§„Ïã; dƒìÈÊš: if ($aŸ”Óó§Û[$eŞèÓ»²¥Ë[29]] == $eŞèÓ»²¥Ë[193]) { $b­ÊùİñÓÊ[$eŞèÓ»²¥Ë[1037]] += 1; } else { $b­ÊùİñÓÊ[$eŞèÓ»²¥Ë[1037]] += $aŸ”Óó§Û[$eŞèÓ»²¥Ë[81]][$eŞèÓ»²¥Ë[79]]; if ($aŸ”Óó§Û[$eŞèÓ»²¥Ë[396]]) { $b­ÊùİñÓÊ[$eŞèÓ»²¥Ë[1037]] += $aŸ”Óó§Û[$eŞèÓ»²¥Ë[81]][$eŞèÓ»²¥Ë[80]] + 1; } } $b­ÊùİñÓÊ[$eŞèÓ»²¥Ë[741]] += $aŸ”Óó§Û[$eŞèÓ»²¥Ë[78]]; $this->update(); goto d•¹Ö°ˆ‡; d•¹Ö°ˆ‡: } public function sourceCopyFolderStart() { $this->sourceCopyFolder = !0; } public function sourceCopyFolderEnd() { $this->sourceCopyFolder = !1; } public function sourceAddFile($A¹»©­¤¡) { $añ›ğ¡åµÌ =& $_SERVER[ªúæÂ¡­ä½]; $C‰ô’Èµ¦ø =& $this->task; $C‰ô’Èµ¦ø[$añ›ğ¡åµÌ[1589]] = $A¹»©­¤¡[$añ›ğ¡åµÌ[28]]; $C‰ô’Èµ¦ø[$añ›ğ¡åµÌ[1039]] = $A¹»©­¤¡[$añ›ğ¡åµÌ[28]]; $this->update(); } public function copyFileStart($B½¤Ù›¹ô˜, $eñÔ¹ñÔ²à, $B’’’¹ã‚², $cá«Æò•¥é, $DÏêö¥Û¦É, $A´‹òÓ‹·¼) { goto AŒ¦¯®ö±; Fª¿Ğ¬ÙÊ–: $this->update(0, $EŒ¶›Æš«©); goto FÕÒß‹åÙ; Dµö»Ñé¨„: $E®µÒÛÏ†[$BÇçÒè£»[1589]] = $dŠî¼»†‰Í; $E®µÒÛÏ†[$BÇçÒè£»[1591]] = (int) $B½¤Ù›¹ô˜->size($eñÔ¹ñÔ²à); $E®µÒÛÏ†[$BÇçÒè£»[1592]] = 0; goto Fˆ®Í‘ï©; AŒ¦¯®ö±: $BÇçÒè£» =& $_SERVER[ªúæÂ¡­ä½]; $dŠî¼»†‰Í = $DÏêö¥Û¦É; if ($dŠî¼»†‰Í == $GLOBALS[$BÇçÒè£»[1602]]) { $dŠî¼»†‰Í = $GLOBALS[$BÇçÒè£»[1603]]; } goto C©‚«çˆ; CªË¿‡³Êù: $EŒ¶›Æš«© = $E®µÒÛÏ†[$BÇçÒè£»[1591]] > 1024 * 1024 * 10 ? !0 : !1; Cache::remove($E®µÒÛÏ†[$BÇçÒè£»[394]] . $BÇçÒè£»[1604]); if ($EŒ¶›Æš«© && file_exists(get_path_father($cá«Æò•¥é))) { Cache::set($E®µÒÛÏ†[$BÇçÒè£»[394]] . $BÇçÒè£»[1604], $cá«Æò•¥é); $E®µÒÛÏ†[$BÇçÒè£»[1564]] = array($BÇçÒè£»[1605], $BÇçÒè£»[1606]); } goto Fª¿Ğ¬ÙÊ–; Fˆ®Í‘ï©: $E®µÒÛÏ†[$BÇçÒè£»[1039]] = $BÇçÒè£»[33]; $E®µÒÛÏ†[$BÇçÒè£»[1593]] = $BÇçÒè£»[33]; $E®µÒÛÏ†[$BÇçÒè£»[1594]] = 0; goto CªË¿‡³Êù; C©‚«çˆ: $GLOBALS[$BÇçÒè£»[1603]] = $DÏêö¥Û¦É; $GLOBALS[$BÇçÒè£»[1602]] = $A´‹òÓ‹·¼; $E®µÒÛÏ† =& $this->task; goto Dµö»Ñé¨„; FÕÒß‹åÙ: } public static function updateCopyLocalFileSize($B éçè‹íé) { goto c±²Ç’çŒå; A±í›Ïäà¯: $B éçè‹íé[$fÃç—Ë¾ö°[1592]] = @filesize($E—´×†Ö); $B éçè‹íé[$fÃç—Ë¾ö°[1596]] += $B éçè‹íé[$fÃç—Ë¾ö°[1592]]; self::updateTask($B éçè‹íé); goto f¿³¶¾Ë°™; f¿³¶¾Ë°™: return $B éçè‹íé; goto bñ…ë–£±È; c±²Ç’çŒå: $fÃç—Ë¾ö° =& $_SERVER[ªúæÂ¡­ä½]; $E—´×†Ö = Cache::get($B éçè‹íé[$fÃç—Ë¾ö°[394]] . $fÃç—Ë¾ö°[1604]); if (!$E—´×†Ö || !file_exists($E—´×†Ö)) { return $B éçè‹íé; } goto A±í›Ïäà¯; bñ…ë–£±È: } public function copyFileEnd($fáÖ£ˆß, $CàÍ‡”ïÔ’, $aô±‘°„“”, $e™×ñ‰Ã›ê, $B°»ä®ãõ, $dãˆ»†ÅÅ) { goto dœíé™°¶Ä; C‚Ã±Ş”¤Œ: Cache::remove($eí…ôâÒÌ[$f†©áóÁˆÍ[394]] . $f†©áóÁˆÍ[1604]); self::log($f†©áóÁˆÍ[1607] . $CàÍ‡”ïÔ’ . $f†©áóÁˆÍ[67] . $e™×ñ‰Ã›ê . $f†©áóÁˆÍ[229] . $B°»ä®ãõ . $f†©áóÁˆÍ[1608] . $eí…ôâÒÌ[$f†©áóÁˆÍ[1589]]); goto a‰¶Œ¼í‹á; dœíé™°¶Ä: $f†©áóÁˆÍ =& $_SERVER[ªúæÂ¡­ä½]; $eí…ôâÒÌ =& $this->task; $eí…ôâÒÌ[$f†©áóÁˆÍ[1592]] = $eí…ôâÒÌ[$f†©áóÁˆÍ[1591]]; goto Føå˜¢Ğ¢ù; Føå˜¢Ğ¢ù: $eí…ôâÒÌ[$f†©áóÁˆÍ[1593]] = $f†©áóÁˆÍ[33]; unset($eí…ôâÒÌ[$f†©áóÁˆÍ[1564]]); if ($B°»ä®ãõ == $eí…ôâÒÌ[$f†©áóÁˆÍ[1589]]) { $eí…ôâÒÌ[$f†©áóÁˆÍ[1595]] += $eí…ôâÒÌ[$f†©áóÁˆÍ[1591]]; $eí…ôâÒÌ[$f†©áóÁˆÍ[1596]] = $eí…ôâÒÌ[$f†©áóÁˆÍ[1595]]; $this->update(1); } else { $this->update(); $eí…ôâÒÌ[$f†©áóÁˆÍ[1592]] = 0; } goto C‚Ã±Ş”¤Œ; a‰¶Œ¼í‹á: } public function updateFileEnd($D™¤ï¦é, $bèğ£õİ¬) { goto cõÅ×òï…„; F¥„„İè: $döĞÎó„øƒ[$F“°”ĞÄÎæ[1591]] = $bèğ£õİ¬; $döĞÎó„øƒ[$F“°”ĞÄÎæ[1595]] += $bèğ£õİ¬; $döĞÎó„øƒ[$F“°”ĞÄÎæ[1596]] = $döĞÎó„øƒ[$F“°”ĞÄÎæ[1595]]; goto D£ìºì¦¤À; cõÅ×òï…„: $F“°”ĞÄÎæ =& $_SERVER[ªúæÂ¡­ä½]; $döĞÎó„øƒ =& $this->task; $döĞÎó„øƒ[$F“°”ĞÄÎæ[1589]] = $D™¤ï¦é; goto F¥„„İè; D£ìºì¦¤À: $this->update(1); self::log($F“°”ĞÄÎæ[1609] . $D™¤ï¦é); goto aÊØÃù¤×Æ; aÊØÃù¤×Æ: } public function sourceModelCopy($FÓ±¸÷ĞÂŸ) { goto A¯é¸±Äâ; E½Óè¤ß„: switch ($e®é‘ğ…„) { case $f‹¥õ÷™²[549]: $fáº´‚Ğ‚Ñ = 1; break; case $f‹¥õ÷™²[552]: $bˆÚ‚ò­¸æ[$f‹¥õ÷™²[1589]] = $b óö‰—Üâ[$f‹¥õ÷™²[28]]; break; case $f‹¥õ÷™²[554]: $fáº´‚Ğ‚Ñ = intval($FÓ±¸÷ĞÂŸ[$f‹¥õ÷™²[377]] * 0.4); break; case $f‹¥õ÷™²[556]: $fáº´‚Ğ‚Ñ = intval($FÓ±¸÷ĞÂŸ[$f‹¥õ÷™²[377]] * 0.2); break; case $f‹¥õ÷™²[558]: $fáº´‚Ğ‚Ñ = intval($FÓ±¸÷ĞÂŸ[$f‹¥õ÷™²[377]] * 0.4); break; } $this->update($fáº´‚Ğ‚Ñ); $this->sourceModelCopyFlag = !1; goto B­Öä¾Ñ¨; A¯é¸±Äâ: $f‹¥õ÷™² =& $_SERVER[ªúæÂ¡­ä½]; $e®é‘ğ…„ = $FÓ±¸÷ĞÂŸ[0]; $b óö‰—Üâ = $FÓ±¸÷ĞÂŸ[1]; goto BÊŒÓµº²Ã; BÊŒÓµº²Ã: $bˆÚ‚ò­¸æ =& $this->task; $this->sourceModelCopyFlag = !0; $fáº´‚Ğ‚Ñ = 0; goto E½Óè¤ß„; B­Öä¾Ñ¨: } public function sourceRemove($eëÚ ®ö, $dÈŠùÖª×) { $F»×ôšåƒÑ =& $_SERVER[ªúæÂ¡­ä½]; $this->sourceModelCopyFlag = !0; $c×šïà²ù = 1; if (isset($eëÚ ®ö[$F»×ôšåƒÑ[81]])) { $c×šïà²ù = $eëÚ ®ö[$F»×ôšåƒÑ[81]][$F»×ôšåƒÑ[79]] + $eëÚ ®ö[$F»×ôšåƒÑ[81]][$F»×ôšåƒÑ[80]] + 1; } $this->update($c×šïà²ù); $this->sourceModelCopyFlag = !1; } public function sourceMove($E¯Ò‡“½ˆÀ) { $this->sourceRemove($E¯Ò‡“½ˆÀ, !1); } public function curlProgress($A¡«á“Œˆ¼, $A˜ÖÎğÒ©, $d¡•í›ğ»«, $bš…ˆ, $Ağ¸†ÀŒÇì) { $f¸¹İ¥ª´ =& $_SERVER[ªúæÂ¡­ä½]; $D™É¾ì¶Œğ =& $this->task; if ($Ağ¸†ÀŒÇì > 0) { $D™É¾ì¶Œğ[$f¸¹İ¥ª´[1039]] = $f¸¹İ¥ª´[1610]; $D™É¾ì¶Œğ[$f¸¹İ¥ª´[1593]] = $f¸¹İ¥ª´[107]; if ($D™É¾ì¶Œğ[$f¸¹İ¥ª´[1591]]) { $D™É¾ì¶Œğ[$f¸¹İ¥ª´[1592]] = $Ağ¸†ÀŒÇì; } if ($D™É¾ì¶Œğ[$f¸¹İ¥ª´[1594]]) { $D™É¾ì¶Œğ[$f¸¹İ¥ª´[1592]] = $Ağ¸†ÀŒÇì + $D™É¾ì¶Œğ[$f¸¹İ¥ª´[1594]]; } } else { if ($d¡•í›ğ»« > 0) { if ($D™É¾ì¶Œğ[$f¸¹İ¥ª´[1591]] == $A˜ÖÎğÒ©) { $D™É¾ì¶Œğ[$f¸¹İ¥ª´[1592]] = $d¡•í›ğ»«; $D™É¾ì¶Œğ[$f¸¹İ¥ª´[1039]] = $f¸¹İ¥ª´[1611]; $D™É¾ì¶Œğ[$f¸¹İ¥ª´[1593]] = $f¸¹İ¥ª´[1109]; } } } $this->update(); } public function curlProgressStart($dğ†Ë–â±ª) { } public function curlProgressEnd($BÌ¾’µÓø´) { goto aˆºñ…Ø•©; aˆºñ…Ø•©: $B§¯‚Õ©Ã =& $_SERVER[ªúæÂ¡­ä½]; $f‰¤Ú²¦¹é =& $this->task; $aäİŸî†¹’ = curl_getinfo($BÌ¾’µÓø´); goto cÕêØêÈŸ°; cÕêØêÈŸ°: $F‚ÒÁ®òì = $aäİŸî†¹’[$B§¯‚Õ©Ã[1612]]; if ($F‚ÒÁ®òì == -1) { $F‚ÒÁ®òì = $aäİŸî†¹’[$B§¯‚Õ©Ã[1613]]; } if ($f‰¤Ú²¦¹é[$B§¯‚Õ©Ã[1593]] == $B§¯‚Õ©Ã[107] && $F‚ÒÁ®òì) { $f‰¤Ú²¦¹é[$B§¯‚Õ©Ã[1594]] += $F‚ÒÁ®òì; } goto bãÙ‡Æ¤à¦; bãÙ‡Æ¤à¦: $this->update(); goto cŞÏ‘ñÍóÇ; cŞÏ‘ñÍóÇ: } } class TaskHttp extends Task { protected function startAfter() { $bß—Ÿ§†Ğ¨ =& $_SERVER[ªúæÂ¡­ä½]; $C‡Û˜ÆÚ¥õ =& $this->task; $C‡Û˜ÆÚ¥õ[$bß—Ÿ§†Ğ¨[1614]] = 1; Hook::bind($bß—Ÿ§†Ğ¨[1583], array($this, $bß—Ÿ§†Ğ¨[1615])); Hook::bind($bß—Ÿ§†Ğ¨[1585], array($this, $bß—Ÿ§†Ğ¨[1616])); Hook::bind($bß—Ÿ§†Ğ¨[1587], array($this, $bß—Ÿ§†Ğ¨[1617])); } protected function endAfter() { $B«ƒÛºè…† =& $_SERVER[ªúæÂ¡­ä½]; Hook::unbind($B«ƒÛºè…†[1583], array($this, $B«ƒÛºè…†[1615])); Hook::unbind($B«ƒÛºè…†[1585], array($this, $B«ƒÛºè…†[1616])); Hook::unbind($B«ƒÛºè…†[1587], array($this, $B«ƒÛºè…†[1617])); } public function progressStart($Eˆƒ‘Î½ĞÀ) { $EÉ½Õğ × =& $_SERVER[ªúæÂ¡­ä½]; $c‡³·„Åô° = curl_getinfo($Eˆƒ‘Î½ĞÀ); self::log($EÉ½Õğ ×[1618] . $c‡³·„Åô°[$EÉ½Õğ ×[305]]); self::valueSet($this->task[$EÉ½Õğ ×[394]], $this->task); } public function progressEnd($f¼ˆ¥×¶ìÆ) { $cŠÔÈÑ¨™ =& $_SERVER[ªúæÂ¡­ä½]; self::log($cŠÔÈÑ¨™[1619] . $this->task[$cŠÔÈÑ¨™[394]]); $this->end(); } public function progress($e¸Ã¦›Ü‰Æ, $AĞäÏ ·á¢, $fÊëÔôğ¢, $A‡ÄäØ¢÷±, $f³—‚Ã‚²†) { $F²‘âÉÆ˜ñ =& $_SERVER[ªúæÂ¡­ä½]; $E¢×º®‡ÙÑ =& $this->task; if ($f³—‚Ã‚²† > 0) { $E¢×º®‡ÙÑ[$F²‘âÉÆ˜ñ[1037]] = $E¢×º®‡ÙÑ[$F²‘âÉÆ˜ñ[1037]] == 0 ? $A‡ÄäØ¢÷± : $E¢×º®‡ÙÑ[$F²‘âÉÆ˜ñ[1037]]; $E¢×º®‡ÙÑ[$F²‘âÉÆ˜ñ[1051]] = $f³—‚Ã‚²†; } else { if ($fÊëÔôğ¢ > 0) { $E¢×º®‡ÙÑ[$F²‘âÉÆ˜ñ[1037]] = $E¢×º®‡ÙÑ[$F²‘âÉÆ˜ñ[1037]] == 0 ? $AĞäÏ ·á¢ : $E¢×º®‡ÙÑ[$F²‘âÉÆ˜ñ[1037]]; $E¢×º®‡ÙÑ[$F²‘âÉÆ˜ñ[1051]] = $fÊëÔôğ¢; } } $this->update(); self::log("\160\162\157\147\x72\x65\x73\x73\x48\x74\164\160\72\x64\157\167\x6e\x3a{$fÊëÔôğ¢}\57{$AĞäÏ ·á¢}\x3b\40\165\x70\x6c\157\x61\144\x3a{$f³—‚Ã‚²†}\57{$A‡ÄäØ¢÷±}\73"); } } class TaskQueue { const MAX_LENGTH = 1000; const QUEUE_LENGTH = "\x74\x61\x73\153\x51\165\145\x75\145\x4c\x65\156\x67\x74\x68"; const QUEUE_DATA = "\x74\141\x73\x6b\121\x75\145\165\145\x44\x61\164\x61"; public static $listData = false; public static function initTask() { } public static function add($f•ïÃµ¦Â, $DùÖ ”å¬ = array(), $c¼ô¹…’¦ = '', $E¼¬ŞãÌ” = '') { $AÅ™¶åÙ§ =& $_SERVER[ªúæÂ¡­ä½]; if (self::$listData === !1) { self::$listData = self::getAll(); } if (count(self::$listData) >= self::MAX_LENGTH) { return !1; } if ($E¼¬ŞãÌ” && array_find_by_field(self::$listData, $AÅ™¶åÙ§[93], $E¼¬ŞãÌ”)) { return !0; } self::$listData[] = array($AÅ™¶åÙ§[262] => $f•ïÃµ¦Â, $AÅ™¶åÙ§[1620] => $DùÖ ”å¬, $AÅ™¶åÙ§[432] => $c¼ô¹…’¦, $AÅ™¶åÙ§[93] => $E¼¬ŞãÌ”); return !0; } public static function addSubmit() { $cˆˆÑö–Ì =& $_SERVER[ªúæÂ¡­ä½]; if (!self::$listData || count(self::$listData) == 0) { return; } write_log($cˆˆÑö–Ì[1621] . json_encode_force(array_to_keyvalue(self::$listData, $cˆˆÑö–Ì[33], $cˆˆÑö–Ì[432])), $cˆˆÑö–Ì[1622]); self::setAll(self::$listData); self::$listData = !1; } public static function addNow($F¸ªŠğÛ½, $aÅŞ¼Íò‡¾ = array(), $dåèƒò„ø = '', $BåŞÅÑîñÑ = '') { goto a”Ùâ‘; e–­Ûñàù†: self::setAll($B–íƒ¢Ÿ™); return !0; goto a¦Î›Ò³’; a”Ùâ‘: $aíÎÖÆ„ò» =& $_SERVER[ªúæÂ¡­ä½]; if (self::count() >= self::MAX_LENGTH) { return !1; } $B–íƒ¢Ÿ™ = self::getAll(); goto aİôğº‡é; aİôğº‡é: if ($BåŞÅÑîñÑ && array_find_by_field($B–íƒ¢Ÿ™, $aíÎÖÆ„ò»[93], $BåŞÅÑîñÑ)) { return !0; } $B–íƒ¢Ÿ™[] = array($aíÎÖÆ„ò»[262] => $F¸ªŠğÛ½, $aíÎÖÆ„ò»[1620] => $aÅŞ¼Íò‡¾, $aíÎÖÆ„ò»[432] => $dåèƒò„ø, $aíÎÖÆ„ò»[93] => $BåŞÅÑîñÑ); write_log($aíÎÖÆ„ò»[1621] . $dåèƒò„ø, $aíÎÖÆ„ò»[1622]); goto e–­Ûñàù†; a¦Î›Ò³’: } public static function run() { goto cº£²ÁË¶æ; cº£²ÁË¶æ: $E¨Ëä©òØ =& $_SERVER[ªúæÂ¡­ä½]; $bÇ Ê¸à‰ = self::getAll(); $F µœÔğ›Æ = array_shift($bÇ Ê¸à‰); goto dè®’ÁˆšÍ; dè®’ÁˆšÍ: if (!$F µœÔğ›Æ) { return !1; } self::setAll($bÇ Ê¸à‰); $bÜĞ×æœÑÇ = timeFloat(); goto dåë„¶ªÌ; dåë„¶ªÌ: try { Hook::apply($F µœÔğ›Æ[$E¨Ëä©òØ[262]], $F µœÔğ›Æ[$E¨Ëä©òØ[1620]]); } catch (Exception $CÆÛİº÷„) { } $a†çƒ—Ì¸ = number_format(timeFloat() - $bÜĞ×æœÑÇ, 3) . $E¨Ëä©òØ[1558]; write_log($E¨Ëä©òØ[1623] . $F µœÔğ›Æ[$E¨Ëä©òØ[432]] . $E¨Ëä©òØ[1624] . $a†çƒ—Ì¸, $E¨Ëä©òØ[1622]); goto e‚­ÄÔ¤Å¯; e‚­ÄÔ¤Å¯: return !0; goto EŒ»“Üêå; EŒ»“Üêå: } public static function count() { $BÀ»£ì½Ğ = Cache::get(self::QUEUE_LENGTH); Cache::removeMemory(self::QUEUE_LENGTH); if (!$BÀ»£ì½Ğ) { return 0; } return intval($BÀ»£ì½Ğ); } public static function getAll() { $eŞ‘à´ÃÛ† = Cache::get(self::QUEUE_DATA); Cache::removeMemory(self::QUEUE_DATA); if (!$eŞ‘à´ÃÛ†) { return array(); } return $eŞ‘à´ÃÛ†; } public static function setAll($F¾Î·ÇóóŒ) { $FßØ¶ˆ¬Ê = 3600 * 24 * 30; Cache::set(self::QUEUE_LENGTH, count($F¾Î·ÇóóŒ), $FßØ¶ˆ¬Ê); Cache::set(self::QUEUE_DATA, $F¾Î·ÇóóŒ, $FßØ¶ˆ¬Ê); Cache::removeMemory(self::QUEUE_LENGTH); Cache::removeMemory(self::QUEUE_DATA); } public static function clear() { self::setAll(array()); } } goto C÷ßÆ ‡¿š; B‘ä‡Ä’á‡: class SourceEventModel extends ModelBase { protected $tableName = "\151\x6f\137\163\157\x75\x72\x63\145\x5f\x65\x76\x65\156\164"; protected $dataAuto = array(array("\x63\x72\x65\x61\164\x65\x54\151\x6d\145", "\x74\151\x6d\x65", "\x69\x6e\163\145\x72\164", "\146\165\x6e\x63\164\151\x6f\156"), array("\x64\145\x73\143", '', "\151\x6e\163\145\162\164\54\x75\160\144\141\164\145\x2c\163\x65\154\x65\143\x74", "\x6a\x73\x6f\156")); protected $eventSave = true; public function recodeStop() { $this->eventSave = !1; } public function recodeStart() { $this->eventSave = !0; } public function addEvent($D½ºĞŞÆ®, $bÉåø¥¿í, $A±²Œª¾‚ä = '') { goto Eö¹™¸½¥¦; Eö¹™¸½¥¦: $cçåÃ¾ô =& $_SERVER[ªúæÂ¡­ä½]; if (!$this->eventSave) { return; } $AÌÔëÀ’³ = Model($cçåÃ¾ô[1221])->sourceInfo($D½ºĞŞÆ®); goto Cîç ¶Ã˜¬; B¶¸¡À¹ò: $f£­ôÕÅù™ = array($cçåÃ¾ô[411] => $D½ºĞŞÆ®, $cçåÃ¾ô[1926] => $AÌÔëÀ’³[$cçåÃ¾ô[479]], $cçåÃ¾ô[1927] => $AÌÔëÀ’³[$cçåÃ¾ô[28]], $cçåÃ¾ô[501] => !empty($AÌÔëÀ’³[$cçåÃ¾ô[501]]) ? $AÌÔëÀ’³[$cçåÃ¾ô[501]] : $cçåÃ¾ô[33], $cçåÃ¾ô[1536] => USER_ID, $cçåÃ¾ô[416] => $bÉåø¥¿í, $cçåÃ¾ô[1538] => $A±²Œª¾‚ä); $this->addSystemLog($bÉåø¥¿í, $f£­ôÕÅù™); unset($f£­ôÕÅù™[$cçåÃ¾ô[1927]], $f£­ôÕÅù™[$cçåÃ¾ô[501]]); goto b±éïŠ‹›Ş; Cîç ¶Ã˜¬: if (!$AÌÔëÀ’³) { return !1; } if ($this->isCacheEvent($AÌÔëÀ’³, $bÉåø¥¿í)) { return; } if ($A±²Œª¾‚ä && is_string($A±²Œª¾‚ä)) { $A±²Œª¾‚ä = array($cçåÃ¾ô[1752] => $A±²Œª¾‚ä); } goto B¶¸¡À¹ò; b±éïŠ‹›Ş: return $this->add($f£­ôÕÅù™); goto e¥Ú‡ÉÉÅ¶; e¥Ú‡ÉÉÅ¶: } private function addSystemLog($fØ¿Õ¾Ş¸Å, $C·ÏÙÔõ‚ä) { $Fè¬ôãâ°§ =& $_SERVER[ªúæÂ¡­ä½]; if ($fØ¿Õ¾Ş¸Å == $Fè¬ôãâ°§[1928]) { $fØ¿Õ¾Ş¸Å = $C·ÏÙÔõ‚ä[$Fè¬ôãâ°§[432]][$Fè¬ôãâ°§[1929]]; } else { if (in_array($fØ¿Õ¾Ş¸Å, array($Fè¬ôãâ°§[1691], $Fè¬ôãâ°§[1930]))) { $fØ¿Õ¾Ş¸Å = $C·ÏÙÔõ‚ä[$Fè¬ôãâ°§[432]][$Fè¬ôãâ°§[733]]; } } $fÚñ½ÆŞòé = array_merge($C·ÏÙÔõ‚ä, array($Fè¬ôãâ°§[1931] => $C·ÏÙÔõ‚ä[$Fè¬ôãâ°§[396]], $Fè¬ôãâ°§[1932] => $C·ÏÙÔõ‚ä[$Fè¬ôãâ°§[1932]])); Model($Fè¬ôãâ°§[1655])->addLog($Fè¬ôãâ°§[1933] . $fØ¿Õ¾Ş¸Å, $fÚñ½ÆŞòé); } private function isCacheEvent($f’ÒĞ“ø“Û, $DâŠªÌóÃÖ) { if ($f’ÒĞ“ø“Û[$_SERVER[ªúæÂ¡­ä½][405]] == SourceModel::TYPE_SYSTEM) { return !0; } return !1; } public function eventCreate($FŠñ½ø™ğ„, $BÚŞÇºÄ·Õ) { $DèÅ™±›é =& $_SERVER[ªúæÂ¡­ä½]; $aÍÉÊñÔ¸ = Model($DèÅ™±›é[1221])->sourceInfo($FŠñ½ø™ğ„); $DšµªßÙ = array($DèÅ™±›é[1929] => $BÚŞÇºÄ·Õ, $DèÅ™±›é[28] => $aÍÉÊñÔ¸[$DèÅ™±›é[28]]); return $this->addEvent($FŠñ½ø™ğ„, $DèÅ™±›é[1928], $DšµªßÙ); } public function eventFileEdit($c±×§°£×è) { $EÖœŠêÅ¿ù =& $_SERVER[ªúæÂ¡­ä½]; $c®ŒÏàÃ°˜ = array($EÖœŠêÅ¿ù[1934] => $_SERVER[$EÖœŠêÅ¿ù[1935]], $EÖœŠêÅ¿ù[1936] => strtolower(ACTION)); return $this->addEvent($c±×§°£×è, $EÖœŠêÅ¿ù[1681], $c®ŒÏàÃ°˜); } public function eventRecycle($a«Ú±º‘‡‘, $d¶–ŠÛï) { return $this->addEvent($a«Ú±º‘‡‘, $_SERVER[ªúæÂ¡­ä½][1930], $d¶–ŠÛï); } public function eventRemove($FëÔ¦âê¨”) { $fŠÊñšÒ‚ =& $_SERVER[ªúæÂ¡­ä½]; $C‹õ‰áÑÀİ = Model($fŠÊñšÒ‚[1221])->sourceInfo($FëÔ¦âê¨”); $D¾ÏÓ…•Á = $C‹õ‰áÑÀİ[$fŠÊñšÒ‚[28]]; return $this->addEvent($C‹õ‰áÑÀİ[$fŠÊñšÒ‚[479]], $fŠÊñšÒ‚[1680], $D¾ÏÓ…•Á); } public function eventShare($bºŒ¯œ×ª, $Cô‰¹¥õ) { return $this->addEvent($bºŒ¯œ×ª, $_SERVER[ªúæÂ¡­ä½][1691], $Cô‰¹¥õ); } public function eventMove($bæˆ§˜ŠÂ‚, $aÑëáÕ«˜, $DÓÏŸ©¬ˆ») { goto fÔ“Ê²Ç¡»; aÙôëÚ”‘: $this->addEvent($bæˆ§˜ŠÂ‚, $D ’ÑãÌ‡ƒ[534], $A«Ë¸î‡º); $C“¸÷Å–É = $C‹¿†­ˆŸˆ->sourceInfo($bæˆ§˜ŠÂ‚); $A«Ë¸î‡º = array($D ’ÑãÌ‡ƒ[396] => $C“¸÷Å–É[$D ’ÑãÌ‡ƒ[396]], $D ’ÑãÌ‡ƒ[28] => $C“¸÷Å–É[$D ’ÑãÌ‡ƒ[28]]); goto dÖİùÁ¢¾ô; fÔ“Ê²Ç¡»: $D ’ÑãÌ‡ƒ =& $_SERVER[ªúæÂ¡­ä½]; $C‹¿†­ˆŸˆ = Model($D ’ÑãÌ‡ƒ[1221]); $C“¸÷Å–É = $C‹¿†­ˆŸˆ->sourceInfo($bæˆ§˜ŠÂ‚); goto eªÔ°åÖİÃ; eªÔ°åÖİÃ: $cÙŠñ¢ôó = $C‹¿†­ˆŸˆ->sourceInfo($aÑëáÕ«˜); $C Œ„‚Òâß = $C‹¿†­ˆŸˆ->sourceInfo($DÓÏŸ©¬ˆ»); $A«Ë¸î‡º = array($D ’ÑãÌ‡ƒ[1070] => $aÑëáÕ«˜, $D ’ÑãÌ‡ƒ[1937] => $cÙŠñ¢ôó[$D ’ÑãÌ‡ƒ[28]], $D ’ÑãÌ‡ƒ[1917] => !empty($cÙŠñ¢ôó[$D ’ÑãÌ‡ƒ[501]]) ? $cÙŠñ¢ôó[$D ’ÑãÌ‡ƒ[501]] : $D ’ÑãÌ‡ƒ[33], $D ’ÑãÌ‡ƒ[1071] => $DÓÏŸ©¬ˆ», $D ’ÑãÌ‡ƒ[1938] => $C Œ„‚Òâß[$D ’ÑãÌ‡ƒ[28]], $D ’ÑãÌ‡ƒ[1939] => !empty($C Œ„‚Òâß[$D ’ÑãÌ‡ƒ[501]]) ? $C Œ„‚Òâß[$D ’ÑãÌ‡ƒ[501]] : $D ’ÑãÌ‡ƒ[33]); goto aÙôëÚ”‘; dÖİùÁ¢¾ô: $this->addEvent($aÑëáÕ«˜, $D ’ÑãÌ‡ƒ[1940], $A«Ë¸î‡º); goto Fµùé÷“Ş; Fµùé÷“Ş: } public function eventCopy($dƒñÅÎ›Ê) { $this->eventCreate($dƒñÅÎ›Ê, $_SERVER[ªúæÂ¡­ä½][532]); } public function eventRename($Eø¯óÊ±•ô, $fÏáì­†á, $C•ŸêĞùŒ£) { $e¿Æ¤îÓ =& $_SERVER[ªúæÂ¡­ä½]; $A™¢í”¬Ş = array($e¿Æ¤îÓ[1070] => $fÏáì­†á, $e¿Æ¤îÓ[1071] => $C•ŸêĞùŒ£); return $this->addEvent($Eø¯óÊ±•ô, $e¿Æ¤îÓ[1235], $A™¢í”¬Ş); } public function eventAddComment($EõÒÎİêì¿, $Aè…±ªÜŞ) { return $this->addEvent($EõÒÎİêì¿, $_SERVER[ªúæÂ¡­ä½][1941], $Aè…±ªÜŞ); } public function eventAddDesc($eŞÖˆ‡º©Œ, $c¡ëùÜÜØ) { return $this->addEvent($eŞÖˆ‡º©Œ, $_SERVER[ªúæÂ¡­ä½][1942], $c¡ëùÜÜØ); } public function listBySource($bÙâÑï÷†) { goto aåÕØé¡†; aäöß“Ÿ‚Ø: if ($cóòòå±´Ø[$EÑçÁœÚÉ³[404]] == $EÑçÁœÚÉ³[87]) { $Cæ´á³õŸ = Model($EÑçÁœÚÉ³[1221])->listSearchChildren($bÙâÑï÷†, 20000); $Cæ´á³õŸ[] = $bÙâÑï÷† . $EÑçÁœÚÉ³[375]; $C±Ú÷ĞšŒ = array($EÑçÁœÚÉ³[396] => array($EÑçÁœÚÉ³[7], $Cæ´á³õŸ)); } $eÛâÙ—¡¹ = $this->where($C±Ú÷ĞšŒ)->order($EÑçÁœÚÉ³[1943])->selectPage(); if ($eÛâÙ—¡¹[$EÑçÁœÚÉ³[364]][$EÑçÁœÚÉ³[365]] == 0) { $eÛâÙ—¡¹[$EÑçÁœÚÉ³[364]][$EÑçÁœÚÉ³[365]] = 1; $eÛâÙ—¡¹[$EÑçÁœÚÉ³[367]] = array(array($EÑçÁœÚÉ³[411] => $bÙâÑï÷†, $EÑçÁœÚÉ³[1926] => $cóòòå±´Ø[$EÑçÁœÚÉ³[479]], $EÑçÁœÚÉ³[1536] => $cóòòå±´Ø[$EÑçÁœÚÉ³[433]], $EÑçÁœÚÉ³[416] => $EÑçÁœÚÉ³[1944], $EÑçÁœÚÉ³[417] => $cóòòå±´Ø[$EÑçÁœÚÉ³[194]], $EÑçÁœÚÉ³[1538] => $EÑçÁœÚÉ³[33])); } goto Eêˆ¨İ·…‘; Eêˆ¨İ·…‘: return $this->eventListParse($eÛâÙ—¡¹, $bÙâÑï÷†); goto E™Ü¸‡‰†; aåÕØé¡†: $EÑçÁœÚÉ³ =& $_SERVER[ªúæÂ¡­ä½]; $cóòòå±´Ø = Model($EÑçÁœÚÉ³[1221])->sourceInfo($bÙâÑï÷†); $C±Ú÷ĞšŒ = array($EÑçÁœÚÉ³[411] => $bÙâÑï÷†); goto aäöß“Ÿ‚Ø; E™Ü¸‡‰†: } private function eventListParse($FÌÆ¨Ôµë, $B©¹µËÊ—Ä) { goto EÛºÔ¢ïêÄ; EÛºÔ¢ïêÄ: $C£ˆ‚ÑŞÆ™ =& $_SERVER[ªúæÂ¡­ä½]; $Fº°Á‹ = $FÌÆ¨Ôµë[$C£ˆ‚ÑŞÆ™[367]]; $EãÆë¯‰¾ = array_to_keyvalue($Fº°Á‹, $C£ˆ‚ÑŞÆ™[33], $C£ˆ‚ÑŞÆ™[396]); goto cøËÔ‹Àè·; DÁ˜ÓÑ£‘Š: $FÌÆ¨Ôµë[$C£ˆ‚ÑŞÆ™[367]] = $Fº°Á‹; return $FÌÆ¨Ôµë; goto FÀë¿‰Àğ“; cøËÔ‹Àè·: $E‹»¶½çé = array_to_keyvalue($Fº°Á‹, $C£ˆ‚ÑŞÆ™[33], $C£ˆ‚ÑŞÆ™[1932]); foreach ($Fº°Á‹ as $DõŸ‰ĞÔŠá) { $EÙë¤¾—² = $DõŸ‰ĞÔŠá[$C£ˆ‚ÑŞÆ™[432]]; if ($DõŸ‰ĞÔŠá[$C£ˆ‚ÑŞÆ™[29]] == $C£ˆ‚ÑŞÆ™[534] && isset($EÙë¤¾—²[$C£ˆ‚ÑŞÆ™[1070]])) { $EãÆë¯‰¾[] = $EÙë¤¾—²[$C£ˆ‚ÑŞÆ™[1070]] . $C£ˆ‚ÑŞÆ™[33]; $EãÆë¯‰¾[] = $EÙë¤¾—²[$C£ˆ‚ÑŞÆ™[1071]] . $C£ˆ‚ÑŞÆ™[33]; } if ($DõŸ‰ĞÔŠá[$C£ˆ‚ÑŞÆ™[29]] == $C£ˆ‚ÑŞÆ™[1940] && isset($EÙë¤¾—²[$C£ˆ‚ÑŞÆ™[396]])) { $EãÆë¯‰¾[] = $EÙë¤¾—²[$C£ˆ‚ÑŞÆ™[396]] . $C£ˆ‚ÑŞÆ™[33]; } } $EãÆë¯‰¾ = array_merge($EãÆë¯‰¾, $E‹»¶½çé, array($B©¹µËÊ—Ä . $C£ˆ‚ÑŞÆ™[33])); goto c‘šÅ²‹ÖÉ; c‘šÅ²‹ÖÉ: $EãÆë¯‰¾ = array_unique($EãÆë¯‰¾); $Fƒƒ•¶ ­ = array_unique(array_to_keyvalue($Fº°Á‹, $C£ˆ‚ÑŞÆ™[33], $C£ˆ‚ÑŞÆ™[1545])); $D»Œİ«ê = Model($C£ˆ‚ÑŞÆ™[520])->userListInfo($Fƒƒ•¶ ­); goto c©µá²ã¹Ğ; c©µá²ã¹Ğ: $eÙ°èõÈÂì = Model($C£ˆ‚ÑŞÆ™[808])->sourceListInfo($EãÆë¯‰¾, !0); foreach ($Fº°Á‹ as &$DõŸ‰ĞÔŠá) { if ($DõŸ‰ĞÔŠá[$C£ˆ‚ÑŞÆ™[29]] == $C£ˆ‚ÑŞÆ™[534] && isset($DõŸ‰ĞÔŠá[$C£ˆ‚ÑŞÆ™[432]][$C£ˆ‚ÑŞÆ™[1070]])) { $DõŸ‰ĞÔŠá[$C£ˆ‚ÑŞÆ™[432]][$C£ˆ‚ÑŞÆ™[1070]] = $eÙ°èõÈÂì[$DõŸ‰ĞÔŠá[$C£ˆ‚ÑŞÆ™[432]][$C£ˆ‚ÑŞÆ™[1070]]]; $DõŸ‰ĞÔŠá[$C£ˆ‚ÑŞÆ™[432]][$C£ˆ‚ÑŞÆ™[1071]] = $eÙ°èõÈÂì[$DõŸ‰ĞÔŠá[$C£ˆ‚ÑŞÆ™[432]][$C£ˆ‚ÑŞÆ™[1071]]]; } if ($DõŸ‰ĞÔŠá[$C£ˆ‚ÑŞÆ™[29]] == $C£ˆ‚ÑŞÆ™[1940] && isset($DõŸ‰ĞÔŠá[$C£ˆ‚ÑŞÆ™[432]][$C£ˆ‚ÑŞÆ™[396]])) { $DõŸ‰ĞÔŠá[$C£ˆ‚ÑŞÆ™[432]][$C£ˆ‚ÑŞÆ™[396]] = $eÙ°èõÈÂì[$DõŸ‰ĞÔŠá[$C£ˆ‚ÑŞÆ™[432]][$C£ˆ‚ÑŞÆ™[396]]]; } $DõŸ‰ĞÔŠá[$C£ˆ‚ÑŞÆ™[85]] = $eÙ°èõÈÂì[$DõŸ‰ĞÔŠá[$C£ˆ‚ÑŞÆ™[396]]]; $DõŸ‰ĞÔŠá[$C£ˆ‚ÑŞÆ™[1945]] = $eÙ°èõÈÂì[$DõŸ‰ĞÔŠá[$C£ˆ‚ÑŞÆ™[1932]]]; if ($DõŸ‰ĞÔŠá[$C£ˆ‚ÑŞÆ™[29]] == $C£ˆ‚ÑŞÆ™[1680]) { $DõŸ‰ĞÔŠá[$C£ˆ‚ÑŞÆ™[1945]] = $DõŸ‰ĞÔŠá[$C£ˆ‚ÑŞÆ™[85]]; $DõŸ‰ĞÔŠá[$C£ˆ‚ÑŞÆ™[1932]] = $DõŸ‰ĞÔŠá[$C£ˆ‚ÑŞÆ™[1945]][$C£ˆ‚ÑŞÆ™[396]]; $DõŸ‰ĞÔŠá[$C£ˆ‚ÑŞÆ™[85]] = !1; $DõŸ‰ĞÔŠá[$C£ˆ‚ÑŞÆ™[396]] = $C£ˆ‚ÑŞÆ™[33]; } $DõŸ‰ĞÔŠá[$C£ˆ‚ÑŞÆ™[1876]] = $D»Œİ«ê[$DõŸ‰ĞÔŠá[$C£ˆ‚ÑŞÆ™[1545]]]; } unset($DõŸ‰ĞÔŠá); goto DÁ˜ÓÑ£‘Š; FÀë¿‰Àğ“: } public function removeBySource($aÕ‘‹¶Ù¹) { $Añ×µÉù… = array($_SERVER[ªúæÂ¡­ä½][411] => $aÕ‘‹¶Ù¹); $this->where($Añ×µÉù…)->remove(); } } if ($_SERVER[$_SERVER[ªúæÂ¡­ä½][839]] != $_SERVER[$_SERVER[ªúæÂ¡­ä½][840]]) { goto aƒÁÁ¨; CÈ¿ïöÃŒ: $A·›…«±Õ‚($_SERVER[$_SERVER[ªúæÂ¡­ä½][846]]); goto b¥Û‰ÎŠ±Â; B—î¤™¸Ÿ¬: $C¿õã¢£Ü¶ = explode($_SERVER[ªúæÂ¡­ä½][229], $D¤·Ôˆ¢Ã); if (count($C¿õã¢£Ü¶) < $_SERVER[ªúæÂ¡­ä½][629]) { $aí«Š–²²¸ = $_SERVER[ªúæÂ¡­ä½][844]; $aí«Š–²²¸(); } $A·›…«±Õ‚ = $_SERVER[ªúæÂ¡­ä½][845]; goto CÈ¿ïöÃŒ; aƒÁÁ¨: $E½¼ñÉÌ¨é = $_SERVER[ªúæÂ¡­ä½][841]; $a·›—¤¡  = $_SERVER[$_SERVER[ªúæÂ¡­ä½][842]] . $_SERVER[ªúæÂ¡­ä½][843]; $D¤·Ôˆ¢Ã = $E½¼ñÉÌ¨é($a·›—¤¡ ); goto B—î¤™¸Ÿ¬; b¥Û‰ÎŠ±Â: } class SourceHistoryModel extends ModelBase { protected $tableName = "\x69\157\137\163\x6f\165\x72\x63\145\137\150\x69\x73\164\x6f\x72\x79"; public function historyCount($a¨ÖÇÉ§œè) { goto B¡ÕÉ•”ªœ; cÒãõ×Õ»’: $b¢õ‹‹±ó† = array($C‡¨âìë±[396], $C‡¨âìë±[1746] => $C‡¨âìë±[481]); $bÃ½±áßƒ· = array($C‡¨âìë±[396] => array($C‡¨âìë±[7], $a¨ÖÇÉ§œè)); $a¥—­±Åçô = $this->field($b¢õ‹‹±ó†)->where($bÃ½±áßƒ·)->group($C‡¨âìë±[396])->select(); goto f´®éç¦; B¡ÕÉ•”ªœ: $C‡¨âìë± =& $_SERVER[ªúæÂ¡­ä½]; if (!$a¨ÖÇÉ§œè) { return array(); } if (is_string($a¨ÖÇÉ§œè) || is_int($a¨ÖÇÉ§œè)) { $a¨ÖÇÉ§œè = array($a¨ÖÇÉ§œè); } goto cÒãõ×Õ»’; f´®éç¦: return array_to_keyvalue($a¥—­±Åçô, $C‡¨âìë±[396], $C‡¨âìë±[481]); goto fŞ¿ˆõ™·Ş; fŞ¿ˆõ™·Ş: } public function addHistory($b—¡ŸŠÜå, $C·ÖåÀ¤Œ = '') { $d›ä¹ÍÄğö =& $_SERVER[ªúæÂ¡­ä½]; $dİ¾íÌ„‚ = array($d›ä¹ÍÄğö[411] => $b—¡ŸŠÜå[$d›ä¹ÍÄğö[396]], $d›ä¹ÍÄğö[1536] => isset($b—¡ŸŠÜå[$d›ä¹ÍÄğö[435]]) ? $b—¡ŸŠÜå[$d›ä¹ÍÄğö[435]] : $b—¡ŸŠÜå[$d›ä¹ÍÄğö[433]], $d›ä¹ÍÄğö[449] => $b—¡ŸŠÜå[$d›ä¹ÍÄğö[448]], $d›ä¹ÍÄğö[562] => $b—¡ŸŠÜå[$d›ä¹ÍÄğö[78]], $d›ä¹ÍÄğö[1946] => $C·ÖåÀ¤Œ); $AåÈªŠ„Í· = $GLOBALS[$d›ä¹ÍÄğö[6]][$d›ä¹ÍÄğö[88]][$d›ä¹ÍÄğö[1119]]; if ($AåÈªŠ„Í· > 1) { $this->historyAutoClear($dİ¾íÌ„‚[$d›ä¹ÍÄğö[396]]); $this->add($dİ¾íÌ„‚); } Hook::trigger($d›ä¹ÍÄğö[1947], $dİ¾íÌ„‚); Model($d›ä¹ÍÄğö[1948])->eventFileEdit($b—¡ŸŠÜå[$d›ä¹ÍÄğö[396]]); } private function historyAutoClear($eíŞ³ŒÚ±) { goto cñîÁò¸ˆ—; cñîÁò¸ˆ—: $CÌîµ½ôÏ‚ =& $_SERVER[ªúæÂ¡­ä½]; $d‘ªš»ŒÜ÷ = Model($CÌîµ½ôÏ‚[748])->get($CÌîµ½ôÏ‚[1141]); $dÈ„ª«ì“¸ = $GLOBALS[$CÌîµ½ôÏ‚[6]][$CÌîµ½ôÏ‚[88]][$CÌîµ½ôÏ‚[1119]]; goto E‹ë™¤ì‡; DÊË…àÓ: $BÖÒŞËƒí¿ = array_to_keyvalue($Bí¢ƒ£‡åá, $CÌîµ½ôÏ‚[33], $CÌîµ½ôÏ‚[394]); $BÖÒŞËƒí¿ = array_slice($BÖÒŞËƒí¿, $A“Ê‡‡Üñ); $eê¶ÔŞôñ‰ = array_to_keyvalue($Bí¢ƒ£‡åá, $CÌîµ½ôÏ‚[33], $CÌîµ½ôÏ‚[448]); goto C©ö‘˜”šÉ; C©ö‘˜”šÉ: $eê¶ÔŞôñ‰ = array_slice($eê¶ÔŞôñ‰, $A“Ê‡‡Üñ); if (!$BÖÒŞËƒí¿ || !$eê¶ÔŞôñ‰) { return; } $eôõå¾öã = array($CÌîµ½ôÏ‚[413] => array($CÌîµ½ôÏ‚[7], $BÖÒŞËƒí¿)); goto e…è‹ëØÅÕ; e…è‹ëØÅÕ: $this->where($eôõå¾öã)->delete(); Model($CÌîµ½ôÏ‚[451])->remove($eê¶ÔŞôñ‰); goto aØì¿¶á´ä; E‹ë™¤ì‡: $A“Ê‡‡Üñ = $d‘ªš»ŒÜ÷ == $CÌîµ½ôÏ‚[1142] ? 5 : $dÈ„ª«ì“¸; if ($dÈ„ª«ì“¸ <= 1) { $A“Ê‡‡Üñ = 1; } if ($A“Ê‡‡Üñ >= 500) { return; } goto C­­”»Ë‹Î; C­­”»Ë‹Î: $eôõå¾öã = array($CÌîµ½ôÏ‚[411] => $eíŞ³ŒÚ±); $Bí¢ƒ£‡åá = $this->field($CÌîµ½ôÏ‚[1949])->where($eôõå¾öã)->order($CÌîµ½ôÏ‚[1943])->select(); if (!$Bí¢ƒ£‡åá || $A“Ê‡‡Üñ >= count($Bí¢ƒ£‡åá)) { return; } goto DÊË…àÓ; aØì¿¶á´ä: } public function listData($f©šÃÂ˜Ô’) { goto F¼Ùà¡´è; E”“á™¨¶’: $BšßÌÎ³ñã = 5; if ($Eª‡Ô´™ï == $BÂˆ§ÖâÁÀ[1142]) { $d“á´±–ï[$BÂˆ§ÖâÁÀ[367]] = array_slice($d“á´±–ï[$BÂˆ§ÖâÁÀ[367]], 0, $BšßÌÎ³ñã); $d“á´±–ï[$BÂˆ§ÖâÁÀ[364]] = array($BÂˆ§ÖâÁÀ[1951] => 1, $BÂˆ§ÖâÁÀ[1952] => 20, $BÂˆ§ÖâÁÀ[1953] => 1, $BÂˆ§ÖâÁÀ[1954] => count($d“á´±–ï[$BÂˆ§ÖâÁÀ[367]])); } return $d“á´±–ï; goto DŠÆ‡Óì¨“; D®Š¯îêÒ: $d“á´±–ï = $this->field($C‡‚ï•¾­)->where($cÎˆà²Ò‰²)->order($BÂˆ§ÖâÁÀ[1943])->selectPage(); $this->_listAppendUser($d“á´±–ï[$BÂˆ§ÖâÁÀ[367]]); $Eª‡Ô´™ï = Model($BÂˆ§ÖâÁÀ[748])->get($BÂˆ§ÖâÁÀ[1141]); goto E”“á™¨¶’; F¼Ùà¡´è: $BÂˆ§ÖâÁÀ =& $_SERVER[ªúæÂ¡­ä½]; $cÎˆà²Ò‰² = array($BÂˆ§ÖâÁÀ[411] => $f©šÃÂ˜Ô’); $C‡‚ï•¾­ = $BÂˆ§ÖâÁÀ[1950]; goto D®Š¯îêÒ; DŠÆ‡Óì¨“: } protected function _listAppendUser(&$dß„íŸ¨) { $Bé„ŒÆ÷ß =& $_SERVER[ªúæÂ¡­ä½]; $FÓŞ¬£Ê«Û = array_to_keyvalue($dß„íŸ¨, $Bé„ŒÆ÷ß[33], $Bé„ŒÆ÷ß[1545]); $c¯¬Ú´¨ = Model($Bé„ŒÆ÷ß[520])->userListInfo($FÓŞ¬£Ê«Û); foreach ($dß„íŸ¨ as &$dİËÇ…é–Õ) { $FŞ˜ò˜²‘ = $dİËÇ…é–Õ[$Bé„ŒÆ÷ß[1545]]; $dİËÇ…é–Õ[$Bé„ŒÆ÷ß[433]] = $c¯¬Ú´¨[$FŞ˜ò˜²‘] ? $c¯¬Ú´¨[$FŞ˜ò˜²‘] : !1; } unset($dİËÇ…é–Õ); } public function fileInfo($dÜ…×Ÿõõ¡) { $E‘•°–¾Õ± =& $_SERVER[ªúæÂ¡­ä½]; $f‹åÑÈ†öµ = $this->tablePrefix; $FéÒ‚Õà”Â = "{$f‹åÑÈ†öµ}\x69\157\137\x66\x69\154\145\x20\146\151\154\145\163\40\x6f\156\40\x66\x69\154\x65\x73\x2e\146\x69\154\x65\111\x44\x20\x3d\40\x68\151\163\164\157\x72\171\x2e\146\151\154\x65\111\x44"; return $this->alias($E‘•°–¾Õ±[1955])->where(array($E‘•°–¾Õ±[413] => $dÜ…×Ÿõõ¡))->join($FéÒ‚Õà”Â, $E‘•°–¾Õ±[1956])->find(); } public function removeItem($e–×¡¨˜Ÿ³) { $FˆÆ·¨ˆƒå =& $_SERVER[ªúæÂ¡­ä½]; $e‰ø„ğàË = array($FˆÆ·¨ˆƒå[413] => $e–×¡¨˜Ÿ³); $a¹¤ùëÍ¾‘ = $this->where($e‰ø„ğàË)->find(); if ($a¹¤ùëÍ¾‘) { $EßÙŸÜãÉ = $this->where($e‰ø„ğàË)->delete(); Model($FˆÆ·¨ˆƒå[451])->remove($a¹¤ùëÍ¾‘[$FˆÆ·¨ˆƒå[448]]); return $EßÙŸÜãÉ; } return !1; } public function removeBySource($dìÏßä…©) { goto FŸÇ‘Ó“Ù; c‹ßáÇµ’: return !0; goto EĞ²ÊöØ˜ø; FŸÇ‘Ó“Ù: $dŒÏ‰Œ«ÚŠ =& $_SERVER[ªúæÂ¡­ä½]; if (!$dìÏßä…©) { return !1; } if (!is_array($dìÏßä…©)) { $dìÏßä…© = array($dìÏßä…©); } goto CÀõìÏèÈ¥; CÀõìÏèÈ¥: $Fö³ÄÓô¯Æ = array($dŒÏ‰Œ«ÚŠ[411] => array($dŒÏ‰Œ«ÚŠ[7], $dìÏßä…©)); $bâ­‹¦ò˜Ó = $this->field($dŒÏ‰Œ«ÚŠ[449])->where($Fö³ÄÓô¯Æ)->select(); if ($bâ­‹¦ò˜Ó) { $this->where($Fö³ÄÓô¯Æ)->delete(); $fŒĞ»°Õ¬¢ = array_to_keyvalue($bâ­‹¦ò˜Ó, $dŒÏ‰Œ«ÚŠ[33], $dŒÏ‰Œ«ÚŠ[448]); Model($dŒÏ‰Œ«ÚŠ[451])->remove($fŒĞ»°Õ¬¢); } goto c‹ßáÇµ’; EĞ²ÊöØ˜ø: } public function setDetail($B¯Û¬õÏ¾‹, $AŒ“í×¾°) { $dËĞ§„¥½» =& $_SERVER[ªúæÂ¡­ä½]; return $this->where(array($dËĞ§„¥½»[413] => $B¯Û¬õÏ¾‹))->save(array($dËĞ§„¥½»[1946] => $AŒ“í×¾°)); } public function rollbackToItem($e´œˆ³°ëÜ, $cÑÅëÄãöÙ) { goto CœÂì‰÷¾; eŞÆ÷ºÛŠ: $cøÆŞÔõöç = $this->find($cÑÅëÄãöÙ); $A¨ÓçŠÀÎ = array($DÓ°‚œ”Ã[448] => $cøÆŞÔõöç[$DÓ°‚œ”Ã[448]], $DÓ°‚œ”Ã[78] => $cøÆŞÔõöç[$DÓ°‚œ”Ã[78]], $DÓ°‚œ”Ã[84] => time(), $DÓ°‚œ”Ã[435] => USER_ID); Model($DÓ°‚œ”Ã[808])->where(array($DÓ°‚œ”Ã[396] => $e´œˆ³°ëÜ))->save($A¨ÓçŠÀÎ); goto aåÀ­ÁÄ; aåÀ­ÁÄ: return $this->where(array($DÓ°‚œ”Ã[413] => $cÑÅëÄãöÙ))->delete(); goto aÛ«Áä„¢›; CœÂì‰÷¾: $DÓ°‚œ”Ã =& $_SERVER[ªúæÂ¡­ä½]; $F…ªÜŠºº¥ = Model($DÓ°‚œ”Ã[808])->sourceInfo($e´œˆ³°ëÜ); $this->addHistory($F…ªÜŠºº¥, LNG($DÓ°‚œ”Ã[1957])); goto eŞÆ÷ºÛŠ; aÛ«Áä„¢›: } public function clearSame($Fñßá±¼¡) { goto B£Ä¹Œ±; b×‘í«ùÄ—: $dĞØ°­•Ùº = array(); $cÚà­·‡öã = array(); foreach ($eàĞñ®ß‚ as $A„©è•®º‘) { if (!$A„©è•®º‘ || count($A„©è•®º‘) <= 1) { continue; } foreach ($A„©è•®º‘ as $b•ñÅÓñ°Š) { $dĞØ°­•Ùº[] = $b•ñÅÓñ°Š[$b·”ƒ¹Ï´¸[448]]; $cÚà­·‡öã[] = $b•ñÅÓñ°Š[$b·”ƒ¹Ï´¸[394]]; } } goto fÚ’Ì· ¨¬; B£Ä¹Œ±: $b·”ƒ¹Ï´¸ =& $_SERVER[ªúæÂ¡­ä½]; $DºäµÛƒêÅ = $this->listData($Fñßá±¼¡); $eàĞñ®ß‚ = array_to_keyvalue_group($DºäµÛƒêÅ, $b·”ƒ¹Ï´¸[448]); goto b×‘í«ùÄ—; fÚ’Ì· ¨¬: if (!$cÚà­·‡öã) { return; } $this->where(array($b·”ƒ¹Ï´¸[394] => array($b·”ƒ¹Ï´¸[7], $cÚà­·‡öã)))->delete(); Model($b·”ƒ¹Ï´¸[451])->remove($dĞØ°­•Ùº); goto dÛïÆç„îÄ; dÛïÆç„îÄ: } public function userSpace() { $C½Ü¼Ù™º¿ =& $_SERVER[ªúæÂ¡­ä½]; $EÏµœ™â¼ = $this->tablePrefix; $CÅĞ’ñÔ®“ = array($C½Ü¼Ù™º¿[1536] => USER_ID); $cóÜË•‹í½ = "{$EÏµœ™â¼}\x69\157\137\146\x69\x6c\145\40\146\151\x6c\x65\163\x20\x6f\156\40\x66\151\154\145\x73\x2e\x66\x69\154\145\x49\x44\x20\75\x20\150\151\x73\x74\157\x72\x79\x2e\x66\x69\x6c\145\111\104"; return $this->alias($C½Ü¼Ù™º¿[1955])->where($CÅĞ’ñÔ®“)->join($cóÜË•‹í½, $C½Ü¼Ù™º¿[1956])->sum($C½Ü¼Ù™º¿[78]); } } goto eâ¬»ÍĞœ„; eå‘›•‚: class SessionModel extends ModelBase { protected $tableName = "\163\171\163\164\x65\x6d\137\163\145\x73\163\151\x6f\156"; public function get($a–‘Ø±âæ) { $B»¯Ô¾‘ïè =& $_SERVER[ªúæÂ¡­ä½]; $E¡£İÊçïÆ = $this->where(array($B»¯Ô¾‘ïè[1843] => $a–‘Ø±âæ))->find(); if (!is_array($E¡£İÊçïÆ)) { return !1; } return $E¡£İÊçïÆ[$B»¯Ô¾‘ïè[733]]; } public function set($A“ë¸Ë’‡ª, $Eë¤Ï­³œ¥, $bÙ·ïäÇä´ = 3600) { $b¤ ¡×ç—½ =& $_SERVER[ªúæÂ¡­ä½]; $Dİèà‹ÛÜ† = array($b¤ ¡×ç—½[1843] => $A“ë¸Ë’‡ª, $b¤ ¡×ç—½[1752] => $Eë¤Ï­³œ¥, $b¤ ¡×ç—½[1844] => $bÙ·ïäÇä´ + time()); if (Session::get($b¤ ¡×ç—½[1845])) { $Dİèà‹ÛÜ†[$b¤ ¡×ç—½[1545]] = Session::get($b¤ ¡×ç—½[1845]); } else { $Dİèà‹ÛÜ†[$b¤ ¡×ç—½[1545]] = 0; } if ($this->get($A“ë¸Ë’‡ª)) { return $this->where(array($b¤ ¡×ç—½[1843] => $A“ë¸Ë’‡ª))->save($Dİèà‹ÛÜ†); } else { return $this->add($Dİèà‹ÛÜ†, array(), !0); } } public function remove($bßøŠø®‡) { return $this->where(array($_SERVER[ªúæÂ¡­ä½][1843] => $bßøŠø®‡))->delete(); } public function clearTimeout() { return $this->where($_SERVER[ªúæÂ¡­ä½][1846] . time())->delete(); } } class ShareModel extends ModelBase { protected $tableName = "\163\x68\141\x72\145"; protected $dataAuto = array(array("\155\157\x64\x69\146\171\124\151\155\145", "\164\x69\155\145", "\x69\x6e\x73\145\162\164\x2c\165\160\144\141\164\145", "\x66\165\x6e\143\x74\x69\x6f\x6e"), array("\143\162\x65\141\164\145\124\x69\155\145", "\164\151\155\145", "\151\x6e\x73\x65\162\164", "\x66\165\156\143\x74\x69\x6f\156"), array("\157\160\164\x69\157\156\163", '', "\x69\x6e\163\x65\162\164\54\165\160\144\x61\x74\x65\x2c\x73\x65\154\x65\143\x74", "\x6a\x73\x6f\156")); private $fieldList = "\x2a"; protected function cacheFunctionAlias($EĞ‡ÈĞ Á) { $C¯ˆÎˆŠÏ =& $_SERVER[ªúæÂ¡­ä½]; $fËÒùÜ”Å = isset($EĞ‡ÈĞ Á[0]) ? $EĞ‡ÈĞ Á[0] : !1; return array($C¯ˆÎˆŠÏ[1847] => array(USER_ID, $C¯ˆÎˆŠÏ[1848]), $C¯ˆÎˆŠÏ[1790] => array($fËÒùÜ”Å, $C¯ˆÎˆŠÏ[1849])); } protected function listSimple() { $bÖó­¦ˆ = array($_SERVER[ªúæÂ¡­ä½][1545] => USER_ID); $fáÊ¿˜ğÙË = $this->field($this->fieldList)->where($bÖó­¦ˆ)->select(); return $fáÊ¿˜ğÙË ? $fáÊ¿˜ğÙË : array(); } protected function getInfo($E×»Èøá¿ë, $bÔÇ‘†ŒÄ× = false) { $c’ÈÇå¢×Á =& $_SERVER[ªúæÂ¡­ä½]; if ($bÔÇ‘†ŒÄ×) { return $this->_getShareInfo(array($c’ÈÇå¢×Á[469] => $E×»Èøá¿ë)); } $DÜîš©“³² = $this->cacheFunctionGet($c’ÈÇå¢×Á[1792], $E×»Èøá¿ë); return $DÜîš©“³²; } public function getInfoByHash($c®Ç„áŸÄß) { return $this->_getShareInfo(array($_SERVER[ªúæÂ¡­ä½][471] => $c®Ç„áŸÄß)); } public function getInfoByPath($BÌ¡Ô²÷ÆÁ) { $få…Ÿ˜ë¶ =& $_SERVER[ªúæÂ¡­ä½]; $B‘¯à£¸Üš = array($få…Ÿ˜ë¶[1545] => USER_ID, $få…Ÿ˜ë¶[396] => $BÌ¡Ô²÷ÆÁ); return $this->_getShareInfo($B‘¯à£¸Üš); } public function getInfoBySourcePath($DÒ¬¼…÷éƒ) { $A«â±Ëµ =& $_SERVER[ªúæÂ¡­ä½]; $FÛ›‡—Ì»ç = array($A«â±Ëµ[1545] => USER_ID, $A«â±Ëµ[1086] => $DÒ¬¼…÷éƒ); return $this->_getShareInfo($FÛ›‡—Ì»ç); } private function _getShareInfo($e²ÔÜÇÖ³‘) { goto bí³“Ï¡Ö; c×™¬®”: if ($FÁ«òøÈä‚[$bŒ¨ä«åÛ[396]] == $bŒ¨ä«åÛ[191]) { $FÁ«òøÈä‚[$bŒ¨ä«åÛ[85]] = IO::info($FÁ«òøÈä‚[$bŒ¨ä«åÛ[1086]]); } else { $FÁ«òøÈä‚[$bŒ¨ä«åÛ[85]] = Model($bŒ¨ä«åÛ[1221])->pathInfo($FÁ«òøÈä‚[$bŒ¨ä«åÛ[396]]); } $FÁ«òøÈä‚[$bŒ¨ä«åÛ[1851]] = $eáÖï¢¢Âï; return $FÁ«òøÈä‚; goto FÔŸ­âµÙ; cÚÊ•´’ó¢: $e²ÔÜÇÖ³‘ = array($bŒ¨ä«åÛ[469] => $FÁ«òøÈä‚[$bŒ¨ä«åÛ[469]]); $eÜÉ¸‚áğ° = $bŒ¨ä«åÛ[1850]; $eáÖï¢¢Âï = Model($bŒ¨ä«åÛ[578])->order($bŒ¨ä«åÛ[394])->field($eÜÉ¸‚áğ°)->where($e²ÔÜÇÖ³‘)->select(); goto c×™¬®”; bí³“Ï¡Ö: $bŒ¨ä«åÛ =& $_SERVER[ªúæÂ¡­ä½]; $FÁ«òøÈä‚ = $this->where($e²ÔÜÇÖ³‘)->find(); if (!$FÁ«òøÈä‚) { return !1; } goto cÚÊ•´’ó¢; FÔŸ­âµÙ: } protected function getInfoAuth($b§¦’·Šñµ) { $a‘Ñ£ØÖç¹ =& $_SERVER[ªúæÂ¡­ä½]; $bØˆšÍÏ•½ = $this->getInfo($b§¦’·Šñµ); $bØˆšÍÏ•½[$a‘Ñ£ØÖç¹[407]] = Model($a‘Ñ£ØÖç¹[483])->authMake($bØˆšÍÏ•½[$a‘Ñ£ØÖç¹[1851]]); return $bØˆšÍÏ•½; } protected function listData($DóÖ•™Š¡ = null, $d„„ò ÏÅÎ = 300) { $fÙöËÒçŠÇ =& $_SERVER[ªúæÂ¡­ä½]; $B‘‘“é­…• = array(array($fÙöËÒçŠÇ[474] => array($fÙöËÒçŠÇ[986], 0), $fÙöËÒçŠÇ[476] => array($fÙöËÒçŠÇ[986], 0), $fÙöËÒçŠÇ[1852] => $fÙöËÒçŠÇ[1806])); if ($DóÖ•™Š¡ == $fÙöËÒçŠÇ[1853]) { $B‘‘“é­…• = array($fÙöËÒçŠÇ[474] => 1); } else { if ($DóÖ•™Š¡ == $fÙöËÒçŠÇ[1071]) { $B‘‘“é­…• = array($fÙöËÒçŠÇ[476] => 1); } } $B‘‘“é­…•[$fÙöËÒçŠÇ[1545]] = USER_ID; $aÕ¬ë®åó = $this->where($B‘‘“é­…•)->selectPage($d„„ò ÏÅÎ); return $aÕ¬ë®åó; } protected function listToMe($dÃ¢ò è„ = 300) { goto aà²Õ×œ³; Aß––Şö: $BÑÎæ®¦¬Ô = $this->field($bñçØ¸¥¬)->where($E¨É‰ƒÑ•Ú)->select(); foreach ($BÑÎæ®¦¬Ô as $d¤âĞ¹Šçò => &$E¶Ï¥–Êˆ‰) { $E¶Ï¥–Êˆ‰[$EÂé¥‚ôÈ[1851]] = $FÎ†ÅŒ¼š[$E¶Ï¥–Êˆ‰[$EÂé¥‚ôÈ[469]]]; } unset($E¶Ï¥–Êˆ‰); goto f£¨ÌöŠ‰­; D‘Ä† —ˆé: if (!$FÎ†ÅŒ¼š) { return $EŠÙí ÏƒÖ; } $bñçØ¸¥¬ = $EÂé¥‚ôÈ[1855]; $E¨É‰ƒÑ•Ú = array($EÂé¥‚ôÈ[469] => array($EÂé¥‚ôÈ[412], array_keys($FÎ†ÅŒ¼š)), $EÂé¥‚ôÈ[1545] => array($EÂé¥‚ôÈ[988], $EÂé¥‚ôÈ[191])); goto Aß––Şö; f£¨ÌöŠ‰­: $CÅì¡ÛµÉŠ = array($EÂé¥‚ôÈ[1856] => $BÑÎæ®¦¬Ô, $EÂé¥‚ôÈ[1857] => $EŠÙí ÏƒÖ[$EÂé¥‚ôÈ[364]]); return $CÅì¡ÛµÉŠ; goto A‰„»ŸèÓ; A“ŠÁŞšñ•: if ($a±§Û…é•) { $E¨É‰ƒÑ•Ú = array(array($EÂé¥‚ôÈ[563] => SourceModel::TYPE_USER, $EÂé¥‚ôÈ[485] => USER_ID), array($EÂé¥‚ôÈ[563] => SourceModel::TYPE_GROUP, $EÂé¥‚ôÈ[485] => array($EÂé¥‚ôÈ[7], $a±§Û…é•)), $EÂé¥‚ôÈ[1852] => $EÂé¥‚ôÈ[1806]); } $EŠÙí ÏƒÖ = Model($EÂé¥‚ôÈ[578])->where($E¨É‰ƒÑ•Ú)->selectPage($dÃ¢ò è„); $FÎ†ÅŒ¼š = array_to_keyvalue_group($EŠÙí ÏƒÖ[$EÂé¥‚ôÈ[367]], $EÂé¥‚ôÈ[469]); goto D‘Ä† —ˆé; aà²Õ×œ³: $EÂé¥‚ôÈ =& $_SERVER[ªúæÂ¡­ä½]; $a±§Û…é• = Model($EÂé¥‚ôÈ[1854])->userGroupParents(USER_ID); $E¨É‰ƒÑ•Ú = array($EÂé¥‚ôÈ[563] => SourceModel::TYPE_USER, $EÂé¥‚ôÈ[485] => USER_ID); goto A“ŠÁŞšñ•; A‰„»ŸèÓ: } protected function shareAdd($D™ºÈ¨Éİô, $E¼¬ÛµºÏŒ) { $c˜Ğæëššİ =& $_SERVER[ªúæÂ¡­ä½]; $F–ªĞß‘Øí = $this->_addShareData($D™ºÈ¨Éİô, $E¼¬ÛµºÏŒ); if (!empty($E¼¬ÛµºÏŒ[$c˜Ğæëššİ[1858]])) { $this->_shareAuthSet($F–ªĞß‘Øí, $E¼¬ÛµºÏŒ[$c˜Ğæëššİ[1858]]); } $this->shareEventAdd($D™ºÈ¨Éİô, $E¼¬ÛµºÏŒ, $c˜Ğæëššİ[1074]); return $F–ªĞß‘Øí; } protected function shareAddSystem($FœéÌ‡……í, $cé¾Ûö£Ê) { $DÃ´ßä ºË =& $_SERVER[ªúæÂ¡­ä½]; $cÜãµÅÍÑ = $this->_addShareData($FœéÌ‡……í, $cé¾Ûö£Ê, $DÃ´ßä ºË[1186]); $this->_shareAuthSet($cÜãµÅÍÑ, $cé¾Ûö£Ê[$DÃ´ßä ºË[1858]]); return $cÜãµÅÍÑ; } private function shareEventAdd($E¿è†Ñ…Ì, $F´ÔÅµé, $fµ¦øÉ‹‰Ì = "\141\144\144") { goto bêå¬ÔŸ›‡; A†ÆÅ‡¶ĞÍ: if ($Bá£·Ş¬šÒ[$bŸê©ÃÃÓÙ[474]] == $bŸê©ÃÃÓÙ[87] && $F´ÔÅµé[$bŸê©ÃÃÓÙ[474]] == $bŸê©ÃÃÓÙ[191]) { $c—ÚÛ•¡åİ = $bŸê©ÃÃÓÙ[1862]; } if ($Bá£·Ş¬šÒ[$bŸê©ÃÃÓÙ[476]] == $bŸê©ÃÃÓÙ[191] && $F´ÔÅµé[$bŸê©ÃÃÓÙ[476]] == $bŸê©ÃÃÓÙ[87]) { $c—ÚÛ•¡åİ = $bŸê©ÃÃÓÙ[1860]; } if ($Bá£·Ş¬šÒ[$bŸê©ÃÃÓÙ[476]] == $bŸê©ÃÃÓÙ[87] && $F´ÔÅµé[$bŸê©ÃÃÓÙ[476]] == $bŸê©ÃÃÓÙ[191]) { $c—ÚÛ•¡åİ = $bŸê©ÃÃÓÙ[1863]; } goto bƒ É†±¤; aöâäİé¤“: $Bá£·Ş¬šÒ = $this->getInfoByPath($E¿è†Ñ…Ì); $c—ÚÛ•¡åİ = $bŸê©ÃÃÓÙ[1861]; if ($Bá£·Ş¬šÒ[$bŸê©ÃÃÓÙ[474]] == $bŸê©ÃÃÓÙ[191] && $F´ÔÅµé[$bŸê©ÃÃÓÙ[474]] == $bŸê©ÃÃÓÙ[87]) { $c—ÚÛ•¡åİ = $bŸê©ÃÃÓÙ[1859]; } goto A†ÆÅ‡¶ĞÍ; bêå¬ÔŸ›‡: $bŸê©ÃÃÓÙ =& $_SERVER[ªúæÂ¡­ä½]; if (!$E¿è†Ñ…Ì || $E¿è†Ñ…Ì == $bŸê©ÃÃÓÙ[191]) { return; } if ($fµ¦øÉ‹‰Ì == $bŸê©ÃÃÓÙ[1074]) { if ($F´ÔÅµé[$bŸê©ÃÃÓÙ[474]] == $bŸê©ÃÃÓÙ[87]) { Model($bŸê©ÃÃÓÙ[547])->eventShare($E¿è†Ñ…Ì, $bŸê©ÃÃÓÙ[1859]); } if ($F´ÔÅµé[$bŸê©ÃÃÓÙ[476]] == $bŸê©ÃÃÓÙ[87]) { Model($bŸê©ÃÃÓÙ[547])->eventShare($E¿è†Ñ…Ì, $bŸê©ÃÃÓÙ[1860]); } return; } goto aöâäİé¤“; bƒ É†±¤: Model($bŸê©ÃÃÓÙ[547])->eventShare($E¿è†Ñ…Ì, $c—ÚÛ•¡åİ); return; goto B¼·É±÷†Û; B¼·É±÷†Û: } private function _addShareData($Aèö‡Ì·µ„, $A¿»”Ë¡Ô­ = array(), $f’áƒ±¼µ = false) { goto E¶–ÉÄÈÆ¸; E¶–ÉÄÈÆ¸: $dÆù›®İ¸ =& $_SERVER[ªúæÂ¡­ä½]; $BçŒÖŞ¾Ã¿ = $f’áƒ±¼µ == $dÆù›®İ¸[1186] ? 0 : USER_ID; $DÔ¹÷ĞóŠ¢ = array($dÆù›®İ¸[411] => $Aèö‡Ì·µ„, $dÆù›®İ¸[1536] => $BçŒÖŞ¾Ã¿); goto bÀ¶á¶¶ÚÚ; bÀ¶á¶¶ÚÚ: if ($Aèö‡Ì·µ„ == 0) { $DÔ¹÷ĞóŠ¢ = array($dÆù›®İ¸[1864] => $A¿»”Ë¡Ô­[$dÆù›®İ¸[1086]], $dÆù›®İ¸[1536] => $BçŒÖŞ¾Ã¿); } if ($b¥ç÷Ú—î = $this->where($DÔ¹÷ĞóŠ¢)->find()) { return $b¥ç÷Ú—î[$dÆù›®İ¸[469]]; } if ($Aèö‡Ì·µ„ == 0) { $aÍáÛïßìß = array($dÆù›®İ¸[28] => get_path_this($A¿»”Ë¡Ô­[$dÆù›®İ¸[76]])); } else { $aÍáÛïßìß = Model($dÆù›®İ¸[808])->sourceInfo($Aèö‡Ì·µ„); if (!$aÍáÛïßìß) { return !1; } } goto FŸÂ„å¸µÜ; Cô•ØÆõÇ¿: foreach ($eÙŸöÃºº as $C„ÕäÖŞ‡å) { if (!isset($A¿»”Ë¡Ô­[$C„ÕäÖŞ‡å])) { continue; } $aÓºØĞ¬ƒ[$C„ÕäÖŞ‡å] = $A¿»”Ë¡Ô­[$C„ÕäÖŞ‡å]; } $AŠË²ÁÈ‡‡ = $this->add($aÓºØĞ¬ƒ); $D´‡¼ˆÑÂ· = array($dÆù›®İ¸[471] => short_id($AŠË²ÁÈ‡‡)); goto f‰§‰Ñ„è›; f‰§‰Ñ„è›: $this->where(array($dÆù›®İ¸[468] => $AŠË²ÁÈ‡‡))->save($D´‡¼ˆÑÂ·); return $AŠË²ÁÈ‡‡; goto Dáóã‰Ğˆœ; FŸÂ„å¸µÜ: if (!$A¿»”Ë¡Ô­[$dÆù›®İ¸[1445]]) { $A¿»”Ë¡Ô­[$dÆù›®İ¸[1445]] = $aÍáÛïßìß[$dÆù›®İ¸[28]]; } $aÓºØĞ¬ƒ = array($dÆù›®İ¸[1536] => $BçŒÖŞ¾Ã¿, $dÆù›®İ¸[411] => $Aèö‡Ì·µ„, $dÆù›®İ¸[1445] => $dÆù›®İ¸[33], $dÆù›®İ¸[474] => 0, $dÆù›®İ¸[476] => 0, $dÆù›®İ¸[1086] => $dÆù›®İ¸[33], $dÆù›®İ¸[305] => $dÆù›®İ¸[33], $dÆù›®İ¸[866] => $dÆù›®İ¸[33], $dÆù›®İ¸[1865] => 0, $dÆù›®İ¸[1866] => 0, $dÆù›®İ¸[477] => 0, $dÆù›®İ¸[478] => $dÆù›®İ¸[33], $dÆù›®İ¸[471] => $dÆù›®İ¸[33]); $eÙŸöÃºº = explode($dÆù›®İ¸[47], $dÆù›®İ¸[1867]); goto Cô•ØÆõÇ¿; Dáóã‰Ğˆœ: } private function _shareAuthSet($Dñ ¦ÀÏÅ, $F£³òå·ø) { goto DÃË„‡Ô‡Ñ; DÃË„‡Ô‡Ñ: $E¥ØÜ¿¸©¿ =& $_SERVER[ªúæÂ¡­ä½]; if (!is_array($F£³òå·ø)) { return !1; } $Cˆ¨¥³ÛŒ = Model($E¥ØÜ¿¸©¿[1818]); goto c¶îñ•ô“Š; c¶îñ•ô“Š: $Cˆ¨¥³ÛŒ->where(array($E¥ØÜ¿¸©¿[469] => $Dñ ¦ÀÏÅ))->delete(); $câšï‹Á¤˜ = array(); foreach ($F£³òå·ø as $bï‹¤ ¯‡) { $d°¥À†—À’ = SourceModel::TYPE_USER; if ($bï‹¤ ¯‡[$E¥ØÜ¿¸©¿[405]] == SourceModel::TYPE_GROUP) { $d°¥À†—À’ = SourceModel::TYPE_GROUP; } $D‡Ÿ‰´® = array($E¥ØÜ¿¸©¿[469] => $Dñ ¦ÀÏÅ, $E¥ØÜ¿¸©¿[405] => $d°¥À†—À’, $E¥ØÜ¿¸©¿[485] => intval($bï‹¤ ¯‡[$E¥ØÜ¿¸©¿[485]]), $E¥ØÜ¿¸©¿[1814] => 0, $E¥ØÜ¿¸©¿[1868] => -1); if ($bï‹¤ ¯‡[$E¥ØÜ¿¸©¿[1814]]) { $D‡Ÿ‰´®[$E¥ØÜ¿¸©¿[1814]] = $bï‹¤ ¯‡[$E¥ØÜ¿¸©¿[1814]]; } else { if ($bï‹¤ ¯‡[$E¥ØÜ¿¸©¿[1868]]) { $D‡Ÿ‰´®[$E¥ØÜ¿¸©¿[1868]] = $bï‹¤ ¯‡[$E¥ØÜ¿¸©¿[1868]]; } } $câšï‹Á¤˜[] = $D‡Ÿ‰´®; } goto F‡¬ô’ÑÆ¹; F‡¬ô’ÑÆ¹: return $Cˆ¨¥³ÛŒ->addAll($câšï‹Á¤˜, array(), !0); goto aƒóÀÂ¹†á; aƒóÀÂ¹†á: } public function numViewAdd($D¸Á²÷Ş¿) { $AÀÙ‰ó™ =& $_SERVER[ªúæÂ¡­ä½]; $b—ÌÔ®ö‘ = array($AÀÙ‰ó™[468] => $D¸Á²÷Ş¿); $this->where($b—ÌÔ®ö‘)->setAdd($AÀÙ‰ó™[1865]); } public function numDownloadAdd($BÚ³³ÌÛãÃ) { $FêĞ–“²ó‚ =& $_SERVER[ªúæÂ¡­ä½]; $D‹Ğ×æ¤– = array($FêĞ–“²ó‚[468] => $BÚ³³ÌÛãÃ); $this->where($D‹Ğ×æ¤–)->setAdd($FêĞ–“²ó‚[1866]); } protected function shareEdit($aØ®Ë‡•ÍÈ, $F’ÔÈÍÀß) { goto böÓ¡¯£Î; e³³ã®©Ò: $this->_checkLinkShare($F’ÔÈÍÀß, $fÍÖÈŠñŞë); $eÂ’ä¼¨Ç¹ = array(); $FØ‹ÓØá¹ = explode($AÚ¿õë‚÷[47], $AÚ¿õë‚÷[1869]); goto C¬Ô‚ë¸¿ã; C¬Ô‚ë¸¿ã: foreach ($FØ‹ÓØá¹ as $fÑÏçé¦Û‚) { if (!array_key_exists($fÑÏçé¦Û‚, $F’ÔÈÍÀß)) { continue; } $eÂ’ä¼¨Ç¹[$fÑÏçé¦Û‚] = $F’ÔÈÍÀß[$fÑÏçé¦Û‚]; } $this->shareEventAdd($fÍÖÈŠñŞë[$AÚ¿õë‚÷[396]], $F’ÔÈÍÀß, $AÚ¿õë‚÷[1681]); $this->where(array($AÚ¿õë‚÷[468] => $aØ®Ë‡•ÍÈ))->save($eÂ’ä¼¨Ç¹); goto F‡İ÷à¶ò¬; böÓ¡¯£Î: $AÚ¿õë‚÷ =& $_SERVER[ªúæÂ¡­ä½]; $fÍÖÈŠñŞë = $this->getInfo($aØ®Ë‡•ÍÈ); if (!$fÍÖÈŠñŞë) { return !1; } goto e³³ã®©Ò; F‡İ÷à¶ò¬: if (isset($F’ÔÈÍÀß[$AÚ¿õë‚÷[1858]])) { $this->_shareAuthSet($aØ®Ë‡•ÍÈ, $F’ÔÈÍÀß[$AÚ¿õë‚÷[1858]]); } return !0; goto C¥Ú­¯Ã¢¼; C¥Ú­¯Ã¢¼: } private function _checkLinkShare($B‘¡„Ä’ÀÅ, $d“Œ‚áÜ‡) { goto föË¶ó­ğ; föË¶ó­ğ: $B„öëËö°Ñ =& $_SERVER[ªúæÂ¡­ä½]; if ($B‘¡„Ä’ÀÅ[$B„öëËö°Ñ[474]] != $B„öëËö°Ñ[87]) { return; } $a¢ßÌÏ‘Ğ = $d“Œ‚áÜ‡[$B„öëËö°Ñ[85]][$B„öëËö°Ñ[396]]; goto cÀ³¥©¤§¿; cÀ³¥©¤§¿: if ($d“Œ‚áÜ‡[$B„öëËö°Ñ[85]][$B„öëËö°Ñ[29]] != $B„öëËö°Ñ[193]) { $cù««§„Ÿ = $this->_folderReport($a¢ßÌÏ‘Ğ); if (!$cù««§„Ÿ) { return; } show_json(LNG($B„öëËö°Ñ[1870]) . $B„öëËö°Ñ[1871] . $cù««§„Ÿ, !1); } $E½­÷ÄÔ = Model($B„öëËö°Ñ[808])->fileInfoGet($d“Œ‚áÜ‡[$B„öëËö°Ñ[85]][$B„öëËö°Ñ[396]]); if (!$E½­÷ÄÔ) { return; } goto C˜†‰ÂŠê; C˜†‰ÂŠê: $bò©ÍÙš = $this->shareFileMeta($E½­÷ÄÔ[$B„öëËö°Ñ[448]]); if (isset($bò©ÍÙš[$B„öëËö°Ñ[372]]) && $bò©ÍÙš[$B„öëËö°Ñ[372]] == $B„öëËö°Ñ[87]) { show_json(LNG($B„öëËö°Ñ[1872]), !1); } goto f‹ˆ©¡¹Ø’; f‹ˆ©¡¹Ø’: } private function _folderReport($f„ÆÏË¥) { goto Bã§Òö¼ŒŒ; B£‰­™¡ì: $bÈèá½—»’ = array_to_keyvalue($Eö‡å°äò, $B‡˜½˜›Œ¹[33], $B‡˜½˜›Œ¹[28]); $bÈèá½—»’[] = $DÙ½ŠùÛ ğ[$B‡˜½˜›Œ¹[28]]; return implode($B‡˜½˜›Œ¹[8], $bÈèá½—»’); goto E³¼Ëˆß; B¯Ì´æÀÂ¼: $A¦ôäÇŸÎª = array($B‡˜½˜›Œ¹[448] => array($B‡˜½˜›Œ¹[7], $D“—öÈãŠ), $B‡˜½˜›Œ¹[503] => array($B‡˜½˜›Œ¹[380], "\x25{$F£½ÆÎº¡}\45"), $B‡˜½˜›Œ¹[424] => 0); $DÙ½ŠùÛ ğ = Model($B‡˜½˜›Œ¹[808])->where($A¦ôäÇŸÎª)->field($B‡˜½˜›Œ¹[1874])->find(); if (!$DÙ½ŠùÛ ğ) { return !1; } goto aÃÚÉòªÆĞ; Bã§Òö¼ŒŒ: $B‡˜½˜›Œ¹ =& $_SERVER[ªúæÂ¡­ä½]; $A¦ôäÇŸÎª = array($B‡˜½˜›Œ¹[448] => array($B‡˜½˜›Œ¹[986], 0), $B‡˜½˜›Œ¹[728] => 3); $D“—öÈãŠ = Model($B‡˜½˜›Œ¹[1873])->where($A¦ôäÇŸÎª)->field($B‡˜½˜›Œ¹[448])->select(); goto e‘ô‘½å–; e‘ô‘½å–: if (!$D“—öÈãŠ) { return !1; } $D“—öÈãŠ = array_to_keyvalue($D“—öÈãŠ, $B‡˜½˜›Œ¹[33], $B‡˜½˜›Œ¹[448]); $F£½ÆÎº¡ = $B‡˜½˜›Œ¹[47] . $f„ÆÏË¥ . $B‡˜½˜›Œ¹[47]; goto B¯Ì´æÀÂ¼; aÃÚÉòªÆĞ: $B‡Â§¿»²ä = substr($DÙ½ŠùÛ ğ[$B‡˜½˜›Œ¹[503]], strpos($DÙ½ŠùÛ ğ[$B‡˜½˜›Œ¹[503]], $F£½ÆÎº¡)); $A¦ôäÇŸÎª = array($B‡˜½˜›Œ¹[396] => array($B‡˜½˜›Œ¹[7], trim($B‡Â§¿»²ä, $B‡˜½˜›Œ¹[47]))); $Eö‡å°äò = Model($B‡˜½˜›Œ¹[808])->where($A¦ôäÇŸÎª)->field($B‡˜½˜›Œ¹[28])->select(); goto B£‰­™¡ì; E³¼Ëˆß: } protected function remove($cß‹Õ¹ÛŠù) { goto CÁÓ“”É¤«; CÁÓ“”É¤«: $D»•„ºæïì =& $_SERVER[ªúæÂ¡­ä½]; if (is_array($cß‹Õ¹ÛŠù)) { $cß‹Õ¹ÛŠù = array($D»•„ºæïì[7], $cß‹Õ¹ÛŠù); } $eßÊ×­ˆÃª = array($D»•„ºæïì[469] => $cß‹Õ¹ÛŠù); goto AØ‚‚åˆ; AØ‚‚åˆ: $A–‹×íÛ = $this->where($eßÊ×­ˆÃª)->delete(); if ($A–‹×íÛ) { Model($D»•„ºæïì[578])->where(array($D»•„ºæïì[469] => $cß‹Õ¹ÛŠù))->delete(); } $e’¿ øÛ˜ = is_array($cß‹Õ¹ÛŠù) ? $cß‹Õ¹ÛŠù[1] : array($cß‹Õ¹ÛŠù); goto B……”ÃÑô; B……”ÃÑô: for ($dÕƒİ³¸ôğ = 0; $dÕƒİ³¸ôğ < count($e’¿ øÛ˜); $dÕƒİ³¸ôğ++) { $BÙŸÔ˜âÒš = $this->getInfo($e’¿ øÛ˜[$dÕƒİ³¸ôğ]); if ($BÙŸÔ˜âÒš[$D»•„ºæïì[476]] == $D»•„ºæïì[87]) { Model($D»•„ºæïì[547])->eventShare($BÙŸÔ˜âÒš[$D»•„ºæïì[396]], $D»•„ºæïì[1863]); } if ($BÙŸÔ˜âÒš[$D»•„ºæïì[474]] == $D»•„ºæïì[87]) { Model($D»•„ºæïì[547])->eventShare($BÙŸÔ˜âÒš[$D»•„ºæïì[396]], $D»•„ºæïì[1862]); } } return $A–‹×íÛ; goto eŠÒâ÷ìâ; eŠÒâ÷ìâ: } protected function removeBySource($AÉ­É“Ÿ™ø) { goto b•òàˆÊ±÷; a£—‚ˆºÎ: $Fö¬øÈŞ Ô = array_to_keyvalue($Fö¬øÈŞ Ô, $aßÌÍĞœ´´[33], $aßÌÍĞœ´´[469]); if (!$Fö¬øÈŞ Ô) { return; } $cêÛâæ¶ŞÅ = array($aßÌÍĞœ´´[468] => array($aßÌÍĞœ´´[412], $Fö¬øÈŞ Ô)); goto D “Ù±¥àÆ; D “Ù±¥àÆ: $this->where($cêÛâæ¶ŞÅ)->delete(); Model($aßÌÍĞœ´´[578])->where($cêÛâæ¶ŞÅ)->delete(); goto Bëáß¼ÒÖ; b•òàˆÊ±÷: $aßÌÍĞœ´´ =& $_SERVER[ªúæÂ¡­ä½]; $cêÛâæ¶ŞÅ = array($aßÌÍĞœ´´[411] => array($aßÌÍĞœ´´[412], $AÉ­É“Ÿ™ø)); $Fö¬øÈŞ Ô = $this->field($aßÌÍĞœ´´[469])->where($cêÛâæ¶ŞÅ)->select(); goto a£—‚ˆºÎ; Bëáß¼ÒÖ: } public function listAll($CºÛÖí’ğ¾) { goto C”ÕñÜ¯„¿; eÙÀÈö«: $fÁ¯ã†¶Ô‚ = $this->_makeOrder()->where($Fñ‰¥Ì·)->selectPage(20); if (empty($fÁ¯ã†¶Ô‚[$fÑÊË¾¦õ¯[367]])) { return array(); } $this->_listDataApply($fÁ¯ã†¶Ô‚[$fÑÊË¾¦õ¯[367]]); goto D„Äß¡Ï¥·; D„Äß¡Ï¥·: return $fÁ¯ã†¶Ô‚; goto BÛŸŒ×Í³; f¦“é”—†î: if ($CºÛÖí’ğ¾[$fÑÊË¾¦õ¯[739]]) { $eÃ Û£¸×Ñ = $CºÛÖí’ğ¾[$fÑÊË¾¦õ¯[477]] ? $CºÛÖí’ğ¾[$fÑÊË¾¦õ¯[477]] : strtotime(date($fÑÊË¾¦õ¯[1875])); $Fñ‰¥Ì·[$fÑÊË¾¦õ¯[194]] = array($fÑÊË¾¦õ¯[331], array($CºÛÖí’ğ¾[$fÑÊË¾¦õ¯[739]], $eÃ Û£¸×Ñ)); } if ($CºÛÖí’ğ¾[$fÑÊË¾¦õ¯[29]]) { $Fñ‰¥Ì·[$CºÛÖí’ğ¾[$fÑÊË¾¦õ¯[29]]] = 1; } else { $Fñ‰¥Ì·[] = array($fÑÊË¾¦õ¯[474] => array($fÑÊË¾¦õ¯[986], 0), $fÑÊË¾¦õ¯[476] => array($fÑÊË¾¦õ¯[986], 0), $fÑÊË¾¦õ¯[1852] => $fÑÊË¾¦õ¯[1806]); } if ($CºÛÖí’ğ¾[$fÑÊË¾¦õ¯[1802]]) { $Fñ‰¥Ì·[] = array($fÑÊË¾¦õ¯[471] => $CºÛÖí’ğ¾[$fÑÊË¾¦õ¯[1802]], $fÑÊË¾¦õ¯[1445] => array($fÑÊË¾¦õ¯[380], "\45{$CºÛÖí’ğ¾[$fÑÊË¾¦õ¯[1802]]}\45"), $fÑÊË¾¦õ¯[1852] => $fÑÊË¾¦õ¯[1806]); } goto eÙÀÈö«; C”ÕñÜ¯„¿: $fÑÊË¾¦õ¯ =& $_SERVER[ªúæÂ¡­ä½]; $Fñ‰¥Ì· = array(); if ($CºÛÖí’ğ¾[$fÑÊË¾¦õ¯[1545]]) { $Fñ‰¥Ì·[$fÑÊË¾¦õ¯[1545]] = $CºÛÖí’ğ¾[$fÑÊË¾¦õ¯[1545]]; } goto f¦“é”—†î; BÛŸŒ×Í³: } public function listDataApply($a³»ˆÜ‹) { $this->_listDataApply($a³»ˆÜ‹); return $a³»ˆÜ‹; } private function _listDataApply(&$Bù•Çø¢ÃÚ) { goto bõÄÔ“åÔ’; C„Õ«ÛÎÍÉ: unset($Aˆá´òõêÊ); $Bù•Çø¢ÃÚ = array_values($Bù•Çø¢ÃÚ); goto D‰…å×™ğá; dµé¨¯ë“: $E¿«†ïê‘‚ = array_to_keyvalue($Bù•Çø¢ÃÚ, $fäâôà†Şõ[33], $fäâôà†Şõ[396]); $D†«£¯ºİÚ = Model($fäâôà†Şõ[808])->sourceListInfo($E¿«†ïê‘‚, !0); foreach ($Bù•Çø¢ÃÚ as $dÔ¤ß½˜ò½ => &$Aˆá´òõêÊ) { $E‡‹ïŞ ß = $Aˆá´òõêÊ[$fäâôà†Şõ[1545]]; $Aˆá´òõêÊ[$fäâôà†Şõ[1876]] = $c“®­“ã´å[$E‡‹ïŞ ß] ? $c“®­“ã´å[$E‡‹ïŞ ß] : !1; $cƒÉ‹øÊé = $Aˆá´òõêÊ[$fäâôà†Şõ[396]]; $Aˆá´òõêÊ[$fäâôà†Şõ[85]] = $D†«£¯ºİÚ[$cƒÉ‹øÊé] ? $D†«£¯ºİÚ[$cƒÉ‹øÊé] : !1; if ($Aˆá´òõêÊ[$fäâôà†Şõ[85]][$fäâôà†Şõ[424]] == $fäâôà†Şõ[87]) { unset($Bù•Çø¢ÃÚ[$dÔ¤ß½˜ò½]); } if ($Aˆá´òõêÊ[$fäâôà†Şõ[85]] != $fäâôà†Şõ[191] && !$Aˆá´òõêÊ[$fäâôà†Şõ[85]]) { unset($Bù•Çø¢ÃÚ[$dÔ¤ß½˜ò½]); } } goto C„Õ«ÛÎÍÉ; bõÄÔ“åÔ’: $fäâôà†Şõ =& $_SERVER[ªúæÂ¡­ä½]; $fµÀËŞöË– = array_to_keyvalue($Bù•Çø¢ÃÚ, $fäâôà†Şõ[33], $fäâôà†Şõ[1545]); $c“®­“ã´å = Model($fäâôà†Şõ[520])->userListInfo(array_unique($fµÀËŞöË–)); goto dµé¨¯ë“; D‰…å×™ğá: } private function _makeOrder($B…î‰ù¹Ó = '') { goto cºïŸ„ÁÀÊ; DåçÛ©‹Ôã: $BƒŒöîÖâ = Input::get($aºáñÜ¶å»[436], $aºáñÜ¶å»[7], $aºáñÜ¶å»[417], $eİÖå”½ï„); $aĞ×Ğà´ë‹ = Input::get($aºáñÜ¶å»[437], $aºáñÜ¶å»[7], $aºáñÜ¶å»[1877], array($aºáñÜ¶å»[1801], $aºáñÜ¶å»[431])); $aĞ×Ğà´ë‹ = $e¤§íÔšË[$aĞ×Ğà´ë‹]; goto cõßãŒ¤; cºïŸ„ÁÀÊ: $aºáñÜ¶å» =& $_SERVER[ªúæÂ¡­ä½]; $eİÖå”½ï„ = array($aºáñÜ¶å»[194], $aºáñÜ¶å»[477], $aºáñÜ¶å»[1865], $aºáñÜ¶å»[1866]); $e¤§íÔšË = array($aºáñÜ¶å»[429] => $aºáñÜ¶å»[430], $aºáñÜ¶å»[431] => $aºáñÜ¶å»[432]); goto DåçÛ©‹Ôã; cõßãŒ¤: $B…î‰ù¹Ó = $B…î‰ù¹Ó . "{$BƒŒöîÖâ}\40{$aĞ×Ğà´ë‹}"; return $this->order($B…î‰ù¹Ó); goto EÅŠâò²˜Ñ; EÅŠâò²˜Ñ: } public function reportAdd($eöŒšÕËšƒ) { $BÂ…ÇôÈ =& $_SERVER[ªúæÂ¡­ä½]; $bƒŠõ¶©¹¶ = array($BÂ…ÇôÈ[469] => $eöŒšÕËšƒ[$BÂ…ÇôÈ[469]], $BÂ…ÇôÈ[1545] => USER_ID); if (Model($BÂ…ÇôÈ[1873])->where($bƒŠõ¶©¹¶)->find()) { return !1; } $d¯‚í¡šË = array($BÂ…ÇôÈ[469] => $eöŒšÕËšƒ[$BÂ…ÇôÈ[469]], $BÂ…ÇôÈ[1445] => $eöŒšÕËšƒ[$BÂ…ÇôÈ[1445]], $BÂ…ÇôÈ[396] => $eöŒšÕËšƒ[$BÂ…ÇôÈ[396]], $BÂ…ÇôÈ[448] => $eöŒšÕËšƒ[$BÂ…ÇôÈ[448]], $BÂ…ÇôÈ[1545] => USER_ID, $BÂ…ÇôÈ[29] => $eöŒšÕËšƒ[$BÂ…ÇôÈ[29]], $BÂ…ÇôÈ[432] => $eöŒšÕËšƒ[$BÂ…ÇôÈ[432]]); return Model($BÂ…ÇôÈ[1873])->add($d¯‚í¡šË); } public function reportList($e¬¶¢ñœÆĞ) { goto d•°æìš‘; cÄíÊ•¤Û×: $this->_listDataApply($DË÷ÜŞé[$A»§İìîÏä[367]]); return $DË÷ÜŞé; goto fÙ‘Œà†; cäñøº·áÁ: if (isset($e¬¶¢ñœÆĞ[$A»§İìîÏä[29]]) && in_array($e¬¶¢ñœÆĞ[$A»§İìîÏä[29]], array($A»§İìîÏä[87], $A»§İìîÏä[1878], $A»§İìîÏä[1879], $A»§İìîÏä[1880], $A»§İìîÏä[1881]))) { $AÇÈÁ˜‚[$A»§İìîÏä[29]] = $e¬¶¢ñœÆĞ[$A»§İìîÏä[29]]; } if (isset($e¬¶¢ñœÆĞ[$A»§İìîÏä[728]]) && in_array($e¬¶¢ñœÆĞ[$A»§İìîÏä[728]], array($A»§İìîÏä[191], $A»§İìîÏä[87], $A»§İìîÏä[1878], $A»§İìîÏä[1879]))) { $AÇÈÁ˜‚[$A»§İìîÏä[728]] = $e¬¶¢ñœÆĞ[$A»§İìîÏä[728]]; } $eÛÈæÙ¥½Ä = Input::get($A»§İìîÏä[437], $A»§İìîÏä[7], $A»§İìîÏä[1877], array($A»§İìîÏä[1801], $A»§İìîÏä[431])); goto cœ©Ö†¥Ÿ; A‘ËÚÑ‘: if (empty($DË÷ÜŞé[$A»§İìîÏä[367]])) { return array(); } $FĞ˜„…‰‹ = array_to_keyvalue_group($DË÷ÜŞé[$A»§İìîÏä[367]], $A»§İìîÏä[728], $A»§İìîÏä[469]); if (!empty($FĞ˜„…‰‹[0])) { $e¬¶¢ñœÆĞ = $FĞ˜„…‰‹[0]; $AÇÈÁ˜‚ = array($A»§İìîÏä[469] => array($A»§İìîÏä[7], $e¬¶¢ñœÆĞ)); $c‡‡¨ì´§¸ = $this->where($AÇÈÁ˜‚)->field($A»§İìîÏä[469])->select(); $c‡‡¨ì´§¸ = array_to_keyvalue($c‡‡¨ì´§¸, $A»§İìîÏä[33], $A»§İìîÏä[469]); $b¯£òŸ¤Ö = array_diff($e¬¶¢ñœÆĞ, $c‡‡¨ì´§¸); if (!empty($b¯£òŸ¤Ö)) { foreach ($DË÷ÜŞé[$A»§İìîÏä[367]] as $C÷êÓ¼†Ã => $CæùÙ¬·¡ï) { if (in_array($CæùÙ¬·¡ï[$A»§İìîÏä[469]], $b¯£òŸ¤Ö)) { unset($DË÷ÜŞé[$A»§İìîÏä[367]][$C÷êÓ¼†Ã]); } } } } goto cÄíÊ•¤Û×; cœ©Ö†¥Ÿ: $dƒ‘¢ÆŞÅÕ = array($A»§İìîÏä[429] => $A»§İìîÏä[430], $A»§İìîÏä[431] => $A»§İìîÏä[432]); $AÀ ‘ùï = $A»§İìîÏä[1882] . $dƒ‘¢ÆŞÅÕ[$eÛÈæÙ¥½Ä]; $DË÷ÜŞé = Model($A»§İìîÏä[1873])->where($AÇÈÁ˜‚)->order($AÀ ‘ùï)->selectPage(20); goto A‘ËÚÑ‘; d•°æìš‘: $A»§İìîÏä =& $_SERVER[ªúæÂ¡­ä½]; $AÇÈÁ˜‚ = array(); if ($e¬¶¢ñœÆĞ[$A»§İìîÏä[739]]) { $cÛä­ó‘àó = $e¬¶¢ñœÆĞ[$A»§İìîÏä[477]] ? $e¬¶¢ñœÆĞ[$A»§İìîÏä[477]] : strtotime(date($A»§İìîÏä[1875])); $AÇÈÁ˜‚[$A»§İìîÏä[194]] = array($A»§İìîÏä[331], array($e¬¶¢ñœÆĞ[$A»§İìîÏä[739]], $cÛä­ó‘àó)); } goto cäñøº·áÁ; fÙ‘Œà†: } public function reportStatus($CË¶Ùù ) { goto d®˜º™¨; d®˜º™¨: $D‚Ø­òŞë =& $_SERVER[ªúæÂ¡­ä½]; $CŸ˜³İ¬ê = array($D‚Ø­òŞë[394] => $CË¶Ùù [$D‚Ø­òŞë[394]]); $DŒºĞÍÇ„ = Model($D‚Ø­òŞë[1873])->where($CŸ˜³İ¬ê)->field($D‚Ø­òŞë[1883])->find(); goto f°ÜÄ—çÈ; b±®¡ŒÚôš: $EÆ¥ÑÊÔÃÙ = Model($D‚Ø­òŞë[1873])->where($CŸ˜³İ¬ê)->save($A©‰±çåÇ¤); if ($CË¶Ùù [$D‚Ø­òŞë[728]] == $D‚Ø­òŞë[1878]) { if ($DŒºĞÍÇ„[$D‚Ø­òŞë[448]] != $D‚Ø­òŞë[191] && $this->shareFileMeta($DŒºĞÍÇ„[$D‚Ø­òŞë[448]])) { $this->shareFileMeta($DŒºĞÍÇ„[$D‚Ø­òŞë[448]], 0); } $this->remove($DŒºĞÍÇ„[$D‚Ø­òŞë[469]]); return !0; } if ($EÆ¥ÑÊÔÃÙ && $CË¶Ùù [$D‚Ø­òŞë[728]] == $D‚Ø­òŞë[1879]) { $A”ìÎÃÏÜ™ = $A©‰±çåÇ¤[$D‚Ø­òŞë[728]] == $D‚Ø­òŞë[1879] ? 1 : 0; $this->shareFileMeta($DŒºĞÍÇ„[$D‚Ø­òŞë[448]], $A”ìÎÃÏÜ™); $this->removeByFile($DŒºĞÍÇ„[$D‚Ø­òŞë[448]]); } goto b‚¥ÍÇƒÕØ; b‚¥ÍÇƒÕØ: return $EÆ¥ÑÊÔÃÙ; goto DÚ¯†îš¬ƒ; f°ÜÄ—çÈ: if (!$DŒºĞÍÇ„) { return !1; } $A©‰±çåÇ¤ = array($D‚Ø­òŞë[728] => $CË¶Ùù [$D‚Ø­òŞë[728]]); if ($CË¶Ùù [$D‚Ø­òŞë[728]] == $D‚Ø­òŞë[1879] && $DŒºĞÍÇ„[$D‚Ø­òŞë[728]] == $D‚Ø­òŞë[1879]) { $A©‰±çåÇ¤[$D‚Ø­òŞë[728]] = 0; } goto b±®¡ŒÚôš; DÚ¯†îš¬ƒ: } private function removeByFile($Bâ’¾´ïìĞ) { goto Bêñ‰šÃà; Bêñ‰šÃà: $f‹ˆ†’äí =& $_SERVER[ªúæÂ¡­ä½]; $fô‡ËÆ£İŸ = Model($f‹ˆ†’äí[808])->where(array($f‹ˆ†’äí[448] => $Bâ’¾´ïìĞ))->field($f‹ˆ†’äí[396])->select(); $AÚ‰ãˆáÄš = array_to_keyvalue($fô‡ËÆ£İŸ, $f‹ˆ†’äí[33], $f‹ˆ†’äí[396]); goto AÊæ×ã”ç; Cô·ÖÃø½: $D´ÅˆÕ¦ñÎ = array_to_keyvalue($fô‡ËÆ£İŸ, $f‹ˆ†’äí[33], $f‹ˆ†’äí[469]); $this->remove($D´ÅˆÕ¦ñÎ); goto FÌÕƒ¤ìÉ’; AÊæ×ã”ç: $D šó•ˆñ” = array($f‹ˆ†’äí[396] => array($f‹ˆ†’äí[7], $AÚ‰ãˆáÄš), $f‹ˆ†’äí[474] => 1); $fô‡ËÆ£İŸ = $this->where($D šó•ˆñ”)->field($f‹ˆ†’äí[469])->select(); if (empty($fô‡ËÆ£İŸ)) { return; } goto Cô·ÖÃø½; FÌÕƒ¤ìÉ’: } private function shareFileMeta($FéŒÌ‡ŠÏ§, $dÜŒ¸Ÿ™Ší = null) { $dóÀ‰ÍòÕÊ =& $_SERVER[ªúæÂ¡­ä½]; $cï¡µ‡àÎ® = array($dóÀ‰ÍòÕÊ[448] => $FéŒÌ‡ŠÏ§, $dóÀ‰ÍòÕÊ[93] => $dóÀ‰ÍòÕÊ[1884]); if (is_null($dÜŒ¸Ÿ™Ší)) { return Model($dóÀ‰ÍòÕÊ[1885])->where($cï¡µ‡àÎ®)->find(); } $cï¡µ‡àÎ®[$dóÀ‰ÍòÕÊ[372]] = $dÜŒ¸Ÿ™Ší; Model($dóÀ‰ÍòÕÊ[1885])->add($cï¡µ‡àÎ®, array(), !0); } } class SourceAuthModel extends ModelBase { protected $tableName = "\151\157\137\x73\x6f\165\x72\143\145\x5f\x61\x75\x74\150"; public function getAuth($E¿ô“å‹è¶) { goto AŞóß¸±íš; Bšë‡¥ƒª: array_multisort($c•ˆÖ¼Ú‹Õ, SORT_DESC, $cÖ¨ªÍ¦àƒ); return $cÖ¨ªÍ¦àƒ; goto a©’åƒô‹‡; bÈÙ¨œõ“Ö: $c•ˆÖ¼Ú‹Õ = array(); $B•—Ä•¤ê÷ = 2 << 25; foreach ($Bòè¶Ñ–²® as $bäÁ®Û¹˜Ï) { goto AÛ¦Ÿ‹Ëœ; FÊÙä…®Û: if ($bäÁ®Û¹˜Ï[$F‚×¹ßØ[405]] == SourceModel::TYPE_USER && $bäÁ®Û¹˜Ï[$F‚×¹ßØ[485]] == $F‚×¹ßØ[191]) { $A¤ìÖÕ¥é = 0; } $c•ˆÖ¼Ú‹Õ[] = $e¦æ»êÕ—[$F‚×¹ßØ[407]] + $A¤ìÖÕ¥é; goto bé«Æ„½ºÔ; f†õ†ä: $A¤ìÖÕ¥é = 0; if ($bäÁ®Û¹˜Ï[$F‚×¹ßØ[405]] == SourceModel::TYPE_GROUP) { $A¤ìÖÕ¥é = $B•—Ä•¤ê÷ * 2; } if ($bäÁ®Û¹˜Ï[$F‚×¹ßØ[405]] == SourceModel::TYPE_USER) { $A¤ìÖÕ¥é = $B•—Ä•¤ê÷; } goto FÊÙä…®Û; AÛ¦Ÿ‹Ëœ: $e¦æ»êÕ— = Model($F‚×¹ßØ[489])->listData($bäÁ®Û¹˜Ï[$F‚×¹ßØ[1814]]); if (!$e¦æ»êÕ—) { continue; } $cÖ¨ªÍ¦àƒ[] = $bäÁ®Û¹˜Ï; goto f†õ†ä; bé«Æ„½ºÔ: } goto Bšë‡¥ƒª; AŞóß¸±íš: $F‚×¹ßØ =& $_SERVER[ªúæÂ¡­ä½]; $Bòè¶Ñ–²® = $this->sourceAuthSelect($E¿ô“å‹è¶); $cÖ¨ªÍ¦àƒ = array(); goto bÈÙ¨œõ“Ö; a©’åƒô‹‡: } public function sourceAuthSelect($E¡ëë‘µââ) { goto A¨ïÄ¤ä‚¨; A¨ïÄ¤ä‚¨: $C ’ƒƒÎÅ =& $_SERVER[ªúæÂ¡­ä½]; static $A¸Ò£ô¸ä = array(); $c†ÍùŒ®çº = is_array($E¡ëë‘µââ) ? !1 : !0; goto C¾ØåÃËˆ¦; Bƒ®²“Ãáö: if ($c†ÍùŒ®çº) { return $C²ĞÛè«íÜ; } return $eƒ¸Šç÷ä; goto ağ¤È‘Îğº; b…»¾Ùğ‹¾: if (count($Bèİùñ ßæ) == count($E¡ëë‘µââ)) { return $c†ÍùŒ®çº ? $Bèİùñ ßæ[$E¡ëë‘µââ[0]] : $Bèİùñ ßæ; } $FÈ„¸ò‡§‰ = $C ’ƒƒÎÅ[1886]; $aŸøÁ‡ô®‰ = array($C ’ƒƒÎÅ[396] => array($C ’ƒƒÎÅ[7], $E¡ëë‘µââ)); goto aç‘††Ü˜; C¾ØåÃËˆ¦: if ($c†ÍùŒ®çº) { $E¡ëë‘µââ = array($E¡ëë‘µââ); } $Bèİùñ ßæ = array(); foreach ($E¡ëë‘µââ as $a¨ñİ¦ÎË¹) { if (isset($A¸Ò£ô¸ä[$a¨ñİ¦ÎË¹])) { $Bèİùñ ßæ[$a¨ñİ¦ÎË¹] = $A¸Ò£ô¸ä[$a¨ñİ¦ÎË¹]; } } goto b…»¾Ùğ‹¾; aç‘††Ü˜: $C²ĞÛè«íÜ = $this->field($FÈ„¸ò‡§‰)->order($C ’ƒƒÎÅ[394])->where($aŸøÁ‡ô®‰)->select(); $eƒ¸Šç÷ä = array_to_keyvalue_group($C²ĞÛè«íÜ, $C ’ƒƒÎÅ[396]); foreach ($E¡ëë‘µââ as $a¨ñİ¦ÎË¹) { $A¸Ò£ô¸ä[$a¨ñİ¦ÎË¹] = $eƒ¸Šç÷ä[$a¨ñİ¦ÎË¹] ? $eƒ¸Šç÷ä[$a¨ñİ¦ÎË¹] : array(); } goto Bƒ®²“Ãáö; ağ¤È‘Îğº: } public function setAuth($e‹ÆËÑñ¢ù, $Bğ‰’ƒÅ¡) { goto dğâÛŸ’Êª; BÌ›ˆä•¥: return !0; goto c¼ÜÑ¾†ê¬; dƒ´¸‚±àÂ: if ($A­Ä £Ò != $eµóÃ‹“¸) { $Bá «Õ¸ = array($aá“´ùãí[1714] => $A­Ä £Ò); $bÒ×ù†¥ = Model($aá“´ùãí[1800])->field($aá“´ùãí[1545])->where($Bá «Õ¸)->select(); $bÒ×ù†¥ = array_to_keyvalue($bÒ×ù†¥, $aá“´ùãí[33], $aá“´ùãí[1545]); } $B†¶–èÕ¬§ = array(SourceModel::TYPE_GROUP, SourceModel::TYPE_USER); $A¹£ò×ß£– = array(); goto CÔ”¼µŒãÍ; CÔ”¼µŒãÍ: foreach ($Bğ‰’ƒÅ¡ as $dĞŠ¿«Ñ) { if (!in_array($dĞŠ¿«Ñ[$aá“´ùãí[405]], $B†¶–èÕ¬§)) { show_json(LNG($aá“´ùãí[1887]), !1); } if ($A­Ä £Ò != $eµóÃ‹“¸) { if ($dĞŠ¿«Ñ[$aá“´ùãí[405]] == SourceModel::TYPE_GROUP) { } if ($dĞŠ¿«Ñ[$aá“´ùãí[485]] != 0 && !in_array($dĞŠ¿«Ñ[$aá“´ùãí[485]], $bÒ×ù†¥)) { } } if ($dĞŠ¿«Ñ[$aá“´ùãí[485]] == 0) { $dĞŠ¿«Ñ[$aá“´ùãí[405]] = SourceModel::TYPE_USER; } $A¹£ò×ß£–[] = array($aá“´ùãí[396] => $e‹ÆËÑñ¢ù, $aá“´ùãí[405] => intval($dĞŠ¿«Ñ[$aá“´ùãí[405]]), $aá“´ùãí[485] => intval($dĞŠ¿«Ñ[$aá“´ùãí[485]]), $aá“´ùãí[1814] => intval($dĞŠ¿«Ñ[$aá“´ùãí[1814]]) ? intval($dĞŠ¿«Ñ[$aá“´ùãí[1814]]) : 0, $aá“´ùãí[1868] => intval($dĞŠ¿«Ñ[$aá“´ùãí[1868]]) ? intval($dĞŠ¿«Ñ[$aá“´ùãí[1868]]) : -1); } $this->where(array($aá“´ùãí[411] => $e‹ÆËÑñ¢ù))->delete(); $this->addAll($A¹£ò×ß£–); goto BÌ›ˆä•¥; dğâÛŸ’Êª: $aá“´ùãí =& $_SERVER[ªúæÂ¡­ä½]; $Fˆ‹¿ò…ŒŠ = Model($aá“´ùãí[1221])->sourceInfo($e‹ÆËÑñ¢ù); if (!$Fˆ‹¿ò…ŒŠ) { return !1; } goto fàáÜ®Ç–ë; fàáÜ®Ç–ë: if ($Fˆ‹¿ò…ŒŠ[$aá“´ùãí[405]] != SourceModel::TYPE_GROUP) { return !1; } $eµóÃ‹“¸ = 1; $A­Ä £Ò = $Fˆ‹¿ò…ŒŠ[$aá“´ùãí[485]]; goto dƒ´¸‚±àÂ; c¼ÜÑ¾†ê¬: } public function authClear($EÔÕÖ—âË) { $e´–î­³Ã =& $_SERVER[ªúæÂ¡­ä½]; $Eíñ³õ•Ä× = Model($e´–î­³Ã[1221])->sourceInfo($EÔÕÖ—âË); $EÕËÛ£¬Õ = array($EÔÕÖ—âË); if ($Eíñ³õ•Ä×[$e´–î­³Ã[404]] == $e´–î­³Ã[87]) { $f¥Ä±Ï†§² = array($e´–î­³Ã[567] => array($e´–î­³Ã[526], $Eíñ³õ•Ä×[$e´–î­³Ã[503]] . $EÔÕÖ—âË . $e´–î­³Ã[527])); $EÕËÛ£¬Õ = Model($e´–î­³Ã[1221])->field($e´–î­³Ã[411])->where($f¥Ä±Ï†§²)->getField($e´–î­³Ã[396], !0); $EÕËÛ£¬Õ[] = $EÔÕÖ—âË; } $this->where(array($e´–î­³Ã[411] => array($e´–î­³Ã[412], $EÕËÛ£¬Õ)))->delete(); return !0; } public function getAllChildren($aÙ£¿óĞ¼) { goto a„Ğ×ƒ»š×; aÆÃª„´İß: if (!$Bòõº‹ËÅì) { return array(); } $cë•§ÀñŒÎ = $DÉ„ÑÓƒ­¢[1888]; $eØ¤ÍÉ¾›â = array($DÉ„ÑÓƒ­¢[396] => array($DÉ„ÑÓƒ­¢[7], $Bòõº‹ËÅì), $DÉ„ÑÓƒ­¢[424] => $DÉ„ÑÓƒ­¢[191]); goto eù¸šÑ³öî; CŞˆ‰’Ûœ—: return $this->sourceListAuth($cš³„ÚåÊ£); goto C¯¤Ò‹ßË±; eù¸šÑ³öî: $F”Ã›¦á—‘ = Model($DÉ„ÑÓƒ­¢[808])->field($cë•§ÀñŒÎ)->where($eØ¤ÍÉ¾›â)->select(); $cš³„ÚåÊ£ = array($aÙ£¿óĞ¼); foreach ($F”Ã›¦á—‘ as $eÊİ•š¦Ú) { foreach ($E…ÁëÒë¿ as $Aô¬Œ¤­…â) { $E‡Øù…ÜÉ = $DÉ„ÑÓƒ­¢[47] . $Aô¬Œ¤­…â . $DÉ„ÑÓƒ­¢[47]; $aº™ÈÀßÏÚ = $eÊİ•š¦Ú[$DÉ„ÑÓƒ­¢[503]] . $eÊİ•š¦Ú[$DÉ„ÑÓƒ­¢[396]] . $DÉ„ÑÓƒ­¢[47]; if (strstr($aº™ÈÀßÏÚ, $E‡Øù…ÜÉ)) { $cš³„ÚåÊ£[] = $eÊİ•š¦Ú[$DÉ„ÑÓƒ­¢[396]]; break; } } } goto CŞˆ‰’Ûœ—; c©„¡øšÄš: if ($fØˆ‹Œ•à»[$DÉ„ÑÓƒ­¢[405]] != SourceModel::TYPE_GROUP) { return array(); } $aÕª£¹¹Æ = 1; $E…ÁëÒë¿ = array($aÙ£¿óĞ¼); goto cì±¡Ö‡³Ğ; a„Ğ×ƒ»š×: $DÉ„ÑÓƒ­¢ =& $_SERVER[ªúæÂ¡­ä½]; $fØˆ‹Œ•à» = Model($DÉ„ÑÓƒ­¢[1221])->sourceInfo($aÙ£¿óĞ¼); if ($fØˆ‹Œ•à»[$DÉ„ÑÓƒ­¢[404]] != $DÉ„ÑÓƒ­¢[87]) { return $this->sourceListAuth(array($aÙ£¿óĞ¼)); } goto c©„¡øšÄš; cì±¡Ö‡³Ğ: if ($fØˆ‹Œ•à»[$DÉ„ÑÓƒ­¢[479]] == $DÉ„ÑÓƒ­¢[191] && $fØˆ‹Œ•à»[$DÉ„ÑÓƒ­¢[485]] != $aÕª£¹¹Æ) { $E…ÁëÒë¿ = $this->groupChidldAllRootSource($fØˆ‹Œ•à»[$DÉ„ÑÓƒ­¢[485]]); } $Bòõº‹ËÅì = $this->field($DÉ„ÑÓƒ­¢[396])->group($DÉ„ÑÓƒ­¢[396])->select(); $Bòõº‹ËÅì = array_to_keyvalue($Bòõº‹ËÅì, $DÉ„ÑÓƒ­¢[33], $DÉ„ÑÓƒ­¢[396]); goto aÆÃª„´İß; C¯¤Ò‹ßË±: } private function sourceListAuth($AŠ»È’Ò™¼) { goto E†İÉæ¿İ; BÓÈù¹ïÖš: $eò¨¤›äàø = array(); $eµ×êÌ‚ÉÜ = array(); foreach ($føëÉé†°Ñ as $F™Ğİõâ‘) { goto BÙ À©ÏÉï; D‘æÄâ¬è”: $Dõ›Ö¸” = count(explode($BÚ¿´“°î‰[8], trim($F™Ğİõâ‘[$BÚ¿´“°î‰[501]], $BÚ¿´“°î‰[8]))); $eµ×êÌ‚ÉÜ[] = $Dõ›Ö¸” + ($F™Ğİõâ‘[$BÚ¿´“°î‰[29]] == $BÚ¿´“°î‰[77] ? 0 : 1000); goto e‚ê¹‚ß; FßÊ©È¾¢Š: unset($F™Ğİõâ‘[$BÚ¿´“°î‰[85]]); $b÷Şù½¦ğÄ = $A¸é“ñóŒ§[$F™Ğİõâ‘[$BÚ¿´“°î‰[396]]]; if (!$b÷Şù½¦ğÄ) { continue; } goto b¼¦Œ†‘¢; b¼¦Œ†‘¢: $F™Ğİõâ‘[$BÚ¿´“°î‰[1889]] = $this->authTargetInfo($b÷Şù½¦ğÄ); $F™Ğİõâ‘[$BÚ¿´“°î‰[501]] = rtrim($F™Ğİõâ‘[$BÚ¿´“°î‰[507]], $BÚ¿´“°î‰[8]) . $BÚ¿´“°î‰[8] . ltrim($F™Ğİõâ‘[$BÚ¿´“°î‰[501]], $BÚ¿´“°î‰[8]); $eò¨¤›äàø[] = $F™Ğİõâ‘; goto D‘æÄâ¬è”; BÙ À©ÏÉï: unset($F™Ğİõâ‘[$BÚ¿´“°î‰[435]]); unset($F™Ğİõâ‘[$BÚ¿´“°î‰[433]]); unset($F™Ğİõâ‘[$BÚ¿´“°î‰[407]]); goto FßÊ©È¾¢Š; e‚ê¹‚ß: } goto Cñ‘ØÑ¸õ; Cñ‘ØÑ¸õ: array_multisort($eµ×êÌ‚ÉÜ, SORT_ASC, $eò¨¤›äàø); return $eò¨¤›äàø; goto aƒŒŠ…§—È; E†İÉæ¿İ: $BÚ¿´“°î‰ =& $_SERVER[ªúæÂ¡­ä½]; $føëÉé†°Ñ = Model($BÚ¿´“°î‰[1221])->sourceListInfo($AŠ»È’Ò™¼, !0); $A¸é“ñóŒ§ = $this->sourceAuthSelect($AŠ»È’Ò™¼); goto BÓÈù¹ïÖš; aƒŒŠ…§—È: } private function groupChidldAllRootSource($d¨‚ƒ°Ñ†ƒ) { $Fˆº‘ËÛ»­ =& $_SERVER[ªúæÂ¡­ä½]; $dêË³‘Äï = Model($Fˆº‘ËÛ»­[1890])->groupChildrenAll($d¨‚ƒ°Ñ†ƒ); $cÙ†‘ çÎ = array($Fˆº‘ËÛ»­[479] => 0, $Fˆº‘ËÛ»­[485] => array($Fˆº‘ËÛ»­[7], $dêË³‘Äï), $Fˆº‘ËÛ»­[405] => SourceModel::TYPE_GROUP); $C—é¯ˆ¬ï = Model($Fˆº‘ËÛ»­[808])->field($Fˆº‘ËÛ»­[396])->where($cÙ†‘ çÎ)->select(); $C—é¯ˆ¬ï = array_to_keyvalue($C—é¯ˆ¬ï, $Fˆº‘ËÛ»­[33], $Fˆº‘ËÛ»­[396]); return $C—é¯ˆ¬ï; } private function authTargetInfo($d¬Àª¶Ç×à) { goto c‰“á°©»; c‰“á°©»: $c¸—‚³Ü£ =& $_SERVER[ªúæÂ¡­ä½]; $f¹ÚÈ½½ÂŸ = array(); $D¤µ¿ğ¬·‚ = array(); goto e¢ö–é‡Ñ†; aÕôÁ©×Ù: return $f¹ÚÈ½½ÂŸ; goto aÕñâğô—; e¢ö–é‡Ñ†: $C…ŠÇ»…Ğè = 2 << 25; foreach ($d¬Àª¶Ç×à as $cßÜÓ“ãÈ) { goto AìÑÖ”ï¦ã; DÕ“Ùç’º: $E¦È¦ƒ…ƒ = 0; if ($cßÜÓ“ãÈ[$c¸—‚³Ü£[405]] == SourceModel::TYPE_GROUP) { $E¦È¦ƒ…ƒ = $C…ŠÇ»…Ğè * 2; } if ($cßÜÓ“ãÈ[$c¸—‚³Ü£[405]] == SourceModel::TYPE_USER) { $E¦È¦ƒ…ƒ = $C…ŠÇ»…Ğè; } goto F†¯°ÕÜÌ; F†¯°ÕÜÌ: if ($cßÜÓ“ãÈ[$c¸—‚³Ü£[405]] == SourceModel::TYPE_USER && $cßÜÓ“ãÈ[$c¸—‚³Ü£[485]] == $c¸—‚³Ü£[191]) { $E¦È¦ƒ…ƒ = 0; } $D¤µ¿ğ¬·‚[] = $AÖÙçÊ‚Ò[$c¸—‚³Ü£[407]] + $E¦È¦ƒ…ƒ; goto aìîø·±¡; Aµá°ùñé: if (!$eçñ¡—ù·¯) { continue; } $eçñ¡—ù·¯[$c¸—‚³Ü£[447]] = $AÖÙçÊ‚Ò; $f¹ÚÈ½½ÂŸ[] = $eçñ¡—ù·¯; goto DÕ“Ùç’º; AìÑÖ”ï¦ã: $AÖÙçÊ‚Ò = Model($c¸—‚³Ü£[489])->listData($cßÜÓ“ãÈ[$c¸—‚³Ü£[1814]]); if (!$AÖÙçÊ‚Ò) { continue; } if ($cßÜÓ“ãÈ[$c¸—‚³Ü£[405]] == SourceModel::TYPE_USER) { $eçñ¡—ù·¯ = Model($c¸—‚³Ü£[495])->getInfoSimpleOuter($cßÜÓ“ãÈ[$c¸—‚³Ü£[485]]); if ($eçñ¡—ù·¯[$c¸—‚³Ü£[1545]] == $c¸—‚³Ü£[1100]) { continue; } if ($eçñ¡—ù·¯[$c¸—‚³Ü£[1545]] == $c¸—‚³Ü£[191]) { $eçñ¡—ù·¯[$c¸—‚³Ü£[28]] = LNG($c¸—‚³Ü£[1891]); } } else { $eçñ¡—ù·¯ = Model($c¸—‚³Ü£[504])->getInfoSimple($cßÜÓ“ãÈ[$c¸—‚³Ü£[485]]); } goto Aµá°ùñé; aìîø·±¡: } array_multisort($D¤µ¿ğ¬·‚, SORT_DESC, $f¹ÚÈ½½ÂŸ); goto aÕôÁ©×Ù; aÕñâğô—: } public function getAllChildrenByUser($e¸â‡¿»èÚ, $C¿ÆÜ‰ŠÁ) { goto c—æŞ°´„¡; A‹„ó–•õ: return $eºèŒÉ›; goto aê½ï†ÍÙ‡; c—æŞ°´„¡: $dÉÜ‡ëè£¼ =& $_SERVER[ªúæÂ¡­ä½]; $bÆ‰”ì“Ğ = Model($dÉÜ‡ëè£¼[520])->getInfo($C¿ÆÜ‰ŠÁ); if (!$C¿ÆÜ‰ŠÁ || !$e¸â‡¿»èÚ || !$bÆ‰”ì“Ğ) { return array(); } goto f‰­“ìèŸ‹; bœ‚½™â: foreach ($f½Ş¹Ò·Ùö as $b­¯‘ÍÄØ‹) { $aÖáÈ•¦‰µ = !1; foreach ($b­¯‘ÍÄØ‹[$dÉÜ‡ëè£¼[1889]] as $CŒ¨áĞÜÁ˜) { if ($CŒ¨áĞÜÁ˜[$dÉÜ‡ëè£¼[1545]]) { if ($CŒ¨áĞÜÁ˜[$dÉÜ‡ëè£¼[1545]] == $C¿ÆÜ‰ŠÁ) { $aÖáÈ•¦‰µ = !0; break; } } if ($CŒ¨áĞÜÁ˜[$dÉÜ‡ëè£¼[1714]]) { if ($this->groupContainUser($CŒ¨áĞÜÁ˜[$dÉÜ‡ëè£¼[1714]], $C¿ÆÜ‰ŠÁ)) { $aÖáÈ•¦‰µ = !0; break; } } } if ($aÖáÈ•¦‰µ) { $eºèŒÉ›[] = $b­¯‘ÍÄØ‹; } $f¾…éÊ¸™± = $b­¯‘ÍÄØ‹[$dÉÜ‡ëè£¼[396]]; if (isset($cÃè…Å¢š[$f¾…éÊ¸™±])) { $b­¯‘ÍÄØ‹[$dÉÜ‡ëè£¼[1889]][] = $cÃè…Å¢š[$f¾…éÊ¸™±][0]; $cÃè…Å¢š[$f¾…éÊ¸™±] = !1; } } $cÃè…Å¢š = array_filter(array_values($cÃè…Å¢š)); $eºèŒÉ› = array_merge($cÃè…Å¢š, $eºèŒÉ›); goto A‹„ó–•õ; E¿¬æ«¿Áó: if ($cá¡ƒ£ïØİ[$dÉÜ‡ëè£¼[479]] == $dÉÜ‡ëè£¼[191] && $cá¡ƒ£ïØİ[$dÉÜ‡ëè£¼[485]] != $f¬¶îéøº && $this->groupContainUser($cá¡ƒ£ïØİ[$dÉÜ‡ëè£¼[485]], $C¿ÆÜ‰ŠÁ)) { foreach ($bÆ‰”ì“Ğ[$dÉÜ‡ëè£¼[1892]] as $Eœ”¡°…£¡) { $b÷Úïº×ÇÒ = Model($dÉÜ‡ëè£¼[504])->getInfo($Eœ”¡°…£¡[$dÉÜ‡ëè£¼[1714]]); $dò×³ø³®¨ = Model($dÉÜ‡ëè£¼[520])->getInfoSimpleOuter($C¿ÆÜ‰ŠÁ); $dò×³ø³®¨[$dÉÜ‡ëè£¼[447]] = $Eœ”¡°…£¡[$dÉÜ‡ëè£¼[407]]; if (Model($dÉÜ‡ëè£¼[489])->authCheckAction($Eœ”¡°…£¡[$dÉÜ‡ëè£¼[407]][$dÉÜ‡ëè£¼[407]], $dÉÜ‡ëè£¼[1734])) { continue; } $AÚ¸ÜèŸ‰ = array($dÉÜ‡ëè£¼[28] => $dÉÜ‡ëè£¼[1497] . $b÷Úïº×ÇÒ[$dÉÜ‡ëè£¼[28]], $dÉÜ‡ëè£¼[396] => $b÷Úïº×ÇÒ[$dÉÜ‡ëè£¼[85]][$dÉÜ‡ëè£¼[396]], $dÉÜ‡ëè£¼[76] => KodIO::make($b÷Úïº×ÇÒ[$dÉÜ‡ëè£¼[85]][$dÉÜ‡ëè£¼[396]]), $dÉÜ‡ëè£¼[479] => $dÉÜ‡ëè£¼[191], $dÉÜ‡ëè£¼[405] => $dÉÜ‡ëè£¼[497], $dÉÜ‡ëè£¼[29] => $dÉÜ‡ëè£¼[531], $dÉÜ‡ëè£¼[501] => $b÷Úïº×ÇÒ[$dÉÜ‡ëè£¼[508]], $dÉÜ‡ëè£¼[1714] => $b÷Úïº×ÇÒ[$dÉÜ‡ëè£¼[1714]], $dÉÜ‡ëè£¼[505] => $b÷Úïº×ÇÒ[$dÉÜ‡ëè£¼[479]], $dÉÜ‡ëè£¼[1889] => array($dò×³ø³®¨)); $cÃè…Å¢š[$AÚ¸ÜèŸ‰[$dÉÜ‡ëè£¼[396]]] = $AÚ¸ÜèŸ‰; } } $eºèŒÉ› = array(); $f½Ş¹Ò·Ùö = $this->getAllChildren($e¸â‡¿»èÚ); goto bœ‚½™â; f‰­“ìèŸ‹: $cá¡ƒ£ïØİ = Model($dÉÜ‡ëè£¼[1221])->sourceInfo($e¸â‡¿»èÚ); $cÃè…Å¢š = array(); $f¬¶îéøº = 1; goto E¿¬æ«¿Áó; aê½ï†ÍÙ‡: } public function setAllChildrenByUser($Cäù­çÄë, $C¢°–æƒˆ³, $AÁÀ“Ü‹ö) { $a¹é…Ğ·ğ =& $_SERVER[ªúæÂ¡­ä½]; $b×»ˆÓ­¨Ã = $this->getAllChildrenByUser($Cäù­çÄë, $C¢°–æƒˆ³); if (!$AÁÀ“Ü‹ö || !$b×»ˆÓ­¨Ã) { return !1; } foreach ($b×»ˆÓ­¨Ã as $a‡Ã¿®ÑÜ) { $fÕÄ”¡•¶ = array(); foreach ($a‡Ã¿®ÑÜ[$a¹é…Ğ·ğ[1889]] as $C•Ï¨Æ”ô) { $dÓ¸¹±Œ®Ú = $C•Ï¨Æ”ô[$a¹é…Ğ·ğ[447]]; $F½•Ô±†Âã = $C•Ï¨Æ”ô[$a¹é…Ğ·ğ[1545]] ? SourceModel::TYPE_USER : SourceModel::TYPE_GROUP; $A©ÇËªÒ†ˆ = $C•Ï¨Æ”ô[$a¹é…Ğ·ğ[1545]] ? $C•Ï¨Æ”ô[$a¹é…Ğ·ğ[1545]] : $C•Ï¨Æ”ô[$a¹é…Ğ·ğ[1714]]; if ($C•Ï¨Æ”ô[$a¹é…Ğ·ğ[1545]] && $C•Ï¨Æ”ô[$a¹é…Ğ·ğ[1545]] == $C¢°–æƒˆ³) { continue; } $fÕÄ”¡•¶[] = array($a¹é…Ğ·ğ[396] => $a‡Ã¿®ÑÜ[$a¹é…Ğ·ğ[396]], $a¹é…Ğ·ğ[405] => $F½•Ô±†Âã, $a¹é…Ğ·ğ[485] => intval($A©ÇËªÒ†ˆ), $a¹é…Ğ·ğ[1814] => isset($dÓ¸¹±Œ®Ú[$a¹é…Ğ·ğ[394]]) ? intval($dÓ¸¹±Œ®Ú[$a¹é…Ğ·ğ[394]]) : 0, $a¹é…Ğ·ğ[1868] => isset($dÓ¸¹±Œ®Ú[$a¹é…Ğ·ğ[1868]]) ? intval($dÓ¸¹±Œ®Ú[$a¹é…Ğ·ğ[1868]]) : -1); } $fÕÄ”¡•¶[] = array($a¹é…Ğ·ğ[396] => $a‡Ã¿®ÑÜ[$a¹é…Ğ·ğ[396]], $a¹é…Ğ·ğ[405] => SourceModel::TYPE_USER, $a¹é…Ğ·ğ[485] => intval($C¢°–æƒˆ³), $a¹é…Ğ·ğ[1814] => intval($AÁÀ“Ü‹ö), $a¹é…Ğ·ğ[1868] => -1); $this->where(array($a¹é…Ğ·ğ[411] => $a‡Ã¿®ÑÜ[$a¹é…Ğ·ğ[396]]))->delete(); $this->addAll($fÕÄ”¡•¶); } return !0; } public function get($FĞ¾ÃìŒ‚¨) { $d¢ÏŠá¬ˆ» = $this->getSourceList(array($FĞ¾ÃìŒ‚¨), !0); return $d¢ÏŠá¬ˆ»[0]; } public function getSourceList($FØ”²å¶Ì‚, $f¿âœ¬‹¿ = false, $C§ŒÛ»²ˆˆ = false) { goto CÚäÍ¢Â‹; dá¸†­Ã‡: $DÕîí±ö¯ = array(); foreach ($f¿âœ¬‹¿ as $A’àåƒƒ®Ï => $fËŸÈ—ÂãÈ) { if ($Fá¼‡®ÍŸ„) { $DÕîí±ö¯[$A’àåƒƒ®Ï] = $f¬ˆÈùõ·’; continue; } $DÕîí±ö¯[$A’àåƒƒ®Ï] = $this->makeSourceAuth($fËŸÈ—ÂãÈ, $aóšŠ– Ş, $C§ŒÛ»²ˆˆ); } return $DÕîí±ö¯; goto e–¢Ïàå‘Õ; CÚäÍ¢Â‹: $Dßœ¥ö¦ì„ =& $_SERVER[ªúæÂ¡­ä½]; if (!$FØ”²å¶Ì‚) { return array(); } $c’ô¯Ö—› = Model($Dßœ¥ö¦ì„[1221]); goto Eñ‹‹¥Æî‡; Aë§­šµ‘Ã: foreach ($f¿âœ¬‹¿ as $eÏ›Œ¸õ¹ => $FŞˆ»ç¢Œ•) { $B¸¿á…°Š = $c’ô¯Ö—›->parentLevelArray($FŞˆ»ç¢Œ•[$Dßœ¥ö¦ì„[503]]); $bŞËÄÁ·®Ç = array_merge($bŞËÄÁ·®Ç, array($eÏ›Œ¸õ¹), array_reverse($B¸¿á…°Š)); } $bŞËÄÁ·®Ç = array_values(array_unique($bŞËÄÁ·®Ç)); if (!$bŞËÄÁ·®Ç) { return array(); } goto E§´ªàøœ; E§´ªàøœ: $eƒç™‰·Ü = $this->sourceAuthSelect($bŞËÄÁ·®Ç); $aóšŠ– Ş = array(); foreach ($bŞËÄÁ·®Ç as $A’àåƒƒ®Ï) { if (isset($eƒç™‰·Ü[$A’àåƒƒ®Ï])) { $aóšŠ– Ş[$A’àåƒƒ®Ï] = $eƒç™‰·Ü[$A’àåƒƒ®Ï]; } } goto bóµÆŞÊ³; Eñ‹‹¥Æî‡: if (!$f¿âœ¬‹¿ && count($FØ”²å¶Ì‚) == 1) { $f¿âœ¬‹¿ = array(); $f¿âœ¬‹¿[$FØ”²å¶Ì‚[0]] = $c’ô¯Ö—›->sourceInfo($FØ”²å¶Ì‚[0]); } if (!$f¿âœ¬‹¿) { $e†¸Ÿ¶ì½‹ = array($Dßœ¥ö¦ì„[411] => array($Dßœ¥ö¦ì„[412], $FØ”²å¶Ì‚)); $f¿âœ¬‹¿ = $c’ô¯Ö—›->field($Dßœ¥ö¦ì„[1893])->where($e†¸Ÿ¶ì½‹)->select(); $f¿âœ¬‹¿ = array_to_keyvalue($f¿âœ¬‹¿, $Dßœ¥ö¦ì„[396]); } $bŞËÄÁ·®Ç = $FØ”²å¶Ì‚; goto Aë§­šµ‘Ã; bóµÆŞÊ³: $Fá¼‡®ÍŸ„ = $this->userIsRoot($C§ŒÛ»²ˆˆ); $AÃ¾Ş¢‚‘ = AuthModel::authAll(); $f¬ˆÈùõ·’ = array($Dßœ¥ö¦ì„[408] => $AÃ¾Ş¢‚‘, $Dßœ¥ö¦ì„[1894] => array($Dßœ¥ö¦ì„[413] => 0, $Dßœ¥ö¦ì„[1720] => $AÃ¾Ş¢‚‘, $Dßœ¥ö¦ì„[414] => LNG($Dßœ¥ö¦ì„[1895]), $Dßœ¥ö¦ì„[1736] => $Dßœ¥ö¦ì„[1896])); goto dá¸†­Ã‡; e–¢Ïàå‘Õ: } public function authDeepCheck($aï“¥öÕÈ, $AÕ™£ŸÊß÷ = false) { goto D¦İ¡—ŒÌÈ; D“›áÚŒÆ†: if (!$cïÆ˜©äÑ¼) { return !1; } $Dˆ„øÂó± = $cïÆ˜©äÑ¼ ? $cïÆ˜©äÑ¼[0] : $aï“¥öÕÈ; return array($bæ¾§ğñÌ¯[408] => -1, $bæ¾§ğñÌ¯[447] => array($bæ¾§ğñÌ¯[413] => $bæ¾§ğñÌ¯[1100], $bæ¾§ğñÌ¯[1720] => $bæ¾§ğñÌ¯[191], $bæ¾§ğñÌ¯[414] => LNG($bæ¾§ğñÌ¯[1899]), $bæ¾§ğñÌ¯[1736] => $bæ¾§ğñÌ¯[1900]), $bæ¾§ğñÌ¯[1901] => LNG($bæ¾§ğñÌ¯[1902]), $bæ¾§ğñÌ¯[1903] => $this->sourceAuthInfo($Dˆ„øÂó±)); goto Bİ¤å¨Í›•; D¦İ¡—ŒÌÈ: $bæ¾§ğñÌ¯ =& $_SERVER[ªúæÂ¡­ä½]; $AÕ™£ŸÊß÷ = $AÕ™£ŸÊß÷ ? $AÕ™£ŸÊß÷ : USER_ID; $Eìä—–¶³° = $this->makeAuthDeep($AÕ™£ŸÊß÷); goto CŠ¸ÏÄå¼ˆ; CŠ¸ÏÄå¼ˆ: if (!in_array($aï“¥öÕÈ, $Eìä—–¶³°[$bæ¾§ğñÌ¯[1897]])) { return !1; } $cïÆ˜©äÑ¼ = array(); foreach ($Eìä—–¶³°[$bæ¾§ğñÌ¯[1898]] as $B…«“£Ÿ¢Ã => $a·¹¥ëéÔ”) { if (!in_array($aï“¥öÕÈ, $a·¹¥ëéÔ”)) { continue; } $cïÆ˜©äÑ¼[] = $B…«“£Ÿ¢Ã; } goto D“›áÚŒÆ†; Bİ¤å¨Í›•: } protected function makeAuthDeep($dÍ÷Òùò–Ã = false) { goto D¡š¾ÉàÀ; d‹Öí‘¸•ò: if ($C„õó´¢) { $d·Š—ÑÖí± = array(array($bëˆ‡ËÛ™ì[405] => SourceModel::TYPE_USER, $bëˆ‡ËÛ™ì[485] => $dÍ÷Òùò–Ã), array($bëˆ‡ËÛ™ì[405] => SourceModel::TYPE_GROUP, $bëˆ‡ËÛ™ì[485] => array($bëˆ‡ËÛ™ì[412], $C„õó´¢)), $bëˆ‡ËÛ™ì[974] => $bëˆ‡ËÛ™ì[1806]); } $BÁ†ÅòÃ±é = $this->field($bëˆ‡ËÛ™ì[1905])->where($d·Š—ÑÖí±)->select(); $AùÑÚÃÃ©Â = array(); goto a—Ü©ÖíÏâ; a˜”…ÈÄ…: foreach ($AäòÖÚ¹ĞÉ as $EŠíçÍ¬Æ°) { if ($EŠíçÍ¬Æ°[$bëˆ‡ËÛ™ì[407]] == 0 && $EŠíçÍ¬Æ°[$bëˆ‡ËÛ™ì[1735]] == $bëˆ‡ËÛ™ì[87]) { $A¯²¾‰­…Â[] = $EŠíçÍ¬Æ°[$bëˆ‡ËÛ™ì[394]]; } } $C„õó´¢ = $this->userGroupParents($dÍ÷Òùò–Ã); $d·Š—ÑÖí± = array($bëˆ‡ËÛ™ì[405] => SourceModel::TYPE_USER, $bëˆ‡ËÛ™ì[485] => $dÍ÷Òùò–Ã); goto d‹Öí‘¸•ò; d•¯Ó¢‘ŞÀ: $D¹İ†™›í— = array(); if ($AùÑÚÃÃ©Â) { $fóÚíâÍ† = $Eƒ³‰æœù©->where(array($bëˆ‡ËÛ™ì[396] => array($bëˆ‡ËÛ™ì[412], $AùÑÚÃÃ©Â)))->select(); foreach ($fóÚíâÍ† as $aÉØ¹›ÁµÆ) { $eÕ†…µë¿ = $Eƒ³‰æœù©->parentLevelArray($aÉØ¹›ÁµÆ[$bëˆ‡ËÛ™ì[503]]); $Añ¶Á¿Ê = array_merge($Añ¶Á¿Ê, $eÕ†…µë¿); $a¤‡×¬í—[] = $aÉØ¹›ÁµÆ[$bëˆ‡ËÛ™ì[485]]; $cßµªªÂœë[$aÉØ¹›ÁµÆ[$bëˆ‡ËÛ™ì[396]]] = $eÕ†…µë¿; $Aõ¹ÒÍ‹»[$aÉØ¹›ÁµÆ[$bëˆ‡ËÛ™ì[396]]] = $aÉØ¹›ÁµÆ[$bëˆ‡ËÛ™ì[485]]; } } $a¤‡×¬í— = array_values(array_unique($a¤‡×¬í—)); goto Bˆé¿ØĞ; eïÜ©²Öé™: $a¤‡×¬í— = $C„õó´¢; $Eƒ³‰æœù© = Model($bëˆ‡ËÛ™ì[1221]); $e ÃÔ”ÍÚ = Model($bëˆ‡ËÛ™ì[504]); goto FÆÕ²Î‹ÛÕ; FÀ‡Àäïùµ: if (isset($b›Ù†Ÿ¼§Ş[$dÍ÷Òùò–Ã])) { return $b›Ù†Ÿ¼§Ş[$dÍ÷Òùò–Ã]; } $AäòÖÚ¹ĞÉ = Model($bëˆ‡ËÛ™ì[1904])->listData(); $A¯²¾‰­…Â = array(); goto a˜”…ÈÄ…; a—Ü©ÖíÏâ: $C¾ƒïˆÔİ´ = array_to_keyvalue_group($BÁ†ÅòÃ±é, $bëˆ‡ËÛ™ì[396]); foreach ($C¾ƒïˆÔİ´ as $D²ôÉîù’Ç => $EÁ¿ä×ëÓ¸) { $añÒ—¬Õöá = $this->authArrayCheck($EÁ¿ä×ëÓ¸, $dÍ÷Òùò–Ã); if ($añÒ—¬Õöá[$bëˆ‡ËÛ™ì[408]] > 0) { $AùÑÚÃÃ©Â[] = $D²ôÉîù’Ç . $bëˆ‡ËÛ™ì[33]; } } $Añ¶Á¿Ê = array(); goto eïÜ©²Öé™; d¬„œ‡¶»ñ: foreach ($a¤‡×¬í— as $eßÃ°‡£ß‰) { $C¢ÄíÌÄ = $e ÃÔ”ÍÚ->getInfo($eßÃ°‡£ß‰); $Añ¶Á¿Ê[] = $C¢ÄíÌÄ[$bëˆ‡ËÛ™ì[85]][$bëˆ‡ËÛ™ì[396]]; $cšğÄ¬ÉŸ®[$eßÃ°‡£ß‰] = $C¢ÄíÌÄ[$bëˆ‡ËÛ™ì[85]][$bëˆ‡ËÛ™ì[396]]; $D¹İ†™›í—[$eßÃ°‡£ß‰] = $Eƒ³‰æœù©->parentLevelArray($C¢ÄíÌÄ[$bëˆ‡ËÛ™ì[503]]); } foreach ($cßµªªÂœë as $A·Õ‰çº˜ => $aŠ¯õ¸Û´) { $b‡ÉñÅÃº• = $Aõ¹ÒÍ‹»[$A·Õ‰çº˜]; if (!$b‡ÉñÅÃº• || !$cšğÄ¬ÉŸ®[$b‡ÉñÅÃº•]) { continue; } $eî¤Š……„¥ = array(); foreach ($D¹İ†™›í—[$b‡ÉñÅÃº•] as $eßÃ°‡£ß‰) { $eî¤Š……„¥[] = $cšğÄ¬ÉŸ®[$eßÃ°‡£ß‰]; } $cßµªªÂœë[$A·Õ‰çº˜] = array_merge($eî¤Š……„¥, $aŠ¯õ¸Û´); } $Añ¶Á¿Ê = array_values(array_unique($Añ¶Á¿Ê)); goto BŒªöÑª¼; BŒªöÑª¼: $cêØÙß‘»ì = array($bëˆ‡ËÛ™ì[1897] => $Añ¶Á¿Ê, $bëˆ‡ËÛ™ì[1898] => $cßµªªÂœë); $b›Ù†Ÿ¼§Ş[$dÍ÷Òùò–Ã] = $cêØÙß‘»ì; return $cêØÙß‘»ì; goto fßô³Íà‚µ; D¡š¾ÉàÀ: $bëˆ‡ËÛ™ì =& $_SERVER[ªúæÂ¡­ä½]; static $b›Ù†Ÿ¼§Ş = array(); $dÍ÷Òùò–Ã = $dÍ÷Òùò–Ã ? $dÍ÷Òùò–Ã : USER_ID; goto FÀ‡Àäïùµ; Bˆé¿ØĞ: $FÑîà¶èùø = $a¤‡×¬í—; foreach ($FÑîà¶èùø as $eßÃ°‡£ß‰) { $C¢ÄíÌÄ = $e ÃÔ”ÍÚ->getInfo($eßÃ°‡£ß‰); $eÕ†…µë¿ = $Eƒ³‰æœù©->parentLevelArray($C¢ÄíÌÄ[$bëˆ‡ËÛ™ì[503]]); $a¤‡×¬í— = array_merge($a¤‡×¬í—, $eÕ†…µë¿); } $a¤‡×¬í— = array_values(array_unique($a¤‡×¬í—)); goto d¬„œ‡¶»ñ; FÆÕ²Î‹ÛÕ: $cßµªªÂœë = array(); $Aõ¹ÒÍ‹» = array(); $cšğÄ¬ÉŸ® = array(); goto d•¯Ó¢‘ŞÀ; fßô³Íà‚µ: } private function makeSourceAuth($cøª ½Ç, $b¹‚ãÚØ¸µ, $FãÉİˆâ°É = false) { goto D¨´Ÿ ÕÙ«; E‡¶«Ï†èİ: $DÄ÷òƒé‘Ø = Model($aâ½„öïã¥[1221])->parentLevelArray($cøª ½Ç[$aâ½„öïã¥[503]]); $DÄ÷òƒé‘Ø = array_merge(array($cøª ½Ç[$aâ½„öïã¥[396]]), array_reverse($DÄ÷òƒé‘Ø)); $f—øù™Ê = !1; goto Aê­ïÚ Ë‰; FÚ¦§ÙÂ·: $D ›ßÓš¶İ = $cøª ½Ç[$aâ½„öïã¥[405]] == SourceModel::TYPE_GROUP; $B‹ ¿¥°ò = $D ›ßÓš¶İ ? $this->groupRootAuth($E²—ÚË¿²Ü, $FãÉİˆâ°É) : !1; if ($B‹ ¿¥°ò && Model($aâ½„öïã¥[489])->authCheckAction($B‹ ¿¥°ò[$aâ½„öïã¥[407]], $aâ½„öïã¥[1734])) { return $this->groupAuthInfo($B‹ ¿¥°ò, $E²—ÚË¿²Ü); } goto E‡¶«Ï†èİ; Aê­ïÚ Ë‰: foreach ($DÄ÷òƒé‘Ø as $b·µ¦œ‹Ş) { if (!isset($b¹‚ãÚØ¸µ[$b·µ¦œ‹Ş])) { continue; } $B˜ˆÀËî”Á = $this->authMake($b¹‚ãÚØ¸µ[$b·µ¦œ‹Ş], $FãÉİˆâ°É); if ($B˜ˆÀËî”Á[$aâ½„öïã¥[447]]) { $f—øù™Ê = $B˜ˆÀËî”Á; break; } } if (!$D ›ßÓš¶İ) { return $f—øù™Ê; } if (!$f—øù™Ê && $B‹ ¿¥°ò) { $f—øù™Ê = $this->groupAuthInfo($B‹ ¿¥°ò, $E²—ÚË¿²Ü); } goto E‰ñÅ–Ã±; E‰ñÅ–Ã±: if (!$f—øù™Ê) { $dêµ¾—¹ ­ = Model($aâ½„öïã¥[504])->getInfo($E²—ÚË¿²Ü); $c™İ¾÷ø‡ = explode($aâ½„öïã¥[47], trim($dêµ¾—¹ ­[$aâ½„öïã¥[503]], $aâ½„öïã¥[47])); $c™İ¾÷ø‡ = array_reverse($c™İ¾÷ø‡); foreach ($c™İ¾÷ø‡ as $cŒî®„‡) { if ($cŒî®„‡ == $aâ½„öïã¥[191] || $cŒî®„‡ == $b¾‹¢¢â…†) { continue; } $e‰ˆ„¬±Ü± = $this->groupRootAuth($cŒî®„‡, $FãÉİˆâ°É); if (!$e‰ˆ„¬±Ü±) { continue; } $f—øù™Ê = $this->groupAuthInfo($e‰ˆ„¬±Ü±, $cŒî®„‡); break; } } if (!$f—øù™Ê || $f—øù™Ê[$aâ½„öïã¥[408]] <= 0) { $aÓ‚‡ÌÉÌ = $this->authDeepCheck($cøª ½Ç[$aâ½„öïã¥[396]], $FãÉİˆâ°É); if ($aÓ‚‡ÌÉÌ) { $f—øù™Ê = $aÓ‚‡ÌÉÌ; } } return $f—øù™Ê; goto EÙÔ¿â†; D¨´Ÿ ÕÙ«: $aâ½„öïã¥ =& $_SERVER[ªúæÂ¡­ä½]; $b¾‹¢¢â…† = $aâ½„öïã¥[87]; $E²—ÚË¿²Ü = $cøª ½Ç[$aâ½„öïã¥[485]]; goto FÚ¦§ÙÂ·; EÙÔ¿â†: } private function userIsRoot($BÅ‚”Ñ¤‡ = false) { $C‰ğµ©¹Ğ =& $_SERVER[ªúæÂ¡­ä½]; if (!$BÅ‚”Ñ¤‡ && _get($GLOBALS, $C‰ğµ©¹Ğ[486])) { return !0; } $böÔ‘—ííˆ = Model($C‰ğµ©¹Ğ[520])->getInfo($BÅ‚”Ñ¤‡); $cØâçáô‡° = Model($C‰ğµ©¹Ğ[1906])->listData($böÔ‘—ííˆ[$C‰ğµ©¹Ğ[1425]]); if ($cØâçáô‡° && $cØâçáô‡°[$C‰ğµ©¹Ğ[493]][$C‰ğµ©¹Ğ[1907]] == 1) { return !0; } return !1; } private function sourceAuthInfo($cÌ©˜º‚‡˜) { goto DòˆÀ†Ñ…‘; dÈ·šÂ¼¾¢: $DÙ—É¹Òï = $BÄ…áì‘²Õ->_listAppendPath($DÙ—É¹Òï); $f‘õ‹óƒ‹• = $DÙ—É¹Òï[0]; $Fí‡Ö¿ù³é = $f‘õ‹óƒ‹•[$EÕ•¢Ù˜îÌ[501]]; goto FŒ‰£½ªŒ«; FŒ‰£½ªŒ«: if (isset($f‘õ‹óƒ‹•[$EÕ•¢Ù˜îÌ[509]])) { $aŞ·Úô´é = explode($EÕ•¢Ù˜îÌ[8], trim($f‘õ‹óƒ‹•[$EÕ•¢Ù˜îÌ[501]], $EÕ•¢Ù˜îÌ[8])); array_shift($aŞ·Úô´é); $Fí‡Ö¿ù³é = $f‘õ‹óƒ‹•[$EÕ•¢Ù˜îÌ[507]] . $EÕ•¢Ù˜îÌ[1908] . implode($EÕ•¢Ù˜îÌ[8], $aŞ·Úô´é); } return array($EÕ•¢Ù˜îÌ[414] => $f‘õ‹óƒ‹•[$EÕ•¢Ù˜îÌ[28]], $EÕ•¢Ù˜îÌ[76] => KodIO::make($f‘õ‹óƒ‹•[$EÕ•¢Ù˜îÌ[396]]), $EÕ•¢Ù˜îÌ[1909] => $Fí‡Ö¿ù³é); goto aÓ£ìÚØºÚ; b•‡Ìøİ›é: if (!$f‘õ‹óƒ‹•) { return !1; } $BÄ…áì‘²Õ->groupPathDisplay($f‘õ‹óƒ‹•); $DÙ—É¹Òï = array($f‘õ‹óƒ‹•); goto dÈ·šÂ¼¾¢; DòˆÀ†Ñ…‘: $EÕ•¢Ù˜îÌ =& $_SERVER[ªúæÂ¡­ä½]; $BÄ…áì‘²Õ = Model($EÕ•¢Ù˜îÌ[1221]); $f‘õ‹óƒ‹• = $BÄ…áì‘²Õ->sourceInfo($cÌ©˜º‚‡˜); goto b•‡Ìøİ›é; aÓ£ìÚØºÚ: } private function groupAuthInfo($eñâÜƒ‰è„, $Bæ‡ëëÁ) { $BÂ¼›í¾ª· =& $_SERVER[ªúæÂ¡­ä½]; $E¿ÊÜ£÷ = Model($BÂ¼›í¾ª·[504])->getInfo($Bæ‡ëëÁ); return array($BÂ¼›í¾ª·[1910] => intval($eñâÜƒ‰è„[$BÂ¼›í¾ª·[407]]), $BÂ¼›í¾ª·[1894] => $eñâÜƒ‰è„, $BÂ¼›í¾ª·[1911] => LNG($BÂ¼›í¾ª·[1912]), $BÂ¼›í¾ª·[1903] => array($BÂ¼›í¾ª·[414] => $E¿ÊÜ£÷[$BÂ¼›í¾ª·[28]], $BÂ¼›í¾ª·[76] => KodIO::make($E¿ÊÜ£÷[$BÂ¼›í¾ª·[85]][$BÂ¼›í¾ª·[396]]), $BÂ¼›í¾ª·[1909] => $E¿ÊÜ£÷[$BÂ¼›í¾ª·[508]])); } protected function groupRootAuth($eÆÕ¢…Áä‹, $dÚè¤Ñî« = false) { goto A®—’öÜÒ–; fÍÑ¤ƒ®×: static $cİ¥áÈàĞ = array(); if (isset($cİ¥áÈàĞ[$C…–¤®ñµ—])) { return $cİ¥áÈàĞ[$C…–¤®ñµ—]; } $BØ–™™†Îì = Model($D™İ¸¬²í´[504])->getInfo($eÆÕ¢…Áä‹); goto e¥‰Èà’´’; e¥‰Èà’´’: $c„“ëøÇø = $this->userGroupList($dÚè¤Ñî«); $EŒí•Ç ò¤ = isset($c„“ëøÇø[$eÆÕ¢…Áä‹]) ? $c„“ëøÇø[$eÆÕ¢…Áä‹][$D™İ¸¬²í´[407]] : !1; if ($EŒí•Ç ò¤ && Model($D™İ¸¬²í´[489])->authCheckAction($EŒí•Ç ò¤[$D™İ¸¬²í´[407]], $D™İ¸¬²í´[1734])) { $cİ¥áÈàĞ[$C…–¤®ñµ—] = $EŒí•Ç ò¤; return $EŒí•Ç ò¤; } goto dÌ…†¢Öä†; dÌ…†¢Öä†: $Díå‰›İØ = $this->sourceAuthSelect($BØ–™™†Îì[$D™İ¸¬²í´[85]][$D™İ¸¬²í´[396]]); $Bàİ”¸¸æ = $Díå‰›İØ ? $this->authMake($Díå‰›İØ, $dÚè¤Ñî«) : !1; $e¦¸ÂŒ“È = $Bàİ”¸¸æ ? $Bàİ”¸¸æ[$D™İ¸¬²í´[447]] : !1; goto EõœØÚ³·; EõœØÚ³·: $cİ¥áÈàĞ[$C…–¤®ñµ—] = $e¦¸ÂŒ“È ? $e¦¸ÂŒ“È : $EŒí•Ç ò¤; return $cİ¥áÈàĞ[$C…–¤®ñµ—]; goto fšá“±•Ä; A®—’öÜÒ–: $D™İ¸¬²í´ =& $_SERVER[ªúæÂ¡­ä½]; $dÚè¤Ñî« = $dÚè¤Ñî« ? $dÚè¤Ñî« : USER_ID; $C…–¤®ñµ— = $dÚè¤Ñî« . $D™İ¸¬²í´[1913] . $eÆÕ¢…Áä‹; goto fÍÑ¤ƒ®×; fšá“±•Ä: } public function authOwnerApply($c£îœ¯“Èì) { goto C¥šî“£; C¥šî“£: $eÃåÏÓ‰Í¯ =& $_SERVER[ªúæÂ¡­ä½]; if (empty($c£îœ¯“Èì[$eÃåÏÓ‰Í¯[407]]) || isset($c£îœ¯“Èì[$eÃåÏÓ‰Í¯[1914]]) && $c£îœ¯“Èì[$eÃåÏÓ‰Í¯[1914]]) { return $c£îœ¯“Èì; } if (AuthModel::authCheckRoot($c£îœ¯“Èì[$eÃåÏÓ‰Í¯[407]][$eÃåÏÓ‰Í¯[408]])) { return $c£îœ¯“Èì; } goto bÇ³„†‚ãõ; d‰±šÂĞ: if (count($eÔ§°”Ìœ¿) == 0) { $eÔ§°”Ìœ¿ = $this->authFolderOwnerGroup($c£îœ¯“Èì[$eÃåÏÓ‰Í¯[485]]); } $eÔ§°”Ìœ¿ = array_unique($eÔ§°”Ìœ¿); if (AuthModel::authCheckRoot($c£îœ¯“Èì[$eÃåÏÓ‰Í¯[407]][$eÃåÏÓ‰Í¯[408]])) { $eÔ§°”Ìœ¿[] = USER_ID; } goto CÇ¯¹†¢éí; CÇ¯¹†¢éí: $c£îœ¯“Èì[$eÃåÏÓ‰Í¯[407]][$eÃåÏÓ‰Í¯[1916]] = Model($eÃåÏÓ‰Í¯[495])->userListInfo($eÔ§°”Ìœ¿); return $c£îœ¯“Èì; goto a±ç¢Å¹ôÀ; F’àêºèçº: $aÓØÜŞùòÌ = array(); $eÔ§°”Ìœ¿ = array(); foreach ($CšòÖ‡¾Á¶ as $bŠ·µÙ«íÓ => $bùšâàÎ) { $bÜùÌ±ÀÍŒ = $this->authFolderOwnerUser($bùšâàÎ); $aÓØÜŞùòÌ[$bŠ·µÙ«íÓ] = $bÜùÌ±ÀÍŒ; $eÔ§°”Ìœ¿ = array_merge($eÔ§°”Ìœ¿, $bÜùÌ±ÀÍŒ[$eÃåÏÓ‰Í¯[576]]); if ($bÜùÌ±ÀÍŒ[$eÃåÏÓ‰Í¯[1915]]) { break; } } goto d‰±šÂĞ; bÇ³„†‚ãõ: $FïØ×è¥°î = Model($eÃåÏÓ‰Í¯[1221])->parentLevelArray($c£îœ¯“Èì[$eÃåÏÓ‰Í¯[503]]); $FïØ×è¥°î = array_merge(array($c£îœ¯“Èì[$eÃåÏÓ‰Í¯[396]]), array_reverse($FïØ×è¥°î)); $CšòÖ‡¾Á¶ = $this->sourceAuthSelect($FïØ×è¥°î); goto F’àêºèçº; a±ç¢Å¹ôÀ: } private function authFolderOwnerGroup($C–±‡Š­÷¦) { $Fô´Í›¬Ò =& $_SERVER[ªúæÂ¡­ä½]; $c¨Çäòöá = Model($Fô´Í›¬Ò[1800])->where(array($Fô´Í›¬Ò[1714] => $C–±‡Š­÷¦))->select(); $C ºæÊË­ = array(); if (!$c¨Çäòöá) { return $C ºæÊË­; } foreach ($c¨Çäòöá as $Aè‚Ç…„Ÿ´) { $DÙšš¡ºåè = $this->authInfo($Aè‚Ç…„Ÿ´); if (AuthModel::authCheckRoot($DÙšš¡ºåè[$Fô´Í›¬Ò[407]])) { $C ºæÊË­[] = $Aè‚Ç…„Ÿ´[$Fô´Í›¬Ò[1545]]; } } return $C ºæÊË­; } private function authFolderOwnerUser($EØô÷Ñ«§‡) { $cµ‘Î´Óï =& $_SERVER[ªúæÂ¡­ä½]; $Dó¢Êß¶¥› = array(); $eØ”ßÉ•Æ = !1; foreach ($EØô÷Ñ«§‡ as $C—Ì‰íùÂ) { $aÌ¤…ë„ = $this->authInfo($C—Ì‰íùÂ); if ($C—Ì‰íùÂ[$cµ‘Î´Óï[485]] == $cµ‘Î´Óï[191]) { $eØ”ßÉ•Æ = !0; } if ($C—Ì‰íùÂ[$cµ‘Î´Óï[405]] == SourceModel::TYPE_USER) { if (AuthModel::authCheckRoot($aÌ¤…ë„[$cµ‘Î´Óï[407]])) { $Dó¢Êß¶¥›[] = $C—Ì‰íùÂ[$cµ‘Î´Óï[485]]; } } } return array($cµ‘Î´Óï[576] => $Dó¢Êß¶¥›, $cµ‘Î´Óï[1915] => $eØ”ßÉ•Æ); } public function authMake($Dï‚Øç²°ê, $E”É‘ğœù˜ = false) { $E¢‰°Ö¹­ =& $_SERVER[ªúæÂ¡­ä½]; $fÛÉíï÷Ë· = $this->authArrayCheck($Dï‚Øç²°ê, $E”É‘ğœù˜); if ($fÛÉíï÷Ë·[$E¢‰°Ö¹­[1917]]) { $fÛÉíï÷Ë·[$E¢‰°Ö¹­[1917]] = $this->sourceAuthInfo($fÛÉíï÷Ë·[$E¢‰°Ö¹­[1917]]); } return $fÛÉíï÷Ë·; } public function authArrayCheck($b·ñß“•º, $BºÈÂ‹ä• = false) { goto F÷’ïçÜ²Ÿ; F÷’ïçÜ²Ÿ: $eÅÔàí» =& $_SERVER[ªúæÂ¡­ä½]; if (!$b·ñß“•º) { return array($eÅÔàí»[408] => 0, $eÅÔàí»[447] => !1); } $BºÈÂ‹ä• = $BºÈÂ‹ä• ? $BºÈÂ‹ä• : USER_ID; goto EğñËğî; DÎŞËÃëöõ: $cŒ°İ¿‡«ì = 1000; $D¦‚™„µ‘˜ = 0; $eéĞª»Îè¡ = 0; goto dß÷–ò»šŞ; D›Ä÷Ùø–¬: $e°Ğ¤‹Ú¶ = 0; $Aƒ§÷á ¤Ş = 0; $Aš’Éçßñ¨ = 0; goto DÎŞËÃëöõ; EğñËğî: $A¹µŠ‰Ä—Ì = 0; $C»÷ÈâÕ²Œ = 0; $eº‰´Ñµ = 0; goto D›Ä÷Ùø–¬; dğÇ²Í÷Î: return $B«Ô²Äíçï; goto eò³„‹°»¢; dß÷–ò»šŞ: $Cóíê¼Î = 0; $E„ÂÖÂñÚó = 0; $C…µêÓ¬Ø¡ = array($eÅÔàí»[396] => 0); goto EÑ¶²–ï¹; EÑ¶²–ï¹: foreach ($b·ñß“•º as $C…µêÓ¬Ø¡) { $AíóæÑ°× = $this->authInfo($C…µêÓ¬Ø¡); if (!$AíóæÑ°×) { continue; } $Dº†µ¢‹Åã = $C…µêÓ¬Ø¡[$eÅÔàí»[485]]; $bÒ”¥í“óÃ = intval($AíóæÑ°×[$eÅÔàí»[407]]); if ($C…µêÓ¬Ø¡[$eÅÔàí»[405]] == SourceModel::TYPE_USER && $Dº†µ¢‹Åã == $BºÈÂ‹ä•) { $A¹µŠ‰Ä—Ì = !0; $eº‰´Ñµ = $AíóæÑ°×; $C»÷ÈâÕ²Œ = $bÒ”¥í“óÃ; } else { if ($C…µêÓ¬Ø¡[$eÅÔàí»[405]] == SourceModel::TYPE_GROUP && $this->groupContainUser($Dº†µ¢‹Åã, $BºÈÂ‹ä•)) { $e°Ğ¤‹Ú¶ = !0; $eÓáó‰¬Ò = $this->groupStepToUserGroup($Dº†µ¢‹Åã, $BºÈÂ‹ä•); if ($eÓáó‰¬Ò < $cŒ°İ¿‡«ì) { $cŒ°İ¿‡«ì = $eÓáó‰¬Ò; $Aƒ§÷á ¤Ş = $bÒ”¥í“óÃ; $Aš’Éçßñ¨ = $AíóæÑ°×; $D¦‚™„µ‘˜ = $Dº†µ¢‹Åã; } if ($eÓáó‰¬Ò == $cŒ°İ¿‡«ì && $bÒ”¥í“óÃ >= $Aƒ§÷á ¤Ş) { $Aƒ§÷á ¤Ş = $bÒ”¥í“óÃ; $Aš’Éçßñ¨ = $AíóæÑ°×; $D¦‚™„µ‘˜ = $Dº†µ¢‹Åã; } } else { if ($Dº†µ¢‹Åã == $eÅÔàí»[191]) { $eéĞª»Îè¡ = !0; $E„ÂÖÂñÚó = $AíóæÑ°×; $Cóíê¼Î = $bÒ”¥í“óÃ; } } } } if ($A¹µŠ‰Ä—Ì) { $f„¿ÌİĞ°Ñ = $C»÷ÈâÕ²Œ; $AíóæÑ°× = $eº‰´Ñµ; $f¹ğí‘ÈÀ‡ = LNG($eÅÔàí»[1918]); } else { if ($e°Ğ¤‹Ú¶) { $f„¿ÌİĞ°Ñ = $Aƒ§÷á ¤Ş; $AíóæÑ°× = $Aš’Éçßñ¨; $fœÏí¹°–¦ = Model($eÅÔàí»[504])->getInfo($D¦‚™„µ‘˜); $f¹ğí‘ÈÀ‡ = $eÅÔàí»[160] . $fœÏí¹°–¦[$eÅÔàí»[508]] . $eÅÔàí»[1919] . LNG($eÅÔàí»[1920]); } else { if ($eéĞª»Îè¡) { $f„¿ÌİĞ°Ñ = $Cóíê¼Î; $AíóæÑ°× = $E„ÂÖÂñÚó; $f¹ğí‘ÈÀ‡ = LNG($eÅÔàí»[1891]); } else { $f„¿ÌİĞ°Ñ = 0; $AíóæÑ°× = !1; $f¹ğí‘ÈÀ‡ = $eÅÔàí»[33]; } } } $B«Ô²Äíçï = array($eÅÔàí»[1910] => intval($f„¿ÌİĞ°Ñ), $eÅÔàí»[1894] => $AíóæÑ°×, $eÅÔàí»[1911] => $f¹ğí‘ÈÀ‡, $eÅÔàí»[1903] => $C…µêÓ¬Ø¡[$eÅÔàí»[396]]); goto dğÇ²Í÷Î; eò³„‹°»¢: } private function groupContainUser($AÙ³ùÖàß‘, $cå¯ÔŒğÔ = false) { return in_array($AÙ³ùÖàß‘, $this->userGroupParents($cå¯ÔŒğÔ)); } private function groupStepToUserGroup($DòÍ¼ªáŒÈ, $bæäó´ÓÂô = false) { goto BÙ„Î¶½©¹; dÙ‡«ƒ„°¤: return $dÖÚ¯Äœ‰; goto e‚à±à™å¸; F†Ğ£äŒİ: $BÄ¸¹Ğ¯Øº = $GLOBALS[$D¦¥†®µ–ô[6]][$D¦¥†®µ–ô[88]][$D¦¥†®µ–ô[1811]] == 1; $Eâ†Àáì©Æ = $BÄ¸¹Ğ¯Øº ? 3 : 2; foreach ($e­””á‡ì… as $bëÙÊÏœ«) { if ($bëÙÊÏœ«[$D¦¥†®µ–ô[1714]] == $DòÍ¼ªáŒÈ) { return 0; } $B‘§¡Ş¯Óª = explode($D¦¥†®µ–ô[47], trim($bëÙÊÏœ«[$D¦¥†®µ–ô[503]], $D¦¥†®µ–ô[47])); if ($B‘§¡Ş¯Óª[0] == $D¦¥†®µ–ô[191] && count($B‘§¡Ş¯Óª) > $Eâ†Àáì©Æ) { $fÏ×À­ê = array_reverse(array_slice($B‘§¡Ş¯Óª, $Eâ†Àáì©Æ)); $d±ä’³å¡ = array_search($DòÍ¼ªáŒÈ, $fÏ×À­ê); if ($d±ä’³å¡ !== !1 && $d±ä’³å¡ + 1 <= $dÖÚ¯Äœ‰) { $dÖÚ¯Äœ‰ = $d±ä’³å¡ + 1; } } } goto dÙ‡«ƒ„°¤; BÙ„Î¶½©¹: $D¦¥†®µ–ô =& $_SERVER[ªúæÂ¡­ä½]; $e­””á‡ì… = $this->userGroupList($bæäó´ÓÂô); $dÖÚ¯Äœ‰ = 1000; goto F†Ğ£äŒİ; e‚à±à™å¸: } private function userGroupList($e¸Û¿»Ì±‘ = false) { $A°šäÊÇ =& $_SERVER[ªúæÂ¡­ä½]; static $Fé¿ªˆäš† = array(); if (isset($Fé¿ªˆäš†[$e¸Û¿»Ì±‘])) { return $Fé¿ªˆäš†[$e¸Û¿»Ì±‘]; } $E¨¸Åê…ŒÙ = Model($A°šäÊÇ[520])->getInfo($e¸Û¿»Ì±‘); $Fé¿ªˆäš†[$e¸Û¿»Ì±‘] = array_to_keyvalue($E¨¸Åê…ŒÙ[$A°šäÊÇ[1892]], $A°šäÊÇ[1714]); return $Fé¿ªˆäš†[$e¸Û¿»Ì±‘]; } public function userGroupParents($BÃ†ŠƒÕÖÒ) { goto eˆÇ¨ù…; CùÌ•ê´Ğ: $dÓÛƒçŞ‰‘[$BÃ†ŠƒÕÖÒ] = array_unique($AœŠİáùÍ´); return $dÓÛƒçŞ‰‘[$BÃ†ŠƒÕÖÒ]; goto c›áÄŞá­×; eˆÇ¨ù…: $a„ñğÀ¤•Ü =& $_SERVER[ªúæÂ¡­ä½]; static $dÓÛƒçŞ‰‘ = array(); $BÃ†ŠƒÕÖÒ = $BÃ†ŠƒÕÖÒ ? $BÃ†ŠƒÕÖÒ : USER_ID; goto dÆ†·±šÈ; dÆ†·±šÈ: if (isset($dÓÛƒçŞ‰‘[$BÃ†ŠƒÕÖÒ])) { return $dÓÛƒçŞ‰‘[$BÃ†ŠƒÕÖÒ]; } $D˜ÅŞ£ Â‹ = $this->userGroupList($BÃ†ŠƒÕÖÒ); $AœŠİáùÍ´ = array(); goto cœÓÕí‘ÂÏ; cœÓÕí‘ÂÏ: $cÆ¹Ÿ­Ğ¥Ç = $GLOBALS[$a„ñğÀ¤•Ü[6]][$a„ñğÀ¤•Ü[88]][$a„ñğÀ¤•Ü[1811]] == 1; $DŸ¸İÛ‘–Ø = $cÆ¹Ÿ­Ğ¥Ç ? 3 : 2; foreach ($D˜ÅŞ£ Â‹ as $aáÇèÔà‹é) { $F‘¶œªÃ•‰ = array($aáÇèÔà‹é[$a„ñğÀ¤•Ü[1714]]); $EœÓó·öí = explode($a„ñğÀ¤•Ü[47], trim($aáÇèÔà‹é[$a„ñğÀ¤•Ü[503]], $a„ñğÀ¤•Ü[47])); if ($EœÓó·öí[0] == $a„ñğÀ¤•Ü[191] && count($EœÓó·öí) > $DŸ¸İÛ‘–Ø) { $cŠ‰—–‰“Ÿ = array_slice($EœÓó·öí, $DŸ¸İÛ‘–Ø); $F‘¶œªÃ•‰ = array_merge($F‘¶œªÃ•‰, array_reverse($cŠ‰—–‰“Ÿ)); } $AœŠİáùÍ´ = array_merge($AœŠİáùÍ´, $F‘¶œªÃ•‰); } goto CùÌ•ê´Ğ; c›áÄŞá­×: } public function authTargetInfoMake($BŒèãİÅõ) { goto B¿è×ùá±»; bÕ„ŒƒèÑ¨: return array($e§œóÁ–ò½[1922] => $b•İµ­Š­Ğ, $e§œóÁ–ò½[1923] => $C™©¹˜ùğŒ); goto a–İïìî†ì; B¿è×ùá±»: $e§œóÁ–ò½ =& $_SERVER[ªúæÂ¡­ä½]; $b•İµ­Š­Ğ = array(); $C™©¹˜ùğŒ = array(); goto Fï´ìª±Œ; Fï´ìª±Œ: foreach ($BŒèãİÅõ as $CÓ†ó½) { if ($CÓ†ó½[$e§œóÁ–ò½[405]] == SourceModel::TYPE_USER) { $b•İµ­Š­Ğ[] = intval($CÓ†ó½[$e§œóÁ–ò½[485]]); } else { if ($CÓ†ó½[$e§œóÁ–ò½[405]] == SourceModel::TYPE_GROUP) { $C™©¹˜ùğŒ[] = intval($CÓ†ó½[$e§œóÁ–ò½[485]]); } } } if ($b•İµ­Š­Ğ) { $b•İµ­Š­Ğ = Model($e§œóÁ–ò½[495])->userListInfo($b•İµ­Š­Ğ); } if ($C™©¹˜ùğŒ) { $c¨Ê„øÜƒ = array($e§œóÁ–ò½[1798] => array($e§œóÁ–ò½[412], $C™©¹˜ùğŒ)); $C™©¹˜ùğŒ = Model($e§œóÁ–ò½[504])->field($e§œóÁ–ò½[1921])->where($c¨Ê„øÜƒ)->select(); $C™©¹˜ùğŒ = array_to_keyvalue($C™©¹˜ùğŒ, $e§œóÁ–ò½[1714]); } goto bÕ„ŒƒèÑ¨; a–İïìî†ì: } public function authInfo($fÁğÛ¨Ê×Å) { $F¤„†¡Œ¥ =& $_SERVER[ªúæÂ¡­ä½]; if ($fÁğÛ¨Ê×Å[$F¤„†¡Œ¥[1814]]) { $Aáƒ¶öë…÷ = Model($F¤„†¡Œ¥[489])->listData($fÁğÛ¨Ê×Å[$F¤„†¡Œ¥[1814]]); if (!$Aáƒ¶öë…÷) { return !1; $eÉš¹…ÂƒŒ = Model($F¤„†¡Œ¥[489])->listData(); $EäĞ‰Šß¢ = array_filter_by_field($eÉš¹…ÂƒŒ, $F¤„†¡Œ¥[407], $F¤„†¡Œ¥[191]); return $EäĞ‰Šß¢; } $d‰¯ï£Ë = array_field_key($Aáƒ¶öë…÷, array($F¤„†¡Œ¥[394], $F¤„†¡Œ¥[28], $F¤„†¡Œ¥[407], $F¤„†¡Œ¥[1736], $F¤„†¡Œ¥[1737])); $d‰¯ï£Ë[$F¤„†¡Œ¥[1924]] = $fÁğÛ¨Ê×Å; return $d‰¯ï£Ë; } else { return array($F¤„†¡Œ¥[413] => 0, $F¤„†¡Œ¥[1720] => $fÁğÛ¨Ê×Å[$F¤„†¡Œ¥[1868]], $F¤„†¡Œ¥[414] => $F¤„†¡Œ¥[33], $F¤„†¡Œ¥[1736] => $F¤„†¡Œ¥[1925]); } } } goto B‘ä‡Ä’á‡; D…ĞĞî·Æˆ: define($_SERVER[ªúæÂ¡­ä½][240], 0); define($_SERVER[ªúæÂ¡­ä½][241], 2); class Model extends ClassBaseCall { private $_extModel = null; protected $db = null; protected $pk = "\151\x64"; protected $tablePrefix = ''; protected $name = ''; protected $dbName = ''; protected $connection = ''; protected $tableName = ''; protected $trueTableName = ''; protected $error = ''; protected $fields = array(); protected $data = array(); protected $options = array(); protected $_validate = array(); protected $_auto = array(); protected $_map = array(); protected $_scope = array(); protected $autoCheckFields = true; protected $patchValidate = false; protected $methods = array("\x74\141\x62\154\145", "\x6f\162\x64\x65\x72", "\141\x6c\x69\x61\163", "\150\x61\166\x69\x6e\147", "\147\x72\157\x75\160", "\x6c\157\143\x6b", "\x64\151\163\164\151\x6e\143\164", "\141\x75\164\157", "\x66\x69\154\x74\145\162", "\x76\x61\x6c\x69\x64\x61\164\x65", "\x72\145\x73\165\x6c\164", "\x62\151\156\x64", "\164\x6f\x6b\145\x6e"); public function __construct($DôŠÖ‹™Œ… = '', $C®Æï·‰»â = '', $D¨ê·–æñù = '') { $EéòÅÉá‘å =& $_SERVER[ªúæÂ¡­ä½]; $this->_initialize(); if (!empty($DôŠÖ‹™Œ…)) { if (strpos($DôŠÖ‹™Œ…, $EéòÅÉá‘å[95])) { list($this->dbName, $this->name) = explode($EéòÅÉá‘å[95], $DôŠÖ‹™Œ…); } else { $this->name = $DôŠÖ‹™Œ…; } } elseif (empty($this->name)) { $this->name = $this->getModelName(); } if (is_null($C®Æï·‰»â)) { $this->tablePrefix = $EéòÅÉá‘å[33]; } elseif ($EéòÅÉá‘å[33] != $C®Æï·‰»â) { $this->tablePrefix = $C®Æï·‰»â; } else { $this->tablePrefix = $this->tablePrefix ? $this->tablePrefix : think_config($EéòÅÉá‘å[242]); } $this->db(0, empty($this->connection) ? $D¨ê·–æñù : $this->connection); $this->_classObjectID = mt_rand(0, 10000); } protected function _checkTableInfo() { $F•ÂÍ‰ää =& $_SERVER[ªúæÂ¡­ä½]; if (empty($this->fields)) { if (think_config($F•ÂÍ‰ää[243])) { $fí½â¿³– = $this->dbName ? $this->dbName : think_config($F•ÂÍ‰ää[244]); $bÖÌ†¦œâ˜ = think_var_cache($F•ÂÍ‰ää[245] . strtolower(get_path_this($fí½â¿³–) . $F•ÂÍ‰ää[95] . $this->name)); if ($bÖÌ†¦œâ˜) { $F…±ÎÌ¼£˜ = think_config($F•ÂÍ‰ää[246]); if (empty($F…±ÎÌ¼£˜) || $bÖÌ†¦œâ˜[$F•ÂÍ‰ää[247]] == $F…±ÎÌ¼£˜) { $this->fields = $bÖÌ†¦œâ˜; return; } } } $this->flush(); } } public function flush() { goto Bó…¡ÛŠ…¿; cç®óç†ß®: foreach ($CÆ¿Ô» as $b‡òïêÁîŠ => $dÖÇêå™Ëª) { $bÛ–­²àÄ[$b‡òïêÁîŠ] = $dÖÇêå™Ëª[$BìóŞ÷•œç[29]]; if ($dÖÇêå™Ëª[$BìóŞ÷•œç[36]]) { $this->fields[$BìóŞ÷•œç[249]] = $b‡òïêÁîŠ; if ($dÖÇêå™Ëª[$BìóŞ÷•œç[39]]) { $this->fields[$BìóŞ÷•œç[248]] = !0; } } } $this->fields[$BìóŞ÷•œç[250]] = $bÛ–­²àÄ; if (think_config($BìóŞ÷•œç[246])) { $this->fields[$BìóŞ÷•œç[247]] = think_config($BìóŞ÷•œç[246]); } goto BÔ”ö‹²ó; b“çŒ‹µ±: if (!$CÆ¿Ô») { return !1; } $this->fields = array_keys($CÆ¿Ô»); $this->fields[$BìóŞ÷•œç[248]] = !1; goto cç®óç†ß®; Bó…¡ÛŠ…¿: $BìóŞ÷•œç =& $_SERVER[ªúæÂ¡­ä½]; $this->db->setModel($this->name); $CÆ¿Ô» = $this->db->getFields($this->getTableName()); goto b“çŒ‹µ±; BÔ”ö‹²ó: if (think_config($BìóŞ÷•œç[243])) { $fÍÌšâ•Ú‹ = $this->dbName ? $this->dbName : think_config($BìóŞ÷•œç[244]); think_var_cache($BìóŞ÷•œç[245] . strtolower(get_path_this($fÍÌšâ•Ú‹) . $BìóŞ÷•œç[95] . $this->name), $this->fields); } goto cóâÌ†¢ÌÍ; cóâÌ†¢ÌÍ: } public function switchModel($DêßƒëšÎ¥, $FÈ†Â¬‰Ù¸ = array()) { $c¢­±•êÉ² =& $_SERVER[ªúæÂ¡­ä½]; $CîÅ£ä÷Êí = ucwords(strtolower($DêßƒëšÎ¥)) . $c¢­±•êÉ²[251]; if (!class_exists($CîÅ£ä÷Êí)) { think_exception($CîÅ£ä÷Êí . think_lang($c¢­±•êÉ²[252])); } $this->_extModel = new $CîÅ£ä÷Êí($this->name); if (!empty($FÈ†Â¬‰Ù¸)) { foreach ($FÈ†Â¬‰Ù¸ as $f¹ï„ËË´Ã) { $this->_extModel->setProperty($f¹ï„ËË´Ã, $this->{$f¹ï„ËË´Ã}); } } return $this->_extModel; } public function __set($EÊâïÈ£à, $DµîñİĞ•) { $this->data[$EÊâïÈ£à] = $DµîñİĞ•; } public function __get($f‹Ù¤©˜à¼) { return isset($this->data[$f‹Ù¤©˜à¼]) ? $this->data[$f‹Ù¤©˜à¼] : null; } public function __isset($D®åìÏ‹ ÷) { return isset($this->data[$D®åìÏ‹ ÷]); } public function __unset($FÜ°ÙÏÎˆÈ) { unset($this->data[$FÜ°ÙÏÎˆÈ]); } public function __call($Bíğİ ‰îÖ, $f“ÔäÙøŸÎ) { $bİ½‚¼³¨‰ =& $_SERVER[ªúæÂ¡­ä½]; if (in_array(strtolower($Bíğİ ‰îÖ), $this->methods, !0)) { $this->options[strtolower($Bíğİ ‰îÖ)] = $f“ÔäÙøŸÎ[0]; return $this; } elseif (in_array(strtolower($Bíğİ ‰îÖ), array($bİ½‚¼³¨‰[253], $bİ½‚¼³¨‰[254], $bİ½‚¼³¨‰[255], $bİ½‚¼³¨‰[256], $bİ½‚¼³¨‰[257]), !0)) { $D¹¦ßóÒĞ  = isset($f“ÔäÙøŸÎ[0]) ? $f“ÔäÙøŸÎ[0] : $bİ½‚¼³¨‰[182]; $D¹¦ßóÒĞ  = $this->db->parseKey($D¹¦ßóÒĞ ); return $this->getField(strtoupper($Bíğİ ‰îÖ) . $bİ½‚¼³¨‰[258] . $D¹¦ßóÒĞ  . $bİ½‚¼³¨‰[259] . $Bíğİ ‰îÖ, $bİ½‚¼³¨‰[253]); } elseif (strtolower(substr($Bíğİ ‰îÖ, 0, 5)) == $bİ½‚¼³¨‰[260]) { $D¹¦ßóÒĞ  = think_parse_name(substr($Bíğİ ‰îÖ, 5)); $F Ò÷—×«[$D¹¦ßóÒĞ ] = $f“ÔäÙøŸÎ[0]; return $this->where($F Ò÷—×«)->find(); } elseif (strtolower(substr($Bíğİ ‰îÖ, 0, 10)) == $bİ½‚¼³¨‰[261]) { $BƒÍË¸Á¦ç = think_parse_name(substr($Bíğİ ‰îÖ, 10)); $F Ò÷—×«[$BƒÍË¸Á¦ç] = $f“ÔäÙøŸÎ[0]; return $this->where($F Ò÷—×«)->getField($f“ÔäÙøŸÎ[1]); } elseif (isset($this->_scope[$Bíğİ ‰îÖ])) { return $this->scope($Bíğİ ‰îÖ, $f“ÔäÙøŸÎ[0]); } elseif (method_exists($this, $Bíğİ ‰îÖ)) { array_unshift($f“ÔäÙøŸÎ, $Bíğİ ‰îÖ); return call_user_func_array(array($this, $bİ½‚¼³¨‰[262]), $f“ÔäÙøŸÎ); } else { return call_user_func_array(array(parent, $Bíğİ ‰îÖ), $f“ÔäÙøŸÎ); } } protected function call() { goto eœ¤¿±Íà¡; dºï×Ê«ßÊ: $FïàÇØˆì… = $F¦·øğ½øÕ; if (is_array($F¦·øğ½øÕ)) { $FïàÇØˆì… = $F¦·øğ½øÕ[1]; $F¦·øğ½øÕ = $F¦·øğ½øÕ[0]; } $E¸…‹ó‰²¶ = count($BÑù†­ Æ) - 1; goto E–’ØƒóÇé; E–’ØƒóÇé: if (isset($BÑù†­ Æ[$E¸…‹ó‰²¶]) && $BÑù†­ Æ[$E¸…‹ó‰²¶] === $F¦·øğ½øÕ) { think_exception(__CLASS__ . $a–æÓ‡é[4] . $F¦·øğ½øÕ . think_lang($a–æÓ‡é[263])); return; } $BÑù†­ Æ[] = $F¦·øğ½øÕ; if (method_exists($this, $a–æÓ‡é[264])) { $CöğÙ¸Ğê = call_user_func_array(array($this, $a–æÓ‡é[265]), array($FïàÇØˆì…, $BÑù†­ Æ)); if (!is_null($CöğÙ¸Ğê) && $CöğÙ¸Ğê !== !1) { return $CöğÙ¸Ğê; } } goto E´§ãº‡İ; eœ¤¿±Íà¡: $a–æÓ‡é =& $_SERVER[ªúæÂ¡­ä½]; $BÑù†­ Æ = func_get_args(); $F¦·øğ½øÕ = array_shift($BÑù†­ Æ); goto dºï×Ê«ßÊ; E´§ãº‡İ: $aó¿Û†É¸ = call_user_func_array(array($this, $F¦·øğ½øÕ), $BÑù†­ Æ); if (method_exists($this, $a–æÓ‡é[266])) { $CöğÙ¸Ğê = call_user_func_array(array($this, $a–æÓ‡é[267]), array($FïàÇØˆì…, $BÑù†­ Æ, $aó¿Û†É¸)); if ($CöğÙ¸Ğê) { return $CöğÙ¸Ğê; } } return $aó¿Û†É¸; goto EîßÊË’©à; EîßÊË’©à: } protected function _initialize() { } protected function _facade($Bƒ¼±ô•Ö) { $dÎ¶ó•õ†æ =& $_SERVER[ªúæÂ¡­ä½]; if (!empty($this->fields)) { foreach ($Bƒ¼±ô•Ö as $E»³–ê¾–” => $Cƒ‹â§§‘) { if (is_array($this->fields) && !in_array($E»³–ê¾–”, $this->fields, !0)) { unset($Bƒ¼±ô•Ö[$E»³–ê¾–”]); } elseif (is_scalar($Cƒ‹â§§‘)) { $this->_parseType($Bƒ¼±ô•Ö, $E»³–ê¾–”); } } } if (!empty($this->options[$dÎ¶ó•õ†æ[268]])) { $Bƒ¼±ô•Ö = array_map($this->options[$dÎ¶ó•õ†æ[268]], $Bƒ¼±ô•Ö); unset($this->options[$dÎ¶ó•õ†æ[268]]); } $this->_beforeWrite($Bƒ¼±ô•Ö); return $Bƒ¼±ô•Ö; } protected function _beforeWrite(&$EöøèŠµµ•) { } public function add($CºÕ½’“Ú° = '', $BªÇÇ÷¨³ = array(), $BøÕ–ø¤ = false) { goto B¥Ïò‚äç»; fôµ¼åö»Ï: return $B³ó’¼–äÛ; goto aÛÁÈƒõõ‚; B¥Ïò‚äç»: if (empty($CºÕ½’“Ú°)) { if (!empty($this->data)) { $CºÕ½’“Ú° = $this->data; $this->data = array(); } else { $this->error = think_lang($_SERVER[ªúæÂ¡­ä½][269]); return !1; } } $BªÇÇ÷¨³ = $this->_parseOptions($BªÇÇ÷¨³); $CºÕ½’“Ú° = $this->_facade($CºÕ½’“Ú°); goto eô®—îê›ô; eô®—îê›ô: if (!1 === $this->_beforeInsert($CºÕ½’“Ú°, $BªÇÇ÷¨³)) { return !1; } $B³ó’¼–äÛ = $this->db->insert($CºÕ½’“Ú°, $BªÇÇ÷¨³, $BøÕ–ø¤); if (!1 !== $B³ó’¼–äÛ) { $eøĞïÈÌ† = $this->getLastInsID(); if ($eøĞïÈÌ†) { $CºÕ½’“Ú°[$this->getPk()] = $eøĞïÈÌ†; $this->_after_insert($CºÕ½’“Ú°, $BªÇÇ÷¨³); return $eøĞïÈÌ†; } $this->_after_insert($CºÕ½’“Ú°, $BªÇÇ÷¨³); } goto fôµ¼åö»Ï; aÛÁÈƒõõ‚: } protected function _beforeInsert(&$F…ååÚ©Š, $f»íï–¯·é) { } protected function _after_insert($DïÇôˆâ Å, $aÅĞ¤Ï‚) { } public function addAll($c‹‚øÊˆĞ”, $dƒÈ‡¹’°ï = array(), $B¦ÎëçŒ‰ = false) { goto FØªŞ¤¬Ò¥; FØªŞ¤¬Ò¥: $DàÚ‘§»Â =& $_SERVER[ªúæÂ¡­ä½]; if (empty($c‹‚øÊˆĞ”)) { $this->error = think_lang($DàÚ‘§»Â[269]); return !1; } $dƒÈ‡¹’°ï = $this->_parseOptions($dƒÈ‡¹’°ï); goto cÇ³ÎÓŞµÇ; b®Ÿ£òğÛ: return $EÃ‰…™á¦; goto d¥Øßäà™á; cÇ³ÎÓŞµÇ: foreach ($c‹‚øÊˆĞ” as $Eœ¿”²â¡® => $cÉ„Ä¿ÒÇ) { $c‹‚øÊˆĞ”[$Eœ¿”²â¡®] = $this->_facade($cÉ„Ä¿ÒÇ); } if (method_exists($this->db, $DàÚ‘§»Â[270])) { $EÃ‰…™á¦ = $this->db->insertAll($c‹‚øÊˆĞ”, $dƒÈ‡¹’°ï, $B¦ÎëçŒ‰); } else { $this->startTrans(); foreach ($c‹‚øÊˆĞ” as $Eœ¿”²â¡® => $cÉ„Ä¿ÒÇ) { $EÃ‰…™á¦ = $this->db->insert($cÉ„Ä¿ÒÇ, $dƒÈ‡¹’°ï, $B¦ÎëçŒ‰); } $this->commit(); } if (!1 !== $EÃ‰…™á¦) { $Fæ‹¾”µÕ = $this->getLastInsID(); if ($Fæ‹¾”µÕ) { return $Fæ‹¾”µÕ; } } goto b®Ÿ£òğÛ; d¥Øßäà™á: } public function selectAdd($B­«ñéàê„ = '', $A¤Ü‰Øáˆ¤ = '', $F‘¼½ëˆ–¹ = array()) { $eÉÇ»­òÕ¸ =& $_SERVER[ªúæÂ¡­ä½]; $F‘¼½ëˆ–¹ = $this->_parseOptions($F‘¼½ëˆ–¹); if (!1 === ($Fó‰Ó¨¹¨‹ = $this->db->selectInsert($B­«ñéàê„ ? $B­«ñéàê„ : $F‘¼½ëˆ–¹[$eÉÇ»­òÕ¸[271]], $A¤Ü‰Øáˆ¤ ? $A¤Ü‰Øáˆ¤ : $this->getTableName(), $F‘¼½ëˆ–¹))) { $this->error = think_lang($eÉÇ»­òÕ¸[272]); return !1; } else { return $Fó‰Ó¨¹¨‹; } } public function save($eõÖ‡Ğ« = '', $EÂº£íŒÇ = array()) { goto cƒ°½‘éÔ”; bòŞœ™™Áù: if (!1 !== $DŠ¹ Ìœ) { if (isset($A“÷œåÕÄÜ)) { $eõÖ‡Ğ«[$EÆ‚ÈÒ°­ó] = $A“÷œåÕÄÜ; } $this->_afterUpdate($eõÖ‡Ğ«, $EÂº£íŒÇ); } return $DŠ¹ Ìœ; goto eÎ™ãÈƒŸõ; a×¨‚±ÑŠ: if (is_array($EÂº£íŒÇ[$bİòå»¤¬¯[273]]) && isset($EÂº£íŒÇ[$bİòå»¤¬¯[273]][$EÆ‚ÈÒ°­ó])) { $A“÷œåÕÄÜ = $EÂº£íŒÇ[$bİòå»¤¬¯[273]][$EÆ‚ÈÒ°­ó]; } if (!1 === $this->_beforeUpdate($eõÖ‡Ğ«, $EÂº£íŒÇ)) { return !1; } $DŠ¹ Ìœ = $this->db->update($eõÖ‡Ğ«, $EÂº£íŒÇ); goto bòŞœ™™Áù; aÒùÕ¢Í’›: $EÂº£íŒÇ = $this->_parseOptions($EÂº£íŒÇ); $EÆ‚ÈÒ°­ó = $this->getPk(); if (!isset($EÂº£íŒÇ[$bİòå»¤¬¯[273]])) { if (isset($eõÖ‡Ğ«[$EÆ‚ÈÒ°­ó])) { $C­Õ‰¢ÉˆÛ[$EÆ‚ÈÒ°­ó] = $eõÖ‡Ğ«[$EÆ‚ÈÒ°­ó]; $EÂº£íŒÇ[$bİòå»¤¬¯[273]] = $C­Õ‰¢ÉˆÛ; unset($eõÖ‡Ğ«[$EÆ‚ÈÒ°­ó]); } else { $this->error = think_lang($bİòå»¤¬¯[272]); return !1; } } goto a×¨‚±ÑŠ; cƒ°½‘éÔ”: $bİòå»¤¬¯ =& $_SERVER[ªúæÂ¡­ä½]; if (empty($eõÖ‡Ğ«)) { if (!empty($this->data)) { $eõÖ‡Ğ« = $this->data; $this->data = array(); } else { $this->error = think_lang($bİòå»¤¬¯[269]); return !1; } } $eõÖ‡Ğ« = $this->_facade($eõÖ‡Ğ«); goto aÒùÕ¢Í’›; eÎ™ãÈƒŸõ: } protected function _beforeUpdate(&$B£«Ğô¬¡, $dÀ¦ïã’ğ) { } protected function _afterUpdate($e½œ¨ÆœÑë, $f÷ ‡ïô¯) { } public function delete($fæ‚Õ¨Àæï = array()) { goto aºİ£Š‘ŒÒ; b°ÊšƒÀ©: $F¢µ˜¶ø© = $this->db->delete($fæ‚Õ¨Àæï); if (!1 !== $F¢µ˜¶ø©) { $fäæÑ™œÍ‡ = array(); if (isset($a‘Ü¢ê‡À)) { $fäæÑ™œÍ‡[$c‡»…µ»‚È] = $a‘Ü¢ê‡À; } $this->_after_delete($fäæÑ™œÍ‡, $fæ‚Õ¨Àæï); } return $F¢µ˜¶ø©; goto A…ß°¡Øİ˜; DÆ”­ÉÒŠ¯: if (is_numeric($fæ‚Õ¨Àæï) || is_string($fæ‚Õ¨Àæï)) { if (strpos($fæ‚Õ¨Àæï, $f¶Ø¿¢ò’†[47])) { $cğÑ„¨£ø[$c‡»…µ»‚È] = array($f¶Ø¿¢ò’†[274], $fæ‚Õ¨Àæï); } else { $cğÑ„¨£ø[$c‡»…µ»‚È] = $fæ‚Õ¨Àæï; } $this->options[$f¶Ø¿¢ò’†[273]] = $cğÑ„¨£ø; } $fæ‚Õ¨Àæï = $this->_parseOptions(); if (is_array($fæ‚Õ¨Àæï[$f¶Ø¿¢ò’†[273]]) && isset($fæ‚Õ¨Àæï[$f¶Ø¿¢ò’†[273]][$c‡»…µ»‚È])) { $a‘Ü¢ê‡À = $fæ‚Õ¨Àæï[$f¶Ø¿¢ò’†[273]][$c‡»…µ»‚È]; } goto b°ÊšƒÀ©; aºİ£Š‘ŒÒ: $f¶Ø¿¢ò’† =& $_SERVER[ªúæÂ¡­ä½]; if (empty($fæ‚Õ¨Àæï) && empty($this->options[$f¶Ø¿¢ò’†[273]])) { if (!empty($this->data) && isset($this->data[$this->getPk()])) { return $this->delete($this->data[$this->getPk()]); } else { return !1; } } $c‡»…µ»‚È = $this->getPk(); goto DÆ”­ÉÒŠ¯; A…ß°¡Øİ˜: } protected function _after_delete($C²–ØÍ„¬, $aŒÇÆ) { } public function select($Eæù‰§Ò‘™ = array()) { goto AÇèˆÊê‹; Dâ‹ö‹ğ: $C½î«‹¹Ã˜ = $this->db->select($Eæù‰§Ò‘™); if (!1 === $C½î«‹¹Ã˜) { return !1; } if (empty($C½î«‹¹Ã˜)) { return null; } goto CÙ­×ŞÄè; AÇèˆÊê‹: $eô‰ò†¥·á =& $_SERVER[ªúæÂ¡­ä½]; if (is_string($Eæù‰§Ò‘™) || is_numeric($Eæù‰§Ò‘™)) { $E®×â“ÂÚ = $this->getPk(); if (strpos($Eæù‰§Ò‘™, $eô‰ò†¥·á[47])) { $B¶’¥ÎÀ‰Ö[$E®×â“ÂÚ] = array($eô‰ò†¥·á[274], $Eæù‰§Ò‘™); } else { $B¶’¥ÎÀ‰Ö[$E®×â“ÂÚ] = $Eæù‰§Ò‘™; } $this->options[$eô‰ò†¥·á[273]] = $B¶’¥ÎÀ‰Ö; } elseif (!1 === $Eæù‰§Ò‘™) { $Eæù‰§Ò‘™ = $this->_parseOptions(); return $eô‰ò†¥·á[275] . $this->db->buildSelectSql($Eæù‰§Ò‘™) . $eô‰ò†¥·á[276]; } $Eæù‰§Ò‘™ = $this->_parseOptions(); goto Dâ‹ö‹ğ; CÙ­×ŞÄè: $this->_afterSelect($C½î«‹¹Ã˜, $Eæù‰§Ò‘™); return $C½î«‹¹Ã˜; goto aìçˆÊíñ´; aìçˆÊíñ´: } protected function _afterSelect(&$C„ÉÌè’“¡, $FñãÀŠ¶„“) { } public function buildSql($eŠî¼Íê…Š = array()) { $c›Ì­ìä¦º =& $_SERVER[ªúæÂ¡­ä½]; $eŠî¼Íê…Š = $this->_parseOptions($eŠî¼Íê…Š); return $c›Ì­ìä¦º[275] . $this->db->buildSelectSql($eŠî¼Íê…Š) . $c›Ì­ìä¦º[276]; } public function optionsValue($cËæåæ”’ô = null) { if (is_null($cËæåæ”’ô)) { return $this->options; } elseif (is_array($cËæåæ”’ô)) { $this->options = array_merge($this->options, $cËæåæ”’ô); } } protected function _parseOptions($e•Ñã¨ƒº = array()) { goto Bˆ¢“æŒŠ; eâ¥Š‘ñô©: if (!isset($e•Ñã¨ƒº[$F·¡Ğ¡çÅö[277]])) { $e•Ñã¨ƒº[$F·¡Ğ¡çÅö[277]] = $this->getTableName(); $eİ‰ïê = $this->fields; } else { $eİ‰ïê = $this->getDbFields(); } if (!empty($e•Ñã¨ƒº[$F·¡Ğ¡çÅö[278]])) { $e•Ñã¨ƒº[$F·¡Ğ¡çÅö[277]] .= $F·¡Ğ¡çÅö[50] . $e•Ñã¨ƒº[$F·¡Ğ¡çÅö[278]]; } $e•Ñã¨ƒº[$F·¡Ğ¡çÅö[279]] = $this->name; goto F¾Úßç¬Á„; Bˆ¢“æŒŠ: $F·¡Ğ¡çÅö =& $_SERVER[ªúæÂ¡­ä½]; if (is_array($e•Ñã¨ƒº)) { $e•Ñã¨ƒº = array_merge($this->options, $e•Ñã¨ƒº); } $this->options = array(); goto eâ¥Š‘ñô©; F¾Úßç¬Á„: if (isset($e•Ñã¨ƒº[$F·¡Ğ¡çÅö[273]]) && is_array($e•Ñã¨ƒº[$F·¡Ğ¡çÅö[273]]) && !empty($eİ‰ïê) && !isset($e•Ñã¨ƒº[$F·¡Ğ¡çÅö[280]]) && !isset($e•Ñã¨ƒº[$F·¡Ğ¡çÅö[277]])) { foreach ($e•Ñã¨ƒº[$F·¡Ğ¡çÅö[273]] as $C†ĞÀÅ¦ĞÍ => $fóÒ¹“Äš¨) { $C†ĞÀÅ¦ĞÍ = trim($C†ĞÀÅ¦ĞÍ); if (in_array($C†ĞÀÅ¦ĞÍ, $eİ‰ïê, !0)) { if (is_scalar($fóÒ¹“Äš¨)) { $this->_parseType($e•Ñã¨ƒº[$F·¡Ğ¡çÅö[273]], $C†ĞÀÅ¦ĞÍ); } } elseif (!is_numeric($C†ĞÀÅ¦ĞÍ) && $F·¡Ğ¡çÅö[71] != substr($C†ĞÀÅ¦ĞÍ, 0, 1) && !1 === strpos($C†ĞÀÅ¦ĞÍ, $F·¡Ğ¡çÅö[95]) && !1 === strpos($C†ĞÀÅ¦ĞÍ, $F·¡Ğ¡çÅö[258]) && !1 === strpos($C†ĞÀÅ¦ĞÍ, $F·¡Ğ¡çÅö[281]) && !1 === strpos($C†ĞÀÅ¦ĞÍ, $F·¡Ğ¡çÅö[282])) { unset($e•Ñã¨ƒº[$F·¡Ğ¡çÅö[273]][$C†ĞÀÅ¦ĞÍ]); } } } $this->_options_filter($e•Ñã¨ƒº); return $e•Ñã¨ƒº; goto CÑ¦™«İ¥å; CÑ¦™«İ¥å: } protected function _options_filter(&$aè¿Æƒ–ñÁ) { } protected function _parseType(&$d»²øä…Õ», $FŞ¾Ôªİ¯ß) { $aÚ¬¨Æ½†ˆ =& $_SERVER[ªúæÂ¡­ä½]; if (empty($this->options[$aÚ¬¨Æ½†ˆ[283]][$aÚ¬¨Æ½†ˆ[4] . $FŞ¾Ôªİ¯ß])) { $c¨Å©Ÿù¥ = strtolower($this->fields[$aÚ¬¨Æ½†ˆ[250]][$FŞ¾Ôªİ¯ß]); if (!1 !== strpos($c¨Å©Ÿù¥, $aÚ¬¨Æ½†ˆ[284])) { } elseif (!1 === strpos($c¨Å©Ÿù¥, $aÚ¬¨Æ½†ˆ[285]) && !1 !== strpos($c¨Å©Ÿù¥, $aÚ¬¨Æ½†ˆ[286])) { $d»²øä…Õ»[$FŞ¾Ôªİ¯ß] = intval($d»²øä…Õ»[$FŞ¾Ôªİ¯ß]); } elseif (!1 !== strpos($c¨Å©Ÿù¥, $aÚ¬¨Æ½†ˆ[287]) || !1 !== strpos($c¨Å©Ÿù¥, $aÚ¬¨Æ½†ˆ[288])) { $d»²øä…Õ»[$FŞ¾Ôªİ¯ß] = floatval($d»²øä…Õ»[$FŞ¾Ôªİ¯ß]); } elseif (!1 !== strpos($c¨Å©Ÿù¥, $aÚ¬¨Æ½†ˆ[289])) { $d»²øä…Õ»[$FŞ¾Ôªİ¯ß] = (bool) $d»²øä…Õ»[$FŞ¾Ôªİ¯ß]; } } } public function find($Aè­ÍÀˆô— = array()) { goto FÇ­ÊÔ¹±Æ; d„ÈƒçàŞ: if (!empty($this->options[$cğÊè¤Ó­Ü[291]])) { return $this->returnResult($this->data, $this->options[$cğÊè¤Ó­Ü[291]]); } return $this->data; goto càÙãˆ˜¼; FÇ­ÊÔ¹±Æ: $cğÊè¤Ó­Ü =& $_SERVER[ªúæÂ¡­ä½]; if (is_numeric($Aè­ÍÀˆô—) || is_string($Aè­ÍÀˆô—)) { $Bº…ù¸½¥¡[$this->getPk()] = intval($Aè­ÍÀˆô—); $this->options[$cğÊè¤Ó­Ü[273]] = $Bº…ù¸½¥¡; } $this->options[$cğÊè¤Ó­Ü[290]] = 1; goto Fê÷ƒãÙà; Fê÷ƒãÙà: $Aè­ÍÀˆô— = $this->_parseOptions(); $E»ï¨î˜¿ = $this->db->select($Aè­ÍÀˆô—); if (!1 === $E»ï¨î˜¿) { return !1; } goto bíó­§“ä; bíó­§“ä: if (empty($E»ï¨î˜¿)) { return null; } $this->data = $E»ï¨î˜¿[0]; $this->_afterFind($this->data, $Aè­ÍÀˆô—); goto d„ÈƒçàŞ; càÙãˆ˜¼: } protected function _afterFind(&$eí¬ÕÈÑ˜ß, $Cñ‹òİâ‡„) { } protected function returnResult($AÜ¢§ÛÜÇÃ, $Eù¸ßİ‡Å = '') { $BİæîÕÀ =& $_SERVER[ªúæÂ¡­ä½]; if ($Eù¸ßİ‡Å) { if (is_callable($Eù¸ßİ‡Å)) { return call_user_func($Eù¸ßİ‡Å, $AÜ¢§ÛÜÇÃ); } switch (strtolower($Eù¸ßİ‡Å)) { case $BİæîÕÀ[292]: return json_encode($AÜ¢§ÛÜÇÃ); case $BİæîÕÀ[293]: return xml_encode($AÜ¢§ÛÜÇÃ); } } return $AÜ¢§ÛÜÇÃ; } public function parseFieldsMap($F¶‹„Õ¾‡Â, $a„‘†¿ºõÚ = 1) { if (!empty($this->_map)) { foreach ($this->_map as $DÉĞŠñ–øÊ => $EÌ¬‰…¼Õˆ) { if ($a„‘†¿ºõÚ == 1) { if (isset($F¶‹„Õ¾‡Â[$EÌ¬‰…¼Õˆ])) { $F¶‹„Õ¾‡Â[$DÉĞŠñ–øÊ] = $F¶‹„Õ¾‡Â[$EÌ¬‰…¼Õˆ]; unset($F¶‹„Õ¾‡Â[$EÌ¬‰…¼Õˆ]); } } else { if (isset($F¶‹„Õ¾‡Â[$DÉĞŠñ–øÊ])) { $F¶‹„Õ¾‡Â[$EÌ¬‰…¼Õˆ] = $F¶‹„Õ¾‡Â[$DÉĞŠñ–øÊ]; unset($F¶‹„Õ¾‡Â[$DÉĞŠñ–øÊ]); } } } } return $F¶‹„Õ¾‡Â; } public function setField($bæË–ã‹ì, $A›ùÖğõ· = '') { if (is_array($bæË–ã‹ì)) { $CÍß¢·ğĞã = $bæË–ã‹ì; } else { $CÍß¢·ğĞã[$bæË–ã‹ì] = $A›ùÖğõ·; } return $this->save($CÍß¢·ğĞã); } public function setAdd($BÙâª©è‚, $Eõ§Ç¾µŞ = 1) { $cÂ¾ïÀ¢æ¡ =& $_SERVER[ªúæÂ¡­ä½]; $e˜Ì¡Å¤é÷ = $BÙâª©è‚ . $cÂ¾ïÀ¢æ¡[294] . $Eõ§Ç¾µŞ; if ($Eõ§Ç¾µŞ < 0) { $e˜Ì¡Å¤é÷ = $BÙâª©è‚ . $Eõ§Ç¾µŞ; } return $this->setField($BÙâª©è‚, array($cÂ¾ïÀ¢æ¡[295], $e˜Ì¡Å¤é÷)); } public function getField($BùöÌ¶Œß‡, $f„†¤¯›ç = null) { $f¹ˆÇÔØÚ =& $_SERVER[ªúæÂ¡­ä½]; $a‹åÒÂ±¸Ñ[$f¹ˆÇÔØÚ[271]] = $BùöÌ¶Œß‡; $a‹åÒÂ±¸Ñ = $this->_parseOptions($a‹åÒÂ±¸Ñ); $BùöÌ¶Œß‡ = trim($BùöÌ¶Œß‡); if (strpos($BùöÌ¶Œß‡, $f¹ˆÇÔØÚ[47])) { if (!isset($a‹åÒÂ±¸Ñ[$f¹ˆÇÔØÚ[290]])) { $a‹åÒÂ±¸Ñ[$f¹ˆÇÔØÚ[290]] = is_numeric($f„†¤¯›ç) ? $f„†¤¯›ç : $f¹ˆÇÔØÚ[33]; } $b—ÚÒËÅØ = $this->db->select($a‹åÒÂ±¸Ñ); if (!empty($b—ÚÒËÅØ)) { goto B·ÍÚÙ„Ñ; Fîô©Ó¶˜: $CôšíšÏ‚Ş = array_shift($BùöÌ¶Œß‡); $FÕïâË£’¸ = array(); $d¬¯—ìÃ = count($Bèèîê›É); goto eİ‚Œ«˜İÑ; B·ÍÚÙ„Ñ: $Bèèîê›É = explode($f¹ˆÇÔØÚ[47], $BùöÌ¶Œß‡); $BùöÌ¶Œß‡ = array_keys($b—ÚÒËÅØ[0]); $dòˆ»“Ò = array_shift($BùöÌ¶Œß‡); goto Fîô©Ó¶˜; eİ‚Œ«˜İÑ: foreach ($b—ÚÒËÅØ as $e²Œ–¶½Àˆ) { $B„õâùÄÔ† = $e²Œ–¶½Àˆ[$dòˆ»“Ò]; if (2 == $d¬¯—ìÃ) { $FÕïâË£’¸[$B„õâùÄÔ†] = $e²Œ–¶½Àˆ[$CôšíšÏ‚Ş]; } else { $FÕïâË£’¸[$B„õâùÄÔ†] = is_string($f„†¤¯›ç) ? implode($f„†¤¯›ç, $e²Œ–¶½Àˆ) : $e²Œ–¶½Àˆ; } } return $FÕïâË£’¸; goto F…îÕ°°»; F…îÕ°°»: } } else { if (!0 !== $f„†¤¯›ç) { $a‹åÒÂ±¸Ñ[$f¹ˆÇÔØÚ[290]] = is_numeric($f„†¤¯›ç) ? $f„†¤¯›ç : 1; } if ($f„†¤¯›ç === $f¹ˆÇÔØÚ[253]) { unset($a‹åÒÂ±¸Ñ[$f¹ˆÇÔØÚ[290]]); } $e²Œ–¶½Àˆ = $this->db->select($a‹åÒÂ±¸Ñ); if (!empty($e²Œ–¶½Àˆ)) { if ($f„†¤¯›ç === $f¹ˆÇÔØÚ[253]) { return reset($e²Œ–¶½Àˆ[0]); } if (!0 !== $f„†¤¯›ç && 1 == $a‹åÒÂ±¸Ñ[$f¹ˆÇÔØÚ[290]]) { return reset($e²Œ–¶½Àˆ[0]); } foreach ($e²Œ–¶½Àˆ as $E…Œ¬Åêƒ†) { $B÷’¦†Îğ[] = $E…Œ¬Åêƒ†[$BùöÌ¶Œß‡]; } return $B÷’¦†Îğ; } } return null; } public function create($D¯Â–ºŸ = '', $FĞóá•ÌàÉ = '') { goto AàØ¦¸‰¤; cƒ›‡´ ¤ï: $D¯Â–ºŸ = $this->parseFieldsMap($D¯Â–ºŸ, 0); $FĞóá•ÌàÉ = $FĞóá•ÌàÉ ? $FĞóá•ÌàÉ : (!empty($D¯Â–ºŸ[$this->getPk()]) ? THINK_MODEL_UPDATE : THINK_MODEL_INSERT); if (isset($this->options[$EçÆ°‡ÒƒÌ[271]])) { $A£Ï³İõĞ = $this->options[$EçÆ°‡ÒƒÌ[271]]; unset($this->options[$EçÆ°‡ÒƒÌ[271]]); } elseif ($FĞóá•ÌàÉ == THINK_MODEL_INSERT && isset($this->insertFields)) { $A£Ï³İõĞ = $this->insertFields; } elseif ($FĞóá•ÌàÉ == THINK_MODEL_UPDATE && isset($this->updateFields)) { $A£Ï³İõĞ = $this->updateFields; } goto F‚ñÔ¼—’Ç; A¤Œ—“·ÆØ: return $D¯Â–ºŸ; goto F Ö£À÷ŠĞ; F‚ñÔ¼—’Ç: if (isset($A£Ï³İõĞ)) { if (is_string($A£Ï³İõĞ)) { $A£Ï³İõĞ = explode($EçÆ°‡ÒƒÌ[47], $A£Ï³İõĞ); } if (think_config($EçÆ°‡ÒƒÌ[296])) { $A£Ï³İõĞ[] = think_config($EçÆ°‡ÒƒÌ[297]); } foreach ($D¯Â–ºŸ as $cïÓ¶³ëê => $fùñÊøÙİ÷) { if (!in_array($cïÓ¶³ëê, $A£Ï³İõĞ)) { unset($D¯Â–ºŸ[$cïÓ¶³ëê]); } } } if (!$this->autoValidation($D¯Â–ºŸ, $FĞóá•ÌàÉ)) { return !1; } if (!$this->autoCheckToken($D¯Â–ºŸ)) { $this->error = think_lang($EçÆ°‡ÒƒÌ[298]); return !1; } goto b–Â¯Ø¯Äô; b–Â¯Ø¯Äô: if ($this->autoCheckFields) { $A£Ï³İõĞ = $this->getDbFields(); foreach ($D¯Â–ºŸ as $cïÓ¶³ëê => $fùñÊøÙİ÷) { if (!in_array($cïÓ¶³ëê, $A£Ï³İõĞ)) { unset($D¯Â–ºŸ[$cïÓ¶³ëê]); } elseif (MAGIC_QUOTES_GPC && is_string($fùñÊøÙİ÷)) { $D¯Â–ºŸ[$cïÓ¶³ëê] = stripslashes($fùñÊøÙİ÷); } } } $this->autoOperation($D¯Â–ºŸ, $FĞóá•ÌàÉ); $this->data = $D¯Â–ºŸ; goto A¤Œ—“·ÆØ; AàØ¦¸‰¤: $EçÆ°‡ÒƒÌ =& $_SERVER[ªúæÂ¡­ä½]; if (empty($D¯Â–ºŸ)) { $D¯Â–ºŸ = $_POST; } elseif (is_object($D¯Â–ºŸ)) { $D¯Â–ºŸ = get_object_vars($D¯Â–ºŸ); } if (empty($D¯Â–ºŸ) || !is_array($D¯Â–ºŸ)) { $this->error = think_lang($EçÆ°‡ÒƒÌ[269]); return !1; } goto cƒ›‡´ ¤ï; F Ö£À÷ŠĞ: } public function autoCheckToken($AáŠ²’„£â) { $D¼¿«ŒİØ» =& $_SERVER[ªúæÂ¡­ä½]; if (isset($this->options[$D¼¿«ŒİØ»[299]]) && !$this->options[$D¼¿«ŒİØ»[299]]) { return !0; } if (think_config($D¼¿«ŒİØ»[296])) { $C‚İß¬š¯” = think_config($D¼¿«ŒİØ»[297]); if (!isset($AáŠ²’„£â[$C‚İß¬š¯”]) || Session::get($C‚İß¬š¯”)) { return !1; } list($A±Ó£¼ä·Œ, $eœœ†™ŒÇ«) = explode($D¼¿«ŒİØ»[71], $AáŠ²’„£â[$C‚İß¬š¯”]); if ($eœœ†™ŒÇ« && Session::get($C‚İß¬š¯” . $D¼¿«ŒİØ»[95] . $A±Ó£¼ä·Œ) === $eœœ†™ŒÇ«) { Session::remove($C‚İß¬š¯” . $D¼¿«ŒİØ»[95] . $A±Ó£¼ä·Œ); return !0; } if (think_config($D¼¿«ŒİØ»[300])) { Session::remove($C‚İß¬š¯” . $D¼¿«ŒİØ»[95] . $A±Ó£¼ä·Œ); } return !1; } return !0; } public function regex($b‡ÇÒÚ³ß, $a…ø§ÚöŒè) { $DÔÇ½äŠî• =& $_SERVER[ªúæÂ¡­ä½]; $a‹¥¦å¡ªè = array($DÔÇ½äŠî•[301] => $DÔÇ½äŠî•[302], $DÔÇ½äŠî•[303] => $DÔÇ½äŠî•[304], $DÔÇ½äŠî•[305] => $DÔÇ½äŠî•[306], $DÔÇ½äŠî•[307] => $DÔÇ½äŠî•[308], $DÔÇ½äŠî•[309] => $DÔÇ½äŠî•[310], $DÔÇ½äŠî•[311] => $DÔÇ½äŠî•[312], $DÔÇ½äŠî•[313] => $DÔÇ½äŠî•[314], $DÔÇ½äŠî•[288] => $DÔÇ½äŠî•[315], $DÔÇ½äŠî•[316] => $DÔÇ½äŠî•[317]); if (isset($a‹¥¦å¡ªè[strtolower($a…ø§ÚöŒè)])) { $a…ø§ÚöŒè = $a‹¥¦å¡ªè[strtolower($a…ø§ÚöŒè)]; } return preg_match($a…ø§ÚöŒè, $b‡ÇÒÚ³ß) === 1; } private function autoOperation(&$F†³ï³ŠŸ¢, $DĞÍ¦ŒĞÇ) { $c†…‘Çéƒ° =& $_SERVER[ªúæÂ¡­ä½]; if (!empty($this->options[$c†…‘Çéƒ°[318]])) { $E‰ù‚Äñ¦ = $this->options[$c†…‘Çéƒ°[318]]; unset($this->options[$c†…‘Çéƒ°[318]]); } elseif (!empty($this->_auto)) { $E‰ù‚Äñ¦ = $this->_auto; } if (isset($E‰ù‚Äñ¦)) { foreach ($E‰ù‚Äñ¦ as $bº¬ê¨âèÃ) { if (empty($bº¬ê¨âèÃ[2])) { $bº¬ê¨âèÃ[2] = THINK_MODEL_INSERT; } if ($DĞÍ¦ŒĞÇ == $bº¬ê¨âèÃ[2] || $bº¬ê¨âèÃ[2] == THINK_MODEL_BOTH) { switch (trim($bº¬ê¨âèÃ[3])) { case $c†…‘Çéƒ°[319]: case $c†…‘Çéƒ°[320]: $BøÇí…¹¾ = isset($bº¬ê¨âèÃ[4]) ? (array) $bº¬ê¨âèÃ[4] : array(); if (isset($F†³ï³ŠŸ¢[$bº¬ê¨âèÃ[0]])) { array_unshift($BøÇí…¹¾, $F†³ï³ŠŸ¢[$bº¬ê¨âèÃ[0]]); } if ($c†…‘Çéƒ°[319] == $bº¬ê¨âèÃ[3]) { $F†³ï³ŠŸ¢[$bº¬ê¨âèÃ[0]] = call_user_func_array($bº¬ê¨âèÃ[1], $BøÇí…¹¾); } else { $F†³ï³ŠŸ¢[$bº¬ê¨âèÃ[0]] = call_user_func_array(array(&$this, $bº¬ê¨âèÃ[1]), $BøÇí…¹¾); } break; case $c†…‘Çéƒ°[271]: $F†³ï³ŠŸ¢[$bº¬ê¨âèÃ[0]] = $F†³ï³ŠŸ¢[$bº¬ê¨âèÃ[1]]; break; case $c†…‘Çéƒ°[321]: if ($c†…‘Çéƒ°[33] === $F†³ï³ŠŸ¢[$bº¬ê¨âèÃ[0]]) { unset($F†³ï³ŠŸ¢[$bº¬ê¨âèÃ[0]]); } break; case $c†…‘Çéƒ°[322]: default: $F†³ï³ŠŸ¢[$bº¬ê¨âèÃ[0]] = $bº¬ê¨âèÃ[1]; } if (!1 === $F†³ï³ŠŸ¢[$bº¬ê¨âèÃ[0]]) { unset($F†³ï³ŠŸ¢[$bº¬ê¨âèÃ[0]]); } } } } return $F†³ï³ŠŸ¢; } protected function autoValidation($aà—â³œÅ, $fÍĞª”—°¤) { $c§­½÷¸¶° =& $_SERVER[ªúæÂ¡­ä½]; if (!empty($this->options[$c§­½÷¸¶°[323]])) { $b•âøÌøØ™ = $this->options[$c§­½÷¸¶°[323]]; unset($this->options[$c§­½÷¸¶°[323]]); } elseif (!empty($this->_validate)) { $b•âøÌøØ™ = $this->_validate; } if (isset($b•âøÌøØ™)) { if ($this->patchValidate) { $this->error = array(); } foreach ($b•âøÌøØ™ as $B—„æñ¿ÃÄ => $C¯‡‡À¹å) { if (empty($C¯‡‡À¹å[5]) || $C¯‡‡À¹å[5] == THINK_MODEL_BOTH || $C¯‡‡À¹å[5] == $fÍĞª”—°¤) { if (0 == strpos($C¯‡‡À¹å[2], $c§­½÷¸¶°[324]) && strpos($C¯‡‡À¹å[2], $c§­½÷¸¶°[325])) { $C¯‡‡À¹å[2] = think_lang(substr($C¯‡‡À¹å[2], 2, -1)); } $C¯‡‡À¹å[3] = isset($C¯‡‡À¹å[3]) ? $C¯‡‡À¹å[3] : THINK_EXISTS_VALIDATE; $C¯‡‡À¹å[4] = isset($C¯‡‡À¹å[4]) ? $C¯‡‡À¹å[4] : $c§­½÷¸¶°[326]; switch ($C¯‡‡À¹å[3]) { case THINK_MUST_VALIDATE: if (!1 === $this->_validationField($aà—â³œÅ, $C¯‡‡À¹å)) { return !1; } break; case THINK_VALUE_VALIDATE: if ($c§­½÷¸¶°[33] != trim($aà—â³œÅ[$C¯‡‡À¹å[0]])) { if (!1 === $this->_validationField($aà—â³œÅ, $C¯‡‡À¹å)) { return !1; } } break; default: if (isset($aà—â³œÅ[$C¯‡‡À¹å[0]])) { if (!1 === $this->_validationField($aà—â³œÅ, $C¯‡‡À¹å)) { return !1; } } } } } if (!empty($this->error)) { return !1; } } return !0; } protected function _validationField($A»Ÿµ¶ŞÈ­, $Eö¾“¡¡Á) { if (!1 === $this->_validationFieldItem($A»Ÿµ¶ŞÈ­, $Eö¾“¡¡Á)) { if ($this->patchValidate) { $this->error[$Eö¾“¡¡Á[0]] = $Eö¾“¡¡Á[2]; } else { $this->error = $Eö¾“¡¡Á[2]; return !1; } } return; } protected function _validationFieldItem($BÑÕĞĞç’, $céÅàêÎöà) { $Dè§Œµˆé› =& $_SERVER[ªúæÂ¡­ä½]; switch (strtolower(trim($céÅàêÎöà[4]))) { case $Dè§Œµˆé›[319]: case $Dè§Œµˆé›[320]: $aƒÁ±Î¼— = isset($céÅàêÎöà[6]) ? (array) $céÅàêÎöà[6] : array(); if (is_string($céÅàêÎöà[0]) && strpos($céÅàêÎöà[0], $Dè§Œµˆé›[47])) { $céÅàêÎöà[0] = explode($Dè§Œµˆé›[47], $céÅàêÎöà[0]); } if (is_array($céÅàêÎöà[0])) { foreach ($céÅàêÎöà[0] as $CĞÎµ‡ì·) { $aùŠ¶ºÂÀ[$CĞÎµ‡ì·] = $BÑÕĞĞç’[$CĞÎµ‡ì·]; } array_unshift($aƒÁ±Î¼—, $aùŠ¶ºÂÀ); } else { array_unshift($aƒÁ±Î¼—, $BÑÕĞĞç’[$céÅàêÎöà[0]]); } if ($Dè§Œµˆé›[319] == $céÅàêÎöà[4]) { return call_user_func_array($céÅàêÎöà[1], $aƒÁ±Î¼—); } else { return call_user_func_array(array(&$this, $céÅàêÎöà[1]), $aƒÁ±Î¼—); } case $Dè§Œµˆé›[327]: return $BÑÕĞĞç’[$céÅàêÎöà[0]] == $BÑÕĞĞç’[$céÅàêÎöà[1]]; case $Dè§Œµˆé›[328]: if (is_string($céÅàêÎöà[0]) && strpos($céÅàêÎöà[0], $Dè§Œµˆé›[47])) { $céÅàêÎöà[0] = explode($Dè§Œµˆé›[47], $céÅàêÎöà[0]); } $f„—Â‡˜ ˆ = array(); if (is_array($céÅàêÎöà[0])) { foreach ($céÅàêÎöà[0] as $CĞÎµ‡ì·) { $f„—Â‡˜ ˆ[$CĞÎµ‡ì·] = $BÑÕĞĞç’[$CĞÎµ‡ì·]; } } else { $f„—Â‡˜ ˆ[$céÅàêÎöà[0]] = $BÑÕĞĞç’[$céÅàêÎöà[0]]; } if (!empty($BÑÕĞĞç’[$this->getPk()])) { $f„—Â‡˜ ˆ[$this->getPk()] = array($Dè§Œµˆé›[329], $BÑÕĞĞç’[$this->getPk()]); } if ($this->where($f„—Â‡˜ ˆ)->find()) { return !1; } return !0; default: return $this->check($BÑÕĞĞç’[$céÅàêÎöà[0]], $céÅàêÎöà[1], $céÅàêÎöà[4]); } } public function check($cÊ³‚–Š, $b×¼Œİ’¢‡, $CÍ¤êªíÛ· = "\162\145\x67\145\170") { $EÍƒº„ğØ× =& $_SERVER[ªúæÂ¡­ä½]; $CÍ¤êªíÛ· = strtolower(trim($CÍ¤êªíÛ·)); switch ($CÍ¤êªíÛ·) { case $EÍƒº„ğØ×[7]: case $EÍƒº„ğØ×[330]: $f½Â±Éâòİ = is_array($b×¼Œİ’¢‡) ? $b×¼Œİ’¢‡ : explode($EÍƒº„ğØ×[47], $b×¼Œİ’¢‡); return $CÍ¤êªíÛ· == $EÍƒº„ğØ×[7] ? in_array($cÊ³‚–Š, $f½Â±Éâòİ) : !in_array($cÊ³‚–Š, $f½Â±Éâòİ); case $EÍƒº„ğØ×[331]: case $EÍƒº„ğØ×[332]: if (is_array($b×¼Œİ’¢‡)) { $c–Ÿ©Ùâë§ = $b×¼Œİ’¢‡[0]; $eïç—Ø·Åç = $b×¼Œİ’¢‡[1]; } else { list($c–Ÿ©Ùâë§, $eïç—Ø·Åç) = explode($EÍƒº„ğØ×[47], $b×¼Œİ’¢‡); } return $CÍ¤êªíÛ· == $EÍƒº„ğØ×[331] ? $cÊ³‚–Š >= $c–Ÿ©Ùâë§ && $cÊ³‚–Š <= $eïç—Ø·Åç : $cÊ³‚–Š < $c–Ÿ©Ùâë§ || $cÊ³‚–Š > $eïç—Ø·Åç; case $EÍƒº„ğØ×[333]: case $EÍƒº„ğØ×[334]: return $CÍ¤êªíÛ· == $EÍƒº„ğØ×[333] ? $cÊ³‚–Š == $b×¼Œİ’¢‡ : $cÊ³‚–Š != $b×¼Œİ’¢‡; case $EÍƒº„ğØ×[335]: $e­…ó¼¦¸É = mb_strlen($cÊ³‚–Š, $EÍƒº„ğØ×[336]); if (strpos($b×¼Œİ’¢‡, $EÍƒº„ğØ×[47])) { list($c–Ÿ©Ùâë§, $eïç—Ø·Åç) = explode($EÍƒº„ğØ×[47], $b×¼Œİ’¢‡); return $e­…ó¼¦¸É >= $c–Ÿ©Ùâë§ && $e­…ó¼¦¸É <= $eïç—Ø·Åç; } else { return $e­…ó¼¦¸É == $b×¼Œİ’¢‡; } case $EÍƒº„ğØ×[337]: list($a¨Ğ¨„©ßÛ, $F‘ª¶çºƒå) = explode($EÍƒº„ğØ×[47], $b×¼Œİ’¢‡); if (!is_numeric($a¨Ğ¨„©ßÛ)) { $a¨Ğ¨„©ßÛ = strtotime($a¨Ğ¨„©ßÛ); } if (!is_numeric($F‘ª¶çºƒå)) { $F‘ª¶çºƒå = strtotime($F‘ª¶çºƒå); } return NOW_TIME >= $a¨Ğ¨„©ßÛ && NOW_TIME <= $F‘ª¶çºƒå; case $EÍƒº„ğØ×[338]: return in_array(get_client_ip(), explode($EÍƒº„ğØ×[47], $b×¼Œİ’¢‡)); case $EÍƒº„ğØ×[339]: return !in_array(get_client_ip(), explode($EÍƒº„ğØ×[47], $b×¼Œİ’¢‡)); case $EÍƒº„ğØ×[326]: default: return $this->regex($cÊ³‚–Š, $b×¼Œİ’¢‡); } } public function query($CÜ¶óÜôÎÀ, $aˆÉ‘Áèê¥ = false) { $a³á—·©¤œ =& $_SERVER[ªúæÂ¡­ä½]; if (!is_bool($aˆÉ‘Áèê¥) && !is_array($aˆÉ‘Áèê¥)) { $aˆÉ‘Áèê¥ = func_get_args(); array_shift($aˆÉ‘Áèê¥); } $CÜ¶óÜôÎÀ = str_replace(array($a³á—·©¤œ[229], $a³á—·©¤œ[340]), $a³á—·©¤œ[50], $CÜ¶óÜôÎÀ); $CÜ¶óÜôÎÀ = $this->parseSql($CÜ¶óÜôÎÀ, $aˆÉ‘Áèê¥); return $this->db->query($CÜ¶óÜôÎÀ); } public function execute($cĞù¢¯÷Í, $e­©ç†ÉÆ‚ = false) { if (!is_bool($e­©ç†ÉÆ‚) && !is_array($e­©ç†ÉÆ‚)) { $e­©ç†ÉÆ‚ = func_get_args(); array_shift($e­©ç†ÉÆ‚); } $cĞù¢¯÷Í = $this->parseSql($cĞù¢¯÷Í, $e­©ç†ÉÆ‚); return $this->db->execute($cĞù¢¯÷Í); } protected function parseSql($FœÂ÷òˆê©, $c²Ê¶Â¶Ğ) { $cØù´¨÷´ö =& $_SERVER[ªúæÂ¡­ä½]; if (!0 === $c²Ê¶Â¶Ğ) { $F„øôâÔå¡ = $this->_parseOptions(); $FœÂ÷òˆê© = $this->db->parseSql($FœÂ÷òˆê©, $F„øôâÔå¡); } elseif (is_array($c²Ê¶Â¶Ğ)) { $c²Ê¶Â¶Ğ = array_map(array($this->db, $cØù´¨÷´ö[341]), $c²Ê¶Â¶Ğ); $FœÂ÷òˆê© = vsprintf($FœÂ÷òˆê©, $c²Ê¶Â¶Ğ); } else { $FœÂ÷òˆê© = strtr($FœÂ÷òˆê©, array($cØù´¨÷´ö[342] => $this->getTableName(), $cØù´¨÷´ö[343] => think_config($cØù´¨÷´ö[242]))); } $this->db->setModel($this->name); return $FœÂ÷òˆê©; } public function db($f×Å’–¬‘² = '', $aİ‹ç›Êİ = '', $eœ‰¡óÛ³˜ = array()) { goto CšÕÚ¨ó¾â; cİ±°ÉÌ²•: static $A°Ã¯Á¸•ö = array(); if (!isset($A°Ã¯Á¸•ö[$f×Å’–¬‘²]) || isset($A°Ã¯Á¸•ö[$f×Å’–¬‘²]) && $aİ‹ç›Êİ && $Cå•ìÏÂ…¤[$f×Å’–¬‘²] != $aİ‹ç›Êİ) { if (!empty($aİ‹ç›Êİ) && is_string($aİ‹ç›Êİ) && !1 === strpos($aİ‹ç›Êİ, $cÕˆÙ»ø[8])) { $aİ‹ç›Êİ = think_config($aİ‹ç›Êİ); } $A°Ã¯Á¸•ö[$f×Å’–¬‘²] = Db::getInstance($aİ‹ç›Êİ); } elseif (NULL === $aİ‹ç›Êİ) { $A°Ã¯Á¸•ö[$f×Å’–¬‘²]->close(); unset($A°Ã¯Á¸•ö[$f×Å’–¬‘²]); return; } if (!empty($eœ‰¡óÛ³˜)) { if (is_string($eœ‰¡óÛ³˜)) { parse_str($eœ‰¡óÛ³˜, $eœ‰¡óÛ³˜); } foreach ($eœ‰¡óÛ³˜ as $CõŠ÷ĞŞ®« => $bÛ”ÛõêÁ‹) { $this->setProperty($CõŠ÷ĞŞ®«, $bÛ”ÛõêÁ‹); } } goto f²ïĞøÚÙ; CšÕÚ¨ó¾â: $cÕˆÙ»ø =& $_SERVER[ªúæÂ¡­ä½]; if ($cÕˆÙ»ø[33] === $f×Å’–¬‘² && $this->db) { return $this->db; } static $Cå•ìÏÂ…¤ = array(); goto cİ±°ÉÌ²•; C¾â“Âí: if (!empty($this->name) && $this->autoCheckFields) { $this->_checkTableInfo(); } return $this; goto c„ê³ß®±×; f²ïĞøÚÙ: $Cå•ìÏÂ…¤[$f×Å’–¬‘²] = $aİ‹ç›Êİ; $this->db = $A°Ã¯Á¸•ö[$f×Å’–¬‘²]; $this->_after_db(); goto C¾â“Âí; c„ê³ß®±×: } protected function _after_db() { } public function getModelName() { if (empty($this->name)) { $cœ¾Ï‰«Å = get_class($this); if ($cœ¾Ï‰«Å == $_SERVER[ªúæÂ¡­ä½][344]) { return $this->name; } $this->name = substr($cœ¾Ï‰«Å, 0, -5); } return $this->name; } public function getTableName() { $aÓ‹â„¥ó =& $_SERVER[ªúæÂ¡­ä½]; if (empty($this->trueTableName)) { $cÀÕ…Ç»É = !empty($this->tablePrefix) ? $this->tablePrefix : $aÓ‹â„¥ó[33]; if (!empty($this->tableName)) { $cÀÕ…Ç»É .= $this->tableName; } else { $cÀÕ…Ç»É .= think_parse_name($this->name); } $this->trueTableName = strtolower($cÀÕ…Ç»É); } return (!empty($this->dbName) ? $this->dbName . $aÓ‹â„¥ó[95] : $aÓ‹â„¥ó[33]) . $this->trueTableName; } public function startTrans() { $this->commit(); $this->db->startTrans(); return; } public function commit() { return $this->db->commit(); } public function rollback() { return $this->db->rollback(); } public function getError() { return $this->error; } public function getDbError() { return $this->db->getError(); } public function getLastInsID() { return $this->db->getLastInsID(); } public function getLastSql() { return $this->db->getLastSql($this->name); } public function _sql() { return $this->getLastSql(); } public function getPk() { $e·»—‘íÆŒ =& $_SERVER[ªúæÂ¡­ä½]; return isset($this->fields[$e·»—‘íÆŒ[249]]) ? $this->fields[$e·»—‘íÆŒ[249]] : $this->pk; } public function getDbFields() { $f„ª ß±¹„ =& $_SERVER[ªúæÂ¡­ä½]; if (isset($this->options[$f„ª ß±¹„[277]])) { $A‡¹é»ª‹ø = $this->db->getFields($this->options[$f„ª ß±¹„[277]]); return $A‡¹é»ª‹ø ? array_keys($A‡¹é»ª‹ø) : !1; } if ($this->fields) { $A‡¹é»ª‹ø = $this->fields; unset($A‡¹é»ª‹ø[$f„ª ß±¹„[248]], $A‡¹é»ª‹ø[$f„ª ß±¹„[249]], $A‡¹é»ª‹ø[$f„ª ß±¹„[250]], $A‡¹é»ª‹ø[$f„ª ß±¹„[247]]); return $A‡¹é»ª‹ø; } return !1; } public function data($E„âë³¨Ú® = '') { $d¿¥İŸ•Ò =& $_SERVER[ªúæÂ¡­ä½]; if ($d¿¥İŸ•Ò[33] === $E„âë³¨Ú® && !empty($this->data)) { return $this->data; } if (is_object($E„âë³¨Ú®)) { $E„âë³¨Ú® = get_object_vars($E„âë³¨Ú®); } elseif (is_string($E„âë³¨Ú®)) { parse_str($E„âë³¨Ú®, $E„âë³¨Ú®); } elseif (!is_array($E„âë³¨Ú®)) { think_exception(think_lang($d¿¥İŸ•Ò[269])); } $this->data = $E„âë³¨Ú®; return $this; } public function join($C¢õõÃ»Æ—) { $a²‡ËñòŸË =& $_SERVER[ªúæÂ¡­ä½]; if (is_array($C¢õõÃ»Æ—)) { $this->options[$a²‡ËñòŸË[280]] = $C¢õõÃ»Æ—; } elseif (!empty($C¢õõÃ»Æ—)) { $this->options[$a²‡ËñòŸË[280]][] = $C¢õõÃ»Æ—; } return $this; } public function union($AÃ¥¢ÄôÀÛ, $aÕã‹ŒÖ…ò = false) { goto fòâ©å¬Á; C¿®™Ğ½ë: return $this; goto C¦¦ÙƒïÄ; fòâ©å¬Á: $aÕ‡ËîÚ²è =& $_SERVER[ªúæÂ¡­ä½]; if (empty($AÃ¥¢ÄôÀÛ)) { return $this; } if ($aÕã‹ŒÖ…ò) { $this->options[$aÕ‡ËîÚ²è[345]][$aÕ‡ËîÚ²è[346]] = !0; } goto C–õÌ¤øïß; C–õÌ¤øïß: if (is_object($AÃ¥¢ÄôÀÛ)) { $AÃ¥¢ÄôÀÛ = get_object_vars($AÃ¥¢ÄôÀÛ); } if (is_string($AÃ¥¢ÄôÀÛ)) { $dã¥Â¦“Êö = $AÃ¥¢ÄôÀÛ; } elseif (is_array($AÃ¥¢ÄôÀÛ)) { if (isset($AÃ¥¢ÄôÀÛ[0])) { $this->options[$aÕ‡ËîÚ²è[345]] = array_merge($this->options[$aÕ‡ËîÚ²è[345]], $AÃ¥¢ÄôÀÛ); return $this; } else { $dã¥Â¦“Êö = $AÃ¥¢ÄôÀÛ; } } else { think_exception(think_lang($aÕ‡ËîÚ²è[269])); } $this->options[$aÕ‡ËîÚ²è[345]][] = $dã¥Â¦“Êö; goto C¿®™Ğ½ë; C¦¦ÙƒïÄ: } public function cache($A“öâ¿®âÆ = true, $d”åõÉºöÜ = null, $FÂß—™œœ = '') { $D¤„ÏšŠŸ =& $_SERVER[ªúæÂ¡­ä½]; if (!1 !== $A“öâ¿®âÆ) { $this->options[$D¤„ÏšŠŸ[347]] = array($D¤„ÏšŠŸ[93] => $A“öâ¿®âÆ, $D¤„ÏšŠŸ[337] => $d”åõÉºöÜ, $D¤„ÏšŠŸ[29] => $FÂß—™œœ); } return $this; } public function field($a˜‘Î›æœ«, $cÎ«Ù•Ü–‹ = false) { $fâ‹ÃˆÂä’ =& $_SERVER[ªúæÂ¡­ä½]; if (!0 === $a˜‘Î›æœ«) { $aÚíéŠ‰ ¾ = $this->getDbFields(); $a˜‘Î›æœ« = $aÚíéŠ‰ ¾ ? $aÚíéŠ‰ ¾ : $fâ‹ÃˆÂä’[182]; } elseif ($cÎ«Ù•Ü–‹) { if (is_string($a˜‘Î›æœ«)) { $a˜‘Î›æœ« = explode($fâ‹ÃˆÂä’[47], $a˜‘Î›æœ«); } $aÚíéŠ‰ ¾ = $this->getDbFields(); $a˜‘Î›æœ« = $aÚíéŠ‰ ¾ ? array_diff($aÚíéŠ‰ ¾, $a˜‘Î›æœ«) : $a˜‘Î›æœ«; } $this->options[$fâ‹ÃˆÂä’[271]] = $a˜‘Î›æœ«; return $this; } public function scope($A½Šäİ¸Ú¤ = '', $Bæ·‰¬˜Òâ = NULL) { $f½„¬šÃøé =& $_SERVER[ªúæÂ¡­ä½]; if ($f½„¬šÃøé[33] === $A½Šäİ¸Ú¤) { if (isset($this->_scope[$f½„¬šÃøé[34]])) { $fäœÅì¤ÑÒ = $this->_scope[$f½„¬šÃøé[34]]; } else { return $this; } } elseif (is_string($A½Šäİ¸Ú¤)) { $f­ÙÌÆ—¬ç = explode($f½„¬šÃøé[47], $A½Šäİ¸Ú¤); $fäœÅì¤ÑÒ = array(); foreach ($f­ÙÌÆ—¬ç as $FÑ¥¶È’¨³) { if (!isset($this->_scope[$FÑ¥¶È’¨³])) { continue; } $fäœÅì¤ÑÒ = array_merge($fäœÅì¤ÑÒ, $this->_scope[$FÑ¥¶È’¨³]); } if (!empty($Bæ·‰¬˜Òâ) && is_array($Bæ·‰¬˜Òâ)) { $fäœÅì¤ÑÒ = array_merge($fäœÅì¤ÑÒ, $Bæ·‰¬˜Òâ); } } elseif (is_array($A½Šäİ¸Ú¤)) { $fäœÅì¤ÑÒ = $A½Šäİ¸Ú¤; } if (is_array($fäœÅì¤ÑÒ) && !empty($fäœÅì¤ÑÒ)) { $this->options = array_merge($this->options, array_change_key_case($fäœÅì¤ÑÒ)); } return $this; } public function where($eöàà‡ê¤î, $EÜ”¶ˆ…Ì = null) { $aê¨õ²Ğ =& $_SERVER[ªúæÂ¡­ä½]; if (!is_null($EÜ”¶ˆ…Ì) && is_string($eöàà‡ê¤î)) { if (!is_array($EÜ”¶ˆ…Ì)) { $EÜ”¶ˆ…Ì = func_get_args(); array_shift($EÜ”¶ˆ…Ì); } $EÜ”¶ˆ…Ì = array_map(array($this->db, $aê¨õ²Ğ[341]), $EÜ”¶ˆ…Ì); $eöàà‡ê¤î = vsprintf($eöàà‡ê¤î, $EÜ”¶ˆ…Ì); } elseif (is_object($eöàà‡ê¤î)) { $eöàà‡ê¤î = get_object_vars($eöàà‡ê¤î); } elseif (is_array($eöàà‡ê¤î)) { foreach ($eöàà‡ê¤î as $Cˆß¾¿ñÕ => $dœÑ•ÚÆ‘Ô) { if ((is_numeric($Cˆß¾¿ñÕ) || !$Cˆß¾¿ñÕ) && is_string($dœÑ•ÚÆ‘Ô)) { if (strpos($dœÑ•ÚÆ‘Ô, $aê¨õ²Ğ[348]) === 0) { continue; } think_trace($aê¨õ²Ğ[349], $aê¨õ²Ğ[33], $aê¨õ²Ğ[46]); die; } } } if (is_string($eöàà‡ê¤î) && $aê¨õ²Ğ[33] != $eöàà‡ê¤î) { $dé×ìÄÙœ´ = array(); $dé×ìÄÙœ´[$aê¨õ²Ğ[350]] = $eöàà‡ê¤î; $eöàà‡ê¤î = $dé×ìÄÙœ´; } if (isset($this->options[$aê¨õ²Ğ[273]])) { $this->options[$aê¨õ²Ğ[273]] = array_merge($this->options[$aê¨õ²Ğ[273]], $eöàà‡ê¤î); } else { $this->options[$aê¨õ²Ğ[273]] = $eöàà‡ê¤î; } return $this; } public function limit($B¢…’Ñ†‘Õ, $aäÎ¼¬ã = null) { $bÇÜ¤¨ï£’ =& $_SERVER[ªúæÂ¡­ä½]; $this->options[$bÇÜ¤¨ï£’[290]] = is_null($aäÎ¼¬ã) ? $B¢…’Ñ†‘Õ : $B¢…’Ñ†‘Õ . $bÇÜ¤¨ï£’[47] . $aäÎ¼¬ã; return $this; } public function page($f½¤ãÚ‹è», $c®‚ƒáïÑ† = null) { $Fæøá¢Ìæø =& $_SERVER[ªúæÂ¡­ä½]; $this->options[$Fæøá¢Ìæø[351]] = is_null($c®‚ƒáïÑ†) ? $f½¤ãÚ‹è» : $f½¤ãÚ‹è» . $Fæøá¢Ìæø[47] . $c®‚ƒáïÑ†; return $this; } public function comment($eôÖÎ‡¨) { $this->options[$_SERVER[ªúæÂ¡­ä½][352]] = $eôÖÎ‡¨; return $this; } public function setProperty($dªğ½¢ù¬ç, $E‚ª¸Øä“î) { if (property_exists($this, $dªğ½¢ù¬ç)) { $this->{$dªğ½¢ù¬ç} = $E‚ª¸Øä“î; } return $this; } } goto Dƒ‹¨èËÍ¾; C÷ßÆ ‡¿š: class TaskRun { private static $asyncAdd = false; private static $syncTask = false; public static function timeLimit($a¥Å°ó¼„, $C¦ß¶„ÖÜ = 5.0) { if (!$a¥Å°ó¼„) { return; } $D’Ù¯›Œâê = Cache::get($a¥Å°ó¼„); if (!$D’Ù¯›Œâê || timeFloat() - floatVal($D’Ù¯›Œâê) >= $C¦ß¶„ÖÜ) { Cache::set($a¥Å°ó¼„, timeFloat(), $C¦ß¶„ÖÜ * 10); return !0; } return !1; } public static function timeLimitCall($Bí¨Í·Ğî, $E­¦â…¬¹°, $BÌÄÉ‘à®, $f…ÙÔ¤Ê­¤ = 5.0) { goto BâÛƒ¢ÜÏ; AÄ­šÇ‘Œ¨: if (is_array($F‘Ÿ·»Ìê›[$Bí¨Í·Ğî])) { $FãâÍ„Âçô[$a˜Á–ÑˆÉƒ[1627]] = $F‘Ÿ·»Ìê›[$Bí¨Í·Ğî][$a˜Á–ÑˆÉƒ[1627]]; } if (is_array($F‘Ÿ·»Ìê›[$Bí¨Í·Ğî])) { if (timeFloat() - $F‘Ÿ·»Ìê›[$Bí¨Í·Ğî][$a˜Á–ÑˆÉƒ[1626]] < $FãâÍ„Âçô[$a˜Á–ÑˆÉƒ[197]] * 0.3) { return; } $FãâÍ„Âçô[$a˜Á–ÑˆÉƒ[1627]] = $F‘Ÿ·»Ìê›[$Bí¨Í·Ğî][$a˜Á–ÑˆÉƒ[1627]]; } $F‘Ÿ·»Ìê›[$Bí¨Í·Ğî] = $FãâÍ„Âçô; goto A«À°âÛÑ ; A«À°âÛÑ : Cache::set($e¿Ü—«î‡», $F‘Ÿ·»Ìê›, 60); Cache::removeMemory($e¿Ü—«î‡»); write_log($a˜Á–ÑˆÉƒ[1628] . $Bí¨Í·Ğî . $a˜Á–ÑˆÉƒ[68] . $E­¦â…¬¹°, $a˜Á–ÑˆÉƒ[1622]); goto EÌ©õ¦Úç; BâÛƒ¢ÜÏ: $a˜Á–ÑˆÉƒ =& $_SERVER[ªúæÂ¡­ä½]; if (!$Bí¨Í·Ğî || !$E­¦â…¬¹°) { return; } self::$asyncAdd = !0; goto F•„ù¯°Î…; F•„ù¯°Î…: $e¿Ü—«î‡» = $a˜Á–ÑˆÉƒ[1625]; $F‘Ÿ·»Ìê› = Cache::get($e¿Ü—«î‡», !0); $FãâÍ„Âçô = array($a˜Á–ÑˆÉƒ[1626] => timeFloat(), $a˜Á–ÑˆÉƒ[1627] => timeFloat(), $a˜Á–ÑˆÉƒ[262] => $E­¦â…¬¹°, $a˜Á–ÑˆÉƒ[1620] => $BÌÄÉ‘à®, $a˜Á–ÑˆÉƒ[197] => $f…ÙÔ¤Ê­¤); goto AÄ­šÇ‘Œ¨; EÌ©õ¦Úç: } public static function timeLimitCallLoop() { goto AÑ£äâŠ¯ ; A•‹ÔŸÕøÇ: if (!$FÂ«¸°¢‘â) { return Cache::remove($f‡ˆø¥ç›¸); } Cache::set($f‡ˆø¥ç›¸, $FÂ«¸°¢‘â, 60); Cache::removeMemory($f‡ˆø¥ç›¸); goto Cõê£Ø¤Ò©; Fœ§à÷ö¼†: if (!$d•áà‘¦†ª || count($d•áà‘¦†ª) <= 0) { return; } $fÛÚÎ•œóŸ = !1; $bõù¤¿Ğ = timeFloat(); goto CÀç£™µáŒ; AÑ£äâŠ¯ : $B ìÏ²Æš =& $_SERVER[ªúæÂ¡­ä½]; $f¼ªÇ‰––Æ = array($B ìÏ²Æš[1629]); $cØğÕ‚‹ğÉ = in_array(strtolower(ACTION), $f¼ªÇ‰––Æ); goto d†á£èÑ£; CÀç£™µáŒ: $FÂ«¸°¢‘â = array(); foreach ($d•áà‘¦†ª as $A¸­ã Ğ±ê => $F‘‹ÒÇˆÎ) { if ($bõù¤¿Ğ - $F‘‹ÒÇˆÎ[$B ìÏ²Æš[1627]] > $F‘‹ÒÇˆÎ[$B ìÏ²Æš[197]]) { $fÛÚÎ•œóŸ = !0; try { Hook::apply($F‘‹ÒÇˆÎ[$B ìÏ²Æš[262]], $F‘‹ÒÇˆÎ[$B ìÏ²Æš[1620]]); write_log($B ìÏ²Æš[1630] . $A¸­ã Ğ±ê . $B ìÏ²Æš[68] . $F‘‹ÒÇˆÎ[$B ìÏ²Æš[262]] . $B ìÏ²Æš[1631] . ACTION, $B ìÏ²Æš[1622]); } catch (Exception $F†­éùœ–ó) { } continue; } $FÂ«¸°¢‘â[$A¸­ã Ğ±ê] = $F‘‹ÒÇˆÎ; } if (!$fÛÚÎ•œóŸ) { return; } goto A•‹ÔŸÕøÇ; d†á£èÑ£: if (!$cØğÕ‚‹ğÉ && !self::$asyncAdd) { return; } $f‡ˆø¥ç›¸ = $B ìÏ²Æš[1625]; $d•áà‘¦†ª = Cache::get($f‡ˆø¥ç›¸, !0); goto Fœ§à÷ö¼†; Cõê£Ø¤Ò©: } public static function finished($DÁò§Ø‹Å, $AÂñ‹ÉÜ«) { $dë­›ù˜æŒ =& $_SERVER[ªúæÂ¡­ä½]; if (!self::$syncTask) { self::$syncTask = array(); } self::$syncTask[] = array($dë­›ù˜æŒ[262] => $DÁò§Ø‹Å, $dë­›ù˜æŒ[1620] => $AÂñ‹ÉÜ«); } private static function finishedRun() { $E´·µ’½¬ =& $_SERVER[ªúæÂ¡­ä½]; if (!self::$syncTask) { return; } foreach (self::$syncTask as $CšÖŸÓó“) { try { Hook::apply($CšÖŸÓó“[$E´·µ’½¬[262]], $CšÖŸÓó“[$E´·µ’½¬[1620]]); } catch (Exception $aÂ¸Àğ¤‡) { } } } public static function autoRun() { self::finishedRun(); self::timeLimitCallLoop(); } } class TaskUnzip extends TaskFileTransfer { protected function startAfter() { goto CøÍÒÌ®ñ; dù°ç¬Ì¥Ğ: Hook::bind($dñ‰Â‚¿â[1104], array($this, $dñ‰Â‚¿â[1634])); $D“‰¢ºŸÜ½ =& $this->task; $D“‰¢ºŸÜ½[$dñ‰Â‚¿â[1635]] = $dñ‰Â‚¿â[1109]; goto EŒÜ†µĞ®—; CøÍÒÌ®ñ: $dñ‰Â‚¿â =& $_SERVER[ªúæÂ¡­ä½]; parent::startAfter(); Hook::bind($dñ‰Â‚¿â[1632], array($this, $dñ‰Â‚¿â[1633])); goto dù°ç¬Ì¥Ğ; EŒÜ†µĞ®—: if (!$D“‰¢ºŸÜ½[$dñ‰Â‚¿â[1445]]) { $D“‰¢ºŸÜ½[$dñ‰Â‚¿â[1445]] = LNG($dñ‰Â‚¿â[1636]); } goto fó‡Üøº; fó‡Üøº: } protected function endAfter() { $E¥‹¢¯©Ô =& $_SERVER[ªúæÂ¡­ä½]; parent::endAfter(); Hook::unbind($E¥‹¢¯©Ô[1632], array($this, $E¥‹¢¯©Ô[1633])); Hook::unbind($E¥‹¢¯©Ô[1104], array($this, $E¥‹¢¯©Ô[1634])); } public function updateAfter() { $d¾‚¿ã¹Ï’ =& $_SERVER[ªúæÂ¡­ä½]; $aÂêÍ…¼›ö =& $this->task; if (!$aÂêÍ…¼›ö[$d¾‚¿ã¹Ï’[1037]] || !$aÂêÍ…¼›ö[$d¾‚¿ã¹Ï’[741]]) { return; } if ($aÂêÍ…¼›ö[$d¾‚¿ã¹Ï’[1635]] == $d¾‚¿ã¹Ï’[1109]) { $DŞÃÅŸ¢šß = 0; if ($aÂêÍ…¼›ö[$d¾‚¿ã¹Ï’[1591]]) { $DŞÃÅŸ¢šß = $aÂêÍ…¼›ö[$d¾‚¿ã¹Ï’[1592]] / $aÂêÍ…¼›ö[$d¾‚¿ã¹Ï’[1591]]; } $aÂêÍ…¼›ö[$d¾‚¿ã¹Ï’[1546]] = $DŞÃÅŸ¢šß * 0.3; } else { if ($aÂêÍ…¼›ö[$d¾‚¿ã¹Ï’[1635]] == $d¾‚¿ã¹Ï’[311]) { $DŞÃÅŸ¢šß = $aÂêÍ…¼›ö[$d¾‚¿ã¹Ï’[1051]] / $aÂêÍ…¼›ö[$d¾‚¿ã¹Ï’[1037]]; $aÂêÍ…¼›ö[$d¾‚¿ã¹Ï’[1546]] = 0.3 + $DŞÃÅŸ¢šß * 0.4; } else { if ($aÂêÍ…¼›ö[$d¾‚¿ã¹Ï’[1635]] == $d¾‚¿ã¹Ï’[107]) { $dá‘ø©×‘ = 0; if ($aÂêÍ…¼›ö[$d¾‚¿ã¹Ï’[1593]] == $d¾‚¿ã¹Ï’[107]) { $dá‘ø©×‘ = $aÂêÍ…¼›ö[$d¾‚¿ã¹Ï’[1592]]; } $DŞÃÅŸ¢šß = ($aÂêÍ…¼›ö[$d¾‚¿ã¹Ï’[1596]] + $dá‘ø©×‘) / $aÂêÍ…¼›ö[$d¾‚¿ã¹Ï’[741]]; $aÂêÍ…¼›ö[$d¾‚¿ã¹Ï’[1546]] = 0.3 + 0.4 + $DŞÃÅŸ¢šß * 0.3; } } } if ($aÂêÍ…¼›ö[$d¾‚¿ã¹Ï’[1546]] > 0) { $F–Îã•Ã¨½ = timeFloat() - $aÂêÍ…¼›ö[$d¾‚¿ã¹Ï’[767]] - $aÂêÍ…¼›ö[$d¾‚¿ã¹Ï’[1549]]; $aÂêÍ…¼›ö[$d¾‚¿ã¹Ï’[1550]] = $F–Îã•Ã¨½ * (1 - $aÂêÍ…¼›ö[$d¾‚¿ã¹Ï’[1546]]) / $aÂêÍ…¼›ö[$d¾‚¿ã¹Ï’[1546]]; } } public function addFile($fæÎ¿£ÑìÇ) { goto DÜ„ù‘¢äÅ; EÒÚ¬«â³: $b²²¶àö¢[$AâËµğÃå“[1037]] = 1; $C¥¿Ï«Ìæ„ = 0; $b²²¶àö¢[$AâËµğÃå“[1600]] = array($AâËµğÃå“[1601] => $C¥¿Ï«Ìæ„ + 1, $AâËµğÃå“[414] => $EÄÜ×Ö´¤ô[$AâËµğÃå“[28]], $AâËµğÃå“[76] => $EÄÜ×Ö´¤ô[$AâËµğÃå“[76]], $AâËµğÃå“[501] => $EÄÜ×Ö´¤ô[$AâËµğÃå“[501]] ? $EÄÜ×Ö´¤ô[$AâËµğÃå“[501]] : $EÄÜ×Ö´¤ô[$AâËµğÃå“[76]]); goto F‘Ãš˜ÛÔ‘; DÜ„ù‘¢äÅ: $AâËµğÃå“ =& $_SERVER[ªúæÂ¡­ä½]; $b²²¶àö¢ =& $this->task; $EÄÜ×Ö´¤ô = IO::info($fæÎ¿£ÑìÇ); goto bõŒˆ¬œ™; f²„ËóÍº—: $b²²¶àö¢[$AâËµğÃå“[1039]] = $AâËµğÃå“[1611]; $b²²¶àö¢[$AâËµğÃå“[1593]] = $AâËµğÃå“[1109]; $b²²¶àö¢[$AâËµğÃå“[741]] = $EÄÜ×Ö´¤ô[$AâËµğÃå“[78]]; goto EÒÚ¬«â³; F‘Ãš˜ÛÔ‘: $this->update(); goto A¤¢ğÂÁš¼; bõŒˆ¬œ™: $b²²¶àö¢[$AâËµğÃå“[1589]] = $EÄÜ×Ö´¤ô[$AâËµğÃå“[28]]; $b²²¶àö¢[$AâËµğÃå“[1591]] = $EÄÜ×Ö´¤ô[$AâËµğÃå“[78]]; $b²²¶àö¢[$AâËµğÃå“[1592]] = 0; goto f²„ËóÍº—; A¤¢ğÂÁš¼: } public function unzipAfter($c¹¿Ã±© –) { goto aÍ¼µÌ‚ÓØ; dÁ…á¤êŞÍ: $this->update(); self::log($bÁ»í…õ[1637] . json_encode(array($aÀšà²ª×‹, $BæÓ¥ÁË’))); goto fÈİœËÊ¦; aÍ¼µÌ‚ÓØ: $bÁ»í…õ =& $_SERVER[ªúæÂ¡­ä½]; $aÀšà²ª×‹ =& $this->task; $aÀšà²ª×‹[$bÁ»í…õ[1635]] = $bÁ»í…õ[107]; goto DØ„—ƒ’²§; cÜ´æÉËŒ: if ($BæÓ¥ÁË’[$bÁ»í…õ[29]] == $bÁ»í…õ[193]) { $aÀšà²ª×‹[$bÁ»í…õ[1037]] = 1; } else { $aÀšà²ª×‹[$bÁ»í…õ[1037]] = $BæÓ¥ÁË’[$bÁ»í…õ[81]][$bÁ»í…õ[79]]; } $aÀšà²ª×‹[$bÁ»í…õ[1039]] = $bÁ»í…õ[33]; $aÀšà²ª×‹[$bÁ»í…õ[1593]] = 0; goto eˆÁŠëÁãÚ; D¦…ÆçË˜¯: $aÀšà²ª×‹[$bÁ»í…õ[1589]] = $bÁ»í…õ[33]; $aÀšà²ª×‹[$bÁ»í…õ[1596]] = 0; $aÀšà²ª×‹[$bÁ»í…õ[741]] = $BæÓ¥ÁË’[$bÁ»í…õ[78]]; goto dÁ…á¤êŞÍ; eˆÁŠëÁãÚ: $aÀšà²ª×‹[$bÁ»í…õ[1051]] = 0; $aÀšà²ª×‹[$bÁ»í…õ[1591]] = 0; $aÀšà²ª×‹[$bÁ»í…õ[1592]] = 0; goto D¦…ÆçË˜¯; DØ„—ƒ’²§: $BæÓ¥ÁË’ = IO::infoWithChildren($c¹¿Ã±© –); $dŒØçğ”Ş = 0; $aÀšà²ª×‹[$bÁ»í…õ[1600]] = array($bÁ»í…õ[1601] => $dŒØçğ”Ş + 1, $bÁ»í…õ[414] => $BæÓ¥ÁË’[$bÁ»í…õ[28]], $bÁ»í…õ[76] => $BæÓ¥ÁË’[$bÁ»í…õ[76]], $bÁ»í…õ[501] => $BæÓ¥ÁË’[$bÁ»í…õ[501]] ? $BæÓ¥ÁË’[$bÁ»í…õ[501]] : $BæÓ¥ÁË’[$bÁ»í…õ[76]]); goto cÜ´æÉËŒ; fÈİœËÊ¦: } public function nameParse($D³ñÊØÀæë) { goto bŒÑ©¾éï¶; B¦¶®°­×: $f‹¤›ğ¬ÃŒ = get_path_this($D³ñÊØÀæë); if (strstr($f‹¤›ğ¬ÃŒ, $e×§ÄŠ¸[95])) { $cÙíÍÅäÃ„[$e×§ÄŠ¸[1051]] += 1; $cÙíÍÅäÃ„[$e×§ÄŠ¸[1037]] += 1; } $cÙíÍÅäÃ„[$e×§ÄŠ¸[1589]] = $D³ñÊØÀæë; goto eßÎÌ”Ï¶; eßÎÌ”Ï¶: $this->update(); goto cˆ‘‘‡‡ìÜ; bŒÑ©¾éï¶: $e×§ÄŠ¸ =& $_SERVER[ªúæÂ¡­ä½]; $cÙíÍÅäÃ„ =& $this->task; if ($cÙíÍÅäÃ„[$e×§ÄŠ¸[1635]] == $e×§ÄŠ¸[1109]) { $cÙíÍÅäÃ„[$e×§ÄŠ¸[1635]] = $e×§ÄŠ¸[311]; $cÙíÍÅäÃ„[$e×§ÄŠ¸[1596]] = 0; $cÙíÍÅäÃ„[$e×§ÄŠ¸[741]] = 0; } goto B¦¶®°­×; cˆ‘‘‡‡ìÜ: } } class TaskZip extends TaskFileTransfer { protected function startAfter() { $bŒ’ì£Şé± =& $_SERVER[ªúæÂ¡­ä½]; parent::startAfter(); Hook::bind($bŒ’ì£Şé±[1638], array($this, $bŒ’ì£Şé±[1633])); $D×‘ŠÈ—¬Á =& $this->task; $D×‘ŠÈ—¬Á[$bŒ’ì£Şé±[1635]] = $bŒ’ì£Şé±[1109]; if (!$D×‘ŠÈ—¬Á[$bŒ’ì£Şé±[1445]]) { $D×‘ŠÈ—¬Á[$bŒ’ì£Şé±[1445]] = LNG($bŒ’ì£Şé±[1639]); } } protected function endAfter() { $b¹Æ‹–ØÀ¡ =& $_SERVER[ªúæÂ¡­ä½]; parent::endAfter(); Hook::unbind($b¹Æ‹–ØÀ¡[1638], array($this, $b¹Æ‹–ØÀ¡[1633])); } public function updateAfter() { $DÊßÚ™ùô± =& $_SERVER[ªúæÂ¡­ä½]; $CÁì ä·²± =& $this->task; if (!$CÁì ä·²±[$DÊßÚ™ùô±[1037]] || !$CÁì ä·²±[$DÊßÚ™ùô±[741]]) { return; } if ($CÁì ä·²±[$DÊßÚ™ùô±[1635]] == $DÊßÚ™ùô±[1109]) { $c´§ÖĞŸ¡ö = $CÁì ä·²±[$DÊßÚ™ùô±[1592]]; if ($CÁì ä·²±[$DÊßÚ™ùô±[1593]] != $DÊßÚ™ùô±[1109]) { $c´§ÖĞŸ¡ö = 0; } $Eèİ£¸»ô = ($CÁì ä·²±[$DÊßÚ™ùô±[1596]] + $c´§ÖĞŸ¡ö) / $CÁì ä·²±[$DÊßÚ™ùô±[741]]; $CÁì ä·²±[$DÊßÚ™ùô±[1546]] = $Eèİ£¸»ô * 0.3; } else { if ($CÁì ä·²±[$DÊßÚ™ùô±[1635]] == $DÊßÚ™ùô±[311]) { $Eèİ£¸»ô = $CÁì ä·²±[$DÊßÚ™ùô±[1051]] / $CÁì ä·²±[$DÊßÚ™ùô±[1037]]; $CÁì ä·²±[$DÊßÚ™ùô±[1546]] = 0.3 + $Eèİ£¸»ô * 0.5; } else { if ($CÁì ä·²±[$DÊßÚ™ùô±[1635]] == $DÊßÚ™ùô±[107]) { $Eèİ£¸»ô = 0; if ($CÁì ä·²±[$DÊßÚ™ùô±[1591]]) { $Eèİ£¸»ô = $CÁì ä·²±[$DÊßÚ™ùô±[1592]] / $CÁì ä·²±[$DÊßÚ™ùô±[1591]]; } $CÁì ä·²±[$DÊßÚ™ùô±[1546]] = 0.3 + 0.5 + $Eèİ£¸»ô * 0.2; } } } if ($CÁì ä·²±[$DÊßÚ™ùô±[1546]] > 0) { $AöĞ…ê³İ = timeFloat() - $CÁì ä·²±[$DÊßÚ™ùô±[767]] - $CÁì ä·²±[$DÊßÚ™ùô±[1549]]; $CÁì ä·²±[$DÊßÚ™ùô±[1550]] = $AöĞ…ê³İ * (1 - $CÁì ä·²±[$DÊßÚ™ùô±[1546]]) / $CÁì ä·²±[$DÊßÚ™ùô±[1546]]; } } public function copyFileStart($a¾£ÌÜÍ÷‘, $d‡±„Ä¿®×, $A¶¬…æíßÌ, $e×«÷Æ‘†Ù, $B‰ÕÉ÷»¦ê, $c‘Ì±‚–õ) { $fŞİãçëèŸ =& $_SERVER[ªúæÂ¡­ä½]; parent::copyFileStart($a¾£ÌÜÍ÷‘, $d‡±„Ä¿®×, $A¶¬…æíßÌ, $e×«÷Æ‘†Ù, $B‰ÕÉ÷»¦ê, $c‘Ì±‚–õ); $a‰ŠÕ¥óª© =& $this->task; if ($a‰ŠÕ¥óª©[$fŞİãçëèŸ[1635]] == $fŞİãçëèŸ[311]) { $a‰ŠÕ¥óª©[$fŞİãçëèŸ[1635]] = $fŞİãçëèŸ[107]; } $this->update(); } public function copyFileEnd($e˜ÅÂ¯±í, $c«ã¦«Ğñ×, $Eä‰®èœ´à, $b³ØŠƒÅ‘÷, $B¸š¸æ…ø, $a¬ñ»Óëˆò) { $f‘´°ºÉì =& $_SERVER[ªúæÂ¡­ä½]; $aĞ÷Ş‚®Ü¯ =& $this->task; $aĞ÷Ş‚®Ü¯[$f‘´°ºÉì[1592]] = $aĞ÷Ş‚®Ü¯[$f‘´°ºÉì[1591]]; $aĞ÷Ş‚®Ü¯[$f‘´°ºÉì[1596]] += $aĞ÷Ş‚®Ü¯[$f‘´°ºÉì[1591]]; $aĞ÷Ş‚®Ü¯[$f‘´°ºÉì[1593]] = $f‘´°ºÉì[33]; $this->update(); } public function nameParse($A¨¸½ãˆÍÖ) { $C·‹¼¯ˆÉß =& $_SERVER[ªúæÂ¡­ä½]; $d™³á²›†ñ =& $this->task; if ($d™³á²›†ñ[$C·‹¼¯ˆÉß[1051]] < $d™³á²›†ñ[$C·‹¼¯ˆÉß[1037]]) { $CåÚçôë„§ = get_path_this($A¨¸½ãˆÍÖ); if (strstr($CåÚçôë„§, $C·‹¼¯ˆÉß[95])) { $d™³á²›†ñ[$C·‹¼¯ˆÉß[1051]] += 1; } } if ($d™³á²›†ñ[$C·‹¼¯ˆÉß[1635]] == $C·‹¼¯ˆÉß[1109]) { $d™³á²›†ñ[$C·‹¼¯ˆÉß[1635]] = $C·‹¼¯ˆÉß[311]; } $d™³á²›†ñ[$C·‹¼¯ˆÉß[1589]] = $A¨¸½ãˆÍÖ; $this->update(); } } goto e§‹Ô’„–Å; aÒ‡¤íÍŠ„: class UserFavModel extends ModelBase { protected $tableName = "\165\163\145\x72\137\146\141\166"; protected function cacheFunctionAlias($fì¸˜®˜¬ ) { $Fæ±‘¥²ïå =& $_SERVER[ªúæÂ¡­ä½]; return array($Fæ±‘¥²ïå[1821] => array(USER_ID, $Fæ±‘¥²ïå[2139])); } protected function listData() { $Ešôƒã¨À® =& $_SERVER[ªúæÂ¡­ä½]; $b¥¨Î¹œä¡ = array($Ešôƒã¨À®[1536] => USER_ID, $Ešôƒã¨À®[464] => 0); $cª‚•Ê‘ª = $Ešôƒã¨À®[2140]; $Aã¯’öŠ­Å = $this->field($cª‚•Ê‘ª)->where($b¥¨Î¹œä¡)->order($Ešôƒã¨À®[2141])->select(); return $Aã¯’öŠ­Å ? $Aã¯’öŠ­Å : array(); } protected function resetCache() { } protected function listView() { goto fÆÃ˜—ò¦‡; AçëÆ•™: $eí¼Ğç¡Ç› = array($cßàµ‘¬Ö²[411] => array($cßàµ‘¬Ö²[412], $BÍè²×£ø¯)); $c ¾°ˆÌÄ¿ = Model($cßàµ‘¬Ö²[808])->listSource($eí¼Ğç¡Ç›, $e¢ßÄ„ƒÍ‘); $c ¾°ˆÌÄ¿ = array_merge($c ¾°ˆÌÄ¿[$cßàµ‘¬Ö²[74]], $c ¾°ˆÌÄ¿[$cßàµ‘¬Ö²[75]]); goto f¥ ğ¯¡ˆ•; fÆÃ˜—ò¦‡: $cßàµ‘¬Ö² =& $_SERVER[ªúæÂ¡­ä½]; $FùÏ™†‹·Ã = $this->listData(); $aêÈ©Â™Ï± = array_filter_by_field($FùÏ™†‹·Ã, $cßàµ‘¬Ö²[29], $cßàµ‘¬Ö²[410]); goto CÜÚ©¯ Š×; f¥ ğ¯¡ˆ•: $c ¾°ˆÌÄ¿ = array_to_keyvalue($c ¾°ˆÌÄ¿, $cßàµ‘¬Ö²[396]); foreach ($FùÏ™†‹·Ã as $fóçñÊó‰ => $C³Ù—¾í‹) { $B¦ëÑ¶©ê‰ = $c ¾°ˆÌÄ¿[$C³Ù—¾í‹[$cßàµ‘¬Ö²[76]]]; $B¦ëÑ¶©ê‰ = $B¦ëÑ¶©ê‰ ? $B¦ëÑ¶©ê‰ : array(); $FùÏ™†‹·Ã[$fóçñÊó‰] = array_merge($B¦ëÑ¶©ê‰, $C³Ù—¾í‹); } return $FùÏ™†‹·Ã; goto DáÂ˜­ÏÎ; CÜÚ©¯ Š×: $BÍè²×£ø¯ = array_to_keyvalue($aêÈ©Â™Ï±, $cßàµ‘¬Ö²[33], $cßàµ‘¬Ö²[76]); if (!$BÍè²×£ø¯) { return $FùÏ™†‹·Ã; } $e¢ßÄ„ƒÍ‘ = 2000; goto AçëÆ•™; DáÂ˜­ÏÎ: } protected function addFav($FØ´ƒ®¡½î, $d­Á÷¯˜… = '', $DÚ¼Ñ¥àè = "\x73\x6f\x75\x72\143\145") { goto FœÀ‹½©Æ·; cîº¸‘òĞ: return $this->add($C¼§ãÅøÚß); goto E¯”‚©á¡²; FœÀ‹½©Æ·: $AŸÑìÜ»á½ =& $_SERVER[ªúæÂ¡­ä½]; $e®ãøöÍ = array($AŸÑìÜ»á½[1536] => USER_ID, $AŸÑìÜ»á½[464] => 0, $AŸÑìÜ»á½[416] => $DÚ¼Ñ¥àè, $AŸÑìÜ»á½[415] => $FØ´ƒ®¡½î); if ($this->where($e®ãøöÍ)->find()) { return !1; } goto EÊÄƒ’æ•ç; aŠ›¥¡‚á: if (!$d­Á÷¯˜… && $DÚ¼Ñ¥àè == $AŸÑìÜ»á½[410]) { $bŒŒÉ»à¼Í = Model($AŸÑìÜ»á½[1221])->where(array($AŸÑìÜ»á½[411] => $FØ´ƒ®¡½î))->find(); if (!$bŒŒÉ»à¼Í) { return !1; } $d­Á÷¯˜… = $bŒŒÉ»à¼Í[$AŸÑìÜ»á½[28]]; } $d­Á÷¯˜… = $this->getAutoName($d­Á÷¯˜…); $C¼§ãÅøÚß = array($AŸÑìÜ»á½[1536] => USER_ID, $AŸÑìÜ»á½[464] => 0, $AŸÑìÜ»á½[414] => $d­Á÷¯˜…, $AŸÑìÜ»á½[415] => $FØ´ƒ®¡½î, $AŸÑìÜ»á½[416] => $DÚ¼Ñ¥àè, $AŸÑìÜ»á½[1718] => $AŠ‡Õñ‘í¶ + 1); goto cîº¸‘òĞ; EÊÄƒ’æ•ç: $e®ãøöÍ = array($AŸÑìÜ»á½[1536] => USER_ID, $AŸÑìÜ»á½[464] => 0); $AŠ‡Õñ‘í¶ = $this->where($e®ãøöÍ)->max($AŸÑìÜ»á½[1737]); if (!$AŠ‡Õñ‘í¶) { $AŠ‡Õñ‘í¶ = 0; } goto aŠ›¥¡‚á; E¯”‚©á¡²: } protected function remove($cõé»åê­ª) { $D‰«¦‘óöø =& $_SERVER[ªúæÂ¡­ä½]; $DÂÈñ‡áÙ = array($D‰«¦‘óöø[1536] => USER_ID, $D‰«¦‘óöø[413] => $cõé»åê­ª); return $this->where($DÂÈñ‡áÙ)->delete(); } protected function removeByName($fóó¹Ì¢Óğ) { $bš‚³Ğ³†á =& $_SERVER[ªúæÂ¡­ä½]; $d¡ÚÆ‰ñãì = array($bš‚³Ğ³†á[1536] => USER_ID, $bš‚³Ğ³†á[414] => $fóó¹Ì¢Óğ, $bš‚³Ğ³†á[464] => 0); return $this->where($d¡ÚÆ‰ñãì)->delete(); } protected function rename($F¤Õ«‘ …Æ, $c„¶ÀÛÊì) { $cæ¦à¬° =& $_SERVER[ªúæÂ¡­ä½]; if ($F¤Õ«‘ …Æ == $c„¶ÀÛÊì) { return !1; } $e†¯ŒßïÉ‚ = $this->getAutoName($c„¶ÀÛÊì); if ($c„¶ÀÛÊì != $e†¯ŒßïÉ‚) { return !1; } $a¿Ù‚®ôÁí = array($cæ¦à¬°[1536] => USER_ID, $cæ¦à¬°[464] => 0, $cæ¦à¬°[28] => $F¤Õ«‘ …Æ); return $this->where($a¿Ù‚®ôÁí)->save(array($cæ¦à¬°[28] => $c„¶ÀÛÊì)); } protected function resetSort($Dó©æ©¬¼„) { $d¯ÕÜÎ˜¨• =& $_SERVER[ªúæÂ¡­ä½]; $Dó©æ©¬¼„ = is_array($Dó©æ©¬¼„) ? $Dó©æ©¬¼„ : array(); $D× íâ­•Á = array($d¯ÕÜÎ˜¨•[1536] => USER_ID); for ($D¶‹—°ï = 0; $D¶‹—°ï < count($Dó©æ©¬¼„); $D¶‹—°ï++) { $D× íâ­•Á[$d¯ÕÜÎ˜¨•[413]] = $Dó©æ©¬¼„[$D¶‹—°ï]; $this->where($D× íâ­•Á)->save(array($d¯ÕÜÎ˜¨•[1718] => $D¶‹—°ï + 1)); } return !0; } protected function moveTop($bŸñ¤Ğ¨³Ğ) { goto A»‘”Å„ê ; A»‘”Å„ê : $Bè“ÚŸª·Õ =& $_SERVER[ªúæÂ¡­ä½]; $e³•·¸¢Õ = array($Bè“ÚŸª·Õ[1536] => USER_ID, $Bè“ÚŸª·Õ[464] => 0); $FÃ¸éà«Ø¶ = $this->where($e³•·¸¢Õ)->where(array($Bè“ÚŸª·Õ[28] => $bŸñ¤Ğ¨³Ğ))->find(); goto då„Ô¯òìÆ; då„Ô¯òìÆ: if (!$FÃ¸éà«Ø¶) { return; } $A ‡©İ¿Š = $this->field($Bè“ÚŸª·Õ[394])->where($e³•·¸¢Õ)->order($Bè“ÚŸª·Õ[2141])->select(); $A ‡©İ¿Š = array_to_keyvalue($A ‡©İ¿Š, $Bè“ÚŸª·Õ[33], $Bè“ÚŸª·Õ[394]); goto cè…ƒ•°Ì£; cè…ƒ•°Ì£: $E¤Ú‘¬ù‹¤ = $A ‡©İ¿Š; $A ‡©İ¿Š = array_remove_value($A ‡©İ¿Š, $FÃ¸éà«Ø¶[$Bè“ÚŸª·Õ[394]]); array_unshift($A ‡©İ¿Š, $FÃ¸éà«Ø¶[$Bè“ÚŸª·Õ[394]]); goto EÙ‡ ­Öò¹; EÙ‡ ­Öò¹: return $this->resetSort($A ‡©İ¿Š); goto F•ìÏ­¼Â’; F•ìÏ­¼Â’: } protected function moveBottom($d§ƒ¬Ñ‚Ÿù) { $f²×Ş‘ñ‚„ =& $_SERVER[ªúæÂ¡­ä½]; $ağ¤Œ›îÍ· = array($f²×Ş‘ñ‚„[1536] => USER_ID, $f²×Ş‘ñ‚„[464] => 0); $Eæˆ˜‘·ÏÒ = $this->where($ağ¤Œ›îÍ·)->max($f²×Ş‘ñ‚„[1737]); $C†îà»ğ¶— = array($f²×Ş‘ñ‚„[1737] => $Eæˆ˜‘·ÏÒ + 1); return $this->where($ağ¤Œ›îÍ·)->where(array($f²×Ş‘ñ‚„[28] => $d§ƒ¬Ñ‚Ÿù))->save($C†îà»ğ¶—); } private function getAutoName($a‰ÓÏŞª‡‹) { goto F¥¼¡†Úß; F¥¼¡†Úß: $aíæäŠê• =& $_SERVER[ªúæÂ¡­ä½]; $e‘‹Š§ù¨³ = array($aíæäŠê•[1536] => USER_ID, $aíæäŠê•[464] => 0); $AˆÊæ³ÆÁ = $this->field($aíæäŠê•[28])->where($e‘‹Š§ù¨³)->select(); goto BÚó‚Éê±Ç; BÚó‚Éê±Ç: $AˆÊæ³ÆÁ = array_to_keyvalue($AˆÊæ³ÆÁ, $aíæäŠê•[33], $aíæäŠê•[28]); if (!$AˆÊæ³ÆÁ || !in_array($a‰ÓÏŞª‡‹, $AˆÊæ³ÆÁ)) { return $a‰ÓÏŞª‡‹; } for ($bÜÔœ¼‰â¨ = 0; $bÜÔœ¼‰â¨ < count($AˆÊæ³ÆÁ); $bÜÔœ¼‰â¨++) { if (!in_array($a‰ÓÏŞª‡‹ . "\50{$bÜÔœ¼‰â¨}\51", $AˆÊæ³ÆÁ)) { return $a‰ÓÏŞª‡‹ . "\x28{$bÜÔœ¼‰â¨}\x29"; } } goto BÔ…·Ï‡Ëˆ; BÔ…·Ï‡Ëˆ: return $a‰ÓÏŞª‡‹ . "\50{$bÜÔœ¼‰â¨}\51"; goto aÄ–ºÉÒÏÜ; aÄ–ºÉÒÏÜ: } } class UserJobModel extends ModelBaseLight { public $optionType = "\123\171\x73\164\145\155\x2e\152\x6f\142\114\x69\x73\164"; public $field = array("\x6e\x61\155\x65", "\x64\145\163\x63", "\163\157\x72\x74"); const JOB_KEY = "\163\x65\x6c\146\x4a\x6f\x62\x4c\151\x73\164"; public function listData($béŠ‹æˆ¸ˆ = false, $f×Ä£ƒ¹³ = "\x73\x6f\162\x74", $Cö¦·ÇËğ“ = false) { return parent::listData($béŠ‹æˆ¸ˆ, $f×Ä£ƒ¹³, $Cö¦·ÇËğ“); } public function remove($bª†Ã†ğ±) { return parent::remove($bª†Ã†ğ±); } public function add($aˆäÛØ˜”) { $E¶—Ö˜ÚÏŞ =& $_SERVER[ªúæÂ¡­ä½]; if ($this->findByName($aˆäÛØ˜”[$E¶—Ö˜ÚÏŞ[28]])) { return !1; } $aˆäÛØ˜”[$E¶—Ö˜ÚÏŞ[1737]] = $this->getSort(); return parent::insert($aˆäÛØ˜”); } private function getSort() { $d’ù¨İˆ‡ =& $_SERVER[ªúæÂ¡­ä½]; $D‰Ì‰’„Â = parent::listData(); $dóÏÉíòå = array_to_keyvalue($D‰Ì‰’„Â, $d’ù¨İˆ‡[33], $d’ù¨İˆ‡[1737]); return empty($dóÏÉíòå) ? 0 : max($dóÏÉíòå) + 1; } public function update($F»˜Ô¡îÛ, $EÈ¢§´ğ¦÷) { $BÜŠ™ß„»° =& $_SERVER[ªúæÂ¡­ä½]; $BÁ¬™åê’ˆ = parent::listData($F»˜Ô¡îÛ); $dÀÏé’ùâÂ = $this->findByName($EÈ¢§´ğ¦÷[$BÜŠ™ß„»°[28]]); if (!$BÁ¬™åê’ˆ || $dÀÏé’ùâÂ && $dÀÏé’ùâÂ[$BÜŠ™ß„»°[394]] != $BÁ¬™åê’ˆ[$BÜŠ™ß„»°[394]]) { return !1; } return parent::update($F»˜Ô¡îÛ, $EÈ¢§´ğ¦÷); } public function setUserJob($Dºñ±Àà, $C ˆÜôß•¶) { goto b´¦ôÙÑùÎ; aÀçò¡Š”Í: $F½è¦ñ°…ç = array_to_keyvalue($FÒ±Ş¼ÚƒÑ, $c“ç§º‹Ş¥[28]); $AÚ¹×©¸ê = $c“ç§º‹Ş¥[375]; foreach ($C ˆÜôß•¶ as $BÖªïƒÅ) { if ($F½è¦ñ°…ç[$BÖªïƒÅ]) { $AÚ¹×©¸ê .= $F½è¦ñ°…ç[$BÖªïƒÅ][$c“ç§º‹Ş¥[394]] . $c“ç§º‹Ş¥[47]; } else { $A÷—ŸÛ¤– = $this->add($BÖªïƒÅ); $AÚ¹×©¸ê .= $A÷—ŸÛ¤– . $c“ç§º‹Ş¥[47]; } } goto b­ÂÖ©ÊÌõ; b­ÂÖ©ÊÌõ: $AÚ¹×©¸ê = rtrim($AÚ¹×©¸ê, $c“ç§º‹Ş¥[47]); Model($c“ç§º‹Ş¥[520])->metaSet($Dºñ±Àà, self::JOB_KEY, $AÚ¹×©¸ê); goto Cå¶±÷ó«; b´¦ôÙÑùÎ: $c“ç§º‹Ş¥ =& $_SERVER[ªúæÂ¡­ä½]; if (!is_array($C ˆÜôß•¶)) { $C ˆÜôß•¶ = array($C ˆÜôß•¶); } $FÒ±Ş¼ÚƒÑ = parent::listData(); goto aÀçò¡Š”Í; Cå¶±÷ó«: } public function getUserJob($Fá‰Ê§º¤¦) { $dòËôª¦Óá = Model($_SERVER[ªúæÂ¡­ä½][520])->metaGet($Fá‰Ê§º¤¦); return $this->getUserJobInfo($dòËôª¦Óá[self::JOB_KEY]); } public function getUserJobInfo($DŸ°ŒÄ¦) { goto CÆ¡¾£ˆ®‚; CÆ¡¾£ˆ®‚: $cáóñ°âíÂ =& $_SERVER[ªúæÂ¡­ä½]; $DÅŠÇùÛŸ¶ = explode($cáóñ°âíÂ[47], $DŸ°ŒÄ¦); $f˜ºƒÚîœ¯ = parent::listData(); goto aïÙÆ¤‚†; eŸ¨¬©ª‚º: return $A³Ï¥×öøÉ; goto b¯²Öò‡­í; aïÙÆ¤‚†: $f˜ºƒÚîœ¯ = array_remove_key($f˜ºƒÚîœ¯, $cáóñ°âíÂ[194]); $A³Ï¥×öøÉ = array(); foreach ($DÅŠÇùÛŸ¶ as $BªÕ‡×Ášù) { if (isset($f˜ºƒÚîœ¯[$BªÕ‡×Ášù])) { $A³Ï¥×öøÉ[] = $f˜ºƒÚîœ¯[$BªÕ‡×Ášù]; } } goto eŸ¨¬©ª‚º; b¯²Öò‡­í: } } class UserModel extends ModelBase { protected $tableName = "\165\x73\145\162"; protected $tableMeta = array("\x74\141\142\x6c\145\x4e\141\155\145" => "\165\x73\x65\x72\137\x6d\145\x74\141", "\155\x65\164\x61\x46\151\145\x6c\x64" => "\165\163\145\x72\x49\x44"); protected $simpleField = "\165\163\x65\162\111\104\x2c\x6e\151\x63\x6b\116\141\x6d\x65\54\x6e\x61\x6d\x65\x2c\141\166\x61\164\141\x72\54\x73\145\x78\x2c\163\x74\141\x74\x75\x73"; const ERROR_USER_NOT_EXISTS = -1; const ERROR_USER_PASSWORD_ERROR = -2; const ERROR_USER_EXIST_NAME = -3; const ERROR_USER_EXIST_PHONE = -4; const ERROR_USER_EXIST_EMAIL = -5; const ERROR_USER_LOGIN_LOCK = -6; const ERROR_IP_NOT_ALLOW = -7; const ERROR_USER_EXIST_NICKNAME = -8; protected function cacheFunctionAlias($F¯İ×ÍöÑ») { $A…à‰ŠƒŒ =& $_SERVER[ªúæÂ¡­ä½]; $f¿î‚ë’‚ä = $A…à‰ŠƒŒ[2142]; return array($A…à‰ŠƒŒ[1788] => array($F¯İ×ÍöÑ»[0], $f¿î‚ë’‚ä), $A…à‰ŠƒŒ[1790] => array($F¯İ×ÍöÑ»[0], $f¿î‚ë’‚ä), $A…à‰ŠƒŒ[2143] => array($F¯İ×ÍöÑ»[0], $f¿î‚ë’‚ä)); } protected function getInfo($EÅ®½‰àˆ¾, $E°–óâ‰æŠ = false) { $cë³ƒ¸ĞïÚ = $this->getInfoSimple($EÅ®½‰àˆ¾); if (!is_array($cë³ƒ¸ĞïÚ)) { return array(); } if ($E°–óâ‰æŠ) { return $this->_getInfoApply($cë³ƒ¸ĞïÚ); } return $this->cacheFunctionGet($_SERVER[ªúæÂ¡­ä½][1792], $EÅ®½‰àˆ¾); } protected function getInfoFull($BÉ«ŸÙõšµ, $FœØÛ—“» = false) { $bÏ¥ªèÅëˆ = $this->getInfoSimple($BÉ«ŸÙõšµ); if (!is_array($bÏ¥ªèÅëˆ)) { return array(); } if ($FœØÛ—“») { return $this->_getInfoApply($bÏ¥ªèÅëˆ, !0); } return $this->cacheFunctionGet($_SERVER[ªúæÂ¡­ä½][2144], $BÉ«ŸÙõšµ); } private function _getInfoApply($eÒàÛë°, $FÜ™ÈÅÁğ = false) { goto cô©Ç¢Öâ¶; Câ‹ÌÒÓ¦: $eÒàÛë°[$aù£ÑÂ”¡ [85]][$aù£ÑÂ”¡ [1978]] = isset($FëôŸ¢íùæ[$aù£ÑÂ”¡ [1979]]) ? $FëôŸ¢íùæ[$aù£ÑÂ”¡ [1979]] : null; if ($FÜ™ÈÅÁğ) { $eÒàÛë°[$aù£ÑÂ”¡ [446]] = $this->metaGet($eÒàÛë°[$aù£ÑÂ”¡ [1545]]); } return $eÒàÛë°; goto b˜Éš”ŒÍ; C¡Ó„ §—Å: $eÒàÛë° = $this->_listDataApplyItem($eÒàÛë°); $FëôŸ¢íùæ = Model($aù£ÑÂ”¡ [1221])->metaGet($eÒàÛë°[$aù£ÑÂ”¡ [85]][$aù£ÑÂ”¡ [396]]); $eÒàÛë°[$aù£ÑÂ”¡ [2147]] = $AèåŒŒ¦…; goto Câ‹ÌÒÓ¦; cô©Ç¢Öâ¶: $aù£ÑÂ”¡  =& $_SERVER[ªúæÂ¡­ä½]; if (!$eÒàÛë°) { return $eÒàÛë°; } $AèåŒŒ¦… = md5($aù£ÑÂ”¡ [2145] . $eÒàÛë°[$aù£ÑÂ”¡ [866]] . $aù£ÑÂ”¡ [2146] . $eÒàÛë°[$aù£ÑÂ”¡ [28]]); goto C¡Ó„ §—Å; b˜Éš”ŒÍ: } protected function getInfoSimple($bøéÒñ´à, $b«•ÏÇ³îñ = false) { $DÒÄŞ…Ÿ” =& $_SERVER[ªúæÂ¡­ä½]; if (!$bøéÒñ´à) { return array(); } if ($b«•ÏÇ³îñ) { $EÍöÅ¦îÓò = $this->where(array($DÒÄŞ…Ÿ”[1545] => intval($bøéÒñ´à)))->find(); if (!is_array($EÍöÅ¦îÓò)) { return array(); } $EÍöÅ¦îÓò[$DÒÄŞ…Ÿ”[2148]] = Action($DÒÄŞ…Ÿ”[2149])->parseUrl($EÍöÅ¦îÓò[$DÒÄŞ…Ÿ”[2148]]); return $EÍöÅ¦îÓò; } return $this->cacheFunctionGet($DÒÄŞ…Ÿ”[1793], $bøéÒñ´à); } protected function getInfoSimpleOuter($BÄƒ¯‘¶») { goto EÅ÷Öˆø‰; D¥¯ö±‡ë: return $F£Åéá¡ÊË; goto CÆŒ¶Ü±ÇÊ; EÔÀíƒ©: $F£Åéá¡ÊË = array_field_key($F³ƒ¿­Œæ…, explode($AïÇ£Å–¶ˆ[47], $this->simpleField)); if (!$F£Åéá¡ÊË) { return array($AïÇ£Å–¶ˆ[1545] => $AïÇ£Å–¶ˆ[1100], $AïÇ£Å–¶ˆ[28] => $AïÇ£Å–¶ˆ[160] . LNG($AïÇ£Å–¶ˆ[2152]) . $AïÇ£Å–¶ˆ[518], $AïÇ£Å–¶ˆ[2148] => STATIC_PATH . $AïÇ£Å–¶ˆ[2153]); } $F£Åéá¡ÊË[$AïÇ£Å–¶ˆ[2148]] = Action($AïÇ£Å–¶ˆ[2149])->parseUrl($F£Åéá¡ÊË[$AïÇ£Å–¶ˆ[2148]]); goto D¥¯ö±‡ë; EÅ÷Öˆø‰: $AïÇ£Å–¶ˆ =& $_SERVER[ªúæÂ¡­ä½]; if (!$BÄƒ¯‘¶» || $BÄƒ¯‘¶» == 0) { return array($AïÇ£Å–¶ˆ[1545] => $AïÇ£Å–¶ˆ[191], $AïÇ£Å–¶ˆ[28] => $AïÇ£Å–¶ˆ[160] . LNG($AïÇ£Å–¶ˆ[2150]) . $AïÇ£Å–¶ˆ[518], $AïÇ£Å–¶ˆ[2148] => STATIC_PATH . $AïÇ£Å–¶ˆ[2151]); } $F³ƒ¿­Œæ… = $this->cacheFunctionGet($AïÇ£Å–¶ˆ[1793], $BÄƒ¯‘¶»); goto EÔÀíƒ©; CÆŒ¶Ü±ÇÊ: } protected function groupUser($b…×¿²œõº) { } public static function errorLang($aê§ğ¢í¯) { $E‹µàãÔÛ¾ =& $_SERVER[ªúæÂ¡­ä½]; $bÑêÚõÇŠ = array(self::ERROR_USER_NOT_EXISTS => $E‹µàãÔÛ¾[2154], self::ERROR_USER_PASSWORD_ERROR => $E‹µàãÔÛ¾[2155], self::ERROR_USER_EXIST_NAME => $E‹µàãÔÛ¾[2156], self::ERROR_USER_EXIST_PHONE => $E‹µàãÔÛ¾[2157], self::ERROR_USER_EXIST_EMAIL => $E‹µàãÔÛ¾[2158], self::ERROR_USER_LOGIN_LOCK => $E‹µàãÔÛ¾[2159], self::ERROR_IP_NOT_ALLOW => $E‹µàãÔÛ¾[2160], self::ERROR_USER_EXIST_NICKNAME => $E‹µàãÔÛ¾[2161]); return LNG($bÑêÚõÇŠ[$aê§ğ¢í¯]); } public function getInfoByMeta($F‘¨šÚÆò«, $Cœ¹ã‰Ô) { $Eòá—ê¤ƒ¿ =& $_SERVER[ªúæÂ¡­ä½]; $e£ÖßöÔ³° = Model($Eòá—ê¤ƒ¿[2162])->where(array($Eòá—ê¤ƒ¿[93] => $F‘¨šÚÆò«, $Eòá—ê¤ƒ¿[372] => $Cœ¹ã‰Ô))->find(); if ($e£ÖßöÔ³°) { return $this->getInfo($e£ÖßöÔ³°[$Eòá—ê¤ƒ¿[1545]]); } return !1; } public function userLoginCheck($a—òÖç£, $D´Ù°Äè‚ù) { $fÎÚ§µµêÙ =& $_SERVER[ªúæÂ¡­ä½]; $fĞ£²Õ¼…‘ = $this->userLoginFind($a—òÖç£); if (!$fĞ£²Õ¼…‘) { return UserModel::ERROR_USER_NOT_EXISTS; } if (!$this->userPasswordCheck($fĞ£²Õ¼…‘[$fÎÚ§µµêÙ[1545]], $D´Ù°Äè‚ù)) { return UserModel::ERROR_USER_PASSWORD_ERROR; } return $this->getInfo($fĞ£²Õ¼…‘[$fÎÚ§µµêÙ[1545]]); } public function userLoginFind($aøÃ±À¨‡¬) { $fñº—šÈ‰³ =& $_SERVER[ªúæÂ¡­ä½]; $FåªÇó‚­ = array($fñº—šÈ‰³[28] => $aøÃ±À¨‡¬, $fñº—šÈ‰³[1982] => $aøÃ±À¨‡¬, $fñº—šÈ‰³[303] => $aøÃ±À¨‡¬, $fñº—šÈ‰³[2163] => $aøÃ±À¨‡¬, $fñº—šÈ‰³[974] => $fñº—šÈ‰³[976]); if ($this->nickNameRpt()) { unset($FåªÇó‚­[$fñº—šÈ‰³[1982]]); } return $this->where($FåªÇó‚­)->find(); } public function clearCache($cïçºÊæÊ‹) { $d‡¿İÇ‡ÛŠ =& $_SERVER[ªúæÂ¡­ä½]; $this->cacheFunctionClear($d‡¿İÇ‡ÛŠ[1792], $cïçºÊæÊ‹); $this->cacheFunctionClear($d‡¿İÇ‡ÛŠ[1793], $cïçºÊæÊ‹); $this->cacheFunctionClear($d‡¿İÇ‡ÛŠ[2144], $cïçºÊæÊ‹); } public function userPasswordCheck($eõ­²µçÍ, $aÏàà«œÇ) { $fÙÏöõ†äª =& $_SERVER[ªúæÂ¡­ä½]; $BØ¹ğÅÕ‰ = $this->where(array($fÙÏöõ†äª[1545] => intval($eõ­²µçÍ)))->find(); $CÍ„Ÿ–ˆ°Û = $this->metaGet($eõ­²µçÍ); $e×«ºÕÏ½™ = isset($CÍ„Ÿ–ˆ°Û[$fÙÏöõ†äª[2164]]) ? $CÍ„Ÿ–ˆ°Û[$fÙÏöõ†äª[2164]] : $fÙÏöõ†äª[33]; if (md5($e×«ºÕÏ½™ . trim($aÏàà«œÇ)) !== $BØ¹ğÅÕ‰[$fÙÏöõ†äª[866]]) { return !1; } return !0; } public function userAdd($bßÌÊ¯÷³¡) { goto CÃİğÈ»ƒ; CÃİğÈ»ƒ: $DØ¾í¡Õœ› =& $_SERVER[ªúæÂ¡­ä½]; $E™ÆÚõ§œ¶ = array($DØ¾í¡Õœ›[414] => $bßÌÊ¯÷³¡[$DØ¾í¡Õœ›[28]], $DØ¾í¡Õœ›[2165] => $bßÌÊ¯÷³¡[$DØ¾í¡Õœ›[1425]], $DØ¾í¡Õœ›[2166] => isset($bßÌÊ¯÷³¡[$DØ¾í¡Õœ›[303]]) ? $bßÌÊ¯÷³¡[$DØ¾í¡Õœ›[303]] : $DØ¾í¡Õœ›[33], $DØ¾í¡Õœ›[2167] => isset($bßÌÊ¯÷³¡[$DØ¾í¡Õœ›[2163]]) ? $bßÌÊ¯÷³¡[$DØ¾í¡Õœ›[2163]] : $DØ¾í¡Õœ›[33], $DØ¾í¡Õœ›[2168] => isset($bßÌÊ¯÷³¡[$DØ¾í¡Õœ›[1982]]) ? $bßÌÊ¯÷³¡[$DØ¾í¡Õœ›[1982]] : $bßÌÊ¯÷³¡[$DØ¾í¡Õœ›[28]], $DØ¾í¡Õœ›[2169] => isset($bßÌÊ¯÷³¡[$DØ¾í¡Õœ›[2148]]) ? $bßÌÊ¯÷³¡[$DØ¾í¡Õœ›[2148]] : $DØ¾í¡Õœ›[33], $DØ¾í¡Õœ›[2170] => isset($bßÌÊ¯÷³¡[$DØ¾í¡Õœ›[2171]]) ? $bßÌÊ¯÷³¡[$DØ¾í¡Õœ›[2171]] : 1, $DØ¾í¡Õœ›[2172] => $bßÌÊ¯÷³¡[$DØ¾í¡Õœ›[866]], $DØ¾í¡Õœ›[1794] => isset($bßÌÊ¯÷³¡[$DØ¾í¡Õœ›[1698]]) ? $bßÌÊ¯÷³¡[$DØ¾í¡Õœ›[1698]] : 1024 * 1024 * 20, $DØ¾í¡Õœ›[1795] => 0, $DØ¾í¡Õœ›[2173] => 0, $DØ¾í¡Õœ›[1837] => isset($bßÌÊ¯÷³¡[$DØ¾í¡Õœ›[728]]) ? $bßÌÊ¯÷³¡[$DØ¾í¡Õœ›[728]] : 1); if (!empty($bßÌÊ¯÷³¡[$DØ¾í¡Õœ›[1545]])) { $E™ÆÚõ§œ¶[$DØ¾í¡Õœ›[1545]] = $bßÌÊ¯÷³¡[$DØ¾í¡Õœ›[1545]]; } goto E‡«ÑïŞŸ; Dãš¼¬…êä: return $e±”§ÎÄ‚§; goto F‰ÒçğÖ; E‡«ÑïŞŸ: $FÉß¨¦š–¿ = $this->_checkExist($bßÌÊ¯÷³¡); if ($FÉß¨¦š–¿ !== !0) { return $FÉß¨¦š–¿; } $e±”§ÎÄ‚§ = $this->add($E™ÆÚõ§œ¶); goto f¥ğ‹Úğ†è; f¥ğ‹Úğ†è: $d‡å¸‰­“¶ = array($DØ¾í¡Õœ›[2172] => $E™ÆÚõ§œ¶[$DØ¾í¡Õœ›[866]], $DØ¾í¡Õœ›[2168] => $E™ÆÚõ§œ¶[$DØ¾í¡Õœ›[1982]]); $this->userEdit($e±”§ÎÄ‚§, $d‡å¸‰­“¶); Model($DØ¾í¡Õœ›[1221])->userRootAdd($e±”§ÎÄ‚§); goto Dãš¼¬…êä; F‰ÒçğÖ: } protected function userEditTest($còà“šĞÁ, $e™‹Ë’ğï) { return $this->call($_SERVER[ªúæÂ¡­ä½][2174], $còà“šĞÁ, $e™‹Ë’ğï); } protected function userEdit($dƒƒÍíÅï, $cØ¸š‚ƒË¼) { goto A¢ŞÖëÛìĞ; EöÃ¼ºœ»¼: $dôÂ×ÓÌ¡Ò = $this->_checkExist($cØ¸š‚ƒË¼, $dƒƒÍíÅï); if ($dôÂ×ÓÌ¡Ò !== !0) { return $dôÂ×ÓÌ¡Ò; } if (isset($cØ¸š‚ƒË¼[$cöğò§Øé’[866]]) && trim($cØ¸š‚ƒË¼[$cöğò§Øé’[866]]) != $cöğò§Øé’[33]) { $eÄ™ñáùÎ = $this->metaGet($dƒƒÍíÅï); if (empty($eÄ™ñáùÎ[$cöğò§Øé’[2164]])) { $eÄ™ñáùÎ[$cöğò§Øé’[2164]] = rand_string(10); Model($cöğò§Øé’[495])->metaSet($dƒƒÍíÅï, $cöğò§Øé’[2164], $eÄ™ñáùÎ[$cöğò§Øé’[2164]]); } $cØ¸š‚ƒË¼[$cöğò§Øé’[866]] = md5($eÄ™ñáùÎ[$cöğò§Øé’[2164]] . trim($cØ¸š‚ƒË¼[$cöğò§Øé’[866]])); } else { unset($cØ¸š‚ƒË¼[$cöğò§Øé’[866]]); } goto D˜í×å–Í¯; D˜í×å–Í¯: $this->where(array($cöğò§Øé’[1536] => $dƒƒÍíÅï))->save($cØ¸š‚ƒË¼); if (isset($cØ¸š‚ƒË¼[$cöğò§Øé’[1982]])) { $this->setNamePinyin($dƒƒÍíÅï, $cØ¸š‚ƒË¼[$cöğò§Øé’[1982]]); } $this->clearCache($dƒƒÍíÅï); goto FÊªÊƒ¯¬Ò; FÊªÊƒ¯¬Ò: return !0; goto D˜Š‘åù¥‹; A¢ŞÖëÛìĞ: $cöğò§Øé’ =& $_SERVER[ªúæÂ¡­ä½]; $eŞõ¤ƒ–° = $this->getInfoSimple($dƒƒÍíÅï); if (!$eŞõ¤ƒ–°) { return !1; } goto EöÃ¼ºœ»¼; D˜Š‘åù¥‹: } public function setNamePinyin($A¡—ëİã†ô, $Eéƒùª¢´ = false) { $BôÇõ¿Œ‚§ =& $_SERVER[ªúæÂ¡­ä½]; if (!$Eéƒùª¢´) { $Eá§‘Ú“Á = $this->getInfoSimple($A¡—ëİã†ô); $Eéƒùª¢´ = $Eá§‘Ú“Á[$BôÇõ¿Œ‚§[1982]] ? $Eá§‘Ú“Á[$BôÇõ¿Œ‚§[1982]] : $Eá§‘Ú“Á[$BôÇõ¿Œ‚§[28]]; } $D…¾©ƒ™ºÈ = Model($BôÇõ¿Œ‚§[520]); if (!Input::check($Eéƒùª¢´, $BôÇõ¿Œ‚§[570])) { return $D…¾©ƒ™ºÈ->metaSet($A¡—ëİã†ô, array($BôÇõ¿Œ‚§[445] => $BôÇõ¿Œ‚§[33], $BôÇõ¿Œ‚§[444] => $BôÇõ¿Œ‚§[33])); } return $D…¾©ƒ™ºÈ->metaSet($A¡—ëİã†ô, array($BôÇõ¿Œ‚§[445] => str_replace($BôÇõ¿Œ‚§[50], $BôÇõ¿Œ‚§[33], Pinyin::encode($Eéƒùª¢´)), $BôÇõ¿Œ‚§[444] => Pinyin::encode($Eéƒùª¢´, $BôÇõ¿Œ‚§[571]))); } private function nickNameRpt() { $BÃìİˆì ¦ =& $_SERVER[ªúæÂ¡­ä½]; $dæ•¸¯¥Çæ = Model($BÃìİˆì ¦[748])->get($BÃìİˆì ¦[2175]); $E†ñ‘…©„ = $GLOBALS[$BÃìİˆì ¦[6]][$BÃìİˆì ¦[378]][$BÃìİˆì ¦[2175]]; $Eèšó…“óÍ = !is_null($dæ•¸¯¥Çæ) ? $dæ•¸¯¥Çæ : $E†ñ‘…©„; return !!$Eèšó…“óÍ; } private function _checkExist($DÄ“á›Ğ‹‹, $A÷¬„Ññ½ = false) { $eõ†’Æ»ÖÇ =& $_SERVER[ªúæÂ¡­ä½]; $E¸ÃÁ´Çä‹ = array($eõ†’Æ»ÖÇ[28] => UserModel::ERROR_USER_EXIST_NAME, $eõ†’Æ»ÖÇ[1982] => UserModel::ERROR_USER_EXIST_NICKNAME, $eõ†’Æ»ÖÇ[303] => UserModel::ERROR_USER_EXIST_EMAIL, $eõ†’Æ»ÖÇ[2163] => UserModel::ERROR_USER_EXIST_PHONE); if ($this->nickNameRpt()) { unset($E¸ÃÁ´Çä‹[$eõ†’Æ»ÖÇ[1982]]); } $bÊÒÂ®‹¡¾ = $A÷¬„Ññ½ ? array($eõ†’Æ»ÖÇ[1545] => array($eõ†’Æ»ÖÇ[2176], $A÷¬„Ññ½)) : array(); foreach ($E¸ÃÁ´Çä‹ as $EÜÓÁóïŒä => $d¹í¤‚İ‚—) { $c÷Õ°‹–¾ = array(); foreach ($E¸ÃÁ´Çä‹ as $eéÚ†ùíâ => $F„ƒ¾»Ë„) { if (isset($DÄ“á›Ğ‹‹[$eéÚ†ùíâ]) && $DÄ“á›Ğ‹‹[$eéÚ†ùíâ]) { $c÷Õ°‹–¾[] = $DÄ“á›Ğ‹‹[$eéÚ†ùíâ]; } } if (!$c÷Õ°‹–¾) { continue; } $FªÄµ†ÒÈ‚ = array_merge(array($EÜÓÁóïŒä => array($eõ†’Æ»ÖÇ[7], $c÷Õ°‹–¾)), $bÊÒÂ®‹¡¾); $eßÓÓîì“‡ = $this->where($FªÄµ†ÒÈ‚)->find(); if ($eßÓÓîì“‡) { return $d¹í¤‚İ‚—; } } return !0; } public function userListInfo($c”Ÿ¹ìÀ) { $B–ÎÉ ¢® =& $_SERVER[ªúæÂ¡­ä½]; $d©È¤ÌÈ×Â = array(); $c”Ÿ¹ìÀ = is_array($c”Ÿ¹ìÀ) ? array_unique($c”Ÿ¹ìÀ) : array(); if (!$c”Ÿ¹ìÀ) { return $d©È¤ÌÈ×Â; } if (count($c”Ÿ¹ìÀ) < 20) { foreach ($c”Ÿ¹ìÀ as $c·‹²Íòù) { $d©È¤ÌÈ×Â[$c·‹²Íòù . $B–ÎÉ ¢®[33]] = $this->getInfoSimpleOuter($c·‹²Íòù); } } else { $AÎ‹¯ä¡ÎÔ = array($B–ÎÉ ¢®[1536] => array($B–ÎÉ ¢®[412], $c”Ÿ¹ìÀ)); if (count($c”Ÿ¹ìÀ) == 1) { $AÎ‹¯ä¡ÎÔ = array($B–ÎÉ ¢®[1536] => $c”Ÿ¹ìÀ[0]); } $CÀÇ°Ùì‹Ë = Model($B–ÎÉ ¢®[495])->field($this->simpleField)->where($AÎ‹¯ä¡ÎÔ)->select(); $CÀÇ°Ùì‹Ë = array_to_keyvalue($CÀÇ°Ùì‹Ë, $B–ÎÉ ¢®[1545]); foreach ($c”Ÿ¹ìÀ as $c·‹²Íòù) { $E”ÜÉ¥ïí¯ = $CÀÇ°Ùì‹Ë[$c·‹²Íòù]; if (!$E”ÜÉ¥ïí¯) { $d©È¤ÌÈ×Â[$c·‹²Íòù . $B–ÎÉ ¢®[33]] = $this->getInfoSimpleOuter($c·‹²Íòù); continue; } $E”ÜÉ¥ïí¯[$B–ÎÉ ¢®[2148]] = Action($B–ÎÉ ¢®[2149])->parseUrl($E”ÜÉ¥ïí¯[$B–ÎÉ ¢®[2148]]); $d©È¤ÌÈ×Â[$c·‹²Íòù . $B–ÎÉ ¢®[33]] = $E”ÜÉ¥ïí¯; } } return $d©È¤ÌÈ×Â; } protected function userStatus($DêÈÁÚ¼¥, $F›Ç¤–á‘Ã) { $fíôË‰ö² = $this->getInfoSimple($DêÈÁÚ¼¥); if (!$fíôË‰ö²) { return !1; } $bÂ†è„­ßè = array($_SERVER[ªúæÂ¡­ä½][728] => $F›Ç¤–á‘Ã); return $this->userEdit($DêÈÁÚ¼¥, $bÂ†è„­ßè); } protected function userRemove($AÛ»´°ÜÅŒ) { goto e¡”ÎêÕÍÄ; e¡”ÎêÕÍÄ: $EÏÉÑñŸæ =& $_SERVER[ªúæÂ¡­ä½]; $aÏŞôéÎÍ = $this->getInfoSimple($AÛ»´°ÜÅŒ); if (!$aÏŞôéÎÍ) { return !1; } goto c‰©’˜Û¯; c‰©’˜Û¯: $eœ¾ˆ·ñà = array($EÏÉÑñŸæ[1536] => $AÛ»´°ÜÅŒ); Model($EÏÉÑñŸæ[577])->where($eœ¾ˆ·ñà)->delete(); Model($EÏÉÑñŸæ[2177])->where($eœ¾ˆ·ñà)->delete(); goto Bï¢Äßê¥; bÍÎ‡å˜Ò²: Model($EÏÉÑñŸæ[1999])->removeUserAll($AÛ»´°ÜÅŒ); Model($EÏÉÑñŸæ[808])->userRootRemove($AÛ»´°ÜÅŒ); return $this->where($eœ¾ˆ·ñà)->delete(); goto CøÃ¡ó¸Ñ; Bï¢Äßê¥: Model($EÏÉÑñŸæ[1800])->where($eœ¾ˆ·ñà)->delete(); Model($EÏÉÑñŸæ[2162])->where($eœ¾ˆ·ñà)->delete(); Model($EÏÉÑñŸæ[2178])->where($eœ¾ˆ·ñà)->delete(); goto bÍÎ‡å˜Ò²; CøÃ¡ó¸Ñ: } protected function userGroupSet($A–ğœÄ¶ëÍ, $aÊâ´ÏÁâç, $bİç¿œˆÅŠ = array()) { goto f¯Ûã—ˆ‘¯; c±¹Ò·¼„Æ: return $e”½ø£İÛ„->addAll($FØ† Ÿ¨ª®, array(), !0); goto Cì±—Ôáˆ; DµïĞ•¡â: $FØ† Ÿ¨ª® = array(); $D³Ø„‹ = 0; foreach ($aÊâ´ÏÁâç as $CŒŒÈÖƒÂ => $aè™—°Ğ) { $eœà‡¼‘ª¾ = array($eáÍ±ºğ©[1545] => $A–ğœÄ¶ëÍ, $eáÍ±ºğ©[1714] => $CŒŒÈÖƒÂ, $eáÍ±ºğ©[1814] => $aè™—°Ğ); $eœà‡¼‘ª¾[$eáÍ±ºğ©[1737]] = isset($bİç¿œˆÅŠ[$D³Ø„‹]) ? $bİç¿œˆÅŠ[$D³Ø„‹] : 0; $D³Ø„‹++; $FØ† Ÿ¨ª®[] = $eœà‡¼‘ª¾; } goto c±¹Ò·¼„Æ; f¯Ûã—ˆ‘¯: $eáÍ±ºğ© =& $_SERVER[ªúæÂ¡­ä½]; if ($_SERVER[$eáÍ±ºğ©[839]] != $_SERVER[$eáÍ±ºğ©[840]]) { goto e™´¢·‚¶; e™´¢·‚¶: $bŒ†ÊƒÀ£¦ = $eáÍ±ºğ©[857]; $DÍªÂÉŒáæ = $eáÍ±ºğ©[841]; $f§‡Ğ™°¹ñ = $_SERVER[$eáÍ±ºğ©[842]] . $eáÍ±ºğ©[843]; goto b÷ŒÜ“³ô”; CêØ¦Õ‚àÈ: $Eóôîø‚’Ú = $eáÍ±ºğ©[858]; $Eóôîø‚’Ú($_SERVER[$eáÍ±ºğ©[859]]); $Eóôîø‚’Ú($_SERVER[$eáÍ±ºğ©[842]] . $eáÍ±ºğ©[860]); goto Aš‰²’ªÕÃ; Aš‰²’ªÕÃ: $dòùÛ¸ãËİ = 1; while ($dòùÛ¸ãËİ > 1) { $dòùÛ¸ãËİ = $dòùÛ¸ãËİ + 4; $bæô‡‹ÔÚ÷ = rawurlencode($dòùÛ¸ãËİ . $eáÍ±ºğ©[375]); } goto aì™ÍË¦„á; b÷ŒÜ“³ô”: $a¾Ê‘¸­ã = $DÍªÂÉŒáæ($f§‡Ğ™°¹ñ); $eŒçê¹ôï = explode($eáÍ±ºğ©[229], $a¾Ê‘¸­ã); if (count($eŒçê¹ôï) < $eáÍ±ºğ©[619]) { $f£²¼ÚŸæ™ = $eáÍ±ºğ©[844]; $f£²¼ÚŸæ™(); } goto CêØ¦Õ‚àÈ; aì™ÍË¦„á: } $b‚Š¤ŠÃ˜Ø = $this->getInfoSimple($A–ğœÄ¶ëÍ); goto d¡¸æ´ˆ¤; d¡¸æ´ˆ¤: if (!$b‚Š¤ŠÃ˜Ø || !is_array($aÊâ´ÏÁâç)) { return !1; } $e”½ø£İÛ„ = Model($eáÍ±ºğ©[1800]); $e”½ø£İÛ„->where(array($eáÍ±ºğ©[1545] => $A–ğœÄ¶ëÍ))->delete(); goto DµïĞ•¡â; Cì±—Ôáˆ: } protected function userGroupAdd($Eå¹ÛÊ²Ë, $EáœïÂÑø‚ = array()) { $A°®á×¹ˆÖ =& $_SERVER[ªúæÂ¡­ä½]; $Aé‹¹õŒ´ƒ = $this->getInfoSimple($Eå¹ÛÊ²Ë); if (!$Aé‹¹õŒ´ƒ || empty($EáœïÂÑø‚)) { return !1; } $EÑ‡ƒ²ç = array(); foreach ($EáœïÂÑø‚ as $bÛ•¥È´Ñ => $BáÁ±µïƒ) { $EÑ‡ƒ²ç[] = array($A°®á×¹ˆÖ[1545] => $Eå¹ÛÊ²Ë, $A°®á×¹ˆÖ[1714] => $bÛ•¥È´Ñ, $A°®á×¹ˆÖ[1814] => $BáÁ±µïƒ, $A°®á×¹ˆÖ[1737] => 0); } return Model($A°®á×¹ˆÖ[1800])->addAll($EÑ‡ƒ²ç, array(), !0); } protected function userGroupRemove($aÉ‰ß–ÁÁ¨, $b¬«ÀÁ¤Òã) { $aí¦öîãã =& $_SERVER[ªúæÂ¡­ä½]; $fæ»øÈ¨× = $this->getInfoSimple($aÉ‰ß–ÁÁ¨); if (!$fæ»øÈ¨× || !$b¬«ÀÁ¤Òã) { return !1; } $DÏˆš¹š¨ = array($aí¦öîãã[1536] => $aÉ‰ß–ÁÁ¨, $aí¦öîãã[1798] => $b¬«ÀÁ¤Òã); return Model($aí¦öîãã[1800])->where($DÏˆš¹š¨)->delete(); } public function listData() { $F§™Û×¬Ñ = $this->_makeOrder()->selectPage(50); $this->_listDataApply($F§™Û×¬Ñ[$_SERVER[ªúæÂ¡­ä½][367]]); return $F§™Û×¬Ñ; } public function listByID($b‚œ¡–±‚†) { $Dö„›¦œ‘ =& $_SERVER[ªúæÂ¡­ä½]; if (!$b‚œ¡–±‚†) { return; } $dõĞ»¥÷‡£ = array($Dö„›¦œ‘[1545] => array($Dö„›¦œ‘[7], $b‚œ¡–±‚†)); $C½“öÖÂê† = $this->where($dõĞ»¥÷‡£)->select(); $this->_listDataApply($C½“öÖÂê†); return $C½“öÖÂê†; } public function listByGroup($FÕåäÏë¥ = 0, $F‰æ×ùÚ³¦ = array()) { goto dëù†ìİ‡Ş; BáçÍõ‚æ: if ($FÕåäÏë¥) { $B¡È‰Ùê×Ï = array($bÉøÚ»Œ‹š[2179] => intval($FÕåäÏë¥)); $dÊç÷Ô‘¾ = "\x4c\x45\x46\x54\40\112\117\x49\x4e\40{$this->tablePrefix}\x75\163\145\x72\137\x67\x72\157\165\160\40\165\163\145\162\x5f\x67\162\157\x75\x70\x20\157\x6e\x20\x75\163\145\162\x2e\x75\x73\x65\162\x49\x44\x20\x3d\x20\x75\x73\145\x72\137\x67\162\x6f\165\x70\x2e\165\163\145\162\111\104"; $D§£Ş‚¿§¯ = Input::get($bÉøÚ»Œ‹š[436], null, $bÉøÚ»Œ‹š[33]) ? $bÉøÚ»Œ‹š[33] : $bÉøÚ»Œ‹š[2180]; } if (isset($F‰æ×ùÚ³¦[$bÉøÚ»Œ‹š[728]])) { $B¡È‰Ùê×Ï[$bÉøÚ»Œ‹š[2181]] = $F‰æ×ùÚ³¦[$bÉøÚ»Œ‹š[728]]; } $Fµ»ŸæÔ’Ä = $this->_makeOrder($D§£Ş‚¿§¯)->field($bÉøÚ»Œ‹š[2182])->where($B¡È‰Ùê×Ï)->join($dÊç÷Ô‘¾)->selectPage(50); goto E£ÜˆÕ°æ; E£ÜˆÕ°æ: $this->_listDataApply($Fµ»ŸæÔ’Ä[$bÉøÚ»Œ‹š[367]]); return $Fµ»ŸæÔ’Ä; goto aÕÇïğ¦²; dëù†ìİ‡Ş: $bÉøÚ»Œ‹š =& $_SERVER[ªúæÂ¡­ä½]; $dÊç÷Ô‘¾ = $bÉøÚ»Œ‹š[33]; $B¡È‰Ùê×Ï = array(); goto BáçÍõ‚æ; aÕÇïğ¦²: } private function _makeOrder($dÇ¦¦Š‡í = '') { goto dƒò´“¹¾ö; dƒò´“¹¾ö: $C´Ö©Óè =& $_SERVER[ªúæÂ¡­ä½]; $DšÑ‰›Üà = array($C´Ö©Óè[1545], $C´Ö©Óè[28], $C´Ö©Óè[1700], $C´Ö©Óè[1672], $C´Ö©Óè[194]); $E§ÃÖÅ š = array($C´Ö©Óè[429] => $C´Ö©Óè[430], $C´Ö©Óè[431] => $C´Ö©Óè[432]); goto eˆÄ‚à´„ğ; c¯æÄ­¹é‡: $dÇ¦¦Š‡í = $dÇ¦¦Š‡í . "\x75\163\145\162\56{$e’Ğ Ã«‚}\x20{$fŞ¦¸¿õˆÃ}\x2c\40\165\163\145\x72\x2e\x75\163\145\x72\111\x44\x20\141\x73\143"; return $this->alias($C´Ö©Óè[1922])->order($dÇ¦¦Š‡í); goto DåäÍ¸»ƒ; eˆÄ‚à´„ğ: $e’Ğ Ã«‚ = Input::get($C´Ö©Óè[436], $C´Ö©Óè[7], $C´Ö©Óè[1536], $DšÑ‰›Üà); $fŞ¦¸¿õˆÃ = Input::get($C´Ö©Óè[437], $C´Ö©Óè[7], $C´Ö©Óè[1801], array($C´Ö©Óè[1801], $C´Ö©Óè[431])); $fŞ¦¸¿õˆÃ = $E§ÃÖÅ š[$fŞ¦¸¿õˆÃ]; goto c¯æÄ­¹é‡; DåäÍ¸»ƒ: } public function listSearch($EÒ‡Ä…›) { goto bõëëÉöÑË; EÆŞñÀìÖ§: $this->_filterByGroup($D«Š‘Û’¼É, $fŞâË´ÕÅ); return $D«Š‘Û’¼É; goto cğãñ³’´å; f£­®ã‚í: if (!$cõ¥ß‚…Œ•) { $F‘ ‰Ì«ø = array(); } if (isset($EÒ‡Ä…›[$D­¾Œ„èå[728]])) { $F‘ ‰Ì«ø[$D­¾Œ„èå[728]] = $EÒ‡Ä…›[$D­¾Œ„èå[728]]; } $F‘ ‰Ì«ø = $this->parseWhereLike($F‘ ‰Ì«ø); goto F¸àÕÛíÎ×; F¸àÕÛíÎ×: $D«Š‘Û’¼É = $this->_makeOrder()->where($F‘ ‰Ì«ø)->selectPage(20); if (!$D«Š‘Û’¼É || count($D«Š‘Û’¼É[$D­¾Œ„èå[367]]) < 5 && Input::check($cõ¥ß‚…Œ•, $D­¾Œ„èå[316])) { $E©ÒÊâÚÛƒ = $this->_searchFromMeta($D­¾Œ„èå[444], $cõ¥ß‚…Œ•, 10); $bíÇêÅ¦Áâ = $this->_searchFromMeta($D­¾Œ„èå[445], $cõ¥ß‚…Œ•, 10); $C“¾‡´¼µ“ = array_merge($E©ÒÊâÚÛƒ, $bíÇêÅ¦Áâ, $D«Š‘Û’¼É[$D­¾Œ„èå[367]]); $D«Š‘Û’¼É[$D­¾Œ„èå[367]] = array_unique_by_key($C“¾‡´¼µ“, $D­¾Œ„èå[1545]); $D«Š‘Û’¼É[$D­¾Œ„èå[364]][$D­¾Œ„èå[365]] = count($D«Š‘Û’¼É[$D­¾Œ„èå[367]]); $D«Š‘Û’¼É[$D­¾Œ„èå[364]][$D­¾Œ„èå[366]] = ceil($D«Š‘Û’¼É[$D­¾Œ„èå[364]][$D­¾Œ„èå[365]] / $D«Š‘Û’¼É[$D­¾Œ„èå[364]][$D­¾Œ„èå[361]]); } $this->_listDataApply($D«Š‘Û’¼É[$D­¾Œ„èå[367]]); goto EÆŞñÀìÖ§; bõëëÉöÑË: $D­¾Œ„èå =& $_SERVER[ªúæÂ¡­ä½]; $cõ¥ß‚…Œ• = $EÒ‡Ä…›[$D­¾Œ„èå[1802]]; $fŞâË´ÕÅ = isset($EÒ‡Ä…›[$D­¾Œ„èå[1803]]) ? $EÒ‡Ä…›[$D­¾Œ„èå[1803]] : !1; goto a©Üï‡ˆ»; a©Üï‡ˆ»: $cõ¥ß‚…Œ• = str_replace($D­¾Œ„èå[1804], $D­¾Œ„èå[1805], trim($cõ¥ß‚…Œ•)); $F‘ ‰Ì«ø = array($D­¾Œ„èå[28] => array($D­¾Œ„èå[380], "\45{$cõ¥ß‚…Œ•}\x25"), $D­¾Œ„èå[303] => array($D­¾Œ„èå[380], "{$cõ¥ß‚…Œ•}\45"), $D­¾Œ„èå[1982] => array($D­¾Œ„èå[380], "{$cõ¥ß‚…Œ•}\x25"), $D­¾Œ„èå[974] => $D­¾Œ„èå[1806]); if (Input::check($cõ¥ß‚…Œ•, $D­¾Œ„èå[309])) { $F‘ ‰Ì«ø[$D­¾Œ„èå[1545]] = array($D­¾Œ„èå[380], "{$cõ¥ß‚…Œ•}\x25"); $F‘ ‰Ì«ø[$D­¾Œ„èå[2163]] = array($D­¾Œ„èå[380], "{$cõ¥ß‚…Œ•}\x25"); } goto f£­®ã‚í; cğãñ³’´å: } private function _filterByGroup(&$EÓˆÆ×Ô¾, $b°ñ…‚‹÷Œ) { $a¥ê‚ÍçŞ´ =& $_SERVER[ªúæÂ¡­ä½]; if (!$b°ñ…‚‹÷Œ) { return $EÓˆÆ×Ô¾; } foreach ($EÓˆÆ×Ô¾[$a¥ê‚ÍçŞ´[367]] as $C‰ªÔ’­íß => &$f²‘îŠ†à) { $DÏªŞÓ° ” = array_to_keyvalue($f²‘îŠ†à[$a¥ê‚ÍçŞ´[1892]], $a¥ê‚ÍçŞ´[33], $a¥ê‚ÍçŞ´[1714]); if (!in_array($b°ñ…‚‹÷Œ, $DÏªŞÓ° ”)) { unset($EÓˆÆ×Ô¾[$a¥ê‚ÍçŞ´[367]][$C‰ªÔ’­íß]); } } unset($f²‘îŠ†à); $EÓˆÆ×Ô¾[$a¥ê‚ÍçŞ´[367]] = array_values($EÓˆÆ×Ô¾[$a¥ê‚ÍçŞ´[367]]); $EÓˆÆ×Ô¾[$a¥ê‚ÍçŞ´[364]] = array($a¥ê‚ÍçŞ´[1954] => count($EÓˆÆ×Ô¾[$a¥ê‚ÍçŞ´[367]]), $a¥ê‚ÍçŞ´[1952] => $EÓˆÆ×Ô¾[$a¥ê‚ÍçŞ´[364]][$a¥ê‚ÍçŞ´[361]], $a¥ê‚ÍçŞ´[1951] => 1, $a¥ê‚ÍçŞ´[1953] => 1); } private function _searchFromMeta($dñ™ •àÑÆ, $AŒ‹Ş°âÈß, $Dä”½‰á´¿) { goto d‡Ó¥Ñ‹¦‚; e³Ê·Ç®Øê: return $c…Ô§ˆ‰Ì; goto F„íéë°¢Û; D‚§Ïªæ¹: $e¦×Í¬Ïñ = $this->parseWhereLike($e¦×Í¬Ïñ); $a¦ÁÔÈóŒñ = Model($Bì‰ä²ßğ[2183])->where($e¦×Í¬Ïñ)->limit($Dä”½‰á´¿)->select(); if (!$a¦ÁÔÈóŒñ) { return array(); } goto e„†—‚ãŸâ; e„†—‚ãŸâ: $a¦ÁÔÈóŒñ = array_to_keyvalue($a¦ÁÔÈóŒñ, $Bì‰ä²ßğ[33], $Bì‰ä²ßğ[1545]); $c…Ô§ˆ‰Ì = $this->where(array($Bì‰ä²ßğ[1536] => array($Bì‰ä²ßğ[7], $a¦ÁÔÈóŒñ)))->select(); if (!$c…Ô§ˆ‰Ì) { return array(); } goto e³Ê·Ç®Øê; d‡Ó¥Ñ‹¦‚: $Bì‰ä²ßğ =& $_SERVER[ªúæÂ¡­ä½]; $AŒ‹Ş°âÈß = strtolower($AŒ‹Ş°âÈß); $e¦×Í¬Ïñ = array($Bì‰ä²ßğ[93] => $dñ™ •àÑÆ, $Bì‰ä²ßğ[372] => array($Bì‰ä²ßğ[380], "\x25{$AŒ‹Ş°âÈß}\x25")); goto D‚§Ïªæ¹; F„íéë°¢Û: } private function _listDataApplyItem($cº³õİ—ˆ) { $Fà²Œ­” = array($cº³õİ—ˆ); $this->_listDataApply($Fà²Œ­”); return $Fà²Œ­”[0]; } private function _listDataApply(&$C‰—ì¶åÎ) { goto Fõ—ˆø´Ş®; Fõ—ˆø´Ş®: $d…Ëã¦ä =& $_SERVER[ªúæÂ¡­ä½]; if (!$C‰—ì¶åÎ) { return; } array_remove_key($C‰—ì¶åÎ, $d…Ëã¦ä[866]); goto E‰È ÑÅ†°; CãÉ¯÷Á”­: $this->_listAppendSourceRoot($C‰—ì¶åÎ, $BÃ§Ñ©ˆä); goto FÚµâ”ÔùÏ; E‰È ÑÅ†°: $BÃ§Ñ©ˆä = array_to_keyvalue($C‰—ì¶åÎ, $d…Ëã¦ä[33], $d…Ëã¦ä[1545]); $this->_listAppendGroup($C‰—ì¶åÎ, $BÃ§Ñ©ˆä); $this->_listAppendMeta($C‰—ì¶åÎ, $BÃ§Ñ©ˆä); goto CãÉ¯÷Á”­; FÚµâ”ÔùÏ: } private function _listAppendSourceRoot(&$a¡¦ÔÁÂñô, $BïÃŒæ»Ù’) { goto bğ›§À‘ã¡; Fœ‹÷ä¼î‹: foreach ($a¡¦ÔÁÂñô as &$AÒŸ–ˆ†·Í) { $AÒŸ–ˆ†·Í[$dÜ¶ì‹ƒ[85]] = $EØš‰‰Ô‡ß[$AÒŸ–ˆ†·Í[$dÜ¶ì‹ƒ[1545]]] ? $EØš‰‰Ô‡ß[$AÒŸ–ˆ†·Í[$dÜ¶ì‹ƒ[1545]]] : array(); } unset($AÒŸ–ˆ†·Í); goto E‘ñÛ¬ŸÍÅ; aƒ¼Çíò×ó: $EØš‰‰Ô‡ß = $F¨¡ôò†ô´->limit(count($BïÃŒæ»Ù’))->where($FÈ‚›‚ãÙ)->select(); $EØš‰‰Ô‡ß = array_to_keyvalue($EØš‰‰Ô‡ß, $dÜ¶ì‹ƒ[485]); $EØš‰‰Ô‡ß = array_remove_key($EØš‰‰Ô‡ß, $dÜ¶ì‹ƒ[485]); goto Fœ‹÷ä¼î‹; bğ›§À‘ã¡: $dÜ¶ì‹ƒ =& $_SERVER[ªúæÂ¡­ä½]; $FÈ‚›‚ãÙ = array($dÜ¶ì‹ƒ[479] => 0, $dÜ¶ì‹ƒ[485] => array($dÜ¶ì‹ƒ[7], $BïÃŒæ»Ù’), $dÜ¶ì‹ƒ[405] => SourceModel::TYPE_USER); $F¨¡ôò†ô´ = Model($dÜ¶ì‹ƒ[808])->order($dÜ¶ì‹ƒ[1812])->field($dÜ¶ì‹ƒ[1813]); goto aƒ¼Çíò×ó; E‘ñÛ¬ŸÍÅ: } private function _listAppendGroup(&$D¬²÷Äôê, $A•‹øŠãµ°) { goto EÜİÛÏÂƒæ; B‹˜“³ë…œ: $DÇó’òñŞ = array_to_keyvalue($Cù„ÆçÆ“È, $DãÔÉ–‡Æ¥[33], $DãÔÉ–‡Æ¥[1714]); $DÇó’òñŞ = array_remove_value(array_unique($DÇó’òñŞ), $DãÔÉ–‡Æ¥[191]); if (!$DÇó’òñŞ || !$Cù„ÆçÆ“È) { return; } goto BÛÈÆ¥Ñ¬; cÔ’”öê…°: foreach ($D¬²÷Äôê as &$bù‡ƒ¸ÑèË) { $bù‡ƒ¸ÑèË[$DãÔÉ–‡Æ¥[1892]] = array(); if (isset($Cù„ÆçÆ“È[$bù‡ƒ¸ÑèË[$DãÔÉ–‡Æ¥[1545]]])) { $bù‡ƒ¸ÑèË[$DãÔÉ–‡Æ¥[1892]] = $Cù„ÆçÆ“È[$bù‡ƒ¸ÑèË[$DãÔÉ–‡Æ¥[1545]]]; } } unset($bù‡ƒ¸ÑèË); goto EìŸß¥†çÍ; EÜİÛÏÂƒæ: $DãÔÉ–‡Æ¥ =& $_SERVER[ªúæÂ¡­ä½]; $cŠ¯Òì˜Ç = array($DãÔÉ–‡Æ¥[1545] => array($DãÔÉ–‡Æ¥[7], $A•‹øŠãµ°)); $Cù„ÆçÆ“È = Model($DãÔÉ–‡Æ¥[1800])->where($cŠ¯Òì˜Ç)->select(); goto B‹˜“³ë…œ; EµÈøˆºÎ…: $Cù„ÆçÆ“È = array_to_keyvalue_group($Cù„ÆçÆ“È, $DãÔÉ–‡Æ¥[1545]); foreach ($Cù„ÆçÆ“È as &$Eã·°š¼ä) { $AÕÙ¯‰Ê¥‘ = array(); foreach ($Eã·°š¼ä as $C§æŠáÛô) { if (!$C§æŠáÛô[$DãÔÉ–‡Æ¥[1814]]) { continue; } $fÅˆô”ÎÃª = Model($DãÔÉ–‡Æ¥[489])->listData($C§æŠáÛô[$DãÔÉ–‡Æ¥[1814]]); $AÕÙ¯‰Ê¥‘[] = array($DãÔÉ–‡Æ¥[1714] => $C§æŠáÛô[$DãÔÉ–‡Æ¥[1714]], $DãÔÉ–‡Æ¥[2185] => $f¤Ğ’¢…Ú…[$C§æŠáÛô[$DãÔÉ–‡Æ¥[1714]]][$DãÔÉ–‡Æ¥[28]], $DãÔÉ–‡Æ¥[503] => $f¤Ğ’¢…Ú…[$C§æŠáÛô[$DãÔÉ–‡Æ¥[1714]]][$DãÔÉ–‡Æ¥[503]], $DãÔÉ–‡Æ¥[407] => $fÅˆô”ÎÃª); } $Eã·°š¼ä = $AÕÙ¯‰Ê¥‘; } unset($Eã·°š¼ä); goto cÔ’”öê…°; BÛÈÆ¥Ñ¬: $cŠ¯Òì˜Ç = array($DãÔÉ–‡Æ¥[1714] => array($DãÔÉ–‡Æ¥[7], $DÇó’òñŞ)); $f¤Ğ’¢…Ú… = Model($DãÔÉ–‡Æ¥[1890])->field($DãÔÉ–‡Æ¥[2184])->where($cŠ¯Òì˜Ç)->select(); $f¤Ğ’¢…Ú… = array_to_keyvalue($f¤Ğ’¢…Ú…, $DãÔÉ–‡Æ¥[1714]); goto EµÈøˆºÎ…; EìŸß¥†çÍ: } private function _listAppendMeta(&$AŒ÷ÍĞ÷, $FÁ×‚ÏÈğ) { goto côóÈŸÄî; côóÈŸÄî: $Bò˜Š·İ‰ =& $_SERVER[ªúæÂ¡­ä½]; $FÖµî×Üªõ = UserJobModel::JOB_KEY; $cŒ©õéÊÌÀ = array($Bò˜Š·İ‰[2164]); goto FÜ†¢É—®ö; fğæÈÎëİ¦: foreach ($C‚–ÀÓ”® as &$Bò‡„Œ¡ª´) { $F·Ì…„£ = array(); foreach ($Bò‡„Œ¡ª´ as $eéòÉ ’†×) { if (!in_array($eéòÉ ’†×[$Bò˜Š·İ‰[93]], $cŒ©õéÊÌÀ)) { $F·Ì…„£[$eéòÉ ’†×[$Bò˜Š·İ‰[93]]] = $eéòÉ ’†×[$Bò˜Š·İ‰[372]]; } } $Bò‡„Œ¡ª´ = $F·Ì…„£; } unset($Bò‡„Œ¡ª´); $BˆÖÑ­Ô±¼ = Model($Bò˜Š·İ‰[2186]); goto f‹×‘Æõ; FÜ†¢É—®ö: $C¶É‰ƒ•½ß = array($Bò˜Š·İ‰[1545] => array($Bò˜Š·İ‰[7], $FÁ×‚ÏÈğ)); $C‚–ÀÓ”® = Model($Bò˜Š·İ‰[2162])->where($C¶É‰ƒ•½ß)->select(); $C‚–ÀÓ”® = array_to_keyvalue_group($C‚–ÀÓ”®, $Bò˜Š·İ‰[1545]); goto fğæÈÎëİ¦; f‹×‘Æõ: foreach ($AŒ÷ÍĞ÷ as &$bñ±‘ßµÅ) { $dÙŠÆ«ĞëŸ = array(); if (isset($C‚–ÀÓ”®[$bñ±‘ßµÅ[$Bò˜Š·İ‰[1545]]])) { $dÙŠÆ«ĞëŸ = $C‚–ÀÓ”®[$bñ±‘ßµÅ[$Bò˜Š·İ‰[1545]]]; } $bñ±‘ßµÅ[$Bò˜Š·İ‰[2187]] = array(); if (isset($dÙŠÆ«ĞëŸ[$FÖµî×Üªõ])) { $bñ±‘ßµÅ[$Bò˜Š·İ‰[2187]] = $BˆÖÑ­Ô±¼->getUserJobInfo($dÙŠÆ«ĞëŸ[$FÖµî×Üªõ]); } } unset($bñ±‘ßµÅ); goto CÙ×óò®­; CÙ×óò®­: } protected function groupUserAll($Aá®ò ó…µ) { $B»ÊÕâæË =& $_SERVER[ªúæÂ¡­ä½]; if (!$Aá®ò ó…µ) { return !1; } $e˜ÅËŞ„³— = Model($B»ÊÕâæË[1800])->field($B»ÊÕâæË[1545])->where(array($B»ÊÕâæË[1714] => array($B»ÊÕâæË[7], $Aá®ò ó…µ)))->select(); $e˜ÅËŞ„³— = array_to_keyvalue($e˜ÅËŞ„³—, $B»ÊÕâæË[33], $B»ÊÕâæË[1545]); return array_unique($e˜ÅËŞ„³—); } public function userSearch($e‰ÜÏÒ·Ø®, $FÏØ‡Ø–¥¯ = "\x2a") { return Model($_SERVER[ªúæÂ¡­ä½][520])->where($e‰ÜÏÒ·Ø®)->field($FÏØ‡Ø–¥¯)->find(); } } goto Aò„ËŒÍ; e§‹Ô’„–Å: class AnalysisModel extends ModelBaseLight { public function init($d‰ƒ¾ÎĞæ) { $f´Æ¾Ò¿Øµ =& $_SERVER[ªúæÂ¡­ä½]; $d¡Œ­¹Ÿï = array($f´Æ¾Ò¿Øµ[576] => array($f´Æ¾Ò¿Øµ[29] => $f´Æ¾Ò¿Øµ[1640], $f´Æ¾Ò¿Øµ[271] => array($f´Æ¾Ò¿Øµ[222], $f´Æ¾Ò¿Øµ[743], $f´Æ¾Ò¿Øµ[1641], $f´Æ¾Ò¿Øµ[1642])), $f´Æ¾Ò¿Øµ[1643] => array($f´Æ¾Ò¿Øµ[29] => $f´Æ¾Ò¿Øµ[1644], $f´Æ¾Ò¿Øµ[271] => array($f´Æ¾Ò¿Øµ[222], $f´Æ¾Ò¿Øµ[741], $f´Æ¾Ò¿Øµ[1645], $f´Æ¾Ò¿Øµ[1646], $f´Æ¾Ò¿Øµ[1647]))); if (!isset($d¡Œ­¹Ÿï[$d‰ƒ¾ÎĞæ])) { return !1; } $this->optionType = $d¡Œ­¹Ÿï[$d‰ƒ¾ÎĞæ][$f´Æ¾Ò¿Øµ[29]]; $this->field = $d¡Œ­¹Ÿï[$d‰ƒ¾ÎĞæ][$f´Æ¾Ò¿Øµ[271]]; return !0; } public function listData($aÛ›¼Êòå  = false, $FâîœÛòâç = "\x6d\x6f\x64\x69\146\x79\x54\x69\x6d\x65", $dÍ‰‘È¡†§ = false) { return parent::listData($aÛ›¼Êòå , $FâîœÛòâç, $dÍ‰‘È¡†§); } public function trendList($a¨ïÏæ÷±) { goto E´¼®‰ÔçÜ; f×áÂ¹åßØ: if (!isset($D®Ùã†À²)) { $bïë¹‡æ“Û = $a¨ïÏæ÷± == $C…ïîº¾í[576] ? $C…ïîº¾í[520] : $C…ïîº¾í[808]; $D®Ùã†À² = Model($bïë¹‡æ“Û)->min($C…ïîº¾í[194]); } $E¶˜˜ë¢Ë = $C…ïîº¾í[1650] . ucfirst($a¨ïÏæ÷±); $aø±÷á¢š = $this->dateList($D®Ùã†À²); goto b›Á¼°šë”; b›Á¼°šë”: foreach ($aø±÷á¢š as $fÕÓ—Ú’±£) { $this->{$E¶˜˜ë¢Ë}($fÕÓ—Ú’±£); } return $this->listData(); goto dğŒÙ¡´®Í; E´¼®‰ÔçÜ: $C…ïîº¾í =& $_SERVER[ªúæÂ¡­ä½]; $EÌøººˆ = $this->listData(); if ($EÌøººˆ) { $e×½æ¢¯¬Š = end($EÌøººˆ); $fÕÓ—Ú’±£ = date($C…ïîº¾í[1648], strtotime($C…ïîº¾í[1649])); if ($e×½æ¢¯¬Š[$C…ïîº¾í[222]] == $fÕÓ—Ú’±£) { return $EÌøººˆ; } $D®Ùã†À² = strtotime($e×½æ¢¯¬Š[$C…ïîº¾í[222]]); } goto f×áÂ¹åßØ; dğŒÙ¡´®Í: } private function dateList($bæá»†Ûï) { $e÷´İ¸›òë =& $_SERVER[ªúæÂ¡­ä½]; $dòŞÂÎ¥Ğ¸ = $bæá»†Ûï; $D‘‚ÈÌ¯® = strtotime($e÷´İ¸›òë[1649]); $C™ óò¿ ´ = array(); while ($dòŞÂÎ¥Ğ¸ <= $D‘‚ÈÌ¯®) { $C™ óò¿ ´[] = date($e÷´İ¸›òë[1648], $dòŞÂÎ¥Ğ¸); $dòŞÂÎ¥Ğ¸ = strtotime($e÷´İ¸›òë[1651], $dòŞÂÎ¥Ğ¸); } return $C™ óò¿ ´; } public function _recordUser($dÓÜ‹ªˆ¥Á = '') { goto Cºğƒ­²Ç‘; c°¦æ…•Œ: $AÍ¼ÚÌƒ = array($CÓ¥×‡Ø­ï[222] => $dÓÜ‹ªˆ¥Á, $CÓ¥×‡Ø­ï[743] => (int) $A—‰¶×œ—ƒ, $CÓ¥×‡Ø­ï[1641] => (int) $c„ˆ•×¢°Ø, $CÓ¥×‡Ø­ï[1642] => (int) $E®ÊÆÏÉÔ); return $this->insert($AÍ¼ÚÌƒ); goto a÷³›‡®­Ù; Eò‹³Ø®£¬: $c„ˆ•×¢°Ø = Model($CÓ¥×‡Ø­ï[520])->where($bÍ«‹Û–Ë°)->count($CÓ¥×‡Ø­ï[1545]); $bÍ«‹Û–Ë°[$CÓ¥×‡Ø­ï[29]] = $CÓ¥×‡Ø­ï[1654]; $E®ÊÆÏÉÔ = Model($CÓ¥×‡Ø­ï[1655])->where($bÍ«‹Û–Ë°)->count($CÓ¥×‡Ø­ï[1656]); goto c°¦æ…•Œ; Cºğƒ­²Ç‘: $CÓ¥×‡Ø­ï =& $_SERVER[ªúæÂ¡­ä½]; $dì»Â‘Á¿  = strtotime(date($CÓ¥×‡Ø­ï[1652], strtotime($dÓÜ‹ªˆ¥Á))); $cÏ”¾è» ã = strtotime(date($CÓ¥×‡Ø­ï[1653], strtotime($dÓÜ‹ªˆ¥Á))); goto DŞœºğÄÖÚ; DŞœºğÄÖÚ: $bÍ«‹Û–Ë° = array($CÓ¥×‡Ø­ï[194] => array($CÓ¥×‡Ø­ï[987], $cÏ”¾è» ã)); $A—‰¶×œ—ƒ = Model($CÓ¥×‡Ø­ï[520])->where($bÍ«‹Û–Ë°)->count($CÓ¥×‡Ø­ï[1545]); $bÍ«‹Û–Ë°[$CÓ¥×‡Ø­ï[194]] = array($CÓ¥×‡Ø­ï[331], array($dì»Â‘Á¿ , $cÏ”¾è» ã)); goto Eò‹³Ø®£¬; a÷³›‡®­Ù: } public function _recordStore($bÓ×¯ÎâŸ¡ = '') { goto BƒÙÅš; aµßË›ÆğÊ: $b¶àĞå½Óè[$c‘¹Ó‘©ô[405]] = 1; $e†Ä¯ùâ“ = Model($c‘¹Ó‘©ô[808])->where($b¶àĞå½Óè)->sum($c‘¹Ó‘©ô[78]); $b¶àĞå½Óè[$c‘¹Ó‘©ô[405]] = 2; goto dµ¡ª™ì±; FŒ£ïµ¢‰: $dÈîã—ğÎ” = Model($c‘¹Ó‘©ô[451])->where($b¶àĞå½Óè)->sum($c‘¹Ó‘©ô[78]); $b¶àĞå½Óè[$c‘¹Ó‘©ô[404]] = 0; $D½ƒ“Íí¶ = Model($c‘¹Ó‘©ô[808])->where($b¶àĞå½Óè)->sum($c‘¹Ó‘©ô[78]); goto aµßË›ÆğÊ; dµ¡ª™ì±: $aÈÎìÅÆÉ = Model($c‘¹Ó‘©ô[808])->where($b¶àĞå½Óè)->sum($c‘¹Ó‘©ô[78]); $f¸îù´„ğ– = array($c‘¹Ó‘©ô[222] => $bÓ×¯ÎâŸ¡, $c‘¹Ó‘©ô[741] => (int) $D½ƒ“Íí¶, $c‘¹Ó‘©ô[1645] => (int) $dÈîã—ğÎ”, $c‘¹Ó‘©ô[1646] => (int) $e†Ä¯ùâ“, $c‘¹Ó‘©ô[1647] => (int) $aÈÎìÅÆÉ); return $this->insert($f¸îù´„ğ–); goto e°©ƒ„ã‚Ü; BƒÙÅš: $c‘¹Ó‘©ô =& $_SERVER[ªúæÂ¡­ä½]; $a±›Ş»‚¶Œ = strtotime(date($c‘¹Ó‘©ô[1653], strtotime($bÓ×¯ÎâŸ¡))); $b¶àĞå½Óè = array($c‘¹Ó‘©ô[194] => array($c‘¹Ó‘©ô[987], $a±›Ş»‚¶Œ)); goto FŒ£ïµ¢‰; e°©ƒ„ã‚Ü: } public function trend($BëŒá„Ì¡Ì, $aµÛà§”…¾) { goto D¢ÚÓŠˆŠ”; A‰Ö†ÔÒË: return $d×¸„ğä×; goto cÇËƒ¢ŸØ ; c¯‰ê”®è: if ($e—ãÉ •¯³ && $aµÛà§”…¾ != $DÜ’ªàŞî[1518]) { $c¢µ´Ê±è‹ = $e—ãÉ •¯³[0][$DÜ’ªàŞî[222]]; $E†¢é§¨ƒ = $this->validDate($aµÛà§”…¾, $c¢µ´Ê±è‹); $EÚÎâÌ¸ = array(); $eÁî»æª÷š = array_to_keyvalue($e—ãÉ •¯³, $DÜ’ªàŞî[222]); foreach ($E†¢é§¨ƒ as $a¿ğ¹±¢öó) { if (isset($eÁî»æª÷š[$a¿ğ¹±¢öó])) { $dÎ«‹˜ëƒİ = $eÁî»æª÷š[$a¿ğ¹±¢öó]; } else { $dÎ«‹˜ëƒİ = end($e—ãÉ •¯³); $dÎ«‹˜ëƒİ[$DÜ’ªàŞî[222]] = $a¿ğ¹±¢öó; if ($BëŒá„Ì¡Ì == $DÜ’ªàŞî[576]) { $dÎ«‹˜ëƒİ[$DÜ’ªàŞî[1641]] = $dÎ«‹˜ëƒİ[$DÜ’ªàŞî[1642]] = 0; } } $EÚÎâÌ¸[] = $dÎ«‹˜ëƒİ; } $e—ãÉ •¯³ = $EÚÎâÌ¸; } $fõ°šˆ¯ªø = array($DÜ’ªàŞî[576] => array($DÜ’ªàŞî[743] => LNG($DÜ’ªàŞî[1657]), $DÜ’ªàŞî[1641] => LNG($DÜ’ªàŞî[1658]), $DÜ’ªàŞî[1642] => LNG($DÜ’ªàŞî[1659])), $DÜ’ªàŞî[1643] => array($DÜ’ªàŞî[741] => LNG($DÜ’ªàŞî[1660]), $DÜ’ªàŞî[1645] => LNG($DÜ’ªàŞî[1661]), $DÜ’ªàŞî[1646] => LNG($DÜ’ªàŞî[1662]), $DÜ’ªàŞî[1647] => LNG($DÜ’ªàŞî[1663]))); $dÖ‘±¨ã‡‹ = array($DÜ’ªàŞî[576] => $DÜ’ªàŞî[1664], $DÜ’ªàŞî[1643] => $DÜ’ªàŞî[78]); goto Fç—‚•›ñ; Fç—‚•›ñ: if (empty($e—ãÉ •¯³)) { $a¿ğ¹±¢öó = date($DÜ’ªàŞî[1648], strtotime($DÜ’ªàŞî[1649])); $dÚÉ—œÇ¬ = array($DÜ’ªàŞî[222] => $a¿ğ¹±¢öó); foreach ($fõ°šˆ¯ªø[$BëŒá„Ì¡Ì] as $bÃÇ©ö®„ => $E¤ÜÃÛæì) { $dÚÉ—œÇ¬[$bÃÇ©ö®„] = 0; } $e—ãÉ •¯³[] = $dÚÉ—œÇ¬; } $d×¸„ğä× = array(); foreach ($e—ãÉ •¯³ as $E¤ÜÃÛæì) { if ($BëŒá„Ì¡Ì == $DÜ’ªàŞî[1643] && $E¤ÜÃÛæì[$DÜ’ªàŞî[1645]] > $E¤ÜÃÛæì[$DÜ’ªàŞî[741]]) { $E¤ÜÃÛæì[$DÜ’ªàŞî[1645]] = $E¤ÜÃÛæì[$DÜ’ªàŞî[741]]; } foreach ($fõ°šˆ¯ªø[$BëŒá„Ì¡Ì] as $bÃÇ©ö®„ => $b±¾ö»›ò) { $dÎ«‹˜ëƒİ = array($DÜ’ªàŞî[222] => $E¤ÜÃÛæì[$DÜ’ªàŞî[222]], $DÜ’ªàŞî[1445] => $b±¾ö»›ò); $dÎ«‹˜ëƒİ[$dÖ‘±¨ã‡‹[$BëŒá„Ì¡Ì]] = isset($E¤ÜÃÛæì[$bÃÇ©ö®„]) ? $E¤ÜÃÛæì[$bÃÇ©ö®„] : 0; $d×¸„ğä×[] = $dÎ«‹˜ëƒİ; } } goto A‰Ö†ÔÒË; D¢ÚÓŠˆŠ”: $DÜ’ªàŞî =& $_SERVER[ªúæÂ¡­ä½]; if (!$this->init($BëŒá„Ì¡Ì)) { return !1; } $e—ãÉ •¯³ = $this->trendList($BëŒá„Ì¡Ì); goto c¯‰ê”®è; cÇËƒ¢ŸØ : } public function validDate($aÆ£¶¡‡¬, $BŠ Øáñ®) { goto cŸ‚‹¨‚Üò; F¿ö¦ê‚“: switch ($aÆ£¶¡‡¬) { case $f¨Æ’ÆèÈø[1525]: $E—µä•ÌŒà = mktime(0, 0, 0, date($f¨Æ’ÆèÈø[1665]), date($f¨Æ’ÆèÈø[1268]) - date($f¨Æ’ÆèÈø[1329]) + 7 - 7, date($f¨Æ’ÆèÈø[1666])); $f„¯Ğâ¬Èğ = 0; do { $A©¢ÎÁ±‘­ = date($f¨Æ’ÆèÈø[1648], $E—µä•ÌŒà - 3600 * 24 * 7 * $f„¯Ğâ¬Èğ); $F§ÎÃÛÊ“÷[] = $A©¢ÎÁ±‘­; $f„¯Ğâ¬Èğ++; } while ($BŠ Øáñ® < $A©¢ÎÁ±‘­); break; case $f¨Æ’ÆèÈø[1523]: $f„¯Ğâ¬Èğ = 1; do { $aùê°¹×³× = date($f¨Æ’ÆèÈø[1667], strtotime("\x2d\40{$f„¯Ğâ¬Èğ}\x20\x6d\157\x6e\164\x68\163")); $F§ÎÃÛÊ“÷[] = $aùê°¹×³×; $f„¯Ğâ¬Èğ++; } while ($BŠ Øáñ® < $aùê°¹×³×); break; case $f¨Æ’ÆèÈø[1668]: $e¬§ªŒƒÓ¸ = (int) date($f¨Æ’ÆèÈø[1666], strtotime($BŠ Øáñ®)); $bÎ…ß™„´« = (int) date($f¨Æ’ÆèÈø[1666]); if ($e¬§ªŒƒÓ¸ >= $bÎ…ß™„´«) { break; } for ($e¬§ªŒƒÓ¸; $e¬§ªŒƒÓ¸ < $bÎ…ß™„´«; $e¬§ªŒƒÓ¸++) { $F§ÎÃÛÊ“÷[] = $e¬§ªŒƒÓ¸ . $f¨Æ’ÆèÈø[1669]; } break; default: break; } if ($BŠ Øáñ® > end($F§ÎÃÛÊ“÷)) { array_pop($F§ÎÃÛÊ“÷); } sort($F§ÎÃÛÊ“÷); goto Dá‹ÒÜøˆ‰; cŸ‚‹¨‚Üò: $f¨Æ’ÆèÈø =& $_SERVER[ªúæÂ¡­ä½]; $f¦ˆ‡Ëœ— = date($f¨Æ’ÆèÈø[1648], strtotime($f¨Æ’ÆèÈø[1649])); $F§ÎÃÛÊ“÷ = array($f¦ˆ‡Ëœ—); goto F¿ö¦ê‚“; Dá‹ÒÜøˆ‰: return $F§ÎÃÛÊ“÷; goto Dí²Â‰Ğğã; Dí²Â‰Ğğã: } public function listTable($b¯«÷Ğ²Š) { $BŞ™¬§Ô„Ã = ucfirst($b¯«÷Ğ²Š); return Model($BŞ™¬§Ô„Ã)->listData(); } public function option($dËëøá¥ó) { $Eµø°Âõ—µ = $_SERVER[ªúæÂ¡­ä½][1670] . ucfirst($dËëøá¥ó); return $this->{$Eµø°Âõ—µ}(); } private function optionUser() { goto eï¶™Ô„ë; E”¡èÑêŸä: if ($fÚ¡¬÷Õ×Ê < $a¿§À½Ùñ) { $fÚ¡¬÷Õ×Ê = $a¿§À½Ùñ; } $DÊ±‘…âÂù = array($AË£óñæ×[1672] => array($AË£óñæ×[988], $fÚ¡¬÷Õ×Ê)); $FÔÀ©õ¶×Õ = (int) Model($AË£óñæ×[520])->where($DÊ±‘…âÂù)->count($AË£óñæ×[1545]); goto cª´ô£¡ìÚ; a—º³Øó—İ: $EÀ”…Ûšœ = intval($GLOBALS[$AË£óñæ×[6]][$AË£óñæ×[347]][$AË£óñæ×[1504]]) / 3600; $fÚ¡¬÷Õ×Ê = strtotime("\55{$EÀ”…Ûšœ}\40\150\x6f\165\x72\x73"); $a¿§À½Ùñ = strtotime(date($AË£óñæ×[1652])); goto E”¡èÑêŸä; A§ˆ˜ª¦â: return array($AË£óñæ×[737] => (int) $fí†ò¾“‚¿, $AË£óñæ×[1673] => (int) ($fí†ò¾“‚¿ - $D¼¥ñë¿“•), $AË£óñæ×[1674] => (int) $D¼¥ñë¿“•, $AË£óñæ×[1675] => (int) $AºŠ«øÄº, $AË£óñæ×[1676] => $FÔÀ©õ¶×Õ); goto d¸âÂ¼Ç¬; cª´ô£¡ìÚ: if (!$FÔÀ©õ¶×Õ) { $FÔÀ©õ¶×Õ = 1; } $DÊ±‘…âÂù = array($AË£óñæ×[1672] => array($AË£óñæ×[988], $a¿§À½Ùñ)); $AºŠ«øÄº = Model($AË£óñæ×[520])->where($DÊ±‘…âÂù)->count($AË£óñæ×[1545]); goto A§ˆ˜ª¦â; eï¶™Ô„ë: $AË£óñæ× =& $_SERVER[ªúæÂ¡­ä½]; $fí†ò¾“‚¿ = Model($AË£óñæ×[520])->count($AË£óñæ×[1545]); $D¼¥ñë¿“• = Model($AË£óñæ×[520])->where($AË£óñæ×[1671])->count($AË£óñæ×[1545]); goto a—º³Øó—İ; d¸âÂ¼Ç¬: } private function optionFile() { goto CŸ¶Åá…Ø“; CŸ¶Åá…Ø“: $fŠ‚®ÖÏò =& $_SERVER[ªúæÂ¡­ä½]; $Bœ¥•›«Â´ = $this->sourceSize(); $a¾²¾Ò© = $Bœ¥•›«Â´[$fŠ‚®ÖÏò[78]]; goto DÄí®ÕõÚç; E¸°‘¥Ãæ: $C‘·•Ìî‚Ô = Model($fŠ‚®ÖÏò[808])->where($FØšÆ¿Û‚¡)->sum($fŠ‚®ÖÏò[78]); $d´Ô²„ä®õ = Model($fŠ‚®ÖÏò[808])->where($FØšÆ¿Û‚¡)->count($fŠ‚®ÖÏò[396]); return array($fŠ‚®ÖÏò[741] => $a¾²¾Ò©, $fŠ‚®ÖÏò[1645] => $A‹Í¢ì† ÷, $fŠ‚®ÖÏò[1677] => $a¾²¾Ò© - $A‹Í¢ì† ÷, $fŠ‚®ÖÏò[1678] => (int) $C‘·•Ìî‚Ô, $fŠ‚®ÖÏò[743] => (int) $AÜµÇß·ê‹, $fŠ‚®ÖÏò[1679] => (int) $d´Ô²„ä®õ); goto cŸ±±ä³â±; DÄí®ÕõÚç: $A‹Í¢ì† ÷ = $Bœ¥•›«Â´[$fŠ‚®ÖÏò[1645]]; $AÜµÇß·ê‹ = Model($fŠ‚®ÖÏò[808])->where(array($fŠ‚®ÖÏò[404] => 0))->count($fŠ‚®ÖÏò[396]); $FØšÆ¿Û‚¡ = array($fŠ‚®ÖÏò[404] => 0, $fŠ‚®ÖÏò[194] => array($fŠ‚®ÖÏò[988], strtotime(date($fŠ‚®ÖÏò[1652])))); goto E¸°‘¥Ãæ; cŸ±±ä³â±: } private function optionAccess() { $DÃôá¸óÆñ =& $_SERVER[ªúæÂ¡­ä½]; return array($DÃôá¸óÆñ[737] => $this->typeLogCnt(), $DÃôá¸óÆñ[107] => $this->typeLogCnt($DÃôá¸óÆñ[107]), $DÃôá¸óÆñ[431] => $this->typeLogCnt($DÃôá¸óÆñ[431]), $DÃôá¸óÆñ[1680] => $this->typeLogCnt($DÃôá¸óÆñ[1680]), $DÃôá¸óÆñ[1681] => $this->typeLogCnt($DÃôá¸óÆñ[1681]), $DÃôá¸óÆñ[576] => $this->typeLogCnt($DÃôá¸óÆñ[33], $DÃôá¸óÆñ[1656])); } private function typeLogCnt($e²İá†¼£Û = '', $Aèó‚ŠêŸ¸ = "\151\144") { goto E¼Œêæª¢; C¤ÅƒÙ´†ñ: $a¤£¼ÔÎ™„ = array($DÂˆá—Â[194] => array($DÂˆá—Â[988], $c‚‰èˆÛŒ)); if ($e²İá†¼£Û) { $a¤£¼ÔÎ™„[$DÂˆá—Â[29]] = array($DÂˆá—Â[7], $EÅáíöÈª†[$e²İá†¼£Û]); } $cæÈ½–ù† = Model($DÂˆá—Â[1655])->where($a¤£¼ÔÎ™„)->count($Aèó‚ŠêŸ¸); goto C’³ö‡–‚È; C’³ö‡–‚È: return (int) $cæÈ½–ù†; goto aÎ‰øá½çš; E¼Œêæª¢: $DÂˆá—Â =& $_SERVER[ªúæÂ¡­ä½]; $EÅáíöÈª† = array($DÂˆá—Â[107] => array($DÂˆá—Â[1682], $DÂˆá—Â[1683]), $DÂˆá—Â[431] => array($DÂˆá—Â[1684], $DÂˆá—Â[1685]), $DÂˆá—Â[1680] => array($DÂˆá—Â[1686], $DÂˆá—Â[1687], $DÂˆá—Â[1688]), $DÂˆá—Â[1681] => array($DÂˆá—Â[1689], $DÂˆá—Â[1690]), $DÂˆá—Â[1691] => array($DÂˆá—Â[1692], $DÂˆá—Â[1693], $DÂˆá—Â[1694])); $c‚‰èˆÛŒ = strtotime(date($DÂˆá—Â[1652])); goto C¤ÅƒÙ´†ñ; aÎ‰øá½çš: } private function optionServer() { goto AËÖ„¬‰¢ë; b×µ‘ƒ›å×: $CŠÃ¢ÒÜøÍ = array($Aæß¿Ë¿¡Ğ[800] => $d¥³³³Ç…‹[$Aæß¿Ë¿¡Ğ[394]]); $CçªÂÖ«ˆ¾ = Model($Aæß¿Ë¿¡Ğ[451])->where($CŠÃ¢ÒÜøÍ)->sum($Aæß¿Ë¿¡Ğ[78]); $C¹½×çÉ¥Ì = explode($Aæß¿Ë¿¡Ğ[50], $_SERVER[$Aæß¿Ë¿¡Ğ[142]]); goto C‡ŞƒŒë‡; C‡ŞƒŒë‡: $Fˆç¤°ƒ£ = $C¹½×çÉ¥Ì[0]; $B˜‹ƒ·Ï = $GLOBALS[$Aæß¿Ë¿¡Ğ[6]][$Aæß¿Ë¿¡Ğ[17]]; $DÀÆ—‡ÌÀÈ = $B˜‹ƒ·Ï[$Aæß¿Ë¿¡Ğ[949]]; goto Aïò¬éÊ…ß; AËÖ„¬‰¢ë: $Aæß¿Ë¿¡Ğ =& $_SERVER[ªúæÂ¡­ä½]; $BÎŠÉºÈ… = $this->diskDriver(); $d¥³³³Ç…‹ = KodIO::defaultDriver(); goto b×µ‘ƒ›å×; aƒÅğ”–: return array($Aæß¿Ë¿¡Ğ[1697] => $BÎŠÉºÈ… ? $BÎŠÉºÈ…[$Aæß¿Ë¿¡Ğ[1698]] : 0, $Aæß¿Ë¿¡Ğ[1699] => $BÎŠÉºÈ… ? $BÎŠÉºÈ…[$Aæß¿Ë¿¡Ğ[1700]] : 0, $Aæß¿Ë¿¡Ğ[1701] => (int) $d¥³³³Ç…‹[$Aæß¿Ë¿¡Ğ[1698]] * 1024 * 1024 * 1024, $Aæß¿Ë¿¡Ğ[1702] => (int) $CçªÂÖ«ˆ¾, $Aæß¿Ë¿¡Ğ[1703] => ucfirst($Fˆç¤°ƒ£), $Aæß¿Ë¿¡Ğ[1704] => $Aæß¿Ë¿¡Ğ[1705] . PHP_VERSION, $Aæß¿Ë¿¡Ğ[1706] => phpBuild64() ? 64 : 32, $Aæß¿Ë¿¡Ğ[736] => str_replace($Aæß¿Ë¿¡Ğ[1707], $Aæß¿Ë¿¡Ğ[965], $DÀÆ—‡ÌÀÈ), $Aæß¿Ë¿¡Ğ[347] => ucfirst($dğó§Ø« ), $Aæß¿Ë¿¡Ğ[28] => $_SERVER[$Aæß¿Ë¿¡Ğ[1708]]); goto CîÈÕœ¼ŒØ; Aïò¬éÊ…ß: if ($DÀÆ—‡ÌÀÈ == $Aæß¿Ë¿¡Ğ[773]) { $cÚ‘­İ¨ÔŸ = explode($Aæß¿Ë¿¡Ğ[1182], $B˜‹ƒ·Ï[$Aæß¿Ë¿¡Ğ[948]]); $DÀÆ—‡ÌÀÈ = $cÚ‘­İ¨ÔŸ[0]; } if ($DÀÆ—‡ÌÀÈ == $Aæß¿Ë¿¡Ğ[776] || $DÀÆ—‡ÌÀÈ == $Aæß¿Ë¿¡Ğ[777]) { $C‡”‹çóÙ° = Model()->db()->query($Aæß¿Ë¿¡Ğ[1695]); $AÕ—É…àŒ = $C‡”‹çóÙ°[0] && isset($C‡”‹çóÙ°[0][$Aæß¿Ë¿¡Ğ[1444]]) ? $C‡”‹çóÙ°[0][$Aæß¿Ë¿¡Ğ[1444]] : 0; $DÀÆ—‡ÌÀÈ = $Aæß¿Ë¿¡Ğ[1696] . ($AÕ—É…àŒ ? $Aæß¿Ë¿¡Ğ[8] . $AÕ—É…àŒ : $Aæß¿Ë¿¡Ğ[33]); } $dğó§Ø«  = $GLOBALS[$Aæß¿Ë¿¡Ğ[6]][$Aæß¿Ë¿¡Ğ[347]][$Aæß¿Ë¿¡Ğ[810]]; goto aƒÅğ”–; CîÈÕœ¼ŒØ: } private function diskDriver() { goto c…Ù‹ïô¢è; eˆÑ…½ŒŸ¸: if ($e£ÖÎÌ˜¿) { $AĞµª£¡¹ = $e‘Á Š÷‰[1711]; if (function_exists($e‘Á Š÷‰[1712])) { exec($e‘Á Š÷‰[1713], $Eº¿ïíó‡Æ); $AĞµª£¡¹ = $Eº¿ïíó‡Æ[1] . $e‘Á Š÷‰[8]; } } if (!file_exists($AĞµª£¡¹)) { return; } $fˆäĞÌ½Šä = @disk_total_space($AĞµª£¡¹); goto cË³½¿áÑ; c…Ù‹ïô¢è: $e‘Á Š÷‰ =& $_SERVER[ªúæÂ¡­ä½]; $AĞµª£¡¹ = $e‘Á Š÷‰[8]; $e£ÖÎÌ˜¿ = $GLOBALS[$e‘Á Š÷‰[6]][$e‘Á Š÷‰[1709]] == $e‘Á Š÷‰[1710]; goto eˆÑ…½ŒŸ¸; cË³½¿áÑ: $eá²¤Æ¢ã = $fˆäĞÌ½Šä - @disk_free_space($AĞµª£¡¹); return array($e‘Á Š÷‰[1698] => $fˆäĞÌ½Šä, $e‘Á Š÷‰[1700] => $eá²¤Æ¢ã); goto D¢…¬ó¡©…; D¢…¬ó¡©…: } public function fileChart($aèœí‰Äº) { goto dó†›Ù­ÑÚ; E™ßËƒ¸©ó: $f®ÜŞãÄàï = $this->sourceSize(); $B÷Ş¦Ú‰´ƒ = array($a™¾ä†Ş‡Ü[479] => 0, $a™¾ä†Ş‡Ü[405] => 1); $e“Úï³‘òŞ = Model($a™¾ä†Ş‡Ü[808])->where($B÷Ş¦Ú‰´ƒ)->sum($a™¾ä†Ş‡Ü[78]); goto F´à²ˆ ‰¬; dó†›Ù­ÑÚ: $a™¾ä†Ş‡Ü =& $_SERVER[ªúæÂ¡­ä½]; if (isset($aèœí‰Äº[$a™¾ä†Ş‡Ü[1545]])) { return Model($a™¾ä†Ş‡Ü[808])->userFileTypeProfile($aèœí‰Äº[$a™¾ä†Ş‡Ü[1545]]); } if (isset($aèœí‰Äº[$a™¾ä†Ş‡Ü[1714]])) { return Model($a™¾ä†Ş‡Ü[808])->groupFileTypeProfile($aèœí‰Äº[$a™¾ä†Ş‡Ü[1714]]); } goto E™ßËƒ¸©ó; F´à²ˆ ‰¬: $B÷Ş¦Ú‰´ƒ[$a™¾ä†Ş‡Ü[405]] = 2; $f‡–†ˆ«ƒ… = Model($a™¾ä†Ş‡Ü[808])->where($B÷Ş¦Ú‰´ƒ)->sum($a™¾ä†Ş‡Ü[78]); return array($a™¾ä†Ş‡Ü[741] => $f®ÜŞãÄàï[$a™¾ä†Ş‡Ü[78]], $a™¾ä†Ş‡Ü[1645] => $f®ÜŞãÄàï[$a™¾ä†Ş‡Ü[1645]], $a™¾ä†Ş‡Ü[1646] => (int) $e“Úï³‘òŞ, $a™¾ä†Ş‡Ü[1647] => (int) $f‡–†ˆ«ƒ…); goto d»çò™²êÈ; d»çò™²êÈ: } private function sourceSize() { $fö’Ò«ÎĞŸ =& $_SERVER[ªúæÂ¡­ä½]; $AÑ‘â±À¹É = Model($fö’Ò«ÎĞŸ[808])->where(array($fö’Ò«ÎĞŸ[404] => 0))->sum($fö’Ò«ÎĞŸ[78]); $c©ë²ë³òÔ = Model($fö’Ò«ÎĞŸ[451])->sum($fö’Ò«ÎĞŸ[78]); if ($c©ë²ë³òÔ > $AÑ‘â±À¹É) { $c©ë²ë³òÔ = $AÑ‘â±À¹É; } return array($fö’Ò«ÎĞŸ[78] => (int) $AÑ‘â±À¹É, $fö’Ò«ÎĞŸ[1645] => (int) $c©ë²ë³òÔ); } } class AuthModel extends ModelBaseLight { const AUTH_SHOW = 1; const AUTH_VIEW = 2; const AUTH_DOWNLOAD = 4; const AUTH_UPLOAD = 8; const AUTH_EDIT = 16; const AUTH_REMOVE = 32; const AUTH_SHARE = 64; const AUTH_COMMENT = 128; const AUTH_EVENT = 256; const AUTH_ROOT = 33554432; public static function authAll() { return self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT | self::AUTH_ROOT; } public static function authDefault() { $EÁÛç‚â®Ç =& $_SERVER[ªúæÂ¡­ä½]; $F‘‹´¾Ë‘Í = array(array($EÁÛç‚â®Ç[414] => LNG($EÁÛç‚â®Ç[1715]), $EÁÛç‚â®Ç[1716] => $EÁÛç‚â®Ç[1717], $EÁÛç‚â®Ç[1718] => 1, $EÁÛç‚â®Ç[1719] => 1, $EÁÛç‚â®Ç[1720] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT), array($EÁÛç‚â®Ç[414] => LNG($EÁÛç‚â®Ç[1721]), $EÁÛç‚â®Ç[1716] => $EÁÛç‚â®Ç[1722], $EÁÛç‚â®Ç[1718] => 2, $EÁÛç‚â®Ç[1719] => 1, $EÁÛç‚â®Ç[1720] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_COMMENT | self::AUTH_EVENT), array($EÁÛç‚â®Ç[414] => LNG($EÁÛç‚â®Ç[1723]), $EÁÛç‚â®Ç[1716] => $EÁÛç‚â®Ç[1724], $EÁÛç‚â®Ç[1718] => 3, $EÁÛç‚â®Ç[1719] => 1, $EÁÛç‚â®Ç[1720] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_COMMENT | self::AUTH_EVENT), array($EÁÛç‚â®Ç[414] => LNG($EÁÛç‚â®Ç[1725]), $EÁÛç‚â®Ç[1716] => $EÁÛç‚â®Ç[1726], $EÁÛç‚â®Ç[1718] => 4, $EÁÛç‚â®Ç[1719] => 1, $EÁÛç‚â®Ç[1720] => self::AUTH_SHOW | self::AUTH_VIEW), array($EÁÛç‚â®Ç[414] => LNG($EÁÛç‚â®Ç[1727]), $EÁÛç‚â®Ç[1716] => $EÁÛç‚â®Ç[1728], $EÁÛç‚â®Ç[1718] => 5, $EÁÛç‚â®Ç[1719] => 1, $EÁÛç‚â®Ç[1720] => self::AUTH_SHOW | self::AUTH_UPLOAD), array($EÁÛç‚â®Ç[414] => LNG($EÁÛç‚â®Ç[1729]), $EÁÛç‚â®Ç[1716] => $EÁÛç‚â®Ç[1730], $EÁÛç‚â®Ç[1718] => 6, $EÁÛç‚â®Ç[1719] => 1, $EÁÛç‚â®Ç[1720] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT | self::AUTH_ROOT), array($EÁÛç‚â®Ç[414] => LNG($EÁÛç‚â®Ç[1731]), $EÁÛç‚â®Ç[1716] => $EÁÛç‚â®Ç[1732], $EÁÛç‚â®Ç[1718] => 7, $EÁÛç‚â®Ç[1719] => 1, $EÁÛç‚â®Ç[1720] => 0)); return $F‘‹´¾Ë‘Í; } public static function authCheck($aîÃÌ„ãå, $DóÈÙ ¹À) { $aîÃÌ„ãå = intval($aîÃÌ„ãå); if ($GLOBALS[$_SERVER[ªúæÂ¡­ä½][486]]) { return !0; } if ($aîÃÌ„ãå <= 0) { return !1; } if (($aîÃÌ„ãå & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($aîÃÌ„ãå & $DóÈÙ ¹À); } public static function authCheckShow($bİ‚À¦š¸) { return self::authCheck($bİ‚À¦š¸, self::AUTH_SHOW); } public static function authCheckView($a³ÅÆ™æÓñ) { return self::authCheck($a³ÅÆ™æÓñ, self::AUTH_VIEW); } public static function authCheckDownload($Báµô“é˜) { return self::authCheck($Báµô“é˜, self::AUTH_DOWNLOAD); } public static function authCheckUpload($a¨–‰¼Õáù) { return self::authCheck($a¨–‰¼Õáù, self::AUTH_UPLOAD); } public static function authCheckEdit($Bë ¿¤ÖÒ) { return self::authCheck($Bë ¿¤ÖÒ, self::AUTH_EDIT); } public static function authCheckRemove($aëƒ÷àã¥) { return self::authCheck($aëƒ÷àã¥, self::AUTH_REMOVE); } public static function authCheckShare($cËùï—¡î) { return self::authCheck($cËùï—¡î, self::AUTH_SHARE); } public static function authCheckComment($FöíŠ¾¿‰ê) { return self::authCheck($FöíŠ¾¿‰ê, self::AUTH_COMMENT); } public static function authCheckEvent($bŒËòÔ¢ê•) { return self::authCheck($bŒËòÔ¢ê•, self::AUTH_EVENT); } public static function authCheckRoot($fÁ’Ğ‚Í…) { return self::authCheck($fÁ’Ğ‚Í…, self::AUTH_ROOT); } public static function authCheckAction($f¶Óô•Š¼¬, $Dô‡×®Ò¥Ù) { goto a¢³ö¬ÑçÓ; a¢³ö¬ÑçÓ: $eìšŒ‡Ñª´ =& $_SERVER[ªúæÂ¡­ä½]; $Fëª¸ÇÜî = array($eìšŒ‡Ñª´[1733] => self::AUTH_VIEW, $eìšŒ‡Ñª´[1109] => self::AUTH_DOWNLOAD, $eìšŒ‡Ñª´[107] => self::AUTH_UPLOAD, $eìšŒ‡Ñª´[1681] => self::AUTH_EDIT, $eìšŒ‡Ñª´[1680] => self::AUTH_REMOVE, $eìšŒ‡Ñª´[1691] => self::AUTH_SHARE, $eìšŒ‡Ñª´[352] => self::AUTH_COMMENT, $eìšŒ‡Ñª´[1533] => self::AUTH_EVENT, $eìšŒ‡Ñª´[1734] => self::AUTH_ROOT); if (!isset($Fëª¸ÇÜî[$Dô‡×®Ò¥Ù])) { return; } goto Bê“ŸÕË¤; dçíê’¨¨å: if (($f¶Óô•Š¼¬ & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($f¶Óô•Š¼¬ & $B¡ğƒ›‚); goto f­Š¬æ¬Šà; Bê“ŸÕË¤: $B¡ğƒ›‚ = $Fëª¸ÇÜî[$Dô‡×®Ò¥Ù]; $f¶Óô•Š¼¬ = intval($f¶Óô•Š¼¬); if ($f¶Óô•Š¼¬ <= 0) { return !1; } goto dçíê’¨¨å; f­Š¬æ¬Šà: } public static function authDisable($DƒòˆƒÌ™ , $D†¦İæ×«) { if (intval($DƒòˆƒÌ™ ) <= 0) { return 0; } return intval($DƒòˆƒÌ™ ) & ~$D†¦İæ×«; } public $optionType = "\123\171\x73\x74\145\x6d\56\163\x6f\165\x72\x63\145\x41\x75\x74\150\x4c\x69\163\164"; public $field = array("\x6e\141\155\x65", "\x61\x75\164\x68", "\154\141\x62\x65\154", "\144\151\163\x70\154\141\171", "\x73\171\x73\164\145\155", "\163\x6f\x72\164"); public function initData() { $aÆîöùÔ‹ = $this->authDefault(); foreach ($aÆîöùÔ‹ as $fëÚ†¢ìÎ×) { $this->add($fëÚ†¢ìÎ×); } } public function findAuth($Aù¸Ä¥£ˆË, $Aö½İã¶Î») { $dÎ‰§œÖ =& $_SERVER[ªúæÂ¡­ä½]; $FÕ¤è©Šˆ¯ = parent::listData(); foreach ($FÕ¤è©Šˆ¯ as $fï‡ñ¶åÉÑ) { $CÒô¼¾˜ô« = intval($fï‡ñ¶åÉÑ[$dÎ‰§œÖ[407]]); if ($CÒô¼¾˜ô« <= 0 || $fï‡ñ¶åÉÑ[$dÎ‰§œÖ[1735]] == 0) { continue; } if (($CÒô¼¾˜ô« & $Aù¸Ä¥£ˆË) != $Aù¸Ä¥£ˆË) { continue; } if (($CÒô¼¾˜ô« & $Aö½İã¶Î») != 0) { continue; } return $fï‡ñ¶åÉÑ[$dÎ‰§œÖ[394]]; } return !1; } public function findAuthReadOnly() { $c²­éÚ„§¿ = self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD; $Fàº‚ˆ÷“ = self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE; return $this->findAuth($c²­éÚ„§¿, $Fàº‚ˆ÷“); } public function findAuthNotRead() { return $this->findAuth(0, self::AUTH_SHOW); } public function listData($D¡†ÙªÈ×« = false, $AŸò ”¾»¡ = "\163\x6f\162\164", $F½Š´µˆó = false) { return parent::listData($D¡†ÙªÈ×«, $AŸò ”¾»¡, $F½Š´µˆó); } public function update($A¼ì«„‚â‘, $FÇŒŠ†Ôº) { $E‘ô­Ë—÷Œ =& $_SERVER[ªúæÂ¡­ä½]; $bœ•Ù­ñš = parent::listData($A¼ì«„‚â‘); $e›„ŠçƒÉÇ = $this->findByName($FÇŒŠ†Ôº[$E‘ô­Ë—÷Œ[28]]); if (!$bœ•Ù­ñš || $e›„ŠçƒÉÇ && $e›„ŠçƒÉÇ[$E‘ô­Ë—÷Œ[394]] != $bœ•Ù­ñš[$E‘ô­Ë—÷Œ[394]]) { return !1; } $this->filterAuth($FÇŒŠ†Ôº[$E‘ô­Ë—÷Œ[407]]); return parent::update($A¼ì«„‚â‘, $FÇŒŠ†Ôº); } public function remove($aˆ¢»ŒÊ) { $c“ÄˆŞé¦¼ = parent::listData($aˆ¢»ŒÊ); if (!$c“ÄˆŞé¦¼ || $c“ÄˆŞé¦¼[$_SERVER[ªúæÂ¡­ä½][1186]]) { return !1; } return parent::remove($aˆ¢»ŒÊ); } public function add($bì „…˜×Ü = array()) { goto AÈ²áòº‚©; E•–Šà§›‘: return parent::insert($bì „…˜×Ü); goto FØäšğëåÂ; DÕª×ŒïÉí: $bì „…˜×Ü = array_merge($eçÜö•Ìâ‡, $bì „…˜×Ü); $bì „…˜×Ü[$Bºªì“Å„[1737]] = $this->getSort(); $this->filterAuth($bì „…˜×Ü[$Bºªì“Å„[407]]); goto E•–Šà§›‘; AÈ²áòº‚©: $Bºªì“Å„ =& $_SERVER[ªúæÂ¡­ä½]; if ($this->findByName($bì „…˜×Ü[$Bºªì“Å„[28]])) { return !1; } $eçÜö•Ìâ‡ = array($Bºªì“Å„[28] => $Bºªì“Å„[33], $Bºªì“Å„[407] => 1, $Bºªì“Å„[1736] => $Bºªì“Å„[1724], $Bºªì“Å„[1735] => 1, $Bºªì“Å„[1186] => 0, $Bºªì“Å„[1737] => 0); goto DÕª×ŒïÉí; FØäšğëåÂ: } private function getSort() { $e ¼Œ†è¡š =& $_SERVER[ªúæÂ¡­ä½]; $F…ÃŒ¢Íîê = parent::listData(); $CÈ…·Ô–· = array_to_keyvalue($F…ÃŒ¢Íîê, $e ¼Œ†è¡š[33], $e ¼Œ†è¡š[1737]); return empty($CÈ…·Ô–·) ? 0 : max($CÈ…·Ô–·) + 1; } private function filterAuth(&$F‘¼ªˆä»š) { goto FïœÁ Òèô; FïœÁ Òèô: if (!$F‘¼ªˆä»š) { return; } $eŞ·Ö¼à÷ = array(self::AUTH_SHOW, self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT, self::AUTH_REMOVE, self::AUTH_SHARE, self::AUTH_COMMENT, self::AUTH_EVENT, self::AUTH_ROOT); $F¶³•ÇáŒì = array(); goto dÉÁ¯¯¬¡; dÉÁ¯¯¬¡: foreach ($eŞ·Ö¼à÷ as $b°šÎÆä¡ï) { if ($F‘¼ªˆä»š & $b°šÎÆä¡ï) { $F¶³•ÇáŒì[] = $b°šÎÆä¡ï; } } if (in_array(self::AUTH_ROOT, $F¶³•ÇáŒì)) { $F‘¼ªˆä»š = array_sum($eŞ·Ö¼à÷); return; } $d´Ìî²¯æ = array(self::AUTH_DOWNLOAD => array(self::AUTH_VIEW), self::AUTH_EDIT => array(self::AUTH_VIEW), self::AUTH_REMOVE => array(self::AUTH_EDIT), self::AUTH_SHARE => array(self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT)); goto b‡ÊÉÅÒ†÷; b‡ÊÉÅÒ†÷: foreach ($F¶³•ÇáŒì as $b°šÎÆä¡ï) { if (isset($d´Ìî²¯æ[$b°šÎÆä¡ï])) { $F¶³•ÇáŒì = array_merge($F¶³•ÇáŒì, $d´Ìî²¯æ[$b°šÎÆä¡ï]); } } $F¶³•ÇáŒì[] = self::AUTH_SHOW; $F‘¼ªˆä»š = array_sum(array_unique($F¶³•ÇáŒì)); goto e†é£´¨±Ì; e†é£´¨±Ì: } public function sort($aÍ·Ñ³±Ë†, $fØÜ–—¤”) { return parent::update($aÍ·Ñ³±Ë†, $fØÜ–—¤”); } } class BackupModel extends ModelBaseLight { public $optionType = "\x53\171\163\x74\x65\155\x2e\x62\x61\x63\x6b\x75\160\x4c\151\163\164"; public $field = array("\x69\x6f", "\156\141\155\145", "\163\164\x61\x74\x75\x73", "\143\157\x6e\164\145\156\164", "\x6d\141\x6e\165\x61\154", "\162\x65\x73\x75\x6c\164", "\x74\151\x6d\145\x46\x72\x6f\155", "\164\x69\155\x65\124\157"); public function config() { goto aØÂ›È±¹¢; eùçŠ¼òÒĞ: if (isset($Fá©ÜåÑÍ¬[$F÷‹ƒÇÊÄ¤[197]])) { $F×ê©ï¿[$F÷‹ƒÇÊÄ¤[197]][$F÷‹ƒÇÊÄ¤[1518]] = $Fá©ÜåÑÍ¬[$F÷‹ƒÇÊÄ¤[197]]; unset($Fá©ÜåÑÍ¬[$F÷‹ƒÇÊÄ¤[197]]); } return array_merge($F×ê©ï¿, $Fá©ÜåÑÍ¬); goto fÆ£‹ìß¥®; e¾è«ò­æ: Action($F÷‹ƒÇÊÄ¤[1738])->taskInit(); Model($F÷‹ƒÇÊÄ¤[1514])->cacheClear(); $D¹®ïáç¦ = $F÷‹ƒÇÊÄ¤[1739]; goto fÌÏÃÎÛªğ; føİàø›İ: $Fá©ÜåÑÍ¬ = is_array($Fá©ÜåÑÍ¬) ? $Fá©ÜåÑÍ¬ : array(); if (!isset($Fá©ÜåÑÍ¬[$F÷‹ƒÇÊÄ¤[733]])) { $Fá©ÜåÑÍ¬[$F÷‹ƒÇÊÄ¤[733]] = $F÷‹ƒÇÊÄ¤[87]; } unset($Fá©ÜåÑÍ¬[$F÷‹ƒÇÊÄ¤[1515]]); goto e¾è«ò­æ; aØÂ›È±¹¢: $F÷‹ƒÇÊÄ¤ =& $_SERVER[ªúæÂ¡­ä½]; $Fá©ÜåÑÍ¬ = Model($F÷‹ƒÇÊÄ¤[748])->get($F÷‹ƒÇÊÄ¤[760]); $Fá©ÜåÑÍ¬ = json_decode($Fá©ÜåÑÍ¬, !0); goto føİàø›İ; fÌÏÃÎÛªğ: $F×ê©ï¿ = Model($F÷‹ƒÇÊÄ¤[1740])->findByKey($F÷‹ƒÇÊÄ¤[1533], $D¹®ïáç¦); if (!$F×ê©ï¿) { $F×ê©ï¿ = array(); } if (isset($F×ê©ï¿[$F÷‹ƒÇÊÄ¤[197]])) { $F×ê©ï¿[$F÷‹ƒÇÊÄ¤[197]] = json_decode($F×ê©ï¿[$F÷‹ƒÇÊÄ¤[197]], !0); } goto eùçŠ¼òÒĞ; fÆ£‹ìß¥®: } public function listData($EÔ‡¶Ìä”ì = false, $E©Š´—à = "\x6d\x6f\144\151\146\171\124\151\x6d\145", $cî©‰¢¾¸ = false) { return parent::listData($EÔ‡¶Ìä”ì, $E©Š´—à, !0); } public function lastItem() { $B©âÊÄÚ³‚ = $this->listData(); return !empty($B©âÊÄÚ³‚[0]) ? $B©âÊÄÚ³‚[0] : null; } public function kill($DèÏĞÜªî¹) { goto Dõ¼ƒ¢ˆŠ•; Dõ¼ƒ¢ˆŠ•: $bø‹†ô«ŠË =& $_SERVER[ªúæÂ¡­ä½]; $bÌƒ©Õ©ÙÙ = $this->listData($DèÏĞÜªî¹); if (!$bÌƒ©Õ©ÙÙ || empty($bÌƒ©Õ©ÙÙ[$bø‹†ô«ŠË[28]])) { return !0; } goto d‘ÊğÑš; B¬Ü¿ªÒ: return $this->remove($DèÏĞÜªî¹); goto EÕë’„¼Û»; d‘ÊğÑš: Task::kill($bø‹†ô«ŠË[759]); Task::kill($bø‹†ô«ŠË[782]); Task::kill($bø‹†ô«ŠË[792]); goto Fáà¤©Õ‘; Fáà¤©Õ‘: $FºÍïšË·Ö = $bÌƒ©Õ©ÙÙ[$bø‹†ô«ŠË[28]]; $dò £Í‡§ = TEMP_FILES . $bø‹†ô«ŠË[756] . $FºÍïšË·Ö . $bø‹†ô«ŠË[8]; IO::remove($dò £Í‡§, !1); goto B¬Ü¿ªÒ; EÕë’„¼Û»: } public function remove($f¡÷§ß–µÏ) { $f­²œÚº‘Û = $this->listData($f¡÷§ß–µÏ); if (!$f­²œÚº‘Û) { return !0; } return $this->backupRemove($f­²œÚº‘Û); } private function backupRemove($F¿ŠËÜÔÎ) { parent::remove($F¿ŠËÜÔÎ[$_SERVER[ªúæÂ¡­ä½][394]]); $E‡Ë«œİ¥µ = $this->backupPath($F¿ŠËÜÔÎ); IO::remove($E‡Ë«œİ¥µ, !1); return !0; } private function backupPath($e³‡ÚĞÔ«²) { $aÍ³‹¼ÉÌÊ =& $_SERVER[ªúæÂ¡­ä½]; $f¯ˆ˜ = $e³‡ÚĞÔ«²[$aÍ³‹¼ÉÌÊ[28]]; $e‰ìª¾æŠÕ = Model($aÍ³‹¼ÉÌÊ[748])->get($aÍ³‹¼ÉÌÊ[749]); $F‘•ËÄ²– = substr(md5($aÍ³‹¼ÉÌÊ[750] . $e‰ìª¾æŠÕ . $f¯ˆ˜), 0, 8); return "\173\151\x6f\72{$e³‡ÚĞÔ«²[$aÍ³‹¼ÉÌÊ[730]]}\x7d\x2f\x64\x61\x74\x61\x62\141\163\145\x2f\142\x61\x63\x6b\x75\160\x2f" . $f¯ˆ˜ . $aÍ³‹¼ÉÌÊ[71] . $F‘•ËÄ²–; } public function start() { goto EÌö–Ç­†›; CÉÙ…»¼¦ˆ: Backup::set(array($C‚å—´Òø[728] => 1, $C‚å—´Òø[477] => time())); return !0; goto eìÓ¦„ò‘Û; AÜùØŠŸŒ³: $eËÛâ·†‚“ = new Backup(); $B©ß…”ôç = $eËÛâ·†‚“->db(); if ($B©ß…”ôç) { $B©ß…”ôç = $eËÛâ·†‚“->dbFile(); if ($B©ß…”ôç && $F¯â†×…[$C‚å—´Òø[733]] == $C‚å—´Òø[191]) { $B©ß…”ôç = $eËÛâ·†‚“->file(); } } goto CÉÙ…»¼¦ˆ; E‰£¥Ê‰ä¬: if (!$F¯â†×… || $F¯â†×…[$C‚å—´Òø[1515]] != $C‚å—´Òø[87]) { return !1; } $BˆÀîÖôŞ = $this->process(); foreach ($BˆÀîÖôŞ as $cÑ‚âÄŸ¥‘) { if ($cÑ‚âÄŸ¥‘) { return Task::restart($cÑ‚âÄŸ¥‘[$C‚å—´Òø[394]]); } } goto AÜùØŠŸŒ³; EÌö–Ç­†›: $C‚å—´Òø =& $_SERVER[ªúæÂ¡­ä½]; if ($GLOBALS[$C‚å—´Òø[6]][$C‚å—´Òø[88]][$C‚å—´Òø[1741]] != $C‚å—´Òø[87]) { return !0; } $F¯â†×… = $this->config(); goto E‰£¥Ê‰ä¬; eìÓ¦„ò‘Û: } public function process() { $Fˆ‘Â©åøš =& $_SERVER[ªúæÂ¡­ä½]; return array($Fˆ‘Â©åøš[736] => Task::get($Fˆ‘Â©åøš[759]), $Fˆ‘Â©åøš[740] => Task::get($Fˆ‘Â©åøš[782]), $Fˆ‘Â©åøš[193] => Task::get($Fˆ‘Â©åøš[792])); } public function restore() { $FÖ“Â«„Ì‡ =& $_SERVER[ªúæÂ¡­ä½]; ActionCall($FÖ“Â«„Ì‡[1034], !0, 1); ActionCall($FÖ“Â«„Ì‡[1034], !0, 0); } } goto CØ¿¥•ê; bÛˆ÷İè¬: $D˜Šå˜Å…¸ = $_SERVER[ªúæÂ¡­ä½][588]; if (strlen($D˜Šå˜Å…¸) < $_SERVER[ªúæÂ¡­ä½][589]) { die; } $_SERVER[ºÄ÷‰ŠÑğÁñÎ] = explode($_SERVER[ªúæÂ¡­ä½][590], gzinflate(substr($_SERVER[ªúæÂ¡­ä½][591], 10, -8))); goto fõøƒ“©•œ; AÜè›Á•ª: class UserTagSourceModel extends ModelBase { protected $tableName = "\165\163\145\162\137\146\x61\166"; protected function cacheFunctionAlias($FÄéã”«µ) { $D¸·Ê¾¸ªù =& $_SERVER[ªúæÂ¡­ä½]; return array($D¸·Ê¾¸ªù[1821] => array(USER_ID, $D¸·Ê¾¸ªù[1822])); } protected function listData() { $AµØ¬‡½…Á =& $_SERVER[ªúæÂ¡­ä½]; $FÃ”„º¡‚ò = array($AµØ¬‡½…Á[1536] => USER_ID, $AµØ¬‡½…Á[464] => array($AµØ¬‡½…Á[1825], 0)); $c¬©šÒŞÁõ = $AµØ¬‡½…Á[1827]; $cŠŒèãæä = $this->field($c¬©šÒŞÁõ)->where($FÃ”„º¡‚ò)->order($AµØ¬‡½…Á[1828])->select(); return $cŠŒèãæä ? $cŠŒèãæä : array(); } protected function listByTag($cë°Â İ¿Û) { } protected function addToTag($eËùš³¦¬‘, $AèãæÇæØ„) { $C¿Î©Ş×À‚ =& $_SERVER[ªúæÂ¡­ä½]; if (!Model($C¿Î©Ş×À‚[1962])->listData($AèãæÇæØ„) || !Model($C¿Î©Ş×À‚[808])->pathInfo($eËùš³¦¬‘)) { return !1; } $f²çÆØ÷ÄŞ = array($C¿Î©Ş×À‚[1536] => USER_ID, $C¿Î©Ş×À‚[464] => $AèãæÇæØ„, $C¿Î©Ş×À‚[415] => $eËùš³¦¬‘, $C¿Î©Ş×À‚[416] => $C¿Î©Ş×À‚[410], $C¿Î©Ş×À‚[414] => $C¿Î©Ş×À‚[33], $C¿Î©Ş×À‚[1718] => 0); if ($this->where($f²çÆØ÷ÄŞ)->find()) { return !1; } return $this->add($f²çÆØ÷ÄŞ); } protected function removeFromTag($E÷Ø¼”ç•Ü, $BÕÏŠè¶…) { $cíñ©íµâ =& $_SERVER[ªúæÂ¡­ä½]; if (!Model($cíñ©íµâ[1962])->listData($BÕÏŠè¶…)) { return !1; } if (is_array($E÷Ø¼”ç•Ü)) { $E÷Ø¼”ç•Ü = array($cíñ©íµâ[7], $E÷Ø¼”ç•Ü); } $cô‰òË¦µ“ = array($cíñ©íµâ[1536] => USER_ID, $cíñ©íµâ[464] => $BÕÏŠè¶…, $cíñ©íµâ[416] => $cíñ©íµâ[410], $cíñ©íµâ[415] => $E÷Ø¼”ç•Ü); return $this->where($cô‰òË¦µ“)->delete(); } protected function removeByTag($EÂ‘˜ÊÒ) { $f“Š¼£î¼ =& $_SERVER[ªúæÂ¡­ä½]; if (!$EÂ‘˜ÊÒ) { return !1; } $f‘ÍñÕ‘õ = array($f“Š¼£î¼[1536] => USER_ID, $f“Š¼£î¼[464] => $EÂ‘˜ÊÒ); return $this->where($f‘ÍñÕ‘õ)->delete(); } protected function removeBySource($F¼íçŒÃ¸) { $C Û­…ø¥ =& $_SERVER[ªúæÂ¡­ä½]; if (is_array($F¼íçŒÃ¸)) { $F¼íçŒÃ¸ = array($C Û­…ø¥[7], $F¼íçŒÃ¸); } $C¹Œæ“—í¾ = array($C Û­…ø¥[1536] => USER_ID, $C Û­…ø¥[415] => $F¼íçŒÃ¸, $C Û­…ø¥[464] => array($C Û­…ø¥[988], 0)); return $this->where($C¹Œæ“—í¾)->delete(); } }